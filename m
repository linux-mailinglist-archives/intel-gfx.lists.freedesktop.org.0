Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id C203046322
	for <lists+intel-gfx@lfdr.de>; Fri, 14 Jun 2019 17:43:25 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E9D5289A8C;
	Fri, 14 Jun 2019 15:43:22 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga06.intel.com (mga06.intel.com [134.134.136.31])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 593BE89B00
 for <intel-gfx@lists.freedesktop.org>; Thu, 13 Jun 2019 15:12:30 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga003.jf.intel.com ([10.7.209.27])
 by orsmga104.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 13 Jun 2019 08:12:28 -0700
X-ExtLoop1: 1
Received: from yyosef-mobl.ger.corp.intel.com (HELO [10.252.23.42])
 ([10.252.23.42])
 by orsmga003.jf.intel.com with ESMTP; 13 Jun 2019 08:12:17 -0700
To: Lucas De Marchi <lucas.demarchi@intel.com>, intel-gfx@lists.freedesktop.org
References: <20190612162900.13777-1-lucas.demarchi@intel.com>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <0000a4b2-ac8b-a18d-4c78-0db197c712a1@linux.intel.com>
Date: Thu, 13 Jun 2019 16:12:16 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.7.0
MIME-Version: 1.0
In-Reply-To: <20190612162900.13777-1-lucas.demarchi@intel.com>
Content-Language: en-US
X-Mailman-Approved-At: Fri, 14 Jun 2019 15:43:17 +0000
Subject: Re: [Intel-gfx] [PATCH] gpu/drm/i915: globally replace dev_priv
 with i915
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDEyLzA2LzIwMTkgMTc6MjksIEx1Y2FzIERlIE1hcmNoaSB3cm90ZToKPiBXZSBhcmUgc2xv
d2x5IGNvbnZlcnRpbmcgZGV2X3ByaXYgdG8gaTkxNSBldmVyeXdoZXJlLCBzcHJlYWQgaW50bwo+
IHNtYWxsZXIgc2VyaWVzLiBXaGlsZSB0aGlzIGlzIGdvb2QgdG8gYXZvaWQgdW5yZWxhdGVkIGJy
ZWFrYWdlcyB0byBvdGhlcgo+IGluZmxpZ2h0IHBhdGNoZXMsIGl0J3MgYmFkIGJlY2F1c2UgaW5m
bGlnaHQgcGF0Y2hlcyBvbiBuZWFyYnkgcGF0aHMga2VlcAo+IGJyZWFraW5nLiBQYWlyZWQgd2l0
aCBvdGhlciBjb2RlIG1vdmVzIGFuZCByZWZhY3RvcmVzIHRoaXMgaXMgYmVjb21pbmcgYQo+IG5p
Z2h0bWFyZS4KPiAKPiBOb3cgdGhhdCBJOTE1X3tSRUFELFdSSVRFfSBhcmUgZ29uZSBhbmQgaW1w
bGljaXQgYWNjZXNzIHRvIGRldl9wcml2IG5vCgpXaG8gcmVtb3ZlZCBJOTE1X1JFQUQvV1JJVEU/
IEluIGZhY3QgSSBzZWUgc29tZSBpbiB0aGlzIHBhdGNoLiBXZWxsIApjb2xvdXIgbWUgY29uZnVz
ZWQuLiBob3cgZGlkIHRoZSBwYXRjaCBjb21waWxlPwoKUGx1cyBpdCdzIG5vdCBJOTE1X1JFQUQv
V1JJVEUgLSBzb21lIGRpc3BsYXkgbWFjcm9zIGhhdmUgaGlkZGVuIApkZXBlbmRlbmN5IG9uIGlt
cGxpY2l0IGRldl9wcml2IGFzIHdlbGwuCgo+IGxvbmdlciBleGlzdHMgd2UgY2FuIHNpbXBseSBz
ZWQgYWxsIGZpbGVzIGFuZCBiZSBkb25lIHdpdGggdGhlCj4gY29udmVyc2lvbi4gVGhpcyB3YXMg
Z2VuZXJhdGVkIHdpdGggdGhlIGZvbGxvd2luZyBjb21tYW5kcyB3aXRoIG5vCj4gYWRkaXRpb25h
bCBmaXh1cHM6Cj4gCj4gCWdpdCBscy1maWxlcyAtLWZ1bGwtbmFtZSAteiAtLSBkcml2ZXJzL2dw
dS9kcm0vaTkxNS8gfCBcCj4gCQl4YXJncyAtMCBzZWQgLWkgJ3MvXGJkZXZfcHJpdlxiL2k5MTUv
ZycKPiAKPiBBbnkgcGVuZGluZyBzZXJpZXMgY2FuIGFwcGx5IHRoZSBzYW1lIHNlYXJjaCBhbmQg
cmVwbGFjZSB3aGVuIHJlYmFzaW5nLgoKSSBhbSBpbiB0d28gbWluZHMuIENvbnZlcnRpbmcgcGll
Y2UgbWVhbCBpcyBlYXNpZXIgZm9yIHNvbWUgdXNlIGNhc2VzLCAKYW5kIGNvbnZlcnRpbmcgYWxs
IGF0IG9uY2UgaXMgZWFzaWVyIGZvciBzb21lIG90aGVycy4gRG9uJ3Qga25vdy4KClJlZ2FyZHMs
CgpUdnJ0a28KCj4gCj4gU2lnbmVkLW9mZi1ieTogTHVjYXMgRGUgTWFyY2hpIDxsdWNhcy5kZW1h
cmNoaUBpbnRlbC5jb20+Cj4gLS0tCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kdm9fY2g3MDE3
LmMgICAgICAgICAgICAgfCAgICA2ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kdm9fY2g3
eHh4LmMgICAgICAgICAgICAgfCAgIDEwICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kdm9f
aXZjaC5jICAgICAgICAgICAgICAgfCAgIDE0ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9k
dm9fbnMyNTAxLmMgICAgICAgICAgICAgfCAgIDE0ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9kdm9fc2lsMTY0LmMgICAgICAgICAgICAgfCAgIDEwICstCj4gICBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9kdm9fdGZwNDEwLmMgICAgICAgICAgICAgfCAgIDEwICstCj4gICBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jICAgfCAgIDQ4ICstCj4gICBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5oICAgfCAgICA2ICstCj4gICAuLi4vZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMgICAgfCAgICA0ICstCj4gICBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMgICAgfCAgICA0ICstCj4gICBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fc2htZW0uYyAgICAgfCAgICA0ICstCj4g
ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fc3RvbGVuLmMgICAgfCAgMTY4ICst
Cj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdGlsaW5nLmMgICAgfCAgICA4
ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdXNlcnB0ci5jICAgfCAg
IDQwICstCj4gICAuLi4vZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaHVnZV9wYWdlcy5jICAg
fCAgIDQ4ICstCj4gICAuLi4vZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0
LmMgfCAgICA2ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaCAg
ICAgICAgfCAgICAyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVf
Y3MuYyAgICAgfCAgIDY2ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5n
Y2hlY2suYyAgICAgfCAgIDM2ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9t
b2NzLmMgICAgICAgICAgfCAgIDI0ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9tb2NzLmggICAgICAgICAgfCAgICAyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9yZXNldC5jICAgICAgICAgfCAgICA2ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9yaW5nYnVmZmVyLmMgICAgfCAgIDUyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndnQvYXBlcnR1cmVfZ20uYyAgICAgICAgfCAgIDYwICstCj4gICBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndnQvY2ZnX3NwYWNlLmMgICAgICAgICAgfCAgICA0ICstCj4gICBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndnQvY21kX3BhcnNlci5jICAgICAgICAgfCAgIDM0ICstCj4gICBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndnQvZGVidWdmcy5jICAgICAgICAgICAgfCAgIDEyICstCj4gICBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndnQvZGlzcGxheS5jICAgICAgICAgICAgfCAgIDQ4ICstCj4gICBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZG1hYnVmLmMgICAgICAgICAgICAgfCAgIDEyICstCj4gICBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZWRpZC5jICAgICAgICAgICAgICAgfCAgICA2ICstCj4g
ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZXhlY2xpc3QuYyAgICAgICAgICAgfCAgIDE0ICst
Cj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZmJfZGVjb2Rlci5jICAgICAgICAgfCAgIDEy
ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZmlybXdhcmUuYyAgICAgICAgICAgfCAg
IDE2ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZ3R0LmMgICAgICAgICAgICAgICAg
fCAgIDQ0ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZ3Z0LmMgICAgICAgICAgICAg
ICAgfCAgIDI2ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZ3Z0LmggICAgICAgICAg
ICAgICAgfCAgIDIwICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvaGFuZGxlcnMuYyAg
ICAgICAgICAgfCAgIDkyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvaW50ZXJydXB0
LmMgICAgICAgICAgfCAgICA2ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQva3ZtZ3Qu
YyAgICAgICAgICAgICAgfCAgICA2ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvbW1p
by5jICAgICAgICAgICAgICAgfCAgICAyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQv
bW1pb19jb250ZXh0LmMgICAgICAgfCAgIDM4ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dnQvc2NoZWRfcG9saWN5LmMgICAgICAgfCAgIDEyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndnQvc2NoZWR1bGVyLmMgICAgICAgICAgfCAgIDcyICstCj4gICBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndnQvdmdwdS5jICAgICAgICAgICAgICAgfCAgICA2ICstCj4gICBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2NtZF9wYXJzZXIuYyAgICAgICAgfCAgICA2ICstCj4gICBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYyAgICAgICAgICAgfCAgOTUyICsrKy0tLQo+ICAgZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmggICAgICAgICAgIHwgICAgNCArLQo+ICAg
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYyAgICAgICAgICAgICAgIHwgMTA5MiArKyst
LS0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggICAgICAgICAgICAgICB8ICA1
OTAgKystLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyAgICAgICAgICAgICAg
IHwgIDM1NiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZXZpY3QuYyAgICAg
ICAgIHwgICAgNiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMgICAg
ICAgICAgIHwgIDIxNCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0Lmgg
ICAgICAgICAgIHwgICAyMCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJy
b3IuYyAgICAgICAgIHwgICA0NCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVf
ZXJyb3IuaCAgICAgICAgIHwgICAgNiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9p
cnEuYyAgICAgICAgICAgICAgIHwgMTgwOCArKysrKy0tLS0tCj4gICBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2lycS5oICAgICAgICAgICAgICAgfCAgIDg2ICstCj4gICBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X21lbWNweS5jICAgICAgICAgICAgfCAgICAyICstCj4gICBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X29hX2Jkdy5jICAgICAgICAgICAgfCAgIDMyICstCj4gICBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X29hX2Jkdy5oICAgICAgICAgICAgfCAgICAyICstCj4gICBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2J4dC5jICAgICAgICAgICAgfCAgIDMyICstCj4gICBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2J4dC5oICAgICAgICAgICAgfCAgICAyICstCj4g
ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NmbGd0Mi5jICAgICAgICAgfCAgIDMyICst
Cj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NmbGd0Mi5oICAgICAgICAgfCAgICAy
ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NmbGd0My5jICAgICAgICAgfCAg
IDMyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NmbGd0My5oICAgICAgICAg
fCAgICAyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2Nodi5jICAgICAgICAg
ICAgfCAgIDMyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2Nodi5oICAgICAg
ICAgICAgfCAgICAyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NubC5jICAg
ICAgICAgICAgfCAgIDMyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NubC5o
ICAgICAgICAgICAgfCAgICAyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2ds
ay5jICAgICAgICAgICAgfCAgIDMyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29h
X2dsay5oICAgICAgICAgICAgfCAgICAyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X29hX2hzdy5jICAgICAgICAgICAgfCAgIDMyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X29hX2hzdy5oICAgICAgICAgICAgfCAgICAyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X29hX2ljbC5jICAgICAgICAgICAgfCAgIDMyICstCj4gICBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X29hX2ljbC5oICAgICAgICAgICAgfCAgICAyICstCj4gICBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X29hX2tibGd0Mi5jICAgICAgICAgfCAgIDMyICstCj4gICBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X29hX2tibGd0Mi5oICAgICAgICAgfCAgICAyICstCj4gICBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X29hX2tibGd0My5jICAgICAgICAgfCAgIDMyICstCj4gICBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2tibGd0My5oICAgICAgICAgfCAgICAyICstCj4gICBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0Mi5jICAgICAgICAgfCAgIDMyICstCj4g
ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0Mi5oICAgICAgICAgfCAgICAyICst
Cj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0My5jICAgICAgICAgfCAgIDMy
ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0My5oICAgICAgICAgfCAg
ICAyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0NC5jICAgICAgICAg
fCAgIDMyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0NC5oICAgICAg
ICAgfCAgICAyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYyAgICAgICAg
ICAgICAgfCAgODE0ICsrLS0tCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5jICAg
ICAgICAgICAgICAgfCAgIDQyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3F1ZXJ5
LmMgICAgICAgICAgICAgfCAgIDEwICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3Jl
Zy5oICAgICAgICAgICAgICAgfCAgNDIwICstLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9zdXNwZW5kLmMgICAgICAgICAgIHwgIDEwNiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9zeXNmcy5jICAgICAgICAgICAgIHwgIDE3MiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV90cmFjZS5oICAgICAgICAgICAgIHwgICA0NiArLQo+ICAgZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV92Z3B1LmMgICAgICAgICAgICAgIHwgICAzMCArLQo+ICAgZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV92Z3B1LmggICAgICAgICAgICAgIHwgICAxNiArLQo+ICAgZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV92bWEuYyAgICAgICAgICAgICAgIHwgICAgNCArLQo+ICAgZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaWNsX2RzaS5jICAgICAgICAgICAgICAgIHwgIDEyMiArLQo+ICAgZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfYXRvbWljLmMgICAgICAgICAgIHwgICAyOCArLQo+ICAg
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfYXRvbWljLmggICAgICAgICAgIHwgICAgMiArLQo+
ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfYXVkaW8uYyAgICAgICAgICAgIHwgIDIyMiAr
LQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfYXVkaW8uaCAgICAgICAgICAgIHwgICAg
NiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfYmlvcy5jICAgICAgICAgICAgIHwg
IDU1MiArKy0tCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9iaW9zLmggICAgICAgICAg
ICAgfCAgIDE4ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9idy5jICAgICAgICAg
ICAgICAgfCAgIDY4ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9idy5oICAgICAg
ICAgICAgICAgfCAgICA4ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jZGNsay5j
ICAgICAgICAgICAgfCAgODgyICsrLS0tCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9j
ZGNsay5oICAgICAgICAgICAgfCAgIDE0ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9jb2xvci5jICAgICAgICAgICAgfCAgMTc2ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9jb21ib19waHkuYyAgICAgICAgfCAgIDY0ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9jb21ib19waHkuaCAgICAgICAgfCAgICA2ICstCj4gICBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9jb25uZWN0b3IuYyAgICAgICAgfCAgIDEyICstCj4gICBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9jcnQuYyAgICAgICAgICAgICAgfCAgMTcyICstCj4gICBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF9jcnQuaCAgICAgICAgICAgICAgfCAgICA0ICstCj4gICBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9jc3IuYyAgICAgICAgICAgICAgfCAgMTQ0ICstCj4gICBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kZGkuYyAgICAgICAgICAgICAgfCAgNTkyICsrLS0KPiAg
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RkaS5oICAgICAgICAgICAgICB8ICAgIDYgKy0K
PiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RldmljZV9pbmZvLmMgICAgICB8ICAxNjQg
Ky0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RldmljZV9pbmZvLmggICAgICB8ICAg
IDYgKy0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rpc3BsYXkuYyAgICAgICAgICB8
IDI5MTYgKysrKysrKystLS0tLS0tLS0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rp
c3BsYXkuaCAgICAgICAgICB8ICAgIDYgKy0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X2Rpc3BsYXlfcG93ZXIuYyAgICB8IDEwMjAgKysrLS0tCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmggICAgfCAgIDYyICstCj4gICBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9kcC5jICAgICAgICAgICAgICAgfCAgODIyICsrLS0tCj4gICBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF9kcC5oICAgICAgICAgICAgICAgfCAgIDE4ICstCj4gICBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9kcF9hdXhfYmFja2xpZ2h0LmMgfCAgICA0ICstCj4gICBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcF9tc3QuYyAgICAgICAgICAgfCAgIDMyICstCj4gICBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcGlvX3BoeS5jICAgICAgICAgfCAgMjc2ICstCj4g
ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcGlvX3BoeS5oICAgICAgICAgfCAgIDEyICst
Cj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcGxsX21nci5jICAgICAgICAgfCAgMzU2
ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcGxsX21nci5oICAgICAgICAgfCAg
IDIwICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcnYuaCAgICAgICAgICAgICAg
fCAgIDcyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kc2kuYyAgICAgICAgICAg
ICAgfCAgICA2ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kc2kuaCAgICAgICAg
ICAgICAgfCAgICA2ICstCj4gICAuLi4vZ3B1L2RybS9pOTE1L2ludGVsX2RzaV9kY3NfYmFja2xp
Z2h0LmMgICAgfCAgICA0ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kc2lfdmJ0
LmMgICAgICAgICAgfCAgIDc2ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kdm8u
YyAgICAgICAgICAgICAgfCAgIDMyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9k
dm8uaCAgICAgICAgICAgICAgfCAgICAyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9kdm9fZGV2LmggICAgICAgICAgfCAgICAyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9mYmMuYyAgICAgICAgICAgICAgfCAgNDEwICstLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfZmJjLmggICAgICAgICAgICAgIHwgICAyMCArLQo+ICAgZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfZmJkZXYuYyAgICAgICAgICAgIHwgICA0NiArLQo+ICAgZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfZmJkZXYuaCAgICAgICAgICAgIHwgICAgOCArLQo+ICAgZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfZmlmb191bmRlcnJ1bi5jICAgIHwgIDE2MCArLQo+ICAgZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfZmlmb191bmRlcnJ1bi5oICAgIHwgICAxMiArLQo+ICAgZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZnJvbnRidWZmZXIuYyAgICAgIHwgICA4MiArLQo+ICAg
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZnJvbnRidWZmZXIuaCAgICAgIHwgICAgNiArLQo+
ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ21idXMuYyAgICAgICAgICAgIHwgIDIzMCAr
LQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ21idXMuaCAgICAgICAgICAgIHwgICAx
MCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjLmMgICAgICAgICAgICAgIHwg
ICA0OCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2Fkcy5jICAgICAgICAg
IHwgICAxMiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2Z3LmMgICAgICAg
ICAgIHwgICAyMCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2xvZy5jICAg
ICAgICAgIHwgICAxOCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX3N1Ym1p
c3Npb24uYyAgIHwgICA1NiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3Z0LmMg
ICAgICAgICAgICAgIHwgICAzNiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3Z0
LmggICAgICAgICAgICAgIHwgICAxNiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
aGRjcC5jICAgICAgICAgICAgIHwgIDI4NiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50
ZWxfaGRjcC5oICAgICAgICAgICAgIHwgICAgNiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfaGRtaS5jICAgICAgICAgICAgIHwgIDMxNiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfaGRtaS5oICAgICAgICAgICAgIHwgICAgMiArLQo+ICAgZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfaG90cGx1Zy5jICAgICAgICAgIHwgIDIxMCArLQo+ICAgZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfaG90cGx1Zy5oICAgICAgICAgIHwgICAxNiArLQo+ICAgZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfaHVjLmMgICAgICAgICAgICAgIHwgICAgNiArLQo+ICAgZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfaHVjX2Z3LmMgICAgICAgICAgIHwgICAxOCArLQo+ICAgZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfbHBlX2F1ZGlvLmMgICAgICAgIHwgICA5NiArLQo+ICAg
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfbHBlX2F1ZGlvLmggICAgICAgIHwgICAgOCArLQo+
ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfbHNwY29uLmMgICAgICAgICAgIHwgICAgNCAr
LQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfbHZkcy5jICAgICAgICAgICAgIHwgICA5
NiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfbHZkcy5oICAgICAgICAgICAgIHwg
ICAgOCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfb3ByZWdpb24uYyAgICAgICAg
IHwgIDExNCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfb3ByZWdpb24uaCAgICAg
ICAgIHwgICAyOCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfb3ZlcmxheS5jICAg
ICAgICAgIHwgICA5OCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfb3ZlcmxheS5o
ICAgICAgICAgIHwgICAgOCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcGFuZWwu
YyAgICAgICAgICAgIHwgIDIzOCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcGlw
ZV9jcmMuYyAgICAgICAgIHwgIDEyMCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
cGlwZV9jcmMuaCAgICAgICAgIHwgICAgNCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50
ZWxfcG0uYyAgICAgICAgICAgICAgIHwgMjMwMCArKysrKystLS0tLS0tCj4gICBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF9wbS5oICAgICAgICAgICAgICAgfCAgIDc0ICstCj4gICBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9wc3IuYyAgICAgICAgICAgICAgfCAgMzk0ICstLQo+ICAgZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcHNyLmggICAgICAgICAgICAgIHwgICAxNCArLQo+ICAg
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcXVpcmtzLmggICAgICAgICAgIHwgICAgMiArLQo+
ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcnVudGltZV9wbS5oICAgICAgIHwgICAgOCAr
LQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfc2R2by5jICAgICAgICAgICAgIHwgIDEy
OCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfc2R2by5oICAgICAgICAgICAgIHwg
ICAgNCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfc3ByaXRlLmMgICAgICAgICAg
IHwgIDIxOCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfc3ByaXRlLmggICAgICAg
ICAgIHwgICAgOCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdHYuYyAgICAgICAg
ICAgICAgIHwgICA3MiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdHYuaCAgICAg
ICAgICAgICAgIHwgICAgMiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdWMuYyAg
ICAgICAgICAgICAgIHwgICAgNCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdWMu
aCAgICAgICAgICAgICAgIHwgICAyMiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
dWNfZncuYyAgICAgICAgICAgIHwgICAxMiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50
ZWxfdWNfZncuaCAgICAgICAgICAgIHwgICAgMiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfdW5jb3JlLmMgICAgICAgICAgIHwgICAyNiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfdW5jb3JlLmggICAgICAgICAgIHwgICAgNCArLQo+ICAgZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfdmJ0X2RlZnMuaCAgICAgICAgIHwgICAgMiArLQo+ICAgZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfdmRzYy5jICAgICAgICAgICAgIHwgICAxMCArLQo+ICAgZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfd29wY20uYyAgICAgICAgICAgIHwgICAxNCArLQo+ICAgZHJpdmVy
cy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jIHwgICAyNiArLQo+ICAgZHJp
dmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2ludGVsX2d1Yy5jICAgIHwgICA0NiArLQo+ICAg
ZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2ludGVsX3VuY29yZS5jIHwgICAxMCArLQo+
ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvdmx2X2RzaS5jICAgICAgICAgICAgICAgIHwgIDIyMiAr
LQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvdmx2X2RzaV9wbGwuYyAgICAgICAgICAgIHwgICA4
MCArLQo+ICAgMjAxIGZpbGVzIGNoYW5nZWQsIDEyMDIwIGluc2VydGlvbnMoKyksIDEyMDIwIGRl
bGV0aW9ucygtKQo+IAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kdm9fY2g3
MDE3LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kdm9fY2g3MDE3LmMKPiBpbmRleCA2MDIzODBm
ZTc0ZjMuLmRmNjcwYzhkNWMzMSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9k
dm9fY2g3MDE3LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kdm9fY2g3MDE3LmMKPiBA
QCAtMjEwLDcgKzIxMCw3IEBAIHN0YXRpYyBib29sIGNoNzAxN19pbml0KHN0cnVjdCBpbnRlbF9k
dm9fZGV2aWNlICpkdm8sCj4gICAJCXJldHVybiBmYWxzZTsKPiAgIAo+ICAgCWR2by0+aTJjX2J1
cyA9IGFkYXB0ZXI7Cj4gLQlkdm8tPmRldl9wcml2ID0gcHJpdjsKPiArCWR2by0+aTkxNSA9IHBy
aXY7Cj4gICAKPiAgIAlpZiAoIWNoNzAxN19yZWFkKGR2bywgQ0g3MDE3X0RFVklDRV9JRCwgJnZh
bCkpCj4gICAJCWdvdG8gZmFpbDsKPiBAQCAtMzk1LDExICszOTUsMTEgQEAgZG8gewkJCQkJCQlc
Cj4gICAKPiAgIHN0YXRpYyB2b2lkIGNoNzAxN19kZXN0cm95KHN0cnVjdCBpbnRlbF9kdm9fZGV2
aWNlICpkdm8pCj4gICB7Cj4gLQlzdHJ1Y3QgY2g3MDE3X3ByaXYgKnByaXYgPSBkdm8tPmRldl9w
cml2Owo+ICsJc3RydWN0IGNoNzAxN19wcml2ICpwcml2ID0gZHZvLT5pOTE1Owo+ICAgCj4gICAJ
aWYgKHByaXYpIHsKPiAgIAkJa2ZyZWUocHJpdik7Cj4gLQkJZHZvLT5kZXZfcHJpdiA9IE5VTEw7
Cj4gKwkJZHZvLT5pOTE1ID0gTlVMTDsKPiAgIAl9Cj4gICB9Cj4gICAKPiBkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZHZvX2NoN3h4eC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZHZvX2NoN3h4eC5jCj4gaW5kZXggZTA3MGJlYmVlN2I1Li5lMDc2ODAxZDAzMmYgMTAwNjQ0Cj4g
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZHZvX2NoN3h4eC5jCj4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZHZvX2NoN3h4eC5jCj4gQEAgLTEzNSw3ICsxMzUsNyBAQCBzdGF0aWMgY2hh
ciAqY2g3eHh4X2dldF9kaWQodTggZGlkKQo+ICAgLyoqIFJlYWRzIGFuIDggYml0IHJlZ2lzdGVy
ICovCj4gICBzdGF0aWMgYm9vbCBjaDd4eHhfcmVhZGIoc3RydWN0IGludGVsX2R2b19kZXZpY2Ug
KmR2bywgaW50IGFkZHIsIHU4ICpjaCkKPiAgIHsKPiAtCXN0cnVjdCBjaDd4eHhfcHJpdiAqY2g3
eHh4ID0gZHZvLT5kZXZfcHJpdjsKPiArCXN0cnVjdCBjaDd4eHhfcHJpdiAqY2g3eHh4ID0gZHZv
LT5pOTE1Owo+ICAgCXN0cnVjdCBpMmNfYWRhcHRlciAqYWRhcHRlciA9IGR2by0+aTJjX2J1czsK
PiAgIAl1OCBvdXRfYnVmWzJdOwo+ICAgCXU4IGluX2J1ZlsyXTsKPiBAQCAtMTczLDcgKzE3Myw3
IEBAIHN0YXRpYyBib29sIGNoN3h4eF9yZWFkYihzdHJ1Y3QgaW50ZWxfZHZvX2RldmljZSAqZHZv
LCBpbnQgYWRkciwgdTggKmNoKQo+ICAgLyoqIFdyaXRlcyBhbiA4IGJpdCByZWdpc3RlciAqLwo+
ICAgc3RhdGljIGJvb2wgY2g3eHh4X3dyaXRlYihzdHJ1Y3QgaW50ZWxfZHZvX2RldmljZSAqZHZv
LCBpbnQgYWRkciwgdTggY2gpCj4gICB7Cj4gLQlzdHJ1Y3QgY2g3eHh4X3ByaXYgKmNoN3h4eCA9
IGR2by0+ZGV2X3ByaXY7Cj4gKwlzdHJ1Y3QgY2g3eHh4X3ByaXYgKmNoN3h4eCA9IGR2by0+aTkx
NTsKPiAgIAlzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIgPSBkdm8tPmkyY19idXM7Cj4gICAJ
dTggb3V0X2J1ZlsyXTsKPiAgIAlzdHJ1Y3QgaTJjX21zZyBtc2cgPSB7Cj4gQEAgLTIxMCw3ICsy
MTAsNyBAQCBzdGF0aWMgYm9vbCBjaDd4eHhfaW5pdChzdHJ1Y3QgaW50ZWxfZHZvX2RldmljZSAq
ZHZvLAo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gICAKPiAgIAlkdm8tPmkyY19idXMgPSBhZGFwdGVy
Owo+IC0JZHZvLT5kZXZfcHJpdiA9IGNoN3h4eDsKPiArCWR2by0+aTkxNSA9IGNoN3h4eDsKPiAg
IAljaDd4eHgtPnF1aWV0ID0gdHJ1ZTsKPiAgIAo+ICAgCWlmICghY2g3eHh4X3JlYWRiKGR2bywg
Q0g3eHh4X1JFR19WSUQsICZ2ZW5kb3IpKQo+IEBAIC0zNDcsMTEgKzM0NywxMSBAQCBzdGF0aWMg
dm9pZCBjaDd4eHhfZHVtcF9yZWdzKHN0cnVjdCBpbnRlbF9kdm9fZGV2aWNlICpkdm8pCj4gICAK
PiAgIHN0YXRpYyB2b2lkIGNoN3h4eF9kZXN0cm95KHN0cnVjdCBpbnRlbF9kdm9fZGV2aWNlICpk
dm8pCj4gICB7Cj4gLQlzdHJ1Y3QgY2g3eHh4X3ByaXYgKmNoN3h4eCA9IGR2by0+ZGV2X3ByaXY7
Cj4gKwlzdHJ1Y3QgY2g3eHh4X3ByaXYgKmNoN3h4eCA9IGR2by0+aTkxNTsKPiAgIAo+ICAgCWlm
IChjaDd4eHgpIHsKPiAgIAkJa2ZyZWUoY2g3eHh4KTsKPiAtCQlkdm8tPmRldl9wcml2ID0gTlVM
TDsKPiArCQlkdm8tPmk5MTUgPSBOVUxMOwo+ICAgCX0KPiAgIH0KPiAgIAo+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kdm9faXZjaC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZHZvX2l2Y2guYwo+IGluZGV4IDA5ZGJhMzVmM2ZmYS4uYzk5YzE2MjExNTY3IDEwMDY0NAo+IC0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2R2b19pdmNoLmMKPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kdm9faXZjaC5jCj4gQEAgLTE5MSw3ICsxOTEsNyBAQCBzdGF0aWMgdm9pZCBpdmNo
X2R1bXBfcmVncyhzdHJ1Y3QgaW50ZWxfZHZvX2RldmljZSAqZHZvKTsKPiAgICAqLwo+ICAgc3Rh
dGljIGJvb2wgaXZjaF9yZWFkKHN0cnVjdCBpbnRlbF9kdm9fZGV2aWNlICpkdm8sIGludCBhZGRy
LCB1MTYgKmRhdGEpCj4gICB7Cj4gLQlzdHJ1Y3QgaXZjaF9wcml2ICpwcml2ID0gZHZvLT5kZXZf
cHJpdjsKPiArCXN0cnVjdCBpdmNoX3ByaXYgKnByaXYgPSBkdm8tPmk5MTU7Cj4gICAJc3RydWN0
IGkyY19hZGFwdGVyICphZGFwdGVyID0gZHZvLT5pMmNfYnVzOwo+ICAgCXU4IG91dF9idWZbMV07
Cj4gICAJdTggaW5fYnVmWzJdOwo+IEBAIC0yMzQsNyArMjM0LDcgQEAgc3RhdGljIGJvb2wgaXZj
aF9yZWFkKHN0cnVjdCBpbnRlbF9kdm9fZGV2aWNlICpkdm8sIGludCBhZGRyLCB1MTYgKmRhdGEp
Cj4gICAvKiBXcml0ZXMgYSAxNi1iaXQgcmVnaXN0ZXIgb24gdGhlIGl2Y2ggKi8KPiAgIHN0YXRp
YyBib29sIGl2Y2hfd3JpdGUoc3RydWN0IGludGVsX2R2b19kZXZpY2UgKmR2bywgaW50IGFkZHIs
IHUxNiBkYXRhKQo+ICAgewo+IC0Jc3RydWN0IGl2Y2hfcHJpdiAqcHJpdiA9IGR2by0+ZGV2X3By
aXY7Cj4gKwlzdHJ1Y3QgaXZjaF9wcml2ICpwcml2ID0gZHZvLT5pOTE1Owo+ICAgCXN0cnVjdCBp
MmNfYWRhcHRlciAqYWRhcHRlciA9IGR2by0+aTJjX2J1czsKPiAgIAl1OCBvdXRfYnVmWzNdOwo+
ICAgCXN0cnVjdCBpMmNfbXNnIG1zZyA9IHsKPiBAQCAtMjcyLDcgKzI3Miw3IEBAIHN0YXRpYyBi
b29sIGl2Y2hfaW5pdChzdHJ1Y3QgaW50ZWxfZHZvX2RldmljZSAqZHZvLAo+ICAgCQlyZXR1cm4g
ZmFsc2U7Cj4gICAKPiAgIAlkdm8tPmkyY19idXMgPSBhZGFwdGVyOwo+IC0JZHZvLT5kZXZfcHJp
diA9IHByaXY7Cj4gKwlkdm8tPmk5MTUgPSBwcml2Owo+ICAgCXByaXYtPnF1aWV0ID0gdHJ1ZTsK
PiAgIAo+ICAgCWlmICghaXZjaF9yZWFkKGR2bywgVlIwMCwgJnRlbXApKQo+IEBAIC0zMjgsNyAr
MzI4LDcgQEAgc3RhdGljIGVudW0gZHJtX21vZGVfc3RhdHVzIGl2Y2hfbW9kZV92YWxpZChzdHJ1
Y3QgaW50ZWxfZHZvX2RldmljZSAqZHZvLAo+ICAgICovCj4gICBzdGF0aWMgdm9pZCBpdmNoX3Jl
c2V0KHN0cnVjdCBpbnRlbF9kdm9fZGV2aWNlICpkdm8pCj4gICB7Cj4gLQlzdHJ1Y3QgaXZjaF9w
cml2ICpwcml2ID0gZHZvLT5kZXZfcHJpdjsKPiArCXN0cnVjdCBpdmNoX3ByaXYgKnByaXYgPSBk
dm8tPmk5MTU7Cj4gICAJaW50IGk7Cj4gICAKPiAgIAlEUk1fREVCVUdfS01TKCJSZXNldHRpbmcg
dGhlIElWQ0ggcmVnaXN0ZXJzXG4iKTsKPiBAQCAtMzk4LDcgKzM5OCw3IEBAIHN0YXRpYyB2b2lk
IGl2Y2hfbW9kZV9zZXQoc3RydWN0IGludGVsX2R2b19kZXZpY2UgKmR2bywKPiAgIAkJCSAgY29u
c3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUsCj4gICAJCQkgIGNvbnN0IHN0cnVjdCBk
cm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlKQo+ICAgewo+IC0Jc3RydWN0IGl2Y2hfcHJp
diAqcHJpdiA9IGR2by0+ZGV2X3ByaXY7Cj4gKwlzdHJ1Y3QgaXZjaF9wcml2ICpwcml2ID0gZHZv
LT5pOTE1Owo+ICAgCXUxNiB2cjQwID0gMDsKPiAgIAl1MTYgdnIwMSA9IDA7Cj4gICAJdTE2IHZy
MTA7Cj4gQEAgLTQ4MywxMSArNDgzLDExIEBAIHN0YXRpYyB2b2lkIGl2Y2hfZHVtcF9yZWdzKHN0
cnVjdCBpbnRlbF9kdm9fZGV2aWNlICpkdm8pCj4gICAKPiAgIHN0YXRpYyB2b2lkIGl2Y2hfZGVz
dHJveShzdHJ1Y3QgaW50ZWxfZHZvX2RldmljZSAqZHZvKQo+ICAgewo+IC0Jc3RydWN0IGl2Y2hf
cHJpdiAqcHJpdiA9IGR2by0+ZGV2X3ByaXY7Cj4gKwlzdHJ1Y3QgaXZjaF9wcml2ICpwcml2ID0g
ZHZvLT5pOTE1Owo+ICAgCj4gICAJaWYgKHByaXYpIHsKPiAgIAkJa2ZyZWUocHJpdik7Cj4gLQkJ
ZHZvLT5kZXZfcHJpdiA9IE5VTEw7Cj4gKwkJZHZvLT5pOTE1ID0gTlVMTDsKPiAgIAl9Cj4gICB9
Cj4gICAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZHZvX25zMjUwMS5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZHZvX25zMjUwMS5jCj4gaW5kZXggYzgzYTVkODhkNjJiLi5h
ZjA0ZmNhYTk4YjggMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZHZvX25zMjUw
MS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZHZvX25zMjUwMS5jCj4gQEAgLTM5Miw3
ICszOTIsNyBAQCBzdHJ1Y3QgbnMyNTAxX3ByaXYgewo+ICAgKi8KPiAgIHN0YXRpYyBib29sIG5z
MjUwMV9yZWFkYihzdHJ1Y3QgaW50ZWxfZHZvX2RldmljZSAqZHZvLCBpbnQgYWRkciwgdTggKmNo
KQo+ICAgewo+IC0Jc3RydWN0IG5zMjUwMV9wcml2ICpucyA9IGR2by0+ZGV2X3ByaXY7Cj4gKwlz
dHJ1Y3QgbnMyNTAxX3ByaXYgKm5zID0gZHZvLT5pOTE1Owo+ICAgCXN0cnVjdCBpMmNfYWRhcHRl
ciAqYWRhcHRlciA9IGR2by0+aTJjX2J1czsKPiAgIAl1OCBvdXRfYnVmWzJdOwo+ICAgCXU4IGlu
X2J1ZlsyXTsKPiBAQCAtNDM3LDcgKzQzNyw3IEBAIHN0YXRpYyBib29sIG5zMjUwMV9yZWFkYihz
dHJ1Y3QgaW50ZWxfZHZvX2RldmljZSAqZHZvLCBpbnQgYWRkciwgdTggKmNoKQo+ICAgKi8KPiAg
IHN0YXRpYyBib29sIG5zMjUwMV93cml0ZWIoc3RydWN0IGludGVsX2R2b19kZXZpY2UgKmR2bywg
aW50IGFkZHIsIHU4IGNoKQo+ICAgewo+IC0Jc3RydWN0IG5zMjUwMV9wcml2ICpucyA9IGR2by0+
ZGV2X3ByaXY7Cj4gKwlzdHJ1Y3QgbnMyNTAxX3ByaXYgKm5zID0gZHZvLT5pOTE1Owo+ICAgCXN0
cnVjdCBpMmNfYWRhcHRlciAqYWRhcHRlciA9IGR2by0+aTJjX2J1czsKPiAgIAl1OCBvdXRfYnVm
WzJdOwo+ICAgCj4gQEAgLTQ4MSw3ICs0ODEsNyBAQCBzdGF0aWMgYm9vbCBuczI1MDFfaW5pdChz
dHJ1Y3QgaW50ZWxfZHZvX2RldmljZSAqZHZvLAo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gICAKPiAg
IAlkdm8tPmkyY19idXMgPSBhZGFwdGVyOwo+IC0JZHZvLT5kZXZfcHJpdiA9IG5zOwo+ICsJZHZv
LT5pOTE1ID0gbnM7Cj4gICAJbnMtPnF1aWV0ID0gdHJ1ZTsKPiAgIAo+ICAgCWlmICghbnMyNTAx
X3JlYWRiKGR2bywgTlMyNTAxX1ZJRF9MTywgJmNoKSkKPiBAQCAtNTUxLDcgKzU1MSw3IEBAIHN0
YXRpYyB2b2lkIG5zMjUwMV9tb2RlX3NldChzdHJ1Y3QgaW50ZWxfZHZvX2RldmljZSAqZHZvLAo+
ICAgCQkJICAgIGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlKQo+
ICAgewo+ICAgCWNvbnN0IHN0cnVjdCBuczI1MDFfY29uZmlndXJhdGlvbiAqY29uZjsKPiAtCXN0
cnVjdCBuczI1MDFfcHJpdiAqbnMgPSAoc3RydWN0IG5zMjUwMV9wcml2ICopKGR2by0+ZGV2X3By
aXYpOwo+ICsJc3RydWN0IG5zMjUwMV9wcml2ICpucyA9IChzdHJ1Y3QgbnMyNTAxX3ByaXYgKiko
ZHZvLT5pOTE1KTsKPiAgIAlpbnQgbW9kZV9pZHgsIGk7Cj4gICAKPiAgIAlEUk1fREVCVUdfS01T
Cj4gQEAgLTY1NSw3ICs2NTUsNyBAQCBzdGF0aWMgYm9vbCBuczI1MDFfZ2V0X2h3X3N0YXRlKHN0
cnVjdCBpbnRlbF9kdm9fZGV2aWNlICpkdm8pCj4gICAvKiBzZXQgdGhlIE5TMjUwMSBwb3dlciBz
dGF0ZSAqLwo+ICAgc3RhdGljIHZvaWQgbnMyNTAxX2RwbXMoc3RydWN0IGludGVsX2R2b19kZXZp
Y2UgKmR2bywgYm9vbCBlbmFibGUpCj4gICB7Cj4gLQlzdHJ1Y3QgbnMyNTAxX3ByaXYgKm5zID0g
KHN0cnVjdCBuczI1MDFfcHJpdiAqKShkdm8tPmRldl9wcml2KTsKPiArCXN0cnVjdCBuczI1MDFf
cHJpdiAqbnMgPSAoc3RydWN0IG5zMjUwMV9wcml2ICopKGR2by0+aTkxNSk7Cj4gICAKPiAgIAlE
Uk1fREVCVUdfS01TKCJUcnlpbmcgc2V0IHRoZSBkcG1zIG9mIHRoZSBEVk8gdG8gJWlcbiIsIGVu
YWJsZSk7Cj4gICAKPiBAQCAtNjkxLDExICs2OTEsMTEgQEAgc3RhdGljIHZvaWQgbnMyNTAxX2Rw
bXMoc3RydWN0IGludGVsX2R2b19kZXZpY2UgKmR2bywgYm9vbCBlbmFibGUpCj4gICAKPiAgIHN0
YXRpYyB2b2lkIG5zMjUwMV9kZXN0cm95KHN0cnVjdCBpbnRlbF9kdm9fZGV2aWNlICpkdm8pCj4g
ICB7Cj4gLQlzdHJ1Y3QgbnMyNTAxX3ByaXYgKm5zID0gZHZvLT5kZXZfcHJpdjsKPiArCXN0cnVj
dCBuczI1MDFfcHJpdiAqbnMgPSBkdm8tPmk5MTU7Cj4gICAKPiAgIAlpZiAobnMpIHsKPiAgIAkJ
a2ZyZWUobnMpOwo+IC0JCWR2by0+ZGV2X3ByaXYgPSBOVUxMOwo+ICsJCWR2by0+aTkxNSA9IE5V
TEw7Cj4gICAJfQo+ICAgfQo+ICAgCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2R2b19zaWwxNjQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2R2b19zaWwxNjQuYwo+IGluZGV4
IDA0Njk4ZWFlYjYzMi4uYTQ1MmRjYmExNzljIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2R2b19zaWwxNjQuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2R2b19zaWwx
NjQuYwo+IEBAIC02OCw3ICs2OCw3IEBAIHN0cnVjdCBzaWwxNjRfcHJpdiB7Cj4gICAKPiAgIHN0
YXRpYyBib29sIHNpbDE2NF9yZWFkYihzdHJ1Y3QgaW50ZWxfZHZvX2RldmljZSAqZHZvLCBpbnQg
YWRkciwgdTggKmNoKQo+ICAgewo+IC0Jc3RydWN0IHNpbDE2NF9wcml2ICpzaWwgPSBkdm8tPmRl
dl9wcml2Owo+ICsJc3RydWN0IHNpbDE2NF9wcml2ICpzaWwgPSBkdm8tPmk5MTU7Cj4gICAJc3Ry
dWN0IGkyY19hZGFwdGVyICphZGFwdGVyID0gZHZvLT5pMmNfYnVzOwo+ICAgCXU4IG91dF9idWZb
Ml07Cj4gICAJdTggaW5fYnVmWzJdOwo+IEBAIC0xMDUsNyArMTA1LDcgQEAgc3RhdGljIGJvb2wg
c2lsMTY0X3JlYWRiKHN0cnVjdCBpbnRlbF9kdm9fZGV2aWNlICpkdm8sIGludCBhZGRyLCB1OCAq
Y2gpCj4gICAKPiAgIHN0YXRpYyBib29sIHNpbDE2NF93cml0ZWIoc3RydWN0IGludGVsX2R2b19k
ZXZpY2UgKmR2bywgaW50IGFkZHIsIHU4IGNoKQo+ICAgewo+IC0Jc3RydWN0IHNpbDE2NF9wcml2
ICpzaWwgPSBkdm8tPmRldl9wcml2Owo+ICsJc3RydWN0IHNpbDE2NF9wcml2ICpzaWwgPSBkdm8t
Pmk5MTU7Cj4gICAJc3RydWN0IGkyY19hZGFwdGVyICphZGFwdGVyID0gZHZvLT5pMmNfYnVzOwo+
ICAgCXU4IG91dF9idWZbMl07Cj4gICAJc3RydWN0IGkyY19tc2cgbXNnID0gewo+IEBAIC0xNDIs
NyArMTQyLDcgQEAgc3RhdGljIGJvb2wgc2lsMTY0X2luaXQoc3RydWN0IGludGVsX2R2b19kZXZp
Y2UgKmR2bywKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAgCj4gICAJZHZvLT5pMmNfYnVzID0gYWRh
cHRlcjsKPiAtCWR2by0+ZGV2X3ByaXYgPSBzaWw7Cj4gKwlkdm8tPmk5MTUgPSBzaWw7Cj4gICAJ
c2lsLT5xdWlldCA9IHRydWU7Cj4gICAKPiAgIAlpZiAoIXNpbDE2NF9yZWFkYihkdm8sIFNJTDE2
NF9WSURfTE8sICZjaCkpCj4gQEAgLTI2MCwxMSArMjYwLDExIEBAIHN0YXRpYyB2b2lkIHNpbDE2
NF9kdW1wX3JlZ3Moc3RydWN0IGludGVsX2R2b19kZXZpY2UgKmR2bykKPiAgIAo+ICAgc3RhdGlj
IHZvaWQgc2lsMTY0X2Rlc3Ryb3koc3RydWN0IGludGVsX2R2b19kZXZpY2UgKmR2bykKPiAgIHsK
PiAtCXN0cnVjdCBzaWwxNjRfcHJpdiAqc2lsID0gZHZvLT5kZXZfcHJpdjsKPiArCXN0cnVjdCBz
aWwxNjRfcHJpdiAqc2lsID0gZHZvLT5pOTE1Owo+ICAgCj4gICAJaWYgKHNpbCkgewo+ICAgCQlr
ZnJlZShzaWwpOwo+IC0JCWR2by0+ZGV2X3ByaXYgPSBOVUxMOwo+ICsJCWR2by0+aTkxNSA9IE5V
TEw7Cj4gICAJfQo+ICAgfQo+ICAgCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2R2b190ZnA0MTAuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2R2b190ZnA0MTAuYwo+IGluZGV4
IDYyMzExNGVlNzNjZC4uOGZmZWQ4OTE0YjQ5IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2R2b190ZnA0MTAuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2R2b190ZnA0
MTAuYwo+IEBAIC05Myw3ICs5Myw3IEBAIHN0cnVjdCB0ZnA0MTBfcHJpdiB7Cj4gICAKPiAgIHN0
YXRpYyBib29sIHRmcDQxMF9yZWFkYihzdHJ1Y3QgaW50ZWxfZHZvX2RldmljZSAqZHZvLCBpbnQg
YWRkciwgdTggKmNoKQo+ICAgewo+IC0Jc3RydWN0IHRmcDQxMF9wcml2ICp0ZnAgPSBkdm8tPmRl
dl9wcml2Owo+ICsJc3RydWN0IHRmcDQxMF9wcml2ICp0ZnAgPSBkdm8tPmk5MTU7Cj4gICAJc3Ry
dWN0IGkyY19hZGFwdGVyICphZGFwdGVyID0gZHZvLT5pMmNfYnVzOwo+ICAgCXU4IG91dF9idWZb
Ml07Cj4gICAJdTggaW5fYnVmWzJdOwo+IEBAIC0xMzAsNyArMTMwLDcgQEAgc3RhdGljIGJvb2wg
dGZwNDEwX3JlYWRiKHN0cnVjdCBpbnRlbF9kdm9fZGV2aWNlICpkdm8sIGludCBhZGRyLCB1OCAq
Y2gpCj4gICAKPiAgIHN0YXRpYyBib29sIHRmcDQxMF93cml0ZWIoc3RydWN0IGludGVsX2R2b19k
ZXZpY2UgKmR2bywgaW50IGFkZHIsIHU4IGNoKQo+ICAgewo+IC0Jc3RydWN0IHRmcDQxMF9wcml2
ICp0ZnAgPSBkdm8tPmRldl9wcml2Owo+ICsJc3RydWN0IHRmcDQxMF9wcml2ICp0ZnAgPSBkdm8t
Pmk5MTU7Cj4gICAJc3RydWN0IGkyY19hZGFwdGVyICphZGFwdGVyID0gZHZvLT5pMmNfYnVzOwo+
ICAgCXU4IG91dF9idWZbMl07Cj4gICAJc3RydWN0IGkyY19tc2cgbXNnID0gewo+IEBAIC0xNzgs
NyArMTc4LDcgQEAgc3RhdGljIGJvb2wgdGZwNDEwX2luaXQoc3RydWN0IGludGVsX2R2b19kZXZp
Y2UgKmR2bywKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAgCj4gICAJZHZvLT5pMmNfYnVzID0gYWRh
cHRlcjsKPiAtCWR2by0+ZGV2X3ByaXYgPSB0ZnA7Cj4gKwlkdm8tPmk5MTUgPSB0ZnA7Cj4gICAJ
dGZwLT5xdWlldCA9IHRydWU7Cj4gICAKPiAgIAlpZiAoKGlkID0gdGZwNDEwX2dldGlkKGR2bywg
VEZQNDEwX1ZJRF9MTykpICE9IFRGUDQxMF9WSUQpIHsKPiBAQCAtMjk5LDExICsyOTksMTEgQEAg
c3RhdGljIHZvaWQgdGZwNDEwX2R1bXBfcmVncyhzdHJ1Y3QgaW50ZWxfZHZvX2RldmljZSAqZHZv
KQo+ICAgCj4gICBzdGF0aWMgdm9pZCB0ZnA0MTBfZGVzdHJveShzdHJ1Y3QgaW50ZWxfZHZvX2Rl
dmljZSAqZHZvKQo+ICAgewo+IC0Jc3RydWN0IHRmcDQxMF9wcml2ICp0ZnAgPSBkdm8tPmRldl9w
cml2Owo+ICsJc3RydWN0IHRmcDQxMF9wcml2ICp0ZnAgPSBkdm8tPmk5MTU7Cj4gICAKPiAgIAlp
ZiAodGZwKSB7Cj4gICAJCWtmcmVlKHRmcCk7Cj4gLQkJZHZvLT5kZXZfcHJpdiA9IE5VTEw7Cj4g
KwkJZHZvLT5pOTE1ID0gTlVMTDsKPiAgIAl9Cj4gICB9Cj4gICAKPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKPiBpbmRleCBjODZjYTlmMjE1MzIuLjJmYTY3
NDdjN2I2ZSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
Y29udGV4dC5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRl
eHQuYwo+IEBAIC00OTUsMjcgKzQ5NSwyNyBAQCBzdGF0aWMgdm9pZCBfX2Fzc2lnbl9wcGd0dChz
dHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAo+ICAgfQo+ICAgCj4gICBzdGF0aWMgc3RydWN0
IGk5MTVfZ2VtX2NvbnRleHQgKgo+IC1pOTE1X2dlbV9jcmVhdGVfY29udGV4dChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHVuc2lnbmVkIGludCBmbGFncykKPiAraTkxNV9nZW1f
Y3JlYXRlX2NvbnRleHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHVuc2lnbmVkIGlu
dCBmbGFncykKPiAgIHsKPiAgIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4Owo+ICAgCj4g
LQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gKwls
b2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAo+ICAgCWlm
IChmbGFncyAmIEk5MTVfQ09OVEVYVF9DUkVBVEVfRkxBR1NfU0lOR0xFX1RJTUVMSU5FICYmCj4g
LQkgICAgIUhBU19FWEVDTElTVFMoZGV2X3ByaXYpKQo+ICsJICAgICFIQVNfRVhFQ0xJU1RTKGk5
MTUpKQo+ICAgCQlyZXR1cm4gRVJSX1BUUigtRUlOVkFMKTsKPiAgIAo+ICAgCS8qIFJlYXAgdGhl
IG1vc3Qgc3RhbGUgY29udGV4dCAqLwo+IC0JY29udGV4dHNfZnJlZV9maXJzdChkZXZfcHJpdik7
Cj4gKwljb250ZXh0c19mcmVlX2ZpcnN0KGk5MTUpOwo+ICAgCj4gLQljdHggPSBfX2NyZWF0ZV9j
b250ZXh0KGRldl9wcml2KTsKPiArCWN0eCA9IF9fY3JlYXRlX2NvbnRleHQoaTkxNSk7Cj4gICAJ
aWYgKElTX0VSUihjdHgpKQo+ICAgCQlyZXR1cm4gY3R4Owo+ICAgCj4gLQlpZiAoSEFTX0ZVTExf
UFBHVFQoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSEFTX0ZVTExfUFBHVFQoaTkxNSkpIHsKPiAgIAkJ
c3RydWN0IGk5MTVfcHBndHQgKnBwZ3R0Owo+ICAgCj4gLQkJcHBndHQgPSBpOTE1X3BwZ3R0X2Ny
ZWF0ZShkZXZfcHJpdik7Cj4gKwkJcHBndHQgPSBpOTE1X3BwZ3R0X2NyZWF0ZShpOTE1KTsKPiAg
IAkJaWYgKElTX0VSUihwcGd0dCkpIHsKPiAgIAkJCURSTV9ERUJVR19EUklWRVIoIlBQR1RUIHNl
dHVwIGZhaWxlZCAoJWxkKVxuIiwKPiAgIAkJCQkJIFBUUl9FUlIocHBndHQpKTsKPiBAQCAtNTMw
LDcgKzUzMCw3IEBAIGk5MTVfZ2VtX2NyZWF0ZV9jb250ZXh0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwgdW5zaWduZWQgaW50IGZsYWdzKQo+ICAgCWlmIChmbGFncyAmIEk5MTVf
Q09OVEVYVF9DUkVBVEVfRkxBR1NfU0lOR0xFX1RJTUVMSU5FKSB7Cj4gICAJCXN0cnVjdCBpOTE1
X3RpbWVsaW5lICp0aW1lbGluZTsKPiAgIAo+IC0JCXRpbWVsaW5lID0gaTkxNV90aW1lbGluZV9j
cmVhdGUoZGV2X3ByaXYsIE5VTEwpOwo+ICsJCXRpbWVsaW5lID0gaTkxNV90aW1lbGluZV9jcmVh
dGUoaTkxNSwgTlVMTCk7Cj4gICAJCWlmIChJU19FUlIodGltZWxpbmUpKSB7Cj4gICAJCQljb250
ZXh0X2Nsb3NlKGN0eCk7Cj4gICAJCQlyZXR1cm4gRVJSX0NBU1QodGltZWxpbmUpOwo+IEBAIC02
NDksMTkgKzY0OSwxOSBAQCBzdGF0aWMgYm9vbCBuZWVkc19wcmVlbXB0X2NvbnRleHQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICAJcmV0dXJuIEhBU19FWEVDTElTVFMoaTkxNSk7
Cj4gICB9Cj4gICAKPiAtaW50IGk5MTVfZ2VtX2NvbnRleHRzX2luaXQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ICtpbnQgaTkxNV9nZW1fY29udGV4dHNfaW5pdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4
dCAqY3R4Owo+ICAgCj4gICAJLyogUmVhc3N1cmUgb3Vyc2VsdmVzIHdlIGFyZSBvbmx5IGNhbGxl
ZCBvbmNlICovCj4gLQlHRU1fQlVHX09OKGRldl9wcml2LT5rZXJuZWxfY29udGV4dCk7Cj4gLQlH
RU1fQlVHX09OKGRldl9wcml2LT5wcmVlbXB0X2NvbnRleHQpOwo+ICsJR0VNX0JVR19PTihpOTE1
LT5rZXJuZWxfY29udGV4dCk7Cj4gKwlHRU1fQlVHX09OKGk5MTUtPnByZWVtcHRfY29udGV4dCk7
Cj4gICAKPiAtCWludGVsX2VuZ2luZV9pbml0X2N0eF93YShkZXZfcHJpdi0+ZW5naW5lW1JDUzBd
KTsKPiAtCWluaXRfY29udGV4dHMoZGV2X3ByaXYpOwo+ICsJaW50ZWxfZW5naW5lX2luaXRfY3R4
X3dhKGk5MTUtPmVuZ2luZVtSQ1MwXSk7Cj4gKwlpbml0X2NvbnRleHRzKGk5MTUpOwo+ICAgCj4g
ICAJLyogbG93ZXN0IHByaW9yaXR5OyBpZGxlIHRhc2sgKi8KPiAtCWN0eCA9IGk5MTVfZ2VtX2Nv
bnRleHRfY3JlYXRlX2tlcm5lbChkZXZfcHJpdiwgSTkxNV9QUklPUklUWV9NSU4pOwo+ICsJY3R4
ID0gaTkxNV9nZW1fY29udGV4dF9jcmVhdGVfa2VybmVsKGk5MTUsIEk5MTVfUFJJT1JJVFlfTUlO
KTsKPiAgIAlpZiAoSVNfRVJSKGN0eCkpIHsKPiAgIAkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gY3Jl
YXRlIGRlZmF1bHQgZ2xvYmFsIGNvbnRleHRcbiIpOwo+ICAgCQlyZXR1cm4gUFRSX0VSUihjdHgp
Owo+IEBAIC02NzUsMzEgKzY3NSwzMSBAQCBpbnQgaTkxNV9nZW1fY29udGV4dHNfaW5pdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICovCj4gICAJR0VNX0JVR19PTihj
dHgtPmh3X2lkKTsKPiAgIAlHRU1fQlVHX09OKCFhdG9taWNfcmVhZCgmY3R4LT5od19pZF9waW5f
Y291bnQpKTsKPiAtCWRldl9wcml2LT5rZXJuZWxfY29udGV4dCA9IGN0eDsKPiArCWk5MTUtPmtl
cm5lbF9jb250ZXh0ID0gY3R4Owo+ICAgCj4gICAJLyogaGlnaGVzdCBwcmlvcml0eTsgcHJlZW1w
dGluZyB0YXNrICovCj4gLQlpZiAobmVlZHNfcHJlZW1wdF9jb250ZXh0KGRldl9wcml2KSkgewo+
IC0JCWN0eCA9IGk5MTVfZ2VtX2NvbnRleHRfY3JlYXRlX2tlcm5lbChkZXZfcHJpdiwgSU5UX01B
WCk7Cj4gKwlpZiAobmVlZHNfcHJlZW1wdF9jb250ZXh0KGk5MTUpKSB7Cj4gKwkJY3R4ID0gaTkx
NV9nZW1fY29udGV4dF9jcmVhdGVfa2VybmVsKGk5MTUsIElOVF9NQVgpOwo+ICAgCQlpZiAoIUlT
X0VSUihjdHgpKQo+IC0JCQlkZXZfcHJpdi0+cHJlZW1wdF9jb250ZXh0ID0gY3R4Owo+ICsJCQlp
OTE1LT5wcmVlbXB0X2NvbnRleHQgPSBjdHg7Cj4gICAJCWVsc2UKPiAgIAkJCURSTV9FUlJPUigi
RmFpbGVkIHRvIGNyZWF0ZSBwcmVlbXB0IGNvbnRleHQ7IGRpc2FibGluZyBwcmVlbXB0aW9uXG4i
KTsKPiAgIAl9Cj4gICAKPiAgIAlEUk1fREVCVUdfRFJJVkVSKCIlcyBjb250ZXh0IHN1cHBvcnQg
aW5pdGlhbGl6ZWRcbiIsCj4gLQkJCSBEUklWRVJfQ0FQUyhkZXZfcHJpdiktPmhhc19sb2dpY2Fs
X2NvbnRleHRzID8KPiArCQkJIERSSVZFUl9DQVBTKGk5MTUpLT5oYXNfbG9naWNhbF9jb250ZXh0
cyA/Cj4gICAJCQkgImxvZ2ljYWwiIDogImZha2UiKTsKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAg
IAo+IC12b2lkIGk5MTVfZ2VtX2NvbnRleHRzX2xvc3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICt2b2lkIGk5MTVfZ2VtX2NvbnRleHRzX2xvc3Qoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
Owo+ICAgCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwo+ICAgCj4gLQlsb2NrZGVwX2Fzc2VydF9o
ZWxkKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gKwlsb2NrZGVwX2Fzc2VydF9oZWxk
KCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAo+IC0JZm9yX2VhY2hfZW5naW5lKGVuZ2lu
ZSwgZGV2X3ByaXYsIGlkKQo+ICsJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpCj4g
ICAJCWludGVsX2VuZ2luZV9sb3N0X2NvbnRleHQoZW5naW5lKTsKPiAgIH0KPiAgIAo+IEBAIC0y
MzY4LDcgKzIzNjgsNyBAQCBpbnQgaTkxNV9nZW1fY29udGV4dF9zZXRwYXJhbV9pb2N0bChzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ICAgaW50IGk5MTVfZ2VtX2NvbnRleHRf
cmVzZXRfc3RhdHNfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiAgIAkJCQkgICAgICAg
dm9pZCAqZGF0YSwgc3RydWN0IGRybV9maWxlICpmaWxlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJc3RydWN0IGRybV9pOTE1X3Jlc2V0
X3N0YXRzICphcmdzID0gZGF0YTsKPiAgIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4Owo+
ICAgCWludCByZXQ7Cj4gQEAgLTIzOTAsNyArMjM5MCw3IEBAIGludCBpOTE1X2dlbV9jb250ZXh0
X3Jlc2V0X3N0YXRzX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gICAJICovCj4gICAK
PiAgIAlpZiAoY2FwYWJsZShDQVBfU1lTX0FETUlOKSkKPiAtCQlhcmdzLT5yZXNldF9jb3VudCA9
IGk5MTVfcmVzZXRfY291bnQoJmRldl9wcml2LT5ncHVfZXJyb3IpOwo+ICsJCWFyZ3MtPnJlc2V0
X2NvdW50ID0gaTkxNV9yZXNldF9jb3VudCgmaTkxNS0+Z3B1X2Vycm9yKTsKPiAgIAllbHNlCj4g
ICAJCWFyZ3MtPnJlc2V0X2NvdW50ID0gMDsKPiAgIAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX2NvbnRleHQuaAo+IGluZGV4IDYzMDM5MmM3N2U0OC4uZjU1Y2I4ZWFlODdh
IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0
LmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5oCj4g
QEAgLTEzMyw5ICsxMzMsOSBAQCBzdGF0aWMgaW5saW5lIGJvb2wgaTkxNV9nZW1fY29udGV4dF9p
c19rZXJuZWwoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKPiAgIH0KPiAgIAo+ICAgLyog
aTkxNV9nZW1fY29udGV4dC5jICovCj4gLWludCBfX211c3RfY2hlY2sgaTkxNV9nZW1fY29udGV4
dHNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGk5MTVf
Z2VtX2NvbnRleHRzX2xvc3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAt
dm9pZCBpOTE1X2dlbV9jb250ZXh0c19maW5pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdik7Cj4gK2ludCBfX211c3RfY2hlY2sgaTkxNV9nZW1fY29udGV4dHNfaW5pdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgaTkxNV9nZW1fY29udGV4dHNfbG9zdChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgaTkxNV9nZW1fY29udGV4dHNf
ZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICAKPiAgIGludCBpOTE1X2dl
bV9jb250ZXh0X29wZW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgIHN0
cnVjdCBkcm1fZmlsZSAqZmlsZSk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fZXhlY2J1ZmZlci5jCj4gaW5kZXggNTI4ZWVhNDRkY2NmLi44M2Q2NDU4MGEyZjIgMTAw
NjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIu
Ywo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMK
PiBAQCAtMjA5OSw3ICsyMDk5LDcgQEAgc3RhdGljIGludCBlYl9zdWJtaXQoc3RydWN0IGk5MTVf
ZXhlY2J1ZmZlciAqZWIpCj4gICAgKiBUaGUgZW5naW5lIGluZGV4IGlzIHJldHVybmVkLgo+ICAg
ICovCj4gICBzdGF0aWMgdW5zaWduZWQgaW50Cj4gLWdlbjhfZGlzcGF0Y2hfYnNkX2VuZ2luZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2dlbjhfZGlzcGF0Y2hfYnNkX2Vu
Z2luZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSBzdHJ1Y3QgZHJtX2Zp
bGUgKmZpbGUpCj4gICB7Cj4gICAJc3RydWN0IGRybV9pOTE1X2ZpbGVfcHJpdmF0ZSAqZmlsZV9w
cml2ID0gZmlsZS0+ZHJpdmVyX3ByaXY7Cj4gQEAgLTIxMDcsNyArMjEwNyw3IEBAIGdlbjhfZGlz
cGF0Y2hfYnNkX2VuZ2luZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJ
LyogQ2hlY2sgd2hldGhlciB0aGUgZmlsZV9wcml2IGhhcyBhbHJlYWR5IHNlbGVjdGVkIG9uZSBy
aW5nLiAqLwo+ICAgCWlmICgoaW50KWZpbGVfcHJpdi0+YnNkX2VuZ2luZSA8IDApCj4gICAJCWZp
bGVfcHJpdi0+YnNkX2VuZ2luZSA9IGF0b21pY19mZXRjaF94b3IoMSwKPiAtCQkJICZkZXZfcHJp
di0+bW0uYnNkX2VuZ2luZV9kaXNwYXRjaF9pbmRleCk7Cj4gKwkJCSAmaTkxNS0+bW0uYnNkX2Vu
Z2luZV9kaXNwYXRjaF9pbmRleCk7Cj4gICAKPiAgIAlyZXR1cm4gZmlsZV9wcml2LT5ic2RfZW5n
aW5lOwo+ICAgfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fb2JqZWN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMK
PiBpbmRleCAzNmI3NmM2YTBhOWQuLmEzN2YwYWRhYzE2ZSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMKPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMKPiBAQCAtMzY3LDcgKzM2Nyw3IEBAIHZvaWQK
PiAgIGk5MTVfZ2VtX29iamVjdF9mbHVzaF93cml0ZV9kb21haW4oc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKm9iaiwKPiAgIAkJCQkgICB1bnNpZ25lZCBpbnQgZmx1c2hfZG9tYWlucykKPiAg
IHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUob2JqLT5i
YXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUob2Jq
LT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGk5MTVfdm1hICp2bWE7Cj4gICAKPiAgIAlhc3NlcnRf
b2JqZWN0X2hlbGQob2JqKTsKPiBAQCAtMzc3LDcgKzM3Nyw3IEBAIGk5MTVfZ2VtX29iamVjdF9m
bHVzaF93cml0ZV9kb21haW4oc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKPiAgIAo+
ICAgCXN3aXRjaCAob2JqLT53cml0ZV9kb21haW4pIHsKPiAgIAljYXNlIEk5MTVfR0VNX0RPTUFJ
Tl9HVFQ6Cj4gLQkJaTkxNV9nZW1fZmx1c2hfZ2d0dF93cml0ZXMoZGV2X3ByaXYpOwo+ICsJCWk5
MTVfZ2VtX2ZsdXNoX2dndHRfd3JpdGVzKGk5MTUpOwo+ICAgCj4gICAJCWludGVsX2ZiX29ial9m
bHVzaChvYmosCj4gICAJCQkJICAgZmJfd3JpdGVfb3JpZ2luKG9iaiwgSTkxNV9HRU1fRE9NQUlO
X0dUVCkpOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
c2htZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9zaG1lbS5jCj4gaW5k
ZXggMTlkOWVjZGIyODk0Li5lYjRhYWU2NWY2ZTQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3NobWVtLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fc2htZW0uYwo+IEBAIC01MjEsNyArNTIxLDcgQEAgaTkxNV9nZW1fb2Jq
ZWN0X2NyZWF0ZV9zaG1lbShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTY0IHNpemUp
Cj4gICAKPiAgIC8qIEFsbG9jYXRlIGEgbmV3IEdFTSBvYmplY3QgYW5kIGZpbGwgaXQgd2l0aCB0
aGUgc3VwcGxpZWQgZGF0YSAqLwo+ICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKgo+IC1p
OTE1X2dlbV9vYmplY3RfY3JlYXRlX3NobWVtX2Zyb21fZGF0YShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gK2k5MTVfZ2VtX29iamVjdF9jcmVhdGVfc2htZW1fZnJvbV9kYXRh
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgICAgICBjb25zdCB2b2lk
ICpkYXRhLCBzaXplX3Qgc2l6ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVj
dCAqb2JqOwo+IEBAIC01MjksNyArNTI5LDcgQEAgaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zaG1l
bV9mcm9tX2RhdGEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCXNpemVf
dCBvZmZzZXQ7Cj4gICAJaW50IGVycjsKPiAgIAo+IC0Jb2JqID0gaTkxNV9nZW1fb2JqZWN0X2Ny
ZWF0ZV9zaG1lbShkZXZfcHJpdiwgcm91bmRfdXAoc2l6ZSwgUEFHRV9TSVpFKSk7Cj4gKwlvYmog
PSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3NobWVtKGk5MTUsIHJvdW5kX3VwKHNpemUsIFBBR0Vf
U0laRSkpOwo+ICAgCWlmIChJU19FUlIob2JqKSkKPiAgIAkJcmV0dXJuIG9iajsKPiAgIAo+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fc3RvbGVuLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fc3RvbGVuLmMKPiBpbmRleCBkZTFmYWIy
MDU4ZWMuLjI0ZTE3NGYwNjlmMyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fc3RvbGVuLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fc3RvbGVuLmMKPiBAQCAtMjQsNDggKzI0LDQ4IEBACj4gICAgKiBmb3IgaXMgYSBib29u
Lgo+ICAgICovCj4gICAKPiAtaW50IGk5MTVfZ2VtX3N0b2xlbl9pbnNlcnRfbm9kZV9pbl9yYW5n
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2ludCBpOTE1X2dlbV9zdG9s
ZW5faW5zZXJ0X25vZGVfaW5fcmFuZ2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
ICAJCQkJCSBzdHJ1Y3QgZHJtX21tX25vZGUgKm5vZGUsIHU2NCBzaXplLAo+ICAgCQkJCQkgdW5z
aWduZWQgYWxpZ25tZW50LCB1NjQgc3RhcnQsIHU2NCBlbmQpCj4gICB7Cj4gICAJaW50IHJldDsK
PiAgIAo+IC0JaWYgKCFkcm1fbW1faW5pdGlhbGl6ZWQoJmRldl9wcml2LT5tbS5zdG9sZW4pKQo+
ICsJaWYgKCFkcm1fbW1faW5pdGlhbGl6ZWQoJmk5MTUtPm1tLnN0b2xlbikpCj4gICAJCXJldHVy
biAtRU5PREVWOwo+ICAgCj4gICAJLyogV2FTa2lwU3RvbGVuTWVtb3J5Rmlyc3RQYWdlOmJkdysg
Ki8KPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDggJiYgc3RhcnQgPCA0MDk2KQo+ICsJ
aWYgKElOVEVMX0dFTihpOTE1KSA+PSA4ICYmIHN0YXJ0IDwgNDA5NikKPiAgIAkJc3RhcnQgPSA0
MDk2Owo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+bW0uc3RvbGVuX2xvY2spOwo+IC0J
cmV0ID0gZHJtX21tX2luc2VydF9ub2RlX2luX3JhbmdlKCZkZXZfcHJpdi0+bW0uc3RvbGVuLCBu
b2RlLAo+ICsJbXV0ZXhfbG9jaygmaTkxNS0+bW0uc3RvbGVuX2xvY2spOwo+ICsJcmV0ID0gZHJt
X21tX2luc2VydF9ub2RlX2luX3JhbmdlKCZpOTE1LT5tbS5zdG9sZW4sIG5vZGUsCj4gICAJCQkJ
CSAgc2l6ZSwgYWxpZ25tZW50LCAwLAo+ICAgCQkJCQkgIHN0YXJ0LCBlbmQsIERSTV9NTV9JTlNF
UlRfQkVTVCk7Cj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5tbS5zdG9sZW5fbG9jayk7Cj4g
KwltdXRleF91bmxvY2soJmk5MTUtPm1tLnN0b2xlbl9sb2NrKTsKPiAgIAo+ICAgCXJldHVybiBy
ZXQ7Cj4gICB9Cj4gICAKPiAtaW50IGk5MTVfZ2VtX3N0b2xlbl9pbnNlcnRfbm9kZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2ludCBpOTE1X2dlbV9zdG9sZW5faW5zZXJ0
X25vZGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJc3RydWN0IGRybV9t
bV9ub2RlICpub2RlLCB1NjQgc2l6ZSwKPiAgIAkJCQl1bnNpZ25lZCBhbGlnbm1lbnQpCj4gICB7
Cj4gLQlyZXR1cm4gaTkxNV9nZW1fc3RvbGVuX2luc2VydF9ub2RlX2luX3JhbmdlKGRldl9wcml2
LCBub2RlLCBzaXplLAo+ICsJcmV0dXJuIGk5MTVfZ2VtX3N0b2xlbl9pbnNlcnRfbm9kZV9pbl9y
YW5nZShpOTE1LCBub2RlLCBzaXplLAo+ICAgCQkJCQkJICAgIGFsaWdubWVudCwgMCwgVTY0X01B
WCk7Cj4gICB9Cj4gICAKPiAtdm9pZCBpOTE1X2dlbV9zdG9sZW5fcmVtb3ZlX25vZGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICt2b2lkIGk5MTVfZ2VtX3N0b2xlbl9yZW1v
dmVfbm9kZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgc3RydWN0IGRy
bV9tbV9ub2RlICpub2RlKQo+ICAgewo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPm1tLnN0b2xl
bl9sb2NrKTsKPiArCW11dGV4X2xvY2soJmk5MTUtPm1tLnN0b2xlbl9sb2NrKTsKPiAgIAlkcm1f
bW1fcmVtb3ZlX25vZGUobm9kZSk7Cj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5tbS5zdG9s
ZW5fbG9jayk7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPm1tLnN0b2xlbl9sb2NrKTsKPiAgIH0K
PiAgIAo+IC1zdGF0aWMgaW50IGk5MTVfYWRqdXN0X3N0b2xlbihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBpbnQgaTkxNV9hZGp1c3Rfc3RvbGVuKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgICAgc3RydWN0IHJlc291cmNlICpkc20p
Cj4gICB7Cj4gLQlzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0ID0gJmRldl9wcml2LT5nZ3R0Owo+ICsJ
c3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCA9ICZpOTE1LT5nZ3R0Owo+ICAgCXN0cnVjdCByZXNvdXJj
ZSAqcjsKPiAgIAo+ICAgCWlmIChkc20tPnN0YXJ0ID09IDAgfHwgZHNtLT5lbmQgPD0gZHNtLT5z
dGFydCkKPiBAQCAtNzcsMTQgKzc3LDE0IEBAIHN0YXRpYyBpbnQgaTkxNV9hZGp1c3Rfc3RvbGVu
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkgKi8KPiAgIAo+ICAgCS8q
IE1ha2Ugc3VyZSB3ZSBkb24ndCBjbG9iYmVyIHRoZSBHVFQgaWYgaXQncyB3aXRoaW4gc3RvbGVu
IG1lbW9yeSAqLwo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPD0gNCAmJgo+IC0JICAgICFJ
U19HMzMoZGV2X3ByaXYpICYmICFJU19QSU5FVklFVyhkZXZfcHJpdikgJiYgIUlTX0c0WChkZXZf
cHJpdikpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPD0gNCAmJgo+ICsJICAgICFJU19HMzMo
aTkxNSkgJiYgIUlTX1BJTkVWSUVXKGk5MTUpICYmICFJU19HNFgoaTkxNSkpIHsKPiAgIAkJc3Ry
dWN0IHJlc291cmNlIHN0b2xlblsyXSA9IHsqZHNtLCAqZHNtfTsKPiAgIAkJc3RydWN0IHJlc291
cmNlIGdndHRfcmVzOwo+ICAgCQlyZXNvdXJjZV9zaXplX3QgZ2d0dF9zdGFydDsKPiAgIAo+ICAg
CQlnZ3R0X3N0YXJ0ID0gSTkxNV9SRUFEKFBHVEJMX0NUTCk7Cj4gLQkJaWYgKElTX0dFTihkZXZf
cHJpdiwgNCkpCj4gKwkJaWYgKElTX0dFTihpOTE1LCA0KSkKPiAgIAkJCWdndHRfc3RhcnQgPSAo
Z2d0dF9zdGFydCAmIFBHVEJMX0FERFJFU1NfTE9fTUFTSykgfAo+ICAgCQkJCSAgICAgKGdndHRf
c3RhcnQgJiBQR1RCTF9BRERSRVNTX0hJX01BU0spIDw8IDI4Owo+ICAgCQllbHNlCj4gQEAgLTEx
OCw3ICsxMTgsNyBAQCBzdGF0aWMgaW50IGk5MTVfYWRqdXN0X3N0b2xlbihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJICoga2VybmVsLiBTbyBpZiB0aGUgcmVnaW9uIGlz
IGFscmVhZHkgbWFya2VkIGFzIGJ1c3ksIHNvbWV0aGluZwo+ICAgCSAqIGlzIHNlcmlvdXNseSB3
cm9uZy4KPiAgIAkgKi8KPiAtCXIgPSBkZXZtX3JlcXVlc3RfbWVtX3JlZ2lvbihkZXZfcHJpdi0+
ZHJtLmRldiwgZHNtLT5zdGFydCwKPiArCXIgPSBkZXZtX3JlcXVlc3RfbWVtX3JlZ2lvbihpOTE1
LT5kcm0uZGV2LCBkc20tPnN0YXJ0LAo+ICAgCQkJCSAgICByZXNvdXJjZV9zaXplKGRzbSksCj4g
ICAJCQkJICAgICJHcmFwaGljcyBTdG9sZW4gTWVtb3J5Iik7Cj4gICAJaWYgKHIgPT0gTlVMTCkg
ewo+IEBAIC0xMzEsMTQgKzEzMSwxNCBAQCBzdGF0aWMgaW50IGk5MTVfYWRqdXN0X3N0b2xlbihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJCSAqIHJlc2VydmF0aW9uIHN0
YXJ0aW5nIGZyb20gMSBpbnN0ZWFkIG9mIDAuCj4gICAJCSAqIFRoZXJlJ3MgYWxzbyBCSU9TIHdp
dGggb2ZmLWJ5LW9uZSBvbiB0aGUgb3RoZXIgZW5kLgo+ICAgCQkgKi8KPiAtCQlyID0gZGV2bV9y
ZXF1ZXN0X21lbV9yZWdpb24oZGV2X3ByaXYtPmRybS5kZXYsIGRzbS0+c3RhcnQgKyAxLAo+ICsJ
CXIgPSBkZXZtX3JlcXVlc3RfbWVtX3JlZ2lvbihpOTE1LT5kcm0uZGV2LCBkc20tPnN0YXJ0ICsg
MSwKPiAgIAkJCQkJICAgIHJlc291cmNlX3NpemUoZHNtKSAtIDIsCj4gICAJCQkJCSAgICAiR3Jh
cGhpY3MgU3RvbGVuIE1lbW9yeSIpOwo+ICAgCQkvKgo+ICAgCQkgKiBHRU4zIGZpcm13YXJlIGxp
a2VzIHRvIHNtYXNoIHBjaSBicmlkZ2VzIGludG8gdGhlIHN0b2xlbgo+ICAgCQkgKiByYW5nZS4g
QXBwYXJlbnRseSB0aGlzIHdvcmtzLgo+ICAgCQkgKi8KPiAtCQlpZiAociA9PSBOVUxMICYmICFJ
U19HRU4oZGV2X3ByaXYsIDMpKSB7Cj4gKwkJaWYgKHIgPT0gTlVMTCAmJiAhSVNfR0VOKGk5MTUs
IDMpKSB7Cj4gICAJCQlEUk1fRVJST1IoImNvbmZsaWN0IGRldGVjdGVkIHdpdGggc3RvbGVuIHJl
Z2lvbjogJXBSXG4iLAo+ICAgCQkJCSAgZHNtKTsKPiAgIAo+IEBAIC0xNDksMjUgKzE0OSwyNSBA
QCBzdGF0aWMgaW50IGk5MTVfYWRqdXN0X3N0b2xlbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gICAJcmV0dXJuIDA7Cj4gICB9Cj4gICAKPiAtdm9pZCBpOTE1X2dlbV9jbGVh
bnVwX3N0b2xlbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgaTkx
NV9nZW1fY2xlYW51cF9zdG9sZW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7
Cj4gLQlpZiAoIWRybV9tbV9pbml0aWFsaXplZCgmZGV2X3ByaXYtPm1tLnN0b2xlbikpCj4gKwlp
ZiAoIWRybV9tbV9pbml0aWFsaXplZCgmaTkxNS0+bW0uc3RvbGVuKSkKPiAgIAkJcmV0dXJuOwo+
ICAgCj4gLQlkcm1fbW1fdGFrZWRvd24oJmRldl9wcml2LT5tbS5zdG9sZW4pOwo+ICsJZHJtX21t
X3Rha2Vkb3duKCZpOTE1LT5tbS5zdG9sZW4pOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGc0
eF9nZXRfc3RvbGVuX3Jlc2VydmVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiArc3RhdGljIHZvaWQgZzR4X2dldF9zdG9sZW5fcmVzZXJ2ZWQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gICAJCQkJICAgIHJlc291cmNlX3NpemVfdCAqYmFzZSwKPiAgIAkJCQkg
ICAgcmVzb3VyY2Vfc2l6ZV90ICpzaXplKQo+ICAgewo+IC0JdTMyIHJlZ192YWwgPSBJOTE1X1JF
QUQoSVNfR000NShkZXZfcHJpdikgPwo+ICsJdTMyIHJlZ192YWwgPSBJOTE1X1JFQUQoSVNfR000
NShpOTE1KSA/Cj4gICAJCQkJQ1RHX1NUT0xFTl9SRVNFUlZFRCA6Cj4gICAJCQkJRUxLX1NUT0xF
Tl9SRVNFUlZFRCk7Cj4gLQlyZXNvdXJjZV9zaXplX3Qgc3RvbGVuX3RvcCA9IGRldl9wcml2LT5k
c20uZW5kICsgMTsKPiArCXJlc291cmNlX3NpemVfdCBzdG9sZW5fdG9wID0gaTkxNS0+ZHNtLmVu
ZCArIDE7Cj4gICAKPiAgIAlEUk1fREVCVUdfRFJJVkVSKCIlc19TVE9MRU5fUkVTRVJWRUQgPSAl
MDh4XG4iLAo+IC0JCQkgSVNfR000NShkZXZfcHJpdikgPyAiQ1RHIiA6ICJFTEsiLCByZWdfdmFs
KTsKPiArCQkJIElTX0dNNDUoaTkxNSkgPyAiQ1RHIiA6ICJFTEsiLCByZWdfdmFsKTsKPiAgIAo+
ICAgCWlmICgocmVnX3ZhbCAmIEc0WF9TVE9MRU5fUkVTRVJWRURfRU5BQkxFKSA9PSAwKQo+ICAg
CQlyZXR1cm47Cj4gQEAgLTE3Niw3ICsxNzYsNyBAQCBzdGF0aWMgdm9pZCBnNHhfZ2V0X3N0b2xl
bl9yZXNlcnZlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJICogV2hl
dGhlciBJTEsgcmVhbGx5IHJldXNlcyB0aGUgRUxLIHJlZ2lzdGVyIGZvciB0aGlzIGlzIHVuY2xl
YXIuCj4gICAJICogTGV0J3Mgc2VlIGlmIHdlIGNhdGNoIGFueW9uZSB3aXRoIHRoaXMgc3VwcG9z
ZWRseSBlbmFibGVkIG9uIElMSy4KPiAgIAkgKi8KPiAtCVdBUk4oSVNfR0VOKGRldl9wcml2LCA1
KSwgIklMSyBzdG9sZW4gcmVzZXJ2ZWQgZm91bmQ/IDB4JTA4eFxuIiwKPiArCVdBUk4oSVNfR0VO
KGk5MTUsIDUpLCAiSUxLIHN0b2xlbiByZXNlcnZlZCBmb3VuZD8gMHglMDh4XG4iLAo+ICAgCSAg
ICAgcmVnX3ZhbCk7Cj4gICAKPiAgIAlpZiAoIShyZWdfdmFsICYgRzRYX1NUT0xFTl9SRVNFUlZF
RF9BRERSMl9NQVNLKSkKPiBAQCAtMTg4LDcgKzE4OCw3IEBAIHN0YXRpYyB2b2lkIGc0eF9nZXRf
c3RvbGVuX3Jlc2VydmVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkq
c2l6ZSA9IHN0b2xlbl90b3AgLSAqYmFzZTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBnZW42
X2dldF9zdG9sZW5fcmVzZXJ2ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICtzdGF0aWMgdm9pZCBnZW42X2dldF9zdG9sZW5fcmVzZXJ2ZWQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gICAJCQkJICAgICByZXNvdXJjZV9zaXplX3QgKmJhc2UsCj4gICAJCQkJ
ICAgICByZXNvdXJjZV9zaXplX3QgKnNpemUpCj4gICB7Cj4gQEAgLTIyMCwxMiArMjIwLDEyIEBA
IHN0YXRpYyB2b2lkIGdlbjZfZ2V0X3N0b2xlbl9yZXNlcnZlZChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gICAJfQo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIHZsdl9nZXRf
c3RvbGVuX3Jlc2VydmVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3Rh
dGljIHZvaWQgdmx2X2dldF9zdG9sZW5fcmVzZXJ2ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCj4gICAJCQkJICAgIHJlc291cmNlX3NpemVfdCAqYmFzZSwKPiAgIAkJCQkgICAgcmVz
b3VyY2Vfc2l6ZV90ICpzaXplKQo+ICAgewo+ICAgCXUzMiByZWdfdmFsID0gSTkxNV9SRUFEKEdF
TjZfU1RPTEVOX1JFU0VSVkVEKTsKPiAtCXJlc291cmNlX3NpemVfdCBzdG9sZW5fdG9wID0gZGV2
X3ByaXYtPmRzbS5lbmQgKyAxOwo+ICsJcmVzb3VyY2Vfc2l6ZV90IHN0b2xlbl90b3AgPSBpOTE1
LT5kc20uZW5kICsgMTsKPiAgIAo+ICAgCURSTV9ERUJVR19EUklWRVIoIkdFTjZfU1RPTEVOX1JF
U0VSVkVEID0gJTA4eFxuIiwgcmVnX3ZhbCk7Cj4gICAKPiBAQCAtMjQ4LDcgKzI0OCw3IEBAIHN0
YXRpYyB2b2lkIHZsdl9nZXRfc3RvbGVuX3Jlc2VydmVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiAgIAkqYmFzZSA9IHN0b2xlbl90b3AgLSAqc2l6ZTsKPiAgIH0KPiAgIAo+
IC1zdGF0aWMgdm9pZCBnZW43X2dldF9zdG9sZW5fcmVzZXJ2ZWQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBnZW43X2dldF9zdG9sZW5fcmVzZXJ2ZWQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgICByZXNvdXJjZV9zaXpl
X3QgKmJhc2UsCj4gICAJCQkJICAgICByZXNvdXJjZV9zaXplX3QgKnNpemUpCj4gICB7Cj4gQEAg
LTI3NCw3ICsyNzQsNyBAQCBzdGF0aWMgdm9pZCBnZW43X2dldF9zdG9sZW5fcmVzZXJ2ZWQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCX0KPiAgIH0KPiAgIAo+IC1zdGF0
aWMgdm9pZCBjaHZfZ2V0X3N0b2xlbl9yZXNlcnZlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGNodl9nZXRfc3RvbGVuX3Jlc2VydmVkKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgICByZXNvdXJjZV9zaXplX3QgKmJhc2Us
Cj4gICAJCQkJICAgIHJlc291cmNlX3NpemVfdCAqc2l6ZSkKPiAgIHsKPiBAQCAtMzA2LDEyICsz
MDYsMTIgQEAgc3RhdGljIHZvaWQgY2h2X2dldF9zdG9sZW5fcmVzZXJ2ZWQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCX0KPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBi
ZHdfZ2V0X3N0b2xlbl9yZXNlcnZlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gK3N0YXRpYyB2b2lkIGJkd19nZXRfc3RvbGVuX3Jlc2VydmVkKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAo+ICAgCQkJCSAgICByZXNvdXJjZV9zaXplX3QgKmJhc2UsCj4gICAJCQkJ
ICAgIHJlc291cmNlX3NpemVfdCAqc2l6ZSkKPiAgIHsKPiAgIAl1MzIgcmVnX3ZhbCA9IEk5MTVf
UkVBRChHRU42X1NUT0xFTl9SRVNFUlZFRCk7Cj4gLQlyZXNvdXJjZV9zaXplX3Qgc3RvbGVuX3Rv
cCA9IGRldl9wcml2LT5kc20uZW5kICsgMTsKPiArCXJlc291cmNlX3NpemVfdCBzdG9sZW5fdG9w
ID0gaTkxNS0+ZHNtLmVuZCArIDE7Cj4gICAKPiAgIAlEUk1fREVCVUdfRFJJVkVSKCJHRU42X1NU
T0xFTl9SRVNFUlZFRCA9ICUwOHhcbiIsIHJlZ192YWwpOwo+ICAgCj4gQEAgLTM1NCwxOSArMzU0
LDE5IEBAIHN0YXRpYyB2b2lkIGljbF9nZXRfc3RvbGVuX3Jlc2VydmVkKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCX0KPiAgIH0KPiAgIAo+IC1pbnQgaTkxNV9nZW1faW5pdF9z
dG9sZW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtpbnQgaTkxNV9nZW1f
aW5pdF9zdG9sZW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJcmVz
b3VyY2Vfc2l6ZV90IHJlc2VydmVkX2Jhc2UsIHN0b2xlbl90b3A7Cj4gICAJcmVzb3VyY2Vfc2l6
ZV90IHJlc2VydmVkX3RvdGFsLCByZXNlcnZlZF9zaXplOwo+ICAgCj4gLQltdXRleF9pbml0KCZk
ZXZfcHJpdi0+bW0uc3RvbGVuX2xvY2spOwo+ICsJbXV0ZXhfaW5pdCgmaTkxNS0+bW0uc3RvbGVu
X2xvY2spOwo+ICAgCj4gLQlpZiAoaW50ZWxfdmdwdV9hY3RpdmUoZGV2X3ByaXYpKSB7Cj4gKwlp
ZiAoaW50ZWxfdmdwdV9hY3RpdmUoaTkxNSkpIHsKPiAgIAkJRFJNX0lORk8oImlHVlQtZyBhY3Rp
dmUsIGRpc2FibGluZyB1c2Ugb2Ygc3RvbGVuIG1lbW9yeVxuIik7Cj4gICAJCXJldHVybiAwOwo+
ICAgCX0KPiAgIAo+IC0JaWYgKGludGVsX3Z0ZF9hY3RpdmUoKSAmJiBJTlRFTF9HRU4oZGV2X3By
aXYpIDwgOCkgewo+ICsJaWYgKGludGVsX3Z0ZF9hY3RpdmUoKSAmJiBJTlRFTF9HRU4oaTkxNSkg
PCA4KSB7Cj4gICAJCURSTV9JTkZPKCJETUFSIGFjdGl2ZSwgZGlzYWJsaW5nIHVzZSBvZiBzdG9s
ZW4gbWVtb3J5XG4iKTsKPiAgIAkJcmV0dXJuIDA7Cj4gICAJfQo+IEBAIC0zNzQsNTUgKzM3NCw1
NSBAQCBpbnQgaTkxNV9nZW1faW5pdF9zdG9sZW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ICAgCWlmIChyZXNvdXJjZV9zaXplKCZpbnRlbF9ncmFwaGljc19zdG9sZW5fcmVz
KSA9PSAwKQo+ICAgCQlyZXR1cm4gMDsKPiAgIAo+IC0JZGV2X3ByaXYtPmRzbSA9IGludGVsX2dy
YXBoaWNzX3N0b2xlbl9yZXM7Cj4gKwlpOTE1LT5kc20gPSBpbnRlbF9ncmFwaGljc19zdG9sZW5f
cmVzOwo+ICAgCj4gLQlpZiAoaTkxNV9hZGp1c3Rfc3RvbGVuKGRldl9wcml2LCAmZGV2X3ByaXYt
PmRzbSkpCj4gKwlpZiAoaTkxNV9hZGp1c3Rfc3RvbGVuKGk5MTUsICZpOTE1LT5kc20pKQo+ICAg
CQlyZXR1cm4gMDsKPiAgIAo+IC0JR0VNX0JVR19PTihkZXZfcHJpdi0+ZHNtLnN0YXJ0ID09IDAp
Owo+IC0JR0VNX0JVR19PTihkZXZfcHJpdi0+ZHNtLmVuZCA8PSBkZXZfcHJpdi0+ZHNtLnN0YXJ0
KTsKPiArCUdFTV9CVUdfT04oaTkxNS0+ZHNtLnN0YXJ0ID09IDApOwo+ICsJR0VNX0JVR19PTihp
OTE1LT5kc20uZW5kIDw9IGk5MTUtPmRzbS5zdGFydCk7Cj4gICAKPiAtCXN0b2xlbl90b3AgPSBk
ZXZfcHJpdi0+ZHNtLmVuZCArIDE7Cj4gKwlzdG9sZW5fdG9wID0gaTkxNS0+ZHNtLmVuZCArIDE7
Cj4gICAJcmVzZXJ2ZWRfYmFzZSA9IHN0b2xlbl90b3A7Cj4gICAJcmVzZXJ2ZWRfc2l6ZSA9IDA7
Cj4gICAKPiAtCXN3aXRjaCAoSU5URUxfR0VOKGRldl9wcml2KSkgewo+ICsJc3dpdGNoIChJTlRF
TF9HRU4oaTkxNSkpIHsKPiAgIAljYXNlIDI6Cj4gICAJY2FzZSAzOgo+ICAgCQlicmVhazsKPiAg
IAljYXNlIDQ6Cj4gLQkJaWYgKCFJU19HNFgoZGV2X3ByaXYpKQo+ICsJCWlmICghSVNfRzRYKGk5
MTUpKQo+ICAgCQkJYnJlYWs7Cj4gICAJCS8qIGZhbGwgdGhyb3VnaCAqLwo+ICAgCWNhc2UgNToK
PiAtCQlnNHhfZ2V0X3N0b2xlbl9yZXNlcnZlZChkZXZfcHJpdiwKPiArCQlnNHhfZ2V0X3N0b2xl
bl9yZXNlcnZlZChpOTE1LAo+ICAgCQkJCQkmcmVzZXJ2ZWRfYmFzZSwgJnJlc2VydmVkX3NpemUp
Owo+ICAgCQlicmVhazsKPiAgIAljYXNlIDY6Cj4gLQkJZ2VuNl9nZXRfc3RvbGVuX3Jlc2VydmVk
KGRldl9wcml2LAo+ICsJCWdlbjZfZ2V0X3N0b2xlbl9yZXNlcnZlZChpOTE1LAo+ICAgCQkJCQkg
JnJlc2VydmVkX2Jhc2UsICZyZXNlcnZlZF9zaXplKTsKPiAgIAkJYnJlYWs7Cj4gICAJY2FzZSA3
Ogo+IC0JCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkKPiAtCQkJdmx2X2dldF9zdG9sZW5f
cmVzZXJ2ZWQoZGV2X3ByaXYsCj4gKwkJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkpCj4gKwkJCXZs
dl9nZXRfc3RvbGVuX3Jlc2VydmVkKGk5MTUsCj4gICAJCQkJCQkmcmVzZXJ2ZWRfYmFzZSwgJnJl
c2VydmVkX3NpemUpOwo+ICAgCQllbHNlCj4gLQkJCWdlbjdfZ2V0X3N0b2xlbl9yZXNlcnZlZChk
ZXZfcHJpdiwKPiArCQkJZ2VuN19nZXRfc3RvbGVuX3Jlc2VydmVkKGk5MTUsCj4gICAJCQkJCQkg
JnJlc2VydmVkX2Jhc2UsICZyZXNlcnZlZF9zaXplKTsKPiAgIAkJYnJlYWs7Cj4gICAJY2FzZSA4
Ogo+ICAgCWNhc2UgOToKPiAgIAljYXNlIDEwOgo+IC0JCWlmIChJU19MUChkZXZfcHJpdikpCj4g
LQkJCWNodl9nZXRfc3RvbGVuX3Jlc2VydmVkKGRldl9wcml2LAo+ICsJCWlmIChJU19MUChpOTE1
KSkKPiArCQkJY2h2X2dldF9zdG9sZW5fcmVzZXJ2ZWQoaTkxNSwKPiAgIAkJCQkJCSZyZXNlcnZl
ZF9iYXNlLCAmcmVzZXJ2ZWRfc2l6ZSk7Cj4gICAJCWVsc2UKPiAtCQkJYmR3X2dldF9zdG9sZW5f
cmVzZXJ2ZWQoZGV2X3ByaXYsCj4gKwkJCWJkd19nZXRfc3RvbGVuX3Jlc2VydmVkKGk5MTUsCj4g
ICAJCQkJCQkmcmVzZXJ2ZWRfYmFzZSwgJnJlc2VydmVkX3NpemUpOwo+ICAgCQlicmVhazsKPiAg
IAljYXNlIDExOgo+ICAgCWRlZmF1bHQ6Cj4gLQkJaWNsX2dldF9zdG9sZW5fcmVzZXJ2ZWQoZGV2
X3ByaXYsICZyZXNlcnZlZF9iYXNlLAo+ICsJCWljbF9nZXRfc3RvbGVuX3Jlc2VydmVkKGk5MTUs
ICZyZXNlcnZlZF9iYXNlLAo+ICAgCQkJCQkmcmVzZXJ2ZWRfc2l6ZSk7Cj4gICAJCWJyZWFrOwo+
ICAgCX0KPiBAQCAtNDM5LDEyICs0MzksMTIgQEAgaW50IGk5MTVfZ2VtX2luaXRfc3RvbGVuKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkJcmVzZXJ2ZWRfc2l6ZSA9IDA7
Cj4gICAJfQo+ICAgCj4gLQlkZXZfcHJpdi0+ZHNtX3Jlc2VydmVkID0KPiArCWk5MTUtPmRzbV9y
ZXNlcnZlZCA9Cj4gICAJCShzdHJ1Y3QgcmVzb3VyY2UpIERFRklORV9SRVNfTUVNKHJlc2VydmVk
X2Jhc2UsIHJlc2VydmVkX3NpemUpOwo+ICAgCj4gLQlpZiAoIXJlc291cmNlX2NvbnRhaW5zKCZk
ZXZfcHJpdi0+ZHNtLCAmZGV2X3ByaXYtPmRzbV9yZXNlcnZlZCkpIHsKPiArCWlmICghcmVzb3Vy
Y2VfY29udGFpbnMoJmk5MTUtPmRzbSwgJmk5MTUtPmRzbV9yZXNlcnZlZCkpIHsKPiAgIAkJRFJN
X0VSUk9SKCJTdG9sZW4gcmVzZXJ2ZWQgYXJlYSAlcFIgb3V0c2lkZSBzdG9sZW4gbWVtb3J5ICVw
UlxuIiwKPiAtCQkJICAmZGV2X3ByaXYtPmRzbV9yZXNlcnZlZCwgJmRldl9wcml2LT5kc20pOwo+
ICsJCQkgICZpOTE1LT5kc21fcmVzZXJ2ZWQsICZpOTE1LT5kc20pOwo+ICAgCQlyZXR1cm4gMDsK
PiAgIAl9Cj4gICAKPiBAQCAtNDUzLDE0ICs0NTMsMTQgQEAgaW50IGk5MTVfZ2VtX2luaXRfc3Rv
bGVuKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAlyZXNlcnZlZF90b3Rh
bCA9IHN0b2xlbl90b3AgLSByZXNlcnZlZF9iYXNlOwo+ICAgCj4gICAJRFJNX0RFQlVHX0RSSVZF
UigiTWVtb3J5IHJlc2VydmVkIGZvciBncmFwaGljcyBkZXZpY2U6ICVsbHVLLCB1c2FibGU6ICVs
bHVLXG4iLAo+IC0JCQkgKHU2NClyZXNvdXJjZV9zaXplKCZkZXZfcHJpdi0+ZHNtKSA+PiAxMCwK
PiAtCQkJICgodTY0KXJlc291cmNlX3NpemUoJmRldl9wcml2LT5kc20pIC0gcmVzZXJ2ZWRfdG90
YWwpID4+IDEwKTsKPiArCQkJICh1NjQpcmVzb3VyY2Vfc2l6ZSgmaTkxNS0+ZHNtKSA+PiAxMCwK
PiArCQkJICgodTY0KXJlc291cmNlX3NpemUoJmk5MTUtPmRzbSkgLSByZXNlcnZlZF90b3RhbCkg
Pj4gMTApOwo+ICAgCj4gLQlkZXZfcHJpdi0+c3RvbGVuX3VzYWJsZV9zaXplID0KPiAtCQlyZXNv
dXJjZV9zaXplKCZkZXZfcHJpdi0+ZHNtKSAtIHJlc2VydmVkX3RvdGFsOwo+ICsJaTkxNS0+c3Rv
bGVuX3VzYWJsZV9zaXplID0KPiArCQlyZXNvdXJjZV9zaXplKCZpOTE1LT5kc20pIC0gcmVzZXJ2
ZWRfdG90YWw7Cj4gICAKPiAgIAkvKiBCYXNpYyBtZW1yYW5nZSBhbGxvY2F0b3IgZm9yIHN0b2xl
biBzcGFjZS4gKi8KPiAtCWRybV9tbV9pbml0KCZkZXZfcHJpdi0+bW0uc3RvbGVuLCAwLCBkZXZf
cHJpdi0+c3RvbGVuX3VzYWJsZV9zaXplKTsKPiArCWRybV9tbV9pbml0KCZpOTE1LT5tbS5zdG9s
ZW4sIDAsIGk5MTUtPnN0b2xlbl91c2FibGVfc2l6ZSk7Cj4gICAKPiAgIAlyZXR1cm4gMDsKPiAg
IH0KPiBAQCAtNDY5LDExICs0NjksMTEgQEAgc3RhdGljIHN0cnVjdCBzZ190YWJsZSAqCj4gICBp
OTE1X3BhZ2VzX2NyZWF0ZV9mb3Jfc3RvbGVuKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gICAJ
CQkgICAgIHJlc291cmNlX3NpemVfdCBvZmZzZXQsIHJlc291cmNlX3NpemVfdCBzaXplKQo+ICAg
ewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJc3Ry
dWN0IHNnX3RhYmxlICpzdDsKPiAgIAlzdHJ1Y3Qgc2NhdHRlcmxpc3QgKnNnOwo+ICAgCj4gLQlH
RU1fQlVHX09OKHJhbmdlX292ZXJmbG93cyhvZmZzZXQsIHNpemUsIHJlc291cmNlX3NpemUoJmRl
dl9wcml2LT5kc20pKSk7Cj4gKwlHRU1fQlVHX09OKHJhbmdlX292ZXJmbG93cyhvZmZzZXQsIHNp
emUsIHJlc291cmNlX3NpemUoJmk5MTUtPmRzbSkpKTsKPiAgIAo+ICAgCS8qIFdlIGhpZGUgdGhh
dCB3ZSBoYXZlIG5vIHN0cnVjdCBwYWdlIGJhY2tpbmcgb3VyIHN0b2xlbiBvYmplY3QKPiAgIAkg
KiBieSB3cmFwcGluZyB0aGUgY29udGlndW91cyBwaHlzaWNhbCBhbGxvY2F0aW9uIHdpdGggYSBm
YWtlCj4gQEAgLTQ5Myw3ICs0OTMsNyBAQCBpOTE1X3BhZ2VzX2NyZWF0ZV9mb3Jfc3RvbGVuKHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gICAJc2ctPm9mZnNldCA9IDA7Cj4gICAJc2ctPmxlbmd0
aCA9IHNpemU7Cj4gICAKPiAtCXNnX2RtYV9hZGRyZXNzKHNnKSA9IChkbWFfYWRkcl90KWRldl9w
cml2LT5kc20uc3RhcnQgKyBvZmZzZXQ7Cj4gKwlzZ19kbWFfYWRkcmVzcyhzZykgPSAoZG1hX2Fk
ZHJfdClpOTE1LT5kc20uc3RhcnQgKyBvZmZzZXQ7Cj4gICAJc2dfZG1hX2xlbihzZykgPSBzaXpl
Owo+ICAgCj4gICAJcmV0dXJuIHN0Owo+IEBAIC01MjQsMTQgKzUyNCwxNCBAQCBzdGF0aWMgdm9p
ZCBpOTE1X2dlbV9vYmplY3RfcHV0X3BhZ2VzX3N0b2xlbihzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29i
amVjdCAqb2JqLAo+ICAgc3RhdGljIHZvaWQKPiAgIGk5MTVfZ2VtX29iamVjdF9yZWxlYXNlX3N0
b2xlbihzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQo+ICAgewo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShvYmotPmJhc2UuZGV2KTsKPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShvYmotPmJhc2UuZGV2KTsKPiAg
IAlzdHJ1Y3QgZHJtX21tX25vZGUgKnN0b2xlbiA9IGZldGNoX2FuZF96ZXJvKCZvYmotPnN0b2xl
bik7Cj4gICAKPiAgIAlHRU1fQlVHX09OKCFzdG9sZW4pOwo+ICAgCj4gICAJX19pOTE1X2dlbV9v
YmplY3RfdW5waW5fcGFnZXMob2JqKTsKPiAgIAo+IC0JaTkxNV9nZW1fc3RvbGVuX3JlbW92ZV9u
b2RlKGRldl9wcml2LCBzdG9sZW4pOwo+ICsJaTkxNV9nZW1fc3RvbGVuX3JlbW92ZV9ub2RlKGk5
MTUsIHN0b2xlbik7Cj4gICAJa2ZyZWUoc3RvbGVuKTsKPiAgIH0KPiAgIAo+IEBAIC01NDIsNyAr
NTQyLDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0X29wcyBpOTE1
X2dlbV9vYmplY3Rfc3RvbGVuX29wcyA9IHsKPiAgIH07Cj4gICAKPiAgIHN0YXRpYyBzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqCj4gLV9pOTE1X2dlbV9vYmplY3RfY3JlYXRlX3N0b2xlbihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK19pOTE1X2dlbV9vYmplY3RfY3Jl
YXRlX3N0b2xlbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgICBz
dHJ1Y3QgZHJtX21tX25vZGUgKnN0b2xlbikKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdCAqb2JqOwo+IEBAIC01NTIsMTIgKzU1MiwxMiBAQCBfaTkxNV9nZW1fb2JqZWN0X2Ny
ZWF0ZV9zdG9sZW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCWlmIChv
YmogPT0gTlVMTCkKPiAgIAkJcmV0dXJuIE5VTEw7Cj4gICAKPiAtCWRybV9nZW1fcHJpdmF0ZV9v
YmplY3RfaW5pdCgmZGV2X3ByaXYtPmRybSwgJm9iai0+YmFzZSwgc3RvbGVuLT5zaXplKTsKPiAr
CWRybV9nZW1fcHJpdmF0ZV9vYmplY3RfaW5pdCgmaTkxNS0+ZHJtLCAmb2JqLT5iYXNlLCBzdG9s
ZW4tPnNpemUpOwo+ICAgCWk5MTVfZ2VtX29iamVjdF9pbml0KG9iaiwgJmk5MTVfZ2VtX29iamVj
dF9zdG9sZW5fb3BzKTsKPiAgIAo+ICAgCW9iai0+c3RvbGVuID0gc3RvbGVuOwo+ICAgCW9iai0+
cmVhZF9kb21haW5zID0gSTkxNV9HRU1fRE9NQUlOX0NQVSB8IEk5MTVfR0VNX0RPTUFJTl9HVFQ7
Cj4gLQljYWNoZV9sZXZlbCA9IEhBU19MTEMoZGV2X3ByaXYpID8gSTkxNV9DQUNIRV9MTEMgOiBJ
OTE1X0NBQ0hFX05PTkU7Cj4gKwljYWNoZV9sZXZlbCA9IEhBU19MTEMoaTkxNSkgPyBJOTE1X0NB
Q0hFX0xMQyA6IEk5MTVfQ0FDSEVfTk9ORTsKPiAgIAlpOTE1X2dlbV9vYmplY3Rfc2V0X2NhY2hl
X2NvaGVyZW5jeShvYmosIGNhY2hlX2xldmVsKTsKPiAgIAo+ICAgCWlmIChpOTE1X2dlbV9vYmpl
Y3RfcGluX3BhZ2VzKG9iaikpCj4gQEAgLTU3MSwxNCArNTcxLDE0IEBAIF9pOTE1X2dlbV9vYmpl
Y3RfY3JlYXRlX3N0b2xlbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICB9
Cj4gICAKPiAgIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICoKPiAtaTkxNV9nZW1fb2JqZWN0
X2NyZWF0ZV9zdG9sZW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtpOTE1
X2dlbV9vYmplY3RfY3JlYXRlX3N0b2xlbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
PiAgIAkJCSAgICAgIHJlc291cmNlX3NpemVfdCBzaXplKQo+ICAgewo+ICAgCXN0cnVjdCBkcm1f
aTkxNV9nZW1fb2JqZWN0ICpvYmo7Cj4gICAJc3RydWN0IGRybV9tbV9ub2RlICpzdG9sZW47Cj4g
ICAJaW50IHJldDsKPiAgIAo+IC0JaWYgKCFkcm1fbW1faW5pdGlhbGl6ZWQoJmRldl9wcml2LT5t
bS5zdG9sZW4pKQo+ICsJaWYgKCFkcm1fbW1faW5pdGlhbGl6ZWQoJmk5MTUtPm1tLnN0b2xlbikp
Cj4gICAJCXJldHVybiBOVUxMOwo+ICAgCj4gICAJaWYgKHNpemUgPT0gMCkKPiBAQCAtNTg4LDM3
ICs1ODgsMzcgQEAgaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zdG9sZW4oc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCWlmICghc3RvbGVuKQo+ICAgCQlyZXR1cm4gTlVMTDsK
PiAgIAo+IC0JcmV0ID0gaTkxNV9nZW1fc3RvbGVuX2luc2VydF9ub2RlKGRldl9wcml2LCBzdG9s
ZW4sIHNpemUsIDQwOTYpOwo+ICsJcmV0ID0gaTkxNV9nZW1fc3RvbGVuX2luc2VydF9ub2RlKGk5
MTUsIHN0b2xlbiwgc2l6ZSwgNDA5Nik7Cj4gICAJaWYgKHJldCkgewo+ICAgCQlrZnJlZShzdG9s
ZW4pOwo+ICAgCQlyZXR1cm4gTlVMTDsKPiAgIAl9Cj4gICAKPiAtCW9iaiA9IF9pOTE1X2dlbV9v
YmplY3RfY3JlYXRlX3N0b2xlbihkZXZfcHJpdiwgc3RvbGVuKTsKPiArCW9iaiA9IF9pOTE1X2dl
bV9vYmplY3RfY3JlYXRlX3N0b2xlbihpOTE1LCBzdG9sZW4pOwo+ICAgCWlmIChvYmopCj4gICAJ
CXJldHVybiBvYmo7Cj4gICAKPiAtCWk5MTVfZ2VtX3N0b2xlbl9yZW1vdmVfbm9kZShkZXZfcHJp
diwgc3RvbGVuKTsKPiArCWk5MTVfZ2VtX3N0b2xlbl9yZW1vdmVfbm9kZShpOTE1LCBzdG9sZW4p
Owo+ICAgCWtmcmVlKHN0b2xlbik7Cj4gICAJcmV0dXJuIE5VTEw7Cj4gICB9Cj4gICAKPiAgIHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICoKPiAtaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zdG9s
ZW5fZm9yX3ByZWFsbG9jYXRlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
K2k5MTVfZ2VtX29iamVjdF9jcmVhdGVfc3RvbGVuX2Zvcl9wcmVhbGxvY2F0ZWQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJCSAgICAgICByZXNvdXJjZV9zaXplX3Qgc3Rv
bGVuX29mZnNldCwKPiAgIAkJCQkJICAgICAgIHJlc291cmNlX3NpemVfdCBndHRfb2Zmc2V0LAo+
ICAgCQkJCQkgICAgICAgcmVzb3VyY2Vfc2l6ZV90IHNpemUpCj4gICB7Cj4gLQlzdHJ1Y3QgaTkx
NV9nZ3R0ICpnZ3R0ID0gJmRldl9wcml2LT5nZ3R0Owo+ICsJc3RydWN0IGk5MTVfZ2d0dCAqZ2d0
dCA9ICZpOTE1LT5nZ3R0Owo+ICAgCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7Cj4g
ICAJc3RydWN0IGRybV9tbV9ub2RlICpzdG9sZW47Cj4gICAJc3RydWN0IGk5MTVfdm1hICp2bWE7
Cj4gICAJaW50IHJldDsKPiAgIAo+IC0JaWYgKCFkcm1fbW1faW5pdGlhbGl6ZWQoJmRldl9wcml2
LT5tbS5zdG9sZW4pKQo+ICsJaWYgKCFkcm1fbW1faW5pdGlhbGl6ZWQoJmk5MTUtPm1tLnN0b2xl
bikpCj4gICAJCXJldHVybiBOVUxMOwo+ICAgCj4gLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZf
cHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5k
cm0uc3RydWN0X211dGV4KTsKPiAgIAo+ICAgCURSTV9ERUJVR19EUklWRVIoImNyZWF0aW5nIHBy
ZWFsbG9jYXRlZCBzdG9sZW4gb2JqZWN0OiBzdG9sZW5fb2Zmc2V0PSVwYSwgZ3R0X29mZnNldD0l
cGEsIHNpemU9JXBhXG4iLAo+ICAgCQkJICZzdG9sZW5fb2Zmc2V0LCAmZ3R0X29mZnNldCwgJnNp
emUpOwo+IEBAIC02MzUsMTkgKzYzNSwxOSBAQCBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3N0b2xl
bl9mb3JfcHJlYWxsb2NhdGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdgo+ICAg
Cj4gICAJc3RvbGVuLT5zdGFydCA9IHN0b2xlbl9vZmZzZXQ7Cj4gICAJc3RvbGVuLT5zaXplID0g
c2l6ZTsKPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5tbS5zdG9sZW5fbG9jayk7Cj4gLQlyZXQg
PSBkcm1fbW1fcmVzZXJ2ZV9ub2RlKCZkZXZfcHJpdi0+bW0uc3RvbGVuLCBzdG9sZW4pOwo+IC0J
bXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+bW0uc3RvbGVuX2xvY2spOwo+ICsJbXV0ZXhfbG9jaygm
aTkxNS0+bW0uc3RvbGVuX2xvY2spOwo+ICsJcmV0ID0gZHJtX21tX3Jlc2VydmVfbm9kZSgmaTkx
NS0+bW0uc3RvbGVuLCBzdG9sZW4pOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5tbS5zdG9sZW5f
bG9jayk7Cj4gICAJaWYgKHJldCkgewo+ICAgCQlEUk1fREVCVUdfRFJJVkVSKCJmYWlsZWQgdG8g
YWxsb2NhdGUgc3RvbGVuIHNwYWNlXG4iKTsKPiAgIAkJa2ZyZWUoc3RvbGVuKTsKPiAgIAkJcmV0
dXJuIE5VTEw7Cj4gICAJfQo+ICAgCj4gLQlvYmogPSBfaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9z
dG9sZW4oZGV2X3ByaXYsIHN0b2xlbik7Cj4gKwlvYmogPSBfaTkxNV9nZW1fb2JqZWN0X2NyZWF0
ZV9zdG9sZW4oaTkxNSwgc3RvbGVuKTsKPiAgIAlpZiAob2JqID09IE5VTEwpIHsKPiAgIAkJRFJN
X0RFQlVHX0RSSVZFUigiZmFpbGVkIHRvIGFsbG9jYXRlIHN0b2xlbiBvYmplY3RcbiIpOwo+IC0J
CWk5MTVfZ2VtX3N0b2xlbl9yZW1vdmVfbm9kZShkZXZfcHJpdiwgc3RvbGVuKTsKPiArCQlpOTE1
X2dlbV9zdG9sZW5fcmVtb3ZlX25vZGUoaTkxNSwgc3RvbGVuKTsKPiAgIAkJa2ZyZWUoc3RvbGVu
KTsKPiAgIAkJcmV0dXJuIE5VTEw7Cj4gICAJfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fdGlsaW5nLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fdGlsaW5nLmMKPiBpbmRleCBjYTBjMmY0NTE3NDIuLjQ2YjUyM2Q0ZWQ4NCAxMDA2
NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdGlsaW5nLmMKPiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdGlsaW5nLmMKPiBAQCAtMzk4
LDcgKzM5OCw3IEBAIGk5MTVfZ2VtX2dldF90aWxpbmdfaW9jdGwoc3RydWN0IGRybV9kZXZpY2Ug
KmRldiwgdm9pZCAqZGF0YSwKPiAgIAkJCSAgc3RydWN0IGRybV9maWxlICpmaWxlKQo+ICAgewo+
ICAgCXN0cnVjdCBkcm1faTkxNV9nZW1fZ2V0X3RpbGluZyAqYXJncyA9IGRhdGE7Cj4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAlzdHJ1Y3QgZHJtX2k5
MTVfZ2VtX29iamVjdCAqb2JqOwo+ICAgCWludCBlcnIgPSAtRU5PRU5UOwo+ICAgCj4gQEAgLTQx
NSwxMCArNDE1LDEwIEBAIGk5MTVfZ2VtX2dldF90aWxpbmdfaW9jdGwoc3RydWN0IGRybV9kZXZp
Y2UgKmRldiwgdm9pZCAqZGF0YSwKPiAgIAo+ICAgCXN3aXRjaCAoYXJncy0+dGlsaW5nX21vZGUp
IHsKPiAgIAljYXNlIEk5MTVfVElMSU5HX1g6Cj4gLQkJYXJncy0+c3dpenpsZV9tb2RlID0gZGV2
X3ByaXYtPm1tLmJpdF82X3N3aXp6bGVfeDsKPiArCQlhcmdzLT5zd2l6emxlX21vZGUgPSBpOTE1
LT5tbS5iaXRfNl9zd2l6emxlX3g7Cj4gICAJCWJyZWFrOwo+ICAgCWNhc2UgSTkxNV9USUxJTkdf
WToKPiAtCQlhcmdzLT5zd2l6emxlX21vZGUgPSBkZXZfcHJpdi0+bW0uYml0XzZfc3dpenpsZV95
Owo+ICsJCWFyZ3MtPnN3aXp6bGVfbW9kZSA9IGk5MTUtPm1tLmJpdF82X3N3aXp6bGVfeTsKPiAg
IAkJYnJlYWs7Cj4gICAJZGVmYXVsdDoKPiAgIAljYXNlIEk5MTVfVElMSU5HX05PTkU6Cj4gQEAg
LTQyNyw3ICs0MjcsNyBAQCBpOTE1X2dlbV9nZXRfdGlsaW5nX2lvY3RsKHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gICAJfQo+ICAgCj4gICAJLyogSGlkZSBiaXQgMTcgZnJv
bSB0aGUgdXNlciAtLSBzZWUgY29tbWVudCBpbiBpOTE1X2dlbV9zZXRfdGlsaW5nICovCj4gLQlp
ZiAoZGV2X3ByaXYtPnF1aXJrcyAmIFFVSVJLX1BJTl9TV0laWkxFRF9QQUdFUykKPiArCWlmIChp
OTE1LT5xdWlya3MgJiBRVUlSS19QSU5fU1dJWlpMRURfUEFHRVMpCj4gICAJCWFyZ3MtPnBoeXNf
c3dpenpsZV9tb2RlID0gSTkxNV9CSVRfNl9TV0laWkxFX1VOS05PV047Cj4gICAJZWxzZQo+ICAg
CQlhcmdzLT5waHlzX3N3aXp6bGVfbW9kZSA9IGFyZ3MtPnN3aXp6bGVfbW9kZTsKPiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3VzZXJwdHIuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV91c2VycHRyLmMKPiBpbmRleCA1MjhiNjE2Nzgz
MzQuLmYyMmUxMGU4ODk1YSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fdXNlcnB0ci5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX3VzZXJwdHIuYwo+IEBAIC0zMjcsMTIgKzMyNywxMiBAQCBpOTE1X21tdV9ub3RpZmllcl9m
cmVlKHN0cnVjdCBpOTE1X21tdV9ub3RpZmllciAqbW4sCj4gICAjZW5kaWYKPiAgIAo+ICAgc3Rh
dGljIHN0cnVjdCBpOTE1X21tX3N0cnVjdCAqCj4gLV9faTkxNV9tbV9zdHJ1Y3RfZmluZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHN0cnVjdCBtbV9zdHJ1Y3QgKnJlYWwpCj4g
K19faTkxNV9tbV9zdHJ1Y3RfZmluZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgc3Ry
dWN0IG1tX3N0cnVjdCAqcmVhbCkKPiAgIHsKPiAgIAlzdHJ1Y3QgaTkxNV9tbV9zdHJ1Y3QgKm1t
Owo+ICAgCj4gLQkvKiBQcm90ZWN0ZWQgYnkgZGV2X3ByaXYtPm1tX2xvY2sgKi8KPiAtCWhhc2hf
Zm9yX2VhY2hfcG9zc2libGUoZGV2X3ByaXYtPm1tX3N0cnVjdHMsIG1tLCBub2RlLCAodW5zaWdu
ZWQgbG9uZylyZWFsKQo+ICsJLyogUHJvdGVjdGVkIGJ5IGk5MTUtPm1tX2xvY2sgKi8KPiArCWhh
c2hfZm9yX2VhY2hfcG9zc2libGUoaTkxNS0+bW1fc3RydWN0cywgbW0sIG5vZGUsICh1bnNpZ25l
ZCBsb25nKXJlYWwpCj4gICAJCWlmIChtbS0+bW0gPT0gcmVhbCkKPiAgIAkJCXJldHVybiBtbTsK
PiAgIAo+IEBAIC0zNDIsNyArMzQyLDcgQEAgX19pOTE1X21tX3N0cnVjdF9maW5kKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgc3RydWN0IG1tX3N0cnVjdCAqcmVhbCkKPiAgIHN0
YXRpYyBpbnQKPiAgIGk5MTVfZ2VtX3VzZXJwdHJfaW5pdF9fbW1fc3RydWN0KHN0cnVjdCBkcm1f
aTkxNV9nZW1fb2JqZWN0ICpvYmopCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KG9iai0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KG9iai0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpOTE1X21t
X3N0cnVjdCAqbW07Cj4gICAJaW50IHJldCA9IDA7Cj4gICAKPiBAQCAtMzU2LDggKzM1Niw4IEBA
IGk5MTVfZ2VtX3VzZXJwdHJfaW5pdF9fbW1fc3RydWN0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICpvYmopCj4gICAJICogc3RydWN0X211dGV4LCBpLmUuIHdlIG5lZWQgdG8gc2NoZWR1bGUg
YSB3b3JrZXIgdG8gZG8gdGhlIGNsZWFuCj4gICAJICogdXAuCj4gICAJICovCj4gLQltdXRleF9s
b2NrKCZkZXZfcHJpdi0+bW1fbG9jayk7Cj4gLQltbSA9IF9faTkxNV9tbV9zdHJ1Y3RfZmluZChk
ZXZfcHJpdiwgY3VycmVudC0+bW0pOwo+ICsJbXV0ZXhfbG9jaygmaTkxNS0+bW1fbG9jayk7Cj4g
KwltbSA9IF9faTkxNV9tbV9zdHJ1Y3RfZmluZChpOTE1LCBjdXJyZW50LT5tbSk7Cj4gICAJaWYg
KG1tID09IE5VTEwpIHsKPiAgIAkJbW0gPSBrbWFsbG9jKHNpemVvZigqbW0pLCBHRlBfS0VSTkVM
KTsKPiAgIAkJaWYgKG1tID09IE5VTEwpIHsKPiBAQCAtMzczLDE1ICszNzMsMTUgQEAgaTkxNV9n
ZW1fdXNlcnB0cl9pbml0X19tbV9zdHJ1Y3Qoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
aikKPiAgIAo+ICAgCQltbS0+bW4gPSBOVUxMOwo+ICAgCj4gLQkJLyogUHJvdGVjdGVkIGJ5IGRl
dl9wcml2LT5tbV9sb2NrICovCj4gLQkJaGFzaF9hZGQoZGV2X3ByaXYtPm1tX3N0cnVjdHMsCj4g
KwkJLyogUHJvdGVjdGVkIGJ5IGk5MTUtPm1tX2xvY2sgKi8KPiArCQloYXNoX2FkZChpOTE1LT5t
bV9zdHJ1Y3RzLAo+ICAgCQkJICZtbS0+bm9kZSwgKHVuc2lnbmVkIGxvbmcpbW0tPm1tKTsKPiAg
IAl9IGVsc2UKPiAgIAkJa3JlZl9nZXQoJm1tLT5rcmVmKTsKPiAgIAo+ICAgCW9iai0+dXNlcnB0
ci5tbSA9IG1tOwo+ICAgb3V0Ogo+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+bW1fbG9jayk7
Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPm1tX2xvY2spOwo+ICAgCXJldHVybiByZXQ7Cj4gICB9
Cj4gICAKPiBAQCAtMzk5LDcgKzM5OSw3IEBAIF9faTkxNV9tbV9zdHJ1Y3RfZnJlZShzdHJ1Y3Qg
a3JlZiAqa3JlZikKPiAgIHsKPiAgIAlzdHJ1Y3QgaTkxNV9tbV9zdHJ1Y3QgKm1tID0gY29udGFp
bmVyX29mKGtyZWYsIHR5cGVvZigqbW0pLCBrcmVmKTsKPiAgIAo+IC0JLyogUHJvdGVjdGVkIGJ5
IGRldl9wcml2LT5tbV9sb2NrICovCj4gKwkvKiBQcm90ZWN0ZWQgYnkgaTkxNS0+bW1fbG9jayAq
Lwo+ICAgCWhhc2hfZGVsKCZtbS0+bm9kZSk7Cj4gICAJbXV0ZXhfdW5sb2NrKCZtbS0+aTkxNS0+
bW1fbG9jayk7Cj4gICAKPiBAQCAtNzQxLDEzICs3NDEsMTMgQEAgaTkxNV9nZW1fdXNlcnB0cl9p
b2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ICAgCQkgICAgICAgdm9pZCAqZGF0YSwKPiAg
IAkJICAgICAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXN0cnVjdCBkcm1faTkxNV9nZW1fdXNl
cnB0ciAqYXJncyA9IGRhdGE7Cj4gICAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsK
PiAgIAlpbnQgcmV0Owo+ICAgCXUzMiBoYW5kbGU7Cj4gICAKPiAtCWlmICghSEFTX0xMQyhkZXZf
cHJpdikgJiYgIUhBU19TTk9PUChkZXZfcHJpdikpIHsKPiArCWlmICghSEFTX0xMQyhpOTE1KSAm
JiAhSEFTX1NOT09QKGk5MTUpKSB7Cj4gICAJCS8qIFdlIGNhbm5vdCBzdXBwb3J0IGNvaGVyZW50
IHVzZXJwdHIgb2JqZWN0cyBvbiBodyB3aXRob3V0Cj4gICAJCSAqIExMQyBhbmQgYnJva2VuIHNu
b29waW5nLgo+ICAgCQkgKi8KPiBAQCAtNzc0LDcgKzc3NCw3IEBAIGk5MTVfZ2VtX3VzZXJwdHJf
aW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiAgIAkJICogT24gYWxtb3N0IGFsbCBvZiB0
aGUgb2xkZXIgaHcsIHdlIGNhbm5vdCB0ZWxsIHRoZSBHUFUgdGhhdAo+ICAgCQkgKiBhIHBhZ2Ug
aXMgcmVhZG9ubHkuCj4gICAJCSAqLwo+IC0JCXZtID0gZGV2X3ByaXYtPmtlcm5lbF9jb250ZXh0
LT52bTsKPiArCQl2bSA9IGk5MTUtPmtlcm5lbF9jb250ZXh0LT52bTsKPiAgIAkJaWYgKCF2bSB8
fCAhdm0tPmhhc19yZWFkX29ubHkpCj4gICAJCQlyZXR1cm4gLUVOT0RFVjsKPiAgIAl9Cj4gQEAg
LTgxMiwyMiArODEyLDIyIEBAIGk5MTVfZ2VtX3VzZXJwdHJfaW9jdGwoc3RydWN0IGRybV9kZXZp
Y2UgKmRldiwKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+IC1pbnQgaTkxNV9nZW1faW5pdF91
c2VycHRyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAraW50IGk5MTVfZ2Vt
X2luaXRfdXNlcnB0cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCW11
dGV4X2luaXQoJmRldl9wcml2LT5tbV9sb2NrKTsKPiAtCWhhc2hfaW5pdChkZXZfcHJpdi0+bW1f
c3RydWN0cyk7Cj4gKwltdXRleF9pbml0KCZpOTE1LT5tbV9sb2NrKTsKPiArCWhhc2hfaW5pdChp
OTE1LT5tbV9zdHJ1Y3RzKTsKPiAgIAo+IC0JZGV2X3ByaXYtPm1tLnVzZXJwdHJfd3EgPQo+ICsJ
aTkxNS0+bW0udXNlcnB0cl93cSA9Cj4gICAJCWFsbG9jX3dvcmtxdWV1ZSgiaTkxNS11c2VycHRy
LWFjcXVpcmUiLAo+ICAgCQkJCVdRX0hJR0hQUkkgfCBXUV9VTkJPVU5ELAo+ICAgCQkJCTApOwo+
IC0JaWYgKCFkZXZfcHJpdi0+bW0udXNlcnB0cl93cSkKPiArCWlmICghaTkxNS0+bW0udXNlcnB0
cl93cSkKPiAgIAkJcmV0dXJuIC1FTk9NRU07Cj4gICAKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAg
IAo+IC12b2lkIGk5MTVfZ2VtX2NsZWFudXBfdXNlcnB0cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgaTkxNV9nZW1fY2xlYW51cF91c2VycHRyKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JZGVzdHJveV93b3JrcXVldWUoZGV2X3ByaXYt
Pm1tLnVzZXJwdHJfd3EpOwo+ICsJZGVzdHJveV93b3JrcXVldWUoaTkxNS0+bW0udXNlcnB0cl93
cSk7Cj4gICB9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVz
dHMvaHVnZV9wYWdlcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdl
X3BhZ2VzLmMKPiBpbmRleCA3M2U2NjdiMzFjYzQuLjc4Nzk3Njk5ZmViMCAxMDA2NDQKPiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2h1Z2VfcGFnZXMuYwo+ICsrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaHVnZV9wYWdlcy5jCj4gQEAgLTE0
MTUsOCArMTQxNSw4IEBAIHN0YXRpYyBpbnQgaWd0X3BwZ3R0X2dlbWZzX2h1Z2Uodm9pZCAqYXJn
KQo+ICAgc3RhdGljIGludCBpZ3RfcHBndHRfcGluX3VwZGF0ZSh2b2lkICphcmcpCj4gICB7Cj4g
ICAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCA9IGFyZzsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IGN0eC0+aTkxNTsKPiAtCXVuc2lnbmVkIGxvbmcgc3VwcG9y
dGVkID0gSU5URUxfSU5GTyhkZXZfcHJpdiktPnBhZ2Vfc2l6ZXM7Cj4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IGN0eC0+aTkxNTsKPiArCXVuc2lnbmVkIGxvbmcgc3VwcG9ydGVk
ID0gSU5URUxfSU5GTyhpOTE1KS0+cGFnZV9zaXplczsKPiAgIAlzdHJ1Y3QgaTkxNV9hZGRyZXNz
X3NwYWNlICp2bSA9IGN0eC0+dm07Cj4gICAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
ajsKPiAgIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKPiBAQCAtMTQ0Myw3ICsxNDQzLDcgQEAgc3Rh
dGljIGludCBpZ3RfcHBndHRfcGluX3VwZGF0ZSh2b2lkICphcmcpCj4gICAJZm9yX2VhY2hfc2V0
X2JpdF9mcm9tKGZpcnN0LCAmc3VwcG9ydGVkLCBsYXN0ICsgMSkgewo+ICAgCQl1bnNpZ25lZCBp
bnQgcGFnZV9zaXplID0gQklUKGZpcnN0KTsKPiAgIAo+IC0JCW9iaiA9IGk5MTVfZ2VtX29iamVj
dF9jcmVhdGVfaW50ZXJuYWwoZGV2X3ByaXYsIHBhZ2Vfc2l6ZSk7Cj4gKwkJb2JqID0gaTkxNV9n
ZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5hbChpOTE1LCBwYWdlX3NpemUpOwo+ICAgCQlpZiAoSVNf
RVJSKG9iaikpCj4gICAJCQlyZXR1cm4gUFRSX0VSUihvYmopOwo+ICAgCj4gQEAgLTE0OTcsNyAr
MTQ5Nyw3IEBAIHN0YXRpYyBpbnQgaWd0X3BwZ3R0X3Bpbl91cGRhdGUodm9pZCAqYXJnKQo+ICAg
CQlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7Cj4gICAJfQo+ICAgCj4gLQlvYmogPSBpOTE1X2dl
bV9vYmplY3RfY3JlYXRlX2ludGVybmFsKGRldl9wcml2LCBQQUdFX1NJWkUpOwo+ICsJb2JqID0g
aTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5hbChpOTE1LCBQQUdFX1NJWkUpOwo+ICAgCWlm
IChJU19FUlIob2JqKSkKPiAgIAkJcmV0dXJuIFBUUl9FUlIob2JqKTsKPiAgIAo+IEBAIC0xNTE4
LDcgKzE1MTgsNyBAQCBzdGF0aWMgaW50IGlndF9wcGd0dF9waW5fdXBkYXRlKHZvaWQgKmFyZykK
PiAgIAkgKiBsYW5kIGluIHRoZSBub3cgc3RhbGUgMk0gcGFnZS4KPiAgIAkgKi8KPiAgIAo+IC0J
ZXJyID0gZ3B1X3dyaXRlKHZtYSwgY3R4LCBkZXZfcHJpdi0+ZW5naW5lW1JDUzBdLCAwLCAweGRl
YWRiZWFmKTsKPiArCWVyciA9IGdwdV93cml0ZSh2bWEsIGN0eCwgaTkxNS0+ZW5naW5lW1JDUzBd
LCAwLCAweGRlYWRiZWFmKTsKPiAgIAlpZiAoZXJyKQo+ICAgCQlnb3RvIG91dF91bnBpbjsKPiAg
IAo+IEBAIC0xNjgyLDIwICsxNjgyLDIwIEBAIGludCBpOTE1X2dlbV9odWdlX3BhZ2VfbW9ja19z
ZWxmdGVzdHModm9pZCkKPiAgIAkJU1VCVEVTVChpZ3RfbW9ja19wcGd0dF9odWdlX2ZpbGwpLAo+
ICAgCQlTVUJURVNUKGlndF9tb2NrX3BwZ3R0XzY0SyksCj4gICAJfTsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdjsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
Owo+ICAgCXN0cnVjdCBpOTE1X3BwZ3R0ICpwcGd0dDsKPiAgIAlpbnQgZXJyOwo+ICAgCj4gLQlk
ZXZfcHJpdiA9IG1vY2tfZ2VtX2RldmljZSgpOwo+IC0JaWYgKCFkZXZfcHJpdikKPiArCWk5MTUg
PSBtb2NrX2dlbV9kZXZpY2UoKTsKPiArCWlmICghaTkxNSkKPiAgIAkJcmV0dXJuIC1FTk9NRU07
Cj4gICAKPiAgIAkvKiBQcmV0ZW5kIHRvIGJlIGEgZGV2aWNlIHdoaWNoIHN1cHBvcnRzIHRoZSA0
OGIgUFBHVFQgKi8KPiAtCW1rd3JpdGVfZGV2aWNlX2luZm8oZGV2X3ByaXYpLT5wcGd0dF90eXBl
ID0gSU5URUxfUFBHVFRfRlVMTDsKPiAtCW1rd3JpdGVfZGV2aWNlX2luZm8oZGV2X3ByaXYpLT5w
cGd0dF9zaXplID0gNDg7Cj4gKwlta3dyaXRlX2RldmljZV9pbmZvKGk5MTUpLT5wcGd0dF90eXBl
ID0gSU5URUxfUFBHVFRfRlVMTDsKPiArCW1rd3JpdGVfZGV2aWNlX2luZm8oaTkxNSktPnBwZ3R0
X3NpemUgPSA0ODsKPiAgIAo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwo+IC0JcHBndHQgPSBpOTE1X3BwZ3R0X2NyZWF0ZShkZXZfcHJpdik7Cj4gKwltdXRleF9s
b2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiArCXBwZ3R0ID0gaTkxNV9wcGd0dF9jcmVh
dGUoaTkxNSk7Cj4gICAJaWYgKElTX0VSUihwcGd0dCkpIHsKPiAgIAkJZXJyID0gUFRSX0VSUihw
cGd0dCk7Cj4gICAJCWdvdG8gb3V0X3VubG9jazsKPiBAQCAtMTcyMCwxMyArMTcyMCwxMyBAQCBp
bnQgaTkxNV9nZW1faHVnZV9wYWdlX21vY2tfc2VsZnRlc3RzKHZvaWQpCj4gICAJaTkxNV92bV9w
dXQoJnBwZ3R0LT52bSk7Cj4gICAKPiAgIG91dF91bmxvY2s6Cj4gLQltdXRleF91bmxvY2soJmRl
dl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiAtCWRybV9kZXZfcHV0KCZkZXZfcHJpdi0+ZHJt
KTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gKwlkcm1fZGV2
X3B1dCgmaTkxNS0+ZHJtKTsKPiAgIAo+ICAgCXJldHVybiBlcnI7Cj4gICB9Cj4gICAKPiAtaW50
IGk5MTVfZ2VtX2h1Z2VfcGFnZV9saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gK2ludCBpOTE1X2dlbV9odWdlX3BhZ2VfbGl2ZV9zZWxmdGVzdHMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RhdGljIGNvbnN0IHN0cnVj
dCBpOTE1X3N1YnRlc3QgdGVzdHNbXSA9IHsKPiAgIAkJU1VCVEVTVChpZ3Rfc2hyaW5rX3RocCks
Cj4gQEAgLTE3NDEsMjIgKzE3NDEsMjIgQEAgaW50IGk5MTVfZ2VtX2h1Z2VfcGFnZV9saXZlX3Nl
bGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJaW50ZWxfd2Fr
ZXJlZl90IHdha2VyZWY7Cj4gICAJaW50IGVycjsKPiAgIAo+IC0JaWYgKCFIQVNfUFBHVFQoZGV2
X3ByaXYpKSB7Cj4gKwlpZiAoIUhBU19QUEdUVChpOTE1KSkgewo+ICAgCQlwcl9pbmZvKCJQUEdU
VCBub3Qgc3VwcG9ydGVkLCBza2lwcGluZyBsaXZlLXNlbGZ0ZXN0c1xuIik7Cj4gICAJCXJldHVy
biAwOwo+ICAgCX0KPiAgIAo+IC0JaWYgKGk5MTVfdGVybWluYWxseV93ZWRnZWQoZGV2X3ByaXYp
KQo+ICsJaWYgKGk5MTVfdGVybWluYWxseV93ZWRnZWQoaTkxNSkpCj4gICAJCXJldHVybiAwOwo+
ICAgCj4gLQlmaWxlID0gbW9ja19maWxlKGRldl9wcml2KTsKPiArCWZpbGUgPSBtb2NrX2ZpbGUo
aTkxNSk7Cj4gICAJaWYgKElTX0VSUihmaWxlKSkKPiAgIAkJcmV0dXJuIFBUUl9FUlIoZmlsZSk7
Cj4gICAKPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiAtCXdh
a2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7Cj4gKwltdXRleF9sb2NrKCZp
OTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiArCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dl
dChpOTE1KTsKPiAgIAo+IC0JY3R4ID0gbGl2ZV9jb250ZXh0KGRldl9wcml2LCBmaWxlKTsKPiAr
CWN0eCA9IGxpdmVfY29udGV4dChpOTE1LCBmaWxlKTsKPiAgIAlpZiAoSVNfRVJSKGN0eCkpIHsK
PiAgIAkJZXJyID0gUFRSX0VSUihjdHgpOwo+ICAgCQlnb3RvIG91dF91bmxvY2s7Cj4gQEAgLTE3
NjgsMTAgKzE3NjgsMTAgQEAgaW50IGk5MTVfZ2VtX2h1Z2VfcGFnZV9saXZlX3NlbGZ0ZXN0cyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJZXJyID0gaTkxNV9zdWJ0ZXN0
cyh0ZXN0cywgY3R4KTsKPiAgIAo+ICAgb3V0X3VubG9jazoKPiAtCWludGVsX3J1bnRpbWVfcG1f
cHV0KGRldl9wcml2LCB3YWtlcmVmKTsKPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5z
dHJ1Y3RfbXV0ZXgpOwo+ICsJaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7Cj4g
KwltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCj4gLQltb2NrX2Zp
bGVfZnJlZShkZXZfcHJpdiwgZmlsZSk7Cj4gKwltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsK
PiAgIAo+ICAgCXJldHVybiBlcnI7Cj4gICB9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fY29udGV4dC5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMKPiBpbmRleCA3NGIwZTU4NzFj
NGIuLjJmZGNhYTE2NjdiZiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
c2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fY29udGV4dC5jCj4gQEAgLTE3NDgsNyArMTc0OCw3IEBA
IGludCBpOTE1X2dlbV9jb250ZXh0X21vY2tfc2VsZnRlc3RzKHZvaWQpCj4gICAJcmV0dXJuIGVy
cjsKPiAgIH0KPiAgIAo+IC1pbnQgaTkxNV9nZW1fY29udGV4dF9saXZlX3NlbGZ0ZXN0cyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK2ludCBpOTE1X2dlbV9jb250ZXh0X2xp
dmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXN0
YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9zdWJ0ZXN0IHRlc3RzW10gPSB7Cj4gICAJCVNVQlRFU1Qo
bGl2ZV9ub3Bfc3dpdGNoKSwKPiBAQCAtMTc1OSw4ICsxNzU5LDggQEAgaW50IGk5MTVfZ2VtX2Nv
bnRleHRfbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ICAgCQlTVUJURVNUKGlndF92bV9pc29sYXRpb24pLAo+ICAgCX07Cj4gICAKPiAtCWlmIChpOTE1
X3Rlcm1pbmFsbHlfd2VkZ2VkKGRldl9wcml2KSkKPiArCWlmIChpOTE1X3Rlcm1pbmFsbHlfd2Vk
Z2VkKGk5MTUpKQo+ICAgCQlyZXR1cm4gMDsKPiAgIAo+IC0JcmV0dXJuIGk5MTVfc3VidGVzdHMo
dGVzdHMsIGRldl9wcml2KTsKPiArCXJldHVybiBpOTE1X3N1YnRlc3RzKHRlc3RzLCBpOTE1KTsK
PiAgIH0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5l
LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaAo+IGluZGV4IDE0Mzlm
YTQwOTNhYy4uNzRmOWFkNjY0OGViIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2VuZ2luZS5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
ZW5naW5lLmgKPiBAQCAtNDY1LDcgKzQ2NSw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9l
bmdpbmVfcmVzZXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAo+ICAgfQo+ICAgCj4g
ICBib29sIGludGVsX2VuZ2luZV9pc19pZGxlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSk7Cj4gLWJvb2wgaW50ZWxfZW5naW5lc19hcmVfaWRsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpOwo+ICtib29sIGludGVsX2VuZ2luZXNfYXJlX2lkbGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgCj4gICB2b2lkIGludGVsX2VuZ2luZV9sb3N0X2NvbnRl
eHQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKPiAgIAo+IGRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jCj4gaW5kZXggYzBkOTg2ZGI1YTc1Li5hMDQ4Yjg3
NDNjZTYgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5l
X2NzLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYwo+
IEBAIC0xNjAsNyArMTYwLDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBlbmdpbmVfaW5mbyBpbnRl
bF9lbmdpbmVzW10gPSB7Cj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxfZW5naW5lX2NvbnRleHRf
c2l6ZSgpIC0gcmV0dXJuIHRoZSBzaXplIG9mIHRoZSBjb250ZXh0IGZvciBhbiBlbmdpbmUKPiAt
ICogQGRldl9wcml2OiBpOTE1IGRldmljZSBwcml2YXRlCj4gKyAqIEBpOTE1OiBpOTE1IGRldmlj
ZSBwcml2YXRlCj4gICAgKiBAY2xhc3M6IGVuZ2luZSBjbGFzcwo+ICAgICoKPiAgICAqIEVhY2gg
ZW5naW5lIGNsYXNzIG1heSByZXF1aXJlIGEgZGlmZmVyZW50IGFtb3VudCBvZiBzcGFjZSBmb3Ig
YSBjb250ZXh0Cj4gQEAgLTE3Miw3ICsxNzIsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGVuZ2lu
ZV9pbmZvIGludGVsX2VuZ2luZXNbXSA9IHsKPiAgICAqIGluIExSQyBtb2RlLCBidXQgZG9lcyBu
b3QgaW5jbHVkZSB0aGUgInNoYXJlZCBkYXRhIHBhZ2UiIHVzZWQgd2l0aAo+ICAgICogR3VDIHN1
Ym1pc3Npb24uIFRoZSBjYWxsZXIgc2hvdWxkIGFjY291bnQgZm9yIHRoaXMgaWYgdXNpbmcgdGhl
IEd1Qy4KPiAgICAqLwo+IC11MzIgaW50ZWxfZW5naW5lX2NvbnRleHRfc2l6ZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4IGNsYXNzKQo+ICt1MzIgaW50ZWxfZW5naW5lX2Nv
bnRleHRfc2l6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTggY2xhc3MpCj4gICB7
Cj4gICAJdTMyIGN4dF9zaXplOwo+ICAgCj4gQEAgLTE4MCw5ICsxODAsOSBAQCB1MzIgaW50ZWxf
ZW5naW5lX2NvbnRleHRfc2l6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4
IGNsYXNzKQo+ICAgCj4gICAJc3dpdGNoIChjbGFzcykgewo+ICAgCWNhc2UgUkVOREVSX0NMQVNT
Ogo+IC0JCXN3aXRjaCAoSU5URUxfR0VOKGRldl9wcml2KSkgewo+ICsJCXN3aXRjaCAoSU5URUxf
R0VOKGk5MTUpKSB7Cj4gICAJCWRlZmF1bHQ6Cj4gLQkJCU1JU1NJTkdfQ0FTRShJTlRFTF9HRU4o
ZGV2X3ByaXYpKTsKPiArCQkJTUlTU0lOR19DQVNFKElOVEVMX0dFTihpOTE1KSk7Cj4gICAJCQly
ZXR1cm4gREVGQVVMVF9MUl9DT05URVhUX1JFTkRFUl9TSVpFOwo+ICAgCQljYXNlIDExOgo+ICAg
CQkJcmV0dXJuIEdFTjExX0xSX0NPTlRFWFRfUkVOREVSX1NJWkU7Cj4gQEAgLTE5Myw3ICsxOTMs
NyBAQCB1MzIgaW50ZWxfZW5naW5lX2NvbnRleHRfc2l6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsIHU4IGNsYXNzKQo+ICAgCQljYXNlIDg6Cj4gICAJCQlyZXR1cm4gR0VOOF9M
Ul9DT05URVhUX1JFTkRFUl9TSVpFOwo+ICAgCQljYXNlIDc6Cj4gLQkJCWlmIChJU19IQVNXRUxM
KGRldl9wcml2KSkKPiArCQkJaWYgKElTX0hBU1dFTEwoaTkxNSkpCj4gICAJCQkJcmV0dXJuIEhT
V19DWFRfVE9UQUxfU0laRTsKPiAgIAo+ICAgCQkJY3h0X3NpemUgPSBJOTE1X1JFQUQoR0VON19D
WFRfU0laRSk7Cj4gQEAgLTIxNyw3ICsyMTcsNyBAQCB1MzIgaW50ZWxfZW5naW5lX2NvbnRleHRf
c2l6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4IGNsYXNzKQo+ICAgCQkJ
ICovCj4gICAJCQljeHRfc2l6ZSA9IEk5MTVfUkVBRChDWFRfU0laRSkgKyAxOwo+ICAgCQkJRFJN
X0RFQlVHX0RSSVZFUigiZ2VuJWQgQ1hUX1NJWkUgPSAlZCBieXRlcyBbMHglMDh4XVxuIiwKPiAt
CQkJCQkgSU5URUxfR0VOKGRldl9wcml2KSwKPiArCQkJCQkgSU5URUxfR0VOKGk5MTUpLAo+ICAg
CQkJCQkgY3h0X3NpemUgKiA2NCwKPiAgIAkJCQkJIGN4dF9zaXplIC0gMSk7Cj4gICAJCQlyZXR1
cm4gcm91bmRfdXAoY3h0X3NpemUgKiA2NCwgUEFHRV9TSVpFKTsKPiBAQCAtMjM0LDcgKzIzNCw3
IEBAIHUzMiBpbnRlbF9lbmdpbmVfY29udGV4dF9zaXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwgdTggY2xhc3MpCj4gICAJY2FzZSBWSURFT19ERUNPREVfQ0xBU1M6Cj4gICAJ
Y2FzZSBWSURFT19FTkhBTkNFTUVOVF9DTEFTUzoKPiAgIAljYXNlIENPUFlfRU5HSU5FX0NMQVNT
Ogo+IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgOCkKPiArCQlpZiAoSU5URUxfR0VOKGk5
MTUpIDwgOCkKPiAgIAkJCXJldHVybiAwOwo+ICAgCQlyZXR1cm4gR0VOOF9MUl9DT05URVhUX09U
SEVSX1NJWkU7Cj4gICAJfQo+IEBAIC0yODQsNyArMjg0LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxf
ZW5naW5lX3Nhbml0aXplX21taW8oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+ICAg
fQo+ICAgCj4gICBzdGF0aWMgaW50Cj4gLWludGVsX2VuZ2luZV9zZXR1cChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2ludGVsX2VuZ2luZV9zZXR1cChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJICAgZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQpCj4gICB7
Cj4gICAJY29uc3Qgc3RydWN0IGVuZ2luZV9pbmZvICppbmZvID0gJmludGVsX2VuZ2luZXNbaWRd
Owo+IEBAIC0zMDEsMTAgKzMwMSwxMCBAQCBpbnRlbF9lbmdpbmVfc2V0dXAoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCWlmIChHRU1fREVCVUdfV0FSTl9PTihpbmZvLT5p
bnN0YW5jZSA+IE1BWF9FTkdJTkVfSU5TVEFOQ0UpKQo+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiAg
IAo+IC0JaWYgKEdFTV9ERUJVR19XQVJOX09OKGRldl9wcml2LT5lbmdpbmVfY2xhc3NbaW5mby0+
Y2xhc3NdW2luZm8tPmluc3RhbmNlXSkpCj4gKwlpZiAoR0VNX0RFQlVHX1dBUk5fT04oaTkxNS0+
ZW5naW5lX2NsYXNzW2luZm8tPmNsYXNzXVtpbmZvLT5pbnN0YW5jZV0pKQo+ICAgCQlyZXR1cm4g
LUVJTlZBTDsKPiAgIAo+IC0JR0VNX0JVR19PTihkZXZfcHJpdi0+ZW5naW5lW2lkXSk7Cj4gKwlH
RU1fQlVHX09OKGk5MTUtPmVuZ2luZVtpZF0pOwo+ICAgCWVuZ2luZSA9IGt6YWxsb2Moc2l6ZW9m
KCplbmdpbmUpLCBHRlBfS0VSTkVMKTsKPiAgIAlpZiAoIWVuZ2luZSkKPiAgIAkJcmV0dXJuIC1F
Tk9NRU07Cj4gQEAgLTMxMywxMSArMzEzLDExIEBAIGludGVsX2VuZ2luZV9zZXR1cChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAKPiAgIAllbmdpbmUtPmlkID0gaWQ7Cj4g
ICAJZW5naW5lLT5tYXNrID0gQklUKGlkKTsKPiAtCWVuZ2luZS0+aTkxNSA9IGRldl9wcml2Owo+
IC0JZW5naW5lLT51bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsKPiArCWVuZ2luZS0+aTkxNSA9
IGk5MTU7Cj4gKwllbmdpbmUtPnVuY29yZSA9ICZpOTE1LT51bmNvcmU7Cj4gICAJX19zcHJpbnRf
ZW5naW5lX25hbWUoZW5naW5lLT5uYW1lLCBpbmZvKTsKPiAgIAllbmdpbmUtPmh3X2lkID0gZW5n
aW5lLT5ndWNfaWQgPSBpbmZvLT5od19pZDsKPiAtCWVuZ2luZS0+bW1pb19iYXNlID0gX19lbmdp
bmVfbW1pb19iYXNlKGRldl9wcml2LCBpbmZvLT5tbWlvX2Jhc2VzKTsKPiArCWVuZ2luZS0+bW1p
b19iYXNlID0gX19lbmdpbmVfbW1pb19iYXNlKGk5MTUsIGluZm8tPm1taW9fYmFzZXMpOwo+ICAg
CWVuZ2luZS0+Y2xhc3MgPSBpbmZvLT5jbGFzczsKPiAgIAllbmdpbmUtPmluc3RhbmNlID0gaW5m
by0+aW5zdGFuY2U7Cj4gICAKPiBAQCAtMzI5LDEyICszMjksMTIgQEAgaW50ZWxfZW5naW5lX3Nl
dHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAo+ICAgCWVuZ2luZS0+
dWFiaV9jbGFzcyA9IGludGVsX2VuZ2luZV9jbGFzc2VzW2luZm8tPmNsYXNzXS51YWJpX2NsYXNz
Owo+ICAgCj4gLQllbmdpbmUtPmNvbnRleHRfc2l6ZSA9IGludGVsX2VuZ2luZV9jb250ZXh0X3Np
emUoZGV2X3ByaXYsCj4gKwllbmdpbmUtPmNvbnRleHRfc2l6ZSA9IGludGVsX2VuZ2luZV9jb250
ZXh0X3NpemUoaTkxNSwKPiAgIAkJCQkJCQkgZW5naW5lLT5jbGFzcyk7Cj4gICAJaWYgKFdBUk5f
T04oZW5naW5lLT5jb250ZXh0X3NpemUgPiBCSVQoMjApKSkKPiAgIAkJZW5naW5lLT5jb250ZXh0
X3NpemUgPSAwOwo+ICAgCWlmIChlbmdpbmUtPmNvbnRleHRfc2l6ZSkKPiAtCQlEUklWRVJfQ0FQ
UyhkZXZfcHJpdiktPmhhc19sb2dpY2FsX2NvbnRleHRzID0gdHJ1ZTsKPiArCQlEUklWRVJfQ0FQ
UyhpOTE1KS0+aGFzX2xvZ2ljYWxfY29udGV4dHMgPSB0cnVlOwo+ICAgCj4gICAJLyogTm90aGlu
ZyB0byBkbyBoZXJlLCBleGVjdXRlIGluIG9yZGVyIG9mIGRlcGVuZGVuY2llcyAqLwo+ICAgCWVu
Z2luZS0+c2NoZWR1bGUgPSBOVUxMOwo+IEBAIC0zNDYsOCArMzQ2LDggQEAgaW50ZWxfZW5naW5l
X3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkvKiBTY3J1YiBt
bWlvIHN0YXRlIG9uIHRha2VvdmVyICovCj4gICAJaW50ZWxfZW5naW5lX3Nhbml0aXplX21taW8o
ZW5naW5lKTsKPiAgIAo+IC0JZGV2X3ByaXYtPmVuZ2luZV9jbGFzc1tpbmZvLT5jbGFzc11baW5m
by0+aW5zdGFuY2VdID0gZW5naW5lOwo+IC0JZGV2X3ByaXYtPmVuZ2luZVtpZF0gPSBlbmdpbmU7
Cj4gKwlpOTE1LT5lbmdpbmVfY2xhc3NbaW5mby0+Y2xhc3NdW2luZm8tPmluc3RhbmNlXSA9IGVu
Z2luZTsKPiArCWk5MTUtPmVuZ2luZVtpZF0gPSBlbmdpbmU7Cj4gICAJcmV0dXJuIDA7Cj4gICB9
Cj4gICAKPiBAQCAtOTUzLDE3ICs5NTMsMTcgQEAgY29uc3QgY2hhciAqaTkxNV9jYWNoZV9sZXZl
bF9zdHIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGludCB0eXBlKQo+ICAgCX0KPiAg
IH0KPiAgIAo+IC11MzIgaW50ZWxfY2FsY3VsYXRlX21jcl9zX3NzX3NlbGVjdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3UzMiBpbnRlbF9jYWxjdWxhdGVfbWNyX3Nfc3Nf
c2VsZWN0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JY29uc3Qgc3Ry
dWN0IHNzZXVfZGV2X2luZm8gKnNzZXUgPSAmUlVOVElNRV9JTkZPKGRldl9wcml2KS0+c3NldTsK
PiArCWNvbnN0IHN0cnVjdCBzc2V1X2Rldl9pbmZvICpzc2V1ID0gJlJVTlRJTUVfSU5GTyhpOTE1
KS0+c3NldTsKPiAgIAl1MzIgbWNyX3Nfc3Nfc2VsZWN0Owo+ICAgCXUzMiBzbGljZSA9IGZscyhz
c2V1LT5zbGljZV9tYXNrKTsKPiAgIAl1MzIgc3Vic2xpY2UgPSBmbHMoc3NldS0+c3Vic2xpY2Vf
bWFza1tzbGljZV0pOwo+ICAgCj4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCAxMCkpCj4gKwlpZiAo
SVNfR0VOKGk5MTUsIDEwKSkKPiAgIAkJbWNyX3Nfc3Nfc2VsZWN0ID0gR0VOOF9NQ1JfU0xJQ0Uo
c2xpY2UpIHwKPiAgIAkJCQkgIEdFTjhfTUNSX1NVQlNMSUNFKHN1YnNsaWNlKTsKPiAtCWVsc2Ug
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCj4gKwllbHNlIGlmIChJTlRFTF9HRU4oaTkx
NSkgPj0gMTEpCj4gICAJCW1jcl9zX3NzX3NlbGVjdCA9IEdFTjExX01DUl9TTElDRShzbGljZSkg
fAo+ICAgCQkJCSAgR0VOMTFfTUNSX1NVQlNMSUNFKHN1YnNsaWNlKTsKPiAgIAllbHNlCj4gQEAg
LTEwOTUsNyArMTA5NSw3IEBAIHZvaWQgaW50ZWxfZW5naW5lX2dldF9pbnN0ZG9uZShzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUsCj4gICAKPiAgIHN0YXRpYyBib29sIHJpbmdfaXNfaWRs
ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBlbmdpbmUtPmk5MTU7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IGVuZ2luZS0+aTkxNTsKPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJl
ZjsKPiAgIAlib29sIGlkbGUgPSB0cnVlOwo+ICAgCj4gQEAgLTExMDMsNyArMTEwMyw3IEBAIHN0
YXRpYyBib29sIHJpbmdfaXNfaWRsZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4g
ICAJCXJldHVybiB0cnVlOwo+ICAgCj4gICAJLyogSWYgdGhlIHdob2xlIGRldmljZSBpcyBhc2xl
ZXAsIHRoZSBlbmdpbmUgbXVzdCBiZSBpZGxlICovCj4gLQl3YWtlcmVmID0gaW50ZWxfcnVudGlt
ZV9wbV9nZXRfaWZfaW5fdXNlKGRldl9wcml2KTsKPiArCXdha2VyZWYgPSBpbnRlbF9ydW50aW1l
X3BtX2dldF9pZl9pbl91c2UoaTkxNSk7Cj4gICAJaWYgKCF3YWtlcmVmKQo+ICAgCQlyZXR1cm4g
dHJ1ZTsKPiAgIAo+IEBAIC0xMTEzLDExICsxMTEzLDExIEBAIHN0YXRpYyBib29sIHJpbmdfaXNf
aWRsZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gICAJCWlkbGUgPSBmYWxzZTsK
PiAgIAo+ICAgCS8qIE5vIGJpdCBmb3IgZ2VuMiwgc28gYXNzdW1lIHRoZSBDUyBwYXJzZXIgaXMg
aWRsZSAqLwo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPiAyICYmCj4gKwlpZiAoSU5URUxf
R0VOKGk5MTUpID4gMiAmJgo+ICAgCSAgICAhKEVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19NSV9N
T0RFKSAmIE1PREVfSURMRSkpCj4gICAJCWlkbGUgPSBmYWxzZTsKPiAgIAo+IC0JaW50ZWxfcnVu
dGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOwo+ICsJaW50ZWxfcnVudGltZV9wbV9wdXQo
aTkxNSwgd2FrZXJlZik7Cj4gICAKPiAgIAlyZXR1cm4gaWRsZTsKPiAgIH0KPiBAQCAtMTMyMSwx
MiArMTMyMSwxMiBAQCBzdGF0aWMgdm9pZCBoZXhkdW1wKHN0cnVjdCBkcm1fcHJpbnRlciAqbSwg
Y29uc3Qgdm9pZCAqYnVmLCBzaXplX3QgbGVuKQo+ICAgc3RhdGljIHZvaWQgaW50ZWxfZW5naW5l
X3ByaW50X3JlZ2lzdGVycyhjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCj4g
ICAJCQkJCSBzdHJ1Y3QgZHJtX3ByaW50ZXIgKm0pCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSBlbmdpbmUtPmk5MTU7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IGVuZ2luZS0+aTkxNTsKPiAgIAljb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5l
X2V4ZWNsaXN0cyAqIGNvbnN0IGV4ZWNsaXN0cyA9Cj4gICAJCSZlbmdpbmUtPmV4ZWNsaXN0czsK
PiAgIAl1NjQgYWRkcjsKPiAgIAo+IC0JaWYgKGVuZ2luZS0+aWQgPT0gUkNTMCAmJiBJU19HRU5f
UkFOR0UoZGV2X3ByaXYsIDQsIDcpKQo+ICsJaWYgKGVuZ2luZS0+aWQgPT0gUkNTMCAmJiBJU19H
RU5fUkFOR0UoaTkxNSwgNCwgNykpCj4gICAJCWRybV9wcmludGYobSwgIlx0Q0NJRDogMHglMDh4
XG4iLCBFTkdJTkVfUkVBRChlbmdpbmUsIENDSUQpKTsKPiAgIAlkcm1fcHJpbnRmKG0sICJcdFJJ
TkdfU1RBUlQ6IDB4JTA4eFxuIiwKPiAgIAkJICAgRU5HSU5FX1JFQUQoZW5naW5lLCBSSU5HX1NU
QVJUKSk7Cj4gQEAgLTEzNDMsNyArMTM0Myw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2VuZ2luZV9w
cmludF9yZWdpc3RlcnMoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAo+ICAg
CQkJICAgRU5HSU5FX1JFQUQoZW5naW5lLCBSSU5HX01JX01PREUpICYgKE1PREVfSURMRSkgPyAi
IFtpZGxlXSIgOiAiIik7Cj4gICAJfQo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+
PSA2KSB7Cj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDYpIHsKPiAgIAkJZHJtX3ByaW50Ziht
LCAiXHRSSU5HX0lNUjogJTA4eFxuIiwKPiAgIAkJCSAgIEVOR0lORV9SRUFEKGVuZ2luZSwgUklO
R19JTVIpKTsKPiAgIAl9Cj4gQEAgLTEzNTQsMTUgKzEzNTQsMTUgQEAgc3RhdGljIHZvaWQgaW50
ZWxfZW5naW5lX3ByaW50X3JlZ2lzdGVycyhjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUsCj4gICAJYWRkciA9IGludGVsX2VuZ2luZV9nZXRfbGFzdF9iYXRjaF9oZWFkKGVuZ2lu
ZSk7Cj4gICAJZHJtX3ByaW50ZihtLCAiXHRCQkFERFI6IDB4JTA4eF8lMDh4XG4iLAo+ICAgCQkg
ICB1cHBlcl8zMl9iaXRzKGFkZHIpLCBsb3dlcl8zMl9iaXRzKGFkZHIpKTsKPiAtCWlmIChJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDgpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDgpCj4gICAJ
CWFkZHIgPSBFTkdJTkVfUkVBRDY0KGVuZ2luZSwgUklOR19ETUFfRkFERCwgUklOR19ETUFfRkFE
RF9VRFcpOwo+IC0JZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA0KQo+ICsJZWxzZSBp
ZiAoSU5URUxfR0VOKGk5MTUpID49IDQpCj4gICAJCWFkZHIgPSBFTkdJTkVfUkVBRChlbmdpbmUs
IFJJTkdfRE1BX0ZBREQpOwo+ICAgCWVsc2UKPiAgIAkJYWRkciA9IEVOR0lORV9SRUFEKGVuZ2lu
ZSwgRE1BX0ZBRERfSThYWCk7Cj4gICAJZHJtX3ByaW50ZihtLCAiXHRETUFfRkFERFI6IDB4JTA4
eF8lMDh4XG4iLAo+ICAgCQkgICB1cHBlcl8zMl9iaXRzKGFkZHIpLCBsb3dlcl8zMl9iaXRzKGFk
ZHIpKTsKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDQpIHsKPiArCWlmIChJTlRFTF9H
RU4oaTkxNSkgPj0gNCkgewo+ICAgCQlkcm1fcHJpbnRmKG0sICJcdElQRUlSOiAweCUwOHhcbiIs
Cj4gICAJCQkgICBFTkdJTkVfUkVBRChlbmdpbmUsIFJJTkdfSVBFSVIpKTsKPiAgIAkJZHJtX3By
aW50ZihtLCAiXHRJUEVIUjogMHglMDh4XG4iLAo+IEBAIC0xMzcyLDcgKzEzNzIsNyBAQCBzdGF0
aWMgdm9pZCBpbnRlbF9lbmdpbmVfcHJpbnRfcmVnaXN0ZXJzKGNvbnN0IHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSwKPiAgIAkJZHJtX3ByaW50ZihtLCAiXHRJUEVIUjogMHglMDh4XG4i
LCBFTkdJTkVfUkVBRChlbmdpbmUsIElQRUhSKSk7Cj4gICAJfQo+ICAgCj4gLQlpZiAoSEFTX0VY
RUNMSVNUUyhkZXZfcHJpdikpIHsKPiArCWlmIChIQVNfRVhFQ0xJU1RTKGk5MTUpKSB7Cj4gICAJ
CWNvbnN0IHUzMiAqaHdzID0KPiAgIAkJCSZlbmdpbmUtPnN0YXR1c19wYWdlLmFkZHJbSTkxNV9I
V1NfQ1NCX0JVRjBfSU5ERVhdOwo+ICAgCQljb25zdCB1OCBudW1fZW50cmllcyA9IGV4ZWNsaXN0
cy0+Y3NiX3NpemU7Cj4gQEAgLTE0MjYsNyArMTQyNiw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2Vu
Z2luZV9wcmludF9yZWdpc3RlcnMoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
LAo+ICAgCQl9Cj4gICAJCWRybV9wcmludGYobSwgIlx0XHRIVyBhY3RpdmU/IDB4JXhcbiIsIGV4
ZWNsaXN0cy0+YWN0aXZlKTsKPiAgIAkJcmN1X3JlYWRfdW5sb2NrKCk7Cj4gLQl9IGVsc2UgaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPiA2KSB7Cj4gKwl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1
KSA+IDYpIHsKPiAgIAkJZHJtX3ByaW50ZihtLCAiXHRQUF9ESVJfQkFTRTogMHglMDh4XG4iLAo+
ICAgCQkJICAgRU5HSU5FX1JFQUQoZW5naW5lLCBSSU5HX1BQX0RJUl9CQVNFKSk7Cj4gICAJCWRy
bV9wcmludGYobSwgIlx0UFBfRElSX0JBU0VfUkVBRDogMHglMDh4XG4iLAo+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5nY2hlY2suYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2hhbmdjaGVjay5jCj4gaW5kZXggMTc0YmIwYTYwMzA5Li45NDg0
MjNjNWY2N2QgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfaGFu
Z2NoZWNrLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5nY2hlY2su
Ywo+IEBAIC01MCw3ICs1MCw3IEBAIHN0YXRpYyBib29sIGluc3Rkb25lX3VuY2hhbmdlZCh1MzIg
Y3VycmVudF9pbnN0ZG9uZSwgdTMyICpvbGRfaW5zdGRvbmUpCj4gICAKPiAgIHN0YXRpYyBib29s
IHN1YnVuaXRzX3N0dWNrKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGVuZ2luZS0+aTkxNTsKPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZW5naW5lLT5pOTE1Owo+ICAgCXN0cnVjdCBp
bnRlbF9pbnN0ZG9uZSBpbnN0ZG9uZTsKPiAgIAlzdHJ1Y3QgaW50ZWxfaW5zdGRvbmUgKmFjY3Vf
aW5zdGRvbmUgPSAmZW5naW5lLT5oYW5nY2hlY2suaW5zdGRvbmU7Cj4gICAJYm9vbCBzdHVjazsK
PiBAQCAtNzIsNyArNzIsNyBAQCBzdGF0aWMgYm9vbCBzdWJ1bml0c19zdHVjayhzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gICAJc3R1Y2sgJj0gaW5zdGRvbmVfdW5jaGFuZ2VkKGlu
c3Rkb25lLnNsaWNlX2NvbW1vbiwKPiAgIAkJCQkgICAgJmFjY3VfaW5zdGRvbmUtPnNsaWNlX2Nv
bW1vbik7Cj4gICAKPiAtCWZvcl9lYWNoX2luc3Rkb25lX3NsaWNlX3N1YnNsaWNlKGRldl9wcml2
LCBzbGljZSwgc3Vic2xpY2UpIHsKPiArCWZvcl9lYWNoX2luc3Rkb25lX3NsaWNlX3N1YnNsaWNl
KGk5MTUsIHNsaWNlLCBzdWJzbGljZSkgewo+ICAgCQlzdHVjayAmPSBpbnN0ZG9uZV91bmNoYW5n
ZWQoaW5zdGRvbmUuc2FtcGxlcltzbGljZV1bc3Vic2xpY2VdLAo+ICAgCQkJCQkgICAgJmFjY3Vf
aW5zdGRvbmUtPnNhbXBsZXJbc2xpY2VdW3N1YnNsaWNlXSk7Cj4gICAJCXN0dWNrICY9IGluc3Rk
b25lX3VuY2hhbmdlZChpbnN0ZG9uZS5yb3dbc2xpY2VdW3N1YnNsaWNlXSwKPiBAQCAtMTAzLDcg
KzEwMyw3IEBAIGhlYWRfc3R1Y2soc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1NjQg
YWN0aGQpCj4gICBzdGF0aWMgZW51bSBpbnRlbF9lbmdpbmVfaGFuZ2NoZWNrX2FjdGlvbgo+ICAg
ZW5naW5lX3N0dWNrKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgdTY0IGFjdGhkKQo+
ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZW5naW5lLT5pOTE1
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBlbmdpbmUtPmk5MTU7Cj4gICAJ
ZW51bSBpbnRlbF9lbmdpbmVfaGFuZ2NoZWNrX2FjdGlvbiBoYTsKPiAgIAl1MzIgdG1wOwo+ICAg
Cj4gQEAgLTExMSw3ICsxMTEsNyBAQCBlbmdpbmVfc3R1Y2soc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lLCB1NjQgYWN0aGQpCj4gICAJaWYgKGhhICE9IEVOR0lORV9ERUFEKQo+ICAgCQly
ZXR1cm4gaGE7Cj4gICAKPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDIpKQo+ICsJaWYgKElTX0dF
TihpOTE1LCAyKSkKPiAgIAkJcmV0dXJuIEVOR0lORV9ERUFEOwo+ICAgCj4gICAJLyogSXMgdGhl
IGNoaXAgaGFuZ2luZyBvbiBhIFdBSVRfRk9SX0VWRU5UPwo+IEBAIC0xMjEsNyArMTIxLDcgQEAg
ZW5naW5lX3N0dWNrKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgdTY0IGFjdGhkKQo+
ICAgCSAqLwo+ICAgCXRtcCA9IEVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19DVEwpOwo+ICAgCWlm
ICh0bXAgJiBSSU5HX1dBSVQpIHsKPiAtCQlpOTE1X2hhbmRsZV9lcnJvcihkZXZfcHJpdiwgZW5n
aW5lLT5tYXNrLCAwLAo+ICsJCWk5MTVfaGFuZGxlX2Vycm9yKGk5MTUsIGVuZ2luZS0+bWFzaywg
MCwKPiAgIAkJCQkgICJzdHVjayB3YWl0IG9uICVzIiwgZW5naW5lLT5uYW1lKTsKPiAgIAkJRU5H
SU5FX1dSSVRFKGVuZ2luZSwgUklOR19DVEwsIHRtcCk7Cj4gICAJCXJldHVybiBFTkdJTkVfV0FJ
VF9LSUNLOwo+IEBAIC0yNTYsOCArMjU2LDggQEAgc3RhdGljIHZvaWQgaGFuZ2NoZWNrX2RlY2xh
cmVfaGFuZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgICAqLwo+ICAgc3RhdGlj
IHZvaWQgaTkxNV9oYW5nY2hlY2tfZWxhcHNlZChzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+IC0JCWNvbnRhaW5l
cl9vZih3b3JrLCB0eXBlb2YoKmRldl9wcml2KSwKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0KPiArCQljb250YWluZXJfb2Yod29yaywgdHlwZW9mKCppOTE1KSwKPiAgIAkJCSAg
ICAgZ3B1X2Vycm9yLmhhbmdjaGVja193b3JrLndvcmspOwo+ICAgCWludGVsX2VuZ2luZV9tYXNr
X3QgaHVuZyA9IDAsIHN0dWNrID0gMCwgd2VkZ2VkID0gMDsKPiAgIAlzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmU7Cj4gQEAgLTI2NywxMyArMjY3LDEzIEBAIHN0YXRpYyB2b2lkIGk5MTVf
aGFuZ2NoZWNrX2VsYXBzZWQoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAgCWlmICghaTkx
NV9tb2RwYXJhbXMuZW5hYmxlX2hhbmdjaGVjaykKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQlpZiAo
IVJFQURfT05DRShkZXZfcHJpdi0+Z3QuYXdha2UpKQo+ICsJaWYgKCFSRUFEX09OQ0UoaTkxNS0+
Z3QuYXdha2UpKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCWlmIChpOTE1X3Rlcm1pbmFsbHlfd2Vk
Z2VkKGRldl9wcml2KSkKPiArCWlmIChpOTE1X3Rlcm1pbmFsbHlfd2VkZ2VkKGk5MTUpKQo+ICAg
CQlyZXR1cm47Cj4gICAKPiAtCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91
c2UoZGV2X3ByaXYpOwo+ICsJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3Vz
ZShpOTE1KTsKPiAgIAlpZiAoIXdha2VyZWYpCj4gICAJCXJldHVybjsKPiAgIAo+IEBAIC0yODEs
OSArMjgxLDkgQEAgc3RhdGljIHZvaWQgaTkxNV9oYW5nY2hlY2tfZWxhcHNlZChzdHJ1Y3Qgd29y
a19zdHJ1Y3QgKndvcmspCj4gICAJICogcGVyaW9kaWNhbGx5IGFybSB0aGUgbW1pbyBjaGVja2Vy
IHRvIHNlZSBpZiB3ZSBhcmUgdHJpZ2dlcmluZwo+ICAgCSAqIGFueSBpbnZhbGlkIGFjY2Vzcy4K
PiAgIAkgKi8KPiAtCWludGVsX3VuY29yZV9hcm1fdW5jbGFpbWVkX21taW9fZGV0ZWN0aW9uKCZk
ZXZfcHJpdi0+dW5jb3JlKTsKPiArCWludGVsX3VuY29yZV9hcm1fdW5jbGFpbWVkX21taW9fZGV0
ZWN0aW9uKCZpOTE1LT51bmNvcmUpOwo+ICAgCj4gLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBk
ZXZfcHJpdiwgaWQpIHsKPiArCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKSB7Cj4g
ICAJCXN0cnVjdCBoYW5nY2hlY2sgaGM7Cj4gICAKPiAgIAkJaW50ZWxfZW5naW5lX3NpZ25hbF9i
cmVhZGNydW1icyhlbmdpbmUpOwo+IEBAIC0zMDUsNyArMzA1LDcgQEAgc3RhdGljIHZvaWQgaTkx
NV9oYW5nY2hlY2tfZWxhcHNlZChzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gICAJaWYgKEdF
TV9TSE9XX0RFQlVHKCkgJiYgKGh1bmcgfCBzdHVjaykpIHsKPiAgIAkJc3RydWN0IGRybV9wcmlu
dGVyIHAgPSBkcm1fZGVidWdfcHJpbnRlcigiaGFuZ2NoZWNrIik7Cj4gICAKPiAtCQlmb3JfZWFj
aF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpIHsKPiArCQlmb3JfZWFjaF9lbmdpbmUoZW5n
aW5lLCBpOTE1LCBpZCkgewo+ICAgCQkJaWYgKGludGVsX2VuZ2luZV9pc19pZGxlKGVuZ2luZSkp
Cj4gICAJCQkJY29udGludWU7Cj4gICAKPiBAQCAtMzE0LDIwICszMTQsMjAgQEAgc3RhdGljIHZv
aWQgaTkxNV9oYW5nY2hlY2tfZWxhcHNlZChzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gICAJ
fQo+ICAgCj4gICAJaWYgKHdlZGdlZCkgewo+IC0JCWRldl9lcnIoZGV2X3ByaXYtPmRybS5kZXYs
Cj4gKwkJZGV2X2VycihpOTE1LT5kcm0uZGV2LAo+ICAgCQkJIkdQVSByZWNvdmVyeSB0aW1lZCBv
dXQsIgo+ICAgCQkJIiBjYW5jZWxsaW5nIGFsbCBpbi1mbGlnaHQgcmVuZGVyaW5nLlxuIik7Cj4g
ICAJCUdFTV9UUkFDRV9EVU1QKCk7Cj4gLQkJaTkxNV9nZW1fc2V0X3dlZGdlZChkZXZfcHJpdik7
Cj4gKwkJaTkxNV9nZW1fc2V0X3dlZGdlZChpOTE1KTsKPiAgIAl9Cj4gICAKPiAgIAlpZiAoaHVu
ZykKPiAtCQloYW5nY2hlY2tfZGVjbGFyZV9oYW5nKGRldl9wcml2LCBodW5nLCBzdHVjayk7Cj4g
KwkJaGFuZ2NoZWNrX2RlY2xhcmVfaGFuZyhpOTE1LCBodW5nLCBzdHVjayk7Cj4gICAKPiAtCWlu
dGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKPiArCWludGVsX3J1bnRpbWVf
cG1fcHV0KGk5MTUsIHdha2VyZWYpOwo+ICAgCj4gICAJLyogUmVzZXQgdGltZXIgaW4gY2FzZSBH
UFUgaGFuZ3Mgd2l0aG91dCBhbm90aGVyIHJlcXVlc3QgYmVpbmcgYWRkZWQgKi8KPiAtCWk5MTVf
cXVldWVfaGFuZ2NoZWNrKGRldl9wcml2KTsKPiArCWk5MTVfcXVldWVfaGFuZ2NoZWNrKGk5MTUp
Owo+ICAgfQo+ICAgCj4gICB2b2lkIGludGVsX2VuZ2luZV9pbml0X2hhbmdjaGVjayhzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX21vY3MuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX21vY3Mu
Ywo+IGluZGV4IDc5ZGY2NjAyMmQzYS4uOWQ2ZjA4OTNmNTI4IDEwMDY0NAo+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX21vY3MuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX21vY3MuYwo+IEBAIC0yMzksNyArMjM5LDcgQEAgc3RhdGljIGNvbnN0IHN0
cnVjdCBkcm1faTkxNV9tb2NzX2VudHJ5IGljZWxha2VfbW9jc190YWJsZVtdID0gewo+ICAgCj4g
ICAvKioKPiAgICAqIGdldF9tb2NzX3NldHRpbmdzKCkKPiAtICogQGRldl9wcml2OglpOTE1IGRl
dmljZS4KPiArICogQGk5MTU6CWk5MTUgZGV2aWNlLgo+ICAgICogQHRhYmxlOiAgICAgIE91dHB1
dCB0YWJsZSB0aGF0IHdpbGwgYmUgbWFkZSB0byBwb2ludCBhdCBhcHByb3ByaWF0ZQo+ICAgICoJ
ICAgICAgTU9DUyB2YWx1ZXMgZm9yIHRoZSBkZXZpY2UuCj4gICAgKgo+IEBAIC0yNDksMzMgKzI0
OSwzMyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9pOTE1X21vY3NfZW50cnkgaWNlbGFrZV9t
b2NzX3RhYmxlW10gPSB7Cj4gICAgKgo+ICAgICogUmV0dXJuOiB0cnVlIGlmIHRoZXJlIGFyZSBh
cHBsaWNhYmxlIE1PQ1Mgc2V0dGluZ3MgZm9yIHRoZSBkZXZpY2UuCj4gICAgKi8KPiAtc3RhdGlj
IGJvb2wgZ2V0X21vY3Nfc2V0dGluZ3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ICtzdGF0aWMgYm9vbCBnZXRfbW9jc19zZXR0aW5ncyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwKPiAgIAkJCSAgICAgIHN0cnVjdCBkcm1faTkxNV9tb2NzX3RhYmxlICp0YWJsZSkK
PiAgIHsKPiAgIAlib29sIHJlc3VsdCA9IGZhbHNlOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRl
dl9wcml2KSA+PSAxMSkgewo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkgewo+ICAgCQl0
YWJsZS0+c2l6ZSAgPSBBUlJBWV9TSVpFKGljZWxha2VfbW9jc190YWJsZSk7Cj4gICAJCXRhYmxl
LT50YWJsZSA9IGljZWxha2VfbW9jc190YWJsZTsKPiAgIAkJdGFibGUtPm5fZW50cmllcyA9IEdF
TjExX05VTV9NT0NTX0VOVFJJRVM7Cj4gICAJCXJlc3VsdCA9IHRydWU7Cj4gLQl9IGVsc2UgaWYg
KElTX0dFTjlfQkMoZGV2X3ByaXYpIHx8IElTX0NBTk5PTkxBS0UoZGV2X3ByaXYpKSB7Cj4gKwl9
IGVsc2UgaWYgKElTX0dFTjlfQkMoaTkxNSkgfHwgSVNfQ0FOTk9OTEFLRShpOTE1KSkgewo+ICAg
CQl0YWJsZS0+c2l6ZSAgPSBBUlJBWV9TSVpFKHNreWxha2VfbW9jc190YWJsZSk7Cj4gICAJCXRh
YmxlLT5uX2VudHJpZXMgPSBHRU45X05VTV9NT0NTX0VOVFJJRVM7Cj4gICAJCXRhYmxlLT50YWJs
ZSA9IHNreWxha2VfbW9jc190YWJsZTsKPiAgIAkJcmVzdWx0ID0gdHJ1ZTsKPiAtCX0gZWxzZSBp
ZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAoSVNfR0VOOV9MUChpOTE1
KSkgewo+ICAgCQl0YWJsZS0+c2l6ZSAgPSBBUlJBWV9TSVpFKGJyb3h0b25fbW9jc190YWJsZSk7
Cj4gICAJCXRhYmxlLT5uX2VudHJpZXMgPSBHRU45X05VTV9NT0NTX0VOVFJJRVM7Cj4gICAJCXRh
YmxlLT50YWJsZSA9IGJyb3h0b25fbW9jc190YWJsZTsKPiAgIAkJcmVzdWx0ID0gdHJ1ZTsKPiAg
IAl9IGVsc2Ugewo+IC0JCVdBUk5fT05DRShJTlRFTF9HRU4oZGV2X3ByaXYpID49IDksCj4gKwkJ
V0FSTl9PTkNFKElOVEVMX0dFTihpOTE1KSA+PSA5LAo+ICAgCQkJICAiUGxhdGZvcm0gdGhhdCBz
aG91bGQgaGF2ZSBhIE1PQ1MgdGFibGUgZG9lcyBub3QuXG4iKTsKPiAgIAl9Cj4gICAKPiAgIAkv
KiBXYURpc2FibGVTa2lwQ2FjaGluZzpza2wsYnh0LGtibCxnbGsgKi8KPiAtCWlmIChJU19HRU4o
ZGV2X3ByaXYsIDkpKSB7Cj4gKwlpZiAoSVNfR0VOKGk5MTUsIDkpKSB7Cj4gICAJCWludCBpOwo+
ICAgCj4gICAJCWZvciAoaSA9IDA7IGkgPCB0YWJsZS0+c2l6ZTsgaSsrKQo+IEBAIC0zMzAsMTIg
KzMzMCwxMiBAQCBzdGF0aWMgdTMyIGdldF9lbnRyeV9jb250cm9sKGNvbnN0IHN0cnVjdCBkcm1f
aTkxNV9tb2NzX3RhYmxlICp0YWJsZSwKPiAgICAqLwo+ICAgdm9pZCBpbnRlbF9tb2NzX2luaXRf
ZW5naW5lKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiAgIHsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGVuZ2luZS0+aTkxNTsKPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gZW5naW5lLT5pOTE1Owo+ICAgCXN0cnVjdCBkcm1faTkxNV9t
b2NzX3RhYmxlIHRhYmxlOwo+ICAgCXVuc2lnbmVkIGludCBpbmRleDsKPiAgIAl1MzIgdW51c2Vk
X3ZhbHVlOwo+ICAgCj4gLQlpZiAoIWdldF9tb2NzX3NldHRpbmdzKGRldl9wcml2LCAmdGFibGUp
KQo+ICsJaWYgKCFnZXRfbW9jc19zZXR0aW5ncyhpOTE1LCAmdGFibGUpKQo+ICAgCQlyZXR1cm47
Cj4gICAKPiAgIAkvKiBTZXQgdW51c2VkIHZhbHVlcyB0byBQVEUgKi8KPiBAQCAtNDgyLDcgKzQ4
Miw3IEBAIHN0YXRpYyBpbnQgZW1pdF9tb2NzX2wzY2NfdGFibGUoc3RydWN0IGk5MTVfcmVxdWVz
dCAqcnEsCj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxfbW9jc19pbml0X2wzY2NfdGFibGUoKSAt
IHByb2dyYW0gdGhlIG1vY3MgY29udHJvbCB0YWJsZQo+IC0gKiBAZGV2X3ByaXY6ICAgICAgaTkx
NSBkZXZpY2UgcHJpdmF0ZQo+ICsgKiBAaTkxNTogICAgICBpOTE1IGRldmljZSBwcml2YXRlCj4g
ICAgKgo+ICAgICogVGhpcyBmdW5jdGlvbiBzaW1wbHkgcHJvZ3JhbXMgdGhlIG1vY3MgcmVnaXN0
ZXJzIGZvciB0aGUgZ2l2ZW4gdGFibGUKPiAgICAqIHN0YXJ0aW5nIGF0IHRoZSBnaXZlbiBhZGRy
ZXNzLiBUaGlzIHJlZ2lzdGVyIHNldCBpcyAgcHJvZ3JhbW1lZCBpbiBwYWlycy4KPiBAQCAtNDk0
LDEzICs0OTQsMTMgQEAgc3RhdGljIGludCBlbWl0X21vY3NfbDNjY190YWJsZShzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpycSwKPiAgICAqCj4gICAgKiBSZXR1cm46IE5vdGhpbmcuCj4gICAgKi8KPiAt
dm9pZCBpbnRlbF9tb2NzX2luaXRfbDNjY190YWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gK3ZvaWQgaW50ZWxfbW9jc19pbml0X2wzY2NfdGFibGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RydWN0IGRybV9pOTE1X21vY3NfdGFibGUg
dGFibGU7Cj4gICAJdW5zaWduZWQgaW50IGk7Cj4gICAJdTE2IHVudXNlZF92YWx1ZTsKPiAgIAo+
IC0JaWYgKCFnZXRfbW9jc19zZXR0aW5ncyhkZXZfcHJpdiwgJnRhYmxlKSkKPiArCWlmICghZ2V0
X21vY3Nfc2V0dGluZ3MoaTkxNSwgJnRhYmxlKSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJLyog
U2V0IHVudXNlZCB2YWx1ZXMgdG8gUFRFICovCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX21vY3MuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX21v
Y3MuaAo+IGluZGV4IDA5MTM3MDRhMWFmMi4uNmY4OTczZmJjYjNlIDEwMDY0NAo+IC0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX21vY3MuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX21vY3MuaAo+IEBAIC01NCw3ICs1NCw3IEBAIHN0cnVjdCBpOTE1X3Jl
cXVlc3Q7Cj4gICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzOwo+ICAgCj4gICBpbnQgaW50ZWxfcmNz
X2NvbnRleHRfaW5pdF9tb2NzKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKTsKPiAtdm9pZCBpbnRl
bF9tb2NzX2luaXRfbDNjY190YWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Owo+ICt2b2lkIGludGVsX21vY3NfaW5pdF9sM2NjX3RhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KTsKPiAgIHZvaWQgaW50ZWxfbW9jc19pbml0X2VuZ2luZShzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUpOwo+ICAgCj4gICAjZW5kaWYKPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX3Jlc2V0LmMKPiBpbmRleCA2MzY4YjM3ZjI2ZDEuLmQ1Y2QzY2NjYjQwNyAxMDA2NDQK
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jCj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwo+IEBAIC0xMjA4LDEzICsxMjA4LDEz
IEBAIHN0YXRpYyB2b2lkIGNsZWFyX2Vycm9yX3JlZ2lzdGVycyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiAgIAl9Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgZ2VuNl9jaGVja19m
YXVsdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBn
ZW42X2NoZWNrX2ZhdWx0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAg
IAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4gICAJZW51bSBpbnRlbF9lbmdpbmVf
aWQgaWQ7Cj4gICAJdTMyIGZhdWx0Owo+ICAgCj4gLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBk
ZXZfcHJpdiwgaWQpIHsKPiArCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKSB7Cj4g
ICAJCWZhdWx0ID0gR0VONl9SSU5HX0ZBVUxUX1JFR19SRUFEKGVuZ2luZSk7Cj4gICAJCWlmIChm
YXVsdCAmIFJJTkdfRkFVTFRfVkFMSUQpIHsKPiAgIAkJCURSTV9ERUJVR19EUklWRVIoIlVuZXhw
ZWN0ZWQgZmF1bHRcbiIKPiBAQCAtMTIzMCw3ICsxMjMwLDcgQEAgc3RhdGljIHZvaWQgZ2VuNl9j
aGVja19mYXVsdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCX0KPiAg
IH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBnZW44X2NoZWNrX2ZhdWx0cyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGdlbjhfY2hlY2tfZmF1bHRzKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUzMiBmYXVsdCA9IEk5MTVfUkVB
RChHRU44X1JJTkdfRkFVTFRfUkVHKTsKPiAgIAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9yaW5nYnVmZmVyLmMKPiBpbmRleCBiM2JmNDdlODE2MmYuLjhlYzJkMzMyZTIwNiAxMDA2
NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMKPiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMKPiBAQCAtNDg5
LDExICs0ODksMTEgQEAgc3RhdGljIHZvaWQgc2V0X2h3c3RhbShzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUsIHUzMiBtYXNrKQo+ICAgCj4gICBzdGF0aWMgdm9pZCBzZXRfaHdzX3BnYShz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHBoeXNfYWRkcl90IHBoeXMpCj4gICB7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBlbmdpbmUtPmk5MTU7Cj4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGVuZ2luZS0+aTkxNTsKPiAgIAl1MzIgYWRk
cjsKPiAgIAo+ICAgCWFkZHIgPSBsb3dlcl8zMl9iaXRzKHBoeXMpOwo+IC0JaWYgKElOVEVMX0dF
TihkZXZfcHJpdikgPj0gNCkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNCkKPiAgIAkJYWRk
ciB8PSAocGh5cyA+PiAyOCkgJiAweGYwOwo+ICAgCj4gICAJSTkxNV9XUklURShIV1NfUEdBLCBh
ZGRyKTsKPiBAQCAtNTE1LDE0ICs1MTUsMTQgQEAgc3RhdGljIHZvaWQgcmluZ19zZXR1cF9waHlz
X3N0YXR1c19wYWdlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiAgIAo+ICAgc3Rh
dGljIHZvaWQgc2V0X2h3c3Aoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1MzIgb2Zm
c2V0KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZW5naW5l
LT5pOTE1Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBlbmdpbmUtPmk5MTU7
Cj4gICAJaTkxNV9yZWdfdCBod3NwOwo+ICAgCj4gICAJLyoKPiAgIAkgKiBUaGUgcmluZyBzdGF0
dXMgcGFnZSBhZGRyZXNzZXMgYXJlIG5vIGxvbmdlciBuZXh0IHRvIHRoZSByZXN0IG9mCj4gICAJ
ICogdGhlIHJpbmcgcmVnaXN0ZXJzIGFzIG9mIGdlbjcuCj4gICAJICovCj4gLQlpZiAoSVNfR0VO
KGRldl9wcml2LCA3KSkgewo+ICsJaWYgKElTX0dFTihpOTE1LCA3KSkgewo+ICAgCQlzd2l0Y2gg
KGVuZ2luZS0+aWQpIHsKPiAgIAkJLyoKPiAgIAkJICogTm8gbW9yZSByaW5ncyBleGlzdCBvbiBH
ZW43LiBEZWZhdWx0IGNhc2UgaXMgb25seSB0byBzaHV0IHVwCj4gQEAgLTU0NCw3ICs1NDQsNyBA
QCBzdGF0aWMgdm9pZCBzZXRfaHdzcChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHUz
MiBvZmZzZXQpCj4gICAJCQlod3NwID0gVkVCT1hfSFdTX1BHQV9HRU43Owo+ICAgCQkJYnJlYWs7
Cj4gICAJCX0KPiAtCX0gZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCA2KSkgewo+ICsJfSBlbHNl
IGlmIChJU19HRU4oaTkxNSwgNikpIHsKPiAgIAkJaHdzcCA9IFJJTkdfSFdTX1BHQV9HRU42KGVu
Z2luZS0+bW1pb19iYXNlKTsKPiAgIAl9IGVsc2Ugewo+ICAgCQlod3NwID0gUklOR19IV1NfUEdB
KGVuZ2luZS0+bW1pb19iYXNlKTsKPiBAQCAtNTU2LDkgKzU1Niw5IEBAIHN0YXRpYyB2b2lkIHNl
dF9od3NwKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgdTMyIG9mZnNldCkKPiAgIAo+
ICAgc3RhdGljIHZvaWQgZmx1c2hfY3NfdGxiKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGVuZ2luZS0+
aTkxNTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZW5naW5lLT5pOTE1Owo+
ICAgCj4gLQlpZiAoIUlTX0dFTl9SQU5HRShkZXZfcHJpdiwgNiwgNykpCj4gKwlpZiAoIUlTX0dF
Tl9SQU5HRShpOTE1LCA2LCA3KSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJLyogcmluZyBzaG91
bGQgYmUgaWRsZSBiZWZvcmUgaXNzdWluZyBhIHN5bmMgZmx1c2gqLwo+IEBAIC01ODUsOSArNTg1
LDkgQEAgc3RhdGljIHZvaWQgcmluZ19zZXR1cF9zdGF0dXNfcGFnZShzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmUpCj4gICAKPiAgIHN0YXRpYyBib29sIHN0b3BfcmluZyhzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBlbmdpbmUtPmk5MTU7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IGVuZ2luZS0+aTkxNTsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPiAyKSB7
Cj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID4gMikgewo+ICAgCQlFTkdJTkVfV1JJVEUoZW5naW5l
LAo+ICAgCQkJICAgICBSSU5HX01JX01PREUsIF9NQVNLRURfQklUX0VOQUJMRShTVE9QX1JJTkcp
KTsKPiAgIAkJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKGVuZ2luZS0+dW5jb3JlLAo+IEBA
IC02MjIsNyArNjIyLDcgQEAgc3RhdGljIGJvb2wgc3RvcF9yaW5nKHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSkKPiAgIAo+ICAgc3RhdGljIGludCB4Y3NfcmVzdW1lKHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IGVuZ2luZS0+aTkxNTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gZW5naW5lLT5pOTE1Owo+ICAgCXN0cnVjdCBpbnRlbF9yaW5nICpyaW5nID0gZW5naW5lLT5i
dWZmZXI7Cj4gICAJaW50IHJldCA9IDA7Cj4gICAKPiBAQCAtNjU0LDcgKzY1NCw3IEBAIHN0YXRp
YyBpbnQgeGNzX3Jlc3VtZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gICAJCX0K
PiAgIAl9Cj4gICAKPiAtCWlmIChIV1NfTkVFRFNfUEhZU0lDQUwoZGV2X3ByaXYpKQo+ICsJaWYg
KEhXU19ORUVEU19QSFlTSUNBTChpOTE1KSkKPiAgIAkJcmluZ19zZXR1cF9waHlzX3N0YXR1c19w
YWdlKGVuZ2luZSk7Cj4gICAJZWxzZQo+ICAgCQlyaW5nX3NldHVwX3N0YXR1c19wYWdlKGVuZ2lu
ZSk7Cj4gQEAgLTcwNSw3ICs3MDUsNyBAQCBzdGF0aWMgaW50IHhjc19yZXN1bWUoc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+ICAgCQlnb3RvIG91dDsKPiAgIAl9Cj4gICAKPiAtCWlm
IChJTlRFTF9HRU4oZGV2X3ByaXYpID4gMikKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPiAyKQo+
ICAgCQlFTkdJTkVfV1JJVEUoZW5naW5lLAo+ICAgCQkJICAgICBSSU5HX01JX01PREUsIF9NQVNL
RURfQklUX0RJU0FCTEUoU1RPUF9SSU5HKSk7Cj4gICAKPiBAQCAtODE1LDcgKzgxNSw3IEBAIHN0
YXRpYyBpbnQgaW50ZWxfcmNzX2N0eF9pbml0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQo+ICAg
Cj4gICBzdGF0aWMgaW50IHJjc19yZXN1bWUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZW5naW5lLT5p
OTE1Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBlbmdpbmUtPmk5MTU7Cj4g
ICAKPiAgIAkvKgo+ICAgCSAqIERpc2FibGUgQ09OU1RBTlRfQlVGRkVSIGJlZm9yZSBpdCBpcyBs
b2FkZWQgZnJvbSB0aGUgY29udGV4dAo+IEBAIC04MjcsMTIgKzgyNywxMiBAQCBzdGF0aWMgaW50
IHJjc19yZXN1bWUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+ICAgCSAqIHRoZXkg
YXJlIGFscmVhZHkgYWNjdXN0b21lZCB0byBmcm9tIGJlZm9yZSBjb250ZXh0cyB3ZXJlCj4gICAJ
ICogZW5hYmxlZC4KPiAgIAkgKi8KPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDQpKQo+ICsJaWYg
KElTX0dFTihpOTE1LCA0KSkKPiAgIAkJSTkxNV9XUklURShFQ09TS1BELAo+ICAgCQkJICAgX01B
U0tFRF9CSVRfRU5BQkxFKEVDT19DT05TVEFOVF9CVUZGRVJfU1JfRElTQUJMRSkpOwo+ICAgCj4g
ICAJLyogV2FUaW1lZFNpbmdsZVZlcnRleERpc3BhdGNoOmNsLGJ3LGN0ZyxlbGssaWxrLHNuYiAq
Lwo+IC0JaWYgKElTX0dFTl9SQU5HRShkZXZfcHJpdiwgNCwgNikpCj4gKwlpZiAoSVNfR0VOX1JB
TkdFKGk5MTUsIDQsIDYpKQo+ICAgCQlJOTE1X1dSSVRFKE1JX01PREUsIF9NQVNLRURfQklUX0VO
QUJMRShWU19USU1FUl9ESVNQQVRDSCkpOwo+ICAgCj4gICAJLyogV2UgbmVlZCB0byBkaXNhYmxl
IHRoZSBBc3luY0ZsaXAgcGVyZm9ybWFuY2Ugb3B0aW1pc2F0aW9ucyBpbiBvcmRlcgo+IEBAIC04
NDEsMjIgKzg0MSwyMiBAQCBzdGF0aWMgaW50IHJjc19yZXN1bWUoc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lKQo+ICAgCSAqCj4gICAJICogV2FEaXNhYmxlQXN5bmNGbGlwUGVyZk1vZGU6
c25iLGl2Yixoc3csdmx2Cj4gICAJICovCj4gLQlpZiAoSVNfR0VOX1JBTkdFKGRldl9wcml2LCA2
LCA3KSkKPiArCWlmIChJU19HRU5fUkFOR0UoaTkxNSwgNiwgNykpCj4gICAJCUk5MTVfV1JJVEUo
TUlfTU9ERSwgX01BU0tFRF9CSVRfRU5BQkxFKEFTWU5DX0ZMSVBfUEVSRl9ESVNBQkxFKSk7Cj4g
ICAKPiAgIAkvKiBSZXF1aXJlZCBmb3IgdGhlIGhhcmR3YXJlIHRvIHByb2dyYW0gc2NhbmxpbmUg
dmFsdWVzIGZvciB3YWl0aW5nICovCj4gICAJLyogV2FFbmFibGVGbHVzaFRsYkludmFsaWRhdGlv
bk1vZGU6c25iICovCj4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCA2KSkKPiArCWlmIChJU19HRU4o
aTkxNSwgNikpCj4gICAJCUk5MTVfV1JJVEUoR0ZYX01PREUsCj4gICAJCQkgICBfTUFTS0VEX0JJ
VF9FTkFCTEUoR0ZYX1RMQl9JTlZBTElEQVRFX0VYUExJQ0lUKSk7Cj4gICAKPiAgIAkvKiBXYUJD
U1ZDU1RsYkludmFsaWRhdGlvbk1vZGU6aXZiLHZsdixoc3cgKi8KPiAtCWlmIChJU19HRU4oZGV2
X3ByaXYsIDcpKQo+ICsJaWYgKElTX0dFTihpOTE1LCA3KSkKPiAgIAkJSTkxNV9XUklURShHRlhf
TU9ERV9HRU43LAo+ICAgCQkJICAgX01BU0tFRF9CSVRfRU5BQkxFKEdGWF9UTEJfSU5WQUxJREFU
RV9FWFBMSUNJVCkgfAo+ICAgCQkJICAgX01BU0tFRF9CSVRfRU5BQkxFKEdGWF9SRVBMQVlfTU9E
RSkpOwo+ICAgCj4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCA2KSkgewo+ICsJaWYgKElTX0dFTihp
OTE1LCA2KSkgewo+ICAgCQkvKiBGcm9tIHRoZSBTYW5keWJyaWRnZSBQUk0sIHZvbHVtZSAxIHBh
cnQgMywgcGFnZSAyNDoKPiAgIAkJICogIklmIHRoaXMgYml0IGlzIHNldCwgU1RDdW5pdCB3aWxs
IGhhdmUgTFJBIGFzIHJlcGxhY2VtZW50Cj4gICAJCSAqICBwb2xpY3kuIFsuLi5dIFRoaXMgYml0
IG11c3QgYmUgcmVzZXQuICBMUkEgcmVwbGFjZW1lbnQKPiBAQCAtODY2LDcgKzg2Niw3IEBAIHN0
YXRpYyBpbnQgcmNzX3Jlc3VtZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gICAJ
CQkgICBfTUFTS0VEX0JJVF9ESVNBQkxFKENNMF9TVENfRVZJQ1RfRElTQUJMRV9MUkFfU05CKSk7
Cj4gICAJfQo+ICAgCj4gLQlpZiAoSVNfR0VOX1JBTkdFKGRldl9wcml2LCA2LCA3KSkKPiArCWlm
IChJU19HRU5fUkFOR0UoaTkxNSwgNiwgNykpCj4gICAJCUk5MTVfV1JJVEUoSU5TVFBNLCBfTUFT
S0VEX0JJVF9FTkFCTEUoSU5TVFBNX0ZPUkNFX09SREVSSU5HKSk7Cj4gICAKPiAgIAlyZXR1cm4g
eGNzX3Jlc3VtZShlbmdpbmUpOwo+IEBAIC0xMjI3LDE1ICsxMjI3LDE1IEBAIHZvaWQgaW50ZWxf
cmluZ191bnBpbihzdHJ1Y3QgaW50ZWxfcmluZyAqcmluZykKPiAgIH0KPiAgIAo+ICAgc3RhdGlj
IHN0cnVjdCBpOTE1X3ZtYSAqCj4gLWludGVsX3JpbmdfY3JlYXRlX3ZtYShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCBzaXplKQo+ICtpbnRlbF9yaW5nX2NyZWF0ZV92bWEo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGludCBzaXplKQo+ICAgewo+IC0Jc3RydWN0
IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSAmZGV2X3ByaXYtPmdndHQudm07Cj4gKwlzdHJ1Y3Qg
aTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9ICZpOTE1LT5nZ3R0LnZtOwo+ICAgCXN0cnVjdCBkcm1f
aTkxNV9nZW1fb2JqZWN0ICpvYmo7Cj4gICAJc3RydWN0IGk5MTVfdm1hICp2bWE7Cj4gICAKPiAt
CW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfc3RvbGVuKGRldl9wcml2LCBzaXplKTsKPiAr
CW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfc3RvbGVuKGk5MTUsIHNpemUpOwo+ICAgCWlm
ICghb2JqKQo+IC0JCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfaW50ZXJuYWwoZGV2X3By
aXYsIHNpemUpOwo+ICsJCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfaW50ZXJuYWwoaTkx
NSwgc2l6ZSk7Cj4gICAJaWYgKElTX0VSUihvYmopKQo+ICAgCQlyZXR1cm4gRVJSX0NBU1Qob2Jq
KTsKPiAgIAo+IEBAIC0yMTE1LDkgKzIxMTUsOSBAQCBzdGF0aWMgdm9pZCBnZW42X2JzZF9zZXRf
ZGVmYXVsdF9zdWJtaXNzaW9uKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiAgIAo+
ICAgc3RhdGljIHZvaWQgcmluZ19kZXN0cm95KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGVuZ2luZS0+
aTkxNTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZW5naW5lLT5pOTE1Owo+
ICAgCj4gLQlXQVJOX09OKElOVEVMX0dFTihkZXZfcHJpdikgPiAyICYmCj4gKwlXQVJOX09OKElO
VEVMX0dFTihpOTE1KSA+IDIgJiYKPiAgIAkJKEVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19NSV9N
T0RFKSAmIE1PREVfSURMRSkgPT0gMCk7Cj4gICAKPiAgIAlpbnRlbF9yaW5nX3VucGluKGVuZ2lu
ZS0+YnVmZmVyKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2FwZXJ0
dXJlX2dtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvYXBlcnR1cmVfZ20uYwo+IGluZGV4
IDFmYTJmNjVjM2NkMS4uODgwN2RlNTY2MzYxIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d2dC9hcGVydHVyZV9nbS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0
L2FwZXJ0dXJlX2dtLmMKPiBAQCAtNDAsNyArNDAsNyBAQAo+ICAgc3RhdGljIGludCBhbGxvY19n
bShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwgYm9vbCBoaWdoX2dtKQo+ICAgewo+ICAgCXN0cnVj
dCBpbnRlbF9ndnQgKmd2dCA9IHZncHUtPmd2dDsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IGd2dC0+ZGV2X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IGd2dC0+aTkxNTsKPiAgIAl1bnNpZ25lZCBpbnQgZmxhZ3M7Cj4gICAJdTY0IHN0YXJ0
LCBlbmQsIHNpemU7Cj4gICAJc3RydWN0IGRybV9tbV9ub2RlICpub2RlOwo+IEBAIC02MCwxNCAr
NjAsMTQgQEAgc3RhdGljIGludCBhbGxvY19nbShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwgYm9v
bCBoaWdoX2dtKQo+ICAgCQlmbGFncyA9IFBJTl9NQVBQQUJMRTsKPiAgIAl9Cj4gICAKPiAtCW11
dGV4X2xvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiAtCW1taW9faHdfYWNjZXNz
X3ByZShkZXZfcHJpdik7Cj4gLQlyZXQgPSBpOTE1X2dlbV9ndHRfaW5zZXJ0KCZkZXZfcHJpdi0+
Z2d0dC52bSwgbm9kZSwKPiArCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+
ICsJbW1pb19od19hY2Nlc3NfcHJlKGk5MTUpOwo+ICsJcmV0ID0gaTkxNV9nZW1fZ3R0X2luc2Vy
dCgmaTkxNS0+Z2d0dC52bSwgbm9kZSwKPiAgIAkJCQkgIHNpemUsIEk5MTVfR1RUX1BBR0VfU0la
RSwKPiAgIAkJCQkgIEk5MTVfQ09MT1JfVU5FVklDVEFCTEUsCj4gICAJCQkJICBzdGFydCwgZW5k
LCBmbGFncyk7Cj4gLQltbWlvX2h3X2FjY2Vzc19wb3N0KGRldl9wcml2KTsKPiAtCW11dGV4X3Vu
bG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJbW1pb19od19hY2Nlc3NfcG9z
dChpOTE1KTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAJ
aWYgKHJldCkKPiAgIAkJZ3Z0X2VycigiZmFpbCB0byBhbGxvYyAlcyBnbSBzcGFjZSBmcm9tIGhv
c3RcbiIsCj4gICAJCQloaWdoX2dtID8gImhpZ2giIDogImxvdyIpOwo+IEBAIC03OCw3ICs3OCw3
IEBAIHN0YXRpYyBpbnQgYWxsb2NfZ20oc3RydWN0IGludGVsX3ZncHUgKnZncHUsIGJvb2wgaGln
aF9nbSkKPiAgIHN0YXRpYyBpbnQgYWxsb2NfdmdwdV9nbShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdw
dSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQgPSB2Z3B1LT5ndnQ7Cj4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndnQtPmRldl9wcml2Owo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndnQtPmk5MTU7Cj4gICAJaW50IHJldDsKPiAgIAo+
ICAgCXJldCA9IGFsbG9jX2dtKHZncHUsIGZhbHNlKTsKPiBAQCAtOTcsMjAgKzk3LDIwIEBAIHN0
YXRpYyBpbnQgYWxsb2NfdmdwdV9nbShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKPiAgIAo+ICAg
CXJldHVybiAwOwo+ICAgb3V0X2ZyZWVfYXBlcnR1cmU6Cj4gLQltdXRleF9sb2NrKCZkZXZfcHJp
di0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211
dGV4KTsKPiAgIAlkcm1fbW1fcmVtb3ZlX25vZGUoJnZncHUtPmdtLmxvd19nbV9ub2RlKTsKPiAt
CW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJbXV0ZXhfdW5s
b2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+ICAg
Cj4gICBzdGF0aWMgdm9pZCBmcmVlX3ZncHVfZ20oc3RydWN0IGludGVsX3ZncHUgKnZncHUpCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2Z3B1LT5ndnQtPmRl
dl9wcml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2Z3B1LT5ndnQtPmk5
MTU7Cj4gICAKPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiAr
CW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCWRybV9tbV9yZW1vdmVf
bm9kZSgmdmdwdS0+Z20ubG93X2dtX25vZGUpOwo+ICAgCWRybV9tbV9yZW1vdmVfbm9kZSgmdmdw
dS0+Z20uaGlnaF9nbV9ub2RlKTsKPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1
Y3RfbXV0ZXgpOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAg
IH0KPiAgIAo+ICAgLyoqCj4gQEAgLTEyNywxMSArMTI3LDExIEBAIHZvaWQgaW50ZWxfdmdwdV93
cml0ZV9mZW5jZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwKPiAgIAkJdTMyIGZlbmNlLCB1NjQg
dmFsdWUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2d2dCAqZ3Z0ID0gdmdwdS0+Z3Z0Owo+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZ3Z0LT5kZXZfcHJpdjsKPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3Z0LT5pOTE1Owo+ICAgCXN0cnVjdCBkcm1f
aTkxNV9mZW5jZV9yZWcgKnJlZzsKPiAgIAlpOTE1X3JlZ190IGZlbmNlX3JlZ19sbywgZmVuY2Vf
cmVnX2hpOwo+ICAgCj4gLQlhc3NlcnRfcnBtX3dha2Vsb2NrX2hlbGQoZGV2X3ByaXYpOwo+ICsJ
YXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKGk5MTUpOwo+ICAgCj4gICAJaWYgKFdBUk5fT04oZmVu
Y2UgPj0gdmdwdV9mZW5jZV9zeih2Z3B1KSkpCj4gICAJCXJldHVybjsKPiBAQCAtMTYyLDQxICsx
NjIsNDEgQEAgc3RhdGljIHZvaWQgX2NsZWFyX3ZncHVfZmVuY2Uoc3RydWN0IGludGVsX3ZncHUg
KnZncHUpCj4gICBzdGF0aWMgdm9pZCBmcmVlX3ZncHVfZmVuY2Uoc3RydWN0IGludGVsX3ZncHUg
KnZncHUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2d2dCAqZ3Z0ID0gdmdwdS0+Z3Z0Owo+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZ3Z0LT5kZXZfcHJpdjsKPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3Z0LT5pOTE1Owo+ICAgCXN0cnVjdCBkcm1f
aTkxNV9mZW5jZV9yZWcgKnJlZzsKPiAgIAl1MzIgaTsKPiAgIAo+ICAgCWlmIChXQVJOX09OKCF2
Z3B1X2ZlbmNlX3N6KHZncHUpKSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQlpbnRlbF9ydW50aW1l
X3BtX2dldChkZXZfcHJpdik7Cj4gKwlpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKPiAgIAo+
IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJbXV0ZXhfbG9j
aygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAJX2NsZWFyX3ZncHVfZmVuY2UodmdwdSk7
Cj4gICAJZm9yIChpID0gMDsgaSA8IHZncHVfZmVuY2Vfc3oodmdwdSk7IGkrKykgewo+ICAgCQly
ZWcgPSB2Z3B1LT5mZW5jZS5yZWdzW2ldOwo+ICAgCQlpOTE1X3VucmVzZXJ2ZV9mZW5jZShyZWcp
Owo+ICAgCQl2Z3B1LT5mZW5jZS5yZWdzW2ldID0gTlVMTDsKPiAgIAl9Cj4gLQltdXRleF91bmxv
Y2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAKPiAtCWludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tl
ZChkZXZfcHJpdik7Cj4gKwlpbnRlbF9ydW50aW1lX3BtX3B1dF91bmNoZWNrZWQoaTkxNSk7Cj4g
ICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQgYWxsb2NfdmdwdV9mZW5jZShzdHJ1Y3QgaW50ZWxfdmdw
dSAqdmdwdSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQgPSB2Z3B1LT5ndnQ7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndnQtPmRldl9wcml2Owo+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndnQtPmk5MTU7Cj4gICAJc3RydWN0IGRy
bV9pOTE1X2ZlbmNlX3JlZyAqcmVnOwo+ICAgCWludCBpOwo+ICAgCj4gLQlpbnRlbF9ydW50aW1l
X3BtX2dldChkZXZfcHJpdik7Cj4gKwlpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKPiAgIAo+
ICAgCS8qIFJlcXVlc3QgZmVuY2VzIGZyb20gaG9zdCAqLwo+IC0JbXV0ZXhfbG9jaygmZGV2X3By
aXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9t
dXRleCk7Cj4gICAKPiAgIAlmb3IgKGkgPSAwOyBpIDwgdmdwdV9mZW5jZV9zeih2Z3B1KTsgaSsr
KSB7Cj4gLQkJcmVnID0gaTkxNV9yZXNlcnZlX2ZlbmNlKGRldl9wcml2KTsKPiArCQlyZWcgPSBp
OTE1X3Jlc2VydmVfZmVuY2UoaTkxNSk7Cj4gICAJCWlmIChJU19FUlIocmVnKSkKPiAgIAkJCWdv
dG8gb3V0X2ZyZWVfZmVuY2U7Cj4gICAKPiBAQCAtMjA1LDggKzIwNSw4IEBAIHN0YXRpYyBpbnQg
YWxsb2NfdmdwdV9mZW5jZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKPiAgIAo+ICAgCV9jbGVh
cl92Z3B1X2ZlbmNlKHZncHUpOwo+ICAgCj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5kcm0u
c3RydWN0X211dGV4KTsKPiAtCWludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tlZChkZXZfcHJp
dik7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJaW50ZWxf
cnVudGltZV9wbV9wdXRfdW5jaGVja2VkKGk5MTUpOwo+ICAgCXJldHVybiAwOwo+ICAgb3V0X2Zy
ZWVfZmVuY2U6Cj4gICAJZ3Z0X3ZncHVfZXJyKCJGYWlsZWQgdG8gYWxsb2MgZmVuY2VzXG4iKTsK
PiBAQCAtMjE4LDggKzIxOCw4IEBAIHN0YXRpYyBpbnQgYWxsb2NfdmdwdV9mZW5jZShzdHJ1Y3Qg
aW50ZWxfdmdwdSAqdmdwdSkKPiAgIAkJaTkxNV91bnJlc2VydmVfZmVuY2UocmVnKTsKPiAgIAkJ
dmdwdS0+ZmVuY2UucmVnc1tpXSA9IE5VTEw7Cj4gICAJfQo+IC0JbXV0ZXhfdW5sb2NrKCZkZXZf
cHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gLQlpbnRlbF9ydW50aW1lX3BtX3B1dF91bmNoZWNr
ZWQoZGV2X3ByaXYpOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsK
PiArCWludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tlZChpOTE1KTsKPiAgIAlyZXR1cm4gLUVO
T1NQQzsKPiAgIH0KPiAgIAo+IEBAIC0zMTMsMTEgKzMxMywxMSBAQCB2b2lkIGludGVsX3ZncHVf
ZnJlZV9yZXNvdXJjZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKPiAgICAqLwo+ICAgdm9pZCBp
bnRlbF92Z3B1X3Jlc2V0X3Jlc291cmNlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQo+ICAgewo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJp
djsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdmdwdS0+Z3Z0LT5pOTE1Owo+
ICAgCj4gLQlpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7Cj4gKwlpbnRlbF9ydW50aW1l
X3BtX2dldChpOTE1KTsKPiAgIAlfY2xlYXJfdmdwdV9mZW5jZSh2Z3B1KTsKPiAtCWludGVsX3J1
bnRpbWVfcG1fcHV0X3VuY2hlY2tlZChkZXZfcHJpdik7Cj4gKwlpbnRlbF9ydW50aW1lX3BtX3B1
dF91bmNoZWNrZWQoaTkxNSk7Cj4gICB9Cj4gICAKPiAgIC8qKgo+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndnQvY2ZnX3NwYWNlLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dnQvY2ZnX3NwYWNlLmMKPiBpbmRleCAxOWNmMWJiZTA1OWQuLmQzYTc0NGU3Yzk1OSAxMDA2NDQK
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvY2ZnX3NwYWNlLmMKPiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndnQvY2ZnX3NwYWNlLmMKPiBAQCAtMzkxLDkgKzM5MSw5IEBAIHZv
aWQgaW50ZWxfdmdwdV9pbml0X2NmZ19zcGFjZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwKPiAg
IAltZW1zZXQodmdwdV9jZmdfc3BhY2UodmdwdSkgKyBJTlRFTF9HVlRfUENJX09QUkVHSU9OLCAw
LCA0KTsKPiAgIAo+ICAgCXZncHUtPmNmZ19zcGFjZS5iYXJbSU5URUxfR1ZUX1BDSV9CQVJfR1RU
TU1JT10uc2l6ZSA9Cj4gLQkJCQlwY2lfcmVzb3VyY2VfbGVuKGd2dC0+ZGV2X3ByaXYtPmRybS5w
ZGV2LCAwKTsKPiArCQkJCXBjaV9yZXNvdXJjZV9sZW4oZ3Z0LT5pOTE1LT5kcm0ucGRldiwgMCk7
Cj4gICAJdmdwdS0+Y2ZnX3NwYWNlLmJhcltJTlRFTF9HVlRfUENJX0JBUl9BUEVSVFVSRV0uc2l6
ZSA9Cj4gLQkJCQlwY2lfcmVzb3VyY2VfbGVuKGd2dC0+ZGV2X3ByaXYtPmRybS5wZGV2LCAyKTsK
PiArCQkJCXBjaV9yZXNvdXJjZV9sZW4oZ3Z0LT5pOTE1LT5kcm0ucGRldiwgMik7Cj4gICAKPiAg
IAltZW1zZXQodmdwdV9jZmdfc3BhY2UodmdwdSkgKyBQQ0lfUk9NX0FERFJFU1MsIDAsIDQpOwo+
ICAgfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvY21kX3BhcnNlci5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2NtZF9wYXJzZXIuYwo+IGluZGV4IDZlYTg4Mjcw
YzgxOC4uMmIwOWFjYzA1MDJmIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2
dC9jbWRfcGFyc2VyLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvY21kX3BhcnNl
ci5jCj4gQEAgLTgxOSw3ICs4MTksNyBAQCBzdGF0aWMgaW50IGZvcmNlX25vbnByaXZfcmVnX2hh
bmRsZXIoc3RydWN0IHBhcnNlcl9leGVjX3N0YXRlICpzLAo+ICAgCXVuc2lnbmVkIGludCBkYXRh
Owo+ICAgCXUzMiByaW5nX2Jhc2U7Cj4gICAJdTMyIG5vcGlkOwo+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gcy0+dmdwdS0+Z3Z0LT5kZXZfcHJpdjsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gcy0+dmdwdS0+Z3Z0LT5pOTE1Owo+ICAgCj4gICAJaWYg
KCFzdHJjbXAoY21kLCAibHJpIikpCj4gICAJCWRhdGEgPSBjbWRfdmFsKHMsIGluZGV4ICsgMSk7
Cj4gQEAgLTgyOSw3ICs4MjksNyBAQCBzdGF0aWMgaW50IGZvcmNlX25vbnByaXZfcmVnX2hhbmRs
ZXIoc3RydWN0IHBhcnNlcl9leGVjX3N0YXRlICpzLAo+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiAg
IAl9Cj4gICAKPiAtCXJpbmdfYmFzZSA9IGRldl9wcml2LT5lbmdpbmVbcy0+cmluZ19pZF0tPm1t
aW9fYmFzZTsKPiArCXJpbmdfYmFzZSA9IGk5MTUtPmVuZ2luZVtzLT5yaW5nX2lkXS0+bW1pb19i
YXNlOwo+ICAgCW5vcGlkID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19OT1BJRChyaW5nX2Jh
c2UpKTsKPiAgIAo+ICAgCWlmICghaW50ZWxfZ3Z0X2luX2ZvcmNlX25vbnByaXZfd2hpdGVsaXN0
KGd2dCwgZGF0YSkgJiYKPiBAQCAtOTA1LDcgKzkwNSw3IEBAIHN0YXRpYyBpbnQgY21kX3JlZ19o
YW5kbGVyKHN0cnVjdCBwYXJzZXJfZXhlY19zdGF0ZSAqcywKPiAgIAkgKiB1cGRhdGUgcmVnIHZh
bHVlcyBpbiBpdCBpbnRvIHZyZWdzLCBzbyBMUklzIGluIHdvcmtsb2FkIHdpdGgKPiAgIAkgKiBp
bmhpYml0IGNvbnRleHQgd2lsbCByZXN0b3JlIHdpdGggY29ycmVjdCB2YWx1ZXMKPiAgIAkgKi8K
PiAtCWlmIChJU19HRU4oZ3Z0LT5kZXZfcHJpdiwgOSkgJiYKPiArCWlmIChJU19HRU4oZ3Z0LT5p
OTE1LCA5KSAmJgo+ICAgCQkJaW50ZWxfZ3Z0X21taW9faXNfaW5fY3R4KGd2dCwgb2Zmc2V0KSAm
Jgo+ICAgCQkJIXN0cm5jbXAoY21kLCAibHJpIiwgMykpIHsKPiAgIAkJaW50ZWxfZ3Z0X2h5cGVy
dmlzb3JfcmVhZF9ncGEocy0+dmdwdSwKPiBAQCAtOTQ2LDcgKzk0Niw3IEBAIHN0YXRpYyBpbnQg
Y21kX2hhbmRsZXJfbHJpKHN0cnVjdCBwYXJzZXJfZXhlY19zdGF0ZSAqcykKPiAgIAlzdHJ1Y3Qg
aW50ZWxfZ3Z0ICpndnQgPSBzLT52Z3B1LT5ndnQ7Cj4gICAKPiAgIAlmb3IgKGkgPSAxOyBpIDwg
Y21kX2xlbjsgaSArPSAyKSB7Cj4gLQkJaWYgKElTX0JST0FEV0VMTChndnQtPmRldl9wcml2KSAm
JiBzLT5yaW5nX2lkICE9IFJDUzApIHsKPiArCQlpZiAoSVNfQlJPQURXRUxMKGd2dC0+aTkxNSkg
JiYgcy0+cmluZ19pZCAhPSBSQ1MwKSB7Cj4gICAJCQlpZiAocy0+cmluZ19pZCA9PSBCQ1MwICYm
Cj4gICAJCQkgICAgY21kX3JlZyhzLCBpKSA9PSBpOTE1X21taW9fcmVnX29mZnNldChERVJSTVIp
KQo+ICAgCQkJCXJldCB8PSAwOwo+IEBAIC05NjgsNyArOTY4LDcgQEAgc3RhdGljIGludCBjbWRf
aGFuZGxlcl9scnIoc3RydWN0IHBhcnNlcl9leGVjX3N0YXRlICpzKQo+ICAgCWludCBjbWRfbGVu
ID0gY21kX2xlbmd0aChzKTsKPiAgIAo+ICAgCWZvciAoaSA9IDE7IGkgPCBjbWRfbGVuOyBpICs9
IDIpIHsKPiAtCQlpZiAoSVNfQlJPQURXRUxMKHMtPnZncHUtPmd2dC0+ZGV2X3ByaXYpKQo+ICsJ
CWlmIChJU19CUk9BRFdFTEwocy0+dmdwdS0+Z3Z0LT5pOTE1KSkKPiAgIAkJCXJldCB8PSAoKGNt
ZF9yZWdfaW5oaWJpdChzLCBpKSB8fAo+ICAgCQkJCQkoY21kX3JlZ19pbmhpYml0KHMsIGkgKyAx
KSkpKSA/Cj4gICAJCQkJLUVCQURSUUMgOiAwOwo+IEBAIC05OTYsNyArOTk2LDcgQEAgc3RhdGlj
IGludCBjbWRfaGFuZGxlcl9scm0oc3RydWN0IHBhcnNlcl9leGVjX3N0YXRlICpzKQo+ICAgCWlu
dCBjbWRfbGVuID0gY21kX2xlbmd0aChzKTsKPiAgIAo+ICAgCWZvciAoaSA9IDE7IGkgPCBjbWRf
bGVuOykgewo+IC0JCWlmIChJU19CUk9BRFdFTEwoZ3Z0LT5kZXZfcHJpdikpCj4gKwkJaWYgKElT
X0JST0FEV0VMTChndnQtPmk5MTUpKQo+ICAgCQkJcmV0IHw9IChjbWRfcmVnX2luaGliaXQocywg
aSkpID8gLUVCQURSUUMgOiAwOwo+ICAgCQlpZiAocmV0KQo+ICAgCQkJYnJlYWs7Cj4gQEAgLTEx
ODAsNyArMTE4MCw3IEBAIHN0cnVjdCBwbGFuZV9jb2RlX21hcHBpbmcgewo+ICAgc3RhdGljIGlu
dCBnZW44X2RlY29kZV9taV9kaXNwbGF5X2ZsaXAoc3RydWN0IHBhcnNlcl9leGVjX3N0YXRlICpz
LAo+ICAgCQlzdHJ1Y3QgbWlfZGlzcGxheV9mbGlwX2NvbW1hbmRfaW5mbyAqaW5mbykKPiAgIHsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHMtPnZncHUtPmd2dC0+ZGV2
X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHMtPnZncHUtPmd2dC0+
aTkxNTsKPiAgIAlzdHJ1Y3QgcGxhbmVfY29kZV9tYXBwaW5nIGdlbjhfcGxhbmVfY29kZVtdID0g
ewo+ICAgCQlbMF0gPSB7UElQRV9BLCBQTEFORV9BLCBQUklNQVJZX0FfRkxJUF9ET05FfSwKPiAg
IAkJWzFdID0ge1BJUEVfQiwgUExBTkVfQSwgUFJJTUFSWV9CX0ZMSVBfRE9ORX0sCj4gQEAgLTEy
MjYsNyArMTIyNiw3IEBAIHN0YXRpYyBpbnQgZ2VuOF9kZWNvZGVfbWlfZGlzcGxheV9mbGlwKHN0
cnVjdCBwYXJzZXJfZXhlY19zdGF0ZSAqcywKPiAgIHN0YXRpYyBpbnQgc2tsX2RlY29kZV9taV9k
aXNwbGF5X2ZsaXAoc3RydWN0IHBhcnNlcl9leGVjX3N0YXRlICpzLAo+ICAgCQlzdHJ1Y3QgbWlf
ZGlzcGxheV9mbGlwX2NvbW1hbmRfaW5mbyAqaW5mbykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHMtPnZncHUtPmd2dC0+ZGV2X3ByaXY7Cj4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHMtPnZncHUtPmd2dC0+aTkxNTsKPiAgIAlzdHJ1Y3Qg
aW50ZWxfdmdwdSAqdmdwdSA9IHMtPnZncHU7Cj4gICAJdTMyIGR3b3JkMCA9IGNtZF92YWwocywg
MCk7Cj4gICAJdTMyIGR3b3JkMSA9IGNtZF92YWwocywgMSk7Cj4gQEAgLTEyODUsMTMgKzEyODUs
MTMgQEAgc3RhdGljIGludCBza2xfZGVjb2RlX21pX2Rpc3BsYXlfZmxpcChzdHJ1Y3QgcGFyc2Vy
X2V4ZWNfc3RhdGUgKnMsCj4gICBzdGF0aWMgaW50IGdlbjhfY2hlY2tfbWlfZGlzcGxheV9mbGlw
KHN0cnVjdCBwYXJzZXJfZXhlY19zdGF0ZSAqcywKPiAgIAkJc3RydWN0IG1pX2Rpc3BsYXlfZmxp
cF9jb21tYW5kX2luZm8gKmluZm8pCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBzLT52Z3B1LT5ndnQtPmRldl9wcml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSBzLT52Z3B1LT5ndnQtPmk5MTU7Cj4gICAJdTMyIHN0cmlkZSwgdGlsZTsK
PiAgIAo+ICAgCWlmICghaW5mby0+YXN5bmNfZmxpcCkKPiAgIAkJcmV0dXJuIDA7Cj4gICAKPiAt
CWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkg
Pj0gOSkgewo+ICAgCQlzdHJpZGUgPSB2Z3B1X3ZyZWdfdChzLT52Z3B1LCBpbmZvLT5zdHJpZGVf
cmVnKSAmIEdFTk1BU0soOSwgMCk7Cj4gICAJCXRpbGUgPSAodmdwdV92cmVnX3Qocy0+dmdwdSwg
aW5mby0+Y3RybF9yZWcpICYKPiAgIAkJCQlHRU5NQVNLKDEyLCAxMCkpID4+IDEwOwo+IEBAIC0x
MzE0LDEyICsxMzE0LDEyIEBAIHN0YXRpYyBpbnQgZ2VuOF91cGRhdGVfcGxhbmVfbW1pb19mcm9t
X21pX2Rpc3BsYXlfZmxpcCgKPiAgIAkJc3RydWN0IHBhcnNlcl9leGVjX3N0YXRlICpzLAo+ICAg
CQlzdHJ1Y3QgbWlfZGlzcGxheV9mbGlwX2NvbW1hbmRfaW5mbyAqaW5mbykKPiAgIHsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHMtPnZncHUtPmd2dC0+ZGV2X3ByaXY7
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHMtPnZncHUtPmd2dC0+aTkxNTsK
PiAgIAlzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSA9IHMtPnZncHU7Cj4gICAKPiAgIAlzZXRfbWFz
a19iaXRzKCZ2Z3B1X3ZyZWdfdCh2Z3B1LCBpbmZvLT5zdXJmX3JlZyksIEdFTk1BU0soMzEsIDEy
KSwKPiAgIAkJICAgICAgaW5mby0+c3VyZl92YWwgPDwgMTIpOwo+IC0JaWYgKElOVEVMX0dFTihk
ZXZfcHJpdikgPj0gOSkgewo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KSB7Cj4gICAJCXNl
dF9tYXNrX2JpdHMoJnZncHVfdnJlZ190KHZncHUsIGluZm8tPnN0cmlkZV9yZWcpLCBHRU5NQVNL
KDksIDApLAo+ICAgCQkJICAgICAgaW5mby0+c3RyaWRlX3ZhbCk7Cj4gICAJCXNldF9tYXNrX2Jp
dHMoJnZncHVfdnJlZ190KHZncHUsIGluZm8tPmN0cmxfcmVnKSwgR0VOTUFTSygxMiwgMTApLAo+
IEBAIC0xMzQ1LDExICsxMzQ1LDExIEBAIHN0YXRpYyBpbnQgZ2VuOF91cGRhdGVfcGxhbmVfbW1p
b19mcm9tX21pX2Rpc3BsYXlfZmxpcCgKPiAgIHN0YXRpYyBpbnQgZGVjb2RlX21pX2Rpc3BsYXlf
ZmxpcChzdHJ1Y3QgcGFyc2VyX2V4ZWNfc3RhdGUgKnMsCj4gICAJCXN0cnVjdCBtaV9kaXNwbGF5
X2ZsaXBfY29tbWFuZF9pbmZvICppbmZvKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gcy0+dmdwdS0+Z3Z0LT5kZXZfcHJpdjsKPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gcy0+dmdwdS0+Z3Z0LT5pOTE1Owo+ICAgCj4gLQlpZiAoSVNfQlJP
QURXRUxMKGRldl9wcml2KSkKPiArCWlmIChJU19CUk9BRFdFTEwoaTkxNSkpCj4gICAJCXJldHVy
biBnZW44X2RlY29kZV9taV9kaXNwbGF5X2ZsaXAocywgaW5mbyk7Cj4gLQlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSA5KQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ICAgCQlyZXR1
cm4gc2tsX2RlY29kZV9taV9kaXNwbGF5X2ZsaXAocywgaW5mbyk7Cj4gICAKPiAgIAlyZXR1cm4g
LUVOT0RFVjsKPiBAQCAtMTc1Niw3ICsxNzU2LDcgQEAgc3RhdGljIGludCBwZXJmb3JtX2JiX3No
YWRvdyhzdHJ1Y3QgcGFyc2VyX2V4ZWNfc3RhdGUgKnMpCj4gICAJaWYgKGJiLT5wcGd0dCkKPiAg
IAkJc3RhcnRfb2Zmc2V0ID0gZ21hICYgfkk5MTVfR1RUX1BBR0VfTUFTSzsKPiAgIAo+IC0JYmIt
Pm9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfc2htZW0ocy0+dmdwdS0+Z3Z0LT5kZXZfcHJp
diwKPiArCWJiLT5vYmogPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3NobWVtKHMtPnZncHUtPmd2
dC0+aTkxNSwKPiAgIAkJCQkJICAgICAgIHJvdW5kX3VwKGJiX3NpemUgKyBzdGFydF9vZmZzZXQs
Cj4gICAJCQkJCQkJUEFHRV9TSVpFKSk7Cj4gICAJaWYgKElTX0VSUihiYi0+b2JqKSkgewo+IEBA
IC0yODMwLDcgKzI4MzAsNyBAQCBzdGF0aWMgaW50IHNoYWRvd19pbmRpcmVjdF9jdHgoc3RydWN0
IGludGVsX3NoYWRvd193YV9jdHggKndhX2N0eCkKPiAgIAlpbnQgcmV0ID0gMDsKPiAgIAl2b2lk
ICptYXA7Cj4gICAKPiAtCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfc2htZW0od29ya2xv
YWQtPnZncHUtPmd2dC0+ZGV2X3ByaXYsCj4gKwlvYmogPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRl
X3NobWVtKHdvcmtsb2FkLT52Z3B1LT5ndnQtPmk5MTUsCj4gICAJCQkJCSAgIHJvdW5kdXAoY3R4
X3NpemUgKyBDQUNIRUxJTkVfQllURVMsCj4gICAJCQkJCQkgICBQQUdFX1NJWkUpKTsKPiAgIAlp
ZiAoSVNfRVJSKG9iaikpCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9k
ZWJ1Z2ZzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZGVidWdmcy5jCj4gaW5kZXggMmZi
N2I3M2IyNjBkLi4xZmY3ZjExYzg5YTIgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Z0L2RlYnVnZnMuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9kZWJ1Z2Zz
LmMKPiBAQCAtNTgsNyArNTgsNyBAQCBzdGF0aWMgaW50IG1taW9fb2Zmc2V0X2NvbXBhcmUodm9p
ZCAqcHJpdiwKPiAgIHN0YXRpYyBpbmxpbmUgaW50IG1taW9fZGlmZl9oYW5kbGVyKHN0cnVjdCBp
bnRlbF9ndnQgKmd2dCwKPiAgIAkJCQkgICAgdTMyIG9mZnNldCwgdm9pZCAqZGF0YSkKPiAgIHsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3Z0LT5kZXZfcHJpdjsKPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3Z0LT5pOTE1Owo+ICAgCXN0cnVjdCBtbWlv
X2RpZmZfcGFyYW0gKnBhcmFtID0gZGF0YTsKPiAgIAlzdHJ1Y3QgZGlmZl9tbWlvICpub2RlOwo+
ICAgCXUzMiBwcmVnLCB2cmVnOwo+IEBAIC05OCwxMCArOTgsMTAgQEAgc3RhdGljIGludCB2Z3B1
X21taW9fZGlmZl9zaG93KHN0cnVjdCBzZXFfZmlsZSAqcywgdm9pZCAqdW51c2VkKQo+ICAgCW11
dGV4X2xvY2soJmd2dC0+bG9jayk7Cj4gICAJc3Bpbl9sb2NrX2JoKCZndnQtPnNjaGVkdWxlci5t
bWlvX2NvbnRleHRfbG9jayk7Cj4gICAKPiAtCW1taW9faHdfYWNjZXNzX3ByZShndnQtPmRldl9w
cml2KTsKPiArCW1taW9faHdfYWNjZXNzX3ByZShndnQtPmk5MTUpOwo+ICAgCS8qIFJlY29nbml6
ZSBhbGwgdGhlIGRpZmYgbW1pb3MgdG8gbGlzdC4gKi8KPiAgIAlpbnRlbF9ndnRfZm9yX2VhY2hf
dHJhY2tlZF9tbWlvKGd2dCwgbW1pb19kaWZmX2hhbmRsZXIsICZwYXJhbSk7Cj4gLQltbWlvX2h3
X2FjY2Vzc19wb3N0KGd2dC0+ZGV2X3ByaXYpOwo+ICsJbW1pb19od19hY2Nlc3NfcG9zdChndnQt
Pmk5MTUpOwo+ICAgCj4gICAJc3Bpbl91bmxvY2tfYmgoJmd2dC0+c2NoZWR1bGVyLm1taW9fY29u
dGV4dF9sb2NrKTsKPiAgIAltdXRleF91bmxvY2soJmd2dC0+bG9jayk7Cj4gQEAgLTE0Miw3ICsx
NDIsNyBAQCBzdGF0aWMgaW50Cj4gICB2Z3B1X3NjYW5fbm9ucHJpdmJiX3NldCh2b2lkICpkYXRh
LCB1NjQgdmFsKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1ID0gKHN0cnVjdCBp
bnRlbF92Z3B1ICopZGF0YTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHZncHUtPmd2dC0+ZGV2X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHZncHUtPmd2dC0+aTkxNTsKPiAgIAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKPiAgIAljaGFy
IGJ1ZlsxMjhdLCAqczsKPiAgIAlpbnQgbGVuOwo+IEBAIC0xNjQsNyArMTY0LDcgQEAgdmdwdV9z
Y2FuX25vbnByaXZiYl9zZXQodm9pZCAqZGF0YSwgdTY0IHZhbCkKPiAgIAlmb3IgKGlkID0gMDsg
aWQgPCBJOTE1X05VTV9FTkdJTkVTOyBpZCsrKSB7Cj4gICAJCXN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZTsKPiAgIAo+IC0JCWVuZ2luZSA9IGRldl9wcml2LT5lbmdpbmVbaWRdOwo+ICsJ
CWVuZ2luZSA9IGk5MTUtPmVuZ2luZVtpZF07Cj4gICAJCWlmIChlbmdpbmUgJiYgKHZhbCAmICgx
IDw8IGlkKSkpIHsKPiAgIAkJCWxlbiA9IHNucHJpbnRmKHMsIDQsICIlZCwgIiwgZW5naW5lLT5p
ZCk7Cj4gICAJCQlzICs9IGxlbjsKPiBAQCAtMjQwLDcgKzI0MCw3IEBAIHZvaWQgaW50ZWxfZ3Z0
X2RlYnVnZnNfcmVtb3ZlX3ZncHUoc3RydWN0IGludGVsX3ZncHUgKnZncHUpCj4gICAgKi8KPiAg
IGludCBpbnRlbF9ndnRfZGVidWdmc19pbml0KHN0cnVjdCBpbnRlbF9ndnQgKmd2dCkKPiAgIHsK
PiAtCXN0cnVjdCBkcm1fbWlub3IgKm1pbm9yID0gZ3Z0LT5kZXZfcHJpdi0+ZHJtLnByaW1hcnk7
Cj4gKwlzdHJ1Y3QgZHJtX21pbm9yICptaW5vciA9IGd2dC0+aTkxNS0+ZHJtLnByaW1hcnk7Cj4g
ICAJc3RydWN0IGRlbnRyeSAqZW50Owo+ICAgCj4gICAJZ3Z0LT5kZWJ1Z2ZzX3Jvb3QgPSBkZWJ1
Z2ZzX2NyZWF0ZV9kaXIoImd2dCIsIG1pbm9yLT5kZWJ1Z2ZzX3Jvb3QpOwo+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZGlzcGxheS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Z0L2Rpc3BsYXkuYwo+IGluZGV4IGUxYzMxM2RhNmMwMC4uYjAzN2FlZWQyZjQwIDEwMDY0
NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9kaXNwbGF5LmMKPiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZGlzcGxheS5jCj4gQEAgLTU3LDcgKzU3LDcgQEAgc3RhdGlj
IGludCBnZXRfZWRwX3BpcGUoc3RydWN0IGludGVsX3ZncHUgKnZncHUpCj4gICAKPiAgIHN0YXRp
YyBpbnQgZWRwX3BpcGVfaXNfZW5hYmxlZChzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKPiAgIHsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHZncHUtPmd2dC0+ZGV2X3By
aXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHZncHUtPmd2dC0+aTkxNTsK
PiAgIAo+ICAgCWlmICghKHZncHVfdnJlZ190KHZncHUsIFBJUEVDT05GKF9QSVBFX0VEUCkpICYg
UElQRUNPTkZfRU5BQkxFKSkKPiAgIAkJcmV0dXJuIDA7Cj4gQEAgLTY5LDcgKzY5LDcgQEAgc3Rh
dGljIGludCBlZHBfcGlwZV9pc19lbmFibGVkKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQo+ICAg
Cj4gICBpbnQgcGlwZV9pc19lbmFibGVkKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCBpbnQgcGlw
ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHZncHUtPmd2
dC0+ZGV2X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHZncHUtPmd2
dC0+aTkxNTsKPiAgIAo+ICAgCWlmIChXQVJOX09OKHBpcGUgPCBQSVBFX0EgfHwgcGlwZSA+PSBJ
OTE1X01BWF9QSVBFUykpCj4gICAJCXJldHVybiAtRUlOVkFMOwo+IEBAIC0xNjgsMTAgKzE2OCwx
MCBAQCBzdGF0aWMgdTggZHBjZF9maXhfZGF0YVtEUENEX0hFQURFUl9TSVpFXSA9IHsKPiAgIAo+
ICAgc3RhdGljIHZvaWQgZW11bGF0ZV9tb25pdG9yX3N0YXR1c19jaGFuZ2Uoc3RydWN0IGludGVs
X3ZncHUgKnZncHUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB2Z3B1LT5ndnQtPmRldl9wcml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB2Z3B1LT5ndnQtPmk5MTU7Cj4gICAJaW50IHBpcGU7Cj4gICAKPiAtCWlmIChJU19CUk9YVE9O
KGRldl9wcml2KSkgewo+ICsJaWYgKElTX0JST1hUT04oaTkxNSkpIHsKPiAgIAkJdmdwdV92cmVn
X3QodmdwdSwgR0VOOF9ERV9QT1JUX0lTUikgJj0gfihCWFRfREVfUE9SVF9IUF9ERElBIHwKPiAg
IAkJCUJYVF9ERV9QT1JUX0hQX0RESUIgfAo+ICAgCQkJQlhUX0RFX1BPUlRfSFBfRERJQyk7Cj4g
QEAgLTE5OCw4ICsxOTgsOCBAQCBzdGF0aWMgdm9pZCBlbXVsYXRlX21vbml0b3Jfc3RhdHVzX2No
YW5nZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKPiAgIAkJCVNERV9QT1JUQ19IT1RQTFVHX0NQ
VCB8Cj4gICAJCQlTREVfUE9SVERfSE9UUExVR19DUFQpOwo+ICAgCj4gLQlpZiAoSVNfU0tZTEFL
RShkZXZfcHJpdikgfHwgSVNfS0FCWUxBS0UoZGV2X3ByaXYpIHx8Cj4gLQkgICAgSVNfQ09GRkVF
TEFLRShkZXZfcHJpdikpIHsKPiArCWlmIChJU19TS1lMQUtFKGk5MTUpIHx8IElTX0tBQllMQUtF
KGk5MTUpIHx8Cj4gKwkgICAgSVNfQ09GRkVFTEFLRShpOTE1KSkgewo+ICAgCQl2Z3B1X3ZyZWdf
dCh2Z3B1LCBTREVJU1IpICY9IH4oU0RFX1BPUlRBX0hPVFBMVUdfU1BUIHwKPiAgIAkJCQlTREVf
UE9SVEVfSE9UUExVR19TUFQpOwo+ICAgCQl2Z3B1X3ZyZWdfdCh2Z3B1LCBTS0xfRlVTRV9TVEFU
VVMpIHw9Cj4gQEAgLTIyMyw3ICsyMjMsNyBAQCBzdGF0aWMgdm9pZCBlbXVsYXRlX21vbml0b3Jf
c3RhdHVzX2NoYW5nZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKPiAgIAkJCShUUkFOU19ERElf
QlBDXzggfCBUUkFOU19ERElfTU9ERV9TRUxFQ1RfRFZJIHwKPiAgIAkJCShQT1JUX0IgPDwgVFJB
TlNfRERJX1BPUlRfU0hJRlQpIHwKPiAgIAkJCVRSQU5TX0RESV9GVU5DX0VOQUJMRSk7Cj4gLQkJ
aWYgKElTX0JST0FEV0VMTChkZXZfcHJpdikpIHsKPiArCQlpZiAoSVNfQlJPQURXRUxMKGk5MTUp
KSB7Cj4gICAJCQl2Z3B1X3ZyZWdfdCh2Z3B1LCBQT1JUX0NMS19TRUwoUE9SVF9CKSkgJj0KPiAg
IAkJCQl+UE9SVF9DTEtfU0VMX01BU0s7Cj4gICAJCQl2Z3B1X3ZyZWdfdCh2Z3B1LCBQT1JUX0NM
S19TRUwoUE9SVF9CKSkgfD0KPiBAQCAtMjQzLDcgKzI0Myw3IEBAIHN0YXRpYyB2b2lkIGVtdWxh
dGVfbW9uaXRvcl9zdGF0dXNfY2hhbmdlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQo+ICAgCQkJ
KFRSQU5TX0RESV9CUENfOCB8IFRSQU5TX0RESV9NT0RFX1NFTEVDVF9EVkkgfAo+ICAgCQkJKFBP
UlRfQyA8PCBUUkFOU19ERElfUE9SVF9TSElGVCkgfAo+ICAgCQkJVFJBTlNfRERJX0ZVTkNfRU5B
QkxFKTsKPiAtCQlpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSkgewo+ICsJCWlmIChJU19CUk9B
RFdFTEwoaTkxNSkpIHsKPiAgIAkJCXZncHVfdnJlZ190KHZncHUsIFBPUlRfQ0xLX1NFTChQT1JU
X0MpKSAmPQo+ICAgCQkJCX5QT1JUX0NMS19TRUxfTUFTSzsKPiAgIAkJCXZncHVfdnJlZ190KHZn
cHUsIFBPUlRfQ0xLX1NFTChQT1JUX0MpKSB8PQo+IEBAIC0yNjMsNyArMjYzLDcgQEAgc3RhdGlj
IHZvaWQgZW11bGF0ZV9tb25pdG9yX3N0YXR1c19jaGFuZ2Uoc3RydWN0IGludGVsX3ZncHUgKnZn
cHUpCj4gICAJCQkoVFJBTlNfRERJX0JQQ184IHwgVFJBTlNfRERJX01PREVfU0VMRUNUX0RWSSB8
Cj4gICAJCQkoUE9SVF9EIDw8IFRSQU5TX0RESV9QT1JUX1NISUZUKSB8Cj4gICAJCQlUUkFOU19E
RElfRlVOQ19FTkFCTEUpOwo+IC0JCWlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYpKSB7Cj4gKwkJ
aWYgKElTX0JST0FEV0VMTChpOTE1KSkgewo+ICAgCQkJdmdwdV92cmVnX3QodmdwdSwgUE9SVF9D
TEtfU0VMKFBPUlRfRCkpICY9Cj4gICAJCQkJflBPUlRfQ0xLX1NFTF9NQVNLOwo+ICAgCQkJdmdw
dV92cmVnX3QodmdwdSwgUE9SVF9DTEtfU0VMKFBPUlRfRCkpIHw9Cj4gQEAgLTI3NCwxNCArMjc0
LDE0IEBAIHN0YXRpYyB2b2lkIGVtdWxhdGVfbW9uaXRvcl9zdGF0dXNfY2hhbmdlKHN0cnVjdCBp
bnRlbF92Z3B1ICp2Z3B1KQo+ICAgCQl2Z3B1X3ZyZWdfdCh2Z3B1LCBTRlVTRV9TVFJBUCkgfD0g
U0ZVU0VfU1RSQVBfRERJRF9ERVRFQ1RFRDsKPiAgIAl9Cj4gICAKPiAtCWlmICgoSVNfU0tZTEFL
RShkZXZfcHJpdikgfHwgSVNfS0FCWUxBS0UoZGV2X3ByaXYpIHx8Cj4gLQkgICAgIElTX0NPRkZF
RUxBS0UoZGV2X3ByaXYpKSAmJgo+ICsJaWYgKChJU19TS1lMQUtFKGk5MTUpIHx8IElTX0tBQllM
QUtFKGk5MTUpIHx8Cj4gKwkgICAgIElTX0NPRkZFRUxBS0UoaTkxNSkpICYmCj4gICAJCQlpbnRl
bF92Z3B1X2hhc19tb25pdG9yX29uX3BvcnQodmdwdSwgUE9SVF9FKSkgewo+ICAgCQl2Z3B1X3Zy
ZWdfdCh2Z3B1LCBTREVJU1IpIHw9IFNERV9QT1JURV9IT1RQTFVHX1NQVDsKPiAgIAl9Cj4gICAK
PiAgIAlpZiAoaW50ZWxfdmdwdV9oYXNfbW9uaXRvcl9vbl9wb3J0KHZncHUsIFBPUlRfQSkpIHsK
PiAtCQlpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSkKPiArCQlpZiAoSVNfQlJPQURXRUxMKGk5
MTUpKQo+ICAgCQkJdmdwdV92cmVnX3QodmdwdSwgR0VOOF9ERV9QT1JUX0lTUikgfD0KPiAgIAkJ
CQlHRU44X1BPUlRfRFBfQV9IT1RQTFVHOwo+ICAgCQllbHNlCj4gQEAgLTI5MSwxMSArMjkxLDEx
IEBAIHN0YXRpYyB2b2lkIGVtdWxhdGVfbW9uaXRvcl9zdGF0dXNfY2hhbmdlKHN0cnVjdCBpbnRl
bF92Z3B1ICp2Z3B1KQo+ICAgCX0KPiAgIAo+ICAgCS8qIENsZWFyIGhvc3QgQ1JUIHN0YXR1cywg
c28gZ3Vlc3QgY291bGRuJ3QgZGV0ZWN0IHRoaXMgaG9zdCBDUlQuICovCj4gLQlpZiAoSVNfQlJP
QURXRUxMKGRldl9wcml2KSkKPiArCWlmIChJU19CUk9BRFdFTEwoaTkxNSkpCj4gICAJCXZncHVf
dnJlZ190KHZncHUsIFBDSF9BRFBBKSAmPSB+QURQQV9DUlRfSE9UUExVR19NT05JVE9SX01BU0s7
Cj4gICAKPiAgIAkvKiBEaXNhYmxlIFByaW1hcnkvU3ByaXRlL0N1cnNvciBwbGFuZSAqLwo+IC0J
Zm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkgewo+ICsJZm9yX2VhY2hfcGlwZShpOTE1LCBw
aXBlKSB7Cj4gICAJCXZncHVfdnJlZ190KHZncHUsIERTUENOVFIocGlwZSkpICY9IH5ESVNQTEFZ
X1BMQU5FX0VOQUJMRTsKPiAgIAkJdmdwdV92cmVnX3QodmdwdSwgU1BSQ1RMKHBpcGUpKSAmPSB+
U1BSSVRFX0VOQUJMRTsKPiAgIAkJdmdwdV92cmVnX3QodmdwdSwgQ1VSQ05UUihwaXBlKSkgJj0g
fk1DVVJTT1JfTU9ERTsKPiBAQCAtMzg5LDcgKzM4OSw3IEBAIHZvaWQgaW50ZWxfZ3Z0X2NoZWNr
X3ZibGFua19lbXVsYXRpb24oc3RydWN0IGludGVsX2d2dCAqZ3Z0KQo+ICAgCj4gICBzdGF0aWMg
dm9pZCBlbXVsYXRlX3ZibGFua19vbl9waXBlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCBpbnQg
cGlwZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHZncHUt
Pmd2dC0+ZGV2X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHZncHUt
Pmd2dC0+aTkxNTsKPiAgIAlzdHJ1Y3QgaW50ZWxfdmdwdV9pcnEgKmlycSA9ICZ2Z3B1LT5pcnE7
Cj4gICAJaW50IHZibGFua19ldmVudFtdID0gewo+ICAgCQlbUElQRV9BXSA9IFBJUEVfQV9WQkxB
TkssCj4gQEAgLTQyMSw3ICs0MjEsNyBAQCBzdGF0aWMgdm9pZCBlbXVsYXRlX3ZibGFuayhzdHJ1
Y3QgaW50ZWxfdmdwdSAqdmdwdSkKPiAgIAlpbnQgcGlwZTsKPiAgIAo+ICAgCW11dGV4X2xvY2so
JnZncHUtPnZncHVfbG9jayk7Cj4gLQlmb3JfZWFjaF9waXBlKHZncHUtPmd2dC0+ZGV2X3ByaXYs
IHBpcGUpCj4gKwlmb3JfZWFjaF9waXBlKHZncHUtPmd2dC0+aTkxNSwgcGlwZSkKPiAgIAkJZW11
bGF0ZV92Ymxhbmtfb25fcGlwZSh2Z3B1LCBwaXBlKTsKPiAgIAltdXRleF91bmxvY2soJnZncHUt
PnZncHVfbG9jayk7Cj4gICB9Cj4gQEAgLTQ1NCwxMCArNDU0LDEwIEBAIHZvaWQgaW50ZWxfZ3Z0
X2VtdWxhdGVfdmJsYW5rKHN0cnVjdCBpbnRlbF9ndnQgKmd2dCkKPiAgICAqLwo+ICAgdm9pZCBp
bnRlbF92Z3B1X2VtdWxhdGVfaG90cGx1ZyhzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwgYm9vbCBj
b25uZWN0ZWQpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2
Z3B1LT5ndnQtPmRldl9wcml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2
Z3B1LT5ndnQtPmk5MTU7Cj4gICAKPiAgIAkvKiBUT0RPOiBhZGQgbW9yZSBwbGF0Zm9ybXMgc3Vw
cG9ydCAqLwo+IC0JaWYgKElTX1NLWUxBS0UoZGV2X3ByaXYpIHx8IElTX0tBQllMQUtFKGRldl9w
cml2KSkgewo+ICsJaWYgKElTX1NLWUxBS0UoaTkxNSkgfHwgSVNfS0FCWUxBS0UoaTkxNSkpIHsK
PiAgIAkJaWYgKGNvbm5lY3RlZCkgewo+ICAgCQkJdmdwdV92cmVnX3QodmdwdSwgU0ZVU0VfU1RS
QVApIHw9Cj4gICAJCQkJU0ZVU0VfU1RSQVBfRERJRF9ERVRFQ1RFRDsKPiBAQCAtNDgzLDEwICs0
ODMsMTAgQEAgdm9pZCBpbnRlbF92Z3B1X2VtdWxhdGVfaG90cGx1ZyhzdHJ1Y3QgaW50ZWxfdmdw
dSAqdmdwdSwgYm9vbCBjb25uZWN0ZWQpCj4gICAgKi8KPiAgIHZvaWQgaW50ZWxfdmdwdV9jbGVh
bl9kaXNwbGF5KHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQo+ICAgewo+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdmdwdS0+Z3Z0LT5pOTE1Owo+ICAgCj4gLQlpZiAoSVNf
U0tZTEFLRShkZXZfcHJpdikgfHwgSVNfS0FCWUxBS0UoZGV2X3ByaXYpIHx8Cj4gLQkgICAgSVNf
Q09GRkVFTEFLRShkZXZfcHJpdikpCj4gKwlpZiAoSVNfU0tZTEFLRShpOTE1KSB8fCBJU19LQUJZ
TEFLRShpOTE1KSB8fAo+ICsJICAgIElTX0NPRkZFRUxBS0UoaTkxNSkpCj4gICAJCWNsZWFuX3Zp
cnR1YWxfZHBfbW9uaXRvcih2Z3B1LCBQT1JUX0QpOwo+ICAgCWVsc2UKPiAgIAkJY2xlYW5fdmly
dHVhbF9kcF9tb25pdG9yKHZncHUsIFBPUlRfQik7Cj4gQEAgLTUwNSwxMiArNTA1LDEyIEBAIHZv
aWQgaW50ZWxfdmdwdV9jbGVhbl9kaXNwbGF5KHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQo+ICAg
ICovCj4gICBpbnQgaW50ZWxfdmdwdV9pbml0X2Rpc3BsYXkoc3RydWN0IGludGVsX3ZncHUgKnZn
cHUsIHU2NCByZXNvbHV0aW9uKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdmdwdS0+Z3Z0LT5pOTE1Owo+ICAgCj4gICAJaW50ZWxfdmdwdV9pbml0X2kyY19l
ZGlkKHZncHUpOwo+ICAgCj4gLQlpZiAoSVNfU0tZTEFLRShkZXZfcHJpdikgfHwgSVNfS0FCWUxB
S0UoZGV2X3ByaXYpIHx8Cj4gLQkgICAgSVNfQ09GRkVFTEFLRShkZXZfcHJpdikpCj4gKwlpZiAo
SVNfU0tZTEFLRShpOTE1KSB8fCBJU19LQUJZTEFLRShpOTE1KSB8fAo+ICsJICAgIElTX0NPRkZF
RUxBS0UoaTkxNSkpCj4gICAJCXJldHVybiBzZXR1cF92aXJ0dWFsX2RwX21vbml0b3IodmdwdSwg
UE9SVF9ELCBHVlRfRFBfRCwKPiAgIAkJCQkJCXJlc29sdXRpb24pOwo+ICAgCWVsc2UKPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2RtYWJ1Zi5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3Z0L2RtYWJ1Zi5jCj4gaW5kZXggNDFjOGViYzYwYzYzLi41MjMwMzhkMjI0YTEg
MTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2RtYWJ1Zi5jCj4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2RtYWJ1Zi5jCj4gQEAgLTM5LDcgKzM5LDcgQEAKPiAg
IHN0YXRpYyBpbnQgdmdwdV9nZW1fZ2V0X3BhZ2VzKAo+ICAgCQlzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdCAqb2JqKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShvYmotPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShvYmotPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3Qgc2dfdGFibGUgKnN0Owo+
ICAgCXN0cnVjdCBzY2F0dGVybGlzdCAqc2c7Cj4gICAJaW50IGksIHJldDsKPiBAQCAtNjEsNyAr
NjEsNyBAQCBzdGF0aWMgaW50IHZncHVfZ2VtX2dldF9wYWdlcygKPiAgIAkJa2ZyZWUoc3QpOwo+
ICAgCQlyZXR1cm4gcmV0Owo+ICAgCX0KPiAtCWd0dF9lbnRyaWVzID0gKGdlbjhfcHRlX3QgX19p
b21lbSAqKWRldl9wcml2LT5nZ3R0LmdzbSArCj4gKwlndHRfZW50cmllcyA9IChnZW44X3B0ZV90
IF9faW9tZW0gKilpOTE1LT5nZ3R0LmdzbSArCj4gICAJCShmYl9pbmZvLT5zdGFydCA+PiBQQUdF
X1NISUZUKTsKPiAgIAlmb3JfZWFjaF9zZyhzdC0+c2dsLCBzZywgcGFnZV9udW0sIGkpIHsKPiAg
IAkJc2ctPm9mZnNldCA9IDA7Cj4gQEAgLTE1Miw3ICsxNTIsNyBAQCBzdGF0aWMgY29uc3Qgc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3Rfb3BzIGludGVsX3ZncHVfZ2VtX29wcyA9IHsKPiAgIHN0
YXRpYyBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqdmdwdV9jcmVhdGVfZ2VtKHN0cnVjdCBk
cm1fZGV2aWNlICpkZXYsCj4gICAJCXN0cnVjdCBpbnRlbF92Z3B1X2ZiX2luZm8gKmluZm8pCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAlz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwo+ICAgCj4gICAJb2JqID0gaTkxNV9nZW1f
b2JqZWN0X2FsbG9jKCk7Cj4gQEAgLTE2NSw3ICsxNjUsNyBAQCBzdGF0aWMgc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3QgKnZncHVfY3JlYXRlX2dlbShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+
ICAgCj4gICAJb2JqLT5yZWFkX2RvbWFpbnMgPSBJOTE1X0dFTV9ET01BSU5fR1RUOwo+ICAgCW9i
ai0+d3JpdGVfZG9tYWluID0gMDsKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpIHsK
PiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkgewo+ICAgCQl1bnNpZ25lZCBpbnQgdGlsaW5n
X21vZGUgPSAwOwo+ICAgCQl1bnNpZ25lZCBpbnQgc3RyaWRlID0gMDsKPiAgIAo+IEBAIC0zNjAs
NyArMzYwLDcgQEAgc3RhdGljIHZvaWQgdXBkYXRlX2ZiX2luZm8oc3RydWN0IHZmaW9fZGV2aWNl
X2dmeF9wbGFuZV9pbmZvICpndnRfZG1hYnVmLAo+ICAgCj4gICBpbnQgaW50ZWxfdmdwdV9xdWVy
eV9wbGFuZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwgdm9pZCAqYXJncykKPiAgIHsKPiAtCXN0
cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmdmdwdS0+Z3Z0LT5kZXZfcHJpdi0+ZHJtOwo+ICsJc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiA9ICZ2Z3B1LT5ndnQtPmk5MTUtPmRybTsKPiAgIAlzdHJ1Y3Qg
dmZpb19kZXZpY2VfZ2Z4X3BsYW5lX2luZm8gKmdmeF9wbGFuZV9pbmZvID0gYXJnczsKPiAgIAlz
dHJ1Y3QgaW50ZWxfdmdwdV9kbWFidWZfb2JqICpkbWFidWZfb2JqOwo+ICAgCXN0cnVjdCBpbnRl
bF92Z3B1X2ZiX2luZm8gZmJfaW5mbzsKPiBAQCAtNDY2LDcgKzQ2Niw3IEBAIGludCBpbnRlbF92
Z3B1X3F1ZXJ5X3BsYW5lKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCB2b2lkICphcmdzKQo+ICAg
LyogVG8gYXNzb2NpYXRlIGFuIGV4cG9zZWQgZG1hYnVmIHdpdGggdGhlIGRtYWJ1Zl9vYmogKi8K
PiAgIGludCBpbnRlbF92Z3B1X2dldF9kbWFidWYoc3RydWN0IGludGVsX3ZncHUgKnZncHUsIHVu
c2lnbmVkIGludCBkbWFidWZfaWQpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0g
JnZncHUtPmd2dC0+ZGV2X3ByaXYtPmRybTsKPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAm
dmdwdS0+Z3Z0LT5pOTE1LT5kcm07Cj4gICAJc3RydWN0IGludGVsX3ZncHVfZG1hYnVmX29iaiAq
ZG1hYnVmX29iajsKPiAgIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwo+ICAgCXN0
cnVjdCBkbWFfYnVmICpkbWFidWY7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d2dC9lZGlkLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZWRpZC5jCj4gaW5kZXggMWZl
NjEyNDkxOGYxLi45ZTQ1Y2JhYzVlZWQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Z0L2VkaWQuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9lZGlkLmMKPiBA
QCAtMTM1LDcgKzEzNSw3IEBAIHN0YXRpYyB2b2lkIHJlc2V0X2dtYnVzX2NvbnRyb2xsZXIoc3Ry
dWN0IGludGVsX3ZncHUgKnZncHUpCj4gICBzdGF0aWMgaW50IGdtYnVzMF9tbWlvX3dyaXRlKHN0
cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LAo+ICAgCQkJdW5zaWduZWQgaW50IG9mZnNldCwgdm9pZCAq
cF9kYXRhLCB1bnNpZ25lZCBpbnQgYnl0ZXMpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB2Z3B1LT5ndnQtPmRldl9wcml2Owo+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB2Z3B1LT5ndnQtPmk5MTU7Cj4gICAJaW50IHBvcnQsIHBpbl9zZWxl
Y3Q7Cj4gICAKPiAgIAltZW1jcHkoJnZncHVfdnJlZyh2Z3B1LCBvZmZzZXQpLCBwX2RhdGEsIGJ5
dGVzKTsKPiBAQCAtMTQ3LDkgKzE0Nyw5IEBAIHN0YXRpYyBpbnQgZ21idXMwX21taW9fd3JpdGUo
c3RydWN0IGludGVsX3ZncHUgKnZncHUsCj4gICAJaWYgKHBpbl9zZWxlY3QgPT0gMCkKPiAgIAkJ
cmV0dXJuIDA7Cj4gICAKPiAtCWlmIChJU19CUk9YVE9OKGRldl9wcml2KSkKPiArCWlmIChJU19C
Uk9YVE9OKGk5MTUpKQo+ICAgCQlwb3J0ID0gYnh0X2dldF9wb3J0X2Zyb21fZ21idXMwKHBpbl9z
ZWxlY3QpOwo+IC0JZWxzZSBpZiAoSVNfQ09GRkVFTEFLRShkZXZfcHJpdikpCj4gKwllbHNlIGlm
IChJU19DT0ZGRUVMQUtFKGk5MTUpKQo+ICAgCQlwb3J0ID0gY25wX2dldF9wb3J0X2Zyb21fZ21i
dXMwKHBpbl9zZWxlY3QpOwo+ICAgCWVsc2UKPiAgIAkJcG9ydCA9IGdldF9wb3J0X2Zyb21fZ21i
dXMwKHBpbl9zZWxlY3QpOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQv
ZXhlY2xpc3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9leGVjbGlzdC5jCj4gaW5kZXgg
ZjIxYjhmYjViMzdlLi43YTdhOTI1NTY1YTAgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Z0L2V4ZWNsaXN0LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZXhl
Y2xpc3QuYwo+IEBAIC00MCw3ICs0MCw3IEBACj4gICAjZGVmaW5lIF9FTF9PRkZTRVRfU1RBVFVT
X1BUUiAgIDB4M0EwCj4gICAKPiAgICNkZWZpbmUgZXhlY2xpc3RfcmluZ19tbWlvKGd2dCwgcmlu
Z19pZCwgb2Zmc2V0KSBcCj4gLQkoZ3Z0LT5kZXZfcHJpdi0+ZW5naW5lW3JpbmdfaWRdLT5tbWlv
X2Jhc2UgKyAob2Zmc2V0KSkKPiArCShndnQtPmk5MTUtPmVuZ2luZVtyaW5nX2lkXS0+bW1pb19i
YXNlICsgKG9mZnNldCkpCj4gICAKPiAgICNkZWZpbmUgdmFsaWRfY29udGV4dChjdHgpICgoY3R4
KS0+dmFsaWQpCj4gICAjZGVmaW5lIHNhbWVfY29udGV4dChhLCBiKSAoKChhKS0+Y29udGV4dF9p
ZCA9PSAoYiktPmNvbnRleHRfaWQpICYmIFwKPiBAQCAtMTMzLDcgKzEzMyw3IEBAIHN0YXRpYyB2
b2lkIGVtdWxhdGVfY3NiX3VwZGF0ZShzdHJ1Y3QgaW50ZWxfdmdwdV9leGVjbGlzdCAqZXhlY2xp
c3QsCj4gICAJdTMyIHdyaXRlX3BvaW50ZXI7Cj4gICAJdTMyIGN0eF9zdGF0dXNfcHRyX3JlZywg
Y3R4X3N0YXR1c19idWZfcmVnLCBvZmZzZXQ7Cj4gICAJdW5zaWduZWQgbG9uZyBod3NwX2dwYTsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHZncHUtPmd2dC0+ZGV2X3By
aXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHZncHUtPmd2dC0+aTkxNTsK
PiAgIAo+ICAgCWN0eF9zdGF0dXNfcHRyX3JlZyA9IGV4ZWNsaXN0X3JpbmdfbW1pbyh2Z3B1LT5n
dnQsIHJpbmdfaWQsCj4gICAJCQlfRUxfT0ZGU0VUX1NUQVRVU19QVFIpOwo+IEBAIC0xNjksNyAr
MTY5LDcgQEAgc3RhdGljIHZvaWQgZW11bGF0ZV9jc2JfdXBkYXRlKHN0cnVjdCBpbnRlbF92Z3B1
X2V4ZWNsaXN0ICpleGVjbGlzdCwKPiAgIAkJCXN0YXR1cywgOCk7Cj4gICAJCWludGVsX2d2dF9o
eXBlcnZpc29yX3dyaXRlX2dwYSh2Z3B1LAo+ICAgCQkJaHdzcF9ncGEgKwo+IC0JCQlpbnRlbF9o
d3NfY3NiX3dyaXRlX2luZGV4KGRldl9wcml2KSAqIDQsCj4gKwkJCWludGVsX2h3c19jc2Jfd3Jp
dGVfaW5kZXgoaTkxNSkgKiA0LAo+ICAgCQkJJndyaXRlX3BvaW50ZXIsIDQpOwo+ICAgCX0KPiAg
IAo+IEBAIC01MjksMTIgKzUyOSwxMiBAQCBzdGF0aWMgdm9pZCBpbml0X3ZncHVfZXhlY2xpc3Qo
c3RydWN0IGludGVsX3ZncHUgKnZncHUsIGludCByaW5nX2lkKQo+ICAgc3RhdGljIHZvaWQgY2xl
YW5fZXhlY2xpc3Qoc3RydWN0IGludGVsX3ZncHUgKnZncHUsCj4gICAJCQkgICBpbnRlbF9lbmdp
bmVfbWFza190IGVuZ2luZV9tYXNrKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdmdwdS0+Z3Z0LT5pOTE1Owo+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZTsKPiAgIAlzdHJ1Y3QgaW50ZWxfdmdwdV9zdWJtaXNzaW9uICpzID0gJnZncHUtPnN1
Ym1pc3Npb247Cj4gICAJaW50ZWxfZW5naW5lX21hc2tfdCB0bXA7Cj4gICAKPiAtCWZvcl9lYWNo
X2VuZ2luZV9tYXNrZWQoZW5naW5lLCBkZXZfcHJpdiwgZW5naW5lX21hc2ssIHRtcCkgewo+ICsJ
Zm9yX2VhY2hfZW5naW5lX21hc2tlZChlbmdpbmUsIGk5MTUsIGVuZ2luZV9tYXNrLCB0bXApIHsK
PiAgIAkJa2ZyZWUocy0+cmluZ19zY2FuX2J1ZmZlcltlbmdpbmUtPmlkXSk7Cj4gICAJCXMtPnJp
bmdfc2Nhbl9idWZmZXJbZW5naW5lLT5pZF0gPSBOVUxMOwo+ICAgCQlzLT5yaW5nX3NjYW5fYnVm
ZmVyX3NpemVbZW5naW5lLT5pZF0gPSAwOwo+IEBAIC01NDQsMTEgKzU0NCwxMSBAQCBzdGF0aWMg
dm9pZCBjbGVhbl9leGVjbGlzdChzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwKPiAgIHN0YXRpYyB2
b2lkIHJlc2V0X2V4ZWNsaXN0KHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LAo+ICAgCQkJICAgaW50
ZWxfZW5naW5lX21hc2tfdCBlbmdpbmVfbWFzaykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHZncHUtPmd2dC0+ZGV2X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHZncHUtPmd2dC0+aTkxNTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmU7Cj4gICAJaW50ZWxfZW5naW5lX21hc2tfdCB0bXA7Cj4gICAKPiAtCWZv
cl9lYWNoX2VuZ2luZV9tYXNrZWQoZW5naW5lLCBkZXZfcHJpdiwgZW5naW5lX21hc2ssIHRtcCkK
PiArCWZvcl9lYWNoX2VuZ2luZV9tYXNrZWQoZW5naW5lLCBpOTE1LCBlbmdpbmVfbWFzaywgdG1w
KQo+ICAgCQlpbml0X3ZncHVfZXhlY2xpc3QodmdwdSwgZW5naW5lLT5pZCk7Cj4gICB9Cj4gICAK
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2ZiX2RlY29kZXIuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9mYl9kZWNvZGVyLmMKPiBpbmRleCA2NWU4NDczOTJhZWEu
Ljc2YzM0NmVlY2RhMyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZmJf
ZGVjb2Rlci5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2ZiX2RlY29kZXIuYwo+
IEBAIC0xNDYsMTIgKzE0NiwxMiBAQCBzdGF0aWMgaW50IHNrbF9mb3JtYXRfdG9fZHJtKGludCBm
b3JtYXQsIGJvb2wgcmdiX29yZGVyLCBib29sIGFscGhhLAo+ICAgc3RhdGljIHUzMiBpbnRlbF92
Z3B1X2dldF9zdHJpZGUoc3RydWN0IGludGVsX3ZncHUgKnZncHUsIGludCBwaXBlLAo+ICAgCXUz
MiB0aWxlZCwgaW50IHN0cmlkZV9tYXNrLCBpbnQgYnBwKQo+ICAgewo+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdmdwdS0+Z3Z0LT5pOTE1Owo+ICAgCj4gICAJdTMyIHN0
cmlkZV9yZWcgPSB2Z3B1X3ZyZWdfdCh2Z3B1LCBEU1BTVFJJREUocGlwZSkpICYgc3RyaWRlX21h
c2s7Cj4gICAJdTMyIHN0cmlkZSA9IHN0cmlkZV9yZWc7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDkpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkgewo+ICAgCQlz
d2l0Y2ggKHRpbGVkKSB7Cj4gICAJCWNhc2UgUExBTkVfQ1RMX1RJTEVEX0xJTkVBUjoKPiAgIAkJ
CXN0cmlkZSA9IHN0cmlkZV9yZWcgKiA2NDsKPiBAQCAtMjAzLDcgKzIwMyw3IEBAIGludCBpbnRl
bF92Z3B1X2RlY29kZV9wcmltYXJ5X3BsYW5lKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LAo+ICAg
CXN0cnVjdCBpbnRlbF92Z3B1X3ByaW1hcnlfcGxhbmVfZm9ybWF0ICpwbGFuZSkKPiAgIHsKPiAg
IAl1MzIgdmFsLCBmbXQ7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2
Z3B1LT5ndnQtPmRldl9wcml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2
Z3B1LT5ndnQtPmk5MTU7Cj4gICAJaW50IHBpcGU7Cj4gICAKPiAgIAlwaXBlID0gZ2V0X2FjdGl2
ZV9waXBlKHZncHUpOwo+IEBAIC0yMTUsNyArMjE1LDcgQEAgaW50IGludGVsX3ZncHVfZGVjb2Rl
X3ByaW1hcnlfcGxhbmUoc3RydWN0IGludGVsX3ZncHUgKnZncHUsCj4gICAJaWYgKCFwbGFuZS0+
ZW5hYmxlZCkKPiAgIAkJcmV0dXJuIC1FTk9ERVY7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2
X3ByaXYpID49IDkpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkgewo+ICAgCQlwbGFu
ZS0+dGlsZWQgPSB2YWwgJiBQTEFORV9DVExfVElMRURfTUFTSzsKPiAgIAkJZm10ID0gc2tsX2Zv
cm1hdF90b19kcm0oCj4gICAJCQl2YWwgJiBQTEFORV9DVExfRk9STUFUX01BU0ssCj4gQEAgLTI1
Niw3ICsyNTYsNyBAQCBpbnQgaW50ZWxfdmdwdV9kZWNvZGVfcHJpbWFyeV9wbGFuZShzdHJ1Y3Qg
aW50ZWxfdmdwdSAqdmdwdSwKPiAgIAl9Cj4gICAKPiAgIAlwbGFuZS0+c3RyaWRlID0gaW50ZWxf
dmdwdV9nZXRfc3RyaWRlKHZncHUsIHBpcGUsIHBsYW5lLT50aWxlZCwKPiAtCQkoSU5URUxfR0VO
KGRldl9wcml2KSA+PSA5KSA/Cj4gKwkJKElOVEVMX0dFTihpOTE1KSA+PSA5KSA/Cj4gICAJCQko
X1BSSV9QTEFORV9TVFJJREVfTUFTSyA+PiA2KSA6Cj4gICAJCQkJX1BSSV9QTEFORV9TVFJJREVf
TUFTSywgcGxhbmUtPmJwcCk7Cj4gICAKPiBAQCAtMzM0LDcgKzMzNCw3IEBAIGludCBpbnRlbF92
Z3B1X2RlY29kZV9jdXJzb3JfcGxhbmUoc3RydWN0IGludGVsX3ZncHUgKnZncHUsCj4gICB7Cj4g
ICAJdTMyIHZhbCwgbW9kZSwgaW5kZXg7Cj4gICAJdTMyIGFscGhhX3BsYW5lLCBhbHBoYV9mb3Jj
ZTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHZncHUtPmd2dC0+ZGV2
X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHZncHUtPmd2dC0+aTkx
NTsKPiAgIAlpbnQgcGlwZTsKPiAgIAo+ICAgCXBpcGUgPSBnZXRfYWN0aXZlX3BpcGUodmdwdSk7
Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9maXJtd2FyZS5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2Zpcm13YXJlLmMKPiBpbmRleCAwNDk3NzVlOGUzNTAuLmVm
ZGM5ZGY0ZjczMSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZmlybXdh
cmUuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9maXJtd2FyZS5jCj4gQEAgLTY4
LDcgKzY4LDcgQEAgc3RhdGljIHN0cnVjdCBiaW5fYXR0cmlidXRlIGZpcm13YXJlX2F0dHIgPSB7
Cj4gICAKPiAgIHN0YXRpYyBpbnQgbW1pb19zbmFwc2hvdF9oYW5kbGVyKHN0cnVjdCBpbnRlbF9n
dnQgKmd2dCwgdTMyIG9mZnNldCwgdm9pZCAqZGF0YSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gZ3Z0LT5kZXZfcHJpdjsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gZ3Z0LT5pOTE1Owo+ICAgCj4gICAJKih1MzIgKikoZGF0YSArIG9mZnNldCkg
PSBpbnRlbF91bmNvcmVfcmVhZF9ub3RyYWNlKCZpOTE1LT51bmNvcmUsCj4gICAJCQkJCQkJICAg
IF9NTUlPKG9mZnNldCkpOwo+IEBAIC03OCw3ICs3OCw3IEBAIHN0YXRpYyBpbnQgbW1pb19zbmFw
c2hvdF9oYW5kbGVyKHN0cnVjdCBpbnRlbF9ndnQgKmd2dCwgdTMyIG9mZnNldCwgdm9pZCAqZGF0
YSkKPiAgIHN0YXRpYyBpbnQgZXhwb3NlX2Zpcm13YXJlX3N5c2ZzKHN0cnVjdCBpbnRlbF9ndnQg
Kmd2dCkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZ3Z0X2RldmljZV9pbmZvICppbmZvID0gJmd2
dC0+ZGV2aWNlX2luZm87Cj4gLQlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGd2dC0+ZGV2X3ByaXYt
PmRybS5wZGV2Owo+ICsJc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBndnQtPmk5MTUtPmRybS5wZGV2
Owo+ICAgCXN0cnVjdCBndnRfZmlybXdhcmVfaGVhZGVyICpoOwo+ICAgCXZvaWQgKmZpcm13YXJl
Owo+ICAgCXZvaWQgKnA7Cj4gQEAgLTEyOSw3ICsxMjksNyBAQCBzdGF0aWMgaW50IGV4cG9zZV9m
aXJtd2FyZV9zeXNmcyhzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQpCj4gICAKPiAgIHN0YXRpYyB2b2lk
IGNsZWFuX2Zpcm13YXJlX3N5c2ZzKHN0cnVjdCBpbnRlbF9ndnQgKmd2dCkKPiAgIHsKPiAtCXN0
cnVjdCBwY2lfZGV2ICpwZGV2ID0gZ3Z0LT5kZXZfcHJpdi0+ZHJtLnBkZXY7Cj4gKwlzdHJ1Y3Qg
cGNpX2RldiAqcGRldiA9IGd2dC0+aTkxNS0+ZHJtLnBkZXY7Cj4gICAKPiAgIAlkZXZpY2VfcmVt
b3ZlX2Jpbl9maWxlKCZwZGV2LT5kZXYsICZmaXJtd2FyZV9hdHRyKTsKPiAgIAl2ZnJlZShmaXJt
d2FyZV9hdHRyLnByaXZhdGUpOwo+IEBAIC0xNTMsOCArMTUzLDggQEAgc3RhdGljIGludCB2ZXJp
ZnlfZmlybXdhcmUoc3RydWN0IGludGVsX2d2dCAqZ3Z0LAo+ICAgCQkJICAgY29uc3Qgc3RydWN0
IGZpcm13YXJlICpmdykKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZ3Z0X2RldmljZV9pbmZvICpp
bmZvID0gJmd2dC0+ZGV2aWNlX2luZm87Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSBndnQtPmRldl9wcml2Owo+IC0Jc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBkZXZfcHJp
di0+ZHJtLnBkZXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd2dC0+aTkx
NTsKPiArCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gaTkxNS0+ZHJtLnBkZXY7Cj4gICAJc3RydWN0
IGd2dF9maXJtd2FyZV9oZWFkZXIgKmg7Cj4gICAJdW5zaWduZWQgbG9uZyBpZCwgY3JjMzJfc3Rh
cnQ7Cj4gICAJY29uc3Qgdm9pZCAqbWVtOwo+IEBAIC0yMDgsOCArMjA4LDggQEAgc3RhdGljIGlu
dCB2ZXJpZnlfZmlybXdhcmUoc3RydWN0IGludGVsX2d2dCAqZ3Z0LAo+ICAgaW50IGludGVsX2d2
dF9sb2FkX2Zpcm13YXJlKHN0cnVjdCBpbnRlbF9ndnQgKmd2dCkKPiAgIHsKPiAgIAlzdHJ1Y3Qg
aW50ZWxfZ3Z0X2RldmljZV9pbmZvICppbmZvID0gJmd2dC0+ZGV2aWNlX2luZm87Cj4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndnQtPmRldl9wcml2Owo+IC0Jc3RydWN0
IHBjaV9kZXYgKnBkZXYgPSBkZXZfcHJpdi0+ZHJtLnBkZXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IGd2dC0+aTkxNTsKPiArCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gaTkx
NS0+ZHJtLnBkZXY7Cj4gICAJc3RydWN0IGludGVsX2d2dF9maXJtd2FyZSAqZmlybXdhcmUgPSAm
Z3Z0LT5maXJtd2FyZTsKPiAgIAlzdHJ1Y3QgZ3Z0X2Zpcm13YXJlX2hlYWRlciAqaDsKPiAgIAlj
b25zdCBzdHJ1Y3QgZmlybXdhcmUgKmZ3Owo+IEBAIC0yNDQsNyArMjQ0LDcgQEAgaW50IGludGVs
X2d2dF9sb2FkX2Zpcm13YXJlKHN0cnVjdCBpbnRlbF9ndnQgKmd2dCkKPiAgIAo+ICAgCWd2dF9k
YmdfY29yZSgicmVxdWVzdCBodyBzdGF0ZSBmaXJtd2FyZSAlcy4uLlxuIiwgcGF0aCk7Cj4gICAK
PiAtCXJldCA9IHJlcXVlc3RfZmlybXdhcmUoJmZ3LCBwYXRoLCAmZGV2X3ByaXYtPmRybS5wZGV2
LT5kZXYpOwo+ICsJcmV0ID0gcmVxdWVzdF9maXJtd2FyZSgmZncsIHBhdGgsICZpOTE1LT5kcm0u
cGRldi0+ZGV2KTsKPiAgIAlrZnJlZShwYXRoKTsKPiAgIAo+ICAgCWlmIChyZXQpCj4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9ndHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d2dC9ndHQuYwo+IGluZGV4IDUzMTE1YmRhZTEyYi4uMzkwNTYyZmUzMjIzIDEwMDY0NAo+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9ndHQuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d2dC9ndHQuYwo+IEBAIC0yNzUsMjQgKzI3NSwyNCBAQCBzdGF0aWMgaW5saW5l
IGludCBnZXRfcHNlX3R5cGUoaW50IHR5cGUpCj4gICAJcmV0dXJuIGd0dF90eXBlX3RhYmxlW3R5
cGVdLnBzZV9lbnRyeV90eXBlOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB1NjQgcmVhZF9wdGU2NChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHVuc2lnbmVkIGxvbmcgaW5kZXgpCj4g
K3N0YXRpYyB1NjQgcmVhZF9wdGU2NChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdW5z
aWduZWQgbG9uZyBpbmRleCkKPiAgIHsKPiAtCXZvaWQgX19pb21lbSAqYWRkciA9IChnZW44X3B0
ZV90IF9faW9tZW0gKilkZXZfcHJpdi0+Z2d0dC5nc20gKyBpbmRleDsKPiArCXZvaWQgX19pb21l
bSAqYWRkciA9IChnZW44X3B0ZV90IF9faW9tZW0gKilpOTE1LT5nZ3R0LmdzbSArIGluZGV4Owo+
ICAgCj4gICAJcmV0dXJuIHJlYWRxKGFkZHIpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGdn
dHRfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRp
YyB2b2lkIGdndHRfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAg
IHsKPiAtCW1taW9faHdfYWNjZXNzX3ByZShkZXZfcHJpdik7Cj4gKwltbWlvX2h3X2FjY2Vzc19w
cmUoaTkxNSk7Cj4gICAJSTkxNV9XUklURShHRlhfRkxTSF9DTlRMX0dFTjYsIEdGWF9GTFNIX0NO
VExfRU4pOwo+IC0JbW1pb19od19hY2Nlc3NfcG9zdChkZXZfcHJpdik7Cj4gKwltbWlvX2h3X2Fj
Y2Vzc19wb3N0KGk5MTUpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIHdyaXRlX3B0ZTY0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgd3JpdGVfcHRl
NjQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCXVuc2lnbmVkIGxvbmcgaW5k
ZXgsIHU2NCBwdGUpCj4gICB7Cj4gLQl2b2lkIF9faW9tZW0gKmFkZHIgPSAoZ2VuOF9wdGVfdCBf
X2lvbWVtICopZGV2X3ByaXYtPmdndHQuZ3NtICsgaW5kZXg7Cj4gKwl2b2lkIF9faW9tZW0gKmFk
ZHIgPSAoZ2VuOF9wdGVfdCBfX2lvbWVtICopaTkxNS0+Z2d0dC5nc20gKyBpbmRleDsKPiAgIAo+
ICAgCXdyaXRlcShwdGUsIGFkZHIpOwo+ICAgfQo+IEBAIC0zMTUsNyArMzE1LDcgQEAgc3RhdGlj
IGlubGluZSBpbnQgZ3R0X2dldF9lbnRyeTY0KHZvaWQgKnB0LAo+ICAgCQlpZiAoV0FSTl9PTihy
ZXQpKQo+ICAgCQkJcmV0dXJuIHJldDsKPiAgIAl9IGVsc2UgaWYgKCFwdCkgewo+IC0JCWUtPnZh
bDY0ID0gcmVhZF9wdGU2NCh2Z3B1LT5ndnQtPmRldl9wcml2LCBpbmRleCk7Cj4gKwkJZS0+dmFs
NjQgPSByZWFkX3B0ZTY0KHZncHUtPmd2dC0+aTkxNSwgaW5kZXgpOwo+ICAgCX0gZWxzZSB7Cj4g
ICAJCWUtPnZhbDY0ID0gKigodTY0ICopcHQgKyBpbmRleCk7Cj4gICAJfQo+IEBAIC0zNDAsNyAr
MzQwLDcgQEAgc3RhdGljIGlubGluZSBpbnQgZ3R0X3NldF9lbnRyeTY0KHZvaWQgKnB0LAo+ICAg
CQlpZiAoV0FSTl9PTihyZXQpKQo+ICAgCQkJcmV0dXJuIHJldDsKPiAgIAl9IGVsc2UgaWYgKCFw
dCkgewo+IC0JCXdyaXRlX3B0ZTY0KHZncHUtPmd2dC0+ZGV2X3ByaXYsIGluZGV4LCBlLT52YWw2
NCk7Cj4gKwkJd3JpdGVfcHRlNjQodmdwdS0+Z3Z0LT5pOTE1LCBpbmRleCwgZS0+dmFsNjQpOwo+
ICAgCX0gZWxzZSB7Cj4gICAJCSooKHU2NCAqKXB0ICsgaW5kZXgpID0gZS0+dmFsNjQ7Cj4gICAJ
fQo+IEBAIC03MzQsNyArNzM0LDcgQEAgc3RhdGljIGludCBkZXRhY2hfb29zX3BhZ2Uoc3RydWN0
IGludGVsX3ZncHUgKnZncHUsCj4gICAKPiAgIHN0YXRpYyB2b2lkIHBwZ3R0X2ZyZWVfc3B0KHN0
cnVjdCBpbnRlbF92Z3B1X3BwZ3R0X3NwdCAqc3B0KQo+ICAgewo+IC0Jc3RydWN0IGRldmljZSAq
a2RldiA9ICZzcHQtPnZncHUtPmd2dC0+ZGV2X3ByaXYtPmRybS5wZGV2LT5kZXY7Cj4gKwlzdHJ1
Y3QgZGV2aWNlICprZGV2ID0gJnNwdC0+dmdwdS0+Z3Z0LT5pOTE1LT5kcm0ucGRldi0+ZGV2Owo+
ICAgCj4gICAJdHJhY2Vfc3B0X2ZyZWUoc3B0LT52Z3B1LT5pZCwgc3B0LCBzcHQtPmd1ZXN0X3Bh
Z2UudHlwZSk7Cj4gICAKPiBAQCAtODE5LDcgKzgxOSw3IEBAIHN0YXRpYyBpbnQgcmVjbGFpbV9v
bmVfcHBndHRfbW0oc3RydWN0IGludGVsX2d2dCAqZ3Z0KTsKPiAgIHN0YXRpYyBzdHJ1Y3QgaW50
ZWxfdmdwdV9wcGd0dF9zcHQgKnBwZ3R0X2FsbG9jX3NwdCgKPiAgIAkJc3RydWN0IGludGVsX3Zn
cHUgKnZncHUsIGVudW0gaW50ZWxfZ3Z0X2d0dF90eXBlIHR5cGUpCj4gICB7Cj4gLQlzdHJ1Y3Qg
ZGV2aWNlICprZGV2ID0gJnZncHUtPmd2dC0+ZGV2X3ByaXYtPmRybS5wZGV2LT5kZXY7Cj4gKwlz
dHJ1Y3QgZGV2aWNlICprZGV2ID0gJnZncHUtPmd2dC0+aTkxNS0+ZHJtLnBkZXYtPmRldjsKPiAg
IAlzdHJ1Y3QgaW50ZWxfdmdwdV9wcGd0dF9zcHQgKnNwdCA9IE5VTEw7Cj4gICAJZG1hX2FkZHJf
dCBkYWRkcjsKPiAgIAlpbnQgcmV0Owo+IEBAIC0xMDQ0LDE0ICsxMDQ0LDE0IEBAIHN0YXRpYyBp
bnQgcHBndHRfaW52YWxpZGF0ZV9zcHQoc3RydWN0IGludGVsX3ZncHVfcHBndHRfc3B0ICpzcHQp
Cj4gICAKPiAgIHN0YXRpYyBib29sIHZncHVfaXBzX2VuYWJsZWQoc3RydWN0IGludGVsX3ZncHUg
KnZncHUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2Z3B1
LT5ndnQtPmRldl9wcml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2Z3B1
LT5ndnQtPmk5MTU7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID09IDkgfHwgSU5U
RUxfR0VOKGRldl9wcml2KSA9PSAxMCkgewo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA9PSA5IHx8
IElOVEVMX0dFTihpOTE1KSA9PSAxMCkgewo+ICAgCQl1MzIgaXBzID0gdmdwdV92cmVnX3Qodmdw
dSwgR0VOOF9HQU1XX0VDT19ERVZfUldfSUEpICYKPiAgIAkJCUdBTVdfRUNPX0VOQUJMRV82NEtf
SVBTX0ZJRUxEOwo+ICAgCj4gICAJCXJldHVybiBpcHMgPT0gR0FNV19FQ09fRU5BQkxFXzY0S19J
UFNfRklFTEQ7Cj4gLQl9IGVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpIHsKPiAr
CX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKSB7Cj4gICAJCS8qIDY0SyBwYWdpbmcg
b25seSBjb250cm9sbGVkIGJ5IElQUyBiaXQgaW4gUFRFIG5vdy4gKi8KPiAgIAkJcmV0dXJuIHRy
dWU7Cj4gICAJfSBlbHNlCj4gQEAgLTExNTMsNyArMTE1Myw3IEBAIHN0YXRpYyBpbnQgaXNfMk1C
X2d0dF9wb3NzaWJsZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwKPiAgIAlzdHJ1Y3QgaW50ZWxf
Z3Z0X2d0dF9wdGVfb3BzICpvcHMgPSB2Z3B1LT5ndnQtPmd0dC5wdGVfb3BzOwo+ICAgCXVuc2ln
bmVkIGxvbmcgcGZuOwo+ICAgCj4gLQlpZiAoIUhBU19QQUdFX1NJWkVTKHZncHUtPmd2dC0+ZGV2
X3ByaXYsIEk5MTVfR1RUX1BBR0VfU0laRV8yTSkpCj4gKwlpZiAoIUhBU19QQUdFX1NJWkVTKHZn
cHUtPmd2dC0+aTkxNSwgSTkxNV9HVFRfUEFHRV9TSVpFXzJNKSkKPiAgIAkJcmV0dXJuIDA7Cj4g
ICAKPiAgIAlwZm4gPSBpbnRlbF9ndnRfaHlwZXJ2aXNvcl9nZm5fdG9fbWZuKHZncHUsIG9wcy0+
Z2V0X3BmbihlbnRyeSkpOwo+IEBAIC0yMzAxLDcgKzIzMDEsNyBAQCBzdGF0aWMgaW50IGVtdWxh
dGVfZ2d0dF9tbWlvX3dyaXRlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCB1bnNpZ25lZCBpbnQg
b2ZmLAo+ICAgCWdndHRfaW52YWxpZGF0ZV9wdGUodmdwdSwgJmUpOwo+ICAgCj4gICAJZ2d0dF9z
ZXRfaG9zdF9lbnRyeShnZ3R0X21tLCAmbSwgZ19ndHRfaW5kZXgpOwo+IC0JZ2d0dF9pbnZhbGlk
YXRlKGd2dC0+ZGV2X3ByaXYpOwo+ICsJZ2d0dF9pbnZhbGlkYXRlKGd2dC0+aTkxNSk7Cj4gICAJ
cmV0dXJuIDA7Cj4gICB9Cj4gICAKPiBAQCAtMjM0MCw3ICsyMzQwLDcgQEAgc3RhdGljIGludCBh
bGxvY19zY3JhdGNoX3BhZ2VzKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LAo+ICAgCQkJCXZncHUt
Pmd2dC0+ZGV2aWNlX2luZm8uZ3R0X2VudHJ5X3NpemVfc2hpZnQ7Cj4gICAJdm9pZCAqc2NyYXRj
aF9wdDsKPiAgIAlpbnQgaTsKPiAtCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZ2Z3B1LT5ndnQtPmRl
dl9wcml2LT5kcm0ucGRldi0+ZGV2Owo+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJnZncHUtPmd2
dC0+aTkxNS0+ZHJtLnBkZXYtPmRldjsKPiAgIAlkbWFfYWRkcl90IGRhZGRyOwo+ICAgCj4gICAJ
aWYgKFdBUk5fT04odHlwZSA8IEdUVF9UWVBFX1BQR1RUX1BURV9QVCB8fCB0eXBlID49IEdUVF9U
WVBFX01BWCkpCj4gQEAgLTIzOTcsNyArMjM5Nyw3IEBAIHN0YXRpYyBpbnQgYWxsb2Nfc2NyYXRj
aF9wYWdlcyhzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwKPiAgIHN0YXRpYyBpbnQgcmVsZWFzZV9z
Y3JhdGNoX3BhZ2VfdHJlZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKPiAgIHsKPiAgIAlpbnQg
aTsKPiAtCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZ2Z3B1LT5ndnQtPmRldl9wcml2LT5kcm0ucGRl
di0+ZGV2Owo+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJnZncHUtPmd2dC0+aTkxNS0+ZHJtLnBk
ZXYtPmRldjsKPiAgIAlkbWFfYWRkcl90IGRhZGRyOwo+ICAgCj4gICAJZm9yIChpID0gR1RUX1RZ
UEVfUFBHVFRfUFRFX1BUOyBpIDwgR1RUX1RZUEVfTUFYOyBpKyspIHsKPiBAQCAtMjY2OSw3ICsy
NjY5LDcgQEAgaW50IGludGVsX2d2dF9pbml0X2d0dChzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQpCj4g
ICB7Cj4gICAJaW50IHJldDsKPiAgIAl2b2lkICpwYWdlOwo+IC0Jc3RydWN0IGRldmljZSAqZGV2
ID0gJmd2dC0+ZGV2X3ByaXYtPmRybS5wZGV2LT5kZXY7Cj4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYg
PSAmZ3Z0LT5pOTE1LT5kcm0ucGRldi0+ZGV2Owo+ICAgCWRtYV9hZGRyX3QgZGFkZHI7Cj4gICAK
PiAgIAlndnRfZGJnX2NvcmUoImluaXQgZ3R0XG4iKTsKPiBAQCAtMjcxOCw3ICsyNzE4LDcgQEAg
aW50IGludGVsX2d2dF9pbml0X2d0dChzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQpCj4gICAgKi8KPiAg
IHZvaWQgaW50ZWxfZ3Z0X2NsZWFuX2d0dChzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQpCj4gICB7Cj4g
LQlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmZ3Z0LT5kZXZfcHJpdi0+ZHJtLnBkZXYtPmRldjsKPiAr
CXN0cnVjdCBkZXZpY2UgKmRldiA9ICZndnQtPmk5MTUtPmRybS5wZGV2LT5kZXY7Cj4gICAJZG1h
X2FkZHJfdCBkYWRkciA9IChkbWFfYWRkcl90KShndnQtPmd0dC5zY3JhdGNoX21mbiA8PAo+ICAg
CQkJCQlJOTE1X0dUVF9QQUdFX1NISUZUKTsKPiAgIAo+IEBAIC0yNzY2LDcgKzI3NjYsNyBAQCB2
b2lkIGludGVsX3ZncHVfaW52YWxpZGF0ZV9wcGd0dChzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkK
PiAgIHZvaWQgaW50ZWxfdmdwdV9yZXNldF9nZ3R0KHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCBi
b29sIGludmFsaWRhdGVfb2xkKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9ndnQgKmd2dCA9IHZn
cHUtPmd2dDsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGd2dC0+ZGV2
X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd2dC0+aTkxNTsKPiAg
IAlzdHJ1Y3QgaW50ZWxfZ3Z0X2d0dF9wdGVfb3BzICpwdGVfb3BzID0gdmdwdS0+Z3Z0LT5ndHQu
cHRlX29wczsKPiAgIAlzdHJ1Y3QgaW50ZWxfZ3Z0X2d0dF9lbnRyeSBlbnRyeSA9IHsudHlwZSA9
IEdUVF9UWVBFX0dHVFRfUFRFfTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZ3Z0X2d0dF9lbnRyeSBvbGRf
ZW50cnk7Cj4gQEAgLTI3OTYsNyArMjc5Niw3IEBAIHZvaWQgaW50ZWxfdmdwdV9yZXNldF9nZ3R0
KHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCBib29sIGludmFsaWRhdGVfb2xkKQo+ICAgCQlnZ3R0
X3NldF9ob3N0X2VudHJ5KHZncHUtPmd0dC5nZ3R0X21tLCAmZW50cnksIGluZGV4KyspOwo+ICAg
CX0KPiAgIAo+IC0JZ2d0dF9pbnZhbGlkYXRlKGRldl9wcml2KTsKPiArCWdndHRfaW52YWxpZGF0
ZShpOTE1KTsKPiAgIH0KPiAgIAo+ICAgLyoqCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d2dC9ndnQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9ndnQuYwo+IGluZGV4
IDQzZjQyNDIwNjJkZC4uYjg0Y2RkOGQ4Yzk4IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d2dC9ndnQuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9ndnQuYwo+
IEBAIC01Miw3ICs1Miw3IEBAIHN0YXRpYyBzdHJ1Y3QgaW50ZWxfdmdwdV90eXBlICppbnRlbF9n
dnRfZmluZF92Z3B1X3R5cGUoc3RydWN0IGludGVsX2d2dCAqZ3Z0LAo+ICAgCWludCBpOwo+ICAg
CXN0cnVjdCBpbnRlbF92Z3B1X3R5cGUgKnQ7Cj4gICAJY29uc3QgY2hhciAqZHJpdmVyX25hbWUg
PSBkZXZfZHJpdmVyX3N0cmluZygKPiAtCQkJJmd2dC0+ZGV2X3ByaXYtPmRybS5wZGV2LT5kZXYp
Owo+ICsJCQkmZ3Z0LT5pOTE1LT5kcm0ucGRldi0+ZGV2KTsKPiAgIAo+ICAgCWZvciAoaSA9IDA7
IGkgPCBndnQtPm51bV90eXBlczsgaSsrKSB7Cj4gICAJCXQgPSAmZ3Z0LT50eXBlc1tpXTsKPiBA
QCAtMTkxLDcgKzE5MSw3IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaW50ZWxfZ3Z0X29wcyBpbnRl
bF9ndnRfb3BzID0gewo+ICAgc3RhdGljIHZvaWQgaW5pdF9kZXZpY2VfaW5mbyhzdHJ1Y3QgaW50
ZWxfZ3Z0ICpndnQpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2d2dF9kZXZpY2VfaW5mbyAqaW5m
byA9ICZndnQtPmRldmljZV9pbmZvOwo+IC0Jc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBndnQtPmRl
dl9wcml2LT5kcm0ucGRldjsKPiArCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gZ3Z0LT5pOTE1LT5k
cm0ucGRldjsKPiAgIAo+ICAgCWluZm8tPm1heF9zdXBwb3J0X3ZncHVzID0gODsKPiAgIAlpbmZv
LT5jZmdfc3BhY2Vfc2l6ZSA9IFBDSV9DRkdfU1BBQ0VfRVhQX1NJWkU7Cj4gQEAgLTI1NywxNSAr
MjU3LDE1IEBAIHN0YXRpYyBpbnQgaW5pdF9zZXJ2aWNlX3RocmVhZChzdHJ1Y3QgaW50ZWxfZ3Z0
ICpndnQpCj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxfZ3Z0X2NsZWFuX2RldmljZSAtIGNsZWFu
IGEgR1ZUIGRldmljZQo+IC0gKiBAZGV2X3ByaXY6IGk5MTUgcHJpdmF0ZQo+ICsgKiBAaTkxNTog
aTkxNSBwcml2YXRlCj4gICAgKgo+ICAgICogVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgYXQgdGhl
IGRyaXZlciB1bmxvYWRpbmcgc3RhZ2UsIHRvIGZyZWUgdGhlCj4gICAgKiByZXNvdXJjZXMgb3du
ZWQgYnkgYSBHVlQgZGV2aWNlLgo+ICAgICoKPiAgICAqLwo+IC12b2lkIGludGVsX2d2dF9jbGVh
bl9kZXZpY2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGludGVs
X2d2dF9jbGVhbl9kZXZpY2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4g
LQlzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQgPSB0b19ndnQoZGV2X3ByaXYpOwo+ICsJc3RydWN0IGlu
dGVsX2d2dCAqZ3Z0ID0gdG9fZ3Z0KGk5MTUpOwo+ICAgCj4gICAJaWYgKFdBUk5fT04oIWd2dCkp
Cj4gICAJCXJldHVybjsKPiBAQCAtMjg1LDEzICsyODUsMTMgQEAgdm9pZCBpbnRlbF9ndnRfY2xl
YW5fZGV2aWNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAlpbnRlbF9n
dnRfY2xlYW5fbW1pb19pbmZvKGd2dCk7Cj4gICAJaWRyX2Rlc3Ryb3koJmd2dC0+dmdwdV9pZHIp
Owo+ICAgCj4gLQlrZnJlZShkZXZfcHJpdi0+Z3Z0KTsKPiAtCWRldl9wcml2LT5ndnQgPSBOVUxM
Owo+ICsJa2ZyZWUoaTkxNS0+Z3Z0KTsKPiArCWk5MTUtPmd2dCA9IE5VTEw7Cj4gICB9Cj4gICAK
PiAgIC8qKgo+ICAgICogaW50ZWxfZ3Z0X2luaXRfZGV2aWNlIC0gaW5pdGlhbGl6ZSBhIEdWVCBk
ZXZpY2UKPiAtICogQGRldl9wcml2OiBkcm0gaTkxNSBwcml2YXRlIGRhdGEKPiArICogQGk5MTU6
IGRybSBpOTE1IHByaXZhdGUgZGF0YQo+ICAgICoKPiAgICAqIFRoaXMgZnVuY3Rpb24gaXMgY2Fs
bGVkIGF0IHRoZSBpbml0aWFsaXphdGlvbiBzdGFnZSwgdG8gaW5pdGlhbGl6ZQo+ICAgICogbmVj
ZXNzYXJ5IEdWVCBjb21wb25lbnRzLgo+IEBAIC0zMDAsMTMgKzMwMCwxMyBAQCB2b2lkIGludGVs
X2d2dF9jbGVhbl9kZXZpY2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAg
ICogWmVybyBvbiBzdWNjZXNzLCBuZWdhdGl2ZSBlcnJvciBjb2RlIGlmIGZhaWxlZC4KPiAgICAq
Cj4gICAgKi8KPiAtaW50IGludGVsX2d2dF9pbml0X2RldmljZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gK2ludCBpbnRlbF9ndnRfaW5pdF9kZXZpY2Uoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2d2dCAqZ3Z0Owo+ICAg
CXN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1Owo+ICAgCWludCByZXQ7Cj4gICAKPiAtCWlmIChXQVJO
X09OKGRldl9wcml2LT5ndnQpKQo+ICsJaWYgKFdBUk5fT04oaTkxNS0+Z3Z0KSkKPiAgIAkJcmV0
dXJuIC1FRVhJU1Q7Cj4gICAKPiAgIAlndnQgPSBremFsbG9jKHNpemVvZihzdHJ1Y3QgaW50ZWxf
Z3Z0KSwgR0ZQX0tFUk5FTCk7Cj4gQEAgLTMxOSw3ICszMTksNyBAQCBpbnQgaW50ZWxfZ3Z0X2lu
aXRfZGV2aWNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAlzcGluX2xv
Y2tfaW5pdCgmZ3Z0LT5zY2hlZHVsZXIubW1pb19jb250ZXh0X2xvY2spOwo+ICAgCW11dGV4X2lu
aXQoJmd2dC0+bG9jayk7Cj4gICAJbXV0ZXhfaW5pdCgmZ3Z0LT5zY2hlZF9sb2NrKTsKPiAtCWd2
dC0+ZGV2X3ByaXYgPSBkZXZfcHJpdjsKPiArCWd2dC0+aTkxNSA9IGk5MTU7Cj4gICAKPiAgIAlp
bml0X2RldmljZV9pbmZvKGd2dCk7Cj4gICAKPiBAQCAtMzgwLDggKzM4MCw4IEBAIGludCBpbnRl
bF9ndnRfaW5pdF9kZXZpY2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAg
CQlndnRfZXJyKCJkZWJ1Z2ZzIHJlZ2lzdHJhdGlvbiBmYWlsZWQsIGdvIG9uLlxuIik7Cj4gICAK
PiAgIAlndnRfZGJnX2NvcmUoImd2dCBkZXZpY2UgaW5pdGlhbGl6YXRpb24gaXMgZG9uZVxuIik7
Cj4gLQlkZXZfcHJpdi0+Z3Z0ID0gZ3Z0Owo+IC0JaW50ZWxfZ3Z0X2hvc3QuZGV2ID0gJmRldl9w
cml2LT5kcm0ucGRldi0+ZGV2Owo+ICsJaTkxNS0+Z3Z0ID0gZ3Z0Owo+ICsJaW50ZWxfZ3Z0X2hv
c3QuZGV2ID0gJmk5MTUtPmRybS5wZGV2LT5kZXY7Cj4gICAJaW50ZWxfZ3Z0X2hvc3QuaW5pdGlh
bGl6ZWQgPSB0cnVlOwo+ICAgCXJldHVybiAwOwo+ICAgCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d2dC9ndnQuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9ndnQuaAo+
IGluZGV4IGI1NGYyYmRjMTNhNC4uZmJlYmUwYWU0MDk2IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d2dC9ndnQuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9n
dnQuaAo+IEBAIC0zMDYsNyArMzA2LDcgQEAgc3RydWN0IGludGVsX2d2dCB7Cj4gICAJLyogc2No
ZWR1bGVyIHNjb3BlIGxvY2ssIHByb3RlY3QgZ3Z0IGFuZCB2Z3B1IHNjaGVkdWxlIHJlbGF0ZWQg
ZGF0YSAqLwo+ICAgCXN0cnVjdCBtdXRleCBzY2hlZF9sb2NrOwo+ICAgCj4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NTsKPiAgIAlzdHJ1Y3QgaWRyIHZncHVfaWRyOwkvKiB2R1BVIElEUiBwb29sICovCj4gICAKPiAg
IAlzdHJ1Y3QgaW50ZWxfZ3Z0X2RldmljZV9pbmZvIGRldmljZV9pbmZvOwo+IEBAIC0zNzMsMTIg
KzM3MywxMiBAQCBpbnQgaW50ZWxfZ3Z0X2xvYWRfZmlybXdhcmUoc3RydWN0IGludGVsX2d2dCAq
Z3Z0KTsKPiAgICNkZWZpbmUgSE9TVF9GRU5DRSA0Cj4gICAKPiAgIC8qIEFwZXJ0dXJlL0dNIHNw
YWNlIGRlZmluaXRpb25zIGZvciBHVlQgZGV2aWNlICovCj4gLSNkZWZpbmUgZ3Z0X2FwZXJ0dXJl
X3N6KGd2dCkJICAoZ3Z0LT5kZXZfcHJpdi0+Z2d0dC5tYXBwYWJsZV9lbmQpCj4gLSNkZWZpbmUg
Z3Z0X2FwZXJ0dXJlX3BhX2Jhc2UoZ3Z0KSAoZ3Z0LT5kZXZfcHJpdi0+Z2d0dC5nbWFkci5zdGFy
dCkKPiArI2RlZmluZSBndnRfYXBlcnR1cmVfc3ooZ3Z0KQkgIChndnQtPmk5MTUtPmdndHQubWFw
cGFibGVfZW5kKQo+ICsjZGVmaW5lIGd2dF9hcGVydHVyZV9wYV9iYXNlKGd2dCkgKGd2dC0+aTkx
NS0+Z2d0dC5nbWFkci5zdGFydCkKPiAgIAo+IC0jZGVmaW5lIGd2dF9nZ3R0X2dtX3N6KGd2dCkJ
ICAoZ3Z0LT5kZXZfcHJpdi0+Z2d0dC52bS50b3RhbCkKPiArI2RlZmluZSBndnRfZ2d0dF9nbV9z
eihndnQpCSAgKGd2dC0+aTkxNS0+Z2d0dC52bS50b3RhbCkKPiAgICNkZWZpbmUgZ3Z0X2dndHRf
c3ooZ3Z0KSBcCj4gLQkoKGd2dC0+ZGV2X3ByaXYtPmdndHQudm0udG90YWwgPj4gUEFHRV9TSElG
VCkgPDwgMykKPiArCSgoZ3Z0LT5pOTE1LT5nZ3R0LnZtLnRvdGFsID4+IFBBR0VfU0hJRlQpIDw8
IDMpCj4gICAjZGVmaW5lIGd2dF9oaWRkZW5fc3ooZ3Z0KQkgIChndnRfZ2d0dF9nbV9zeihndnQp
IC0gZ3Z0X2FwZXJ0dXJlX3N6KGd2dCkpCj4gICAKPiAgICNkZWZpbmUgZ3Z0X2FwZXJ0dXJlX2dt
YWRyX2Jhc2UoZ3Z0KSAoMCkKPiBAQCAtMzkwLDcgKzM5MCw3IEBAIGludCBpbnRlbF9ndnRfbG9h
ZF9maXJtd2FyZShzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQpOwo+ICAgI2RlZmluZSBndnRfaGlkZGVu
X2dtYWRyX2VuZChndnQpIChndnRfaGlkZGVuX2dtYWRyX2Jhc2UoZ3Z0KSBcCj4gICAJCQkJICAg
KyBndnRfaGlkZGVuX3N6KGd2dCkgLSAxKQo+ICAgCj4gLSNkZWZpbmUgZ3Z0X2ZlbmNlX3N6KGd2
dCkgKGd2dC0+ZGV2X3ByaXYtPm51bV9mZW5jZV9yZWdzKQo+ICsjZGVmaW5lIGd2dF9mZW5jZV9z
eihndnQpIChndnQtPmk5MTUtPm51bV9mZW5jZV9yZWdzKQo+ICAgCj4gICAvKiBBcGVydHVyZS9H
TSBzcGFjZSBkZWZpbml0aW9ucyBmb3IgdkdQVSAqLwo+ICAgI2RlZmluZSB2Z3B1X2FwZXJ0dXJl
X29mZnNldCh2Z3B1KQkoKHZncHUpLT5nbS5sb3dfZ21fbm9kZS5zdGFydCkKPiBAQCAtNTgyLDE0
ICs1ODIsMTQgQEAgZW51bSB7Cj4gICAJR1ZUX0ZBSUxTQUZFX0dVRVNUX0VSUiwKPiAgIH07Cj4g
ICAKPiAtc3RhdGljIGlubGluZSB2b2lkIG1taW9faHdfYWNjZXNzX3ByZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyBpbmxpbmUgdm9pZCBtbWlvX2h3X2FjY2Vz
c19wcmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlpbnRlbF9ydW50
aW1lX3BtX2dldChkZXZfcHJpdik7Cj4gKwlpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKPiAg
IH0KPiAgIAo+IC1zdGF0aWMgaW5saW5lIHZvaWQgbW1pb19od19hY2Nlc3NfcG9zdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyBpbmxpbmUgdm9pZCBtbWlvX2h3
X2FjY2Vzc19wb3N0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JaW50
ZWxfcnVudGltZV9wbV9wdXRfdW5jaGVja2VkKGRldl9wcml2KTsKPiArCWludGVsX3J1bnRpbWVf
cG1fcHV0X3VuY2hlY2tlZChpOTE1KTsKPiAgIH0KPiAgIAo+ICAgLyoqCj4gZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9oYW5kbGVycy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Z0L2hhbmRsZXJzLmMKPiBpbmRleCBhNmFkZTY2MzQ5YmQuLjlhY2IwMWIwYjdjNyAxMDA2
NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvaGFuZGxlcnMuYwo+ICsrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9oYW5kbGVycy5jCj4gQEAgLTQ5LDE1ICs0OSwxNSBAQAo+
ICAgCj4gICB1bnNpZ25lZCBsb25nIGludGVsX2d2dF9nZXRfZGV2aWNlX3R5cGUoc3RydWN0IGlu
dGVsX2d2dCAqZ3Z0KQo+ICAgewo+IC0JaWYgKElTX0JST0FEV0VMTChndnQtPmRldl9wcml2KSkK
PiArCWlmIChJU19CUk9BRFdFTEwoZ3Z0LT5pOTE1KSkKPiAgIAkJcmV0dXJuIERfQkRXOwo+IC0J
ZWxzZSBpZiAoSVNfU0tZTEFLRShndnQtPmRldl9wcml2KSkKPiArCWVsc2UgaWYgKElTX1NLWUxB
S0UoZ3Z0LT5pOTE1KSkKPiAgIAkJcmV0dXJuIERfU0tMOwo+IC0JZWxzZSBpZiAoSVNfS0FCWUxB
S0UoZ3Z0LT5kZXZfcHJpdikpCj4gKwllbHNlIGlmIChJU19LQUJZTEFLRShndnQtPmk5MTUpKQo+
ICAgCQlyZXR1cm4gRF9LQkw7Cj4gLQllbHNlIGlmIChJU19CUk9YVE9OKGd2dC0+ZGV2X3ByaXYp
KQo+ICsJZWxzZSBpZiAoSVNfQlJPWFRPTihndnQtPmk5MTUpKQo+ICAgCQlyZXR1cm4gRF9CWFQ7
Cj4gLQllbHNlIGlmIChJU19DT0ZGRUVMQUtFKGd2dC0+ZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAo
SVNfQ09GRkVFTEFLRShndnQtPmk5MTUpKQo+ICAgCQlyZXR1cm4gRF9DRkw7Cj4gICAKPiAgIAly
ZXR1cm4gMDsKPiBAQCAtMTU2LDcgKzE1Niw3IEBAIGludCBpbnRlbF9ndnRfcmVuZGVyX21taW9f
dG9fcmluZ19pZChzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQsCj4gICAJc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lOwo+ICAgCj4gICAJb2Zmc2V0ICY9IH5HRU5NQVNLKDExLCAwKTsKPiAtCWZv
cl9lYWNoX2VuZ2luZShlbmdpbmUsIGd2dC0+ZGV2X3ByaXYsIGlkKSB7Cj4gKwlmb3JfZWFjaF9l
bmdpbmUoZW5naW5lLCBndnQtPmk5MTUsIGlkKSB7Cj4gICAJCWlmIChlbmdpbmUtPm1taW9fYmFz
ZSA9PSBvZmZzZXQpCj4gICAJCQlyZXR1cm4gaWQ7Cj4gICAJfQo+IEBAIC0yMTcsNyArMjE3LDcg
QEAgc3RhdGljIGludCBnYW13X2VjaG9fZGV2X3J3X2lhX3dyaXRlKHN0cnVjdCBpbnRlbF92Z3B1
ICp2Z3B1LAo+ICAgewo+ICAgCXUzMiBpcHMgPSAoKih1MzIgKilwX2RhdGEpICYgR0FNV19FQ09f
RU5BQkxFXzY0S19JUFNfRklFTEQ7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4odmdwdS0+Z3Z0LT5k
ZXZfcHJpdikgPD0gMTApIHsKPiArCWlmIChJTlRFTF9HRU4odmdwdS0+Z3Z0LT5pOTE1KSA8PSAx
MCkgewo+ICAgCQlpZiAoaXBzID09IEdBTVdfRUNPX0VOQUJMRV82NEtfSVBTX0ZJRUxEKQo+ICAg
CQkJZ3Z0X2RiZ19jb3JlKCJ2Z3B1JWQ6IGlwcyBlbmFibGVkXG4iLCB2Z3B1LT5pZCk7Cj4gICAJ
CWVsc2UgaWYgKCFpcHMpCj4gQEAgLTI1Myw3ICsyNTMsNyBAQCBzdGF0aWMgaW50IGZlbmNlX21t
aW9fcmVhZChzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwgdW5zaWduZWQgaW50IG9mZiwKPiAgIHN0
YXRpYyBpbnQgZmVuY2VfbW1pb193cml0ZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwgdW5zaWdu
ZWQgaW50IG9mZiwKPiAgIAkJdm9pZCAqcF9kYXRhLCB1bnNpZ25lZCBpbnQgYnl0ZXMpCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2Z3B1LT5ndnQtPmRldl9w
cml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2Z3B1LT5ndnQtPmk5MTU7
Cj4gICAJdW5zaWduZWQgaW50IGZlbmNlX251bSA9IG9mZnNldF90b19mZW5jZV9udW0ob2ZmKTsK
PiAgIAlpbnQgcmV0Owo+ICAgCj4gQEAgLTI2MiwxMCArMjYyLDEwIEBAIHN0YXRpYyBpbnQgZmVu
Y2VfbW1pb193cml0ZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwgdW5zaWduZWQgaW50IG9mZiwK
PiAgIAkJcmV0dXJuIHJldDsKPiAgIAl3cml0ZV92cmVnKHZncHUsIG9mZiwgcF9kYXRhLCBieXRl
cyk7Cj4gICAKPiAtCW1taW9faHdfYWNjZXNzX3ByZShkZXZfcHJpdik7Cj4gKwltbWlvX2h3X2Fj
Y2Vzc19wcmUoaTkxNSk7Cj4gICAJaW50ZWxfdmdwdV93cml0ZV9mZW5jZSh2Z3B1LCBmZW5jZV9u
dW0sCj4gICAJCQl2Z3B1X3ZyZWc2NCh2Z3B1LCBmZW5jZV9udW1fdG9fb2Zmc2V0KGZlbmNlX251
bSkpKTsKPiAtCW1taW9faHdfYWNjZXNzX3Bvc3QoZGV2X3ByaXYpOwo+ICsJbW1pb19od19hY2Nl
c3NfcG9zdChpOTE1KTsKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+IEBAIC0yODMsNyArMjgz
LDcgQEAgc3RhdGljIGludCBtdWxfZm9yY2Vfd2FrZV93cml0ZShzdHJ1Y3QgaW50ZWxfdmdwdSAq
dmdwdSwKPiAgIAlvbGQgPSB2Z3B1X3ZyZWcodmdwdSwgb2Zmc2V0KTsKPiAgIAluZXcgPSBDQUxD
X01PREVfTUFTS19SRUcob2xkLCAqKHUzMiAqKXBfZGF0YSk7Cj4gICAKPiAtCWlmIChJTlRFTF9H
RU4odmdwdS0+Z3Z0LT5kZXZfcHJpdikgID49ICA5KSB7Cj4gKwlpZiAoSU5URUxfR0VOKHZncHUt
Pmd2dC0+aTkxNSkgID49ICA5KSB7Cj4gICAJCXN3aXRjaCAob2Zmc2V0KSB7Cj4gICAJCWNhc2Ug
Rk9SQ0VXQUtFX1JFTkRFUl9HRU45X1JFRzoKPiAgIAkJCWFja19yZWdfb2Zmc2V0ID0gRk9SQ0VX
QUtFX0FDS19SRU5ERVJfR0VOOV9SRUc7Cj4gQEAgLTM0MSw3ICszNDEsNyBAQCBzdGF0aWMgaW50
IGdkcnN0X21taW9fd3JpdGUoc3RydWN0IGludGVsX3ZncHUgKnZncHUsIHVuc2lnbmVkIGludCBv
ZmZzZXQsCj4gICAJCQlndnRfZGJnX21taW8oInZncHUlZDogcmVxdWVzdCBWQ1MyIFJlc2V0XG4i
LCB2Z3B1LT5pZCk7Cj4gICAJCQllbmdpbmVfbWFzayB8PSBCSVQoVkNTMSk7Cj4gICAJCX0KPiAt
CQllbmdpbmVfbWFzayAmPSBJTlRFTF9JTkZPKHZncHUtPmd2dC0+ZGV2X3ByaXYpLT5lbmdpbmVf
bWFzazsKPiArCQllbmdpbmVfbWFzayAmPSBJTlRFTF9JTkZPKHZncHUtPmd2dC0+aTkxNSktPmVu
Z2luZV9tYXNrOwo+ICAgCX0KPiAgIAo+ICAgCS8qIHZncHVfbG9jayBhbHJlYWR5IGhvbGQgYnkg
ZW11bGF0ZSBtbWlvIHIvdyAqLwo+IEBAIC01MTEsNyArNTExLDcgQEAgc3RhdGljIGludCBmb3Jj
ZV9ub25wcml2X3dyaXRlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LAo+ICAgCXUzMiByZWdfbm9u
cHJpdiA9ICoodTMyICopcF9kYXRhOwo+ICAgCWludCByaW5nX2lkID0gaW50ZWxfZ3Z0X3JlbmRl
cl9tbWlvX3RvX3JpbmdfaWQodmdwdS0+Z3Z0LCBvZmZzZXQpOwo+ICAgCXUzMiByaW5nX2Jhc2U7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2Z3B1LT5ndnQtPmRldl9w
cml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2Z3B1LT5ndnQtPmk5MTU7
Cj4gICAJaW50IHJldCA9IC1FSU5WQUw7Cj4gICAKPiAgIAlpZiAoKGJ5dGVzICE9IDQpIHx8ICgo
b2Zmc2V0ICYgKGJ5dGVzIC0gMSkpICE9IDApIHx8IHJpbmdfaWQgPCAwKSB7Cj4gQEAgLTUyMCw3
ICs1MjAsNyBAQCBzdGF0aWMgaW50IGZvcmNlX25vbnByaXZfd3JpdGUoc3RydWN0IGludGVsX3Zn
cHUgKnZncHUsCj4gICAJCXJldHVybiByZXQ7Cj4gICAJfQo+ICAgCj4gLQlyaW5nX2Jhc2UgPSBk
ZXZfcHJpdi0+ZW5naW5lW3JpbmdfaWRdLT5tbWlvX2Jhc2U7Cj4gKwlyaW5nX2Jhc2UgPSBpOTE1
LT5lbmdpbmVbcmluZ19pZF0tPm1taW9fYmFzZTsKPiAgIAo+ICAgCWlmIChpbl93aGl0ZWxpc3Qo
cmVnX25vbnByaXYpIHx8Cj4gICAJCXJlZ19ub25wcml2ID09IGk5MTVfbW1pb19yZWdfb2Zmc2V0
KFJJTkdfTk9QSUQocmluZ19iYXNlKSkpIHsKPiBAQCAtNzUxLDcgKzc1MSw3IEBAIHN0YXRpYyBp
bnQgc291dGhfY2hpY2tlbjJfbW1pb193cml0ZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwKPiAg
IHN0YXRpYyBpbnQgcHJpX3N1cmZfbW1pb193cml0ZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwg
dW5zaWduZWQgaW50IG9mZnNldCwKPiAgIAkJdm9pZCAqcF9kYXRhLCB1bnNpZ25lZCBpbnQgYnl0
ZXMpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2Z3B1LT5n
dnQtPmRldl9wcml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2Z3B1LT5n
dnQtPmk5MTU7Cj4gICAJdTMyIHBpcGUgPSBEU1BTVVJGX1RPX1BJUEUob2Zmc2V0KTsKPiAgIAlp
bnQgZXZlbnQgPSBTS0xfRkxJUF9FVkVOVChwaXBlLCBQTEFORV9QUklNQVJZKTsKPiAgIAo+IEBA
IC03OTIsNyArNzkyLDcgQEAgc3RhdGljIGludCByZWc1MDA4MF9tbWlvX3dyaXRlKHN0cnVjdCBp
bnRlbF92Z3B1ICp2Z3B1LAo+ICAgCQkJICAgICAgIHVuc2lnbmVkIGludCBvZmZzZXQsIHZvaWQg
KnBfZGF0YSwKPiAgIAkJCSAgICAgICB1bnNpZ25lZCBpbnQgYnl0ZXMpCj4gICB7Cj4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2Z3B1LT5ndnQtPmRldl9wcml2Owo+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2Z3B1LT5ndnQtPmk5MTU7Cj4gICAJZW51
bSBwaXBlIHBpcGUgPSBSRUdfNTAwODBfVE9fUElQRShvZmZzZXQpOwo+ICAgCWVudW0gcGxhbmVf
aWQgcGxhbmUgPSBSRUdfNTAwODBfVE9fUExBTkUob2Zmc2V0KTsKPiAgIAlpbnQgZXZlbnQgPSBT
S0xfRkxJUF9FVkVOVChwaXBlLCBwbGFuZSk7Cj4gQEAgLTgxNiw3ICs4MTYsNyBAQCBzdGF0aWMg
aW50IHJlZzUwMDgwX21taW9fd3JpdGUoc3RydWN0IGludGVsX3ZncHUgKnZncHUsCj4gICBzdGF0
aWMgaW50IHRyaWdnZXJfYXV4X2NoYW5uZWxfaW50ZXJydXB0KHN0cnVjdCBpbnRlbF92Z3B1ICp2
Z3B1LAo+ICAgCQl1bnNpZ25lZCBpbnQgcmVnKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdmdwdS0+Z3Z0LT5pOTE1Owo+ICAgCWVudW0gaW50ZWxfZ3Z0X2V2
ZW50X3R5cGUgZXZlbnQ7Cj4gICAKPiAgIAlpZiAocmVnID09IF9EUEFfQVVYX0NIX0NUTCkKPiBA
QCAtOTE2LDExICs5MTYsMTEgQEAgc3RhdGljIGludCBkcF9hdXhfY2hfY3RsX21taW9fd3JpdGUo
c3RydWN0IGludGVsX3ZncHUgKnZncHUsCj4gICAJd3JpdGVfdnJlZyh2Z3B1LCBvZmZzZXQsIHBf
ZGF0YSwgYnl0ZXMpOwo+ICAgCWRhdGEgPSB2Z3B1X3ZyZWcodmdwdSwgb2Zmc2V0KTsKPiAgIAo+
IC0JaWYgKChJTlRFTF9HRU4odmdwdS0+Z3Z0LT5kZXZfcHJpdikgPj0gOSkKPiArCWlmICgoSU5U
RUxfR0VOKHZncHUtPmd2dC0+aTkxNSkgPj0gOSkKPiAgIAkJJiYgb2Zmc2V0ICE9IF9SRUdfU0tM
X0RQX0FVWF9DSF9DVEwocG9ydF9pbmRleCkpIHsKPiAgIAkJLyogU0tMIERQQi9DL0QgYXV4IGN0
bCByZWdpc3RlciBjaGFuZ2VkICovCj4gICAJCXJldHVybiAwOwo+IC0JfSBlbHNlIGlmIChJU19C
Uk9BRFdFTEwodmdwdS0+Z3Z0LT5kZXZfcHJpdikgJiYKPiArCX0gZWxzZSBpZiAoSVNfQlJPQURX
RUxMKHZncHUtPmd2dC0+aTkxNSkgJiYKPiAgIAkJICAgb2Zmc2V0ICE9IF9SRUdfSFNXX0RQX0FV
WF9DSF9DVEwocG9ydF9pbmRleCkpIHsKPiAgIAkJLyogd3JpdGUgdG8gdGhlIGRhdGEgcmVnaXN0
ZXJzICovCj4gICAJCXJldHVybiAwOwo+IEBAIC0xMjM2LDggKzEyMzYsOCBAQCBzdGF0aWMgaW50
IGhhbmRsZV9nMnZfbm90aWZpY2F0aW9uKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCBpbnQgbm90
aWZpY2F0aW9uKQo+ICAgCj4gICBzdGF0aWMgaW50IHNlbmRfZGlzcGxheV9yZWFkeV91ZXZlbnQo
c3RydWN0IGludGVsX3ZncHUgKnZncHUsIGludCByZWFkeSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHZncHUtPmd2dC0+ZGV2X3ByaXY7Cj4gLQlzdHJ1Y3Qg
a29iamVjdCAqa29iaiA9ICZkZXZfcHJpdi0+ZHJtLnByaW1hcnktPmtkZXYtPmtvYmo7Cj4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHZncHUtPmd2dC0+aTkxNTsKPiArCXN0cnVj
dCBrb2JqZWN0ICprb2JqID0gJmk5MTUtPmRybS5wcmltYXJ5LT5rZGV2LT5rb2JqOwo+ICAgCWNo
YXIgKmVudlszXSA9IHtOVUxMLCBOVUxMLCBOVUxMfTsKPiAgIAljaGFyIHZtaWRfc3RyWzIwXTsK
PiAgIAljaGFyIGRpc3BsYXlfcmVhZHlfc3RyWzIwXTsKPiBAQCAtMTQxNiw5ICsxNDE2LDkgQEAg
c3RhdGljIGludCBtYWlsYm94X3dyaXRlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCB1bnNpZ25l
ZCBpbnQgb2Zmc2V0LAo+ICAgCj4gICAJc3dpdGNoIChjbWQpIHsKPiAgIAljYXNlIEdFTjlfUENP
REVfUkVBRF9NRU1fTEFURU5DWToKPiAtCQlpZiAoSVNfU0tZTEFLRSh2Z3B1LT5ndnQtPmRldl9w
cml2KQo+IC0JCQkgfHwgSVNfS0FCWUxBS0UodmdwdS0+Z3Z0LT5kZXZfcHJpdikKPiAtCQkJIHx8
IElTX0NPRkZFRUxBS0UodmdwdS0+Z3Z0LT5kZXZfcHJpdikpIHsKPiArCQlpZiAoSVNfU0tZTEFL
RSh2Z3B1LT5ndnQtPmk5MTUpCj4gKwkJCSB8fCBJU19LQUJZTEFLRSh2Z3B1LT5ndnQtPmk5MTUp
Cj4gKwkJCSB8fCBJU19DT0ZGRUVMQUtFKHZncHUtPmd2dC0+aTkxNSkpIHsKPiAgIAkJCS8qKgo+
ICAgCQkJICogIlJlYWQgbWVtb3J5IGxhdGVuY3kiIGNvbW1hbmQgb24gZ2VuOS4KPiAgIAkJCSAq
IEJlbG93IG1lbW9yeSBsYXRlbmN5IHZhbHVlcyBhcmUgcmVhZAo+IEBAIC0xNDI4LDcgKzE0Mjgs
NyBAQCBzdGF0aWMgaW50IG1haWxib3hfd3JpdGUoc3RydWN0IGludGVsX3ZncHUgKnZncHUsIHVu
c2lnbmVkIGludCBvZmZzZXQsCj4gICAJCQkJKmRhdGEwID0gMHgxZTFhMTEwMDsKPiAgIAkJCWVs
c2UKPiAgIAkJCQkqZGF0YTAgPSAweDYxNTE0YjNkOwo+IC0JCX0gZWxzZSBpZiAoSVNfQlJPWFRP
Tih2Z3B1LT5ndnQtPmRldl9wcml2KSkgewo+ICsJCX0gZWxzZSBpZiAoSVNfQlJPWFRPTih2Z3B1
LT5ndnQtPmk5MTUpKSB7Cj4gICAJCQkvKioKPiAgIAkJCSAqICJSZWFkIG1lbW9yeSBsYXRlbmN5
IiBjb21tYW5kIG9uIGdlbjkuCj4gICAJCQkgKiBCZWxvdyBtZW1vcnkgbGF0ZW5jeSB2YWx1ZXMg
YXJlIHJlYWQKPiBAQCAtMTQ0MSw5ICsxNDQxLDkgQEAgc3RhdGljIGludCBtYWlsYm94X3dyaXRl
KHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCB1bnNpZ25lZCBpbnQgb2Zmc2V0LAo+ICAgCQl9Cj4g
ICAJCWJyZWFrOwo+ICAgCWNhc2UgU0tMX1BDT0RFX0NEQ0xLX0NPTlRST0w6Cj4gLQkJaWYgKElT
X1NLWUxBS0UodmdwdS0+Z3Z0LT5kZXZfcHJpdikKPiAtCQkJIHx8IElTX0tBQllMQUtFKHZncHUt
Pmd2dC0+ZGV2X3ByaXYpCj4gLQkJCSB8fCBJU19DT0ZGRUVMQUtFKHZncHUtPmd2dC0+ZGV2X3By
aXYpKQo+ICsJCWlmIChJU19TS1lMQUtFKHZncHUtPmd2dC0+aTkxNSkKPiArCQkJIHx8IElTX0tB
QllMQUtFKHZncHUtPmd2dC0+aTkxNSkKPiArCQkJIHx8IElTX0NPRkZFRUxBS0UodmdwdS0+Z3Z0
LT5pOTE1KSkKPiAgIAkJCSpkYXRhMCA9IFNLTF9DRENMS19SRUFEWV9GT1JfQ0hBTkdFOwo+ICAg
CQlicmVhazsKPiAgIAljYXNlIEdFTjZfUENPREVfUkVBRF9SQzZWSURTOgo+IEBAIC0xNDk2LDcg
KzE0OTYsNyBAQCBzdGF0aWMgaW50IHNrbF9wb3dlcl93ZWxsX2N0bF93cml0ZShzdHJ1Y3QgaW50
ZWxfdmdwdSAqdmdwdSwKPiAgIHsKPiAgIAl1MzIgdiA9ICoodTMyICopcF9kYXRhOwo+ICAgCj4g
LQlpZiAoSVNfQlJPWFRPTih2Z3B1LT5ndnQtPmRldl9wcml2KSkKPiArCWlmIChJU19CUk9YVE9O
KHZncHUtPmd2dC0+aTkxNSkpCj4gICAJCXYgJj0gKDEgPDwgMzEpIHwgKDEgPDwgMjkpOwo+ICAg
CWVsc2UKPiAgIAkJdiAmPSAoMSA8PCAzMSkgfCAoMSA8PCAyOSkgfCAoMSA8PCA5KSB8Cj4gQEAg
LTE2MzMsNyArMTYzMyw3IEBAIHN0YXRpYyBpbnQgbW1pb19yZWFkX2Zyb21faHcoc3RydWN0IGlu
dGVsX3ZncHUgKnZncHUsCj4gICAJCXVuc2lnbmVkIGludCBvZmZzZXQsIHZvaWQgKnBfZGF0YSwg
dW5zaWduZWQgaW50IGJ5dGVzKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9ndnQgKmd2dCA9IHZn
cHUtPmd2dDsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGd2dC0+ZGV2
X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd2dC0+aTkxNTsKPiAg
IAlpbnQgcmluZ19pZDsKPiAgIAl1MzIgcmluZ19iYXNlOwo+ICAgCj4gQEAgLTE2NDUsMTQgKzE2
NDUsMTQgQEAgc3RhdGljIGludCBtbWlvX3JlYWRfZnJvbV9odyhzdHJ1Y3QgaW50ZWxfdmdwdSAq
dmdwdSwKPiAgIAkgKiBjLiB0aGUgb2Zmc2V0IGlzIHJpbmcgdGltZSBzdGFtcCBtbWlvCj4gICAJ
ICovCj4gICAJaWYgKHJpbmdfaWQgPj0gMCkKPiAtCQlyaW5nX2Jhc2UgPSBkZXZfcHJpdi0+ZW5n
aW5lW3JpbmdfaWRdLT5tbWlvX2Jhc2U7Cj4gKwkJcmluZ19iYXNlID0gaTkxNS0+ZW5naW5lW3Jp
bmdfaWRdLT5tbWlvX2Jhc2U7Cj4gICAKPiAgIAlpZiAocmluZ19pZCA8IDAgfHwgdmdwdSAgPT0g
Z3Z0LT5zY2hlZHVsZXIuZW5naW5lX293bmVyW3JpbmdfaWRdIHx8Cj4gICAJICAgIG9mZnNldCA9
PSBpOTE1X21taW9fcmVnX29mZnNldChSSU5HX1RJTUVTVEFNUChyaW5nX2Jhc2UpKSB8fAo+ICAg
CSAgICBvZmZzZXQgPT0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19USU1FU1RBTVBfVURXKHJp
bmdfYmFzZSkpKSB7Cj4gLQkJbW1pb19od19hY2Nlc3NfcHJlKGRldl9wcml2KTsKPiArCQltbWlv
X2h3X2FjY2Vzc19wcmUoaTkxNSk7Cj4gICAJCXZncHVfdnJlZyh2Z3B1LCBvZmZzZXQpID0gSTkx
NV9SRUFEKF9NTUlPKG9mZnNldCkpOwo+IC0JCW1taW9faHdfYWNjZXNzX3Bvc3QoZGV2X3ByaXYp
Owo+ICsJCW1taW9faHdfYWNjZXNzX3Bvc3QoaTkxNSk7Cj4gICAJfQo+ICAgCj4gICAJcmV0dXJu
IGludGVsX3ZncHVfZGVmYXVsdF9tbWlvX3JlYWQodmdwdSwgb2Zmc2V0LCBwX2RhdGEsIGJ5dGVz
KTsKPiBAQCAtMTY5Myw3ICsxNjkzLDcgQEAgc3RhdGljIGludCByaW5nX21vZGVfbW1pb193cml0
ZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwgdW5zaWduZWQgaW50IG9mZnNldCwKPiAgIAlpbnQg
cmV0Owo+ICAgCj4gICAJKCoodTMyICopcF9kYXRhKSAmPSB+X01BU0tFRF9CSVRfRU5BQkxFKDEp
Owo+IC0JaWYgKElTX0NPRkZFRUxBS0UodmdwdS0+Z3Z0LT5kZXZfcHJpdikpCj4gKwlpZiAoSVNf
Q09GRkVFTEFLRSh2Z3B1LT5ndnQtPmk5MTUpKQo+ICAgCQkoKih1MzIgKilwX2RhdGEpICY9IH5f
TUFTS0VEX0JJVF9FTkFCTEUoMik7Cj4gICAJd3JpdGVfdnJlZyh2Z3B1LCBvZmZzZXQsIHBfZGF0
YSwgYnl0ZXMpOwo+ICAgCj4gQEAgLTE3MDIsNyArMTcwMiw3IEBAIHN0YXRpYyBpbnQgcmluZ19t
b2RlX21taW9fd3JpdGUoc3RydWN0IGludGVsX3ZncHUgKnZncHUsIHVuc2lnbmVkIGludCBvZmZz
ZXQsCj4gICAJCXJldHVybiAwOwo+ICAgCX0KPiAgIAo+IC0JaWYgKElTX0NPRkZFRUxBS0Uodmdw
dS0+Z3Z0LT5kZXZfcHJpdikgJiYKPiArCWlmIChJU19DT0ZGRUVMQUtFKHZncHUtPmd2dC0+aTkx
NSkgJiYKPiAgIAkgICAgZGF0YSAmIF9NQVNLRURfQklUX0VOQUJMRSgyKSkgewo+ICAgCQllbnRl
cl9mYWlsc2FmZV9tb2RlKHZncHUsIEdWVF9GQUlMU0FGRV9VTlNVUFBPUlRFRF9HVUVTVCk7Cj4g
ICAJCXJldHVybiAwOwo+IEBAIC0xODM0LDcgKzE4MzQsNyBAQCBzdGF0aWMgaW50IGNzZmVfY2hp
Y2tlbjFfbW1pb193cml0ZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwKPiAgIAlNTUlPX0YocHJl
Zml4KEJMVF9SSU5HX0JBU0UpLCBzLCBmLCBhbSwgcm0sIGQsIHIsIHcpOyBcCj4gICAJTU1JT19G
KHByZWZpeChHRU42X0JTRF9SSU5HX0JBU0UpLCBzLCBmLCBhbSwgcm0sIGQsIHIsIHcpOyBcCj4g
ICAJTU1JT19GKHByZWZpeChWRUJPWF9SSU5HX0JBU0UpLCBzLCBmLCBhbSwgcm0sIGQsIHIsIHcp
OyBcCj4gLQlpZiAoSEFTX0VOR0lORShkZXZfcHJpdiwgVkNTMSkpIFwKPiArCWlmIChIQVNfRU5H
SU5FKGk5MTUsIFZDUzEpKSBcCj4gICAJCU1NSU9fRihwcmVmaXgoR0VOOF9CU0QyX1JJTkdfQkFT
RSksIHMsIGYsIGFtLCBybSwgZCwgciwgdyk7IFwKPiAgIH0gd2hpbGUgKDApCj4gICAKPiBAQCAt
MTg1NSw3ICsxODU1LDcgQEAgc3RhdGljIGludCBjc2ZlX2NoaWNrZW4xX21taW9fd3JpdGUoc3Ry
dWN0IGludGVsX3ZncHUgKnZncHUsCj4gICAKPiAgIHN0YXRpYyBpbnQgaW5pdF9nZW5lcmljX21t
aW9faW5mbyhzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSBndnQtPmRldl9wcml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSBndnQtPmk5MTU7Cj4gICAJaW50IHJldDsKPiAgIAo+ICAgCU1NSU9fUklO
R19ERkgoUklOR19JTVIsIERfQUxMLCBGX0NNRF9BQ0NFU1MsIE5VTEwsCj4gQEAgLTI2NzAsNyAr
MjY3MCw3IEBAIHN0YXRpYyBpbnQgaW5pdF9nZW5lcmljX21taW9faW5mbyhzdHJ1Y3QgaW50ZWxf
Z3Z0ICpndnQpCj4gICAKPiAgIHN0YXRpYyBpbnQgaW5pdF9icm9hZHdlbGxfbW1pb19pbmZvKHN0
cnVjdCBpbnRlbF9ndnQgKmd2dCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IGd2dC0+ZGV2X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IGd2dC0+aTkxNTsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gICAJTU1JT19ESChHRU44X0dUX0lN
UigwKSwgRF9CRFdfUExVUywgTlVMTCwgaW50ZWxfdmdwdV9yZWdfaW1yX2hhbmRsZXIpOwo+IEBA
IC0yODU5LDcgKzI4NTksNyBAQCBzdGF0aWMgaW50IGluaXRfYnJvYWR3ZWxsX21taW9faW5mbyhz
dHJ1Y3QgaW50ZWxfZ3Z0ICpndnQpCj4gICAKPiAgIHN0YXRpYyBpbnQgaW5pdF9za2xfbW1pb19p
bmZvKHN0cnVjdCBpbnRlbF9ndnQgKmd2dCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IGd2dC0+ZGV2X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IGd2dC0+aTkxNTsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gICAJTU1JT19ESChGT1JD
RVdBS0VfUkVOREVSX0dFTjksIERfU0tMX1BMVVMsIE5VTEwsIG11bF9mb3JjZV93YWtlX3dyaXRl
KTsKPiBAQCAtMzEwOCw3ICszMTA4LDcgQEAgc3RhdGljIGludCBpbml0X3NrbF9tbWlvX2luZm8o
c3RydWN0IGludGVsX2d2dCAqZ3Z0KQo+ICAgCj4gICBzdGF0aWMgaW50IGluaXRfYnh0X21taW9f
aW5mbyhzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSBndnQtPmRldl9wcml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSBndnQtPmk5MTU7Cj4gICAJaW50IHJldDsKPiAgIAo+ICAgCU1NSU9fRihfTU1J
TygweDgwMDAwKSwgMHgzMDAwLCAwLCAwLCAwLCBEX0JYVCwgTlVMTCwgTlVMTCk7Cj4gQEAgLTMz
NDQsNyArMzM0NCw3IEBAIHN0YXRpYyBzdHJ1Y3QgZ3Z0X21taW9fYmxvY2sgbW1pb19ibG9ja3Nb
XSA9IHsKPiAgIGludCBpbnRlbF9ndnRfc2V0dXBfbW1pb19pbmZvKHN0cnVjdCBpbnRlbF9ndnQg
Kmd2dCkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZ3Z0X2RldmljZV9pbmZvICppbmZvID0gJmd2
dC0+ZGV2aWNlX2luZm87Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBn
dnQtPmRldl9wcml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndnQtPmk5
MTU7Cj4gICAJaW50IHNpemUgPSBpbmZvLT5tbWlvX3NpemUgLyA0ICogc2l6ZW9mKCpndnQtPm1t
aW8ubW1pb19hdHRyaWJ1dGUpOwo+ICAgCWludCByZXQ7Cj4gICAKPiBAQCAtMzM1NiwyMCArMzM1
NiwyMCBAQCBpbnQgaW50ZWxfZ3Z0X3NldHVwX21taW9faW5mbyhzdHJ1Y3QgaW50ZWxfZ3Z0ICpn
dnQpCj4gICAJaWYgKHJldCkKPiAgIAkJZ290byBlcnI7Cj4gICAKPiAtCWlmIChJU19CUk9BRFdF
TEwoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfQlJPQURXRUxMKGk5MTUpKSB7Cj4gICAJCXJldCA9
IGluaXRfYnJvYWR3ZWxsX21taW9faW5mbyhndnQpOwo+ICAgCQlpZiAocmV0KQo+ICAgCQkJZ290
byBlcnI7Cj4gLQl9IGVsc2UgaWYgKElTX1NLWUxBS0UoZGV2X3ByaXYpCj4gLQkJfHwgSVNfS0FC
WUxBS0UoZGV2X3ByaXYpCj4gLQkJfHwgSVNfQ09GRkVFTEFLRShkZXZfcHJpdikpIHsKPiArCX0g
ZWxzZSBpZiAoSVNfU0tZTEFLRShpOTE1KQo+ICsJCXx8IElTX0tBQllMQUtFKGk5MTUpCj4gKwkJ
fHwgSVNfQ09GRkVFTEFLRShpOTE1KSkgewo+ICAgCQlyZXQgPSBpbml0X2Jyb2Fkd2VsbF9tbWlv
X2luZm8oZ3Z0KTsKPiAgIAkJaWYgKHJldCkKPiAgIAkJCWdvdG8gZXJyOwo+ICAgCQlyZXQgPSBp
bml0X3NrbF9tbWlvX2luZm8oZ3Z0KTsKPiAgIAkJaWYgKHJldCkKPiAgIAkJCWdvdG8gZXJyOwo+
IC0JfSBlbHNlIGlmIChJU19CUk9YVE9OKGRldl9wcml2KSkgewo+ICsJfSBlbHNlIGlmIChJU19C
Uk9YVE9OKGk5MTUpKSB7Cj4gICAJCXJldCA9IGluaXRfYnJvYWR3ZWxsX21taW9faW5mbyhndnQp
Owo+ICAgCQlpZiAocmV0KQo+ICAgCQkJZ290byBlcnI7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d2dC9pbnRlcnJ1cHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9p
bnRlcnJ1cHQuYwo+IGluZGV4IDk1MTY4MTgxMzIzMC4uMzdlMmU3MmJmYWNjIDEwMDY0NAo+IC0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9pbnRlcnJ1cHQuYwo+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d2dC9pbnRlcnJ1cHQuYwo+IEBAIC01MzYsNyArNTM2LDcgQEAgc3RhdGlj
IHZvaWQgZ2VuOF9pbml0X2lycSgKPiAgIAlTRVRfQklUX0lORk8oaXJxLCA0LCBWQ1NfTUlfRkxV
U0hfRFcsIElOVEVMX0dWVF9JUlFfSU5GT19HVDEpOwo+ICAgCVNFVF9CSVRfSU5GTyhpcnEsIDgs
IFZDU19BU19DT05URVhUX1NXSVRDSCwgSU5URUxfR1ZUX0lSUV9JTkZPX0dUMSk7Cj4gICAKPiAt
CWlmIChIQVNfRU5HSU5FKGd2dC0+ZGV2X3ByaXYsIFZDUzEpKSB7Cj4gKwlpZiAoSEFTX0VOR0lO
RShndnQtPmk5MTUsIFZDUzEpKSB7Cj4gICAJCVNFVF9CSVRfSU5GTyhpcnEsIDE2LCBWQ1MyX01J
X1VTRVJfSU5URVJSVVBULAo+ICAgCQkJSU5URUxfR1ZUX0lSUV9JTkZPX0dUMSk7Cj4gICAJCVNF
VF9CSVRfSU5GTyhpcnEsIDIwLCBWQ1MyX01JX0ZMVVNIX0RXLAo+IEBAIC01NjgsNyArNTY4LDcg
QEAgc3RhdGljIHZvaWQgZ2VuOF9pbml0X2lycSgKPiAgIAlTRVRfQklUX0lORk8oaXJxLCAyMiwg
RFBfQ19IT1RQTFVHLCBJTlRFTF9HVlRfSVJRX0lORk9fUENIKTsKPiAgIAlTRVRfQklUX0lORk8o
aXJxLCAyMywgRFBfRF9IT1RQTFVHLCBJTlRFTF9HVlRfSVJRX0lORk9fUENIKTsKPiAgIAo+IC0J
aWYgKElTX0JST0FEV0VMTChndnQtPmRldl9wcml2KSkgewo+ICsJaWYgKElTX0JST0FEV0VMTChn
dnQtPmk5MTUpKSB7Cj4gICAJCVNFVF9CSVRfSU5GTyhpcnEsIDI1LCBBVVhfQ0hBTk5FTF9CLCBJ
TlRFTF9HVlRfSVJRX0lORk9fUENIKTsKPiAgIAkJU0VUX0JJVF9JTkZPKGlycSwgMjYsIEFVWF9D
SEFOTkVMX0MsIElOVEVMX0dWVF9JUlFfSU5GT19QQ0gpOwo+ICAgCQlTRVRfQklUX0lORk8oaXJx
LCAyNywgQVVYX0NIQU5ORUxfRCwgSU5URUxfR1ZUX0lSUV9JTkZPX1BDSCk7Cj4gQEAgLTU4MSw3
ICs1ODEsNyBAQCBzdGF0aWMgdm9pZCBnZW44X2luaXRfaXJxKAo+ICAgCj4gICAJCVNFVF9CSVRf
SU5GTyhpcnEsIDQsIFBSSU1BUllfQ19GTElQX0RPTkUsIElOVEVMX0dWVF9JUlFfSU5GT19ERV9Q
SVBFX0MpOwo+ICAgCQlTRVRfQklUX0lORk8oaXJxLCA1LCBTUFJJVEVfQ19GTElQX0RPTkUsIElO
VEVMX0dWVF9JUlFfSU5GT19ERV9QSVBFX0MpOwo+IC0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZ3Z0
LT5kZXZfcHJpdikgPj0gOSkgewo+ICsJfSBlbHNlIGlmIChJTlRFTF9HRU4oZ3Z0LT5pOTE1KSA+
PSA5KSB7Cj4gICAJCVNFVF9CSVRfSU5GTyhpcnEsIDI1LCBBVVhfQ0hBTk5FTF9CLCBJTlRFTF9H
VlRfSVJRX0lORk9fREVfUE9SVCk7Cj4gICAJCVNFVF9CSVRfSU5GTyhpcnEsIDI2LCBBVVhfQ0hB
Tk5FTF9DLCBJTlRFTF9HVlRfSVJRX0lORk9fREVfUE9SVCk7Cj4gICAJCVNFVF9CSVRfSU5GTyhp
cnEsIDI3LCBBVVhfQ0hBTk5FTF9ELCBJTlRFTF9HVlRfSVJRX0lORk9fREVfUE9SVCk7Cj4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9rdm1ndC5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3Z0L2t2bWd0LmMKPiBpbmRleCAxNDQzMDFiNzc4ZGYuLjYxNWE3OTU5Yjc2MiAx
MDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQva3ZtZ3QuYwo+ICsrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9rdm1ndC5jCj4gQEAgLTE4Nyw3ICsxODcsNyBAQCBzdGF0
aWMgaW50IGd2dF9waW5fZ3Vlc3RfcGFnZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwgdW5zaWdu
ZWQgbG9uZyBnZm4sCj4gICBzdGF0aWMgaW50IGd2dF9kbWFfbWFwX3BhZ2Uoc3RydWN0IGludGVs
X3ZncHUgKnZncHUsIHVuc2lnbmVkIGxvbmcgZ2ZuLAo+ICAgCQlkbWFfYWRkcl90ICpkbWFfYWRk
ciwgdW5zaWduZWQgbG9uZyBzaXplKQo+ICAgewo+IC0Jc3RydWN0IGRldmljZSAqZGV2ID0gJnZn
cHUtPmd2dC0+ZGV2X3ByaXYtPmRybS5wZGV2LT5kZXY7Cj4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYg
PSAmdmdwdS0+Z3Z0LT5pOTE1LT5kcm0ucGRldi0+ZGV2Owo+ICAgCXN0cnVjdCBwYWdlICpwYWdl
ID0gTlVMTDsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gQEAgLTIxMCw3ICsyMTAsNyBAQCBzdGF0aWMg
aW50IGd2dF9kbWFfbWFwX3BhZ2Uoc3RydWN0IGludGVsX3ZncHUgKnZncHUsIHVuc2lnbmVkIGxv
bmcgZ2ZuLAo+ICAgc3RhdGljIHZvaWQgZ3Z0X2RtYV91bm1hcF9wYWdlKHN0cnVjdCBpbnRlbF92
Z3B1ICp2Z3B1LCB1bnNpZ25lZCBsb25nIGdmbiwKPiAgIAkJZG1hX2FkZHJfdCBkbWFfYWRkciwg
dW5zaWduZWQgbG9uZyBzaXplKQo+ICAgewo+IC0Jc3RydWN0IGRldmljZSAqZGV2ID0gJnZncHUt
Pmd2dC0+ZGV2X3ByaXYtPmRybS5wZGV2LT5kZXY7Cj4gKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAm
dmdwdS0+Z3Z0LT5pOTE1LT5kcm0ucGRldi0+ZGV2Owo+ICAgCj4gICAJZG1hX3VubWFwX3BhZ2Uo
ZGV2LCBkbWFfYWRkciwgc2l6ZSwgUENJX0RNQV9CSURJUkVDVElPTkFMKTsKPiAgIAlndnRfdW5w
aW5fZ3Vlc3RfcGFnZSh2Z3B1LCBnZm4sIHNpemUpOwo+IEBAIC05MTMsNyArOTEzLDcgQEAgc3Rh
dGljIGludCBpbnRlbF92Z3B1X2FwZXJ0dXJlX3J3KHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCB1
NjQgb2ZmLAo+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiAgIAl9Cj4gICAKPiAtCWFwZXJ0dXJlX3Zh
ID0gaW9fbWFwcGluZ19tYXBfd2MoJnZncHUtPmd2dC0+ZGV2X3ByaXYtPmdndHQuaW9tYXAsCj4g
KwlhcGVydHVyZV92YSA9IGlvX21hcHBpbmdfbWFwX3djKCZ2Z3B1LT5ndnQtPmk5MTUtPmdndHQu
aW9tYXAsCj4gICAJCQkJCUFMSUdOX0RPV04ob2ZmLCBQQUdFX1NJWkUpLAo+ICAgCQkJCQljb3Vu
dCArIG9mZnNldF9pbl9wYWdlKG9mZikpOwo+ICAgCWlmICghYXBlcnR1cmVfdmEpCj4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9tbWlvLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndnQvbW1pby5jCj4gaW5kZXggYTU1MTc4ODg0ZDY3Li41NzJiODMyOGFmNjEgMTAwNjQ0
Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L21taW8uYwo+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d2dC9tbWlvLmMKPiBAQCAtMjQ1LDcgKzI0NSw3IEBAIHZvaWQgaW50ZWxf
dmdwdV9yZXNldF9tbWlvKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCBib29sIGRtbHIpCj4gICAJ
CS8qIHNldCB0aGUgYml0IDA6MihDb3JlIEMtU3RhdGUgKSB0byBDMCAqLwo+ICAgCQl2Z3B1X3Zy
ZWdfdCh2Z3B1LCBHRU42X0dUX0NPUkVfU1RBVFVTKSA9IDA7Cj4gICAKPiAtCQlpZiAoSVNfQlJP
WFRPTih2Z3B1LT5ndnQtPmRldl9wcml2KSkgewo+ICsJCWlmIChJU19CUk9YVE9OKHZncHUtPmd2
dC0+aTkxNSkpIHsKPiAgIAkJCXZncHVfdnJlZ190KHZncHUsIEJYVF9QX0NSX0dUX0RJU1BfUFdS
T04pICY9Cj4gICAJCQkJICAgIH4oQklUKDApIHwgQklUKDEpKTsKPiAgIAkJCXZncHVfdnJlZ190
KHZncHUsIEJYVF9QT1JUX0NMMUNNX0RXMChEUElPX1BIWTApKSAmPQo+IGRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvbW1pb19jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndnQvbW1pb19jb250ZXh0LmMKPiBpbmRleCAyOTk4OTk5ZTg1NjguLjQ0ZmQ2YTBhNjk4
YyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvbW1pb19jb250ZXh0LmMK
PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvbW1pb19jb250ZXh0LmMKPiBAQCAtMTQ4
LDcgKzE0OCw3IEBAIHN0YXRpYyBzdHJ1Y3Qgewo+ICAgCXUzMiBsM2NjX3RhYmxlW0dFTjlfTU9D
U19TSVpFIC8gMl07Cj4gICB9IGdlbjlfcmVuZGVyX21vY3M7Cj4gICAKPiAtc3RhdGljIHZvaWQg
bG9hZF9yZW5kZXJfbW9jcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0
YXRpYyB2b2lkIGxvYWRfcmVuZGVyX21vY3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gICB7Cj4gICAJaTkxNV9yZWdfdCBvZmZzZXQ7Cj4gICAJdTMyIHJlZ3NbXSA9IHsKPiBAQCAt
MTYxLDcgKzE2MSw3IEBAIHN0YXRpYyB2b2lkIGxvYWRfcmVuZGVyX21vY3Moc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCWludCByaW5nX2lkLCBpOwo+ICAgCj4gICAJZm9y
IChyaW5nX2lkID0gMDsgcmluZ19pZCA8IEFSUkFZX1NJWkUocmVncyk7IHJpbmdfaWQrKykgewo+
IC0JCWlmICghSEFTX0VOR0lORShkZXZfcHJpdiwgcmluZ19pZCkpCj4gKwkJaWYgKCFIQVNfRU5H
SU5FKGk5MTUsIHJpbmdfaWQpKQo+ICAgCQkJY29udGludWU7Cj4gICAJCW9mZnNldC5yZWcgPSBy
ZWdzW3JpbmdfaWRdOwo+ICAgCQlmb3IgKGkgPSAwOyBpIDwgR0VOOV9NT0NTX1NJWkU7IGkrKykg
ewo+IEBAIC0zMjksOCArMzI5LDggQEAgaW50IGludGVsX3ZncHVfcmVzdG9yZV9pbmhpYml0X2Nv
bnRleHQoc3RydWN0IGludGVsX3ZncHUgKnZncHUsCj4gICAKPiAgIHN0YXRpYyB2b2lkIGhhbmRs
ZV90bGJfcGVuZGluZ19ldmVudChzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwgaW50IHJpbmdfaWQp
Cj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2Z3B1LT5ndnQt
PmRldl9wcml2Owo+IC0Jc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmRldl9wcml2LT51
bmNvcmU7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHZncHUtPmd2dC0+aTkx
NTsKPiArCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZpOTE1LT51bmNvcmU7Cj4gICAJ
c3RydWN0IGludGVsX3ZncHVfc3VibWlzc2lvbiAqcyA9ICZ2Z3B1LT5zdWJtaXNzaW9uOwo+ICAg
CWVudW0gZm9yY2V3YWtlX2RvbWFpbnMgZnc7Cj4gICAJaTkxNV9yZWdfdCByZWc7Cj4gQEAgLTM1
Nyw3ICszNTcsNyBAQCBzdGF0aWMgdm9pZCBoYW5kbGVfdGxiX3BlbmRpbmdfZXZlbnQoc3RydWN0
IGludGVsX3ZncHUgKnZncHUsIGludCByaW5nX2lkKQo+ICAgCSAqLwo+ICAgCWZ3ID0gaW50ZWxf
dW5jb3JlX2ZvcmNld2FrZV9mb3JfcmVnKHVuY29yZSwgcmVnLAo+ICAgCQkJCQkgICAgRldfUkVH
X1JFQUQgfCBGV19SRUdfV1JJVEUpOwo+IC0JaWYgKHJpbmdfaWQgPT0gUkNTMCAmJiBJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDkpCj4gKwlpZiAocmluZ19pZCA9PSBSQ1MwICYmIElOVEVMX0dFTihp
OTE1KSA+PSA5KQo+ICAgCQlmdyB8PSBGT1JDRVdBS0VfUkVOREVSOwo+ICAgCj4gICAJaW50ZWxf
dW5jb3JlX2ZvcmNld2FrZV9nZXQodW5jb3JlLCBmdyk7Cj4gQEAgLTM3Nyw3ICszNzcsNyBAQCBz
dGF0aWMgdm9pZCBoYW5kbGVfdGxiX3BlbmRpbmdfZXZlbnQoc3RydWN0IGludGVsX3ZncHUgKnZn
cHUsIGludCByaW5nX2lkKQo+ICAgc3RhdGljIHZvaWQgc3dpdGNoX21vY3Moc3RydWN0IGludGVs
X3ZncHUgKnByZSwgc3RydWN0IGludGVsX3ZncHUgKm5leHQsCj4gICAJCQlpbnQgcmluZ19pZCkK
PiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdjsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1Owo+ICAgCWk5MTVfcmVnX3Qgb2Zmc2V0LCBsM19vZmZzZXQ7
Cj4gICAJdTMyIG9sZF92LCBuZXdfdjsKPiAgIAo+IEBAIC0zOTAsMTUgKzM5MCwxNSBAQCBzdGF0
aWMgdm9pZCBzd2l0Y2hfbW9jcyhzdHJ1Y3QgaW50ZWxfdmdwdSAqcHJlLCBzdHJ1Y3QgaW50ZWxf
dmdwdSAqbmV4dCwKPiAgIAl9Owo+ICAgCWludCBpOwo+ICAgCj4gLQlkZXZfcHJpdiA9IHByZSA/
IHByZS0+Z3Z0LT5kZXZfcHJpdiA6IG5leHQtPmd2dC0+ZGV2X3ByaXY7Cj4gKwlpOTE1ID0gcHJl
ID8gcHJlLT5ndnQtPmk5MTUgOiBuZXh0LT5ndnQtPmk5MTU7Cj4gICAJaWYgKFdBUk5fT04ocmlu
Z19pZCA+PSBBUlJBWV9TSVpFKHJlZ3MpKSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQlpZiAocmlu
Z19pZCA9PSBSQ1MwICYmIElTX0dFTihkZXZfcHJpdiwgOSkpCj4gKwlpZiAocmluZ19pZCA9PSBS
Q1MwICYmIElTX0dFTihpOTE1LCA5KSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJaWYgKCFwcmUg
JiYgIWdlbjlfcmVuZGVyX21vY3MuaW5pdGlhbGl6ZWQpCj4gLQkJbG9hZF9yZW5kZXJfbW9jcyhk
ZXZfcHJpdik7Cj4gKwkJbG9hZF9yZW5kZXJfbW9jcyhpOTE1KTsKPiAgIAo+ICAgCW9mZnNldC5y
ZWcgPSByZWdzW3JpbmdfaWRdOwo+ICAgCWZvciAoaSA9IDA7IGkgPCBHRU45X01PQ1NfU0laRTsg
aSsrKSB7Cj4gQEAgLTQ1NCwxNiArNDU0LDE2IEBAIHN0YXRpYyB2b2lkIHN3aXRjaF9tbWlvKHN0
cnVjdCBpbnRlbF92Z3B1ICpwcmUsCj4gICAJCQlzdHJ1Y3QgaW50ZWxfdmdwdSAqbmV4dCwKPiAg
IAkJCWludCByaW5nX2lkKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTU7Cj4gICAJc3RydWN0IGludGVs
X3ZncHVfc3VibWlzc2lvbiAqczsKPiAgIAlzdHJ1Y3QgZW5naW5lX21taW8gKm1taW87Cj4gICAJ
dTMyIG9sZF92LCBuZXdfdjsKPiAgIAo+IC0JZGV2X3ByaXYgPSBwcmUgPyBwcmUtPmd2dC0+ZGV2
X3ByaXYgOiBuZXh0LT5ndnQtPmRldl9wcml2Owo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gOSkKPiArCWk5MTUgPSBwcmUgPyBwcmUtPmd2dC0+aTkxNSA6IG5leHQtPmd2dC0+aTkxNTsK
PiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkKPiAgIAkJc3dpdGNoX21vY3MocHJlLCBuZXh0
LCByaW5nX2lkKTsKPiAgIAo+IC0JZm9yIChtbWlvID0gZGV2X3ByaXYtPmd2dC0+ZW5naW5lX21t
aW9fbGlzdC5tbWlvOwo+ICsJZm9yIChtbWlvID0gaTkxNS0+Z3Z0LT5lbmdpbmVfbW1pb19saXN0
Lm1taW87Cj4gICAJICAgICBpOTE1X21taW9fcmVnX3ZhbGlkKG1taW8tPnJlZyk7IG1taW8rKykg
ewo+ICAgCQlpZiAobW1pby0+cmluZ19pZCAhPSByaW5nX2lkKQo+ICAgCQkJY29udGludWU7Cj4g
QEAgLTQ3Miw3ICs0NzIsNyBAQCBzdGF0aWMgdm9pZCBzd2l0Y2hfbW1pbyhzdHJ1Y3QgaW50ZWxf
dmdwdSAqcHJlLAo+ICAgCQkgKiBzdGF0ZSBpbWFnZSBvbiBnZW45LCBpdCdzIGluaXRpYWxpemVk
IGJ5IGxyaSBjb21tYW5kIGFuZAo+ICAgCQkgKiBzYXZlIG9yIHJlc3RvcmUgd2l0aCBjb250ZXh0
IHRvZ2V0aGVyLgo+ICAgCQkgKi8KPiAtCQlpZiAoSVNfR0VOKGRldl9wcml2LCA5KSAmJiBtbWlv
LT5pbl9jb250ZXh0KQo+ICsJCWlmIChJU19HRU4oaTkxNSwgOSkgJiYgbW1pby0+aW5fY29udGV4
dCkKPiAgIAkJCWNvbnRpbnVlOwo+ICAgCj4gICAJCS8vIHNhdmUKPiBAQCAtNTM2LDcgKzUzNiw3
IEBAIHN0YXRpYyB2b2lkIHN3aXRjaF9tbWlvKHN0cnVjdCBpbnRlbF92Z3B1ICpwcmUsCj4gICB2
b2lkIGludGVsX2d2dF9zd2l0Y2hfbW1pbyhzdHJ1Y3QgaW50ZWxfdmdwdSAqcHJlLAo+ICAgCQkJ
ICAgc3RydWN0IGludGVsX3ZncHUgKm5leHQsIGludCByaW5nX2lkKQo+ICAgewo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTU7Cj4gICAKPiAgIAlpZiAoV0FSTl9PTighcHJlICYmICFuZXh0KSkKPiAgIAkJcmV0dXJu
Owo+IEBAIC01NDQsMTYgKzU0NCwxNiBAQCB2b2lkIGludGVsX2d2dF9zd2l0Y2hfbW1pbyhzdHJ1
Y3QgaW50ZWxfdmdwdSAqcHJlLAo+ICAgCWd2dF9kYmdfcmVuZGVyKCJzd2l0Y2ggcmluZyAlZCBm
cm9tICVzIHRvICVzXG4iLCByaW5nX2lkLAo+ICAgCQkgICAgICAgcHJlID8gInZHUFUiIDogImhv
c3QiLCBuZXh0ID8gInZHUFUiIDogIkhPU1QiKTsKPiAgIAo+IC0JZGV2X3ByaXYgPSBwcmUgPyBw
cmUtPmd2dC0+ZGV2X3ByaXYgOiBuZXh0LT5ndnQtPmRldl9wcml2Owo+ICsJaTkxNSA9IHByZSA/
IHByZS0+Z3Z0LT5pOTE1IDogbmV4dC0+Z3Z0LT5pOTE1Owo+ICAgCj4gICAJLyoqCj4gICAJICog
V2UgYXJlIHVzaW5nIHJhdyBtbWlvIGFjY2VzcyB3cmFwcGVyIHRvIGltcHJvdmUgdGhlCj4gICAJ
ICogcGVyZm9ybWFjZSBmb3IgYmF0Y2ggbW1pbyByZWFkL3dyaXRlLCBzbyB3ZSBuZWVkCj4gICAJ
ICogaGFuZGxlIGZvcmNld2FrZSBtYW5udWFsbHkuCj4gICAJICovCj4gLQlpbnRlbF91bmNvcmVf
Zm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gKwlpbnRl
bF91bmNvcmVfZm9yY2V3YWtlX2dldCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiAg
IAlzd2l0Y2hfbW1pbyhwcmUsIG5leHQsIHJpbmdfaWQpOwo+IC0JaW50ZWxfdW5jb3JlX2ZvcmNl
d2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ICsJaW50ZWxfdW5j
b3JlX2ZvcmNld2FrZV9wdXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gICB9Cj4g
ICAKPiAgIC8qKgo+IEBAIC01NjUsNyArNTY1LDcgQEAgdm9pZCBpbnRlbF9ndnRfaW5pdF9lbmdp
bmVfbW1pb19jb250ZXh0KHN0cnVjdCBpbnRlbF9ndnQgKmd2dCkKPiAgIHsKPiAgIAlzdHJ1Y3Qg
ZW5naW5lX21taW8gKm1taW87Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZ3Z0LT5kZXZfcHJpdikg
Pj0gOSkKPiArCWlmIChJTlRFTF9HRU4oZ3Z0LT5pOTE1KSA+PSA5KQo+ICAgCQlndnQtPmVuZ2lu
ZV9tbWlvX2xpc3QubW1pbyA9IGdlbjlfZW5naW5lX21taW9fbGlzdDsKPiAgIAllbHNlCj4gICAJ
CWd2dC0+ZW5naW5lX21taW9fbGlzdC5tbWlvID0gZ2VuOF9lbmdpbmVfbW1pb19saXN0Owo+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWRfcG9saWN5LmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWRfcG9saWN5LmMKPiBpbmRleCAxYzc2M2EyN2E0MTIu
LjY0YTVkNDY4OGM4OSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2No
ZWRfcG9saWN5LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWRfcG9saWN5
LmMKPiBAQCAtMzksNyArMzksNyBAQCBzdGF0aWMgYm9vbCB2Z3B1X2hhc19wZW5kaW5nX3dvcmts
b2FkKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQo+ICAgCWVudW0gaW50ZWxfZW5naW5lX2lkIGk7
Cj4gICAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwo+ICAgCj4gLQlmb3JfZWFjaF9l
bmdpbmUoZW5naW5lLCB2Z3B1LT5ndnQtPmRldl9wcml2LCBpKSB7Cj4gKwlmb3JfZWFjaF9lbmdp
bmUoZW5naW5lLCB2Z3B1LT5ndnQtPmk5MTUsIGkpIHsKPiAgIAkJaWYgKCFsaXN0X2VtcHR5KHdv
cmtsb2FkX3FfaGVhZCh2Z3B1LCBpKSkpCj4gICAJCQlyZXR1cm4gdHJ1ZTsKPiAgIAl9Cj4gQEAg
LTE1Miw3ICsxNTIsNyBAQCBzdGF0aWMgdm9pZCB0cnlfdG9fc2NoZWR1bGVfbmV4dF92Z3B1KHN0
cnVjdCBpbnRlbF9ndnQgKmd2dCkKPiAgIAlzY2hlZHVsZXItPm5lZWRfcmVzY2hlZHVsZSA9IHRy
dWU7Cj4gICAKPiAgIAkvKiBzdGlsbCBoYXZlIHVuY29tcGxldGVkIHdvcmtsb2FkPyAqLwo+IC0J
Zm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3Z0LT5kZXZfcHJpdiwgaSkgewo+ICsJZm9yX2VhY2hf
ZW5naW5lKGVuZ2luZSwgZ3Z0LT5pOTE1LCBpKSB7Cj4gICAJCWlmIChzY2hlZHVsZXItPmN1cnJl
bnRfd29ya2xvYWRbaV0pCj4gICAJCQlyZXR1cm47Cj4gICAJfQo+IEBAIC0xNjksNyArMTY5LDcg
QEAgc3RhdGljIHZvaWQgdHJ5X3RvX3NjaGVkdWxlX25leHRfdmdwdShzdHJ1Y3QgaW50ZWxfZ3Z0
ICpndnQpCj4gICAJc2NoZWR1bGVyLT5uZWVkX3Jlc2NoZWR1bGUgPSBmYWxzZTsKPiAgIAo+ICAg
CS8qIHdha2UgdXAgd29ya2xvYWQgZGlzcGF0Y2ggdGhyZWFkICovCj4gLQlmb3JfZWFjaF9lbmdp
bmUoZW5naW5lLCBndnQtPmRldl9wcml2LCBpKQo+ICsJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwg
Z3Z0LT5pOTE1LCBpKQo+ICAgCQl3YWtlX3VwKCZzY2hlZHVsZXItPndhaXRxW2ldKTsKPiAgIH0K
PiAgIAo+IEBAIC00NDYsNyArNDQ2LDcgQEAgdm9pZCBpbnRlbF92Z3B1X3N0b3Bfc2NoZWR1bGUo
c3RydWN0IGludGVsX3ZncHUgKnZncHUpCj4gICAJCSZ2Z3B1LT5ndnQtPnNjaGVkdWxlcjsKPiAg
IAlpbnQgcmluZ19pZDsKPiAgIAlzdHJ1Y3QgdmdwdV9zY2hlZF9kYXRhICp2Z3B1X2RhdGEgPSB2
Z3B1LT5zY2hlZF9kYXRhOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dmdwdS0+Z3Z0LT5kZXZfcHJpdjsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dmdwdS0+Z3Z0LT5pOTE1Owo+ICAgCj4gICAJaWYgKCF2Z3B1X2RhdGEtPmFjdGl2ZSkKPiAgIAkJ
cmV0dXJuOwo+IEBAIC00NjUsNyArNDY1LDcgQEAgdm9pZCBpbnRlbF92Z3B1X3N0b3Bfc2NoZWR1
bGUoc3RydWN0IGludGVsX3ZncHUgKnZncHUpCj4gICAJCXNjaGVkdWxlci0+Y3VycmVudF92Z3B1
ID0gTlVMTDsKPiAgIAl9Cj4gICAKPiAtCWludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsK
PiArCWludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOwo+ICAgCXNwaW5fbG9ja19iaCgmc2NoZWR1
bGVyLT5tbWlvX2NvbnRleHRfbG9jayk7Cj4gICAJZm9yIChyaW5nX2lkID0gMDsgcmluZ19pZCA8
IEk5MTVfTlVNX0VOR0lORVM7IHJpbmdfaWQrKykgewo+ICAgCQlpZiAoc2NoZWR1bGVyLT5lbmdp
bmVfb3duZXJbcmluZ19pZF0gPT0gdmdwdSkgewo+IEBAIC00NzQsNiArNDc0LDYgQEAgdm9pZCBp
bnRlbF92Z3B1X3N0b3Bfc2NoZWR1bGUoc3RydWN0IGludGVsX3ZncHUgKnZncHUpCj4gICAJCX0K
PiAgIAl9Cj4gICAJc3Bpbl91bmxvY2tfYmgoJnNjaGVkdWxlci0+bW1pb19jb250ZXh0X2xvY2sp
Owo+IC0JaW50ZWxfcnVudGltZV9wbV9wdXRfdW5jaGVja2VkKGRldl9wcml2KTsKPiArCWludGVs
X3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tlZChpOTE1KTsKPiAgIAltdXRleF91bmxvY2soJnZncHUt
Pmd2dC0+c2NoZWRfbG9jayk7Cj4gICB9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d2dC9zY2hlZHVsZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIu
Ywo+IGluZGV4IGUzMDFlZmIxOGQ0NS4uZWM3Mjk5ZDhhNzM4IDEwMDY0NAo+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d2dC9zY2hlZHVsZXIuYwo+IEBAIC04Myw5ICs4Myw5IEBAIHN0YXRpYyB2b2lkIHVwZGF0
ZV9zaGFkb3dfcGRwcyhzdHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xvYWQpCj4gICBz
dGF0aWMgdm9pZCBzcl9vYV9yZWdzKHN0cnVjdCBpbnRlbF92Z3B1X3dvcmtsb2FkICp3b3JrbG9h
ZCwKPiAgIAkJdTMyICpyZWdfc3RhdGUsIGJvb2wgc2F2ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHdvcmtsb2FkLT52Z3B1LT5ndnQtPmRldl9wcml2Owo+
IC0JdTMyIGN0eF9vYWN0eGN0cmwgPSBkZXZfcHJpdi0+cGVyZi5vYS5jdHhfb2FjdHhjdHJsX29m
ZnNldDsKPiAtCXUzMiBjdHhfZmxleGV1MCA9IGRldl9wcml2LT5wZXJmLm9hLmN0eF9mbGV4ZXUw
X29mZnNldDsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gd29ya2xvYWQtPnZn
cHUtPmd2dC0+aTkxNTsKPiArCXUzMiBjdHhfb2FjdHhjdHJsID0gaTkxNS0+cGVyZi5vYS5jdHhf
b2FjdHhjdHJsX29mZnNldDsKPiArCXUzMiBjdHhfZmxleGV1MCA9IGk5MTUtPnBlcmYub2EuY3R4
X2ZsZXhldTBfb2Zmc2V0Owo+ICAgCWludCBpID0gMDsKPiAgIAl1MzIgZmxleF9tbWlvW10gPSB7
Cj4gICAJCWk5MTVfbW1pb19yZWdfb2Zmc2V0KEVVX1BFUkZfQ05UTDApLAo+IEBAIC0xNzcsMTEg
KzE3NywxMSBAQCBzdGF0aWMgaW50IHBvcHVsYXRlX3NoYWRvd19jb250ZXh0KHN0cnVjdCBpbnRl
bF92Z3B1X3dvcmtsb2FkICp3b3JrbG9hZCkKPiAgIAlndnRfZGJnX3NjaGVkKCJyaW5nIGlkICVk
IHdvcmtsb2FkIGxyY2EgJXgiLCByaW5nX2lkLAo+ICAgCQkJd29ya2xvYWQtPmN0eF9kZXNjLmxy
Y2EpOwo+ICAgCj4gLQljb250ZXh0X3BhZ2VfbnVtID0gZ3Z0LT5kZXZfcHJpdi0+ZW5naW5lW3Jp
bmdfaWRdLT5jb250ZXh0X3NpemU7Cj4gKwljb250ZXh0X3BhZ2VfbnVtID0gZ3Z0LT5pOTE1LT5l
bmdpbmVbcmluZ19pZF0tPmNvbnRleHRfc2l6ZTsKPiAgIAo+ICAgCWNvbnRleHRfcGFnZV9udW0g
PSBjb250ZXh0X3BhZ2VfbnVtID4+IFBBR0VfU0hJRlQ7Cj4gICAKPiAtCWlmIChJU19CUk9BRFdF
TEwoZ3Z0LT5kZXZfcHJpdikgJiYgcmluZ19pZCA9PSBSQ1MwKQo+ICsJaWYgKElTX0JST0FEV0VM
TChndnQtPmk5MTUpICYmIHJpbmdfaWQgPT0gUkNTMCkKPiAgIAkJY29udGV4dF9wYWdlX251bSA9
IDE5Owo+ICAgCj4gICAJaSA9IDI7Cj4gQEAgLTIxMSw4ICsyMTEsOCBAQCBzdGF0aWMgaW5saW5l
IGJvb2wgaXNfZ3Z0X3JlcXVlc3Qoc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxKQo+ICAgCj4gICBz
dGF0aWMgdm9pZCBzYXZlX3JpbmdfaHdfc3RhdGUoc3RydWN0IGludGVsX3ZncHUgKnZncHUsIGlu
dCByaW5nX2lkKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dmdwdS0+Z3Z0LT5kZXZfcHJpdjsKPiAtCXUzMiByaW5nX2Jhc2UgPSBkZXZfcHJpdi0+ZW5naW5l
W3JpbmdfaWRdLT5tbWlvX2Jhc2U7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHZncHUtPmd2dC0+aTkxNTsKPiArCXUzMiByaW5nX2Jhc2UgPSBpOTE1LT5lbmdpbmVbcmluZ19p
ZF0tPm1taW9fYmFzZTsKPiAgIAlpOTE1X3JlZ190IHJlZzsKPiAgIAo+ICAgCXJlZyA9IFJJTkdf
SU5TVERPTkUocmluZ19iYXNlKTsKPiBAQCAtMzkxLDEwICszOTEsMTAgQEAgaW50ZWxfZ3Z0X3dv
cmtsb2FkX3JlcV9hbGxvYyhzdHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xvYWQpCj4g
ICB7Cj4gICAJc3RydWN0IGludGVsX3ZncHUgKnZncHUgPSB3b3JrbG9hZC0+dmdwdTsKPiAgIAlz
dHJ1Y3QgaW50ZWxfdmdwdV9zdWJtaXNzaW9uICpzID0gJnZncHUtPnN1Ym1pc3Npb247Cj4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2Z3B1LT5ndnQtPmRldl9wcml2Owo+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2Z3B1LT5ndnQtPmk5MTU7Cj4gICAJ
c3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7Cj4gICAKPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRl
dl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUt
PmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCj4gICAJaWYgKHdvcmtsb2FkLT5yZXEpCj4gICAJCXJl
dHVybiAwOwo+IEBAIC00MjEsMTAgKzQyMSwxMCBAQCBpbnQgaW50ZWxfZ3Z0X3NjYW5fYW5kX3No
YWRvd193b3JrbG9hZChzdHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xvYWQpCj4gICB7
Cj4gICAJc3RydWN0IGludGVsX3ZncHUgKnZncHUgPSB3b3JrbG9hZC0+dmdwdTsKPiAgIAlzdHJ1
Y3QgaW50ZWxfdmdwdV9zdWJtaXNzaW9uICpzID0gJnZncHUtPnN1Ym1pc3Npb247Cj4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2Z3B1LT5ndnQtPmRldl9wcml2Owo+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2Z3B1LT5ndnQtPmk5MTU7Cj4gICAJaW50
IHJldDsKPiAgIAo+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPmRybS5zdHJ1Y3Rf
bXV0ZXgpOwo+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7
Cj4gICAKPiAgIAlpZiAod29ya2xvYWQtPnNoYWRvdykKPiAgIAkJcmV0dXJuIDA7Cj4gQEAgLTU3
Nyw3ICs1NzcsNyBAQCBzdGF0aWMgaW50IHByZXBhcmVfc2hhZG93X3dhX2N0eChzdHJ1Y3QgaW50
ZWxfc2hhZG93X3dhX2N0eCAqd2FfY3R4KQo+ICAgc3RhdGljIHZvaWQgcmVsZWFzZV9zaGFkb3df
YmF0Y2hfYnVmZmVyKHN0cnVjdCBpbnRlbF92Z3B1X3dvcmtsb2FkICp3b3JrbG9hZCkKPiAgIHsK
PiAgIAlzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSA9IHdvcmtsb2FkLT52Z3B1Owo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdmdwdS0+Z3Z0LT5pOTE1Owo+ICAgCXN0cnVj
dCBpbnRlbF92Z3B1X3NoYWRvd19iYiAqYmIsICpwb3M7Cj4gICAKPiAgIAlpZiAobGlzdF9lbXB0
eSgmd29ya2xvYWQtPnNoYWRvd19iYikpCj4gQEAgLTU4Niw3ICs1ODYsNyBAQCBzdGF0aWMgdm9p
ZCByZWxlYXNlX3NoYWRvd19iYXRjaF9idWZmZXIoc3RydWN0IGludGVsX3ZncHVfd29ya2xvYWQg
Kndvcmtsb2FkKQo+ICAgCWJiID0gbGlzdF9maXJzdF9lbnRyeSgmd29ya2xvYWQtPnNoYWRvd19i
YiwKPiAgIAkJCXN0cnVjdCBpbnRlbF92Z3B1X3NoYWRvd19iYiwgbGlzdCk7Cj4gICAKPiAtCW11
dGV4X2xvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiArCW11dGV4X2xvY2soJmk5
MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCj4gICAJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZl
KGJiLCBwb3MsICZ3b3JrbG9hZC0+c2hhZG93X2JiLCBsaXN0KSB7Cj4gICAJCWlmIChiYi0+b2Jq
KSB7Cj4gQEAgLTYwNiw3ICs2MDYsNyBAQCBzdGF0aWMgdm9pZCByZWxlYXNlX3NoYWRvd19iYXRj
aF9idWZmZXIoc3RydWN0IGludGVsX3ZncHVfd29ya2xvYWQgKndvcmtsb2FkKQo+ICAgCQlrZnJl
ZShiYik7Cj4gICAJfQo+ICAgCj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5kcm0uc3RydWN0
X211dGV4KTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICB9
Cj4gICAKPiAgIHN0YXRpYyBpbnQgcHJlcGFyZV93b3JrbG9hZChzdHJ1Y3QgaW50ZWxfdmdwdV93
b3JrbG9hZCAqd29ya2xvYWQpCj4gQEAgLTY3MSw3ICs2NzEsNyBAQCBzdGF0aWMgaW50IHByZXBh
cmVfd29ya2xvYWQoc3RydWN0IGludGVsX3ZncHVfd29ya2xvYWQgKndvcmtsb2FkKQo+ICAgc3Rh
dGljIGludCBkaXNwYXRjaF93b3JrbG9hZChzdHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29y
a2xvYWQpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX3ZncHUgKnZncHUgPSB3b3JrbG9hZC0+dmdw
dTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHZncHUtPmd2dC0+ZGV2
X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHZncHUtPmd2dC0+aTkx
NTsKPiAgIAlzdHJ1Y3QgaW50ZWxfdmdwdV9zdWJtaXNzaW9uICpzID0gJnZncHUtPnN1Ym1pc3Np
b247Cj4gICAJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7Cj4gICAJaW50IHJpbmdfaWQgPSB3b3Jr
bG9hZC0+cmluZ19pZDsKPiBAQCAtNjgxLDcgKzY4MSw3IEBAIHN0YXRpYyBpbnQgZGlzcGF0Y2hf
d29ya2xvYWQoc3RydWN0IGludGVsX3ZncHVfd29ya2xvYWQgKndvcmtsb2FkKQo+ICAgCQlyaW5n
X2lkLCB3b3JrbG9hZCk7Cj4gICAKPiAgIAltdXRleF9sb2NrKCZ2Z3B1LT52Z3B1X2xvY2spOwo+
IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJbXV0ZXhfbG9j
aygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAKPiAgIAlyZXQgPSBzZXRfY29udGV4dF9w
cGd0dF9mcm9tX3NoYWRvdyh3b3JrbG9hZCwKPiAgIAkJCQkJICAgIHMtPnNoYWRvd1tyaW5nX2lk
XS0+Z2VtX2NvbnRleHQpOwo+IEBAIC03MjMsNyArNzIzLDcgQEAgc3RhdGljIGludCBkaXNwYXRj
aF93b3JrbG9hZChzdHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xvYWQpCj4gICBlcnJf
cmVxOgo+ICAgCWlmIChyZXQpCj4gICAJCXdvcmtsb2FkLT5zdGF0dXMgPSByZXQ7Cj4gLQltdXRl
eF91bmxvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiArCW11dGV4X3VubG9jaygm
aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAJbXV0ZXhfdW5sb2NrKCZ2Z3B1LT52Z3B1X2xv
Y2spOwo+ICAgCXJldHVybiByZXQ7Cj4gICB9Cj4gQEAgLTc5Niw3ICs3OTYsNyBAQCBzdGF0aWMg
dm9pZCB1cGRhdGVfZ3Vlc3RfY29udGV4dChzdHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29y
a2xvYWQpCj4gICAJdm9pZCAqc3JjOwo+ICAgCXVuc2lnbmVkIGxvbmcgY29udGV4dF9ncGEsIGNv
bnRleHRfcGFnZV9udW07Cj4gICAJaW50IGk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBndnQtPmRldl9wcml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSBndnQtPmk5MTU7Cj4gICAJdTMyIHJpbmdfYmFzZTsKPiAgIAl1MzIgaGVhZCwgdGFpbDsK
PiAgIAl1MTYgd3JhcF9jb3VudDsKPiBAQCAtODE3LDE0ICs4MTcsMTQgQEAgc3RhdGljIHZvaWQg
dXBkYXRlX2d1ZXN0X2NvbnRleHQoc3RydWN0IGludGVsX3ZncHVfd29ya2xvYWQgKndvcmtsb2Fk
KQo+ICAgCj4gICAJaGVhZCA9ICh3cmFwX2NvdW50IDw8IFJCX0hFQURfV1JBUF9DTlRfT0ZGKSB8
IHRhaWw7Cj4gICAKPiAtCXJpbmdfYmFzZSA9IGRldl9wcml2LT5lbmdpbmVbd29ya2xvYWQtPnJp
bmdfaWRdLT5tbWlvX2Jhc2U7Cj4gKwlyaW5nX2Jhc2UgPSBpOTE1LT5lbmdpbmVbd29ya2xvYWQt
PnJpbmdfaWRdLT5tbWlvX2Jhc2U7Cj4gICAJdmdwdV92cmVnX3QodmdwdSwgUklOR19UQUlMKHJp
bmdfYmFzZSkpID0gdGFpbDsKPiAgIAl2Z3B1X3ZyZWdfdCh2Z3B1LCBSSU5HX0hFQUQocmluZ19i
YXNlKSkgPSBoZWFkOwo+ICAgCj4gICAJY29udGV4dF9wYWdlX251bSA9IHJxLT5lbmdpbmUtPmNv
bnRleHRfc2l6ZTsKPiAgIAljb250ZXh0X3BhZ2VfbnVtID0gY29udGV4dF9wYWdlX251bSA+PiBQ
QUdFX1NISUZUOwo+ICAgCj4gLQlpZiAoSVNfQlJPQURXRUxMKGd2dC0+ZGV2X3ByaXYpICYmIHJx
LT5lbmdpbmUtPmlkID09IFJDUzApCj4gKwlpZiAoSVNfQlJPQURXRUxMKGd2dC0+aTkxNSkgJiYg
cnEtPmVuZ2luZS0+aWQgPT0gUkNTMCkKPiAgIAkJY29udGV4dF9wYWdlX251bSA9IDE5Owo+ICAg
Cj4gICAJaSA9IDI7Cj4gQEAgLTg3NSwxMyArODc1LDEzIEBAIHZvaWQgaW50ZWxfdmdwdV9jbGVh
bl93b3JrbG9hZHMoc3RydWN0IGludGVsX3ZncHUgKnZncHUsCj4gICAJCQkJaW50ZWxfZW5naW5l
X21hc2tfdCBlbmdpbmVfbWFzaykKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfdmdwdV9zdWJtaXNz
aW9uICpzID0gJnZncHUtPnN1Ym1pc3Npb247Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB2Z3B1LT5ndnQtPmRldl9wcml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB2Z3B1LT5ndnQtPmk5MTU7Cj4gICAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lOwo+ICAgCXN0cnVjdCBpbnRlbF92Z3B1X3dvcmtsb2FkICpwb3MsICpuOwo+ICAgCWlu
dGVsX2VuZ2luZV9tYXNrX3QgdG1wOwo+ICAgCj4gICAJLyogZnJlZSB0aGUgdW5zdWJtaXRlZCB3
b3JrbG9hZHMgaW4gdGhlIHF1ZXVlcy4gKi8KPiAtCWZvcl9lYWNoX2VuZ2luZV9tYXNrZWQoZW5n
aW5lLCBkZXZfcHJpdiwgZW5naW5lX21hc2ssIHRtcCkgewo+ICsJZm9yX2VhY2hfZW5naW5lX21h
c2tlZChlbmdpbmUsIGk5MTUsIGVuZ2luZV9tYXNrLCB0bXApIHsKPiAgIAkJbGlzdF9mb3JfZWFj
aF9lbnRyeV9zYWZlKHBvcywgbiwKPiAgIAkJCSZzLT53b3JrbG9hZF9xX2hlYWRbZW5naW5lLT5p
ZF0sIGxpc3QpIHsKPiAgIAkJCWxpc3RfZGVsX2luaXQoJnBvcy0+bGlzdCk7Cj4gQEAgLTk4Niw3
ICs5ODYsNyBAQCBzdGF0aWMgaW50IHdvcmtsb2FkX3RocmVhZCh2b2lkICpwcml2KQo+ICAgCXN0
cnVjdCBpbnRlbF92Z3B1X3dvcmtsb2FkICp3b3JrbG9hZCA9IE5VTEw7Cj4gICAJc3RydWN0IGlu
dGVsX3ZncHUgKnZncHUgPSBOVUxMOwo+ICAgCWludCByZXQ7Cj4gLQlib29sIG5lZWRfZm9yY2Vf
d2FrZSA9IChJTlRFTF9HRU4oZ3Z0LT5kZXZfcHJpdikgPj0gOSk7Cj4gKwlib29sIG5lZWRfZm9y
Y2Vfd2FrZSA9IChJTlRFTF9HRU4oZ3Z0LT5pOTE1KSA+PSA5KTsKPiAgIAlERUZJTkVfV0FJVF9G
VU5DKHdhaXQsIHdva2VuX3dha2VfZnVuY3Rpb24pOwo+ICAgCj4gICAJa2ZyZWUocCk7Cj4gQEAg
LTEwMTUsNyArMTAxNSw3IEBAIHN0YXRpYyBpbnQgd29ya2xvYWRfdGhyZWFkKHZvaWQgKnByaXYp
Cj4gICAJCQkJd29ya2xvYWQtPnJpbmdfaWQsIHdvcmtsb2FkKTsKPiAgIAo+ICAgCQlpZiAobmVl
ZF9mb3JjZV93YWtlKQo+IC0JCQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZ3Z0LT5kZXZf
cHJpdi0+dW5jb3JlLAo+ICsJCQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZ3Z0LT5pOTE1
LT51bmNvcmUsCj4gICAJCQkJCUZPUkNFV0FLRV9BTEwpOwo+ICAgCj4gICAJCXJldCA9IGRpc3Bh
dGNoX3dvcmtsb2FkKHdvcmtsb2FkKTsKPiBAQCAtMTAzNyw3ICsxMDM3LDcgQEAgc3RhdGljIGlu
dCB3b3JrbG9hZF90aHJlYWQodm9pZCAqcHJpdikKPiAgIAkJY29tcGxldGVfY3VycmVudF93b3Jr
bG9hZChndnQsIHJpbmdfaWQpOwo+ICAgCj4gICAJCWlmIChuZWVkX2ZvcmNlX3dha2UpCj4gLQkJ
CWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZndnQtPmRldl9wcml2LT51bmNvcmUsCj4gKwkJ
CWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZndnQtPmk5MTUtPnVuY29yZSwKPiAgIAkJCQkJ
Rk9SQ0VXQUtFX0FMTCk7Cj4gICAKPiAgIAkJaWYgKHJldCAmJiAodmdwdV9pc192bV91bmhlYWx0
aHkocmV0KSkpCj4gQEAgLTEwNjgsNyArMTA2OCw3IEBAIHZvaWQgaW50ZWxfZ3Z0X2NsZWFuX3dv
cmtsb2FkX3NjaGVkdWxlcihzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQpCj4gICAKPiAgIAlndnRfZGJn
X2NvcmUoImNsZWFuIHdvcmtsb2FkIHNjaGVkdWxlclxuIik7Cj4gICAKPiAtCWZvcl9lYWNoX2Vu
Z2luZShlbmdpbmUsIGd2dC0+ZGV2X3ByaXYsIGkpIHsKPiArCWZvcl9lYWNoX2VuZ2luZShlbmdp
bmUsIGd2dC0+aTkxNSwgaSkgewo+ICAgCQlhdG9taWNfbm90aWZpZXJfY2hhaW5fdW5yZWdpc3Rl
cigKPiAgIAkJCQkJJmVuZ2luZS0+Y29udGV4dF9zdGF0dXNfbm90aWZpZXIsCj4gICAJCQkJCSZn
dnQtPnNoYWRvd19jdHhfbm90aWZpZXJfYmxvY2tbaV0pOwo+IEBAIC0xMDg4LDcgKzEwODgsNyBA
QCBpbnQgaW50ZWxfZ3Z0X2luaXRfd29ya2xvYWRfc2NoZWR1bGVyKHN0cnVjdCBpbnRlbF9ndnQg
Kmd2dCkKPiAgIAo+ICAgCWluaXRfd2FpdHF1ZXVlX2hlYWQoJnNjaGVkdWxlci0+d29ya2xvYWRf
Y29tcGxldGVfd3EpOwo+ICAgCj4gLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndnQtPmRldl9w
cml2LCBpKSB7Cj4gKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndnQtPmk5MTUsIGkpIHsKPiAg
IAkJaW5pdF93YWl0cXVldWVfaGVhZCgmc2NoZWR1bGVyLT53YWl0cVtpXSk7Cj4gICAKPiAgIAkJ
cGFyYW0gPSBremFsbG9jKHNpemVvZigqcGFyYW0pLCBHRlBfS0VSTkVMKTsKPiBAQCAtMTE1Miw3
ICsxMTUyLDcgQEAgdm9pZCBpbnRlbF92Z3B1X2NsZWFuX3N1Ym1pc3Npb24oc3RydWN0IGludGVs
X3ZncHUgKnZncHUpCj4gICAJaW50ZWxfdmdwdV9zZWxlY3Rfc3VibWlzc2lvbl9vcHModmdwdSwg
QUxMX0VOR0lORVMsIDApOwo+ICAgCj4gICAJaTkxNV9jb250ZXh0X3BwZ3R0X3Jvb3RfcmVzdG9y
ZShzLCBpOTE1X3ZtX3RvX3BwZ3R0KHMtPnNoYWRvd1swXS0+Z2VtX2NvbnRleHQtPnZtKSk7Cj4g
LQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCB2Z3B1LT5ndnQtPmRldl9wcml2LCBpZCkKPiArCWZv
cl9lYWNoX2VuZ2luZShlbmdpbmUsIHZncHUtPmd2dC0+aTkxNSwgaWQpCj4gICAJCWludGVsX2Nv
bnRleHRfdW5waW4ocy0+c2hhZG93W2lkXSk7Cj4gICAKPiAgIAlrbWVtX2NhY2hlX2Rlc3Ryb3ko
cy0+d29ya2xvYWRzKTsKPiBAQCAtMTIxMiwxMyArMTIxMiwxMyBAQCBpbnQgaW50ZWxfdmdwdV9z
ZXR1cF9zdWJtaXNzaW9uKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQo+ICAgCWVudW0gaW50ZWxf
ZW5naW5lX2lkIGk7Cj4gICAJaW50IHJldDsKPiAgIAo+IC0JY3R4ID0gaTkxNV9nZW1fY29udGV4
dF9jcmVhdGVfZ3Z0KCZ2Z3B1LT5ndnQtPmRldl9wcml2LT5kcm0pOwo+ICsJY3R4ID0gaTkxNV9n
ZW1fY29udGV4dF9jcmVhdGVfZ3Z0KCZ2Z3B1LT5ndnQtPmk5MTUtPmRybSk7Cj4gICAJaWYgKElT
X0VSUihjdHgpKQo+ICAgCQlyZXR1cm4gUFRSX0VSUihjdHgpOwo+ICAgCj4gICAJaTkxNV9jb250
ZXh0X3BwZ3R0X3Jvb3Rfc2F2ZShzLCBpOTE1X3ZtX3RvX3BwZ3R0KGN0eC0+dm0pKTsKPiAgIAo+
IC0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgdmdwdS0+Z3Z0LT5kZXZfcHJpdiwgaSkgewo+ICsJ
Zm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgdmdwdS0+Z3Z0LT5pOTE1LCBpKSB7Cj4gICAJCXN0cnVj
dCBpbnRlbF9jb250ZXh0ICpjZTsKPiAgIAo+ICAgCQlJTklUX0xJU1RfSEVBRCgmcy0+d29ya2xv
YWRfcV9oZWFkW2ldKTsKPiBAQCAtMTI2MCw3ICsxMjYwLDcgQEAgaW50IGludGVsX3ZncHVfc2V0
dXBfc3VibWlzc2lvbihzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKPiAgIAo+ICAgb3V0X3NoYWRv
d19jdHg6Cj4gICAJaTkxNV9jb250ZXh0X3BwZ3R0X3Jvb3RfcmVzdG9yZShzLCBpOTE1X3ZtX3Rv
X3BwZ3R0KGN0eC0+dm0pKTsKPiAtCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIHZncHUtPmd2dC0+
ZGV2X3ByaXYsIGkpIHsKPiArCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIHZncHUtPmd2dC0+aTkx
NSwgaSkgewo+ICAgCQlpZiAoSVNfRVJSKHMtPnNoYWRvd1tpXSkpCj4gICAJCQlicmVhazsKPiAg
IAo+IEBAIC0xNDM5LDcgKzE0MzksNyBAQCBpbnRlbF92Z3B1X2NyZWF0ZV93b3JrbG9hZChzdHJ1
Y3QgaW50ZWxfdmdwdSAqdmdwdSwgaW50IHJpbmdfaWQsCj4gICAJc3RydWN0IGxpc3RfaGVhZCAq
cSA9IHdvcmtsb2FkX3FfaGVhZCh2Z3B1LCByaW5nX2lkKTsKPiAgIAlzdHJ1Y3QgaW50ZWxfdmdw
dV93b3JrbG9hZCAqbGFzdF93b3JrbG9hZCA9IGdldF9sYXN0X3dvcmtsb2FkKHEpOwo+ICAgCXN0
cnVjdCBpbnRlbF92Z3B1X3dvcmtsb2FkICp3b3JrbG9hZCA9IE5VTEw7Cj4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2Z3B1LT5ndnQtPmRldl9wcml2Owo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2Z3B1LT5ndnQtPmk5MTU7Cj4gICAJdTY0IHJpbmdf
Y29udGV4dF9ncGE7Cj4gICAJdTMyIGhlYWQsIHRhaWwsIHN0YXJ0LCBjdGwsIGN0eF9jdGwsIHBl
cl9jdHgsIGluZGlyZWN0X2N0eDsKPiAgIAl1MzIgZ3Vlc3RfaGVhZDsKPiBAQCAtMTUyNiwxMSAr
MTUyNiwxMSBAQCBpbnRlbF92Z3B1X2NyZWF0ZV93b3JrbG9hZChzdHJ1Y3QgaW50ZWxfdmdwdSAq
dmdwdSwgaW50IHJpbmdfaWQsCj4gICAJICogYXMgdGhlcmUgaXMgb25seSBvbmUgcHJlLWFsbG9j
YXRlZCBidWYtb2JqIGZvciBzaGFkb3cuCj4gICAJICovCj4gICAJaWYgKGxpc3RfZW1wdHkod29y
a2xvYWRfcV9oZWFkKHZncHUsIHJpbmdfaWQpKSkgewo+IC0JCWludGVsX3J1bnRpbWVfcG1fZ2V0
KGRldl9wcml2KTsKPiAtCQltdXRleF9sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7
Cj4gKwkJaW50ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7Cj4gKwkJbXV0ZXhfbG9jaygmaTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAJCXJldCA9IGludGVsX2d2dF9zY2FuX2FuZF9zaGFkb3df
d29ya2xvYWQod29ya2xvYWQpOwo+IC0JCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1
Y3RfbXV0ZXgpOwo+IC0JCWludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tlZChkZXZfcHJpdik7
Cj4gKwkJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiArCQlpbnRlbF9y
dW50aW1lX3BtX3B1dF91bmNoZWNrZWQoaTkxNSk7Cj4gICAJfQo+ICAgCj4gICAJaWYgKHJldCkg
ewo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvdmdwdS5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3Z0L3ZncHUuYwo+IGluZGV4IDQ0Y2UzYzJiOWFjMS4uYTMxMTczN2M5
NjMzIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC92Z3B1LmMKPiArKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvdmdwdS5jCj4gQEAgLTE0OCwxMCArMTQ4LDEwIEBA
IGludCBpbnRlbF9ndnRfaW5pdF92Z3B1X3R5cGVzKHN0cnVjdCBpbnRlbF9ndnQgKmd2dCkKPiAg
IAkJZ3Z0LT50eXBlc1tpXS5hdmFpbF9pbnN0YW5jZSA9IG1pbihsb3dfYXZhaWwgLyB2Z3B1X3R5
cGVzW2ldLmxvd19tbSwKPiAgIAkJCQkJCSAgIGhpZ2hfYXZhaWwgLyB2Z3B1X3R5cGVzW2ldLmhp
Z2hfbW0pOwo+ICAgCj4gLQkJaWYgKElTX0dFTihndnQtPmRldl9wcml2LCA4KSkKPiArCQlpZiAo
SVNfR0VOKGd2dC0+aTkxNSwgOCkpCj4gICAJCQlzcHJpbnRmKGd2dC0+dHlwZXNbaV0ubmFtZSwg
IkdWVGdfVjRfJXMiLAo+ICAgCQkJCQkJdmdwdV90eXBlc1tpXS5uYW1lKTsKPiAtCQllbHNlIGlm
IChJU19HRU4oZ3Z0LT5kZXZfcHJpdiwgOSkpCj4gKwkJZWxzZSBpZiAoSVNfR0VOKGd2dC0+aTkx
NSwgOSkpCj4gICAJCQlzcHJpbnRmKGd2dC0+dHlwZXNbaV0ubmFtZSwgIkdWVGdfVjVfJXMiLAo+
ICAgCQkJCQkJdmdwdV90eXBlc1tpXS5uYW1lKTsKPiAgIAo+IEBAIC00MjksNyArNDI5LDcgQEAg
c3RhdGljIHN0cnVjdCBpbnRlbF92Z3B1ICpfX2ludGVsX2d2dF9jcmVhdGVfdmdwdShzdHJ1Y3Qg
aW50ZWxfZ3Z0ICpndnQsCj4gICAJCWdvdG8gb3V0X2NsZWFuX3NjaGVkX3BvbGljeTsKPiAgIAo+
ICAgCS8qVE9ETzogYWRkIG1vcmUgcGxhdGZvcm1zIHN1cHBvcnQgKi8KPiAtCWlmIChJU19TS1lM
QUtFKGd2dC0+ZGV2X3ByaXYpIHx8IElTX0tBQllMQUtFKGd2dC0+ZGV2X3ByaXYpKQo+ICsJaWYg
KElTX1NLWUxBS0UoZ3Z0LT5pOTE1KSB8fCBJU19LQUJZTEFLRShndnQtPmk5MTUpKQo+ICAgCQly
ZXQgPSBpbnRlbF9ndnRfaHlwZXJ2aXNvcl9zZXRfZWRpZCh2Z3B1LCBQT1JUX0QpOwo+ICAgCWlm
IChyZXQpCj4gICAJCWdvdG8gb3V0X2NsZWFuX3NjaGVkX3BvbGljeTsKPiBkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9jbWRfcGFyc2VyLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2NtZF9wYXJzZXIuYwo+IGluZGV4IGEyOGJjZDJkN2MwOS4uZTlkMDc2MTY3YjI0
IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfY21kX3BhcnNlci5jCj4g
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9jbWRfcGFyc2VyLmMKPiBAQCAtMTM0Miwy
MSArMTM0MiwyMSBAQCBpbnQgaW50ZWxfZW5naW5lX2NtZF9wYXJzZXIoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lLAo+ICAgCj4gICAvKioKPiAgICAqIGk5MTVfY21kX3BhcnNlcl9nZXRf
dmVyc2lvbigpIC0gZ2V0IHRoZSBjbWQgcGFyc2VyIHZlcnNpb24gbnVtYmVyCj4gLSAqIEBkZXZf
cHJpdjogaTkxNSBkZXZpY2UgcHJpdmF0ZQo+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UgcHJpdmF0
ZQo+ICAgICoKPiAgICAqIFRoZSBjbWQgcGFyc2VyIG1haW50YWlucyBhIHNpbXBsZSBpbmNyZWFz
aW5nIGludGVnZXIgdmVyc2lvbiBudW1iZXIgc3VpdGFibGUKPiAgICAqIGZvciBwYXNzaW5nIHRv
IHVzZXJzcGFjZSBjbGllbnRzIHRvIGRldGVybWluZSB3aGF0IG9wZXJhdGlvbnMgYXJlIHBlcm1p
dHRlZC4KPiAgICAqCj4gICAgKiBSZXR1cm46IHRoZSBjdXJyZW50IHZlcnNpb24gbnVtYmVyIG9m
IHRoZSBjbWQgcGFyc2VyCj4gICAgKi8KPiAtaW50IGk5MTVfY21kX3BhcnNlcl9nZXRfdmVyc2lv
bihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK2ludCBpOTE1X2NtZF9wYXJz
ZXJfZ2V0X3ZlcnNpb24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJ
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwo+ICAgCWVudW0gaW50ZWxfZW5naW5lX2lk
IGlkOwo+ICAgCWJvb2wgYWN0aXZlID0gZmFsc2U7Cj4gICAKPiAgIAkvKiBJZiB0aGUgY29tbWFu
ZCBwYXJzZXIgaXMgbm90IGVuYWJsZWQsIHJlcG9ydCAwIC0gdW5zdXBwb3J0ZWQgKi8KPiAtCWZv
cl9lYWNoX2VuZ2luZShlbmdpbmUsIGRldl9wcml2LCBpZCkgewo+ICsJZm9yX2VhY2hfZW5naW5l
KGVuZ2luZSwgaTkxNSwgaWQpIHsKPiAgIAkJaWYgKGludGVsX2VuZ2luZV9uZWVkc19jbWRfcGFy
c2VyKGVuZ2luZSkpIHsKPiAgIAkJCWFjdGl2ZSA9IHRydWU7Cj4gICAJCQlicmVhazsKPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwo+IGluZGV4IDAyNmZiNDYwMjBmNi4uZmVjMDE4NTg2
ODVkIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCj4g
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKPiBAQCAtNTUsMTcgKzU1
LDE3IEBAIHN0YXRpYyBpbmxpbmUgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKm5vZGVfdG9faTkx
NShzdHJ1Y3QgZHJtX2luZm9fbm9kZSAqbm9kZSkKPiAgIAo+ICAgc3RhdGljIGludCBpOTE1X2Nh
cGFiaWxpdGllcyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gICB7Cj4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7
Cj4gLQljb25zdCBzdHJ1Y3QgaW50ZWxfZGV2aWNlX2luZm8gKmluZm8gPSBJTlRFTF9JTkZPKGRl
dl9wcml2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1
KG0tPnByaXZhdGUpOwo+ICsJY29uc3Qgc3RydWN0IGludGVsX2RldmljZV9pbmZvICppbmZvID0g
SU5URUxfSU5GTyhpOTE1KTsKPiAgIAlzdHJ1Y3QgZHJtX3ByaW50ZXIgcCA9IGRybV9zZXFfZmls
ZV9wcmludGVyKG0pOwo+ICAgCj4gLQlzZXFfcHJpbnRmKG0sICJnZW46ICVkXG4iLCBJTlRFTF9H
RU4oZGV2X3ByaXYpKTsKPiArCXNlcV9wcmludGYobSwgImdlbjogJWRcbiIsIElOVEVMX0dFTihp
OTE1KSk7Cj4gICAJc2VxX3ByaW50ZihtLCAicGxhdGZvcm06ICVzXG4iLCBpbnRlbF9wbGF0Zm9y
bV9uYW1lKGluZm8tPnBsYXRmb3JtKSk7Cj4gLQlzZXFfcHJpbnRmKG0sICJwY2g6ICVkXG4iLCBJ
TlRFTF9QQ0hfVFlQRShkZXZfcHJpdikpOwo+ICsJc2VxX3ByaW50ZihtLCAicGNoOiAlZFxuIiwg
SU5URUxfUENIX1RZUEUoaTkxNSkpOwo+ICAgCj4gICAJaW50ZWxfZGV2aWNlX2luZm9fZHVtcF9m
bGFncyhpbmZvLCAmcCk7Cj4gLQlpbnRlbF9kZXZpY2VfaW5mb19kdW1wX3J1bnRpbWUoUlVOVElN
RV9JTkZPKGRldl9wcml2KSwgJnApOwo+IC0JaW50ZWxfZHJpdmVyX2NhcHNfcHJpbnQoJmRldl9w
cml2LT5jYXBzLCAmcCk7Cj4gKwlpbnRlbF9kZXZpY2VfaW5mb19kdW1wX3J1bnRpbWUoUlVOVElN
RV9JTkZPKGk5MTUpLCAmcCk7Cj4gKwlpbnRlbF9kcml2ZXJfY2Fwc19wcmludCgmaTkxNS0+Y2Fw
cywgJnApOwo+ICAgCj4gICAJa2VybmVsX3BhcmFtX2xvY2soVEhJU19NT0RVTEUpOwo+ICAgCWk5
MTVfcGFyYW1zX2R1bXAoJmk5MTVfbW9kcGFyYW1zLCAmcCk7Cj4gQEAgLTEzNyw3ICsxMzcsNyBA
QCBzdHJpbmdpZnlfcGFnZV9zaXplcyh1bnNpZ25lZCBpbnQgcGFnZV9zaXplcywgY2hhciAqYnVm
LCBzaXplX3QgbGVuKQo+ICAgc3RhdGljIHZvaWQKPiAgIGRlc2NyaWJlX29iaihzdHJ1Y3Qgc2Vx
X2ZpbGUgKm0sIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCj4gICB7Cj4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KG9iai0+YmFzZS5kZXYpOwo+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KG9iai0+YmFzZS5kZXYp
Owo+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKPiAgIAlzdHJ1Y3QgaTkxNV92
bWEgKnZtYTsKPiAgIAl1bnNpZ25lZCBpbnQgZnJvbnRidWZmZXJfYml0czsKPiBAQCAtMTU1LDcg
KzE1NSw3IEBAIGRlc2NyaWJlX29iaihzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHN0cnVjdCBkcm1faTkx
NV9nZW1fb2JqZWN0ICpvYmopCj4gICAJCSAgIG9iai0+YmFzZS5zaXplIC8gMTAyNCwKPiAgIAkJ
ICAgb2JqLT5yZWFkX2RvbWFpbnMsCj4gICAJCSAgIG9iai0+d3JpdGVfZG9tYWluLAo+IC0JCSAg
IGk5MTVfY2FjaGVfbGV2ZWxfc3RyKGRldl9wcml2LCBvYmotPmNhY2hlX2xldmVsKSwKPiArCQkg
ICBpOTE1X2NhY2hlX2xldmVsX3N0cihpOTE1LCBvYmotPmNhY2hlX2xldmVsKSwKPiAgIAkJICAg
b2JqLT5tbS5kaXJ0eSA/ICIgZGlydHkiIDogIiIsCj4gICAJCSAgIG9iai0+bW0ubWFkdiA9PSBJ
OTE1X01BRFZfRE9OVE5FRUQgPyAiIHB1cmdlYWJsZSIgOiAiIik7Cj4gICAJaWYgKG9iai0+YmFz
ZS5uYW1lKQo+IEBAIC0yOTYsNyArMjk2LDcgQEAgc3RhdGljIGludCBwZXJfZmlsZV9zdGF0cyhp
bnQgaWQsIHZvaWQgKnB0ciwgdm9pZCAqZGF0YSkKPiAgIH0gd2hpbGUgKDApCj4gICAKPiAgIHN0
YXRpYyB2b2lkIHByaW50X2JhdGNoX3Bvb2xfc3RhdHMoc3RydWN0IHNlcV9maWxlICptLAo+IC0J
CQkJICAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICsJCQkJICAgc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RydWN0IGRybV9pOTE1X2dlbV9v
YmplY3QgKm9iajsKPiAgIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4gQEAgLTMw
NCw3ICszMDQsNyBAQCBzdGF0aWMgdm9pZCBwcmludF9iYXRjaF9wb29sX3N0YXRzKHN0cnVjdCBz
ZXFfZmlsZSAqbSwKPiAgIAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKPiAgIAlpbnQgajsKPiAg
IAo+IC0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYsIGlkKSB7Cj4gKwlmb3JfZWFj
aF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgewo+ICAgCQlmb3IgKGogPSAwOyBqIDwgQVJSQVlf
U0laRShlbmdpbmUtPmJhdGNoX3Bvb2wuY2FjaGVfbGlzdCk7IGorKykgewo+ICAgCQkJbGlzdF9m
b3JfZWFjaF9lbnRyeShvYmosCj4gICAJCQkJCSAgICAmZW5naW5lLT5iYXRjaF9wb29sLmNhY2hl
X2xpc3Rbal0sCj4gQEAgLTM4Miw4ICszODIsOCBAQCBzdGF0aWMgaW50IGk5MTVfZ2VtX29iamVj
dF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiAgIAo+ICAgc3RhdGljIGlu
dCBpOTE1X2dlbV9iYXRjaF9wb29sX2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRh
KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19p
OTE1KG0tPnByaXZhdGUpOwo+IC0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZkZXZfcHJpdi0+
ZHJtOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+
cHJpdmF0ZSk7Cj4gKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmk5MTUtPmRybTsKPiAgIAlz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwo+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZTsKPiAgIAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKPiBAQCAtMzk0LDcgKzM5
NCw3IEBAIHN0YXRpYyBpbnQgaTkxNV9nZW1fYmF0Y2hfcG9vbF9pbmZvKHN0cnVjdCBzZXFfZmls
ZSAqbSwgdm9pZCAqZGF0YSkKPiAgIAlpZiAocmV0KQo+ICAgCQlyZXR1cm4gcmV0Owo+ICAgCj4g
LQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpIHsKPiArCWZvcl9lYWNoX2Vu
Z2luZShlbmdpbmUsIGk5MTUsIGlkKSB7Cj4gICAJCWZvciAoaiA9IDA7IGogPCBBUlJBWV9TSVpF
KGVuZ2luZS0+YmF0Y2hfcG9vbC5jYWNoZV9saXN0KTsgaisrKSB7Cj4gICAJCQlpbnQgY291bnQ7
Cj4gICAKPiBAQCAtNDI3LDE1ICs0MjcsMTUgQEAgc3RhdGljIGludCBpOTE1X2dlbV9iYXRjaF9w
b29sX2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ICAgCj4gICBzdGF0aWMg
dm9pZCBnZW44X2Rpc3BsYXlfaW50ZXJydXB0X2luZm8oc3RydWN0IHNlcV9maWxlICptKQo+ICAg
ewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0t
PnByaXZhdGUpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5
MTUobS0+cHJpdmF0ZSk7Cj4gICAJaW50IHBpcGU7Cj4gICAKPiAtCWZvcl9lYWNoX3BpcGUoZGV2
X3ByaXYsIHBpcGUpIHsKPiArCWZvcl9lYWNoX3BpcGUoaTkxNSwgcGlwZSkgewo+ICAgCQllbnVt
IGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIHBvd2VyX2RvbWFpbjsKPiAgIAkJaW50ZWxfd2Fr
ZXJlZl90IHdha2VyZWY7Cj4gICAKPiAgIAkJcG93ZXJfZG9tYWluID0gUE9XRVJfRE9NQUlOX1BJ
UEUocGlwZSk7Cj4gLQkJd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJs
ZWQoZGV2X3ByaXYsCj4gKwkJd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2Vu
YWJsZWQoaTkxNSwKPiAgIAkJCQkJCQkgICAgIHBvd2VyX2RvbWFpbik7Cj4gICAJCWlmICghd2Fr
ZXJlZikgewo+ICAgCQkJc2VxX3ByaW50ZihtLCAiUGlwZSAlYyBwb3dlciBkaXNhYmxlZFxuIiwK
PiBAQCAtNDUyLDcgKzQ1Miw3IEBAIHN0YXRpYyB2b2lkIGdlbjhfZGlzcGxheV9pbnRlcnJ1cHRf
aW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0pCj4gICAJCQkgICBwaXBlX25hbWUocGlwZSksCj4gICAJ
CQkgICBJOTE1X1JFQUQoR0VOOF9ERV9QSVBFX0lFUihwaXBlKSkpOwo+ICAgCj4gLQkJaW50ZWxf
ZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIHBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gKwkJ
aW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgcG93ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiAg
IAl9Cj4gICAKPiAgIAlzZXFfcHJpbnRmKG0sICJEaXNwbGF5IEVuZ2luZSBwb3J0IGludGVycnVw
dCBtYXNrOlx0JTA4eFxuIiwKPiBAQCAtNDc5LDE1ICs0NzksMTUgQEAgc3RhdGljIHZvaWQgZ2Vu
OF9kaXNwbGF5X2ludGVycnVwdF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSkKPiAgIAo+ICAgc3Rh
dGljIGludCBpOTE1X2ludGVycnVwdF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0
YSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9f
aTkxNShtLT5wcml2YXRlKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9k
ZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZTsKPiAgIAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2Fr
ZXJlZjsKPiAgIAlpbnQgaSwgcGlwZTsKPiAgIAo+IC0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVf
cG1fZ2V0KGRldl9wcml2KTsKPiArCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1
KTsKPiAgIAo+IC0JaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfQ0hF
UlJZVklFVyhpOTE1KSkgewo+ICAgCQlpbnRlbF93YWtlcmVmX3QgcHJlZjsKPiAgIAo+ICAgCQlz
ZXFfcHJpbnRmKG0sICJNYXN0ZXIgSW50ZXJydXB0IENvbnRyb2w6XHQlMDh4XG4iLAo+IEBAIC01
MDEsMTEgKzUwMSwxMSBAQCBzdGF0aWMgaW50IGk5MTVfaW50ZXJydXB0X2luZm8oc3RydWN0IHNl
cV9maWxlICptLCB2b2lkICpkYXRhKQo+ICAgCQkJICAgSTkxNV9SRUFEKFZMVl9JSVJfUlcpKTsK
PiAgIAkJc2VxX3ByaW50ZihtLCAiRGlzcGxheSBJTVI6XHQlMDh4XG4iLAo+ICAgCQkJICAgSTkx
NV9SRUFEKFZMVl9JTVIpKTsKPiAtCQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKSB7Cj4g
KwkJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKSB7Cj4gICAJCQllbnVtIGludGVsX2Rpc3BsYXlf
cG93ZXJfZG9tYWluIHBvd2VyX2RvbWFpbjsKPiAgIAo+ICAgCQkJcG93ZXJfZG9tYWluID0gUE9X
RVJfRE9NQUlOX1BJUEUocGlwZSk7Cj4gLQkJCXByZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dl
dF9pZl9lbmFibGVkKGRldl9wcml2LAo+ICsJCQlwcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9n
ZXRfaWZfZW5hYmxlZChpOTE1LAo+ICAgCQkJCQkJCQkgIHBvd2VyX2RvbWFpbik7Cj4gICAJCQlp
ZiAoIXByZWYpIHsKPiAgIAkJCQlzZXFfcHJpbnRmKG0sICJQaXBlICVjIHBvd2VyIGRpc2FibGVk
XG4iLAo+IEBAIC01MTcsMTcgKzUxNywxNyBAQCBzdGF0aWMgaW50IGk5MTVfaW50ZXJydXB0X2lu
Zm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ICAgCQkJCSAgIHBpcGVfbmFtZShw
aXBlKSwKPiAgIAkJCQkgICBJOTE1X1JFQUQoUElQRVNUQVQocGlwZSkpKTsKPiAgIAo+IC0JCQlp
bnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwgcG93ZXJfZG9tYWluLCBwcmVmKTsKPiAr
CQkJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgcG93ZXJfZG9tYWluLCBwcmVmKTsKPiAg
IAkJfQo+ICAgCj4gLQkJcHJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGRldl9wcml2LCBQ
T1dFUl9ET01BSU5fSU5JVCk7Cj4gKwkJcHJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGk5
MTUsIFBPV0VSX0RPTUFJTl9JTklUKTsKPiAgIAkJc2VxX3ByaW50ZihtLCAiUG9ydCBob3RwbHVn
Olx0JTA4eFxuIiwKPiAgIAkJCSAgIEk5MTVfUkVBRChQT1JUX0hPVFBMVUdfRU4pKTsKPiAgIAkJ
c2VxX3ByaW50ZihtLCAiRFBGTElQU1RBVDpcdCUwOHhcbiIsCj4gICAJCQkgICBJOTE1X1JFQUQo
VkxWX0RQRkxJUFNUQVQpKTsKPiAgIAkJc2VxX3ByaW50ZihtLCAiRFBJTlZHVFQ6XHQlMDh4XG4i
LAo+ICAgCQkJICAgSTkxNV9SRUFEKERQSU5WR1RUKSk7Cj4gLQkJaW50ZWxfZGlzcGxheV9wb3dl
cl9wdXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9JTklULCBwcmVmKTsKPiArCQlpbnRlbF9kaXNw
bGF5X3Bvd2VyX3B1dChpOTE1LCBQT1dFUl9ET01BSU5fSU5JVCwgcHJlZik7Cj4gICAKPiAgIAkJ
Zm9yIChpID0gMDsgaSA8IDQ7IGkrKykgewo+ICAgCQkJc2VxX3ByaW50ZihtLCAiR1QgSW50ZXJy
dXB0IElNUiAlZDpcdCUwOHhcbiIsCj4gQEAgLTU0NCw3ICs1NDQsNyBAQCBzdGF0aWMgaW50IGk5
MTVfaW50ZXJydXB0X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ICAgCQkJ
ICAgSTkxNV9SRUFEKEdFTjhfUENVX0lJUikpOwo+ICAgCQlzZXFfcHJpbnRmKG0sICJQQ1UgaW50
ZXJydXB0IGVuYWJsZTpcdCUwOHhcbiIsCj4gICAJCQkgICBJOTE1X1JFQUQoR0VOOF9QQ1VfSUVS
KSk7Cj4gLQl9IGVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpIHsKPiArCX0gZWxz
ZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKSB7Cj4gICAJCXNlcV9wcmludGYobSwgIk1hc3Rl
ciBJbnRlcnJ1cHQgQ29udHJvbDogICUwOHhcbiIsCj4gICAJCQkgICBJOTE1X1JFQUQoR0VOMTFf
R0ZYX01TVFJfSVJRKSk7Cj4gICAKPiBAQCAtNTY1LDcgKzU2NSw3IEBAIHN0YXRpYyBpbnQgaTkx
NV9pbnRlcnJ1cHRfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gICAJCQkg
ICBJOTE1X1JFQUQoR0VOMTFfRElTUExBWV9JTlRfQ1RMKSk7Cj4gICAKPiAgIAkJZ2VuOF9kaXNw
bGF5X2ludGVycnVwdF9pbmZvKG0pOwo+IC0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
ID49IDgpIHsKPiArCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDgpIHsKPiAgIAkJc2Vx
X3ByaW50ZihtLCAiTWFzdGVyIEludGVycnVwdCBDb250cm9sOlx0JTA4eFxuIiwKPiAgIAkJCSAg
IEk5MTVfUkVBRChHRU44X01BU1RFUl9JUlEpKTsKPiAgIAo+IEBAIC01NzksNyArNTc5LDcgQEAg
c3RhdGljIGludCBpOTE1X2ludGVycnVwdF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAq
ZGF0YSkKPiAgIAkJfQo+ICAgCj4gICAJCWdlbjhfZGlzcGxheV9pbnRlcnJ1cHRfaW5mbyhtKTsK
PiAtCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAo
SVNfVkFMTEVZVklFVyhpOTE1KSkgewo+ICAgCQlzZXFfcHJpbnRmKG0sICJEaXNwbGF5IElFUjpc
dCUwOHhcbiIsCj4gICAJCQkgICBJOTE1X1JFQUQoVkxWX0lFUikpOwo+ICAgCQlzZXFfcHJpbnRm
KG0sICJEaXNwbGF5IElJUjpcdCUwOHhcbiIsCj4gQEAgLTU4OCwxMiArNTg4LDEyIEBAIHN0YXRp
YyBpbnQgaTkxNV9pbnRlcnJ1cHRfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEp
Cj4gICAJCQkgICBJOTE1X1JFQUQoVkxWX0lJUl9SVykpOwo+ICAgCQlzZXFfcHJpbnRmKG0sICJE
aXNwbGF5IElNUjpcdCUwOHhcbiIsCj4gICAJCQkgICBJOTE1X1JFQUQoVkxWX0lNUikpOwo+IC0J
CWZvcl9lYWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpIHsKPiArCQlmb3JfZWFjaF9waXBlKGk5MTUs
IHBpcGUpIHsKPiAgIAkJCWVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gcG93ZXJfZG9t
YWluOwo+ICAgCQkJaW50ZWxfd2FrZXJlZl90IHByZWY7Cj4gICAKPiAgIAkJCXBvd2VyX2RvbWFp
biA9IFBPV0VSX0RPTUFJTl9QSVBFKHBpcGUpOwo+IC0JCQlwcmVmID0gaW50ZWxfZGlzcGxheV9w
b3dlcl9nZXRfaWZfZW5hYmxlZChkZXZfcHJpdiwKPiArCQkJcHJlZiA9IGludGVsX2Rpc3BsYXlf
cG93ZXJfZ2V0X2lmX2VuYWJsZWQoaTkxNSwKPiAgIAkJCQkJCQkJICBwb3dlcl9kb21haW4pOwo+
ICAgCQkJaWYgKCFwcmVmKSB7Cj4gICAJCQkJc2VxX3ByaW50ZihtLCAiUGlwZSAlYyBwb3dlciBk
aXNhYmxlZFxuIiwKPiBAQCAtNjA0LDcgKzYwNCw3IEBAIHN0YXRpYyBpbnQgaTkxNV9pbnRlcnJ1
cHRfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gICAJCQlzZXFfcHJpbnRm
KG0sICJQaXBlICVjIHN0YXQ6XHQlMDh4XG4iLAo+ICAgCQkJCSAgIHBpcGVfbmFtZShwaXBlKSwK
PiAgIAkJCQkgICBJOTE1X1JFQUQoUElQRVNUQVQocGlwZSkpKTsKPiAtCQkJaW50ZWxfZGlzcGxh
eV9wb3dlcl9wdXQoZGV2X3ByaXYsIHBvd2VyX2RvbWFpbiwgcHJlZik7Cj4gKwkJCWludGVsX2Rp
c3BsYXlfcG93ZXJfcHV0KGk5MTUsIHBvd2VyX2RvbWFpbiwgcHJlZik7Cj4gICAJCX0KPiAgIAo+
ICAgCQlzZXFfcHJpbnRmKG0sICJNYXN0ZXIgSUVSOlx0JTA4eFxuIiwKPiBAQCAtNjMxLDE0ICs2
MzEsMTQgQEAgc3RhdGljIGludCBpOTE1X2ludGVycnVwdF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAq
bSwgdm9pZCAqZGF0YSkKPiAgIAkJc2VxX3ByaW50ZihtLCAiRFBJTlZHVFQ6XHQlMDh4XG4iLAo+
ICAgCQkJICAgSTkxNV9SRUFEKERQSU5WR1RUKSk7Cj4gICAKPiAtCX0gZWxzZSBpZiAoIUhBU19Q
Q0hfU1BMSVQoZGV2X3ByaXYpKSB7Cj4gKwl9IGVsc2UgaWYgKCFIQVNfUENIX1NQTElUKGk5MTUp
KSB7Cj4gICAJCXNlcV9wcmludGYobSwgIkludGVycnVwdCBlbmFibGU6ICAgICUwOHhcbiIsCj4g
ICAJCQkgICBJOTE1X1JFQUQoR0VOMl9JRVIpKTsKPiAgIAkJc2VxX3ByaW50ZihtLCAiSW50ZXJy
dXB0IGlkZW50aXR5OiAgJTA4eFxuIiwKPiAgIAkJCSAgIEk5MTVfUkVBRChHRU4yX0lJUikpOwo+
ICAgCQlzZXFfcHJpbnRmKG0sICJJbnRlcnJ1cHQgbWFzazogICAgICAlMDh4XG4iLAo+ICAgCQkJ
ICAgSTkxNV9SRUFEKEdFTjJfSU1SKSk7Cj4gLQkJZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlw
ZSkKPiArCQlmb3JfZWFjaF9waXBlKGk5MTUsIHBpcGUpCj4gICAJCQlzZXFfcHJpbnRmKG0sICJQ
aXBlICVjIHN0YXQ6ICAgICAgICAgJTA4eFxuIiwKPiAgIAkJCQkgICBwaXBlX25hbWUocGlwZSks
Cj4gICAJCQkJICAgSTkxNV9SRUFEKFBJUEVTVEFUKHBpcGUpKSk7Cj4gQEAgLTY2Myw3ICs2NjMs
NyBAQCBzdGF0aWMgaW50IGk5MTVfaW50ZXJydXB0X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2
b2lkICpkYXRhKQo+ICAgCQkJICAgSTkxNV9SRUFEKEdUSU1SKSk7Cj4gICAJfQo+ICAgCj4gLQlp
ZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkgewo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+
PSAxMSkgewo+ICAgCQlzZXFfcHJpbnRmKG0sICJSQ1MgSW50ciBNYXNrOlx0ICUwOHhcbiIsCj4g
ICAJCQkgICBJOTE1X1JFQUQoR0VOMTFfUkNTMF9SU1ZEX0lOVFJfTUFTSykpOwo+ICAgCQlzZXFf
cHJpbnRmKG0sICJCQ1MgSW50ciBNYXNrOlx0ICUwOHhcbiIsCj4gQEAgLTY4MywzNSArNjgzLDM1
IEBAIHN0YXRpYyBpbnQgaTkxNV9pbnRlcnJ1cHRfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZv
aWQgKmRhdGEpCj4gICAJCXNlcV9wcmludGYobSwgIkd1bml0L0NTTUUgSW50ciBNYXNrOlx0ICUw
OHhcbiIsCj4gICAJCQkgICBJOTE1X1JFQUQoR0VOMTFfR1VOSVRfQ1NNRV9JTlRSX01BU0spKTsK
PiAgIAo+IC0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDYpIHsKPiAtCQlmb3Jf
ZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpIHsKPiArCX0gZWxzZSBpZiAoSU5URUxf
R0VOKGk5MTUpID49IDYpIHsKPiArCQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkg
ewo+ICAgCQkJc2VxX3ByaW50ZihtLAo+ICAgCQkJCSAgICJHcmFwaGljcyBJbnRlcnJ1cHQgbWFz
ayAoJXMpOgklMDh4XG4iLAo+ICAgCQkJCSAgIGVuZ2luZS0+bmFtZSwgRU5HSU5FX1JFQUQoZW5n
aW5lLCBSSU5HX0lNUikpOwo+ICAgCQl9Cj4gICAJfQo+ICAgCj4gLQlpbnRlbF9ydW50aW1lX3Bt
X3B1dChkZXZfcHJpdiwgd2FrZXJlZik7Cj4gKwlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3
YWtlcmVmKTsKPiAgIAo+ICAgCXJldHVybiAwOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgaW50IGk5
MTVfZ2VtX2ZlbmNlX3JlZ3NfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUo
bS0+cHJpdmF0ZSk7Cj4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmRldl9wcml2LT5kcm07
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2
YXRlKTsKPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+ICAgCWludCBp
LCByZXQ7Cj4gICAKPiAgIAlyZXQgPSBtdXRleF9sb2NrX2ludGVycnVwdGlibGUoJmRldi0+c3Ry
dWN0X211dGV4KTsKPiAgIAlpZiAocmV0KQo+ICAgCQlyZXR1cm4gcmV0Owo+ICAgCj4gLQlzZXFf
cHJpbnRmKG0sICJUb3RhbCBmZW5jZXMgPSAlZFxuIiwgZGV2X3ByaXYtPm51bV9mZW5jZV9yZWdz
KTsKPiAtCWZvciAoaSA9IDA7IGkgPCBkZXZfcHJpdi0+bnVtX2ZlbmNlX3JlZ3M7IGkrKykgewo+
IC0JCXN0cnVjdCBpOTE1X3ZtYSAqdm1hID0gZGV2X3ByaXYtPmZlbmNlX3JlZ3NbaV0udm1hOwo+
ICsJc2VxX3ByaW50ZihtLCAiVG90YWwgZmVuY2VzID0gJWRcbiIsIGk5MTUtPm51bV9mZW5jZV9y
ZWdzKTsKPiArCWZvciAoaSA9IDA7IGkgPCBpOTE1LT5udW1fZmVuY2VfcmVnczsgaSsrKSB7Cj4g
KwkJc3RydWN0IGk5MTVfdm1hICp2bWEgPSBpOTE1LT5mZW5jZV9yZWdzW2ldLnZtYTsKPiAgIAo+
ICAgCQlzZXFfcHJpbnRmKG0sICJGZW5jZSAlZCwgcGluIGNvdW50ID0gJWQsIG9iamVjdCA9ICIs
Cj4gLQkJCSAgIGksIGRldl9wcml2LT5mZW5jZV9yZWdzW2ldLnBpbl9jb3VudCk7Cj4gKwkJCSAg
IGksIGk5MTUtPmZlbmNlX3JlZ3NbaV0ucGluX2NvdW50KTsKPiAgIAkJaWYgKCF2bWEpCj4gICAJ
CQlzZXFfcHV0cyhtLCAidW51c2VkIik7Cj4gICAJCWVsc2UKPiBAQCAtODI1LDE1ICs4MjUsMTUg
QEAgc3RhdGljIGNvbnN0IHN0cnVjdCBmaWxlX29wZXJhdGlvbnMgaTkxNV9lcnJvcl9zdGF0ZV9m
b3BzID0gewo+ICAgCj4gICBzdGF0aWMgaW50IGk5MTVfZnJlcXVlbmN5X2luZm8oc3RydWN0IHNl
cV9maWxlICptLCB2b2lkICp1bnVzZWQpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gLQlzdHJ1Y3QgaW50ZWxf
dW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsKPiAtCXN0cnVjdCBpbnRlbF9ycHMg
KnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gKwlzdHJ1Y3QgaW50ZWxfdW5jb3Jl
ICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwo+ICsJc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmk5
MTUtPmd0X3BtLnJwczsKPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiAgIAlpbnQgcmV0
ID0gMDsKPiAgIAo+IC0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsK
PiArCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKPiAgIAo+IC0JaWYgKElT
X0dFTihkZXZfcHJpdiwgNSkpIHsKPiArCWlmIChJU19HRU4oaTkxNSwgNSkpIHsKPiAgIAkJdTE2
IHJndnN3Y3RsID0gaW50ZWxfdW5jb3JlX3JlYWQxNih1bmNvcmUsIE1FTVNXQ1RMKTsKPiAgIAkJ
dTE2IHJndnN0YXQgPSBpbnRlbF91bmNvcmVfcmVhZDE2KHVuY29yZSwgTUVNU1RBVF9JTEspOwo+
ICAgCj4gQEAgLTg0Myw3ICs4NDMsNyBAQCBzdGF0aWMgaW50IGk5MTVfZnJlcXVlbmN5X2luZm8o
c3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCj4gICAJCQkgICBNRU1TVEFUX1ZJRF9T
SElGVCk7Cj4gICAJCXNlcV9wcmludGYobSwgIkN1cnJlbnQgUC1zdGF0ZTogJWRcbiIsCj4gICAJ
CQkgICAocmd2c3RhdCAmIE1FTVNUQVRfUFNUQVRFX01BU0spID4+IE1FTVNUQVRfUFNUQVRFX1NI
SUZUKTsKPiAtCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZ
VklFVyhkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJ
U19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gICAJCXUzMiBycG1vZGVjdGwsIGZyZXFfc3RzOwo+ICAg
Cj4gICAJCXJwbW9kZWN0bCA9IEk5MTVfUkVBRChHRU42X1JQX0NPTlRST0wpOwo+IEBAIC04NTUs
MzIgKzg1NSwzMiBAQCBzdGF0aWMgaW50IGk5MTVfZnJlcXVlbmN5X2luZm8oc3RydWN0IHNlcV9m
aWxlICptLCB2b2lkICp1bnVzZWQpCj4gICAJCQkgICB5ZXNubygocnBtb2RlY3RsICYgR0VONl9S
UF9NRURJQV9NT0RFX01BU0spID09Cj4gICAJCQkJICBHRU42X1JQX01FRElBX1NXX01PREUpKTsK
PiAgIAo+IC0JCXZsdl9wdW5pdF9nZXQoZGV2X3ByaXYpOwo+IC0JCWZyZXFfc3RzID0gdmx2X3B1
bml0X3JlYWQoZGV2X3ByaXYsIFBVTklUX1JFR19HUFVfRlJFUV9TVFMpOwo+IC0JCXZsdl9wdW5p
dF9wdXQoZGV2X3ByaXYpOwo+ICsJCXZsdl9wdW5pdF9nZXQoaTkxNSk7Cj4gKwkJZnJlcV9zdHMg
PSB2bHZfcHVuaXRfcmVhZChpOTE1LCBQVU5JVF9SRUdfR1BVX0ZSRVFfU1RTKTsKPiArCQl2bHZf
cHVuaXRfcHV0KGk5MTUpOwo+ICAgCj4gICAJCXNlcV9wcmludGYobSwgIlBVTklUX1JFR19HUFVf
RlJFUV9TVFM6IDB4JTA4eFxuIiwgZnJlcV9zdHMpOwo+IC0JCXNlcV9wcmludGYobSwgIkREUiBm
cmVxOiAlZCBNSHpcbiIsIGRldl9wcml2LT5tZW1fZnJlcSk7Cj4gKwkJc2VxX3ByaW50ZihtLCAi
RERSIGZyZXE6ICVkIE1IelxuIiwgaTkxNS0+bWVtX2ZyZXEpOwo+ICAgCj4gICAJCXNlcV9wcmlu
dGYobSwgImFjdHVhbCBHUFUgZnJlcTogJWQgTUh6XG4iLAo+IC0JCQkgICBpbnRlbF9ncHVfZnJl
cShkZXZfcHJpdiwgKGZyZXFfc3RzID4+IDgpICYgMHhmZikpOwo+ICsJCQkgICBpbnRlbF9ncHVf
ZnJlcShpOTE1LCAoZnJlcV9zdHMgPj4gOCkgJiAweGZmKSk7Cj4gICAKPiAgIAkJc2VxX3ByaW50
ZihtLCAiY3VycmVudCBHUFUgZnJlcTogJWQgTUh6XG4iLAo+IC0JCQkgICBpbnRlbF9ncHVfZnJl
cShkZXZfcHJpdiwgcnBzLT5jdXJfZnJlcSkpOwo+ICsJCQkgICBpbnRlbF9ncHVfZnJlcShpOTE1
LCBycHMtPmN1cl9mcmVxKSk7Cj4gICAKPiAgIAkJc2VxX3ByaW50ZihtLCAibWF4IEdQVSBmcmVx
OiAlZCBNSHpcbiIsCj4gLQkJCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMtPm1heF9m
cmVxKSk7Cj4gKwkJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUsIHJwcy0+bWF4X2ZyZXEpKTsKPiAg
IAo+ICAgCQlzZXFfcHJpbnRmKG0sICJtaW4gR1BVIGZyZXE6ICVkIE1IelxuIiwKPiAtCQkJICAg
aW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+bWluX2ZyZXEpKTsKPiArCQkJICAgaW50ZWxf
Z3B1X2ZyZXEoaTkxNSwgcnBzLT5taW5fZnJlcSkpOwo+ICAgCj4gICAJCXNlcV9wcmludGYobSwg
ImlkbGUgR1BVIGZyZXE6ICVkIE1IelxuIiwKPiAtCQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3By
aXYsIHJwcy0+aWRsZV9mcmVxKSk7Cj4gKwkJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUsIHJwcy0+
aWRsZV9mcmVxKSk7Cj4gICAKPiAgIAkJc2VxX3ByaW50ZihtLAo+ICAgCQkJICAgImVmZmljaWVu
dCAoUlBlKSBmcmVxdWVuY3k6ICVkIE1IelxuIiwKPiAtCQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2
X3ByaXYsIHJwcy0+ZWZmaWNpZW50X2ZyZXEpKTsKPiAtCX0gZWxzZSBpZiAoSU5URUxfR0VOKGRl
dl9wcml2KSA+PSA2KSB7Cj4gKwkJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUsIHJwcy0+ZWZmaWNp
ZW50X2ZyZXEpKTsKPiArCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDYpIHsKPiAgIAkJ
dTMyIHJwX3N0YXRlX2xpbWl0czsKPiAgIAkJdTMyIGd0X3BlcmZfc3RhdHVzOwo+ICAgCQl1MzIg
cnBfc3RhdGVfY2FwOwo+IEBAIC04OTIsNyArODkyLDcgQEAgc3RhdGljIGludCBpOTE1X2ZyZXF1
ZW5jeV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQo+ICAgCQlpbnQgbWF4
X2ZyZXE7Cj4gICAKPiAgIAkJcnBfc3RhdGVfbGltaXRzID0gSTkxNV9SRUFEKEdFTjZfUlBfU1RB
VEVfTElNSVRTKTsKPiAtCQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpIHsKPiArCQlpZiAoSVNf
R0VOOV9MUChpOTE1KSkgewo+ICAgCQkJcnBfc3RhdGVfY2FwID0gSTkxNV9SRUFEKEJYVF9SUF9T
VEFURV9DQVApOwo+ICAgCQkJZ3RfcGVyZl9zdGF0dXMgPSBJOTE1X1JFQUQoQlhUX0dUX1BFUkZf
U1RBVFVTKTsKPiAgIAkJfSBlbHNlIHsKPiBAQCAtOTAxLDE5ICs5MDEsMTkgQEAgc3RhdGljIGlu
dCBpOTE1X2ZyZXF1ZW5jeV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQo+
ICAgCQl9Cj4gICAKPiAgIAkJLyogUlBTVEFUMSBpcyBpbiB0aGUgR1QgcG93ZXIgd2VsbCAqLwo+
IC0JCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdB
S0VfQUxMKTsKPiArCQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmaTkxNS0+dW5jb3JlLCBG
T1JDRVdBS0VfQUxMKTsKPiAgIAo+ICAgCQlyZXFmID0gSTkxNV9SRUFEKEdFTjZfUlBOU1dSRVEp
Owo+IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gKwkJaWYgKElOVEVMX0dFTihp
OTE1KSA+PSA5KQo+ICAgCQkJcmVxZiA+Pj0gMjM7Cj4gICAJCWVsc2Ugewo+ICAgCQkJcmVxZiAm
PSB+R0VONl9UVVJCT19ESVNBQkxFOwo+IC0JCQlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgfHwg
SVNfQlJPQURXRUxMKGRldl9wcml2KSkKPiArCQkJaWYgKElTX0hBU1dFTEwoaTkxNSkgfHwgSVNf
QlJPQURXRUxMKGk5MTUpKQo+ICAgCQkJCXJlcWYgPj49IDI0Owo+ICAgCQkJZWxzZQo+ICAgCQkJ
CXJlcWYgPj49IDI1Owo+ICAgCQl9Cj4gLQkJcmVxZiA9IGludGVsX2dwdV9mcmVxKGRldl9wcml2
LCByZXFmKTsKPiArCQlyZXFmID0gaW50ZWxfZ3B1X2ZyZXEoaTkxNSwgcmVxZik7Cj4gICAKPiAg
IAkJcnBtb2RlY3RsID0gSTkxNV9SRUFEKEdFTjZfUlBfQ09OVFJPTCk7Cj4gICAJCXJwaW5jbGlt
aXQgPSBJOTE1X1JFQUQoR0VONl9SUF9VUF9USFJFU0hPTEQpOwo+IEBAIC05MjYsMTIgKzkyNiwx
MiBAQCBzdGF0aWMgaW50IGk5MTVfZnJlcXVlbmN5X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2
b2lkICp1bnVzZWQpCj4gICAJCXJwZG93bmVpID0gSTkxNV9SRUFEKEdFTjZfUlBfQ1VSX0RPV05f
RUkpICYgR0VONl9DVVJJQVZHX01BU0s7Cj4gICAJCXJwY3VyZG93biA9IEk5MTVfUkVBRChHRU42
X1JQX0NVUl9ET1dOKSAmIEdFTjZfQ1VSQlNZVEFWR19NQVNLOwo+ICAgCQlycHByZXZkb3duID0g
STkxNV9SRUFEKEdFTjZfUlBfUFJFVl9ET1dOKSAmIEdFTjZfQ1VSQlNZVEFWR19NQVNLOwo+IC0J
CWNhZ2YgPSBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwKPiAtCQkJCSAgICAgIGludGVsX2dldF9j
YWdmKGRldl9wcml2LCBycHN0YXQpKTsKPiArCQljYWdmID0gaW50ZWxfZ3B1X2ZyZXEoaTkxNSwK
PiArCQkJCSAgICAgIGludGVsX2dldF9jYWdmKGk5MTUsIHJwc3RhdCkpOwo+ICAgCj4gLQkJaW50
ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwp
Owo+ICsJCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FL
RV9BTEwpOwo+ICAgCj4gLQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpIHsKPiArCQlp
ZiAoSU5URUxfR0VOKGk5MTUpID49IDExKSB7Cj4gICAJCQlwbV9pZXIgPSBJOTE1X1JFQUQoR0VO
MTFfR1BNX1dHQk9YUEVSRl9JTlRSX0VOQUJMRSk7Cj4gICAJCQlwbV9pbXIgPSBJOTE1X1JFQUQo
R0VOMTFfR1BNX1dHQk9YUEVSRl9JTlRSX01BU0spOwo+ICAgCQkJLyoKPiBAQCAtOTQwLDcgKzk0
MCw3IEBAIHN0YXRpYyBpbnQgaTkxNV9mcmVxdWVuY3lfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0s
IHZvaWQgKnVudXNlZCkKPiAgIAkJCSAqLwo+ICAgCQkJcG1faXNyID0gMDsKPiAgIAkJCXBtX2lp
ciA9IDA7Cj4gLQkJfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDgpIHsKPiArCQl9
IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA4KSB7Cj4gICAJCQlwbV9pZXIgPSBJOTE1X1JF
QUQoR0VOOF9HVF9JRVIoMikpOwo+ICAgCQkJcG1faW1yID0gSTkxNV9SRUFEKEdFTjhfR1RfSU1S
KDIpKTsKPiAgIAkJCXBtX2lzciA9IEk5MTVfUkVBRChHRU44X0dUX0lTUigyKSk7Cj4gQEAgLTk2
MywxNCArOTYzLDE0IEBAIHN0YXRpYyBpbnQgaTkxNV9mcmVxdWVuY3lfaW5mbyhzdHJ1Y3Qgc2Vx
X2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKPiAgIAo+ICAgCQlzZXFfcHJpbnRmKG0sICJQTSBJRVI9
MHglMDh4IElNUj0weCUwOHgsIE1BU0s9MHglMDh4XG4iLAo+ICAgCQkJICAgcG1faWVyLCBwbV9p
bXIsIHBtX21hc2spOwo+IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDEwKQo+ICsJCWlm
IChJTlRFTF9HRU4oaTkxNSkgPD0gMTApCj4gICAJCQlzZXFfcHJpbnRmKG0sICJQTSBJU1I9MHgl
MDh4IElJUj0weCUwOHhcbiIsCj4gICAJCQkJICAgcG1faXNyLCBwbV9paXIpOwo+ICAgCQlzZXFf
cHJpbnRmKG0sICJwbV9pbnRybXNrX21iejogMHglMDh4XG4iLAo+ICAgCQkJICAgcnBzLT5wbV9p
bnRybXNrX21ieik7Cj4gICAJCXNlcV9wcmludGYobSwgIkdUX1BFUkZfU1RBVFVTOiAweCUwOHhc
biIsIGd0X3BlcmZfc3RhdHVzKTsKPiAgIAkJc2VxX3ByaW50ZihtLCAiUmVuZGVyIHAtc3RhdGUg
cmF0aW86ICVkXG4iLAo+IC0JCQkgICAoZ3RfcGVyZl9zdGF0dXMgJiAoSU5URUxfR0VOKGRldl9w
cml2KSA+PSA5ID8gMHgxZmYwMCA6IDB4ZmYwMCkpID4+IDgpOwo+ICsJCQkgICAoZ3RfcGVyZl9z
dGF0dXMgJiAoSU5URUxfR0VOKGk5MTUpID49IDkgPyAweDFmZjAwIDogMHhmZjAwKSkgPj4gOCk7
Cj4gICAJCXNlcV9wcmludGYobSwgIlJlbmRlciBwLXN0YXRlIFZJRDogJWRcbiIsCj4gICAJCQkg
ICBndF9wZXJmX3N0YXR1cyAmIDB4ZmYpOwo+ICAgCQlzZXFfcHJpbnRmKG0sICJSZW5kZXIgcC1z
dGF0ZSBsaW1pdDogJWRcbiIsCj4gQEAgLTk4Miw3MiArOTgyLDcyIEBAIHN0YXRpYyBpbnQgaTkx
NV9mcmVxdWVuY3lfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKPiAgIAkJ
c2VxX3ByaW50ZihtLCAiUlBOU1dSRVE6ICVkTUh6XG4iLCByZXFmKTsKPiAgIAkJc2VxX3ByaW50
ZihtLCAiQ0FHRjogJWRNSHpcbiIsIGNhZ2YpOwo+ICAgCQlzZXFfcHJpbnRmKG0sICJSUCBDVVIg
VVAgRUk6ICVkICglZHVzKVxuIiwKPiAtCQkJICAgcnB1cGVpLCBHVF9QTV9JTlRFUlZBTF9UT19V
UyhkZXZfcHJpdiwgcnB1cGVpKSk7Cj4gKwkJCSAgIHJwdXBlaSwgR1RfUE1fSU5URVJWQUxfVE9f
VVMoaTkxNSwgcnB1cGVpKSk7Cj4gICAJCXNlcV9wcmludGYobSwgIlJQIENVUiBVUDogJWQgKCVk
dXMpXG4iLAo+IC0JCQkgICBycGN1cnVwLCBHVF9QTV9JTlRFUlZBTF9UT19VUyhkZXZfcHJpdiwg
cnBjdXJ1cCkpOwo+ICsJCQkgICBycGN1cnVwLCBHVF9QTV9JTlRFUlZBTF9UT19VUyhpOTE1LCBy
cGN1cnVwKSk7Cj4gICAJCXNlcV9wcmludGYobSwgIlJQIFBSRVYgVVA6ICVkICglZHVzKVxuIiwK
PiAtCQkJICAgcnBwcmV2dXAsIEdUX1BNX0lOVEVSVkFMX1RPX1VTKGRldl9wcml2LCBycHByZXZ1
cCkpOwo+ICsJCQkgICBycHByZXZ1cCwgR1RfUE1fSU5URVJWQUxfVE9fVVMoaTkxNSwgcnBwcmV2
dXApKTsKPiAgIAkJc2VxX3ByaW50ZihtLCAiVXAgdGhyZXNob2xkOiAlZCUlXG4iLAo+ICAgCQkJ
ICAgcnBzLT5wb3dlci51cF90aHJlc2hvbGQpOwo+ICAgCj4gICAJCXNlcV9wcmludGYobSwgIlJQ
IENVUiBET1dOIEVJOiAlZCAoJWR1cylcbiIsCj4gLQkJCSAgIHJwZG93bmVpLCBHVF9QTV9JTlRF
UlZBTF9UT19VUyhkZXZfcHJpdiwgcnBkb3duZWkpKTsKPiArCQkJICAgcnBkb3duZWksIEdUX1BN
X0lOVEVSVkFMX1RPX1VTKGk5MTUsIHJwZG93bmVpKSk7Cj4gICAJCXNlcV9wcmludGYobSwgIlJQ
IENVUiBET1dOOiAlZCAoJWR1cylcbiIsCj4gLQkJCSAgIHJwY3VyZG93biwgR1RfUE1fSU5URVJW
QUxfVE9fVVMoZGV2X3ByaXYsIHJwY3VyZG93bikpOwo+ICsJCQkgICBycGN1cmRvd24sIEdUX1BN
X0lOVEVSVkFMX1RPX1VTKGk5MTUsIHJwY3VyZG93bikpOwo+ICAgCQlzZXFfcHJpbnRmKG0sICJS
UCBQUkVWIERPV046ICVkICglZHVzKVxuIiwKPiAtCQkJICAgcnBwcmV2ZG93biwgR1RfUE1fSU5U
RVJWQUxfVE9fVVMoZGV2X3ByaXYsIHJwcHJldmRvd24pKTsKPiArCQkJICAgcnBwcmV2ZG93biwg
R1RfUE1fSU5URVJWQUxfVE9fVVMoaTkxNSwgcnBwcmV2ZG93bikpOwo+ICAgCQlzZXFfcHJpbnRm
KG0sICJEb3duIHRocmVzaG9sZDogJWQlJVxuIiwKPiAgIAkJCSAgIHJwcy0+cG93ZXIuZG93bl90
aHJlc2hvbGQpOwo+ICAgCj4gLQkJbWF4X2ZyZXEgPSAoSVNfR0VOOV9MUChkZXZfcHJpdikgPyBy
cF9zdGF0ZV9jYXAgPj4gMCA6Cj4gKwkJbWF4X2ZyZXEgPSAoSVNfR0VOOV9MUChpOTE1KSA/IHJw
X3N0YXRlX2NhcCA+PiAwIDoKPiAgIAkJCSAgICBycF9zdGF0ZV9jYXAgPj4gMTYpICYgMHhmZjsK
PiAtCQltYXhfZnJlcSAqPSAoSVNfR0VOOV9CQyhkZXZfcHJpdikgfHwKPiAtCQkJICAgICBJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDEwID8gR0VOOV9GUkVRX1NDQUxFUiA6IDEpOwo+ICsJCW1heF9m
cmVxICo9IChJU19HRU45X0JDKGk5MTUpIHx8Cj4gKwkJCSAgICAgSU5URUxfR0VOKGk5MTUpID49
IDEwID8gR0VOOV9GUkVRX1NDQUxFUiA6IDEpOwo+ICAgCQlzZXFfcHJpbnRmKG0sICJMb3dlc3Qg
KFJQTikgZnJlcXVlbmN5OiAlZE1IelxuIiwKPiAtCQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3By
aXYsIG1heF9mcmVxKSk7Cj4gKwkJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUsIG1heF9mcmVxKSk7
Cj4gICAKPiAgIAkJbWF4X2ZyZXEgPSAocnBfc3RhdGVfY2FwICYgMHhmZjAwKSA+PiA4Owo+IC0J
CW1heF9mcmVxICo9IChJU19HRU45X0JDKGRldl9wcml2KSB8fAo+IC0JCQkgICAgIElOVEVMX0dF
TihkZXZfcHJpdikgPj0gMTAgPyBHRU45X0ZSRVFfU0NBTEVSIDogMSk7Cj4gKwkJbWF4X2ZyZXEg
Kj0gKElTX0dFTjlfQkMoaTkxNSkgfHwKPiArCQkJICAgICBJTlRFTF9HRU4oaTkxNSkgPj0gMTAg
PyBHRU45X0ZSRVFfU0NBTEVSIDogMSk7Cj4gICAJCXNlcV9wcmludGYobSwgIk5vbWluYWwgKFJQ
MSkgZnJlcXVlbmN5OiAlZE1IelxuIiwKPiAtCQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYs
IG1heF9mcmVxKSk7Cj4gKwkJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUsIG1heF9mcmVxKSk7Cj4g
ICAKPiAtCQltYXhfZnJlcSA9IChJU19HRU45X0xQKGRldl9wcml2KSA/IHJwX3N0YXRlX2NhcCA+
PiAxNiA6Cj4gKwkJbWF4X2ZyZXEgPSAoSVNfR0VOOV9MUChpOTE1KSA/IHJwX3N0YXRlX2NhcCA+
PiAxNiA6Cj4gICAJCQkgICAgcnBfc3RhdGVfY2FwID4+IDApICYgMHhmZjsKPiAtCQltYXhfZnJl
cSAqPSAoSVNfR0VOOV9CQyhkZXZfcHJpdikgfHwKPiAtCQkJICAgICBJTlRFTF9HRU4oZGV2X3By
aXYpID49IDEwID8gR0VOOV9GUkVRX1NDQUxFUiA6IDEpOwo+ICsJCW1heF9mcmVxICo9IChJU19H
RU45X0JDKGk5MTUpIHx8Cj4gKwkJCSAgICAgSU5URUxfR0VOKGk5MTUpID49IDEwID8gR0VOOV9G
UkVRX1NDQUxFUiA6IDEpOwo+ICAgCQlzZXFfcHJpbnRmKG0sICJNYXggbm9uLW92ZXJjbG9ja2Vk
IChSUDApIGZyZXF1ZW5jeTogJWRNSHpcbiIsCj4gLQkJCSAgIGludGVsX2dwdV9mcmVxKGRldl9w
cml2LCBtYXhfZnJlcSkpOwo+ICsJCQkgICBpbnRlbF9ncHVfZnJlcShpOTE1LCBtYXhfZnJlcSkp
Owo+ICAgCQlzZXFfcHJpbnRmKG0sICJNYXggb3ZlcmNsb2NrZWQgZnJlcXVlbmN5OiAlZE1Ielxu
IiwKPiAtCQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+bWF4X2ZyZXEpKTsKPiAr
CQkJICAgaW50ZWxfZ3B1X2ZyZXEoaTkxNSwgcnBzLT5tYXhfZnJlcSkpOwo+ICAgCj4gICAJCXNl
cV9wcmludGYobSwgIkN1cnJlbnQgZnJlcTogJWQgTUh6XG4iLAo+IC0JCQkgICBpbnRlbF9ncHVf
ZnJlcShkZXZfcHJpdiwgcnBzLT5jdXJfZnJlcSkpOwo+ICsJCQkgICBpbnRlbF9ncHVfZnJlcShp
OTE1LCBycHMtPmN1cl9mcmVxKSk7Cj4gICAJCXNlcV9wcmludGYobSwgIkFjdHVhbCBmcmVxOiAl
ZCBNSHpcbiIsIGNhZ2YpOwo+ICAgCQlzZXFfcHJpbnRmKG0sICJJZGxlIGZyZXE6ICVkIE1Ielxu
IiwKPiAtCQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+aWRsZV9mcmVxKSk7Cj4g
KwkJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUsIHJwcy0+aWRsZV9mcmVxKSk7Cj4gICAJCXNlcV9w
cmludGYobSwgIk1pbiBmcmVxOiAlZCBNSHpcbiIsCj4gLQkJCSAgIGludGVsX2dwdV9mcmVxKGRl
dl9wcml2LCBycHMtPm1pbl9mcmVxKSk7Cj4gKwkJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUsIHJw
cy0+bWluX2ZyZXEpKTsKPiAgIAkJc2VxX3ByaW50ZihtLCAiQm9vc3QgZnJlcTogJWQgTUh6XG4i
LAo+IC0JCQkgICBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5ib29zdF9mcmVxKSk7Cj4g
KwkJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUsIHJwcy0+Ym9vc3RfZnJlcSkpOwo+ICAgCQlzZXFf
cHJpbnRmKG0sICJNYXggZnJlcTogJWQgTUh6XG4iLAo+IC0JCQkgICBpbnRlbF9ncHVfZnJlcShk
ZXZfcHJpdiwgcnBzLT5tYXhfZnJlcSkpOwo+ICsJCQkgICBpbnRlbF9ncHVfZnJlcShpOTE1LCBy
cHMtPm1heF9mcmVxKSk7Cj4gICAJCXNlcV9wcmludGYobSwKPiAgIAkJCSAgICJlZmZpY2llbnQg
KFJQZSkgZnJlcXVlbmN5OiAlZCBNSHpcbiIsCj4gLQkJCSAgIGludGVsX2dwdV9mcmVxKGRldl9w
cml2LCBycHMtPmVmZmljaWVudF9mcmVxKSk7Cj4gKwkJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUs
IHJwcy0+ZWZmaWNpZW50X2ZyZXEpKTsKPiAgIAl9IGVsc2Ugewo+ICAgCQlzZXFfcHV0cyhtLCAi
bm8gUC1zdGF0ZSBpbmZvIGF2YWlsYWJsZVxuIik7Cj4gICAJfQo+ICAgCj4gLQlzZXFfcHJpbnRm
KG0sICJDdXJyZW50IENEIGNsb2NrIGZyZXF1ZW5jeTogJWQga0h6XG4iLCBkZXZfcHJpdi0+Y2Rj
bGsuaHcuY2RjbGspOwo+IC0Jc2VxX3ByaW50ZihtLCAiTWF4IENEIGNsb2NrIGZyZXF1ZW5jeTog
JWQga0h6XG4iLCBkZXZfcHJpdi0+bWF4X2NkY2xrX2ZyZXEpOwo+IC0Jc2VxX3ByaW50ZihtLCAi
TWF4IHBpeGVsIGNsb2NrIGZyZXF1ZW5jeTogJWQga0h6XG4iLCBkZXZfcHJpdi0+bWF4X2RvdGNs
a19mcmVxKTsKPiArCXNlcV9wcmludGYobSwgIkN1cnJlbnQgQ0QgY2xvY2sgZnJlcXVlbmN5OiAl
ZCBrSHpcbiIsIGk5MTUtPmNkY2xrLmh3LmNkY2xrKTsKPiArCXNlcV9wcmludGYobSwgIk1heCBD
RCBjbG9jayBmcmVxdWVuY3k6ICVkIGtIelxuIiwgaTkxNS0+bWF4X2NkY2xrX2ZyZXEpOwo+ICsJ
c2VxX3ByaW50ZihtLCAiTWF4IHBpeGVsIGNsb2NrIGZyZXF1ZW5jeTogJWQga0h6XG4iLCBpOTE1
LT5tYXhfZG90Y2xrX2ZyZXEpOwo+ICAgCj4gLQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJp
diwgd2FrZXJlZik7Cj4gKwlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKPiAg
IAlyZXR1cm4gcmV0Owo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGk5MTVfaW5zdGRvbmVfaW5m
byhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGk5MTVf
aW5zdGRvbmVfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAg
ICBzdHJ1Y3Qgc2VxX2ZpbGUgKm0sCj4gICAJCQkgICAgICAgc3RydWN0IGludGVsX2luc3Rkb25l
ICppbnN0ZG9uZSkKPiAgIHsKPiBAQCAtMTA1NywzNyArMTA1NywzNyBAQCBzdGF0aWMgdm9pZCBp
OTE1X2luc3Rkb25lX2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAg
CXNlcV9wcmludGYobSwgIlx0XHRJTlNURE9ORTogMHglMDh4XG4iLAo+ICAgCQkgICBpbnN0ZG9u
ZS0+aW5zdGRvbmUpOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8PSAzKQo+ICsJ
aWYgKElOVEVMX0dFTihpOTE1KSA8PSAzKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAlzZXFfcHJp
bnRmKG0sICJcdFx0U0NfSU5TVERPTkU6IDB4JTA4eFxuIiwKPiAgIAkJICAgaW5zdGRvbmUtPnNs
aWNlX2NvbW1vbik7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDYpCj4gKwlp
ZiAoSU5URUxfR0VOKGk5MTUpIDw9IDYpCj4gICAJCXJldHVybjsKPiAgIAo+IC0JZm9yX2VhY2hf
aW5zdGRvbmVfc2xpY2Vfc3Vic2xpY2UoZGV2X3ByaXYsIHNsaWNlLCBzdWJzbGljZSkKPiArCWZv
cl9lYWNoX2luc3Rkb25lX3NsaWNlX3N1YnNsaWNlKGk5MTUsIHNsaWNlLCBzdWJzbGljZSkKPiAg
IAkJc2VxX3ByaW50ZihtLCAiXHRcdFNBTVBMRVJfSU5TVERPTkVbJWRdWyVkXTogMHglMDh4XG4i
LAo+ICAgCQkJICAgc2xpY2UsIHN1YnNsaWNlLCBpbnN0ZG9uZS0+c2FtcGxlcltzbGljZV1bc3Vi
c2xpY2VdKTsKPiAgIAo+IC0JZm9yX2VhY2hfaW5zdGRvbmVfc2xpY2Vfc3Vic2xpY2UoZGV2X3By
aXYsIHNsaWNlLCBzdWJzbGljZSkKPiArCWZvcl9lYWNoX2luc3Rkb25lX3NsaWNlX3N1YnNsaWNl
KGk5MTUsIHNsaWNlLCBzdWJzbGljZSkKPiAgIAkJc2VxX3ByaW50ZihtLCAiXHRcdFJPV19JTlNU
RE9ORVslZF1bJWRdOiAweCUwOHhcbiIsCj4gICAJCQkgICBzbGljZSwgc3Vic2xpY2UsIGluc3Rk
b25lLT5yb3dbc2xpY2VdW3N1YnNsaWNlXSk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQgaTkx
NV9oYW5nY2hlY2tfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKPiAgIHsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5w
cml2YXRlKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1
KG0tPnByaXZhdGUpOwo+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKPiAgIAl1
NjQgYWN0aGRbSTkxNV9OVU1fRU5HSU5FU107Cj4gICAJc3RydWN0IGludGVsX2luc3Rkb25lIGlu
c3Rkb25lOwo+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICAgCWVudW0gaW50ZWxfZW5n
aW5lX2lkIGlkOwo+ICAgCj4gLQlzZXFfcHJpbnRmKG0sICJSZXNldCBmbGFnczogJWx4XG4iLCBk
ZXZfcHJpdi0+Z3B1X2Vycm9yLmZsYWdzKTsKPiAtCWlmICh0ZXN0X2JpdChJOTE1X1dFREdFRCwg
JmRldl9wcml2LT5ncHVfZXJyb3IuZmxhZ3MpKQo+ICsJc2VxX3ByaW50ZihtLCAiUmVzZXQgZmxh
Z3M6ICVseFxuIiwgaTkxNS0+Z3B1X2Vycm9yLmZsYWdzKTsKPiArCWlmICh0ZXN0X2JpdChJOTE1
X1dFREdFRCwgJmk5MTUtPmdwdV9lcnJvci5mbGFncykpCj4gICAJCXNlcV9wdXRzKG0sICJcdFdl
ZGdlZFxuIik7Cj4gLQlpZiAodGVzdF9iaXQoSTkxNV9SRVNFVF9CQUNLT0ZGLCAmZGV2X3ByaXYt
PmdwdV9lcnJvci5mbGFncykpCj4gKwlpZiAodGVzdF9iaXQoSTkxNV9SRVNFVF9CQUNLT0ZGLCAm
aTkxNS0+Z3B1X2Vycm9yLmZsYWdzKSkKPiAgIAkJc2VxX3B1dHMobSwgIlx0RGV2aWNlIChnbG9i
YWwpIHJlc2V0IGluIHByb2dyZXNzXG4iKTsKPiAgIAo+ICAgCWlmICghaTkxNV9tb2RwYXJhbXMu
ZW5hYmxlX2hhbmdjaGVjaykgewo+IEBAIC0xMDk1LDI1ICsxMDk1LDI1IEBAIHN0YXRpYyBpbnQg
aTkxNV9oYW5nY2hlY2tfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKPiAg
IAkJcmV0dXJuIDA7Cj4gICAJfQo+ICAgCj4gLQl3aXRoX2ludGVsX3J1bnRpbWVfcG0oZGV2X3By
aXYsIHdha2VyZWYpIHsKPiAtCQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQp
Cj4gKwl3aXRoX2ludGVsX3J1bnRpbWVfcG0oaTkxNSwgd2FrZXJlZikgewo+ICsJCWZvcl9lYWNo
X2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKQo+ICAgCQkJYWN0aGRbaWRdID0gaW50ZWxfZW5naW5l
X2dldF9hY3RpdmVfaGVhZChlbmdpbmUpOwo+ICAgCj4gLQkJaW50ZWxfZW5naW5lX2dldF9pbnN0
ZG9uZShkZXZfcHJpdi0+ZW5naW5lW1JDUzBdLCAmaW5zdGRvbmUpOwo+ICsJCWludGVsX2VuZ2lu
ZV9nZXRfaW5zdGRvbmUoaTkxNS0+ZW5naW5lW1JDUzBdLCAmaW5zdGRvbmUpOwo+ICAgCX0KPiAg
IAo+IC0JaWYgKHRpbWVyX3BlbmRpbmcoJmRldl9wcml2LT5ncHVfZXJyb3IuaGFuZ2NoZWNrX3dv
cmsudGltZXIpKQo+ICsJaWYgKHRpbWVyX3BlbmRpbmcoJmk5MTUtPmdwdV9lcnJvci5oYW5nY2hl
Y2tfd29yay50aW1lcikpCj4gICAJCXNlcV9wcmludGYobSwgIkhhbmdjaGVjayBhY3RpdmUsIHRp
bWVyIGZpcmVzIGluICVkbXNcbiIsCj4gLQkJCSAgIGppZmZpZXNfdG9fbXNlY3MoZGV2X3ByaXYt
PmdwdV9lcnJvci5oYW5nY2hlY2tfd29yay50aW1lci5leHBpcmVzIC0KPiArCQkJICAgamlmZmll
c190b19tc2VjcyhpOTE1LT5ncHVfZXJyb3IuaGFuZ2NoZWNrX3dvcmsudGltZXIuZXhwaXJlcyAt
Cj4gICAJCQkJCSAgICBqaWZmaWVzKSk7Cj4gLQllbHNlIGlmIChkZWxheWVkX3dvcmtfcGVuZGlu
ZygmZGV2X3ByaXYtPmdwdV9lcnJvci5oYW5nY2hlY2tfd29yaykpCj4gKwllbHNlIGlmIChkZWxh
eWVkX3dvcmtfcGVuZGluZygmaTkxNS0+Z3B1X2Vycm9yLmhhbmdjaGVja193b3JrKSkKPiAgIAkJ
c2VxX3B1dHMobSwgIkhhbmdjaGVjayBhY3RpdmUsIHdvcmsgcGVuZGluZ1xuIik7Cj4gICAJZWxz
ZQo+ICAgCQlzZXFfcHV0cyhtLCAiSGFuZ2NoZWNrIGluYWN0aXZlXG4iKTsKPiAgIAo+IC0Jc2Vx
X3ByaW50ZihtLCAiR1QgYWN0aXZlPyAlc1xuIiwgeWVzbm8oZGV2X3ByaXYtPmd0LmF3YWtlKSk7
Cj4gKwlzZXFfcHJpbnRmKG0sICJHVCBhY3RpdmU/ICVzXG4iLCB5ZXNubyhpOTE1LT5ndC5hd2Fr
ZSkpOwo+ICAgCj4gLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpIHsKPiAr
CWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKSB7Cj4gICAJCXNlcV9wcmludGYobSwg
IiVzOiAlZCBtcyBhZ29cbiIsCj4gICAJCQkgICBlbmdpbmUtPm5hbWUsCj4gICAJCQkgICBqaWZm
aWVzX3RvX21zZWNzKGppZmZpZXMgLQo+IEBAIC0xMTI2LDExICsxMTI2LDExIEBAIHN0YXRpYyBp
bnQgaTkxNV9oYW5nY2hlY2tfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkK
PiAgIAkJaWYgKGVuZ2luZS0+aWQgPT0gUkNTMCkgewo+ICAgCQkJc2VxX3B1dHMobSwgIlx0aW5z
dGRvbmUgcmVhZCA9XG4iKTsKPiAgIAo+IC0JCQlpOTE1X2luc3Rkb25lX2luZm8oZGV2X3ByaXYs
IG0sICZpbnN0ZG9uZSk7Cj4gKwkJCWk5MTVfaW5zdGRvbmVfaW5mbyhpOTE1LCBtLCAmaW5zdGRv
bmUpOwo+ICAgCj4gICAJCQlzZXFfcHV0cyhtLCAiXHRpbnN0ZG9uZSBhY2N1ID1cbiIpOwo+ICAg
Cj4gLQkJCWk5MTVfaW5zdGRvbmVfaW5mbyhkZXZfcHJpdiwgbSwKPiArCQkJaTkxNV9pbnN0ZG9u
ZV9pbmZvKGk5MTUsIG0sCj4gICAJCQkJCSAgICZlbmdpbmUtPmhhbmdjaGVjay5pbnN0ZG9uZSk7
Cj4gICAJCX0KPiAgIAl9Cj4gQEAgLTExNDAsMTQgKzExNDAsMTQgQEAgc3RhdGljIGludCBpOTE1
X2hhbmdjaGVja19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQo+ICAgCj4g
ICBzdGF0aWMgaW50IGk5MTVfcmVzZXRfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVu
dXNlZCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVf
dG9faTkxNShtLT5wcml2YXRlKTsKPiAtCXN0cnVjdCBpOTE1X2dwdV9lcnJvciAqZXJyb3IgPSAm
ZGV2X3ByaXYtPmdwdV9lcnJvcjsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
bm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ICsJc3RydWN0IGk5MTVfZ3B1X2Vycm9yICplcnJv
ciA9ICZpOTE1LT5ncHVfZXJyb3I7Cj4gICAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
Owo+ICAgCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwo+ICAgCj4gICAJc2VxX3ByaW50ZihtLCAi
ZnVsbCBncHUgcmVzZXQgPSAldVxuIiwgaTkxNV9yZXNldF9jb3VudChlcnJvcikpOwo+ICAgCj4g
LQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpIHsKPiArCWZvcl9lYWNoX2Vu
Z2luZShlbmdpbmUsIGk5MTUsIGlkKSB7Cj4gICAJCXNlcV9wcmludGYobSwgIiVzID0gJXVcbiIs
IGVuZ2luZS0+bmFtZSwKPiAgIAkJCSAgIGk5MTVfcmVzZXRfZW5naW5lX2NvdW50KGVycm9yLCBl
bmdpbmUpKTsKPiAgIAl9Cj4gQEAgLTEyMzUsMTYgKzEyMzUsMTYgQEAgc3RhdGljIHZvaWQgcHJp
bnRfcmM2X3JlcyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sCj4gICAJCQkgIGNvbnN0IGNoYXIgKnRpdGxl
LAo+ICAgCQkJICBjb25zdCBpOTE1X3JlZ190IHJlZykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ICAg
Cj4gICAJc2VxX3ByaW50ZihtLCAiJXMgJXUgKCVsbHUgdXMpXG4iLAo+ICAgCQkgICB0aXRsZSwg
STkxNV9SRUFEKHJlZyksCj4gLQkJICAgaW50ZWxfcmM2X3Jlc2lkZW5jeV91cyhkZXZfcHJpdiwg
cmVnKSk7Cj4gKwkJICAgaW50ZWxfcmM2X3Jlc2lkZW5jeV91cyhpOTE1LCByZWcpKTsKPiAgIH0K
PiAgIAo+ICAgc3RhdGljIGludCB2bHZfZHJwY19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSkKPiAg
IHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNSht
LT5wcml2YXRlKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19p
OTE1KG0tPnByaXZhdGUpOwo+ICAgCXUzMiByY2N0bDEsIHB3X3N0YXR1czsKPiAgIAo+ICAgCXB3
X3N0YXR1cyA9IEk5MTVfUkVBRChWTFZfR1RMQ19QV19TVEFUVVMpOwo+IEBAIC0xMjY2LDcgKzEy
NjYsNyBAQCBzdGF0aWMgaW50IHZsdl9kcnBjX2luZm8oc3RydWN0IHNlcV9maWxlICptKQo+ICAg
Cj4gICBzdGF0aWMgaW50IGdlbjZfZHJwY19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSkKPiAgIHsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5w
cml2YXRlKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1
KG0tPnByaXZhdGUpOwo+ICAgCXUzMiBndF9jb3JlX3N0YXR1cywgcmNjdGwxLCByYzZ2aWRzID0g
MDsKPiAgIAl1MzIgZ2VuOV9wb3dlcmdhdGVfZW5hYmxlID0gMCwgZ2VuOV9wb3dlcmdhdGVfc3Rh
dHVzID0gMDsKPiAgIAo+IEBAIC0xMjc0LDIwICsxMjc0LDIwIEBAIHN0YXRpYyBpbnQgZ2VuNl9k
cnBjX2luZm8oc3RydWN0IHNlcV9maWxlICptKQo+ICAgCXRyYWNlX2k5MTVfcmVnX3J3KGZhbHNl
LCBHRU42X0dUX0NPUkVfU1RBVFVTLCBndF9jb3JlX3N0YXR1cywgNCwgdHJ1ZSk7Cj4gICAKPiAg
IAlyY2N0bDEgPSBJOTE1X1JFQUQoR0VONl9SQ19DT05UUk9MKTsKPiAtCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDkpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkgewo+ICAgCQln
ZW45X3Bvd2VyZ2F0ZV9lbmFibGUgPSBJOTE1X1JFQUQoR0VOOV9QR19FTkFCTEUpOwo+ICAgCQln
ZW45X3Bvd2VyZ2F0ZV9zdGF0dXMgPSBJOTE1X1JFQUQoR0VOOV9QV1JHVF9ET01BSU5fU1RBVFVT
KTsKPiAgIAl9Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDcpCj4gLQkJc2Fu
ZHlicmlkZ2VfcGNvZGVfcmVhZChkZXZfcHJpdiwgR0VONl9QQ09ERV9SRUFEX1JDNlZJRFMsCj4g
KwlpZiAoSU5URUxfR0VOKGk5MTUpIDw9IDcpCj4gKwkJc2FuZHlicmlkZ2VfcGNvZGVfcmVhZChp
OTE1LCBHRU42X1BDT0RFX1JFQURfUkM2VklEUywKPiAgIAkJCQkgICAgICAgJnJjNnZpZHMsIE5V
TEwpOwo+ICAgCj4gICAJc2VxX3ByaW50ZihtLCAiUkMxZSBFbmFibGVkOiAlc1xuIiwKPiAgIAkJ
ICAgeWVzbm8ocmNjdGwxICYgR0VONl9SQ19DVExfUkMxZV9FTkFCTEUpKTsKPiAgIAlzZXFfcHJp
bnRmKG0sICJSQzYgRW5hYmxlZDogJXNcbiIsCj4gICAJCSAgIHllc25vKHJjY3RsMSAmIEdFTjZf
UkNfQ1RMX1JDNl9FTkFCTEUpKTsKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpIHsK
PiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkgewo+ICAgCQlzZXFfcHJpbnRmKG0sICJSZW5k
ZXIgV2VsbCBHYXRpbmcgRW5hYmxlZDogJXNcbiIsCj4gICAJCQl5ZXNubyhnZW45X3Bvd2VyZ2F0
ZV9lbmFibGUgJiBHRU45X1JFTkRFUl9QR19FTkFCTEUpKTsKPiAgIAkJc2VxX3ByaW50ZihtLCAi
TWVkaWEgV2VsbCBHYXRpbmcgRW5hYmxlZDogJXNcbiIsCj4gQEAgLTEzMjEsNyArMTMyMSw3IEBA
IHN0YXRpYyBpbnQgZ2VuNl9kcnBjX2luZm8oc3RydWN0IHNlcV9maWxlICptKQo+ICAgCj4gICAJ
c2VxX3ByaW50ZihtLCAiQ29yZSBQb3dlciBEb3duOiAlc1xuIiwKPiAgIAkJICAgeWVzbm8oZ3Rf
Y29yZV9zdGF0dXMgJiBHRU42X0NPUkVfQ1BEX1NUQVRFX01BU0spKTsKPiAtCWlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDkpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkgewo+ICAg
CQlzZXFfcHJpbnRmKG0sICJSZW5kZXIgUG93ZXIgV2VsbDogJXNcbiIsCj4gICAJCQkoZ2VuOV9w
b3dlcmdhdGVfc3RhdHVzICYKPiAgIAkJCSBHRU45X1BXUkdUX1JFTkRFUl9TVEFUVVNfTUFTSykg
PyAiVXAiIDogIkRvd24iKTsKPiBAQCAtMTMzNyw3ICsxMzM3LDcgQEAgc3RhdGljIGludCBnZW42
X2RycGNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0pCj4gICAJcHJpbnRfcmM2X3JlcyhtLCAiUkM2
KyByZXNpZGVuY3kgc2luY2UgYm9vdDoiLCBHRU42X0dUX0dGWF9SQzZwKTsKPiAgIAlwcmludF9y
YzZfcmVzKG0sICJSQzYrKyByZXNpZGVuY3kgc2luY2UgYm9vdDoiLCBHRU42X0dUX0dGWF9SQzZw
cCk7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDcpIHsKPiArCWlmIChJTlRF
TF9HRU4oaTkxNSkgPD0gNykgewo+ICAgCQlzZXFfcHJpbnRmKG0sICJSQzYgICB2b2x0YWdlOiAl
ZG1WXG4iLAo+ICAgCQkJICAgR0VONl9ERUNPREVfUkM2X1ZJRCgoKHJjNnZpZHMgPj4gMCkgJiAw
eGZmKSkpOwo+ICAgCQlzZXFfcHJpbnRmKG0sICJSQzYrICB2b2x0YWdlOiAlZG1WXG4iLAo+IEBA
IC0xMzUxLDE0ICsxMzUxLDE0IEBAIHN0YXRpYyBpbnQgZ2VuNl9kcnBjX2luZm8oc3RydWN0IHNl
cV9maWxlICptKQo+ICAgCj4gICBzdGF0aWMgaW50IGk5MTVfZHJwY19pbmZvKHN0cnVjdCBzZXFf
ZmlsZSAqbSwgdm9pZCAqdW51c2VkKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gICAJaW50ZWxfd2Fr
ZXJlZl90IHdha2VyZWY7Cj4gICAJaW50IGVyciA9IC1FTk9ERVY7Cj4gICAKPiAtCXdpdGhfaW50
ZWxfcnVudGltZV9wbShkZXZfcHJpdiwgd2FrZXJlZikgewo+IC0JCWlmIChJU19WQUxMRVlWSUVX
KGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiArCXdpdGhfaW50ZWxfcnVu
dGltZV9wbShpOTE1LCB3YWtlcmVmKSB7Cj4gKwkJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwg
SVNfQ0hFUlJZVklFVyhpOTE1KSkKPiAgIAkJCWVyciA9IHZsdl9kcnBjX2luZm8obSk7Cj4gLQkJ
ZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA2KQo+ICsJCWVsc2UgaWYgKElOVEVMX0dF
TihpOTE1KSA+PSA2KQo+ICAgCQkJZXJyID0gZ2VuNl9kcnBjX2luZm8obSk7Cj4gICAJCWVsc2UK
PiAgIAkJCWVyciA9IGlyb25sYWtlX2RycGNfaW5mbyhtKTsKPiBAQCAtMTM2OSw0NCArMTM2OSw0
NCBAQCBzdGF0aWMgaW50IGk5MTVfZHJwY19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAq
dW51c2VkKQo+ICAgCj4gICBzdGF0aWMgaW50IGk5MTVfZnJvbnRidWZmZXJfdHJhY2tpbmcoc3Ry
dWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiAgIAo+
ICAgCXNlcV9wcmludGYobSwgIkZCIHRyYWNraW5nIGJ1c3kgYml0czogMHglMDh4XG4iLAo+IC0J
CSAgIGRldl9wcml2LT5mYl90cmFja2luZy5idXN5X2JpdHMpOwo+ICsJCSAgIGk5MTUtPmZiX3Ry
YWNraW5nLmJ1c3lfYml0cyk7Cj4gICAKPiAgIAlzZXFfcHJpbnRmKG0sICJGQiB0cmFja2luZyBm
bGlwIGJpdHM6IDB4JTA4eFxuIiwKPiAtCQkgICBkZXZfcHJpdi0+ZmJfdHJhY2tpbmcuZmxpcF9i
aXRzKTsKPiArCQkgICBpOTE1LT5mYl90cmFja2luZy5mbGlwX2JpdHMpOwo+ICAgCj4gICAJcmV0
dXJuIDA7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQgaTkxNV9mYmNfc3RhdHVzKHN0cnVjdCBz
ZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+IC0Jc3RydWN0IGludGVs
X2ZiYyAqZmJjID0gJmRldl9wcml2LT5mYmM7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiArCXN0cnVjdCBpbnRlbF9mYmMgKmZi
YyA9ICZpOTE1LT5mYmM7Cj4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gICAKPiAtCWlm
ICghSEFTX0ZCQyhkZXZfcHJpdikpCj4gKwlpZiAoIUhBU19GQkMoaTkxNSkpCj4gICAJCXJldHVy
biAtRU5PREVWOwo+ICAgCj4gLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3By
aXYpOwo+ICsJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOwo+ICAgCW11dGV4
X2xvY2soJmZiYy0+bG9jayk7Cj4gICAKPiAtCWlmIChpbnRlbF9mYmNfaXNfYWN0aXZlKGRldl9w
cml2KSkKPiArCWlmIChpbnRlbF9mYmNfaXNfYWN0aXZlKGk5MTUpKQo+ICAgCQlzZXFfcHV0cyht
LCAiRkJDIGVuYWJsZWRcbiIpOwo+ICAgCWVsc2UKPiAgIAkJc2VxX3ByaW50ZihtLCAiRkJDIGRp
c2FibGVkOiAlc1xuIiwgZmJjLT5ub19mYmNfcmVhc29uKTsKPiAgIAo+IC0JaWYgKGludGVsX2Zi
Y19pc19hY3RpdmUoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoaW50ZWxfZmJjX2lzX2FjdGl2ZShpOTE1
KSkgewo+ICAgCQl1MzIgbWFzazsKPiAgIAo+IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDgpCj4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA4KQo+ICAgCQkJbWFzayA9IEk5MTVfUkVB
RChJVkJfRkJDX1NUQVRVUzIpICYgQkRXX0ZCQ19DT01QX1NFR19NQVNLOwo+IC0JCWVsc2UgaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPj0gNykKPiArCQllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkg
Pj0gNykKPiAgIAkJCW1hc2sgPSBJOTE1X1JFQUQoSVZCX0ZCQ19TVEFUVVMyKSAmIElWQl9GQkNf
Q09NUF9TRUdfTUFTSzsKPiAtCQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDUpCj4g
KwkJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDUpCj4gICAJCQltYXNrID0gSTkxNV9SRUFE
KElMS19EUEZDX1NUQVRVUykgJiBJTEtfRFBGQ19DT01QX1NFR19NQVNLOwo+IC0JCWVsc2UgaWYg
KElTX0c0WChkZXZfcHJpdikpCj4gKwkJZWxzZSBpZiAoSVNfRzRYKGk5MTUpKQo+ICAgCQkJbWFz
ayA9IEk5MTVfUkVBRChEUEZDX1NUQVRVUykgJiBEUEZDX0NPTVBfU0VHX01BU0s7Cj4gICAJCWVs
c2UKPiAgIAkJCW1hc2sgPSBJOTE1X1JFQUQoRkJDX1NUQVRVUykgJiAoRkJDX1NUQVRfQ09NUFJF
U1NJTkcgfAo+IEBAIC0xNDE2LDQxICsxNDE2LDQxIEBAIHN0YXRpYyBpbnQgaTkxNV9mYmNfc3Rh
dHVzKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQo+ICAgCX0KPiAgIAo+ICAgCW11
dGV4X3VubG9jaygmZmJjLT5sb2NrKTsKPiAtCWludGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2
LCB3YWtlcmVmKTsKPiArCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOwo+ICAg
Cj4gICAJcmV0dXJuIDA7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQgaTkxNV9mYmNfZmFsc2Vf
Y29sb3JfZ2V0KHZvaWQgKmRhdGEsIHU2NCAqdmFsKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gZGF0YTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gZGF0YTsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA3IHx8ICFIQVNf
RkJDKGRldl9wcml2KSkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA3IHx8ICFIQVNfRkJDKGk5
MTUpKQo+ICAgCQlyZXR1cm4gLUVOT0RFVjsKPiAgIAo+IC0JKnZhbCA9IGRldl9wcml2LT5mYmMu
ZmFsc2VfY29sb3I7Cj4gKwkqdmFsID0gaTkxNS0+ZmJjLmZhbHNlX2NvbG9yOwo+ICAgCj4gICAJ
cmV0dXJuIDA7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQgaTkxNV9mYmNfZmFsc2VfY29sb3Jf
c2V0KHZvaWQgKmRhdGEsIHU2NCB2YWwpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSBkYXRhOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBk
YXRhOwo+ICAgCXUzMiByZWc7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNyB8
fCAhSEFTX0ZCQyhkZXZfcHJpdikpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgNyB8fCAhSEFT
X0ZCQyhpOTE1KSkKPiAgIAkJcmV0dXJuIC1FTk9ERVY7Cj4gICAKPiAtCW11dGV4X2xvY2soJmRl
dl9wcml2LT5mYmMubG9jayk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT5mYmMubG9jayk7Cj4gICAK
PiAgIAlyZWcgPSBJOTE1X1JFQUQoSUxLX0RQRkNfQ09OVFJPTCk7Cj4gLQlkZXZfcHJpdi0+ZmJj
LmZhbHNlX2NvbG9yID0gdmFsOwo+ICsJaTkxNS0+ZmJjLmZhbHNlX2NvbG9yID0gdmFsOwo+ICAg
Cj4gICAJSTkxNV9XUklURShJTEtfRFBGQ19DT05UUk9MLCB2YWwgPwo+ICAgCQkgICAocmVnIHwg
RkJDX0NUTF9GQUxTRV9DT0xPUikgOgo+ICAgCQkgICAocmVnICYgfkZCQ19DVExfRkFMU0VfQ09M
T1IpKTsKPiAgIAo+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZmJjLmxvY2spOwo+ICsJbXV0
ZXhfdW5sb2NrKCZpOTE1LT5mYmMubG9jayk7Cj4gICAJcmV0dXJuIDA7Cj4gICB9Cj4gICAKPiBA
QCAtMTQ2MCwxOCArMTQ2MCwxOCBAQCBERUZJTkVfU0lNUExFX0FUVFJJQlVURShpOTE1X2ZiY19m
YWxzZV9jb2xvcl9mb3BzLAo+ICAgCj4gICBzdGF0aWMgaW50IGk5MTVfaXBzX3N0YXR1cyhzdHJ1
Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ICAgCWlu
dGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICAgCj4gLQlpZiAoIUhBU19JUFMoZGV2X3ByaXYpKQo+
ICsJaWYgKCFIQVNfSVBTKGk5MTUpKQo+ICAgCQlyZXR1cm4gLUVOT0RFVjsKPiAgIAo+IC0Jd2Fr
ZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKPiArCXdha2VyZWYgPSBpbnRl
bF9ydW50aW1lX3BtX2dldChpOTE1KTsKPiAgIAo+ICAgCXNlcV9wcmludGYobSwgIkVuYWJsZWQg
Ynkga2VybmVsIHBhcmFtZXRlcjogJXNcbiIsCj4gICAJCSAgIHllc25vKGk5MTVfbW9kcGFyYW1z
LmVuYWJsZV9pcHMpKTsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOCkgewo+
ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA4KSB7Cj4gICAJCXNlcV9wdXRzKG0sICJDdXJyZW50
bHk6IHVua25vd25cbiIpOwo+ICAgCX0gZWxzZSB7Cj4gICAJCWlmIChJOTE1X1JFQUQoSVBTX0NU
TCkgJiBJUFNfRU5BQkxFKQo+IEBAIC0xNDgwLDM0ICsxNDgwLDM0IEBAIHN0YXRpYyBpbnQgaTkx
NV9pcHNfc3RhdHVzKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQo+ICAgCQkJc2Vx
X3B1dHMobSwgIkN1cnJlbnRseTogZGlzYWJsZWRcbiIpOwo+ICAgCX0KPiAgIAo+IC0JaW50ZWxf
cnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOwo+ICsJaW50ZWxfcnVudGltZV9wbV9w
dXQoaTkxNSwgd2FrZXJlZik7Cj4gICAKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+ICAgc3Rh
dGljIGludCBpOTE1X3NyX3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkK
PiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkx
NShtLT5wcml2YXRlKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90
b19pOTE1KG0tPnByaXZhdGUpOwo+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICAgCWJv
b2wgc3JfZW5hYmxlZCA9IGZhbHNlOwo+ICAgCj4gLQl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9w
b3dlcl9nZXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9JTklUKTsKPiArCXdha2VyZWYgPSBpbnRl
bF9kaXNwbGF5X3Bvd2VyX2dldChpOTE1LCBQT1dFUl9ET01BSU5fSU5JVCk7Cj4gICAKPiAtCWlm
IChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkp
Cj4gICAJCS8qIG5vIGdsb2JhbCBTUiBzdGF0dXM7IGluc3BlY3QgcGVyLXBsYW5lIFdNICovOwo+
IC0JZWxzZSBpZiAoSEFTX1BDSF9TUExJVChkZXZfcHJpdikpCj4gKwllbHNlIGlmIChIQVNfUENI
X1NQTElUKGk5MTUpKQo+ICAgCQlzcl9lbmFibGVkID0gSTkxNV9SRUFEKFdNMV9MUF9JTEspICYg
V00xX0xQX1NSX0VOOwo+IC0JZWxzZSBpZiAoSVNfSTk2NUdNKGRldl9wcml2KSB8fCBJU19HNFgo
ZGV2X3ByaXYpIHx8Cj4gLQkJIElTX0k5NDVHKGRldl9wcml2KSB8fCBJU19JOTQ1R00oZGV2X3By
aXYpKQo+ICsJZWxzZSBpZiAoSVNfSTk2NUdNKGk5MTUpIHx8IElTX0c0WChpOTE1KSB8fAo+ICsJ
CSBJU19JOTQ1RyhpOTE1KSB8fCBJU19JOTQ1R00oaTkxNSkpCj4gICAJCXNyX2VuYWJsZWQgPSBJ
OTE1X1JFQUQoRldfQkxDX1NFTEYpICYgRldfQkxDX1NFTEZfRU47Cj4gLQllbHNlIGlmIChJU19J
OTE1R00oZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAoSVNfSTkxNUdNKGk5MTUpKQo+ICAgCQlzcl9l
bmFibGVkID0gSTkxNV9SRUFEKElOU1RQTSkgJiBJTlNUUE1fU0VMRl9FTjsKPiAtCWVsc2UgaWYg
KElTX1BJTkVWSUVXKGRldl9wcml2KSkKPiArCWVsc2UgaWYgKElTX1BJTkVWSUVXKGk5MTUpKQo+
ICAgCQlzcl9lbmFibGVkID0gSTkxNV9SRUFEKERTUEZXMykgJiBQSU5FVklFV19TRUxGX1JFRlJF
U0hfRU47Cj4gLQllbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllW
SUVXKGRldl9wcml2KSkKPiArCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hF
UlJZVklFVyhpOTE1KSkKPiAgIAkJc3JfZW5hYmxlZCA9IEk5MTVfUkVBRChGV19CTENfU0VMRl9W
TFYpICYgRldfQ1NQV1JEV05FTjsKPiAgIAo+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2
X3ByaXYsIFBPV0VSX0RPTUFJTl9JTklULCB3YWtlcmVmKTsKPiArCWludGVsX2Rpc3BsYXlfcG93
ZXJfcHV0KGk5MTUsIFBPV0VSX0RPTUFJTl9JTklULCB3YWtlcmVmKTsKPiAgIAo+ICAgCXNlcV9w
cmludGYobSwgInNlbGYtcmVmcmVzaDogJXNcbiIsIGVuYWJsZWRkaXNhYmxlZChzcl9lbmFibGVk
KSk7Cj4gICAKPiBAQCAtMTU0MCwxOCArMTU0MCwxOCBAQCBzdGF0aWMgaW50IGk5MTVfZW1vbl9z
dGF0dXMoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCj4gICAKPiAgIHN0YXRpYyBp
bnQgaTkxNV9yaW5nX2ZyZXFfdGFibGUoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQp
Cj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5
MTUobS0+cHJpdmF0ZSk7Cj4gLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0
X3BtLnJwczsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1
KG0tPnByaXZhdGUpOwo+ICsJc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmk5MTUtPmd0X3BtLnJw
czsKPiAgIAl1bnNpZ25lZCBpbnQgbWF4X2dwdV9mcmVxLCBtaW5fZ3B1X2ZyZXE7Cj4gICAJaW50
ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gICAJaW50IGdwdV9mcmVxLCBpYV9mcmVxOwo+ICAgCj4g
LQlpZiAoIUhBU19MTEMoZGV2X3ByaXYpKQo+ICsJaWYgKCFIQVNfTExDKGk5MTUpKQo+ICAgCQly
ZXR1cm4gLUVOT0RFVjsKPiAgIAo+ICAgCW1pbl9ncHVfZnJlcSA9IHJwcy0+bWluX2ZyZXE7Cj4g
ICAJbWF4X2dwdV9mcmVxID0gcnBzLT5tYXhfZnJlcTsKPiAtCWlmIChJU19HRU45X0JDKGRldl9w
cml2KSB8fCBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwKSB7Cj4gKwlpZiAoSVNfR0VOOV9CQyhp
OTE1KSB8fCBJTlRFTF9HRU4oaTkxNSkgPj0gMTApIHsKPiAgIAkJLyogQ29udmVydCBHVCBmcmVx
dWVuY3kgdG8gNTAgSFogdW5pdHMgKi8KPiAgIAkJbWluX2dwdV9mcmVxIC89IEdFTjlfRlJFUV9T
Q0FMRVI7Cj4gICAJCW1heF9ncHVfZnJlcSAvPSBHRU45X0ZSRVFfU0NBTEVSOwo+IEBAIC0xNTU5
LDMwICsxNTU5LDMwIEBAIHN0YXRpYyBpbnQgaTkxNV9yaW5nX2ZyZXFfdGFibGUoc3RydWN0IHNl
cV9maWxlICptLCB2b2lkICp1bnVzZWQpCj4gICAKPiAgIAlzZXFfcHV0cyhtLCAiR1BVIGZyZXEg
KE1IeilcdEVmZmVjdGl2ZSBDUFUgZnJlcSAoTUh6KVx0RWZmZWN0aXZlIFJpbmcgZnJlcSAoTUh6
KVxuIik7Cj4gICAKPiAtCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7
Cj4gKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7Cj4gICAJZm9yIChncHVf
ZnJlcSA9IG1pbl9ncHVfZnJlcTsgZ3B1X2ZyZXEgPD0gbWF4X2dwdV9mcmVxOyBncHVfZnJlcSsr
KSB7Cj4gICAJCWlhX2ZyZXEgPSBncHVfZnJlcTsKPiAtCQlzYW5keWJyaWRnZV9wY29kZV9yZWFk
KGRldl9wcml2LAo+ICsJCXNhbmR5YnJpZGdlX3Bjb2RlX3JlYWQoaTkxNSwKPiAgIAkJCQkgICAg
ICAgR0VONl9QQ09ERV9SRUFEX01JTl9GUkVRX1RBQkxFLAo+ICAgCQkJCSAgICAgICAmaWFfZnJl
cSwgTlVMTCk7Cj4gICAJCXNlcV9wcmludGYobSwgIiVkXHRcdCVkXHRcdFx0XHQlZFxuIiwKPiAt
CQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIChncHVfZnJlcSAqCj4gLQkJCQkJCSAgICAg
KElTX0dFTjlfQkMoZGV2X3ByaXYpIHx8Cj4gLQkJCQkJCSAgICAgIElOVEVMX0dFTihkZXZfcHJp
dikgPj0gMTAgPwo+ICsJCQkgICBpbnRlbF9ncHVfZnJlcShpOTE1LCAoZ3B1X2ZyZXEgKgo+ICsJ
CQkJCQkgICAgIChJU19HRU45X0JDKGk5MTUpIHx8Cj4gKwkJCQkJCSAgICAgIElOVEVMX0dFTihp
OTE1KSA+PSAxMCA/Cj4gICAJCQkJCQkgICAgICBHRU45X0ZSRVFfU0NBTEVSIDogMSkpKSwKPiAg
IAkJCSAgICgoaWFfZnJlcSA+PiAwKSAmIDB4ZmYpICogMTAwLAo+ICAgCQkJICAgKChpYV9mcmVx
ID4+IDgpICYgMHhmZikgKiAxMDApOwo+ICAgCX0KPiAtCWludGVsX3J1bnRpbWVfcG1fcHV0KGRl
dl9wcml2LCB3YWtlcmVmKTsKPiArCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYp
Owo+ICAgCj4gICAJcmV0dXJuIDA7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQgaTkxNV9vcHJl
Z2lvbihzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKPiAgIHsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiAt
CXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKPiAtCXN0cnVjdCBpbnRl
bF9vcHJlZ2lvbiAqb3ByZWdpb24gPSAmZGV2X3ByaXYtPm9wcmVnaW9uOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gKwlzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2ID0gJmk5MTUtPmRybTsKPiArCXN0cnVjdCBpbnRlbF9vcHJlZ2lv
biAqb3ByZWdpb24gPSAmaTkxNS0+b3ByZWdpb247Cj4gICAJaW50IHJldDsKPiAgIAo+ICAgCXJl
dCA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmZGV2LT5zdHJ1Y3RfbXV0ZXgpOwo+IEBAIC0x
NjEwLDggKzE2MTAsOCBAQCBzdGF0aWMgaW50IGk5MTVfdmJ0KHN0cnVjdCBzZXFfZmlsZSAqbSwg
dm9pZCAqdW51c2VkKQo+ICAgCj4gICBzdGF0aWMgaW50IGk5MTVfZ2VtX2ZyYW1lYnVmZmVyX2lu
Zm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ICAgewo+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+IC0Jc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiA9ICZkZXZfcHJpdi0+ZHJtOwo+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gKwlzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2ID0gJmk5MTUtPmRybTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZnJhbWVidWZmZXIg
KmZiZGV2X2ZiID0gTlVMTDsKPiAgIAlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpkcm1fZmI7Cj4g
ICAJaW50IHJldDsKPiBAQCAtMTYyMSw4ICsxNjIxLDggQEAgc3RhdGljIGludCBpOTE1X2dlbV9m
cmFtZWJ1ZmZlcl9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiAgIAkJcmV0
dXJuIHJldDsKPiAgIAo+ICAgI2lmZGVmIENPTkZJR19EUk1fRkJERVZfRU1VTEFUSU9OCj4gLQlp
ZiAoZGV2X3ByaXYtPmZiZGV2ICYmIGRldl9wcml2LT5mYmRldi0+aGVscGVyLmZiKSB7Cj4gLQkJ
ZmJkZXZfZmIgPSB0b19pbnRlbF9mcmFtZWJ1ZmZlcihkZXZfcHJpdi0+ZmJkZXYtPmhlbHBlci5m
Yik7Cj4gKwlpZiAoaTkxNS0+ZmJkZXYgJiYgaTkxNS0+ZmJkZXYtPmhlbHBlci5mYikgewo+ICsJ
CWZiZGV2X2ZiID0gdG9faW50ZWxfZnJhbWVidWZmZXIoaTkxNS0+ZmJkZXYtPmhlbHBlci5mYik7
Cj4gICAKPiAgIAkJc2VxX3ByaW50ZihtLCAiZmJjb24gc2l6ZTogJWQgeCAlZCwgZGVwdGggJWQs
ICVkIGJwcCwgbW9kaWZpZXIgMHglbGx4LCByZWZjb3VudCAlZCwgb2JqICIsCj4gICAJCQkgICBm
YmRldl9mYi0+YmFzZS53aWR0aCwKPiBAQCAtMTY2Niw4ICsxNjY2LDggQEAgc3RhdGljIHZvaWQg
ZGVzY3JpYmVfY3R4X3Jpbmcoc3RydWN0IHNlcV9maWxlICptLCBzdHJ1Y3QgaW50ZWxfcmluZyAq
cmluZykKPiAgIAo+ICAgc3RhdGljIGludCBpOTE1X2NvbnRleHRfc3RhdHVzKHN0cnVjdCBzZXFf
ZmlsZSAqbSwgdm9pZCAqdW51c2VkKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+IC0Jc3RydWN0IGRybV9kZXZp
Y2UgKmRldiA9ICZkZXZfcHJpdi0+ZHJtOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
ID0gJmk5MTUtPmRybTsKPiAgIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4Owo+ICAgCWlu
dCByZXQ7Cj4gICAKPiBAQCAtMTY3NSw3ICsxNjc1LDcgQEAgc3RhdGljIGludCBpOTE1X2NvbnRl
eHRfc3RhdHVzKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQo+ICAgCWlmIChyZXQp
Cj4gICAJCXJldHVybiByZXQ7Cj4gICAKPiAtCWxpc3RfZm9yX2VhY2hfZW50cnkoY3R4LCAmZGV2
X3ByaXYtPmNvbnRleHRzLmxpc3QsIGxpbmspIHsKPiArCWxpc3RfZm9yX2VhY2hfZW50cnkoY3R4
LCAmaTkxNS0+Y29udGV4dHMubGlzdCwgbGluaykgewo+ICAgCQlzdHJ1Y3QgaTkxNV9nZW1fZW5n
aW5lc19pdGVyIGl0Owo+ICAgCQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7Cj4gICAKPiBAQCAt
MTc0NiwxOCArMTc0NiwxOCBAQCBzdGF0aWMgY29uc3QgY2hhciAqc3dpenpsZV9zdHJpbmcodW5z
aWduZWQgc3dpenpsZSkKPiAgIAo+ICAgc3RhdGljIGludCBpOTE1X3N3aXp6bGVfaW5mbyhzdHJ1
Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gLQlzdHJ1Y3QgaW50
ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsKPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ICsJc3RydWN0IGlu
dGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsKPiAgIAlpbnRlbF93YWtlcmVmX3Qg
d2FrZXJlZjsKPiAgIAo+IC0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2
KTsKPiArCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKPiAgIAo+ICAgCXNl
cV9wcmludGYobSwgImJpdDYgc3dpenpsZSBmb3IgWC10aWxpbmcgPSAlc1xuIiwKPiAtCQkgICBz
d2l6emxlX3N0cmluZyhkZXZfcHJpdi0+bW0uYml0XzZfc3dpenpsZV94KSk7Cj4gKwkJICAgc3dp
enpsZV9zdHJpbmcoaTkxNS0+bW0uYml0XzZfc3dpenpsZV94KSk7Cj4gICAJc2VxX3ByaW50Ziht
LCAiYml0NiBzd2l6emxlIGZvciBZLXRpbGluZyA9ICVzXG4iLAo+IC0JCSAgIHN3aXp6bGVfc3Ry
aW5nKGRldl9wcml2LT5tbS5iaXRfNl9zd2l6emxlX3kpKTsKPiArCQkgICBzd2l6emxlX3N0cmlu
ZyhpOTE1LT5tbS5iaXRfNl9zd2l6emxlX3kpKTsKPiAgIAo+IC0JaWYgKElTX0dFTl9SQU5HRShk
ZXZfcHJpdiwgMywgNCkpIHsKPiArCWlmIChJU19HRU5fUkFOR0UoaTkxNSwgMywgNCkpIHsKPiAg
IAkJc2VxX3ByaW50ZihtLCAiRERDID0gMHglMDh4XG4iLAo+ICAgCQkJICAgaW50ZWxfdW5jb3Jl
X3JlYWQodW5jb3JlLCBEQ0MpKTsKPiAgIAkJc2VxX3ByaW50ZihtLCAiRERDMiA9IDB4JTA4eFxu
IiwKPiBAQCAtMTc2Niw3ICsxNzY2LDcgQEAgc3RhdGljIGludCBpOTE1X3N3aXp6bGVfaW5mbyhz
dHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gICAJCQkgICBpbnRlbF91bmNvcmVfcmVh
ZDE2KHVuY29yZSwgQzBEUkIzKSk7Cj4gICAJCXNlcV9wcmludGYobSwgIkMxRFJCMyA9IDB4JTA0
eFxuIiwKPiAgIAkJCSAgIGludGVsX3VuY29yZV9yZWFkMTYodW5jb3JlLCBDMURSQjMpKTsKPiAt
CX0gZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA2KSB7Cj4gKwl9IGVsc2UgaWYgKElO
VEVMX0dFTihpOTE1KSA+PSA2KSB7Cj4gICAJCXNlcV9wcmludGYobSwgIk1BRF9ESU1NX0MwID0g
MHglMDh4XG4iLAo+ICAgCQkJICAgaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBNQURfRElNTV9D
MCkpOwo+ICAgCQlzZXFfcHJpbnRmKG0sICJNQURfRElNTV9DMSA9IDB4JTA4eFxuIiwKPiBAQCAt
MTc3NSw3ICsxNzc1LDcgQEAgc3RhdGljIGludCBpOTE1X3N3aXp6bGVfaW5mbyhzdHJ1Y3Qgc2Vx
X2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gICAJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUs
IE1BRF9ESU1NX0MyKSk7Cj4gICAJCXNlcV9wcmludGYobSwgIlRJTEVDVEwgPSAweCUwOHhcbiIs
Cj4gICAJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIFRJTEVDVEwpKTsKPiAtCQlpZiAo
SU5URUxfR0VOKGRldl9wcml2KSA+PSA4KQo+ICsJCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOCkK
PiAgIAkJCXNlcV9wcmludGYobSwgIkdBTVRBUkJNT0RFID0gMHglMDh4XG4iLAo+ICAgCQkJCSAg
IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0FNVEFSQk1PREUpKTsKPiAgIAkJZWxzZQo+IEBA
IC0xNzg1LDEwICsxNzg1LDEwIEBAIHN0YXRpYyBpbnQgaTkxNV9zd2l6emxlX2luZm8oc3RydWN0
IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ICAgCQkJICAgaW50ZWxfdW5jb3JlX3JlYWQodW5j
b3JlLCBESVNQX0FSQl9DVEwpKTsKPiAgIAl9Cj4gICAKPiAtCWlmIChkZXZfcHJpdi0+cXVpcmtz
ICYgUVVJUktfUElOX1NXSVpaTEVEX1BBR0VTKQo+ICsJaWYgKGk5MTUtPnF1aXJrcyAmIFFVSVJL
X1BJTl9TV0laWkxFRF9QQUdFUykKPiAgIAkJc2VxX3B1dHMobSwgIkwtc2hhcGVkIG1lbW9yeSBk
ZXRlY3RlZFxuIik7Cj4gICAKPiAtCWludGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtl
cmVmKTsKPiArCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOwo+ICAgCj4gICAJ
cmV0dXJuIDA7Cj4gICB9Cj4gQEAgLTE4MDksNTQgKzE4MDksNTQgQEAgc3RhdGljIGNvbnN0IGNo
YXIgKnJwc19wb3dlcl90b19zdHIodW5zaWduZWQgaW50IHBvd2VyKQo+ICAgCj4gICBzdGF0aWMg
aW50IGk5MTVfcnBzX2Jvb3N0X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+
ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1
KG0tPnByaXZhdGUpOwo+IC0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9w
bS5ycHM7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNSht
LT5wcml2YXRlKTsKPiArCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1LT5ndF9wbS5ycHM7
Cj4gICAJdTMyIGFjdF9mcmVxID0gcnBzLT5jdXJfZnJlcTsKPiAgIAlpbnRlbF93YWtlcmVmX3Qg
d2FrZXJlZjsKPiAgIAo+IC0Jd2l0aF9pbnRlbF9ydW50aW1lX3BtX2lmX2luX3VzZShkZXZfcHJp
diwgd2FrZXJlZikgewo+IC0JCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVS
UllWSUVXKGRldl9wcml2KSkgewo+IC0JCQl2bHZfcHVuaXRfZ2V0KGRldl9wcml2KTsKPiAtCQkJ
YWN0X2ZyZXEgPSB2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwKPiArCXdpdGhfaW50ZWxfcnVudGlt
ZV9wbV9pZl9pbl91c2UoaTkxNSwgd2FrZXJlZikgewo+ICsJCWlmIChJU19WQUxMRVlWSUVXKGk5
MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiArCQkJdmx2X3B1bml0X2dldChpOTE1KTsK
PiArCQkJYWN0X2ZyZXEgPSB2bHZfcHVuaXRfcmVhZChpOTE1LAo+ICAgCQkJCQkJICBQVU5JVF9S
RUdfR1BVX0ZSRVFfU1RTKTsKPiAtCQkJdmx2X3B1bml0X3B1dChkZXZfcHJpdik7Cj4gKwkJCXZs
dl9wdW5pdF9wdXQoaTkxNSk7Cj4gICAJCQlhY3RfZnJlcSA9IChhY3RfZnJlcSA+PiA4KSAmIDB4
ZmY7Cj4gICAJCX0gZWxzZSB7Cj4gLQkJCWFjdF9mcmVxID0gaW50ZWxfZ2V0X2NhZ2YoZGV2X3By
aXYsCj4gKwkJCWFjdF9mcmVxID0gaW50ZWxfZ2V0X2NhZ2YoaTkxNSwKPiAgIAkJCQkJCSAgSTkx
NV9SRUFEKEdFTjZfUlBTVEFUMSkpOwo+ICAgCQl9Cj4gICAJfQo+ICAgCj4gICAJc2VxX3ByaW50
ZihtLCAiUlBTIGVuYWJsZWQ/ICVkXG4iLCBycHMtPmVuYWJsZWQpOwo+IC0Jc2VxX3ByaW50Ziht
LCAiR1BVIGJ1c3k/ICVzXG4iLCB5ZXNubyhkZXZfcHJpdi0+Z3QuYXdha2UpKTsKPiArCXNlcV9w
cmludGYobSwgIkdQVSBidXN5PyAlc1xuIiwgeWVzbm8oaTkxNS0+Z3QuYXdha2UpKTsKPiAgIAlz
ZXFfcHJpbnRmKG0sICJCb29zdHMgb3V0c3RhbmRpbmc/ICVkXG4iLAo+ICAgCQkgICBhdG9taWNf
cmVhZCgmcnBzLT5udW1fd2FpdGVycykpOwo+ICAgCXNlcV9wcmludGYobSwgIkludGVyYWN0aXZl
PyAlZFxuIiwgUkVBRF9PTkNFKHJwcy0+cG93ZXIuaW50ZXJhY3RpdmUpKTsKPiAgIAlzZXFfcHJp
bnRmKG0sICJGcmVxdWVuY3kgcmVxdWVzdGVkICVkLCBhY3R1YWwgJWRcbiIsCj4gLQkJICAgaW50
ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+Y3VyX2ZyZXEpLAo+IC0JCSAgIGludGVsX2dwdV9m
cmVxKGRldl9wcml2LCBhY3RfZnJlcSkpOwo+ICsJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUsIHJw
cy0+Y3VyX2ZyZXEpLAo+ICsJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUsIGFjdF9mcmVxKSk7Cj4g
ICAJc2VxX3ByaW50ZihtLCAiICBtaW4gaGFyZDolZCwgc29mdDolZDsgbWF4IHNvZnQ6JWQsIGhh
cmQ6JWRcbiIsCj4gLQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+bWluX2ZyZXEp
LAo+IC0JCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMtPm1pbl9mcmVxX3NvZnRsaW1p
dCksCj4gLQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+bWF4X2ZyZXFfc29mdGxp
bWl0KSwKPiAtCQkgICBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5tYXhfZnJlcSkpOwo+
ICsJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUsIHJwcy0+bWluX2ZyZXEpLAo+ICsJCSAgIGludGVs
X2dwdV9mcmVxKGk5MTUsIHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0KSwKPiArCQkgICBpbnRlbF9n
cHVfZnJlcShpOTE1LCBycHMtPm1heF9mcmVxX3NvZnRsaW1pdCksCj4gKwkJICAgaW50ZWxfZ3B1
X2ZyZXEoaTkxNSwgcnBzLT5tYXhfZnJlcSkpOwo+ICAgCXNlcV9wcmludGYobSwgIiAgaWRsZTol
ZCwgZWZmaWNpZW50OiVkLCBib29zdDolZFxuIiwKPiAtCQkgICBpbnRlbF9ncHVfZnJlcShkZXZf
cHJpdiwgcnBzLT5pZGxlX2ZyZXEpLAo+IC0JCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBy
cHMtPmVmZmljaWVudF9mcmVxKSwKPiAtCQkgICBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBz
LT5ib29zdF9mcmVxKSk7Cj4gKwkJICAgaW50ZWxfZ3B1X2ZyZXEoaTkxNSwgcnBzLT5pZGxlX2Zy
ZXEpLAo+ICsJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUsIHJwcy0+ZWZmaWNpZW50X2ZyZXEpLAo+
ICsJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUsIHJwcy0+Ym9vc3RfZnJlcSkpOwo+ICAgCj4gICAJ
c2VxX3ByaW50ZihtLCAiV2FpdCBib29zdHM6ICVkXG4iLCBhdG9taWNfcmVhZCgmcnBzLT5ib29z
dHMpKTsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNiAmJiBycHMtPmVuYWJs
ZWQgJiYgZGV2X3ByaXYtPmd0LmF3YWtlKSB7Cj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDYg
JiYgcnBzLT5lbmFibGVkICYmIGk5MTUtPmd0LmF3YWtlKSB7Cj4gICAJCXUzMiBycHVwLCBycHVw
ZWk7Cj4gICAJCXUzMiBycGRvd24sIHJwZG93bmVpOwo+ICAgCj4gLQkJaW50ZWxfdW5jb3JlX2Zv
cmNld2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ICsJCWludGVs
X3VuY29yZV9mb3JjZXdha2VfZ2V0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ICAg
CQlycHVwID0gSTkxNV9SRUFEX0ZXKEdFTjZfUlBfQ1VSX1VQKSAmIEdFTjZfUlBfRUlfTUFTSzsK
PiAgIAkJcnB1cGVpID0gSTkxNV9SRUFEX0ZXKEdFTjZfUlBfQ1VSX1VQX0VJKSAmIEdFTjZfUlBf
RUlfTUFTSzsKPiAgIAkJcnBkb3duID0gSTkxNV9SRUFEX0ZXKEdFTjZfUlBfQ1VSX0RPV04pICYg
R0VONl9SUF9FSV9NQVNLOwo+ICAgCQlycGRvd25laSA9IEk5MTVfUkVBRF9GVyhHRU42X1JQX0NV
Ul9ET1dOX0VJKSAmIEdFTjZfUlBfRUlfTUFTSzsKPiAtCQlpbnRlbF91bmNvcmVfZm9yY2V3YWtl
X3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gKwkJaW50ZWxfdW5jb3Jl
X2ZvcmNld2FrZV9wdXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gICAKPiAgIAkJ
c2VxX3ByaW50ZihtLCAiXG5SUFMgQXV0b3R1bmluZyAoY3VycmVudCBcIiVzXCIgd2luZG93KTpc
biIsCj4gICAJCQkgICBycHNfcG93ZXJfdG9fc3RyKHJwcy0+cG93ZXIubW9kZSkpOwo+IEBAIC0x
ODc1LDI5ICsxODc1LDI5IEBAIHN0YXRpYyBpbnQgaTkxNV9ycHNfYm9vc3RfaW5mbyhzdHJ1Y3Qg
c2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gICAKPiAgIHN0YXRpYyBpbnQgaTkxNV9sbGMoc3Ry
dWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+IC0JY29uc3QgYm9v
bCBlZHJhbSA9IElOVEVMX0dFTihkZXZfcHJpdikgPiA4Owo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gKwljb25zdCBib29sIGVk
cmFtID0gSU5URUxfR0VOKGk5MTUpID4gODsKPiAgIAo+IC0Jc2VxX3ByaW50ZihtLCAiTExDOiAl
c1xuIiwgeWVzbm8oSEFTX0xMQyhkZXZfcHJpdikpKTsKPiArCXNlcV9wcmludGYobSwgIkxMQzog
JXNcbiIsIHllc25vKEhBU19MTEMoaTkxNSkpKTsKPiAgIAlzZXFfcHJpbnRmKG0sICIlczogJXVN
QlxuIiwgZWRyYW0gPyAiZURSQU0iIDogImVMTEMiLAo+IC0JCSAgIGRldl9wcml2LT5lZHJhbV9z
aXplX21iKTsKPiArCQkgICBpOTE1LT5lZHJhbV9zaXplX21iKTsKPiAgIAo+ICAgCXJldHVybiAw
Owo+ICAgfQo+ICAgCj4gICBzdGF0aWMgaW50IGk5MTVfaHVjX2xvYWRfc3RhdHVzX2luZm8oc3Ry
dWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gICAJaW50
ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gICAJc3RydWN0IGRybV9wcmludGVyIHA7Cj4gICAKPiAt
CWlmICghSEFTX0hVQyhkZXZfcHJpdikpCj4gKwlpZiAoIUhBU19IVUMoaTkxNSkpCj4gICAJCXJl
dHVybiAtRU5PREVWOwo+ICAgCj4gICAJcCA9IGRybV9zZXFfZmlsZV9wcmludGVyKG0pOwo+IC0J
aW50ZWxfdWNfZndfZHVtcCgmZGV2X3ByaXYtPmh1Yy5mdywgJnApOwo+ICsJaW50ZWxfdWNfZndf
ZHVtcCgmaTkxNS0+aHVjLmZ3LCAmcCk7Cj4gICAKPiAtCXdpdGhfaW50ZWxfcnVudGltZV9wbShk
ZXZfcHJpdiwgd2FrZXJlZikKPiArCXdpdGhfaW50ZWxfcnVudGltZV9wbShpOTE1LCB3YWtlcmVm
KQo+ICAgCQlzZXFfcHJpbnRmKG0sICJcbkh1QyBzdGF0dXMgMHglMDh4OlxuIiwgSTkxNV9SRUFE
KEhVQ19TVEFUVVMyKSk7Cj4gICAKPiAgIAlyZXR1cm4gMDsKPiBAQCAtMTkwNSwxNyArMTkwNSwx
NyBAQCBzdGF0aWMgaW50IGk5MTVfaHVjX2xvYWRfc3RhdHVzX2luZm8oc3RydWN0IHNlcV9maWxl
ICptLCB2b2lkICpkYXRhKQo+ICAgCj4gICBzdGF0aWMgaW50IGk5MTVfZ3VjX2xvYWRfc3RhdHVz
X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ICAgewo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7
Cj4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gICAJc3RydWN0IGRybV9wcmludGVyIHA7
Cj4gICAKPiAtCWlmICghSEFTX0dVQyhkZXZfcHJpdikpCj4gKwlpZiAoIUhBU19HVUMoaTkxNSkp
Cj4gICAJCXJldHVybiAtRU5PREVWOwo+ICAgCj4gICAJcCA9IGRybV9zZXFfZmlsZV9wcmludGVy
KG0pOwo+IC0JaW50ZWxfdWNfZndfZHVtcCgmZGV2X3ByaXYtPmd1Yy5mdywgJnApOwo+ICsJaW50
ZWxfdWNfZndfZHVtcCgmaTkxNS0+Z3VjLmZ3LCAmcCk7Cj4gICAKPiAtCXdpdGhfaW50ZWxfcnVu
dGltZV9wbShkZXZfcHJpdiwgd2FrZXJlZikgewo+ICsJd2l0aF9pbnRlbF9ydW50aW1lX3BtKGk5
MTUsIHdha2VyZWYpIHsKPiAgIAkJdTMyIHRtcCA9IEk5MTVfUkVBRChHVUNfU1RBVFVTKTsKPiAg
IAkJdTMyIGk7Cj4gICAKPiBAQCAtMTk1NCw5ICsxOTU0LDkgQEAgc3RyaW5naWZ5X2d1Y19sb2df
dHlwZShlbnVtIGd1Y19sb2dfYnVmZmVyX3R5cGUgdHlwZSkKPiAgIH0KPiAgIAo+ICAgc3RhdGlj
IHZvaWQgaTkxNV9ndWNfbG9nX2luZm8oc3RydWN0IHNlcV9maWxlICptLAo+IC0JCQkgICAgICBz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gKwkJCSAgICAgIHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RydWN0IGludGVsX2d1Y19sb2cgKmxvZyA9
ICZkZXZfcHJpdi0+Z3VjLmxvZzsKPiArCXN0cnVjdCBpbnRlbF9ndWNfbG9nICpsb2cgPSAmaTkx
NS0+Z3VjLmxvZzsKPiAgIAllbnVtIGd1Y19sb2dfYnVmZmVyX3R5cGUgdHlwZTsKPiAgIAo+ICAg
CWlmICghaW50ZWxfZ3VjX2xvZ19yZWxheV9lbmFibGVkKGxvZykpIHsKPiBAQCAtMTk3OCw3ICsx
OTc4LDcgQEAgc3RhdGljIHZvaWQgaTkxNV9ndWNfbG9nX2luZm8oc3RydWN0IHNlcV9maWxlICpt
LAo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZCBpOTE1X2d1Y19jbGllbnRfaW5mbyhzdHJ1Y3Qg
c2VxX2ZpbGUgKm0sCj4gLQkJCQkgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICsJCQkJIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSBzdHJ1Y3QgaW50
ZWxfZ3VjX2NsaWVudCAqY2xpZW50KQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZTsKPiBAQCAtMTk5MCw3ICsxOTkwLDcgQEAgc3RhdGljIHZvaWQgaTkxNV9ndWNfY2xp
ZW50X2luZm8oc3RydWN0IHNlcV9maWxlICptLAo+ICAgCXNlcV9wcmludGYobSwgIlx0RG9vcmJl
bGwgaWQgJWQsIG9mZnNldDogMHglbHhcbiIsCj4gICAJCWNsaWVudC0+ZG9vcmJlbGxfaWQsIGNs
aWVudC0+ZG9vcmJlbGxfb2Zmc2V0KTsKPiAgIAo+IC0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwg
ZGV2X3ByaXYsIGlkKSB7Cj4gKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgewo+
ICAgCQl1NjQgc3VibWlzc2lvbnMgPSBjbGllbnQtPnN1Ym1pc3Npb25zW2lkXTsKPiAgIAkJdG90
ICs9IHN1Ym1pc3Npb25zOwo+ICAgCQlzZXFfcHJpbnRmKG0sICJcdFN1Ym1pc3Npb25zOiAlbGx1
ICVzXG4iLAo+IEBAIC0yMDAxLDE1ICsyMDAxLDE1IEBAIHN0YXRpYyB2b2lkIGk5MTVfZ3VjX2Ns
aWVudF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwKPiAgIAo+ICAgc3RhdGljIGludCBpOTE1X2d1
Y19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiAgIHsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiAt
CWNvbnN0IHN0cnVjdCBpbnRlbF9ndWMgKmd1YyA9ICZkZXZfcHJpdi0+Z3VjOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gKwlj
b25zdCBzdHJ1Y3QgaW50ZWxfZ3VjICpndWMgPSAmaTkxNS0+Z3VjOwo+ICAgCj4gLQlpZiAoIVVT
RVNfR1VDKGRldl9wcml2KSkKPiArCWlmICghVVNFU19HVUMoaTkxNSkpCj4gICAJCXJldHVybiAt
RU5PREVWOwo+ICAgCj4gLQlpOTE1X2d1Y19sb2dfaW5mbyhtLCBkZXZfcHJpdik7Cj4gKwlpOTE1
X2d1Y19sb2dfaW5mbyhtLCBpOTE1KTsKPiAgIAo+IC0JaWYgKCFVU0VTX0dVQ19TVUJNSVNTSU9O
KGRldl9wcml2KSkKPiArCWlmICghVVNFU19HVUNfU1VCTUlTU0lPTihpOTE1KSkKPiAgIAkJcmV0
dXJuIDA7Cj4gICAKPiAgIAlHRU1fQlVHX09OKCFndWMtPmV4ZWNidWZfY2xpZW50KTsKPiBAQCAt
MjAxOSwxMSArMjAxOSwxMSBAQCBzdGF0aWMgaW50IGk5MTVfZ3VjX2luZm8oc3RydWN0IHNlcV9m
aWxlICptLCB2b2lkICpkYXRhKQo+ICAgCXNlcV9wcmludGYobSwgIkRvb3JiZWxsIG5leHQgY2Fj
aGVsaW5lOiAweCV4XG4iLCBndWMtPmRiX2NhY2hlbGluZSk7Cj4gICAKPiAgIAlzZXFfcHJpbnRm
KG0sICJcbkd1QyBleGVjYnVmIGNsaWVudCBAICVwOlxuIiwgZ3VjLT5leGVjYnVmX2NsaWVudCk7
Cj4gLQlpOTE1X2d1Y19jbGllbnRfaW5mbyhtLCBkZXZfcHJpdiwgZ3VjLT5leGVjYnVmX2NsaWVu
dCk7Cj4gKwlpOTE1X2d1Y19jbGllbnRfaW5mbyhtLCBpOTE1LCBndWMtPmV4ZWNidWZfY2xpZW50
KTsKPiAgIAlpZiAoZ3VjLT5wcmVlbXB0X2NsaWVudCkgewo+ICAgCQlzZXFfcHJpbnRmKG0sICJc
bkd1QyBwcmVlbXB0IGNsaWVudCBAICVwOlxuIiwKPiAgIAkJCSAgIGd1Yy0+cHJlZW1wdF9jbGll
bnQpOwo+IC0JCWk5MTVfZ3VjX2NsaWVudF9pbmZvKG0sIGRldl9wcml2LCBndWMtPnByZWVtcHRf
Y2xpZW50KTsKPiArCQlpOTE1X2d1Y19jbGllbnRfaW5mbyhtLCBpOTE1LCBndWMtPnByZWVtcHRf
Y2xpZW50KTsKPiAgIAl9Cj4gICAKPiAgIAkvKiBBZGQgbW9yZSBhcyByZXF1aXJlZCAuLi4gKi8K
PiBAQCAtMjAzMywxNCArMjAzMywxNCBAQCBzdGF0aWMgaW50IGk5MTVfZ3VjX2luZm8oc3RydWN0
IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ICAgCj4gICBzdGF0aWMgaW50IGk5MTVfZ3VjX3N0
YWdlX3Bvb2woc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ICAgewo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+
IC0JY29uc3Qgc3RydWN0IGludGVsX2d1YyAqZ3VjID0gJmRldl9wcml2LT5ndWM7Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiAr
CWNvbnN0IHN0cnVjdCBpbnRlbF9ndWMgKmd1YyA9ICZpOTE1LT5ndWM7Cj4gICAJc3RydWN0IGd1
Y19zdGFnZV9kZXNjICpkZXNjID0gZ3VjLT5zdGFnZV9kZXNjX3Bvb2xfdmFkZHI7Cj4gICAJc3Ry
dWN0IGludGVsX2d1Y19jbGllbnQgKmNsaWVudCA9IGd1Yy0+ZXhlY2J1Zl9jbGllbnQ7Cj4gICAJ
aW50ZWxfZW5naW5lX21hc2tfdCB0bXA7Cj4gICAJaW50IGluZGV4Owo+ICAgCj4gLQlpZiAoIVVT
RVNfR1VDX1NVQk1JU1NJT04oZGV2X3ByaXYpKQo+ICsJaWYgKCFVU0VTX0dVQ19TVUJNSVNTSU9O
KGk5MTUpKQo+ICAgCQlyZXR1cm4gLUVOT0RFVjsKPiAgIAo+ICAgCWZvciAoaW5kZXggPSAwOyBp
bmRleCA8IEdVQ19NQVhfU1RBR0VfREVTQ1JJUFRPUlM7IGluZGV4KyssIGRlc2MrKykgewo+IEBA
IC0yMDY2LDcgKzIwNjYsNyBAQCBzdGF0aWMgaW50IGk5MTVfZ3VjX3N0YWdlX3Bvb2woc3RydWN0
IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ICAgCQkJICAgZGVzYy0+d3FfYWRkciwgZGVzYy0+
d3Ffc2l6ZSk7Cj4gICAJCXNlcV9wdXRjKG0sICdcbicpOwo+ICAgCj4gLQkJZm9yX2VhY2hfZW5n
aW5lX21hc2tlZChlbmdpbmUsIGRldl9wcml2LCBjbGllbnQtPmVuZ2luZXMsIHRtcCkgewo+ICsJ
CWZvcl9lYWNoX2VuZ2luZV9tYXNrZWQoZW5naW5lLCBpOTE1LCBjbGllbnQtPmVuZ2luZXMsIHRt
cCkgewo+ICAgCQkJdTMyIGd1Y19lbmdpbmVfaWQgPSBlbmdpbmUtPmd1Y19pZDsKPiAgIAkJCXN0
cnVjdCBndWNfZXhlY2xpc3RfY29udGV4dCAqbHJjID0KPiAgIAkJCQkJCSZkZXNjLT5scmNbZ3Vj
X2VuZ2luZV9pZF07Cj4gQEAgLTIwODgsMTkgKzIwODgsMTkgQEAgc3RhdGljIGludCBpOTE1X2d1
Y19zdGFnZV9wb29sKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiAgIHN0YXRpYyBp
bnQgaTkxNV9ndWNfbG9nX2R1bXAoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ICAg
ewo+ICAgCXN0cnVjdCBkcm1faW5mb19ub2RlICpub2RlID0gbS0+cHJpdmF0ZTsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShub2RlKTsKPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1KG5vZGUpOwo+ICAgCWJv
b2wgZHVtcF9sb2FkX2VyciA9ICEhbm9kZS0+aW5mb19lbnQtPmRhdGE7Cj4gICAJc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IE5VTEw7Cj4gICAJdTMyICpsb2c7Cj4gICAJaW50IGkg
PSAwOwo+ICAgCj4gLQlpZiAoIUhBU19HVUMoZGV2X3ByaXYpKQo+ICsJaWYgKCFIQVNfR1VDKGk5
MTUpKQo+ICAgCQlyZXR1cm4gLUVOT0RFVjsKPiAgIAo+ICAgCWlmIChkdW1wX2xvYWRfZXJyKQo+
IC0JCW9iaiA9IGRldl9wcml2LT5ndWMubG9hZF9lcnJfbG9nOwo+IC0JZWxzZSBpZiAoZGV2X3By
aXYtPmd1Yy5sb2cudm1hKQo+IC0JCW9iaiA9IGRldl9wcml2LT5ndWMubG9nLnZtYS0+b2JqOwo+
ICsJCW9iaiA9IGk5MTUtPmd1Yy5sb2FkX2Vycl9sb2c7Cj4gKwllbHNlIGlmIChpOTE1LT5ndWMu
bG9nLnZtYSkKPiArCQlvYmogPSBpOTE1LT5ndWMubG9nLnZtYS0+b2JqOwo+ICAgCj4gICAJaWYg
KCFvYmopCj4gICAJCXJldHVybiAwOwo+IEBAIC0yMTI2LDI0ICsyMTI2LDI0IEBAIHN0YXRpYyBp
bnQgaTkxNV9ndWNfbG9nX2R1bXAoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ICAg
Cj4gICBzdGF0aWMgaW50IGk5MTVfZ3VjX2xvZ19sZXZlbF9nZXQodm9pZCAqZGF0YSwgdTY0ICp2
YWwpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkYXRhOwo+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkYXRhOwo+ICAgCj4gLQlpZiAoIVVT
RVNfR1VDKGRldl9wcml2KSkKPiArCWlmICghVVNFU19HVUMoaTkxNSkpCj4gICAJCXJldHVybiAt
RU5PREVWOwo+ICAgCj4gLQkqdmFsID0gaW50ZWxfZ3VjX2xvZ19nZXRfbGV2ZWwoJmRldl9wcml2
LT5ndWMubG9nKTsKPiArCSp2YWwgPSBpbnRlbF9ndWNfbG9nX2dldF9sZXZlbCgmaTkxNS0+Z3Vj
LmxvZyk7Cj4gICAKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGludCBpOTE1
X2d1Y19sb2dfbGV2ZWxfc2V0KHZvaWQgKmRhdGEsIHU2NCB2YWwpCj4gICB7Cj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkYXRhOwo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSBkYXRhOwo+ICAgCj4gLQlpZiAoIVVTRVNfR1VDKGRldl9wcml2KSkKPiAr
CWlmICghVVNFU19HVUMoaTkxNSkpCj4gICAJCXJldHVybiAtRU5PREVWOwo+ICAgCj4gLQlyZXR1
cm4gaW50ZWxfZ3VjX2xvZ19zZXRfbGV2ZWwoJmRldl9wcml2LT5ndWMubG9nLCB2YWwpOwo+ICsJ
cmV0dXJuIGludGVsX2d1Y19sb2dfc2V0X2xldmVsKCZpOTE1LT5ndWMubG9nLCB2YWwpOwo+ICAg
fQo+ICAgCj4gICBERUZJTkVfU0lNUExFX0FUVFJJQlVURShpOTE1X2d1Y19sb2dfbGV2ZWxfZm9w
cywKPiBAQCAtMjE1MiwxNCArMjE1MiwxNCBAQCBERUZJTkVfU0lNUExFX0FUVFJJQlVURShpOTE1
X2d1Y19sb2dfbGV2ZWxfZm9wcywKPiAgIAo+ICAgc3RhdGljIGludCBpOTE1X2d1Y19sb2dfcmVs
YXlfb3BlbihzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZmlsZSkKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGlub2RlLT5pX3ByaXZhdGU7Cj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGlub2RlLT5pX3ByaXZhdGU7Cj4gICAK
PiAtCWlmICghVVNFU19HVUMoZGV2X3ByaXYpKQo+ICsJaWYgKCFVU0VTX0dVQyhpOTE1KSkKPiAg
IAkJcmV0dXJuIC1FTk9ERVY7Cj4gICAKPiAtCWZpbGUtPnByaXZhdGVfZGF0YSA9ICZkZXZfcHJp
di0+Z3VjLmxvZzsKPiArCWZpbGUtPnByaXZhdGVfZGF0YSA9ICZpOTE1LT5ndWMubG9nOwo+ICAg
Cj4gLQlyZXR1cm4gaW50ZWxfZ3VjX2xvZ19yZWxheV9vcGVuKCZkZXZfcHJpdi0+Z3VjLmxvZyk7
Cj4gKwlyZXR1cm4gaW50ZWxfZ3VjX2xvZ19yZWxheV9vcGVuKCZpOTE1LT5ndWMubG9nKTsKPiAg
IH0KPiAgIAo+ICAgc3RhdGljIHNzaXplX3QKPiBAQCAtMjE3Nyw5ICsyMTc3LDkgQEAgaTkxNV9n
dWNfbG9nX3JlbGF5X3dyaXRlKHN0cnVjdCBmaWxlICpmaWxwLAo+ICAgCj4gICBzdGF0aWMgaW50
IGk5MTVfZ3VjX2xvZ19yZWxheV9yZWxlYXNlKHN0cnVjdCBpbm9kZSAqaW5vZGUsIHN0cnVjdCBm
aWxlICpmaWxlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
aW5vZGUtPmlfcHJpdmF0ZTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gaW5v
ZGUtPmlfcHJpdmF0ZTsKPiAgIAo+IC0JaW50ZWxfZ3VjX2xvZ19yZWxheV9jbG9zZSgmZGV2X3By
aXYtPmd1Yy5sb2cpOwo+ICsJaW50ZWxfZ3VjX2xvZ19yZWxheV9jbG9zZSgmaTkxNS0+Z3VjLmxv
Zyk7Cj4gICAKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiBAQCAtMjIwNSwxMiArMjIwNSwxMiBAQCBz
dGF0aWMgaW50IGk5MTVfcHNyX3Npbmtfc3RhdHVzX3Nob3coc3RydWN0IHNlcV9maWxlICptLCB2
b2lkICpkYXRhKQo+ICAgCQkic2luayBpbnRlcm5hbCBlcnJvciIsCj4gICAJfTsKPiAgIAlzdHJ1
Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gbS0+cHJpdmF0ZTsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOwo+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsKPiAg
IAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0KPiAgIAkJZW5jX3RvX2ludGVsX2RwKCZpbnRl
bF9hdHRhY2hlZF9lbmNvZGVyKGNvbm5lY3RvciktPmJhc2UpOwo+ICAgCWludCByZXQ7Cj4gICAK
PiAtCWlmICghQ0FOX1BTUihkZXZfcHJpdikpIHsKPiArCWlmICghQ0FOX1BTUihpOTE1KSkgewo+
ICAgCQlzZXFfcHV0cyhtLCAiUFNSIFVuc3VwcG9ydGVkXG4iKTsKPiAgIAkJcmV0dXJuIC1FTk9E
RVY7Cj4gICAJfQo+IEBAIC0yMjM2LDEyICsyMjM2LDEyIEBAIHN0YXRpYyBpbnQgaTkxNV9wc3Jf
c2lua19zdGF0dXNfc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gICBERUZJ
TkVfU0hPV19BVFRSSUJVVEUoaTkxNV9wc3Jfc2lua19zdGF0dXMpOwo+ICAgCj4gICBzdGF0aWMg
dm9pZAo+IC1wc3Jfc291cmNlX3N0YXR1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsIHN0cnVjdCBzZXFfZmlsZSAqbSkKPiArcHNyX3NvdXJjZV9zdGF0dXMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsIHN0cnVjdCBzZXFfZmlsZSAqbSkKPiAgIHsKPiAgIAl1MzIgdmFs
LCBzdGF0dXNfdmFsOwo+ICAgCWNvbnN0IGNoYXIgKnN0YXR1cyA9ICJ1bmtub3duIjsKPiAgIAo+
IC0JaWYgKGRldl9wcml2LT5wc3IucHNyMl9lbmFibGVkKSB7Cj4gKwlpZiAoaTkxNS0+cHNyLnBz
cjJfZW5hYmxlZCkgewo+ICAgCQlzdGF0aWMgY29uc3QgY2hhciAqIGNvbnN0IGxpdmVfc3RhdHVz
W10gPSB7Cj4gICAJCQkiSURMRSIsCj4gICAJCQkiQ0FQVFVSRSIsCj4gQEAgLTIyODMsMTQgKzIy
ODMsMTQgQEAgcHNyX3NvdXJjZV9zdGF0dXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LCBzdHJ1Y3Qgc2VxX2ZpbGUgKm0pCj4gICAKPiAgIHN0YXRpYyBpbnQgaTkxNV9lZHBfcHNy
X3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gICB7Cj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4g
LQlzdHJ1Y3QgaTkxNV9wc3IgKnBzciA9ICZkZXZfcHJpdi0+cHNyOwo+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gKwlzdHJ1Y3Qg
aTkxNV9wc3IgKnBzciA9ICZpOTE1LT5wc3I7Cj4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7
Cj4gICAJY29uc3QgY2hhciAqc3RhdHVzOwo+ICAgCWJvb2wgZW5hYmxlZDsKPiAgIAl1MzIgdmFs
Owo+ICAgCj4gLQlpZiAoIUhBU19QU1IoZGV2X3ByaXYpKQo+ICsJaWYgKCFIQVNfUFNSKGk5MTUp
KQo+ICAgCQlyZXR1cm4gLUVOT0RFVjsKPiAgIAo+ICAgCXNlcV9wcmludGYobSwgIlNpbmsgc3Vw
cG9ydDogJXMiLCB5ZXNubyhwc3ItPnNpbmtfc3VwcG9ydCkpOwo+IEBAIC0yMzAxLDcgKzIzMDEs
NyBAQCBzdGF0aWMgaW50IGk5MTVfZWRwX3Bzcl9zdGF0dXMoc3RydWN0IHNlcV9maWxlICptLCB2
b2lkICpkYXRhKQo+ICAgCWlmICghcHNyLT5zaW5rX3N1cHBvcnQpCj4gICAJCXJldHVybiAwOwo+
ICAgCj4gLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOwo+ICsJd2Fr
ZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOwo+ICAgCW11dGV4X2xvY2soJnBzci0+
bG9jayk7Cj4gICAKPiAgIAlpZiAocHNyLT5lbmFibGVkKQo+IEBAIC0yMzIyLDE0ICsyMzIyLDE0
IEBAIHN0YXRpYyBpbnQgaTkxNV9lZHBfcHNyX3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZv
aWQgKmRhdGEpCj4gICAJfQo+ICAgCXNlcV9wcmludGYobSwgIlNvdXJjZSBQU1IgY3RsOiAlcyBb
MHglMDh4XVxuIiwKPiAgIAkJICAgZW5hYmxlZGRpc2FibGVkKGVuYWJsZWQpLCB2YWwpOwo+IC0J
cHNyX3NvdXJjZV9zdGF0dXMoZGV2X3ByaXYsIG0pOwo+ICsJcHNyX3NvdXJjZV9zdGF0dXMoaTkx
NSwgbSk7Cj4gICAJc2VxX3ByaW50ZihtLCAiQnVzeSBmcm9udGJ1ZmZlciBiaXRzOiAweCUwOHhc
biIsCj4gICAJCSAgIHBzci0+YnVzeV9mcm9udGJ1ZmZlcl9iaXRzKTsKPiAgIAo+ICAgCS8qCj4g
ICAJICogU0tMKyBQZXJmIGNvdW50ZXIgaXMgcmVzZXQgdG8gMCBldmVyeXRpbWUgREMgc3RhdGUg
aXMgZW50ZXJlZAo+ICAgCSAqLwo+IC0JaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElTX0JS
T0FEV0VMTChkZXZfcHJpdikpIHsKPiArCWlmIChJU19IQVNXRUxMKGk5MTUpIHx8IElTX0JST0FE
V0VMTChpOTE1KSkgewo+ICAgCQl2YWwgPSBJOTE1X1JFQUQoRURQX1BTUl9QRVJGX0NOVCkgJiBF
RFBfUFNSX1BFUkZfQ05UX01BU0s7Cj4gICAJCXNlcV9wcmludGYobSwgIlBlcmZvcm1hbmNlIGNv
dW50ZXI6ICV1XG4iLCB2YWwpOwo+ICAgCX0KPiBAQCAtMjM2NSw3ICsyMzY1LDcgQEAgc3RhdGlj
IGludCBpOTE1X2VkcF9wc3Jfc3RhdHVzKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkK
PiAgIAo+ICAgdW5sb2NrOgo+ICAgCW11dGV4X3VubG9jaygmcHNyLT5sb2NrKTsKPiAtCWludGVs
X3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKPiArCWludGVsX3J1bnRpbWVfcG1f
cHV0KGk5MTUsIHdha2VyZWYpOwo+ICAgCj4gICAJcmV0dXJuIDA7Cj4gICB9Cj4gQEAgLTIzNzMs
MjAgKzIzNzMsMjAgQEAgc3RhdGljIGludCBpOTE1X2VkcF9wc3Jfc3RhdHVzKHN0cnVjdCBzZXFf
ZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiAgIHN0YXRpYyBpbnQKPiAgIGk5MTVfZWRwX3Bzcl9kZWJ1
Z19zZXQodm9pZCAqZGF0YSwgdTY0IHZhbCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IGRhdGE7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IGRhdGE7Cj4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gICAJaW50IHJldDsKPiAgIAo+
IC0JaWYgKCFDQU5fUFNSKGRldl9wcml2KSkKPiArCWlmICghQ0FOX1BTUihpOTE1KSkKPiAgIAkJ
cmV0dXJuIC1FTk9ERVY7Cj4gICAKPiAgIAlEUk1fREVCVUdfS01TKCJTZXR0aW5nIFBTUiBkZWJ1
ZyB0byAlbGx4XG4iLCB2YWwpOwo+ICAgCj4gLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9n
ZXQoZGV2X3ByaXYpOwo+ICsJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOwo+
ICAgCj4gLQlyZXQgPSBpbnRlbF9wc3JfZGVidWdfc2V0KGRldl9wcml2LCB2YWwpOwo+ICsJcmV0
ID0gaW50ZWxfcHNyX2RlYnVnX3NldChpOTE1LCB2YWwpOwo+ICAgCj4gLQlpbnRlbF9ydW50aW1l
X3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7Cj4gKwlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1
LCB3YWtlcmVmKTsKPiAgIAo+ICAgCXJldHVybiByZXQ7Cj4gICB9Cj4gQEAgLTIzOTQsMTIgKzIz
OTQsMTIgQEAgaTkxNV9lZHBfcHNyX2RlYnVnX3NldCh2b2lkICpkYXRhLCB1NjQgdmFsKQo+ICAg
c3RhdGljIGludAo+ICAgaTkxNV9lZHBfcHNyX2RlYnVnX2dldCh2b2lkICpkYXRhLCB1NjQgKnZh
bCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRhdGE7Cj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRhdGE7Cj4gICAKPiAtCWlmICghQ0FO
X1BTUihkZXZfcHJpdikpCj4gKwlpZiAoIUNBTl9QU1IoaTkxNSkpCj4gICAJCXJldHVybiAtRU5P
REVWOwo+ICAgCj4gLQkqdmFsID0gUkVBRF9PTkNFKGRldl9wcml2LT5wc3IuZGVidWcpOwo+ICsJ
KnZhbCA9IFJFQURfT05DRShpOTE1LT5wc3IuZGVidWcpOwo+ICAgCXJldHVybiAwOwo+ICAgfQo+
ICAgCj4gQEAgLTI0MDksMTkgKzI0MDksMTkgQEAgREVGSU5FX1NJTVBMRV9BVFRSSUJVVEUoaTkx
NV9lZHBfcHNyX2RlYnVnX2ZvcHMsCj4gICAKPiAgIHN0YXRpYyBpbnQgaTkxNV9lbmVyZ3lfdUoo
c3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gICAJ
dW5zaWduZWQgbG9uZyBsb25nIHBvd2VyOwo+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+
ICAgCXUzMiB1bml0czsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA2KQo+ICsJ
aWYgKElOVEVMX0dFTihpOTE1KSA8IDYpCj4gICAJCXJldHVybiAtRU5PREVWOwo+ICAgCj4gICAJ
aWYgKHJkbXNybF9zYWZlKE1TUl9SQVBMX1BPV0VSX1VOSVQsICZwb3dlcikpCj4gICAJCXJldHVy
biAtRU5PREVWOwo+ICAgCj4gICAJdW5pdHMgPSAocG93ZXIgJiAweDFmMDApID4+IDg7Cj4gLQl3
aXRoX2ludGVsX3J1bnRpbWVfcG0oZGV2X3ByaXYsIHdha2VyZWYpCj4gKwl3aXRoX2ludGVsX3J1
bnRpbWVfcG0oaTkxNSwgd2FrZXJlZikKPiAgIAkJcG93ZXIgPSBJOTE1X1JFQUQoTUNIX1NFQ1Bf
TlJHX1NUVFMpOwo+ICAgCj4gICAJcG93ZXIgPSAoMTAwMDAwMCAqIHBvd2VyKSA+PiB1bml0czsg
LyogY29udmVydCB0byB1SiAqLwo+IEBAIC0yNDMyLDIxICsyNDMyLDIxIEBAIHN0YXRpYyBpbnQg
aTkxNV9lbmVyZ3lfdUooc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ICAgCj4gICBz
dGF0aWMgaW50IGk5MTVfcnVudGltZV9wbV9zdGF0dXMoc3RydWN0IHNlcV9maWxlICptLCB2b2lk
ICp1bnVzZWQpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBu
b2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gLQlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGRldl9w
cml2LT5kcm0ucGRldjsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90
b19pOTE1KG0tPnByaXZhdGUpOwo+ICsJc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBpOTE1LT5kcm0u
cGRldjsKPiAgIAo+IC0JaWYgKCFIQVNfUlVOVElNRV9QTShkZXZfcHJpdikpCj4gKwlpZiAoIUhB
U19SVU5USU1FX1BNKGk5MTUpKQo+ICAgCQlzZXFfcHV0cyhtLCAiUnVudGltZSBwb3dlciBtYW5h
Z2VtZW50IG5vdCBzdXBwb3J0ZWRcbiIpOwo+ICAgCj4gICAJc2VxX3ByaW50ZihtLCAiUnVudGlt
ZSBwb3dlciBzdGF0dXM6ICVzXG4iLAo+IC0JCSAgIGVuYWJsZWRkaXNhYmxlZCghZGV2X3ByaXYt
PnBvd2VyX2RvbWFpbnMud2FrZXJlZikpOwo+ICsJCSAgIGVuYWJsZWRkaXNhYmxlZCghaTkxNS0+
cG93ZXJfZG9tYWlucy53YWtlcmVmKSk7Cj4gICAKPiAtCXNlcV9wcmludGYobSwgIkdQVSBpZGxl
OiAlc1xuIiwgeWVzbm8oIWRldl9wcml2LT5ndC5hd2FrZSkpOwo+ICsJc2VxX3ByaW50ZihtLCAi
R1BVIGlkbGU6ICVzXG4iLCB5ZXNubyghaTkxNS0+Z3QuYXdha2UpKTsKPiAgIAlzZXFfcHJpbnRm
KG0sICJJUlFzIGRpc2FibGVkOiAlc1xuIiwKPiAtCQkgICB5ZXNubyghaW50ZWxfaXJxc19lbmFi
bGVkKGRldl9wcml2KSkpOwo+ICsJCSAgIHllc25vKCFpbnRlbF9pcnFzX2VuYWJsZWQoaTkxNSkp
KTsKPiAgICNpZmRlZiBDT05GSUdfUE0KPiAgIAlzZXFfcHJpbnRmKG0sICJVc2FnZSBjb3VudDog
JWRcbiIsCj4gLQkJICAgYXRvbWljX3JlYWQoJmRldl9wcml2LT5kcm0uZGV2LT5wb3dlci51c2Fn
ZV9jb3VudCkpOwo+ICsJCSAgIGF0b21pY19yZWFkKCZpOTE1LT5kcm0uZGV2LT5wb3dlci51c2Fn
ZV9jb3VudCkpOwo+ICAgI2Vsc2UKPiAgIAlzZXFfcHJpbnRmKG0sICJEZXZpY2UgUG93ZXIgTWFu
YWdlbWVudCAoQ09ORklHX1BNKSBkaXNhYmxlZFxuIik7Cj4gICAjZW5kaWYKPiBAQCAtMjQ1Nyw3
ICsyNDU3LDcgQEAgc3RhdGljIGludCBpOTE1X3J1bnRpbWVfcG1fc3RhdHVzKHN0cnVjdCBzZXFf
ZmlsZSAqbSwgdm9pZCAqdW51c2VkKQo+ICAgCWlmIChJU19FTkFCTEVEKENPTkZJR19EUk1fSTkx
NV9ERUJVR19SVU5USU1FX1BNKSkgewo+ICAgCQlzdHJ1Y3QgZHJtX3ByaW50ZXIgcCA9IGRybV9z
ZXFfZmlsZV9wcmludGVyKG0pOwo+ICAgCj4gLQkJcHJpbnRfaW50ZWxfcnVudGltZV9wbV93YWtl
cmVmKGRldl9wcml2LCAmcCk7Cj4gKwkJcHJpbnRfaW50ZWxfcnVudGltZV9wbV93YWtlcmVmKGk5
MTUsICZwKTsKPiAgIAl9Cj4gICAKPiAgIAlyZXR1cm4gMDsKPiBAQCAtMjQ2NSw4ICsyNDY1LDgg
QEAgc3RhdGljIGludCBpOTE1X3J1bnRpbWVfcG1fc3RhdHVzKHN0cnVjdCBzZXFfZmlsZSAqbSwg
dm9pZCAqdW51c2VkKQo+ICAgCj4gICBzdGF0aWMgaW50IGk5MTVfcG93ZXJfZG9tYWluX2luZm8o
c3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gLQlzdHJ1
Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9k
b21haW5zOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUo
bS0+cHJpdmF0ZSk7Cj4gKwlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5z
ID0gJmk5MTUtPnBvd2VyX2RvbWFpbnM7Cj4gICAJaW50IGk7Cj4gICAKPiAgIAltdXRleF9sb2Nr
KCZwb3dlcl9kb21haW5zLT5sb2NrKTsKPiBAQCAtMjQ5MywxNiArMjQ5MywxNiBAQCBzdGF0aWMg
aW50IGk5MTVfcG93ZXJfZG9tYWluX2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVz
ZWQpCj4gICAKPiAgIHN0YXRpYyBpbnQgaTkxNV9kbWNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0s
IHZvaWQgKnVudXNlZCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ICAgCWludGVsX3dha2VyZWZfdCB3
YWtlcmVmOwo+ICAgCXN0cnVjdCBpbnRlbF9jc3IgKmNzcjsKPiAgIAo+IC0JaWYgKCFIQVNfQ1NS
KGRldl9wcml2KSkKPiArCWlmICghSEFTX0NTUihpOTE1KSkKPiAgIAkJcmV0dXJuIC1FTk9ERVY7
Cj4gICAKPiAtCWNzciA9ICZkZXZfcHJpdi0+Y3NyOwo+ICsJY3NyID0gJmk5MTUtPmNzcjsKPiAg
IAo+IC0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKPiArCXdha2Vy
ZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKPiAgIAo+ICAgCXNlcV9wcmludGYobSwg
ImZ3IGxvYWRlZDogJXNcbiIsIHllc25vKGNzci0+ZG1jX3BheWxvYWQgIT0gTlVMTCkpOwo+ICAg
CXNlcV9wcmludGYobSwgInBhdGg6ICVzXG4iLCBjc3ItPmZ3X3BhdGgpOwo+IEBAIC0yNTEzLDEz
ICsyNTEzLDEzIEBAIHN0YXRpYyBpbnQgaTkxNV9kbWNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0s
IHZvaWQgKnVudXNlZCkKPiAgIAlzZXFfcHJpbnRmKG0sICJ2ZXJzaW9uOiAlZC4lZFxuIiwgQ1NS
X1ZFUlNJT05fTUFKT1IoY3NyLT52ZXJzaW9uKSwKPiAgIAkJICAgQ1NSX1ZFUlNJT05fTUlOT1Io
Y3NyLT52ZXJzaW9uKSk7Cj4gICAKPiAtCWlmIChXQVJOX09OKElOVEVMX0dFTihkZXZfcHJpdikg
PiAxMSkpCj4gKwlpZiAoV0FSTl9PTihJTlRFTF9HRU4oaTkxNSkgPiAxMSkpCj4gICAJCWdvdG8g
b3V0Owo+ICAgCj4gICAJc2VxX3ByaW50ZihtLCAiREMzIC0+IERDNSBjb3VudDogJWRcbiIsCj4g
LQkJICAgSTkxNV9SRUFEKElTX0JST1hUT04oZGV2X3ByaXYpID8gQlhUX0NTUl9EQzNfREM1X0NP
VU5UIDoKPiArCQkgICBJOTE1X1JFQUQoSVNfQlJPWFRPTihpOTE1KSA/IEJYVF9DU1JfREMzX0RD
NV9DT1VOVCA6Cj4gICAJCQkJCQkgICAgU0tMX0NTUl9EQzNfREM1X0NPVU5UKSk7Cj4gLQlpZiAo
IUlTX0dFTjlfTFAoZGV2X3ByaXYpKQo+ICsJaWYgKCFJU19HRU45X0xQKGk5MTUpKQo+ICAgCQlz
ZXFfcHJpbnRmKG0sICJEQzUgLT4gREM2IGNvdW50OiAlZFxuIiwKPiAgIAkJCSAgIEk5MTVfUkVB
RChTS0xfQ1NSX0RDNV9EQzZfQ09VTlQpKTsKPiAgIAo+IEBAIC0yNTI4LDcgKzI1MjgsNyBAQCBz
dGF0aWMgaW50IGk5MTVfZG1jX2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQp
Cj4gICAJc2VxX3ByaW50ZihtLCAic3NwIGJhc2U6IDB4JTA4eFxuIiwgSTkxNV9SRUFEKENTUl9T
U1BfQkFTRSkpOwo+ICAgCXNlcV9wcmludGYobSwgImh0cDogMHglMDh4XG4iLCBJOTE1X1JFQUQo
Q1NSX0hUUF9TS0wpKTsKPiAgIAo+IC0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdh
a2VyZWYpOwo+ICsJaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7Cj4gICAKPiAg
IAlyZXR1cm4gMDsKPiAgIH0KPiBAQCAtMjU0OCw4ICsyNTQ4LDggQEAgc3RhdGljIHZvaWQgaW50
ZWxfZW5jb2Rlcl9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwKPiAgIAkJCSAgICAgICBzdHJ1Y3Qg
aW50ZWxfY3J0YyAqaW50ZWxfY3J0YywKPiAgIAkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqaW50ZWxfZW5jb2RlcikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYgPSAmZGV2X3ByaXYtPmRybTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
bm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ICsJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZp
OTE1LT5kcm07Cj4gICAJc3RydWN0IGRybV9jcnRjICpjcnRjID0gJmludGVsX2NydGMtPmJhc2U7
Cj4gICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqaW50ZWxfY29ubmVjdG9yOwo+ICAgCXN0cnVj
dCBkcm1fZW5jb2RlciAqZW5jb2RlcjsKPiBAQCAtMjU3NSw4ICsyNTc1LDggQEAgc3RhdGljIHZv
aWQgaW50ZWxfZW5jb2Rlcl9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwKPiAgIAo+ICAgc3RhdGlj
IHZvaWQgaW50ZWxfY3J0Y19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgc3RydWN0IGludGVsX2Ny
dGMgKmludGVsX2NydGMpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
ID0gJmRldl9wcml2LT5kcm07Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5v
ZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmaTkx
NS0+ZHJtOwo+ICAgCXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9ICZpbnRlbF9jcnRjLT5iYXNlOwo+
ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICppbnRlbF9lbmNvZGVyOwo+ICAgCXN0cnVjdCBkcm1f
cGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlID0gY3J0Yy0+cHJpbWFyeS0+c3RhdGU7Cj4gQEAgLTI3
MzEsOCArMjczMSw4IEBAIHN0YXRpYyB2b2lkIHBsYW5lX3JvdGF0aW9uKGNoYXIgKmJ1Ziwgc2l6
ZV90IGJ1ZnNpemUsIHVuc2lnbmVkIGludCByb3RhdGlvbikKPiAgIAo+ICAgc3RhdGljIHZvaWQg
aW50ZWxfcGxhbmVfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHN0cnVjdCBpbnRlbF9jcnRjICpp
bnRlbF9jcnRjKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
bm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+IC0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZk
ZXZfcHJpdi0+ZHJtOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3Rv
X2k5MTUobS0+cHJpdmF0ZSk7Cj4gKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmk5MTUtPmRy
bTsKPiAgIAlzdHJ1Y3QgaW50ZWxfcGxhbmUgKmludGVsX3BsYW5lOwo+ICAgCj4gICAJZm9yX2Vh
Y2hfaW50ZWxfcGxhbmVfb25fY3J0YyhkZXYsIGludGVsX2NydGMsIGludGVsX3BsYW5lKSB7Cj4g
QEAgLTI4MDUsMTQgKzI4MDUsMTQgQEAgc3RhdGljIHZvaWQgaW50ZWxfc2NhbGVyX2luZm8oc3Ry
dWN0IHNlcV9maWxlICptLCBzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YykKPiAgIAo+ICAg
c3RhdGljIGludCBpOTE1X2Rpc3BsYXlfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVu
dXNlZCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVf
dG9faTkxNShtLT5wcml2YXRlKTsKPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3By
aXYtPmRybTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1
KG0tPnByaXZhdGUpOwo+ICsJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZpOTE1LT5kcm07Cj4g
ICAJc3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4gICAJc3RydWN0IGRybV9jb25uZWN0b3IgKmNv
bm5lY3RvcjsKPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9saXN0X2l0ZXIgY29ubl9pdGVyOwo+
ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICAgCj4gLQl3YWtlcmVmID0gaW50ZWxfcnVu
dGltZV9wbV9nZXQoZGV2X3ByaXYpOwo+ICsJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0
KGk5MTUpOwo+ICAgCj4gICAJc2VxX3ByaW50ZihtLCAiQ1JUQyBpbmZvXG4iKTsKPiAgIAlzZXFf
cHJpbnRmKG0sICItLS0tLS0tLS1cbiIpOwo+IEBAIC0yODYxLDQyICsyODYxLDQyIEBAIHN0YXRp
YyBpbnQgaTkxNV9kaXNwbGF5X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQp
Cj4gICAJZHJtX2Nvbm5lY3Rvcl9saXN0X2l0ZXJfZW5kKCZjb25uX2l0ZXIpOwo+ICAgCW11dGV4
X3VubG9jaygmZGV2LT5tb2RlX2NvbmZpZy5tdXRleCk7Cj4gICAKPiAtCWludGVsX3J1bnRpbWVf
cG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKPiArCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUs
IHdha2VyZWYpOwo+ICAgCj4gICAJcmV0dXJuIDA7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQg
aTkxNV9lbmdpbmVfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKPiAgIHsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5w
cml2YXRlKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1
KG0tPnByaXZhdGUpOwo+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKPiAgIAlp
bnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiAgIAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKPiAg
IAlzdHJ1Y3QgZHJtX3ByaW50ZXIgcDsKPiAgIAo+IC0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVf
cG1fZ2V0KGRldl9wcml2KTsKPiArCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1
KTsKPiAgIAo+ICAgCXNlcV9wcmludGYobSwgIkdUIGF3YWtlPyAlcyBbJWRdXG4iLAo+IC0JCSAg
IHllc25vKGRldl9wcml2LT5ndC5hd2FrZSksCj4gLQkJICAgYXRvbWljX3JlYWQoJmRldl9wcml2
LT5ndC53YWtlcmVmLmNvdW50KSk7Cj4gKwkJICAgeWVzbm8oaTkxNS0+Z3QuYXdha2UpLAo+ICsJ
CSAgIGF0b21pY19yZWFkKCZpOTE1LT5ndC53YWtlcmVmLmNvdW50KSk7Cj4gICAJc2VxX3ByaW50
ZihtLCAiQ1MgdGltZXN0YW1wIGZyZXF1ZW5jeTogJXUga0h6XG4iLAo+IC0JCSAgIFJVTlRJTUVf
SU5GTyhkZXZfcHJpdiktPmNzX3RpbWVzdGFtcF9mcmVxdWVuY3lfa2h6KTsKPiArCQkgICBSVU5U
SU1FX0lORk8oaTkxNSktPmNzX3RpbWVzdGFtcF9mcmVxdWVuY3lfa2h6KTsKPiAgIAo+ICAgCXAg
PSBkcm1fc2VxX2ZpbGVfcHJpbnRlcihtKTsKPiAtCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGRl
dl9wcml2LCBpZCkKPiArCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKQo+ICAgCQlp
bnRlbF9lbmdpbmVfZHVtcChlbmdpbmUsICZwLCAiJXNcbiIsIGVuZ2luZS0+bmFtZSk7Cj4gICAK
PiAtCWludGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKPiArCWludGVsX3J1
bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOwo+ICAgCj4gICAJcmV0dXJuIDA7Cj4gICB9Cj4g
ICAKPiAgIHN0YXRpYyBpbnQgaTkxNV9yY3NfdG9wb2xvZ3koc3RydWN0IHNlcV9maWxlICptLCB2
b2lkICp1bnVzZWQpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiAgIAlzdHJ1Y3QgZHJtX3ByaW50ZXIg
cCA9IGRybV9zZXFfZmlsZV9wcmludGVyKG0pOwo+ICAgCj4gLQlpbnRlbF9kZXZpY2VfaW5mb19k
dW1wX3RvcG9sb2d5KCZSVU5USU1FX0lORk8oZGV2X3ByaXYpLT5zc2V1LCAmcCk7Cj4gKwlpbnRl
bF9kZXZpY2VfaW5mb19kdW1wX3RvcG9sb2d5KCZSVU5USU1FX0lORk8oaTkxNSktPnNzZXUsICZw
KTsKPiAgIAo+ICAgCXJldHVybiAwOwo+ICAgfQo+IEBAIC0yOTEzLDEzICsyOTEzLDEzIEBAIHN0
YXRpYyBpbnQgaTkxNV9zaHJpbmtlcl9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51
c2VkKQo+ICAgCj4gICBzdGF0aWMgaW50IGk5MTVfc2hhcmVkX2RwbGxzX2luZm8oc3RydWN0IHNl
cV9maWxlICptLCB2b2lkICp1bnVzZWQpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gLQlzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2ID0gJmRldl9wcml2LT5kcm07Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiArCXN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYgPSAmaTkxNS0+ZHJtOwo+ICAgCWludCBpOwo+ICAgCj4gICAJZHJtX21vZGVzZXRfbG9ja19h
bGwoZGV2KTsKPiAtCWZvciAoaSA9IDA7IGkgPCBkZXZfcHJpdi0+bnVtX3NoYXJlZF9kcGxsOyBp
KyspIHsKPiAtCQlzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCA9ICZkZXZfcHJpdi0+c2hh
cmVkX2RwbGxzW2ldOwo+ICsJZm9yIChpID0gMDsgaSA8IGk5MTUtPm51bV9zaGFyZWRfZHBsbDsg
aSsrKSB7Cj4gKwkJc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGwgPSAmaTkxNS0+c2hhcmVk
X2RwbGxzW2ldOwo+ICAgCj4gICAJCXNlcV9wcmludGYobSwgIkRQTEwlaTogJXMsIGlkOiAlaVxu
IiwgaSwgcGxsLT5pbmZvLT5uYW1lLAo+ICAgCQkJICAgcGxsLT5pbmZvLT5pZCk7Cj4gQEAgLTI5
NzcsMjggKzI5NzcsMjggQEAgc3RhdGljIGludCBpOTE1X3dhX3JlZ2lzdGVycyhzdHJ1Y3Qgc2Vx
X2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKPiAgIAo+ICAgc3RhdGljIGludCBpOTE1X2lwY19zdGF0
dXNfc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gICB7Cj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBtLT5wcml2YXRlOwo+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSBtLT5wcml2YXRlOwo+ICAgCj4gICAJc2VxX3ByaW50ZihtLCAi
SXNvY2hyb25vdXMgUHJpb3JpdHkgQ29udHJvbDogJXNcbiIsCj4gLQkJCXllc25vKGRldl9wcml2
LT5pcGNfZW5hYmxlZCkpOwo+ICsJCQl5ZXNubyhpOTE1LT5pcGNfZW5hYmxlZCkpOwo+ICAgCXJl
dHVybiAwOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgaW50IGk5MTVfaXBjX3N0YXR1c19vcGVuKHN0
cnVjdCBpbm9kZSAqaW5vZGUsIHN0cnVjdCBmaWxlICpmaWxlKQo+ICAgewo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gaW5vZGUtPmlfcHJpdmF0ZTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gaW5vZGUtPmlfcHJpdmF0ZTsKPiAgIAo+IC0JaWYgKCFI
QVNfSVBDKGRldl9wcml2KSkKPiArCWlmICghSEFTX0lQQyhpOTE1KSkKPiAgIAkJcmV0dXJuIC1F
Tk9ERVY7Cj4gICAKPiAtCXJldHVybiBzaW5nbGVfb3BlbihmaWxlLCBpOTE1X2lwY19zdGF0dXNf
c2hvdywgZGV2X3ByaXYpOwo+ICsJcmV0dXJuIHNpbmdsZV9vcGVuKGZpbGUsIGk5MTVfaXBjX3N0
YXR1c19zaG93LCBpOTE1KTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHNzaXplX3QgaTkxNV9pcGNf
c3RhdHVzX3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLCBjb25zdCBjaGFyIF9fdXNlciAqdWJ1ZiwK
PiAgIAkJCQkgICAgIHNpemVfdCBsZW4sIGxvZmZfdCAqb2ZmcCkKPiAgIHsKPiAgIAlzdHJ1Y3Qg
c2VxX2ZpbGUgKm0gPSBmaWxlLT5wcml2YXRlX2RhdGE7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSBtLT5wcml2YXRlOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBtLT5wcml2YXRlOwo+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICAgCWJv
b2wgZW5hYmxlOwo+ICAgCWludCByZXQ7Cj4gQEAgLTMwMDcsMTIgKzMwMDcsMTIgQEAgc3RhdGlj
IHNzaXplX3QgaTkxNV9pcGNfc3RhdHVzX3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLCBjb25zdCBj
aGFyIF9fdXNlciAqdWJ1ZiwKPiAgIAlpZiAocmV0IDwgMCkKPiAgIAkJcmV0dXJuIHJldDsKPiAg
IAo+IC0Jd2l0aF9pbnRlbF9ydW50aW1lX3BtKGRldl9wcml2LCB3YWtlcmVmKSB7Cj4gLQkJaWYg
KCFkZXZfcHJpdi0+aXBjX2VuYWJsZWQgJiYgZW5hYmxlKQo+ICsJd2l0aF9pbnRlbF9ydW50aW1l
X3BtKGk5MTUsIHdha2VyZWYpIHsKPiArCQlpZiAoIWk5MTUtPmlwY19lbmFibGVkICYmIGVuYWJs
ZSkKPiAgIAkJCURSTV9JTkZPKCJFbmFibGluZyBJUEM6IFdNIHdpbGwgYmUgcHJvcGVyIG9ubHkg
YWZ0ZXIgbmV4dCBjb21taXRcbiIpOwo+IC0JCWRldl9wcml2LT53bS5kaXN0cnVzdF9iaW9zX3dt
ID0gdHJ1ZTsKPiAtCQlkZXZfcHJpdi0+aXBjX2VuYWJsZWQgPSBlbmFibGU7Cj4gLQkJaW50ZWxf
ZW5hYmxlX2lwYyhkZXZfcHJpdik7Cj4gKwkJaTkxNS0+d20uZGlzdHJ1c3RfYmlvc193bSA9IHRy
dWU7Cj4gKwkJaTkxNS0+aXBjX2VuYWJsZWQgPSBlbmFibGU7Cj4gKwkJaW50ZWxfZW5hYmxlX2lw
YyhpOTE1KTsKPiAgIAl9Cj4gICAKPiAgIAlyZXR1cm4gbGVuOwo+IEBAIC0zMDI5LDE5ICszMDI5
LDE5IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVyYXRpb25zIGk5MTVfaXBjX3N0YXR1
c19mb3BzID0gewo+ICAgCj4gICBzdGF0aWMgaW50IGk5MTVfZGRiX2luZm8oc3RydWN0IHNlcV9m
aWxlICptLCB2b2lkICp1bnVzZWQpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gLQlzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2ID0gJmRldl9wcml2LT5kcm07Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYg
PSAmaTkxNS0+ZHJtOwo+ICAgCXN0cnVjdCBza2xfZGRiX2VudHJ5ICplbnRyeTsKPiAgIAlzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YzsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA5
KQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8IDkpCj4gICAJCXJldHVybiAtRU5PREVWOwo+ICAg
Cj4gICAJZHJtX21vZGVzZXRfbG9ja19hbGwoZGV2KTsKPiAgIAo+ICAgCXNlcV9wcmludGYobSwg
IiUtMTVzJThzJThzJThzXG4iLCAiIiwgIlN0YXJ0IiwgIkVuZCIsICJTaXplIik7Cj4gICAKPiAt
CWZvcl9lYWNoX2ludGVsX2NydGMoJmRldl9wcml2LT5kcm0sIGNydGMpIHsKPiArCWZvcl9lYWNo
X2ludGVsX2NydGMoJmk5MTUtPmRybSwgY3J0Yykgewo+ICAgCQlzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSA9Cj4gICAJCQl0b19pbnRlbF9jcnRjX3N0YXRlKGNydGMtPmJhc2Uu
c3RhdGUpOwo+ICAgCQllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gQEAgLTMwNzAsOCAr
MzA3MCw4IEBAIHN0YXRpYyB2b2lkIGRycnNfc3RhdHVzX3Blcl9jcnRjKHN0cnVjdCBzZXFfZmls
ZSAqbSwKPiAgIAkJCQkgc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiAgIAkJCQkgc3RydWN0IGlu
dGVsX2NydGMgKmludGVsX2NydGMpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gLQlzdHJ1Y3QgaTkxNV9kcnJzICpkcnJzID0gJmRl
dl9wcml2LT5kcnJzOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGRldik7Cj4gKwlzdHJ1Y3QgaTkxNV9kcnJzICpkcnJzID0gJmk5MTUtPmRycnM7Cj4gICAJaW50
IHZyZWZyZXNoID0gMDsKPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yOwo+ICAg
CXN0cnVjdCBkcm1fY29ubmVjdG9yX2xpc3RfaXRlciBjb25uX2l0ZXI7Cj4gQEAgLTMwODUsMTEg
KzMwODUsMTEgQEAgc3RhdGljIHZvaWQgZHJyc19zdGF0dXNfcGVyX2NydGMoc3RydWN0IHNlcV9m
aWxlICptLAo+ICAgCX0KPiAgIAlkcm1fY29ubmVjdG9yX2xpc3RfaXRlcl9lbmQoJmNvbm5faXRl
cik7Cj4gICAKPiAtCWlmIChkZXZfcHJpdi0+dmJ0LmRycnNfdHlwZSA9PSBTVEFUSUNfRFJSU19T
VVBQT1JUKQo+ICsJaWYgKGk5MTUtPnZidC5kcnJzX3R5cGUgPT0gU1RBVElDX0RSUlNfU1VQUE9S
VCkKPiAgIAkJc2VxX3B1dHMobSwgIlx0VkJUOiBEUlJTX3R5cGU6IFN0YXRpYyIpOwo+IC0JZWxz
ZSBpZiAoZGV2X3ByaXYtPnZidC5kcnJzX3R5cGUgPT0gU0VBTUxFU1NfRFJSU19TVVBQT1JUKQo+
ICsJZWxzZSBpZiAoaTkxNS0+dmJ0LmRycnNfdHlwZSA9PSBTRUFNTEVTU19EUlJTX1NVUFBPUlQp
Cj4gICAJCXNlcV9wdXRzKG0sICJcdFZCVDogRFJSU190eXBlOiBTZWFtbGVzcyIpOwo+IC0JZWxz
ZSBpZiAoZGV2X3ByaXYtPnZidC5kcnJzX3R5cGUgPT0gRFJSU19OT1RfU1VQUE9SVEVEKQo+ICsJ
ZWxzZSBpZiAoaTkxNS0+dmJ0LmRycnNfdHlwZSA9PSBEUlJTX05PVF9TVVBQT1JURUQpCj4gICAJ
CXNlcV9wdXRzKG0sICJcdFZCVDogRFJSU190eXBlOiBOb25lIik7Cj4gICAJZWxzZQo+ICAgCQlz
ZXFfcHV0cyhtLCAiXHRWQlQ6IERSUlNfdHlwZTogRklYTUU6IFVucmVjb2duaXplZCBWYWx1ZSIp
Owo+IEBAIC0zMTA2LDcgKzMxMDYsNyBAQCBzdGF0aWMgdm9pZCBkcnJzX3N0YXR1c19wZXJfY3J0
YyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sCj4gICAJCS8qIGRpc2FibGVfZHJycygpIHdpbGwgbWFrZSBk
cnJzLT5kcCBOVUxMICovCj4gICAJCWlmICghZHJycy0+ZHApIHsKPiAgIAkJCXNlcV9wdXRzKG0s
ICJJZGxlbmVzcyBEUlJTOiBEaXNhYmxlZFxuIik7Cj4gLQkJCWlmIChkZXZfcHJpdi0+cHNyLmVu
YWJsZWQpCj4gKwkJCWlmIChpOTE1LT5wc3IuZW5hYmxlZCkKPiAgIAkJCQlzZXFfcHV0cyhtLAo+
ICAgCQkJCSJcdEFzIFBTUiBpcyBlbmFibGVkLCBEUlJTIGlzIG5vdCBlbmFibGVkXG4iKTsKPiAg
IAkJCW11dGV4X3VubG9jaygmZHJycy0+bXV0ZXgpOwo+IEBAIC0zMTQzLDggKzMxNDMsOCBAQCBz
dGF0aWMgdm9pZCBkcnJzX3N0YXR1c19wZXJfY3J0YyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sCj4gICAK
PiAgIHN0YXRpYyBpbnQgaTkxNV9kcnJzX3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQg
KnVudXNlZCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5v
ZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2
X3ByaXYtPmRybTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19p
OTE1KG0tPnByaXZhdGUpOwo+ICsJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZpOTE1LT5kcm07
Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGM7Cj4gICAJaW50IGFjdGl2ZV9jcnRj
X2NudCA9IDA7Cj4gICAKPiBAQCAtMzE2Nyw4ICszMTY3LDggQEAgc3RhdGljIGludCBpOTE1X2Ry
cnNfc3RhdHVzKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQo+ICAgCj4gICBzdGF0
aWMgaW50IGk5MTVfZHBfbXN0X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQp
Cj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5
MTUobS0+cHJpdmF0ZSk7Cj4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmRldl9wcml2LT5k
cm07Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5w
cml2YXRlKTsKPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+ICAgCXN0
cnVjdCBpbnRlbF9lbmNvZGVyICppbnRlbF9lbmNvZGVyOwo+ICAgCXN0cnVjdCBpbnRlbF9kaWdp
dGFsX3BvcnQgKmludGVsX2RpZ19wb3J0Owo+ICAgCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25u
ZWN0b3I7Cj4gQEAgLTMyNTcsOCArMzI1Nyw4IEBAIHN0YXRpYyBzc2l6ZV90IGk5MTVfZGlzcGxh
eXBvcnRfdGVzdF9hY3RpdmVfd3JpdGUoc3RydWN0IGZpbGUgKmZpbGUsCj4gICAKPiAgIHN0YXRp
YyBpbnQgaTkxNV9kaXNwbGF5cG9ydF90ZXN0X2FjdGl2ZV9zaG93KHN0cnVjdCBzZXFfZmlsZSAq
bSwgdm9pZCAqZGF0YSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IG0tPnByaXZhdGU7Cj4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmRldl9wcml2LT5k
cm07Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG0tPnByaXZhdGU7Cj4gKwlz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmk5MTUtPmRybTsKPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5l
Y3RvciAqY29ubmVjdG9yOwo+ICAgCXN0cnVjdCBkcm1fY29ubmVjdG9yX2xpc3RfaXRlciBjb25u
X2l0ZXI7Cj4gICAJc3RydWN0IGludGVsX2RwICppbnRlbF9kcDsKPiBAQCAtMzMwNyw4ICszMzA3
LDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBmaWxlX29wZXJhdGlvbnMgaTkxNV9kaXNwbGF5cG9y
dF90ZXN0X2FjdGl2ZV9mb3BzID0gewo+ICAgCj4gICBzdGF0aWMgaW50IGk5MTVfZGlzcGxheXBv
cnRfdGVzdF9kYXRhX3Nob3coc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ICAgewo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbS0+cHJpdmF0ZTsKPiAtCXN0
cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gbS0+cHJpdmF0ZTsKPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYg
PSAmaTkxNS0+ZHJtOwo+ICAgCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3I7Cj4gICAJ
c3RydWN0IGRybV9jb25uZWN0b3JfbGlzdF9pdGVyIGNvbm5faXRlcjsKPiAgIAlzdHJ1Y3QgaW50
ZWxfZHAgKmludGVsX2RwOwo+IEBAIC0zMzUxLDggKzMzNTEsOCBAQCBERUZJTkVfU0hPV19BVFRS
SUJVVEUoaTkxNV9kaXNwbGF5cG9ydF90ZXN0X2RhdGEpOwo+ICAgCj4gICBzdGF0aWMgaW50IGk5
MTVfZGlzcGxheXBvcnRfdGVzdF90eXBlX3Nob3coc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpk
YXRhKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbS0+cHJp
dmF0ZTsKPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbS0+cHJpdmF0ZTsKPiArCXN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+ICAgCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25u
ZWN0b3I7Cj4gICAJc3RydWN0IGRybV9jb25uZWN0b3JfbGlzdF9pdGVyIGNvbm5faXRlcjsKPiAg
IAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwOwo+IEBAIC0zMzgzLDE5ICszMzgzLDE5IEBAIERF
RklORV9TSE9XX0FUVFJJQlVURShpOTE1X2Rpc3BsYXlwb3J0X3Rlc3RfdHlwZSk7Cj4gICAKPiAg
IHN0YXRpYyB2b2lkIHdtX2xhdGVuY3lfc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIGNvbnN0IHUx
NiB3bVs4XSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG0t
PnByaXZhdGU7Cj4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmRldl9wcml2LT5kcm07Cj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG0tPnByaXZhdGU7Cj4gKwlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2ID0gJmk5MTUtPmRybTsKPiAgIAlpbnQgbGV2ZWw7Cj4gICAJaW50IG51
bV9sZXZlbHM7Cj4gICAKPiAtCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiArCWlmIChJ
U19DSEVSUllWSUVXKGk5MTUpKQo+ICAgCQludW1fbGV2ZWxzID0gMzsKPiAtCWVsc2UgaWYgKElT
X1ZBTExFWVZJRVcoZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSkK
PiAgIAkJbnVtX2xldmVscyA9IDE7Cj4gLQllbHNlIGlmIChJU19HNFgoZGV2X3ByaXYpKQo+ICsJ
ZWxzZSBpZiAoSVNfRzRYKGk5MTUpKQo+ICAgCQludW1fbGV2ZWxzID0gMzsKPiAgIAllbHNlCj4g
LQkJbnVtX2xldmVscyA9IGlsa193bV9tYXhfbGV2ZWwoZGV2X3ByaXYpICsgMTsKPiArCQludW1f
bGV2ZWxzID0gaWxrX3dtX21heF9sZXZlbChpOTE1KSArIDE7Cj4gICAKPiAgIAlkcm1fbW9kZXNl
dF9sb2NrX2FsbChkZXYpOwo+ICAgCj4gQEAgLTM0MDYsMTAgKzM0MDYsMTAgQEAgc3RhdGljIHZv
aWQgd21fbGF0ZW5jeV9zaG93KHN0cnVjdCBzZXFfZmlsZSAqbSwgY29uc3QgdTE2IHdtWzhdKQo+
ICAgCQkgKiAtIFdNMSsgbGF0ZW5jeSB2YWx1ZXMgaW4gMC41dXMgdW5pdHMKPiAgIAkJICogLSBs
YXRlbmNpZXMgYXJlIGluIHVzIG9uIGdlbjkvdmx2L2Nodgo+ICAgCQkgKi8KPiAtCQlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA+PSA5IHx8Cj4gLQkJICAgIElTX1ZBTExFWVZJRVcoZGV2X3ByaXYp
IHx8Cj4gLQkJICAgIElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpIHx8Cj4gLQkJICAgIElTX0c0WChk
ZXZfcHJpdikpCj4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5IHx8Cj4gKwkJICAgIElTX1ZB
TExFWVZJRVcoaTkxNSkgfHwKPiArCQkgICAgSVNfQ0hFUlJZVklFVyhpOTE1KSB8fAo+ICsJCSAg
ICBJU19HNFgoaTkxNSkpCj4gICAJCQlsYXRlbmN5ICo9IDEwOwo+ICAgCQllbHNlIGlmIChsZXZl
bCA+IDApCj4gICAJCQlsYXRlbmN5ICo9IDU7Cj4gQEAgLTM0MjMsMTMgKzM0MjMsMTMgQEAgc3Rh
dGljIHZvaWQgd21fbGF0ZW5jeV9zaG93KHN0cnVjdCBzZXFfZmlsZSAqbSwgY29uc3QgdTE2IHdt
WzhdKQo+ICAgCj4gICBzdGF0aWMgaW50IHByaV93bV9sYXRlbmN5X3Nob3coc3RydWN0IHNlcV9m
aWxlICptLCB2b2lkICpkYXRhKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gbS0+cHJpdmF0ZTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
bS0+cHJpdmF0ZTsKPiAgIAljb25zdCB1MTYgKmxhdGVuY2llczsKPiAgIAo+IC0JaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPj0gOSkKPiAtCQlsYXRlbmNpZXMgPSBkZXZfcHJpdi0+d20uc2tsX2xh
dGVuY3k7Cj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkpCj4gKwkJbGF0ZW5jaWVzID0gaTkx
NS0+d20uc2tsX2xhdGVuY3k7Cj4gICAJZWxzZQo+IC0JCWxhdGVuY2llcyA9IGRldl9wcml2LT53
bS5wcmlfbGF0ZW5jeTsKPiArCQlsYXRlbmNpZXMgPSBpOTE1LT53bS5wcmlfbGF0ZW5jeTsKPiAg
IAo+ICAgCXdtX2xhdGVuY3lfc2hvdyhtLCBsYXRlbmNpZXMpOwo+ICAgCj4gQEAgLTM0MzgsMTMg
KzM0MzgsMTMgQEAgc3RhdGljIGludCBwcmlfd21fbGF0ZW5jeV9zaG93KHN0cnVjdCBzZXFfZmls
ZSAqbSwgdm9pZCAqZGF0YSkKPiAgIAo+ICAgc3RhdGljIGludCBzcHJfd21fbGF0ZW5jeV9zaG93
KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IG0tPnByaXZhdGU7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IG0tPnByaXZhdGU7Cj4gICAJY29uc3QgdTE2ICpsYXRlbmNpZXM7Cj4gICAK
PiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gLQkJbGF0ZW5jaWVzID0gZGV2X3By
aXYtPndtLnNrbF9sYXRlbmN5Owo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ICsJCWxh
dGVuY2llcyA9IGk5MTUtPndtLnNrbF9sYXRlbmN5Owo+ICAgCWVsc2UKPiAtCQlsYXRlbmNpZXMg
PSBkZXZfcHJpdi0+d20uc3ByX2xhdGVuY3k7Cj4gKwkJbGF0ZW5jaWVzID0gaTkxNS0+d20uc3By
X2xhdGVuY3k7Cj4gICAKPiAgIAl3bV9sYXRlbmN5X3Nob3cobSwgbGF0ZW5jaWVzKTsKPiAgIAo+
IEBAIC0zNDUzLDEzICszNDUzLDEzIEBAIHN0YXRpYyBpbnQgc3ByX3dtX2xhdGVuY3lfc2hvdyhz
dHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gICAKPiAgIHN0YXRpYyBpbnQgY3VyX3dt
X2xhdGVuY3lfc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gICB7Cj4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBtLT5wcml2YXRlOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBtLT5wcml2YXRlOwo+ICAgCWNvbnN0IHUxNiAqbGF0
ZW5jaWVzOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KQo+IC0JCWxhdGVu
Y2llcyA9IGRldl9wcml2LT53bS5za2xfbGF0ZW5jeTsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkg
Pj0gOSkKPiArCQlsYXRlbmNpZXMgPSBpOTE1LT53bS5za2xfbGF0ZW5jeTsKPiAgIAllbHNlCj4g
LQkJbGF0ZW5jaWVzID0gZGV2X3ByaXYtPndtLmN1cl9sYXRlbmN5Owo+ICsJCWxhdGVuY2llcyA9
IGk5MTUtPndtLmN1cl9sYXRlbmN5Owo+ICAgCj4gICAJd21fbGF0ZW5jeV9zaG93KG0sIGxhdGVu
Y2llcyk7Cj4gICAKPiBAQCAtMzQ2OCw1NCArMzQ2OCw1NCBAQCBzdGF0aWMgaW50IGN1cl93bV9s
YXRlbmN5X3Nob3coc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ICAgCj4gICBzdGF0
aWMgaW50IHByaV93bV9sYXRlbmN5X29wZW4oc3RydWN0IGlub2RlICppbm9kZSwgc3RydWN0IGZp
bGUgKmZpbGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBp
bm9kZS0+aV9wcml2YXRlOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBpbm9k
ZS0+aV9wcml2YXRlOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDUgJiYgIUlT
X0c0WChkZXZfcHJpdikpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgNSAmJiAhSVNfRzRYKGk5
MTUpKQo+ICAgCQlyZXR1cm4gLUVOT0RFVjsKPiAgIAo+IC0JcmV0dXJuIHNpbmdsZV9vcGVuKGZp
bGUsIHByaV93bV9sYXRlbmN5X3Nob3csIGRldl9wcml2KTsKPiArCXJldHVybiBzaW5nbGVfb3Bl
bihmaWxlLCBwcmlfd21fbGF0ZW5jeV9zaG93LCBpOTE1KTsKPiAgIH0KPiAgIAo+ICAgc3RhdGlj
IGludCBzcHJfd21fbGF0ZW5jeV9vcGVuKHN0cnVjdCBpbm9kZSAqaW5vZGUsIHN0cnVjdCBmaWxl
ICpmaWxlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gaW5v
ZGUtPmlfcHJpdmF0ZTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gaW5vZGUt
PmlfcHJpdmF0ZTsKPiAgIAo+IC0JaWYgKEhBU19HTUNIKGRldl9wcml2KSkKPiArCWlmIChIQVNf
R01DSChpOTE1KSkKPiAgIAkJcmV0dXJuIC1FTk9ERVY7Cj4gICAKPiAtCXJldHVybiBzaW5nbGVf
b3BlbihmaWxlLCBzcHJfd21fbGF0ZW5jeV9zaG93LCBkZXZfcHJpdik7Cj4gKwlyZXR1cm4gc2lu
Z2xlX29wZW4oZmlsZSwgc3ByX3dtX2xhdGVuY3lfc2hvdywgaTkxNSk7Cj4gICB9Cj4gICAKPiAg
IHN0YXRpYyBpbnQgY3VyX3dtX2xhdGVuY3lfb3BlbihzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1
Y3QgZmlsZSAqZmlsZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IGlub2RlLT5pX3ByaXZhdGU7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IGlub2RlLT5pX3ByaXZhdGU7Cj4gICAKPiAtCWlmIChIQVNfR01DSChkZXZfcHJpdikpCj4gKwlp
ZiAoSEFTX0dNQ0goaTkxNSkpCj4gICAJCXJldHVybiAtRU5PREVWOwo+ICAgCj4gLQlyZXR1cm4g
c2luZ2xlX29wZW4oZmlsZSwgY3VyX3dtX2xhdGVuY3lfc2hvdywgZGV2X3ByaXYpOwo+ICsJcmV0
dXJuIHNpbmdsZV9vcGVuKGZpbGUsIGN1cl93bV9sYXRlbmN5X3Nob3csIGk5MTUpOwo+ICAgfQo+
ICAgCj4gICBzdGF0aWMgc3NpemVfdCB3bV9sYXRlbmN5X3dyaXRlKHN0cnVjdCBmaWxlICpmaWxl
LCBjb25zdCBjaGFyIF9fdXNlciAqdWJ1ZiwKPiAgIAkJCQlzaXplX3QgbGVuLCBsb2ZmX3QgKm9m
ZnAsIHUxNiB3bVs4XSkKPiAgIHsKPiAgIAlzdHJ1Y3Qgc2VxX2ZpbGUgKm0gPSBmaWxlLT5wcml2
YXRlX2RhdGE7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBtLT5wcml2
YXRlOwo+IC0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZkZXZfcHJpdi0+ZHJtOwo+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBtLT5wcml2YXRlOwo+ICsJc3RydWN0IGRybV9k
ZXZpY2UgKmRldiA9ICZpOTE1LT5kcm07Cj4gICAJdTE2IG5ld1s4XSA9IHsgMCB9Owo+ICAgCWlu
dCBudW1fbGV2ZWxzOwo+ICAgCWludCBsZXZlbDsKPiAgIAlpbnQgcmV0Owo+ICAgCWNoYXIgdG1w
WzMyXTsKPiAgIAo+IC0JaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ICsJaWYgKElTX0NI
RVJSWVZJRVcoaTkxNSkpCj4gICAJCW51bV9sZXZlbHMgPSAzOwo+IC0JZWxzZSBpZiAoSVNfVkFM
TEVZVklFVyhkZXZfcHJpdikpCj4gKwllbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpKQo+ICAg
CQludW1fbGV2ZWxzID0gMTsKPiAtCWVsc2UgaWYgKElTX0c0WChkZXZfcHJpdikpCj4gKwllbHNl
IGlmIChJU19HNFgoaTkxNSkpCj4gICAJCW51bV9sZXZlbHMgPSAzOwo+ICAgCWVsc2UKPiAtCQlu
dW1fbGV2ZWxzID0gaWxrX3dtX21heF9sZXZlbChkZXZfcHJpdikgKyAxOwo+ICsJCW51bV9sZXZl
bHMgPSBpbGtfd21fbWF4X2xldmVsKGk5MTUpICsgMTsKPiAgIAo+ICAgCWlmIChsZW4gPj0gc2l6
ZW9mKHRtcCkpCj4gICAJCXJldHVybiAtRUlOVkFMOwo+IEBAIC0zNTQ2LDEzICszNTQ2LDEzIEBA
IHN0YXRpYyBzc2l6ZV90IHByaV93bV9sYXRlbmN5X3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLCBj
b25zdCBjaGFyIF9fdXNlciAqdWJ1ZiwKPiAgIAkJCQkgICAgc2l6ZV90IGxlbiwgbG9mZl90ICpv
ZmZwKQo+ICAgewo+ICAgCXN0cnVjdCBzZXFfZmlsZSAqbSA9IGZpbGUtPnByaXZhdGVfZGF0YTsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG0tPnByaXZhdGU7Cj4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG0tPnByaXZhdGU7Cj4gICAJdTE2ICpsYXRl
bmNpZXM7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gLQkJbGF0ZW5j
aWVzID0gZGV2X3ByaXYtPndtLnNrbF9sYXRlbmN5Owo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+
PSA5KQo+ICsJCWxhdGVuY2llcyA9IGk5MTUtPndtLnNrbF9sYXRlbmN5Owo+ICAgCWVsc2UKPiAt
CQlsYXRlbmNpZXMgPSBkZXZfcHJpdi0+d20ucHJpX2xhdGVuY3k7Cj4gKwkJbGF0ZW5jaWVzID0g
aTkxNS0+d20ucHJpX2xhdGVuY3k7Cj4gICAKPiAgIAlyZXR1cm4gd21fbGF0ZW5jeV93cml0ZShm
aWxlLCB1YnVmLCBsZW4sIG9mZnAsIGxhdGVuY2llcyk7Cj4gICB9Cj4gQEAgLTM1NjEsMTMgKzM1
NjEsMTMgQEAgc3RhdGljIHNzaXplX3Qgc3ByX3dtX2xhdGVuY3lfd3JpdGUoc3RydWN0IGZpbGUg
KmZpbGUsIGNvbnN0IGNoYXIgX191c2VyICp1YnVmLAo+ICAgCQkJCSAgICBzaXplX3QgbGVuLCBs
b2ZmX3QgKm9mZnApCj4gICB7Cj4gICAJc3RydWN0IHNlcV9maWxlICptID0gZmlsZS0+cHJpdmF0
ZV9kYXRhOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbS0+cHJpdmF0
ZTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbS0+cHJpdmF0ZTsKPiAgIAl1
MTYgKmxhdGVuY2llczsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkKPiAt
CQlsYXRlbmNpZXMgPSBkZXZfcHJpdi0+d20uc2tsX2xhdGVuY3k7Cj4gKwlpZiAoSU5URUxfR0VO
KGk5MTUpID49IDkpCj4gKwkJbGF0ZW5jaWVzID0gaTkxNS0+d20uc2tsX2xhdGVuY3k7Cj4gICAJ
ZWxzZQo+IC0JCWxhdGVuY2llcyA9IGRldl9wcml2LT53bS5zcHJfbGF0ZW5jeTsKPiArCQlsYXRl
bmNpZXMgPSBpOTE1LT53bS5zcHJfbGF0ZW5jeTsKPiAgIAo+ICAgCXJldHVybiB3bV9sYXRlbmN5
X3dyaXRlKGZpbGUsIHVidWYsIGxlbiwgb2ZmcCwgbGF0ZW5jaWVzKTsKPiAgIH0KPiBAQCAtMzU3
NiwxMyArMzU3NiwxMyBAQCBzdGF0aWMgc3NpemVfdCBjdXJfd21fbGF0ZW5jeV93cml0ZShzdHJ1
Y3QgZmlsZSAqZmlsZSwgY29uc3QgY2hhciBfX3VzZXIgKnVidWYsCj4gICAJCQkJICAgIHNpemVf
dCBsZW4sIGxvZmZfdCAqb2ZmcCkKPiAgIHsKPiAgIAlzdHJ1Y3Qgc2VxX2ZpbGUgKm0gPSBmaWxl
LT5wcml2YXRlX2RhdGE7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBt
LT5wcml2YXRlOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBtLT5wcml2YXRl
Owo+ICAgCXUxNiAqbGF0ZW5jaWVzOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+
PSA5KQo+IC0JCWxhdGVuY2llcyA9IGRldl9wcml2LT53bS5za2xfbGF0ZW5jeTsKPiArCWlmIChJ
TlRFTF9HRU4oaTkxNSkgPj0gOSkKPiArCQlsYXRlbmNpZXMgPSBpOTE1LT53bS5za2xfbGF0ZW5j
eTsKPiAgIAllbHNlCj4gLQkJbGF0ZW5jaWVzID0gZGV2X3ByaXYtPndtLmN1cl9sYXRlbmN5Owo+
ICsJCWxhdGVuY2llcyA9IGk5MTUtPndtLmN1cl9sYXRlbmN5Owo+ICAgCj4gICAJcmV0dXJuIHdt
X2xhdGVuY3lfd3JpdGUoZmlsZSwgdWJ1ZiwgbGVuLCBvZmZwLCBsYXRlbmNpZXMpOwo+ICAgfQo+
IEBAIC0zNzUyLDE0ICszNzUyLDE0IEBAIERFRklORV9TSU1QTEVfQVRUUklCVVRFKGk5MTVfZHJv
cF9jYWNoZXNfZm9wcywKPiAgIHN0YXRpYyBpbnQKPiAgIGk5MTVfY2FjaGVfc2hhcmluZ19nZXQo
dm9pZCAqZGF0YSwgdTY0ICp2YWwpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBkYXRhOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkYXRh
Owo+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICAgCXUzMiBzbnBjciA9IDA7Cj4gICAK
PiAtCWlmICghKElTX0dFTl9SQU5HRShkZXZfcHJpdiwgNiwgNykpKQo+ICsJaWYgKCEoSVNfR0VO
X1JBTkdFKGk5MTUsIDYsIDcpKSkKPiAgIAkJcmV0dXJuIC1FTk9ERVY7Cj4gICAKPiAtCXdpdGhf
aW50ZWxfcnVudGltZV9wbShkZXZfcHJpdiwgd2FrZXJlZikKPiArCXdpdGhfaW50ZWxfcnVudGlt
ZV9wbShpOTE1LCB3YWtlcmVmKQo+ICAgCQlzbnBjciA9IEk5MTVfUkVBRChHRU42X01CQ1VOSVRf
U05QQ1IpOwo+ICAgCj4gICAJKnZhbCA9IChzbnBjciAmIEdFTjZfTUJDX1NOUENSX01BU0spID4+
IEdFTjZfTUJDX1NOUENSX1NISUZUOwo+IEBAIC0zNzcwLDE3ICszNzcwLDE3IEBAIGk5MTVfY2Fj
aGVfc2hhcmluZ19nZXQodm9pZCAqZGF0YSwgdTY0ICp2YWwpCj4gICBzdGF0aWMgaW50Cj4gICBp
OTE1X2NhY2hlX3NoYXJpbmdfc2V0KHZvaWQgKmRhdGEsIHU2NCB2YWwpCj4gICB7Cj4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkYXRhOwo+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSBkYXRhOwo+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICAg
Cj4gLQlpZiAoIShJU19HRU5fUkFOR0UoZGV2X3ByaXYsIDYsIDcpKSkKPiArCWlmICghKElTX0dF
Tl9SQU5HRShpOTE1LCA2LCA3KSkpCj4gICAJCXJldHVybiAtRU5PREVWOwo+ICAgCj4gICAJaWYg
KHZhbCA+IDMpCj4gICAJCXJldHVybiAtRUlOVkFMOwo+ICAgCj4gICAJRFJNX0RFQlVHX0RSSVZF
UigiTWFudWFsbHkgc2V0dGluZyB1bmNvcmUgc2hhcmluZyB0byAlbGx1XG4iLCB2YWwpOwo+IC0J
d2l0aF9pbnRlbF9ydW50aW1lX3BtKGRldl9wcml2LCB3YWtlcmVmKSB7Cj4gKwl3aXRoX2ludGVs
X3J1bnRpbWVfcG0oaTkxNSwgd2FrZXJlZikgewo+ICAgCQl1MzIgc25wY3I7Cj4gICAKPiAgIAkJ
LyogVXBkYXRlIHRoZSBjYWNoZSBzaGFyaW5nIHBvbGljeSBoZXJlIGFzIHdlbGwgKi8KPiBAQCAt
Mzc5Nyw3ICszNzk3LDcgQEAgREVGSU5FX1NJTVBMRV9BVFRSSUJVVEUoaTkxNV9jYWNoZV9zaGFy
aW5nX2ZvcHMsCj4gICAJCQlpOTE1X2NhY2hlX3NoYXJpbmdfZ2V0LCBpOTE1X2NhY2hlX3NoYXJp
bmdfc2V0LAo+ICAgCQkJIiVsbHVcbiIpOwo+ICAgCj4gLXN0YXRpYyB2b2lkIGNoZXJyeXZpZXdf
c3NldV9kZXZpY2Vfc3RhdHVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAr
c3RhdGljIHZvaWQgY2hlcnJ5dmlld19zc2V1X2RldmljZV9zdGF0dXMoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJCSAgc3RydWN0IHNzZXVfZGV2X2luZm8gKnNzZXUpCj4g
ICB7Cj4gICAjZGVmaW5lIFNTX01BWCAyCj4gQEAgLTM4MzAsMTEgKzM4MzAsMTEgQEAgc3RhdGlj
IHZvaWQgY2hlcnJ5dmlld19zc2V1X2RldmljZV9zdGF0dXMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ICAgI3VuZGVmIFNTX01BWAo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lk
IGdlbjEwX3NzZXVfZGV2aWNlX3N0YXR1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gK3N0YXRpYyB2b2lkIGdlbjEwX3NzZXVfZGV2aWNlX3N0YXR1cyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAgIHN0cnVjdCBzc2V1X2Rldl9pbmZvICpzc2V1
KQo+ICAgewo+ICAgI2RlZmluZSBTU19NQVggNgo+IC0JY29uc3Qgc3RydWN0IGludGVsX3J1bnRp
bWVfaW5mbyAqaW5mbyA9IFJVTlRJTUVfSU5GTyhkZXZfcHJpdik7Cj4gKwljb25zdCBzdHJ1Y3Qg
aW50ZWxfcnVudGltZV9pbmZvICppbmZvID0gUlVOVElNRV9JTkZPKGk5MTUpOwo+ICAgCXUzMiBz
X3JlZ1tTU19NQVhdLCBldV9yZWdbMiAqIFNTX01BWF0sIGV1X21hc2tbMl07Cj4gICAJaW50IHMs
IHNzOwo+ICAgCj4gQEAgLTM4ODYsMTEgKzM4ODYsMTEgQEAgc3RhdGljIHZvaWQgZ2VuMTBfc3Nl
dV9kZXZpY2Vfc3RhdHVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgICN1
bmRlZiBTU19NQVgKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBnZW45X3NzZXVfZGV2aWNlX3N0
YXR1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGdl
bjlfc3NldV9kZXZpY2Vfc3RhdHVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAg
CQkJCSAgICBzdHJ1Y3Qgc3NldV9kZXZfaW5mbyAqc3NldSkKPiAgIHsKPiAgICNkZWZpbmUgU1Nf
TUFYIDMKPiAtCWNvbnN0IHN0cnVjdCBpbnRlbF9ydW50aW1lX2luZm8gKmluZm8gPSBSVU5USU1F
X0lORk8oZGV2X3ByaXYpOwo+ICsJY29uc3Qgc3RydWN0IGludGVsX3J1bnRpbWVfaW5mbyAqaW5m
byA9IFJVTlRJTUVfSU5GTyhpOTE1KTsKPiAgIAl1MzIgc19yZWdbU1NfTUFYXSwgZXVfcmVnWzIg
KiBTU19NQVhdLCBldV9tYXNrWzJdOwo+ICAgCWludCBzLCBzczsKPiAgIAo+IEBAIC0zOTE2LDE0
ICszOTE2LDE0IEBAIHN0YXRpYyB2b2lkIGdlbjlfc3NldV9kZXZpY2Vfc3RhdHVzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAo+ICAgCQlzc2V1LT5zbGljZV9tYXNrIHw9
IEJJVChzKTsKPiAgIAo+IC0JCWlmIChJU19HRU45X0JDKGRldl9wcml2KSkKPiArCQlpZiAoSVNf
R0VOOV9CQyhpOTE1KSkKPiAgIAkJCXNzZXUtPnN1YnNsaWNlX21hc2tbc10gPQo+IC0JCQkJUlVO
VElNRV9JTkZPKGRldl9wcml2KS0+c3NldS5zdWJzbGljZV9tYXNrW3NdOwo+ICsJCQkJUlVOVElN
RV9JTkZPKGk5MTUpLT5zc2V1LnN1YnNsaWNlX21hc2tbc107Cj4gICAKPiAgIAkJZm9yIChzcyA9
IDA7IHNzIDwgaW5mby0+c3NldS5tYXhfc3Vic2xpY2VzOyBzcysrKSB7Cj4gICAJCQl1bnNpZ25l
ZCBpbnQgZXVfY250Owo+ICAgCj4gLQkJCWlmIChJU19HRU45X0xQKGRldl9wcml2KSkgewo+ICsJ
CQlpZiAoSVNfR0VOOV9MUChpOTE1KSkgewo+ICAgCQkJCWlmICghKHNfcmVnW3NdICYgKEdFTjlf
UEdDVExfU1NfQUNLKHNzKSkpKQo+ICAgCQkJCQkvKiBza2lwIGRpc2FibGVkIHN1YnNsaWNlICov
Cj4gICAJCQkJCWNvbnRpbnVlOwo+IEBAIC0zOTQyLDcgKzM5NDIsNyBAQCBzdGF0aWMgdm9pZCBn
ZW45X3NzZXVfZGV2aWNlX3N0YXR1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gICAjdW5kZWYgU1NfTUFYCj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgYnJvYWR3ZWxsX3Nz
ZXVfZGV2aWNlX3N0YXR1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0
YXRpYyB2b2lkIGJyb2Fkd2VsbF9zc2V1X2RldmljZV9zdGF0dXMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gICAJCQkJCSBzdHJ1Y3Qgc3NldV9kZXZfaW5mbyAqc3NldSkKPiAgIHsK
PiAgIAl1MzIgc2xpY2VfaW5mbyA9IEk5MTVfUkVBRChHRU44X0dUX1NMSUNFX0lORk8pOwo+IEBA
IC0zOTUyLDEwICszOTUyLDEwIEBAIHN0YXRpYyB2b2lkIGJyb2Fkd2VsbF9zc2V1X2RldmljZV9z
dGF0dXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCj4gICAJaWYgKHNz
ZXUtPnNsaWNlX21hc2spIHsKPiAgIAkJc3NldS0+ZXVfcGVyX3N1YnNsaWNlID0KPiAtCQkJUlVO
VElNRV9JTkZPKGRldl9wcml2KS0+c3NldS5ldV9wZXJfc3Vic2xpY2U7Cj4gKwkJCVJVTlRJTUVf
SU5GTyhpOTE1KS0+c3NldS5ldV9wZXJfc3Vic2xpY2U7Cj4gICAJCWZvciAocyA9IDA7IHMgPCBm
bHMoc3NldS0+c2xpY2VfbWFzayk7IHMrKykgewo+ICAgCQkJc3NldS0+c3Vic2xpY2VfbWFza1tz
XSA9Cj4gLQkJCQlSVU5USU1FX0lORk8oZGV2X3ByaXYpLT5zc2V1LnN1YnNsaWNlX21hc2tbc107
Cj4gKwkJCQlSVU5USU1FX0lORk8oaTkxNSktPnNzZXUuc3Vic2xpY2VfbWFza1tzXTsKPiAgIAkJ
fQo+ICAgCQlzc2V1LT5ldV90b3RhbCA9IHNzZXUtPmV1X3Blcl9zdWJzbGljZSAqCj4gICAJCQkJ
IGludGVsX3NzZXVfc3Vic2xpY2VfdG90YWwoc3NldSk7Cj4gQEAgLTM5NjMsNyArMzk2Myw3IEBA
IHN0YXRpYyB2b2lkIGJyb2Fkd2VsbF9zc2V1X2RldmljZV9zdGF0dXMoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCQkvKiBzdWJ0cmFjdCBmdXNlZCBvZmYgRVUocykgZnJv
bSBlbmFibGVkIHNsaWNlKHMpICovCj4gICAJCWZvciAocyA9IDA7IHMgPCBmbHMoc3NldS0+c2xp
Y2VfbWFzayk7IHMrKykgewo+ICAgCQkJdTggc3Vic2xpY2VfN2V1ID0KPiAtCQkJCVJVTlRJTUVf
SU5GTyhkZXZfcHJpdiktPnNzZXUuc3Vic2xpY2VfN2V1W3NdOwo+ICsJCQkJUlVOVElNRV9JTkZP
KGk5MTUpLT5zc2V1LnN1YnNsaWNlXzdldVtzXTsKPiAgIAo+ICAgCQkJc3NldS0+ZXVfdG90YWwg
LT0gaHdlaWdodDgoc3Vic2xpY2VfN2V1KTsKPiAgIAkJfQo+IEBAIC0zOTczLDcgKzM5NzMsNyBA
QCBzdGF0aWMgdm9pZCBicm9hZHdlbGxfc3NldV9kZXZpY2Vfc3RhdHVzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIHN0YXRpYyB2b2lkIGk5MTVfcHJpbnRfc3NldV9pbmZv
KHN0cnVjdCBzZXFfZmlsZSAqbSwgYm9vbCBpc19hdmFpbGFibGVfaW5mbywKPiAgIAkJCQkgY29u
c3Qgc3RydWN0IHNzZXVfZGV2X2luZm8gKnNzZXUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiAgIAlj
b25zdCBjaGFyICp0eXBlID0gaXNfYXZhaWxhYmxlX2luZm8gPyAiQXZhaWxhYmxlIiA6ICJFbmFi
bGVkIjsKPiAgIAlpbnQgczsKPiAgIAo+IEBAIC0zOTk1LDggKzM5OTUsOCBAQCBzdGF0aWMgdm9p
ZCBpOTE1X3ByaW50X3NzZXVfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIGJvb2wgaXNfYXZhaWxh
YmxlX2luZm8sCj4gICAJaWYgKCFpc19hdmFpbGFibGVfaW5mbykKPiAgIAkJcmV0dXJuOwo+ICAg
Cj4gLQlzZXFfcHJpbnRmKG0sICIgIEhhcyBQb29sZWQgRVU6ICVzXG4iLCB5ZXNubyhIQVNfUE9P
TEVEX0VVKGRldl9wcml2KSkpOwo+IC0JaWYgKEhBU19QT09MRURfRVUoZGV2X3ByaXYpKQo+ICsJ
c2VxX3ByaW50ZihtLCAiICBIYXMgUG9vbGVkIEVVOiAlc1xuIiwgeWVzbm8oSEFTX1BPT0xFRF9F
VShpOTE1KSkpOwo+ICsJaWYgKEhBU19QT09MRURfRVUoaTkxNSkpCj4gICAJCXNlcV9wcmludGYo
bSwgIiAgTWluIEVVIGluIHBvb2w6ICV1XG4iLCBzc2V1LT5taW5fZXVfaW5fcG9vbCk7Cj4gICAK
PiAgIAlzZXFfcHJpbnRmKG0sICIgIEhhcyBTbGljZSBQb3dlciBHYXRpbmc6ICVzXG4iLAo+IEBA
IC00MDA5LDMyICs0MDA5LDMyIEBAIHN0YXRpYyB2b2lkIGk5MTVfcHJpbnRfc3NldV9pbmZvKHN0
cnVjdCBzZXFfZmlsZSAqbSwgYm9vbCBpc19hdmFpbGFibGVfaW5mbywKPiAgIAo+ICAgc3RhdGlj
IGludCBpOTE1X3NzZXVfc3RhdHVzKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQo+
ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1
KG0tPnByaXZhdGUpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3Rv
X2k5MTUobS0+cHJpdmF0ZSk7Cj4gICAJc3RydWN0IHNzZXVfZGV2X2luZm8gc3NldTsKPiAgIAlp
bnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
PCA4KQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8IDgpCj4gICAJCXJldHVybiAtRU5PREVWOwo+
ICAgCj4gICAJc2VxX3B1dHMobSwgIlNTRVUgRGV2aWNlIEluZm9cbiIpOwo+IC0JaTkxNV9wcmlu
dF9zc2V1X2luZm8obSwgdHJ1ZSwgJlJVTlRJTUVfSU5GTyhkZXZfcHJpdiktPnNzZXUpOwo+ICsJ
aTkxNV9wcmludF9zc2V1X2luZm8obSwgdHJ1ZSwgJlJVTlRJTUVfSU5GTyhpOTE1KS0+c3NldSk7
Cj4gICAKPiAgIAlzZXFfcHV0cyhtLCAiU1NFVSBEZXZpY2UgU3RhdHVzXG4iKTsKPiAgIAltZW1z
ZXQoJnNzZXUsIDAsIHNpemVvZihzc2V1KSk7Cj4gLQlzc2V1Lm1heF9zbGljZXMgPSBSVU5USU1F
X0lORk8oZGV2X3ByaXYpLT5zc2V1Lm1heF9zbGljZXM7Cj4gLQlzc2V1Lm1heF9zdWJzbGljZXMg
PSBSVU5USU1FX0lORk8oZGV2X3ByaXYpLT5zc2V1Lm1heF9zdWJzbGljZXM7Cj4gKwlzc2V1Lm1h
eF9zbGljZXMgPSBSVU5USU1FX0lORk8oaTkxNSktPnNzZXUubWF4X3NsaWNlczsKPiArCXNzZXUu
bWF4X3N1YnNsaWNlcyA9IFJVTlRJTUVfSU5GTyhpOTE1KS0+c3NldS5tYXhfc3Vic2xpY2VzOwo+
ICAgCXNzZXUubWF4X2V1c19wZXJfc3Vic2xpY2UgPQo+IC0JCVJVTlRJTUVfSU5GTyhkZXZfcHJp
diktPnNzZXUubWF4X2V1c19wZXJfc3Vic2xpY2U7Cj4gLQo+IC0Jd2l0aF9pbnRlbF9ydW50aW1l
X3BtKGRldl9wcml2LCB3YWtlcmVmKSB7Cj4gLQkJaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYp
KQo+IC0JCQljaGVycnl2aWV3X3NzZXVfZGV2aWNlX3N0YXR1cyhkZXZfcHJpdiwgJnNzZXUpOwo+
IC0JCWVsc2UgaWYgKElTX0JST0FEV0VMTChkZXZfcHJpdikpCj4gLQkJCWJyb2Fkd2VsbF9zc2V1
X2RldmljZV9zdGF0dXMoZGV2X3ByaXYsICZzc2V1KTsKPiAtCQllbHNlIGlmIChJU19HRU4oZGV2
X3ByaXYsIDkpKQo+IC0JCQlnZW45X3NzZXVfZGV2aWNlX3N0YXR1cyhkZXZfcHJpdiwgJnNzZXUp
Owo+IC0JCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTApCj4gLQkJCWdlbjEwX3Nz
ZXVfZGV2aWNlX3N0YXR1cyhkZXZfcHJpdiwgJnNzZXUpOwo+ICsJCVJVTlRJTUVfSU5GTyhpOTE1
KS0+c3NldS5tYXhfZXVzX3Blcl9zdWJzbGljZTsKPiArCj4gKwl3aXRoX2ludGVsX3J1bnRpbWVf
cG0oaTkxNSwgd2FrZXJlZikgewo+ICsJCWlmIChJU19DSEVSUllWSUVXKGk5MTUpKQo+ICsJCQlj
aGVycnl2aWV3X3NzZXVfZGV2aWNlX3N0YXR1cyhpOTE1LCAmc3NldSk7Cj4gKwkJZWxzZSBpZiAo
SVNfQlJPQURXRUxMKGk5MTUpKQo+ICsJCQlicm9hZHdlbGxfc3NldV9kZXZpY2Vfc3RhdHVzKGk5
MTUsICZzc2V1KTsKPiArCQllbHNlIGlmIChJU19HRU4oaTkxNSwgOSkpCj4gKwkJCWdlbjlfc3Nl
dV9kZXZpY2Vfc3RhdHVzKGk5MTUsICZzc2V1KTsKPiArCQllbHNlIGlmIChJTlRFTF9HRU4oaTkx
NSkgPj0gMTApCj4gKwkJCWdlbjEwX3NzZXVfZGV2aWNlX3N0YXR1cyhpOTE1LCAmc3NldSk7Cj4g
ICAJfQo+ICAgCj4gICAJaTkxNV9wcmludF9zc2V1X2luZm8obSwgZmFsc2UsICZzc2V1KTsKPiBA
QCAtNDA3NywxNSArNDA3NywxNSBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGZpbGVfb3BlcmF0aW9u
cyBpOTE1X2ZvcmNld2FrZV9mb3BzID0gewo+ICAgCj4gICBzdGF0aWMgaW50IGk5MTVfaHBkX3N0
b3JtX2N0bF9zaG93KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiAgIHsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG0tPnByaXZhdGU7Cj4gLQlzdHJ1Y3Qg
aTkxNV9ob3RwbHVnICpob3RwbHVnID0gJmRldl9wcml2LT5ob3RwbHVnOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBtLT5wcml2YXRlOwo+ICsJc3RydWN0IGk5MTVfaG90cGx1
ZyAqaG90cGx1ZyA9ICZpOTE1LT5ob3RwbHVnOwo+ICAgCj4gICAJLyogU3luY2hyb25pemUgd2l0
aCBldmVyeXRoaW5nIGZpcnN0IGluIGNhc2UgdGhlcmUncyBiZWVuIGFuIEhQRAo+ICAgCSAqIHN0
b3JtLCBidXQgd2UgaGF2ZW4ndCBmaW5pc2hlZCBoYW5kbGluZyBpdCBpbiB0aGUga2VybmVsIHll
dAo+ICAgCSAqLwo+IC0Jc3luY2hyb25pemVfaXJxKGRldl9wcml2LT5kcm0uaXJxKTsKPiAtCWZs
dXNoX3dvcmsoJmRldl9wcml2LT5ob3RwbHVnLmRpZ19wb3J0X3dvcmspOwo+IC0JZmx1c2hfd29y
aygmZGV2X3ByaXYtPmhvdHBsdWcuaG90cGx1Z193b3JrKTsKPiArCXN5bmNocm9uaXplX2lycShp
OTE1LT5kcm0uaXJxKTsKPiArCWZsdXNoX3dvcmsoJmk5MTUtPmhvdHBsdWcuZGlnX3BvcnRfd29y
ayk7Cj4gKwlmbHVzaF93b3JrKCZpOTE1LT5ob3RwbHVnLmhvdHBsdWdfd29yayk7Cj4gICAKPiAg
IAlzZXFfcHJpbnRmKG0sICJUaHJlc2hvbGQ6ICVkXG4iLCBob3RwbHVnLT5ocGRfc3Rvcm1fdGhy
ZXNob2xkKTsKPiAgIAlzZXFfcHJpbnRmKG0sICJEZXRlY3RlZDogJXNcbiIsCj4gQEAgLTQwOTks
OCArNDA5OSw4IEBAIHN0YXRpYyBzc2l6ZV90IGk5MTVfaHBkX3N0b3JtX2N0bF93cml0ZShzdHJ1
Y3QgZmlsZSAqZmlsZSwKPiAgIAkJCQkJbG9mZl90ICpvZmZwKQo+ICAgewo+ICAgCXN0cnVjdCBz
ZXFfZmlsZSAqbSA9IGZpbGUtPnByaXZhdGVfZGF0YTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IG0tPnByaXZhdGU7Cj4gLQlzdHJ1Y3QgaTkxNV9ob3RwbHVnICpob3Rw
bHVnID0gJmRldl9wcml2LT5ob3RwbHVnOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSBtLT5wcml2YXRlOwo+ICsJc3RydWN0IGk5MTVfaG90cGx1ZyAqaG90cGx1ZyA9ICZpOTE1
LT5ob3RwbHVnOwo+ICAgCXVuc2lnbmVkIGludCBuZXdfdGhyZXNob2xkOwo+ICAgCWludCBpOwo+
ICAgCWNoYXIgKm5ld2xpbmU7Cj4gQEAgLTQxMzAsMTUgKzQxMzAsMTUgQEAgc3RhdGljIHNzaXpl
X3QgaTkxNV9ocGRfc3Rvcm1fY3RsX3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLAo+ICAgCWVsc2UK
PiAgIAkJRFJNX0RFQlVHX0tNUygiRGlzYWJsaW5nIEhQRCBzdG9ybSBkZXRlY3Rpb25cbiIpOwo+
ICAgCj4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ICsJc3Bpbl9sb2Nr
X2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ICAgCWhvdHBsdWctPmhwZF9zdG9ybV90aHJlc2hvbGQg
PSBuZXdfdGhyZXNob2xkOwo+ICAgCS8qIFJlc2V0IHRoZSBIUEQgc3Rvcm0gc3RhdHMgc28gd2Ug
ZG9uJ3QgYWNjaWRlbnRhbGx5IHRyaWdnZXIgYSBzdG9ybSAqLwo+ICAgCWZvcl9lYWNoX2hwZF9w
aW4oaSkKPiAgIAkJaG90cGx1Zy0+c3RhdHNbaV0uY291bnQgPSAwOwo+IC0Jc3Bpbl91bmxvY2tf
aXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ICsJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFf
bG9jayk7Cj4gICAKPiAgIAkvKiBSZS1lbmFibGUgaHBkIGltbWVkaWF0ZWx5IGlmIHdlIHdlcmUg
aW4gYW4gaXJxIHN0b3JtICovCj4gLQlmbHVzaF9kZWxheWVkX3dvcmsoJmRldl9wcml2LT5ob3Rw
bHVnLnJlZW5hYmxlX3dvcmspOwo+ICsJZmx1c2hfZGVsYXllZF93b3JrKCZpOTE1LT5ob3RwbHVn
LnJlZW5hYmxlX3dvcmspOwo+ICAgCj4gICAJcmV0dXJuIGxlbjsKPiAgIH0KPiBAQCAtNDE1OSwx
MCArNDE1OSwxMCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGZpbGVfb3BlcmF0aW9ucyBpOTE1X2hw
ZF9zdG9ybV9jdGxfZm9wcyA9IHsKPiAgIAo+ICAgc3RhdGljIGludCBpOTE1X2hwZF9zaG9ydF9z
dG9ybV9jdGxfc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gICB7Cj4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBtLT5wcml2YXRlOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBtLT5wcml2YXRlOwo+ICAgCj4gICAJc2VxX3ByaW50
ZihtLCAiRW5hYmxlZDogJXNcbiIsCj4gLQkJICAgeWVzbm8oZGV2X3ByaXYtPmhvdHBsdWcuaHBk
X3Nob3J0X3N0b3JtX2VuYWJsZWQpKTsKPiArCQkgICB5ZXNubyhpOTE1LT5ob3RwbHVnLmhwZF9z
aG9ydF9zdG9ybV9lbmFibGVkKSk7Cj4gICAKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiBAQCAtNDE3
OSw4ICs0MTc5LDggQEAgc3RhdGljIHNzaXplX3QgaTkxNV9ocGRfc2hvcnRfc3Rvcm1fY3RsX3dy
aXRlKHN0cnVjdCBmaWxlICpmaWxlLAo+ICAgCQkJCQkgICAgICBzaXplX3QgbGVuLCBsb2ZmX3Qg
Km9mZnApCj4gICB7Cj4gICAJc3RydWN0IHNlcV9maWxlICptID0gZmlsZS0+cHJpdmF0ZV9kYXRh
Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbS0+cHJpdmF0ZTsKPiAt
CXN0cnVjdCBpOTE1X2hvdHBsdWcgKmhvdHBsdWcgPSAmZGV2X3ByaXYtPmhvdHBsdWc7Cj4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG0tPnByaXZhdGU7Cj4gKwlzdHJ1Y3QgaTkx
NV9ob3RwbHVnICpob3RwbHVnID0gJmk5MTUtPmhvdHBsdWc7Cj4gICAJY2hhciAqbmV3bGluZTsK
PiAgIAljaGFyIHRtcFsxNl07Cj4gICAJaW50IGk7Cj4gQEAgLTQyMDEsMjIgKzQyMDEsMjIgQEAg
c3RhdGljIHNzaXplX3QgaTkxNV9ocGRfc2hvcnRfc3Rvcm1fY3RsX3dyaXRlKHN0cnVjdCBmaWxl
ICpmaWxlLAo+ICAgCj4gICAJLyogUmVzZXQgdG8gdGhlICJkZWZhdWx0IiBzdGF0ZSBmb3IgdGhp
cyBzeXN0ZW0gKi8KPiAgIAlpZiAoc3RyY21wKHRtcCwgInJlc2V0IikgPT0gMCkKPiAtCQluZXdf
c3RhdGUgPSAhSEFTX0RQX01TVChkZXZfcHJpdik7Cj4gKwkJbmV3X3N0YXRlID0gIUhBU19EUF9N
U1QoaTkxNSk7Cj4gICAJZWxzZSBpZiAoa3N0cnRvYm9vbCh0bXAsICZuZXdfc3RhdGUpICE9IDAp
Cj4gICAJCXJldHVybiAtRUlOVkFMOwo+ICAgCj4gICAJRFJNX0RFQlVHX0tNUygiJXNhYmxpbmcg
SFBEIHNob3J0IHN0b3JtIGRldGVjdGlvblxuIiwKPiAgIAkJICAgICAgbmV3X3N0YXRlID8gIkVu
IiA6ICJEaXMiKTsKPiAgIAo+IC0Jc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsK
PiArCXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiAgIAlob3RwbHVnLT5ocGRfc2hv
cnRfc3Rvcm1fZW5hYmxlZCA9IG5ld19zdGF0ZTsKPiAgIAkvKiBSZXNldCB0aGUgSFBEIHN0b3Jt
IHN0YXRzIHNvIHdlIGRvbid0IGFjY2lkZW50YWxseSB0cmlnZ2VyIGEgc3Rvcm0gKi8KPiAgIAlm
b3JfZWFjaF9ocGRfcGluKGkpCj4gICAJCWhvdHBsdWctPnN0YXRzW2ldLmNvdW50ID0gMDsKPiAt
CXNwaW5fdW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiArCXNwaW5fdW5sb2NrX2ly
cSgmaTkxNS0+aXJxX2xvY2spOwo+ICAgCj4gICAJLyogUmUtZW5hYmxlIGhwZCBpbW1lZGlhdGVs
eSBpZiB3ZSB3ZXJlIGluIGFuIGlycSBzdG9ybSAqLwo+IC0JZmx1c2hfZGVsYXllZF93b3JrKCZk
ZXZfcHJpdi0+aG90cGx1Zy5yZWVuYWJsZV93b3JrKTsKPiArCWZsdXNoX2RlbGF5ZWRfd29yaygm
aTkxNS0+aG90cGx1Zy5yZWVuYWJsZV93b3JrKTsKPiAgIAo+ICAgCXJldHVybiBsZW47Cj4gICB9
Cj4gQEAgLTQyMzIsMTEgKzQyMzIsMTEgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBmaWxlX29wZXJh
dGlvbnMgaTkxNV9ocGRfc2hvcnRfc3Rvcm1fY3RsX2ZvcHMgPSB7Cj4gICAKPiAgIHN0YXRpYyBp
bnQgaTkxNV9kcnJzX2N0bF9zZXQodm9pZCAqZGF0YSwgdTY0IHZhbCkKPiAgIHsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRhdGE7Cj4gLQlzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2ID0gJmRldl9wcml2LT5kcm07Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IGRhdGE7Cj4gKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmk5MTUtPmRybTsKPiAgIAlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
PCA3KQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8IDcpCj4gICAJCXJldHVybiAtRU5PREVWOwo+
ICAgCj4gICAJZm9yX2VhY2hfaW50ZWxfY3J0YyhkZXYsIGNydGMpIHsKPiBAQCAtNDMwNSw5ICs0
MzA1LDkgQEAgaTkxNV9maWZvX3VuZGVycnVuX3Jlc2V0X3dyaXRlKHN0cnVjdCBmaWxlICpmaWxw
LAo+ICAgCQkJICAgICAgIGNvbnN0IGNoYXIgX191c2VyICp1YnVmLAo+ICAgCQkJICAgICAgIHNp
emVfdCBjbnQsIGxvZmZfdCAqcHBvcykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IGZpbHAtPnByaXZhdGVfZGF0YTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gZmlscC0+cHJpdmF0ZV9kYXRhOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpp
bnRlbF9jcnRjOwo+IC0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZkZXZfcHJpdi0+ZHJtOwo+
ICsJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZpOTE1LT5kcm07Cj4gICAJaW50IHJldDsKPiAg
IAlib29sIHJlc2V0Owo+ICAgCj4gQEAgLTQzNDcsNyArNDM0Nyw3IEBAIGk5MTVfZmlmb191bmRl
cnJ1bl9yZXNldF93cml0ZShzdHJ1Y3QgZmlsZSAqZmlscCwKPiAgIAkJCXJldHVybiByZXQ7Cj4g
ICAJfQo+ICAgCj4gLQlyZXQgPSBpbnRlbF9mYmNfcmVzZXRfdW5kZXJydW4oZGV2X3ByaXYpOwo+
ICsJcmV0ID0gaW50ZWxfZmJjX3Jlc2V0X3VuZGVycnVuKGk5MTUpOwo+ICAgCWlmIChyZXQpCj4g
ICAJCXJldHVybiByZXQ7Cj4gICAKPiBAQCAtNDQzNyw5ICs0NDM3LDkgQEAgc3RhdGljIGNvbnN0
IHN0cnVjdCBpOTE1X2RlYnVnZnNfZmlsZXMgewo+ICAgCXsiaTkxNV9lZHBfcHNyX2RlYnVnIiwg
Jmk5MTVfZWRwX3Bzcl9kZWJ1Z19mb3BzfQo+ICAgfTsKPiAgIAo+IC1pbnQgaTkxNV9kZWJ1Z2Zz
X3JlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAraW50IGk5MTVf
ZGVidWdmc19yZWdpc3RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAt
CXN0cnVjdCBkcm1fbWlub3IgKm1pbm9yID0gZGV2X3ByaXYtPmRybS5wcmltYXJ5Owo+ICsJc3Ry
dWN0IGRybV9taW5vciAqbWlub3IgPSBpOTE1LT5kcm0ucHJpbWFyeTsKPiAgIAlzdHJ1Y3QgZGVu
dHJ5ICplbnQ7Cj4gICAJaW50IGk7Cj4gICAKPiBAQCAtNDY5Miw3ICs0NjkyLDcgQEAgc3RhdGlj
IGNvbnN0IHN0cnVjdCBmaWxlX29wZXJhdGlvbnMgaTkxNV9kc2NfZmVjX3N1cHBvcnRfZm9wcyA9
IHsKPiAgIGludCBpOTE1X2RlYnVnZnNfY29ubmVjdG9yX2FkZChzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
ciAqY29ubmVjdG9yKQo+ICAgewo+ICAgCXN0cnVjdCBkZW50cnkgKnJvb3QgPSBjb25uZWN0b3It
PmRlYnVnZnNfZW50cnk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShjb25uZWN0b3ItPmRldik7Cj4gICAKPiAgIAkvKiBUaGUgY29ubmVjdG9yIG11
c3QgaGF2ZSBiZWVuIHJlZ2lzdGVyZWQgYmVmb3JlaGFuZHMuICovCj4gICAJaWYgKCFyb290KQo+
IEBAIC00NzE3LDcgKzQ3MTcsNyBAQCBpbnQgaTkxNV9kZWJ1Z2ZzX2Nvbm5lY3Rvcl9hZGQoc3Ry
dWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIAkJCQkgICAgY29ubmVjdG9yLCAmaTkx
NV9oZGNwX3NpbmtfY2FwYWJpbGl0eV9mb3BzKTsKPiAgIAl9Cj4gICAKPiAtCWlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDEwICYmCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDEwICYmCj4g
ICAJICAgIChjb25uZWN0b3ItPmNvbm5lY3Rvcl90eXBlID09IERSTV9NT0RFX0NPTk5FQ1RPUl9E
aXNwbGF5UG9ydCB8fAo+ICAgCSAgICAgY29ubmVjdG9yLT5jb25uZWN0b3JfdHlwZSA9PSBEUk1f
TU9ERV9DT05ORUNUT1JfZURQKSkKPiAgIAkJZGVidWdmc19jcmVhdGVfZmlsZSgiaTkxNV9kc2Nf
ZmVjX3N1cHBvcnQiLCBTX0lSVUdPLCByb290LAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2RlYnVnZnMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdm
cy5oCj4gaW5kZXggYzBjZDIyZWI5MTZkLi4zZTk5ZWFmOGRlMDIgMTAwNjQ0Cj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2RlYnVnZnMuaAo+IEBAIC0xMCwxMCArMTAsMTAgQEAgc3RydWN0IGRybV9pOTE1
X3ByaXZhdGU7Cj4gICBzdHJ1Y3QgZHJtX2Nvbm5lY3RvcjsKPiAgIAo+ICAgI2lmZGVmIENPTkZJ
R19ERUJVR19GUwo+IC1pbnQgaTkxNV9kZWJ1Z2ZzX3JlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdik7Cj4gK2ludCBpOTE1X2RlYnVnZnNfcmVnaXN0ZXIoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgaW50IGk5MTVfZGVidWdmc19jb25uZWN0b3JfYWRk
KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpOwo+ICAgI2Vsc2UKPiAtc3RhdGljIGlu
bGluZSBpbnQgaTkxNV9kZWJ1Z2ZzX3JlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikgeyByZXR1cm4gMDsgfQo+ICtzdGF0aWMgaW5saW5lIGludCBpOTE1X2RlYnVnZnNf
cmVnaXN0ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpIHsgcmV0dXJuIDA7IH0KPiAg
IHN0YXRpYyBpbmxpbmUgaW50IGk5MTVfZGVidWdmc19jb25uZWN0b3JfYWRkKHN0cnVjdCBkcm1f
Y29ubmVjdG9yICpjb25uZWN0b3IpIHsgcmV0dXJuIDA7IH0KPiAgICNlbmRpZgo+ICAgCj4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2Rydi5jCj4gaW5kZXggODFmZjJjNzhmZDU1Li5hMDlkMDI4ZWM4ZDggMTAw
NjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYwo+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKPiBAQCAtMTA4LDExICsxMDgsMTEgQEAgYm9vbCBp
OTE1X2Vycm9yX2luamVjdGVkKHZvaWQpCj4gICAJCSAgICAicHJvdmlkaW5nIHRoZSBkbWVzZyBs
b2cgYnkgYm9vdGluZyB3aXRoIGRybS5kZWJ1Zz0weGYiCj4gICAKPiAgIHZvaWQKPiAtX19pOTE1
X3ByaW50ayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGNvbnN0IGNoYXIgKmxl
dmVsLAo+ICtfX2k5MTVfcHJpbnRrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBjb25z
dCBjaGFyICpsZXZlbCwKPiAgIAkgICAgICBjb25zdCBjaGFyICpmbXQsIC4uLikKPiAgIHsKPiAg
IAlzdGF0aWMgYm9vbCBzaG93bl9idWdfb25jZTsKPiAtCXN0cnVjdCBkZXZpY2UgKmtkZXYgPSBk
ZXZfcHJpdi0+ZHJtLmRldjsKPiArCXN0cnVjdCBkZXZpY2UgKmtkZXYgPSBpOTE1LT5kcm0uZGV2
Owo+ICAgCWJvb2wgaXNfZXJyb3IgPSBsZXZlbFsxXSA8PSBLRVJOX0VSUlsxXTsKPiAgIAlib29s
IGlzX2RlYnVnID0gbGV2ZWxbMV0gPT0gS0VSTl9ERUJVR1sxXTsKPiAgIAlzdHJ1Y3QgdmFfZm9y
bWF0IHZhZjsKPiBAQCAtMTQ4LDc0ICsxNDgsNzQgQEAgX19pOTE1X3ByaW50ayhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGNvbnN0IGNoYXIgKmxldmVsLAo+ICAgCj4gICAvKiBN
YXAgUENIIGRldmljZSBpZCB0byBQQ0ggdHlwZSwgb3IgUENIX05PTkUgaWYgdW5rbm93bi4gKi8K
PiAgIHN0YXRpYyBlbnVtIGludGVsX3BjaAo+IC1pbnRlbF9wY2hfdHlwZShjb25zdCBzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHVuc2lnbmVkIHNob3J0IGlkKQo+ICtpbnRlbF9w
Y2hfdHlwZShjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdW5zaWduZWQgc2hv
cnQgaWQpCj4gICB7Cj4gICAJc3dpdGNoIChpZCkgewo+ICAgCWNhc2UgSU5URUxfUENIX0lCWF9E
RVZJQ0VfSURfVFlQRToKPiAgIAkJRFJNX0RFQlVHX0tNUygiRm91bmQgSWJleCBQZWFrIFBDSFxu
Iik7Cj4gLQkJV0FSTl9PTighSVNfR0VOKGRldl9wcml2LCA1KSk7Cj4gKwkJV0FSTl9PTighSVNf
R0VOKGk5MTUsIDUpKTsKPiAgIAkJcmV0dXJuIFBDSF9JQlg7Cj4gICAJY2FzZSBJTlRFTF9QQ0hf
Q1BUX0RFVklDRV9JRF9UWVBFOgo+ICAgCQlEUk1fREVCVUdfS01TKCJGb3VuZCBDb3VnYXJQb2lu
dCBQQ0hcbiIpOwo+IC0JCVdBUk5fT04oIUlTX0dFTihkZXZfcHJpdiwgNikgJiYgIUlTX0lWWUJS
SURHRShkZXZfcHJpdikpOwo+ICsJCVdBUk5fT04oIUlTX0dFTihpOTE1LCA2KSAmJiAhSVNfSVZZ
QlJJREdFKGk5MTUpKTsKPiAgIAkJcmV0dXJuIFBDSF9DUFQ7Cj4gICAJY2FzZSBJTlRFTF9QQ0hf
UFBUX0RFVklDRV9JRF9UWVBFOgo+ICAgCQlEUk1fREVCVUdfS01TKCJGb3VuZCBQYW50aGVyUG9p
bnQgUENIXG4iKTsKPiAtCQlXQVJOX09OKCFJU19HRU4oZGV2X3ByaXYsIDYpICYmICFJU19JVllC
UklER0UoZGV2X3ByaXYpKTsKPiArCQlXQVJOX09OKCFJU19HRU4oaTkxNSwgNikgJiYgIUlTX0lW
WUJSSURHRShpOTE1KSk7Cj4gICAJCS8qIFBhbnRoZXJQb2ludCBpcyBDUFQgY29tcGF0aWJsZSAq
Lwo+ICAgCQlyZXR1cm4gUENIX0NQVDsKPiAgIAljYXNlIElOVEVMX1BDSF9MUFRfREVWSUNFX0lE
X1RZUEU6Cj4gICAJCURSTV9ERUJVR19LTVMoIkZvdW5kIEx5bnhQb2ludCBQQ0hcbiIpOwo+IC0J
CVdBUk5fT04oIUlTX0hBU1dFTEwoZGV2X3ByaXYpICYmICFJU19CUk9BRFdFTEwoZGV2X3ByaXYp
KTsKPiAtCQlXQVJOX09OKElTX0hTV19VTFQoZGV2X3ByaXYpIHx8IElTX0JEV19VTFQoZGV2X3By
aXYpKTsKPiArCQlXQVJOX09OKCFJU19IQVNXRUxMKGk5MTUpICYmICFJU19CUk9BRFdFTEwoaTkx
NSkpOwo+ICsJCVdBUk5fT04oSVNfSFNXX1VMVChpOTE1KSB8fCBJU19CRFdfVUxUKGk5MTUpKTsK
PiAgIAkJcmV0dXJuIFBDSF9MUFQ7Cj4gICAJY2FzZSBJTlRFTF9QQ0hfTFBUX0xQX0RFVklDRV9J
RF9UWVBFOgo+ICAgCQlEUk1fREVCVUdfS01TKCJGb3VuZCBMeW54UG9pbnQgTFAgUENIXG4iKTsK
PiAtCQlXQVJOX09OKCFJU19IQVNXRUxMKGRldl9wcml2KSAmJiAhSVNfQlJPQURXRUxMKGRldl9w
cml2KSk7Cj4gLQkJV0FSTl9PTighSVNfSFNXX1VMVChkZXZfcHJpdikgJiYgIUlTX0JEV19VTFQo
ZGV2X3ByaXYpKTsKPiArCQlXQVJOX09OKCFJU19IQVNXRUxMKGk5MTUpICYmICFJU19CUk9BRFdF
TEwoaTkxNSkpOwo+ICsJCVdBUk5fT04oIUlTX0hTV19VTFQoaTkxNSkgJiYgIUlTX0JEV19VTFQo
aTkxNSkpOwo+ICAgCQlyZXR1cm4gUENIX0xQVDsKPiAgIAljYXNlIElOVEVMX1BDSF9XUFRfREVW
SUNFX0lEX1RZUEU6Cj4gICAJCURSTV9ERUJVR19LTVMoIkZvdW5kIFdpbGRjYXRQb2ludCBQQ0hc
biIpOwo+IC0JCVdBUk5fT04oIUlTX0hBU1dFTEwoZGV2X3ByaXYpICYmICFJU19CUk9BRFdFTEwo
ZGV2X3ByaXYpKTsKPiAtCQlXQVJOX09OKElTX0hTV19VTFQoZGV2X3ByaXYpIHx8IElTX0JEV19V
TFQoZGV2X3ByaXYpKTsKPiArCQlXQVJOX09OKCFJU19IQVNXRUxMKGk5MTUpICYmICFJU19CUk9B
RFdFTEwoaTkxNSkpOwo+ICsJCVdBUk5fT04oSVNfSFNXX1VMVChpOTE1KSB8fCBJU19CRFdfVUxU
KGk5MTUpKTsKPiAgIAkJLyogV2lsZGNhdFBvaW50IGlzIExQVCBjb21wYXRpYmxlICovCj4gICAJ
CXJldHVybiBQQ0hfTFBUOwo+ICAgCWNhc2UgSU5URUxfUENIX1dQVF9MUF9ERVZJQ0VfSURfVFlQ
RToKPiAgIAkJRFJNX0RFQlVHX0tNUygiRm91bmQgV2lsZGNhdFBvaW50IExQIFBDSFxuIik7Cj4g
LQkJV0FSTl9PTighSVNfSEFTV0VMTChkZXZfcHJpdikgJiYgIUlTX0JST0FEV0VMTChkZXZfcHJp
dikpOwo+IC0JCVdBUk5fT04oIUlTX0hTV19VTFQoZGV2X3ByaXYpICYmICFJU19CRFdfVUxUKGRl
dl9wcml2KSk7Cj4gKwkJV0FSTl9PTighSVNfSEFTV0VMTChpOTE1KSAmJiAhSVNfQlJPQURXRUxM
KGk5MTUpKTsKPiArCQlXQVJOX09OKCFJU19IU1dfVUxUKGk5MTUpICYmICFJU19CRFdfVUxUKGk5
MTUpKTsKPiAgIAkJLyogV2lsZGNhdFBvaW50IGlzIExQVCBjb21wYXRpYmxlICovCj4gICAJCXJl
dHVybiBQQ0hfTFBUOwo+ICAgCWNhc2UgSU5URUxfUENIX1NQVF9ERVZJQ0VfSURfVFlQRToKPiAg
IAkJRFJNX0RFQlVHX0tNUygiRm91bmQgU3VucmlzZVBvaW50IFBDSFxuIik7Cj4gLQkJV0FSTl9P
TighSVNfU0tZTEFLRShkZXZfcHJpdikgJiYgIUlTX0tBQllMQUtFKGRldl9wcml2KSk7Cj4gKwkJ
V0FSTl9PTighSVNfU0tZTEFLRShpOTE1KSAmJiAhSVNfS0FCWUxBS0UoaTkxNSkpOwo+ICAgCQly
ZXR1cm4gUENIX1NQVDsKPiAgIAljYXNlIElOVEVMX1BDSF9TUFRfTFBfREVWSUNFX0lEX1RZUEU6
Cj4gICAJCURSTV9ERUJVR19LTVMoIkZvdW5kIFN1bnJpc2VQb2ludCBMUCBQQ0hcbiIpOwo+IC0J
CVdBUk5fT04oIUlTX1NLWUxBS0UoZGV2X3ByaXYpICYmICFJU19LQUJZTEFLRShkZXZfcHJpdikp
Owo+ICsJCVdBUk5fT04oIUlTX1NLWUxBS0UoaTkxNSkgJiYgIUlTX0tBQllMQUtFKGk5MTUpKTsK
PiAgIAkJcmV0dXJuIFBDSF9TUFQ7Cj4gICAJY2FzZSBJTlRFTF9QQ0hfS0JQX0RFVklDRV9JRF9U
WVBFOgo+ICAgCQlEUk1fREVCVUdfS01TKCJGb3VuZCBLYWJ5IExha2UgUENIIChLQlApXG4iKTsK
PiAtCQlXQVJOX09OKCFJU19TS1lMQUtFKGRldl9wcml2KSAmJiAhSVNfS0FCWUxBS0UoZGV2X3By
aXYpICYmCj4gLQkJCSFJU19DT0ZGRUVMQUtFKGRldl9wcml2KSk7Cj4gKwkJV0FSTl9PTighSVNf
U0tZTEFLRShpOTE1KSAmJiAhSVNfS0FCWUxBS0UoaTkxNSkgJiYKPiArCQkJIUlTX0NPRkZFRUxB
S0UoaTkxNSkpOwo+ICAgCQkvKiBLQlAgaXMgU1BUIGNvbXBhdGlibGUgKi8KPiAgIAkJcmV0dXJu
IFBDSF9TUFQ7Cj4gICAJY2FzZSBJTlRFTF9QQ0hfQ05QX0RFVklDRV9JRF9UWVBFOgo+ICAgCQlE
Uk1fREVCVUdfS01TKCJGb3VuZCBDYW5ub24gTGFrZSBQQ0ggKENOUClcbiIpOwo+IC0JCVdBUk5f
T04oIUlTX0NBTk5PTkxBS0UoZGV2X3ByaXYpICYmICFJU19DT0ZGRUVMQUtFKGRldl9wcml2KSk7
Cj4gKwkJV0FSTl9PTighSVNfQ0FOTk9OTEFLRShpOTE1KSAmJiAhSVNfQ09GRkVFTEFLRShpOTE1
KSk7Cj4gICAJCXJldHVybiBQQ0hfQ05QOwo+ICAgCWNhc2UgSU5URUxfUENIX0NOUF9MUF9ERVZJ
Q0VfSURfVFlQRToKPiAgIAkJRFJNX0RFQlVHX0tNUygiRm91bmQgQ2Fubm9uIExha2UgTFAgUENI
IChDTlAtTFApXG4iKTsKPiAtCQlXQVJOX09OKCFJU19DQU5OT05MQUtFKGRldl9wcml2KSAmJiAh
SVNfQ09GRkVFTEFLRShkZXZfcHJpdikpOwo+ICsJCVdBUk5fT04oIUlTX0NBTk5PTkxBS0UoaTkx
NSkgJiYgIUlTX0NPRkZFRUxBS0UoaTkxNSkpOwo+ICAgCQlyZXR1cm4gUENIX0NOUDsKPiAgIAlj
YXNlIElOVEVMX1BDSF9DTVBfREVWSUNFX0lEX1RZUEU6Cj4gICAJCURSTV9ERUJVR19LTVMoIkZv
dW5kIENvbWV0IExha2UgUENIIChDTVApXG4iKTsKPiAtCQlXQVJOX09OKCFJU19DT0ZGRUVMQUtF
KGRldl9wcml2KSk7Cj4gKwkJV0FSTl9PTighSVNfQ09GRkVFTEFLRShpOTE1KSk7Cj4gICAJCS8q
IENvbWV0UG9pbnQgaXMgQ05QIENvbXBhdGlibGUgKi8KPiAgIAkJcmV0dXJuIFBDSF9DTlA7Cj4g
ICAJY2FzZSBJTlRFTF9QQ0hfSUNQX0RFVklDRV9JRF9UWVBFOgo+ICAgCQlEUk1fREVCVUdfS01T
KCJGb3VuZCBJY2UgTGFrZSBQQ0hcbiIpOwo+IC0JCVdBUk5fT04oIUlTX0lDRUxBS0UoZGV2X3By
aXYpKTsKPiArCQlXQVJOX09OKCFJU19JQ0VMQUtFKGk5MTUpKTsKPiAgIAkJcmV0dXJuIFBDSF9J
Q1A7Cj4gICAJZGVmYXVsdDoKPiAgIAkJcmV0dXJuIFBDSF9OT05FOwo+IEBAIC0yMzMsNyArMjMz
LDcgQEAgc3RhdGljIGJvb2wgaW50ZWxfaXNfdmlydF9wY2godW5zaWduZWQgc2hvcnQgaWQsCj4g
ICB9Cj4gICAKPiAgIHN0YXRpYyB1bnNpZ25lZCBzaG9ydAo+IC1pbnRlbF92aXJ0X2RldGVjdF9w
Y2goY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtpbnRlbF92aXJ0
X2RldGVjdF9wY2goY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4g
ICAJdW5zaWduZWQgc2hvcnQgaWQgPSAwOwo+ICAgCj4gQEAgLTI0NCwxOSArMjQ0LDE5IEBAIGlu
dGVsX3ZpcnRfZGV0ZWN0X3BjaChjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gICAJICogbWFrZSBhbiBlZHVjYXRlZCBndWVzcyBhcyB0byB3aGljaCBQQ0ggaXMgcmVh
bGx5IHRoZXJlLgo+ICAgCSAqLwo+ICAgCj4gLQlpZiAoSVNfSUNFTEFLRShkZXZfcHJpdikpCj4g
KwlpZiAoSVNfSUNFTEFLRShpOTE1KSkKPiAgIAkJaWQgPSBJTlRFTF9QQ0hfSUNQX0RFVklDRV9J
RF9UWVBFOwo+IC0JZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShkZXZfcHJpdikgfHwgSVNfQ09GRkVF
TEFLRShkZXZfcHJpdikpCj4gKwllbHNlIGlmIChJU19DQU5OT05MQUtFKGk5MTUpIHx8IElTX0NP
RkZFRUxBS0UoaTkxNSkpCj4gICAJCWlkID0gSU5URUxfUENIX0NOUF9ERVZJQ0VfSURfVFlQRTsK
PiAtCWVsc2UgaWYgKElTX0tBQllMQUtFKGRldl9wcml2KSB8fCBJU19TS1lMQUtFKGRldl9wcml2
KSkKPiArCWVsc2UgaWYgKElTX0tBQllMQUtFKGk5MTUpIHx8IElTX1NLWUxBS0UoaTkxNSkpCj4g
ICAJCWlkID0gSU5URUxfUENIX1NQVF9ERVZJQ0VfSURfVFlQRTsKPiAtCWVsc2UgaWYgKElTX0hT
V19VTFQoZGV2X3ByaXYpIHx8IElTX0JEV19VTFQoZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAoSVNf
SFNXX1VMVChpOTE1KSB8fCBJU19CRFdfVUxUKGk5MTUpKQo+ICAgCQlpZCA9IElOVEVMX1BDSF9M
UFRfTFBfREVWSUNFX0lEX1RZUEU7Cj4gLQllbHNlIGlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8
fCBJU19CUk9BRFdFTEwoZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAoSVNfSEFTV0VMTChpOTE1KSB8
fCBJU19CUk9BRFdFTEwoaTkxNSkpCj4gICAJCWlkID0gSU5URUxfUENIX0xQVF9ERVZJQ0VfSURf
VFlQRTsKPiAtCWVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgNikgfHwgSVNfSVZZQlJJREdFKGRl
dl9wcml2KSkKPiArCWVsc2UgaWYgKElTX0dFTihpOTE1LCA2KSB8fCBJU19JVllCUklER0UoaTkx
NSkpCj4gICAJCWlkID0gSU5URUxfUENIX0NQVF9ERVZJQ0VfSURfVFlQRTsKPiAtCWVsc2UgaWYg
KElTX0dFTihkZXZfcHJpdiwgNSkpCj4gKwllbHNlIGlmIChJU19HRU4oaTkxNSwgNSkpCj4gICAJ
CWlkID0gSU5URUxfUENIX0lCWF9ERVZJQ0VfSURfVFlQRTsKPiAgIAo+ICAgCWlmIChpZCkKPiBA
QCAtMjY3LDcgKzI2Nyw3IEBAIGludGVsX3ZpcnRfZGV0ZWN0X3BjaChjb25zdCBzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJcmV0dXJuIGlkOwo+ICAgfQo+ICAgCj4gLXN0
YXRpYyB2b2lkIGludGVsX2RldGVjdF9wY2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICtzdGF0aWMgdm9pZCBpbnRlbF9kZXRlY3RfcGNoKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ICAgewo+ICAgCXN0cnVjdCBwY2lfZGV2ICpwY2ggPSBOVUxMOwo+ICAgCj4g
QEAgLTI5MSwyMiArMjkxLDIyIEBAIHN0YXRpYyB2b2lkIGludGVsX2RldGVjdF9wY2goc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCj4gICAJCWlkID0gcGNoLT5kZXZpY2Ug
JiBJTlRFTF9QQ0hfREVWSUNFX0lEX01BU0s7Cj4gICAKPiAtCQlwY2hfdHlwZSA9IGludGVsX3Bj
aF90eXBlKGRldl9wcml2LCBpZCk7Cj4gKwkJcGNoX3R5cGUgPSBpbnRlbF9wY2hfdHlwZShpOTE1
LCBpZCk7Cj4gICAJCWlmIChwY2hfdHlwZSAhPSBQQ0hfTk9ORSkgewo+IC0JCQlkZXZfcHJpdi0+
cGNoX3R5cGUgPSBwY2hfdHlwZTsKPiAtCQkJZGV2X3ByaXYtPnBjaF9pZCA9IGlkOwo+ICsJCQlp
OTE1LT5wY2hfdHlwZSA9IHBjaF90eXBlOwo+ICsJCQlpOTE1LT5wY2hfaWQgPSBpZDsKPiAgIAkJ
CWJyZWFrOwo+ICAgCQl9IGVsc2UgaWYgKGludGVsX2lzX3ZpcnRfcGNoKGlkLCBwY2gtPnN1YnN5
c3RlbV92ZW5kb3IsCj4gICAJCQkJCSBwY2gtPnN1YnN5c3RlbV9kZXZpY2UpKSB7Cj4gLQkJCWlk
ID0gaW50ZWxfdmlydF9kZXRlY3RfcGNoKGRldl9wcml2KTsKPiAtCQkJcGNoX3R5cGUgPSBpbnRl
bF9wY2hfdHlwZShkZXZfcHJpdiwgaWQpOwo+ICsJCQlpZCA9IGludGVsX3ZpcnRfZGV0ZWN0X3Bj
aChpOTE1KTsKPiArCQkJcGNoX3R5cGUgPSBpbnRlbF9wY2hfdHlwZShpOTE1LCBpZCk7Cj4gICAK
PiAgIAkJCS8qIFNhbml0eSBjaGVjayB2aXJ0dWFsIFBDSCBpZCAqLwo+ICAgCQkJaWYgKFdBUk5f
T04oaWQgJiYgcGNoX3R5cGUgPT0gUENIX05PTkUpKQo+ICAgCQkJCWlkID0gMDsKPiAgIAo+IC0J
CQlkZXZfcHJpdi0+cGNoX3R5cGUgPSBwY2hfdHlwZTsKPiAtCQkJZGV2X3ByaXYtPnBjaF9pZCA9
IGlkOwo+ICsJCQlpOTE1LT5wY2hfdHlwZSA9IHBjaF90eXBlOwo+ICsJCQlpOTE1LT5wY2hfaWQg
PSBpZDsKPiAgIAkJCWJyZWFrOwo+ICAgCQl9Cj4gICAJfQo+IEBAIC0zMTUsMTAgKzMxNSwxMCBA
QCBzdGF0aWMgdm9pZCBpbnRlbF9kZXRlY3RfcGNoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiAgIAkgKiBVc2UgUENIX05PUCAoUENIIGJ1dCBubyBTb3V0aCBEaXNwbGF5KSBm
b3IgUENIIHBsYXRmb3JtcyB3aXRob3V0Cj4gICAJICogZGlzcGxheS4KPiAgIAkgKi8KPiAtCWlm
IChwY2ggJiYgIUhBU19ESVNQTEFZKGRldl9wcml2KSkgewo+ICsJaWYgKHBjaCAmJiAhSEFTX0RJ
U1BMQVkoaTkxNSkpIHsKPiAgIAkJRFJNX0RFQlVHX0tNUygiRGlzcGxheSBkaXNhYmxlZCwgcmV2
ZXJ0aW5nIHRvIE5PUCBQQ0hcbiIpOwo+IC0JCWRldl9wcml2LT5wY2hfdHlwZSA9IFBDSF9OT1A7
Cj4gLQkJZGV2X3ByaXYtPnBjaF9pZCA9IDA7Cj4gKwkJaTkxNS0+cGNoX3R5cGUgPSBQQ0hfTk9Q
Owo+ICsJCWk5MTUtPnBjaF9pZCA9IDA7Cj4gICAJfQo+ICAgCj4gICAJaWYgKCFwY2gpCj4gQEAg
LTMzMCw5ICszMzAsOSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZXRlY3RfcGNoKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIHN0YXRpYyBpbnQgaTkxNV9nZXRwYXJhbV9pb2N0
bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ICAgCQkJICAgICAgIHN0cnVj
dCBkcm1fZmlsZSAqZmlsZV9wcml2KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+IC0Jc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBkZXZf
cHJpdi0+ZHJtLnBkZXY7Cj4gLQljb25zdCBzdHJ1Y3Qgc3NldV9kZXZfaW5mbyAqc3NldSA9ICZS
VU5USU1FX0lORk8oZGV2X3ByaXYpLT5zc2V1Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGk5MTUtPmRy
bS5wZGV2Owo+ICsJY29uc3Qgc3RydWN0IHNzZXVfZGV2X2luZm8gKnNzZXUgPSAmUlVOVElNRV9J
TkZPKGk5MTUpLT5zc2V1Owo+ICAgCWRybV9pOTE1X2dldHBhcmFtX3QgKnBhcmFtID0gZGF0YTsK
PiAgIAlpbnQgdmFsdWU7Cj4gICAKPiBAQCAtMzUwLDQwICszNTAsNDAgQEAgc3RhdGljIGludCBp
OTE1X2dldHBhcmFtX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4g
ICAJCXZhbHVlID0gcGRldi0+cmV2aXNpb247Cj4gICAJCWJyZWFrOwo+ICAgCWNhc2UgSTkxNV9Q
QVJBTV9OVU1fRkVOQ0VTX0FWQUlMOgo+IC0JCXZhbHVlID0gZGV2X3ByaXYtPm51bV9mZW5jZV9y
ZWdzOwo+ICsJCXZhbHVlID0gaTkxNS0+bnVtX2ZlbmNlX3JlZ3M7Cj4gICAJCWJyZWFrOwo+ICAg
CWNhc2UgSTkxNV9QQVJBTV9IQVNfT1ZFUkxBWToKPiAtCQl2YWx1ZSA9IGRldl9wcml2LT5vdmVy
bGF5ID8gMSA6IDA7Cj4gKwkJdmFsdWUgPSBpOTE1LT5vdmVybGF5ID8gMSA6IDA7Cj4gICAJCWJy
ZWFrOwo+ICAgCWNhc2UgSTkxNV9QQVJBTV9IQVNfQlNEOgo+IC0JCXZhbHVlID0gISFkZXZfcHJp
di0+ZW5naW5lW1ZDUzBdOwo+ICsJCXZhbHVlID0gISFpOTE1LT5lbmdpbmVbVkNTMF07Cj4gICAJ
CWJyZWFrOwo+ICAgCWNhc2UgSTkxNV9QQVJBTV9IQVNfQkxUOgo+IC0JCXZhbHVlID0gISFkZXZf
cHJpdi0+ZW5naW5lW0JDUzBdOwo+ICsJCXZhbHVlID0gISFpOTE1LT5lbmdpbmVbQkNTMF07Cj4g
ICAJCWJyZWFrOwo+ICAgCWNhc2UgSTkxNV9QQVJBTV9IQVNfVkVCT1g6Cj4gLQkJdmFsdWUgPSAh
IWRldl9wcml2LT5lbmdpbmVbVkVDUzBdOwo+ICsJCXZhbHVlID0gISFpOTE1LT5lbmdpbmVbVkVD
UzBdOwo+ICAgCQlicmVhazsKPiAgIAljYXNlIEk5MTVfUEFSQU1fSEFTX0JTRDI6Cj4gLQkJdmFs
dWUgPSAhIWRldl9wcml2LT5lbmdpbmVbVkNTMV07Cj4gKwkJdmFsdWUgPSAhIWk5MTUtPmVuZ2lu
ZVtWQ1MxXTsKPiAgIAkJYnJlYWs7Cj4gICAJY2FzZSBJOTE1X1BBUkFNX0hBU19MTEM6Cj4gLQkJ
dmFsdWUgPSBIQVNfTExDKGRldl9wcml2KTsKPiArCQl2YWx1ZSA9IEhBU19MTEMoaTkxNSk7Cj4g
ICAJCWJyZWFrOwo+ICAgCWNhc2UgSTkxNV9QQVJBTV9IQVNfV1Q6Cj4gLQkJdmFsdWUgPSBIQVNf
V1QoZGV2X3ByaXYpOwo+ICsJCXZhbHVlID0gSEFTX1dUKGk5MTUpOwo+ICAgCQlicmVhazsKPiAg
IAljYXNlIEk5MTVfUEFSQU1fSEFTX0FMSUFTSU5HX1BQR1RUOgo+IC0JCXZhbHVlID0gSU5URUxf
UFBHVFQoZGV2X3ByaXYpOwo+ICsJCXZhbHVlID0gSU5URUxfUFBHVFQoaTkxNSk7Cj4gICAJCWJy
ZWFrOwo+ICAgCWNhc2UgSTkxNV9QQVJBTV9IQVNfU0VNQVBIT1JFUzoKPiAtCQl2YWx1ZSA9ICEh
KGRldl9wcml2LT5jYXBzLnNjaGVkdWxlciAmIEk5MTVfU0NIRURVTEVSX0NBUF9TRU1BUEhPUkVT
KTsKPiArCQl2YWx1ZSA9ICEhKGk5MTUtPmNhcHMuc2NoZWR1bGVyICYgSTkxNV9TQ0hFRFVMRVJf
Q0FQX1NFTUFQSE9SRVMpOwo+ICAgCQlicmVhazsKPiAgIAljYXNlIEk5MTVfUEFSQU1fSEFTX1NF
Q1VSRV9CQVRDSEVTOgo+ICAgCQl2YWx1ZSA9IGNhcGFibGUoQ0FQX1NZU19BRE1JTik7Cj4gICAJ
CWJyZWFrOwo+ICAgCWNhc2UgSTkxNV9QQVJBTV9DTURfUEFSU0VSX1ZFUlNJT046Cj4gLQkJdmFs
dWUgPSBpOTE1X2NtZF9wYXJzZXJfZ2V0X3ZlcnNpb24oZGV2X3ByaXYpOwo+ICsJCXZhbHVlID0g
aTkxNV9jbWRfcGFyc2VyX2dldF92ZXJzaW9uKGk5MTUpOwo+ICAgCQlicmVhazsKPiAgIAljYXNl
IEk5MTVfUEFSQU1fU1VCU0xJQ0VfVE9UQUw6Cj4gICAJCXZhbHVlID0gaW50ZWxfc3NldV9zdWJz
bGljZV90b3RhbChzc2V1KTsKPiBAQCAtMzk3LDIxICszOTcsMjEgQEAgc3RhdGljIGludCBpOTE1
X2dldHBhcmFtX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gICAJ
CWJyZWFrOwo+ICAgCWNhc2UgSTkxNV9QQVJBTV9IQVNfR1BVX1JFU0VUOgo+ICAgCQl2YWx1ZSA9
IGk5MTVfbW9kcGFyYW1zLmVuYWJsZV9oYW5nY2hlY2sgJiYKPiAtCQkJaW50ZWxfaGFzX2dwdV9y
ZXNldChkZXZfcHJpdik7Cj4gLQkJaWYgKHZhbHVlICYmIGludGVsX2hhc19yZXNldF9lbmdpbmUo
ZGV2X3ByaXYpKQo+ICsJCQlpbnRlbF9oYXNfZ3B1X3Jlc2V0KGk5MTUpOwo+ICsJCWlmICh2YWx1
ZSAmJiBpbnRlbF9oYXNfcmVzZXRfZW5naW5lKGk5MTUpKQo+ICAgCQkJdmFsdWUgPSAyOwo+ICAg
CQlicmVhazsKPiAgIAljYXNlIEk5MTVfUEFSQU1fSEFTX1JFU09VUkNFX1NUUkVBTUVSOgo+ICAg
CQl2YWx1ZSA9IDA7Cj4gICAJCWJyZWFrOwo+ICAgCWNhc2UgSTkxNV9QQVJBTV9IQVNfUE9PTEVE
X0VVOgo+IC0JCXZhbHVlID0gSEFTX1BPT0xFRF9FVShkZXZfcHJpdik7Cj4gKwkJdmFsdWUgPSBI
QVNfUE9PTEVEX0VVKGk5MTUpOwo+ICAgCQlicmVhazsKPiAgIAljYXNlIEk5MTVfUEFSQU1fTUlO
X0VVX0lOX1BPT0w6Cj4gICAJCXZhbHVlID0gc3NldS0+bWluX2V1X2luX3Bvb2w7Cj4gICAJCWJy
ZWFrOwo+ICAgCWNhc2UgSTkxNV9QQVJBTV9IVUNfU1RBVFVTOgo+IC0JCXZhbHVlID0gaW50ZWxf
aHVjX2NoZWNrX3N0YXR1cygmZGV2X3ByaXYtPmh1Yyk7Cj4gKwkJdmFsdWUgPSBpbnRlbF9odWNf
Y2hlY2tfc3RhdHVzKCZpOTE1LT5odWMpOwo+ICAgCQlpZiAodmFsdWUgPCAwKQo+ICAgCQkJcmV0
dXJuIHZhbHVlOwo+ICAgCQlicmVhazsKPiBAQCAtNDIzLDcgKzQyMyw3IEBAIHN0YXRpYyBpbnQg
aTkxNV9nZXRwYXJhbV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+
ICAgCQl2YWx1ZSA9IGk5MTVfZ2VtX21tYXBfZ3R0X3ZlcnNpb24oKTsKPiAgIAkJYnJlYWs7Cj4g
ICAJY2FzZSBJOTE1X1BBUkFNX0hBU19TQ0hFRFVMRVI6Cj4gLQkJdmFsdWUgPSBkZXZfcHJpdi0+
Y2Fwcy5zY2hlZHVsZXI7Cj4gKwkJdmFsdWUgPSBpOTE1LT5jYXBzLnNjaGVkdWxlcjsKPiAgIAkJ
YnJlYWs7Cj4gICAKPiAgIAljYXNlIEk5MTVfUEFSQU1fTU1BUF9WRVJTSU9OOgo+IEBAIC00NTYs
NyArNDU2LDcgQEAgc3RhdGljIGludCBpOTE1X2dldHBhcmFtX2lvY3RsKHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gICAJCXZhbHVlID0gMTsKPiAgIAkJYnJlYWs7Cj4gICAJ
Y2FzZSBJOTE1X1BBUkFNX0hBU19DT05URVhUX0lTT0xBVElPTjoKPiAtCQl2YWx1ZSA9IGludGVs
X2VuZ2luZXNfaGFzX2NvbnRleHRfaXNvbGF0aW9uKGRldl9wcml2KTsKPiArCQl2YWx1ZSA9IGlu
dGVsX2VuZ2luZXNfaGFzX2NvbnRleHRfaXNvbGF0aW9uKGk5MTUpOwo+ICAgCQlicmVhazsKPiAg
IAljYXNlIEk5MTVfUEFSQU1fU0xJQ0VfTUFTSzoKPiAgIAkJdmFsdWUgPSBzc2V1LT5zbGljZV9t
YXNrOwo+IEBAIC00NjksMTAgKzQ2OSwxMCBAQCBzdGF0aWMgaW50IGk5MTVfZ2V0cGFyYW1faW9j
dGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKPiAgIAkJCXJldHVybiAtRU5P
REVWOwo+ICAgCQlicmVhazsKPiAgIAljYXNlIEk5MTVfUEFSQU1fQ1NfVElNRVNUQU1QX0ZSRVFV
RU5DWToKPiAtCQl2YWx1ZSA9IDEwMDAgKiBSVU5USU1FX0lORk8oZGV2X3ByaXYpLT5jc190aW1l
c3RhbXBfZnJlcXVlbmN5X2toejsKPiArCQl2YWx1ZSA9IDEwMDAgKiBSVU5USU1FX0lORk8oaTkx
NSktPmNzX3RpbWVzdGFtcF9mcmVxdWVuY3lfa2h6Owo+ICAgCQlicmVhazsKPiAgIAljYXNlIEk5
MTVfUEFSQU1fTU1BUF9HVFRfQ09IRVJFTlQ6Cj4gLQkJdmFsdWUgPSBJTlRFTF9JTkZPKGRldl9w
cml2KS0+aGFzX2NvaGVyZW50X2dndHQ7Cj4gKwkJdmFsdWUgPSBJTlRFTF9JTkZPKGk5MTUpLT5o
YXNfY29oZXJlbnRfZ2d0dDsKPiAgIAkJYnJlYWs7Cj4gICAJZGVmYXVsdDoKPiAgIAkJRFJNX0RF
QlVHKCJVbmtub3duIHBhcmFtZXRlciAlZFxuIiwgcGFyYW0tPnBhcmFtKTsKPiBAQCAtNDg1LDEz
ICs0ODUsMTMgQEAgc3RhdGljIGludCBpOTE1X2dldHBhcmFtX2lvY3RsKHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gICAJcmV0dXJuIDA7Cj4gICB9Cj4gICAKPiAtc3RhdGlj
IGludCBpOTE1X2dldF9icmlkZ2VfZGV2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiArc3RhdGljIGludCBpOTE1X2dldF9icmlkZ2VfZGV2KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ICAgewo+IC0JaW50IGRvbWFpbiA9IHBjaV9kb21haW5fbnIoZGV2X3ByaXYt
PmRybS5wZGV2LT5idXMpOwo+ICsJaW50IGRvbWFpbiA9IHBjaV9kb21haW5fbnIoaTkxNS0+ZHJt
LnBkZXYtPmJ1cyk7Cj4gICAKPiAtCWRldl9wcml2LT5icmlkZ2VfZGV2ID0KPiArCWk5MTUtPmJy
aWRnZV9kZXYgPQo+ICAgCQlwY2lfZ2V0X2RvbWFpbl9idXNfYW5kX3Nsb3QoZG9tYWluLCAwLCBQ
Q0lfREVWRk4oMCwgMCkpOwo+IC0JaWYgKCFkZXZfcHJpdi0+YnJpZGdlX2Rldikgewo+ICsJaWYg
KCFpOTE1LT5icmlkZ2VfZGV2KSB7Cj4gICAJCURSTV9FUlJPUigiYnJpZGdlIGRldmljZSBub3Qg
Zm91bmRcbiIpOwo+ICAgCQlyZXR1cm4gLTE7Cj4gICAJfQo+IEBAIC01MDAsMTYgKzUwMCwxNiBA
QCBzdGF0aWMgaW50IGk5MTVfZ2V0X2JyaWRnZV9kZXYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICAgCj4gICAvKiBBbGxvY2F0ZSBzcGFjZSBmb3IgdGhlIE1DSCByZWdzIGlm
IG5lZWRlZCwgcmV0dXJuIG5vbnplcm8gb24gZXJyb3IgKi8KPiAgIHN0YXRpYyBpbnQKPiAtaW50
ZWxfYWxsb2NfbWNoYmFyX3Jlc291cmNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiAraW50ZWxfYWxsb2NfbWNoYmFyX3Jlc291cmNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQo+ICAgewo+IC0JaW50IHJlZyA9IElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCA/IE1D
SEJBUl9JOTY1IDogTUNIQkFSX0k5MTU7Cj4gKwlpbnQgcmVnID0gSU5URUxfR0VOKGk5MTUpID49
IDQgPyBNQ0hCQVJfSTk2NSA6IE1DSEJBUl9JOTE1Owo+ICAgCXUzMiB0ZW1wX2xvLCB0ZW1wX2hp
ID0gMDsKPiAgIAl1NjQgbWNoYmFyX2FkZHI7Cj4gICAJaW50IHJldDsKPiAgIAo+IC0JaWYgKElO
VEVMX0dFTihkZXZfcHJpdikgPj0gNCkKPiAtCQlwY2lfcmVhZF9jb25maWdfZHdvcmQoZGV2X3By
aXYtPmJyaWRnZV9kZXYsIHJlZyArIDQsICZ0ZW1wX2hpKTsKPiAtCXBjaV9yZWFkX2NvbmZpZ19k
d29yZChkZXZfcHJpdi0+YnJpZGdlX2RldiwgcmVnLCAmdGVtcF9sbyk7Cj4gKwlpZiAoSU5URUxf
R0VOKGk5MTUpID49IDQpCj4gKwkJcGNpX3JlYWRfY29uZmlnX2R3b3JkKGk5MTUtPmJyaWRnZV9k
ZXYsIHJlZyArIDQsICZ0ZW1wX2hpKTsKPiArCXBjaV9yZWFkX2NvbmZpZ19kd29yZChpOTE1LT5i
cmlkZ2VfZGV2LCByZWcsICZ0ZW1wX2xvKTsKPiAgIAltY2hiYXJfYWRkciA9ICgodTY0KXRlbXBf
aGkgPDwgMzIpIHwgdGVtcF9sbzsKPiAgIAo+ICAgCS8qIElmIEFDUEkgZG9lc24ndCBoYXZlIGl0
LCBhc3N1bWUgd2UgbmVlZCB0byBhbGxvY2F0ZSBpdCBvdXJzZWx2ZXMgKi8KPiBAQCAtNTIwLDQ3
ICs1MjAsNDcgQEAgaW50ZWxfYWxsb2NfbWNoYmFyX3Jlc291cmNlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiAgICNlbmRpZgo+ICAgCj4gICAJLyogR2V0IHNvbWUgc3BhY2Ug
Zm9yIGl0ICovCj4gLQlkZXZfcHJpdi0+bWNoX3Jlcy5uYW1lID0gImk5MTUgTUNIQkFSIjsKPiAt
CWRldl9wcml2LT5tY2hfcmVzLmZsYWdzID0gSU9SRVNPVVJDRV9NRU07Cj4gLQlyZXQgPSBwY2lf
YnVzX2FsbG9jX3Jlc291cmNlKGRldl9wcml2LT5icmlkZ2VfZGV2LT5idXMsCj4gLQkJCQkgICAg
ICZkZXZfcHJpdi0+bWNoX3JlcywKPiArCWk5MTUtPm1jaF9yZXMubmFtZSA9ICJpOTE1IE1DSEJB
UiI7Cj4gKwlpOTE1LT5tY2hfcmVzLmZsYWdzID0gSU9SRVNPVVJDRV9NRU07Cj4gKwlyZXQgPSBw
Y2lfYnVzX2FsbG9jX3Jlc291cmNlKGk5MTUtPmJyaWRnZV9kZXYtPmJ1cywKPiArCQkJCSAgICAg
Jmk5MTUtPm1jaF9yZXMsCj4gICAJCQkJICAgICBNQ0hCQVJfU0laRSwgTUNIQkFSX1NJWkUsCj4g
ICAJCQkJICAgICBQQ0lCSU9TX01JTl9NRU0sCj4gICAJCQkJICAgICAwLCBwY2liaW9zX2FsaWdu
X3Jlc291cmNlLAo+IC0JCQkJICAgICBkZXZfcHJpdi0+YnJpZGdlX2Rldik7Cj4gKwkJCQkgICAg
IGk5MTUtPmJyaWRnZV9kZXYpOwo+ICAgCWlmIChyZXQpIHsKPiAgIAkJRFJNX0RFQlVHX0RSSVZF
UigiZmFpbGVkIGJ1cyBhbGxvYzogJWRcbiIsIHJldCk7Cj4gLQkJZGV2X3ByaXYtPm1jaF9yZXMu
c3RhcnQgPSAwOwo+ICsJCWk5MTUtPm1jaF9yZXMuc3RhcnQgPSAwOwo+ICAgCQlyZXR1cm4gcmV0
Owo+ICAgCX0KPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCkKPiAtCQlwY2lf
d3JpdGVfY29uZmlnX2R3b3JkKGRldl9wcml2LT5icmlkZ2VfZGV2LCByZWcgKyA0LAo+IC0JCQkJ
ICAgICAgIHVwcGVyXzMyX2JpdHMoZGV2X3ByaXYtPm1jaF9yZXMuc3RhcnQpKTsKPiArCWlmIChJ
TlRFTF9HRU4oaTkxNSkgPj0gNCkKPiArCQlwY2lfd3JpdGVfY29uZmlnX2R3b3JkKGk5MTUtPmJy
aWRnZV9kZXYsIHJlZyArIDQsCj4gKwkJCQkgICAgICAgdXBwZXJfMzJfYml0cyhpOTE1LT5tY2hf
cmVzLnN0YXJ0KSk7Cj4gICAKPiAtCXBjaV93cml0ZV9jb25maWdfZHdvcmQoZGV2X3ByaXYtPmJy
aWRnZV9kZXYsIHJlZywKPiAtCQkJICAgICAgIGxvd2VyXzMyX2JpdHMoZGV2X3ByaXYtPm1jaF9y
ZXMuc3RhcnQpKTsKPiArCXBjaV93cml0ZV9jb25maWdfZHdvcmQoaTkxNS0+YnJpZGdlX2Rldiwg
cmVnLAo+ICsJCQkgICAgICAgbG93ZXJfMzJfYml0cyhpOTE1LT5tY2hfcmVzLnN0YXJ0KSk7Cj4g
ICAJcmV0dXJuIDA7Cj4gICB9Cj4gICAKPiAgIC8qIFNldHVwIE1DSEJBUiBpZiBwb3NzaWJsZSwg
cmV0dXJuIHRydWUgaWYgd2Ugc2hvdWxkIGRpc2FibGUgaXQgYWdhaW4gKi8KPiAgIHN0YXRpYyB2
b2lkCj4gLWludGVsX3NldHVwX21jaGJhcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gK2ludGVsX3NldHVwX21jaGJhcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiAgIHsKPiAtCWludCBtY2hiYXJfcmVnID0gSU5URUxfR0VOKGRldl9wcml2KSA+PSA0ID8gTUNI
QkFSX0k5NjUgOiBNQ0hCQVJfSTkxNTsKPiArCWludCBtY2hiYXJfcmVnID0gSU5URUxfR0VOKGk5
MTUpID49IDQgPyBNQ0hCQVJfSTk2NSA6IE1DSEJBUl9JOTE1Owo+ICAgCXUzMiB0ZW1wOwo+ICAg
CWJvb2wgZW5hYmxlZDsKPiAgIAo+IC0JaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElT
X0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ICsJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNf
Q0hFUlJZVklFVyhpOTE1KSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQlkZXZfcHJpdi0+bWNoYmFy
X25lZWRfZGlzYWJsZSA9IGZhbHNlOwo+ICsJaTkxNS0+bWNoYmFyX25lZWRfZGlzYWJsZSA9IGZh
bHNlOwo+ICAgCj4gLQlpZiAoSVNfSTkxNUcoZGV2X3ByaXYpIHx8IElTX0k5MTVHTShkZXZfcHJp
dikpIHsKPiAtCQlwY2lfcmVhZF9jb25maWdfZHdvcmQoZGV2X3ByaXYtPmJyaWRnZV9kZXYsIERF
VkVOLCAmdGVtcCk7Cj4gKwlpZiAoSVNfSTkxNUcoaTkxNSkgfHwgSVNfSTkxNUdNKGk5MTUpKSB7
Cj4gKwkJcGNpX3JlYWRfY29uZmlnX2R3b3JkKGk5MTUtPmJyaWRnZV9kZXYsIERFVkVOLCAmdGVt
cCk7Cj4gICAJCWVuYWJsZWQgPSAhISh0ZW1wICYgREVWRU5fTUNIQkFSX0VOKTsKPiAgIAl9IGVs
c2Ugewo+IC0JCXBjaV9yZWFkX2NvbmZpZ19kd29yZChkZXZfcHJpdi0+YnJpZGdlX2RldiwgbWNo
YmFyX3JlZywgJnRlbXApOwo+ICsJCXBjaV9yZWFkX2NvbmZpZ19kd29yZChpOTE1LT5icmlkZ2Vf
ZGV2LCBtY2hiYXJfcmVnLCAmdGVtcCk7Cj4gICAJCWVuYWJsZWQgPSB0ZW1wICYgMTsKPiAgIAl9
Cj4gICAKPiBAQCAtNTY4LDU2ICs1NjgsNTYgQEAgaW50ZWxfc2V0dXBfbWNoYmFyKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAlpZiAoZW5hYmxlZCkKPiAgIAkJcmV0dXJu
Owo+ICAgCj4gLQlpZiAoaW50ZWxfYWxsb2NfbWNoYmFyX3Jlc291cmNlKGRldl9wcml2KSkKPiAr
CWlmIChpbnRlbF9hbGxvY19tY2hiYXJfcmVzb3VyY2UoaTkxNSkpCj4gICAJCXJldHVybjsKPiAg
IAo+IC0JZGV2X3ByaXYtPm1jaGJhcl9uZWVkX2Rpc2FibGUgPSB0cnVlOwo+ICsJaTkxNS0+bWNo
YmFyX25lZWRfZGlzYWJsZSA9IHRydWU7Cj4gICAKPiAgIAkvKiBTcGFjZSBpcyBhbGxvY2F0ZWQg
b3IgcmVzZXJ2ZWQsIHNvIGVuYWJsZSBpdC4gKi8KPiAtCWlmIChJU19JOTE1RyhkZXZfcHJpdikg
fHwgSVNfSTkxNUdNKGRldl9wcml2KSkgewo+IC0JCXBjaV93cml0ZV9jb25maWdfZHdvcmQoZGV2
X3ByaXYtPmJyaWRnZV9kZXYsIERFVkVOLAo+ICsJaWYgKElTX0k5MTVHKGk5MTUpIHx8IElTX0k5
MTVHTShpOTE1KSkgewo+ICsJCXBjaV93cml0ZV9jb25maWdfZHdvcmQoaTkxNS0+YnJpZGdlX2Rl
diwgREVWRU4sCj4gICAJCQkJICAgICAgIHRlbXAgfCBERVZFTl9NQ0hCQVJfRU4pOwo+ICAgCX0g
ZWxzZSB7Cj4gLQkJcGNpX3JlYWRfY29uZmlnX2R3b3JkKGRldl9wcml2LT5icmlkZ2VfZGV2LCBt
Y2hiYXJfcmVnLCAmdGVtcCk7Cj4gLQkJcGNpX3dyaXRlX2NvbmZpZ19kd29yZChkZXZfcHJpdi0+
YnJpZGdlX2RldiwgbWNoYmFyX3JlZywgdGVtcCB8IDEpOwo+ICsJCXBjaV9yZWFkX2NvbmZpZ19k
d29yZChpOTE1LT5icmlkZ2VfZGV2LCBtY2hiYXJfcmVnLCAmdGVtcCk7Cj4gKwkJcGNpX3dyaXRl
X2NvbmZpZ19kd29yZChpOTE1LT5icmlkZ2VfZGV2LCBtY2hiYXJfcmVnLCB0ZW1wIHwgMSk7Cj4g
ICAJfQo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZAo+IC1pbnRlbF90ZWFyZG93bl9tY2hiYXIo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtpbnRlbF90ZWFyZG93bl9tY2hi
YXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlpbnQgbWNoYmFyX3Jl
ZyA9IElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCA/IE1DSEJBUl9JOTY1IDogTUNIQkFSX0k5MTU7
Cj4gKwlpbnQgbWNoYmFyX3JlZyA9IElOVEVMX0dFTihpOTE1KSA+PSA0ID8gTUNIQkFSX0k5NjUg
OiBNQ0hCQVJfSTkxNTsKPiAgIAo+IC0JaWYgKGRldl9wcml2LT5tY2hiYXJfbmVlZF9kaXNhYmxl
KSB7Cj4gLQkJaWYgKElTX0k5MTVHKGRldl9wcml2KSB8fCBJU19JOTE1R00oZGV2X3ByaXYpKSB7
Cj4gKwlpZiAoaTkxNS0+bWNoYmFyX25lZWRfZGlzYWJsZSkgewo+ICsJCWlmIChJU19JOTE1Ryhp
OTE1KSB8fCBJU19JOTE1R00oaTkxNSkpIHsKPiAgIAkJCXUzMiBkZXZlbl92YWw7Cj4gICAKPiAt
CQkJcGNpX3JlYWRfY29uZmlnX2R3b3JkKGRldl9wcml2LT5icmlkZ2VfZGV2LCBERVZFTiwKPiAr
CQkJcGNpX3JlYWRfY29uZmlnX2R3b3JkKGk5MTUtPmJyaWRnZV9kZXYsIERFVkVOLAo+ICAgCQkJ
CQkgICAgICAmZGV2ZW5fdmFsKTsKPiAgIAkJCWRldmVuX3ZhbCAmPSB+REVWRU5fTUNIQkFSX0VO
Owo+IC0JCQlwY2lfd3JpdGVfY29uZmlnX2R3b3JkKGRldl9wcml2LT5icmlkZ2VfZGV2LCBERVZF
TiwKPiArCQkJcGNpX3dyaXRlX2NvbmZpZ19kd29yZChpOTE1LT5icmlkZ2VfZGV2LCBERVZFTiwK
PiAgIAkJCQkJICAgICAgIGRldmVuX3ZhbCk7Cj4gICAJCX0gZWxzZSB7Cj4gICAJCQl1MzIgbWNo
YmFyX3ZhbDsKPiAgIAo+IC0JCQlwY2lfcmVhZF9jb25maWdfZHdvcmQoZGV2X3ByaXYtPmJyaWRn
ZV9kZXYsIG1jaGJhcl9yZWcsCj4gKwkJCXBjaV9yZWFkX2NvbmZpZ19kd29yZChpOTE1LT5icmlk
Z2VfZGV2LCBtY2hiYXJfcmVnLAo+ICAgCQkJCQkgICAgICAmbWNoYmFyX3ZhbCk7Cj4gICAJCQlt
Y2hiYXJfdmFsICY9IH4xOwo+IC0JCQlwY2lfd3JpdGVfY29uZmlnX2R3b3JkKGRldl9wcml2LT5i
cmlkZ2VfZGV2LCBtY2hiYXJfcmVnLAo+ICsJCQlwY2lfd3JpdGVfY29uZmlnX2R3b3JkKGk5MTUt
PmJyaWRnZV9kZXYsIG1jaGJhcl9yZWcsCj4gICAJCQkJCSAgICAgICBtY2hiYXJfdmFsKTsKPiAg
IAkJfQo+ICAgCX0KPiAgIAo+IC0JaWYgKGRldl9wcml2LT5tY2hfcmVzLnN0YXJ0KQo+IC0JCXJl
bGVhc2VfcmVzb3VyY2UoJmRldl9wcml2LT5tY2hfcmVzKTsKPiArCWlmIChpOTE1LT5tY2hfcmVz
LnN0YXJ0KQo+ICsJCXJlbGVhc2VfcmVzb3VyY2UoJmk5MTUtPm1jaF9yZXMpOwo+ICAgfQo+ICAg
Cj4gICAvKiB0cnVlID0gZW5hYmxlIGRlY29kZSwgZmFsc2UgPSBkaXNhYmxlIGRlY29kZXIgKi8K
PiAgIHN0YXRpYyB1bnNpZ25lZCBpbnQgaTkxNV92Z2Ffc2V0X2RlY29kZSh2b2lkICpjb29raWUs
IGJvb2wgc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSBjb29raWU7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGNvb2tpZTsKPiAg
IAo+IC0JaW50ZWxfbW9kZXNldF92Z2Ffc2V0X3N0YXRlKGRldl9wcml2LCBzdGF0ZSk7Cj4gKwlp
bnRlbF9tb2Rlc2V0X3ZnYV9zZXRfc3RhdGUoaTkxNSwgc3RhdGUpOwo+ICAgCWlmIChzdGF0ZSkK
PiAgIAkJcmV0dXJuIFZHQV9SU1JDX0xFR0FDWV9JTyB8IFZHQV9SU1JDX0xFR0FDWV9NRU0gfAo+
ICAgCQkgICAgICAgVkdBX1JTUkNfTk9STUFMX0lPIHwgVkdBX1JTUkNfTk9STUFMX01FTTsKPiBA
QCAtNjY4LDIxICs2NjgsMjEgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2Z2Ffc3dpdGNoZXJvb19j
bGllbnRfb3BzIGk5MTVfc3dpdGNoZXJvb19vcHMgPSB7Cj4gICAKPiAgIHN0YXRpYyBpbnQgaTkx
NV9sb2FkX21vZGVzZXRfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAgewo+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+IC0Jc3RydWN0
IHBjaV9kZXYgKnBkZXYgPSBkZXZfcHJpdi0+ZHJtLnBkZXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0g
aTkxNS0+ZHJtLnBkZXY7Cj4gICAJaW50IHJldDsKPiAgIAo+ICAgCWlmIChpOTE1X2luamVjdF9s
b2FkX2ZhaWx1cmUoKSkKPiAgIAkJcmV0dXJuIC1FTk9ERVY7Cj4gICAKPiAtCWlmIChIQVNfRElT
UExBWShkZXZfcHJpdikpIHsKPiAtCQlyZXQgPSBkcm1fdmJsYW5rX2luaXQoJmRldl9wcml2LT5k
cm0sCj4gLQkJCQkgICAgICBJTlRFTF9JTkZPKGRldl9wcml2KS0+bnVtX3BpcGVzKTsKPiArCWlm
IChIQVNfRElTUExBWShpOTE1KSkgewo+ICsJCXJldCA9IGRybV92YmxhbmtfaW5pdCgmaTkxNS0+
ZHJtLAo+ICsJCQkJICAgICAgSU5URUxfSU5GTyhpOTE1KS0+bnVtX3BpcGVzKTsKPiAgIAkJaWYg
KHJldCkKPiAgIAkJCWdvdG8gb3V0Owo+ICAgCX0KPiAgIAo+IC0JaW50ZWxfYmlvc19pbml0KGRl
dl9wcml2KTsKPiArCWludGVsX2Jpb3NfaW5pdChpOTE1KTsKPiAgIAo+ICAgCS8qIElmIHdlIGhh
dmUgPiAxIFZHQSBjYXJkcywgdGhlbiB3ZSBuZWVkIHRvIGFyYml0cmF0ZSBhY2Nlc3MKPiAgIAkg
KiB0byB0aGUgY29tbW9uIFZHQSByZXNvdXJjZXMuCj4gQEAgLTY5MSw3ICs2OTEsNyBAQCBzdGF0
aWMgaW50IGk5MTVfbG9hZF9tb2Rlc2V0X2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAg
IAkgKiB0aGVuIHdlIGRvIG5vdCB0YWtlIHBhcnQgaW4gVkdBIGFyYml0cmF0aW9uIGFuZCB0aGUK
PiAgIAkgKiB2Z2FfY2xpZW50X3JlZ2lzdGVyKCkgZmFpbHMgd2l0aCAtRU5PREVWLgo+ICAgCSAq
Lwo+IC0JcmV0ID0gdmdhX2NsaWVudF9yZWdpc3RlcihwZGV2LCBkZXZfcHJpdiwgTlVMTCwgaTkx
NV92Z2Ffc2V0X2RlY29kZSk7Cj4gKwlyZXQgPSB2Z2FfY2xpZW50X3JlZ2lzdGVyKHBkZXYsIGk5
MTUsIE5VTEwsIGk5MTVfdmdhX3NldF9kZWNvZGUpOwo+ICAgCWlmIChyZXQgJiYgcmV0ICE9IC1F
Tk9ERVYpCj4gICAJCWdvdG8gb3V0Owo+ICAgCj4gQEAgLTcwMiwxNyArNzAyLDE3IEBAIHN0YXRp
YyBpbnQgaTkxNV9sb2FkX21vZGVzZXRfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAg
CQlnb3RvIGNsZWFudXBfdmdhX2NsaWVudDsKPiAgIAo+ICAgCS8qIG11c3QgaGFwcGVuIGJlZm9y
ZSBpbnRlbF9wb3dlcl9kb21haW5zX2luaXRfaHcoKSBvbiBWTFYvQ0hWICovCj4gLQlpbnRlbF91
cGRhdGVfcmF3Y2xrKGRldl9wcml2KTsKPiArCWludGVsX3VwZGF0ZV9yYXdjbGsoaTkxNSk7Cj4g
ICAKPiAtCWludGVsX3Bvd2VyX2RvbWFpbnNfaW5pdF9odyhkZXZfcHJpdiwgZmFsc2UpOwo+ICsJ
aW50ZWxfcG93ZXJfZG9tYWluc19pbml0X2h3KGk5MTUsIGZhbHNlKTsKPiAgIAo+IC0JaW50ZWxf
Y3NyX3Vjb2RlX2luaXQoZGV2X3ByaXYpOwo+ICsJaW50ZWxfY3NyX3Vjb2RlX2luaXQoaTkxNSk7
Cj4gICAKPiAtCXJldCA9IGludGVsX2lycV9pbnN0YWxsKGRldl9wcml2KTsKPiArCXJldCA9IGlu
dGVsX2lycV9pbnN0YWxsKGk5MTUpOwo+ICAgCWlmIChyZXQpCj4gICAJCWdvdG8gY2xlYW51cF9j
c3I7Cj4gICAKPiAtCWludGVsX2dtYnVzX3NldHVwKGRldl9wcml2KTsKPiArCWludGVsX2dtYnVz
X3NldHVwKGk5MTUpOwo+ICAgCj4gICAJLyogSW1wb3J0YW50OiBUaGUgb3V0cHV0IHNldHVwIGZ1
bmN0aW9ucyBjYWxsZWQgYnkgbW9kZXNldF9pbml0IG5lZWQKPiAgIAkgKiB3b3JraW5nIGlycXMg
Zm9yIGUuZy4gZ21idXMgYW5kIGRwIGF1eCB0cmFuc2ZlcnMuICovCj4gQEAgLTcyMCwxMyArNzIw
LDEzIEBAIHN0YXRpYyBpbnQgaTkxNV9sb2FkX21vZGVzZXRfaW5pdChzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2KQo+ICAgCWlmIChyZXQpCj4gICAJCWdvdG8gY2xlYW51cF9pcnE7Cj4gICAKPiAtCXJl
dCA9IGk5MTVfZ2VtX2luaXQoZGV2X3ByaXYpOwo+ICsJcmV0ID0gaTkxNV9nZW1faW5pdChpOTE1
KTsKPiAgIAlpZiAocmV0KQo+ICAgCQlnb3RvIGNsZWFudXBfbW9kZXNldDsKPiAgIAo+IC0JaW50
ZWxfb3ZlcmxheV9zZXR1cChkZXZfcHJpdik7Cj4gKwlpbnRlbF9vdmVybGF5X3NldHVwKGk5MTUp
Owo+ICAgCj4gLQlpZiAoIUhBU19ESVNQTEFZKGRldl9wcml2KSkKPiArCWlmICghSEFTX0RJU1BM
QVkoaTkxNSkpCj4gICAJCXJldHVybiAwOwo+ICAgCj4gICAJcmV0ID0gaW50ZWxfZmJkZXZfaW5p
dChkZXYpOwo+IEBAIC03MzQsMjQgKzczNCwyNCBAQCBzdGF0aWMgaW50IGk5MTVfbG9hZF9tb2Rl
c2V0X2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIAkJZ290byBjbGVhbnVwX2dlbTsK
PiAgIAo+ICAgCS8qIE9ubHkgZW5hYmxlIGhvdHBsdWcgaGFuZGxpbmcgb25jZSB0aGUgZmJkZXYg
aXMgZnVsbHkgc2V0IHVwLiAqLwo+IC0JaW50ZWxfaHBkX2luaXQoZGV2X3ByaXYpOwo+ICsJaW50
ZWxfaHBkX2luaXQoaTkxNSk7Cj4gICAKPiAtCWludGVsX2luaXRfaXBjKGRldl9wcml2KTsKPiAr
CWludGVsX2luaXRfaXBjKGk5MTUpOwo+ICAgCj4gICAJcmV0dXJuIDA7Cj4gICAKPiAgIGNsZWFu
dXBfZ2VtOgo+IC0JaTkxNV9nZW1fc3VzcGVuZChkZXZfcHJpdik7Cj4gLQlpOTE1X2dlbV9maW5p
X2h3KGRldl9wcml2KTsKPiAtCWk5MTVfZ2VtX2ZpbmkoZGV2X3ByaXYpOwo+ICsJaTkxNV9nZW1f
c3VzcGVuZChpOTE1KTsKPiArCWk5MTVfZ2VtX2ZpbmlfaHcoaTkxNSk7Cj4gKwlpOTE1X2dlbV9m
aW5pKGk5MTUpOwo+ICAgY2xlYW51cF9tb2Rlc2V0Ogo+ICAgCWludGVsX21vZGVzZXRfY2xlYW51
cChkZXYpOwo+ICAgY2xlYW51cF9pcnE6Cj4gICAJZHJtX2lycV91bmluc3RhbGwoZGV2KTsKPiAt
CWludGVsX2dtYnVzX3RlYXJkb3duKGRldl9wcml2KTsKPiArCWludGVsX2dtYnVzX3RlYXJkb3du
KGk5MTUpOwo+ICAgY2xlYW51cF9jc3I6Cj4gLQlpbnRlbF9jc3JfdWNvZGVfZmluaShkZXZfcHJp
dik7Cj4gLQlpbnRlbF9wb3dlcl9kb21haW5zX2ZpbmlfaHcoZGV2X3ByaXYpOwo+ICsJaW50ZWxf
Y3NyX3Vjb2RlX2ZpbmkoaTkxNSk7Cj4gKwlpbnRlbF9wb3dlcl9kb21haW5zX2ZpbmlfaHcoaTkx
NSk7Cj4gICAJdmdhX3N3aXRjaGVyb29fdW5yZWdpc3Rlcl9jbGllbnQocGRldik7Cj4gICBjbGVh
bnVwX3ZnYV9jbGllbnQ6Cj4gICAJdmdhX2NsaWVudF9yZWdpc3RlcihwZGV2LCBOVUxMLCBOVUxM
LCBOVUxMKTsKPiBAQCAtNzU5LDExICs3NTksMTEgQEAgc3RhdGljIGludCBpOTE1X2xvYWRfbW9k
ZXNldF9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gICAJcmV0dXJuIHJldDsKPiAgIH0K
PiAgIAo+IC1zdGF0aWMgaW50IGk5MTVfa2lja19vdXRfZmlybXdhcmVfZmIoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgaW50IGk5MTVfa2lja19vdXRfZmlybXdh
cmVfZmIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RydWN0IGFw
ZXJ0dXJlc19zdHJ1Y3QgKmFwOwo+IC0Jc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBkZXZfcHJpdi0+
ZHJtLnBkZXY7Cj4gLQlzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0ID0gJmRldl9wcml2LT5nZ3R0Owo+
ICsJc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBpOTE1LT5kcm0ucGRldjsKPiArCXN0cnVjdCBpOTE1
X2dndHQgKmdndHQgPSAmaTkxNS0+Z2d0dDsKPiAgIAlib29sIHByaW1hcnk7Cj4gICAJaW50IHJl
dDsKPiAgIAo+IEBAIC03ODQsMjIgKzc4NCwyMiBAQCBzdGF0aWMgaW50IGk5MTVfa2lja19vdXRf
ZmlybXdhcmVfZmIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCXJldHVy
biByZXQ7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaW50ZWxfaW5pdF9kcGlvKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaW50ZWxfaW5pdF9kcGlv
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCS8qCj4gICAJICogSU9T
Rl9QT1JUX0RQSU8gaXMgdXNlZCBmb3IgVkxWIHgyIFBIWSAoRFAvSERNSSBCIGFuZCBDKSwKPiAg
IAkgKiBDSFYgeDEgUEhZIChEUC9IRE1JIEQpCj4gICAJICogSU9TRl9QT1JUX0RQSU9fMiBpcyB1
c2VkIGZvciBDSFYgeDIgUEhZIChEUC9IRE1JIEIgYW5kIEMpCj4gICAJICovCj4gLQlpZiAoSVNf
Q0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiArCWlmIChJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4g
ICAJCURQSU9fUEhZX0lPU0ZfUE9SVChEUElPX1BIWTApID0gSU9TRl9QT1JUX0RQSU9fMjsKPiAg
IAkJRFBJT19QSFlfSU9TRl9QT1JUKERQSU9fUEhZMSkgPSBJT1NGX1BPUlRfRFBJTzsKPiAtCX0g
ZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAoSVNfVkFM
TEVZVklFVyhpOTE1KSkgewo+ICAgCQlEUElPX1BIWV9JT1NGX1BPUlQoRFBJT19QSFkwKSA9IElP
U0ZfUE9SVF9EUElPOwo+ICAgCX0KPiAgIH0KPiAgIAo+IC1zdGF0aWMgaW50IGk5MTVfd29ya3F1
ZXVlc19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIGlu
dCBpOTE1X3dvcmtxdWV1ZXNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAg
IHsKPiAgIAkvKgo+ICAgCSAqIFRoZSBpOTE1IHdvcmtxdWV1ZSBpcyBwcmltYXJpbHkgdXNlZCBm
b3IgYmF0Y2hlZCByZXRpcmVtZW50IG9mCj4gQEAgLTgxNSwxOCArODE1LDE4IEBAIHN0YXRpYyBp
bnQgaTkxNV93b3JrcXVldWVzX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ICAgCSAqIHNvIHRoZXJlIGlzIG5vIHBvaW50IGluIHJ1bm5pbmcgbW9yZSB0aGFuIG9uZSBp
bnN0YW5jZSBvZiB0aGUKPiAgIAkgKiB3b3JrcXVldWUgYXQgYW55IHRpbWUuICBVc2UgYW4gb3Jk
ZXJlZCBvbmUuCj4gICAJICovCj4gLQlkZXZfcHJpdi0+d3EgPSBhbGxvY19vcmRlcmVkX3dvcmtx
dWV1ZSgiaTkxNSIsIDApOwo+IC0JaWYgKGRldl9wcml2LT53cSA9PSBOVUxMKQo+ICsJaTkxNS0+
d3EgPSBhbGxvY19vcmRlcmVkX3dvcmtxdWV1ZSgiaTkxNSIsIDApOwo+ICsJaWYgKGk5MTUtPndx
ID09IE5VTEwpCj4gICAJCWdvdG8gb3V0X2VycjsKPiAgIAo+IC0JZGV2X3ByaXYtPmhvdHBsdWcu
ZHBfd3EgPSBhbGxvY19vcmRlcmVkX3dvcmtxdWV1ZSgiaTkxNS1kcCIsIDApOwo+IC0JaWYgKGRl
dl9wcml2LT5ob3RwbHVnLmRwX3dxID09IE5VTEwpCj4gKwlpOTE1LT5ob3RwbHVnLmRwX3dxID0g
YWxsb2Nfb3JkZXJlZF93b3JrcXVldWUoImk5MTUtZHAiLCAwKTsKPiArCWlmIChpOTE1LT5ob3Rw
bHVnLmRwX3dxID09IE5VTEwpCj4gICAJCWdvdG8gb3V0X2ZyZWVfd3E7Cj4gICAKPiAgIAlyZXR1
cm4gMDsKPiAgIAo+ICAgb3V0X2ZyZWVfd3E6Cj4gLQlkZXN0cm95X3dvcmtxdWV1ZShkZXZfcHJp
di0+d3EpOwo+ICsJZGVzdHJveV93b3JrcXVldWUoaTkxNS0+d3EpOwo+ICAgb3V0X2VycjoKPiAg
IAlEUk1fRVJST1IoIkZhaWxlZCB0byBhbGxvY2F0ZSB3b3JrcXVldWVzLlxuIik7Cj4gICAKPiBA
QCAtODQyLDEwICs4NDIsMTAgQEAgc3RhdGljIHZvaWQgaTkxNV9lbmdpbmVzX2NsZWFudXAoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICAJCWtmcmVlKGVuZ2luZSk7Cj4gICB9Cj4g
ICAKPiAtc3RhdGljIHZvaWQgaTkxNV93b3JrcXVldWVzX2NsZWFudXAoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBpOTE1X3dvcmtxdWV1ZXNfY2xlYW51
cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCWRlc3Ryb3lfd29ya3F1
ZXVlKGRldl9wcml2LT5ob3RwbHVnLmRwX3dxKTsKPiAtCWRlc3Ryb3lfd29ya3F1ZXVlKGRldl9w
cml2LT53cSk7Cj4gKwlkZXN0cm95X3dvcmtxdWV1ZShpOTE1LT5ob3RwbHVnLmRwX3dxKTsKPiAr
CWRlc3Ryb3lfd29ya3F1ZXVlKGk5MTUtPndxKTsKPiAgIH0KPiAgIAo+ICAgLyoKPiBAQCAtODU4
LDE0ICs4NTgsMTQgQEAgc3RhdGljIHZvaWQgaTkxNV93b3JrcXVldWVzX2NsZWFudXAoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgICogKHdvcmthcm91bmRzIGhhdmUgYSBo
YWJpdCBvZiBwZXJzaXN0aW5nISkuIEFueXRoaW5nIG9sZGVyIHRoYW4gdGhhdAo+ICAgICogc2hv
dWxkIGJlIHJlbW92ZWQgYWxvbmcgd2l0aCB0aGUgY29tcGxpY2F0aW9ucyB0aGV5IGludHJvZHVj
ZS4KPiAgICAqLwo+IC1zdGF0aWMgdm9pZCBpbnRlbF9kZXRlY3RfcHJlcHJvZHVjdGlvbl9odyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGludGVsX2Rl
dGVjdF9wcmVwcm9kdWN0aW9uX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAg
ewo+ICAgCWJvb2wgcHJlID0gZmFsc2U7Cj4gICAKPiAtCXByZSB8PSBJU19IU1dfRUFSTFlfU0RW
KGRldl9wcml2KTsKPiAtCXByZSB8PSBJU19TS0xfUkVWSUQoZGV2X3ByaXYsIDAsIFNLTF9SRVZJ
RF9GMCk7Cj4gLQlwcmUgfD0gSVNfQlhUX1JFVklEKGRldl9wcml2LCAwLCBCWFRfUkVWSURfQl9M
QVNUKTsKPiAtCXByZSB8PSBJU19LQkxfUkVWSUQoZGV2X3ByaXYsIDAsIEtCTF9SRVZJRF9BMCk7
Cj4gKwlwcmUgfD0gSVNfSFNXX0VBUkxZX1NEVihpOTE1KTsKPiArCXByZSB8PSBJU19TS0xfUkVW
SUQoaTkxNSwgMCwgU0tMX1JFVklEX0YwKTsKPiArCXByZSB8PSBJU19CWFRfUkVWSUQoaTkxNSwg
MCwgQlhUX1JFVklEX0JfTEFTVCk7Cj4gKwlwcmUgfD0gSVNfS0JMX1JFVklEKGk5MTUsIDAsIEtC
TF9SRVZJRF9BMCk7Cj4gICAKPiAgIAlpZiAocHJlKSB7Cj4gICAJCURSTV9FUlJPUigiVGhpcyBp
cyBhIHByZS1wcm9kdWN0aW9uIHN0ZXBwaW5nLiAiCj4gQEAgLTg3Niw3ICs4NzYsNyBAQCBzdGF0
aWMgdm9pZCBpbnRlbF9kZXRlY3RfcHJlcHJvZHVjdGlvbl9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gICAKPiAgIC8qKgo+ICAgICogaTkxNV9kcml2ZXJfaW5pdF9lYXJs
eSAtIHNldHVwIHN0YXRlIG5vdCByZXF1aXJpbmcgZGV2aWNlIGFjY2Vzcwo+IC0gKiBAZGV2X3By
aXY6IGRldmljZSBwcml2YXRlCj4gKyAqIEBpOTE1OiBkZXZpY2UgcHJpdmF0ZQo+ICAgICoKPiAg
ICAqIEluaXRpYWxpemUgZXZlcnl0aGluZyB0aGF0IGlzIGEgIlNXLW9ubHkiIHN0YXRlLCB0aGF0
IGlzIHN0YXRlIG5vdAo+ICAgICogcmVxdWlyaW5nIGFjY2Vzc2luZyB0aGUgZGV2aWNlIG9yIGV4
cG9zaW5nIHRoZSBkcml2ZXIgdmlhIGtlcm5lbCBpbnRlcm5hbAo+IEBAIC04ODQsMTUyICs4ODQs
MTUyIEBAIHN0YXRpYyB2b2lkIGludGVsX2RldGVjdF9wcmVwcm9kdWN0aW9uX2h3KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgICAqIHN5c3RlbSBtZW1vcnkgYWxsb2NhdGlv
biwgc2V0dGluZyB1cCBkZXZpY2Ugc3BlY2lmaWMgYXR0cmlidXRlcyBhbmQKPiAgICAqIGZ1bmN0
aW9uIGhvb2tzIG5vdCByZXF1aXJpbmcgYWNjZXNzaW5nIHRoZSBkZXZpY2UuCj4gICAgKi8KPiAt
c3RhdGljIGludCBpOTE1X2RyaXZlcl9pbml0X2Vhcmx5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiArc3RhdGljIGludCBpOTE1X2RyaXZlcl9pbml0X2Vhcmx5KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCWludCByZXQgPSAwOwo+ICAgCj4gICAJ
aWYgKGk5MTVfaW5qZWN0X2xvYWRfZmFpbHVyZSgpKQo+ICAgCQlyZXR1cm4gLUVOT0RFVjsKPiAg
IAo+IC0JaW50ZWxfZGV2aWNlX2luZm9fc3VicGxhdGZvcm1faW5pdChkZXZfcHJpdik7Cj4gKwlp
bnRlbF9kZXZpY2VfaW5mb19zdWJwbGF0Zm9ybV9pbml0KGk5MTUpOwo+ICAgCj4gLQlpbnRlbF91
bmNvcmVfaW5pdF9lYXJseSgmZGV2X3ByaXYtPnVuY29yZSk7Cj4gKwlpbnRlbF91bmNvcmVfaW5p
dF9lYXJseSgmaTkxNS0+dW5jb3JlKTsKPiAgIAo+IC0Jc3Bpbl9sb2NrX2luaXQoJmRldl9wcml2
LT5pcnFfbG9jayk7Cj4gLQlzcGluX2xvY2tfaW5pdCgmZGV2X3ByaXYtPmdwdV9lcnJvci5sb2Nr
KTsKPiAtCW11dGV4X2luaXQoJmRldl9wcml2LT5iYWNrbGlnaHRfbG9jayk7Cj4gKwlzcGluX2xv
Y2tfaW5pdCgmaTkxNS0+aXJxX2xvY2spOwo+ICsJc3Bpbl9sb2NrX2luaXQoJmk5MTUtPmdwdV9l
cnJvci5sb2NrKTsKPiArCW11dGV4X2luaXQoJmk5MTUtPmJhY2tsaWdodF9sb2NrKTsKPiAgIAo+
IC0JbXV0ZXhfaW5pdCgmZGV2X3ByaXYtPnNiX2xvY2spOwo+IC0JcG1fcW9zX2FkZF9yZXF1ZXN0
KCZkZXZfcHJpdi0+c2JfcW9zLAo+ICsJbXV0ZXhfaW5pdCgmaTkxNS0+c2JfbG9jayk7Cj4gKwlw
bV9xb3NfYWRkX3JlcXVlc3QoJmk5MTUtPnNiX3FvcywKPiAgIAkJCSAgIFBNX1FPU19DUFVfRE1B
X0xBVEVOQ1ksIFBNX1FPU19ERUZBVUxUX1ZBTFVFKTsKPiAgIAo+IC0JbXV0ZXhfaW5pdCgmZGV2
X3ByaXYtPmF2X211dGV4KTsKPiAtCW11dGV4X2luaXQoJmRldl9wcml2LT53bS53bV9tdXRleCk7
Cj4gLQltdXRleF9pbml0KCZkZXZfcHJpdi0+cHBzX211dGV4KTsKPiAtCW11dGV4X2luaXQoJmRl
dl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ICsJbXV0ZXhfaW5pdCgmaTkxNS0+YXZfbXV0ZXgp
Owo+ICsJbXV0ZXhfaW5pdCgmaTkxNS0+d20ud21fbXV0ZXgpOwo+ICsJbXV0ZXhfaW5pdCgmaTkx
NS0+cHBzX211dGV4KTsKPiArCW11dGV4X2luaXQoJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4g
ICAKPiAtCWk5MTVfbWVtY3B5X2luaXRfZWFybHkoZGV2X3ByaXYpOwo+IC0JaW50ZWxfcnVudGlt
ZV9wbV9pbml0X2Vhcmx5KGRldl9wcml2KTsKPiArCWk5MTVfbWVtY3B5X2luaXRfZWFybHkoaTkx
NSk7Cj4gKwlpbnRlbF9ydW50aW1lX3BtX2luaXRfZWFybHkoaTkxNSk7Cj4gICAKPiAtCXJldCA9
IGk5MTVfd29ya3F1ZXVlc19pbml0KGRldl9wcml2KTsKPiArCXJldCA9IGk5MTVfd29ya3F1ZXVl
c19pbml0KGk5MTUpOwo+ICAgCWlmIChyZXQgPCAwKQo+ICAgCQlnb3RvIGVycl9lbmdpbmVzOwo+
ICAgCj4gLQlyZXQgPSBpOTE1X2dlbV9pbml0X2Vhcmx5KGRldl9wcml2KTsKPiArCXJldCA9IGk5
MTVfZ2VtX2luaXRfZWFybHkoaTkxNSk7Cj4gICAJaWYgKHJldCA8IDApCj4gICAJCWdvdG8gZXJy
X3dvcmtxdWV1ZXM7Cj4gICAKPiAgIAkvKiBUaGlzIG11c3QgYmUgY2FsbGVkIGJlZm9yZSBhbnkg
Y2FsbHMgdG8gSEFTX1BDSF8qICovCj4gLQlpbnRlbF9kZXRlY3RfcGNoKGRldl9wcml2KTsKPiAr
CWludGVsX2RldGVjdF9wY2goaTkxNSk7Cj4gICAKPiAtCWludGVsX3dvcGNtX2luaXRfZWFybHko
JmRldl9wcml2LT53b3BjbSk7Cj4gLQlpbnRlbF91Y19pbml0X2Vhcmx5KGRldl9wcml2KTsKPiAt
CWludGVsX3BtX3NldHVwKGRldl9wcml2KTsKPiAtCWludGVsX2luaXRfZHBpbyhkZXZfcHJpdik7
Cj4gLQlyZXQgPSBpbnRlbF9wb3dlcl9kb21haW5zX2luaXQoZGV2X3ByaXYpOwo+ICsJaW50ZWxf
d29wY21faW5pdF9lYXJseSgmaTkxNS0+d29wY20pOwo+ICsJaW50ZWxfdWNfaW5pdF9lYXJseShp
OTE1KTsKPiArCWludGVsX3BtX3NldHVwKGk5MTUpOwo+ICsJaW50ZWxfaW5pdF9kcGlvKGk5MTUp
Owo+ICsJcmV0ID0gaW50ZWxfcG93ZXJfZG9tYWluc19pbml0KGk5MTUpOwo+ICAgCWlmIChyZXQg
PCAwKQo+ICAgCQlnb3RvIGVycl91YzsKPiAtCWludGVsX2lycV9pbml0KGRldl9wcml2KTsKPiAt
CWludGVsX2hhbmdjaGVja19pbml0KGRldl9wcml2KTsKPiAtCWludGVsX2luaXRfZGlzcGxheV9o
b29rcyhkZXZfcHJpdik7Cj4gLQlpbnRlbF9pbml0X2Nsb2NrX2dhdGluZ19ob29rcyhkZXZfcHJp
dik7Cj4gLQlpbnRlbF9pbml0X2F1ZGlvX2hvb2tzKGRldl9wcml2KTsKPiAtCWludGVsX2Rpc3Bs
YXlfY3JjX2luaXQoZGV2X3ByaXYpOwo+ICsJaW50ZWxfaXJxX2luaXQoaTkxNSk7Cj4gKwlpbnRl
bF9oYW5nY2hlY2tfaW5pdChpOTE1KTsKPiArCWludGVsX2luaXRfZGlzcGxheV9ob29rcyhpOTE1
KTsKPiArCWludGVsX2luaXRfY2xvY2tfZ2F0aW5nX2hvb2tzKGk5MTUpOwo+ICsJaW50ZWxfaW5p
dF9hdWRpb19ob29rcyhpOTE1KTsKPiArCWludGVsX2Rpc3BsYXlfY3JjX2luaXQoaTkxNSk7Cj4g
ICAKPiAtCWludGVsX2RldGVjdF9wcmVwcm9kdWN0aW9uX2h3KGRldl9wcml2KTsKPiArCWludGVs
X2RldGVjdF9wcmVwcm9kdWN0aW9uX2h3KGk5MTUpOwo+ICAgCj4gICAJcmV0dXJuIDA7Cj4gICAK
PiAgIGVycl91YzoKPiAtCWludGVsX3VjX2NsZWFudXBfZWFybHkoZGV2X3ByaXYpOwo+IC0JaTkx
NV9nZW1fY2xlYW51cF9lYXJseShkZXZfcHJpdik7Cj4gKwlpbnRlbF91Y19jbGVhbnVwX2Vhcmx5
KGk5MTUpOwo+ICsJaTkxNV9nZW1fY2xlYW51cF9lYXJseShpOTE1KTsKPiAgIGVycl93b3JrcXVl
dWVzOgo+IC0JaTkxNV93b3JrcXVldWVzX2NsZWFudXAoZGV2X3ByaXYpOwo+ICsJaTkxNV93b3Jr
cXVldWVzX2NsZWFudXAoaTkxNSk7Cj4gICBlcnJfZW5naW5lczoKPiAtCWk5MTVfZW5naW5lc19j
bGVhbnVwKGRldl9wcml2KTsKPiArCWk5MTVfZW5naW5lc19jbGVhbnVwKGk5MTUpOwo+ICAgCXJl
dHVybiByZXQ7Cj4gICB9Cj4gICAKPiAgIC8qKgo+ICAgICogaTkxNV9kcml2ZXJfY2xlYW51cF9l
YXJseSAtIGNsZWFudXAgdGhlIHNldHVwIGRvbmUgaW4gaTkxNV9kcml2ZXJfaW5pdF9lYXJseSgp
Cj4gLSAqIEBkZXZfcHJpdjogZGV2aWNlIHByaXZhdGUKPiArICogQGk5MTU6IGRldmljZSBwcml2
YXRlCj4gICAgKi8KPiAtc3RhdGljIHZvaWQgaTkxNV9kcml2ZXJfY2xlYW51cF9lYXJseShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGk5MTVfZHJpdmVy
X2NsZWFudXBfZWFybHkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlp
bnRlbF9pcnFfZmluaShkZXZfcHJpdik7Cj4gLQlpbnRlbF9wb3dlcl9kb21haW5zX2NsZWFudXAo
ZGV2X3ByaXYpOwo+IC0JaW50ZWxfdWNfY2xlYW51cF9lYXJseShkZXZfcHJpdik7Cj4gLQlpOTE1
X2dlbV9jbGVhbnVwX2Vhcmx5KGRldl9wcml2KTsKPiAtCWk5MTVfd29ya3F1ZXVlc19jbGVhbnVw
KGRldl9wcml2KTsKPiAtCWk5MTVfZW5naW5lc19jbGVhbnVwKGRldl9wcml2KTsKPiArCWludGVs
X2lycV9maW5pKGk5MTUpOwo+ICsJaW50ZWxfcG93ZXJfZG9tYWluc19jbGVhbnVwKGk5MTUpOwo+
ICsJaW50ZWxfdWNfY2xlYW51cF9lYXJseShpOTE1KTsKPiArCWk5MTVfZ2VtX2NsZWFudXBfZWFy
bHkoaTkxNSk7Cj4gKwlpOTE1X3dvcmtxdWV1ZXNfY2xlYW51cChpOTE1KTsKPiArCWk5MTVfZW5n
aW5lc19jbGVhbnVwKGk5MTUpOwo+ICAgCj4gLQlwbV9xb3NfcmVtb3ZlX3JlcXVlc3QoJmRldl9w
cml2LT5zYl9xb3MpOwo+IC0JbXV0ZXhfZGVzdHJveSgmZGV2X3ByaXYtPnNiX2xvY2spOwo+ICsJ
cG1fcW9zX3JlbW92ZV9yZXF1ZXN0KCZpOTE1LT5zYl9xb3MpOwo+ICsJbXV0ZXhfZGVzdHJveSgm
aTkxNS0+c2JfbG9jayk7Cj4gICB9Cj4gICAKPiAgIC8qKgo+ICAgICogaTkxNV9kcml2ZXJfaW5p
dF9tbWlvIC0gc2V0dXAgZGV2aWNlIE1NSU8KPiAtICogQGRldl9wcml2OiBkZXZpY2UgcHJpdmF0
ZQo+ICsgKiBAaTkxNTogZGV2aWNlIHByaXZhdGUKPiAgICAqCj4gICAgKiBTZXR1cCBtaW5pbWFs
IGRldmljZSBzdGF0ZSBuZWNlc3NhcnkgZm9yIE1NSU8gYWNjZXNzZXMgbGF0ZXIgaW4gdGhlCj4g
ICAgKiBpbml0aWFsaXphdGlvbiBzZXF1ZW5jZS4gVGhlIHNldHVwIGhlcmUgc2hvdWxkIGF2b2lk
IGFueSBvdGhlciBkZXZpY2Utd2lkZQo+ICAgICogc2lkZSBlZmZlY3RzIG9yIGV4cG9zaW5nIHRo
ZSBkcml2ZXIgdmlhIGtlcm5lbCBpbnRlcm5hbCBvciB1c2VyIHNwYWNlCj4gICAgKiBpbnRlcmZh
Y2VzLgo+ICAgICovCj4gLXN0YXRpYyBpbnQgaTkxNV9kcml2ZXJfaW5pdF9tbWlvKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIGludCBpOTE1X2RyaXZlcl9pbml0
X21taW8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJaW50IHJldDsK
PiAgIAo+ICAgCWlmIChpOTE1X2luamVjdF9sb2FkX2ZhaWx1cmUoKSkKPiAgIAkJcmV0dXJuIC1F
Tk9ERVY7Cj4gICAKPiAtCWlmIChpOTE1X2dldF9icmlkZ2VfZGV2KGRldl9wcml2KSkKPiArCWlm
IChpOTE1X2dldF9icmlkZ2VfZGV2KGk5MTUpKQo+ICAgCQlyZXR1cm4gLUVJTzsKPiAgIAo+IC0J
cmV0ID0gaW50ZWxfdW5jb3JlX2luaXRfbW1pbygmZGV2X3ByaXYtPnVuY29yZSk7Cj4gKwlyZXQg
PSBpbnRlbF91bmNvcmVfaW5pdF9tbWlvKCZpOTE1LT51bmNvcmUpOwo+ICAgCWlmIChyZXQgPCAw
KQo+ICAgCQlnb3RvIGVycl9icmlkZ2U7Cj4gICAKPiAgIAkvKiBUcnkgdG8gbWFrZSBzdXJlIE1D
SEJBUiBpcyBlbmFibGVkIGJlZm9yZSBwb2tpbmcgYXQgaXQgKi8KPiAtCWludGVsX3NldHVwX21j
aGJhcihkZXZfcHJpdik7Cj4gKwlpbnRlbF9zZXR1cF9tY2hiYXIoaTkxNSk7Cj4gICAKPiAtCWlu
dGVsX2RldmljZV9pbmZvX2luaXRfbW1pbyhkZXZfcHJpdik7Cj4gKwlpbnRlbF9kZXZpY2VfaW5m
b19pbml0X21taW8oaTkxNSk7Cj4gICAKPiAtCWludGVsX3VuY29yZV9wcnVuZV9tbWlvX2RvbWFp
bnMoJmRldl9wcml2LT51bmNvcmUpOwo+ICsJaW50ZWxfdW5jb3JlX3BydW5lX21taW9fZG9tYWlu
cygmaTkxNS0+dW5jb3JlKTsKPiAgIAo+IC0JaW50ZWxfdWNfaW5pdF9tbWlvKGRldl9wcml2KTsK
PiArCWludGVsX3VjX2luaXRfbW1pbyhpOTE1KTsKPiAgIAo+IC0JcmV0ID0gaW50ZWxfZW5naW5l
c19pbml0X21taW8oZGV2X3ByaXYpOwo+ICsJcmV0ID0gaW50ZWxfZW5naW5lc19pbml0X21taW8o
aTkxNSk7Cj4gICAJaWYgKHJldCkKPiAgIAkJZ290byBlcnJfdW5jb3JlOwo+ICAgCj4gLQlpOTE1
X2dlbV9pbml0X21taW8oZGV2X3ByaXYpOwo+ICsJaTkxNV9nZW1faW5pdF9tbWlvKGk5MTUpOwo+
ICAgCj4gICAJcmV0dXJuIDA7Cj4gICAKPiAgIGVycl91bmNvcmU6Cj4gLQlpbnRlbF90ZWFyZG93
bl9tY2hiYXIoZGV2X3ByaXYpOwo+IC0JaW50ZWxfdW5jb3JlX2ZpbmlfbW1pbygmZGV2X3ByaXYt
PnVuY29yZSk7Cj4gKwlpbnRlbF90ZWFyZG93bl9tY2hiYXIoaTkxNSk7Cj4gKwlpbnRlbF91bmNv
cmVfZmluaV9tbWlvKCZpOTE1LT51bmNvcmUpOwo+ICAgZXJyX2JyaWRnZToKPiAtCXBjaV9kZXZf
cHV0KGRldl9wcml2LT5icmlkZ2VfZGV2KTsKPiArCXBjaV9kZXZfcHV0KGk5MTUtPmJyaWRnZV9k
ZXYpOwo+ICAgCj4gICAJcmV0dXJuIHJldDsKPiAgIH0KPiAgIAo+ICAgLyoqCj4gICAgKiBpOTE1
X2RyaXZlcl9jbGVhbnVwX21taW8gLSBjbGVhbnVwIHRoZSBzZXR1cCBkb25lIGluIGk5MTVfZHJp
dmVyX2luaXRfbW1pbygpCj4gLSAqIEBkZXZfcHJpdjogZGV2aWNlIHByaXZhdGUKPiArICogQGk5
MTU6IGRldmljZSBwcml2YXRlCj4gICAgKi8KPiAtc3RhdGljIHZvaWQgaTkxNV9kcml2ZXJfY2xl
YW51cF9tbWlvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZv
aWQgaTkxNV9kcml2ZXJfY2xlYW51cF9tbWlvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ICAgewo+IC0JaW50ZWxfdGVhcmRvd25fbWNoYmFyKGRldl9wcml2KTsKPiAtCWludGVsX3Vu
Y29yZV9maW5pX21taW8oJmRldl9wcml2LT51bmNvcmUpOwo+IC0JcGNpX2Rldl9wdXQoZGV2X3By
aXYtPmJyaWRnZV9kZXYpOwo+ICsJaW50ZWxfdGVhcmRvd25fbWNoYmFyKGk5MTUpOwo+ICsJaW50
ZWxfdW5jb3JlX2ZpbmlfbW1pbygmaTkxNS0+dW5jb3JlKTsKPiArCXBjaV9kZXZfcHV0KGk5MTUt
PmJyaWRnZV9kZXYpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGludGVsX3Nhbml0aXplX29w
dGlvbnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBp
bnRlbF9zYW5pdGl6ZV9vcHRpb25zKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAg
ewo+IC0JaW50ZWxfZ3Z0X3Nhbml0aXplX29wdGlvbnMoZGV2X3ByaXYpOwo+ICsJaW50ZWxfZ3Z0
X3Nhbml0aXplX29wdGlvbnMoaTkxNSk7Cj4gICB9Cj4gICAKPiAgICNkZWZpbmUgRFJBTV9UWVBF
X1NUUih0eXBlKSBbSU5URUxfRFJBTV8gIyMgdHlwZV0gPSAjdHlwZQo+IEBAIC0xMTMxLDExICsx
MTMxLDExIEBAIHNrbF9pc18xNmdiX2RpbW0oY29uc3Qgc3RydWN0IGRyYW1fZGltbV9pbmZvICpk
aW1tKQo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZAo+IC1za2xfZHJhbV9nZXRfZGltbV9pbmZv
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc2tsX2RyYW1fZ2V0X2RpbW1f
aW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJICAgICAgIHN0cnVjdCBk
cmFtX2RpbW1faW5mbyAqZGltbSwKPiAgIAkJICAgICAgIGludCBjaGFubmVsLCBjaGFyIGRpbW1f
bmFtZSwgdTE2IHZhbCkKPiAgIHsKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwKSB7
Cj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDEwKSB7Cj4gICAJCWRpbW0tPnNpemUgPSBjbmxf
Z2V0X2RpbW1fc2l6ZSh2YWwpOwo+ICAgCQlkaW1tLT53aWR0aCA9IGNubF9nZXRfZGltbV93aWR0
aCh2YWwpOwo+ICAgCQlkaW1tLT5yYW5rcyA9IGNubF9nZXRfZGltbV9yYW5rcyh2YWwpOwo+IEBA
IC0xMTUxLDEzICsxMTUxLDEzIEBAIHNrbF9kcmFtX2dldF9kaW1tX2luZm8oc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgfQo+ICAgCj4gICBzdGF0aWMgaW50Cj4gLXNrbF9k
cmFtX2dldF9jaGFubmVsX2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICtza2xfZHJhbV9nZXRfY2hhbm5lbF9pbmZvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAo+ICAgCQkJICBzdHJ1Y3QgZHJhbV9jaGFubmVsX2luZm8gKmNoLAo+ICAgCQkJICBpbnQgY2hh
bm5lbCwgdTMyIHZhbCkKPiAgIHsKPiAtCXNrbF9kcmFtX2dldF9kaW1tX2luZm8oZGV2X3ByaXYs
ICZjaC0+ZGltbV9sLAo+ICsJc2tsX2RyYW1fZ2V0X2RpbW1faW5mbyhpOTE1LCAmY2gtPmRpbW1f
bCwKPiAgIAkJCSAgICAgICBjaGFubmVsLCAnTCcsIHZhbCAmIDB4ZmZmZik7Cj4gLQlza2xfZHJh
bV9nZXRfZGltbV9pbmZvKGRldl9wcml2LCAmY2gtPmRpbW1fcywKPiArCXNrbF9kcmFtX2dldF9k
aW1tX2luZm8oaTkxNSwgJmNoLT5kaW1tX3MsCj4gICAJCQkgICAgICAgY2hhbm5lbCwgJ1MnLCB2
YWwgPj4gMTYpOwo+ICAgCj4gICAJaWYgKGNoLT5kaW1tX2wuc2l6ZSA9PSAwICYmIGNoLT5kaW1t
X3Muc2l6ZSA9PSAwKSB7Cj4gQEAgLTExOTIsMjAgKzExOTIsMjAgQEAgaW50ZWxfaXNfZHJhbV9z
eW1tZXRyaWMoY29uc3Qgc3RydWN0IGRyYW1fY2hhbm5lbF9pbmZvICpjaDAsCj4gICB9Cj4gICAK
PiAgIHN0YXRpYyBpbnQKPiAtc2tsX2RyYW1fZ2V0X2NoYW5uZWxzX2luZm8oc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtza2xfZHJhbV9nZXRfY2hhbm5lbHNfaW5mbyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVjdCBkcmFtX2luZm8gKmRy
YW1faW5mbyA9ICZkZXZfcHJpdi0+ZHJhbV9pbmZvOwo+ICsJc3RydWN0IGRyYW1faW5mbyAqZHJh
bV9pbmZvID0gJmk5MTUtPmRyYW1faW5mbzsKPiAgIAlzdHJ1Y3QgZHJhbV9jaGFubmVsX2luZm8g
Y2gwID0ge30sIGNoMSA9IHt9Owo+ICAgCXUzMiB2YWw7Cj4gICAJaW50IHJldDsKPiAgIAo+ICAg
CXZhbCA9IEk5MTVfUkVBRChTS0xfTUFEX0RJTU1fQ0gwXzBfMF8wX01DSEJBUl9NQ01BSU4pOwo+
IC0JcmV0ID0gc2tsX2RyYW1fZ2V0X2NoYW5uZWxfaW5mbyhkZXZfcHJpdiwgJmNoMCwgMCwgdmFs
KTsKPiArCXJldCA9IHNrbF9kcmFtX2dldF9jaGFubmVsX2luZm8oaTkxNSwgJmNoMCwgMCwgdmFs
KTsKPiAgIAlpZiAocmV0ID09IDApCj4gICAJCWRyYW1faW5mby0+bnVtX2NoYW5uZWxzKys7Cj4g
ICAKPiAgIAl2YWwgPSBJOTE1X1JFQUQoU0tMX01BRF9ESU1NX0NIMV8wXzBfMF9NQ0hCQVJfTUNN
QUlOKTsKPiAtCXJldCA9IHNrbF9kcmFtX2dldF9jaGFubmVsX2luZm8oZGV2X3ByaXYsICZjaDEs
IDEsIHZhbCk7Cj4gKwlyZXQgPSBza2xfZHJhbV9nZXRfY2hhbm5lbF9pbmZvKGk5MTUsICZjaDEs
IDEsIHZhbCk7Cj4gICAJaWYgKHJldCA9PSAwKQo+ICAgCQlkcmFtX2luZm8tPm51bV9jaGFubmVs
cysrOwo+ICAgCj4gQEAgLTEyMzksNyArMTIzOSw3IEBAIHNrbF9kcmFtX2dldF9jaGFubmVsc19p
bmZvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIH0KPiAgIAo+ICAgc3Rh
dGljIGVudW0gaW50ZWxfZHJhbV90eXBlCj4gLXNrbF9nZXRfZHJhbV90eXBlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc2tsX2dldF9kcmFtX3R5cGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJdTMyIHZhbDsKPiAgIAo+IEBAIC0xMjYxLDE2
ICsxMjYxLDE2IEBAIHNrbF9nZXRfZHJhbV90eXBlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGludAo+IC1za2xfZ2V0X2RyYW1faW5mbyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3NrbF9nZXRfZHJhbV9pbmZvKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RydWN0IGRyYW1faW5mbyAq
ZHJhbV9pbmZvID0gJmRldl9wcml2LT5kcmFtX2luZm87Cj4gKwlzdHJ1Y3QgZHJhbV9pbmZvICpk
cmFtX2luZm8gPSAmaTkxNS0+ZHJhbV9pbmZvOwo+ICAgCXUzMiBtZW1fZnJlcV9raHosIHZhbDsK
PiAgIAlpbnQgcmV0Owo+ICAgCj4gLQlkcmFtX2luZm8tPnR5cGUgPSBza2xfZ2V0X2RyYW1fdHlw
ZShkZXZfcHJpdik7Cj4gKwlkcmFtX2luZm8tPnR5cGUgPSBza2xfZ2V0X2RyYW1fdHlwZShpOTE1
KTsKPiAgIAlEUk1fREVCVUdfS01TKCJEUkFNIHR5cGU6ICVzXG4iLCBpbnRlbF9kcmFtX3R5cGVf
c3RyKGRyYW1faW5mby0+dHlwZSkpOwo+ICAgCj4gLQlyZXQgPSBza2xfZHJhbV9nZXRfY2hhbm5l
bHNfaW5mbyhkZXZfcHJpdik7Cj4gKwlyZXQgPSBza2xfZHJhbV9nZXRfY2hhbm5lbHNfaW5mbyhp
OTE1KTsKPiAgIAlpZiAocmV0KQo+ICAgCQlyZXR1cm4gcmV0Owo+ICAgCj4gQEAgLTEzNzAsOSAr
MTM3MCw5IEBAIHN0YXRpYyB2b2lkIGJ4dF9nZXRfZGltbV9pbmZvKHN0cnVjdCBkcmFtX2RpbW1f
aW5mbyAqZGltbSwKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGludAo+IC1ieHRfZ2V0X2RyYW1faW5m
byhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK2J4dF9nZXRfZHJhbV9pbmZv
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RydWN0IGRyYW1faW5m
byAqZHJhbV9pbmZvID0gJmRldl9wcml2LT5kcmFtX2luZm87Cj4gKwlzdHJ1Y3QgZHJhbV9pbmZv
ICpkcmFtX2luZm8gPSAmaTkxNS0+ZHJhbV9pbmZvOwo+ICAgCXUzMiBkcmFtX2NoYW5uZWxzOwo+
ICAgCXUzMiBtZW1fZnJlcV9raHosIHZhbDsKPiAgIAl1OCBudW1fYWN0aXZlX2NoYW5uZWxzOwo+
IEBAIC0xNDQzLDkgKzE0NDMsOSBAQCBieHRfZ2V0X2RyYW1faW5mbyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkCj4gLWludGVsX2dl
dF9kcmFtX2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtpbnRlbF9n
ZXRfZHJhbV9pbmZvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3Ry
dWN0IGRyYW1faW5mbyAqZHJhbV9pbmZvID0gJmRldl9wcml2LT5kcmFtX2luZm87Cj4gKwlzdHJ1
Y3QgZHJhbV9pbmZvICpkcmFtX2luZm8gPSAmaTkxNS0+ZHJhbV9pbmZvOwo+ICAgCWludCByZXQ7
Cj4gICAKPiAgIAkvKgo+IEBAIC0xNDUzLDE1ICsxNDUzLDE1IEBAIGludGVsX2dldF9kcmFtX2lu
Zm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCSAqIFRoaXMgaXMgb25s
eSB1c2VkIGZvciB0aGUgbGV2ZWwgMCB3YXRlcm1hcmsgbGF0ZW5jeQo+ICAgCSAqIHcvYSB3aGlj
aCBkb2VzIG5vdCBhcHBseSB0byBieHQvZ2xrLgo+ICAgCSAqLwo+IC0JZHJhbV9pbmZvLT5pc18x
NmdiX2RpbW0gPSAhSVNfR0VOOV9MUChkZXZfcHJpdik7Cj4gKwlkcmFtX2luZm8tPmlzXzE2Z2Jf
ZGltbSA9ICFJU19HRU45X0xQKGk5MTUpOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2
KSA8IDkpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgOSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4g
LQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCj4gLQkJcmV0ID0gYnh0X2dldF9kcmFtX2luZm8o
ZGV2X3ByaXYpOwo+ICsJaWYgKElTX0dFTjlfTFAoaTkxNSkpCj4gKwkJcmV0ID0gYnh0X2dldF9k
cmFtX2luZm8oaTkxNSk7Cj4gICAJZWxzZQo+IC0JCXJldCA9IHNrbF9nZXRfZHJhbV9pbmZvKGRl
dl9wcml2KTsKPiArCQlyZXQgPSBza2xfZ2V0X2RyYW1faW5mbyhpOTE1KTsKPiAgIAlpZiAocmV0
KQo+ICAgCQlyZXR1cm47Cj4gICAKPiBAQCAtMTQ3Myw3ICsxNDczLDcgQEAgaW50ZWxfZ2V0X2Ry
YW1faW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCSAgICAgIGRy
YW1faW5mby0+cmFua3MsIHllc25vKGRyYW1faW5mby0+aXNfMTZnYl9kaW1tKSk7Cj4gICB9Cj4g
ICAKPiAtc3RhdGljIHUzMiBnZW45X2VkcmFtX3NpemVfbWIoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LCB1MzIgY2FwKQo+ICtzdGF0aWMgdTMyIGdlbjlfZWRyYW1fc2l6ZV9tYihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIGNhcCkKPiAgIHsKPiAgIAljb25zdCB1
bnNpZ25lZCBpbnQgd2F5c1s4XSA9IHsgNCwgOCwgMTIsIDE2LCAxNiwgMTYsIDE2LCAxNiB9Owo+
ICAgCWNvbnN0IHVuc2lnbmVkIGludCBzZXRzWzRdID0geyAxLCAxLCAyLCAyIH07Cj4gQEAgLTE0
ODMsMTYgKzE0ODMsMTYgQEAgc3RhdGljIHUzMiBnZW45X2VkcmFtX3NpemVfbWIoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgY2FwKQo+ICAgCQlzZXRzW0VEUkFNX1NFVFNf
SURYKGNhcCldOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGVkcmFtX2RldGVjdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGVkcmFtX2RldGVjdChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAl1MzIgZWRyYW1fY2FwID0g
MDsKPiAgIAo+IC0JaWYgKCEoSVNfSEFTV0VMTChkZXZfcHJpdikgfHwKPiAtCSAgICAgIElTX0JS
T0FEV0VMTChkZXZfcHJpdikgfHwKPiAtCSAgICAgIElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkp
Cj4gKwlpZiAoIShJU19IQVNXRUxMKGk5MTUpIHx8Cj4gKwkgICAgICBJU19CUk9BRFdFTEwoaTkx
NSkgfHwKPiArCSAgICAgIElOVEVMX0dFTihpOTE1KSA+PSA5KSkKPiAgIAkJcmV0dXJuOwo+ICAg
Cj4gLQllZHJhbV9jYXAgPSBfX3Jhd191bmNvcmVfcmVhZDMyKCZkZXZfcHJpdi0+dW5jb3JlLCBI
U1dfRURSQU1fQ0FQKTsKPiArCWVkcmFtX2NhcCA9IF9fcmF3X3VuY29yZV9yZWFkMzIoJmk5MTUt
PnVuY29yZSwgSFNXX0VEUkFNX0NBUCk7Cj4gICAKPiAgIAkvKiBOQjogV2UgY2FuJ3Qgd3JpdGUg
SURJQ1IgeWV0IGJlY2F1c2Ugd2UgZG9uJ3QgaGF2ZSBndCBmdW5jcyBzZXQgdXAgKi8KPiAgIAo+
IEBAIC0xNTAzLDYzICsxNTAzLDYzIEBAIHN0YXRpYyB2b2lkIGVkcmFtX2RldGVjdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICogVGhlIG5lZWRlZCBjYXBhYmlsaXR5
IGJpdHMgZm9yIHNpemUgY2FsY3VsYXRpb24gYXJlIG5vdCB0aGVyZSB3aXRoCj4gICAJICogcHJl
IGdlbjkgc28gcmV0dXJuIDEyOE1CIGFsd2F5cy4KPiAgIAkgKi8KPiAtCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpIDwgOSkKPiAtCQlkZXZfcHJpdi0+ZWRyYW1fc2l6ZV9tYiA9IDEyODsKPiArCWlm
IChJTlRFTF9HRU4oaTkxNSkgPCA5KQo+ICsJCWk5MTUtPmVkcmFtX3NpemVfbWIgPSAxMjg7Cj4g
ICAJZWxzZQo+IC0JCWRldl9wcml2LT5lZHJhbV9zaXplX21iID0KPiAtCQkJZ2VuOV9lZHJhbV9z
aXplX21iKGRldl9wcml2LCBlZHJhbV9jYXApOwo+ICsJCWk5MTUtPmVkcmFtX3NpemVfbWIgPQo+
ICsJCQlnZW45X2VkcmFtX3NpemVfbWIoaTkxNSwgZWRyYW1fY2FwKTsKPiAgIAo+IC0JRFJNX0lO
Rk8oIkZvdW5kICV1TUIgb2YgZURSQU1cbiIsIGRldl9wcml2LT5lZHJhbV9zaXplX21iKTsKPiAr
CURSTV9JTkZPKCJGb3VuZCAldU1CIG9mIGVEUkFNXG4iLCBpOTE1LT5lZHJhbV9zaXplX21iKTsK
PiAgIH0KPiAgIAo+ICAgLyoqCj4gICAgKiBpOTE1X2RyaXZlcl9pbml0X2h3IC0gc2V0dXAgc3Rh
dGUgcmVxdWlyaW5nIGRldmljZSBhY2Nlc3MKPiAtICogQGRldl9wcml2OiBkZXZpY2UgcHJpdmF0
ZQo+ICsgKiBAaTkxNTogZGV2aWNlIHByaXZhdGUKPiAgICAqCj4gICAgKiBTZXR1cCBzdGF0ZSB0
aGF0IHJlcXVpcmVzIGFjY2Vzc2luZyB0aGUgZGV2aWNlLCBidXQgZG9lc24ndCByZXF1aXJlCj4g
ICAgKiBleHBvc2luZyB0aGUgZHJpdmVyIHZpYSBrZXJuZWwgaW50ZXJuYWwgb3IgdXNlcnNwYWNl
IGludGVyZmFjZXMuCj4gICAgKi8KPiAtc3RhdGljIGludCBpOTE1X2RyaXZlcl9pbml0X2h3KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIGludCBpOTE1X2RyaXZl
cl9pbml0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RydWN0
IHBjaV9kZXYgKnBkZXYgPSBkZXZfcHJpdi0+ZHJtLnBkZXY7Cj4gKwlzdHJ1Y3QgcGNpX2RldiAq
cGRldiA9IGk5MTUtPmRybS5wZGV2Owo+ICAgCWludCByZXQ7Cj4gICAKPiAgIAlpZiAoaTkxNV9p
bmplY3RfbG9hZF9mYWlsdXJlKCkpCj4gICAJCXJldHVybiAtRU5PREVWOwo+ICAgCj4gLQlpbnRl
bF9kZXZpY2VfaW5mb19ydW50aW1lX2luaXQoZGV2X3ByaXYpOwo+ICsJaW50ZWxfZGV2aWNlX2lu
Zm9fcnVudGltZV9pbml0KGk5MTUpOwo+ICAgCj4gLQlpZiAoSEFTX1BQR1RUKGRldl9wcml2KSkg
ewo+IC0JCWlmIChpbnRlbF92Z3B1X2FjdGl2ZShkZXZfcHJpdikgJiYKPiAtCQkgICAgIWludGVs
X3ZncHVfaGFzX2Z1bGxfcHBndHQoZGV2X3ByaXYpKSB7Cj4gLQkJCWk5MTVfcmVwb3J0X2Vycm9y
KGRldl9wcml2LAo+ICsJaWYgKEhBU19QUEdUVChpOTE1KSkgewo+ICsJCWlmIChpbnRlbF92Z3B1
X2FjdGl2ZShpOTE1KSAmJgo+ICsJCSAgICAhaW50ZWxfdmdwdV9oYXNfZnVsbF9wcGd0dChpOTE1
KSkgewo+ICsJCQlpOTE1X3JlcG9ydF9lcnJvcihpOTE1LAo+ICAgCQkJCQkgICJpbmNvbXBhdGli
bGUgdkdQVSBmb3VuZCwgc3VwcG9ydCBmb3IgaXNvbGF0ZWQgcHBHVFQgcmVxdWlyZWRcbiIpOwo+
ICAgCQkJcmV0dXJuIC1FTlhJTzsKPiAgIAkJfQo+ICAgCX0KPiAgIAo+IC0JaWYgKEhBU19FWEVD
TElTVFMoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSEFTX0VYRUNMSVNUUyhpOTE1KSkgewo+ICAgCQkv
Kgo+ICAgCQkgKiBPbGRlciBHVlQgZW11bGF0aW9uIGRlcGVuZHMgdXBvbiBpbnRlcmNlcHRpbmcg
Q1NCIG1taW8sCj4gICAJCSAqIHdoaWNoIHdlIG5vIGxvbmdlciB1c2UsIHByZWZlcnJpbmcgdG8g
dXNlIHRoZSBIV1NQIGNhY2hlCj4gICAJCSAqIGluc3RlYWQuCj4gICAJCSAqLwo+IC0JCWlmIChp
bnRlbF92Z3B1X2FjdGl2ZShkZXZfcHJpdikgJiYKPiAtCQkgICAgIWludGVsX3ZncHVfaGFzX2h3
c3BfZW11bGF0aW9uKGRldl9wcml2KSkgewo+IC0JCQlpOTE1X3JlcG9ydF9lcnJvcihkZXZfcHJp
diwKPiArCQlpZiAoaW50ZWxfdmdwdV9hY3RpdmUoaTkxNSkgJiYKPiArCQkgICAgIWludGVsX3Zn
cHVfaGFzX2h3c3BfZW11bGF0aW9uKGk5MTUpKSB7Cj4gKwkJCWk5MTVfcmVwb3J0X2Vycm9yKGk5
MTUsCj4gICAJCQkJCSAgIm9sZCB2R1BVIGhvc3QgZm91bmQsIHN1cHBvcnQgZm9yIEhXU1AgZW11
bGF0aW9uIHJlcXVpcmVkXG4iKTsKPiAgIAkJCXJldHVybiAtRU5YSU87Cj4gICAJCX0KPiAgIAl9
Cj4gICAKPiAtCWludGVsX3Nhbml0aXplX29wdGlvbnMoZGV2X3ByaXYpOwo+ICsJaW50ZWxfc2Fu
aXRpemVfb3B0aW9ucyhpOTE1KTsKPiAgIAo+ICAgCS8qIG5lZWRzIHRvIGJlIGRvbmUgYmVmb3Jl
IGdndHQgcHJvYmUgKi8KPiAtCWVkcmFtX2RldGVjdChkZXZfcHJpdik7Cj4gKwllZHJhbV9kZXRl
Y3QoaTkxNSk7Cj4gICAKPiAtCWk5MTVfcGVyZl9pbml0KGRldl9wcml2KTsKPiArCWk5MTVfcGVy
Zl9pbml0KGk5MTUpOwo+ICAgCj4gLQlyZXQgPSBpOTE1X2dndHRfcHJvYmVfaHcoZGV2X3ByaXYp
Owo+ICsJcmV0ID0gaTkxNV9nZ3R0X3Byb2JlX2h3KGk5MTUpOwo+ICAgCWlmIChyZXQpCj4gICAJ
CWdvdG8gZXJyX3BlcmY7Cj4gICAKPiBAQCAtMTU2Nyw3ICsxNTY3LDcgQEAgc3RhdGljIGludCBp
OTE1X2RyaXZlcl9pbml0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAg
IAkgKiBXQVJOSU5HOiBBcHBhcmVudGx5IHdlIG11c3Qga2ljayBmYmRldiBkcml2ZXJzIGJlZm9y
ZSB2Z2Fjb24sCj4gICAJICogb3RoZXJ3aXNlIHRoZSB2Z2EgZmJkZXYgZHJpdmVyIGZhbGxzIG92
ZXIuCj4gICAJICovCj4gLQlyZXQgPSBpOTE1X2tpY2tfb3V0X2Zpcm13YXJlX2ZiKGRldl9wcml2
KTsKPiArCXJldCA9IGk5MTVfa2lja19vdXRfZmlybXdhcmVfZmIoaTkxNSk7Cj4gICAJaWYgKHJl
dCkgewo+ICAgCQlEUk1fRVJST1IoImZhaWxlZCB0byByZW1vdmUgY29uZmxpY3RpbmcgZnJhbWVi
dWZmZXIgZHJpdmVyc1xuIik7Cj4gICAJCWdvdG8gZXJyX2dndHQ7Cj4gQEAgLTE1NzksMTEgKzE1
NzksMTEgQEAgc3RhdGljIGludCBpOTE1X2RyaXZlcl9pbml0X2h3KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiAgIAkJZ290byBlcnJfZ2d0dDsKPiAgIAl9Cj4gICAKPiAtCXJl
dCA9IGk5MTVfZ2d0dF9pbml0X2h3KGRldl9wcml2KTsKPiArCXJldCA9IGk5MTVfZ2d0dF9pbml0
X2h3KGk5MTUpOwo+ICAgCWlmIChyZXQpCj4gICAJCWdvdG8gZXJyX2dndHQ7Cj4gICAKPiAtCXJl
dCA9IGk5MTVfZ2d0dF9lbmFibGVfaHcoZGV2X3ByaXYpOwo+ICsJcmV0ID0gaTkxNV9nZ3R0X2Vu
YWJsZV9odyhpOTE1KTsKPiAgIAlpZiAocmV0KSB7Cj4gICAJCURSTV9FUlJPUigiZmFpbGVkIHRv
IGVuYWJsZSBHR1RUXG4iKTsKPiAgIAkJZ290byBlcnJfZ2d0dDsKPiBAQCAtMTU5Miw3ICsxNTky
LDcgQEAgc3RhdGljIGludCBpOTE1X2RyaXZlcl9pbml0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiAgIAlwY2lfc2V0X21hc3RlcihwZGV2KTsKPiAgIAo+ICAgCS8qIG92
ZXJsYXkgb24gZ2VuMiBpcyBicm9rZW4gYW5kIGNhbid0IGFkZHJlc3MgYWJvdmUgMUcgKi8KPiAt
CWlmIChJU19HRU4oZGV2X3ByaXYsIDIpKSB7Cj4gKwlpZiAoSVNfR0VOKGk5MTUsIDIpKSB7Cj4g
ICAJCXJldCA9IGRtYV9zZXRfY29oZXJlbnRfbWFzaygmcGRldi0+ZGV2LCBETUFfQklUX01BU0so
MzApKTsKPiAgIAkJaWYgKHJldCkgewo+ICAgCQkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gc2V0IERN
QSBtYXNrXG4iKTsKPiBAQCAtMTYwOSw3ICsxNjA5LDcgQEAgc3RhdGljIGludCBpOTE1X2RyaXZl
cl9pbml0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkgKiBiZWhh
dmlvdXIgaWYgYW55IGdlbmVyYWwgc3RhdGUgaXMgYWNjZXNzZWQgd2l0aGluIGEgcGFnZSBhYm92
ZSA0R0IsCj4gICAJICogd2hpY2ggYWxzbyBuZWVkcyB0byBiZSBoYW5kbGVkIGNhcmVmdWxseS4K
PiAgIAkgKi8KPiAtCWlmIChJU19JOTY1RyhkZXZfcHJpdikgfHwgSVNfSTk2NUdNKGRldl9wcml2
KSkgewo+ICsJaWYgKElTX0k5NjVHKGk5MTUpIHx8IElTX0k5NjVHTShpOTE1KSkgewo+ICAgCQly
ZXQgPSBkbWFfc2V0X2NvaGVyZW50X21hc2soJnBkZXYtPmRldiwgRE1BX0JJVF9NQVNLKDMyKSk7
Cj4gICAKPiAgIAkJaWYgKHJldCkgewo+IEBAIC0xNjE5LDEzICsxNjE5LDEzIEBAIHN0YXRpYyBp
bnQgaTkxNV9kcml2ZXJfaW5pdF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gICAJCX0KPiAgIAl9Cj4gICAKPiAtCXBtX3Fvc19hZGRfcmVxdWVzdCgmZGV2X3ByaXYtPnBt
X3FvcywgUE1fUU9TX0NQVV9ETUFfTEFURU5DWSwKPiArCXBtX3Fvc19hZGRfcmVxdWVzdCgmaTkx
NS0+cG1fcW9zLCBQTV9RT1NfQ1BVX0RNQV9MQVRFTkNZLAo+ICAgCQkJICAgUE1fUU9TX0RFRkFV
TFRfVkFMVUUpOwo+ICAgCj4gLQlpbnRlbF91bmNvcmVfc2FuaXRpemUoZGV2X3ByaXYpOwo+ICsJ
aW50ZWxfdW5jb3JlX3Nhbml0aXplKGk5MTUpOwo+ICAgCj4gLQlpbnRlbF9ndF9pbml0X3dvcmth
cm91bmRzKGRldl9wcml2KTsKPiAtCWk5MTVfZ2VtX2xvYWRfaW5pdF9mZW5jZXMoZGV2X3ByaXYp
Owo+ICsJaW50ZWxfZ3RfaW5pdF93b3JrYXJvdW5kcyhpOTE1KTsKPiArCWk5MTVfZ2VtX2xvYWRf
aW5pdF9mZW5jZXMoaTkxNSk7Cj4gICAKPiAgIAkvKiBPbiB0aGUgOTQ1Ry9HTSwgdGhlIGNoaXBz
ZXQgcmVwb3J0cyB0aGUgTVNJIGNhcGFiaWxpdHkgb24gdGhlCj4gICAJICogaW50ZWdyYXRlZCBn
cmFwaGljcyBldmVuIHRob3VnaCB0aGUgc3VwcG9ydCBpc24ndCBhY3R1YWxseSB0aGVyZQo+IEBA
IC0xNjQ2LDk0ICsxNjQ2LDk0IEBAIHN0YXRpYyBpbnQgaTkxNV9kcml2ZXJfaW5pdF9odyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICogZGV2aWNlLiBUaGUga2VybmVs
IHRoZW4gZGlzYWJsZXMgdGhhdCBpbnRlcnJ1cHQgc291cmNlIGFuZCBzbwo+ICAgCSAqIHByZXZl
bnRzIHRoZSBvdGhlciBkZXZpY2UgZnJvbSB3b3JraW5nIHByb3Blcmx5Lgo+ICAgCSAqLwo+IC0J
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNSkgewo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+
PSA1KSB7Cj4gICAJCWlmIChwY2lfZW5hYmxlX21zaShwZGV2KSA8IDApCj4gICAJCQlEUk1fREVC
VUdfRFJJVkVSKCJjYW4ndCBlbmFibGUgTVNJIik7Cj4gICAJfQo+ICAgCj4gLQlyZXQgPSBpbnRl
bF9ndnRfaW5pdChkZXZfcHJpdik7Cj4gKwlyZXQgPSBpbnRlbF9ndnRfaW5pdChpOTE1KTsKPiAg
IAlpZiAocmV0KQo+ICAgCQlnb3RvIGVycl9tc2k7Cj4gICAKPiAtCWludGVsX29wcmVnaW9uX3Nl
dHVwKGRldl9wcml2KTsKPiArCWludGVsX29wcmVnaW9uX3NldHVwKGk5MTUpOwo+ICAgCS8qCj4g
ICAJICogRmlsbCB0aGUgZHJhbSBzdHJ1Y3R1cmUgdG8gZ2V0IHRoZSBzeXN0ZW0gcmF3IGJhbmR3
aWR0aCBhbmQKPiAgIAkgKiBkcmFtIGluZm8uIFRoaXMgd2lsbCBiZSB1c2VkIGZvciBtZW1vcnkg
bGF0ZW5jeSBjYWxjdWxhdGlvbi4KPiAgIAkgKi8KPiAtCWludGVsX2dldF9kcmFtX2luZm8oZGV2
X3ByaXYpOwo+ICsJaW50ZWxfZ2V0X2RyYW1faW5mbyhpOTE1KTsKPiAgIAo+IC0JaW50ZWxfYndf
aW5pdF9odyhkZXZfcHJpdik7Cj4gKwlpbnRlbF9id19pbml0X2h3KGk5MTUpOwo+ICAgCj4gICAJ
cmV0dXJuIDA7Cj4gICAKPiAgIGVycl9tc2k6Cj4gICAJaWYgKHBkZXYtPm1zaV9lbmFibGVkKQo+
ICAgCQlwY2lfZGlzYWJsZV9tc2kocGRldik7Cj4gLQlwbV9xb3NfcmVtb3ZlX3JlcXVlc3QoJmRl
dl9wcml2LT5wbV9xb3MpOwo+ICsJcG1fcW9zX3JlbW92ZV9yZXF1ZXN0KCZpOTE1LT5wbV9xb3Mp
Owo+ICAgZXJyX2dndHQ6Cj4gLQlpOTE1X2dndHRfY2xlYW51cF9odyhkZXZfcHJpdik7Cj4gKwlp
OTE1X2dndHRfY2xlYW51cF9odyhpOTE1KTsKPiAgIGVycl9wZXJmOgo+IC0JaTkxNV9wZXJmX2Zp
bmkoZGV2X3ByaXYpOwo+ICsJaTkxNV9wZXJmX2ZpbmkoaTkxNSk7Cj4gICAJcmV0dXJuIHJldDsK
PiAgIH0KPiAgIAo+ICAgLyoqCj4gICAgKiBpOTE1X2RyaXZlcl9jbGVhbnVwX2h3IC0gY2xlYW51
cCB0aGUgc2V0dXAgZG9uZSBpbiBpOTE1X2RyaXZlcl9pbml0X2h3KCkKPiAtICogQGRldl9wcml2
OiBkZXZpY2UgcHJpdmF0ZQo+ICsgKiBAaTkxNTogZGV2aWNlIHByaXZhdGUKPiAgICAqLwo+IC1z
dGF0aWMgdm9pZCBpOTE1X2RyaXZlcl9jbGVhbnVwX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaTkxNV9kcml2ZXJfY2xlYW51cF9odyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0g
ZGV2X3ByaXYtPmRybS5wZGV2Owo+ICsJc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBpOTE1LT5kcm0u
cGRldjsKPiAgIAo+IC0JaTkxNV9wZXJmX2ZpbmkoZGV2X3ByaXYpOwo+ICsJaTkxNV9wZXJmX2Zp
bmkoaTkxNSk7Cj4gICAKPiAgIAlpZiAocGRldi0+bXNpX2VuYWJsZWQpCj4gICAJCXBjaV9kaXNh
YmxlX21zaShwZGV2KTsKPiAgIAo+IC0JcG1fcW9zX3JlbW92ZV9yZXF1ZXN0KCZkZXZfcHJpdi0+
cG1fcW9zKTsKPiArCXBtX3Fvc19yZW1vdmVfcmVxdWVzdCgmaTkxNS0+cG1fcW9zKTsKPiAgIH0K
PiAgIAo+ICAgLyoqCj4gICAgKiBpOTE1X2RyaXZlcl9yZWdpc3RlciAtIHJlZ2lzdGVyIHRoZSBk
cml2ZXIgd2l0aCB0aGUgcmVzdCBvZiB0aGUgc3lzdGVtCj4gLSAqIEBkZXZfcHJpdjogZGV2aWNl
IHByaXZhdGUKPiArICogQGk5MTU6IGRldmljZSBwcml2YXRlCj4gICAgKgo+ICAgICogUGVyZm9y
bSBhbnkgc3RlcHMgbmVjZXNzYXJ5IHRvIG1ha2UgdGhlIGRyaXZlciBhdmFpbGFibGUgdmlhIGtl
cm5lbAo+ICAgICogaW50ZXJuYWwgb3IgdXNlcnNwYWNlIGludGVyZmFjZXMuCj4gICAgKi8KPiAt
c3RhdGljIHZvaWQgaTkxNV9kcml2ZXJfcmVnaXN0ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBpOTE1X2RyaXZlcl9yZWdpc3RlcihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAm
ZGV2X3ByaXYtPmRybTsKPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+
ICAgCj4gLQlpOTE1X2dlbV9zaHJpbmtlcl9yZWdpc3RlcihkZXZfcHJpdik7Cj4gLQlpOTE1X3Bt
dV9yZWdpc3RlcihkZXZfcHJpdik7Cj4gKwlpOTE1X2dlbV9zaHJpbmtlcl9yZWdpc3RlcihpOTE1
KTsKPiArCWk5MTVfcG11X3JlZ2lzdGVyKGk5MTUpOwo+ICAgCj4gICAJLyoKPiAgIAkgKiBOb3Rp
ZnkgYSB2YWxpZCBzdXJmYWNlIGFmdGVyIG1vZGVzZXR0aW5nLAo+ICAgCSAqIHdoZW4gcnVubmlu
ZyBpbnNpZGUgYSBWTS4KPiAgIAkgKi8KPiAtCWlmIChpbnRlbF92Z3B1X2FjdGl2ZShkZXZfcHJp
dikpCj4gKwlpZiAoaW50ZWxfdmdwdV9hY3RpdmUoaTkxNSkpCj4gICAJCUk5MTVfV1JJVEUodmd0
aWZfcmVnKGRpc3BsYXlfcmVhZHkpLCBWR1RfRFJWX0RJU1BMQVlfUkVBRFkpOwo+ICAgCj4gICAJ
LyogUmV2ZWFsIG91ciBwcmVzZW5jZSB0byB1c2Vyc3BhY2UgKi8KPiAgIAlpZiAoZHJtX2Rldl9y
ZWdpc3RlcihkZXYsIDApID09IDApIHsKPiAtCQlpOTE1X2RlYnVnZnNfcmVnaXN0ZXIoZGV2X3By
aXYpOwo+IC0JCWk5MTVfc2V0dXBfc3lzZnMoZGV2X3ByaXYpOwo+ICsJCWk5MTVfZGVidWdmc19y
ZWdpc3RlcihpOTE1KTsKPiArCQlpOTE1X3NldHVwX3N5c2ZzKGk5MTUpOwo+ICAgCj4gICAJCS8q
IERlcGVuZHMgb24gc3lzZnMgaGF2aW5nIGJlZW4gaW5pdGlhbGl6ZWQgKi8KPiAtCQlpOTE1X3Bl
cmZfcmVnaXN0ZXIoZGV2X3ByaXYpOwo+ICsJCWk5MTVfcGVyZl9yZWdpc3RlcihpOTE1KTsKPiAg
IAl9IGVsc2UKPiAgIAkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gcmVnaXN0ZXIgZHJpdmVyIGZvciB1
c2Vyc3BhY2UgYWNjZXNzIVxuIik7Cj4gICAKPiAtCWlmIChIQVNfRElTUExBWShkZXZfcHJpdikp
IHsKPiArCWlmIChIQVNfRElTUExBWShpOTE1KSkgewo+ICAgCQkvKiBNdXN0IGJlIGRvbmUgYWZ0
ZXIgcHJvYmluZyBvdXRwdXRzICovCj4gLQkJaW50ZWxfb3ByZWdpb25fcmVnaXN0ZXIoZGV2X3By
aXYpOwo+ICsJCWludGVsX29wcmVnaW9uX3JlZ2lzdGVyKGk5MTUpOwo+ICAgCQlhY3BpX3ZpZGVv
X3JlZ2lzdGVyKCk7Cj4gICAJfQo+ICAgCj4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCA1KSkKPiAt
CQlpbnRlbF9ncHVfaXBzX2luaXQoZGV2X3ByaXYpOwo+ICsJaWYgKElTX0dFTihpOTE1LCA1KSkK
PiArCQlpbnRlbF9ncHVfaXBzX2luaXQoaTkxNSk7Cj4gICAKPiAtCWludGVsX2F1ZGlvX2luaXQo
ZGV2X3ByaXYpOwo+ICsJaW50ZWxfYXVkaW9faW5pdChpOTE1KTsKPiAgIAo+ICAgCS8qCj4gICAJ
ICogU29tZSBwb3J0cyByZXF1aXJlIGNvcnJlY3RseSBzZXQtdXAgaHBkIHJlZ2lzdGVycyBmb3Ig
ZGV0ZWN0aW9uIHRvCj4gQEAgLTE3NDgsNjAgKzE3NDgsNjAgQEAgc3RhdGljIHZvaWQgaTkxNV9k
cml2ZXJfcmVnaXN0ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCSAq
IFdlIG5lZWQgdG8gY29vcmRpbmF0ZSB0aGUgaG90cGx1Z3Mgd2l0aCB0aGUgYXN5bmNocm9ub3Vz
IGZiZGV2Cj4gICAJICogY29uZmlndXJhdGlvbiwgZm9yIHdoaWNoIHdlIHVzZSB0aGUgZmJkZXYt
PmFzeW5jX2Nvb2tpZS4KPiAgIAkgKi8KPiAtCWlmIChIQVNfRElTUExBWShkZXZfcHJpdikpCj4g
KwlpZiAoSEFTX0RJU1BMQVkoaTkxNSkpCj4gICAJCWRybV9rbXNfaGVscGVyX3BvbGxfaW5pdChk
ZXYpOwo+ICAgCj4gLQlpbnRlbF9wb3dlcl9kb21haW5zX2VuYWJsZShkZXZfcHJpdik7Cj4gLQlp
bnRlbF9ydW50aW1lX3BtX2VuYWJsZShkZXZfcHJpdik7Cj4gKwlpbnRlbF9wb3dlcl9kb21haW5z
X2VuYWJsZShpOTE1KTsKPiArCWludGVsX3J1bnRpbWVfcG1fZW5hYmxlKGk5MTUpOwo+ICAgfQo+
ICAgCj4gICAvKioKPiAgICAqIGk5MTVfZHJpdmVyX3VucmVnaXN0ZXIgLSBjbGVhbnVwIHRoZSBy
ZWdpc3RyYXRpb24gZG9uZSBpbiBpOTE1X2RyaXZlcl9yZWdpc2VyKCkKPiAtICogQGRldl9wcml2
OiBkZXZpY2UgcHJpdmF0ZQo+ICsgKiBAaTkxNTogZGV2aWNlIHByaXZhdGUKPiAgICAqLwo+IC1z
dGF0aWMgdm9pZCBpOTE1X2RyaXZlcl91bnJlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaTkxNV9kcml2ZXJfdW5yZWdpc3RlcihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCWludGVsX3J1bnRpbWVfcG1fZGlzYWJs
ZShkZXZfcHJpdik7Cj4gLQlpbnRlbF9wb3dlcl9kb21haW5zX2Rpc2FibGUoZGV2X3ByaXYpOwo+
ICsJaW50ZWxfcnVudGltZV9wbV9kaXNhYmxlKGk5MTUpOwo+ICsJaW50ZWxfcG93ZXJfZG9tYWlu
c19kaXNhYmxlKGk5MTUpOwo+ICAgCj4gLQlpbnRlbF9mYmRldl91bnJlZ2lzdGVyKGRldl9wcml2
KTsKPiAtCWludGVsX2F1ZGlvX2RlaW5pdChkZXZfcHJpdik7Cj4gKwlpbnRlbF9mYmRldl91bnJl
Z2lzdGVyKGk5MTUpOwo+ICsJaW50ZWxfYXVkaW9fZGVpbml0KGk5MTUpOwo+ICAgCj4gICAJLyoK
PiAgIAkgKiBBZnRlciBmbHVzaGluZyB0aGUgZmJkZXYgKGluY2wuIGEgbGF0ZSBhc3luYyBjb25m
aWcgd2hpY2ggd2lsbAo+ICAgCSAqIGhhdmUgZGVsYXllZCBxdWV1aW5nIG9mIGEgaG90cGx1ZyBl
dmVudCksIHRoZW4gZmx1c2ggdGhlIGhvdHBsdWcKPiAgIAkgKiBldmVudHMuCj4gICAJICovCj4g
LQlkcm1fa21zX2hlbHBlcl9wb2xsX2ZpbmkoJmRldl9wcml2LT5kcm0pOwo+ICsJZHJtX2ttc19o
ZWxwZXJfcG9sbF9maW5pKCZpOTE1LT5kcm0pOwo+ICAgCj4gICAJaW50ZWxfZ3B1X2lwc190ZWFy
ZG93bigpOwo+ICAgCWFjcGlfdmlkZW9fdW5yZWdpc3RlcigpOwo+IC0JaW50ZWxfb3ByZWdpb25f
dW5yZWdpc3RlcihkZXZfcHJpdik7Cj4gKwlpbnRlbF9vcHJlZ2lvbl91bnJlZ2lzdGVyKGk5MTUp
Owo+ICAgCj4gLQlpOTE1X3BlcmZfdW5yZWdpc3RlcihkZXZfcHJpdik7Cj4gLQlpOTE1X3BtdV91
bnJlZ2lzdGVyKGRldl9wcml2KTsKPiArCWk5MTVfcGVyZl91bnJlZ2lzdGVyKGk5MTUpOwo+ICsJ
aTkxNV9wbXVfdW5yZWdpc3RlcihpOTE1KTsKPiAgIAo+IC0JaTkxNV90ZWFyZG93bl9zeXNmcyhk
ZXZfcHJpdik7Cj4gLQlkcm1fZGV2X3VucGx1ZygmZGV2X3ByaXYtPmRybSk7Cj4gKwlpOTE1X3Rl
YXJkb3duX3N5c2ZzKGk5MTUpOwo+ICsJZHJtX2Rldl91bnBsdWcoJmk5MTUtPmRybSk7Cj4gICAK
PiAtCWk5MTVfZ2VtX3Nocmlua2VyX3VucmVnaXN0ZXIoZGV2X3ByaXYpOwo+ICsJaTkxNV9nZW1f
c2hyaW5rZXJfdW5yZWdpc3RlcihpOTE1KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpOTE1
X3dlbGNvbWVfbWVzc2FnZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtz
dGF0aWMgdm9pZCBpOTE1X3dlbGNvbWVfbWVzc2FnZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCj4gICB7Cj4gICAJaWYgKGRybV9kZWJ1ZyAmIERSTV9VVF9EUklWRVIpIHsKPiAgIAkJ
c3RydWN0IGRybV9wcmludGVyIHAgPSBkcm1fZGVidWdfcHJpbnRlcigiaTkxNSBkZXZpY2UgaW5m
bzoiKTsKPiAgIAo+ICAgCQlkcm1fcHJpbnRmKCZwLCAicGNpaWQ9MHglMDR4IHJldj0weCUwMngg
cGxhdGZvcm09JXMgKHN1YnBsYXRmb3JtPTB4JXgpIGdlbj0laVxuIiwKPiAtCQkJICAgSU5URUxf
REVWSUQoZGV2X3ByaXYpLAo+IC0JCQkgICBJTlRFTF9SRVZJRChkZXZfcHJpdiksCj4gLQkJCSAg
IGludGVsX3BsYXRmb3JtX25hbWUoSU5URUxfSU5GTyhkZXZfcHJpdiktPnBsYXRmb3JtKSwKPiAt
CQkJICAgaW50ZWxfc3VicGxhdGZvcm0oUlVOVElNRV9JTkZPKGRldl9wcml2KSwKPiAtCQkJCQkg
ICAgIElOVEVMX0lORk8oZGV2X3ByaXYpLT5wbGF0Zm9ybSksCj4gLQkJCSAgIElOVEVMX0dFTihk
ZXZfcHJpdikpOwo+IC0KPiAtCQlpbnRlbF9kZXZpY2VfaW5mb19kdW1wX2ZsYWdzKElOVEVMX0lO
Rk8oZGV2X3ByaXYpLCAmcCk7Cj4gLQkJaW50ZWxfZGV2aWNlX2luZm9fZHVtcF9ydW50aW1lKFJV
TlRJTUVfSU5GTyhkZXZfcHJpdiksICZwKTsKPiArCQkJICAgSU5URUxfREVWSUQoaTkxNSksCj4g
KwkJCSAgIElOVEVMX1JFVklEKGk5MTUpLAo+ICsJCQkgICBpbnRlbF9wbGF0Zm9ybV9uYW1lKElO
VEVMX0lORk8oaTkxNSktPnBsYXRmb3JtKSwKPiArCQkJICAgaW50ZWxfc3VicGxhdGZvcm0oUlVO
VElNRV9JTkZPKGk5MTUpLAo+ICsJCQkJCSAgICAgSU5URUxfSU5GTyhpOTE1KS0+cGxhdGZvcm0p
LAo+ICsJCQkgICBJTlRFTF9HRU4oaTkxNSkpOwo+ICsKPiArCQlpbnRlbF9kZXZpY2VfaW5mb19k
dW1wX2ZsYWdzKElOVEVMX0lORk8oaTkxNSksICZwKTsKPiArCQlpbnRlbF9kZXZpY2VfaW5mb19k
dW1wX3J1bnRpbWUoUlVOVElNRV9JTkZPKGk5MTUpLCAmcCk7Cj4gICAJfQo+ICAgCj4gICAJaWYg
KElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X0RFQlVHKSkKPiBAQCAtMTg3MSwxMjYgKzE4NzEs
MTI2IEBAIGludCBpOTE1X2RyaXZlcl9sb2FkKHN0cnVjdCBwY2lfZGV2ICpwZGV2LCBjb25zdCBz
dHJ1Y3QgcGNpX2RldmljZV9pZCAqZW50KQo+ICAgewo+ICAgCWNvbnN0IHN0cnVjdCBpbnRlbF9k
ZXZpY2VfaW5mbyAqbWF0Y2hfaW5mbyA9Cj4gICAJCShzdHJ1Y3QgaW50ZWxfZGV2aWNlX2luZm8g
KillbnQtPmRyaXZlcl9kYXRhOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTU7Cj4gICAJaW50IHJldDsKPiAgIAo+
IC0JZGV2X3ByaXYgPSBpOTE1X2RyaXZlcl9jcmVhdGUocGRldiwgZW50KTsKPiAtCWlmIChJU19F
UlIoZGV2X3ByaXYpKQo+IC0JCXJldHVybiBQVFJfRVJSKGRldl9wcml2KTsKPiArCWk5MTUgPSBp
OTE1X2RyaXZlcl9jcmVhdGUocGRldiwgZW50KTsKPiArCWlmIChJU19FUlIoaTkxNSkpCj4gKwkJ
cmV0dXJuIFBUUl9FUlIoaTkxNSk7Cj4gICAKPiAgIAkvKiBEaXNhYmxlIG51Y2xlYXIgcGFnZWZs
aXAgYnkgZGVmYXVsdCBvbiBwcmUtSUxLICovCj4gICAJaWYgKCFpOTE1X21vZHBhcmFtcy5udWNs
ZWFyX3BhZ2VmbGlwICYmIG1hdGNoX2luZm8tPmdlbiA8IDUpCj4gLQkJZGV2X3ByaXYtPmRybS5k
cml2ZXJfZmVhdHVyZXMgJj0gfkRSSVZFUl9BVE9NSUM7Cj4gKwkJaTkxNS0+ZHJtLmRyaXZlcl9m
ZWF0dXJlcyAmPSB+RFJJVkVSX0FUT01JQzsKPiAgIAo+ICAgCXJldCA9IHBjaV9lbmFibGVfZGV2
aWNlKHBkZXYpOwo+ICAgCWlmIChyZXQpCj4gICAJCWdvdG8gb3V0X2Zpbmk7Cj4gICAKPiAtCXJl
dCA9IGk5MTVfZHJpdmVyX2luaXRfZWFybHkoZGV2X3ByaXYpOwo+ICsJcmV0ID0gaTkxNV9kcml2
ZXJfaW5pdF9lYXJseShpOTE1KTsKPiAgIAlpZiAocmV0IDwgMCkKPiAgIAkJZ290byBvdXRfcGNp
X2Rpc2FibGU7Cj4gICAKPiAtCWRpc2FibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7
Cj4gKwlkaXNhYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoaTkxNSk7Cj4gICAKPiAtCXJldCA9IGk5
MTVfZHJpdmVyX2luaXRfbW1pbyhkZXZfcHJpdik7Cj4gKwlyZXQgPSBpOTE1X2RyaXZlcl9pbml0
X21taW8oaTkxNSk7Cj4gICAJaWYgKHJldCA8IDApCj4gICAJCWdvdG8gb3V0X3J1bnRpbWVfcG1f
cHV0Owo+ICAgCj4gLQlyZXQgPSBpOTE1X2RyaXZlcl9pbml0X2h3KGRldl9wcml2KTsKPiArCXJl
dCA9IGk5MTVfZHJpdmVyX2luaXRfaHcoaTkxNSk7Cj4gICAJaWYgKHJldCA8IDApCj4gICAJCWdv
dG8gb3V0X2NsZWFudXBfbW1pbzsKPiAgIAo+IC0JcmV0ID0gaTkxNV9sb2FkX21vZGVzZXRfaW5p
dCgmZGV2X3ByaXYtPmRybSk7Cj4gKwlyZXQgPSBpOTE1X2xvYWRfbW9kZXNldF9pbml0KCZpOTE1
LT5kcm0pOwo+ICAgCWlmIChyZXQgPCAwKQo+ICAgCQlnb3RvIG91dF9jbGVhbnVwX2h3Owo+ICAg
Cj4gLQlpOTE1X2RyaXZlcl9yZWdpc3RlcihkZXZfcHJpdik7Cj4gKwlpOTE1X2RyaXZlcl9yZWdp
c3RlcihpOTE1KTsKPiAgIAo+IC0JZW5hYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoZGV2X3ByaXYp
Owo+ICsJZW5hYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoaTkxNSk7Cj4gICAKPiAtCWk5MTVfd2Vs
Y29tZV9tZXNzYWdlcyhkZXZfcHJpdik7Cj4gKwlpOTE1X3dlbGNvbWVfbWVzc2FnZXMoaTkxNSk7
Cj4gICAKPiAgIAlyZXR1cm4gMDsKPiAgIAo+ICAgb3V0X2NsZWFudXBfaHc6Cj4gLQlpOTE1X2Ry
aXZlcl9jbGVhbnVwX2h3KGRldl9wcml2KTsKPiAtCWk5MTVfZ2d0dF9jbGVhbnVwX2h3KGRldl9w
cml2KTsKPiArCWk5MTVfZHJpdmVyX2NsZWFudXBfaHcoaTkxNSk7Cj4gKwlpOTE1X2dndHRfY2xl
YW51cF9odyhpOTE1KTsKPiAgIG91dF9jbGVhbnVwX21taW86Cj4gLQlpOTE1X2RyaXZlcl9jbGVh
bnVwX21taW8oZGV2X3ByaXYpOwo+ICsJaTkxNV9kcml2ZXJfY2xlYW51cF9tbWlvKGk5MTUpOwo+
ICAgb3V0X3J1bnRpbWVfcG1fcHV0Ogo+IC0JZW5hYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoZGV2
X3ByaXYpOwo+IC0JaTkxNV9kcml2ZXJfY2xlYW51cF9lYXJseShkZXZfcHJpdik7Cj4gKwllbmFi
bGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhpOTE1KTsKPiArCWk5MTVfZHJpdmVyX2NsZWFudXBfZWFy
bHkoaTkxNSk7Cj4gICBvdXRfcGNpX2Rpc2FibGU6Cj4gICAJcGNpX2Rpc2FibGVfZGV2aWNlKHBk
ZXYpOwo+ICAgb3V0X2Zpbmk6Cj4gLQlpOTE1X2xvYWRfZXJyb3IoZGV2X3ByaXYsICJEZXZpY2Ug
aW5pdGlhbGl6YXRpb24gZmFpbGVkICglZClcbiIsIHJldCk7Cj4gLQlpOTE1X2RyaXZlcl9kZXN0
cm95KGRldl9wcml2KTsKPiArCWk5MTVfbG9hZF9lcnJvcihpOTE1LCAiRGV2aWNlIGluaXRpYWxp
emF0aW9uIGZhaWxlZCAoJWQpXG4iLCByZXQpOwo+ICsJaTkxNV9kcml2ZXJfZGVzdHJveShpOTE1
KTsKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+ICAgCj4gICB2b2lkIGk5MTVfZHJpdmVyX3VubG9h
ZChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+IC0Jc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBk
ZXZfcHJpdi0+ZHJtLnBkZXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoZGV2KTsKPiArCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gaTkxNS0+ZHJtLnBkZXY7Cj4g
ICAKPiAtCWRpc2FibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7Cj4gKwlkaXNhYmxl
X3JwbV93YWtlcmVmX2Fzc2VydHMoaTkxNSk7Cj4gICAKPiAtCWk5MTVfZHJpdmVyX3VucmVnaXN0
ZXIoZGV2X3ByaXYpOwo+ICsJaTkxNV9kcml2ZXJfdW5yZWdpc3RlcihpOTE1KTsKPiAgIAo+ICAg
CS8qCj4gICAJICogQWZ0ZXIgdW5yZWdpc3RlcmluZyB0aGUgZGV2aWNlIHRvIHByZXZlbnQgYW55
IG5ldyB1c2VycywgY2FuY2VsCj4gICAJICogYWxsIGluLWZsaWdodCByZXF1ZXN0cyBzbyB0aGF0
IHdlIGNhbiBxdWlja2x5IHVuYmluZCB0aGUgYWN0aXZlCj4gICAJICogcmVzb3VyY2VzLgo+ICAg
CSAqLwo+IC0JaTkxNV9nZW1fc2V0X3dlZGdlZChkZXZfcHJpdik7Cj4gKwlpOTE1X2dlbV9zZXRf
d2VkZ2VkKGk5MTUpOwo+ICAgCj4gICAJLyogRmx1c2ggYW55IGV4dGVybmFsIGNvZGUgdGhhdCBz
dGlsbCBtYXkgYmUgdW5kZXIgdGhlIFJDVSBsb2NrICovCj4gICAJc3luY2hyb25pemVfcmN1KCk7
Cj4gICAKPiAtCWk5MTVfZ2VtX3N1c3BlbmQoZGV2X3ByaXYpOwo+ICsJaTkxNV9nZW1fc3VzcGVu
ZChpOTE1KTsKPiAgIAo+ICAgCWRybV9hdG9taWNfaGVscGVyX3NodXRkb3duKGRldik7Cj4gICAK
PiAtCWludGVsX2d2dF9jbGVhbnVwKGRldl9wcml2KTsKPiArCWludGVsX2d2dF9jbGVhbnVwKGk5
MTUpOwo+ICAgCj4gICAJaW50ZWxfbW9kZXNldF9jbGVhbnVwKGRldik7Cj4gICAKPiAtCWludGVs
X2Jpb3NfY2xlYW51cChkZXZfcHJpdik7Cj4gKwlpbnRlbF9iaW9zX2NsZWFudXAoaTkxNSk7Cj4g
ICAKPiAgIAl2Z2Ffc3dpdGNoZXJvb191bnJlZ2lzdGVyX2NsaWVudChwZGV2KTsKPiAgIAl2Z2Ff
Y2xpZW50X3JlZ2lzdGVyKHBkZXYsIE5VTEwsIE5VTEwsIE5VTEwpOwo+ICAgCj4gLQlpbnRlbF9j
c3JfdWNvZGVfZmluaShkZXZfcHJpdik7Cj4gKwlpbnRlbF9jc3JfdWNvZGVfZmluaShpOTE1KTsK
PiAgIAo+ICAgCS8qIEZyZWUgZXJyb3Igc3RhdGUgYWZ0ZXIgaW50ZXJydXB0cyBhcmUgZnVsbHkg
ZGlzYWJsZWQuICovCj4gLQljYW5jZWxfZGVsYXllZF93b3JrX3N5bmMoJmRldl9wcml2LT5ncHVf
ZXJyb3IuaGFuZ2NoZWNrX3dvcmspOwo+IC0JaTkxNV9yZXNldF9lcnJvcl9zdGF0ZShkZXZfcHJp
dik7Cj4gKwljYW5jZWxfZGVsYXllZF93b3JrX3N5bmMoJmk5MTUtPmdwdV9lcnJvci5oYW5nY2hl
Y2tfd29yayk7Cj4gKwlpOTE1X3Jlc2V0X2Vycm9yX3N0YXRlKGk5MTUpOwo+ICAgCj4gLQlpOTE1
X2dlbV9maW5pX2h3KGRldl9wcml2KTsKPiArCWk5MTVfZ2VtX2ZpbmlfaHcoaTkxNSk7Cj4gICAK
PiAtCWludGVsX3Bvd2VyX2RvbWFpbnNfZmluaV9odyhkZXZfcHJpdik7Cj4gKwlpbnRlbF9wb3dl
cl9kb21haW5zX2ZpbmlfaHcoaTkxNSk7Cj4gICAKPiAtCWk5MTVfZHJpdmVyX2NsZWFudXBfaHco
ZGV2X3ByaXYpOwo+ICsJaTkxNV9kcml2ZXJfY2xlYW51cF9odyhpOTE1KTsKPiAgIAo+IC0JZW5h
YmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoZGV2X3ByaXYpOwo+ICsJZW5hYmxlX3JwbV93YWtlcmVm
X2Fzc2VydHMoaTkxNSk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIGk5MTVfZHJpdmVyX3Jl
bGVhc2Uoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCj4gLQlkaXNhYmxlX3JwbV93YWtlcmVmX2Fz
c2VydHMoZGV2X3ByaXYpOwo+ICsJZGlzYWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGk5MTUpOwo+
ICAgCj4gLQlpOTE1X2dlbV9maW5pKGRldl9wcml2KTsKPiArCWk5MTVfZ2VtX2ZpbmkoaTkxNSk7
Cj4gICAKPiAtCWk5MTVfZ2d0dF9jbGVhbnVwX2h3KGRldl9wcml2KTsKPiAtCWk5MTVfZHJpdmVy
X2NsZWFudXBfbW1pbyhkZXZfcHJpdik7Cj4gKwlpOTE1X2dndHRfY2xlYW51cF9odyhpOTE1KTsK
PiArCWk5MTVfZHJpdmVyX2NsZWFudXBfbW1pbyhpOTE1KTsKPiAgIAo+IC0JZW5hYmxlX3JwbV93
YWtlcmVmX2Fzc2VydHMoZGV2X3ByaXYpOwo+IC0JaW50ZWxfcnVudGltZV9wbV9jbGVhbnVwKGRl
dl9wcml2KTsKPiArCWVuYWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGk5MTUpOwo+ICsJaW50ZWxf
cnVudGltZV9wbV9jbGVhbnVwKGk5MTUpOwo+ICAgCj4gLQlpOTE1X2RyaXZlcl9jbGVhbnVwX2Vh
cmx5KGRldl9wcml2KTsKPiAtCWk5MTVfZHJpdmVyX2Rlc3Ryb3koZGV2X3ByaXYpOwo+ICsJaTkx
NV9kcml2ZXJfY2xlYW51cF9lYXJseShpOTE1KTsKPiArCWk5MTVfZHJpdmVyX2Rlc3Ryb3koaTkx
NSk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQgaTkxNV9kcml2ZXJfb3BlbihzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2LCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpCj4gQEAgLTIwMzUsOSArMjAzNSw5
IEBAIHN0YXRpYyB2b2lkIGk5MTVfZHJpdmVyX3Bvc3RjbG9zZShzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2LCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpCj4gICAJa2ZyZWUoZmlsZV9wcml2KTsKPiAgIH0K
PiAgIAo+IC1zdGF0aWMgdm9pZCBpbnRlbF9zdXNwZW5kX2VuY29kZXJzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaW50ZWxfc3VzcGVuZF9lbmNvZGVy
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1fZGV2
aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAm
aTkxNS0+ZHJtOwo+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyOwo+ICAgCj4gICAJ
ZHJtX21vZGVzZXRfbG9ja19hbGwoZGV2KTsKPiBAQCAtMjA0NywxMSArMjA0NywxMSBAQCBzdGF0
aWMgdm9pZCBpbnRlbF9zdXNwZW5kX2VuY29kZXJzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiAgIAlkcm1fbW9kZXNldF91bmxvY2tfYWxsKGRldik7Cj4gICB9Cj4gICAKPiAt
c3RhdGljIGludCB2bHZfcmVzdW1lX3ByZXBhcmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ICtzdGF0aWMgaW50IHZsdl9yZXN1bWVfcHJlcGFyZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgIGJvb2wgcnBtX3Jlc3VtZSk7Cj4gLXN0YXRpYyBp
bnQgdmx2X3N1c3BlbmRfY29tcGxldGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KTsKPiArc3RhdGljIGludCB2bHZfc3VzcGVuZF9jb21wbGV0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSk7Cj4gICAKPiAtc3RhdGljIGJvb2wgc3VzcGVuZF90b19pZGxlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIGJvb2wgc3VzcGVuZF90b19pZGxl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgI2lmIElTX0VOQUJMRUQo
Q09ORklHX0FDUElfU0xFRVApCj4gICAJaWYgKGFjcGlfdGFyZ2V0X3N5c3RlbV9zdGF0ZSgpIDwg
QUNQSV9TVEFURV9TMykKPiBAQCAtMjA3NywxNSArMjA3NywxNSBAQCBzdGF0aWMgaW50IGk5MTVf
ZHJtX3ByZXBhcmUoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIAo+ICAgc3RhdGljIGludCBp
OTE1X2RybV9zdXNwZW5kKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gICB7Cj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gLQlzdHJ1Y3QgcGNp
X2RldiAqcGRldiA9IGRldl9wcml2LT5kcm0ucGRldjsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBpOTE1
LT5kcm0ucGRldjsKPiAgIAlwY2lfcG93ZXJfdCBvcHJlZ2lvbl90YXJnZXRfc3RhdGU7Cj4gICAK
PiAtCWRpc2FibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7Cj4gKwlkaXNhYmxlX3Jw
bV93YWtlcmVmX2Fzc2VydHMoaTkxNSk7Cj4gICAKPiAgIAkvKiBXZSBkbyBhIGxvdCBvZiBwb2tp
bmcgaW4gYSBsb3Qgb2YgcmVnaXN0ZXJzLCBtYWtlIHN1cmUgdGhleSB3b3JrCj4gICAJICogcHJv
cGVybHkuICovCj4gLQlpbnRlbF9wb3dlcl9kb21haW5zX2Rpc2FibGUoZGV2X3ByaXYpOwo+ICsJ
aW50ZWxfcG93ZXJfZG9tYWluc19kaXNhYmxlKGk5MTUpOwo+ICAgCj4gICAJZHJtX2ttc19oZWxw
ZXJfcG9sbF9kaXNhYmxlKGRldik7Cj4gICAKPiBAQCAtMjA5Myw0MCArMjA5Myw0MCBAQCBzdGF0
aWMgaW50IGk5MTVfZHJtX3N1c3BlbmQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIAo+ICAg
CWludGVsX2Rpc3BsYXlfc3VzcGVuZChkZXYpOwo+ICAgCj4gLQlpbnRlbF9kcF9tc3Rfc3VzcGVu
ZChkZXZfcHJpdik7Cj4gKwlpbnRlbF9kcF9tc3Rfc3VzcGVuZChpOTE1KTsKPiAgIAo+IC0JaW50
ZWxfcnVudGltZV9wbV9kaXNhYmxlX2ludGVycnVwdHMoZGV2X3ByaXYpOwo+IC0JaW50ZWxfaHBk
X2NhbmNlbF93b3JrKGRldl9wcml2KTsKPiArCWludGVsX3J1bnRpbWVfcG1fZGlzYWJsZV9pbnRl
cnJ1cHRzKGk5MTUpOwo+ICsJaW50ZWxfaHBkX2NhbmNlbF93b3JrKGk5MTUpOwo+ICAgCj4gLQlp
bnRlbF9zdXNwZW5kX2VuY29kZXJzKGRldl9wcml2KTsKPiArCWludGVsX3N1c3BlbmRfZW5jb2Rl
cnMoaTkxNSk7Cj4gICAKPiAtCWludGVsX3N1c3BlbmRfaHcoZGV2X3ByaXYpOwo+ICsJaW50ZWxf
c3VzcGVuZF9odyhpOTE1KTsKPiAgIAo+IC0JaTkxNV9nZW1fc3VzcGVuZF9ndHRfbWFwcGluZ3Mo
ZGV2X3ByaXYpOwo+ICsJaTkxNV9nZW1fc3VzcGVuZF9ndHRfbWFwcGluZ3MoaTkxNSk7Cj4gICAK
PiAtCWk5MTVfc2F2ZV9zdGF0ZShkZXZfcHJpdik7Cj4gKwlpOTE1X3NhdmVfc3RhdGUoaTkxNSk7
Cj4gICAKPiAtCW9wcmVnaW9uX3RhcmdldF9zdGF0ZSA9IHN1c3BlbmRfdG9faWRsZShkZXZfcHJp
dikgPyBQQ0lfRDEgOiBQQ0lfRDNjb2xkOwo+IC0JaW50ZWxfb3ByZWdpb25fc3VzcGVuZChkZXZf
cHJpdiwgb3ByZWdpb25fdGFyZ2V0X3N0YXRlKTsKPiArCW9wcmVnaW9uX3RhcmdldF9zdGF0ZSA9
IHN1c3BlbmRfdG9faWRsZShpOTE1KSA/IFBDSV9EMSA6IFBDSV9EM2NvbGQ7Cj4gKwlpbnRlbF9v
cHJlZ2lvbl9zdXNwZW5kKGk5MTUsIG9wcmVnaW9uX3RhcmdldF9zdGF0ZSk7Cj4gICAKPiAgIAlp
bnRlbF9mYmRldl9zZXRfc3VzcGVuZChkZXYsIEZCSU5GT19TVEFURV9TVVNQRU5ERUQsIHRydWUp
Owo+ICAgCj4gLQlkZXZfcHJpdi0+c3VzcGVuZF9jb3VudCsrOwo+ICsJaTkxNS0+c3VzcGVuZF9j
b3VudCsrOwo+ICAgCj4gLQlpbnRlbF9jc3JfdWNvZGVfc3VzcGVuZChkZXZfcHJpdik7Cj4gKwlp
bnRlbF9jc3JfdWNvZGVfc3VzcGVuZChpOTE1KTsKPiAgIAo+IC0JZW5hYmxlX3JwbV93YWtlcmVm
X2Fzc2VydHMoZGV2X3ByaXYpOwo+ICsJZW5hYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoaTkxNSk7
Cj4gICAKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGVudW0gaTkxNV9kcm1f
c3VzcGVuZF9tb2RlCj4gLWdldF9zdXNwZW5kX21vZGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LCBib29sIGhpYmVybmF0ZSkKPiArZ2V0X3N1c3BlbmRfbW9kZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwgYm9vbCBoaWJlcm5hdGUpCj4gICB7Cj4gICAJaWYgKGhpYmVy
bmF0ZSkKPiAgIAkJcmV0dXJuIEk5MTVfRFJNX1NVU1BFTkRfSElCRVJOQVRFOwo+ICAgCj4gLQlp
ZiAoc3VzcGVuZF90b19pZGxlKGRldl9wcml2KSkKPiArCWlmIChzdXNwZW5kX3RvX2lkbGUoaTkx
NSkpCj4gICAJCXJldHVybiBJOTE1X0RSTV9TVVNQRU5EX0lETEU7Cj4gICAKPiAgIAlyZXR1cm4g
STkxNV9EUk1fU1VTUEVORF9NRU07Cj4gQEAgLTIxMzQsMzAgKzIxMzQsMzAgQEAgZ2V0X3N1c3Bl
bmRfbW9kZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGJvb2wgaGliZXJuYXRl
KQo+ICAgCj4gICBzdGF0aWMgaW50IGk5MTVfZHJtX3N1c3BlbmRfbGF0ZShzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LCBib29sIGhpYmVybmF0aW9uKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+IC0Jc3RydWN0IHBjaV9kZXYgKnBkZXYg
PSBkZXZfcHJpdi0+ZHJtLnBkZXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gaTkxNS0+ZHJtLnBkZXY7
Cj4gICAJaW50IHJldDsKPiAgIAo+IC0JZGlzYWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGRldl9w
cml2KTsKPiArCWRpc2FibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhpOTE1KTsKPiAgIAo+IC0JaTkx
NV9nZW1fc3VzcGVuZF9sYXRlKGRldl9wcml2KTsKPiArCWk5MTVfZ2VtX3N1c3BlbmRfbGF0ZShp
OTE1KTsKPiAgIAo+IC0JaW50ZWxfdW5jb3JlX3N1c3BlbmQoJmRldl9wcml2LT51bmNvcmUpOwo+
ICsJaW50ZWxfdW5jb3JlX3N1c3BlbmQoJmk5MTUtPnVuY29yZSk7Cj4gICAKPiAtCWludGVsX3Bv
d2VyX2RvbWFpbnNfc3VzcGVuZChkZXZfcHJpdiwKPiAtCQkJCSAgICBnZXRfc3VzcGVuZF9tb2Rl
KGRldl9wcml2LCBoaWJlcm5hdGlvbikpOwo+ICsJaW50ZWxfcG93ZXJfZG9tYWluc19zdXNwZW5k
KGk5MTUsCj4gKwkJCQkgICAgZ2V0X3N1c3BlbmRfbW9kZShpOTE1LCBoaWJlcm5hdGlvbikpOwo+
ICAgCj4gICAJcmV0ID0gMDsKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExIHx8IElT
X0dFTjlfTFAoZGV2X3ByaXYpKQo+IC0JCWJ4dF9lbmFibGVfZGM5KGRldl9wcml2KTsKPiAtCWVs
c2UgaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElTX0JST0FEV0VMTChkZXZfcHJpdikpCj4g
LQkJaHN3X2VuYWJsZV9wYzgoZGV2X3ByaXYpOwo+IC0JZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhk
ZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gLQkJcmV0ID0gdmx2X3N1c3Bl
bmRfY29tcGxldGUoZGV2X3ByaXYpOwo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSB8fCBJ
U19HRU45X0xQKGk5MTUpKQo+ICsJCWJ4dF9lbmFibGVfZGM5KGk5MTUpOwo+ICsJZWxzZSBpZiAo
SVNfSEFTV0VMTChpOTE1KSB8fCBJU19CUk9BRFdFTEwoaTkxNSkpCj4gKwkJaHN3X2VuYWJsZV9w
YzgoaTkxNSk7Cj4gKwllbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJ
RVcoaTkxNSkpCj4gKwkJcmV0ID0gdmx2X3N1c3BlbmRfY29tcGxldGUoaTkxNSk7Cj4gICAKPiAg
IAlpZiAocmV0KSB7Cj4gICAJCURSTV9FUlJPUigiU3VzcGVuZCBjb21wbGV0ZSBmYWlsZWQ6ICVk
XG4iLCByZXQpOwo+IC0JCWludGVsX3Bvd2VyX2RvbWFpbnNfcmVzdW1lKGRldl9wcml2KTsKPiAr
CQlpbnRlbF9wb3dlcl9kb21haW5zX3Jlc3VtZShpOTE1KTsKPiAgIAo+ICAgCQlnb3RvIG91dDsK
PiAgIAl9Cj4gQEAgLTIxNzUsMTMgKzIxNzUsMTMgQEAgc3RhdGljIGludCBpOTE1X2RybV9zdXNw
ZW5kX2xhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgYm9vbCBoaWJlcm5hdGlvbikKPiAgIAkg
KiBGdWppdHN1IEZTQyBTNzExMAo+ICAgCSAqIEFjZXIgQXNwaXJlIDE4MzBUCj4gICAJICovCj4g
LQlpZiAoIShoaWJlcm5hdGlvbiAmJiBJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNikpCj4gKwlpZiAo
IShoaWJlcm5hdGlvbiAmJiBJTlRFTF9HRU4oaTkxNSkgPCA2KSkKPiAgIAkJcGNpX3NldF9wb3dl
cl9zdGF0ZShwZGV2LCBQQ0lfRDNob3QpOwo+ICAgCj4gICBvdXQ6Cj4gLQllbmFibGVfcnBtX3dh
a2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7Cj4gLQlpZiAoIWRldl9wcml2LT51bmNvcmUudXNlcl9m
b3JjZXdha2UuY291bnQpCj4gLQkJaW50ZWxfcnVudGltZV9wbV9jbGVhbnVwKGRldl9wcml2KTsK
PiArCWVuYWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGk5MTUpOwo+ICsJaWYgKCFpOTE1LT51bmNv
cmUudXNlcl9mb3JjZXdha2UuY291bnQpCj4gKwkJaW50ZWxfcnVudGltZV9wbV9jbGVhbnVwKGk5
MTUpOwo+ICAgCj4gICAJcmV0dXJuIHJldDsKPiAgIH0KPiBAQCAtMjIxMiwyNCArMjIxMiwyNCBA
QCBzdGF0aWMgaW50IGk5MTVfc3VzcGVuZF9zd2l0Y2hlcm9vKHN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYsIHBtX21lc3NhZ2VfdCBzdGF0ZSkKPiAgIAo+ICAgc3RhdGljIGludCBpOTE1X2RybV9yZXN1
bWUoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCWludCByZXQ7Cj4gICAKPiAtCWRpc2FibGVfcnBt
X3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7Cj4gLQlpbnRlbF9zYW5pdGl6ZV9ndF9wb3dlcnNh
dmUoZGV2X3ByaXYpOwo+ICsJZGlzYWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGk5MTUpOwo+ICsJ
aW50ZWxfc2FuaXRpemVfZ3RfcG93ZXJzYXZlKGk5MTUpOwo+ICAgCj4gLQlpOTE1X2dlbV9zYW5p
dGl6ZShkZXZfcHJpdik7Cj4gKwlpOTE1X2dlbV9zYW5pdGl6ZShpOTE1KTsKPiAgIAo+IC0JcmV0
ID0gaTkxNV9nZ3R0X2VuYWJsZV9odyhkZXZfcHJpdik7Cj4gKwlyZXQgPSBpOTE1X2dndHRfZW5h
YmxlX2h3KGk5MTUpOwo+ICAgCWlmIChyZXQpCj4gICAJCURSTV9FUlJPUigiZmFpbGVkIHRvIHJl
LWVuYWJsZSBHR1RUXG4iKTsKPiAgIAo+IC0JaW50ZWxfY3NyX3Vjb2RlX3Jlc3VtZShkZXZfcHJp
dik7Cj4gKwlpbnRlbF9jc3JfdWNvZGVfcmVzdW1lKGk5MTUpOwo+ICAgCj4gLQlpOTE1X3Jlc3Rv
cmVfc3RhdGUoZGV2X3ByaXYpOwo+IC0JaW50ZWxfcHBzX3VubG9ja19yZWdzX3dhKGRldl9wcml2
KTsKPiArCWk5MTVfcmVzdG9yZV9zdGF0ZShpOTE1KTsKPiArCWludGVsX3Bwc191bmxvY2tfcmVn
c193YShpOTE1KTsKPiAgIAo+IC0JaW50ZWxfaW5pdF9wY2hfcmVmY2xrKGRldl9wcml2KTsKPiAr
CWludGVsX2luaXRfcGNoX3JlZmNsayhpOTE1KTsKPiAgIAo+ICAgCS8qCj4gICAJICogSW50ZXJy
dXB0cyBoYXZlIHRvIGJlIGVuYWJsZWQgYmVmb3JlIGFueSBiYXRjaGVzIGFyZSBydW4uIElmIG5v
dCB0aGUKPiBAQCAtMjI0MSwyMSArMjI0MSwyMSBAQCBzdGF0aWMgaW50IGk5MTVfZHJtX3Jlc3Vt
ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAgCSAqIE1vZGVzZXQgZW5hYmxpbmcgaW4gaW50
ZWxfbW9kZXNldF9pbml0X2h3KCkgYWxzbyBuZWVkcyB3b3JraW5nCj4gICAJICogaW50ZXJydXB0
cy4KPiAgIAkgKi8KPiAtCWludGVsX3J1bnRpbWVfcG1fZW5hYmxlX2ludGVycnVwdHMoZGV2X3By
aXYpOwo+ICsJaW50ZWxfcnVudGltZV9wbV9lbmFibGVfaW50ZXJydXB0cyhpOTE1KTsKPiAgIAo+
ICAgCWRybV9tb2RlX2NvbmZpZ19yZXNldChkZXYpOwo+ICAgCj4gLQlpOTE1X2dlbV9yZXN1bWUo
ZGV2X3ByaXYpOwo+ICsJaTkxNV9nZW1fcmVzdW1lKGk5MTUpOwo+ICAgCj4gICAJaW50ZWxfbW9k
ZXNldF9pbml0X2h3KGRldik7Cj4gLQlpbnRlbF9pbml0X2Nsb2NrX2dhdGluZyhkZXZfcHJpdik7
Cj4gKwlpbnRlbF9pbml0X2Nsb2NrX2dhdGluZyhpOTE1KTsKPiAgIAo+IC0Jc3Bpbl9sb2NrX2ly
cSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiAtCWlmIChkZXZfcHJpdi0+ZGlzcGxheS5ocGRfaXJx
X3NldHVwKQo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmhwZF9pcnFfc2V0dXAoZGV2X3ByaXYpOwo+
IC0Jc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ICsJc3Bpbl9sb2NrX2ly
cSgmaTkxNS0+aXJxX2xvY2spOwo+ICsJaWYgKGk5MTUtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCkK
PiArCQlpOTE1LT5kaXNwbGF5LmhwZF9pcnFfc2V0dXAoaTkxNSk7Cj4gKwlzcGluX3VubG9ja19p
cnEoJmk5MTUtPmlycV9sb2NrKTsKPiAgIAo+IC0JaW50ZWxfZHBfbXN0X3Jlc3VtZShkZXZfcHJp
dik7Cj4gKwlpbnRlbF9kcF9tc3RfcmVzdW1lKGk5MTUpOwo+ICAgCj4gICAJaW50ZWxfZGlzcGxh
eV9yZXN1bWUoZGV2KTsKPiAgIAo+IEBAIC0yMjY3LDIzICsyMjY3LDIzIEBAIHN0YXRpYyBpbnQg
aTkxNV9kcm1fcmVzdW1lKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gICAJICogYm90aGVyIHdp
dGggdGhlIHRpbnkgcmFjZSBoZXJlIHdoZXJlIHdlIG1pZ2h0IGxvc2UgaG90cGx1Zwo+ICAgCSAq
IG5vdGlmaWNhdGlvbnMuCj4gICAJICogKi8KPiAtCWludGVsX2hwZF9pbml0KGRldl9wcml2KTsK
PiArCWludGVsX2hwZF9pbml0KGk5MTUpOwo+ICAgCj4gLQlpbnRlbF9vcHJlZ2lvbl9yZXN1bWUo
ZGV2X3ByaXYpOwo+ICsJaW50ZWxfb3ByZWdpb25fcmVzdW1lKGk5MTUpOwo+ICAgCj4gICAJaW50
ZWxfZmJkZXZfc2V0X3N1c3BlbmQoZGV2LCBGQklORk9fU1RBVEVfUlVOTklORywgZmFsc2UpOwo+
ICAgCj4gLQlpbnRlbF9wb3dlcl9kb21haW5zX2VuYWJsZShkZXZfcHJpdik7Cj4gKwlpbnRlbF9w
b3dlcl9kb21haW5zX2VuYWJsZShpOTE1KTsKPiAgIAo+IC0JZW5hYmxlX3JwbV93YWtlcmVmX2Fz
c2VydHMoZGV2X3ByaXYpOwo+ICsJZW5hYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoaTkxNSk7Cj4g
ICAKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGludCBpOTE1X2RybV9yZXN1
bWVfZWFybHkoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiAtCXN0cnVjdCBwY2lfZGV2ICpw
ZGV2ID0gZGV2X3ByaXYtPmRybS5wZGV2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGk5MTUtPmRybS5w
ZGV2Owo+ICAgCWludCByZXQ7Cj4gICAKPiAgIAkvKgo+IEBAIC0yMzMwLDMyICsyMzMwLDMyIEBA
IHN0YXRpYyBpbnQgaTkxNV9kcm1fcmVzdW1lX2Vhcmx5KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYp
Cj4gICAKPiAgIAlwY2lfc2V0X21hc3RlcihwZGV2KTsKPiAgIAo+IC0JZGlzYWJsZV9ycG1fd2Fr
ZXJlZl9hc3NlcnRzKGRldl9wcml2KTsKPiArCWRpc2FibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhp
OTE1KTsKPiAgIAo+IC0JaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJ
RVcoZGV2X3ByaXYpKQo+IC0JCXJldCA9IHZsdl9yZXN1bWVfcHJlcGFyZShkZXZfcHJpdiwgZmFs
c2UpOwo+ICsJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkK
PiArCQlyZXQgPSB2bHZfcmVzdW1lX3ByZXBhcmUoaTkxNSwgZmFsc2UpOwo+ICAgCWlmIChyZXQp
Cj4gICAJCURSTV9FUlJPUigiUmVzdW1lIHByZXBhcmUgZmFpbGVkOiAlZCwgY29udGludWluZyBh
bnl3YXlcbiIsCj4gICAJCQkgIHJldCk7Cj4gICAKPiAtCWludGVsX3VuY29yZV9yZXN1bWVfZWFy
bHkoJmRldl9wcml2LT51bmNvcmUpOwo+ICsJaW50ZWxfdW5jb3JlX3Jlc3VtZV9lYXJseSgmaTkx
NS0+dW5jb3JlKTsKPiAgIAo+IC0JaTkxNV9jaGVja19hbmRfY2xlYXJfZmF1bHRzKGRldl9wcml2
KTsKPiArCWk5MTVfY2hlY2tfYW5kX2NsZWFyX2ZhdWx0cyhpOTE1KTsKPiAgIAo+IC0JaWYgKElO
VEVMX0dFTihkZXZfcHJpdikgPj0gMTEgfHwgSVNfR0VOOV9MUChkZXZfcHJpdikpIHsKPiAtCQln
ZW45X3Nhbml0aXplX2RjX3N0YXRlKGRldl9wcml2KTsKPiAtCQlieHRfZGlzYWJsZV9kYzkoZGV2
X3ByaXYpOwo+IC0JfSBlbHNlIGlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8fCBJU19CUk9BRFdF
TEwoZGV2X3ByaXYpKSB7Cj4gLQkJaHN3X2Rpc2FibGVfcGM4KGRldl9wcml2KTsKPiArCWlmIChJ
TlRFTF9HRU4oaTkxNSkgPj0gMTEgfHwgSVNfR0VOOV9MUChpOTE1KSkgewo+ICsJCWdlbjlfc2Fu
aXRpemVfZGNfc3RhdGUoaTkxNSk7Cj4gKwkJYnh0X2Rpc2FibGVfZGM5KGk5MTUpOwo+ICsJfSBl
bHNlIGlmIChJU19IQVNXRUxMKGk5MTUpIHx8IElTX0JST0FEV0VMTChpOTE1KSkgewo+ICsJCWhz
d19kaXNhYmxlX3BjOChpOTE1KTsKPiAgIAl9Cj4gICAKPiAtCWludGVsX3VuY29yZV9zYW5pdGl6
ZShkZXZfcHJpdik7Cj4gKwlpbnRlbF91bmNvcmVfc2FuaXRpemUoaTkxNSk7Cj4gICAKPiAtCWlu
dGVsX3Bvd2VyX2RvbWFpbnNfcmVzdW1lKGRldl9wcml2KTsKPiArCWludGVsX3Bvd2VyX2RvbWFp
bnNfcmVzdW1lKGk5MTUpOwo+ICAgCj4gLQlpbnRlbF9ndF9zYW5pdGl6ZShkZXZfcHJpdiwgdHJ1
ZSk7Cj4gKwlpbnRlbF9ndF9zYW5pdGl6ZShpOTE1LCB0cnVlKTsKPiAgIAo+IC0JZW5hYmxlX3Jw
bV93YWtlcmVmX2Fzc2VydHMoZGV2X3ByaXYpOwo+ICsJZW5hYmxlX3JwbV93YWtlcmVmX2Fzc2Vy
dHMoaTkxNSk7Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+IEBAIC0yNTQwLDkgKzI1NDAs
OSBAQCBzdGF0aWMgaW50IGk5MTVfcG1fcmVzdG9yZShzdHJ1Y3QgZGV2aWNlICprZGV2KQo+ICAg
ICogYSBibGFjay1ib3ggZm9yIHRoZSBkcml2ZXIuIEZ1cnRoZXIgaW52ZXN0aWdhdGlvbiBpcyBu
ZWVkZWQgdG8gcmVkdWNlIHRoZQo+ICAgICogc2F2ZWQvcmVzdG9yZWQgcmVnaXN0ZXJzIGV2ZW4g
ZnVydGhlciwgYnkgZm9sbG93aW5nIHRoZSBzYW1lIDMgY3JpdGVyaWEuCj4gICAgKi8KPiAtc3Rh
dGljIHZvaWQgdmx2X3NhdmVfZ3VuaXRfczBpeF9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIHZsdl9zYXZlX2d1bml0X3MwaXhfc3RhdGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3Qgdmx2X3MwaXhfc3Rh
dGUgKnMgPSAmZGV2X3ByaXYtPnZsdl9zMGl4X3N0YXRlOwo+ICsJc3RydWN0IHZsdl9zMGl4X3N0
YXRlICpzID0gJmk5MTUtPnZsdl9zMGl4X3N0YXRlOwo+ICAgCWludCBpOwo+ICAgCj4gICAJLyog
R0FNIDB4NDAwMC0weDQ3NzAgKi8KPiBAQCAtMjYyMSw5ICsyNjIxLDkgQEAgc3RhdGljIHZvaWQg
dmx2X3NhdmVfZ3VuaXRfczBpeF9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gICAJICovCj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgdmx2X3Jlc3RvcmVfZ3VuaXRf
czBpeF9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2
b2lkIHZsdl9yZXN0b3JlX2d1bml0X3MwaXhfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3Qgdmx2X3MwaXhfc3RhdGUgKnMgPSAmZGV2X3ByaXYtPnZs
dl9zMGl4X3N0YXRlOwo+ICsJc3RydWN0IHZsdl9zMGl4X3N0YXRlICpzID0gJmk5MTUtPnZsdl9z
MGl4X3N0YXRlOwo+ICAgCXUzMiB2YWw7Cj4gICAJaW50IGk7Cj4gICAKPiBAQCAtMjczMiw3ICsy
NzMyLDcgQEAgc3RhdGljIGludCB2bHZfd2FpdF9mb3JfcHdfc3RhdHVzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCXJldHVybiByZXQ7Cj4gICB9Cj4gICAKPiAtaW50IHZsdl9m
b3JjZV9nZnhfY2xvY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBib29sIGZv
cmNlX29uKQo+ICtpbnQgdmx2X2ZvcmNlX2dmeF9jbG9jayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwgYm9vbCBmb3JjZV9vbikKPiAgIHsKPiAgIAl1MzIgdmFsOwo+ICAgCWludCBlcnI7
Cj4gQEAgLTI3NDYsNyArMjc0Niw3IEBAIGludCB2bHZfZm9yY2VfZ2Z4X2Nsb2NrKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgYm9vbCBmb3JjZV9vbikKPiAgIAlpZiAoIWZvcmNl
X29uKQo+ICAgCQlyZXR1cm4gMDsKPiAgIAo+IC0JZXJyID0gaW50ZWxfd2FpdF9mb3JfcmVnaXN0
ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gKwllcnIgPSBpbnRlbF93YWl0X2Zvcl9yZWdpc3Rlcigm
aTkxNS0+dW5jb3JlLAo+ICAgCQkJCSAgICAgIFZMVl9HVExDX1NVUlZJVkFCSUxJVFlfUkVHLAo+
ICAgCQkJCSAgICAgIFZMVl9HRlhfQ0xLX1NUQVRVU19CSVQsCj4gICAJCQkJICAgICAgVkxWX0dG
WF9DTEtfU1RBVFVTX0JJVCwKPiBAQCAtMjc1OCw3ICsyNzU4LDcgQEAgaW50IHZsdl9mb3JjZV9n
ZnhfY2xvY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBib29sIGZvcmNlX29u
KQo+ICAgCXJldHVybiBlcnI7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGludCB2bHZfYWxsb3dfZ3Rf
d2FrZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGJvb2wgYWxsb3cpCj4gK3N0
YXRpYyBpbnQgdmx2X2FsbG93X2d0X3dha2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
IGJvb2wgYWxsb3cpCj4gICB7Cj4gICAJdTMyIG1hc2s7Cj4gICAJdTMyIHZhbDsKPiBAQCAtMjc3
NCwxNCArMjc3NCwxNCBAQCBzdGF0aWMgaW50IHZsdl9hbGxvd19ndF93YWtlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwgYm9vbCBhbGxvdykKPiAgIAltYXNrID0gVkxWX0dUTENf
QUxMT1dXQUtFQUNLOwo+ICAgCXZhbCA9IGFsbG93ID8gbWFzayA6IDA7Cj4gICAKPiAtCWVyciA9
IHZsdl93YWl0X2Zvcl9wd19zdGF0dXMoZGV2X3ByaXYsIG1hc2ssIHZhbCk7Cj4gKwllcnIgPSB2
bHZfd2FpdF9mb3JfcHdfc3RhdHVzKGk5MTUsIG1hc2ssIHZhbCk7Cj4gICAJaWYgKGVycikKPiAg
IAkJRFJNX0VSUk9SKCJ0aW1lb3V0IGRpc2FibGluZyBHVCB3YWtpbmdcbiIpOwo+ICAgCj4gICAJ
cmV0dXJuIGVycjsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCB2bHZfd2FpdF9mb3JfZ3Rfd2Vs
bHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCB2bHZf
d2FpdF9mb3JfZ3Rfd2VsbHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJ
ICBib29sIHdhaXRfZm9yX29uKQo+ICAgewo+ICAgCXUzMiBtYXNrOwo+IEBAIC0yNzk3LDEyICsy
Nzk3LDEyIEBAIHN0YXRpYyB2b2lkIHZsdl93YWl0X2Zvcl9ndF93ZWxscyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJICogVGhpcyBjYW4gZmFpbCB0byB0dXJuIG9mZiB0
aGUgcmM2IGlmIHRoZSBHUFUgaXMgc3R1Y2sgYWZ0ZXIgYSBmYWlsZWQKPiAgIAkgKiByZXNldCBh
bmQgd2UgYXJlIHRyeWluZyB0byBmb3JjZSB0aGUgbWFjaGluZSB0byBzbGVlcC4KPiAgIAkgKi8K
PiAtCWlmICh2bHZfd2FpdF9mb3JfcHdfc3RhdHVzKGRldl9wcml2LCBtYXNrLCB2YWwpKQo+ICsJ
aWYgKHZsdl93YWl0X2Zvcl9wd19zdGF0dXMoaTkxNSwgbWFzaywgdmFsKSkKPiAgIAkJRFJNX0RF
QlVHX0RSSVZFUigidGltZW91dCB3YWl0aW5nIGZvciBHVCB3ZWxscyB0byBnbyAlc1xuIiwKPiAg
IAkJCQkgb25vZmYod2FpdF9mb3Jfb24pKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCB2bHZf
Y2hlY2tfbm9fZ3RfYWNjZXNzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAr
c3RhdGljIHZvaWQgdmx2X2NoZWNrX25vX2d0X2FjY2VzcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKPiAgIHsKPiAgIAlpZiAoIShJOTE1X1JFQUQoVkxWX0dUTENfUFdfU1RBVFVTKSAm
IFZMVl9HVExDX0FMTE9XV0FLRUVSUikpCj4gICAJCXJldHVybjsKPiBAQCAtMjgxMSw3ICsyODEx
LDcgQEAgc3RhdGljIHZvaWQgdmx2X2NoZWNrX25vX2d0X2FjY2VzcyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJSTkxNV9XUklURShWTFZfR1RMQ19QV19TVEFUVVMsIFZM
Vl9HVExDX0FMTE9XV0FLRUVSUik7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGludCB2bHZfc3VzcGVu
ZF9jb21wbGV0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyBp
bnQgdmx2X3N1c3BlbmRfY29tcGxldGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
ICB7Cj4gICAJdTMyIG1hc2s7Cj4gICAJaW50IGVycjsKPiBAQCAtMjgyMCwyNSArMjgyMCwyNSBA
QCBzdGF0aWMgaW50IHZsdl9zdXNwZW5kX2NvbXBsZXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiAgIAkgKiBCc3BlYyBkZWZpbmVzIHRoZSBmb2xsb3dpbmcgR1Qgd2VsbCBv
biBmbGFncyBhcyBkZWJ1ZyBvbmx5LCBzbwo+ICAgCSAqIGRvbid0IHRyZWF0IHRoZW0gYXMgaGFy
ZCBmYWlsdXJlcy4KPiAgIAkgKi8KPiAtCXZsdl93YWl0X2Zvcl9ndF93ZWxscyhkZXZfcHJpdiwg
ZmFsc2UpOwo+ICsJdmx2X3dhaXRfZm9yX2d0X3dlbGxzKGk5MTUsIGZhbHNlKTsKPiAgIAo+ICAg
CW1hc2sgPSBWTFZfR1RMQ19SRU5ERVJfQ1RYX0VYSVNUUyB8IFZMVl9HVExDX01FRElBX0NUWF9F
WElTVFM7Cj4gICAJV0FSTl9PTigoSTkxNV9SRUFEKFZMVl9HVExDX1dBS0VfQ1RSTCkgJiBtYXNr
KSAhPSBtYXNrKTsKPiAgIAo+IC0Jdmx2X2NoZWNrX25vX2d0X2FjY2VzcyhkZXZfcHJpdik7Cj4g
Kwl2bHZfY2hlY2tfbm9fZ3RfYWNjZXNzKGk5MTUpOwo+ICAgCj4gLQllcnIgPSB2bHZfZm9yY2Vf
Z2Z4X2Nsb2NrKGRldl9wcml2LCB0cnVlKTsKPiArCWVyciA9IHZsdl9mb3JjZV9nZnhfY2xvY2so
aTkxNSwgdHJ1ZSk7Cj4gICAJaWYgKGVycikKPiAgIAkJZ290byBlcnIxOwo+ICAgCj4gLQllcnIg
PSB2bHZfYWxsb3dfZ3Rfd2FrZShkZXZfcHJpdiwgZmFsc2UpOwo+ICsJZXJyID0gdmx2X2FsbG93
X2d0X3dha2UoaTkxNSwgZmFsc2UpOwo+ICAgCWlmIChlcnIpCj4gICAJCWdvdG8gZXJyMjsKPiAg
IAo+IC0JaWYgKCFJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiAtCQl2bHZfc2F2ZV9ndW5pdF9z
MGl4X3N0YXRlKGRldl9wcml2KTsKPiArCWlmICghSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiArCQl2
bHZfc2F2ZV9ndW5pdF9zMGl4X3N0YXRlKGk5MTUpOwo+ICAgCj4gLQllcnIgPSB2bHZfZm9yY2Vf
Z2Z4X2Nsb2NrKGRldl9wcml2LCBmYWxzZSk7Cj4gKwllcnIgPSB2bHZfZm9yY2VfZ2Z4X2Nsb2Nr
KGk5MTUsIGZhbHNlKTsKPiAgIAlpZiAoZXJyKQo+ICAgCQlnb3RvIGVycjI7Cj4gICAKPiBAQCAt
Mjg0NiwxNCArMjg0NiwxNCBAQCBzdGF0aWMgaW50IHZsdl9zdXNwZW5kX2NvbXBsZXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAo+ICAgZXJyMjoKPiAgIAkvKiBGb3Ig
c2FmZXR5IGFsd2F5cyByZS1lbmFibGUgd2FraW5nIGFuZCBkaXNhYmxlIGdmeCBjbG9jayBmb3Jj
aW5nICovCj4gLQl2bHZfYWxsb3dfZ3Rfd2FrZShkZXZfcHJpdiwgdHJ1ZSk7Cj4gKwl2bHZfYWxs
b3dfZ3Rfd2FrZShpOTE1LCB0cnVlKTsKPiAgIGVycjE6Cj4gLQl2bHZfZm9yY2VfZ2Z4X2Nsb2Nr
KGRldl9wcml2LCBmYWxzZSk7Cj4gKwl2bHZfZm9yY2VfZ2Z4X2Nsb2NrKGk5MTUsIGZhbHNlKTsK
PiAgIAo+ICAgCXJldHVybiBlcnI7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGludCB2bHZfcmVzdW1l
X3ByZXBhcmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgaW50
IHZsdl9yZXN1bWVfcHJlcGFyZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJ
CQlib29sIHJwbV9yZXN1bWUpCj4gICB7Cj4gICAJaW50IGVycjsKPiBAQCAtMjg2NCwyMyArMjg2
NCwyMyBAQCBzdGF0aWMgaW50IHZsdl9yZXN1bWVfcHJlcGFyZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gICAJICogY2FuIGRvIGF0IHRoaXMgcG9pbnQuIFJldHVybiB0aGUg
Zmlyc3QgZXJyb3IgY29kZSAod2hpY2ggd2lsbCBhbHNvCj4gICAJICogbGVhdmUgUlBNIHBlcm1h
bmVudGx5IGRpc2FibGVkKS4KPiAgIAkgKi8KPiAtCXJldCA9IHZsdl9mb3JjZV9nZnhfY2xvY2so
ZGV2X3ByaXYsIHRydWUpOwo+ICsJcmV0ID0gdmx2X2ZvcmNlX2dmeF9jbG9jayhpOTE1LCB0cnVl
KTsKPiAgIAo+IC0JaWYgKCFJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiAtCQl2bHZfcmVzdG9y
ZV9ndW5pdF9zMGl4X3N0YXRlKGRldl9wcml2KTsKPiArCWlmICghSVNfQ0hFUlJZVklFVyhpOTE1
KSkKPiArCQl2bHZfcmVzdG9yZV9ndW5pdF9zMGl4X3N0YXRlKGk5MTUpOwo+ICAgCj4gLQllcnIg
PSB2bHZfYWxsb3dfZ3Rfd2FrZShkZXZfcHJpdiwgdHJ1ZSk7Cj4gKwllcnIgPSB2bHZfYWxsb3df
Z3Rfd2FrZShpOTE1LCB0cnVlKTsKPiAgIAlpZiAoIXJldCkKPiAgIAkJcmV0ID0gZXJyOwo+ICAg
Cj4gLQllcnIgPSB2bHZfZm9yY2VfZ2Z4X2Nsb2NrKGRldl9wcml2LCBmYWxzZSk7Cj4gKwllcnIg
PSB2bHZfZm9yY2VfZ2Z4X2Nsb2NrKGk5MTUsIGZhbHNlKTsKPiAgIAlpZiAoIXJldCkKPiAgIAkJ
cmV0ID0gZXJyOwo+ICAgCj4gLQl2bHZfY2hlY2tfbm9fZ3RfYWNjZXNzKGRldl9wcml2KTsKPiAr
CXZsdl9jaGVja19ub19ndF9hY2Nlc3MoaTkxNSk7Cj4gICAKPiAgIAlpZiAocnBtX3Jlc3VtZSkK
PiAtCQlpbnRlbF9pbml0X2Nsb2NrX2dhdGluZyhkZXZfcHJpdik7Cj4gKwkJaW50ZWxfaW5pdF9j
bG9ja19nYXRpbmcoaTkxNSk7Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+IEBAIC0yODg5
LDgwICsyODg5LDgwIEBAIHN0YXRpYyBpbnQgaW50ZWxfcnVudGltZV9zdXNwZW5kKHN0cnVjdCBk
ZXZpY2UgKmtkZXYpCj4gICB7Cj4gICAJc3RydWN0IHBjaV9kZXYgKnBkZXYgPSB0b19wY2lfZGV2
KGtkZXYpOwo+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBwY2lfZ2V0X2RydmRhdGEocGRl
dik7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAlp
bnQgcmV0Owo+ICAgCj4gLQlpZiAoV0FSTl9PTl9PTkNFKCEoZGV2X3ByaXYtPmd0X3BtLnJjNi5l
bmFibGVkICYmIEhBU19SQzYoZGV2X3ByaXYpKSkpCj4gKwlpZiAoV0FSTl9PTl9PTkNFKCEoaTkx
NS0+Z3RfcG0ucmM2LmVuYWJsZWQgJiYgSEFTX1JDNihpOTE1KSkpKQo+ICAgCQlyZXR1cm4gLUVO
T0RFVjsKPiAgIAo+IC0JaWYgKFdBUk5fT05fT05DRSghSEFTX1JVTlRJTUVfUE0oZGV2X3ByaXYp
KSkKPiArCWlmIChXQVJOX09OX09OQ0UoIUhBU19SVU5USU1FX1BNKGk5MTUpKSkKPiAgIAkJcmV0
dXJuIC1FTk9ERVY7Cj4gICAKPiAgIAlEUk1fREVCVUdfS01TKCJTdXNwZW5kaW5nIGRldmljZVxu
Iik7Cj4gICAKPiAtCWRpc2FibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7Cj4gKwlk
aXNhYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoaTkxNSk7Cj4gICAKPiAgIAkvKgo+ICAgCSAqIFdl
IGFyZSBzYWZlIGhlcmUgYWdhaW5zdCByZS1mYXVsdHMsIHNpbmNlIHRoZSBmYXVsdCBoYW5kbGVy
IHRha2VzCj4gICAJICogYW4gUlBNIHJlZmVyZW5jZS4KPiAgIAkgKi8KPiAtCWk5MTVfZ2VtX3J1
bnRpbWVfc3VzcGVuZChkZXZfcHJpdik7Cj4gKwlpOTE1X2dlbV9ydW50aW1lX3N1c3BlbmQoaTkx
NSk7Cj4gICAKPiAtCWludGVsX3VjX3J1bnRpbWVfc3VzcGVuZChkZXZfcHJpdik7Cj4gKwlpbnRl
bF91Y19ydW50aW1lX3N1c3BlbmQoaTkxNSk7Cj4gICAKPiAtCWludGVsX3J1bnRpbWVfcG1fZGlz
YWJsZV9pbnRlcnJ1cHRzKGRldl9wcml2KTsKPiArCWludGVsX3J1bnRpbWVfcG1fZGlzYWJsZV9p
bnRlcnJ1cHRzKGk5MTUpOwo+ICAgCj4gLQlpbnRlbF91bmNvcmVfc3VzcGVuZCgmZGV2X3ByaXYt
PnVuY29yZSk7Cj4gKwlpbnRlbF91bmNvcmVfc3VzcGVuZCgmaTkxNS0+dW5jb3JlKTsKPiAgIAo+
ICAgCXJldCA9IDA7Cj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkgewo+IC0JCWlj
bF9kaXNwbGF5X2NvcmVfdW5pbml0KGRldl9wcml2KTsKPiAtCQlieHRfZW5hYmxlX2RjOShkZXZf
cHJpdik7Cj4gLQl9IGVsc2UgaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKSB7Cj4gLQkJYnh0X2Rp
c3BsYXlfY29yZV91bmluaXQoZGV2X3ByaXYpOwo+IC0JCWJ4dF9lbmFibGVfZGM5KGRldl9wcml2
KTsKPiAtCX0gZWxzZSBpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgfHwgSVNfQlJPQURXRUxMKGRl
dl9wcml2KSkgewo+IC0JCWhzd19lbmFibGVfcGM4KGRldl9wcml2KTsKPiAtCX0gZWxzZSBpZiAo
SVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiAt
CQlyZXQgPSB2bHZfc3VzcGVuZF9jb21wbGV0ZShkZXZfcHJpdik7Cj4gKwlpZiAoSU5URUxfR0VO
KGk5MTUpID49IDExKSB7Cj4gKwkJaWNsX2Rpc3BsYXlfY29yZV91bmluaXQoaTkxNSk7Cj4gKwkJ
Ynh0X2VuYWJsZV9kYzkoaTkxNSk7Cj4gKwl9IGVsc2UgaWYgKElTX0dFTjlfTFAoaTkxNSkpIHsK
PiArCQlieHRfZGlzcGxheV9jb3JlX3VuaW5pdChpOTE1KTsKPiArCQlieHRfZW5hYmxlX2RjOShp
OTE1KTsKPiArCX0gZWxzZSBpZiAoSVNfSEFTV0VMTChpOTE1KSB8fCBJU19CUk9BRFdFTEwoaTkx
NSkpIHsKPiArCQloc3dfZW5hYmxlX3BjOChpOTE1KTsKPiArCX0gZWxzZSBpZiAoSVNfVkFMTEVZ
VklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gKwkJcmV0ID0gdmx2X3N1c3Bl
bmRfY29tcGxldGUoaTkxNSk7Cj4gICAJfQo+ICAgCj4gICAJaWYgKHJldCkgewo+ICAgCQlEUk1f
RVJST1IoIlJ1bnRpbWUgc3VzcGVuZCBmYWlsZWQsIGRpc2FibGluZyBpdCAoJWQpXG4iLCByZXQp
Owo+IC0JCWludGVsX3VuY29yZV9ydW50aW1lX3Jlc3VtZSgmZGV2X3ByaXYtPnVuY29yZSk7Cj4g
KwkJaW50ZWxfdW5jb3JlX3J1bnRpbWVfcmVzdW1lKCZpOTE1LT51bmNvcmUpOwo+ICAgCj4gLQkJ
aW50ZWxfcnVudGltZV9wbV9lbmFibGVfaW50ZXJydXB0cyhkZXZfcHJpdik7Cj4gKwkJaW50ZWxf
cnVudGltZV9wbV9lbmFibGVfaW50ZXJydXB0cyhpOTE1KTsKPiAgIAo+IC0JCWludGVsX3VjX3Jl
c3VtZShkZXZfcHJpdik7Cj4gKwkJaW50ZWxfdWNfcmVzdW1lKGk5MTUpOwo+ICAgCj4gLQkJaTkx
NV9nZW1faW5pdF9zd2l6emxpbmcoZGV2X3ByaXYpOwo+IC0JCWk5MTVfZ2VtX3Jlc3RvcmVfZmVu
Y2VzKGRldl9wcml2KTsKPiArCQlpOTE1X2dlbV9pbml0X3N3aXp6bGluZyhpOTE1KTsKPiArCQlp
OTE1X2dlbV9yZXN0b3JlX2ZlbmNlcyhpOTE1KTsKPiAgIAo+IC0JCWVuYWJsZV9ycG1fd2FrZXJl
Zl9hc3NlcnRzKGRldl9wcml2KTsKPiArCQllbmFibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhpOTE1
KTsKPiAgIAo+ICAgCQlyZXR1cm4gcmV0Owo+ICAgCX0KPiAgIAo+IC0JZW5hYmxlX3JwbV93YWtl
cmVmX2Fzc2VydHMoZGV2X3ByaXYpOwo+IC0JaW50ZWxfcnVudGltZV9wbV9jbGVhbnVwKGRldl9w
cml2KTsKPiArCWVuYWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGk5MTUpOwo+ICsJaW50ZWxfcnVu
dGltZV9wbV9jbGVhbnVwKGk5MTUpOwo+ICAgCj4gLQlpZiAoaW50ZWxfdW5jb3JlX2FybV91bmNs
YWltZWRfbW1pb19kZXRlY3Rpb24oJmRldl9wcml2LT51bmNvcmUpKQo+ICsJaWYgKGludGVsX3Vu
Y29yZV9hcm1fdW5jbGFpbWVkX21taW9fZGV0ZWN0aW9uKCZpOTE1LT51bmNvcmUpKQo+ICAgCQlE
Uk1fRVJST1IoIlVuY2xhaW1lZCBhY2Nlc3MgZGV0ZWN0ZWQgcHJpb3IgdG8gc3VzcGVuZGluZ1xu
Iik7Cj4gICAKPiAtCWRldl9wcml2LT5ydW50aW1lX3BtLnN1c3BlbmRlZCA9IHRydWU7Cj4gKwlp
OTE1LT5ydW50aW1lX3BtLnN1c3BlbmRlZCA9IHRydWU7Cj4gICAKPiAgIAkvKgo+ICAgCSAqIEZJ
WE1FOiBXZSByZWFsbHkgc2hvdWxkIGZpbmQgYSBkb2N1bWVudCB0aGF0IHJlZmVyZW5jZXMgdGhl
IGFyZ3VtZW50cwo+ICAgCSAqIHVzZWQgYmVsb3chCj4gICAJICovCj4gLQlpZiAoSVNfQlJPQURX
RUxMKGRldl9wcml2KSkgewo+ICsJaWYgKElTX0JST0FEV0VMTChpOTE1KSkgewo+ICAgCQkvKgo+
ICAgCQkgKiBPbiBCcm9hZHdlbGwsIGlmIHdlIHVzZSBQQ0lfRDEgdGhlIFBDSCBEREkgcG9ydHMg
d2lsbCBzdG9wCj4gICAJCSAqIGJlaW5nIGRldGVjdGVkLCBhbmQgdGhlIGNhbGwgd2UgZG8gYXQg
aW50ZWxfcnVudGltZV9yZXN1bWUoKQo+ICAgCQkgKiB3b24ndCBiZSBhYmxlIHRvIHJlc3RvcmUg
dGhlbS4gU2luY2UgUENJX0QzaG90IG1hdGNoZXMgdGhlCj4gICAJCSAqIGFjdHVhbCBzcGVjaWZp
Y2F0aW9uIGFuZCBhcHBlYXJzIHRvIGJlIHdvcmtpbmcsIHVzZSBpdC4KPiAgIAkJICovCj4gLQkJ
aW50ZWxfb3ByZWdpb25fbm90aWZ5X2FkYXB0ZXIoZGV2X3ByaXYsIFBDSV9EM2hvdCk7Cj4gKwkJ
aW50ZWxfb3ByZWdpb25fbm90aWZ5X2FkYXB0ZXIoaTkxNSwgUENJX0QzaG90KTsKPiAgIAl9IGVs
c2Ugewo+ICAgCQkvKgo+ICAgCQkgKiBjdXJyZW50IHZlcnNpb25zIG9mIGZpcm13YXJlIHdoaWNo
IGRlcGVuZCBvbiB0aGlzIG9wcmVnaW9uCj4gQEAgLTI5NzEsMTMgKzI5NzEsMTMgQEAgc3RhdGlj
IGludCBpbnRlbF9ydW50aW1lX3N1c3BlbmQoc3RydWN0IGRldmljZSAqa2RldikKPiAgIAkJICog
dG8gZGlzdGluZ3Vpc2ggaXQgZnJvbSBub3RpZmljYXRpb25zIHRoYXQgbWlnaHQgYmUgc2VudCB2
aWEKPiAgIAkJICogdGhlIHN1c3BlbmQgcGF0aC4KPiAgIAkJICovCj4gLQkJaW50ZWxfb3ByZWdp
b25fbm90aWZ5X2FkYXB0ZXIoZGV2X3ByaXYsIFBDSV9EMSk7Cj4gKwkJaW50ZWxfb3ByZWdpb25f
bm90aWZ5X2FkYXB0ZXIoaTkxNSwgUENJX0QxKTsKPiAgIAl9Cj4gICAKPiAtCWFzc2VydF9mb3Jj
ZXdha2VzX2luYWN0aXZlKCZkZXZfcHJpdi0+dW5jb3JlKTsKPiArCWFzc2VydF9mb3JjZXdha2Vz
X2luYWN0aXZlKCZpOTE1LT51bmNvcmUpOwo+ICAgCj4gLQlpZiAoIUlTX1ZBTExFWVZJRVcoZGV2
X3ByaXYpICYmICFJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiAtCQlpbnRlbF9ocGRfcG9sbF9p
bml0KGRldl9wcml2KTsKPiArCWlmICghSVNfVkFMTEVZVklFVyhpOTE1KSAmJiAhSVNfQ0hFUlJZ
VklFVyhpOTE1KSkKPiArCQlpbnRlbF9ocGRfcG9sbF9pbml0KGk5MTUpOwo+ICAgCj4gICAJRFJN
X0RFQlVHX0tNUygiRGV2aWNlIHN1c3BlbmRlZFxuIik7Cj4gICAJcmV0dXJuIDA7Cj4gQEAgLTI5
ODcsNjkgKzI5ODcsNjkgQEAgc3RhdGljIGludCBpbnRlbF9ydW50aW1lX3Jlc3VtZShzdHJ1Y3Qg
ZGV2aWNlICprZGV2KQo+ICAgewo+ICAgCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gdG9fcGNpX2Rl
dihrZGV2KTsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gcGNpX2dldF9kcnZkYXRhKHBk
ZXYpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJ
aW50IHJldCA9IDA7Cj4gICAKPiAtCWlmIChXQVJOX09OX09OQ0UoIUhBU19SVU5USU1FX1BNKGRl
dl9wcml2KSkpCj4gKwlpZiAoV0FSTl9PTl9PTkNFKCFIQVNfUlVOVElNRV9QTShpOTE1KSkpCj4g
ICAJCXJldHVybiAtRU5PREVWOwo+ICAgCj4gICAJRFJNX0RFQlVHX0tNUygiUmVzdW1pbmcgZGV2
aWNlXG4iKTsKPiAgIAo+IC0JV0FSTl9PTl9PTkNFKGF0b21pY19yZWFkKCZkZXZfcHJpdi0+cnVu
dGltZV9wbS53YWtlcmVmX2NvdW50KSk7Cj4gLQlkaXNhYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMo
ZGV2X3ByaXYpOwo+ICsJV0FSTl9PTl9PTkNFKGF0b21pY19yZWFkKCZpOTE1LT5ydW50aW1lX3Bt
Lndha2VyZWZfY291bnQpKTsKPiArCWRpc2FibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhpOTE1KTsK
PiAgIAo+IC0JaW50ZWxfb3ByZWdpb25fbm90aWZ5X2FkYXB0ZXIoZGV2X3ByaXYsIFBDSV9EMCk7
Cj4gLQlkZXZfcHJpdi0+cnVudGltZV9wbS5zdXNwZW5kZWQgPSBmYWxzZTsKPiAtCWlmIChpbnRl
bF91bmNvcmVfdW5jbGFpbWVkX21taW8oJmRldl9wcml2LT51bmNvcmUpKQo+ICsJaW50ZWxfb3By
ZWdpb25fbm90aWZ5X2FkYXB0ZXIoaTkxNSwgUENJX0QwKTsKPiArCWk5MTUtPnJ1bnRpbWVfcG0u
c3VzcGVuZGVkID0gZmFsc2U7Cj4gKwlpZiAoaW50ZWxfdW5jb3JlX3VuY2xhaW1lZF9tbWlvKCZp
OTE1LT51bmNvcmUpKQo+ICAgCQlEUk1fREVCVUdfRFJJVkVSKCJVbmNsYWltZWQgYWNjZXNzIGR1
cmluZyBzdXNwZW5kLCBiaW9zP1xuIik7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
ID49IDExKSB7Cj4gLQkJYnh0X2Rpc2FibGVfZGM5KGRldl9wcml2KTsKPiAtCQlpY2xfZGlzcGxh
eV9jb3JlX2luaXQoZGV2X3ByaXYsIHRydWUpOwo+IC0JCWlmIChkZXZfcHJpdi0+Y3NyLmRtY19w
YXlsb2FkKSB7Cj4gLQkJCWlmIChkZXZfcHJpdi0+Y3NyLmFsbG93ZWRfZGNfbWFzayAmCj4gKwlp
ZiAoSU5URUxfR0VOKGk5MTUpID49IDExKSB7Cj4gKwkJYnh0X2Rpc2FibGVfZGM5KGk5MTUpOwo+
ICsJCWljbF9kaXNwbGF5X2NvcmVfaW5pdChpOTE1LCB0cnVlKTsKPiArCQlpZiAoaTkxNS0+Y3Ny
LmRtY19wYXlsb2FkKSB7Cj4gKwkJCWlmIChpOTE1LT5jc3IuYWxsb3dlZF9kY19tYXNrICYKPiAg
IAkJCSAgICBEQ19TVEFURV9FTl9VUFRPX0RDNikKPiAtCQkJCXNrbF9lbmFibGVfZGM2KGRldl9w
cml2KTsKPiAtCQkJZWxzZSBpZiAoZGV2X3ByaXYtPmNzci5hbGxvd2VkX2RjX21hc2sgJgo+ICsJ
CQkJc2tsX2VuYWJsZV9kYzYoaTkxNSk7Cj4gKwkJCWVsc2UgaWYgKGk5MTUtPmNzci5hbGxvd2Vk
X2RjX21hc2sgJgo+ICAgCQkJCSBEQ19TVEFURV9FTl9VUFRPX0RDNSkKPiAtCQkJCWdlbjlfZW5h
YmxlX2RjNShkZXZfcHJpdik7Cj4gKwkJCQlnZW45X2VuYWJsZV9kYzUoaTkxNSk7Cj4gICAJCX0K
PiAtCX0gZWxzZSBpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpIHsKPiAtCQlieHRfZGlzYWJsZV9k
YzkoZGV2X3ByaXYpOwo+IC0JCWJ4dF9kaXNwbGF5X2NvcmVfaW5pdChkZXZfcHJpdiwgdHJ1ZSk7
Cj4gLQkJaWYgKGRldl9wcml2LT5jc3IuZG1jX3BheWxvYWQgJiYKPiAtCQkgICAgKGRldl9wcml2
LT5jc3IuYWxsb3dlZF9kY19tYXNrICYgRENfU1RBVEVfRU5fVVBUT19EQzUpKQo+IC0JCQlnZW45
X2VuYWJsZV9kYzUoZGV2X3ByaXYpOwo+IC0JfSBlbHNlIGlmIChJU19IQVNXRUxMKGRldl9wcml2
KSB8fCBJU19CUk9BRFdFTEwoZGV2X3ByaXYpKSB7Cj4gLQkJaHN3X2Rpc2FibGVfcGM4KGRldl9w
cml2KTsKPiAtCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZ
VklFVyhkZXZfcHJpdikpIHsKPiAtCQlyZXQgPSB2bHZfcmVzdW1lX3ByZXBhcmUoZGV2X3ByaXYs
IHRydWUpOwo+ICsJfSBlbHNlIGlmIChJU19HRU45X0xQKGk5MTUpKSB7Cj4gKwkJYnh0X2Rpc2Fi
bGVfZGM5KGk5MTUpOwo+ICsJCWJ4dF9kaXNwbGF5X2NvcmVfaW5pdChpOTE1LCB0cnVlKTsKPiAr
CQlpZiAoaTkxNS0+Y3NyLmRtY19wYXlsb2FkICYmCj4gKwkJICAgIChpOTE1LT5jc3IuYWxsb3dl
ZF9kY19tYXNrICYgRENfU1RBVEVfRU5fVVBUT19EQzUpKQo+ICsJCQlnZW45X2VuYWJsZV9kYzUo
aTkxNSk7Cj4gKwl9IGVsc2UgaWYgKElTX0hBU1dFTEwoaTkxNSkgfHwgSVNfQlJPQURXRUxMKGk5
MTUpKSB7Cj4gKwkJaHN3X2Rpc2FibGVfcGM4KGk5MTUpOwo+ICsJfSBlbHNlIGlmIChJU19WQUxM
RVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiArCQlyZXQgPSB2bHZfcmVz
dW1lX3ByZXBhcmUoaTkxNSwgdHJ1ZSk7Cj4gICAJfQo+ICAgCj4gLQlpbnRlbF91bmNvcmVfcnVu
dGltZV9yZXN1bWUoJmRldl9wcml2LT51bmNvcmUpOwo+ICsJaW50ZWxfdW5jb3JlX3J1bnRpbWVf
cmVzdW1lKCZpOTE1LT51bmNvcmUpOwo+ICAgCj4gLQlpbnRlbF9ydW50aW1lX3BtX2VuYWJsZV9p
bnRlcnJ1cHRzKGRldl9wcml2KTsKPiArCWludGVsX3J1bnRpbWVfcG1fZW5hYmxlX2ludGVycnVw
dHMoaTkxNSk7Cj4gICAKPiAtCWludGVsX3VjX3Jlc3VtZShkZXZfcHJpdik7Cj4gKwlpbnRlbF91
Y19yZXN1bWUoaTkxNSk7Cj4gICAKPiAgIAkvKgo+ICAgCSAqIE5vIHBvaW50IG9mIHJvbGxpbmcg
YmFjayB0aGluZ3MgaW4gY2FzZSBvZiBhbiBlcnJvciwgYXMgdGhlIGJlc3QKPiAgIAkgKiB3ZSBj
YW4gZG8gaXMgdG8gaG9wZSB0aGF0IHRoaW5ncyB3aWxsIHN0aWxsIHdvcmsgKGFuZCBkaXNhYmxl
IFJQTSkuCj4gICAJICovCj4gLQlpOTE1X2dlbV9pbml0X3N3aXp6bGluZyhkZXZfcHJpdik7Cj4g
LQlpOTE1X2dlbV9yZXN0b3JlX2ZlbmNlcyhkZXZfcHJpdik7Cj4gKwlpOTE1X2dlbV9pbml0X3N3
aXp6bGluZyhpOTE1KTsKPiArCWk5MTVfZ2VtX3Jlc3RvcmVfZmVuY2VzKGk5MTUpOwo+ICAgCj4g
ICAJLyoKPiAgIAkgKiBPbiBWTFYvQ0hWIGRpc3BsYXkgaW50ZXJydXB0cyBhcmUgcGFydCBvZiB0
aGUgZGlzcGxheQo+ICAgCSAqIHBvd2VyIHdlbGwsIHNvIGhwZCBpcyByZWluaXRpYWxpemVkIGZy
b20gdGhlcmUuIEZvcgo+ICAgCSAqIGV2ZXJ5b25lIGVsc2UgZG8gaXQgaGVyZS4KPiAgIAkgKi8K
PiAtCWlmICghSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgJiYgIUlTX0NIRVJSWVZJRVcoZGV2X3By
aXYpKQo+IC0JCWludGVsX2hwZF9pbml0KGRldl9wcml2KTsKPiArCWlmICghSVNfVkFMTEVZVklF
VyhpOTE1KSAmJiAhSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiArCQlpbnRlbF9ocGRfaW5pdChpOTE1
KTsKPiAgIAo+IC0JaW50ZWxfZW5hYmxlX2lwYyhkZXZfcHJpdik7Cj4gKwlpbnRlbF9lbmFibGVf
aXBjKGk5MTUpOwo+ICAgCj4gLQllbmFibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7
Cj4gKwllbmFibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhpOTE1KTsKPiAgIAo+ICAgCWlmIChyZXQp
Cj4gICAJCURSTV9FUlJPUigiUnVudGltZSByZXN1bWUgZmFpbGVkLCBkaXNhYmxpbmcgaXQgKCVk
KVxuIiwgcmV0KTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYu
aCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKPiBpbmRleCBlYjk4ZDI4NWQyOTAu
LmExYWRiNzljYTJjMyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Ry
di5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAo+IEBAIC0yMDgsNyAr
MjA4LDcgQEAgc3RydWN0IGk5MTVfbW1fc3RydWN0Owo+ICAgc3RydWN0IGk5MTVfbW11X29iamVj
dDsKPiAgIAo+ICAgc3RydWN0IGRybV9pOTE1X2ZpbGVfcHJpdmF0ZSB7Cj4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NTsKPiAgIAlzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGU7Cj4gICAKPiAgIAlzdHJ1Y3Qgewo+IEBAIC0y
NzgsMTIgKzI3OCwxMiBAQCBzdHJ1Y3QgZHBsbDsKPiAgIHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0
ZTsKPiAgIAo+ICAgc3RydWN0IGRybV9pOTE1X2Rpc3BsYXlfZnVuY3Mgewo+IC0Jdm9pZCAoKmdl
dF9jZGNsaykoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICsJdm9pZCAoKmdl
dF9jZGNsaykoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgIHN0cnVjdCBp
bnRlbF9jZGNsa19zdGF0ZSAqY2RjbGtfc3RhdGUpOwo+IC0Jdm9pZCAoKnNldF9jZGNsaykoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICsJdm9pZCAoKnNldF9jZGNsaykoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9j
ZGNsa19zdGF0ZSAqY2RjbGtfc3RhdGUsCj4gICAJCQkgIGVudW0gcGlwZSBwaXBlKTsKPiAtCWlu
dCAoKmdldF9maWZvX3NpemUpKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAr
CWludCAoKmdldF9maWZvX3NpemUpKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAg
CQkJICAgICBlbnVtIGk5eHhfcGxhbmVfaWQgaTl4eF9wbGFuZSk7Cj4gICAJaW50ICgqY29tcHV0
ZV9waXBlX3dtKShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlKTsKPiAgIAlpbnQgKCpj
b21wdXRlX2ludGVybWVkaWF0ZV93bSkoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld3N0YXRl
KTsKPiBAQCAtMzE3LDggKzMxNyw4IEBAIHN0cnVjdCBkcm1faTkxNV9kaXNwbGF5X2Z1bmNzIHsK
PiAgIAkJCQkgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKm9sZF9jb25uX3N0
YXRlKTsKPiAgIAl2b2lkICgqZmRpX2xpbmtfdHJhaW4pKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
LAo+ICAgCQkJICAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
KTsKPiAtCXZvaWQgKCppbml0X2Nsb2NrX2dhdGluZykoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KTsKPiAtCXZvaWQgKCpocGRfaXJxX3NldHVwKShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpOwo+ICsJdm9pZCAoKmluaXRfY2xvY2tfZ2F0aW5nKShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gKwl2b2lkICgqaHBkX2lycV9zZXR1cCkoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgCS8qIGNsb2NrIHVwZGF0ZXMgZm9yIG1vZGUgc2V0
ICovCj4gICAJLyogY3Vyc29yIHVwZGF0ZXMgKi8KPiAgIAkvKiByZW5kZXIgY2xvY2sgaW5jcmVh
c2UvZGVjcmVhc2UgKi8KPiBAQCAtNTUyLDcgKzU1Miw3IEBAIHN0cnVjdCBpbnRlbF9nbWJ1cyB7
Cj4gICAJdTMyIHJlZzA7Cj4gICAJaTkxNV9yZWdfdCBncGlvX3JlZzsKPiAgIAlzdHJ1Y3QgaTJj
X2FsZ29fYml0X2RhdGEgYml0X2FsZ287Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNTsKPiAgIH07Cj4gICAKPiAg
IHN0cnVjdCBpOTE1X3N1c3BlbmRfc2F2ZWRfcmVnaXN0ZXJzIHsKPiBAQCAtNjQxLDcgKzY0MSw3
IEBAIHN0cnVjdCBpbnRlbF9ycHMgewo+ICAgCj4gICAJLyoKPiAgIAkgKiB3b3JrLCBpbnRlcnJ1
cHRzX2VuYWJsZWQgYW5kIHBtX2lpciBhcmUgcHJvdGVjdGVkIGJ5Cj4gLQkgKiBkZXZfcHJpdi0+
aXJxX2xvY2sKPiArCSAqIGk5MTUtPmlycV9sb2NrCj4gICAJICovCj4gICAJc3RydWN0IHdvcmtf
c3RydWN0IHdvcms7Cj4gICAJYm9vbCBpbnRlcnJ1cHRzX2VuYWJsZWQ7Cj4gQEAgLTEyNDAsOSAr
MTI0MCw5IEBAIHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtX29wcyB7Cj4gICAgKi8KPiAgIHN0cnVj
dCBpOTE1X3BlcmZfc3RyZWFtIHsKPiAgIAkvKioKPiAtCSAqIEBkZXZfcHJpdjogaTkxNSBkcm0g
ZGV2aWNlCj4gKwkgKiBAaTkxNTogaTkxNSBkcm0gZGV2aWNlCj4gICAJICovCj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNTsKPiAgIAo+ICAgCS8qKgo+ICAgCSAqIEBsaW5rOiBMaW5rcyB0aGUgc3RyZWFtIGludG8g
YGAmZHJtX2k5MTVfcHJpdmF0ZS0+c3RyZWFtc2BgCj4gQEAgLTEzMDIsMjAgKzEzMDIsMjAgQEAg
c3RydWN0IGk5MTVfb2Ffb3BzIHsKPiAgIAkgKiBAaXNfdmFsaWRfYl9jb3VudGVyX3JlZzogVmFs
aWRhdGVzIHJlZ2lzdGVyJ3MgYWRkcmVzcyBmb3IKPiAgIAkgKiBwcm9ncmFtbWluZyBib29sZWFu
IGNvdW50ZXJzIGZvciBhIHBhcnRpY3VsYXIgcGxhdGZvcm0uCj4gICAJICovCj4gLQlib29sICgq
aXNfdmFsaWRfYl9jb3VudGVyX3JlZykoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ICsJYm9vbCAoKmlzX3ZhbGlkX2JfY291bnRlcl9yZWcpKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAo+ICAgCQkJCSAgICAgICB1MzIgYWRkcik7Cj4gICAKPiAgIAkvKioKPiAgIAkg
KiBAaXNfdmFsaWRfbXV4X3JlZzogVmFsaWRhdGVzIHJlZ2lzdGVyJ3MgYWRkcmVzcyBmb3IgcHJv
Z3JhbW1pbmcgbXV4Cj4gICAJICogZm9yIGEgcGFydGljdWxhciBwbGF0Zm9ybS4KPiAgIAkgKi8K
PiAtCWJvb2wgKCppc192YWxpZF9tdXhfcmVnKShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsIHUzMiBhZGRyKTsKPiArCWJvb2wgKCppc192YWxpZF9tdXhfcmVnKShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIGFkZHIpOwo+ICAgCj4gICAJLyoqCj4gICAJICogQGlz
X3ZhbGlkX2ZsZXhfcmVnOiBWYWxpZGF0ZXMgcmVnaXN0ZXIncyBhZGRyZXNzIGZvciBwcm9ncmFt
bWluZwo+ICAgCSAqIGZsZXggRVUgZmlsdGVyaW5nIGZvciBhIHBhcnRpY3VsYXIgcGxhdGZvcm0u
Cj4gICAJICovCj4gLQlib29sICgqaXNfdmFsaWRfZmxleF9yZWcpKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwgdTMyIGFkZHIpOwo+ICsJYm9vbCAoKmlzX3ZhbGlkX2ZsZXhfcmVn
KShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIGFkZHIpOwo+ICAgCj4gICAJLyoq
Cj4gICAJICogQGVuYWJsZV9tZXRyaWNfc2V0OiBTZWxlY3RzIGFuZCBhcHBsaWVzIGFueSBNVVgg
Y29uZmlndXJhdGlvbiB0byBzZXQKPiBAQCAtMTMyOSw3ICsxMzI5LDcgQEAgc3RydWN0IGk5MTVf
b2Ffb3BzIHsKPiAgIAkgKiBAZGlzYWJsZV9tZXRyaWNfc2V0OiBSZW1vdmUgc3lzdGVtIGNvbnN0
cmFpbnRzIGFzc29jaWF0ZWQgd2l0aCB1c2luZwo+ICAgCSAqIHRoZSBPQSB1bml0Lgo+ICAgCSAq
Lwo+IC0Jdm9pZCAoKmRpc2FibGVfbWV0cmljX3NldCkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KTsKPiArCXZvaWQgKCpkaXNhYmxlX21ldHJpY19zZXQpKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KTsKPiAgIAo+ICAgCS8qKgo+ICAgCSAqIEBvYV9lbmFibGU6IEVuYWJs
ZSBwZXJpb2RpYyBzYW1wbGluZwo+IEBAIC0xMzU3LDcgKzEzNTcsNyBAQCBzdHJ1Y3QgaTkxNV9v
YV9vcHMgewo+ICAgCSAqIGhhbmRsaW5nIHRoZSBPQSB1bml0IHRhaWwgcG9pbnRlciByYWNlIHRo
YXQgYWZmZWN0cyBtdWx0aXBsZQo+ICAgCSAqIGdlbmVyYXRpb25zLgo+ICAgCSAqLwo+IC0JdTMy
ICgqb2FfaHdfdGFpbF9yZWFkKShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+
ICsJdTMyICgqb2FfaHdfdGFpbF9yZWFkKShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7
Cj4gICB9Owo+ICAgCj4gICBzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgewo+IEBAIC0xNzUwLDEz
ICsxNzUwLDEzIEBAIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlIHsKPiAgIAo+ICAgCQkvKgo+ICAg
CQkgKiBMb2NrIGFzc29jaWF0ZWQgd2l0aCBhZGRpbmcvbW9kaWZ5aW5nL3JlbW92aW5nIE9BIGNv
bmZpZ3MKPiAtCQkgKiBpbiBkZXZfcHJpdi0+cGVyZi5tZXRyaWNzX2lkci4KPiArCQkgKiBpbiBp
OTE1LT5wZXJmLm1ldHJpY3NfaWRyLgo+ICAgCQkgKi8KPiAgIAkJc3RydWN0IG11dGV4IG1ldHJp
Y3NfbG9jazsKPiAgIAo+ICAgCQkvKgo+ICAgCQkgKiBMaXN0IG9mIGR5bmFtaWMgY29uZmlndXJh
dGlvbnMsIHlvdSBuZWVkIHRvIGhvbGQKPiAtCQkgKiBkZXZfcHJpdi0+cGVyZi5tZXRyaWNzX2xv
Y2sgdG8gYWNjZXNzIGl0Lgo+ICsJCSAqIGk5MTUtPnBlcmYubWV0cmljc19sb2NrIHRvIGFjY2Vz
cyBpdC4KPiAgIAkJICovCj4gICAJCXN0cnVjdCBpZHIgbWV0cmljc19pZHI7Cj4gICAKPiBAQCAt
MTc3Miw3ICsxNzcyLDcgQEAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgewo+ICAgCQkJICogVGhl
IHN0cmVhbSBjdXJyZW50bHkgdXNpbmcgdGhlIE9BIHVuaXQuIElmIGFjY2Vzc2VkCj4gICAJCQkg
KiBvdXRzaWRlIGEgc3lzY2FsbCBhc3NvY2lhdGVkIHRvIGl0cyBmaWxlCj4gICAJCQkgKiBkZXNj
cmlwdG9yLCB5b3UgbmVlZCB0byBob2xkCj4gLQkJCSAqIGRldl9wcml2LT5kcm0uc3RydWN0X211
dGV4Lgo+ICsJCQkgKiBpOTE1LT5kcm0uc3RydWN0X211dGV4Lgo+ICAgCQkJICovCj4gICAJCQlz
dHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqZXhjbHVzaXZlX3N0cmVhbTsKPiAgIAo+IEBAIC0yMDY2
LDE1ICsyMDY2LDE1IEBAIGVudW0gaGRtaV9mb3JjZV9hdWRpbyB7Cj4gICAJR0VOTUFTSyhJTlRF
TF9GUk9OVEJVRkZFUl9CSVRTX1BFUl9QSVBFICogKChwaXBlKSArIDEpIC0gMSwgXAo+ICAgCQlJ
TlRFTF9GUk9OVEJVRkZFUl9CSVRTX1BFUl9QSVBFICogKHBpcGUpKQo+ICAgCj4gLSNkZWZpbmUg
SU5URUxfSU5GTyhkZXZfcHJpdikJKCYoZGV2X3ByaXYpLT5fX2luZm8pCj4gLSNkZWZpbmUgUlVO
VElNRV9JTkZPKGRldl9wcml2KQkoJihkZXZfcHJpdiktPl9fcnVudGltZSkKPiAtI2RlZmluZSBE
UklWRVJfQ0FQUyhkZXZfcHJpdikJKCYoZGV2X3ByaXYpLT5jYXBzKQo+ICsjZGVmaW5lIElOVEVM
X0lORk8oaTkxNSkJKCYoaTkxNSktPl9faW5mbykKPiArI2RlZmluZSBSVU5USU1FX0lORk8oaTkx
NSkJKCYoaTkxNSktPl9fcnVudGltZSkKPiArI2RlZmluZSBEUklWRVJfQ0FQUyhpOTE1KQkoJihp
OTE1KS0+Y2FwcykKPiAgIAo+IC0jZGVmaW5lIElOVEVMX0dFTihkZXZfcHJpdikJKElOVEVMX0lO
Rk8oZGV2X3ByaXYpLT5nZW4pCj4gLSNkZWZpbmUgSU5URUxfREVWSUQoZGV2X3ByaXYpCShSVU5U
SU1FX0lORk8oZGV2X3ByaXYpLT5kZXZpY2VfaWQpCj4gKyNkZWZpbmUgSU5URUxfR0VOKGk5MTUp
CShJTlRFTF9JTkZPKGk5MTUpLT5nZW4pCj4gKyNkZWZpbmUgSU5URUxfREVWSUQoaTkxNSkJKFJV
TlRJTUVfSU5GTyhpOTE1KS0+ZGV2aWNlX2lkKQo+ICAgCj4gICAjZGVmaW5lIFJFVklEX0ZPUkVW
RVIJCTB4ZmYKPiAtI2RlZmluZSBJTlRFTF9SRVZJRChkZXZfcHJpdikJKChkZXZfcHJpdiktPmRy
bS5wZGV2LT5yZXZpc2lvbikKPiArI2RlZmluZSBJTlRFTF9SRVZJRChpOTE1KQkoKGk5MTUpLT5k
cm0ucGRldi0+cmV2aXNpb24pCj4gICAKPiAgICNkZWZpbmUgSU5URUxfR0VOX01BU0socywgZSkg
KCBcCj4gICAJQlVJTERfQlVHX09OX1pFUk8oIV9fYnVpbHRpbl9jb25zdGFudF9wKHMpKSArIFwK
PiBAQCAtMjA4MiwxMiArMjA4MiwxMiBAQCBlbnVtIGhkbWlfZm9yY2VfYXVkaW8gewo+ICAgCUdF
Tk1BU0soKGUpIC0gMSwgKHMpIC0gMSkpCj4gICAKPiAgIC8qIFJldHVybnMgdHJ1ZSBpZiBHZW4g
aXMgaW4gaW5jbHVzaXZlIHJhbmdlIFtTdGFydCwgRW5kXSAqLwo+IC0jZGVmaW5lIElTX0dFTl9S
QU5HRShkZXZfcHJpdiwgcywgZSkgXAo+IC0JKCEhKElOVEVMX0lORk8oZGV2X3ByaXYpLT5nZW5f
bWFzayAmIElOVEVMX0dFTl9NQVNLKChzKSwgKGUpKSkpCj4gKyNkZWZpbmUgSVNfR0VOX1JBTkdF
KGk5MTUsIHMsIGUpIFwKPiArCSghIShJTlRFTF9JTkZPKGk5MTUpLT5nZW5fbWFzayAmIElOVEVM
X0dFTl9NQVNLKChzKSwgKGUpKSkpCj4gICAKPiAtI2RlZmluZSBJU19HRU4oZGV2X3ByaXYsIG4p
IFwKPiArI2RlZmluZSBJU19HRU4oaTkxNSwgbikgXAo+ICAgCShCVUlMRF9CVUdfT05fWkVSTygh
X19idWlsdGluX2NvbnN0YW50X3AobikpICsgXAo+IC0JIElOVEVMX0lORk8oZGV2X3ByaXYpLT5n
ZW4gPT0gKG4pKQo+ICsJIElOVEVMX0lORk8oaTkxNSktPmdlbiA9PSAobikpCj4gICAKPiAgIC8q
Cj4gICAgKiBSZXR1cm4gdHJ1ZSBpZiByZXZpc2lvbiBpcyBpbiByYW5nZSBbc2luY2UsdW50aWxd
IGluY2x1c2l2ZS4KPiBAQCAtMjE1OSw4OCArMjE1OSw4OCBAQCBJU19TVUJQTEFURk9STShjb25z
dCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAlyZXR1cm4gKChtYXNrIDw8ICht
c2IgLSBwYikpICYgKG1hc2sgPDwgKG1zYiAtIHMpKSkgJiBCSVQobXNiKTsKPiAgIH0KPiAgIAo+
IC0jZGVmaW5lIElTX01PQklMRShkZXZfcHJpdikJKElOVEVMX0lORk8oZGV2X3ByaXYpLT5pc19t
b2JpbGUpCj4gLQo+IC0jZGVmaW5lIElTX0k4MzAoZGV2X3ByaXYpCUlTX1BMQVRGT1JNKGRldl9w
cml2LCBJTlRFTF9JODMwKQo+IC0jZGVmaW5lIElTX0k4NDVHKGRldl9wcml2KQlJU19QTEFURk9S
TShkZXZfcHJpdiwgSU5URUxfSTg0NUcpCj4gLSNkZWZpbmUgSVNfSTg1WChkZXZfcHJpdikJSVNf
UExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX0k4NVgpCj4gLSNkZWZpbmUgSVNfSTg2NUcoZGV2X3By
aXYpCUlTX1BMQVRGT1JNKGRldl9wcml2LCBJTlRFTF9JODY1RykKPiAtI2RlZmluZSBJU19JOTE1
RyhkZXZfcHJpdikJSVNfUExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX0k5MTVHKQo+IC0jZGVmaW5l
IElTX0k5MTVHTShkZXZfcHJpdikJSVNfUExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX0k5MTVHTSkK
PiAtI2RlZmluZSBJU19JOTQ1RyhkZXZfcHJpdikJSVNfUExBVEZPUk0oZGV2X3ByaXYsIElOVEVM
X0k5NDVHKQo+IC0jZGVmaW5lIElTX0k5NDVHTShkZXZfcHJpdikJSVNfUExBVEZPUk0oZGV2X3By
aXYsIElOVEVMX0k5NDVHTSkKPiAtI2RlZmluZSBJU19JOTY1RyhkZXZfcHJpdikJSVNfUExBVEZP
Uk0oZGV2X3ByaXYsIElOVEVMX0k5NjVHKQo+IC0jZGVmaW5lIElTX0k5NjVHTShkZXZfcHJpdikJ
SVNfUExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX0k5NjVHTSkKPiAtI2RlZmluZSBJU19HNDUoZGV2
X3ByaXYpCUlTX1BMQVRGT1JNKGRldl9wcml2LCBJTlRFTF9HNDUpCj4gLSNkZWZpbmUgSVNfR000
NShkZXZfcHJpdikJSVNfUExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX0dNNDUpCj4gLSNkZWZpbmUg
SVNfRzRYKGRldl9wcml2KQkoSVNfRzQ1KGRldl9wcml2KSB8fCBJU19HTTQ1KGRldl9wcml2KSkK
PiAtI2RlZmluZSBJU19QSU5FVklFVyhkZXZfcHJpdikJSVNfUExBVEZPUk0oZGV2X3ByaXYsIElO
VEVMX1BJTkVWSUVXKQo+IC0jZGVmaW5lIElTX0czMyhkZXZfcHJpdikJSVNfUExBVEZPUk0oZGV2
X3ByaXYsIElOVEVMX0czMykKPiAtI2RlZmluZSBJU19JUk9OTEFLRShkZXZfcHJpdikJSVNfUExB
VEZPUk0oZGV2X3ByaXYsIElOVEVMX0lST05MQUtFKQo+IC0jZGVmaW5lIElTX0lST05MQUtFX00o
ZGV2X3ByaXYpIFwKPiAtCShJU19QTEFURk9STShkZXZfcHJpdiwgSU5URUxfSVJPTkxBS0UpICYm
IElTX01PQklMRShkZXZfcHJpdikpCj4gLSNkZWZpbmUgSVNfSVZZQlJJREdFKGRldl9wcml2KQlJ
U19QTEFURk9STShkZXZfcHJpdiwgSU5URUxfSVZZQlJJREdFKQo+IC0jZGVmaW5lIElTX0lWQl9H
VDEoZGV2X3ByaXYpCShJU19JVllCUklER0UoZGV2X3ByaXYpICYmIFwKPiAtCQkJCSBJTlRFTF9J
TkZPKGRldl9wcml2KS0+Z3QgPT0gMSkKPiAtI2RlZmluZSBJU19WQUxMRVlWSUVXKGRldl9wcml2
KQlJU19QTEFURk9STShkZXZfcHJpdiwgSU5URUxfVkFMTEVZVklFVykKPiAtI2RlZmluZSBJU19D
SEVSUllWSUVXKGRldl9wcml2KQlJU19QTEFURk9STShkZXZfcHJpdiwgSU5URUxfQ0hFUlJZVklF
VykKPiAtI2RlZmluZSBJU19IQVNXRUxMKGRldl9wcml2KQlJU19QTEFURk9STShkZXZfcHJpdiwg
SU5URUxfSEFTV0VMTCkKPiAtI2RlZmluZSBJU19CUk9BRFdFTEwoZGV2X3ByaXYpCUlTX1BMQVRG
T1JNKGRldl9wcml2LCBJTlRFTF9CUk9BRFdFTEwpCj4gLSNkZWZpbmUgSVNfU0tZTEFLRShkZXZf
cHJpdikJSVNfUExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX1NLWUxBS0UpCj4gLSNkZWZpbmUgSVNf
QlJPWFRPTihkZXZfcHJpdikJSVNfUExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX0JST1hUT04pCj4g
LSNkZWZpbmUgSVNfS0FCWUxBS0UoZGV2X3ByaXYpCUlTX1BMQVRGT1JNKGRldl9wcml2LCBJTlRF
TF9LQUJZTEFLRSkKPiAtI2RlZmluZSBJU19HRU1JTklMQUtFKGRldl9wcml2KQlJU19QTEFURk9S
TShkZXZfcHJpdiwgSU5URUxfR0VNSU5JTEFLRSkKPiAtI2RlZmluZSBJU19DT0ZGRUVMQUtFKGRl
dl9wcml2KQlJU19QTEFURk9STShkZXZfcHJpdiwgSU5URUxfQ09GRkVFTEFLRSkKPiAtI2RlZmlu
ZSBJU19DQU5OT05MQUtFKGRldl9wcml2KQlJU19QTEFURk9STShkZXZfcHJpdiwgSU5URUxfQ0FO
Tk9OTEFLRSkKPiAtI2RlZmluZSBJU19JQ0VMQUtFKGRldl9wcml2KQlJU19QTEFURk9STShkZXZf
cHJpdiwgSU5URUxfSUNFTEFLRSkKPiAtI2RlZmluZSBJU19FTEtIQVJUTEFLRShkZXZfcHJpdikJ
SVNfUExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX0VMS0hBUlRMQUtFKQo+IC0jZGVmaW5lIElTX0hT
V19FQVJMWV9TRFYoZGV2X3ByaXYpIChJU19IQVNXRUxMKGRldl9wcml2KSAmJiBcCj4gLQkJCQkg
ICAgKElOVEVMX0RFVklEKGRldl9wcml2KSAmIDB4RkYwMCkgPT0gMHgwQzAwKQo+IC0jZGVmaW5l
IElTX0JEV19VTFQoZGV2X3ByaXYpIFwKPiAtCUlTX1NVQlBMQVRGT1JNKGRldl9wcml2LCBJTlRF
TF9CUk9BRFdFTEwsIElOVEVMX1NVQlBMQVRGT1JNX1VMVCkKPiAtI2RlZmluZSBJU19CRFdfVUxY
KGRldl9wcml2KSBcCj4gLQlJU19TVUJQTEFURk9STShkZXZfcHJpdiwgSU5URUxfQlJPQURXRUxM
LCBJTlRFTF9TVUJQTEFURk9STV9VTFgpCj4gLSNkZWZpbmUgSVNfQkRXX0dUMyhkZXZfcHJpdikJ
KElTX0JST0FEV0VMTChkZXZfcHJpdikgJiYgXAo+IC0JCQkJIElOVEVMX0lORk8oZGV2X3ByaXYp
LT5ndCA9PSAzKQo+IC0jZGVmaW5lIElTX0hTV19VTFQoZGV2X3ByaXYpIFwKPiAtCUlTX1NVQlBM
QVRGT1JNKGRldl9wcml2LCBJTlRFTF9IQVNXRUxMLCBJTlRFTF9TVUJQTEFURk9STV9VTFQpCj4g
LSNkZWZpbmUgSVNfSFNXX0dUMyhkZXZfcHJpdikJKElTX0hBU1dFTEwoZGV2X3ByaXYpICYmIFwK
PiAtCQkJCSBJTlRFTF9JTkZPKGRldl9wcml2KS0+Z3QgPT0gMykKPiAtI2RlZmluZSBJU19IU1df
R1QxKGRldl9wcml2KQkoSVNfSEFTV0VMTChkZXZfcHJpdikgJiYgXAo+IC0JCQkJIElOVEVMX0lO
Rk8oZGV2X3ByaXYpLT5ndCA9PSAxKQo+ICsjZGVmaW5lIElTX01PQklMRShpOTE1KQkoSU5URUxf
SU5GTyhpOTE1KS0+aXNfbW9iaWxlKQo+ICsKPiArI2RlZmluZSBJU19JODMwKGk5MTUpCUlTX1BM
QVRGT1JNKGk5MTUsIElOVEVMX0k4MzApCj4gKyNkZWZpbmUgSVNfSTg0NUcoaTkxNSkJSVNfUExB
VEZPUk0oaTkxNSwgSU5URUxfSTg0NUcpCj4gKyNkZWZpbmUgSVNfSTg1WChpOTE1KQlJU19QTEFU
Rk9STShpOTE1LCBJTlRFTF9JODVYKQo+ICsjZGVmaW5lIElTX0k4NjVHKGk5MTUpCUlTX1BMQVRG
T1JNKGk5MTUsIElOVEVMX0k4NjVHKQo+ICsjZGVmaW5lIElTX0k5MTVHKGk5MTUpCUlTX1BMQVRG
T1JNKGk5MTUsIElOVEVMX0k5MTVHKQo+ICsjZGVmaW5lIElTX0k5MTVHTShpOTE1KQlJU19QTEFU
Rk9STShpOTE1LCBJTlRFTF9JOTE1R00pCj4gKyNkZWZpbmUgSVNfSTk0NUcoaTkxNSkJSVNfUExB
VEZPUk0oaTkxNSwgSU5URUxfSTk0NUcpCj4gKyNkZWZpbmUgSVNfSTk0NUdNKGk5MTUpCUlTX1BM
QVRGT1JNKGk5MTUsIElOVEVMX0k5NDVHTSkKPiArI2RlZmluZSBJU19JOTY1RyhpOTE1KQlJU19Q
TEFURk9STShpOTE1LCBJTlRFTF9JOTY1RykKPiArI2RlZmluZSBJU19JOTY1R00oaTkxNSkJSVNf
UExBVEZPUk0oaTkxNSwgSU5URUxfSTk2NUdNKQo+ICsjZGVmaW5lIElTX0c0NShpOTE1KQlJU19Q
TEFURk9STShpOTE1LCBJTlRFTF9HNDUpCj4gKyNkZWZpbmUgSVNfR000NShpOTE1KQlJU19QTEFU
Rk9STShpOTE1LCBJTlRFTF9HTTQ1KQo+ICsjZGVmaW5lIElTX0c0WChpOTE1KQkoSVNfRzQ1KGk5
MTUpIHx8IElTX0dNNDUoaTkxNSkpCj4gKyNkZWZpbmUgSVNfUElORVZJRVcoaTkxNSkJSVNfUExB
VEZPUk0oaTkxNSwgSU5URUxfUElORVZJRVcpCj4gKyNkZWZpbmUgSVNfRzMzKGk5MTUpCUlTX1BM
QVRGT1JNKGk5MTUsIElOVEVMX0czMykKPiArI2RlZmluZSBJU19JUk9OTEFLRShpOTE1KQlJU19Q
TEFURk9STShpOTE1LCBJTlRFTF9JUk9OTEFLRSkKPiArI2RlZmluZSBJU19JUk9OTEFLRV9NKGk5
MTUpIFwKPiArCShJU19QTEFURk9STShpOTE1LCBJTlRFTF9JUk9OTEFLRSkgJiYgSVNfTU9CSUxF
KGk5MTUpKQo+ICsjZGVmaW5lIElTX0lWWUJSSURHRShpOTE1KQlJU19QTEFURk9STShpOTE1LCBJ
TlRFTF9JVllCUklER0UpCj4gKyNkZWZpbmUgSVNfSVZCX0dUMShpOTE1KQkoSVNfSVZZQlJJREdF
KGk5MTUpICYmIFwKPiArCQkJCSBJTlRFTF9JTkZPKGk5MTUpLT5ndCA9PSAxKQo+ICsjZGVmaW5l
IElTX1ZBTExFWVZJRVcoaTkxNSkJSVNfUExBVEZPUk0oaTkxNSwgSU5URUxfVkFMTEVZVklFVykK
PiArI2RlZmluZSBJU19DSEVSUllWSUVXKGk5MTUpCUlTX1BMQVRGT1JNKGk5MTUsIElOVEVMX0NI
RVJSWVZJRVcpCj4gKyNkZWZpbmUgSVNfSEFTV0VMTChpOTE1KQlJU19QTEFURk9STShpOTE1LCBJ
TlRFTF9IQVNXRUxMKQo+ICsjZGVmaW5lIElTX0JST0FEV0VMTChpOTE1KQlJU19QTEFURk9STShp
OTE1LCBJTlRFTF9CUk9BRFdFTEwpCj4gKyNkZWZpbmUgSVNfU0tZTEFLRShpOTE1KQlJU19QTEFU
Rk9STShpOTE1LCBJTlRFTF9TS1lMQUtFKQo+ICsjZGVmaW5lIElTX0JST1hUT04oaTkxNSkJSVNf
UExBVEZPUk0oaTkxNSwgSU5URUxfQlJPWFRPTikKPiArI2RlZmluZSBJU19LQUJZTEFLRShpOTE1
KQlJU19QTEFURk9STShpOTE1LCBJTlRFTF9LQUJZTEFLRSkKPiArI2RlZmluZSBJU19HRU1JTklM
QUtFKGk5MTUpCUlTX1BMQVRGT1JNKGk5MTUsIElOVEVMX0dFTUlOSUxBS0UpCj4gKyNkZWZpbmUg
SVNfQ09GRkVFTEFLRShpOTE1KQlJU19QTEFURk9STShpOTE1LCBJTlRFTF9DT0ZGRUVMQUtFKQo+
ICsjZGVmaW5lIElTX0NBTk5PTkxBS0UoaTkxNSkJSVNfUExBVEZPUk0oaTkxNSwgSU5URUxfQ0FO
Tk9OTEFLRSkKPiArI2RlZmluZSBJU19JQ0VMQUtFKGk5MTUpCUlTX1BMQVRGT1JNKGk5MTUsIElO
VEVMX0lDRUxBS0UpCj4gKyNkZWZpbmUgSVNfRUxLSEFSVExBS0UoaTkxNSkJSVNfUExBVEZPUk0o
aTkxNSwgSU5URUxfRUxLSEFSVExBS0UpCj4gKyNkZWZpbmUgSVNfSFNXX0VBUkxZX1NEVihpOTE1
KSAoSVNfSEFTV0VMTChpOTE1KSAmJiBcCj4gKwkJCQkgICAgKElOVEVMX0RFVklEKGk5MTUpICYg
MHhGRjAwKSA9PSAweDBDMDApCj4gKyNkZWZpbmUgSVNfQkRXX1VMVChpOTE1KSBcCj4gKwlJU19T
VUJQTEFURk9STShpOTE1LCBJTlRFTF9CUk9BRFdFTEwsIElOVEVMX1NVQlBMQVRGT1JNX1VMVCkK
PiArI2RlZmluZSBJU19CRFdfVUxYKGk5MTUpIFwKPiArCUlTX1NVQlBMQVRGT1JNKGk5MTUsIElO
VEVMX0JST0FEV0VMTCwgSU5URUxfU1VCUExBVEZPUk1fVUxYKQo+ICsjZGVmaW5lIElTX0JEV19H
VDMoaTkxNSkJKElTX0JST0FEV0VMTChpOTE1KSAmJiBcCj4gKwkJCQkgSU5URUxfSU5GTyhpOTE1
KS0+Z3QgPT0gMykKPiArI2RlZmluZSBJU19IU1dfVUxUKGk5MTUpIFwKPiArCUlTX1NVQlBMQVRG
T1JNKGk5MTUsIElOVEVMX0hBU1dFTEwsIElOVEVMX1NVQlBMQVRGT1JNX1VMVCkKPiArI2RlZmlu
ZSBJU19IU1dfR1QzKGk5MTUpCShJU19IQVNXRUxMKGk5MTUpICYmIFwKPiArCQkJCSBJTlRFTF9J
TkZPKGk5MTUpLT5ndCA9PSAzKQo+ICsjZGVmaW5lIElTX0hTV19HVDEoaTkxNSkJKElTX0hBU1dF
TEwoaTkxNSkgJiYgXAo+ICsJCQkJIElOVEVMX0lORk8oaTkxNSktPmd0ID09IDEpCj4gICAvKiBV
TFggbWFjaGluZXMgYXJlIGFsc28gY29uc2lkZXJlZCBVTFQuICovCj4gLSNkZWZpbmUgSVNfSFNX
X1VMWChkZXZfcHJpdikgXAo+IC0JSVNfU1VCUExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX0hBU1dF
TEwsIElOVEVMX1NVQlBMQVRGT1JNX1VMWCkKPiAtI2RlZmluZSBJU19TS0xfVUxUKGRldl9wcml2
KSBcCj4gLQlJU19TVUJQTEFURk9STShkZXZfcHJpdiwgSU5URUxfU0tZTEFLRSwgSU5URUxfU1VC
UExBVEZPUk1fVUxUKQo+IC0jZGVmaW5lIElTX1NLTF9VTFgoZGV2X3ByaXYpIFwKPiAtCUlTX1NV
QlBMQVRGT1JNKGRldl9wcml2LCBJTlRFTF9TS1lMQUtFLCBJTlRFTF9TVUJQTEFURk9STV9VTFgp
Cj4gLSNkZWZpbmUgSVNfS0JMX1VMVChkZXZfcHJpdikgXAo+IC0JSVNfU1VCUExBVEZPUk0oZGV2
X3ByaXYsIElOVEVMX0tBQllMQUtFLCBJTlRFTF9TVUJQTEFURk9STV9VTFQpCj4gLSNkZWZpbmUg
SVNfS0JMX1VMWChkZXZfcHJpdikgXAo+IC0JSVNfU1VCUExBVEZPUk0oZGV2X3ByaXYsIElOVEVM
X0tBQllMQUtFLCBJTlRFTF9TVUJQTEFURk9STV9VTFgpCj4gLSNkZWZpbmUgSVNfU0tMX0dUMihk
ZXZfcHJpdikJKElTX1NLWUxBS0UoZGV2X3ByaXYpICYmIFwKPiAtCQkJCSBJTlRFTF9JTkZPKGRl
dl9wcml2KS0+Z3QgPT0gMikKPiAtI2RlZmluZSBJU19TS0xfR1QzKGRldl9wcml2KQkoSVNfU0tZ
TEFLRShkZXZfcHJpdikgJiYgXAo+IC0JCQkJIElOVEVMX0lORk8oZGV2X3ByaXYpLT5ndCA9PSAz
KQo+IC0jZGVmaW5lIElTX1NLTF9HVDQoZGV2X3ByaXYpCShJU19TS1lMQUtFKGRldl9wcml2KSAm
JiBcCj4gLQkJCQkgSU5URUxfSU5GTyhkZXZfcHJpdiktPmd0ID09IDQpCj4gLSNkZWZpbmUgSVNf
S0JMX0dUMihkZXZfcHJpdikJKElTX0tBQllMQUtFKGRldl9wcml2KSAmJiBcCj4gLQkJCQkgSU5U
RUxfSU5GTyhkZXZfcHJpdiktPmd0ID09IDIpCj4gLSNkZWZpbmUgSVNfS0JMX0dUMyhkZXZfcHJp
dikJKElTX0tBQllMQUtFKGRldl9wcml2KSAmJiBcCj4gLQkJCQkgSU5URUxfSU5GTyhkZXZfcHJp
diktPmd0ID09IDMpCj4gLSNkZWZpbmUgSVNfQ0ZMX1VMVChkZXZfcHJpdikgXAo+IC0JSVNfU1VC
UExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX0NPRkZFRUxBS0UsIElOVEVMX1NVQlBMQVRGT1JNX1VM
VCkKPiAtI2RlZmluZSBJU19DRkxfVUxYKGRldl9wcml2KSBcCj4gLQlJU19TVUJQTEFURk9STShk
ZXZfcHJpdiwgSU5URUxfQ09GRkVFTEFLRSwgSU5URUxfU1VCUExBVEZPUk1fVUxYKQo+IC0jZGVm
aW5lIElTX0NGTF9HVDIoZGV2X3ByaXYpCShJU19DT0ZGRUVMQUtFKGRldl9wcml2KSAmJiBcCj4g
LQkJCQkgSU5URUxfSU5GTyhkZXZfcHJpdiktPmd0ID09IDIpCj4gLSNkZWZpbmUgSVNfQ0ZMX0dU
MyhkZXZfcHJpdikJKElTX0NPRkZFRUxBS0UoZGV2X3ByaXYpICYmIFwKPiAtCQkJCSBJTlRFTF9J
TkZPKGRldl9wcml2KS0+Z3QgPT0gMykKPiAtI2RlZmluZSBJU19DTkxfV0lUSF9QT1JUX0YoZGV2
X3ByaXYpIFwKPiAtCUlTX1NVQlBMQVRGT1JNKGRldl9wcml2LCBJTlRFTF9DQU5OT05MQUtFLCBJ
TlRFTF9TVUJQTEFURk9STV9QT1JURikKPiAtI2RlZmluZSBJU19JQ0xfV0lUSF9QT1JUX0YoZGV2
X3ByaXYpIFwKPiAtCUlTX1NVQlBMQVRGT1JNKGRldl9wcml2LCBJTlRFTF9JQ0VMQUtFLCBJTlRF
TF9TVUJQTEFURk9STV9QT1JURikKPiArI2RlZmluZSBJU19IU1dfVUxYKGk5MTUpIFwKPiArCUlT
X1NVQlBMQVRGT1JNKGk5MTUsIElOVEVMX0hBU1dFTEwsIElOVEVMX1NVQlBMQVRGT1JNX1VMWCkK
PiArI2RlZmluZSBJU19TS0xfVUxUKGk5MTUpIFwKPiArCUlTX1NVQlBMQVRGT1JNKGk5MTUsIElO
VEVMX1NLWUxBS0UsIElOVEVMX1NVQlBMQVRGT1JNX1VMVCkKPiArI2RlZmluZSBJU19TS0xfVUxY
KGk5MTUpIFwKPiArCUlTX1NVQlBMQVRGT1JNKGk5MTUsIElOVEVMX1NLWUxBS0UsIElOVEVMX1NV
QlBMQVRGT1JNX1VMWCkKPiArI2RlZmluZSBJU19LQkxfVUxUKGk5MTUpIFwKPiArCUlTX1NVQlBM
QVRGT1JNKGk5MTUsIElOVEVMX0tBQllMQUtFLCBJTlRFTF9TVUJQTEFURk9STV9VTFQpCj4gKyNk
ZWZpbmUgSVNfS0JMX1VMWChpOTE1KSBcCj4gKwlJU19TVUJQTEFURk9STShpOTE1LCBJTlRFTF9L
QUJZTEFLRSwgSU5URUxfU1VCUExBVEZPUk1fVUxYKQo+ICsjZGVmaW5lIElTX1NLTF9HVDIoaTkx
NSkJKElTX1NLWUxBS0UoaTkxNSkgJiYgXAo+ICsJCQkJIElOVEVMX0lORk8oaTkxNSktPmd0ID09
IDIpCj4gKyNkZWZpbmUgSVNfU0tMX0dUMyhpOTE1KQkoSVNfU0tZTEFLRShpOTE1KSAmJiBcCj4g
KwkJCQkgSU5URUxfSU5GTyhpOTE1KS0+Z3QgPT0gMykKPiArI2RlZmluZSBJU19TS0xfR1Q0KGk5
MTUpCShJU19TS1lMQUtFKGk5MTUpICYmIFwKPiArCQkJCSBJTlRFTF9JTkZPKGk5MTUpLT5ndCA9
PSA0KQo+ICsjZGVmaW5lIElTX0tCTF9HVDIoaTkxNSkJKElTX0tBQllMQUtFKGk5MTUpICYmIFwK
PiArCQkJCSBJTlRFTF9JTkZPKGk5MTUpLT5ndCA9PSAyKQo+ICsjZGVmaW5lIElTX0tCTF9HVDMo
aTkxNSkJKElTX0tBQllMQUtFKGk5MTUpICYmIFwKPiArCQkJCSBJTlRFTF9JTkZPKGk5MTUpLT5n
dCA9PSAzKQo+ICsjZGVmaW5lIElTX0NGTF9VTFQoaTkxNSkgXAo+ICsJSVNfU1VCUExBVEZPUk0o
aTkxNSwgSU5URUxfQ09GRkVFTEFLRSwgSU5URUxfU1VCUExBVEZPUk1fVUxUKQo+ICsjZGVmaW5l
IElTX0NGTF9VTFgoaTkxNSkgXAo+ICsJSVNfU1VCUExBVEZPUk0oaTkxNSwgSU5URUxfQ09GRkVF
TEFLRSwgSU5URUxfU1VCUExBVEZPUk1fVUxYKQo+ICsjZGVmaW5lIElTX0NGTF9HVDIoaTkxNSkJ
KElTX0NPRkZFRUxBS0UoaTkxNSkgJiYgXAo+ICsJCQkJIElOVEVMX0lORk8oaTkxNSktPmd0ID09
IDIpCj4gKyNkZWZpbmUgSVNfQ0ZMX0dUMyhpOTE1KQkoSVNfQ09GRkVFTEFLRShpOTE1KSAmJiBc
Cj4gKwkJCQkgSU5URUxfSU5GTyhpOTE1KS0+Z3QgPT0gMykKPiArI2RlZmluZSBJU19DTkxfV0lU
SF9QT1JUX0YoaTkxNSkgXAo+ICsJSVNfU1VCUExBVEZPUk0oaTkxNSwgSU5URUxfQ0FOTk9OTEFL
RSwgSU5URUxfU1VCUExBVEZPUk1fUE9SVEYpCj4gKyNkZWZpbmUgSVNfSUNMX1dJVEhfUE9SVF9G
KGk5MTUpIFwKPiArCUlTX1NVQlBMQVRGT1JNKGk5MTUsIElOVEVMX0lDRUxBS0UsIElOVEVMX1NV
QlBMQVRGT1JNX1BPUlRGKQo+ICAgCj4gICAjZGVmaW5lIFNLTF9SRVZJRF9BMAkJMHgwCj4gICAj
ZGVmaW5lIFNLTF9SRVZJRF9CMAkJMHgxCj4gQEAgLTIyNTksOCArMjI1OSw4IEBAIElTX1NVQlBM
QVRGT1JNKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgI2RlZmluZSBC
WFRfUkVWSURfQl9MQVNUCTB4OAo+ICAgI2RlZmluZSBCWFRfUkVWSURfQzAJCTB4OQo+ICAgCj4g
LSNkZWZpbmUgSVNfQlhUX1JFVklEKGRldl9wcml2LCBzaW5jZSwgdW50aWwpIFwKPiAtCShJU19C
Uk9YVE9OKGRldl9wcml2KSAmJiBJU19SRVZJRChkZXZfcHJpdiwgc2luY2UsIHVudGlsKSkKPiAr
I2RlZmluZSBJU19CWFRfUkVWSUQoaTkxNSwgc2luY2UsIHVudGlsKSBcCj4gKwkoSVNfQlJPWFRP
TihpOTE1KSAmJiBJU19SRVZJRChpOTE1LCBzaW5jZSwgdW50aWwpKQo+ICAgCj4gICAjZGVmaW5l
IEtCTF9SRVZJRF9BMAkJMHgwCj4gICAjZGVmaW5lIEtCTF9SRVZJRF9CMAkJMHgxCj4gQEAgLTIy
NjgsMTQgKzIyNjgsMTQgQEAgSVNfU1VCUExBVEZPUk0oY29uc3Qgc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gICAjZGVmaW5lIEtCTF9SRVZJRF9EMAkJMHgzCj4gICAjZGVmaW5lIEtC
TF9SRVZJRF9FMAkJMHg0Cj4gICAKPiAtI2RlZmluZSBJU19LQkxfUkVWSUQoZGV2X3ByaXYsIHNp
bmNlLCB1bnRpbCkgXAo+IC0JKElTX0tBQllMQUtFKGRldl9wcml2KSAmJiBJU19SRVZJRChkZXZf
cHJpdiwgc2luY2UsIHVudGlsKSkKPiArI2RlZmluZSBJU19LQkxfUkVWSUQoaTkxNSwgc2luY2Us
IHVudGlsKSBcCj4gKwkoSVNfS0FCWUxBS0UoaTkxNSkgJiYgSVNfUkVWSUQoaTkxNSwgc2luY2Us
IHVudGlsKSkKPiAgIAo+ICAgI2RlZmluZSBHTEtfUkVWSURfQTAJCTB4MAo+ICAgI2RlZmluZSBH
TEtfUkVWSURfQTEJCTB4MQo+ICAgCj4gLSNkZWZpbmUgSVNfR0xLX1JFVklEKGRldl9wcml2LCBz
aW5jZSwgdW50aWwpIFwKPiAtCShJU19HRU1JTklMQUtFKGRldl9wcml2KSAmJiBJU19SRVZJRChk
ZXZfcHJpdiwgc2luY2UsIHVudGlsKSkKPiArI2RlZmluZSBJU19HTEtfUkVWSUQoaTkxNSwgc2lu
Y2UsIHVudGlsKSBcCj4gKwkoSVNfR0VNSU5JTEFLRShpOTE1KSAmJiBJU19SRVZJRChpOTE1LCBz
aW5jZSwgdW50aWwpKQo+ICAgCj4gICAjZGVmaW5lIENOTF9SRVZJRF9BMAkJMHgwCj4gICAjZGVm
aW5lIENOTF9SRVZJRF9CMAkJMHgxCj4gQEAgLTIyOTMsMTIyICsyMjkzLDEyMiBAQCBJU19TVUJQ
TEFURk9STShjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgICNkZWZpbmUg
SVNfSUNMX1JFVklEKHAsIHNpbmNlLCB1bnRpbCkgXAo+ICAgCShJU19JQ0VMQUtFKHApICYmIElT
X1JFVklEKHAsIHNpbmNlLCB1bnRpbCkpCj4gICAKPiAtI2RlZmluZSBJU19MUChkZXZfcHJpdikJ
KElOVEVMX0lORk8oZGV2X3ByaXYpLT5pc19scCkKPiAtI2RlZmluZSBJU19HRU45X0xQKGRldl9w
cml2KQkoSVNfR0VOKGRldl9wcml2LCA5KSAmJiBJU19MUChkZXZfcHJpdikpCj4gLSNkZWZpbmUg
SVNfR0VOOV9CQyhkZXZfcHJpdikJKElTX0dFTihkZXZfcHJpdiwgOSkgJiYgIUlTX0xQKGRldl9w
cml2KSkKPiArI2RlZmluZSBJU19MUChpOTE1KQkoSU5URUxfSU5GTyhpOTE1KS0+aXNfbHApCj4g
KyNkZWZpbmUgSVNfR0VOOV9MUChpOTE1KQkoSVNfR0VOKGk5MTUsIDkpICYmIElTX0xQKGk5MTUp
KQo+ICsjZGVmaW5lIElTX0dFTjlfQkMoaTkxNSkJKElTX0dFTihpOTE1LCA5KSAmJiAhSVNfTFAo
aTkxNSkpCj4gICAKPiAtI2RlZmluZSBIQVNfRU5HSU5FKGRldl9wcml2LCBpZCkgKElOVEVMX0lO
Rk8oZGV2X3ByaXYpLT5lbmdpbmVfbWFzayAmIEJJVChpZCkpCj4gKyNkZWZpbmUgSEFTX0VOR0lO
RShpOTE1LCBpZCkgKElOVEVMX0lORk8oaTkxNSktPmVuZ2luZV9tYXNrICYgQklUKGlkKSkKPiAg
IAo+IC0jZGVmaW5lIEVOR0lORV9JTlNUQU5DRVNfTUFTSyhkZXZfcHJpdiwgZmlyc3QsIGNvdW50
KSAoewkJXAo+ICsjZGVmaW5lIEVOR0lORV9JTlNUQU5DRVNfTUFTSyhpOTE1LCBmaXJzdCwgY291
bnQpICh7CQlcCj4gICAJdW5zaWduZWQgaW50IGZpcnN0X18gPSAoZmlyc3QpOwkJCQkJXAo+ICAg
CXVuc2lnbmVkIGludCBjb3VudF9fID0gKGNvdW50KTsJCQkJCVwKPiAtCShJTlRFTF9JTkZPKGRl
dl9wcml2KS0+ZW5naW5lX21hc2sgJgkJCQlcCj4gKwkoSU5URUxfSU5GTyhpOTE1KS0+ZW5naW5l
X21hc2sgJgkJCQlcCj4gICAJIEdFTk1BU0soZmlyc3RfXyArIGNvdW50X18gLSAxLCBmaXJzdF9f
KSkgPj4gZmlyc3RfXzsJCVwKPiAgIH0pCj4gLSNkZWZpbmUgVkRCT1hfTUFTSyhkZXZfcHJpdikg
XAo+IC0JRU5HSU5FX0lOU1RBTkNFU19NQVNLKGRldl9wcml2LCBWQ1MwLCBJOTE1X01BWF9WQ1Mp
Cj4gLSNkZWZpbmUgVkVCT1hfTUFTSyhkZXZfcHJpdikgXAo+IC0JRU5HSU5FX0lOU1RBTkNFU19N
QVNLKGRldl9wcml2LCBWRUNTMCwgSTkxNV9NQVhfVkVDUykKPiAtCj4gLSNkZWZpbmUgSEFTX0xM
QyhkZXZfcHJpdikJKElOVEVMX0lORk8oZGV2X3ByaXYpLT5oYXNfbGxjKQo+IC0jZGVmaW5lIEhB
U19TTk9PUChkZXZfcHJpdikJKElOVEVMX0lORk8oZGV2X3ByaXYpLT5oYXNfc25vb3ApCj4gLSNk
ZWZpbmUgSEFTX0VEUkFNKGRldl9wcml2KQkoKGRldl9wcml2KS0+ZWRyYW1fc2l6ZV9tYikKPiAt
I2RlZmluZSBIQVNfV1QoZGV2X3ByaXYpCSgoSVNfSEFTV0VMTChkZXZfcHJpdikgfHwgXAo+IC0J
CQkJIElTX0JST0FEV0VMTChkZXZfcHJpdikpICYmIEhBU19FRFJBTShkZXZfcHJpdikpCj4gLQo+
IC0jZGVmaW5lIEhXU19ORUVEU19QSFlTSUNBTChkZXZfcHJpdikJKElOVEVMX0lORk8oZGV2X3By
aXYpLT5od3NfbmVlZHNfcGh5c2ljYWwpCj4gLQo+IC0jZGVmaW5lIEhBU19MT0dJQ0FMX1JJTkdf
Q09OVEVYVFMoZGV2X3ByaXYpIFwKPiAtCQkoSU5URUxfSU5GTyhkZXZfcHJpdiktPmhhc19sb2dp
Y2FsX3JpbmdfY29udGV4dHMpCj4gLSNkZWZpbmUgSEFTX0xPR0lDQUxfUklOR19FTFNRKGRldl9w
cml2KSBcCj4gLQkJKElOVEVMX0lORk8oZGV2X3ByaXYpLT5oYXNfbG9naWNhbF9yaW5nX2Vsc3Ep
Cj4gLSNkZWZpbmUgSEFTX0xPR0lDQUxfUklOR19QUkVFTVBUSU9OKGRldl9wcml2KSBcCj4gLQkJ
KElOVEVMX0lORk8oZGV2X3ByaXYpLT5oYXNfbG9naWNhbF9yaW5nX3ByZWVtcHRpb24pCj4gLQo+
IC0jZGVmaW5lIEhBU19FWEVDTElTVFMoZGV2X3ByaXYpIEhBU19MT0dJQ0FMX1JJTkdfQ09OVEVY
VFMoZGV2X3ByaXYpCj4gLQo+IC0jZGVmaW5lIElOVEVMX1BQR1RUKGRldl9wcml2KSAoSU5URUxf
SU5GTyhkZXZfcHJpdiktPnBwZ3R0X3R5cGUpCj4gLSNkZWZpbmUgSEFTX1BQR1RUKGRldl9wcml2
KSBcCj4gLQkoSU5URUxfUFBHVFQoZGV2X3ByaXYpICE9IElOVEVMX1BQR1RUX05PTkUpCj4gLSNk
ZWZpbmUgSEFTX0ZVTExfUFBHVFQoZGV2X3ByaXYpIFwKPiAtCShJTlRFTF9QUEdUVChkZXZfcHJp
dikgPj0gSU5URUxfUFBHVFRfRlVMTCkKPiAtCj4gLSNkZWZpbmUgSEFTX1BBR0VfU0laRVMoZGV2
X3ByaXYsIHNpemVzKSAoeyBcCj4gKyNkZWZpbmUgVkRCT1hfTUFTSyhpOTE1KSBcCj4gKwlFTkdJ
TkVfSU5TVEFOQ0VTX01BU0soaTkxNSwgVkNTMCwgSTkxNV9NQVhfVkNTKQo+ICsjZGVmaW5lIFZF
Qk9YX01BU0soaTkxNSkgXAo+ICsJRU5HSU5FX0lOU1RBTkNFU19NQVNLKGk5MTUsIFZFQ1MwLCBJ
OTE1X01BWF9WRUNTKQo+ICsKPiArI2RlZmluZSBIQVNfTExDKGk5MTUpCShJTlRFTF9JTkZPKGk5
MTUpLT5oYXNfbGxjKQo+ICsjZGVmaW5lIEhBU19TTk9PUChpOTE1KQkoSU5URUxfSU5GTyhpOTE1
KS0+aGFzX3Nub29wKQo+ICsjZGVmaW5lIEhBU19FRFJBTShpOTE1KQkoKGk5MTUpLT5lZHJhbV9z
aXplX21iKQo+ICsjZGVmaW5lIEhBU19XVChpOTE1KQkoKElTX0hBU1dFTEwoaTkxNSkgfHwgXAo+
ICsJCQkJIElTX0JST0FEV0VMTChpOTE1KSkgJiYgSEFTX0VEUkFNKGk5MTUpKQo+ICsKPiArI2Rl
ZmluZSBIV1NfTkVFRFNfUEhZU0lDQUwoaTkxNSkJKElOVEVMX0lORk8oaTkxNSktPmh3c19uZWVk
c19waHlzaWNhbCkKPiArCj4gKyNkZWZpbmUgSEFTX0xPR0lDQUxfUklOR19DT05URVhUUyhpOTE1
KSBcCj4gKwkJKElOVEVMX0lORk8oaTkxNSktPmhhc19sb2dpY2FsX3JpbmdfY29udGV4dHMpCj4g
KyNkZWZpbmUgSEFTX0xPR0lDQUxfUklOR19FTFNRKGk5MTUpIFwKPiArCQkoSU5URUxfSU5GTyhp
OTE1KS0+aGFzX2xvZ2ljYWxfcmluZ19lbHNxKQo+ICsjZGVmaW5lIEhBU19MT0dJQ0FMX1JJTkdf
UFJFRU1QVElPTihpOTE1KSBcCj4gKwkJKElOVEVMX0lORk8oaTkxNSktPmhhc19sb2dpY2FsX3Jp
bmdfcHJlZW1wdGlvbikKPiArCj4gKyNkZWZpbmUgSEFTX0VYRUNMSVNUUyhpOTE1KSBIQVNfTE9H
SUNBTF9SSU5HX0NPTlRFWFRTKGk5MTUpCj4gKwo+ICsjZGVmaW5lIElOVEVMX1BQR1RUKGk5MTUp
IChJTlRFTF9JTkZPKGk5MTUpLT5wcGd0dF90eXBlKQo+ICsjZGVmaW5lIEhBU19QUEdUVChpOTE1
KSBcCj4gKwkoSU5URUxfUFBHVFQoaTkxNSkgIT0gSU5URUxfUFBHVFRfTk9ORSkKPiArI2RlZmlu
ZSBIQVNfRlVMTF9QUEdUVChpOTE1KSBcCj4gKwkoSU5URUxfUFBHVFQoaTkxNSkgPj0gSU5URUxf
UFBHVFRfRlVMTCkKPiArCj4gKyNkZWZpbmUgSEFTX1BBR0VfU0laRVMoaTkxNSwgc2l6ZXMpICh7
IFwKPiAgIAlHRU1fQlVHX09OKChzaXplcykgPT0gMCk7IFwKPiAtCSgoc2l6ZXMpICYgfklOVEVM
X0lORk8oZGV2X3ByaXYpLT5wYWdlX3NpemVzKSA9PSAwOyBcCj4gKwkoKHNpemVzKSAmIH5JTlRF
TF9JTkZPKGk5MTUpLT5wYWdlX3NpemVzKSA9PSAwOyBcCj4gICB9KQo+ICAgCj4gLSNkZWZpbmUg
SEFTX09WRVJMQVkoZGV2X3ByaXYpCQkgKElOVEVMX0lORk8oZGV2X3ByaXYpLT5kaXNwbGF5Lmhh
c19vdmVybGF5KQo+IC0jZGVmaW5lIE9WRVJMQVlfTkVFRFNfUEhZU0lDQUwoZGV2X3ByaXYpIFwK
PiAtCQkoSU5URUxfSU5GTyhkZXZfcHJpdiktPmRpc3BsYXkub3ZlcmxheV9uZWVkc19waHlzaWNh
bCkKPiArI2RlZmluZSBIQVNfT1ZFUkxBWShpOTE1KQkJIChJTlRFTF9JTkZPKGk5MTUpLT5kaXNw
bGF5Lmhhc19vdmVybGF5KQo+ICsjZGVmaW5lIE9WRVJMQVlfTkVFRFNfUEhZU0lDQUwoaTkxNSkg
XAo+ICsJCShJTlRFTF9JTkZPKGk5MTUpLT5kaXNwbGF5Lm92ZXJsYXlfbmVlZHNfcGh5c2ljYWwp
Cj4gICAKPiAgIC8qIEVhcmx5IGdlbjIgaGF2ZSBhIHRvdGFsbHkgYnVzdGVkIENTIHRsYiBhbmQg
cmVxdWlyZSBwaW5uZWQgYmF0Y2hlcy4gKi8KPiAtI2RlZmluZSBIQVNfQlJPS0VOX0NTX1RMQihk
ZXZfcHJpdikJKElTX0k4MzAoZGV2X3ByaXYpIHx8IElTX0k4NDVHKGRldl9wcml2KSkKPiArI2Rl
ZmluZSBIQVNfQlJPS0VOX0NTX1RMQihpOTE1KQkoSVNfSTgzMChpOTE1KSB8fCBJU19JODQ1Ryhp
OTE1KSkKPiAgIAo+ICAgLyogV2FSc0Rpc2FibGVDb2Fyc2VQb3dlckdhdGluZzpza2wsY25sICov
Cj4gLSNkZWZpbmUgTkVFRFNfV2FSc0Rpc2FibGVDb2Fyc2VQb3dlckdhdGluZyhkZXZfcHJpdikg
XAo+IC0JKElTX0NBTk5PTkxBS0UoZGV2X3ByaXYpIHx8IFwKPiAtCSBJU19TS0xfR1QzKGRldl9w
cml2KSB8fCBJU19TS0xfR1Q0KGRldl9wcml2KSkKPiArI2RlZmluZSBORUVEU19XYVJzRGlzYWJs
ZUNvYXJzZVBvd2VyR2F0aW5nKGk5MTUpIFwKPiArCShJU19DQU5OT05MQUtFKGk5MTUpIHx8IFwK
PiArCSBJU19TS0xfR1QzKGk5MTUpIHx8IElTX1NLTF9HVDQoaTkxNSkpCj4gICAKPiAtI2RlZmlu
ZSBIQVNfR01CVVNfSVJRKGRldl9wcml2KSAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA0KQo+IC0j
ZGVmaW5lIEhBU19HTUJVU19CVVJTVF9SRUFEKGRldl9wcml2KSAoSU5URUxfR0VOKGRldl9wcml2
KSA+PSAxMCB8fCBcCj4gLQkJCQkJSVNfR0VNSU5JTEFLRShkZXZfcHJpdikgfHwgXAo+IC0JCQkJ
CUlTX0tBQllMQUtFKGRldl9wcml2KSkKPiArI2RlZmluZSBIQVNfR01CVVNfSVJRKGk5MTUpIChJ
TlRFTF9HRU4oaTkxNSkgPj0gNCkKPiArI2RlZmluZSBIQVNfR01CVVNfQlVSU1RfUkVBRChpOTE1
KSAoSU5URUxfR0VOKGk5MTUpID49IDEwIHx8IFwKPiArCQkJCQlJU19HRU1JTklMQUtFKGk5MTUp
IHx8IFwKPiArCQkJCQlJU19LQUJZTEFLRShpOTE1KSkKPiAgIAo+ICAgLyogV2l0aCB0aGUgOTQ1
IGFuZCBsYXRlciwgWSB0aWxpbmcgZ290IGFkanVzdGVkIHNvIHRoYXQgaXQgd2FzIDMyIDEyOC1i
eXRlCj4gICAgKiByb3dzLCB3aGljaCBjaGFuZ2VkIHRoZSBhbGlnbm1lbnQgcmVxdWlyZW1lbnRz
IGFuZCBmZW5jZSBwcm9ncmFtbWluZy4KPiAgICAqLwo+IC0jZGVmaW5lIEhBU18xMjhfQllURV9Z
X1RJTElORyhkZXZfcHJpdikgKCFJU19HRU4oZGV2X3ByaXYsIDIpICYmIFwKPiAtCQkJCQkgIShJ
U19JOTE1RyhkZXZfcHJpdikgfHwgXAo+IC0JCQkJCSBJU19JOTE1R00oZGV2X3ByaXYpKSkKPiAt
I2RlZmluZSBTVVBQT1JUU19UVihkZXZfcHJpdikJCShJTlRFTF9JTkZPKGRldl9wcml2KS0+ZGlz
cGxheS5zdXBwb3J0c190dikKPiAtI2RlZmluZSBJOTE1X0hBU19IT1RQTFVHKGRldl9wcml2KQko
SU5URUxfSU5GTyhkZXZfcHJpdiktPmRpc3BsYXkuaGFzX2hvdHBsdWcpCj4gKyNkZWZpbmUgSEFT
XzEyOF9CWVRFX1lfVElMSU5HKGk5MTUpICghSVNfR0VOKGk5MTUsIDIpICYmIFwKPiArCQkJCQkg
IShJU19JOTE1RyhpOTE1KSB8fCBcCj4gKwkJCQkJIElTX0k5MTVHTShpOTE1KSkpCj4gKyNkZWZp
bmUgU1VQUE9SVFNfVFYoaTkxNSkJCShJTlRFTF9JTkZPKGk5MTUpLT5kaXNwbGF5LnN1cHBvcnRz
X3R2KQo+ICsjZGVmaW5lIEk5MTVfSEFTX0hPVFBMVUcoaTkxNSkJKElOVEVMX0lORk8oaTkxNSkt
PmRpc3BsYXkuaGFzX2hvdHBsdWcpCj4gICAKPiAtI2RlZmluZSBIQVNfRldfQkxDKGRldl9wcml2
KSAJKElOVEVMX0dFTihkZXZfcHJpdikgPiAyKQo+IC0jZGVmaW5lIEhBU19GQkMoZGV2X3ByaXYp
CShJTlRFTF9JTkZPKGRldl9wcml2KS0+ZGlzcGxheS5oYXNfZmJjKQo+IC0jZGVmaW5lIEhBU19D
VVJfRkJDKGRldl9wcml2KQkoIUhBU19HTUNIKGRldl9wcml2KSAmJiBJTlRFTF9HRU4oZGV2X3By
aXYpID49IDcpCj4gKyNkZWZpbmUgSEFTX0ZXX0JMQyhpOTE1KSAJKElOVEVMX0dFTihpOTE1KSA+
IDIpCj4gKyNkZWZpbmUgSEFTX0ZCQyhpOTE1KQkoSU5URUxfSU5GTyhpOTE1KS0+ZGlzcGxheS5o
YXNfZmJjKQo+ICsjZGVmaW5lIEhBU19DVVJfRkJDKGk5MTUpCSghSEFTX0dNQ0goaTkxNSkgJiYg
SU5URUxfR0VOKGk5MTUpID49IDcpCj4gICAKPiAtI2RlZmluZSBIQVNfSVBTKGRldl9wcml2KQko
SVNfSFNXX1VMVChkZXZfcHJpdikgfHwgSVNfQlJPQURXRUxMKGRldl9wcml2KSkKPiArI2RlZmlu
ZSBIQVNfSVBTKGk5MTUpCShJU19IU1dfVUxUKGk5MTUpIHx8IElTX0JST0FEV0VMTChpOTE1KSkK
PiAgIAo+IC0jZGVmaW5lIEhBU19EUF9NU1QoZGV2X3ByaXYpCShJTlRFTF9JTkZPKGRldl9wcml2
KS0+ZGlzcGxheS5oYXNfZHBfbXN0KQo+ICsjZGVmaW5lIEhBU19EUF9NU1QoaTkxNSkJKElOVEVM
X0lORk8oaTkxNSktPmRpc3BsYXkuaGFzX2RwX21zdCkKPiAgIAo+IC0jZGVmaW5lIEhBU19EREko
ZGV2X3ByaXYpCQkgKElOVEVMX0lORk8oZGV2X3ByaXYpLT5kaXNwbGF5Lmhhc19kZGkpCj4gLSNk
ZWZpbmUgSEFTX0ZQR0FfREJHX1VOQ0xBSU1FRChkZXZfcHJpdikgKElOVEVMX0lORk8oZGV2X3By
aXYpLT5oYXNfZnBnYV9kYmcpCj4gLSNkZWZpbmUgSEFTX1BTUihkZXZfcHJpdikJCSAoSU5URUxf
SU5GTyhkZXZfcHJpdiktPmRpc3BsYXkuaGFzX3BzcikKPiAtI2RlZmluZSBIQVNfVFJBTlNDT0RF
Ul9FRFAoZGV2X3ByaXYpCSAoSU5URUxfSU5GTyhkZXZfcHJpdiktPnRyYW5zX29mZnNldHNbVFJB
TlNDT0RFUl9FRFBdICE9IDApCj4gKyNkZWZpbmUgSEFTX0RESShpOTE1KQkJIChJTlRFTF9JTkZP
KGk5MTUpLT5kaXNwbGF5Lmhhc19kZGkpCj4gKyNkZWZpbmUgSEFTX0ZQR0FfREJHX1VOQ0xBSU1F
RChpOTE1KSAoSU5URUxfSU5GTyhpOTE1KS0+aGFzX2ZwZ2FfZGJnKQo+ICsjZGVmaW5lIEhBU19Q
U1IoaTkxNSkJCSAoSU5URUxfSU5GTyhpOTE1KS0+ZGlzcGxheS5oYXNfcHNyKQo+ICsjZGVmaW5l
IEhBU19UUkFOU0NPREVSX0VEUChpOTE1KQkgKElOVEVMX0lORk8oaTkxNSktPnRyYW5zX29mZnNl
dHNbVFJBTlNDT0RFUl9FRFBdICE9IDApCj4gICAKPiAtI2RlZmluZSBIQVNfUkM2KGRldl9wcml2
KQkJIChJTlRFTF9JTkZPKGRldl9wcml2KS0+aGFzX3JjNikKPiAtI2RlZmluZSBIQVNfUkM2cChk
ZXZfcHJpdikJCSAoSU5URUxfSU5GTyhkZXZfcHJpdiktPmhhc19yYzZwKQo+IC0jZGVmaW5lIEhB
U19SQzZwcChkZXZfcHJpdikJCSAoZmFsc2UpIC8qIEhXIHdhcyBuZXZlciB2YWxpZGF0ZWQgKi8K
PiArI2RlZmluZSBIQVNfUkM2KGk5MTUpCQkgKElOVEVMX0lORk8oaTkxNSktPmhhc19yYzYpCj4g
KyNkZWZpbmUgSEFTX1JDNnAoaTkxNSkJCSAoSU5URUxfSU5GTyhpOTE1KS0+aGFzX3JjNnApCj4g
KyNkZWZpbmUgSEFTX1JDNnBwKGk5MTUpCQkgKGZhbHNlKSAvKiBIVyB3YXMgbmV2ZXIgdmFsaWRh
dGVkICovCj4gICAKPiAtI2RlZmluZSBIQVNfUlBTKGRldl9wcml2KQkoSU5URUxfSU5GTyhkZXZf
cHJpdiktPmhhc19ycHMpCj4gKyNkZWZpbmUgSEFTX1JQUyhpOTE1KQkoSU5URUxfSU5GTyhpOTE1
KS0+aGFzX3JwcykKPiAgIAo+IC0jZGVmaW5lIEhBU19DU1IoZGV2X3ByaXYpCShJTlRFTF9JTkZP
KGRldl9wcml2KS0+ZGlzcGxheS5oYXNfY3NyKQo+ICsjZGVmaW5lIEhBU19DU1IoaTkxNSkJKElO
VEVMX0lORk8oaTkxNSktPmRpc3BsYXkuaGFzX2NzcikKPiAgIAo+IC0jZGVmaW5lIEhBU19SVU5U
SU1FX1BNKGRldl9wcml2KSAoSU5URUxfSU5GTyhkZXZfcHJpdiktPmhhc19ydW50aW1lX3BtKQo+
IC0jZGVmaW5lIEhBU182NEJJVF9SRUxPQyhkZXZfcHJpdikgKElOVEVMX0lORk8oZGV2X3ByaXYp
LT5oYXNfNjRiaXRfcmVsb2MpCj4gKyNkZWZpbmUgSEFTX1JVTlRJTUVfUE0oaTkxNSkgKElOVEVM
X0lORk8oaTkxNSktPmhhc19ydW50aW1lX3BtKQo+ICsjZGVmaW5lIEhBU182NEJJVF9SRUxPQyhp
OTE1KSAoSU5URUxfSU5GTyhpOTE1KS0+aGFzXzY0Yml0X3JlbG9jKQo+ICAgCj4gLSNkZWZpbmUg
SEFTX0lQQyhkZXZfcHJpdikJCSAoSU5URUxfSU5GTyhkZXZfcHJpdiktPmRpc3BsYXkuaGFzX2lw
YykKPiArI2RlZmluZSBIQVNfSVBDKGk5MTUpCQkgKElOVEVMX0lORk8oaTkxNSktPmRpc3BsYXku
aGFzX2lwYykKPiAgIAo+ICAgLyoKPiAgICAqIEZvciBub3csIGFueXRoaW5nIHdpdGggYSBHdUMg
cmVxdWlyZXMgdUNvZGUgbG9hZGluZywgYW5kIHRoZW4gc3VwcG9ydHMKPiAgICAqIGNvbW1hbmQg
c3VibWlzc2lvbiBvbmNlIGxvYWRlZC4gQnV0IHRoZXNlIGFyZSBsb2dpY2FsbHkgaW5kZXBlbmRl
bnQKPiAgICAqIHByb3BlcnRpZXMsIHNvIHdlIGhhdmUgc2VwYXJhdGUgbWFjcm9zIHRvIHRlc3Qg
dGhlbS4KPiAgICAqLwo+IC0jZGVmaW5lIEhBU19HVUMoZGV2X3ByaXYpCShJTlRFTF9JTkZPKGRl
dl9wcml2KS0+aGFzX2d1YykKPiAtI2RlZmluZSBIQVNfR1VDX1VDT0RFKGRldl9wcml2KQkoSEFT
X0dVQyhkZXZfcHJpdikpCj4gLSNkZWZpbmUgSEFTX0dVQ19TQ0hFRChkZXZfcHJpdikJKEhBU19H
VUMoZGV2X3ByaXYpKQo+ICsjZGVmaW5lIEhBU19HVUMoaTkxNSkJKElOVEVMX0lORk8oaTkxNSkt
Pmhhc19ndWMpCj4gKyNkZWZpbmUgSEFTX0dVQ19VQ09ERShpOTE1KQkoSEFTX0dVQyhpOTE1KSkK
PiArI2RlZmluZSBIQVNfR1VDX1NDSEVEKGk5MTUpCShIQVNfR1VDKGk5MTUpKQo+ICAgCj4gICAv
KiBGb3Igbm93LCBhbnl0aGluZyB3aXRoIGEgR3VDIGhhcyBhbHNvIEh1QyAqLwo+IC0jZGVmaW5l
IEhBU19IVUMoZGV2X3ByaXYpCShIQVNfR1VDKGRldl9wcml2KSkKPiAtI2RlZmluZSBIQVNfSFVD
X1VDT0RFKGRldl9wcml2KQkoSEFTX0dVQyhkZXZfcHJpdikpCj4gKyNkZWZpbmUgSEFTX0hVQyhp
OTE1KQkoSEFTX0dVQyhpOTE1KSkKPiArI2RlZmluZSBIQVNfSFVDX1VDT0RFKGk5MTUpCShIQVNf
R1VDKGk5MTUpKQo+ICAgCj4gICAvKiBIYXZpbmcgYSBHdUMgaXMgbm90IHRoZSBzYW1lIGFzIHVz
aW5nIGEgR3VDICovCj4gLSNkZWZpbmUgVVNFU19HVUMoZGV2X3ByaXYpCQlpbnRlbF91Y19pc191
c2luZ19ndWMoZGV2X3ByaXYpCj4gLSNkZWZpbmUgVVNFU19HVUNfU1VCTUlTU0lPTihkZXZfcHJp
dikJaW50ZWxfdWNfaXNfdXNpbmdfZ3VjX3N1Ym1pc3Npb24oZGV2X3ByaXYpCj4gLSNkZWZpbmUg
VVNFU19IVUMoZGV2X3ByaXYpCQlpbnRlbF91Y19pc191c2luZ19odWMoZGV2X3ByaXYpCj4gKyNk
ZWZpbmUgVVNFU19HVUMoaTkxNSkJCWludGVsX3VjX2lzX3VzaW5nX2d1YyhpOTE1KQo+ICsjZGVm
aW5lIFVTRVNfR1VDX1NVQk1JU1NJT04oaTkxNSkJaW50ZWxfdWNfaXNfdXNpbmdfZ3VjX3N1Ym1p
c3Npb24oaTkxNSkKPiArI2RlZmluZSBVU0VTX0hVQyhpOTE1KQkJaW50ZWxfdWNfaXNfdXNpbmdf
aHVjKGk5MTUpCj4gICAKPiAtI2RlZmluZSBIQVNfUE9PTEVEX0VVKGRldl9wcml2KQkoSU5URUxf
SU5GTyhkZXZfcHJpdiktPmhhc19wb29sZWRfZXUpCj4gKyNkZWZpbmUgSEFTX1BPT0xFRF9FVShp
OTE1KQkoSU5URUxfSU5GTyhpOTE1KS0+aGFzX3Bvb2xlZF9ldSkKPiAgIAo+ICAgI2RlZmluZSBJ
TlRFTF9QQ0hfREVWSUNFX0lEX01BU0sJCTB4ZmY4MAo+ICAgI2RlZmluZSBJTlRFTF9QQ0hfSUJY
X0RFVklDRV9JRF9UWVBFCQkweDNiMDAKPiBAQCAtMjQyOSwzNiArMjQyOSwzNiBAQCBJU19TVUJQ
TEFURk9STShjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgICNkZWZpbmUg
SU5URUxfUENIX1AzWF9ERVZJQ0VfSURfVFlQRQkJMHg3MDAwCj4gICAjZGVmaW5lIElOVEVMX1BD
SF9RRU1VX0RFVklDRV9JRF9UWVBFCQkweDI5MDAgLyogcWVtdSBxMzUgaGFzIDI5MTggKi8KPiAg
IAo+IC0jZGVmaW5lIElOVEVMX1BDSF9UWVBFKGRldl9wcml2KSAoKGRldl9wcml2KS0+cGNoX3R5
cGUpCj4gLSNkZWZpbmUgSU5URUxfUENIX0lEKGRldl9wcml2KSAoKGRldl9wcml2KS0+cGNoX2lk
KQo+IC0jZGVmaW5lIEhBU19QQ0hfSUNQKGRldl9wcml2KSAoSU5URUxfUENIX1RZUEUoZGV2X3By
aXYpID09IFBDSF9JQ1ApCj4gLSNkZWZpbmUgSEFTX1BDSF9DTlAoZGV2X3ByaXYpIChJTlRFTF9Q
Q0hfVFlQRShkZXZfcHJpdikgPT0gUENIX0NOUCkKPiAtI2RlZmluZSBIQVNfUENIX1NQVChkZXZf
cHJpdikgKElOVEVMX1BDSF9UWVBFKGRldl9wcml2KSA9PSBQQ0hfU1BUKQo+IC0jZGVmaW5lIEhB
U19QQ0hfTFBUKGRldl9wcml2KSAoSU5URUxfUENIX1RZUEUoZGV2X3ByaXYpID09IFBDSF9MUFQp
Cj4gLSNkZWZpbmUgSEFTX1BDSF9MUFRfTFAoZGV2X3ByaXYpIFwKPiAtCShJTlRFTF9QQ0hfSUQo
ZGV2X3ByaXYpID09IElOVEVMX1BDSF9MUFRfTFBfREVWSUNFX0lEX1RZUEUgfHwgXAo+IC0JIElO
VEVMX1BDSF9JRChkZXZfcHJpdikgPT0gSU5URUxfUENIX1dQVF9MUF9ERVZJQ0VfSURfVFlQRSkK
PiAtI2RlZmluZSBIQVNfUENIX0xQVF9IKGRldl9wcml2KSBcCj4gLQkoSU5URUxfUENIX0lEKGRl
dl9wcml2KSA9PSBJTlRFTF9QQ0hfTFBUX0RFVklDRV9JRF9UWVBFIHx8IFwKPiAtCSBJTlRFTF9Q
Q0hfSUQoZGV2X3ByaXYpID09IElOVEVMX1BDSF9XUFRfREVWSUNFX0lEX1RZUEUpCj4gLSNkZWZp
bmUgSEFTX1BDSF9DUFQoZGV2X3ByaXYpIChJTlRFTF9QQ0hfVFlQRShkZXZfcHJpdikgPT0gUENI
X0NQVCkKPiAtI2RlZmluZSBIQVNfUENIX0lCWChkZXZfcHJpdikgKElOVEVMX1BDSF9UWVBFKGRl
dl9wcml2KSA9PSBQQ0hfSUJYKQo+IC0jZGVmaW5lIEhBU19QQ0hfTk9QKGRldl9wcml2KSAoSU5U
RUxfUENIX1RZUEUoZGV2X3ByaXYpID09IFBDSF9OT1ApCj4gLSNkZWZpbmUgSEFTX1BDSF9TUExJ
VChkZXZfcHJpdikgKElOVEVMX1BDSF9UWVBFKGRldl9wcml2KSAhPSBQQ0hfTk9ORSkKPiAtCj4g
LSNkZWZpbmUgSEFTX0dNQ0goZGV2X3ByaXYpIChJTlRFTF9JTkZPKGRldl9wcml2KS0+ZGlzcGxh
eS5oYXNfZ21jaCkKPiAtCj4gLSNkZWZpbmUgSEFTX0xTUENPTihkZXZfcHJpdikgKElOVEVMX0dF
TihkZXZfcHJpdikgPj0gOSkKPiArI2RlZmluZSBJTlRFTF9QQ0hfVFlQRShpOTE1KSAoKGk5MTUp
LT5wY2hfdHlwZSkKPiArI2RlZmluZSBJTlRFTF9QQ0hfSUQoaTkxNSkgKChpOTE1KS0+cGNoX2lk
KQo+ICsjZGVmaW5lIEhBU19QQ0hfSUNQKGk5MTUpIChJTlRFTF9QQ0hfVFlQRShpOTE1KSA9PSBQ
Q0hfSUNQKQo+ICsjZGVmaW5lIEhBU19QQ0hfQ05QKGk5MTUpIChJTlRFTF9QQ0hfVFlQRShpOTE1
KSA9PSBQQ0hfQ05QKQo+ICsjZGVmaW5lIEhBU19QQ0hfU1BUKGk5MTUpIChJTlRFTF9QQ0hfVFlQ
RShpOTE1KSA9PSBQQ0hfU1BUKQo+ICsjZGVmaW5lIEhBU19QQ0hfTFBUKGk5MTUpIChJTlRFTF9Q
Q0hfVFlQRShpOTE1KSA9PSBQQ0hfTFBUKQo+ICsjZGVmaW5lIEhBU19QQ0hfTFBUX0xQKGk5MTUp
IFwKPiArCShJTlRFTF9QQ0hfSUQoaTkxNSkgPT0gSU5URUxfUENIX0xQVF9MUF9ERVZJQ0VfSURf
VFlQRSB8fCBcCj4gKwkgSU5URUxfUENIX0lEKGk5MTUpID09IElOVEVMX1BDSF9XUFRfTFBfREVW
SUNFX0lEX1RZUEUpCj4gKyNkZWZpbmUgSEFTX1BDSF9MUFRfSChpOTE1KSBcCj4gKwkoSU5URUxf
UENIX0lEKGk5MTUpID09IElOVEVMX1BDSF9MUFRfREVWSUNFX0lEX1RZUEUgfHwgXAo+ICsJIElO
VEVMX1BDSF9JRChpOTE1KSA9PSBJTlRFTF9QQ0hfV1BUX0RFVklDRV9JRF9UWVBFKQo+ICsjZGVm
aW5lIEhBU19QQ0hfQ1BUKGk5MTUpIChJTlRFTF9QQ0hfVFlQRShpOTE1KSA9PSBQQ0hfQ1BUKQo+
ICsjZGVmaW5lIEhBU19QQ0hfSUJYKGk5MTUpIChJTlRFTF9QQ0hfVFlQRShpOTE1KSA9PSBQQ0hf
SUJYKQo+ICsjZGVmaW5lIEhBU19QQ0hfTk9QKGk5MTUpIChJTlRFTF9QQ0hfVFlQRShpOTE1KSA9
PSBQQ0hfTk9QKQo+ICsjZGVmaW5lIEhBU19QQ0hfU1BMSVQoaTkxNSkgKElOVEVMX1BDSF9UWVBF
KGk5MTUpICE9IFBDSF9OT05FKQo+ICsKPiArI2RlZmluZSBIQVNfR01DSChpOTE1KSAoSU5URUxf
SU5GTyhpOTE1KS0+ZGlzcGxheS5oYXNfZ21jaCkKPiArCj4gKyNkZWZpbmUgSEFTX0xTUENPTihp
OTE1KSAoSU5URUxfR0VOKGk5MTUpID49IDkpCj4gICAKPiAgIC8qIERQRiA9PSBkeW5hbWljIHBh
cml0eSBmZWF0dXJlICovCj4gLSNkZWZpbmUgSEFTX0wzX0RQRihkZXZfcHJpdikgKElOVEVMX0lO
Rk8oZGV2X3ByaXYpLT5oYXNfbDNfZHBmKQo+IC0jZGVmaW5lIE5VTV9MM19TTElDRVMoZGV2X3By
aXYpIChJU19IU1dfR1QzKGRldl9wcml2KSA/IFwKPiAtCQkJCSAyIDogSEFTX0wzX0RQRihkZXZf
cHJpdikpCj4gKyNkZWZpbmUgSEFTX0wzX0RQRihpOTE1KSAoSU5URUxfSU5GTyhpOTE1KS0+aGFz
X2wzX2RwZikKPiArI2RlZmluZSBOVU1fTDNfU0xJQ0VTKGk5MTUpIChJU19IU1dfR1QzKGk5MTUp
ID8gXAo+ICsJCQkJIDIgOiBIQVNfTDNfRFBGKGk5MTUpKQo+ICAgCj4gICAjZGVmaW5lIEdUX0ZS
RVFVRU5DWV9NVUxUSVBMSUVSIDUwCj4gICAjZGVmaW5lIEdFTjlfRlJFUV9TQ0FMRVIgMwo+ICAg
Cj4gLSNkZWZpbmUgSEFTX0RJU1BMQVkoZGV2X3ByaXYpIChJTlRFTF9JTkZPKGRldl9wcml2KS0+
bnVtX3BpcGVzID4gMCkKPiArI2RlZmluZSBIQVNfRElTUExBWShpOTE1KSAoSU5URUxfSU5GTyhp
OTE1KS0+bnVtX3BpcGVzID4gMCkKPiAgIAo+ICAgI2luY2x1ZGUgImk5MTVfdHJhY2UuaCIKPiAg
IAo+IEBAIC0yNDcxLDI0ICsyNDcxLDI0IEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF92dGRf
YWN0aXZlKHZvaWQpCj4gICAJcmV0dXJuIGZhbHNlOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBpbmxp
bmUgYm9vbCBpbnRlbF9zY2Fub3V0X25lZWRzX3Z0ZF93YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF9zY2Fub3V0X25lZWRzX3Z0
ZF93YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXJldHVybiBJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDYgJiYgaW50ZWxfdnRkX2FjdGl2ZSgpOwo+ICsJcmV0dXJuIElO
VEVMX0dFTihpOTE1KSA+PSA2ICYmIGludGVsX3Z0ZF9hY3RpdmUoKTsKPiAgIH0KPiAgIAo+ICAg
c3RhdGljIGlubGluZSBib29sCj4gLWludGVsX2dndHRfdXBkYXRlX25lZWRzX3Z0ZF93YShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK2ludGVsX2dndHRfdXBkYXRlX25lZWRz
X3Z0ZF93YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXJldHVybiBJ
U19CUk9YVE9OKGRldl9wcml2KSAmJiBpbnRlbF92dGRfYWN0aXZlKCk7Cj4gKwlyZXR1cm4gSVNf
QlJPWFRPTihpOTE1KSAmJiBpbnRlbF92dGRfYWN0aXZlKCk7Cj4gICB9Cj4gICAKPiAgIC8qIGk5
MTVfZHJ2LmMgKi8KPiAgIHZvaWQgX19wcmludGYoMywgNCkKPiAtX19pOTE1X3ByaW50ayhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGNvbnN0IGNoYXIgKmxldmVsLAo+ICtfX2k5
MTVfcHJpbnRrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBjb25zdCBjaGFyICpsZXZl
bCwKPiAgIAkgICAgICBjb25zdCBjaGFyICpmbXQsIC4uLik7Cj4gICAKPiAtI2RlZmluZSBpOTE1
X3JlcG9ydF9lcnJvcihkZXZfcHJpdiwgZm10LCAuLi4pCQkJCSAgIFwKPiAtCV9faTkxNV9wcmlu
dGsoZGV2X3ByaXYsIEtFUk5fRVJSLCBmbXQsICMjX19WQV9BUkdTX18pCj4gKyNkZWZpbmUgaTkx
NV9yZXBvcnRfZXJyb3IoaTkxNSwgZm10LCAuLi4pCQkJCSAgIFwKPiArCV9faTkxNV9wcmludGso
aTkxNSwgS0VSTl9FUlIsIGZtdCwgIyNfX1ZBX0FSR1NfXykKPiAgIAo+ICAgI2lmZGVmIENPTkZJ
R19DT01QQVQKPiAgIGV4dGVybiBsb25nIGk5MTVfY29tcGF0X2lvY3RsKHN0cnVjdCBmaWxlICpm
aWxwLCB1bnNpZ25lZCBpbnQgY21kLAo+IEBAIC0yNTAzLDEyICsyNTAzLDEyIEBAIGV4dGVybiBp
bnQgaTkxNV9kcml2ZXJfbG9hZChzdHJ1Y3QgcGNpX2RldiAqcGRldiwKPiAgIGV4dGVybiB2b2lk
IGk5MTVfZHJpdmVyX3VubG9hZChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KTsKPiAgIAo+ICAgZXh0
ZXJuIHZvaWQgaW50ZWxfZW5naW5lX2luaXRfaGFuZ2NoZWNrKHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSk7Cj4gLWV4dGVybiB2b2lkIGludGVsX2hhbmdjaGVja19pbml0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gLWludCB2bHZfZm9yY2VfZ2Z4X2Nsb2NrKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgYm9vbCBvbik7Cj4gK2V4dGVybiB2b2lk
IGludGVsX2hhbmdjaGVja19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAr
aW50IHZsdl9mb3JjZV9nZnhfY2xvY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGJv
b2wgb24pOwo+ICAgCj4gLXUzMiBpbnRlbF9jYWxjdWxhdGVfbWNyX3Nfc3Nfc2VsZWN0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gK3UzMiBpbnRlbF9jYWxjdWxhdGVfbWNy
X3Nfc3Nfc2VsZWN0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAgIAo+IC1zdGF0
aWMgaW5saW5lIHZvaWQgaTkxNV9xdWV1ZV9oYW5nY2hlY2soc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ICtzdGF0aWMgaW5saW5lIHZvaWQgaTkxNV9xdWV1ZV9oYW5nY2hlY2so
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJdW5zaWduZWQgbG9uZyBk
ZWxheTsKPiAgIAo+IEBAIC0yNTIyLDI4ICsyNTIyLDI4IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBp
OTE1X3F1ZXVlX2hhbmdjaGVjayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
ICAKPiAgIAlkZWxheSA9IHJvdW5kX2ppZmZpZXNfdXBfcmVsYXRpdmUoRFJNX0k5MTVfSEFOR0NI
RUNLX0pJRkZJRVMpOwo+ICAgCXF1ZXVlX2RlbGF5ZWRfd29yayhzeXN0ZW1fbG9uZ193cSwKPiAt
CQkJICAgJmRldl9wcml2LT5ncHVfZXJyb3IuaGFuZ2NoZWNrX3dvcmssIGRlbGF5KTsKPiArCQkJ
ICAgJmk5MTUtPmdwdV9lcnJvci5oYW5nY2hlY2tfd29yaywgZGVsYXkpOwo+ICAgfQo+ICAgCj4g
LXN0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF9ndnRfYWN0aXZlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiArc3RhdGljIGlubGluZSBib29sIGludGVsX2d2dF9hY3RpdmUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlyZXR1cm4gZGV2X3ByaXYtPmd2
dDsKPiArCXJldHVybiBpOTE1LT5ndnQ7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGlubGluZSBib29s
IGludGVsX3ZncHVfYWN0aXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAr
c3RhdGljIGlubGluZSBib29sIGludGVsX3ZncHVfYWN0aXZlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ICAgewo+IC0JcmV0dXJuIGRldl9wcml2LT52Z3B1LmFjdGl2ZTsKPiArCXJl
dHVybiBpOTE1LT52Z3B1LmFjdGl2ZTsKPiAgIH0KPiAgIAo+ICAgLyogaTkxNV9nZW0uYyAqLwo+
IC1pbnQgaTkxNV9nZW1faW5pdF91c2VycHRyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdik7Cj4gLXZvaWQgaTkxNV9nZW1fY2xlYW51cF91c2VycHRyKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdik7Cj4gK2ludCBpOTE1X2dlbV9pbml0X3VzZXJwdHIoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lkIGk5MTVfZ2VtX2NsZWFudXBfdXNlcnB0cihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICB2b2lkIGk5MTVfZ2VtX3Nhbml0aXpl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAtaW50IGk5MTVfZ2VtX2luaXRfZWFy
bHkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtdm9pZCBpOTE1X2dlbV9j
bGVhbnVwX2Vhcmx5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gLXZvaWQg
aTkxNV9nZW1fbG9hZF9pbml0X2ZlbmNlcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpOwo+IC1pbnQgaTkxNV9nZW1fZnJlZXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdik7Cj4gLWludCBpOTE1X2dlbV9mcmVlemVfbGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpOwo+ICtpbnQgaTkxNV9nZW1faW5pdF9lYXJseShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgaTkxNV9nZW1fY2xlYW51cF9lYXJseShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgaTkxNV9nZW1fbG9hZF9pbml0X2ZlbmNlcyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK2ludCBpOTE1X2dlbV9mcmVlemUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICtpbnQgaTkxNV9nZW1fZnJlZXplX2xhdGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgCj4gICBzdGF0aWMgaW5saW5lIHZv
aWQgaTkxNV9nZW1fZHJhaW5fZnJlZWRfb2JqZWN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiAgIHsKPiBAQCAtMjU5MSw3ICsyNTkxLDcgQEAgaTkxNV9nZW1fb2JqZWN0X2dndHRf
cGluKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCj4gICAKPiAgIGludCBpOTE1X2dl
bV9vYmplY3RfdW5iaW5kKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopOwo+ICAgCj4g
LXZvaWQgaTkxNV9nZW1fcnVudGltZV9zdXNwZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdik7Cj4gK3ZvaWQgaTkxNV9nZW1fcnVudGltZV9zdXNwZW5kKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KTsKPiAgIAo+ICAgc3RhdGljIGlubGluZSBpbnQgX19tdXN0X2NoZWNr
Cj4gICBpOTE1X211dGV4X2xvY2tfaW50ZXJydXB0aWJsZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
KQo+IEBAIC0yNjMzLDIwICsyNjMzLDIwIEBAIHN0YXRpYyBpbmxpbmUgdTMyIGk5MTVfcmVzZXRf
ZW5naW5lX2NvdW50KHN0cnVjdCBpOTE1X2dwdV9lcnJvciAqZXJyb3IsCj4gICAJcmV0dXJuIFJF
QURfT05DRShlcnJvci0+cmVzZXRfZW5naW5lX2NvdW50W2VuZ2luZS0+aWRdKTsKPiAgIH0KPiAg
IAo+IC12b2lkIGk5MTVfZ2VtX3NldF93ZWRnZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KTsKPiAtYm9vbCBpOTE1X2dlbV91bnNldF93ZWRnZWQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KTsKPiArdm9pZCBpOTE1X2dlbV9zZXRfd2VkZ2VkKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KTsKPiArYm9vbCBpOTE1X2dlbV91bnNldF93ZWRnZWQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgCj4gICB2b2lkIGk5MTVfZ2VtX2luaXRfbW1p
byhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gLWludCBfX211c3RfY2hlY2sgaTkx
NV9nZW1faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC1pbnQgX19t
dXN0X2NoZWNrIGk5MTVfZ2VtX2luaXRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KTsKPiAtdm9pZCBpOTE1X2dlbV9pbml0X3N3aXp6bGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGk5MTVfZ2VtX2ZpbmlfaHcoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtdm9pZCBpOTE1X2dlbV9maW5pKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdik7Cj4gLWludCBpOTE1X2dlbV93YWl0X2Zvcl9pZGxlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAraW50IF9fbXVzdF9jaGVjayBpOTE1X2dl
bV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAraW50IF9fbXVzdF9jaGVj
ayBpOTE1X2dlbV9pbml0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiArdm9p
ZCBpOTE1X2dlbV9pbml0X3N3aXp6bGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7
Cj4gK3ZvaWQgaTkxNV9nZW1fZmluaV9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7
Cj4gK3ZvaWQgaTkxNV9nZW1fZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4g
K2ludCBpOTE1X2dlbV93YWl0X2Zvcl9pZGxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAo+ICAgCQkJICAgdW5zaWduZWQgaW50IGZsYWdzLCBsb25nIHRpbWVvdXQpOwo+IC12b2lkIGk5
MTVfZ2VtX3N1c3BlbmQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtdm9p
ZCBpOTE1X2dlbV9zdXNwZW5kX2xhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KTsKPiAtdm9pZCBpOTE1X2dlbV9yZXN1bWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KTsKPiArdm9pZCBpOTE1X2dlbV9zdXNwZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KTsKPiArdm9pZCBpOTE1X2dlbV9zdXNwZW5kX2xhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpOwo+ICt2b2lkIGk5MTVfZ2VtX3Jlc3VtZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSk7Cj4gICB2bV9mYXVsdF90IGk5MTVfZ2VtX2ZhdWx0KHN0cnVjdCB2bV9mYXVsdCAq
dm1mKTsKPiAgIAo+ICAgaW50IGk5MTVfZ2VtX29wZW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSk7Cj4gQEAgLTI2NjMsMTIgKzI2NjMsMTIgQEAg
c3RydWN0IGRtYV9idWYgKmk5MTVfZ2VtX3ByaW1lX2V4cG9ydChzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2LAo+ICAgCj4gICAvKiBpOTE1X2dlbV9mZW5jZV9yZWcuYyAqLwo+ICAgc3RydWN0IGRybV9p
OTE1X2ZlbmNlX3JlZyAqCj4gLWk5MTVfcmVzZXJ2ZV9mZW5jZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpOwo+ICtpOTE1X3Jlc2VydmVfZmVuY2Uoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpOwo+ICAgdm9pZCBpOTE1X3VucmVzZXJ2ZV9mZW5jZShzdHJ1Y3QgZHJtX2k5
MTVfZmVuY2VfcmVnICpmZW5jZSk7Cj4gICAKPiAtdm9pZCBpOTE1X2dlbV9yZXN0b3JlX2ZlbmNl
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ICt2b2lkIGk5MTVfZ2VtX3Jl
c3RvcmVfZmVuY2VzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAgIAo+IC12b2lk
IGk5MTVfZ2VtX2RldGVjdF9iaXRfNl9zd2l6emxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdik7Cj4gK3ZvaWQgaTkxNV9nZW1fZGV0ZWN0X2JpdF82X3N3aXp6bGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgdm9pZCBpOTE1X2dlbV9vYmplY3RfZG9fYml0XzE3
X3N3aXp6bGUoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKPiAgIAkJCQkgICAgICAg
c3RydWN0IHNnX3RhYmxlICpwYWdlcyk7Cj4gICB2b2lkIGk5MTVfZ2VtX29iamVjdF9zYXZlX2Jp
dF8xN19zd2l6emxlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCj4gQEAgLTI3MTUs
NDAgKzI3MTUsNDAgQEAgaW50IF9fbXVzdF9jaGVjayBpOTE1X2dlbV9ldmljdF9mb3Jfbm9kZShz
dHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSwKPiAgIAkJCQkJIHVuc2lnbmVkIGludCBmbGFn
cyk7Cj4gICBpbnQgaTkxNV9nZW1fZXZpY3Rfdm0oc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAq
dm0pOwo+ICAgCj4gLXZvaWQgaTkxNV9nZW1fZmx1c2hfZ2d0dF93cml0ZXMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiArdm9pZCBpOTE1X2dlbV9mbHVzaF9nZ3R0X3dyaXRl
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICAKPiAgIC8qIGJlbG9uZ3MgaW4g
aTkxNV9nZW1fZ3R0LmggKi8KPiAtc3RhdGljIGlubGluZSB2b2lkIGk5MTVfZ2VtX2NoaXBzZXRf
Zmx1c2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgaW5saW5l
IHZvaWQgaTkxNV9nZW1fY2hpcHNldF9mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiAgIHsKPiAgIAl3bWIoKTsKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNikKPiAr
CWlmIChJTlRFTF9HRU4oaTkxNSkgPCA2KQo+ICAgCQlpbnRlbF9ndHRfY2hpcHNldF9mbHVzaCgp
Owo+ICAgfQo+ICAgCj4gICAvKiBpOTE1X2dlbV9zdG9sZW4uYyAqLwo+IC1pbnQgaTkxNV9nZW1f
c3RvbGVuX2luc2VydF9ub2RlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAr
aW50IGk5MTVfZ2VtX3N0b2xlbl9pbnNlcnRfbm9kZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiAgIAkJCQlzdHJ1Y3QgZHJtX21tX25vZGUgKm5vZGUsIHU2NCBzaXplLAo+ICAgCQkJ
CXVuc2lnbmVkIGFsaWdubWVudCk7Cj4gLWludCBpOTE1X2dlbV9zdG9sZW5faW5zZXJ0X25vZGVf
aW5fcmFuZ2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtpbnQgaTkxNV9n
ZW1fc3RvbGVuX2luc2VydF9ub2RlX2luX3JhbmdlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ICAgCQkJCQkgc3RydWN0IGRybV9tbV9ub2RlICpub2RlLCB1NjQgc2l6ZSwKPiAgIAkJ
CQkJIHVuc2lnbmVkIGFsaWdubWVudCwgdTY0IHN0YXJ0LAo+ICAgCQkJCQkgdTY0IGVuZCk7Cj4g
LXZvaWQgaTkxNV9nZW1fc3RvbGVuX3JlbW92ZV9ub2RlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiArdm9pZCBpOTE1X2dlbV9zdG9sZW5fcmVtb3ZlX25vZGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJIHN0cnVjdCBkcm1fbW1fbm9kZSAqbm9kZSk7
Cj4gLWludCBpOTE1X2dlbV9pbml0X3N0b2xlbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpOwo+IC12b2lkIGk5MTVfZ2VtX2NsZWFudXBfc3RvbGVuKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdik7Cj4gK2ludCBpOTE1X2dlbV9pbml0X3N0b2xlbihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgaTkxNV9nZW1fY2xlYW51cF9zdG9sZW4oc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKgo+IC1pOTE1X2dlbV9vYmplY3RfY3JlYXRlX3N0b2xlbihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gK2k5MTVfZ2VtX29iamVjdF9jcmVhdGVfc3RvbGVuKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgICAgcmVzb3VyY2Vfc2l6ZV90IHNpemUp
Owo+ICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKgo+IC1pOTE1X2dlbV9vYmplY3RfY3Jl
YXRlX3N0b2xlbl9mb3JfcHJlYWxsb2NhdGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiAraTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zdG9sZW5fZm9yX3ByZWFsbG9jYXRlZChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkJICAgICAgIHJlc291cmNlX3Np
emVfdCBzdG9sZW5fb2Zmc2V0LAo+ICAgCQkJCQkgICAgICAgcmVzb3VyY2Vfc2l6ZV90IGd0dF9v
ZmZzZXQsCj4gICAJCQkJCSAgICAgICByZXNvdXJjZV9zaXplX3Qgc2l6ZSk7Cj4gICAKPiAgIC8q
IGk5MTVfZ2VtX2ludGVybmFsLmMgKi8KPiAgIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICoK
PiAtaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5hbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gK2k5MTVfZ2VtX29iamVjdF9jcmVhdGVfaW50ZXJuYWwoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJcGh5c19hZGRyX3Qgc2l6ZSk7Cj4gICAKPiAg
IC8qIGk5MTVfZ2VtX3Nocmlua2VyLmMgKi8KPiBAQCAtMjc3MSwyMSArMjc3MSwyMSBAQCB2b2lk
IGk5MTVfZ2VtX3Nocmlua2VyX3RhaW50c19tdXRleChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiAgIC8qIGk5MTVfZ2VtX3RpbGluZy5jICovCj4gICBzdGF0aWMgaW5saW5lIGJvb2wg
aTkxNV9nZW1fb2JqZWN0X25lZWRzX2JpdDE3X3N3aXp6bGUoc3RydWN0IGRybV9pOTE1X2dlbV9v
YmplY3QgKm9iaikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUob2JqLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUob2JqLT5iYXNlLmRldik7Cj4gICAKPiAtCXJldHVybiBkZXZfcHJpdi0+bW0u
Yml0XzZfc3dpenpsZV94ID09IEk5MTVfQklUXzZfU1dJWlpMRV85XzEwXzE3ICYmCj4gKwlyZXR1
cm4gaTkxNS0+bW0uYml0XzZfc3dpenpsZV94ID09IEk5MTVfQklUXzZfU1dJWlpMRV85XzEwXzE3
ICYmCj4gICAJCWk5MTVfZ2VtX29iamVjdF9pc190aWxlZChvYmopOwo+ICAgfQo+ICAgCj4gLXUz
MiBpOTE1X2dlbV9mZW5jZV9zaXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwg
dTMyIHNpemUsCj4gK3UzMiBpOTE1X2dlbV9mZW5jZV9zaXplKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LCB1MzIgc2l6ZSwKPiAgIAkJCXVuc2lnbmVkIGludCB0aWxpbmcsIHVuc2lnbmVk
IGludCBzdHJpZGUpOwo+IC11MzIgaTkxNV9nZW1fZmVuY2VfYWxpZ25tZW50KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIHNpemUsCj4gK3UzMiBpOTE1X2dlbV9mZW5jZV9h
bGlnbm1lbnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBzaXplLAo+ICAgCQkJ
ICAgICB1bnNpZ25lZCBpbnQgdGlsaW5nLCB1bnNpZ25lZCBpbnQgc3RyaWRlKTsKPiAgIAo+ICAg
Y29uc3QgY2hhciAqaTkxNV9jYWNoZV9sZXZlbF9zdHIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsIGludCB0eXBlKTsKPiAgIAo+ICAgLyogaTkxNV9jbWRfcGFyc2VyLmMgKi8KPiAtaW50
IGk5MTVfY21kX3BhcnNlcl9nZXRfdmVyc2lvbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpOwo+ICtpbnQgaTkxNV9jbWRfcGFyc2VyX2dldF92ZXJzaW9uKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KTsKPiAgIHZvaWQgaW50ZWxfZW5naW5lX2luaXRfY21kX3BhcnNlcihz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpOwo+ICAgdm9pZCBpbnRlbF9lbmdpbmVfY2xl
YW51cF9jbWRfcGFyc2VyKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7Cj4gICBpbnQg
aW50ZWxfZW5naW5lX2NtZF9wYXJzZXIoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAo+
IEBAIC0yNzk2LDUyICsyNzk2LDUyIEBAIGludCBpbnRlbF9lbmdpbmVfY21kX3BhcnNlcihzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCj4gICAJCQkgICAgYm9vbCBpc19tYXN0ZXIpOwo+
ICAgCj4gICAvKiBpOTE1X3BlcmYuYyAqLwo+IC1leHRlcm4gdm9pZCBpOTE1X3BlcmZfaW5pdChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC1leHRlcm4gdm9pZCBpOTE1X3Bl
cmZfZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC1leHRlcm4gdm9p
ZCBpOTE1X3BlcmZfcmVnaXN0ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsK
PiAtZXh0ZXJuIHZvaWQgaTkxNV9wZXJmX3VucmVnaXN0ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KTsKPiArZXh0ZXJuIHZvaWQgaTkxNV9wZXJmX2luaXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpOwo+ICtleHRlcm4gdm9pZCBpOTE1X3BlcmZfZmluaShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK2V4dGVybiB2b2lkIGk5MTVfcGVyZl9yZWdpc3Rl
cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK2V4dGVybiB2b2lkIGk5MTVfcGVy
Zl91bnJlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAgIAo+ICAgLyog
aTkxNV9zdXNwZW5kLmMgKi8KPiAtZXh0ZXJuIGludCBpOTE1X3NhdmVfc3RhdGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtZXh0ZXJuIGludCBpOTE1X3Jlc3RvcmVfc3Rh
dGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiArZXh0ZXJuIGludCBpOTE1
X3NhdmVfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICtleHRlcm4gaW50
IGk5MTVfcmVzdG9yZV9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICAK
PiAgIC8qIGk5MTVfc3lzZnMuYyAqLwo+IC12b2lkIGk5MTVfc2V0dXBfc3lzZnMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtdm9pZCBpOTE1X3RlYXJkb3duX3N5c2ZzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gK3ZvaWQgaTkxNV9zZXR1cF9zeXNm
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgaTkxNV90ZWFyZG93bl9z
eXNmcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICAKPiAgIC8qIGludGVsX2Rl
dmljZV9pbmZvLmMgKi8KPiAgIHN0YXRpYyBpbmxpbmUgc3RydWN0IGludGVsX2RldmljZV9pbmZv
ICoKPiAtbWt3cml0ZV9kZXZpY2VfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gK21rd3JpdGVfZGV2aWNlX2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gICB7Cj4gLQlyZXR1cm4gKHN0cnVjdCBpbnRlbF9kZXZpY2VfaW5mbyAqKUlOVEVMX0lORk8o
ZGV2X3ByaXYpOwo+ICsJcmV0dXJuIChzdHJ1Y3QgaW50ZWxfZGV2aWNlX2luZm8gKilJTlRFTF9J
TkZPKGk5MTUpOwo+ICAgfQo+ICAgCj4gICAvKiBtb2Rlc2V0dGluZyAqLwo+ICAgZXh0ZXJuIHZv
aWQgaW50ZWxfbW9kZXNldF9pbml0X2h3KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpOwo+ICAgZXh0
ZXJuIGludCBpbnRlbF9tb2Rlc2V0X2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldik7Cj4gICBl
eHRlcm4gdm9pZCBpbnRlbF9tb2Rlc2V0X2NsZWFudXAoc3RydWN0IGRybV9kZXZpY2UgKmRldik7
Cj4gLWV4dGVybiBpbnQgaW50ZWxfbW9kZXNldF92Z2Ffc2V0X3N0YXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiArZXh0ZXJuIGludCBpbnRlbF9tb2Rlc2V0X3ZnYV9zZXRf
c3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgICAgIGJvb2wg
c3RhdGUpOwo+ICAgZXh0ZXJuIHZvaWQgaW50ZWxfZGlzcGxheV9yZXN1bWUoc3RydWN0IGRybV9k
ZXZpY2UgKmRldik7Cj4gLWV4dGVybiB2b2lkIGk5MTVfcmVkaXNhYmxlX3ZnYShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC1leHRlcm4gdm9pZCBpOTE1X3JlZGlzYWJsZV92
Z2FfcG93ZXJfb24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtZXh0ZXJu
IHZvaWQgaW50ZWxfaW5pdF9wY2hfcmVmY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdik7Cj4gK2V4dGVybiB2b2lkIGk5MTVfcmVkaXNhYmxlX3ZnYShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSk7Cj4gK2V4dGVybiB2b2lkIGk5MTVfcmVkaXNhYmxlX3ZnYV9wb3dlcl9v
bihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK2V4dGVybiB2b2lkIGludGVsX2lu
aXRfcGNoX3JlZmNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICAKPiAgIGlu
dCBpOTE1X3JlZ19yZWFkX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEs
Cj4gICAJCQlzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpOwo+ICAgCj4gICBleHRlcm4gc3RydWN0IGlu
dGVsX2Rpc3BsYXlfZXJyb3Jfc3RhdGUgKgo+IC1pbnRlbF9kaXNwbGF5X2NhcHR1cmVfZXJyb3Jf
c3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAraW50ZWxfZGlzcGxh
eV9jYXB0dXJlX2Vycm9yX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAg
IGV4dGVybiB2b2lkIGludGVsX2Rpc3BsYXlfcHJpbnRfZXJyb3Jfc3RhdGUoc3RydWN0IGRybV9p
OTE1X2Vycm9yX3N0YXRlX2J1ZiAqZSwKPiAgIAkJCQkJICAgIHN0cnVjdCBpbnRlbF9kaXNwbGF5
X2Vycm9yX3N0YXRlICplcnJvcik7Cj4gICAKPiAgICNkZWZpbmUgX19JOTE1X1JFR19PUChvcF9f
LCBkZXZfcHJpdl9fLCAuLi4pIFwKPiAgIAlpbnRlbF91bmNvcmVfIyNvcF9fKCYoZGV2X3ByaXZf
XyktPnVuY29yZSwgX19WQV9BUkdTX18pCj4gICAKPiAtI2RlZmluZSBJOTE1X1JFQUQocmVnX18p
CSBfX0k5MTVfUkVHX09QKHJlYWQsIGRldl9wcml2LCAocmVnX18pKQo+IC0jZGVmaW5lIEk5MTVf
V1JJVEUocmVnX18sIHZhbF9fKSBfX0k5MTVfUkVHX09QKHdyaXRlLCBkZXZfcHJpdiwgKHJlZ19f
KSwgKHZhbF9fKSkKPiArI2RlZmluZSBJOTE1X1JFQUQocmVnX18pCSBfX0k5MTVfUkVHX09QKHJl
YWQsIGk5MTUsIChyZWdfXykpCj4gKyNkZWZpbmUgSTkxNV9XUklURShyZWdfXywgdmFsX18pIF9f
STkxNV9SRUdfT1Aod3JpdGUsIGk5MTUsIChyZWdfXyksICh2YWxfXykpCj4gICAKPiAtI2RlZmlu
ZSBQT1NUSU5HX1JFQUQocmVnX18pCV9fSTkxNV9SRUdfT1AocG9zdGluZ19yZWFkLCBkZXZfcHJp
diwgKHJlZ19fKSkKPiArI2RlZmluZSBQT1NUSU5HX1JFQUQocmVnX18pCV9fSTkxNV9SRUdfT1Ao
cG9zdGluZ19yZWFkLCBpOTE1LCAocmVnX18pKQo+ICAgCj4gICAvKiBUaGVzZSBhcmUgdW50cmFj
ZWQgbW1pby1hY2Nlc3NvcnMgdGhhdCBhcmUgb25seSB2YWxpZCB0byBiZSB1c2VkIGluc2lkZQo+
ICAgICogY3JpdGljYWwgc2VjdGlvbnMsIHN1Y2ggYXMgaW5zaWRlIElSUSBoYW5kbGVycywgd2hl
cmUgZm9yY2V3YWtlIGlzIGV4cGxpY2l0bHkKPiBAQCAtMjg1MSwxMyArMjg1MSwxMyBAQCBleHRl
cm4gdm9pZCBpbnRlbF9kaXNwbGF5X3ByaW50X2Vycm9yX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9l
cnJvcl9zdGF0ZV9idWYgKmUsCj4gICAgKgo+ICAgICogQXMgYW4gZXhhbXBsZSwgdGhlc2UgYWNj
ZXNzb3JzIGNhbiBwb3NzaWJseSBiZSB1c2VkIGJldHdlZW46Cj4gICAgKgo+IC0gKiBzcGluX2xv
Y2tfaXJxKCZkZXZfcHJpdi0+dW5jb3JlLmxvY2spOwo+ICsgKiBzcGluX2xvY2tfaXJxKCZpOTE1
LT51bmNvcmUubG9jayk7Cj4gICAgKiBpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldF9fbG9ja2Vk
KCk7Cj4gICAgKgo+ICAgICogYW5kCj4gICAgKgo+ICAgICogaW50ZWxfdW5jb3JlX2ZvcmNld2Fr
ZV9wdXRfX2xvY2tlZCgpOwo+IC0gKiBzcGluX3VubG9ja19pcnEoJmRldl9wcml2LT51bmNvcmUu
bG9jayk7Cj4gKyAqIHNwaW5fdW5sb2NrX2lycSgmaTkxNS0+dW5jb3JlLmxvY2spOwo+ICAgICoK
PiAgICAqCj4gICAgKiBOb3RlOiBzb21lIHJlZ2lzdGVycyBtYXkgbm90IG5lZWQgZm9yY2V3YWtl
IGhlbGQsIHNvCj4gQEAgLTI4NjYsMTggKzI4NjYsMTggQEAgZXh0ZXJuIHZvaWQgaW50ZWxfZGlz
cGxheV9wcmludF9lcnJvcl9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfZXJyb3Jfc3RhdGVfYnVmICpl
LAo+ICAgICoKPiAgICAqIENlcnRhaW4gYXJjaGl0ZWN0dXJlcyB3aWxsIGRpZSBpZiB0aGUgc2Ft
ZSBjYWNoZWxpbmUgaXMgY29uY3VycmVudGx5IGFjY2Vzc2VkCj4gICAgKiBieSBkaWZmZXJlbnQg
Y2xpZW50cyAoZS5nLiBvbiBJdnlicmlkZ2UpLiBBY2Nlc3MgdG8gcmVnaXN0ZXJzIHNob3VsZAo+
IC0gKiB0aGVyZWZvcmUgZ2VuZXJhbGx5IGJlIHNlcmlhbGlzZWQsIGJ5IGVpdGhlciB0aGUgZGV2
X3ByaXYtPnVuY29yZS5sb2NrIG9yCj4gKyAqIHRoZXJlZm9yZSBnZW5lcmFsbHkgYmUgc2VyaWFs
aXNlZCwgYnkgZWl0aGVyIHRoZSBpOTE1LT51bmNvcmUubG9jayBvcgo+ICAgICogYSBtb3JlIGxv
Y2FsaXNlZCBsb2NrIGd1YXJkaW5nIGFsbCBhY2Nlc3MgdG8gdGhhdCBiYW5rIG9mIHJlZ2lzdGVy
cy4KPiAgICAqLwo+IC0jZGVmaW5lIEk5MTVfUkVBRF9GVyhyZWdfXykgX19JOTE1X1JFR19PUChy
ZWFkX2Z3LCBkZXZfcHJpdiwgKHJlZ19fKSkKPiAtI2RlZmluZSBJOTE1X1dSSVRFX0ZXKHJlZ19f
LCB2YWxfXykgX19JOTE1X1JFR19PUCh3cml0ZV9mdywgZGV2X3ByaXYsIChyZWdfXyksICh2YWxf
XykpCj4gKyNkZWZpbmUgSTkxNV9SRUFEX0ZXKHJlZ19fKSBfX0k5MTVfUkVHX09QKHJlYWRfZncs
IGk5MTUsIChyZWdfXykpCj4gKyNkZWZpbmUgSTkxNV9XUklURV9GVyhyZWdfXywgdmFsX18pIF9f
STkxNV9SRUdfT1Aod3JpdGVfZncsIGk5MTUsIChyZWdfXyksICh2YWxfXykpCj4gICAKPiAgIC8q
ICJCcm9hZGNhc3QgUkdCIiBwcm9wZXJ0eSAqLwo+ICAgI2RlZmluZSBJTlRFTF9CUk9BRENBU1Rf
UkdCX0FVVE8gMAo+ICAgI2RlZmluZSBJTlRFTF9CUk9BRENBU1RfUkdCX0ZVTEwgMQo+ICAgI2Rl
ZmluZSBJTlRFTF9CUk9BRENBU1RfUkdCX0xJTUlURUQgMgo+ICAgCj4gLXZvaWQgaTkxNV9tZW1j
cHlfaW5pdF9lYXJseShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ICt2b2lk
IGk5MTVfbWVtY3B5X2luaXRfZWFybHkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+
ICAgYm9vbCBpOTE1X21lbWNweV9mcm9tX3djKHZvaWQgKmRzdCwgY29uc3Qgdm9pZCAqc3JjLCB1
bnNpZ25lZCBsb25nIGxlbik7Cj4gICAKPiAgIC8qIFRoZSBtb3ZudGRxYSBpbnN0cnVjdGlvbnMg
dXNlZCBmb3IgbWVtY3B5LWZyb20td2MgcmVxdWlyZSAxNi1ieXRlIGFsaWdubWVudCwKPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZ2VtLmMKPiBpbmRleCA0MDE3ZWNmNTYxZjYuLjE3NzRjNzYwNDA3NiAxMDA2
NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCj4gKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwo+IEBAIC0xNDksNyArMTQ5LDcgQEAgaTkxNV9nZW1f
cGh5c19wd3JpdGUoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKPiAgIAo+ICAgc3Rh
dGljIGludAo+ICAgaTkxNV9nZW1fY3JlYXRlKHN0cnVjdCBkcm1fZmlsZSAqZmlsZSwKPiAtCQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gKwkJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gICAJCXU2NCAqc2l6ZV9wLAo+ICAgCQl1MzIgKmhhbmRsZV9wKQo+ICAg
ewo+IEBAIC0xNjMsNyArMTYzLDcgQEAgaTkxNV9nZW1fY3JlYXRlKHN0cnVjdCBkcm1fZmlsZSAq
ZmlsZSwKPiAgIAkJcmV0dXJuIC1FSU5WQUw7Cj4gICAKPiAgIAkvKiBBbGxvY2F0ZSB0aGUgbmV3
IG9iamVjdCAqLwo+IC0Jb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zaG1lbShkZXZfcHJp
diwgc2l6ZSk7Cj4gKwlvYmogPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3NobWVtKGk5MTUsIHNp
emUpOwo+ICAgCWlmIChJU19FUlIob2JqKSkKPiAgIAkJcmV0dXJuIFBUUl9FUlIob2JqKTsKPiAg
IAo+IEBAIC0yMjMsMTYgKzIyMywxNiBAQCBpbnQKPiAgIGk5MTVfZ2VtX2NyZWF0ZV9pb2N0bChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ICAgCQkgICAgICBzdHJ1Y3QgZHJt
X2ZpbGUgKmZpbGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoZGV2KTsKPiAgIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2NyZWF0ZSAqYXJncyA9IGRhdGE7Cj4g
ICAKPiAtCWk5MTVfZ2VtX2ZsdXNoX2ZyZWVfb2JqZWN0cyhkZXZfcHJpdik7Cj4gKwlpOTE1X2dl
bV9mbHVzaF9mcmVlX29iamVjdHMoaTkxNSk7Cj4gICAKPiAtCXJldHVybiBpOTE1X2dlbV9jcmVh
dGUoZmlsZSwgZGV2X3ByaXYsCj4gKwlyZXR1cm4gaTkxNV9nZW1fY3JlYXRlKGZpbGUsIGk5MTUs
Cj4gICAJCQkgICAgICAgJmFyZ3MtPnNpemUsICZhcmdzLT5oYW5kbGUpOwo+ICAgfQo+ICAgCj4g
LXZvaWQgaTkxNV9nZW1fZmx1c2hfZ2d0dF93cml0ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICt2b2lkIGk5MTVfZ2VtX2ZsdXNoX2dndHRfd3JpdGVzKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+
ICAgCj4gQEAgLTI1NywxMyArMjU3LDEzIEBAIHZvaWQgaTkxNV9nZW1fZmx1c2hfZ2d0dF93cml0
ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCj4gICAJd21iKCk7Cj4g
ICAKPiAtCWlmIChJTlRFTF9JTkZPKGRldl9wcml2KS0+aGFzX2NvaGVyZW50X2dndHQpCj4gKwlp
ZiAoSU5URUxfSU5GTyhpOTE1KS0+aGFzX2NvaGVyZW50X2dndHQpCj4gICAJCXJldHVybjsKPiAg
IAo+IC0JaTkxNV9nZW1fY2hpcHNldF9mbHVzaChkZXZfcHJpdik7Cj4gKwlpOTE1X2dlbV9jaGlw
c2V0X2ZsdXNoKGk5MTUpOwo+ICAgCj4gLQl3aXRoX2ludGVsX3J1bnRpbWVfcG0oZGV2X3ByaXYs
IHdha2VyZWYpIHsKPiAtCQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYt
PnVuY29yZTsKPiArCXdpdGhfaW50ZWxfcnVudGltZV9wbShpOTE1LCB3YWtlcmVmKSB7Cj4gKwkJ
c3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsKPiAgIAo+ICAgCQlz
cGluX2xvY2tfaXJxKCZ1bmNvcmUtPmxvY2spOwo+ICAgCQlpbnRlbF91bmNvcmVfcG9zdGluZ19y
ZWFkX2Z3KHVuY29yZSwKPiBAQCAtODg0LDcgKzg4NCw3IEBAIGk5MTVfZ2VtX3N3X2ZpbmlzaF9p
b2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ICAgCXJldHVybiAwOwo+
ICAgfQo+ICAgCj4gLXZvaWQgaTkxNV9nZW1fcnVudGltZV9zdXNwZW5kKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBpOTE1X2dlbV9ydW50aW1lX3N1c3BlbmQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKm9iaiwgKm9uOwo+ICAgCWludCBpOwo+IEBAIC04OTcsMTUgKzg5NywxNSBAQCB2
b2lkIGk5MTVfZ2VtX3J1bnRpbWVfc3VzcGVuZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gICAJICovCj4gICAKPiAgIAlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUob2JqLCBv
biwKPiAtCQkJCSAmZGV2X3ByaXYtPm1tLnVzZXJmYXVsdF9saXN0LCB1c2VyZmF1bHRfbGluaykK
PiArCQkJCSAmaTkxNS0+bW0udXNlcmZhdWx0X2xpc3QsIHVzZXJmYXVsdF9saW5rKQo+ICAgCQlf
X2k5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXAob2JqKTsKPiAgIAo+ICAgCS8qIFRoZSBmZW5j
ZSB3aWxsIGJlIGxvc3Qgd2hlbiB0aGUgZGV2aWNlIHBvd2VycyBkb3duLiBJZiBhbnkgd2VyZQo+
ICAgCSAqIGluIHVzZSBieSBoYXJkd2FyZSAoaS5lLiB0aGV5IGFyZSBwaW5uZWQpLCB3ZSBzaG91
bGQgbm90IGJlIHBvd2VyaW5nCj4gICAJICogZG93biEgQWxsIG90aGVyIGZlbmNlcyB3aWxsIGJl
IHJlYWNxdWlyZWQgYnkgdGhlIHVzZXIgdXBvbiB3YWtpbmcuCj4gICAJICovCj4gLQlmb3IgKGkg
PSAwOyBpIDwgZGV2X3ByaXYtPm51bV9mZW5jZV9yZWdzOyBpKyspIHsKPiAtCQlzdHJ1Y3QgZHJt
X2k5MTVfZmVuY2VfcmVnICpyZWcgPSAmZGV2X3ByaXYtPmZlbmNlX3JlZ3NbaV07Cj4gKwlmb3Ig
KGkgPSAwOyBpIDwgaTkxNS0+bnVtX2ZlbmNlX3JlZ3M7IGkrKykgewo+ICsJCXN0cnVjdCBkcm1f
aTkxNV9mZW5jZV9yZWcgKnJlZyA9ICZpOTE1LT5mZW5jZV9yZWdzW2ldOwo+ICAgCj4gICAJCS8q
IElkZWFsbHkgd2Ugd2FudCB0byBhc3NlcnQgdGhhdCB0aGUgZmVuY2UgcmVnaXN0ZXIgaXMgbm90
Cj4gICAJCSAqIGxpdmUgYXQgdGhpcyBwb2ludCAoaS5lLiB0aGF0IG5vIHBpZWNlIG9mIGNvZGUg
d2lsbCBiZQo+IEBAIC0xMDIwLDggKzEwMjAsOCBAQCBpOTE1X2dlbV9vYmplY3RfZ2d0dF9waW4o
c3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKPiAgIAkJCSB1NjQgYWxpZ25tZW50LAo+
ICAgCQkJIHU2NCBmbGFncykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUob2JqLT5iYXNlLmRldik7Cj4gLQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3Nw
YWNlICp2bSA9ICZkZXZfcHJpdi0+Z2d0dC52bTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShvYmotPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBpOTE1X2FkZHJlc3Nf
c3BhY2UgKnZtID0gJmk5MTUtPmdndHQudm07Cj4gICAJc3RydWN0IGk5MTVfdm1hICp2bWE7Cj4g
ICAJaW50IHJldDsKPiAgIAo+IEBAIC0xMDM2LDcgKzEwMzYsNyBAQCBpOTE1X2dlbV9vYmplY3Rf
Z2d0dF9waW4oc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKPiAgIAkJICogdGhlIG9i
amVjdCBpbiBhbmQgb3V0IG9mIHRoZSBHbG9iYWwgR1RUIGFuZAo+ICAgCQkgKiB3YXN0ZSBhIGxv
dCBvZiBjeWNsZXMgdW5kZXIgdGhlIG11dGV4Lgo+ICAgCQkgKi8KPiAtCQlpZiAob2JqLT5iYXNl
LnNpemUgPiBkZXZfcHJpdi0+Z2d0dC5tYXBwYWJsZV9lbmQpCj4gKwkJaWYgKG9iai0+YmFzZS5z
aXplID4gaTkxNS0+Z2d0dC5tYXBwYWJsZV9lbmQpCj4gICAJCQlyZXR1cm4gRVJSX1BUUigtRTJC
SUcpOwo+ICAgCj4gICAJCS8qIElmIE5PTkJMT0NLIGlzIHNldCB0aGUgY2FsbGVyIGlzIG9wdGlt
aXN0aWNhbGx5Cj4gQEAgLTEwNTUsNyArMTA1NSw3IEBAIGk5MTVfZ2VtX29iamVjdF9nZ3R0X3Bp
bihzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAo+ICAgCQkgKiB3ZSBjb3VsZCB0cnkg
dG8gbWluaW1pc2UgaGFybSB0byBvdGhlcnMuCj4gICAJCSAqLwo+ICAgCQlpZiAoZmxhZ3MgJiBQ
SU5fTk9OQkxPQ0sgJiYKPiAtCQkgICAgb2JqLT5iYXNlLnNpemUgPiBkZXZfcHJpdi0+Z2d0dC5t
YXBwYWJsZV9lbmQgLyAyKQo+ICsJCSAgICBvYmotPmJhc2Uuc2l6ZSA+IGk5MTUtPmdndHQubWFw
cGFibGVfZW5kIC8gMikKPiAgIAkJCXJldHVybiBFUlJfUFRSKC1FTk9TUEMpOwo+ICAgCX0KPiAg
IAo+IEBAIC0xMDY5LDcgKzEwNjksNyBAQCBpOTE1X2dlbV9vYmplY3RfZ2d0dF9waW4oc3RydWN0
IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKPiAgIAkJCQlyZXR1cm4gRVJSX1BUUigtRU5PU1BD
KTsKPiAgIAo+ICAgCQkJaWYgKGZsYWdzICYgUElOX01BUFBBQkxFICYmCj4gLQkJCSAgICB2bWEt
PmZlbmNlX3NpemUgPiBkZXZfcHJpdi0+Z2d0dC5tYXBwYWJsZV9lbmQgLyAyKQo+ICsJCQkgICAg
dm1hLT5mZW5jZV9zaXplID4gaTkxNS0+Z2d0dC5tYXBwYWJsZV9lbmQgLyAyKQo+ICAgCQkJCXJl
dHVybiBFUlJfUFRSKC1FTk9TUEMpOwo+ICAgCQl9Cj4gICAKPiBAQCAtMTIwMiwzMCArMTIwMiwz
MCBAQCB2b2lkIGk5MTVfZ2VtX3Nhbml0aXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ICAgCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICB9Cj4gICAK
PiAtdm9pZCBpOTE1X2dlbV9pbml0X3N3aXp6bGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gK3ZvaWQgaTkxNV9nZW1faW5pdF9zd2l6emxpbmcoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDUgfHwK
PiAtCSAgICBkZXZfcHJpdi0+bW0uYml0XzZfc3dpenpsZV94ID09IEk5MTVfQklUXzZfU1dJWlpM
RV9OT05FKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8IDUgfHwKPiArCSAgICBpOTE1LT5tbS5i
aXRfNl9zd2l6emxlX3ggPT0gSTkxNV9CSVRfNl9TV0laWkxFX05PTkUpCj4gICAJCXJldHVybjsK
PiAgIAo+ICAgCUk5MTVfV1JJVEUoRElTUF9BUkJfQ1RMLCBJOTE1X1JFQUQoRElTUF9BUkJfQ1RM
KSB8Cj4gICAJCQkJIERJU1BfVElMRV9TVVJGQUNFX1NXSVpaTElORyk7Cj4gICAKPiAtCWlmIChJ
U19HRU4oZGV2X3ByaXYsIDUpKQo+ICsJaWYgKElTX0dFTihpOTE1LCA1KSkKPiAgIAkJcmV0dXJu
Owo+ICAgCj4gICAJSTkxNV9XUklURShUSUxFQ1RMLCBJOTE1X1JFQUQoVElMRUNUTCkgfCBUSUxF
Q1RMX1NXWkNUTCk7Cj4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCA2KSkKPiArCWlmIChJU19HRU4o
aTkxNSwgNikpCj4gICAJCUk5MTVfV1JJVEUoQVJCX01PREUsIF9NQVNLRURfQklUX0VOQUJMRShB
UkJfTU9ERV9TV0laWkxFX1NOQikpOwo+IC0JZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCA3KSkK
PiArCWVsc2UgaWYgKElTX0dFTihpOTE1LCA3KSkKPiAgIAkJSTkxNV9XUklURShBUkJfTU9ERSwg
X01BU0tFRF9CSVRfRU5BQkxFKEFSQl9NT0RFX1NXSVpaTEVfSVZCKSk7Cj4gLQllbHNlIGlmIChJ
U19HRU4oZGV2X3ByaXYsIDgpKQo+ICsJZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDgpKQo+ICAgCQlJ
OTE1X1dSSVRFKEdBTVRBUkJNT0RFLCBfTUFTS0VEX0JJVF9FTkFCTEUoQVJCX01PREVfU1dJWlpM
RV9CRFcpKTsKPiAgIAllbHNlCj4gICAJCUJVRygpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lk
IGluaXRfdW51c2VkX3Jpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIg
YmFzZSkKPiArc3RhdGljIHZvaWQgaW5pdF91bnVzZWRfcmluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwgdTMyIGJhc2UpCj4gICB7Cj4gICAJSTkxNV9XUklURShSSU5HX0NUTChiYXNl
KSwgMCk7Cj4gICAJSTkxNV9XUklURShSSU5HX0hFQUQoYmFzZSksIDApOwo+IEBAIC0xMjMzLDQ1
ICsxMjMzLDQ1IEBAIHN0YXRpYyB2b2lkIGluaXRfdW51c2VkX3Jpbmcoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgYmFzZSkKPiAgIAlJOTE1X1dSSVRFKFJJTkdfU1RBUlQo
YmFzZSksIDApOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGluaXRfdW51c2VkX3JpbmdzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaW5pdF91bnVz
ZWRfcmluZ3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlpZiAoSVNf
STgzMChkZXZfcHJpdikpIHsKPiAtCQlpbml0X3VudXNlZF9yaW5nKGRldl9wcml2LCBQUkIxX0JB
U0UpOwo+IC0JCWluaXRfdW51c2VkX3JpbmcoZGV2X3ByaXYsIFNSQjBfQkFTRSk7Cj4gLQkJaW5p
dF91bnVzZWRfcmluZyhkZXZfcHJpdiwgU1JCMV9CQVNFKTsKPiAtCQlpbml0X3VudXNlZF9yaW5n
KGRldl9wcml2LCBTUkIyX0JBU0UpOwo+IC0JCWluaXRfdW51c2VkX3JpbmcoZGV2X3ByaXYsIFNS
QjNfQkFTRSk7Cj4gLQl9IGVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgMikpIHsKPiAtCQlpbml0
X3VudXNlZF9yaW5nKGRldl9wcml2LCBTUkIwX0JBU0UpOwo+IC0JCWluaXRfdW51c2VkX3Jpbmco
ZGV2X3ByaXYsIFNSQjFfQkFTRSk7Cj4gLQl9IGVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgMykp
IHsKPiAtCQlpbml0X3VudXNlZF9yaW5nKGRldl9wcml2LCBQUkIxX0JBU0UpOwo+IC0JCWluaXRf
dW51c2VkX3JpbmcoZGV2X3ByaXYsIFBSQjJfQkFTRSk7Cj4gKwlpZiAoSVNfSTgzMChpOTE1KSkg
ewo+ICsJCWluaXRfdW51c2VkX3JpbmcoaTkxNSwgUFJCMV9CQVNFKTsKPiArCQlpbml0X3VudXNl
ZF9yaW5nKGk5MTUsIFNSQjBfQkFTRSk7Cj4gKwkJaW5pdF91bnVzZWRfcmluZyhpOTE1LCBTUkIx
X0JBU0UpOwo+ICsJCWluaXRfdW51c2VkX3JpbmcoaTkxNSwgU1JCMl9CQVNFKTsKPiArCQlpbml0
X3VudXNlZF9yaW5nKGk5MTUsIFNSQjNfQkFTRSk7Cj4gKwl9IGVsc2UgaWYgKElTX0dFTihpOTE1
LCAyKSkgewo+ICsJCWluaXRfdW51c2VkX3JpbmcoaTkxNSwgU1JCMF9CQVNFKTsKPiArCQlpbml0
X3VudXNlZF9yaW5nKGk5MTUsIFNSQjFfQkFTRSk7Cj4gKwl9IGVsc2UgaWYgKElTX0dFTihpOTE1
LCAzKSkgewo+ICsJCWluaXRfdW51c2VkX3JpbmcoaTkxNSwgUFJCMV9CQVNFKTsKPiArCQlpbml0
X3VudXNlZF9yaW5nKGk5MTUsIFBSQjJfQkFTRSk7Cj4gICAJfQo+ICAgfQo+ICAgCj4gLWludCBp
OTE1X2dlbV9pbml0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAraW50
IGk5MTVfZ2VtX2luaXRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4g
ICAJaW50IHJldDsKPiAgIAo+IC0JZGV2X3ByaXYtPmd0Lmxhc3RfaW5pdF90aW1lID0ga3RpbWVf
Z2V0KCk7Cj4gKwlpOTE1LT5ndC5sYXN0X2luaXRfdGltZSA9IGt0aW1lX2dldCgpOwo+ICAgCj4g
ICAJLyogRG91YmxlIGxheWVyIHNlY3VyaXR5IGJsYW5rZXQsIHNlZSBpOTE1X2dlbV9pbml0KCkg
Ki8KPiAtCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JD
RVdBS0VfQUxMKTsKPiArCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZpOTE1LT51bmNvcmUs
IEZPUkNFV0FLRV9BTEwpOwo+ICAgCj4gLQlpZiAoSEFTX0VEUkFNKGRldl9wcml2KSAmJiBJTlRF
TF9HRU4oZGV2X3ByaXYpIDwgOSkKPiArCWlmIChIQVNfRURSQU0oaTkxNSkgJiYgSU5URUxfR0VO
KGk5MTUpIDwgOSkKPiAgIAkJSTkxNV9XUklURShIU1dfSURJQ1IsIEk5MTVfUkVBRChIU1dfSURJ
Q1IpIHwgSURJSEFTSE1TSygweGYpKTsKPiAgIAo+IC0JaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYp
KQo+IC0JCUk5MTVfV1JJVEUoTUlfUFJFRElDQVRFX1JFU1VMVF8yLCBJU19IU1dfR1QzKGRldl9w
cml2KSA/Cj4gKwlpZiAoSVNfSEFTV0VMTChpOTE1KSkKPiArCQlJOTE1X1dSSVRFKE1JX1BSRURJ
Q0FURV9SRVNVTFRfMiwgSVNfSFNXX0dUMyhpOTE1KSA/Cj4gICAJCQkgICBMT1dFUl9TTElDRV9F
TkFCTEVEIDogTE9XRVJfU0xJQ0VfRElTQUJMRUQpOwo+ICAgCj4gICAJLyogQXBwbHkgdGhlIEdU
IHdvcmthcm91bmRzLi4uICovCj4gLQlpbnRlbF9ndF9hcHBseV93b3JrYXJvdW5kcyhkZXZfcHJp
dik7Cj4gKwlpbnRlbF9ndF9hcHBseV93b3JrYXJvdW5kcyhpOTE1KTsKPiAgIAkvKiAuLi5hbmQg
ZGV0ZXJtaW5lIHdoZXRoZXIgdGhleSBhcmUgc3RpY2tpbmcuICovCj4gLQlpbnRlbF9ndF92ZXJp
Znlfd29ya2Fyb3VuZHMoZGV2X3ByaXYsICJpbml0Iik7Cj4gKwlpbnRlbF9ndF92ZXJpZnlfd29y
a2Fyb3VuZHMoaTkxNSwgImluaXQiKTsKPiAgIAo+IC0JaTkxNV9nZW1faW5pdF9zd2l6emxpbmco
ZGV2X3ByaXYpOwo+ICsJaTkxNV9nZW1faW5pdF9zd2l6emxpbmcoaTkxNSk7Cj4gICAKPiAgIAkv
Kgo+ICAgCSAqIEF0IGxlYXN0IDgzMCBjYW4gbGVhdmUgc29tZSBvZiB0aGUgdW51c2VkIHJpbmdz
Cj4gQEAgLTEyNzksNDggKzEyNzksNDggQEAgaW50IGk5MTVfZ2VtX2luaXRfaHcoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCSAqIHdpbGwgcHJldmVudCBjMyBlbnRyeS4g
TWFrZXMgc3VyZSBhbGwgdW51c2VkIHJpbmdzCj4gICAJICogYXJlIHRvdGFsbHkgaWRsZS4KPiAg
IAkgKi8KPiAtCWluaXRfdW51c2VkX3JpbmdzKGRldl9wcml2KTsKPiArCWluaXRfdW51c2VkX3Jp
bmdzKGk5MTUpOwo+ICAgCj4gLQlCVUdfT04oIWRldl9wcml2LT5rZXJuZWxfY29udGV4dCk7Cj4g
LQlyZXQgPSBpOTE1X3Rlcm1pbmFsbHlfd2VkZ2VkKGRldl9wcml2KTsKPiArCUJVR19PTighaTkx
NS0+a2VybmVsX2NvbnRleHQpOwo+ICsJcmV0ID0gaTkxNV90ZXJtaW5hbGx5X3dlZGdlZChpOTE1
KTsKPiAgIAlpZiAocmV0KQo+ICAgCQlnb3RvIG91dDsKPiAgIAo+IC0JcmV0ID0gaTkxNV9wcGd0
dF9pbml0X2h3KGRldl9wcml2KTsKPiArCXJldCA9IGk5MTVfcHBndHRfaW5pdF9odyhpOTE1KTsK
PiAgIAlpZiAocmV0KSB7Cj4gICAJCURSTV9FUlJPUigiRW5hYmxpbmcgUFBHVFQgZmFpbGVkICgl
ZClcbiIsIHJldCk7Cj4gICAJCWdvdG8gb3V0Owo+ICAgCX0KPiAgIAo+IC0JcmV0ID0gaW50ZWxf
d29wY21faW5pdF9odygmZGV2X3ByaXYtPndvcGNtKTsKPiArCXJldCA9IGludGVsX3dvcGNtX2lu
aXRfaHcoJmk5MTUtPndvcGNtKTsKPiAgIAlpZiAocmV0KSB7Cj4gICAJCURSTV9FUlJPUigiRW5h
YmxpbmcgV09QQ00gZmFpbGVkICglZClcbiIsIHJldCk7Cj4gICAJCWdvdG8gb3V0Owo+ICAgCX0K
PiAgIAo+ICAgCS8qIFdlIGNhbid0IGVuYWJsZSBjb250ZXh0cyB1bnRpbCBhbGwgZmlybXdhcmUg
aXMgbG9hZGVkICovCj4gLQlyZXQgPSBpbnRlbF91Y19pbml0X2h3KGRldl9wcml2KTsKPiArCXJl
dCA9IGludGVsX3VjX2luaXRfaHcoaTkxNSk7Cj4gICAJaWYgKHJldCkgewo+ICAgCQlEUk1fRVJS
T1IoIkVuYWJsaW5nIHVjIGZhaWxlZCAoJWQpXG4iLCByZXQpOwo+ICAgCQlnb3RvIG91dDsKPiAg
IAl9Cj4gICAKPiAtCWludGVsX21vY3NfaW5pdF9sM2NjX3RhYmxlKGRldl9wcml2KTsKPiArCWlu
dGVsX21vY3NfaW5pdF9sM2NjX3RhYmxlKGk5MTUpOwo+ICAgCj4gICAJLyogT25seSB3aGVuIHRo
ZSBIVyBpcyByZS1pbml0aWFsaXNlZCwgY2FuIHdlIHJlcGxheSB0aGUgcmVxdWVzdHMgKi8KPiAt
CXJldCA9IGludGVsX2VuZ2luZXNfcmVzdW1lKGRldl9wcml2KTsKPiArCXJldCA9IGludGVsX2Vu
Z2luZXNfcmVzdW1lKGk5MTUpOwo+ICAgCWlmIChyZXQpCj4gICAJCWdvdG8gY2xlYW51cF91YzsK
PiAgIAo+IC0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZP
UkNFV0FLRV9BTEwpOwo+ICsJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmk5MTUtPnVuY29y
ZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gICAKPiAtCWludGVsX2VuZ2luZXNfc2V0X3NjaGVkdWxlcl9j
YXBzKGRldl9wcml2KTsKPiArCWludGVsX2VuZ2luZXNfc2V0X3NjaGVkdWxlcl9jYXBzKGk5MTUp
Owo+ICAgCXJldHVybiAwOwo+ICAgCj4gICBjbGVhbnVwX3VjOgo+IC0JaW50ZWxfdWNfZmluaV9o
dyhkZXZfcHJpdik7Cj4gKwlpbnRlbF91Y19maW5pX2h3KGk5MTUpOwo+ICAgb3V0Ogo+IC0JaW50
ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwp
Owo+ICsJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtF
X0FMTCk7Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+IEBAIC0xNTA1LDI4ICsxNTA1LDI4
IEBAIHN0YXRpYyBpbnQgaW50ZWxfZW5naW5lc192ZXJpZnlfd29ya2Fyb3VuZHMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICAJcmV0dXJuIGVycjsKPiAgIH0KPiAgIAo+IC1pbnQg
aTkxNV9nZW1faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK2ludCBp
OTE1X2dlbV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCWlu
dCByZXQ7Cj4gICAKPiAgIAkvKiBXZSBuZWVkIHRvIGZhbGxiYWNrIHRvIDRLIHBhZ2VzIGlmIGhv
c3QgZG9lc24ndCBzdXBwb3J0IGh1Z2UgZ3R0LiAqLwo+IC0JaWYgKGludGVsX3ZncHVfYWN0aXZl
KGRldl9wcml2KSAmJiAhaW50ZWxfdmdwdV9oYXNfaHVnZV9ndHQoZGV2X3ByaXYpKQo+IC0JCW1r
d3JpdGVfZGV2aWNlX2luZm8oZGV2X3ByaXYpLT5wYWdlX3NpemVzID0KPiArCWlmIChpbnRlbF92
Z3B1X2FjdGl2ZShpOTE1KSAmJiAhaW50ZWxfdmdwdV9oYXNfaHVnZV9ndHQoaTkxNSkpCj4gKwkJ
bWt3cml0ZV9kZXZpY2VfaW5mbyhpOTE1KS0+cGFnZV9zaXplcyA9Cj4gICAJCQlJOTE1X0dUVF9Q
QUdFX1NJWkVfNEs7Cj4gICAKPiAtCWRldl9wcml2LT5tbS51bm9yZGVyZWRfdGltZWxpbmUgPSBk
bWFfZmVuY2VfY29udGV4dF9hbGxvYygxKTsKPiArCWk5MTUtPm1tLnVub3JkZXJlZF90aW1lbGlu
ZSA9IGRtYV9mZW5jZV9jb250ZXh0X2FsbG9jKDEpOwo+ICAgCj4gLQlpOTE1X3RpbWVsaW5lc19p
bml0KGRldl9wcml2KTsKPiArCWk5MTVfdGltZWxpbmVzX2luaXQoaTkxNSk7Cj4gICAKPiAtCXJl
dCA9IGk5MTVfZ2VtX2luaXRfdXNlcnB0cihkZXZfcHJpdik7Cj4gKwlyZXQgPSBpOTE1X2dlbV9p
bml0X3VzZXJwdHIoaTkxNSk7Cj4gICAJaWYgKHJldCkKPiAgIAkJcmV0dXJuIHJldDsKPiAgIAo+
IC0JcmV0ID0gaW50ZWxfdWNfaW5pdF9taXNjKGRldl9wcml2KTsKPiArCXJldCA9IGludGVsX3Vj
X2luaXRfbWlzYyhpOTE1KTsKPiAgIAlpZiAocmV0KQo+ICAgCQlyZXR1cm4gcmV0Owo+ICAgCj4g
LQlyZXQgPSBpbnRlbF93b3BjbV9pbml0KCZkZXZfcHJpdi0+d29wY20pOwo+ICsJcmV0ID0gaW50
ZWxfd29wY21faW5pdCgmaTkxNS0+d29wY20pOwo+ICAgCWlmIChyZXQpCj4gICAJCWdvdG8gZXJy
X3VjX21pc2M7Cj4gICAKPiBAQCAtMTUzNiw0NyArMTUzNiw0NyBAQCBpbnQgaTkxNV9nZW1faW5p
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICogd2UgaG9sZCB0aGUg
Zm9yY2V3YWtlIGR1cmluZyBpbml0aWFsaXNhdGlvbiB0aGVzZSBwcm9ibGVtcwo+ICAgCSAqIGp1
c3QgbWFnaWNhbGx5IGdvIGF3YXkuCj4gICAJICovCj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+
ZHJtLnN0cnVjdF9tdXRleCk7Cj4gLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3By
aXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3Ry
dWN0X211dGV4KTsKPiArCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZpOTE1LT51bmNvcmUs
IEZPUkNFV0FLRV9BTEwpOwo+ICAgCj4gLQlyZXQgPSBpOTE1X2dlbV9pbml0X2dndHQoZGV2X3By
aXYpOwo+ICsJcmV0ID0gaTkxNV9nZW1faW5pdF9nZ3R0KGk5MTUpOwo+ICAgCWlmIChyZXQpIHsK
PiAgIAkJR0VNX0JVR19PTihyZXQgPT0gLUVJTyk7Cj4gICAJCWdvdG8gZXJyX3VubG9jazsKPiAg
IAl9Cj4gICAKPiAtCXJldCA9IGk5MTVfZ2VtX2luaXRfc2NyYXRjaChkZXZfcHJpdiwKPiAtCQkJ
CSAgICBJU19HRU4oZGV2X3ByaXYsIDIpID8gU1pfMjU2SyA6IFBBR0VfU0laRSk7Cj4gKwlyZXQg
PSBpOTE1X2dlbV9pbml0X3NjcmF0Y2goaTkxNSwKPiArCQkJCSAgICBJU19HRU4oaTkxNSwgMikg
PyBTWl8yNTZLIDogUEFHRV9TSVpFKTsKPiAgIAlpZiAocmV0KSB7Cj4gICAJCUdFTV9CVUdfT04o
cmV0ID09IC1FSU8pOwo+ICAgCQlnb3RvIGVycl9nZ3R0Owo+ICAgCX0KPiAgIAo+IC0JcmV0ID0g
aW50ZWxfZW5naW5lc19zZXR1cChkZXZfcHJpdik7Cj4gKwlyZXQgPSBpbnRlbF9lbmdpbmVzX3Nl
dHVwKGk5MTUpOwo+ICAgCWlmIChyZXQpIHsKPiAgIAkJR0VNX0JVR19PTihyZXQgPT0gLUVJTyk7
Cj4gICAJCWdvdG8gZXJyX3VubG9jazsKPiAgIAl9Cj4gICAKPiAtCXJldCA9IGk5MTVfZ2VtX2Nv
bnRleHRzX2luaXQoZGV2X3ByaXYpOwo+ICsJcmV0ID0gaTkxNV9nZW1fY29udGV4dHNfaW5pdChp
OTE1KTsKPiAgIAlpZiAocmV0KSB7Cj4gICAJCUdFTV9CVUdfT04ocmV0ID09IC1FSU8pOwo+ICAg
CQlnb3RvIGVycl9zY3JhdGNoOwo+ICAgCX0KPiAgIAo+IC0JcmV0ID0gaW50ZWxfZW5naW5lc19p
bml0KGRldl9wcml2KTsKPiArCXJldCA9IGludGVsX2VuZ2luZXNfaW5pdChpOTE1KTsKPiAgIAlp
ZiAocmV0KSB7Cj4gICAJCUdFTV9CVUdfT04ocmV0ID09IC1FSU8pOwo+ICAgCQlnb3RvIGVycl9j
b250ZXh0Owo+ICAgCX0KPiAgIAo+IC0JaW50ZWxfaW5pdF9ndF9wb3dlcnNhdmUoZGV2X3ByaXYp
Owo+ICsJaW50ZWxfaW5pdF9ndF9wb3dlcnNhdmUoaTkxNSk7Cj4gICAKPiAtCXJldCA9IGludGVs
X3VjX2luaXQoZGV2X3ByaXYpOwo+ICsJcmV0ID0gaW50ZWxfdWNfaW5pdChpOTE1KTsKPiAgIAlp
ZiAocmV0KQo+ICAgCQlnb3RvIGVycl9wbTsKPiAgIAo+IC0JcmV0ID0gaTkxNV9nZW1faW5pdF9o
dyhkZXZfcHJpdik7Cj4gKwlyZXQgPSBpOTE1X2dlbV9pbml0X2h3KGk5MTUpOwo+ICAgCWlmIChy
ZXQpCj4gICAJCWdvdG8gZXJyX3VjX2luaXQ7Cj4gICAKPiBAQCAtMTU4OSwxMyArMTU4OSwxMyBA
QCBpbnQgaTkxNV9nZW1faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
ICAJICoKPiAgIAkgKiBGSVhNRTogYnJlYWsgdXAgdGhlIHdvcmthcm91bmRzIGFuZCBhcHBseSB0
aGVtIGF0IHRoZSByaWdodCB0aW1lIQo+ICAgCSAqLwo+IC0JaW50ZWxfaW5pdF9jbG9ja19nYXRp
bmcoZGV2X3ByaXYpOwo+ICsJaW50ZWxfaW5pdF9jbG9ja19nYXRpbmcoaTkxNSk7Cj4gICAKPiAt
CXJldCA9IGludGVsX2VuZ2luZXNfdmVyaWZ5X3dvcmthcm91bmRzKGRldl9wcml2KTsKPiArCXJl
dCA9IGludGVsX2VuZ2luZXNfdmVyaWZ5X3dvcmthcm91bmRzKGk5MTUpOwo+ICAgCWlmIChyZXQp
Cj4gICAJCWdvdG8gZXJyX2luaXRfaHc7Cj4gICAKPiAtCXJldCA9IF9faW50ZWxfZW5naW5lc19y
ZWNvcmRfZGVmYXVsdHMoZGV2X3ByaXYpOwo+ICsJcmV0ID0gX19pbnRlbF9lbmdpbmVzX3JlY29y
ZF9kZWZhdWx0cyhpOTE1KTsKPiAgIAlpZiAocmV0KQo+ICAgCQlnb3RvIGVycl9pbml0X2h3Owo+
ICAgCj4gQEAgLTE2MDksOCArMTYwOSw4IEBAIGludCBpOTE1X2dlbV9pbml0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkJZ290byBlcnJfaW5pdF9odzsKPiAgIAl9Cj4g
ICAKPiAtCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JD
RVdBS0VfQUxMKTsKPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgp
Owo+ICsJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtF
X0FMTCk7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCj4g
ICAJcmV0dXJuIDA7Cj4gICAKPiBAQCAtMTYyMSwxMDcgKzE2MjEsMTA3IEBAIGludCBpOTE1X2dl
bV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkgKiBkcml2ZXIg
ZG9lc24ndCBleHBsb2RlIGR1cmluZyBydW50aW1lLgo+ICAgCSAqLwo+ICAgZXJyX2luaXRfaHc6
Cj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiArCW11dGV4
X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAKPiAtCWk5MTVfZ2VtX3NldF93
ZWRnZWQoZGV2X3ByaXYpOwo+IC0JaTkxNV9nZW1fc3VzcGVuZChkZXZfcHJpdik7Cj4gLQlpOTE1
X2dlbV9zdXNwZW5kX2xhdGUoZGV2X3ByaXYpOwo+ICsJaTkxNV9nZW1fc2V0X3dlZGdlZChpOTE1
KTsKPiArCWk5MTVfZ2VtX3N1c3BlbmQoaTkxNSk7Cj4gKwlpOTE1X2dlbV9zdXNwZW5kX2xhdGUo
aTkxNSk7Cj4gICAKPiAtCWk5MTVfZ2VtX2RyYWluX3dvcmtxdWV1ZShkZXZfcHJpdik7Cj4gKwlp
OTE1X2dlbV9kcmFpbl93b3JrcXVldWUoaTkxNSk7Cj4gICAKPiAtCW11dGV4X2xvY2soJmRldl9w
cml2LT5kcm0uc3RydWN0X211dGV4KTsKPiAtCWludGVsX3VjX2ZpbmlfaHcoZGV2X3ByaXYpOwo+
ICsJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gKwlpbnRlbF91Y19maW5p
X2h3KGk5MTUpOwo+ICAgZXJyX3VjX2luaXQ6Cj4gLQlpbnRlbF91Y19maW5pKGRldl9wcml2KTsK
PiArCWludGVsX3VjX2ZpbmkoaTkxNSk7Cj4gICBlcnJfcG06Cj4gICAJaWYgKHJldCAhPSAtRUlP
KSB7Cj4gLQkJaW50ZWxfY2xlYW51cF9ndF9wb3dlcnNhdmUoZGV2X3ByaXYpOwo+IC0JCWludGVs
X2VuZ2luZXNfY2xlYW51cChkZXZfcHJpdik7Cj4gKwkJaW50ZWxfY2xlYW51cF9ndF9wb3dlcnNh
dmUoaTkxNSk7Cj4gKwkJaW50ZWxfZW5naW5lc19jbGVhbnVwKGk5MTUpOwo+ICAgCX0KPiAgIGVy
cl9jb250ZXh0Ogo+ICAgCWlmIChyZXQgIT0gLUVJTykKPiAtCQlpOTE1X2dlbV9jb250ZXh0c19m
aW5pKGRldl9wcml2KTsKPiArCQlpOTE1X2dlbV9jb250ZXh0c19maW5pKGk5MTUpOwo+ICAgZXJy
X3NjcmF0Y2g6Cj4gLQlpOTE1X2dlbV9maW5pX3NjcmF0Y2goZGV2X3ByaXYpOwo+ICsJaTkxNV9n
ZW1fZmluaV9zY3JhdGNoKGk5MTUpOwo+ICAgZXJyX2dndHQ6Cj4gICBlcnJfdW5sb2NrOgo+IC0J
aW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9B
TEwpOwo+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gKwlp
bnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsK
PiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAKPiAgIGVycl91
Y19taXNjOgo+IC0JaW50ZWxfdWNfZmluaV9taXNjKGRldl9wcml2KTsKPiArCWludGVsX3VjX2Zp
bmlfbWlzYyhpOTE1KTsKPiAgIAo+ICAgCWlmIChyZXQgIT0gLUVJTykgewo+IC0JCWk5MTVfZ2Vt
X2NsZWFudXBfdXNlcnB0cihkZXZfcHJpdik7Cj4gLQkJaTkxNV90aW1lbGluZXNfZmluaShkZXZf
cHJpdik7Cj4gKwkJaTkxNV9nZW1fY2xlYW51cF91c2VycHRyKGk5MTUpOwo+ICsJCWk5MTVfdGlt
ZWxpbmVzX2ZpbmkoaTkxNSk7Cj4gICAJfQo+ICAgCj4gICAJaWYgKHJldCA9PSAtRUlPKSB7Cj4g
LQkJbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJCW11dGV4X2xv
Y2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCj4gICAJCS8qCj4gICAJCSAqIEFsbG93
IGVuZ2luZSBpbml0aWFsaXNhdGlvbiB0byBmYWlsIGJ5IG1hcmtpbmcgdGhlIEdQVSBhcwo+ICAg
CQkgKiB3ZWRnZWQuIEJ1dCB3ZSBvbmx5IHdhbnQgdG8gZG8gdGhpcyB3aGVyZSB0aGUgR1BVIGlz
IGFuZ3J5LAo+ICAgCQkgKiBmb3IgYWxsIG90aGVyIGZhaWx1cmUsIHN1Y2ggYXMgYW4gYWxsb2Nh
dGlvbiBmYWlsdXJlLCBiYWlsLgo+ICAgCQkgKi8KPiAtCQlpZiAoIWk5MTVfcmVzZXRfZmFpbGVk
KGRldl9wcml2KSkgewo+IC0JCQlpOTE1X2xvYWRfZXJyb3IoZGV2X3ByaXYsCj4gKwkJaWYgKCFp
OTE1X3Jlc2V0X2ZhaWxlZChpOTE1KSkgewo+ICsJCQlpOTE1X2xvYWRfZXJyb3IoaTkxNSwKPiAg
IAkJCQkJIkZhaWxlZCB0byBpbml0aWFsaXplIEdQVSwgZGVjbGFyaW5nIGl0IHdlZGdlZCFcbiIp
Owo+IC0JCQlpOTE1X2dlbV9zZXRfd2VkZ2VkKGRldl9wcml2KTsKPiArCQkJaTkxNV9nZW1fc2V0
X3dlZGdlZChpOTE1KTsKPiAgIAkJfQo+ICAgCj4gICAJCS8qIE1pbmltYWwgYmFzaWMgcmVjb3Zl
cnkgZm9yIEtNUyAqLwo+IC0JCXJldCA9IGk5MTVfZ2d0dF9lbmFibGVfaHcoZGV2X3ByaXYpOwo+
IC0JCWk5MTVfZ2VtX3Jlc3RvcmVfZ3R0X21hcHBpbmdzKGRldl9wcml2KTsKPiAtCQlpOTE1X2dl
bV9yZXN0b3JlX2ZlbmNlcyhkZXZfcHJpdik7Cj4gLQkJaW50ZWxfaW5pdF9jbG9ja19nYXRpbmco
ZGV2X3ByaXYpOwo+ICsJCXJldCA9IGk5MTVfZ2d0dF9lbmFibGVfaHcoaTkxNSk7Cj4gKwkJaTkx
NV9nZW1fcmVzdG9yZV9ndHRfbWFwcGluZ3MoaTkxNSk7Cj4gKwkJaTkxNV9nZW1fcmVzdG9yZV9m
ZW5jZXMoaTkxNSk7Cj4gKwkJaW50ZWxfaW5pdF9jbG9ja19nYXRpbmcoaTkxNSk7Cj4gICAKPiAt
CQltdXRleF91bmxvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiArCQltdXRleF91
bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCX0KPiAgIAo+IC0JaTkxNV9nZW1f
ZHJhaW5fZnJlZWRfb2JqZWN0cyhkZXZfcHJpdik7Cj4gKwlpOTE1X2dlbV9kcmFpbl9mcmVlZF9v
YmplY3RzKGk5MTUpOwo+ICAgCXJldHVybiByZXQ7Cj4gICB9Cj4gICAKPiAtdm9pZCBpOTE1X2dl
bV9maW5pX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBpOTE1
X2dlbV9maW5pX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JR0VN
X0JVR19PTihkZXZfcHJpdi0+Z3QuYXdha2UpOwo+ICsJR0VNX0JVR19PTihpOTE1LT5ndC5hd2Fr
ZSk7Cj4gICAKPiAtCWludGVsX3dha2VyZWZfYXV0b19maW5pKCZkZXZfcHJpdi0+bW0udXNlcmZh
dWx0X3dha2VyZWYpOwo+ICsJaW50ZWxfd2FrZXJlZl9hdXRvX2ZpbmkoJmk5MTUtPm1tLnVzZXJm
YXVsdF93YWtlcmVmKTsKPiAgIAo+IC0JaTkxNV9nZW1fc3VzcGVuZF9sYXRlKGRldl9wcml2KTsK
PiAtCWludGVsX2Rpc2FibGVfZ3RfcG93ZXJzYXZlKGRldl9wcml2KTsKPiArCWk5MTVfZ2VtX3N1
c3BlbmRfbGF0ZShpOTE1KTsKPiArCWludGVsX2Rpc2FibGVfZ3RfcG93ZXJzYXZlKGk5MTUpOwo+
ICAgCj4gICAJLyogRmx1c2ggYW55IG91dHN0YW5kaW5nIHVucGluX3dvcmsuICovCj4gLQlpOTE1
X2dlbV9kcmFpbl93b3JrcXVldWUoZGV2X3ByaXYpOwo+ICsJaTkxNV9nZW1fZHJhaW5fd29ya3F1
ZXVlKGk5MTUpOwo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRl
eCk7Cj4gLQlpbnRlbF91Y19maW5pX2h3KGRldl9wcml2KTsKPiAtCWludGVsX3VjX2ZpbmkoZGV2
X3ByaXYpOwo+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4g
KwltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiArCWludGVsX3VjX2Zpbmlf
aHcoaTkxNSk7Cj4gKwlpbnRlbF91Y19maW5pKGk5MTUpOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1
LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAo+IC0JaTkxNV9nZW1fZHJhaW5fZnJlZWRfb2JqZWN0
cyhkZXZfcHJpdik7Cj4gKwlpOTE1X2dlbV9kcmFpbl9mcmVlZF9vYmplY3RzKGk5MTUpOwo+ICAg
fQo+ICAgCj4gLXZvaWQgaTkxNV9nZW1fZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gK3ZvaWQgaTkxNV9nZW1fZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiAgIHsKPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiAt
CWludGVsX2VuZ2luZXNfY2xlYW51cChkZXZfcHJpdik7Cj4gLQlpOTE1X2dlbV9jb250ZXh0c19m
aW5pKGRldl9wcml2KTsKPiAtCWk5MTVfZ2VtX2Zpbmlfc2NyYXRjaChkZXZfcHJpdik7Cj4gLQlt
dXRleF91bmxvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiArCW11dGV4X2xvY2so
Jmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJaW50ZWxfZW5naW5lc19jbGVhbnVwKGk5MTUp
Owo+ICsJaTkxNV9nZW1fY29udGV4dHNfZmluaShpOTE1KTsKPiArCWk5MTVfZ2VtX2Zpbmlfc2Ny
YXRjaChpOTE1KTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4g
ICAKPiAtCWludGVsX3dhX2xpc3RfZnJlZSgmZGV2X3ByaXYtPmd0X3dhX2xpc3QpOwo+ICsJaW50
ZWxfd2FfbGlzdF9mcmVlKCZpOTE1LT5ndF93YV9saXN0KTsKPiAgIAo+IC0JaW50ZWxfY2xlYW51
cF9ndF9wb3dlcnNhdmUoZGV2X3ByaXYpOwo+ICsJaW50ZWxfY2xlYW51cF9ndF9wb3dlcnNhdmUo
aTkxNSk7Cj4gICAKPiAtCWludGVsX3VjX2ZpbmlfbWlzYyhkZXZfcHJpdik7Cj4gLQlpOTE1X2dl
bV9jbGVhbnVwX3VzZXJwdHIoZGV2X3ByaXYpOwo+IC0JaTkxNV90aW1lbGluZXNfZmluaShkZXZf
cHJpdik7Cj4gKwlpbnRlbF91Y19maW5pX21pc2MoaTkxNSk7Cj4gKwlpOTE1X2dlbV9jbGVhbnVw
X3VzZXJwdHIoaTkxNSk7Cj4gKwlpOTE1X3RpbWVsaW5lc19maW5pKGk5MTUpOwo+ICAgCj4gLQlp
OTE1X2dlbV9kcmFpbl9mcmVlZF9vYmplY3RzKGRldl9wcml2KTsKPiArCWk5MTVfZ2VtX2RyYWlu
X2ZyZWVkX29iamVjdHMoaTkxNSk7Cj4gICAKPiAtCVdBUk5fT04oIWxpc3RfZW1wdHkoJmRldl9w
cml2LT5jb250ZXh0cy5saXN0KSk7Cj4gKwlXQVJOX09OKCFsaXN0X2VtcHR5KCZpOTE1LT5jb250
ZXh0cy5saXN0KSk7Cj4gICB9Cj4gICAKPiAgIHZvaWQgaTkxNV9nZW1faW5pdF9tbWlvKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+IEBAIC0xNzMwLDM1ICsxNzMwLDM1IEBAIHZvaWQg
aTkxNV9nZW1faW5pdF9tbWlvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgfQo+
ICAgCj4gICB2b2lkCj4gLWk5MTVfZ2VtX2xvYWRfaW5pdF9mZW5jZXMoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ICtpOTE1X2dlbV9sb2FkX2luaXRfZmVuY2VzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCWludCBpOwo+ICAgCj4gLQlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA+PSA3ICYmICFJU19WQUxMRVlWSUVXKGRldl9wcml2KSAmJgo+IC0J
ICAgICFJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiAtCQlkZXZfcHJpdi0+bnVtX2ZlbmNlX3Jl
Z3MgPSAzMjsKPiAtCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCB8fAo+IC0JCSBJ
U19JOTQ1RyhkZXZfcHJpdikgfHwgSVNfSTk0NUdNKGRldl9wcml2KSB8fAo+IC0JCSBJU19HMzMo
ZGV2X3ByaXYpIHx8IElTX1BJTkVWSUVXKGRldl9wcml2KSkKPiAtCQlkZXZfcHJpdi0+bnVtX2Zl
bmNlX3JlZ3MgPSAxNjsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNyAmJiAhSVNfVkFMTEVZ
VklFVyhpOTE1KSAmJgo+ICsJICAgICFJU19DSEVSUllWSUVXKGk5MTUpKQo+ICsJCWk5MTUtPm51
bV9mZW5jZV9yZWdzID0gMzI7Cj4gKwllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNCB8fAo+
ICsJCSBJU19JOTQ1RyhpOTE1KSB8fCBJU19JOTQ1R00oaTkxNSkgfHwKPiArCQkgSVNfRzMzKGk5
MTUpIHx8IElTX1BJTkVWSUVXKGk5MTUpKQo+ICsJCWk5MTUtPm51bV9mZW5jZV9yZWdzID0gMTY7
Cj4gICAJZWxzZQo+IC0JCWRldl9wcml2LT5udW1fZmVuY2VfcmVncyA9IDg7Cj4gKwkJaTkxNS0+
bnVtX2ZlbmNlX3JlZ3MgPSA4Owo+ICAgCj4gLQlpZiAoaW50ZWxfdmdwdV9hY3RpdmUoZGV2X3By
aXYpKQo+IC0JCWRldl9wcml2LT5udW1fZmVuY2VfcmVncyA9Cj4gKwlpZiAoaW50ZWxfdmdwdV9h
Y3RpdmUoaTkxNSkpCj4gKwkJaTkxNS0+bnVtX2ZlbmNlX3JlZ3MgPQo+ICAgCQkJCUk5MTVfUkVB
RCh2Z3RpZl9yZWcoYXZhaWxfcnMuZmVuY2VfbnVtKSk7Cj4gICAKPiAgIAkvKiBJbml0aWFsaXpl
IGZlbmNlIHJlZ2lzdGVycyB0byB6ZXJvICovCj4gLQlmb3IgKGkgPSAwOyBpIDwgZGV2X3ByaXYt
Pm51bV9mZW5jZV9yZWdzOyBpKyspIHsKPiAtCQlzdHJ1Y3QgZHJtX2k5MTVfZmVuY2VfcmVnICpm
ZW5jZSA9ICZkZXZfcHJpdi0+ZmVuY2VfcmVnc1tpXTsKPiArCWZvciAoaSA9IDA7IGkgPCBpOTE1
LT5udW1fZmVuY2VfcmVnczsgaSsrKSB7Cj4gKwkJc3RydWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAq
ZmVuY2UgPSAmaTkxNS0+ZmVuY2VfcmVnc1tpXTsKPiAgIAo+IC0JCWZlbmNlLT5pOTE1ID0gZGV2
X3ByaXY7Cj4gKwkJZmVuY2UtPmk5MTUgPSBpOTE1Owo+ICAgCQlmZW5jZS0+aWQgPSBpOwo+IC0J
CWxpc3RfYWRkX3RhaWwoJmZlbmNlLT5saW5rLCAmZGV2X3ByaXYtPm1tLmZlbmNlX2xpc3QpOwo+
ICsJCWxpc3RfYWRkX3RhaWwoJmZlbmNlLT5saW5rLCAmaTkxNS0+bW0uZmVuY2VfbGlzdCk7Cj4g
ICAJfQo+IC0JaTkxNV9nZW1fcmVzdG9yZV9mZW5jZXMoZGV2X3ByaXYpOwo+ICsJaTkxNV9nZW1f
cmVzdG9yZV9mZW5jZXMoaTkxNSk7Cj4gICAKPiAtCWk5MTVfZ2VtX2RldGVjdF9iaXRfNl9zd2l6
emxlKGRldl9wcml2KTsKPiArCWk5MTVfZ2VtX2RldGVjdF9iaXRfNl9zd2l6emxlKGk5MTUpOwo+
ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZCBpOTE1X2dlbV9pbml0X19tbShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSkKPiBAQCAtMTc3OCw1NiArMTc3OCw1NiBAQCBzdGF0aWMgdm9pZCBp
OTE1X2dlbV9pbml0X19tbShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIAlpOTE1
X2dlbV9pbml0X19vYmplY3RzKGk5MTUpOwo+ICAgfQo+ICAgCj4gLWludCBpOTE1X2dlbV9pbml0
X2Vhcmx5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAraW50IGk5MTVfZ2Vt
X2luaXRfZWFybHkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3Rh
dGljIHN0cnVjdCBsb2NrX2NsYXNzX2tleSByZXNldF9rZXk7Cj4gICAJaW50IGVycjsKPiAgIAo+
IC0JaW50ZWxfZ3RfcG1faW5pdChkZXZfcHJpdik7Cj4gKwlpbnRlbF9ndF9wbV9pbml0KGk5MTUp
Owo+ICAgCj4gLQlJTklUX0xJU1RfSEVBRCgmZGV2X3ByaXYtPmd0LmFjdGl2ZV9yaW5ncyk7Cj4g
LQlJTklUX0xJU1RfSEVBRCgmZGV2X3ByaXYtPmd0LmNsb3NlZF92bWEpOwo+IC0Jc3Bpbl9sb2Nr
X2luaXQoJmRldl9wcml2LT5ndC5jbG9zZWRfbG9jayk7Cj4gLQlsb2NrZGVwX2luaXRfbWFwKCZk
ZXZfcHJpdi0+Z3QucmVzZXRfbG9ja21hcCwKPiArCUlOSVRfTElTVF9IRUFEKCZpOTE1LT5ndC5h
Y3RpdmVfcmluZ3MpOwo+ICsJSU5JVF9MSVNUX0hFQUQoJmk5MTUtPmd0LmNsb3NlZF92bWEpOwo+
ICsJc3Bpbl9sb2NrX2luaXQoJmk5MTUtPmd0LmNsb3NlZF9sb2NrKTsKPiArCWxvY2tkZXBfaW5p
dF9tYXAoJmk5MTUtPmd0LnJlc2V0X2xvY2ttYXAsCj4gICAJCQkgImk5MTUucmVzZXQiLCAmcmVz
ZXRfa2V5LCAwKTsKPiAgIAo+IC0JaTkxNV9nZW1faW5pdF9fbW0oZGV2X3ByaXYpOwo+IC0JaTkx
NV9nZW1faW5pdF9fcG0oZGV2X3ByaXYpOwo+ICsJaTkxNV9nZW1faW5pdF9fbW0oaTkxNSk7Cj4g
KwlpOTE1X2dlbV9pbml0X19wbShpOTE1KTsKPiAgIAo+IC0JaW5pdF93YWl0cXVldWVfaGVhZCgm
ZGV2X3ByaXYtPmdwdV9lcnJvci53YWl0X3F1ZXVlKTsKPiAtCWluaXRfd2FpdHF1ZXVlX2hlYWQo
JmRldl9wcml2LT5ncHVfZXJyb3IucmVzZXRfcXVldWUpOwo+IC0JbXV0ZXhfaW5pdCgmZGV2X3By
aXYtPmdwdV9lcnJvci53ZWRnZV9tdXRleCk7Cj4gLQlpbml0X3NyY3Vfc3RydWN0KCZkZXZfcHJp
di0+Z3B1X2Vycm9yLnJlc2V0X2JhY2tvZmZfc3JjdSk7Cj4gKwlpbml0X3dhaXRxdWV1ZV9oZWFk
KCZpOTE1LT5ncHVfZXJyb3Iud2FpdF9xdWV1ZSk7Cj4gKwlpbml0X3dhaXRxdWV1ZV9oZWFkKCZp
OTE1LT5ncHVfZXJyb3IucmVzZXRfcXVldWUpOwo+ICsJbXV0ZXhfaW5pdCgmaTkxNS0+Z3B1X2Vy
cm9yLndlZGdlX211dGV4KTsKPiArCWluaXRfc3JjdV9zdHJ1Y3QoJmk5MTUtPmdwdV9lcnJvci5y
ZXNldF9iYWNrb2ZmX3NyY3UpOwo+ICAgCj4gLQlhdG9taWNfc2V0KCZkZXZfcHJpdi0+bW0uYnNk
X2VuZ2luZV9kaXNwYXRjaF9pbmRleCwgMCk7Cj4gKwlhdG9taWNfc2V0KCZpOTE1LT5tbS5ic2Rf
ZW5naW5lX2Rpc3BhdGNoX2luZGV4LCAwKTsKPiAgIAo+IC0Jc3Bpbl9sb2NrX2luaXQoJmRldl9w
cml2LT5mYl90cmFja2luZy5sb2NrKTsKPiArCXNwaW5fbG9ja19pbml0KCZpOTE1LT5mYl90cmFj
a2luZy5sb2NrKTsKPiAgIAo+IC0JZXJyID0gaTkxNV9nZW1mc19pbml0KGRldl9wcml2KTsKPiAr
CWVyciA9IGk5MTVfZ2VtZnNfaW5pdChpOTE1KTsKPiAgIAlpZiAoZXJyKQo+ICAgCQlEUk1fTk9U
RSgiVW5hYmxlIHRvIGNyZWF0ZSBhIHByaXZhdGUgdG1wZnMgbW91bnQsIGh1Z2VwYWdlIHN1cHBv
cnQgd2lsbCBiZSBkaXNhYmxlZCglZCkuXG4iLCBlcnIpOwo+ICAgCj4gICAJcmV0dXJuIDA7Cj4g
ICB9Cj4gICAKPiAtdm9pZCBpOTE1X2dlbV9jbGVhbnVwX2Vhcmx5KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBpOTE1X2dlbV9jbGVhbnVwX2Vhcmx5KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JaTkxNV9nZW1fZHJhaW5fZnJlZWRfb2Jq
ZWN0cyhkZXZfcHJpdik7Cj4gLQlHRU1fQlVHX09OKCFsbGlzdF9lbXB0eSgmZGV2X3ByaXYtPm1t
LmZyZWVfbGlzdCkpOwo+IC0JR0VNX0JVR19PTihhdG9taWNfcmVhZCgmZGV2X3ByaXYtPm1tLmZy
ZWVfY291bnQpKTsKPiAtCVdBUk5fT04oZGV2X3ByaXYtPm1tLnNocmlua19jb3VudCk7Cj4gKwlp
OTE1X2dlbV9kcmFpbl9mcmVlZF9vYmplY3RzKGk5MTUpOwo+ICsJR0VNX0JVR19PTighbGxpc3Rf
ZW1wdHkoJmk5MTUtPm1tLmZyZWVfbGlzdCkpOwo+ICsJR0VNX0JVR19PTihhdG9taWNfcmVhZCgm
aTkxNS0+bW0uZnJlZV9jb3VudCkpOwo+ICsJV0FSTl9PTihpOTE1LT5tbS5zaHJpbmtfY291bnQp
Owo+ICAgCj4gLQljbGVhbnVwX3NyY3Vfc3RydWN0KCZkZXZfcHJpdi0+Z3B1X2Vycm9yLnJlc2V0
X2JhY2tvZmZfc3JjdSk7Cj4gKwljbGVhbnVwX3NyY3Vfc3RydWN0KCZpOTE1LT5ncHVfZXJyb3Iu
cmVzZXRfYmFja29mZl9zcmN1KTsKPiAgIAo+IC0JaTkxNV9nZW1mc19maW5pKGRldl9wcml2KTsK
PiArCWk5MTVfZ2VtZnNfZmluaShpOTE1KTsKPiAgIH0KPiAgIAo+IC1pbnQgaTkxNV9nZW1fZnJl
ZXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAraW50IGk5MTVfZ2VtX2Zy
ZWV6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAkvKiBEaXNjYXJk
IGFsbCBwdXJnZWFibGUgb2JqZWN0cywgbGV0IHVzZXJzcGFjZSByZWNvdmVyIHRob3NlIGFzCj4g
ICAJICogcmVxdWlyZWQgYWZ0ZXIgcmVzdW1pbmcuCj4gICAJICovCj4gLQlpOTE1X2dlbV9zaHJp
bmtfYWxsKGRldl9wcml2KTsKPiArCWk5MTVfZ2VtX3Nocmlua19hbGwoaTkxNSk7Cj4gICAKPiAg
IAlyZXR1cm4gMDsKPiAgIH0KPiBAQCAtMTg5NSw3ICsxODk1LDcgQEAgaW50IGk5MTVfZ2VtX29w
ZW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkK
PiAgIAkJcmV0dXJuIC1FTk9NRU07Cj4gICAKPiAgIAlmaWxlLT5kcml2ZXJfcHJpdiA9IGZpbGVf
cHJpdjsKPiAtCWZpbGVfcHJpdi0+ZGV2X3ByaXYgPSBpOTE1Owo+ICsJZmlsZV9wcml2LT5pOTE1
ID0gaTkxNTsKPiAgIAlmaWxlX3ByaXYtPmZpbGUgPSBmaWxlOwo+ICAgCj4gICAJc3Bpbl9sb2Nr
X2luaXQoJmZpbGVfcHJpdi0+bW0ubG9jayk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZ2VtX2V2aWN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9l
dmljdC5jCj4gaW5kZXggYTU3ODNjNGNiOThiLi40MjQ0ZDljNTRkNjYgMTAwNjQ0Cj4gLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZXZpY3QuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZ2VtX2V2aWN0LmMKPiBAQCAtOTksNyArOTksNyBAQCBpOTE1X2dlbV9l
dmljdF9zb21ldGhpbmcoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gICAJCQkgdTY0
IHN0YXJ0LCB1NjQgZW5kLAo+ICAgCQkJIHVuc2lnbmVkIGZsYWdzKQo+ICAgewo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdm0tPmk5MTU7Cj4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHZtLT5pOTE1Owo+ICAgCXN0cnVjdCBkcm1fbW1fc2NhbiBzY2Fu
Owo+ICAgCXN0cnVjdCBsaXN0X2hlYWQgZXZpY3Rpb25fbGlzdDsKPiAgIAlzdHJ1Y3QgaTkxNV92
bWEgKnZtYSwgKm5leHQ7Cj4gQEAgLTEzOCw3ICsxMzgsNyBAQCBpOTE1X2dlbV9ldmljdF9zb21l
dGhpbmcoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gICAJICogcmV0aXJpbmcuCj4g
ICAJICovCj4gICAJaWYgKCEoZmxhZ3MgJiBQSU5fTk9OQkxPQ0spKQo+IC0JCWk5MTVfcmV0aXJl
X3JlcXVlc3RzKGRldl9wcml2KTsKPiArCQlpOTE1X3JldGlyZV9yZXF1ZXN0cyhpOTE1KTsKPiAg
IAo+ICAgc2VhcmNoX2FnYWluOgo+ICAgCWFjdGl2ZSA9IE5VTEw7Cj4gQEAgLTIxMSw3ICsyMTEs
NyBAQCBpOTE1X2dlbV9ldmljdF9zb21ldGhpbmcoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAq
dm0sCj4gICAJaWYgKEk5MTVfU0VMRlRFU1RfT05MWShpZ3RfZXZpY3RfY3RsLmZhaWxfaWZfYnVz
eSkpCj4gICAJCXJldHVybiAtRUJVU1k7Cj4gICAKPiAtCXJldCA9IGdndHRfZmx1c2goZGV2X3By
aXYpOwo+ICsJcmV0ID0gZ2d0dF9mbHVzaChpOTE1KTsKPiAgIAlpZiAocmV0KQo+ICAgCQlyZXR1
cm4gcmV0Owo+ICAgCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2Vt
X2d0dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMKPiBpbmRleCBlNzA2
NzViZmI1MWQuLjQyZDg4ZGFlOWM1ZCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2dlbV9ndHQuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0
dC5jCj4gQEAgLTEyOTQsNyArMTI5NCw3IEBAIHN0YXRpYyBpbnQgZ2VuOF9pbml0X3NjcmF0Y2go
c3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0pCj4gICBzdGF0aWMgaW50IGdlbjhfcHBndHRf
bm90aWZ5X3ZndChzdHJ1Y3QgaTkxNV9wcGd0dCAqcHBndHQsIGJvb2wgY3JlYXRlKQo+ICAgewo+
ICAgCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0gJnBwZ3R0LT52bTsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHZtLT5pOTE1Owo+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB2bS0+aTkxNTsKPiAgIAllbnVtIHZndF9nMnZfdHlwZSBtc2c7
Cj4gICAJaW50IGk7Cj4gICAKPiBAQCAtMTY5Miw3ICsxNjkyLDcgQEAgc3RhdGljIGlubGluZSB2
b2lkIGdlbjZfd3JpdGVfcGRlKGNvbnN0IHN0cnVjdCBnZW42X3BwZ3R0ICpwcGd0dCwKPiAgIAkJ
ICBwcGd0dC0+cGRfYWRkciArIHBkZSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgZ2VuN19w
cGd0dF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMg
dm9pZCBnZW43X3BwZ3R0X2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAg
IHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4gICAJdTMyIGVjb2Noaywg
ZWNvYml0czsKPiBAQCAtMTcwMiw3ICsxNzAyLDcgQEAgc3RhdGljIHZvaWQgZ2VuN19wcGd0dF9l
bmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCUk5MTVfV1JJVEUo
R0FDX0VDT19CSVRTLCBlY29iaXRzIHwgRUNPQklUU19QUEdUVF9DQUNIRTY0Qik7Cj4gICAKPiAg
IAllY29jaGsgPSBJOTE1X1JFQUQoR0FNX0VDT0NISyk7Cj4gLQlpZiAoSVNfSEFTV0VMTChkZXZf
cHJpdikpIHsKPiArCWlmIChJU19IQVNXRUxMKGk5MTUpKSB7Cj4gICAJCWVjb2NoayB8PSBFQ09D
SEtfUFBHVFRfV0JfSFNXOwo+ICAgCX0gZWxzZSB7Cj4gICAJCWVjb2NoayB8PSBFQ09DSEtfUFBH
VFRfTExDX0lWQjsKPiBAQCAtMTcxMCw3ICsxNzEwLDcgQEAgc3RhdGljIHZvaWQgZ2VuN19wcGd0
dF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCX0KPiAgIAlJ
OTE1X1dSSVRFKEdBTV9FQ09DSEssIGVjb2Noayk7Cj4gICAKPiAtCWZvcl9lYWNoX2VuZ2luZShl
bmdpbmUsIGRldl9wcml2LCBpZCkgewo+ICsJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwg
aWQpIHsKPiAgIAkJLyogR0ZYX01PREUgaXMgcGVyLXJpbmcgb24gZ2VuNysgKi8KPiAgIAkJRU5H
SU5FX1dSSVRFKGVuZ2luZSwKPiAgIAkJCSAgICAgUklOR19NT0RFX0dFTjcsCj4gQEAgLTE3MTgs
NyArMTcxOCw3IEBAIHN0YXRpYyB2b2lkIGdlbjdfcHBndHRfZW5hYmxlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAl9Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgZ2Vu
Nl9wcGd0dF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0
aWMgdm9pZCBnZW42X3BwZ3R0X2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiAgIHsKPiAgIAl1MzIgZWNvY2hrLCBnYWJfY3RsLCBlY29iaXRzOwo+ICAgCj4gQEAgLTE3MzIs
NyArMTczMiw3IEBAIHN0YXRpYyB2b2lkIGdlbjZfcHBndHRfZW5hYmxlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAllY29jaGsgPSBJOTE1X1JFQUQoR0FNX0VDT0NISyk7
Cj4gICAJSTkxNV9XUklURShHQU1fRUNPQ0hLLCBlY29jaGsgfCBFQ09DSEtfU05CX0JJVCB8IEVD
T0NIS19QUEdUVF9DQUNIRTY0Qik7Cj4gICAKPiAtCWlmIChIQVNfUFBHVFQoZGV2X3ByaXYpKSAv
KiBtYXkgYmUgZGlzYWJsZWQgZm9yIFZULWQgKi8KPiArCWlmIChIQVNfUFBHVFQoaTkxNSkpIC8q
IG1heSBiZSBkaXNhYmxlZCBmb3IgVlQtZCAqLwo+ICAgCQlJOTE1X1dSSVRFKEdGWF9NT0RFLCBf
TUFTS0VEX0JJVF9FTkFCTEUoR0ZYX1BQR1RUX0VOQUJMRSkpOwo+ICAgfQo+ICAgCj4gQEAgLTIx
ODUsMjAgKzIxODUsMjAgQEAgc3RhdGljIHN0cnVjdCBpOTE1X3BwZ3R0ICpnZW42X3BwZ3R0X2Ny
ZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIAlyZXR1cm4gRVJSX1BUUihl
cnIpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGd0dF93cml0ZV93b3JrYXJvdW5kcyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGd0dF93cml0ZV93
b3JrYXJvdW5kcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAkvKiBU
aGlzIGZ1bmN0aW9uIGlzIGZvciBndHQgcmVsYXRlZCB3b3JrYXJvdW5kcy4gVGhpcyBmdW5jdGlv
biBpcwo+ICAgCSAqIGNhbGxlZCBvbiBkcml2ZXIgbG9hZCBhbmQgYWZ0ZXIgYSBHUFUgcmVzZXQs
IHNvIHlvdSBjYW4gcGxhY2UKPiAgIAkgKiB3b3JrYXJvdW5kcyBoZXJlIGV2ZW4gaWYgdGhleSBn
ZXQgb3ZlcndyaXR0ZW4gYnkgR1BVIHJlc2V0Lgo+ICAgCSAqLwo+ICAgCS8qIFdhSW5jcmVhc2VE
ZWZhdWx0VExCRW50cmllczpjaHYsYmR3LHNrbCxieHQsa2JsLGdsayxjZmwsY25sLGljbCAqLwo+
IC0JaWYgKElTX0JST0FEV0VMTChkZXZfcHJpdikpCj4gKwlpZiAoSVNfQlJPQURXRUxMKGk5MTUp
KQo+ICAgCQlJOTE1X1dSSVRFKEdFTjhfTDNfTFJBXzFfR1BHUFUsIEdFTjhfTDNfTFJBXzFfR1BH
UFVfREVGQVVMVF9WQUxVRV9CRFcpOwo+IC0JZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJp
dikpCj4gKwllbHNlIGlmIChJU19DSEVSUllWSUVXKGk5MTUpKQo+ICAgCQlJOTE1X1dSSVRFKEdF
TjhfTDNfTFJBXzFfR1BHUFUsIEdFTjhfTDNfTFJBXzFfR1BHUFVfREVGQVVMVF9WQUxVRV9DSFYp
Owo+IC0JZWxzZSBpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCj4gKwllbHNlIGlmIChJU19HRU45
X0xQKGk5MTUpKQo+ICAgCQlJOTE1X1dSSVRFKEdFTjhfTDNfTFJBXzFfR1BHUFUsIEdFTjlfTDNf
TFJBXzFfR1BHUFVfREVGQVVMVF9WQUxVRV9CWFQpOwo+IC0JZWxzZSBpZiAoSU5URUxfR0VOKGRl
dl9wcml2KSA+PSA5KQo+ICsJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDkpCj4gICAJCUk5
MTVfV1JJVEUoR0VOOF9MM19MUkFfMV9HUEdQVSwgR0VOOV9MM19MUkFfMV9HUEdQVV9ERUZBVUxU
X1ZBTFVFX1NLTCk7Cj4gICAKPiAgIAkvKgo+IEBAIC0yMjEyLDIxICsyMjEyLDIxIEBAIHN0YXRp
YyB2b2lkIGd0dF93cml0ZV93b3JrYXJvdW5kcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gICAJICogMzJLIHBhZ2VzLCBidXQgd2UgZG9uJ3QgY3VycmVudGx5IGhhdmUgYW55
IHN1cHBvcnQgZm9yIGl0IGluIG91cgo+ICAgCSAqIGRyaXZlci4KPiAgIAkgKi8KPiAtCWlmIChI
QVNfUEFHRV9TSVpFUyhkZXZfcHJpdiwgSTkxNV9HVFRfUEFHRV9TSVpFXzY0SykgJiYKPiAtCSAg
ICBJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDEwKQo+ICsJaWYgKEhBU19QQUdFX1NJWkVTKGk5MTUs
IEk5MTVfR1RUX1BBR0VfU0laRV82NEspICYmCj4gKwkgICAgSU5URUxfR0VOKGk5MTUpIDw9IDEw
KQo+ICAgCQlJOTE1X1dSSVRFKEdFTjhfR0FNV19FQ09fREVWX1JXX0lBLAo+ICAgCQkJICAgSTkx
NV9SRUFEKEdFTjhfR0FNV19FQ09fREVWX1JXX0lBKSB8Cj4gICAJCQkgICBHQU1XX0VDT19FTkFC
TEVfNjRLX0lQU19GSUVMRCk7Cj4gICB9Cj4gICAKPiAtaW50IGk5MTVfcHBndHRfaW5pdF9odyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK2ludCBpOTE1X3BwZ3R0X2luaXRf
aHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlndHRfd3JpdGVfd29y
a2Fyb3VuZHMoZGV2X3ByaXYpOwo+ICsJZ3R0X3dyaXRlX3dvcmthcm91bmRzKGk5MTUpOwo+ICAg
Cj4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCA2KSkKPiAtCQlnZW42X3BwZ3R0X2VuYWJsZShkZXZf
cHJpdik7Cj4gLQllbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDcpKQo+IC0JCWdlbjdfcHBndHRf
ZW5hYmxlKGRldl9wcml2KTsKPiArCWlmIChJU19HRU4oaTkxNSwgNikpCj4gKwkJZ2VuNl9wcGd0
dF9lbmFibGUoaTkxNSk7Cj4gKwllbHNlIGlmIChJU19HRU4oaTkxNSwgNykpCj4gKwkJZ2VuN19w
cGd0dF9lbmFibGUoaTkxNSk7Cj4gICAKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiBAQCAtMjI5Mywy
OSArMjI5MywyOSBAQCB2b2lkIGk5MTVfdm1fcmVsZWFzZShzdHJ1Y3Qga3JlZiAqa3JlZikKPiAg
IC8qIENlcnRhaW4gR2VuNSBjaGlwc2V0cyByZXF1aXJlIHJlcXVpcmUgaWRsaW5nIHRoZSBHUFUg
YmVmb3JlCj4gICAgKiB1bm1hcHBpbmcgYW55dGhpbmcgZnJvbSB0aGUgR1RUIHdoZW4gVlQtZCBp
cyBlbmFibGVkLgo+ICAgICovCj4gLXN0YXRpYyBib29sIG5lZWRzX2lkbGVfbWFwcyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyBib29sIG5lZWRzX2lkbGVfbWFw
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAkvKiBRdWVyeSBpbnRl
bF9pb21tdSB0byBzZWUgaWYgd2UgbmVlZCB0aGUgd29ya2Fyb3VuZC4gUHJlc3VtYWJseSB0aGF0
Cj4gICAJICogd2FzIGxvYWRlZCBmaXJzdC4KPiAgIAkgKi8KPiAtCXJldHVybiBJU19HRU4oZGV2
X3ByaXYsIDUpICYmIElTX01PQklMRShkZXZfcHJpdikgJiYgaW50ZWxfdnRkX2FjdGl2ZSgpOwo+
ICsJcmV0dXJuIElTX0dFTihpOTE1LCA1KSAmJiBJU19NT0JJTEUoaTkxNSkgJiYgaW50ZWxfdnRk
X2FjdGl2ZSgpOwo+ICAgfQo+ICAgCj4gLXZvaWQgaTkxNV9nZW1fc3VzcGVuZF9ndHRfbWFwcGlu
Z3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGk5MTVfZ2VtX3N1
c3BlbmRfZ3R0X21hcHBpbmdzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+
IC0Jc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCA9ICZkZXZfcHJpdi0+Z2d0dDsKPiArCXN0cnVjdCBp
OTE1X2dndHQgKmdndHQgPSAmaTkxNS0+Z2d0dDsKPiAgIAo+ICAgCS8qIERvbid0IGJvdGhlciBt
ZXNzaW5nIHdpdGggZmF1bHRzIHByZSBHRU42IGFzIHdlIGhhdmUgbGl0dGxlCj4gICAJICogZG9j
dW1lbnRhdGlvbiBzdXBwb3J0aW5nIHRoYXQgaXQncyBhIGdvb2QgaWRlYS4KPiAgIAkgKi8KPiAt
CWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNikKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA2
KQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCWk5MTVfY2hlY2tfYW5kX2NsZWFyX2ZhdWx0cyhkZXZf
cHJpdik7Cj4gKwlpOTE1X2NoZWNrX2FuZF9jbGVhcl9mYXVsdHMoaTkxNSk7Cj4gICAKPiAgIAln
Z3R0LT52bS5jbGVhcl9yYW5nZSgmZ2d0dC0+dm0sIDAsIGdndHQtPnZtLnRvdGFsKTsKPiAgIAo+
IC0JaTkxNV9nZ3R0X2ludmFsaWRhdGUoZGV2X3ByaXYpOwo+ICsJaTkxNV9nZ3R0X2ludmFsaWRh
dGUoaTkxNSk7Cj4gICB9Cj4gICAKPiAgIGludCBpOTE1X2dlbV9ndHRfcHJlcGFyZV9wYWdlcyhz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAo+IEBAIC0yNDExLDcgKzI0MTEsNyBAQCBz
dGF0aWMgdm9pZCBnZW42X2dndHRfaW5zZXJ0X3BhZ2Uoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFj
ZSAqdm0sCj4gICAgKiBCaW5kcyBhbiBvYmplY3QgaW50byB0aGUgZ2xvYmFsIGd0dCB3aXRoIHRo
ZSBzcGVjaWZpZWQgY2FjaGUgbGV2ZWwuIFRoZSBvYmplY3QKPiAgICAqIHdpbGwgYmUgYWNjZXNz
aWJsZSB0byB0aGUgR1BVIHZpYSBjb21tYW5kcyB3aG9zZSBvcGVyYW5kcyByZWZlcmVuY2Ugb2Zm
c2V0cwo+ICAgICogd2l0aGluIHRoZSBnbG9iYWwgR1RUIGFzIHdlbGwgYXMgYWNjZXNzaWJsZSBi
eSB0aGUgR1BVIHRocm91Z2ggdGhlIEdNQURSCj4gLSAqIG1hcHBlZCBCQVIgKGRldl9wcml2LT5t
bS5ndHQtPmd0dCkuCj4gKyAqIG1hcHBlZCBCQVIgKGk5MTUtPm1tLmd0dC0+Z3R0KS4KPiAgICAq
Lwo+ICAgc3RhdGljIHZvaWQgZ2VuNl9nZ3R0X2luc2VydF9lbnRyaWVzKHN0cnVjdCBpOTE1X2Fk
ZHJlc3Nfc3BhY2UgKnZtLAo+ICAgCQkJCSAgICAgc3RydWN0IGk5MTVfdm1hICp2bWEsCj4gQEAg
LTI0NjEsNyArMjQ2MSw3IEBAIHN0YXRpYyB2b2lkIGdlbjhfZ2d0dF9jbGVhcl9yYW5nZShzdHJ1
Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSwKPiAgIAo+ICAgc3RhdGljIHZvaWQgYnh0X3Z0ZF9n
Z3R0X3dhKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtKQo+ICAgewo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdm0tPmk5MTU7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHZtLT5pOTE1Owo+ICAgCj4gICAJLyoKPiAgIAkgKiBNYWtlIHN1cmUg
dGhlIGludGVybmFsIEdBTSBmaWZvIGhhcyBiZWVuIGNsZWFyZWQgb2YgYWxsIEdUVAo+IEBAIC0y
NzA1LDEyICsyNzA1LDEyIEBAIHN0YXRpYyB2b2lkIGFsaWFzaW5nX2d0dF91bmJpbmRfdm1hKHN0
cnVjdCBpOTE1X3ZtYSAqdm1hKQo+ICAgdm9pZCBpOTE1X2dlbV9ndHRfZmluaXNoX3BhZ2VzKHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCj4gICAJCQkgICAgICAgc3RydWN0IHNnX3Rh
YmxlICpwYWdlcykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUob2JqLT5iYXNlLmRldik7Cj4gLQlzdHJ1Y3QgZGV2aWNlICprZGV2ID0gJmRldl9w
cml2LT5kcm0ucGRldi0+ZGV2Owo+IC0Jc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCA9ICZkZXZfcHJp
di0+Z2d0dDsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShvYmot
PmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkZXZpY2UgKmtkZXYgPSAmaTkxNS0+ZHJtLnBkZXYtPmRl
djsKPiArCXN0cnVjdCBpOTE1X2dndHQgKmdndHQgPSAmaTkxNS0+Z2d0dDsKPiAgIAo+ICAgCWlm
ICh1bmxpa2VseShnZ3R0LT5kb19pZGxlX21hcHMpKSB7Cj4gLQkJaWYgKGk5MTVfZ2VtX3dhaXRf
Zm9yX2lkbGUoZGV2X3ByaXYsIDAsIE1BWF9TQ0hFRFVMRV9USU1FT1VUKSkgewo+ICsJCWlmIChp
OTE1X2dlbV93YWl0X2Zvcl9pZGxlKGk5MTUsIDAsIE1BWF9TQ0hFRFVMRV9USU1FT1VUKSkgewo+
ICAgCQkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gd2FpdCBmb3IgaWRsZTsgVlQnZCBtYXkgaGFuZy5c
biIpOwo+ICAgCQkJLyogV2FpdCBhIGJpdCwgaW4gaG9wZXMgaXQgYXZvaWRzIHRoZSBoYW5nICov
Cj4gICAJCQl1ZGVsYXkoMTApOwo+IEBAIC0yODM0LDcgKzI4MzQsNyBAQCBzdGF0aWMgdm9pZCBn
Z3R0X3JlbGVhc2VfZ3VjX3RvcChzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0KQo+ICAgCQlkcm1fbW1f
cmVtb3ZlX25vZGUoJmdndHQtPnVjX2Z3KTsKPiAgIH0KPiAgIAo+IC1pbnQgaTkxNV9nZW1faW5p
dF9nZ3R0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAraW50IGk5MTVfZ2Vt
X2luaXRfZ2d0dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAkvKiBM
ZXQgR0VNIE1hbmFnZSBhbGwgb2YgdGhlIGFwZXJ0dXJlLgo+ICAgCSAqCj4gQEAgLTI4NDUsNyAr
Mjg0NSw3IEBAIGludCBpOTE1X2dlbV9pbml0X2dndHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICAgCSAqIGFwZXJ0dXJlLiAgT25lIHBhZ2Ugc2hvdWxkIGJlIGVub3VnaCB0
byBrZWVwIGFueSBwcmVmZXRjaGluZyBpbnNpZGUKPiAgIAkgKiBvZiB0aGUgYXBlcnR1cmUuCj4g
ICAJICovCj4gLQlzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0ID0gJmRldl9wcml2LT5nZ3R0Owo+ICsJ
c3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCA9ICZpOTE1LT5nZ3R0Owo+ICAgCXVuc2lnbmVkIGxvbmcg
aG9sZV9zdGFydCwgaG9sZV9lbmQ7Cj4gICAJc3RydWN0IGRybV9tbV9ub2RlICplbnRyeTsKPiAg
IAlpbnQgcmV0Owo+IEBAIC0yODU3LDkgKzI4NTcsOSBAQCBpbnQgaTkxNV9nZW1faW5pdF9nZ3R0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkgKiB3aHkuCj4gICAJICov
Cj4gICAJZ2d0dC0+cGluX2JpYXMgPSBtYXhfdCh1MzIsIEk5MTVfR1RUX1BBR0VfU0laRSwKPiAt
CQkJICAgICAgIGludGVsX3dvcGNtX2d1Y19zaXplKCZkZXZfcHJpdi0+d29wY20pKTsKPiArCQkJ
ICAgICAgIGludGVsX3dvcGNtX2d1Y19zaXplKCZpOTE1LT53b3BjbSkpOwo+ICAgCj4gLQlyZXQg
PSBpbnRlbF92Z3RfYmFsbG9vbihkZXZfcHJpdik7Cj4gKwlyZXQgPSBpbnRlbF92Z3RfYmFsbG9v
bihpOTE1KTsKPiAgIAlpZiAocmV0KQo+ICAgCQlyZXR1cm4gcmV0Owo+ICAgCj4gQEAgLTI4OTEs
OCArMjg5MSw4IEBAIGludCBpOTE1X2dlbV9pbml0X2dndHQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ICAgCS8qIEFuZCBmaW5hbGx5IGNsZWFyIHRoZSByZXNlcnZlZCBndWFy
ZCBwYWdlICovCj4gICAJZ2d0dC0+dm0uY2xlYXJfcmFuZ2UoJmdndHQtPnZtLCBnZ3R0LT52bS50
b3RhbCAtIFBBR0VfU0laRSwgUEFHRV9TSVpFKTsKPiAgIAo+IC0JaWYgKElOVEVMX1BQR1RUKGRl
dl9wcml2KSA9PSBJTlRFTF9QUEdUVF9BTElBU0lORykgewo+IC0JCXJldCA9IGluaXRfYWxpYXNp
bmdfcHBndHQoZGV2X3ByaXYpOwo+ICsJaWYgKElOVEVMX1BQR1RUKGk5MTUpID09IElOVEVMX1BQ
R1RUX0FMSUFTSU5HKSB7Cj4gKwkJcmV0ID0gaW5pdF9hbGlhc2luZ19wcGd0dChpOTE1KTsKPiAg
IAkJaWYgKHJldCkKPiAgIAkJCWdvdG8gZXJyX2FwcGd0dDsKPiAgIAl9Cj4gQEAgLTI5MDgsMTgg
KzI5MDgsMTggQEAgaW50IGk5MTVfZ2VtX2luaXRfZ2d0dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gICAKPiAgIC8qKgo+ICAgICogaTkxNV9nZ3R0X2NsZWFudXBfaHcgLSBD
bGVhbiB1cCBHR1RUIGhhcmR3YXJlIGluaXRpYWxpemF0aW9uCj4gLSAqIEBkZXZfcHJpdjogaTkx
NSBkZXZpY2UKPiArICogQGk5MTU6IGk5MTUgZGV2aWNlCj4gICAgKi8KPiAtdm9pZCBpOTE1X2dn
dHRfY2xlYW51cF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQg
aTkxNV9nZ3R0X2NsZWFudXBfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7
Cj4gLQlzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0ID0gJmRldl9wcml2LT5nZ3R0Owo+ICsJc3RydWN0
IGk5MTVfZ2d0dCAqZ2d0dCA9ICZpOTE1LT5nZ3R0Owo+ICAgCXN0cnVjdCBpOTE1X3ZtYSAqdm1h
LCAqdm47Cj4gICAJc3RydWN0IHBhZ2V2ZWMgKnB2ZWM7Cj4gICAKPiAgIAlnZ3R0LT52bS5jbG9z
ZWQgPSB0cnVlOwo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRl
eCk7Cj4gLQlmaW5pX2FsaWFzaW5nX3BwZ3R0KGRldl9wcml2KTsKPiArCW11dGV4X2xvY2soJmk5
MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJZmluaV9hbGlhc2luZ19wcGd0dChpOTE1KTsKPiAg
IAo+ICAgCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZSh2bWEsIHZuLCAmZ2d0dC0+dm0uYm91bmRf
bGlzdCwgdm1fbGluaykKPiAgIAkJV0FSTl9PTihpOTE1X3ZtYV91bmJpbmQodm1hKSk7Cj4gQEAg
LTI5MzAsMjQgKzI5MzAsMjQgQEAgdm9pZCBpOTE1X2dndHRfY2xlYW51cF9odyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJZ2d0dF9yZWxlYXNlX2d1Y190b3AoZ2d0dCk7
Cj4gICAKPiAgIAlpZiAoZHJtX21tX2luaXRpYWxpemVkKCZnZ3R0LT52bS5tbSkpIHsKPiAtCQlp
bnRlbF92Z3RfZGViYWxsb29uKGRldl9wcml2KTsKPiArCQlpbnRlbF92Z3RfZGViYWxsb29uKGk5
MTUpOwo+ICAgCQlpOTE1X2FkZHJlc3Nfc3BhY2VfZmluaSgmZ2d0dC0+dm0pOwo+ICAgCX0KPiAg
IAo+ICAgCWdndHQtPnZtLmNsZWFudXAoJmdndHQtPnZtKTsKPiAgIAo+IC0JcHZlYyA9ICZkZXZf
cHJpdi0+bW0ud2Nfc3Rhc2gucHZlYzsKPiArCXB2ZWMgPSAmaTkxNS0+bW0ud2Nfc3Rhc2gucHZl
YzsKPiAgIAlpZiAocHZlYy0+bnIpIHsKPiAgIAkJc2V0X3BhZ2VzX2FycmF5X3diKHB2ZWMtPnBh
Z2VzLCBwdmVjLT5ucik7Cj4gICAJCV9fcGFnZXZlY19yZWxlYXNlKHB2ZWMpOwo+ICAgCX0KPiAg
IAo+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gKwltdXRl
eF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCj4gICAJYXJjaF9waHlzX3dj
X2RlbChnZ3R0LT5tdHJyKTsKPiAgIAlpb19tYXBwaW5nX2ZpbmkoJmdndHQtPmlvbWFwKTsKPiAg
IAo+IC0JaTkxNV9nZW1fY2xlYW51cF9zdG9sZW4oZGV2X3ByaXYpOwo+ICsJaTkxNV9nZW1fY2xl
YW51cF9zdG9sZW4oaTkxNSk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB1bnNpZ25lZCBpbnQgZ2Vu
Nl9nZXRfdG90YWxfZ3R0X3NpemUodTE2IHNuYl9nbWNoX2N0bCkKPiBAQCAtMjk4Niw4ICsyOTg2
LDggQEAgc3RhdGljIHVuc2lnbmVkIGludCBjaHZfZ2V0X3RvdGFsX2d0dF9zaXplKHUxNiBnbWNo
X2N0cmwpCj4gICAKPiAgIHN0YXRpYyBpbnQgZ2d0dF9wcm9iZV9jb21tb24oc3RydWN0IGk5MTVf
Z2d0dCAqZ2d0dCwgdTY0IHNpemUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBnZ3R0LT52bS5pOTE1Owo+IC0Jc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBkZXZf
cHJpdi0+ZHJtLnBkZXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGdndHQt
PnZtLmk5MTU7Cj4gKwlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGk5MTUtPmRybS5wZGV2Owo+ICAg
CXBoeXNfYWRkcl90IHBoeXNfYWRkcjsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gQEAgLTMwMDEsNyAr
MzAwMSw3IEBAIHN0YXRpYyBpbnQgZ2d0dF9wcm9iZV9jb21tb24oc3RydWN0IGk5MTVfZ2d0dCAq
Z2d0dCwgdTY0IHNpemUpCj4gICAJICogcmVzb3J0IHRvIGFuIHVuY2FjaGVkIG1hcHBpbmcuIFRo
ZSBXQyBpc3N1ZSBpcyBlYXNpbHkgY2F1Z2h0IGJ5IHRoZQo+ICAgCSAqIHJlYWRiYWNrIGNoZWNr
IHdoZW4gd3JpdGluZyBHVFQgUFRFIGVudHJpZXMuCj4gICAJICovCj4gLQlpZiAoSVNfR0VOOV9M
UChkZXZfcHJpdikgfHwgSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCkKPiArCWlmIChJU19HRU45
X0xQKGk5MTUpIHx8IElOVEVMX0dFTihpOTE1KSA+PSAxMCkKPiAgIAkJZ2d0dC0+Z3NtID0gaW9y
ZW1hcF9ub2NhY2hlKHBoeXNfYWRkciwgc2l6ZSk7Cj4gICAJZWxzZQo+ICAgCQlnZ3R0LT5nc20g
PSBpb3JlbWFwX3djKHBoeXNfYWRkciwgc2l6ZSk7Cj4gQEAgLTMxMzUsOSArMzEzNSw5IEBAIHZv
aWQgaW50ZWxfcHBhdF9wdXQoY29uc3Qgc3RydWN0IGludGVsX3BwYXRfZW50cnkgKmVudHJ5KQo+
ICAgCWtyZWZfcHV0KCZwcGF0LT5lbnRyaWVzW2luZGV4XS5yZWYsIHJlbGVhc2VfcHBhdCk7Cj4g
ICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgY25sX3ByaXZhdGVfcGF0X3VwZGF0ZV9odyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGNubF9wcml2YXRlX3Bh
dF91cGRhdGVfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1
Y3QgaW50ZWxfcHBhdCAqcHBhdCA9ICZkZXZfcHJpdi0+cHBhdDsKPiArCXN0cnVjdCBpbnRlbF9w
cGF0ICpwcGF0ID0gJmk5MTUtPnBwYXQ7Cj4gICAJaW50IGk7Cj4gICAKPiAgIAlmb3JfZWFjaF9z
ZXRfYml0KGksIHBwYXQtPmRpcnR5LCBwcGF0LT5tYXhfZW50cmllcykgewo+IEBAIC0zMTQ2LDkg
KzMxNDYsOSBAQCBzdGF0aWMgdm9pZCBjbmxfcHJpdmF0ZV9wYXRfdXBkYXRlX2h3KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAl9Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZv
aWQgYmR3X3ByaXZhdGVfcGF0X3VwZGF0ZV9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGJkd19wcml2YXRlX3BhdF91cGRhdGVfaHcoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfcHBhdCAqcHBhdCA9
ICZkZXZfcHJpdi0+cHBhdDsKPiArCXN0cnVjdCBpbnRlbF9wcGF0ICpwcGF0ID0gJmk5MTUtPnBw
YXQ7Cj4gICAJdTY0IHBhdCA9IDA7Cj4gICAJaW50IGk7Cj4gICAKPiBAQCAtMzI5MywxNiArMzI5
MywxNiBAQCBzdGF0aWMgdm9pZCBnZW42X2dtY2hfcmVtb3ZlKHN0cnVjdCBpOTE1X2FkZHJlc3Nf
c3BhY2UgKnZtKQo+ICAgCWNsZWFudXBfc2NyYXRjaF9wYWdlKHZtKTsKPiAgIH0KPiAgIAo+IC1z
dGF0aWMgdm9pZCBzZXR1cF9wcml2YXRlX3BhdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gK3N0YXRpYyB2b2lkIHNldHVwX3ByaXZhdGVfcGF0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RydWN0IGludGVsX3BwYXQgKnBwYXQgPSAmZGV2X3By
aXYtPnBwYXQ7Cj4gKwlzdHJ1Y3QgaW50ZWxfcHBhdCAqcHBhdCA9ICZpOTE1LT5wcGF0Owo+ICAg
CWludCBpOwo+ICAgCj4gLQlwcGF0LT5pOTE1ID0gZGV2X3ByaXY7Cj4gKwlwcGF0LT5pOTE1ID0g
aTkxNTsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTApCj4gKwlpZiAoSU5U
RUxfR0VOKGk5MTUpID49IDEwKQo+ICAgCQljbmxfc2V0dXBfcHJpdmF0ZV9wcGF0KHBwYXQpOwo+
IC0JZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikgfHwgSVNfR0VOOV9MUChkZXZfcHJp
dikpCj4gKwllbHNlIGlmIChJU19DSEVSUllWSUVXKGk5MTUpIHx8IElTX0dFTjlfTFAoaTkxNSkp
Cj4gICAJCWNodl9zZXR1cF9wcml2YXRlX3BwYXQocHBhdCk7Cj4gICAJZWxzZQo+ICAgCQliZHdf
c2V0dXBfcHJpdmF0ZV9wcGF0KHBwYXQpOwo+IEBAIC0zMzE1LDEzICszMzE1LDEzIEBAIHN0YXRp
YyB2b2lkIHNldHVwX3ByaXZhdGVfcGF0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiAgIAkJc2V0X2JpdChpLCBwcGF0LT5kaXJ0eSk7Cj4gICAJfQo+ICAgCj4gLQlwcGF0LT51
cGRhdGVfaHcoZGV2X3ByaXYpOwo+ICsJcHBhdC0+dXBkYXRlX2h3KGk5MTUpOwo+ICAgfQo+ICAg
Cj4gICBzdGF0aWMgaW50IGdlbjhfZ21jaF9wcm9iZShzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0KQo+
ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZ2d0dC0+dm0uaTkx
NTsKPiAtCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gZGV2X3ByaXYtPmRybS5wZGV2Owo+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBnZ3R0LT52bS5pOTE1Owo+ICsJc3RydWN0IHBj
aV9kZXYgKnBkZXYgPSBpOTE1LT5kcm0ucGRldjsKPiAgIAl1bnNpZ25lZCBpbnQgc2l6ZTsKPiAg
IAl1MTYgc25iX2dtY2hfY3RsOwo+ICAgCWludCBlcnI7Cj4gQEAgLTMzMzksNyArMzMzOSw3IEBA
IHN0YXRpYyBpbnQgZ2VuOF9nbWNoX3Byb2JlKHN0cnVjdCBpOTE1X2dndHQgKmdndHQpCj4gICAJ
CURSTV9FUlJPUigiQ2FuJ3Qgc2V0IERNQSBtYXNrL2NvbnNpc3RlbnQgbWFzayAoJWQpXG4iLCBl
cnIpOwo+ICAgCj4gICAJcGNpX3JlYWRfY29uZmlnX3dvcmQocGRldiwgU05CX0dNQ0hfQ1RSTCwg
JnNuYl9nbWNoX2N0bCk7Cj4gLQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gKwlpZiAo
SVNfQ0hFUlJZVklFVyhpOTE1KSkKPiAgIAkJc2l6ZSA9IGNodl9nZXRfdG90YWxfZ3R0X3NpemUo
c25iX2dtY2hfY3RsKTsKPiAgIAllbHNlCj4gICAJCXNpemUgPSBnZW44X2dldF90b3RhbF9ndHRf
c2l6ZShzbmJfZ21jaF9jdGwpOwo+IEBAIC0zMzQ4LDIzICszMzQ4LDIzIEBAIHN0YXRpYyBpbnQg
Z2VuOF9nbWNoX3Byb2JlKHN0cnVjdCBpOTE1X2dndHQgKmdndHQpCj4gICAJZ2d0dC0+dm0uY2xl
YW51cCA9IGdlbjZfZ21jaF9yZW1vdmU7Cj4gICAJZ2d0dC0+dm0uaW5zZXJ0X3BhZ2UgPSBnZW44
X2dndHRfaW5zZXJ0X3BhZ2U7Cj4gICAJZ2d0dC0+dm0uY2xlYXJfcmFuZ2UgPSBub3BfY2xlYXJf
cmFuZ2U7Cj4gLQlpZiAoaW50ZWxfc2Nhbm91dF9uZWVkc192dGRfd2EoZGV2X3ByaXYpKQo+ICsJ
aWYgKGludGVsX3NjYW5vdXRfbmVlZHNfdnRkX3dhKGk5MTUpKQo+ICAgCQlnZ3R0LT52bS5jbGVh
cl9yYW5nZSA9IGdlbjhfZ2d0dF9jbGVhcl9yYW5nZTsKPiAgIAo+ICAgCWdndHQtPnZtLmluc2Vy
dF9lbnRyaWVzID0gZ2VuOF9nZ3R0X2luc2VydF9lbnRyaWVzOwo+ICAgCj4gICAJLyogU2VyaWFs
aXplIEdUVCB1cGRhdGVzIHdpdGggYXBlcnR1cmUgYWNjZXNzIG9uIEJYVCBpZiBWVC1kIGlzIG9u
LiAqLwo+IC0JaWYgKGludGVsX2dndHRfdXBkYXRlX25lZWRzX3Z0ZF93YShkZXZfcHJpdikgfHwK
PiAtCSAgICBJU19DSEVSUllWSUVXKGRldl9wcml2KSAvKiBmYWlscyB3aXRoIGNvbmN1cnJlbnQg
dXNlL3VwZGF0ZSAqLykgewo+ICsJaWYgKGludGVsX2dndHRfdXBkYXRlX25lZWRzX3Z0ZF93YShp
OTE1KSB8fAo+ICsJICAgIElTX0NIRVJSWVZJRVcoaTkxNSkgLyogZmFpbHMgd2l0aCBjb25jdXJy
ZW50IHVzZS91cGRhdGUgKi8pIHsKPiAgIAkJZ2d0dC0+dm0uaW5zZXJ0X2VudHJpZXMgPSBieHRf
dnRkX2dndHRfaW5zZXJ0X2VudHJpZXNfX0JLTDsKPiAgIAkJZ2d0dC0+dm0uaW5zZXJ0X3BhZ2Ug
ICAgPSBieHRfdnRkX2dndHRfaW5zZXJ0X3BhZ2VfX0JLTDsKPiAgIAkJaWYgKGdndHQtPnZtLmNs
ZWFyX3JhbmdlICE9IG5vcF9jbGVhcl9yYW5nZSkKPiAgIAkJCWdndHQtPnZtLmNsZWFyX3Jhbmdl
ID0gYnh0X3Z0ZF9nZ3R0X2NsZWFyX3JhbmdlX19CS0w7Cj4gICAKPiAgIAkJLyogUHJldmVudCBy
ZWN1cnNpdmVseSBjYWxsaW5nIHN0b3BfbWFjaGluZSgpIGFuZCBkZWFkbG9ja3MuICovCj4gLQkJ
ZGV2X2luZm8oZGV2X3ByaXYtPmRybS5kZXYsCj4gKwkJZGV2X2luZm8oaTkxNS0+ZHJtLmRldiwK
PiAgIAkJCSAiRGlzYWJsaW5nIGVycm9yIGNhcHR1cmUgZm9yIFZULWQgd29ya2Fyb3VuZFxuIik7
Cj4gLQkJaTkxNV9kaXNhYmxlX2Vycm9yX3N0YXRlKGRldl9wcml2LCAtRU5PREVWKTsKPiArCQlp
OTE1X2Rpc2FibGVfZXJyb3Jfc3RhdGUoaTkxNSwgLUVOT0RFVik7Cj4gICAJfQo+ICAgCj4gICAJ
Z2d0dC0+aW52YWxpZGF0ZSA9IGdlbjZfZ2d0dF9pbnZhbGlkYXRlOwo+IEBAIC0zMzc2LDE1ICsz
Mzc2LDE1IEBAIHN0YXRpYyBpbnQgZ2VuOF9nbWNoX3Byb2JlKHN0cnVjdCBpOTE1X2dndHQgKmdn
dHQpCj4gICAKPiAgIAlnZ3R0LT52bS5wdGVfZW5jb2RlID0gZ2VuOF9wdGVfZW5jb2RlOwo+ICAg
Cj4gLQlzZXR1cF9wcml2YXRlX3BhdChkZXZfcHJpdik7Cj4gKwlzZXR1cF9wcml2YXRlX3BhdChp
OTE1KTsKPiAgIAo+ICAgCXJldHVybiBnZ3R0X3Byb2JlX2NvbW1vbihnZ3R0LCBzaXplKTsKPiAg
IH0KPiAgIAo+ICAgc3RhdGljIGludCBnZW42X2dtY2hfcHJvYmUoc3RydWN0IGk5MTVfZ2d0dCAq
Z2d0dCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGdndHQt
PnZtLmk5MTU7Cj4gLQlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGRldl9wcml2LT5kcm0ucGRldjsK
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ2d0dC0+dm0uaTkxNTsKPiArCXN0
cnVjdCBwY2lfZGV2ICpwZGV2ID0gaTkxNS0+ZHJtLnBkZXY7Cj4gICAJdW5zaWduZWQgaW50IHNp
emU7Cj4gICAJdTE2IHNuYl9nbWNoX2N0bDsKPiAgIAlpbnQgZXJyOwo+IEBAIC0zNDEzLDcgKzM0
MTMsNyBAQCBzdGF0aWMgaW50IGdlbjZfZ21jaF9wcm9iZShzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0
KQo+ICAgCWdndHQtPnZtLnRvdGFsID0gKHNpemUgLyBzaXplb2YoZ2VuNl9wdGVfdCkpICogSTkx
NV9HVFRfUEFHRV9TSVpFOwo+ICAgCj4gICAJZ2d0dC0+dm0uY2xlYXJfcmFuZ2UgPSBub3BfY2xl
YXJfcmFuZ2U7Cj4gLQlpZiAoIUhBU19GVUxMX1BQR1RUKGRldl9wcml2KSB8fCBpbnRlbF9zY2Fu
b3V0X25lZWRzX3Z0ZF93YShkZXZfcHJpdikpCj4gKwlpZiAoIUhBU19GVUxMX1BQR1RUKGk5MTUp
IHx8IGludGVsX3NjYW5vdXRfbmVlZHNfdnRkX3dhKGk5MTUpKQo+ICAgCQlnZ3R0LT52bS5jbGVh
cl9yYW5nZSA9IGdlbjZfZ2d0dF9jbGVhcl9yYW5nZTsKPiAgIAlnZ3R0LT52bS5pbnNlcnRfcGFn
ZSA9IGdlbjZfZ2d0dF9pbnNlcnRfcGFnZTsKPiAgIAlnZ3R0LT52bS5pbnNlcnRfZW50cmllcyA9
IGdlbjZfZ2d0dF9pbnNlcnRfZW50cmllczsKPiBAQCAtMzQyMSwxMyArMzQyMSwxMyBAQCBzdGF0
aWMgaW50IGdlbjZfZ21jaF9wcm9iZShzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0KQo+ICAgCj4gICAJ
Z2d0dC0+aW52YWxpZGF0ZSA9IGdlbjZfZ2d0dF9pbnZhbGlkYXRlOwo+ICAgCj4gLQlpZiAoSEFT
X0VEUkFNKGRldl9wcml2KSkKPiArCWlmIChIQVNfRURSQU0oaTkxNSkpCj4gICAJCWdndHQtPnZt
LnB0ZV9lbmNvZGUgPSBpcmlzX3B0ZV9lbmNvZGU7Cj4gLQllbHNlIGlmIChJU19IQVNXRUxMKGRl
dl9wcml2KSkKPiArCWVsc2UgaWYgKElTX0hBU1dFTEwoaTkxNSkpCj4gICAJCWdndHQtPnZtLnB0
ZV9lbmNvZGUgPSBoc3dfcHRlX2VuY29kZTsKPiAtCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2
X3ByaXYpKQo+ICsJZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSkKPiAgIAkJZ2d0dC0+dm0u
cHRlX2VuY29kZSA9IGJ5dF9wdGVfZW5jb2RlOwo+IC0JZWxzZSBpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA+PSA3KQo+ICsJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDcpCj4gICAJCWdndHQt
PnZtLnB0ZV9lbmNvZGUgPSBpdmJfcHRlX2VuY29kZTsKPiAgIAllbHNlCj4gICAJCWdndHQtPnZt
LnB0ZV9lbmNvZGUgPSBzbmJfcHRlX2VuY29kZTsKPiBAQCAtMzQ0NywxMSArMzQ0NywxMSBAQCBz
dGF0aWMgdm9pZCBpOTE1X2dtY2hfcmVtb3ZlKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZt
KQo+ICAgCj4gICBzdGF0aWMgaW50IGk5MTVfZ21jaF9wcm9iZShzdHJ1Y3QgaTkxNV9nZ3R0ICpn
Z3R0KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZ2d0dC0+
dm0uaTkxNTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ2d0dC0+dm0uaTkx
NTsKPiAgIAlwaHlzX2FkZHJfdCBnbWFkcl9iYXNlOwo+ICAgCWludCByZXQ7Cj4gICAKPiAtCXJl
dCA9IGludGVsX2dtY2hfcHJvYmUoZGV2X3ByaXYtPmJyaWRnZV9kZXYsIGRldl9wcml2LT5kcm0u
cGRldiwgTlVMTCk7Cj4gKwlyZXQgPSBpbnRlbF9nbWNoX3Byb2JlKGk5MTUtPmJyaWRnZV9kZXYs
IGk5MTUtPmRybS5wZGV2LCBOVUxMKTsKPiAgIAlpZiAoIXJldCkgewo+ICAgCQlEUk1fRVJST1Io
ImZhaWxlZCB0byBzZXQgdXAgZ21jaFxuIik7Cj4gICAJCXJldHVybiAtRUlPOwo+IEBAIC0zNDYz
LDcgKzM0NjMsNyBAQCBzdGF0aWMgaW50IGk5MTVfZ21jaF9wcm9iZShzdHJ1Y3QgaTkxNV9nZ3R0
ICpnZ3R0KQo+ICAgCQkoc3RydWN0IHJlc291cmNlKSBERUZJTkVfUkVTX01FTShnbWFkcl9iYXNl
LAo+ICAgCQkJCQkJIGdndHQtPm1hcHBhYmxlX2VuZCk7Cj4gICAKPiAtCWdndHQtPmRvX2lkbGVf
bWFwcyA9IG5lZWRzX2lkbGVfbWFwcyhkZXZfcHJpdik7Cj4gKwlnZ3R0LT5kb19pZGxlX21hcHMg
PSBuZWVkc19pZGxlX21hcHMoaTkxNSk7Cj4gICAJZ2d0dC0+dm0uaW5zZXJ0X3BhZ2UgPSBpOTE1
X2dndHRfaW5zZXJ0X3BhZ2U7Cj4gICAJZ2d0dC0+dm0uaW5zZXJ0X2VudHJpZXMgPSBpOTE1X2dn
dHRfaW5zZXJ0X2VudHJpZXM7Cj4gICAJZ2d0dC0+dm0uY2xlYXJfcmFuZ2UgPSBpOTE1X2dndHRf
Y2xlYXJfcmFuZ2U7Cj4gQEAgLTM0ODQsMTkgKzM0ODQsMTkgQEAgc3RhdGljIGludCBpOTE1X2dt
Y2hfcHJvYmUoc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCkKPiAgIAo+ICAgLyoqCj4gICAgKiBpOTE1
X2dndHRfcHJvYmVfaHcgLSBQcm9iZSBHR1RUIGhhcmR3YXJlIGxvY2F0aW9uCj4gLSAqIEBkZXZf
cHJpdjogaTkxNSBkZXZpY2UKPiArICogQGk5MTU6IGk5MTUgZGV2aWNlCj4gICAgKi8KPiAtaW50
IGk5MTVfZ2d0dF9wcm9iZV9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
K2ludCBpOTE1X2dndHRfcHJvYmVfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
ICB7Cj4gLQlzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0ID0gJmRldl9wcml2LT5nZ3R0Owo+ICsJc3Ry
dWN0IGk5MTVfZ2d0dCAqZ2d0dCA9ICZpOTE1LT5nZ3R0Owo+ICAgCWludCByZXQ7Cj4gICAKPiAt
CWdndHQtPnZtLmk5MTUgPSBkZXZfcHJpdjsKPiAtCWdndHQtPnZtLmRtYSA9ICZkZXZfcHJpdi0+
ZHJtLnBkZXYtPmRldjsKPiArCWdndHQtPnZtLmk5MTUgPSBpOTE1Owo+ICsJZ2d0dC0+dm0uZG1h
ID0gJmk5MTUtPmRybS5wZGV2LT5kZXY7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
IDw9IDUpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDw9IDUpCj4gICAJCXJldCA9IGk5MTVfZ21j
aF9wcm9iZShnZ3R0KTsKPiAtCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA4KQo+ICsJ
ZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpIDwgOCkKPiAgIAkJcmV0ID0gZ2VuNl9nbWNoX3Byb2Jl
KGdndHQpOwo+ICAgCWVsc2UKPiAgIAkJcmV0ID0gZ2VuOF9nbWNoX3Byb2JlKGdndHQpOwo+IEBA
IC0zNTMyLDM1ICszNTMyLDM1IEBAIGludCBpOTE1X2dndHRfcHJvYmVfaHcoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCj4gICAvKioKPiAgICAqIGk5MTVfZ2d0dF9pbml0
X2h3IC0gSW5pdGlhbGl6ZSBHR1RUIGhhcmR3YXJlCj4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZp
Y2UKPiArICogQGk5MTU6IGk5MTUgZGV2aWNlCj4gICAgKi8KPiAtaW50IGk5MTVfZ2d0dF9pbml0
X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAraW50IGk5MTVfZ2d0dF9p
bml0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RydWN0IGk5
MTVfZ2d0dCAqZ2d0dCA9ICZkZXZfcHJpdi0+Z2d0dDsKPiArCXN0cnVjdCBpOTE1X2dndHQgKmdn
dHQgPSAmaTkxNS0+Z2d0dDsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gLQlzdGFzaF9pbml0KCZkZXZf
cHJpdi0+bW0ud2Nfc3Rhc2gpOwo+ICsJc3Rhc2hfaW5pdCgmaTkxNS0+bW0ud2Nfc3Rhc2gpOwo+
ICAgCj4gICAJLyogTm90ZSB0aGF0IHdlIHVzZSBwYWdlIGNvbG91cmluZyB0byBlbmZvcmNlIGEg
Z3VhcmQgcGFnZSBhdCB0aGUKPiAgIAkgKiBlbmQgb2YgdGhlIGFkZHJlc3Mgc3BhY2UuIFRoaXMg
aXMgcmVxdWlyZWQgYXMgdGhlIENTIG1heSBwcmVmZXRjaAo+ICAgCSAqIGJleW9uZCB0aGUgZW5k
IG9mIHRoZSBiYXRjaCBidWZmZXIsIGFjcm9zcyB0aGUgcGFnZSBib3VuZGFyeSwKPiAgIAkgKiBh
bmQgYmV5b25kIHRoZSBlbmQgb2YgdGhlIEdUVCBpZiB3ZSBkbyBub3QgcHJvdmlkZSBhIGd1YXJk
Lgo+ICAgCSAqLwo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+
ICsJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAJaTkxNV9hZGRyZXNz
X3NwYWNlX2luaXQoJmdndHQtPnZtLCBWTV9DTEFTU19HR1RUKTsKPiAgIAo+ICAgCWdndHQtPnZt
LmlzX2dndHQgPSB0cnVlOwo+ICAgCj4gICAJLyogT25seSBWTFYgc3VwcG9ydHMgcmVhZC1vbmx5
IEdHVFQgbWFwcGluZ3MgKi8KPiAtCWdndHQtPnZtLmhhc19yZWFkX29ubHkgPSBJU19WQUxMRVlW
SUVXKGRldl9wcml2KTsKPiArCWdndHQtPnZtLmhhc19yZWFkX29ubHkgPSBJU19WQUxMRVlWSUVX
KGk5MTUpOwo+ICAgCj4gLQlpZiAoIUhBU19MTEMoZGV2X3ByaXYpICYmICFIQVNfUFBHVFQoZGV2
X3ByaXYpKQo+ICsJaWYgKCFIQVNfTExDKGk5MTUpICYmICFIQVNfUFBHVFQoaTkxNSkpCj4gICAJ
CWdndHQtPnZtLm1tLmNvbG9yX2FkanVzdCA9IGk5MTVfZ3R0X2NvbG9yX2FkanVzdDsKPiAtCW11
dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJbXV0ZXhfdW5sb2Nr
KCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAo+IC0JaWYgKCFpb19tYXBwaW5nX2luaXRf
d2MoJmRldl9wcml2LT5nZ3R0LmlvbWFwLAo+IC0JCQkJZGV2X3ByaXYtPmdndHQuZ21hZHIuc3Rh
cnQsCj4gLQkJCQlkZXZfcHJpdi0+Z2d0dC5tYXBwYWJsZV9lbmQpKSB7Cj4gKwlpZiAoIWlvX21h
cHBpbmdfaW5pdF93YygmaTkxNS0+Z2d0dC5pb21hcCwKPiArCQkJCWk5MTUtPmdndHQuZ21hZHIu
c3RhcnQsCj4gKwkJCQlpOTE1LT5nZ3R0Lm1hcHBhYmxlX2VuZCkpIHsKPiAgIAkJcmV0ID0gLUVJ
TzsKPiAgIAkJZ290byBvdXRfZ3R0X2NsZWFudXA7Cj4gICAJfQo+IEBAIC0zNTcxLDcgKzM1NzEs
NyBAQCBpbnQgaTkxNV9nZ3R0X2luaXRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICAgCSAqIEluaXRpYWxpc2Ugc3RvbGVuIGVhcmx5IHNvIHRoYXQgd2UgbWF5IHJlc2Vy
dmUgcHJlYWxsb2NhdGVkCj4gICAJICogb2JqZWN0cyBmb3IgdGhlIEJJT1MgdG8gS01TIHRyYW5z
aXRpb24uCj4gICAJICovCj4gLQlyZXQgPSBpOTE1X2dlbV9pbml0X3N0b2xlbihkZXZfcHJpdik7
Cj4gKwlyZXQgPSBpOTE1X2dlbV9pbml0X3N0b2xlbihpOTE1KTsKPiAgIAlpZiAocmV0KQo+ICAg
CQlnb3RvIG91dF9ndHRfY2xlYW51cDsKPiAgIAo+IEBAIC0zNTgyLDkgKzM1ODIsOSBAQCBpbnQg
aTkxNV9nZ3R0X2luaXRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAg
CXJldHVybiByZXQ7Cj4gICB9Cj4gICAKPiAtaW50IGk5MTVfZ2d0dF9lbmFibGVfaHcoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtpbnQgaTkxNV9nZ3R0X2VuYWJsZV9odyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCWlmIChJTlRFTF9HRU4oZGV2
X3ByaXYpIDwgNiAmJiAhaW50ZWxfZW5hYmxlX2d0dCgpKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1
KSA8IDYgJiYgIWludGVsX2VuYWJsZV9ndHQoKSkKPiAgIAkJcmV0dXJuIC1FSU87Cj4gICAKPiAg
IAlyZXR1cm4gMDsKPiBAQCAtMzYxMywxMiArMzYxMywxMiBAQCB2b2lkIGk5MTVfZ2d0dF9kaXNh
YmxlX2d1YyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIAlpOTE1X2dndHRfaW52
YWxpZGF0ZShpOTE1KTsKPiAgIH0KPiAgIAo+IC12b2lkIGk5MTVfZ2VtX3Jlc3RvcmVfZ3R0X21h
cHBpbmdzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBpOTE1X2dl
bV9yZXN0b3JlX2d0dF9tYXBwaW5ncyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAg
IHsKPiAtCXN0cnVjdCBpOTE1X2dndHQgKmdndHQgPSAmZGV2X3ByaXYtPmdndHQ7Cj4gKwlzdHJ1
Y3QgaTkxNV9nZ3R0ICpnZ3R0ID0gJmk5MTUtPmdndHQ7Cj4gICAJc3RydWN0IGk5MTVfdm1hICp2
bWEsICp2bjsKPiAgIAo+IC0JaTkxNV9jaGVja19hbmRfY2xlYXJfZmF1bHRzKGRldl9wcml2KTsK
PiArCWk5MTVfY2hlY2tfYW5kX2NsZWFyX2ZhdWx0cyhpOTE1KTsKPiAgIAo+ICAgCW11dGV4X2xv
Y2soJmdndHQtPnZtLm11dGV4KTsKPiAgIAo+IEBAIC0zNjUyLDE1ICszNjUyLDE1IEBAIHZvaWQg
aTkxNV9nZW1fcmVzdG9yZV9ndHRfbWFwcGluZ3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ICAgCX0KPiAgIAo+ICAgCWdndHQtPnZtLmNsb3NlZCA9IGZhbHNlOwo+IC0JaTkx
NV9nZ3R0X2ludmFsaWRhdGUoZGV2X3ByaXYpOwo+ICsJaTkxNV9nZ3R0X2ludmFsaWRhdGUoaTkx
NSk7Cj4gICAKPiAgIAltdXRleF91bmxvY2soJmdndHQtPnZtLm11dGV4KTsKPiAgIAo+IC0JaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPj0gOCkgewo+IC0JCXN0cnVjdCBpbnRlbF9wcGF0ICpwcGF0
ID0gJmRldl9wcml2LT5wcGF0Owo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA4KSB7Cj4gKwkJ
c3RydWN0IGludGVsX3BwYXQgKnBwYXQgPSAmaTkxNS0+cHBhdDsKPiAgIAo+ICAgCQliaXRtYXBf
c2V0KHBwYXQtPmRpcnR5LCAwLCBwcGF0LT5tYXhfZW50cmllcyk7Cj4gLQkJZGV2X3ByaXYtPnBw
YXQudXBkYXRlX2h3KGRldl9wcml2KTsKPiArCQlpOTE1LT5wcGF0LnVwZGF0ZV9odyhpOTE1KTsK
PiAgIAkJcmV0dXJuOwo+ICAgCX0KPiAgIH0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9nZW1fZ3R0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQu
aAo+IGluZGV4IDg5NDM3ZDBhNzIxYy4uYjQ0NDU1MmNjYzYzIDEwMDY0NAo+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9nZW1fZ3R0LmgKPiBAQCAtNDAwLDcgKzQwMCw3IEBAIHN0cnVjdCBpOTE1X2dndHQg
ewo+ICAgCj4gICAJLyoqICJHcmFwaGljcyBTdG9sZW4gTWVtb3J5IiBob2xkcyB0aGUgZ2xvYmFs
IFBURXMgKi8KPiAgIAl2b2lkIF9faW9tZW0gKmdzbTsKPiAtCXZvaWQgKCppbnZhbGlkYXRlKShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ICsJdm9pZCAoKmludmFsaWRhdGUp
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAgIAo+ICAgCWJvb2wgZG9faWRsZV9t
YXBzOwo+ICAgCj4gQEAgLTYyNywxNyArNjI3LDE3IEBAIGNvbnN0IHN0cnVjdCBpbnRlbF9wcGF0
X2VudHJ5ICoKPiAgIGludGVsX3BwYXRfZ2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LCB1OCB2YWx1ZSk7Cj4gICB2b2lkIGludGVsX3BwYXRfcHV0KGNvbnN0IHN0cnVjdCBpbnRlbF9w
cGF0X2VudHJ5ICplbnRyeSk7Cj4gICAKPiAtaW50IGk5MTVfZ2d0dF9wcm9iZV9odyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC1pbnQgaTkxNV9nZ3R0X2luaXRfaHcoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtaW50IGk5MTVfZ2d0dF9lbmFibGVf
aHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAraW50IGk5MTVfZ2d0dF9w
cm9iZV9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK2ludCBpOTE1X2dndHRf
aW5pdF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK2ludCBpOTE1X2dndHRf
ZW5hYmxlX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAgIHZvaWQgaTkxNV9n
Z3R0X2VuYWJsZV9ndWMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgdm9pZCBp
OTE1X2dndHRfZGlzYWJsZV9ndWMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+IC1p
bnQgaTkxNV9nZW1faW5pdF9nZ3R0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7
Cj4gLXZvaWQgaTkxNV9nZ3R0X2NsZWFudXBfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KTsKPiAraW50IGk5MTVfZ2VtX2luaXRfZ2d0dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSk7Cj4gK3ZvaWQgaTkxNV9nZ3R0X2NsZWFudXBfaHcoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpOwo+ICAgCj4gLWludCBpOTE1X3BwZ3R0X2luaXRfaHcoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAraW50IGk5MTVfcHBndHRfaW5pdF9odyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICAKPiAtc3RydWN0IGk5MTVfcHBndHQgKmk5MTVf
cHBndHRfY3JlYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gK3N0cnVj
dCBpOTE1X3BwZ3R0ICppOTE1X3BwZ3R0X2NyZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSk7Cj4gICAKPiAgIHN0YXRpYyBpbmxpbmUgc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAq
Cj4gICBpOTE1X3ZtX2dldChzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSkKPiBAQCAtNjU3
LDggKzY1Nyw4IEBAIGludCBnZW42X3BwZ3R0X3BpbihzdHJ1Y3QgaTkxNV9wcGd0dCAqYmFzZSk7
Cj4gICB2b2lkIGdlbjZfcHBndHRfdW5waW4oc3RydWN0IGk5MTVfcHBndHQgKmJhc2UpOwo+ICAg
dm9pZCBnZW42X3BwZ3R0X3VucGluX2FsbChzdHJ1Y3QgaTkxNV9wcGd0dCAqYmFzZSk7Cj4gICAK
PiAtdm9pZCBpOTE1X2dlbV9zdXNwZW5kX2d0dF9tYXBwaW5ncyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGk5MTVfZ2VtX3Jlc3RvcmVfZ3R0X21hcHBpbmdzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gK3ZvaWQgaTkxNV9nZW1fc3VzcGVu
ZF9ndHRfbWFwcGluZ3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lkIGk5
MTVfZ2VtX3Jlc3RvcmVfZ3R0X21hcHBpbmdzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KTsKPiAgIAo+ICAgaW50IF9fbXVzdF9jaGVjayBpOTE1X2dlbV9ndHRfcHJlcGFyZV9wYWdlcyhz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAo+ICAgCQkJCQkgICAgc3RydWN0IHNnX3Rh
YmxlICpwYWdlcyk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1
X2Vycm9yLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jCj4gaW5kZXgg
ZDdmMTY0YzlmMmViLi4zMzVkYTU5MDMxYjAgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9ncHVfZXJyb3IuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
Z3B1X2Vycm9yLmMKPiBAQCAtMTEyMiwyMiArMTEyMiwyMiBAQCBzdGF0aWMgdTMyIGk5MTVfZXJy
b3JfZ2VuZXJhdGVfY29kZShzdHJ1Y3QgaTkxNV9ncHVfc3RhdGUgKmVycm9yLAo+ICAgCj4gICBz
dGF0aWMgdm9pZCBnZW1fcmVjb3JkX2ZlbmNlcyhzdHJ1Y3QgaTkxNV9ncHVfc3RhdGUgKmVycm9y
KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZXJyb3ItPmk5
MTU7Cj4gLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsK
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZXJyb3ItPmk5MTU7Cj4gKwlzdHJ1
Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwo+ICAgCWludCBpOwo+ICAg
Cj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA2KSB7Cj4gLQkJZm9yIChpID0gMDsgaSA8
IGRldl9wcml2LT5udW1fZmVuY2VfcmVnczsgaSsrKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+
PSA2KSB7Cj4gKwkJZm9yIChpID0gMDsgaSA8IGk5MTUtPm51bV9mZW5jZV9yZWdzOyBpKyspCj4g
ICAJCQllcnJvci0+ZmVuY2VbaV0gPQo+ICAgCQkJCWludGVsX3VuY29yZV9yZWFkNjQodW5jb3Jl
LAo+ICAgCQkJCQkJICAgIEZFTkNFX1JFR19HRU42X0xPKGkpKTsKPiAtCX0gZWxzZSBpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA+PSA0KSB7Cj4gLQkJZm9yIChpID0gMDsgaSA8IGRldl9wcml2LT5u
dW1fZmVuY2VfcmVnczsgaSsrKQo+ICsJfSBlbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNCkg
ewo+ICsJCWZvciAoaSA9IDA7IGkgPCBpOTE1LT5udW1fZmVuY2VfcmVnczsgaSsrKQo+ICAgCQkJ
ZXJyb3ItPmZlbmNlW2ldID0KPiAgIAkJCQlpbnRlbF91bmNvcmVfcmVhZDY0KHVuY29yZSwKPiAg
IAkJCQkJCSAgICBGRU5DRV9SRUdfOTY1X0xPKGkpKTsKPiAgIAl9IGVsc2Ugewo+IC0JCWZvciAo
aSA9IDA7IGkgPCBkZXZfcHJpdi0+bnVtX2ZlbmNlX3JlZ3M7IGkrKykKPiArCQlmb3IgKGkgPSAw
OyBpIDwgaTkxNS0+bnVtX2ZlbmNlX3JlZ3M7IGkrKykKPiAgIAkJCWVycm9yLT5mZW5jZVtpXSA9
Cj4gICAJCQkJaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBGRU5DRV9SRUcoaSkpOwo+ICAgCX0K
PiBAQCAtMTE0OCwyMyArMTE0OCwyMyBAQCBzdGF0aWMgdm9pZCBlcnJvcl9yZWNvcmRfZW5naW5l
X3JlZ2lzdGVycyhzdHJ1Y3QgaTkxNV9ncHVfc3RhdGUgKmVycm9yLAo+ICAgCQkJCQkgIHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKPiAgIAkJCQkJICBzdHJ1Y3QgZHJtX2k5MTVfZXJy
b3JfZW5naW5lICplZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IGVuZ2luZS0+aTkxNTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZW5n
aW5lLT5pOTE1Owo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA2KSB7Cj4gKwlp
ZiAoSU5URUxfR0VOKGk5MTUpID49IDYpIHsKPiAgIAkJZWUtPnJjX3BzbWkgPSBFTkdJTkVfUkVB
RChlbmdpbmUsIFJJTkdfUFNNSV9DVEwpOwo+IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDgpCj4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA4KQo+ICAgCQkJZWUtPmZhdWx0X3JlZyA9
IEk5MTVfUkVBRChHRU44X1JJTkdfRkFVTFRfUkVHKTsKPiAgIAkJZWxzZQo+ICAgCQkJZWUtPmZh
dWx0X3JlZyA9IEdFTjZfUklOR19GQVVMVF9SRUdfUkVBRChlbmdpbmUpOwo+ICAgCX0KPiAgIAo+
IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCkgewo+ICsJaWYgKElOVEVMX0dFTihpOTE1
KSA+PSA0KSB7Cj4gICAJCWVlLT5mYWRkciA9IEVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19ETUFf
RkFERCk7Cj4gICAJCWVlLT5pcGVpciA9IEVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19JUEVJUik7
Cj4gICAJCWVlLT5pcGVociA9IEVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19JUEVIUik7Cj4gICAJ
CWVlLT5pbnN0cHMgPSBFTkdJTkVfUkVBRChlbmdpbmUsIFJJTkdfSU5TVFBTKTsKPiAgIAkJZWUt
PmJiYWRkciA9IEVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19CQkFERFIpOwo+IC0JCWlmIChJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDgpIHsKPiArCQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDgpIHsK
PiAgIAkJCWVlLT5mYWRkciB8PSAodTY0KUVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19ETUFfRkFE
RF9VRFcpIDw8IDMyOwo+ICAgCQkJZWUtPmJiYWRkciB8PSAodTY0KUVOR0lORV9SRUFEKGVuZ2lu
ZSwgUklOR19CQkFERFJfVURXKSA8PCAzMjsKPiAgIAkJfQo+IEBAIC0xMTgzLDEzICsxMTgzLDEz
IEBAIHN0YXRpYyB2b2lkIGVycm9yX3JlY29yZF9lbmdpbmVfcmVnaXN0ZXJzKHN0cnVjdCBpOTE1
X2dwdV9zdGF0ZSAqZXJyb3IsCj4gICAJZWUtPmhlYWQgPSBFTkdJTkVfUkVBRChlbmdpbmUsIFJJ
TkdfSEVBRCk7Cj4gICAJZWUtPnRhaWwgPSBFTkdJTkVfUkVBRChlbmdpbmUsIFJJTkdfVEFJTCk7
Cj4gICAJZWUtPmN0bCA9IEVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19DVEwpOwo+IC0JaWYgKElO
VEVMX0dFTihkZXZfcHJpdikgPiAyKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+IDIpCj4gICAJ
CWVlLT5tb2RlID0gRU5HSU5FX1JFQUQoZW5naW5lLCBSSU5HX01JX01PREUpOwo+ICAgCj4gLQlp
ZiAoIUhXU19ORUVEU19QSFlTSUNBTChkZXZfcHJpdikpIHsKPiArCWlmICghSFdTX05FRURTX1BI
WVNJQ0FMKGk5MTUpKSB7Cj4gICAJCWk5MTVfcmVnX3QgbW1pbzsKPiAgIAo+IC0JCWlmIChJU19H
RU4oZGV2X3ByaXYsIDcpKSB7Cj4gKwkJaWYgKElTX0dFTihpOTE1LCA3KSkgewo+ICAgCQkJc3dp
dGNoIChlbmdpbmUtPmlkKSB7Cj4gICAJCQlkZWZhdWx0Ogo+ICAgCQkJCU1JU1NJTkdfQ0FTRShl
bmdpbmUtPmlkKTsKPiBAQCAtMTIxOSwyMSArMTIxOSwyMSBAQCBzdGF0aWMgdm9pZCBlcnJvcl9y
ZWNvcmRfZW5naW5lX3JlZ2lzdGVycyhzdHJ1Y3QgaTkxNV9ncHVfc3RhdGUgKmVycm9yLAo+ICAg
CWVlLT5pZGxlID0gaW50ZWxfZW5naW5lX2lzX2lkbGUoZW5naW5lKTsKPiAgIAlpZiAoIWVlLT5p
ZGxlKQo+ICAgCQllZS0+aGFuZ2NoZWNrX3RpbWVzdGFtcCA9IGVuZ2luZS0+aGFuZ2NoZWNrLmFj
dGlvbl90aW1lc3RhbXA7Cj4gLQllZS0+cmVzZXRfY291bnQgPSBpOTE1X3Jlc2V0X2VuZ2luZV9j
b3VudCgmZGV2X3ByaXYtPmdwdV9lcnJvciwKPiArCWVlLT5yZXNldF9jb3VudCA9IGk5MTVfcmVz
ZXRfZW5naW5lX2NvdW50KCZpOTE1LT5ncHVfZXJyb3IsCj4gICAJCQkJCQkgIGVuZ2luZSk7Cj4g
ICAKPiAtCWlmIChIQVNfUFBHVFQoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSEFTX1BQR1RUKGk5MTUp
KSB7Cj4gICAJCWludCBpOwo+ICAgCj4gICAJCWVlLT52bV9pbmZvLmdmeF9tb2RlID0gRU5HSU5F
X1JFQUQoZW5naW5lLCBSSU5HX01PREVfR0VONyk7Cj4gICAKPiAtCQlpZiAoSVNfR0VOKGRldl9w
cml2LCA2KSkgewo+ICsJCWlmIChJU19HRU4oaTkxNSwgNikpIHsKPiAgIAkJCWVlLT52bV9pbmZv
LnBwX2Rpcl9iYXNlID0KPiAgIAkJCQlFTkdJTkVfUkVBRChlbmdpbmUsIFJJTkdfUFBfRElSX0JB
U0VfUkVBRCk7Cj4gLQkJfSBlbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDcpKSB7Cj4gKwkJfSBl
bHNlIGlmIChJU19HRU4oaTkxNSwgNykpIHsKPiAgIAkJCWVlLT52bV9pbmZvLnBwX2Rpcl9iYXNl
ID0KPiAgIAkJCQlFTkdJTkVfUkVBRChlbmdpbmUsIFJJTkdfUFBfRElSX0JBU0UpOwo+IC0JCX0g
ZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA4KSB7Cj4gKwkJfSBlbHNlIGlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gOCkgewo+ICAgCQkJdTMyIGJhc2UgPSBlbmdpbmUtPm1taW9fYmFzZTsK
PiAgIAo+ICAgCQkJZm9yIChpID0gMDsgaSA8IDQ7IGkrKykgewo+IEBAIC0xMzg4LDcgKzEzODgs
NyBAQCBzdGF0aWMgdm9pZCByZXF1ZXN0X3JlY29yZF91c2VyX2JvKHN0cnVjdCBpOTE1X3JlcXVl
c3QgKnJlcXVlc3QsCj4gICB9Cj4gICAKPiAgIHN0YXRpYyBzdHJ1Y3QgZHJtX2k5MTVfZXJyb3Jf
b2JqZWN0ICoKPiAtY2FwdHVyZV9vYmplY3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ICtjYXB0dXJlX29iamVjdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAg
IAkgICAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKPiAgIHsKPiAgIAlpZiAo
b2JqICYmIGk5MTVfZ2VtX29iamVjdF9oYXNfcGFnZXMob2JqKSkgewo+IEBAIC0xMzk5LDcgKzEz
OTksNyBAQCBjYXB0dXJlX29iamVjdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gICAJCQkub2JqID0gb2JqLAo+ICAgCQl9Owo+ICAgCj4gLQkJcmV0dXJuIGk5MTVfZXJyb3Jf
b2JqZWN0X2NyZWF0ZShkZXZfcHJpdiwgJmZha2UpOwo+ICsJCXJldHVybiBpOTE1X2Vycm9yX29i
amVjdF9jcmVhdGUoaTkxNSwgJmZha2UpOwo+ICAgCX0gZWxzZSB7Cj4gICAJCXJldHVybiBOVUxM
Owo+ICAgCX0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJy
b3IuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmgKPiBpbmRleCAyZWNk
MGM2YTFjOTQuLjk4MGY5NWZiNTU3OCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2dwdV9lcnJvci5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVf
ZXJyb3IuaAo+IEBAIC0yMzQsNyArMjM0LDcgQEAgc3RydWN0IGk5MTVfZ3B1X2Vycm9yIHsKPiAg
IAo+ICAgCS8qKgo+ICAgCSAqIFdhaXRxdWV1ZSB0byBzaWduYWwgd2hlbiB0aGUgcmVzZXQgaGFz
IGNvbXBsZXRlZC4gVXNlZCBieSBjbGllbnRzCj4gLQkgKiB0aGF0IHdhaXQgZm9yIGRldl9wcml2
LT5tbS53ZWRnZWQgdG8gc2V0dGxlLgo+ICsJICogdGhhdCB3YWl0IGZvciBpOTE1LT5tbS53ZWRn
ZWQgdG8gc2V0dGxlLgo+ICAgCSAqLwo+ICAgCXdhaXRfcXVldWVfaGVhZF90IHJlc2V0X3F1ZXVl
Owo+ICAgCj4gQEAgLTI1OSw3ICsyNTksNyBAQCBfX3ByaW50ZigyLCAzKQo+ICAgdm9pZCBpOTE1
X2Vycm9yX3ByaW50ZihzdHJ1Y3QgZHJtX2k5MTVfZXJyb3Jfc3RhdGVfYnVmICplLCBjb25zdCBj
aGFyICpmLCAuLi4pOwo+ICAgCj4gICBzdHJ1Y3QgaTkxNV9ncHVfc3RhdGUgKmk5MTVfY2FwdHVy
ZV9ncHVfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+IC12b2lkIGk5MTVf
Y2FwdHVyZV9lcnJvcl9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
K3ZvaWQgaTkxNV9jYXB0dXJlX2Vycm9yX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ICAgCQkJICAgICAgaW50ZWxfZW5naW5lX21hc2tfdCBlbmdpbmVfbWFzaywKPiAgIAkJ
CSAgICAgIGNvbnN0IGNoYXIgKmVycm9yX21zZyk7Cj4gICAKPiBAQCAtMjg2LDcgKzI4Niw3IEBA
IHZvaWQgaTkxNV9kaXNhYmxlX2Vycm9yX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LCBpbnQgZXJyKTsKPiAgIAo+ICAgI2Vsc2UKPiAgIAo+IC1zdGF0aWMgaW5saW5lIHZvaWQg
aTkxNV9jYXB0dXJlX2Vycm9yX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiArc3RhdGljIGlubGluZSB2b2lkIGk5MTVfY2FwdHVyZV9lcnJvcl9zdGF0ZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkJICAgIHUzMiBlbmdpbmVfbWFzaywKPiAg
IAkJCQkJICAgIGNvbnN0IGNoYXIgKmVycm9yX21zZykKPiAgIHsKPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9pcnEuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
aXJxLmMKPiBpbmRleCBjZDllZGRkZDY3MTguLjgxZWE2NWQ4NWI5ZiAxMDA2NDQKPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2lycS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9pcnEuYwo+IEBAIC0yNTYsMTggKzI1NiwxOCBAQCBzdGF0aWMgdm9pZCBnZW4yX2ly
cV9pbml0KHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSwKPiAgICNkZWZpbmUgR0VOMl9JUlFf
SU5JVCh1bmNvcmUsIGltcl92YWwsIGllcl92YWwpIFwKPiAgIAlnZW4yX2lycV9pbml0KCh1bmNv
cmUpLCBpbXJfdmFsLCBpZXJfdmFsKQo+ICAgCj4gLXN0YXRpYyB2b2lkIGdlbjZfcnBzX2lycV9o
YW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIHBtX2lpcik7Cj4g
LXN0YXRpYyB2b2lkIGdlbjlfZ3VjX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwgdTMyIHBtX2lpcik7Cj4gK3N0YXRpYyB2b2lkIGdlbjZfcnBzX2lycV9oYW5k
bGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgcG1faWlyKTsKPiArc3RhdGlj
IHZvaWQgZ2VuOV9ndWNfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
IHUzMiBwbV9paXIpOwo+ICAgCj4gICAvKiBGb3IgZGlzcGxheSBob3RwbHVnIGludGVycnVwdCAq
Lwo+ICAgc3RhdGljIGlubGluZSB2b2lkCj4gLWk5MTVfaG90cGx1Z19pbnRlcnJ1cHRfdXBkYXRl
X2xvY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2k5MTVfaG90cGx1
Z19pbnRlcnJ1cHRfdXBkYXRlX2xvY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
PiAgIAkJCQkgICAgIHUzMiBtYXNrLAo+ICAgCQkJCSAgICAgdTMyIGJpdHMpCj4gICB7Cj4gICAJ
dTMyIHZhbDsKPiAgIAo+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPmlycV9sb2Nr
KTsKPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmlycV9sb2NrKTsKPiAgIAlXQVJOX09O
KGJpdHMgJiB+bWFzayk7Cj4gICAKPiAgIAl2YWwgPSBJOTE1X1JFQUQoUE9SVF9IT1RQTFVHX0VO
KTsKPiBAQCAtMjc4LDcgKzI3OCw3IEBAIGk5MTVfaG90cGx1Z19pbnRlcnJ1cHRfdXBkYXRlX2xv
Y2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAKPiAgIC8qKgo+ICAg
ICogaTkxNV9ob3RwbHVnX2ludGVycnVwdF91cGRhdGUgLSB1cGRhdGUgaG90cGx1ZyBpbnRlcnJ1
cHQgZW5hYmxlCj4gLSAqIEBkZXZfcHJpdjogZHJpdmVyIHByaXZhdGUKPiArICogQGk5MTU6IGRy
aXZlciBwcml2YXRlCj4gICAgKiBAbWFzazogYml0cyB0byB1cGRhdGUKPiAgICAqIEBiaXRzOiBi
aXRzIHRvIGVuYWJsZQo+ICAgICogTk9URTogdGhlIEhQRCBlbmFibGUgYml0cyBhcmUgbW9kaWZp
ZWQgYm90aCBpbnNpZGUgYW5kIG91dHNpZGUKPiBAQCAtMjg4LDEzICsyODgsMTMgQEAgaTkxNV9o
b3RwbHVnX2ludGVycnVwdF91cGRhdGVfbG9ja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiAgICAqIGhlbGQgYWxyZWFkeSwgdGhpcyBmdW5jdGlvbiBhY3F1aXJlcyB0aGUg
bG9jayBpdHNlbGYuIEEgbm9uLWxvY2tpbmcKPiAgICAqIHZlcnNpb24gaXMgYWxzbyBhdmFpbGFi
bGUuCj4gICAgKi8KPiAtdm9pZCBpOTE1X2hvdHBsdWdfaW50ZXJydXB0X3VwZGF0ZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3ZvaWQgaTkxNV9ob3RwbHVnX2ludGVycnVw
dF91cGRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgdTMyIG1h
c2ssCj4gICAJCQkJICAgdTMyIGJpdHMpCj4gICB7Cj4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJp
di0+aXJxX2xvY2spOwo+IC0JaTkxNV9ob3RwbHVnX2ludGVycnVwdF91cGRhdGVfbG9ja2VkKGRl
dl9wcml2LCBtYXNrLCBiaXRzKTsKPiAtCXNwaW5fdW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9s
b2NrKTsKPiArCXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiArCWk5MTVfaG90cGx1
Z19pbnRlcnJ1cHRfdXBkYXRlX2xvY2tlZChpOTE1LCBtYXNrLCBiaXRzKTsKPiArCXNwaW5fdW5s
b2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdTMyCj4gQEAg
LTMzNCw4NCArMzM0LDg0IEBAIHN0YXRpYyBib29sIGdlbjExX3Jlc2V0X29uZV9paXIoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKiBjb25zdCBpOTE1LAo+ICAgCj4gICAvKioKPiAgICAqIGlsa191
cGRhdGVfZGlzcGxheV9pcnEgLSB1cGRhdGUgREVJTVIKPiAtICogQGRldl9wcml2OiBkcml2ZXIg
cHJpdmF0ZQo+ICsgKiBAaTkxNTogZHJpdmVyIHByaXZhdGUKPiAgICAqIEBpbnRlcnJ1cHRfbWFz
azogbWFzayBvZiBpbnRlcnJ1cHQgYml0cyB0byB1cGRhdGUKPiAgICAqIEBlbmFibGVkX2lycV9t
YXNrOiBtYXNrIG9mIGludGVycnVwdCBiaXRzIHRvIGVuYWJsZQo+ICAgICovCj4gLXZvaWQgaWxr
X3VwZGF0ZV9kaXNwbGF5X2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
K3ZvaWQgaWxrX3VwZGF0ZV9kaXNwbGF5X2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiAgIAkJCSAgICB1MzIgaW50ZXJydXB0X21hc2ssCj4gICAJCQkgICAgdTMyIGVuYWJsZWRf
aXJxX21hc2spCj4gICB7Cj4gICAJdTMyIG5ld192YWw7Cj4gICAKPiAtCWxvY2tkZXBfYXNzZXJ0
X2hlbGQoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1
LT5pcnFfbG9jayk7Cj4gICAKPiAgIAlXQVJOX09OKGVuYWJsZWRfaXJxX21hc2sgJiB+aW50ZXJy
dXB0X21hc2spOwo+ICAgCj4gLQlpZiAoV0FSTl9PTighaW50ZWxfaXJxc19lbmFibGVkKGRldl9w
cml2KSkpCj4gKwlpZiAoV0FSTl9PTighaW50ZWxfaXJxc19lbmFibGVkKGk5MTUpKSkKPiAgIAkJ
cmV0dXJuOwo+ICAgCj4gLQluZXdfdmFsID0gZGV2X3ByaXYtPmlycV9tYXNrOwo+ICsJbmV3X3Zh
bCA9IGk5MTUtPmlycV9tYXNrOwo+ICAgCW5ld192YWwgJj0gfmludGVycnVwdF9tYXNrOwo+ICAg
CW5ld192YWwgfD0gKH5lbmFibGVkX2lycV9tYXNrICYgaW50ZXJydXB0X21hc2spOwo+ICAgCj4g
LQlpZiAobmV3X3ZhbCAhPSBkZXZfcHJpdi0+aXJxX21hc2spIHsKPiAtCQlkZXZfcHJpdi0+aXJx
X21hc2sgPSBuZXdfdmFsOwo+IC0JCUk5MTVfV1JJVEUoREVJTVIsIGRldl9wcml2LT5pcnFfbWFz
ayk7Cj4gKwlpZiAobmV3X3ZhbCAhPSBpOTE1LT5pcnFfbWFzaykgewo+ICsJCWk5MTUtPmlycV9t
YXNrID0gbmV3X3ZhbDsKPiArCQlJOTE1X1dSSVRFKERFSU1SLCBpOTE1LT5pcnFfbWFzayk7Cj4g
ICAJCVBPU1RJTkdfUkVBRChERUlNUik7Cj4gICAJfQo+ICAgfQo+ICAgCj4gICAvKioKPiAgICAq
IGlsa191cGRhdGVfZ3RfaXJxIC0gdXBkYXRlIEdUSU1SCj4gLSAqIEBkZXZfcHJpdjogZHJpdmVy
IHByaXZhdGUKPiArICogQGk5MTU6IGRyaXZlciBwcml2YXRlCj4gICAgKiBAaW50ZXJydXB0X21h
c2s6IG1hc2sgb2YgaW50ZXJydXB0IGJpdHMgdG8gdXBkYXRlCj4gICAgKiBAZW5hYmxlZF9pcnFf
bWFzazogbWFzayBvZiBpbnRlcnJ1cHQgYml0cyB0byBlbmFibGUKPiAgICAqLwo+IC1zdGF0aWMg
dm9pZCBpbGtfdXBkYXRlX2d0X2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gK3N0YXRpYyB2b2lkIGlsa191cGRhdGVfZ3RfaXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAo+ICAgCQkJICAgICAgdTMyIGludGVycnVwdF9tYXNrLAo+ICAgCQkJICAgICAgdTMy
IGVuYWJsZWRfaXJxX21hc2spCj4gICB7Cj4gLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJp
di0+aXJxX2xvY2spOwo+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+aXJxX2xvY2spOwo+
ICAgCj4gICAJV0FSTl9PTihlbmFibGVkX2lycV9tYXNrICYgfmludGVycnVwdF9tYXNrKTsKPiAg
IAo+IC0JaWYgKFdBUk5fT04oIWludGVsX2lycXNfZW5hYmxlZChkZXZfcHJpdikpKQo+ICsJaWYg
KFdBUk5fT04oIWludGVsX2lycXNfZW5hYmxlZChpOTE1KSkpCj4gICAJCXJldHVybjsKPiAgIAo+
IC0JZGV2X3ByaXYtPmd0X2lycV9tYXNrICY9IH5pbnRlcnJ1cHRfbWFzazsKPiAtCWRldl9wcml2
LT5ndF9pcnFfbWFzayB8PSAofmVuYWJsZWRfaXJxX21hc2sgJiBpbnRlcnJ1cHRfbWFzayk7Cj4g
LQlJOTE1X1dSSVRFKEdUSU1SLCBkZXZfcHJpdi0+Z3RfaXJxX21hc2spOwo+ICsJaTkxNS0+Z3Rf
aXJxX21hc2sgJj0gfmludGVycnVwdF9tYXNrOwo+ICsJaTkxNS0+Z3RfaXJxX21hc2sgfD0gKH5l
bmFibGVkX2lycV9tYXNrICYgaW50ZXJydXB0X21hc2spOwo+ICsJSTkxNV9XUklURShHVElNUiwg
aTkxNS0+Z3RfaXJxX21hc2spOwo+ICAgfQo+ICAgCj4gLXZvaWQgZ2VuNV9lbmFibGVfZ3RfaXJx
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIG1hc2spCj4gK3ZvaWQgZ2Vu
NV9lbmFibGVfZ3RfaXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgbWFzaykK
PiAgIHsKPiAtCWlsa191cGRhdGVfZ3RfaXJxKGRldl9wcml2LCBtYXNrLCBtYXNrKTsKPiAtCWlu
dGVsX3VuY29yZV9wb3N0aW5nX3JlYWRfZncoJmRldl9wcml2LT51bmNvcmUsIEdUSU1SKTsKPiAr
CWlsa191cGRhdGVfZ3RfaXJxKGk5MTUsIG1hc2ssIG1hc2spOwo+ICsJaW50ZWxfdW5jb3JlX3Bv
c3RpbmdfcmVhZF9mdygmaTkxNS0+dW5jb3JlLCBHVElNUik7Cj4gICB9Cj4gICAKPiAtdm9pZCBn
ZW41X2Rpc2FibGVfZ3RfaXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMy
IG1hc2spCj4gK3ZvaWQgZ2VuNV9kaXNhYmxlX2d0X2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwgdTMyIG1hc2spCj4gICB7Cj4gLQlpbGtfdXBkYXRlX2d0X2lycShkZXZfcHJpdiwg
bWFzaywgMCk7Cj4gKwlpbGtfdXBkYXRlX2d0X2lycShpOTE1LCBtYXNrLCAwKTsKPiAgIH0KPiAg
IAo+IC1zdGF0aWMgaTkxNV9yZWdfdCBnZW42X3BtX2lpcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyBpOTE1X3JlZ190IGdlbjZfcG1faWlyKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JV0FSTl9PTl9PTkNFKElOVEVMX0dFTihkZXZf
cHJpdikgPj0gMTEpOwo+ICsJV0FSTl9PTl9PTkNFKElOVEVMX0dFTihpOTE1KSA+PSAxMSk7Cj4g
ICAKPiAtCXJldHVybiBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDggPyBHRU44X0dUX0lJUigyKSA6
IEdFTjZfUE1JSVI7Cj4gKwlyZXR1cm4gSU5URUxfR0VOKGk5MTUpID49IDggPyBHRU44X0dUX0lJ
UigyKSA6IEdFTjZfUE1JSVI7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgd3JpdGVfcG1faW1y
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgd3JpdGVf
cG1faW1yKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCWk5MTVfcmVn
X3QgcmVnOwo+IC0JdTMyIG1hc2sgPSBkZXZfcHJpdi0+cG1faW1yOwo+ICsJdTMyIG1hc2sgPSBp
OTE1LT5wbV9pbXI7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKSB7Cj4g
KwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKSB7Cj4gICAJCXJlZyA9IEdFTjExX0dQTV9XR0JP
WFBFUkZfSU5UUl9NQVNLOwo+ICAgCQkvKiBwbSBpcyBpbiB1cHBlciBoYWxmICovCj4gICAJCW1h
c2sgPSBtYXNrIDw8IDE2Owo+IC0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDgp
IHsKPiArCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDgpIHsKPiAgIAkJcmVnID0gR0VO
OF9HVF9JTVIoMik7Cj4gICAJfSBlbHNlIHsKPiAgIAkJcmVnID0gR0VONl9QTUlNUjsKPiBAQCAt
NDIxLDE2ICs0MjEsMTYgQEAgc3RhdGljIHZvaWQgd3JpdGVfcG1faW1yKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAlQT1NUSU5HX1JFQUQocmVnKTsKPiAgIH0KPiAgIAo+
IC1zdGF0aWMgdm9pZCB3cml0ZV9wbV9pZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICtzdGF0aWMgdm9pZCB3cml0ZV9wbV9pZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCj4gICB7Cj4gICAJaTkxNV9yZWdfdCByZWc7Cj4gLQl1MzIgbWFzayA9IGRldl9wcml2
LT5wbV9pZXI7Cj4gKwl1MzIgbWFzayA9IGk5MTUtPnBtX2llcjsKPiAgIAo+IC0JaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPj0gMTEpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpIHsK
PiAgIAkJcmVnID0gR0VOMTFfR1BNX1dHQk9YUEVSRl9JTlRSX0VOQUJMRTsKPiAgIAkJLyogcG0g
aXMgaW4gdXBwZXIgaGFsZiAqLwo+ICAgCQltYXNrID0gbWFzayA8PCAxNjsKPiAtCX0gZWxzZSBp
ZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA4KSB7Cj4gKwl9IGVsc2UgaWYgKElOVEVMX0dFTihp
OTE1KSA+PSA4KSB7Cj4gICAJCXJlZyA9IEdFTjhfR1RfSUVSKDIpOwo+ICAgCX0gZWxzZSB7Cj4g
ICAJCXJlZyA9IEdFTjZfUE1JRVI7Cj4gQEAgLTQ0MSwxMSArNDQxLDExIEBAIHN0YXRpYyB2b2lk
IHdyaXRlX3BtX2llcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAKPiAg
IC8qKgo+ICAgICogc25iX3VwZGF0ZV9wbV9pcnEgLSB1cGRhdGUgR0VONl9QTUlNUgo+IC0gKiBA
ZGV2X3ByaXY6IGRyaXZlciBwcml2YXRlCj4gKyAqIEBpOTE1OiBkcml2ZXIgcHJpdmF0ZQo+ICAg
ICogQGludGVycnVwdF9tYXNrOiBtYXNrIG9mIGludGVycnVwdCBiaXRzIHRvIHVwZGF0ZQo+ICAg
ICogQGVuYWJsZWRfaXJxX21hc2s6IG1hc2sgb2YgaW50ZXJydXB0IGJpdHMgdG8gZW5hYmxlCj4g
ICAgKi8KPiAtc3RhdGljIHZvaWQgc25iX3VwZGF0ZV9wbV9pcnEoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBzbmJfdXBkYXRlX3BtX2lycShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgIHUzMiBpbnRlcnJ1cHRfbWFzaywK
PiAgIAkJCSAgICAgIHUzMiBlbmFibGVkX2lycV9tYXNrKQo+ICAgewo+IEBAIC00NTMsMTI3ICs0
NTMsMTI3IEBAIHN0YXRpYyB2b2lkIHNuYl91cGRhdGVfcG1faXJxKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiAgIAo+ICAgCVdBUk5fT04oZW5hYmxlZF9pcnFfbWFzayAmIH5p
bnRlcnJ1cHRfbWFzayk7Cj4gICAKPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5p
cnFfbG9jayk7Cj4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5pcnFfbG9jayk7Cj4gICAK
PiAtCW5ld192YWwgPSBkZXZfcHJpdi0+cG1faW1yOwo+ICsJbmV3X3ZhbCA9IGk5MTUtPnBtX2lt
cjsKPiAgIAluZXdfdmFsICY9IH5pbnRlcnJ1cHRfbWFzazsKPiAgIAluZXdfdmFsIHw9ICh+ZW5h
YmxlZF9pcnFfbWFzayAmIGludGVycnVwdF9tYXNrKTsKPiAgIAo+IC0JaWYgKG5ld192YWwgIT0g
ZGV2X3ByaXYtPnBtX2ltcikgewo+IC0JCWRldl9wcml2LT5wbV9pbXIgPSBuZXdfdmFsOwo+IC0J
CXdyaXRlX3BtX2ltcihkZXZfcHJpdik7Cj4gKwlpZiAobmV3X3ZhbCAhPSBpOTE1LT5wbV9pbXIp
IHsKPiArCQlpOTE1LT5wbV9pbXIgPSBuZXdfdmFsOwo+ICsJCXdyaXRlX3BtX2ltcihpOTE1KTsK
PiAgIAl9Cj4gICB9Cj4gICAKPiAtdm9pZCBnZW42X3VubWFza19wbV9pcnEoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgbWFzaykKPiArdm9pZCBnZW42X3VubWFza19wbV9p
cnEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBtYXNrKQo+ICAgewo+IC0JaWYg
KFdBUk5fT04oIWludGVsX2lycXNfZW5hYmxlZChkZXZfcHJpdikpKQo+ICsJaWYgKFdBUk5fT04o
IWludGVsX2lycXNfZW5hYmxlZChpOTE1KSkpCj4gICAJCXJldHVybjsKPiAgIAo+IC0Jc25iX3Vw
ZGF0ZV9wbV9pcnEoZGV2X3ByaXYsIG1hc2ssIG1hc2spOwo+ICsJc25iX3VwZGF0ZV9wbV9pcnEo
aTkxNSwgbWFzaywgbWFzayk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgX19nZW42X21hc2tf
cG1faXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIG1hc2spCj4gK3N0
YXRpYyB2b2lkIF9fZ2VuNl9tYXNrX3BtX2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwgdTMyIG1hc2spCj4gICB7Cj4gLQlzbmJfdXBkYXRlX3BtX2lycShkZXZfcHJpdiwgbWFzaywg
MCk7Cj4gKwlzbmJfdXBkYXRlX3BtX2lycShpOTE1LCBtYXNrLCAwKTsKPiAgIH0KPiAgIAo+IC12
b2lkIGdlbjZfbWFza19wbV9pcnEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1
MzIgbWFzaykKPiArdm9pZCBnZW42X21hc2tfcG1faXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LCB1MzIgbWFzaykKPiAgIHsKPiAtCWlmIChXQVJOX09OKCFpbnRlbF9pcnFzX2VuYWJs
ZWQoZGV2X3ByaXYpKSkKPiArCWlmIChXQVJOX09OKCFpbnRlbF9pcnFzX2VuYWJsZWQoaTkxNSkp
KQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCV9fZ2VuNl9tYXNrX3BtX2lycShkZXZfcHJpdiwgbWFz
ayk7Cj4gKwlfX2dlbjZfbWFza19wbV9pcnEoaTkxNSwgbWFzayk7Cj4gICB9Cj4gICAKPiAtc3Rh
dGljIHZvaWQgZ2VuNl9yZXNldF9wbV9paXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LCB1MzIgcmVzZXRfbWFzaykKPiArc3RhdGljIHZvaWQgZ2VuNl9yZXNldF9wbV9paXIoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiByZXNldF9tYXNrKQo+ICAgewo+IC0JaTkx
NV9yZWdfdCByZWcgPSBnZW42X3BtX2lpcihkZXZfcHJpdik7Cj4gKwlpOTE1X3JlZ190IHJlZyA9
IGdlbjZfcG1faWlyKGk5MTUpOwo+ICAgCj4gLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJp
di0+aXJxX2xvY2spOwo+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+aXJxX2xvY2spOwo+
ICAgCj4gICAJSTkxNV9XUklURShyZWcsIHJlc2V0X21hc2spOwo+ICAgCUk5MTVfV1JJVEUocmVn
LCByZXNldF9tYXNrKTsKPiAgIAlQT1NUSU5HX1JFQUQocmVnKTsKPiAgIH0KPiAgIAo+IC1zdGF0
aWMgdm9pZCBnZW42X2VuYWJsZV9wbV9pcnEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LCB1MzIgZW5hYmxlX21hc2spCj4gK3N0YXRpYyB2b2lkIGdlbjZfZW5hYmxlX3BtX2lycShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIGVuYWJsZV9tYXNrKQo+ICAgewo+IC0J
bG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiArCWxvY2tkZXBfYXNz
ZXJ0X2hlbGQoJmk5MTUtPmlycV9sb2NrKTsKPiAgIAo+IC0JZGV2X3ByaXYtPnBtX2llciB8PSBl
bmFibGVfbWFzazsKPiAtCXdyaXRlX3BtX2llcihkZXZfcHJpdik7Cj4gLQlnZW42X3VubWFza19w
bV9pcnEoZGV2X3ByaXYsIGVuYWJsZV9tYXNrKTsKPiArCWk5MTUtPnBtX2llciB8PSBlbmFibGVf
bWFzazsKPiArCXdyaXRlX3BtX2llcihpOTE1KTsKPiArCWdlbjZfdW5tYXNrX3BtX2lycShpOTE1
LCBlbmFibGVfbWFzayk7Cj4gICAJLyogdW5tYXNrX3BtX2lycSBwcm92aWRlcyBhbiBpbXBsaWNp
dCBiYXJyaWVyIChQT1NUSU5HX1JFQUQpICovCj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgZ2Vu
Nl9kaXNhYmxlX3BtX2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBk
aXNhYmxlX21hc2spCj4gK3N0YXRpYyB2b2lkIGdlbjZfZGlzYWJsZV9wbV9pcnEoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBkaXNhYmxlX21hc2spCj4gICB7Cj4gLQlsb2NrZGVw
X2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ICsJbG9ja2RlcF9hc3NlcnRfaGVs
ZCgmaTkxNS0+aXJxX2xvY2spOwo+ICAgCj4gLQlkZXZfcHJpdi0+cG1faWVyICY9IH5kaXNhYmxl
X21hc2s7Cj4gLQlfX2dlbjZfbWFza19wbV9pcnEoZGV2X3ByaXYsIGRpc2FibGVfbWFzayk7Cj4g
LQl3cml0ZV9wbV9pZXIoZGV2X3ByaXYpOwo+ICsJaTkxNS0+cG1faWVyICY9IH5kaXNhYmxlX21h
c2s7Cj4gKwlfX2dlbjZfbWFza19wbV9pcnEoaTkxNSwgZGlzYWJsZV9tYXNrKTsKPiArCXdyaXRl
X3BtX2llcihpOTE1KTsKPiAgIAkvKiB0aG91Z2ggYSBiYXJyaWVyIGlzIG1pc3NpbmcgaGVyZSwg
YnV0IGRvbid0IHJlYWxseSBuZWVkIGEgb25lICovCj4gICB9Cj4gICAKPiAtdm9pZCBnZW4xMV9y
ZXNldF9ycHNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
K3ZvaWQgZ2VuMTFfcmVzZXRfcnBzX2ludGVycnVwdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCj4gICB7Cj4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ICsJ
c3Bpbl9sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ICAgCj4gLQl3aGlsZSAoZ2VuMTFfcmVz
ZXRfb25lX2lpcihkZXZfcHJpdiwgMCwgR0VOMTFfR1RQTSkpCj4gKwl3aGlsZSAoZ2VuMTFfcmVz
ZXRfb25lX2lpcihpOTE1LCAwLCBHRU4xMV9HVFBNKSkKPiAgIAkJOwo+ICAgCj4gLQlkZXZfcHJp
di0+Z3RfcG0ucnBzLnBtX2lpciA9IDA7Cj4gKwlpOTE1LT5ndF9wbS5ycHMucG1faWlyID0gMDsK
PiAgIAo+IC0Jc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ICsJc3Bpbl91
bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gICB9Cj4gICAKPiAtdm9pZCBnZW42X3Jlc2V0
X3Jwc19pbnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9p
ZCBnZW42X3Jlc2V0X3Jwc19pbnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ICAgewo+IC0Jc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiAtCWdlbjZf
cmVzZXRfcG1faWlyKGRldl9wcml2LCBHRU42X1BNX1JQU19FVkVOVFMpOwo+IC0JZGV2X3ByaXYt
Pmd0X3BtLnJwcy5wbV9paXIgPSAwOwo+IC0Jc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJx
X2xvY2spOwo+ICsJc3Bpbl9sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ICsJZ2VuNl9yZXNl
dF9wbV9paXIoaTkxNSwgR0VONl9QTV9SUFNfRVZFTlRTKTsKPiArCWk5MTUtPmd0X3BtLnJwcy5w
bV9paXIgPSAwOwo+ICsJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gICB9Cj4g
ICAKPiAtdm9pZCBnZW42X2VuYWJsZV9ycHNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgZ2VuNl9lbmFibGVfcnBzX2ludGVycnVwdHMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMg
PSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKPiArCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1
LT5ndF9wbS5ycHM7Cj4gICAKPiAgIAlpZiAoUkVBRF9PTkNFKHJwcy0+aW50ZXJydXB0c19lbmFi
bGVkKSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJx
X2xvY2spOwo+ICsJc3Bpbl9sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ICAgCVdBUk5fT05f
T05DRShycHMtPnBtX2lpcik7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEx
KQo+IC0JCVdBUk5fT05fT05DRShnZW4xMV9yZXNldF9vbmVfaWlyKGRldl9wcml2LCAwLCBHRU4x
MV9HVFBNKSk7Cj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKQo+ICsJCVdBUk5fT05fT05D
RShnZW4xMV9yZXNldF9vbmVfaWlyKGk5MTUsIDAsIEdFTjExX0dUUE0pKTsKPiAgIAllbHNlCj4g
LQkJV0FSTl9PTl9PTkNFKEk5MTVfUkVBRChnZW42X3BtX2lpcihkZXZfcHJpdikpICYgZGV2X3By
aXYtPnBtX3Jwc19ldmVudHMpOwo+ICsJCVdBUk5fT05fT05DRShJOTE1X1JFQUQoZ2VuNl9wbV9p
aXIoaTkxNSkpICYgaTkxNS0+cG1fcnBzX2V2ZW50cyk7Cj4gICAKPiAgIAlycHMtPmludGVycnVw
dHNfZW5hYmxlZCA9IHRydWU7Cj4gLQlnZW42X2VuYWJsZV9wbV9pcnEoZGV2X3ByaXYsIGRldl9w
cml2LT5wbV9ycHNfZXZlbnRzKTsKPiArCWdlbjZfZW5hYmxlX3BtX2lycShpOTE1LCBpOTE1LT5w
bV9ycHNfZXZlbnRzKTsKPiAgIAo+IC0Jc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xv
Y2spOwo+ICsJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gICB9Cj4gICAKPiAt
dm9pZCBnZW42X2Rpc2FibGVfcnBzX2ludGVycnVwdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICt2b2lkIGdlbjZfZGlzYWJsZV9ycHNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZk
ZXZfcHJpdi0+Z3RfcG0ucnBzOwo+ICsJc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmk5MTUtPmd0
X3BtLnJwczsKPiAgIAo+ICAgCWlmICghUkVBRF9PTkNFKHJwcy0+aW50ZXJydXB0c19lbmFibGVk
KSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xv
Y2spOwo+ICsJc3Bpbl9sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ICAgCXJwcy0+aW50ZXJy
dXB0c19lbmFibGVkID0gZmFsc2U7Cj4gICAKPiAtCUk5MTVfV1JJVEUoR0VONl9QTUlOVFJNU0ss
IGdlbjZfc2FuaXRpemVfcnBzX3BtX21hc2soZGV2X3ByaXYsIH4wdSkpOwo+ICsJSTkxNV9XUklU
RShHRU42X1BNSU5UUk1TSywgZ2VuNl9zYW5pdGl6ZV9ycHNfcG1fbWFzayhpOTE1LCB+MHUpKTsK
PiAgIAo+IC0JZ2VuNl9kaXNhYmxlX3BtX2lycShkZXZfcHJpdiwgR0VONl9QTV9SUFNfRVZFTlRT
KTsKPiArCWdlbjZfZGlzYWJsZV9wbV9pcnEoaTkxNSwgR0VONl9QTV9SUFNfRVZFTlRTKTsKPiAg
IAo+IC0Jc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+IC0Jc3luY2hyb25p
emVfaXJxKGRldl9wcml2LT5kcm0uaXJxKTsKPiArCXNwaW5fdW5sb2NrX2lycSgmaTkxNS0+aXJx
X2xvY2spOwo+ICsJc3luY2hyb25pemVfaXJxKGk5MTUtPmRybS5pcnEpOwo+ICAgCj4gICAJLyog
Tm93IHRoYXQgd2Ugd2lsbCBub3QgYmUgZ2VuZXJhdGluZyBhbnkgbW9yZSB3b3JrLCBmbHVzaCBh
bnkKPiAgIAkgKiBvdXRzdGFuZGluZyB0YXNrcy4gQXMgd2UgYXJlIGNhbGxlZCBvbiB0aGUgUlBT
IGlkbGUgcGF0aCwKPiBAQCAtNTgxLDQ4ICs1ODEsNDggQEAgdm9pZCBnZW42X2Rpc2FibGVfcnBz
X2ludGVycnVwdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCSAqIHN0
YXRlIG9mIHRoZSB3b3JrZXIgY2FuIGJlIGRpc2NhcmRlZC4KPiAgIAkgKi8KPiAgIAljYW5jZWxf
d29ya19zeW5jKCZycHMtPndvcmspOwo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEp
Cj4gLQkJZ2VuMTFfcmVzZXRfcnBzX2ludGVycnVwdHMoZGV2X3ByaXYpOwo+ICsJaWYgKElOVEVM
X0dFTihpOTE1KSA+PSAxMSkKPiArCQlnZW4xMV9yZXNldF9ycHNfaW50ZXJydXB0cyhpOTE1KTsK
PiAgIAllbHNlCj4gLQkJZ2VuNl9yZXNldF9ycHNfaW50ZXJydXB0cyhkZXZfcHJpdik7Cj4gKwkJ
Z2VuNl9yZXNldF9ycHNfaW50ZXJydXB0cyhpOTE1KTsKPiAgIH0KPiAgIAo+IC12b2lkIGdlbjlf
cmVzZXRfZ3VjX2ludGVycnVwdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ICt2b2lkIGdlbjlfcmVzZXRfZ3VjX2ludGVycnVwdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCj4gICB7Cj4gLQlhc3NlcnRfcnBtX3dha2Vsb2NrX2hlbGQoZGV2X3ByaXYpOwo+ICsJ
YXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKGk5MTUpOwo+ICAgCj4gLQlzcGluX2xvY2tfaXJxKCZk
ZXZfcHJpdi0+aXJxX2xvY2spOwo+IC0JZ2VuNl9yZXNldF9wbV9paXIoZGV2X3ByaXYsIGRldl9w
cml2LT5wbV9ndWNfZXZlbnRzKTsKPiAtCXNwaW5fdW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9s
b2NrKTsKPiArCXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiArCWdlbjZfcmVzZXRf
cG1faWlyKGk5MTUsIGk5MTUtPnBtX2d1Y19ldmVudHMpOwo+ICsJc3Bpbl91bmxvY2tfaXJxKCZp
OTE1LT5pcnFfbG9jayk7Cj4gICB9Cj4gICAKPiAtdm9pZCBnZW45X2VuYWJsZV9ndWNfaW50ZXJy
dXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgZ2VuOV9lbmFi
bGVfZ3VjX2ludGVycnVwdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4g
LQlhc3NlcnRfcnBtX3dha2Vsb2NrX2hlbGQoZGV2X3ByaXYpOwo+ICsJYXNzZXJ0X3JwbV93YWtl
bG9ja19oZWxkKGk5MTUpOwo+ICAgCj4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xv
Y2spOwo+IC0JaWYgKCFkZXZfcHJpdi0+Z3VjLmludGVycnVwdHMuZW5hYmxlZCkgewo+IC0JCVdB
Uk5fT05fT05DRShJOTE1X1JFQUQoZ2VuNl9wbV9paXIoZGV2X3ByaXYpKSAmCj4gLQkJCQkgICAg
ICAgZGV2X3ByaXYtPnBtX2d1Y19ldmVudHMpOwo+IC0JCWRldl9wcml2LT5ndWMuaW50ZXJydXB0
cy5lbmFibGVkID0gdHJ1ZTsKPiAtCQlnZW42X2VuYWJsZV9wbV9pcnEoZGV2X3ByaXYsIGRldl9w
cml2LT5wbV9ndWNfZXZlbnRzKTsKPiArCXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsK
PiArCWlmICghaTkxNS0+Z3VjLmludGVycnVwdHMuZW5hYmxlZCkgewo+ICsJCVdBUk5fT05fT05D
RShJOTE1X1JFQUQoZ2VuNl9wbV9paXIoaTkxNSkpICYKPiArCQkJCSAgICAgICBpOTE1LT5wbV9n
dWNfZXZlbnRzKTsKPiArCQlpOTE1LT5ndWMuaW50ZXJydXB0cy5lbmFibGVkID0gdHJ1ZTsKPiAr
CQlnZW42X2VuYWJsZV9wbV9pcnEoaTkxNSwgaTkxNS0+cG1fZ3VjX2V2ZW50cyk7Cj4gICAJfQo+
IC0Jc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ICsJc3Bpbl91bmxvY2tf
aXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gICB9Cj4gICAKPiAtdm9pZCBnZW45X2Rpc2FibGVfZ3Vj
X2ludGVycnVwdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGdl
bjlfZGlzYWJsZV9ndWNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiAgIHsKPiAtCWFzc2VydF9ycG1fd2FrZWxvY2tfaGVsZChkZXZfcHJpdik7Cj4gKwlhc3NlcnRf
cnBtX3dha2Vsb2NrX2hlbGQoaTkxNSk7Cj4gICAKPiAtCXNwaW5fbG9ja19pcnEoJmRldl9wcml2
LT5pcnFfbG9jayk7Cj4gLQlkZXZfcHJpdi0+Z3VjLmludGVycnVwdHMuZW5hYmxlZCA9IGZhbHNl
Owo+ICsJc3Bpbl9sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ICsJaTkxNS0+Z3VjLmludGVy
cnVwdHMuZW5hYmxlZCA9IGZhbHNlOwo+ICAgCj4gLQlnZW42X2Rpc2FibGVfcG1faXJxKGRldl9w
cml2LCBkZXZfcHJpdi0+cG1fZ3VjX2V2ZW50cyk7Cj4gKwlnZW42X2Rpc2FibGVfcG1faXJxKGk5
MTUsIGk5MTUtPnBtX2d1Y19ldmVudHMpOwo+ICAgCj4gLQlzcGluX3VubG9ja19pcnEoJmRldl9w
cml2LT5pcnFfbG9jayk7Cj4gLQlzeW5jaHJvbml6ZV9pcnEoZGV2X3ByaXYtPmRybS5pcnEpOwo+
ICsJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gKwlzeW5jaHJvbml6ZV9pcnEo
aTkxNS0+ZHJtLmlycSk7Cj4gICAKPiAtCWdlbjlfcmVzZXRfZ3VjX2ludGVycnVwdHMoZGV2X3By
aXYpOwo+ICsJZ2VuOV9yZXNldF9ndWNfaW50ZXJydXB0cyhpOTE1KTsKPiAgIH0KPiAgIAo+ICAg
dm9pZCBnZW4xMV9yZXNldF9ndWNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiBAQCAtNjMyLDUzICs2MzIsNTMgQEAgdm9pZCBnZW4xMV9yZXNldF9ndWNfaW50ZXJy
dXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIAlzcGluX3VubG9ja19pcnEo
Jmk5MTUtPmlycV9sb2NrKTsKPiAgIH0KPiAgIAo+IC12b2lkIGdlbjExX2VuYWJsZV9ndWNfaW50
ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgZ2VuMTFf
ZW5hYmxlX2d1Y19pbnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAg
ewo+IC0Jc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiAtCWlmICghZGV2X3By
aXYtPmd1Yy5pbnRlcnJ1cHRzLmVuYWJsZWQpIHsKPiArCXNwaW5fbG9ja19pcnEoJmk5MTUtPmly
cV9sb2NrKTsKPiArCWlmICghaTkxNS0+Z3VjLmludGVycnVwdHMuZW5hYmxlZCkgewo+ICAgCQl1
MzIgZXZlbnRzID0gUkVHX0ZJRUxEX1BSRVAoRU5HSU5FMV9NQVNLLAo+ICAgCQkJCQkgICAgR0VO
MTFfR1VDX0lOVFJfR1VDMkhPU1QpOwo+ICAgCj4gLQkJV0FSTl9PTl9PTkNFKGdlbjExX3Jlc2V0
X29uZV9paXIoZGV2X3ByaXYsIDAsIEdFTjExX0dVQykpOwo+ICsJCVdBUk5fT05fT05DRShnZW4x
MV9yZXNldF9vbmVfaWlyKGk5MTUsIDAsIEdFTjExX0dVQykpOwo+ICAgCQlJOTE1X1dSSVRFKEdF
TjExX0dVQ19TR19JTlRSX0VOQUJMRSwgZXZlbnRzKTsKPiAgIAkJSTkxNV9XUklURShHRU4xMV9H
VUNfU0dfSU5UUl9NQVNLLCB+ZXZlbnRzKTsKPiAtCQlkZXZfcHJpdi0+Z3VjLmludGVycnVwdHMu
ZW5hYmxlZCA9IHRydWU7Cj4gKwkJaTkxNS0+Z3VjLmludGVycnVwdHMuZW5hYmxlZCA9IHRydWU7
Cj4gICAJfQo+IC0Jc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ICsJc3Bp
bl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gICB9Cj4gICAKPiAtdm9pZCBnZW4xMV9k
aXNhYmxlX2d1Y19pbnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiArdm9pZCBnZW4xMV9kaXNhYmxlX2d1Y19pbnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ICAgewo+IC0Jc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsK
PiAtCWRldl9wcml2LT5ndWMuaW50ZXJydXB0cy5lbmFibGVkID0gZmFsc2U7Cj4gKwlzcGluX2xv
Y2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gKwlpOTE1LT5ndWMuaW50ZXJydXB0cy5lbmFibGVk
ID0gZmFsc2U7Cj4gICAKPiAgIAlJOTE1X1dSSVRFKEdFTjExX0dVQ19TR19JTlRSX01BU0ssIH4w
KTsKPiAgIAlJOTE1X1dSSVRFKEdFTjExX0dVQ19TR19JTlRSX0VOQUJMRSwgMCk7Cj4gICAKPiAt
CXNwaW5fdW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiAtCXN5bmNocm9uaXplX2ly
cShkZXZfcHJpdi0+ZHJtLmlycSk7Cj4gKwlzcGluX3VubG9ja19pcnEoJmk5MTUtPmlycV9sb2Nr
KTsKPiArCXN5bmNocm9uaXplX2lycShpOTE1LT5kcm0uaXJxKTsKPiAgIAo+IC0JZ2VuMTFfcmVz
ZXRfZ3VjX2ludGVycnVwdHMoZGV2X3ByaXYpOwo+ICsJZ2VuMTFfcmVzZXRfZ3VjX2ludGVycnVw
dHMoaTkxNSk7Cj4gICB9Cj4gICAKPiAgIC8qKgo+ICAgICogYmR3X3VwZGF0ZV9wb3J0X2lycSAt
IHVwZGF0ZSBERSBwb3J0IGludGVycnVwdAo+IC0gKiBAZGV2X3ByaXY6IGRyaXZlciBwcml2YXRl
Cj4gKyAqIEBpOTE1OiBkcml2ZXIgcHJpdmF0ZQo+ICAgICogQGludGVycnVwdF9tYXNrOiBtYXNr
IG9mIGludGVycnVwdCBiaXRzIHRvIHVwZGF0ZQo+ICAgICogQGVuYWJsZWRfaXJxX21hc2s6IG1h
c2sgb2YgaW50ZXJydXB0IGJpdHMgdG8gZW5hYmxlCj4gICAgKi8KPiAtc3RhdGljIHZvaWQgYmR3
X3VwZGF0ZV9wb3J0X2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0
YXRpYyB2b2lkIGJkd191cGRhdGVfcG9ydF9pcnEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gICAJCQkJdTMyIGludGVycnVwdF9tYXNrLAo+ICAgCQkJCXUzMiBlbmFibGVkX2lycV9t
YXNrKQo+ICAgewo+ICAgCXUzMiBuZXdfdmFsOwo+ICAgCXUzMiBvbGRfdmFsOwo+ICAgCj4gLQls
b2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ICsJbG9ja2RlcF9hc3Nl
cnRfaGVsZCgmaTkxNS0+aXJxX2xvY2spOwo+ICAgCj4gICAJV0FSTl9PTihlbmFibGVkX2lycV9t
YXNrICYgfmludGVycnVwdF9tYXNrKTsKPiAgIAo+IC0JaWYgKFdBUk5fT04oIWludGVsX2lycXNf
ZW5hYmxlZChkZXZfcHJpdikpKQo+ICsJaWYgKFdBUk5fT04oIWludGVsX2lycXNfZW5hYmxlZChp
OTE1KSkpCj4gICAJCXJldHVybjsKPiAgIAo+ICAgCW9sZF92YWwgPSBJOTE1X1JFQUQoR0VOOF9E
RV9QT1JUX0lNUik7Cj4gQEAgLTY5NSw0MyArNjk1LDQzIEBAIHN0YXRpYyB2b2lkIGJkd191cGRh
dGVfcG9ydF9pcnEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCj4gICAv
KioKPiAgICAqIGJkd191cGRhdGVfcGlwZV9pcnEgLSB1cGRhdGUgREUgcGlwZSBpbnRlcnJ1cHQK
PiAtICogQGRldl9wcml2OiBkcml2ZXIgcHJpdmF0ZQo+ICsgKiBAaTkxNTogZHJpdmVyIHByaXZh
dGUKPiAgICAqIEBwaXBlOiBwaXBlIHdob3NlIGludGVycnVwdCB0byB1cGRhdGUKPiAgICAqIEBp
bnRlcnJ1cHRfbWFzazogbWFzayBvZiBpbnRlcnJ1cHQgYml0cyB0byB1cGRhdGUKPiAgICAqIEBl
bmFibGVkX2lycV9tYXNrOiBtYXNrIG9mIGludGVycnVwdCBiaXRzIHRvIGVuYWJsZQo+ICAgICov
Cj4gLXZvaWQgYmR3X3VwZGF0ZV9waXBlX2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gK3ZvaWQgYmR3X3VwZGF0ZV9waXBlX2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwKPiAgIAkJCSBlbnVtIHBpcGUgcGlwZSwKPiAgIAkJCSB1MzIgaW50ZXJydXB0X21h
c2ssCj4gICAJCQkgdTMyIGVuYWJsZWRfaXJxX21hc2spCj4gICB7Cj4gICAJdTMyIG5ld192YWw7
Cj4gICAKPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gKwls
b2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5pcnFfbG9jayk7Cj4gICAKPiAgIAlXQVJOX09OKGVu
YWJsZWRfaXJxX21hc2sgJiB+aW50ZXJydXB0X21hc2spOwo+ICAgCj4gLQlpZiAoV0FSTl9PTigh
aW50ZWxfaXJxc19lbmFibGVkKGRldl9wcml2KSkpCj4gKwlpZiAoV0FSTl9PTighaW50ZWxfaXJx
c19lbmFibGVkKGk5MTUpKSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQluZXdfdmFsID0gZGV2X3By
aXYtPmRlX2lycV9tYXNrW3BpcGVdOwo+ICsJbmV3X3ZhbCA9IGk5MTUtPmRlX2lycV9tYXNrW3Bp
cGVdOwo+ICAgCW5ld192YWwgJj0gfmludGVycnVwdF9tYXNrOwo+ICAgCW5ld192YWwgfD0gKH5l
bmFibGVkX2lycV9tYXNrICYgaW50ZXJydXB0X21hc2spOwo+ICAgCj4gLQlpZiAobmV3X3ZhbCAh
PSBkZXZfcHJpdi0+ZGVfaXJxX21hc2tbcGlwZV0pIHsKPiAtCQlkZXZfcHJpdi0+ZGVfaXJxX21h
c2tbcGlwZV0gPSBuZXdfdmFsOwo+IC0JCUk5MTVfV1JJVEUoR0VOOF9ERV9QSVBFX0lNUihwaXBl
KSwgZGV2X3ByaXYtPmRlX2lycV9tYXNrW3BpcGVdKTsKPiArCWlmIChuZXdfdmFsICE9IGk5MTUt
PmRlX2lycV9tYXNrW3BpcGVdKSB7Cj4gKwkJaTkxNS0+ZGVfaXJxX21hc2tbcGlwZV0gPSBuZXdf
dmFsOwo+ICsJCUk5MTVfV1JJVEUoR0VOOF9ERV9QSVBFX0lNUihwaXBlKSwgaTkxNS0+ZGVfaXJx
X21hc2tbcGlwZV0pOwo+ICAgCQlQT1NUSU5HX1JFQUQoR0VOOF9ERV9QSVBFX0lNUihwaXBlKSk7
Cj4gICAJfQo+ICAgfQo+ICAgCj4gICAvKioKPiAgICAqIGlieF9kaXNwbGF5X2ludGVycnVwdF91
cGRhdGUgLSB1cGRhdGUgU0RFSU1SCj4gLSAqIEBkZXZfcHJpdjogZHJpdmVyIHByaXZhdGUKPiAr
ICogQGk5MTU6IGRyaXZlciBwcml2YXRlCj4gICAgKiBAaW50ZXJydXB0X21hc2s6IG1hc2sgb2Yg
aW50ZXJydXB0IGJpdHMgdG8gdXBkYXRlCj4gICAgKiBAZW5hYmxlZF9pcnFfbWFzazogbWFzayBv
ZiBpbnRlcnJ1cHQgYml0cyB0byBlbmFibGUKPiAgICAqLwo+IC12b2lkIGlieF9kaXNwbGF5X2lu
dGVycnVwdF91cGRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICt2b2lk
IGlieF9kaXNwbGF5X2ludGVycnVwdF91cGRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gICAJCQkJICB1MzIgaW50ZXJydXB0X21hc2ssCj4gICAJCQkJICB1MzIgZW5hYmxlZF9p
cnFfbWFzaykKPiAgIHsKPiBAQCAtNzQxLDI0ICs3NDEsMjQgQEAgdm9pZCBpYnhfZGlzcGxheV9p
bnRlcnJ1cHRfdXBkYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAo+
ICAgCVdBUk5fT04oZW5hYmxlZF9pcnFfbWFzayAmIH5pbnRlcnJ1cHRfbWFzayk7Cj4gICAKPiAt
CWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gKwlsb2NrZGVwX2Fz
c2VydF9oZWxkKCZpOTE1LT5pcnFfbG9jayk7Cj4gICAKPiAtCWlmIChXQVJOX09OKCFpbnRlbF9p
cnFzX2VuYWJsZWQoZGV2X3ByaXYpKSkKPiArCWlmIChXQVJOX09OKCFpbnRlbF9pcnFzX2VuYWJs
ZWQoaTkxNSkpKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAlJOTE1X1dSSVRFKFNERUlNUiwgc2Rl
aW1yKTsKPiAgIAlQT1NUSU5HX1JFQUQoU0RFSU1SKTsKPiAgIH0KPiAgIAo+IC11MzIgaTkxNV9w
aXBlc3RhdF9lbmFibGVfbWFzayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
K3UzMiBpOTE1X3BpcGVzdGF0X2VuYWJsZV9tYXNrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ICAgCQkJICAgICAgZW51bSBwaXBlIHBpcGUpCj4gICB7Cj4gLQl1MzIgc3RhdHVzX21h
c2sgPSBkZXZfcHJpdi0+cGlwZXN0YXRfaXJxX21hc2tbcGlwZV07Cj4gKwl1MzIgc3RhdHVzX21h
c2sgPSBpOTE1LT5waXBlc3RhdF9pcnFfbWFza1twaXBlXTsKPiAgIAl1MzIgZW5hYmxlX21hc2sg
PSBzdGF0dXNfbWFzayA8PCAxNjsKPiAgIAo+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3By
aXYtPmlycV9sb2NrKTsKPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmlycV9sb2NrKTsK
PiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA1KQo+ICsJaWYgKElOVEVMX0dFTihp
OTE1KSA8IDUpCj4gICAJCWdvdG8gb3V0Owo+ICAgCj4gICAJLyoKPiBAQCAtNzkxLDcgKzc5MSw3
IEBAIHUzMiBpOTE1X3BpcGVzdGF0X2VuYWJsZV9tYXNrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiAgIAlyZXR1cm4gZW5hYmxlX21hc2s7Cj4gICB9Cj4gICAKPiAtdm9pZCBp
OTE1X2VuYWJsZV9waXBlc3RhdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
K3ZvaWQgaTkxNV9lbmFibGVfcGlwZXN0YXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gICAJCQkgIGVudW0gcGlwZSBwaXBlLCB1MzIgc3RhdHVzX21hc2spCj4gICB7Cj4gICAJaTkx
NV9yZWdfdCByZWcgPSBQSVBFU1RBVChwaXBlKTsKPiBAQCAtODAxLDIwICs4MDEsMjAgQEAgdm9p
ZCBpOTE1X2VuYWJsZV9waXBlc3RhdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gICAJCSAgInBpcGUgJWM6IHN0YXR1c19tYXNrPTB4JXhcbiIsCj4gICAJCSAgcGlwZV9uYW1l
KHBpcGUpLCBzdGF0dXNfbWFzayk7Cj4gICAKPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9w
cml2LT5pcnFfbG9jayk7Cj4gLQlXQVJOX09OKCFpbnRlbF9pcnFzX2VuYWJsZWQoZGV2X3ByaXYp
KTsKPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmlycV9sb2NrKTsKPiArCVdBUk5fT04o
IWludGVsX2lycXNfZW5hYmxlZChpOTE1KSk7Cj4gICAKPiAtCWlmICgoZGV2X3ByaXYtPnBpcGVz
dGF0X2lycV9tYXNrW3BpcGVdICYgc3RhdHVzX21hc2spID09IHN0YXR1c19tYXNrKQo+ICsJaWYg
KChpOTE1LT5waXBlc3RhdF9pcnFfbWFza1twaXBlXSAmIHN0YXR1c19tYXNrKSA9PSBzdGF0dXNf
bWFzaykKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQlkZXZfcHJpdi0+cGlwZXN0YXRfaXJxX21hc2tb
cGlwZV0gfD0gc3RhdHVzX21hc2s7Cj4gLQllbmFibGVfbWFzayA9IGk5MTVfcGlwZXN0YXRfZW5h
YmxlX21hc2soZGV2X3ByaXYsIHBpcGUpOwo+ICsJaTkxNS0+cGlwZXN0YXRfaXJxX21hc2tbcGlw
ZV0gfD0gc3RhdHVzX21hc2s7Cj4gKwllbmFibGVfbWFzayA9IGk5MTVfcGlwZXN0YXRfZW5hYmxl
X21hc2soaTkxNSwgcGlwZSk7Cj4gICAKPiAgIAlJOTE1X1dSSVRFKHJlZywgZW5hYmxlX21hc2sg
fCBzdGF0dXNfbWFzayk7Cj4gICAJUE9TVElOR19SRUFEKHJlZyk7Cj4gICB9Cj4gICAKPiAtdm9p
ZCBpOTE1X2Rpc2FibGVfcGlwZXN0YXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ICt2b2lkIGk5MTVfZGlzYWJsZV9waXBlc3RhdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiAgIAkJCSAgIGVudW0gcGlwZSBwaXBlLCB1MzIgc3RhdHVzX21hc2spCj4gICB7Cj4g
ICAJaTkxNV9yZWdfdCByZWcgPSBQSVBFU1RBVChwaXBlKTsKPiBAQCAtODI0LDQ0ICs4MjQsNDQg
QEAgdm9pZCBpOTE1X2Rpc2FibGVfcGlwZXN0YXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ICAgCQkgICJwaXBlICVjOiBzdGF0dXNfbWFzaz0weCV4XG4iLAo+ICAgCQkgIHBp
cGVfbmFtZShwaXBlKSwgc3RhdHVzX21hc2spOwo+ICAgCj4gLQlsb2NrZGVwX2Fzc2VydF9oZWxk
KCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+IC0JV0FSTl9PTighaW50ZWxfaXJxc19lbmFibGVkKGRl
dl9wcml2KSk7Cj4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5pcnFfbG9jayk7Cj4gKwlX
QVJOX09OKCFpbnRlbF9pcnFzX2VuYWJsZWQoaTkxNSkpOwo+ICAgCj4gLQlpZiAoKGRldl9wcml2
LT5waXBlc3RhdF9pcnFfbWFza1twaXBlXSAmIHN0YXR1c19tYXNrKSA9PSAwKQo+ICsJaWYgKChp
OTE1LT5waXBlc3RhdF9pcnFfbWFza1twaXBlXSAmIHN0YXR1c19tYXNrKSA9PSAwKQo+ICAgCQly
ZXR1cm47Cj4gICAKPiAtCWRldl9wcml2LT5waXBlc3RhdF9pcnFfbWFza1twaXBlXSAmPSB+c3Rh
dHVzX21hc2s7Cj4gLQllbmFibGVfbWFzayA9IGk5MTVfcGlwZXN0YXRfZW5hYmxlX21hc2soZGV2
X3ByaXYsIHBpcGUpOwo+ICsJaTkxNS0+cGlwZXN0YXRfaXJxX21hc2tbcGlwZV0gJj0gfnN0YXR1
c19tYXNrOwo+ICsJZW5hYmxlX21hc2sgPSBpOTE1X3BpcGVzdGF0X2VuYWJsZV9tYXNrKGk5MTUs
IHBpcGUpOwo+ICAgCj4gICAJSTkxNV9XUklURShyZWcsIGVuYWJsZV9tYXNrIHwgc3RhdHVzX21h
c2spOwo+ICAgCVBPU1RJTkdfUkVBRChyZWcpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBib29sIGk5
MTVfaGFzX2FzbGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMg
Ym9vbCBpOTE1X2hhc19hc2xlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+
IC0JaWYgKCFkZXZfcHJpdi0+b3ByZWdpb24uYXNsZSkKPiArCWlmICghaTkxNS0+b3ByZWdpb24u
YXNsZSkKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAgCj4gLQlyZXR1cm4gSVNfUElORVZJRVcoZGV2
X3ByaXYpIHx8IElTX01PQklMRShkZXZfcHJpdik7Cj4gKwlyZXR1cm4gSVNfUElORVZJRVcoaTkx
NSkgfHwgSVNfTU9CSUxFKGk5MTUpOwo+ICAgfQo+ICAgCj4gICAvKioKPiAgICAqIGk5MTVfZW5h
YmxlX2FzbGVfcGlwZXN0YXQgLSBlbmFibGUgQVNMRSBwaXBlc3RhdCBmb3IgT3BSZWdpb24KPiAt
ICogQGRldl9wcml2OiBpOTE1IGRldmljZSBwcml2YXRlCj4gKyAqIEBpOTE1OiBpOTE1IGRldmlj
ZSBwcml2YXRlCj4gICAgKi8KPiAtc3RhdGljIHZvaWQgaTkxNV9lbmFibGVfYXNsZV9waXBlc3Rh
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGk5MTVf
ZW5hYmxlX2FzbGVfcGlwZXN0YXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7
Cj4gLQlpZiAoIWk5MTVfaGFzX2FzbGUoZGV2X3ByaXYpKQo+ICsJaWYgKCFpOTE1X2hhc19hc2xl
KGk5MTUpKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCXNwaW5fbG9ja19pcnEoJmRldl9wcml2LT5p
cnFfbG9jayk7Cj4gKwlzcGluX2xvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gICAKPiAtCWk5
MTVfZW5hYmxlX3BpcGVzdGF0KGRldl9wcml2LCBQSVBFX0IsIFBJUEVfTEVHQUNZX0JMQ19FVkVO
VF9TVEFUVVMpOwo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCkKPiAtCQlpOTE1X2Vu
YWJsZV9waXBlc3RhdChkZXZfcHJpdiwgUElQRV9BLAo+ICsJaTkxNV9lbmFibGVfcGlwZXN0YXQo
aTkxNSwgUElQRV9CLCBQSVBFX0xFR0FDWV9CTENfRVZFTlRfU1RBVFVTKTsKPiArCWlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gNCkKPiArCQlpOTE1X2VuYWJsZV9waXBlc3RhdChpOTE1LCBQSVBFX0Es
Cj4gICAJCQkJICAgICBQSVBFX0xFR0FDWV9CTENfRVZFTlRfU1RBVFVTKTsKPiAgIAo+IC0Jc3Bp
bl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ICsJc3Bpbl91bmxvY2tfaXJxKCZp
OTE1LT5pcnFfbG9jayk7Cj4gICB9Cj4gICAKPiAgIC8qCj4gQEAgLTkxOSw3ICs5MTksNyBAQCBz
dGF0aWMgdm9pZCBpOTE1X2VuYWJsZV9hc2xlX3BpcGVzdGF0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiAgICAqLwo+ICAgc3RhdGljIHUzMiBpOTE1X2dldF92YmxhbmtfY291
bnRlcihzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1bnNpZ25lZCBpbnQgcGlwZSkKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXN0cnVjdCBk
cm1fdmJsYW5rX2NydGMgKnZibGFuayA9ICZkZXYtPnZibGFua1twaXBlXTsKPiAgIAljb25zdCBz
dHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSA9ICZ2YmxhbmstPmh3bW9kZTsKPiAgIAlpOTE1
X3JlZ190IGhpZ2hfZnJhbWUsIGxvd19mcmFtZTsKPiBAQCAtOTU1LDcgKzk1NSw3IEBAIHN0YXRp
YyB1MzIgaTkxNV9nZXRfdmJsYW5rX2NvdW50ZXIoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdW5z
aWduZWQgaW50IHBpcGUpCj4gICAJaGlnaF9mcmFtZSA9IFBJUEVGUkFNRShwaXBlKTsKPiAgIAls
b3dfZnJhbWUgPSBQSVBFRlJBTUVQSVhFTChwaXBlKTsKPiAgIAo+IC0Jc3Bpbl9sb2NrX2lycXNh
dmUoJmRldl9wcml2LT51bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ICsJc3Bpbl9sb2NrX2lycXNh
dmUoJmk5MTUtPnVuY29yZS5sb2NrLCBpcnFmbGFncyk7Cj4gICAKPiAgIAkvKgo+ICAgCSAqIEhp
Z2ggJiBsb3cgcmVnaXN0ZXIgZmllbGRzIGFyZW4ndCBzeW5jaHJvbml6ZWQsIHNvIG1ha2Ugc3Vy
ZQo+IEBAIC05NjgsNyArOTY4LDcgQEAgc3RhdGljIHUzMiBpOTE1X2dldF92YmxhbmtfY291bnRl
cihzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1bnNpZ25lZCBpbnQgcGlwZSkKPiAgIAkJaGlnaDIg
PSBJOTE1X1JFQURfRlcoaGlnaF9mcmFtZSkgJiBQSVBFX0ZSQU1FX0hJR0hfTUFTSzsKPiAgIAl9
IHdoaWxlIChoaWdoMSAhPSBoaWdoMik7Cj4gICAKPiAtCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUo
JmRldl9wcml2LT51bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ICsJc3Bpbl91bmxvY2tfaXJxcmVz
dG9yZSgmaTkxNS0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiAgIAo+ICAgCWhpZ2gxID4+PSBQ
SVBFX0ZSQU1FX0hJR0hfU0hJRlQ7Cj4gICAJcGl4ZWwgPSBsb3cgJiBQSVBFX1BJWEVMX01BU0s7
Cj4gQEAgLTk4NCw3ICs5ODQsNyBAQCBzdGF0aWMgdTMyIGk5MTVfZ2V0X3ZibGFua19jb3VudGVy
KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHVuc2lnbmVkIGludCBwaXBlKQo+ICAgCj4gICBzdGF0
aWMgdTMyIGc0eF9nZXRfdmJsYW5rX2NvdW50ZXIoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdW5z
aWduZWQgaW50IHBpcGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoZGV2KTsKPiAgIAo+ICAgCXJldHVybiBJOTE1X1JFQUQoUElQRV9GUk1DT1VOVF9HNFgo
cGlwZSkpOwo+ICAgfQo+IEBAIC05OTksNyArOTk5LDcgQEAgc3RhdGljIHUzMiBnNHhfZ2V0X3Zi
bGFua19jb3VudGVyKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHVuc2lnbmVkIGludCBwaXBlKQo+
ICAgICovCj4gICBzdGF0aWMgdTMyIF9faW50ZWxfZ2V0X2NydGNfc2NhbmxpbmVfZnJvbV90aW1l
c3RhbXAoc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gICAJc3Ry
dWN0IGRybV92YmxhbmtfY3J0YyAqdmJsYW5rID0KPiAgIAkJJmNydGMtPmJhc2UuZGV2LT52Ymxh
bmtbZHJtX2NydGNfaW5kZXgoJmNydGMtPmJhc2UpXTsKPiAgIAljb25zdCBzdHJ1Y3QgZHJtX2Rp
c3BsYXlfbW9kZSAqbW9kZSA9ICZ2YmxhbmstPmh3bW9kZTsKPiBAQCAtMTA0NCw3ICsxMDQ0LDcg
QEAgc3RhdGljIHUzMiBfX2ludGVsX2dldF9jcnRjX3NjYW5saW5lX2Zyb21fdGltZXN0YW1wKHN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+ICAgc3RhdGljIGludCBfX2ludGVsX2dldF9jcnRjX3Nj
YW5saW5lKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+ICAgewo+ICAgCXN0cnVjdCBkcm1fZGV2
aWNlICpkZXYgPSBjcnRjLT5iYXNlLmRldjsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShkZXYpOwo+ICAgCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2Rl
Owo+ICAgCXN0cnVjdCBkcm1fdmJsYW5rX2NydGMgKnZibGFuazsKPiAgIAllbnVtIHBpcGUgcGlw
ZSA9IGNydGMtPnBpcGU7Cj4gQEAgLTEwNjMsNyArMTA2Myw3IEBAIHN0YXRpYyBpbnQgX19pbnRl
bF9nZXRfY3J0Y19zY2FubGluZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiAgIAlpZiAobW9k
ZS0+ZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX0lOVEVSTEFDRSkKPiAgIAkJdnRvdGFsIC89IDI7Cj4g
ICAKPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDIpKQo+ICsJaWYgKElTX0dFTihpOTE1LCAyKSkK
PiAgIAkJcG9zaXRpb24gPSBJOTE1X1JFQURfRlcoUElQRURTTChwaXBlKSkgJiBEU0xfTElORU1B
U0tfR0VOMjsKPiAgIAllbHNlCj4gICAJCXBvc2l0aW9uID0gSTkxNV9SRUFEX0ZXKFBJUEVEU0wo
cGlwZSkpICYgRFNMX0xJTkVNQVNLX0dFTjM7Cj4gQEAgLTEwODAsNyArMTA4MCw3IEBAIHN0YXRp
YyBpbnQgX19pbnRlbF9nZXRfY3J0Y19zY2FubGluZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykK
PiAgIAkgKiBwcm9ibGVtLiAgV2UgbWF5IG5lZWQgdG8gZXh0ZW5kIHRoaXMgdG8gaW5jbHVkZSBv
dGhlciBwbGF0Zm9ybXMsCj4gICAJICogYnV0IHNvIGZhciB0ZXN0aW5nIG9ubHkgc2hvd3MgdGhl
IHByb2JsZW0gb24gSFNXLgo+ICAgCSAqLwo+IC0JaWYgKEhBU19EREkoZGV2X3ByaXYpICYmICFw
b3NpdGlvbikgewo+ICsJaWYgKEhBU19EREkoaTkxNSkgJiYgIXBvc2l0aW9uKSB7Cj4gICAJCWlu
dCBpLCB0ZW1wOwo+ICAgCj4gICAJCWZvciAoaSA9IDA7IGkgPCAxMDA7IGkrKykgewo+IEBAIC0x
MTA1LDE0ICsxMTA1LDE0IEBAIHN0YXRpYyBib29sIGk5MTVfZ2V0X2NydGNfc2Nhbm91dHBvcyhz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1bnNpZ25lZCBpbnQgcGlwZSwKPiAgIAkJCQkgICAgIGt0
aW1lX3QgKnN0aW1lLCBrdGltZV90ICpldGltZSwKPiAgIAkJCQkgICAgIGNvbnN0IHN0cnVjdCBk
cm1fZGlzcGxheV9tb2RlICptb2RlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+IC0Jc3RydWN0IGludGVsX2NydGMgKmludGVsX2Ny
dGMgPSBpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShkZXZfcHJpdiwKPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmlu
dGVsX2NydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShpOTE1LAo+ICAgCQkJCQkJCQlwaXBl
KTsKPiAgIAlpbnQgcG9zaXRpb247Cj4gICAJaW50IHZibF9zdGFydCwgdmJsX2VuZCwgaHN5bmNf
c3RhcnQsIGh0b3RhbCwgdnRvdGFsOwo+ICAgCXVuc2lnbmVkIGxvbmcgaXJxZmxhZ3M7Cj4gLQli
b29sIHVzZV9zY2FubGluZV9jb3VudGVyID0gSU5URUxfR0VOKGRldl9wcml2KSA+PSA1IHx8Cj4g
LQkJSVNfRzRYKGRldl9wcml2KSB8fCBJU19HRU4oZGV2X3ByaXYsIDIpIHx8Cj4gKwlib29sIHVz
ZV9zY2FubGluZV9jb3VudGVyID0gSU5URUxfR0VOKGk5MTUpID49IDUgfHwKPiArCQlJU19HNFgo
aTkxNSkgfHwgSVNfR0VOKGk5MTUsIDIpIHx8Cj4gICAJCW1vZGUtPnByaXZhdGVfZmxhZ3MgJiBJ
OTE1X01PREVfRkxBR19VU0VfU0NBTkxJTkVfQ09VTlRFUjsKPiAgIAo+ICAgCWlmIChXQVJOX09O
KCFtb2RlLT5jcnRjX2Nsb2NrKSkgewo+IEBAIC0xMTM4LDcgKzExMzgsNyBAQCBzdGF0aWMgYm9v
bCBpOTE1X2dldF9jcnRjX3NjYW5vdXRwb3Moc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdW5zaWdu
ZWQgaW50IHBpcGUsCj4gICAJICogcmVnaXN0ZXIgcmVhZHMsIHBvdGVudGlhbGx5IHdpdGggcHJl
ZW1wdGlvbiBkaXNhYmxlZCwgc28gdGhlCj4gICAJICogZm9sbG93aW5nIGNvZGUgbXVzdCBub3Qg
YmxvY2sgb24gdW5jb3JlLmxvY2suCj4gICAJICovCj4gLQlzcGluX2xvY2tfaXJxc2F2ZSgmZGV2
X3ByaXYtPnVuY29yZS5sb2NrLCBpcnFmbGFncyk7Cj4gKwlzcGluX2xvY2tfaXJxc2F2ZSgmaTkx
NS0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiAgIAo+ICAgCS8qIHByZWVtcHRfZGlzYWJsZV9y
dCgpIHNob3VsZCBnbyByaWdodCBoZXJlIGluIFBSRUVNUFRfUlQgcGF0Y2hzZXQuICovCj4gICAK
PiBAQCAtMTE5Myw3ICsxMTkzLDcgQEAgc3RhdGljIGJvb2wgaTkxNV9nZXRfY3J0Y19zY2Fub3V0
cG9zKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHVuc2lnbmVkIGludCBwaXBlLAo+ICAgCj4gICAJ
LyogcHJlZW1wdF9lbmFibGVfcnQoKSBzaG91bGQgZ28gcmlnaHQgaGVyZSBpbiBQUkVFTVBUX1JU
IHBhdGNoc2V0LiAqLwo+ICAgCj4gLQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZkZXZfcHJpdi0+
dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUt
PnVuY29yZS5sb2NrLCBpcnFmbGFncyk7Cj4gICAKPiAgIAkvKgo+ICAgCSAqIFdoaWxlIGluIHZi
bGFuaywgcG9zaXRpb24gd2lsbCBiZSBuZWdhdGl2ZQo+IEBAIC0xMjE5LDIwICsxMjE5LDIwIEBA
IHN0YXRpYyBib29sIGk5MTVfZ2V0X2NydGNfc2Nhbm91dHBvcyhzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2LCB1bnNpZ25lZCBpbnQgcGlwZSwKPiAgIAo+ICAgaW50IGludGVsX2dldF9jcnRjX3NjYW5s
aW5lKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAgCXVuc2ln
bmVkIGxvbmcgaXJxZmxhZ3M7Cj4gICAJaW50IHBvc2l0aW9uOwo+ICAgCj4gLQlzcGluX2xvY2tf
aXJxc2F2ZSgmZGV2X3ByaXYtPnVuY29yZS5sb2NrLCBpcnFmbGFncyk7Cj4gKwlzcGluX2xvY2tf
aXJxc2F2ZSgmaTkxNS0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiAgIAlwb3NpdGlvbiA9IF9f
aW50ZWxfZ2V0X2NydGNfc2NhbmxpbmUoY3J0Yyk7Cj4gLQlzcGluX3VubG9ja19pcnFyZXN0b3Jl
KCZkZXZfcHJpdi0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiArCXNwaW5fdW5sb2NrX2lycXJl
c3RvcmUoJmk5MTUtPnVuY29yZS5sb2NrLCBpcnFmbGFncyk7Cj4gICAKPiAgIAlyZXR1cm4gcG9z
aXRpb247Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaXJvbmxha2VfcnBzX2NoYW5nZV9pcnFf
aGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lk
IGlyb25sYWtlX3Jwc19jaGFuZ2VfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYt
PnVuY29yZTsKPiArCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZpOTE1LT51bmNvcmU7
Cj4gICAJdTMyIGJ1c3lfdXAsIGJ1c3lfZG93biwgbWF4X2F2ZywgbWluX2F2ZzsKPiAgIAl1OCBu
ZXdfZGVsYXk7Cj4gICAKPiBAQCAtMTI0Miw3ICsxMjQyLDcgQEAgc3RhdGljIHZvaWQgaXJvbmxh
a2VfcnBzX2NoYW5nZV9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gICAJCQkgICAgIE1FTUlOVFJTVFMsCj4gICAJCQkgICAgIGludGVsX3VuY29yZV9yZWFk
KHVuY29yZSwgTUVNSU5UUlNUUykpOwo+ICAgCj4gLQluZXdfZGVsYXkgPSBkZXZfcHJpdi0+aXBz
LmN1cl9kZWxheTsKPiArCW5ld19kZWxheSA9IGk5MTUtPmlwcy5jdXJfZGVsYXk7Cj4gICAKPiAg
IAlpbnRlbF91bmNvcmVfd3JpdGUxNih1bmNvcmUsIE1FTUlOVFJTVFMsIE1FTUlOVF9FVkFMX0NI
Ryk7Cj4gICAJYnVzeV91cCA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgUkNQUkVWQlNZVFVQ
QVZHKTsKPiBAQCAtMTI1MiwyNiArMTI1MiwyNiBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9ycHNf
Y2hhbmdlX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAg
IAo+ICAgCS8qIEhhbmRsZSBSQ1MgY2hhbmdlIHJlcXVlc3QgZnJvbSBodyAqLwo+ICAgCWlmIChi
dXN5X3VwID4gbWF4X2F2Zykgewo+IC0JCWlmIChkZXZfcHJpdi0+aXBzLmN1cl9kZWxheSAhPSBk
ZXZfcHJpdi0+aXBzLm1heF9kZWxheSkKPiAtCQkJbmV3X2RlbGF5ID0gZGV2X3ByaXYtPmlwcy5j
dXJfZGVsYXkgLSAxOwo+IC0JCWlmIChuZXdfZGVsYXkgPCBkZXZfcHJpdi0+aXBzLm1heF9kZWxh
eSkKPiAtCQkJbmV3X2RlbGF5ID0gZGV2X3ByaXYtPmlwcy5tYXhfZGVsYXk7Cj4gKwkJaWYgKGk5
MTUtPmlwcy5jdXJfZGVsYXkgIT0gaTkxNS0+aXBzLm1heF9kZWxheSkKPiArCQkJbmV3X2RlbGF5
ID0gaTkxNS0+aXBzLmN1cl9kZWxheSAtIDE7Cj4gKwkJaWYgKG5ld19kZWxheSA8IGk5MTUtPmlw
cy5tYXhfZGVsYXkpCj4gKwkJCW5ld19kZWxheSA9IGk5MTUtPmlwcy5tYXhfZGVsYXk7Cj4gICAJ
fSBlbHNlIGlmIChidXN5X2Rvd24gPCBtaW5fYXZnKSB7Cj4gLQkJaWYgKGRldl9wcml2LT5pcHMu
Y3VyX2RlbGF5ICE9IGRldl9wcml2LT5pcHMubWluX2RlbGF5KQo+IC0JCQluZXdfZGVsYXkgPSBk
ZXZfcHJpdi0+aXBzLmN1cl9kZWxheSArIDE7Cj4gLQkJaWYgKG5ld19kZWxheSA+IGRldl9wcml2
LT5pcHMubWluX2RlbGF5KQo+IC0JCQluZXdfZGVsYXkgPSBkZXZfcHJpdi0+aXBzLm1pbl9kZWxh
eTsKPiArCQlpZiAoaTkxNS0+aXBzLmN1cl9kZWxheSAhPSBpOTE1LT5pcHMubWluX2RlbGF5KQo+
ICsJCQluZXdfZGVsYXkgPSBpOTE1LT5pcHMuY3VyX2RlbGF5ICsgMTsKPiArCQlpZiAobmV3X2Rl
bGF5ID4gaTkxNS0+aXBzLm1pbl9kZWxheSkKPiArCQkJbmV3X2RlbGF5ID0gaTkxNS0+aXBzLm1p
bl9kZWxheTsKPiAgIAl9Cj4gICAKPiAtCWlmIChpcm9ubGFrZV9zZXRfZHJwcyhkZXZfcHJpdiwg
bmV3X2RlbGF5KSkKPiAtCQlkZXZfcHJpdi0+aXBzLmN1cl9kZWxheSA9IG5ld19kZWxheTsKPiAr
CWlmIChpcm9ubGFrZV9zZXRfZHJwcyhpOTE1LCBuZXdfZGVsYXkpKQo+ICsJCWk5MTUtPmlwcy5j
dXJfZGVsYXkgPSBuZXdfZGVsYXk7Cj4gICAKPiAgIAlzcGluX3VubG9jaygmbWNoZGV2X2xvY2sp
Owo+ICAgCj4gICAJcmV0dXJuOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIHZsdl9jMF9yZWFk
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgdmx2X2Mw
X3JlYWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQlzdHJ1Y3QgaW50ZWxf
cnBzX2VpICplaSkKPiAgIHsKPiAgIAllaS0+a3RpbWUgPSBrdGltZV9nZXRfcmF3KCk7Cj4gQEAg
LTEyNzksMTQgKzEyNzksMTQgQEAgc3RhdGljIHZvaWQgdmx2X2MwX3JlYWQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCWVpLT5tZWRpYV9jMCA9IEk5MTVfUkVBRChWTFZf
TUVESUFfQzBfQ09VTlQpOwo+ICAgfQo+ICAgCj4gLXZvaWQgZ2VuNl9ycHNfcmVzZXRfZWkoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGdlbjZfcnBzX3Jlc2V0X2Vp
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JbWVtc2V0KCZkZXZfcHJp
di0+Z3RfcG0ucnBzLmVpLCAwLCBzaXplb2YoZGV2X3ByaXYtPmd0X3BtLnJwcy5laSkpOwo+ICsJ
bWVtc2V0KCZpOTE1LT5ndF9wbS5ycHMuZWksIDAsIHNpemVvZihpOTE1LT5ndF9wbS5ycHMuZWkp
KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdTMyIHZsdl93YV9jMF9laShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBwbV9paXIpCj4gK3N0YXRpYyB1MzIgdmx2X3dhX2MwX2Vp
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgcG1faWlyKQo+ICAgewo+IC0Jc3Ry
dWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Cj4gKwlzdHJ1Y3QgaW50
ZWxfcnBzICpycHMgPSAmaTkxNS0+Z3RfcG0ucnBzOwo+ICAgCWNvbnN0IHN0cnVjdCBpbnRlbF9y
cHNfZWkgKnByZXYgPSAmcnBzLT5laTsKPiAgIAlzdHJ1Y3QgaW50ZWxfcnBzX2VpIG5vdzsKPiAg
IAl1MzIgZXZlbnRzID0gMDsKPiBAQCAtMTI5NCw3ICsxMjk0LDcgQEAgc3RhdGljIHUzMiB2bHZf
d2FfYzBfZWkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgcG1faWlyKQo+
ICAgCWlmICgocG1faWlyICYgR0VONl9QTV9SUF9VUF9FSV9FWFBJUkVEKSA9PSAwKQo+ICAgCQly
ZXR1cm4gMDsKPiAgIAo+IC0Jdmx2X2MwX3JlYWQoZGV2X3ByaXYsICZub3cpOwo+ICsJdmx2X2Mw
X3JlYWQoaTkxNSwgJm5vdyk7Cj4gICAKPiAgIAlpZiAocHJldi0+a3RpbWUpIHsKPiAgIAkJdTY0
IHRpbWUsIGMwOwo+IEBAIC0xMzAyLDcgKzEzMDIsNyBAQCBzdGF0aWMgdTMyIHZsdl93YV9jMF9l
aShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBwbV9paXIpCj4gICAKPiAg
IAkJdGltZSA9IGt0aW1lX3VzX2RlbHRhKG5vdy5rdGltZSwgcHJldi0+a3RpbWUpOwo+ICAgCj4g
LQkJdGltZSAqPSBkZXZfcHJpdi0+Y3pjbGtfZnJlcTsKPiArCQl0aW1lICo9IGk5MTUtPmN6Y2xr
X2ZyZXE7Cj4gICAKPiAgIAkJLyogV29ya2xvYWQgY2FuIGJlIHNwbGl0IGJldHdlZW4gcmVuZGVy
ICsgbWVkaWEsCj4gICAJCSAqIGUuZy4gU3dhcEJ1ZmZlcnMgYmVpbmcgYmxpdHRlZCBpbiBYIGFm
dGVyIGJlaW5nIHJlbmRlcmVkIGluCj4gQEAgLTEzMjYsMjggKzEzMjYsMjggQEAgc3RhdGljIHUz
MiB2bHZfd2FfYzBfZWkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgcG1f
aWlyKQo+ICAgCj4gICBzdGF0aWMgdm9pZCBnZW42X3BtX3Jwc193b3JrKHN0cnVjdCB3b3JrX3N0
cnVjdCAqd29yaykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9Cj4gICAJCWNvbnRhaW5lcl9vZih3
b3JrLCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSwgZ3RfcG0ucnBzLndvcmspOwo+IC0Jc3RydWN0
IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Cj4gKwlzdHJ1Y3QgaW50ZWxf
cnBzICpycHMgPSAmaTkxNS0+Z3RfcG0ucnBzOwo+ICAgCWJvb2wgY2xpZW50X2Jvb3N0ID0gZmFs
c2U7Cj4gICAJaW50IG5ld19kZWxheSwgYWRqLCBtaW4sIG1heDsKPiAgIAl1MzIgcG1faWlyID0g
MDsKPiAgIAo+IC0Jc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiArCXNwaW5f
bG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiAgIAlpZiAocnBzLT5pbnRlcnJ1cHRzX2VuYWJs
ZWQpIHsKPiAgIAkJcG1faWlyID0gZmV0Y2hfYW5kX3plcm8oJnJwcy0+cG1faWlyKTsKPiAgIAkJ
Y2xpZW50X2Jvb3N0ID0gYXRvbWljX3JlYWQoJnJwcy0+bnVtX3dhaXRlcnMpOwo+ICAgCX0KPiAt
CXNwaW5fdW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiArCXNwaW5fdW5sb2NrX2ly
cSgmaTkxNS0+aXJxX2xvY2spOwo+ICAgCj4gICAJLyogTWFrZSBzdXJlIHdlIGRpZG4ndCBxdWV1
ZSBhbnl0aGluZyB3ZSdyZSBub3QgZ29pbmcgdG8gcHJvY2Vzcy4gKi8KPiAtCVdBUk5fT04ocG1f
aWlyICYgfmRldl9wcml2LT5wbV9ycHNfZXZlbnRzKTsKPiAtCWlmICgocG1faWlyICYgZGV2X3By
aXYtPnBtX3Jwc19ldmVudHMpID09IDAgJiYgIWNsaWVudF9ib29zdCkKPiArCVdBUk5fT04ocG1f
aWlyICYgfmk5MTUtPnBtX3Jwc19ldmVudHMpOwo+ICsJaWYgKChwbV9paXIgJiBpOTE1LT5wbV9y
cHNfZXZlbnRzKSA9PSAwICYmICFjbGllbnRfYm9vc3QpCj4gICAJCWdvdG8gb3V0Owo+ICAgCj4g
ICAJbXV0ZXhfbG9jaygmcnBzLT5sb2NrKTsKPiAgIAo+IC0JcG1faWlyIHw9IHZsdl93YV9jMF9l
aShkZXZfcHJpdiwgcG1faWlyKTsKPiArCXBtX2lpciB8PSB2bHZfd2FfYzBfZWkoaTkxNSwgcG1f
aWlyKTsKPiAgIAo+ICAgCWFkaiA9IHJwcy0+bGFzdF9hZGo7Cj4gICAJbmV3X2RlbGF5ID0gcnBz
LT5jdXJfZnJlcTsKPiBAQCAtMTM2Miw3ICsxMzYyLDcgQEAgc3RhdGljIHZvaWQgZ2VuNl9wbV9y
cHNfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gICAJCWlmIChhZGogPiAwKQo+ICAg
CQkJYWRqICo9IDI7Cj4gICAJCWVsc2UgLyogQ0hWIG5lZWRzIGV2ZW4gZW5jb2RlIHZhbHVlcyAq
Lwo+IC0JCQlhZGogPSBJU19DSEVSUllWSUVXKGRldl9wcml2KSA/IDIgOiAxOwo+ICsJCQlhZGog
PSBJU19DSEVSUllWSUVXKGk5MTUpID8gMiA6IDE7Cj4gICAKPiAgIAkJaWYgKG5ld19kZWxheSA+
PSBycHMtPm1heF9mcmVxX3NvZnRsaW1pdCkKPiAgIAkJCWFkaiA9IDA7Cj4gQEAgLTEzNzgsNyAr
MTM3OCw3IEBAIHN0YXRpYyB2b2lkIGdlbjZfcG1fcnBzX3dvcmsoc3RydWN0IHdvcmtfc3RydWN0
ICp3b3JrKQo+ICAgCQlpZiAoYWRqIDwgMCkKPiAgIAkJCWFkaiAqPSAyOwo+ICAgCQllbHNlIC8q
IENIViBuZWVkcyBldmVuIGVuY29kZSB2YWx1ZXMgKi8KPiAtCQkJYWRqID0gSVNfQ0hFUlJZVklF
VyhkZXZfcHJpdikgPyAtMiA6IC0xOwo+ICsJCQlhZGogPSBJU19DSEVSUllWSUVXKGk5MTUpID8g
LTIgOiAtMTsKPiAgIAo+ICAgCQlpZiAobmV3X2RlbGF5IDw9IHJwcy0+bWluX2ZyZXFfc29mdGxp
bWl0KQo+ICAgCQkJYWRqID0gMDsKPiBAQCAtMTQwNiw3ICsxNDA2LDcgQEAgc3RhdGljIHZvaWQg
Z2VuNl9wbV9ycHNfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gICAJbmV3X2RlbGF5
ICs9IGFkajsKPiAgIAluZXdfZGVsYXkgPSBjbGFtcF90KGludCwgbmV3X2RlbGF5LCBtaW4sIG1h
eCk7Cj4gICAKPiAtCWlmIChpbnRlbF9zZXRfcnBzKGRldl9wcml2LCBuZXdfZGVsYXkpKSB7Cj4g
KwlpZiAoaW50ZWxfc2V0X3JwcyhpOTE1LCBuZXdfZGVsYXkpKSB7Cj4gICAJCURSTV9ERUJVR19E
UklWRVIoIkZhaWxlZCB0byBzZXQgbmV3IEdQVSBmcmVxdWVuY3lcbiIpOwo+ICAgCQlycHMtPmxh
c3RfYWRqID0gMDsKPiAgIAl9Cj4gQEAgLTE0MTUsMTAgKzE0MTUsMTAgQEAgc3RhdGljIHZvaWQg
Z2VuNl9wbV9ycHNfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gICAKPiAgIG91dDoK
PiAgIAkvKiBNYWtlIHN1cmUgbm90IHRvIGNvcnJ1cHQgUE1JTVIgc3RhdGUgdXNlZCBieSByaW5n
YnVmZmVyIG9uIEdFTjYgKi8KPiAtCXNwaW5fbG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7
Cj4gKwlzcGluX2xvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gICAJaWYgKHJwcy0+aW50ZXJy
dXB0c19lbmFibGVkKQo+IC0JCWdlbjZfdW5tYXNrX3BtX2lycShkZXZfcHJpdiwgZGV2X3ByaXYt
PnBtX3Jwc19ldmVudHMpOwo+IC0Jc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2sp
Owo+ICsJCWdlbjZfdW5tYXNrX3BtX2lycShpOTE1LCBpOTE1LT5wbV9ycHNfZXZlbnRzKTsKPiAr
CXNwaW5fdW5sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ICAgfQo+ICAgCj4gICAKPiBAQCAt
MTQzMyw4ICsxNDMzLDggQEAgc3RhdGljIHZvaWQgZ2VuNl9wbV9ycHNfd29yayhzdHJ1Y3Qgd29y
a19zdHJ1Y3QgKndvcmspCj4gICAgKi8KPiAgIHN0YXRpYyB2b2lkIGl2eWJyaWRnZV9wYXJpdHlf
d29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPQo+IC0JCWNvbnRhaW5lcl9vZih3b3JrLCB0eXBlb2YoKmRldl9w
cml2KSwgbDNfcGFyaXR5LmVycm9yX3dvcmspOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPQo+ICsJCWNvbnRhaW5lcl9vZih3b3JrLCB0eXBlb2YoKmk5MTUpLCBsM19wYXJpdHku
ZXJyb3Jfd29yayk7Cj4gICAJdTMyIGVycm9yX3N0YXR1cywgcm93LCBiYW5rLCBzdWJiYW5rOwo+
ICAgCWNoYXIgKnBhcml0eV9ldmVudFs2XTsKPiAgIAl1MzIgbWlzY2NwY3RsOwo+IEBAIC0xNDQ0
LDI0ICsxNDQ0LDI0IEBAIHN0YXRpYyB2b2lkIGl2eWJyaWRnZV9wYXJpdHlfd29yayhzdHJ1Y3Qg
d29ya19zdHJ1Y3QgKndvcmspCj4gICAJICogSW4gb3JkZXIgdG8gcHJldmVudCBhIGdldC9wdXQg
c3R5bGUgaW50ZXJmYWNlLCBhY3F1aXJlIHN0cnVjdCBtdXRleAo+ICAgCSAqIGFueSB0aW1lIHdl
IGFjY2VzcyB0aG9zZSByZWdpc3RlcnMuCj4gICAJICovCj4gLQltdXRleF9sb2NrKCZkZXZfcHJp
di0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211
dGV4KTsKPiAgIAo+ICAgCS8qIElmIHdlJ3ZlIHNjcmV3ZWQgdXAgdHJhY2tpbmcsIGp1c3QgbGV0
IHRoZSBpbnRlcnJ1cHQgZmlyZSBhZ2FpbiAqLwo+IC0JaWYgKFdBUk5fT04oIWRldl9wcml2LT5s
M19wYXJpdHkud2hpY2hfc2xpY2UpKQo+ICsJaWYgKFdBUk5fT04oIWk5MTUtPmwzX3Bhcml0eS53
aGljaF9zbGljZSkpCj4gICAJCWdvdG8gb3V0Owo+ICAgCj4gICAJbWlzY2NwY3RsID0gSTkxNV9S
RUFEKEdFTjdfTUlTQ0NQQ1RMKTsKPiAgIAlJOTE1X1dSSVRFKEdFTjdfTUlTQ0NQQ1RMLCBtaXNj
Y3BjdGwgJiB+R0VON19ET1BfQ0xPQ0tfR0FURV9FTkFCTEUpOwo+ICAgCVBPU1RJTkdfUkVBRChH
RU43X01JU0NDUENUTCk7Cj4gICAKPiAtCXdoaWxlICgoc2xpY2UgPSBmZnMoZGV2X3ByaXYtPmwz
X3Bhcml0eS53aGljaF9zbGljZSkpICE9IDApIHsKPiArCXdoaWxlICgoc2xpY2UgPSBmZnMoaTkx
NS0+bDNfcGFyaXR5LndoaWNoX3NsaWNlKSkgIT0gMCkgewo+ICAgCQlpOTE1X3JlZ190IHJlZzsK
PiAgIAo+ICAgCQlzbGljZS0tOwo+IC0JCWlmIChXQVJOX09OX09OQ0Uoc2xpY2UgPj0gTlVNX0wz
X1NMSUNFUyhkZXZfcHJpdikpKQo+ICsJCWlmIChXQVJOX09OX09OQ0Uoc2xpY2UgPj0gTlVNX0wz
X1NMSUNFUyhpOTE1KSkpCj4gICAJCQlicmVhazsKPiAgIAo+IC0JCWRldl9wcml2LT5sM19wYXJp
dHkud2hpY2hfc2xpY2UgJj0gfigxPDxzbGljZSk7Cj4gKwkJaTkxNS0+bDNfcGFyaXR5LndoaWNo
X3NsaWNlICY9IH4oMTw8c2xpY2UpOwo+ICAgCj4gICAJCXJlZyA9IEdFTjdfTDNDREVSUlNUMShz
bGljZSk7Cj4gICAKPiBAQCAtMTQ4MCw3ICsxNDgwLDcgQEAgc3RhdGljIHZvaWQgaXZ5YnJpZGdl
X3Bhcml0eV93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiAgIAkJcGFyaXR5X2V2ZW50
WzRdID0ga2FzcHJpbnRmKEdGUF9LRVJORUwsICJTTElDRT0lZCIsIHNsaWNlKTsKPiAgIAkJcGFy
aXR5X2V2ZW50WzVdID0gTlVMTDsKPiAgIAo+IC0JCWtvYmplY3RfdWV2ZW50X2VudigmZGV2X3By
aXYtPmRybS5wcmltYXJ5LT5rZGV2LT5rb2JqLAo+ICsJCWtvYmplY3RfdWV2ZW50X2VudigmaTkx
NS0+ZHJtLnByaW1hcnktPmtkZXYtPmtvYmosCj4gICAJCQkJICAgS09CSl9DSEFOR0UsIHBhcml0
eV9ldmVudCk7Cj4gICAKPiAgIAkJRFJNX0RFQlVHKCJQYXJpdHkgZXJyb3I6IFNsaWNlID0gJWQs
IFJvdyA9ICVkLCBCYW5rID0gJWQsIFN1YiBiYW5rID0gJWQuXG4iLAo+IEBAIC0xNDk1LDYwICsx
NDk1LDYwIEBAIHN0YXRpYyB2b2lkIGl2eWJyaWRnZV9wYXJpdHlfd29yayhzdHJ1Y3Qgd29ya19z
dHJ1Y3QgKndvcmspCj4gICAJSTkxNV9XUklURShHRU43X01JU0NDUENUTCwgbWlzY2NwY3RsKTsK
PiAgIAo+ICAgb3V0Ogo+IC0JV0FSTl9PTihkZXZfcHJpdi0+bDNfcGFyaXR5LndoaWNoX3NsaWNl
KTsKPiAtCXNwaW5fbG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gLQlnZW41X2VuYWJs
ZV9ndF9pcnEoZGV2X3ByaXYsIEdUX1BBUklUWV9FUlJPUihkZXZfcHJpdikpOwo+IC0Jc3Bpbl91
bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ICsJV0FSTl9PTihpOTE1LT5sM19wYXJp
dHkud2hpY2hfc2xpY2UpOwo+ICsJc3Bpbl9sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ICsJ
Z2VuNV9lbmFibGVfZ3RfaXJxKGk5MTUsIEdUX1BBUklUWV9FUlJPUihpOTE1KSk7Cj4gKwlzcGlu
X3VubG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiAgIAo+IC0JbXV0ZXhfdW5sb2NrKCZkZXZf
cHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1
Y3RfbXV0ZXgpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGl2eWJyaWRnZV9wYXJpdHlfZXJy
b3JfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0
aWMgdm9pZCBpdnlicmlkZ2VfcGFyaXR5X2Vycm9yX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCQkJCQkgICAgICAgdTMyIGlpcikKPiAgIHsKPiAtCWlmICgh
SEFTX0wzX0RQRihkZXZfcHJpdikpCj4gKwlpZiAoIUhBU19MM19EUEYoaTkxNSkpCj4gICAJCXJl
dHVybjsKPiAgIAo+IC0Jc3Bpbl9sb2NrKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+IC0JZ2VuNV9k
aXNhYmxlX2d0X2lycShkZXZfcHJpdiwgR1RfUEFSSVRZX0VSUk9SKGRldl9wcml2KSk7Cj4gLQlz
cGluX3VubG9jaygmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiArCXNwaW5fbG9jaygmaTkxNS0+aXJx
X2xvY2spOwo+ICsJZ2VuNV9kaXNhYmxlX2d0X2lycShpOTE1LCBHVF9QQVJJVFlfRVJST1IoaTkx
NSkpOwo+ICsJc3Bpbl91bmxvY2soJmk5MTUtPmlycV9sb2NrKTsKPiAgIAo+IC0JaWlyICY9IEdU
X1BBUklUWV9FUlJPUihkZXZfcHJpdik7Cj4gKwlpaXIgJj0gR1RfUEFSSVRZX0VSUk9SKGk5MTUp
Owo+ICAgCWlmIChpaXIgJiBHVF9SRU5ERVJfTDNfUEFSSVRZX0VSUk9SX0lOVEVSUlVQVF9TMSkK
PiAtCQlkZXZfcHJpdi0+bDNfcGFyaXR5LndoaWNoX3NsaWNlIHw9IDEgPDwgMTsKPiArCQlpOTE1
LT5sM19wYXJpdHkud2hpY2hfc2xpY2UgfD0gMSA8PCAxOwo+ICAgCj4gICAJaWYgKGlpciAmIEdU
X1JFTkRFUl9MM19QQVJJVFlfRVJST1JfSU5URVJSVVBUKQo+IC0JCWRldl9wcml2LT5sM19wYXJp
dHkud2hpY2hfc2xpY2UgfD0gMSA8PCAwOwo+ICsJCWk5MTUtPmwzX3Bhcml0eS53aGljaF9zbGlj
ZSB8PSAxIDw8IDA7Cj4gICAKPiAtCXF1ZXVlX3dvcmsoZGV2X3ByaXYtPndxLCAmZGV2X3ByaXYt
PmwzX3Bhcml0eS5lcnJvcl93b3JrKTsKPiArCXF1ZXVlX3dvcmsoaTkxNS0+d3EsICZpOTE1LT5s
M19wYXJpdHkuZXJyb3Jfd29yayk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaWxrX2d0X2ly
cV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZv
aWQgaWxrX2d0X2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAg
CQkJICAgICAgIHUzMiBndF9paXIpCj4gICB7Cj4gICAJaWYgKGd0X2lpciAmIEdUX1JFTkRFUl9V
U0VSX0lOVEVSUlVQVCkKPiAtCQlpbnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNfaXJxKGRldl9wcml2
LT5lbmdpbmVbUkNTMF0pOwo+ICsJCWludGVsX2VuZ2luZV9icmVhZGNydW1ic19pcnEoaTkxNS0+
ZW5naW5lW1JDUzBdKTsKPiAgIAlpZiAoZ3RfaWlyICYgSUxLX0JTRF9VU0VSX0lOVEVSUlVQVCkK
PiAtCQlpbnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNfaXJxKGRldl9wcml2LT5lbmdpbmVbVkNTMF0p
Owo+ICsJCWludGVsX2VuZ2luZV9icmVhZGNydW1ic19pcnEoaTkxNS0+ZW5naW5lW1ZDUzBdKTsK
PiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBzbmJfZ3RfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBzbmJfZ3RfaXJxX2hhbmRsZXIo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICAgICAgdTMyIGd0X2lpcikK
PiAgIHsKPiAgIAlpZiAoZ3RfaWlyICYgR1RfUkVOREVSX1VTRVJfSU5URVJSVVBUKQo+IC0JCWlu
dGVsX2VuZ2luZV9icmVhZGNydW1ic19pcnEoZGV2X3ByaXYtPmVuZ2luZVtSQ1MwXSk7Cj4gKwkJ
aW50ZWxfZW5naW5lX2JyZWFkY3J1bWJzX2lycShpOTE1LT5lbmdpbmVbUkNTMF0pOwo+ICAgCWlm
IChndF9paXIgJiBHVF9CU0RfVVNFUl9JTlRFUlJVUFQpCj4gLQkJaW50ZWxfZW5naW5lX2JyZWFk
Y3J1bWJzX2lycShkZXZfcHJpdi0+ZW5naW5lW1ZDUzBdKTsKPiArCQlpbnRlbF9lbmdpbmVfYnJl
YWRjcnVtYnNfaXJxKGk5MTUtPmVuZ2luZVtWQ1MwXSk7Cj4gICAJaWYgKGd0X2lpciAmIEdUX0JM
VF9VU0VSX0lOVEVSUlVQVCkKPiAtCQlpbnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNfaXJxKGRldl9w
cml2LT5lbmdpbmVbQkNTMF0pOwo+ICsJCWludGVsX2VuZ2luZV9icmVhZGNydW1ic19pcnEoaTkx
NS0+ZW5naW5lW0JDUzBdKTsKPiAgIAo+ICAgCWlmIChndF9paXIgJiAoR1RfQkxUX0NTX0VSUk9S
X0lOVEVSUlVQVCB8Cj4gICAJCSAgICAgIEdUX0JTRF9DU19FUlJPUl9JTlRFUlJVUFQgfAo+ICAg
CQkgICAgICBHVF9SRU5ERVJfQ1NfTUFTVEVSX0VSUk9SX0lOVEVSUlVQVCkpCj4gICAJCURSTV9E
RUJVRygiQ29tbWFuZCBwYXJzZXIgZXJyb3IsIGd0X2lpciAweCUwOHhcbiIsIGd0X2lpcik7Cj4g
ICAKPiAtCWlmIChndF9paXIgJiBHVF9QQVJJVFlfRVJST1IoZGV2X3ByaXYpKQo+IC0JCWl2eWJy
aWRnZV9wYXJpdHlfZXJyb3JfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIGd0X2lpcik7Cj4gKwlpZiAo
Z3RfaWlyICYgR1RfUEFSSVRZX0VSUk9SKGk5MTUpKQo+ICsJCWl2eWJyaWRnZV9wYXJpdHlfZXJy
b3JfaXJxX2hhbmRsZXIoaTkxNSwgZ3RfaWlyKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQK
PiBAQCAtMTc2Myw3ICsxNzYzLDcgQEAgc3RhdGljIGJvb2wgaTl4eF9wb3J0X2hvdHBsdWdfbG9u
Z19kZXRlY3QoZW51bSBocGRfcGluIHBpbiwgdTMyIHZhbCkKPiAgICAqCj4gICAgKiBOb3RlIHRo
YXQgdGhlIGNhbGxlciBpcyBleHBlY3RlZCB0byB6ZXJvIG91dCB0aGUgbWFza3MgaW5pdGlhbGx5
Lgo+ICAgICovCj4gLXN0YXRpYyB2b2lkIGludGVsX2dldF9ocGRfcGlucyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGludGVsX2dldF9ocGRfcGlucyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgICB1MzIgKnBpbl9tYXNr
LCB1MzIgKmxvbmdfbWFzaywKPiAgIAkJCSAgICAgICB1MzIgaG90cGx1Z190cmlnZ2VyLCB1MzIg
ZGlnX2hvdHBsdWdfcmVnLAo+ICAgCQkJICAgICAgIGNvbnN0IHUzMiBocGRbSFBEX05VTV9QSU5T
XSwKPiBAQCAtMTc4NiwyNSArMTc4NiwyNSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9nZXRfaHBkX3Bp
bnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCj4gICB9Cj4gICAKPiAt
c3RhdGljIHZvaWQgZ21idXNfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ICtzdGF0aWMgdm9pZCBnbWJ1c19pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXdha2VfdXBfYWxsKCZkZXZfcHJpdi0+Z21idXNfd2Fp
dF9xdWV1ZSk7Cj4gKwl3YWtlX3VwX2FsbCgmaTkxNS0+Z21idXNfd2FpdF9xdWV1ZSk7Cj4gICB9
Cj4gICAKPiAtc3RhdGljIHZvaWQgZHBfYXV4X2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgZHBfYXV4X2lycV9oYW5kbGVyKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jd2FrZV91cF9hbGwoJmRldl9wcml2
LT5nbWJ1c193YWl0X3F1ZXVlKTsKPiArCXdha2VfdXBfYWxsKCZpOTE1LT5nbWJ1c193YWl0X3F1
ZXVlKTsKPiAgIH0KPiAgIAo+ICAgI2lmIGRlZmluZWQoQ09ORklHX0RFQlVHX0ZTKQo+IC1zdGF0
aWMgdm9pZCBkaXNwbGF5X3BpcGVfY3JjX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgZGlzcGxheV9waXBlX2NyY19pcnFfaGFuZGxl
cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkJIGVudW0gcGlwZSBwaXBl
LAo+ICAgCQkJCQkgdTMyIGNyYzAsIHUzMiBjcmMxLAo+ICAgCQkJCQkgdTMyIGNyYzIsIHUzMiBj
cmMzLAo+ICAgCQkJCQkgdTMyIGNyYzQpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfcGlwZV9jcmMg
KnBpcGVfY3JjID0gJmRldl9wcml2LT5waXBlX2NyY1twaXBlXTsKPiAtCXN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIHBpcGUpOwo+ICsJ
c3RydWN0IGludGVsX3BpcGVfY3JjICpwaXBlX2NyYyA9ICZpOTE1LT5waXBlX2NyY1twaXBlXTsK
PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoaTkx
NSwgcGlwZSk7Cj4gICAJdTMyIGNyY3NbNV0gPSB7IGNyYzAsIGNyYzEsIGNyYzIsIGNyYzMsIGNy
YzQgfTsKPiAgIAo+ICAgCXRyYWNlX2ludGVsX3BpcGVfY3JjKGNydGMsIGNyY3MpOwo+IEBAIC0x
ODE5LDcgKzE4MTksNyBAQCBzdGF0aWMgdm9pZCBkaXNwbGF5X3BpcGVfY3JjX2lycV9oYW5kbGVy
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkgKiBkb24ndCB0cnVzdCB0
aGF0IG9uZSBlaXRoZXIuCj4gICAJICovCj4gICAJaWYgKHBpcGVfY3JjLT5za2lwcGVkIDw9IDAg
fHwKPiAtCSAgICAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA4ICYmIHBpcGVfY3JjLT5za2lwcGVk
ID09IDEpKSB7Cj4gKwkgICAgKElOVEVMX0dFTihpOTE1KSA+PSA4ICYmIHBpcGVfY3JjLT5za2lw
cGVkID09IDEpKSB7Cj4gICAJCXBpcGVfY3JjLT5za2lwcGVkKys7Cj4gICAJCXNwaW5fdW5sb2Nr
KCZwaXBlX2NyYy0+bG9jayk7Cj4gICAJCXJldHVybjsKPiBAQCAtMTgzMiw3ICsxODMyLDcgQEAg
c3RhdGljIHZvaWQgZGlzcGxheV9waXBlX2NyY19pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gICB9Cj4gICAjZWxzZQo+ICAgc3RhdGljIGlubGluZSB2b2lk
Cj4gLWRpc3BsYXlfcGlwZV9jcmNfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICtkaXNwbGF5X3BpcGVfY3JjX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgICBlbnVtIHBpcGUgcGlwZSwKPiAgIAkJCSAgICAg
dTMyIGNyYzAsIHUzMiBjcmMxLAo+ICAgCQkJICAgICB1MzIgY3JjMiwgdTMyIGNyYzMsCj4gQEAg
LTE4NDAsMTggKzE4NDAsMTggQEAgZGlzcGxheV9waXBlX2NyY19pcnFfaGFuZGxlcihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAjZW5kaWYKPiAgIAo+ICAgCj4gLXN0YXRp
YyB2b2lkIGhzd19waXBlX2NyY19pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGhzd19waXBlX2NyY19pcnFfaGFuZGxlcihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAgIGVudW0gcGlwZSBwaXBlKQo+ICAg
ewo+IC0JZGlzcGxheV9waXBlX2NyY19pcnFfaGFuZGxlcihkZXZfcHJpdiwgcGlwZSwKPiArCWRp
c3BsYXlfcGlwZV9jcmNfaXJxX2hhbmRsZXIoaTkxNSwgcGlwZSwKPiAgIAkJCQkgICAgIEk5MTVf
UkVBRChQSVBFX0NSQ19SRVNfMV9JVkIocGlwZSkpLAo+ICAgCQkJCSAgICAgMCwgMCwgMCwgMCk7
Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaXZiX3BpcGVfY3JjX2lycV9oYW5kbGVyKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgaXZiX3BpcGVfY3Jj
X2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgICAg
ZW51bSBwaXBlIHBpcGUpCj4gICB7Cj4gLQlkaXNwbGF5X3BpcGVfY3JjX2lycV9oYW5kbGVyKGRl
dl9wcml2LCBwaXBlLAo+ICsJZGlzcGxheV9waXBlX2NyY19pcnFfaGFuZGxlcihpOTE1LCBwaXBl
LAo+ICAgCQkJCSAgICAgSTkxNV9SRUFEKFBJUEVfQ1JDX1JFU18xX0lWQihwaXBlKSksCj4gICAJ
CQkJICAgICBJOTE1X1JFQUQoUElQRV9DUkNfUkVTXzJfSVZCKHBpcGUpKSwKPiAgIAkJCQkgICAg
IEk5MTVfUkVBRChQSVBFX0NSQ19SRVNfM19JVkIocGlwZSkpLAo+IEBAIC0xODU5LDIyICsxODU5
LDIyIEBAIHN0YXRpYyB2b2lkIGl2Yl9waXBlX2NyY19pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJCQkJICAgICBJOTE1X1JFQUQoUElQRV9DUkNfUkVT
XzVfSVZCKHBpcGUpKSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaTl4eF9waXBlX2NyY19p
cnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2
b2lkIGk5eHhfcGlwZV9jcmNfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gICAJCQkJICAgICAgZW51bSBwaXBlIHBpcGUpCj4gICB7Cj4gICAJdTMyIHJlczEsIHJl
czI7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDMpCj4gKwlpZiAoSU5URUxf
R0VOKGk5MTUpID49IDMpCj4gICAJCXJlczEgPSBJOTE1X1JFQUQoUElQRV9DUkNfUkVTX1JFUzFf
STkxNShwaXBlKSk7Cj4gICAJZWxzZQo+ICAgCQlyZXMxID0gMDsKPiAgIAo+IC0JaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPj0gNSB8fCBJU19HNFgoZGV2X3ByaXYpKQo+ICsJaWYgKElOVEVMX0dF
TihpOTE1KSA+PSA1IHx8IElTX0c0WChpOTE1KSkKPiAgIAkJcmVzMiA9IEk5MTVfUkVBRChQSVBF
X0NSQ19SRVNfUkVTMl9HNFgocGlwZSkpOwo+ICAgCWVsc2UKPiAgIAkJcmVzMiA9IDA7Cj4gICAK
PiAtCWRpc3BsYXlfcGlwZV9jcmNfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIHBpcGUsCj4gKwlkaXNw
bGF5X3BpcGVfY3JjX2lycV9oYW5kbGVyKGk5MTUsIHBpcGUsCj4gICAJCQkJICAgICBJOTE1X1JF
QUQoUElQRV9DUkNfUkVTX1JFRChwaXBlKSksCj4gICAJCQkJICAgICBJOTE1X1JFQUQoUElQRV9D
UkNfUkVTX0dSRUVOKHBpcGUpKSwKPiAgIAkJCQkgICAgIEk5MTVfUkVBRChQSVBFX0NSQ19SRVNf
QkxVRShwaXBlKSksCj4gQEAgLTE5MDMsMzQgKzE5MDMsMzQgQEAgc3RhdGljIHZvaWQgZ2VuMTFf
cnBzX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgcG1faWly
KQo+ICAgCXNjaGVkdWxlX3dvcmsoJnJwcy0+d29yayk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZv
aWQgZ2VuNl9ycHNfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LCB1MzIgcG1faWlyKQo+ICtzdGF0aWMgdm9pZCBnZW42X3Jwc19pcnFfaGFuZGxlcihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIHBtX2lpcikKPiAgIHsKPiAtCXN0cnVjdCBpbnRl
bF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwo+ICsJc3RydWN0IGludGVsX3JwcyAq
cnBzID0gJmk5MTUtPmd0X3BtLnJwczsKPiAgIAo+IC0JaWYgKHBtX2lpciAmIGRldl9wcml2LT5w
bV9ycHNfZXZlbnRzKSB7Cj4gLQkJc3Bpbl9sb2NrKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+IC0J
CWdlbjZfbWFza19wbV9pcnEoZGV2X3ByaXYsIHBtX2lpciAmIGRldl9wcml2LT5wbV9ycHNfZXZl
bnRzKTsKPiArCWlmIChwbV9paXIgJiBpOTE1LT5wbV9ycHNfZXZlbnRzKSB7Cj4gKwkJc3Bpbl9s
b2NrKCZpOTE1LT5pcnFfbG9jayk7Cj4gKwkJZ2VuNl9tYXNrX3BtX2lycShpOTE1LCBwbV9paXIg
JiBpOTE1LT5wbV9ycHNfZXZlbnRzKTsKPiAgIAkJaWYgKHJwcy0+aW50ZXJydXB0c19lbmFibGVk
KSB7Cj4gLQkJCXJwcy0+cG1faWlyIHw9IHBtX2lpciAmIGRldl9wcml2LT5wbV9ycHNfZXZlbnRz
Owo+ICsJCQlycHMtPnBtX2lpciB8PSBwbV9paXIgJiBpOTE1LT5wbV9ycHNfZXZlbnRzOwo+ICAg
CQkJc2NoZWR1bGVfd29yaygmcnBzLT53b3JrKTsKPiAgIAkJfQo+IC0JCXNwaW5fdW5sb2NrKCZk
ZXZfcHJpdi0+aXJxX2xvY2spOwo+ICsJCXNwaW5fdW5sb2NrKCZpOTE1LT5pcnFfbG9jayk7Cj4g
ICAJfQo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA4KQo+ICsJaWYgKElOVEVM
X0dFTihpOTE1KSA+PSA4KQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAlpZiAocG1faWlyICYgUE1f
VkVCT1hfVVNFUl9JTlRFUlJVUFQpCj4gLQkJaW50ZWxfZW5naW5lX2JyZWFkY3J1bWJzX2lycShk
ZXZfcHJpdi0+ZW5naW5lW1ZFQ1MwXSk7Cj4gKwkJaW50ZWxfZW5naW5lX2JyZWFkY3J1bWJzX2ly
cShpOTE1LT5lbmdpbmVbVkVDUzBdKTsKPiAgIAo+ICAgCWlmIChwbV9paXIgJiBQTV9WRUJPWF9D
U19FUlJPUl9JTlRFUlJVUFQpCj4gICAJCURSTV9ERUJVRygiQ29tbWFuZCBwYXJzZXIgZXJyb3Is
IHBtX2lpciAweCUwOHhcbiIsIHBtX2lpcik7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgZ2Vu
OV9ndWNfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIg
Z3RfaWlyKQo+ICtzdGF0aWMgdm9pZCBnZW45X2d1Y19pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIGd0X2lpcikKPiAgIHsKPiAgIAlpZiAoZ3RfaWlyICYgR0VO
OV9HVUNfVE9fSE9TVF9JTlRfRVZFTlQpCj4gLQkJaW50ZWxfZ3VjX3RvX2hvc3RfZXZlbnRfaGFu
ZGxlcigmZGV2X3ByaXYtPmd1Yyk7Cj4gKwkJaW50ZWxfZ3VjX3RvX2hvc3RfZXZlbnRfaGFuZGxl
cigmaTkxNS0+Z3VjKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgZ2VuMTFfZ3VjX2lycV9o
YW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MTYgaWlyKQo+IEBAIC0xOTM5
LDMyICsxOTM5LDMyIEBAIHN0YXRpYyB2b2lkIGdlbjExX2d1Y19pcnFfaGFuZGxlcihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTE2IGlpcikKPiAgIAkJaW50ZWxfZ3VjX3RvX2hvc3Rf
ZXZlbnRfaGFuZGxlcigmaTkxNS0+Z3VjKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpOXh4
X3BpcGVzdGF0X2lycV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
K3N0YXRpYyB2b2lkIGk5eHhfcGlwZXN0YXRfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ICAgewo+ICAgCWVudW0gcGlwZSBwaXBlOwo+ICAgCj4gLQlmb3JfZWFjaF9w
aXBlKGRldl9wcml2LCBwaXBlKSB7Cj4gKwlmb3JfZWFjaF9waXBlKGk5MTUsIHBpcGUpIHsKPiAg
IAkJSTkxNV9XUklURShQSVBFU1RBVChwaXBlKSwKPiAgIAkJCSAgIFBJUEVTVEFUX0lOVF9TVEFU
VVNfTUFTSyB8Cj4gICAJCQkgICBQSVBFX0ZJRk9fVU5ERVJSVU5fU1RBVFVTKTsKPiAgIAo+IC0J
CWRldl9wcml2LT5waXBlc3RhdF9pcnFfbWFza1twaXBlXSA9IDA7Cj4gKwkJaTkxNS0+cGlwZXN0
YXRfaXJxX21hc2tbcGlwZV0gPSAwOwo+ICAgCX0KPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBp
OXh4X3BpcGVzdGF0X2lycV9hY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICtzdGF0aWMgdm9pZCBpOXh4X3BpcGVzdGF0X2lycV9hY2soc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gICAJCQkJICB1MzIgaWlyLCB1MzIgcGlwZV9zdGF0c1tJOTE1X01BWF9QSVBF
U10pCj4gICB7Cj4gICAJaW50IHBpcGU7Cj4gICAKPiAtCXNwaW5fbG9jaygmZGV2X3ByaXYtPmly
cV9sb2NrKTsKPiArCXNwaW5fbG9jaygmaTkxNS0+aXJxX2xvY2spOwo+ICAgCj4gLQlpZiAoIWRl
dl9wcml2LT5kaXNwbGF5X2lycXNfZW5hYmxlZCkgewo+IC0JCXNwaW5fdW5sb2NrKCZkZXZfcHJp
di0+aXJxX2xvY2spOwo+ICsJaWYgKCFpOTE1LT5kaXNwbGF5X2lycXNfZW5hYmxlZCkgewo+ICsJ
CXNwaW5fdW5sb2NrKCZpOTE1LT5pcnFfbG9jayk7Cj4gICAJCXJldHVybjsKPiAgIAl9Cj4gICAK
PiAtCWZvcl9lYWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpIHsKPiArCWZvcl9lYWNoX3BpcGUoaTkx
NSwgcGlwZSkgewo+ICAgCQlpOTE1X3JlZ190IHJlZzsKPiAgIAkJdTMyIHN0YXR1c19tYXNrLCBl
bmFibGVfbWFzaywgaWlyX2JpdCA9IDA7Cj4gICAKPiBAQCAtMTk5MSwxNCArMTk5MSwxNCBAQCBz
dGF0aWMgdm9pZCBpOXh4X3BpcGVzdGF0X2lycV9hY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICAgCQkJYnJlYWs7Cj4gICAJCX0KPiAgIAkJaWYgKGlpciAmIGlpcl9iaXQp
Cj4gLQkJCXN0YXR1c19tYXNrIHw9IGRldl9wcml2LT5waXBlc3RhdF9pcnFfbWFza1twaXBlXTsK
PiArCQkJc3RhdHVzX21hc2sgfD0gaTkxNS0+cGlwZXN0YXRfaXJxX21hc2tbcGlwZV07Cj4gICAK
PiAgIAkJaWYgKCFzdGF0dXNfbWFzaykKPiAgIAkJCWNvbnRpbnVlOwo+ICAgCj4gICAJCXJlZyA9
IFBJUEVTVEFUKHBpcGUpOwo+ICAgCQlwaXBlX3N0YXRzW3BpcGVdID0gSTkxNV9SRUFEKHJlZykg
JiBzdGF0dXNfbWFzazsKPiAtCQllbmFibGVfbWFzayA9IGk5MTVfcGlwZXN0YXRfZW5hYmxlX21h
c2soZGV2X3ByaXYsIHBpcGUpOwo+ICsJCWVuYWJsZV9tYXNrID0gaTkxNV9waXBlc3RhdF9lbmFi
bGVfbWFzayhpOTE1LCBwaXBlKTsKPiAgIAo+ICAgCQkvKgo+ICAgCQkgKiBDbGVhciB0aGUgUElQ
RSpTVEFUIHJlZ3MgYmVmb3JlIHRoZSBJSVIKPiBAQCAtMjAxNCwxMDQgKzIwMTQsMTA0IEBAIHN0
YXRpYyB2b2lkIGk5eHhfcGlwZXN0YXRfaXJxX2FjayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gICAJCQlJOTE1X1dSSVRFKHJlZywgZW5hYmxlX21hc2spOwo+ICAgCQl9Cj4g
ICAJfQo+IC0Jc3Bpbl91bmxvY2soJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gKwlzcGluX3VubG9j
aygmaTkxNS0+aXJxX2xvY2spOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGk4eHhfcGlwZXN0
YXRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0
aWMgdm9pZCBpOHh4X3BpcGVzdGF0X2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAo+ICAgCQkJCSAgICAgIHUxNiBpaXIsIHUzMiBwaXBlX3N0YXRzW0k5MTVfTUFYX1BJ
UEVTXSkKPiAgIHsKPiAgIAllbnVtIHBpcGUgcGlwZTsKPiAgIAo+IC0JZm9yX2VhY2hfcGlwZShk
ZXZfcHJpdiwgcGlwZSkgewo+ICsJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKSB7Cj4gICAJCWlm
IChwaXBlX3N0YXRzW3BpcGVdICYgUElQRV9WQkxBTktfSU5URVJSVVBUX1NUQVRVUykKPiAtCQkJ
ZHJtX2hhbmRsZV92YmxhbmsoJmRldl9wcml2LT5kcm0sIHBpcGUpOwo+ICsJCQlkcm1faGFuZGxl
X3ZibGFuaygmaTkxNS0+ZHJtLCBwaXBlKTsKPiAgIAo+ICAgCQlpZiAocGlwZV9zdGF0c1twaXBl
XSAmIFBJUEVfQ1JDX0RPTkVfSU5URVJSVVBUX1NUQVRVUykKPiAtCQkJaTl4eF9waXBlX2NyY19p
cnFfaGFuZGxlcihkZXZfcHJpdiwgcGlwZSk7Cj4gKwkJCWk5eHhfcGlwZV9jcmNfaXJxX2hhbmRs
ZXIoaTkxNSwgcGlwZSk7Cj4gICAKPiAgIAkJaWYgKHBpcGVfc3RhdHNbcGlwZV0gJiBQSVBFX0ZJ
Rk9fVU5ERVJSVU5fU1RBVFVTKQo+IC0JCQlpbnRlbF9jcHVfZmlmb191bmRlcnJ1bl9pcnFfaGFu
ZGxlcihkZXZfcHJpdiwgcGlwZSk7Cj4gKwkJCWludGVsX2NwdV9maWZvX3VuZGVycnVuX2lycV9o
YW5kbGVyKGk5MTUsIHBpcGUpOwo+ICAgCX0KPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpOTE1
X3BpcGVzdGF0X2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiArc3RhdGljIHZvaWQgaTkxNV9waXBlc3RhdF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAgICB1MzIgaWlyLCB1MzIgcGlwZV9zdGF0c1tJOTE1
X01BWF9QSVBFU10pCj4gICB7Cj4gICAJYm9vbCBibGNfZXZlbnQgPSBmYWxzZTsKPiAgIAllbnVt
IHBpcGUgcGlwZTsKPiAgIAo+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkgewo+ICsJ
Zm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKSB7Cj4gICAJCWlmIChwaXBlX3N0YXRzW3BpcGVdICYg
UElQRV9WQkxBTktfSU5URVJSVVBUX1NUQVRVUykKPiAtCQkJZHJtX2hhbmRsZV92YmxhbmsoJmRl
dl9wcml2LT5kcm0sIHBpcGUpOwo+ICsJCQlkcm1faGFuZGxlX3ZibGFuaygmaTkxNS0+ZHJtLCBw
aXBlKTsKPiAgIAo+ICAgCQlpZiAocGlwZV9zdGF0c1twaXBlXSAmIFBJUEVfTEVHQUNZX0JMQ19F
VkVOVF9TVEFUVVMpCj4gICAJCQlibGNfZXZlbnQgPSB0cnVlOwo+ICAgCj4gICAJCWlmIChwaXBl
X3N0YXRzW3BpcGVdICYgUElQRV9DUkNfRE9ORV9JTlRFUlJVUFRfU1RBVFVTKQo+IC0JCQlpOXh4
X3BpcGVfY3JjX2lycV9oYW5kbGVyKGRldl9wcml2LCBwaXBlKTsKPiArCQkJaTl4eF9waXBlX2Ny
Y19pcnFfaGFuZGxlcihpOTE1LCBwaXBlKTsKPiAgIAo+ICAgCQlpZiAocGlwZV9zdGF0c1twaXBl
XSAmIFBJUEVfRklGT19VTkRFUlJVTl9TVEFUVVMpCj4gLQkJCWludGVsX2NwdV9maWZvX3VuZGVy
cnVuX2lycV9oYW5kbGVyKGRldl9wcml2LCBwaXBlKTsKPiArCQkJaW50ZWxfY3B1X2ZpZm9fdW5k
ZXJydW5faXJxX2hhbmRsZXIoaTkxNSwgcGlwZSk7Cj4gICAJfQo+ICAgCj4gICAJaWYgKGJsY19l
dmVudCB8fCAoaWlyICYgSTkxNV9BU0xFX0lOVEVSUlVQVCkpCj4gLQkJaW50ZWxfb3ByZWdpb25f
YXNsZV9pbnRyKGRldl9wcml2KTsKPiArCQlpbnRlbF9vcHJlZ2lvbl9hc2xlX2ludHIoaTkxNSk7
Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaTk2NV9waXBlc3RhdF9pcnFfaGFuZGxlcihzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGk5NjVfcGlwZXN0
YXRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAg
ICAgdTMyIGlpciwgdTMyIHBpcGVfc3RhdHNbSTkxNV9NQVhfUElQRVNdKQo+ICAgewo+ICAgCWJv
b2wgYmxjX2V2ZW50ID0gZmFsc2U7Cj4gICAJZW51bSBwaXBlIHBpcGU7Cj4gICAKPiAtCWZvcl9l
YWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpIHsKPiArCWZvcl9lYWNoX3BpcGUoaTkxNSwgcGlwZSkg
ewo+ICAgCQlpZiAocGlwZV9zdGF0c1twaXBlXSAmIFBJUEVfU1RBUlRfVkJMQU5LX0lOVEVSUlVQ
VF9TVEFUVVMpCj4gLQkJCWRybV9oYW5kbGVfdmJsYW5rKCZkZXZfcHJpdi0+ZHJtLCBwaXBlKTsK
PiArCQkJZHJtX2hhbmRsZV92YmxhbmsoJmk5MTUtPmRybSwgcGlwZSk7Cj4gICAKPiAgIAkJaWYg
KHBpcGVfc3RhdHNbcGlwZV0gJiBQSVBFX0xFR0FDWV9CTENfRVZFTlRfU1RBVFVTKQo+ICAgCQkJ
YmxjX2V2ZW50ID0gdHJ1ZTsKPiAgIAo+ICAgCQlpZiAocGlwZV9zdGF0c1twaXBlXSAmIFBJUEVf
Q1JDX0RPTkVfSU5URVJSVVBUX1NUQVRVUykKPiAtCQkJaTl4eF9waXBlX2NyY19pcnFfaGFuZGxl
cihkZXZfcHJpdiwgcGlwZSk7Cj4gKwkJCWk5eHhfcGlwZV9jcmNfaXJxX2hhbmRsZXIoaTkxNSwg
cGlwZSk7Cj4gICAKPiAgIAkJaWYgKHBpcGVfc3RhdHNbcGlwZV0gJiBQSVBFX0ZJRk9fVU5ERVJS
VU5fU1RBVFVTKQo+IC0JCQlpbnRlbF9jcHVfZmlmb191bmRlcnJ1bl9pcnFfaGFuZGxlcihkZXZf
cHJpdiwgcGlwZSk7Cj4gKwkJCWludGVsX2NwdV9maWZvX3VuZGVycnVuX2lycV9oYW5kbGVyKGk5
MTUsIHBpcGUpOwo+ICAgCX0KPiAgIAo+ICAgCWlmIChibGNfZXZlbnQgfHwgKGlpciAmIEk5MTVf
QVNMRV9JTlRFUlJVUFQpKQo+IC0JCWludGVsX29wcmVnaW9uX2FzbGVfaW50cihkZXZfcHJpdik7
Cj4gKwkJaW50ZWxfb3ByZWdpb25fYXNsZV9pbnRyKGk5MTUpOwo+ICAgCj4gICAJaWYgKHBpcGVf
c3RhdHNbMF0gJiBQSVBFX0dNQlVTX0lOVEVSUlVQVF9TVEFUVVMpCj4gLQkJZ21idXNfaXJxX2hh
bmRsZXIoZGV2X3ByaXYpOwo+ICsJCWdtYnVzX2lycV9oYW5kbGVyKGk5MTUpOwo+ICAgfQo+ICAg
Cj4gLXN0YXRpYyB2b2lkIHZhbGxleXZpZXdfcGlwZXN0YXRfaXJxX2hhbmRsZXIoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCB2YWxsZXl2aWV3X3BpcGVz
dGF0X2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCQkg
ICAgdTMyIHBpcGVfc3RhdHNbSTkxNV9NQVhfUElQRVNdKQo+ICAgewo+ICAgCWVudW0gcGlwZSBw
aXBlOwo+ICAgCj4gLQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKSB7Cj4gKwlmb3JfZWFj
aF9waXBlKGk5MTUsIHBpcGUpIHsKPiAgIAkJaWYgKHBpcGVfc3RhdHNbcGlwZV0gJiBQSVBFX1NU
QVJUX1ZCTEFOS19JTlRFUlJVUFRfU1RBVFVTKQo+IC0JCQlkcm1faGFuZGxlX3ZibGFuaygmZGV2
X3ByaXYtPmRybSwgcGlwZSk7Cj4gKwkJCWRybV9oYW5kbGVfdmJsYW5rKCZpOTE1LT5kcm0sIHBp
cGUpOwo+ICAgCj4gICAJCWlmIChwaXBlX3N0YXRzW3BpcGVdICYgUElQRV9DUkNfRE9ORV9JTlRF
UlJVUFRfU1RBVFVTKQo+IC0JCQlpOXh4X3BpcGVfY3JjX2lycV9oYW5kbGVyKGRldl9wcml2LCBw
aXBlKTsKPiArCQkJaTl4eF9waXBlX2NyY19pcnFfaGFuZGxlcihpOTE1LCBwaXBlKTsKPiAgIAo+
ICAgCQlpZiAocGlwZV9zdGF0c1twaXBlXSAmIFBJUEVfRklGT19VTkRFUlJVTl9TVEFUVVMpCj4g
LQkJCWludGVsX2NwdV9maWZvX3VuZGVycnVuX2lycV9oYW5kbGVyKGRldl9wcml2LCBwaXBlKTsK
PiArCQkJaW50ZWxfY3B1X2ZpZm9fdW5kZXJydW5faXJxX2hhbmRsZXIoaTkxNSwgcGlwZSk7Cj4g
ICAJfQo+ICAgCj4gICAJaWYgKHBpcGVfc3RhdHNbMF0gJiBQSVBFX0dNQlVTX0lOVEVSUlVQVF9T
VEFUVVMpCj4gLQkJZ21idXNfaXJxX2hhbmRsZXIoZGV2X3ByaXYpOwo+ICsJCWdtYnVzX2lycV9o
YW5kbGVyKGk5MTUpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB1MzIgaTl4eF9ocGRfaXJxX2Fjayhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB1MzIgaTl4eF9ocGRf
aXJxX2FjayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAl1MzIgaG90
cGx1Z19zdGF0dXMgPSAwLCBob3RwbHVnX3N0YXR1c19tYXNrOwo+ICAgCWludCBpOwo+ICAgCj4g
LQlpZiAoSVNfRzRYKGRldl9wcml2KSB8fAo+IC0JICAgIElTX1ZBTExFWVZJRVcoZGV2X3ByaXYp
IHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ICsJaWYgKElTX0c0WChpOTE1KSB8fAo+ICsJ
ICAgIElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiAgIAkJaG90
cGx1Z19zdGF0dXNfbWFzayA9IEhPVFBMVUdfSU5UX1NUQVRVU19HNFggfAo+ICAgCQkJRFBfQVVY
X0NIQU5ORUxfTUFTS19JTlRfU1RBVFVTX0c0WDsKPiAgIAllbHNlCj4gQEAgLTIxNDMsMzUgKzIx
NDMsMzUgQEAgc3RhdGljIHUzMiBpOXh4X2hwZF9pcnFfYWNrKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiAgIAlyZXR1cm4gaG90cGx1Z19zdGF0dXM7Cj4gICB9Cj4gICAKPiAt
c3RhdGljIHZvaWQgaTl4eF9ocGRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBpOXh4X2hwZF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgdTMyIGhvdHBsdWdfc3RhdHVzKQo+ICAgewo+
ICAgCXUzMiBwaW5fbWFzayA9IDAsIGxvbmdfbWFzayA9IDA7Cj4gICAKPiAtCWlmIChJU19HNFgo
ZGV2X3ByaXYpIHx8IElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8Cj4gLQkgICAgSVNfQ0hFUlJZ
VklFVyhkZXZfcHJpdikpIHsKPiArCWlmIChJU19HNFgoaTkxNSkgfHwgSVNfVkFMTEVZVklFVyhp
OTE1KSB8fAo+ICsJICAgIElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiAgIAkJdTMyIGhvdHBsdWdf
dHJpZ2dlciA9IGhvdHBsdWdfc3RhdHVzICYgSE9UUExVR19JTlRfU1RBVFVTX0c0WDsKPiAgIAo+
ICAgCQlpZiAoaG90cGx1Z190cmlnZ2VyKSB7Cj4gLQkJCWludGVsX2dldF9ocGRfcGlucyhkZXZf
cHJpdiwgJnBpbl9tYXNrLCAmbG9uZ19tYXNrLAo+ICsJCQlpbnRlbF9nZXRfaHBkX3BpbnMoaTkx
NSwgJnBpbl9tYXNrLCAmbG9uZ19tYXNrLAo+ICAgCQkJCQkgICBob3RwbHVnX3RyaWdnZXIsIGhv
dHBsdWdfdHJpZ2dlciwKPiAgIAkJCQkJICAgaHBkX3N0YXR1c19nNHgsCj4gICAJCQkJCSAgIGk5
eHhfcG9ydF9ob3RwbHVnX2xvbmdfZGV0ZWN0KTsKPiAgIAo+IC0JCQlpbnRlbF9ocGRfaXJxX2hh
bmRsZXIoZGV2X3ByaXYsIHBpbl9tYXNrLCBsb25nX21hc2spOwo+ICsJCQlpbnRlbF9ocGRfaXJx
X2hhbmRsZXIoaTkxNSwgcGluX21hc2ssIGxvbmdfbWFzayk7Cj4gICAJCX0KPiAgIAo+ICAgCQlp
ZiAoaG90cGx1Z19zdGF0dXMgJiBEUF9BVVhfQ0hBTk5FTF9NQVNLX0lOVF9TVEFUVVNfRzRYKQo+
IC0JCQlkcF9hdXhfaXJxX2hhbmRsZXIoZGV2X3ByaXYpOwo+ICsJCQlkcF9hdXhfaXJxX2hhbmRs
ZXIoaTkxNSk7Cj4gICAJfSBlbHNlIHsKPiAgIAkJdTMyIGhvdHBsdWdfdHJpZ2dlciA9IGhvdHBs
dWdfc3RhdHVzICYgSE9UUExVR19JTlRfU1RBVFVTX0k5MTU7Cj4gICAKPiAgIAkJaWYgKGhvdHBs
dWdfdHJpZ2dlcikgewo+IC0JCQlpbnRlbF9nZXRfaHBkX3BpbnMoZGV2X3ByaXYsICZwaW5fbWFz
aywgJmxvbmdfbWFzaywKPiArCQkJaW50ZWxfZ2V0X2hwZF9waW5zKGk5MTUsICZwaW5fbWFzaywg
JmxvbmdfbWFzaywKPiAgIAkJCQkJICAgaG90cGx1Z190cmlnZ2VyLCBob3RwbHVnX3RyaWdnZXIs
Cj4gICAJCQkJCSAgIGhwZF9zdGF0dXNfaTkxNSwKPiAgIAkJCQkJICAgaTl4eF9wb3J0X2hvdHBs
dWdfbG9uZ19kZXRlY3QpOwo+IC0JCQlpbnRlbF9ocGRfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIHBp
bl9tYXNrLCBsb25nX21hc2spOwo+ICsJCQlpbnRlbF9ocGRfaXJxX2hhbmRsZXIoaTkxNSwgcGlu
X21hc2ssIGxvbmdfbWFzayk7Cj4gICAJCX0KPiAgIAl9Cj4gICB9Cj4gQEAgLTIxNzksMTQgKzIx
NzksMTQgQEAgc3RhdGljIHZvaWQgaTl4eF9ocGRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgc3RhdGljIGlycXJldHVybl90IHZhbGxleXZpZXdfaXJx
X2hhbmRsZXIoaW50IGlycSwgdm9pZCAqYXJnKQo+ICAgewo+ICAgCXN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYgPSBhcmc7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2
KTsKPiAgIAlpcnFyZXR1cm5fdCByZXQgPSBJUlFfTk9ORTsKPiAgIAo+IC0JaWYgKCFpbnRlbF9p
cnFzX2VuYWJsZWQoZGV2X3ByaXYpKQo+ICsJaWYgKCFpbnRlbF9pcnFzX2VuYWJsZWQoaTkxNSkp
Cj4gICAJCXJldHVybiBJUlFfTk9ORTsKPiAgIAo+ICAgCS8qIElSUXMgYXJlIHN5bmNlZCBkdXJp
bmcgcnVudGltZV9zdXNwZW5kLCB3ZSBkb24ndCByZXF1aXJlIGEgd2FrZXJlZiAqLwo+IC0JZGlz
YWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGRldl9wcml2KTsKPiArCWRpc2FibGVfcnBtX3dha2Vy
ZWZfYXNzZXJ0cyhpOTE1KTsKPiAgIAo+ICAgCWRvIHsKPiAgIAkJdTMyIGlpciwgZ3RfaWlyLCBw
bV9paXI7Cj4gQEAgLTIyMjYsMTUgKzIyMjYsMTUgQEAgc3RhdGljIGlycXJldHVybl90IHZhbGxl
eXZpZXdfaXJxX2hhbmRsZXIoaW50IGlycSwgdm9pZCAqYXJnKQo+ICAgCQkJSTkxNV9XUklURShH
RU42X1BNSUlSLCBwbV9paXIpOwo+ICAgCj4gICAJCWlmIChpaXIgJiBJOTE1X0RJU1BMQVlfUE9S
VF9JTlRFUlJVUFQpCj4gLQkJCWhvdHBsdWdfc3RhdHVzID0gaTl4eF9ocGRfaXJxX2FjayhkZXZf
cHJpdik7Cj4gKwkJCWhvdHBsdWdfc3RhdHVzID0gaTl4eF9ocGRfaXJxX2FjayhpOTE1KTsKPiAg
IAo+ICAgCQkvKiBDYWxsIHJlZ2FyZGxlc3MsIGFzIHNvbWUgc3RhdHVzIGJpdHMgbWlnaHQgbm90
IGJlCj4gICAJCSAqIHNpZ25hbGxlZCBpbiBpaXIgKi8KPiAtCQlpOXh4X3BpcGVzdGF0X2lycV9h
Y2soZGV2X3ByaXYsIGlpciwgcGlwZV9zdGF0cyk7Cj4gKwkJaTl4eF9waXBlc3RhdF9pcnFfYWNr
KGk5MTUsIGlpciwgcGlwZV9zdGF0cyk7Cj4gICAKPiAgIAkJaWYgKGlpciAmIChJOTE1X0xQRV9Q
SVBFX0FfSU5URVJSVVBUIHwKPiAgIAkJCSAgIEk5MTVfTFBFX1BJUEVfQl9JTlRFUlJVUFQpKQo+
IC0JCQlpbnRlbF9scGVfYXVkaW9faXJxX2hhbmRsZXIoZGV2X3ByaXYpOwo+ICsJCQlpbnRlbF9s
cGVfYXVkaW9faXJxX2hhbmRsZXIoaTkxNSk7Cj4gICAKPiAgIAkJLyoKPiAgIAkJICogVkxWX0lJ
UiBpcyBzaW5nbGUgYnVmZmVyZWQsIGFuZCByZWZsZWN0cyB0aGUgbGV2ZWwKPiBAQCAtMjI0Nywx
NyArMjI0NywxNyBAQCBzdGF0aWMgaXJxcmV0dXJuX3QgdmFsbGV5dmlld19pcnFfaGFuZGxlcihp
bnQgaXJxLCB2b2lkICphcmcpCj4gICAJCUk5MTVfV1JJVEUoVkxWX01BU1RFUl9JRVIsIE1BU1RF
Ul9JTlRFUlJVUFRfRU5BQkxFKTsKPiAgIAo+ICAgCQlpZiAoZ3RfaWlyKQo+IC0JCQlzbmJfZ3Rf
aXJxX2hhbmRsZXIoZGV2X3ByaXYsIGd0X2lpcik7Cj4gKwkJCXNuYl9ndF9pcnFfaGFuZGxlcihp
OTE1LCBndF9paXIpOwo+ICAgCQlpZiAocG1faWlyKQo+IC0JCQlnZW42X3Jwc19pcnFfaGFuZGxl
cihkZXZfcHJpdiwgcG1faWlyKTsKPiArCQkJZ2VuNl9ycHNfaXJxX2hhbmRsZXIoaTkxNSwgcG1f
aWlyKTsKPiAgIAo+ICAgCQlpZiAoaG90cGx1Z19zdGF0dXMpCj4gLQkJCWk5eHhfaHBkX2lycV9o
YW5kbGVyKGRldl9wcml2LCBob3RwbHVnX3N0YXR1cyk7Cj4gKwkJCWk5eHhfaHBkX2lycV9oYW5k
bGVyKGk5MTUsIGhvdHBsdWdfc3RhdHVzKTsKPiAgIAo+IC0JCXZhbGxleXZpZXdfcGlwZXN0YXRf
aXJxX2hhbmRsZXIoZGV2X3ByaXYsIHBpcGVfc3RhdHMpOwo+ICsJCXZhbGxleXZpZXdfcGlwZXN0
YXRfaXJxX2hhbmRsZXIoaTkxNSwgcGlwZV9zdGF0cyk7Cj4gICAJfSB3aGlsZSAoMCk7Cj4gICAK
PiAtCWVuYWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGRldl9wcml2KTsKPiArCWVuYWJsZV9ycG1f
d2FrZXJlZl9hc3NlcnRzKGk5MTUpOwo+ICAgCj4gICAJcmV0dXJuIHJldDsKPiAgIH0KPiBAQCAt
MjI2NSwxNCArMjI2NSwxNCBAQCBzdGF0aWMgaXJxcmV0dXJuX3QgdmFsbGV5dmlld19pcnFfaGFu
ZGxlcihpbnQgaXJxLCB2b2lkICphcmcpCj4gICBzdGF0aWMgaXJxcmV0dXJuX3QgY2hlcnJ5dmll
d19pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcpCj4gICB7Cj4gICAJc3RydWN0IGRybV9k
ZXZpY2UgKmRldiA9IGFyZzsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShkZXYpOwo+ICAgCWlycXJldHVybl90IHJldCA9IElSUV9OT05FOwo+ICAgCj4gLQlpZiAoIWlu
dGVsX2lycXNfZW5hYmxlZChkZXZfcHJpdikpCj4gKwlpZiAoIWludGVsX2lycXNfZW5hYmxlZChp
OTE1KSkKPiAgIAkJcmV0dXJuIElSUV9OT05FOwo+ICAgCj4gICAJLyogSVJRcyBhcmUgc3luY2Vk
IGR1cmluZyBydW50aW1lX3N1c3BlbmQsIHdlIGRvbid0IHJlcXVpcmUgYSB3YWtlcmVmICovCj4g
LQlkaXNhYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoZGV2X3ByaXYpOwo+ICsJZGlzYWJsZV9ycG1f
d2FrZXJlZl9hc3NlcnRzKGk5MTUpOwo+ICAgCj4gICAJZG8gewo+ICAgCQl1MzIgbWFzdGVyX2N0
bCwgaWlyOwo+IEBAIC0yMzA2LDE5ICsyMzA2LDE5IEBAIHN0YXRpYyBpcnFyZXR1cm5fdCBjaGVy
cnl2aWV3X2lycV9oYW5kbGVyKGludCBpcnEsIHZvaWQgKmFyZykKPiAgIAkJaWVyID0gSTkxNV9S
RUFEKFZMVl9JRVIpOwo+ICAgCQlJOTE1X1dSSVRFKFZMVl9JRVIsIDApOwo+ICAgCj4gLQkJZ2Vu
OF9ndF9pcnFfYWNrKGRldl9wcml2LCBtYXN0ZXJfY3RsLCBndF9paXIpOwo+ICsJCWdlbjhfZ3Rf
aXJxX2FjayhpOTE1LCBtYXN0ZXJfY3RsLCBndF9paXIpOwo+ICAgCj4gICAJCWlmIChpaXIgJiBJ
OTE1X0RJU1BMQVlfUE9SVF9JTlRFUlJVUFQpCj4gLQkJCWhvdHBsdWdfc3RhdHVzID0gaTl4eF9o
cGRfaXJxX2FjayhkZXZfcHJpdik7Cj4gKwkJCWhvdHBsdWdfc3RhdHVzID0gaTl4eF9ocGRfaXJx
X2FjayhpOTE1KTsKPiAgIAo+ICAgCQkvKiBDYWxsIHJlZ2FyZGxlc3MsIGFzIHNvbWUgc3RhdHVz
IGJpdHMgbWlnaHQgbm90IGJlCj4gICAJCSAqIHNpZ25hbGxlZCBpbiBpaXIgKi8KPiAtCQlpOXh4
X3BpcGVzdGF0X2lycV9hY2soZGV2X3ByaXYsIGlpciwgcGlwZV9zdGF0cyk7Cj4gKwkJaTl4eF9w
aXBlc3RhdF9pcnFfYWNrKGk5MTUsIGlpciwgcGlwZV9zdGF0cyk7Cj4gICAKPiAgIAkJaWYgKGlp
ciAmIChJOTE1X0xQRV9QSVBFX0FfSU5URVJSVVBUIHwKPiAgIAkJCSAgIEk5MTVfTFBFX1BJUEVf
Ql9JTlRFUlJVUFQgfAo+ICAgCQkJICAgSTkxNV9MUEVfUElQRV9DX0lOVEVSUlVQVCkpCj4gLQkJ
CWludGVsX2xwZV9hdWRpb19pcnFfaGFuZGxlcihkZXZfcHJpdik7Cj4gKwkJCWludGVsX2xwZV9h
dWRpb19pcnFfaGFuZGxlcihpOTE1KTsKPiAgIAo+ICAgCQkvKgo+ICAgCQkgKiBWTFZfSUlSIGlz
IHNpbmdsZSBidWZmZXJlZCwgYW5kIHJlZmxlY3RzIHRoZSBsZXZlbAo+IEBAIC0yMzMwLDIwICsy
MzMwLDIwIEBAIHN0YXRpYyBpcnFyZXR1cm5fdCBjaGVycnl2aWV3X2lycV9oYW5kbGVyKGludCBp
cnEsIHZvaWQgKmFyZykKPiAgIAkJSTkxNV9XUklURShWTFZfSUVSLCBpZXIpOwo+ICAgCQlJOTE1
X1dSSVRFKEdFTjhfTUFTVEVSX0lSUSwgR0VOOF9NQVNURVJfSVJRX0NPTlRST0wpOwo+ICAgCj4g
LQkJZ2VuOF9ndF9pcnFfaGFuZGxlcihkZXZfcHJpdiwgbWFzdGVyX2N0bCwgZ3RfaWlyKTsKPiAr
CQlnZW44X2d0X2lycV9oYW5kbGVyKGk5MTUsIG1hc3Rlcl9jdGwsIGd0X2lpcik7Cj4gICAKPiAg
IAkJaWYgKGhvdHBsdWdfc3RhdHVzKQo+IC0JCQlpOXh4X2hwZF9pcnFfaGFuZGxlcihkZXZfcHJp
diwgaG90cGx1Z19zdGF0dXMpOwo+ICsJCQlpOXh4X2hwZF9pcnFfaGFuZGxlcihpOTE1LCBob3Rw
bHVnX3N0YXR1cyk7Cj4gICAKPiAtCQl2YWxsZXl2aWV3X3BpcGVzdGF0X2lycV9oYW5kbGVyKGRl
dl9wcml2LCBwaXBlX3N0YXRzKTsKPiArCQl2YWxsZXl2aWV3X3BpcGVzdGF0X2lycV9oYW5kbGVy
KGk5MTUsIHBpcGVfc3RhdHMpOwo+ICAgCX0gd2hpbGUgKDApOwo+ICAgCj4gLQllbmFibGVfcnBt
X3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7Cj4gKwllbmFibGVfcnBtX3dha2VyZWZfYXNzZXJ0
cyhpOTE1KTsKPiAgIAo+ICAgCXJldHVybiByZXQ7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQg
aWJ4X2hwZF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
K3N0YXRpYyB2b2lkIGlieF9ocGRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCj4gICAJCQkJdTMyIGhvdHBsdWdfdHJpZ2dlciwKPiAgIAkJCQljb25zdCB1MzIgaHBk
W0hQRF9OVU1fUElOU10pCj4gICB7Cj4gQEAgLTIzNjgsMTkgKzIzNjgsMTkgQEAgc3RhdGljIHZv
aWQgaWJ4X2hwZF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gICAJaWYgKCFob3RwbHVnX3RyaWdnZXIpCj4gICAJCXJldHVybjsKPiAgIAo+IC0JaW50ZWxf
Z2V0X2hwZF9waW5zKGRldl9wcml2LCAmcGluX21hc2ssICZsb25nX21hc2ssIGhvdHBsdWdfdHJp
Z2dlciwKPiArCWludGVsX2dldF9ocGRfcGlucyhpOTE1LCAmcGluX21hc2ssICZsb25nX21hc2ss
IGhvdHBsdWdfdHJpZ2dlciwKPiAgIAkJCSAgIGRpZ19ob3RwbHVnX3JlZywgaHBkLAo+ICAgCQkJ
ICAgcGNoX3BvcnRfaG90cGx1Z19sb25nX2RldGVjdCk7Cj4gICAKPiAtCWludGVsX2hwZF9pcnFf
aGFuZGxlcihkZXZfcHJpdiwgcGluX21hc2ssIGxvbmdfbWFzayk7Cj4gKwlpbnRlbF9ocGRfaXJx
X2hhbmRsZXIoaTkxNSwgcGluX21hc2ssIGxvbmdfbWFzayk7Cj4gICB9Cj4gICAKPiAtc3RhdGlj
IHZvaWQgaWJ4X2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwg
dTMyIHBjaF9paXIpCj4gK3N0YXRpYyB2b2lkIGlieF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIHBjaF9paXIpCj4gICB7Cj4gICAJaW50IHBpcGU7Cj4gICAJ
dTMyIGhvdHBsdWdfdHJpZ2dlciA9IHBjaF9paXIgJiBTREVfSE9UUExVR19NQVNLOwo+ICAgCj4g
LQlpYnhfaHBkX2lycV9oYW5kbGVyKGRldl9wcml2LCBob3RwbHVnX3RyaWdnZXIsIGhwZF9pYngp
Owo+ICsJaWJ4X2hwZF9pcnFfaGFuZGxlcihpOTE1LCBob3RwbHVnX3RyaWdnZXIsIGhwZF9pYngp
Owo+ICAgCj4gICAJaWYgKHBjaF9paXIgJiBTREVfQVVESU9fUE9XRVJfTUFTSykgewo+ICAgCQlp
bnQgcG9ydCA9IGZmcygocGNoX2lpciAmIFNERV9BVURJT19QT1dFUl9NQVNLKSA+Pgo+IEBAIC0y
MzkwLDEwICsyMzkwLDEwIEBAIHN0YXRpYyB2b2lkIGlieF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBwY2hfaWlyKQo+ICAgCX0KPiAgIAo+ICAgCWlm
IChwY2hfaWlyICYgU0RFX0FVWF9NQVNLKQo+IC0JCWRwX2F1eF9pcnFfaGFuZGxlcihkZXZfcHJp
dik7Cj4gKwkJZHBfYXV4X2lycV9oYW5kbGVyKGk5MTUpOwo+ICAgCj4gICAJaWYgKHBjaF9paXIg
JiBTREVfR01CVVMpCj4gLQkJZ21idXNfaXJxX2hhbmRsZXIoZGV2X3ByaXYpOwo+ICsJCWdtYnVz
X2lycV9oYW5kbGVyKGk5MTUpOwo+ICAgCj4gICAJaWYgKHBjaF9paXIgJiBTREVfQVVESU9fSERD
UF9NQVNLKQo+ICAgCQlEUk1fREVCVUdfRFJJVkVSKCJQQ0ggSERDUCBhdWRpbyBpbnRlcnJ1cHRc
biIpOwo+IEBAIC0yNDA1LDcgKzI0MDUsNyBAQCBzdGF0aWMgdm9pZCBpYnhfaXJxX2hhbmRsZXIo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgcGNoX2lpcikKPiAgIAkJRFJN
X0VSUk9SKCJQQ0ggcG9pc29uIGludGVycnVwdFxuIik7Cj4gICAKPiAgIAlpZiAocGNoX2lpciAm
IFNERV9GRElfTUFTSykKPiAtCQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKQo+ICsJCWZv
cl9lYWNoX3BpcGUoaTkxNSwgcGlwZSkKPiAgIAkJCURSTV9ERUJVR19EUklWRVIoIiAgcGlwZSAl
YyBGREkgSUlSOiAweCUwOHhcbiIsCj4gICAJCQkJCSBwaXBlX25hbWUocGlwZSksCj4gICAJCQkJ
CSBJOTE1X1JFQUQoRkRJX1JYX0lJUihwaXBlKSkpOwo+IEBAIC0yNDE3LDEzICsyNDE3LDEzIEBA
IHN0YXRpYyB2b2lkIGlieF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsIHUzMiBwY2hfaWlyKQo+ICAgCQlEUk1fREVCVUdfRFJJVkVSKCJQQ0ggdHJhbnNjb2Rl
ciBDUkMgZXJyb3IgaW50ZXJydXB0XG4iKTsKPiAgIAo+ICAgCWlmIChwY2hfaWlyICYgU0RFX1RS
QU5TQV9GSUZPX1VOREVSKQo+IC0JCWludGVsX3BjaF9maWZvX3VuZGVycnVuX2lycV9oYW5kbGVy
KGRldl9wcml2LCBQSVBFX0EpOwo+ICsJCWludGVsX3BjaF9maWZvX3VuZGVycnVuX2lycV9oYW5k
bGVyKGk5MTUsIFBJUEVfQSk7Cj4gICAKPiAgIAlpZiAocGNoX2lpciAmIFNERV9UUkFOU0JfRklG
T19VTkRFUikKPiAtCQlpbnRlbF9wY2hfZmlmb191bmRlcnJ1bl9pcnFfaGFuZGxlcihkZXZfcHJp
diwgUElQRV9CKTsKPiArCQlpbnRlbF9wY2hfZmlmb191bmRlcnJ1bl9pcnFfaGFuZGxlcihpOTE1
LCBQSVBFX0IpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGl2Yl9lcnJfaW50X2hhbmRsZXIo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBpdmJfZXJy
X2ludF9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUz
MiBlcnJfaW50ID0gSTkxNV9SRUFEKEdFTjdfRVJSX0lOVCk7Cj4gICAJZW51bSBwaXBlIHBpcGU7
Cj4gQEAgLTI0MzEsMjIgKzI0MzEsMjIgQEAgc3RhdGljIHZvaWQgaXZiX2Vycl9pbnRfaGFuZGxl
cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJaWYgKGVycl9pbnQgJiBF
UlJfSU5UX1BPSVNPTikKPiAgIAkJRFJNX0VSUk9SKCJQb2lzb24gaW50ZXJydXB0XG4iKTsKPiAg
IAo+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkgewo+ICsJZm9yX2VhY2hfcGlwZShp
OTE1LCBwaXBlKSB7Cj4gICAJCWlmIChlcnJfaW50ICYgRVJSX0lOVF9GSUZPX1VOREVSUlVOKHBp
cGUpKQo+IC0JCQlpbnRlbF9jcHVfZmlmb191bmRlcnJ1bl9pcnFfaGFuZGxlcihkZXZfcHJpdiwg
cGlwZSk7Cj4gKwkJCWludGVsX2NwdV9maWZvX3VuZGVycnVuX2lycV9oYW5kbGVyKGk5MTUsIHBp
cGUpOwo+ICAgCj4gICAJCWlmIChlcnJfaW50ICYgRVJSX0lOVF9QSVBFX0NSQ19ET05FKHBpcGUp
KSB7Cj4gLQkJCWlmIChJU19JVllCUklER0UoZGV2X3ByaXYpKQo+IC0JCQkJaXZiX3BpcGVfY3Jj
X2lycV9oYW5kbGVyKGRldl9wcml2LCBwaXBlKTsKPiArCQkJaWYgKElTX0lWWUJSSURHRShpOTE1
KSkKPiArCQkJCWl2Yl9waXBlX2NyY19pcnFfaGFuZGxlcihpOTE1LCBwaXBlKTsKPiAgIAkJCWVs
c2UKPiAtCQkJCWhzd19waXBlX2NyY19pcnFfaGFuZGxlcihkZXZfcHJpdiwgcGlwZSk7Cj4gKwkJ
CQloc3dfcGlwZV9jcmNfaXJxX2hhbmRsZXIoaTkxNSwgcGlwZSk7Cj4gICAJCX0KPiAgIAl9Cj4g
ICAKPiAgIAlJOTE1X1dSSVRFKEdFTjdfRVJSX0lOVCwgZXJyX2ludCk7Cj4gICB9Cj4gICAKPiAt
c3RhdGljIHZvaWQgY3B0X3NlcnJfaW50X2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBjcHRfc2Vycl9pbnRfaGFuZGxlcihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAl1MzIgc2Vycl9pbnQgPSBJOTE1X1JFQUQo
U0VSUl9JTlQpOwo+ICAgCWVudW0gcGlwZSBwaXBlOwo+IEBAIC0yNDU0LDE5ICsyNDU0LDE5IEBA
IHN0YXRpYyB2b2lkIGNwdF9zZXJyX2ludF9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiAgIAlpZiAoc2Vycl9pbnQgJiBTRVJSX0lOVF9QT0lTT04pCj4gICAJCURS
TV9FUlJPUigiUENIIHBvaXNvbiBpbnRlcnJ1cHRcbiIpOwo+ICAgCj4gLQlmb3JfZWFjaF9waXBl
KGRldl9wcml2LCBwaXBlKQo+ICsJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKQo+ICAgCQlpZiAo
c2Vycl9pbnQgJiBTRVJSX0lOVF9UUkFOU19GSUZPX1VOREVSUlVOKHBpcGUpKQo+IC0JCQlpbnRl
bF9wY2hfZmlmb191bmRlcnJ1bl9pcnFfaGFuZGxlcihkZXZfcHJpdiwgcGlwZSk7Cj4gKwkJCWlu
dGVsX3BjaF9maWZvX3VuZGVycnVuX2lycV9oYW5kbGVyKGk5MTUsIHBpcGUpOwo+ICAgCj4gICAJ
STkxNV9XUklURShTRVJSX0lOVCwgc2Vycl9pbnQpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lk
IGNwdF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBw
Y2hfaWlyKQo+ICtzdGF0aWMgdm9pZCBjcHRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsIHUzMiBwY2hfaWlyKQo+ICAgewo+ICAgCWludCBwaXBlOwo+ICAgCXUzMiBo
b3RwbHVnX3RyaWdnZXIgPSBwY2hfaWlyICYgU0RFX0hPVFBMVUdfTUFTS19DUFQ7Cj4gICAKPiAt
CWlieF9ocGRfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIGhvdHBsdWdfdHJpZ2dlciwgaHBkX2NwdCk7
Cj4gKwlpYnhfaHBkX2lycV9oYW5kbGVyKGk5MTUsIGhvdHBsdWdfdHJpZ2dlciwgaHBkX2NwdCk7
Cj4gICAKPiAgIAlpZiAocGNoX2lpciAmIFNERV9BVURJT19QT1dFUl9NQVNLX0NQVCkgewo+ICAg
CQlpbnQgcG9ydCA9IGZmcygocGNoX2lpciAmIFNERV9BVURJT19QT1dFUl9NQVNLX0NQVCkgPj4K
PiBAQCAtMjQ3NiwxMCArMjQ3NiwxMCBAQCBzdGF0aWMgdm9pZCBjcHRfaXJxX2hhbmRsZXIoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgcGNoX2lpcikKPiAgIAl9Cj4gICAK
PiAgIAlpZiAocGNoX2lpciAmIFNERV9BVVhfTUFTS19DUFQpCj4gLQkJZHBfYXV4X2lycV9oYW5k
bGVyKGRldl9wcml2KTsKPiArCQlkcF9hdXhfaXJxX2hhbmRsZXIoaTkxNSk7Cj4gICAKPiAgIAlp
ZiAocGNoX2lpciAmIFNERV9HTUJVU19DUFQpCj4gLQkJZ21idXNfaXJxX2hhbmRsZXIoZGV2X3By
aXYpOwo+ICsJCWdtYnVzX2lycV9oYW5kbGVyKGk5MTUpOwo+ICAgCj4gICAJaWYgKHBjaF9paXIg
JiBTREVfQVVESU9fQ1BfUkVRX0NQVCkKPiAgIAkJRFJNX0RFQlVHX0RSSVZFUigiQXVkaW8gQ1Ag
cmVxdWVzdCBpbnRlcnJ1cHRcbiIpOwo+IEBAIC0yNDg4LDE2ICsyNDg4LDE2IEBAIHN0YXRpYyB2
b2lkIGNwdF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUz
MiBwY2hfaWlyKQo+ICAgCQlEUk1fREVCVUdfRFJJVkVSKCJBdWRpbyBDUCBjaGFuZ2UgaW50ZXJy
dXB0XG4iKTsKPiAgIAo+ICAgCWlmIChwY2hfaWlyICYgU0RFX0ZESV9NQVNLX0NQVCkKPiAtCQlm
b3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKQo+ICsJCWZvcl9lYWNoX3BpcGUoaTkxNSwgcGlw
ZSkKPiAgIAkJCURSTV9ERUJVR19EUklWRVIoIiAgcGlwZSAlYyBGREkgSUlSOiAweCUwOHhcbiIs
Cj4gICAJCQkJCSBwaXBlX25hbWUocGlwZSksCj4gICAJCQkJCSBJOTE1X1JFQUQoRkRJX1JYX0lJ
UihwaXBlKSkpOwo+ICAgCj4gICAJaWYgKHBjaF9paXIgJiBTREVfRVJST1JfQ1BUKQo+IC0JCWNw
dF9zZXJyX2ludF9oYW5kbGVyKGRldl9wcml2KTsKPiArCQljcHRfc2Vycl9pbnRfaGFuZGxlcihp
OTE1KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpY3BfaXJxX2hhbmRsZXIoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgcGNoX2lpcikKPiArc3RhdGljIHZvaWQgaWNw
X2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgcGNoX2lpcikK
PiAgIHsKPiAgIAl1MzIgZGRpX2hvdHBsdWdfdHJpZ2dlciA9IHBjaF9paXIgJiBTREVfRERJX01B
U0tfSUNQOwo+ICAgCXUzMiB0Y19ob3RwbHVnX3RyaWdnZXIgPSBwY2hfaWlyICYgU0RFX1RDX01B
U0tfSUNQOwo+IEBAIC0yNTA5LDcgKzI1MDksNyBAQCBzdGF0aWMgdm9pZCBpY3BfaXJxX2hhbmRs
ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgcGNoX2lpcikKPiAgIAkJ
ZGlnX2hvdHBsdWdfcmVnID0gSTkxNV9SRUFEKFNIT1RQTFVHX0NUTF9EREkpOwo+ICAgCQlJOTE1
X1dSSVRFKFNIT1RQTFVHX0NUTF9EREksIGRpZ19ob3RwbHVnX3JlZyk7Cj4gICAKPiAtCQlpbnRl
bF9nZXRfaHBkX3BpbnMoZGV2X3ByaXYsICZwaW5fbWFzaywgJmxvbmdfbWFzaywKPiArCQlpbnRl
bF9nZXRfaHBkX3BpbnMoaTkxNSwgJnBpbl9tYXNrLCAmbG9uZ19tYXNrLAo+ICAgCQkJCSAgIGRk
aV9ob3RwbHVnX3RyaWdnZXIsCj4gICAJCQkJICAgZGlnX2hvdHBsdWdfcmVnLCBocGRfaWNwLAo+
ICAgCQkJCSAgIGljcF9kZGlfcG9ydF9ob3RwbHVnX2xvbmdfZGV0ZWN0KTsKPiBAQCAtMjUyMSwy
MCArMjUyMSwyMCBAQCBzdGF0aWMgdm9pZCBpY3BfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgcGNoX2lpcikKPiAgIAkJZGlnX2hvdHBsdWdfcmVnID0g
STkxNV9SRUFEKFNIT1RQTFVHX0NUTF9UQyk7Cj4gICAJCUk5MTVfV1JJVEUoU0hPVFBMVUdfQ1RM
X1RDLCBkaWdfaG90cGx1Z19yZWcpOwo+ICAgCj4gLQkJaW50ZWxfZ2V0X2hwZF9waW5zKGRldl9w
cml2LCAmcGluX21hc2ssICZsb25nX21hc2ssCj4gKwkJaW50ZWxfZ2V0X2hwZF9waW5zKGk5MTUs
ICZwaW5fbWFzaywgJmxvbmdfbWFzaywKPiAgIAkJCQkgICB0Y19ob3RwbHVnX3RyaWdnZXIsCj4g
ICAJCQkJICAgZGlnX2hvdHBsdWdfcmVnLCBocGRfaWNwLAo+ICAgCQkJCSAgIGljcF90Y19wb3J0
X2hvdHBsdWdfbG9uZ19kZXRlY3QpOwo+ICAgCX0KPiAgIAo+ICAgCWlmIChwaW5fbWFzaykKPiAt
CQlpbnRlbF9ocGRfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIHBpbl9tYXNrLCBsb25nX21hc2spOwo+
ICsJCWludGVsX2hwZF9pcnFfaGFuZGxlcihpOTE1LCBwaW5fbWFzaywgbG9uZ19tYXNrKTsKPiAg
IAo+ICAgCWlmIChwY2hfaWlyICYgU0RFX0dNQlVTX0lDUCkKPiAtCQlnbWJ1c19pcnFfaGFuZGxl
cihkZXZfcHJpdik7Cj4gKwkJZ21idXNfaXJxX2hhbmRsZXIoaTkxNSk7Cj4gICB9Cj4gICAKPiAt
c3RhdGljIHZvaWQgc3B0X2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwgdTMyIHBjaF9paXIpCj4gK3N0YXRpYyB2b2lkIHNwdF9pcnFfaGFuZGxlcihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIHBjaF9paXIpCj4gICB7Cj4gICAJdTMyIGhvdHBs
dWdfdHJpZ2dlciA9IHBjaF9paXIgJiBTREVfSE9UUExVR19NQVNLX1NQVCAmCj4gICAJCX5TREVf
UE9SVEVfSE9UUExVR19TUFQ7Cj4gQEAgLTI1NDcsNyArMjU0Nyw3IEBAIHN0YXRpYyB2b2lkIHNw
dF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBwY2hf
aWlyKQo+ICAgCQlkaWdfaG90cGx1Z19yZWcgPSBJOTE1X1JFQUQoUENIX1BPUlRfSE9UUExVRyk7
Cj4gICAJCUk5MTVfV1JJVEUoUENIX1BPUlRfSE9UUExVRywgZGlnX2hvdHBsdWdfcmVnKTsKPiAg
IAo+IC0JCWludGVsX2dldF9ocGRfcGlucyhkZXZfcHJpdiwgJnBpbl9tYXNrLCAmbG9uZ19tYXNr
LAo+ICsJCWludGVsX2dldF9ocGRfcGlucyhpOTE1LCAmcGluX21hc2ssICZsb25nX21hc2ssCj4g
ICAJCQkJICAgaG90cGx1Z190cmlnZ2VyLCBkaWdfaG90cGx1Z19yZWcsIGhwZF9zcHQsCj4gICAJ
CQkJICAgc3B0X3BvcnRfaG90cGx1Z19sb25nX2RldGVjdCk7Cj4gICAJfQo+IEBAIC0yNTU4LDE5
ICsyNTU4LDE5IEBAIHN0YXRpYyB2b2lkIHNwdF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBwY2hfaWlyKQo+ICAgCQlkaWdfaG90cGx1Z19yZWcgPSBJ
OTE1X1JFQUQoUENIX1BPUlRfSE9UUExVRzIpOwo+ICAgCQlJOTE1X1dSSVRFKFBDSF9QT1JUX0hP
VFBMVUcyLCBkaWdfaG90cGx1Z19yZWcpOwo+ICAgCj4gLQkJaW50ZWxfZ2V0X2hwZF9waW5zKGRl
dl9wcml2LCAmcGluX21hc2ssICZsb25nX21hc2ssCj4gKwkJaW50ZWxfZ2V0X2hwZF9waW5zKGk5
MTUsICZwaW5fbWFzaywgJmxvbmdfbWFzaywKPiAgIAkJCQkgICBob3RwbHVnMl90cmlnZ2VyLCBk
aWdfaG90cGx1Z19yZWcsIGhwZF9zcHQsCj4gICAJCQkJICAgc3B0X3BvcnRfaG90cGx1ZzJfbG9u
Z19kZXRlY3QpOwo+ICAgCX0KPiAgIAo+ICAgCWlmIChwaW5fbWFzaykKPiAtCQlpbnRlbF9ocGRf
aXJxX2hhbmRsZXIoZGV2X3ByaXYsIHBpbl9tYXNrLCBsb25nX21hc2spOwo+ICsJCWludGVsX2hw
ZF9pcnFfaGFuZGxlcihpOTE1LCBwaW5fbWFzaywgbG9uZ19tYXNrKTsKPiAgIAo+ICAgCWlmIChw
Y2hfaWlyICYgU0RFX0dNQlVTX0NQVCkKPiAtCQlnbWJ1c19pcnFfaGFuZGxlcihkZXZfcHJpdik7
Cj4gKwkJZ21idXNfaXJxX2hhbmRsZXIoaTkxNSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQg
aWxrX2hwZF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
K3N0YXRpYyB2b2lkIGlsa19ocGRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCj4gICAJCQkJdTMyIGhvdHBsdWdfdHJpZ2dlciwKPiAgIAkJCQljb25zdCB1MzIgaHBk
W0hQRF9OVU1fUElOU10pCj4gICB7Cj4gQEAgLTI1NzksOTQgKzI1NzksOTQgQEAgc3RhdGljIHZv
aWQgaWxrX2hwZF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gICAJZGlnX2hvdHBsdWdfcmVnID0gSTkxNV9SRUFEKERJR0lUQUxfUE9SVF9IT1RQTFVHX0NO
VFJMKTsKPiAgIAlJOTE1X1dSSVRFKERJR0lUQUxfUE9SVF9IT1RQTFVHX0NOVFJMLCBkaWdfaG90
cGx1Z19yZWcpOwo+ICAgCj4gLQlpbnRlbF9nZXRfaHBkX3BpbnMoZGV2X3ByaXYsICZwaW5fbWFz
aywgJmxvbmdfbWFzaywgaG90cGx1Z190cmlnZ2VyLAo+ICsJaW50ZWxfZ2V0X2hwZF9waW5zKGk5
MTUsICZwaW5fbWFzaywgJmxvbmdfbWFzaywgaG90cGx1Z190cmlnZ2VyLAo+ICAgCQkJICAgZGln
X2hvdHBsdWdfcmVnLCBocGQsCj4gICAJCQkgICBpbGtfcG9ydF9ob3RwbHVnX2xvbmdfZGV0ZWN0
KTsKPiAgIAo+IC0JaW50ZWxfaHBkX2lycV9oYW5kbGVyKGRldl9wcml2LCBwaW5fbWFzaywgbG9u
Z19tYXNrKTsKPiArCWludGVsX2hwZF9pcnFfaGFuZGxlcihpOTE1LCBwaW5fbWFzaywgbG9uZ19t
YXNrKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpbGtfZGlzcGxheV9pcnFfaGFuZGxlcihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGlsa19kaXNw
bGF5X2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAg
ICB1MzIgZGVfaWlyKQo+ICAgewo+ICAgCWVudW0gcGlwZSBwaXBlOwo+ICAgCXUzMiBob3RwbHVn
X3RyaWdnZXIgPSBkZV9paXIgJiBERV9EUF9BX0hPVFBMVUc7Cj4gICAKPiAgIAlpZiAoaG90cGx1
Z190cmlnZ2VyKQo+IC0JCWlsa19ocGRfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIGhvdHBsdWdfdHJp
Z2dlciwgaHBkX2lsayk7Cj4gKwkJaWxrX2hwZF9pcnFfaGFuZGxlcihpOTE1LCBob3RwbHVnX3Ry
aWdnZXIsIGhwZF9pbGspOwo+ICAgCj4gICAJaWYgKGRlX2lpciAmIERFX0FVWF9DSEFOTkVMX0Ep
Cj4gLQkJZHBfYXV4X2lycV9oYW5kbGVyKGRldl9wcml2KTsKPiArCQlkcF9hdXhfaXJxX2hhbmRs
ZXIoaTkxNSk7Cj4gICAKPiAgIAlpZiAoZGVfaWlyICYgREVfR1NFKQo+IC0JCWludGVsX29wcmVn
aW9uX2FzbGVfaW50cihkZXZfcHJpdik7Cj4gKwkJaW50ZWxfb3ByZWdpb25fYXNsZV9pbnRyKGk5
MTUpOwo+ICAgCj4gICAJaWYgKGRlX2lpciAmIERFX1BPSVNPTikKPiAgIAkJRFJNX0VSUk9SKCJQ
b2lzb24gaW50ZXJydXB0XG4iKTsKPiAgIAo+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlw
ZSkgewo+ICsJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKSB7Cj4gICAJCWlmIChkZV9paXIgJiBE
RV9QSVBFX1ZCTEFOSyhwaXBlKSkKPiAtCQkJZHJtX2hhbmRsZV92YmxhbmsoJmRldl9wcml2LT5k
cm0sIHBpcGUpOwo+ICsJCQlkcm1faGFuZGxlX3ZibGFuaygmaTkxNS0+ZHJtLCBwaXBlKTsKPiAg
IAo+ICAgCQlpZiAoZGVfaWlyICYgREVfUElQRV9GSUZPX1VOREVSUlVOKHBpcGUpKQo+IC0JCQlp
bnRlbF9jcHVfZmlmb191bmRlcnJ1bl9pcnFfaGFuZGxlcihkZXZfcHJpdiwgcGlwZSk7Cj4gKwkJ
CWludGVsX2NwdV9maWZvX3VuZGVycnVuX2lycV9oYW5kbGVyKGk5MTUsIHBpcGUpOwo+ICAgCj4g
ICAJCWlmIChkZV9paXIgJiBERV9QSVBFX0NSQ19ET05FKHBpcGUpKQo+IC0JCQlpOXh4X3BpcGVf
Y3JjX2lycV9oYW5kbGVyKGRldl9wcml2LCBwaXBlKTsKPiArCQkJaTl4eF9waXBlX2NyY19pcnFf
aGFuZGxlcihpOTE1LCBwaXBlKTsKPiAgIAl9Cj4gICAKPiAgIAkvKiBjaGVjayBldmVudCBmcm9t
IFBDSCAqLwo+ICAgCWlmIChkZV9paXIgJiBERV9QQ0hfRVZFTlQpIHsKPiAgIAkJdTMyIHBjaF9p
aXIgPSBJOTE1X1JFQUQoU0RFSUlSKTsKPiAgIAo+IC0JCWlmIChIQVNfUENIX0NQVChkZXZfcHJp
dikpCj4gLQkJCWNwdF9pcnFfaGFuZGxlcihkZXZfcHJpdiwgcGNoX2lpcik7Cj4gKwkJaWYgKEhB
U19QQ0hfQ1BUKGk5MTUpKQo+ICsJCQljcHRfaXJxX2hhbmRsZXIoaTkxNSwgcGNoX2lpcik7Cj4g
ICAJCWVsc2UKPiAtCQkJaWJ4X2lycV9oYW5kbGVyKGRldl9wcml2LCBwY2hfaWlyKTsKPiArCQkJ
aWJ4X2lycV9oYW5kbGVyKGk5MTUsIHBjaF9paXIpOwo+ICAgCj4gICAJCS8qIHNob3VsZCBjbGVh
ciBQQ0ggaG90cGx1ZyBldmVudCBiZWZvcmUgY2xlYXIgQ1BVIGlycSAqLwo+ICAgCQlJOTE1X1dS
SVRFKFNERUlJUiwgcGNoX2lpcik7Cj4gICAJfQo+ICAgCj4gLQlpZiAoSVNfR0VOKGRldl9wcml2
LCA1KSAmJiBkZV9paXIgJiBERV9QQ1VfRVZFTlQpCj4gLQkJaXJvbmxha2VfcnBzX2NoYW5nZV9p
cnFfaGFuZGxlcihkZXZfcHJpdik7Cj4gKwlpZiAoSVNfR0VOKGk5MTUsIDUpICYmIGRlX2lpciAm
IERFX1BDVV9FVkVOVCkKPiArCQlpcm9ubGFrZV9ycHNfY2hhbmdlX2lycV9oYW5kbGVyKGk5MTUp
Owo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGl2Yl9kaXNwbGF5X2lycV9oYW5kbGVyKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgaXZiX2Rpc3BsYXlf
aXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgIHUz
MiBkZV9paXIpCj4gICB7Cj4gICAJZW51bSBwaXBlIHBpcGU7Cj4gICAJdTMyIGhvdHBsdWdfdHJp
Z2dlciA9IGRlX2lpciAmIERFX0RQX0FfSE9UUExVR19JVkI7Cj4gICAKPiAgIAlpZiAoaG90cGx1
Z190cmlnZ2VyKQo+IC0JCWlsa19ocGRfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIGhvdHBsdWdfdHJp
Z2dlciwgaHBkX2l2Yik7Cj4gKwkJaWxrX2hwZF9pcnFfaGFuZGxlcihpOTE1LCBob3RwbHVnX3Ry
aWdnZXIsIGhwZF9pdmIpOwo+ICAgCj4gICAJaWYgKGRlX2lpciAmIERFX0VSUl9JTlRfSVZCKQo+
IC0JCWl2Yl9lcnJfaW50X2hhbmRsZXIoZGV2X3ByaXYpOwo+ICsJCWl2Yl9lcnJfaW50X2hhbmRs
ZXIoaTkxNSk7Cj4gICAKPiAgIAlpZiAoZGVfaWlyICYgREVfRURQX1BTUl9JTlRfSFNXKSB7Cj4g
ICAJCXUzMiBwc3JfaWlyID0gSTkxNV9SRUFEKEVEUF9QU1JfSUlSKTsKPiAgIAo+IC0JCWludGVs
X3Bzcl9pcnFfaGFuZGxlcihkZXZfcHJpdiwgcHNyX2lpcik7Cj4gKwkJaW50ZWxfcHNyX2lycV9o
YW5kbGVyKGk5MTUsIHBzcl9paXIpOwo+ICAgCQlJOTE1X1dSSVRFKEVEUF9QU1JfSUlSLCBwc3Jf
aWlyKTsKPiAgIAl9Cj4gICAKPiAgIAlpZiAoZGVfaWlyICYgREVfQVVYX0NIQU5ORUxfQV9JVkIp
Cj4gLQkJZHBfYXV4X2lycV9oYW5kbGVyKGRldl9wcml2KTsKPiArCQlkcF9hdXhfaXJxX2hhbmRs
ZXIoaTkxNSk7Cj4gICAKPiAgIAlpZiAoZGVfaWlyICYgREVfR1NFX0lWQikKPiAtCQlpbnRlbF9v
cHJlZ2lvbl9hc2xlX2ludHIoZGV2X3ByaXYpOwo+ICsJCWludGVsX29wcmVnaW9uX2FzbGVfaW50
cihpOTE1KTsKPiAgIAo+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkgewo+ICsJZm9y
X2VhY2hfcGlwZShpOTE1LCBwaXBlKSB7Cj4gICAJCWlmIChkZV9paXIgJiAoREVfUElQRV9WQkxB
TktfSVZCKHBpcGUpKSkKPiAtCQkJZHJtX2hhbmRsZV92YmxhbmsoJmRldl9wcml2LT5kcm0sIHBp
cGUpOwo+ICsJCQlkcm1faGFuZGxlX3ZibGFuaygmaTkxNS0+ZHJtLCBwaXBlKTsKPiAgIAl9Cj4g
ICAKPiAgIAkvKiBjaGVjayBldmVudCBmcm9tIFBDSCAqLwo+IC0JaWYgKCFIQVNfUENIX05PUChk
ZXZfcHJpdikgJiYgKGRlX2lpciAmIERFX1BDSF9FVkVOVF9JVkIpKSB7Cj4gKwlpZiAoIUhBU19Q
Q0hfTk9QKGk5MTUpICYmIChkZV9paXIgJiBERV9QQ0hfRVZFTlRfSVZCKSkgewo+ICAgCQl1MzIg
cGNoX2lpciA9IEk5MTVfUkVBRChTREVJSVIpOwo+ICAgCj4gLQkJY3B0X2lycV9oYW5kbGVyKGRl
dl9wcml2LCBwY2hfaWlyKTsKPiArCQljcHRfaXJxX2hhbmRsZXIoaTkxNSwgcGNoX2lpcik7Cj4g
ICAKPiAgIAkJLyogY2xlYXIgUENIIGhvdHBsdWcgZXZlbnQgYmVmb3JlIGNsZWFyIENQVSBpcnEg
Ki8KPiAgIAkJSTkxNV9XUklURShTREVJSVIsIHBjaF9paXIpOwo+IEBAIC0yNjg0LDE1ICsyNjg0
LDE1IEBAIHN0YXRpYyB2b2lkIGl2Yl9kaXNwbGF5X2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIHN0YXRpYyBpcnFyZXR1cm5fdCBpcm9ubGFrZV9pcnFf
aGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcpCj4gICB7Cj4gICAJc3RydWN0IGRybV9kZXZpY2Ug
KmRldiA9IGFyZzsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYp
Owo+ICAgCXUzMiBkZV9paXIsIGd0X2lpciwgZGVfaWVyLCBzZGVfaWVyID0gMDsKPiAgIAlpcnFy
ZXR1cm5fdCByZXQgPSBJUlFfTk9ORTsKPiAgIAo+IC0JaWYgKCFpbnRlbF9pcnFzX2VuYWJsZWQo
ZGV2X3ByaXYpKQo+ICsJaWYgKCFpbnRlbF9pcnFzX2VuYWJsZWQoaTkxNSkpCj4gICAJCXJldHVy
biBJUlFfTk9ORTsKPiAgIAo+ICAgCS8qIElSUXMgYXJlIHN5bmNlZCBkdXJpbmcgcnVudGltZV9z
dXNwZW5kLCB3ZSBkb24ndCByZXF1aXJlIGEgd2FrZXJlZiAqLwo+IC0JZGlzYWJsZV9ycG1fd2Fr
ZXJlZl9hc3NlcnRzKGRldl9wcml2KTsKPiArCWRpc2FibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhp
OTE1KTsKPiAgIAo+ICAgCS8qIGRpc2FibGUgbWFzdGVyIGludGVycnVwdCBiZWZvcmUgY2xlYXJp
bmcgaWlyICAqLwo+ICAgCWRlX2llciA9IEk5MTVfUkVBRChERUlFUik7Cj4gQEAgLTI3MDMsNyAr
MjcwMyw3IEBAIHN0YXRpYyBpcnFyZXR1cm5fdCBpcm9ubGFrZV9pcnFfaGFuZGxlcihpbnQgaXJx
LCB2b2lkICphcmcpCj4gICAJICogYWJsZSB0byBwcm9jZXNzIHRoZW0gYWZ0ZXIgd2UgcmVzdG9y
ZSBTREVJRVIgKGFzIHNvb24gYXMgd2UgcmVzdG9yZQo+ICAgCSAqIGl0LCB3ZSdsbCBnZXQgYW4g
aW50ZXJydXB0IGlmIFNERUlJUiBzdGlsbCBoYXMgc29tZXRoaW5nIHRvIHByb2Nlc3MKPiAgIAkg
KiBkdWUgdG8gaXRzIGJhY2sgcXVldWUpLiAqLwo+IC0JaWYgKCFIQVNfUENIX05PUChkZXZfcHJp
dikpIHsKPiArCWlmICghSEFTX1BDSF9OT1AoaTkxNSkpIHsKPiAgIAkJc2RlX2llciA9IEk5MTVf
UkVBRChTREVJRVIpOwo+ICAgCQlJOTE1X1dSSVRFKFNERUlFUiwgMCk7Cj4gICAJfQo+IEBAIC0y
NzE0LDQyICsyNzE0LDQyIEBAIHN0YXRpYyBpcnFyZXR1cm5fdCBpcm9ubGFrZV9pcnFfaGFuZGxl
cihpbnQgaXJxLCB2b2lkICphcmcpCj4gICAJaWYgKGd0X2lpcikgewo+ICAgCQlJOTE1X1dSSVRF
KEdUSUlSLCBndF9paXIpOwo+ICAgCQlyZXQgPSBJUlFfSEFORExFRDsKPiAtCQlpZiAoSU5URUxf
R0VOKGRldl9wcml2KSA+PSA2KQo+IC0JCQlzbmJfZ3RfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIGd0
X2lpcik7Cj4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA2KQo+ICsJCQlzbmJfZ3RfaXJxX2hh
bmRsZXIoaTkxNSwgZ3RfaWlyKTsKPiAgIAkJZWxzZQo+IC0JCQlpbGtfZ3RfaXJxX2hhbmRsZXIo
ZGV2X3ByaXYsIGd0X2lpcik7Cj4gKwkJCWlsa19ndF9pcnFfaGFuZGxlcihpOTE1LCBndF9paXIp
Owo+ICAgCX0KPiAgIAo+ICAgCWRlX2lpciA9IEk5MTVfUkVBRChERUlJUik7Cj4gICAJaWYgKGRl
X2lpcikgewo+ICAgCQlJOTE1X1dSSVRFKERFSUlSLCBkZV9paXIpOwo+ICAgCQlyZXQgPSBJUlFf
SEFORExFRDsKPiAtCQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA3KQo+IC0JCQlpdmJfZGlz
cGxheV9pcnFfaGFuZGxlcihkZXZfcHJpdiwgZGVfaWlyKTsKPiArCQlpZiAoSU5URUxfR0VOKGk5
MTUpID49IDcpCj4gKwkJCWl2Yl9kaXNwbGF5X2lycV9oYW5kbGVyKGk5MTUsIGRlX2lpcik7Cj4g
ICAJCWVsc2UKPiAtCQkJaWxrX2Rpc3BsYXlfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIGRlX2lpcik7
Cj4gKwkJCWlsa19kaXNwbGF5X2lycV9oYW5kbGVyKGk5MTUsIGRlX2lpcik7Cj4gICAJfQo+ICAg
Cj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA2KSB7Cj4gKwlpZiAoSU5URUxfR0VOKGk5
MTUpID49IDYpIHsKPiAgIAkJdTMyIHBtX2lpciA9IEk5MTVfUkVBRChHRU42X1BNSUlSKTsKPiAg
IAkJaWYgKHBtX2lpcikgewo+ICAgCQkJSTkxNV9XUklURShHRU42X1BNSUlSLCBwbV9paXIpOwo+
ICAgCQkJcmV0ID0gSVJRX0hBTkRMRUQ7Cj4gLQkJCWdlbjZfcnBzX2lycV9oYW5kbGVyKGRldl9w
cml2LCBwbV9paXIpOwo+ICsJCQlnZW42X3Jwc19pcnFfaGFuZGxlcihpOTE1LCBwbV9paXIpOwo+
ICAgCQl9Cj4gICAJfQo+ICAgCj4gICAJSTkxNV9XUklURShERUlFUiwgZGVfaWVyKTsKPiAtCWlm
ICghSEFTX1BDSF9OT1AoZGV2X3ByaXYpKQo+ICsJaWYgKCFIQVNfUENIX05PUChpOTE1KSkKPiAg
IAkJSTkxNV9XUklURShTREVJRVIsIHNkZV9pZXIpOwo+ICAgCj4gICAJLyogSVJRcyBhcmUgc3lu
Y2VkIGR1cmluZyBydW50aW1lX3N1c3BlbmQsIHdlIGRvbid0IHJlcXVpcmUgYSB3YWtlcmVmICov
Cj4gLQllbmFibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7Cj4gKwllbmFibGVfcnBt
X3dha2VyZWZfYXNzZXJ0cyhpOTE1KTsKPiAgIAo+ICAgCXJldHVybiByZXQ7Cj4gICB9Cj4gICAK
PiAtc3RhdGljIHZvaWQgYnh0X2hwZF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGJ4dF9ocGRfaXJxX2hhbmRsZXIoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJdTMyIGhvdHBsdWdfdHJpZ2dlciwKPiAgIAkJ
CQljb25zdCB1MzIgaHBkW0hQRF9OVU1fUElOU10pCj4gICB7Cj4gQEAgLTI3NTgsMTQgKzI3NTgs
MTQgQEAgc3RhdGljIHZvaWQgYnh0X2hwZF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gICAJZGlnX2hvdHBsdWdfcmVnID0gSTkxNV9SRUFEKFBDSF9QT1JU
X0hPVFBMVUcpOwo+ICAgCUk5MTVfV1JJVEUoUENIX1BPUlRfSE9UUExVRywgZGlnX2hvdHBsdWdf
cmVnKTsKPiAgIAo+IC0JaW50ZWxfZ2V0X2hwZF9waW5zKGRldl9wcml2LCAmcGluX21hc2ssICZs
b25nX21hc2ssIGhvdHBsdWdfdHJpZ2dlciwKPiArCWludGVsX2dldF9ocGRfcGlucyhpOTE1LCAm
cGluX21hc2ssICZsb25nX21hc2ssIGhvdHBsdWdfdHJpZ2dlciwKPiAgIAkJCSAgIGRpZ19ob3Rw
bHVnX3JlZywgaHBkLAo+ICAgCQkJICAgYnh0X3BvcnRfaG90cGx1Z19sb25nX2RldGVjdCk7Cj4g
ICAKPiAtCWludGVsX2hwZF9pcnFfaGFuZGxlcihkZXZfcHJpdiwgcGluX21hc2ssIGxvbmdfbWFz
ayk7Cj4gKwlpbnRlbF9ocGRfaXJxX2hhbmRsZXIoaTkxNSwgcGluX21hc2ssIGxvbmdfbWFzayk7
Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgZ2VuMTFfaHBkX2lycV9oYW5kbGVyKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIGlpcikKPiArc3RhdGljIHZvaWQgZ2VuMTFf
aHBkX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgaWlyKQo+
ICAgewo+ICAgCXUzMiBwaW5fbWFzayA9IDAsIGxvbmdfbWFzayA9IDA7Cj4gICAJdTMyIHRyaWdn
ZXJfdGMgPSBpaXIgJiBHRU4xMV9ERV9UQ19IT1RQTFVHX01BU0s7Cj4gQEAgLTI3NzcsNyArMjc3
Nyw3IEBAIHN0YXRpYyB2b2lkIGdlbjExX2hwZF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBpaXIpCj4gICAJCWRpZ19ob3RwbHVnX3JlZyA9IEk5MTVf
UkVBRChHRU4xMV9UQ19IT1RQTFVHX0NUTCk7Cj4gICAJCUk5MTVfV1JJVEUoR0VOMTFfVENfSE9U
UExVR19DVEwsIGRpZ19ob3RwbHVnX3JlZyk7Cj4gICAKPiAtCQlpbnRlbF9nZXRfaHBkX3BpbnMo
ZGV2X3ByaXYsICZwaW5fbWFzaywgJmxvbmdfbWFzaywgdHJpZ2dlcl90YywKPiArCQlpbnRlbF9n
ZXRfaHBkX3BpbnMoaTkxNSwgJnBpbl9tYXNrLCAmbG9uZ19tYXNrLCB0cmlnZ2VyX3RjLAo+ICAg
CQkJCSAgIGRpZ19ob3RwbHVnX3JlZywgaHBkX2dlbjExLAo+ICAgCQkJCSAgIGdlbjExX3BvcnRf
aG90cGx1Z19sb25nX2RldGVjdCk7Cj4gICAJfQo+IEBAIC0yNzg4LDMwICsyNzg4LDMwIEBAIHN0
YXRpYyB2b2lkIGdlbjExX2hwZF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsIHUzMiBpaXIpCj4gICAJCWRpZ19ob3RwbHVnX3JlZyA9IEk5MTVfUkVBRChHRU4x
MV9UQlRfSE9UUExVR19DVEwpOwo+ICAgCQlJOTE1X1dSSVRFKEdFTjExX1RCVF9IT1RQTFVHX0NU
TCwgZGlnX2hvdHBsdWdfcmVnKTsKPiAgIAo+IC0JCWludGVsX2dldF9ocGRfcGlucyhkZXZfcHJp
diwgJnBpbl9tYXNrLCAmbG9uZ19tYXNrLCB0cmlnZ2VyX3RidCwKPiArCQlpbnRlbF9nZXRfaHBk
X3BpbnMoaTkxNSwgJnBpbl9tYXNrLCAmbG9uZ19tYXNrLCB0cmlnZ2VyX3RidCwKPiAgIAkJCQkg
ICBkaWdfaG90cGx1Z19yZWcsIGhwZF9nZW4xMSwKPiAgIAkJCQkgICBnZW4xMV9wb3J0X2hvdHBs
dWdfbG9uZ19kZXRlY3QpOwo+ICAgCX0KPiAgIAo+ICAgCWlmIChwaW5fbWFzaykKPiAtCQlpbnRl
bF9ocGRfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIHBpbl9tYXNrLCBsb25nX21hc2spOwo+ICsJCWlu
dGVsX2hwZF9pcnFfaGFuZGxlcihpOTE1LCBwaW5fbWFzaywgbG9uZ19tYXNrKTsKPiAgIAllbHNl
Cj4gICAJCURSTV9FUlJPUigiVW5leHBlY3RlZCBERSBIUEQgaW50ZXJydXB0IDB4JTA4eFxuIiwg
aWlyKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdTMyIGdlbjhfZGVfcG9ydF9hdXhfbWFzayhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB1MzIgZ2VuOF9kZV9wb3J0
X2F1eF9tYXNrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUzMiBt
YXNrID0gR0VOOF9BVVhfQ0hBTk5FTF9BOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2
KSA+PSA5KQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ICAgCQltYXNrIHw9IEdFTjlf
QVVYX0NIQU5ORUxfQiB8Cj4gICAJCQlHRU45X0FVWF9DSEFOTkVMX0MgfAo+ICAgCQkJR0VOOV9B
VVhfQ0hBTk5FTF9EOwo+ICAgCj4gLQlpZiAoSVNfQ05MX1dJVEhfUE9SVF9GKGRldl9wcml2KSkK
PiArCWlmIChJU19DTkxfV0lUSF9QT1JUX0YoaTkxNSkpCj4gICAJCW1hc2sgfD0gQ05MX0FVWF9D
SEFOTkVMX0Y7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQo+ICsJaWYg
KElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiAgIAkJbWFzayB8PSBJQ0xfQVVYX0NIQU5ORUxfRSB8
Cj4gICAJCQlDTkxfQVVYX0NIQU5ORUxfRjsKPiAgIAo+IEBAIC0yODE5LDcgKzI4MTksNyBAQCBz
dGF0aWMgdTMyIGdlbjhfZGVfcG9ydF9hdXhfbWFzayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpcnFyZXR1cm5fdAo+IC1nZW44X2RlX2ly
cV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIG1hc3Rlcl9j
dGwpCj4gK2dlbjhfZGVfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
IHUzMiBtYXN0ZXJfY3RsKQo+ICAgewo+ICAgCWlycXJldHVybl90IHJldCA9IElSUV9OT05FOwo+
ICAgCXUzMiBpaXI7Cj4gQEAgLTI4MzQsMTQgKzI4MzQsMTQgQEAgZ2VuOF9kZV9pcnFfaGFuZGxl
cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBtYXN0ZXJfY3RsKQo+ICAg
CQkJcmV0ID0gSVJRX0hBTkRMRUQ7Cj4gICAKPiAgIAkJCWlmIChpaXIgJiBHRU44X0RFX01JU0Nf
R1NFKSB7Cj4gLQkJCQlpbnRlbF9vcHJlZ2lvbl9hc2xlX2ludHIoZGV2X3ByaXYpOwo+ICsJCQkJ
aW50ZWxfb3ByZWdpb25fYXNsZV9pbnRyKGk5MTUpOwo+ICAgCQkJCWZvdW5kID0gdHJ1ZTsKPiAg
IAkJCX0KPiAgIAo+ICAgCQkJaWYgKGlpciAmIEdFTjhfREVfRURQX1BTUikgewo+ICAgCQkJCXUz
MiBwc3JfaWlyID0gSTkxNV9SRUFEKEVEUF9QU1JfSUlSKTsKPiAgIAo+IC0JCQkJaW50ZWxfcHNy
X2lycV9oYW5kbGVyKGRldl9wcml2LCBwc3JfaWlyKTsKPiArCQkJCWludGVsX3Bzcl9pcnFfaGFu
ZGxlcihpOTE1LCBwc3JfaWlyKTsKPiAgIAkJCQlJOTE1X1dSSVRFKEVEUF9QU1JfSUlSLCBwc3Jf
aWlyKTsKPiAgIAkJCQlmb3VuZCA9IHRydWU7Cj4gICAJCQl9Cj4gQEAgLTI4NTMsMTIgKzI4NTMs
MTIgQEAgZ2VuOF9kZV9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsIHUzMiBtYXN0ZXJfY3RsKQo+ICAgCQkJRFJNX0VSUk9SKCJUaGUgbWFzdGVyIGNvbnRyb2wg
aW50ZXJydXB0IGxpZWQgKERFIE1JU0MpIVxuIik7Cj4gICAJfQo+ICAgCj4gLQlpZiAoSU5URUxf
R0VOKGRldl9wcml2KSA+PSAxMSAmJiAobWFzdGVyX2N0bCAmIEdFTjExX0RFX0hQRF9JUlEpKSB7
Cj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExICYmIChtYXN0ZXJfY3RsICYgR0VOMTFfREVf
SFBEX0lSUSkpIHsKPiAgIAkJaWlyID0gSTkxNV9SRUFEKEdFTjExX0RFX0hQRF9JSVIpOwo+ICAg
CQlpZiAoaWlyKSB7Cj4gICAJCQlJOTE1X1dSSVRFKEdFTjExX0RFX0hQRF9JSVIsIGlpcik7Cj4g
ICAJCQlyZXQgPSBJUlFfSEFORExFRDsKPiAtCQkJZ2VuMTFfaHBkX2lycV9oYW5kbGVyKGRldl9w
cml2LCBpaXIpOwo+ICsJCQlnZW4xMV9ocGRfaXJxX2hhbmRsZXIoaTkxNSwgaWlyKTsKPiAgIAkJ
fSBlbHNlIHsKPiAgIAkJCURSTV9FUlJPUigiVGhlIG1hc3RlciBjb250cm9sIGludGVycnVwdCBs
aWVkLCAoREUgSFBEKSFcbiIpOwo+ICAgCQl9Cj4gQEAgLTI4NzMsMjkgKzI4NzMsMjkgQEAgZ2Vu
OF9kZV9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBt
YXN0ZXJfY3RsKQo+ICAgCQkJSTkxNV9XUklURShHRU44X0RFX1BPUlRfSUlSLCBpaXIpOwo+ICAg
CQkJcmV0ID0gSVJRX0hBTkRMRUQ7Cj4gICAKPiAtCQkJaWYgKGlpciAmIGdlbjhfZGVfcG9ydF9h
dXhfbWFzayhkZXZfcHJpdikpIHsKPiAtCQkJCWRwX2F1eF9pcnFfaGFuZGxlcihkZXZfcHJpdik7
Cj4gKwkJCWlmIChpaXIgJiBnZW44X2RlX3BvcnRfYXV4X21hc2soaTkxNSkpIHsKPiArCQkJCWRw
X2F1eF9pcnFfaGFuZGxlcihpOTE1KTsKPiAgIAkJCQlmb3VuZCA9IHRydWU7Cj4gICAJCQl9Cj4g
ICAKPiAtCQkJaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKSB7Cj4gKwkJCWlmIChJU19HRU45X0xQ
KGk5MTUpKSB7Cj4gICAJCQkJdG1wX21hc2sgPSBpaXIgJiBCWFRfREVfUE9SVF9IT1RQTFVHX01B
U0s7Cj4gICAJCQkJaWYgKHRtcF9tYXNrKSB7Cj4gLQkJCQkJYnh0X2hwZF9pcnFfaGFuZGxlcihk
ZXZfcHJpdiwgdG1wX21hc2ssCj4gKwkJCQkJYnh0X2hwZF9pcnFfaGFuZGxlcihpOTE1LCB0bXBf
bWFzaywKPiAgIAkJCQkJCQkgICAgaHBkX2J4dCk7Cj4gICAJCQkJCWZvdW5kID0gdHJ1ZTsKPiAg
IAkJCQl9Cj4gLQkJCX0gZWxzZSBpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSkgewo+ICsJCQl9
IGVsc2UgaWYgKElTX0JST0FEV0VMTChpOTE1KSkgewo+ICAgCQkJCXRtcF9tYXNrID0gaWlyICYg
R0VOOF9QT1JUX0RQX0FfSE9UUExVRzsKPiAgIAkJCQlpZiAodG1wX21hc2spIHsKPiAtCQkJCQlp
bGtfaHBkX2lycV9oYW5kbGVyKGRldl9wcml2LAo+ICsJCQkJCWlsa19ocGRfaXJxX2hhbmRsZXIo
aTkxNSwKPiAgIAkJCQkJCQkgICAgdG1wX21hc2ssIGhwZF9iZHcpOwo+ICAgCQkJCQlmb3VuZCA9
IHRydWU7Cj4gICAJCQkJfQo+ICAgCQkJfQo+ICAgCj4gLQkJCWlmIChJU19HRU45X0xQKGRldl9w
cml2KSAmJiAoaWlyICYgQlhUX0RFX1BPUlRfR01CVVMpKSB7Cj4gLQkJCQlnbWJ1c19pcnFfaGFu
ZGxlcihkZXZfcHJpdik7Cj4gKwkJCWlmIChJU19HRU45X0xQKGk5MTUpICYmIChpaXIgJiBCWFRf
REVfUE9SVF9HTUJVUykpIHsKPiArCQkJCWdtYnVzX2lycV9oYW5kbGVyKGk5MTUpOwo+ICAgCQkJ
CWZvdW5kID0gdHJ1ZTsKPiAgIAkJCX0KPiAgIAo+IEBAIC0yOTA2LDcgKzI5MDYsNyBAQCBnZW44
X2RlX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIG1h
c3Rlcl9jdGwpCj4gICAJCQlEUk1fRVJST1IoIlRoZSBtYXN0ZXIgY29udHJvbCBpbnRlcnJ1cHQg
bGllZCAoREUgUE9SVCkhXG4iKTsKPiAgIAl9Cj4gICAKPiAtCWZvcl9lYWNoX3BpcGUoZGV2X3By
aXYsIHBpcGUpIHsKPiArCWZvcl9lYWNoX3BpcGUoaTkxNSwgcGlwZSkgewo+ICAgCQl1MzIgZmF1
bHRfZXJyb3JzOwo+ICAgCj4gICAJCWlmICghKG1hc3Rlcl9jdGwgJiBHRU44X0RFX1BJUEVfSVJR
KHBpcGUpKSkKPiBAQCAtMjkyMiwxNiArMjkyMiwxNiBAQCBnZW44X2RlX2lycV9oYW5kbGVyKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIG1hc3Rlcl9jdGwpCj4gICAJCUk5
MTVfV1JJVEUoR0VOOF9ERV9QSVBFX0lJUihwaXBlKSwgaWlyKTsKPiAgIAo+ICAgCQlpZiAoaWly
ICYgR0VOOF9QSVBFX1ZCTEFOSykKPiAtCQkJZHJtX2hhbmRsZV92YmxhbmsoJmRldl9wcml2LT5k
cm0sIHBpcGUpOwo+ICsJCQlkcm1faGFuZGxlX3ZibGFuaygmaTkxNS0+ZHJtLCBwaXBlKTsKPiAg
IAo+ICAgCQlpZiAoaWlyICYgR0VOOF9QSVBFX0NEQ0xLX0NSQ19ET05FKQo+IC0JCQloc3dfcGlw
ZV9jcmNfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIHBpcGUpOwo+ICsJCQloc3dfcGlwZV9jcmNfaXJx
X2hhbmRsZXIoaTkxNSwgcGlwZSk7Cj4gICAKPiAgIAkJaWYgKGlpciAmIEdFTjhfUElQRV9GSUZP
X1VOREVSUlVOKQo+IC0JCQlpbnRlbF9jcHVfZmlmb191bmRlcnJ1bl9pcnFfaGFuZGxlcihkZXZf
cHJpdiwgcGlwZSk7Cj4gKwkJCWludGVsX2NwdV9maWZvX3VuZGVycnVuX2lycV9oYW5kbGVyKGk5
MTUsIHBpcGUpOwo+ICAgCj4gICAJCWZhdWx0X2Vycm9ycyA9IGlpcjsKPiAtCQlpZiAoSU5URUxf
R0VOKGRldl9wcml2KSA+PSA5KQo+ICsJCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkKPiAgIAkJ
CWZhdWx0X2Vycm9ycyAmPSBHRU45X0RFX1BJUEVfSVJRX0ZBVUxUX0VSUk9SUzsKPiAgIAkJZWxz
ZQo+ICAgCQkJZmF1bHRfZXJyb3JzICY9IEdFTjhfREVfUElQRV9JUlFfRkFVTFRfRVJST1JTOwo+
IEBAIC0yOTQyLDcgKzI5NDIsNyBAQCBnZW44X2RlX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIG1hc3Rlcl9jdGwpCj4gICAJCQkJICBmYXVsdF9lcnJv
cnMpOwo+ICAgCX0KPiAgIAo+IC0JaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3ByaXYpICYmICFIQVNf
UENIX05PUChkZXZfcHJpdikgJiYKPiArCWlmIChIQVNfUENIX1NQTElUKGk5MTUpICYmICFIQVNf
UENIX05PUChpOTE1KSAmJgo+ICAgCSAgICBtYXN0ZXJfY3RsICYgR0VOOF9ERV9QQ0hfSVJRKSB7
Cj4gICAJCS8qCj4gICAJCSAqIEZJWE1FKEJEVyk6IEFzc3VtZSBmb3Igbm93IHRoYXQgdGhlIG5l
dyBpbnRlcnJ1cHQgaGFuZGxpbmcKPiBAQCAtMjk1NCwxMiArMjk1NCwxMiBAQCBnZW44X2RlX2ly
cV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIG1hc3Rlcl9j
dGwpCj4gICAJCQlJOTE1X1dSSVRFKFNERUlJUiwgaWlyKTsKPiAgIAkJCXJldCA9IElSUV9IQU5E
TEVEOwo+ICAgCj4gLQkJCWlmIChJTlRFTF9QQ0hfVFlQRShkZXZfcHJpdikgPj0gUENIX0lDUCkK
PiAtCQkJCWljcF9pcnFfaGFuZGxlcihkZXZfcHJpdiwgaWlyKTsKPiAtCQkJZWxzZSBpZiAoSU5U
RUxfUENIX1RZUEUoZGV2X3ByaXYpID49IFBDSF9TUFQpCj4gLQkJCQlzcHRfaXJxX2hhbmRsZXIo
ZGV2X3ByaXYsIGlpcik7Cj4gKwkJCWlmIChJTlRFTF9QQ0hfVFlQRShpOTE1KSA+PSBQQ0hfSUNQ
KQo+ICsJCQkJaWNwX2lycV9oYW5kbGVyKGk5MTUsIGlpcik7Cj4gKwkJCWVsc2UgaWYgKElOVEVM
X1BDSF9UWVBFKGk5MTUpID49IFBDSF9TUFQpCj4gKwkJCQlzcHRfaXJxX2hhbmRsZXIoaTkxNSwg
aWlyKTsKPiAgIAkJCWVsc2UKPiAtCQkJCWNwdF9pcnFfaGFuZGxlcihkZXZfcHJpdiwgaWlyKTsK
PiArCQkJCWNwdF9pcnFfaGFuZGxlcihpOTE1LCBpaXIpOwo+ICAgCQl9IGVsc2Ugewo+ICAgCQkJ
LyoKPiAgIAkJCSAqIExpa2Ugb24gcHJldmlvdXMgUENIIHRoZXJlIHNlZW1zIHRvIGJlIHNvbWV0
aGluZwo+IEBAIC0yOTkyLDEyICsyOTkyLDEyIEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBnZW44X21h
c3Rlcl9pbnRyX2VuYWJsZSh2b2lkIF9faW9tZW0gKiBjb25zdCByZWdzKQo+ICAgCj4gICBzdGF0
aWMgaXJxcmV0dXJuX3QgZ2VuOF9pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcpCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGFyZyk7Cj4g
LQl2b2lkIF9faW9tZW0gKiBjb25zdCByZWdzID0gZGV2X3ByaXYtPnVuY29yZS5yZWdzOwo+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGFyZyk7Cj4gKwl2b2lkIF9f
aW9tZW0gKiBjb25zdCByZWdzID0gaTkxNS0+dW5jb3JlLnJlZ3M7Cj4gICAJdTMyIG1hc3Rlcl9j
dGw7Cj4gICAJdTMyIGd0X2lpcls0XTsKPiAgIAo+IC0JaWYgKCFpbnRlbF9pcnFzX2VuYWJsZWQo
ZGV2X3ByaXYpKQo+ICsJaWYgKCFpbnRlbF9pcnFzX2VuYWJsZWQoaTkxNSkpCj4gICAJCXJldHVy
biBJUlFfTk9ORTsKPiAgIAo+ICAgCW1hc3Rlcl9jdGwgPSBnZW44X21hc3Rlcl9pbnRyX2Rpc2Fi
bGUocmVncyk7Cj4gQEAgLTMwMDcsMTggKzMwMDcsMTggQEAgc3RhdGljIGlycXJldHVybl90IGdl
bjhfaXJxX2hhbmRsZXIoaW50IGlycSwgdm9pZCAqYXJnKQo+ICAgCX0KPiAgIAo+ICAgCS8qIEZp
bmQsIGNsZWFyLCB0aGVuIHByb2Nlc3MgZWFjaCBzb3VyY2Ugb2YgaW50ZXJydXB0ICovCj4gLQln
ZW44X2d0X2lycV9hY2soZGV2X3ByaXYsIG1hc3Rlcl9jdGwsIGd0X2lpcik7Cj4gKwlnZW44X2d0
X2lycV9hY2soaTkxNSwgbWFzdGVyX2N0bCwgZ3RfaWlyKTsKPiAgIAo+ICAgCS8qIElSUXMgYXJl
IHN5bmNlZCBkdXJpbmcgcnVudGltZV9zdXNwZW5kLCB3ZSBkb24ndCByZXF1aXJlIGEgd2FrZXJl
ZiAqLwo+ICAgCWlmIChtYXN0ZXJfY3RsICYgfkdFTjhfR1RfSVJRUykgewo+IC0JCWRpc2FibGVf
cnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7Cj4gLQkJZ2VuOF9kZV9pcnFfaGFuZGxlcihk
ZXZfcHJpdiwgbWFzdGVyX2N0bCk7Cj4gLQkJZW5hYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoZGV2
X3ByaXYpOwo+ICsJCWRpc2FibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhpOTE1KTsKPiArCQlnZW44
X2RlX2lycV9oYW5kbGVyKGk5MTUsIG1hc3Rlcl9jdGwpOwo+ICsJCWVuYWJsZV9ycG1fd2FrZXJl
Zl9hc3NlcnRzKGk5MTUpOwo+ICAgCX0KPiAgIAo+ICAgCWdlbjhfbWFzdGVyX2ludHJfZW5hYmxl
KHJlZ3MpOwo+ICAgCj4gLQlnZW44X2d0X2lycV9oYW5kbGVyKGRldl9wcml2LCBtYXN0ZXJfY3Rs
LCBndF9paXIpOwo+ICsJZ2VuOF9ndF9pcnFfaGFuZGxlcihpOTE1LCBtYXN0ZXJfY3RsLCBndF9p
aXIpOwo+ICAgCj4gICAJcmV0dXJuIElSUV9IQU5ETEVEOwo+ICAgfQo+IEBAIC0zMTQ5LDkgKzMx
NDksOSBAQCBnZW4xMV9ndF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqIGNv
bnN0IGk5MTUsCj4gICB9Cj4gICAKPiAgIHN0YXRpYyB1MzIKPiAtZ2VuMTFfZ3VfbWlzY19pcnFf
YWNrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgY29uc3QgdTMyIG1hc3Rlcl9j
dGwpCj4gK2dlbjExX2d1X21pc2NfaXJxX2FjayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwgY29uc3QgdTMyIG1hc3Rlcl9jdGwpCj4gICB7Cj4gLQl2b2lkIF9faW9tZW0gKiBjb25zdCBy
ZWdzID0gZGV2X3ByaXYtPnVuY29yZS5yZWdzOwo+ICsJdm9pZCBfX2lvbWVtICogY29uc3QgcmVn
cyA9IGk5MTUtPnVuY29yZS5yZWdzOwo+ICAgCXUzMiBpaXI7Cj4gICAKPiAgIAlpZiAoIShtYXN0
ZXJfY3RsICYgR0VOMTFfR1VfTUlTQ19JUlEpKQo+IEBAIC0zMTY1LDEwICszMTY1LDEwIEBAIGdl
bjExX2d1X21pc2NfaXJxX2FjayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGNv
bnN0IHUzMiBtYXN0ZXJfY3RsKQo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZAo+IC1nZW4xMV9n
dV9taXNjX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgY29u
c3QgdTMyIGlpcikKPiArZ2VuMTFfZ3VfbWlzY19pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwgY29uc3QgdTMyIGlpcikKPiAgIHsKPiAgIAlpZiAoaWlyICYgR0VOMTFf
R1VfTUlTQ19HU0UpCj4gLQkJaW50ZWxfb3ByZWdpb25fYXNsZV9pbnRyKGRldl9wcml2KTsKPiAr
CQlpbnRlbF9vcHJlZ2lvbl9hc2xlX2ludHIoaTkxNSk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBp
bmxpbmUgdTMyIGdlbjExX21hc3Rlcl9pbnRyX2Rpc2FibGUodm9pZCBfX2lvbWVtICogY29uc3Qg
cmVncykKPiBAQCAtMzIzNSw1NCArMzIzNSw1NCBAQCBzdGF0aWMgaXJxcmV0dXJuX3QgZ2VuMTFf
aXJxX2hhbmRsZXIoaW50IGlycSwgdm9pZCAqYXJnKQo+ICAgICovCj4gICBzdGF0aWMgaW50IGk4
eHhfZW5hYmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1bnNpZ25lZCBpbnQgcGlw
ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+
ICAgCXVuc2lnbmVkIGxvbmcgaXJxZmxhZ3M7Cj4gICAKPiAtCXNwaW5fbG9ja19pcnFzYXZlKCZk
ZXZfcHJpdi0+aXJxX2xvY2ssIGlycWZsYWdzKTsKPiAtCWk5MTVfZW5hYmxlX3BpcGVzdGF0KGRl
dl9wcml2LCBwaXBlLCBQSVBFX1ZCTEFOS19JTlRFUlJVUFRfU1RBVFVTKTsKPiAtCXNwaW5fdW5s
b2NrX2lycXJlc3RvcmUoJmRldl9wcml2LT5pcnFfbG9jaywgaXJxZmxhZ3MpOwo+ICsJc3Bpbl9s
b2NrX2lycXNhdmUoJmk5MTUtPmlycV9sb2NrLCBpcnFmbGFncyk7Cj4gKwlpOTE1X2VuYWJsZV9w
aXBlc3RhdChpOTE1LCBwaXBlLCBQSVBFX1ZCTEFOS19JTlRFUlJVUFRfU1RBVFVTKTsKPiArCXNw
aW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPmlycV9sb2NrLCBpcnFmbGFncyk7Cj4gICAKPiAg
IAlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGludCBpOTQ1Z21fZW5hYmxlX3ZibGFu
ayhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1bnNpZ25lZCBpbnQgcGlwZSkKPiAgIHsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCj4gLQlpZiAoZGV2
X3ByaXYtPmk5NDVnbV92YmxhbmsuZW5hYmxlZCsrID09IDApCj4gLQkJc2NoZWR1bGVfd29yaygm
ZGV2X3ByaXYtPmk5NDVnbV92Ymxhbmsud29yayk7Cj4gKwlpZiAoaTkxNS0+aTk0NWdtX3ZibGFu
ay5lbmFibGVkKysgPT0gMCkKPiArCQlzY2hlZHVsZV93b3JrKCZpOTE1LT5pOTQ1Z21fdmJsYW5r
LndvcmspOwo+ICAgCj4gICAJcmV0dXJuIGk4eHhfZW5hYmxlX3ZibGFuayhkZXYsIHBpcGUpOwo+
ICAgfQo+ICAgCj4gICBzdGF0aWMgaW50IGk5NjVfZW5hYmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LCB1bnNpZ25lZCBpbnQgcGlwZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXVuc2lnbmVkIGxvbmcgaXJxZmxhZ3M7Cj4g
ICAKPiAtCXNwaW5fbG9ja19pcnFzYXZlKCZkZXZfcHJpdi0+aXJxX2xvY2ssIGlycWZsYWdzKTsK
PiAtCWk5MTVfZW5hYmxlX3BpcGVzdGF0KGRldl9wcml2LCBwaXBlLAo+ICsJc3Bpbl9sb2NrX2ly
cXNhdmUoJmk5MTUtPmlycV9sb2NrLCBpcnFmbGFncyk7Cj4gKwlpOTE1X2VuYWJsZV9waXBlc3Rh
dChpOTE1LCBwaXBlLAo+ICAgCQkJICAgICBQSVBFX1NUQVJUX1ZCTEFOS19JTlRFUlJVUFRfU1RB
VFVTKTsKPiAtCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRldl9wcml2LT5pcnFfbG9jaywgaXJx
ZmxhZ3MpOwo+ICsJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+aXJxX2xvY2ssIGlycWZs
YWdzKTsKPiAgIAo+ICAgCXJldHVybiAwOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgaW50IGlyb25s
YWtlX2VuYWJsZV92Ymxhbmsoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdW5zaWduZWQgaW50IHBp
cGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsK
PiAgIAl1bnNpZ25lZCBsb25nIGlycWZsYWdzOwo+IC0JdTMyIGJpdCA9IElOVEVMX0dFTihkZXZf
cHJpdikgPj0gNyA/Cj4gKwl1MzIgYml0ID0gSU5URUxfR0VOKGk5MTUpID49IDcgPwo+ICAgCQlE
RV9QSVBFX1ZCTEFOS19JVkIocGlwZSkgOiBERV9QSVBFX1ZCTEFOSyhwaXBlKTsKPiAgIAo+IC0J
c3Bpbl9sb2NrX2lycXNhdmUoJmRldl9wcml2LT5pcnFfbG9jaywgaXJxZmxhZ3MpOwo+IC0JaWxr
X2VuYWJsZV9kaXNwbGF5X2lycShkZXZfcHJpdiwgYml0KTsKPiAtCXNwaW5fdW5sb2NrX2lycXJl
c3RvcmUoJmRldl9wcml2LT5pcnFfbG9jaywgaXJxZmxhZ3MpOwo+ICsJc3Bpbl9sb2NrX2lycXNh
dmUoJmk5MTUtPmlycV9sb2NrLCBpcnFmbGFncyk7Cj4gKwlpbGtfZW5hYmxlX2Rpc3BsYXlfaXJx
KGk5MTUsIGJpdCk7Cj4gKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpOTE1LT5pcnFfbG9jaywg
aXJxZmxhZ3MpOwo+ICAgCj4gICAJLyogRXZlbiB0aG91Z2ggdGhlcmUgaXMgbm8gRE1DLCBmcmFt
ZSBjb3VudGVyIGNhbiBnZXQgc3R1Y2sgd2hlbgo+ICAgCSAqIFBTUiBpcyBhY3RpdmUgYXMgbm8g
ZnJhbWVzIGFyZSBnZW5lcmF0ZWQuCj4gICAJICovCj4gLQlpZiAoSEFTX1BTUihkZXZfcHJpdikp
Cj4gKwlpZiAoSEFTX1BTUihpOTE1KSkKPiAgIAkJZHJtX3ZibGFua19yZXN0b3JlKGRldiwgcGlw
ZSk7Cj4gICAKPiAgIAlyZXR1cm4gMDsKPiBAQCAtMzI5MCwxNyArMzI5MCwxNyBAQCBzdGF0aWMg
aW50IGlyb25sYWtlX2VuYWJsZV92Ymxhbmsoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdW5zaWdu
ZWQgaW50IHBpcGUpCj4gICAKPiAgIHN0YXRpYyBpbnQgZ2VuOF9lbmFibGVfdmJsYW5rKHN0cnVj
dCBkcm1fZGV2aWNlICpkZXYsIHVuc2lnbmVkIGludCBwaXBlKQo+ICAgewo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJdW5zaWduZWQgbG9uZyBpcnFm
bGFnczsKPiAgIAo+IC0Jc3Bpbl9sb2NrX2lycXNhdmUoJmRldl9wcml2LT5pcnFfbG9jaywgaXJx
ZmxhZ3MpOwo+IC0JYmR3X2VuYWJsZV9waXBlX2lycShkZXZfcHJpdiwgcGlwZSwgR0VOOF9QSVBF
X1ZCTEFOSyk7Cj4gLQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZkZXZfcHJpdi0+aXJxX2xvY2ss
IGlycWZsYWdzKTsKPiArCXNwaW5fbG9ja19pcnFzYXZlKCZpOTE1LT5pcnFfbG9jaywgaXJxZmxh
Z3MpOwo+ICsJYmR3X2VuYWJsZV9waXBlX2lycShpOTE1LCBwaXBlLCBHRU44X1BJUEVfVkJMQU5L
KTsKPiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPmlycV9sb2NrLCBpcnFmbGFncyk7
Cj4gICAKPiAgIAkvKiBFdmVuIGlmIHRoZXJlIGlzIG5vIERNQywgZnJhbWUgY291bnRlciBjYW4g
Z2V0IHN0dWNrIHdoZW4KPiAgIAkgKiBQU1IgaXMgYWN0aXZlIGFzIG5vIGZyYW1lcyBhcmUgZ2Vu
ZXJhdGVkLCBzbyBjaGVjayBvbmx5IGZvciBQU1IuCj4gICAJICovCj4gLQlpZiAoSEFTX1BTUihk
ZXZfcHJpdikpCj4gKwlpZiAoSEFTX1BTUihpOTE1KSkKPiAgIAkJZHJtX3ZibGFua19yZXN0b3Jl
KGRldiwgcGlwZSk7Cj4gICAKPiAgIAlyZXR1cm4gMDsKPiBAQCAtMzMxMSw2MCArMzMxMSw2MCBA
QCBzdGF0aWMgaW50IGdlbjhfZW5hYmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1
bnNpZ25lZCBpbnQgcGlwZSkKPiAgICAqLwo+ICAgc3RhdGljIHZvaWQgaTh4eF9kaXNhYmxlX3Zi
bGFuayhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1bnNpZ25lZCBpbnQgcGlwZSkKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXVuc2lnbmVk
IGxvbmcgaXJxZmxhZ3M7Cj4gICAKPiAtCXNwaW5fbG9ja19pcnFzYXZlKCZkZXZfcHJpdi0+aXJx
X2xvY2ssIGlycWZsYWdzKTsKPiAtCWk5MTVfZGlzYWJsZV9waXBlc3RhdChkZXZfcHJpdiwgcGlw
ZSwgUElQRV9WQkxBTktfSU5URVJSVVBUX1NUQVRVUyk7Cj4gLQlzcGluX3VubG9ja19pcnFyZXN0
b3JlKCZkZXZfcHJpdi0+aXJxX2xvY2ssIGlycWZsYWdzKTsKPiArCXNwaW5fbG9ja19pcnFzYXZl
KCZpOTE1LT5pcnFfbG9jaywgaXJxZmxhZ3MpOwo+ICsJaTkxNV9kaXNhYmxlX3BpcGVzdGF0KGk5
MTUsIHBpcGUsIFBJUEVfVkJMQU5LX0lOVEVSUlVQVF9TVEFUVVMpOwo+ICsJc3Bpbl91bmxvY2tf
aXJxcmVzdG9yZSgmaTkxNS0+aXJxX2xvY2ssIGlycWZsYWdzKTsKPiAgIH0KPiAgIAo+ICAgc3Rh
dGljIHZvaWQgaTk0NWdtX2Rpc2FibGVfdmJsYW5rKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHVu
c2lnbmVkIGludCBwaXBlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGRldik7Cj4gICAKPiAgIAlpOHh4X2Rpc2FibGVfdmJsYW5rKGRldiwgcGlwZSk7Cj4g
ICAKPiAtCWlmICgtLWRldl9wcml2LT5pOTQ1Z21fdmJsYW5rLmVuYWJsZWQgPT0gMCkKPiAtCQlz
Y2hlZHVsZV93b3JrKCZkZXZfcHJpdi0+aTk0NWdtX3ZibGFuay53b3JrKTsKPiArCWlmICgtLWk5
MTUtPmk5NDVnbV92YmxhbmsuZW5hYmxlZCA9PSAwKQo+ICsJCXNjaGVkdWxlX3dvcmsoJmk5MTUt
Pmk5NDVnbV92Ymxhbmsud29yayk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIGk5NjVfZGlz
YWJsZV92Ymxhbmsoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdW5zaWduZWQgaW50IHBpcGUpCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAl1
bnNpZ25lZCBsb25nIGlycWZsYWdzOwo+ICAgCj4gLQlzcGluX2xvY2tfaXJxc2F2ZSgmZGV2X3By
aXYtPmlycV9sb2NrLCBpcnFmbGFncyk7Cj4gLQlpOTE1X2Rpc2FibGVfcGlwZXN0YXQoZGV2X3By
aXYsIHBpcGUsCj4gKwlzcGluX2xvY2tfaXJxc2F2ZSgmaTkxNS0+aXJxX2xvY2ssIGlycWZsYWdz
KTsKPiArCWk5MTVfZGlzYWJsZV9waXBlc3RhdChpOTE1LCBwaXBlLAo+ICAgCQkJICAgICAgUElQ
RV9TVEFSVF9WQkxBTktfSU5URVJSVVBUX1NUQVRVUyk7Cj4gLQlzcGluX3VubG9ja19pcnFyZXN0
b3JlKCZkZXZfcHJpdi0+aXJxX2xvY2ssIGlycWZsYWdzKTsKPiArCXNwaW5fdW5sb2NrX2lycXJl
c3RvcmUoJmk5MTUtPmlycV9sb2NrLCBpcnFmbGFncyk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2
b2lkIGlyb25sYWtlX2Rpc2FibGVfdmJsYW5rKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHVuc2ln
bmVkIGludCBwaXBlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGRldik7Cj4gICAJdW5zaWduZWQgbG9uZyBpcnFmbGFnczsKPiAtCXUzMiBiaXQgPSBJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDcgPwo+ICsJdTMyIGJpdCA9IElOVEVMX0dFTihpOTE1KSA+PSA3
ID8KPiAgIAkJREVfUElQRV9WQkxBTktfSVZCKHBpcGUpIDogREVfUElQRV9WQkxBTksocGlwZSk7
Cj4gICAKPiAtCXNwaW5fbG9ja19pcnFzYXZlKCZkZXZfcHJpdi0+aXJxX2xvY2ssIGlycWZsYWdz
KTsKPiAtCWlsa19kaXNhYmxlX2Rpc3BsYXlfaXJxKGRldl9wcml2LCBiaXQpOwo+IC0Jc3Bpbl91
bmxvY2tfaXJxcmVzdG9yZSgmZGV2X3ByaXYtPmlycV9sb2NrLCBpcnFmbGFncyk7Cj4gKwlzcGlu
X2xvY2tfaXJxc2F2ZSgmaTkxNS0+aXJxX2xvY2ssIGlycWZsYWdzKTsKPiArCWlsa19kaXNhYmxl
X2Rpc3BsYXlfaXJxKGk5MTUsIGJpdCk7Cj4gKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpOTE1
LT5pcnFfbG9jaywgaXJxZmxhZ3MpOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZCBnZW44X2Rp
c2FibGVfdmJsYW5rKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHVuc2lnbmVkIGludCBwaXBlKQo+
ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJ
dW5zaWduZWQgbG9uZyBpcnFmbGFnczsKPiAgIAo+IC0Jc3Bpbl9sb2NrX2lycXNhdmUoJmRldl9w
cml2LT5pcnFfbG9jaywgaXJxZmxhZ3MpOwo+IC0JYmR3X2Rpc2FibGVfcGlwZV9pcnEoZGV2X3By
aXYsIHBpcGUsIEdFTjhfUElQRV9WQkxBTkspOwo+IC0Jc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgm
ZGV2X3ByaXYtPmlycV9sb2NrLCBpcnFmbGFncyk7Cj4gKwlzcGluX2xvY2tfaXJxc2F2ZSgmaTkx
NS0+aXJxX2xvY2ssIGlycWZsYWdzKTsKPiArCWJkd19kaXNhYmxlX3BpcGVfaXJxKGk5MTUsIHBp
cGUsIEdFTjhfUElQRV9WQkxBTkspOwo+ICsJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+
aXJxX2xvY2ssIGlycWZsYWdzKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgaTk0NWdtX3Zi
bGFua193b3JrX2Z1bmMoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAgewo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0KPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0KPiAgIAkJY29udGFpbmVyX29mKHdvcmssIHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
LCBpOTQ1Z21fdmJsYW5rLndvcmspOwo+ICAgCj4gICAJLyoKPiBAQCAtMzM3Miw5ICszMzcyLDkg
QEAgc3RhdGljIHZvaWQgaTk0NWdtX3ZibGFua193b3JrX2Z1bmMoc3RydWN0IHdvcmtfc3RydWN0
ICp3b3JrKQo+ICAgCSAqIGhlbmNlIHdlIHdhbnQgdG8gcHJldmVudCBDMyB1c2FnZSB3aGlsZSB2
YmxhbmsgaW50ZXJydXB0cwo+ICAgCSAqIGFyZSBlbmFibGVkLgo+ICAgCSAqLwo+IC0JcG1fcW9z
X3VwZGF0ZV9yZXF1ZXN0KCZkZXZfcHJpdi0+aTk0NWdtX3ZibGFuay5wbV9xb3MsCj4gLQkJCSAg
ICAgIFJFQURfT05DRShkZXZfcHJpdi0+aTk0NWdtX3ZibGFuay5lbmFibGVkKSA/Cj4gLQkJCSAg
ICAgIGRldl9wcml2LT5pOTQ1Z21fdmJsYW5rLmMzX2Rpc2FibGVfbGF0ZW5jeSA6Cj4gKwlwbV9x
b3NfdXBkYXRlX3JlcXVlc3QoJmk5MTUtPmk5NDVnbV92YmxhbmsucG1fcW9zLAo+ICsJCQkgICAg
ICBSRUFEX09OQ0UoaTkxNS0+aTk0NWdtX3ZibGFuay5lbmFibGVkKSA/Cj4gKwkJCSAgICAgIGk5
MTUtPmk5NDVnbV92YmxhbmsuYzNfZGlzYWJsZV9sYXRlbmN5IDoKPiAgIAkJCSAgICAgIFBNX1FP
U19ERUZBVUxUX1ZBTFVFKTsKPiAgIH0KPiAgIAo+IEBAIC0zMzk4LDM0ICszMzk4LDM0IEBAIHN0
YXRpYyBpbnQgY3N0YXRlX2Rpc2FibGVfbGF0ZW5jeShjb25zdCBjaGFyICpuYW1lKQo+ICAgCXJl
dHVybiAwOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGk5NDVnbV92Ymxhbmtfd29ya19pbml0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaTk0NWdt
X3ZibGFua193b3JrX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4g
LQlJTklUX1dPUksoJmRldl9wcml2LT5pOTQ1Z21fdmJsYW5rLndvcmssCj4gKwlJTklUX1dPUkso
Jmk5MTUtPmk5NDVnbV92Ymxhbmsud29yaywKPiAgIAkJICBpOTQ1Z21fdmJsYW5rX3dvcmtfZnVu
Yyk7Cj4gICAKPiAtCWRldl9wcml2LT5pOTQ1Z21fdmJsYW5rLmMzX2Rpc2FibGVfbGF0ZW5jeSA9
Cj4gKwlpOTE1LT5pOTQ1Z21fdmJsYW5rLmMzX2Rpc2FibGVfbGF0ZW5jeSA9Cj4gICAJCWNzdGF0
ZV9kaXNhYmxlX2xhdGVuY3koIkMzIik7Cj4gLQlwbV9xb3NfYWRkX3JlcXVlc3QoJmRldl9wcml2
LT5pOTQ1Z21fdmJsYW5rLnBtX3FvcywKPiArCXBtX3Fvc19hZGRfcmVxdWVzdCgmaTkxNS0+aTk0
NWdtX3ZibGFuay5wbV9xb3MsCj4gICAJCQkgICBQTV9RT1NfQ1BVX0RNQV9MQVRFTkNZLAo+ICAg
CQkJICAgUE1fUU9TX0RFRkFVTFRfVkFMVUUpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGk5
NDVnbV92Ymxhbmtfd29ya19maW5pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiArc3RhdGljIHZvaWQgaTk0NWdtX3ZibGFua193b3JrX2Zpbmkoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCj4gICB7Cj4gLQljYW5jZWxfd29ya19zeW5jKCZkZXZfcHJpdi0+aTk0NWdt
X3ZibGFuay53b3JrKTsKPiAtCXBtX3Fvc19yZW1vdmVfcmVxdWVzdCgmZGV2X3ByaXYtPmk5NDVn
bV92YmxhbmsucG1fcW9zKTsKPiArCWNhbmNlbF93b3JrX3N5bmMoJmk5MTUtPmk5NDVnbV92Ymxh
bmsud29yayk7Cj4gKwlwbV9xb3NfcmVtb3ZlX3JlcXVlc3QoJmk5MTUtPmk5NDVnbV92Ymxhbmsu
cG1fcW9zKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpYnhfaXJxX3Jlc2V0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaWJ4X2lycV9yZXNldChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVjdCBpbnRlbF91bmNv
cmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwo+ICsJc3RydWN0IGludGVsX3VuY29yZSAq
dW5jb3JlID0gJmk5MTUtPnVuY29yZTsKPiAgIAo+IC0JaWYgKEhBU19QQ0hfTk9QKGRldl9wcml2
KSkKPiArCWlmIChIQVNfUENIX05PUChpOTE1KSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJR0VO
M19JUlFfUkVTRVQodW5jb3JlLCBTREUpOwo+ICAgCj4gLQlpZiAoSEFTX1BDSF9DUFQoZGV2X3By
aXYpIHx8IEhBU19QQ0hfTFBUKGRldl9wcml2KSkKPiArCWlmIChIQVNfUENIX0NQVChpOTE1KSB8
fCBIQVNfUENIX0xQVChpOTE1KSkKPiAgIAkJSTkxNV9XUklURShTRVJSX0lOVCwgMHhmZmZmZmZm
Zik7Cj4gICB9Cj4gICAKPiBAQCAtMzQzOSw5ICszNDM5LDkgQEAgc3RhdGljIHZvaWQgaWJ4X2ly
cV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAgKi8KPiAgIHN0
YXRpYyB2b2lkIGlieF9pcnFfcHJlX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYp
Cj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRl
dik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAg
IAo+IC0JaWYgKEhBU19QQ0hfTk9QKGRldl9wcml2KSkKPiArCWlmIChIQVNfUENIX05PUChpOTE1
KSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJV0FSTl9PTihJOTE1X1JFQUQoU0RFSUVSKSAhPSAw
KTsKPiBAQCAtMzQ0OSwzNiArMzQ0OSwzNiBAQCBzdGF0aWMgdm9pZCBpYnhfaXJxX3ByZV9wb3N0
aW5zdGFsbChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAgCVBPU1RJTkdfUkVBRChTREVJRVIp
Owo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGdlbjVfZ3RfaXJxX3Jlc2V0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgZ2VuNV9ndF9pcnFfcmVzZXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfdW5j
b3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsKPiArCXN0cnVjdCBpbnRlbF91bmNvcmUg
KnVuY29yZSA9ICZpOTE1LT51bmNvcmU7Cj4gICAKPiAgIAlHRU4zX0lSUV9SRVNFVCh1bmNvcmUs
IEdUKTsKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDYpCj4gKwlpZiAoSU5URUxfR0VO
KGk5MTUpID49IDYpCj4gICAJCUdFTjNfSVJRX1JFU0VUKHVuY29yZSwgR0VONl9QTSk7Cj4gICB9
Cj4gICAKPiAtc3RhdGljIHZvaWQgdmx2X2Rpc3BsYXlfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgdmx2X2Rpc3BsYXlfaXJxX3Jlc2V0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RydWN0IGludGVsX3Vu
Y29yZSAqdW5jb3JlID0gJmRldl9wcml2LT51bmNvcmU7Cj4gKwlzdHJ1Y3QgaW50ZWxfdW5jb3Jl
ICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwo+ICAgCj4gLQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZf
cHJpdikpCj4gKwlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiAgIAkJSTkxNV9XUklURShEUElO
VkdUVCwgRFBJTlZHVFRfU1RBVFVTX01BU0tfQ0hWKTsKPiAgIAllbHNlCj4gICAJCUk5MTVfV1JJ
VEUoRFBJTlZHVFQsIERQSU5WR1RUX1NUQVRVU19NQVNLKTsKPiAgIAo+IC0JaTkxNV9ob3RwbHVn
X2ludGVycnVwdF91cGRhdGVfbG9ja2VkKGRldl9wcml2LCAweGZmZmZmZmZmLCAwKTsKPiArCWk5
MTVfaG90cGx1Z19pbnRlcnJ1cHRfdXBkYXRlX2xvY2tlZChpOTE1LCAweGZmZmZmZmZmLCAwKTsK
PiAgIAlJOTE1X1dSSVRFKFBPUlRfSE9UUExVR19TVEFULCBJOTE1X1JFQUQoUE9SVF9IT1RQTFVH
X1NUQVQpKTsKPiAgIAo+IC0JaTl4eF9waXBlc3RhdF9pcnFfcmVzZXQoZGV2X3ByaXYpOwo+ICsJ
aTl4eF9waXBlc3RhdF9pcnFfcmVzZXQoaTkxNSk7Cj4gICAKPiAgIAlHRU4zX0lSUV9SRVNFVCh1
bmNvcmUsIFZMVl8pOwo+IC0JZGV2X3ByaXYtPmlycV9tYXNrID0gfjB1Owo+ICsJaTkxNS0+aXJx
X21hc2sgPSB+MHU7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgdmx2X2Rpc3BsYXlfaXJxX3Bv
c3RpbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZv
aWQgdmx2X2Rpc3BsYXlfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ICAgewo+IC0Jc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmRldl9wcml2LT51
bmNvcmU7Cj4gKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwo+
ICAgCj4gICAJdTMyIHBpcGVzdGF0X21hc2s7Cj4gICAJdTMyIGVuYWJsZV9tYXNrOwo+IEBAIC0z
NDg2LDkgKzM0ODYsOSBAQCBzdGF0aWMgdm9pZCB2bHZfZGlzcGxheV9pcnFfcG9zdGluc3RhbGwo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCj4gICAJcGlwZXN0YXRfbWFz
ayA9IFBJUEVfQ1JDX0RPTkVfSU5URVJSVVBUX1NUQVRVUzsKPiAgIAo+IC0JaTkxNV9lbmFibGVf
cGlwZXN0YXQoZGV2X3ByaXYsIFBJUEVfQSwgUElQRV9HTUJVU19JTlRFUlJVUFRfU1RBVFVTKTsK
PiAtCWZvcl9lYWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpCj4gLQkJaTkxNV9lbmFibGVfcGlwZXN0
YXQoZGV2X3ByaXYsIHBpcGUsIHBpcGVzdGF0X21hc2spOwo+ICsJaTkxNV9lbmFibGVfcGlwZXN0
YXQoaTkxNSwgUElQRV9BLCBQSVBFX0dNQlVTX0lOVEVSUlVQVF9TVEFUVVMpOwo+ICsJZm9yX2Vh
Y2hfcGlwZShpOTE1LCBwaXBlKQo+ICsJCWk5MTVfZW5hYmxlX3BpcGVzdGF0KGk5MTUsIHBpcGUs
IHBpcGVzdGF0X21hc2spOwo+ICAgCj4gICAJZW5hYmxlX21hc2sgPSBJOTE1X0RJU1BMQVlfUE9S
VF9JTlRFUlJVUFQgfAo+ICAgCQlJOTE1X0RJU1BMQVlfUElQRV9BX0VWRU5UX0lOVEVSUlVQVCB8
Cj4gQEAgLTM0OTYsNTYgKzM0OTYsNTYgQEAgc3RhdGljIHZvaWQgdmx2X2Rpc3BsYXlfaXJxX3Bv
c3RpbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkJSTkxNV9M
UEVfUElQRV9BX0lOVEVSUlVQVCB8Cj4gICAJCUk5MTVfTFBFX1BJUEVfQl9JTlRFUlJVUFQ7Cj4g
ICAKPiAtCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiArCWlmIChJU19DSEVSUllWSUVX
KGk5MTUpKQo+ICAgCQllbmFibGVfbWFzayB8PSBJOTE1X0RJU1BMQVlfUElQRV9DX0VWRU5UX0lO
VEVSUlVQVCB8Cj4gICAJCQlJOTE1X0xQRV9QSVBFX0NfSU5URVJSVVBUOwo+ICAgCj4gLQlXQVJO
X09OKGRldl9wcml2LT5pcnFfbWFzayAhPSB+MHUpOwo+ICsJV0FSTl9PTihpOTE1LT5pcnFfbWFz
ayAhPSB+MHUpOwo+ICAgCj4gLQlkZXZfcHJpdi0+aXJxX21hc2sgPSB+ZW5hYmxlX21hc2s7Cj4g
KwlpOTE1LT5pcnFfbWFzayA9IH5lbmFibGVfbWFzazsKPiAgIAo+IC0JR0VOM19JUlFfSU5JVCh1
bmNvcmUsIFZMVl8sIGRldl9wcml2LT5pcnFfbWFzaywgZW5hYmxlX21hc2spOwo+ICsJR0VOM19J
UlFfSU5JVCh1bmNvcmUsIFZMVl8sIGk5MTUtPmlycV9tYXNrLCBlbmFibGVfbWFzayk7Cj4gICB9
Cj4gICAKPiAgIC8qIGRybV9kbWEuaCBob29rcwo+ICAgKi8KPiAgIHN0YXRpYyB2b2lkIGlyb25s
YWtlX2lycV9yZXNldChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAgewo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+IC0Jc3RydWN0IGludGVs
X3VuY29yZSAqdW5jb3JlID0gJmRldl9wcml2LT51bmNvcmU7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVu
Y29yZSA9ICZpOTE1LT51bmNvcmU7Cj4gICAKPiAgIAlHRU4zX0lSUV9SRVNFVCh1bmNvcmUsIERF
KTsKPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDcpKQo+ICsJaWYgKElTX0dFTihpOTE1LCA3KSkK
PiAgIAkJSTkxNV9XUklURShHRU43X0VSUl9JTlQsIDB4ZmZmZmZmZmYpOwo+ICAgCj4gLQlpZiAo
SVNfSEFTV0VMTChkZXZfcHJpdikpIHsKPiArCWlmIChJU19IQVNXRUxMKGk5MTUpKSB7Cj4gICAJ
CUk5MTVfV1JJVEUoRURQX1BTUl9JTVIsIDB4ZmZmZmZmZmYpOwo+ICAgCQlJOTE1X1dSSVRFKEVE
UF9QU1JfSUlSLCAweGZmZmZmZmZmKTsKPiAgIAl9Cj4gICAKPiAtCWdlbjVfZ3RfaXJxX3Jlc2V0
KGRldl9wcml2KTsKPiArCWdlbjVfZ3RfaXJxX3Jlc2V0KGk5MTUpOwo+ICAgCj4gLQlpYnhfaXJx
X3Jlc2V0KGRldl9wcml2KTsKPiArCWlieF9pcnFfcmVzZXQoaTkxNSk7Cj4gICB9Cj4gICAKPiAg
IHN0YXRpYyB2b2lkIHZhbGxleXZpZXdfaXJxX3Jlc2V0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYp
Cj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRl
dik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAg
IAo+ICAgCUk5MTVfV1JJVEUoVkxWX01BU1RFUl9JRVIsIDApOwo+ICAgCVBPU1RJTkdfUkVBRChW
TFZfTUFTVEVSX0lFUik7Cj4gICAKPiAtCWdlbjVfZ3RfaXJxX3Jlc2V0KGRldl9wcml2KTsKPiAr
CWdlbjVfZ3RfaXJxX3Jlc2V0KGk5MTUpOwo+ICAgCj4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJp
di0+aXJxX2xvY2spOwo+IC0JaWYgKGRldl9wcml2LT5kaXNwbGF5X2lycXNfZW5hYmxlZCkKPiAt
CQl2bHZfZGlzcGxheV9pcnFfcmVzZXQoZGV2X3ByaXYpOwo+IC0Jc3Bpbl91bmxvY2tfaXJxKCZk
ZXZfcHJpdi0+aXJxX2xvY2spOwo+ICsJc3Bpbl9sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+
ICsJaWYgKGk5MTUtPmRpc3BsYXlfaXJxc19lbmFibGVkKQo+ICsJCXZsdl9kaXNwbGF5X2lycV9y
ZXNldChpOTE1KTsKPiArCXNwaW5fdW5sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ICAgfQo+
ICAgCj4gLXN0YXRpYyB2b2lkIGdlbjhfZ3RfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgZ2VuOF9ndF9pcnFfcmVzZXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNv
cmUgPSAmZGV2X3ByaXYtPnVuY29yZTsKPiArCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9
ICZpOTE1LT51bmNvcmU7Cj4gICAKPiAgIAlHRU44X0lSUV9SRVNFVF9ORFgodW5jb3JlLCBHVCwg
MCk7Cj4gICAJR0VOOF9JUlFfUkVTRVRfTkRYKHVuY29yZSwgR1QsIDEpOwo+IEBAIC0zNTU1LDE5
ICszNTU1LDE5IEBAIHN0YXRpYyB2b2lkIGdlbjhfZ3RfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAo+ICAgc3RhdGljIHZvaWQgZ2VuOF9pcnFfcmVzZXQo
c3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiAtCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29y
ZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+
dW5jb3JlOwo+ICAgCWludCBwaXBlOwo+ICAgCj4gLQlnZW44X21hc3Rlcl9pbnRyX2Rpc2FibGUo
ZGV2X3ByaXYtPnVuY29yZS5yZWdzKTsKPiArCWdlbjhfbWFzdGVyX2ludHJfZGlzYWJsZShpOTE1
LT51bmNvcmUucmVncyk7Cj4gICAKPiAtCWdlbjhfZ3RfaXJxX3Jlc2V0KGRldl9wcml2KTsKPiAr
CWdlbjhfZ3RfaXJxX3Jlc2V0KGk5MTUpOwo+ICAgCj4gICAJSTkxNV9XUklURShFRFBfUFNSX0lN
UiwgMHhmZmZmZmZmZik7Cj4gICAJSTkxNV9XUklURShFRFBfUFNSX0lJUiwgMHhmZmZmZmZmZik7
Cj4gICAKPiAtCWZvcl9lYWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpCj4gLQkJaWYgKGludGVsX2Rp
c3BsYXlfcG93ZXJfaXNfZW5hYmxlZChkZXZfcHJpdiwKPiArCWZvcl9lYWNoX3BpcGUoaTkxNSwg
cGlwZSkKPiArCQlpZiAoaW50ZWxfZGlzcGxheV9wb3dlcl9pc19lbmFibGVkKGk5MTUsCj4gICAJ
CQkJCQkgICBQT1dFUl9ET01BSU5fUElQRShwaXBlKSkpCj4gICAJCQlHRU44X0lSUV9SRVNFVF9O
RFgodW5jb3JlLCBERV9QSVBFLCBwaXBlKTsKPiAgIAo+IEBAIC0zNTc1LDExICszNTc1LDExIEBA
IHN0YXRpYyB2b2lkIGdlbjhfaXJxX3Jlc2V0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gICAJ
R0VOM19JUlFfUkVTRVQodW5jb3JlLCBHRU44X0RFX01JU0NfKTsKPiAgIAlHRU4zX0lSUV9SRVNF
VCh1bmNvcmUsIEdFTjhfUENVXyk7Cj4gICAKPiAtCWlmIChIQVNfUENIX1NQTElUKGRldl9wcml2
KSkKPiAtCQlpYnhfaXJxX3Jlc2V0KGRldl9wcml2KTsKPiArCWlmIChIQVNfUENIX1NQTElUKGk5
MTUpKQo+ICsJCWlieF9pcnFfcmVzZXQoaTkxNSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQg
Z2VuMTFfZ3RfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAr
c3RhdGljIHZvaWQgZ2VuMTFfZ3RfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ICAgewo+ICAgCS8qIERpc2FibGUgUkNTLCBCQ1MsIFZDUyBhbmQgVkVDUyBjbGFzcyBl
bmdpbmVzLiAqLwo+ICAgCUk5MTVfV1JJVEUoR0VOMTFfUkVOREVSX0NPUFlfSU5UUl9FTkFCTEUs
IDApOwo+IEBAIC0zNjAwLDIxICszNjAwLDIxIEBAIHN0YXRpYyB2b2lkIGdlbjExX2d0X2lycV9y
ZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAKPiAgIHN0YXRpYyB2
b2lkIGdlbjExX2lycV9yZXNldChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAgewo+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZGV2LT5kZXZfcHJpdmF0ZTsKPiAtCXN0
cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkZXYtPmRldl9wcml2YXRlOwo+ICsJc3RydWN0IGlu
dGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsKPiAgIAlpbnQgcGlwZTsKPiAgIAo+
IC0JZ2VuMTFfbWFzdGVyX2ludHJfZGlzYWJsZShkZXZfcHJpdi0+dW5jb3JlLnJlZ3MpOwo+ICsJ
Z2VuMTFfbWFzdGVyX2ludHJfZGlzYWJsZShpOTE1LT51bmNvcmUucmVncyk7Cj4gICAKPiAtCWdl
bjExX2d0X2lycV9yZXNldChkZXZfcHJpdik7Cj4gKwlnZW4xMV9ndF9pcnFfcmVzZXQoaTkxNSk7
Cj4gICAKPiAgIAlJOTE1X1dSSVRFKEdFTjExX0RJU1BMQVlfSU5UX0NUTCwgMCk7Cj4gICAKPiAg
IAlJOTE1X1dSSVRFKEVEUF9QU1JfSU1SLCAweGZmZmZmZmZmKTsKPiAgIAlJOTE1X1dSSVRFKEVE
UF9QU1JfSUlSLCAweGZmZmZmZmZmKTsKPiAgIAo+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwg
cGlwZSkKPiAtCQlpZiAoaW50ZWxfZGlzcGxheV9wb3dlcl9pc19lbmFibGVkKGRldl9wcml2LAo+
ICsJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKQo+ICsJCWlmIChpbnRlbF9kaXNwbGF5X3Bvd2Vy
X2lzX2VuYWJsZWQoaTkxNSwKPiAgIAkJCQkJCSAgIFBPV0VSX0RPTUFJTl9QSVBFKHBpcGUpKSkK
PiAgIAkJCUdFTjhfSVJRX1JFU0VUX05EWCh1bmNvcmUsIERFX1BJUEUsIHBpcGUpOwo+ICAgCj4g
QEAgLTM2MjQsODcgKzM2MjQsODcgQEAgc3RhdGljIHZvaWQgZ2VuMTFfaXJxX3Jlc2V0KHN0cnVj
dCBkcm1fZGV2aWNlICpkZXYpCj4gICAJR0VOM19JUlFfUkVTRVQodW5jb3JlLCBHRU4xMV9HVV9N
SVNDXyk7Cj4gICAJR0VOM19JUlFfUkVTRVQodW5jb3JlLCBHRU44X1BDVV8pOwo+ICAgCj4gLQlp
ZiAoSU5URUxfUENIX1RZUEUoZGV2X3ByaXYpID49IFBDSF9JQ1ApCj4gKwlpZiAoSU5URUxfUENI
X1RZUEUoaTkxNSkgPj0gUENIX0lDUCkKPiAgIAkJR0VOM19JUlFfUkVTRVQodW5jb3JlLCBTREUp
Owo+ICAgfQo+ICAgCj4gLXZvaWQgZ2VuOF9pcnFfcG93ZXJfd2VsbF9wb3N0X2VuYWJsZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3ZvaWQgZ2VuOF9pcnFfcG93ZXJfd2Vs
bF9wb3N0X2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAg
IHU4IHBpcGVfbWFzaykKPiAgIHsKPiAtCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZk
ZXZfcHJpdi0+dW5jb3JlOwo+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUt
PnVuY29yZTsKPiAgIAo+ICAgCXUzMiBleHRyYV9pZXIgPSBHRU44X1BJUEVfVkJMQU5LIHwgR0VO
OF9QSVBFX0ZJRk9fVU5ERVJSVU47Cj4gICAJZW51bSBwaXBlIHBpcGU7Cj4gICAKPiAtCXNwaW5f
bG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gKwlzcGluX2xvY2tfaXJxKCZpOTE1LT5p
cnFfbG9jayk7Cj4gICAKPiAtCWlmICghaW50ZWxfaXJxc19lbmFibGVkKGRldl9wcml2KSkgewo+
IC0JCXNwaW5fdW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiArCWlmICghaW50ZWxf
aXJxc19lbmFibGVkKGk5MTUpKSB7Cj4gKwkJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9j
ayk7Cj4gICAJCXJldHVybjsKPiAgIAl9Cj4gICAKPiAtCWZvcl9lYWNoX3BpcGVfbWFza2VkKGRl
dl9wcml2LCBwaXBlLCBwaXBlX21hc2spCj4gKwlmb3JfZWFjaF9waXBlX21hc2tlZChpOTE1LCBw
aXBlLCBwaXBlX21hc2spCj4gICAJCUdFTjhfSVJRX0lOSVRfTkRYKHVuY29yZSwgREVfUElQRSwg
cGlwZSwKPiAtCQkJCSAgZGV2X3ByaXYtPmRlX2lycV9tYXNrW3BpcGVdLAo+IC0JCQkJICB+ZGV2
X3ByaXYtPmRlX2lycV9tYXNrW3BpcGVdIHwgZXh0cmFfaWVyKTsKPiArCQkJCSAgaTkxNS0+ZGVf
aXJxX21hc2tbcGlwZV0sCj4gKwkJCQkgIH5pOTE1LT5kZV9pcnFfbWFza1twaXBlXSB8IGV4dHJh
X2llcik7Cj4gICAKPiAtCXNwaW5fdW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiAr
CXNwaW5fdW5sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ICAgfQo+ICAgCj4gLXZvaWQgZ2Vu
OF9pcnFfcG93ZXJfd2VsbF9wcmVfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gK3ZvaWQgZ2VuOF9pcnFfcG93ZXJfd2VsbF9wcmVfZGlzYWJsZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAgIHU4IHBpcGVfbWFzaykKPiAgIHsKPiAt
CXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwo+ICsJc3Ry
dWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsKPiAgIAllbnVtIHBpcGUg
cGlwZTsKPiAgIAo+IC0Jc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiArCXNw
aW5fbG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiAgIAo+IC0JaWYgKCFpbnRlbF9pcnFzX2Vu
YWJsZWQoZGV2X3ByaXYpKSB7Cj4gLQkJc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xv
Y2spOwo+ICsJaWYgKCFpbnRlbF9pcnFzX2VuYWJsZWQoaTkxNSkpIHsKPiArCQlzcGluX3VubG9j
a19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiAgIAkJcmV0dXJuOwo+ICAgCX0KPiAgIAo+IC0JZm9y
X2VhY2hfcGlwZV9tYXNrZWQoZGV2X3ByaXYsIHBpcGUsIHBpcGVfbWFzaykKPiArCWZvcl9lYWNo
X3BpcGVfbWFza2VkKGk5MTUsIHBpcGUsIHBpcGVfbWFzaykKPiAgIAkJR0VOOF9JUlFfUkVTRVRf
TkRYKHVuY29yZSwgREVfUElQRSwgcGlwZSk7Cj4gICAKPiAtCXNwaW5fdW5sb2NrX2lycSgmZGV2
X3ByaXYtPmlycV9sb2NrKTsKPiArCXNwaW5fdW5sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+
ICAgCj4gICAJLyogbWFrZSBzdXJlIHdlJ3JlIGRvbmUgcHJvY2Vzc2luZyBkaXNwbGF5IGlycXMg
Ki8KPiAtCXN5bmNocm9uaXplX2lycShkZXZfcHJpdi0+ZHJtLmlycSk7Cj4gKwlzeW5jaHJvbml6
ZV9pcnEoaTkxNS0+ZHJtLmlycSk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIGNoZXJyeXZp
ZXdfaXJxX3Jlc2V0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gLQlzdHJ1Y3QgaW50ZWxf
dW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5j
b3JlID0gJmk5MTUtPnVuY29yZTsKPiAgIAo+ICAgCUk5MTVfV1JJVEUoR0VOOF9NQVNURVJfSVJR
LCAwKTsKPiAgIAlQT1NUSU5HX1JFQUQoR0VOOF9NQVNURVJfSVJRKTsKPiAgIAo+IC0JZ2VuOF9n
dF9pcnFfcmVzZXQoZGV2X3ByaXYpOwo+ICsJZ2VuOF9ndF9pcnFfcmVzZXQoaTkxNSk7Cj4gICAK
PiAgIAlHRU4zX0lSUV9SRVNFVCh1bmNvcmUsIEdFTjhfUENVXyk7Cj4gICAKPiAtCXNwaW5fbG9j
a19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gLQlpZiAoZGV2X3ByaXYtPmRpc3BsYXlfaXJx
c19lbmFibGVkKQo+IC0JCXZsdl9kaXNwbGF5X2lycV9yZXNldChkZXZfcHJpdik7Cj4gLQlzcGlu
X3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gKwlzcGluX2xvY2tfaXJxKCZpOTE1
LT5pcnFfbG9jayk7Cj4gKwlpZiAoaTkxNS0+ZGlzcGxheV9pcnFzX2VuYWJsZWQpCj4gKwkJdmx2
X2Rpc3BsYXlfaXJxX3Jlc2V0KGk5MTUpOwo+ICsJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFf
bG9jayk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHUzMiBpbnRlbF9ocGRfZW5hYmxlZF9pcnFzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHUzMiBpbnRlbF9ocGRf
ZW5hYmxlZF9pcnFzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgY29u
c3QgdTMyIGhwZFtIUERfTlVNX1BJTlNdKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyOwo+ICAgCXUzMiBlbmFibGVkX2lycXMgPSAwOwo+ICAgCj4gLQlmb3JfZWFjaF9p
bnRlbF9lbmNvZGVyKCZkZXZfcHJpdi0+ZHJtLCBlbmNvZGVyKQo+IC0JCWlmIChkZXZfcHJpdi0+
aG90cGx1Zy5zdGF0c1tlbmNvZGVyLT5ocGRfcGluXS5zdGF0ZSA9PSBIUERfRU5BQkxFRCkKPiAr
CWZvcl9lYWNoX2ludGVsX2VuY29kZXIoJmk5MTUtPmRybSwgZW5jb2RlcikKPiArCQlpZiAoaTkx
NS0+aG90cGx1Zy5zdGF0c1tlbmNvZGVyLT5ocGRfcGluXS5zdGF0ZSA9PSBIUERfRU5BQkxFRCkK
PiAgIAkJCWVuYWJsZWRfaXJxcyB8PSBocGRbZW5jb2Rlci0+aHBkX3Bpbl07Cj4gICAKPiAgIAly
ZXR1cm4gZW5hYmxlZF9pcnFzOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGlieF9ocGRfZGV0
ZWN0aW9uX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGlj
IHZvaWQgaWJ4X2hwZF9kZXRlY3Rpb25fc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCj4gICB7Cj4gICAJdTMyIGhvdHBsdWc7Cj4gICAKPiBAQCAtMzcyNCwyOSArMzcyNCwyOSBA
QCBzdGF0aWMgdm9pZCBpYnhfaHBkX2RldGVjdGlvbl9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gICAJICogV2hlbiBDUFUgYW5kIFBDSCBhcmUgb24gdGhlIHNhbWUg
cGFja2FnZSwgcG9ydCBBCj4gICAJICogSFBEIG11c3QgYmUgZW5hYmxlZCBpbiBib3RoIG5vcnRo
IGFuZCBzb3V0aC4KPiAgIAkgKi8KPiAtCWlmIChIQVNfUENIX0xQVF9MUChkZXZfcHJpdikpCj4g
KwlpZiAoSEFTX1BDSF9MUFRfTFAoaTkxNSkpCj4gICAJCWhvdHBsdWcgfD0gUE9SVEFfSE9UUExV
R19FTkFCTEU7Cj4gICAJSTkxNV9XUklURShQQ0hfUE9SVF9IT1RQTFVHLCBob3RwbHVnKTsKPiAg
IH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpYnhfaHBkX2lycV9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGlieF9ocGRfaXJxX3NldHVwKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUzMiBob3RwbHVnX2lycXMsIGVu
YWJsZWRfaXJxczsKPiAgIAo+IC0JaWYgKEhBU19QQ0hfSUJYKGRldl9wcml2KSkgewo+ICsJaWYg
KEhBU19QQ0hfSUJYKGk5MTUpKSB7Cj4gICAJCWhvdHBsdWdfaXJxcyA9IFNERV9IT1RQTFVHX01B
U0s7Cj4gLQkJZW5hYmxlZF9pcnFzID0gaW50ZWxfaHBkX2VuYWJsZWRfaXJxcyhkZXZfcHJpdiwg
aHBkX2lieCk7Cj4gKwkJZW5hYmxlZF9pcnFzID0gaW50ZWxfaHBkX2VuYWJsZWRfaXJxcyhpOTE1
LCBocGRfaWJ4KTsKPiAgIAl9IGVsc2Ugewo+ICAgCQlob3RwbHVnX2lycXMgPSBTREVfSE9UUExV
R19NQVNLX0NQVDsKPiAtCQllbmFibGVkX2lycXMgPSBpbnRlbF9ocGRfZW5hYmxlZF9pcnFzKGRl
dl9wcml2LCBocGRfY3B0KTsKPiArCQllbmFibGVkX2lycXMgPSBpbnRlbF9ocGRfZW5hYmxlZF9p
cnFzKGk5MTUsIGhwZF9jcHQpOwo+ICAgCX0KPiAgIAo+IC0JaWJ4X2Rpc3BsYXlfaW50ZXJydXB0
X3VwZGF0ZShkZXZfcHJpdiwgaG90cGx1Z19pcnFzLCBlbmFibGVkX2lycXMpOwo+ICsJaWJ4X2Rp
c3BsYXlfaW50ZXJydXB0X3VwZGF0ZShpOTE1LCBob3RwbHVnX2lycXMsIGVuYWJsZWRfaXJxcyk7
Cj4gICAKPiAtCWlieF9ocGRfZGV0ZWN0aW9uX3NldHVwKGRldl9wcml2KTsKPiArCWlieF9ocGRf
ZGV0ZWN0aW9uX3NldHVwKGk5MTUpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGljcF9ocGRf
ZGV0ZWN0aW9uX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3Rh
dGljIHZvaWQgaWNwX2hwZF9kZXRlY3Rpb25fc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCj4gICB7Cj4gICAJdTMyIGhvdHBsdWc7Cj4gICAKPiBAQCAtMzc2MywxOSArMzc2Mywx
OSBAQCBzdGF0aWMgdm9pZCBpY3BfaHBkX2RldGVjdGlvbl9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJSTkxNV9XUklURShTSE9UUExVR19DVExfVEMsIGhvdHBs
dWcpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGljcF9ocGRfaXJxX3NldHVwKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaWNwX2hwZF9pcnFfc2V0
dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJdTMyIGhvdHBsdWdf
aXJxcywgZW5hYmxlZF9pcnFzOwo+ICAgCj4gICAJaG90cGx1Z19pcnFzID0gU0RFX0RESV9NQVNL
X0lDUCB8IFNERV9UQ19NQVNLX0lDUDsKPiAtCWVuYWJsZWRfaXJxcyA9IGludGVsX2hwZF9lbmFi
bGVkX2lycXMoZGV2X3ByaXYsIGhwZF9pY3ApOwo+ICsJZW5hYmxlZF9pcnFzID0gaW50ZWxfaHBk
X2VuYWJsZWRfaXJxcyhpOTE1LCBocGRfaWNwKTsKPiAgIAo+IC0JaWJ4X2Rpc3BsYXlfaW50ZXJy
dXB0X3VwZGF0ZShkZXZfcHJpdiwgaG90cGx1Z19pcnFzLCBlbmFibGVkX2lycXMpOwo+ICsJaWJ4
X2Rpc3BsYXlfaW50ZXJydXB0X3VwZGF0ZShpOTE1LCBob3RwbHVnX2lycXMsIGVuYWJsZWRfaXJx
cyk7Cj4gICAKPiAtCWljcF9ocGRfZGV0ZWN0aW9uX3NldHVwKGRldl9wcml2KTsKPiArCWljcF9o
cGRfZGV0ZWN0aW9uX3NldHVwKGk5MTUpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGdlbjEx
X2hwZF9kZXRlY3Rpb25fc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ICtzdGF0aWMgdm9pZCBnZW4xMV9ocGRfZGV0ZWN0aW9uX3NldHVwKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUzMiBob3RwbHVnOwo+ICAgCj4gQEAgLTM3OTQsMTIg
KzM3OTQsMTIgQEAgc3RhdGljIHZvaWQgZ2VuMTFfaHBkX2RldGVjdGlvbl9zZXR1cChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJSTkxNV9XUklURShHRU4xMV9UQlRfSE9U
UExVR19DVEwsIGhvdHBsdWcpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGdlbjExX2hwZF9p
cnFfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9p
ZCBnZW4xMV9ocGRfaXJxX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAg
ewo+ICAgCXUzMiBob3RwbHVnX2lycXMsIGVuYWJsZWRfaXJxczsKPiAgIAl1MzIgdmFsOwo+ICAg
Cj4gLQllbmFibGVkX2lycXMgPSBpbnRlbF9ocGRfZW5hYmxlZF9pcnFzKGRldl9wcml2LCBocGRf
Z2VuMTEpOwo+ICsJZW5hYmxlZF9pcnFzID0gaW50ZWxfaHBkX2VuYWJsZWRfaXJxcyhpOTE1LCBo
cGRfZ2VuMTEpOwo+ICAgCWhvdHBsdWdfaXJxcyA9IEdFTjExX0RFX1RDX0hPVFBMVUdfTUFTSyB8
IEdFTjExX0RFX1RCVF9IT1RQTFVHX01BU0s7Cj4gICAKPiAgIAl2YWwgPSBJOTE1X1JFQUQoR0VO
MTFfREVfSFBEX0lNUik7Cj4gQEAgLTM4MDcsMTggKzM4MDcsMTggQEAgc3RhdGljIHZvaWQgZ2Vu
MTFfaHBkX2lycV9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJ
STkxNV9XUklURShHRU4xMV9ERV9IUERfSU1SLCB2YWwpOwo+ICAgCVBPU1RJTkdfUkVBRChHRU4x
MV9ERV9IUERfSU1SKTsKPiAgIAo+IC0JZ2VuMTFfaHBkX2RldGVjdGlvbl9zZXR1cChkZXZfcHJp
dik7Cj4gKwlnZW4xMV9ocGRfZGV0ZWN0aW9uX3NldHVwKGk5MTUpOwo+ICAgCj4gLQlpZiAoSU5U
RUxfUENIX1RZUEUoZGV2X3ByaXYpID49IFBDSF9JQ1ApCj4gLQkJaWNwX2hwZF9pcnFfc2V0dXAo
ZGV2X3ByaXYpOwo+ICsJaWYgKElOVEVMX1BDSF9UWVBFKGk5MTUpID49IFBDSF9JQ1ApCj4gKwkJ
aWNwX2hwZF9pcnFfc2V0dXAoaTkxNSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgc3B0X2hw
ZF9kZXRlY3Rpb25fc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtz
dGF0aWMgdm9pZCBzcHRfaHBkX2RldGVjdGlvbl9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKPiAgIHsKPiAgIAl1MzIgdmFsLCBob3RwbHVnOwo+ICAgCj4gICAJLyogRGlzcGxh
eSBXQSAjMTE3OSBXYUhhcmRIYW5nb25Ib3RQbHVnOiBjbnAgKi8KPiAtCWlmIChIQVNfUENIX0NO
UChkZXZfcHJpdikpIHsKPiArCWlmIChIQVNfUENIX0NOUChpOTE1KSkgewo+ICAgCQl2YWwgPSBJ
OTE1X1JFQUQoU09VVEhfQ0hJQ0tFTjEpOwo+ICAgCQl2YWwgJj0gfkNIQVNTSVNfQ0xLX1JFUV9E
VVJBVElPTl9NQVNLOwo+ICAgCQl2YWwgfD0gQ0hBU1NJU19DTEtfUkVRX0RVUkFUSU9OKDB4Zik7
Cj4gQEAgLTM4MzgsMTkgKzM4MzgsMTkgQEAgc3RhdGljIHZvaWQgc3B0X2hwZF9kZXRlY3Rpb25f
c2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCUk5MTVfV1JJVEUo
UENIX1BPUlRfSE9UUExVRzIsIGhvdHBsdWcpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIHNw
dF9ocGRfaXJxX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3Rh
dGljIHZvaWQgc3B0X2hwZF9pcnFfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gICB7Cj4gICAJdTMyIGhvdHBsdWdfaXJxcywgZW5hYmxlZF9pcnFzOwo+ICAgCj4gICAJaG90
cGx1Z19pcnFzID0gU0RFX0hPVFBMVUdfTUFTS19TUFQ7Cj4gLQllbmFibGVkX2lycXMgPSBpbnRl
bF9ocGRfZW5hYmxlZF9pcnFzKGRldl9wcml2LCBocGRfc3B0KTsKPiArCWVuYWJsZWRfaXJxcyA9
IGludGVsX2hwZF9lbmFibGVkX2lycXMoaTkxNSwgaHBkX3NwdCk7Cj4gICAKPiAtCWlieF9kaXNw
bGF5X2ludGVycnVwdF91cGRhdGUoZGV2X3ByaXYsIGhvdHBsdWdfaXJxcywgZW5hYmxlZF9pcnFz
KTsKPiArCWlieF9kaXNwbGF5X2ludGVycnVwdF91cGRhdGUoaTkxNSwgaG90cGx1Z19pcnFzLCBl
bmFibGVkX2lycXMpOwo+ICAgCj4gLQlzcHRfaHBkX2RldGVjdGlvbl9zZXR1cChkZXZfcHJpdik7
Cj4gKwlzcHRfaHBkX2RldGVjdGlvbl9zZXR1cChpOTE1KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMg
dm9pZCBpbGtfaHBkX2RldGVjdGlvbl9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGlsa19ocGRfZGV0ZWN0aW9uX3NldHVwKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUzMiBob3RwbHVnOwo+ICAgCj4gQEAgLTM4
NjYsMzMgKzM4NjYsMzMgQEAgc3RhdGljIHZvaWQgaWxrX2hwZF9kZXRlY3Rpb25fc2V0dXAoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCUk5MTVfV1JJVEUoRElHSVRBTF9Q
T1JUX0hPVFBMVUdfQ05UUkwsIGhvdHBsdWcpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGls
a19ocGRfaXJxX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3Rh
dGljIHZvaWQgaWxrX2hwZF9pcnFfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gICB7Cj4gICAJdTMyIGhvdHBsdWdfaXJxcywgZW5hYmxlZF9pcnFzOwo+ICAgCj4gLQlpZiAo
SU5URUxfR0VOKGRldl9wcml2KSA+PSA4KSB7Cj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDgp
IHsKPiAgIAkJaG90cGx1Z19pcnFzID0gR0VOOF9QT1JUX0RQX0FfSE9UUExVRzsKPiAtCQllbmFi
bGVkX2lycXMgPSBpbnRlbF9ocGRfZW5hYmxlZF9pcnFzKGRldl9wcml2LCBocGRfYmR3KTsKPiAr
CQllbmFibGVkX2lycXMgPSBpbnRlbF9ocGRfZW5hYmxlZF9pcnFzKGk5MTUsIGhwZF9iZHcpOwo+
ICAgCj4gLQkJYmR3X3VwZGF0ZV9wb3J0X2lycShkZXZfcHJpdiwgaG90cGx1Z19pcnFzLCBlbmFi
bGVkX2lycXMpOwo+IC0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDcpIHsKPiAr
CQliZHdfdXBkYXRlX3BvcnRfaXJxKGk5MTUsIGhvdHBsdWdfaXJxcywgZW5hYmxlZF9pcnFzKTsK
PiArCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDcpIHsKPiAgIAkJaG90cGx1Z19pcnFz
ID0gREVfRFBfQV9IT1RQTFVHX0lWQjsKPiAtCQllbmFibGVkX2lycXMgPSBpbnRlbF9ocGRfZW5h
YmxlZF9pcnFzKGRldl9wcml2LCBocGRfaXZiKTsKPiArCQllbmFibGVkX2lycXMgPSBpbnRlbF9o
cGRfZW5hYmxlZF9pcnFzKGk5MTUsIGhwZF9pdmIpOwo+ICAgCj4gLQkJaWxrX3VwZGF0ZV9kaXNw
bGF5X2lycShkZXZfcHJpdiwgaG90cGx1Z19pcnFzLCBlbmFibGVkX2lycXMpOwo+ICsJCWlsa191
cGRhdGVfZGlzcGxheV9pcnEoaTkxNSwgaG90cGx1Z19pcnFzLCBlbmFibGVkX2lycXMpOwo+ICAg
CX0gZWxzZSB7Cj4gICAJCWhvdHBsdWdfaXJxcyA9IERFX0RQX0FfSE9UUExVRzsKPiAtCQllbmFi
bGVkX2lycXMgPSBpbnRlbF9ocGRfZW5hYmxlZF9pcnFzKGRldl9wcml2LCBocGRfaWxrKTsKPiAr
CQllbmFibGVkX2lycXMgPSBpbnRlbF9ocGRfZW5hYmxlZF9pcnFzKGk5MTUsIGhwZF9pbGspOwo+
ICAgCj4gLQkJaWxrX3VwZGF0ZV9kaXNwbGF5X2lycShkZXZfcHJpdiwgaG90cGx1Z19pcnFzLCBl
bmFibGVkX2lycXMpOwo+ICsJCWlsa191cGRhdGVfZGlzcGxheV9pcnEoaTkxNSwgaG90cGx1Z19p
cnFzLCBlbmFibGVkX2lycXMpOwo+ICAgCX0KPiAgIAo+IC0JaWxrX2hwZF9kZXRlY3Rpb25fc2V0
dXAoZGV2X3ByaXYpOwo+ICsJaWxrX2hwZF9kZXRlY3Rpb25fc2V0dXAoaTkxNSk7Cj4gICAKPiAt
CWlieF9ocGRfaXJxX3NldHVwKGRldl9wcml2KTsKPiArCWlieF9ocGRfaXJxX3NldHVwKGk5MTUp
Owo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIF9fYnh0X2hwZF9kZXRlY3Rpb25fc2V0dXAoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBfX2J4dF9ocGRf
ZGV0ZWN0aW9uX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAg
ICAgIHUzMiBlbmFibGVkX2lycXMpCj4gICB7Cj4gICAJdTMyIGhvdHBsdWc7Cj4gQEAgLTM5MTEs
MTA2ICszOTExLDEwNiBAQCBzdGF0aWMgdm9pZCBfX2J4dF9ocGRfZGV0ZWN0aW9uX3NldHVwKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkgKiBmb3IgSFBEIGRldGVjdGlv
biBsb2dpYywgdXBkYXRlIGl0IGJhc2VkIG9uIFZCVCBmaWVsZHMuCj4gICAJICovCj4gICAJaWYg
KChlbmFibGVkX2lycXMgJiBCWFRfREVfUE9SVF9IUF9ERElBKSAmJgo+IC0JICAgIGludGVsX2Jp
b3NfaXNfcG9ydF9ocGRfaW52ZXJ0ZWQoZGV2X3ByaXYsIFBPUlRfQSkpCj4gKwkgICAgaW50ZWxf
Ymlvc19pc19wb3J0X2hwZF9pbnZlcnRlZChpOTE1LCBQT1JUX0EpKQo+ICAgCQlob3RwbHVnIHw9
IEJYVF9ERElBX0hQRF9JTlZFUlQ7Cj4gICAJaWYgKChlbmFibGVkX2lycXMgJiBCWFRfREVfUE9S
VF9IUF9ERElCKSAmJgo+IC0JICAgIGludGVsX2Jpb3NfaXNfcG9ydF9ocGRfaW52ZXJ0ZWQoZGV2
X3ByaXYsIFBPUlRfQikpCj4gKwkgICAgaW50ZWxfYmlvc19pc19wb3J0X2hwZF9pbnZlcnRlZChp
OTE1LCBQT1JUX0IpKQo+ICAgCQlob3RwbHVnIHw9IEJYVF9ERElCX0hQRF9JTlZFUlQ7Cj4gICAJ
aWYgKChlbmFibGVkX2lycXMgJiBCWFRfREVfUE9SVF9IUF9ERElDKSAmJgo+IC0JICAgIGludGVs
X2Jpb3NfaXNfcG9ydF9ocGRfaW52ZXJ0ZWQoZGV2X3ByaXYsIFBPUlRfQykpCj4gKwkgICAgaW50
ZWxfYmlvc19pc19wb3J0X2hwZF9pbnZlcnRlZChpOTE1LCBQT1JUX0MpKQo+ICAgCQlob3RwbHVn
IHw9IEJYVF9ERElDX0hQRF9JTlZFUlQ7Cj4gICAKPiAgIAlJOTE1X1dSSVRFKFBDSF9QT1JUX0hP
VFBMVUcsIGhvdHBsdWcpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGJ4dF9ocGRfZGV0ZWN0
aW9uX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZv
aWQgYnh0X2hwZF9kZXRlY3Rpb25fc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gICB7Cj4gLQlfX2J4dF9ocGRfZGV0ZWN0aW9uX3NldHVwKGRldl9wcml2LCBCWFRfREVfUE9S
VF9IT1RQTFVHX01BU0spOwo+ICsJX19ieHRfaHBkX2RldGVjdGlvbl9zZXR1cChpOTE1LCBCWFRf
REVfUE9SVF9IT1RQTFVHX01BU0spOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGJ4dF9ocGRf
aXJxX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZv
aWQgYnh0X2hwZF9pcnFfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7
Cj4gICAJdTMyIGhvdHBsdWdfaXJxcywgZW5hYmxlZF9pcnFzOwo+ICAgCj4gLQllbmFibGVkX2ly
cXMgPSBpbnRlbF9ocGRfZW5hYmxlZF9pcnFzKGRldl9wcml2LCBocGRfYnh0KTsKPiArCWVuYWJs
ZWRfaXJxcyA9IGludGVsX2hwZF9lbmFibGVkX2lycXMoaTkxNSwgaHBkX2J4dCk7Cj4gICAJaG90
cGx1Z19pcnFzID0gQlhUX0RFX1BPUlRfSE9UUExVR19NQVNLOwo+ICAgCj4gLQliZHdfdXBkYXRl
X3BvcnRfaXJxKGRldl9wcml2LCBob3RwbHVnX2lycXMsIGVuYWJsZWRfaXJxcyk7Cj4gKwliZHdf
dXBkYXRlX3BvcnRfaXJxKGk5MTUsIGhvdHBsdWdfaXJxcywgZW5hYmxlZF9pcnFzKTsKPiAgIAo+
IC0JX19ieHRfaHBkX2RldGVjdGlvbl9zZXR1cChkZXZfcHJpdiwgZW5hYmxlZF9pcnFzKTsKPiAr
CV9fYnh0X2hwZF9kZXRlY3Rpb25fc2V0dXAoaTkxNSwgZW5hYmxlZF9pcnFzKTsKPiAgIH0KPiAg
IAo+ICAgc3RhdGljIHZvaWQgaWJ4X2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7
Cj4gICAJdTMyIG1hc2s7Cj4gICAKPiAtCWlmIChIQVNfUENIX05PUChkZXZfcHJpdikpCj4gKwlp
ZiAoSEFTX1BDSF9OT1AoaTkxNSkpCj4gICAJCXJldHVybjsKPiAgIAo+IC0JaWYgKEhBU19QQ0hf
SUJYKGRldl9wcml2KSkKPiArCWlmIChIQVNfUENIX0lCWChpOTE1KSkKPiAgIAkJbWFzayA9IFNE
RV9HTUJVUyB8IFNERV9BVVhfTUFTSyB8IFNERV9QT0lTT047Cj4gLQllbHNlIGlmIChIQVNfUENI
X0NQVChkZXZfcHJpdikgfHwgSEFTX1BDSF9MUFQoZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAoSEFT
X1BDSF9DUFQoaTkxNSkgfHwgSEFTX1BDSF9MUFQoaTkxNSkpCj4gICAJCW1hc2sgPSBTREVfR01C
VVNfQ1BUIHwgU0RFX0FVWF9NQVNLX0NQVDsKPiAgIAllbHNlCj4gICAJCW1hc2sgPSBTREVfR01C
VVNfQ1BUOwo+ICAgCj4gLQlnZW4zX2Fzc2VydF9paXJfaXNfemVybygmZGV2X3ByaXYtPnVuY29y
ZSwgU0RFSUlSKTsKPiArCWdlbjNfYXNzZXJ0X2lpcl9pc196ZXJvKCZpOTE1LT51bmNvcmUsIFNE
RUlJUik7Cj4gICAJSTkxNV9XUklURShTREVJTVIsIH5tYXNrKTsKPiAgIAo+IC0JaWYgKEhBU19Q
Q0hfSUJYKGRldl9wcml2KSB8fCBIQVNfUENIX0NQVChkZXZfcHJpdikgfHwKPiAtCSAgICBIQVNf
UENIX0xQVChkZXZfcHJpdikpCj4gLQkJaWJ4X2hwZF9kZXRlY3Rpb25fc2V0dXAoZGV2X3ByaXYp
Owo+ICsJaWYgKEhBU19QQ0hfSUJYKGk5MTUpIHx8IEhBU19QQ0hfQ1BUKGk5MTUpIHx8Cj4gKwkg
ICAgSEFTX1BDSF9MUFQoaTkxNSkpCj4gKwkJaWJ4X2hwZF9kZXRlY3Rpb25fc2V0dXAoaTkxNSk7
Cj4gICAJZWxzZQo+IC0JCXNwdF9ocGRfZGV0ZWN0aW9uX3NldHVwKGRldl9wcml2KTsKPiArCQlz
cHRfaHBkX2RldGVjdGlvbl9zZXR1cChpOTE1KTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQg
Z2VuNV9ndF9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiAtCXN0
cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgaW50ZWxf
dW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwo+ICAgCXUzMiBwbV9pcnFzLCBndF9pcnFz
Owo+ICAgCj4gICAJcG1faXJxcyA9IGd0X2lycXMgPSAwOwo+ICAgCj4gLQlkZXZfcHJpdi0+Z3Rf
aXJxX21hc2sgPSB+MDsKPiAtCWlmIChIQVNfTDNfRFBGKGRldl9wcml2KSkgewo+ICsJaTkxNS0+
Z3RfaXJxX21hc2sgPSB+MDsKPiArCWlmIChIQVNfTDNfRFBGKGk5MTUpKSB7Cj4gICAJCS8qIEwz
IHBhcml0eSBpbnRlcnJ1cHQgaXMgYWx3YXlzIHVubWFza2VkLiAqLwo+IC0JCWRldl9wcml2LT5n
dF9pcnFfbWFzayA9IH5HVF9QQVJJVFlfRVJST1IoZGV2X3ByaXYpOwo+IC0JCWd0X2lycXMgfD0g
R1RfUEFSSVRZX0VSUk9SKGRldl9wcml2KTsKPiArCQlpOTE1LT5ndF9pcnFfbWFzayA9IH5HVF9Q
QVJJVFlfRVJST1IoaTkxNSk7Cj4gKwkJZ3RfaXJxcyB8PSBHVF9QQVJJVFlfRVJST1IoaTkxNSk7
Cj4gICAJfQo+ICAgCj4gICAJZ3RfaXJxcyB8PSBHVF9SRU5ERVJfVVNFUl9JTlRFUlJVUFQ7Cj4g
LQlpZiAoSVNfR0VOKGRldl9wcml2LCA1KSkgewo+ICsJaWYgKElTX0dFTihpOTE1LCA1KSkgewo+
ICAgCQlndF9pcnFzIHw9IElMS19CU0RfVVNFUl9JTlRFUlJVUFQ7Cj4gICAJfSBlbHNlIHsKPiAg
IAkJZ3RfaXJxcyB8PSBHVF9CTFRfVVNFUl9JTlRFUlJVUFQgfCBHVF9CU0RfVVNFUl9JTlRFUlJV
UFQ7Cj4gICAJfQo+ICAgCj4gLQlHRU4zX0lSUV9JTklUKHVuY29yZSwgR1QsIGRldl9wcml2LT5n
dF9pcnFfbWFzaywgZ3RfaXJxcyk7Cj4gKwlHRU4zX0lSUV9JTklUKHVuY29yZSwgR1QsIGk5MTUt
Pmd0X2lycV9tYXNrLCBndF9pcnFzKTsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gNikgewo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA2KSB7Cj4gICAJCS8qCj4gICAJCSAq
IFJQUyBpbnRlcnJ1cHRzIHdpbGwgZ2V0IGVuYWJsZWQvZGlzYWJsZWQgb24gZGVtYW5kIHdoZW4g
UlBTCj4gICAJCSAqIGl0c2VsZiBpcyBlbmFibGVkL2Rpc2FibGVkLgo+ICAgCQkgKi8KPiAtCQlp
ZiAoSEFTX0VOR0lORShkZXZfcHJpdiwgVkVDUzApKSB7Cj4gKwkJaWYgKEhBU19FTkdJTkUoaTkx
NSwgVkVDUzApKSB7Cj4gICAJCQlwbV9pcnFzIHw9IFBNX1ZFQk9YX1VTRVJfSU5URVJSVVBUOwo+
IC0JCQlkZXZfcHJpdi0+cG1faWVyIHw9IFBNX1ZFQk9YX1VTRVJfSU5URVJSVVBUOwo+ICsJCQlp
OTE1LT5wbV9pZXIgfD0gUE1fVkVCT1hfVVNFUl9JTlRFUlJVUFQ7Cj4gICAJCX0KPiAgIAo+IC0J
CWRldl9wcml2LT5wbV9pbXIgPSAweGZmZmZmZmZmOwo+IC0JCUdFTjNfSVJRX0lOSVQodW5jb3Jl
LCBHRU42X1BNLCBkZXZfcHJpdi0+cG1faW1yLCBwbV9pcnFzKTsKPiArCQlpOTE1LT5wbV9pbXIg
PSAweGZmZmZmZmZmOwo+ICsJCUdFTjNfSVJRX0lOSVQodW5jb3JlLCBHRU42X1BNLCBpOTE1LT5w
bV9pbXIsIHBtX2lycXMpOwo+ICAgCX0KPiAgIH0KPiAgIAo+ICAgc3RhdGljIGludCBpcm9ubGFr
ZV9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIHsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiAtCXN0cnVjdCBp
bnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwo+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgaW50ZWxfdW5jb3Jl
ICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwo+ICAgCXUzMiBkaXNwbGF5X21hc2ssIGV4dHJhX21h
c2s7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDcpIHsKPiArCWlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gNykgewo+ICAgCQlkaXNwbGF5X21hc2sgPSAoREVfTUFTVEVSX0lSUV9D
T05UUk9MIHwgREVfR1NFX0lWQiB8Cj4gICAJCQkJREVfUENIX0VWRU5UX0lWQiB8IERFX0FVWF9D
SEFOTkVMX0FfSVZCKTsKPiAgIAkJZXh0cmFfbWFzayA9IChERV9QSVBFQ19WQkxBTktfSVZCIHwg
REVfUElQRUJfVkJMQU5LX0lWQiB8Cj4gQEAgLTQwMjUsNzggKzQwMjUsNzggQEAgc3RhdGljIGlu
dCBpcm9ubGFrZV9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIAkJ
CSAgICAgIERFX0RQX0FfSE9UUExVRyk7Cj4gICAJfQo+ICAgCj4gLQlpZiAoSVNfSEFTV0VMTChk
ZXZfcHJpdikpIHsKPiArCWlmIChJU19IQVNXRUxMKGk5MTUpKSB7Cj4gICAJCWdlbjNfYXNzZXJ0
X2lpcl9pc196ZXJvKHVuY29yZSwgRURQX1BTUl9JSVIpOwo+IC0JCWludGVsX3Bzcl9pcnFfY29u
dHJvbChkZXZfcHJpdiwgZGV2X3ByaXYtPnBzci5kZWJ1Zyk7Cj4gKwkJaW50ZWxfcHNyX2lycV9j
b250cm9sKGk5MTUsIGk5MTUtPnBzci5kZWJ1Zyk7Cj4gICAJCWRpc3BsYXlfbWFzayB8PSBERV9F
RFBfUFNSX0lOVF9IU1c7Cj4gICAJfQo+ICAgCj4gLQlkZXZfcHJpdi0+aXJxX21hc2sgPSB+ZGlz
cGxheV9tYXNrOwo+ICsJaTkxNS0+aXJxX21hc2sgPSB+ZGlzcGxheV9tYXNrOwo+ICAgCj4gICAJ
aWJ4X2lycV9wcmVfcG9zdGluc3RhbGwoZGV2KTsKPiAgIAo+IC0JR0VOM19JUlFfSU5JVCh1bmNv
cmUsIERFLCBkZXZfcHJpdi0+aXJxX21hc2ssCj4gKwlHRU4zX0lSUV9JTklUKHVuY29yZSwgREUs
IGk5MTUtPmlycV9tYXNrLAo+ICAgCQkgICAgICBkaXNwbGF5X21hc2sgfCBleHRyYV9tYXNrKTsK
PiAgIAo+ICAgCWdlbjVfZ3RfaXJxX3Bvc3RpbnN0YWxsKGRldik7Cj4gICAKPiAtCWlsa19ocGRf
ZGV0ZWN0aW9uX3NldHVwKGRldl9wcml2KTsKPiArCWlsa19ocGRfZGV0ZWN0aW9uX3NldHVwKGk5
MTUpOwo+ICAgCj4gICAJaWJ4X2lycV9wb3N0aW5zdGFsbChkZXYpOwo+ICAgCj4gLQlpZiAoSVNf
SVJPTkxBS0VfTShkZXZfcHJpdikpIHsKPiArCWlmIChJU19JUk9OTEFLRV9NKGk5MTUpKSB7Cj4g
ICAJCS8qIEVuYWJsZSBQQ1UgZXZlbnQgaW50ZXJydXB0cwo+ICAgCQkgKgo+ICAgCQkgKiBzcGlu
bG9ja2luZyBub3QgcmVxdWlyZWQgaGVyZSBmb3IgY29ycmVjdG5lc3Mgc2luY2UgaW50ZXJydXB0
Cj4gICAJCSAqIHNldHVwIGlzIGd1YXJhbnRlZWQgdG8gcnVuIGluIHNpbmdsZS10aHJlYWRlZCBj
b250ZXh0LiBCdXQgd2UKPiAgIAkJICogbmVlZCBpdCB0byBtYWtlIHRoZSBhc3NlcnRfc3Bpbl9s
b2NrZWQgaGFwcHkuICovCj4gLQkJc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsK
PiAtCQlpbGtfZW5hYmxlX2Rpc3BsYXlfaXJxKGRldl9wcml2LCBERV9QQ1VfRVZFTlQpOwo+IC0J
CXNwaW5fdW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiArCQlzcGluX2xvY2tfaXJx
KCZpOTE1LT5pcnFfbG9jayk7Cj4gKwkJaWxrX2VuYWJsZV9kaXNwbGF5X2lycShpOTE1LCBERV9Q
Q1VfRVZFTlQpOwo+ICsJCXNwaW5fdW5sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ICAgCX0K
PiAgIAo+ICAgCXJldHVybiAwOwo+ICAgfQo+ICAgCj4gLXZvaWQgdmFsbGV5dmlld19lbmFibGVf
ZGlzcGxheV9pcnFzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9pZCB2
YWxsZXl2aWV3X2VuYWJsZV9kaXNwbGF5X2lycXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCj4gICB7Cj4gLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+
ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+aXJxX2xvY2spOwo+ICAgCj4gLQlpZiAoZGV2
X3ByaXYtPmRpc3BsYXlfaXJxc19lbmFibGVkKQo+ICsJaWYgKGk5MTUtPmRpc3BsYXlfaXJxc19l
bmFibGVkKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCWRldl9wcml2LT5kaXNwbGF5X2lycXNfZW5h
YmxlZCA9IHRydWU7Cj4gKwlpOTE1LT5kaXNwbGF5X2lycXNfZW5hYmxlZCA9IHRydWU7Cj4gICAK
PiAtCWlmIChpbnRlbF9pcnFzX2VuYWJsZWQoZGV2X3ByaXYpKSB7Cj4gLQkJdmx2X2Rpc3BsYXlf
aXJxX3Jlc2V0KGRldl9wcml2KTsKPiAtCQl2bHZfZGlzcGxheV9pcnFfcG9zdGluc3RhbGwoZGV2
X3ByaXYpOwo+ICsJaWYgKGludGVsX2lycXNfZW5hYmxlZChpOTE1KSkgewo+ICsJCXZsdl9kaXNw
bGF5X2lycV9yZXNldChpOTE1KTsKPiArCQl2bHZfZGlzcGxheV9pcnFfcG9zdGluc3RhbGwoaTkx
NSk7Cj4gICAJfQo+ICAgfQo+ICAgCj4gLXZvaWQgdmFsbGV5dmlld19kaXNhYmxlX2Rpc3BsYXlf
aXJxcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgdmFsbGV5dmll
d19kaXNhYmxlX2Rpc3BsYXlfaXJxcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAg
IHsKPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gKwlsb2Nr
ZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5pcnFfbG9jayk7Cj4gICAKPiAtCWlmICghZGV2X3ByaXYt
PmRpc3BsYXlfaXJxc19lbmFibGVkKQo+ICsJaWYgKCFpOTE1LT5kaXNwbGF5X2lycXNfZW5hYmxl
ZCkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQlkZXZfcHJpdi0+ZGlzcGxheV9pcnFzX2VuYWJsZWQg
PSBmYWxzZTsKPiArCWk5MTUtPmRpc3BsYXlfaXJxc19lbmFibGVkID0gZmFsc2U7Cj4gICAKPiAt
CWlmIChpbnRlbF9pcnFzX2VuYWJsZWQoZGV2X3ByaXYpKQo+IC0JCXZsdl9kaXNwbGF5X2lycV9y
ZXNldChkZXZfcHJpdik7Cj4gKwlpZiAoaW50ZWxfaXJxc19lbmFibGVkKGk5MTUpKQo+ICsJCXZs
dl9kaXNwbGF5X2lycV9yZXNldChpOTE1KTsKPiAgIH0KPiAgIAo+ICAgCj4gICBzdGF0aWMgaW50
IHZhbGxleXZpZXdfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAo+ICAg
CWdlbjVfZ3RfaXJxX3Bvc3RpbnN0YWxsKGRldik7Cj4gICAKPiAtCXNwaW5fbG9ja19pcnEoJmRl
dl9wcml2LT5pcnFfbG9jayk7Cj4gLQlpZiAoZGV2X3ByaXYtPmRpc3BsYXlfaXJxc19lbmFibGVk
KQo+IC0JCXZsdl9kaXNwbGF5X2lycV9wb3N0aW5zdGFsbChkZXZfcHJpdik7Cj4gLQlzcGluX3Vu
bG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gKwlzcGluX2xvY2tfaXJxKCZpOTE1LT5p
cnFfbG9jayk7Cj4gKwlpZiAoaTkxNS0+ZGlzcGxheV9pcnFzX2VuYWJsZWQpCj4gKwkJdmx2X2Rp
c3BsYXlfaXJxX3Bvc3RpbnN0YWxsKGk5MTUpOwo+ICsJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5p
cnFfbG9jayk7Cj4gICAKPiAgIAlJOTE1X1dSSVRFKFZMVl9NQVNURVJfSUVSLCBNQVNURVJfSU5U
RVJSVVBUX0VOQUJMRSk7Cj4gICAJUE9TVElOR19SRUFEKFZMVl9NQVNURVJfSUVSKTsKPiBAQCAt
NDEwNCw5ICs0MTA0LDkgQEAgc3RhdGljIGludCB2YWxsZXl2aWV3X2lycV9wb3N0aW5zdGFsbChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAgCXJldHVybiAwOwo+ICAgfQo+ICAgCj4gLXN0YXRp
YyB2b2lkIGdlbjhfZ3RfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiArc3RhdGljIHZvaWQgZ2VuOF9ndF9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNv
cmUgPSAmZGV2X3ByaXYtPnVuY29yZTsKPiArCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9
ICZpOTE1LT51bmNvcmU7Cj4gICAKPiAgIAkvKiBUaGVzZSBhcmUgaW50ZXJydXB0cyB3ZSdsbCB0
b2dnbGUgd2l0aCB0aGUgcmluZyBtYXNrIHJlZ2lzdGVyICovCj4gICAJdTMyIGd0X2ludGVycnVw
dHNbXSA9IHsKPiBAQCAtNDEyNiwyMSArNDEyNiwyMSBAQCBzdGF0aWMgdm9pZCBnZW44X2d0X2ly
cV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCSBH
VF9DT05URVhUX1NXSVRDSF9JTlRFUlJVUFQgPDwgR0VOOF9WRUNTX0lSUV9TSElGVCkKPiAgIAl9
Owo+ICAgCj4gLQlkZXZfcHJpdi0+cG1faWVyID0gMHgwOwo+IC0JZGV2X3ByaXYtPnBtX2ltciA9
IH5kZXZfcHJpdi0+cG1faWVyOwo+ICsJaTkxNS0+cG1faWVyID0gMHgwOwo+ICsJaTkxNS0+cG1f
aW1yID0gfmk5MTUtPnBtX2llcjsKPiAgIAlHRU44X0lSUV9JTklUX05EWCh1bmNvcmUsIEdULCAw
LCB+Z3RfaW50ZXJydXB0c1swXSwgZ3RfaW50ZXJydXB0c1swXSk7Cj4gICAJR0VOOF9JUlFfSU5J
VF9ORFgodW5jb3JlLCBHVCwgMSwgfmd0X2ludGVycnVwdHNbMV0sIGd0X2ludGVycnVwdHNbMV0p
Owo+ICAgCS8qCj4gICAJICogUlBTIGludGVycnVwdHMgd2lsbCBnZXQgZW5hYmxlZC9kaXNhYmxl
ZCBvbiBkZW1hbmQgd2hlbiBSUFMgaXRzZWxmCj4gICAJICogaXMgZW5hYmxlZC9kaXNhYmxlZC4g
U2FtZSB3aWwgYmUgdGhlIGNhc2UgZm9yIEd1QyBpbnRlcnJ1cHRzLgo+ICAgCSAqLwo+IC0JR0VO
OF9JUlFfSU5JVF9ORFgodW5jb3JlLCBHVCwgMiwgZGV2X3ByaXYtPnBtX2ltciwgZGV2X3ByaXYt
PnBtX2llcik7Cj4gKwlHRU44X0lSUV9JTklUX05EWCh1bmNvcmUsIEdULCAyLCBpOTE1LT5wbV9p
bXIsIGk5MTUtPnBtX2llcik7Cj4gICAJR0VOOF9JUlFfSU5JVF9ORFgodW5jb3JlLCBHVCwgMywg
fmd0X2ludGVycnVwdHNbM10sIGd0X2ludGVycnVwdHNbM10pOwo+ICAgfQo+ICAgCj4gLXN0YXRp
YyB2b2lkIGdlbjhfZGVfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiArc3RhdGljIHZvaWQgZ2VuOF9kZV9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNv
cmUgPSAmZGV2X3ByaXYtPnVuY29yZTsKPiArCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9
ICZpOTE1LT51bmNvcmU7Cj4gICAKPiAgIAl1MzIgZGVfcGlwZV9tYXNrZWQgPSBHRU44X1BJUEVf
Q0RDTEtfQ1JDX0RPTkU7Cj4gICAJdTMyIGRlX3BpcGVfZW5hYmxlczsKPiBAQCAtNDE0OSw4NCAr
NDE0OSw4NCBAQCBzdGF0aWMgdm9pZCBnZW44X2RlX2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJdTMyIGRlX21pc2NfbWFza2VkID0gR0VOOF9E
RV9FRFBfUFNSOwo+ICAgCWVudW0gcGlwZSBwaXBlOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRl
dl9wcml2KSA8PSAxMCkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPD0gMTApCj4gICAJCWRlX21p
c2NfbWFza2VkIHw9IEdFTjhfREVfTUlTQ19HU0U7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2
X3ByaXYpID49IDkpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkgewo+ICAgCQlkZV9w
aXBlX21hc2tlZCB8PSBHRU45X0RFX1BJUEVfSVJRX0ZBVUxUX0VSUk9SUzsKPiAgIAkJZGVfcG9y
dF9tYXNrZWQgfD0gR0VOOV9BVVhfQ0hBTk5FTF9CIHwgR0VOOV9BVVhfQ0hBTk5FTF9DIHwKPiAg
IAkJCQkgIEdFTjlfQVVYX0NIQU5ORUxfRDsKPiAtCQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikp
Cj4gKwkJaWYgKElTX0dFTjlfTFAoaTkxNSkpCj4gICAJCQlkZV9wb3J0X21hc2tlZCB8PSBCWFRf
REVfUE9SVF9HTUJVUzsKPiAgIAl9IGVsc2Ugewo+ICAgCQlkZV9waXBlX21hc2tlZCB8PSBHRU44
X0RFX1BJUEVfSVJRX0ZBVUxUX0VSUk9SUzsKPiAgIAl9Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDExKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiAgIAkJZGVf
cG9ydF9tYXNrZWQgfD0gSUNMX0FVWF9DSEFOTkVMX0U7Cj4gICAKPiAtCWlmIChJU19DTkxfV0lU
SF9QT1JUX0YoZGV2X3ByaXYpIHx8IElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCj4gKwlpZiAo
SVNfQ05MX1dJVEhfUE9SVF9GKGk5MTUpIHx8IElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiAgIAkJ
ZGVfcG9ydF9tYXNrZWQgfD0gQ05MX0FVWF9DSEFOTkVMX0Y7Cj4gICAKPiAgIAlkZV9waXBlX2Vu
YWJsZXMgPSBkZV9waXBlX21hc2tlZCB8IEdFTjhfUElQRV9WQkxBTksgfAo+ICAgCQkJCQkgICBH
RU44X1BJUEVfRklGT19VTkRFUlJVTjsKPiAgIAo+ICAgCWRlX3BvcnRfZW5hYmxlcyA9IGRlX3Bv
cnRfbWFza2VkOwo+IC0JaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKQo+ICsJaWYgKElTX0dFTjlf
TFAoaTkxNSkpCj4gICAJCWRlX3BvcnRfZW5hYmxlcyB8PSBCWFRfREVfUE9SVF9IT1RQTFVHX01B
U0s7Cj4gLQllbHNlIGlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAoSVNf
QlJPQURXRUxMKGk5MTUpKQo+ICAgCQlkZV9wb3J0X2VuYWJsZXMgfD0gR0VOOF9QT1JUX0RQX0Ff
SE9UUExVRzsKPiAgIAo+ICAgCWdlbjNfYXNzZXJ0X2lpcl9pc196ZXJvKHVuY29yZSwgRURQX1BT
Ul9JSVIpOwo+IC0JaW50ZWxfcHNyX2lycV9jb250cm9sKGRldl9wcml2LCBkZXZfcHJpdi0+cHNy
LmRlYnVnKTsKPiArCWludGVsX3Bzcl9pcnFfY29udHJvbChpOTE1LCBpOTE1LT5wc3IuZGVidWcp
Owo+ICAgCj4gLQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKSB7Cj4gLQkJZGV2X3ByaXYt
PmRlX2lycV9tYXNrW3BpcGVdID0gfmRlX3BpcGVfbWFza2VkOwo+ICsJZm9yX2VhY2hfcGlwZShp
OTE1LCBwaXBlKSB7Cj4gKwkJaTkxNS0+ZGVfaXJxX21hc2tbcGlwZV0gPSB+ZGVfcGlwZV9tYXNr
ZWQ7Cj4gICAKPiAtCQlpZiAoaW50ZWxfZGlzcGxheV9wb3dlcl9pc19lbmFibGVkKGRldl9wcml2
LAo+ICsJCWlmIChpbnRlbF9kaXNwbGF5X3Bvd2VyX2lzX2VuYWJsZWQoaTkxNSwKPiAgIAkJCQlQ
T1dFUl9ET01BSU5fUElQRShwaXBlKSkpCj4gICAJCQlHRU44X0lSUV9JTklUX05EWCh1bmNvcmUs
IERFX1BJUEUsIHBpcGUsCj4gLQkJCQkJICBkZXZfcHJpdi0+ZGVfaXJxX21hc2tbcGlwZV0sCj4g
KwkJCQkJICBpOTE1LT5kZV9pcnFfbWFza1twaXBlXSwKPiAgIAkJCQkJICBkZV9waXBlX2VuYWJs
ZXMpOwo+ICAgCX0KPiAgIAo+ICAgCUdFTjNfSVJRX0lOSVQodW5jb3JlLCBHRU44X0RFX1BPUlRf
LCB+ZGVfcG9ydF9tYXNrZWQsIGRlX3BvcnRfZW5hYmxlcyk7Cj4gICAJR0VOM19JUlFfSU5JVCh1
bmNvcmUsIEdFTjhfREVfTUlTQ18sIH5kZV9taXNjX21hc2tlZCwgZGVfbWlzY19tYXNrZWQpOwo+
ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkgewo+ICsJaWYgKElOVEVMX0dF
TihpOTE1KSA+PSAxMSkgewo+ICAgCQl1MzIgZGVfaHBkX21hc2tlZCA9IDA7Cj4gICAJCXUzMiBk
ZV9ocGRfZW5hYmxlcyA9IEdFTjExX0RFX1RDX0hPVFBMVUdfTUFTSyB8Cj4gICAJCQkJICAgICBH
RU4xMV9ERV9UQlRfSE9UUExVR19NQVNLOwo+ICAgCj4gICAJCUdFTjNfSVJRX0lOSVQodW5jb3Jl
LCBHRU4xMV9ERV9IUERfLCB+ZGVfaHBkX21hc2tlZCwKPiAgIAkJCSAgICAgIGRlX2hwZF9lbmFi
bGVzKTsKPiAtCQlnZW4xMV9ocGRfZGV0ZWN0aW9uX3NldHVwKGRldl9wcml2KTsKPiAtCX0gZWxz
ZSBpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpIHsKPiAtCQlieHRfaHBkX2RldGVjdGlvbl9zZXR1
cChkZXZfcHJpdik7Cj4gLQl9IGVsc2UgaWYgKElTX0JST0FEV0VMTChkZXZfcHJpdikpIHsKPiAt
CQlpbGtfaHBkX2RldGVjdGlvbl9zZXR1cChkZXZfcHJpdik7Cj4gKwkJZ2VuMTFfaHBkX2RldGVj
dGlvbl9zZXR1cChpOTE1KTsKPiArCX0gZWxzZSBpZiAoSVNfR0VOOV9MUChpOTE1KSkgewo+ICsJ
CWJ4dF9ocGRfZGV0ZWN0aW9uX3NldHVwKGk5MTUpOwo+ICsJfSBlbHNlIGlmIChJU19CUk9BRFdF
TEwoaTkxNSkpIHsKPiArCQlpbGtfaHBkX2RldGVjdGlvbl9zZXR1cChpOTE1KTsKPiAgIAl9Cj4g
ICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQgZ2VuOF9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9k
ZXZpY2UgKmRldikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShkZXYpOwo+ICAgCj4gLQlpZiAoSEFTX1BDSF9TUExJVChkZXZfcHJpdikpCj4gKwlpZiAoSEFT
X1BDSF9TUExJVChpOTE1KSkKPiAgIAkJaWJ4X2lycV9wcmVfcG9zdGluc3RhbGwoZGV2KTsKPiAg
IAo+IC0JZ2VuOF9ndF9pcnFfcG9zdGluc3RhbGwoZGV2X3ByaXYpOwo+IC0JZ2VuOF9kZV9pcnFf
cG9zdGluc3RhbGwoZGV2X3ByaXYpOwo+ICsJZ2VuOF9ndF9pcnFfcG9zdGluc3RhbGwoaTkxNSk7
Cj4gKwlnZW44X2RlX2lycV9wb3N0aW5zdGFsbChpOTE1KTsKPiAgIAo+IC0JaWYgKEhBU19QQ0hf
U1BMSVQoZGV2X3ByaXYpKQo+ICsJaWYgKEhBU19QQ0hfU1BMSVQoaTkxNSkpCj4gICAJCWlieF9p
cnFfcG9zdGluc3RhbGwoZGV2KTsKPiAgIAo+IC0JZ2VuOF9tYXN0ZXJfaW50cl9lbmFibGUoZGV2
X3ByaXYtPnVuY29yZS5yZWdzKTsKPiArCWdlbjhfbWFzdGVyX2ludHJfZW5hYmxlKGk5MTUtPnVu
Y29yZS5yZWdzKTsKPiAgIAo+ICAgCXJldHVybiAwOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lk
IGdlbjExX2d0X2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gK3N0YXRpYyB2b2lkIGdlbjExX2d0X2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAljb25zdCB1MzIgaXJxcyA9IEdUX1JFTkRFUl9V
U0VSX0lOVEVSUlVQVCB8IEdUX0NPTlRFWFRfU1dJVENIX0lOVEVSUlVQVDsKPiAgIAo+IEBAIC00
MjQ3LDggKzQyNDcsOCBAQCBzdGF0aWMgdm9pZCBnZW4xMV9ndF9pcnFfcG9zdGluc3RhbGwoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCSAqIFJQUyBpbnRlcnJ1cHRzIHdp
bGwgZ2V0IGVuYWJsZWQvZGlzYWJsZWQgb24gZGVtYW5kIHdoZW4gUlBTIGl0c2VsZgo+ICAgCSAq
IGlzIGVuYWJsZWQvZGlzYWJsZWQuCj4gICAJICovCj4gLQlkZXZfcHJpdi0+cG1faWVyID0gMHgw
Owo+IC0JZGV2X3ByaXYtPnBtX2ltciA9IH5kZXZfcHJpdi0+cG1faWVyOwo+ICsJaTkxNS0+cG1f
aWVyID0gMHgwOwo+ICsJaTkxNS0+cG1faW1yID0gfmk5MTUtPnBtX2llcjsKPiAgIAlJOTE1X1dS
SVRFKEdFTjExX0dQTV9XR0JPWFBFUkZfSU5UUl9FTkFCTEUsIDApOwo+ICAgCUk5MTVfV1JJVEUo
R0VOMTFfR1BNX1dHQk9YUEVSRl9JTlRSX01BU0ssICB+MCk7Cj4gICAKPiBAQCAtNDI1OSwzNiAr
NDI1OSwzNiBAQCBzdGF0aWMgdm9pZCBnZW4xMV9ndF9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCj4gICBzdGF0aWMgdm9pZCBpY3BfaXJxX3Bv
c3RpbnN0YWxsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAl1MzIgbWFzayA9IFNERV9HTUJVU19J
Q1A7Cj4gICAKPiAgIAlXQVJOX09OKEk5MTVfUkVBRChTREVJRVIpICE9IDApOwo+ICAgCUk5MTVf
V1JJVEUoU0RFSUVSLCAweGZmZmZmZmZmKTsKPiAgIAlQT1NUSU5HX1JFQUQoU0RFSUVSKTsKPiAg
IAo+IC0JZ2VuM19hc3NlcnRfaWlyX2lzX3plcm8oJmRldl9wcml2LT51bmNvcmUsIFNERUlJUik7
Cj4gKwlnZW4zX2Fzc2VydF9paXJfaXNfemVybygmaTkxNS0+dW5jb3JlLCBTREVJSVIpOwo+ICAg
CUk5MTVfV1JJVEUoU0RFSU1SLCB+bWFzayk7Cj4gICAKPiAtCWljcF9ocGRfZGV0ZWN0aW9uX3Nl
dHVwKGRldl9wcml2KTsKPiArCWljcF9ocGRfZGV0ZWN0aW9uX3NldHVwKGk5MTUpOwo+ICAgfQo+
ICAgCj4gICBzdGF0aWMgaW50IGdlbjExX2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZGV2
LT5kZXZfcHJpdmF0ZTsKPiAtCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJp
di0+dW5jb3JlOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkZXYtPmRldl9w
cml2YXRlOwo+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsK
PiAgIAl1MzIgZ3VfbWlzY19tYXNrZWQgPSBHRU4xMV9HVV9NSVNDX0dTRTsKPiAgIAo+IC0JaWYg
KElOVEVMX1BDSF9UWVBFKGRldl9wcml2KSA+PSBQQ0hfSUNQKQo+ICsJaWYgKElOVEVMX1BDSF9U
WVBFKGk5MTUpID49IFBDSF9JQ1ApCj4gICAJCWljcF9pcnFfcG9zdGluc3RhbGwoZGV2KTsKPiAg
IAo+IC0JZ2VuMTFfZ3RfaXJxX3Bvc3RpbnN0YWxsKGRldl9wcml2KTsKPiAtCWdlbjhfZGVfaXJx
X3Bvc3RpbnN0YWxsKGRldl9wcml2KTsKPiArCWdlbjExX2d0X2lycV9wb3N0aW5zdGFsbChpOTE1
KTsKPiArCWdlbjhfZGVfaXJxX3Bvc3RpbnN0YWxsKGk5MTUpOwo+ICAgCj4gICAJR0VOM19JUlFf
SU5JVCh1bmNvcmUsIEdFTjExX0dVX01JU0NfLCB+Z3VfbWlzY19tYXNrZWQsIGd1X21pc2NfbWFz
a2VkKTsKPiAgIAo+ICAgCUk5MTVfV1JJVEUoR0VOMTFfRElTUExBWV9JTlRfQ1RMLCBHRU4xMV9E
SVNQTEFZX0lSUV9FTkFCTEUpOwo+ICAgCj4gLQlnZW4xMV9tYXN0ZXJfaW50cl9lbmFibGUoZGV2
X3ByaXYtPnVuY29yZS5yZWdzKTsKPiArCWdlbjExX21hc3Rlcl9pbnRyX2VuYWJsZShpOTE1LT51
bmNvcmUucmVncyk7Cj4gICAJUE9TVElOR19SRUFEKEdFTjExX0dGWF9NU1RSX0lSUSk7Cj4gICAK
PiAgIAlyZXR1cm4gMDsKPiBAQCAtNDI5NiwxNCArNDI5NiwxNCBAQCBzdGF0aWMgaW50IGdlbjEx
X2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAgCj4gICBzdGF0aWMg
aW50IGNoZXJyeXZpZXdfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAo+
IC0JZ2VuOF9ndF9pcnFfcG9zdGluc3RhbGwoZGV2X3ByaXYpOwo+ICsJZ2VuOF9ndF9pcnFfcG9z
dGluc3RhbGwoaTkxNSk7Cj4gICAKPiAtCXNwaW5fbG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9j
ayk7Cj4gLQlpZiAoZGV2X3ByaXYtPmRpc3BsYXlfaXJxc19lbmFibGVkKQo+IC0JCXZsdl9kaXNw
bGF5X2lycV9wb3N0aW5zdGFsbChkZXZfcHJpdik7Cj4gLQlzcGluX3VubG9ja19pcnEoJmRldl9w
cml2LT5pcnFfbG9jayk7Cj4gKwlzcGluX2xvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gKwlp
ZiAoaTkxNS0+ZGlzcGxheV9pcnFzX2VuYWJsZWQpCj4gKwkJdmx2X2Rpc3BsYXlfaXJxX3Bvc3Rp
bnN0YWxsKGk5MTUpOwo+ICsJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gICAK
PiAgIAlJOTE1X1dSSVRFKEdFTjhfTUFTVEVSX0lSUSwgR0VOOF9NQVNURVJfSVJRX0NPTlRST0wp
Owo+ICAgCVBPU1RJTkdfUkVBRChHRU44X01BU1RFUl9JUlEpOwo+IEBAIC00MzEzLDE4ICs0MzEz
LDE4IEBAIHN0YXRpYyBpbnQgY2hlcnJ5dmlld19pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9k
ZXZpY2UgKmRldikKPiAgIAo+ICAgc3RhdGljIHZvaWQgaTh4eF9pcnFfcmVzZXQoc3RydWN0IGRy
bV9kZXZpY2UgKmRldikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZGV2KTsKPiAtCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZf
cHJpdi0+dW5jb3JlOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGRldik7Cj4gKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwo+
ICAgCj4gLQlpOXh4X3BpcGVzdGF0X2lycV9yZXNldChkZXZfcHJpdik7Cj4gKwlpOXh4X3BpcGVz
dGF0X2lycV9yZXNldChpOTE1KTsKPiAgIAo+ICAgCUdFTjJfSVJRX1JFU0VUKHVuY29yZSk7Cj4g
ICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQgaTh4eF9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9k
ZXZpY2UgKmRldikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZGV2KTsKPiAtCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJp
di0+dW5jb3JlOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRl
dik7Cj4gKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwo+ICAg
CXUxNiBlbmFibGVfbWFzazsKPiAgIAo+ICAgCWludGVsX3VuY29yZV93cml0ZTE2KHVuY29yZSwK
PiBAQCAtNDMzMyw3ICs0MzMzLDcgQEAgc3RhdGljIGludCBpOHh4X2lycV9wb3N0aW5zdGFsbChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAgCQkJICAgICAgIEk5MTVfRVJST1JfTUVNT1JZX1JF
RlJFU0gpKTsKPiAgIAo+ICAgCS8qIFVubWFzayB0aGUgaW50ZXJydXB0cyB0aGF0IHdlIGFsd2F5
cyB3YW50IG9uLiAqLwo+IC0JZGV2X3ByaXYtPmlycV9tYXNrID0KPiArCWk5MTUtPmlycV9tYXNr
ID0KPiAgIAkJfihJOTE1X0RJU1BMQVlfUElQRV9BX0VWRU5UX0lOVEVSUlVQVCB8Cj4gICAJCSAg
STkxNV9ESVNQTEFZX1BJUEVfQl9FVkVOVF9JTlRFUlJVUFQgfAo+ICAgCQkgIEk5MTVfTUFTVEVS
X0VSUk9SX0lOVEVSUlVQVCk7Cj4gQEAgLTQzNDQsMTQgKzQzNDQsMTQgQEAgc3RhdGljIGludCBp
OHh4X2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAgCQlJOTE1X01B
U1RFUl9FUlJPUl9JTlRFUlJVUFQgfAo+ICAgCQlJOTE1X1VTRVJfSU5URVJSVVBUOwo+ICAgCj4g
LQlHRU4yX0lSUV9JTklUKHVuY29yZSwgZGV2X3ByaXYtPmlycV9tYXNrLCBlbmFibGVfbWFzayk7
Cj4gKwlHRU4yX0lSUV9JTklUKHVuY29yZSwgaTkxNS0+aXJxX21hc2ssIGVuYWJsZV9tYXNrKTsK
PiAgIAo+ICAgCS8qIEludGVycnVwdCBzZXR1cCBpcyBhbHJlYWR5IGd1YXJhbnRlZWQgdG8gYmUg
c2luZ2xlLXRocmVhZGVkLCB0aGlzIGlzCj4gICAJICoganVzdCB0byBtYWtlIHRoZSBhc3NlcnRf
c3Bpbl9sb2NrZWQgY2hlY2sgaGFwcHkuICovCj4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+
aXJxX2xvY2spOwo+IC0JaTkxNV9lbmFibGVfcGlwZXN0YXQoZGV2X3ByaXYsIFBJUEVfQSwgUElQ
RV9DUkNfRE9ORV9JTlRFUlJVUFRfU1RBVFVTKTsKPiAtCWk5MTVfZW5hYmxlX3BpcGVzdGF0KGRl
dl9wcml2LCBQSVBFX0IsIFBJUEVfQ1JDX0RPTkVfSU5URVJSVVBUX1NUQVRVUyk7Cj4gLQlzcGlu
X3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gKwlzcGluX2xvY2tfaXJxKCZpOTE1
LT5pcnFfbG9jayk7Cj4gKwlpOTE1X2VuYWJsZV9waXBlc3RhdChpOTE1LCBQSVBFX0EsIFBJUEVf
Q1JDX0RPTkVfSU5URVJSVVBUX1NUQVRVUyk7Cj4gKwlpOTE1X2VuYWJsZV9waXBlc3RhdChpOTE1
LCBQSVBFX0IsIFBJUEVfQ1JDX0RPTkVfSU5URVJSVVBUX1NUQVRVUyk7Cj4gKwlzcGluX3VubG9j
a19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiAgIAo+ICAgCXJldHVybiAwOwo+ICAgfQo+IEBAIC00
Mzg2LDcgKzQzODYsNyBAQCBzdGF0aWMgdm9pZCBpOHh4X2Vycm9yX2lycV9hY2soc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJaW50ZWxfdW5jb3JlX3dyaXRlMTYodW5jb3JlLCBF
TVIsIGVtciB8ICplaXJfc3R1Y2spOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGk4eHhfZXJy
b3JfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0
aWMgdm9pZCBpOHh4X2Vycm9yX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ICAgCQkJCSAgIHUxNiBlaXIsIHUxNiBlaXJfc3R1Y2spCj4gICB7Cj4gICAJRFJNX0RF
QlVHKCJNYXN0ZXIgRXJyb3I6IEVJUiAweCUwNHhcbiIsIGVpcik7Cj4gQEAgLTQzOTUsNyArNDM5
NSw3IEBAIHN0YXRpYyB2b2lkIGk4eHhfZXJyb3JfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCQlEUk1fREVCVUdfRFJJVkVSKCJFSVIgc3R1Y2s6IDB4
JTA0eCwgbWFza2VkXG4iLCBlaXJfc3R1Y2spOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGk5
eHhfZXJyb3JfaXJxX2FjayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0
YXRpYyB2b2lkIGk5eHhfZXJyb3JfaXJxX2FjayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiAgIAkJCSAgICAgICB1MzIgKmVpciwgdTMyICplaXJfc3R1Y2spCj4gICB7Cj4gICAJdTMy
IGVtcjsKPiBAQCAtNDQyMyw3ICs0NDIzLDcgQEAgc3RhdGljIHZvaWQgaTl4eF9lcnJvcl9pcnFf
YWNrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlJOTE1X1dSSVRFKEVN
UiwgZW1yIHwgKmVpcl9zdHVjayk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaTl4eF9lcnJv
cl9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRp
YyB2b2lkIGk5eHhfZXJyb3JfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gICAJCQkJICAgdTMyIGVpciwgdTMyIGVpcl9zdHVjaykKPiAgIHsKPiAgIAlEUk1fREVC
VUcoIk1hc3RlciBFcnJvciwgRUlSIDB4JTA4eFxuIiwgZWlyKTsKPiBAQCAtNDQzNSwyMSArNDQz
NSwyMSBAQCBzdGF0aWMgdm9pZCBpOXh4X2Vycm9yX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIHN0YXRpYyBpcnFyZXR1cm5fdCBpOHh4X2lycV9oYW5k
bGVyKGludCBpcnEsIHZvaWQgKmFyZykKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
ID0gYXJnOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShk
ZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4g
ICAJaXJxcmV0dXJuX3QgcmV0ID0gSVJRX05PTkU7Cj4gICAKPiAtCWlmICghaW50ZWxfaXJxc19l
bmFibGVkKGRldl9wcml2KSkKPiArCWlmICghaW50ZWxfaXJxc19lbmFibGVkKGk5MTUpKQo+ICAg
CQlyZXR1cm4gSVJRX05PTkU7Cj4gICAKPiAgIAkvKiBJUlFzIGFyZSBzeW5jZWQgZHVyaW5nIHJ1
bnRpbWVfc3VzcGVuZCwgd2UgZG9uJ3QgcmVxdWlyZSBhIHdha2VyZWYgKi8KPiAtCWRpc2FibGVf
cnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7Cj4gKwlkaXNhYmxlX3JwbV93YWtlcmVmX2Fz
c2VydHMoaTkxNSk7Cj4gICAKPiAgIAlkbyB7Cj4gICAJCXUzMiBwaXBlX3N0YXRzW0k5MTVfTUFY
X1BJUEVTXSA9IHt9Owo+ICAgCQl1MTYgZWlyID0gMCwgZWlyX3N0dWNrID0gMDsKPiAgIAkJdTE2
IGlpcjsKPiAgIAo+IC0JCWlpciA9IGludGVsX3VuY29yZV9yZWFkMTYoJmRldl9wcml2LT51bmNv
cmUsIEdFTjJfSUlSKTsKPiArCQlpaXIgPSBpbnRlbF91bmNvcmVfcmVhZDE2KCZpOTE1LT51bmNv
cmUsIEdFTjJfSUlSKTsKPiAgIAkJaWYgKGlpciA9PSAwKQo+ICAgCQkJYnJlYWs7Cj4gICAKPiBA
QCAtNDQ1Nyw1MyArNDQ1Nyw1MyBAQCBzdGF0aWMgaXJxcmV0dXJuX3QgaTh4eF9pcnFfaGFuZGxl
cihpbnQgaXJxLCB2b2lkICphcmcpCj4gICAKPiAgIAkJLyogQ2FsbCByZWdhcmRsZXNzLCBhcyBz
b21lIHN0YXR1cyBiaXRzIG1pZ2h0IG5vdCBiZQo+ICAgCQkgKiBzaWduYWxsZWQgaW4gaWlyICov
Cj4gLQkJaTl4eF9waXBlc3RhdF9pcnFfYWNrKGRldl9wcml2LCBpaXIsIHBpcGVfc3RhdHMpOwo+
ICsJCWk5eHhfcGlwZXN0YXRfaXJxX2FjayhpOTE1LCBpaXIsIHBpcGVfc3RhdHMpOwo+ICAgCj4g
ICAJCWlmIChpaXIgJiBJOTE1X01BU1RFUl9FUlJPUl9JTlRFUlJVUFQpCj4gLQkJCWk4eHhfZXJy
b3JfaXJxX2FjayhkZXZfcHJpdiwgJmVpciwgJmVpcl9zdHVjayk7Cj4gKwkJCWk4eHhfZXJyb3Jf
aXJxX2FjayhpOTE1LCAmZWlyLCAmZWlyX3N0dWNrKTsKPiAgIAo+IC0JCWludGVsX3VuY29yZV93
cml0ZTE2KCZkZXZfcHJpdi0+dW5jb3JlLCBHRU4yX0lJUiwgaWlyKTsKPiArCQlpbnRlbF91bmNv
cmVfd3JpdGUxNigmaTkxNS0+dW5jb3JlLCBHRU4yX0lJUiwgaWlyKTsKPiAgIAo+ICAgCQlpZiAo
aWlyICYgSTkxNV9VU0VSX0lOVEVSUlVQVCkKPiAtCQkJaW50ZWxfZW5naW5lX2JyZWFkY3J1bWJz
X2lycShkZXZfcHJpdi0+ZW5naW5lW1JDUzBdKTsKPiArCQkJaW50ZWxfZW5naW5lX2JyZWFkY3J1
bWJzX2lycShpOTE1LT5lbmdpbmVbUkNTMF0pOwo+ICAgCj4gICAJCWlmIChpaXIgJiBJOTE1X01B
U1RFUl9FUlJPUl9JTlRFUlJVUFQpCj4gLQkJCWk4eHhfZXJyb3JfaXJxX2hhbmRsZXIoZGV2X3By
aXYsIGVpciwgZWlyX3N0dWNrKTsKPiArCQkJaTh4eF9lcnJvcl9pcnFfaGFuZGxlcihpOTE1LCBl
aXIsIGVpcl9zdHVjayk7Cj4gICAKPiAtCQlpOHh4X3BpcGVzdGF0X2lycV9oYW5kbGVyKGRldl9w
cml2LCBpaXIsIHBpcGVfc3RhdHMpOwo+ICsJCWk4eHhfcGlwZXN0YXRfaXJxX2hhbmRsZXIoaTkx
NSwgaWlyLCBwaXBlX3N0YXRzKTsKPiAgIAl9IHdoaWxlICgwKTsKPiAgIAo+IC0JZW5hYmxlX3Jw
bV93YWtlcmVmX2Fzc2VydHMoZGV2X3ByaXYpOwo+ICsJZW5hYmxlX3JwbV93YWtlcmVmX2Fzc2Vy
dHMoaTkxNSk7Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9p
ZCBpOTE1X2lycV9yZXNldChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAgewo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+IC0Jc3RydWN0IGlu
dGVsX3VuY29yZSAqdW5jb3JlID0gJmRldl9wcml2LT51bmNvcmU7Cj4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBpbnRlbF91bmNvcmUg
KnVuY29yZSA9ICZpOTE1LT51bmNvcmU7Cj4gICAKPiAtCWlmIChJOTE1X0hBU19IT1RQTFVHKGRl
dl9wcml2KSkgewo+IC0JCWk5MTVfaG90cGx1Z19pbnRlcnJ1cHRfdXBkYXRlKGRldl9wcml2LCAw
eGZmZmZmZmZmLCAwKTsKPiArCWlmIChJOTE1X0hBU19IT1RQTFVHKGk5MTUpKSB7Cj4gKwkJaTkx
NV9ob3RwbHVnX2ludGVycnVwdF91cGRhdGUoaTkxNSwgMHhmZmZmZmZmZiwgMCk7Cj4gICAJCUk5
MTVfV1JJVEUoUE9SVF9IT1RQTFVHX1NUQVQsIEk5MTVfUkVBRChQT1JUX0hPVFBMVUdfU1RBVCkp
Owo+ICAgCX0KPiAgIAo+IC0JaTl4eF9waXBlc3RhdF9pcnFfcmVzZXQoZGV2X3ByaXYpOwo+ICsJ
aTl4eF9waXBlc3RhdF9pcnFfcmVzZXQoaTkxNSk7Cj4gICAKPiAgIAlHRU4zX0lSUV9SRVNFVCh1
bmNvcmUsIEdFTjJfKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGludCBpOTE1X2lycV9wb3N0aW5z
dGFsbChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+IC0Jc3RydWN0IGludGVsX3VuY29yZSAq
dW5jb3JlID0gJmRldl9wcml2LT51bmNvcmU7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZp
OTE1LT51bmNvcmU7Cj4gICAJdTMyIGVuYWJsZV9tYXNrOwo+ICAgCj4gICAJSTkxNV9XUklURShF
TVIsIH4oSTkxNV9FUlJPUl9QQUdFX1RBQkxFIHwKPiAgIAkJCSAgSTkxNV9FUlJPUl9NRU1PUllf
UkVGUkVTSCkpOwo+ICAgCj4gICAJLyogVW5tYXNrIHRoZSBpbnRlcnJ1cHRzIHRoYXQgd2UgYWx3
YXlzIHdhbnQgb24uICovCj4gLQlkZXZfcHJpdi0+aXJxX21hc2sgPQo+ICsJaTkxNS0+aXJxX21h
c2sgPQo+ICAgCQl+KEk5MTVfQVNMRV9JTlRFUlJVUFQgfAo+ICAgCQkgIEk5MTVfRElTUExBWV9Q
SVBFX0FfRVZFTlRfSU5URVJSVVBUIHwKPiAgIAkJICBJOTE1X0RJU1BMQVlfUElQRV9CX0VWRU5U
X0lOVEVSUlVQVCB8Cj4gQEAgLTQ1MTYsMjMgKzQ1MTYsMjMgQEAgc3RhdGljIGludCBpOTE1X2ly
cV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAgCQlJOTE1X01BU1RFUl9F
UlJPUl9JTlRFUlJVUFQgfAo+ICAgCQlJOTE1X1VTRVJfSU5URVJSVVBUOwo+ICAgCj4gLQlpZiAo
STkxNV9IQVNfSE9UUExVRyhkZXZfcHJpdikpIHsKPiArCWlmIChJOTE1X0hBU19IT1RQTFVHKGk5
MTUpKSB7Cj4gICAJCS8qIEVuYWJsZSBpbiBJRVIuLi4gKi8KPiAgIAkJZW5hYmxlX21hc2sgfD0g
STkxNV9ESVNQTEFZX1BPUlRfSU5URVJSVVBUOwo+ICAgCQkvKiBhbmQgdW5tYXNrIGluIElNUiAq
Lwo+IC0JCWRldl9wcml2LT5pcnFfbWFzayAmPSB+STkxNV9ESVNQTEFZX1BPUlRfSU5URVJSVVBU
Owo+ICsJCWk5MTUtPmlycV9tYXNrICY9IH5JOTE1X0RJU1BMQVlfUE9SVF9JTlRFUlJVUFQ7Cj4g
ICAJfQo+ICAgCj4gLQlHRU4zX0lSUV9JTklUKHVuY29yZSwgR0VOMl8sIGRldl9wcml2LT5pcnFf
bWFzaywgZW5hYmxlX21hc2spOwo+ICsJR0VOM19JUlFfSU5JVCh1bmNvcmUsIEdFTjJfLCBpOTE1
LT5pcnFfbWFzaywgZW5hYmxlX21hc2spOwo+ICAgCj4gICAJLyogSW50ZXJydXB0IHNldHVwIGlz
IGFscmVhZHkgZ3VhcmFudGVlZCB0byBiZSBzaW5nbGUtdGhyZWFkZWQsIHRoaXMgaXMKPiAgIAkg
KiBqdXN0IHRvIG1ha2UgdGhlIGFzc2VydF9zcGluX2xvY2tlZCBjaGVjayBoYXBweS4gKi8KPiAt
CXNwaW5fbG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gLQlpOTE1X2VuYWJsZV9waXBl
c3RhdChkZXZfcHJpdiwgUElQRV9BLCBQSVBFX0NSQ19ET05FX0lOVEVSUlVQVF9TVEFUVVMpOwo+
IC0JaTkxNV9lbmFibGVfcGlwZXN0YXQoZGV2X3ByaXYsIFBJUEVfQiwgUElQRV9DUkNfRE9ORV9J
TlRFUlJVUFRfU1RBVFVTKTsKPiAtCXNwaW5fdW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2Nr
KTsKPiArCXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiArCWk5MTVfZW5hYmxlX3Bp
cGVzdGF0KGk5MTUsIFBJUEVfQSwgUElQRV9DUkNfRE9ORV9JTlRFUlJVUFRfU1RBVFVTKTsKPiAr
CWk5MTVfZW5hYmxlX3BpcGVzdGF0KGk5MTUsIFBJUEVfQiwgUElQRV9DUkNfRE9ORV9JTlRFUlJV
UFRfU1RBVFVTKTsKPiArCXNwaW5fdW5sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ICAgCj4g
LQlpOTE1X2VuYWJsZV9hc2xlX3BpcGVzdGF0KGRldl9wcml2KTsKPiArCWk5MTVfZW5hYmxlX2Fz
bGVfcGlwZXN0YXQoaTkxNSk7Cj4gICAKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiBAQCAtNDU0MCwx
NCArNDU0MCwxNCBAQCBzdGF0aWMgaW50IGk5MTVfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYpCj4gICBzdGF0aWMgaXJxcmV0dXJuX3QgaTkxNV9pcnFfaGFuZGxlcihpbnQg
aXJxLCB2b2lkICphcmcpCj4gICB7Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGFyZzsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCWlycXJl
dHVybl90IHJldCA9IElSUV9OT05FOwo+ICAgCj4gLQlpZiAoIWludGVsX2lycXNfZW5hYmxlZChk
ZXZfcHJpdikpCj4gKwlpZiAoIWludGVsX2lycXNfZW5hYmxlZChpOTE1KSkKPiAgIAkJcmV0dXJu
IElSUV9OT05FOwo+ICAgCj4gICAJLyogSVJRcyBhcmUgc3luY2VkIGR1cmluZyBydW50aW1lX3N1
c3BlbmQsIHdlIGRvbid0IHJlcXVpcmUgYSB3YWtlcmVmICovCj4gLQlkaXNhYmxlX3JwbV93YWtl
cmVmX2Fzc2VydHMoZGV2X3ByaXYpOwo+ICsJZGlzYWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGk5
MTUpOwo+ICAgCj4gICAJZG8gewo+ICAgCQl1MzIgcGlwZV9zdGF0c1tJOTE1X01BWF9QSVBFU10g
PSB7fTsKPiBAQCAtNDU2MSw1MyArNDU2MSw1MyBAQCBzdGF0aWMgaXJxcmV0dXJuX3QgaTkxNV9p
cnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcpCj4gICAKPiAgIAkJcmV0ID0gSVJRX0hBTkRM
RUQ7Cj4gICAKPiAtCQlpZiAoSTkxNV9IQVNfSE9UUExVRyhkZXZfcHJpdikgJiYKPiArCQlpZiAo
STkxNV9IQVNfSE9UUExVRyhpOTE1KSAmJgo+ICAgCQkgICAgaWlyICYgSTkxNV9ESVNQTEFZX1BP
UlRfSU5URVJSVVBUKQo+IC0JCQlob3RwbHVnX3N0YXR1cyA9IGk5eHhfaHBkX2lycV9hY2soZGV2
X3ByaXYpOwo+ICsJCQlob3RwbHVnX3N0YXR1cyA9IGk5eHhfaHBkX2lycV9hY2soaTkxNSk7Cj4g
ICAKPiAgIAkJLyogQ2FsbCByZWdhcmRsZXNzLCBhcyBzb21lIHN0YXR1cyBiaXRzIG1pZ2h0IG5v
dCBiZQo+ICAgCQkgKiBzaWduYWxsZWQgaW4gaWlyICovCj4gLQkJaTl4eF9waXBlc3RhdF9pcnFf
YWNrKGRldl9wcml2LCBpaXIsIHBpcGVfc3RhdHMpOwo+ICsJCWk5eHhfcGlwZXN0YXRfaXJxX2Fj
ayhpOTE1LCBpaXIsIHBpcGVfc3RhdHMpOwo+ICAgCj4gICAJCWlmIChpaXIgJiBJOTE1X01BU1RF
Ul9FUlJPUl9JTlRFUlJVUFQpCj4gLQkJCWk5eHhfZXJyb3JfaXJxX2FjayhkZXZfcHJpdiwgJmVp
ciwgJmVpcl9zdHVjayk7Cj4gKwkJCWk5eHhfZXJyb3JfaXJxX2FjayhpOTE1LCAmZWlyLCAmZWly
X3N0dWNrKTsKPiAgIAo+ICAgCQlJOTE1X1dSSVRFKEdFTjJfSUlSLCBpaXIpOwo+ICAgCj4gICAJ
CWlmIChpaXIgJiBJOTE1X1VTRVJfSU5URVJSVVBUKQo+IC0JCQlpbnRlbF9lbmdpbmVfYnJlYWRj
cnVtYnNfaXJxKGRldl9wcml2LT5lbmdpbmVbUkNTMF0pOwo+ICsJCQlpbnRlbF9lbmdpbmVfYnJl
YWRjcnVtYnNfaXJxKGk5MTUtPmVuZ2luZVtSQ1MwXSk7Cj4gICAKPiAgIAkJaWYgKGlpciAmIEk5
MTVfTUFTVEVSX0VSUk9SX0lOVEVSUlVQVCkKPiAtCQkJaTl4eF9lcnJvcl9pcnFfaGFuZGxlcihk
ZXZfcHJpdiwgZWlyLCBlaXJfc3R1Y2spOwo+ICsJCQlpOXh4X2Vycm9yX2lycV9oYW5kbGVyKGk5
MTUsIGVpciwgZWlyX3N0dWNrKTsKPiAgIAo+ICAgCQlpZiAoaG90cGx1Z19zdGF0dXMpCj4gLQkJ
CWk5eHhfaHBkX2lycV9oYW5kbGVyKGRldl9wcml2LCBob3RwbHVnX3N0YXR1cyk7Cj4gKwkJCWk5
eHhfaHBkX2lycV9oYW5kbGVyKGk5MTUsIGhvdHBsdWdfc3RhdHVzKTsKPiAgIAo+IC0JCWk5MTVf
cGlwZXN0YXRfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIGlpciwgcGlwZV9zdGF0cyk7Cj4gKwkJaTkx
NV9waXBlc3RhdF9pcnFfaGFuZGxlcihpOTE1LCBpaXIsIHBpcGVfc3RhdHMpOwo+ICAgCX0gd2hp
bGUgKDApOwo+ICAgCj4gLQllbmFibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7Cj4g
KwllbmFibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhpOTE1KTsKPiAgIAo+ICAgCXJldHVybiByZXQ7
Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIGk5NjVfaXJxX3Jlc2V0KHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGRldik7Cj4gLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYt
PnVuY29yZTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYp
Owo+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsKPiAgIAo+
IC0JaTkxNV9ob3RwbHVnX2ludGVycnVwdF91cGRhdGUoZGV2X3ByaXYsIDB4ZmZmZmZmZmYsIDAp
Owo+ICsJaTkxNV9ob3RwbHVnX2ludGVycnVwdF91cGRhdGUoaTkxNSwgMHhmZmZmZmZmZiwgMCk7
Cj4gICAJSTkxNV9XUklURShQT1JUX0hPVFBMVUdfU1RBVCwgSTkxNV9SRUFEKFBPUlRfSE9UUExV
R19TVEFUKSk7Cj4gICAKPiAtCWk5eHhfcGlwZXN0YXRfaXJxX3Jlc2V0KGRldl9wcml2KTsKPiAr
CWk5eHhfcGlwZXN0YXRfaXJxX3Jlc2V0KGk5MTUpOwo+ICAgCj4gICAJR0VOM19JUlFfUkVTRVQo
dW5jb3JlLCBHRU4yXyk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQgaTk2NV9pcnFfcG9zdGlu
c3RhbGwoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiAtCXN0cnVjdCBpbnRlbF91bmNvcmUg
KnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAm
aTkxNS0+dW5jb3JlOwo+ICAgCXUzMiBlbmFibGVfbWFzazsKPiAgIAl1MzIgZXJyb3JfbWFzazsK
PiAgIAo+IEBAIC00NjE1LDcgKzQ2MTUsNyBAQCBzdGF0aWMgaW50IGk5NjVfaXJxX3Bvc3RpbnN0
YWxsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gICAJICogRW5hYmxlIHNvbWUgZXJyb3IgZGV0
ZWN0aW9uLCBub3RlIHRoZSBpbnN0cnVjdGlvbiBlcnJvciBtYXNrCj4gICAJICogYml0IGlzIHJl
c2VydmVkLCBzbyB3ZSBsZWF2ZSBpdCBtYXNrZWQuCj4gICAJICovCj4gLQlpZiAoSVNfRzRYKGRl
dl9wcml2KSkgewo+ICsJaWYgKElTX0c0WChpOTE1KSkgewo+ICAgCQllcnJvcl9tYXNrID0gfihH
TTQ1X0VSUk9SX1BBR0VfVEFCTEUgfAo+ICAgCQkJICAgICAgIEdNNDVfRVJST1JfTUVNX1BSSVYg
fAo+ICAgCQkJICAgICAgIEdNNDVfRVJST1JfQ1BfUFJJViB8Cj4gQEAgLTQ2MjcsNyArNDYyNyw3
IEBAIHN0YXRpYyBpbnQgaTk2NV9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9kZXZpY2UgKmRl
dikKPiAgIAlJOTE1X1dSSVRFKEVNUiwgZXJyb3JfbWFzayk7Cj4gICAKPiAgIAkvKiBVbm1hc2sg
dGhlIGludGVycnVwdHMgdGhhdCB3ZSBhbHdheXMgd2FudCBvbi4gKi8KPiAtCWRldl9wcml2LT5p
cnFfbWFzayA9Cj4gKwlpOTE1LT5pcnFfbWFzayA9Cj4gICAJCX4oSTkxNV9BU0xFX0lOVEVSUlVQ
VCB8Cj4gICAJCSAgSTkxNV9ESVNQTEFZX1BPUlRfSU5URVJSVVBUIHwKPiAgIAkJICBJOTE1X0RJ
U1BMQVlfUElQRV9BX0VWRU5UX0lOVEVSUlVQVCB8Cj4gQEAgLTQ2NDIsNDMgKzQ2NDIsNDMgQEAg
c3RhdGljIGludCBpOTY1X2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+
ICAgCQlJOTE1X01BU1RFUl9FUlJPUl9JTlRFUlJVUFQgfAo+ICAgCQlJOTE1X1VTRVJfSU5URVJS
VVBUOwo+ICAgCj4gLQlpZiAoSVNfRzRYKGRldl9wcml2KSkKPiArCWlmIChJU19HNFgoaTkxNSkp
Cj4gICAJCWVuYWJsZV9tYXNrIHw9IEk5MTVfQlNEX1VTRVJfSU5URVJSVVBUOwo+ICAgCj4gLQlH
RU4zX0lSUV9JTklUKHVuY29yZSwgR0VOMl8sIGRldl9wcml2LT5pcnFfbWFzaywgZW5hYmxlX21h
c2spOwo+ICsJR0VOM19JUlFfSU5JVCh1bmNvcmUsIEdFTjJfLCBpOTE1LT5pcnFfbWFzaywgZW5h
YmxlX21hc2spOwo+ICAgCj4gICAJLyogSW50ZXJydXB0IHNldHVwIGlzIGFscmVhZHkgZ3VhcmFu
dGVlZCB0byBiZSBzaW5nbGUtdGhyZWFkZWQsIHRoaXMgaXMKPiAgIAkgKiBqdXN0IHRvIG1ha2Ug
dGhlIGFzc2VydF9zcGluX2xvY2tlZCBjaGVjayBoYXBweS4gKi8KPiAtCXNwaW5fbG9ja19pcnEo
JmRldl9wcml2LT5pcnFfbG9jayk7Cj4gLQlpOTE1X2VuYWJsZV9waXBlc3RhdChkZXZfcHJpdiwg
UElQRV9BLCBQSVBFX0dNQlVTX0lOVEVSUlVQVF9TVEFUVVMpOwo+IC0JaTkxNV9lbmFibGVfcGlw
ZXN0YXQoZGV2X3ByaXYsIFBJUEVfQSwgUElQRV9DUkNfRE9ORV9JTlRFUlJVUFRfU1RBVFVTKTsK
PiAtCWk5MTVfZW5hYmxlX3BpcGVzdGF0KGRldl9wcml2LCBQSVBFX0IsIFBJUEVfQ1JDX0RPTkVf
SU5URVJSVVBUX1NUQVRVUyk7Cj4gLQlzcGluX3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9j
ayk7Cj4gKwlzcGluX2xvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gKwlpOTE1X2VuYWJsZV9w
aXBlc3RhdChpOTE1LCBQSVBFX0EsIFBJUEVfR01CVVNfSU5URVJSVVBUX1NUQVRVUyk7Cj4gKwlp
OTE1X2VuYWJsZV9waXBlc3RhdChpOTE1LCBQSVBFX0EsIFBJUEVfQ1JDX0RPTkVfSU5URVJSVVBU
X1NUQVRVUyk7Cj4gKwlpOTE1X2VuYWJsZV9waXBlc3RhdChpOTE1LCBQSVBFX0IsIFBJUEVfQ1JD
X0RPTkVfSU5URVJSVVBUX1NUQVRVUyk7Cj4gKwlzcGluX3VubG9ja19pcnEoJmk5MTUtPmlycV9s
b2NrKTsKPiAgIAo+IC0JaTkxNV9lbmFibGVfYXNsZV9waXBlc3RhdChkZXZfcHJpdik7Cj4gKwlp
OTE1X2VuYWJsZV9hc2xlX3BpcGVzdGF0KGk5MTUpOwo+ICAgCj4gICAJcmV0dXJuIDA7Cj4gICB9
Cj4gICAKPiAtc3RhdGljIHZvaWQgaTkxNV9ocGRfaXJxX3NldHVwKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaTkxNV9ocGRfaXJxX3NldHVwKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUzMiBob3RwbHVnX2VuOwo+ICAg
Cj4gLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ICsJbG9ja2Rl
cF9hc3NlcnRfaGVsZCgmaTkxNS0+aXJxX2xvY2spOwo+ICAgCj4gICAJLyogTm90ZSBIRE1JIGFu
ZCBEUCBzaGFyZSBob3RwbHVnIGJpdHMgKi8KPiAgIAkvKiBlbmFibGUgYml0cyBhcmUgdGhlIHNh
bWUgZm9yIGFsbCBnZW5lcmF0aW9ucyAqLwo+IC0JaG90cGx1Z19lbiA9IGludGVsX2hwZF9lbmFi
bGVkX2lycXMoZGV2X3ByaXYsIGhwZF9tYXNrX2k5MTUpOwo+ICsJaG90cGx1Z19lbiA9IGludGVs
X2hwZF9lbmFibGVkX2lycXMoaTkxNSwgaHBkX21hc2tfaTkxNSk7Cj4gICAJLyogUHJvZ3JhbW1p
bmcgdGhlIENSVCBkZXRlY3Rpb24gcGFyYW1ldGVycyB0ZW5kcwo+ICAgCSAgIHRvIGdlbmVyYXRl
IGEgc3B1cmlvdXMgaG90cGx1ZyBldmVudCBhYm91dCB0aHJlZQo+ICAgCSAgIHNlY29uZHMgbGF0
ZXIuICBTbyBqdXN0IGRvIGl0IG9uY2UuCj4gICAJKi8KPiAtCWlmIChJU19HNFgoZGV2X3ByaXYp
KQo+ICsJaWYgKElTX0c0WChpOTE1KSkKPiAgIAkJaG90cGx1Z19lbiB8PSBDUlRfSE9UUExVR19B
Q1RJVkFUSU9OX1BFUklPRF82NDsKPiAgIAlob3RwbHVnX2VuIHw9IENSVF9IT1RQTFVHX1ZPTFRB
R0VfQ09NUEFSRV81MDsKPiAgIAo+ICAgCS8qIElnbm9yZSBUViBzaW5jZSBpdCdzIGJ1Z2d5ICov
Cj4gLQlpOTE1X2hvdHBsdWdfaW50ZXJydXB0X3VwZGF0ZV9sb2NrZWQoZGV2X3ByaXYsCj4gKwlp
OTE1X2hvdHBsdWdfaW50ZXJydXB0X3VwZGF0ZV9sb2NrZWQoaTkxNSwKPiAgIAkJCQkJICAgICBI
T1RQTFVHX0lOVF9FTl9NQVNLIHwKPiAgIAkJCQkJICAgICBDUlRfSE9UUExVR19WT0xUQUdFX0NP
TVBBUkVfTUFTSyB8Cj4gICAJCQkJCSAgICAgQ1JUX0hPVFBMVUdfQUNUSVZBVElPTl9QRVJJT0Rf
NjQsCj4gQEAgLTQ2ODgsMTQgKzQ2ODgsMTQgQEAgc3RhdGljIHZvaWQgaTkxNV9ocGRfaXJxX3Nl
dHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIHN0YXRpYyBpcnFyZXR1
cm5fdCBpOTY1X2lycV9oYW5kbGVyKGludCBpcnEsIHZvaWQgKmFyZykKPiAgIHsKPiAgIAlzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2ID0gYXJnOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGRldik7Cj4gICAJaXJxcmV0dXJuX3QgcmV0ID0gSVJRX05PTkU7Cj4gICAKPiAt
CWlmICghaW50ZWxfaXJxc19lbmFibGVkKGRldl9wcml2KSkKPiArCWlmICghaW50ZWxfaXJxc19l
bmFibGVkKGk5MTUpKQo+ICAgCQlyZXR1cm4gSVJRX05PTkU7Cj4gICAKPiAgIAkvKiBJUlFzIGFy
ZSBzeW5jZWQgZHVyaW5nIHJ1bnRpbWVfc3VzcGVuZCwgd2UgZG9uJ3QgcmVxdWlyZSBhIHdha2Vy
ZWYgKi8KPiAtCWRpc2FibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7Cj4gKwlkaXNh
YmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoaTkxNSk7Cj4gICAKPiAgIAlkbyB7Cj4gICAJCXUzMiBw
aXBlX3N0YXRzW0k5MTVfTUFYX1BJUEVTXSA9IHt9Owo+IEBAIC00NzEwLDc2ICs0NzEwLDc2IEBA
IHN0YXRpYyBpcnFyZXR1cm5fdCBpOTY1X2lycV9oYW5kbGVyKGludCBpcnEsIHZvaWQgKmFyZykK
PiAgIAkJcmV0ID0gSVJRX0hBTkRMRUQ7Cj4gICAKPiAgIAkJaWYgKGlpciAmIEk5MTVfRElTUExB
WV9QT1JUX0lOVEVSUlVQVCkKPiAtCQkJaG90cGx1Z19zdGF0dXMgPSBpOXh4X2hwZF9pcnFfYWNr
KGRldl9wcml2KTsKPiArCQkJaG90cGx1Z19zdGF0dXMgPSBpOXh4X2hwZF9pcnFfYWNrKGk5MTUp
Owo+ICAgCj4gICAJCS8qIENhbGwgcmVnYXJkbGVzcywgYXMgc29tZSBzdGF0dXMgYml0cyBtaWdo
dCBub3QgYmUKPiAgIAkJICogc2lnbmFsbGVkIGluIGlpciAqLwo+IC0JCWk5eHhfcGlwZXN0YXRf
aXJxX2FjayhkZXZfcHJpdiwgaWlyLCBwaXBlX3N0YXRzKTsKPiArCQlpOXh4X3BpcGVzdGF0X2ly
cV9hY2soaTkxNSwgaWlyLCBwaXBlX3N0YXRzKTsKPiAgIAo+ICAgCQlpZiAoaWlyICYgSTkxNV9N
QVNURVJfRVJST1JfSU5URVJSVVBUKQo+IC0JCQlpOXh4X2Vycm9yX2lycV9hY2soZGV2X3ByaXYs
ICZlaXIsICZlaXJfc3R1Y2spOwo+ICsJCQlpOXh4X2Vycm9yX2lycV9hY2soaTkxNSwgJmVpciwg
JmVpcl9zdHVjayk7Cj4gICAKPiAgIAkJSTkxNV9XUklURShHRU4yX0lJUiwgaWlyKTsKPiAgIAo+
ICAgCQlpZiAoaWlyICYgSTkxNV9VU0VSX0lOVEVSUlVQVCkKPiAtCQkJaW50ZWxfZW5naW5lX2Jy
ZWFkY3J1bWJzX2lycShkZXZfcHJpdi0+ZW5naW5lW1JDUzBdKTsKPiArCQkJaW50ZWxfZW5naW5l
X2JyZWFkY3J1bWJzX2lycShpOTE1LT5lbmdpbmVbUkNTMF0pOwo+ICAgCj4gICAJCWlmIChpaXIg
JiBJOTE1X0JTRF9VU0VSX0lOVEVSUlVQVCkKPiAtCQkJaW50ZWxfZW5naW5lX2JyZWFkY3J1bWJz
X2lycShkZXZfcHJpdi0+ZW5naW5lW1ZDUzBdKTsKPiArCQkJaW50ZWxfZW5naW5lX2JyZWFkY3J1
bWJzX2lycShpOTE1LT5lbmdpbmVbVkNTMF0pOwo+ICAgCj4gICAJCWlmIChpaXIgJiBJOTE1X01B
U1RFUl9FUlJPUl9JTlRFUlJVUFQpCj4gLQkJCWk5eHhfZXJyb3JfaXJxX2hhbmRsZXIoZGV2X3By
aXYsIGVpciwgZWlyX3N0dWNrKTsKPiArCQkJaTl4eF9lcnJvcl9pcnFfaGFuZGxlcihpOTE1LCBl
aXIsIGVpcl9zdHVjayk7Cj4gICAKPiAgIAkJaWYgKGhvdHBsdWdfc3RhdHVzKQo+IC0JCQlpOXh4
X2hwZF9pcnFfaGFuZGxlcihkZXZfcHJpdiwgaG90cGx1Z19zdGF0dXMpOwo+ICsJCQlpOXh4X2hw
ZF9pcnFfaGFuZGxlcihpOTE1LCBob3RwbHVnX3N0YXR1cyk7Cj4gICAKPiAtCQlpOTY1X3BpcGVz
dGF0X2lycV9oYW5kbGVyKGRldl9wcml2LCBpaXIsIHBpcGVfc3RhdHMpOwo+ICsJCWk5NjVfcGlw
ZXN0YXRfaXJxX2hhbmRsZXIoaTkxNSwgaWlyLCBwaXBlX3N0YXRzKTsKPiAgIAl9IHdoaWxlICgw
KTsKPiAgIAo+IC0JZW5hYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoZGV2X3ByaXYpOwo+ICsJZW5h
YmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoaTkxNSk7Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAg
fQo+ICAgCj4gICAvKioKPiAgICAqIGludGVsX2lycV9pbml0IC0gaW5pdGlhbGl6ZXMgaXJxIHN1
cHBvcnQKPiAtICogQGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ICsgKiBAaTkxNTog
aTkxNSBkZXZpY2UgaW5zdGFuY2UKPiAgICAqCj4gICAgKiBUaGlzIGZ1bmN0aW9uIGluaXRpYWxp
emVzIGFsbCB0aGUgaXJxIHN1cHBvcnQgaW5jbHVkaW5nIHdvcmsgaXRlbXMsIHRpbWVycwo+ICAg
ICogYW5kIGFsbCB0aGUgdnRhYmxlcy4gSXQgZG9lcyBub3Qgc2V0dXAgdGhlIGludGVycnVwdCBp
dHNlbGYgdGhvdWdoLgo+ICAgICovCj4gLXZvaWQgaW50ZWxfaXJxX2luaXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGludGVsX2lycV9pbml0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZk
ZXZfcHJpdi0+ZHJtOwo+IC0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9w
bS5ycHM7Cj4gKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmk5MTUtPmRybTsKPiArCXN0cnVj
dCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1LT5ndF9wbS5ycHM7Cj4gICAJaW50IGk7Cj4gICAKPiAt
CWlmIChJU19JOTQ1R00oZGV2X3ByaXYpKQo+IC0JCWk5NDVnbV92Ymxhbmtfd29ya19pbml0KGRl
dl9wcml2KTsKPiArCWlmIChJU19JOTQ1R00oaTkxNSkpCj4gKwkJaTk0NWdtX3ZibGFua193b3Jr
X2luaXQoaTkxNSk7Cj4gICAKPiAtCWludGVsX2hwZF9pbml0X3dvcmsoZGV2X3ByaXYpOwo+ICsJ
aW50ZWxfaHBkX2luaXRfd29yayhpOTE1KTsKPiAgIAo+ICAgCUlOSVRfV09SSygmcnBzLT53b3Jr
LCBnZW42X3BtX3Jwc193b3JrKTsKPiAgIAo+IC0JSU5JVF9XT1JLKCZkZXZfcHJpdi0+bDNfcGFy
aXR5LmVycm9yX3dvcmssIGl2eWJyaWRnZV9wYXJpdHlfd29yayk7Cj4gKwlJTklUX1dPUksoJmk5
MTUtPmwzX3Bhcml0eS5lcnJvcl93b3JrLCBpdnlicmlkZ2VfcGFyaXR5X3dvcmspOwo+ICAgCWZv
ciAoaSA9IDA7IGkgPCBNQVhfTDNfU0xJQ0VTOyArK2kpCj4gLQkJZGV2X3ByaXYtPmwzX3Bhcml0
eS5yZW1hcF9pbmZvW2ldID0gTlVMTDsKPiArCQlpOTE1LT5sM19wYXJpdHkucmVtYXBfaW5mb1tp
XSA9IE5VTEw7Cj4gICAKPiAtCWlmIChIQVNfR1VDX1NDSEVEKGRldl9wcml2KSAmJiBJTlRFTF9H
RU4oZGV2X3ByaXYpIDwgMTEpCj4gLQkJZGV2X3ByaXYtPnBtX2d1Y19ldmVudHMgPSBHRU45X0dV
Q19UT19IT1NUX0lOVF9FVkVOVDsKPiArCWlmIChIQVNfR1VDX1NDSEVEKGk5MTUpICYmIElOVEVM
X0dFTihpOTE1KSA8IDExKQo+ICsJCWk5MTUtPnBtX2d1Y19ldmVudHMgPSBHRU45X0dVQ19UT19I
T1NUX0lOVF9FVkVOVDsKPiAgIAo+ICAgCS8qIExldCdzIHRyYWNrIHRoZSBlbmFibGVkIHJwcyBl
dmVudHMgKi8KPiAtCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkKPiArCWlmIChJU19WQUxM
RVlWSUVXKGk5MTUpKQo+ICAgCQkvKiBXYUdzdlJDMFJlc2lkZW5jeU1ldGhvZDp2bHYgKi8KPiAt
CQlkZXZfcHJpdi0+cG1fcnBzX2V2ZW50cyA9IEdFTjZfUE1fUlBfVVBfRUlfRVhQSVJFRDsKPiAr
CQlpOTE1LT5wbV9ycHNfZXZlbnRzID0gR0VONl9QTV9SUF9VUF9FSV9FWFBJUkVEOwo+ICAgCWVs
c2UKPiAtCQlkZXZfcHJpdi0+cG1fcnBzX2V2ZW50cyA9IChHRU42X1BNX1JQX1VQX1RIUkVTSE9M
RCB8Cj4gKwkJaTkxNS0+cG1fcnBzX2V2ZW50cyA9IChHRU42X1BNX1JQX1VQX1RIUkVTSE9MRCB8
Cj4gICAJCQkJCSAgIEdFTjZfUE1fUlBfRE9XTl9USFJFU0hPTEQgfAo+ICAgCQkJCQkgICBHRU42
X1BNX1JQX0RPV05fVElNRU9VVCk7Cj4gICAKPiAgIAkvKiBXZSBzaGFyZSB0aGUgcmVnaXN0ZXIg
d2l0aCBvdGhlciBlbmdpbmUgKi8KPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID4gOSkKPiAt
CQlHRU1fV0FSTl9PTihkZXZfcHJpdi0+cG1fcnBzX2V2ZW50cyAmIDB4ZmZmZjAwMDApOwo+ICsJ
aWYgKElOVEVMX0dFTihpOTE1KSA+IDkpCj4gKwkJR0VNX1dBUk5fT04oaTkxNS0+cG1fcnBzX2V2
ZW50cyAmIDB4ZmZmZjAwMDApOwo+ICAgCj4gICAJcnBzLT5wbV9pbnRybXNrX21ieiA9IDA7Cj4g
ICAKPiBAQCAtNDc4OSwxNSArNDc4OSwxNSBAQCB2b2lkIGludGVsX2lycV9pbml0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkgKgo+ICAgCSAqIFRPRE86IHZlcmlmeSBp
ZiB0aGlzIGNhbiBiZSByZXByb2R1Y2VkIG9uIFZMVixDSFYuCj4gICAJICovCj4gLQlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA8PSA3KQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8PSA3KQo+ICAg
CQlycHMtPnBtX2ludHJtc2tfbWJ6IHw9IEdFTjZfUE1fUlBfVVBfRUlfRVhQSVJFRDsKPiAgIAo+
IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOCkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkg
Pj0gOCkKPiAgIAkJcnBzLT5wbV9pbnRybXNrX21ieiB8PSBHRU44X1BNSU5UUl9ESVNBQkxFX1JF
RElSRUNUX1RPX0dVQzsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNSB8fCBJ
U19HNFgoZGV2X3ByaXYpKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA1IHx8IElTX0c0WChp
OTE1KSkKPiAgIAkJZGV2LT5kcml2ZXItPmdldF92YmxhbmtfY291bnRlciA9IGc0eF9nZXRfdmJs
YW5rX2NvdW50ZXI7Cj4gLQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDMpCj4gKwll
bHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMykKPiAgIAkJZGV2LT5kcml2ZXItPmdldF92Ymxh
bmtfY291bnRlciA9IGk5MTVfZ2V0X3ZibGFua19jb3VudGVyOwo+ICAgCj4gICAJZGV2LT52Ymxh
bmtfZGlzYWJsZV9pbW1lZGlhdGUgPSB0cnVlOwo+IEBAIC00ODA4LDgzICs0ODA4LDgzIEBAIHZv
aWQgaW50ZWxfaXJxX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAg
CSAqIG91dHNpZGUgb2YgdGhlIHBvd2VyIGRvbWFpbi4gV2UgZGVmZXIgc2V0dGluZyB1cCB0aGUg
ZGlzcGxheSBpcnFzCj4gICAJICogaW4gdGhpcyBjYXNlIHRvIHRoZSBydW50aW1lIHBtLgo+ICAg
CSAqLwo+IC0JZGV2X3ByaXYtPmRpc3BsYXlfaXJxc19lbmFibGVkID0gdHJ1ZTsKPiAtCWlmIChJ
U19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiAtCQlk
ZXZfcHJpdi0+ZGlzcGxheV9pcnFzX2VuYWJsZWQgPSBmYWxzZTsKPiArCWk5MTUtPmRpc3BsYXlf
aXJxc19lbmFibGVkID0gdHJ1ZTsKPiArCWlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NI
RVJSWVZJRVcoaTkxNSkpCj4gKwkJaTkxNS0+ZGlzcGxheV9pcnFzX2VuYWJsZWQgPSBmYWxzZTsK
PiAgIAo+IC0JZGV2X3ByaXYtPmhvdHBsdWcuaHBkX3N0b3JtX3RocmVzaG9sZCA9IEhQRF9TVE9S
TV9ERUZBVUxUX1RIUkVTSE9MRDsKPiArCWk5MTUtPmhvdHBsdWcuaHBkX3N0b3JtX3RocmVzaG9s
ZCA9IEhQRF9TVE9STV9ERUZBVUxUX1RIUkVTSE9MRDsKPiAgIAkvKiBJZiB3ZSBoYXZlIE1TVCBz
dXBwb3J0LCB3ZSB3YW50IHRvIGF2b2lkIGRvaW5nIHNob3J0IEhQRCBJUlEgc3Rvcm0KPiAgIAkg
KiBkZXRlY3Rpb24sIGFzIHNob3J0IEhQRCBzdG9ybXMgd2lsbCBvY2N1ciBhcyBhIG5hdHVyYWwg
cGFydCBvZgo+ICAgCSAqIHNpZGViYW5kIG1lc3NhZ2luZyB3aXRoIE1TVC4KPiAgIAkgKiBPbiBv
bGRlciBwbGF0Zm9ybXMgaG93ZXZlciwgSVJRIHN0b3JtcyBjYW4gb2NjdXIgd2l0aCBib3RoIGxv
bmcgYW5kCj4gICAJICogc2hvcnQgcHVsc2VzLCBhcyBzZWVuIG9uIHNvbWUgRzR4IHN5c3RlbXMu
Cj4gICAJICovCj4gLQlkZXZfcHJpdi0+aG90cGx1Zy5ocGRfc2hvcnRfc3Rvcm1fZW5hYmxlZCA9
ICFIQVNfRFBfTVNUKGRldl9wcml2KTsKPiArCWk5MTUtPmhvdHBsdWcuaHBkX3Nob3J0X3N0b3Jt
X2VuYWJsZWQgPSAhSEFTX0RQX01TVChpOTE1KTsKPiAgIAo+ICAgCWRldi0+ZHJpdmVyLT5nZXRf
dmJsYW5rX3RpbWVzdGFtcCA9IGRybV9jYWxjX3ZibHRpbWVzdGFtcF9mcm9tX3NjYW5vdXRwb3M7
Cj4gICAJZGV2LT5kcml2ZXItPmdldF9zY2Fub3V0X3Bvc2l0aW9uID0gaTkxNV9nZXRfY3J0Y19z
Y2Fub3V0cG9zOwo+ICAgCj4gLQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiArCWlm
IChJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gICAJCWRldi0+ZHJpdmVyLT5pcnFfaGFuZGxlciA9
IGNoZXJyeXZpZXdfaXJxX2hhbmRsZXI7Cj4gICAJCWRldi0+ZHJpdmVyLT5pcnFfcHJlaW5zdGFs
bCA9IGNoZXJyeXZpZXdfaXJxX3Jlc2V0Owo+ICAgCQlkZXYtPmRyaXZlci0+aXJxX3Bvc3RpbnN0
YWxsID0gY2hlcnJ5dmlld19pcnFfcG9zdGluc3RhbGw7Cj4gICAJCWRldi0+ZHJpdmVyLT5pcnFf
dW5pbnN0YWxsID0gY2hlcnJ5dmlld19pcnFfcmVzZXQ7Cj4gICAJCWRldi0+ZHJpdmVyLT5lbmFi
bGVfdmJsYW5rID0gaTk2NV9lbmFibGVfdmJsYW5rOwo+ICAgCQlkZXYtPmRyaXZlci0+ZGlzYWJs
ZV92YmxhbmsgPSBpOTY1X2Rpc2FibGVfdmJsYW5rOwo+IC0JCWRldl9wcml2LT5kaXNwbGF5Lmhw
ZF9pcnFfc2V0dXAgPSBpOTE1X2hwZF9pcnFfc2V0dXA7Cj4gLQl9IGVsc2UgaWYgKElTX1ZBTExF
WVZJRVcoZGV2X3ByaXYpKSB7Cj4gKwkJaTkxNS0+ZGlzcGxheS5ocGRfaXJxX3NldHVwID0gaTkx
NV9ocGRfaXJxX3NldHVwOwo+ICsJfSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpKSB7Cj4g
ICAJCWRldi0+ZHJpdmVyLT5pcnFfaGFuZGxlciA9IHZhbGxleXZpZXdfaXJxX2hhbmRsZXI7Cj4g
ICAJCWRldi0+ZHJpdmVyLT5pcnFfcHJlaW5zdGFsbCA9IHZhbGxleXZpZXdfaXJxX3Jlc2V0Owo+
ICAgCQlkZXYtPmRyaXZlci0+aXJxX3Bvc3RpbnN0YWxsID0gdmFsbGV5dmlld19pcnFfcG9zdGlu
c3RhbGw7Cj4gICAJCWRldi0+ZHJpdmVyLT5pcnFfdW5pbnN0YWxsID0gdmFsbGV5dmlld19pcnFf
cmVzZXQ7Cj4gICAJCWRldi0+ZHJpdmVyLT5lbmFibGVfdmJsYW5rID0gaTk2NV9lbmFibGVfdmJs
YW5rOwo+ICAgCQlkZXYtPmRyaXZlci0+ZGlzYWJsZV92YmxhbmsgPSBpOTY1X2Rpc2FibGVfdmJs
YW5rOwo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmhwZF9pcnFfc2V0dXAgPSBpOTE1X2hwZF9pcnFf
c2V0dXA7Cj4gLQl9IGVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpIHsKPiArCQlp
OTE1LT5kaXNwbGF5LmhwZF9pcnFfc2V0dXAgPSBpOTE1X2hwZF9pcnFfc2V0dXA7Cj4gKwl9IGVs
c2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkgewo+ICAgCQlkZXYtPmRyaXZlci0+aXJxX2hh
bmRsZXIgPSBnZW4xMV9pcnFfaGFuZGxlcjsKPiAgIAkJZGV2LT5kcml2ZXItPmlycV9wcmVpbnN0
YWxsID0gZ2VuMTFfaXJxX3Jlc2V0Owo+ICAgCQlkZXYtPmRyaXZlci0+aXJxX3Bvc3RpbnN0YWxs
ID0gZ2VuMTFfaXJxX3Bvc3RpbnN0YWxsOwo+ICAgCQlkZXYtPmRyaXZlci0+aXJxX3VuaW5zdGFs
bCA9IGdlbjExX2lycV9yZXNldDsKPiAgIAkJZGV2LT5kcml2ZXItPmVuYWJsZV92YmxhbmsgPSBn
ZW44X2VuYWJsZV92Ymxhbms7Cj4gICAJCWRldi0+ZHJpdmVyLT5kaXNhYmxlX3ZibGFuayA9IGdl
bjhfZGlzYWJsZV92Ymxhbms7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCA9
IGdlbjExX2hwZF9pcnFfc2V0dXA7Cj4gLQl9IGVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gOCkgewo+ICsJCWk5MTUtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCA9IGdlbjExX2hwZF9pcnFf
c2V0dXA7Cj4gKwl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA4KSB7Cj4gICAJCWRldi0+
ZHJpdmVyLT5pcnFfaGFuZGxlciA9IGdlbjhfaXJxX2hhbmRsZXI7Cj4gICAJCWRldi0+ZHJpdmVy
LT5pcnFfcHJlaW5zdGFsbCA9IGdlbjhfaXJxX3Jlc2V0Owo+ICAgCQlkZXYtPmRyaXZlci0+aXJx
X3Bvc3RpbnN0YWxsID0gZ2VuOF9pcnFfcG9zdGluc3RhbGw7Cj4gICAJCWRldi0+ZHJpdmVyLT5p
cnFfdW5pbnN0YWxsID0gZ2VuOF9pcnFfcmVzZXQ7Cj4gICAJCWRldi0+ZHJpdmVyLT5lbmFibGVf
dmJsYW5rID0gZ2VuOF9lbmFibGVfdmJsYW5rOwo+ICAgCQlkZXYtPmRyaXZlci0+ZGlzYWJsZV92
YmxhbmsgPSBnZW44X2Rpc2FibGVfdmJsYW5rOwo+IC0JCWlmIChJU19HRU45X0xQKGRldl9wcml2
KSkKPiAtCQkJZGV2X3ByaXYtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCA9IGJ4dF9ocGRfaXJxX3Nl
dHVwOwo+IC0JCWVsc2UgaWYgKElOVEVMX1BDSF9UWVBFKGRldl9wcml2KSA+PSBQQ0hfU1BUKQo+
IC0JCQlkZXZfcHJpdi0+ZGlzcGxheS5ocGRfaXJxX3NldHVwID0gc3B0X2hwZF9pcnFfc2V0dXA7
Cj4gKwkJaWYgKElTX0dFTjlfTFAoaTkxNSkpCj4gKwkJCWk5MTUtPmRpc3BsYXkuaHBkX2lycV9z
ZXR1cCA9IGJ4dF9ocGRfaXJxX3NldHVwOwo+ICsJCWVsc2UgaWYgKElOVEVMX1BDSF9UWVBFKGk5
MTUpID49IFBDSF9TUFQpCj4gKwkJCWk5MTUtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCA9IHNwdF9o
cGRfaXJxX3NldHVwOwo+ICAgCQllbHNlCj4gLQkJCWRldl9wcml2LT5kaXNwbGF5LmhwZF9pcnFf
c2V0dXAgPSBpbGtfaHBkX2lycV9zZXR1cDsKPiAtCX0gZWxzZSBpZiAoSEFTX1BDSF9TUExJVChk
ZXZfcHJpdikpIHsKPiArCQkJaTkxNS0+ZGlzcGxheS5ocGRfaXJxX3NldHVwID0gaWxrX2hwZF9p
cnFfc2V0dXA7Cj4gKwl9IGVsc2UgaWYgKEhBU19QQ0hfU1BMSVQoaTkxNSkpIHsKPiAgIAkJZGV2
LT5kcml2ZXItPmlycV9oYW5kbGVyID0gaXJvbmxha2VfaXJxX2hhbmRsZXI7Cj4gICAJCWRldi0+
ZHJpdmVyLT5pcnFfcHJlaW5zdGFsbCA9IGlyb25sYWtlX2lycV9yZXNldDsKPiAgIAkJZGV2LT5k
cml2ZXItPmlycV9wb3N0aW5zdGFsbCA9IGlyb25sYWtlX2lycV9wb3N0aW5zdGFsbDsKPiAgIAkJ
ZGV2LT5kcml2ZXItPmlycV91bmluc3RhbGwgPSBpcm9ubGFrZV9pcnFfcmVzZXQ7Cj4gICAJCWRl
di0+ZHJpdmVyLT5lbmFibGVfdmJsYW5rID0gaXJvbmxha2VfZW5hYmxlX3ZibGFuazsKPiAgIAkJ
ZGV2LT5kcml2ZXItPmRpc2FibGVfdmJsYW5rID0gaXJvbmxha2VfZGlzYWJsZV92Ymxhbms7Cj4g
LQkJZGV2X3ByaXYtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCA9IGlsa19ocGRfaXJxX3NldHVwOwo+
ICsJCWk5MTUtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCA9IGlsa19ocGRfaXJxX3NldHVwOwo+ICAg
CX0gZWxzZSB7Cj4gLQkJaWYgKElTX0dFTihkZXZfcHJpdiwgMikpIHsKPiArCQlpZiAoSVNfR0VO
KGk5MTUsIDIpKSB7Cj4gICAJCQlkZXYtPmRyaXZlci0+aXJxX3ByZWluc3RhbGwgPSBpOHh4X2ly
cV9yZXNldDsKPiAgIAkJCWRldi0+ZHJpdmVyLT5pcnFfcG9zdGluc3RhbGwgPSBpOHh4X2lycV9w
b3N0aW5zdGFsbDsKPiAgIAkJCWRldi0+ZHJpdmVyLT5pcnFfaGFuZGxlciA9IGk4eHhfaXJxX2hh
bmRsZXI7Cj4gICAJCQlkZXYtPmRyaXZlci0+aXJxX3VuaW5zdGFsbCA9IGk4eHhfaXJxX3Jlc2V0
Owo+ICAgCQkJZGV2LT5kcml2ZXItPmVuYWJsZV92YmxhbmsgPSBpOHh4X2VuYWJsZV92Ymxhbms7
Cj4gICAJCQlkZXYtPmRyaXZlci0+ZGlzYWJsZV92YmxhbmsgPSBpOHh4X2Rpc2FibGVfdmJsYW5r
Owo+IC0JCX0gZWxzZSBpZiAoSVNfSTk0NUdNKGRldl9wcml2KSkgewo+ICsJCX0gZWxzZSBpZiAo
SVNfSTk0NUdNKGk5MTUpKSB7Cj4gICAJCQlkZXYtPmRyaXZlci0+aXJxX3ByZWluc3RhbGwgPSBp
OTE1X2lycV9yZXNldDsKPiAgIAkJCWRldi0+ZHJpdmVyLT5pcnFfcG9zdGluc3RhbGwgPSBpOTE1
X2lycV9wb3N0aW5zdGFsbDsKPiAgIAkJCWRldi0+ZHJpdmVyLT5pcnFfdW5pbnN0YWxsID0gaTkx
NV9pcnFfcmVzZXQ7Cj4gICAJCQlkZXYtPmRyaXZlci0+aXJxX2hhbmRsZXIgPSBpOTE1X2lycV9o
YW5kbGVyOwo+ICAgCQkJZGV2LT5kcml2ZXItPmVuYWJsZV92YmxhbmsgPSBpOTQ1Z21fZW5hYmxl
X3ZibGFuazsKPiAgIAkJCWRldi0+ZHJpdmVyLT5kaXNhYmxlX3ZibGFuayA9IGk5NDVnbV9kaXNh
YmxlX3ZibGFuazsKPiAtCQl9IGVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgMykpIHsKPiArCQl9
IGVsc2UgaWYgKElTX0dFTihpOTE1LCAzKSkgewo+ICAgCQkJZGV2LT5kcml2ZXItPmlycV9wcmVp
bnN0YWxsID0gaTkxNV9pcnFfcmVzZXQ7Cj4gICAJCQlkZXYtPmRyaXZlci0+aXJxX3Bvc3RpbnN0
YWxsID0gaTkxNV9pcnFfcG9zdGluc3RhbGw7Cj4gICAJCQlkZXYtPmRyaXZlci0+aXJxX3VuaW5z
dGFsbCA9IGk5MTVfaXJxX3Jlc2V0Owo+IEBAIC00ODk5LDggKzQ4OTksOCBAQCB2b2lkIGludGVs
X2lycV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkJCWRldi0+
ZHJpdmVyLT5lbmFibGVfdmJsYW5rID0gaTk2NV9lbmFibGVfdmJsYW5rOwo+ICAgCQkJZGV2LT5k
cml2ZXItPmRpc2FibGVfdmJsYW5rID0gaTk2NV9kaXNhYmxlX3ZibGFuazsKPiAgIAkJfQo+IC0J
CWlmIChJOTE1X0hBU19IT1RQTFVHKGRldl9wcml2KSkKPiAtCQkJZGV2X3ByaXYtPmRpc3BsYXku
aHBkX2lycV9zZXR1cCA9IGk5MTVfaHBkX2lycV9zZXR1cDsKPiArCQlpZiAoSTkxNV9IQVNfSE9U
UExVRyhpOTE1KSkKPiArCQkJaTkxNS0+ZGlzcGxheS5ocGRfaXJxX3NldHVwID0gaTkxNV9ocGRf
aXJxX3NldHVwOwo+ICAgCX0KPiAgIH0KPiAgIAo+IEBAIC00OTIzLDcgKzQ5MjMsNyBAQCB2b2lk
IGludGVsX2lycV9maW5pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgCj4gICAv
KioKPiAgICAqIGludGVsX2lycV9pbnN0YWxsIC0gZW5hYmxlcyB0aGUgaGFyZHdhcmUgaW50ZXJy
dXB0Cj4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiArICogQGk5MTU6IGk5
MTUgZGV2aWNlIGluc3RhbmNlCj4gICAgKgo+ICAgICogVGhpcyBmdW5jdGlvbiBlbmFibGVzIHRo
ZSBoYXJkd2FyZSBpbnRlcnJ1cHQgaGFuZGxpbmcsIGJ1dCBsZWF2ZXMgdGhlIGhvdHBsdWcKPiAg
ICAqIGhhbmRsaW5nIHN0aWxsIGRpc2FibGVkLiBJdCBpcyBjYWxsZWQgYWZ0ZXIgaW50ZWxfaXJx
X2luaXQoKS4KPiBAQCAtNDkzMiw1NiArNDkzMiw1NiBAQCB2b2lkIGludGVsX2lycV9maW5pKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgICogYnV0IGRvbid0IHdhbnQgdG8gZGVh
bCB3aXRoIHRoZSBoYXNzbGUgb2YgY29uY3VycmVudCBwcm9iZSBhbmQgaG90cGx1Zwo+ICAgICog
d29ya2Vycy4gSGVuY2UgdGhlIHNwbGl0IGludG8gdGhpcyB0d28tc3RhZ2UgYXBwcm9hY2guCj4g
ICAgKi8KPiAtaW50IGludGVsX2lycV9pbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiAraW50IGludGVsX2lycV9pbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQo+ICAgewo+ICAgCS8qCj4gICAJICogV2UgZW5hYmxlIHNvbWUgaW50ZXJydXB0IHNv
dXJjZXMgaW4gb3VyIHBvc3RpbnN0YWxsIGhvb2tzLCBzbyBtYXJrCj4gICAJICogaW50ZXJydXB0
cyBhcyBlbmFibGVkIF9iZWZvcmVfIGFjdHVhbGx5IGVuYWJsaW5nIHRoZW0gdG8gYXZvaWQKPiAg
IAkgKiBzcGVjaWFsIGNhc2VzIGluIG91ciBvcmRlcmluZyBjaGVja3MuCj4gICAJICovCj4gLQlk
ZXZfcHJpdi0+cnVudGltZV9wbS5pcnFzX2VuYWJsZWQgPSB0cnVlOwo+ICsJaTkxNS0+cnVudGlt
ZV9wbS5pcnFzX2VuYWJsZWQgPSB0cnVlOwo+ICAgCj4gLQlyZXR1cm4gZHJtX2lycV9pbnN0YWxs
KCZkZXZfcHJpdi0+ZHJtLCBkZXZfcHJpdi0+ZHJtLnBkZXYtPmlycSk7Cj4gKwlyZXR1cm4gZHJt
X2lycV9pbnN0YWxsKCZpOTE1LT5kcm0sIGk5MTUtPmRybS5wZGV2LT5pcnEpOwo+ICAgfQo+ICAg
Cj4gICAvKioKPiAgICAqIGludGVsX2lycV91bmluc3RhbGwgLSBmaW5pbGl6ZXMgYWxsIGlycSBo
YW5kbGluZwo+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gKyAqIEBpOTE1
OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ICAgICoKPiAgICAqIFRoaXMgc3RvcHMgaW50ZXJydXB0
IGFuZCBob3RwbHVnIGhhbmRsaW5nIGFuZCB1bnJlZ2lzdGVycyBhbmQgZnJlZXMgYWxsCj4gICAg
KiByZXNvdXJjZXMgYWNxdWlyZWQgaW4gdGhlIGluaXQgZnVuY3Rpb25zLgo+ICAgICovCj4gLXZv
aWQgaW50ZWxfaXJxX3VuaW5zdGFsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gK3ZvaWQgaW50ZWxfaXJxX3VuaW5zdGFsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiAgIHsKPiAtCWRybV9pcnFfdW5pbnN0YWxsKCZkZXZfcHJpdi0+ZHJtKTsKPiAtCWludGVs
X2hwZF9jYW5jZWxfd29yayhkZXZfcHJpdik7Cj4gLQlkZXZfcHJpdi0+cnVudGltZV9wbS5pcnFz
X2VuYWJsZWQgPSBmYWxzZTsKPiArCWRybV9pcnFfdW5pbnN0YWxsKCZpOTE1LT5kcm0pOwo+ICsJ
aW50ZWxfaHBkX2NhbmNlbF93b3JrKGk5MTUpOwo+ICsJaTkxNS0+cnVudGltZV9wbS5pcnFzX2Vu
YWJsZWQgPSBmYWxzZTsKPiAgIH0KPiAgIAo+ICAgLyoqCj4gICAgKiBpbnRlbF9ydW50aW1lX3Bt
X2Rpc2FibGVfaW50ZXJydXB0cyAtIHJ1bnRpbWUgaW50ZXJydXB0IGRpc2FibGluZwo+IC0gKiBA
ZGV2X3ByaXY6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gKyAqIEBpOTE1OiBpOTE1IGRldmljZSBp
bnN0YW5jZQo+ICAgICoKPiAgICAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBkaXNhYmxlIGlu
dGVycnVwdHMgYXQgcnVudGltZSwgYm90aCBpbiB0aGUgcnVudGltZQo+ICAgICogcG0gYW5kIHRo
ZSBzeXN0ZW0gc3VzcGVuZC9yZXN1bWUgY29kZS4KPiAgICAqLwo+IC12b2lkIGludGVsX3J1bnRp
bWVfcG1fZGlzYWJsZV9pbnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiArdm9pZCBpbnRlbF9ydW50aW1lX3BtX2Rpc2FibGVfaW50ZXJydXB0cyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCWRldl9wcml2LT5kcm0uZHJpdmVyLT5pcnFf
dW5pbnN0YWxsKCZkZXZfcHJpdi0+ZHJtKTsKPiAtCWRldl9wcml2LT5ydW50aW1lX3BtLmlycXNf
ZW5hYmxlZCA9IGZhbHNlOwo+IC0Jc3luY2hyb25pemVfaXJxKGRldl9wcml2LT5kcm0uaXJxKTsK
PiArCWk5MTUtPmRybS5kcml2ZXItPmlycV91bmluc3RhbGwoJmk5MTUtPmRybSk7Cj4gKwlpOTE1
LT5ydW50aW1lX3BtLmlycXNfZW5hYmxlZCA9IGZhbHNlOwo+ICsJc3luY2hyb25pemVfaXJxKGk5
MTUtPmRybS5pcnEpOwo+ICAgfQo+ICAgCj4gICAvKioKPiAgICAqIGludGVsX3J1bnRpbWVfcG1f
ZW5hYmxlX2ludGVycnVwdHMgLSBydW50aW1lIGludGVycnVwdCBlbmFibGluZwo+IC0gKiBAZGV2
X3ByaXY6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gKyAqIEBpOTE1OiBpOTE1IGRldmljZSBpbnN0
YW5jZQo+ICAgICoKPiAgICAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBlbmFibGUgaW50ZXJy
dXB0cyBhdCBydW50aW1lLCBib3RoIGluIHRoZSBydW50aW1lCj4gICAgKiBwbSBhbmQgdGhlIHN5
c3RlbSBzdXNwZW5kL3Jlc3VtZSBjb2RlLgo+ICAgICovCj4gLXZvaWQgaW50ZWxfcnVudGltZV9w
bV9lbmFibGVfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
K3ZvaWQgaW50ZWxfcnVudGltZV9wbV9lbmFibGVfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCWRldl9wcml2LT5ydW50aW1lX3BtLmlycXNfZW5hYmxl
ZCA9IHRydWU7Cj4gLQlkZXZfcHJpdi0+ZHJtLmRyaXZlci0+aXJxX3ByZWluc3RhbGwoJmRldl9w
cml2LT5kcm0pOwo+IC0JZGV2X3ByaXYtPmRybS5kcml2ZXItPmlycV9wb3N0aW5zdGFsbCgmZGV2
X3ByaXYtPmRybSk7Cj4gKwlpOTE1LT5ydW50aW1lX3BtLmlycXNfZW5hYmxlZCA9IHRydWU7Cj4g
KwlpOTE1LT5kcm0uZHJpdmVyLT5pcnFfcHJlaW5zdGFsbCgmaTkxNS0+ZHJtKTsKPiArCWk5MTUt
PmRybS5kcml2ZXItPmlycV9wb3N0aW5zdGFsbCgmaTkxNS0+ZHJtKTsKPiAgIH0KPiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9pcnEuaCBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfaXJxLmgKPiBpbmRleCBjYjI1ZGQyMTMzMDguLjYwNDUwNDk5MzUxMyAxMDA2NDQK
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2lycS5oCj4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9pcnEuaAo+IEBAIC0xMyw3NyArMTMsNzcgQEAKPiAgIHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlOwo+ICAgc3RydWN0IGludGVsX2NydGM7Cj4gICAKPiAtZXh0ZXJuIHZv
aWQgaW50ZWxfaXJxX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAt
ZXh0ZXJuIHZvaWQgaW50ZWxfaXJxX2Zpbmkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KTsKPiAtaW50IGludGVsX2lycV9pbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdik7Cj4gLXZvaWQgaW50ZWxfaXJxX3VuaW5zdGFsbChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpOwo+ICtleHRlcm4gdm9pZCBpbnRlbF9pcnFfaW5pdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK2V4dGVybiB2b2lkIGludGVsX2lycV9maW5pKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAraW50IGludGVsX2lycV9pbnN0YWxsKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiArdm9pZCBpbnRlbF9pcnFfdW5pbnN0YWxsKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAgIAo+IC11MzIgaTkxNV9waXBlc3RhdF9l
bmFibGVfbWFzayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3UzMiBpOTE1
X3BpcGVzdGF0X2VuYWJsZV9tYXNrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAg
CQkJICAgICAgZW51bSBwaXBlIHBpcGUpOwo+ICAgdm9pZAo+IC1pOTE1X2VuYWJsZV9waXBlc3Rh
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlwZSBwaXBlLAo+ICtp
OTE1X2VuYWJsZV9waXBlc3RhdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBw
aXBlIHBpcGUsCj4gICAJCSAgICAgdTMyIHN0YXR1c19tYXNrKTsKPiAgIAo+ICAgdm9pZAo+IC1p
OTE1X2Rpc2FibGVfcGlwZXN0YXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBl
bnVtIHBpcGUgcGlwZSwKPiAraTkxNV9kaXNhYmxlX3BpcGVzdGF0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LCBlbnVtIHBpcGUgcGlwZSwKPiAgIAkJICAgICAgdTMyIHN0YXR1c19tYXNr
KTsKPiAgIAo+IC12b2lkIHZhbGxleXZpZXdfZW5hYmxlX2Rpc3BsYXlfaXJxcyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIHZhbGxleXZpZXdfZGlzYWJsZV9kaXNw
bGF5X2lycXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiArdm9pZCB2YWxs
ZXl2aWV3X2VuYWJsZV9kaXNwbGF5X2lycXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Owo+ICt2b2lkIHZhbGxleXZpZXdfZGlzYWJsZV9kaXNwbGF5X2lycXMoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpOwo+ICAgCj4gLXZvaWQgaTkxNV9ob3RwbHVnX2ludGVycnVwdF91cGRh
dGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICt2b2lkIGk5MTVfaG90cGx1
Z19pbnRlcnJ1cHRfdXBkYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJ
CSAgIHUzMiBtYXNrLAo+ICAgCQkJCSAgIHUzMiBiaXRzKTsKPiAtdm9pZCBpbGtfdXBkYXRlX2Rp
c3BsYXlfaXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArdm9pZCBpbGtf
dXBkYXRlX2Rpc3BsYXlfaXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJ
ICAgIHUzMiBpbnRlcnJ1cHRfbWFzaywKPiAgIAkJCSAgICB1MzIgZW5hYmxlZF9pcnFfbWFzayk7
Cj4gICBzdGF0aWMgaW5saW5lIHZvaWQKPiAtaWxrX2VuYWJsZV9kaXNwbGF5X2lycShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBiaXRzKQo+ICtpbGtfZW5hYmxlX2Rpc3Bs
YXlfaXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgYml0cykKPiAgIHsKPiAt
CWlsa191cGRhdGVfZGlzcGxheV9pcnEoZGV2X3ByaXYsIGJpdHMsIGJpdHMpOwo+ICsJaWxrX3Vw
ZGF0ZV9kaXNwbGF5X2lycShpOTE1LCBiaXRzLCBiaXRzKTsKPiAgIH0KPiAgIHN0YXRpYyBpbmxp
bmUgdm9pZAo+IC1pbGtfZGlzYWJsZV9kaXNwbGF5X2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsIHUzMiBiaXRzKQo+ICtpbGtfZGlzYWJsZV9kaXNwbGF5X2lycShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIGJpdHMpCj4gICB7Cj4gLQlpbGtfdXBkYXRlX2Rp
c3BsYXlfaXJxKGRldl9wcml2LCBiaXRzLCAwKTsKPiArCWlsa191cGRhdGVfZGlzcGxheV9pcnEo
aTkxNSwgYml0cywgMCk7Cj4gICB9Cj4gLXZvaWQgYmR3X3VwZGF0ZV9waXBlX2lycShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3ZvaWQgYmR3X3VwZGF0ZV9waXBlX2lycShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSBlbnVtIHBpcGUgcGlwZSwKPiAg
IAkJCSB1MzIgaW50ZXJydXB0X21hc2ssCj4gICAJCQkgdTMyIGVuYWJsZWRfaXJxX21hc2spOwo+
IC1zdGF0aWMgaW5saW5lIHZvaWQgYmR3X2VuYWJsZV9waXBlX2lycShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBpbmxpbmUgdm9pZCBiZHdfZW5hYmxlX3BpcGVf
aXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgICAgICBlbnVtIHBp
cGUgcGlwZSwgdTMyIGJpdHMpCj4gICB7Cj4gLQliZHdfdXBkYXRlX3BpcGVfaXJxKGRldl9wcml2
LCBwaXBlLCBiaXRzLCBiaXRzKTsKPiArCWJkd191cGRhdGVfcGlwZV9pcnEoaTkxNSwgcGlwZSwg
Yml0cywgYml0cyk7Cj4gICB9Cj4gLXN0YXRpYyBpbmxpbmUgdm9pZCBiZHdfZGlzYWJsZV9waXBl
X2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBpbmxpbmUg
dm9pZCBiZHdfZGlzYWJsZV9waXBlX2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
PiAgIAkJCQkJZW51bSBwaXBlIHBpcGUsIHUzMiBiaXRzKQo+ICAgewo+IC0JYmR3X3VwZGF0ZV9w
aXBlX2lycShkZXZfcHJpdiwgcGlwZSwgYml0cywgMCk7Cj4gKwliZHdfdXBkYXRlX3BpcGVfaXJx
KGk5MTUsIHBpcGUsIGJpdHMsIDApOwo+ICAgfQo+IC12b2lkIGlieF9kaXNwbGF5X2ludGVycnVw
dF91cGRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICt2b2lkIGlieF9k
aXNwbGF5X2ludGVycnVwdF91cGRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
ICAJCQkJICB1MzIgaW50ZXJydXB0X21hc2ssCj4gICAJCQkJICB1MzIgZW5hYmxlZF9pcnFfbWFz
ayk7Cj4gICBzdGF0aWMgaW5saW5lIHZvaWQKPiAtaWJ4X2VuYWJsZV9kaXNwbGF5X2ludGVycnVw
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBiaXRzKQo+ICtpYnhfZW5h
YmxlX2Rpc3BsYXlfaW50ZXJydXB0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIg
Yml0cykKPiAgIHsKPiAtCWlieF9kaXNwbGF5X2ludGVycnVwdF91cGRhdGUoZGV2X3ByaXYsIGJp
dHMsIGJpdHMpOwo+ICsJaWJ4X2Rpc3BsYXlfaW50ZXJydXB0X3VwZGF0ZShpOTE1LCBiaXRzLCBi
aXRzKTsKPiAgIH0KPiAgIHN0YXRpYyBpbmxpbmUgdm9pZAo+IC1pYnhfZGlzYWJsZV9kaXNwbGF5
X2ludGVycnVwdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBiaXRzKQo+
ICtpYnhfZGlzYWJsZV9kaXNwbGF5X2ludGVycnVwdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwgdTMyIGJpdHMpCj4gICB7Cj4gLQlpYnhfZGlzcGxheV9pbnRlcnJ1cHRfdXBkYXRlKGRl
dl9wcml2LCBiaXRzLCAwKTsKPiArCWlieF9kaXNwbGF5X2ludGVycnVwdF91cGRhdGUoaTkxNSwg
Yml0cywgMCk7Cj4gICB9Cj4gICAKPiAtdm9pZCBnZW41X2VuYWJsZV9ndF9pcnEoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgbWFzayk7Cj4gLXZvaWQgZ2VuNV9kaXNhYmxl
X2d0X2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBtYXNrKTsKPiAt
dm9pZCBnZW42X21hc2tfcG1faXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwg
dTMyIG1hc2spOwo+IC12b2lkIGdlbjZfdW5tYXNrX3BtX2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsIHUzMiBtYXNrKTsKPiAtdm9pZCBnZW4xMV9yZXNldF9ycHNfaW50ZXJy
dXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGdlbjZfcmVz
ZXRfcnBzX2ludGVycnVwdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAt
dm9pZCBnZW42X2VuYWJsZV9ycHNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpOwo+IC12b2lkIGdlbjZfZGlzYWJsZV9ycHNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGdlbjZfcnBzX3Jlc2V0X2VpKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gK3ZvaWQgZ2VuNV9lbmFibGVfZ3RfaXJx
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgbWFzayk7Cj4gK3ZvaWQgZ2VuNV9k
aXNhYmxlX2d0X2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIG1hc2spOwo+
ICt2b2lkIGdlbjZfbWFza19wbV9pcnEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUz
MiBtYXNrKTsKPiArdm9pZCBnZW42X3VubWFza19wbV9pcnEoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsIHUzMiBtYXNrKTsKPiArdm9pZCBnZW4xMV9yZXNldF9ycHNfaW50ZXJydXB0cyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgZ2VuNl9yZXNldF9ycHNfaW50
ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgZ2VuNl9lbmFi
bGVfcnBzX2ludGVycnVwdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lk
IGdlbjZfZGlzYWJsZV9ycHNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSk7Cj4gK3ZvaWQgZ2VuNl9ycHNfcmVzZXRfZWkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpOwo+ICAgCj4gICBzdGF0aWMgaW5saW5lIHUzMiBnZW42X3Nhbml0aXplX3Jwc19wbV9tYXNr
KGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCQkgICAgdTMyIG1h
c2spCj4gQEAgLTkxLDI1ICs5MSwyNSBAQCBzdGF0aWMgaW5saW5lIHUzMiBnZW42X3Nhbml0aXpl
X3Jwc19wbV9tYXNrKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCXJl
dHVybiBtYXNrICYgfmk5MTUtPmd0X3BtLnJwcy5wbV9pbnRybXNrX21iejsKPiAgIH0KPiAgIAo+
IC12b2lkIGludGVsX3J1bnRpbWVfcG1fZGlzYWJsZV9pbnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdik7Cj4gLXZvaWQgaW50ZWxfcnVudGltZV9wbV9lbmFibGVfaW50
ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC1zdGF0aWMgaW5s
aW5lIGJvb2wgaW50ZWxfaXJxc19lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiArdm9pZCBpbnRlbF9ydW50aW1lX3BtX2Rpc2FibGVfaW50ZXJydXB0cyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgaW50ZWxfcnVudGltZV9wbV9lbmFibGVf
aW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3N0YXRpYyBpbmxp
bmUgYm9vbCBpbnRlbF9pcnFzX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gICB7Cj4gICAJLyoKPiAgIAkgKiBXZSBvbmx5IHVzZSBkcm1faXJxX3VuaW5zdGFsbCgpIGF0
IHVubG9hZCBhbmQgVlQgc3dpdGNoLCBzbwo+ICAgCSAqIHRoaXMgaXMgdGhlIG9ubHkgdGhpbmcg
d2UgbmVlZCB0byBjaGVjay4KPiAgIAkgKi8KPiAtCXJldHVybiBkZXZfcHJpdi0+cnVudGltZV9w
bS5pcnFzX2VuYWJsZWQ7Cj4gKwlyZXR1cm4gaTkxNS0+cnVudGltZV9wbS5pcnFzX2VuYWJsZWQ7
Cj4gICB9Cj4gICAKPiAgIGludCBpbnRlbF9nZXRfY3J0Y19zY2FubGluZShzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0Yyk7Cj4gLXZvaWQgZ2VuOF9pcnFfcG93ZXJfd2VsbF9wb3N0X2VuYWJsZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3ZvaWQgZ2VuOF9pcnFfcG93ZXJfd2Vs
bF9wb3N0X2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAg
IHU4IHBpcGVfbWFzayk7Cj4gLXZvaWQgZ2VuOF9pcnFfcG93ZXJfd2VsbF9wcmVfZGlzYWJsZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3ZvaWQgZ2VuOF9pcnFfcG93ZXJf
d2VsbF9wcmVfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkg
ICAgIHU4IHBpcGVfbWFzayk7Cj4gLXZvaWQgZ2VuOV9yZXNldF9ndWNfaW50ZXJydXB0cyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGdlbjlfZW5hYmxlX2d1Y19p
bnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gLXZvaWQgZ2Vu
OV9kaXNhYmxlX2d1Y19pbnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dik7Cj4gK3ZvaWQgZ2VuOV9yZXNldF9ndWNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgZ2VuOV9lbmFibGVfZ3VjX2ludGVycnVwdHMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lkIGdlbjlfZGlzYWJsZV9ndWNfaW50ZXJydXB0
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICB2b2lkIGdlbjExX3Jlc2V0X2d1
Y19pbnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAgIHZvaWQgZ2Vu
MTFfZW5hYmxlX2d1Y19pbnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsK
PiAgIHZvaWQgZ2VuMTFfZGlzYWJsZV9ndWNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfbWVt
Y3B5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X21lbWNweS5jCj4gaW5kZXggNzlmOGVj
NzU2MzYyLi4yYmQ2NjRjMTZiYTAgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9tZW1jcHkuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfbWVtY3B5LmMK
PiBAQCAtOTQsNyArOTQsNyBAQCBib29sIGk5MTVfbWVtY3B5X2Zyb21fd2Modm9pZCAqZHN0LCBj
b25zdCB2b2lkICpzcmMsIHVuc2lnbmVkIGxvbmcgbGVuKQo+ICAgCXJldHVybiBmYWxzZTsKPiAg
IH0KPiAgIAo+IC12b2lkIGk5MTVfbWVtY3B5X2luaXRfZWFybHkoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGk5MTVfbWVtY3B5X2luaXRfZWFybHkoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJLyoKPiAgIAkgKiBTb21lIGh5cGVydmlz
b3JzIChlLmcuIEtWTSkgZG9uJ3Qgc3VwcG9ydCBWRVgtcHJlZml4IGluc3RydWN0aW9ucwo+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2Jkdy5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9vYV9iZHcuYwo+IGluZGV4IDRhY2RiOTQ1NTViNy4uN2M5N2NkOTBl
OTczIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2FfYmR3LmMKPiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2Jkdy5jCj4gQEAgLTY0LDI4ICs2NCwy
OCBAQCBzaG93X3Rlc3Rfb2FfaWQoc3RydWN0IGRldmljZSAqa2Rldiwgc3RydWN0IGRldmljZV9h
dHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKPiAgIH0KPiAgIAo+ICAgdm9pZAo+IC1pOTE1X3Bl
cmZfbG9hZF90ZXN0X2NvbmZpZ19iZHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ICtpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19iZHcoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJsY3B5KGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmln
LnV1aWQsCj4gKwlzdHJsY3B5KGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcudXVpZCwKPiAgIAkJ
ImQ2ZGU2ZjU1LWU1MjYtNGY3OS1hNmE2LWQ3MzE1YzA5MDQ0ZSIsCj4gLQkJc2l6ZW9mKGRldl9w
cml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQpKTsKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRl
c3RfY29uZmlnLmlkID0gMTsKPiArCQlzaXplb2YoaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy51
dWlkKSk7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmlkID0gMTsKPiAgIAo+IC0JZGV2
X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcubXV4X3JlZ3MgPSBtdXhfY29uZmlnX3Rlc3Rfb2E7
Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVnc19sZW4gPSBBUlJBWV9T
SVpFKG11eF9jb25maWdfdGVzdF9vYSk7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11
eF9yZWdzID0gbXV4X2NvbmZpZ190ZXN0X29hOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZp
Zy5tdXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKG11eF9jb25maWdfdGVzdF9vYSk7Cj4gICAKPiAt
CWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmJfY291bnRlcl9yZWdzID0gYl9jb3VudGVy
X2NvbmZpZ190ZXN0X29hOwo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3Vu
dGVyX3JlZ3NfbGVuID0gQVJSQVlfU0laRShiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2EpOwo+ICsJ
aTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVncyA9IGJfY291bnRlcl9jb25m
aWdfdGVzdF9vYTsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3Nf
bGVuID0gQVJSQVlfU0laRShiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2EpOwo+ICAgCj4gLQlkZXZf
cHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0
X29hOwo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuZmxleF9yZWdzX2xlbiA9IEFS
UkFZX1NJWkUoZmxleF9ldV9jb25maWdfdGVzdF9vYSk7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3Rf
Y29uZmlnLmZsZXhfcmVncyA9IGZsZXhfZXVfY29uZmlnX3Rlc3Rfb2E7Cj4gKwlpOTE1LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLmZsZXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGZsZXhfZXVfY29uZmln
X3Rlc3Rfb2EpOwo+ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19t
ZXRyaWMubmFtZSA9ICJkNmRlNmY1NS1lNTI2LTRmNzktYTZhNi1kNzMxNWMwOTA0NGUiOwo+IC0J
ZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljLmF0dHJzID0gZGV2X3By
aXYtPnBlcmYub2EudGVzdF9jb25maWcuYXR0cnM7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29u
ZmlnLnN5c2ZzX21ldHJpYy5uYW1lID0gImQ2ZGU2ZjU1LWU1MjYtNGY3OS1hNmE2LWQ3MzE1YzA5
MDQ0ZSI7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYy5hdHRycyA9
IGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYXR0cnM7Cj4gICAKPiAtCWRldl9wcml2LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmln
LnN5c2ZzX21ldHJpY19pZC5hdHRyOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5hdHRy
c1swXSA9ICZpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyOwo+
ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0
ci5uYW1lID0gImlkIjsKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21l
dHJpY19pZC5hdHRyLm1vZGUgPSAwNDQ0Owo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25m
aWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gKwlpOTE1LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm5hbWUgPSAiaWQiOwo+ICsJaTkx
NS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0ci5tb2RlID0gMDQ0NDsK
PiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93
X3Rlc3Rfb2FfaWQ7Cj4gICB9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfb2FfYmR3LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2Jkdy5oCj4gaW5kZXgg
MGU2NjdmMWE4YWExLi42OTQ3OWU1YjQzNmYgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9vYV9iZHcuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2Ff
YmR3LmgKPiBAQCAtMTAsNiArMTAsNiBAQAo+ICAgI2lmbmRlZiBfX0k5MTVfT0FfQkRXX0hfXwo+
ICAgI2RlZmluZSBfX0k5MTVfT0FfQkRXX0hfXwo+ICAgCj4gLWV4dGVybiB2b2lkIGk5MTVfcGVy
Zl9sb2FkX3Rlc3RfY29uZmlnX2JkdyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Owo+ICtleHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19iZHcoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgCj4gICAjZW5kaWYKPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9ieHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfb2FfYnh0LmMKPiBpbmRleCBhNDQxOTVjMzk5MjMuLjVlYzIzNmIzM2VjYyAxMDA2NDQKPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2J4dC5jCj4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9vYV9ieHQuYwo+IEBAIC02MiwyOCArNjIsMjggQEAgc2hvd190ZXN0
X29hX2lkKHN0cnVjdCBkZXZpY2UgKmtkZXYsIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRy
LCBjaGFyICpidWYpCj4gICB9Cj4gICAKPiAgIHZvaWQKPiAtaTkxNV9wZXJmX2xvYWRfdGVzdF9j
b25maWdfYnh0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAraTkxNV9wZXJm
X2xvYWRfdGVzdF9jb25maWdfYnh0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAg
ewo+IC0Jc3RybGNweShkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy51dWlkLAo+ICsJc3Ry
bGNweShpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQsCj4gICAJCSI1ZWU3MmY1Yy0wOTJm
LTQyMWUtOGI3MC0yMjVmN2MzZTk2MTIiLAo+IC0JCXNpemVvZihkZXZfcHJpdi0+cGVyZi5vYS50
ZXN0X2NvbmZpZy51dWlkKSk7Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5pZCA9
IDE7Cj4gKwkJc2l6ZW9mKGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcudXVpZCkpOwo+ICsJaTkx
NS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5pZCA9IDE7Cj4gICAKPiAtCWRldl9wcml2LT5wZXJmLm9h
LnRlc3RfY29uZmlnLm11eF9yZWdzID0gbXV4X2NvbmZpZ190ZXN0X29hOwo+IC0JZGV2X3ByaXYt
PnBlcmYub2EudGVzdF9jb25maWcubXV4X3JlZ3NfbGVuID0gQVJSQVlfU0laRShtdXhfY29uZmln
X3Rlc3Rfb2EpOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVncyA9IG11eF9j
b25maWdfdGVzdF9vYTsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcubXV4X3JlZ3NfbGVu
ID0gQVJSQVlfU0laRShtdXhfY29uZmlnX3Rlc3Rfb2EpOwo+ICAgCj4gLQlkZXZfcHJpdi0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVncyA9IGJfY291bnRlcl9jb25maWdfdGVzdF9v
YTsKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmJfY291bnRlcl9yZWdzX2xlbiA9
IEFSUkFZX1NJWkUoYl9jb3VudGVyX2NvbmZpZ190ZXN0X29hKTsKPiArCWk5MTUtPnBlcmYub2Eu
dGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3MgPSBiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2E7Cj4g
KwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmJfY291bnRlcl9yZWdzX2xlbiA9IEFSUkFZX1NJ
WkUoYl9jb3VudGVyX2NvbmZpZ190ZXN0X29hKTsKPiAgIAo+IC0JZGV2X3ByaXYtPnBlcmYub2Eu
dGVzdF9jb25maWcuZmxleF9yZWdzID0gZmxleF9ldV9jb25maWdfdGVzdF9vYTsKPiAtCWRldl9w
cml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmZsZXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGZsZXhf
ZXVfY29uZmlnX3Rlc3Rfb2EpOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3Jl
Z3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZp
Zy5mbGV4X3JlZ3NfbGVuID0gQVJSQVlfU0laRShmbGV4X2V1X2NvbmZpZ190ZXN0X29hKTsKPiAg
IAo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljLm5hbWUgPSAi
NWVlNzJmNWMtMDkyZi00MjFlLThiNzAtMjI1ZjdjM2U5NjEyIjsKPiAtCWRldl9wcml2LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYy5hdHRycyA9IGRldl9wcml2LT5wZXJmLm9hLnRl
c3RfY29uZmlnLmF0dHJzOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRy
aWMubmFtZSA9ICI1ZWU3MmY1Yy0wOTJmLTQyMWUtOGI3MC0yMjVmN2MzZTk2MTIiOwo+ICsJaTkx
NS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMuYXR0cnMgPSBpOTE1LT5wZXJmLm9h
LnRlc3RfY29uZmlnLmF0dHJzOwo+ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZp
Zy5hdHRyc1swXSA9ICZkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNf
aWQuYXR0cjsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYXR0cnNbMF0gPSAmaTkxNS0+
cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0cjsKPiAgIAo+IC0JZGV2X3By
aXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubmFtZSA9ICJpZCI7
Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0ci5t
b2RlID0gMDQ0NDsKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJp
Y19pZC5zaG93ID0gc2hvd190ZXN0X29hX2lkOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZp
Zy5zeXNmc19tZXRyaWNfaWQuYXR0ci5uYW1lID0gImlkIjsKPiArCWk5MTUtPnBlcmYub2EudGVz
dF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubW9kZSA9IDA0NDQ7Cj4gKwlpOTE1LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5zaG93ID0gc2hvd190ZXN0X29hX2lkOwo+
ICAgfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2J4dC5oIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9ieHQuaAo+IGluZGV4IDY3OWU5MmNmNGYxZC4u
NDdkODMyN2YzOGExIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2Ff
Ynh0LmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2J4dC5oCj4gQEAgLTEw
LDYgKzEwLDYgQEAKPiAgICNpZm5kZWYgX19JOTE1X09BX0JYVF9IX18KPiAgICNkZWZpbmUgX19J
OTE1X09BX0JYVF9IX18KPiAgIAo+IC1leHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2Nv
bmZpZ19ieHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiArZXh0ZXJuIHZv
aWQgaTkxNV9wZXJmX2xvYWRfdGVzdF9jb25maWdfYnh0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KTsKPiAgIAo+ICAgI2VuZGlmCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfb2FfY2ZsZ3QyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NmbGd0
Mi5jCj4gaW5kZXggN2Y2MGQ1MWI4NzYxLi4zOTcyY2Q3ZGNiZmMgMTAwNjQ0Cj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9jZmxndDIuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfb2FfY2ZsZ3QyLmMKPiBAQCAtNjMsMjggKzYzLDI4IEBAIHNob3dfdGVzdF9v
YV9pZChzdHJ1Y3QgZGV2aWNlICprZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwg
Y2hhciAqYnVmKQo+ICAgfQo+ICAgCj4gICB2b2lkCj4gLWk5MTVfcGVyZl9sb2FkX3Rlc3RfY29u
ZmlnX2NmbGd0MihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK2k5MTVfcGVy
Zl9sb2FkX3Rlc3RfY29uZmlnX2NmbGd0MihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiAgIHsKPiAtCXN0cmxjcHkoZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcudXVpZCwKPiAr
CXN0cmxjcHkoaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy51dWlkLAo+ICAgCQkiNzRmYjQ5MDIt
ZDNkMy00MjM3LTllOTAtY2JkYzY4ZDBhNDQ2IiwKPiAtCQlzaXplb2YoZGV2X3ByaXYtPnBlcmYu
b2EudGVzdF9jb25maWcudXVpZCkpOwo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcu
aWQgPSAxOwo+ICsJCXNpemVvZihpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQpKTsKPiAr
CWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuaWQgPSAxOwo+ICAgCj4gLQlkZXZfcHJpdi0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVncyA9IG11eF9jb25maWdfdGVzdF9vYTsKPiAtCWRldl9w
cml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11eF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUobXV4X2Nv
bmZpZ190ZXN0X29hKTsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcubXV4X3JlZ3MgPSBt
dXhfY29uZmlnX3Rlc3Rfb2E7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11eF9yZWdz
X2xlbiA9IEFSUkFZX1NJWkUobXV4X2NvbmZpZ190ZXN0X29hKTsKPiAgIAo+IC0JZGV2X3ByaXYt
PnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3MgPSBiX2NvdW50ZXJfY29uZmlnX3Rl
c3Rfb2E7Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVnc19s
ZW4gPSBBUlJBWV9TSVpFKGJfY291bnRlcl9jb25maWdfdGVzdF9vYSk7Cj4gKwlpOTE1LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLmJfY291bnRlcl9yZWdzID0gYl9jb3VudGVyX2NvbmZpZ190ZXN0X29h
Owo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVnc19sZW4gPSBBUlJB
WV9TSVpFKGJfY291bnRlcl9jb25maWdfdGVzdF9vYSk7Cj4gICAKPiAtCWRldl9wcml2LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLmZsZXhfcmVncyA9IGZsZXhfZXVfY29uZmlnX3Rlc3Rfb2E7Cj4gLQlk
ZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3NfbGVuID0gQVJSQVlfU0laRShm
bGV4X2V1X2NvbmZpZ190ZXN0X29hKTsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuZmxl
eF9yZWdzID0gZmxleF9ldV9jb25maWdfdGVzdF9vYTsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9j
b25maWcuZmxleF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUoZmxleF9ldV9jb25maWdfdGVzdF9vYSk7
Cj4gICAKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYy5uYW1l
ID0gIjc0ZmI0OTAyLWQzZDMtNDIzNy05ZTkwLWNiZGM2OGQwYTQ0NiI7Cj4gLQlkZXZfcHJpdi0+
cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMuYXR0cnMgPSBkZXZfcHJpdi0+cGVyZi5v
YS50ZXN0X2NvbmZpZy5hdHRyczsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNf
bWV0cmljLm5hbWUgPSAiNzRmYjQ5MDItZDNkMy00MjM3LTllOTAtY2JkYzY4ZDBhNDQ2IjsKPiAr
CWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljLmF0dHJzID0gaTkxNS0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5hdHRyczsKPiAgIAo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9j
b25maWcuYXR0cnNbMF0gPSAmZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0
cmljX2lkLmF0dHI7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmk5
MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHI7Cj4gICAKPiAtCWRl
dl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm5hbWUgPSAi
aWQiOwo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0
dHIubW9kZSA9IDA0NDQ7Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19t
ZXRyaWNfaWQuc2hvdyA9IHNob3dfdGVzdF9vYV9pZDsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9j
b25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubmFtZSA9ICJpZCI7Cj4gKwlpOTE1LT5wZXJmLm9h
LnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm1vZGUgPSAwNDQ0Owo+ICsJaTkxNS0+
cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuc2hvdyA9IHNob3dfdGVzdF9vYV9p
ZDsKPiAgIH0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9jZmxn
dDIuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2FfY2ZsZ3QyLmgKPiBpbmRleCA0ZDYw
MjU1NTliYmUuLjQzNDU0NWM5YzVkOSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X29hX2NmbGd0Mi5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9j
ZmxndDIuaAo+IEBAIC0xMCw2ICsxMCw2IEBACj4gICAjaWZuZGVmIF9fSTkxNV9PQV9DRkxHVDJf
SF9fCj4gICAjZGVmaW5lIF9fSTkxNV9PQV9DRkxHVDJfSF9fCj4gICAKPiAtZXh0ZXJuIHZvaWQg
aTkxNV9wZXJmX2xvYWRfdGVzdF9jb25maWdfY2ZsZ3QyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdik7Cj4gK2V4dGVybiB2b2lkIGk5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX2Nm
bGd0MihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICAKPiAgICNlbmRpZgo+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NmbGd0My5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9jZmxndDMuYwo+IGluZGV4IGE5MmMzOGUzYTBjZS4uYzAw
YjlkOWQ2ZGRmIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2FfY2Zs
Z3QzLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NmbGd0My5jCj4gQEAg
LTYzLDI4ICs2MywyOCBAQCBzaG93X3Rlc3Rfb2FfaWQoc3RydWN0IGRldmljZSAqa2Rldiwgc3Ry
dWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKPiAgIH0KPiAgIAo+ICAgdm9p
ZAo+IC1pOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19jZmxndDMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ICtpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19jZmxndDMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJsY3B5KGRldl9wcml2LT5w
ZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQsCj4gKwlzdHJsY3B5KGk5MTUtPnBlcmYub2EudGVzdF9j
b25maWcudXVpZCwKPiAgIAkJIjU3N2U4ZTJjLTNmYTAtNDg3NS04NzQzLTM1MzhkNTg1ZTNiMCIs
Cj4gLQkJc2l6ZW9mKGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQpKTsKPiAtCWRl
dl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmlkID0gMTsKPiArCQlzaXplb2YoaTkxNS0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy51dWlkKSk7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmlk
ID0gMTsKPiAgIAo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcubXV4X3JlZ3MgPSBt
dXhfY29uZmlnX3Rlc3Rfb2E7Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhf
cmVnc19sZW4gPSBBUlJBWV9TSVpFKG11eF9jb25maWdfdGVzdF9vYSk7Cj4gKwlpOTE1LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLm11eF9yZWdzID0gbXV4X2NvbmZpZ190ZXN0X29hOwo+ICsJaTkxNS0+
cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKG11eF9jb25maWdf
dGVzdF9vYSk7Cj4gICAKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmJfY291bnRl
cl9yZWdzID0gYl9jb3VudGVyX2NvbmZpZ190ZXN0X29hOwo+IC0JZGV2X3ByaXYtPnBlcmYub2Eu
dGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3NfbGVuID0gQVJSQVlfU0laRShiX2NvdW50ZXJfY29u
ZmlnX3Rlc3Rfb2EpOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVn
cyA9IGJfY291bnRlcl9jb25maWdfdGVzdF9vYTsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25m
aWcuYl9jb3VudGVyX3JlZ3NfbGVuID0gQVJSQVlfU0laRShiX2NvdW50ZXJfY29uZmlnX3Rlc3Rf
b2EpOwo+ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBm
bGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcu
ZmxleF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUoZmxleF9ldV9jb25maWdfdGVzdF9vYSk7Cj4gKwlp
OTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmZsZXhfcmVncyA9IGZsZXhfZXVfY29uZmlnX3Rlc3Rf
b2E7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmZsZXhfcmVnc19sZW4gPSBBUlJBWV9T
SVpFKGZsZXhfZXVfY29uZmlnX3Rlc3Rfb2EpOwo+ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50
ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMubmFtZSA9ICI1NzdlOGUyYy0zZmEwLTQ4NzUtODc0My0z
NTM4ZDU4NWUzYjAiOwo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0
cmljLmF0dHJzID0gZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuYXR0cnM7Cj4gKwlpOTE1
LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYy5uYW1lID0gIjU3N2U4ZTJjLTNmYTAt
NDg3NS04NzQzLTM1MzhkNTg1ZTNiMCI7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5
c2ZzX21ldHJpYy5hdHRycyA9IGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYXR0cnM7Cj4gICAK
PiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmRldl9wcml2LT5w
ZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyOwo+ICsJaTkxNS0+cGVyZi5v
YS50ZXN0X2NvbmZpZy5hdHRyc1swXSA9ICZpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2Zz
X21ldHJpY19pZC5hdHRyOwo+ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5z
eXNmc19tZXRyaWNfaWQuYXR0ci5uYW1lID0gImlkIjsKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRl
c3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm1vZGUgPSAwNDQ0Owo+IC0JZGV2X3ByaXYt
PnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2Ff
aWQ7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm5h
bWUgPSAiaWQiOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQu
YXR0ci5tb2RlID0gMDQ0NDsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0
cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gICB9Cj4gZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfb2FfY2ZsZ3QzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X29hX2NmbGd0My5oCj4gaW5kZXggMDY5N2Y0MDc3NDAyLi4yYzIzZWRhMDU2YWEgMTAwNjQ0
Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9jZmxndDMuaAo+ICsrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2FfY2ZsZ3QzLmgKPiBAQCAtMTAsNiArMTAsNiBAQAo+
ICAgI2lmbmRlZiBfX0k5MTVfT0FfQ0ZMR1QzX0hfXwo+ICAgI2RlZmluZSBfX0k5MTVfT0FfQ0ZM
R1QzX0hfXwo+ICAgCj4gLWV4dGVybiB2b2lkIGk5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX2Nm
bGd0MyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ICtleHRlcm4gdm9pZCBp
OTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19jZmxndDMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpOwo+ICAgCj4gICAjZW5kaWYKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9vYV9jaHYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2FfY2h2LmMKPiBp
bmRleCA3MWVjODg5YTAxMTQuLjU4MjlkMjRkMGY3YyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X29hX2Nodi5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9vYV9jaHYuYwo+IEBAIC02MywyOCArNjMsMjggQEAgc2hvd190ZXN0X29hX2lkKHN0cnVjdCBk
ZXZpY2UgKmtkZXYsIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCj4g
ICB9Cj4gICAKPiAgIHZvaWQKPiAtaTkxNV9wZXJmX2xvYWRfdGVzdF9jb25maWdfY2h2KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAraTkxNV9wZXJmX2xvYWRfdGVzdF9jb25m
aWdfY2h2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RybGNweShk
ZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy51dWlkLAo+ICsJc3RybGNweShpOTE1LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLnV1aWQsCj4gICAJCSI0YTUzNGIwNy1jYmEzLTQxNGQtOGQ2MC04NzQ4
MzBlODgzYWEiLAo+IC0JCXNpemVvZihkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy51dWlk
KSk7Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5pZCA9IDE7Cj4gKwkJc2l6ZW9m
KGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcudXVpZCkpOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0
X2NvbmZpZy5pZCA9IDE7Cj4gICAKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11
eF9yZWdzID0gbXV4X2NvbmZpZ190ZXN0X29hOwo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9j
b25maWcubXV4X3JlZ3NfbGVuID0gQVJSQVlfU0laRShtdXhfY29uZmlnX3Rlc3Rfb2EpOwo+ICsJ
aTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVncyA9IG11eF9jb25maWdfdGVzdF9vYTsK
PiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcubXV4X3JlZ3NfbGVuID0gQVJSQVlfU0laRSht
dXhfY29uZmlnX3Rlc3Rfb2EpOwo+ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZp
Zy5iX2NvdW50ZXJfcmVncyA9IGJfY291bnRlcl9jb25maWdfdGVzdF9vYTsKPiAtCWRldl9wcml2
LT5wZXJmLm9hLnRlc3RfY29uZmlnLmJfY291bnRlcl9yZWdzX2xlbiA9IEFSUkFZX1NJWkUoYl9j
b3VudGVyX2NvbmZpZ190ZXN0X29hKTsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYl9j
b3VudGVyX3JlZ3MgPSBiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2E7Cj4gKwlpOTE1LT5wZXJmLm9h
LnRlc3RfY29uZmlnLmJfY291bnRlcl9yZWdzX2xlbiA9IEFSUkFZX1NJWkUoYl9jb3VudGVyX2Nv
bmZpZ190ZXN0X29hKTsKPiAgIAo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuZmxl
eF9yZWdzID0gZmxleF9ldV9jb25maWdfdGVzdF9vYTsKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRl
c3RfY29uZmlnLmZsZXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGZsZXhfZXVfY29uZmlnX3Rlc3Rf
b2EpOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2Nv
bmZpZ190ZXN0X29hOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3NfbGVu
ID0gQVJSQVlfU0laRShmbGV4X2V1X2NvbmZpZ190ZXN0X29hKTsKPiAgIAo+IC0JZGV2X3ByaXYt
PnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljLm5hbWUgPSAiNGE1MzRiMDctY2JhMy00
MTRkLThkNjAtODc0ODMwZTg4M2FhIjsKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmln
LnN5c2ZzX21ldHJpYy5hdHRycyA9IGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJz
Owo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMubmFtZSA9ICI0YTUz
NGIwNy1jYmEzLTQxNGQtOGQ2MC04NzQ4MzBlODgzYWEiOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0
X2NvbmZpZy5zeXNmc19tZXRyaWMuYXR0cnMgPSBpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0
dHJzOwo+ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5hdHRyc1swXSA9ICZk
ZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0cjsKPiArCWk5
MTUtPnBlcmYub2EudGVzdF9jb25maWcuYXR0cnNbMF0gPSAmaTkxNS0+cGVyZi5vYS50ZXN0X2Nv
bmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0cjsKPiAgIAo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVz
dF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubmFtZSA9ICJpZCI7Cj4gLQlkZXZfcHJpdi0+
cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0ci5tb2RlID0gMDQ0NDsKPiAt
CWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5zaG93ID0gc2hv
d190ZXN0X29hX2lkOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNf
aWQuYXR0ci5uYW1lID0gImlkIjsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNf
bWV0cmljX2lkLmF0dHIubW9kZSA9IDA0NDQ7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmln
LnN5c2ZzX21ldHJpY19pZC5zaG93ID0gc2hvd190ZXN0X29hX2lkOwo+ICAgfQo+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2Nodi5oIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9vYV9jaHYuaAo+IGluZGV4IDA5ODZlYWUzMTM1Zi4uNGJiM2I2YmU3YmQyIDEw
MDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2FfY2h2LmgKPiArKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2Nodi5oCj4gQEAgLTEwLDYgKzEwLDYgQEAKPiAg
ICNpZm5kZWYgX19JOTE1X09BX0NIVl9IX18KPiAgICNkZWZpbmUgX19JOTE1X09BX0NIVl9IX18K
PiAgIAo+IC1leHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19jaHYoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiArZXh0ZXJuIHZvaWQgaTkxNV9wZXJmX2xv
YWRfdGVzdF9jb25maWdfY2h2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAgIAo+
ICAgI2VuZGlmCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2FfY25s
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NubC5jCj4gaW5kZXggNWMyM2Q4ODNk
NmM5Li5mY2YwOGI5ZTdjNzMgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9vYV9jbmwuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2FfY25sLmMKPiBA
QCAtNzUsMjggKzc1LDI4IEBAIHNob3dfdGVzdF9vYV9pZChzdHJ1Y3QgZGV2aWNlICprZGV2LCBz
dHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+ICAgfQo+ICAgCj4gICB2
b2lkCj4gLWk5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX2NubChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gK2k5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX2NubChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cmxjcHkoZGV2X3ByaXYtPnBlcmYu
b2EudGVzdF9jb25maWcudXVpZCwKPiArCXN0cmxjcHkoaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZp
Zy51dWlkLAo+ICAgCQkiZGI0MWVkZDQtZDhlNy00NzMwLWFkMTEtYjlhMmQ2ODMzNTAzIiwKPiAt
CQlzaXplb2YoZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcudXVpZCkpOwo+IC0JZGV2X3By
aXYtPnBlcmYub2EudGVzdF9jb25maWcuaWQgPSAxOwo+ICsJCXNpemVvZihpOTE1LT5wZXJmLm9h
LnRlc3RfY29uZmlnLnV1aWQpKTsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuaWQgPSAx
Owo+ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVncyA9IG11eF9j
b25maWdfdGVzdF9vYTsKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11eF9yZWdz
X2xlbiA9IEFSUkFZX1NJWkUobXV4X2NvbmZpZ190ZXN0X29hKTsKPiArCWk5MTUtPnBlcmYub2Eu
dGVzdF9jb25maWcubXV4X3JlZ3MgPSBtdXhfY29uZmlnX3Rlc3Rfb2E7Cj4gKwlpOTE1LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLm11eF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUobXV4X2NvbmZpZ190ZXN0
X29hKTsKPiAgIAo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3Jl
Z3MgPSBiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2E7Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0
X2NvbmZpZy5iX2NvdW50ZXJfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGJfY291bnRlcl9jb25maWdf
dGVzdF9vYSk7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmJfY291bnRlcl9yZWdzID0g
Yl9jb3VudGVyX2NvbmZpZ190ZXN0X29hOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5i
X2NvdW50ZXJfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGJfY291bnRlcl9jb25maWdfdGVzdF9vYSk7
Cj4gICAKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmZsZXhfcmVncyA9IGZsZXhf
ZXVfY29uZmlnX3Rlc3Rfb2E7Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4
X3JlZ3NfbGVuID0gQVJSQVlfU0laRShmbGV4X2V1X2NvbmZpZ190ZXN0X29hKTsKPiArCWk5MTUt
PnBlcmYub2EudGVzdF9jb25maWcuZmxleF9yZWdzID0gZmxleF9ldV9jb25maWdfdGVzdF9vYTsK
PiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuZmxleF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUo
ZmxleF9ldV9jb25maWdfdGVzdF9vYSk7Cj4gICAKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3Rf
Y29uZmlnLnN5c2ZzX21ldHJpYy5uYW1lID0gImRiNDFlZGQ0LWQ4ZTctNDczMC1hZDExLWI5YTJk
NjgzMzUwMyI7Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMu
YXR0cnMgPSBkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5hdHRyczsKPiArCWk5MTUtPnBl
cmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljLm5hbWUgPSAiZGI0MWVkZDQtZDhlNy00NzMw
LWFkMTEtYjlhMmQ2ODMzNTAzIjsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNf
bWV0cmljLmF0dHJzID0gaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5hdHRyczsKPiAgIAo+IC0J
ZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuYXR0cnNbMF0gPSAmZGV2X3ByaXYtPnBlcmYu
b2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHI7Cj4gKwlpOTE1LT5wZXJmLm9hLnRl
c3RfY29uZmlnLmF0dHJzWzBdID0gJmk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0
cmljX2lkLmF0dHI7Cj4gICAKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2Zz
X21ldHJpY19pZC5hdHRyLm5hbWUgPSAiaWQiOwo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9j
b25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubW9kZSA9IDA0NDQ7Cj4gLQlkZXZfcHJpdi0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuc2hvdyA9IHNob3dfdGVzdF9vYV9pZDsK
PiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubmFtZSA9
ICJpZCI7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRy
Lm1vZGUgPSAwNDQ0Owo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNf
aWQuc2hvdyA9IHNob3dfdGVzdF9vYV9pZDsKPiAgIH0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9vYV9jbmwuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2Ff
Y25sLmgKPiBpbmRleCBlODMwYTQwNmFmZjIuLmM3MDEwMTY1NTA0OSAxMDA2NDQKPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NubC5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9vYV9jbmwuaAo+IEBAIC0xMCw2ICsxMCw2IEBACj4gICAjaWZuZGVmIF9fSTkx
NV9PQV9DTkxfSF9fCj4gICAjZGVmaW5lIF9fSTkxNV9PQV9DTkxfSF9fCj4gICAKPiAtZXh0ZXJu
IHZvaWQgaTkxNV9wZXJmX2xvYWRfdGVzdF9jb25maWdfY25sKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdik7Cj4gK2V4dGVybiB2b2lkIGk5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmln
X2NubChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICAKPiAgICNlbmRpZgo+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2dsay5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9vYV9nbGsuYwo+IGluZGV4IDRiZGRhNjZkZjdkMi4uZmRiMzhiOWVh
OWJiIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2FfZ2xrLmMKPiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2dsay5jCj4gQEAgLTYyLDI4ICs2Miwy
OCBAQCBzaG93X3Rlc3Rfb2FfaWQoc3RydWN0IGRldmljZSAqa2Rldiwgc3RydWN0IGRldmljZV9h
dHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKPiAgIH0KPiAgIAo+ICAgdm9pZAo+IC1pOTE1X3Bl
cmZfbG9hZF90ZXN0X2NvbmZpZ19nbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ICtpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19nbGsoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJsY3B5KGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmln
LnV1aWQsCj4gKwlzdHJsY3B5KGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcudXVpZCwKPiAgIAkJ
ImRkM2ZkNzg5LWU3ODMtNDIwNC04Y2QwLWI2NzFiYmNjYjBjZiIsCj4gLQkJc2l6ZW9mKGRldl9w
cml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQpKTsKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRl
c3RfY29uZmlnLmlkID0gMTsKPiArCQlzaXplb2YoaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy51
dWlkKSk7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmlkID0gMTsKPiAgIAo+IC0JZGV2
X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcubXV4X3JlZ3MgPSBtdXhfY29uZmlnX3Rlc3Rfb2E7
Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVnc19sZW4gPSBBUlJBWV9T
SVpFKG11eF9jb25maWdfdGVzdF9vYSk7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11
eF9yZWdzID0gbXV4X2NvbmZpZ190ZXN0X29hOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZp
Zy5tdXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKG11eF9jb25maWdfdGVzdF9vYSk7Cj4gICAKPiAt
CWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmJfY291bnRlcl9yZWdzID0gYl9jb3VudGVy
X2NvbmZpZ190ZXN0X29hOwo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3Vu
dGVyX3JlZ3NfbGVuID0gQVJSQVlfU0laRShiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2EpOwo+ICsJ
aTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVncyA9IGJfY291bnRlcl9jb25m
aWdfdGVzdF9vYTsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3Nf
bGVuID0gQVJSQVlfU0laRShiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2EpOwo+ICAgCj4gLQlkZXZf
cHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0
X29hOwo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuZmxleF9yZWdzX2xlbiA9IEFS
UkFZX1NJWkUoZmxleF9ldV9jb25maWdfdGVzdF9vYSk7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3Rf
Y29uZmlnLmZsZXhfcmVncyA9IGZsZXhfZXVfY29uZmlnX3Rlc3Rfb2E7Cj4gKwlpOTE1LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLmZsZXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGZsZXhfZXVfY29uZmln
X3Rlc3Rfb2EpOwo+ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19t
ZXRyaWMubmFtZSA9ICJkZDNmZDc4OS1lNzgzLTQyMDQtOGNkMC1iNjcxYmJjY2IwY2YiOwo+IC0J
ZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljLmF0dHJzID0gZGV2X3By
aXYtPnBlcmYub2EudGVzdF9jb25maWcuYXR0cnM7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29u
ZmlnLnN5c2ZzX21ldHJpYy5uYW1lID0gImRkM2ZkNzg5LWU3ODMtNDIwNC04Y2QwLWI2NzFiYmNj
YjBjZiI7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYy5hdHRycyA9
IGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYXR0cnM7Cj4gICAKPiAtCWRldl9wcml2LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmln
LnN5c2ZzX21ldHJpY19pZC5hdHRyOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5hdHRy
c1swXSA9ICZpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyOwo+
ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0
ci5uYW1lID0gImlkIjsKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21l
dHJpY19pZC5hdHRyLm1vZGUgPSAwNDQ0Owo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25m
aWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gKwlpOTE1LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm5hbWUgPSAiaWQiOwo+ICsJaTkx
NS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0ci5tb2RlID0gMDQ0NDsK
PiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93
X3Rlc3Rfb2FfaWQ7Cj4gICB9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfb2FfZ2xrLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2dsay5oCj4gaW5kZXgg
MDZkZWRmOTkxZWRiLi41ZDA3OTg2ODI3YzggMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9vYV9nbGsuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2Ff
Z2xrLmgKPiBAQCAtMTAsNiArMTAsNiBAQAo+ICAgI2lmbmRlZiBfX0k5MTVfT0FfR0xLX0hfXwo+
ICAgI2RlZmluZSBfX0k5MTVfT0FfR0xLX0hfXwo+ICAgCj4gLWV4dGVybiB2b2lkIGk5MTVfcGVy
Zl9sb2FkX3Rlc3RfY29uZmlnX2dsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Owo+ICtleHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19nbGsoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgCj4gICAjZW5kaWYKPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9oc3cuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfb2FfaHN3LmMKPiBpbmRleCBjYzY1MjZmZGQyYmQuLjY0MDMwMWM5ZmI5ZCAxMDA2NDQKPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2hzdy5jCj4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9vYV9oc3cuYwo+IEBAIC05MiwyOCArOTIsMjggQEAgc2hvd19yZW5k
ZXJfYmFzaWNfaWQoc3RydWN0IGRldmljZSAqa2Rldiwgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUg
KmF0dHIsIGNoYXIgKmIKPiAgIH0KPiAgIAo+ICAgdm9pZAo+IC1pOTE1X3BlcmZfbG9hZF90ZXN0
X2NvbmZpZ19oc3coc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtpOTE1X3Bl
cmZfbG9hZF90ZXN0X2NvbmZpZ19oc3coc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
ICB7Cj4gLQlzdHJsY3B5KGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQsCj4gKwlz
dHJsY3B5KGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcudXVpZCwKPiAgIAkJIjQwM2Q4ODMyLTFh
MjctNGFhNi1hNjRlLWY1Mzg5Y2U3YjIxMiIsCj4gLQkJc2l6ZW9mKGRldl9wcml2LT5wZXJmLm9h
LnRlc3RfY29uZmlnLnV1aWQpKTsKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmlk
ID0gMTsKPiArCQlzaXplb2YoaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy51dWlkKSk7Cj4gKwlp
OTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmlkID0gMTsKPiAgIAo+IC0JZGV2X3ByaXYtPnBlcmYu
b2EudGVzdF9jb25maWcubXV4X3JlZ3MgPSBtdXhfY29uZmlnX3JlbmRlcl9iYXNpYzsKPiAtCWRl
dl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11eF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUobXV4
X2NvbmZpZ19yZW5kZXJfYmFzaWMpOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhf
cmVncyA9IG11eF9jb25maWdfcmVuZGVyX2Jhc2ljOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2Nv
bmZpZy5tdXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKG11eF9jb25maWdfcmVuZGVyX2Jhc2ljKTsK
PiAgIAo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3MgPSBi
X2NvdW50ZXJfY29uZmlnX3JlbmRlcl9iYXNpYzsKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3Rf
Y29uZmlnLmJfY291bnRlcl9yZWdzX2xlbiA9IEFSUkFZX1NJWkUoYl9jb3VudGVyX2NvbmZpZ19y
ZW5kZXJfYmFzaWMpOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVn
cyA9IGJfY291bnRlcl9jb25maWdfcmVuZGVyX2Jhc2ljOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0
X2NvbmZpZy5iX2NvdW50ZXJfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGJfY291bnRlcl9jb25maWdf
cmVuZGVyX2Jhc2ljKTsKPiAgIAo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuZmxl
eF9yZWdzID0gZmxleF9ldV9jb25maWdfcmVuZGVyX2Jhc2ljOwo+IC0JZGV2X3ByaXYtPnBlcmYu
b2EudGVzdF9jb25maWcuZmxleF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUoZmxleF9ldV9jb25maWdf
cmVuZGVyX2Jhc2ljKTsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuZmxleF9yZWdzID0g
ZmxleF9ldV9jb25maWdfcmVuZGVyX2Jhc2ljOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZp
Zy5mbGV4X3JlZ3NfbGVuID0gQVJSQVlfU0laRShmbGV4X2V1X2NvbmZpZ19yZW5kZXJfYmFzaWMp
Owo+ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMubmFt
ZSA9ICI0MDNkODgzMi0xYTI3LTRhYTYtYTY0ZS1mNTM4OWNlN2IyMTIiOwo+IC0JZGV2X3ByaXYt
PnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljLmF0dHJzID0gZGV2X3ByaXYtPnBlcmYu
b2EudGVzdF9jb25maWcuYXR0cnM7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2Zz
X21ldHJpYy5uYW1lID0gIjQwM2Q4ODMyLTFhMjctNGFhNi1hNjRlLWY1Mzg5Y2U3YjIxMiI7Cj4g
KwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYy5hdHRycyA9IGk5MTUtPnBl
cmYub2EudGVzdF9jb25maWcuYXR0cnM7Cj4gICAKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3Rf
Y29uZmlnLmF0dHJzWzBdID0gJmRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21l
dHJpY19pZC5hdHRyOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5hdHRyc1swXSA9ICZp
OTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyOwo+ICAgCj4gLQlk
ZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0ci5uYW1lID0g
ImlkIjsKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5h
dHRyLm1vZGUgPSAwNDQ0Owo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNf
bWV0cmljX2lkLnNob3cgPSBzaG93X3JlbmRlcl9iYXNpY19pZDsKPiArCWk5MTUtPnBlcmYub2Eu
dGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubmFtZSA9ICJpZCI7Cj4gKwlpOTE1LT5w
ZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm1vZGUgPSAwNDQ0Owo+ICsJ
aTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuc2hvdyA9IHNob3dfcmVu
ZGVyX2Jhc2ljX2lkOwo+ICAgfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X29hX2hzdy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9oc3cuaAo+IGluZGV4
IDNkMGM4NzBjZDBiZC4uNzgxMmE5ZGY4NjQ3IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfb2FfaHN3LmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29h
X2hzdy5oCj4gQEAgLTEwLDYgKzEwLDYgQEAKPiAgICNpZm5kZWYgX19JOTE1X09BX0hTV19IX18K
PiAgICNkZWZpbmUgX19JOTE1X09BX0hTV19IX18KPiAgIAo+IC1leHRlcm4gdm9pZCBpOTE1X3Bl
cmZfbG9hZF90ZXN0X2NvbmZpZ19oc3coc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KTsKPiArZXh0ZXJuIHZvaWQgaTkxNV9wZXJmX2xvYWRfdGVzdF9jb25maWdfaHN3KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAgIAo+ICAgI2VuZGlmCj4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2FfaWNsLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X29hX2ljbC5jCj4gaW5kZXggYmFhNTE0MjdhNTQzLi4yYThjNmRlNjE5YmEgMTAwNjQ0Cj4g
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9pY2wuYwo+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfb2FfaWNsLmMKPiBAQCAtNzIsMjggKzcyLDI4IEBAIHNob3dfdGVz
dF9vYV9pZChzdHJ1Y3QgZGV2aWNlICprZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0
ciwgY2hhciAqYnVmKQo+ICAgfQo+ICAgCj4gICB2b2lkCj4gLWk5MTVfcGVyZl9sb2FkX3Rlc3Rf
Y29uZmlnX2ljbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK2k5MTVfcGVy
Zl9sb2FkX3Rlc3RfY29uZmlnX2ljbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAg
IHsKPiAtCXN0cmxjcHkoZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcudXVpZCwKPiArCXN0
cmxjcHkoaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy51dWlkLAo+ICAgCQkiYTI5MTY2NWUtMjQ0
Yi00Yjc2LTliOWEtMDFkZTlkM2M4MDY4IiwKPiAtCQlzaXplb2YoZGV2X3ByaXYtPnBlcmYub2Eu
dGVzdF9jb25maWcudXVpZCkpOwo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuaWQg
PSAxOwo+ICsJCXNpemVvZihpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQpKTsKPiArCWk5
MTUtPnBlcmYub2EudGVzdF9jb25maWcuaWQgPSAxOwo+ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5v
YS50ZXN0X2NvbmZpZy5tdXhfcmVncyA9IG11eF9jb25maWdfdGVzdF9vYTsKPiAtCWRldl9wcml2
LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11eF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUobXV4X2NvbmZp
Z190ZXN0X29hKTsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcubXV4X3JlZ3MgPSBtdXhf
Y29uZmlnX3Rlc3Rfb2E7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11eF9yZWdzX2xl
biA9IEFSUkFZX1NJWkUobXV4X2NvbmZpZ190ZXN0X29hKTsKPiAgIAo+IC0JZGV2X3ByaXYtPnBl
cmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3MgPSBiX2NvdW50ZXJfY29uZmlnX3Rlc3Rf
b2E7Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVnc19sZW4g
PSBBUlJBWV9TSVpFKGJfY291bnRlcl9jb25maWdfdGVzdF9vYSk7Cj4gKwlpOTE1LT5wZXJmLm9h
LnRlc3RfY29uZmlnLmJfY291bnRlcl9yZWdzID0gYl9jb3VudGVyX2NvbmZpZ190ZXN0X29hOwo+
ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVnc19sZW4gPSBBUlJBWV9T
SVpFKGJfY291bnRlcl9jb25maWdfdGVzdF9vYSk7Cj4gICAKPiAtCWRldl9wcml2LT5wZXJmLm9h
LnRlc3RfY29uZmlnLmZsZXhfcmVncyA9IGZsZXhfZXVfY29uZmlnX3Rlc3Rfb2E7Cj4gLQlkZXZf
cHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3NfbGVuID0gQVJSQVlfU0laRShmbGV4
X2V1X2NvbmZpZ190ZXN0X29hKTsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuZmxleF9y
ZWdzID0gZmxleF9ldV9jb25maWdfdGVzdF9vYTsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25m
aWcuZmxleF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUoZmxleF9ldV9jb25maWdfdGVzdF9vYSk7Cj4g
ICAKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYy5uYW1lID0g
ImEyOTE2NjVlLTI0NGItNGI3Ni05YjlhLTAxZGU5ZDNjODA2OCI7Cj4gLQlkZXZfcHJpdi0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMuYXR0cnMgPSBkZXZfcHJpdi0+cGVyZi5vYS50
ZXN0X2NvbmZpZy5hdHRyczsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0
cmljLm5hbWUgPSAiYTI5MTY2NWUtMjQ0Yi00Yjc2LTliOWEtMDFkZTlkM2M4MDY4IjsKPiArCWk5
MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljLmF0dHJzID0gaTkxNS0+cGVyZi5v
YS50ZXN0X2NvbmZpZy5hdHRyczsKPiAgIAo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25m
aWcuYXR0cnNbMF0gPSAmZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmlj
X2lkLmF0dHI7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmk5MTUt
PnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHI7Cj4gICAKPiAtCWRldl9w
cml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm5hbWUgPSAiaWQi
Owo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIu
bW9kZSA9IDA0NDQ7Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRy
aWNfaWQuc2hvdyA9IHNob3dfdGVzdF9vYV9pZDsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25m
aWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubmFtZSA9ICJpZCI7Cj4gKwlpOTE1LT5wZXJmLm9hLnRl
c3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm1vZGUgPSAwNDQ0Owo+ICsJaTkxNS0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuc2hvdyA9IHNob3dfdGVzdF9vYV9pZDsK
PiAgIH0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9pY2wuaCBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2FfaWNsLmgKPiBpbmRleCAyNGVhYTk3ZDYxYmEu
LmE3YzUwZDMxZTY3OCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29h
X2ljbC5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9pY2wuaAo+IEBAIC0x
MCw2ICsxMCw2IEBACj4gICAjaWZuZGVmIF9fSTkxNV9PQV9JQ0xfSF9fCj4gICAjZGVmaW5lIF9f
STkxNV9PQV9JQ0xfSF9fCj4gICAKPiAtZXh0ZXJuIHZvaWQgaTkxNV9wZXJmX2xvYWRfdGVzdF9j
b25maWdfaWNsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gK2V4dGVybiB2
b2lkIGk5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX2ljbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSk7Cj4gICAKPiAgICNlbmRpZgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X29hX2tibGd0Mi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9rYmxn
dDIuYwo+IGluZGV4IDE2OGU0OWFiMGQ0ZC4uOTc1MzExZGYzZDYyIDEwMDY0NAo+IC0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2Ffa2JsZ3QyLmMKPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X29hX2tibGd0Mi5jCj4gQEAgLTYzLDI4ICs2MywyOCBAQCBzaG93X3Rlc3Rf
b2FfaWQoc3RydWN0IGRldmljZSAqa2Rldiwgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIs
IGNoYXIgKmJ1ZikKPiAgIH0KPiAgIAo+ICAgdm9pZAo+IC1pOTE1X3BlcmZfbG9hZF90ZXN0X2Nv
bmZpZ19rYmxndDIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtpOTE1X3Bl
cmZfbG9hZF90ZXN0X2NvbmZpZ19rYmxndDIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gICB7Cj4gLQlzdHJsY3B5KGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQsCj4g
KwlzdHJsY3B5KGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcudXVpZCwKPiAgIAkJImJhYTNjN2U0
LTUyYjYtNGI4NS04MDFlLTQ2NWE5NGI3NDZkZCIsCj4gLQkJc2l6ZW9mKGRldl9wcml2LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLnV1aWQpKTsKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmln
LmlkID0gMTsKPiArCQlzaXplb2YoaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy51dWlkKSk7Cj4g
KwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmlkID0gMTsKPiAgIAo+IC0JZGV2X3ByaXYtPnBl
cmYub2EudGVzdF9jb25maWcubXV4X3JlZ3MgPSBtdXhfY29uZmlnX3Rlc3Rfb2E7Cj4gLQlkZXZf
cHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKG11eF9j
b25maWdfdGVzdF9vYSk7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11eF9yZWdzID0g
bXV4X2NvbmZpZ190ZXN0X29hOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVn
c19sZW4gPSBBUlJBWV9TSVpFKG11eF9jb25maWdfdGVzdF9vYSk7Cj4gICAKPiAtCWRldl9wcml2
LT5wZXJmLm9hLnRlc3RfY29uZmlnLmJfY291bnRlcl9yZWdzID0gYl9jb3VudGVyX2NvbmZpZ190
ZXN0X29hOwo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3Nf
bGVuID0gQVJSQVlfU0laRShiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2EpOwo+ICsJaTkxNS0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVncyA9IGJfY291bnRlcl9jb25maWdfdGVzdF9v
YTsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3NfbGVuID0gQVJS
QVlfU0laRShiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2EpOwo+ICAgCj4gLQlkZXZfcHJpdi0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+IC0J
ZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuZmxleF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUo
ZmxleF9ldV9jb25maWdfdGVzdF9vYSk7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmZs
ZXhfcmVncyA9IGZsZXhfZXVfY29uZmlnX3Rlc3Rfb2E7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3Rf
Y29uZmlnLmZsZXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGZsZXhfZXVfY29uZmlnX3Rlc3Rfb2Ep
Owo+ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMubmFt
ZSA9ICJiYWEzYzdlNC01MmI2LTRiODUtODAxZS00NjVhOTRiNzQ2ZGQiOwo+IC0JZGV2X3ByaXYt
PnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljLmF0dHJzID0gZGV2X3ByaXYtPnBlcmYu
b2EudGVzdF9jb25maWcuYXR0cnM7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2Zz
X21ldHJpYy5uYW1lID0gImJhYTNjN2U0LTUyYjYtNGI4NS04MDFlLTQ2NWE5NGI3NDZkZCI7Cj4g
KwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYy5hdHRycyA9IGk5MTUtPnBl
cmYub2EudGVzdF9jb25maWcuYXR0cnM7Cj4gICAKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3Rf
Y29uZmlnLmF0dHJzWzBdID0gJmRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21l
dHJpY19pZC5hdHRyOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5hdHRyc1swXSA9ICZp
OTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyOwo+ICAgCj4gLQlk
ZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0ci5uYW1lID0g
ImlkIjsKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5h
dHRyLm1vZGUgPSAwNDQ0Owo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNf
bWV0cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3Rf
Y29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm5hbWUgPSAiaWQiOwo+ICsJaTkxNS0+cGVyZi5v
YS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0ci5tb2RlID0gMDQ0NDsKPiArCWk5MTUt
PnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2Ff
aWQ7Cj4gICB9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2Ffa2Js
Z3QyLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2tibGd0Mi5oCj4gaW5kZXggYTU1
Mzk4YTkwNGRlLi41MzY1NWRlN2I5NzYgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9vYV9rYmxndDIuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2Ff
a2JsZ3QyLmgKPiBAQCAtMTAsNiArMTAsNiBAQAo+ICAgI2lmbmRlZiBfX0k5MTVfT0FfS0JMR1Qy
X0hfXwo+ICAgI2RlZmluZSBfX0k5MTVfT0FfS0JMR1QyX0hfXwo+ICAgCj4gLWV4dGVybiB2b2lk
IGk5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX2tibGd0MihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpOwo+ICtleHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19r
YmxndDIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgCj4gICAjZW5kaWYKPiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9rYmxndDMuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfb2Ffa2JsZ3QzLmMKPiBpbmRleCA2ZmZhNTUzYzM4OGUuLmVk
MzlmOGRkOWFmMiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2ti
bGd0My5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9rYmxndDMuYwo+IEBA
IC02MywyOCArNjMsMjggQEAgc2hvd190ZXN0X29hX2lkKHN0cnVjdCBkZXZpY2UgKmtkZXYsIHN0
cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCj4gICB9Cj4gICAKPiAgIHZv
aWQKPiAtaTkxNV9wZXJmX2xvYWRfdGVzdF9jb25maWdfa2JsZ3QzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiAraTkxNV9wZXJmX2xvYWRfdGVzdF9jb25maWdfa2JsZ3QzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RybGNweShkZXZfcHJpdi0+
cGVyZi5vYS50ZXN0X2NvbmZpZy51dWlkLAo+ICsJc3RybGNweShpOTE1LT5wZXJmLm9hLnRlc3Rf
Y29uZmlnLnV1aWQsCj4gICAJCSJmMTc5MmYzMi02ZGIyLTRiNTAtYjRiMi01NTcxMjhmMTY4OGQi
LAo+IC0JCXNpemVvZihkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy51dWlkKSk7Cj4gLQlk
ZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5pZCA9IDE7Cj4gKwkJc2l6ZW9mKGk5MTUtPnBl
cmYub2EudGVzdF9jb25maWcudXVpZCkpOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5p
ZCA9IDE7Cj4gICAKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11eF9yZWdzID0g
bXV4X2NvbmZpZ190ZXN0X29hOwo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcubXV4
X3JlZ3NfbGVuID0gQVJSQVlfU0laRShtdXhfY29uZmlnX3Rlc3Rfb2EpOwo+ICsJaTkxNS0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVncyA9IG11eF9jb25maWdfdGVzdF9vYTsKPiArCWk5MTUt
PnBlcmYub2EudGVzdF9jb25maWcubXV4X3JlZ3NfbGVuID0gQVJSQVlfU0laRShtdXhfY29uZmln
X3Rlc3Rfb2EpOwo+ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50
ZXJfcmVncyA9IGJfY291bnRlcl9jb25maWdfdGVzdF9vYTsKPiAtCWRldl9wcml2LT5wZXJmLm9h
LnRlc3RfY29uZmlnLmJfY291bnRlcl9yZWdzX2xlbiA9IEFSUkFZX1NJWkUoYl9jb3VudGVyX2Nv
bmZpZ190ZXN0X29hKTsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3Jl
Z3MgPSBiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2E7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29u
ZmlnLmJfY291bnRlcl9yZWdzX2xlbiA9IEFSUkFZX1NJWkUoYl9jb3VudGVyX2NvbmZpZ190ZXN0
X29hKTsKPiAgIAo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuZmxleF9yZWdzID0g
ZmxleF9ldV9jb25maWdfdGVzdF9vYTsKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmln
LmZsZXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGZsZXhfZXVfY29uZmlnX3Rlc3Rfb2EpOwo+ICsJ
aTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0
X29hOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3NfbGVuID0gQVJSQVlf
U0laRShmbGV4X2V1X2NvbmZpZ190ZXN0X29hKTsKPiAgIAo+IC0JZGV2X3ByaXYtPnBlcmYub2Eu
dGVzdF9jb25maWcuc3lzZnNfbWV0cmljLm5hbWUgPSAiZjE3OTJmMzItNmRiMi00YjUwLWI0YjIt
NTU3MTI4ZjE2ODhkIjsKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21l
dHJpYy5hdHRycyA9IGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJzOwo+ICsJaTkx
NS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMubmFtZSA9ICJmMTc5MmYzMi02ZGIy
LTRiNTAtYjRiMi01NTcxMjhmMTY4OGQiOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5z
eXNmc19tZXRyaWMuYXR0cnMgPSBpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJzOwo+ICAg
Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5hdHRyc1swXSA9ICZkZXZfcHJpdi0+
cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0cjsKPiArCWk5MTUtPnBlcmYu
b2EudGVzdF9jb25maWcuYXR0cnNbMF0gPSAmaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNm
c19tZXRyaWNfaWQuYXR0cjsKPiAgIAo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcu
c3lzZnNfbWV0cmljX2lkLmF0dHIubmFtZSA9ICJpZCI7Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50
ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0ci5tb2RlID0gMDQ0NDsKPiAtCWRldl9wcml2
LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5zaG93ID0gc2hvd190ZXN0X29h
X2lkOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0ci5u
YW1lID0gImlkIjsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lk
LmF0dHIubW9kZSA9IDA0NDQ7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21l
dHJpY19pZC5zaG93ID0gc2hvd190ZXN0X29hX2lkOwo+ICAgfQo+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2tibGd0My5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9vYV9rYmxndDMuaAo+IGluZGV4IDNkZGQzNDgzYjdjYy4uNjBlYmUyYjIwYWRhIDEwMDY0
NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2Ffa2JsZ3QzLmgKPiArKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2tibGd0My5oCj4gQEAgLTEwLDYgKzEwLDYgQEAK
PiAgICNpZm5kZWYgX19JOTE1X09BX0tCTEdUM19IX18KPiAgICNkZWZpbmUgX19JOTE1X09BX0tC
TEdUM19IX18KPiAgIAo+IC1leHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19r
YmxndDMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiArZXh0ZXJuIHZvaWQg
aTkxNV9wZXJmX2xvYWRfdGVzdF9jb25maWdfa2JsZ3QzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KTsKPiAgIAo+ICAgI2VuZGlmCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfb2Ffc2tsZ3QyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0
Mi5jCj4gaW5kZXggN2NlNmVlODUxZDQzLi42MGI0ZGJjZDRjNTkgMTAwNjQ0Cj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9za2xndDIuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfb2Ffc2tsZ3QyLmMKPiBAQCAtNjIsMjggKzYyLDI4IEBAIHNob3dfdGVzdF9v
YV9pZChzdHJ1Y3QgZGV2aWNlICprZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwg
Y2hhciAqYnVmKQo+ICAgfQo+ICAgCj4gICB2b2lkCj4gLWk5MTVfcGVyZl9sb2FkX3Rlc3RfY29u
ZmlnX3NrbGd0MihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK2k5MTVfcGVy
Zl9sb2FkX3Rlc3RfY29uZmlnX3NrbGd0MihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiAgIHsKPiAtCXN0cmxjcHkoZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcudXVpZCwKPiAr
CXN0cmxjcHkoaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy51dWlkLAo+ICAgCQkiMTY1MTk0OWYt
MGFjMC00Y2IxLWEwNmYtZGFmZDc0YTQwN2QxIiwKPiAtCQlzaXplb2YoZGV2X3ByaXYtPnBlcmYu
b2EudGVzdF9jb25maWcudXVpZCkpOwo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcu
aWQgPSAxOwo+ICsJCXNpemVvZihpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQpKTsKPiAr
CWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuaWQgPSAxOwo+ICAgCj4gLQlkZXZfcHJpdi0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVncyA9IG11eF9jb25maWdfdGVzdF9vYTsKPiAtCWRldl9w
cml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11eF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUobXV4X2Nv
bmZpZ190ZXN0X29hKTsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcubXV4X3JlZ3MgPSBt
dXhfY29uZmlnX3Rlc3Rfb2E7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11eF9yZWdz
X2xlbiA9IEFSUkFZX1NJWkUobXV4X2NvbmZpZ190ZXN0X29hKTsKPiAgIAo+IC0JZGV2X3ByaXYt
PnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3MgPSBiX2NvdW50ZXJfY29uZmlnX3Rl
c3Rfb2E7Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVnc19s
ZW4gPSBBUlJBWV9TSVpFKGJfY291bnRlcl9jb25maWdfdGVzdF9vYSk7Cj4gKwlpOTE1LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLmJfY291bnRlcl9yZWdzID0gYl9jb3VudGVyX2NvbmZpZ190ZXN0X29h
Owo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVnc19sZW4gPSBBUlJB
WV9TSVpFKGJfY291bnRlcl9jb25maWdfdGVzdF9vYSk7Cj4gICAKPiAtCWRldl9wcml2LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLmZsZXhfcmVncyA9IGZsZXhfZXVfY29uZmlnX3Rlc3Rfb2E7Cj4gLQlk
ZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3NfbGVuID0gQVJSQVlfU0laRShm
bGV4X2V1X2NvbmZpZ190ZXN0X29hKTsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuZmxl
eF9yZWdzID0gZmxleF9ldV9jb25maWdfdGVzdF9vYTsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9j
b25maWcuZmxleF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUoZmxleF9ldV9jb25maWdfdGVzdF9vYSk7
Cj4gICAKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYy5uYW1l
ID0gIjE2NTE5NDlmLTBhYzAtNGNiMS1hMDZmLWRhZmQ3NGE0MDdkMSI7Cj4gLQlkZXZfcHJpdi0+
cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMuYXR0cnMgPSBkZXZfcHJpdi0+cGVyZi5v
YS50ZXN0X2NvbmZpZy5hdHRyczsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNf
bWV0cmljLm5hbWUgPSAiMTY1MTk0OWYtMGFjMC00Y2IxLWEwNmYtZGFmZDc0YTQwN2QxIjsKPiAr
CWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljLmF0dHJzID0gaTkxNS0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5hdHRyczsKPiAgIAo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9j
b25maWcuYXR0cnNbMF0gPSAmZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0
cmljX2lkLmF0dHI7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmk5
MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHI7Cj4gICAKPiAtCWRl
dl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm5hbWUgPSAi
aWQiOwo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0
dHIubW9kZSA9IDA0NDQ7Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19t
ZXRyaWNfaWQuc2hvdyA9IHNob3dfdGVzdF9vYV9pZDsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9j
b25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubmFtZSA9ICJpZCI7Cj4gKwlpOTE1LT5wZXJmLm9h
LnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm1vZGUgPSAwNDQ0Owo+ICsJaTkxNS0+
cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuc2hvdyA9IHNob3dfdGVzdF9vYV9p
ZDsKPiAgIH0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9za2xn
dDIuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2Ffc2tsZ3QyLmgKPiBpbmRleCBiZTYy
NTYwMzcyMzkuLmVlNmY3NDc1MDJlYSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X29hX3NrbGd0Mi5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9z
a2xndDIuaAo+IEBAIC0xMCw2ICsxMCw2IEBACj4gICAjaWZuZGVmIF9fSTkxNV9PQV9TS0xHVDJf
SF9fCj4gICAjZGVmaW5lIF9fSTkxNV9PQV9TS0xHVDJfSF9fCj4gICAKPiAtZXh0ZXJuIHZvaWQg
aTkxNV9wZXJmX2xvYWRfdGVzdF9jb25maWdfc2tsZ3QyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdik7Cj4gK2V4dGVybiB2b2lkIGk5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX3Nr
bGd0MihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICAKPiAgICNlbmRpZgo+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0My5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9za2xndDMuYwo+IGluZGV4IDA4NmNhMjYzMWUxYy4uOGMy
M2NmNzEyYTdhIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2Ffc2ts
Z3QzLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0My5jCj4gQEAg
LTYzLDI4ICs2MywyOCBAQCBzaG93X3Rlc3Rfb2FfaWQoc3RydWN0IGRldmljZSAqa2Rldiwgc3Ry
dWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKPiAgIH0KPiAgIAo+ICAgdm9p
ZAo+IC1pOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19za2xndDMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ICtpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19za2xndDMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJsY3B5KGRldl9wcml2LT5w
ZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQsCj4gKwlzdHJsY3B5KGk5MTUtPnBlcmYub2EudGVzdF9j
b25maWcudXVpZCwKPiAgIAkJIjJiOTg1ODAzLWQzYzktNDYyOS04YTRmLTYzNGJmZWNiYTBlOCIs
Cj4gLQkJc2l6ZW9mKGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQpKTsKPiAtCWRl
dl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmlkID0gMTsKPiArCQlzaXplb2YoaTkxNS0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy51dWlkKSk7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmlk
ID0gMTsKPiAgIAo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcubXV4X3JlZ3MgPSBt
dXhfY29uZmlnX3Rlc3Rfb2E7Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhf
cmVnc19sZW4gPSBBUlJBWV9TSVpFKG11eF9jb25maWdfdGVzdF9vYSk7Cj4gKwlpOTE1LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLm11eF9yZWdzID0gbXV4X2NvbmZpZ190ZXN0X29hOwo+ICsJaTkxNS0+
cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKG11eF9jb25maWdf
dGVzdF9vYSk7Cj4gICAKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmJfY291bnRl
cl9yZWdzID0gYl9jb3VudGVyX2NvbmZpZ190ZXN0X29hOwo+IC0JZGV2X3ByaXYtPnBlcmYub2Eu
dGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3NfbGVuID0gQVJSQVlfU0laRShiX2NvdW50ZXJfY29u
ZmlnX3Rlc3Rfb2EpOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVn
cyA9IGJfY291bnRlcl9jb25maWdfdGVzdF9vYTsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25m
aWcuYl9jb3VudGVyX3JlZ3NfbGVuID0gQVJSQVlfU0laRShiX2NvdW50ZXJfY29uZmlnX3Rlc3Rf
b2EpOwo+ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBm
bGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcu
ZmxleF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUoZmxleF9ldV9jb25maWdfdGVzdF9vYSk7Cj4gKwlp
OTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmZsZXhfcmVncyA9IGZsZXhfZXVfY29uZmlnX3Rlc3Rf
b2E7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmZsZXhfcmVnc19sZW4gPSBBUlJBWV9T
SVpFKGZsZXhfZXVfY29uZmlnX3Rlc3Rfb2EpOwo+ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50
ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMubmFtZSA9ICIyYjk4NTgwMy1kM2M5LTQ2MjktOGE0Zi02
MzRiZmVjYmEwZTgiOwo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0
cmljLmF0dHJzID0gZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuYXR0cnM7Cj4gKwlpOTE1
LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYy5uYW1lID0gIjJiOTg1ODAzLWQzYzkt
NDYyOS04YTRmLTYzNGJmZWNiYTBlOCI7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5
c2ZzX21ldHJpYy5hdHRycyA9IGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYXR0cnM7Cj4gICAK
PiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmRldl9wcml2LT5w
ZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyOwo+ICsJaTkxNS0+cGVyZi5v
YS50ZXN0X2NvbmZpZy5hdHRyc1swXSA9ICZpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2Zz
X21ldHJpY19pZC5hdHRyOwo+ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5z
eXNmc19tZXRyaWNfaWQuYXR0ci5uYW1lID0gImlkIjsKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRl
c3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm1vZGUgPSAwNDQ0Owo+IC0JZGV2X3ByaXYt
PnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2Ff
aWQ7Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm5h
bWUgPSAiaWQiOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQu
YXR0ci5tb2RlID0gMDQ0NDsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0
cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gICB9Cj4gZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfb2Ffc2tsZ3QzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X29hX3NrbGd0My5oCj4gaW5kZXggNjUwYmViMDY4ZTU2Li4zNWNjYjQxMjVkNzEgMTAwNjQ0
Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9za2xndDMuaAo+ICsrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2Ffc2tsZ3QzLmgKPiBAQCAtMTAsNiArMTAsNiBAQAo+
ICAgI2lmbmRlZiBfX0k5MTVfT0FfU0tMR1QzX0hfXwo+ICAgI2RlZmluZSBfX0k5MTVfT0FfU0tM
R1QzX0hfXwo+ICAgCj4gLWV4dGVybiB2b2lkIGk5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX3Nr
bGd0MyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ICtleHRlcm4gdm9pZCBp
OTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19za2xndDMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpOwo+ICAgCj4gICAjZW5kaWYKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9vYV9za2xndDQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2Ffc2tsZ3Q0
LmMKPiBpbmRleCBiMjkxYTZlYjhhODcuLmI4NDZkYTYxOThmOCAxMDA2NDQKPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0NC5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9vYV9za2xndDQuYwo+IEBAIC02MywyOCArNjMsMjggQEAgc2hvd190ZXN0X29h
X2lkKHN0cnVjdCBkZXZpY2UgKmtkZXYsIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBj
aGFyICpidWYpCj4gICB9Cj4gICAKPiAgIHZvaWQKPiAtaTkxNV9wZXJmX2xvYWRfdGVzdF9jb25m
aWdfc2tsZ3Q0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAraTkxNV9wZXJm
X2xvYWRfdGVzdF9jb25maWdfc2tsZ3Q0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ICAgewo+IC0Jc3RybGNweShkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy51dWlkLAo+ICsJ
c3RybGNweShpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQsCj4gICAJCSI4ODJmYTQzMy0x
ZjRhLTRhNjctYTk2Mi1jNzQxODg4ZmU1ZjUiLAo+IC0JCXNpemVvZihkZXZfcHJpdi0+cGVyZi5v
YS50ZXN0X2NvbmZpZy51dWlkKSk7Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5p
ZCA9IDE7Cj4gKwkJc2l6ZW9mKGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcudXVpZCkpOwo+ICsJ
aTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5pZCA9IDE7Cj4gICAKPiAtCWRldl9wcml2LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLm11eF9yZWdzID0gbXV4X2NvbmZpZ190ZXN0X29hOwo+IC0JZGV2X3By
aXYtPnBlcmYub2EudGVzdF9jb25maWcubXV4X3JlZ3NfbGVuID0gQVJSQVlfU0laRShtdXhfY29u
ZmlnX3Rlc3Rfb2EpOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVncyA9IG11
eF9jb25maWdfdGVzdF9vYTsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcubXV4X3JlZ3Nf
bGVuID0gQVJSQVlfU0laRShtdXhfY29uZmlnX3Rlc3Rfb2EpOwo+ICAgCj4gLQlkZXZfcHJpdi0+
cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVncyA9IGJfY291bnRlcl9jb25maWdfdGVz
dF9vYTsKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmJfY291bnRlcl9yZWdzX2xl
biA9IEFSUkFZX1NJWkUoYl9jb3VudGVyX2NvbmZpZ190ZXN0X29hKTsKPiArCWk5MTUtPnBlcmYu
b2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3MgPSBiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2E7
Cj4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmJfY291bnRlcl9yZWdzX2xlbiA9IEFSUkFZ
X1NJWkUoYl9jb3VudGVyX2NvbmZpZ190ZXN0X29hKTsKPiAgIAo+IC0JZGV2X3ByaXYtPnBlcmYu
b2EudGVzdF9jb25maWcuZmxleF9yZWdzID0gZmxleF9ldV9jb25maWdfdGVzdF9vYTsKPiAtCWRl
dl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmZsZXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGZs
ZXhfZXVfY29uZmlnX3Rlc3Rfb2EpOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4
X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2Nv
bmZpZy5mbGV4X3JlZ3NfbGVuID0gQVJSQVlfU0laRShmbGV4X2V1X2NvbmZpZ190ZXN0X29hKTsK
PiAgIAo+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljLm5hbWUg
PSAiODgyZmE0MzMtMWY0YS00YTY3LWE5NjItYzc0MTg4OGZlNWY1IjsKPiAtCWRldl9wcml2LT5w
ZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYy5hdHRycyA9IGRldl9wcml2LT5wZXJmLm9h
LnRlc3RfY29uZmlnLmF0dHJzOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19t
ZXRyaWMubmFtZSA9ICI4ODJmYTQzMy0xZjRhLTRhNjctYTk2Mi1jNzQxODg4ZmU1ZjUiOwo+ICsJ
aTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMuYXR0cnMgPSBpOTE1LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLmF0dHJzOwo+ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2Nv
bmZpZy5hdHRyc1swXSA9ICZkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRy
aWNfaWQuYXR0cjsKPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYXR0cnNbMF0gPSAmaTkx
NS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0cjsKPiAgIAo+IC0JZGV2
X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubmFtZSA9ICJp
ZCI7Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0
ci5tb2RlID0gMDQ0NDsKPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21l
dHJpY19pZC5zaG93ID0gc2hvd190ZXN0X29hX2lkOwo+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2Nv
bmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0ci5uYW1lID0gImlkIjsKPiArCWk5MTUtPnBlcmYub2Eu
dGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubW9kZSA9IDA0NDQ7Cj4gKwlpOTE1LT5w
ZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5zaG93ID0gc2hvd190ZXN0X29hX2lk
Owo+ICAgfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0
NC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9za2xndDQuaAo+IGluZGV4IDhkY2Y4
NDlkMTMxZS4uZjNmNmQ3YmYyOGUwIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfb2Ffc2tsZ3Q0LmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3Nr
bGd0NC5oCj4gQEAgLTEwLDYgKzEwLDYgQEAKPiAgICNpZm5kZWYgX19JOTE1X09BX1NLTEdUNF9I
X18KPiAgICNkZWZpbmUgX19JOTE1X09BX1NLTEdUNF9IX18KPiAgIAo+IC1leHRlcm4gdm9pZCBp
OTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19za2xndDQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KTsKPiArZXh0ZXJuIHZvaWQgaTkxNV9wZXJmX2xvYWRfdGVzdF9jb25maWdfc2ts
Z3Q0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAgIAo+ICAgI2VuZGlmCj4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9wZXJmLmMKPiBpbmRleCBkOTJkZGZhZGEyNjIuLmUwZWY3N2VjNGRhMyAx
MDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYwo+ICsrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5jCj4gQEAgLTM2Niw3ICszNjYsNyBAQCBzdHJ1
Y3QgcGVyZl9vcGVuX3Byb3BlcnRpZXMgewo+ICAgCWludCBvYV9wZXJpb2RfZXhwb25lbnQ7Cj4g
ICB9Owo+ICAgCj4gLXN0YXRpYyB2b2lkIGZyZWVfb2FfY29uZmlnKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgZnJlZV9vYV9jb25maWcoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICBzdHJ1Y3QgaTkxNV9vYV9jb25maWcgKm9h
X2NvbmZpZykKPiAgIHsKPiAgIAlpZiAoIVBUUl9FUlIob2FfY29uZmlnLT5mbGV4X3JlZ3MpKQo+
IEBAIC0zNzgsNDggKzM3OCw0OCBAQCBzdGF0aWMgdm9pZCBmcmVlX29hX2NvbmZpZyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJa2ZyZWUob2FfY29uZmlnKTsKPiAgIH0K
PiAgIAo+IC1zdGF0aWMgdm9pZCBwdXRfb2FfY29uZmlnKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgcHV0X29hX2NvbmZpZyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgc3RydWN0IGk5MTVfb2FfY29uZmlnICpvYV9jb25maWcp
Cj4gICB7Cj4gICAJaWYgKCFhdG9taWNfZGVjX2FuZF90ZXN0KCZvYV9jb25maWctPnJlZl9jb3Vu
dCkpCj4gICAJCXJldHVybjsKPiAgIAo+IC0JZnJlZV9vYV9jb25maWcoZGV2X3ByaXYsIG9hX2Nv
bmZpZyk7Cj4gKwlmcmVlX29hX2NvbmZpZyhpOTE1LCBvYV9jb25maWcpOwo+ICAgfQo+ICAgCj4g
LXN0YXRpYyBpbnQgZ2V0X29hX2NvbmZpZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gK3N0YXRpYyBpbnQgZ2V0X29hX2NvbmZpZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiAgIAkJCSBpbnQgbWV0cmljc19zZXQsCj4gICAJCQkgc3RydWN0IGk5MTVfb2FfY29u
ZmlnICoqb3V0X2NvbmZpZykKPiAgIHsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gICAJaWYgKG1ldHJp
Y3Nfc2V0ID09IDEpIHsKPiAtCQkqb3V0X2NvbmZpZyA9ICZkZXZfcHJpdi0+cGVyZi5vYS50ZXN0
X2NvbmZpZzsKPiAtCQlhdG9taWNfaW5jKCZkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5y
ZWZfY291bnQpOwo+ICsJCSpvdXRfY29uZmlnID0gJmk5MTUtPnBlcmYub2EudGVzdF9jb25maWc7
Cj4gKwkJYXRvbWljX2luYygmaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5yZWZfY291bnQpOwo+
ICAgCQlyZXR1cm4gMDsKPiAgIAl9Cj4gICAKPiAtCXJldCA9IG11dGV4X2xvY2tfaW50ZXJydXB0
aWJsZSgmZGV2X3ByaXYtPnBlcmYubWV0cmljc19sb2NrKTsKPiArCXJldCA9IG11dGV4X2xvY2tf
aW50ZXJydXB0aWJsZSgmaTkxNS0+cGVyZi5tZXRyaWNzX2xvY2spOwo+ICAgCWlmIChyZXQpCj4g
ICAJCXJldHVybiByZXQ7Cj4gICAKPiAtCSpvdXRfY29uZmlnID0gaWRyX2ZpbmQoJmRldl9wcml2
LT5wZXJmLm1ldHJpY3NfaWRyLCBtZXRyaWNzX3NldCk7Cj4gKwkqb3V0X2NvbmZpZyA9IGlkcl9m
aW5kKCZpOTE1LT5wZXJmLm1ldHJpY3NfaWRyLCBtZXRyaWNzX3NldCk7Cj4gICAJaWYgKCEqb3V0
X2NvbmZpZykKPiAgIAkJcmV0ID0gLUVJTlZBTDsKPiAgIAllbHNlCj4gICAJCWF0b21pY19pbmMo
Jigqb3V0X2NvbmZpZyktPnJlZl9jb3VudCk7Cj4gICAKPiAtCW11dGV4X3VubG9jaygmZGV2X3By
aXYtPnBlcmYubWV0cmljc19sb2NrKTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+cGVyZi5tZXRy
aWNzX2xvY2spOwo+ICAgCj4gICAJcmV0dXJuIHJldDsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdTMy
IGdlbjhfb2FfaHdfdGFpbF9yZWFkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiArc3RhdGljIHUzMiBnZW44X29hX2h3X3RhaWxfcmVhZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKPiAgIHsKPiAgIAlyZXR1cm4gSTkxNV9SRUFEKEdFTjhfT0FUQUlMUFRSKSAmIEdF
TjhfT0FUQUlMUFRSX01BU0s7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHUzMiBnZW43X29hX2h3X3Rh
aWxfcmVhZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB1MzIg
Z2VuN19vYV9od190YWlsX3JlYWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7
Cj4gICAJdTMyIG9hc3RhdHVzMSA9IEk5MTVfUkVBRChHRU43X09BU1RBVFVTMSk7Cj4gICAKPiBA
QCAtNDI4LDcgKzQyOCw3IEBAIHN0YXRpYyB1MzIgZ2VuN19vYV9od190YWlsX3JlYWQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCj4gICAvKioKPiAgICAqIG9hX2J1ZmZl
cl9jaGVja191bmxvY2tlZCAtIGNoZWNrIGZvciBkYXRhIGFuZCB1cGRhdGUgdGFpbCBwdHIgc3Rh
dGUKPiAtICogQGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ICsgKiBAaTkxNTogaTkx
NSBkZXZpY2UgaW5zdGFuY2UKPiAgICAqCj4gICAgKiBUaGlzIGlzIGVpdGhlciBjYWxsZWQgdmlh
IGZvcHMgKGZvciBibG9ja2luZyByZWFkcyBpbiB1c2VyIGN0eCkgb3IgdGhlIHBvbGwKPiAgICAq
IGNoZWNrIGhydGltZXIgKGF0b21pYyBjdHgpIHRvIGNoZWNrIHRoZSBPQSBidWZmZXIgdGFpbCBw
b2ludGVyIGFuZCBjaGVjawo+IEBAIC00NTAsOSArNDUwLDkgQEAgc3RhdGljIHUzMiBnZW43X29h
X2h3X3RhaWxfcmVhZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAgKgo+
ICAgICogUmV0dXJuczogJXRydWUgaWYgdGhlIE9BIGJ1ZmZlciBjb250YWlucyBkYXRhLCBlbHNl
ICVmYWxzZQo+ICAgICovCj4gLXN0YXRpYyBib29sIG9hX2J1ZmZlcl9jaGVja191bmxvY2tlZChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyBib29sIG9hX2J1ZmZl
cl9jaGVja191bmxvY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAt
CWludCByZXBvcnRfc2l6ZSA9IGRldl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZlci5mb3JtYXRfc2l6
ZTsKPiArCWludCByZXBvcnRfc2l6ZSA9IGk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLmZvcm1hdF9z
aXplOwo+ICAgCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4gICAJdW5zaWduZWQgaW50IGFnZWRfaWR4
Owo+ICAgCXUzMiBoZWFkLCBod190YWlsLCBhZ2VkX3RhaWwsIGFnaW5nX3RhaWw7Cj4gQEAgLTQ2
MiwxOSArNDYyLDE5IEBAIHN0YXRpYyBib29sIG9hX2J1ZmZlcl9jaGVja191bmxvY2tlZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICogY291bGQgcmVzdWx0IGluIGFu
IE9BIGJ1ZmZlciByZXNldCB3aGljaCBtaWdodCByZXNldCB0aGUgaGVhZCwKPiAgIAkgKiB0YWls
c1tdIGFuZCBhZ2VkX3RhaWwgc3RhdGUuCj4gICAJICovCj4gLQlzcGluX2xvY2tfaXJxc2F2ZSgm
ZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLnB0cl9sb2NrLCBmbGFncyk7Cj4gKwlzcGluX2xv
Y2tfaXJxc2F2ZSgmaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIucHRyX2xvY2ssIGZsYWdzKTsKPiAg
IAo+ICAgCS8qIE5COiBUaGUgaGVhZCB3ZSBvYnNlcnZlIGhlcmUgbWlnaHQgZWZmZWN0aXZlbHkg
YmUgYSBsaXR0bGUgb3V0IG9mCj4gICAJICogZGF0ZSAoYmV0d2VlbiBoZWFkIGFuZCB0YWlsc1th
Z2VkX2lkeF0ub2Zmc2V0IGlmIHRoZXJlIGlzIGN1cnJlbnRseQo+ICAgCSAqIGEgcmVhZCgpIGlu
IHByb2dyZXNzLgo+ICAgCSAqLwo+IC0JaGVhZCA9IGRldl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZl
ci5oZWFkOwo+ICsJaGVhZCA9IGk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLmhlYWQ7Cj4gICAKPiAt
CWFnZWRfaWR4ID0gZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLmFnZWRfdGFpbF9pZHg7Cj4g
LQlhZ2VkX3RhaWwgPSBkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIudGFpbHNbYWdlZF9pZHhd
Lm9mZnNldDsKPiAtCWFnaW5nX3RhaWwgPSBkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIudGFp
bHNbIWFnZWRfaWR4XS5vZmZzZXQ7Cj4gKwlhZ2VkX2lkeCA9IGk5MTUtPnBlcmYub2Eub2FfYnVm
ZmVyLmFnZWRfdGFpbF9pZHg7Cj4gKwlhZ2VkX3RhaWwgPSBpOTE1LT5wZXJmLm9hLm9hX2J1ZmZl
ci50YWlsc1thZ2VkX2lkeF0ub2Zmc2V0Owo+ICsJYWdpbmdfdGFpbCA9IGk5MTUtPnBlcmYub2Eu
b2FfYnVmZmVyLnRhaWxzWyFhZ2VkX2lkeF0ub2Zmc2V0Owo+ICAgCj4gLQlod190YWlsID0gZGV2
X3ByaXYtPnBlcmYub2Eub3BzLm9hX2h3X3RhaWxfcmVhZChkZXZfcHJpdik7Cj4gKwlod190YWls
ID0gaTkxNS0+cGVyZi5vYS5vcHMub2FfaHdfdGFpbF9yZWFkKGk5MTUpOwo+ICAgCj4gICAJLyog
VGhlIHRhaWwgcG9pbnRlciBpbmNyZWFzZXMgaW4gNjQgYnl0ZSBpbmNyZW1lbnRzLAo+ICAgCSAq
IG5vdCBpbiByZXBvcnRfc2l6ZSBzdGVwcy4uLgo+IEBAIC00OTQsMTYgKzQ5NCwxNiBAQCBzdGF0
aWMgYm9vbCBvYV9idWZmZXJfY2hlY2tfdW5sb2NrZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICAgCSAqIGF2YWlsYWJsZSkgd2l0aG91dCBuZWVkaW5nIHRvIHdhaXQgZm9y
IGEgbGF0ZXIgaHJ0aW1lciBjYWxsYmFjay4KPiAgIAkgKi8KPiAgIAlpZiAoYWdpbmdfdGFpbCAh
PSBJTlZBTElEX1RBSUxfUFRSICYmCj4gLQkgICAgKChub3cgLSBkZXZfcHJpdi0+cGVyZi5vYS5v
YV9idWZmZXIuYWdpbmdfdGltZXN0YW1wKSA+Cj4gKwkgICAgKChub3cgLSBpOTE1LT5wZXJmLm9h
Lm9hX2J1ZmZlci5hZ2luZ190aW1lc3RhbXApID4KPiAgIAkgICAgIE9BX1RBSUxfTUFSR0lOX05T
RUMpKSB7Cj4gICAKPiAgIAkJYWdlZF9pZHggXj0gMTsKPiAtCQlkZXZfcHJpdi0+cGVyZi5vYS5v
YV9idWZmZXIuYWdlZF90YWlsX2lkeCA9IGFnZWRfaWR4Owo+ICsJCWk5MTUtPnBlcmYub2Eub2Ff
YnVmZmVyLmFnZWRfdGFpbF9pZHggPSBhZ2VkX2lkeDsKPiAgIAo+ICAgCQlhZ2VkX3RhaWwgPSBh
Z2luZ190YWlsOwo+ICAgCj4gICAJCS8qIE1hcmsgdGhhdCB3ZSBuZWVkIGEgbmV3IHBvaW50ZXIg
dG8gc3RhcnQgYWdpbmcuLi4gKi8KPiAtCQlkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIudGFp
bHNbIWFnZWRfaWR4XS5vZmZzZXQgPSBJTlZBTElEX1RBSUxfUFRSOwo+ICsJCWk5MTUtPnBlcmYu
b2Eub2FfYnVmZmVyLnRhaWxzWyFhZ2VkX2lkeF0ub2Zmc2V0ID0gSU5WQUxJRF9UQUlMX1BUUjsK
PiAgIAkJYWdpbmdfdGFpbCA9IElOVkFMSURfVEFJTF9QVFI7Cj4gICAJfQo+ICAgCj4gQEAgLTUx
OCw3ICs1MTgsNyBAQCBzdGF0aWMgYm9vbCBvYV9idWZmZXJfY2hlY2tfdW5sb2NrZWQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCWlmIChhZ2luZ190YWlsID09IElOVkFM
SURfVEFJTF9QVFIgJiYKPiAgIAkgICAgKGFnZWRfdGFpbCA9PSBJTlZBTElEX1RBSUxfUFRSIHx8
Cj4gICAJICAgICBPQV9UQUtFTihod190YWlsLCBhZ2VkX3RhaWwpID49IHJlcG9ydF9zaXplKSkg
ewo+IC0JCXN0cnVjdCBpOTE1X3ZtYSAqdm1hID0gZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVy
LnZtYTsKPiArCQlzdHJ1Y3QgaTkxNV92bWEgKnZtYSA9IGk5MTUtPnBlcmYub2Eub2FfYnVmZmVy
LnZtYTsKPiAgIAkJdTMyIGd0dF9vZmZzZXQgPSBpOTE1X2dndHRfb2Zmc2V0KHZtYSk7Cj4gICAK
PiAgIAkJLyogQmUgcGFyYW5vaWQgYW5kIGRvIGEgYm91bmRzIGNoZWNrIG9uIHRoZSBwb2ludGVy
IHJlYWQgYmFjawo+IEBAIC01MjcsMTYgKzUyNywxNiBAQCBzdGF0aWMgYm9vbCBvYV9idWZmZXJf
Y2hlY2tfdW5sb2NrZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQkg
Ki8KPiAgIAkJaWYgKGh3X3RhaWwgPj0gZ3R0X29mZnNldCAmJgo+ICAgCQkgICAgaHdfdGFpbCA8
IChndHRfb2Zmc2V0ICsgT0FfQlVGRkVSX1NJWkUpKSB7Cj4gLQkJCWRldl9wcml2LT5wZXJmLm9h
Lm9hX2J1ZmZlci50YWlsc1shYWdlZF9pZHhdLm9mZnNldCA9Cj4gKwkJCWk5MTUtPnBlcmYub2Eu
b2FfYnVmZmVyLnRhaWxzWyFhZ2VkX2lkeF0ub2Zmc2V0ID0KPiAgIAkJCQlhZ2luZ190YWlsID0g
aHdfdGFpbDsKPiAtCQkJZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLmFnaW5nX3RpbWVzdGFt
cCA9IG5vdzsKPiArCQkJaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIuYWdpbmdfdGltZXN0YW1wID0g
bm93Owo+ICAgCQl9IGVsc2Ugewo+ICAgCQkJRFJNX0VSUk9SKCJJZ25vcmluZyBzcHVyaW91cyBv
dXQgb2YgcmFuZ2UgT0EgYnVmZmVyIHRhaWwgcG9pbnRlciA9ICV1XG4iLAo+ICAgCQkJCSAgaHdf
dGFpbCk7Cj4gICAJCX0KPiAgIAl9Cj4gICAKPiAtCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRl
dl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZlci5wdHJfbG9jaywgZmxhZ3MpOwo+ICsJc3Bpbl91bmxv
Y2tfaXJxcmVzdG9yZSgmaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIucHRyX2xvY2ssIGZsYWdzKTsK
PiAgIAo+ICAgCXJldHVybiBhZ2VkX3RhaWwgPT0gSU5WQUxJRF9UQUlMX1BUUiA/Cj4gICAJCWZh
bHNlIDogT0FfVEFLRU4oYWdlZF90YWlsLCBoZWFkKSA+PSByZXBvcnRfc2l6ZTsKPiBAQCAtNTk5
LDggKzU5OSw4IEBAIHN0YXRpYyBpbnQgYXBwZW5kX29hX3NhbXBsZShzdHJ1Y3QgaTkxNV9wZXJm
X3N0cmVhbSAqc3RyZWFtLAo+ICAgCQkJICAgIHNpemVfdCAqb2Zmc2V0LAo+ICAgCQkJICAgIGNv
bnN0IHU4ICpyZXBvcnQpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSBzdHJlYW0tPmRldl9wcml2Owo+IC0JaW50IHJlcG9ydF9zaXplID0gZGV2X3ByaXYtPnBl
cmYub2Eub2FfYnVmZmVyLmZvcm1hdF9zaXplOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBzdHJlYW0tPmk5MTU7Cj4gKwlpbnQgcmVwb3J0X3NpemUgPSBpOTE1LT5wZXJmLm9h
Lm9hX2J1ZmZlci5mb3JtYXRfc2l6ZTsKPiAgIAlzdHJ1Y3QgZHJtX2k5MTVfcGVyZl9yZWNvcmRf
aGVhZGVyIGhlYWRlcjsKPiAgIAl1MzIgc2FtcGxlX2ZsYWdzID0gc3RyZWFtLT5zYW1wbGVfZmxh
Z3M7Cj4gICAKPiBAQCAtNjUxLDEwICs2NTEsMTAgQEAgc3RhdGljIGludCBnZW44X2FwcGVuZF9v
YV9yZXBvcnRzKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0sCj4gICAJCQkJICBzaXpl
X3QgY291bnQsCj4gICAJCQkJICBzaXplX3QgKm9mZnNldCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHN0cmVhbS0+ZGV2X3ByaXY7Cj4gLQlpbnQgcmVwb3J0
X3NpemUgPSBkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIuZm9ybWF0X3NpemU7Cj4gLQl1OCAq
b2FfYnVmX2Jhc2UgPSBkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIudmFkZHI7Cj4gLQl1MzIg
Z3R0X29mZnNldCA9IGk5MTVfZ2d0dF9vZmZzZXQoZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVy
LnZtYSk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHN0cmVhbS0+aTkxNTsK
PiArCWludCByZXBvcnRfc2l6ZSA9IGk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLmZvcm1hdF9zaXpl
Owo+ICsJdTggKm9hX2J1Zl9iYXNlID0gaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIudmFkZHI7Cj4g
Kwl1MzIgZ3R0X29mZnNldCA9IGk5MTVfZ2d0dF9vZmZzZXQoaTkxNS0+cGVyZi5vYS5vYV9idWZm
ZXIudm1hKTsKPiAgIAl1MzIgbWFzayA9IChPQV9CVUZGRVJfU0laRSAtIDEpOwo+ICAgCXNpemVf
dCBzdGFydF9vZmZzZXQgPSAqb2Zmc2V0Owo+ICAgCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4gQEAg
LTY2NiwxMyArNjY2LDEzIEBAIHN0YXRpYyBpbnQgZ2VuOF9hcHBlbmRfb2FfcmVwb3J0cyhzdHJ1
Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtLAo+ICAgCWlmIChXQVJOX09OKCFzdHJlYW0tPmVu
YWJsZWQpKQo+ICAgCQlyZXR1cm4gLUVJTzsKPiAgIAo+IC0Jc3Bpbl9sb2NrX2lycXNhdmUoJmRl
dl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZlci5wdHJfbG9jaywgZmxhZ3MpOwo+ICsJc3Bpbl9sb2Nr
X2lycXNhdmUoJmk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLnB0cl9sb2NrLCBmbGFncyk7Cj4gICAK
PiAtCWhlYWQgPSBkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIuaGVhZDsKPiAtCWFnZWRfdGFp
bF9pZHggPSBkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIuYWdlZF90YWlsX2lkeDsKPiAtCXRh
aWwgPSBkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIudGFpbHNbYWdlZF90YWlsX2lkeF0ub2Zm
c2V0Owo+ICsJaGVhZCA9IGk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLmhlYWQ7Cj4gKwlhZ2VkX3Rh
aWxfaWR4ID0gaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIuYWdlZF90YWlsX2lkeDsKPiArCXRhaWwg
PSBpOTE1LT5wZXJmLm9hLm9hX2J1ZmZlci50YWlsc1thZ2VkX3RhaWxfaWR4XS5vZmZzZXQ7Cj4g
ICAKPiAtCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRldl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZl
ci5wdHJfbG9jaywgZmxhZ3MpOwo+ICsJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+cGVy
Zi5vYS5vYV9idWZmZXIucHRyX2xvY2ssIGZsYWdzKTsKPiAgIAo+ICAgCS8qCj4gICAJICogQW4g
aW52YWxpZCB0YWlsIHBvaW50ZXIgaGVyZSBtZWFucyB3ZSdyZSBzdGlsbCB3YWl0aW5nIGZvciB0
aGUgcG9sbAo+IEBAIC03MzYsMTIgKzczNiwxMiBAQCBzdGF0aWMgaW50IGdlbjhfYXBwZW5kX29h
X3JlcG9ydHMoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSwKPiAgIAkJcmVhc29uID0g
KChyZXBvcnQzMlswXSA+PiBPQVJFUE9SVF9SRUFTT05fU0hJRlQpICYKPiAgIAkJCSAgT0FSRVBP
UlRfUkVBU09OX01BU0spOwo+ICAgCQlpZiAocmVhc29uID09IDApIHsKPiAtCQkJaWYgKF9fcmF0
ZWxpbWl0KCZkZXZfcHJpdi0+cGVyZi5vYS5zcHVyaW91c19yZXBvcnRfcnMpKQo+ICsJCQlpZiAo
X19yYXRlbGltaXQoJmk5MTUtPnBlcmYub2Euc3B1cmlvdXNfcmVwb3J0X3JzKSkKPiAgIAkJCQlE
Uk1fTk9URSgiU2tpcHBpbmcgc3B1cmlvdXMsIGludmFsaWQgT0EgcmVwb3J0XG4iKTsKPiAgIAkJ
CWNvbnRpbnVlOwo+ICAgCQl9Cj4gICAKPiAtCQljdHhfaWQgPSByZXBvcnQzMlsyXSAmIGRldl9w
cml2LT5wZXJmLm9hLnNwZWNpZmljX2N0eF9pZF9tYXNrOwo+ICsJCWN0eF9pZCA9IHJlcG9ydDMy
WzJdICYgaTkxNS0+cGVyZi5vYS5zcGVjaWZpY19jdHhfaWRfbWFzazsKPiAgIAo+ICAgCQkvKgo+
ICAgCQkgKiBTcXVhc2ggd2hhdGV2ZXIgaXMgaW4gdGhlIENUWF9JRCBmaWVsZCBpZiBpdCdzIG1h
cmtlZCBhcwo+IEBAIC03NTEsNyArNzUxLDcgQEAgc3RhdGljIGludCBnZW44X2FwcGVuZF9vYV9y
ZXBvcnRzKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0sCj4gICAJCSAqIE5vdGU6IHRo
YXQgd2UgZG9uJ3QgY2xlYXIgdGhlIHZhbGlkX2N0eF9iaXQgc28gdXNlcnNwYWNlIGNhbgo+ICAg
CQkgKiB1bmRlcnN0YW5kIHRoYXQgdGhlIElEIGhhcyBiZWVuIHNxdWFzaGVkIGJ5IHRoZSBrZXJu
ZWwuCj4gICAJCSAqLwo+IC0JCWlmICghKHJlcG9ydDMyWzBdICYgZGV2X3ByaXYtPnBlcmYub2Eu
Z2VuOF92YWxpZF9jdHhfYml0KSkKPiArCQlpZiAoIShyZXBvcnQzMlswXSAmIGk5MTUtPnBlcmYu
b2EuZ2VuOF92YWxpZF9jdHhfYml0KSkKPiAgIAkJCWN0eF9pZCA9IHJlcG9ydDMyWzJdID0gSU5W
QUxJRF9DVFhfSUQ7Cj4gICAKPiAgIAkJLyoKPiBAQCAtNzg1LDE4ICs3ODUsMTggQEAgc3RhdGlj
IGludCBnZW44X2FwcGVuZF9vYV9yZXBvcnRzKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJl
YW0sCj4gICAJCSAqIHN3aXRjaGVzIHNpbmNlIGl0J3Mgbm90LXVuY29tbW9uIGZvciBwZXJpb2Rp
YyBzYW1wbGVzIHRvCj4gICAJCSAqIGlkZW50aWZ5IGEgc3dpdGNoIGJlZm9yZSBhbnkgJ2NvbnRl
eHQgc3dpdGNoJyByZXBvcnQuCj4gICAJCSAqLwo+IC0JCWlmICghZGV2X3ByaXYtPnBlcmYub2Eu
ZXhjbHVzaXZlX3N0cmVhbS0+Y3R4IHx8Cj4gLQkJICAgIGRldl9wcml2LT5wZXJmLm9hLnNwZWNp
ZmljX2N0eF9pZCA9PSBjdHhfaWQgfHwKPiAtCQkgICAgKGRldl9wcml2LT5wZXJmLm9hLm9hX2J1
ZmZlci5sYXN0X2N0eF9pZCA9PQo+IC0JCSAgICAgZGV2X3ByaXYtPnBlcmYub2Euc3BlY2lmaWNf
Y3R4X2lkKSB8fAo+ICsJCWlmICghaTkxNS0+cGVyZi5vYS5leGNsdXNpdmVfc3RyZWFtLT5jdHgg
fHwKPiArCQkgICAgaTkxNS0+cGVyZi5vYS5zcGVjaWZpY19jdHhfaWQgPT0gY3R4X2lkIHx8Cj4g
KwkJICAgIChpOTE1LT5wZXJmLm9hLm9hX2J1ZmZlci5sYXN0X2N0eF9pZCA9PQo+ICsJCSAgICAg
aTkxNS0+cGVyZi5vYS5zcGVjaWZpY19jdHhfaWQpIHx8Cj4gICAJCSAgICByZWFzb24gJiBPQVJF
UE9SVF9SRUFTT05fQ1RYX1NXSVRDSCkgewo+ICAgCj4gICAJCQkvKgo+ICAgCQkJICogV2hpbGUg
ZmlsdGVyaW5nIGZvciBhIHNpbmdsZSBjb250ZXh0IHdlIGF2b2lkCj4gICAJCQkgKiBsZWFraW5n
IHRoZSBJRHMgb2Ygb3RoZXIgY29udGV4dHMuCj4gICAJCQkgKi8KPiAtCQkJaWYgKGRldl9wcml2
LT5wZXJmLm9hLmV4Y2x1c2l2ZV9zdHJlYW0tPmN0eCAmJgo+IC0JCQkgICAgZGV2X3ByaXYtPnBl
cmYub2Euc3BlY2lmaWNfY3R4X2lkICE9IGN0eF9pZCkgewo+ICsJCQlpZiAoaTkxNS0+cGVyZi5v
YS5leGNsdXNpdmVfc3RyZWFtLT5jdHggJiYKPiArCQkJICAgIGk5MTUtPnBlcmYub2Euc3BlY2lm
aWNfY3R4X2lkICE9IGN0eF9pZCkgewo+ICAgCQkJCXJlcG9ydDMyWzJdID0gSU5WQUxJRF9DVFhf
SUQ7Cj4gICAJCQl9Cj4gICAKPiBAQCAtODA1LDcgKzgwNSw3IEBAIHN0YXRpYyBpbnQgZ2VuOF9h
cHBlbmRfb2FfcmVwb3J0cyhzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtLAo+ICAgCQkJ
aWYgKHJldCkKPiAgIAkJCQlicmVhazsKPiAgIAo+IC0JCQlkZXZfcHJpdi0+cGVyZi5vYS5vYV9i
dWZmZXIubGFzdF9jdHhfaWQgPSBjdHhfaWQ7Cj4gKwkJCWk5MTUtPnBlcmYub2Eub2FfYnVmZmVy
Lmxhc3RfY3R4X2lkID0gY3R4X2lkOwo+ICAgCQl9Cj4gICAKPiAgIAkJLyoKPiBAQCAtODE5LDcg
KzgxOSw3IEBAIHN0YXRpYyBpbnQgZ2VuOF9hcHBlbmRfb2FfcmVwb3J0cyhzdHJ1Y3QgaTkxNV9w
ZXJmX3N0cmVhbSAqc3RyZWFtLAo+ICAgCX0KPiAgIAo+ICAgCWlmIChzdGFydF9vZmZzZXQgIT0g
Km9mZnNldCkgewo+IC0JCXNwaW5fbG9ja19pcnFzYXZlKCZkZXZfcHJpdi0+cGVyZi5vYS5vYV9i
dWZmZXIucHRyX2xvY2ssIGZsYWdzKTsKPiArCQlzcGluX2xvY2tfaXJxc2F2ZSgmaTkxNS0+cGVy
Zi5vYS5vYV9idWZmZXIucHRyX2xvY2ssIGZsYWdzKTsKPiAgIAo+ICAgCQkvKgo+ICAgCQkgKiBX
ZSByZW1vdmVkIHRoZSBndHRfb2Zmc2V0IGZvciB0aGUgY29weSBsb29wIGFib3ZlLCBpbmRleGlu
Zwo+IEBAIC04MjgsOSArODI4LDkgQEAgc3RhdGljIGludCBnZW44X2FwcGVuZF9vYV9yZXBvcnRz
KHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0sCj4gICAJCWhlYWQgKz0gZ3R0X29mZnNl
dDsKPiAgIAo+ICAgCQlJOTE1X1dSSVRFKEdFTjhfT0FIRUFEUFRSLCBoZWFkICYgR0VOOF9PQUhF
QURQVFJfTUFTSyk7Cj4gLQkJZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLmhlYWQgPSBoZWFk
Owo+ICsJCWk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLmhlYWQgPSBoZWFkOwo+ICAgCj4gLQkJc3Bp
bl91bmxvY2tfaXJxcmVzdG9yZSgmZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLnB0cl9sb2Nr
LCBmbGFncyk7Cj4gKwkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+cGVyZi5vYS5vYV9i
dWZmZXIucHRyX2xvY2ssIGZsYWdzKTsKPiAgIAl9Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+IEBA
IC04NjEsMTEgKzg2MSwxMSBAQCBzdGF0aWMgaW50IGdlbjhfb2FfcmVhZChzdHJ1Y3QgaTkxNV9w
ZXJmX3N0cmVhbSAqc3RyZWFtLAo+ICAgCQkJc2l6ZV90IGNvdW50LAo+ICAgCQkJc2l6ZV90ICpv
ZmZzZXQpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBzdHJl
YW0tPmRldl9wcml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBzdHJlYW0t
Pmk5MTU7Cj4gICAJdTMyIG9hc3RhdHVzOwo+ICAgCWludCByZXQ7Cj4gICAKPiAtCWlmIChXQVJO
X09OKCFkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIudmFkZHIpKQo+ICsJaWYgKFdBUk5fT04o
IWk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLnZhZGRyKSkKPiAgIAkJcmV0dXJuIC1FSU87Cj4gICAK
PiAgIAlvYXN0YXR1cyA9IEk5MTVfUkVBRChHRU44X09BU1RBVFVTKTsKPiBAQCAtODkxLDEwICs4
OTEsMTAgQEAgc3RhdGljIGludCBnZW44X29hX3JlYWQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0g
KnN0cmVhbSwKPiAgIAkJCXJldHVybiByZXQ7Cj4gICAKPiAgIAkJRFJNX0RFQlVHKCJPQSBidWZm
ZXIgb3ZlcmZsb3cgKGV4cG9uZW50ID0gJWQpOiBmb3JjZSByZXN0YXJ0XG4iLAo+IC0JCQkgIGRl
dl9wcml2LT5wZXJmLm9hLnBlcmlvZF9leHBvbmVudCk7Cj4gKwkJCSAgaTkxNS0+cGVyZi5vYS5w
ZXJpb2RfZXhwb25lbnQpOwo+ICAgCj4gLQkJZGV2X3ByaXYtPnBlcmYub2Eub3BzLm9hX2Rpc2Fi
bGUoc3RyZWFtKTsKPiAtCQlkZXZfcHJpdi0+cGVyZi5vYS5vcHMub2FfZW5hYmxlKHN0cmVhbSk7
Cj4gKwkJaTkxNS0+cGVyZi5vYS5vcHMub2FfZGlzYWJsZShzdHJlYW0pOwo+ICsJCWk5MTUtPnBl
cmYub2Eub3BzLm9hX2VuYWJsZShzdHJlYW0pOwo+ICAgCj4gICAJCS8qCj4gICAJCSAqIE5vdGU6
IC5vYV9lbmFibGUoKSBpcyBleHBlY3RlZCB0byByZS1pbml0IHRoZSBvYWJ1ZmZlciBhbmQKPiBA
QCAtOTQwLDEwICs5NDAsMTAgQEAgc3RhdGljIGludCBnZW43X2FwcGVuZF9vYV9yZXBvcnRzKHN0
cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0sCj4gICAJCQkJICBzaXplX3QgY291bnQsCj4g
ICAJCQkJICBzaXplX3QgKm9mZnNldCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHN0cmVhbS0+ZGV2X3ByaXY7Cj4gLQlpbnQgcmVwb3J0X3NpemUgPSBkZXZf
cHJpdi0+cGVyZi5vYS5vYV9idWZmZXIuZm9ybWF0X3NpemU7Cj4gLQl1OCAqb2FfYnVmX2Jhc2Ug
PSBkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIudmFkZHI7Cj4gLQl1MzIgZ3R0X29mZnNldCA9
IGk5MTVfZ2d0dF9vZmZzZXQoZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLnZtYSk7Cj4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHN0cmVhbS0+aTkxNTsKPiArCWludCByZXBv
cnRfc2l6ZSA9IGk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLmZvcm1hdF9zaXplOwo+ICsJdTggKm9h
X2J1Zl9iYXNlID0gaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIudmFkZHI7Cj4gKwl1MzIgZ3R0X29m
ZnNldCA9IGk5MTVfZ2d0dF9vZmZzZXQoaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIudm1hKTsKPiAg
IAl1MzIgbWFzayA9IChPQV9CVUZGRVJfU0laRSAtIDEpOwo+ICAgCXNpemVfdCBzdGFydF9vZmZz
ZXQgPSAqb2Zmc2V0Owo+ICAgCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4gQEAgLTk1NSwxMyArOTU1
LDEzIEBAIHN0YXRpYyBpbnQgZ2VuN19hcHBlbmRfb2FfcmVwb3J0cyhzdHJ1Y3QgaTkxNV9wZXJm
X3N0cmVhbSAqc3RyZWFtLAo+ICAgCWlmIChXQVJOX09OKCFzdHJlYW0tPmVuYWJsZWQpKQo+ICAg
CQlyZXR1cm4gLUVJTzsKPiAgIAo+IC0Jc3Bpbl9sb2NrX2lycXNhdmUoJmRldl9wcml2LT5wZXJm
Lm9hLm9hX2J1ZmZlci5wdHJfbG9jaywgZmxhZ3MpOwo+ICsJc3Bpbl9sb2NrX2lycXNhdmUoJmk5
MTUtPnBlcmYub2Eub2FfYnVmZmVyLnB0cl9sb2NrLCBmbGFncyk7Cj4gICAKPiAtCWhlYWQgPSBk
ZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIuaGVhZDsKPiAtCWFnZWRfdGFpbF9pZHggPSBkZXZf
cHJpdi0+cGVyZi5vYS5vYV9idWZmZXIuYWdlZF90YWlsX2lkeDsKPiAtCXRhaWwgPSBkZXZfcHJp
di0+cGVyZi5vYS5vYV9idWZmZXIudGFpbHNbYWdlZF90YWlsX2lkeF0ub2Zmc2V0Owo+ICsJaGVh
ZCA9IGk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLmhlYWQ7Cj4gKwlhZ2VkX3RhaWxfaWR4ID0gaTkx
NS0+cGVyZi5vYS5vYV9idWZmZXIuYWdlZF90YWlsX2lkeDsKPiArCXRhaWwgPSBpOTE1LT5wZXJm
Lm9hLm9hX2J1ZmZlci50YWlsc1thZ2VkX3RhaWxfaWR4XS5vZmZzZXQ7Cj4gICAKPiAtCXNwaW5f
dW5sb2NrX2lycXJlc3RvcmUoJmRldl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZlci5wdHJfbG9jaywg
ZmxhZ3MpOwo+ICsJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+cGVyZi5vYS5vYV9idWZm
ZXIucHRyX2xvY2ssIGZsYWdzKTsKPiAgIAo+ICAgCS8qIEFuIGludmFsaWQgdGFpbCBwb2ludGVy
IGhlcmUgbWVhbnMgd2UncmUgc3RpbGwgd2FpdGluZyBmb3IgdGhlIHBvbGwKPiAgIAkgKiBocnRp
bWVyIGNhbGxiYWNrIHRvIGdpdmUgdXMgYSBwb2ludGVyCj4gQEAgLTEwMTQsNyArMTAxNCw3IEBA
IHN0YXRpYyBpbnQgZ2VuN19hcHBlbmRfb2FfcmVwb3J0cyhzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVh
bSAqc3RyZWFtLAo+ICAgCQkgKiBjb3B5aW5nIGl0IHRvIHVzZXJzcGFjZS4uLgo+ICAgCQkgKi8K
PiAgIAkJaWYgKHJlcG9ydDMyWzBdID09IDApIHsKPiAtCQkJaWYgKF9fcmF0ZWxpbWl0KCZkZXZf
cHJpdi0+cGVyZi5vYS5zcHVyaW91c19yZXBvcnRfcnMpKQo+ICsJCQlpZiAoX19yYXRlbGltaXQo
Jmk5MTUtPnBlcmYub2Euc3B1cmlvdXNfcmVwb3J0X3JzKSkKPiAgIAkJCQlEUk1fTk9URSgiU2tp
cHBpbmcgc3B1cmlvdXMsIGludmFsaWQgT0EgcmVwb3J0XG4iKTsKPiAgIAkJCWNvbnRpbnVlOwo+
ICAgCQl9Cj4gQEAgLTEwMzMsNyArMTAzMyw3IEBAIHN0YXRpYyBpbnQgZ2VuN19hcHBlbmRfb2Ff
cmVwb3J0cyhzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtLAo+ICAgCX0KPiAgIAo+ICAg
CWlmIChzdGFydF9vZmZzZXQgIT0gKm9mZnNldCkgewo+IC0JCXNwaW5fbG9ja19pcnFzYXZlKCZk
ZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIucHRyX2xvY2ssIGZsYWdzKTsKPiArCQlzcGluX2xv
Y2tfaXJxc2F2ZSgmaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIucHRyX2xvY2ssIGZsYWdzKTsKPiAg
IAo+ICAgCQkvKiBXZSByZW1vdmVkIHRoZSBndHRfb2Zmc2V0IGZvciB0aGUgY29weSBsb29wIGFi
b3ZlLCBpbmRleGluZwo+ICAgCQkgKiByZWxhdGl2ZSB0byBvYV9idWZfYmFzZSBzbyBwdXQgYmFj
ayBoZXJlLi4uCj4gQEAgLTEwNDMsOSArMTA0Myw5IEBAIHN0YXRpYyBpbnQgZ2VuN19hcHBlbmRf
b2FfcmVwb3J0cyhzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtLAo+ICAgCQlJOTE1X1dS
SVRFKEdFTjdfT0FTVEFUVVMyLAo+ICAgCQkJICAgKChoZWFkICYgR0VON19PQVNUQVRVUzJfSEVB
RF9NQVNLKSB8Cj4gICAJCQkgICAgR0VON19PQVNUQVRVUzJfTUVNX1NFTEVDVF9HR1RUKSk7Cj4g
LQkJZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLmhlYWQgPSBoZWFkOwo+ICsJCWk5MTUtPnBl
cmYub2Eub2FfYnVmZmVyLmhlYWQgPSBoZWFkOwo+ICAgCj4gLQkJc3Bpbl91bmxvY2tfaXJxcmVz
dG9yZSgmZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLnB0cl9sb2NrLCBmbGFncyk7Cj4gKwkJ
c3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIucHRyX2xvY2ss
IGZsYWdzKTsKPiAgIAl9Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+IEBAIC0xMDcyLDExICsxMDcy
LDExIEBAIHN0YXRpYyBpbnQgZ2VuN19vYV9yZWFkKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpz
dHJlYW0sCj4gICAJCQlzaXplX3QgY291bnQsCj4gICAJCQlzaXplX3QgKm9mZnNldCkKPiAgIHsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHN0cmVhbS0+ZGV2X3ByaXY7
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHN0cmVhbS0+aTkxNTsKPiAgIAl1
MzIgb2FzdGF0dXMxOwo+ICAgCWludCByZXQ7Cj4gICAKPiAtCWlmIChXQVJOX09OKCFkZXZfcHJp
di0+cGVyZi5vYS5vYV9idWZmZXIudmFkZHIpKQo+ICsJaWYgKFdBUk5fT04oIWk5MTUtPnBlcmYu
b2Eub2FfYnVmZmVyLnZhZGRyKSkKPiAgIAkJcmV0dXJuIC1FSU87Cj4gICAKPiAgIAlvYXN0YXR1
czEgPSBJOTE1X1JFQUQoR0VON19PQVNUQVRVUzEpOwo+IEBAIC0xMDg2LDcgKzEwODYsNyBAQCBz
dGF0aWMgaW50IGdlbjdfb2FfcmVhZChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtLAo+
ICAgCSAqIG1heSBiZSB1cGRhdGVkIGFzeW5jaHJvbm91c2x5KSBzbyB3ZSBpZ25vcmUgc3RhdHVz
IGJpdHMKPiAgIAkgKiB0aGF0IGhhdmUgYWxyZWFkeSBiZWVuIHJlcG9ydGVkIHRvIHVzZXJzcGFj
ZS4KPiAgIAkgKi8KPiAtCW9hc3RhdHVzMSAmPSB+ZGV2X3ByaXYtPnBlcmYub2EuZ2VuN19sYXRj
aGVkX29hc3RhdHVzMTsKPiArCW9hc3RhdHVzMSAmPSB+aTkxNS0+cGVyZi5vYS5nZW43X2xhdGNo
ZWRfb2FzdGF0dXMxOwo+ICAgCj4gICAJLyogV2UgdHJlYXQgT0FCVUZGRVJfT1ZFUkZMT1cgYXMg
YSBzaWduaWZpY2FudCBlcnJvcjoKPiAgIAkgKgo+IEBAIC0xMTE1LDEwICsxMTE1LDEwIEBAIHN0
YXRpYyBpbnQgZ2VuN19vYV9yZWFkKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0sCj4g
ICAJCQlyZXR1cm4gcmV0Owo+ICAgCj4gICAJCURSTV9ERUJVRygiT0EgYnVmZmVyIG92ZXJmbG93
IChleHBvbmVudCA9ICVkKTogZm9yY2UgcmVzdGFydFxuIiwKPiAtCQkJICBkZXZfcHJpdi0+cGVy
Zi5vYS5wZXJpb2RfZXhwb25lbnQpOwo+ICsJCQkgIGk5MTUtPnBlcmYub2EucGVyaW9kX2V4cG9u
ZW50KTsKPiAgIAo+IC0JCWRldl9wcml2LT5wZXJmLm9hLm9wcy5vYV9kaXNhYmxlKHN0cmVhbSk7
Cj4gLQkJZGV2X3ByaXYtPnBlcmYub2Eub3BzLm9hX2VuYWJsZShzdHJlYW0pOwo+ICsJCWk5MTUt
PnBlcmYub2Eub3BzLm9hX2Rpc2FibGUoc3RyZWFtKTsKPiArCQlpOTE1LT5wZXJmLm9hLm9wcy5v
YV9lbmFibGUoc3RyZWFtKTsKPiAgIAo+ICAgCQlvYXN0YXR1czEgPSBJOTE1X1JFQUQoR0VON19P
QVNUQVRVUzEpOwo+ICAgCX0KPiBAQCAtMTEyOCw3ICsxMTI4LDcgQEAgc3RhdGljIGludCBnZW43
X29hX3JlYWQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSwKPiAgIAkJCQkgICAgICAg
RFJNX0k5MTVfUEVSRl9SRUNPUkRfT0FfUkVQT1JUX0xPU1QpOwo+ICAgCQlpZiAocmV0KQo+ICAg
CQkJcmV0dXJuIHJldDsKPiAtCQlkZXZfcHJpdi0+cGVyZi5vYS5nZW43X2xhdGNoZWRfb2FzdGF0
dXMxIHw9Cj4gKwkJaTkxNS0+cGVyZi5vYS5nZW43X2xhdGNoZWRfb2FzdGF0dXMxIHw9Cj4gICAJ
CQlHRU43X09BU1RBVFVTMV9SRVBPUlRfTE9TVDsKPiAgIAl9Cj4gICAKPiBAQCAtMTE1MSwxNCAr
MTE1MSwxNCBAQCBzdGF0aWMgaW50IGdlbjdfb2FfcmVhZChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVh
bSAqc3RyZWFtLAo+ICAgICovCj4gICBzdGF0aWMgaW50IGk5MTVfb2Ffd2FpdF91bmxvY2tlZChz
dHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gc3RyZWFtLT5kZXZfcHJpdjsKPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gc3RyZWFtLT5pOTE1Owo+ICAgCj4gICAJLyogV2Ugd291bGQgd2Fp
dCBpbmRlZmluaXRlbHkgaWYgcGVyaW9kaWMgc2FtcGxpbmcgaXMgbm90IGVuYWJsZWQgKi8KPiAt
CWlmICghZGV2X3ByaXYtPnBlcmYub2EucGVyaW9kaWMpCj4gKwlpZiAoIWk5MTUtPnBlcmYub2Eu
cGVyaW9kaWMpCj4gICAJCXJldHVybiAtRUlPOwo+ICAgCj4gLQlyZXR1cm4gd2FpdF9ldmVudF9p
bnRlcnJ1cHRpYmxlKGRldl9wcml2LT5wZXJmLm9hLnBvbGxfd3EsCj4gLQkJCQkJb2FfYnVmZmVy
X2NoZWNrX3VubG9ja2VkKGRldl9wcml2KSk7Cj4gKwlyZXR1cm4gd2FpdF9ldmVudF9pbnRlcnJ1
cHRpYmxlKGk5MTUtPnBlcmYub2EucG9sbF93cSwKPiArCQkJCQlvYV9idWZmZXJfY2hlY2tfdW5s
b2NrZWQoaTkxNSkpOwo+ICAgfQo+ICAgCj4gICAvKioKPiBAQCAtMTE3NSw5ICsxMTc1LDkgQEAg
c3RhdGljIHZvaWQgaTkxNV9vYV9wb2xsX3dhaXQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0
cmVhbSwKPiAgIAkJCSAgICAgIHN0cnVjdCBmaWxlICpmaWxlLAo+ICAgCQkJICAgICAgcG9sbF90
YWJsZSAqd2FpdCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHN0cmVhbS0+ZGV2X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHN0
cmVhbS0+aTkxNTsKPiAgIAo+IC0JcG9sbF93YWl0KGZpbGUsICZkZXZfcHJpdi0+cGVyZi5vYS5w
b2xsX3dxLCB3YWl0KTsKPiArCXBvbGxfd2FpdChmaWxlLCAmaTkxNS0+cGVyZi5vYS5wb2xsX3dx
LCB3YWl0KTsKPiAgIH0KPiAgIAo+ICAgLyoqCj4gQEAgLTExOTcsOSArMTE5Nyw5IEBAIHN0YXRp
YyBpbnQgaTkxNV9vYV9yZWFkKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0sCj4gICAJ
CQlzaXplX3QgY291bnQsCj4gICAJCQlzaXplX3QgKm9mZnNldCkKPiAgIHsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHN0cmVhbS0+ZGV2X3ByaXY7Cj4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHN0cmVhbS0+aTkxNTsKPiAgIAo+IC0JcmV0dXJuIGRl
dl9wcml2LT5wZXJmLm9hLm9wcy5yZWFkKHN0cmVhbSwgYnVmLCBjb3VudCwgb2Zmc2V0KTsKPiAr
CXJldHVybiBpOTE1LT5wZXJmLm9hLm9wcy5yZWFkKHN0cmVhbSwgYnVmLCBjb3VudCwgb2Zmc2V0
KTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHN0cnVjdCBpbnRlbF9jb250ZXh0ICpvYV9waW5fY29u
dGV4dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiBAQCAtMTI0OCw3ICsxMjQ4LDcg
QEAgc3RhdGljIHN0cnVjdCBpbnRlbF9jb250ZXh0ICpvYV9waW5fY29udGV4dChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgICAqLwo+ICAgc3RhdGljIGludCBvYV9nZXRfcmVuZGVy
X2N0eF9pZChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtKQo+ICAgewo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBzdHJlYW0tPmRldl9wcml2Owo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBzdHJlYW0tPmk5MTU7Cj4gICAJc3RydWN0IGludGVsX2Nv
bnRleHQgKmNlOwo+ICAgCj4gICAJY2UgPSBvYV9waW5fY29udGV4dChpOTE1LCBzdHJlYW0tPmN0
eCk7Cj4gQEAgLTEzMzAsMTcgKzEzMzAsMTcgQEAgc3RhdGljIGludCBvYV9nZXRfcmVuZGVyX2N0
eF9pZChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtKQo+ICAgICovCj4gICBzdGF0aWMg
dm9pZCBvYV9wdXRfcmVuZGVyX2N0eF9pZChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFt
KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gc3RyZWFtLT5k
ZXZfcHJpdjsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gc3RyZWFtLT5pOTE1
Owo+ICAgCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsKPiAgIAo+IC0JZGV2X3ByaXYtPnBlcmYu
b2Euc3BlY2lmaWNfY3R4X2lkID0gSU5WQUxJRF9DVFhfSUQ7Cj4gLQlkZXZfcHJpdi0+cGVyZi5v
YS5zcGVjaWZpY19jdHhfaWRfbWFzayA9IDA7Cj4gKwlpOTE1LT5wZXJmLm9hLnNwZWNpZmljX2N0
eF9pZCA9IElOVkFMSURfQ1RYX0lEOwo+ICsJaTkxNS0+cGVyZi5vYS5zcGVjaWZpY19jdHhfaWRf
bWFzayA9IDA7Cj4gICAKPiAtCWNlID0gZmV0Y2hfYW5kX3plcm8oJmRldl9wcml2LT5wZXJmLm9h
LnBpbm5lZF9jdHgpOwo+ICsJY2UgPSBmZXRjaF9hbmRfemVybygmaTkxNS0+cGVyZi5vYS5waW5u
ZWRfY3R4KTsKPiAgIAlpZiAoY2UpIHsKPiAtCQltdXRleF9sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0
cnVjdF9tdXRleCk7Cj4gKwkJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4g
ICAJCWludGVsX2NvbnRleHRfdW5waW4oY2UpOwo+IC0JCW11dGV4X3VubG9jaygmZGV2X3ByaXYt
PmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9t
dXRleCk7Cj4gICAJfQo+ICAgfQo+ICAgCj4gQEAgLTEzNTksNjQgKzEzNTksNjQgQEAgZnJlZV9v
YV9idWZmZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICAKPiAgIHN0YXRpYyB2
b2lkIGk5MTVfb2Ffc3RyZWFtX2Rlc3Ryb3koc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVh
bSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHN0cmVhbS0+
ZGV2X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHN0cmVhbS0+aTkx
NTsKPiAgIAo+IC0JQlVHX09OKHN0cmVhbSAhPSBkZXZfcHJpdi0+cGVyZi5vYS5leGNsdXNpdmVf
c3RyZWFtKTsKPiArCUJVR19PTihzdHJlYW0gIT0gaTkxNS0+cGVyZi5vYS5leGNsdXNpdmVfc3Ry
ZWFtKTsKPiAgIAo+ICAgCS8qCj4gICAJICogVW5zZXQgZXhjbHVzaXZlX3N0cmVhbSBmaXJzdCwg
aXQgd2lsbCBiZSBjaGVja2VkIHdoaWxlIGRpc2FibGluZwo+ICAgCSAqIHRoZSBtZXRyaWMgc2V0
IG9uIGdlbjgrLgo+ICAgCSAqLwo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3Rf
bXV0ZXgpOwo+IC0JZGV2X3ByaXYtPnBlcmYub2EuZXhjbHVzaXZlX3N0cmVhbSA9IE5VTEw7Cj4g
LQlkZXZfcHJpdi0+cGVyZi5vYS5vcHMuZGlzYWJsZV9tZXRyaWNfc2V0KGRldl9wcml2KTsKPiAt
CW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJbXV0ZXhfbG9j
aygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gKwlpOTE1LT5wZXJmLm9hLmV4Y2x1c2l2ZV9z
dHJlYW0gPSBOVUxMOwo+ICsJaTkxNS0+cGVyZi5vYS5vcHMuZGlzYWJsZV9tZXRyaWNfc2V0KGk5
MTUpOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAo+IC0J
ZnJlZV9vYV9idWZmZXIoZGV2X3ByaXYpOwo+ICsJZnJlZV9vYV9idWZmZXIoaTkxNSk7Cj4gICAK
PiAtCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdB
S0VfQUxMKTsKPiAtCWludGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCBzdHJlYW0tPndha2Vy
ZWYpOwo+ICsJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VX
QUtFX0FMTCk7Cj4gKwlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCBzdHJlYW0tPndha2VyZWYp
Owo+ICAgCj4gICAJaWYgKHN0cmVhbS0+Y3R4KQo+ICAgCQlvYV9wdXRfcmVuZGVyX2N0eF9pZChz
dHJlYW0pOwo+ICAgCj4gLQlwdXRfb2FfY29uZmlnKGRldl9wcml2LCBzdHJlYW0tPm9hX2NvbmZp
Zyk7Cj4gKwlwdXRfb2FfY29uZmlnKGk5MTUsIHN0cmVhbS0+b2FfY29uZmlnKTsKPiAgIAo+IC0J
aWYgKGRldl9wcml2LT5wZXJmLm9hLnNwdXJpb3VzX3JlcG9ydF9ycy5taXNzZWQpIHsKPiArCWlm
IChpOTE1LT5wZXJmLm9hLnNwdXJpb3VzX3JlcG9ydF9ycy5taXNzZWQpIHsKPiAgIAkJRFJNX05P
VEUoIiVkIHNwdXJpb3VzIE9BIHJlcG9ydCBub3RpY2VzIHN1cHByZXNzZWQgZHVlIHRvIHJhdGVs
aW1pdGluZ1xuIiwKPiAtCQkJIGRldl9wcml2LT5wZXJmLm9hLnNwdXJpb3VzX3JlcG9ydF9ycy5t
aXNzZWQpOwo+ICsJCQkgaTkxNS0+cGVyZi5vYS5zcHVyaW91c19yZXBvcnRfcnMubWlzc2VkKTsK
PiAgIAl9Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgZ2VuN19pbml0X29hX2J1ZmZlcihzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGdlbjdfaW5pdF9v
YV9idWZmZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQl1MzIgZ3R0
X29mZnNldCA9IGk5MTVfZ2d0dF9vZmZzZXQoZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLnZt
YSk7Cj4gKwl1MzIgZ3R0X29mZnNldCA9IGk5MTVfZ2d0dF9vZmZzZXQoaTkxNS0+cGVyZi5vYS5v
YV9idWZmZXIudm1hKTsKPiAgIAl1bnNpZ25lZCBsb25nIGZsYWdzOwo+ICAgCj4gLQlzcGluX2xv
Y2tfaXJxc2F2ZSgmZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLnB0cl9sb2NrLCBmbGFncyk7
Cj4gKwlzcGluX2xvY2tfaXJxc2F2ZSgmaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIucHRyX2xvY2ss
IGZsYWdzKTsKPiAgIAo+ICAgCS8qIFByZS1EZXZCRFc6IE9BQlVGRkVSIG11c3QgYmUgc2V0IHdp
dGggY291bnRlcnMgb2ZmLAo+ICAgCSAqIGJlZm9yZSBPQVNUQVRVUzEsIGJ1dCBhZnRlciBPQVNU
QVRVUzIKPiAgIAkgKi8KPiAgIAlJOTE1X1dSSVRFKEdFTjdfT0FTVEFUVVMyLAo+ICAgCQkgICBn
dHRfb2Zmc2V0IHwgR0VON19PQVNUQVRVUzJfTUVNX1NFTEVDVF9HR1RUKTsgLyogaGVhZCAqLwo+
IC0JZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLmhlYWQgPSBndHRfb2Zmc2V0Owo+ICsJaTkx
NS0+cGVyZi5vYS5vYV9idWZmZXIuaGVhZCA9IGd0dF9vZmZzZXQ7Cj4gICAKPiAgIAlJOTE1X1dS
SVRFKEdFTjdfT0FCVUZGRVIsIGd0dF9vZmZzZXQpOwo+ICAgCj4gICAJSTkxNV9XUklURShHRU43
X09BU1RBVFVTMSwgZ3R0X29mZnNldCB8IE9BQlVGRkVSX1NJWkVfMTZNKTsgLyogdGFpbCAqLwo+
ICAgCj4gICAJLyogTWFyayB0aGF0IHdlIG5lZWQgdXBkYXRlZCB0YWlsIHBvaW50ZXJzIHRvIHJl
YWQgZnJvbS4uLiAqLwo+IC0JZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLnRhaWxzWzBdLm9m
ZnNldCA9IElOVkFMSURfVEFJTF9QVFI7Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIu
dGFpbHNbMV0ub2Zmc2V0ID0gSU5WQUxJRF9UQUlMX1BUUjsKPiArCWk5MTUtPnBlcmYub2Eub2Ff
YnVmZmVyLnRhaWxzWzBdLm9mZnNldCA9IElOVkFMSURfVEFJTF9QVFI7Cj4gKwlpOTE1LT5wZXJm
Lm9hLm9hX2J1ZmZlci50YWlsc1sxXS5vZmZzZXQgPSBJTlZBTElEX1RBSUxfUFRSOwo+ICAgCj4g
LQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIucHRy
X2xvY2ssIGZsYWdzKTsKPiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPnBlcmYub2Eu
b2FfYnVmZmVyLnB0cl9sb2NrLCBmbGFncyk7Cj4gICAKPiAgIAkvKiBPbiBIYXN3ZWxsIHdlIGhh
dmUgdG8gdHJhY2sgd2hpY2ggT0FTVEFUVVMxIGZsYWdzIHdlJ3ZlCj4gICAJICogYWxyZWFkeSBz
ZWVuIHNpbmNlIHRoZXkgY2FuJ3QgYmUgY2xlYXJlZCB3aGlsZSBwZXJpb2RpYwo+ICAgCSAqIHNh
bXBsaW5nIGlzIGVuYWJsZWQuCj4gICAJICovCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS5nZW43X2xh
dGNoZWRfb2FzdGF0dXMxID0gMDsKPiArCWk5MTUtPnBlcmYub2EuZ2VuN19sYXRjaGVkX29hc3Rh
dHVzMSA9IDA7Cj4gICAKPiAgIAkvKiBOQjogYWx0aG91Z2ggdGhlIE9BIGJ1ZmZlciB3aWxsIGlu
aXRpYWxseSBiZSBhbGxvY2F0ZWQKPiAgIAkgKiB6ZXJvZWQgdmlhIHNobWZzIChhbmQgc28gdGhp
cyBtZW1zZXQgaXMgcmVkdW5kYW50IHdoZW4KPiBAQCAtMTQyOSwyNCArMTQyOSwyNCBAQCBzdGF0
aWMgdm9pZCBnZW43X2luaXRfb2FfYnVmZmVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiAgIAkgKiB0aGUgYXNzdW1wdGlvbiB0aGF0IG5ldyByZXBvcnRzIGFyZSBiZWluZyB3
cml0dGVuIHRvIHplcm9lZAo+ICAgCSAqIG1lbW9yeS4uLgo+ICAgCSAqLwo+IC0JbWVtc2V0KGRl
dl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZlci52YWRkciwgMCwgT0FfQlVGRkVSX1NJWkUpOwo+ICsJ
bWVtc2V0KGk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLnZhZGRyLCAwLCBPQV9CVUZGRVJfU0laRSk7
Cj4gICAKPiAgIAkvKiBNYXliZSBtYWtlIC0+cG9sbGluIHBlci1zdHJlYW0gc3RhdGUgaWYgd2Ug
c3VwcG9ydCBtdWx0aXBsZQo+ICAgCSAqIGNvbmN1cnJlbnQgc3RyZWFtcyBpbiB0aGUgZnV0dXJl
Lgo+ICAgCSAqLwo+IC0JZGV2X3ByaXYtPnBlcmYub2EucG9sbGluID0gZmFsc2U7Cj4gKwlpOTE1
LT5wZXJmLm9hLnBvbGxpbiA9IGZhbHNlOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGdlbjhf
aW5pdF9vYV9idWZmZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0
aWMgdm9pZCBnZW44X2luaXRfb2FfYnVmZmVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ICAgewo+IC0JdTMyIGd0dF9vZmZzZXQgPSBpOTE1X2dndHRfb2Zmc2V0KGRldl9wcml2LT5w
ZXJmLm9hLm9hX2J1ZmZlci52bWEpOwo+ICsJdTMyIGd0dF9vZmZzZXQgPSBpOTE1X2dndHRfb2Zm
c2V0KGk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLnZtYSk7Cj4gICAJdW5zaWduZWQgbG9uZyBmbGFn
czsKPiAgIAo+IC0Jc3Bpbl9sb2NrX2lycXNhdmUoJmRldl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZl
ci5wdHJfbG9jaywgZmxhZ3MpOwo+ICsJc3Bpbl9sb2NrX2lycXNhdmUoJmk5MTUtPnBlcmYub2Eu
b2FfYnVmZmVyLnB0cl9sb2NrLCBmbGFncyk7Cj4gICAKPiAgIAlJOTE1X1dSSVRFKEdFTjhfT0FT
VEFUVVMsIDApOwo+ICAgCUk5MTVfV1JJVEUoR0VOOF9PQUhFQURQVFIsIGd0dF9vZmZzZXQpOwo+
IC0JZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLmhlYWQgPSBndHRfb2Zmc2V0Owo+ICsJaTkx
NS0+cGVyZi5vYS5vYV9idWZmZXIuaGVhZCA9IGd0dF9vZmZzZXQ7Cj4gICAKPiAgIAlJOTE1X1dS
SVRFKEdFTjhfT0FCVUZGRVJfVURXLCAwKTsKPiAgIAo+IEBAIC0xNDYzLDE3ICsxNDYzLDE3IEBA
IHN0YXRpYyB2b2lkIGdlbjhfaW5pdF9vYV9idWZmZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICAgCUk5MTVfV1JJVEUoR0VOOF9PQVRBSUxQVFIsIGd0dF9vZmZzZXQgJiBH
RU44X09BVEFJTFBUUl9NQVNLKTsKPiAgIAo+ICAgCS8qIE1hcmsgdGhhdCB3ZSBuZWVkIHVwZGF0
ZWQgdGFpbCBwb2ludGVycyB0byByZWFkIGZyb20uLi4gKi8KPiAtCWRldl9wcml2LT5wZXJmLm9h
Lm9hX2J1ZmZlci50YWlsc1swXS5vZmZzZXQgPSBJTlZBTElEX1RBSUxfUFRSOwo+IC0JZGV2X3By
aXYtPnBlcmYub2Eub2FfYnVmZmVyLnRhaWxzWzFdLm9mZnNldCA9IElOVkFMSURfVEFJTF9QVFI7
Cj4gKwlpOTE1LT5wZXJmLm9hLm9hX2J1ZmZlci50YWlsc1swXS5vZmZzZXQgPSBJTlZBTElEX1RB
SUxfUFRSOwo+ICsJaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIudGFpbHNbMV0ub2Zmc2V0ID0gSU5W
QUxJRF9UQUlMX1BUUjsKPiAgIAo+ICAgCS8qCj4gICAJICogUmVzZXQgc3RhdGUgdXNlZCB0byBy
ZWNvZ25pc2UgY29udGV4dCBzd2l0Y2hlcywgYWZmZWN0aW5nIHdoaWNoCj4gICAJICogcmVwb3J0
cyB3ZSB3aWxsIGZvcndhcmQgdG8gdXNlcnNwYWNlIHdoaWxlIGZpbHRlcmluZyBmb3IgYSBzaW5n
bGUKPiAgIAkgKiBjb250ZXh0Lgo+ICAgCSAqLwo+IC0JZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVm
ZmVyLmxhc3RfY3R4X2lkID0gSU5WQUxJRF9DVFhfSUQ7Cj4gKwlpOTE1LT5wZXJmLm9hLm9hX2J1
ZmZlci5sYXN0X2N0eF9pZCA9IElOVkFMSURfQ1RYX0lEOwo+ICAgCj4gLQlzcGluX3VubG9ja19p
cnFyZXN0b3JlKCZkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIucHRyX2xvY2ssIGZsYWdzKTsK
PiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLnB0cl9s
b2NrLCBmbGFncyk7Cj4gICAKPiAgIAkvKgo+ICAgCSAqIE5COiBhbHRob3VnaCB0aGUgT0EgYnVm
ZmVyIHdpbGwgaW5pdGlhbGx5IGJlIGFsbG9jYXRlZAo+IEBAIC0xNDg3LDMyICsxNDg3LDMyIEBA
IHN0YXRpYyB2b2lkIGdlbjhfaW5pdF9vYV9idWZmZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICAgCSAqIHRoZSBhc3N1bXB0aW9uIHRoYXQgbmV3IHJlcG9ydHMgYXJlIGJl
aW5nIHdyaXR0ZW4gdG8gemVyb2VkCj4gICAJICogbWVtb3J5Li4uCj4gICAJICovCj4gLQltZW1z
ZXQoZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLnZhZGRyLCAwLCBPQV9CVUZGRVJfU0laRSk7
Cj4gKwltZW1zZXQoaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIudmFkZHIsIDAsIE9BX0JVRkZFUl9T
SVpFKTsKPiAgIAo+ICAgCS8qCj4gICAJICogTWF5YmUgbWFrZSAtPnBvbGxpbiBwZXItc3RyZWFt
IHN0YXRlIGlmIHdlIHN1cHBvcnQgbXVsdGlwbGUKPiAgIAkgKiBjb25jdXJyZW50IHN0cmVhbXMg
aW4gdGhlIGZ1dHVyZS4KPiAgIAkgKi8KPiAtCWRldl9wcml2LT5wZXJmLm9hLnBvbGxpbiA9IGZh
bHNlOwo+ICsJaTkxNS0+cGVyZi5vYS5wb2xsaW4gPSBmYWxzZTsKPiAgIH0KPiAgIAo+IC1zdGF0
aWMgaW50IGFsbG9jX29hX2J1ZmZlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gK3N0YXRpYyBpbnQgYWxsb2Nfb2FfYnVmZmVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ICAgewo+ICAgCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpibzsKPiAgIAlzdHJ1
Y3QgaTkxNV92bWEgKnZtYTsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gLQlpZiAoV0FSTl9PTihkZXZf
cHJpdi0+cGVyZi5vYS5vYV9idWZmZXIudm1hKSkKPiArCWlmIChXQVJOX09OKGk5MTUtPnBlcmYu
b2Eub2FfYnVmZmVyLnZtYSkpCj4gICAJCXJldHVybiAtRU5PREVWOwo+ICAgCj4gLQlyZXQgPSBp
OTE1X211dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmZGV2X3ByaXYtPmRybSk7Cj4gKwlyZXQgPSBp
OTE1X211dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmaTkxNS0+ZHJtKTsKPiAgIAlpZiAocmV0KQo+
ICAgCQlyZXR1cm4gcmV0Owo+ICAgCj4gICAJQlVJTERfQlVHX09OX05PVF9QT1dFUl9PRl8yKE9B
X0JVRkZFUl9TSVpFKTsKPiAgIAlCVUlMRF9CVUdfT04oT0FfQlVGRkVSX1NJWkUgPCBTWl8xMjhL
IHx8IE9BX0JVRkZFUl9TSVpFID4gU1pfMTZNKTsKPiAgIAo+IC0JYm8gPSBpOTE1X2dlbV9vYmpl
Y3RfY3JlYXRlX3NobWVtKGRldl9wcml2LCBPQV9CVUZGRVJfU0laRSk7Cj4gKwlibyA9IGk5MTVf
Z2VtX29iamVjdF9jcmVhdGVfc2htZW0oaTkxNSwgT0FfQlVGRkVSX1NJWkUpOwo+ICAgCWlmIChJ
U19FUlIoYm8pKSB7Cj4gICAJCURSTV9FUlJPUigiRmFpbGVkIHRvIGFsbG9jYXRlIE9BIGJ1ZmZl
clxuIik7Cj4gICAJCXJldCA9IFBUUl9FUlIoYm8pOwo+IEBAIC0xNTI3LDE4ICsxNTI3LDE4IEBA
IHN0YXRpYyBpbnQgYWxsb2Nfb2FfYnVmZmVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiAgIAkJcmV0ID0gUFRSX0VSUih2bWEpOwo+ICAgCQlnb3RvIGVycl91bnJlZjsKPiAg
IAl9Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIudm1hID0gdm1hOwo+ICsJaTkxNS0+
cGVyZi5vYS5vYV9idWZmZXIudm1hID0gdm1hOwo+ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS5v
YV9idWZmZXIudmFkZHIgPQo+ICsJaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIudmFkZHIgPQo+ICAg
CQlpOTE1X2dlbV9vYmplY3RfcGluX21hcChibywgSTkxNV9NQVBfV0IpOwo+IC0JaWYgKElTX0VS
UihkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIudmFkZHIpKSB7Cj4gLQkJcmV0ID0gUFRSX0VS
UihkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIudmFkZHIpOwo+ICsJaWYgKElTX0VSUihpOTE1
LT5wZXJmLm9hLm9hX2J1ZmZlci52YWRkcikpIHsKPiArCQlyZXQgPSBQVFJfRVJSKGk5MTUtPnBl
cmYub2Eub2FfYnVmZmVyLnZhZGRyKTsKPiAgIAkJZ290byBlcnJfdW5waW47Cj4gICAJfQo+ICAg
Cj4gICAJRFJNX0RFQlVHX0RSSVZFUigiT0EgQnVmZmVyIGluaXRpYWxpemVkLCBndHQgb2Zmc2V0
ID0gMHgleCwgdmFkZHIgPSAlcFxuIiwKPiAtCQkJIGk5MTVfZ2d0dF9vZmZzZXQoZGV2X3ByaXYt
PnBlcmYub2Eub2FfYnVmZmVyLnZtYSksCj4gLQkJCSBkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZm
ZXIudmFkZHIpOwo+ICsJCQkgaTkxNV9nZ3R0X29mZnNldChpOTE1LT5wZXJmLm9hLm9hX2J1ZmZl
ci52bWEpLAo+ICsJCQkgaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIudmFkZHIpOwo+ICAgCj4gICAJ
Z290byB1bmxvY2s7Cj4gICAKPiBAQCAtMTU0OCwxNSArMTU0OCwxNSBAQCBzdGF0aWMgaW50IGFs
bG9jX29hX2J1ZmZlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICBlcnJf
dW5yZWY6Cj4gICAJaTkxNV9nZW1fb2JqZWN0X3B1dChibyk7Cj4gICAKPiAtCWRldl9wcml2LT5w
ZXJmLm9hLm9hX2J1ZmZlci52YWRkciA9IE5VTEw7Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS5vYV9i
dWZmZXIudm1hID0gTlVMTDsKPiArCWk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLnZhZGRyID0gTlVM
TDsKPiArCWk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLnZtYSA9IE5VTEw7Cj4gICAKPiAgIHVubG9j
azoKPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJbXV0
ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAlyZXR1cm4gcmV0Owo+ICAg
fQo+ICAgCj4gLXN0YXRpYyB2b2lkIGNvbmZpZ19vYV9yZWdzKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgY29uZmlnX29hX3JlZ3Moc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICBjb25zdCBzdHJ1Y3QgaTkxNV9vYV9yZWcgKnJl
Z3MsCj4gICAJCQkgICB1MzIgbl9yZWdzKQo+ICAgewo+IEBAIC0xNTcxLDcgKzE1NzEsNyBAQCBz
dGF0aWMgdm9pZCBjb25maWdfb2FfcmVncyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gICAKPiAgIHN0YXRpYyBpbnQgaHN3X2VuYWJsZV9tZXRyaWNfc2V0KHN0cnVjdCBpOTE1
X3BlcmZfc3RyZWFtICpzdHJlYW0pCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBzdHJlYW0tPmRldl9wcml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBzdHJlYW0tPmk5MTU7Cj4gICAJY29uc3Qgc3RydWN0IGk5MTVfb2FfY29uZmlnICpv
YV9jb25maWcgPSBzdHJlYW0tPm9hX2NvbmZpZzsKPiAgIAo+ICAgCS8qIFBSTToKPiBAQCAtMTU4
OCw3ICsxNTg4LDcgQEAgc3RhdGljIGludCBoc3dfZW5hYmxlX21ldHJpY19zZXQoc3RydWN0IGk5
MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSkKPiAgIAlJOTE1X1dSSVRFKEdFTjZfVUNHQ1RMMSwgKEk5
MTVfUkVBRChHRU42X1VDR0NUTDEpIHwKPiAgIAkJCQkgIEdFTjZfQ1NVTklUX0NMT0NLX0dBVEVf
RElTQUJMRSkpOwo+ICAgCj4gLQljb25maWdfb2FfcmVncyhkZXZfcHJpdiwgb2FfY29uZmlnLT5t
dXhfcmVncywgb2FfY29uZmlnLT5tdXhfcmVnc19sZW4pOwo+ICsJY29uZmlnX29hX3JlZ3MoaTkx
NSwgb2FfY29uZmlnLT5tdXhfcmVncywgb2FfY29uZmlnLT5tdXhfcmVnc19sZW4pOwo+ICAgCj4g
ICAJLyogSXQgYXBwYXJlbnRseSB0YWtlcyBhIGZhaXJseSBsb25nIHRpbWUgZm9yIGEgbmV3IE1V
WAo+ICAgCSAqIGNvbmZpZ3VyYXRpb24gdG8gYmUgYmUgYXBwbGllZCBhZnRlciB0aGVzZSByZWdp
c3RlciB3cml0ZXMuCj4gQEAgLTE2MTMsMTMgKzE2MTMsMTMgQEAgc3RhdGljIGludCBoc3dfZW5h
YmxlX21ldHJpY19zZXQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSkKPiAgIAkgKi8K
PiAgIAl1c2xlZXBfcmFuZ2UoMTUwMDAsIDIwMDAwKTsKPiAgIAo+IC0JY29uZmlnX29hX3JlZ3Mo
ZGV2X3ByaXYsIG9hX2NvbmZpZy0+Yl9jb3VudGVyX3JlZ3MsCj4gKwljb25maWdfb2FfcmVncyhp
OTE1LCBvYV9jb25maWctPmJfY291bnRlcl9yZWdzLAo+ICAgCQkgICAgICAgb2FfY29uZmlnLT5i
X2NvdW50ZXJfcmVnc19sZW4pOwo+ICAgCj4gICAJcmV0dXJuIDA7Cj4gICB9Cj4gICAKPiAtc3Rh
dGljIHZvaWQgaHN3X2Rpc2FibGVfbWV0cmljX3NldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGhzd19kaXNhYmxlX21ldHJpY19zZXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJSTkxNV9XUklURShHRU42X1VDR0NUTDEs
IChJOTE1X1JFQUQoR0VONl9VQ0dDVEwxKSAmCj4gICAJCQkJICB+R0VONl9DU1VOSVRfQ0xPQ0tf
R0FURV9ESVNBQkxFKSk7Cj4gQEAgLTE3MTYsMTUgKzE3MTYsMTUgQEAgZ2VuOF91cGRhdGVfcmVn
X3N0YXRlX3VubG9ja2VkKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKPiAgICAqCj4gICAgKiBO
b3RlOiBpdCdzIG9ubHkgdGhlIFJDUy9SZW5kZXIgY29udGV4dCB0aGF0IGhhcyBhbnkgT0Egc3Rh
dGUuCj4gICAgKi8KPiAtc3RhdGljIGludCBnZW44X2NvbmZpZ3VyZV9hbGxfY29udGV4dHMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgaW50IGdlbjhfY29uZmln
dXJlX2FsbF9jb250ZXh0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkg
ICAgICAgY29uc3Qgc3RydWN0IGk5MTVfb2FfY29uZmlnICpvYV9jb25maWcpCj4gICB7Cj4gLQl1
bnNpZ25lZCBpbnQgbWFwX3R5cGUgPSBpOTE1X2NvaGVyZW50X21hcF90eXBlKGRldl9wcml2KTsK
PiArCXVuc2lnbmVkIGludCBtYXBfdHlwZSA9IGk5MTVfY29oZXJlbnRfbWFwX3R5cGUoaTkxNSk7
Cj4gICAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eDsKPiAgIAlzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpycTsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZf
cHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5k
cm0uc3RydWN0X211dGV4KTsKPiAgIAo+ICAgCS8qCj4gICAJICogVGhlIE9BIHJlZ2lzdGVyIGNv
bmZpZyBpcyBzZXR1cCB0aHJvdWdoIHRoZSBjb250ZXh0IGltYWdlLiBUaGlzIGltYWdlCj4gQEAg
LTE3MzksMTQgKzE3MzksMTQgQEAgc3RhdGljIGludCBnZW44X2NvbmZpZ3VyZV9hbGxfY29udGV4
dHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCSAqIFNvIGZhciB0aGUg
YmVzdCB3YXkgdG8gd29yayBhcm91bmQgdGhpcyBpc3N1ZSBzZWVtcyB0byBiZSBkcmFpbmluZwo+
ICAgCSAqIHRoZSBHUFUgZnJvbSBhbnkgc3VibWl0dGVkIHdvcmsuCj4gICAJICovCj4gLQlyZXQg
PSBpOTE1X2dlbV93YWl0X2Zvcl9pZGxlKGRldl9wcml2LAo+ICsJcmV0ID0gaTkxNV9nZW1fd2Fp
dF9mb3JfaWRsZShpOTE1LAo+ICAgCQkJCSAgICAgSTkxNV9XQUlUX0xPQ0tFRCwKPiAgIAkJCQkg
ICAgIE1BWF9TQ0hFRFVMRV9USU1FT1VUKTsKPiAgIAlpZiAocmV0KQo+ICAgCQlyZXR1cm4gcmV0
Owo+ICAgCj4gICAJLyogVXBkYXRlIGFsbCBjb250ZXh0cyBub3cgdGhhdCB3ZSd2ZSBzdGFsbGVk
IHRoZSBzdWJtaXNzaW9uLiAqLwo+IC0JbGlzdF9mb3JfZWFjaF9lbnRyeShjdHgsICZkZXZfcHJp
di0+Y29udGV4dHMubGlzdCwgbGluaykgewo+ICsJbGlzdF9mb3JfZWFjaF9lbnRyeShjdHgsICZp
OTE1LT5jb250ZXh0cy5saXN0LCBsaW5rKSB7Cj4gICAJCXN0cnVjdCBpOTE1X2dlbV9lbmdpbmVz
X2l0ZXIgaXQ7Cj4gICAJCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsKPiAgIAo+IEBAIC0xNzgz
LDcgKzE3ODMsNyBAQCBzdGF0aWMgaW50IGdlbjhfY29uZmlndXJlX2FsbF9jb250ZXh0cyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJICogQXBwbHkgdGhlIGNvbmZpZ3Vy
YXRpb24gYnkgZG9pbmcgb25lIGNvbnRleHQgcmVzdG9yZSBvZiB0aGUgZWRpdGVkCj4gICAJICog
Y29udGV4dCBpbWFnZS4KPiAgIAkgKi8KPiAtCXJxID0gaTkxNV9yZXF1ZXN0X2NyZWF0ZShkZXZf
cHJpdi0+ZW5naW5lW1JDUzBdLT5rZXJuZWxfY29udGV4dCk7Cj4gKwlycSA9IGk5MTVfcmVxdWVz
dF9jcmVhdGUoaTkxNS0+ZW5naW5lW1JDUzBdLT5rZXJuZWxfY29udGV4dCk7Cj4gICAJaWYgKElT
X0VSUihycSkpCj4gICAJCXJldHVybiBQVFJfRVJSKHJxKTsKPiAgIAo+IEBAIC0xNzk0LDcgKzE3
OTQsNyBAQCBzdGF0aWMgaW50IGdlbjhfY29uZmlndXJlX2FsbF9jb250ZXh0cyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAKPiAgIHN0YXRpYyBpbnQgZ2VuOF9lbmFibGVf
bWV0cmljX3NldChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtKQo+ICAgewo+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gc3RyZWFtLT5kZXZfcHJpdjsKPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gc3RyZWFtLT5pOTE1Owo+ICAgCWNvbnN0IHN0
cnVjdCBpOTE1X29hX2NvbmZpZyAqb2FfY29uZmlnID0gc3RyZWFtLT5vYV9jb25maWc7Cj4gICAJ
aW50IHJldDsKPiAgIAo+IEBAIC0xODIxLDcgKzE4MjEsNyBAQCBzdGF0aWMgaW50IGdlbjhfZW5h
YmxlX21ldHJpY19zZXQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSkKPiAgIAkgKiBi
ZSByZWFkIGJhY2sgZnJvbSBhdXRvbWF0aWNhbGx5IHRyaWdnZXJlZCByZXBvcnRzLCBhcyBwYXJ0
IG9mIHRoZQo+ICAgCSAqIFJQVF9JRCBmaWVsZC4KPiAgIAkgKi8KPiAtCWlmIChJU19HRU5fUkFO
R0UoZGV2X3ByaXYsIDksIDExKSkgewo+ICsJaWYgKElTX0dFTl9SQU5HRShpOTE1LCA5LCAxMSkp
IHsKPiAgIAkJSTkxNV9XUklURShHRU44X09BX0RFQlVHLAo+ICAgCQkJICAgX01BU0tFRF9CSVRf
RU5BQkxFKEdFTjlfT0FfREVCVUdfRElTQUJMRV9DTEtfUkFUSU9fUkVQT1JUUyB8Cj4gICAJCQkJ
CSAgICAgIEdFTjlfT0FfREVCVUdfSU5DTFVERV9DTEtfUkFUSU8pKTsKPiBAQCAtMTgzMiwzMSAr
MTgzMiwzMSBAQCBzdGF0aWMgaW50IGdlbjhfZW5hYmxlX21ldHJpY19zZXQoc3RydWN0IGk5MTVf
cGVyZl9zdHJlYW0gKnN0cmVhbSkKPiAgIAkgKiB0byBtYWtlIHN1cmUgYWxsIHNsaWNlcy9zdWJz
bGljZXMgYXJlIE9OIGJlZm9yZSB3cml0aW5nIHRvIE5PQQo+ICAgCSAqIHJlZ2lzdGVycy4KPiAg
IAkgKi8KPiAtCXJldCA9IGdlbjhfY29uZmlndXJlX2FsbF9jb250ZXh0cyhkZXZfcHJpdiwgb2Ff
Y29uZmlnKTsKPiArCXJldCA9IGdlbjhfY29uZmlndXJlX2FsbF9jb250ZXh0cyhpOTE1LCBvYV9j
b25maWcpOwo+ICAgCWlmIChyZXQpCj4gICAJCXJldHVybiByZXQ7Cj4gICAKPiAtCWNvbmZpZ19v
YV9yZWdzKGRldl9wcml2LCBvYV9jb25maWctPm11eF9yZWdzLCBvYV9jb25maWctPm11eF9yZWdz
X2xlbik7Cj4gKwljb25maWdfb2FfcmVncyhpOTE1LCBvYV9jb25maWctPm11eF9yZWdzLCBvYV9j
b25maWctPm11eF9yZWdzX2xlbik7Cj4gICAKPiAtCWNvbmZpZ19vYV9yZWdzKGRldl9wcml2LCBv
YV9jb25maWctPmJfY291bnRlcl9yZWdzLAo+ICsJY29uZmlnX29hX3JlZ3MoaTkxNSwgb2FfY29u
ZmlnLT5iX2NvdW50ZXJfcmVncywKPiAgIAkJICAgICAgIG9hX2NvbmZpZy0+Yl9jb3VudGVyX3Jl
Z3NfbGVuKTsKPiAgIAo+ICAgCXJldHVybiAwOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGdl
bjhfZGlzYWJsZV9tZXRyaWNfc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiArc3RhdGljIHZvaWQgZ2VuOF9kaXNhYmxlX21ldHJpY19zZXQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJLyogUmVzZXQgYWxsIGNvbnRleHRzJyBzbGljZXMvc3Vi
c2xpY2VzIGNvbmZpZ3VyYXRpb25zLiAqLwo+IC0JZ2VuOF9jb25maWd1cmVfYWxsX2NvbnRleHRz
KGRldl9wcml2LCBOVUxMKTsKPiArCWdlbjhfY29uZmlndXJlX2FsbF9jb250ZXh0cyhpOTE1LCBO
VUxMKTsKPiAgIAo+ICAgCUk5MTVfV1JJVEUoR0RUX0NISUNLRU5fQklUUywgKEk5MTVfUkVBRChH
RFRfQ0hJQ0tFTl9CSVRTKSAmCj4gICAJCQkJICAgICAgfkdUX05PQV9FTkFCTEUpKTsKPiAgIH0K
PiAgIAo+IC1zdGF0aWMgdm9pZCBnZW4xMF9kaXNhYmxlX21ldHJpY19zZXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBnZW4xMF9kaXNhYmxlX21ldHJp
Y19zZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJLyogUmVzZXQg
YWxsIGNvbnRleHRzJyBzbGljZXMvc3Vic2xpY2VzIGNvbmZpZ3VyYXRpb25zLiAqLwo+IC0JZ2Vu
OF9jb25maWd1cmVfYWxsX2NvbnRleHRzKGRldl9wcml2LCBOVUxMKTsKPiArCWdlbjhfY29uZmln
dXJlX2FsbF9jb250ZXh0cyhpOTE1LCBOVUxMKTsKPiAgIAo+ICAgCS8qIE1ha2Ugc3VyZSB3ZSBk
aXNhYmxlIG5vYSB0byBzYXZlIHBvd2VyLiAqLwo+ICAgCUk5MTVfV1JJVEUoUlBNX0NPTkZJRzEs
Cj4gQEAgLTE4NjUsMTIgKzE4NjUsMTIgQEAgc3RhdGljIHZvaWQgZ2VuMTBfZGlzYWJsZV9tZXRy
aWNfc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAo+ICAgc3RhdGlj
IHZvaWQgZ2VuN19vYV9lbmFibGUoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSkKPiAg
IHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHN0cmVhbS0+ZGV2X3By
aXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHN0cmVhbS0+aTkxNTsKPiAg
IAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4ID0gc3RyZWFtLT5jdHg7Cj4gLQl1MzIgY3R4
X2lkID0gZGV2X3ByaXYtPnBlcmYub2Euc3BlY2lmaWNfY3R4X2lkOwo+IC0JYm9vbCBwZXJpb2Rp
YyA9IGRldl9wcml2LT5wZXJmLm9hLnBlcmlvZGljOwo+IC0JdTMyIHBlcmlvZF9leHBvbmVudCA9
IGRldl9wcml2LT5wZXJmLm9hLnBlcmlvZF9leHBvbmVudDsKPiAtCXUzMiByZXBvcnRfZm9ybWF0
ID0gZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLmZvcm1hdDsKPiArCXUzMiBjdHhfaWQgPSBp
OTE1LT5wZXJmLm9hLnNwZWNpZmljX2N0eF9pZDsKPiArCWJvb2wgcGVyaW9kaWMgPSBpOTE1LT5w
ZXJmLm9hLnBlcmlvZGljOwo+ICsJdTMyIHBlcmlvZF9leHBvbmVudCA9IGk5MTUtPnBlcmYub2Eu
cGVyaW9kX2V4cG9uZW50Owo+ICsJdTMyIHJlcG9ydF9mb3JtYXQgPSBpOTE1LT5wZXJmLm9hLm9h
X2J1ZmZlci5mb3JtYXQ7Cj4gICAKPiAgIAkvKgo+ICAgCSAqIFJlc2V0IGJ1ZiBwb2ludGVycyBz
byB3ZSBkb24ndCBmb3J3YXJkIHJlcG9ydHMgZnJvbSBiZWZvcmUgbm93Lgo+IEBAIC0xODgxLDcg
KzE4ODEsNyBAQCBzdGF0aWMgdm9pZCBnZW43X29hX2VuYWJsZShzdHJ1Y3QgaTkxNV9wZXJmX3N0
cmVhbSAqc3RyZWFtKQo+ICAgCSAqIG9uIHRoZSBhc3N1bXB0aW9uIHRoYXQgY2VydGFpbiBmaWVs
ZHMgYXJlIHdyaXR0ZW4gdG8gemVyb2VkCj4gICAJICogbWVtb3J5IHdoaWNoIHRoaXMgaGVscHMg
bWFpbnRhaW5zLgo+ICAgCSAqLwo+IC0JZ2VuN19pbml0X29hX2J1ZmZlcihkZXZfcHJpdik7Cj4g
KwlnZW43X2luaXRfb2FfYnVmZmVyKGk5MTUpOwo+ICAgCj4gICAJSTkxNV9XUklURShHRU43X09B
Q09OVFJPTCwKPiAgIAkJICAgKGN0eF9pZCAmIEdFTjdfT0FDT05UUk9MX0NUWF9NQVNLKSB8Cj4g
QEAgLTE4OTUsOCArMTg5NSw4IEBAIHN0YXRpYyB2b2lkIGdlbjdfb2FfZW5hYmxlKHN0cnVjdCBp
OTE1X3BlcmZfc3RyZWFtICpzdHJlYW0pCj4gICAKPiAgIHN0YXRpYyB2b2lkIGdlbjhfb2FfZW5h
YmxlKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0pCj4gICB7Cj4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBzdHJlYW0tPmRldl9wcml2Owo+IC0JdTMyIHJlcG9y
dF9mb3JtYXQgPSBkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIuZm9ybWF0Owo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBzdHJlYW0tPmk5MTU7Cj4gKwl1MzIgcmVwb3J0X2Zv
cm1hdCA9IGk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLmZvcm1hdDsKPiAgIAo+ICAgCS8qCj4gICAJ
ICogUmVzZXQgYnVmIHBvaW50ZXJzIHNvIHdlIGRvbid0IGZvcndhcmQgcmVwb3J0cyBmcm9tIGJl
Zm9yZSBub3cuCj4gQEAgLTE5MDcsNyArMTkwNyw3IEBAIHN0YXRpYyB2b2lkIGdlbjhfb2FfZW5h
YmxlKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0pCj4gICAJICogb24gdGhlIGFzc3Vt
cHRpb24gdGhhdCBjZXJ0YWluIGZpZWxkcyBhcmUgd3JpdHRlbiB0byB6ZXJvZWQKPiAgIAkgKiBt
ZW1vcnkgd2hpY2ggdGhpcyBoZWxwcyBtYWludGFpbnMuCj4gICAJICovCj4gLQlnZW44X2luaXRf
b2FfYnVmZmVyKGRldl9wcml2KTsKPiArCWdlbjhfaW5pdF9vYV9idWZmZXIoaTkxNSk7Cj4gICAK
PiAgIAkvKgo+ICAgCSAqIE5vdGU6IHdlIGRvbid0IHJlbHkgb24gdGhlIGhhcmR3YXJlIHRvIHBl
cmZvcm0gc2luZ2xlIGNvbnRleHQKPiBAQCAtMTkzMCwxOSArMTkzMCwxOSBAQCBzdGF0aWMgdm9p
ZCBnZW44X29hX2VuYWJsZShzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtKQo+ICAgICov
Cj4gICBzdGF0aWMgdm9pZCBpOTE1X29hX3N0cmVhbV9lbmFibGUoc3RydWN0IGk5MTVfcGVyZl9z
dHJlYW0gKnN0cmVhbSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHN0cmVhbS0+ZGV2X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHN0cmVhbS0+aTkxNTsKPiAgIAo+IC0JZGV2X3ByaXYtPnBlcmYub2Eub3BzLm9hX2VuYWJsZShz
dHJlYW0pOwo+ICsJaTkxNS0+cGVyZi5vYS5vcHMub2FfZW5hYmxlKHN0cmVhbSk7Cj4gICAKPiAt
CWlmIChkZXZfcHJpdi0+cGVyZi5vYS5wZXJpb2RpYykKPiAtCQlocnRpbWVyX3N0YXJ0KCZkZXZf
cHJpdi0+cGVyZi5vYS5wb2xsX2NoZWNrX3RpbWVyLAo+ICsJaWYgKGk5MTUtPnBlcmYub2EucGVy
aW9kaWMpCj4gKwkJaHJ0aW1lcl9zdGFydCgmaTkxNS0+cGVyZi5vYS5wb2xsX2NoZWNrX3RpbWVy
LAo+ICAgCQkJICAgICAgbnNfdG9fa3RpbWUoUE9MTF9QRVJJT0QpLAo+ICAgCQkJICAgICAgSFJU
SU1FUl9NT0RFX1JFTF9QSU5ORUQpOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZCBnZW43X29h
X2Rpc2FibGUoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSkKPiAgIHsKPiAtCXN0cnVj
dCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZzdHJlYW0tPmRldl9wcml2LT51bmNvcmU7Cj4gKwlz
dHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmc3RyZWFtLT5pOTE1LT51bmNvcmU7Cj4gICAK
PiAgIAlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBHRU43X09BQ09OVFJPTCwgMCk7Cj4gICAJ
aWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKHVuY29yZSwKPiBAQCAtMTk1Myw3ICsxOTUzLDcg
QEAgc3RhdGljIHZvaWQgZ2VuN19vYV9kaXNhYmxlKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpz
dHJlYW0pCj4gICAKPiAgIHN0YXRpYyB2b2lkIGdlbjhfb2FfZGlzYWJsZShzdHJ1Y3QgaTkxNV9w
ZXJmX3N0cmVhbSAqc3RyZWFtKQo+ICAgewo+IC0Jc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3Jl
ID0gJnN0cmVhbS0+ZGV2X3ByaXYtPnVuY29yZTsKPiArCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVu
Y29yZSA9ICZzdHJlYW0tPmk5MTUtPnVuY29yZTsKPiAgIAo+ICAgCWludGVsX3VuY29yZV93cml0
ZSh1bmNvcmUsIEdFTjhfT0FDT05UUk9MLCAwKTsKPiAgIAlpZiAoaW50ZWxfd2FpdF9mb3JfcmVn
aXN0ZXIodW5jb3JlLAo+IEBAIC0xOTcyLDEyICsxOTcyLDEyIEBAIHN0YXRpYyB2b2lkIGdlbjhf
b2FfZGlzYWJsZShzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtKQo+ICAgICovCj4gICBz
dGF0aWMgdm9pZCBpOTE1X29hX3N0cmVhbV9kaXNhYmxlKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFt
ICpzdHJlYW0pCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBz
dHJlYW0tPmRldl9wcml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBzdHJl
YW0tPmk5MTU7Cj4gICAKPiAtCWRldl9wcml2LT5wZXJmLm9hLm9wcy5vYV9kaXNhYmxlKHN0cmVh
bSk7Cj4gKwlpOTE1LT5wZXJmLm9hLm9wcy5vYV9kaXNhYmxlKHN0cmVhbSk7Cj4gICAKPiAtCWlm
IChkZXZfcHJpdi0+cGVyZi5vYS5wZXJpb2RpYykKPiAtCQlocnRpbWVyX2NhbmNlbCgmZGV2X3By
aXYtPnBlcmYub2EucG9sbF9jaGVja190aW1lcik7Cj4gKwlpZiAoaTkxNS0+cGVyZi5vYS5wZXJp
b2RpYykKPiArCQlocnRpbWVyX2NhbmNlbCgmaTkxNS0+cGVyZi5vYS5wb2xsX2NoZWNrX3RpbWVy
KTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtX29w
cyBpOTE1X29hX3N0cmVhbV9vcHMgPSB7Cj4gQEAgLTIwMTEsNyArMjAxMSw3IEBAIHN0YXRpYyBp
bnQgaTkxNV9vYV9zdHJlYW1faW5pdChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtLAo+
ICAgCQkJICAgICAgIHN0cnVjdCBkcm1faTkxNV9wZXJmX29wZW5fcGFyYW0gKnBhcmFtLAo+ICAg
CQkJICAgICAgIHN0cnVjdCBwZXJmX29wZW5fcHJvcGVydGllcyAqcHJvcHMpCj4gICB7Cj4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBzdHJlYW0tPmRldl9wcml2Owo+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBzdHJlYW0tPmk5MTU7Cj4gICAJaW50IGZv
cm1hdF9zaXplOwo+ICAgCWludCByZXQ7Cj4gICAKPiBAQCAtMjAxOSw3ICsyMDE5LDcgQEAgc3Rh
dGljIGludCBpOTE1X29hX3N0cmVhbV9pbml0KHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJl
YW0sCj4gICAJICogcmVhc29uIHRoZW4gZG9uJ3QgbGV0IHVzZXJzcGFjZSB0cnkgdGhlaXIgbHVj
ayB3aXRoIGNvbmZpZwo+ICAgCSAqIElEcwo+ICAgCSAqLwo+IC0JaWYgKCFkZXZfcHJpdi0+cGVy
Zi5tZXRyaWNzX2tvYmopIHsKPiArCWlmICghaTkxNS0+cGVyZi5tZXRyaWNzX2tvYmopIHsKPiAg
IAkJRFJNX0RFQlVHKCJPQSBtZXRyaWNzIHdlcmVuJ3QgYWR2ZXJ0aXNlZCB2aWEgc3lzZnNcbiIp
Owo+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiAgIAl9Cj4gQEAgLTIwMjksNyArMjAyOSw3IEBAIHN0
YXRpYyBpbnQgaTkxNV9vYV9zdHJlYW1faW5pdChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3Ry
ZWFtLAo+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiAgIAl9Cj4gICAKPiAtCWlmICghZGV2X3ByaXYt
PnBlcmYub2Eub3BzLmVuYWJsZV9tZXRyaWNfc2V0KSB7Cj4gKwlpZiAoIWk5MTUtPnBlcmYub2Eu
b3BzLmVuYWJsZV9tZXRyaWNfc2V0KSB7Cj4gICAJCURSTV9ERUJVRygiT0EgdW5pdCBub3Qgc3Vw
cG9ydGVkXG4iKTsKPiAgIAkJcmV0dXJuIC1FTk9ERVY7Cj4gICAJfQo+IEBAIC0yMDM4LDcgKzIw
MzgsNyBAQCBzdGF0aWMgaW50IGk5MTVfb2Ffc3RyZWFtX2luaXQoc3RydWN0IGk5MTVfcGVyZl9z
dHJlYW0gKnN0cmVhbSwKPiAgIAkgKiBjb3VudGVyIHJlcG9ydHMgYW5kIG1hcnNoYWwgdG8gdGhl
IGFwcHJvcHJpYXRlIGNsaWVudAo+ICAgCSAqIHdlIGN1cnJlbnRseSBvbmx5IGFsbG93IGV4Y2x1
c2l2ZSBhY2Nlc3MKPiAgIAkgKi8KPiAtCWlmIChkZXZfcHJpdi0+cGVyZi5vYS5leGNsdXNpdmVf
c3RyZWFtKSB7Cj4gKwlpZiAoaTkxNS0+cGVyZi5vYS5leGNsdXNpdmVfc3RyZWFtKSB7Cj4gICAJ
CURSTV9ERUJVRygiT0EgdW5pdCBhbHJlYWR5IGluIHVzZVxuIik7Cj4gICAJCXJldHVybiAtRUJV
U1k7Cj4gICAJfQo+IEBAIC0yMDU5LDMyICsyMDU5LDMyIEBAIHN0YXRpYyBpbnQgaTkxNV9vYV9z
dHJlYW1faW5pdChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtLAo+ICAgCSAqCj4gICAJ
ICogVXNpbmcgdGhlIHNhbWUgbGltaXRpbmcgZmFjdG9ycyBhcyBwcmludGtfcmF0ZWxpbWl0KCkK
PiAgIAkgKi8KPiAtCXJhdGVsaW1pdF9zdGF0ZV9pbml0KCZkZXZfcHJpdi0+cGVyZi5vYS5zcHVy
aW91c19yZXBvcnRfcnMsCj4gKwlyYXRlbGltaXRfc3RhdGVfaW5pdCgmaTkxNS0+cGVyZi5vYS5z
cHVyaW91c19yZXBvcnRfcnMsCj4gICAJCQkgICAgIDUgKiBIWiwgMTApOwo+ICAgCS8qIFNpbmNl
IHdlIHVzZSBhIERSTV9OT1RFIGZvciBzcHVyaW91cyByZXBvcnRzIGl0IHdvdWxkIGJlCj4gICAJ
ICogaW5jb25zaXN0ZW50IHRvIGxldCBfX3JhdGVsaW1pdCgpIGF1dG9tYXRpY2FsbHkgcHJpbnQg
YSB3YXJuaW5nIGZvcgo+ICAgCSAqIHRocm90dGxpbmcuCj4gICAJICovCj4gLQlyYXRlbGltaXRf
c2V0X2ZsYWdzKCZkZXZfcHJpdi0+cGVyZi5vYS5zcHVyaW91c19yZXBvcnRfcnMsCj4gKwlyYXRl
bGltaXRfc2V0X2ZsYWdzKCZpOTE1LT5wZXJmLm9hLnNwdXJpb3VzX3JlcG9ydF9ycywKPiAgIAkJ
CSAgICBSQVRFTElNSVRfTVNHX09OX1JFTEVBU0UpOwo+ICAgCj4gICAJc3RyZWFtLT5zYW1wbGVf
c2l6ZSA9IHNpemVvZihzdHJ1Y3QgZHJtX2k5MTVfcGVyZl9yZWNvcmRfaGVhZGVyKTsKPiAgIAo+
IC0JZm9ybWF0X3NpemUgPSBkZXZfcHJpdi0+cGVyZi5vYS5vYV9mb3JtYXRzW3Byb3BzLT5vYV9m
b3JtYXRdLnNpemU7Cj4gKwlmb3JtYXRfc2l6ZSA9IGk5MTUtPnBlcmYub2Eub2FfZm9ybWF0c1tw
cm9wcy0+b2FfZm9ybWF0XS5zaXplOwo+ICAgCj4gICAJc3RyZWFtLT5zYW1wbGVfZmxhZ3MgfD0g
U0FNUExFX09BX1JFUE9SVDsKPiAgIAlzdHJlYW0tPnNhbXBsZV9zaXplICs9IGZvcm1hdF9zaXpl
Owo+ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIuZm9ybWF0X3NpemUgPSBmb3Jt
YXRfc2l6ZTsKPiAtCWlmIChXQVJOX09OKGRldl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZlci5mb3Jt
YXRfc2l6ZSA9PSAwKSkKPiArCWk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLmZvcm1hdF9zaXplID0g
Zm9ybWF0X3NpemU7Cj4gKwlpZiAoV0FSTl9PTihpOTE1LT5wZXJmLm9hLm9hX2J1ZmZlci5mb3Jt
YXRfc2l6ZSA9PSAwKSkKPiAgIAkJcmV0dXJuIC1FSU5WQUw7Cj4gICAKPiAtCWRldl9wcml2LT5w
ZXJmLm9hLm9hX2J1ZmZlci5mb3JtYXQgPQo+IC0JCWRldl9wcml2LT5wZXJmLm9hLm9hX2Zvcm1h
dHNbcHJvcHMtPm9hX2Zvcm1hdF0uZm9ybWF0Owo+ICsJaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIu
Zm9ybWF0ID0KPiArCQlpOTE1LT5wZXJmLm9hLm9hX2Zvcm1hdHNbcHJvcHMtPm9hX2Zvcm1hdF0u
Zm9ybWF0Owo+ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5vYS5wZXJpb2RpYyA9IHByb3BzLT5vYV9w
ZXJpb2RpYzsKPiAtCWlmIChkZXZfcHJpdi0+cGVyZi5vYS5wZXJpb2RpYykKPiAtCQlkZXZfcHJp
di0+cGVyZi5vYS5wZXJpb2RfZXhwb25lbnQgPSBwcm9wcy0+b2FfcGVyaW9kX2V4cG9uZW50Owo+
ICsJaTkxNS0+cGVyZi5vYS5wZXJpb2RpYyA9IHByb3BzLT5vYV9wZXJpb2RpYzsKPiArCWlmIChp
OTE1LT5wZXJmLm9hLnBlcmlvZGljKQo+ICsJCWk5MTUtPnBlcmYub2EucGVyaW9kX2V4cG9uZW50
ID0gcHJvcHMtPm9hX3BlcmlvZF9leHBvbmVudDsKPiAgIAo+ICAgCWlmIChzdHJlYW0tPmN0eCkg
ewo+ICAgCQlyZXQgPSBvYV9nZXRfcmVuZGVyX2N0eF9pZChzdHJlYW0pOwo+IEBAIC0yMDk0LDcg
KzIwOTQsNyBAQCBzdGF0aWMgaW50IGk5MTVfb2Ffc3RyZWFtX2luaXQoc3RydWN0IGk5MTVfcGVy
Zl9zdHJlYW0gKnN0cmVhbSwKPiAgIAkJfQo+ICAgCX0KPiAgIAo+IC0JcmV0ID0gZ2V0X29hX2Nv
bmZpZyhkZXZfcHJpdiwgcHJvcHMtPm1ldHJpY3Nfc2V0LCAmc3RyZWFtLT5vYV9jb25maWcpOwo+
ICsJcmV0ID0gZ2V0X29hX2NvbmZpZyhpOTE1LCBwcm9wcy0+bWV0cmljc19zZXQsICZzdHJlYW0t
Pm9hX2NvbmZpZyk7Cj4gICAJaWYgKHJldCkgewo+ICAgCQlEUk1fREVCVUcoIkludmFsaWQgT0Eg
Y29uZmlnIGlkPSVpXG4iLCBwcm9wcy0+bWV0cmljc19zZXQpOwo+ICAgCQlnb3RvIGVycl9jb25m
aWc7Cj4gQEAgLTIxMTIsNDMgKzIxMTIsNDMgQEAgc3RhdGljIGludCBpOTE1X29hX3N0cmVhbV9p
bml0KHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0sCj4gICAJICogICBJbiBvdXIgY2Fz
ZSB3ZSBhcmUgZXhwZWN0aW5nIHRoYXQgdGFraW5nIHBtICsgRk9SQ0VXQUtFCj4gICAJICogICBy
ZWZlcmVuY2VzIHdpbGwgZWZmZWN0aXZlbHkgZGlzYWJsZSBSQzYuCj4gICAJICovCj4gLQlzdHJl
YW0tPndha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7Cj4gLQlpbnRlbF91
bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4g
KwlzdHJlYW0tPndha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKPiArCWludGVs
X3VuY29yZV9mb3JjZXdha2VfZ2V0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ICAg
Cj4gLQlyZXQgPSBhbGxvY19vYV9idWZmZXIoZGV2X3ByaXYpOwo+ICsJcmV0ID0gYWxsb2Nfb2Ff
YnVmZmVyKGk5MTUpOwo+ICAgCWlmIChyZXQpCj4gICAJCWdvdG8gZXJyX29hX2J1Zl9hbGxvYzsK
PiAgIAo+IC0JcmV0ID0gaTkxNV9tdXRleF9sb2NrX2ludGVycnVwdGlibGUoJmRldl9wcml2LT5k
cm0pOwo+ICsJcmV0ID0gaTkxNV9tdXRleF9sb2NrX2ludGVycnVwdGlibGUoJmk5MTUtPmRybSk7
Cj4gICAJaWYgKHJldCkKPiAgIAkJZ290byBlcnJfbG9jazsKPiAgIAo+ICAgCXN0cmVhbS0+b3Bz
ID0gJmk5MTVfb2Ffc3RyZWFtX29wczsKPiAtCWRldl9wcml2LT5wZXJmLm9hLmV4Y2x1c2l2ZV9z
dHJlYW0gPSBzdHJlYW07Cj4gKwlpOTE1LT5wZXJmLm9hLmV4Y2x1c2l2ZV9zdHJlYW0gPSBzdHJl
YW07Cj4gICAKPiAtCXJldCA9IGRldl9wcml2LT5wZXJmLm9hLm9wcy5lbmFibGVfbWV0cmljX3Nl
dChzdHJlYW0pOwo+ICsJcmV0ID0gaTkxNS0+cGVyZi5vYS5vcHMuZW5hYmxlX21ldHJpY19zZXQo
c3RyZWFtKTsKPiAgIAlpZiAocmV0KSB7Cj4gICAJCURSTV9ERUJVRygiVW5hYmxlIHRvIGVuYWJs
ZSBtZXRyaWMgc2V0XG4iKTsKPiAgIAkJZ290byBlcnJfZW5hYmxlOwo+ICAgCX0KPiAgIAo+IC0J
bXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gKwltdXRleF91bmxv
Y2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCj4gICAJcmV0dXJuIDA7Cj4gICAKPiAg
IGVycl9lbmFibGU6Cj4gLQlkZXZfcHJpdi0+cGVyZi5vYS5leGNsdXNpdmVfc3RyZWFtID0gTlVM
TDsKPiAtCWRldl9wcml2LT5wZXJmLm9hLm9wcy5kaXNhYmxlX21ldHJpY19zZXQoZGV2X3ByaXYp
Owo+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gKwlpOTE1
LT5wZXJmLm9hLmV4Y2x1c2l2ZV9zdHJlYW0gPSBOVUxMOwo+ICsJaTkxNS0+cGVyZi5vYS5vcHMu
ZGlzYWJsZV9tZXRyaWNfc2V0KGk5MTUpOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3Ry
dWN0X211dGV4KTsKPiAgIAo+ICAgZXJyX2xvY2s6Cj4gLQlmcmVlX29hX2J1ZmZlcihkZXZfcHJp
dik7Cj4gKwlmcmVlX29hX2J1ZmZlcihpOTE1KTsKPiAgIAo+ICAgZXJyX29hX2J1Zl9hbGxvYzoK
PiAtCXB1dF9vYV9jb25maWcoZGV2X3ByaXYsIHN0cmVhbS0+b2FfY29uZmlnKTsKPiArCXB1dF9v
YV9jb25maWcoaTkxNSwgc3RyZWFtLT5vYV9jb25maWcpOwo+ICAgCj4gLQlpbnRlbF91bmNvcmVf
Zm9yY2V3YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gLQlpbnRl
bF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgc3RyZWFtLT53YWtlcmVmKTsKPiArCWludGVsX3Vu
Y29yZV9mb3JjZXdha2VfcHV0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ICsJaW50
ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgc3RyZWFtLT53YWtlcmVmKTsKPiAgIAo+ICAgZXJyX2Nv
bmZpZzoKPiAgIAlpZiAoc3RyZWFtLT5jdHgpCj4gQEAgLTIyMzgsNyArMjIzOCw3IEBAIHN0YXRp
YyBzc2l6ZV90IGk5MTVfcGVyZl9yZWFkKHN0cnVjdCBmaWxlICpmaWxlLAo+ICAgCQkJICAgICAg
bG9mZl90ICpwcG9zKQo+ICAgewo+ICAgCXN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0g
PSBmaWxlLT5wcml2YXRlX2RhdGE7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSBzdHJlYW0tPmRldl9wcml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSBzdHJlYW0tPmk5MTU7Cj4gICAJc3NpemVfdCByZXQ7Cj4gICAKPiAgIAkvKiBUbyBlbnN1cmUg
aXQncyBoYW5kbGVkIGNvbnNpc3RlbnRseSB3ZSBzaW1wbHkgdHJlYXQgYWxsIHJlYWRzIG9mIGEK
PiBAQCAtMjI2MSwxNSArMjI2MSwxNSBAQCBzdGF0aWMgc3NpemVfdCBpOTE1X3BlcmZfcmVhZChz
dHJ1Y3QgZmlsZSAqZmlsZSwKPiAgIAkJCWlmIChyZXQpCj4gICAJCQkJcmV0dXJuIHJldDsKPiAg
IAo+IC0JCQltdXRleF9sb2NrKCZkZXZfcHJpdi0+cGVyZi5sb2NrKTsKPiArCQkJbXV0ZXhfbG9j
aygmaTkxNS0+cGVyZi5sb2NrKTsKPiAgIAkJCXJldCA9IGk5MTVfcGVyZl9yZWFkX2xvY2tlZChz
dHJlYW0sIGZpbGUsCj4gICAJCQkJCQkgICAgYnVmLCBjb3VudCwgcHBvcyk7Cj4gLQkJCW11dGV4
X3VubG9jaygmZGV2X3ByaXYtPnBlcmYubG9jayk7Cj4gKwkJCW11dGV4X3VubG9jaygmaTkxNS0+
cGVyZi5sb2NrKTsKPiAgIAkJfSB3aGlsZSAocmV0ID09IC1FQUdBSU4pOwo+ICAgCX0gZWxzZSB7
Cj4gLQkJbXV0ZXhfbG9jaygmZGV2X3ByaXYtPnBlcmYubG9jayk7Cj4gKwkJbXV0ZXhfbG9jaygm
aTkxNS0+cGVyZi5sb2NrKTsKPiAgIAkJcmV0ID0gaTkxNV9wZXJmX3JlYWRfbG9ja2VkKHN0cmVh
bSwgZmlsZSwgYnVmLCBjb3VudCwgcHBvcyk7Cj4gLQkJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+
cGVyZi5sb2NrKTsKPiArCQltdXRleF91bmxvY2soJmk5MTUtPnBlcmYubG9jayk7Cj4gICAJfQo+
ICAgCj4gICAJLyogV2UgYWxsb3cgdGhlIHBvbGwgY2hlY2tpbmcgdG8gc29tZXRpbWVzIHJlcG9y
dCBmYWxzZSBwb3NpdGl2ZSBFUE9MTElOCj4gQEAgLTIyODQsNyArMjI4NCw3IEBAIHN0YXRpYyBz
c2l6ZV90IGk5MTVfcGVyZl9yZWFkKHN0cnVjdCBmaWxlICpmaWxlLAo+ICAgCQkvKiBNYXliZSBt
YWtlIC0+cG9sbGluIHBlci1zdHJlYW0gc3RhdGUgaWYgd2Ugc3VwcG9ydCBtdWx0aXBsZQo+ICAg
CQkgKiBjb25jdXJyZW50IHN0cmVhbXMgaW4gdGhlIGZ1dHVyZS4KPiAgIAkJICovCj4gLQkJZGV2
X3ByaXYtPnBlcmYub2EucG9sbGluID0gZmFsc2U7Cj4gKwkJaTkxNS0+cGVyZi5vYS5wb2xsaW4g
PSBmYWxzZTsKPiAgIAl9Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+IEBAIC0yMjkyLDEzICsyMjky
LDEzIEBAIHN0YXRpYyBzc2l6ZV90IGk5MTVfcGVyZl9yZWFkKHN0cnVjdCBmaWxlICpmaWxlLAo+
ICAgCj4gICBzdGF0aWMgZW51bSBocnRpbWVyX3Jlc3RhcnQgb2FfcG9sbF9jaGVja190aW1lcl9j
YihzdHJ1Y3QgaHJ0aW1lciAqaHJ0aW1lcikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9Cj4gLQkJY29udGFpbmVyX29mKGhydGltZXIsIHR5cGVvZigqZGV2X3By
aXYpLAo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPQo+ICsJCWNvbnRhaW5lcl9v
ZihocnRpbWVyLCB0eXBlb2YoKmk5MTUpLAo+ICAgCQkJICAgICBwZXJmLm9hLnBvbGxfY2hlY2tf
dGltZXIpOwo+ICAgCj4gLQlpZiAob2FfYnVmZmVyX2NoZWNrX3VubG9ja2VkKGRldl9wcml2KSkg
ewo+IC0JCWRldl9wcml2LT5wZXJmLm9hLnBvbGxpbiA9IHRydWU7Cj4gLQkJd2FrZV91cCgmZGV2
X3ByaXYtPnBlcmYub2EucG9sbF93cSk7Cj4gKwlpZiAob2FfYnVmZmVyX2NoZWNrX3VubG9ja2Vk
KGk5MTUpKSB7Cj4gKwkJaTkxNS0+cGVyZi5vYS5wb2xsaW4gPSB0cnVlOwo+ICsJCXdha2VfdXAo
Jmk5MTUtPnBlcmYub2EucG9sbF93cSk7Cj4gICAJfQo+ICAgCj4gICAJaHJ0aW1lcl9mb3J3YXJk
X25vdyhocnRpbWVyLCBuc190b19rdGltZShQT0xMX1BFUklPRCkpOwo+IEBAIC0yMzA4LDcgKzIz
MDgsNyBAQCBzdGF0aWMgZW51bSBocnRpbWVyX3Jlc3RhcnQgb2FfcG9sbF9jaGVja190aW1lcl9j
YihzdHJ1Y3QgaHJ0aW1lciAqaHJ0aW1lcikKPiAgIAo+ICAgLyoqCj4gICAgKiBpOTE1X3BlcmZf
cG9sbF9sb2NrZWQgLSBwb2xsX3dhaXQoKSB3aXRoIGEgc3VpdGFibGUgd2FpdCBxdWV1ZSBmb3Ig
c3RyZWFtCj4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiArICogQGk5MTU6
IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gICAgKiBAc3RyZWFtOiBBbiBpOTE1IHBlcmYgc3RyZWFt
Cj4gICAgKiBAZmlsZTogQW4gaTkxNSBwZXJmIHN0cmVhbSBmaWxlCj4gICAgKiBAd2FpdDogcG9s
bCgpIHN0YXRlIHRhYmxlCj4gQEAgLTIzMjIsNyArMjMyMiw3IEBAIHN0YXRpYyBlbnVtIGhydGlt
ZXJfcmVzdGFydCBvYV9wb2xsX2NoZWNrX3RpbWVyX2NiKHN0cnVjdCBocnRpbWVyICpocnRpbWVy
KQo+ICAgICoKPiAgICAqIFJldHVybnM6IGFueSBwb2xsIGV2ZW50cyB0aGF0IGFyZSByZWFkeSB3
aXRob3V0IHNsZWVwaW5nCj4gICAgKi8KPiAtc3RhdGljIF9fcG9sbF90IGk5MTVfcGVyZl9wb2xs
X2xvY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBfX3Bv
bGxfdCBpOTE1X3BlcmZfcG9sbF9sb2NrZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gICAJCQkJCSAgc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSwKPiAgIAkJCQkJICBz
dHJ1Y3QgZmlsZSAqZmlsZSwKPiAgIAkJCQkJICBwb2xsX3RhYmxlICp3YWl0KQo+IEBAIC0yMzM3
LDcgKzIzMzcsNyBAQCBzdGF0aWMgX19wb2xsX3QgaTkxNV9wZXJmX3BvbGxfbG9ja2VkKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkgKiB0aGUgaHJ0aW1lci9vYV9wb2xs
X2NoZWNrX3RpbWVyX2NiIHRvIG5vdGlmeSB1cyB3aGVuIHRoZXJlIGFyZQo+ICAgCSAqIHNhbXBs
ZXMgdG8gcmVhZC4KPiAgIAkgKi8KPiAtCWlmIChkZXZfcHJpdi0+cGVyZi5vYS5wb2xsaW4pCj4g
KwlpZiAoaTkxNS0+cGVyZi5vYS5wb2xsaW4pCj4gICAJCWV2ZW50cyB8PSBFUE9MTElOOwo+ICAg
Cj4gICAJcmV0dXJuIGV2ZW50czsKPiBAQCAtMjM1OSwxMiArMjM1OSwxMiBAQCBzdGF0aWMgX19w
b2xsX3QgaTkxNV9wZXJmX3BvbGxfbG9ja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiAgIHN0YXRpYyBfX3BvbGxfdCBpOTE1X3BlcmZfcG9sbChzdHJ1Y3QgZmlsZSAqZmls
ZSwgcG9sbF90YWJsZSAqd2FpdCkKPiAgIHsKPiAgIAlzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAq
c3RyZWFtID0gZmlsZS0+cHJpdmF0ZV9kYXRhOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gc3RyZWFtLT5kZXZfcHJpdjsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gc3RyZWFtLT5pOTE1Owo+ICAgCV9fcG9sbF90IHJldDsKPiAgIAo+IC0JbXV0ZXhf
bG9jaygmZGV2X3ByaXYtPnBlcmYubG9jayk7Cj4gLQlyZXQgPSBpOTE1X3BlcmZfcG9sbF9sb2Nr
ZWQoZGV2X3ByaXYsIHN0cmVhbSwgZmlsZSwgd2FpdCk7Cj4gLQltdXRleF91bmxvY2soJmRldl9w
cml2LT5wZXJmLmxvY2spOwo+ICsJbXV0ZXhfbG9jaygmaTkxNS0+cGVyZi5sb2NrKTsKPiArCXJl
dCA9IGk5MTVfcGVyZl9wb2xsX2xvY2tlZChpOTE1LCBzdHJlYW0sIGZpbGUsIHdhaXQpOwo+ICsJ
bXV0ZXhfdW5sb2NrKCZpOTE1LT5wZXJmLmxvY2spOwo+ICAgCj4gICAJcmV0dXJuIHJldDsKPiAg
IH0KPiBAQCAtMjQ2MSwxMiArMjQ2MSwxMiBAQCBzdGF0aWMgbG9uZyBpOTE1X3BlcmZfaW9jdGwo
c3RydWN0IGZpbGUgKmZpbGUsCj4gICAJCQkgICAgdW5zaWduZWQgbG9uZyBhcmcpCj4gICB7Cj4g
ICAJc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSA9IGZpbGUtPnByaXZhdGVfZGF0YTsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHN0cmVhbS0+ZGV2X3ByaXY7
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHN0cmVhbS0+aTkxNTsKPiAgIAls
b25nIHJldDsKPiAgIAo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPnBlcmYubG9jayk7Cj4gKwlt
dXRleF9sb2NrKCZpOTE1LT5wZXJmLmxvY2spOwo+ICAgCXJldCA9IGk5MTVfcGVyZl9pb2N0bF9s
b2NrZWQoc3RyZWFtLCBjbWQsIGFyZyk7Cj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5wZXJm
LmxvY2spOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5wZXJmLmxvY2spOwo+ICAgCj4gICAJcmV0
dXJuIHJldDsKPiAgIH0KPiBAQCAtMjUxMSwxMSArMjUxMSwxMSBAQCBzdGF0aWMgdm9pZCBpOTE1
X3BlcmZfZGVzdHJveV9sb2NrZWQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSkKPiAg
IHN0YXRpYyBpbnQgaTkxNV9wZXJmX3JlbGVhc2Uoc3RydWN0IGlub2RlICppbm9kZSwgc3RydWN0
IGZpbGUgKmZpbGUpCj4gICB7Cj4gICAJc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSA9
IGZpbGUtPnByaXZhdGVfZGF0YTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHN0cmVhbS0+ZGV2X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHN0cmVhbS0+aTkxNTsKPiAgIAo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPnBlcmYubG9jayk7
Cj4gKwltdXRleF9sb2NrKCZpOTE1LT5wZXJmLmxvY2spOwo+ICAgCWk5MTVfcGVyZl9kZXN0cm95
X2xvY2tlZChzdHJlYW0pOwo+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+cGVyZi5sb2NrKTsK
PiArCW11dGV4X3VubG9jaygmaTkxNS0+cGVyZi5sb2NrKTsKPiAgIAo+ICAgCXJldHVybiAwOwo+
ICAgfQo+IEBAIC0yNTM3LDcgKzI1MzcsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGZpbGVfb3Bl
cmF0aW9ucyBmb3BzID0gewo+ICAgCj4gICAvKioKPiAgICAqIGk5MTVfcGVyZl9vcGVuX2lvY3Rs
X2xvY2tlZCAtIERSTSBpb2N0bCgpIGZvciB1c2Vyc3BhY2UgdG8gb3BlbiBhIHN0cmVhbSBGRAo+
IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gKyAqIEBpOTE1OiBpOTE1IGRl
dmljZSBpbnN0YW5jZQo+ICAgICogQHBhcmFtOiBUaGUgb3BlbiBwYXJhbWV0ZXJzIHBhc3NlZCB0
byAnRFJNX0k5MTVfUEVSRl9PUEVOYAo+ICAgICogQHByb3BzOiBpbmRpdmlkdWFsbHkgdmFsaWRh
dGVkIHU2NCBwcm9wZXJ0eSB2YWx1ZSBwYWlycwo+ICAgICogQGZpbGU6IGRybSBmaWxlCj4gQEAg
LTI1NjAsNyArMjU2MCw3IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVyYXRpb25zIGZv
cHMgPSB7Cj4gICAgKiBSZXR1cm5zOiB6ZXJvIG9uIHN1Y2Nlc3Mgb3IgYSBuZWdhdGl2ZSBlcnJv
ciBjb2RlLgo+ICAgICovCj4gICBzdGF0aWMgaW50Cj4gLWk5MTVfcGVyZl9vcGVuX2lvY3RsX2xv
Y2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2k5MTVfcGVyZl9vcGVu
X2lvY3RsX2xvY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICBz
dHJ1Y3QgZHJtX2k5MTVfcGVyZl9vcGVuX3BhcmFtICpwYXJhbSwKPiAgIAkJCSAgICBzdHJ1Y3Qg
cGVyZl9vcGVuX3Byb3BlcnRpZXMgKnByb3BzLAo+ICAgCQkJICAgIHN0cnVjdCBkcm1fZmlsZSAq
ZmlsZSkKPiBAQCAtMjU5OSw3ICsyNTk5LDcgQEAgaTkxNV9wZXJmX29wZW5faW9jdGxfbG9ja2Vk
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkgKiBNSV9SRVBPUlRfUEVS
Rl9DT1VOVCBjb21tYW5kcyBhbmQgc28gY29uc2lkZXIgaXQgYSBwcml2aWxlZ2VkIG9wIHRvCj4g
ICAJICogZW5hYmxlIHRoZSBPQSB1bml0IGJ5IGRlZmF1bHQuCj4gICAJICovCj4gLQlpZiAoSVNf
SEFTV0VMTChkZXZfcHJpdikgJiYgc3BlY2lmaWNfY3R4KQo+ICsJaWYgKElTX0hBU1dFTEwoaTkx
NSkgJiYgc3BlY2lmaWNfY3R4KQo+ICAgCQlwcml2aWxlZ2VkX29wID0gZmFsc2U7Cj4gICAKPiAg
IAkvKiBTaW1pbGFyIHRvIHBlcmYncyBrZXJuZWwucGVyZl9wYXJhbm9pZF9jcHUgc3lzY3RsIG9w
dGlvbgo+IEBAIC0yNjIwLDcgKzI2MjAsNyBAQCBpOTE1X3BlcmZfb3Blbl9pb2N0bF9sb2NrZWQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCQlnb3RvIGVycl9jdHg7Cj4g
ICAJfQo+ICAgCj4gLQlzdHJlYW0tPmRldl9wcml2ID0gZGV2X3ByaXY7Cj4gKwlzdHJlYW0tPmk5
MTUgPSBpOTE1Owo+ICAgCXN0cmVhbS0+Y3R4ID0gc3BlY2lmaWNfY3R4Owo+ICAgCj4gICAJcmV0
ID0gaTkxNV9vYV9zdHJlYW1faW5pdChzdHJlYW0sIHBhcmFtLCBwcm9wcyk7Cj4gQEAgLTI2MzYs
NyArMjYzNiw3IEBAIGk5MTVfcGVyZl9vcGVuX2lvY3RsX2xvY2tlZChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJCWdvdG8gZXJyX2ZsYWdzOwo+ICAgCX0KPiAgIAo+IC0J
bGlzdF9hZGQoJnN0cmVhbS0+bGluaywgJmRldl9wcml2LT5wZXJmLnN0cmVhbXMpOwo+ICsJbGlz
dF9hZGQoJnN0cmVhbS0+bGluaywgJmk5MTUtPnBlcmYuc3RyZWFtcyk7Cj4gICAKPiAgIAlpZiAo
cGFyYW0tPmZsYWdzICYgSTkxNV9QRVJGX0ZMQUdfRkRfQ0xPRVhFQykKPiAgIAkJZl9mbGFncyB8
PSBPX0NMT0VYRUM7Cj4gQEAgLTI2NjgsMTUgKzI2NjgsMTUgQEAgaTkxNV9wZXJmX29wZW5faW9j
dGxfbG9ja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlyZXR1cm4g
cmV0Owo+ICAgfQo+ICAgCj4gLXN0YXRpYyB1NjQgb2FfZXhwb25lbnRfdG9fbnMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgZXhwb25lbnQpCj4gK3N0YXRpYyB1NjQgb2Ff
ZXhwb25lbnRfdG9fbnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGludCBleHBvbmVu
dCkKPiAgIHsKPiAgIAlyZXR1cm4gZGl2NjRfdTY0KDEwMDAwMDAwMDBVTEwgKiAoMlVMTCA8PCBl
eHBvbmVudCksCj4gLQkJCSAxMDAwVUxMICogUlVOVElNRV9JTkZPKGRldl9wcml2KS0+Y3NfdGlt
ZXN0YW1wX2ZyZXF1ZW5jeV9raHopOwo+ICsJCQkgMTAwMFVMTCAqIFJVTlRJTUVfSU5GTyhpOTE1
KS0+Y3NfdGltZXN0YW1wX2ZyZXF1ZW5jeV9raHopOwo+ICAgfQo+ICAgCj4gICAvKioKPiAgICAq
IHJlYWRfcHJvcGVydGllc191bmxvY2tlZCAtIHZhbGlkYXRlICsgY29weSB1c2Vyc3BhY2Ugc3Ry
ZWFtIG9wZW4gcHJvcGVydGllcwo+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIGluc3RhbmNl
Cj4gKyAqIEBpOTE1OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ICAgICogQHVwcm9wczogVGhlIGFy
cmF5IG9mIHU2NCBrZXkgdmFsdWUgcGFpcnMgZ2l2ZW4gYnkgdXNlcnNwYWNlCj4gICAgKiBAbl9w
cm9wczogVGhlIG51bWJlciBvZiBrZXkgdmFsdWUgcGFpcnMgZXhwZWN0ZWQgaW4gQHVwcm9wcwo+
ICAgICogQHByb3BzOiBUaGUgc3RyZWFtIGNvbmZpZ3VyYXRpb24gYnVpbHQgdXAgd2hpbGUgdmFs
aWRhdGluZyBwcm9wZXJ0aWVzCj4gQEAgLTI2ODksNyArMjY4OSw3IEBAIHN0YXRpYyB1NjQgb2Ff
ZXhwb25lbnRfdG9fbnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgZXhw
b25lbnQpCj4gICAgKiB3ZSBzaG91bGRuJ3QgdmFsaWRhdGUgb3IgYXNzdW1lIGFueXRoaW5nIGFi
b3V0IG9yZGVyaW5nIGhlcmUuIFRoaXMgZG9lc24ndAo+ICAgICogcnVsZSBvdXQgZGVmaW5pbmcg
bmV3IHByb3BlcnRpZXMgd2l0aCBvcmRlcmluZyByZXF1aXJlbWVudHMgaW4gdGhlIGZ1dHVyZS4K
PiAgICAqLwo+IC1zdGF0aWMgaW50IHJlYWRfcHJvcGVydGllc191bmxvY2tlZChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBpbnQgcmVhZF9wcm9wZXJ0aWVzX3Vu
bG9ja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgICB1NjQgX191
c2VyICp1cHJvcHMsCj4gICAJCQkJICAgIHUzMiBuX3Byb3BzLAo+ICAgCQkJCSAgICBzdHJ1Y3Qg
cGVyZl9vcGVuX3Byb3BlcnRpZXMgKnByb3BzKQo+IEBAIC0yNzU1LDcgKzI3NTUsNyBAQCBzdGF0
aWMgaW50IHJlYWRfcHJvcGVydGllc191bmxvY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gICAJCQkJCSAgdmFsdWUpOwo+ICAgCQkJCXJldHVybiAtRUlOVkFMOwo+ICAg
CQkJfQo+IC0JCQlpZiAoIWRldl9wcml2LT5wZXJmLm9hLm9hX2Zvcm1hdHNbdmFsdWVdLnNpemUp
IHsKPiArCQkJaWYgKCFpOTE1LT5wZXJmLm9hLm9hX2Zvcm1hdHNbdmFsdWVdLnNpemUpIHsKPiAg
IAkJCQlEUk1fREVCVUcoIlVuc3VwcG9ydGVkIE9BIHJlcG9ydCBmb3JtYXQgJWxsdVxuIiwKPiAg
IAkJCQkJICB2YWx1ZSk7Cj4gICAJCQkJcmV0dXJuIC1FSU5WQUw7Cj4gQEAgLTI3NzYsNyArMjc3
Niw3IEBAIHN0YXRpYyBpbnQgcmVhZF9wcm9wZXJ0aWVzX3VubG9ja2VkKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkJCSAqLwo+ICAgCj4gICAJCQlCVUlMRF9CVUdfT04o
c2l6ZW9mKG9hX3BlcmlvZCkgIT0gOCk7Cj4gLQkJCW9hX3BlcmlvZCA9IG9hX2V4cG9uZW50X3Rv
X25zKGRldl9wcml2LCB2YWx1ZSk7Cj4gKwkJCW9hX3BlcmlvZCA9IG9hX2V4cG9uZW50X3RvX25z
KGk5MTUsIHZhbHVlKTsKPiAgIAo+ICAgCQkJLyogVGhpcyBjaGVjayBpcyBwcmltYXJpbHkgdG8g
ZW5zdXJlIHRoYXQgb2FfcGVyaW9kIDw9Cj4gICAJCQkgKiBVSU5UMzJfTUFYIChiZWZvcmUgcGFz
c2luZyB0byBkb19kaXYgd2hpY2ggb25seQo+IEBAIC0yODM5LDEzICsyODM5LDEzIEBAIHN0YXRp
YyBpbnQgcmVhZF9wcm9wZXJ0aWVzX3VubG9ja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiAgIGludCBpOTE1X3BlcmZfb3Blbl9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2LCB2b2lkICpkYXRhLAo+ICAgCQkJIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRldi0+ZGV2X3ByaXZhdGU7Cj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRldi0+ZGV2X3ByaXZhdGU7Cj4gICAJ
c3RydWN0IGRybV9pOTE1X3BlcmZfb3Blbl9wYXJhbSAqcGFyYW0gPSBkYXRhOwo+ICAgCXN0cnVj
dCBwZXJmX29wZW5fcHJvcGVydGllcyBwcm9wczsKPiAgIAl1MzIga25vd25fb3Blbl9mbGFnczsK
PiAgIAlpbnQgcmV0Owo+ICAgCj4gLQlpZiAoIWRldl9wcml2LT5wZXJmLmluaXRpYWxpemVkKSB7
Cj4gKwlpZiAoIWk5MTUtPnBlcmYuaW5pdGlhbGl6ZWQpIHsKPiAgIAkJRFJNX0RFQlVHKCJpOTE1
IHBlcmYgaW50ZXJmYWNlIG5vdCBhdmFpbGFibGUgZm9yIHRoaXMgc3lzdGVtXG4iKTsKPiAgIAkJ
cmV0dXJuIC1FTk9UU1VQUDsKPiAgIAl9Cj4gQEAgLTI4NTgsMTI0ICsyODU4LDEyNCBAQCBpbnQg
aTkxNV9wZXJmX29wZW5faW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwK
PiAgIAkJcmV0dXJuIC1FSU5WQUw7Cj4gICAJfQo+ICAgCj4gLQlyZXQgPSByZWFkX3Byb3BlcnRp
ZXNfdW5sb2NrZWQoZGV2X3ByaXYsCj4gKwlyZXQgPSByZWFkX3Byb3BlcnRpZXNfdW5sb2NrZWQo
aTkxNSwKPiAgIAkJCQkgICAgICAgdTY0X3RvX3VzZXJfcHRyKHBhcmFtLT5wcm9wZXJ0aWVzX3B0
ciksCj4gICAJCQkJICAgICAgIHBhcmFtLT5udW1fcHJvcGVydGllcywKPiAgIAkJCQkgICAgICAg
JnByb3BzKTsKPiAgIAlpZiAocmV0KQo+ICAgCQlyZXR1cm4gcmV0Owo+ICAgCj4gLQltdXRleF9s
b2NrKCZkZXZfcHJpdi0+cGVyZi5sb2NrKTsKPiAtCXJldCA9IGk5MTVfcGVyZl9vcGVuX2lvY3Rs
X2xvY2tlZChkZXZfcHJpdiwgcGFyYW0sICZwcm9wcywgZmlsZSk7Cj4gLQltdXRleF91bmxvY2so
JmRldl9wcml2LT5wZXJmLmxvY2spOwo+ICsJbXV0ZXhfbG9jaygmaTkxNS0+cGVyZi5sb2NrKTsK
PiArCXJldCA9IGk5MTVfcGVyZl9vcGVuX2lvY3RsX2xvY2tlZChpOTE1LCBwYXJhbSwgJnByb3Bz
LCBmaWxlKTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+cGVyZi5sb2NrKTsKPiAgIAo+ICAgCXJl
dHVybiByZXQ7Cj4gICB9Cj4gICAKPiAgIC8qKgo+ICAgICogaTkxNV9wZXJmX3JlZ2lzdGVyIC0g
ZXhwb3NlcyBpOTE1LXBlcmYgdG8gdXNlcnNwYWNlCj4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZp
Y2UgaW5zdGFuY2UKPiArICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gICAgKgo+ICAg
ICogSW4gcGFydGljdWxhciBPQSBtZXRyaWMgc2V0cyBhcmUgYWR2ZXJ0aXNlZCB1bmRlciBhIHN5
c2ZzIG1ldHJpY3MvCj4gICAgKiBkaXJlY3RvcnkgYWxsb3dpbmcgdXNlcnNwYWNlIHRvIGVudW1l
cmF0ZSB2YWxpZCBJRHMgdGhhdCBjYW4gYmUKPiAgICAqIHVzZWQgdG8gb3BlbiBhbiBpOTE1LXBl
cmYgc3RyZWFtLgo+ICAgICovCj4gLXZvaWQgaTkxNV9wZXJmX3JlZ2lzdGVyKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBpOTE1X3BlcmZfcmVnaXN0ZXIoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJaW50IHJldDsKPiAgIAo+IC0JaWYg
KCFkZXZfcHJpdi0+cGVyZi5pbml0aWFsaXplZCkKPiArCWlmICghaTkxNS0+cGVyZi5pbml0aWFs
aXplZCkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJLyogVG8gYmUgc3VyZSB3ZSdyZSBzeW5jaHJv
bml6ZWQgd2l0aCBhbiBhdHRlbXB0ZWQKPiAgIAkgKiBpOTE1X3BlcmZfb3Blbl9pb2N0bCgpOyBj
b25zaWRlcmluZyB0aGF0IHdlIHJlZ2lzdGVyIGFmdGVyCj4gICAJICogYmVpbmcgZXhwb3NlZCB0
byB1c2Vyc3BhY2UuCj4gICAJICovCj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+cGVyZi5sb2Nr
KTsKPiArCW11dGV4X2xvY2soJmk5MTUtPnBlcmYubG9jayk7Cj4gICAKPiAtCWRldl9wcml2LT5w
ZXJmLm1ldHJpY3Nfa29iaiA9Cj4gKwlpOTE1LT5wZXJmLm1ldHJpY3Nfa29iaiA9Cj4gICAJCWtv
YmplY3RfY3JlYXRlX2FuZF9hZGQoIm1ldHJpY3MiLAo+IC0JCQkJICAgICAgICZkZXZfcHJpdi0+
ZHJtLnByaW1hcnktPmtkZXYtPmtvYmopOwo+IC0JaWYgKCFkZXZfcHJpdi0+cGVyZi5tZXRyaWNz
X2tvYmopCj4gKwkJCQkgICAgICAgJmk5MTUtPmRybS5wcmltYXJ5LT5rZGV2LT5rb2JqKTsKPiAr
CWlmICghaTkxNS0+cGVyZi5tZXRyaWNzX2tvYmopCj4gICAJCWdvdG8gZXhpdDsKPiAgIAo+IC0J
c3lzZnNfYXR0cl9pbml0KCZkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRy
aWNfaWQuYXR0cik7Cj4gLQo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpIHsKPiAt
CQlpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19pY2woZGV2X3ByaXYpOwo+IC0JfSBlbHNlIGlm
IChJU19DQU5OT05MQUtFKGRldl9wcml2KSkgewo+IC0JCWk5MTVfcGVyZl9sb2FkX3Rlc3RfY29u
ZmlnX2NubChkZXZfcHJpdik7Cj4gLQl9IGVsc2UgaWYgKElTX0NPRkZFRUxBS0UoZGV2X3ByaXYp
KSB7Cj4gLQkJaWYgKElTX0NGTF9HVDIoZGV2X3ByaXYpKQo+IC0JCQlpOTE1X3BlcmZfbG9hZF90
ZXN0X2NvbmZpZ19jZmxndDIoZGV2X3ByaXYpOwo+IC0JCWlmIChJU19DRkxfR1QzKGRldl9wcml2
KSkKPiAtCQkJaTkxNV9wZXJmX2xvYWRfdGVzdF9jb25maWdfY2ZsZ3QzKGRldl9wcml2KTsKPiAt
CX0gZWxzZSBpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpIHsKPiAtCQlpOTE1X3BlcmZfbG9h
ZF90ZXN0X2NvbmZpZ19nbGsoZGV2X3ByaXYpOwo+IC0JfSBlbHNlIGlmIChJU19LQUJZTEFLRShk
ZXZfcHJpdikpIHsKPiAtCQlpZiAoSVNfS0JMX0dUMihkZXZfcHJpdikpCj4gLQkJCWk5MTVfcGVy
Zl9sb2FkX3Rlc3RfY29uZmlnX2tibGd0MihkZXZfcHJpdik7Cj4gLQkJZWxzZSBpZiAoSVNfS0JM
X0dUMyhkZXZfcHJpdikpCj4gLQkJCWk5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX2tibGd0Myhk
ZXZfcHJpdik7Cj4gLQl9IGVsc2UgaWYgKElTX0JST1hUT04oZGV2X3ByaXYpKSB7Cj4gLQkJaTkx
NV9wZXJmX2xvYWRfdGVzdF9jb25maWdfYnh0KGRldl9wcml2KTsKPiAtCX0gZWxzZSBpZiAoSVNf
U0tZTEFLRShkZXZfcHJpdikpIHsKPiAtCQlpZiAoSVNfU0tMX0dUMihkZXZfcHJpdikpCj4gLQkJ
CWk5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX3NrbGd0MihkZXZfcHJpdik7Cj4gLQkJZWxzZSBp
ZiAoSVNfU0tMX0dUMyhkZXZfcHJpdikpCj4gLQkJCWk5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmln
X3NrbGd0MyhkZXZfcHJpdik7Cj4gLQkJZWxzZSBpZiAoSVNfU0tMX0dUNChkZXZfcHJpdikpCj4g
LQkJCWk5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX3NrbGd0NChkZXZfcHJpdik7Cj4gLQl9IGVs
c2UgaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gLQkJaTkxNV9wZXJmX2xvYWRfdGVz
dF9jb25maWdfY2h2KGRldl9wcml2KTsKPiAtCX0gZWxzZSBpZiAoSVNfQlJPQURXRUxMKGRldl9w
cml2KSkgewo+IC0JCWk5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX2JkdyhkZXZfcHJpdik7Cj4g
LQl9IGVsc2UgaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpKSB7Cj4gLQkJaTkxNV9wZXJmX2xvYWRf
dGVzdF9jb25maWdfaHN3KGRldl9wcml2KTsKPiAtfQo+IC0KPiAtCWlmIChkZXZfcHJpdi0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5pZCA9PSAwKQo+ICsJc3lzZnNfYXR0cl9pbml0KCZpOTE1LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyKTsKPiArCj4gKwlpZiAoSU5URUxf
R0VOKGk5MTUpID49IDExKSB7Cj4gKwkJaTkxNV9wZXJmX2xvYWRfdGVzdF9jb25maWdfaWNsKGk5
MTUpOwo+ICsJfSBlbHNlIGlmIChJU19DQU5OT05MQUtFKGk5MTUpKSB7Cj4gKwkJaTkxNV9wZXJm
X2xvYWRfdGVzdF9jb25maWdfY25sKGk5MTUpOwo+ICsJfSBlbHNlIGlmIChJU19DT0ZGRUVMQUtF
KGk5MTUpKSB7Cj4gKwkJaWYgKElTX0NGTF9HVDIoaTkxNSkpCj4gKwkJCWk5MTVfcGVyZl9sb2Fk
X3Rlc3RfY29uZmlnX2NmbGd0MihpOTE1KTsKPiArCQlpZiAoSVNfQ0ZMX0dUMyhpOTE1KSkKPiAr
CQkJaTkxNV9wZXJmX2xvYWRfdGVzdF9jb25maWdfY2ZsZ3QzKGk5MTUpOwo+ICsJfSBlbHNlIGlm
IChJU19HRU1JTklMQUtFKGk5MTUpKSB7Cj4gKwkJaTkxNV9wZXJmX2xvYWRfdGVzdF9jb25maWdf
Z2xrKGk5MTUpOwo+ICsJfSBlbHNlIGlmIChJU19LQUJZTEFLRShpOTE1KSkgewo+ICsJCWlmIChJ
U19LQkxfR1QyKGk5MTUpKQo+ICsJCQlpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19rYmxndDIo
aTkxNSk7Cj4gKwkJZWxzZSBpZiAoSVNfS0JMX0dUMyhpOTE1KSkKPiArCQkJaTkxNV9wZXJmX2xv
YWRfdGVzdF9jb25maWdfa2JsZ3QzKGk5MTUpOwo+ICsJfSBlbHNlIGlmIChJU19CUk9YVE9OKGk5
MTUpKSB7Cj4gKwkJaTkxNV9wZXJmX2xvYWRfdGVzdF9jb25maWdfYnh0KGk5MTUpOwo+ICsJfSBl
bHNlIGlmIChJU19TS1lMQUtFKGk5MTUpKSB7Cj4gKwkJaWYgKElTX1NLTF9HVDIoaTkxNSkpCj4g
KwkJCWk5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX3NrbGd0MihpOTE1KTsKPiArCQllbHNlIGlm
IChJU19TS0xfR1QzKGk5MTUpKQo+ICsJCQlpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19za2xn
dDMoaTkxNSk7Cj4gKwkJZWxzZSBpZiAoSVNfU0tMX0dUNChpOTE1KSkKPiArCQkJaTkxNV9wZXJm
X2xvYWRfdGVzdF9jb25maWdfc2tsZ3Q0KGk5MTUpOwo+ICsJfSBlbHNlIGlmIChJU19DSEVSUllW
SUVXKGk5MTUpKSB7Cj4gKwkJaTkxNV9wZXJmX2xvYWRfdGVzdF9jb25maWdfY2h2KGk5MTUpOwo+
ICsJfSBlbHNlIGlmIChJU19CUk9BRFdFTEwoaTkxNSkpIHsKPiArCQlpOTE1X3BlcmZfbG9hZF90
ZXN0X2NvbmZpZ19iZHcoaTkxNSk7Cj4gKwl9IGVsc2UgaWYgKElTX0hBU1dFTEwoaTkxNSkpIHsK
PiArCQlpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19oc3coaTkxNSk7Cj4gK30KPiArCj4gKwlp
ZiAoaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5pZCA9PSAwKQo+ICAgCQlnb3RvIHN5c2ZzX2Vy
cm9yOwo+ICAgCj4gLQlyZXQgPSBzeXNmc19jcmVhdGVfZ3JvdXAoZGV2X3ByaXYtPnBlcmYubWV0
cmljc19rb2JqLAo+IC0JCQkJICZkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19t
ZXRyaWMpOwo+ICsJcmV0ID0gc3lzZnNfY3JlYXRlX2dyb3VwKGk5MTUtPnBlcmYubWV0cmljc19r
b2JqLAo+ICsJCQkJICZpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYyk7Cj4g
ICAJaWYgKHJldCkKPiAgIAkJZ290byBzeXNmc19lcnJvcjsKPiAgIAo+IC0JYXRvbWljX3NldCgm
ZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcucmVmX2NvdW50LCAxKTsKPiArCWF0b21pY19z
ZXQoJmk5MTUtPnBlcmYub2EudGVzdF9jb25maWcucmVmX2NvdW50LCAxKTsKPiAgIAo+ICAgCWdv
dG8gZXhpdDsKPiAgIAo+ICAgc3lzZnNfZXJyb3I6Cj4gLQlrb2JqZWN0X3B1dChkZXZfcHJpdi0+
cGVyZi5tZXRyaWNzX2tvYmopOwo+IC0JZGV2X3ByaXYtPnBlcmYubWV0cmljc19rb2JqID0gTlVM
TDsKPiArCWtvYmplY3RfcHV0KGk5MTUtPnBlcmYubWV0cmljc19rb2JqKTsKPiArCWk5MTUtPnBl
cmYubWV0cmljc19rb2JqID0gTlVMTDsKPiAgIAo+ICAgZXhpdDoKPiAtCW11dGV4X3VubG9jaygm
ZGV2X3ByaXYtPnBlcmYubG9jayk7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPnBlcmYubG9jayk7
Cj4gICB9Cj4gICAKPiAgIC8qKgo+ICAgICogaTkxNV9wZXJmX3VucmVnaXN0ZXIgLSBoaWRlIGk5
MTUtcGVyZiBmcm9tIHVzZXJzcGFjZQo+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIGluc3Rh
bmNlCj4gKyAqIEBpOTE1OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ICAgICoKPiAgICAqIGk5MTUt
cGVyZiBzdGF0ZSBjbGVhbnVwIGlzIHNwbGl0IHVwIGludG8gYW4gJ3VucmVnaXN0ZXInIGFuZAo+
ICAgICogJ2RlaW5pdCcgcGhhc2Ugd2hlcmUgdGhlIGludGVyZmFjZSBpcyBmaXJzdCBoaWRkZW4g
ZnJvbQo+ICAgICogdXNlcnNwYWNlIGJ5IGk5MTVfcGVyZl91bnJlZ2lzdGVyKCkgYmVmb3JlIGNs
ZWFuaW5nIHVwCj4gICAgKiByZW1haW5pbmcgc3RhdGUgaW4gaTkxNV9wZXJmX2ZpbmkoKS4KPiAg
ICAqLwo+IC12b2lkIGk5MTVfcGVyZl91bnJlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiArdm9pZCBpOTE1X3BlcmZfdW5yZWdpc3RlcihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCWlmICghZGV2X3ByaXYtPnBlcmYubWV0cmljc19rb2Jq
KQo+ICsJaWYgKCFpOTE1LT5wZXJmLm1ldHJpY3Nfa29iaikKPiAgIAkJcmV0dXJuOwo+ICAgCj4g
LQlzeXNmc19yZW1vdmVfZ3JvdXAoZGV2X3ByaXYtPnBlcmYubWV0cmljc19rb2JqLAo+IC0JCQkg
ICAmZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljKTsKPiArCXN5c2Zz
X3JlbW92ZV9ncm91cChpOTE1LT5wZXJmLm1ldHJpY3Nfa29iaiwKPiArCQkJICAgJmk5MTUtPnBl
cmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljKTsKPiAgIAo+IC0Ja29iamVjdF9wdXQoZGV2
X3ByaXYtPnBlcmYubWV0cmljc19rb2JqKTsKPiAtCWRldl9wcml2LT5wZXJmLm1ldHJpY3Nfa29i
aiA9IE5VTEw7Cj4gKwlrb2JqZWN0X3B1dChpOTE1LT5wZXJmLm1ldHJpY3Nfa29iaik7Cj4gKwlp
OTE1LT5wZXJmLm1ldHJpY3Nfa29iaiA9IE5VTEw7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGJvb2wg
Z2VuOF9pc192YWxpZF9mbGV4X2FkZHIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LCB1MzIgYWRkcikKPiArc3RhdGljIGJvb2wgZ2VuOF9pc192YWxpZF9mbGV4X2FkZHIoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBhZGRyKQo+ICAgewo+ICAgCXN0YXRpYyBjb25z
dCBpOTE1X3JlZ190IGZsZXhfZXVfcmVnc1tdID0gewo+ICAgCQlFVV9QRVJGX0NOVEwwLAo+IEBA
IC0yOTk1LDcgKzI5OTUsNyBAQCBzdGF0aWMgYm9vbCBnZW44X2lzX3ZhbGlkX2ZsZXhfYWRkcihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBhZGRyKQo+ICAgCXJldHVybiBm
YWxzZTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgYm9vbCBnZW43X2lzX3ZhbGlkX2JfY291bnRlcl9h
ZGRyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIGFkZHIpCj4gK3N0YXRp
YyBib29sIGdlbjdfaXNfdmFsaWRfYl9jb3VudGVyX2FkZHIoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsIHUzMiBhZGRyKQo+ICAgewo+ICAgCXJldHVybiAoYWRkciA+PSBpOTE1X21taW9f
cmVnX29mZnNldChPQVNUQVJUVFJJRzEpICYmCj4gICAJCWFkZHIgPD0gaTkxNV9tbWlvX3JlZ19v
ZmZzZXQoT0FTVEFSVFRSSUc4KSkgfHwKPiBAQCAtMzAwNSw3ICszMDA1LDcgQEAgc3RhdGljIGJv
b2wgZ2VuN19pc192YWxpZF9iX2NvdW50ZXJfYWRkcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsIHUzMgo+ICAgCQkgYWRkciA8PSBpOTE1X21taW9fcmVnX29mZnNldChPQUNFQzdf
MSkpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBib29sIGdlbjdfaXNfdmFsaWRfbXV4X2FkZHIoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgYWRkcikKPiArc3RhdGljIGJvb2wg
Z2VuN19pc192YWxpZF9tdXhfYWRkcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMy
IGFkZHIpCj4gICB7Cj4gICAJcmV0dXJuIGFkZHIgPT0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoSEFM
Rl9TTElDRV9DSElDS0VOMikgfHwKPiAgIAkJKGFkZHIgPj0gaTkxNV9tbWlvX3JlZ19vZmZzZXQo
TUlDUk9fQlAwXzApICYmCj4gQEAgLTMwMTYsMzQgKzMwMTYsMzQgQEAgc3RhdGljIGJvb2wgZ2Vu
N19pc192YWxpZF9tdXhfYWRkcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUz
MiBhZGRyKQo+ICAgCQkgYWRkciA8PSBpOTE1X21taW9fcmVnX29mZnNldChPQV9QRVJGTUFUUklY
X0hJKSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGJvb2wgZ2VuOF9pc192YWxpZF9tdXhfYWRkcihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBhZGRyKQo+ICtzdGF0aWMgYm9v
bCBnZW44X2lzX3ZhbGlkX211eF9hZGRyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1
MzIgYWRkcikKPiAgIHsKPiAtCXJldHVybiBnZW43X2lzX3ZhbGlkX211eF9hZGRyKGRldl9wcml2
LCBhZGRyKSB8fAo+ICsJcmV0dXJuIGdlbjdfaXNfdmFsaWRfbXV4X2FkZHIoaTkxNSwgYWRkcikg
fHwKPiAgIAkJYWRkciA9PSBpOTE1X21taW9fcmVnX29mZnNldChXQUlUX0ZPUl9SQzZfRVhJVCkg
fHwKPiAgIAkJKGFkZHIgPj0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoUlBNX0NPTkZJRzApICYmCj4g
ICAJCSBhZGRyIDw9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KE5PQV9DT05GSUcoOCkpKTsKPiAgIH0K
PiAgIAo+IC1zdGF0aWMgYm9vbCBnZW4xMF9pc192YWxpZF9tdXhfYWRkcihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBhZGRyKQo+ICtzdGF0aWMgYm9vbCBnZW4xMF9pc192
YWxpZF9tdXhfYWRkcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIGFkZHIpCj4g
ICB7Cj4gLQlyZXR1cm4gZ2VuOF9pc192YWxpZF9tdXhfYWRkcihkZXZfcHJpdiwgYWRkcikgfHwK
PiArCXJldHVybiBnZW44X2lzX3ZhbGlkX211eF9hZGRyKGk5MTUsIGFkZHIpIHx8Cj4gICAJCWFk
ZHIgPT0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOMTBfTk9BX1dSSVRFX0hJR0gpIHx8Cj4gICAJ
CShhZGRyID49IGk5MTVfbW1pb19yZWdfb2Zmc2V0KE9BX1BFUkZDTlQzX0xPKSAmJgo+ICAgCQkg
YWRkciA8PSBpOTE1X21taW9fcmVnX29mZnNldChPQV9QRVJGQ05UNF9ISSkpOwo+ICAgfQo+ICAg
Cj4gLXN0YXRpYyBib29sIGhzd19pc192YWxpZF9tdXhfYWRkcihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsIHUzMiBhZGRyKQo+ICtzdGF0aWMgYm9vbCBoc3dfaXNfdmFsaWRfbXV4
X2FkZHIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBhZGRyKQo+ICAgewo+IC0J
cmV0dXJuIGdlbjdfaXNfdmFsaWRfbXV4X2FkZHIoZGV2X3ByaXYsIGFkZHIpIHx8Cj4gKwlyZXR1
cm4gZ2VuN19pc192YWxpZF9tdXhfYWRkcihpOTE1LCBhZGRyKSB8fAo+ICAgCQkoYWRkciA+PSAw
eDI1MTAwICYmIGFkZHIgPD0gMHgyRkY5MCkgfHwKPiAgIAkJKGFkZHIgPj0gaTkxNV9tbWlvX3Jl
Z19vZmZzZXQoSFNXX01CVklEMl9OT0EwKSAmJgo+ICAgCQkgYWRkciA8PSBpOTE1X21taW9fcmVn
X29mZnNldChIU1dfTUJWSUQyX05PQTkpKSB8fAo+ICAgCQlhZGRyID09IGk5MTVfbW1pb19yZWdf
b2Zmc2V0KEhTV19NQlZJRDJfTUlTUjApOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBib29sIGNodl9p
c192YWxpZF9tdXhfYWRkcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBh
ZGRyKQo+ICtzdGF0aWMgYm9vbCBjaHZfaXNfdmFsaWRfbXV4X2FkZHIoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsIHUzMiBhZGRyKQo+ICAgewo+IC0JcmV0dXJuIGdlbjdfaXNfdmFsaWRf
bXV4X2FkZHIoZGV2X3ByaXYsIGFkZHIpIHx8Cj4gKwlyZXR1cm4gZ2VuN19pc192YWxpZF9tdXhf
YWRkcihpOTE1LCBhZGRyKSB8fAo+ICAgCQkoYWRkciA+PSAweDE4MjMwMCAmJiBhZGRyIDw9IDB4
MTgyM0E0KTsKPiAgIH0KPiAgIAo+IEBAIC0zMDY2LDggKzMwNjYsOCBAQCBzdGF0aWMgdTMyIG1h
c2tfcmVnX3ZhbHVlKHUzMiByZWcsIHUzMiB2YWwpCj4gICAJcmV0dXJuIHZhbDsKPiAgIH0KPiAg
IAo+IC1zdGF0aWMgc3RydWN0IGk5MTVfb2FfcmVnICphbGxvY19vYV9yZWdzKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAtCQkJCQkgYm9vbCAoKmlzX3ZhbGlkKShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBhZGRyKSwKPiArc3RhdGljIHN0cnVjdCBp
OTE1X29hX3JlZyAqYWxsb2Nfb2FfcmVncyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
PiArCQkJCQkgYm9vbCAoKmlzX3ZhbGlkKShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwg
dTMyIGFkZHIpLAo+ICAgCQkJCQkgdTMyIF9fdXNlciAqcmVncywKPiAgIAkJCQkJIHUzMiBuX3Jl
Z3MpCj4gICB7Cj4gQEAgLTMwOTcsNyArMzA5Nyw3IEBAIHN0YXRpYyBzdHJ1Y3QgaTkxNV9vYV9y
ZWcgKmFsbG9jX29hX3JlZ3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAg
CQlpZiAoZXJyKQo+ICAgCQkJZ290byBhZGRyX2VycjsKPiAgIAo+IC0JCWlmICghaXNfdmFsaWQo
ZGV2X3ByaXYsIGFkZHIpKSB7Cj4gKwkJaWYgKCFpc192YWxpZChpOTE1LCBhZGRyKSkgewo+ICAg
CQkJRFJNX0RFQlVHKCJJbnZhbGlkIG9hX3JlZyBhZGRyZXNzOiAlWFxuIiwgYWRkcik7Cj4gICAJ
CQllcnIgPSAtRUlOVkFMOwo+ICAgCQkJZ290byBhZGRyX2VycjsKPiBAQCAtMzEzMCw3ICszMTMw
LDcgQEAgc3RhdGljIHNzaXplX3Qgc2hvd19keW5hbWljX2lkKHN0cnVjdCBkZXZpY2UgKmRldiwK
PiAgIAlyZXR1cm4gc3ByaW50ZihidWYsICIlZFxuIiwgb2FfY29uZmlnLT5pZCk7Cj4gICB9Cj4g
ICAKPiAtc3RhdGljIGludCBjcmVhdGVfZHluYW1pY19vYV9zeXNmc19lbnRyeShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBpbnQgY3JlYXRlX2R5bmFtaWNfb2Ff
c3lzZnNfZW50cnkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJCSBzdHJ1
Y3QgaTkxNV9vYV9jb25maWcgKm9hX2NvbmZpZykKPiAgIHsKPiAgIAlzeXNmc19hdHRyX2luaXQo
Jm9hX2NvbmZpZy0+c3lzZnNfbWV0cmljX2lkLmF0dHIpOwo+IEBAIC0zMTQ1LDcgKzMxNDUsNyBA
QCBzdGF0aWMgaW50IGNyZWF0ZV9keW5hbWljX29hX3N5c2ZzX2VudHJ5KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlvYV9jb25maWctPnN5c2ZzX21ldHJpYy5uYW1lID0g
b2FfY29uZmlnLT51dWlkOwo+ICAgCW9hX2NvbmZpZy0+c3lzZnNfbWV0cmljLmF0dHJzID0gb2Ff
Y29uZmlnLT5hdHRyczsKPiAgIAo+IC0JcmV0dXJuIHN5c2ZzX2NyZWF0ZV9ncm91cChkZXZfcHJp
di0+cGVyZi5tZXRyaWNzX2tvYmosCj4gKwlyZXR1cm4gc3lzZnNfY3JlYXRlX2dyb3VwKGk5MTUt
PnBlcmYubWV0cmljc19rb2JqLAo+ICAgCQkJCSAgJm9hX2NvbmZpZy0+c3lzZnNfbWV0cmljKTsK
PiAgIH0KPiAgIAo+IEBAIC0zMTY1LDE3ICszMTY1LDE3IEBAIHN0YXRpYyBpbnQgY3JlYXRlX2R5
bmFtaWNfb2Ffc3lzZnNfZW50cnkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICAgaW50IGk5MTVfcGVyZl9hZGRfY29uZmlnX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYs
IHZvaWQgKmRhdGEsCj4gICAJCQkgICAgICAgc3RydWN0IGRybV9maWxlICpmaWxlKQo+ICAgewo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZGV2LT5kZXZfcHJpdmF0ZTsK
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZGV2LT5kZXZfcHJpdmF0ZTsKPiAg
IAlzdHJ1Y3QgZHJtX2k5MTVfcGVyZl9vYV9jb25maWcgKmFyZ3MgPSBkYXRhOwo+ICAgCXN0cnVj
dCBpOTE1X29hX2NvbmZpZyAqb2FfY29uZmlnLCAqdG1wOwo+ICAgCWludCBlcnIsIGlkOwo+ICAg
Cj4gLQlpZiAoIWRldl9wcml2LT5wZXJmLmluaXRpYWxpemVkKSB7Cj4gKwlpZiAoIWk5MTUtPnBl
cmYuaW5pdGlhbGl6ZWQpIHsKPiAgIAkJRFJNX0RFQlVHKCJpOTE1IHBlcmYgaW50ZXJmYWNlIG5v
dCBhdmFpbGFibGUgZm9yIHRoaXMgc3lzdGVtXG4iKTsKPiAgIAkJcmV0dXJuIC1FTk9UU1VQUDsK
PiAgIAl9Cj4gICAKPiAtCWlmICghZGV2X3ByaXYtPnBlcmYubWV0cmljc19rb2JqKSB7Cj4gKwlp
ZiAoIWk5MTUtPnBlcmYubWV0cmljc19rb2JqKSB7Cj4gICAJCURSTV9ERUJVRygiT0EgbWV0cmlj
cyB3ZXJlbid0IGFkdmVydGlzZWQgdmlhIHN5c2ZzXG4iKTsKPiAgIAkJcmV0dXJuIC1FSU5WQUw7
Cj4gICAJfQo+IEBAIC0zMjEzLDggKzMyMTMsOCBAQCBpbnQgaTkxNV9wZXJmX2FkZF9jb25maWdf
aW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKPiAgIAo+ICAgCW9hX2Nv
bmZpZy0+bXV4X3JlZ3NfbGVuID0gYXJncy0+bl9tdXhfcmVnczsKPiAgIAlvYV9jb25maWctPm11
eF9yZWdzID0KPiAtCQlhbGxvY19vYV9yZWdzKGRldl9wcml2LAo+IC0JCQkgICAgICBkZXZfcHJp
di0+cGVyZi5vYS5vcHMuaXNfdmFsaWRfbXV4X3JlZywKPiArCQlhbGxvY19vYV9yZWdzKGk5MTUs
Cj4gKwkJCSAgICAgIGk5MTUtPnBlcmYub2Eub3BzLmlzX3ZhbGlkX211eF9yZWcsCj4gICAJCQkg
ICAgICB1NjRfdG9fdXNlcl9wdHIoYXJncy0+bXV4X3JlZ3NfcHRyKSwKPiAgIAkJCSAgICAgIGFy
Z3MtPm5fbXV4X3JlZ3MpOwo+ICAgCj4gQEAgLTMyMjYsOCArMzIyNiw4IEBAIGludCBpOTE1X3Bl
cmZfYWRkX2NvbmZpZ19pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+
ICAgCj4gICAJb2FfY29uZmlnLT5iX2NvdW50ZXJfcmVnc19sZW4gPSBhcmdzLT5uX2Jvb2xlYW5f
cmVnczsKPiAgIAlvYV9jb25maWctPmJfY291bnRlcl9yZWdzID0KPiAtCQlhbGxvY19vYV9yZWdz
KGRldl9wcml2LAo+IC0JCQkgICAgICBkZXZfcHJpdi0+cGVyZi5vYS5vcHMuaXNfdmFsaWRfYl9j
b3VudGVyX3JlZywKPiArCQlhbGxvY19vYV9yZWdzKGk5MTUsCj4gKwkJCSAgICAgIGk5MTUtPnBl
cmYub2Eub3BzLmlzX3ZhbGlkX2JfY291bnRlcl9yZWcsCj4gICAJCQkgICAgICB1NjRfdG9fdXNl
cl9wdHIoYXJncy0+Ym9vbGVhbl9yZWdzX3B0ciksCj4gICAJCQkgICAgICBhcmdzLT5uX2Jvb2xl
YW5fcmVncyk7Cj4gICAKPiBAQCAtMzIzNyw3ICszMjM3LDcgQEAgaW50IGk5MTVfcGVyZl9hZGRf
Y29uZmlnX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gICAJCWdv
dG8gcmVnX2VycjsKPiAgIAl9Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgOCkg
ewo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8IDgpIHsKPiAgIAkJaWYgKGFyZ3MtPm5fZmxleF9y
ZWdzICE9IDApIHsKPiAgIAkJCWVyciA9IC1FSU5WQUw7Cj4gICAJCQlnb3RvIHJlZ19lcnI7Cj4g
QEAgLTMyNDUsOCArMzI0NSw4IEBAIGludCBpOTE1X3BlcmZfYWRkX2NvbmZpZ19pb2N0bChzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ICAgCX0gZWxzZSB7Cj4gICAJCW9hX2Nv
bmZpZy0+ZmxleF9yZWdzX2xlbiA9IGFyZ3MtPm5fZmxleF9yZWdzOwo+ICAgCQlvYV9jb25maWct
PmZsZXhfcmVncyA9Cj4gLQkJCWFsbG9jX29hX3JlZ3MoZGV2X3ByaXYsCj4gLQkJCQkgICAgICBk
ZXZfcHJpdi0+cGVyZi5vYS5vcHMuaXNfdmFsaWRfZmxleF9yZWcsCj4gKwkJCWFsbG9jX29hX3Jl
Z3MoaTkxNSwKPiArCQkJCSAgICAgIGk5MTUtPnBlcmYub2Eub3BzLmlzX3ZhbGlkX2ZsZXhfcmVn
LAo+ICAgCQkJCSAgICAgIHU2NF90b191c2VyX3B0cihhcmdzLT5mbGV4X3JlZ3NfcHRyKSwKPiAg
IAkJCQkgICAgICBhcmdzLT5uX2ZsZXhfcmVncyk7Cj4gICAKPiBAQCAtMzI1NywxNCArMzI1Nywx
NCBAQCBpbnQgaTkxNV9wZXJmX2FkZF9jb25maWdfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRl
diwgdm9pZCAqZGF0YSwKPiAgIAkJfQo+ICAgCX0KPiAgIAo+IC0JZXJyID0gbXV0ZXhfbG9ja19p
bnRlcnJ1cHRpYmxlKCZkZXZfcHJpdi0+cGVyZi5tZXRyaWNzX2xvY2spOwo+ICsJZXJyID0gbXV0
ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKCZpOTE1LT5wZXJmLm1ldHJpY3NfbG9jayk7Cj4gICAJaWYg
KGVycikKPiAgIAkJZ290byByZWdfZXJyOwo+ICAgCj4gICAJLyogV2Ugc2hvdWxkbid0IGhhdmUg
dG9vIG1hbnkgY29uZmlncywgc28gdGhpcyBpdGVyYXRpb24gc2hvdWxkbid0IGJlCj4gICAJICog
dG9vIGNvc3RseS4KPiAgIAkgKi8KPiAtCWlkcl9mb3JfZWFjaF9lbnRyeSgmZGV2X3ByaXYtPnBl
cmYubWV0cmljc19pZHIsIHRtcCwgaWQpIHsKPiArCWlkcl9mb3JfZWFjaF9lbnRyeSgmaTkxNS0+
cGVyZi5tZXRyaWNzX2lkciwgdG1wLCBpZCkgewo+ICAgCQlpZiAoIXN0cmNtcCh0bXAtPnV1aWQs
IG9hX2NvbmZpZy0+dXVpZCkpIHsKPiAgIAkJCURSTV9ERUJVRygiT0EgY29uZmlnIGFscmVhZHkg
ZXhpc3RzIHdpdGggdGhpcyB1dWlkXG4iKTsKPiAgIAkJCWVyciA9IC1FQUREUklOVVNFOwo+IEBA
IC0zMjcyLDE0ICszMjcyLDE0IEBAIGludCBpOTE1X3BlcmZfYWRkX2NvbmZpZ19pb2N0bChzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ICAgCQl9Cj4gICAJfQo+ICAgCj4gLQll
cnIgPSBjcmVhdGVfZHluYW1pY19vYV9zeXNmc19lbnRyeShkZXZfcHJpdiwgb2FfY29uZmlnKTsK
PiArCWVyciA9IGNyZWF0ZV9keW5hbWljX29hX3N5c2ZzX2VudHJ5KGk5MTUsIG9hX2NvbmZpZyk7
Cj4gICAJaWYgKGVycikgewo+ICAgCQlEUk1fREVCVUcoIkZhaWxlZCB0byBjcmVhdGUgc3lzZnMg
ZW50cnkgZm9yIE9BIGNvbmZpZ1xuIik7Cj4gICAJCWdvdG8gc3lzZnNfZXJyOwo+ICAgCX0KPiAg
IAo+ICAgCS8qIENvbmZpZyBpZCAwIGlzIGludmFsaWQsIGlkIDEgZm9yIGtlcm5lbCBzdG9yZWQg
dGVzdCBjb25maWcuICovCj4gLQlvYV9jb25maWctPmlkID0gaWRyX2FsbG9jKCZkZXZfcHJpdi0+
cGVyZi5tZXRyaWNzX2lkciwKPiArCW9hX2NvbmZpZy0+aWQgPSBpZHJfYWxsb2MoJmk5MTUtPnBl
cmYubWV0cmljc19pZHIsCj4gICAJCQkJICBvYV9jb25maWcsIDIsCj4gICAJCQkJICAwLCBHRlBf
S0VSTkVMKTsKPiAgIAlpZiAob2FfY29uZmlnLT5pZCA8IDApIHsKPiBAQCAtMzI4OCwxNiArMzI4
OCwxNiBAQCBpbnQgaTkxNV9wZXJmX2FkZF9jb25maWdfaW9jdGwoc3RydWN0IGRybV9kZXZpY2Ug
KmRldiwgdm9pZCAqZGF0YSwKPiAgIAkJZ290byBzeXNmc19lcnI7Cj4gICAJfQo+ICAgCj4gLQlt
dXRleF91bmxvY2soJmRldl9wcml2LT5wZXJmLm1ldHJpY3NfbG9jayk7Cj4gKwltdXRleF91bmxv
Y2soJmk5MTUtPnBlcmYubWV0cmljc19sb2NrKTsKPiAgIAo+ICAgCURSTV9ERUJVRygiQWRkZWQg
Y29uZmlnICVzIGlkPSVpXG4iLCBvYV9jb25maWctPnV1aWQsIG9hX2NvbmZpZy0+aWQpOwo+ICAg
Cj4gICAJcmV0dXJuIG9hX2NvbmZpZy0+aWQ7Cj4gICAKPiAgIHN5c2ZzX2VycjoKPiAtCW11dGV4
X3VubG9jaygmZGV2X3ByaXYtPnBlcmYubWV0cmljc19sb2NrKTsKPiArCW11dGV4X3VubG9jaygm
aTkxNS0+cGVyZi5tZXRyaWNzX2xvY2spOwo+ICAgcmVnX2VycjoKPiAtCXB1dF9vYV9jb25maWco
ZGV2X3ByaXYsIG9hX2NvbmZpZyk7Cj4gKwlwdXRfb2FfY29uZmlnKGk5MTUsIG9hX2NvbmZpZyk7
Cj4gICAJRFJNX0RFQlVHKCJGYWlsZWQgdG8gYWRkIG5ldyBPQSBjb25maWdcbiIpOwo+ICAgCXJl
dHVybiBlcnI7Cj4gICB9Cj4gQEAgLTMzMTYsMTIgKzMzMTYsMTIgQEAgaW50IGk5MTVfcGVyZl9h
ZGRfY29uZmlnX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gICBp
bnQgaTkxNV9wZXJmX3JlbW92ZV9jb25maWdfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwg
dm9pZCAqZGF0YSwKPiAgIAkJCQkgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkKPiAgIHsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRldi0+ZGV2X3ByaXZhdGU7Cj4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRldi0+ZGV2X3ByaXZhdGU7Cj4gICAJdTY0
ICphcmcgPSBkYXRhOwo+ICAgCXN0cnVjdCBpOTE1X29hX2NvbmZpZyAqb2FfY29uZmlnOwo+ICAg
CWludCByZXQ7Cj4gICAKPiAtCWlmICghZGV2X3ByaXYtPnBlcmYuaW5pdGlhbGl6ZWQpIHsKPiAr
CWlmICghaTkxNS0+cGVyZi5pbml0aWFsaXplZCkgewo+ICAgCQlEUk1fREVCVUcoImk5MTUgcGVy
ZiBpbnRlcmZhY2Ugbm90IGF2YWlsYWJsZSBmb3IgdGhpcyBzeXN0ZW1cbiIpOwo+ICAgCQlyZXR1
cm4gLUVOT1RTVVBQOwo+ICAgCX0KPiBAQCAtMzMzMSwxMSArMzMzMSwxMSBAQCBpbnQgaTkxNV9w
ZXJmX3JlbW92ZV9jb25maWdfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0
YSwKPiAgIAkJcmV0dXJuIC1FQUNDRVM7Cj4gICAJfQo+ICAgCj4gLQlyZXQgPSBtdXRleF9sb2Nr
X2ludGVycnVwdGlibGUoJmRldl9wcml2LT5wZXJmLm1ldHJpY3NfbG9jayk7Cj4gKwlyZXQgPSBt
dXRleF9sb2NrX2ludGVycnVwdGlibGUoJmk5MTUtPnBlcmYubWV0cmljc19sb2NrKTsKPiAgIAlp
ZiAocmV0KQo+ICAgCQlnb3RvIGxvY2tfZXJyOwo+ICAgCj4gLQlvYV9jb25maWcgPSBpZHJfZmlu
ZCgmZGV2X3ByaXYtPnBlcmYubWV0cmljc19pZHIsICphcmcpOwo+ICsJb2FfY29uZmlnID0gaWRy
X2ZpbmQoJmk5MTUtPnBlcmYubWV0cmljc19pZHIsICphcmcpOwo+ICAgCWlmICghb2FfY29uZmln
KSB7Cj4gICAJCURSTV9ERUJVRygiRmFpbGVkIHRvIHJlbW92ZSB1bmtub3duIE9BIGNvbmZpZ1xu
Iik7Cj4gICAJCXJldCA9IC1FTk9FTlQ7Cj4gQEAgLTMzNDQsMTcgKzMzNDQsMTcgQEAgaW50IGk5
MTVfcGVyZl9yZW1vdmVfY29uZmlnX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQg
KmRhdGEsCj4gICAKPiAgIAlHRU1fQlVHX09OKCphcmcgIT0gb2FfY29uZmlnLT5pZCk7Cj4gICAK
PiAtCXN5c2ZzX3JlbW92ZV9ncm91cChkZXZfcHJpdi0+cGVyZi5tZXRyaWNzX2tvYmosCj4gKwlz
eXNmc19yZW1vdmVfZ3JvdXAoaTkxNS0+cGVyZi5tZXRyaWNzX2tvYmosCj4gICAJCQkgICAmb2Ff
Y29uZmlnLT5zeXNmc19tZXRyaWMpOwo+ICAgCj4gLQlpZHJfcmVtb3ZlKCZkZXZfcHJpdi0+cGVy
Zi5tZXRyaWNzX2lkciwgKmFyZyk7Cj4gKwlpZHJfcmVtb3ZlKCZpOTE1LT5wZXJmLm1ldHJpY3Nf
aWRyLCAqYXJnKTsKPiAgIAo+ICAgCURSTV9ERUJVRygiUmVtb3ZlZCBjb25maWcgJXMgaWQ9JWlc
biIsIG9hX2NvbmZpZy0+dXVpZCwgb2FfY29uZmlnLT5pZCk7Cj4gICAKPiAtCXB1dF9vYV9jb25m
aWcoZGV2X3ByaXYsIG9hX2NvbmZpZyk7Cj4gKwlwdXRfb2FfY29uZmlnKGk5MTUsIG9hX2NvbmZp
Zyk7Cj4gICAKPiAgIGNvbmZpZ19lcnI6Cj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5wZXJm
Lm1ldHJpY3NfbG9jayk7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPnBlcmYubWV0cmljc19sb2Nr
KTsKPiAgIGxvY2tfZXJyOgo+ICAgCXJldHVybiByZXQ7Cj4gICB9Cj4gQEAgLTM0MDMsMTM1ICsz
NDAzLDEzNSBAQCBzdGF0aWMgc3RydWN0IGN0bF90YWJsZSBkZXZfcm9vdFtdID0gewo+ICAgCj4g
ICAvKioKPiAgICAqIGk5MTVfcGVyZl9pbml0IC0gaW5pdGlhbGl6ZSBpOTE1LXBlcmYgc3RhdGUg
b24gbW9kdWxlIGxvYWQKPiAtICogQGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ICsg
KiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiAgICAqCj4gICAgKiBJbml0aWFsaXplcyBp
OTE1LXBlcmYgc3RhdGUgd2l0aG91dCBleHBvc2luZyBhbnl0aGluZyB0byB1c2Vyc3BhY2UuCj4g
ICAgKgo+ICAgICogTm90ZTogaTkxNS1wZXJmIGluaXRpYWxpemF0aW9uIGlzIHNwbGl0IGludG8g
YW4gJ2luaXQnIGFuZCAncmVnaXN0ZXInCj4gICAgKiBwaGFzZSB3aXRoIHRoZSBpOTE1X3BlcmZf
cmVnaXN0ZXIoKSBleHBvc2luZyBzdGF0ZSB0byB1c2Vyc3BhY2UuCj4gICAgKi8KPiAtdm9pZCBp
OTE1X3BlcmZfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQg
aTkxNV9wZXJmX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlp
ZiAoSVNfSEFTV0VMTChkZXZfcHJpdikpIHsKPiAtCQlkZXZfcHJpdi0+cGVyZi5vYS5vcHMuaXNf
dmFsaWRfYl9jb3VudGVyX3JlZyA9Cj4gKwlpZiAoSVNfSEFTV0VMTChpOTE1KSkgewo+ICsJCWk5
MTUtPnBlcmYub2Eub3BzLmlzX3ZhbGlkX2JfY291bnRlcl9yZWcgPQo+ICAgCQkJZ2VuN19pc192
YWxpZF9iX2NvdW50ZXJfYWRkcjsKPiAtCQlkZXZfcHJpdi0+cGVyZi5vYS5vcHMuaXNfdmFsaWRf
bXV4X3JlZyA9Cj4gKwkJaTkxNS0+cGVyZi5vYS5vcHMuaXNfdmFsaWRfbXV4X3JlZyA9Cj4gICAJ
CQloc3dfaXNfdmFsaWRfbXV4X2FkZHI7Cj4gLQkJZGV2X3ByaXYtPnBlcmYub2Eub3BzLmlzX3Zh
bGlkX2ZsZXhfcmVnID0gTlVMTDsKPiAtCQlkZXZfcHJpdi0+cGVyZi5vYS5vcHMuZW5hYmxlX21l
dHJpY19zZXQgPSBoc3dfZW5hYmxlX21ldHJpY19zZXQ7Cj4gLQkJZGV2X3ByaXYtPnBlcmYub2Eu
b3BzLmRpc2FibGVfbWV0cmljX3NldCA9IGhzd19kaXNhYmxlX21ldHJpY19zZXQ7Cj4gLQkJZGV2
X3ByaXYtPnBlcmYub2Eub3BzLm9hX2VuYWJsZSA9IGdlbjdfb2FfZW5hYmxlOwo+IC0JCWRldl9w
cml2LT5wZXJmLm9hLm9wcy5vYV9kaXNhYmxlID0gZ2VuN19vYV9kaXNhYmxlOwo+IC0JCWRldl9w
cml2LT5wZXJmLm9hLm9wcy5yZWFkID0gZ2VuN19vYV9yZWFkOwo+IC0JCWRldl9wcml2LT5wZXJm
Lm9hLm9wcy5vYV9od190YWlsX3JlYWQgPQo+ICsJCWk5MTUtPnBlcmYub2Eub3BzLmlzX3ZhbGlk
X2ZsZXhfcmVnID0gTlVMTDsKPiArCQlpOTE1LT5wZXJmLm9hLm9wcy5lbmFibGVfbWV0cmljX3Nl
dCA9IGhzd19lbmFibGVfbWV0cmljX3NldDsKPiArCQlpOTE1LT5wZXJmLm9hLm9wcy5kaXNhYmxl
X21ldHJpY19zZXQgPSBoc3dfZGlzYWJsZV9tZXRyaWNfc2V0Owo+ICsJCWk5MTUtPnBlcmYub2Eu
b3BzLm9hX2VuYWJsZSA9IGdlbjdfb2FfZW5hYmxlOwo+ICsJCWk5MTUtPnBlcmYub2Eub3BzLm9h
X2Rpc2FibGUgPSBnZW43X29hX2Rpc2FibGU7Cj4gKwkJaTkxNS0+cGVyZi5vYS5vcHMucmVhZCA9
IGdlbjdfb2FfcmVhZDsKPiArCQlpOTE1LT5wZXJmLm9hLm9wcy5vYV9od190YWlsX3JlYWQgPQo+
ICAgCQkJZ2VuN19vYV9od190YWlsX3JlYWQ7Cj4gICAKPiAtCQlkZXZfcHJpdi0+cGVyZi5vYS5v
YV9mb3JtYXRzID0gaHN3X29hX2Zvcm1hdHM7Cj4gLQl9IGVsc2UgaWYgKEhBU19MT0dJQ0FMX1JJ
TkdfQ09OVEVYVFMoZGV2X3ByaXYpKSB7Cj4gKwkJaTkxNS0+cGVyZi5vYS5vYV9mb3JtYXRzID0g
aHN3X29hX2Zvcm1hdHM7Cj4gKwl9IGVsc2UgaWYgKEhBU19MT0dJQ0FMX1JJTkdfQ09OVEVYVFMo
aTkxNSkpIHsKPiAgIAkJLyogTm90ZTogdGhhdCBhbHRob3VnaCB3ZSBjb3VsZCB0aGVvcmV0aWNh
bGx5IGFsc28gc3VwcG9ydCB0aGUKPiAgIAkJICogbGVnYWN5IHJpbmdidWZmZXIgbW9kZSBvbiBC
RFcgKGFuZCBlYXJsaWVyIGl0ZXJhdGlvbnMgb2YKPiAgIAkJICogdGhpcyBkcml2ZXIsIGJlZm9y
ZSB1cHN0cmVhbWluZyBkaWQgdGhpcykgaXQgZGlkbid0IHNlZW0KPiAgIAkJICogd29ydGggdGhl
IGNvbXBsZXhpdHkgdG8gbWFpbnRhaW4gbm93IHRoYXQgQkRXKyBlbmFibGUKPiAgIAkJICogZXhl
Y2xpc3QgbW9kZSBieSBkZWZhdWx0Lgo+ICAgCQkgKi8KPiAtCQlkZXZfcHJpdi0+cGVyZi5vYS5v
YV9mb3JtYXRzID0gZ2VuOF9wbHVzX29hX2Zvcm1hdHM7Cj4gKwkJaTkxNS0+cGVyZi5vYS5vYV9m
b3JtYXRzID0gZ2VuOF9wbHVzX29hX2Zvcm1hdHM7Cj4gICAKPiAtCQlkZXZfcHJpdi0+cGVyZi5v
YS5vcHMub2FfZW5hYmxlID0gZ2VuOF9vYV9lbmFibGU7Cj4gLQkJZGV2X3ByaXYtPnBlcmYub2Eu
b3BzLm9hX2Rpc2FibGUgPSBnZW44X29hX2Rpc2FibGU7Cj4gLQkJZGV2X3ByaXYtPnBlcmYub2Eu
b3BzLnJlYWQgPSBnZW44X29hX3JlYWQ7Cj4gLQkJZGV2X3ByaXYtPnBlcmYub2Eub3BzLm9hX2h3
X3RhaWxfcmVhZCA9IGdlbjhfb2FfaHdfdGFpbF9yZWFkOwo+ICsJCWk5MTUtPnBlcmYub2Eub3Bz
Lm9hX2VuYWJsZSA9IGdlbjhfb2FfZW5hYmxlOwo+ICsJCWk5MTUtPnBlcmYub2Eub3BzLm9hX2Rp
c2FibGUgPSBnZW44X29hX2Rpc2FibGU7Cj4gKwkJaTkxNS0+cGVyZi5vYS5vcHMucmVhZCA9IGdl
bjhfb2FfcmVhZDsKPiArCQlpOTE1LT5wZXJmLm9hLm9wcy5vYV9od190YWlsX3JlYWQgPSBnZW44
X29hX2h3X3RhaWxfcmVhZDsKPiAgIAo+IC0JCWlmIChJU19HRU5fUkFOR0UoZGV2X3ByaXYsIDgs
IDkpKSB7Cj4gLQkJCWRldl9wcml2LT5wZXJmLm9hLm9wcy5pc192YWxpZF9iX2NvdW50ZXJfcmVn
ID0KPiArCQlpZiAoSVNfR0VOX1JBTkdFKGk5MTUsIDgsIDkpKSB7Cj4gKwkJCWk5MTUtPnBlcmYu
b2Eub3BzLmlzX3ZhbGlkX2JfY291bnRlcl9yZWcgPQo+ICAgCQkJCWdlbjdfaXNfdmFsaWRfYl9j
b3VudGVyX2FkZHI7Cj4gLQkJCWRldl9wcml2LT5wZXJmLm9hLm9wcy5pc192YWxpZF9tdXhfcmVn
ID0KPiArCQkJaTkxNS0+cGVyZi5vYS5vcHMuaXNfdmFsaWRfbXV4X3JlZyA9Cj4gICAJCQkJZ2Vu
OF9pc192YWxpZF9tdXhfYWRkcjsKPiAtCQkJZGV2X3ByaXYtPnBlcmYub2Eub3BzLmlzX3ZhbGlk
X2ZsZXhfcmVnID0KPiArCQkJaTkxNS0+cGVyZi5vYS5vcHMuaXNfdmFsaWRfZmxleF9yZWcgPQo+
ICAgCQkJCWdlbjhfaXNfdmFsaWRfZmxleF9hZGRyOwo+ICAgCj4gLQkJCWlmIChJU19DSEVSUllW
SUVXKGRldl9wcml2KSkgewo+IC0JCQkJZGV2X3ByaXYtPnBlcmYub2Eub3BzLmlzX3ZhbGlkX211
eF9yZWcgPQo+ICsJCQlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkgewo+ICsJCQkJaTkxNS0+cGVy
Zi5vYS5vcHMuaXNfdmFsaWRfbXV4X3JlZyA9Cj4gICAJCQkJCWNodl9pc192YWxpZF9tdXhfYWRk
cjsKPiAgIAkJCX0KPiAgIAo+IC0JCQlkZXZfcHJpdi0+cGVyZi5vYS5vcHMuZW5hYmxlX21ldHJp
Y19zZXQgPSBnZW44X2VuYWJsZV9tZXRyaWNfc2V0Owo+IC0JCQlkZXZfcHJpdi0+cGVyZi5vYS5v
cHMuZGlzYWJsZV9tZXRyaWNfc2V0ID0gZ2VuOF9kaXNhYmxlX21ldHJpY19zZXQ7Cj4gKwkJCWk5
MTUtPnBlcmYub2Eub3BzLmVuYWJsZV9tZXRyaWNfc2V0ID0gZ2VuOF9lbmFibGVfbWV0cmljX3Nl
dDsKPiArCQkJaTkxNS0+cGVyZi5vYS5vcHMuZGlzYWJsZV9tZXRyaWNfc2V0ID0gZ2VuOF9kaXNh
YmxlX21ldHJpY19zZXQ7Cj4gICAKPiAtCQkJaWYgKElTX0dFTihkZXZfcHJpdiwgOCkpIHsKPiAt
CQkJCWRldl9wcml2LT5wZXJmLm9hLmN0eF9vYWN0eGN0cmxfb2Zmc2V0ID0gMHgxMjA7Cj4gLQkJ
CQlkZXZfcHJpdi0+cGVyZi5vYS5jdHhfZmxleGV1MF9vZmZzZXQgPSAweDJjZTsKPiArCQkJaWYg
KElTX0dFTihpOTE1LCA4KSkgewo+ICsJCQkJaTkxNS0+cGVyZi5vYS5jdHhfb2FjdHhjdHJsX29m
ZnNldCA9IDB4MTIwOwo+ICsJCQkJaTkxNS0+cGVyZi5vYS5jdHhfZmxleGV1MF9vZmZzZXQgPSAw
eDJjZTsKPiAgIAo+IC0JCQkJZGV2X3ByaXYtPnBlcmYub2EuZ2VuOF92YWxpZF9jdHhfYml0ID0g
KDE8PDI1KTsKPiArCQkJCWk5MTUtPnBlcmYub2EuZ2VuOF92YWxpZF9jdHhfYml0ID0gKDE8PDI1
KTsKPiAgIAkJCX0gZWxzZSB7Cj4gLQkJCQlkZXZfcHJpdi0+cGVyZi5vYS5jdHhfb2FjdHhjdHJs
X29mZnNldCA9IDB4MTI4Owo+IC0JCQkJZGV2X3ByaXYtPnBlcmYub2EuY3R4X2ZsZXhldTBfb2Zm
c2V0ID0gMHgzZGU7Cj4gKwkJCQlpOTE1LT5wZXJmLm9hLmN0eF9vYWN0eGN0cmxfb2Zmc2V0ID0g
MHgxMjg7Cj4gKwkJCQlpOTE1LT5wZXJmLm9hLmN0eF9mbGV4ZXUwX29mZnNldCA9IDB4M2RlOwo+
ICAgCj4gLQkJCQlkZXZfcHJpdi0+cGVyZi5vYS5nZW44X3ZhbGlkX2N0eF9iaXQgPSAoMTw8MTYp
Owo+ICsJCQkJaTkxNS0+cGVyZi5vYS5nZW44X3ZhbGlkX2N0eF9iaXQgPSAoMTw8MTYpOwo+ICAg
CQkJfQo+IC0JCX0gZWxzZSBpZiAoSVNfR0VOX1JBTkdFKGRldl9wcml2LCAxMCwgMTEpKSB7Cj4g
LQkJCWRldl9wcml2LT5wZXJmLm9hLm9wcy5pc192YWxpZF9iX2NvdW50ZXJfcmVnID0KPiArCQl9
IGVsc2UgaWYgKElTX0dFTl9SQU5HRShpOTE1LCAxMCwgMTEpKSB7Cj4gKwkJCWk5MTUtPnBlcmYu
b2Eub3BzLmlzX3ZhbGlkX2JfY291bnRlcl9yZWcgPQo+ICAgCQkJCWdlbjdfaXNfdmFsaWRfYl9j
b3VudGVyX2FkZHI7Cj4gLQkJCWRldl9wcml2LT5wZXJmLm9hLm9wcy5pc192YWxpZF9tdXhfcmVn
ID0KPiArCQkJaTkxNS0+cGVyZi5vYS5vcHMuaXNfdmFsaWRfbXV4X3JlZyA9Cj4gICAJCQkJZ2Vu
MTBfaXNfdmFsaWRfbXV4X2FkZHI7Cj4gLQkJCWRldl9wcml2LT5wZXJmLm9hLm9wcy5pc192YWxp
ZF9mbGV4X3JlZyA9Cj4gKwkJCWk5MTUtPnBlcmYub2Eub3BzLmlzX3ZhbGlkX2ZsZXhfcmVnID0K
PiAgIAkJCQlnZW44X2lzX3ZhbGlkX2ZsZXhfYWRkcjsKPiAgIAo+IC0JCQlkZXZfcHJpdi0+cGVy
Zi5vYS5vcHMuZW5hYmxlX21ldHJpY19zZXQgPSBnZW44X2VuYWJsZV9tZXRyaWNfc2V0Owo+IC0J
CQlkZXZfcHJpdi0+cGVyZi5vYS5vcHMuZGlzYWJsZV9tZXRyaWNfc2V0ID0gZ2VuMTBfZGlzYWJs
ZV9tZXRyaWNfc2V0Owo+ICsJCQlpOTE1LT5wZXJmLm9hLm9wcy5lbmFibGVfbWV0cmljX3NldCA9
IGdlbjhfZW5hYmxlX21ldHJpY19zZXQ7Cj4gKwkJCWk5MTUtPnBlcmYub2Eub3BzLmRpc2FibGVf
bWV0cmljX3NldCA9IGdlbjEwX2Rpc2FibGVfbWV0cmljX3NldDsKPiAgIAo+IC0JCQlkZXZfcHJp
di0+cGVyZi5vYS5jdHhfb2FjdHhjdHJsX29mZnNldCA9IDB4MTI4Owo+IC0JCQlkZXZfcHJpdi0+
cGVyZi5vYS5jdHhfZmxleGV1MF9vZmZzZXQgPSAweDNkZTsKPiArCQkJaTkxNS0+cGVyZi5vYS5j
dHhfb2FjdHhjdHJsX29mZnNldCA9IDB4MTI4Owo+ICsJCQlpOTE1LT5wZXJmLm9hLmN0eF9mbGV4
ZXUwX29mZnNldCA9IDB4M2RlOwo+ICAgCj4gLQkJCWRldl9wcml2LT5wZXJmLm9hLmdlbjhfdmFs
aWRfY3R4X2JpdCA9ICgxPDwxNik7Cj4gKwkJCWk5MTUtPnBlcmYub2EuZ2VuOF92YWxpZF9jdHhf
Yml0ID0gKDE8PDE2KTsKPiAgIAkJfQo+ICAgCX0KPiAgIAo+IC0JaWYgKGRldl9wcml2LT5wZXJm
Lm9hLm9wcy5lbmFibGVfbWV0cmljX3NldCkgewo+IC0JCWhydGltZXJfaW5pdCgmZGV2X3ByaXYt
PnBlcmYub2EucG9sbF9jaGVja190aW1lciwKPiArCWlmIChpOTE1LT5wZXJmLm9hLm9wcy5lbmFi
bGVfbWV0cmljX3NldCkgewo+ICsJCWhydGltZXJfaW5pdCgmaTkxNS0+cGVyZi5vYS5wb2xsX2No
ZWNrX3RpbWVyLAo+ICAgCQkJCUNMT0NLX01PTk9UT05JQywgSFJUSU1FUl9NT0RFX1JFTCk7Cj4g
LQkJZGV2X3ByaXYtPnBlcmYub2EucG9sbF9jaGVja190aW1lci5mdW5jdGlvbiA9IG9hX3BvbGxf
Y2hlY2tfdGltZXJfY2I7Cj4gLQkJaW5pdF93YWl0cXVldWVfaGVhZCgmZGV2X3ByaXYtPnBlcmYu
b2EucG9sbF93cSk7Cj4gKwkJaTkxNS0+cGVyZi5vYS5wb2xsX2NoZWNrX3RpbWVyLmZ1bmN0aW9u
ID0gb2FfcG9sbF9jaGVja190aW1lcl9jYjsKPiArCQlpbml0X3dhaXRxdWV1ZV9oZWFkKCZpOTE1
LT5wZXJmLm9hLnBvbGxfd3EpOwo+ICAgCj4gLQkJSU5JVF9MSVNUX0hFQUQoJmRldl9wcml2LT5w
ZXJmLnN0cmVhbXMpOwo+IC0JCW11dGV4X2luaXQoJmRldl9wcml2LT5wZXJmLmxvY2spOwo+IC0J
CXNwaW5fbG9ja19pbml0KCZkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIucHRyX2xvY2spOwo+
ICsJCUlOSVRfTElTVF9IRUFEKCZpOTE1LT5wZXJmLnN0cmVhbXMpOwo+ICsJCW11dGV4X2luaXQo
Jmk5MTUtPnBlcmYubG9jayk7Cj4gKwkJc3Bpbl9sb2NrX2luaXQoJmk5MTUtPnBlcmYub2Eub2Ff
YnVmZmVyLnB0cl9sb2NrKTsKPiAgIAo+ICAgCQlvYV9zYW1wbGVfcmF0ZV9oYXJkX2xpbWl0ID0g
MTAwMCAqCj4gLQkJCShSVU5USU1FX0lORk8oZGV2X3ByaXYpLT5jc190aW1lc3RhbXBfZnJlcXVl
bmN5X2toeiAvIDIpOwo+IC0JCWRldl9wcml2LT5wZXJmLnN5c2N0bF9oZWFkZXIgPSByZWdpc3Rl
cl9zeXNjdGxfdGFibGUoZGV2X3Jvb3QpOwo+ICsJCQkoUlVOVElNRV9JTkZPKGk5MTUpLT5jc190
aW1lc3RhbXBfZnJlcXVlbmN5X2toeiAvIDIpOwo+ICsJCWk5MTUtPnBlcmYuc3lzY3RsX2hlYWRl
ciA9IHJlZ2lzdGVyX3N5c2N0bF90YWJsZShkZXZfcm9vdCk7Cj4gICAKPiAtCQltdXRleF9pbml0
KCZkZXZfcHJpdi0+cGVyZi5tZXRyaWNzX2xvY2spOwo+IC0JCWlkcl9pbml0KCZkZXZfcHJpdi0+
cGVyZi5tZXRyaWNzX2lkcik7Cj4gKwkJbXV0ZXhfaW5pdCgmaTkxNS0+cGVyZi5tZXRyaWNzX2xv
Y2spOwo+ICsJCWlkcl9pbml0KCZpOTE1LT5wZXJmLm1ldHJpY3NfaWRyKTsKPiAgIAo+IC0JCWRl
dl9wcml2LT5wZXJmLmluaXRpYWxpemVkID0gdHJ1ZTsKPiArCQlpOTE1LT5wZXJmLmluaXRpYWxp
emVkID0gdHJ1ZTsKPiAgIAl9Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQgZGVzdHJveV9jb25m
aWcoaW50IGlkLCB2b2lkICpwLCB2b2lkICpkYXRhKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gZGF0YTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gZGF0YTsKPiAgIAlzdHJ1Y3QgaTkxNV9vYV9jb25maWcgKm9hX2NvbmZpZyA9IHA7Cj4g
ICAKPiAtCXB1dF9vYV9jb25maWcoZGV2X3ByaXYsIG9hX2NvbmZpZyk7Cj4gKwlwdXRfb2FfY29u
ZmlnKGk5MTUsIG9hX2NvbmZpZyk7Cj4gICAKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+ICAg
LyoqCj4gICAgKiBpOTE1X3BlcmZfZmluaSAtIENvdW50ZXIgcGFydCB0byBpOTE1X3BlcmZfaW5p
dCgpCj4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiArICogQGk5MTU6IGk5
MTUgZGV2aWNlIGluc3RhbmNlCj4gICAgKi8KPiAtdm9pZCBpOTE1X3BlcmZfZmluaShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgaTkxNV9wZXJmX2Zpbmkoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlpZiAoIWRldl9wcml2LT5wZXJmLmlu
aXRpYWxpemVkKQo+ICsJaWYgKCFpOTE1LT5wZXJmLmluaXRpYWxpemVkKQo+ICAgCQlyZXR1cm47
Cj4gICAKPiAtCWlkcl9mb3JfZWFjaCgmZGV2X3ByaXYtPnBlcmYubWV0cmljc19pZHIsIGRlc3Ry
b3lfY29uZmlnLCBkZXZfcHJpdik7Cj4gLQlpZHJfZGVzdHJveSgmZGV2X3ByaXYtPnBlcmYubWV0
cmljc19pZHIpOwo+ICsJaWRyX2Zvcl9lYWNoKCZpOTE1LT5wZXJmLm1ldHJpY3NfaWRyLCBkZXN0
cm95X2NvbmZpZywgaTkxNSk7Cj4gKwlpZHJfZGVzdHJveSgmaTkxNS0+cGVyZi5tZXRyaWNzX2lk
cik7Cj4gICAKPiAtCXVucmVnaXN0ZXJfc3lzY3RsX3RhYmxlKGRldl9wcml2LT5wZXJmLnN5c2N0
bF9oZWFkZXIpOwo+ICsJdW5yZWdpc3Rlcl9zeXNjdGxfdGFibGUoaTkxNS0+cGVyZi5zeXNjdGxf
aGVhZGVyKTsKPiAgIAo+IC0JbWVtc2V0KCZkZXZfcHJpdi0+cGVyZi5vYS5vcHMsIDAsIHNpemVv
ZihkZXZfcHJpdi0+cGVyZi5vYS5vcHMpKTsKPiArCW1lbXNldCgmaTkxNS0+cGVyZi5vYS5vcHMs
IDAsIHNpemVvZihpOTE1LT5wZXJmLm9hLm9wcykpOwo+ICAgCj4gLQlkZXZfcHJpdi0+cGVyZi5p
bml0aWFsaXplZCA9IGZhbHNlOwo+ICsJaTkxNS0+cGVyZi5pbml0aWFsaXplZCA9IGZhbHNlOwo+
ICAgfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wbXUuYwo+IGluZGV4IGViOWMwZTBlNTQ1Yy4uYzQ4NjFj
MTIxMDBjIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11LmMKPiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5jCj4gQEAgLTE1OSwyNCArMTU5LDI0
IEBAIGFkZF9zYW1wbGUoc3RydWN0IGk5MTVfcG11X3NhbXBsZSAqc2FtcGxlLCB1MzIgdmFsKQo+
ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZAo+IC1lbmdpbmVzX3NhbXBsZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHVuc2lnbmVkIGludCBwZXJpb2RfbnMpCj4gK2VuZ2luZXNf
c2FtcGxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1bnNpZ25lZCBpbnQgcGVyaW9k
X25zKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKPiAgIAllbnVt
IGludGVsX2VuZ2luZV9pZCBpZDsKPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiAgIAl1
bnNpZ25lZCBsb25nIGZsYWdzOwo+ICAgCj4gLQlpZiAoKGRldl9wcml2LT5wbXUuZW5hYmxlICYg
RU5HSU5FX1NBTVBMRV9NQVNLKSA9PSAwKQo+ICsJaWYgKChpOTE1LT5wbXUuZW5hYmxlICYgRU5H
SU5FX1NBTVBMRV9NQVNLKSA9PSAwKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAl3YWtlcmVmID0g
MDsKPiAtCWlmIChSRUFEX09OQ0UoZGV2X3ByaXYtPmd0LmF3YWtlKSkKPiAtCQl3YWtlcmVmID0g
aW50ZWxfcnVudGltZV9wbV9nZXRfaWZfaW5fdXNlKGRldl9wcml2KTsKPiArCWlmIChSRUFEX09O
Q0UoaTkxNS0+Z3QuYXdha2UpKQo+ICsJCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9p
Zl9pbl91c2UoaTkxNSk7Cj4gICAJaWYgKCF3YWtlcmVmKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAt
CXNwaW5fbG9ja19pcnFzYXZlKCZkZXZfcHJpdi0+dW5jb3JlLmxvY2ssIGZsYWdzKTsKPiAtCWZv
cl9lYWNoX2VuZ2luZShlbmdpbmUsIGRldl9wcml2LCBpZCkgewo+ICsJc3Bpbl9sb2NrX2lycXNh
dmUoJmk5MTUtPnVuY29yZS5sb2NrLCBmbGFncyk7Cj4gKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5l
LCBpOTE1LCBpZCkgewo+ICAgCQlzdHJ1Y3QgaW50ZWxfZW5naW5lX3BtdSAqcG11ID0gJmVuZ2lu
ZS0+cG11Owo+ICAgCQlib29sIGJ1c3k7Cj4gICAJCXUzMiB2YWw7Cj4gQEAgLTIwNSw5ICsyMDUs
OSBAQCBlbmdpbmVzX3NhbXBsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHVu
c2lnbmVkIGludCBwZXJpb2RfbnMpCj4gICAJCWlmIChidXN5KQo+ICAgCQkJYWRkX3NhbXBsZSgm
cG11LT5zYW1wbGVbSTkxNV9TQU1QTEVfQlVTWV0sIHBlcmlvZF9ucyk7Cj4gICAJfQo+IC0Jc3Bp
bl91bmxvY2tfaXJxcmVzdG9yZSgmZGV2X3ByaXYtPnVuY29yZS5sb2NrLCBmbGFncyk7Cj4gKwlz
cGluX3VubG9ja19pcnFyZXN0b3JlKCZpOTE1LT51bmNvcmUubG9jaywgZmxhZ3MpOwo+ICAgCj4g
LQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7Cj4gKwlpbnRlbF9ydW50
aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQKPiBA
QCAtMjE3LDMzICsyMTcsMzMgQEAgYWRkX3NhbXBsZV9tdWx0KHN0cnVjdCBpOTE1X3BtdV9zYW1w
bGUgKnNhbXBsZSwgdTMyIHZhbCwgdTMyIG11bCkKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQK
PiAtZnJlcXVlbmN5X3NhbXBsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHVu
c2lnbmVkIGludCBwZXJpb2RfbnMpCj4gK2ZyZXF1ZW5jeV9zYW1wbGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsIHVuc2lnbmVkIGludCBwZXJpb2RfbnMpCj4gICB7Cj4gLQlpZiAoZGV2
X3ByaXYtPnBtdS5lbmFibGUgJgo+ICsJaWYgKGk5MTUtPnBtdS5lbmFibGUgJgo+ICAgCSAgICBj
b25maWdfZW5hYmxlZF9tYXNrKEk5MTVfUE1VX0FDVFVBTF9GUkVRVUVOQ1kpKSB7Cj4gICAJCXUz
MiB2YWw7Cj4gICAKPiAtCQl2YWwgPSBkZXZfcHJpdi0+Z3RfcG0ucnBzLmN1cl9mcmVxOwo+IC0J
CWlmIChkZXZfcHJpdi0+Z3QuYXdha2UpIHsKPiArCQl2YWwgPSBpOTE1LT5ndF9wbS5ycHMuY3Vy
X2ZyZXE7Cj4gKwkJaWYgKGk5MTUtPmd0LmF3YWtlKSB7Cj4gICAJCQlpbnRlbF93YWtlcmVmX3Qg
d2FrZXJlZjsKPiAgIAo+IC0JCQl3aXRoX2ludGVsX3J1bnRpbWVfcG1faWZfaW5fdXNlKGRldl9w
cml2LCB3YWtlcmVmKSB7Cj4gLQkJCQl2YWwgPSBpbnRlbF91bmNvcmVfcmVhZF9ub3RyYWNlKCZk
ZXZfcHJpdi0+dW5jb3JlLAo+ICsJCQl3aXRoX2ludGVsX3J1bnRpbWVfcG1faWZfaW5fdXNlKGk5
MTUsIHdha2VyZWYpIHsKPiArCQkJCXZhbCA9IGludGVsX3VuY29yZV9yZWFkX25vdHJhY2UoJmk5
MTUtPnVuY29yZSwKPiAgIAkJCQkJCQkJR0VONl9SUFNUQVQxKTsKPiAtCQkJCXZhbCA9IGludGVs
X2dldF9jYWdmKGRldl9wcml2LCB2YWwpOwo+ICsJCQkJdmFsID0gaW50ZWxfZ2V0X2NhZ2YoaTkx
NSwgdmFsKTsKPiAgIAkJCX0KPiAgIAkJfQo+ICAgCj4gLQkJYWRkX3NhbXBsZV9tdWx0KCZkZXZf
cHJpdi0+cG11LnNhbXBsZVtfX0k5MTVfU0FNUExFX0ZSRVFfQUNUXSwKPiAtCQkJCWludGVsX2dw
dV9mcmVxKGRldl9wcml2LCB2YWwpLAo+ICsJCWFkZF9zYW1wbGVfbXVsdCgmaTkxNS0+cG11LnNh
bXBsZVtfX0k5MTVfU0FNUExFX0ZSRVFfQUNUXSwKPiArCQkJCWludGVsX2dwdV9mcmVxKGk5MTUs
IHZhbCksCj4gICAJCQkJcGVyaW9kX25zIC8gMTAwMCk7Cj4gICAJfQo+ICAgCj4gLQlpZiAoZGV2
X3ByaXYtPnBtdS5lbmFibGUgJgo+ICsJaWYgKGk5MTUtPnBtdS5lbmFibGUgJgo+ICAgCSAgICBj
b25maWdfZW5hYmxlZF9tYXNrKEk5MTVfUE1VX1JFUVVFU1RFRF9GUkVRVUVOQ1kpKSB7Cj4gLQkJ
YWRkX3NhbXBsZV9tdWx0KCZkZXZfcHJpdi0+cG11LnNhbXBsZVtfX0k5MTVfU0FNUExFX0ZSRVFf
UkVRXSwKPiAtCQkJCWludGVsX2dwdV9mcmVxKGRldl9wcml2LAo+IC0JCQkJCSAgICAgICBkZXZf
cHJpdi0+Z3RfcG0ucnBzLmN1cl9mcmVxKSwKPiArCQlhZGRfc2FtcGxlX211bHQoJmk5MTUtPnBt
dS5zYW1wbGVbX19JOTE1X1NBTVBMRV9GUkVRX1JFUV0sCj4gKwkJCQlpbnRlbF9ncHVfZnJlcShp
OTE1LAo+ICsJCQkJCSAgICAgICBpOTE1LT5ndF9wbS5ycHMuY3VyX2ZyZXEpLAo+ICAgCQkJCXBl
cmlvZF9ucyAvIDEwMDApOwo+ICAgCX0KPiAgIH0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9xdWVyeS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9xdWVyeS5j
Cj4gaW5kZXggN2I3MDE2MTcxMDU3Li44NzYwNjM2MmI1NmYgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9xdWVyeS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9xdWVyeS5jCj4gQEAgLTMxLDEwICszMSwxMCBAQCBzdGF0aWMgaW50IGNvcHlfcXVlcnlf
aXRlbSh2b2lkICpxdWVyeV9oZHIsIHNpemVfdCBxdWVyeV9zeiwKPiAgIAlyZXR1cm4gMDsKPiAg
IH0KPiAgIAo+IC1zdGF0aWMgaW50IHF1ZXJ5X3RvcG9sb2d5X2luZm8oc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgaW50IHF1ZXJ5X3RvcG9sb2d5X2luZm8oc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICAgICAgc3RydWN0IGRybV9pOTE1
X3F1ZXJ5X2l0ZW0gKnF1ZXJ5X2l0ZW0pCj4gICB7Cj4gLQljb25zdCBzdHJ1Y3Qgc3NldV9kZXZf
aW5mbyAqc3NldSA9ICZSVU5USU1FX0lORk8oZGV2X3ByaXYpLT5zc2V1Owo+ICsJY29uc3Qgc3Ry
dWN0IHNzZXVfZGV2X2luZm8gKnNzZXUgPSAmUlVOVElNRV9JTkZPKGk5MTUpLT5zc2V1Owo+ICAg
CXN0cnVjdCBkcm1faTkxNV9xdWVyeV90b3BvbG9neV9pbmZvIHRvcG87Cj4gICAJdTMyIHNsaWNl
X2xlbmd0aCwgc3Vic2xpY2VfbGVuZ3RoLCBldV9sZW5ndGgsIHRvdGFsX2xlbmd0aDsKPiAgIAl1
OCBzdWJzbGljZV9zdHJpZGUgPSBHRU5fU1NFVV9TVFJJREUoc3NldS0+bWF4X3N1YnNsaWNlcyk7
Cj4gQEAgLTE0Myw3ICsxNDMsNyBAQCBxdWVyeV9lbmdpbmVfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKPiAgIAlyZXR1cm4gbGVuOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBpbnQg
KCogY29uc3QgaTkxNV9xdWVyeV9mdW5jc1tdKShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gK3N0YXRpYyBpbnQgKCogY29uc3QgaTkxNV9xdWVyeV9mdW5jc1tdKShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkJc3RydWN0IGRybV9pOTE1X3F1ZXJ5X2l0
ZW0gKnF1ZXJ5X2l0ZW0pID0gewo+ICAgCXF1ZXJ5X3RvcG9sb2d5X2luZm8sCj4gICAJcXVlcnlf
ZW5naW5lX2luZm8sCj4gQEAgLTE1MSw3ICsxNTEsNyBAQCBzdGF0aWMgaW50ICgqIGNvbnN0IGk5
MTVfcXVlcnlfZnVuY3NbXSkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAg
Cj4gICBpbnQgaTkxNV9xdWVyeV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpk
YXRhLCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAlzdHJ1Y3QgZHJtX2k5MTVfcXVlcnkgKmFyZ3Mg
PSBkYXRhOwo+ICAgCXN0cnVjdCBkcm1faTkxNV9xdWVyeV9pdGVtIF9fdXNlciAqdXNlcl9pdGVt
X3B0ciA9Cj4gICAJCXU2NF90b191c2VyX3B0cihhcmdzLT5pdGVtc19wdHIpOwo+IEBAIC0xODAs
NyArMTgwLDcgQEAgaW50IGk5MTVfcXVlcnlfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwg
dm9pZCAqZGF0YSwgc3RydWN0IGRybV9maWxlICpmaWxlKQo+ICAgCQlpZiAoZnVuY19pZHggPCBB
UlJBWV9TSVpFKGk5MTVfcXVlcnlfZnVuY3MpKSB7Cj4gICAJCQlmdW5jX2lkeCA9IGFycmF5X2lu
ZGV4X25vc3BlYyhmdW5jX2lkeCwKPiAgIAkJCQkJCSAgICAgIEFSUkFZX1NJWkUoaTkxNV9xdWVy
eV9mdW5jcykpOwo+IC0JCQlyZXQgPSBpOTE1X3F1ZXJ5X2Z1bmNzW2Z1bmNfaWR4XShkZXZfcHJp
diwgJml0ZW0pOwo+ICsJCQlyZXQgPSBpOTE1X3F1ZXJ5X2Z1bmNzW2Z1bmNfaWR4XShpOTE1LCAm
aXRlbSk7Cj4gICAJCX0KPiAgIAo+ICAgCQkvKiBPbmx5IHdyaXRlIHRoZSBsZW5ndGggYmFjayB0
byB1c2Vyc3BhY2UgaWYgdGhleSBkaWZmZXIuICovCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfcmVnLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlZy5oCj4g
aW5kZXggZWRmOWY5MzkzNGExLi5iNTIyOTcwYmRmNzQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9yZWcuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
cmVnLmgKPiBAQCAtMjA1LDcgKzIwNSw3IEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBpOTE1X21taW9f
cmVnX3ZhbGlkKGk5MTVfcmVnX3QgcmVnKQo+ICAgI2RlZmluZSBWTFZfTUlQSV9CQVNFCQkJVkxW
X0RJU1BMQVlfQkFTRQo+ICAgI2RlZmluZSBCWFRfTUlQSV9CQVNFCQkJMHg2MDAwMAo+ICAgCj4g
LSNkZWZpbmUgRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpCShJTlRFTF9JTkZPKGRldl9wcml2
KS0+ZGlzcGxheV9tbWlvX29mZnNldCkKPiArI2RlZmluZSBESVNQTEFZX01NSU9fQkFTRShpOTE1
KQkoSU5URUxfSU5GTyhpOTE1KS0+ZGlzcGxheV9tbWlvX29mZnNldCkKPiAgIAo+ICAgLyoKPiAg
ICAqIEdpdmVuIHRoZSBmaXJzdCB0d28gbnVtYmVycyBfX2EgYW5kIF9fYiBvZiBhcmJpdHJhcmls
eSBtYW55IGV2ZW5seSBzcGFjZWQKPiBAQCAtMjQ3LDE1ICsyNDcsMTUgQEAgc3RhdGljIGlubGlu
ZSBib29sIGk5MTVfbW1pb19yZWdfdmFsaWQoaTkxNV9yZWdfdCByZWcpCj4gICAgKiBEZXZpY2Ug
aW5mbyBvZmZzZXQgYXJyYXkgYmFzZWQgaGVscGVycyBmb3IgZ3JvdXBzIG9mIHJlZ2lzdGVycyB3
aXRoIHVuZXZlbmx5Cj4gICAgKiBzcGFjZWQgYmFzZSBvZmZzZXRzLgo+ICAgICovCj4gLSNkZWZp
bmUgX01NSU9fUElQRTIocGlwZSwgcmVnKQkJX01NSU8oSU5URUxfSU5GTyhkZXZfcHJpdiktPnBp
cGVfb2Zmc2V0c1twaXBlXSAtIFwKPiAtCQkJCQkgICAgICBJTlRFTF9JTkZPKGRldl9wcml2KS0+
cGlwZV9vZmZzZXRzW1BJUEVfQV0gKyAocmVnKSArIFwKPiAtCQkJCQkgICAgICBESVNQTEFZX01N
SU9fQkFTRShkZXZfcHJpdikpCj4gLSNkZWZpbmUgX01NSU9fVFJBTlMyKHBpcGUsIHJlZykJCV9N
TUlPKElOVEVMX0lORk8oZGV2X3ByaXYpLT50cmFuc19vZmZzZXRzWyhwaXBlKV0gLSBcCj4gLQkJ
CQkJICAgICAgSU5URUxfSU5GTyhkZXZfcHJpdiktPnRyYW5zX29mZnNldHNbVFJBTlNDT0RFUl9B
XSArIChyZWcpICsgXAo+IC0JCQkJCSAgICAgIERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSkK
PiAtI2RlZmluZSBfQ1VSU09SMihwaXBlLCByZWcpCQlfTU1JTyhJTlRFTF9JTkZPKGRldl9wcml2
KS0+Y3Vyc29yX29mZnNldHNbKHBpcGUpXSAtIFwKPiAtCQkJCQkgICAgICBJTlRFTF9JTkZPKGRl
dl9wcml2KS0+Y3Vyc29yX29mZnNldHNbUElQRV9BXSArIChyZWcpICsgXAo+IC0JCQkJCSAgICAg
IERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSkKPiArI2RlZmluZSBfTU1JT19QSVBFMihwaXBl
LCByZWcpCQlfTU1JTyhJTlRFTF9JTkZPKGk5MTUpLT5waXBlX29mZnNldHNbcGlwZV0gLSBcCj4g
KwkJCQkJICAgICAgSU5URUxfSU5GTyhpOTE1KS0+cGlwZV9vZmZzZXRzW1BJUEVfQV0gKyAocmVn
KSArIFwKPiArCQkJCQkgICAgICBESVNQTEFZX01NSU9fQkFTRShpOTE1KSkKPiArI2RlZmluZSBf
TU1JT19UUkFOUzIocGlwZSwgcmVnKQkJX01NSU8oSU5URUxfSU5GTyhpOTE1KS0+dHJhbnNfb2Zm
c2V0c1socGlwZSldIC0gXAo+ICsJCQkJCSAgICAgIElOVEVMX0lORk8oaTkxNSktPnRyYW5zX29m
ZnNldHNbVFJBTlNDT0RFUl9BXSArIChyZWcpICsgXAo+ICsJCQkJCSAgICAgIERJU1BMQVlfTU1J
T19CQVNFKGk5MTUpKQo+ICsjZGVmaW5lIF9DVVJTT1IyKHBpcGUsIHJlZykJCV9NTUlPKElOVEVM
X0lORk8oaTkxNSktPmN1cnNvcl9vZmZzZXRzWyhwaXBlKV0gLSBcCj4gKwkJCQkJICAgICAgSU5U
RUxfSU5GTyhpOTE1KS0+Y3Vyc29yX29mZnNldHNbUElQRV9BXSArIChyZWcpICsgXAo+ICsJCQkJ
CSAgICAgIERJU1BMQVlfTU1JT19CQVNFKGk5MTUpKQo+ICAgCj4gICAjZGVmaW5lIF9fTUFTS0VE
X0ZJRUxEKG1hc2ssIHZhbHVlKSAoKG1hc2spIDw8IDE2IHwgKHZhbHVlKSkKPiAgICNkZWZpbmUg
X01BU0tFRF9GSUVMRChtYXNrLCB2YWx1ZSkgKHsJCQkJCSAgIFwKPiBAQCAtMTMwNyw3ICsxMzA3
LDcgQEAgZW51bSBpOTE1X3Bvd2VyX3dlbGxfaWQgewo+ICAgI2RlZmluZSAgRFBJT19DTU5SU1QJ
CQkoMSA8PCAwKQo+ICAgCj4gICAjZGVmaW5lIERQSU9fUEhZKHBpcGUpCQkJKChwaXBlKSA+PiAx
KQo+IC0jZGVmaW5lIERQSU9fUEhZX0lPU0ZfUE9SVChwaHkpCQkoZGV2X3ByaXYtPmRwaW9fcGh5
X2lvc2ZfcG9ydFtwaHldKQo+ICsjZGVmaW5lIERQSU9fUEhZX0lPU0ZfUE9SVChwaHkpCQkoaTkx
NS0+ZHBpb19waHlfaW9zZl9wb3J0W3BoeV0pCj4gICAKPiAgIC8qCj4gICAgKiBQZXIgcGlwZS9Q
TEwgRFBJTyByZWdzCj4gQEAgLTMwMDQsOSArMzAwNCw5IEBAIGVudW0gaTkxNV9wb3dlcl93ZWxs
X2lkIHsKPiAgICNkZWZpbmUgUE1fVkVCT1hfQ1NfRVJST1JfSU5URVJSVVBUCQkoMSA8PCAxMikg
LyogaHN3KyAqLwo+ICAgI2RlZmluZSBQTV9WRUJPWF9VU0VSX0lOVEVSUlVQVAkJCSgxIDw8IDEw
KSAvKiBoc3crICovCj4gICAKPiAtI2RlZmluZSBHVF9QQVJJVFlfRVJST1IoZGV2X3ByaXYpIFwK
PiArI2RlZmluZSBHVF9QQVJJVFlfRVJST1IoaTkxNSkgXAo+ICAgCShHVF9SRU5ERVJfTDNfUEFS
SVRZX0VSUk9SX0lOVEVSUlVQVCB8IFwKPiAtCSAoSVNfSEFTV0VMTChkZXZfcHJpdikgPyBHVF9S
RU5ERVJfTDNfUEFSSVRZX0VSUk9SX0lOVEVSUlVQVF9TMSA6IDApKQo+ICsJIChJU19IQVNXRUxM
KGk5MTUpID8gR1RfUkVOREVSX0wzX1BBUklUWV9FUlJPUl9JTlRFUlJVUFRfUzEgOiAwKSkKPiAg
IAo+ICAgLyogVGhlc2UgYXJlIGFsbCB0aGUgIm9sZCIgaW50ZXJydXB0cyAqLwo+ICAgI2RlZmlu
ZSBJTEtfQlNEX1VTRVJfSU5URVJSVVBUCQkJCSgxIDw8IDUpCj4gQEAgLTMxOTUsNyArMzE5NSw3
IEBAIGVudW0gaTkxNV9wb3dlcl93ZWxsX2lkIHsKPiAgIC8qCj4gICAgKiBHUElPIHJlZ3MKPiAg
ICAqLwo+IC0jZGVmaW5lIEdQSU8oZ3BpbykJCV9NTUlPKGRldl9wcml2LT5ncGlvX21taW9fYmFz
ZSArIDB4NTAxMCArIFwKPiArI2RlZmluZSBHUElPKGdwaW8pCQlfTU1JTyhpOTE1LT5ncGlvX21t
aW9fYmFzZSArIDB4NTAxMCArIFwKPiAgIAkJCQkgICAgICA0ICogKGdwaW8pKQo+ICAgCj4gICAj
IGRlZmluZSBHUElPX0NMT0NLX0RJUl9NQVNLCQkoMSA8PCAwKQo+IEBAIC0zMjEzLDcgKzMyMTMs
NyBAQCBlbnVtIGk5MTVfcG93ZXJfd2VsbF9pZCB7Cj4gICAjIGRlZmluZSBHUElPX0RBVEFfVkFM
X0lOCQkoMSA8PCAxMikKPiAgICMgZGVmaW5lIEdQSU9fREFUQV9QVUxMVVBfRElTQUJMRQkoMSA8
PCAxMykKPiAgIAo+IC0jZGVmaW5lIEdNQlVTMAkJCV9NTUlPKGRldl9wcml2LT5ncGlvX21taW9f
YmFzZSArIDB4NTEwMCkgLyogY2xvY2svcG9ydCBzZWxlY3QgKi8KPiArI2RlZmluZSBHTUJVUzAJ
CQlfTU1JTyhpOTE1LT5ncGlvX21taW9fYmFzZSArIDB4NTEwMCkgLyogY2xvY2svcG9ydCBzZWxl
Y3QgKi8KPiAgICNkZWZpbmUgICBHTUJVU19BS1NWX1NFTEVDVAkoMSA8PCAxMSkKPiAgICNkZWZp
bmUgICBHTUJVU19SQVRFXzEwMEtIWgkoMCA8PCA4KQo+ICAgI2RlZmluZSAgIEdNQlVTX1JBVEVf
NTBLSFoJKDEgPDwgOCkKPiBAQCAtMzI0MCw3ICszMjQwLDcgQEAgZW51bSBpOTE1X3Bvd2VyX3dl
bGxfaWQgewo+ICAgI2RlZmluZSAgIEdNQlVTX1BJTl8xMl9UQzRfSUNQCTEyCj4gICAKPiAgICNk
ZWZpbmUgICBHTUJVU19OVU1fUElOUwkxMyAvKiBpbmNsdWRpbmcgMCAqLwo+IC0jZGVmaW5lIEdN
QlVTMQkJCV9NTUlPKGRldl9wcml2LT5ncGlvX21taW9fYmFzZSArIDB4NTEwNCkgLyogY29tbWFu
ZC9zdGF0dXMgKi8KPiArI2RlZmluZSBHTUJVUzEJCQlfTU1JTyhpOTE1LT5ncGlvX21taW9fYmFz
ZSArIDB4NTEwNCkgLyogY29tbWFuZC9zdGF0dXMgKi8KPiAgICNkZWZpbmUgICBHTUJVU19TV19D
TFJfSU5UCSgxIDw8IDMxKQo+ICAgI2RlZmluZSAgIEdNQlVTX1NXX1JEWQkJKDEgPDwgMzApCj4g
ICAjZGVmaW5lICAgR01CVVNfRU5UCQkoMSA8PCAyOSkgLyogZW5hYmxlIHRpbWVvdXQgKi8KPiBA
QCAtMzI1NSw3ICszMjU1LDcgQEAgZW51bSBpOTE1X3Bvd2VyX3dlbGxfaWQgewo+ICAgI2RlZmlu
ZSAgIEdNQlVTX1NMQVZFX0FERFJfU0hJRlQgMQo+ICAgI2RlZmluZSAgIEdNQlVTX1NMQVZFX1JF
QUQJKDEgPDwgMCkKPiAgICNkZWZpbmUgICBHTUJVU19TTEFWRV9XUklURQkoMCA8PCAwKQo+IC0j
ZGVmaW5lIEdNQlVTMgkJCV9NTUlPKGRldl9wcml2LT5ncGlvX21taW9fYmFzZSArIDB4NTEwOCkg
Lyogc3RhdHVzICovCj4gKyNkZWZpbmUgR01CVVMyCQkJX01NSU8oaTkxNS0+Z3Bpb19tbWlvX2Jh
c2UgKyAweDUxMDgpIC8qIHN0YXR1cyAqLwo+ICAgI2RlZmluZSAgIEdNQlVTX0lOVVNFCQkoMSA8
PCAxNSkKPiAgICNkZWZpbmUgICBHTUJVU19IV19XQUlUX1BIQVNFCSgxIDw8IDE0KQo+ICAgI2Rl
ZmluZSAgIEdNQlVTX1NUQUxMX1RJTUVPVVQJKDEgPDwgMTMpCj4gQEAgLTMyNjMsMjIgKzMyNjMs
MjIgQEAgZW51bSBpOTE1X3Bvd2VyX3dlbGxfaWQgewo+ICAgI2RlZmluZSAgIEdNQlVTX0hXX1JE
WQkJKDEgPDwgMTEpCj4gICAjZGVmaW5lICAgR01CVVNfU0FUT0VSCQkoMSA8PCAxMCkKPiAgICNk
ZWZpbmUgICBHTUJVU19BQ1RJVkUJCSgxIDw8IDkpCj4gLSNkZWZpbmUgR01CVVMzCQkJX01NSU8o
ZGV2X3ByaXYtPmdwaW9fbW1pb19iYXNlICsgMHg1MTBjKSAvKiBkYXRhIGJ1ZmZlciBieXRlcyAz
LTAgKi8KPiAtI2RlZmluZSBHTUJVUzQJCQlfTU1JTyhkZXZfcHJpdi0+Z3Bpb19tbWlvX2Jhc2Ug
KyAweDUxMTApIC8qIGludGVycnVwdCBtYXNrIChQaW5ldmlldyspICovCj4gKyNkZWZpbmUgR01C
VVMzCQkJX01NSU8oaTkxNS0+Z3Bpb19tbWlvX2Jhc2UgKyAweDUxMGMpIC8qIGRhdGEgYnVmZmVy
IGJ5dGVzIDMtMCAqLwo+ICsjZGVmaW5lIEdNQlVTNAkJCV9NTUlPKGk5MTUtPmdwaW9fbW1pb19i
YXNlICsgMHg1MTEwKSAvKiBpbnRlcnJ1cHQgbWFzayAoUGluZXZpZXcrKSAqLwo+ICAgI2RlZmlu
ZSAgIEdNQlVTX1NMQVZFX1RJTUVPVVRfRU4gKDEgPDwgNCkKPiAgICNkZWZpbmUgICBHTUJVU19O
QUtfRU4JCSgxIDw8IDMpCj4gICAjZGVmaW5lICAgR01CVVNfSURMRV9FTgkJKDEgPDwgMikKPiAg
ICNkZWZpbmUgICBHTUJVU19IV19XQUlUX0VOCSgxIDw8IDEpCj4gICAjZGVmaW5lICAgR01CVVNf
SFdfUkRZX0VOCSgxIDw8IDApCj4gLSNkZWZpbmUgR01CVVM1CQkJX01NSU8oZGV2X3ByaXYtPmdw
aW9fbW1pb19iYXNlICsgMHg1MTIwKSAvKiBieXRlIGluZGV4ICovCj4gKyNkZWZpbmUgR01CVVM1
CQkJX01NSU8oaTkxNS0+Z3Bpb19tbWlvX2Jhc2UgKyAweDUxMjApIC8qIGJ5dGUgaW5kZXggKi8K
PiAgICNkZWZpbmUgICBHTUJVU18yQllURV9JTkRFWF9FTgkoMSA8PCAzMSkKPiAgIAo+ICAgLyoK
PiAgICAqIENsb2NrIGNvbnRyb2wgJiBwb3dlciBtYW5hZ2VtZW50Cj4gICAgKi8KPiAtI2RlZmlu
ZSBfRFBMTF9BIChESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDYwMTQpCj4gLSNkZWZp
bmUgX0RQTExfQiAoRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg2MDE4KQo+IC0jZGVm
aW5lIF9DSFZfRFBMTF9DIChESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDYwMzApCj4g
KyNkZWZpbmUgX0RQTExfQSAoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDYwMTQpCj4gKyNk
ZWZpbmUgX0RQTExfQiAoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDYwMTgpCj4gKyNkZWZp
bmUgX0NIVl9EUExMX0MgKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg2MDMwKQo+ICAgI2Rl
ZmluZSBEUExMKHBpcGUpIF9NTUlPX1BJUEUzKChwaXBlKSwgX0RQTExfQSwgX0RQTExfQiwgX0NI
Vl9EUExMX0MpCj4gICAKPiAgICNkZWZpbmUgVkdBMAlfTU1JTygweDYwMDApCj4gQEAgLTMzNzUs
OSArMzM3NSw5IEBAIGVudW0gaTkxNV9wb3dlcl93ZWxsX2lkIHsKPiAgICNkZWZpbmUgICBTRFZP
X01VTFRJUExJRVJfU0hJRlRfSElSRVMJCTQKPiAgICNkZWZpbmUgICBTRFZPX01VTFRJUExJRVJf
U0hJRlRfVkdBCQkwCj4gICAKPiAtI2RlZmluZSBfRFBMTF9BX01EIChESVNQTEFZX01NSU9fQkFT
RShkZXZfcHJpdikgKyAweDYwMWMpCj4gLSNkZWZpbmUgX0RQTExfQl9NRCAoRElTUExBWV9NTUlP
X0JBU0UoZGV2X3ByaXYpICsgMHg2MDIwKQo+IC0jZGVmaW5lIF9DSFZfRFBMTF9DX01EIChESVNQ
TEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDYwM2MpCj4gKyNkZWZpbmUgX0RQTExfQV9NRCAo
RElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDYwMWMpCj4gKyNkZWZpbmUgX0RQTExfQl9NRCAo
RElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDYwMjApCj4gKyNkZWZpbmUgX0NIVl9EUExMX0Nf
TUQgKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg2MDNjKQo+ICAgI2RlZmluZSBEUExMX01E
KHBpcGUpIF9NTUlPX1BJUEUzKChwaXBlKSwgX0RQTExfQV9NRCwgX0RQTExfQl9NRCwgX0NIVl9E
UExMX0NfTUQpCj4gICAKPiAgIC8qCj4gQEAgLTM0NDksNyArMzQ0OSw3IEBAIGVudW0gaTkxNV9w
b3dlcl93ZWxsX2lkIHsKPiAgICNkZWZpbmUgIERTVEFURV9QTExfRDNfT0ZGCQkJKDEgPDwgMykK
PiAgICNkZWZpbmUgIERTVEFURV9HRlhfQ0xPQ0tfR0FUSU5HCQkoMSA8PCAxKQo+ICAgI2RlZmlu
ZSAgRFNUQVRFX0RPVF9DTE9DS19HQVRJTkcJCSgxIDw8IDApCj4gLSNkZWZpbmUgRFNQQ0xLX0dB
VEVfRAlfTU1JTyhESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDYyMDApCj4gKyNkZWZp
bmUgRFNQQ0xLX0dBVEVfRAlfTU1JTyhESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjIwMCkK
PiAgICMgZGVmaW5lIERQVU5JVF9CX0NMT0NLX0dBVEVfRElTQUJMRQkJKDEgPDwgMzApIC8qIDk2
NSAqLwo+ICAgIyBkZWZpbmUgVlNVTklUX0NMT0NLX0dBVEVfRElTQUJMRQkJKDEgPDwgMjkpIC8q
IDk2NSAqLwo+ICAgIyBkZWZpbmUgVlJIVU5JVF9DTE9DS19HQVRFX0RJU0FCTEUJCSgxIDw8IDI4
KSAvKiA5NjUgKi8KPiBAQCAtMzU4OSw3ICszNTg5LDcgQEAgZW51bSBpOTE1X3Bvd2VyX3dlbGxf
aWQgewo+ICAgI2RlZmluZSBfUEFMRVRURV9BCQkweGEwMDAKPiAgICNkZWZpbmUgX1BBTEVUVEVf
QgkJMHhhODAwCj4gICAjZGVmaW5lIF9DSFZfUEFMRVRURV9DCQkweGMwMDAKPiAtI2RlZmluZSBQ
QUxFVFRFKHBpcGUsIGkpCV9NTUlPKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIFwKPiAr
I2RlZmluZSBQQUxFVFRFKHBpcGUsIGkpCV9NTUlPKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsg
XAo+ICAgCQkJCSAgICAgIF9QSUNLKChwaXBlKSwgX1BBTEVUVEVfQSwJCVwKPiAgIAkJCQkJICAg
IF9QQUxFVFRFX0IsIF9DSFZfUEFMRVRURV9DKSArIFwKPiAgIAkJCQkgICAgICAoaSkgKiA0KQo+
IEBAIC0zOTM2LDggKzM5MzYsOCBAQCBlbnVtIGk5MTVfcG93ZXJfd2VsbF9pZCB7Cj4gICAjZGVm
aW5lIElOVEVSVkFMXzFfMjhfVVModXMpCXJvdW5kdXAoKCh1cykgKiAxMDApID4+IDcsIDI1KQo+
ICAgI2RlZmluZSBJTlRFUlZBTF8xXzMzX1VTKHVzKQkoKCh1cykgKiAzKSAgID4+IDIpCj4gICAj
ZGVmaW5lIElOVEVSVkFMXzBfODMzX1VTKHVzKQkoKCh1cykgKiA2KSAvIDUpCj4gLSNkZWZpbmUg
R1RfSU5URVJWQUxfRlJPTV9VUyhkZXZfcHJpdiwgdXMpIChJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDkgPyBcCj4gLQkJCQkoSVNfR0VOOV9MUChkZXZfcHJpdikgPyBcCj4gKyNkZWZpbmUgR1RfSU5U
RVJWQUxfRlJPTV9VUyhpOTE1LCB1cykgKElOVEVMX0dFTihpOTE1KSA+PSA5ID8gXAo+ICsJCQkJ
KElTX0dFTjlfTFAoaTkxNSkgPyBcCj4gICAJCQkJSU5URVJWQUxfMF84MzNfVVModXMpIDogXAo+
ICAgCQkJCUlOVEVSVkFMXzFfMzNfVVModXMpKSA6IFwKPiAgIAkJCQlJTlRFUlZBTF8xXzI4X1VT
KHVzKSkKPiBAQCAtMzk0NSw4ICszOTQ1LDggQEAgZW51bSBpOTE1X3Bvd2VyX3dlbGxfaWQgewo+
ICAgI2RlZmluZSBJTlRFUlZBTF8xXzI4X1RPX1VTKGludGVydmFsKSAgKCgoaW50ZXJ2YWwpIDw8
IDcpIC8gMTAwKQo+ICAgI2RlZmluZSBJTlRFUlZBTF8xXzMzX1RPX1VTKGludGVydmFsKSAgKCgo
aW50ZXJ2YWwpIDw8IDIpIC8gMykKPiAgICNkZWZpbmUgSU5URVJWQUxfMF84MzNfVE9fVVMoaW50
ZXJ2YWwpICgoKGludGVydmFsKSAqIDUpICAvIDYpCj4gLSNkZWZpbmUgR1RfUE1fSU5URVJWQUxf
VE9fVVMoZGV2X3ByaXYsIGludGVydmFsKSAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5ID8gXAo+
IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAoSVNfR0VOOV9MUChkZXZfcHJpdikgPyBcCj4g
KyNkZWZpbmUgR1RfUE1fSU5URVJWQUxfVE9fVVMoaTkxNSwgaW50ZXJ2YWwpIChJTlRFTF9HRU4o
aTkxNSkgPj0gOSA/IFwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgKElTX0dFTjlfTFAo
aTkxNSkgPyBcCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJTlRFUlZBTF8wXzgzM19U
T19VUyhpbnRlcnZhbCkgOiBcCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJTlRFUlZB
TF8xXzMzX1RPX1VTKGludGVydmFsKSkgOiBcCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBJTlRFUlZBTF8xXzI4X1RPX1VTKGludGVydmFsKSkKPiBAQCAtNDIxOSw3ICs0MjE5LDcgQEAg
ZW51bSB7Cj4gICAvKiBIU1crIGVEUCBQU1IgcmVnaXN0ZXJzICovCj4gICAjZGVmaW5lIEhTV19F
RFBfUFNSX0JBU0UJMHg2NDgwMAo+ICAgI2RlZmluZSBCRFdfRURQX1BTUl9CQVNFCTB4NmY4MDAK
PiAtI2RlZmluZSBFRFBfUFNSX0NUTAkJCQlfTU1JTyhkZXZfcHJpdi0+cHNyX21taW9fYmFzZSAr
IDApCj4gKyNkZWZpbmUgRURQX1BTUl9DVEwJCQkJX01NSU8oaTkxNS0+cHNyX21taW9fYmFzZSAr
IDApCj4gICAjZGVmaW5lICAgRURQX1BTUl9FTkFCTEUJCQkoMSA8PCAzMSkKPiAgICNkZWZpbmUg
ICBCRFdfUFNSX1NJTkdMRV9GUkFNRQkJCSgxIDw8IDMwKQo+ICAgI2RlZmluZSAgIEVEUF9QU1Jf
UkVTVE9SRV9QU1JfQUNUSVZFX0NUWF9NQVNLCSgxIDw8IDI5KSAvKiBTVyBjYW4ndCBtb2RpZnkg
Ki8KPiBAQCAtNDI1NiwxNiArNDI1NiwxNiBAQCBlbnVtIHsKPiAgICNkZWZpbmUgICBFRFBfUFNS
X1RSQU5TQ09ERVJfQV9TSElGVAkJOAo+ICAgI2RlZmluZSAgIEVEUF9QU1JfVFJBTlNDT0RFUl9F
RFBfU0hJRlQJCTAKPiAgIAo+IC0jZGVmaW5lIEVEUF9QU1JfQVVYX0NUTAkJCQlfTU1JTyhkZXZf
cHJpdi0+cHNyX21taW9fYmFzZSArIDB4MTApCj4gKyNkZWZpbmUgRURQX1BTUl9BVVhfQ1RMCQkJ
CV9NTUlPKGk5MTUtPnBzcl9tbWlvX2Jhc2UgKyAweDEwKQo+ICAgI2RlZmluZSAgIEVEUF9QU1Jf
QVVYX0NUTF9USU1FX09VVF9NQVNLCQkoMyA8PCAyNikKPiAgICNkZWZpbmUgICBFRFBfUFNSX0FV
WF9DVExfTUVTU0FHRV9TSVpFX01BU0sJKDB4MWYgPDwgMjApCj4gICAjZGVmaW5lICAgRURQX1BT
Ul9BVVhfQ1RMX1BSRUNIQVJHRV8yVVNfTUFTSwkoMHhmIDw8IDE2KQo+ICAgI2RlZmluZSAgIEVE
UF9QU1JfQVVYX0NUTF9FUlJPUl9JTlRFUlJVUFQJKDEgPDwgMTEpCj4gICAjZGVmaW5lICAgRURQ
X1BTUl9BVVhfQ1RMX0JJVF9DTE9DS18yWF9NQVNLCSgweDdmZikKPiAgIAo+IC0jZGVmaW5lIEVE
UF9QU1JfQVVYX0RBVEEoaSkJCQlfTU1JTyhkZXZfcHJpdi0+cHNyX21taW9fYmFzZSArIDB4MTQg
KyAoaSkgKiA0KSAvKiA1IHJlZ2lzdGVycyAqLwo+ICsjZGVmaW5lIEVEUF9QU1JfQVVYX0RBVEEo
aSkJCQlfTU1JTyhpOTE1LT5wc3JfbW1pb19iYXNlICsgMHgxNCArIChpKSAqIDQpIC8qIDUgcmVn
aXN0ZXJzICovCj4gICAKPiAtI2RlZmluZSBFRFBfUFNSX1NUQVRVUwkJCQlfTU1JTyhkZXZfcHJp
di0+cHNyX21taW9fYmFzZSArIDB4NDApCj4gKyNkZWZpbmUgRURQX1BTUl9TVEFUVVMJCQkJX01N
SU8oaTkxNS0+cHNyX21taW9fYmFzZSArIDB4NDApCj4gICAjZGVmaW5lICAgRURQX1BTUl9TVEFU
VVNfU1RBVEVfTUFTSwkJKDcgPDwgMjkpCj4gICAjZGVmaW5lICAgRURQX1BTUl9TVEFUVVNfU1RB
VEVfU0hJRlQJCTI5Cj4gICAjZGVmaW5lICAgRURQX1BTUl9TVEFUVVNfU1RBVEVfSURMRQkJKDAg
PDwgMjkpCj4gQEAgLTQyOTAsMTAgKzQyOTAsMTAgQEAgZW51bSB7Cj4gICAjZGVmaW5lICAgRURQ
X1BTUl9TVEFUVVNfU0VORElOR19UUDEJCSgxIDw8IDQpCj4gICAjZGVmaW5lICAgRURQX1BTUl9T
VEFUVVNfSURMRV9NQVNLCQkweGYKPiAgIAo+IC0jZGVmaW5lIEVEUF9QU1JfUEVSRl9DTlQJCV9N
TUlPKGRldl9wcml2LT5wc3JfbW1pb19iYXNlICsgMHg0NCkKPiArI2RlZmluZSBFRFBfUFNSX1BF
UkZfQ05UCQlfTU1JTyhpOTE1LT5wc3JfbW1pb19iYXNlICsgMHg0NCkKPiAgICNkZWZpbmUgICBF
RFBfUFNSX1BFUkZfQ05UX01BU0sJCTB4ZmZmZmZmCj4gICAKPiAtI2RlZmluZSBFRFBfUFNSX0RF
QlVHCQkJCV9NTUlPKGRldl9wcml2LT5wc3JfbW1pb19iYXNlICsgMHg2MCkgLyogUFNSX01BU0sg
b24gU0tMKyAqLwo+ICsjZGVmaW5lIEVEUF9QU1JfREVCVUcJCQkJX01NSU8oaTkxNS0+cHNyX21t
aW9fYmFzZSArIDB4NjApIC8qIFBTUl9NQVNLIG9uIFNLTCsgKi8KPiAgICNkZWZpbmUgICBFRFBf
UFNSX0RFQlVHX01BU0tfTUFYX1NMRUVQICAgICAgICAgKDEgPDwgMjgpCj4gICAjZGVmaW5lICAg
RURQX1BTUl9ERUJVR19NQVNLX0xQU1AgICAgICAgICAgICAgICgxIDw8IDI3KQo+ICAgI2RlZmlu
ZSAgIEVEUF9QU1JfREVCVUdfTUFTS19NRU1VUCAgICAgICAgICAgICAoMSA8PCAyNikKPiBAQCAt
NDQwNSw3ICs0NDA1LDcgQEAgZW51bSB7Cj4gICAKPiAgIAo+ICAgLyogSG90cGx1ZyBjb250cm9s
ICg5NDUrIG9ubHkpICovCj4gLSNkZWZpbmUgUE9SVF9IT1RQTFVHX0VOCQlfTU1JTyhESVNQTEFZ
X01NSU9fQkFTRShkZXZfcHJpdikgKyAweDYxMTEwKQo+ICsjZGVmaW5lIFBPUlRfSE9UUExVR19F
TgkJX01NSU8oRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDYxMTEwKQo+ICAgI2RlZmluZSAg
IFBPUlRCX0hPVFBMVUdfSU5UX0VOCQkJKDEgPDwgMjkpCj4gICAjZGVmaW5lICAgUE9SVENfSE9U
UExVR19JTlRfRU4JCQkoMSA8PCAyOCkKPiAgICNkZWZpbmUgICBQT1JURF9IT1RQTFVHX0lOVF9F
TgkJCSgxIDw8IDI3KQo+IEBAIC00NDM1LDcgKzQ0MzUsNyBAQCBlbnVtIHsKPiAgICNkZWZpbmUg
Q1JUX0hPVFBMVUdfREVURUNUX1ZPTFRBR0VfMzI1TVYJKDAgPDwgMikKPiAgICNkZWZpbmUgQ1JU
X0hPVFBMVUdfREVURUNUX1ZPTFRBR0VfNDc1TVYJKDEgPDwgMikKPiAgIAo+IC0jZGVmaW5lIFBP
UlRfSE9UUExVR19TVEFUCV9NTUlPKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjEx
MTQpCj4gKyNkZWZpbmUgUE9SVF9IT1RQTFVHX1NUQVQJX01NSU8oRElTUExBWV9NTUlPX0JBU0Uo
aTkxNSkgKyAweDYxMTE0KQo+ICAgLyoKPiAgICAqIEhETUkvRFAgYml0cyBhcmUgZzR4Kwo+ICAg
ICoKPiBAQCAtNDUxNyw3ICs0NTE3LDcgQEAgZW51bSB7Cj4gICAKPiAgICNkZWZpbmUgUE9SVF9E
RlRfSTlYWAkJCQlfTU1JTygweDYxMTUwKQo+ICAgI2RlZmluZSAgIERDX0JBTEFOQ0VfUkVTRVQJ
CQkoMSA8PCAyNSkKPiAtI2RlZmluZSBQT1JUX0RGVDJfRzRYCQlfTU1JTyhESVNQTEFZX01NSU9f
QkFTRShkZXZfcHJpdikgKyAweDYxMTU0KQo+ICsjZGVmaW5lIFBPUlRfREZUMl9HNFgJCV9NTUlP
KERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg2MTE1NCkKPiAgICNkZWZpbmUgICBEQ19CQUxB
TkNFX1JFU0VUX1ZMVgkJCSgxIDw8IDMxKQo+ICAgI2RlZmluZSAgIFBJUEVfU0NSQU1CTEVfUkVT
RVRfTUFTSwkJKCgxIDw8IDE0KSB8ICgweDMgPDwgMCkpCj4gICAjZGVmaW5lICAgUElQRV9DX1ND
UkFNQkxFX1JFU0VUCQkJKDEgPDwgMTQpIC8qIGNodiAqLwo+IEBAIC00NzE5LDcgKzQ3MTksNyBA
QCBlbnVtIHsKPiAgICNkZWZpbmUgVkxWX1BQU19CQVNFCQkJKFZMVl9ESVNQTEFZX0JBU0UgKyBQ
UFNfQkFTRSkKPiAgICNkZWZpbmUgUENIX1BQU19CQVNFCQkJMHhDNzIwMAo+ICAgCj4gLSNkZWZp
bmUgX01NSU9fUFBTKHBwc19pZHgsIHJlZykJCV9NTUlPKGRldl9wcml2LT5wcHNfbW1pb19iYXNl
IC0JXAo+ICsjZGVmaW5lIF9NTUlPX1BQUyhwcHNfaWR4LCByZWcpCQlfTU1JTyhpOTE1LT5wcHNf
bW1pb19iYXNlIC0JXAo+ICAgCQkJCQkgICAgICBQUFNfQkFTRSArIChyZWcpICsJXAo+ICAgCQkJ
CQkgICAgICAocHBzX2lkeCkgKiAweDEwMCkKPiAgIAo+IEBAIC00NzkyLDcgKzQ3OTIsNyBAQCBl
bnVtIHsKPiAgICNkZWZpbmUgIFBBTkVMX1BPV0VSX0NZQ0xFX0RFTEFZX01BU0sJUkVHX0dFTk1B
U0soNCwgMCkKPiAgIAo+ICAgLyogUGFuZWwgZml0dGluZyAqLwo+IC0jZGVmaW5lIFBGSVRfQ09O
VFJPTAlfTU1JTyhESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDYxMjMwKQo+ICsjZGVm
aW5lIFBGSVRfQ09OVFJPTAlfTU1JTyhESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjEyMzAp
Cj4gICAjZGVmaW5lICAgUEZJVF9FTkFCTEUJCSgxIDw8IDMxKQo+ICAgI2RlZmluZSAgIFBGSVRf
UElQRV9NQVNLCSgzIDw8IDI5KQo+ICAgI2RlZmluZSAgIFBGSVRfUElQRV9TSElGVAkyOQo+IEBA
IC00ODEwLDcgKzQ4MTAsNyBAQCBlbnVtIHsKPiAgICNkZWZpbmUgICBQRklUX1NDQUxJTkdfUFJP
R1JBTU1FRCAoMSA8PCAyNikKPiAgICNkZWZpbmUgICBQRklUX1NDQUxJTkdfUElMTEFSCSgyIDw8
IDI2KQo+ICAgI2RlZmluZSAgIFBGSVRfU0NBTElOR19MRVRURVIJKDMgPDwgMjYpCj4gLSNkZWZp
bmUgUEZJVF9QR01fUkFUSU9TIF9NTUlPKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4
NjEyMzQpCj4gKyNkZWZpbmUgUEZJVF9QR01fUkFUSU9TIF9NTUlPKERJU1BMQVlfTU1JT19CQVNF
KGk5MTUpICsgMHg2MTIzNCkKPiAgIC8qIFByZS05NjUgKi8KPiAgICNkZWZpbmUJCVBGSVRfVkVS
VF9TQ0FMRV9TSElGVAkJMjAKPiAgICNkZWZpbmUJCVBGSVRfVkVSVF9TQ0FMRV9NQVNLCQkweGZm
ZjAwMDAwCj4gQEAgLTQ4MjIsMjUgKzQ4MjIsMjUgQEAgZW51bSB7Cj4gICAjZGVmaW5lCQlQRklU
X0hPUklaX1NDQUxFX1NISUZUXzk2NQkwCj4gICAjZGVmaW5lCQlQRklUX0hPUklaX1NDQUxFX01B
U0tfOTY1CTB4MDAwMDFmZmYKPiAgIAo+IC0jZGVmaW5lIFBGSVRfQVVUT19SQVRJT1MgX01NSU8o
RElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg2MTIzOCkKPiArI2RlZmluZSBQRklUX0FV
VE9fUkFUSU9TIF9NTUlPKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg2MTIzOCkKPiAgIAo+
IC0jZGVmaW5lIF9WTFZfQkxDX1BXTV9DVEwyX0EgKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2
KSArIDB4NjEyNTApCj4gLSNkZWZpbmUgX1ZMVl9CTENfUFdNX0NUTDJfQiAoRElTUExBWV9NTUlP
X0JBU0UoZGV2X3ByaXYpICsgMHg2MTM1MCkKPiArI2RlZmluZSBfVkxWX0JMQ19QV01fQ1RMMl9B
IChESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjEyNTApCj4gKyNkZWZpbmUgX1ZMVl9CTENf
UFdNX0NUTDJfQiAoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDYxMzUwKQo+ICAgI2RlZmlu
ZSBWTFZfQkxDX1BXTV9DVEwyKHBpcGUpIF9NTUlPX1BJUEUocGlwZSwgX1ZMVl9CTENfUFdNX0NU
TDJfQSwgXAo+ICAgCQkJCQkgX1ZMVl9CTENfUFdNX0NUTDJfQikKPiAgIAo+IC0jZGVmaW5lIF9W
TFZfQkxDX1BXTV9DVExfQSAoRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg2MTI1NCkK
PiAtI2RlZmluZSBfVkxWX0JMQ19QV01fQ1RMX0IgKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2
KSArIDB4NjEzNTQpCj4gKyNkZWZpbmUgX1ZMVl9CTENfUFdNX0NUTF9BIChESVNQTEFZX01NSU9f
QkFTRShpOTE1KSArIDB4NjEyNTQpCj4gKyNkZWZpbmUgX1ZMVl9CTENfUFdNX0NUTF9CIChESVNQ
TEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjEzNTQpCj4gICAjZGVmaW5lIFZMVl9CTENfUFdNX0NU
TChwaXBlKSBfTU1JT19QSVBFKHBpcGUsIF9WTFZfQkxDX1BXTV9DVExfQSwgXAo+ICAgCQkJCQlf
VkxWX0JMQ19QV01fQ1RMX0IpCj4gICAKPiAtI2RlZmluZSBfVkxWX0JMQ19ISVNUX0NUTF9BIChE
SVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDYxMjYwKQo+IC0jZGVmaW5lIF9WTFZfQkxD
X0hJU1RfQ1RMX0IgKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjEzNjApCj4gKyNk
ZWZpbmUgX1ZMVl9CTENfSElTVF9DVExfQSAoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDYx
MjYwKQo+ICsjZGVmaW5lIF9WTFZfQkxDX0hJU1RfQ1RMX0IgKERJU1BMQVlfTU1JT19CQVNFKGk5
MTUpICsgMHg2MTM2MCkKPiAgICNkZWZpbmUgVkxWX0JMQ19ISVNUX0NUTChwaXBlKSBfTU1JT19Q
SVBFKHBpcGUsIF9WTFZfQkxDX0hJU1RfQ1RMX0EsIFwKPiAgIAkJCQkJIF9WTFZfQkxDX0hJU1Rf
Q1RMX0IpCj4gICAKPiAgIC8qIEJhY2tsaWdodCBjb250cm9sICovCj4gLSNkZWZpbmUgQkxDX1BX
TV9DVEwyCV9NTUlPKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjEyNTApIC8qIDk2
NSsgb25seSAqLwo+ICsjZGVmaW5lIEJMQ19QV01fQ1RMMglfTU1JTyhESVNQTEFZX01NSU9fQkFT
RShpOTE1KSArIDB4NjEyNTApIC8qIDk2NSsgb25seSAqLwo+ICAgI2RlZmluZSAgIEJMTV9QV01f
RU5BQkxFCQkoMSA8PCAzMSkKPiAgICNkZWZpbmUgICBCTE1fQ09NQklOQVRJT05fTU9ERQkJKDEg
PDwgMzApIC8qIGdlbjQgb25seSAqLwo+ICAgI2RlZmluZSAgIEJMTV9QSVBFX1NFTEVDVAkJKDEg
PDwgMjkpCj4gQEAgLTQ4NjMsNyArNDg2Myw3IEBAIGVudW0gewo+ICAgI2RlZmluZSAgIEJMTV9Q
SEFTRV9JTl9DT1VOVF9NQVNLCSgweGZmIDw8IDgpCj4gICAjZGVmaW5lICAgQkxNX1BIQVNFX0lO
X0lOQ1JfU0hJRlQJKDApCj4gICAjZGVmaW5lICAgQkxNX1BIQVNFX0lOX0lOQ1JfTUFTSwkoMHhm
ZiA8PCAwKQo+IC0jZGVmaW5lIEJMQ19QV01fQ1RMCV9NTUlPKERJU1BMQVlfTU1JT19CQVNFKGRl
dl9wcml2KSArIDB4NjEyNTQpCj4gKyNkZWZpbmUgQkxDX1BXTV9DVEwJX01NSU8oRElTUExBWV9N
TUlPX0JBU0UoaTkxNSkgKyAweDYxMjU0KQo+ICAgLyoKPiAgICAqIFRoaXMgaXMgdGhlIG1vc3Qg
c2lnbmlmaWNhbnQgMTUgYml0cyBvZiB0aGUgbnVtYmVyIG9mIGJhY2tsaWdodCBjeWNsZXMgaW4g
YQo+ICAgICogY29tcGxldGUgY3ljbGUgb2YgdGhlIG1vZHVsYXRlZCBiYWNrbGlnaHQgY29udHJv
bC4KPiBAQCAtNDg4NSw3ICs0ODg1LDcgQEAgZW51bSB7Cj4gICAjZGVmaW5lICAgQkFDS0xJR0hU
X0RVVFlfQ1lDTEVfTUFTS19QTlYJCSgweGZmZmUpCj4gICAjZGVmaW5lICAgQkxNX1BPTEFSSVRZ
X1BOVgkJCSgxIDw8IDApIC8qIHBudiBvbmx5ICovCj4gICAKPiAtI2RlZmluZSBCTENfSElTVF9D
VEwJX01NSU8oRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg2MTI2MCkKPiArI2RlZmlu
ZSBCTENfSElTVF9DVEwJX01NSU8oRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDYxMjYwKQo+
ICAgI2RlZmluZSAgQkxNX0hJU1RPR1JBTV9FTkFCTEUJCQkoMSA8PCAzMSkKPiAgIAo+ICAgLyog
TmV3IHJlZ2lzdGVycyBmb3IgUENILXNwbGl0IHBsYXRmb3Jtcy4gU2FmZSB3aGVyZSBuZXcgYml0
cyBzaG93IHVwLCB0aGUKPiBAQCAtNTUxMCw0NyArNTUxMCw0NyBAQCBlbnVtIHsKPiAgICAqIGlz
IDIwIGJ5dGVzIGluIGVhY2ggZGlyZWN0aW9uLCBoZW5jZSB0aGUgNSBmaXhlZAo+ICAgICogZGF0
YSByZWdpc3RlcnMKPiAgICAqLwo+IC0jZGVmaW5lIF9EUEFfQVVYX0NIX0NUTAkJKERJU1BMQVlf
TU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQwMTApCj4gLSNkZWZpbmUgX0RQQV9BVVhfQ0hfREFU
QTEJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQwMTQpCj4gLSNkZWZpbmUgX0RQ
QV9BVVhfQ0hfREFUQTIJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQwMTgpCj4g
LSNkZWZpbmUgX0RQQV9BVVhfQ0hfREFUQTMJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSAr
IDB4NjQwMWMpCj4gLSNkZWZpbmUgX0RQQV9BVVhfQ0hfREFUQTQJKERJU1BMQVlfTU1JT19CQVNF
KGRldl9wcml2KSArIDB4NjQwMjApCj4gLSNkZWZpbmUgX0RQQV9BVVhfQ0hfREFUQTUJKERJU1BM
QVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQwMjQpCj4gLQo+IC0jZGVmaW5lIF9EUEJfQVVY
X0NIX0NUTAkJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQxMTApCj4gLSNkZWZp
bmUgX0RQQl9BVVhfQ0hfREFUQTEJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQx
MTQpCj4gLSNkZWZpbmUgX0RQQl9BVVhfQ0hfREFUQTIJKERJU1BMQVlfTU1JT19CQVNFKGRldl9w
cml2KSArIDB4NjQxMTgpCj4gLSNkZWZpbmUgX0RQQl9BVVhfQ0hfREFUQTMJKERJU1BMQVlfTU1J
T19CQVNFKGRldl9wcml2KSArIDB4NjQxMWMpCj4gLSNkZWZpbmUgX0RQQl9BVVhfQ0hfREFUQTQJ
KERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQxMjApCj4gLSNkZWZpbmUgX0RQQl9B
VVhfQ0hfREFUQTUJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQxMjQpCj4gLQo+
IC0jZGVmaW5lIF9EUENfQVVYX0NIX0NUTAkJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSAr
IDB4NjQyMTApCj4gLSNkZWZpbmUgX0RQQ19BVVhfQ0hfREFUQTEJKERJU1BMQVlfTU1JT19CQVNF
KGRldl9wcml2KSArIDB4NjQyMTQpCj4gLSNkZWZpbmUgX0RQQ19BVVhfQ0hfREFUQTIJKERJU1BM
QVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQyMTgpCj4gLSNkZWZpbmUgX0RQQ19BVVhfQ0hf
REFUQTMJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQyMWMpCj4gLSNkZWZpbmUg
X0RQQ19BVVhfQ0hfREFUQTQJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQyMjAp
Cj4gLSNkZWZpbmUgX0RQQ19BVVhfQ0hfREFUQTUJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2
KSArIDB4NjQyMjQpCj4gLQo+IC0jZGVmaW5lIF9EUERfQVVYX0NIX0NUTAkJKERJU1BMQVlfTU1J
T19CQVNFKGRldl9wcml2KSArIDB4NjQzMTApCj4gLSNkZWZpbmUgX0RQRF9BVVhfQ0hfREFUQTEJ
KERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQzMTQpCj4gLSNkZWZpbmUgX0RQRF9B
VVhfQ0hfREFUQTIJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQzMTgpCj4gLSNk
ZWZpbmUgX0RQRF9BVVhfQ0hfREFUQTMJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4
NjQzMWMpCj4gLSNkZWZpbmUgX0RQRF9BVVhfQ0hfREFUQTQJKERJU1BMQVlfTU1JT19CQVNFKGRl
dl9wcml2KSArIDB4NjQzMjApCj4gLSNkZWZpbmUgX0RQRF9BVVhfQ0hfREFUQTUJKERJU1BMQVlf
TU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQzMjQpCj4gLQo+IC0jZGVmaW5lIF9EUEVfQVVYX0NI
X0NUTAkJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQ0MTApCj4gLSNkZWZpbmUg
X0RQRV9BVVhfQ0hfREFUQTEJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQ0MTQp
Cj4gLSNkZWZpbmUgX0RQRV9BVVhfQ0hfREFUQTIJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2
KSArIDB4NjQ0MTgpCj4gLSNkZWZpbmUgX0RQRV9BVVhfQ0hfREFUQTMJKERJU1BMQVlfTU1JT19C
QVNFKGRldl9wcml2KSArIDB4NjQ0MWMpCj4gLSNkZWZpbmUgX0RQRV9BVVhfQ0hfREFUQTQJKERJ
U1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQ0MjApCj4gLSNkZWZpbmUgX0RQRV9BVVhf
Q0hfREFUQTUJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQ0MjQpCj4gLQo+IC0j
ZGVmaW5lIF9EUEZfQVVYX0NIX0NUTAkJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4
NjQ1MTApCj4gLSNkZWZpbmUgX0RQRl9BVVhfQ0hfREFUQTEJKERJU1BMQVlfTU1JT19CQVNFKGRl
dl9wcml2KSArIDB4NjQ1MTQpCj4gLSNkZWZpbmUgX0RQRl9BVVhfQ0hfREFUQTIJKERJU1BMQVlf
TU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQ1MTgpCj4gLSNkZWZpbmUgX0RQRl9BVVhfQ0hfREFU
QTMJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQ1MWMpCj4gLSNkZWZpbmUgX0RQ
Rl9BVVhfQ0hfREFUQTQJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQ1MjApCj4g
LSNkZWZpbmUgX0RQRl9BVVhfQ0hfREFUQTUJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSAr
IDB4NjQ1MjQpCj4gKyNkZWZpbmUgX0RQQV9BVVhfQ0hfQ1RMCQkoRElTUExBWV9NTUlPX0JBU0Uo
aTkxNSkgKyAweDY0MDEwKQo+ICsjZGVmaW5lIF9EUEFfQVVYX0NIX0RBVEExCShESVNQTEFZX01N
SU9fQkFTRShpOTE1KSArIDB4NjQwMTQpCj4gKyNkZWZpbmUgX0RQQV9BVVhfQ0hfREFUQTIJKERJ
U1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg2NDAxOCkKPiArI2RlZmluZSBfRFBBX0FVWF9DSF9E
QVRBMwkoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDY0MDFjKQo+ICsjZGVmaW5lIF9EUEFf
QVVYX0NIX0RBVEE0CShESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjQwMjApCj4gKyNkZWZp
bmUgX0RQQV9BVVhfQ0hfREFUQTUJKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg2NDAyNCkK
PiArCj4gKyNkZWZpbmUgX0RQQl9BVVhfQ0hfQ1RMCQkoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkg
KyAweDY0MTEwKQo+ICsjZGVmaW5lIF9EUEJfQVVYX0NIX0RBVEExCShESVNQTEFZX01NSU9fQkFT
RShpOTE1KSArIDB4NjQxMTQpCj4gKyNkZWZpbmUgX0RQQl9BVVhfQ0hfREFUQTIJKERJU1BMQVlf
TU1JT19CQVNFKGk5MTUpICsgMHg2NDExOCkKPiArI2RlZmluZSBfRFBCX0FVWF9DSF9EQVRBMwko
RElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDY0MTFjKQo+ICsjZGVmaW5lIF9EUEJfQVVYX0NI
X0RBVEE0CShESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjQxMjApCj4gKyNkZWZpbmUgX0RQ
Ql9BVVhfQ0hfREFUQTUJKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg2NDEyNCkKPiArCj4g
KyNkZWZpbmUgX0RQQ19BVVhfQ0hfQ1RMCQkoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDY0
MjEwKQo+ICsjZGVmaW5lIF9EUENfQVVYX0NIX0RBVEExCShESVNQTEFZX01NSU9fQkFTRShpOTE1
KSArIDB4NjQyMTQpCj4gKyNkZWZpbmUgX0RQQ19BVVhfQ0hfREFUQTIJKERJU1BMQVlfTU1JT19C
QVNFKGk5MTUpICsgMHg2NDIxOCkKPiArI2RlZmluZSBfRFBDX0FVWF9DSF9EQVRBMwkoRElTUExB
WV9NTUlPX0JBU0UoaTkxNSkgKyAweDY0MjFjKQo+ICsjZGVmaW5lIF9EUENfQVVYX0NIX0RBVEE0
CShESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjQyMjApCj4gKyNkZWZpbmUgX0RQQ19BVVhf
Q0hfREFUQTUJKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg2NDIyNCkKPiArCj4gKyNkZWZp
bmUgX0RQRF9BVVhfQ0hfQ1RMCQkoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDY0MzEwKQo+
ICsjZGVmaW5lIF9EUERfQVVYX0NIX0RBVEExCShESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4
NjQzMTQpCj4gKyNkZWZpbmUgX0RQRF9BVVhfQ0hfREFUQTIJKERJU1BMQVlfTU1JT19CQVNFKGk5
MTUpICsgMHg2NDMxOCkKPiArI2RlZmluZSBfRFBEX0FVWF9DSF9EQVRBMwkoRElTUExBWV9NTUlP
X0JBU0UoaTkxNSkgKyAweDY0MzFjKQo+ICsjZGVmaW5lIF9EUERfQVVYX0NIX0RBVEE0CShESVNQ
TEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjQzMjApCj4gKyNkZWZpbmUgX0RQRF9BVVhfQ0hfREFU
QTUJKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg2NDMyNCkKPiArCj4gKyNkZWZpbmUgX0RQ
RV9BVVhfQ0hfQ1RMCQkoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDY0NDEwKQo+ICsjZGVm
aW5lIF9EUEVfQVVYX0NIX0RBVEExCShESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjQ0MTQp
Cj4gKyNkZWZpbmUgX0RQRV9BVVhfQ0hfREFUQTIJKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsg
MHg2NDQxOCkKPiArI2RlZmluZSBfRFBFX0FVWF9DSF9EQVRBMwkoRElTUExBWV9NTUlPX0JBU0Uo
aTkxNSkgKyAweDY0NDFjKQo+ICsjZGVmaW5lIF9EUEVfQVVYX0NIX0RBVEE0CShESVNQTEFZX01N
SU9fQkFTRShpOTE1KSArIDB4NjQ0MjApCj4gKyNkZWZpbmUgX0RQRV9BVVhfQ0hfREFUQTUJKERJ
U1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg2NDQyNCkKPiArCj4gKyNkZWZpbmUgX0RQRl9BVVhf
Q0hfQ1RMCQkoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDY0NTEwKQo+ICsjZGVmaW5lIF9E
UEZfQVVYX0NIX0RBVEExCShESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjQ1MTQpCj4gKyNk
ZWZpbmUgX0RQRl9BVVhfQ0hfREFUQTIJKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg2NDUx
OCkKPiArI2RlZmluZSBfRFBGX0FVWF9DSF9EQVRBMwkoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkg
KyAweDY0NTFjKQo+ICsjZGVmaW5lIF9EUEZfQVVYX0NIX0RBVEE0CShESVNQTEFZX01NSU9fQkFT
RShpOTE1KSArIDB4NjQ1MjApCj4gKyNkZWZpbmUgX0RQRl9BVVhfQ0hfREFUQTUJKERJU1BMQVlf
TU1JT19CQVNFKGk5MTUpICsgMHg2NDUyNCkKPiAgIAo+ICAgI2RlZmluZSBEUF9BVVhfQ0hfQ1RM
KGF1eF9jaCkJX01NSU9fUE9SVChhdXhfY2gsIF9EUEFfQVVYX0NIX0NUTCwgX0RQQl9BVVhfQ0hf
Q1RMKQo+ICAgI2RlZmluZSBEUF9BVVhfQ0hfREFUQShhdXhfY2gsIGkpCV9NTUlPKF9QT1JUKGF1
eF9jaCwgX0RQQV9BVVhfQ0hfREFUQTEsIF9EUEJfQVVYX0NIX0RBVEExKSArIChpKSAqIDQpIC8q
IDUgcmVnaXN0ZXJzICovCj4gQEAgLTU4NDMsNyArNTg0Myw3IEBAIGVudW0gewo+ICAgI2RlZmlu
ZSAgIERQSU5WR1RUX1NUQVRVU19NQVNLCQkJMHhmZgo+ICAgI2RlZmluZSAgIERQSU5WR1RUX1NU
QVRVU19NQVNLX0NIVgkJMHhmZmYKPiAgIAo+IC0jZGVmaW5lIERTUEFSQgkJCV9NTUlPKERJU1BM
QVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NzAwMzApCj4gKyNkZWZpbmUgRFNQQVJCCQkJX01N
SU8oRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDcwMDMwKQo+ICAgI2RlZmluZSAgIERTUEFS
Ql9DU1RBUlRfTUFTSwkoMHg3ZiA8PCA3KQo+ICAgI2RlZmluZSAgIERTUEFSQl9DU1RBUlRfU0hJ
RlQJNwo+ICAgI2RlZmluZSAgIERTUEFSQl9CU1RBUlRfTUFTSwkoMHg3ZikKPiBAQCAtNTg3OCw3
ICs1ODc4LDcgQEAgZW51bSB7Cj4gICAjZGVmaW5lICAgRFNQQVJCX1NQUklURUZfTUFTS19WTFYJ
KDB4ZmYgPDwgOCkKPiAgIAo+ICAgLyogcG52L2dlbjQvZzR4L3Zsdi9jaHYgKi8KPiAtI2RlZmlu
ZSBEU1BGVzEJCV9NTUlPKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NzAwMzQpCj4g
KyNkZWZpbmUgRFNQRlcxCQlfTU1JTyhESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NzAwMzQp
Cj4gICAjZGVmaW5lICAgRFNQRldfU1JfU0hJRlQJCTIzCj4gICAjZGVmaW5lICAgRFNQRldfU1Jf
TUFTSwkJCSgweDFmZiA8PCAyMykKPiAgICNkZWZpbmUgICBEU1BGV19DVVJTT1JCX1NISUZUCQkx
Ngo+IEBAIC01ODg5LDcgKzU4ODksNyBAQCBlbnVtIHsKPiAgICNkZWZpbmUgICBEU1BGV19QTEFO
RUFfU0hJRlQJCTAKPiAgICNkZWZpbmUgICBEU1BGV19QTEFORUFfTUFTSwkJKDB4N2YgPDwgMCkK
PiAgICNkZWZpbmUgICBEU1BGV19QTEFORUFfTUFTS19WTFYJCSgweGZmIDw8IDApIC8qIHZsdi9j
aHYgKi8KPiAtI2RlZmluZSBEU1BGVzIJCV9NTUlPKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2
KSArIDB4NzAwMzgpCj4gKyNkZWZpbmUgRFNQRlcyCQlfTU1JTyhESVNQTEFZX01NSU9fQkFTRShp
OTE1KSArIDB4NzAwMzgpCj4gICAjZGVmaW5lICAgRFNQRldfRkJDX1NSX0VOCQkoMSA8PCAzMSkJ
ICAvKiBnNHggKi8KPiAgICNkZWZpbmUgICBEU1BGV19GQkNfU1JfU0hJRlQJCTI4Cj4gICAjZGVm
aW5lICAgRFNQRldfRkJDX1NSX01BU0sJCSgweDcgPDwgMjgpIC8qIGc0eCAqLwo+IEBAIC01OTA1
LDcgKzU5MDUsNyBAQCBlbnVtIHsKPiAgICNkZWZpbmUgICBEU1BGV19TUFJJVEVBX1NISUZUCQkw
Cj4gICAjZGVmaW5lICAgRFNQRldfU1BSSVRFQV9NQVNLCQkoMHg3ZiA8PCAwKSAvKiBnNHggKi8K
PiAgICNkZWZpbmUgICBEU1BGV19TUFJJVEVBX01BU0tfVkxWCSgweGZmIDw8IDApIC8qIHZsdi9j
aHYgKi8KPiAtI2RlZmluZSBEU1BGVzMJCV9NTUlPKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2
KSArIDB4NzAwM2MpCj4gKyNkZWZpbmUgRFNQRlczCQlfTU1JTyhESVNQTEFZX01NSU9fQkFTRShp
OTE1KSArIDB4NzAwM2MpCj4gICAjZGVmaW5lICAgRFNQRldfSFBMTF9TUl9FTgkJKDEgPDwgMzEp
Cj4gICAjZGVmaW5lICAgUElORVZJRVdfU0VMRl9SRUZSRVNIX0VOCSgxIDw8IDMwKQo+ICAgI2Rl
ZmluZSAgIERTUEZXX0NVUlNPUl9TUl9TSElGVAkJMjQKPiBAQCAtNjMyMiwzNSArNjMyMiwzNSBA
QCBlbnVtIHsKPiAgICAqIFsxMDoxZl0gYWxsCj4gICAgKiBbMzA6MzJdIGFsbAo+ICAgICovCj4g
LSNkZWZpbmUgU1dGMChpKQlfTU1JTyhESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDcw
NDEwICsgKGkpICogNCkKPiAtI2RlZmluZSBTV0YxKGkpCV9NTUlPKERJU1BMQVlfTU1JT19CQVNF
KGRldl9wcml2KSArIDB4NzE0MTAgKyAoaSkgKiA0KQo+IC0jZGVmaW5lIFNXRjMoaSkJX01NSU8o
RElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg3MjQxNCArIChpKSAqIDQpCj4gKyNkZWZp
bmUgU1dGMChpKQlfTU1JTyhESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NzA0MTAgKyAoaSkg
KiA0KQo+ICsjZGVmaW5lIFNXRjEoaSkJX01NSU8oRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAw
eDcxNDEwICsgKGkpICogNCkKPiArI2RlZmluZSBTV0YzKGkpCV9NTUlPKERJU1BMQVlfTU1JT19C
QVNFKGk5MTUpICsgMHg3MjQxNCArIChpKSAqIDQpCj4gICAjZGVmaW5lIFNXRl9JTEsoaSkJX01N
SU8oMHg0RjAwMCArIChpKSAqIDQpCj4gICAKPiAgIC8qIFBpcGUgQiAqLwo+IC0jZGVmaW5lIF9Q
SVBFQkRTTAkJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NzEwMDApCj4gLSNkZWZp
bmUgX1BJUEVCQ09ORgkJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NzEwMDgpCj4g
LSNkZWZpbmUgX1BJUEVCU1RBVAkJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NzEw
MjQpCj4gKyNkZWZpbmUgX1BJUEVCRFNMCQkoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDcx
MDAwKQo+ICsjZGVmaW5lIF9QSVBFQkNPTkYJCShESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4
NzEwMDgpCj4gKyNkZWZpbmUgX1BJUEVCU1RBVAkJKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsg
MHg3MTAyNCkKPiAgICNkZWZpbmUgX1BJUEVCRlJBTUVISUdICQkweDcxMDQwCj4gICAjZGVmaW5l
IF9QSVBFQkZSQU1FUElYRUwJMHg3MTA0NAo+IC0jZGVmaW5lIF9QSVBFQl9GUk1DT1VOVF9HNFgJ
KERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NzEwNDApCj4gLSNkZWZpbmUgX1BJUEVC
X0ZMSVBDT1VOVF9HNFgJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NzEwNDQpCj4g
KyNkZWZpbmUgX1BJUEVCX0ZSTUNPVU5UX0c0WAkoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAw
eDcxMDQwKQo+ICsjZGVmaW5lIF9QSVBFQl9GTElQQ09VTlRfRzRYCShESVNQTEFZX01NSU9fQkFT
RShpOTE1KSArIDB4NzEwNDQpCj4gICAKPiAgIAo+ICAgLyogRGlzcGxheSBCIGNvbnRyb2wgKi8K
PiAtI2RlZmluZSBfRFNQQkNOVFIJCShESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDcx
MTgwKQo+ICsjZGVmaW5lIF9EU1BCQ05UUgkJKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg3
MTE4MCkKPiAgICNkZWZpbmUgICBESVNQUExBTkVfQUxQSEFfVFJBTlNfRU5BQkxFCQkoMSA8PCAx
NSkKPiAgICNkZWZpbmUgICBESVNQUExBTkVfQUxQSEFfVFJBTlNfRElTQUJMRQkJMAo+ICAgI2Rl
ZmluZSAgIERJU1BQTEFORV9TUFJJVEVfQUJPVkVfRElTUExBWQkwCj4gICAjZGVmaW5lICAgRElT
UFBMQU5FX1NQUklURV9BQk9WRV9PVkVSTEFZCSgxKQo+IC0jZGVmaW5lIF9EU1BCQUREUgkJKERJ
U1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NzExODQpCj4gLSNkZWZpbmUgX0RTUEJTVFJJ
REUJCShESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDcxMTg4KQo+IC0jZGVmaW5lIF9E
U1BCUE9TCQkoRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg3MTE4QykKPiAtI2RlZmlu
ZSBfRFNQQlNJWkUJCShESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDcxMTkwKQo+IC0j
ZGVmaW5lIF9EU1BCU1VSRgkJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NzExOUMp
Cj4gLSNkZWZpbmUgX0RTUEJUSUxFT0ZGCQkoRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsg
MHg3MTFBNCkKPiAtI2RlZmluZSBfRFNQQk9GRlNFVAkJKERJU1BMQVlfTU1JT19CQVNFKGRldl9w
cml2KSArIDB4NzExQTQpCj4gLSNkZWZpbmUgX0RTUEJTVVJGTElWRQkJKERJU1BMQVlfTU1JT19C
QVNFKGRldl9wcml2KSArIDB4NzExQUMpCj4gKyNkZWZpbmUgX0RTUEJBRERSCQkoRElTUExBWV9N
TUlPX0JBU0UoaTkxNSkgKyAweDcxMTg0KQo+ICsjZGVmaW5lIF9EU1BCU1RSSURFCQkoRElTUExB
WV9NTUlPX0JBU0UoaTkxNSkgKyAweDcxMTg4KQo+ICsjZGVmaW5lIF9EU1BCUE9TCQkoRElTUExB
WV9NTUlPX0JBU0UoaTkxNSkgKyAweDcxMThDKQo+ICsjZGVmaW5lIF9EU1BCU0laRQkJKERJU1BM
QVlfTU1JT19CQVNFKGk5MTUpICsgMHg3MTE5MCkKPiArI2RlZmluZSBfRFNQQlNVUkYJCShESVNQ
TEFZX01NSU9fQkFTRShpOTE1KSArIDB4NzExOUMpCj4gKyNkZWZpbmUgX0RTUEJUSUxFT0ZGCQko
RElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDcxMUE0KQo+ICsjZGVmaW5lIF9EU1BCT0ZGU0VU
CQkoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDcxMUE0KQo+ICsjZGVmaW5lIF9EU1BCU1VS
RkxJVkUJCShESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NzExQUMpCj4gICAKPiAgIC8qIElD
TCBEU0kgMCBhbmQgMSAqLwo+ICAgI2RlZmluZSBfUElQRURTSTBDT05GCQkweDdiMDA4Cj4gQEAg
LTg5NDYsNyArODk0Niw3IEBAIGVudW0gewo+ICAgI2RlZmluZSAgIEdFTjlfRU5BQkxFX0dQR1BV
X1BSRUVNUFRJT04JKDEgPDwgMikKPiAgIAo+ICAgLyogQXVkaW8gKi8KPiAtI2RlZmluZSBHNFhf
QVVEX1ZJRF9ESUQJCQlfTU1JTyhESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDYyMDIw
KQo+ICsjZGVmaW5lIEc0WF9BVURfVklEX0RJRAkJCV9NTUlPKERJU1BMQVlfTU1JT19CQVNFKGk5
MTUpICsgMHg2MjAyMCkKPiAgICNkZWZpbmUgICBJTlRFTF9BVURJT19ERVZDTAkJMHg4MDg2MjlG
Qgo+ICAgI2RlZmluZSAgIElOVEVMX0FVRElPX0RFVkJMQwkJMHg4MDg2MjgwMQo+ICAgI2RlZmlu
ZSAgIElOVEVMX0FVRElPX0RFVkNURwkJMHg4MDg2MjgwMgo+IEBAIC0xMDQ2OSw4ICsxMDQ2OSw4
IEBAIGVudW0gc2tsX3Bvd2VyX2dhdGUgewo+ICAgCj4gICAvKiBNSVBJIERTSSBDb250cm9sbGVy
IGFuZCBELVBIWSByZWdpc3RlcnMgKi8KPiAgIAo+IC0jZGVmaW5lIF9NSVBJQV9ERVZJQ0VfUkVB
RFkJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwMDApCj4gLSNkZWZpbmUgX01JUElD
X0RFVklDRV9SRUFEWQkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjgwMCkKPiArI2Rl
ZmluZSBfTUlQSUFfREVWSUNFX1JFQURZCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwMDAp
Cj4gKyNkZWZpbmUgX01JUElDX0RFVklDRV9SRUFEWQkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsg
MHhiODAwKQo+ICAgI2RlZmluZSBNSVBJX0RFVklDRV9SRUFEWShwb3J0KQkJX01NSU9fTUlQSShw
b3J0LCBfTUlQSUFfREVWSUNFX1JFQURZLCBfTUlQSUNfREVWSUNFX1JFQURZKQo+ICAgI2RlZmlu
ZSAgQlVTX1BPU1NFU1NJT04JCQkJCSgxIDw8IDMpIC8qIHNldCB0byBnaXZlIGJ1cyB0byByZWNl
aXZlciAqLwo+ICAgI2RlZmluZSAgVUxQU19TVEFURV9NQVNLCQkJCSgzIDw8IDEpCj4gQEAgLTEw
NDc5LDExICsxMDQ3OSwxMSBAQCBlbnVtIHNrbF9wb3dlcl9nYXRlIHsKPiAgICNkZWZpbmUgIFVM
UFNfU1RBVEVfTk9STUFMX09QRVJBVElPTgkJCSgwIDw8IDEpCj4gICAjZGVmaW5lICBERVZJQ0Vf
UkVBRFkJCQkJCSgxIDw8IDApCj4gICAKPiAtI2RlZmluZSBfTUlQSUFfSU5UUl9TVEFUCQkoZGV2
X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiMDA0KQo+IC0jZGVmaW5lIF9NSVBJQ19JTlRSX1NU
QVQJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4MDQpCj4gKyNkZWZpbmUgX01JUElB
X0lOVFJfU1RBVAkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiMDA0KQo+ICsjZGVmaW5lIF9N
SVBJQ19JTlRSX1NUQVQJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4YjgwNCkKPiAgICNkZWZp
bmUgTUlQSV9JTlRSX1NUQVQocG9ydCkJCV9NTUlPX01JUEkocG9ydCwgX01JUElBX0lOVFJfU1RB
VCwgX01JUElDX0lOVFJfU1RBVCkKPiAtI2RlZmluZSBfTUlQSUFfSU5UUl9FTgkJCShkZXZfcHJp
di0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwMDgpCj4gLSNkZWZpbmUgX01JUElDX0lOVFJfRU4JCQko
ZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiODA4KQo+ICsjZGVmaW5lIF9NSVBJQV9JTlRS
X0VOCQkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiMDA4KQo+ICsjZGVmaW5lIF9NSVBJQ19J
TlRSX0VOCQkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiODA4KQo+ICAgI2RlZmluZSBNSVBJ
X0lOVFJfRU4ocG9ydCkJCV9NTUlPX01JUEkocG9ydCwgX01JUElBX0lOVFJfRU4sIF9NSVBJQ19J
TlRSX0VOKQo+ICAgI2RlZmluZSAgVEVBUklOR19FRkZFQ1QJCQkJCSgxIDw8IDMxKQo+ICAgI2Rl
ZmluZSAgU1BMX1BLVF9TRU5UX0lOVEVSUlVQVAkJCQkoMSA8PCAzMCkKPiBAQCAtMTA1MTgsOCAr
MTA1MTgsOCBAQCBlbnVtIHNrbF9wb3dlcl9nYXRlIHsKPiAgICNkZWZpbmUgIFJYU09UX1NZTkNf
RVJST1IJCQkJKDEgPDwgMSkKPiAgICNkZWZpbmUgIFJYU09UX0VSUk9SCQkJCQkoMSA8PCAwKQo+
ICAgCj4gLSNkZWZpbmUgX01JUElBX0RTSV9GVU5DX1BSRwkJKGRldl9wcml2LT5taXBpX21taW9f
YmFzZSArIDB4YjAwYykKPiAtI2RlZmluZSBfTUlQSUNfRFNJX0ZVTkNfUFJHCQkoZGV2X3ByaXYt
Pm1pcGlfbW1pb19iYXNlICsgMHhiODBjKQo+ICsjZGVmaW5lIF9NSVBJQV9EU0lfRlVOQ19QUkcJ
CShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4YjAwYykKPiArI2RlZmluZSBfTUlQSUNfRFNJX0ZV
TkNfUFJHCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4MGMpCj4gICAjZGVmaW5lIE1JUElf
RFNJX0ZVTkNfUFJHKHBvcnQpCQlfTU1JT19NSVBJKHBvcnQsIF9NSVBJQV9EU0lfRlVOQ19QUkcs
IF9NSVBJQ19EU0lfRlVOQ19QUkcpCj4gICAjZGVmaW5lICBDTURfTU9ERV9EQVRBX1dJRFRIX01B
U0sJCQkoNyA8PCAxMykKPiAgICNkZWZpbmUgIENNRF9NT0RFX05PVF9TVVBQT1JURUQJCQkJKDAg
PDwgMTMpCj4gQEAgLTEwNTQxLDc4ICsxMDU0MSw3OCBAQCBlbnVtIHNrbF9wb3dlcl9nYXRlIHsK
PiAgICNkZWZpbmUgIERBVEFfTEFORVNfUFJHX1JFR19TSElGVAkJCTAKPiAgICNkZWZpbmUgIERB
VEFfTEFORVNfUFJHX1JFR19NQVNLCQkJKDcgPDwgMCkKPiAgIAo+IC0jZGVmaW5lIF9NSVBJQV9I
U19UWF9USU1FT1VUCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiMDEwKQo+IC0jZGVm
aW5lIF9NSVBJQ19IU19UWF9USU1FT1VUCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhi
ODEwKQo+ICsjZGVmaW5lIF9NSVBJQV9IU19UWF9USU1FT1VUCQkoaTkxNS0+bWlwaV9tbWlvX2Jh
c2UgKyAweGIwMTApCj4gKyNkZWZpbmUgX01JUElDX0hTX1RYX1RJTUVPVVQJCShpOTE1LT5taXBp
X21taW9fYmFzZSArIDB4YjgxMCkKPiAgICNkZWZpbmUgTUlQSV9IU19UWF9USU1FT1VUKHBvcnQp
CV9NTUlPX01JUEkocG9ydCwgX01JUElBX0hTX1RYX1RJTUVPVVQsIF9NSVBJQ19IU19UWF9USU1F
T1VUKQo+ICAgI2RlZmluZSAgSElHSF9TUEVFRF9UWF9USU1FT1VUX0NPVU5URVJfTUFTSwkJMHhm
ZmZmZmYKPiAgIAo+IC0jZGVmaW5lIF9NSVBJQV9MUF9SWF9USU1FT1VUCQkoZGV2X3ByaXYtPm1p
cGlfbW1pb19iYXNlICsgMHhiMDE0KQo+IC0jZGVmaW5lIF9NSVBJQ19MUF9SWF9USU1FT1VUCQko
ZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiODE0KQo+ICsjZGVmaW5lIF9NSVBJQV9MUF9S
WF9USU1FT1VUCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwMTQpCj4gKyNkZWZpbmUgX01J
UElDX0xQX1JYX1RJTUVPVVQJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4YjgxNCkKPiAgICNk
ZWZpbmUgTUlQSV9MUF9SWF9USU1FT1VUKHBvcnQpCV9NTUlPX01JUEkocG9ydCwgX01JUElBX0xQ
X1JYX1RJTUVPVVQsIF9NSVBJQ19MUF9SWF9USU1FT1VUKQo+ICAgI2RlZmluZSAgTE9XX1BPV0VS
X1JYX1RJTUVPVVRfQ09VTlRFUl9NQVNLCQkweGZmZmZmZgo+ICAgCj4gLSNkZWZpbmUgX01JUElB
X1RVUk5fQVJPVU5EX1RJTUVPVVQJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjAxOCkK
PiAtI2RlZmluZSBfTUlQSUNfVFVSTl9BUk9VTkRfVElNRU9VVAkoZGV2X3ByaXYtPm1pcGlfbW1p
b19iYXNlICsgMHhiODE4KQo+ICsjZGVmaW5lIF9NSVBJQV9UVVJOX0FST1VORF9USU1FT1VUCShp
OTE1LT5taXBpX21taW9fYmFzZSArIDB4YjAxOCkKPiArI2RlZmluZSBfTUlQSUNfVFVSTl9BUk9V
TkRfVElNRU9VVAkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4MTgpCj4gICAjZGVmaW5lIE1J
UElfVFVSTl9BUk9VTkRfVElNRU9VVChwb3J0KQlfTU1JT19NSVBJKHBvcnQsIF9NSVBJQV9UVVJO
X0FST1VORF9USU1FT1VULCBfTUlQSUNfVFVSTl9BUk9VTkRfVElNRU9VVCkKPiAgICNkZWZpbmUg
IFRVUk5fQVJPVU5EX1RJTUVPVVRfTUFTSwkJCTB4M2YKPiAgIAo+IC0jZGVmaW5lIF9NSVBJQV9E
RVZJQ0VfUkVTRVRfVElNRVIJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjAxYykKPiAt
I2RlZmluZSBfTUlQSUNfREVWSUNFX1JFU0VUX1RJTUVSCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jh
c2UgKyAweGI4MWMpCj4gKyNkZWZpbmUgX01JUElBX0RFVklDRV9SRVNFVF9USU1FUgkoaTkxNS0+
bWlwaV9tbWlvX2Jhc2UgKyAweGIwMWMpCj4gKyNkZWZpbmUgX01JUElDX0RFVklDRV9SRVNFVF9U
SU1FUgkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4MWMpCj4gICAjZGVmaW5lIE1JUElfREVW
SUNFX1JFU0VUX1RJTUVSKHBvcnQpCV9NTUlPX01JUEkocG9ydCwgX01JUElBX0RFVklDRV9SRVNF
VF9USU1FUiwgX01JUElDX0RFVklDRV9SRVNFVF9USU1FUikKPiAgICNkZWZpbmUgIERFVklDRV9S
RVNFVF9USU1FUl9NQVNLCQkJMHhmZmZmCj4gICAKPiAtI2RlZmluZSBfTUlQSUFfRFBJX1JFU09M
VVRJT04JCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwMjApCj4gLSNkZWZpbmUgX01J
UElDX0RQSV9SRVNPTFVUSU9OCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiODIwKQo+
ICsjZGVmaW5lIF9NSVBJQV9EUElfUkVTT0xVVElPTgkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsg
MHhiMDIwKQo+ICsjZGVmaW5lIF9NSVBJQ19EUElfUkVTT0xVVElPTgkJKGk5MTUtPm1pcGlfbW1p
b19iYXNlICsgMHhiODIwKQo+ICAgI2RlZmluZSBNSVBJX0RQSV9SRVNPTFVUSU9OKHBvcnQpCV9N
TUlPX01JUEkocG9ydCwgX01JUElBX0RQSV9SRVNPTFVUSU9OLCBfTUlQSUNfRFBJX1JFU09MVVRJ
T04pCj4gICAjZGVmaW5lICBWRVJUSUNBTF9BRERSRVNTX1NISUZUCQkJCTE2Cj4gICAjZGVmaW5l
ICBWRVJUSUNBTF9BRERSRVNTX01BU0sJCQkJKDB4ZmZmZiA8PCAxNikKPiAgICNkZWZpbmUgIEhP
UklaT05UQUxfQUREUkVTU19TSElGVAkJCTAKPiAgICNkZWZpbmUgIEhPUklaT05UQUxfQUREUkVT
U19NQVNLCQkJMHhmZmZmCj4gICAKPiAtI2RlZmluZSBfTUlQSUFfREJJX0ZJRk9fVEhST1RUTEUJ
KGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjAyNCkKPiAtI2RlZmluZSBfTUlQSUNfREJJ
X0ZJRk9fVEhST1RUTEUJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjgyNCkKPiArI2Rl
ZmluZSBfTUlQSUFfREJJX0ZJRk9fVEhST1RUTEUJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhi
MDI0KQo+ICsjZGVmaW5lIF9NSVBJQ19EQklfRklGT19USFJPVFRMRQkoaTkxNS0+bWlwaV9tbWlv
X2Jhc2UgKyAweGI4MjQpCj4gICAjZGVmaW5lIE1JUElfREJJX0ZJRk9fVEhST1RUTEUocG9ydCkJ
X01NSU9fTUlQSShwb3J0LCBfTUlQSUFfREJJX0ZJRk9fVEhST1RUTEUsIF9NSVBJQ19EQklfRklG
T19USFJPVFRMRSkKPiAgICNkZWZpbmUgIERCSV9GSUZPX0VNUFRZX0hBTEYJCQkJKDAgPDwgMCkK
PiAgICNkZWZpbmUgIERCSV9GSUZPX0VNUFRZX1FVQVJURVIJCQkJKDEgPDwgMCkKPiAgICNkZWZp
bmUgIERCSV9GSUZPX0VNUFRZXzdfTE9DQVRJT05TCQkJKDIgPDwgMCkKPiAgIAo+ICAgLyogcmVn
cyBiZWxvdyBhcmUgYml0cyAxNTowICovCj4gLSNkZWZpbmUgX01JUElBX0hTWU5DX1BBRERJTkdf
Q09VTlQJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjAyOCkKPiAtI2RlZmluZSBfTUlQ
SUNfSFNZTkNfUEFERElOR19DT1VOVAkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiODI4
KQo+ICsjZGVmaW5lIF9NSVBJQV9IU1lOQ19QQURESU5HX0NPVU5UCShpOTE1LT5taXBpX21taW9f
YmFzZSArIDB4YjAyOCkKPiArI2RlZmluZSBfTUlQSUNfSFNZTkNfUEFERElOR19DT1VOVAkoaTkx
NS0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4MjgpCj4gICAjZGVmaW5lIE1JUElfSFNZTkNfUEFERElO
R19DT1VOVChwb3J0KQlfTU1JT19NSVBJKHBvcnQsIF9NSVBJQV9IU1lOQ19QQURESU5HX0NPVU5U
LCBfTUlQSUNfSFNZTkNfUEFERElOR19DT1VOVCkKPiAgIAo+IC0jZGVmaW5lIF9NSVBJQV9IQlBf
Q09VTlQJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwMmMpCj4gLSNkZWZpbmUgX01J
UElDX0hCUF9DT1VOVAkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjgyYykKPiArI2Rl
ZmluZSBfTUlQSUFfSEJQX0NPVU5UCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwMmMpCj4g
KyNkZWZpbmUgX01JUElDX0hCUF9DT1VOVAkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiODJj
KQo+ICAgI2RlZmluZSBNSVBJX0hCUF9DT1VOVChwb3J0KQkJX01NSU9fTUlQSShwb3J0LCBfTUlQ
SUFfSEJQX0NPVU5ULCBfTUlQSUNfSEJQX0NPVU5UKQo+ICAgCj4gLSNkZWZpbmUgX01JUElBX0hG
UF9DT1VOVAkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjAzMCkKPiAtI2RlZmluZSBf
TUlQSUNfSEZQX0NPVU5UCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiODMwKQo+ICsj
ZGVmaW5lIF9NSVBJQV9IRlBfQ09VTlQJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4YjAzMCkK
PiArI2RlZmluZSBfTUlQSUNfSEZQX0NPVU5UCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4
MzApCj4gICAjZGVmaW5lIE1JUElfSEZQX0NPVU5UKHBvcnQpCQlfTU1JT19NSVBJKHBvcnQsIF9N
SVBJQV9IRlBfQ09VTlQsIF9NSVBJQ19IRlBfQ09VTlQpCj4gICAKPiAtI2RlZmluZSBfTUlQSUFf
SEFDVElWRV9BUkVBX0NPVU5UCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwMzQpCj4g
LSNkZWZpbmUgX01JUElDX0hBQ1RJVkVfQVJFQV9DT1VOVAkoZGV2X3ByaXYtPm1pcGlfbW1pb19i
YXNlICsgMHhiODM0KQo+ICsjZGVmaW5lIF9NSVBJQV9IQUNUSVZFX0FSRUFfQ09VTlQJKGk5MTUt
Pm1pcGlfbW1pb19iYXNlICsgMHhiMDM0KQo+ICsjZGVmaW5lIF9NSVBJQ19IQUNUSVZFX0FSRUFf
Q09VTlQJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiODM0KQo+ICAgI2RlZmluZSBNSVBJX0hB
Q1RJVkVfQVJFQV9DT1VOVChwb3J0KQlfTU1JT19NSVBJKHBvcnQsIF9NSVBJQV9IQUNUSVZFX0FS
RUFfQ09VTlQsIF9NSVBJQ19IQUNUSVZFX0FSRUFfQ09VTlQpCj4gICAKPiAtI2RlZmluZSBfTUlQ
SUFfVlNZTkNfUEFERElOR19DT1VOVAkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiMDM4
KQo+IC0jZGVmaW5lIF9NSVBJQ19WU1lOQ19QQURESU5HX0NPVU5UCShkZXZfcHJpdi0+bWlwaV9t
bWlvX2Jhc2UgKyAweGI4MzgpCj4gKyNkZWZpbmUgX01JUElBX1ZTWU5DX1BBRERJTkdfQ09VTlQJ
KGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiMDM4KQo+ICsjZGVmaW5lIF9NSVBJQ19WU1lOQ19Q
QURESU5HX0NPVU5UCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4YjgzOCkKPiAgICNkZWZpbmUg
TUlQSV9WU1lOQ19QQURESU5HX0NPVU5UKHBvcnQpCV9NTUlPX01JUEkocG9ydCwgX01JUElBX1ZT
WU5DX1BBRERJTkdfQ09VTlQsIF9NSVBJQ19WU1lOQ19QQURESU5HX0NPVU5UKQo+ICAgCj4gLSNk
ZWZpbmUgX01JUElBX1ZCUF9DT1VOVAkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjAz
YykKPiAtI2RlZmluZSBfTUlQSUNfVkJQX0NPVU5UCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNl
ICsgMHhiODNjKQo+ICsjZGVmaW5lIF9NSVBJQV9WQlBfQ09VTlQJCShpOTE1LT5taXBpX21taW9f
YmFzZSArIDB4YjAzYykKPiArI2RlZmluZSBfTUlQSUNfVkJQX0NPVU5UCQkoaTkxNS0+bWlwaV9t
bWlvX2Jhc2UgKyAweGI4M2MpCj4gICAjZGVmaW5lIE1JUElfVkJQX0NPVU5UKHBvcnQpCQlfTU1J
T19NSVBJKHBvcnQsIF9NSVBJQV9WQlBfQ09VTlQsIF9NSVBJQ19WQlBfQ09VTlQpCj4gICAKPiAt
I2RlZmluZSBfTUlQSUFfVkZQX0NPVU5UCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhi
MDQwKQo+IC0jZGVmaW5lIF9NSVBJQ19WRlBfQ09VTlQJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jh
c2UgKyAweGI4NDApCj4gKyNkZWZpbmUgX01JUElBX1ZGUF9DT1VOVAkJKGk5MTUtPm1pcGlfbW1p
b19iYXNlICsgMHhiMDQwKQo+ICsjZGVmaW5lIF9NSVBJQ19WRlBfQ09VTlQJCShpOTE1LT5taXBp
X21taW9fYmFzZSArIDB4Yjg0MCkKPiAgICNkZWZpbmUgTUlQSV9WRlBfQ09VTlQocG9ydCkJCV9N
TUlPX01JUEkocG9ydCwgX01JUElBX1ZGUF9DT1VOVCwgX01JUElDX1ZGUF9DT1VOVCkKPiAgIAo+
IC0jZGVmaW5lIF9NSVBJQV9ISUdIX0xPV19TV0lUQ0hfQ09VTlQJKGRldl9wcml2LT5taXBpX21t
aW9fYmFzZSArIDB4YjA0NCkKPiAtI2RlZmluZSBfTUlQSUNfSElHSF9MT1dfU1dJVENIX0NPVU5U
CShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4NDQpCj4gKyNkZWZpbmUgX01JUElBX0hJ
R0hfTE9XX1NXSVRDSF9DT1VOVAkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwNDQpCj4gKyNk
ZWZpbmUgX01JUElDX0hJR0hfTE9XX1NXSVRDSF9DT1VOVAkoaTkxNS0+bWlwaV9tbWlvX2Jhc2Ug
KyAweGI4NDQpCj4gICAjZGVmaW5lIE1JUElfSElHSF9MT1dfU1dJVENIX0NPVU5UKHBvcnQpCV9N
TUlPX01JUEkocG9ydCwJX01JUElBX0hJR0hfTE9XX1NXSVRDSF9DT1VOVCwgX01JUElDX0hJR0hf
TE9XX1NXSVRDSF9DT1VOVCkKPiAgIAo+ICAgLyogcmVncyBhYm92ZSBhcmUgYml0cyAxNTowICov
Cj4gICAKPiAtI2RlZmluZSBfTUlQSUFfRFBJX0NPTlRST0wJCShkZXZfcHJpdi0+bWlwaV9tbWlv
X2Jhc2UgKyAweGIwNDgpCj4gLSNkZWZpbmUgX01JUElDX0RQSV9DT05UUk9MCQkoZGV2X3ByaXYt
Pm1pcGlfbW1pb19iYXNlICsgMHhiODQ4KQo+ICsjZGVmaW5lIF9NSVBJQV9EUElfQ09OVFJPTAkJ
KGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiMDQ4KQo+ICsjZGVmaW5lIF9NSVBJQ19EUElfQ09O
VFJPTAkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiODQ4KQo+ICAgI2RlZmluZSBNSVBJX0RQ
SV9DT05UUk9MKHBvcnQpCQlfTU1JT19NSVBJKHBvcnQsIF9NSVBJQV9EUElfQ09OVFJPTCwgX01J
UElDX0RQSV9DT05UUk9MKQo+ICAgI2RlZmluZSAgRFBJX0xQX01PREUJCQkJCSgxIDw8IDYpCj4g
ICAjZGVmaW5lICBCQUNLTElHSFRfT0ZGCQkJCQkoMSA8PCA1KQo+IEBAIC0xMDYyMiwyNyArMTA2
MjIsMjcgQEAgZW51bSBza2xfcG93ZXJfZ2F0ZSB7Cj4gICAjZGVmaW5lICBUVVJOX09OCQkJCQko
MSA8PCAxKQo+ICAgI2RlZmluZSAgU0hVVERPV04JCQkJCSgxIDw8IDApCj4gICAKPiAtI2RlZmlu
ZSBfTUlQSUFfRFBJX0RBVEEJCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiMDRjKQo+
IC0jZGVmaW5lIF9NSVBJQ19EUElfREFUQQkJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAw
eGI4NGMpCj4gKyNkZWZpbmUgX01JUElBX0RQSV9EQVRBCQkJKGk5MTUtPm1pcGlfbW1pb19iYXNl
ICsgMHhiMDRjKQo+ICsjZGVmaW5lIF9NSVBJQ19EUElfREFUQQkJCShpOTE1LT5taXBpX21taW9f
YmFzZSArIDB4Yjg0YykKPiAgICNkZWZpbmUgTUlQSV9EUElfREFUQShwb3J0KQkJX01NSU9fTUlQ
SShwb3J0LCBfTUlQSUFfRFBJX0RBVEEsIF9NSVBJQ19EUElfREFUQSkKPiAgICNkZWZpbmUgIENP
TU1BTkRfQllURV9TSElGVAkJCQkwCj4gICAjZGVmaW5lICBDT01NQU5EX0JZVEVfTUFTSwkJCQko
MHgzZiA8PCAwKQo+ICAgCj4gLSNkZWZpbmUgX01JUElBX0lOSVRfQ09VTlQJCShkZXZfcHJpdi0+
bWlwaV9tbWlvX2Jhc2UgKyAweGIwNTApCj4gLSNkZWZpbmUgX01JUElDX0lOSVRfQ09VTlQJCShk
ZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4NTApCj4gKyNkZWZpbmUgX01JUElBX0lOSVRf
Q09VTlQJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4YjA1MCkKPiArI2RlZmluZSBfTUlQSUNf
SU5JVF9DT1VOVAkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiODUwKQo+ICAgI2RlZmluZSBN
SVBJX0lOSVRfQ09VTlQocG9ydCkJCV9NTUlPX01JUEkocG9ydCwgX01JUElBX0lOSVRfQ09VTlQs
IF9NSVBJQ19JTklUX0NPVU5UKQo+ICAgI2RlZmluZSAgTUFTVEVSX0lOSVRfVElNRVJfU0hJRlQJ
CQkwCj4gICAjZGVmaW5lICBNQVNURVJfSU5JVF9USU1FUl9NQVNLCQkJCSgweGZmZmYgPDwgMCkK
PiAgIAo+IC0jZGVmaW5lIF9NSVBJQV9NQVhfUkVUVVJOX1BLVF9TSVpFCShkZXZfcHJpdi0+bWlw
aV9tbWlvX2Jhc2UgKyAweGIwNTQpCj4gLSNkZWZpbmUgX01JUElDX01BWF9SRVRVUk5fUEtUX1NJ
WkUJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4Yjg1NCkKPiArI2RlZmluZSBfTUlQSUFf
TUFYX1JFVFVSTl9QS1RfU0laRQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwNTQpCj4gKyNk
ZWZpbmUgX01JUElDX01BWF9SRVRVUk5fUEtUX1NJWkUJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsg
MHhiODU0KQo+ICAgI2RlZmluZSBNSVBJX01BWF9SRVRVUk5fUEtUX1NJWkUocG9ydCkJX01NSU9f
TUlQSShwb3J0LCBcCj4gICAJCQlfTUlQSUFfTUFYX1JFVFVSTl9QS1RfU0laRSwgX01JUElDX01B
WF9SRVRVUk5fUEtUX1NJWkUpCj4gICAjZGVmaW5lICBNQVhfUkVUVVJOX1BLVF9TSVpFX1NISUZU
CQkJMAo+ICAgI2RlZmluZSAgTUFYX1JFVFVSTl9QS1RfU0laRV9NQVNLCQkJKDB4M2ZmIDw8IDAp
Cj4gICAKPiAtI2RlZmluZSBfTUlQSUFfVklERU9fTU9ERV9GT1JNQVQJKGRldl9wcml2LT5taXBp
X21taW9fYmFzZSArIDB4YjA1OCkKPiAtI2RlZmluZSBfTUlQSUNfVklERU9fTU9ERV9GT1JNQVQJ
KGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4Yjg1OCkKPiArI2RlZmluZSBfTUlQSUFfVklE
RU9fTU9ERV9GT1JNQVQJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiMDU4KQo+ICsjZGVmaW5l
IF9NSVBJQ19WSURFT19NT0RFX0ZPUk1BVAkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4NTgp
Cj4gICAjZGVmaW5lIE1JUElfVklERU9fTU9ERV9GT1JNQVQocG9ydCkJX01NSU9fTUlQSShwb3J0
LCBfTUlQSUFfVklERU9fTU9ERV9GT1JNQVQsIF9NSVBJQ19WSURFT19NT0RFX0ZPUk1BVCkKPiAg
ICNkZWZpbmUgIFJBTkRPTV9EUElfRElTUExBWV9SRVNPTFVUSU9OCQkJKDEgPDwgNCkKPiAgICNk
ZWZpbmUgIERJU0FCTEVfVklERU9fQlRBCQkJCSgxIDw8IDMpCj4gQEAgLTEwNjUxLDggKzEwNjUx
LDggQEAgZW51bSBza2xfcG93ZXJfZ2F0ZSB7Cj4gICAjZGVmaW5lICBWSURFT19NT0RFX05PTl9C
VVJTVF9XSVRIX1NZTkNfRVZFTlRTCQkoMiA8PCAwKQo+ICAgI2RlZmluZSAgVklERU9fTU9ERV9C
VVJTVAkJCQkoMyA8PCAwKQo+ICAgCj4gLSNkZWZpbmUgX01JUElBX0VPVF9ESVNBQkxFCQkoZGV2
X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiMDVjKQo+IC0jZGVmaW5lIF9NSVBJQ19FT1RfRElT
QUJMRQkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4Yjg1YykKPiArI2RlZmluZSBfTUlQ
SUFfRU9UX0RJU0FCTEUJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4YjA1YykKPiArI2RlZmlu
ZSBfTUlQSUNfRU9UX0RJU0FCTEUJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4Yjg1YykKPiAg
ICNkZWZpbmUgTUlQSV9FT1RfRElTQUJMRShwb3J0KQkJX01NSU9fTUlQSShwb3J0LCBfTUlQSUFf
RU9UX0RJU0FCTEUsIF9NSVBJQ19FT1RfRElTQUJMRSkKPiAgICNkZWZpbmUgIEJYVF9ERUZFQVRV
UkVfRFBJX0ZJRk9fQ1RSCQkJKDEgPDwgOSkKPiAgICNkZWZpbmUgIEJYVF9EUEhZX0RFRkVBVFVS
RV9FTgkJCQkoMSA8PCA4KQo+IEBAIC0xMDY2NSwzNSArMTA2NjUsMzUgQEAgZW51bSBza2xfcG93
ZXJfZ2F0ZSB7Cj4gICAjZGVmaW5lICBDTE9DS1NUT1AJCQkJCSgxIDw8IDEpCj4gICAjZGVmaW5l
ICBFT1RfRElTQUJMRQkJCQkJKDEgPDwgMCkKPiAgIAo+IC0jZGVmaW5lIF9NSVBJQV9MUF9CWVRF
Q0xLCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiMDYwKQo+IC0jZGVmaW5lIF9NSVBJ
Q19MUF9CWVRFQ0xLCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiODYwKQo+ICsjZGVm
aW5lIF9NSVBJQV9MUF9CWVRFQ0xLCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwNjApCj4g
KyNkZWZpbmUgX01JUElDX0xQX0JZVEVDTEsJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4Yjg2
MCkKPiAgICNkZWZpbmUgTUlQSV9MUF9CWVRFQ0xLKHBvcnQpCQlfTU1JT19NSVBJKHBvcnQsIF9N
SVBJQV9MUF9CWVRFQ0xLLCBfTUlQSUNfTFBfQllURUNMSykKPiAgICNkZWZpbmUgIExQX0JZVEVD
TEtfU0hJRlQJCQkJMAo+ICAgI2RlZmluZSAgTFBfQllURUNMS19NQVNLCQkJCSgweGZmZmYgPDwg
MCkKPiAgIAo+IC0jZGVmaW5lIF9NSVBJQV9UTFBYX1RJTUVfQ09VTlQJCShkZXZfcHJpdi0+bWlw
aV9tbWlvX2Jhc2UgKyAweGIwYTQpCj4gLSNkZWZpbmUgX01JUElDX1RMUFhfVElNRV9DT1VOVAkJ
KGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjhhNCkKPiArI2RlZmluZSBfTUlQSUFfVExQ
WF9USU1FX0NPVU5UCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwYTQpCj4gKyNkZWZpbmUg
X01JUElDX1RMUFhfVElNRV9DT1VOVAkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiOGE0KQo+
ICAgI2RlZmluZSBNSVBJX1RMUFhfVElNRV9DT1VOVChwb3J0KQkgX01NSU9fTUlQSShwb3J0LCBf
TUlQSUFfVExQWF9USU1FX0NPVU5ULCBfTUlQSUNfVExQWF9USU1FX0NPVU5UKQo+ICAgCj4gLSNk
ZWZpbmUgX01JUElBX0NMS19MQU5FX1RJTUlORwkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSAr
IDB4YjA5OCkKPiAtI2RlZmluZSBfTUlQSUNfQ0xLX0xBTkVfVElNSU5HCQkoZGV2X3ByaXYtPm1p
cGlfbW1pb19iYXNlICsgMHhiODk4KQo+ICsjZGVmaW5lIF9NSVBJQV9DTEtfTEFORV9USU1JTkcJ
CShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4YjA5OCkKPiArI2RlZmluZSBfTUlQSUNfQ0xLX0xB
TkVfVElNSU5HCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4OTgpCj4gICAjZGVmaW5lIE1J
UElfQ0xLX0xBTkVfVElNSU5HKHBvcnQpCSBfTU1JT19NSVBJKHBvcnQsIF9NSVBJQV9DTEtfTEFO
RV9USU1JTkcsIF9NSVBJQ19DTEtfTEFORV9USU1JTkcpCj4gICAKPiAgIC8qIGJpdHMgMzE6MCAq
Lwo+IC0jZGVmaW5lIF9NSVBJQV9MUF9HRU5fREFUQQkJKGRldl9wcml2LT5taXBpX21taW9fYmFz
ZSArIDB4YjA2NCkKPiAtI2RlZmluZSBfTUlQSUNfTFBfR0VOX0RBVEEJCShkZXZfcHJpdi0+bWlw
aV9tbWlvX2Jhc2UgKyAweGI4NjQpCj4gKyNkZWZpbmUgX01JUElBX0xQX0dFTl9EQVRBCQkoaTkx
NS0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwNjQpCj4gKyNkZWZpbmUgX01JUElDX0xQX0dFTl9EQVRB
CQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4NjQpCj4gICAjZGVmaW5lIE1JUElfTFBfR0VO
X0RBVEEocG9ydCkJCV9NTUlPX01JUEkocG9ydCwgX01JUElBX0xQX0dFTl9EQVRBLCBfTUlQSUNf
TFBfR0VOX0RBVEEpCj4gICAKPiAgIC8qIGJpdHMgMzE6MCAqLwo+IC0jZGVmaW5lIF9NSVBJQV9I
U19HRU5fREFUQQkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjA2OCkKPiAtI2RlZmlu
ZSBfTUlQSUNfSFNfR0VOX0RBVEEJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4Njgp
Cj4gKyNkZWZpbmUgX01JUElBX0hTX0dFTl9EQVRBCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAw
eGIwNjgpCj4gKyNkZWZpbmUgX01JUElDX0hTX0dFTl9EQVRBCQkoaTkxNS0+bWlwaV9tbWlvX2Jh
c2UgKyAweGI4NjgpCj4gICAjZGVmaW5lIE1JUElfSFNfR0VOX0RBVEEocG9ydCkJCV9NTUlPX01J
UEkocG9ydCwgX01JUElBX0hTX0dFTl9EQVRBLCBfTUlQSUNfSFNfR0VOX0RBVEEpCj4gICAKPiAt
I2RlZmluZSBfTUlQSUFfTFBfR0VOX0NUUkwJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAw
eGIwNmMpCj4gLSNkZWZpbmUgX01JUElDX0xQX0dFTl9DVFJMCQkoZGV2X3ByaXYtPm1pcGlfbW1p
b19iYXNlICsgMHhiODZjKQo+ICsjZGVmaW5lIF9NSVBJQV9MUF9HRU5fQ1RSTAkJKGk5MTUtPm1p
cGlfbW1pb19iYXNlICsgMHhiMDZjKQo+ICsjZGVmaW5lIF9NSVBJQ19MUF9HRU5fQ1RSTAkJKGk5
MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiODZjKQo+ICAgI2RlZmluZSBNSVBJX0xQX0dFTl9DVFJM
KHBvcnQpCQlfTU1JT19NSVBJKHBvcnQsIF9NSVBJQV9MUF9HRU5fQ1RSTCwgX01JUElDX0xQX0dF
Tl9DVFJMKQo+IC0jZGVmaW5lIF9NSVBJQV9IU19HRU5fQ1RSTAkJKGRldl9wcml2LT5taXBpX21t
aW9fYmFzZSArIDB4YjA3MCkKPiAtI2RlZmluZSBfTUlQSUNfSFNfR0VOX0NUUkwJCShkZXZfcHJp
di0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4NzApCj4gKyNkZWZpbmUgX01JUElBX0hTX0dFTl9DVFJM
CQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwNzApCj4gKyNkZWZpbmUgX01JUElDX0hTX0dF
Tl9DVFJMCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4NzApCj4gICAjZGVmaW5lIE1JUElf
SFNfR0VOX0NUUkwocG9ydCkJCV9NTUlPX01JUEkocG9ydCwgX01JUElBX0hTX0dFTl9DVFJMLCBf
TUlQSUNfSFNfR0VOX0NUUkwpCj4gICAjZGVmaW5lICBMT05HX1BBQ0tFVF9XT1JEX0NPVU5UX1NI
SUZUCQkJOAo+ICAgI2RlZmluZSAgTE9OR19QQUNLRVRfV09SRF9DT1VOVF9NQVNLCQkJKDB4ZmZm
ZiA8PCA4KQo+IEBAIC0xMDcwNSw4ICsxMDcwNSw4IEBAIGVudW0gc2tsX3Bvd2VyX2dhdGUgewo+
ICAgI2RlZmluZSAgREFUQV9UWVBFX01BU0sJCQkJCSgweDNmIDw8IDApCj4gICAvKiBkYXRhIHR5
cGUgdmFsdWVzLCBzZWUgaW5jbHVkZS92aWRlby9taXBpX2Rpc3BsYXkuaCAqLwo+ICAgCj4gLSNk
ZWZpbmUgX01JUElBX0dFTl9GSUZPX1NUQVQJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAw
eGIwNzQpCj4gLSNkZWZpbmUgX01JUElDX0dFTl9GSUZPX1NUQVQJCShkZXZfcHJpdi0+bWlwaV9t
bWlvX2Jhc2UgKyAweGI4NzQpCj4gKyNkZWZpbmUgX01JUElBX0dFTl9GSUZPX1NUQVQJCShpOTE1
LT5taXBpX21taW9fYmFzZSArIDB4YjA3NCkKPiArI2RlZmluZSBfTUlQSUNfR0VOX0ZJRk9fU1RB
VAkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiODc0KQo+ICAgI2RlZmluZSBNSVBJX0dFTl9G
SUZPX1NUQVQocG9ydCkJX01NSU9fTUlQSShwb3J0LCBfTUlQSUFfR0VOX0ZJRk9fU1RBVCwgX01J
UElDX0dFTl9GSUZPX1NUQVQpCj4gICAjZGVmaW5lICBEUElfRklGT19FTVBUWQkJCQkJKDEgPDwg
MjgpCj4gICAjZGVmaW5lICBEQklfRklGT19FTVBUWQkJCQkJKDEgPDwgMjcpCj4gQEAgLTEwNzIz
LDE1ICsxMDcyMywxNSBAQCBlbnVtIHNrbF9wb3dlcl9nYXRlIHsKPiAgICNkZWZpbmUgIEhTX0RB
VEFfRklGT19IQUxGX0VNUFRZCQkJKDEgPDwgMSkKPiAgICNkZWZpbmUgIEhTX0RBVEFfRklGT19G
VUxMCQkJCSgxIDw8IDApCj4gICAKPiAtI2RlZmluZSBfTUlQSUFfSFNfTFNfREJJX0VOQUJMRQkJ
KGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjA3OCkKPiAtI2RlZmluZSBfTUlQSUNfSFNf
TFNfREJJX0VOQUJMRQkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4Yjg3OCkKPiArI2Rl
ZmluZSBfTUlQSUFfSFNfTFNfREJJX0VOQUJMRQkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhi
MDc4KQo+ICsjZGVmaW5lIF9NSVBJQ19IU19MU19EQklfRU5BQkxFCQkoaTkxNS0+bWlwaV9tbWlv
X2Jhc2UgKyAweGI4NzgpCj4gICAjZGVmaW5lIE1JUElfSFNfTFBfREJJX0VOQUJMRShwb3J0KQlf
TU1JT19NSVBJKHBvcnQsIF9NSVBJQV9IU19MU19EQklfRU5BQkxFLCBfTUlQSUNfSFNfTFNfREJJ
X0VOQUJMRSkKPiAgICNkZWZpbmUgIERCSV9IU19MUF9NT0RFX01BU0sJCQkJKDEgPDwgMCkKPiAg
ICNkZWZpbmUgIERCSV9MUF9NT0RFCQkJCQkoMSA8PCAwKQo+ICAgI2RlZmluZSAgREJJX0hTX01P
REUJCQkJCSgwIDw8IDApCj4gICAKPiAtI2RlZmluZSBfTUlQSUFfRFBIWV9QQVJBTQkJKGRldl9w
cml2LT5taXBpX21taW9fYmFzZSArIDB4YjA4MCkKPiAtI2RlZmluZSBfTUlQSUNfRFBIWV9QQVJB
TQkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4Yjg4MCkKPiArI2RlZmluZSBfTUlQSUFf
RFBIWV9QQVJBTQkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiMDgwKQo+ICsjZGVmaW5lIF9N
SVBJQ19EUEhZX1BBUkFNCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4ODApCj4gICAjZGVm
aW5lIE1JUElfRFBIWV9QQVJBTShwb3J0KQkJX01NSU9fTUlQSShwb3J0LCBfTUlQSUFfRFBIWV9Q
QVJBTSwgX01JUElDX0RQSFlfUEFSQU0pCj4gICAjZGVmaW5lICBFWElUX1pFUk9fQ09VTlRfU0hJ
RlQJCQkJMjQKPiAgICNkZWZpbmUgIEVYSVRfWkVST19DT1VOVF9NQVNLCQkJCSgweDNmIDw8IDI0
KQo+IEBAIC0xMDk3OCwzNCArMTA5NzgsMzQgQEAgZW51bSBza2xfcG93ZXJfZ2F0ZSB7Cj4gICAj
ZGVmaW5lICBUQV9USU1FT1VUX1ZBTFVFKHgpCQkoKHgpIDw8IDApCj4gICAKPiAgIC8qIGJpdHMg
MzE6MCAqLwo+IC0jZGVmaW5lIF9NSVBJQV9EQklfQldfQ1RSTAkJKGRldl9wcml2LT5taXBpX21t
aW9fYmFzZSArIDB4YjA4NCkKPiAtI2RlZmluZSBfTUlQSUNfREJJX0JXX0NUUkwJCShkZXZfcHJp
di0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4ODQpCj4gKyNkZWZpbmUgX01JUElBX0RCSV9CV19DVFJM
CQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwODQpCj4gKyNkZWZpbmUgX01JUElDX0RCSV9C
V19DVFJMCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4ODQpCj4gICAjZGVmaW5lIE1JUElf
REJJX0JXX0NUUkwocG9ydCkJCV9NTUlPX01JUEkocG9ydCwgX01JUElBX0RCSV9CV19DVFJMLCBf
TUlQSUNfREJJX0JXX0NUUkwpCj4gICAKPiAtI2RlZmluZSBfTUlQSUFfQ0xLX0xBTkVfU1dJVENI
X1RJTUVfQ05UCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiMDg4KQo+IC0jZGVmaW5l
IF9NSVBJQ19DTEtfTEFORV9TV0lUQ0hfVElNRV9DTlQJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jh
c2UgKyAweGI4ODgpCj4gKyNkZWZpbmUgX01JUElBX0NMS19MQU5FX1NXSVRDSF9USU1FX0NOVAkJ
KGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiMDg4KQo+ICsjZGVmaW5lIF9NSVBJQ19DTEtfTEFO
RV9TV0lUQ0hfVElNRV9DTlQJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4Yjg4OCkKPiAgICNk
ZWZpbmUgTUlQSV9DTEtfTEFORV9TV0lUQ0hfVElNRV9DTlQocG9ydCkJX01NSU9fTUlQSShwb3J0
LCBfTUlQSUFfQ0xLX0xBTkVfU1dJVENIX1RJTUVfQ05ULCBfTUlQSUNfQ0xLX0xBTkVfU1dJVENI
X1RJTUVfQ05UKQo+ICAgI2RlZmluZSAgTFBfSFNfU1NXX0NOVF9TSElGVAkJCQkxNgo+ICAgI2Rl
ZmluZSAgTFBfSFNfU1NXX0NOVF9NQVNLCQkJCSgweGZmZmYgPDwgMTYpCj4gICAjZGVmaW5lICBI
U19MUF9QV1JfU1dfQ05UX1NISUZUCQkJCTAKPiAgICNkZWZpbmUgIEhTX0xQX1BXUl9TV19DTlRf
TUFTSwkJCQkoMHhmZmZmIDw8IDApCj4gICAKPiAtI2RlZmluZSBfTUlQSUFfU1RPUF9TVEFURV9T
VEFMTAkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjA4YykKPiAtI2RlZmluZSBfTUlQ
SUNfU1RPUF9TVEFURV9TVEFMTAkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4Yjg4YykK
PiArI2RlZmluZSBfTUlQSUFfU1RPUF9TVEFURV9TVEFMTAkJKGk5MTUtPm1pcGlfbW1pb19iYXNl
ICsgMHhiMDhjKQo+ICsjZGVmaW5lIF9NSVBJQ19TVE9QX1NUQVRFX1NUQUxMCQkoaTkxNS0+bWlw
aV9tbWlvX2Jhc2UgKyAweGI4OGMpCj4gICAjZGVmaW5lIE1JUElfU1RPUF9TVEFURV9TVEFMTChw
b3J0KQlfTU1JT19NSVBJKHBvcnQsIF9NSVBJQV9TVE9QX1NUQVRFX1NUQUxMLCBfTUlQSUNfU1RP
UF9TVEFURV9TVEFMTCkKPiAgICNkZWZpbmUgIFNUT1BfU1RBVEVfU1RBTExfQ09VTlRFUl9TSElG
VAkJCTAKPiAgICNkZWZpbmUgIFNUT1BfU1RBVEVfU1RBTExfQ09VTlRFUl9NQVNLCQkJKDB4ZmYg
PDwgMCkKPiAgIAo+IC0jZGVmaW5lIF9NSVBJQV9JTlRSX1NUQVRfUkVHXzEJCShkZXZfcHJpdi0+
bWlwaV9tbWlvX2Jhc2UgKyAweGIwOTApCj4gLSNkZWZpbmUgX01JUElDX0lOVFJfU1RBVF9SRUdf
MQkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4Yjg5MCkKPiArI2RlZmluZSBfTUlQSUFf
SU5UUl9TVEFUX1JFR18xCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwOTApCj4gKyNkZWZp
bmUgX01JUElDX0lOVFJfU1RBVF9SRUdfMQkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiODkw
KQo+ICAgI2RlZmluZSBNSVBJX0lOVFJfU1RBVF9SRUdfMShwb3J0KQlfTU1JT19NSVBJKHBvcnQs
IF9NSVBJQV9JTlRSX1NUQVRfUkVHXzEsIF9NSVBJQ19JTlRSX1NUQVRfUkVHXzEpCj4gLSNkZWZp
bmUgX01JUElBX0lOVFJfRU5fUkVHXzEJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGIw
OTQpCj4gLSNkZWZpbmUgX01JUElDX0lOVFJfRU5fUkVHXzEJCShkZXZfcHJpdi0+bWlwaV9tbWlv
X2Jhc2UgKyAweGI4OTQpCj4gKyNkZWZpbmUgX01JUElBX0lOVFJfRU5fUkVHXzEJCShpOTE1LT5t
aXBpX21taW9fYmFzZSArIDB4YjA5NCkKPiArI2RlZmluZSBfTUlQSUNfSU5UUl9FTl9SRUdfMQkJ
KGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiODk0KQo+ICAgI2RlZmluZSBNSVBJX0lOVFJfRU5f
UkVHXzEocG9ydCkJX01NSU9fTUlQSShwb3J0LCBfTUlQSUFfSU5UUl9FTl9SRUdfMSwgX01JUElD
X0lOVFJfRU5fUkVHXzEpCj4gICAjZGVmaW5lICBSWF9DT05URU5USU9OX0RFVEVDVEVECQkJCSgx
IDw8IDApCj4gICAKPiAgIC8qIFhYWDogb25seSBwaXBlIEEgPyE/ICovCj4gLSNkZWZpbmUgTUlQ
SUFfREJJX1RZUEVDX0NUUkwJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGIxMDApCj4g
KyNkZWZpbmUgTUlQSUFfREJJX1RZUEVDX0NUUkwJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4
YjEwMCkKPiAgICNkZWZpbmUgIERCSV9UWVBFQ19FTkFCTEUJCQkJKDEgPDwgMzEpCj4gICAjZGVm
aW5lICBEQklfVFlQRUNfV0lQCQkJCQkoMSA8PCAzMCkKPiAgICNkZWZpbmUgIERCSV9UWVBFQ19P
UFRJT05fU0hJRlQJCQkJMjgKPiBAQCAtMTEwMTksOCArMTEwMTksOCBAQCBlbnVtIHNrbF9wb3dl
cl9nYXRlIHsKPiAgIAo+ICAgLyogTUlQSSBhZGFwdGVyIHJlZ2lzdGVycyAqLwo+ICAgCj4gLSNk
ZWZpbmUgX01JUElBX0NUUkwJCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiMTA0KQo+
IC0jZGVmaW5lIF9NSVBJQ19DVFJMCQkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4Yjkw
NCkKPiArI2RlZmluZSBfTUlQSUFfQ1RSTAkJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4YjEw
NCkKPiArI2RlZmluZSBfTUlQSUNfQ1RSTAkJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4Yjkw
NCkKPiAgICNkZWZpbmUgTUlQSV9DVFJMKHBvcnQpCQkJX01NSU9fTUlQSShwb3J0LCBfTUlQSUFf
Q1RSTCwgX01JUElDX0NUUkwpCj4gICAjZGVmaW5lICBFU0NBUEVfQ0xPQ0tfRElWSURFUl9TSElG
VAkJCTUgLyogQSBvbmx5ICovCj4gICAjZGVmaW5lICBFU0NBUEVfQ0xPQ0tfRElWSURFUl9NQVNL
CQkJKDMgPDwgNSkKPiBAQCAtMTEwNTIsMjEgKzExMDUyLDIxIEBAIGVudW0gc2tsX3Bvd2VyX2dh
dGUgewo+ICAgI2RlZmluZSAgR0xLX01JUElJT19QT1JUX1BPV0VSRUQJCQkoMSA8PCAxKSAvKiBS
TyAqLwo+ICAgI2RlZmluZSAgR0xLX01JUElJT19FTkFCTEUJCQkJKDEgPDwgMCkKPiAgIAo+IC0j
ZGVmaW5lIF9NSVBJQV9EQVRBX0FERFJFU1MJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAw
eGIxMDgpCj4gLSNkZWZpbmUgX01JUElDX0RBVEFfQUREUkVTUwkJKGRldl9wcml2LT5taXBpX21t
aW9fYmFzZSArIDB4YjkwOCkKPiArI2RlZmluZSBfTUlQSUFfREFUQV9BRERSRVNTCQkoaTkxNS0+
bWlwaV9tbWlvX2Jhc2UgKyAweGIxMDgpCj4gKyNkZWZpbmUgX01JUElDX0RBVEFfQUREUkVTUwkJ
KGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiOTA4KQo+ICAgI2RlZmluZSBNSVBJX0RBVEFfQURE
UkVTUyhwb3J0KQkJX01NSU9fTUlQSShwb3J0LCBfTUlQSUFfREFUQV9BRERSRVNTLCBfTUlQSUNf
REFUQV9BRERSRVNTKQo+ICAgI2RlZmluZSAgREFUQV9NRU1fQUREUkVTU19TSElGVAkJCQk1Cj4g
ICAjZGVmaW5lICBEQVRBX01FTV9BRERSRVNTX01BU0sJCQkJKDB4N2ZmZmZmZiA8PCA1KQo+ICAg
I2RlZmluZSAgREFUQV9WQUxJRAkJCQkJKDEgPDwgMCkKPiAgIAo+IC0jZGVmaW5lIF9NSVBJQV9E
QVRBX0xFTkdUSAkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjEwYykKPiAtI2RlZmlu
ZSBfTUlQSUNfREFUQV9MRU5HVEgJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI5MGMp
Cj4gKyNkZWZpbmUgX01JUElBX0RBVEFfTEVOR1RICQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAw
eGIxMGMpCj4gKyNkZWZpbmUgX01JUElDX0RBVEFfTEVOR1RICQkoaTkxNS0+bWlwaV9tbWlvX2Jh
c2UgKyAweGI5MGMpCj4gICAjZGVmaW5lIE1JUElfREFUQV9MRU5HVEgocG9ydCkJCV9NTUlPX01J
UEkocG9ydCwgX01JUElBX0RBVEFfTEVOR1RILCBfTUlQSUNfREFUQV9MRU5HVEgpCj4gICAjZGVm
aW5lICBEQVRBX0xFTkdUSF9TSElGVAkJCQkwCj4gICAjZGVmaW5lICBEQVRBX0xFTkdUSF9NQVNL
CQkJCSgweGZmZmZmIDw8IDApCj4gICAKPiAtI2RlZmluZSBfTUlQSUFfQ09NTUFORF9BRERSRVNT
CQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiMTEwKQo+IC0jZGVmaW5lIF9NSVBJQ19D
T01NQU5EX0FERFJFU1MJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI5MTApCj4gKyNk
ZWZpbmUgX01JUElBX0NPTU1BTkRfQUREUkVTUwkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhi
MTEwKQo+ICsjZGVmaW5lIF9NSVBJQ19DT01NQU5EX0FERFJFU1MJCShpOTE1LT5taXBpX21taW9f
YmFzZSArIDB4YjkxMCkKPiAgICNkZWZpbmUgTUlQSV9DT01NQU5EX0FERFJFU1MocG9ydCkJX01N
SU9fTUlQSShwb3J0LCBfTUlQSUFfQ09NTUFORF9BRERSRVNTLCBfTUlQSUNfQ09NTUFORF9BRERS
RVNTKQo+ICAgI2RlZmluZSAgQ09NTUFORF9NRU1fQUREUkVTU19TSElGVAkJCTUKPiAgICNkZWZp
bmUgIENPTU1BTkRfTUVNX0FERFJFU1NfTUFTSwkJCSgweDdmZmZmZmYgPDwgNSkKPiBAQCAtMTEw
NzQsMTggKzExMDc0LDE4IEBAIGVudW0gc2tsX3Bvd2VyX2dhdGUgewo+ICAgI2RlZmluZSAgTUVN
T1JZX1dSSVRFX0RBVEFfRlJPTV9QSVBFX1JFTkRFUklORwkJKDEgPDwgMSkKPiAgICNkZWZpbmUg
IENPTU1BTkRfVkFMSUQJCQkJCSgxIDw8IDApCj4gICAKPiAtI2RlZmluZSBfTUlQSUFfQ09NTUFO
RF9MRU5HVEgJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGIxMTQpCj4gLSNkZWZpbmUg
X01JUElDX0NPTU1BTkRfTEVOR1RICQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiOTE0
KQo+ICsjZGVmaW5lIF9NSVBJQV9DT01NQU5EX0xFTkdUSAkJKGk5MTUtPm1pcGlfbW1pb19iYXNl
ICsgMHhiMTE0KQo+ICsjZGVmaW5lIF9NSVBJQ19DT01NQU5EX0xFTkdUSAkJKGk5MTUtPm1pcGlf
bW1pb19iYXNlICsgMHhiOTE0KQo+ICAgI2RlZmluZSBNSVBJX0NPTU1BTkRfTEVOR1RIKHBvcnQp
CV9NTUlPX01JUEkocG9ydCwgX01JUElBX0NPTU1BTkRfTEVOR1RILCBfTUlQSUNfQ09NTUFORF9M
RU5HVEgpCj4gICAjZGVmaW5lICBDT01NQU5EX0xFTkdUSF9TSElGVChuKQkJCSg4ICogKG4pKSAv
KiBuOiAwLi4uMyAqLwo+ICAgI2RlZmluZSAgQ09NTUFORF9MRU5HVEhfTUFTSyhuKQkJCQkoMHhm
ZiA8PCAoOCAqIChuKSkpCj4gICAKPiAtI2RlZmluZSBfTUlQSUFfUkVBRF9EQVRBX1JFVFVSTjAJ
KGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjExOCkKPiAtI2RlZmluZSBfTUlQSUNfUkVB
RF9EQVRBX1JFVFVSTjAJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjkxOCkKPiArI2Rl
ZmluZSBfTUlQSUFfUkVBRF9EQVRBX1JFVFVSTjAJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhi
MTE4KQo+ICsjZGVmaW5lIF9NSVBJQ19SRUFEX0RBVEFfUkVUVVJOMAkoaTkxNS0+bWlwaV9tbWlv
X2Jhc2UgKyAweGI5MTgpCj4gICAjZGVmaW5lIE1JUElfUkVBRF9EQVRBX1JFVFVSTihwb3J0LCBu
KSBfTU1JTyhfTUlQSShwb3J0LCBfTUlQSUFfUkVBRF9EQVRBX1JFVFVSTjAsIF9NSVBJQ19SRUFE
X0RBVEFfUkVUVVJOMCkgKyA0ICogKG4pKSAvKiBuOiAwLi4uNyAqLwo+ICAgCj4gLSNkZWZpbmUg
X01JUElBX1JFQURfREFUQV9WQUxJRAkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjEz
OCkKPiAtI2RlZmluZSBfTUlQSUNfUkVBRF9EQVRBX1ZBTElECQkoZGV2X3ByaXYtPm1pcGlfbW1p
b19iYXNlICsgMHhiOTM4KQo+ICsjZGVmaW5lIF9NSVBJQV9SRUFEX0RBVEFfVkFMSUQJCShpOTE1
LT5taXBpX21taW9fYmFzZSArIDB4YjEzOCkKPiArI2RlZmluZSBfTUlQSUNfUkVBRF9EQVRBX1ZB
TElECQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGI5MzgpCj4gICAjZGVmaW5lIE1JUElfUkVB
RF9EQVRBX1ZBTElEKHBvcnQpCV9NTUlPX01JUEkocG9ydCwgX01JUElBX1JFQURfREFUQV9WQUxJ
RCwgX01JUElDX1JFQURfREFUQV9WQUxJRCkKPiAgICNkZWZpbmUgIFJFQURfREFUQV9WQUxJRChu
KQkJCQkoMSA8PCAobikpCj4gICAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9zdXNwZW5kLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3N1c3BlbmQuYwo+IGlu
ZGV4IDU4MTIwMWJjYjgxYS4uNWIzYWQ3YzkyNDBlIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfc3VzcGVuZC5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9zdXNwZW5kLmMKPiBAQCAtMzEsMTIxICszMSwxMjEgQEAKPiAgICNpbmNsdWRlICJpbnRlbF9m
YmMuaCIKPiAgICNpbmNsdWRlICJpbnRlbF9nbWJ1cy5oIgo+ICAgCj4gLXN0YXRpYyB2b2lkIGk5
MTVfc2F2ZV9kaXNwbGF5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3Rh
dGljIHZvaWQgaTkxNV9zYXZlX2Rpc3BsYXkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gICB7Cj4gICAJLyogRGlzcGxheSBhcmJpdHJhdGlvbiBjb250cm9sICovCj4gLQlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA8PSA0KQo+IC0JCWRldl9wcml2LT5yZWdmaWxlLnNhdmVEU1BBUkIg
PSBJOTE1X1JFQUQoRFNQQVJCKTsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPD0gNCkKPiArCQlp
OTE1LT5yZWdmaWxlLnNhdmVEU1BBUkIgPSBJOTE1X1JFQUQoRFNQQVJCKTsKPiAgIAo+ICAgCS8q
IHNhdmUgRkJDIGludGVydmFsICovCj4gLQlpZiAoSEFTX0ZCQyhkZXZfcHJpdikgJiYgSU5URUxf
R0VOKGRldl9wcml2KSA8PSA0ICYmICFJU19HNFgoZGV2X3ByaXYpKQo+IC0JCWRldl9wcml2LT5y
ZWdmaWxlLnNhdmVGQkNfQ09OVFJPTCA9IEk5MTVfUkVBRChGQkNfQ09OVFJPTCk7Cj4gKwlpZiAo
SEFTX0ZCQyhpOTE1KSAmJiBJTlRFTF9HRU4oaTkxNSkgPD0gNCAmJiAhSVNfRzRYKGk5MTUpKQo+
ICsJCWk5MTUtPnJlZ2ZpbGUuc2F2ZUZCQ19DT05UUk9MID0gSTkxNV9SRUFEKEZCQ19DT05UUk9M
KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpOTE1X3Jlc3RvcmVfZGlzcGxheShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGk5MTVfcmVzdG9yZV9k
aXNwbGF5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCS8qIERpc3Bs
YXkgYXJiaXRyYXRpb24gKi8KPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDQpCj4gLQkJ
STkxNV9XUklURShEU1BBUkIsIGRldl9wcml2LT5yZWdmaWxlLnNhdmVEU1BBUkIpOwo+ICsJaWYg
KElOVEVMX0dFTihpOTE1KSA8PSA0KQo+ICsJCUk5MTVfV1JJVEUoRFNQQVJCLCBpOTE1LT5yZWdm
aWxlLnNhdmVEU1BBUkIpOwo+ICAgCj4gICAJLyogb25seSByZXN0b3JlIEZCQyBpbmZvIG9uIHRo
ZSBwbGF0Zm9ybSB0aGF0IHN1cHBvcnRzIEZCQyovCj4gLQlpbnRlbF9mYmNfZ2xvYmFsX2Rpc2Fi
bGUoZGV2X3ByaXYpOwo+ICsJaW50ZWxfZmJjX2dsb2JhbF9kaXNhYmxlKGk5MTUpOwo+ICAgCj4g
ICAJLyogcmVzdG9yZSBGQkMgaW50ZXJ2YWwgKi8KPiAtCWlmIChIQVNfRkJDKGRldl9wcml2KSAm
JiBJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDQgJiYgIUlTX0c0WChkZXZfcHJpdikpCj4gLQkJSTkx
NV9XUklURShGQkNfQ09OVFJPTCwgZGV2X3ByaXYtPnJlZ2ZpbGUuc2F2ZUZCQ19DT05UUk9MKTsK
PiArCWlmIChIQVNfRkJDKGk5MTUpICYmIElOVEVMX0dFTihpOTE1KSA8PSA0ICYmICFJU19HNFgo
aTkxNSkpCj4gKwkJSTkxNV9XUklURShGQkNfQ09OVFJPTCwgaTkxNS0+cmVnZmlsZS5zYXZlRkJD
X0NPTlRST0wpOwo+ICAgCj4gLQlpOTE1X3JlZGlzYWJsZV92Z2EoZGV2X3ByaXYpOwo+ICsJaTkx
NV9yZWRpc2FibGVfdmdhKGk5MTUpOwo+ICAgfQo+ICAgCj4gLWludCBpOTE1X3NhdmVfc3RhdGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtpbnQgaTkxNV9zYXZlX3N0YXRl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RydWN0IHBjaV9kZXYg
KnBkZXYgPSBkZXZfcHJpdi0+ZHJtLnBkZXY7Cj4gKwlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGk5
MTUtPmRybS5wZGV2Owo+ICAgCWludCBpOwo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+
ZHJtLnN0cnVjdF9tdXRleCk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4
KTsKPiAgIAo+IC0JaTkxNV9zYXZlX2Rpc3BsYXkoZGV2X3ByaXYpOwo+ICsJaTkxNV9zYXZlX2Rp
c3BsYXkoaTkxNSk7Cj4gICAKPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDQpKQo+ICsJaWYgKElT
X0dFTihpOTE1LCA0KSkKPiAgIAkJcGNpX3JlYWRfY29uZmlnX3dvcmQocGRldiwgR0NER01CVVMs
Cj4gLQkJCQkgICAgICZkZXZfcHJpdi0+cmVnZmlsZS5zYXZlR0NER01CVVMpOwo+ICsJCQkJICAg
ICAmaTkxNS0+cmVnZmlsZS5zYXZlR0NER01CVVMpOwo+ICAgCj4gICAJLyogQ2FjaGUgbW9kZSBz
dGF0ZSAqLwo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA3KQo+IC0JCWRldl9wcml2LT5y
ZWdmaWxlLnNhdmVDQUNIRV9NT0RFXzAgPSBJOTE1X1JFQUQoQ0FDSEVfTU9ERV8wKTsKPiArCWlm
IChJTlRFTF9HRU4oaTkxNSkgPCA3KQo+ICsJCWk5MTUtPnJlZ2ZpbGUuc2F2ZUNBQ0hFX01PREVf
MCA9IEk5MTVfUkVBRChDQUNIRV9NT0RFXzApOwo+ICAgCj4gICAJLyogTWVtb3J5IEFyYml0cmF0
aW9uIHN0YXRlICovCj4gLQlkZXZfcHJpdi0+cmVnZmlsZS5zYXZlTUlfQVJCX1NUQVRFID0gSTkx
NV9SRUFEKE1JX0FSQl9TVEFURSk7Cj4gKwlpOTE1LT5yZWdmaWxlLnNhdmVNSV9BUkJfU1RBVEUg
PSBJOTE1X1JFQUQoTUlfQVJCX1NUQVRFKTsKPiAgIAo+ICAgCS8qIFNjcmF0Y2ggc3BhY2UgKi8K
PiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDIpICYmIElTX01PQklMRShkZXZfcHJpdikpIHsKPiAr
CWlmIChJU19HRU4oaTkxNSwgMikgJiYgSVNfTU9CSUxFKGk5MTUpKSB7Cj4gICAJCWZvciAoaSA9
IDA7IGkgPCA3OyBpKyspIHsKPiAtCQkJZGV2X3ByaXYtPnJlZ2ZpbGUuc2F2ZVNXRjBbaV0gPSBJ
OTE1X1JFQUQoU1dGMChpKSk7Cj4gLQkJCWRldl9wcml2LT5yZWdmaWxlLnNhdmVTV0YxW2ldID0g
STkxNV9SRUFEKFNXRjEoaSkpOwo+ICsJCQlpOTE1LT5yZWdmaWxlLnNhdmVTV0YwW2ldID0gSTkx
NV9SRUFEKFNXRjAoaSkpOwo+ICsJCQlpOTE1LT5yZWdmaWxlLnNhdmVTV0YxW2ldID0gSTkxNV9S
RUFEKFNXRjEoaSkpOwo+ICAgCQl9Cj4gICAJCWZvciAoaSA9IDA7IGkgPCAzOyBpKyspCj4gLQkJ
CWRldl9wcml2LT5yZWdmaWxlLnNhdmVTV0YzW2ldID0gSTkxNV9SRUFEKFNXRjMoaSkpOwo+IC0J
fSBlbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDIpKSB7Cj4gKwkJCWk5MTUtPnJlZ2ZpbGUuc2F2
ZVNXRjNbaV0gPSBJOTE1X1JFQUQoU1dGMyhpKSk7Cj4gKwl9IGVsc2UgaWYgKElTX0dFTihpOTE1
LCAyKSkgewo+ICAgCQlmb3IgKGkgPSAwOyBpIDwgNzsgaSsrKQo+IC0JCQlkZXZfcHJpdi0+cmVn
ZmlsZS5zYXZlU1dGMVtpXSA9IEk5MTVfUkVBRChTV0YxKGkpKTsKPiAtCX0gZWxzZSBpZiAoSEFT
X0dNQ0goZGV2X3ByaXYpKSB7Cj4gKwkJCWk5MTUtPnJlZ2ZpbGUuc2F2ZVNXRjFbaV0gPSBJOTE1
X1JFQUQoU1dGMShpKSk7Cj4gKwl9IGVsc2UgaWYgKEhBU19HTUNIKGk5MTUpKSB7Cj4gICAJCWZv
ciAoaSA9IDA7IGkgPCAxNjsgaSsrKSB7Cj4gLQkJCWRldl9wcml2LT5yZWdmaWxlLnNhdmVTV0Yw
W2ldID0gSTkxNV9SRUFEKFNXRjAoaSkpOwo+IC0JCQlkZXZfcHJpdi0+cmVnZmlsZS5zYXZlU1dG
MVtpXSA9IEk5MTVfUkVBRChTV0YxKGkpKTsKPiArCQkJaTkxNS0+cmVnZmlsZS5zYXZlU1dGMFtp
XSA9IEk5MTVfUkVBRChTV0YwKGkpKTsKPiArCQkJaTkxNS0+cmVnZmlsZS5zYXZlU1dGMVtpXSA9
IEk5MTVfUkVBRChTV0YxKGkpKTsKPiAgIAkJfQo+ICAgCQlmb3IgKGkgPSAwOyBpIDwgMzsgaSsr
KQo+IC0JCQlkZXZfcHJpdi0+cmVnZmlsZS5zYXZlU1dGM1tpXSA9IEk5MTVfUkVBRChTV0YzKGkp
KTsKPiArCQkJaTkxNS0+cmVnZmlsZS5zYXZlU1dGM1tpXSA9IEk5MTVfUkVBRChTV0YzKGkpKTsK
PiAgIAl9Cj4gICAKPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgp
Owo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAo+ICAgCXJl
dHVybiAwOwo+ICAgfQo+ICAgCj4gLWludCBpOTE1X3Jlc3RvcmVfc3RhdGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtpbnQgaTkxNV9yZXN0b3JlX3N0YXRlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBk
ZXZfcHJpdi0+ZHJtLnBkZXY7Cj4gKwlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGk5MTUtPmRybS5w
ZGV2Owo+ICAgCWludCBpOwo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVj
dF9tdXRleCk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAo+
IC0JaWYgKElTX0dFTihkZXZfcHJpdiwgNCkpCj4gKwlpZiAoSVNfR0VOKGk5MTUsIDQpKQo+ICAg
CQlwY2lfd3JpdGVfY29uZmlnX3dvcmQocGRldiwgR0NER01CVVMsCj4gLQkJCQkgICAgICBkZXZf
cHJpdi0+cmVnZmlsZS5zYXZlR0NER01CVVMpOwo+IC0JaTkxNV9yZXN0b3JlX2Rpc3BsYXkoZGV2
X3ByaXYpOwo+ICsJCQkJICAgICAgaTkxNS0+cmVnZmlsZS5zYXZlR0NER01CVVMpOwo+ICsJaTkx
NV9yZXN0b3JlX2Rpc3BsYXkoaTkxNSk7Cj4gICAKPiAgIAkvKiBDYWNoZSBtb2RlIHN0YXRlICov
Cj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDcpCj4gLQkJSTkxNV9XUklURShDQUNIRV9N
T0RFXzAsIGRldl9wcml2LT5yZWdmaWxlLnNhdmVDQUNIRV9NT0RFXzAgfAo+ICsJaWYgKElOVEVM
X0dFTihpOTE1KSA8IDcpCj4gKwkJSTkxNV9XUklURShDQUNIRV9NT0RFXzAsIGk5MTUtPnJlZ2Zp
bGUuc2F2ZUNBQ0hFX01PREVfMCB8Cj4gICAJCQkgICAweGZmZmYwMDAwKTsKPiAgIAo+ICAgCS8q
IE1lbW9yeSBhcmJpdHJhdGlvbiBzdGF0ZSAqLwo+IC0JSTkxNV9XUklURShNSV9BUkJfU1RBVEUs
IGRldl9wcml2LT5yZWdmaWxlLnNhdmVNSV9BUkJfU1RBVEUgfCAweGZmZmYwMDAwKTsKPiArCUk5
MTVfV1JJVEUoTUlfQVJCX1NUQVRFLCBpOTE1LT5yZWdmaWxlLnNhdmVNSV9BUkJfU1RBVEUgfCAw
eGZmZmYwMDAwKTsKPiAgIAo+ICAgCS8qIFNjcmF0Y2ggc3BhY2UgKi8KPiAtCWlmIChJU19HRU4o
ZGV2X3ByaXYsIDIpICYmIElTX01PQklMRShkZXZfcHJpdikpIHsKPiArCWlmIChJU19HRU4oaTkx
NSwgMikgJiYgSVNfTU9CSUxFKGk5MTUpKSB7Cj4gICAJCWZvciAoaSA9IDA7IGkgPCA3OyBpKysp
IHsKPiAtCQkJSTkxNV9XUklURShTV0YwKGkpLCBkZXZfcHJpdi0+cmVnZmlsZS5zYXZlU1dGMFtp
XSk7Cj4gLQkJCUk5MTVfV1JJVEUoU1dGMShpKSwgZGV2X3ByaXYtPnJlZ2ZpbGUuc2F2ZVNXRjFb
aV0pOwo+ICsJCQlJOTE1X1dSSVRFKFNXRjAoaSksIGk5MTUtPnJlZ2ZpbGUuc2F2ZVNXRjBbaV0p
Owo+ICsJCQlJOTE1X1dSSVRFKFNXRjEoaSksIGk5MTUtPnJlZ2ZpbGUuc2F2ZVNXRjFbaV0pOwo+
ICAgCQl9Cj4gICAJCWZvciAoaSA9IDA7IGkgPCAzOyBpKyspCj4gLQkJCUk5MTVfV1JJVEUoU1dG
MyhpKSwgZGV2X3ByaXYtPnJlZ2ZpbGUuc2F2ZVNXRjNbaV0pOwo+IC0JfSBlbHNlIGlmIChJU19H
RU4oZGV2X3ByaXYsIDIpKSB7Cj4gKwkJCUk5MTVfV1JJVEUoU1dGMyhpKSwgaTkxNS0+cmVnZmls
ZS5zYXZlU1dGM1tpXSk7Cj4gKwl9IGVsc2UgaWYgKElTX0dFTihpOTE1LCAyKSkgewo+ICAgCQlm
b3IgKGkgPSAwOyBpIDwgNzsgaSsrKQo+IC0JCQlJOTE1X1dSSVRFKFNXRjEoaSksIGRldl9wcml2
LT5yZWdmaWxlLnNhdmVTV0YxW2ldKTsKPiAtCX0gZWxzZSBpZiAoSEFTX0dNQ0goZGV2X3ByaXYp
KSB7Cj4gKwkJCUk5MTVfV1JJVEUoU1dGMShpKSwgaTkxNS0+cmVnZmlsZS5zYXZlU1dGMVtpXSk7
Cj4gKwl9IGVsc2UgaWYgKEhBU19HTUNIKGk5MTUpKSB7Cj4gICAJCWZvciAoaSA9IDA7IGkgPCAx
NjsgaSsrKSB7Cj4gLQkJCUk5MTVfV1JJVEUoU1dGMChpKSwgZGV2X3ByaXYtPnJlZ2ZpbGUuc2F2
ZVNXRjBbaV0pOwo+IC0JCQlJOTE1X1dSSVRFKFNXRjEoaSksIGRldl9wcml2LT5yZWdmaWxlLnNh
dmVTV0YxW2ldKTsKPiArCQkJSTkxNV9XUklURShTV0YwKGkpLCBpOTE1LT5yZWdmaWxlLnNhdmVT
V0YwW2ldKTsKPiArCQkJSTkxNV9XUklURShTV0YxKGkpLCBpOTE1LT5yZWdmaWxlLnNhdmVTV0Yx
W2ldKTsKPiAgIAkJfQo+ICAgCQlmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKQo+IC0JCQlJOTE1X1dS
SVRFKFNXRjMoaSksIGRldl9wcml2LT5yZWdmaWxlLnNhdmVTV0YzW2ldKTsKPiArCQkJSTkxNV9X
UklURShTV0YzKGkpLCBpOTE1LT5yZWdmaWxlLnNhdmVTV0YzW2ldKTsKPiAgIAl9Cj4gICAKPiAt
CW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJbXV0ZXhfdW5s
b2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAo+IC0JaW50ZWxfZ21idXNfcmVzZXQo
ZGV2X3ByaXYpOwo+ICsJaW50ZWxfZ21idXNfcmVzZXQoaTkxNSk7Cj4gICAKPiAgIAlyZXR1cm4g
MDsKPiAgIH0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zeXNmcy5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zeXNmcy5jCj4gaW5kZXggM2VmMDdiOTg3ZDQw
Li45Yzg5YmUzZWM0YzEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9z
eXNmcy5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zeXNmcy5jCj4gQEAgLTQy
LDE0ICs0MiwxNCBAQCBzdGF0aWMgaW5saW5lIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICprZGV2
X21pbm9yX3RvX2k5MTUoc3RydWN0IGRldmljZSAqa2RldikKPiAgIH0KPiAgIAo+ICAgI2lmZGVm
IENPTkZJR19QTQo+IC1zdGF0aWMgdTMyIGNhbGNfcmVzaWRlbmN5KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHUzMiBjYWxjX3Jlc2lkZW5jeShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgaTkxNV9yZWdfdCByZWcpCj4gICB7Cj4gICAJ
aW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gICAJdTY0IHJlcyA9IDA7Cj4gICAKPiAtCXdpdGhf
aW50ZWxfcnVudGltZV9wbShkZXZfcHJpdiwgd2FrZXJlZikKPiAtCQlyZXMgPSBpbnRlbF9yYzZf
cmVzaWRlbmN5X3VzKGRldl9wcml2LCByZWcpOwo+ICsJd2l0aF9pbnRlbF9ydW50aW1lX3BtKGk5
MTUsIHdha2VyZWYpCj4gKwkJcmVzID0gaW50ZWxfcmM2X3Jlc2lkZW5jeV91cyhpOTE1LCByZWcp
Owo+ICAgCj4gICAJcmV0dXJuIERJVl9ST1VORF9DTE9TRVNUX1VMTChyZXMsIDEwMDApOwo+ICAg
fQo+IEBAIC01NywxNSArNTcsMTUgQEAgc3RhdGljIHUzMiBjYWxjX3Jlc2lkZW5jeShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICBzdGF0aWMgc3NpemVfdAo+ICAgc2hvd19y
YzZfbWFzayhzdHJ1Y3QgZGV2aWNlICprZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0
ciwgY2hhciAqYnVmKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0ga2Rldl9taW5vcl90b19pOTE1KGtkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7Cj4gICAJdW5zaWduZWQgaW50IG1hc2s7
Cj4gICAKPiAgIAltYXNrID0gMDsKPiAtCWlmIChIQVNfUkM2KGRldl9wcml2KSkKPiArCWlmIChI
QVNfUkM2KGk5MTUpKQo+ICAgCQltYXNrIHw9IEJJVCgwKTsKPiAtCWlmIChIQVNfUkM2cChkZXZf
cHJpdikpCj4gKwlpZiAoSEFTX1JDNnAoaTkxNSkpCj4gICAJCW1hc2sgfD0gQklUKDEpOwo+IC0J
aWYgKEhBU19SQzZwcChkZXZfcHJpdikpCj4gKwlpZiAoSEFTX1JDNnBwKGk5MTUpKQo+ICAgCQlt
YXNrIHw9IEJJVCgyKTsKPiAgIAo+ICAgCXJldHVybiBzbnByaW50ZihidWYsIFBBR0VfU0laRSwg
IiV4XG4iLCBtYXNrKTsKPiBAQCAtNzQsMzIgKzc0LDMyIEBAIHNob3dfcmM2X21hc2soc3RydWN0
IGRldmljZSAqa2Rldiwgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikK
PiAgIHN0YXRpYyBzc2l6ZV90Cj4gICBzaG93X3JjNl9tcyhzdHJ1Y3QgZGV2aWNlICprZGV2LCBz
dHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+ICAgewo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0ga2Rldl9taW5vcl90b19pOTE1KGtkZXYpOwo+
IC0JdTMyIHJjNl9yZXNpZGVuY3kgPSBjYWxjX3Jlc2lkZW5jeShkZXZfcHJpdiwgR0VONl9HVF9H
RlhfUkM2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0ga2Rldl9taW5vcl90
b19pOTE1KGtkZXYpOwo+ICsJdTMyIHJjNl9yZXNpZGVuY3kgPSBjYWxjX3Jlc2lkZW5jeShpOTE1
LCBHRU42X0dUX0dGWF9SQzYpOwo+ICAgCXJldHVybiBzbnByaW50ZihidWYsIFBBR0VfU0laRSwg
IiV1XG4iLCByYzZfcmVzaWRlbmN5KTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHNzaXplX3QKPiAg
IHNob3dfcmM2cF9tcyhzdHJ1Y3QgZGV2aWNlICprZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0
ZSAqYXR0ciwgY2hhciAqYnVmKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0ga2Rldl9taW5vcl90b19pOTE1KGtkZXYpOwo+IC0JdTMyIHJjNnBfcmVzaWRlbmN5
ID0gY2FsY19yZXNpZGVuY3koZGV2X3ByaXYsIEdFTjZfR1RfR0ZYX1JDNnApOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7Cj4gKwl1
MzIgcmM2cF9yZXNpZGVuY3kgPSBjYWxjX3Jlc2lkZW5jeShpOTE1LCBHRU42X0dUX0dGWF9SQzZw
KTsKPiAgIAlyZXR1cm4gc25wcmludGYoYnVmLCBQQUdFX1NJWkUsICIldVxuIiwgcmM2cF9yZXNp
ZGVuY3kpOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgc3NpemVfdAo+ICAgc2hvd19yYzZwcF9tcyhz
dHJ1Y3QgZGV2aWNlICprZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAq
YnVmKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0ga2Rldl9t
aW5vcl90b19pOTE1KGtkZXYpOwo+IC0JdTMyIHJjNnBwX3Jlc2lkZW5jeSA9IGNhbGNfcmVzaWRl
bmN5KGRldl9wcml2LCBHRU42X0dUX0dGWF9SQzZwcCk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IGtkZXZfbWlub3JfdG9faTkxNShrZGV2KTsKPiArCXUzMiByYzZwcF9yZXNp
ZGVuY3kgPSBjYWxjX3Jlc2lkZW5jeShpOTE1LCBHRU42X0dUX0dGWF9SQzZwcCk7Cj4gICAJcmV0
dXJuIHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiJXVcbiIsIHJjNnBwX3Jlc2lkZW5jeSk7Cj4g
ICB9Cj4gICAKPiAgIHN0YXRpYyBzc2l6ZV90Cj4gICBzaG93X21lZGlhX3JjNl9tcyhzdHJ1Y3Qg
ZGV2aWNlICprZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+
ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0ga2Rldl9taW5vcl90
b19pOTE1KGtkZXYpOwo+IC0JdTMyIHJjNl9yZXNpZGVuY3kgPSBjYWxjX3Jlc2lkZW5jeShkZXZf
cHJpdiwgVkxWX0dUX01FRElBX1JDNik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IGtkZXZfbWlub3JfdG9faTkxNShrZGV2KTsKPiArCXUzMiByYzZfcmVzaWRlbmN5ID0gY2Fs
Y19yZXNpZGVuY3koaTkxNSwgVkxWX0dUX01FRElBX1JDNik7Cj4gICAJcmV0dXJuIHNucHJpbnRm
KGJ1ZiwgUEFHRV9TSVpFLCAiJXVcbiIsIHJjNl9yZXNpZGVuY3kpOwo+ICAgfQo+ICAgCj4gQEAg
LTE0Miw5ICsxNDIsOSBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGF0dHJpYnV0ZV9ncm91cCBtZWRp
YV9yYzZfYXR0cl9ncm91cCA9IHsKPiAgIH07Cj4gICAjZW5kaWYKPiAgIAo+IC1zdGF0aWMgaW50
IGwzX2FjY2Vzc192YWxpZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGxvZmZf
dCBvZmZzZXQpCj4gK3N0YXRpYyBpbnQgbDNfYWNjZXNzX3ZhbGlkKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LCBsb2ZmX3Qgb2Zmc2V0KQo+ICAgewo+IC0JaWYgKCFIQVNfTDNfRFBGKGRl
dl9wcml2KSkKPiArCWlmICghSEFTX0wzX0RQRihpOTE1KSkKPiAgIAkJcmV0dXJuIC1FUEVSTTsK
PiAgIAo+ICAgCWlmIChvZmZzZXQgJSA0ICE9IDApCj4gQEAgLTE2MiwxNCArMTYyLDE0IEBAIGk5
MTVfbDNfcmVhZChzdHJ1Y3QgZmlsZSAqZmlscCwgc3RydWN0IGtvYmplY3QgKmtvYmosCj4gICAJ
ICAgICBsb2ZmX3Qgb2Zmc2V0LCBzaXplX3QgY291bnQpCj4gICB7Cj4gICAJc3RydWN0IGRldmlj
ZSAqa2RldiA9IGtvYmpfdG9fZGV2KGtvYmopOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0ga2Rldl9taW5vcl90b19pOTE1KGtkZXYpOwo+IC0Jc3RydWN0IGRybV9kZXZp
Y2UgKmRldiA9ICZkZXZfcHJpdi0+ZHJtOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7Cj4gKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
ID0gJmk5MTUtPmRybTsKPiAgIAlpbnQgc2xpY2UgPSAoaW50KSh1aW50cHRyX3QpYXR0ci0+cHJp
dmF0ZTsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gICAJY291bnQgPSByb3VuZF9kb3duKGNvdW50LCA0
KTsKPiAgIAo+IC0JcmV0ID0gbDNfYWNjZXNzX3ZhbGlkKGRldl9wcml2LCBvZmZzZXQpOwo+ICsJ
cmV0ID0gbDNfYWNjZXNzX3ZhbGlkKGk5MTUsIG9mZnNldCk7Cj4gICAJaWYgKHJldCkKPiAgIAkJ
cmV0dXJuIHJldDsKPiAgIAo+IEBAIC0xNzksOSArMTc5LDkgQEAgaTkxNV9sM19yZWFkKHN0cnVj
dCBmaWxlICpmaWxwLCBzdHJ1Y3Qga29iamVjdCAqa29iaiwKPiAgIAlpZiAocmV0KQo+ICAgCQly
ZXR1cm4gcmV0Owo+ICAgCj4gLQlpZiAoZGV2X3ByaXYtPmwzX3Bhcml0eS5yZW1hcF9pbmZvW3Ns
aWNlXSkKPiArCWlmIChpOTE1LT5sM19wYXJpdHkucmVtYXBfaW5mb1tzbGljZV0pCj4gICAJCW1l
bWNweShidWYsCj4gLQkJICAgICAgIGRldl9wcml2LT5sM19wYXJpdHkucmVtYXBfaW5mb1tzbGlj
ZV0gKyAob2Zmc2V0LzQpLAo+ICsJCSAgICAgICBpOTE1LT5sM19wYXJpdHkucmVtYXBfaW5mb1tz
bGljZV0gKyAob2Zmc2V0LzQpLAo+ICAgCQkgICAgICAgY291bnQpOwo+ICAgCWVsc2UKPiAgIAkJ
bWVtc2V0KGJ1ZiwgMCwgY291bnQpOwo+IEBAIC0xOTcsMTQgKzE5NywxNCBAQCBpOTE1X2wzX3dy
aXRlKHN0cnVjdCBmaWxlICpmaWxwLCBzdHJ1Y3Qga29iamVjdCAqa29iaiwKPiAgIAkgICAgICBs
b2ZmX3Qgb2Zmc2V0LCBzaXplX3QgY291bnQpCj4gICB7Cj4gICAJc3RydWN0IGRldmljZSAqa2Rl
diA9IGtvYmpfdG9fZGV2KGtvYmopOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0ga2Rldl9taW5vcl90b19pOTE1KGtkZXYpOwo+IC0Jc3RydWN0IGRybV9kZXZpY2UgKmRl
diA9ICZkZXZfcHJpdi0+ZHJtOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBr
ZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7Cj4gKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmk5
MTUtPmRybTsKPiAgIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4Owo+ICAgCWludCBzbGlj
ZSA9IChpbnQpKHVpbnRwdHJfdClhdHRyLT5wcml2YXRlOwo+ICAgCXUzMiAqKnJlbWFwX2luZm87
Cj4gICAJaW50IHJldDsKPiAgIAo+IC0JcmV0ID0gbDNfYWNjZXNzX3ZhbGlkKGRldl9wcml2LCBv
ZmZzZXQpOwo+ICsJcmV0ID0gbDNfYWNjZXNzX3ZhbGlkKGk5MTUsIG9mZnNldCk7Cj4gICAJaWYg
KHJldCkKPiAgIAkJcmV0dXJuIHJldDsKPiAgIAo+IEBAIC0yMTIsNyArMjEyLDcgQEAgaTkxNV9s
M193cml0ZShzdHJ1Y3QgZmlsZSAqZmlscCwgc3RydWN0IGtvYmplY3QgKmtvYmosCj4gICAJaWYg
KHJldCkKPiAgIAkJcmV0dXJuIHJldDsKPiAgIAo+IC0JcmVtYXBfaW5mbyA9ICZkZXZfcHJpdi0+
bDNfcGFyaXR5LnJlbWFwX2luZm9bc2xpY2VdOwo+ICsJcmVtYXBfaW5mbyA9ICZpOTE1LT5sM19w
YXJpdHkucmVtYXBfaW5mb1tzbGljZV07Cj4gICAJaWYgKCEqcmVtYXBfaW5mbykgewo+ICAgCQkq
cmVtYXBfaW5mbyA9IGt6YWxsb2MoR0VON19MM0xPR19TSVpFLCBHRlBfS0VSTkVMKTsKPiAgIAkJ
aWYgKCEqcmVtYXBfaW5mbykgewo+IEBAIC0yMjgsNyArMjI4LDcgQEAgaTkxNV9sM193cml0ZShz
dHJ1Y3QgZmlsZSAqZmlscCwgc3RydWN0IGtvYmplY3QgKmtvYmosCj4gICAJbWVtY3B5KCpyZW1h
cF9pbmZvICsgKG9mZnNldC80KSwgYnVmLCBjb3VudCk7Cj4gICAKPiAgIAkvKiBOQjogV2UgZGVm
ZXIgdGhlIHJlbWFwcGluZyB1bnRpbCB3ZSBzd2l0Y2ggdG8gdGhlIGNvbnRleHQgKi8KPiAtCWxp
c3RfZm9yX2VhY2hfZW50cnkoY3R4LCAmZGV2X3ByaXYtPmNvbnRleHRzLmxpc3QsIGxpbmspCj4g
KwlsaXN0X2Zvcl9lYWNoX2VudHJ5KGN0eCwgJmk5MTUtPmNvbnRleHRzLmxpc3QsIGxpbmspCj4g
ICAJCWN0eC0+cmVtYXBfc2xpY2UgfD0gKDE8PHNsaWNlKTsKPiAgIAo+ICAgCXJldCA9IGNvdW50
Owo+IEBAIC0yNjAsNTIgKzI2MCw1MiBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGJpbl9hdHRyaWJ1
dGUgZHBmX2F0dHJzXzEgPSB7Cj4gICBzdGF0aWMgc3NpemVfdCBndF9hY3RfZnJlcV9taHpfc2hv
dyhzdHJ1Y3QgZGV2aWNlICprZGV2LAo+ICAgCQkJCSAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0
ZSAqYXR0ciwgY2hhciAqYnVmKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0ga2Rldl9taW5vcl90b19pOTE1KGtkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7Cj4gICAJaW50ZWxfd2FrZXJl
Zl90IHdha2VyZWY7Cj4gICAJdTMyIGZyZXE7Cj4gICAKPiAtCXdha2VyZWYgPSBpbnRlbF9ydW50
aW1lX3BtX2dldChkZXZfcHJpdik7Cj4gKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQo
aTkxNSk7Cj4gICAKPiAtCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllW
SUVXKGRldl9wcml2KSkgewo+IC0JCXZsdl9wdW5pdF9nZXQoZGV2X3ByaXYpOwo+IC0JCWZyZXEg
PSB2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgUFVOSVRfUkVHX0dQVV9GUkVRX1NUUyk7Cj4gLQkJ
dmx2X3B1bml0X3B1dChkZXZfcHJpdik7Cj4gKwlpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJ
U19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gKwkJdmx2X3B1bml0X2dldChpOTE1KTsKPiArCQlmcmVx
ID0gdmx2X3B1bml0X3JlYWQoaTkxNSwgUFVOSVRfUkVHX0dQVV9GUkVRX1NUUyk7Cj4gKwkJdmx2
X3B1bml0X3B1dChpOTE1KTsKPiAgIAo+ICAgCQlmcmVxID0gKGZyZXEgPj4gOCkgJiAweGZmOwo+
ICAgCX0gZWxzZSB7Cj4gLQkJZnJlcSA9IGludGVsX2dldF9jYWdmKGRldl9wcml2LCBJOTE1X1JF
QUQoR0VONl9SUFNUQVQxKSk7Cj4gKwkJZnJlcSA9IGludGVsX2dldF9jYWdmKGk5MTUsIEk5MTVf
UkVBRChHRU42X1JQU1RBVDEpKTsKPiAgIAl9Cj4gICAKPiAtCWludGVsX3J1bnRpbWVfcG1fcHV0
KGRldl9wcml2LCB3YWtlcmVmKTsKPiArCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2Vy
ZWYpOwo+ICAgCj4gLQlyZXR1cm4gc25wcmludGYoYnVmLCBQQUdFX1NJWkUsICIlZFxuIiwgaW50
ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIGZyZXEpKTsKPiArCXJldHVybiBzbnByaW50ZihidWYsIFBB
R0VfU0laRSwgIiVkXG4iLCBpbnRlbF9ncHVfZnJlcShpOTE1LCBmcmVxKSk7Cj4gICB9Cj4gICAK
PiAgIHN0YXRpYyBzc2l6ZV90IGd0X2N1cl9mcmVxX21oel9zaG93KHN0cnVjdCBkZXZpY2UgKmtk
ZXYsCj4gICAJCQkJICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYp
Cj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBrZGV2X21pbm9y
X3RvX2k5MTUoa2Rldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGtkZXZf
bWlub3JfdG9faTkxNShrZGV2KTsKPiAgIAo+ICAgCXJldHVybiBzbnByaW50ZihidWYsIFBBR0Vf
U0laRSwgIiVkXG4iLAo+IC0JCQlpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwKPiAtCQkJCSAgICAg
ICBkZXZfcHJpdi0+Z3RfcG0ucnBzLmN1cl9mcmVxKSk7Cj4gKwkJCWludGVsX2dwdV9mcmVxKGk5
MTUsCj4gKwkJCQkgICAgICAgaTkxNS0+Z3RfcG0ucnBzLmN1cl9mcmVxKSk7Cj4gICB9Cj4gICAK
PiAgIHN0YXRpYyBzc2l6ZV90IGd0X2Jvb3N0X2ZyZXFfbWh6X3Nob3coc3RydWN0IGRldmljZSAq
a2Rldiwgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGtkZXZfbWlub3JfdG9faTkxNShr
ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0ga2Rldl9taW5vcl90b19p
OTE1KGtkZXYpOwo+ICAgCj4gICAJcmV0dXJuIHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiJWRc
biIsCj4gLQkJCWludGVsX2dwdV9mcmVxKGRldl9wcml2LAo+IC0JCQkJICAgICAgIGRldl9wcml2
LT5ndF9wbS5ycHMuYm9vc3RfZnJlcSkpOwo+ICsJCQlpbnRlbF9ncHVfZnJlcShpOTE1LAo+ICsJ
CQkJICAgICAgIGk5MTUtPmd0X3BtLnJwcy5ib29zdF9mcmVxKSk7Cj4gICB9Cj4gICAKPiAgIHN0
YXRpYyBzc2l6ZV90IGd0X2Jvb3N0X2ZyZXFfbWh6X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmtkZXYs
Cj4gICAJCQkJICAgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAo+ICAgCQkJCSAg
ICAgICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBjb3VudCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGtkZXZfbWlub3JfdG9faTkxNShrZGV2KTsKPiAtCXN0
cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7Cj4gKwlzdHJ1
Y3QgaW50ZWxfcnBzICpycHMgPSAmaTkxNS0+Z3RfcG0ucnBzOwo+ICAgCWJvb2wgYm9vc3QgPSBm
YWxzZTsKPiAgIAlzc2l6ZV90IHJldDsKPiAgIAl1MzIgdmFsOwo+IEBAIC0zMTUsNyArMzE1LDcg
QEAgc3RhdGljIHNzaXplX3QgZ3RfYm9vc3RfZnJlcV9taHpfc3RvcmUoc3RydWN0IGRldmljZSAq
a2RldiwKPiAgIAkJcmV0dXJuIHJldDsKPiAgIAo+ICAgCS8qIFZhbGlkYXRlIGFnYWluc3QgKHN0
YXRpYykgaGFyZHdhcmUgbGltaXRzICovCj4gLQl2YWwgPSBpbnRlbF9mcmVxX29wY29kZShkZXZf
cHJpdiwgdmFsKTsKPiArCXZhbCA9IGludGVsX2ZyZXFfb3Bjb2RlKGk5MTUsIHZhbCk7Cj4gICAJ
aWYgKHZhbCA8IHJwcy0+bWluX2ZyZXEgfHwgdmFsID4gcnBzLT5tYXhfZnJlcSkKPiAgIAkJcmV0
dXJuIC1FSU5WQUw7Cj4gICAKPiBAQCAtMzM0LDI4ICszMzQsMjggQEAgc3RhdGljIHNzaXplX3Qg
Z3RfYm9vc3RfZnJlcV9taHpfc3RvcmUoc3RydWN0IGRldmljZSAqa2RldiwKPiAgIHN0YXRpYyBz
c2l6ZV90IHZsdl9ycGVfZnJlcV9taHpfc2hvdyhzdHJ1Y3QgZGV2aWNlICprZGV2LAo+ICAgCQkJ
CSAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGtkZXZfbWlub3JfdG9faTkxNShr
ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0ga2Rldl9taW5vcl90b19p
OTE1KGtkZXYpOwo+ICAgCj4gICAJcmV0dXJuIHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiJWRc
biIsCj4gLQkJCWludGVsX2dwdV9mcmVxKGRldl9wcml2LAo+IC0JCQkJICAgICAgIGRldl9wcml2
LT5ndF9wbS5ycHMuZWZmaWNpZW50X2ZyZXEpKTsKPiArCQkJaW50ZWxfZ3B1X2ZyZXEoaTkxNSwK
PiArCQkJCSAgICAgICBpOTE1LT5ndF9wbS5ycHMuZWZmaWNpZW50X2ZyZXEpKTsKPiAgIH0KPiAg
IAo+ICAgc3RhdGljIHNzaXplX3QgZ3RfbWF4X2ZyZXFfbWh6X3Nob3coc3RydWN0IGRldmljZSAq
a2Rldiwgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGtkZXZfbWlub3JfdG9faTkxNShr
ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0ga2Rldl9taW5vcl90b19p
OTE1KGtkZXYpOwo+ICAgCj4gICAJcmV0dXJuIHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiJWRc
biIsCj4gLQkJCWludGVsX2dwdV9mcmVxKGRldl9wcml2LAo+IC0JCQkJICAgICAgIGRldl9wcml2
LT5ndF9wbS5ycHMubWF4X2ZyZXFfc29mdGxpbWl0KSk7Cj4gKwkJCWludGVsX2dwdV9mcmVxKGk5
MTUsCj4gKwkJCQkgICAgICAgaTkxNS0+Z3RfcG0ucnBzLm1heF9mcmVxX3NvZnRsaW1pdCkpOwo+
ICAgfQo+ICAgCj4gICBzdGF0aWMgc3NpemVfdCBndF9tYXhfZnJlcV9taHpfc3RvcmUoc3RydWN0
IGRldmljZSAqa2RldiwKPiAgIAkJCQkgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRy
LAo+ICAgCQkJCSAgICAgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgY291bnQpCj4gICB7Cj4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rl
dik7Cj4gLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0ga2Rldl9taW5vcl90b19pOTE1KGtkZXYp
Owo+ICsJc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmk5MTUtPmd0X3BtLnJwczsKPiAgIAlpbnRl
bF93YWtlcmVmX3Qgd2FrZXJlZjsKPiAgIAl1MzIgdmFsOwo+ICAgCXNzaXplX3QgcmV0Owo+IEBA
IC0zNjQsMTAgKzM2NCwxMCBAQCBzdGF0aWMgc3NpemVfdCBndF9tYXhfZnJlcV9taHpfc3RvcmUo
c3RydWN0IGRldmljZSAqa2RldiwKPiAgIAlpZiAocmV0KQo+ICAgCQlyZXR1cm4gcmV0Owo+ICAg
Cj4gLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOwo+ICsJd2FrZXJl
ZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOwo+ICAgCW11dGV4X2xvY2soJnJwcy0+bG9j
ayk7Cj4gICAKPiAtCXZhbCA9IGludGVsX2ZyZXFfb3Bjb2RlKGRldl9wcml2LCB2YWwpOwo+ICsJ
dmFsID0gaW50ZWxfZnJlcV9vcGNvZGUoaTkxNSwgdmFsKTsKPiAgIAlpZiAodmFsIDwgcnBzLT5t
aW5fZnJlcSB8fAo+ICAgCSAgICB2YWwgPiBycHMtPm1heF9mcmVxIHx8Cj4gICAJICAgIHZhbCA8
IHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0KSB7Cj4gQEAgLTM3Nyw3ICszNzcsNyBAQCBzdGF0aWMg
c3NpemVfdCBndF9tYXhfZnJlcV9taHpfc3RvcmUoc3RydWN0IGRldmljZSAqa2RldiwKPiAgIAo+
ICAgCWlmICh2YWwgPiBycHMtPnJwMF9mcmVxKQo+ICAgCQlEUk1fREVCVUcoIlVzZXIgcmVxdWVz
dGVkIG92ZXJjbG9ja2luZyB0byAlZFxuIiwKPiAtCQkJICBpbnRlbF9ncHVfZnJlcShkZXZfcHJp
diwgdmFsKSk7Cj4gKwkJCSAgaW50ZWxfZ3B1X2ZyZXEoaTkxNSwgdmFsKSk7Cj4gICAKPiAgIAly
cHMtPm1heF9mcmVxX3NvZnRsaW1pdCA9IHZhbDsKPiAgIAo+IEBAIC0zODgsMzAgKzM4OCwzMCBA
QCBzdGF0aWMgc3NpemVfdCBndF9tYXhfZnJlcV9taHpfc3RvcmUoc3RydWN0IGRldmljZSAqa2Rl
diwKPiAgIAkvKiBXZSBzdGlsbCBuZWVkICpfc2V0X3JwcyB0byBwcm9jZXNzIHRoZSBuZXcgbWF4
X2RlbGF5IGFuZAo+ICAgCSAqIHVwZGF0ZSB0aGUgaW50ZXJydXB0IGxpbWl0cyBhbmQgUE1JTlRS
TVNLIGV2ZW4gdGhvdWdoCj4gICAJICogZnJlcXVlbmN5IHJlcXVlc3QgbWF5IGJlIHVuY2hhbmdl
ZC4gKi8KPiAtCXJldCA9IGludGVsX3NldF9ycHMoZGV2X3ByaXYsIHZhbCk7Cj4gKwlyZXQgPSBp
bnRlbF9zZXRfcnBzKGk5MTUsIHZhbCk7Cj4gICAKPiAgIHVubG9jazoKPiAgIAltdXRleF91bmxv
Y2soJnJwcy0+bG9jayk7Cj4gLQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJl
Zik7Cj4gKwlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKPiAgIAo+ICAgCXJl
dHVybiByZXQgPzogY291bnQ7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBzc2l6ZV90IGd0X21pbl9m
cmVxX21oel9zaG93KHN0cnVjdCBkZXZpY2UgKmtkZXYsIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRl
ICphdHRyLCBjaGFyICpidWYpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IGtkZXZfbWlub3JfdG9faTkxNShrZGV2KTsKPiAgIAo+ICAgCXJldHVybiBz
bnByaW50ZihidWYsIFBBR0VfU0laRSwgIiVkXG4iLAo+IC0JCQlpbnRlbF9ncHVfZnJlcShkZXZf
cHJpdiwKPiAtCQkJCSAgICAgICBkZXZfcHJpdi0+Z3RfcG0ucnBzLm1pbl9mcmVxX3NvZnRsaW1p
dCkpOwo+ICsJCQlpbnRlbF9ncHVfZnJlcShpOTE1LAo+ICsJCQkJICAgICAgIGk5MTUtPmd0X3Bt
LnJwcy5taW5fZnJlcV9zb2Z0bGltaXQpKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHNzaXplX3Qg
Z3RfbWluX2ZyZXFfbWh6X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmtkZXYsCj4gICAJCQkJICAgICBz
dHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKPiAgIAkJCQkgICAgIGNvbnN0IGNoYXIgKmJ1
Ziwgc2l6ZV90IGNvdW50KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0ga2Rldl9taW5vcl90b19pOTE1KGtkZXYpOwo+IC0Jc3RydWN0IGludGVsX3JwcyAqcnBz
ID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IGtkZXZfbWlub3JfdG9faTkxNShrZGV2KTsKPiArCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9
ICZpOTE1LT5ndF9wbS5ycHM7Cj4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gICAJdTMy
IHZhbDsKPiAgIAlzc2l6ZV90IHJldDsKPiBAQCAtNDIwLDEwICs0MjAsMTAgQEAgc3RhdGljIHNz
aXplX3QgZ3RfbWluX2ZyZXFfbWh6X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmtkZXYsCj4gICAJaWYg
KHJldCkKPiAgIAkJcmV0dXJuIHJldDsKPiAgIAo+IC0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVf
cG1fZ2V0KGRldl9wcml2KTsKPiArCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1
KTsKPiAgIAltdXRleF9sb2NrKCZycHMtPmxvY2spOwo+ICAgCj4gLQl2YWwgPSBpbnRlbF9mcmVx
X29wY29kZShkZXZfcHJpdiwgdmFsKTsKPiArCXZhbCA9IGludGVsX2ZyZXFfb3Bjb2RlKGk5MTUs
IHZhbCk7Cj4gICAJaWYgKHZhbCA8IHJwcy0+bWluX2ZyZXEgfHwKPiAgIAkgICAgdmFsID4gcnBz
LT5tYXhfZnJlcSB8fAo+ICAgCSAgICB2YWwgPiBycHMtPm1heF9mcmVxX3NvZnRsaW1pdCkgewo+
IEBAIC00NDAsMTEgKzQ0MCwxMSBAQCBzdGF0aWMgc3NpemVfdCBndF9taW5fZnJlcV9taHpfc3Rv
cmUoc3RydWN0IGRldmljZSAqa2RldiwKPiAgIAkvKiBXZSBzdGlsbCBuZWVkICpfc2V0X3JwcyB0
byBwcm9jZXNzIHRoZSBuZXcgbWluX2RlbGF5IGFuZAo+ICAgCSAqIHVwZGF0ZSB0aGUgaW50ZXJy
dXB0IGxpbWl0cyBhbmQgUE1JTlRSTVNLIGV2ZW4gdGhvdWdoCj4gICAJICogZnJlcXVlbmN5IHJl
cXVlc3QgbWF5IGJlIHVuY2hhbmdlZC4gKi8KPiAtCXJldCA9IGludGVsX3NldF9ycHMoZGV2X3By
aXYsIHZhbCk7Cj4gKwlyZXQgPSBpbnRlbF9zZXRfcnBzKGk5MTUsIHZhbCk7Cj4gICAKPiAgIHVu
bG9jazoKPiAgIAltdXRleF91bmxvY2soJnJwcy0+bG9jayk7Cj4gLQlpbnRlbF9ydW50aW1lX3Bt
X3B1dChkZXZfcHJpdiwgd2FrZXJlZik7Cj4gKwlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3
YWtlcmVmKTsKPiAgIAo+ICAgCXJldHVybiByZXQgPzogY291bnQ7Cj4gICB9Cj4gQEAgLTQ2NSwx
NiArNDY1LDE2IEBAIHN0YXRpYyBERVZJQ0VfQVRUUihndF9SUG5fZnJlcV9taHosIFNfSVJVR08s
IGd0X3JwX21oel9zaG93LCBOVUxMKTsKPiAgIC8qIEZvciBub3cgd2UgaGF2ZSBhIHN0YXRpYyBu
dW1iZXIgb2YgUlAgc3RhdGVzICovCj4gICBzdGF0aWMgc3NpemVfdCBndF9ycF9taHpfc2hvdyhz
dHJ1Y3QgZGV2aWNlICprZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAq
YnVmKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0ga2Rldl9t
aW5vcl90b19pOTE1KGtkZXYpOwo+IC0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2
LT5ndF9wbS5ycHM7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGtkZXZfbWlu
b3JfdG9faTkxNShrZGV2KTsKPiArCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1LT5ndF9w
bS5ycHM7Cj4gICAJdTMyIHZhbDsKPiAgIAo+ICAgCWlmIChhdHRyID09ICZkZXZfYXR0cl9ndF9S
UDBfZnJlcV9taHopCj4gLQkJdmFsID0gaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+cnAw
X2ZyZXEpOwo+ICsJCXZhbCA9IGludGVsX2dwdV9mcmVxKGk5MTUsIHJwcy0+cnAwX2ZyZXEpOwo+
ICAgCWVsc2UgaWYgKGF0dHIgPT0gJmRldl9hdHRyX2d0X1JQMV9mcmVxX21oeikKPiAtCQl2YWwg
PSBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5ycDFfZnJlcSk7Cj4gKwkJdmFsID0gaW50
ZWxfZ3B1X2ZyZXEoaTkxNSwgcnBzLT5ycDFfZnJlcSk7Cj4gICAJZWxzZSBpZiAoYXR0ciA9PSAm
ZGV2X2F0dHJfZ3RfUlBuX2ZyZXFfbWh6KQo+IC0JCXZhbCA9IGludGVsX2dwdV9mcmVxKGRldl9w
cml2LCBycHMtPm1pbl9mcmVxKTsKPiArCQl2YWwgPSBpbnRlbF9ncHVfZnJlcShpOTE1LCBycHMt
Pm1pbl9mcmVxKTsKPiAgIAllbHNlCj4gICAJCUJVRygpOwo+ICAgCj4gQEAgLTU0MCwxMCArNTQw
LDEwIEBAIHN0YXRpYyBzc2l6ZV90IGVycm9yX3N0YXRlX3dyaXRlKHN0cnVjdCBmaWxlICpmaWxl
LCBzdHJ1Y3Qga29iamVjdCAqa29iaiwKPiAgIAkJCQkgbG9mZl90IG9mZiwgc2l6ZV90IGNvdW50
KQo+ICAgewo+ICAgCXN0cnVjdCBkZXZpY2UgKmtkZXYgPSBrb2JqX3RvX2Rldihrb2JqKTsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGtkZXZfbWlub3JfdG9faTkxNShr
ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0ga2Rldl9taW5vcl90b19p
OTE1KGtkZXYpOwo+ICAgCj4gICAJRFJNX0RFQlVHX0RSSVZFUigiUmVzZXR0aW5nIGVycm9yIHN0
YXRlXG4iKTsKPiAtCWk5MTVfcmVzZXRfZXJyb3Jfc3RhdGUoZGV2X3ByaXYpOwo+ICsJaTkxNV9y
ZXNldF9lcnJvcl9zdGF0ZShpOTE1KTsKPiAgIAo+ICAgCXJldHVybiBjb3VudDsKPiAgIH0KPiBA
QCAtNTcxLDM3ICs1NzEsMzcgQEAgc3RhdGljIHZvaWQgaTkxNV9zZXR1cF9lcnJvcl9jYXB0dXJl
KHN0cnVjdCBkZXZpY2UgKmtkZXYpIHt9Cj4gICBzdGF0aWMgdm9pZCBpOTE1X3RlYXJkb3duX2Vy
cm9yX2NhcHR1cmUoc3RydWN0IGRldmljZSAqa2Rldikge30KPiAgICNlbmRpZgo+ICAgCj4gLXZv
aWQgaTkxNV9zZXR1cF9zeXNmcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
K3ZvaWQgaTkxNV9zZXR1cF9zeXNmcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAg
IHsKPiAtCXN0cnVjdCBkZXZpY2UgKmtkZXYgPSBkZXZfcHJpdi0+ZHJtLnByaW1hcnktPmtkZXY7
Cj4gKwlzdHJ1Y3QgZGV2aWNlICprZGV2ID0gaTkxNS0+ZHJtLnByaW1hcnktPmtkZXY7Cj4gICAJ
aW50IHJldDsKPiAgIAo+ICAgI2lmZGVmIENPTkZJR19QTQo+IC0JaWYgKEhBU19SQzYoZGV2X3By
aXYpKSB7Cj4gKwlpZiAoSEFTX1JDNihpOTE1KSkgewo+ICAgCQlyZXQgPSBzeXNmc19tZXJnZV9n
cm91cCgma2Rldi0+a29iaiwKPiAgIAkJCQkJJnJjNl9hdHRyX2dyb3VwKTsKPiAgIAkJaWYgKHJl
dCkKPiAgIAkJCURSTV9FUlJPUigiUkM2IHJlc2lkZW5jeSBzeXNmcyBzZXR1cCBmYWlsZWRcbiIp
Owo+ICAgCX0KPiAtCWlmIChIQVNfUkM2cChkZXZfcHJpdikpIHsKPiArCWlmIChIQVNfUkM2cChp
OTE1KSkgewo+ICAgCQlyZXQgPSBzeXNmc19tZXJnZV9ncm91cCgma2Rldi0+a29iaiwKPiAgIAkJ
CQkJJnJjNnBfYXR0cl9ncm91cCk7Cj4gICAJCWlmIChyZXQpCj4gICAJCQlEUk1fRVJST1IoIlJD
NnAgcmVzaWRlbmN5IHN5c2ZzIHNldHVwIGZhaWxlZFxuIik7Cj4gICAJfQo+IC0JaWYgKElTX1ZB
TExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gKwlpZiAo
SVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gICAJCXJldCA9
IHN5c2ZzX21lcmdlX2dyb3VwKCZrZGV2LT5rb2JqLAo+ICAgCQkJCQkmbWVkaWFfcmM2X2F0dHJf
Z3JvdXApOwo+ICAgCQlpZiAocmV0KQo+ICAgCQkJRFJNX0VSUk9SKCJNZWRpYSBSQzYgcmVzaWRl
bmN5IHN5c2ZzIHNldHVwIGZhaWxlZFxuIik7Cj4gICAJfQo+ICAgI2VuZGlmCj4gLQlpZiAoSEFT
X0wzX0RQRihkZXZfcHJpdikpIHsKPiArCWlmIChIQVNfTDNfRFBGKGk5MTUpKSB7Cj4gICAJCXJl
dCA9IGRldmljZV9jcmVhdGVfYmluX2ZpbGUoa2RldiwgJmRwZl9hdHRycyk7Cj4gICAJCWlmIChy
ZXQpCj4gICAJCQlEUk1fRVJST1IoImwzIHBhcml0eSBzeXNmcyBzZXR1cCBmYWlsZWRcbiIpOwo+
ICAgCj4gLQkJaWYgKE5VTV9MM19TTElDRVMoZGV2X3ByaXYpID4gMSkgewo+ICsJCWlmIChOVU1f
TDNfU0xJQ0VTKGk5MTUpID4gMSkgewo+ICAgCQkJcmV0ID0gZGV2aWNlX2NyZWF0ZV9iaW5fZmls
ZShrZGV2LAo+ICAgCQkJCQkJICAgICAmZHBmX2F0dHJzXzEpOwo+ICAgCQkJaWYgKHJldCkKPiBA
QCAtNjEwLDkgKzYxMCw5IEBAIHZvaWQgaTkxNV9zZXR1cF9zeXNmcyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJfQo+ICAgCj4gICAJcmV0ID0gMDsKPiAtCWlmIChJU19W
QUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiArCWlmIChJ
U19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gICAJCXJldCA9IHN5
c2ZzX2NyZWF0ZV9maWxlcygma2Rldi0+a29iaiwgdmx2X2F0dHJzKTsKPiAtCWVsc2UgaWYgKElO
VEVMX0dFTihkZXZfcHJpdikgPj0gNikKPiArCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA2
KQo+ICAgCQlyZXQgPSBzeXNmc19jcmVhdGVfZmlsZXMoJmtkZXYtPmtvYmosIGdlbjZfYXR0cnMp
Owo+ICAgCWlmIChyZXQpCj4gICAJCURSTV9FUlJPUigiUlBTIHN5c2ZzIHNldHVwIGZhaWxlZFxu
Iik7Cj4gQEAgLTYyMCwxMyArNjIwLDEzIEBAIHZvaWQgaTkxNV9zZXR1cF9zeXNmcyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJaTkxNV9zZXR1cF9lcnJvcl9jYXB0dXJl
KGtkZXYpOwo+ICAgfQo+ICAgCj4gLXZvaWQgaTkxNV90ZWFyZG93bl9zeXNmcyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgaTkxNV90ZWFyZG93bl9zeXNmcyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVjdCBkZXZpY2UgKmtkZXYg
PSBkZXZfcHJpdi0+ZHJtLnByaW1hcnktPmtkZXY7Cj4gKwlzdHJ1Y3QgZGV2aWNlICprZGV2ID0g
aTkxNS0+ZHJtLnByaW1hcnktPmtkZXY7Cj4gICAKPiAgIAlpOTE1X3RlYXJkb3duX2Vycm9yX2Nh
cHR1cmUoa2Rldik7Cj4gICAKPiAtCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19D
SEVSUllWSUVXKGRldl9wcml2KSkKPiArCWlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NI
RVJSWVZJRVcoaTkxNSkpCj4gICAJCXN5c2ZzX3JlbW92ZV9maWxlcygma2Rldi0+a29iaiwgdmx2
X2F0dHJzKTsKPiAgIAllbHNlCj4gICAJCXN5c2ZzX3JlbW92ZV9maWxlcygma2Rldi0+a29iaiwg
Z2VuNl9hdHRycyk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdHJh
Y2UuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdHJhY2UuaAo+IGluZGV4IDVjOGNmYWE3
MGQ3Mi4uOTU0OGI5ZmU0MTk5IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfdHJhY2UuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdHJhY2UuaAo+IEBA
IC0yMSw4ICsyMSw4IEBACj4gICAvKiB3YXRlcm1hcmsvZmlmbyB1cGRhdGVzICovCj4gICAKPiAg
IFRSQUNFX0VWRU5UKGludGVsX3BpcGVfZW5hYmxlLAo+IC0JICAgIFRQX1BST1RPKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUpLAo+IC0JICAgIFRQX0FS
R1MoZGV2X3ByaXYsIHBpcGUpLAo+ICsJICAgIFRQX1BST1RPKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LCBlbnVtIHBpcGUgcGlwZSksCj4gKwkgICAgVFBfQVJHUyhpOTE1LCBwaXBlKSwK
PiAgIAo+ICAgCSAgICBUUF9TVFJVQ1RfX2VudHJ5KAo+ICAgCQkJICAgICBfX2FycmF5KHUzMiwg
ZnJhbWUsIDMpCj4gQEAgLTMyLDExICszMiwxMSBAQCBUUkFDRV9FVkVOVChpbnRlbF9waXBlX2Vu
YWJsZSwKPiAgIAo+ICAgCSAgICBUUF9mYXN0X2Fzc2lnbigKPiAgIAkJCSAgIGVudW0gcGlwZSBf
cGlwZTsKPiAtCQkJICAgZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgX3BpcGUpIHsKPiArCQkJICAg
Zm9yX2VhY2hfcGlwZShpOTE1LCBfcGlwZSkgewo+ICAgCQkJCSAgIF9fZW50cnktPmZyYW1lW19w
aXBlXSA9Cj4gLQkJCQkJICAgZGV2X3ByaXYtPmRybS5kcml2ZXItPmdldF92YmxhbmtfY291bnRl
cigmZGV2X3ByaXYtPmRybSwgX3BpcGUpOwo+ICsJCQkJCSAgIGk5MTUtPmRybS5kcml2ZXItPmdl
dF92YmxhbmtfY291bnRlcigmaTkxNS0+ZHJtLCBfcGlwZSk7Cj4gICAJCQkJICAgX19lbnRyeS0+
c2NhbmxpbmVbX3BpcGVdID0KPiAtCQkJCQkgICBpbnRlbF9nZXRfY3J0Y19zY2FubGluZShpbnRl
bF9nZXRfY3J0Y19mb3JfcGlwZShkZXZfcHJpdiwgX3BpcGUpKTsKPiArCQkJCQkgICBpbnRlbF9n
ZXRfY3J0Y19zY2FubGluZShpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShpOTE1LCBfcGlwZSkpOwo+
ICAgCQkJICAgfQo+ICAgCQkJICAgX19lbnRyeS0+cGlwZSA9IHBpcGU7Cj4gICAJCQkgICApLAo+
IEBAIC00OSw4ICs0OSw4IEBAIFRSQUNFX0VWRU5UKGludGVsX3BpcGVfZW5hYmxlLAo+ICAgKTsK
PiAgIAo+ICAgVFJBQ0VfRVZFTlQoaW50ZWxfcGlwZV9kaXNhYmxlLAo+IC0JICAgIFRQX1BST1RP
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUpLAo+IC0J
ICAgIFRQX0FSR1MoZGV2X3ByaXYsIHBpcGUpLAo+ICsJICAgIFRQX1BST1RPKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBpcGUgcGlwZSksCj4gKwkgICAgVFBfQVJHUyhpOTE1
LCBwaXBlKSwKPiAgIAo+ICAgCSAgICBUUF9TVFJVQ1RfX2VudHJ5KAo+ICAgCQkJICAgICBfX2Fy
cmF5KHUzMiwgZnJhbWUsIDMpCj4gQEAgLTYwLDExICs2MCwxMSBAQCBUUkFDRV9FVkVOVChpbnRl
bF9waXBlX2Rpc2FibGUsCj4gICAKPiAgIAkgICAgVFBfZmFzdF9hc3NpZ24oCj4gICAJCQkgICBl
bnVtIHBpcGUgX3BpcGU7Cj4gLQkJCSAgIGZvcl9lYWNoX3BpcGUoZGV2X3ByaXYsIF9waXBlKSB7
Cj4gKwkJCSAgIGZvcl9lYWNoX3BpcGUoaTkxNSwgX3BpcGUpIHsKPiAgIAkJCQkgICBfX2VudHJ5
LT5mcmFtZVtfcGlwZV0gPQo+IC0JCQkJCSAgIGRldl9wcml2LT5kcm0uZHJpdmVyLT5nZXRfdmJs
YW5rX2NvdW50ZXIoJmRldl9wcml2LT5kcm0sIF9waXBlKTsKPiArCQkJCQkgICBpOTE1LT5kcm0u
ZHJpdmVyLT5nZXRfdmJsYW5rX2NvdW50ZXIoJmk5MTUtPmRybSwgX3BpcGUpOwo+ICAgCQkJCSAg
IF9fZW50cnktPnNjYW5saW5lW19waXBlXSA9Cj4gLQkJCQkJICAgaW50ZWxfZ2V0X2NydGNfc2Nh
bmxpbmUoaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIF9waXBlKSk7Cj4gKwkJCQkJ
ICAgaW50ZWxfZ2V0X2NydGNfc2NhbmxpbmUoaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoaTkxNSwg
X3BpcGUpKTsKPiAgIAkJCSAgIH0KPiAgIAkJCSAgIF9fZW50cnktPnBpcGUgPSBwaXBlOwo+ICAg
CQkJICAgKSwKPiBAQCAtMTAyLDggKzEwMiw4IEBAIFRSQUNFX0VWRU5UKGludGVsX3BpcGVfY3Jj
LAo+ICAgKTsKPiAgIAo+ICAgVFJBQ0VfRVZFTlQoaW50ZWxfY3B1X2ZpZm9fdW5kZXJydW4sCj4g
LQkgICAgVFBfUFJPVE8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBp
cGUgcGlwZSksCj4gLQkgICAgVFBfQVJHUyhkZXZfcHJpdiwgcGlwZSksCj4gKwkgICAgVFBfUFJP
VE8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gcGlwZSBwaXBlKSwKPiArCSAg
ICBUUF9BUkdTKGk5MTUsIHBpcGUpLAo+ICAgCj4gICAJICAgIFRQX1NUUlVDVF9fZW50cnkoCj4g
ICAJCQkgICAgIF9fZmllbGQoZW51bSBwaXBlLCBwaXBlKQo+IEBAIC0xMTMsOCArMTEzLDggQEAg
VFJBQ0VfRVZFTlQoaW50ZWxfY3B1X2ZpZm9fdW5kZXJydW4sCj4gICAKPiAgIAkgICAgVFBfZmFz
dF9hc3NpZ24oCj4gICAJCQkgICBfX2VudHJ5LT5waXBlID0gcGlwZTsKPiAtCQkJICAgX19lbnRy
eS0+ZnJhbWUgPSBkZXZfcHJpdi0+ZHJtLmRyaXZlci0+Z2V0X3ZibGFua19jb3VudGVyKCZkZXZf
cHJpdi0+ZHJtLCBwaXBlKTsKPiAtCQkJICAgX19lbnRyeS0+c2NhbmxpbmUgPSBpbnRlbF9nZXRf
Y3J0Y19zY2FubGluZShpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShkZXZfcHJpdiwgcGlwZSkpOwo+
ICsJCQkgICBfX2VudHJ5LT5mcmFtZSA9IGk5MTUtPmRybS5kcml2ZXItPmdldF92YmxhbmtfY291
bnRlcigmaTkxNS0+ZHJtLCBwaXBlKTsKPiArCQkJICAgX19lbnRyeS0+c2NhbmxpbmUgPSBpbnRl
bF9nZXRfY3J0Y19zY2FubGluZShpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShpOTE1LCBwaXBlKSk7
Cj4gICAJCQkgICApLAo+ICAgCj4gICAJICAgIFRQX3ByaW50aygicGlwZSAlYywgZnJhbWU9JXUs
IHNjYW5saW5lPSV1IiwKPiBAQCAtMTIzLDggKzEyMyw4IEBAIFRSQUNFX0VWRU5UKGludGVsX2Nw
dV9maWZvX3VuZGVycnVuLAo+ICAgKTsKPiAgIAo+ICAgVFJBQ0VfRVZFTlQoaW50ZWxfcGNoX2Zp
Zm9fdW5kZXJydW4sCj4gLQkgICAgVFBfUFJPVE8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LCBlbnVtIHBpcGUgcGNoX3RyYW5zY29kZXIpLAo+IC0JICAgIFRQX0FSR1MoZGV2X3By
aXYsIHBjaF90cmFuc2NvZGVyKSwKPiArCSAgICBUUF9QUk9UTyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwgZW51bSBwaXBlIHBjaF90cmFuc2NvZGVyKSwKPiArCSAgICBUUF9BUkdTKGk5
MTUsIHBjaF90cmFuc2NvZGVyKSwKPiAgIAo+ICAgCSAgICBUUF9TVFJVQ1RfX2VudHJ5KAo+ICAg
CQkJICAgICBfX2ZpZWxkKGVudW0gcGlwZSwgcGlwZSkKPiBAQCAtMTM1LDggKzEzNSw4IEBAIFRS
QUNFX0VWRU5UKGludGVsX3BjaF9maWZvX3VuZGVycnVuLAo+ICAgCSAgICBUUF9mYXN0X2Fzc2ln
bigKPiAgIAkJCSAgIGVudW0gcGlwZSBwaXBlID0gcGNoX3RyYW5zY29kZXI7Cj4gICAJCQkgICBf
X2VudHJ5LT5waXBlID0gcGlwZTsKPiAtCQkJICAgX19lbnRyeS0+ZnJhbWUgPSBkZXZfcHJpdi0+
ZHJtLmRyaXZlci0+Z2V0X3ZibGFua19jb3VudGVyKCZkZXZfcHJpdi0+ZHJtLCBwaXBlKTsKPiAt
CQkJICAgX19lbnRyeS0+c2NhbmxpbmUgPSBpbnRlbF9nZXRfY3J0Y19zY2FubGluZShpbnRlbF9n
ZXRfY3J0Y19mb3JfcGlwZShkZXZfcHJpdiwgcGlwZSkpOwo+ICsJCQkgICBfX2VudHJ5LT5mcmFt
ZSA9IGk5MTUtPmRybS5kcml2ZXItPmdldF92YmxhbmtfY291bnRlcigmaTkxNS0+ZHJtLCBwaXBl
KTsKPiArCQkJICAgX19lbnRyeS0+c2NhbmxpbmUgPSBpbnRlbF9nZXRfY3J0Y19zY2FubGluZShp
bnRlbF9nZXRfY3J0Y19mb3JfcGlwZShpOTE1LCBwaXBlKSk7Cj4gICAJCQkgICApLAo+ICAgCj4g
ICAJICAgIFRQX3ByaW50aygicGNoIHRyYW5zY29kZXIgJWMsIGZyYW1lPSV1LCBzY2FubGluZT0l
dSIsCj4gQEAgLTE0NSw4ICsxNDUsOCBAQCBUUkFDRV9FVkVOVChpbnRlbF9wY2hfZmlmb191bmRl
cnJ1biwKPiAgICk7Cj4gICAKPiAgIFRSQUNFX0VWRU5UKGludGVsX21lbW9yeV9jeHNyLAo+IC0J
ICAgIFRQX1BST1RPKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgYm9vbCBvbGQs
IGJvb2wgbmV3KSwKPiAtCSAgICBUUF9BUkdTKGRldl9wcml2LCBvbGQsIG5ldyksCj4gKwkgICAg
VFBfUFJPVE8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGJvb2wgb2xkLCBib29sIG5l
dyksCj4gKwkgICAgVFBfQVJHUyhpOTE1LCBvbGQsIG5ldyksCj4gICAKPiAgIAkgICAgVFBfU1RS
VUNUX19lbnRyeSgKPiAgIAkJCSAgICAgX19hcnJheSh1MzIsIGZyYW1lLCAzKQo+IEBAIC0xNTcs
MTEgKzE1NywxMSBAQCBUUkFDRV9FVkVOVChpbnRlbF9tZW1vcnlfY3hzciwKPiAgIAo+ICAgCSAg
ICBUUF9mYXN0X2Fzc2lnbigKPiAgIAkJCSAgIGVudW0gcGlwZSBwaXBlOwo+IC0JCQkgICBmb3Jf
ZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKSB7Cj4gKwkJCSAgIGZvcl9lYWNoX3BpcGUoaTkxNSwg
cGlwZSkgewo+ICAgCQkJCSAgIF9fZW50cnktPmZyYW1lW3BpcGVdID0KPiAtCQkJCQkgICBkZXZf
cHJpdi0+ZHJtLmRyaXZlci0+Z2V0X3ZibGFua19jb3VudGVyKCZkZXZfcHJpdi0+ZHJtLCBwaXBl
KTsKPiArCQkJCQkgICBpOTE1LT5kcm0uZHJpdmVyLT5nZXRfdmJsYW5rX2NvdW50ZXIoJmk5MTUt
PmRybSwgcGlwZSk7Cj4gICAJCQkJICAgX19lbnRyeS0+c2NhbmxpbmVbcGlwZV0gPQo+IC0JCQkJ
CSAgIGludGVsX2dldF9jcnRjX3NjYW5saW5lKGludGVsX2dldF9jcnRjX2Zvcl9waXBlKGRldl9w
cml2LCBwaXBlKSk7Cj4gKwkJCQkJICAgaW50ZWxfZ2V0X2NydGNfc2NhbmxpbmUoaW50ZWxfZ2V0
X2NydGNfZm9yX3BpcGUoaTkxNSwgcGlwZSkpOwo+ICAgCQkJICAgfQo+ICAgCQkJICAgX19lbnRy
eS0+b2xkID0gb2xkOwo+ICAgCQkJICAgX19lbnRyeS0+bmV3ID0gbmV3Owo+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZncHUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfdmdwdS5jCj4gaW5kZXggOTRkMzk5MmI1OTlkLi45Njg3NGE0ODE5YTkgMTAwNjQ0Cj4g
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92Z3B1LmMKPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3ZncHUuYwo+IEBAIC01MywxNCArNTMsMTQgQEAKPiAgIAo+ICAgLyoq
Cj4gICAgKiBpOTE1X2NoZWNrX3ZncHUgLSBkZXRlY3QgdmlydHVhbCBHUFUKPiAtICogQGRldl9w
cml2OiBpOTE1IGRldmljZSBwcml2YXRlCj4gKyAqIEBpOTE1OiBpOTE1IGRldmljZSBwcml2YXRl
Cj4gICAgKgo+ICAgICogVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgYXQgdGhlIGluaXRpYWxpemF0
aW9uIHN0YWdlLCB0byBkZXRlY3Qgd2hldGhlcgo+ICAgICogcnVubmluZyBvbiBhIHZHUFUuCj4g
ICAgKi8KPiAtdm9pZCBpOTE1X2NoZWNrX3ZncHUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ICt2b2lkIGk5MTVfY2hlY2tfdmdwdShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiAgIHsKPiAtCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+
dW5jb3JlOwo+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsK
PiAgIAl1NjQgbWFnaWM7Cj4gICAJdTE2IHZlcnNpb25fbWFqb3I7Cj4gICAKPiBAQCAtNzYsMTUg
Kzc2LDE1IEBAIHZvaWQgaTkxNV9jaGVja192Z3B1KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiAgIAkJcmV0dXJuOwo+ICAgCX0KPiAgIAo+IC0JZGV2X3ByaXYtPnZncHUuY2Fw
cyA9IF9fcmF3X3VuY29yZV9yZWFkMzIodW5jb3JlLCB2Z3RpZl9yZWcodmd0X2NhcHMpKTsKPiAr
CWk5MTUtPnZncHUuY2FwcyA9IF9fcmF3X3VuY29yZV9yZWFkMzIodW5jb3JlLCB2Z3RpZl9yZWco
dmd0X2NhcHMpKTsKPiAgIAo+IC0JZGV2X3ByaXYtPnZncHUuYWN0aXZlID0gdHJ1ZTsKPiArCWk5
MTUtPnZncHUuYWN0aXZlID0gdHJ1ZTsKPiAgIAlEUk1fSU5GTygiVmlydHVhbCBHUFUgZm9yIElu
dGVsIEdWVC1nIGRldGVjdGVkLlxuIik7Cj4gICB9Cj4gICAKPiAtYm9vbCBpbnRlbF92Z3B1X2hh
c19mdWxsX3BwZ3R0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArYm9vbCBp
bnRlbF92Z3B1X2hhc19mdWxsX3BwZ3R0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ICAgewo+IC0JcmV0dXJuIGRldl9wcml2LT52Z3B1LmNhcHMgJiBWR1RfQ0FQU19GVUxMX1BQR1RU
Owo+ICsJcmV0dXJuIGk5MTUtPnZncHUuY2FwcyAmIFZHVF9DQVBTX0ZVTExfUFBHVFQ7Cj4gICB9
Cj4gICAKPiAgIHN0cnVjdCBfYmFsbG9vbl9pbmZvXyB7Cj4gQEAgLTExMiwyMiArMTEyLDIyIEBA
IHN0YXRpYyB2b2lkIHZndF9kZWJhbGxvb25fc3BhY2Uoc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCwK
PiAgIAo+ICAgLyoqCj4gICAgKiBpbnRlbF92Z3RfZGViYWxsb29uIC0gZGViYWxsb29uIHJlc2Vy
dmVkIGdyYXBoaWNzIGFkZHJlc3MgdHJ1bmtzCj4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2Ug
cHJpdmF0ZSBkYXRhCj4gKyAqIEBpOTE1OiBpOTE1IGRldmljZSBwcml2YXRlIGRhdGEKPiAgICAq
Cj4gICAgKiBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCB0byBkZWFsbG9jYXRlIHRoZSBiYWxsb29u
ZWQtb3V0IGdyYXBoaWMgbWVtb3J5LCB3aGVuCj4gICAgKiBkcml2ZXIgaXMgdW5sb2FkZWQgb3Ig
d2hlbiBiYWxsb29uaW5nIGZhaWxzLgo+ICAgICovCj4gLXZvaWQgaW50ZWxfdmd0X2RlYmFsbG9v
bihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgaW50ZWxfdmd0X2Rl
YmFsbG9vbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAlpbnQgaTsK
PiAgIAo+IC0JaWYgKCFpbnRlbF92Z3B1X2FjdGl2ZShkZXZfcHJpdikpCj4gKwlpZiAoIWludGVs
X3ZncHVfYWN0aXZlKGk5MTUpKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAlEUk1fREVCVUcoIlZH
VCBkZWJhbGxvb24uXG4iKTsKPiAgIAo+ICAgCWZvciAoaSA9IDA7IGkgPCA0OyBpKyspCj4gLQkJ
dmd0X2RlYmFsbG9vbl9zcGFjZSgmZGV2X3ByaXYtPmdndHQsICZibF9pbmZvLnNwYWNlW2ldKTsK
PiArCQl2Z3RfZGViYWxsb29uX3NwYWNlKCZpOTE1LT5nZ3R0LCAmYmxfaW5mby5zcGFjZVtpXSk7
Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQgdmd0X2JhbGxvb25fc3BhY2Uoc3RydWN0IGk5MTVf
Z2d0dCAqZ2d0dCwKPiBAQCAtMTUzLDcgKzE1Myw3IEBAIHN0YXRpYyBpbnQgdmd0X2JhbGxvb25f
c3BhY2Uoc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCwKPiAgIAo+ICAgLyoqCj4gICAgKiBpbnRlbF92
Z3RfYmFsbG9vbiAtIGJhbGxvb24gb3V0IHJlc2VydmVkIGdyYXBoaWNzIGFkZHJlc3MgdHJ1bmtz
Cj4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgcHJpdmF0ZSBkYXRhCj4gKyAqIEBpOTE1OiBp
OTE1IGRldmljZSBwcml2YXRlIGRhdGEKPiAgICAqCj4gICAgKiBUaGlzIGZ1bmN0aW9uIGlzIGNh
bGxlZCBhdCB0aGUgaW5pdGlhbGl6YXRpb24gc3RhZ2UsIHRvIGJhbGxvb24gb3V0IHRoZQo+ICAg
ICogZ3JhcGhpYyBhZGRyZXNzIHNwYWNlIGFsbG9jYXRlZCB0byBvdGhlciB2R1BVcywgYnkgbWFy
a2luZyB0aGVzZSBzcGFjZXMgYXMKPiBAQCAtMTk1LDE2ICsxOTUsMTYgQEAgc3RhdGljIGludCB2
Z3RfYmFsbG9vbl9zcGFjZShzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0LAo+ICAgICogUmV0dXJuczoK
PiAgICAqIHplcm8gb24gc3VjY2Vzcywgbm9uLXplcm8gaWYgY29uZmlndXJhdGlvbiBpbnZhbGlk
IG9yIGJhbGxvb25pbmcgZmFpbGVkCj4gICAgKi8KPiAtaW50IGludGVsX3ZndF9iYWxsb29uKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAraW50IGludGVsX3ZndF9iYWxsb29u
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RydWN0IGk5MTVfZ2d0
dCAqZ2d0dCA9ICZkZXZfcHJpdi0+Z2d0dDsKPiArCXN0cnVjdCBpOTE1X2dndHQgKmdndHQgPSAm
aTkxNS0+Z2d0dDsKPiAgIAl1bnNpZ25lZCBsb25nIGdndHRfZW5kID0gZ2d0dC0+dm0udG90YWw7
Cj4gICAKPiAgIAl1bnNpZ25lZCBsb25nIG1hcHBhYmxlX2Jhc2UsIG1hcHBhYmxlX3NpemUsIG1h
cHBhYmxlX2VuZDsKPiAgIAl1bnNpZ25lZCBsb25nIHVubWFwcGFibGVfYmFzZSwgdW5tYXBwYWJs
ZV9zaXplLCB1bm1hcHBhYmxlX2VuZDsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gLQlpZiAoIWludGVs
X3ZncHVfYWN0aXZlKGRldl9wcml2KSkKPiArCWlmICghaW50ZWxfdmdwdV9hY3RpdmUoaTkxNSkp
Cj4gICAJCXJldHVybiAwOwo+ICAgCj4gICAJbWFwcGFibGVfYmFzZSA9IEk5MTVfUkVBRCh2Z3Rp
Zl9yZWcoYXZhaWxfcnMubWFwcGFibGVfZ21hZHIuYmFzZSkpOwo+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZncHUuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
dmdwdS5oCj4gaW5kZXggZWJlMWI3YmNlZDk4Li4wZmEwYmZiODhiZWQgMTAwNjQ0Cj4gLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92Z3B1LmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3ZncHUuaAo+IEBAIC0yNiwyMyArMjYsMjMgQEAKPiAgIAo+ICAgI2luY2x1ZGUg
Imk5MTVfcHZpbmZvLmgiCj4gICAKPiAtdm9pZCBpOTE1X2NoZWNrX3ZncHUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiArdm9pZCBpOTE1X2NoZWNrX3ZncHUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgCj4gLWJvb2wgaW50ZWxfdmdwdV9oYXNfZnVsbF9w
cGd0dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ICtib29sIGludGVsX3Zn
cHVfaGFzX2Z1bGxfcHBndHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgCj4g
ICBzdGF0aWMgaW5saW5lIGJvb2wKPiAtaW50ZWxfdmdwdV9oYXNfaHdzcF9lbXVsYXRpb24oc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtpbnRlbF92Z3B1X2hhc19od3NwX2Vt
dWxhdGlvbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXJldHVybiBk
ZXZfcHJpdi0+dmdwdS5jYXBzICYgVkdUX0NBUFNfSFdTUF9FTVVMQVRJT047Cj4gKwlyZXR1cm4g
aTkxNS0+dmdwdS5jYXBzICYgVkdUX0NBUFNfSFdTUF9FTVVMQVRJT047Cj4gICB9Cj4gICAKPiAg
IHN0YXRpYyBpbmxpbmUgYm9vbAo+IC1pbnRlbF92Z3B1X2hhc19odWdlX2d0dChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK2ludGVsX3ZncHVfaGFzX2h1Z2VfZ3R0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JcmV0dXJuIGRldl9wcml2LT52Z3B1
LmNhcHMgJiBWR1RfQ0FQU19IVUdFX0dUVDsKPiArCXJldHVybiBpOTE1LT52Z3B1LmNhcHMgJiBW
R1RfQ0FQU19IVUdFX0dUVDsKPiAgIH0KPiAgIAo+IC1pbnQgaW50ZWxfdmd0X2JhbGxvb24oc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtdm9pZCBpbnRlbF92Z3RfZGViYWxs
b29uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gK2ludCBpbnRlbF92Z3Rf
YmFsbG9vbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgaW50ZWxfdmd0
X2RlYmFsbG9vbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICAKPiAgICNlbmRp
ZiAvKiBfSTkxNV9WR1BVX0hfICovCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfdm1hLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCj4gaW5kZXggY2Iz
NDFlNGFjZjk5Li5lM2Y0ZDcwMDZhMWIgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV92bWEuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMKPiBA
QCAtNTU1LDcgKzU1NSw3IEBAIHN0YXRpYyB2b2lkIGFzc2VydF9iaW5kX2NvdW50KGNvbnN0IHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCj4gICBzdGF0aWMgaW50Cj4gICBpOTE1X3Zt
YV9pbnNlcnQoc3RydWN0IGk5MTVfdm1hICp2bWEsIHU2NCBzaXplLCB1NjQgYWxpZ25tZW50LCB1
NjQgZmxhZ3MpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2
bWEtPnZtLT5pOTE1Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2bWEtPnZt
LT5pOTE1Owo+ICAgCXVuc2lnbmVkIGludCBjYWNoZV9sZXZlbDsKPiAgIAl1NjQgc3RhcnQsIGVu
ZDsKPiAgIAlpbnQgcmV0Owo+IEBAIC01ODEsNyArNTgxLDcgQEAgaTkxNV92bWFfaW5zZXJ0KHN0
cnVjdCBpOTE1X3ZtYSAqdm1hLCB1NjQgc2l6ZSwgdTY0IGFsaWdubWVudCwgdTY0IGZsYWdzKQo+
ICAgCj4gICAJZW5kID0gdm1hLT52bS0+dG90YWw7Cj4gICAJaWYgKGZsYWdzICYgUElOX01BUFBB
QkxFKQo+IC0JCWVuZCA9IG1pbl90KHU2NCwgZW5kLCBkZXZfcHJpdi0+Z2d0dC5tYXBwYWJsZV9l
bmQpOwo+ICsJCWVuZCA9IG1pbl90KHU2NCwgZW5kLCBpOTE1LT5nZ3R0Lm1hcHBhYmxlX2VuZCk7
Cj4gICAJaWYgKGZsYWdzICYgUElOX1pPTkVfNEcpCj4gICAJCWVuZCA9IG1pbl90KHU2NCwgZW5k
LCAoMVVMTCA8PCAzMikgLSBJOTE1X0dUVF9QQUdFX1NJWkUpOwo+ICAgCUdFTV9CVUdfT04oIUlT
X0FMSUdORUQoZW5kLCBJOTE1X0dUVF9QQUdFX1NJWkUpKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaWNsX2RzaS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaWNsX2RzaS5j
Cj4gaW5kZXggNzQ0NDhlNmJmNzQ5Li5kMDE5MmUwOTNmNmYgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaWNsX2RzaS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaWNs
X2RzaS5jCj4gQEAgLTM1LDMyICszNSwzMiBAQAo+ICAgI2luY2x1ZGUgImludGVsX2RzaS5oIgo+
ICAgI2luY2x1ZGUgImludGVsX3BhbmVsLmgiCj4gICAKPiAtc3RhdGljIGlubGluZSBpbnQgaGVh
ZGVyX2NyZWRpdHNfYXZhaWxhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiArc3RhdGljIGlubGluZSBpbnQgaGVhZGVyX2NyZWRpdHNfYXZhaWxhYmxlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCQkgICBlbnVtIHRyYW5zY29kZXIgZHNpX3RyYW5z
KQo+ICAgewo+ICAgCXJldHVybiAoSTkxNV9SRUFEKERTSV9DTURfVFhDVEwoZHNpX3RyYW5zKSkg
JiBGUkVFX0hFQURFUl9DUkVESVRfTUFTSykKPiAgIAkJPj4gRlJFRV9IRUFERVJfQ1JFRElUX1NI
SUZUOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBpbmxpbmUgaW50IHBheWxvYWRfY3JlZGl0c19hdmFp
bGFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgaW5saW5l
IGludCBwYXlsb2FkX2NyZWRpdHNfYXZhaWxhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ICAgCQkJCQkgICAgZW51bSB0cmFuc2NvZGVyIGRzaV90cmFucykKPiAgIHsKPiAgIAly
ZXR1cm4gKEk5MTVfUkVBRChEU0lfQ01EX1RYQ1RMKGRzaV90cmFucykpICYgRlJFRV9QTE9BRF9D
UkVESVRfTUFTSykKPiAgIAkJPj4gRlJFRV9QTE9BRF9DUkVESVRfU0hJRlQ7Cj4gICB9Cj4gICAK
PiAtc3RhdGljIHZvaWQgd2FpdF9mb3JfaGVhZGVyX2NyZWRpdHMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCB3YWl0X2Zvcl9oZWFkZXJfY3JlZGl0cyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAgZW51bSB0cmFuc2NvZGVy
IGRzaV90cmFucykKPiAgIHsKPiAtCWlmICh3YWl0X2Zvcl91cyhoZWFkZXJfY3JlZGl0c19hdmFp
bGFibGUoZGV2X3ByaXYsIGRzaV90cmFucykgPj0KPiArCWlmICh3YWl0X2Zvcl91cyhoZWFkZXJf
Y3JlZGl0c19hdmFpbGFibGUoaTkxNSwgZHNpX3RyYW5zKSA+PQo+ICAgCQkJTUFYX0hFQURFUl9D
UkVESVQsIDEwMCkpCj4gICAJCURSTV9FUlJPUigiRFNJIGhlYWRlciBjcmVkaXRzIG5vdCByZWxl
YXNlZFxuIik7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgd2FpdF9mb3JfcGF5bG9hZF9jcmVk
aXRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgd2Fp
dF9mb3JfcGF5bG9hZF9jcmVkaXRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAg
CQkJCSAgICAgZW51bSB0cmFuc2NvZGVyIGRzaV90cmFucykKPiAgIHsKPiAtCWlmICh3YWl0X2Zv
cl91cyhwYXlsb2FkX2NyZWRpdHNfYXZhaWxhYmxlKGRldl9wcml2LCBkc2lfdHJhbnMpID49Cj4g
KwlpZiAod2FpdF9mb3JfdXMocGF5bG9hZF9jcmVkaXRzX2F2YWlsYWJsZShpOTE1LCBkc2lfdHJh
bnMpID49Cj4gICAJCQlNQVhfUExPQURfQ1JFRElULCAxMDApKQo+ICAgCQlEUk1fRVJST1IoIkRT
SSBwYXlsb2FkIGNyZWRpdHMgbm90IHJlbGVhc2VkXG4iKTsKPiAgIH0KPiBAQCAtNzUsNyArNzUs
NyBAQCBzdGF0aWMgZW51bSB0cmFuc2NvZGVyIGRzaV9wb3J0X3RvX3RyYW5zY29kZXIoZW51bSBw
b3J0IHBvcnQpCj4gICAKPiAgIHN0YXRpYyB2b2lkIHdhaXRfZm9yX2NtZHNfZGlzcGF0Y2hlZF90
b19wYW5lbChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIHsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2Uu
ZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBlbmNfdG9faW50ZWxfZHNp
KCZlbmNvZGVyLT5iYXNlKTsKPiAgIAlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2k7Cj4gICAJ
ZW51bSBwb3J0IHBvcnQ7Cj4gQEAgLTg1LDggKzg1LDggQEAgc3RhdGljIHZvaWQgd2FpdF9mb3Jf
Y21kc19kaXNwYXRjaGVkX3RvX3BhbmVsKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+
ICAgCS8qIHdhaXQgZm9yIGhlYWRlci9wYXlsb2FkIGNyZWRpdHMgdG8gYmUgcmVsZWFzZWQgKi8K
PiAgIAlmb3JfZWFjaF9kc2lfcG9ydChwb3J0LCBpbnRlbF9kc2ktPnBvcnRzKSB7Cj4gICAJCWRz
aV90cmFucyA9IGRzaV9wb3J0X3RvX3RyYW5zY29kZXIocG9ydCk7Cj4gLQkJd2FpdF9mb3JfaGVh
ZGVyX2NyZWRpdHMoZGV2X3ByaXYsIGRzaV90cmFucyk7Cj4gLQkJd2FpdF9mb3JfcGF5bG9hZF9j
cmVkaXRzKGRldl9wcml2LCBkc2lfdHJhbnMpOwo+ICsJCXdhaXRfZm9yX2hlYWRlcl9jcmVkaXRz
KGk5MTUsIGRzaV90cmFucyk7Cj4gKwkJd2FpdF9mb3JfcGF5bG9hZF9jcmVkaXRzKGk5MTUsIGRz
aV90cmFucyk7Cj4gICAJfQo+ICAgCj4gICAJLyogc2VuZCBub3AgRENTIGNvbW1hbmQgKi8KPiBA
QCAtMTAyLDcgKzEwMiw3IEBAIHN0YXRpYyB2b2lkIHdhaXRfZm9yX2NtZHNfZGlzcGF0Y2hlZF90
b19wYW5lbChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIAkvKiB3YWl0IGZvciBo
ZWFkZXIgY3JlZGl0cyB0byBiZSByZWxlYXNlZCAqLwo+ICAgCWZvcl9lYWNoX2RzaV9wb3J0KHBv
cnQsIGludGVsX2RzaS0+cG9ydHMpIHsKPiAgIAkJZHNpX3RyYW5zID0gZHNpX3BvcnRfdG9fdHJh
bnNjb2Rlcihwb3J0KTsKPiAtCQl3YWl0X2Zvcl9oZWFkZXJfY3JlZGl0cyhkZXZfcHJpdiwgZHNp
X3RyYW5zKTsKPiArCQl3YWl0X2Zvcl9oZWFkZXJfY3JlZGl0cyhpOTE1LCBkc2lfdHJhbnMpOwo+
ICAgCX0KPiAgIAo+ICAgCS8qIHdhaXQgZm9yIExQIFRYIGluIHByb2dyZXNzIGJpdCB0byBiZSBj
bGVhcmVkICovCj4gQEAgLTExOCw3ICsxMTgsNyBAQCBzdGF0aWMgYm9vbCBhZGRfcGF5bGRfdG9f
cXVldWUoc3RydWN0IGludGVsX2RzaV9ob3N0ICpob3N0LCBjb25zdCB1OCAqZGF0YSwKPiAgIAkJ
CSAgICAgICB1MzIgbGVuKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9
IGhvc3QtPmludGVsX2RzaTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoaW50ZWxfZHNpLT5iYXNlLmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShpbnRlbF9kc2ktPmJhc2UuYmFzZS5kZXYpOwo+ICAgCWVu
dW0gdHJhbnNjb2RlciBkc2lfdHJhbnMgPSBkc2lfcG9ydF90b190cmFuc2NvZGVyKGhvc3QtPnBv
cnQpOwo+ICAgCWludCBmcmVlX2NyZWRpdHM7Cj4gICAJaW50IGksIGo7Cj4gQEAgLTEyNiw3ICsx
MjYsNyBAQCBzdGF0aWMgYm9vbCBhZGRfcGF5bGRfdG9fcXVldWUoc3RydWN0IGludGVsX2RzaV9o
b3N0ICpob3N0LCBjb25zdCB1OCAqZGF0YSwKPiAgIAlmb3IgKGkgPSAwOyBpIDwgbGVuOyBpICs9
IDQpIHsKPiAgIAkJdTMyIHRtcCA9IDA7Cj4gICAKPiAtCQlmcmVlX2NyZWRpdHMgPSBwYXlsb2Fk
X2NyZWRpdHNfYXZhaWxhYmxlKGRldl9wcml2LCBkc2lfdHJhbnMpOwo+ICsJCWZyZWVfY3JlZGl0
cyA9IHBheWxvYWRfY3JlZGl0c19hdmFpbGFibGUoaTkxNSwgZHNpX3RyYW5zKTsKPiAgIAkJaWYg
KGZyZWVfY3JlZGl0cyA8IDEpIHsKPiAgIAkJCURSTV9FUlJPUigiUGF5bG9hZCBjcmVkaXQgbm90
IGF2YWlsYWJsZVxuIik7Cj4gICAJCQlyZXR1cm4gZmFsc2U7Cj4gQEAgLTE0NSwxMyArMTQ1LDEz
IEBAIHN0YXRpYyBpbnQgZHNpX3NlbmRfcGt0X2hkcihzdHJ1Y3QgaW50ZWxfZHNpX2hvc3QgKmhv
c3QsCj4gICAJCQkgICAgc3RydWN0IG1pcGlfZHNpX3BhY2tldCBwa3QsIGJvb2wgZW5hYmxlX2xw
ZHQpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0gaG9zdC0+aW50ZWxf
ZHNpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShpbnRl
bF9kc2ktPmJhc2UuYmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGludGVsX2RzaS0+YmFzZS5iYXNlLmRldik7Cj4gICAJZW51bSB0cmFuc2NvZGVy
IGRzaV90cmFucyA9IGRzaV9wb3J0X3RvX3RyYW5zY29kZXIoaG9zdC0+cG9ydCk7Cj4gICAJdTMy
IHRtcDsKPiAgIAlpbnQgZnJlZV9jcmVkaXRzOwo+ICAgCj4gICAJLyogY2hlY2sgaWYgaGVhZGVy
IGNyZWRpdCBhdmFpbGFibGUgKi8KPiAtCWZyZWVfY3JlZGl0cyA9IGhlYWRlcl9jcmVkaXRzX2F2
YWlsYWJsZShkZXZfcHJpdiwgZHNpX3RyYW5zKTsKPiArCWZyZWVfY3JlZGl0cyA9IGhlYWRlcl9j
cmVkaXRzX2F2YWlsYWJsZShpOTE1LCBkc2lfdHJhbnMpOwo+ICAgCWlmIChmcmVlX2NyZWRpdHMg
PCAxKSB7Cj4gICAJCURSTV9FUlJPUigic2VuZCBwa3QgaGVhZGVyIGZhaWxlZCwgbm90IGVub3Vn
aCBoZHIgY3JlZGl0c1xuIik7Cj4gICAJCXJldHVybiAtMTsKPiBAQCAtMjAwLDcgKzIwMCw3IEBA
IHN0YXRpYyBpbnQgZHNpX3NlbmRfcGt0X3BheWxkKHN0cnVjdCBpbnRlbF9kc2lfaG9zdCAqaG9z
dCwKPiAgIAo+ICAgc3RhdGljIHZvaWQgZHNpX3Byb2dyYW1fc3dpbmdfYW5kX2RlZW1waGFzaXMo
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4g
ICAJc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rl
ci0+YmFzZSk7Cj4gICAJZW51bSBwb3J0IHBvcnQ7Cj4gICAJdTMyIHRtcDsKPiBAQCAtMjY2LDcg
KzI2Niw3IEBAIHN0YXRpYyB2b2lkIGRzaV9wcm9ncmFtX3N3aW5nX2FuZF9kZWVtcGhhc2lzKHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ICAgc3RhdGljIHZvaWQgY29uZmlndXJlX2R1
YWxfbGlua19tb2RlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCSAgICAg
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ICAgewo+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRl
dik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+
YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGVuY190b19pbnRl
bF9kc2koJmVuY29kZXItPmJhc2UpOwo+ICAgCXUzMiBkc3NfY3RsMTsKPiAgIAo+IEBAIC0zMDQs
NyArMzA0LDcgQEAgc3RhdGljIHZvaWQgY29uZmlndXJlX2R1YWxfbGlua19tb2RlKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCj4gICBzdGF0aWMgdm9pZCBnZW4xMV9kc2lfcHJv
Z3JhbV9lc2NfY2xrX2RpdihzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFz
ZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29k
ZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBlbmNfdG9f
aW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiAgIAllbnVtIHBvcnQgcG9ydDsKPiAgIAl1MzIg
YnBwID0gbWlwaV9kc2lfcGl4ZWxfZm9ybWF0X3RvX2JwcChpbnRlbF9kc2ktPnBpeGVsX2Zvcm1h
dCk7Cj4gQEAgLTMyOSw3ICszMjksNyBAQCBzdGF0aWMgdm9pZCBnZW4xMV9kc2lfcHJvZ3JhbV9l
c2NfY2xrX2RpdihzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIAl9Cj4gICB9Cj4g
ICAKPiAtc3RhdGljIHZvaWQgZ2V0X2RzaV9pb19wb3dlcl9kb21haW5zKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgZ2V0X2RzaV9pb19wb3dlcl9kb21h
aW5zKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgICAgc3RydWN0IGlu
dGVsX2RzaSAqaW50ZWxfZHNpKQo+ICAgewo+ICAgCWVudW0gcG9ydCBwb3J0Owo+IEBAIC0zMzcs
NyArMzM3LDcgQEAgc3RhdGljIHZvaWQgZ2V0X2RzaV9pb19wb3dlcl9kb21haW5zKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlmb3JfZWFjaF9kc2lfcG9ydChwb3J0LCBp
bnRlbF9kc2ktPnBvcnRzKSB7Cj4gICAJCVdBUk5fT04oaW50ZWxfZHNpLT5pb193YWtlcmVmW3Bv
cnRdKTsKPiAgIAkJaW50ZWxfZHNpLT5pb193YWtlcmVmW3BvcnRdID0KPiAtCQkJaW50ZWxfZGlz
cGxheV9wb3dlcl9nZXQoZGV2X3ByaXYsCj4gKwkJCWludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGk5
MTUsCj4gICAJCQkJCQlwb3J0ID09IFBPUlRfQSA/Cj4gICAJCQkJCQlQT1dFUl9ET01BSU5fUE9S
VF9ERElfQV9JTyA6Cj4gICAJCQkJCQlQT1dFUl9ET01BSU5fUE9SVF9ERElfQl9JTyk7Cj4gQEAg
LTM0Niw3ICszNDYsNyBAQCBzdGF0aWMgdm9pZCBnZXRfZHNpX2lvX3Bvd2VyX2RvbWFpbnMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCj4gICBzdGF0aWMgdm9pZCBnZW4x
MV9kc2lfZW5hYmxlX2lvX3Bvd2VyKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ICAg
ewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVy
LT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
ZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGVu
Y190b19pbnRlbF9kc2koJmVuY29kZXItPmJhc2UpOwo+ICAgCWVudW0gcG9ydCBwb3J0Owo+ICAg
CXUzMiB0bXA7Cj4gQEAgLTM1NywyMyArMzU3LDIzIEBAIHN0YXRpYyB2b2lkIGdlbjExX2RzaV9l
bmFibGVfaW9fcG93ZXIoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICAJCUk5MTVf
V1JJVEUoSUNMX0RTSV9JT19NT0RFQ1RMKHBvcnQpLCB0bXApOwo+ICAgCX0KPiAgIAo+IC0JZ2V0
X2RzaV9pb19wb3dlcl9kb21haW5zKGRldl9wcml2LCBpbnRlbF9kc2kpOwo+ICsJZ2V0X2RzaV9p
b19wb3dlcl9kb21haW5zKGk5MTUsIGludGVsX2RzaSk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2
b2lkIGdlbjExX2RzaV9wb3dlcl91cF9sYW5lcyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
cikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9k
c2kgPSBlbmNfdG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiAgIAllbnVtIHBvcnQgcG9y
dDsKPiAgIAo+ICAgCWZvcl9lYWNoX2RzaV9wb3J0KHBvcnQsIGludGVsX2RzaS0+cG9ydHMpCj4g
LQkJaW50ZWxfY29tYm9fcGh5X3Bvd2VyX3VwX2xhbmVzKGRldl9wcml2LCBwb3J0LCB0cnVlLAo+
ICsJCWludGVsX2NvbWJvX3BoeV9wb3dlcl91cF9sYW5lcyhpOTE1LCBwb3J0LCB0cnVlLAo+ICAg
CQkJCQkgICAgICAgaW50ZWxfZHNpLT5sYW5lX2NvdW50LCBmYWxzZSk7Cj4gICB9Cj4gICAKPiAg
IHN0YXRpYyB2b2lkIGdlbjExX2RzaV9jb25maWdfcGh5X2xhbmVzX3NlcXVlbmNlKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVj
dCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGVuY190b19pbnRlbF9kc2koJmVuY29kZXItPmJhc2Up
Owo+ICAgCWVudW0gcG9ydCBwb3J0Owo+ICAgCXUzMiB0bXA7Cj4gQEAgLTQwOSw3ICs0MDksNyBA
QCBzdGF0aWMgdm9pZCBnZW4xMV9kc2lfY29uZmlnX3BoeV9sYW5lc19zZXF1ZW5jZShzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIAo+ICAgc3RhdGljIHZvaWQgZ2VuMTFfZHNpX3Zv
bHRhZ2Vfc3dpbmdfcHJvZ3JhbV9zZXEoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29k
ZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0g
ZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gICAJdTMyIHRtcDsKPiAgIAllbnVt
IHBvcnQgcG9ydDsKPiBAQCAtNDYxLDcgKzQ2MSw3IEBAIHN0YXRpYyB2b2lkIGdlbjExX2RzaV92
b2x0YWdlX3N3aW5nX3Byb2dyYW1fc2VxKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+
ICAgCj4gICBzdGF0aWMgdm9pZCBnZW4xMV9kc2lfZW5hYmxlX2RkaV9idWZmZXIoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0
IGludGVsX2RzaSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7
Cj4gICAJdTMyIHRtcDsKPiAgIAllbnVtIHBvcnQgcG9ydDsKPiBAQCAtNDgwLDcgKzQ4MCw3IEBA
IHN0YXRpYyB2b2lkIGdlbjExX2RzaV9lbmFibGVfZGRpX2J1ZmZlcihzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlcikKPiAgIAo+ICAgc3RhdGljIHZvaWQgZ2VuMTFfZHNpX3NldHVwX2RwaHlf
dGltaW5ncyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIHsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2Uu
ZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBlbmNfdG9faW50ZWxfZHNp
KCZlbmNvZGVyLT5iYXNlKTsKPiAgIAl1MzIgdG1wOwo+ICAgCWVudW0gcG9ydCBwb3J0Owo+IEBA
IC01MzUsNDggKzUzNSw0OCBAQCBzdGF0aWMgdm9pZCBnZW4xMV9kc2lfc2V0dXBfZHBoeV90aW1p
bmdzKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ICAgCj4gICBzdGF0aWMgdm9pZCBn
ZW4xMV9kc2lfZ2F0ZV9jbG9ja3Moc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShl
bmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0gZW5j
X3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gICAJdTMyIHRtcDsKPiAgIAllbnVtIHBv
cnQgcG9ydDsKPiAgIAo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRwbGxfbG9jayk7Cj4gKwlt
dXRleF9sb2NrKCZpOTE1LT5kcGxsX2xvY2spOwo+ICAgCXRtcCA9IEk5MTVfUkVBRChEUENMS0Ff
Q0ZHQ1IwX0lDTCk7Cj4gICAJZm9yX2VhY2hfZHNpX3BvcnQocG9ydCwgaW50ZWxfZHNpLT5wb3J0
cykgewo+ICAgCQl0bXAgfD0gRFBDTEtBX0NGR0NSMF9ERElfQ0xLX09GRihwb3J0KTsKPiAgIAl9
Cj4gICAKPiAgIAlJOTE1X1dSSVRFKERQQ0xLQV9DRkdDUjBfSUNMLCB0bXApOwo+IC0JbXV0ZXhf
dW5sb2NrKCZkZXZfcHJpdi0+ZHBsbF9sb2NrKTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHBs
bF9sb2NrKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgZ2VuMTFfZHNpX3VuZ2F0ZV9jbG9j
a3Moc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7
Cj4gICAJc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5j
b2Rlci0+YmFzZSk7Cj4gICAJdTMyIHRtcDsKPiAgIAllbnVtIHBvcnQgcG9ydDsKPiAgIAo+IC0J
bXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRwbGxfbG9jayk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT5k
cGxsX2xvY2spOwo+ICAgCXRtcCA9IEk5MTVfUkVBRChEUENMS0FfQ0ZHQ1IwX0lDTCk7Cj4gICAJ
Zm9yX2VhY2hfZHNpX3BvcnQocG9ydCwgaW50ZWxfZHNpLT5wb3J0cykgewo+ICAgCQl0bXAgJj0g
fkRQQ0xLQV9DRkdDUjBfRERJX0NMS19PRkYocG9ydCk7Cj4gICAJfQo+ICAgCj4gICAJSTkxNV9X
UklURShEUENMS0FfQ0ZHQ1IwX0lDTCwgdG1wKTsKPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYt
PmRwbGxfbG9jayk7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPmRwbGxfbG9jayk7Cj4gICB9Cj4g
ICAKPiAgIHN0YXRpYyB2b2lkIGdlbjExX2RzaV9tYXBfcGxsKHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLAo+ICAgCQkJICAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2RzaSAq
aW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gICAJc3RydWN0
IGludGVsX3NoYXJlZF9kcGxsICpwbGwgPSBjcnRjX3N0YXRlLT5zaGFyZWRfZHBsbDsKPiAgIAll
bnVtIHBvcnQgcG9ydDsKPiAgIAl1MzIgdmFsOwo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZfcHJp
di0+ZHBsbF9sb2NrKTsKPiArCW11dGV4X2xvY2soJmk5MTUtPmRwbGxfbG9jayk7Cj4gICAKPiAg
IAl2YWwgPSBJOTE1X1JFQUQoRFBDTEtBX0NGR0NSMF9JQ0wpOwo+ICAgCWZvcl9lYWNoX2RzaV9w
b3J0KHBvcnQsIGludGVsX2RzaS0+cG9ydHMpIHsKPiBAQCAtNTkyLDE0ICs1OTIsMTQgQEAgc3Rh
dGljIHZvaWQgZ2VuMTFfZHNpX21hcF9wbGwoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
Cj4gICAKPiAgIAlQT1NUSU5HX1JFQUQoRFBDTEtBX0NGR0NSMF9JQ0wpOwo+ICAgCj4gLQltdXRl
eF91bmxvY2soJmRldl9wcml2LT5kcGxsX2xvY2spOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5k
cGxsX2xvY2spOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZAo+ICAgZ2VuMTFfZHNpX2NvbmZp
Z3VyZV90cmFuc2NvZGVyKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJICAg
ICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFz
ZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29k
ZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBlbmNfdG9f
aW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxf
Y3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0Yyk7Cj4gICAJZW51bSBw
aXBlIHBpcGUgPSBpbnRlbF9jcnRjLT5waXBlOwo+IEBAIC03MzYsNyArNzM2LDcgQEAgc3RhdGlj
IHZvaWQKPiAgIGdlbjExX2RzaV9zZXRfdHJhbnNjb2Rlcl90aW1pbmdzKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
cGlwZV9jb25maWcpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2Rz
aSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gICAJY29u
c3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+ICAgCQkJCQkmcGlw
ZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPiBAQCAtODQ5LDcgKzg0OSw3IEBAIGdlbjEx
X2RzaV9zZXRfdHJhbnNjb2Rlcl90aW1pbmdzKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ICAgCj4gICBzdGF0aWMgdm9pZCBnZW4xMV9kc2lfZW5hYmxlX3RyYW5zY29kZXIoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3Ry
dWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFz
ZSk7Cj4gICAJZW51bSBwb3J0IHBvcnQ7Cj4gICAJZW51bSB0cmFuc2NvZGVyIGRzaV90cmFuczsK
PiBAQCAtODYyLDcgKzg2Miw3IEBAIHN0YXRpYyB2b2lkIGdlbjExX2RzaV9lbmFibGVfdHJhbnNj
b2RlcihzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIAkJSTkxNV9XUklURShQSVBF
Q09ORihkc2lfdHJhbnMpLCB0bXApOwo+ICAgCj4gICAJCS8qIHdhaXQgZm9yIHRyYW5zY29kZXIg
dG8gYmUgZW5hYmxlZCAqLwo+IC0JCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3By
aXYtPnVuY29yZSwKPiArCQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29y
ZSwKPiAgIAkJCQkJICAgIFBJUEVDT05GKGRzaV90cmFucyksCj4gICAJCQkJCSAgICBJOTY1X1BJ
UEVDT05GX0FDVElWRSwKPiAgIAkJCQkJICAgIEk5NjVfUElQRUNPTkZfQUNUSVZFLCAxMCkpCj4g
QEAgLTg3Miw3ICs4NzIsNyBAQCBzdGF0aWMgdm9pZCBnZW4xMV9kc2lfZW5hYmxlX3RyYW5zY29k
ZXIoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICAKPiAgIHN0YXRpYyB2b2lkIGdl
bjExX2RzaV9zZXR1cF90aW1lb3V0cyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAg
IHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rl
ci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBl
bmNfdG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiAgIAllbnVtIHBvcnQgcG9ydDsKPiAg
IAllbnVtIHRyYW5zY29kZXIgZHNpX3RyYW5zOwo+IEBAIC05NTAsNyArOTUwLDcgQEAgZ2VuMTFf
ZHNpX2VuYWJsZV9wb3J0X2FuZF9waHkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4g
ICAKPiAgIHN0YXRpYyB2b2lkIGdlbjExX2RzaV9wb3dlcnVwX3BhbmVsKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRl
bF9kc2kgKmludGVsX2RzaSA9IGVuY190b19pbnRlbF9kc2koJmVuY29kZXItPmJhc2UpOwo+ICAg
CXN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRzaTsKPiAgIAllbnVtIHBvcnQgcG9ydDsKPiBAQCAt
MTAyNiw3ICsxMDI2LDcgQEAgc3RhdGljIHZvaWQgZ2VuMTFfZHNpX3ByZV9lbmFibGUoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAKPiAgIHN0YXRpYyB2b2lkIGdlbjExX2RzaV9k
aXNhYmxlX3RyYW5zY29kZXIoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICB7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNv
ZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0gZW5jX3Rv
X2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gICAJZW51bSBwb3J0IHBvcnQ7Cj4gICAJZW51
bSB0cmFuc2NvZGVyIGRzaV90cmFuczsKPiBAQCAtMTA0MSw3ICsxMDQxLDcgQEAgc3RhdGljIHZv
aWQgZ2VuMTFfZHNpX2Rpc2FibGVfdHJhbnNjb2RlcihzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlcikKPiAgIAkJSTkxNV9XUklURShQSVBFQ09ORihkc2lfdHJhbnMpLCB0bXApOwo+ICAgCj4g
ICAJCS8qIHdhaXQgZm9yIHRyYW5zY29kZXIgdG8gYmUgZGlzYWJsZWQgKi8KPiAtCQlpZiAoaW50
ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gKwkJaWYgKGludGVsX3dh
aXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsCj4gICAJCQkJCSAgICBQSVBFQ09ORihkc2lf
dHJhbnMpLAo+ICAgCQkJCQkgICAgSTk2NV9QSVBFQ09ORl9BQ1RJVkUsIDAsIDUwKSkKPiAgIAkJ
CURSTV9FUlJPUigiRFNJIHRyYW5jb2RlciBub3QgZGlzYWJsZWRcbiIpOwo+IEBAIC0xMDYyLDcg
KzEwNjIsNyBAQCBzdGF0aWMgdm9pZCBnZW4xMV9kc2lfcG93ZXJkb3duX3BhbmVsKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ICAgCj4gICBzdGF0aWMgdm9pZCBnZW4xMV9kc2lfZGVj
b25maWd1cmVfdHJhbmNvZGVyKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ICAgewo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5i
YXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5j
b2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGVuY190
b19pbnRlbF9kc2koJmVuY29kZXItPmJhc2UpOwo+ICAgCWVudW0gcG9ydCBwb3J0Owo+ICAgCWVu
dW0gdHJhbnNjb2RlciBkc2lfdHJhbnM7Cj4gQEAgLTExMDMsNyArMTEwMyw3IEBAIHN0YXRpYyB2
b2lkIGdlbjExX2RzaV9kZWNvbmZpZ3VyZV90cmFuY29kZXIoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIpCj4gICAKPiAgIHN0YXRpYyB2b2lkIGdlbjExX2RzaV9kaXNhYmxlX3BvcnQoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJ
c3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+
YmFzZSk7Cj4gICAJdTMyIHRtcDsKPiAgIAllbnVtIHBvcnQgcG9ydDsKPiBAQCAtMTEyNSw3ICsx
MTI1LDcgQEAgc3RhdGljIHZvaWQgZ2VuMTFfZHNpX2Rpc2FibGVfcG9ydChzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlcikKPiAgIAo+ICAgc3RhdGljIHZvaWQgZ2VuMTFfZHNpX2Rpc2FibGVf
aW9fcG93ZXIoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICB7Cj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsK
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNl
LmRldik7Cj4gICAJc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2Rz
aSgmZW5jb2Rlci0+YmFzZSk7Cj4gICAJZW51bSBwb3J0IHBvcnQ7Cj4gICAJdTMyIHRtcDsKPiBA
QCAtMTEzNCw3ICsxMTM0LDcgQEAgc3RhdGljIHZvaWQgZ2VuMTFfZHNpX2Rpc2FibGVfaW9fcG93
ZXIoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICAJCWludGVsX3dha2VyZWZfdCB3
YWtlcmVmOwo+ICAgCj4gICAJCXdha2VyZWYgPSBmZXRjaF9hbmRfemVybygmaW50ZWxfZHNpLT5p
b193YWtlcmVmW3BvcnRdKTsKPiAtCQlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwK
PiArCQlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChpOTE1LAo+ICAgCQkJCQlwb3J0ID09IFBPUlRf
QSA/Cj4gICAJCQkJCVBPV0VSX0RPTUFJTl9QT1JUX0RESV9BX0lPIDoKPiAgIAkJCQkJUE9XRVJf
RE9NQUlOX1BPUlRfRERJX0JfSU8sCj4gQEAgLTEyMDUsMTMgKzEyMDUsMTMgQEAgc3RhdGljIHZv
aWQgZ2VuMTFfZHNpX2dldF90aW1pbmdzKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+
ICAgc3RhdGljIHZvaWQgZ2VuMTFfZHNpX2dldF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4gICAJCQkJIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykK
PiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5j
b2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRv
X2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0Yyk7Cj4gICAJc3RydWN0IGludGVsX2Rz
aSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gICAKPiAg
IAkvKiBGSVhNRTogYWRhcHQgaWNsX2RkaV9jbG9ja19nZXQoKSBmb3IgRFNJIGFuZCB1c2UgdGhh
dD8gKi8KPiAgIAlwaXBlX2NvbmZpZy0+cG9ydF9jbG9jayA9Cj4gLQkJY25sX2NhbGNfd3JwbGxf
bGluayhkZXZfcHJpdiwgJnBpcGVfY29uZmlnLT5kcGxsX2h3X3N0YXRlKTsKPiArCQljbmxfY2Fs
Y193cnBsbF9saW5rKGk5MTUsICZwaXBlX2NvbmZpZy0+ZHBsbF9od19zdGF0ZSk7Cj4gICAKPiAg
IAlwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2sgPSBpbnRlbF9kc2kt
PnBjbGs7Cj4gICAJaWYgKGludGVsX2RzaS0+ZHVhbF9saW5rKQo+IEBAIC0xMjYzLDcgKzEyNjMs
NyBAQCBzdGF0aWMgdm9pZCBnZW4xMV9kc2lfZ2V0X3Bvd2VyX2RvbWFpbnMoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsCj4gICBzdGF0aWMgYm9vbCBnZW4xMV9kc2lfZ2V0X2h3X3N0YXRl
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCSAgIGVudW0gcGlwZSAqcGlw
ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9k
c2kgPSBlbmNfdG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiAgIAllbnVtIHRyYW5zY29k
ZXIgZHNpX3RyYW5zOwo+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+IEBAIC0xMjcxLDcg
KzEyNzEsNyBAQCBzdGF0aWMgYm9vbCBnZW4xMV9kc2lfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCWJvb2wgcmV0ID0gZmFsc2U7Cj4gICAJdTMyIHRtcDsK
PiAgIAo+IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2
X3ByaXYsCj4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChp
OTE1LAo+ICAgCQkJCQkJICAgICBlbmNvZGVyLT5wb3dlcl9kb21haW4pOwo+ICAgCWlmICghd2Fr
ZXJlZikKPiAgIAkJcmV0dXJuIGZhbHNlOwo+IEBAIC0xMjk4LDcgKzEyOTgsNyBAQCBzdGF0aWMg
Ym9vbCBnZW4xMV9kc2lfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ICAgCQlyZXQgPSB0bXAgJiBQSVBFQ09ORl9FTkFCTEU7Cj4gICAJfQo+ICAgb3V0Ogo+IC0J
aW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIGVuY29kZXItPnBvd2VyX2RvbWFpbiwg
d2FrZXJlZik7Cj4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChpOTE1LCBlbmNvZGVyLT5wb3dl
cl9kb21haW4sIHdha2VyZWYpOwo+ICAgCXJldHVybiByZXQ7Cj4gICB9Cj4gICAKPiBAQCAtMTM5
MSw4ICsxMzkxLDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBtaXBpX2RzaV9ob3N0X29wcyBnZW4x
MV9kc2lfaG9zdF9vcHMgPSB7Cj4gICBzdGF0aWMgdm9pZCBpY2xfZHBoeV9wYXJhbV9pbml0KHN0
cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSkKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2ID0gaW50ZWxfZHNpLT5iYXNlLmJhc2UuZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+IC0Jc3RydWN0IG1pcGlfY29uZmlnICptaXBp
X2NvbmZpZyA9IGRldl9wcml2LT52YnQuZHNpLmNvbmZpZzsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IG1pcGlfY29uZmlnICptaXBp
X2NvbmZpZyA9IGk5MTUtPnZidC5kc2kuY29uZmlnOwo+ICAgCXUzMiB0bHB4X25zOwo+ICAgCXUz
MiBwcmVwYXJlX2NudCwgZXhpdF96ZXJvX2NudCwgY2xrX3plcm9fY250LCB0cmFpbF9jbnQ7Cj4g
ICAJdTMyIHRoc19wcmVwYXJlX25zLCB0Y2xrX3RyYWlsX25zOwo+IEBAIC0xNDg3LDkgKzE0ODcs
OSBAQCBzdGF0aWMgdm9pZCBpY2xfZHBoeV9wYXJhbV9pbml0KHN0cnVjdCBpbnRlbF9kc2kgKmlu
dGVsX2RzaSkKPiAgIAlpbnRlbF9kc2lfbG9nX3BhcmFtcyhpbnRlbF9kc2kpOwo+ICAgfQo+ICAg
Cj4gLXZvaWQgaWNsX2RzaV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiArdm9pZCBpY2xfZHNpX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmRldl9wcml2LT5kcm07Cj4gKwlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2ID0gJmk5MTUtPmRybTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRl
bF9kc2k7Cj4gICAJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXI7Cj4gICAJc3RydWN0IGlu
dGVsX2Nvbm5lY3RvciAqaW50ZWxfY29ubmVjdG9yOwo+IEBAIC0xNDk3LDcgKzE0OTcsNyBAQCB2
b2lkIGljbF9kc2lfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJ
c3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmZpeGVkX21vZGU7Cj4gICAJZW51bSBwb3J0IHBvcnQ7
Cj4gICAKPiAtCWlmICghaW50ZWxfYmlvc19pc19kc2lfcHJlc2VudChkZXZfcHJpdiwgJnBvcnQp
KQo+ICsJaWYgKCFpbnRlbF9iaW9zX2lzX2RzaV9wcmVzZW50KGk5MTUsICZwb3J0KSkKPiAgIAkJ
cmV0dXJuOwo+ICAgCj4gICAJaW50ZWxfZHNpID0ga3phbGxvYyhzaXplb2YoKmludGVsX2RzaSks
IEdGUF9LRVJORUwpOwo+IEBAIC0xNTU2LDEzICsxNTU2LDEzIEBAIHZvaWQgaWNsX2RzaV9pbml0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAlpbnRlbF9wYW5lbF9pbml0
KCZpbnRlbF9jb25uZWN0b3ItPnBhbmVsLCBmaXhlZF9tb2RlLCBOVUxMKTsKPiAgIAlpbnRlbF9w
YW5lbF9zZXR1cF9iYWNrbGlnaHQoY29ubmVjdG9yLCBJTlZBTElEX1BJUEUpOwo+ICAgCj4gLQlp
ZiAoZGV2X3ByaXYtPnZidC5kc2kuY29uZmlnLT5kdWFsX2xpbmspCj4gKwlpZiAoaTkxNS0+dmJ0
LmRzaS5jb25maWctPmR1YWxfbGluaykKPiAgIAkJaW50ZWxfZHNpLT5wb3J0cyA9IEJJVChQT1JU
X0EpIHwgQklUKFBPUlRfQik7Cj4gICAJZWxzZQo+ICAgCQlpbnRlbF9kc2ktPnBvcnRzID0gQklU
KHBvcnQpOwo+ICAgCj4gLQlpbnRlbF9kc2ktPmRjc19iYWNrbGlnaHRfcG9ydHMgPSBkZXZfcHJp
di0+dmJ0LmRzaS5ibF9wb3J0czsKPiAtCWludGVsX2RzaS0+ZGNzX2NhYmNfcG9ydHMgPSBkZXZf
cHJpdi0+dmJ0LmRzaS5jYWJjX3BvcnRzOwo+ICsJaW50ZWxfZHNpLT5kY3NfYmFja2xpZ2h0X3Bv
cnRzID0gaTkxNS0+dmJ0LmRzaS5ibF9wb3J0czsKPiArCWludGVsX2RzaS0+ZGNzX2NhYmNfcG9y
dHMgPSBpOTE1LT52YnQuZHNpLmNhYmNfcG9ydHM7Cj4gICAKPiAgIAlmb3JfZWFjaF9kc2lfcG9y
dChwb3J0LCBpbnRlbF9kc2ktPnBvcnRzKSB7Cj4gICAJCXN0cnVjdCBpbnRlbF9kc2lfaG9zdCAq
aG9zdDsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfYXRvbWljLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9hdG9taWMuYwo+IGluZGV4IDZiOTg1ZTg5NWE5
Ny4uNDU3ODJlNmZmMGY0IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X2F0b21pYy5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfYXRvbWljLmMKPiBA
QCAtNTQsMTMgKzU0LDEzIEBAIGludCBpbnRlbF9kaWdpdGFsX2Nvbm5lY3Rvcl9hdG9taWNfZ2V0
X3Byb3BlcnR5KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCj4gICAJCQkJCQl1NjQg
KnZhbCkKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY29ubmVjdG9yLT5kZXY7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAlzdHJ1
Y3QgaW50ZWxfZGlnaXRhbF9jb25uZWN0b3Jfc3RhdGUgKmludGVsX2Nvbm5fc3RhdGUgPQo+ICAg
CQl0b19pbnRlbF9kaWdpdGFsX2Nvbm5lY3Rvcl9zdGF0ZShzdGF0ZSk7Cj4gICAKPiAtCWlmIChw
cm9wZXJ0eSA9PSBkZXZfcHJpdi0+Zm9yY2VfYXVkaW9fcHJvcGVydHkpCj4gKwlpZiAocHJvcGVy
dHkgPT0gaTkxNS0+Zm9yY2VfYXVkaW9fcHJvcGVydHkpCj4gICAJCSp2YWwgPSBpbnRlbF9jb25u
X3N0YXRlLT5mb3JjZV9hdWRpbzsKPiAtCWVsc2UgaWYgKHByb3BlcnR5ID09IGRldl9wcml2LT5i
cm9hZGNhc3RfcmdiX3Byb3BlcnR5KQo+ICsJZWxzZSBpZiAocHJvcGVydHkgPT0gaTkxNS0+YnJv
YWRjYXN0X3JnYl9wcm9wZXJ0eSkKPiAgIAkJKnZhbCA9IGludGVsX2Nvbm5fc3RhdGUtPmJyb2Fk
Y2FzdF9yZ2I7Cj4gICAJZWxzZSB7Cj4gICAJCURSTV9ERUJVR19BVE9NSUMoIlVua25vd24gcHJv
cGVydHkgW1BST1A6JWQ6JXNdXG4iLAo+IEBAIC04NiwxNiArODYsMTYgQEAgaW50IGludGVsX2Rp
Z2l0YWxfY29ubmVjdG9yX2F0b21pY19zZXRfcHJvcGVydHkoc3RydWN0IGRybV9jb25uZWN0b3Ig
KmNvbm5lY3RvciwKPiAgIAkJCQkJCXU2NCB2YWwpCj4gICB7Cj4gICAJc3RydWN0IGRybV9kZXZp
Y2UgKmRldiA9IGNvbm5lY3Rvci0+ZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGRldik7Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfY29ubmVjdG9yX3N0YXRl
ICppbnRlbF9jb25uX3N0YXRlID0KPiAgIAkJdG9faW50ZWxfZGlnaXRhbF9jb25uZWN0b3Jfc3Rh
dGUoc3RhdGUpOwo+ICAgCj4gLQlpZiAocHJvcGVydHkgPT0gZGV2X3ByaXYtPmZvcmNlX2F1ZGlv
X3Byb3BlcnR5KSB7Cj4gKwlpZiAocHJvcGVydHkgPT0gaTkxNS0+Zm9yY2VfYXVkaW9fcHJvcGVy
dHkpIHsKPiAgIAkJaW50ZWxfY29ubl9zdGF0ZS0+Zm9yY2VfYXVkaW8gPSB2YWw7Cj4gICAJCXJl
dHVybiAwOwo+ICAgCX0KPiAgIAo+IC0JaWYgKHByb3BlcnR5ID09IGRldl9wcml2LT5icm9hZGNh
c3RfcmdiX3Byb3BlcnR5KSB7Cj4gKwlpZiAocHJvcGVydHkgPT0gaTkxNS0+YnJvYWRjYXN0X3Jn
Yl9wcm9wZXJ0eSkgewo+ICAgCQlpbnRlbF9jb25uX3N0YXRlLT5icm9hZGNhc3RfcmdiID0gdmFs
Owo+ICAgCQlyZXR1cm4gMDsKPiAgIAl9Cj4gQEAgLTIyNyw3ICsyMjcsNyBAQCBzdGF0aWMgdm9p
ZCBpbnRlbF9hdG9taWNfc2V0dXBfc2NhbGVyKHN0cnVjdCBpbnRlbF9jcnRjX3NjYWxlcl9zdGF0
ZSAqc2NhbGVyX3N0YQo+ICAgCQkJCSAgICAgIHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxh
bmVfc3RhdGUsCj4gICAJCQkJICAgICAgaW50ICpzY2FsZXJfaWQpCj4gICB7Cj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGludGVsX2NydGMtPmJhc2UuZGV2
KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShpbnRlbF9jcnRj
LT5iYXNlLmRldik7Cj4gICAJaW50IGo7Cj4gICAJdTMyIG1vZGU7Cj4gICAKPiBAQCAtMjUxLDEw
ICsyNTEsMTAgQEAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX3NldHVwX3NjYWxlcihzdHJ1Y3Qg
aW50ZWxfY3J0Y19zY2FsZXJfc3RhdGUgKnNjYWxlcl9zdGEKPiAgIAkgICAgcGxhbmVfc3RhdGUt
PmJhc2UuZmItPmZvcm1hdC0+aXNfeXV2ICYmCj4gICAJICAgIHBsYW5lX3N0YXRlLT5iYXNlLmZi
LT5mb3JtYXQtPm51bV9wbGFuZXMgPiAxKSB7Cj4gICAJCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxh
bmUgPSB0b19pbnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZSk7Cj4gLQkJaWYgKElT
X0dFTihkZXZfcHJpdiwgOSkgJiYKPiAtCQkgICAgIUlTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKSB7
Cj4gKwkJaWYgKElTX0dFTihpOTE1LCA5KSAmJgo+ICsJCSAgICAhSVNfR0VNSU5JTEFLRShpOTE1
KSkgewo+ICAgCQkJbW9kZSA9IFNLTF9QU19TQ0FMRVJfTU9ERV9OVjEyOwo+IC0JCX0gZWxzZSBp
ZiAoaWNsX2lzX2hkcl9wbGFuZShkZXZfcHJpdiwgcGxhbmUtPmlkKSkgewo+ICsJCX0gZWxzZSBp
ZiAoaWNsX2lzX2hkcl9wbGFuZShpOTE1LCBwbGFuZS0+aWQpKSB7Cj4gICAJCQkvKgo+ICAgCQkJ
ICogT24gZ2VuMTErJ3MgSERSIHBsYW5lcyB3ZSBvbmx5IHVzZSB0aGUgc2NhbGVyIGZvcgo+ICAg
CQkJICogc2NhbGluZy4gVGhleSBoYXZlIGEgZGVkaWNhdGVkIGNocm9tYSB1cHNhbXBsZXIsIHNv
Cj4gQEAgLTI2Nyw3ICsyNjcsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9hdG9taWNfc2V0dXBfc2Nh
bGVyKHN0cnVjdCBpbnRlbF9jcnRjX3NjYWxlcl9zdGF0ZSAqc2NhbGVyX3N0YQo+ICAgCQkJaWYg
KHBsYW5lX3N0YXRlLT5saW5rZWRfcGxhbmUpCj4gICAJCQkJbW9kZSB8PSBQU19QTEFORV9ZX1NF
TChwbGFuZV9zdGF0ZS0+bGlua2VkX3BsYW5lLT5pZCk7Cj4gICAJCX0KPiAtCX0gZWxzZSBpZiAo
SU5URUxfR0VOKGRldl9wcml2KSA+IDkgfHwgSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpIHsKPiAr
CX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID4gOSB8fCBJU19HRU1JTklMQUtFKGk5MTUpKSB7
Cj4gICAJCW1vZGUgPSBQU19TQ0FMRVJfTU9ERV9OT1JNQUw7Cj4gICAJfSBlbHNlIGlmIChudW1f
c2NhbGVyc19uZWVkID09IDEgJiYgaW50ZWxfY3J0Yy0+bnVtX3NjYWxlcnMgPiAxKSB7Cj4gICAJ
CS8qCj4gQEAgLTI5MCw3ICsyOTAsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9hdG9taWNfc2V0dXBf
c2NhbGVyKHN0cnVjdCBpbnRlbF9jcnRjX3NjYWxlcl9zdGF0ZSAqc2NhbGVyX3N0YQo+ICAgCj4g
ICAvKioKPiAgICAqIGludGVsX2F0b21pY19zZXR1cF9zY2FsZXJzKCkgLSBzZXR1cCBzY2FsZXJz
IGZvciBjcnRjIHBlciBzdGFnZWQgcmVxdWVzdHMKPiAtICogQGRldl9wcml2OiBpOTE1IGRldmlj
ZQo+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UKPiAgICAqIEBpbnRlbF9jcnRjOiBpbnRlbCBjcnRj
Cj4gICAgKiBAY3J0Y19zdGF0ZTogaW5jb21pbmcgY3J0Y19zdGF0ZSB0byB2YWxpZGF0ZSBhbmQg
c2V0dXAgc2NhbGVycwo+ICAgICoKPiBAQCAtMzA1LDcgKzMwNSw3IEBAIHN0YXRpYyB2b2lkIGlu
dGVsX2F0b21pY19zZXR1cF9zY2FsZXIoc3RydWN0IGludGVsX2NydGNfc2NhbGVyX3N0YXRlICpz
Y2FsZXJfc3RhCj4gICAgKiAgICAgICAgIDAgLSBzY2FsZXJzIHdlcmUgc2V0dXAgc3VjY2VzZnVs
bHkKPiAgICAqICAgICAgICAgZXJyb3IgY29kZSAtIG90aGVyd2lzZQo+ICAgICovCj4gLWludCBp
bnRlbF9hdG9taWNfc2V0dXBfc2NhbGVycyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gK2ludCBpbnRlbF9hdG9taWNfc2V0dXBfc2NhbGVycyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YywK
PiAgIAkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsK
PiBAQCAtMzY5LDcgKzM2OSw3IEBAIGludCBpbnRlbF9hdG9taWNfc2V0dXBfc2NhbGVycyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJCQkgKi8KPiAgIAkJCWlmICghcGxh
bmUpIHsKPiAgIAkJCQlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpzdGF0ZTsKPiAtCQkJCXBsYW5l
ID0gZHJtX3BsYW5lX2Zyb21faW5kZXgoJmRldl9wcml2LT5kcm0sIGkpOwo+ICsJCQkJcGxhbmUg
PSBkcm1fcGxhbmVfZnJvbV9pbmRleCgmaTkxNS0+ZHJtLCBpKTsKPiAgIAkJCQlzdGF0ZSA9IGRy
bV9hdG9taWNfZ2V0X3BsYW5lX3N0YXRlKGRybV9zdGF0ZSwgcGxhbmUpOwo+ICAgCQkJCWlmIChJ
U19FUlIoc3RhdGUpKSB7Cj4gICAJCQkJCURSTV9ERUJVR19LTVMoIkZhaWxlZCB0byBhZGQgW1BM
QU5FOiVkXSB0byBkcm1fc3RhdGVcbiIsCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX2F0b21pYy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfYXRvbWljLmgK
PiBpbmRleCAxYzg1MDdkYTFhNjkuLjU0ODJmZDA0ZDYzOSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9hdG9taWMuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2F0b21pYy5oCj4gQEAgLTQyLDcgKzQyLDcgQEAgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKgo+ICAgaW50ZWxfYXRvbWljX2dldF9jcnRjX3N0YXRlKHN0cnVjdCBkcm1fYXRvbWljX3N0
YXRlICpzdGF0ZSwKPiAgIAkJCSAgICBzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0Yyk7Cj4gICAKPiAt
aW50IGludGVsX2F0b21pY19zZXR1cF9zY2FsZXJzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiAraW50IGludGVsX2F0b21pY19zZXR1cF9zY2FsZXJzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgICAgIHN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9j
cnRjLAo+ICAgCQkJICAgICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKTsK
PiAgIAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9hdWRpby5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfYXVkaW8uYwo+IGluZGV4IDg0MGRhZmYxMjI0Ni4u
ZjQ2M2Q4NDUyZmU5IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2F1
ZGlvLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9hdWRpby5jCj4gQEAgLTIz
MCw3ICsyMzAsNyBAQCBzdGF0aWMgYm9vbCBpbnRlbF9lbGRfdXB0b2RhdGUoc3RydWN0IGRybV9j
b25uZWN0b3IgKmNvbm5lY3RvciwKPiAgIAkJCSAgICAgICBpOTE1X3JlZ190IHJlZ19lbGRhLCB1
MzIgYml0c19lbGRhLAo+ICAgCQkJICAgICAgIGk5MTVfcmVnX3QgcmVnX2VkaWQpCj4gICB7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+
ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0
b3ItPmRldik7Cj4gICAJY29uc3QgdTggKmVsZCA9IGNvbm5lY3Rvci0+ZWxkOwo+ICAgCXUzMiB0
bXA7Cj4gICAJaW50IGk7Cj4gQEAgLTI1Niw3ICsyNTYsNyBAQCBzdGF0aWMgdm9pZCBnNHhfYXVk
aW9fY29kZWNfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCQkg
ICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+ICAgCQkJ
CSAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29k
ZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJdTMyIGVsZHYsIHRtcDsKPiAgIAo+ICAgCURSTV9E
RUJVR19LTVMoIkRpc2FibGUgYXVkaW8gY29kZWNcbiIpOwo+IEBAIC0yNzcsNyArMjc3LDcgQEAg
c3RhdGljIHZvaWQgZzR4X2F1ZGlvX2NvZGVjX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlciwKPiAgIAkJCQkgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSwKPiAgIAkJCQkgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9z
dGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAq
Y29ubmVjdG9yID0gY29ubl9zdGF0ZS0+Y29ubmVjdG9yOwo+ICAgCWNvbnN0IHU4ICplbGQgPSBj
b25uZWN0b3ItPmVsZDsKPiAgIAl1MzIgZWxkdjsKPiBAQCAtMzE3LDggKzMxNyw4IEBAIHN0YXRp
YyB2b2lkCj4gICBoc3dfZHBfYXVkaW9fY29uZmlnX3VwZGF0ZShzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiAgIAkJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gLQlzdHJ1Y3QgaTkxNV9hdWRpb19jb21wb25lbnQg
KmFjb21wID0gZGV2X3ByaXYtPmF1ZGlvX2NvbXBvbmVudDsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgaTkx
NV9hdWRpb19jb21wb25lbnQgKmFjb21wID0gaTkxNS0+YXVkaW9fY29tcG9uZW50Owo+ICAgCWVu
dW0gdHJhbnNjb2RlciBjcHVfdHJhbnNjb2RlciA9IGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVy
Owo+ICAgCWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKPiAgIAljb25zdCBzdHJ1Y3Qg
ZHBfYXVkX25fbSAqbm07Cj4gQEAgLTM2NCw4ICszNjQsOCBAQCBzdGF0aWMgdm9pZAo+ICAgaHN3
X2hkbWlfYXVkaW9fY29uZmlnX3VwZGF0ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwK
PiAgIAkJCSAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29k
ZXItPmJhc2UuZGV2KTsKPiAtCXN0cnVjdCBpOTE1X2F1ZGlvX2NvbXBvbmVudCAqYWNvbXAgPSBk
ZXZfcHJpdi0+YXVkaW9fY29tcG9uZW50Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBpOTE1X2F1ZGlvX2Nv
bXBvbmVudCAqYWNvbXAgPSBpOTE1LT5hdWRpb19jb21wb25lbnQ7Cj4gICAJZW51bSB0cmFuc2Nv
ZGVyIGNwdV90cmFuc2NvZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXI7Cj4gICAJZW51
bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+ICAgCWludCBuLCByYXRlOwo+IEBAIC00MTYs
MTQgKzQxNiwxNCBAQCBzdGF0aWMgdm9pZCBoc3dfYXVkaW9fY29kZWNfZGlzYWJsZShzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCQkgICAgY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+ICAgCQkJCSAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nv
bm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4g
ICAJZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0gb2xkX2NydGNfc3RhdGUtPmNwdV90
cmFuc2NvZGVyOwo+ICAgCXUzMiB0bXA7Cj4gICAKPiAgIAlEUk1fREVCVUdfS01TKCJEaXNhYmxl
IGF1ZGlvIGNvZGVjIG9uIHRyYW5zY29kZXIgJXNcbiIsCj4gICAJCSAgICAgIHRyYW5zY29kZXJf
bmFtZShjcHVfdHJhbnNjb2RlcikpOwo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+YXZf
bXV0ZXgpOwo+ICsJbXV0ZXhfbG9jaygmaTkxNS0+YXZfbXV0ZXgpOwo+ICAgCj4gICAJLyogRGlz
YWJsZSB0aW1lc3RhbXBzICovCj4gICAJdG1wID0gSTkxNV9SRUFEKEhTV19BVURfQ0ZHKGNwdV90
cmFuc2NvZGVyKSk7Cj4gQEAgLTQ0MSwxNCArNDQxLDE0IEBAIHN0YXRpYyB2b2lkIGhzd19hdWRp
b19jb2RlY19kaXNhYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCXRtcCAm
PSB+QVVESU9fT1VUUFVUX0VOQUJMRShjcHVfdHJhbnNjb2Rlcik7Cj4gICAJSTkxNV9XUklURShI
U1dfQVVEX1BJTl9FTERfQ1BfVkxELCB0bXApOwo+ICAgCj4gLQltdXRleF91bmxvY2soJmRldl9w
cml2LT5hdl9tdXRleCk7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPmF2X211dGV4KTsKPiAgIH0K
PiAgIAo+ICAgc3RhdGljIHZvaWQgaHN3X2F1ZGlvX2NvZGVjX2VuYWJsZShzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCQkgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJCQkgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0
ZSAqY29ubl9zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgZHJtX2Nv
bm5lY3RvciAqY29ubmVjdG9yID0gY29ubl9zdGF0ZS0+Y29ubmVjdG9yOwo+ICAgCWVudW0gdHJh
bnNjb2RlciBjcHVfdHJhbnNjb2RlciA9IGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyOwo+ICAg
CWNvbnN0IHU4ICplbGQgPSBjb25uZWN0b3ItPmVsZDsKPiBAQCAtNDU4LDcgKzQ1OCw3IEBAIHN0
YXRpYyB2b2lkIGhzd19hdWRpb19jb2RlY19lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCj4gICAJRFJNX0RFQlVHX0tNUygiRW5hYmxlIGF1ZGlvIGNvZGVjIG9uIHRyYW5zY29k
ZXIgJXMsICV1IGJ5dGVzIEVMRFxuIiwKPiAgIAkJICAgICAgdHJhbnNjb2Rlcl9uYW1lKGNwdV90
cmFuc2NvZGVyKSwgZHJtX2VsZF9zaXplKGVsZCkpOwo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZf
cHJpdi0+YXZfbXV0ZXgpOwo+ICsJbXV0ZXhfbG9jaygmaTkxNS0+YXZfbXV0ZXgpOwo+ICAgCj4g
ICAJLyogRW5hYmxlIGF1ZGlvIHByZXNlbmNlIGRldGVjdCwgaW52YWxpZGF0ZSBFTEQgKi8KPiAg
IAl0bXAgPSBJOTE1X1JFQUQoSFNXX0FVRF9QSU5fRUxEX0NQX1ZMRCk7Cj4gQEAgLTQ5MSwxNCAr
NDkxLDE0IEBAIHN0YXRpYyB2b2lkIGhzd19hdWRpb19jb2RlY19lbmFibGUoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsCj4gICAJLyogRW5hYmxlIHRpbWVzdGFtcHMgKi8KPiAgIAloc3df
YXVkaW9fY29uZmlnX3VwZGF0ZShlbmNvZGVyLCBjcnRjX3N0YXRlKTsKPiAgIAo+IC0JbXV0ZXhf
dW5sb2NrKCZkZXZfcHJpdi0+YXZfbXV0ZXgpOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5hdl9t
dXRleCk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIGlsa19hdWRpb19jb2RlY19kaXNhYmxl
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCSAgICBjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCj4gICAJCQkJICAgIGNvbnN0IHN0cnVj
dCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2Uu
ZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMob2xkX2Ny
dGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+
ICAgCWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKPiBAQCAtNTExLDEwICs1MTEsMTAg
QEAgc3RhdGljIHZvaWQgaWxrX2F1ZGlvX2NvZGVjX2Rpc2FibGUoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIsCj4gICAJaWYgKFdBUk5fT04ocG9ydCA9PSBQT1JUX0EpKQo+ICAgCQlyZXR1
cm47Cj4gICAKPiAtCWlmIChIQVNfUENIX0lCWChkZXZfcHJpdikpIHsKPiArCWlmIChIQVNfUENI
X0lCWChpOTE1KSkgewo+ICAgCQlhdWRfY29uZmlnID0gSUJYX0FVRF9DRkcocGlwZSk7Cj4gICAJ
CWF1ZF9jbnRybF9zdDIgPSBJQlhfQVVEX0NOVExfU1QyOwo+IC0JfSBlbHNlIGlmIChJU19WQUxM
RVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkgewo+ICsJfSBlbHNl
IGlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiAgIAkJ
YXVkX2NvbmZpZyA9IFZMVl9BVURfQ0ZHKHBpcGUpOwo+ICAgCQlhdWRfY250cmxfc3QyID0gVkxW
X0FVRF9DTlRMX1NUMjsKPiAgIAl9IGVsc2Ugewo+IEBAIC01NDQsNyArNTQ0LDcgQEAgc3RhdGlj
IHZvaWQgaWxrX2F1ZGlvX2NvZGVjX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKPiAgIAkJCQkgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwK
PiAgIAkJCQkgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkK
PiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5j
b2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRv
X2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5l
Y3RvciAqY29ubmVjdG9yID0gY29ubl9zdGF0ZS0+Y29ubmVjdG9yOwo+ICAgCWVudW0gcGlwZSBw
aXBlID0gY3J0Yy0+cGlwZTsKPiBAQCAtNTY3LDEzICs1NjcsMTMgQEAgc3RhdGljIHZvaWQgaWxr
X2F1ZGlvX2NvZGVjX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkg
KiBpbmZyYXN0cnVjdHVyZSBpcyBub3QgdGhlcmUgeWV0Lgo+ICAgCSAqLwo+ICAgCj4gLQlpZiAo
SEFTX1BDSF9JQlgoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSEFTX1BDSF9JQlgoaTkxNSkpIHsKPiAg
IAkJaGRtaXdfaGRtaWVkaWQgPSBJQlhfSERNSVdfSERNSUVESUQocGlwZSk7Cj4gICAJCWF1ZF9j
b25maWcgPSBJQlhfQVVEX0NGRyhwaXBlKTsKPiAgIAkJYXVkX2NudGxfc3QgPSBJQlhfQVVEX0NO
VExfU1QocGlwZSk7Cj4gICAJCWF1ZF9jbnRybF9zdDIgPSBJQlhfQVVEX0NOVExfU1QyOwo+IC0J
fSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fAo+IC0JCSAgIElTX0NIRVJSWVZJ
RVcoZGV2X3ByaXYpKSB7Cj4gKwl9IGVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwKPiAr
CQkgICBJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gICAJCWhkbWl3X2hkbWllZGlkID0gVkxWX0hE
TUlXX0hETUlFRElEKHBpcGUpOwo+ICAgCQlhdWRfY29uZmlnID0gVkxWX0FVRF9DRkcocGlwZSk7
Cj4gICAJCWF1ZF9jbnRsX3N0ID0gVkxWX0FVRF9DTlRMX1NUKHBpcGUpOwo+IEBAIC02MzIsOCAr
NjMyLDggQEAgdm9pZCBpbnRlbF9hdWRpb19jb2RlY19lbmFibGUoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIsCj4gICAJCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSwKPiAgIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRl
ICpjb25uX3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gLQlzdHJ1Y3QgaTkxNV9hdWRpb19jb21w
b25lbnQgKmFjb21wID0gZGV2X3ByaXYtPmF1ZGlvX2NvbXBvbmVudDsKPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1
Y3QgaTkxNV9hdWRpb19jb21wb25lbnQgKmFjb21wID0gaTkxNS0+YXVkaW9fY29tcG9uZW50Owo+
ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5i
YXNlLmNydGMpOwo+ICAgCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IgPSBjb25uX3N0
YXRlLT5jb25uZWN0b3I7Cj4gICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVz
dGVkX21vZGUgPQo+IEBAIC02NTQsMTcgKzY1NCwxNyBAQCB2b2lkIGludGVsX2F1ZGlvX2NvZGVj
X2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAo+ICAgCWNvbm5lY3Rv
ci0+ZWxkWzZdID0gZHJtX2F2X3N5bmNfZGVsYXkoY29ubmVjdG9yLCBhZGp1c3RlZF9tb2RlKSAv
IDI7Cj4gICAKPiAtCWlmIChkZXZfcHJpdi0+ZGlzcGxheS5hdWRpb19jb2RlY19lbmFibGUpCj4g
LQkJZGV2X3ByaXYtPmRpc3BsYXkuYXVkaW9fY29kZWNfZW5hYmxlKGVuY29kZXIsCj4gKwlpZiAo
aTkxNS0+ZGlzcGxheS5hdWRpb19jb2RlY19lbmFibGUpCj4gKwkJaTkxNS0+ZGlzcGxheS5hdWRp
b19jb2RlY19lbmFibGUoZW5jb2RlciwKPiAgIAkJCQkJCSAgICAgY3J0Y19zdGF0ZSwKPiAgIAkJ
CQkJCSAgICAgY29ubl9zdGF0ZSk7Cj4gICAKPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5hdl9t
dXRleCk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT5hdl9tdXRleCk7Cj4gICAJZW5jb2Rlci0+YXVk
aW9fY29ubmVjdG9yID0gY29ubmVjdG9yOwo+ICAgCj4gICAJLyogcmVmZXJyZWQgaW4gYXVkaW8g
Y2FsbGJhY2tzICovCj4gLQlkZXZfcHJpdi0+YXZfZW5jX21hcFtwaXBlXSA9IGVuY29kZXI7Cj4g
LQltdXRleF91bmxvY2soJmRldl9wcml2LT5hdl9tdXRleCk7Cj4gKwlpOTE1LT5hdl9lbmNfbWFw
W3BpcGVdID0gZW5jb2RlcjsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+YXZfbXV0ZXgpOwo+ICAg
Cj4gICAJaWYgKGFjb21wICYmIGFjb21wLT5iYXNlLmF1ZGlvX29wcyAmJgo+ICAgCSAgICBhY29t
cC0+YmFzZS5hdWRpb19vcHMtPnBpbl9lbGRfbm90aWZ5KSB7Cj4gQEAgLTY3NSw3ICs2NzUsNyBA
QCB2b2lkIGludGVsX2F1ZGlvX2NvZGVjX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKPiAgIAkJCQkJCSAoaW50KSBwb3J0LCAoaW50KSBwaXBlKTsKPiAgIAl9Cj4gICAKPiAt
CWludGVsX2xwZV9hdWRpb19ub3RpZnkoZGV2X3ByaXYsIHBpcGUsIHBvcnQsIGNvbm5lY3Rvci0+
ZWxkLAo+ICsJaW50ZWxfbHBlX2F1ZGlvX25vdGlmeShpOTE1LCBwaXBlLCBwb3J0LCBjb25uZWN0
b3ItPmVsZCwKPiAgIAkJCSAgICAgICBjcnRjX3N0YXRlLT5wb3J0X2Nsb2NrLAo+ICAgCQkJICAg
ICAgIGludGVsX2NydGNfaGFzX2RwX2VuY29kZXIoY3J0Y19zdGF0ZSkpOwo+ICAgfQo+IEBAIC02
OTMsMjEgKzY5MywyMSBAQCB2b2lkIGludGVsX2F1ZGlvX2NvZGVjX2Rpc2FibGUoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkgICAgICAgY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+ICAgCQkJICAgICAgIGNvbnN0IHN0cnVjdCBkcm1f
Y29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+IC0Jc3Ry
dWN0IGk5MTVfYXVkaW9fY29tcG9uZW50ICphY29tcCA9IGRldl9wcml2LT5hdWRpb19jb21wb25l
bnQ7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+
YmFzZS5kZXYpOwo+ICsJc3RydWN0IGk5MTVfYXVkaW9fY29tcG9uZW50ICphY29tcCA9IGk5MTUt
PmF1ZGlvX2NvbXBvbmVudDsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVs
X2NydGMob2xkX2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gICAJZW51bSBwb3J0IHBvcnQgPSBl
bmNvZGVyLT5wb3J0Owo+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgIAo+IC0J
aWYgKGRldl9wcml2LT5kaXNwbGF5LmF1ZGlvX2NvZGVjX2Rpc2FibGUpCj4gLQkJZGV2X3ByaXYt
PmRpc3BsYXkuYXVkaW9fY29kZWNfZGlzYWJsZShlbmNvZGVyLAo+ICsJaWYgKGk5MTUtPmRpc3Bs
YXkuYXVkaW9fY29kZWNfZGlzYWJsZSkKPiArCQlpOTE1LT5kaXNwbGF5LmF1ZGlvX2NvZGVjX2Rp
c2FibGUoZW5jb2RlciwKPiAgIAkJCQkJCSAgICAgIG9sZF9jcnRjX3N0YXRlLAo+ICAgCQkJCQkJ
ICAgICAgb2xkX2Nvbm5fc3RhdGUpOwo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+YXZf
bXV0ZXgpOwo+ICsJbXV0ZXhfbG9jaygmaTkxNS0+YXZfbXV0ZXgpOwo+ICAgCWVuY29kZXItPmF1
ZGlvX2Nvbm5lY3RvciA9IE5VTEw7Cj4gLQlkZXZfcHJpdi0+YXZfZW5jX21hcFtwaXBlXSA9IE5V
TEw7Cj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5hdl9tdXRleCk7Cj4gKwlpOTE1LT5hdl9l
bmNfbWFwW3BpcGVdID0gTlVMTDsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+YXZfbXV0ZXgpOwo+
ICAgCj4gICAJaWYgKGFjb21wICYmIGFjb21wLT5iYXNlLmF1ZGlvX29wcyAmJgo+ICAgCSAgICBh
Y29tcC0+YmFzZS5hdWRpb19vcHMtPnBpbl9lbGRfbm90aWZ5KSB7Cj4gQEAgLTcxOCwzMSArNzE4
LDMxIEBAIHZvaWQgaW50ZWxfYXVkaW9fY29kZWNfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiAgIAkJCQkJCSAoaW50KSBwb3J0LCAoaW50KSBwaXBlKTsKPiAgIAl9Cj4g
ICAKPiAtCWludGVsX2xwZV9hdWRpb19ub3RpZnkoZGV2X3ByaXYsIHBpcGUsIHBvcnQsIE5VTEws
IDAsIGZhbHNlKTsKPiArCWludGVsX2xwZV9hdWRpb19ub3RpZnkoaTkxNSwgcGlwZSwgcG9ydCwg
TlVMTCwgMCwgZmFsc2UpOwo+ICAgfQo+ICAgCj4gICAvKioKPiAgICAqIGludGVsX2luaXRfYXVk
aW9faG9va3MgLSBTZXQgdXAgY2hpcCBzcGVjaWZpYyBhdWRpbyBob29rcwo+IC0gKiBAZGV2X3By
aXY6IGRldmljZSBwcml2YXRlCj4gKyAqIEBpOTE1OiBkZXZpY2UgcHJpdmF0ZQo+ICAgICovCj4g
LXZvaWQgaW50ZWxfaW5pdF9hdWRpb19ob29rcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gK3ZvaWQgaW50ZWxfaW5pdF9hdWRpb19ob29rcyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiAgIHsKPiAtCWlmIChJU19HNFgoZGV2X3ByaXYpKSB7Cj4gLQkJZGV2X3By
aXYtPmRpc3BsYXkuYXVkaW9fY29kZWNfZW5hYmxlID0gZzR4X2F1ZGlvX2NvZGVjX2VuYWJsZTsK
PiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5hdWRpb19jb2RlY19kaXNhYmxlID0gZzR4X2F1ZGlvX2Nv
ZGVjX2Rpc2FibGU7Cj4gLQl9IGVsc2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElT
X0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuYXVkaW9fY29k
ZWNfZW5hYmxlID0gaWxrX2F1ZGlvX2NvZGVjX2VuYWJsZTsKPiAtCQlkZXZfcHJpdi0+ZGlzcGxh
eS5hdWRpb19jb2RlY19kaXNhYmxlID0gaWxrX2F1ZGlvX2NvZGVjX2Rpc2FibGU7Cj4gLQl9IGVs
c2UgaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElOVEVMX0dFTihkZXZfcHJpdikgPj0gOCkg
ewo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmF1ZGlvX2NvZGVjX2VuYWJsZSA9IGhzd19hdWRpb19j
b2RlY19lbmFibGU7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuYXVkaW9fY29kZWNfZGlzYWJsZSA9
IGhzd19hdWRpb19jb2RlY19kaXNhYmxlOwo+IC0JfSBlbHNlIGlmIChIQVNfUENIX1NQTElUKGRl
dl9wcml2KSkgewo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmF1ZGlvX2NvZGVjX2VuYWJsZSA9IGls
a19hdWRpb19jb2RlY19lbmFibGU7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuYXVkaW9fY29kZWNf
ZGlzYWJsZSA9IGlsa19hdWRpb19jb2RlY19kaXNhYmxlOwo+ICsJaWYgKElTX0c0WChpOTE1KSkg
ewo+ICsJCWk5MTUtPmRpc3BsYXkuYXVkaW9fY29kZWNfZW5hYmxlID0gZzR4X2F1ZGlvX2NvZGVj
X2VuYWJsZTsKPiArCQlpOTE1LT5kaXNwbGF5LmF1ZGlvX2NvZGVjX2Rpc2FibGUgPSBnNHhfYXVk
aW9fY29kZWNfZGlzYWJsZTsKPiArCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJ
U19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gKwkJaTkxNS0+ZGlzcGxheS5hdWRpb19jb2RlY19lbmFi
bGUgPSBpbGtfYXVkaW9fY29kZWNfZW5hYmxlOwo+ICsJCWk5MTUtPmRpc3BsYXkuYXVkaW9fY29k
ZWNfZGlzYWJsZSA9IGlsa19hdWRpb19jb2RlY19kaXNhYmxlOwo+ICsJfSBlbHNlIGlmIChJU19I
QVNXRUxMKGk5MTUpIHx8IElOVEVMX0dFTihpOTE1KSA+PSA4KSB7Cj4gKwkJaTkxNS0+ZGlzcGxh
eS5hdWRpb19jb2RlY19lbmFibGUgPSBoc3dfYXVkaW9fY29kZWNfZW5hYmxlOwo+ICsJCWk5MTUt
PmRpc3BsYXkuYXVkaW9fY29kZWNfZGlzYWJsZSA9IGhzd19hdWRpb19jb2RlY19kaXNhYmxlOwo+
ICsJfSBlbHNlIGlmIChIQVNfUENIX1NQTElUKGk5MTUpKSB7Cj4gKwkJaTkxNS0+ZGlzcGxheS5h
dWRpb19jb2RlY19lbmFibGUgPSBpbGtfYXVkaW9fY29kZWNfZW5hYmxlOwo+ICsJCWk5MTUtPmRp
c3BsYXkuYXVkaW9fY29kZWNfZGlzYWJsZSA9IGlsa19hdWRpb19jb2RlY19kaXNhYmxlOwo+ICAg
CX0KPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBnbGtfZm9yY2VfYXVkaW9fY2RjbGsoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBnbGtfZm9yY2VfYXVk
aW9fY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICBib29sIGVu
YWJsZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX21vZGVzZXRfYWNxdWlyZV9jdHggY3R4Owo+IEBA
IC03NTAsNyArNzUwLDcgQEAgc3RhdGljIHZvaWQgZ2xrX2ZvcmNlX2F1ZGlvX2NkY2xrKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlpbnQgcmV0Owo+ICAgCj4gICAJZHJt
X21vZGVzZXRfYWNxdWlyZV9pbml0KCZjdHgsIDApOwo+IC0Jc3RhdGUgPSBkcm1fYXRvbWljX3N0
YXRlX2FsbG9jKCZkZXZfcHJpdi0+ZHJtKTsKPiArCXN0YXRlID0gZHJtX2F0b21pY19zdGF0ZV9h
bGxvYygmaTkxNS0+ZHJtKTsKPiAgIAlpZiAoV0FSTl9PTighc3RhdGUpKQo+ICAgCQlyZXR1cm47
Cj4gICAKPiBAQCAtNzYyLDExICs3NjIsMTEgQEAgc3RhdGljIHZvaWQgZ2xrX2ZvcmNlX2F1ZGlv
X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkJZW5hYmxlID8g
MiAqIDk2MDAwIDogMDsKPiAgIAo+ICAgCS8qCj4gLQkgKiBQcm90ZWN0cyBkZXZfcHJpdi0+Y2Rj
bGsuZm9yY2VfbWluX2NkY2xrCj4gKwkgKiBQcm90ZWN0cyBpOTE1LT5jZGNsay5mb3JjZV9taW5f
Y2RjbGsKPiAgIAkgKiBOZWVkIHRvIGxvY2sgdGhpcyBoZXJlIGluIGNhc2Ugd2UgaGF2ZSBubyBh
Y3RpdmUgcGlwZXMKPiAgIAkgKiBhbmQgdGh1cyB3b3VsZG4ndCBsb2NrIGl0IGR1cmluZyB0aGUg
Y29tbWl0IG90aGVyd2lzZS4KPiAgIAkgKi8KPiAtCXJldCA9IGRybV9tb2Rlc2V0X2xvY2soJmRl
dl9wcml2LT5kcm0ubW9kZV9jb25maWcuY29ubmVjdGlvbl9tdXRleCwKPiArCXJldCA9IGRybV9t
b2Rlc2V0X2xvY2soJmk5MTUtPmRybS5tb2RlX2NvbmZpZy5jb25uZWN0aW9uX211dGV4LAo+ICAg
CQkJICAgICAgICZjdHgpOwo+ICAgCWlmICghcmV0KQo+ICAgCQlyZXQgPSBkcm1fYXRvbWljX2Nv
bW1pdChzdGF0ZSk7Cj4gQEAgLTc4NywxOCArNzg3LDE4IEBAIHN0YXRpYyB2b2lkIGdsa19mb3Jj
ZV9hdWRpb19jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAKPiAg
IHN0YXRpYyB1bnNpZ25lZCBsb25nIGk5MTVfYXVkaW9fY29tcG9uZW50X2dldF9wb3dlcihzdHJ1
Y3QgZGV2aWNlICprZGV2KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0ga2Rldl90b19pOTE1KGtkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSBrZGV2X3RvX2k5MTUoa2Rldik7Cj4gICAJaW50ZWxfd2FrZXJlZl90IHJldDsKPiAgIAo+
ICAgCS8qIENhdGNoIHBvdGVudGlhbCBpbXBlZGFuY2UgbWlzbWF0Y2hlcyBiZWZvcmUgdGhleSBv
Y2N1ciEgKi8KPiAgIAlCVUlMRF9CVUdfT04oc2l6ZW9mKGludGVsX3dha2VyZWZfdCkgPiBzaXpl
b2YodW5zaWduZWQgbG9uZykpOwo+ICAgCj4gLQlyZXQgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dl
dChkZXZfcHJpdiwgUE9XRVJfRE9NQUlOX0FVRElPKTsKPiArCXJldCA9IGludGVsX2Rpc3BsYXlf
cG93ZXJfZ2V0KGk5MTUsIFBPV0VSX0RPTUFJTl9BVURJTyk7Cj4gICAKPiAgIAkvKiBGb3JjZSBD
RENMSyB0byAyKkJDTEsgYXMgbG9uZyBhcyB3ZSBuZWVkIGF1ZGlvIHRvIGJlIHBvd2VyZWQuICov
Cj4gLQlpZiAoZGV2X3ByaXYtPmF1ZGlvX3Bvd2VyX3JlZmNvdW50KysgPT0gMCkKPiAtCQlpZiAo
SVNfQ0FOTk9OTEFLRShkZXZfcHJpdikgfHwgSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpCj4gLQkJ
CWdsa19mb3JjZV9hdWRpb19jZGNsayhkZXZfcHJpdiwgdHJ1ZSk7Cj4gKwlpZiAoaTkxNS0+YXVk
aW9fcG93ZXJfcmVmY291bnQrKyA9PSAwKQo+ICsJCWlmIChJU19DQU5OT05MQUtFKGk5MTUpIHx8
IElTX0dFTUlOSUxBS0UoaTkxNSkpCj4gKwkJCWdsa19mb3JjZV9hdWRpb19jZGNsayhpOTE1LCB0
cnVlKTsKPiAgIAo+ICAgCXJldHVybiByZXQ7Cj4gICB9Cj4gQEAgLTgwNiwyNCArODA2LDI0IEBA
IHN0YXRpYyB1bnNpZ25lZCBsb25nIGk5MTVfYXVkaW9fY29tcG9uZW50X2dldF9wb3dlcihzdHJ1
Y3QgZGV2aWNlICprZGV2KQo+ICAgc3RhdGljIHZvaWQgaTkxNV9hdWRpb19jb21wb25lbnRfcHV0
X3Bvd2VyKHN0cnVjdCBkZXZpY2UgKmtkZXYsCj4gICAJCQkJCSAgIHVuc2lnbmVkIGxvbmcgY29v
a2llKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0ga2Rldl90
b19pOTE1KGtkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBrZGV2X3Rv
X2k5MTUoa2Rldik7Cj4gICAKPiAgIAkvKiBTdG9wIGZvcmNpbmcgQ0RDTEsgdG8gMipCQ0xLIGlm
IG5vIG5lZWQgZm9yIGF1ZGlvIHRvIGJlIHBvd2VyZWQuICovCj4gLQlpZiAoLS1kZXZfcHJpdi0+
YXVkaW9fcG93ZXJfcmVmY291bnQgPT0gMCkKPiAtCQlpZiAoSVNfQ0FOTk9OTEFLRShkZXZfcHJp
dikgfHwgSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpCj4gLQkJCWdsa19mb3JjZV9hdWRpb19jZGNs
ayhkZXZfcHJpdiwgZmFsc2UpOwo+ICsJaWYgKC0taTkxNS0+YXVkaW9fcG93ZXJfcmVmY291bnQg
PT0gMCkKPiArCQlpZiAoSVNfQ0FOTk9OTEFLRShpOTE1KSB8fCBJU19HRU1JTklMQUtFKGk5MTUp
KQo+ICsJCQlnbGtfZm9yY2VfYXVkaW9fY2RjbGsoaTkxNSwgZmFsc2UpOwo+ICAgCj4gLQlpbnRl
bF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwgUE9XRVJfRE9NQUlOX0FVRElPLCBjb29raWUp
Owo+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgUE9XRVJfRE9NQUlOX0FVRElPLCBj
b29raWUpOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZCBpOTE1X2F1ZGlvX2NvbXBvbmVudF9j
b2RlY193YWtlX292ZXJyaWRlKHN0cnVjdCBkZXZpY2UgKmtkZXYsCj4gICAJCQkJCQkgICAgIGJv
b2wgZW5hYmxlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
a2Rldl90b19pOTE1KGtkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBr
ZGV2X3RvX2k5MTUoa2Rldik7Cj4gICAJdW5zaWduZWQgbG9uZyBjb29raWU7Cj4gICAJdTMyIHRt
cDsKPiAgIAo+IC0JaWYgKCFJU19HRU4oZGV2X3ByaXYsIDkpKQo+ICsJaWYgKCFJU19HRU4oaTkx
NSwgOSkpCj4gICAJCXJldHVybjsKPiAgIAo+ICAgCWNvb2tpZSA9IGk5MTVfYXVkaW9fY29tcG9u
ZW50X2dldF9wb3dlcihrZGV2KTsKPiBAQCAtODUwLDEyICs4NTAsMTIgQEAgc3RhdGljIHZvaWQg
aTkxNV9hdWRpb19jb21wb25lbnRfY29kZWNfd2FrZV9vdmVycmlkZShzdHJ1Y3QgZGV2aWNlICpr
ZGV2LAo+ICAgLyogR2V0IENEQ0xLIGluIGtIeiAgKi8KPiAgIHN0YXRpYyBpbnQgaTkxNV9hdWRp
b19jb21wb25lbnRfZ2V0X2NkY2xrX2ZyZXEoc3RydWN0IGRldmljZSAqa2RldikKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGtkZXZfdG9faTkxNShrZGV2KTsK
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0ga2Rldl90b19pOTE1KGtkZXYpOwo+
ICAgCj4gLQlpZiAoV0FSTl9PTl9PTkNFKCFIQVNfRERJKGRldl9wcml2KSkpCj4gKwlpZiAoV0FS
Tl9PTl9PTkNFKCFIQVNfRERJKGk5MTUpKSkKPiAgIAkJcmV0dXJuIC1FTk9ERVY7Cj4gICAKPiAt
CXJldHVybiBkZXZfcHJpdi0+Y2RjbGsuaHcuY2RjbGs7Cj4gKwlyZXR1cm4gaTkxNS0+Y2RjbGsu
aHcuY2RjbGs7Cj4gICB9Cj4gICAKPiAgIC8qCj4gQEAgLTg2OCwxNyArODY4LDE3IEBAIHN0YXRp
YyBpbnQgaTkxNV9hdWRpb19jb21wb25lbnRfZ2V0X2NkY2xrX2ZyZXEoc3RydWN0IGRldmljZSAq
a2RldikKPiAgICAqICAgd2lsbCBnZXQgdGhlIHJpZ2h0IGludGVsX2VuY29kZXIgd2l0aCBwb3J0
IG1hdGNoZWQKPiAgICAqIE5vbi1NU1QgJiAocGlwZSA8IDApOiBnZXQgdGhlIHJpZ2h0IGludGVs
X2VuY29kZXIgd2l0aCBwb3J0IG1hdGNoZWQKPiAgICAqLwo+IC1zdGF0aWMgc3RydWN0IGludGVs
X2VuY29kZXIgKmdldF9zYXZlZF9lbmMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ICtzdGF0aWMgc3RydWN0IGludGVsX2VuY29kZXIgKmdldF9zYXZlZF9lbmMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJCSAgICAgICBpbnQgcG9ydCwgaW50IHBpcGUp
Cj4gICB7Cj4gICAJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXI7Cj4gICAKPiAgIAkvKiBN
U1QgKi8KPiAgIAlpZiAocGlwZSA+PSAwKSB7Cj4gLQkJaWYgKFdBUk5fT04ocGlwZSA+PSBBUlJB
WV9TSVpFKGRldl9wcml2LT5hdl9lbmNfbWFwKSkpCj4gKwkJaWYgKFdBUk5fT04ocGlwZSA+PSBB
UlJBWV9TSVpFKGk5MTUtPmF2X2VuY19tYXApKSkKPiAgIAkJCXJldHVybiBOVUxMOwo+ICAgCj4g
LQkJZW5jb2RlciA9IGRldl9wcml2LT5hdl9lbmNfbWFwW3BpcGVdOwo+ICsJCWVuY29kZXIgPSBp
OTE1LT5hdl9lbmNfbWFwW3BpcGVdOwo+ICAgCQkvKgo+ICAgCQkgKiB3aGVuIGJvb3R1cCwgYXVk
aW8gZHJpdmVyIG1heSBub3Qga25vdyBpdCBpcwo+ICAgCQkgKiBNU1Qgb3Igbm90LiBTbyBpdCB3
aWxsIHBvbGwgYWxsIHRoZSBwb3J0ICYgcGlwZQo+IEBAIC04OTMsOCArODkzLDggQEAgc3RhdGlj
IHN0cnVjdCBpbnRlbF9lbmNvZGVyICpnZXRfc2F2ZWRfZW5jKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiAgIAlpZiAocGlwZSA+IDApCj4gICAJCXJldHVybiBOVUxMOwo+ICAg
Cj4gLQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKSB7Cj4gLQkJZW5jb2RlciA9IGRldl9w
cml2LT5hdl9lbmNfbWFwW3BpcGVdOwo+ICsJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKSB7Cj4g
KwkJZW5jb2RlciA9IGk5MTUtPmF2X2VuY19tYXBbcGlwZV07Cj4gICAJCWlmIChlbmNvZGVyID09
IE5VTEwpCj4gICAJCQljb250aW51ZTsKPiAgIAo+IEBAIC05MTEsMjEgKzkxMSwyMSBAQCBzdGF0
aWMgc3RydWN0IGludGVsX2VuY29kZXIgKmdldF9zYXZlZF9lbmMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ICAgc3RhdGljIGludCBpOTE1X2F1ZGlvX2NvbXBvbmVudF9zeW5j
X2F1ZGlvX3JhdGUoc3RydWN0IGRldmljZSAqa2RldiwgaW50IHBvcnQsCj4gICAJCQkJCQlpbnQg
cGlwZSwgaW50IHJhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSBrZGV2X3RvX2k5MTUoa2Rldik7Cj4gLQlzdHJ1Y3QgaTkxNV9hdWRpb19jb21wb25lbnQg
KmFjb21wID0gZGV2X3ByaXYtPmF1ZGlvX2NvbXBvbmVudDsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0ga2Rldl90b19pOTE1KGtkZXYpOwo+ICsJc3RydWN0IGk5MTVfYXVkaW9f
Y29tcG9uZW50ICphY29tcCA9IGk5MTUtPmF1ZGlvX2NvbXBvbmVudDsKPiAgIAlzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlcjsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsKPiAgIAl1
bnNpZ25lZCBsb25nIGNvb2tpZTsKPiAgIAlpbnQgZXJyID0gMDsKPiAgIAo+IC0JaWYgKCFIQVNf
RERJKGRldl9wcml2KSkKPiArCWlmICghSEFTX0RESShpOTE1KSkKPiAgIAkJcmV0dXJuIDA7Cj4g
ICAKPiAgIAljb29raWUgPSBpOTE1X2F1ZGlvX2NvbXBvbmVudF9nZXRfcG93ZXIoa2Rldik7Cj4g
LQltdXRleF9sb2NrKCZkZXZfcHJpdi0+YXZfbXV0ZXgpOwo+ICsJbXV0ZXhfbG9jaygmaTkxNS0+
YXZfbXV0ZXgpOwo+ICAgCj4gICAJLyogMS4gZ2V0IHRoZSBwaXBlICovCj4gLQllbmNvZGVyID0g
Z2V0X3NhdmVkX2VuYyhkZXZfcHJpdiwgcG9ydCwgcGlwZSk7Cj4gKwllbmNvZGVyID0gZ2V0X3Nh
dmVkX2VuYyhpOTE1LCBwb3J0LCBwaXBlKTsKPiAgIAlpZiAoIWVuY29kZXIgfHwgIWVuY29kZXIt
PmJhc2UuY3J0Yykgewo+ICAgCQlEUk1fREVCVUdfS01TKCJOb3QgdmFsaWQgZm9yIHBvcnQgJWNc
biIsIHBvcnRfbmFtZShwb3J0KSk7Cj4gICAJCWVyciA9IC1FTk9ERVY7Cj4gQEAgLTk0MCw3ICs5
NDAsNyBAQCBzdGF0aWMgaW50IGk5MTVfYXVkaW9fY29tcG9uZW50X3N5bmNfYXVkaW9fcmF0ZShz
dHJ1Y3QgZGV2aWNlICprZGV2LCBpbnQgcG9ydCwKPiAgIAloc3dfYXVkaW9fY29uZmlnX3VwZGF0
ZShlbmNvZGVyLCBjcnRjLT5jb25maWcpOwo+ICAgCj4gICAgdW5sb2NrOgo+IC0JbXV0ZXhfdW5s
b2NrKCZkZXZfcHJpdi0+YXZfbXV0ZXgpOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5hdl9tdXRl
eCk7Cj4gICAJaTkxNV9hdWRpb19jb21wb25lbnRfcHV0X3Bvd2VyKGtkZXYsIGNvb2tpZSk7Cj4g
ICAJcmV0dXJuIGVycjsKPiAgIH0KPiBAQCAtOTQ5LDE3ICs5NDksMTcgQEAgc3RhdGljIGludCBp
OTE1X2F1ZGlvX2NvbXBvbmVudF9nZXRfZWxkKHN0cnVjdCBkZXZpY2UgKmtkZXYsIGludCBwb3J0
LAo+ICAgCQkJCQlpbnQgcGlwZSwgYm9vbCAqZW5hYmxlZCwKPiAgIAkJCQkJdW5zaWduZWQgY2hh
ciAqYnVmLCBpbnQgbWF4X2J5dGVzKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0ga2Rldl90b19pOTE1KGtkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSBrZGV2X3RvX2k5MTUoa2Rldik7Cj4gICAJc3RydWN0IGludGVsX2VuY29kZXIg
KmludGVsX2VuY29kZXI7Cj4gICAJY29uc3QgdTggKmVsZDsKPiAgIAlpbnQgcmV0ID0gLUVJTlZB
TDsKPiAgIAo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmF2X211dGV4KTsKPiArCW11dGV4X2xv
Y2soJmk5MTUtPmF2X211dGV4KTsKPiAgIAo+IC0JaW50ZWxfZW5jb2RlciA9IGdldF9zYXZlZF9l
bmMoZGV2X3ByaXYsIHBvcnQsIHBpcGUpOwo+ICsJaW50ZWxfZW5jb2RlciA9IGdldF9zYXZlZF9l
bmMoaTkxNSwgcG9ydCwgcGlwZSk7Cj4gICAJaWYgKCFpbnRlbF9lbmNvZGVyKSB7Cj4gICAJCURS
TV9ERUJVR19LTVMoIk5vdCB2YWxpZCBmb3IgcG9ydCAlY1xuIiwgcG9ydF9uYW1lKHBvcnQpKTsK
PiAtCQltdXRleF91bmxvY2soJmRldl9wcml2LT5hdl9tdXRleCk7Cj4gKwkJbXV0ZXhfdW5sb2Nr
KCZpOTE1LT5hdl9tdXRleCk7Cj4gICAJCXJldHVybiByZXQ7Cj4gICAJfQo+ICAgCj4gQEAgLTk3
MSw3ICs5NzEsNyBAQCBzdGF0aWMgaW50IGk5MTVfYXVkaW9fY29tcG9uZW50X2dldF9lbGQoc3Ry
dWN0IGRldmljZSAqa2RldiwgaW50IHBvcnQsCj4gICAJCW1lbWNweShidWYsIGVsZCwgbWluKG1h
eF9ieXRlcywgcmV0KSk7Cj4gICAJfQo+ICAgCj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5h
dl9tdXRleCk7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPmF2X211dGV4KTsKPiAgIAlyZXR1cm4g
cmV0Owo+ICAgfQo+ICAgCj4gQEAgLTk4OSw3ICs5ODksNyBAQCBzdGF0aWMgaW50IGk5MTVfYXVk
aW9fY29tcG9uZW50X2JpbmQoc3RydWN0IGRldmljZSAqaTkxNV9rZGV2LAo+ICAgCQkJCSAgICAg
c3RydWN0IGRldmljZSAqaGRhX2tkZXYsIHZvaWQgKmRhdGEpCj4gICB7Cj4gICAJc3RydWN0IGk5
MTVfYXVkaW9fY29tcG9uZW50ICphY29tcCA9IGRhdGE7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSBrZGV2X3RvX2k5MTUoaTkxNV9rZGV2KTsKPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0ga2Rldl90b19pOTE1KGk5MTVfa2Rldik7Cj4gICAJaW50IGk7
Cj4gICAKPiAgIAlpZiAoV0FSTl9PTihhY29tcC0+YmFzZS5vcHMgfHwgYWNvbXAtPmJhc2UuZGV2
KSkKPiBAQCAtOTk4LDE0ICs5OTgsMTQgQEAgc3RhdGljIGludCBpOTE1X2F1ZGlvX2NvbXBvbmVu
dF9iaW5kKHN0cnVjdCBkZXZpY2UgKmk5MTVfa2RldiwKPiAgIAlpZiAoV0FSTl9PTighZGV2aWNl
X2xpbmtfYWRkKGhkYV9rZGV2LCBpOTE1X2tkZXYsIERMX0ZMQUdfU1RBVEVMRVNTKSkpCj4gICAJ
CXJldHVybiAtRU5PTUVNOwo+ICAgCj4gLQlkcm1fbW9kZXNldF9sb2NrX2FsbCgmZGV2X3ByaXYt
PmRybSk7Cj4gKwlkcm1fbW9kZXNldF9sb2NrX2FsbCgmaTkxNS0+ZHJtKTsKPiAgIAlhY29tcC0+
YmFzZS5vcHMgPSAmaTkxNV9hdWRpb19jb21wb25lbnRfb3BzOwo+ICAgCWFjb21wLT5iYXNlLmRl
diA9IGk5MTVfa2RldjsKPiAgIAlCVUlMRF9CVUdfT04oTUFYX1BPUlRTICE9IEk5MTVfTUFYX1BP
UlRTKTsKPiAgIAlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShhY29tcC0+YXVkX3NhbXBsZV9y
YXRlKTsgaSsrKQo+ICAgCQlhY29tcC0+YXVkX3NhbXBsZV9yYXRlW2ldID0gMDsKPiAtCWRldl9w
cml2LT5hdWRpb19jb21wb25lbnQgPSBhY29tcDsKPiAtCWRybV9tb2Rlc2V0X3VubG9ja19hbGwo
JmRldl9wcml2LT5kcm0pOwo+ICsJaTkxNS0+YXVkaW9fY29tcG9uZW50ID0gYWNvbXA7Cj4gKwlk
cm1fbW9kZXNldF91bmxvY2tfYWxsKCZpOTE1LT5kcm0pOwo+ICAgCj4gICAJcmV0dXJuIDA7Cj4g
ICB9Cj4gQEAgLTEwMTQsMTMgKzEwMTQsMTMgQEAgc3RhdGljIHZvaWQgaTkxNV9hdWRpb19jb21w
b25lbnRfdW5iaW5kKHN0cnVjdCBkZXZpY2UgKmk5MTVfa2RldiwKPiAgIAkJCQkJc3RydWN0IGRl
dmljZSAqaGRhX2tkZXYsIHZvaWQgKmRhdGEpCj4gICB7Cj4gICAJc3RydWN0IGk5MTVfYXVkaW9f
Y29tcG9uZW50ICphY29tcCA9IGRhdGE7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSBrZGV2X3RvX2k5MTUoaTkxNV9rZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0ga2Rldl90b19pOTE1KGk5MTVfa2Rldik7Cj4gICAKPiAtCWRybV9tb2Rlc2V0
X2xvY2tfYWxsKCZkZXZfcHJpdi0+ZHJtKTsKPiArCWRybV9tb2Rlc2V0X2xvY2tfYWxsKCZpOTE1
LT5kcm0pOwo+ICAgCWFjb21wLT5iYXNlLm9wcyA9IE5VTEw7Cj4gICAJYWNvbXAtPmJhc2UuZGV2
ID0gTlVMTDsKPiAtCWRldl9wcml2LT5hdWRpb19jb21wb25lbnQgPSBOVUxMOwo+IC0JZHJtX21v
ZGVzZXRfdW5sb2NrX2FsbCgmZGV2X3ByaXYtPmRybSk7Cj4gKwlpOTE1LT5hdWRpb19jb21wb25l
bnQgPSBOVUxMOwo+ICsJZHJtX21vZGVzZXRfdW5sb2NrX2FsbCgmaTkxNS0+ZHJtKTsKPiAgIAo+
ICAgCWRldmljZV9saW5rX3JlbW92ZShoZGFfa2RldiwgaTkxNV9rZGV2KTsKPiAgIH0KPiBAQCAt
MTAzMiw3ICsxMDMyLDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBjb21wb25lbnRfb3BzIGk5MTVf
YXVkaW9fY29tcG9uZW50X2JpbmRfb3BzID0gewo+ICAgCj4gICAvKioKPiAgICAqIGk5MTVfYXVk
aW9fY29tcG9uZW50X2luaXQgLSBpbml0aWFsaXplIGFuZCByZWdpc3RlciB0aGUgYXVkaW8gY29t
cG9uZW50Cj4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiArICogQGk5MTU6
IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gICAgKgo+ICAgICogVGhpcyB3aWxsIHJlZ2lzdGVyIHdp
dGggdGhlIGNvbXBvbmVudCBmcmFtZXdvcmsgYSBjaGlsZCBjb21wb25lbnQgd2hpY2gKPiAgICAq
IHdpbGwgYmluZCBkeW5hbWljYWxseSB0byB0aGUgc25kX2hkYV9pbnRlbCBkcml2ZXIncyBjb3Jy
ZXNwb25kaW5nIG1hc3Rlcgo+IEBAIC0xMDQ2LDExICsxMDQ2LDExIEBAIHN0YXRpYyBjb25zdCBz
dHJ1Y3QgY29tcG9uZW50X29wcyBpOTE1X2F1ZGlvX2NvbXBvbmVudF9iaW5kX29wcyA9IHsKPiAg
ICAqIFdlIGlnbm9yZSBhbnkgZXJyb3IgZHVyaW5nIHJlZ2lzdHJhdGlvbiBhbmQgY29udGludWUg
d2l0aCByZWR1Y2VkCj4gICAgKiBmdW5jdGlvbmFsaXR5IChpLmUuIHdpdGhvdXQgSERNSSBhdWRp
bykuCj4gICAgKi8KPiAtc3RhdGljIHZvaWQgaTkxNV9hdWRpb19jb21wb25lbnRfaW5pdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGk5MTVfYXVkaW9f
Y29tcG9uZW50X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJ
aW50IHJldDsKPiAgIAo+IC0JcmV0ID0gY29tcG9uZW50X2FkZF90eXBlZChkZXZfcHJpdi0+ZHJt
LmRldiwKPiArCXJldCA9IGNvbXBvbmVudF9hZGRfdHlwZWQoaTkxNS0+ZHJtLmRldiwKPiAgIAkJ
CQkgICZpOTE1X2F1ZGlvX2NvbXBvbmVudF9iaW5kX29wcywKPiAgIAkJCQkgIEk5MTVfQ09NUE9O
RU5UX0FVRElPKTsKPiAgIAlpZiAocmV0IDwgMCkgewo+IEBAIC0xMDU5LDQ2ICsxMDU5LDQ2IEBA
IHN0YXRpYyB2b2lkIGk5MTVfYXVkaW9fY29tcG9uZW50X2luaXQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ICAgCQlyZXR1cm47Cj4gICAJfQo+ICAgCj4gLQlkZXZfcHJpdi0+
YXVkaW9fY29tcG9uZW50X3JlZ2lzdGVyZWQgPSB0cnVlOwo+ICsJaTkxNS0+YXVkaW9fY29tcG9u
ZW50X3JlZ2lzdGVyZWQgPSB0cnVlOwo+ICAgfQo+ICAgCj4gICAvKioKPiAgICAqIGk5MTVfYXVk
aW9fY29tcG9uZW50X2NsZWFudXAgLSBkZXJlZ2lzdGVyIHRoZSBhdWRpbyBjb21wb25lbnQKPiAt
ICogQGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ICsgKiBAaTkxNTogaTkxNSBkZXZp
Y2UgaW5zdGFuY2UKPiAgICAqCj4gICAgKiBEZXJlZ2lzdGVycyB0aGUgYXVkaW8gY29tcG9uZW50
LCBicmVha2luZyBhbnkgZXhpc3RpbmcgYmluZGluZyB0byB0aGUKPiAgICAqIGNvcnJlc3BvbmRp
bmcgc25kX2hkYV9pbnRlbCBkcml2ZXIncyBtYXN0ZXIgY29tcG9uZW50Lgo+ICAgICovCj4gLXN0
YXRpYyB2b2lkIGk5MTVfYXVkaW9fY29tcG9uZW50X2NsZWFudXAoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBpOTE1X2F1ZGlvX2NvbXBvbmVudF9jbGVh
bnVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JaWYgKCFkZXZfcHJp
di0+YXVkaW9fY29tcG9uZW50X3JlZ2lzdGVyZWQpCj4gKwlpZiAoIWk5MTUtPmF1ZGlvX2NvbXBv
bmVudF9yZWdpc3RlcmVkKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCWNvbXBvbmVudF9kZWwoZGV2
X3ByaXYtPmRybS5kZXYsICZpOTE1X2F1ZGlvX2NvbXBvbmVudF9iaW5kX29wcyk7Cj4gLQlkZXZf
cHJpdi0+YXVkaW9fY29tcG9uZW50X3JlZ2lzdGVyZWQgPSBmYWxzZTsKPiArCWNvbXBvbmVudF9k
ZWwoaTkxNS0+ZHJtLmRldiwgJmk5MTVfYXVkaW9fY29tcG9uZW50X2JpbmRfb3BzKTsKPiArCWk5
MTUtPmF1ZGlvX2NvbXBvbmVudF9yZWdpc3RlcmVkID0gZmFsc2U7Cj4gICB9Cj4gICAKPiAgIC8q
Kgo+ICAgICogaW50ZWxfYXVkaW9faW5pdCgpIC0gSW5pdGlhbGl6ZSB0aGUgYXVkaW8gZHJpdmVy
IGVpdGhlciB1c2luZwo+ICAgICogY29tcG9uZW50IGZyYW1ld29yayBvciB1c2luZyBscGUgYXVk
aW8gYnJpZGdlCj4gLSAqIEBkZXZfcHJpdjogdGhlIGk5MTUgZHJtIGRldmljZSBwcml2YXRlIGRh
dGEKPiArICogQGk5MTU6IHRoZSBpOTE1IGRybSBkZXZpY2UgcHJpdmF0ZSBkYXRhCj4gICAgKgo+
ICAgICovCj4gLXZvaWQgaW50ZWxfYXVkaW9faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gK3ZvaWQgaW50ZWxfYXVkaW9faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKPiAgIHsKPiAtCWlmIChpbnRlbF9scGVfYXVkaW9faW5pdChkZXZfcHJpdikgPCAw
KQo+IC0JCWk5MTVfYXVkaW9fY29tcG9uZW50X2luaXQoZGV2X3ByaXYpOwo+ICsJaWYgKGludGVs
X2xwZV9hdWRpb19pbml0KGk5MTUpIDwgMCkKPiArCQlpOTE1X2F1ZGlvX2NvbXBvbmVudF9pbml0
KGk5MTUpOwo+ICAgfQo+ICAgCj4gICAvKioKPiAgICAqIGludGVsX2F1ZGlvX2RlaW5pdCgpIC0g
ZGVpbml0aWFsaXplIHRoZSBhdWRpbyBkcml2ZXIKPiAtICogQGRldl9wcml2OiB0aGUgaTkxNSBk
cm0gZGV2aWNlIHByaXZhdGUgZGF0YQo+ICsgKiBAaTkxNTogdGhlIGk5MTUgZHJtIGRldmljZSBw
cml2YXRlIGRhdGEKPiAgICAqCj4gICAgKi8KPiAtdm9pZCBpbnRlbF9hdWRpb19kZWluaXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGludGVsX2F1ZGlvX2RlaW5p
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCWlmICgoZGV2X3ByaXYp
LT5scGVfYXVkaW8ucGxhdGRldiAhPSBOVUxMKQo+IC0JCWludGVsX2xwZV9hdWRpb190ZWFyZG93
bihkZXZfcHJpdik7Cj4gKwlpZiAoKGk5MTUpLT5scGVfYXVkaW8ucGxhdGRldiAhPSBOVUxMKQo+
ICsJCWludGVsX2xwZV9hdWRpb190ZWFyZG93bihpOTE1KTsKPiAgIAllbHNlCj4gLQkJaTkxNV9h
dWRpb19jb21wb25lbnRfY2xlYW51cChkZXZfcHJpdik7Cj4gKwkJaTkxNV9hdWRpb19jb21wb25l
bnRfY2xlYW51cChpOTE1KTsKPiAgIH0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfYXVkaW8uaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2F1ZGlvLmgKPiBp
bmRleCBhMzY1N2M3YTdiYTIuLmM4ZmRlNDJhOWZkZSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF9hdWRpby5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50
ZWxfYXVkaW8uaAo+IEBAIC0xMSwxNCArMTEsMTQgQEAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGU7
Cj4gICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZTsKPiAgIHN0cnVjdCBpbnRlbF9lbmNvZGVyOwo+
ICAgCj4gLXZvaWQgaW50ZWxfaW5pdF9hdWRpb19ob29rcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpOwo+ICt2b2lkIGludGVsX2luaXRfYXVkaW9faG9va3Moc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgdm9pZCBpbnRlbF9hdWRpb19jb2RlY19lbmFibGUoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBkcm1f
Y29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKTsKPiAgIHZvaWQgaW50ZWxfYXVkaW9fY29kZWNf
ZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCSAgICAgICBjb25z
dCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCj4gICAJCQkgICAgICAg
Y29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKm9sZF9jb25uX3N0YXRlKTsKPiAtdm9p
ZCBpbnRlbF9hdWRpb19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4g
LXZvaWQgaW50ZWxfYXVkaW9fZGVpbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dik7Cj4gK3ZvaWQgaW50ZWxfYXVkaW9faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSk7Cj4gK3ZvaWQgaW50ZWxfYXVkaW9fZGVpbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KTsKPiAgIAo+ICAgI2VuZGlmIC8qIF9fSU5URUxfQVVESU9fSF9fICovCj4gZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Jpb3MuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX2Jpb3MuYwo+IGluZGV4IDFjMDM3ZGZhODNmNS4uN2JkYWM1NWQwOGNjIDEwMDY0
NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Jpb3MuYwo+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX2Jpb3MuYwo+IEBAIC0yMDIsNyArMjAyLDcgQEAgZ2V0X2x2
ZHNfZnBfdGltaW5nKGNvbnN0IHN0cnVjdCBiZGJfaGVhZGVyICpiZGIsCj4gICAKPiAgIC8qIFRy
eSB0byBmaW5kIGludGVncmF0ZWQgcGFuZWwgZGF0YSAqLwo+ICAgc3RhdGljIHZvaWQKPiAtcGFy
c2VfbGZwX3BhbmVsX2RhdGEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtw
YXJzZV9sZnBfcGFuZWxfZGF0YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJ
ICAgICBjb25zdCBzdHJ1Y3QgYmRiX2hlYWRlciAqYmRiKQo+ICAgewo+ICAgCWNvbnN0IHN0cnVj
dCBiZGJfbHZkc19vcHRpb25zICpsdmRzX29wdGlvbnM7Cj4gQEAgLTIxOSw5ICsyMTksOSBAQCBw
YXJzZV9sZnBfcGFuZWxfZGF0YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
ICAJaWYgKCFsdmRzX29wdGlvbnMpCj4gICAJCXJldHVybjsKPiAgIAo+IC0JZGV2X3ByaXYtPnZi
dC5sdmRzX2RpdGhlciA9IGx2ZHNfb3B0aW9ucy0+cGl4ZWxfZGl0aGVyOwo+ICsJaTkxNS0+dmJ0
Lmx2ZHNfZGl0aGVyID0gbHZkc19vcHRpb25zLT5waXhlbF9kaXRoZXI7Cj4gICAKPiAtCXJldCA9
IGludGVsX29wcmVnaW9uX2dldF9wYW5lbF90eXBlKGRldl9wcml2KTsKPiArCXJldCA9IGludGVs
X29wcmVnaW9uX2dldF9wYW5lbF90eXBlKGk5MTUpOwo+ICAgCWlmIChyZXQgPj0gMCkgewo+ICAg
CQlXQVJOX09OKHJldCA+IDB4Zik7Cj4gICAJCXBhbmVsX3R5cGUgPSByZXQ7Cj4gQEAgLTIzNiw3
ICsyMzYsNyBAQCBwYXJzZV9sZnBfcGFuZWxfZGF0YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gICAJCURSTV9ERUJVR19LTVMoIlBhbmVsIHR5cGU6ICVkIChWQlQpXG4iLCBw
YW5lbF90eXBlKTsKPiAgIAl9Cj4gICAKPiAtCWRldl9wcml2LT52YnQucGFuZWxfdHlwZSA9IHBh
bmVsX3R5cGU7Cj4gKwlpOTE1LT52YnQucGFuZWxfdHlwZSA9IHBhbmVsX3R5cGU7Cj4gICAKPiAg
IAlkcnJzX21vZGUgPSAobHZkc19vcHRpb25zLT5kcHNfcGFuZWxfdHlwZV9iaXRzCj4gICAJCQkJ
Pj4gKHBhbmVsX3R5cGUgKiAyKSkgJiBNT0RFX01BU0s7Cj4gQEAgLTI0NywxNSArMjQ3LDE1IEBA
IHBhcnNlX2xmcF9wYW5lbF9kYXRhKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiAgIAkgKi8KPiAgIAlzd2l0Y2ggKGRycnNfbW9kZSkgewo+ICAgCWNhc2UgMDoKPiAtCQlkZXZf
cHJpdi0+dmJ0LmRycnNfdHlwZSA9IFNUQVRJQ19EUlJTX1NVUFBPUlQ7Cj4gKwkJaTkxNS0+dmJ0
LmRycnNfdHlwZSA9IFNUQVRJQ19EUlJTX1NVUFBPUlQ7Cj4gICAJCURSTV9ERUJVR19LTVMoIkRS
UlMgc3VwcG9ydGVkIG1vZGUgaXMgc3RhdGljXG4iKTsKPiAgIAkJYnJlYWs7Cj4gICAJY2FzZSAy
Ogo+IC0JCWRldl9wcml2LT52YnQuZHJyc190eXBlID0gU0VBTUxFU1NfRFJSU19TVVBQT1JUOwo+
ICsJCWk5MTUtPnZidC5kcnJzX3R5cGUgPSBTRUFNTEVTU19EUlJTX1NVUFBPUlQ7Cj4gICAJCURS
TV9ERUJVR19LTVMoIkRSUlMgc3VwcG9ydGVkIG1vZGUgaXMgc2VhbWxlc3NcbiIpOwo+ICAgCQli
cmVhazsKPiAgIAlkZWZhdWx0Ogo+IC0JCWRldl9wcml2LT52YnQuZHJyc190eXBlID0gRFJSU19O
T1RfU1VQUE9SVEVEOwo+ICsJCWk5MTUtPnZidC5kcnJzX3R5cGUgPSBEUlJTX05PVF9TVVBQT1JU
RUQ7Cj4gICAJCURSTV9ERUJVR19LTVMoIkRSUlMgbm90IHN1cHBvcnRlZCAoVkJUIGlucHV0KVxu
Iik7Cj4gICAJCWJyZWFrOwo+ICAgCX0KPiBAQCAtMjc4LDcgKzI3OCw3IEBAIHBhcnNlX2xmcF9w
YW5lbF9kYXRhKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAo+ICAgCWZp
bGxfZGV0YWlsX3RpbWluZ19kYXRhKHBhbmVsX2ZpeGVkX21vZGUsIHBhbmVsX2R2b190aW1pbmcp
Owo+ICAgCj4gLQlkZXZfcHJpdi0+dmJ0LmxmcF9sdmRzX3ZidF9tb2RlID0gcGFuZWxfZml4ZWRf
bW9kZTsKPiArCWk5MTUtPnZidC5sZnBfbHZkc192YnRfbW9kZSA9IHBhbmVsX2ZpeGVkX21vZGU7
Cj4gICAKPiAgIAlEUk1fREVCVUdfS01TKCJGb3VuZCBwYW5lbCBtb2RlIGluIEJJT1MgVkJUIHRh
YmxlczpcbiIpOwo+ICAgCWRybV9tb2RlX2RlYnVnX3ByaW50bW9kZWxpbmUocGFuZWxfZml4ZWRf
bW9kZSk7Cj4gQEAgLTI5MCwyMCArMjkwLDIwIEBAIHBhcnNlX2xmcF9wYW5lbF9kYXRhKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkJLyogY2hlY2sgdGhlIHJlc29sdXRp
b24sIGp1c3QgdG8gYmUgc3VyZSAqLwo+ICAgCQlpZiAoZnBfdGltaW5nLT54X3JlcyA9PSBwYW5l
bF9maXhlZF9tb2RlLT5oZGlzcGxheSAmJgo+ICAgCQkgICAgZnBfdGltaW5nLT55X3JlcyA9PSBw
YW5lbF9maXhlZF9tb2RlLT52ZGlzcGxheSkgewo+IC0JCQlkZXZfcHJpdi0+dmJ0LmJpb3NfbHZk
c192YWwgPSBmcF90aW1pbmctPmx2ZHNfcmVnX3ZhbDsKPiArCQkJaTkxNS0+dmJ0LmJpb3NfbHZk
c192YWwgPSBmcF90aW1pbmctPmx2ZHNfcmVnX3ZhbDsKPiAgIAkJCURSTV9ERUJVR19LTVMoIlZC
VCBpbml0aWFsIExWRFMgdmFsdWUgJXhcbiIsCj4gLQkJCQkgICAgICBkZXZfcHJpdi0+dmJ0LmJp
b3NfbHZkc192YWwpOwo+ICsJCQkJICAgICAgaTkxNS0+dmJ0LmJpb3NfbHZkc192YWwpOwo+ICAg
CQl9Cj4gICAJfQo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZAo+IC1wYXJzZV9sZnBfYmFja2xp
Z2h0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArcGFyc2VfbGZwX2JhY2ts
aWdodChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJICAgIGNvbnN0IHN0cnVj
dCBiZGJfaGVhZGVyICpiZGIpCj4gICB7Cj4gICAJY29uc3Qgc3RydWN0IGJkYl9sZnBfYmFja2xp
Z2h0X2RhdGEgKmJhY2tsaWdodF9kYXRhOwo+ICAgCWNvbnN0IHN0cnVjdCBsZnBfYmFja2xpZ2h0
X2RhdGFfZW50cnkgKmVudHJ5Owo+IC0JaW50IHBhbmVsX3R5cGUgPSBkZXZfcHJpdi0+dmJ0LnBh
bmVsX3R5cGU7Cj4gKwlpbnQgcGFuZWxfdHlwZSA9IGk5MTUtPnZidC5wYW5lbF90eXBlOwo+ICAg
Cj4gICAJYmFja2xpZ2h0X2RhdGEgPSBmaW5kX3NlY3Rpb24oYmRiLCBCREJfTFZEU19CQUNLTElH
SFQpOwo+ICAgCWlmICghYmFja2xpZ2h0X2RhdGEpCj4gQEAgLTMxNywzOCArMzE3LDM4IEBAIHBh
cnNlX2xmcF9iYWNrbGlnaHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAg
Cj4gICAJZW50cnkgPSAmYmFja2xpZ2h0X2RhdGEtPmRhdGFbcGFuZWxfdHlwZV07Cj4gICAKPiAt
CWRldl9wcml2LT52YnQuYmFja2xpZ2h0LnByZXNlbnQgPSBlbnRyeS0+dHlwZSA9PSBCREJfQkFD
S0xJR0hUX1RZUEVfUFdNOwo+IC0JaWYgKCFkZXZfcHJpdi0+dmJ0LmJhY2tsaWdodC5wcmVzZW50
KSB7Cj4gKwlpOTE1LT52YnQuYmFja2xpZ2h0LnByZXNlbnQgPSBlbnRyeS0+dHlwZSA9PSBCREJf
QkFDS0xJR0hUX1RZUEVfUFdNOwo+ICsJaWYgKCFpOTE1LT52YnQuYmFja2xpZ2h0LnByZXNlbnQp
IHsKPiAgIAkJRFJNX0RFQlVHX0tNUygiUFdNIGJhY2tsaWdodCBub3QgcHJlc2VudCBpbiBWQlQg
KHR5cGUgJXUpXG4iLAo+ICAgCQkJICAgICAgZW50cnktPnR5cGUpOwo+ICAgCQlyZXR1cm47Cj4g
ICAJfQo+ICAgCj4gLQlkZXZfcHJpdi0+dmJ0LmJhY2tsaWdodC50eXBlID0gSU5URUxfQkFDS0xJ
R0hUX0RJU1BMQVlfRERJOwo+ICsJaTkxNS0+dmJ0LmJhY2tsaWdodC50eXBlID0gSU5URUxfQkFD
S0xJR0hUX0RJU1BMQVlfRERJOwo+ICAgCWlmIChiZGItPnZlcnNpb24gPj0gMTkxICYmCj4gICAJ
ICAgIGdldF9ibG9ja3NpemUoYmFja2xpZ2h0X2RhdGEpID49IHNpemVvZigqYmFja2xpZ2h0X2Rh
dGEpKSB7Cj4gICAJCWNvbnN0IHN0cnVjdCBsZnBfYmFja2xpZ2h0X2NvbnRyb2xfbWV0aG9kICpt
ZXRob2Q7Cj4gICAKPiAgIAkJbWV0aG9kID0gJmJhY2tsaWdodF9kYXRhLT5iYWNrbGlnaHRfY29u
dHJvbFtwYW5lbF90eXBlXTsKPiAtCQlkZXZfcHJpdi0+dmJ0LmJhY2tsaWdodC50eXBlID0gbWV0
aG9kLT50eXBlOwo+IC0JCWRldl9wcml2LT52YnQuYmFja2xpZ2h0LmNvbnRyb2xsZXIgPSBtZXRo
b2QtPmNvbnRyb2xsZXI7Cj4gKwkJaTkxNS0+dmJ0LmJhY2tsaWdodC50eXBlID0gbWV0aG9kLT50
eXBlOwo+ICsJCWk5MTUtPnZidC5iYWNrbGlnaHQuY29udHJvbGxlciA9IG1ldGhvZC0+Y29udHJv
bGxlcjsKPiAgIAl9Cj4gICAKPiAtCWRldl9wcml2LT52YnQuYmFja2xpZ2h0LnB3bV9mcmVxX2h6
ID0gZW50cnktPnB3bV9mcmVxX2h6Owo+IC0JZGV2X3ByaXYtPnZidC5iYWNrbGlnaHQuYWN0aXZl
X2xvd19wd20gPSBlbnRyeS0+YWN0aXZlX2xvd19wd207Cj4gLQlkZXZfcHJpdi0+dmJ0LmJhY2ts
aWdodC5taW5fYnJpZ2h0bmVzcyA9IGVudHJ5LT5taW5fYnJpZ2h0bmVzczsKPiArCWk5MTUtPnZi
dC5iYWNrbGlnaHQucHdtX2ZyZXFfaHogPSBlbnRyeS0+cHdtX2ZyZXFfaHo7Cj4gKwlpOTE1LT52
YnQuYmFja2xpZ2h0LmFjdGl2ZV9sb3dfcHdtID0gZW50cnktPmFjdGl2ZV9sb3dfcHdtOwo+ICsJ
aTkxNS0+dmJ0LmJhY2tsaWdodC5taW5fYnJpZ2h0bmVzcyA9IGVudHJ5LT5taW5fYnJpZ2h0bmVz
czsKPiAgIAlEUk1fREVCVUdfS01TKCJWQlQgYmFja2xpZ2h0IFBXTSBtb2R1bGF0aW9uIGZyZXF1
ZW5jeSAldSBIeiwgIgo+ICAgCQkgICAgICAiYWN0aXZlICVzLCBtaW4gYnJpZ2h0bmVzcyAldSwg
bGV2ZWwgJXUsIGNvbnRyb2xsZXIgJXVcbiIsCj4gLQkJICAgICAgZGV2X3ByaXYtPnZidC5iYWNr
bGlnaHQucHdtX2ZyZXFfaHosCj4gLQkJICAgICAgZGV2X3ByaXYtPnZidC5iYWNrbGlnaHQuYWN0
aXZlX2xvd19wd20gPyAibG93IiA6ICJoaWdoIiwKPiAtCQkgICAgICBkZXZfcHJpdi0+dmJ0LmJh
Y2tsaWdodC5taW5fYnJpZ2h0bmVzcywKPiArCQkgICAgICBpOTE1LT52YnQuYmFja2xpZ2h0LnB3
bV9mcmVxX2h6LAo+ICsJCSAgICAgIGk5MTUtPnZidC5iYWNrbGlnaHQuYWN0aXZlX2xvd19wd20g
PyAibG93IiA6ICJoaWdoIiwKPiArCQkgICAgICBpOTE1LT52YnQuYmFja2xpZ2h0Lm1pbl9icmln
aHRuZXNzLAo+ICAgCQkgICAgICBiYWNrbGlnaHRfZGF0YS0+bGV2ZWxbcGFuZWxfdHlwZV0sCj4g
LQkJICAgICAgZGV2X3ByaXYtPnZidC5iYWNrbGlnaHQuY29udHJvbGxlcik7Cj4gKwkJICAgICAg
aTkxNS0+dmJ0LmJhY2tsaWdodC5jb250cm9sbGVyKTsKPiAgIH0KPiAgIAo+ICAgLyogVHJ5IHRv
IGZpbmQgc2R2byBwYW5lbCBkYXRhICovCj4gICBzdGF0aWMgdm9pZAo+IC1wYXJzZV9zZHZvX3Bh
bmVsX2RhdGEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtwYXJzZV9zZHZv
X3BhbmVsX2RhdGEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCSAgICAgIGNv
bnN0IHN0cnVjdCBiZGJfaGVhZGVyICpiZGIpCj4gICB7Cj4gICAJY29uc3Qgc3RydWN0IGJkYl9z
ZHZvX3BhbmVsX2R0ZHMgKmR0ZHM7Cj4gQEAgLTM4MSwxNiArMzgxLDE2IEBAIHBhcnNlX3Nkdm9f
cGFuZWxfZGF0YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAKPiAgIAlm
aWxsX2RldGFpbF90aW1pbmdfZGF0YShwYW5lbF9maXhlZF9tb2RlLCAmZHRkcy0+ZHRkc1tpbmRl
eF0pOwo+ICAgCj4gLQlkZXZfcHJpdi0+dmJ0LnNkdm9fbHZkc192YnRfbW9kZSA9IHBhbmVsX2Zp
eGVkX21vZGU7Cj4gKwlpOTE1LT52YnQuc2R2b19sdmRzX3ZidF9tb2RlID0gcGFuZWxfZml4ZWRf
bW9kZTsKPiAgIAo+ICAgCURSTV9ERUJVR19LTVMoIkZvdW5kIFNEVk8gcGFuZWwgbW9kZSBpbiBC
SU9TIFZCVCB0YWJsZXM6XG4iKTsKPiAgIAlkcm1fbW9kZV9kZWJ1Z19wcmludG1vZGVsaW5lKHBh
bmVsX2ZpeGVkX21vZGUpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBpbnQgaW50ZWxfYmlvc19zc2Nf
ZnJlcXVlbmN5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIGlu
dCBpbnRlbF9iaW9zX3NzY19mcmVxdWVuY3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gICAJCQkJICAgIGJvb2wgYWx0ZXJuYXRlKQo+ICAgewo+IC0Jc3dpdGNoIChJTlRFTF9HRU4o
ZGV2X3ByaXYpKSB7Cj4gKwlzd2l0Y2ggKElOVEVMX0dFTihpOTE1KSkgewo+ICAgCWNhc2UgMjoK
PiAgIAkJcmV0dXJuIGFsdGVybmF0ZSA/IDY2NjY3IDogNDgwMDA7Cj4gICAJY2FzZSAzOgo+IEBA
IC00MDIsNyArNDAyLDcgQEAgc3RhdGljIGludCBpbnRlbF9iaW9zX3NzY19mcmVxdWVuY3koc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9p
ZAo+IC1wYXJzZV9nZW5lcmFsX2ZlYXR1cmVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiArcGFyc2VfZ2VuZXJhbF9mZWF0dXJlcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiAgIAkJICAgICAgIGNvbnN0IHN0cnVjdCBiZGJfaGVhZGVyICpiZGIpCj4gICB7Cj4g
ICAJY29uc3Qgc3RydWN0IGJkYl9nZW5lcmFsX2ZlYXR1cmVzICpnZW5lcmFsOwo+IEBAIC00MTEs
MzAgKzQxMSwzMCBAQCBwYXJzZV9nZW5lcmFsX2ZlYXR1cmVzKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiAgIAlpZiAoIWdlbmVyYWwpCj4gICAJCXJldHVybjsKPiAgIAo+IC0J
ZGV2X3ByaXYtPnZidC5pbnRfdHZfc3VwcG9ydCA9IGdlbmVyYWwtPmludF90dl9zdXBwb3J0Owo+
ICsJaTkxNS0+dmJ0LmludF90dl9zdXBwb3J0ID0gZ2VuZXJhbC0+aW50X3R2X3N1cHBvcnQ7Cj4g
ICAJLyogaW50X2NydF9zdXBwb3J0IGNhbid0IGJlIHRydXN0ZWQgb24gZWFybGllciBwbGF0Zm9y
bXMgKi8KPiAgIAlpZiAoYmRiLT52ZXJzaW9uID49IDE1NSAmJgo+IC0JICAgIChIQVNfRERJKGRl
dl9wcml2KSB8fCBJU19WQUxMRVlWSUVXKGRldl9wcml2KSkpCj4gLQkJZGV2X3ByaXYtPnZidC5p
bnRfY3J0X3N1cHBvcnQgPSBnZW5lcmFsLT5pbnRfY3J0X3N1cHBvcnQ7Cj4gLQlkZXZfcHJpdi0+
dmJ0Lmx2ZHNfdXNlX3NzYyA9IGdlbmVyYWwtPmVuYWJsZV9zc2M7Cj4gLQlkZXZfcHJpdi0+dmJ0
Lmx2ZHNfc3NjX2ZyZXEgPQo+IC0JCWludGVsX2Jpb3Nfc3NjX2ZyZXF1ZW5jeShkZXZfcHJpdiwg
Z2VuZXJhbC0+c3NjX2ZyZXEpOwo+IC0JZGV2X3ByaXYtPnZidC5kaXNwbGF5X2Nsb2NrX21vZGUg
PSBnZW5lcmFsLT5kaXNwbGF5X2Nsb2NrX21vZGU7Cj4gLQlkZXZfcHJpdi0+dmJ0LmZkaV9yeF9w
b2xhcml0eV9pbnZlcnRlZCA9IGdlbmVyYWwtPmZkaV9yeF9wb2xhcml0eV9pbnZlcnRlZDsKPiAr
CSAgICAoSEFTX0RESShpOTE1KSB8fCBJU19WQUxMRVlWSUVXKGk5MTUpKSkKPiArCQlpOTE1LT52
YnQuaW50X2NydF9zdXBwb3J0ID0gZ2VuZXJhbC0+aW50X2NydF9zdXBwb3J0Owo+ICsJaTkxNS0+
dmJ0Lmx2ZHNfdXNlX3NzYyA9IGdlbmVyYWwtPmVuYWJsZV9zc2M7Cj4gKwlpOTE1LT52YnQubHZk
c19zc2NfZnJlcSA9Cj4gKwkJaW50ZWxfYmlvc19zc2NfZnJlcXVlbmN5KGk5MTUsIGdlbmVyYWwt
PnNzY19mcmVxKTsKPiArCWk5MTUtPnZidC5kaXNwbGF5X2Nsb2NrX21vZGUgPSBnZW5lcmFsLT5k
aXNwbGF5X2Nsb2NrX21vZGU7Cj4gKwlpOTE1LT52YnQuZmRpX3J4X3BvbGFyaXR5X2ludmVydGVk
ID0gZ2VuZXJhbC0+ZmRpX3J4X3BvbGFyaXR5X2ludmVydGVkOwo+ICAgCWlmIChiZGItPnZlcnNp
b24gPj0gMTgxKSB7Cj4gLQkJZGV2X3ByaXYtPnZidC5vcmllbnRhdGlvbiA9IGdlbmVyYWwtPnJv
dGF0ZV8xODAgPwo+ICsJCWk5MTUtPnZidC5vcmllbnRhdGlvbiA9IGdlbmVyYWwtPnJvdGF0ZV8x
ODAgPwo+ICAgCQkJRFJNX01PREVfUEFORUxfT1JJRU5UQVRJT05fQk9UVE9NX1VQIDoKPiAgIAkJ
CURSTV9NT0RFX1BBTkVMX09SSUVOVEFUSU9OX05PUk1BTDsKPiAgIAl9IGVsc2Ugewo+IC0JCWRl
dl9wcml2LT52YnQub3JpZW50YXRpb24gPSBEUk1fTU9ERV9QQU5FTF9PUklFTlRBVElPTl9VTktO
T1dOOwo+ICsJCWk5MTUtPnZidC5vcmllbnRhdGlvbiA9IERSTV9NT0RFX1BBTkVMX09SSUVOVEFU
SU9OX1VOS05PV047Cj4gICAJfQo+ICAgCURSTV9ERUJVR19LTVMoIkJEQl9HRU5FUkFMX0ZFQVRV
UkVTIGludF90dl9zdXBwb3J0ICVkIGludF9jcnRfc3VwcG9ydCAlZCBsdmRzX3VzZV9zc2MgJWQg
bHZkc19zc2NfZnJlcSAlZCBkaXNwbGF5X2Nsb2NrX21vZGUgJWQgZmRpX3J4X3BvbGFyaXR5X2lu
dmVydGVkICVkXG4iLAo+IC0JCSAgICAgIGRldl9wcml2LT52YnQuaW50X3R2X3N1cHBvcnQsCj4g
LQkJICAgICAgZGV2X3ByaXYtPnZidC5pbnRfY3J0X3N1cHBvcnQsCj4gLQkJICAgICAgZGV2X3By
aXYtPnZidC5sdmRzX3VzZV9zc2MsCj4gLQkJICAgICAgZGV2X3ByaXYtPnZidC5sdmRzX3NzY19m
cmVxLAo+IC0JCSAgICAgIGRldl9wcml2LT52YnQuZGlzcGxheV9jbG9ja19tb2RlLAo+IC0JCSAg
ICAgIGRldl9wcml2LT52YnQuZmRpX3J4X3BvbGFyaXR5X2ludmVydGVkKTsKPiArCQkgICAgICBp
OTE1LT52YnQuaW50X3R2X3N1cHBvcnQsCj4gKwkJICAgICAgaTkxNS0+dmJ0LmludF9jcnRfc3Vw
cG9ydCwKPiArCQkgICAgICBpOTE1LT52YnQubHZkc191c2Vfc3NjLAo+ICsJCSAgICAgIGk5MTUt
PnZidC5sdmRzX3NzY19mcmVxLAo+ICsJCSAgICAgIGk5MTUtPnZidC5kaXNwbGF5X2Nsb2NrX21v
ZGUsCj4gKwkJICAgICAgaTkxNS0+dmJ0LmZkaV9yeF9wb2xhcml0eV9pbnZlcnRlZCk7Cj4gICB9
Cj4gICAKPiAgIHN0YXRpYyBjb25zdCBzdHJ1Y3QgY2hpbGRfZGV2aWNlX2NvbmZpZyAqCj4gQEAg
LTQ0NCw3ICs0NDQsNyBAQCBjaGlsZF9kZXZpY2VfcHRyKGNvbnN0IHN0cnVjdCBiZGJfZ2VuZXJh
bF9kZWZpbml0aW9ucyAqZGVmcywgaW50IGkpCj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkCj4g
LXBhcnNlX3Nkdm9fZGV2aWNlX21hcHBpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LCB1OCBiZGJfdmVyc2lvbikKPiArcGFyc2Vfc2R2b19kZXZpY2VfbWFwcGluZyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTggYmRiX3ZlcnNpb24pCj4gICB7Cj4gICAJc3RydWN0
IHNkdm9fZGV2aWNlX21hcHBpbmcgKm1hcHBpbmc7Cj4gICAJY29uc3Qgc3RydWN0IGNoaWxkX2Rl
dmljZV9jb25maWcgKmNoaWxkOwo+IEBAIC00NTQsMTMgKzQ1NCwxMyBAQCBwYXJzZV9zZHZvX2Rl
dmljZV9tYXBwaW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTggYmRiX3Zl
cnNpb24pCj4gICAJICogT25seSBwYXJzZSBTRFZPIG1hcHBpbmdzIG9uIGdlbnMgdGhhdCBjb3Vs
ZCBoYXZlIFNEVk8uIFRoaXMgaXNuJ3QKPiAgIAkgKiBhY2N1cmF0ZSBhbmQgZG9lc24ndCBoYXZl
IHRvIGJlLCBhcyBsb25nIGFzIGl0J3Mgbm90IHRvbyBzdHJpY3QuCj4gICAJICovCj4gLQlpZiAo
IUlTX0dFTl9SQU5HRShkZXZfcHJpdiwgMywgNykpIHsKPiArCWlmICghSVNfR0VOX1JBTkdFKGk5
MTUsIDMsIDcpKSB7Cj4gICAJCURSTV9ERUJVR19LTVMoIlNraXBwaW5nIFNEVk8gZGV2aWNlIG1h
cHBpbmdcbiIpOwo+ICAgCQlyZXR1cm47Cj4gICAJfQo+ICAgCj4gLQlmb3IgKGkgPSAwLCBjb3Vu
dCA9IDA7IGkgPCBkZXZfcHJpdi0+dmJ0LmNoaWxkX2Rldl9udW07IGkrKykgewo+IC0JCWNoaWxk
ID0gZGV2X3ByaXYtPnZidC5jaGlsZF9kZXYgKyBpOwo+ICsJZm9yIChpID0gMCwgY291bnQgPSAw
OyBpIDwgaTkxNS0+dmJ0LmNoaWxkX2Rldl9udW07IGkrKykgewo+ICsJCWNoaWxkID0gaTkxNS0+
dmJ0LmNoaWxkX2RldiArIGk7Cj4gICAKPiAgIAkJaWYgKGNoaWxkLT5zbGF2ZV9hZGRyICE9IFNM
QVZFX0FERFIxICYmCj4gICAJCSAgICBjaGlsZC0+c2xhdmVfYWRkciAhPSBTTEFWRV9BRERSMikg
ewo+IEBAIC00ODEsNyArNDgxLDcgQEAgcGFyc2Vfc2R2b19kZXZpY2VfbWFwcGluZyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4IGJkYl92ZXJzaW9uKQo+ICAgCQkJICAgICAg
Y2hpbGQtPnNsYXZlX2FkZHIsCj4gICAJCQkgICAgICAoY2hpbGQtPmR2b19wb3J0ID09IERFVklD
RV9QT1JUX0RWT0IpID8KPiAgIAkJCSAgICAgICJTRFZPQiIgOiAiU0RWT0MiKTsKPiAtCQltYXBw
aW5nID0gJmRldl9wcml2LT52YnQuc2R2b19tYXBwaW5nc1tjaGlsZC0+ZHZvX3BvcnQgLSAxXTsK
PiArCQltYXBwaW5nID0gJmk5MTUtPnZidC5zZHZvX21hcHBpbmdzW2NoaWxkLT5kdm9fcG9ydCAt
IDFdOwo+ICAgCQlpZiAoIW1hcHBpbmctPmluaXRpYWxpemVkKSB7Cj4gICAJCQltYXBwaW5nLT5k
dm9fcG9ydCA9IGNoaWxkLT5kdm9fcG9ydDsKPiAgIAkJCW1hcHBpbmctPnNsYXZlX2FkZHIgPSBj
aGlsZC0+c2xhdmVfYWRkcjsKPiBAQCAtNTE1LDcgKzUxNSw3IEBAIHBhcnNlX3Nkdm9fZGV2aWNl
X21hcHBpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1OCBiZGJfdmVyc2lv
bikKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQKPiAtcGFyc2VfZHJpdmVyX2ZlYXR1cmVzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArcGFyc2VfZHJpdmVyX2ZlYXR1cmVz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkgICAgICBjb25zdCBzdHJ1Y3Qg
YmRiX2hlYWRlciAqYmRiKQo+ICAgewo+ICAgCWNvbnN0IHN0cnVjdCBiZGJfZHJpdmVyX2ZlYXR1
cmVzICpkcml2ZXI7Cj4gQEAgLTUyNCwxNCArNTI0LDE0IEBAIHBhcnNlX2RyaXZlcl9mZWF0dXJl
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJaWYgKCFkcml2ZXIpCj4g
ICAJCXJldHVybjsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNSkgewo+ICsJ
aWYgKElOVEVMX0dFTihpOTE1KSA+PSA1KSB7Cj4gICAJCS8qCj4gICAJCSAqIE5vdGUgdGhhdCB3
ZSBjb25zaWRlciBCREJfRFJJVkVSX0ZFQVRVUkVfSU5UX1NEVk9fTFZEUwo+ICAgCQkgKiB0byBt
ZWFuICJlRFAiLiBUaGUgVkJUIHNwZWMgZG9lc24ndCBhZ3JlZSB3aXRoIHRoYXQKPiAgIAkJICog
aW50ZXJwcmV0YXRpb24sIGJ1dCByZWFsIHdvcmxkIFZCVHMgc2VlbSB0by4KPiAgIAkJICovCj4g
ICAJCWlmIChkcml2ZXItPmx2ZHNfY29uZmlnICE9IEJEQl9EUklWRVJfRkVBVFVSRV9JTlRfTFZE
UykKPiAtCQkJZGV2X3ByaXYtPnZidC5pbnRfbHZkc19zdXBwb3J0ID0gMDsKPiArCQkJaTkxNS0+
dmJ0LmludF9sdmRzX3N1cHBvcnQgPSAwOwo+ICAgCX0gZWxzZSB7Cj4gICAJCS8qCj4gICAJCSAq
IEZJWE1FIGl0J3Mgbm90IGNsZWFyIHdoaWNoIEJEQiB2ZXJzaW9uIGhhcyB0aGUgTFZEUyBjb25m
aWcKPiBAQCAtNTQ3LDcgKzU0Nyw3IEBAIHBhcnNlX2RyaXZlcl9mZWF0dXJlcyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJCWlmIChiZGItPnZlcnNpb24gPj0gMTM0ICYm
Cj4gICAJCSAgICBkcml2ZXItPmx2ZHNfY29uZmlnICE9IEJEQl9EUklWRVJfRkVBVFVSRV9JTlRf
TFZEUyAmJgo+ICAgCQkgICAgZHJpdmVyLT5sdmRzX2NvbmZpZyAhPSBCREJfRFJJVkVSX0ZFQVRV
UkVfSU5UX1NEVk9fTFZEUykKPiAtCQkJZGV2X3ByaXYtPnZidC5pbnRfbHZkc19zdXBwb3J0ID0g
MDsKPiArCQkJaTkxNS0+dmJ0LmludF9sdmRzX3N1cHBvcnQgPSAwOwo+ICAgCX0KPiAgIAo+ICAg
CURSTV9ERUJVR19LTVMoIkRSUlMgU3RhdGUgRW5hYmxlZDolZFxuIiwgZHJpdmVyLT5kcnJzX2Vu
YWJsZWQpOwo+IEBAIC01NTgsMTcgKzU1OCwxNyBAQCBwYXJzZV9kcml2ZXJfZmVhdHVyZXMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCSAqIGRyaXZlci0+ZHJyc19lbmFi
bGVkPWZhbHNlCj4gICAJICovCj4gICAJaWYgKCFkcml2ZXItPmRycnNfZW5hYmxlZCkKPiAtCQlk
ZXZfcHJpdi0+dmJ0LmRycnNfdHlwZSA9IERSUlNfTk9UX1NVUFBPUlRFRDsKPiAtCWRldl9wcml2
LT52YnQucHNyLmVuYWJsZSA9IGRyaXZlci0+cHNyX2VuYWJsZWQ7Cj4gKwkJaTkxNS0+dmJ0LmRy
cnNfdHlwZSA9IERSUlNfTk9UX1NVUFBPUlRFRDsKPiArCWk5MTUtPnZidC5wc3IuZW5hYmxlID0g
ZHJpdmVyLT5wc3JfZW5hYmxlZDsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQKPiAtcGFyc2Vf
ZWRwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgY29uc3Qgc3RydWN0IGJkYl9o
ZWFkZXIgKmJkYikKPiArcGFyc2VfZWRwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBj
b25zdCBzdHJ1Y3QgYmRiX2hlYWRlciAqYmRiKQo+ICAgewo+ICAgCWNvbnN0IHN0cnVjdCBiZGJf
ZWRwICplZHA7Cj4gICAJY29uc3Qgc3RydWN0IGVkcF9wb3dlcl9zZXEgKmVkcF9wcHM7Cj4gICAJ
Y29uc3Qgc3RydWN0IGVkcF9mYXN0X2xpbmtfcGFyYW1zICplZHBfbGlua19wYXJhbXM7Cj4gLQlp
bnQgcGFuZWxfdHlwZSA9IGRldl9wcml2LT52YnQucGFuZWxfdHlwZTsKPiArCWludCBwYW5lbF90
eXBlID0gaTkxNS0+dmJ0LnBhbmVsX3R5cGU7Cj4gICAKPiAgIAllZHAgPSBmaW5kX3NlY3Rpb24o
YmRiLCBCREJfRURQKTsKPiAgIAlpZiAoIWVkcCkKPiBAQCAtNTc2LDEzICs1NzYsMTMgQEAgcGFy
c2VfZWRwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgY29uc3Qgc3RydWN0IGJk
Yl9oZWFkZXIgKmJkYikKPiAgIAo+ICAgCXN3aXRjaCAoKGVkcC0+Y29sb3JfZGVwdGggPj4gKHBh
bmVsX3R5cGUgKiAyKSkgJiAzKSB7Cj4gICAJY2FzZSBFRFBfMThCUFA6Cj4gLQkJZGV2X3ByaXYt
PnZidC5lZHAuYnBwID0gMTg7Cj4gKwkJaTkxNS0+dmJ0LmVkcC5icHAgPSAxODsKPiAgIAkJYnJl
YWs7Cj4gICAJY2FzZSBFRFBfMjRCUFA6Cj4gLQkJZGV2X3ByaXYtPnZidC5lZHAuYnBwID0gMjQ7
Cj4gKwkJaTkxNS0+dmJ0LmVkcC5icHAgPSAyNDsKPiAgIAkJYnJlYWs7Cj4gICAJY2FzZSBFRFBf
MzBCUFA6Cj4gLQkJZGV2X3ByaXYtPnZidC5lZHAuYnBwID0gMzA7Cj4gKwkJaTkxNS0+dmJ0LmVk
cC5icHAgPSAzMDsKPiAgIAkJYnJlYWs7Cj4gICAJfQo+ICAgCj4gQEAgLTU5MCwxNCArNTkwLDE0
IEBAIHBhcnNlX2VkcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGNvbnN0IHN0
cnVjdCBiZGJfaGVhZGVyICpiZGIpCj4gICAJZWRwX3BwcyA9ICZlZHAtPnBvd2VyX3NlcXNbcGFu
ZWxfdHlwZV07Cj4gICAJZWRwX2xpbmtfcGFyYW1zID0gJmVkcC0+ZmFzdF9saW5rX3BhcmFtc1tw
YW5lbF90eXBlXTsKPiAgIAo+IC0JZGV2X3ByaXYtPnZidC5lZHAucHBzID0gKmVkcF9wcHM7Cj4g
KwlpOTE1LT52YnQuZWRwLnBwcyA9ICplZHBfcHBzOwo+ICAgCj4gICAJc3dpdGNoIChlZHBfbGlu
a19wYXJhbXMtPnJhdGUpIHsKPiAgIAljYXNlIEVEUF9SQVRFXzFfNjI6Cj4gLQkJZGV2X3ByaXYt
PnZidC5lZHAucmF0ZSA9IERQX0xJTktfQldfMV82MjsKPiArCQlpOTE1LT52YnQuZWRwLnJhdGUg
PSBEUF9MSU5LX0JXXzFfNjI7Cj4gICAJCWJyZWFrOwo+ICAgCWNhc2UgRURQX1JBVEVfMl83Ogo+
IC0JCWRldl9wcml2LT52YnQuZWRwLnJhdGUgPSBEUF9MSU5LX0JXXzJfNzsKPiArCQlpOTE1LT52
YnQuZWRwLnJhdGUgPSBEUF9MSU5LX0JXXzJfNzsKPiAgIAkJYnJlYWs7Cj4gICAJZGVmYXVsdDoK
PiAgIAkJRFJNX0RFQlVHX0tNUygiVkJUIGhhcyB1bmtub3duIGVEUCBsaW5rIHJhdGUgdmFsdWUg
JXVcbiIsCj4gQEAgLTYwNywxMyArNjA3LDEzIEBAIHBhcnNlX2VkcChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsIGNvbnN0IHN0cnVjdCBiZGJfaGVhZGVyICpiZGIpCj4gICAKPiAg
IAlzd2l0Y2ggKGVkcF9saW5rX3BhcmFtcy0+bGFuZXMpIHsKPiAgIAljYXNlIEVEUF9MQU5FXzE6
Cj4gLQkJZGV2X3ByaXYtPnZidC5lZHAubGFuZXMgPSAxOwo+ICsJCWk5MTUtPnZidC5lZHAubGFu
ZXMgPSAxOwo+ICAgCQlicmVhazsKPiAgIAljYXNlIEVEUF9MQU5FXzI6Cj4gLQkJZGV2X3ByaXYt
PnZidC5lZHAubGFuZXMgPSAyOwo+ICsJCWk5MTUtPnZidC5lZHAubGFuZXMgPSAyOwo+ICAgCQli
cmVhazsKPiAgIAljYXNlIEVEUF9MQU5FXzQ6Cj4gLQkJZGV2X3ByaXYtPnZidC5lZHAubGFuZXMg
PSA0Owo+ICsJCWk5MTUtPnZidC5lZHAubGFuZXMgPSA0Owo+ICAgCQlicmVhazsKPiAgIAlkZWZh
dWx0Ogo+ICAgCQlEUk1fREVCVUdfS01TKCJWQlQgaGFzIHVua25vd24gZURQIGxhbmUgY291bnQg
dmFsdWUgJXVcbiIsCj4gQEAgLTYyMywxNiArNjIzLDE2IEBAIHBhcnNlX2VkcChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGNvbnN0IHN0cnVjdCBiZGJfaGVhZGVyICpiZGIpCj4g
ICAKPiAgIAlzd2l0Y2ggKGVkcF9saW5rX3BhcmFtcy0+cHJlZW1waGFzaXMpIHsKPiAgIAljYXNl
IEVEUF9QUkVFTVBIQVNJU19OT05FOgo+IC0JCWRldl9wcml2LT52YnQuZWRwLnByZWVtcGhhc2lz
ID0gRFBfVFJBSU5fUFJFX0VNUEhfTEVWRUxfMDsKPiArCQlpOTE1LT52YnQuZWRwLnByZWVtcGhh
c2lzID0gRFBfVFJBSU5fUFJFX0VNUEhfTEVWRUxfMDsKPiAgIAkJYnJlYWs7Cj4gICAJY2FzZSBF
RFBfUFJFRU1QSEFTSVNfM181ZEI6Cj4gLQkJZGV2X3ByaXYtPnZidC5lZHAucHJlZW1waGFzaXMg
PSBEUF9UUkFJTl9QUkVfRU1QSF9MRVZFTF8xOwo+ICsJCWk5MTUtPnZidC5lZHAucHJlZW1waGFz
aXMgPSBEUF9UUkFJTl9QUkVfRU1QSF9MRVZFTF8xOwo+ICAgCQlicmVhazsKPiAgIAljYXNlIEVE
UF9QUkVFTVBIQVNJU182ZEI6Cj4gLQkJZGV2X3ByaXYtPnZidC5lZHAucHJlZW1waGFzaXMgPSBE
UF9UUkFJTl9QUkVfRU1QSF9MRVZFTF8yOwo+ICsJCWk5MTUtPnZidC5lZHAucHJlZW1waGFzaXMg
PSBEUF9UUkFJTl9QUkVfRU1QSF9MRVZFTF8yOwo+ICAgCQlicmVhazsKPiAgIAljYXNlIEVEUF9Q
UkVFTVBIQVNJU185XzVkQjoKPiAtCQlkZXZfcHJpdi0+dmJ0LmVkcC5wcmVlbXBoYXNpcyA9IERQ
X1RSQUlOX1BSRV9FTVBIX0xFVkVMXzM7Cj4gKwkJaTkxNS0+dmJ0LmVkcC5wcmVlbXBoYXNpcyA9
IERQX1RSQUlOX1BSRV9FTVBIX0xFVkVMXzM7Cj4gICAJCWJyZWFrOwo+ICAgCWRlZmF1bHQ6Cj4g
ICAJCURSTV9ERUJVR19LTVMoIlZCVCBoYXMgdW5rbm93biBlRFAgcHJlLWVtcGhhc2lzIHZhbHVl
ICV1XG4iLAo+IEBAIC02NDIsMTYgKzY0MiwxNiBAQCBwYXJzZV9lZHAoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LCBjb25zdCBzdHJ1Y3QgYmRiX2hlYWRlciAqYmRiKQo+ICAgCj4g
ICAJc3dpdGNoIChlZHBfbGlua19wYXJhbXMtPnZzd2luZykgewo+ICAgCWNhc2UgRURQX1ZTV0lO
R18wXzRWOgo+IC0JCWRldl9wcml2LT52YnQuZWRwLnZzd2luZyA9IERQX1RSQUlOX1ZPTFRBR0Vf
U1dJTkdfTEVWRUxfMDsKPiArCQlpOTE1LT52YnQuZWRwLnZzd2luZyA9IERQX1RSQUlOX1ZPTFRB
R0VfU1dJTkdfTEVWRUxfMDsKPiAgIAkJYnJlYWs7Cj4gICAJY2FzZSBFRFBfVlNXSU5HXzBfNlY6
Cj4gLQkJZGV2X3ByaXYtPnZidC5lZHAudnN3aW5nID0gRFBfVFJBSU5fVk9MVEFHRV9TV0lOR19M
RVZFTF8xOwo+ICsJCWk5MTUtPnZidC5lZHAudnN3aW5nID0gRFBfVFJBSU5fVk9MVEFHRV9TV0lO
R19MRVZFTF8xOwo+ICAgCQlicmVhazsKPiAgIAljYXNlIEVEUF9WU1dJTkdfMF84VjoKPiAtCQlk
ZXZfcHJpdi0+dmJ0LmVkcC52c3dpbmcgPSBEUF9UUkFJTl9WT0xUQUdFX1NXSU5HX0xFVkVMXzI7
Cj4gKwkJaTkxNS0+dmJ0LmVkcC52c3dpbmcgPSBEUF9UUkFJTl9WT0xUQUdFX1NXSU5HX0xFVkVM
XzI7Cj4gICAJCWJyZWFrOwo+ICAgCWNhc2UgRURQX1ZTV0lOR18xXzJWOgo+IC0JCWRldl9wcml2
LT52YnQuZWRwLnZzd2luZyA9IERQX1RSQUlOX1ZPTFRBR0VfU1dJTkdfTEVWRUxfMzsKPiArCQlp
OTE1LT52YnQuZWRwLnZzd2luZyA9IERQX1RSQUlOX1ZPTFRBR0VfU1dJTkdfTEVWRUxfMzsKPiAg
IAkJYnJlYWs7Cj4gICAJZGVmYXVsdDoKPiAgIAkJRFJNX0RFQlVHX0tNUygiVkJUIGhhcyB1bmtu
b3duIGVEUCB2b2x0YWdlIHN3aW5nIHZhbHVlICV1XG4iLAo+IEBAIC02NjQsMjEgKzY2NCwyMSBA
QCBwYXJzZV9lZHAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBjb25zdCBzdHJ1
Y3QgYmRiX2hlYWRlciAqYmRiKQo+ICAgCj4gICAJCS8qIERvbid0IHJlYWQgZnJvbSBWQlQgaWYg
bW9kdWxlIHBhcmFtZXRlciBoYXMgdmFsaWQgdmFsdWUqLwo+ICAgCQlpZiAoaTkxNV9tb2RwYXJh
bXMuZWRwX3Zzd2luZykgewo+IC0JCQlkZXZfcHJpdi0+dmJ0LmVkcC5sb3dfdnN3aW5nID0KPiAr
CQkJaTkxNS0+dmJ0LmVkcC5sb3dfdnN3aW5nID0KPiAgIAkJCQlpOTE1X21vZHBhcmFtcy5lZHBf
dnN3aW5nID09IDE7Cj4gICAJCX0gZWxzZSB7Cj4gICAJCQl2c3dpbmcgPSAoZWRwLT5lZHBfdnN3
aW5nX3ByZWVtcGggPj4gKHBhbmVsX3R5cGUgKiA0KSkgJiAweEY7Cj4gLQkJCWRldl9wcml2LT52
YnQuZWRwLmxvd192c3dpbmcgPSB2c3dpbmcgPT0gMDsKPiArCQkJaTkxNS0+dmJ0LmVkcC5sb3df
dnN3aW5nID0gdnN3aW5nID09IDA7Cj4gICAJCX0KPiAgIAl9Cj4gICB9Cj4gICAKPiAgIHN0YXRp
YyB2b2lkCj4gLXBhcnNlX3BzcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGNv
bnN0IHN0cnVjdCBiZGJfaGVhZGVyICpiZGIpCj4gK3BhcnNlX3BzcihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwgY29uc3Qgc3RydWN0IGJkYl9oZWFkZXIgKmJkYikKPiAgIHsKPiAgIAlj
b25zdCBzdHJ1Y3QgYmRiX3BzciAqcHNyOwo+ICAgCWNvbnN0IHN0cnVjdCBwc3JfdGFibGUgKnBz
cl90YWJsZTsKPiAtCWludCBwYW5lbF90eXBlID0gZGV2X3ByaXYtPnZidC5wYW5lbF90eXBlOwo+
ICsJaW50IHBhbmVsX3R5cGUgPSBpOTE1LT52YnQucGFuZWxfdHlwZTsKPiAgIAo+ICAgCXBzciA9
IGZpbmRfc2VjdGlvbihiZGIsIEJEQl9QU1IpOwo+ICAgCWlmICghcHNyKSB7Cj4gQEAgLTY4OCwy
NSArNjg4LDI1IEBAIHBhcnNlX3BzcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
IGNvbnN0IHN0cnVjdCBiZGJfaGVhZGVyICpiZGIpCj4gICAKPiAgIAlwc3JfdGFibGUgPSAmcHNy
LT5wc3JfdGFibGVbcGFuZWxfdHlwZV07Cj4gICAKPiAtCWRldl9wcml2LT52YnQucHNyLmZ1bGxf
bGluayA9IHBzcl90YWJsZS0+ZnVsbF9saW5rOwo+IC0JZGV2X3ByaXYtPnZidC5wc3IucmVxdWly
ZV9hdXhfd2FrZXVwID0gcHNyX3RhYmxlLT5yZXF1aXJlX2F1eF90b193YWtldXA7Cj4gKwlpOTE1
LT52YnQucHNyLmZ1bGxfbGluayA9IHBzcl90YWJsZS0+ZnVsbF9saW5rOwo+ICsJaTkxNS0+dmJ0
LnBzci5yZXF1aXJlX2F1eF93YWtldXAgPSBwc3JfdGFibGUtPnJlcXVpcmVfYXV4X3RvX3dha2V1
cDsKPiAgIAo+ICAgCS8qIEFsbG93ZWQgVkJUIHZhbHVlcyBnb2VzIGZyb20gMCB0byAxNSAqLwo+
IC0JZGV2X3ByaXYtPnZidC5wc3IuaWRsZV9mcmFtZXMgPSBwc3JfdGFibGUtPmlkbGVfZnJhbWVz
IDwgMCA/IDAgOgo+ICsJaTkxNS0+dmJ0LnBzci5pZGxlX2ZyYW1lcyA9IHBzcl90YWJsZS0+aWRs
ZV9mcmFtZXMgPCAwID8gMCA6Cj4gICAJCXBzcl90YWJsZS0+aWRsZV9mcmFtZXMgPiAxNSA/IDE1
IDogcHNyX3RhYmxlLT5pZGxlX2ZyYW1lczsKPiAgIAo+ICAgCXN3aXRjaCAocHNyX3RhYmxlLT5s
aW5lc190b193YWl0KSB7Cj4gICAJY2FzZSAwOgo+IC0JCWRldl9wcml2LT52YnQucHNyLmxpbmVz
X3RvX3dhaXQgPSBQU1JfMF9MSU5FU19UT19XQUlUOwo+ICsJCWk5MTUtPnZidC5wc3IubGluZXNf
dG9fd2FpdCA9IFBTUl8wX0xJTkVTX1RPX1dBSVQ7Cj4gICAJCWJyZWFrOwo+ICAgCWNhc2UgMToK
PiAtCQlkZXZfcHJpdi0+dmJ0LnBzci5saW5lc190b193YWl0ID0gUFNSXzFfTElORV9UT19XQUlU
Owo+ICsJCWk5MTUtPnZidC5wc3IubGluZXNfdG9fd2FpdCA9IFBTUl8xX0xJTkVfVE9fV0FJVDsK
PiAgIAkJYnJlYWs7Cj4gICAJY2FzZSAyOgo+IC0JCWRldl9wcml2LT52YnQucHNyLmxpbmVzX3Rv
X3dhaXQgPSBQU1JfNF9MSU5FU19UT19XQUlUOwo+ICsJCWk5MTUtPnZidC5wc3IubGluZXNfdG9f
d2FpdCA9IFBTUl80X0xJTkVTX1RPX1dBSVQ7Cj4gICAJCWJyZWFrOwo+ICAgCWNhc2UgMzoKPiAt
CQlkZXZfcHJpdi0+dmJ0LnBzci5saW5lc190b193YWl0ID0gUFNSXzhfTElORVNfVE9fV0FJVDsK
PiArCQlpOTE1LT52YnQucHNyLmxpbmVzX3RvX3dhaXQgPSBQU1JfOF9MSU5FU19UT19XQUlUOwo+
ICAgCQlicmVhazsKPiAgIAlkZWZhdWx0Ogo+ICAgCQlEUk1fREVCVUdfS01TKCJWQlQgaGFzIHVu
a25vd24gUFNSIGxpbmVzIHRvIHdhaXQgJXVcbiIsCj4gQEAgLTcxOSw0OCArNzE5LDQ4IEBAIHBh
cnNlX3BzcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGNvbnN0IHN0cnVjdCBi
ZGJfaGVhZGVyICpiZGIpCj4gICAJICogT2xkIGRlY2ltYWwgdmFsdWUgaXMgd2FrZSB1cCB0aW1l
IGluIG11bHRpcGxlcyBvZiAxMDAgdXMuCj4gICAJICovCj4gICAJaWYgKGJkYi0+dmVyc2lvbiA+
PSAyMDUgJiYKPiAtCSAgICAoSVNfR0VOOV9CQyhkZXZfcHJpdikgfHwgSVNfR0VNSU5JTEFLRShk
ZXZfcHJpdikgfHwKPiAtCSAgICAgSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCkpIHsKPiArCSAg
ICAoSVNfR0VOOV9CQyhpOTE1KSB8fCBJU19HRU1JTklMQUtFKGk5MTUpIHx8Cj4gKwkgICAgIElO
VEVMX0dFTihpOTE1KSA+PSAxMCkpIHsKPiAgIAkJc3dpdGNoIChwc3JfdGFibGUtPnRwMV93YWtl
dXBfdGltZSkgewo+ICAgCQljYXNlIDA6Cj4gLQkJCWRldl9wcml2LT52YnQucHNyLnRwMV93YWtl
dXBfdGltZV91cyA9IDUwMDsKPiArCQkJaTkxNS0+dmJ0LnBzci50cDFfd2FrZXVwX3RpbWVfdXMg
PSA1MDA7Cj4gICAJCQlicmVhazsKPiAgIAkJY2FzZSAxOgo+IC0JCQlkZXZfcHJpdi0+dmJ0LnBz
ci50cDFfd2FrZXVwX3RpbWVfdXMgPSAxMDA7Cj4gKwkJCWk5MTUtPnZidC5wc3IudHAxX3dha2V1
cF90aW1lX3VzID0gMTAwOwo+ICAgCQkJYnJlYWs7Cj4gICAJCWNhc2UgMzoKPiAtCQkJZGV2X3By
aXYtPnZidC5wc3IudHAxX3dha2V1cF90aW1lX3VzID0gMDsKPiArCQkJaTkxNS0+dmJ0LnBzci50
cDFfd2FrZXVwX3RpbWVfdXMgPSAwOwo+ICAgCQkJYnJlYWs7Cj4gICAJCWRlZmF1bHQ6Cj4gICAJ
CQlEUk1fREVCVUdfS01TKCJWQlQgdHAxIHdha2V1cCB0aW1lIHZhbHVlICVkIGlzIG91dHNpZGUg
cmFuZ2VbMC0zXSwgZGVmYXVsdGluZyB0byBtYXggdmFsdWUgMjUwMHVzXG4iLAo+ICAgCQkJCQlw
c3JfdGFibGUtPnRwMV93YWtldXBfdGltZSk7Cj4gICAJCQkvKiBmYWxsdGhyb3VnaCAqLwo+ICAg
CQljYXNlIDI6Cj4gLQkJCWRldl9wcml2LT52YnQucHNyLnRwMV93YWtldXBfdGltZV91cyA9IDI1
MDA7Cj4gKwkJCWk5MTUtPnZidC5wc3IudHAxX3dha2V1cF90aW1lX3VzID0gMjUwMDsKPiAgIAkJ
CWJyZWFrOwo+ICAgCQl9Cj4gICAKPiAgIAkJc3dpdGNoIChwc3JfdGFibGUtPnRwMl90cDNfd2Fr
ZXVwX3RpbWUpIHsKPiAgIAkJY2FzZSAwOgo+IC0JCQlkZXZfcHJpdi0+dmJ0LnBzci50cDJfdHAz
X3dha2V1cF90aW1lX3VzID0gNTAwOwo+ICsJCQlpOTE1LT52YnQucHNyLnRwMl90cDNfd2FrZXVw
X3RpbWVfdXMgPSA1MDA7Cj4gICAJCQlicmVhazsKPiAgIAkJY2FzZSAxOgo+IC0JCQlkZXZfcHJp
di0+dmJ0LnBzci50cDJfdHAzX3dha2V1cF90aW1lX3VzID0gMTAwOwo+ICsJCQlpOTE1LT52YnQu
cHNyLnRwMl90cDNfd2FrZXVwX3RpbWVfdXMgPSAxMDA7Cj4gICAJCQlicmVhazsKPiAgIAkJY2Fz
ZSAzOgo+IC0JCQlkZXZfcHJpdi0+dmJ0LnBzci50cDJfdHAzX3dha2V1cF90aW1lX3VzID0gMDsK
PiArCQkJaTkxNS0+dmJ0LnBzci50cDJfdHAzX3dha2V1cF90aW1lX3VzID0gMDsKPiAgIAkJCWJy
ZWFrOwo+ICAgCQlkZWZhdWx0Ogo+ICAgCQkJRFJNX0RFQlVHX0tNUygiVkJUIHRwMl90cDMgd2Fr
ZXVwIHRpbWUgdmFsdWUgJWQgaXMgb3V0c2lkZSByYW5nZVswLTNdLCBkZWZhdWx0aW5nIHRvIG1h
eCB2YWx1ZSAyNTAwdXNcbiIsCj4gICAJCQkJCXBzcl90YWJsZS0+dHAyX3RwM193YWtldXBfdGlt
ZSk7Cj4gICAJCQkvKiBmYWxsdGhyb3VnaCAqLwo+ICAgCQljYXNlIDI6Cj4gLQkJCWRldl9wcml2
LT52YnQucHNyLnRwMl90cDNfd2FrZXVwX3RpbWVfdXMgPSAyNTAwOwo+ICsJCQlpOTE1LT52YnQu
cHNyLnRwMl90cDNfd2FrZXVwX3RpbWVfdXMgPSAyNTAwOwo+ICAgCQlicmVhazsKPiAgIAkJfQo+
ICAgCX0gZWxzZSB7Cj4gLQkJZGV2X3ByaXYtPnZidC5wc3IudHAxX3dha2V1cF90aW1lX3VzID0g
cHNyX3RhYmxlLT50cDFfd2FrZXVwX3RpbWUgKiAxMDA7Cj4gLQkJZGV2X3ByaXYtPnZidC5wc3Iu
dHAyX3RwM193YWtldXBfdGltZV91cyA9IHBzcl90YWJsZS0+dHAyX3RwM193YWtldXBfdGltZSAq
IDEwMDsKPiArCQlpOTE1LT52YnQucHNyLnRwMV93YWtldXBfdGltZV91cyA9IHBzcl90YWJsZS0+
dHAxX3dha2V1cF90aW1lICogMTAwOwo+ICsJCWk5MTUtPnZidC5wc3IudHAyX3RwM193YWtldXBf
dGltZV91cyA9IHBzcl90YWJsZS0+dHAyX3RwM193YWtldXBfdGltZSAqIDEwMDsKPiAgIAl9Cj4g
ICAKPiAgIAlpZiAoYmRiLT52ZXJzaW9uID49IDIyNikgewo+IEBAIC03ODIsNzQgKzc4Miw3NCBA
QCBwYXJzZV9wc3Ioc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBjb25zdCBzdHJ1
Y3QgYmRiX2hlYWRlciAqYmRiKQo+ICAgCQkJd2FrZXVwX3RpbWUgPSAyNTAwOwo+ICAgCQkJYnJl
YWs7Cj4gICAJCX0KPiAtCQlkZXZfcHJpdi0+dmJ0LnBzci5wc3IyX3RwMl90cDNfd2FrZXVwX3Rp
bWVfdXMgPSB3YWtldXBfdGltZTsKPiArCQlpOTE1LT52YnQucHNyLnBzcjJfdHAyX3RwM193YWtl
dXBfdGltZV91cyA9IHdha2V1cF90aW1lOwo+ICAgCX0gZWxzZSB7Cj4gICAJCS8qIFJldXNpbmcg
UFNSMSB3YWtldXAgdGltZSBmb3IgUFNSMiBpbiBvbGRlciBWQlRzICovCj4gLQkJZGV2X3ByaXYt
PnZidC5wc3IucHNyMl90cDJfdHAzX3dha2V1cF90aW1lX3VzID0gZGV2X3ByaXYtPnZidC5wc3Iu
dHAyX3RwM193YWtldXBfdGltZV91czsKPiArCQlpOTE1LT52YnQucHNyLnBzcjJfdHAyX3RwM193
YWtldXBfdGltZV91cyA9IGk5MTUtPnZidC5wc3IudHAyX3RwM193YWtldXBfdGltZV91czsKPiAg
IAl9Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgcGFyc2VfZHNpX2JhY2tsaWdodF9wb3J0cyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIHBhcnNlX2Rz
aV9iYWNrbGlnaHRfcG9ydHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJ
ICAgICAgdTE2IHZlcnNpb24sIGVudW0gcG9ydCBwb3J0KQo+ICAgewo+IC0JaWYgKCFkZXZfcHJp
di0+dmJ0LmRzaS5jb25maWctPmR1YWxfbGluayB8fCB2ZXJzaW9uIDwgMTk3KSB7Cj4gLQkJZGV2
X3ByaXYtPnZidC5kc2kuYmxfcG9ydHMgPSBCSVQocG9ydCk7Cj4gLQkJaWYgKGRldl9wcml2LT52
YnQuZHNpLmNvbmZpZy0+Y2FiY19zdXBwb3J0ZWQpCj4gLQkJCWRldl9wcml2LT52YnQuZHNpLmNh
YmNfcG9ydHMgPSBCSVQocG9ydCk7Cj4gKwlpZiAoIWk5MTUtPnZidC5kc2kuY29uZmlnLT5kdWFs
X2xpbmsgfHwgdmVyc2lvbiA8IDE5Nykgewo+ICsJCWk5MTUtPnZidC5kc2kuYmxfcG9ydHMgPSBC
SVQocG9ydCk7Cj4gKwkJaWYgKGk5MTUtPnZidC5kc2kuY29uZmlnLT5jYWJjX3N1cHBvcnRlZCkK
PiArCQkJaTkxNS0+dmJ0LmRzaS5jYWJjX3BvcnRzID0gQklUKHBvcnQpOwo+ICAgCj4gICAJCXJl
dHVybjsKPiAgIAl9Cj4gICAKPiAtCXN3aXRjaCAoZGV2X3ByaXYtPnZidC5kc2kuY29uZmlnLT5k
bF9kY3NfYmFja2xpZ2h0X3BvcnRzKSB7Cj4gKwlzd2l0Y2ggKGk5MTUtPnZidC5kc2kuY29uZmln
LT5kbF9kY3NfYmFja2xpZ2h0X3BvcnRzKSB7Cj4gICAJY2FzZSBETF9EQ1NfUE9SVF9BOgo+IC0J
CWRldl9wcml2LT52YnQuZHNpLmJsX3BvcnRzID0gQklUKFBPUlRfQSk7Cj4gKwkJaTkxNS0+dmJ0
LmRzaS5ibF9wb3J0cyA9IEJJVChQT1JUX0EpOwo+ICAgCQlicmVhazsKPiAgIAljYXNlIERMX0RD
U19QT1JUX0M6Cj4gLQkJZGV2X3ByaXYtPnZidC5kc2kuYmxfcG9ydHMgPSBCSVQoUE9SVF9DKTsK
PiArCQlpOTE1LT52YnQuZHNpLmJsX3BvcnRzID0gQklUKFBPUlRfQyk7Cj4gICAJCWJyZWFrOwo+
ICAgCWRlZmF1bHQ6Cj4gICAJY2FzZSBETF9EQ1NfUE9SVF9BX0FORF9DOgo+IC0JCWRldl9wcml2
LT52YnQuZHNpLmJsX3BvcnRzID0gQklUKFBPUlRfQSkgfCBCSVQoUE9SVF9DKTsKPiArCQlpOTE1
LT52YnQuZHNpLmJsX3BvcnRzID0gQklUKFBPUlRfQSkgfCBCSVQoUE9SVF9DKTsKPiAgIAkJYnJl
YWs7Cj4gICAJfQo+ICAgCj4gLQlpZiAoIWRldl9wcml2LT52YnQuZHNpLmNvbmZpZy0+Y2FiY19z
dXBwb3J0ZWQpCj4gKwlpZiAoIWk5MTUtPnZidC5kc2kuY29uZmlnLT5jYWJjX3N1cHBvcnRlZCkK
PiAgIAkJcmV0dXJuOwo+ICAgCj4gLQlzd2l0Y2ggKGRldl9wcml2LT52YnQuZHNpLmNvbmZpZy0+
ZGxfZGNzX2NhYmNfcG9ydHMpIHsKPiArCXN3aXRjaCAoaTkxNS0+dmJ0LmRzaS5jb25maWctPmRs
X2Rjc19jYWJjX3BvcnRzKSB7Cj4gICAJY2FzZSBETF9EQ1NfUE9SVF9BOgo+IC0JCWRldl9wcml2
LT52YnQuZHNpLmNhYmNfcG9ydHMgPSBCSVQoUE9SVF9BKTsKPiArCQlpOTE1LT52YnQuZHNpLmNh
YmNfcG9ydHMgPSBCSVQoUE9SVF9BKTsKPiAgIAkJYnJlYWs7Cj4gICAJY2FzZSBETF9EQ1NfUE9S
VF9DOgo+IC0JCWRldl9wcml2LT52YnQuZHNpLmNhYmNfcG9ydHMgPSBCSVQoUE9SVF9DKTsKPiAr
CQlpOTE1LT52YnQuZHNpLmNhYmNfcG9ydHMgPSBCSVQoUE9SVF9DKTsKPiAgIAkJYnJlYWs7Cj4g
ICAJZGVmYXVsdDoKPiAgIAljYXNlIERMX0RDU19QT1JUX0FfQU5EX0M6Cj4gLQkJZGV2X3ByaXYt
PnZidC5kc2kuY2FiY19wb3J0cyA9Cj4gKwkJaTkxNS0+dmJ0LmRzaS5jYWJjX3BvcnRzID0KPiAg
IAkJCQkJQklUKFBPUlRfQSkgfCBCSVQoUE9SVF9DKTsKPiAgIAkJYnJlYWs7Cj4gICAJfQo+ICAg
fQo+ICAgCj4gICBzdGF0aWMgdm9pZAo+IC1wYXJzZV9taXBpX2NvbmZpZyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3BhcnNlX21pcGlfY29uZmlnKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCQkgIGNvbnN0IHN0cnVjdCBiZGJfaGVhZGVyICpiZGIpCj4g
ICB7Cj4gICAJY29uc3Qgc3RydWN0IGJkYl9taXBpX2NvbmZpZyAqc3RhcnQ7Cj4gICAJY29uc3Qg
c3RydWN0IG1pcGlfY29uZmlnICpjb25maWc7Cj4gICAJY29uc3Qgc3RydWN0IG1pcGlfcHBzX2Rh
dGEgKnBwczsKPiAtCWludCBwYW5lbF90eXBlID0gZGV2X3ByaXYtPnZidC5wYW5lbF90eXBlOwo+
ICsJaW50IHBhbmVsX3R5cGUgPSBpOTE1LT52YnQucGFuZWxfdHlwZTsKPiAgIAllbnVtIHBvcnQg
cG9ydDsKPiAgIAo+ICAgCS8qIHBhcnNlIE1JUEkgYmxvY2tzIG9ubHkgaWYgTEZQIHR5cGUgaXMg
TUlQSSAqLwo+IC0JaWYgKCFpbnRlbF9iaW9zX2lzX2RzaV9wcmVzZW50KGRldl9wcml2LCAmcG9y
dCkpCj4gKwlpZiAoIWludGVsX2Jpb3NfaXNfZHNpX3ByZXNlbnQoaTkxNSwgJnBvcnQpKQo+ICAg
CQlyZXR1cm47Cj4gICAKPiAgIAkvKiBJbml0aWFsaXplIHRoaXMgdG8gdW5kZWZpbmVkIGluZGlj
YXRpbmcgbm8gZ2VuZXJpYyBNSVBJIHN1cHBvcnQgKi8KPiAtCWRldl9wcml2LT52YnQuZHNpLnBh
bmVsX2lkID0gTUlQSV9EU0lfVU5ERUZJTkVEX1BBTkVMX0lEOwo+ICsJaTkxNS0+dmJ0LmRzaS5w
YW5lbF9pZCA9IE1JUElfRFNJX1VOREVGSU5FRF9QQU5FTF9JRDsKPiAgIAo+ICAgCS8qIEJsb2Nr
ICM0MCBpcyBhbHJlYWR5IHBhcnNlZCBhbmQgcGFuZWxfZml4ZWRfbW9kZSBpcwo+IC0JICogc3Rv
cmVkIGluIGRldl9wcml2LT5sZnBfbHZkc192YnRfbW9kZQo+ICsJICogc3RvcmVkIGluIGk5MTUt
PmxmcF9sdmRzX3ZidF9tb2RlCj4gICAJICogcmVzdXNlIHRoaXMgd2hlbiBuZWVkZWQKPiAgIAkg
Ki8KPiAgIAo+IEBAIC04NzMsMTcgKzg3MywxNyBAQCBwYXJzZV9taXBpX2NvbmZpZyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJcHBzID0gJnN0YXJ0LT5wcHNbcGFuZWxf
dHlwZV07Cj4gICAKPiAgIAkvKiBzdG9yZSBhcyBvZiBub3cgZnVsbCBkYXRhLiBUcmltIHdoZW4g
d2UgcmVhbGlzZSBhbGwgaXMgbm90IG5lZWRlZCAqLwo+IC0JZGV2X3ByaXYtPnZidC5kc2kuY29u
ZmlnID0ga21lbWR1cChjb25maWcsIHNpemVvZihzdHJ1Y3QgbWlwaV9jb25maWcpLCBHRlBfS0VS
TkVMKTsKPiAtCWlmICghZGV2X3ByaXYtPnZidC5kc2kuY29uZmlnKQo+ICsJaTkxNS0+dmJ0LmRz
aS5jb25maWcgPSBrbWVtZHVwKGNvbmZpZywgc2l6ZW9mKHN0cnVjdCBtaXBpX2NvbmZpZyksIEdG
UF9LRVJORUwpOwo+ICsJaWYgKCFpOTE1LT52YnQuZHNpLmNvbmZpZykKPiAgIAkJcmV0dXJuOwo+
ICAgCj4gLQlkZXZfcHJpdi0+dmJ0LmRzaS5wcHMgPSBrbWVtZHVwKHBwcywgc2l6ZW9mKHN0cnVj
dCBtaXBpX3Bwc19kYXRhKSwgR0ZQX0tFUk5FTCk7Cj4gLQlpZiAoIWRldl9wcml2LT52YnQuZHNp
LnBwcykgewo+IC0JCWtmcmVlKGRldl9wcml2LT52YnQuZHNpLmNvbmZpZyk7Cj4gKwlpOTE1LT52
YnQuZHNpLnBwcyA9IGttZW1kdXAocHBzLCBzaXplb2Yoc3RydWN0IG1pcGlfcHBzX2RhdGEpLCBH
RlBfS0VSTkVMKTsKPiArCWlmICghaTkxNS0+dmJ0LmRzaS5wcHMpIHsKPiArCQlrZnJlZShpOTE1
LT52YnQuZHNpLmNvbmZpZyk7Cj4gICAJCXJldHVybjsKPiAgIAl9Cj4gICAKPiAtCXBhcnNlX2Rz
aV9iYWNrbGlnaHRfcG9ydHMoZGV2X3ByaXYsIGJkYi0+dmVyc2lvbiwgcG9ydCk7Cj4gKwlwYXJz
ZV9kc2lfYmFja2xpZ2h0X3BvcnRzKGk5MTUsIGJkYi0+dmVyc2lvbiwgcG9ydCk7Cj4gICAKPiAg
IAkvKiBGSVhNRSBpcyB0aGUgOTAgdnMuIDI3MCBjb3JyZWN0PyAqLwo+ICAgCXN3aXRjaCAoY29u
ZmlnLT5yb3RhdGlvbikgewo+IEBAIC04OTIsMjUgKzg5MiwyNSBAQCBwYXJzZV9taXBpX2NvbmZp
ZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJCSAqIE1vc3QgKGFsbD8p
IFZCVHMgY2xhaW0gMCBkZWdyZWVzIGRlc3BpdGUgaGF2aW5nCj4gICAJCSAqIGFuIHVwc2lkZSBk
b3duIHBhbmVsLCB0aHVzIHdlIGRvIG5vdCB0cnVzdCB0aGlzLgo+ICAgCQkgKi8KPiAtCQlkZXZf
cHJpdi0+dmJ0LmRzaS5vcmllbnRhdGlvbiA9Cj4gKwkJaTkxNS0+dmJ0LmRzaS5vcmllbnRhdGlv
biA9Cj4gICAJCQlEUk1fTU9ERV9QQU5FTF9PUklFTlRBVElPTl9VTktOT1dOOwo+ICAgCQlicmVh
azsKPiAgIAljYXNlIEVOQUJMRV9ST1RBVElPTl85MDoKPiAtCQlkZXZfcHJpdi0+dmJ0LmRzaS5v
cmllbnRhdGlvbiA9Cj4gKwkJaTkxNS0+dmJ0LmRzaS5vcmllbnRhdGlvbiA9Cj4gICAJCQlEUk1f
TU9ERV9QQU5FTF9PUklFTlRBVElPTl9SSUdIVF9VUDsKPiAgIAkJYnJlYWs7Cj4gICAJY2FzZSBF
TkFCTEVfUk9UQVRJT05fMTgwOgo+IC0JCWRldl9wcml2LT52YnQuZHNpLm9yaWVudGF0aW9uID0K
PiArCQlpOTE1LT52YnQuZHNpLm9yaWVudGF0aW9uID0KPiAgIAkJCURSTV9NT0RFX1BBTkVMX09S
SUVOVEFUSU9OX0JPVFRPTV9VUDsKPiAgIAkJYnJlYWs7Cj4gICAJY2FzZSBFTkFCTEVfUk9UQVRJ
T05fMjcwOgo+IC0JCWRldl9wcml2LT52YnQuZHNpLm9yaWVudGF0aW9uID0KPiArCQlpOTE1LT52
YnQuZHNpLm9yaWVudGF0aW9uID0KPiAgIAkJCURSTV9NT0RFX1BBTkVMX09SSUVOVEFUSU9OX0xF
RlRfVVA7Cj4gICAJCWJyZWFrOwo+ICAgCX0KPiAgIAo+ICAgCS8qIFdlIGhhdmUgbWFuZGF0b3J5
IG1pcGkgY29uZmlnIGJsb2Nrcy4gSW5pdGlhbGl6ZSBhcyBnZW5lcmljIHBhbmVsICovCj4gLQlk
ZXZfcHJpdi0+dmJ0LmRzaS5wYW5lbF9pZCA9IE1JUElfRFNJX0dFTkVSSUNfUEFORUxfSUQ7Cj4g
KwlpOTE1LT52YnQuZHNpLnBhbmVsX2lkID0gTUlQSV9EU0lfR0VORVJJQ19QQU5FTF9JRDsKPiAg
IH0KPiAgIAo+ICAgLyogRmluZCB0aGUgc2VxdWVuY2UgYmxvY2sgYW5kIHNpemUgZm9yIHRoZSBn
aXZlbiBwYW5lbC4gKi8KPiBAQCAtMTA3MywxMiArMTA3MywxMiBAQCBzdGF0aWMgaW50IGdvdG9f
bmV4dF9zZXF1ZW5jZV92Myhjb25zdCB1OCAqZGF0YSwgaW50IGluZGV4LCBpbnQgdG90YWwpCj4g
ICAgKiBHZXQgbGVuIG9mIHByZS1maXhlZCBkZWFzc2VydCBmcmFnbWVudCBmcm9tIGEgdjEgaW5p
dCBPVFAgc2VxdWVuY2UsCj4gICAgKiBza2lwIGFsbCBkZWxheSArIGdwaW8gb3BlcmFuZHMgYW5k
IHN0b3AgYXQgdGhlIGZpcnN0IERTSSBwYWNrZXQgb3AuCj4gICAgKi8KPiAtc3RhdGljIGludCBn
ZXRfaW5pdF9vdHBfZGVhc3NlcnRfZnJhZ21lbnRfbGVuKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiArc3RhdGljIGludCBnZXRfaW5pdF9vdHBfZGVhc3NlcnRfZnJhZ21lbnRf
bGVuKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JY29uc3QgdTggKmRh
dGEgPSBkZXZfcHJpdi0+dmJ0LmRzaS5zZXF1ZW5jZVtNSVBJX1NFUV9JTklUX09UUF07Cj4gKwlj
b25zdCB1OCAqZGF0YSA9IGk5MTUtPnZidC5kc2kuc2VxdWVuY2VbTUlQSV9TRVFfSU5JVF9PVFBd
Owo+ICAgCWludCBpbmRleCwgbGVuOwo+ICAgCj4gLQlpZiAoV0FSTl9PTighZGF0YSB8fCBkZXZf
cHJpdi0+dmJ0LmRzaS5zZXFfdmVyc2lvbiAhPSAxKSkKPiArCWlmIChXQVJOX09OKCFkYXRhIHx8
IGk5MTUtPnZidC5kc2kuc2VxX3ZlcnNpb24gIT0gMSkpCj4gICAJCXJldHVybiAwOwo+ICAgCj4g
ICAJLyogaW5kZXggPSAxIHRvIHNraXAgc2VxdWVuY2UgYnl0ZSAqLwo+IEBAIC0xMTA2LDU0ICsx
MTA2LDU0IEBAIHN0YXRpYyBpbnQgZ2V0X2luaXRfb3RwX2RlYXNzZXJ0X2ZyYWdtZW50X2xlbihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAgKiB0aGVzZSBkZXZpY2VzIHdl
IHNwbGl0IHRoZSBpbml0IE9UUCBzZXF1ZW5jZSBpbnRvIGEgZGVhc3NlcnQgc2VxdWVuY2UgYW5k
Cj4gICAgKiB0aGUgYWN0dWFsIGluaXQgT1RQIHBhcnQuCj4gICAgKi8KPiAtc3RhdGljIHZvaWQg
Zml4dXBfbWlwaV9zZXF1ZW5jZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ICtzdGF0aWMgdm9pZCBmaXh1cF9taXBpX3NlcXVlbmNlcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKPiAgIHsKPiAgIAl1OCAqaW5pdF9vdHA7Cj4gICAJaW50IGxlbjsKPiAgIAo+ICAg
CS8qIExpbWl0IHRoaXMgdG8gVkxWIGZvciBub3cuICovCj4gLQlpZiAoIUlTX1ZBTExFWVZJRVco
ZGV2X3ByaXYpKQo+ICsJaWYgKCFJU19WQUxMRVlWSUVXKGk5MTUpKQo+ICAgCQlyZXR1cm47Cj4g
ICAKPiAgIAkvKiBMaW1pdCB0aGlzIHRvIHYxIHZpZC1tb2RlIHNlcXVlbmNlcyAqLwo+IC0JaWYg
KGRldl9wcml2LT52YnQuZHNpLmNvbmZpZy0+aXNfY21kX21vZGUgfHwKPiAtCSAgICBkZXZfcHJp
di0+dmJ0LmRzaS5zZXFfdmVyc2lvbiAhPSAxKQo+ICsJaWYgKGk5MTUtPnZidC5kc2kuY29uZmln
LT5pc19jbWRfbW9kZSB8fAo+ICsJICAgIGk5MTUtPnZidC5kc2kuc2VxX3ZlcnNpb24gIT0gMSkK
PiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJLyogT25seSBkbyB0aGlzIGlmIHRoZXJlIGFyZSBvdHAg
YW5kIGFzc2VydCBzZXFzIGFuZCBubyBkZWFzc2VydCBzZXEgKi8KPiAtCWlmICghZGV2X3ByaXYt
PnZidC5kc2kuc2VxdWVuY2VbTUlQSV9TRVFfSU5JVF9PVFBdIHx8Cj4gLQkgICAgIWRldl9wcml2
LT52YnQuZHNpLnNlcXVlbmNlW01JUElfU0VRX0FTU0VSVF9SRVNFVF0gfHwKPiAtCSAgICBkZXZf
cHJpdi0+dmJ0LmRzaS5zZXF1ZW5jZVtNSVBJX1NFUV9ERUFTU0VSVF9SRVNFVF0pCj4gKwlpZiAo
IWk5MTUtPnZidC5kc2kuc2VxdWVuY2VbTUlQSV9TRVFfSU5JVF9PVFBdIHx8Cj4gKwkgICAgIWk5
MTUtPnZidC5kc2kuc2VxdWVuY2VbTUlQSV9TRVFfQVNTRVJUX1JFU0VUXSB8fAo+ICsJICAgIGk5
MTUtPnZidC5kc2kuc2VxdWVuY2VbTUlQSV9TRVFfREVBU1NFUlRfUkVTRVRdKQo+ICAgCQlyZXR1
cm47Cj4gICAKPiAgIAkvKiBUaGUgZGVhc3NlcnQtc2VxdWVuY2UgZW5kcyBhdCB0aGUgZmlyc3Qg
RFNJIHBhY2tldCAqLwo+IC0JbGVuID0gZ2V0X2luaXRfb3RwX2RlYXNzZXJ0X2ZyYWdtZW50X2xl
bihkZXZfcHJpdik7Cj4gKwlsZW4gPSBnZXRfaW5pdF9vdHBfZGVhc3NlcnRfZnJhZ21lbnRfbGVu
KGk5MTUpOwo+ICAgCWlmICghbGVuKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAlEUk1fREVCVUdf
S01TKCJVc2luZyBpbml0IE9UUCBmcmFnbWVudCB0byBkZWFzc2VydCByZXNldFxuIik7Cj4gICAK
PiAgIAkvKiBDb3B5IHRoZSBmcmFnbWVudCwgdXBkYXRlIHNlcSBieXRlIGFuZCB0ZXJtaW5hdGUg
aXQgKi8KPiAtCWluaXRfb3RwID0gKHU4ICopZGV2X3ByaXYtPnZidC5kc2kuc2VxdWVuY2VbTUlQ
SV9TRVFfSU5JVF9PVFBdOwo+IC0JZGV2X3ByaXYtPnZidC5kc2kuZGVhc3NlcnRfc2VxID0ga21l
bWR1cChpbml0X290cCwgbGVuICsgMSwgR0ZQX0tFUk5FTCk7Cj4gLQlpZiAoIWRldl9wcml2LT52
YnQuZHNpLmRlYXNzZXJ0X3NlcSkKPiArCWluaXRfb3RwID0gKHU4ICopaTkxNS0+dmJ0LmRzaS5z
ZXF1ZW5jZVtNSVBJX1NFUV9JTklUX09UUF07Cj4gKwlpOTE1LT52YnQuZHNpLmRlYXNzZXJ0X3Nl
cSA9IGttZW1kdXAoaW5pdF9vdHAsIGxlbiArIDEsIEdGUF9LRVJORUwpOwo+ICsJaWYgKCFpOTE1
LT52YnQuZHNpLmRlYXNzZXJ0X3NlcSkKPiAgIAkJcmV0dXJuOwo+IC0JZGV2X3ByaXYtPnZidC5k
c2kuZGVhc3NlcnRfc2VxWzBdID0gTUlQSV9TRVFfREVBU1NFUlRfUkVTRVQ7Cj4gLQlkZXZfcHJp
di0+dmJ0LmRzaS5kZWFzc2VydF9zZXFbbGVuXSA9IE1JUElfU0VRX0VMRU1fRU5EOwo+ICsJaTkx
NS0+dmJ0LmRzaS5kZWFzc2VydF9zZXFbMF0gPSBNSVBJX1NFUV9ERUFTU0VSVF9SRVNFVDsKPiAr
CWk5MTUtPnZidC5kc2kuZGVhc3NlcnRfc2VxW2xlbl0gPSBNSVBJX1NFUV9FTEVNX0VORDsKPiAg
IAkvKiBVc2UgdGhlIGNvcHkgZm9yIGRlYXNzZXJ0ICovCj4gLQlkZXZfcHJpdi0+dmJ0LmRzaS5z
ZXF1ZW5jZVtNSVBJX1NFUV9ERUFTU0VSVF9SRVNFVF0gPQo+IC0JCWRldl9wcml2LT52YnQuZHNp
LmRlYXNzZXJ0X3NlcTsKPiArCWk5MTUtPnZidC5kc2kuc2VxdWVuY2VbTUlQSV9TRVFfREVBU1NF
UlRfUkVTRVRdID0KPiArCQlpOTE1LT52YnQuZHNpLmRlYXNzZXJ0X3NlcTsKPiAgIAkvKiBSZXBs
YWNlIHRoZSBsYXN0IGJ5dGUgb2YgdGhlIGZyYWdtZW50IHdpdGggaW5pdCBPVFAgc2VxIGJ5dGUg
Ki8KPiAgIAlpbml0X290cFtsZW4gLSAxXSA9IE1JUElfU0VRX0lOSVRfT1RQOwo+ICAgCS8qIEFu
ZCBtYWtlIE1JUElfTUlQSV9TRVFfSU5JVF9PVFAgcG9pbnQgdG8gaXQgKi8KPiAtCWRldl9wcml2
LT52YnQuZHNpLnNlcXVlbmNlW01JUElfU0VRX0lOSVRfT1RQXSA9IGluaXRfb3RwICsgbGVuIC0g
MTsKPiArCWk5MTUtPnZidC5kc2kuc2VxdWVuY2VbTUlQSV9TRVFfSU5JVF9PVFBdID0gaW5pdF9v
dHAgKyBsZW4gLSAxOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZAo+IC1wYXJzZV9taXBpX3Nl
cXVlbmNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArcGFyc2VfbWlwaV9z
ZXF1ZW5jZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJICAgIGNvbnN0IHN0
cnVjdCBiZGJfaGVhZGVyICpiZGIpCj4gICB7Cj4gLQlpbnQgcGFuZWxfdHlwZSA9IGRldl9wcml2
LT52YnQucGFuZWxfdHlwZTsKPiArCWludCBwYW5lbF90eXBlID0gaTkxNS0+dmJ0LnBhbmVsX3R5
cGU7Cj4gICAJY29uc3Qgc3RydWN0IGJkYl9taXBpX3NlcXVlbmNlICpzZXF1ZW5jZTsKPiAgIAlj
b25zdCB1OCAqc2VxX2RhdGE7Cj4gICAJdTMyIHNlcV9zaXplOwo+IEBAIC0xMTYxLDcgKzExNjEs
NyBAQCBwYXJzZV9taXBpX3NlcXVlbmNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiAgIAlpbnQgaW5kZXggPSAwOwo+ICAgCj4gICAJLyogT25seSBvdXIgZ2VuZXJpYyBwYW5l
bCBkcml2ZXIgdXNlcyB0aGUgc2VxdWVuY2UgYmxvY2suICovCj4gLQlpZiAoZGV2X3ByaXYtPnZi
dC5kc2kucGFuZWxfaWQgIT0gTUlQSV9EU0lfR0VORVJJQ19QQU5FTF9JRCkKPiArCWlmIChpOTE1
LT52YnQuZHNpLnBhbmVsX2lkICE9IE1JUElfRFNJX0dFTkVSSUNfUEFORUxfSUQpCj4gICAJCXJl
dHVybjsKPiAgIAo+ICAgCXNlcXVlbmNlID0gZmluZF9zZWN0aW9uKGJkYiwgQkRCX01JUElfU0VR
VUVOQ0UpOwo+IEBAIC0xMjAyLDcgKzEyMDIsNyBAQCBwYXJzZV9taXBpX3NlcXVlbmNlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkJaWYgKHNlcV9pZCA9PSBNSVBJX1NF
UV9URUFSX09OIHx8IHNlcV9pZCA9PSBNSVBJX1NFUV9URUFSX09GRikKPiAgIAkJCURSTV9ERUJV
R19LTVMoIlVuc3VwcG9ydGVkIHNlcXVlbmNlICV1XG4iLCBzZXFfaWQpOwo+ICAgCj4gLQkJZGV2
X3ByaXYtPnZidC5kc2kuc2VxdWVuY2Vbc2VxX2lkXSA9IGRhdGEgKyBpbmRleDsKPiArCQlpOTE1
LT52YnQuZHNpLnNlcXVlbmNlW3NlcV9pZF0gPSBkYXRhICsgaW5kZXg7Cj4gICAKPiAgIAkJaWYg
KHNlcXVlbmNlLT52ZXJzaW9uID49IDMpCj4gICAJCQlpbmRleCA9IGdvdG9fbmV4dF9zZXF1ZW5j
ZV92MyhkYXRhLCBpbmRleCwgc2VxX3NpemUpOwo+IEBAIC0xMjE0LDE4ICsxMjE0LDE4IEBAIHBh
cnNlX21pcGlfc2VxdWVuY2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAg
CQl9Cj4gICAJfQo+ICAgCj4gLQlkZXZfcHJpdi0+dmJ0LmRzaS5kYXRhID0gZGF0YTsKPiAtCWRl
dl9wcml2LT52YnQuZHNpLnNpemUgPSBzZXFfc2l6ZTsKPiAtCWRldl9wcml2LT52YnQuZHNpLnNl
cV92ZXJzaW9uID0gc2VxdWVuY2UtPnZlcnNpb247Cj4gKwlpOTE1LT52YnQuZHNpLmRhdGEgPSBk
YXRhOwo+ICsJaTkxNS0+dmJ0LmRzaS5zaXplID0gc2VxX3NpemU7Cj4gKwlpOTE1LT52YnQuZHNp
LnNlcV92ZXJzaW9uID0gc2VxdWVuY2UtPnZlcnNpb247Cj4gICAKPiAtCWZpeHVwX21pcGlfc2Vx
dWVuY2VzKGRldl9wcml2KTsKPiArCWZpeHVwX21pcGlfc2VxdWVuY2VzKGk5MTUpOwo+ICAgCj4g
ICAJRFJNX0RFQlVHX0RSSVZFUigiTUlQSSByZWxhdGVkIFZCVCBwYXJzaW5nIGNvbXBsZXRlXG4i
KTsKPiAgIAlyZXR1cm47Cj4gICAKPiAgIGVycjoKPiAgIAlrZnJlZShkYXRhKTsKPiAtCW1lbXNl
dChkZXZfcHJpdi0+dmJ0LmRzaS5zZXF1ZW5jZSwgMCwgc2l6ZW9mKGRldl9wcml2LT52YnQuZHNp
LnNlcXVlbmNlKSk7Cj4gKwltZW1zZXQoaTkxNS0+dmJ0LmRzaS5zZXF1ZW5jZSwgMCwgc2l6ZW9m
KGk5MTUtPnZidC5kc2kuc2VxdWVuY2UpKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHU4IHRyYW5z
bGF0ZV9pYm9vc3QodTggdmFsKQo+IEBAIC0xMjU0LDE2ICsxMjU0LDE2IEBAIHN0YXRpYyBlbnVt
IHBvcnQgZ2V0X3BvcnRfYnlfZGRjX3BpbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwg
dTggZGRjX3BpbikKPiAgIAlyZXR1cm4gUE9SVF9OT05FOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2
b2lkIHNhbml0aXplX2RkY19waW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICtzdGF0aWMgdm9pZCBzYW5pdGl6ZV9kZGNfcGluKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ICAgCQkJICAgICBlbnVtIHBvcnQgcG9ydCkKPiAgIHsKPiAtCXN0cnVjdCBkZGlfdmJ0
X3BvcnRfaW5mbyAqaW5mbyA9ICZkZXZfcHJpdi0+dmJ0LmRkaV9wb3J0X2luZm9bcG9ydF07Cj4g
KwlzdHJ1Y3QgZGRpX3ZidF9wb3J0X2luZm8gKmluZm8gPSAmaTkxNS0+dmJ0LmRkaV9wb3J0X2lu
Zm9bcG9ydF07Cj4gICAJZW51bSBwb3J0IHA7Cj4gICAKPiAgIAlpZiAoIWluZm8tPmFsdGVybmF0
ZV9kZGNfcGluKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCXAgPSBnZXRfcG9ydF9ieV9kZGNfcGlu
KGRldl9wcml2LCBpbmZvLT5hbHRlcm5hdGVfZGRjX3Bpbik7Cj4gKwlwID0gZ2V0X3BvcnRfYnlf
ZGRjX3BpbihpOTE1LCBpbmZvLT5hbHRlcm5hdGVfZGRjX3Bpbik7Cj4gICAJaWYgKHAgIT0gUE9S
VF9OT05FKSB7Cj4gICAJCURSTV9ERUJVR19LTVMoInBvcnQgJWMgdHJ5aW5nIHRvIHVzZSB0aGUg
c2FtZSBEREMgcGluICgweCV4KSBhcyBwb3J0ICVjLCAiCj4gICAJCQkgICAgICAiZGlzYWJsaW5n
IHBvcnQgJWMgRFZJL0hETUkgc3VwcG9ydFxuIiwKPiBAQCAtMTMwMCwxNiArMTMwMCwxNiBAQCBz
dGF0aWMgZW51bSBwb3J0IGdldF9wb3J0X2J5X2F1eF9jaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwgdTggYXV4X2NoKQo+ICAgCXJldHVybiBQT1JUX05PTkU7Cj4gICB9Cj4gICAKPiAt
c3RhdGljIHZvaWQgc2FuaXRpemVfYXV4X2NoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiArc3RhdGljIHZvaWQgc2FuaXRpemVfYXV4X2NoKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAo+ICAgCQkJICAgIGVudW0gcG9ydCBwb3J0KQo+ICAgewo+IC0Jc3RydWN0IGRk
aV92YnRfcG9ydF9pbmZvICppbmZvID0gJmRldl9wcml2LT52YnQuZGRpX3BvcnRfaW5mb1twb3J0
XTsKPiArCXN0cnVjdCBkZGlfdmJ0X3BvcnRfaW5mbyAqaW5mbyA9ICZpOTE1LT52YnQuZGRpX3Bv
cnRfaW5mb1twb3J0XTsKPiAgIAllbnVtIHBvcnQgcDsKPiAgIAo+ICAgCWlmICghaW5mby0+YWx0
ZXJuYXRlX2F1eF9jaGFubmVsKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCXAgPSBnZXRfcG9ydF9i
eV9hdXhfY2goZGV2X3ByaXYsIGluZm8tPmFsdGVybmF0ZV9hdXhfY2hhbm5lbCk7Cj4gKwlwID0g
Z2V0X3BvcnRfYnlfYXV4X2NoKGk5MTUsIGluZm8tPmFsdGVybmF0ZV9hdXhfY2hhbm5lbCk7Cj4g
ICAJaWYgKHAgIT0gUE9SVF9OT05FKSB7Cj4gICAJCURSTV9ERUJVR19LTVMoInBvcnQgJWMgdHJ5
aW5nIHRvIHVzZSB0aGUgc2FtZSBBVVggQ0ggKDB4JXgpIGFzIHBvcnQgJWMsICIKPiAgIAkJCSAg
ICAgICJkaXNhYmxpbmcgcG9ydCAlYyBEUCBzdXBwb3J0XG4iLAo+IEBAIC0xMzQ3LDE1ICsxMzQ3
LDE1IEBAIHN0YXRpYyBjb25zdCB1OCBpY3BfZGRjX3Bpbl9tYXBbXSA9IHsKPiAgIAlbSUNMX0RE
Q19CVVNfUE9SVF80XSA9IEdNQlVTX1BJTl8xMl9UQzRfSUNQLAo+ICAgfTsKPiAgIAo+IC1zdGF0
aWMgdTggbWFwX2RkY19waW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1OCB2
YnRfcGluKQo+ICtzdGF0aWMgdTggbWFwX2RkY19waW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsIHU4IHZidF9waW4pCj4gICB7Cj4gICAJY29uc3QgdTggKmRkY19waW5fbWFwOwo+ICAg
CWludCBuX2VudHJpZXM7Cj4gICAKPiAtCWlmIChIQVNfUENIX0lDUChkZXZfcHJpdikpIHsKPiAr
CWlmIChIQVNfUENIX0lDUChpOTE1KSkgewo+ICAgCQlkZGNfcGluX21hcCA9IGljcF9kZGNfcGlu
X21hcDsKPiAgIAkJbl9lbnRyaWVzID0gQVJSQVlfU0laRShpY3BfZGRjX3Bpbl9tYXApOwo+IC0J
fSBlbHNlIGlmIChIQVNfUENIX0NOUChkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAoSEFTX1BD
SF9DTlAoaTkxNSkpIHsKPiAgIAkJZGRjX3Bpbl9tYXAgPSBjbnBfZGRjX3Bpbl9tYXA7Cj4gICAJ
CW5fZW50cmllcyA9IEFSUkFZX1NJWkUoY25wX2RkY19waW5fbWFwKTsKPiAgIAl9IGVsc2Ugewo+
IEBAIC0xNDAxLDcgKzE0MDEsNyBAQCBzdGF0aWMgZW51bSBwb3J0IGR2b19wb3J0X3RvX3BvcnQo
dTggZHZvX3BvcnQpCj4gICAJcmV0dXJuIFBPUlRfTk9ORTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMg
dm9pZCBwYXJzZV9kZGlfcG9ydChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
K3N0YXRpYyB2b2lkIHBhcnNlX2RkaV9wb3J0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAo+ICAgCQkJICAgY29uc3Qgc3RydWN0IGNoaWxkX2RldmljZV9jb25maWcgKmNoaWxkLAo+ICAg
CQkJICAgdTggYmRiX3ZlcnNpb24pCj4gICB7Cj4gQEAgLTE0MTMsNyArMTQxMyw3IEBAIHN0YXRp
YyB2b2lkIHBhcnNlX2RkaV9wb3J0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiAgIAlpZiAocG9ydCA9PSBQT1JUX05PTkUpCj4gICAJCXJldHVybjsKPiAgIAo+IC0JaW5mbyA9
ICZkZXZfcHJpdi0+dmJ0LmRkaV9wb3J0X2luZm9bcG9ydF07Cj4gKwlpbmZvID0gJmk5MTUtPnZi
dC5kZGlfcG9ydF9pbmZvW3BvcnRdOwo+ICAgCj4gICAJaWYgKGluZm8tPmNoaWxkKSB7Cj4gICAJ
CURSTV9ERUJVR19LTVMoIk1vcmUgdGhhbiBvbmUgY2hpbGQgZGV2aWNlIGZvciBwb3J0ICVjIGlu
IFZCVCwgdXNpbmcgdGhlIGZpcnN0LlxuIiwKPiBAQCAtMTQ0Nyw3ICsxNDQ3LDcgQEAgc3RhdGlj
IHZvaWQgcGFyc2VfZGRpX3BvcnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICAgCj4gICAJRFJNX0RFQlVHX0tNUygiUG9ydCAlYyBWQlQgaW5mbzogQ1JUOiVkIERWSTolZCBI
RE1JOiVkIERQOiVkIGVEUDolZCBMU1BDT046JWQgVVNCLVR5cGUtQzolZCBUQlQ6JWRcbiIsCj4g
ICAJCSAgICAgIHBvcnRfbmFtZShwb3J0KSwgaXNfY3J0LCBpc19kdmksIGlzX2hkbWksIGlzX2Rw
LCBpc19lZHAsCj4gLQkJICAgICAgSEFTX0xTUENPTihkZXZfcHJpdikgJiYgY2hpbGQtPmxzcGNv
biwKPiArCQkgICAgICBIQVNfTFNQQ09OKGk5MTUpICYmIGNoaWxkLT5sc3Bjb24sCj4gICAJCSAg
ICAgIGluZm8tPnN1cHBvcnRzX3R5cGVjX3VzYiwgaW5mby0+c3VwcG9ydHNfdGJ0KTsKPiAgIAo+
ICAgCWlmIChpc19lZHAgJiYgaXNfZHZpKQo+IEBAIC0xNDY5LDEwICsxNDY5LDEwIEBAIHN0YXRp
YyB2b2lkIHBhcnNlX2RkaV9wb3J0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiAgIAlpZiAoaXNfZHZpKSB7Cj4gICAJCXU4IGRkY19waW47Cj4gICAKPiAtCQlkZGNfcGluID0g
bWFwX2RkY19waW4oZGV2X3ByaXYsIGNoaWxkLT5kZGNfcGluKTsKPiAtCQlpZiAoaW50ZWxfZ21i
dXNfaXNfdmFsaWRfcGluKGRldl9wcml2LCBkZGNfcGluKSkgewo+ICsJCWRkY19waW4gPSBtYXBf
ZGRjX3BpbihpOTE1LCBjaGlsZC0+ZGRjX3Bpbik7Cj4gKwkJaWYgKGludGVsX2dtYnVzX2lzX3Zh
bGlkX3BpbihpOTE1LCBkZGNfcGluKSkgewo+ICAgCQkJaW5mby0+YWx0ZXJuYXRlX2RkY19waW4g
PSBkZGNfcGluOwo+IC0JCQlzYW5pdGl6ZV9kZGNfcGluKGRldl9wcml2LCBwb3J0KTsKPiArCQkJ
c2FuaXRpemVfZGRjX3BpbihpOTE1LCBwb3J0KTsKPiAgIAkJfSBlbHNlIHsKPiAgIAkJCURSTV9E
RUJVR19LTVMoIlBvcnQgJWMgaGFzIGludmFsaWQgRERDIHBpbiAlZCwgIgo+ICAgCQkJCSAgICAg
ICJzdGlja2luZyB0byBkZWZhdWx0c1xuIiwKPiBAQCAtMTQ4Myw3ICsxNDgzLDcgQEAgc3RhdGlj
IHZvaWQgcGFyc2VfZGRpX3BvcnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICAgCWlmIChpc19kcCkgewo+ICAgCQlpbmZvLT5hbHRlcm5hdGVfYXV4X2NoYW5uZWwgPSBjaGls
ZC0+YXV4X2NoYW5uZWw7Cj4gICAKPiAtCQlzYW5pdGl6ZV9hdXhfY2goZGV2X3ByaXYsIHBvcnQp
Owo+ICsJCXNhbml0aXplX2F1eF9jaChpOTE1LCBwb3J0KTsKPiAgIAl9Cj4gICAKPiAgIAlpZiAo
YmRiX3ZlcnNpb24gPj0gMTU4KSB7Cj4gQEAgLTE1NTMsMjYgKzE1NTMsMjYgQEAgc3RhdGljIHZv
aWQgcGFyc2VfZGRpX3BvcnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAg
CWluZm8tPmNoaWxkID0gY2hpbGQ7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgcGFyc2VfZGRp
X3BvcnRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTggYmRiX3ZlcnNpb24p
Cj4gK3N0YXRpYyB2b2lkIHBhcnNlX2RkaV9wb3J0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwgdTggYmRiX3ZlcnNpb24pCj4gICB7Cj4gICAJY29uc3Qgc3RydWN0IGNoaWxkX2Rldmlj
ZV9jb25maWcgKmNoaWxkOwo+ICAgCWludCBpOwo+ICAgCj4gLQlpZiAoIUhBU19EREkoZGV2X3By
aXYpICYmICFJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiArCWlmICghSEFTX0RESShpOTE1KSAm
JiAhSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJaWYgKGJkYl92
ZXJzaW9uIDwgMTU1KQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCWZvciAoaSA9IDA7IGkgPCBkZXZf
cHJpdi0+dmJ0LmNoaWxkX2Rldl9udW07IGkrKykgewo+IC0JCWNoaWxkID0gZGV2X3ByaXYtPnZi
dC5jaGlsZF9kZXYgKyBpOwo+ICsJZm9yIChpID0gMDsgaSA8IGk5MTUtPnZidC5jaGlsZF9kZXZf
bnVtOyBpKyspIHsKPiArCQljaGlsZCA9IGk5MTUtPnZidC5jaGlsZF9kZXYgKyBpOwo+ICAgCj4g
LQkJcGFyc2VfZGRpX3BvcnQoZGV2X3ByaXYsIGNoaWxkLCBiZGJfdmVyc2lvbik7Cj4gKwkJcGFy
c2VfZGRpX3BvcnQoaTkxNSwgY2hpbGQsIGJkYl92ZXJzaW9uKTsKPiAgIAl9Cj4gICB9Cj4gICAK
PiAgIHN0YXRpYyB2b2lkCj4gLXBhcnNlX2dlbmVyYWxfZGVmaW5pdGlvbnMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtwYXJzZV9nZW5lcmFsX2RlZmluaXRpb25zKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICBjb25zdCBzdHJ1Y3QgYmRiX2hlYWRl
ciAqYmRiKQo+ICAgewo+ICAgCWNvbnN0IHN0cnVjdCBiZGJfZ2VuZXJhbF9kZWZpbml0aW9ucyAq
ZGVmczsKPiBAQCAtMTU5Nyw4ICsxNTk3LDggQEAgcGFyc2VfZ2VuZXJhbF9kZWZpbml0aW9ucyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAKPiAgIAlidXNfcGluID0gZGVm
cy0+Y3J0X2RkY19nbWJ1c19waW47Cj4gICAJRFJNX0RFQlVHX0tNUygiY3J0X2RkY19idXNfcGlu
OiAlZFxuIiwgYnVzX3Bpbik7Cj4gLQlpZiAoaW50ZWxfZ21idXNfaXNfdmFsaWRfcGluKGRldl9w
cml2LCBidXNfcGluKSkKPiAtCQlkZXZfcHJpdi0+dmJ0LmNydF9kZGNfcGluID0gYnVzX3BpbjsK
PiArCWlmIChpbnRlbF9nbWJ1c19pc192YWxpZF9waW4oaTkxNSwgYnVzX3BpbikpCj4gKwkJaTkx
NS0+dmJ0LmNydF9kZGNfcGluID0gYnVzX3BpbjsKPiAgIAo+ICAgCWlmIChiZGItPnZlcnNpb24g
PCAxMDYpIHsKPiAgIAkJZXhwZWN0ZWRfc2l6ZSA9IDIyOwo+IEBAIC0xNjQ1LDEzICsxNjQ1LDEz
IEBAIHBhcnNlX2dlbmVyYWxfZGVmaW5pdGlvbnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ICAgCQlEUk1fREVCVUdfS01TKCJubyBjaGlsZCBkZXYgaXMgcGFyc2VkIGZyb20g
VkJUXG4iKTsKPiAgIAkJcmV0dXJuOwo+ICAgCX0KPiAtCWRldl9wcml2LT52YnQuY2hpbGRfZGV2
ID0ga2NhbGxvYyhjb3VudCwgc2l6ZW9mKCpjaGlsZCksIEdGUF9LRVJORUwpOwo+IC0JaWYgKCFk
ZXZfcHJpdi0+dmJ0LmNoaWxkX2Rldikgewo+ICsJaTkxNS0+dmJ0LmNoaWxkX2RldiA9IGtjYWxs
b2MoY291bnQsIHNpemVvZigqY2hpbGQpLCBHRlBfS0VSTkVMKTsKPiArCWlmICghaTkxNS0+dmJ0
LmNoaWxkX2Rldikgewo+ICAgCQlEUk1fREVCVUdfS01TKCJObyBtZW1vcnkgc3BhY2UgZm9yIGNo
aWxkIGRldmljZVxuIik7Cj4gICAJCXJldHVybjsKPiAgIAl9Cj4gICAKPiAtCWRldl9wcml2LT52
YnQuY2hpbGRfZGV2X251bSA9IGNvdW50Owo+ICsJaTkxNS0+dmJ0LmNoaWxkX2Rldl9udW0gPSBj
b3VudDsKPiAgIAljb3VudCA9IDA7Cj4gICAJZm9yIChpID0gMDsgaSA8IGNoaWxkX2RldmljZV9u
dW07IGkrKykgewo+ICAgCQljaGlsZCA9IGNoaWxkX2RldmljZV9wdHIoZGVmcywgaSk7Cj4gQEAg
LTE2NjMsNyArMTY2Myw3IEBAIHBhcnNlX2dlbmVyYWxfZGVmaW5pdGlvbnMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCQkgKiAoY2hpbGRfZGV2X3NpemUpIG9mIHRoZSBj
aGlsZCBkZXZpY2UuIEFjY2Vzc2luZyB0aGUgZGF0YSBtdXN0Cj4gICAJCSAqIGRlcGVuZCBvbiBW
QlQgdmVyc2lvbi4KPiAgIAkJICovCj4gLQkJbWVtY3B5KGRldl9wcml2LT52YnQuY2hpbGRfZGV2
ICsgY291bnQsIGNoaWxkLAo+ICsJCW1lbWNweShpOTE1LT52YnQuY2hpbGRfZGV2ICsgY291bnQs
IGNoaWxkLAo+ICAgCQkgICAgICAgbWluX3Qoc2l6ZV90LCBkZWZzLT5jaGlsZF9kZXZfc2l6ZSwg
c2l6ZW9mKCpjaGlsZCkpKTsKPiAgIAkJY291bnQrKzsKPiAgIAl9Cj4gQEAgLTE2NzEsNDEgKzE2
NzEsNDEgQEAgcGFyc2VfZ2VuZXJhbF9kZWZpbml0aW9ucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gICAKPiAgIC8qIENvbW1vbiBkZWZhdWx0cyB3aGljaCBtYXkgYmUgb3Zl
cnJpZGRlbiBieSBWQlQuICovCj4gICBzdGF0aWMgdm9pZAo+IC1pbml0X3ZidF9kZWZhdWx0cyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK2luaXRfdmJ0X2RlZmF1bHRzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCWVudW0gcG9ydCBwb3J0Owo+
ICAgCj4gLQlkZXZfcHJpdi0+dmJ0LmNydF9kZGNfcGluID0gR01CVVNfUElOX1ZHQUREQzsKPiAr
CWk5MTUtPnZidC5jcnRfZGRjX3BpbiA9IEdNQlVTX1BJTl9WR0FEREM7Cj4gICAKPiAgIAkvKiBE
ZWZhdWx0IHRvIGhhdmluZyBiYWNrbGlnaHQgKi8KPiAtCWRldl9wcml2LT52YnQuYmFja2xpZ2h0
LnByZXNlbnQgPSB0cnVlOwo+ICsJaTkxNS0+dmJ0LmJhY2tsaWdodC5wcmVzZW50ID0gdHJ1ZTsK
PiAgIAo+ICAgCS8qIExGUCBwYW5lbCBkYXRhICovCj4gLQlkZXZfcHJpdi0+dmJ0Lmx2ZHNfZGl0
aGVyID0gMTsKPiArCWk5MTUtPnZidC5sdmRzX2RpdGhlciA9IDE7Cj4gICAKPiAgIAkvKiBTRFZP
IHBhbmVsIGRhdGEgKi8KPiAtCWRldl9wcml2LT52YnQuc2R2b19sdmRzX3ZidF9tb2RlID0gTlVM
TDsKPiArCWk5MTUtPnZidC5zZHZvX2x2ZHNfdmJ0X21vZGUgPSBOVUxMOwo+ICAgCj4gICAJLyog
Z2VuZXJhbCBmZWF0dXJlcyAqLwo+IC0JZGV2X3ByaXYtPnZidC5pbnRfdHZfc3VwcG9ydCA9IDE7
Cj4gLQlkZXZfcHJpdi0+dmJ0LmludF9jcnRfc3VwcG9ydCA9IDE7Cj4gKwlpOTE1LT52YnQuaW50
X3R2X3N1cHBvcnQgPSAxOwo+ICsJaTkxNS0+dmJ0LmludF9jcnRfc3VwcG9ydCA9IDE7Cj4gICAK
PiAgIAkvKiBkcml2ZXIgZmVhdHVyZXMgKi8KPiAtCWRldl9wcml2LT52YnQuaW50X2x2ZHNfc3Vw
cG9ydCA9IDE7Cj4gKwlpOTE1LT52YnQuaW50X2x2ZHNfc3VwcG9ydCA9IDE7Cj4gICAKPiAgIAkv
KiBEZWZhdWx0IHRvIHVzaW5nIFNTQyAqLwo+IC0JZGV2X3ByaXYtPnZidC5sdmRzX3VzZV9zc2Mg
PSAxOwo+ICsJaTkxNS0+dmJ0Lmx2ZHNfdXNlX3NzYyA9IDE7Cj4gICAJLyoKPiAgIAkgKiBDb3Jl
L1NhbmR5QnJpZGdlL0l2eUJyaWRnZSB1c2UgYWx0ZXJuYXRpdmUgKDEyME1IeikgcmVmZXJlbmNl
Cj4gICAJICogY2xvY2sgZm9yIExWRFMuCj4gICAJICovCj4gLQlkZXZfcHJpdi0+dmJ0Lmx2ZHNf
c3NjX2ZyZXEgPSBpbnRlbF9iaW9zX3NzY19mcmVxdWVuY3koZGV2X3ByaXYsCj4gLQkJCSFIQVNf
UENIX1NQTElUKGRldl9wcml2KSk7Cj4gLQlEUk1fREVCVUdfS01TKCJTZXQgZGVmYXVsdCB0byBT
U0MgYXQgJWQga0h6XG4iLCBkZXZfcHJpdi0+dmJ0Lmx2ZHNfc3NjX2ZyZXEpOwo+ICsJaTkxNS0+
dmJ0Lmx2ZHNfc3NjX2ZyZXEgPSBpbnRlbF9iaW9zX3NzY19mcmVxdWVuY3koaTkxNSwKPiArCQkJ
IUhBU19QQ0hfU1BMSVQoaTkxNSkpOwo+ICsJRFJNX0RFQlVHX0tNUygiU2V0IGRlZmF1bHQgdG8g
U1NDIGF0ICVkIGtIelxuIiwgaTkxNS0+dmJ0Lmx2ZHNfc3NjX2ZyZXEpOwo+ICAgCj4gICAJZm9y
IChwb3J0ID0gUE9SVF9BOyBwb3J0IDwgSTkxNV9NQVhfUE9SVFM7IHBvcnQrKykgewo+ICAgCQlz
dHJ1Y3QgZGRpX3ZidF9wb3J0X2luZm8gKmluZm8gPQo+IC0JCQkmZGV2X3ByaXYtPnZidC5kZGlf
cG9ydF9pbmZvW3BvcnRdOwo+ICsJCQkmaTkxNS0+dmJ0LmRkaV9wb3J0X2luZm9bcG9ydF07Cj4g
ICAKPiAgIAkJaW5mby0+aGRtaV9sZXZlbF9zaGlmdCA9IEhETUlfTEVWRUxfU0hJRlRfVU5LTk9X
TjsKPiAgIAl9Cj4gQEAgLTE3MTMsMTkgKzE3MTMsMTkgQEAgaW5pdF92YnRfZGVmYXVsdHMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCj4gICAvKiBEZWZhdWx0cyB0byBp
bml0aWFsaXplIG9ubHkgaWYgdGhlcmUgaXMgbm8gVkJULiAqLwo+ICAgc3RhdGljIHZvaWQKPiAt
aW5pdF92YnRfbWlzc2luZ19kZWZhdWx0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gK2luaXRfdmJ0X21pc3NpbmdfZGVmYXVsdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCj4gICB7Cj4gICAJZW51bSBwb3J0IHBvcnQ7Cj4gICAKPiAgIAlmb3IgKHBvcnQgPSBQ
T1JUX0E7IHBvcnQgPCBJOTE1X01BWF9QT1JUUzsgcG9ydCsrKSB7Cj4gICAJCXN0cnVjdCBkZGlf
dmJ0X3BvcnRfaW5mbyAqaW5mbyA9Cj4gLQkJCSZkZXZfcHJpdi0+dmJ0LmRkaV9wb3J0X2luZm9b
cG9ydF07Cj4gKwkJCSZpOTE1LT52YnQuZGRpX3BvcnRfaW5mb1twb3J0XTsKPiAgIAo+ICAgCQkv
Kgo+ICAgCQkgKiBWQlQgaGFzIHRoZSBUeXBlQyBtb2RlIChuYXRpdmUsVEJUL1VTQikgYW5kIHdl
IGRvbid0IHdhbnQKPiAgIAkJICogdG8gZGV0ZWN0IGl0Lgo+ICAgCQkgKi8KPiAtCQlpZiAoaW50
ZWxfcG9ydF9pc190YyhkZXZfcHJpdiwgcG9ydCkpCj4gKwkJaWYgKGludGVsX3BvcnRfaXNfdGMo
aTkxNSwgcG9ydCkpCj4gICAJCQljb250aW51ZTsKPiAgIAo+ICAgCQlpbmZvLT5zdXBwb3J0c19k
dmkgPSAocG9ydCAhPSBQT1JUX0EgJiYgcG9ydCAhPSBQT1JUX0UpOwo+IEBAIC0xODExLDI1ICsx
ODExLDI1IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgdmJ0X2hlYWRlciAqZmluZF92YnQodm9pZCBf
X2lvbWVtICpiaW9zLCBzaXplX3Qgc2l6ZSkKPiAgIAo+ICAgLyoqCj4gICAgKiBpbnRlbF9iaW9z
X2luaXQgLSBmaW5kIFZCVCBhbmQgaW5pdGlhbGl6ZSBzZXR0aW5ncyBmcm9tIHRoZSBCSU9TCj4g
LSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiArICogQGk5MTU6IGk5MTUgZGV2
aWNlIGluc3RhbmNlCj4gICAgKgo+ICAgICogUGFyc2UgYW5kIGluaXRpYWxpemUgc2V0dGluZ3Mg
ZnJvbSB0aGUgVmlkZW8gQklPUyBUYWJsZXMgKFZCVCkuIElmIHRoZSBWQlQKPiAgICAqIHdhcyBu
b3QgZm91bmQgaW4gQUNQSSBPcFJlZ2lvbiwgdHJ5IHRvIGZpbmQgaXQgaW4gUENJIFJPTSBmaXJz
dC4gQWxzbwo+ICAgICogaW5pdGlhbGl6ZSBzb21lIGRlZmF1bHRzIGlmIHRoZSBWQlQgaXMgbm90
IHByZXNlbnQgYXQgYWxsLgo+ICAgICovCj4gLXZvaWQgaW50ZWxfYmlvc19pbml0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBpbnRlbF9iaW9zX2luaXQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9
IGRldl9wcml2LT5kcm0ucGRldjsKPiAtCWNvbnN0IHN0cnVjdCB2YnRfaGVhZGVyICp2YnQgPSBk
ZXZfcHJpdi0+b3ByZWdpb24udmJ0Owo+ICsJc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBpOTE1LT5k
cm0ucGRldjsKPiArCWNvbnN0IHN0cnVjdCB2YnRfaGVhZGVyICp2YnQgPSBpOTE1LT5vcHJlZ2lv
bi52YnQ7Cj4gICAJY29uc3Qgc3RydWN0IGJkYl9oZWFkZXIgKmJkYjsKPiAgIAl1OCBfX2lvbWVt
ICpiaW9zID0gTlVMTDsKPiAgIAo+IC0JaWYgKCFIQVNfRElTUExBWShkZXZfcHJpdikpIHsKPiAr
CWlmICghSEFTX0RJU1BMQVkoaTkxNSkpIHsKPiAgIAkJRFJNX0RFQlVHX0tNUygiU2tpcHBpbmcg
VkJUIGluaXQgZHVlIHRvIGRpc2FibGVkIGRpc3BsYXkuXG4iKTsKPiAgIAkJcmV0dXJuOwo+ICAg
CX0KPiAgIAo+IC0JaW5pdF92YnRfZGVmYXVsdHMoZGV2X3ByaXYpOwo+ICsJaW5pdF92YnRfZGVm
YXVsdHMoaTkxNSk7Cj4gICAKPiAgIAkvKiBJZiB0aGUgT3BSZWdpb24gZG9lcyBub3QgaGF2ZSBW
QlQsIGxvb2sgaW4gUENJIFJPTS4gKi8KPiAgIAlpZiAoIXZidCkgewo+IEBAIC0xODUyLDI1ICsx
ODUyLDI1IEBAIHZvaWQgaW50ZWxfYmlvc19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiAgIAkJICAgICAgKGludClzaXplb2YodmJ0LT5zaWduYXR1cmUpLCB2YnQtPnNp
Z25hdHVyZSwgYmRiLT52ZXJzaW9uKTsKPiAgIAo+ICAgCS8qIEdyYWIgdXNlZnVsIGdlbmVyYWwg
ZGVmaW5pdGlvbnMgKi8KPiAtCXBhcnNlX2dlbmVyYWxfZmVhdHVyZXMoZGV2X3ByaXYsIGJkYik7
Cj4gLQlwYXJzZV9nZW5lcmFsX2RlZmluaXRpb25zKGRldl9wcml2LCBiZGIpOwo+IC0JcGFyc2Vf
bGZwX3BhbmVsX2RhdGEoZGV2X3ByaXYsIGJkYik7Cj4gLQlwYXJzZV9sZnBfYmFja2xpZ2h0KGRl
dl9wcml2LCBiZGIpOwo+IC0JcGFyc2Vfc2R2b19wYW5lbF9kYXRhKGRldl9wcml2LCBiZGIpOwo+
IC0JcGFyc2VfZHJpdmVyX2ZlYXR1cmVzKGRldl9wcml2LCBiZGIpOwo+IC0JcGFyc2VfZWRwKGRl
dl9wcml2LCBiZGIpOwo+IC0JcGFyc2VfcHNyKGRldl9wcml2LCBiZGIpOwo+IC0JcGFyc2VfbWlw
aV9jb25maWcoZGV2X3ByaXYsIGJkYik7Cj4gLQlwYXJzZV9taXBpX3NlcXVlbmNlKGRldl9wcml2
LCBiZGIpOwo+ICsJcGFyc2VfZ2VuZXJhbF9mZWF0dXJlcyhpOTE1LCBiZGIpOwo+ICsJcGFyc2Vf
Z2VuZXJhbF9kZWZpbml0aW9ucyhpOTE1LCBiZGIpOwo+ICsJcGFyc2VfbGZwX3BhbmVsX2RhdGEo
aTkxNSwgYmRiKTsKPiArCXBhcnNlX2xmcF9iYWNrbGlnaHQoaTkxNSwgYmRiKTsKPiArCXBhcnNl
X3Nkdm9fcGFuZWxfZGF0YShpOTE1LCBiZGIpOwo+ICsJcGFyc2VfZHJpdmVyX2ZlYXR1cmVzKGk5
MTUsIGJkYik7Cj4gKwlwYXJzZV9lZHAoaTkxNSwgYmRiKTsKPiArCXBhcnNlX3BzcihpOTE1LCBi
ZGIpOwo+ICsJcGFyc2VfbWlwaV9jb25maWcoaTkxNSwgYmRiKTsKPiArCXBhcnNlX21pcGlfc2Vx
dWVuY2UoaTkxNSwgYmRiKTsKPiAgIAo+ICAgCS8qIEZ1cnRoZXIgcHJvY2Vzc2luZyBvbiBwcmUt
cGFyc2VkIGRhdGEgKi8KPiAtCXBhcnNlX3Nkdm9fZGV2aWNlX21hcHBpbmcoZGV2X3ByaXYsIGJk
Yi0+dmVyc2lvbik7Cj4gLQlwYXJzZV9kZGlfcG9ydHMoZGV2X3ByaXYsIGJkYi0+dmVyc2lvbik7
Cj4gKwlwYXJzZV9zZHZvX2RldmljZV9tYXBwaW5nKGk5MTUsIGJkYi0+dmVyc2lvbik7Cj4gKwlw
YXJzZV9kZGlfcG9ydHMoaTkxNSwgYmRiLT52ZXJzaW9uKTsKPiAgIAo+ICAgb3V0Ogo+ICAgCWlm
ICghdmJ0KSB7Cj4gICAJCURSTV9JTkZPKCJGYWlsZWQgdG8gZmluZCBWQklPUyB0YWJsZXMgKFZC
VClcbiIpOwo+IC0JCWluaXRfdmJ0X21pc3NpbmdfZGVmYXVsdHMoZGV2X3ByaXYpOwo+ICsJCWlu
aXRfdmJ0X21pc3NpbmdfZGVmYXVsdHMoaTkxNSk7Cj4gICAJfQo+ICAgCj4gICAJaWYgKGJpb3Mp
Cj4gQEAgLTE4NzksNDcgKzE4NzksNDcgQEAgdm9pZCBpbnRlbF9iaW9zX2luaXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCj4gICAvKioKPiAgICAqIGludGVsX2Jpb3Nf
Y2xlYW51cCAtIEZyZWUgYW55IHJlc291cmNlcyBhbGxvY2F0ZWQgYnkgaW50ZWxfYmlvc19pbml0
KCkKPiAtICogQGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ICsgKiBAaTkxNTogaTkx
NSBkZXZpY2UgaW5zdGFuY2UKPiAgICAqLwo+IC12b2lkIGludGVsX2Jpb3NfY2xlYW51cChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgaW50ZWxfYmlvc19jbGVhbnVw
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Ja2ZyZWUoZGV2X3ByaXYt
PnZidC5jaGlsZF9kZXYpOwo+IC0JZGV2X3ByaXYtPnZidC5jaGlsZF9kZXYgPSBOVUxMOwo+IC0J
ZGV2X3ByaXYtPnZidC5jaGlsZF9kZXZfbnVtID0gMDsKPiAtCWtmcmVlKGRldl9wcml2LT52YnQu
c2R2b19sdmRzX3ZidF9tb2RlKTsKPiAtCWRldl9wcml2LT52YnQuc2R2b19sdmRzX3ZidF9tb2Rl
ID0gTlVMTDsKPiAtCWtmcmVlKGRldl9wcml2LT52YnQubGZwX2x2ZHNfdmJ0X21vZGUpOwo+IC0J
ZGV2X3ByaXYtPnZidC5sZnBfbHZkc192YnRfbW9kZSA9IE5VTEw7Cj4gLQlrZnJlZShkZXZfcHJp
di0+dmJ0LmRzaS5kYXRhKTsKPiAtCWRldl9wcml2LT52YnQuZHNpLmRhdGEgPSBOVUxMOwo+IC0J
a2ZyZWUoZGV2X3ByaXYtPnZidC5kc2kucHBzKTsKPiAtCWRldl9wcml2LT52YnQuZHNpLnBwcyA9
IE5VTEw7Cj4gLQlrZnJlZShkZXZfcHJpdi0+dmJ0LmRzaS5jb25maWcpOwo+IC0JZGV2X3ByaXYt
PnZidC5kc2kuY29uZmlnID0gTlVMTDsKPiAtCWtmcmVlKGRldl9wcml2LT52YnQuZHNpLmRlYXNz
ZXJ0X3NlcSk7Cj4gLQlkZXZfcHJpdi0+dmJ0LmRzaS5kZWFzc2VydF9zZXEgPSBOVUxMOwo+ICsJ
a2ZyZWUoaTkxNS0+dmJ0LmNoaWxkX2Rldik7Cj4gKwlpOTE1LT52YnQuY2hpbGRfZGV2ID0gTlVM
TDsKPiArCWk5MTUtPnZidC5jaGlsZF9kZXZfbnVtID0gMDsKPiArCWtmcmVlKGk5MTUtPnZidC5z
ZHZvX2x2ZHNfdmJ0X21vZGUpOwo+ICsJaTkxNS0+dmJ0LnNkdm9fbHZkc192YnRfbW9kZSA9IE5V
TEw7Cj4gKwlrZnJlZShpOTE1LT52YnQubGZwX2x2ZHNfdmJ0X21vZGUpOwo+ICsJaTkxNS0+dmJ0
LmxmcF9sdmRzX3ZidF9tb2RlID0gTlVMTDsKPiArCWtmcmVlKGk5MTUtPnZidC5kc2kuZGF0YSk7
Cj4gKwlpOTE1LT52YnQuZHNpLmRhdGEgPSBOVUxMOwo+ICsJa2ZyZWUoaTkxNS0+dmJ0LmRzaS5w
cHMpOwo+ICsJaTkxNS0+dmJ0LmRzaS5wcHMgPSBOVUxMOwo+ICsJa2ZyZWUoaTkxNS0+dmJ0LmRz
aS5jb25maWcpOwo+ICsJaTkxNS0+dmJ0LmRzaS5jb25maWcgPSBOVUxMOwo+ICsJa2ZyZWUoaTkx
NS0+dmJ0LmRzaS5kZWFzc2VydF9zZXEpOwo+ICsJaTkxNS0+dmJ0LmRzaS5kZWFzc2VydF9zZXEg
PSBOVUxMOwo+ICAgfQo+ICAgCj4gICAvKioKPiAgICAqIGludGVsX2Jpb3NfaXNfdHZfcHJlc2Vu
dCAtIGlzIGludGVncmF0ZWQgVFYgcHJlc2VudCBpbiBWQlQKPiAtICogQGRldl9wcml2OglpOTE1
IGRldmljZSBpbnN0YW5jZQo+ICsgKiBAaTkxNToJaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiAgICAq
Cj4gICAgKiBSZXR1cm4gdHJ1ZSBpZiBUViBpcyBwcmVzZW50LiBJZiBubyBjaGlsZCBkZXZpY2Vz
IHdlcmUgcGFyc2VkIGZyb20gVkJULAo+ICAgICogYXNzdW1lIFRWIGlzIHByZXNlbnQuCj4gICAg
Ki8KPiAtYm9vbCBpbnRlbF9iaW9zX2lzX3R2X3ByZXNlbnQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ICtib29sIGludGVsX2Jpb3NfaXNfdHZfcHJlc2VudChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAljb25zdCBzdHJ1Y3QgY2hpbGRfZGV2aWNl
X2NvbmZpZyAqY2hpbGQ7Cj4gICAJaW50IGk7Cj4gICAKPiAtCWlmICghZGV2X3ByaXYtPnZidC5p
bnRfdHZfc3VwcG9ydCkKPiArCWlmICghaTkxNS0+dmJ0LmludF90dl9zdXBwb3J0KQo+ICAgCQly
ZXR1cm4gZmFsc2U7Cj4gICAKPiAtCWlmICghZGV2X3ByaXYtPnZidC5jaGlsZF9kZXZfbnVtKQo+
ICsJaWYgKCFpOTE1LT52YnQuY2hpbGRfZGV2X251bSkKPiAgIAkJcmV0dXJuIHRydWU7Cj4gICAK
PiAtCWZvciAoaSA9IDA7IGkgPCBkZXZfcHJpdi0+dmJ0LmNoaWxkX2Rldl9udW07IGkrKykgewo+
IC0JCWNoaWxkID0gZGV2X3ByaXYtPnZidC5jaGlsZF9kZXYgKyBpOwo+ICsJZm9yIChpID0gMDsg
aSA8IGk5MTUtPnZidC5jaGlsZF9kZXZfbnVtOyBpKyspIHsKPiArCQljaGlsZCA9IGk5MTUtPnZi
dC5jaGlsZF9kZXYgKyBpOwo+ICAgCQkvKgo+ICAgCQkgKiBJZiB0aGUgZGV2aWNlIHR5cGUgaXMg
bm90IFRWLCBjb250aW51ZS4KPiAgIAkJICovCj4gQEAgLTE5NDMsMjIgKzE5NDMsMjIgQEAgYm9v
bCBpbnRlbF9iaW9zX2lzX3R2X3ByZXNlbnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICAgCj4gICAvKioKPiAgICAqIGludGVsX2Jpb3NfaXNfbHZkc19wcmVzZW50IC0gaXMg
TFZEUyBwcmVzZW50IGluIFZCVAo+IC0gKiBAZGV2X3ByaXY6CWk5MTUgZGV2aWNlIGluc3RhbmNl
Cj4gKyAqIEBpOTE1OglpOTE1IGRldmljZSBpbnN0YW5jZQo+ICAgICogQGkyY19waW46CWkyYyBw
aW4gZm9yIExWRFMgaWYgcHJlc2VudAo+ICAgICoKPiAgICAqIFJldHVybiB0cnVlIGlmIExWRFMg
aXMgcHJlc2VudC4gSWYgbm8gY2hpbGQgZGV2aWNlcyB3ZXJlIHBhcnNlZCBmcm9tIFZCVCwKPiAg
ICAqIGFzc3VtZSBMVkRTIGlzIHByZXNlbnQuCj4gICAgKi8KPiAtYm9vbCBpbnRlbF9iaW9zX2lz
X2x2ZHNfcHJlc2VudChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4ICppMmNf
cGluKQo+ICtib29sIGludGVsX2Jpb3NfaXNfbHZkc19wcmVzZW50KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LCB1OCAqaTJjX3BpbikKPiAgIHsKPiAgIAljb25zdCBzdHJ1Y3QgY2hpbGRf
ZGV2aWNlX2NvbmZpZyAqY2hpbGQ7Cj4gICAJaW50IGk7Cj4gICAKPiAtCWlmICghZGV2X3ByaXYt
PnZidC5jaGlsZF9kZXZfbnVtKQo+ICsJaWYgKCFpOTE1LT52YnQuY2hpbGRfZGV2X251bSkKPiAg
IAkJcmV0dXJuIHRydWU7Cj4gICAKPiAtCWZvciAoaSA9IDA7IGkgPCBkZXZfcHJpdi0+dmJ0LmNo
aWxkX2Rldl9udW07IGkrKykgewo+IC0JCWNoaWxkID0gZGV2X3ByaXYtPnZidC5jaGlsZF9kZXYg
KyBpOwo+ICsJZm9yIChpID0gMDsgaSA8IGk5MTUtPnZidC5jaGlsZF9kZXZfbnVtOyBpKyspIHsK
PiArCQljaGlsZCA9IGk5MTUtPnZidC5jaGlsZF9kZXYgKyBpOwo+ICAgCj4gICAJCS8qIElmIHRo
ZSBkZXZpY2UgdHlwZSBpcyBub3QgTEZQLCBjb250aW51ZS4KPiAgIAkJICogV2UgaGF2ZSB0byBj
aGVjayBib3RoIHRoZSBuZXcgaWRlbnRpZmllcnMgYXMgd2VsbCBhcyB0aGUKPiBAQCAtMTk2OCw3
ICsxOTY4LDcgQEAgYm9vbCBpbnRlbF9iaW9zX2lzX2x2ZHNfcHJlc2VudChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4ICppMmNfcGluKQo+ICAgCQkgICAgY2hpbGQtPmRldmlj
ZV90eXBlICE9IERFVklDRV9UWVBFX0xGUCkKPiAgIAkJCWNvbnRpbnVlOwo+ICAgCj4gLQkJaWYg
KGludGVsX2dtYnVzX2lzX3ZhbGlkX3BpbihkZXZfcHJpdiwgY2hpbGQtPmkyY19waW4pKQo+ICsJ
CWlmIChpbnRlbF9nbWJ1c19pc192YWxpZF9waW4oaTkxNSwgY2hpbGQtPmkyY19waW4pKQo+ICAg
CQkJKmkyY19waW4gPSBjaGlsZC0+aTJjX3BpbjsKPiAgIAo+ICAgCQkvKiBIb3dldmVyLCB3ZSBj
YW5ub3QgdHJ1c3QgdGhlIEJJT1Mgd3JpdGVycyB0byBwb3B1bGF0ZQo+IEBAIC0xOTg0LDcgKzE5
ODQsNyBAQCBib29sIGludGVsX2Jpb3NfaXNfbHZkc19wcmVzZW50KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwgdTggKmkyY19waW4pCj4gICAJCSAqIGFkZGl0aW9uYWwgZGF0YS4g
IFRydXN0IHRoYXQgaWYgdGhlIFZCVCB3YXMgd3JpdHRlbiBpbnRvCj4gICAJCSAqIHRoZSBPcFJl
Z2lvbiB0aGVuIHRoZXkgaGF2ZSB2YWxpZGF0ZWQgdGhlIExWRFMncyBleGlzdGVuY2UuCj4gICAJ
CSAqLwo+IC0JCWlmIChkZXZfcHJpdi0+b3ByZWdpb24udmJ0KQo+ICsJCWlmIChpOTE1LT5vcHJl
Z2lvbi52YnQpCj4gICAJCQlyZXR1cm4gdHJ1ZTsKPiAgIAl9Cj4gICAKPiBAQCAtMTk5MywxMiAr
MTk5MywxMiBAQCBib29sIGludGVsX2Jpb3NfaXNfbHZkc19wcmVzZW50KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwgdTggKmkyY19waW4pCj4gICAKPiAgIC8qKgo+ICAgICogaW50
ZWxfYmlvc19pc19wb3J0X3ByZXNlbnQgLSBpcyB0aGUgc3BlY2lmaWVkIGRpZ2l0YWwgcG9ydCBw
cmVzZW50Cj4gLSAqIEBkZXZfcHJpdjoJaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiArICogQGk5MTU6
CWk5MTUgZGV2aWNlIGluc3RhbmNlCj4gICAgKiBAcG9ydDoJcG9ydCB0byBjaGVjawo+ICAgICoK
PiAgICAqIFJldHVybiB0cnVlIGlmIHRoZSBkZXZpY2UgaW4gJXBvcnQgaXMgcHJlc2VudC4KPiAg
ICAqLwo+IC1ib29sIGludGVsX2Jpb3NfaXNfcG9ydF9wcmVzZW50KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBvcnQpCj4gK2Jvb2wgaW50ZWxfYmlvc19pc19w
b3J0X3ByZXNlbnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gcG9ydCBwb3J0
KQo+ICAgewo+ICAgCWNvbnN0IHN0cnVjdCBjaGlsZF9kZXZpY2VfY29uZmlnICpjaGlsZDsKPiAg
IAlzdGF0aWMgY29uc3Qgc3RydWN0IHsKPiBAQCAtMjAxMiw5ICsyMDEyLDkgQEAgYm9vbCBpbnRl
bF9iaW9zX2lzX3BvcnRfcHJlc2VudChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
IGVudW0gcG9ydCBwb3IKPiAgIAl9Owo+ICAgCWludCBpOwo+ICAgCj4gLQlpZiAoSEFTX0RESShk
ZXZfcHJpdikpIHsKPiArCWlmIChIQVNfRERJKGk5MTUpKSB7Cj4gICAJCWNvbnN0IHN0cnVjdCBk
ZGlfdmJ0X3BvcnRfaW5mbyAqcG9ydF9pbmZvID0KPiAtCQkJJmRldl9wcml2LT52YnQuZGRpX3Bv
cnRfaW5mb1twb3J0XTsKPiArCQkJJmk5MTUtPnZidC5kZGlfcG9ydF9pbmZvW3BvcnRdOwo+ICAg
Cj4gICAJCXJldHVybiBwb3J0X2luZm8tPnN1cHBvcnRzX2RwIHx8Cj4gICAJCSAgICAgICBwb3J0
X2luZm8tPnN1cHBvcnRzX2R2aSB8fAo+IEBAIC0yMDI1LDExICsyMDI1LDExIEBAIGJvb2wgaW50
ZWxfYmlvc19pc19wb3J0X3ByZXNlbnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LCBlbnVtIHBvcnQgcG9yCj4gICAJaWYgKFdBUk5fT04ocG9ydCA9PSBQT1JUX0EpIHx8IHBvcnQg
Pj0gQVJSQVlfU0laRShwb3J0X21hcHBpbmcpKQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gICAKPiAt
CWlmICghZGV2X3ByaXYtPnZidC5jaGlsZF9kZXZfbnVtKQo+ICsJaWYgKCFpOTE1LT52YnQuY2hp
bGRfZGV2X251bSkKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAgCj4gLQlmb3IgKGkgPSAwOyBpIDwg
ZGV2X3ByaXYtPnZidC5jaGlsZF9kZXZfbnVtOyBpKyspIHsKPiAtCQljaGlsZCA9IGRldl9wcml2
LT52YnQuY2hpbGRfZGV2ICsgaTsKPiArCWZvciAoaSA9IDA7IGkgPCBpOTE1LT52YnQuY2hpbGRf
ZGV2X251bTsgaSsrKSB7Cj4gKwkJY2hpbGQgPSBpOTE1LT52YnQuY2hpbGRfZGV2ICsgaTsKPiAg
IAo+ICAgCQlpZiAoKGNoaWxkLT5kdm9fcG9ydCA9PSBwb3J0X21hcHBpbmdbcG9ydF0uZHAgfHwK
PiAgIAkJICAgICBjaGlsZC0+ZHZvX3BvcnQgPT0gcG9ydF9tYXBwaW5nW3BvcnRdLmhkbWkpICYm
Cj4gQEAgLTIwNDMsMTIgKzIwNDMsMTIgQEAgYm9vbCBpbnRlbF9iaW9zX2lzX3BvcnRfcHJlc2Vu
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcG9ydCBwb3IKPiAgIAo+
ICAgLyoqCj4gICAgKiBpbnRlbF9iaW9zX2lzX3BvcnRfZWRwIC0gaXMgdGhlIGRldmljZSBpbiBn
aXZlbiBwb3J0IGVEUAo+IC0gKiBAZGV2X3ByaXY6CWk5MTUgZGV2aWNlIGluc3RhbmNlCj4gKyAq
IEBpOTE1OglpOTE1IGRldmljZSBpbnN0YW5jZQo+ICAgICogQHBvcnQ6CXBvcnQgdG8gY2hlY2sK
PiAgICAqCj4gICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZGV2aWNlIGluICVwb3J0IGlzIGVEUC4K
PiAgICAqLwo+IC1ib29sIGludGVsX2Jpb3NfaXNfcG9ydF9lZHAoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LCBlbnVtIHBvcnQgcG9ydCkKPiArYm9vbCBpbnRlbF9iaW9zX2lzX3Bv
cnRfZWRwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBvcnQgcG9ydCkKPiAg
IHsKPiAgIAljb25zdCBzdHJ1Y3QgY2hpbGRfZGV2aWNlX2NvbmZpZyAqY2hpbGQ7Cj4gICAJc3Rh
dGljIGNvbnN0IHNob3J0IHBvcnRfbWFwcGluZ1tdID0gewo+IEBAIC0yMDYwLDE0ICsyMDYwLDE0
IEBAIGJvb2wgaW50ZWxfYmlvc19pc19wb3J0X2VkcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsIGVudW0gcG9ydCBwb3J0KQo+ICAgCX07Cj4gICAJaW50IGk7Cj4gICAKPiAtCWlm
IChIQVNfRERJKGRldl9wcml2KSkKPiAtCQlyZXR1cm4gZGV2X3ByaXYtPnZidC5kZGlfcG9ydF9p
bmZvW3BvcnRdLnN1cHBvcnRzX2VkcDsKPiArCWlmIChIQVNfRERJKGk5MTUpKQo+ICsJCXJldHVy
biBpOTE1LT52YnQuZGRpX3BvcnRfaW5mb1twb3J0XS5zdXBwb3J0c19lZHA7Cj4gICAKPiAtCWlm
ICghZGV2X3ByaXYtPnZidC5jaGlsZF9kZXZfbnVtKQo+ICsJaWYgKCFpOTE1LT52YnQuY2hpbGRf
ZGV2X251bSkKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAgCj4gLQlmb3IgKGkgPSAwOyBpIDwgZGV2
X3ByaXYtPnZidC5jaGlsZF9kZXZfbnVtOyBpKyspIHsKPiAtCQljaGlsZCA9IGRldl9wcml2LT52
YnQuY2hpbGRfZGV2ICsgaTsKPiArCWZvciAoaSA9IDA7IGkgPCBpOTE1LT52YnQuY2hpbGRfZGV2
X251bTsgaSsrKSB7Cj4gKwkJY2hpbGQgPSBpOTE1LT52YnQuY2hpbGRfZGV2ICsgaTsKPiAgIAo+
ICAgCQlpZiAoY2hpbGQtPmR2b19wb3J0ID09IHBvcnRfbWFwcGluZ1twb3J0XSAmJgo+ICAgCQkg
ICAgKGNoaWxkLT5kZXZpY2VfdHlwZSAmIERFVklDRV9UWVBFX2VEUF9CSVRTKSA9PQo+IEBAIC0y
MTEzLDE0ICsyMTEzLDE0IEBAIHN0YXRpYyBib29sIGNoaWxkX2Rldl9pc19kcF9kdWFsX21vZGUo
Y29uc3Qgc3RydWN0IGNoaWxkX2RldmljZV9jb25maWcgKmNoaWxkLAo+ICAgCXJldHVybiBmYWxz
ZTsKPiAgIH0KPiAgIAo+IC1ib29sIGludGVsX2Jpb3NfaXNfcG9ydF9kcF9kdWFsX21vZGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtib29sIGludGVsX2Jpb3NfaXNfcG9y
dF9kcF9kdWFsX21vZGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAg
ICBlbnVtIHBvcnQgcG9ydCkKPiAgIHsKPiAgIAljb25zdCBzdHJ1Y3QgY2hpbGRfZGV2aWNlX2Nv
bmZpZyAqY2hpbGQ7Cj4gICAJaW50IGk7Cj4gICAKPiAtCWZvciAoaSA9IDA7IGkgPCBkZXZfcHJp
di0+dmJ0LmNoaWxkX2Rldl9udW07IGkrKykgewo+IC0JCWNoaWxkID0gZGV2X3ByaXYtPnZidC5j
aGlsZF9kZXYgKyBpOwo+ICsJZm9yIChpID0gMDsgaSA8IGk5MTUtPnZidC5jaGlsZF9kZXZfbnVt
OyBpKyspIHsKPiArCQljaGlsZCA9IGk5MTUtPnZidC5jaGlsZF9kZXYgKyBpOwo+ICAgCj4gICAJ
CWlmIChjaGlsZF9kZXZfaXNfZHBfZHVhbF9tb2RlKGNoaWxkLCBwb3J0KSkKPiAgIAkJCXJldHVy
biB0cnVlOwo+IEBAIC0yMTMxLDIwICsyMTMxLDIwIEBAIGJvb2wgaW50ZWxfYmlvc19pc19wb3J0
X2RwX2R1YWxfbW9kZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAKPiAg
IC8qKgo+ICAgICogaW50ZWxfYmlvc19pc19kc2lfcHJlc2VudCAtIGlzIERTSSBwcmVzZW50IGlu
IFZCVAo+IC0gKiBAZGV2X3ByaXY6CWk5MTUgZGV2aWNlIGluc3RhbmNlCj4gKyAqIEBpOTE1Oglp
OTE1IGRldmljZSBpbnN0YW5jZQo+ICAgICogQHBvcnQ6CXBvcnQgZm9yIERTSSBpZiBwcmVzZW50
Cj4gICAgKgo+ICAgICogUmV0dXJuIHRydWUgaWYgRFNJIGlzIHByZXNlbnQsIGFuZCByZXR1cm4g
dGhlIHBvcnQgaW4gJXBvcnQuCj4gICAgKi8KPiAtYm9vbCBpbnRlbF9iaW9zX2lzX2RzaV9wcmVz
ZW50KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArYm9vbCBpbnRlbF9iaW9z
X2lzX2RzaV9wcmVzZW50KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAg
ICAgIGVudW0gcG9ydCAqcG9ydCkKPiAgIHsKPiAgIAljb25zdCBzdHJ1Y3QgY2hpbGRfZGV2aWNl
X2NvbmZpZyAqY2hpbGQ7Cj4gICAJdTggZHZvX3BvcnQ7Cj4gICAJaW50IGk7Cj4gICAKPiAtCWZv
ciAoaSA9IDA7IGkgPCBkZXZfcHJpdi0+dmJ0LmNoaWxkX2Rldl9udW07IGkrKykgewo+IC0JCWNo
aWxkID0gZGV2X3ByaXYtPnZidC5jaGlsZF9kZXYgKyBpOwo+ICsJZm9yIChpID0gMDsgaSA8IGk5
MTUtPnZidC5jaGlsZF9kZXZfbnVtOyBpKyspIHsKPiArCQljaGlsZCA9IGk5MTUtPnZidC5jaGls
ZF9kZXYgKyBpOwo+ICAgCj4gICAJCWlmICghKGNoaWxkLT5kZXZpY2VfdHlwZSAmIERFVklDRV9U
WVBFX01JUElfT1VUUFVUKSkKPiAgIAkJCWNvbnRpbnVlOwo+IEBAIC0yMTUyLDggKzIxNTIsOCBA
QCBib29sIGludGVsX2Jpb3NfaXNfZHNpX3ByZXNlbnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICAgCQlkdm9fcG9ydCA9IGNoaWxkLT5kdm9fcG9ydDsKPiAgIAo+ICAgCQlp
ZiAoZHZvX3BvcnQgPT0gRFZPX1BPUlRfTUlQSUEgfHwKPiAtCQkgICAgKGR2b19wb3J0ID09IERW
T19QT1JUX01JUElCICYmIElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpIHx8Cj4gLQkJICAgIChk
dm9fcG9ydCA9PSBEVk9fUE9SVF9NSVBJQyAmJiBJTlRFTF9HRU4oZGV2X3ByaXYpIDwgMTEpKSB7
Cj4gKwkJICAgIChkdm9fcG9ydCA9PSBEVk9fUE9SVF9NSVBJQiAmJiBJTlRFTF9HRU4oaTkxNSkg
Pj0gMTEpIHx8Cj4gKwkJICAgIChkdm9fcG9ydCA9PSBEVk9fUE9SVF9NSVBJQyAmJiBJTlRFTF9H
RU4oaTkxNSkgPCAxMSkpIHsKPiAgIAkJCWlmIChwb3J0KQo+ICAgCQkJCSpwb3J0ID0gZHZvX3Bv
cnQgLSBEVk9fUE9SVF9NSVBJQTsKPiAgIAkJCXJldHVybiB0cnVlOwo+IEBAIC0yMjA1LDExICsy
MjA1LDExIEBAIGludGVsX2Jpb3NfaXNfbHNwY29uX3ByZXNlbnQoY29uc3Qgc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJcmV0dXJuIEhBU19MU1BDT04oaTkxNSkgJiYgY2hpbGQg
JiYgY2hpbGQtPmxzcGNvbjsKPiAgIH0KPiAgIAo+IC1lbnVtIGF1eF9jaCBpbnRlbF9iaW9zX3Bv
cnRfYXV4X2NoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArZW51bSBhdXhf
Y2ggaW50ZWxfYmlvc19wb3J0X2F1eF9jaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
PiAgIAkJCQkgICBlbnVtIHBvcnQgcG9ydCkKPiAgIHsKPiAgIAljb25zdCBzdHJ1Y3QgZGRpX3Zi
dF9wb3J0X2luZm8gKmluZm8gPQo+IC0JCSZkZXZfcHJpdi0+dmJ0LmRkaV9wb3J0X2luZm9bcG9y
dF07Cj4gKwkJJmk5MTUtPnZidC5kZGlfcG9ydF9pbmZvW3BvcnRdOwo+ICAgCWVudW0gYXV4X2No
IGF1eF9jaDsKPiAgIAo+ICAgCWlmICghaW5mby0+YWx0ZXJuYXRlX2F1eF9jaGFubmVsKSB7Cj4g
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Jpb3MuaCBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX2Jpb3MuaAo+IGluZGV4IDRlNDJjZmFmNjFhNy4uZDI5MmJkMTc5
MGFlIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Jpb3MuaAo+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Jpb3MuaAo+IEBAIC0yMjYsMTkgKzIyNiwx
OSBAQCBzdHJ1Y3QgbWlwaV9wcHNfZGF0YSB7Cj4gICAJdTE2IHBhbmVsX3Bvd2VyX2N5Y2xlX2Rl
bGF5Owo+ICAgfSBfX3BhY2tlZDsKPiAgIAo+IC12b2lkIGludGVsX2Jpb3NfaW5pdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGludGVsX2Jpb3NfY2xlYW51cChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ICt2b2lkIGludGVsX2Jpb3NfaW5p
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgaW50ZWxfYmlvc19jbGVh
bnVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAgIGJvb2wgaW50ZWxfYmlvc19p
c192YWxpZF92YnQoY29uc3Qgdm9pZCAqYnVmLCBzaXplX3Qgc2l6ZSk7Cj4gLWJvb2wgaW50ZWxf
Ymlvc19pc190dl9wcmVzZW50KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4g
LWJvb2wgaW50ZWxfYmlvc19pc19sdmRzX3ByZXNlbnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LCB1OCAqaTJjX3Bpbik7Cj4gLWJvb2wgaW50ZWxfYmlvc19pc19wb3J0X3ByZXNl
bnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBvcnQgcG9ydCk7Cj4g
LWJvb2wgaW50ZWxfYmlvc19pc19wb3J0X2VkcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsIGVudW0gcG9ydCBwb3J0KTsKPiAtYm9vbCBpbnRlbF9iaW9zX2lzX3BvcnRfZHBfZHVh
bF9tb2RlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBvcnQp
Owo+IC1ib29sIGludGVsX2Jpb3NfaXNfZHNpX3ByZXNlbnQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LCBlbnVtIHBvcnQgKnBvcnQpOwo+ICtib29sIGludGVsX2Jpb3NfaXNfdHZf
cHJlc2VudChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK2Jvb2wgaW50ZWxfYmlv
c19pc19sdmRzX3ByZXNlbnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHU4ICppMmNf
cGluKTsKPiArYm9vbCBpbnRlbF9iaW9zX2lzX3BvcnRfcHJlc2VudChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwgZW51bSBwb3J0IHBvcnQpOwo+ICtib29sIGludGVsX2Jpb3NfaXNfcG9y
dF9lZHAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gcG9ydCBwb3J0KTsKPiAr
Ym9vbCBpbnRlbF9iaW9zX2lzX3BvcnRfZHBfZHVhbF9tb2RlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LCBlbnVtIHBvcnQgcG9ydCk7Cj4gK2Jvb2wgaW50ZWxfYmlvc19pc19kc2lfcHJl
c2VudChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBwb3J0ICpwb3J0KTsKPiAg
IGJvb2wgaW50ZWxfYmlvc19pc19wb3J0X2hwZF9pbnZlcnRlZChjb25zdCBzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAgIGVudW0gcG9ydCBwb3J0KTsKPiAgIGJvb2wg
aW50ZWxfYmlvc19pc19sc3Bjb25fcHJlc2VudChjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwKPiAgIAkJCQkgIGVudW0gcG9ydCBwb3J0KTsKPiAtZW51bSBhdXhfY2ggaW50ZWxf
Ymlvc19wb3J0X2F1eF9jaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0g
cG9ydCBwb3J0KTsKPiArZW51bSBhdXhfY2ggaW50ZWxfYmlvc19wb3J0X2F1eF9jaChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBwb3J0IHBvcnQpOwo+ICAgCj4gICAjZW5kaWYg
LyogX0lOVEVMX0JJT1NfSF8gKi8KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfYncuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2J3LmMKPiBpbmRleCA3NTNh
YzMxNjUwNjEuLjFhY2E0NGEyNThkMyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9idy5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfYncuYwo+IEBA
IC0yMiwxMyArMjIsMTMgQEAgc3RydWN0IGludGVsX3Fndl9pbmZvIHsKPiAgIAllbnVtIGludGVs
X2RyYW1fdHlwZSBkcmFtX3R5cGU7Cj4gICB9Owo+ICAgCj4gLXN0YXRpYyBpbnQgaWNsX3Bjb2Rl
X3JlYWRfbWVtX2dsb2JhbF9pbmZvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiArc3RhdGljIGludCBpY2xfcGNvZGVfcmVhZF9tZW1fZ2xvYmFsX2luZm8oc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJCSAgc3RydWN0IGludGVsX3Fndl9pbmZvICpxaSkK
PiAgIHsKPiAgIAl1MzIgdmFsID0gMDsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gLQlyZXQgPSBzYW5k
eWJyaWRnZV9wY29kZV9yZWFkKGRldl9wcml2LAo+ICsJcmV0ID0gc2FuZHlicmlkZ2VfcGNvZGVf
cmVhZChpOTE1LAo+ICAgCQkJCSAgICAgSUNMX1BDT0RFX01FTV9TVUJTWVNZU1RFTV9JTkZPIHwK
PiAgIAkJCQkgICAgIElDTF9QQ09ERV9NRU1fU1NfUkVBRF9HTE9CQUxfSU5GTywKPiAgIAkJCQkg
ICAgICZ2YWwsIE5VTEwpOwo+IEBAIC02MSwxNCArNjEsMTQgQEAgc3RhdGljIGludCBpY2xfcGNv
ZGVfcmVhZF9tZW1fZ2xvYmFsX2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ICAgCXJldHVybiAwOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBpbnQgaWNsX3Bjb2RlX3JlYWRf
cWd2X3BvaW50X2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0
aWMgaW50IGljbF9wY29kZV9yZWFkX3Fndl9wb2ludF9pbmZvKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAo+ICAgCQkJCQkgc3RydWN0IGludGVsX3Fndl9wb2ludCAqc3AsCj4gICAJCQkJ
CSBpbnQgcG9pbnQpCj4gICB7Cj4gICAJdTMyIHZhbCA9IDAsIHZhbDI7Cj4gICAJaW50IHJldDsK
PiAgIAo+IC0JcmV0ID0gc2FuZHlicmlkZ2VfcGNvZGVfcmVhZChkZXZfcHJpdiwKPiArCXJldCA9
IHNhbmR5YnJpZGdlX3Bjb2RlX3JlYWQoaTkxNSwKPiAgIAkJCQkgICAgIElDTF9QQ09ERV9NRU1f
U1VCU1lTWVNURU1fSU5GTyB8Cj4gICAJCQkJICAgICBJQ0xfUENPREVfTUVNX1NTX1JFQURfUUdW
X1BPSU5UX0lORk8ocG9pbnQpLAo+ICAgCQkJCSAgICAgJnZhbCwgJnZhbDIpOwo+IEBAIC04Nywx
MiArODcsMTIgQEAgc3RhdGljIGludCBpY2xfcGNvZGVfcmVhZF9xZ3ZfcG9pbnRfaW5mbyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJcmV0dXJuIDA7Cj4gICB9Cj4gICAK
PiAtc3RhdGljIGludCBpY2xfZ2V0X3Fndl9wb2ludHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICtzdGF0aWMgaW50IGljbF9nZXRfcWd2X3BvaW50cyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgIHN0cnVjdCBpbnRlbF9xZ3ZfaW5mbyAqcWkp
Cj4gICB7Cj4gICAJaW50IGksIHJldDsKPiAgIAo+IC0JcmV0ID0gaWNsX3Bjb2RlX3JlYWRfbWVt
X2dsb2JhbF9pbmZvKGRldl9wcml2LCBxaSk7Cj4gKwlyZXQgPSBpY2xfcGNvZGVfcmVhZF9tZW1f
Z2xvYmFsX2luZm8oaTkxNSwgcWkpOwo+ICAgCWlmIChyZXQpCj4gICAJCXJldHVybiByZXQ7Cj4g
ICAKPiBAQCAtMTAyLDcgKzEwMiw3IEBAIHN0YXRpYyBpbnQgaWNsX2dldF9xZ3ZfcG9pbnRzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlmb3IgKGkgPSAwOyBpIDwgcWkt
Pm51bV9wb2ludHM7IGkrKykgewo+ICAgCQlzdHJ1Y3QgaW50ZWxfcWd2X3BvaW50ICpzcCA9ICZx
aS0+cG9pbnRzW2ldOwo+ICAgCj4gLQkJcmV0ID0gaWNsX3Bjb2RlX3JlYWRfcWd2X3BvaW50X2lu
Zm8oZGV2X3ByaXYsIHNwLCBpKTsKPiArCQlyZXQgPSBpY2xfcGNvZGVfcmVhZF9xZ3ZfcG9pbnRf
aW5mbyhpOTE1LCBzcCwgaSk7Cj4gICAJCWlmIChyZXQpCj4gICAJCQlyZXR1cm4gcmV0Owo+ICAg
Cj4gQEAgLTE0Miw3ICsxNDIsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGludGVsX3NhX2luZm8g
aWNsX3NhX2luZm8gPSB7Cj4gICAJLmRpc3BsYXlydGlkcyA9IDEyOCwKPiAgIH07Cj4gICAKPiAt
c3RhdGljIGludCBpY2xfZ2V0X2J3X2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICtzdGF0aWMgaW50IGljbF9nZXRfYndfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfcWd2X2luZm8gcWkgPSB7fTsKPiAgIAlj
b25zdCBzdHJ1Y3QgaW50ZWxfc2FfaW5mbyAqc2EgPSAmaWNsX3NhX2luZm87Cj4gQEAgLTE1NCw3
ICsxNTQsNyBAQCBzdGF0aWMgaW50IGljbF9nZXRfYndfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gICAJaW50IG1heGRlYnc7Cj4gICAJaW50IGksIHJldDsKPiAgIAo+
IC0JcmV0ID0gaWNsX2dldF9xZ3ZfcG9pbnRzKGRldl9wcml2LCAmcWkpOwo+ICsJcmV0ID0gaWNs
X2dldF9xZ3ZfcG9pbnRzKGk5MTUsICZxaSk7Cj4gICAJaWYgKHJldCkgewo+ICAgCQlEUk1fREVC
VUdfS01TKCJGYWlsZWQgdG8gZ2V0IG1lbW9yeSBzdWJzeXN0ZW0gaW5mb3JtYXRpb24sIGlnbm9y
aW5nIGJhbmR3aWR0aCBsaW1pdHMiKTsKPiAgIAkJcmV0dXJuIHJldDsKPiBAQCAtMTcwLDggKzE3
MCw4IEBAIHN0YXRpYyBpbnQgaWNsX2dldF9id19pbmZvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiAgIAkJICAgICAgaWNsX2NhbGNfYncoZGNsa19tYXgsIDE2LCAxKSAqIDYg
LyAxMCk7IC8qIDYwJSAqLwo+ICAgCWlwcWRlcHRoID0gbWluKGlwcWRlcHRocGNoLCBzYS0+ZGlz
cGxheXJ0aWRzIC8gbnVtX2NoYW5uZWxzKTsKPiAgIAo+IC0JZm9yIChpID0gMDsgaSA8IEFSUkFZ
X1NJWkUoZGV2X3ByaXYtPm1heF9idyk7IGkrKykgewo+IC0JCXN0cnVjdCBpbnRlbF9id19pbmZv
ICpiaSA9ICZkZXZfcHJpdi0+bWF4X2J3W2ldOwo+ICsJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJ
WkUoaTkxNS0+bWF4X2J3KTsgaSsrKSB7Cj4gKwkJc3RydWN0IGludGVsX2J3X2luZm8gKmJpID0g
Jmk5MTUtPm1heF9id1tpXTsKPiAgIAkJaW50IGNscGNoZ3JvdXA7Cj4gICAJCWludCBqOwo+ICAg
Cj4gQEAgLTIwNiwxOCArMjA2LDE4IEBAIHN0YXRpYyBpbnQgaWNsX2dldF9id19pbmZvKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+
IC1zdGF0aWMgdW5zaWduZWQgaW50IGljbF9tYXhfYncoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICtzdGF0aWMgdW5zaWduZWQgaW50IGljbF9tYXhfYncoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICAgICAgaW50IG51bV9wbGFuZXMsIGludCBxZ3Zf
cG9pbnQpCj4gICB7Cj4gICAJaW50IGk7Cj4gICAKPiAgIAkvKiBEaWQgd2UgaW5pdGlhbGl6ZSB0
aGUgYncgbGltaXRzIHN1Y2Nlc3NmdWxseT8gKi8KPiAtCWlmIChkZXZfcHJpdi0+bWF4X2J3WzBd
Lm51bV9wbGFuZXMgPT0gMCkKPiArCWlmIChpOTE1LT5tYXhfYndbMF0ubnVtX3BsYW5lcyA9PSAw
KQo+ICAgCQlyZXR1cm4gVUlOVF9NQVg7Cj4gICAKPiAtCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9T
SVpFKGRldl9wcml2LT5tYXhfYncpOyBpKyspIHsKPiArCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9T
SVpFKGk5MTUtPm1heF9idyk7IGkrKykgewo+ICAgCQljb25zdCBzdHJ1Y3QgaW50ZWxfYndfaW5m
byAqYmkgPQo+IC0JCQkmZGV2X3ByaXYtPm1heF9id1tpXTsKPiArCQkJJmk5MTUtPm1heF9id1tp
XTsKPiAgIAo+ICAgCQlpZiAobnVtX3BsYW5lcyA+PSBiaS0+bnVtX3BsYW5lcykKPiAgIAkJCXJl
dHVybiBiaS0+ZGVyYXRlZGJ3W3Fndl9wb2ludF07Cj4gQEAgLTIyNiwyNCArMjI2LDI0IEBAIHN0
YXRpYyB1bnNpZ25lZCBpbnQgaWNsX21heF9idyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gICAJcmV0dXJuIDA7Cj4gICB9Cj4gICAKPiAtdm9pZCBpbnRlbF9id19pbml0X2h3
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBpbnRlbF9id19pbml0
X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JaWYgKElTX0dFTihk
ZXZfcHJpdiwgMTEpKQo+IC0JCWljbF9nZXRfYndfaW5mbyhkZXZfcHJpdik7Cj4gKwlpZiAoSVNf
R0VOKGk5MTUsIDExKSkKPiArCQlpY2xfZ2V0X2J3X2luZm8oaTkxNSk7Cj4gICB9Cj4gICAKPiAt
c3RhdGljIHVuc2lnbmVkIGludCBpbnRlbF9tYXhfZGF0YV9yYXRlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHVuc2lnbmVkIGludCBpbnRlbF9tYXhfZGF0YV9y
YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCQlpbnQgbnVtX3BsYW5l
cykKPiAgIHsKPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDExKSkKPiArCWlmIChJU19HRU4oaTkx
NSwgMTEpKQo+ICAgCQkvKgo+ICAgCQkgKiBGSVhNRSB3aXRoIFNBR1YgZGlzYWJsZWQgbWF5YmUg
d2UgY2FuIGFzc3VtZQo+ICAgCQkgKiBwb2ludCAxIHdpbGwgYWx3YXlzIGJlIHVzZWQ/IFNlZW1z
IHRvIG1hdGNoCj4gICAJCSAqIHRoZSBiZWhhdmlvdXIgb2JzZXJ2ZWQgaW4gdGhlIHdpbGQuCj4g
ICAJCSAqLwo+IC0JCXJldHVybiBtaW4zKGljbF9tYXhfYncoZGV2X3ByaXYsIG51bV9wbGFuZXMs
IDApLAo+IC0JCQkgICAgaWNsX21heF9idyhkZXZfcHJpdiwgbnVtX3BsYW5lcywgMSksCj4gLQkJ
CSAgICBpY2xfbWF4X2J3KGRldl9wcml2LCBudW1fcGxhbmVzLCAyKSk7Cj4gKwkJcmV0dXJuIG1p
bjMoaWNsX21heF9idyhpOTE1LCBudW1fcGxhbmVzLCAwKSwKPiArCQkJICAgIGljbF9tYXhfYnco
aTkxNSwgbnVtX3BsYW5lcywgMSksCj4gKwkJCSAgICBpY2xfbWF4X2J3KGk5MTUsIG51bV9wbGFu
ZXMsIDIpKTsKPiAgIAllbHNlCj4gICAJCXJldHVybiBVSU5UX01BWDsKPiAgIH0KPiBAQCAtMjkz
LDI1ICsyOTMsMjUgQEAgdm9pZCBpbnRlbF9id19jcnRjX3VwZGF0ZShzdHJ1Y3QgaW50ZWxfYndf
c3RhdGUgKmJ3X3N0YXRlLAo+ICAgCQkgICAgICBid19zdGF0ZS0+bnVtX2FjdGl2ZV9wbGFuZXNb
Y3J0Yy0+cGlwZV0pOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB1bnNpZ25lZCBpbnQgaW50ZWxfYndf
bnVtX2FjdGl2ZV9wbGFuZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtz
dGF0aWMgdW5zaWduZWQgaW50IGludGVsX2J3X251bV9hY3RpdmVfcGxhbmVzKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCQkgICAgICAgY29uc3Qgc3RydWN0IGludGVsX2J3
X3N0YXRlICpid19zdGF0ZSkKPiAgIHsKPiAgIAl1bnNpZ25lZCBpbnQgbnVtX2FjdGl2ZV9wbGFu
ZXMgPSAwOwo+ICAgCWVudW0gcGlwZSBwaXBlOwo+ICAgCj4gLQlmb3JfZWFjaF9waXBlKGRldl9w
cml2LCBwaXBlKQo+ICsJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKQo+ICAgCQludW1fYWN0aXZl
X3BsYW5lcyArPSBid19zdGF0ZS0+bnVtX2FjdGl2ZV9wbGFuZXNbcGlwZV07Cj4gICAKPiAgIAly
ZXR1cm4gbnVtX2FjdGl2ZV9wbGFuZXM7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHVuc2lnbmVkIGlu
dCBpbnRlbF9id19kYXRhX3JhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICtzdGF0aWMgdW5zaWduZWQgaW50IGludGVsX2J3X2RhdGFfcmF0ZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAgICAgY29uc3Qgc3RydWN0IGludGVsX2J3X3N0YXRl
ICpid19zdGF0ZSkKPiAgIHsKPiAgIAl1bnNpZ25lZCBpbnQgZGF0YV9yYXRlID0gMDsKPiAgIAll
bnVtIHBpcGUgcGlwZTsKPiAgIAo+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkKPiAr
CWZvcl9lYWNoX3BpcGUoaTkxNSwgcGlwZSkKPiAgIAkJZGF0YV9yYXRlICs9IGJ3X3N0YXRlLT5k
YXRhX3JhdGVbcGlwZV07Cj4gICAKPiAgIAlyZXR1cm4gZGF0YV9yYXRlOwo+IEBAIC0zMTksNyAr
MzE5LDcgQEAgc3RhdGljIHVuc2lnbmVkIGludCBpbnRlbF9id19kYXRhX3JhdGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCj4gICBpbnQgaW50ZWxfYndfYXRvbWljX2No
ZWNrKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShzdGF0ZS0+YmFzZS5kZXYpOwo+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KHN0YXRlLT5iYXNlLmRldik7
Cj4gICAJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlLCAqb2xkX2NydGNf
c3RhdGU7Cj4gICAJc3RydWN0IGludGVsX2J3X3N0YXRlICpid19zdGF0ZSA9IE5VTEw7Cj4gICAJ
dW5zaWduZWQgaW50IGRhdGFfcmF0ZSwgbWF4X2RhdGFfcmF0ZTsKPiBAQCAtMzI4LDcgKzMyOCw3
IEBAIGludCBpbnRlbF9id19hdG9taWNfY2hlY2soc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAq
c3RhdGUpCj4gICAJaW50IGk7Cj4gICAKPiAgIAkvKiBGSVhNRSBlYXJsaWVyIGdlbnMgbmVlZCBz
b21lIGNoZWNrcyB0b28gKi8KPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgMTEpCj4gKwlp
ZiAoSU5URUxfR0VOKGk5MTUpIDwgMTEpCj4gICAJCXJldHVybiAwOwo+ICAgCj4gICAJZm9yX2Vh
Y2hfb2xkbmV3X2ludGVsX2NydGNfaW5fc3RhdGUoc3RhdGUsIGNydGMsIG9sZF9jcnRjX3N0YXRl
LAo+IEBAIC0zNjYsMTAgKzM2NiwxMCBAQCBpbnQgaW50ZWxfYndfYXRvbWljX2NoZWNrKHN0cnVj
dCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAgCWlmICghYndfc3RhdGUpCj4gICAJCXJl
dHVybiAwOwo+ICAgCj4gLQlkYXRhX3JhdGUgPSBpbnRlbF9id19kYXRhX3JhdGUoZGV2X3ByaXYs
IGJ3X3N0YXRlKTsKPiAtCW51bV9hY3RpdmVfcGxhbmVzID0gaW50ZWxfYndfbnVtX2FjdGl2ZV9w
bGFuZXMoZGV2X3ByaXYsIGJ3X3N0YXRlKTsKPiArCWRhdGFfcmF0ZSA9IGludGVsX2J3X2RhdGFf
cmF0ZShpOTE1LCBid19zdGF0ZSk7Cj4gKwludW1fYWN0aXZlX3BsYW5lcyA9IGludGVsX2J3X251
bV9hY3RpdmVfcGxhbmVzKGk5MTUsIGJ3X3N0YXRlKTsKPiAgIAo+IC0JbWF4X2RhdGFfcmF0ZSA9
IGludGVsX21heF9kYXRhX3JhdGUoZGV2X3ByaXYsIG51bV9hY3RpdmVfcGxhbmVzKTsKPiArCW1h
eF9kYXRhX3JhdGUgPSBpbnRlbF9tYXhfZGF0YV9yYXRlKGk5MTUsIG51bV9hY3RpdmVfcGxhbmVz
KTsKPiAgIAo+ICAgCWRhdGFfcmF0ZSA9IERJVl9ST1VORF9VUChkYXRhX3JhdGUsIDEwMDApOwo+
ICAgCj4gQEAgLTQwNiw3ICs0MDYsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9wcml2YXRl
X3N0YXRlX2Z1bmNzIGludGVsX2J3X2Z1bmNzID0gewo+ICAgCS5hdG9taWNfZGVzdHJveV9zdGF0
ZSA9IGludGVsX2J3X2Rlc3Ryb3lfc3RhdGUsCj4gICB9Owo+ICAgCj4gLWludCBpbnRlbF9id19p
bml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAraW50IGludGVsX2J3X2lu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RydWN0IGludGVs
X2J3X3N0YXRlICpzdGF0ZTsKPiAgIAo+IEBAIC00MTQsNyArNDE0LDcgQEAgaW50IGludGVsX2J3
X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCWlmICghc3RhdGUp
Cj4gICAJCXJldHVybiAtRU5PTUVNOwo+ICAgCj4gLQlkcm1fYXRvbWljX3ByaXZhdGVfb2JqX2lu
aXQoJmRldl9wcml2LT5kcm0sICZkZXZfcHJpdi0+Yndfb2JqLAo+ICsJZHJtX2F0b21pY19wcml2
YXRlX29ial9pbml0KCZpOTE1LT5kcm0sICZpOTE1LT5id19vYmosCj4gICAJCQkJICAgICZzdGF0
ZS0+YmFzZSwgJmludGVsX2J3X2Z1bmNzKTsKPiAgIAo+ICAgCXJldHVybiAwOwo+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9idy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfYncuaAo+IGluZGV4IGU5ZDljNmQ2M2JjMy4uMzk2ZTUwMjlmOWE0IDEwMDY0NAo+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2J3LmgKPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF9idy5oCj4gQEAgLTI3LDE5ICsyNywxOSBAQCBzdHJ1Y3QgaW50ZWxf
Yndfc3RhdGUgewo+ICAgc3RhdGljIGlubGluZSBzdHJ1Y3QgaW50ZWxfYndfc3RhdGUgKgo+ICAg
aW50ZWxfYXRvbWljX2dldF9id19zdGF0ZShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0
ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
c3RhdGUtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShzdGF0ZS0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBkcm1fcHJpdmF0ZV9zdGF0ZSAqYndf
c3RhdGU7Cj4gICAKPiAgIAlid19zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X3ByaXZhdGVfb2JqX3N0
YXRlKCZzdGF0ZS0+YmFzZSwKPiAtCQkJCQkJICAgICZkZXZfcHJpdi0+Yndfb2JqKTsKPiArCQkJ
CQkJICAgICZpOTE1LT5id19vYmopOwo+ICAgCWlmIChJU19FUlIoYndfc3RhdGUpKQo+ICAgCQly
ZXR1cm4gRVJSX0NBU1QoYndfc3RhdGUpOwo+ICAgCj4gICAJcmV0dXJuIHRvX2ludGVsX2J3X3N0
YXRlKGJ3X3N0YXRlKTsKPiAgIH0KPiAgIAo+IC12b2lkIGludGVsX2J3X2luaXRfaHcoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtaW50IGludGVsX2J3X2luaXQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiArdm9pZCBpbnRlbF9id19pbml0X2h3KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAraW50IGludGVsX2J3X2luaXQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgaW50IGludGVsX2J3X2F0b21pY19jaGVjayhz
dHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSk7Cj4gICB2b2lkIGludGVsX2J3X2NydGNf
dXBkYXRlKHN0cnVjdCBpbnRlbF9id19zdGF0ZSAqYndfc3RhdGUsCj4gICAJCQkgIGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfY2RjbGsuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X2NkY2xrLmMKPiBpbmRleCA4OTkzYWIyODM1NjIuLjAyYzYxNzE4MGM0YiAxMDA2NDQKPiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jZGNsay5jCj4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfY2RjbGsuYwo+IEBAIC01Myw0NiArNTMsNDYgQEAKPiAgICAqIGRpdmlk
ZXJzIGNhbiBiZSBwcm9ncmFtbWVkIGNvcnJlY3RseS4KPiAgICAqLwo+ICAgCj4gLXN0YXRpYyB2
b2lkIGZpeGVkXzEzM21oel9nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ICtzdGF0aWMgdm9pZCBmaXhlZF8xMzNtaHpfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgIHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqY2Rj
bGtfc3RhdGUpCj4gICB7Cj4gICAJY2RjbGtfc3RhdGUtPmNkY2xrID0gMTMzMzMzOwo+ICAgfQo+
ICAgCj4gLXN0YXRpYyB2b2lkIGZpeGVkXzIwMG1oel9nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBmaXhlZF8yMDBtaHpfZ2V0X2NkY2xr
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgIHN0cnVjdCBpbnRlbF9j
ZGNsa19zdGF0ZSAqY2RjbGtfc3RhdGUpCj4gICB7Cj4gICAJY2RjbGtfc3RhdGUtPmNkY2xrID0g
MjAwMDAwOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGZpeGVkXzI2Nm1oel9nZXRfY2RjbGso
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBmaXhlZF8y
NjZtaHpfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAg
IHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqY2RjbGtfc3RhdGUpCj4gICB7Cj4gICAJY2RjbGtf
c3RhdGUtPmNkY2xrID0gMjY2NjY3Owo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGZpeGVkXzMz
M21oel9nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0
aWMgdm9pZCBmaXhlZF8zMzNtaHpfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ICAgCQkJCSAgIHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqY2RjbGtfc3RhdGUpCj4g
ICB7Cj4gICAJY2RjbGtfc3RhdGUtPmNkY2xrID0gMzMzMzMzOwo+ICAgfQo+ICAgCj4gLXN0YXRp
YyB2b2lkIGZpeGVkXzQwMG1oel9nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ICtzdGF0aWMgdm9pZCBmaXhlZF80MDBtaHpfZ2V0X2NkY2xrKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgIHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAq
Y2RjbGtfc3RhdGUpCj4gICB7Cj4gICAJY2RjbGtfc3RhdGUtPmNkY2xrID0gNDAwMDAwOwo+ICAg
fQo+ICAgCj4gLXN0YXRpYyB2b2lkIGZpeGVkXzQ1MG1oel9nZXRfY2RjbGsoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBmaXhlZF80NTBtaHpfZ2V0X2Nk
Y2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgIHN0cnVjdCBpbnRl
bF9jZGNsa19zdGF0ZSAqY2RjbGtfc3RhdGUpCj4gICB7Cj4gICAJY2RjbGtfc3RhdGUtPmNkY2xr
ID0gNDUwMDAwOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGk4NXhfZ2V0X2NkY2xrKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgaTg1eF9nZXRfY2Rj
bGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICBzdHJ1Y3QgaW50ZWxf
Y2RjbGtfc3RhdGUgKmNkY2xrX3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IHBjaV9kZXYgKnBkZXYg
PSBkZXZfcHJpdi0+ZHJtLnBkZXY7Cj4gKwlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGk5MTUtPmRy
bS5wZGV2Owo+ICAgCXUxNiBocGxsY2MgPSAwOwo+ICAgCj4gICAJLyoKPiBAQCAtMTMxLDEwICsx
MzEsMTAgQEAgc3RhdGljIHZvaWQgaTg1eF9nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ICAgCX0KPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpOTE1Z21fZ2V0
X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQg
aTkxNWdtX2dldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAg
ICAgc3RydWN0IGludGVsX2NkY2xrX3N0YXRlICpjZGNsa19zdGF0ZSkKPiAgIHsKPiAtCXN0cnVj
dCBwY2lfZGV2ICpwZGV2ID0gZGV2X3ByaXYtPmRybS5wZGV2Owo+ICsJc3RydWN0IHBjaV9kZXYg
KnBkZXYgPSBpOTE1LT5kcm0ucGRldjsKPiAgIAl1MTYgZ2NmZ2MgPSAwOwo+ICAgCj4gICAJcGNp
X3JlYWRfY29uZmlnX3dvcmQocGRldiwgR0NGR0MsICZnY2ZnYyk7Cj4gQEAgLTE1NSwxMCArMTU1
LDEwIEBAIHN0YXRpYyB2b2lkIGk5MTVnbV9nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ICAgCX0KPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpOTQ1Z21fZ2V0
X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQg
aTk0NWdtX2dldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAg
ICAgc3RydWN0IGludGVsX2NkY2xrX3N0YXRlICpjZGNsa19zdGF0ZSkKPiAgIHsKPiAtCXN0cnVj
dCBwY2lfZGV2ICpwZGV2ID0gZGV2X3ByaXYtPmRybS5wZGV2Owo+ICsJc3RydWN0IHBjaV9kZXYg
KnBkZXYgPSBpOTE1LT5kcm0ucGRldjsKPiAgIAl1MTYgZ2NmZ2MgPSAwOwo+ICAgCj4gICAJcGNp
X3JlYWRfY29uZmlnX3dvcmQocGRldiwgR0NGR0MsICZnY2ZnYyk7Cj4gQEAgLTE3OSw3ICsxNzks
NyBAQCBzdGF0aWMgdm9pZCBpOTQ1Z21fZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiAgIAl9Cj4gICB9Cj4gICAKPiAtc3RhdGljIHVuc2lnbmVkIGludCBpbnRl
bF9ocGxsX3ZjbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB1
bnNpZ25lZCBpbnQgaW50ZWxfaHBsbF92Y28oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gICB7Cj4gICAJc3RhdGljIGNvbnN0IHVuc2lnbmVkIGludCBibGJfdmNvWzhdID0gewo+ICAg
CQlbMF0gPSAzMjAwMDAwLAo+IEBAIC0yMjMsMjAgKzIyMywyMCBAQCBzdGF0aWMgdW5zaWduZWQg
aW50IGludGVsX2hwbGxfdmNvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAg
IAl1OCB0bXAgPSAwOwo+ICAgCj4gICAJLyogRklYTUUgb3RoZXIgY2hpcHNldHM/ICovCj4gLQlp
ZiAoSVNfR000NShkZXZfcHJpdikpCj4gKwlpZiAoSVNfR000NShpOTE1KSkKPiAgIAkJdmNvX3Rh
YmxlID0gY3RnX3ZjbzsKPiAtCWVsc2UgaWYgKElTX0c0NShkZXZfcHJpdikpCj4gKwllbHNlIGlm
IChJU19HNDUoaTkxNSkpCj4gICAJCXZjb190YWJsZSA9IGVsa192Y287Cj4gLQllbHNlIGlmIChJ
U19JOTY1R00oZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAoSVNfSTk2NUdNKGk5MTUpKQo+ICAgCQl2
Y29fdGFibGUgPSBjbF92Y287Cj4gLQllbHNlIGlmIChJU19QSU5FVklFVyhkZXZfcHJpdikpCj4g
KwllbHNlIGlmIChJU19QSU5FVklFVyhpOTE1KSkKPiAgIAkJdmNvX3RhYmxlID0gcG52X3ZjbzsK
PiAtCWVsc2UgaWYgKElTX0czMyhkZXZfcHJpdikpCj4gKwllbHNlIGlmIChJU19HMzMoaTkxNSkp
Cj4gICAJCXZjb190YWJsZSA9IGJsYl92Y287Cj4gICAJZWxzZQo+ICAgCQlyZXR1cm4gMDsKPiAg
IAo+IC0JdG1wID0gSTkxNV9SRUFEKElTX1BJTkVWSUVXKGRldl9wcml2KSB8fCBJU19NT0JJTEUo
ZGV2X3ByaXYpID8KPiArCXRtcCA9IEk5MTVfUkVBRChJU19QSU5FVklFVyhpOTE1KSB8fCBJU19N
T0JJTEUoaTkxNSkgPwo+ICAgCQkJSFBMTFZDT19NT0JJTEUgOiBIUExMVkNPKTsKPiAgIAo+ICAg
CXZjbyA9IHZjb190YWJsZVt0bXAgJiAweDddOwo+IEBAIC0yNDgsMTAgKzI0OCwxMCBAQCBzdGF0
aWMgdW5zaWduZWQgaW50IGludGVsX2hwbGxfdmNvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiAgIAlyZXR1cm4gdmNvOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGczM19n
ZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9p
ZCBnMzNfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICBz
dHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgKmNkY2xrX3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IHBj
aV9kZXYgKnBkZXYgPSBkZXZfcHJpdi0+ZHJtLnBkZXY7Cj4gKwlzdHJ1Y3QgcGNpX2RldiAqcGRl
diA9IGk5MTUtPmRybS5wZGV2Owo+ICAgCXN0YXRpYyBjb25zdCB1OCBkaXZfMzIwMFtdID0geyAx
MiwgMTAsICA4LCAgNywgNSwgMTYgfTsKPiAgIAlzdGF0aWMgY29uc3QgdTggZGl2XzQwMDBbXSA9
IHsgMTQsIDEyLCAxMCwgIDgsIDYsIDIwIH07Cj4gICAJc3RhdGljIGNvbnN0IHU4IGRpdl80ODAw
W10gPSB7IDIwLCAxNCwgMTIsIDEwLCA4LCAyNCB9Owo+IEBAIC0yNjAsNyArMjYwLDcgQEAgc3Rh
dGljIHZvaWQgZzMzX2dldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gICAJdW5zaWduZWQgaW50IGNkY2xrX3NlbDsKPiAgIAl1MTYgdG1wID0gMDsKPiAgIAo+IC0J
Y2RjbGtfc3RhdGUtPnZjbyA9IGludGVsX2hwbGxfdmNvKGRldl9wcml2KTsKPiArCWNkY2xrX3N0
YXRlLT52Y28gPSBpbnRlbF9ocGxsX3ZjbyhpOTE1KTsKPiAgIAo+ICAgCXBjaV9yZWFkX2NvbmZp
Z193b3JkKHBkZXYsIEdDRkdDLCAmdG1wKTsKPiAgIAo+IEBAIC0yOTYsMTAgKzI5NiwxMCBAQCBz
dGF0aWMgdm9pZCBnMzNfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiAgIAljZGNsa19zdGF0ZS0+Y2RjbGsgPSAxOTA0NzY7Cj4gICB9Cj4gICAKPiAtc3RhdGlj
IHZvaWQgcG52X2dldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
K3N0YXRpYyB2b2lkIHBudl9nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gICAJCQkgIHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqY2RjbGtfc3RhdGUpCj4gICB7Cj4g
LQlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGRldl9wcml2LT5kcm0ucGRldjsKPiArCXN0cnVjdCBw
Y2lfZGV2ICpwZGV2ID0gaTkxNS0+ZHJtLnBkZXY7Cj4gICAJdTE2IGdjZmdjID0gMDsKPiAgIAo+
ICAgCXBjaV9yZWFkX2NvbmZpZ193b3JkKHBkZXYsIEdDRkdDLCAmZ2NmZ2MpOwo+IEBAIC0zMjks
MTAgKzMyOSwxMCBAQCBzdGF0aWMgdm9pZCBwbnZfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiAgIAl9Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaTk2NWdt
X2dldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2
b2lkIGk5NjVnbV9nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJ
CQkgICAgIHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqY2RjbGtfc3RhdGUpCj4gICB7Cj4gLQlz
dHJ1Y3QgcGNpX2RldiAqcGRldiA9IGRldl9wcml2LT5kcm0ucGRldjsKPiArCXN0cnVjdCBwY2lf
ZGV2ICpwZGV2ID0gaTkxNS0+ZHJtLnBkZXY7Cj4gICAJc3RhdGljIGNvbnN0IHU4IGRpdl8zMjAw
W10gPSB7IDE2LCAxMCwgIDggfTsKPiAgIAlzdGF0aWMgY29uc3QgdTggZGl2XzQwMDBbXSA9IHsg
MjAsIDEyLCAxMCB9Owo+ICAgCXN0YXRpYyBjb25zdCB1OCBkaXZfNTMzM1tdID0geyAyNCwgMTYs
IDE0IH07Cj4gQEAgLTM0MCw3ICszNDAsNyBAQCBzdGF0aWMgdm9pZCBpOTY1Z21fZ2V0X2NkY2xr
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAl1bnNpZ25lZCBpbnQgY2Rj
bGtfc2VsOwo+ICAgCXUxNiB0bXAgPSAwOwo+ICAgCj4gLQljZGNsa19zdGF0ZS0+dmNvID0gaW50
ZWxfaHBsbF92Y28oZGV2X3ByaXYpOwo+ICsJY2RjbGtfc3RhdGUtPnZjbyA9IGludGVsX2hwbGxf
dmNvKGk5MTUpOwo+ICAgCj4gICAJcGNpX3JlYWRfY29uZmlnX3dvcmQocGRldiwgR0NGR0MsICZ0
bXApOwo+ICAgCj4gQEAgLTM3MywxNCArMzczLDE0IEBAIHN0YXRpYyB2b2lkIGk5NjVnbV9nZXRf
Y2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCWNkY2xrX3N0YXRl
LT5jZGNsayA9IDIwMDAwMDsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBnbTQ1X2dldF9jZGNs
ayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGdtNDVf
Z2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgc3RydWN0
IGludGVsX2NkY2xrX3N0YXRlICpjZGNsa19zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBwY2lfZGV2
ICpwZGV2ID0gZGV2X3ByaXYtPmRybS5wZGV2Owo+ICsJc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBp
OTE1LT5kcm0ucGRldjsKPiAgIAl1bnNpZ25lZCBpbnQgY2RjbGtfc2VsOwo+ICAgCXUxNiB0bXAg
PSAwOwo+ICAgCj4gLQljZGNsa19zdGF0ZS0+dmNvID0gaW50ZWxfaHBsbF92Y28oZGV2X3ByaXYp
Owo+ICsJY2RjbGtfc3RhdGUtPnZjbyA9IGludGVsX2hwbGxfdmNvKGk5MTUpOwo+ICAgCj4gICAJ
cGNpX3JlYWRfY29uZmlnX3dvcmQocGRldiwgR0NGR0MsICZ0bXApOwo+ICAgCj4gQEAgLTQwMyw3
ICs0MDMsNyBAQCBzdGF0aWMgdm9pZCBnbTQ1X2dldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gICAJfQo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGhzd19nZXRf
Y2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBo
c3dfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICBzdHJ1
Y3QgaW50ZWxfY2RjbGtfc3RhdGUgKmNkY2xrX3N0YXRlKQo+ICAgewo+ICAgCXUzMiBsY3BsbCA9
IEk5MTVfUkVBRChMQ1BMTF9DVEwpOwo+IEBAIC00MTUsMTUgKzQxNSwxNSBAQCBzdGF0aWMgdm9p
ZCBoc3dfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkJ
Y2RjbGtfc3RhdGUtPmNkY2xrID0gNDUwMDAwOwo+ICAgCWVsc2UgaWYgKGZyZXEgPT0gTENQTExf
Q0xLX0ZSRVFfNDUwKQo+ICAgCQljZGNsa19zdGF0ZS0+Y2RjbGsgPSA0NTAwMDA7Cj4gLQllbHNl
IGlmIChJU19IU1dfVUxUKGRldl9wcml2KSkKPiArCWVsc2UgaWYgKElTX0hTV19VTFQoaTkxNSkp
Cj4gICAJCWNkY2xrX3N0YXRlLT5jZGNsayA9IDMzNzUwMDsKPiAgIAllbHNlCj4gICAJCWNkY2xr
X3N0YXRlLT5jZGNsayA9IDU0MDAwMDsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgaW50IHZsdl9jYWxj
X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50IG1pbl9jZGNsaykK
PiArc3RhdGljIGludCB2bHZfY2FsY19jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwgaW50IG1pbl9jZGNsaykKPiAgIHsKPiAtCWludCBmcmVxXzMyMCA9IChkZXZfcHJpdi0+aHBs
bF9mcmVxIDw8ICAxKSAlIDMyMDAwMCAhPSAwID8KPiArCWludCBmcmVxXzMyMCA9IChpOTE1LT5o
cGxsX2ZyZXEgPDwgIDEpICUgMzIwMDAwICE9IDAgPwo+ICAgCQkzMzMzMzMgOiAzMjAwMDA7Cj4g
ICAKPiAgIAkvKgo+IEBAIC00MzEsNyArNDMxLDcgQEAgc3RhdGljIGludCB2bHZfY2FsY19jZGNs
ayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCBtaW5fY2RjbGspCj4gICAJ
ICogTm90IHN1cmUgd2hhdCdzIHdyb25nLiBGb3Igbm93IHVzZSAyMDBNSHogb25seSB3aGVuIGFs
bCBwaXBlcwo+ICAgCSAqIGFyZSBvZmYuCj4gICAJICovCj4gLQlpZiAoSVNfVkFMTEVZVklFVyhk
ZXZfcHJpdikgJiYgbWluX2NkY2xrID4gZnJlcV8zMjApCj4gKwlpZiAoSVNfVkFMTEVZVklFVyhp
OTE1KSAmJiBtaW5fY2RjbGsgPiBmcmVxXzMyMCkKPiAgIAkJcmV0dXJuIDQwMDAwMDsKPiAgIAll
bHNlIGlmIChtaW5fY2RjbGsgPiAyNjY2NjcpCj4gICAJCXJldHVybiBmcmVxXzMyMDsKPiBAQCAt
NDQxLDkgKzQ0MSw5IEBAIHN0YXRpYyBpbnQgdmx2X2NhbGNfY2RjbGsoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgbWluX2NkY2xrKQo+ICAgCQlyZXR1cm4gMjAwMDAwOwo+
ICAgfQo+ICAgCj4gLXN0YXRpYyB1OCB2bHZfY2FsY192b2x0YWdlX2xldmVsKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50IGNkY2xrKQo+ICtzdGF0aWMgdTggdmx2X2NhbGNf
dm9sdGFnZV9sZXZlbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50IGNkY2xrKQo+
ICAgewo+IC0JaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfVkFMTEVZ
VklFVyhpOTE1KSkgewo+ICAgCQlpZiAoY2RjbGsgPj0gMzIwMDAwKSAvKiBqdW1wIHRvIGhpZ2hl
c3Qgdm9sdGFnZSBmb3IgNDAwTUh6IHRvbyAqLwo+ICAgCQkJcmV0dXJuIDI7Cj4gICAJCWVsc2Ug
aWYgKGNkY2xrID49IDI2NjY2NykKPiBAQCAtNDU2LDI5ICs0NTYsMjkgQEAgc3RhdGljIHU4IHZs
dl9jYWxjX3ZvbHRhZ2VfbGV2ZWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBp
bnQgY2RjbGspCj4gICAJCSAqIGhhcmR3YXJlIGhhcyBzaG93biB0aGF0IHdlIGp1c3QgbmVlZCB0
byB3cml0ZSB0aGUgZGVzaXJlZAo+ICAgCQkgKiBDQ0sgZGl2aWRlciBpbnRvIHRoZSBQdW5pdCBy
ZWdpc3Rlci4KPiAgIAkJICovCj4gLQkJcmV0dXJuIERJVl9ST1VORF9DTE9TRVNUKGRldl9wcml2
LT5ocGxsX2ZyZXEgPDwgMSwgY2RjbGspIC0gMTsKPiArCQlyZXR1cm4gRElWX1JPVU5EX0NMT1NF
U1QoaTkxNS0+aHBsbF9mcmVxIDw8IDEsIGNkY2xrKSAtIDE7Cj4gICAJfQo+ICAgfQo+ICAgCj4g
LXN0YXRpYyB2b2lkIHZsdl9nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ICtzdGF0aWMgdm9pZCB2bHZfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAo+ICAgCQkJICBzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgKmNkY2xrX3N0YXRlKQo+
ICAgewo+ICAgCXUzMiB2YWw7Cj4gICAKPiAtCXZsdl9pb3NmX3NiX2dldChkZXZfcHJpdiwKPiAr
CXZsdl9pb3NmX3NiX2dldChpOTE1LAo+ICAgCQkJQklUKFZMVl9JT1NGX1NCX0NDSykgfCBCSVQo
VkxWX0lPU0ZfU0JfUFVOSVQpKTsKPiAgIAo+IC0JY2RjbGtfc3RhdGUtPnZjbyA9IHZsdl9nZXRf
aHBsbF92Y28oZGV2X3ByaXYpOwo+IC0JY2RjbGtfc3RhdGUtPmNkY2xrID0gdmx2X2dldF9jY2tf
Y2xvY2soZGV2X3ByaXYsICJjZGNsayIsCj4gKwljZGNsa19zdGF0ZS0+dmNvID0gdmx2X2dldF9o
cGxsX3ZjbyhpOTE1KTsKPiArCWNkY2xrX3N0YXRlLT5jZGNsayA9IHZsdl9nZXRfY2NrX2Nsb2Nr
KGk5MTUsICJjZGNsayIsCj4gICAJCQkJCSAgICAgICBDQ0tfRElTUExBWV9DTE9DS19DT05UUk9M
LAo+ICAgCQkJCQkgICAgICAgY2RjbGtfc3RhdGUtPnZjbyk7Cj4gICAKPiAtCXZhbCA9IHZsdl9w
dW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfRFNQU1NQTSk7Cj4gKwl2YWwgPSB2bHZfcHVu
aXRfcmVhZChpOTE1LCBQVU5JVF9SRUdfRFNQU1NQTSk7Cj4gICAKPiAtCXZsdl9pb3NmX3NiX3B1
dChkZXZfcHJpdiwKPiArCXZsdl9pb3NmX3NiX3B1dChpOTE1LAo+ICAgCQkJQklUKFZMVl9JT1NG
X1NCX0NDSykgfCBCSVQoVkxWX0lPU0ZfU0JfUFVOSVQpKTsKPiAgIAo+IC0JaWYgKElTX1ZBTExF
WVZJRVcoZGV2X3ByaXYpKQo+ICsJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkpCj4gICAJCWNkY2xr
X3N0YXRlLT52b2x0YWdlX2xldmVsID0gKHZhbCAmIERTUEZSRVFHVUFSX01BU0spID4+Cj4gICAJ
CQlEU1BGUkVRR1VBUl9TSElGVDsKPiAgIAllbHNlCj4gQEAgLTQ4NiwxOCArNDg2LDE4IEBAIHN0
YXRpYyB2b2lkIHZsdl9nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ICAgCQkJRFNQRlJFUUdVQVJfU0hJRlRfQ0hWOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lk
IHZsdl9wcm9ncmFtX3BmaV9jcmVkaXRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiArc3RhdGljIHZvaWQgdmx2X3Byb2dyYW1fcGZpX2NyZWRpdHMoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJdW5zaWduZWQgaW50IGNyZWRpdHMsIGRlZmF1bHRf
Y3JlZGl0czsKPiAgIAo+IC0JaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ICsJaWYgKElT
X0NIRVJSWVZJRVcoaTkxNSkpCj4gICAJCWRlZmF1bHRfY3JlZGl0cyA9IFBGSV9DUkVESVQoMTIp
Owo+ICAgCWVsc2UKPiAgIAkJZGVmYXVsdF9jcmVkaXRzID0gUEZJX0NSRURJVCg4KTsKPiAgIAo+
IC0JaWYgKGRldl9wcml2LT5jZGNsay5ody5jZGNsayA+PSBkZXZfcHJpdi0+Y3pjbGtfZnJlcSkg
ewo+ICsJaWYgKGk5MTUtPmNkY2xrLmh3LmNkY2xrID49IGk5MTUtPmN6Y2xrX2ZyZXEpIHsKPiAg
IAkJLyogQ0hWIHN1Z2dlc3RlZCB2YWx1ZSBpcyAzMSBvciA2MyAqLwo+IC0JCWlmIChJU19DSEVS
UllWSUVXKGRldl9wcml2KSkKPiArCQlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiAgIAkJCWNy
ZWRpdHMgPSBQRklfQ1JFRElUXzYzOwo+ICAgCQllbHNlCj4gICAJCQljcmVkaXRzID0gUEZJX0NS
RURJVCgxNSk7Cj4gQEAgLTUyMiw3ICs1MjIsNyBAQCBzdGF0aWMgdm9pZCB2bHZfcHJvZ3JhbV9w
ZmlfY3JlZGl0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJV0FSTl9P
TihJOTE1X1JFQUQoR0NJX0NPTlRST0wpICYgUEZJX0NSRURJVF9SRVNFTkQpOwo+ICAgfQo+ICAg
Cj4gLXN0YXRpYyB2b2lkIHZsdl9zZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ICtzdGF0aWMgdm9pZCB2bHZfc2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAo+ICAgCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgKmNkY2xr
X3N0YXRlLAo+ICAgCQkJICBlbnVtIHBpcGUgcGlwZSkKPiAgIHsKPiBAQCAtNTQ4LDE4ICs1NDgs
MTggQEAgc3RhdGljIHZvaWQgdmx2X3NldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gICAJICogYSBzeXN0ZW0gc3VzcGVuZC4gIFNvIGdyYWIgdGhlIFBJUEUtQSBk
b21haW4sIHdoaWNoIGNvdmVycwo+ICAgCSAqIHRoZSBIVyBibG9ja3MgbmVlZGVkIGZvciB0aGUg
Zm9sbG93aW5nIHByb2dyYW1taW5nLgo+ICAgCSAqLwo+IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3Bs
YXlfcG93ZXJfZ2V0KGRldl9wcml2LCBQT1dFUl9ET01BSU5fUElQRV9BKTsKPiArCXdha2VyZWYg
PSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChpOTE1LCBQT1dFUl9ET01BSU5fUElQRV9BKTsKPiAg
IAo+IC0Jdmx2X2lvc2Zfc2JfZ2V0KGRldl9wcml2LAo+ICsJdmx2X2lvc2Zfc2JfZ2V0KGk5MTUs
Cj4gICAJCQlCSVQoVkxWX0lPU0ZfU0JfQ0NLKSB8Cj4gICAJCQlCSVQoVkxWX0lPU0ZfU0JfQlVO
SVQpIHwKPiAgIAkJCUJJVChWTFZfSU9TRl9TQl9QVU5JVCkpOwo+ICAgCj4gLQl2YWwgPSB2bHZf
cHVuaXRfcmVhZChkZXZfcHJpdiwgUFVOSVRfUkVHX0RTUFNTUE0pOwo+ICsJdmFsID0gdmx2X3B1
bml0X3JlYWQoaTkxNSwgUFVOSVRfUkVHX0RTUFNTUE0pOwo+ICAgCXZhbCAmPSB+RFNQRlJFUUdV
QVJfTUFTSzsKPiAgIAl2YWwgfD0gKGNtZCA8PCBEU1BGUkVRR1VBUl9TSElGVCk7Cj4gLQl2bHZf
cHVuaXRfd3JpdGUoZGV2X3ByaXYsIFBVTklUX1JFR19EU1BTU1BNLCB2YWwpOwo+IC0JaWYgKHdh
aXRfZm9yKCh2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgUFVOSVRfUkVHX0RTUFNTUE0pICYKPiAr
CXZsdl9wdW5pdF93cml0ZShpOTE1LCBQVU5JVF9SRUdfRFNQU1NQTSwgdmFsKTsKPiArCWlmICh3
YWl0X2Zvcigodmx2X3B1bml0X3JlYWQoaTkxNSwgUFVOSVRfUkVHX0RTUFNTUE0pICYKPiAgIAkJ
ICAgICAgRFNQRlJFUVNUQVRfTUFTSykgPT0gKGNtZCA8PCBEU1BGUkVRU1RBVF9TSElGVCksCj4g
ICAJCSAgICAgNTApKSB7Cj4gICAJCURSTV9FUlJPUigidGltZWQgb3V0IHdhaXRpbmcgZm9yIENE
Y2xrIGNoYW5nZVxuIik7Cj4gQEAgLTU2OCwyMyArNTY4LDIzIEBAIHN0YXRpYyB2b2lkIHZsdl9z
ZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCWlmIChjZGNs
ayA9PSA0MDAwMDApIHsKPiAgIAkJdTMyIGRpdmlkZXI7Cj4gICAKPiAtCQlkaXZpZGVyID0gRElW
X1JPVU5EX0NMT1NFU1QoZGV2X3ByaXYtPmhwbGxfZnJlcSA8PCAxLAo+ICsJCWRpdmlkZXIgPSBE
SVZfUk9VTkRfQ0xPU0VTVChpOTE1LT5ocGxsX2ZyZXEgPDwgMSwKPiAgIAkJCQkJICAgIGNkY2xr
KSAtIDE7Cj4gICAKPiAgIAkJLyogYWRqdXN0IGNkY2xrIGRpdmlkZXIgKi8KPiAtCQl2YWwgPSB2
bHZfY2NrX3JlYWQoZGV2X3ByaXYsIENDS19ESVNQTEFZX0NMT0NLX0NPTlRST0wpOwo+ICsJCXZh
bCA9IHZsdl9jY2tfcmVhZChpOTE1LCBDQ0tfRElTUExBWV9DTE9DS19DT05UUk9MKTsKPiAgIAkJ
dmFsICY9IH5DQ0tfRlJFUVVFTkNZX1ZBTFVFUzsKPiAgIAkJdmFsIHw9IGRpdmlkZXI7Cj4gLQkJ
dmx2X2Nja193cml0ZShkZXZfcHJpdiwgQ0NLX0RJU1BMQVlfQ0xPQ0tfQ09OVFJPTCwgdmFsKTsK
PiArCQl2bHZfY2NrX3dyaXRlKGk5MTUsIENDS19ESVNQTEFZX0NMT0NLX0NPTlRST0wsIHZhbCk7
Cj4gICAKPiAtCQlpZiAod2FpdF9mb3IoKHZsdl9jY2tfcmVhZChkZXZfcHJpdiwgQ0NLX0RJU1BM
QVlfQ0xPQ0tfQ09OVFJPTCkgJgo+ICsJCWlmICh3YWl0X2Zvcigodmx2X2Nja19yZWFkKGk5MTUs
IENDS19ESVNQTEFZX0NMT0NLX0NPTlRST0wpICYKPiAgIAkJCSAgICAgIENDS19GUkVRVUVOQ1lf
U1RBVFVTKSA9PSAoZGl2aWRlciA8PCBDQ0tfRlJFUVVFTkNZX1NUQVRVU19TSElGVCksCj4gICAJ
CQkgICAgIDUwKSkKPiAgIAkJCURSTV9FUlJPUigidGltZWQgb3V0IHdhaXRpbmcgZm9yIENEY2xr
IGNoYW5nZVxuIik7Cj4gICAJfQo+ICAgCj4gICAJLyogYWRqdXN0IHNlbGYtcmVmcmVzaCBleGl0
IGxhdGVuY3kgdmFsdWUgKi8KPiAtCXZhbCA9IHZsdl9idW5pdF9yZWFkKGRldl9wcml2LCBCVU5J
VF9SRUdfQklTT0MpOwo+ICsJdmFsID0gdmx2X2J1bml0X3JlYWQoaTkxNSwgQlVOSVRfUkVHX0JJ
U09DKTsKPiAgIAl2YWwgJj0gfjB4N2Y7Cj4gICAKPiAgIAkvKgo+IEBAIC01OTUsMjEgKzU5NSwy
MSBAQCBzdGF0aWMgdm9pZCB2bHZfc2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiAgIAkJdmFsIHw9IDQ1MDAgLyAyNTA7IC8qIDQuNSB1c2VjICovCj4gICAJZWxz
ZQo+ICAgCQl2YWwgfD0gMzAwMCAvIDI1MDsgLyogMy4wIHVzZWMgKi8KPiAtCXZsdl9idW5pdF93
cml0ZShkZXZfcHJpdiwgQlVOSVRfUkVHX0JJU09DLCB2YWwpOwo+ICsJdmx2X2J1bml0X3dyaXRl
KGk5MTUsIEJVTklUX1JFR19CSVNPQywgdmFsKTsKPiAgIAo+IC0Jdmx2X2lvc2Zfc2JfcHV0KGRl
dl9wcml2LAo+ICsJdmx2X2lvc2Zfc2JfcHV0KGk5MTUsCj4gICAJCQlCSVQoVkxWX0lPU0ZfU0Jf
Q0NLKSB8Cj4gICAJCQlCSVQoVkxWX0lPU0ZfU0JfQlVOSVQpIHwKPiAgIAkJCUJJVChWTFZfSU9T
Rl9TQl9QVU5JVCkpOwo+ICAgCj4gLQlpbnRlbF91cGRhdGVfY2RjbGsoZGV2X3ByaXYpOwo+ICsJ
aW50ZWxfdXBkYXRlX2NkY2xrKGk5MTUpOwo+ICAgCj4gLQl2bHZfcHJvZ3JhbV9wZmlfY3JlZGl0
cyhkZXZfcHJpdik7Cj4gKwl2bHZfcHJvZ3JhbV9wZmlfY3JlZGl0cyhpOTE1KTsKPiAgIAo+IC0J
aW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9QSVBFX0EsIHdh
a2VyZWYpOwo+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgUE9XRVJfRE9NQUlOX1BJ
UEVfQSwgd2FrZXJlZik7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgY2h2X3NldF9jZGNsayhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGNodl9zZXRf
Y2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgIGNvbnN0IHN0cnVj
dCBpbnRlbF9jZGNsa19zdGF0ZSAqY2RjbGtfc3RhdGUsCj4gICAJCQkgIGVudW0gcGlwZSBwaXBl
KQo+ICAgewo+IEBAIC02MzQsMjYgKzYzNCwyNiBAQCBzdGF0aWMgdm9pZCBjaHZfc2V0X2NkY2xr
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkgKiBhIHN5c3RlbSBzdXNw
ZW5kLiAgU28gZ3JhYiB0aGUgUElQRS1BIGRvbWFpbiwgd2hpY2ggY292ZXJzCj4gICAJICogdGhl
IEhXIGJsb2NrcyBuZWVkZWQgZm9yIHRoZSBmb2xsb3dpbmcgcHJvZ3JhbW1pbmcuCj4gICAJICov
Cj4gLQl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoZGV2X3ByaXYsIFBPV0VSX0RP
TUFJTl9QSVBFX0EpOwo+ICsJd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGk5MTUs
IFBPV0VSX0RPTUFJTl9QSVBFX0EpOwo+ICAgCj4gLQl2bHZfcHVuaXRfZ2V0KGRldl9wcml2KTsK
PiAtCXZhbCA9IHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfRFNQU1NQTSk7Cj4g
Kwl2bHZfcHVuaXRfZ2V0KGk5MTUpOwo+ICsJdmFsID0gdmx2X3B1bml0X3JlYWQoaTkxNSwgUFVO
SVRfUkVHX0RTUFNTUE0pOwo+ICAgCXZhbCAmPSB+RFNQRlJFUUdVQVJfTUFTS19DSFY7Cj4gICAJ
dmFsIHw9IChjbWQgPDwgRFNQRlJFUUdVQVJfU0hJRlRfQ0hWKTsKPiAtCXZsdl9wdW5pdF93cml0
ZShkZXZfcHJpdiwgUFVOSVRfUkVHX0RTUFNTUE0sIHZhbCk7Cj4gLQlpZiAod2FpdF9mb3IoKHZs
dl9wdW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfRFNQU1NQTSkgJgo+ICsJdmx2X3B1bml0
X3dyaXRlKGk5MTUsIFBVTklUX1JFR19EU1BTU1BNLCB2YWwpOwo+ICsJaWYgKHdhaXRfZm9yKCh2
bHZfcHVuaXRfcmVhZChpOTE1LCBQVU5JVF9SRUdfRFNQU1NQTSkgJgo+ICAgCQkgICAgICBEU1BG
UkVRU1RBVF9NQVNLX0NIVikgPT0gKGNtZCA8PCBEU1BGUkVRU1RBVF9TSElGVF9DSFYpLAo+ICAg
CQkgICAgIDUwKSkgewo+ICAgCQlEUk1fRVJST1IoInRpbWVkIG91dCB3YWl0aW5nIGZvciBDRGNs
ayBjaGFuZ2VcbiIpOwo+ICAgCX0KPiAgIAo+IC0Jdmx2X3B1bml0X3B1dChkZXZfcHJpdik7Cj4g
Kwl2bHZfcHVuaXRfcHV0KGk5MTUpOwo+ICAgCj4gLQlpbnRlbF91cGRhdGVfY2RjbGsoZGV2X3By
aXYpOwo+ICsJaW50ZWxfdXBkYXRlX2NkY2xrKGk5MTUpOwo+ICAgCj4gLQl2bHZfcHJvZ3JhbV9w
ZmlfY3JlZGl0cyhkZXZfcHJpdik7Cj4gKwl2bHZfcHJvZ3JhbV9wZmlfY3JlZGl0cyhpOTE1KTsK
PiAgIAo+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9Q
SVBFX0EsIHdha2VyZWYpOwo+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgUE9XRVJf
RE9NQUlOX1BJUEVfQSwgd2FrZXJlZik7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQgYmR3X2Nh
bGNfY2RjbGsoaW50IG1pbl9jZGNsaykKPiBAQCAtNjgzLDcgKzY4Myw3IEBAIHN0YXRpYyB1OCBi
ZHdfY2FsY192b2x0YWdlX2xldmVsKGludCBjZGNsaykKPiAgIAl9Cj4gICB9Cj4gICAKPiAtc3Rh
dGljIHZvaWQgYmR3X2dldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gK3N0YXRpYyB2b2lkIGJkd19nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gICAJCQkgIHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqY2RjbGtfc3RhdGUpCj4gICB7
Cj4gICAJdTMyIGxjcGxsID0gSTkxNV9SRUFEKExDUExMX0NUTCk7Cj4gQEAgLTcxMCw3ICs3MTAs
NyBAQCBzdGF0aWMgdm9pZCBiZHdfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiAgIAkJYmR3X2NhbGNfdm9sdGFnZV9sZXZlbChjZGNsa19zdGF0ZS0+Y2RjbGsp
Owo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGJkd19zZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBiZHdfc2V0X2NkY2xrKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY2RjbGtf
c3RhdGUgKmNkY2xrX3N0YXRlLAo+ICAgCQkJICBlbnVtIHBpcGUgcGlwZSkKPiAgIHsKPiBAQCAt
NzI2LDcgKzcyNiw3IEBAIHN0YXRpYyB2b2lkIGJkd19zZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCQkgInRyeWluZyB0byBjaGFuZ2UgY2RjbGsgZnJlcXVl
bmN5IHdpdGggY2RjbGsgbm90IGVuYWJsZWRcbiIpKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCXJl
dCA9IHNhbmR5YnJpZGdlX3Bjb2RlX3dyaXRlKGRldl9wcml2LAo+ICsJcmV0ID0gc2FuZHlicmlk
Z2VfcGNvZGVfd3JpdGUoaTkxNSwKPiAgIAkJCQkgICAgICBCRFdfUENPREVfRElTUExBWV9GUkVR
X0NIQU5HRV9SRVEsIDB4MCk7Cj4gICAJaWYgKHJldCkgewo+ICAgCQlEUk1fRVJST1IoImZhaWxl
ZCB0byBpbmZvcm0gcGNvZGUgYWJvdXQgY2RjbGsgY2hhbmdlXG4iKTsKPiBAQCAtNzc2LDEyICs3
NzYsMTIgQEAgc3RhdGljIHZvaWQgYmR3X3NldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gICAJCQlMQ1BMTF9DRF9TT1VSQ0VfRkNMS19ET05FKSA9PSAwLCAxKSkK
PiAgIAkJRFJNX0VSUk9SKCJTd2l0Y2hpbmcgYmFjayB0byBMQ1BMTCBmYWlsZWRcbiIpOwo+ICAg
Cj4gLQlzYW5keWJyaWRnZV9wY29kZV93cml0ZShkZXZfcHJpdiwgSFNXX1BDT0RFX0RFX1dSSVRF
X0ZSRVFfUkVRLAo+ICsJc2FuZHlicmlkZ2VfcGNvZGVfd3JpdGUoaTkxNSwgSFNXX1BDT0RFX0RF
X1dSSVRFX0ZSRVFfUkVRLAo+ICAgCQkJCWNkY2xrX3N0YXRlLT52b2x0YWdlX2xldmVsKTsKPiAg
IAo+ICAgCUk5MTVfV1JJVEUoQ0RDTEtfRlJFUSwgRElWX1JPVU5EX0NMT1NFU1QoY2RjbGssIDEw
MDApIC0gMSk7Cj4gICAKPiAtCWludGVsX3VwZGF0ZV9jZGNsayhkZXZfcHJpdik7Cj4gKwlpbnRl
bF91cGRhdGVfY2RjbGsoaTkxNSk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQgc2tsX2NhbGNf
Y2RjbGsoaW50IG1pbl9jZGNsaywgaW50IHZjbykKPiBAQCAtODE5LDcgKzgxOSw3IEBAIHN0YXRp
YyB1OCBza2xfY2FsY192b2x0YWdlX2xldmVsKGludCBjZGNsaykKPiAgIAkJcmV0dXJuIDA7Cj4g
ICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgc2tsX2RwbGwwX3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIHNrbF9kcGxsMF91cGRhdGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICAgIHN0cnVjdCBpbnRlbF9jZGNsa19z
dGF0ZSAqY2RjbGtfc3RhdGUpCj4gICB7Cj4gICAJdTMyIHZhbDsKPiBAQCAtODU5LDEyICs4NTks
MTIgQEAgc3RhdGljIHZvaWQgc2tsX2RwbGwwX3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gICAJfQo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIHNrbF9nZXRfY2Rj
bGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBza2xf
Z2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICBzdHJ1Y3Qg
aW50ZWxfY2RjbGtfc3RhdGUgKmNkY2xrX3N0YXRlKQo+ICAgewo+ICAgCXUzMiBjZGN0bDsKPiAg
IAo+IC0Jc2tsX2RwbGwwX3VwZGF0ZShkZXZfcHJpdiwgY2RjbGtfc3RhdGUpOwo+ICsJc2tsX2Rw
bGwwX3VwZGF0ZShpOTE1LCBjZGNsa19zdGF0ZSk7Cj4gICAKPiAgIAljZGNsa19zdGF0ZS0+Y2Rj
bGsgPSBjZGNsa19zdGF0ZS0+YnlwYXNzID0gY2RjbGtfc3RhdGUtPnJlZjsKPiAgIAo+IEBAIC05
MjYsMTggKzkyNiwxOCBAQCBzdGF0aWMgaW50IHNrbF9jZGNsa19kZWNpbWFsKGludCBjZGNsaykK
PiAgIAlyZXR1cm4gRElWX1JPVU5EX0NMT1NFU1QoY2RjbGsgLSAxMDAwLCA1MDApOwo+ICAgfQo+
ICAgCj4gLXN0YXRpYyB2b2lkIHNrbF9zZXRfcHJlZmVycmVkX2NkY2xrX3ZjbyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIHNrbF9zZXRfcHJlZmVycmVk
X2NkY2xrX3ZjbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkJaW50IHZj
bykKPiAgIHsKPiAtCWJvb2wgY2hhbmdlZCA9IGRldl9wcml2LT5za2xfcHJlZmVycmVkX3Zjb19m
cmVxICE9IHZjbzsKPiArCWJvb2wgY2hhbmdlZCA9IGk5MTUtPnNrbF9wcmVmZXJyZWRfdmNvX2Zy
ZXEgIT0gdmNvOwo+ICAgCj4gLQlkZXZfcHJpdi0+c2tsX3ByZWZlcnJlZF92Y29fZnJlcSA9IHZj
bzsKPiArCWk5MTUtPnNrbF9wcmVmZXJyZWRfdmNvX2ZyZXEgPSB2Y287Cj4gICAKPiAgIAlpZiAo
Y2hhbmdlZCkKPiAtCQlpbnRlbF91cGRhdGVfbWF4X2NkY2xrKGRldl9wcml2KTsKPiArCQlpbnRl
bF91cGRhdGVfbWF4X2NkY2xrKGk5MTUpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIHNrbF9k
cGxsMF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgdmNvKQo+
ICtzdGF0aWMgdm9pZCBza2xfZHBsbDBfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LCBpbnQgdmNvKQo+ICAgewo+ICAgCXUzMiB2YWw7Cj4gICAKPiBAQCAtOTY5LDI5ICs5Njks
MjkgQEAgc3RhdGljIHZvaWQgc2tsX2RwbGwwX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsIGludCB2Y28pCj4gICAKPiAgIAlJOTE1X1dSSVRFKExDUExMMV9DVEwsIEk5
MTVfUkVBRChMQ1BMTDFfQ1RMKSB8IExDUExMX1BMTF9FTkFCTEUpOwo+ICAgCj4gLQlpZiAoaW50
ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gKwlpZiAoaW50ZWxfd2Fp
dF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiAgIAkJCQkgICAgTENQTEwxX0NUTCwgTENQ
TExfUExMX0xPQ0ssIExDUExMX1BMTF9MT0NLLAo+ICAgCQkJCSAgICA1KSkKPiAgIAkJRFJNX0VS
Uk9SKCJEUExMMCBub3QgbG9ja2VkXG4iKTsKPiAgIAo+IC0JZGV2X3ByaXYtPmNkY2xrLmh3LnZj
byA9IHZjbzsKPiArCWk5MTUtPmNkY2xrLmh3LnZjbyA9IHZjbzsKPiAgIAo+ICAgCS8qIFdlJ2xs
IHdhbnQgdG8ga2VlcCB1c2luZyB0aGUgY3VycmVudCB2Y28gZnJvbSBub3cgb24uICovCj4gLQlz
a2xfc2V0X3ByZWZlcnJlZF9jZGNsa192Y28oZGV2X3ByaXYsIHZjbyk7Cj4gKwlza2xfc2V0X3By
ZWZlcnJlZF9jZGNsa192Y28oaTkxNSwgdmNvKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBz
a2xfZHBsbDBfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0
YXRpYyB2b2lkIHNrbF9kcGxsMF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ICAgewo+ICAgCUk5MTVfV1JJVEUoTENQTEwxX0NUTCwgSTkxNV9SRUFEKExDUExMMV9DVEwp
ICYgfkxDUExMX1BMTF9FTkFCTEUpOwo+IC0JaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZk
ZXZfcHJpdi0+dW5jb3JlLAo+ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51
bmNvcmUsCj4gICAJCQkJICAgIExDUExMMV9DVEwsIExDUExMX1BMTF9MT0NLLCAwLAo+ICAgCQkJ
CSAgICAxKSkKPiAgIAkJRFJNX0VSUk9SKCJDb3VsZG4ndCBkaXNhYmxlIERQTEwwXG4iKTsKPiAg
IAo+IC0JZGV2X3ByaXYtPmNkY2xrLmh3LnZjbyA9IDA7Cj4gKwlpOTE1LT5jZGNsay5ody52Y28g
PSAwOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIHNrbF9zZXRfY2RjbGsoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBza2xfc2V0X2NkY2xrKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY2Rj
bGtfc3RhdGUgKmNkY2xrX3N0YXRlLAo+ICAgCQkJICBlbnVtIHBpcGUgcGlwZSkKPiAgIHsKPiBA
QCAtMTAwOCw5ICsxMDA4LDkgQEAgc3RhdGljIHZvaWQgc2tsX3NldF9jZGNsayhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJICogdXNlIHRoZSBjb3JyZXNwb25kaW5nIFZD
TyBmcmVxIGFzIHRoYXQgYWx3YXlzIGxlYWRzIHRvIHVzaW5nIHRoZQo+ICAgCSAqIG1pbmltdW0g
MzA4TUh6IENEQ0xLLgo+ICAgCSAqLwo+IC0JV0FSTl9PTl9PTkNFKElTX1NLWUxBS0UoZGV2X3By
aXYpICYmIHZjbyA9PSA4NjQwMDAwKTsKPiArCVdBUk5fT05fT05DRShJU19TS1lMQUtFKGk5MTUp
ICYmIHZjbyA9PSA4NjQwMDAwKTsKPiAgIAo+IC0JcmV0ID0gc2tsX3Bjb2RlX3JlcXVlc3QoZGV2
X3ByaXYsIFNLTF9QQ09ERV9DRENMS19DT05UUk9MLAo+ICsJcmV0ID0gc2tsX3Bjb2RlX3JlcXVl
c3QoaTkxNSwgU0tMX1BDT0RFX0NEQ0xLX0NPTlRST0wsCj4gICAJCQkJU0tMX0NEQ0xLX1BSRVBB
UkVfRk9SX0NIQU5HRSwKPiAgIAkJCQlTS0xfQ0RDTEtfUkVBRFlfRk9SX0NIQU5HRSwKPiAgIAkJ
CQlTS0xfQ0RDTEtfUkVBRFlfRk9SX0NIQU5HRSwgMyk7Cj4gQEAgLTEwMjMsNyArMTAyMyw3IEBA
IHN0YXRpYyB2b2lkIHNrbF9zZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ICAgCS8qIENob29zZSBmcmVxdWVuY3kgZm9yIHRoaXMgY2RjbGsgKi8KPiAgIAlzd2l0
Y2ggKGNkY2xrKSB7Cj4gICAJZGVmYXVsdDoKPiAtCQlXQVJOX09OKGNkY2xrICE9IGRldl9wcml2
LT5jZGNsay5ody5ieXBhc3MpOwo+ICsJCVdBUk5fT04oY2RjbGsgIT0gaTkxNS0+Y2RjbGsuaHcu
YnlwYXNzKTsKPiAgIAkJV0FSTl9PTih2Y28gIT0gMCk7Cj4gICAJCS8qIGZhbGwgdGhyb3VnaCAq
Lwo+ICAgCWNhc2UgMzA4NTcxOgo+IEBAIC0xMDQzLDEzICsxMDQzLDEzIEBAIHN0YXRpYyB2b2lk
IHNrbF9zZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCQli
cmVhazsKPiAgIAl9Cj4gICAKPiAtCWlmIChkZXZfcHJpdi0+Y2RjbGsuaHcudmNvICE9IDAgJiYK
PiAtCSAgICBkZXZfcHJpdi0+Y2RjbGsuaHcudmNvICE9IHZjbykKPiAtCQlza2xfZHBsbDBfZGlz
YWJsZShkZXZfcHJpdik7Cj4gKwlpZiAoaTkxNS0+Y2RjbGsuaHcudmNvICE9IDAgJiYKPiArCSAg
ICBpOTE1LT5jZGNsay5ody52Y28gIT0gdmNvKQo+ICsJCXNrbF9kcGxsMF9kaXNhYmxlKGk5MTUp
Owo+ICAgCj4gICAJY2RjbGtfY3RsID0gSTkxNV9SRUFEKENEQ0xLX0NUTCk7Cj4gICAKPiAtCWlm
IChkZXZfcHJpdi0+Y2RjbGsuaHcudmNvICE9IHZjbykgewo+ICsJaWYgKGk5MTUtPmNkY2xrLmh3
LnZjbyAhPSB2Y28pIHsKPiAgIAkJLyogV2EgRGlzcGxheSAjMTE4Mzogc2tsLGtibCxjZmwgKi8K
PiAgIAkJY2RjbGtfY3RsICY9IH4oQ0RDTEtfRlJFUV9TRUxfTUFTSyB8IENEQ0xLX0ZSRVFfREVD
SU1BTF9NQVNLKTsKPiAgIAkJY2RjbGtfY3RsIHw9IGZyZXFfc2VsZWN0IHwgc2tsX2NkY2xrX2Rl
Y2ltYWwoY2RjbGspOwo+IEBAIC0xMDYxLDggKzEwNjEsOCBAQCBzdGF0aWMgdm9pZCBza2xfc2V0
X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlJOTE1X1dSSVRF
KENEQ0xLX0NUTCwgY2RjbGtfY3RsKTsKPiAgIAlQT1NUSU5HX1JFQUQoQ0RDTEtfQ1RMKTsKPiAg
IAo+IC0JaWYgKGRldl9wcml2LT5jZGNsay5ody52Y28gIT0gdmNvKQo+IC0JCXNrbF9kcGxsMF9l
bmFibGUoZGV2X3ByaXYsIHZjbyk7Cj4gKwlpZiAoaTkxNS0+Y2RjbGsuaHcudmNvICE9IHZjbykK
PiArCQlza2xfZHBsbDBfZW5hYmxlKGk5MTUsIHZjbyk7Cj4gICAKPiAgIAkvKiBXYSBEaXNwbGF5
ICMxMTgzOiBza2wsa2JsLGNmbCAqLwo+ICAgCWNkY2xrX2N0bCAmPSB+KENEQ0xLX0ZSRVFfU0VM
X01BU0sgfCBDRENMS19GUkVRX0RFQ0lNQUxfTUFTSyk7Cj4gQEAgLTEwNzcsMTMgKzEwNzcsMTMg
QEAgc3RhdGljIHZvaWQgc2tsX3NldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gICAJUE9TVElOR19SRUFEKENEQ0xLX0NUTCk7Cj4gICAKPiAgIAkvKiBpbmZvcm0g
UENVIG9mIHRoZSBjaGFuZ2UgKi8KPiAtCXNhbmR5YnJpZGdlX3Bjb2RlX3dyaXRlKGRldl9wcml2
LCBTS0xfUENPREVfQ0RDTEtfQ09OVFJPTCwKPiArCXNhbmR5YnJpZGdlX3Bjb2RlX3dyaXRlKGk5
MTUsIFNLTF9QQ09ERV9DRENMS19DT05UUk9MLAo+ICAgCQkJCWNkY2xrX3N0YXRlLT52b2x0YWdl
X2xldmVsKTsKPiAgIAo+IC0JaW50ZWxfdXBkYXRlX2NkY2xrKGRldl9wcml2KTsKPiArCWludGVs
X3VwZGF0ZV9jZGNsayhpOTE1KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBza2xfc2FuaXRp
emVfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9p
ZCBza2xfc2FuaXRpemVfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7
Cj4gICAJdTMyIGNkY3RsLCBleHBlY3RlZDsKPiAgIAo+IEBAIC0xMDk1LDEyICsxMDk1LDEyIEBA
IHN0YXRpYyB2b2lkIHNrbF9zYW5pdGl6ZV9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gICAJaWYgKChJOTE1X1JFQUQoU1dGX0lMSygweDE4KSkgJiAweDAwRkZGRkZG
KSA9PSAwKQo+ICAgCQlnb3RvIHNhbml0aXplOwo+ICAgCj4gLQlpbnRlbF91cGRhdGVfY2RjbGso
ZGV2X3ByaXYpOwo+IC0JaW50ZWxfZHVtcF9jZGNsa19zdGF0ZSgmZGV2X3ByaXYtPmNkY2xrLmh3
LCAiQ3VycmVudCBDRENMSyIpOwo+ICsJaW50ZWxfdXBkYXRlX2NkY2xrKGk5MTUpOwo+ICsJaW50
ZWxfZHVtcF9jZGNsa19zdGF0ZSgmaTkxNS0+Y2RjbGsuaHcsICJDdXJyZW50IENEQ0xLIik7Cj4g
ICAKPiAgIAkvKiBJcyBQTEwgZW5hYmxlZCBhbmQgbG9ja2VkID8gKi8KPiAtCWlmIChkZXZfcHJp
di0+Y2RjbGsuaHcudmNvID09IDAgfHwKPiAtCSAgICBkZXZfcHJpdi0+Y2RjbGsuaHcuY2RjbGsg
PT0gZGV2X3ByaXYtPmNkY2xrLmh3LmJ5cGFzcykKPiArCWlmIChpOTE1LT5jZGNsay5ody52Y28g
PT0gMCB8fAo+ICsJICAgIGk5MTUtPmNkY2xrLmh3LmNkY2xrID09IGk5MTUtPmNkY2xrLmh3LmJ5
cGFzcykKPiAgIAkJZ290byBzYW5pdGl6ZTsKPiAgIAo+ICAgCS8qIERQTEwgb2theTsgdmVyaWZ5
IHRoZSBjZGNsb2NrCj4gQEAgLTExMTEsNyArMTExMSw3IEBAIHN0YXRpYyB2b2lkIHNrbF9zYW5p
dGl6ZV9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICovCj4g
ICAJY2RjdGwgPSBJOTE1X1JFQUQoQ0RDTEtfQ1RMKTsKPiAgIAlleHBlY3RlZCA9IChjZGN0bCAm
IENEQ0xLX0ZSRVFfU0VMX01BU0spIHwKPiAtCQlza2xfY2RjbGtfZGVjaW1hbChkZXZfcHJpdi0+
Y2RjbGsuaHcuY2RjbGspOwo+ICsJCXNrbF9jZGNsa19kZWNpbWFsKGk5MTUtPmNkY2xrLmh3LmNk
Y2xrKTsKPiAgIAlpZiAoY2RjdGwgPT0gZXhwZWN0ZWQpCj4gICAJCS8qIEFsbCB3ZWxsOyBub3Ro
aW5nIHRvIHNhbml0aXplICovCj4gICAJCXJldHVybjsKPiBAQCAtMTEyMCw0OSArMTEyMCw0OSBA
QCBzdGF0aWMgdm9pZCBza2xfc2FuaXRpemVfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICAgCURSTV9ERUJVR19LTVMoIlNhbml0aXppbmcgY2RjbGsgcHJvZ3JhbW1l
ZCBieSBwcmUtb3NcbiIpOwo+ICAgCj4gICAJLyogZm9yY2UgY2RjbGsgcHJvZ3JhbW1pbmcgKi8K
PiAtCWRldl9wcml2LT5jZGNsay5ody5jZGNsayA9IDA7Cj4gKwlpOTE1LT5jZGNsay5ody5jZGNs
ayA9IDA7Cj4gICAJLyogZm9yY2UgZnVsbCBQTEwgZGlzYWJsZSArIGVuYWJsZSAqLwo+IC0JZGV2
X3ByaXYtPmNkY2xrLmh3LnZjbyA9IC0xOwo+ICsJaTkxNS0+Y2RjbGsuaHcudmNvID0gLTE7Cj4g
ICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgc2tsX2luaXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBza2xfaW5pdF9jZGNsayhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUg
Y2RjbGtfc3RhdGU7Cj4gICAKPiAtCXNrbF9zYW5pdGl6ZV9jZGNsayhkZXZfcHJpdik7Cj4gKwlz
a2xfc2FuaXRpemVfY2RjbGsoaTkxNSk7Cj4gICAKPiAtCWlmIChkZXZfcHJpdi0+Y2RjbGsuaHcu
Y2RjbGsgIT0gMCAmJgo+IC0JICAgIGRldl9wcml2LT5jZGNsay5ody52Y28gIT0gMCkgewo+ICsJ
aWYgKGk5MTUtPmNkY2xrLmh3LmNkY2xrICE9IDAgJiYKPiArCSAgICBpOTE1LT5jZGNsay5ody52
Y28gIT0gMCkgewo+ICAgCQkvKgo+ICAgCQkgKiBVc2UgdGhlIGN1cnJlbnQgdmNvIGFzIG91ciBp
bml0aWFsCj4gICAJCSAqIGd1ZXNzIGFzIHRvIHdoYXQgdGhlIHByZWZlcnJlZCB2Y28gaXMuCj4g
ICAJCSAqLwo+IC0JCWlmIChkZXZfcHJpdi0+c2tsX3ByZWZlcnJlZF92Y29fZnJlcSA9PSAwKQo+
IC0JCQlza2xfc2V0X3ByZWZlcnJlZF9jZGNsa192Y28oZGV2X3ByaXYsCj4gLQkJCQkJCSAgICBk
ZXZfcHJpdi0+Y2RjbGsuaHcudmNvKTsKPiArCQlpZiAoaTkxNS0+c2tsX3ByZWZlcnJlZF92Y29f
ZnJlcSA9PSAwKQo+ICsJCQlza2xfc2V0X3ByZWZlcnJlZF9jZGNsa192Y28oaTkxNSwKPiArCQkJ
CQkJICAgIGk5MTUtPmNkY2xrLmh3LnZjbyk7Cj4gICAJCXJldHVybjsKPiAgIAl9Cj4gICAKPiAt
CWNkY2xrX3N0YXRlID0gZGV2X3ByaXYtPmNkY2xrLmh3Owo+ICsJY2RjbGtfc3RhdGUgPSBpOTE1
LT5jZGNsay5odzsKPiAgIAo+IC0JY2RjbGtfc3RhdGUudmNvID0gZGV2X3ByaXYtPnNrbF9wcmVm
ZXJyZWRfdmNvX2ZyZXE7Cj4gKwljZGNsa19zdGF0ZS52Y28gPSBpOTE1LT5za2xfcHJlZmVycmVk
X3Zjb19mcmVxOwo+ICAgCWlmIChjZGNsa19zdGF0ZS52Y28gPT0gMCkKPiAgIAkJY2RjbGtfc3Rh
dGUudmNvID0gODEwMDAwMDsKPiAgIAljZGNsa19zdGF0ZS5jZGNsayA9IHNrbF9jYWxjX2NkY2xr
KDAsIGNkY2xrX3N0YXRlLnZjbyk7Cj4gICAJY2RjbGtfc3RhdGUudm9sdGFnZV9sZXZlbCA9IHNr
bF9jYWxjX3ZvbHRhZ2VfbGV2ZWwoY2RjbGtfc3RhdGUuY2RjbGspOwo+ICAgCj4gLQlza2xfc2V0
X2NkY2xrKGRldl9wcml2LCAmY2RjbGtfc3RhdGUsIElOVkFMSURfUElQRSk7Cj4gKwlza2xfc2V0
X2NkY2xrKGk5MTUsICZjZGNsa19zdGF0ZSwgSU5WQUxJRF9QSVBFKTsKPiAgIH0KPiAgIAo+IC1z
dGF0aWMgdm9pZCBza2xfdW5pbml0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiArc3RhdGljIHZvaWQgc2tsX3VuaW5pdF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSBjZGNsa19zdGF0
ZSA9IGRldl9wcml2LT5jZGNsay5odzsKPiArCXN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSBjZGNs
a19zdGF0ZSA9IGk5MTUtPmNkY2xrLmh3Owo+ICAgCj4gICAJY2RjbGtfc3RhdGUuY2RjbGsgPSBj
ZGNsa19zdGF0ZS5ieXBhc3M7Cj4gICAJY2RjbGtfc3RhdGUudmNvID0gMDsKPiAgIAljZGNsa19z
dGF0ZS52b2x0YWdlX2xldmVsID0gc2tsX2NhbGNfdm9sdGFnZV9sZXZlbChjZGNsa19zdGF0ZS5j
ZGNsayk7Cj4gICAKPiAtCXNrbF9zZXRfY2RjbGsoZGV2X3ByaXYsICZjZGNsa19zdGF0ZSwgSU5W
QUxJRF9QSVBFKTsKPiArCXNrbF9zZXRfY2RjbGsoaTkxNSwgJmNkY2xrX3N0YXRlLCBJTlZBTElE
X1BJUEUpOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgaW50IGJ4dF9jYWxjX2NkY2xrKGludCBtaW5f
Y2RjbGspCj4gQEAgLTExOTQsMTEgKzExOTQsMTEgQEAgc3RhdGljIHU4IGJ4dF9jYWxjX3ZvbHRh
Z2VfbGV2ZWwoaW50IGNkY2xrKQo+ICAgCXJldHVybiBESVZfUk9VTkRfVVAoY2RjbGssIDI1MDAw
KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgaW50IGJ4dF9kZV9wbGxfdmNvKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwgaW50IGNkY2xrKQo+ICtzdGF0aWMgaW50IGJ4dF9kZV9wbGxf
dmNvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBpbnQgY2RjbGspCj4gICB7Cj4gICAJ
aW50IHJhdGlvOwo+ICAgCj4gLQlpZiAoY2RjbGsgPT0gZGV2X3ByaXYtPmNkY2xrLmh3LmJ5cGFz
cykKPiArCWlmIChjZGNsayA9PSBpOTE1LT5jZGNsay5ody5ieXBhc3MpCj4gICAJCXJldHVybiAw
Owo+ICAgCj4gICAJc3dpdGNoIChjZGNsaykgewo+IEBAIC0xMjE2LDE0ICsxMjE2LDE0IEBAIHN0
YXRpYyBpbnQgYnh0X2RlX3BsbF92Y28oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LCBpbnQgY2RjbGspCj4gICAJCWJyZWFrOwo+ICAgCX0KPiAgIAo+IC0JcmV0dXJuIGRldl9wcml2
LT5jZGNsay5ody5yZWYgKiByYXRpbzsKPiArCXJldHVybiBpOTE1LT5jZGNsay5ody5yZWYgKiBy
YXRpbzsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgaW50IGdsa19kZV9wbGxfdmNvKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50IGNkY2xrKQo+ICtzdGF0aWMgaW50IGdsa19kZV9w
bGxfdmNvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBpbnQgY2RjbGspCj4gICB7Cj4g
ICAJaW50IHJhdGlvOwo+ICAgCj4gLQlpZiAoY2RjbGsgPT0gZGV2X3ByaXYtPmNkY2xrLmh3LmJ5
cGFzcykKPiArCWlmIChjZGNsayA9PSBpOTE1LT5jZGNsay5ody5ieXBhc3MpCj4gICAJCXJldHVy
biAwOwo+ICAgCj4gICAJc3dpdGNoIChjZGNsaykgewo+IEBAIC0xMjM3LDEwICsxMjM3LDEwIEBA
IHN0YXRpYyBpbnQgZ2xrX2RlX3BsbF92Y28oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LCBpbnQgY2RjbGspCj4gICAJCWJyZWFrOwo+ICAgCX0KPiAgIAo+IC0JcmV0dXJuIGRldl9w
cml2LT5jZGNsay5ody5yZWYgKiByYXRpbzsKPiArCXJldHVybiBpOTE1LT5jZGNsay5ody5yZWYg
KiByYXRpbzsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBieHRfZGVfcGxsX3VwZGF0ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGJ4dF9kZV9wbGxf
dXBkYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgICAgc3RydWN0
IGludGVsX2NkY2xrX3N0YXRlICpjZGNsa19zdGF0ZSkKPiAgIHsKPiAgIAl1MzIgdmFsOwo+IEBA
IC0xMjU5LDEzICsxMjU5LDEzIEBAIHN0YXRpYyB2b2lkIGJ4dF9kZV9wbGxfdXBkYXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAljZGNsa19zdGF0ZS0+dmNvID0gKHZh
bCAmIEJYVF9ERV9QTExfUkFUSU9fTUFTSykgKiBjZGNsa19zdGF0ZS0+cmVmOwo+ICAgfQo+ICAg
Cj4gLXN0YXRpYyB2b2lkIGJ4dF9nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ICtzdGF0aWMgdm9pZCBieHRfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAo+ICAgCQkJICBzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgKmNkY2xrX3N0YXRl
KQo+ICAgewo+ICAgCXUzMiBkaXZpZGVyOwo+ICAgCWludCBkaXY7Cj4gICAKPiAtCWJ4dF9kZV9w
bGxfdXBkYXRlKGRldl9wcml2LCBjZGNsa19zdGF0ZSk7Cj4gKwlieHRfZGVfcGxsX3VwZGF0ZShp
OTE1LCBjZGNsa19zdGF0ZSk7Cj4gICAKPiAgIAljZGNsa19zdGF0ZS0+Y2RjbGsgPSBjZGNsa19z
dGF0ZS0+YnlwYXNzID0gY2RjbGtfc3RhdGUtPnJlZjsKPiAgIAo+IEBAIC0xMjc5LDcgKzEyNzks
NyBAQCBzdGF0aWMgdm9pZCBieHRfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiAgIAkJZGl2ID0gMjsKPiAgIAkJYnJlYWs7Cj4gICAJY2FzZSBCWFRfQ0RDTEtf
Q0QyWF9ESVZfU0VMXzFfNToKPiAtCQlXQVJOKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpLCAiVW5z
dXBwb3J0ZWQgZGl2aWRlclxuIik7Cj4gKwkJV0FSTihJU19HRU1JTklMQUtFKGk5MTUpLCAiVW5z
dXBwb3J0ZWQgZGl2aWRlclxuIik7Cj4gICAJCWRpdiA9IDM7Cj4gICAJCWJyZWFrOwo+ICAgCWNh
c2UgQlhUX0NEQ0xLX0NEMlhfRElWX1NFTF8yOgo+IEBAIC0xMzA0LDIyICsxMzA0LDIyIEBAIHN0
YXRpYyB2b2lkIGJ4dF9nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ICAgCQlieHRfY2FsY192b2x0YWdlX2xldmVsKGNkY2xrX3N0YXRlLT5jZGNsayk7Cj4gICB9
Cj4gICAKPiAtc3RhdGljIHZvaWQgYnh0X2RlX3BsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgYnh0X2RlX3BsbF9kaXNhYmxlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCUk5MTVfV1JJVEUoQlhUX0RFX1BM
TF9FTkFCTEUsIDApOwo+ICAgCj4gICAJLyogVGltZW91dCAyMDB1cyAqLwo+IC0JaWYgKGludGVs
X3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLAo+ICsJaWYgKGludGVsX3dhaXRf
Zm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsCj4gICAJCQkJICAgIEJYVF9ERV9QTExfRU5BQkxF
LCBCWFRfREVfUExMX0xPQ0ssIDAsCj4gICAJCQkJICAgIDEpKQo+ICAgCQlEUk1fRVJST1IoInRp
bWVvdXQgd2FpdGluZyBmb3IgREUgUExMIHVubG9ja1xuIik7Cj4gICAKPiAtCWRldl9wcml2LT5j
ZGNsay5ody52Y28gPSAwOwo+ICsJaTkxNS0+Y2RjbGsuaHcudmNvID0gMDsKPiAgIH0KPiAgIAo+
IC1zdGF0aWMgdm9pZCBieHRfZGVfcGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsIGludCB2Y28pCj4gK3N0YXRpYyB2b2lkIGJ4dF9kZV9wbGxfZW5hYmxlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBpbnQgdmNvKQo+ICAgewo+IC0JaW50IHJhdGlvID0g
RElWX1JPVU5EX0NMT1NFU1QodmNvLCBkZXZfcHJpdi0+Y2RjbGsuaHcucmVmKTsKPiArCWludCBy
YXRpbyA9IERJVl9ST1VORF9DTE9TRVNUKHZjbywgaTkxNS0+Y2RjbGsuaHcucmVmKTsKPiAgIAl1
MzIgdmFsOwo+ICAgCj4gICAJdmFsID0gSTkxNV9SRUFEKEJYVF9ERV9QTExfQ1RMKTsKPiBAQCAt
MTMzMCwxNyArMTMzMCwxNyBAQCBzdGF0aWMgdm9pZCBieHRfZGVfcGxsX2VuYWJsZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCB2Y28pCj4gICAJSTkxNV9XUklURShCWFRf
REVfUExMX0VOQUJMRSwgQlhUX0RFX1BMTF9QTExfRU5BQkxFKTsKPiAgIAo+ICAgCS8qIFRpbWVv
dXQgMjAwdXMgKi8KPiAtCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVu
Y29yZSwKPiArCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+ICAg
CQkJCSAgICBCWFRfREVfUExMX0VOQUJMRSwKPiAgIAkJCQkgICAgQlhUX0RFX1BMTF9MT0NLLAo+
ICAgCQkJCSAgICBCWFRfREVfUExMX0xPQ0ssCj4gICAJCQkJICAgIDEpKQo+ICAgCQlEUk1fRVJS
T1IoInRpbWVvdXQgd2FpdGluZyBmb3IgREUgUExMIGxvY2tcbiIpOwo+ICAgCj4gLQlkZXZfcHJp
di0+Y2RjbGsuaHcudmNvID0gdmNvOwo+ICsJaTkxNS0+Y2RjbGsuaHcudmNvID0gdmNvOwo+ICAg
fQo+ICAgCj4gLXN0YXRpYyB2b2lkIGJ4dF9zZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBieHRfc2V0X2NkY2xrKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUg
KmNkY2xrX3N0YXRlLAo+ICAgCQkJICBlbnVtIHBpcGUgcGlwZSkKPiAgIHsKPiBAQCAtMTM1Miwx
NCArMTM1MiwxNCBAQCBzdGF0aWMgdm9pZCBieHRfc2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiAgIAkvKiBjZGNsayA9IHZjbyAvIDIgLyBkaXZ7MSwxLjUsMiw0
fSAqLwo+ICAgCXN3aXRjaCAoRElWX1JPVU5EX0NMT1NFU1QodmNvLCBjZGNsaykpIHsKPiAgIAlk
ZWZhdWx0Ogo+IC0JCVdBUk5fT04oY2RjbGsgIT0gZGV2X3ByaXYtPmNkY2xrLmh3LmJ5cGFzcyk7
Cj4gKwkJV0FSTl9PTihjZGNsayAhPSBpOTE1LT5jZGNsay5ody5ieXBhc3MpOwo+ICAgCQlXQVJO
X09OKHZjbyAhPSAwKTsKPiAgIAkJLyogZmFsbCB0aHJvdWdoICovCj4gICAJY2FzZSAyOgo+ICAg
CQlkaXZpZGVyID0gQlhUX0NEQ0xLX0NEMlhfRElWX1NFTF8xOwo+ICAgCQlicmVhazsKPiAgIAlj
YXNlIDM6Cj4gLQkJV0FSTihJU19HRU1JTklMQUtFKGRldl9wcml2KSwgIlVuc3VwcG9ydGVkIGRp
dmlkZXJcbiIpOwo+ICsJCVdBUk4oSVNfR0VNSU5JTEFLRShpOTE1KSwgIlVuc3VwcG9ydGVkIGRp
dmlkZXJcbiIpOwo+ICAgCQlkaXZpZGVyID0gQlhUX0NEQ0xLX0NEMlhfRElWX1NFTF8xXzU7Cj4g
ICAJCWJyZWFrOwo+ICAgCWNhc2UgNDoKPiBAQCAtMTM3NSw3ICsxMzc1LDcgQEAgc3RhdGljIHZv
aWQgYnh0X3NldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJ
ICogcmVxdWlyZXMgdXMgdG8gd2FpdCB1cCB0byAxNTB1c2VjLCBidXQgdGhhdCBsZWFkcyB0byB0
aW1lb3V0czsKPiAgIAkgKiB0aGUgMm1zIHVzZWQgaGVyZSBpcyBiYXNlZCBvbiBleHBlcmltZW50
Lgo+ICAgCSAqLwo+IC0JcmV0ID0gc2FuZHlicmlkZ2VfcGNvZGVfd3JpdGVfdGltZW91dChkZXZf
cHJpdiwKPiArCXJldCA9IHNhbmR5YnJpZGdlX3Bjb2RlX3dyaXRlX3RpbWVvdXQoaTkxNSwKPiAg
IAkJCQkJICAgICAgSFNXX1BDT0RFX0RFX1dSSVRFX0ZSRVFfUkVRLAo+ICAgCQkJCQkgICAgICAw
eDgwMDAwMDAwLCAxNTAsIDIpOwo+ICAgCWlmIChyZXQpIHsKPiBAQCAtMTM4NCwxMiArMTM4NCwx
MiBAQCBzdGF0aWMgdm9pZCBieHRfc2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiAgIAkJcmV0dXJuOwo+ICAgCX0KPiAgIAo+IC0JaWYgKGRldl9wcml2LT5jZGNs
ay5ody52Y28gIT0gMCAmJgo+IC0JICAgIGRldl9wcml2LT5jZGNsay5ody52Y28gIT0gdmNvKQo+
IC0JCWJ4dF9kZV9wbGxfZGlzYWJsZShkZXZfcHJpdik7Cj4gKwlpZiAoaTkxNS0+Y2RjbGsuaHcu
dmNvICE9IDAgJiYKPiArCSAgICBpOTE1LT5jZGNsay5ody52Y28gIT0gdmNvKQo+ICsJCWJ4dF9k
ZV9wbGxfZGlzYWJsZShpOTE1KTsKPiAgIAo+IC0JaWYgKGRldl9wcml2LT5jZGNsay5ody52Y28g
IT0gdmNvKQo+IC0JCWJ4dF9kZV9wbGxfZW5hYmxlKGRldl9wcml2LCB2Y28pOwo+ICsJaWYgKGk5
MTUtPmNkY2xrLmh3LnZjbyAhPSB2Y28pCj4gKwkJYnh0X2RlX3BsbF9lbmFibGUoaTkxNSwgdmNv
KTsKPiAgIAo+ICAgCXZhbCA9IGRpdmlkZXIgfCBza2xfY2RjbGtfZGVjaW1hbChjZGNsayk7Cj4g
ICAJaWYgKHBpcGUgPT0gSU5WQUxJRF9QSVBFKQo+IEBAIC0xNDA1LDcgKzE0MDUsNyBAQCBzdGF0
aWMgdm9pZCBieHRfc2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiAgIAlJOTE1X1dSSVRFKENEQ0xLX0NUTCwgdmFsKTsKPiAgIAo+ICAgCWlmIChwaXBlICE9IElO
VkFMSURfUElQRSkKPiAtCQlpbnRlbF93YWl0X2Zvcl92YmxhbmsoZGV2X3ByaXYsIHBpcGUpOwo+
ICsJCWludGVsX3dhaXRfZm9yX3ZibGFuayhpOTE1LCBwaXBlKTsKPiAgIAo+ICAgCS8qCj4gICAJ
ICogVGhlIHRpbWVvdXQgaXNuJ3Qgc3BlY2lmaWVkLCB0aGUgMm1zIHVzZWQgaGVyZSBpcyBiYXNl
ZCBvbgo+IEBAIC0xNDEzLDcgKzE0MTMsNyBAQCBzdGF0aWMgdm9pZCBieHRfc2V0X2NkY2xrKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkgKiBGSVhNRTogV2FpdGluZyBm
b3IgdGhlIHJlcXVlc3QgY29tcGxldGlvbiBjb3VsZCBiZSBkZWxheWVkIHVudGlsCj4gICAJICog
dGhlIG5leHQgUENPREUgcmVxdWVzdCBiYXNlZCBvbiBCU3BlYy4KPiAgIAkgKi8KPiAtCXJldCA9
IHNhbmR5YnJpZGdlX3Bjb2RlX3dyaXRlX3RpbWVvdXQoZGV2X3ByaXYsCj4gKwlyZXQgPSBzYW5k
eWJyaWRnZV9wY29kZV93cml0ZV90aW1lb3V0KGk5MTUsCj4gICAJCQkJCSAgICAgIEhTV19QQ09E
RV9ERV9XUklURV9GUkVRX1JFUSwKPiAgIAkJCQkJICAgICAgY2RjbGtfc3RhdGUtPnZvbHRhZ2Vf
bGV2ZWwsIDE1MCwgMik7Cj4gICAJaWYgKHJldCkgewo+IEBAIC0xNDIyLDE4ICsxNDIyLDE4IEBA
IHN0YXRpYyB2b2lkIGJ4dF9zZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ICAgCQlyZXR1cm47Cj4gICAJfQo+ICAgCj4gLQlpbnRlbF91cGRhdGVfY2RjbGsoZGV2
X3ByaXYpOwo+ICsJaW50ZWxfdXBkYXRlX2NkY2xrKGk5MTUpOwo+ICAgfQo+ICAgCj4gLXN0YXRp
YyB2b2lkIGJ4dF9zYW5pdGl6ZV9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gK3N0YXRpYyB2b2lkIGJ4dF9zYW5pdGl6ZV9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAl1MzIgY2RjdGwsIGV4cGVjdGVkOwo+ICAgCj4gLQlpbnRl
bF91cGRhdGVfY2RjbGsoZGV2X3ByaXYpOwo+IC0JaW50ZWxfZHVtcF9jZGNsa19zdGF0ZSgmZGV2
X3ByaXYtPmNkY2xrLmh3LCAiQ3VycmVudCBDRENMSyIpOwo+ICsJaW50ZWxfdXBkYXRlX2NkY2xr
KGk5MTUpOwo+ICsJaW50ZWxfZHVtcF9jZGNsa19zdGF0ZSgmaTkxNS0+Y2RjbGsuaHcsICJDdXJy
ZW50IENEQ0xLIik7Cj4gICAKPiAtCWlmIChkZXZfcHJpdi0+Y2RjbGsuaHcudmNvID09IDAgfHwK
PiAtCSAgICBkZXZfcHJpdi0+Y2RjbGsuaHcuY2RjbGsgPT0gZGV2X3ByaXYtPmNkY2xrLmh3LmJ5
cGFzcykKPiArCWlmIChpOTE1LT5jZGNsay5ody52Y28gPT0gMCB8fAo+ICsJICAgIGk5MTUtPmNk
Y2xrLmh3LmNkY2xrID09IGk5MTUtPmNkY2xrLmh3LmJ5cGFzcykKPiAgIAkJZ290byBzYW5pdGl6
ZTsKPiAgIAo+ICAgCS8qIERQTEwgb2theTsgdmVyaWZ5IHRoZSBjZGNsb2NrCj4gQEAgLTE0NTEs
MTIgKzE0NTEsMTIgQEAgc3RhdGljIHZvaWQgYnh0X3Nhbml0aXplX2NkY2xrKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAljZGN0bCAmPSB+QlhUX0NEQ0xLX0NEMlhfUElQ
RV9OT05FOwo+ICAgCj4gICAJZXhwZWN0ZWQgPSAoY2RjdGwgJiBCWFRfQ0RDTEtfQ0QyWF9ESVZf
U0VMX01BU0spIHwKPiAtCQlza2xfY2RjbGtfZGVjaW1hbChkZXZfcHJpdi0+Y2RjbGsuaHcuY2Rj
bGspOwo+ICsJCXNrbF9jZGNsa19kZWNpbWFsKGk5MTUtPmNkY2xrLmh3LmNkY2xrKTsKPiAgIAkv
Kgo+ICAgCSAqIERpc2FibGUgU1NBIFByZWNoYXJnZSB3aGVuIENEIGNsb2NrIGZyZXF1ZW5jeSA8
IDUwMCBNSHosCj4gICAJICogZW5hYmxlIG90aGVyd2lzZS4KPiAgIAkgKi8KPiAtCWlmIChkZXZf
cHJpdi0+Y2RjbGsuaHcuY2RjbGsgPj0gNTAwMDAwKQo+ICsJaWYgKGk5MTUtPmNkY2xrLmh3LmNk
Y2xrID49IDUwMDAwMCkKPiAgIAkJZXhwZWN0ZWQgfD0gQlhUX0NEQ0xLX1NTQV9QUkVDSEFSR0Vf
RU5BQkxFOwo+ICAgCj4gICAJaWYgKGNkY3RsID09IGV4cGVjdGVkKQo+IEBAIC0xNDY3LDUwICsx
NDY3LDUwIEBAIHN0YXRpYyB2b2lkIGJ4dF9zYW5pdGl6ZV9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJRFJNX0RFQlVHX0tNUygiU2FuaXRpemluZyBjZGNsayBw
cm9ncmFtbWVkIGJ5IHByZS1vc1xuIik7Cj4gICAKPiAgIAkvKiBmb3JjZSBjZGNsayBwcm9ncmFt
bWluZyAqLwo+IC0JZGV2X3ByaXYtPmNkY2xrLmh3LmNkY2xrID0gMDsKPiArCWk5MTUtPmNkY2xr
Lmh3LmNkY2xrID0gMDsKPiAgIAo+ICAgCS8qIGZvcmNlIGZ1bGwgUExMIGRpc2FibGUgKyBlbmFi
bGUgKi8KPiAtCWRldl9wcml2LT5jZGNsay5ody52Y28gPSAtMTsKPiArCWk5MTUtPmNkY2xrLmh3
LnZjbyA9IC0xOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGJ4dF9pbml0X2NkY2xrKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgYnh0X2luaXRfY2Rj
bGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RydWN0IGludGVs
X2NkY2xrX3N0YXRlIGNkY2xrX3N0YXRlOwo+ICAgCj4gLQlieHRfc2FuaXRpemVfY2RjbGsoZGV2
X3ByaXYpOwo+ICsJYnh0X3Nhbml0aXplX2NkY2xrKGk5MTUpOwo+ICAgCj4gLQlpZiAoZGV2X3By
aXYtPmNkY2xrLmh3LmNkY2xrICE9IDAgJiYKPiAtCSAgICBkZXZfcHJpdi0+Y2RjbGsuaHcudmNv
ICE9IDApCj4gKwlpZiAoaTkxNS0+Y2RjbGsuaHcuY2RjbGsgIT0gMCAmJgo+ICsJICAgIGk5MTUt
PmNkY2xrLmh3LnZjbyAhPSAwKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCWNkY2xrX3N0YXRlID0g
ZGV2X3ByaXYtPmNkY2xrLmh3Owo+ICsJY2RjbGtfc3RhdGUgPSBpOTE1LT5jZGNsay5odzsKPiAg
IAo+ICAgCS8qCj4gICAJICogRklYTUU6Cj4gICAJICogLSBUaGUgaW5pdGlhbCBDRENMSyBuZWVk
cyB0byBiZSByZWFkIGZyb20gVkJULgo+ICAgCSAqICAgTmVlZCB0byBtYWtlIHRoaXMgY2hhbmdl
IGFmdGVyIFZCVCBoYXMgY2hhbmdlcyBmb3IgQlhULgo+ICAgCSAqLwo+IC0JaWYgKElTX0dFTUlO
SUxBS0UoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfR0VNSU5JTEFLRShpOTE1KSkgewo+ICAgCQlj
ZGNsa19zdGF0ZS5jZGNsayA9IGdsa19jYWxjX2NkY2xrKDApOwo+IC0JCWNkY2xrX3N0YXRlLnZj
byA9IGdsa19kZV9wbGxfdmNvKGRldl9wcml2LCBjZGNsa19zdGF0ZS5jZGNsayk7Cj4gKwkJY2Rj
bGtfc3RhdGUudmNvID0gZ2xrX2RlX3BsbF92Y28oaTkxNSwgY2RjbGtfc3RhdGUuY2RjbGspOwo+
ICAgCX0gZWxzZSB7Cj4gICAJCWNkY2xrX3N0YXRlLmNkY2xrID0gYnh0X2NhbGNfY2RjbGsoMCk7
Cj4gLQkJY2RjbGtfc3RhdGUudmNvID0gYnh0X2RlX3BsbF92Y28oZGV2X3ByaXYsIGNkY2xrX3N0
YXRlLmNkY2xrKTsKPiArCQljZGNsa19zdGF0ZS52Y28gPSBieHRfZGVfcGxsX3ZjbyhpOTE1LCBj
ZGNsa19zdGF0ZS5jZGNsayk7Cj4gICAJfQo+ICAgCWNkY2xrX3N0YXRlLnZvbHRhZ2VfbGV2ZWwg
PSBieHRfY2FsY192b2x0YWdlX2xldmVsKGNkY2xrX3N0YXRlLmNkY2xrKTsKPiAgIAo+IC0JYnh0
X3NldF9jZGNsayhkZXZfcHJpdiwgJmNkY2xrX3N0YXRlLCBJTlZBTElEX1BJUEUpOwo+ICsJYnh0
X3NldF9jZGNsayhpOTE1LCAmY2RjbGtfc3RhdGUsIElOVkFMSURfUElQRSk7Cj4gICB9Cj4gICAK
PiAtc3RhdGljIHZvaWQgYnh0X3VuaW5pdF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGJ4dF91bmluaXRfY2RjbGsoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgY2RjbGtf
c3RhdGUgPSBkZXZfcHJpdi0+Y2RjbGsuaHc7Cj4gKwlzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUg
Y2RjbGtfc3RhdGUgPSBpOTE1LT5jZGNsay5odzsKPiAgIAo+ICAgCWNkY2xrX3N0YXRlLmNkY2xr
ID0gY2RjbGtfc3RhdGUuYnlwYXNzOwo+ICAgCWNkY2xrX3N0YXRlLnZjbyA9IDA7Cj4gICAJY2Rj
bGtfc3RhdGUudm9sdGFnZV9sZXZlbCA9IGJ4dF9jYWxjX3ZvbHRhZ2VfbGV2ZWwoY2RjbGtfc3Rh
dGUuY2RjbGspOwo+ICAgCj4gLQlieHRfc2V0X2NkY2xrKGRldl9wcml2LCAmY2RjbGtfc3RhdGUs
IElOVkFMSURfUElQRSk7Cj4gKwlieHRfc2V0X2NkY2xrKGk5MTUsICZjZGNsa19zdGF0ZSwgSU5W
QUxJRF9QSVBFKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGludCBjbmxfY2FsY19jZGNsayhpbnQg
bWluX2NkY2xrKQo+IEBAIC0xNTMzLDcgKzE1MzMsNyBAQCBzdGF0aWMgdTggY25sX2NhbGNfdm9s
dGFnZV9sZXZlbChpbnQgY2RjbGspCj4gICAJCXJldHVybiAwOwo+ICAgfQo+ICAgCj4gLXN0YXRp
YyB2b2lkIGNubF9jZGNsa19wbGxfdXBkYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiArc3RhdGljIHZvaWQgY25sX2NkY2xrX3BsbF91cGRhdGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJIHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqY2RjbGtf
c3RhdGUpCj4gICB7Cj4gICAJdTMyIHZhbDsKPiBAQCAtMTU1NSwxMyArMTU1NSwxMyBAQCBzdGF0
aWMgdm9pZCBjbmxfY2RjbGtfcGxsX3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gICAJY2RjbGtfc3RhdGUtPnZjbyA9ICh2YWwgJiBDTkxfQ0RDTEtfUExMX1JBVElP
X01BU0spICogY2RjbGtfc3RhdGUtPnJlZjsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBjbmxf
Z2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZv
aWQgY25sX2dldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSBz
dHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgKmNkY2xrX3N0YXRlKQo+ICAgewo+ICAgCXUzMiBkaXZp
ZGVyOwo+ICAgCWludCBkaXY7Cj4gICAKPiAtCWNubF9jZGNsa19wbGxfdXBkYXRlKGRldl9wcml2
LCBjZGNsa19zdGF0ZSk7Cj4gKwljbmxfY2RjbGtfcGxsX3VwZGF0ZShpOTE1LCBjZGNsa19zdGF0
ZSk7Cj4gICAKPiAgIAljZGNsa19zdGF0ZS0+Y2RjbGsgPSBjZGNsa19zdGF0ZS0+YnlwYXNzID0g
Y2RjbGtfc3RhdGUtPnJlZjsKPiAgIAo+IEBAIC0xNTkzLDcgKzE1OTMsNyBAQCBzdGF0aWMgdm9p
ZCBjbmxfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkJ
Y25sX2NhbGNfdm9sdGFnZV9sZXZlbChjZGNsa19zdGF0ZS0+Y2RjbGspOwo+ICAgfQo+ICAgCj4g
LXN0YXRpYyB2b2lkIGNubF9jZGNsa19wbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGNubF9jZGNsa19wbGxfZGlzYWJsZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAl1MzIgdmFsOwo+ICAgCj4gQEAgLTE2
MDUsMTIgKzE2MDUsMTIgQEAgc3RhdGljIHZvaWQgY25sX2NkY2xrX3BsbF9kaXNhYmxlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAlpZiAod2FpdF9mb3IoKEk5MTVfUkVB
RChCWFRfREVfUExMX0VOQUJMRSkgJiBCWFRfREVfUExMX0xPQ0spID09IDAsIDEpKQo+ICAgCQlE
Uk1fRVJST1IoInRpbWVvdXQgd2FpdGluZyBmb3IgQ0RDTEsgUExMIHVubG9ja1xuIik7Cj4gICAK
PiAtCWRldl9wcml2LT5jZGNsay5ody52Y28gPSAwOwo+ICsJaTkxNS0+Y2RjbGsuaHcudmNvID0g
MDsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBjbmxfY2RjbGtfcGxsX2VuYWJsZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCB2Y28pCj4gK3N0YXRpYyB2b2lkIGNubF9j
ZGNsa19wbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBpbnQgdmNvKQo+
ICAgewo+IC0JaW50IHJhdGlvID0gRElWX1JPVU5EX0NMT1NFU1QodmNvLCBkZXZfcHJpdi0+Y2Rj
bGsuaHcucmVmKTsKPiArCWludCByYXRpbyA9IERJVl9ST1VORF9DTE9TRVNUKHZjbywgaTkxNS0+
Y2RjbGsuaHcucmVmKTsKPiAgIAl1MzIgdmFsOwo+ICAgCj4gICAJdmFsID0gQ05MX0NEQ0xLX1BM
TF9SQVRJTyhyYXRpbyk7Cj4gQEAgLTE2MjMsMTAgKzE2MjMsMTAgQEAgc3RhdGljIHZvaWQgY25s
X2NkY2xrX3BsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQg
dmNvKQo+ICAgCWlmICh3YWl0X2ZvcigoSTkxNV9SRUFEKEJYVF9ERV9QTExfRU5BQkxFKSAmIEJY
VF9ERV9QTExfTE9DSykgIT0gMCwgMSkpCj4gICAJCURSTV9FUlJPUigidGltZW91dCB3YWl0aW5n
IGZvciBDRENMSyBQTEwgbG9ja1xuIik7Cj4gICAKPiAtCWRldl9wcml2LT5jZGNsay5ody52Y28g
PSB2Y287Cj4gKwlpOTE1LT5jZGNsay5ody52Y28gPSB2Y287Cj4gICB9Cj4gICAKPiAtc3RhdGlj
IHZvaWQgY25sX3NldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
K3N0YXRpYyB2b2lkIGNubF9zZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gICAJCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqY2RjbGtfc3RhdGUsCj4g
ICAJCQkgIGVudW0gcGlwZSBwaXBlKQo+ICAgewo+IEBAIC0xNjM1LDcgKzE2MzUsNyBAQCBzdGF0
aWMgdm9pZCBjbmxfc2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiAgIAl1MzIgdmFsLCBkaXZpZGVyOwo+ICAgCWludCByZXQ7Cj4gICAKPiAtCXJldCA9IHNrbF9w
Y29kZV9yZXF1ZXN0KGRldl9wcml2LCBTS0xfUENPREVfQ0RDTEtfQ09OVFJPTCwKPiArCXJldCA9
IHNrbF9wY29kZV9yZXF1ZXN0KGk5MTUsIFNLTF9QQ09ERV9DRENMS19DT05UUk9MLAo+ICAgCQkJ
CVNLTF9DRENMS19QUkVQQVJFX0ZPUl9DSEFOR0UsCj4gICAJCQkJU0tMX0NEQ0xLX1JFQURZX0ZP
Ul9DSEFOR0UsCj4gICAJCQkJU0tMX0NEQ0xLX1JFQURZX0ZPUl9DSEFOR0UsIDMpOwo+IEBAIC0x
NjQ4LDcgKzE2NDgsNyBAQCBzdGF0aWMgdm9pZCBjbmxfc2V0X2NkY2xrKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkvKiBjZGNsayA9IHZjbyAvIDIgLyBkaXZ7MSwyfSAq
Lwo+ICAgCXN3aXRjaCAoRElWX1JPVU5EX0NMT1NFU1QodmNvLCBjZGNsaykpIHsKPiAgIAlkZWZh
dWx0Ogo+IC0JCVdBUk5fT04oY2RjbGsgIT0gZGV2X3ByaXYtPmNkY2xrLmh3LmJ5cGFzcyk7Cj4g
KwkJV0FSTl9PTihjZGNsayAhPSBpOTE1LT5jZGNsay5ody5ieXBhc3MpOwo+ICAgCQlXQVJOX09O
KHZjbyAhPSAwKTsKPiAgIAkJLyogZmFsbCB0aHJvdWdoICovCj4gICAJY2FzZSAyOgo+IEBAIC0x
NjU5LDEyICsxNjU5LDEyIEBAIHN0YXRpYyB2b2lkIGNubF9zZXRfY2RjbGsoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCQlicmVhazsKPiAgIAl9Cj4gICAKPiAtCWlmIChk
ZXZfcHJpdi0+Y2RjbGsuaHcudmNvICE9IDAgJiYKPiAtCSAgICBkZXZfcHJpdi0+Y2RjbGsuaHcu
dmNvICE9IHZjbykKPiAtCQljbmxfY2RjbGtfcGxsX2Rpc2FibGUoZGV2X3ByaXYpOwo+ICsJaWYg
KGk5MTUtPmNkY2xrLmh3LnZjbyAhPSAwICYmCj4gKwkgICAgaTkxNS0+Y2RjbGsuaHcudmNvICE9
IHZjbykKPiArCQljbmxfY2RjbGtfcGxsX2Rpc2FibGUoaTkxNSk7Cj4gICAKPiAtCWlmIChkZXZf
cHJpdi0+Y2RjbGsuaHcudmNvICE9IHZjbykKPiAtCQljbmxfY2RjbGtfcGxsX2VuYWJsZShkZXZf
cHJpdiwgdmNvKTsKPiArCWlmIChpOTE1LT5jZGNsay5ody52Y28gIT0gdmNvKQo+ICsJCWNubF9j
ZGNsa19wbGxfZW5hYmxlKGk5MTUsIHZjbyk7Cj4gICAKPiAgIAl2YWwgPSBkaXZpZGVyIHwgc2ts
X2NkY2xrX2RlY2ltYWwoY2RjbGspOwo+ICAgCWlmIChwaXBlID09IElOVkFMSURfUElQRSkKPiBA
QCAtMTY3NCwyNiArMTY3NCwyNiBAQCBzdGF0aWMgdm9pZCBjbmxfc2V0X2NkY2xrKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlJOTE1X1dSSVRFKENEQ0xLX0NUTCwgdmFs
KTsKPiAgIAo+ICAgCWlmIChwaXBlICE9IElOVkFMSURfUElQRSkKPiAtCQlpbnRlbF93YWl0X2Zv
cl92YmxhbmsoZGV2X3ByaXYsIHBpcGUpOwo+ICsJCWludGVsX3dhaXRfZm9yX3ZibGFuayhpOTE1
LCBwaXBlKTsKPiAgIAo+ICAgCS8qIGluZm9ybSBQQ1Ugb2YgdGhlIGNoYW5nZSAqLwo+IC0Jc2Fu
ZHlicmlkZ2VfcGNvZGVfd3JpdGUoZGV2X3ByaXYsIFNLTF9QQ09ERV9DRENMS19DT05UUk9MLAo+
ICsJc2FuZHlicmlkZ2VfcGNvZGVfd3JpdGUoaTkxNSwgU0tMX1BDT0RFX0NEQ0xLX0NPTlRST0ws
Cj4gICAJCQkJY2RjbGtfc3RhdGUtPnZvbHRhZ2VfbGV2ZWwpOwo+ICAgCj4gLQlpbnRlbF91cGRh
dGVfY2RjbGsoZGV2X3ByaXYpOwo+ICsJaW50ZWxfdXBkYXRlX2NkY2xrKGk5MTUpOwo+ICAgCj4g
ICAJLyoKPiAgIAkgKiBDYW4ndCByZWFkIG91dCB0aGUgdm9sdGFnZSBsZXZlbCA6KAo+ICAgCSAq
IExldCdzIGp1c3QgYXNzdW1lIGV2ZXJ5dGhpbmcgaXMgYXMgZXhwZWN0ZWQuCj4gICAJICovCj4g
LQlkZXZfcHJpdi0+Y2RjbGsuaHcudm9sdGFnZV9sZXZlbCA9IGNkY2xrX3N0YXRlLT52b2x0YWdl
X2xldmVsOwo+ICsJaTkxNS0+Y2RjbGsuaHcudm9sdGFnZV9sZXZlbCA9IGNkY2xrX3N0YXRlLT52
b2x0YWdlX2xldmVsOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBpbnQgY25sX2NkY2xrX3BsbF92Y28o
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgY2RjbGspCj4gK3N0YXRpYyBp
bnQgY25sX2NkY2xrX3BsbF92Y28oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGludCBj
ZGNsaykKPiAgIHsKPiAgIAlpbnQgcmF0aW87Cj4gICAKPiAtCWlmIChjZGNsayA9PSBkZXZfcHJp
di0+Y2RjbGsuaHcuYnlwYXNzKQo+ICsJaWYgKGNkY2xrID09IGk5MTUtPmNkY2xrLmh3LmJ5cGFz
cykKPiAgIAkJcmV0dXJuIDA7Cj4gICAKPiAgIAlzd2l0Y2ggKGNkY2xrKSB7Cj4gQEAgLTE3MDIs
MjUgKzE3MDIsMjUgQEAgc3RhdGljIGludCBjbmxfY2RjbGtfcGxsX3ZjbyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCBjZGNsaykKPiAgIAkJLyogZmFsbCB0aHJvdWdoICov
Cj4gICAJY2FzZSAxNjgwMDA6Cj4gICAJY2FzZSAzMzYwMDA6Cj4gLQkJcmF0aW8gPSBkZXZfcHJp
di0+Y2RjbGsuaHcucmVmID09IDE5MjAwID8gMzUgOiAyODsKPiArCQlyYXRpbyA9IGk5MTUtPmNk
Y2xrLmh3LnJlZiA9PSAxOTIwMCA/IDM1IDogMjg7Cj4gICAJCWJyZWFrOwo+ICAgCWNhc2UgNTI4
MDAwOgo+IC0JCXJhdGlvID0gZGV2X3ByaXYtPmNkY2xrLmh3LnJlZiA9PSAxOTIwMCA/IDU1IDog
NDQ7Cj4gKwkJcmF0aW8gPSBpOTE1LT5jZGNsay5ody5yZWYgPT0gMTkyMDAgPyA1NSA6IDQ0Owo+
ICAgCQlicmVhazsKPiAgIAl9Cj4gICAKPiAtCXJldHVybiBkZXZfcHJpdi0+Y2RjbGsuaHcucmVm
ICogcmF0aW87Cj4gKwlyZXR1cm4gaTkxNS0+Y2RjbGsuaHcucmVmICogcmF0aW87Cj4gICB9Cj4g
ICAKPiAtc3RhdGljIHZvaWQgY25sX3Nhbml0aXplX2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgY25sX3Nhbml0aXplX2NkY2xrKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUzMiBjZGN0bCwgZXhwZWN0ZWQ7Cj4g
ICAKPiAtCWludGVsX3VwZGF0ZV9jZGNsayhkZXZfcHJpdik7Cj4gLQlpbnRlbF9kdW1wX2NkY2xr
X3N0YXRlKCZkZXZfcHJpdi0+Y2RjbGsuaHcsICJDdXJyZW50IENEQ0xLIik7Cj4gKwlpbnRlbF91
cGRhdGVfY2RjbGsoaTkxNSk7Cj4gKwlpbnRlbF9kdW1wX2NkY2xrX3N0YXRlKCZpOTE1LT5jZGNs
ay5odywgIkN1cnJlbnQgQ0RDTEsiKTsKPiAgIAo+IC0JaWYgKGRldl9wcml2LT5jZGNsay5ody52
Y28gPT0gMCB8fAo+IC0JICAgIGRldl9wcml2LT5jZGNsay5ody5jZGNsayA9PSBkZXZfcHJpdi0+
Y2RjbGsuaHcuYnlwYXNzKQo+ICsJaWYgKGk5MTUtPmNkY2xrLmh3LnZjbyA9PSAwIHx8Cj4gKwkg
ICAgaTkxNS0+Y2RjbGsuaHcuY2RjbGsgPT0gaTkxNS0+Y2RjbGsuaHcuYnlwYXNzKQo+ICAgCQln
b3RvIHNhbml0aXplOwo+ICAgCj4gICAJLyogRFBMTCBva2F5OyB2ZXJpZnkgdGhlIGNkY2xvY2sK
PiBAQCAtMTczOCw3ICsxNzM4LDcgQEAgc3RhdGljIHZvaWQgY25sX3Nhbml0aXplX2NkY2xrKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAljZGN0bCAmPSB+QlhUX0NEQ0xL
X0NEMlhfUElQRV9OT05FOwo+ICAgCj4gICAJZXhwZWN0ZWQgPSAoY2RjdGwgJiBCWFRfQ0RDTEtf
Q0QyWF9ESVZfU0VMX01BU0spIHwKPiAtCQkgICBza2xfY2RjbGtfZGVjaW1hbChkZXZfcHJpdi0+
Y2RjbGsuaHcuY2RjbGspOwo+ICsJCSAgIHNrbF9jZGNsa19kZWNpbWFsKGk5MTUtPmNkY2xrLmh3
LmNkY2xrKTsKPiAgIAo+ICAgCWlmIChjZGN0bCA9PSBleHBlY3RlZCkKPiAgIAkJLyogQWxsIHdl
bGw7IG5vdGhpbmcgdG8gc2FuaXRpemUgKi8KPiBAQCAtMTc0OCwxMCArMTc0OCwxMCBAQCBzdGF0
aWMgdm9pZCBjbmxfc2FuaXRpemVfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICAgCURSTV9ERUJVR19LTVMoIlNhbml0aXppbmcgY2RjbGsgcHJvZ3JhbW1lZCBieSBw
cmUtb3NcbiIpOwo+ICAgCj4gICAJLyogZm9yY2UgY2RjbGsgcHJvZ3JhbW1pbmcgKi8KPiAtCWRl
dl9wcml2LT5jZGNsay5ody5jZGNsayA9IDA7Cj4gKwlpOTE1LT5jZGNsay5ody5jZGNsayA9IDA7
Cj4gICAKPiAgIAkvKiBmb3JjZSBmdWxsIFBMTCBkaXNhYmxlICsgZW5hYmxlICovCj4gLQlkZXZf
cHJpdi0+Y2RjbGsuaHcudmNvID0gLTE7Cj4gKwlpOTE1LT5jZGNsay5ody52Y28gPSAtMTsKPiAg
IH0KPiAgIAo+ICAgc3RhdGljIGludCBpY2xfY2FsY19jZGNsayhpbnQgbWluX2NkY2xrLCB1bnNp
Z25lZCBpbnQgcmVmKQo+IEBAIC0xNzgxLDExICsxNzgxLDExIEBAIHN0YXRpYyBpbnQgaWNsX2Nh
bGNfY2RjbGsoaW50IG1pbl9jZGNsaywgdW5zaWduZWQgaW50IHJlZikKPiAgIAkJcmV0dXJuIHJh
bmdlc1swXTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgaW50IGljbF9jYWxjX2NkY2xrX3BsbF92Y28o
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgY2RjbGspCj4gK3N0YXRpYyBp
bnQgaWNsX2NhbGNfY2RjbGtfcGxsX3ZjbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwg
aW50IGNkY2xrKQo+ICAgewo+ICAgCWludCByYXRpbzsKPiAgIAo+IC0JaWYgKGNkY2xrID09IGRl
dl9wcml2LT5jZGNsay5ody5ieXBhc3MpCj4gKwlpZiAoY2RjbGsgPT0gaTkxNS0+Y2RjbGsuaHcu
YnlwYXNzKQo+ICAgCQlyZXR1cm4gMDsKPiAgIAo+ICAgCXN3aXRjaCAoY2RjbGspIHsKPiBAQCAt
MTc5NSwyMSArMTc5NSwyMSBAQCBzdGF0aWMgaW50IGljbF9jYWxjX2NkY2xrX3BsbF92Y28oc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgY2RjbGspCj4gICAJY2FzZSAzMDcy
MDA6Cj4gICAJY2FzZSA1NTY4MDA6Cj4gICAJY2FzZSA2NTI4MDA6Cj4gLQkJV0FSTl9PTihkZXZf
cHJpdi0+Y2RjbGsuaHcucmVmICE9IDE5MjAwICYmCj4gLQkJCWRldl9wcml2LT5jZGNsay5ody5y
ZWYgIT0gMzg0MDApOwo+ICsJCVdBUk5fT04oaTkxNS0+Y2RjbGsuaHcucmVmICE9IDE5MjAwICYm
Cj4gKwkJCWk5MTUtPmNkY2xrLmh3LnJlZiAhPSAzODQwMCk7Cj4gICAJCWJyZWFrOwo+ICAgCWNh
c2UgMzEyMDAwOgo+ICAgCWNhc2UgNTUyMDAwOgo+ICAgCWNhc2UgNjQ4MDAwOgo+IC0JCVdBUk5f
T04oZGV2X3ByaXYtPmNkY2xrLmh3LnJlZiAhPSAyNDAwMCk7Cj4gKwkJV0FSTl9PTihpOTE1LT5j
ZGNsay5ody5yZWYgIT0gMjQwMDApOwo+ICAgCX0KPiAgIAo+IC0JcmF0aW8gPSBjZGNsayAvIChk
ZXZfcHJpdi0+Y2RjbGsuaHcucmVmIC8gMik7Cj4gKwlyYXRpbyA9IGNkY2xrIC8gKGk5MTUtPmNk
Y2xrLmh3LnJlZiAvIDIpOwo+ICAgCj4gLQlyZXR1cm4gZGV2X3ByaXYtPmNkY2xrLmh3LnJlZiAq
IHJhdGlvOwo+ICsJcmV0dXJuIGk5MTUtPmNkY2xrLmh3LnJlZiAqIHJhdGlvOwo+ICAgfQo+ICAg
Cj4gLXN0YXRpYyB2b2lkIGljbF9zZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ICtzdGF0aWMgdm9pZCBpY2xfc2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAo+ICAgCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgKmNkY2xr
X3N0YXRlLAo+ICAgCQkJICBlbnVtIHBpcGUgcGlwZSkKPiAgIHsKPiBAQCAtMTgxNyw3ICsxODE3
LDcgQEAgc3RhdGljIHZvaWQgaWNsX3NldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gICAJdW5zaWduZWQgaW50IHZjbyA9IGNkY2xrX3N0YXRlLT52Y287Cj4gICAJ
aW50IHJldDsKPiAgIAo+IC0JcmV0ID0gc2tsX3Bjb2RlX3JlcXVlc3QoZGV2X3ByaXYsIFNLTF9Q
Q09ERV9DRENMS19DT05UUk9MLAo+ICsJcmV0ID0gc2tsX3Bjb2RlX3JlcXVlc3QoaTkxNSwgU0tM
X1BDT0RFX0NEQ0xLX0NPTlRST0wsCj4gICAJCQkJU0tMX0NEQ0xLX1BSRVBBUkVfRk9SX0NIQU5H
RSwKPiAgIAkJCQlTS0xfQ0RDTEtfUkVBRFlfRk9SX0NIQU5HRSwKPiAgIAkJCQlTS0xfQ0RDTEtf
UkVBRFlfRk9SX0NIQU5HRSwgMyk7Cj4gQEAgLTE4MjcsMTIgKzE4MjcsMTIgQEAgc3RhdGljIHZv
aWQgaWNsX3NldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJ
CXJldHVybjsKPiAgIAl9Cj4gICAKPiAtCWlmIChkZXZfcHJpdi0+Y2RjbGsuaHcudmNvICE9IDAg
JiYKPiAtCSAgICBkZXZfcHJpdi0+Y2RjbGsuaHcudmNvICE9IHZjbykKPiAtCQljbmxfY2RjbGtf
cGxsX2Rpc2FibGUoZGV2X3ByaXYpOwo+ICsJaWYgKGk5MTUtPmNkY2xrLmh3LnZjbyAhPSAwICYm
Cj4gKwkgICAgaTkxNS0+Y2RjbGsuaHcudmNvICE9IHZjbykKPiArCQljbmxfY2RjbGtfcGxsX2Rp
c2FibGUoaTkxNSk7Cj4gICAKPiAtCWlmIChkZXZfcHJpdi0+Y2RjbGsuaHcudmNvICE9IHZjbykK
PiAtCQljbmxfY2RjbGtfcGxsX2VuYWJsZShkZXZfcHJpdiwgdmNvKTsKPiArCWlmIChpOTE1LT5j
ZGNsay5ody52Y28gIT0gdmNvKQo+ICsJCWNubF9jZGNsa19wbGxfZW5hYmxlKGk5MTUsIHZjbyk7
Cj4gICAKPiAgIAkvKgo+ICAgCSAqIE9uIElDTCBDRDJYX0RJViBjYW4gb25seSBiZSAxLCBzbyB3
ZSdsbCBuZXZlciBlbmQgdXAgY2hhbmdpbmcgdGhlCj4gQEAgLTE4NDIsMTYgKzE4NDIsMTYgQEAg
c3RhdGljIHZvaWQgaWNsX3NldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gICAJSTkxNV9XUklURShDRENMS19DVEwsIElDTF9DRENMS19DRDJYX1BJUEVfTk9ORSB8
Cj4gICAJCQkgICAgICBza2xfY2RjbGtfZGVjaW1hbChjZGNsaykpOwo+ICAgCj4gLQlzYW5keWJy
aWRnZV9wY29kZV93cml0ZShkZXZfcHJpdiwgU0tMX1BDT0RFX0NEQ0xLX0NPTlRST0wsCj4gKwlz
YW5keWJyaWRnZV9wY29kZV93cml0ZShpOTE1LCBTS0xfUENPREVfQ0RDTEtfQ09OVFJPTCwKPiAg
IAkJCQljZGNsa19zdGF0ZS0+dm9sdGFnZV9sZXZlbCk7Cj4gICAKPiAtCWludGVsX3VwZGF0ZV9j
ZGNsayhkZXZfcHJpdik7Cj4gKwlpbnRlbF91cGRhdGVfY2RjbGsoaTkxNSk7Cj4gICAKPiAgIAkv
Kgo+ICAgCSAqIENhbid0IHJlYWQgb3V0IHRoZSB2b2x0YWdlIGxldmVsIDooCj4gICAJICogTGV0
J3MganVzdCBhc3N1bWUgZXZlcnl0aGluZyBpcyBhcyBleHBlY3RlZC4KPiAgIAkgKi8KPiAtCWRl
dl9wcml2LT5jZGNsay5ody52b2x0YWdlX2xldmVsID0gY2RjbGtfc3RhdGUtPnZvbHRhZ2VfbGV2
ZWw7Cj4gKwlpOTE1LT5jZGNsay5ody52b2x0YWdlX2xldmVsID0gY2RjbGtfc3RhdGUtPnZvbHRh
Z2VfbGV2ZWw7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB1OCBpY2xfY2FsY192b2x0YWdlX2xldmVs
KGludCBjZGNsaykKPiBAQCAtMTg2NCw3ICsxODY0LDcgQEAgc3RhdGljIHU4IGljbF9jYWxjX3Zv
bHRhZ2VfbGV2ZWwoaW50IGNkY2xrKQo+ICAgCQlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+IC1zdGF0
aWMgdm9pZCBpY2xfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiArc3RhdGljIHZvaWQgaWNsX2dldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiAgIAkJCSAgc3RydWN0IGludGVsX2NkY2xrX3N0YXRlICpjZGNsa19zdGF0ZSkKPiAgIHsK
PiAgIAl1MzIgdmFsOwo+IEBAIC0xOTE1LDE3ICsxOTE1LDE3IEBAIHN0YXRpYyB2b2lkIGljbF9n
ZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCQlpY2xfY2Fs
Y192b2x0YWdlX2xldmVsKGNkY2xrX3N0YXRlLT5jZGNsayk7Cj4gICB9Cj4gICAKPiAtc3RhdGlj
IHZvaWQgaWNsX2luaXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ICtzdGF0aWMgdm9pZCBpY2xfaW5pdF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgc2FuaXRpemVkX3N0YXRlOwo+
ICAgCXUzMiB2YWw7Cj4gICAKPiAtCS8qIFRoaXMgc2V0cyBkZXZfcHJpdi0+Y2RjbGsuaHcuICov
Cj4gLQlpbnRlbF91cGRhdGVfY2RjbGsoZGV2X3ByaXYpOwo+IC0JaW50ZWxfZHVtcF9jZGNsa19z
dGF0ZSgmZGV2X3ByaXYtPmNkY2xrLmh3LCAiQ3VycmVudCBDRENMSyIpOwo+ICsJLyogVGhpcyBz
ZXRzIGk5MTUtPmNkY2xrLmh3LiAqLwo+ICsJaW50ZWxfdXBkYXRlX2NkY2xrKGk5MTUpOwo+ICsJ
aW50ZWxfZHVtcF9jZGNsa19zdGF0ZSgmaTkxNS0+Y2RjbGsuaHcsICJDdXJyZW50IENEQ0xLIik7
Cj4gICAKPiAgIAkvKiBUaGlzIG1lYW5zIENEQ0xLIGRpc2FibGVkLiAqLwo+IC0JaWYgKGRldl9w
cml2LT5jZGNsay5ody5jZGNsayA9PSBkZXZfcHJpdi0+Y2RjbGsuaHcuYnlwYXNzKQo+ICsJaWYg
KGk5MTUtPmNkY2xrLmh3LmNkY2xrID09IGk5MTUtPmNkY2xrLmh3LmJ5cGFzcykKPiAgIAkJZ290
byBzYW5pdGl6ZTsKPiAgIAo+ICAgCXZhbCA9IEk5MTVfUkVBRChDRENMS19DVEwpOwo+IEBAIC0x
OTM0LDcgKzE5MzQsNyBAQCBzdGF0aWMgdm9pZCBpY2xfaW5pdF9jZGNsayhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCWdvdG8gc2FuaXRpemU7Cj4gICAKPiAgIAlpZiAo
KHZhbCAmIENEQ0xLX0ZSRVFfREVDSU1BTF9NQVNLKSAhPQo+IC0JICAgIHNrbF9jZGNsa19kZWNp
bWFsKGRldl9wcml2LT5jZGNsay5ody5jZGNsaykpCj4gKwkgICAgc2tsX2NkY2xrX2RlY2ltYWwo
aTkxNS0+Y2RjbGsuaHcuY2RjbGspKQo+ICAgCQlnb3RvIHNhbml0aXplOwo+ICAgCj4gICAJcmV0
dXJuOwo+IEBAIC0xOTQyLDYyICsxOTQyLDYyIEBAIHN0YXRpYyB2b2lkIGljbF9pbml0X2NkY2xr
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIHNhbml0aXplOgo+ICAgCURS
TV9ERUJVR19LTVMoIlNhbml0aXppbmcgY2RjbGsgcHJvZ3JhbW1lZCBieSBwcmUtb3NcbiIpOwo+
ICAgCj4gLQlzYW5pdGl6ZWRfc3RhdGUucmVmID0gZGV2X3ByaXYtPmNkY2xrLmh3LnJlZjsKPiAr
CXNhbml0aXplZF9zdGF0ZS5yZWYgPSBpOTE1LT5jZGNsay5ody5yZWY7Cj4gICAJc2FuaXRpemVk
X3N0YXRlLmNkY2xrID0gaWNsX2NhbGNfY2RjbGsoMCwgc2FuaXRpemVkX3N0YXRlLnJlZik7Cj4g
LQlzYW5pdGl6ZWRfc3RhdGUudmNvID0gaWNsX2NhbGNfY2RjbGtfcGxsX3ZjbyhkZXZfcHJpdiwK
PiArCXNhbml0aXplZF9zdGF0ZS52Y28gPSBpY2xfY2FsY19jZGNsa19wbGxfdmNvKGk5MTUsCj4g
ICAJCQkJCQkgICAgIHNhbml0aXplZF9zdGF0ZS5jZGNsayk7Cj4gICAJc2FuaXRpemVkX3N0YXRl
LnZvbHRhZ2VfbGV2ZWwgPQo+ICAgCQkJCWljbF9jYWxjX3ZvbHRhZ2VfbGV2ZWwoc2FuaXRpemVk
X3N0YXRlLmNkY2xrKTsKPiAgIAo+IC0JaWNsX3NldF9jZGNsayhkZXZfcHJpdiwgJnNhbml0aXpl
ZF9zdGF0ZSwgSU5WQUxJRF9QSVBFKTsKPiArCWljbF9zZXRfY2RjbGsoaTkxNSwgJnNhbml0aXpl
ZF9zdGF0ZSwgSU5WQUxJRF9QSVBFKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpY2xfdW5p
bml0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZv
aWQgaWNsX3VuaW5pdF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsK
PiAtCXN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSBjZGNsa19zdGF0ZSA9IGRldl9wcml2LT5jZGNs
ay5odzsKPiArCXN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSBjZGNsa19zdGF0ZSA9IGk5MTUtPmNk
Y2xrLmh3Owo+ICAgCj4gICAJY2RjbGtfc3RhdGUuY2RjbGsgPSBjZGNsa19zdGF0ZS5ieXBhc3M7
Cj4gICAJY2RjbGtfc3RhdGUudmNvID0gMDsKPiAgIAljZGNsa19zdGF0ZS52b2x0YWdlX2xldmVs
ID0gaWNsX2NhbGNfdm9sdGFnZV9sZXZlbChjZGNsa19zdGF0ZS5jZGNsayk7Cj4gICAKPiAtCWlj
bF9zZXRfY2RjbGsoZGV2X3ByaXYsICZjZGNsa19zdGF0ZSwgSU5WQUxJRF9QSVBFKTsKPiArCWlj
bF9zZXRfY2RjbGsoaTkxNSwgJmNkY2xrX3N0YXRlLCBJTlZBTElEX1BJUEUpOwo+ICAgfQo+ICAg
Cj4gLXN0YXRpYyB2b2lkIGNubF9pbml0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiArc3RhdGljIHZvaWQgY25sX2luaXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2NkY2xrX3N0YXRlIGNkY2xrX3N0
YXRlOwo+ICAgCj4gLQljbmxfc2FuaXRpemVfY2RjbGsoZGV2X3ByaXYpOwo+ICsJY25sX3Nhbml0
aXplX2NkY2xrKGk5MTUpOwo+ICAgCj4gLQlpZiAoZGV2X3ByaXYtPmNkY2xrLmh3LmNkY2xrICE9
IDAgJiYKPiAtCSAgICBkZXZfcHJpdi0+Y2RjbGsuaHcudmNvICE9IDApCj4gKwlpZiAoaTkxNS0+
Y2RjbGsuaHcuY2RjbGsgIT0gMCAmJgo+ICsJICAgIGk5MTUtPmNkY2xrLmh3LnZjbyAhPSAwKQo+
ICAgCQlyZXR1cm47Cj4gICAKPiAtCWNkY2xrX3N0YXRlID0gZGV2X3ByaXYtPmNkY2xrLmh3Owo+
ICsJY2RjbGtfc3RhdGUgPSBpOTE1LT5jZGNsay5odzsKPiAgIAo+ICAgCWNkY2xrX3N0YXRlLmNk
Y2xrID0gY25sX2NhbGNfY2RjbGsoMCk7Cj4gLQljZGNsa19zdGF0ZS52Y28gPSBjbmxfY2RjbGtf
cGxsX3ZjbyhkZXZfcHJpdiwgY2RjbGtfc3RhdGUuY2RjbGspOwo+ICsJY2RjbGtfc3RhdGUudmNv
ID0gY25sX2NkY2xrX3BsbF92Y28oaTkxNSwgY2RjbGtfc3RhdGUuY2RjbGspOwo+ICAgCWNkY2xr
X3N0YXRlLnZvbHRhZ2VfbGV2ZWwgPSBjbmxfY2FsY192b2x0YWdlX2xldmVsKGNkY2xrX3N0YXRl
LmNkY2xrKTsKPiAgIAo+IC0JY25sX3NldF9jZGNsayhkZXZfcHJpdiwgJmNkY2xrX3N0YXRlLCBJ
TlZBTElEX1BJUEUpOwo+ICsJY25sX3NldF9jZGNsayhpOTE1LCAmY2RjbGtfc3RhdGUsIElOVkFM
SURfUElQRSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgY25sX3VuaW5pdF9jZGNsayhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGNubF91bmluaXRf
Y2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50
ZWxfY2RjbGtfc3RhdGUgY2RjbGtfc3RhdGUgPSBkZXZfcHJpdi0+Y2RjbGsuaHc7Cj4gKwlzdHJ1
Y3QgaW50ZWxfY2RjbGtfc3RhdGUgY2RjbGtfc3RhdGUgPSBpOTE1LT5jZGNsay5odzsKPiAgIAo+
ICAgCWNkY2xrX3N0YXRlLmNkY2xrID0gY2RjbGtfc3RhdGUuYnlwYXNzOwo+ICAgCWNkY2xrX3N0
YXRlLnZjbyA9IDA7Cj4gICAJY2RjbGtfc3RhdGUudm9sdGFnZV9sZXZlbCA9IGNubF9jYWxjX3Zv
bHRhZ2VfbGV2ZWwoY2RjbGtfc3RhdGUuY2RjbGspOwo+ICAgCj4gLQljbmxfc2V0X2NkY2xrKGRl
dl9wcml2LCAmY2RjbGtfc3RhdGUsIElOVkFMSURfUElQRSk7Cj4gKwljbmxfc2V0X2NkY2xrKGk5
MTUsICZjZGNsa19zdGF0ZSwgSU5WQUxJRF9QSVBFKTsKPiAgIH0KPiAgIAo+ICAgLyoqCj4gICAg
KiBpbnRlbF9jZGNsa19pbml0IC0gSW5pdGlhbGl6ZSBDRENMSwo+ICAgICogQGk5MTU6IGk5MTUg
ZGV2aWNlCj4gICAgKgo+IC0gKiBJbml0aWFsaXplIENEQ0xLLiBUaGlzIGNvbnNpc3RzIG1haW5s
eSBvZiBpbml0aWFsaXppbmcgZGV2X3ByaXYtPmNkY2xrLmh3IGFuZAo+ICsgKiBJbml0aWFsaXpl
IENEQ0xLLiBUaGlzIGNvbnNpc3RzIG1haW5seSBvZiBpbml0aWFsaXppbmcgaTkxNS0+Y2RjbGsu
aHcgYW5kCj4gICAgKiBzYW5pdGl6aW5nIHRoZSBzdGF0ZSBvZiB0aGUgaGFyZHdhcmUgaWYgbmVl
ZGVkLiBUaGlzIGlzIGdlbmVyYWxseSBkb25lIG9ubHkKPiAgICAqIGR1cmluZyB0aGUgZGlzcGxh
eSBjb3JlIGluaXRpYWxpemF0aW9uIHNlcXVlbmNlLCBhZnRlciB3aGljaCB0aGUgRE1DIHdpbGwK
PiAgICAqIHRha2UgY2FyZSBvZiB0dXJuaW5nIENEQ0xLIG9mZi9vbiBhcyBuZWVkZWQuCj4gQEAg
LTIwNTEsMTkgKzIwNTEsMTkgQEAgYm9vbCBpbnRlbF9jZGNsa19uZWVkc19tb2Rlc2V0KGNvbnN0
IHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqYSwKPiAgIAo+ICAgLyoqCj4gICAgKiBpbnRlbF9j
ZGNsa19uZWVkc19jZDJ4X3VwZGF0ZSAtIERldGVybWluZSBpZiB0d28gQ0RDTEsgc3RhdGVzIHJl
cXVpcmUgYSBjZDJ4IGRpdmlkZXIgdXBkYXRlCj4gLSAqIEBkZXZfcHJpdjogTm90IGEgQ0RDTEsg
c3RhdGUsIGl0J3MgdGhlIGRybV9pOTE1X3ByaXZhdGUhCj4gKyAqIEBpOTE1OiBOb3QgYSBDRENM
SyBzdGF0ZSwgaXQncyB0aGUgZHJtX2k5MTVfcHJpdmF0ZSEKPiAgICAqIEBhOiBmaXJzdCBDRENM
SyBzdGF0ZQo+ICAgICogQGI6IHNlY29uZCBDRENMSyBzdGF0ZQo+ICAgICoKPiAgICAqIFJldHVy
bnM6Cj4gICAgKiBUcnVlIGlmIHRoZSBDRENMSyBzdGF0ZXMgcmVxdWlyZSBqdXN0IGEgY2QyeCBk
aXZpZGVyIHVwZGF0ZSwgZmFsc2UgaWYgbm90Lgo+ICAgICovCj4gLWJvb2wgaW50ZWxfY2RjbGtf
bmVlZHNfY2QyeF91cGRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICti
b29sIGludGVsX2NkY2xrX25lZWRzX2NkMnhfdXBkYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAo+ICAgCQkJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqYSwKPiAg
IAkJCQkgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgKmIpCj4gICB7Cj4gICAJLyog
T2xkZXIgaHcgZG9lc24ndCBoYXZlIHRoZSBjYXBhYmlsaXR5ICovCj4gLQlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA8IDEwICYmICFJU19HRU45X0xQKGRldl9wcml2KSkKPiArCWlmIChJTlRFTF9H
RU4oaTkxNSkgPCAxMCAmJiAhSVNfR0VOOV9MUChpOTE1KSkKPiAgIAkJcmV0dXJuIGZhbHNlOwo+
ICAgCj4gICAJcmV0dXJuIGEtPmNkY2xrICE9IGItPmNkY2xrICYmCj4gQEAgLTIxMDAsMTAgKzIx
MDAsMTAgQEAgYm9vbCBpbnRlbF9jZGNsa19jaGFuZ2VkKGNvbnN0IHN0cnVjdCBpbnRlbF9jZGNs
a19zdGF0ZSAqYSwKPiAgICAqLwo+ICAgdm9pZCBpbnRlbF9jZGNsa19zd2FwX3N0YXRlKHN0cnVj
dCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShzdGF0ZS0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KHN0YXRlLT5iYXNlLmRldik7Cj4gICAKPiAt
CXN3YXAoc3RhdGUtPmNkY2xrLmxvZ2ljYWwsIGRldl9wcml2LT5jZGNsay5sb2dpY2FsKTsKPiAt
CXN3YXAoc3RhdGUtPmNkY2xrLmFjdHVhbCwgZGV2X3ByaXYtPmNkY2xrLmFjdHVhbCk7Cj4gKwlz
d2FwKHN0YXRlLT5jZGNsay5sb2dpY2FsLCBpOTE1LT5jZGNsay5sb2dpY2FsKTsKPiArCXN3YXAo
c3RhdGUtPmNkY2xrLmFjdHVhbCwgaTkxNS0+Y2RjbGsuYWN0dWFsKTsKPiAgIH0KPiAgIAo+ICAg
dm9pZCBpbnRlbF9kdW1wX2NkY2xrX3N0YXRlKGNvbnN0IHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0
ZSAqY2RjbGtfc3RhdGUsCj4gQEAgLTIxMTcsMzcgKzIxMTcsMzcgQEAgdm9pZCBpbnRlbF9kdW1w
X2NkY2xrX3N0YXRlKGNvbnN0IHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqY2RjbGtfc3RhdGUs
Cj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxfc2V0X2NkY2xrIC0gUHVzaCB0aGUgQ0RDTEsgc3Rh
dGUgdG8gdGhlIGhhcmR3YXJlCj4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UKPiArICogQGk5
MTU6IGk5MTUgZGV2aWNlCj4gICAgKiBAY2RjbGtfc3RhdGU6IG5ldyBDRENMSyBzdGF0ZQo+ICAg
ICogQHBpcGU6IHBpcGUgd2l0aCB3aGljaCB0byBzeW5jaHJvbml6ZSB0aGUgdXBkYXRlCj4gICAg
Kgo+ICAgICogUHJvZ3JhbSB0aGUgaGFyZHdhcmUgYmFzZWQgb24gdGhlIHBhc3NlZCBpbiBDRENM
SyBzdGF0ZSwKPiAgICAqIGlmIG5lY2Vzc2FyeS4KPiAgICAqLwo+IC1zdGF0aWMgdm9pZCBpbnRl
bF9zZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMg
dm9pZCBpbnRlbF9zZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJ
CQkgICAgY29uc3Qgc3RydWN0IGludGVsX2NkY2xrX3N0YXRlICpjZGNsa19zdGF0ZSwKPiAgIAkJ
CSAgICBlbnVtIHBpcGUgcGlwZSkKPiAgIHsKPiAtCWlmICghaW50ZWxfY2RjbGtfY2hhbmdlZCgm
ZGV2X3ByaXYtPmNkY2xrLmh3LCBjZGNsa19zdGF0ZSkpCj4gKwlpZiAoIWludGVsX2NkY2xrX2No
YW5nZWQoJmk5MTUtPmNkY2xrLmh3LCBjZGNsa19zdGF0ZSkpCj4gICAJCXJldHVybjsKPiAgIAo+
IC0JaWYgKFdBUk5fT05fT05DRSghZGV2X3ByaXYtPmRpc3BsYXkuc2V0X2NkY2xrKSkKPiArCWlm
IChXQVJOX09OX09OQ0UoIWk5MTUtPmRpc3BsYXkuc2V0X2NkY2xrKSkKPiAgIAkJcmV0dXJuOwo+
ICAgCj4gICAJaW50ZWxfZHVtcF9jZGNsa19zdGF0ZShjZGNsa19zdGF0ZSwgIkNoYW5naW5nIENE
Q0xLIHRvIik7Cj4gICAKPiAtCWRldl9wcml2LT5kaXNwbGF5LnNldF9jZGNsayhkZXZfcHJpdiwg
Y2RjbGtfc3RhdGUsIHBpcGUpOwo+ICsJaTkxNS0+ZGlzcGxheS5zZXRfY2RjbGsoaTkxNSwgY2Rj
bGtfc3RhdGUsIHBpcGUpOwo+ICAgCj4gLQlpZiAoV0FSTihpbnRlbF9jZGNsa19jaGFuZ2VkKCZk
ZXZfcHJpdi0+Y2RjbGsuaHcsIGNkY2xrX3N0YXRlKSwKPiArCWlmIChXQVJOKGludGVsX2NkY2xr
X2NoYW5nZWQoJmk5MTUtPmNkY2xrLmh3LCBjZGNsa19zdGF0ZSksCj4gICAJCSAiY2RjbGsgc3Rh
dGUgZG9lc24ndCBtYXRjaCFcbiIpKSB7Cj4gLQkJaW50ZWxfZHVtcF9jZGNsa19zdGF0ZSgmZGV2
X3ByaXYtPmNkY2xrLmh3LCAiW2h3IHN0YXRlXSIpOwo+ICsJCWludGVsX2R1bXBfY2RjbGtfc3Rh
dGUoJmk5MTUtPmNkY2xrLmh3LCAiW2h3IHN0YXRlXSIpOwo+ICAgCQlpbnRlbF9kdW1wX2NkY2xr
X3N0YXRlKGNkY2xrX3N0YXRlLCAiW3N3IHN0YXRlXSIpOwo+ICAgCX0KPiAgIH0KPiAgIAo+ICAg
LyoqCj4gICAgKiBpbnRlbF9zZXRfY2RjbGtfcHJlX3BsYW5lX3VwZGF0ZSAtIFB1c2ggdGhlIENE
Q0xLIHN0YXRlIHRvIHRoZSBoYXJkd2FyZQo+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlCj4g
KyAqIEBpOTE1OiBpOTE1IGRldmljZQo+ICAgICogQG9sZF9zdGF0ZTogb2xkIENEQ0xLIHN0YXRl
Cj4gICAgKiBAbmV3X3N0YXRlOiBuZXcgQ0RDTEsgc3RhdGUKPiAgICAqIEBwaXBlOiBwaXBlIHdp
dGggd2hpY2ggdG8gc3luY2hyb25pemUgdGhlIHVwZGF0ZQo+IEBAIC0yMTU2LDE4ICsyMTU2LDE4
IEBAIHN0YXRpYyB2b2lkIGludGVsX3NldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gICAgKiBpbiBDRENMSyBzdGF0ZSwgaWYgbmVjZXNzYXJ5Lgo+ICAgICovCj4g
ICB2b2lkCj4gLWludGVsX3NldF9jZGNsa19wcmVfcGxhbmVfdXBkYXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiAraW50ZWxfc2V0X2NkY2xrX3ByZV9wbGFuZV91cGRhdGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJIGNvbnN0IHN0cnVjdCBpbnRl
bF9jZGNsa19zdGF0ZSAqb2xkX3N0YXRlLAo+ICAgCQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfY2Rj
bGtfc3RhdGUgKm5ld19zdGF0ZSwKPiAgIAkJCQkgZW51bSBwaXBlIHBpcGUpCj4gICB7Cj4gICAJ
aWYgKHBpcGUgPT0gSU5WQUxJRF9QSVBFIHx8IG9sZF9zdGF0ZS0+Y2RjbGsgPD0gbmV3X3N0YXRl
LT5jZGNsaykKPiAtCQlpbnRlbF9zZXRfY2RjbGsoZGV2X3ByaXYsIG5ld19zdGF0ZSwgcGlwZSk7
Cj4gKwkJaW50ZWxfc2V0X2NkY2xrKGk5MTUsIG5ld19zdGF0ZSwgcGlwZSk7Cj4gICB9Cj4gICAK
PiAgIC8qKgo+ICAgICogaW50ZWxfc2V0X2NkY2xrX3Bvc3RfcGxhbmVfdXBkYXRlIC0gUHVzaCB0
aGUgQ0RDTEsgc3RhdGUgdG8gdGhlIGhhcmR3YXJlCj4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZp
Y2UKPiArICogQGk5MTU6IGk5MTUgZGV2aWNlCj4gICAgKiBAb2xkX3N0YXRlOiBvbGQgQ0RDTEsg
c3RhdGUKPiAgICAqIEBuZXdfc3RhdGU6IG5ldyBDRENMSyBzdGF0ZQo+ICAgICogQHBpcGU6IHBp
cGUgd2l0aCB3aGljaCB0byBzeW5jaHJvbml6ZSB0aGUgdXBkYXRlCj4gQEAgLTIxNzYsMjQgKzIx
NzYsMjQgQEAgaW50ZWxfc2V0X2NkY2xrX3ByZV9wbGFuZV91cGRhdGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgICogaW4gQ0RDTEsgc3RhdGUsIGlmIG5lY2Vzc2FyeS4K
PiAgICAqLwo+ICAgdm9pZAo+IC1pbnRlbF9zZXRfY2RjbGtfcG9zdF9wbGFuZV91cGRhdGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtpbnRlbF9zZXRfY2RjbGtfcG9zdF9w
bGFuZV91cGRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICBjb25z
dCBzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgKm9sZF9zdGF0ZSwKPiAgIAkJCQkgIGNvbnN0IHN0
cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqbmV3X3N0YXRlLAo+ICAgCQkJCSAgZW51bSBwaXBlIHBp
cGUpCj4gICB7Cj4gICAJaWYgKHBpcGUgIT0gSU5WQUxJRF9QSVBFICYmIG9sZF9zdGF0ZS0+Y2Rj
bGsgPiBuZXdfc3RhdGUtPmNkY2xrKQo+IC0JCWludGVsX3NldF9jZGNsayhkZXZfcHJpdiwgbmV3
X3N0YXRlLCBwaXBlKTsKPiArCQlpbnRlbF9zZXRfY2RjbGsoaTkxNSwgbmV3X3N0YXRlLCBwaXBl
KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgaW50IGludGVsX3BpeGVsX3JhdGVfdG9fY2RjbGsoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgaW50IGludGVsX3BpeGVs
X3JhdGVfdG9fY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAg
ICBpbnQgcGl4ZWxfcmF0ZSkKPiAgIHsKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEw
IHx8IElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAx
MCB8fCBJU19HRU1JTklMQUtFKGk5MTUpKQo+ICAgCQlyZXR1cm4gRElWX1JPVU5EX1VQKHBpeGVs
X3JhdGUsIDIpOwo+IC0JZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCA5KSB8fAo+IC0JCSBJU19C
Uk9BRFdFTEwoZGV2X3ByaXYpIHx8IElTX0hBU1dFTEwoZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAo
SVNfR0VOKGk5MTUsIDkpIHx8Cj4gKwkJIElTX0JST0FEV0VMTChpOTE1KSB8fCBJU19IQVNXRUxM
KGk5MTUpKQo+ICAgCQlyZXR1cm4gcGl4ZWxfcmF0ZTsKPiAtCWVsc2UgaWYgKElTX0NIRVJSWVZJ
RVcoZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiAgIAkJcmV0
dXJuIERJVl9ST1VORF9VUChwaXhlbF9yYXRlICogMTAwLCA5NSk7Cj4gICAJZWxzZQo+ICAgCQly
ZXR1cm4gRElWX1JPVU5EX1VQKHBpeGVsX3JhdGUgKiAxMDAsIDkwKTsKPiBAQCAtMjIwMSwxNyAr
MjIwMSwxNyBAQCBzdGF0aWMgaW50IGludGVsX3BpeGVsX3JhdGVfdG9fY2RjbGsoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCj4gICBpbnQgaW50ZWxfY3J0Y19jb21wdXRl
X21pbl9jZGNsayhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAg
IHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9Cj4gICAJCXRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRj
LT5kZXYpOwo+ICAgCWludCBtaW5fY2RjbGs7Cj4gICAKPiAgIAlpZiAoIWNydGNfc3RhdGUtPmJh
c2UuZW5hYmxlKQo+ICAgCQlyZXR1cm4gMDsKPiAgIAo+IC0JbWluX2NkY2xrID0gaW50ZWxfcGl4
ZWxfcmF0ZV90b19jZGNsayhkZXZfcHJpdiwgY3J0Y19zdGF0ZS0+cGl4ZWxfcmF0ZSk7Cj4gKwlt
aW5fY2RjbGsgPSBpbnRlbF9waXhlbF9yYXRlX3RvX2NkY2xrKGk5MTUsIGNydGNfc3RhdGUtPnBp
eGVsX3JhdGUpOwo+ICAgCj4gICAJLyogcGl4ZWwgcmF0ZSBtdXN0bid0IGV4Y2VlZCA5NSUgb2Yg
Y2RjbGsgd2l0aCBJUFMgb24gQkRXICovCj4gLQlpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSAm
JiBoc3dfY3J0Y19zdGF0ZV9pcHNfY2FwYWJsZShjcnRjX3N0YXRlKSkKPiArCWlmIChJU19CUk9B
RFdFTEwoaTkxNSkgJiYgaHN3X2NydGNfc3RhdGVfaXBzX2NhcGFibGUoY3J0Y19zdGF0ZSkpCj4g
ICAJCW1pbl9jZGNsayA9IERJVl9ST1VORF9VUChtaW5fY2RjbGsgKiAxMDAsIDk1KTsKPiAgIAo+
ICAgCS8qIEJTcGVjIHNheXMgIkRvIG5vdCB1c2UgRGlzcGxheVBvcnQgd2l0aCBDRENMSyBsZXNz
IHRoYW4gNDMyIE1IeiwKPiBAQCAtMjIyMywxMCArMjIyMywxMCBAQCBpbnQgaW50ZWxfY3J0Y19j
b21wdXRlX21pbl9jZGNsayhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSkKPiAgIAkgICAgY3J0Y19zdGF0ZS0+aGFzX2F1ZGlvICYmCj4gICAJICAgIGNydGNfc3RhdGUt
PnBvcnRfY2xvY2sgPj0gNTQwMDAwICYmCj4gICAJICAgIGNydGNfc3RhdGUtPmxhbmVfY291bnQg
PT0gNCkgewo+IC0JCWlmIChJU19DQU5OT05MQUtFKGRldl9wcml2KSB8fCBJU19HRU1JTklMQUtF
KGRldl9wcml2KSkgewo+ICsJCWlmIChJU19DQU5OT05MQUtFKGk5MTUpIHx8IElTX0dFTUlOSUxB
S0UoaTkxNSkpIHsKPiAgIAkJCS8qIERpc3BsYXkgV0EgIzExNDU6IGdsayxjbmwgKi8KPiAgIAkJ
CW1pbl9jZGNsayA9IG1heCgzMTY4MDAsIG1pbl9jZGNsayk7Cj4gLQkJfSBlbHNlIGlmIChJU19H
RU4oZGV2X3ByaXYsIDkpIHx8IElTX0JST0FEV0VMTChkZXZfcHJpdikpIHsKPiArCQl9IGVsc2Ug
aWYgKElTX0dFTihpOTE1LCA5KSB8fCBJU19CUk9BRFdFTEwoaTkxNSkpIHsKPiAgIAkJCS8qIERp
c3BsYXkgV0EgIzExNDQ6IHNrbCxieHQgKi8KPiAgIAkJCW1pbl9jZGNsayA9IG1heCg0MzIwMDAs
IG1pbl9jZGNsayk7Cj4gICAJCX0KPiBAQCAtMjIzNiw3ICsyMjM2LDcgQEAgaW50IGludGVsX2Ny
dGNfY29tcHV0ZV9taW5fY2RjbGsoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUpCj4gICAJICogQWNjb3JkaW5nIHRvIEJTcGVjLCAiVGhlIENEIGNsb2NrIGZyZXF1ZW5j
eSBtdXN0IGJlIGF0IGxlYXN0IHR3aWNlCj4gICAJICogdGhlIGZyZXF1ZW5jeSBvZiB0aGUgQXph
bGlhIEJDTEsuIiBhbmQgQkNMSyBpcyA5NiBNSHogYnkgZGVmYXVsdC4KPiAgIAkgKi8KPiAtCWlm
IChjcnRjX3N0YXRlLT5oYXNfYXVkaW8gJiYgSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KQo+ICsJ
aWYgKGNydGNfc3RhdGUtPmhhc19hdWRpbyAmJiBJTlRFTF9HRU4oaTkxNSkgPj0gOSkKPiAgIAkJ
bWluX2NkY2xrID0gbWF4KDIgKiA5NjAwMCwgbWluX2NkY2xrKTsKPiAgIAo+ICAgCS8qCj4gQEAg
LTIyNDQsNyArMjI0NCw3IEBAIGludCBpbnRlbF9jcnRjX2NvbXB1dGVfbWluX2NkY2xrKGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgCSAqIHRoYW4gMzIwMDAw
S0h6Lgo+ICAgCSAqLwo+ICAgCWlmIChpbnRlbF9jcnRjX2hhc190eXBlKGNydGNfc3RhdGUsIElO
VEVMX09VVFBVVF9EU0kpICYmCj4gLQkgICAgSVNfVkFMTEVZVklFVyhkZXZfcHJpdikpCj4gKwkg
ICAgSVNfVkFMTEVZVklFVyhpOTE1KSkKPiAgIAkJbWluX2NkY2xrID0gbWF4KDMyMDAwMCwgbWlu
X2NkY2xrKTsKPiAgIAo+ICAgCS8qCj4gQEAgLTIyNTMsMTIgKzIyNTMsMTIgQEAgaW50IGludGVs
X2NydGNfY29tcHV0ZV9taW5fY2RjbGsoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUpCj4gICAJICogY29ycmVjdCBmb3IgRFNJIFBMTCBhbmQgREUgUExMLgo+ICAgCSAq
Lwo+ICAgCWlmIChpbnRlbF9jcnRjX2hhc190eXBlKGNydGNfc3RhdGUsIElOVEVMX09VVFBVVF9E
U0kpICYmCj4gLQkgICAgSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpCj4gKwkgICAgSVNfR0VNSU5J
TEFLRShpOTE1KSkKPiAgIAkJbWluX2NkY2xrID0gbWF4KDE1ODQwMCwgbWluX2NkY2xrKTsKPiAg
IAo+IC0JaWYgKG1pbl9jZGNsayA+IGRldl9wcml2LT5tYXhfY2RjbGtfZnJlcSkgewo+ICsJaWYg
KG1pbl9jZGNsayA+IGk5MTUtPm1heF9jZGNsa19mcmVxKSB7Cj4gICAJCURSTV9ERUJVR19LTVMo
InJlcXVpcmVkIGNkY2xrICglZCBrSHopIGV4Y2VlZHMgbWF4ICglZCBrSHopXG4iLAo+IC0JCQkg
ICAgICBtaW5fY2RjbGssIGRldl9wcml2LT5tYXhfY2RjbGtfZnJlcSk7Cj4gKwkJCSAgICAgIG1p
bl9jZGNsaywgaTkxNS0+bWF4X2NkY2xrX2ZyZXEpOwo+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiAg
IAl9Cj4gICAKPiBAQCAtMjI2NywxMyArMjI2NywxMyBAQCBpbnQgaW50ZWxfY3J0Y19jb21wdXRl
X21pbl9jZGNsayhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAg
IAo+ICAgc3RhdGljIGludCBpbnRlbF9jb21wdXRlX21pbl9jZGNsayhzdHJ1Y3QgaW50ZWxfYXRv
bWljX3N0YXRlICpzdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoc3RhdGUtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShzdGF0ZS0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlOwo+ICAg
CWludCBtaW5fY2RjbGssIGk7Cj4gICAJZW51bSBwaXBlIHBpcGU7Cj4gICAKPiAtCW1lbWNweShz
dGF0ZS0+bWluX2NkY2xrLCBkZXZfcHJpdi0+bWluX2NkY2xrLAo+ICsJbWVtY3B5KHN0YXRlLT5t
aW5fY2RjbGssIGk5MTUtPm1pbl9jZGNsaywKPiAgIAkgICAgICAgc2l6ZW9mKHN0YXRlLT5taW5f
Y2RjbGspKTsKPiAgIAo+ICAgCWZvcl9lYWNoX25ld19pbnRlbF9jcnRjX2luX3N0YXRlKHN0YXRl
LCBjcnRjLCBjcnRjX3N0YXRlLCBpKSB7Cj4gQEAgLTIyODUsNyArMjI4NSw3IEBAIHN0YXRpYyBp
bnQgaW50ZWxfY29tcHV0ZV9taW5fY2RjbGsoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3Rh
dGUpCj4gICAJfQo+ICAgCj4gICAJbWluX2NkY2xrID0gc3RhdGUtPmNkY2xrLmZvcmNlX21pbl9j
ZGNsazsKPiAtCWZvcl9lYWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpCj4gKwlmb3JfZWFjaF9waXBl
KGk5MTUsIHBpcGUpCj4gICAJCW1pbl9jZGNsayA9IG1heChzdGF0ZS0+bWluX2NkY2xrW3BpcGVd
LCBtaW5fY2RjbGspOwo+ICAgCj4gICAJcmV0dXJuIG1pbl9jZGNsazsKPiBAQCAtMjMwMiwxNCAr
MjMwMiwxNCBAQCBzdGF0aWMgaW50IGludGVsX2NvbXB1dGVfbWluX2NkY2xrKHN0cnVjdCBpbnRl
bF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAgICovCj4gICBzdGF0aWMgdTggY25sX2NvbXB1dGVf
bWluX3ZvbHRhZ2VfbGV2ZWwoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHN0YXRlLT5i
YXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoc3Rh
dGUtPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsKPiAgIAlzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZTsKPiAgIAl1OCBtaW5fdm9sdGFnZV9sZXZlbDsK
PiAgIAlpbnQgaTsKPiAgIAllbnVtIHBpcGUgcGlwZTsKPiAgIAo+IC0JbWVtY3B5KHN0YXRlLT5t
aW5fdm9sdGFnZV9sZXZlbCwgZGV2X3ByaXYtPm1pbl92b2x0YWdlX2xldmVsLAo+ICsJbWVtY3B5
KHN0YXRlLT5taW5fdm9sdGFnZV9sZXZlbCwgaTkxNS0+bWluX3ZvbHRhZ2VfbGV2ZWwsCj4gICAJ
ICAgICAgIHNpemVvZihzdGF0ZS0+bWluX3ZvbHRhZ2VfbGV2ZWwpKTsKPiAgIAo+ICAgCWZvcl9l
YWNoX25ld19pbnRlbF9jcnRjX2luX3N0YXRlKHN0YXRlLCBjcnRjLCBjcnRjX3N0YXRlLCBpKSB7
Cj4gQEAgLTIzMjEsNyArMjMyMSw3IEBAIHN0YXRpYyB1OCBjbmxfY29tcHV0ZV9taW5fdm9sdGFn
ZV9sZXZlbChzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgIAl9Cj4gICAKPiAg
IAltaW5fdm9sdGFnZV9sZXZlbCA9IDA7Cj4gLQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBl
KQo+ICsJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKQo+ICAgCQltaW5fdm9sdGFnZV9sZXZlbCA9
IG1heChzdGF0ZS0+bWluX3ZvbHRhZ2VfbGV2ZWxbcGlwZV0sCj4gICAJCQkJCW1pbl92b2x0YWdl
X2xldmVsKTsKPiAgIAo+IEBAIC0yMzMwLDI1ICsyMzMwLDI1IEBAIHN0YXRpYyB1OCBjbmxfY29t
cHV0ZV9taW5fdm9sdGFnZV9sZXZlbChzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkK
PiAgIAo+ICAgc3RhdGljIGludCB2bHZfbW9kZXNldF9jYWxjX2NkY2xrKHN0cnVjdCBpbnRlbF9h
dG9taWNfc3RhdGUgKnN0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShzdGF0ZS0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KHN0YXRlLT5iYXNlLmRldik7Cj4gICAJaW50IG1pbl9jZGNs
aywgY2RjbGs7Cj4gICAKPiAgIAltaW5fY2RjbGsgPSBpbnRlbF9jb21wdXRlX21pbl9jZGNsayhz
dGF0ZSk7Cj4gICAJaWYgKG1pbl9jZGNsayA8IDApCj4gICAJCXJldHVybiBtaW5fY2RjbGs7Cj4g
ICAKPiAtCWNkY2xrID0gdmx2X2NhbGNfY2RjbGsoZGV2X3ByaXYsIG1pbl9jZGNsayk7Cj4gKwlj
ZGNsayA9IHZsdl9jYWxjX2NkY2xrKGk5MTUsIG1pbl9jZGNsayk7Cj4gICAKPiAgIAlzdGF0ZS0+
Y2RjbGsubG9naWNhbC5jZGNsayA9IGNkY2xrOwo+ICAgCXN0YXRlLT5jZGNsay5sb2dpY2FsLnZv
bHRhZ2VfbGV2ZWwgPQo+IC0JCXZsdl9jYWxjX3ZvbHRhZ2VfbGV2ZWwoZGV2X3ByaXYsIGNkY2xr
KTsKPiArCQl2bHZfY2FsY192b2x0YWdlX2xldmVsKGk5MTUsIGNkY2xrKTsKPiAgIAo+ICAgCWlm
ICghc3RhdGUtPmFjdGl2ZV9jcnRjcykgewo+IC0JCWNkY2xrID0gdmx2X2NhbGNfY2RjbGsoZGV2
X3ByaXYsIHN0YXRlLT5jZGNsay5mb3JjZV9taW5fY2RjbGspOwo+ICsJCWNkY2xrID0gdmx2X2Nh
bGNfY2RjbGsoaTkxNSwgc3RhdGUtPmNkY2xrLmZvcmNlX21pbl9jZGNsayk7Cj4gICAKPiAgIAkJ
c3RhdGUtPmNkY2xrLmFjdHVhbC5jZGNsayA9IGNkY2xrOwo+ICAgCQlzdGF0ZS0+Y2RjbGsuYWN0
dWFsLnZvbHRhZ2VfbGV2ZWwgPQo+IC0JCQl2bHZfY2FsY192b2x0YWdlX2xldmVsKGRldl9wcml2
LCBjZGNsayk7Cj4gKwkJCXZsdl9jYWxjX3ZvbHRhZ2VfbGV2ZWwoaTkxNSwgY2RjbGspOwo+ICAg
CX0gZWxzZSB7Cj4gICAJCXN0YXRlLT5jZGNsay5hY3R1YWwgPSBzdGF0ZS0+Y2RjbGsubG9naWNh
bDsKPiAgIAl9Cj4gQEAgLTIzODksMTQgKzIzODksMTQgQEAgc3RhdGljIGludCBiZHdfbW9kZXNl
dF9jYWxjX2NkY2xrKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAgCj4gICBz
dGF0aWMgaW50IHNrbF9kcGxsMF92Y28oc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUp
Cj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHN0
YXRlLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoc3RhdGUtPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsKPiAgIAlz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZTsKPiAgIAlpbnQgdmNvLCBpOwo+ICAg
Cj4gICAJdmNvID0gc3RhdGUtPmNkY2xrLmxvZ2ljYWwudmNvOwo+ICAgCWlmICghdmNvKQo+IC0J
CXZjbyA9IGRldl9wcml2LT5za2xfcHJlZmVycmVkX3Zjb19mcmVxOwo+ICsJCXZjbyA9IGk5MTUt
PnNrbF9wcmVmZXJyZWRfdmNvX2ZyZXE7Cj4gICAKPiAgIAlmb3JfZWFjaF9uZXdfaW50ZWxfY3J0
Y19pbl9zdGF0ZShzdGF0ZSwgY3J0YywgY3J0Y19zdGF0ZSwgaSkgewo+ICAgCQlpZiAoIWNydGNf
c3RhdGUtPmJhc2UuZW5hYmxlKQo+IEBAIC0yNDYwLDE5ICsyNDYwLDE5IEBAIHN0YXRpYyBpbnQg
c2tsX21vZGVzZXRfY2FsY19jZGNsayhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkK
PiAgIAo+ICAgc3RhdGljIGludCBieHRfbW9kZXNldF9jYWxjX2NkY2xrKHN0cnVjdCBpbnRlbF9h
dG9taWNfc3RhdGUgKnN0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShzdGF0ZS0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KHN0YXRlLT5iYXNlLmRldik7Cj4gICAJaW50IG1pbl9jZGNs
aywgY2RjbGssIHZjbzsKPiAgIAo+ICAgCW1pbl9jZGNsayA9IGludGVsX2NvbXB1dGVfbWluX2Nk
Y2xrKHN0YXRlKTsKPiAgIAlpZiAobWluX2NkY2xrIDwgMCkKPiAgIAkJcmV0dXJuIG1pbl9jZGNs
azsKPiAgIAo+IC0JaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfR0VN
SU5JTEFLRShpOTE1KSkgewo+ICAgCQljZGNsayA9IGdsa19jYWxjX2NkY2xrKG1pbl9jZGNsayk7
Cj4gLQkJdmNvID0gZ2xrX2RlX3BsbF92Y28oZGV2X3ByaXYsIGNkY2xrKTsKPiArCQl2Y28gPSBn
bGtfZGVfcGxsX3ZjbyhpOTE1LCBjZGNsayk7Cj4gICAJfSBlbHNlIHsKPiAgIAkJY2RjbGsgPSBi
eHRfY2FsY19jZGNsayhtaW5fY2RjbGspOwo+IC0JCXZjbyA9IGJ4dF9kZV9wbGxfdmNvKGRldl9w
cml2LCBjZGNsayk7Cj4gKwkJdmNvID0gYnh0X2RlX3BsbF92Y28oaTkxNSwgY2RjbGspOwo+ICAg
CX0KPiAgIAo+ICAgCXN0YXRlLT5jZGNsay5sb2dpY2FsLnZjbyA9IHZjbzsKPiBAQCAtMjQ4MSwx
MiArMjQ4MSwxMiBAQCBzdGF0aWMgaW50IGJ4dF9tb2Rlc2V0X2NhbGNfY2RjbGsoc3RydWN0IGlu
dGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gICAJCWJ4dF9jYWxjX3ZvbHRhZ2VfbGV2ZWwoY2Rj
bGspOwo+ICAgCj4gICAJaWYgKCFzdGF0ZS0+YWN0aXZlX2NydGNzKSB7Cj4gLQkJaWYgKElTX0dF
TUlOSUxBS0UoZGV2X3ByaXYpKSB7Cj4gKwkJaWYgKElTX0dFTUlOSUxBS0UoaTkxNSkpIHsKPiAg
IAkJCWNkY2xrID0gZ2xrX2NhbGNfY2RjbGsoc3RhdGUtPmNkY2xrLmZvcmNlX21pbl9jZGNsayk7
Cj4gLQkJCXZjbyA9IGdsa19kZV9wbGxfdmNvKGRldl9wcml2LCBjZGNsayk7Cj4gKwkJCXZjbyA9
IGdsa19kZV9wbGxfdmNvKGk5MTUsIGNkY2xrKTsKPiAgIAkJfSBlbHNlIHsKPiAgIAkJCWNkY2xr
ID0gYnh0X2NhbGNfY2RjbGsoc3RhdGUtPmNkY2xrLmZvcmNlX21pbl9jZGNsayk7Cj4gLQkJCXZj
byA9IGJ4dF9kZV9wbGxfdmNvKGRldl9wcml2LCBjZGNsayk7Cj4gKwkJCXZjbyA9IGJ4dF9kZV9w
bGxfdmNvKGk5MTUsIGNkY2xrKTsKPiAgIAkJfQo+ICAgCj4gICAJCXN0YXRlLT5jZGNsay5hY3R1
YWwudmNvID0gdmNvOwo+IEBAIC0yNTAyLDcgKzI1MDIsNyBAQCBzdGF0aWMgaW50IGJ4dF9tb2Rl
c2V0X2NhbGNfY2RjbGsoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gICAKPiAg
IHN0YXRpYyBpbnQgY25sX21vZGVzZXRfY2FsY19jZGNsayhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0
YXRlICpzdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoc3RhdGUtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShzdGF0ZS0+YmFzZS5kZXYpOwo+ICAgCWludCBtaW5fY2RjbGssIGNkY2xr
LCB2Y287Cj4gICAKPiAgIAltaW5fY2RjbGsgPSBpbnRlbF9jb21wdXRlX21pbl9jZGNsayhzdGF0
ZSk7Cj4gQEAgLTI1MTAsNyArMjUxMCw3IEBAIHN0YXRpYyBpbnQgY25sX21vZGVzZXRfY2FsY19j
ZGNsayhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgIAkJcmV0dXJuIG1pbl9j
ZGNsazsKPiAgIAo+ICAgCWNkY2xrID0gY25sX2NhbGNfY2RjbGsobWluX2NkY2xrKTsKPiAtCXZj
byA9IGNubF9jZGNsa19wbGxfdmNvKGRldl9wcml2LCBjZGNsayk7Cj4gKwl2Y28gPSBjbmxfY2Rj
bGtfcGxsX3ZjbyhpOTE1LCBjZGNsayk7Cj4gICAKPiAgIAlzdGF0ZS0+Y2RjbGsubG9naWNhbC52
Y28gPSB2Y287Cj4gICAJc3RhdGUtPmNkY2xrLmxvZ2ljYWwuY2RjbGsgPSBjZGNsazsKPiBAQCAt
MjUyMCw3ICsyNTIwLDcgQEAgc3RhdGljIGludCBjbmxfbW9kZXNldF9jYWxjX2NkY2xrKHN0cnVj
dCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAgCj4gICAJaWYgKCFzdGF0ZS0+YWN0aXZl
X2NydGNzKSB7Cj4gICAJCWNkY2xrID0gY25sX2NhbGNfY2RjbGsoc3RhdGUtPmNkY2xrLmZvcmNl
X21pbl9jZGNsayk7Cj4gLQkJdmNvID0gY25sX2NkY2xrX3BsbF92Y28oZGV2X3ByaXYsIGNkY2xr
KTsKPiArCQl2Y28gPSBjbmxfY2RjbGtfcGxsX3ZjbyhpOTE1LCBjZGNsayk7Cj4gICAKPiAgIAkJ
c3RhdGUtPmNkY2xrLmFjdHVhbC52Y28gPSB2Y287Cj4gICAJCXN0YXRlLT5jZGNsay5hY3R1YWwu
Y2RjbGsgPSBjZGNsazsKPiBAQCAtMjUzNSw3ICsyNTM1LDcgQEAgc3RhdGljIGludCBjbmxfbW9k
ZXNldF9jYWxjX2NkY2xrKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAgCj4g
ICBzdGF0aWMgaW50IGljbF9tb2Rlc2V0X2NhbGNfY2RjbGsoc3RydWN0IGludGVsX2F0b21pY19z
dGF0ZSAqc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KHN0YXRlLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoc3RhdGUtPmJhc2UuZGV2KTsKPiAgIAl1bnNpZ25lZCBpbnQgcmVmID0g
c3RhdGUtPmNkY2xrLmxvZ2ljYWwucmVmOwo+ICAgCWludCBtaW5fY2RjbGssIGNkY2xrLCB2Y287
Cj4gICAKPiBAQCAtMjU0NCw3ICsyNTQ0LDcgQEAgc3RhdGljIGludCBpY2xfbW9kZXNldF9jYWxj
X2NkY2xrKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAgCQlyZXR1cm4gbWlu
X2NkY2xrOwo+ICAgCj4gICAJY2RjbGsgPSBpY2xfY2FsY19jZGNsayhtaW5fY2RjbGssIHJlZik7
Cj4gLQl2Y28gPSBpY2xfY2FsY19jZGNsa19wbGxfdmNvKGRldl9wcml2LCBjZGNsayk7Cj4gKwl2
Y28gPSBpY2xfY2FsY19jZGNsa19wbGxfdmNvKGk5MTUsIGNkY2xrKTsKPiAgIAo+ICAgCXN0YXRl
LT5jZGNsay5sb2dpY2FsLnZjbyA9IHZjbzsKPiAgIAlzdGF0ZS0+Y2RjbGsubG9naWNhbC5jZGNs
ayA9IGNkY2xrOwo+IEBAIC0yNTU0LDcgKzI1NTQsNyBAQCBzdGF0aWMgaW50IGljbF9tb2Rlc2V0
X2NhbGNfY2RjbGsoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gICAKPiAgIAlp
ZiAoIXN0YXRlLT5hY3RpdmVfY3J0Y3MpIHsKPiAgIAkJY2RjbGsgPSBpY2xfY2FsY19jZGNsayhz
dGF0ZS0+Y2RjbGsuZm9yY2VfbWluX2NkY2xrLCByZWYpOwo+IC0JCXZjbyA9IGljbF9jYWxjX2Nk
Y2xrX3BsbF92Y28oZGV2X3ByaXYsIGNkY2xrKTsKPiArCQl2Y28gPSBpY2xfY2FsY19jZGNsa19w
bGxfdmNvKGk5MTUsIGNkY2xrKTsKPiAgIAo+ICAgCQlzdGF0ZS0+Y2RjbGsuYWN0dWFsLnZjbyA9
IHZjbzsKPiAgIAkJc3RhdGUtPmNkY2xrLmFjdHVhbC5jZGNsayA9IGNkY2xrOwo+IEBAIC0yNTY3
LDE4ICsyNTY3LDE4IEBAIHN0YXRpYyBpbnQgaWNsX21vZGVzZXRfY2FsY19jZGNsayhzdHJ1Y3Qg
aW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+IC1z
dGF0aWMgaW50IGludGVsX2NvbXB1dGVfbWF4X2RvdGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyBpbnQgaW50ZWxfY29tcHV0ZV9tYXhfZG90Y2xrKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JaW50IG1heF9jZGNsa19mcmVxID0g
ZGV2X3ByaXYtPm1heF9jZGNsa19mcmVxOwo+ICsJaW50IG1heF9jZGNsa19mcmVxID0gaTkxNS0+
bWF4X2NkY2xrX2ZyZXE7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwIHx8
IElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMCB8
fCBJU19HRU1JTklMQUtFKGk5MTUpKQo+ICAgCQlyZXR1cm4gMiAqIG1heF9jZGNsa19mcmVxOwo+
IC0JZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCA5KSB8fAo+IC0JCSBJU19CUk9BRFdFTEwoZGV2
X3ByaXYpIHx8IElTX0hBU1dFTEwoZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAoSVNfR0VOKGk5MTUs
IDkpIHx8Cj4gKwkJIElTX0JST0FEV0VMTChpOTE1KSB8fCBJU19IQVNXRUxMKGk5MTUpKQo+ICAg
CQlyZXR1cm4gbWF4X2NkY2xrX2ZyZXE7Cj4gLQllbHNlIGlmIChJU19DSEVSUllWSUVXKGRldl9w
cml2KSkKPiArCWVsc2UgaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gICAJCXJldHVybiBtYXhf
Y2RjbGtfZnJlcSo5NS8xMDA7Cj4gLQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNCkK
PiArCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA8IDQpCj4gICAJCXJldHVybiAyKm1heF9jZGNs
a19mcmVxKjkwLzEwMDsKPiAgIAllbHNlCj4gICAJCXJldHVybiBtYXhfY2RjbGtfZnJlcSo5MC8x
MDA7Cj4gQEAgLTI1ODYsMjYgKzI1ODYsMjYgQEAgc3RhdGljIGludCBpbnRlbF9jb21wdXRlX21h
eF9kb3RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCj4gICAvKioK
PiAgICAqIGludGVsX3VwZGF0ZV9tYXhfY2RjbGsgLSBEZXRlcm1pbmUgdGhlIG1heGltdW0gc3Vw
cG9ydCBDRENMSyBmcmVxdWVuY3kKPiAtICogQGRldl9wcml2OiBpOTE1IGRldmljZQo+ICsgKiBA
aTkxNTogaTkxNSBkZXZpY2UKPiAgICAqCj4gICAgKiBEZXRlcm1pbmUgdGhlIG1heGltdW0gQ0RD
TEsgZnJlcXVlbmN5IHRoZSBwbGF0Zm9ybSBzdXBwb3J0cywgYW5kIGFsc28KPiAgICAqIGRlcml2
ZSB0aGUgbWF4aW11bSBkb3QgY2xvY2sgZnJlcXVlbmN5IHRoZSBtYXhpbXVtIENEQ0xLIGZyZXF1
ZW5jeQo+ICAgICogYWxsb3dzLgo+ICAgICovCj4gLXZvaWQgaW50ZWxfdXBkYXRlX21heF9jZGNs
ayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgaW50ZWxfdXBkYXRl
X21heF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCWlmIChJ
TlRFTF9HRU4oZGV2X3ByaXYpID49IDExKSB7Cj4gLQkJaWYgKGRldl9wcml2LT5jZGNsay5ody5y
ZWYgPT0gMjQwMDApCj4gLQkJCWRldl9wcml2LT5tYXhfY2RjbGtfZnJlcSA9IDY0ODAwMDsKPiAr
CWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpIHsKPiArCQlpZiAoaTkxNS0+Y2RjbGsuaHcucmVm
ID09IDI0MDAwKQo+ICsJCQlpOTE1LT5tYXhfY2RjbGtfZnJlcSA9IDY0ODAwMDsKPiAgIAkJZWxz
ZQo+IC0JCQlkZXZfcHJpdi0+bWF4X2NkY2xrX2ZyZXEgPSA2NTI4MDA7Cj4gLQl9IGVsc2UgaWYg
KElTX0NBTk5PTkxBS0UoZGV2X3ByaXYpKSB7Cj4gLQkJZGV2X3ByaXYtPm1heF9jZGNsa19mcmVx
ID0gNTI4MDAwOwo+IC0JfSBlbHNlIGlmIChJU19HRU45X0JDKGRldl9wcml2KSkgewo+ICsJCQlp
OTE1LT5tYXhfY2RjbGtfZnJlcSA9IDY1MjgwMDsKPiArCX0gZWxzZSBpZiAoSVNfQ0FOTk9OTEFL
RShpOTE1KSkgewo+ICsJCWk5MTUtPm1heF9jZGNsa19mcmVxID0gNTI4MDAwOwo+ICsJfSBlbHNl
IGlmIChJU19HRU45X0JDKGk5MTUpKSB7Cj4gICAJCXUzMiBsaW1pdCA9IEk5MTVfUkVBRChTS0xf
REZTTSkgJiBTS0xfREZTTV9DRENMS19MSU1JVF9NQVNLOwo+ICAgCQlpbnQgbWF4X2NkY2xrLCB2
Y287Cj4gICAKPiAtCQl2Y28gPSBkZXZfcHJpdi0+c2tsX3ByZWZlcnJlZF92Y29fZnJlcTsKPiAr
CQl2Y28gPSBpOTE1LT5za2xfcHJlZmVycmVkX3Zjb19mcmVxOwo+ICAgCQlXQVJOX09OKHZjbyAh
PSA4MTAwMDAwICYmIHZjbyAhPSA4NjQwMDAwKTsKPiAgIAo+ICAgCQkvKgo+IEBAIC0yNjIyLDEy
ICsyNjIyLDEyIEBAIHZvaWQgaW50ZWxfdXBkYXRlX21heF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCWVsc2UKPiAgIAkJCW1heF9jZGNsayA9IDMwODU3MTsK
PiAgIAo+IC0JCWRldl9wcml2LT5tYXhfY2RjbGtfZnJlcSA9IHNrbF9jYWxjX2NkY2xrKG1heF9j
ZGNsaywgdmNvKTsKPiAtCX0gZWxzZSBpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpIHsKPiAt
CQlkZXZfcHJpdi0+bWF4X2NkY2xrX2ZyZXEgPSAzMTY4MDA7Cj4gLQl9IGVsc2UgaWYgKElTX0JS
T1hUT04oZGV2X3ByaXYpKSB7Cj4gLQkJZGV2X3ByaXYtPm1heF9jZGNsa19mcmVxID0gNjI0MDAw
Owo+IC0JfSBlbHNlIGlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYpKSAgewo+ICsJCWk5MTUtPm1h
eF9jZGNsa19mcmVxID0gc2tsX2NhbGNfY2RjbGsobWF4X2NkY2xrLCB2Y28pOwo+ICsJfSBlbHNl
IGlmIChJU19HRU1JTklMQUtFKGk5MTUpKSB7Cj4gKwkJaTkxNS0+bWF4X2NkY2xrX2ZyZXEgPSAz
MTY4MDA7Cj4gKwl9IGVsc2UgaWYgKElTX0JST1hUT04oaTkxNSkpIHsKPiArCQlpOTE1LT5tYXhf
Y2RjbGtfZnJlcSA9IDYyNDAwMDsKPiArCX0gZWxzZSBpZiAoSVNfQlJPQURXRUxMKGk5MTUpKSAg
ewo+ICAgCQkvKgo+ICAgCQkgKiBGSVhNRSB3aXRoIGV4dHJhIGNvb2xpbmcgd2UgY2FuIGFsbG93
Cj4gICAJCSAqIDU0MCBNSHogZm9yIFVMWCBhbmQgNjc1IE1oeiBmb3IgVUxULgo+IEBAIC0yNjM1
LDQwICsyNjM1LDQwIEBAIHZvaWQgaW50ZWxfdXBkYXRlX21heF9jZGNsayhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCSAqIGF2YWlsYWJsZT8gUENJIElELCBWVEIsIHNv
bWV0aGluZyBlbHNlPwo+ICAgCQkgKi8KPiAgIAkJaWYgKEk5MTVfUkVBRChGVVNFX1NUUkFQKSAm
IEhTV19DRENMS19MSU1JVCkKPiAtCQkJZGV2X3ByaXYtPm1heF9jZGNsa19mcmVxID0gNDUwMDAw
Owo+IC0JCWVsc2UgaWYgKElTX0JEV19VTFgoZGV2X3ByaXYpKQo+IC0JCQlkZXZfcHJpdi0+bWF4
X2NkY2xrX2ZyZXEgPSA0NTAwMDA7Cj4gLQkJZWxzZSBpZiAoSVNfQkRXX1VMVChkZXZfcHJpdikp
Cj4gLQkJCWRldl9wcml2LT5tYXhfY2RjbGtfZnJlcSA9IDU0MDAwMDsKPiArCQkJaTkxNS0+bWF4
X2NkY2xrX2ZyZXEgPSA0NTAwMDA7Cj4gKwkJZWxzZSBpZiAoSVNfQkRXX1VMWChpOTE1KSkKPiAr
CQkJaTkxNS0+bWF4X2NkY2xrX2ZyZXEgPSA0NTAwMDA7Cj4gKwkJZWxzZSBpZiAoSVNfQkRXX1VM
VChpOTE1KSkKPiArCQkJaTkxNS0+bWF4X2NkY2xrX2ZyZXEgPSA1NDAwMDA7Cj4gICAJCWVsc2UK
PiAtCQkJZGV2X3ByaXYtPm1heF9jZGNsa19mcmVxID0gNjc1MDAwOwo+IC0JfSBlbHNlIGlmIChJ
U19DSEVSUllWSUVXKGRldl9wcml2KSkgewo+IC0JCWRldl9wcml2LT5tYXhfY2RjbGtfZnJlcSA9
IDMyMDAwMDsKPiAtCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikpIHsKPiAtCQlk
ZXZfcHJpdi0+bWF4X2NkY2xrX2ZyZXEgPSA0MDAwMDA7Cj4gKwkJCWk5MTUtPm1heF9jZGNsa19m
cmVxID0gNjc1MDAwOwo+ICsJfSBlbHNlIGlmIChJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gKwkJ
aTkxNS0+bWF4X2NkY2xrX2ZyZXEgPSAzMjAwMDA7Cj4gKwl9IGVsc2UgaWYgKElTX1ZBTExFWVZJ
RVcoaTkxNSkpIHsKPiArCQlpOTE1LT5tYXhfY2RjbGtfZnJlcSA9IDQwMDAwMDsKPiAgIAl9IGVs
c2Ugewo+ICAgCQkvKiBvdGhlcndpc2UgYXNzdW1lIGNkY2xrIGlzIGZpeGVkICovCj4gLQkJZGV2
X3ByaXYtPm1heF9jZGNsa19mcmVxID0gZGV2X3ByaXYtPmNkY2xrLmh3LmNkY2xrOwo+ICsJCWk5
MTUtPm1heF9jZGNsa19mcmVxID0gaTkxNS0+Y2RjbGsuaHcuY2RjbGs7Cj4gICAJfQo+ICAgCj4g
LQlkZXZfcHJpdi0+bWF4X2RvdGNsa19mcmVxID0gaW50ZWxfY29tcHV0ZV9tYXhfZG90Y2xrKGRl
dl9wcml2KTsKPiArCWk5MTUtPm1heF9kb3RjbGtfZnJlcSA9IGludGVsX2NvbXB1dGVfbWF4X2Rv
dGNsayhpOTE1KTsKPiAgIAo+ICAgCURSTV9ERUJVR19EUklWRVIoIk1heCBDRCBjbG9jayByYXRl
OiAlZCBrSHpcbiIsCj4gLQkJCSBkZXZfcHJpdi0+bWF4X2NkY2xrX2ZyZXEpOwo+ICsJCQkgaTkx
NS0+bWF4X2NkY2xrX2ZyZXEpOwo+ICAgCj4gICAJRFJNX0RFQlVHX0RSSVZFUigiTWF4IGRvdGNs
b2NrIHJhdGU6ICVkIGtIelxuIiwKPiAtCQkJIGRldl9wcml2LT5tYXhfZG90Y2xrX2ZyZXEpOwo+
ICsJCQkgaTkxNS0+bWF4X2RvdGNsa19mcmVxKTsKPiAgIH0KPiAgIAo+ICAgLyoqCj4gICAgKiBp
bnRlbF91cGRhdGVfY2RjbGsgLSBEZXRlcm1pbmUgdGhlIGN1cnJlbnQgQ0RDTEsgZnJlcXVlbmN5
Cj4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UKPiArICogQGk5MTU6IGk5MTUgZGV2aWNlCj4g
ICAgKgo+ICAgICogRGV0ZXJtaW5lIHRoZSBjdXJyZW50IENEQ0xLIGZyZXF1ZW5jeS4KPiAgICAq
Lwo+IC12b2lkIGludGVsX3VwZGF0ZV9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gK3ZvaWQgaW50ZWxfdXBkYXRlX2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQo+ICAgewo+IC0JZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X2NkY2xrKGRldl9wcml2LCAm
ZGV2X3ByaXYtPmNkY2xrLmh3KTsKPiArCWk5MTUtPmRpc3BsYXkuZ2V0X2NkY2xrKGk5MTUsICZp
OTE1LT5jZGNsay5odyk7Cj4gICAKPiAgIAkvKgo+ICAgCSAqIDk6MCBDTUJVUyBbc2ljXSBDRENM
SyBmcmVxdWVuY3kgKGNkZnJlcSk6Cj4gQEAgLTI2NzYsMTIgKzI2NzYsMTIgQEAgdm9pZCBpbnRl
bF91cGRhdGVfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCSAq
IG9mIGNkY2xrIHRoYXQgZ2VuZXJhdGVzIDRNSHogcmVmZXJlbmNlIGNsb2NrIGZyZXEgd2hpY2gg
aXMgdXNlZCB0bwo+ICAgCSAqIGdlbmVyYXRlIEdNQnVzIGNsb2NrLiBUaGlzIHdpbGwgdmFyeSB3
aXRoIHRoZSBjZGNsayBmcmVxLgo+ICAgCSAqLwo+IC0JaWYgKElTX1ZBTExFWVZJRVcoZGV2X3By
aXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ICsJaWYgKElTX1ZBTExFWVZJRVcoaTkx
NSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiAgIAkJSTkxNV9XUklURShHTUJVU0ZSRVFfVkxW
LAo+IC0JCQkgICBESVZfUk9VTkRfVVAoZGV2X3ByaXYtPmNkY2xrLmh3LmNkY2xrLCAxMDAwKSk7
Cj4gKwkJCSAgIERJVl9ST1VORF9VUChpOTE1LT5jZGNsay5ody5jZGNsaywgMTAwMCkpOwo+ICAg
fQo+ICAgCj4gLXN0YXRpYyBpbnQgY25wX3Jhd2NsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gK3N0YXRpYyBpbnQgY25wX3Jhd2NsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKPiAgIHsKPiAgIAl1MzIgcmF3Y2xrOwo+ICAgCWludCBkaXZpZGVyLCBmcmFjdGlv
bjsKPiBAQCAtMjcwMiw3ICsyNzAyLDcgQEAgc3RhdGljIGludCBjbnBfcmF3Y2xrKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAo+ICAgCQlyYXdjbGsgfD0gQ05QX1JBV0NM
S19ERU4oRElWX1JPVU5EX0NMT1NFU1QobnVtZXJhdG9yICogMTAwMCwKPiAgIAkJCQkJCQkgICBm
cmFjdGlvbikgLSAxKTsKPiAtCQlpZiAoSU5URUxfUENIX1RZUEUoZGV2X3ByaXYpID49IFBDSF9J
Q1ApCj4gKwkJaWYgKElOVEVMX1BDSF9UWVBFKGk5MTUpID49IFBDSF9JQ1ApCj4gICAJCQlyYXdj
bGsgfD0gSUNQX1JBV0NMS19OVU0obnVtZXJhdG9yKTsKPiAgIAl9Cj4gICAKPiBAQCAtMjcxMCwx
OSArMjcxMCwxOSBAQCBzdGF0aWMgaW50IGNucF9yYXdjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ICAgCXJldHVybiBkaXZpZGVyICsgZnJhY3Rpb247Cj4gICB9Cj4gICAK
PiAtc3RhdGljIGludCBwY2hfcmF3Y2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiArc3RhdGljIGludCBwY2hfcmF3Y2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ICAgewo+ICAgCXJldHVybiAoSTkxNV9SRUFEKFBDSF9SQVdDTEtfRlJFUSkgJiBSQVdDTEtf
RlJFUV9NQVNLKSAqIDEwMDA7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGludCB2bHZfaHJhd2Nsayhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyBpbnQgdmx2X2hyYXdj
bGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJLyogUkFXQ0xLX0ZS
RVFfVkxWIHJlZ2lzdGVyIHVwZGF0ZWQgZnJvbSBwb3dlciB3ZWxsIGNvZGUgKi8KPiAtCXJldHVy
biB2bHZfZ2V0X2Nja19jbG9ja19ocGxsKGRldl9wcml2LCAiaHJhd2NsayIsCj4gKwlyZXR1cm4g
dmx2X2dldF9jY2tfY2xvY2tfaHBsbChpOTE1LCAiaHJhd2NsayIsCj4gICAJCQkJICAgICAgQ0NL
X0RJU1BMQVlfUkVGX0NMT0NLX0NPTlRST0wpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBpbnQgZzR4
X2hyYXdjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgaW50
IGc0eF9ocmF3Y2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUz
MiBjbGtjZmc7Cj4gICAKPiBAQCAtMjc1MCwxMDQgKzI3NTAsMTA0IEBAIHN0YXRpYyBpbnQgZzR4
X2hyYXdjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCj4gICAvKioK
PiAgICAqIGludGVsX3VwZGF0ZV9yYXdjbGsgLSBEZXRlcm1pbmUgdGhlIGN1cnJlbnQgUkFXQ0xL
IGZyZXF1ZW5jeQo+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlCj4gKyAqIEBpOTE1OiBpOTE1
IGRldmljZQo+ICAgICoKPiAgICAqIERldGVybWluZSB0aGUgY3VycmVudCBSQVdDTEsgZnJlcXVl
bmN5LiBSQVdDTEsgaXMgYSBmaXhlZAo+ICAgICogZnJlcXVlbmN5IGNsb2NrIHNvIHRoaXMgbmVl
ZHMgdG8gZG9uZSBvbmx5IG9uY2UuCj4gICAgKi8KPiAtdm9pZCBpbnRlbF91cGRhdGVfcmF3Y2xr
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAtewo+IC0JaWYgKElOVEVMX1BD
SF9UWVBFKGRldl9wcml2KSA+PSBQQ0hfQ05QKQo+IC0JCWRldl9wcml2LT5yYXdjbGtfZnJlcSA9
IGNucF9yYXdjbGsoZGV2X3ByaXYpOwo+IC0JZWxzZSBpZiAoSEFTX1BDSF9TUExJVChkZXZfcHJp
dikpCj4gLQkJZGV2X3ByaXYtPnJhd2Nsa19mcmVxID0gcGNoX3Jhd2NsayhkZXZfcHJpdik7Cj4g
LQllbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9w
cml2KSkKPiAtCQlkZXZfcHJpdi0+cmF3Y2xrX2ZyZXEgPSB2bHZfaHJhd2NsayhkZXZfcHJpdik7
Cj4gLQllbHNlIGlmIChJU19HNFgoZGV2X3ByaXYpIHx8IElTX1BJTkVWSUVXKGRldl9wcml2KSkK
PiAtCQlkZXZfcHJpdi0+cmF3Y2xrX2ZyZXEgPSBnNHhfaHJhd2NsayhkZXZfcHJpdik7Cj4gK3Zv
aWQgaW50ZWxfdXBkYXRlX3Jhd2NsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAr
ewo+ICsJaWYgKElOVEVMX1BDSF9UWVBFKGk5MTUpID49IFBDSF9DTlApCj4gKwkJaTkxNS0+cmF3
Y2xrX2ZyZXEgPSBjbnBfcmF3Y2xrKGk5MTUpOwo+ICsJZWxzZSBpZiAoSEFTX1BDSF9TUExJVChp
OTE1KSkKPiArCQlpOTE1LT5yYXdjbGtfZnJlcSA9IHBjaF9yYXdjbGsoaTkxNSk7Cj4gKwllbHNl
IGlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gKwkJaTkx
NS0+cmF3Y2xrX2ZyZXEgPSB2bHZfaHJhd2NsayhpOTE1KTsKPiArCWVsc2UgaWYgKElTX0c0WChp
OTE1KSB8fCBJU19QSU5FVklFVyhpOTE1KSkKPiArCQlpOTE1LT5yYXdjbGtfZnJlcSA9IGc0eF9o
cmF3Y2xrKGk5MTUpOwo+ICAgCWVsc2UKPiAgIAkJLyogbm8gcmF3Y2xrIG9uIG90aGVyIHBsYXRm
b3Jtcywgb3Igbm8gbmVlZCB0byBrbm93IGl0ICovCj4gICAJCXJldHVybjsKPiAgIAo+IC0JRFJN
X0RFQlVHX0RSSVZFUigicmF3Y2xrIHJhdGU6ICVkIGtIelxuIiwgZGV2X3ByaXYtPnJhd2Nsa19m
cmVxKTsKPiArCURSTV9ERUJVR19EUklWRVIoInJhd2NsayByYXRlOiAlZCBrSHpcbiIsIGk5MTUt
PnJhd2Nsa19mcmVxKTsKPiAgIH0KPiAgIAo+ICAgLyoqCj4gICAgKiBpbnRlbF9pbml0X2NkY2xr
X2hvb2tzIC0gSW5pdGlhbGl6ZSBDRENMSyByZWxhdGVkIG1vZGVzZXR0aW5nIGhvb2tzCj4gLSAq
IEBkZXZfcHJpdjogaTkxNSBkZXZpY2UKPiArICogQGk5MTU6IGk5MTUgZGV2aWNlCj4gICAgKi8K
PiAtdm9pZCBpbnRlbF9pbml0X2NkY2xrX2hvb2tzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiAtewo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpIHsKPiAtCQlk
ZXZfcHJpdi0+ZGlzcGxheS5zZXRfY2RjbGsgPSBpY2xfc2V0X2NkY2xrOwo+IC0JCWRldl9wcml2
LT5kaXNwbGF5Lm1vZGVzZXRfY2FsY19jZGNsayA9IGljbF9tb2Rlc2V0X2NhbGNfY2RjbGs7Cj4g
LQl9IGVsc2UgaWYgKElTX0NBTk5PTkxBS0UoZGV2X3ByaXYpKSB7Cj4gLQkJZGV2X3ByaXYtPmRp
c3BsYXkuc2V0X2NkY2xrID0gY25sX3NldF9jZGNsazsKPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5t
b2Rlc2V0X2NhbGNfY2RjbGsgPSBjbmxfbW9kZXNldF9jYWxjX2NkY2xrOwo+IC0JfSBlbHNlIGlm
IChJU19HRU45X0xQKGRldl9wcml2KSkgewo+IC0JCWRldl9wcml2LT5kaXNwbGF5LnNldF9jZGNs
ayA9IGJ4dF9zZXRfY2RjbGs7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkubW9kZXNldF9jYWxjX2Nk
Y2xrID0gYnh0X21vZGVzZXRfY2FsY19jZGNsazsKPiAtCX0gZWxzZSBpZiAoSVNfR0VOOV9CQyhk
ZXZfcHJpdikpIHsKPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5zZXRfY2RjbGsgPSBza2xfc2V0X2Nk
Y2xrOwo+IC0JCWRldl9wcml2LT5kaXNwbGF5Lm1vZGVzZXRfY2FsY19jZGNsayA9IHNrbF9tb2Rl
c2V0X2NhbGNfY2RjbGs7Cj4gLQl9IGVsc2UgaWYgKElTX0JST0FEV0VMTChkZXZfcHJpdikpIHsK
PiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5zZXRfY2RjbGsgPSBiZHdfc2V0X2NkY2xrOwo+IC0JCWRl
dl9wcml2LT5kaXNwbGF5Lm1vZGVzZXRfY2FsY19jZGNsayA9IGJkd19tb2Rlc2V0X2NhbGNfY2Rj
bGs7Cj4gLQl9IGVsc2UgaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gLQkJZGV2X3By
aXYtPmRpc3BsYXkuc2V0X2NkY2xrID0gY2h2X3NldF9jZGNsazsKPiAtCQlkZXZfcHJpdi0+ZGlz
cGxheS5tb2Rlc2V0X2NhbGNfY2RjbGsgPSB2bHZfbW9kZXNldF9jYWxjX2NkY2xrOwo+IC0JfSBl
bHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkgewo+IC0JCWRldl9wcml2LT5kaXNwbGF5
LnNldF9jZGNsayA9IHZsdl9zZXRfY2RjbGs7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkubW9kZXNl
dF9jYWxjX2NkY2xrID0gdmx2X21vZGVzZXRfY2FsY19jZGNsazsKPiArdm9pZCBpbnRlbF9pbml0
X2NkY2xrX2hvb2tzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICt7Cj4gKwlpZiAo
SU5URUxfR0VOKGk5MTUpID49IDExKSB7Cj4gKwkJaTkxNS0+ZGlzcGxheS5zZXRfY2RjbGsgPSBp
Y2xfc2V0X2NkY2xrOwo+ICsJCWk5MTUtPmRpc3BsYXkubW9kZXNldF9jYWxjX2NkY2xrID0gaWNs
X21vZGVzZXRfY2FsY19jZGNsazsKPiArCX0gZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShpOTE1KSkg
ewo+ICsJCWk5MTUtPmRpc3BsYXkuc2V0X2NkY2xrID0gY25sX3NldF9jZGNsazsKPiArCQlpOTE1
LT5kaXNwbGF5Lm1vZGVzZXRfY2FsY19jZGNsayA9IGNubF9tb2Rlc2V0X2NhbGNfY2RjbGs7Cj4g
Kwl9IGVsc2UgaWYgKElTX0dFTjlfTFAoaTkxNSkpIHsKPiArCQlpOTE1LT5kaXNwbGF5LnNldF9j
ZGNsayA9IGJ4dF9zZXRfY2RjbGs7Cj4gKwkJaTkxNS0+ZGlzcGxheS5tb2Rlc2V0X2NhbGNfY2Rj
bGsgPSBieHRfbW9kZXNldF9jYWxjX2NkY2xrOwo+ICsJfSBlbHNlIGlmIChJU19HRU45X0JDKGk5
MTUpKSB7Cj4gKwkJaTkxNS0+ZGlzcGxheS5zZXRfY2RjbGsgPSBza2xfc2V0X2NkY2xrOwo+ICsJ
CWk5MTUtPmRpc3BsYXkubW9kZXNldF9jYWxjX2NkY2xrID0gc2tsX21vZGVzZXRfY2FsY19jZGNs
azsKPiArCX0gZWxzZSBpZiAoSVNfQlJPQURXRUxMKGk5MTUpKSB7Cj4gKwkJaTkxNS0+ZGlzcGxh
eS5zZXRfY2RjbGsgPSBiZHdfc2V0X2NkY2xrOwo+ICsJCWk5MTUtPmRpc3BsYXkubW9kZXNldF9j
YWxjX2NkY2xrID0gYmR3X21vZGVzZXRfY2FsY19jZGNsazsKPiArCX0gZWxzZSBpZiAoSVNfQ0hF
UlJZVklFVyhpOTE1KSkgewo+ICsJCWk5MTUtPmRpc3BsYXkuc2V0X2NkY2xrID0gY2h2X3NldF9j
ZGNsazsKPiArCQlpOTE1LT5kaXNwbGF5Lm1vZGVzZXRfY2FsY19jZGNsayA9IHZsdl9tb2Rlc2V0
X2NhbGNfY2RjbGs7Cj4gKwl9IGVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkpIHsKPiArCQlp
OTE1LT5kaXNwbGF5LnNldF9jZGNsayA9IHZsdl9zZXRfY2RjbGs7Cj4gKwkJaTkxNS0+ZGlzcGxh
eS5tb2Rlc2V0X2NhbGNfY2RjbGsgPSB2bHZfbW9kZXNldF9jYWxjX2NkY2xrOwo+ICAgCX0KPiAg
IAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCj4gLQkJZGV2X3ByaXYtPmRpc3Bs
YXkuZ2V0X2NkY2xrID0gaWNsX2dldF9jZGNsazsKPiAtCWVsc2UgaWYgKElTX0NBTk5PTkxBS0Uo
ZGV2X3ByaXYpKQo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmdldF9jZGNsayA9IGNubF9nZXRfY2Rj
bGs7Cj4gLQllbHNlIGlmIChJU19HRU45X0xQKGRldl9wcml2KSkKPiAtCQlkZXZfcHJpdi0+ZGlz
cGxheS5nZXRfY2RjbGsgPSBieHRfZ2V0X2NkY2xrOwo+IC0JZWxzZSBpZiAoSVNfR0VOOV9CQyhk
ZXZfcHJpdikpCj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X2NkY2xrID0gc2tsX2dldF9jZGNs
azsKPiAtCWVsc2UgaWYgKElTX0JST0FEV0VMTChkZXZfcHJpdikpCj4gLQkJZGV2X3ByaXYtPmRp
c3BsYXkuZ2V0X2NkY2xrID0gYmR3X2dldF9jZGNsazsKPiAtCWVsc2UgaWYgKElTX0hBU1dFTEwo
ZGV2X3ByaXYpKQo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmdldF9jZGNsayA9IGhzd19nZXRfY2Rj
bGs7Cj4gLQllbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVX
KGRldl9wcml2KSkKPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5nZXRfY2RjbGsgPSB2bHZfZ2V0X2Nk
Y2xrOwo+IC0JZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCA2KSB8fCBJU19JVllCUklER0UoZGV2
X3ByaXYpKQo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmdldF9jZGNsayA9IGZpeGVkXzQwMG1oel9n
ZXRfY2RjbGs7Cj4gLQllbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDUpKQo+IC0JCWRldl9wcml2
LT5kaXNwbGF5LmdldF9jZGNsayA9IGZpeGVkXzQ1MG1oel9nZXRfY2RjbGs7Cj4gLQllbHNlIGlm
IChJU19HTTQ1KGRldl9wcml2KSkKPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5nZXRfY2RjbGsgPSBn
bTQ1X2dldF9jZGNsazsKPiAtCWVsc2UgaWYgKElTX0c0NShkZXZfcHJpdikpCj4gLQkJZGV2X3By
aXYtPmRpc3BsYXkuZ2V0X2NkY2xrID0gZzMzX2dldF9jZGNsazsKPiAtCWVsc2UgaWYgKElTX0k5
NjVHTShkZXZfcHJpdikpCj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X2NkY2xrID0gaTk2NWdt
X2dldF9jZGNsazsKPiAtCWVsc2UgaWYgKElTX0k5NjVHKGRldl9wcml2KSkKPiAtCQlkZXZfcHJp
di0+ZGlzcGxheS5nZXRfY2RjbGsgPSBmaXhlZF80MDBtaHpfZ2V0X2NkY2xrOwo+IC0JZWxzZSBp
ZiAoSVNfUElORVZJRVcoZGV2X3ByaXYpKQo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmdldF9jZGNs
ayA9IHBudl9nZXRfY2RjbGs7Cj4gLQllbHNlIGlmIChJU19HMzMoZGV2X3ByaXYpKQo+IC0JCWRl
dl9wcml2LT5kaXNwbGF5LmdldF9jZGNsayA9IGczM19nZXRfY2RjbGs7Cj4gLQllbHNlIGlmIChJ
U19JOTQ1R00oZGV2X3ByaXYpKQo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmdldF9jZGNsayA9IGk5
NDVnbV9nZXRfY2RjbGs7Cj4gLQllbHNlIGlmIChJU19JOTQ1RyhkZXZfcHJpdikpCj4gLQkJZGV2
X3ByaXYtPmRpc3BsYXkuZ2V0X2NkY2xrID0gZml4ZWRfNDAwbWh6X2dldF9jZGNsazsKPiAtCWVs
c2UgaWYgKElTX0k5MTVHTShkZXZfcHJpdikpCj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X2Nk
Y2xrID0gaTkxNWdtX2dldF9jZGNsazsKPiAtCWVsc2UgaWYgKElTX0k5MTVHKGRldl9wcml2KSkK
PiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5nZXRfY2RjbGsgPSBmaXhlZF8zMzNtaHpfZ2V0X2NkY2xr
Owo+IC0JZWxzZSBpZiAoSVNfSTg2NUcoZGV2X3ByaXYpKQo+IC0JCWRldl9wcml2LT5kaXNwbGF5
LmdldF9jZGNsayA9IGZpeGVkXzI2Nm1oel9nZXRfY2RjbGs7Cj4gLQllbHNlIGlmIChJU19JODVY
KGRldl9wcml2KSkKPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5nZXRfY2RjbGsgPSBpODV4X2dldF9j
ZGNsazsKPiAtCWVsc2UgaWYgKElTX0k4NDVHKGRldl9wcml2KSkKPiAtCQlkZXZfcHJpdi0+ZGlz
cGxheS5nZXRfY2RjbGsgPSBmaXhlZF8yMDBtaHpfZ2V0X2NkY2xrOwo+ICsJaWYgKElOVEVMX0dF
TihpOTE1KSA+PSAxMSkKPiArCQlpOTE1LT5kaXNwbGF5LmdldF9jZGNsayA9IGljbF9nZXRfY2Rj
bGs7Cj4gKwllbHNlIGlmIChJU19DQU5OT05MQUtFKGk5MTUpKQo+ICsJCWk5MTUtPmRpc3BsYXku
Z2V0X2NkY2xrID0gY25sX2dldF9jZGNsazsKPiArCWVsc2UgaWYgKElTX0dFTjlfTFAoaTkxNSkp
Cj4gKwkJaTkxNS0+ZGlzcGxheS5nZXRfY2RjbGsgPSBieHRfZ2V0X2NkY2xrOwo+ICsJZWxzZSBp
ZiAoSVNfR0VOOV9CQyhpOTE1KSkKPiArCQlpOTE1LT5kaXNwbGF5LmdldF9jZGNsayA9IHNrbF9n
ZXRfY2RjbGs7Cj4gKwllbHNlIGlmIChJU19CUk9BRFdFTEwoaTkxNSkpCj4gKwkJaTkxNS0+ZGlz
cGxheS5nZXRfY2RjbGsgPSBiZHdfZ2V0X2NkY2xrOwo+ICsJZWxzZSBpZiAoSVNfSEFTV0VMTChp
OTE1KSkKPiArCQlpOTE1LT5kaXNwbGF5LmdldF9jZGNsayA9IGhzd19nZXRfY2RjbGs7Cj4gKwll
bHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gKwkJ
aTkxNS0+ZGlzcGxheS5nZXRfY2RjbGsgPSB2bHZfZ2V0X2NkY2xrOwo+ICsJZWxzZSBpZiAoSVNf
R0VOKGk5MTUsIDYpIHx8IElTX0lWWUJSSURHRShpOTE1KSkKPiArCQlpOTE1LT5kaXNwbGF5Lmdl
dF9jZGNsayA9IGZpeGVkXzQwMG1oel9nZXRfY2RjbGs7Cj4gKwllbHNlIGlmIChJU19HRU4oaTkx
NSwgNSkpCj4gKwkJaTkxNS0+ZGlzcGxheS5nZXRfY2RjbGsgPSBmaXhlZF80NTBtaHpfZ2V0X2Nk
Y2xrOwo+ICsJZWxzZSBpZiAoSVNfR000NShpOTE1KSkKPiArCQlpOTE1LT5kaXNwbGF5LmdldF9j
ZGNsayA9IGdtNDVfZ2V0X2NkY2xrOwo+ICsJZWxzZSBpZiAoSVNfRzQ1KGk5MTUpKQo+ICsJCWk5
MTUtPmRpc3BsYXkuZ2V0X2NkY2xrID0gZzMzX2dldF9jZGNsazsKPiArCWVsc2UgaWYgKElTX0k5
NjVHTShpOTE1KSkKPiArCQlpOTE1LT5kaXNwbGF5LmdldF9jZGNsayA9IGk5NjVnbV9nZXRfY2Rj
bGs7Cj4gKwllbHNlIGlmIChJU19JOTY1RyhpOTE1KSkKPiArCQlpOTE1LT5kaXNwbGF5LmdldF9j
ZGNsayA9IGZpeGVkXzQwMG1oel9nZXRfY2RjbGs7Cj4gKwllbHNlIGlmIChJU19QSU5FVklFVyhp
OTE1KSkKPiArCQlpOTE1LT5kaXNwbGF5LmdldF9jZGNsayA9IHBudl9nZXRfY2RjbGs7Cj4gKwll
bHNlIGlmIChJU19HMzMoaTkxNSkpCj4gKwkJaTkxNS0+ZGlzcGxheS5nZXRfY2RjbGsgPSBnMzNf
Z2V0X2NkY2xrOwo+ICsJZWxzZSBpZiAoSVNfSTk0NUdNKGk5MTUpKQo+ICsJCWk5MTUtPmRpc3Bs
YXkuZ2V0X2NkY2xrID0gaTk0NWdtX2dldF9jZGNsazsKPiArCWVsc2UgaWYgKElTX0k5NDVHKGk5
MTUpKQo+ICsJCWk5MTUtPmRpc3BsYXkuZ2V0X2NkY2xrID0gZml4ZWRfNDAwbWh6X2dldF9jZGNs
azsKPiArCWVsc2UgaWYgKElTX0k5MTVHTShpOTE1KSkKPiArCQlpOTE1LT5kaXNwbGF5LmdldF9j
ZGNsayA9IGk5MTVnbV9nZXRfY2RjbGs7Cj4gKwllbHNlIGlmIChJU19JOTE1RyhpOTE1KSkKPiAr
CQlpOTE1LT5kaXNwbGF5LmdldF9jZGNsayA9IGZpeGVkXzMzM21oel9nZXRfY2RjbGs7Cj4gKwll
bHNlIGlmIChJU19JODY1RyhpOTE1KSkKPiArCQlpOTE1LT5kaXNwbGF5LmdldF9jZGNsayA9IGZp
eGVkXzI2Nm1oel9nZXRfY2RjbGs7Cj4gKwllbHNlIGlmIChJU19JODVYKGk5MTUpKQo+ICsJCWk5
MTUtPmRpc3BsYXkuZ2V0X2NkY2xrID0gaTg1eF9nZXRfY2RjbGs7Cj4gKwllbHNlIGlmIChJU19J
ODQ1RyhpOTE1KSkKPiArCQlpOTE1LT5kaXNwbGF5LmdldF9jZGNsayA9IGZpeGVkXzIwMG1oel9n
ZXRfY2RjbGs7Cj4gICAJZWxzZSB7IC8qIDgzMCAqLwo+IC0JCVdBUk4oIUlTX0k4MzAoZGV2X3By
aXYpLAo+ICsJCVdBUk4oIUlTX0k4MzAoaTkxNSksCj4gICAJCSAgICAgIlVua25vd24gcGxhdGZv
cm0uIEFzc3VtaW5nIDEzMyBNSHogQ0RDTEtcbiIpOwo+IC0JCWRldl9wcml2LT5kaXNwbGF5Lmdl
dF9jZGNsayA9IGZpeGVkXzEzM21oel9nZXRfY2RjbGs7Cj4gKwkJaTkxNS0+ZGlzcGxheS5nZXRf
Y2RjbGsgPSBmaXhlZF8xMzNtaHpfZ2V0X2NkY2xrOwo+ICAgCX0KPiAgIH0KPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfY2RjbGsuaCBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX2NkY2xrLmgKPiBpbmRleCA0ZDZmN2Y1Zjg5MzAuLjRlMTcxMDJhZjY2YyAxMDA2
NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jZGNsay5oCj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfY2RjbGsuaAo+IEBAIC0xOCwxMSArMTgsMTEgQEAgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGU7Cj4gICBpbnQgaW50ZWxfY3J0Y19jb21wdXRlX21pbl9jZGNs
ayhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7Cj4gICB2b2lkIGlu
dGVsX2NkY2xrX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgdm9pZCBp
bnRlbF9jZGNsa191bmluaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+IC12b2lk
IGludGVsX2luaXRfY2RjbGtfaG9va3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KTsKPiAtdm9pZCBpbnRlbF91cGRhdGVfbWF4X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdik7Cj4gLXZvaWQgaW50ZWxfdXBkYXRlX2NkY2xrKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdik7Cj4gLXZvaWQgaW50ZWxfdXBkYXRlX3Jhd2NsayhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC1ib29sIGludGVsX2NkY2xrX25lZWRzX2NkMnhf
dXBkYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArdm9pZCBpbnRlbF9p
bml0X2NkY2xrX2hvb2tzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiArdm9pZCBp
bnRlbF91cGRhdGVfbWF4X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAr
dm9pZCBpbnRlbF91cGRhdGVfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+
ICt2b2lkIGludGVsX3VwZGF0ZV9yYXdjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Owo+ICtib29sIGludGVsX2NkY2xrX25lZWRzX2NkMnhfdXBkYXRlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAo+ICAgCQkJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAq
YSwKPiAgIAkJCQkgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgKmIpOwo+ICAgYm9v
bCBpbnRlbF9jZGNsa19uZWVkc19tb2Rlc2V0KGNvbnN0IHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0
ZSAqYSwKPiBAQCAtMzEsMTIgKzMxLDEyIEBAIGJvb2wgaW50ZWxfY2RjbGtfY2hhbmdlZChjb25z
dCBzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgKmEsCj4gICAJCQkgY29uc3Qgc3RydWN0IGludGVs
X2NkY2xrX3N0YXRlICpiKTsKPiAgIHZvaWQgaW50ZWxfY2RjbGtfc3dhcF9zdGF0ZShzdHJ1Y3Qg
aW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSk7Cj4gICB2b2lkCj4gLWludGVsX3NldF9jZGNsa19w
cmVfcGxhbmVfdXBkYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAraW50
ZWxfc2V0X2NkY2xrX3ByZV9wbGFuZV91cGRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gICAJCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqb2xkX3N0YXRlLAo+
ICAgCQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgKm5ld19zdGF0ZSwKPiAgIAkJ
CQkgZW51bSBwaXBlIHBpcGUpOwo+ICAgdm9pZAo+IC1pbnRlbF9zZXRfY2RjbGtfcG9zdF9wbGFu
ZV91cGRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtpbnRlbF9zZXRf
Y2RjbGtfcG9zdF9wbGFuZV91cGRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
ICAJCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgKm9sZF9zdGF0ZSwKPiAgIAkJ
CQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqbmV3X3N0YXRlLAo+ICAgCQkJCSAg
ZW51bSBwaXBlIHBpcGUpOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9jb2xvci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfY29sb3IuYwo+IGluZGV4IDBi
OGNmM2U4Yzk2My4uZWZjNjdlNGEwYmE1IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX2NvbG9yLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jb2xv
ci5jCj4gQEAgLTEzNyw3ICsxMzcsNyBAQCBzdGF0aWMgdm9pZCBpbGtfdXBkYXRlX3BpcGVfY3Nj
KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCQkJCWNvbnN0IHUxNiBjb2VmZls5XSwKPiAg
IAkJCQljb25zdCB1MTYgcG9zdG9mZlszXSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAllbnVtIHBp
cGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gICAKPiAgIAlJOTE1X1dSSVRFKFBJUEVfQ1NDX1BSRU9G
Rl9ISShwaXBlKSwgcHJlb2ZmWzBdKTsKPiBAQCAtMTUzLDcgKzE1Myw3IEBAIHN0YXRpYyB2b2lk
IGlsa191cGRhdGVfcGlwZV9jc2Moc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gICAJSTkxNV9X
UklURShQSVBFX0NTQ19DT0VGRl9SVl9HVihwaXBlKSwgY29lZmZbNl0gPDwgMTYgfCBjb2VmZls3
XSk7Cj4gICAJSTkxNV9XUklURShQSVBFX0NTQ19DT0VGRl9CVihwaXBlKSwgY29lZmZbOF0gPDwg
MTYpOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA3KSB7Cj4gKwlpZiAoSU5U
RUxfR0VOKGk5MTUpID49IDcpIHsKPiAgIAkJSTkxNV9XUklURShQSVBFX0NTQ19QT1NUT0ZGX0hJ
KHBpcGUpLCBwb3N0b2ZmWzBdKTsKPiAgIAkJSTkxNV9XUklURShQSVBFX0NTQ19QT1NUT0ZGX01F
KHBpcGUpLCBwb3N0b2ZmWzFdKTsKPiAgIAkJSTkxNV9XUklURShQSVBFX0NTQ19QT1NUT0ZGX0xP
KHBpcGUpLCBwb3N0b2ZmWzJdKTsKPiBAQCAtMTY1LDcgKzE2NSw3IEBAIHN0YXRpYyB2b2lkIGlj
bF91cGRhdGVfb3V0cHV0X2NzYyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAkJCQkgIGNv
bnN0IHUxNiBjb2VmZls5XSwKPiAgIAkJCQkgIGNvbnN0IHUxNiBwb3N0b2ZmWzNdKQo+ICAgewo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNl
LmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+
YmFzZS5kZXYpOwo+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgIAo+ICAgCUk5
MTVfV1JJVEUoUElQRV9DU0NfT1VUUFVUX1BSRU9GRl9ISShwaXBlKSwgcHJlb2ZmWzBdKTsKPiBA
QCAtMTg4LDE1ICsxODgsMTUgQEAgc3RhdGljIHZvaWQgaWNsX3VwZGF0ZV9vdXRwdXRfY3NjKHN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCj4gICBzdGF0aWMgYm9vbCBpbGtfY3NjX2xpbWl0
ZWRfcmFuZ2UoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3Rh
dGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gICAKPiAgIAkvKgo+ICAgCSAq
IEZJWE1FIGlmIHRoZXJlJ3MgYSBnYW1tYSBMVVQgYWZ0ZXIgdGhlIENTQywgd2Ugc2hvdWxkCj4g
ICAJICogZG8gdGhlIHJhbmdlIGNvbXByZXNzaW9uIHVzaW5nIHRoZSBnYW1tYSBMVVQgaW5zdGVh
ZC4KPiAgIAkgKi8KPiAgIAlyZXR1cm4gY3J0Y19zdGF0ZS0+bGltaXRlZF9jb2xvcl9yYW5nZSAm
Jgo+IC0JCShJU19IQVNXRUxMKGRldl9wcml2KSB8fCBJU19CUk9BRFdFTEwoZGV2X3ByaXYpIHx8
Cj4gLQkJIElTX0dFTl9SQU5HRShkZXZfcHJpdiwgOSwgMTApKTsKPiArCQkoSVNfSEFTV0VMTChp
OTE1KSB8fCBJU19CUk9BRFdFTEwoaTkxNSkgfHwKPiArCQkgSVNfR0VOX1JBTkdFKGk5MTUsIDks
IDEwKSk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIGlsa19jc2NfY29udmVydF9jdG0oY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gQEAgLTI1NCw3ICsyNTQs
NyBAQCBzdGF0aWMgdm9pZCBpbGtfY3NjX2NvbnZlcnRfY3RtKGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgc3RhdGljIHZvaWQgaWxrX2xvYWRfY3NjX21hdHJp
eChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAgIAlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5j
cnRjKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGNydGMtPmJhc2UuZGV2KTsKPiAgIAlib29sIGxpbWl0ZWRfY29sb3JfcmFuZ2UgPSBpbGtfY3Nj
X2xpbWl0ZWRfcmFuZ2UoY3J0Y19zdGF0ZSk7Cj4gICAKPiAgIAlpZiAoY3J0Y19zdGF0ZS0+YmFz
ZS5jdG0pIHsKPiBAQCAtMjgwLDcgKzI4MCw3IEBAIHN0YXRpYyB2b2lkIGlsa19sb2FkX2NzY19t
YXRyaXgoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICAJCSAq
IExVVCBpcyBuZWVkZWQgYnV0IENTQyBpcyBub3Qgd2UgbmVlZCB0byBsb2FkIGFuCj4gICAJCSAq
IGlkZW50aXR5IG1hdHJpeC4KPiAgIAkJICovCj4gLQkJV0FSTl9PTighSVNfQ0FOTk9OTEFLRShk
ZXZfcHJpdikgJiYgIUlTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKTsKPiArCQlXQVJOX09OKCFJU19D
QU5OT05MQUtFKGk5MTUpICYmICFJU19HRU1JTklMQUtFKGk5MTUpKTsKPiAgIAo+ICAgCQlpbGtf
dXBkYXRlX3BpcGVfY3NjKGNydGMsIGlsa19jc2Nfb2ZmX3plcm8sCj4gICAJCQkJICAgIGlsa19j
c2NfY29lZmZfaWRlbnRpdHksCj4gQEAgLTI5Myw3ICsyOTMsNyBAQCBzdGF0aWMgdm9pZCBpbGtf
bG9hZF9jc2NfbWF0cml4KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
KQo+ICAgc3RhdGljIHZvaWQgaWNsX2xvYWRfY3NjX21hdHJpeChjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAg
IAo+ICAgCWlmIChjcnRjX3N0YXRlLT5iYXNlLmN0bSkgewo+ICAgCQl1MTYgY29lZmZbOV07Cj4g
QEAgLTMyMiw3ICszMjIsNyBAQCBzdGF0aWMgdm9pZCBpY2xfbG9hZF9jc2NfbWF0cml4KGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgc3RhdGljIHZvaWQgY2hl
cnJ5dmlld19sb2FkX2NzY19tYXRyaXgoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9j
cnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gICAJZW51bSBwaXBlIHBp
cGUgPSBjcnRjLT5waXBlOwo+ICAgCj4gICAJaWYgKGNydGNfc3RhdGUtPmJhc2UuY3RtKSB7Cj4g
QEAgLTM4OCwxNSArMzg4LDE1IEBAIHN0YXRpYyB2b2lkIGk5eHhfbG9hZF9sdXRzX2ludGVybmFs
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCQkJCSAgICBj
b25zdCBzdHJ1Y3QgZHJtX3Byb3BlcnR5X2Jsb2IgKmJsb2IpCj4gICB7Cj4gICAJc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2Uu
ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5i
YXNlLmRldik7Cj4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAgCWludCBpOwo+
ICAgCj4gLQlpZiAoSEFTX0dNQ0goZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSEFTX0dNQ0goaTkxNSkp
IHsKPiAgIAkJaWYgKGludGVsX2NydGNfaGFzX3R5cGUoY3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVU
X0RTSSkpCj4gLQkJCWFzc2VydF9kc2lfcGxsX2VuYWJsZWQoZGV2X3ByaXYpOwo+ICsJCQlhc3Nl
cnRfZHNpX3BsbF9lbmFibGVkKGk5MTUpOwo+ICAgCQllbHNlCj4gLQkJCWFzc2VydF9wbGxfZW5h
YmxlZChkZXZfcHJpdiwgcGlwZSk7Cj4gKwkJCWFzc2VydF9wbGxfZW5hYmxlZChpOTE1LCBwaXBl
KTsKPiAgIAl9Cj4gICAKPiAgIAlpZiAoYmxvYikgewo+IEBAIC00MDgsNyArNDA4LDcgQEAgc3Rh
dGljIHZvaWQgaTl4eF9sb2FkX2x1dHNfaW50ZXJuYWwoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUsCj4gICAJCQkJKGRybV9jb2xvcl9sdXRfZXh0cmFjdChsdXRbaV0u
Z3JlZW4sIDgpIDw8IDgpIHwKPiAgIAkJCQlkcm1fY29sb3JfbHV0X2V4dHJhY3QobHV0W2ldLmJs
dWUsIDgpOwo+ICAgCj4gLQkJCWlmIChIQVNfR01DSChkZXZfcHJpdikpCj4gKwkJCWlmIChIQVNf
R01DSChpOTE1KSkKPiAgIAkJCQlJOTE1X1dSSVRFKFBBTEVUVEUocGlwZSwgaSksIHdvcmQpOwo+
ICAgCQkJZWxzZQo+ICAgCQkJCUk5MTVfV1JJVEUoTEdDX1BBTEVUVEUocGlwZSwgaSksIHdvcmQp
Owo+IEBAIC00MjQsNyArNDI0LDcgQEAgc3RhdGljIHZvaWQgaTl4eF9sb2FkX2x1dHMoY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICBzdGF0aWMgdm9pZCBpOXh4
X2NvbG9yX2NvbW1pdChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkK
PiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19z
dGF0ZS0+YmFzZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMt
PnBpcGU7Cj4gICAJdTMyIHZhbDsKPiAgIAo+IEBAIC00MzcsNyArNDM3LDcgQEAgc3RhdGljIHZv
aWQgaTl4eF9jb2xvcl9jb21taXQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUpCj4gICBzdGF0aWMgdm9pZCBpbGtfY29sb3JfY29tbWl0KGNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+
ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgIAl1MzIgdmFsOwo+ICAgCj4gQEAg
LTQ1Miw3ICs0NTIsNyBAQCBzdGF0aWMgdm9pZCBpbGtfY29sb3JfY29tbWl0KGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgc3RhdGljIHZvaWQgaHN3X2NvbG9y
X2NvbW1pdChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsK
PiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+
YmFzZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAo+ICAgCUk5MTVfV1JJVEUoR0FNTUFfTU9ERShj
cnRjLT5waXBlKSwgY3J0Y19zdGF0ZS0+Z2FtbWFfbW9kZSk7Cj4gICAKPiBAQCAtNDYyLDcgKzQ2
Miw3IEBAIHN0YXRpYyB2b2lkIGhzd19jb2xvcl9jb21taXQoY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICBzdGF0aWMgdm9pZCBza2xfY29sb3JfY29tbWl0KGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgewo+ICAgCXN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMp
Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5i
YXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwo+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgIAl1MzIg
dmFsID0gMDsKPiAgIAo+IEBAIC00NzksNyArNDc5LDcgQEAgc3RhdGljIHZvaWQgc2tsX2NvbG9y
X2NvbW1pdChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIAo+
ICAgCUk5MTVfV1JJVEUoR0FNTUFfTU9ERShjcnRjLT5waXBlKSwgY3J0Y19zdGF0ZS0+Z2FtbWFf
bW9kZSk7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQo+ICsJaWYgKElO
VEVMX0dFTihpOTE1KSA+PSAxMSkKPiAgIAkJaWNsX2xvYWRfY3NjX21hdHJpeChjcnRjX3N0YXRl
KTsKPiAgIAllbHNlCj4gICAJCWlsa19sb2FkX2NzY19tYXRyaXgoY3J0Y19zdGF0ZSk7Cj4gQEAg
LTQ4OCw3ICs0ODgsNyBAQCBzdGF0aWMgdm9pZCBza2xfY29sb3JfY29tbWl0KGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgc3RhdGljIHZvaWQgaTk2NV9sb2Fk
X2x1dF8xMHA2KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCQkJICAgICAgIGNvbnN0IHN0
cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqYmxvYikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAljb25z
dCBzdHJ1Y3QgZHJtX2NvbG9yX2x1dCAqbHV0ID0gYmxvYi0+ZGF0YTsKPiAgIAlpbnQgaSwgbHV0
X3NpemUgPSBkcm1fY29sb3JfbHV0X3NpemUoYmxvYik7Cj4gICAJZW51bSBwaXBlIHBpcGUgPSBj
cnRjLT5waXBlOwo+IEBAIC01MTksNyArNTE5LDcgQEAgc3RhdGljIHZvaWQgaTk2NV9sb2FkX2x1
dHMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICBzdGF0aWMg
dm9pZCBpbGtfbG9hZF9sdXRfMTAoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gICAJCQkgICAg
Y29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpibG9iKQo+ICAgewo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+
ICAgCWNvbnN0IHN0cnVjdCBkcm1fY29sb3JfbHV0ICpsdXQgPSBibG9iLT5kYXRhOwo+ICAgCWlu
dCBpLCBsdXRfc2l6ZSA9IGRybV9jb2xvcl9sdXRfc2l6ZShibG9iKTsKPiAgIAllbnVtIHBpcGUg
cGlwZSA9IGNydGMtPnBpcGU7Cj4gQEAgLTU1Niw3ICs1NTYsNyBAQCBzdGF0aWMgdm9pZCBpdmJf
bG9hZF9sdXRfMTAoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gICAJCQkgICAgY29uc3Qgc3Ry
dWN0IGRybV9wcm9wZXJ0eV9ibG9iICpibG9iLAo+ICAgCQkJICAgIHUzMiBwcmVjX2luZGV4KQo+
ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
Y3J0Yy0+YmFzZS5kZXYpOwo+ICAgCWludCBod19sdXRfc2l6ZSA9IGl2Yl9sdXRfMTBfc2l6ZShw
cmVjX2luZGV4KTsKPiAgIAljb25zdCBzdHJ1Y3QgZHJtX2NvbG9yX2x1dCAqbHV0ID0gYmxvYi0+
ZGF0YTsKPiAgIAlpbnQgaSwgbHV0X3NpemUgPSBkcm1fY29sb3JfbHV0X3NpemUoYmxvYik7Cj4g
QEAgLTU4Myw3ICs1ODMsNyBAQCBzdGF0aWMgdm9pZCBiZHdfbG9hZF9sdXRfMTAoc3RydWN0IGlu
dGVsX2NydGMgKmNydGMsCj4gICAJCQkgICAgY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9i
ICpibG9iLAo+ICAgCQkJICAgIHUzMiBwcmVjX2luZGV4KQo+ICAgewo+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAg
CWludCBod19sdXRfc2l6ZSA9IGl2Yl9sdXRfMTBfc2l6ZShwcmVjX2luZGV4KTsKPiAgIAljb25z
dCBzdHJ1Y3QgZHJtX2NvbG9yX2x1dCAqbHV0ID0gYmxvYi0+ZGF0YTsKPiAgIAlpbnQgaSwgbHV0
X3NpemUgPSBkcm1fY29sb3JfbHV0X3NpemUoYmxvYik7Cj4gQEAgLTYwOSw3ICs2MDksNyBAQCBz
dGF0aWMgdm9pZCBiZHdfbG9hZF9sdXRfMTAoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gICAK
PiAgIHN0YXRpYyB2b2lkIGl2Yl9sb2FkX2x1dF8xMF9tYXgoc3RydWN0IGludGVsX2NydGMgKmNy
dGMpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShjcnRjLT5iYXNlLmRldik7Cj4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+
ICAgCj4gICAJLyogUHJvZ3JhbSB0aGUgbWF4IHJlZ2lzdGVyIHRvIGNsYW1wIHZhbHVlcyA+IDEu
MC4gKi8KPiBAQCAtNjIyLDcgKzYyMiw3IEBAIHN0YXRpYyB2b2lkIGl2Yl9sb2FkX2x1dF8xMF9t
YXgoc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gICAJICogVG9EbzogRXh0ZW5kIHRoZSBBQkkg
dG8gYmUgYWJsZSB0byBwcm9ncmFtIHZhbHVlcwo+ICAgCSAqIGZyb20gMy4wIHRvIDcuMAo+ICAg
CSAqLwo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgfHwgSVNfR0VNSU5JTEFLRShk
ZXZfcHJpdikpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTAgfHwgSVNfR0VNSU5JTEFL
RShpOTE1KSkgewo+ICAgCQlJOTE1X1dSSVRFKFBSRUNfUEFMX0VYVDJfR0NfTUFYKHBpcGUsIDAp
LCAxIDw8IDE2KTsKPiAgIAkJSTkxNV9XUklURShQUkVDX1BBTF9FWFQyX0dDX01BWChwaXBlLCAx
KSwgMSA8PCAxNik7Cj4gICAJCUk5MTVfV1JJVEUoUFJFQ19QQUxfRVhUMl9HQ19NQVgocGlwZSwg
MiksIDEgPDwgMTYpOwo+IEBAIC02NzgsOSArNjc4LDkgQEAgc3RhdGljIHZvaWQgYmR3X2xvYWRf
bHV0cyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHN0YXRp
YyB2b2lkIGdsa19sb2FkX2RlZ2FtbWFfbHV0KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50
ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAgCWVudW0gcGlw
ZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAtCWNvbnN0IHUzMiBsdXRfc2l6ZSA9IElOVEVMX0lORk8o
ZGV2X3ByaXYpLT5jb2xvci5kZWdhbW1hX2x1dF9zaXplOwo+ICsJY29uc3QgdTMyIGx1dF9zaXpl
ID0gSU5URUxfSU5GTyhpOTE1KS0+Y29sb3IuZGVnYW1tYV9sdXRfc2l6ZTsKPiAgIAljb25zdCBz
dHJ1Y3QgZHJtX2NvbG9yX2x1dCAqbHV0ID0gY3J0Y19zdGF0ZS0+YmFzZS5kZWdhbW1hX2x1dC0+
ZGF0YTsKPiAgIAl1MzIgaTsKPiAgIAo+IEBAIC03MTcsOSArNzE3LDkgQEAgc3RhdGljIHZvaWQg
Z2xrX2xvYWRfZGVnYW1tYV9sdXQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUpCj4gICBzdGF0aWMgdm9pZCBnbGtfbG9hZF9kZWdhbW1hX2x1dF9saW5lYXIoY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2Uu
ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5i
YXNlLmRldik7Cj4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+IC0JY29uc3QgdTMy
IGx1dF9zaXplID0gSU5URUxfSU5GTyhkZXZfcHJpdiktPmNvbG9yLmRlZ2FtbWFfbHV0X3NpemU7
Cj4gKwljb25zdCB1MzIgbHV0X3NpemUgPSBJTlRFTF9JTkZPKGk5MTUpLT5jb2xvci5kZWdhbW1h
X2x1dF9zaXplOwo+ICAgCXUzMiBpOwo+ICAgCj4gICAJLyoKPiBAQCAtNzk4LDcgKzc5OCw3IEBA
IHN0YXRpYyB1MzIgY2h2X2NnbV9kZWdhbW1hX3Vkdyhjb25zdCBzdHJ1Y3QgZHJtX2NvbG9yX2x1
dCAqY29sb3IpCj4gICBzdGF0aWMgdm9pZCBjaHZfbG9hZF9jZ21fZGVnYW1tYShzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YywKPiAgIAkJCQkgY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpi
bG9iKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAgCWNvbnN0IHN0cnVjdCBkcm1fY29sb3JfbHV0ICps
dXQgPSBibG9iLT5kYXRhOwo+ICAgCWludCBpLCBsdXRfc2l6ZSA9IGRybV9jb2xvcl9sdXRfc2l6
ZShibG9iKTsKPiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gQEAgLTgyNSw3ICs4
MjUsNyBAQCBzdGF0aWMgdTMyIGNodl9jZ21fZ2FtbWFfdWR3KGNvbnN0IHN0cnVjdCBkcm1fY29s
b3JfbHV0ICpjb2xvcikKPiAgIHN0YXRpYyB2b2lkIGNodl9sb2FkX2NnbV9nYW1tYShzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YywKPiAgIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgZHJtX3Byb3BlcnR5
X2Jsb2IgKmJsb2IpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gICAJY29uc3Qgc3RydWN0IGRybV9jb2xv
cl9sdXQgKmx1dCA9IGJsb2ItPmRhdGE7Cj4gICAJaW50IGksIGx1dF9zaXplID0gZHJtX2NvbG9y
X2x1dF9zaXplKGJsb2IpOwo+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiBAQCAt
ODYwLDM3ICs4NjAsMzcgQEAgc3RhdGljIHZvaWQgY2h2X2xvYWRfbHV0cyhjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIAo+ICAgdm9pZCBpbnRlbF9jb2xvcl9s
b2FkX2x1dHMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3Rh
dGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gICAKPiAtCWRldl9wcml2LT5k
aXNwbGF5LmxvYWRfbHV0cyhjcnRjX3N0YXRlKTsKPiArCWk5MTUtPmRpc3BsYXkubG9hZF9sdXRz
KGNydGNfc3RhdGUpOwo+ICAgfQo+ICAgCj4gICB2b2lkIGludGVsX2NvbG9yX2NvbW1pdChjb25z
dCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRj
LT5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGNf
c3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiAgIAo+IC0JZGV2X3ByaXYtPmRpc3BsYXkuY29sb3Jf
Y29tbWl0KGNydGNfc3RhdGUpOwo+ICsJaTkxNS0+ZGlzcGxheS5jb2xvcl9jb21taXQoY3J0Y19z
dGF0ZSk7Cj4gICB9Cj4gICAKPiAgIGludCBpbnRlbF9jb2xvcl9jaGVjayhzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0
Yy0+ZGV2KTsKPiAgIAo+IC0JcmV0dXJuIGRldl9wcml2LT5kaXNwbGF5LmNvbG9yX2NoZWNrKGNy
dGNfc3RhdGUpOwo+ICsJcmV0dXJuIGk5MTUtPmRpc3BsYXkuY29sb3JfY2hlY2soY3J0Y19zdGF0
ZSk7Cj4gICB9Cj4gICAKPiAgIHZvaWQgaW50ZWxfY29sb3JfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2Uu
Y3J0Yy0+ZGV2KTsKPiAgIAo+IC0JaWYgKGRldl9wcml2LT5kaXNwbGF5LnJlYWRfbHV0cykKPiAt
CQlkZXZfcHJpdi0+ZGlzcGxheS5yZWFkX2x1dHMoY3J0Y19zdGF0ZSk7Cj4gKwlpZiAoaTkxNS0+
ZGlzcGxheS5yZWFkX2x1dHMpCj4gKwkJaTkxNS0+ZGlzcGxheS5yZWFkX2x1dHMoY3J0Y19zdGF0
ZSk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBib29sIG5lZWRfcGxhbmVfdXBkYXRlKHN0cnVjdCBp
bnRlbF9wbGFuZSAqcGxhbmUsCj4gICAJCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ICAgCj4gICAJLyoKPiAgIAkg
KiBPbiBwcmUtU0tMIHRoZSBwaXBlIGdhbW1hIGVuYWJsZSBhbmQgcGlwZSBjc2MgZW5hYmxlIGZv
cgo+IEBAIC04OTgsNyArODk4LDcgQEAgc3RhdGljIGJvb2wgbmVlZF9wbGFuZV91cGRhdGUoc3Ry
dWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiAgIAkgKiBXZSBoYXZlIHRvIHJlY29uZmlndXJlIHRo
YXQgZXZlbiBpZiB0aGUgcGxhbmUgaXMgaW5hY3RpdmUuCj4gICAJICovCj4gICAJcmV0dXJuIGNy
dGNfc3RhdGUtPmFjdGl2ZV9wbGFuZXMgJiBCSVQocGxhbmUtPmlkKSB8fAo+IC0JCShJTlRFTF9H
RU4oZGV2X3ByaXYpIDwgOSAmJgo+ICsJCShJTlRFTF9HRU4oaTkxNSkgPCA5ICYmCj4gICAJCSBw
bGFuZS0+aWQgPT0gUExBTkVfUFJJTUFSWSk7Cj4gICB9Cj4gICAKPiBAQCAtOTA2LDcgKzkwNiw3
IEBAIHN0YXRpYyBpbnQKPiAgIGludGVsX2NvbG9yX2FkZF9hZmZlY3RlZF9wbGFuZXMoc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhuZXdfY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFz
ZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMt
PmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSA9Cj4gICAJ
CXRvX2ludGVsX2F0b21pY19zdGF0ZShuZXdfY3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZSk7Cj4gICAJ
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlID0KPiBAQCAtOTIx
LDcgKzkyMSw3IEBAIGludGVsX2NvbG9yX2FkZF9hZmZlY3RlZF9wbGFuZXMoc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+ICAgCSAgICBuZXdfY3J0Y19zdGF0ZS0+Y3Nj
X2VuYWJsZSA9PSBvbGRfY3J0Y19zdGF0ZS0+Y3NjX2VuYWJsZSkKPiAgIAkJcmV0dXJuIDA7Cj4g
ICAKPiAtCWZvcl9lYWNoX2ludGVsX3BsYW5lX29uX2NydGMoJmRldl9wcml2LT5kcm0sIGNydGMs
IHBsYW5lKSB7Cj4gKwlmb3JfZWFjaF9pbnRlbF9wbGFuZV9vbl9jcnRjKCZpOTE1LT5kcm0sIGNy
dGMsIHBsYW5lKSB7Cj4gICAJCXN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGU7
Cj4gICAKPiAgIAkJaWYgKCFuZWVkX3BsYW5lX3VwZGF0ZShwbGFuZSwgbmV3X2NydGNfc3RhdGUp
KQo+IEBAIC05NTYsNyArOTU2LDcgQEAgc3RhdGljIGludCBjaGVja19sdXRfc2l6ZShjb25zdCBz
dHJ1Y3QgZHJtX3Byb3BlcnR5X2Jsb2IgKmx1dCwgaW50IGV4cGVjdGVkKQo+ICAgCj4gICBzdGF0
aWMgaW50IGNoZWNrX2x1dHMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gICAJY29uc3Qg
c3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpnYW1tYV9sdXQgPSBjcnRjX3N0YXRlLT5iYXNlLmdh
bW1hX2x1dDsKPiAgIAljb25zdCBzdHJ1Y3QgZHJtX3Byb3BlcnR5X2Jsb2IgKmRlZ2FtbWFfbHV0
ID0gY3J0Y19zdGF0ZS0+YmFzZS5kZWdhbW1hX2x1dDsKPiAgIAlpbnQgZ2FtbWFfbGVuZ3RoLCBk
ZWdhbW1hX2xlbmd0aDsKPiBAQCAtOTcyLDEwICs5NzIsMTAgQEAgc3RhdGljIGludCBjaGVja19s
dXRzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgCQlyZXR1
cm4gLUVJTlZBTDsKPiAgIAl9Cj4gICAKPiAtCWRlZ2FtbWFfbGVuZ3RoID0gSU5URUxfSU5GTyhk
ZXZfcHJpdiktPmNvbG9yLmRlZ2FtbWFfbHV0X3NpemU7Cj4gLQlnYW1tYV9sZW5ndGggPSBJTlRF
TF9JTkZPKGRldl9wcml2KS0+Y29sb3IuZ2FtbWFfbHV0X3NpemU7Cj4gLQlkZWdhbW1hX3Rlc3Rz
ID0gSU5URUxfSU5GTyhkZXZfcHJpdiktPmNvbG9yLmRlZ2FtbWFfbHV0X3Rlc3RzOwo+IC0JZ2Ft
bWFfdGVzdHMgPSBJTlRFTF9JTkZPKGRldl9wcml2KS0+Y29sb3IuZ2FtbWFfbHV0X3Rlc3RzOwo+
ICsJZGVnYW1tYV9sZW5ndGggPSBJTlRFTF9JTkZPKGk5MTUpLT5jb2xvci5kZWdhbW1hX2x1dF9z
aXplOwo+ICsJZ2FtbWFfbGVuZ3RoID0gSU5URUxfSU5GTyhpOTE1KS0+Y29sb3IuZ2FtbWFfbHV0
X3NpemU7Cj4gKwlkZWdhbW1hX3Rlc3RzID0gSU5URUxfSU5GTyhpOTE1KS0+Y29sb3IuZGVnYW1t
YV9sdXRfdGVzdHM7Cj4gKwlnYW1tYV90ZXN0cyA9IElOVEVMX0lORk8oaTkxNSktPmNvbG9yLmdh
bW1hX2x1dF90ZXN0czsKPiAgIAo+ICAgCWlmIChjaGVja19sdXRfc2l6ZShkZWdhbW1hX2x1dCwg
ZGVnYW1tYV9sZW5ndGgpIHx8Cj4gICAJICAgIGNoZWNrX2x1dF9zaXplKGdhbW1hX2x1dCwgZ2Ft
bWFfbGVuZ3RoKSkKPiBAQCAtMTI1NSw1NiArMTI1NSw1NiBAQCBzdGF0aWMgaW50IGljbF9jb2xv
cl9jaGVjayhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIAo+ICAgdm9p
ZCBpbnRlbF9jb2xvcl9pbml0KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+ICAgewo+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7
Cj4gLQlib29sIGhhc19jdG0gPSBJTlRFTF9JTkZPKGRldl9wcml2KS0+Y29sb3IuZGVnYW1tYV9s
dXRfc2l6ZSAhPSAwOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGNydGMtPmJhc2UuZGV2KTsKPiArCWJvb2wgaGFzX2N0bSA9IElOVEVMX0lORk8oaTkxNSktPmNv
bG9yLmRlZ2FtbWFfbHV0X3NpemUgIT0gMDsKPiAgIAo+ICAgCWRybV9tb2RlX2NydGNfc2V0X2dh
bW1hX3NpemUoJmNydGMtPmJhc2UsIDI1Nik7Cj4gICAKPiAtCWlmIChIQVNfR01DSChkZXZfcHJp
dikpIHsKPiAtCQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiAtCQkJZGV2X3ByaXYt
PmRpc3BsYXkuY29sb3JfY2hlY2sgPSBjaHZfY29sb3JfY2hlY2s7Cj4gLQkJCWRldl9wcml2LT5k
aXNwbGF5LmNvbG9yX2NvbW1pdCA9IGk5eHhfY29sb3JfY29tbWl0Owo+IC0JCQlkZXZfcHJpdi0+
ZGlzcGxheS5sb2FkX2x1dHMgPSBjaHZfbG9hZF9sdXRzOwo+IC0JCX0gZWxzZSBpZiAoSU5URUxf
R0VOKGRldl9wcml2KSA+PSA0KSB7Cj4gLQkJCWRldl9wcml2LT5kaXNwbGF5LmNvbG9yX2NoZWNr
ID0gaTl4eF9jb2xvcl9jaGVjazsKPiAtCQkJZGV2X3ByaXYtPmRpc3BsYXkuY29sb3JfY29tbWl0
ID0gaTl4eF9jb2xvcl9jb21taXQ7Cj4gLQkJCWRldl9wcml2LT5kaXNwbGF5LmxvYWRfbHV0cyA9
IGk5NjVfbG9hZF9sdXRzOwo+ICsJaWYgKEhBU19HTUNIKGk5MTUpKSB7Cj4gKwkJaWYgKElTX0NI
RVJSWVZJRVcoaTkxNSkpIHsKPiArCQkJaTkxNS0+ZGlzcGxheS5jb2xvcl9jaGVjayA9IGNodl9j
b2xvcl9jaGVjazsKPiArCQkJaTkxNS0+ZGlzcGxheS5jb2xvcl9jb21taXQgPSBpOXh4X2NvbG9y
X2NvbW1pdDsKPiArCQkJaTkxNS0+ZGlzcGxheS5sb2FkX2x1dHMgPSBjaHZfbG9hZF9sdXRzOwo+
ICsJCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDQpIHsKPiArCQkJaTkxNS0+ZGlzcGxh
eS5jb2xvcl9jaGVjayA9IGk5eHhfY29sb3JfY2hlY2s7Cj4gKwkJCWk5MTUtPmRpc3BsYXkuY29s
b3JfY29tbWl0ID0gaTl4eF9jb2xvcl9jb21taXQ7Cj4gKwkJCWk5MTUtPmRpc3BsYXkubG9hZF9s
dXRzID0gaTk2NV9sb2FkX2x1dHM7Cj4gICAJCX0gZWxzZSB7Cj4gLQkJCWRldl9wcml2LT5kaXNw
bGF5LmNvbG9yX2NoZWNrID0gaTl4eF9jb2xvcl9jaGVjazsKPiAtCQkJZGV2X3ByaXYtPmRpc3Bs
YXkuY29sb3JfY29tbWl0ID0gaTl4eF9jb2xvcl9jb21taXQ7Cj4gLQkJCWRldl9wcml2LT5kaXNw
bGF5LmxvYWRfbHV0cyA9IGk5eHhfbG9hZF9sdXRzOwo+ICsJCQlpOTE1LT5kaXNwbGF5LmNvbG9y
X2NoZWNrID0gaTl4eF9jb2xvcl9jaGVjazsKPiArCQkJaTkxNS0+ZGlzcGxheS5jb2xvcl9jb21t
aXQgPSBpOXh4X2NvbG9yX2NvbW1pdDsKPiArCQkJaTkxNS0+ZGlzcGxheS5sb2FkX2x1dHMgPSBp
OXh4X2xvYWRfbHV0czsKPiAgIAkJfQo+ICAgCX0gZWxzZSB7Cj4gLQkJaWYgKElOVEVMX0dFTihk
ZXZfcHJpdikgPj0gMTEpCj4gLQkJCWRldl9wcml2LT5kaXNwbGF5LmNvbG9yX2NoZWNrID0gaWNs
X2NvbG9yX2NoZWNrOwo+IC0JCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgfHwg
SVNfR0VNSU5JTEFLRShkZXZfcHJpdikpCj4gLQkJCWRldl9wcml2LT5kaXNwbGF5LmNvbG9yX2No
ZWNrID0gZ2xrX2NvbG9yX2NoZWNrOwo+IC0JCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gNykKPiAtCQkJZGV2X3ByaXYtPmRpc3BsYXkuY29sb3JfY2hlY2sgPSBpdmJfY29sb3JfY2hl
Y2s7Cj4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiArCQkJaTkxNS0+ZGlzcGxheS5j
b2xvcl9jaGVjayA9IGljbF9jb2xvcl9jaGVjazsKPiArCQllbHNlIGlmIChJTlRFTF9HRU4oaTkx
NSkgPj0gMTAgfHwgSVNfR0VNSU5JTEFLRShpOTE1KSkKPiArCQkJaTkxNS0+ZGlzcGxheS5jb2xv
cl9jaGVjayA9IGdsa19jb2xvcl9jaGVjazsKPiArCQllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkg
Pj0gNykKPiArCQkJaTkxNS0+ZGlzcGxheS5jb2xvcl9jaGVjayA9IGl2Yl9jb2xvcl9jaGVjazsK
PiAgIAkJZWxzZQo+IC0JCQlkZXZfcHJpdi0+ZGlzcGxheS5jb2xvcl9jaGVjayA9IGlsa19jb2xv
cl9jaGVjazsKPiArCQkJaTkxNS0+ZGlzcGxheS5jb2xvcl9jaGVjayA9IGlsa19jb2xvcl9jaGVj
azsKPiAgIAo+IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gLQkJCWRldl9wcml2
LT5kaXNwbGF5LmNvbG9yX2NvbW1pdCA9IHNrbF9jb2xvcl9jb21taXQ7Cj4gLQkJZWxzZSBpZiAo
SVNfQlJPQURXRUxMKGRldl9wcml2KSB8fCBJU19IQVNXRUxMKGRldl9wcml2KSkKPiAtCQkJZGV2
X3ByaXYtPmRpc3BsYXkuY29sb3JfY29tbWl0ID0gaHN3X2NvbG9yX2NvbW1pdDsKPiArCQlpZiAo
SU5URUxfR0VOKGk5MTUpID49IDkpCj4gKwkJCWk5MTUtPmRpc3BsYXkuY29sb3JfY29tbWl0ID0g
c2tsX2NvbG9yX2NvbW1pdDsKPiArCQllbHNlIGlmIChJU19CUk9BRFdFTEwoaTkxNSkgfHwgSVNf
SEFTV0VMTChpOTE1KSkKPiArCQkJaTkxNS0+ZGlzcGxheS5jb2xvcl9jb21taXQgPSBoc3dfY29s
b3JfY29tbWl0Owo+ICAgCQllbHNlCj4gLQkJCWRldl9wcml2LT5kaXNwbGF5LmNvbG9yX2NvbW1p
dCA9IGlsa19jb2xvcl9jb21taXQ7Cj4gLQo+IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDExKQo+IC0JCQlkZXZfcHJpdi0+ZGlzcGxheS5sb2FkX2x1dHMgPSBpY2xfbG9hZF9sdXRzOwo+
IC0JCWVsc2UgaWYgKElTX0NBTk5PTkxBS0UoZGV2X3ByaXYpIHx8IElTX0dFTUlOSUxBS0UoZGV2
X3ByaXYpKQo+IC0JCQlkZXZfcHJpdi0+ZGlzcGxheS5sb2FkX2x1dHMgPSBnbGtfbG9hZF9sdXRz
Owo+IC0JCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOCkKPiAtCQkJZGV2X3ByaXYt
PmRpc3BsYXkubG9hZF9sdXRzID0gYmR3X2xvYWRfbHV0czsKPiAtCQllbHNlIGlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDcpCj4gLQkJCWRldl9wcml2LT5kaXNwbGF5LmxvYWRfbHV0cyA9IGl2
Yl9sb2FkX2x1dHM7Cj4gKwkJCWk5MTUtPmRpc3BsYXkuY29sb3JfY29tbWl0ID0gaWxrX2NvbG9y
X2NvbW1pdDsKPiArCj4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiArCQkJaTkxNS0+
ZGlzcGxheS5sb2FkX2x1dHMgPSBpY2xfbG9hZF9sdXRzOwo+ICsJCWVsc2UgaWYgKElTX0NBTk5P
TkxBS0UoaTkxNSkgfHwgSVNfR0VNSU5JTEFLRShpOTE1KSkKPiArCQkJaTkxNS0+ZGlzcGxheS5s
b2FkX2x1dHMgPSBnbGtfbG9hZF9sdXRzOwo+ICsJCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+
PSA4KQo+ICsJCQlpOTE1LT5kaXNwbGF5LmxvYWRfbHV0cyA9IGJkd19sb2FkX2x1dHM7Cj4gKwkJ
ZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDcpCj4gKwkJCWk5MTUtPmRpc3BsYXkubG9hZF9s
dXRzID0gaXZiX2xvYWRfbHV0czsKPiAgIAkJZWxzZQo+IC0JCQlkZXZfcHJpdi0+ZGlzcGxheS5s
b2FkX2x1dHMgPSBpbGtfbG9hZF9sdXRzOwo+ICsJCQlpOTE1LT5kaXNwbGF5LmxvYWRfbHV0cyA9
IGlsa19sb2FkX2x1dHM7Cj4gICAJfQo+ICAgCj4gICAJZHJtX2NydGNfZW5hYmxlX2NvbG9yX21n
bXQoJmNydGMtPmJhc2UsCj4gLQkJCQkgICBJTlRFTF9JTkZPKGRldl9wcml2KS0+Y29sb3IuZGVn
YW1tYV9sdXRfc2l6ZSwKPiArCQkJCSAgIElOVEVMX0lORk8oaTkxNSktPmNvbG9yLmRlZ2FtbWFf
bHV0X3NpemUsCj4gICAJCQkJICAgaGFzX2N0bSwKPiAtCQkJCSAgIElOVEVMX0lORk8oZGV2X3By
aXYpLT5jb2xvci5nYW1tYV9sdXRfc2l6ZSk7Cj4gKwkJCQkgICBJTlRFTF9JTkZPKGk5MTUpLT5j
b2xvci5nYW1tYV9sdXRfc2l6ZSk7Cj4gICB9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX2NvbWJvX3BoeS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfY29t
Ym9fcGh5LmMKPiBpbmRleCA4NDE3MDhkYTVhNTYuLjBlN2MxOGQ3ODNjYSAxMDA2NDQKPiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jb21ib19waHkuYwo+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX2NvbWJvX3BoeS5jCj4gQEAgLTQ0LDcgKzQ0LDcgQEAgc3RhdGlj
IGNvbnN0IHN0cnVjdCBjbmxfcHJvY21vbiB7Cj4gICAgKiBvbiBpdHMgbmFtZS4KPiAgICAqLwo+
ICAgc3RhdGljIGNvbnN0IHN0cnVjdCBjbmxfcHJvY21vbiAqCj4gLWNubF9nZXRfcHJvY21vbl9y
ZWZfdmFsdWVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBv
cnQpCj4gK2NubF9nZXRfcHJvY21vbl9yZWZfdmFsdWVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LCBlbnVtIHBvcnQgcG9ydCkKPiAgIHsKPiAgIAljb25zdCBzdHJ1Y3QgY25sX3Byb2Nt
b24gKnByb2Ntb247Cj4gICAJdTMyIHZhbDsKPiBAQCAtNzQsMTMgKzc0LDEzIEBAIGNubF9nZXRf
cHJvY21vbl9yZWZfdmFsdWVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51
bSBwb3J0IHBvcnQpCj4gICAJcmV0dXJuIHByb2Ntb247Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZv
aWQgY25sX3NldF9wcm9jbW9uX3JlZl92YWx1ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ICtzdGF0aWMgdm9pZCBjbmxfc2V0X3Byb2Ntb25fcmVmX3ZhbHVlcyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAgICAgZW51bSBwb3J0IHBvcnQpCj4g
ICB7Cj4gICAJY29uc3Qgc3RydWN0IGNubF9wcm9jbW9uICpwcm9jbW9uOwo+ICAgCXUzMiB2YWw7
Cj4gICAKPiAtCXByb2Ntb24gPSBjbmxfZ2V0X3Byb2Ntb25fcmVmX3ZhbHVlcyhkZXZfcHJpdiwg
cG9ydCk7Cj4gKwlwcm9jbW9uID0gY25sX2dldF9wcm9jbW9uX3JlZl92YWx1ZXMoaTkxNSwgcG9y
dCk7Cj4gICAKPiAgIAl2YWwgPSBJOTE1X1JFQUQoSUNMX1BPUlRfQ09NUF9EVzEocG9ydCkpOwo+
ICAgCXZhbCAmPSB+KCgweGZmIDw8IDE2KSB8IDB4ZmYpOwo+IEBAIC05MSw3ICs5MSw3IEBAIHN0
YXRpYyB2b2lkIGNubF9zZXRfcHJvY21vbl9yZWZfdmFsdWVzKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiAgIAlJOTE1X1dSSVRFKElDTF9QT1JUX0NPTVBfRFcxMChwb3J0KSwg
cHJvY21vbi0+ZHcxMCk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGJvb2wgY2hlY2tfcGh5X3JlZyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBib29sIGNoZWNrX3Bo
eV9yZWcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgIGVudW0gcG9ydCBw
b3J0LCBpOTE1X3JlZ190IHJlZywgdTMyIG1hc2ssCj4gICAJCQkgIHUzMiBleHBlY3RlZF92YWwp
Cj4gICB7Cj4gQEAgLTEwOCw0NyArMTA4LDQ3IEBAIHN0YXRpYyBib29sIGNoZWNrX3BoeV9yZWco
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCXJldHVybiB0cnVlOwo+ICAg
fQo+ICAgCj4gLXN0YXRpYyBib29sIGNubF92ZXJpZnlfcHJvY21vbl9yZWZfdmFsdWVzKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIGJvb2wgY25sX3ZlcmlmeV9w
cm9jbW9uX3JlZl92YWx1ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJ
CSAgZW51bSBwb3J0IHBvcnQpCj4gICB7Cj4gICAJY29uc3Qgc3RydWN0IGNubF9wcm9jbW9uICpw
cm9jbW9uOwo+ICAgCWJvb2wgcmV0Owo+ICAgCj4gLQlwcm9jbW9uID0gY25sX2dldF9wcm9jbW9u
X3JlZl92YWx1ZXMoZGV2X3ByaXYsIHBvcnQpOwo+ICsJcHJvY21vbiA9IGNubF9nZXRfcHJvY21v
bl9yZWZfdmFsdWVzKGk5MTUsIHBvcnQpOwo+ICAgCj4gLQlyZXQgPSBjaGVja19waHlfcmVnKGRl
dl9wcml2LCBwb3J0LCBJQ0xfUE9SVF9DT01QX0RXMShwb3J0KSwKPiArCXJldCA9IGNoZWNrX3Bo
eV9yZWcoaTkxNSwgcG9ydCwgSUNMX1BPUlRfQ09NUF9EVzEocG9ydCksCj4gICAJCQkgICAgKDB4
ZmYgPDwgMTYpIHwgMHhmZiwgcHJvY21vbi0+ZHcxKTsKPiAtCXJldCAmPSBjaGVja19waHlfcmVn
KGRldl9wcml2LCBwb3J0LCBJQ0xfUE9SVF9DT01QX0RXOShwb3J0KSwKPiArCXJldCAmPSBjaGVj
a19waHlfcmVnKGk5MTUsIHBvcnQsIElDTF9QT1JUX0NPTVBfRFc5KHBvcnQpLAo+ICAgCQkJICAg
ICAtMVUsIHByb2Ntb24tPmR3OSk7Cj4gLQlyZXQgJj0gY2hlY2tfcGh5X3JlZyhkZXZfcHJpdiwg
cG9ydCwgSUNMX1BPUlRfQ09NUF9EVzEwKHBvcnQpLAo+ICsJcmV0ICY9IGNoZWNrX3BoeV9yZWco
aTkxNSwgcG9ydCwgSUNMX1BPUlRfQ09NUF9EVzEwKHBvcnQpLAo+ICAgCQkJICAgICAtMVUsIHBy
b2Ntb24tPmR3MTApOwo+ICAgCj4gICAJcmV0dXJuIHJldDsKPiAgIH0KPiAgIAo+IC1zdGF0aWMg
Ym9vbCBjbmxfY29tYm9fcGh5X2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICtzdGF0aWMgYm9vbCBjbmxfY29tYm9fcGh5X2VuYWJsZWQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJcmV0dXJuICEoSTkxNV9SRUFEKENISUNLRU5fTUlT
Q18yKSAmIENOTF9DT01QX1BXUl9ET1dOKSAmJgo+ICAgCQkoSTkxNV9SRUFEKENOTF9QT1JUX0NP
TVBfRFcwKSAmIENPTVBfSU5JVCk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGJvb2wgY25sX2NvbWJv
X3BoeV92ZXJpZnlfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtz
dGF0aWMgYm9vbCBjbmxfY29tYm9fcGh5X3ZlcmlmeV9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAllbnVtIHBvcnQgcG9ydCA9IFBPUlRfQTsKPiAgIAlib29s
IHJldDsKPiAgIAo+IC0JaWYgKCFjbmxfY29tYm9fcGh5X2VuYWJsZWQoZGV2X3ByaXYpKQo+ICsJ
aWYgKCFjbmxfY29tYm9fcGh5X2VuYWJsZWQoaTkxNSkpCj4gICAJCXJldHVybiBmYWxzZTsKPiAg
IAo+IC0JcmV0ID0gY25sX3ZlcmlmeV9wcm9jbW9uX3JlZl92YWx1ZXMoZGV2X3ByaXYsIHBvcnQp
Owo+ICsJcmV0ID0gY25sX3ZlcmlmeV9wcm9jbW9uX3JlZl92YWx1ZXMoaTkxNSwgcG9ydCk7Cj4g
ICAKPiAtCXJldCAmPSBjaGVja19waHlfcmVnKGRldl9wcml2LCBwb3J0LCBDTkxfUE9SVF9DTDFD
TV9EVzUsCj4gKwlyZXQgJj0gY2hlY2tfcGh5X3JlZyhpOTE1LCBwb3J0LCBDTkxfUE9SVF9DTDFD
TV9EVzUsCj4gICAJCQkgICAgIENMX1BPV0VSX0RPV05fRU5BQkxFLCBDTF9QT1dFUl9ET1dOX0VO
QUJMRSk7Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGNu
bF9jb21ib19waHlzX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtz
dGF0aWMgdm9pZCBjbmxfY29tYm9fcGh5c19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ICAgewo+ICAgCXUzMiB2YWw7Cj4gICAKPiBAQCAtMTU3LDcgKzE1Nyw3IEBAIHN0YXRp
YyB2b2lkIGNubF9jb21ib19waHlzX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICAgCUk5MTVfV1JJVEUoQ0hJQ0tFTl9NSVNDXzIsIHZhbCk7Cj4gICAKPiAgIAkvKiBE
dW1teSBQT1JUX0EgdG8gZ2V0IHRoZSBjb3JyZWN0IENOTCByZWdpc3RlciBmcm9tIHRoZSBJQ0wg
bWFjcm8gKi8KPiAtCWNubF9zZXRfcHJvY21vbl9yZWZfdmFsdWVzKGRldl9wcml2LCBQT1JUX0Ep
Owo+ICsJY25sX3NldF9wcm9jbW9uX3JlZl92YWx1ZXMoaTkxNSwgUE9SVF9BKTsKPiAgIAo+ICAg
CXZhbCA9IEk5MTVfUkVBRChDTkxfUE9SVF9DT01QX0RXMCk7Cj4gICAJdmFsIHw9IENPTVBfSU5J
VDsKPiBAQCAtMTY4LDExICsxNjgsMTEgQEAgc3RhdGljIHZvaWQgY25sX2NvbWJvX3BoeXNfaW5p
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJSTkxNV9XUklURShDTkxf
UE9SVF9DTDFDTV9EVzUsIHZhbCk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgY25sX2NvbWJv
X3BoeXNfdW5pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGlj
IHZvaWQgY25sX2NvbWJvX3BoeXNfdW5pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ICAgewo+ICAgCXUzMiB2YWw7Cj4gICAKPiAtCWlmICghY25sX2NvbWJvX3BoeV92ZXJpZnlf
c3RhdGUoZGV2X3ByaXYpKQo+ICsJaWYgKCFjbmxfY29tYm9fcGh5X3ZlcmlmeV9zdGF0ZShpOTE1
KSkKPiAgIAkJRFJNX1dBUk4oIkNvbWJvIFBIWSBIVyBzdGF0ZSBjaGFuZ2VkIHVuZXhwZWN0ZWRs
eS5cbiIpOwo+ICAgCj4gICAJdmFsID0gSTkxNV9SRUFEKENISUNLRU5fTUlTQ18yKTsKPiBAQCAt
MTgwLDcgKzE4MCw3IEBAIHN0YXRpYyB2b2lkIGNubF9jb21ib19waHlzX3VuaW5pdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJSTkxNV9XUklURShDSElDS0VOX01JU0Nf
MiwgdmFsKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgYm9vbCBpY2xfY29tYm9fcGh5X2VuYWJsZWQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgYm9vbCBpY2xfY29t
Ym9fcGh5X2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICBl
bnVtIHBvcnQgcG9ydCkKPiAgIHsKPiAgIAlyZXR1cm4gIShJOTE1X1JFQUQoSUNMX1BIWV9NSVND
KHBvcnQpKSAmCj4gQEAgLTE4OCwyNyArMTg4LDI3IEBAIHN0YXRpYyBib29sIGljbF9jb21ib19w
aHlfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJCShJOTE1
X1JFQUQoSUNMX1BPUlRfQ09NUF9EVzAocG9ydCkpICYgQ09NUF9JTklUKTsKPiAgIH0KPiAgIAo+
IC1zdGF0aWMgYm9vbCBpY2xfY29tYm9fcGh5X3ZlcmlmeV9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBib29sIGljbF9jb21ib19waHlfdmVyaWZ5X3N0
YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgICAgICBlbnVtIHBv
cnQgcG9ydCkKPiAgIHsKPiAgIAlib29sIHJldDsKPiAgIAo+IC0JaWYgKCFpY2xfY29tYm9fcGh5
X2VuYWJsZWQoZGV2X3ByaXYsIHBvcnQpKQo+ICsJaWYgKCFpY2xfY29tYm9fcGh5X2VuYWJsZWQo
aTkxNSwgcG9ydCkpCj4gICAJCXJldHVybiBmYWxzZTsKPiAgIAo+IC0JcmV0ID0gY25sX3Zlcmlm
eV9wcm9jbW9uX3JlZl92YWx1ZXMoZGV2X3ByaXYsIHBvcnQpOwo+ICsJcmV0ID0gY25sX3Zlcmlm
eV9wcm9jbW9uX3JlZl92YWx1ZXMoaTkxNSwgcG9ydCk7Cj4gICAKPiAgIAlpZiAocG9ydCA9PSBQ
T1JUX0EpCj4gLQkJcmV0ICY9IGNoZWNrX3BoeV9yZWcoZGV2X3ByaXYsIHBvcnQsIElDTF9QT1JU
X0NPTVBfRFc4KHBvcnQpLAo+ICsJCXJldCAmPSBjaGVja19waHlfcmVnKGk5MTUsIHBvcnQsIElD
TF9QT1JUX0NPTVBfRFc4KHBvcnQpLAo+ICAgCQkJCSAgICAgSVJFRkdFTiwgSVJFRkdFTik7Cj4g
ICAKPiAtCXJldCAmPSBjaGVja19waHlfcmVnKGRldl9wcml2LCBwb3J0LCBJQ0xfUE9SVF9DTF9E
VzUocG9ydCksCj4gKwlyZXQgJj0gY2hlY2tfcGh5X3JlZyhpOTE1LCBwb3J0LCBJQ0xfUE9SVF9D
TF9EVzUocG9ydCksCj4gICAJCQkgICAgIENMX1BPV0VSX0RPV05fRU5BQkxFLCBDTF9QT1dFUl9E
T1dOX0VOQUJMRSk7Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+ICAgCj4gLXZvaWQgaW50
ZWxfY29tYm9fcGh5X3Bvd2VyX3VwX2xhbmVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiArdm9pZCBpbnRlbF9jb21ib19waHlfcG93ZXJfdXBfbGFuZXMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgIGVudW0gcG9ydCBwb3J0LCBib29sIGlzX2Rz
aSwKPiAgIAkJCQkgICAgaW50IGxhbmVfY291bnQsIGJvb2wgbGFuZV9yZXZlcnNhbCkKPiAgIHsK
PiBAQCAtMjYwLDE0ICsyNjAsMTQgQEAgdm9pZCBpbnRlbF9jb21ib19waHlfcG93ZXJfdXBfbGFu
ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCUk5MTVfV1JJVEUoSUNM
X1BPUlRfQ0xfRFcxMChwb3J0KSwgdmFsKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpY2xf
Y29tYm9fcGh5c19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3Rh
dGljIHZvaWQgaWNsX2NvbWJvX3BoeXNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiAgIHsKPiAgIAllbnVtIHBvcnQgcG9ydDsKPiAgIAo+IC0JZm9yX2VhY2hfY29tYm9fcG9y
dChkZXZfcHJpdiwgcG9ydCkgewo+ICsJZm9yX2VhY2hfY29tYm9fcG9ydChpOTE1LCBwb3J0KSB7
Cj4gICAJCXUzMiB2YWw7Cj4gICAKPiAtCQlpZiAoaWNsX2NvbWJvX3BoeV92ZXJpZnlfc3RhdGUo
ZGV2X3ByaXYsIHBvcnQpKSB7Cj4gKwkJaWYgKGljbF9jb21ib19waHlfdmVyaWZ5X3N0YXRlKGk5
MTUsIHBvcnQpKSB7Cj4gICAJCQlEUk1fREVCVUdfRFJJVkVSKCJQb3J0ICVjIGNvbWJvIFBIWSBh
bHJlYWR5IGVuYWJsZWQsIHdvbid0IHJlcHJvZ3JhbSBpdC5cbiIsCj4gICAJCQkJCSBwb3J0X25h
bWUocG9ydCkpOwo+ICAgCQkJY29udGludWU7Cj4gQEAgLTI3Nyw3ICsyNzcsNyBAQCBzdGF0aWMg
dm9pZCBpY2xfY29tYm9fcGh5c19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiAgIAkJdmFsICY9IH5JQ0xfUEhZX01JU0NfREVfSU9fQ09NUF9QV1JfRE9XTjsKPiAgIAkJ
STkxNV9XUklURShJQ0xfUEhZX01JU0MocG9ydCksIHZhbCk7Cj4gICAKPiAtCQljbmxfc2V0X3By
b2Ntb25fcmVmX3ZhbHVlcyhkZXZfcHJpdiwgcG9ydCk7Cj4gKwkJY25sX3NldF9wcm9jbW9uX3Jl
Zl92YWx1ZXMoaTkxNSwgcG9ydCk7Cj4gICAKPiAgIAkJaWYgKHBvcnQgPT0gUE9SVF9BKSB7Cj4g
ICAJCQl2YWwgPSBJOTE1X1JFQUQoSUNMX1BPUlRfQ09NUF9EVzgocG9ydCkpOwo+IEBAIC0yOTUs
MTUgKzI5NSwxNSBAQCBzdGF0aWMgdm9pZCBpY2xfY29tYm9fcGh5c19pbml0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAl9Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQg
aWNsX2NvbWJvX3BoeXNfdW5pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiArc3RhdGljIHZvaWQgaWNsX2NvbWJvX3BoeXNfdW5pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ICAgewo+ICAgCWVudW0gcG9ydCBwb3J0Owo+ICAgCj4gLQlmb3JfZWFjaF9j
b21ib19wb3J0X3JldmVyc2UoZGV2X3ByaXYsIHBvcnQpIHsKPiArCWZvcl9lYWNoX2NvbWJvX3Bv
cnRfcmV2ZXJzZShpOTE1LCBwb3J0KSB7Cj4gICAJCXUzMiB2YWw7Cj4gICAKPiAgIAkJaWYgKHBv
cnQgPT0gUE9SVF9BICYmCj4gLQkJICAgICFpY2xfY29tYm9fcGh5X3ZlcmlmeV9zdGF0ZShkZXZf
cHJpdiwgcG9ydCkpCj4gKwkJICAgICFpY2xfY29tYm9fcGh5X3ZlcmlmeV9zdGF0ZShpOTE1LCBw
b3J0KSkKPiAgIAkJCURSTV9XQVJOKCJQb3J0ICVjIGNvbWJvIFBIWSBIVyBzdGF0ZSBjaGFuZ2Vk
IHVuZXhwZWN0ZWRseVxuIiwKPiAgIAkJCQkgcG9ydF9uYW1lKHBvcnQpKTsKPiAgIAo+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jb21ib19waHkuaCBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX2NvbWJvX3BoeS5oCj4gaW5kZXggZTZlMTk1YTgzYjE5Li5hMDgy
ODZjZmNlY2YgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfY29tYm9f
cGh5LmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jb21ib19waHkuaAo+IEBA
IC0xMSw5ICsxMSw5IEBACj4gICAKPiAgIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlOwo+ICAgCj4g
LXZvaWQgaW50ZWxfY29tYm9fcGh5X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KTsKPiAtdm9pZCBpbnRlbF9jb21ib19waHlfdW5pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdik7Cj4gLXZvaWQgaW50ZWxfY29tYm9fcGh5X3Bvd2VyX3VwX2xhbmVzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArdm9pZCBpbnRlbF9jb21ib19waHlf
aW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgaW50ZWxfY29tYm9f
cGh5X3VuaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgaW50ZWxf
Y29tYm9fcGh5X3Bvd2VyX3VwX2xhbmVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+
ICAgCQkJCSAgICBlbnVtIHBvcnQgcG9ydCwgYm9vbCBpc19kc2ksCj4gICAJCQkJICAgIGludCBs
YW5lX2NvdW50LCBib29sIGxhbmVfcmV2ZXJzYWwpOwo+ICAgCj4gZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX2Nvbm5lY3Rvci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfY29ubmVjdG9yLmMKPiBpbmRleCAwNzNiNmMzYWI3Y2MuLjI5MTI4MDRkNWEwZCAxMDA2
NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jb25uZWN0b3IuYwo+ICsrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Nvbm5lY3Rvci5jCj4gQEAgLTIxOSwxMCArMjE5
LDEwIEBAIHZvaWQKPiAgIGludGVsX2F0dGFjaF9mb3JjZV9hdWRpb19wcm9wZXJ0eShzdHJ1Y3Qg
ZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ICAgewo+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYgPSBjb25uZWN0b3ItPmRldjsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShkZXYpOwo+ICAgCXN0cnVjdCBkcm1fcHJvcGVydHkgKnByb3A7Cj4gICAKPiAtCXByb3Ag
PSBkZXZfcHJpdi0+Zm9yY2VfYXVkaW9fcHJvcGVydHk7Cj4gKwlwcm9wID0gaTkxNS0+Zm9yY2Vf
YXVkaW9fcHJvcGVydHk7Cj4gICAJaWYgKHByb3AgPT0gTlVMTCkgewo+ICAgCQlwcm9wID0gZHJt
X3Byb3BlcnR5X2NyZWF0ZV9lbnVtKGRldiwgMCwKPiAgIAkJCQkJICAgImF1ZGlvIiwKPiBAQCAt
MjMxLDcgKzIzMSw3IEBAIGludGVsX2F0dGFjaF9mb3JjZV9hdWRpb19wcm9wZXJ0eShzdHJ1Y3Qg
ZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ICAgCQlpZiAocHJvcCA9PSBOVUxMKQo+ICAgCQkJ
cmV0dXJuOwo+ICAgCj4gLQkJZGV2X3ByaXYtPmZvcmNlX2F1ZGlvX3Byb3BlcnR5ID0gcHJvcDsK
PiArCQlpOTE1LT5mb3JjZV9hdWRpb19wcm9wZXJ0eSA9IHByb3A7Cj4gICAJfQo+ICAgCWRybV9v
YmplY3RfYXR0YWNoX3Byb3BlcnR5KCZjb25uZWN0b3ItPmJhc2UsIHByb3AsIDApOwo+ICAgfQo+
IEBAIC0yNDYsMTAgKzI0NiwxMCBAQCB2b2lkCj4gICBpbnRlbF9hdHRhY2hfYnJvYWRjYXN0X3Jn
Yl9wcm9wZXJ0eShzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ICAgewo+ICAgCXN0
cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjb25uZWN0b3ItPmRldjsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXN0cnVjdCBkcm1fcHJvcGVydHkgKnBy
b3A7Cj4gICAKPiAtCXByb3AgPSBkZXZfcHJpdi0+YnJvYWRjYXN0X3JnYl9wcm9wZXJ0eTsKPiAr
CXByb3AgPSBpOTE1LT5icm9hZGNhc3RfcmdiX3Byb3BlcnR5Owo+ICAgCWlmIChwcm9wID09IE5V
TEwpIHsKPiAgIAkJcHJvcCA9IGRybV9wcm9wZXJ0eV9jcmVhdGVfZW51bShkZXYsIERSTV9NT0RF
X1BST1BfRU5VTSwKPiAgIAkJCQkJICAgIkJyb2FkY2FzdCBSR0IiLAo+IEBAIC0yNTgsNyArMjU4
LDcgQEAgaW50ZWxfYXR0YWNoX2Jyb2FkY2FzdF9yZ2JfcHJvcGVydHkoc3RydWN0IGRybV9jb25u
ZWN0b3IgKmNvbm5lY3RvcikKPiAgIAkJaWYgKHByb3AgPT0gTlVMTCkKPiAgIAkJCXJldHVybjsK
PiAgIAo+IC0JCWRldl9wcml2LT5icm9hZGNhc3RfcmdiX3Byb3BlcnR5ID0gcHJvcDsKPiArCQlp
OTE1LT5icm9hZGNhc3RfcmdiX3Byb3BlcnR5ID0gcHJvcDsKPiAgIAl9Cj4gICAKPiAgIAlkcm1f
b2JqZWN0X2F0dGFjaF9wcm9wZXJ0eSgmY29ubmVjdG9yLT5iYXNlLCBwcm9wLCAwKTsKPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfY3J0LmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9jcnQuYwo+IGluZGV4IDNmY2YyZjg0YmNjZS4uMmE3OTRlMGJmNDU3IDEw
MDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2NydC5jCj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfY3J0LmMKPiBAQCAtNzAsNyArNzAsNyBAQCBzdGF0aWMg
c3RydWN0IGludGVsX2NydCAqaW50ZWxfYXR0YWNoZWRfY3J0KHN0cnVjdCBkcm1fY29ubmVjdG9y
ICpjb25uZWN0b3IpCj4gICAJcmV0dXJuIGludGVsX2VuY29kZXJfdG9fY3J0KGludGVsX2F0dGFj
aGVkX2VuY29kZXIoY29ubmVjdG9yKSk7Cj4gICB9Cj4gICAKPiAtYm9vbCBpbnRlbF9jcnRfcG9y
dF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArYm9vbCBpbnRl
bF9jcnRfcG9ydF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJ
ICAgIGk5MTVfcmVnX3QgYWRwYV9yZWcsIGVudW0gcGlwZSAqcGlwZSkKPiAgIHsKPiAgIAl1MzIg
dmFsOwo+IEBAIC03OCw3ICs3OCw3IEBAIGJvb2wgaW50ZWxfY3J0X3BvcnRfZW5hYmxlZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJdmFsID0gSTkxNV9SRUFEKGFkcGFf
cmVnKTsKPiAgIAo+ICAgCS8qIGFzc2VydHMgd2FudCB0byBrbm93IHRoZSBwaXBlIGV2ZW4gaWYg
dGhlIHBvcnQgaXMgZGlzYWJsZWQgKi8KPiAtCWlmIChIQVNfUENIX0NQVChkZXZfcHJpdikpCj4g
KwlpZiAoSEFTX1BDSF9DUFQoaTkxNSkpCj4gICAJCSpwaXBlID0gKHZhbCAmIEFEUEFfUElQRV9T
RUxfTUFTS19DUFQpID4+IEFEUEFfUElQRV9TRUxfU0hJRlRfQ1BUOwo+ICAgCWVsc2UKPiAgIAkJ
KnBpcGUgPSAodmFsICYgQURQQV9QSVBFX1NFTF9NQVNLKSA+PiBBRFBBX1BJUEVfU0VMX1NISUZU
Owo+IEBAIC04OSwyNiArODksMjYgQEAgYm9vbCBpbnRlbF9jcnRfcG9ydF9lbmFibGVkKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIHN0YXRpYyBib29sIGludGVsX2NydF9n
ZXRfaHdfc3RhdGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkJICAgZW51
bSBwaXBlICpwaXBlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9j
cnQgKmNydCA9IGludGVsX2VuY29kZXJfdG9fY3J0KGVuY29kZXIpOwo+ICAgCWludGVsX3dha2Vy
ZWZfdCB3YWtlcmVmOwo+ICAgCWJvb2wgcmV0Owo+ICAgCj4gLQl3YWtlcmVmID0gaW50ZWxfZGlz
cGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChkZXZfcHJpdiwKPiArCXdha2VyZWYgPSBpbnRlbF9k
aXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGk5MTUsCj4gICAJCQkJCQkgICAgIGVuY29kZXIt
PnBvd2VyX2RvbWFpbik7Cj4gICAJaWYgKCF3YWtlcmVmKQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4g
ICAKPiAtCXJldCA9IGludGVsX2NydF9wb3J0X2VuYWJsZWQoZGV2X3ByaXYsIGNydC0+YWRwYV9y
ZWcsIHBpcGUpOwo+ICsJcmV0ID0gaW50ZWxfY3J0X3BvcnRfZW5hYmxlZChpOTE1LCBjcnQtPmFk
cGFfcmVnLCBwaXBlKTsKPiAgIAo+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYs
IGVuY29kZXItPnBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gKwlpbnRlbF9kaXNwbGF5X3Bvd2Vy
X3B1dChpOTE1LCBlbmNvZGVyLT5wb3dlcl9kb21haW4sIHdha2VyZWYpOwo+ICAgCj4gICAJcmV0
dXJuIHJldDsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHVuc2lnbmVkIGludCBpbnRlbF9jcnRfZ2V0
X2ZsYWdzKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ICAgewo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5k
ZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnQgKmNydCA9IGludGVsX2VuY29kZXJfdG9fY3J0KGVu
Y29kZXIpOwo+ICAgCXUzMiB0bXAsIGZsYWdzID0gMDsKPiAgIAo+IEBAIC0xNDAsNyArMTQwLDcg
QEAgc3RhdGljIHZvaWQgaW50ZWxfY3J0X2dldF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4gICBzdGF0aWMgdm9pZCBoc3dfY3J0X2dldF9jb25maWcoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkgICAgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KnBpcGVfY29uZmlnKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCj4gICAJaW50ZWxfZGRp
X2dldF9jb25maWcoZW5jb2RlciwgcGlwZV9jb25maWcpOwo+ICAgCj4gQEAgLTE1MCw3ICsxNTAs
NyBAQCBzdGF0aWMgdm9pZCBoc3dfY3J0X2dldF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4gICAJCQkJCSAgICAgIERSTV9NT0RFX0ZMQUdfTlZTWU5DKTsKPiAgIAlwaXBl
X2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmZsYWdzIHw9IGludGVsX2NydF9nZXRfZmxhZ3Mo
ZW5jb2Rlcik7Cj4gICAKPiAtCXBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19j
bG9jayA9IGxwdF9nZXRfaWNsa2lwKGRldl9wcml2KTsKPiArCXBpcGVfY29uZmlnLT5iYXNlLmFk
anVzdGVkX21vZGUuY3J0Y19jbG9jayA9IGxwdF9nZXRfaWNsa2lwKGk5MTUpOwo+ICAgfQo+ICAg
Cj4gICAvKiBOb3RlOiBUaGUgY2FsbGVyIGlzIHJlcXVpcmVkIHRvIGZpbHRlciBvdXQgZHBtcyBt
b2RlcyBub3Qgc3VwcG9ydGVkIGJ5IHRoZQo+IEBAIC0xNTksMTMgKzE1OSwxMyBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9jcnRfc2V0X2RwbXMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4g
ICAJCQkgICAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4g
ICAJCQkgICAgICAgaW50IG1vZGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0
IGludGVsX2NydCAqY3J0ID0gaW50ZWxfZW5jb2Rlcl90b19jcnQoZW5jb2Rlcik7Cj4gICAJc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0
Yyk7Cj4gICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAm
Y3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICAgCXUzMiBhZHBhOwo+ICAgCj4gLQlp
ZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA1KQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA1
KQo+ICAgCQlhZHBhID0gQURQQV9IT1RQTFVHX0JJVFM7Cj4gICAJZWxzZQo+ICAgCQlhZHBhID0g
MDsKPiBAQCAtMTc2LDE0ICsxNzYsMTQgQEAgc3RhdGljIHZvaWQgaW50ZWxfY3J0X3NldF9kcG1z
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQlhZHBhIHw9IEFEUEFfVlNZTkNf
QUNUSVZFX0hJR0g7Cj4gICAKPiAgIAkvKiBGb3IgQ1BUIGFsbG93IDMgcGlwZSBjb25maWcsIGZv
ciBvdGhlcnMganVzdCB1c2UgQSBvciBCICovCj4gLQlpZiAoSEFTX1BDSF9MUFQoZGV2X3ByaXYp
KQo+ICsJaWYgKEhBU19QQ0hfTFBUKGk5MTUpKQo+ICAgCQk7IC8qIFRob3NlIGJpdHMgZG9uJ3Qg
ZXhpc3QgaGVyZSAqLwo+IC0JZWxzZSBpZiAoSEFTX1BDSF9DUFQoZGV2X3ByaXYpKQo+ICsJZWxz
ZSBpZiAoSEFTX1BDSF9DUFQoaTkxNSkpCj4gICAJCWFkcGEgfD0gQURQQV9QSVBFX1NFTF9DUFQo
Y3J0Yy0+cGlwZSk7Cj4gICAJZWxzZQo+ICAgCQlhZHBhIHw9IEFEUEFfUElQRV9TRUwoY3J0Yy0+
cGlwZSk7Cj4gICAKPiAtCWlmICghSEFTX1BDSF9TUExJVChkZXZfcHJpdikpCj4gKwlpZiAoIUhB
U19QQ0hfU1BMSVQoaTkxNSkpCj4gICAJCUk5MTVfV1JJVEUoQkNMUlBBVChjcnRjLT5waXBlKSwg
MCk7Cj4gICAKPiAgIAlzd2l0Y2ggKG1vZGUpIHsKPiBAQCAtMjI4LDU3ICsyMjgsNTcgQEAgc3Rh
dGljIHZvaWQgaHN3X2Rpc2FibGVfY3J0KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+
ICAgCQkJICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwK
PiAgIAkJCSAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3Rh
dGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAKPiAgIAlXQVJOX09OKCFvbGRfY3J0Y19z
dGF0ZS0+aGFzX3BjaF9lbmNvZGVyKTsKPiAgIAo+IC0JaW50ZWxfc2V0X3BjaF9maWZvX3VuZGVy
cnVuX3JlcG9ydGluZyhkZXZfcHJpdiwgUElQRV9BLCBmYWxzZSk7Cj4gKwlpbnRlbF9zZXRfcGNo
X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGk5MTUsIFBJUEVfQSwgZmFsc2UpOwo+ICAgfQo+ICAg
Cj4gICBzdGF0aWMgdm9pZCBoc3dfcG9zdF9kaXNhYmxlX2NydChzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiAgIAkJCQkgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9j
cnRjX3N0YXRlLAo+ICAgCQkJCSBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xk
X2Nvbm5fc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAKPiAgIAlpbnRlbF9kZGlf
ZGlzYWJsZV9waXBlX2Nsb2NrKG9sZF9jcnRjX3N0YXRlKTsKPiAgIAo+ICAgCXBjaF9wb3N0X2Rp
c2FibGVfY3J0KGVuY29kZXIsIG9sZF9jcnRjX3N0YXRlLCBvbGRfY29ubl9zdGF0ZSk7Cj4gICAK
PiAtCWxwdF9kaXNhYmxlX3BjaF90cmFuc2NvZGVyKGRldl9wcml2KTsKPiAtCWxwdF9kaXNhYmxl
X2ljbGtpcChkZXZfcHJpdik7Cj4gKwlscHRfZGlzYWJsZV9wY2hfdHJhbnNjb2RlcihpOTE1KTsK
PiArCWxwdF9kaXNhYmxlX2ljbGtpcChpOTE1KTsKPiAgIAo+ICAgCWludGVsX2RkaV9mZGlfcG9z
dF9kaXNhYmxlKGVuY29kZXIsIG9sZF9jcnRjX3N0YXRlLCBvbGRfY29ubl9zdGF0ZSk7Cj4gICAK
PiAgIAlXQVJOX09OKCFvbGRfY3J0Y19zdGF0ZS0+aGFzX3BjaF9lbmNvZGVyKTsKPiAgIAo+IC0J
aW50ZWxfc2V0X3BjaF9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZfcHJpdiwgUElQRV9BLCB0
cnVlKTsKPiArCWludGVsX3NldF9wY2hfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoaTkxNSwgUElQ
RV9BLCB0cnVlKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgaHN3X3ByZV9wbGxfZW5hYmxl
X2NydChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCQkgICBjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJCQkgICBjb25zdCBzdHJ1Y3Qg
ZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsK
PiAgIAo+ICAgCVdBUk5fT04oIWNydGNfc3RhdGUtPmhhc19wY2hfZW5jb2Rlcik7Cj4gICAKPiAt
CWludGVsX3NldF9wY2hfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoZGV2X3ByaXYsIFBJUEVfQSwg
ZmFsc2UpOwo+ICsJaW50ZWxfc2V0X3BjaF9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhpOTE1LCBQ
SVBFX0EsIGZhbHNlKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgaHN3X3ByZV9lbmFibGVf
Y3J0KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJICAgICAgIGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCQkJICAgICAgIGNvbnN0IHN0
cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5k
ZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0
YXRlLT5iYXNlLmNydGMpOwo+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgIAo+
ICAgCVdBUk5fT04oIWNydGNfc3RhdGUtPmhhc19wY2hfZW5jb2Rlcik7Cj4gICAKPiAtCWludGVs
X3NldF9jcHVfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoZGV2X3ByaXYsIHBpcGUsIGZhbHNlKTsK
PiArCWludGVsX3NldF9jcHVfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoaTkxNSwgcGlwZSwgZmFs
c2UpOwo+ICAgCj4gLQlkZXZfcHJpdi0+ZGlzcGxheS5mZGlfbGlua190cmFpbihjcnRjLCBjcnRj
X3N0YXRlKTsKPiArCWk5MTUtPmRpc3BsYXkuZmRpX2xpbmtfdHJhaW4oY3J0YywgY3J0Y19zdGF0
ZSk7Cj4gICAKPiAgIAlpbnRlbF9kZGlfZW5hYmxlX3BpcGVfY2xvY2soY3J0Y19zdGF0ZSk7Cj4g
ICB9Cj4gQEAgLTI4Nyw3ICsyODcsNyBAQCBzdGF0aWMgdm9pZCBoc3dfZW5hYmxlX2NydChzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCQkJICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0
b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0
IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7
Cj4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAgCj4gQEAgLTI5NSwxMCArMjk1
LDEwIEBAIHN0YXRpYyB2b2lkIGhzd19lbmFibGVfY3J0KHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAo+ICAgCj4gICAJaW50ZWxfY3J0X3NldF9kcG1zKGVuY29kZXIsIGNydGNfc3RhdGUs
IERSTV9NT0RFX0RQTVNfT04pOwo+ICAgCj4gLQlpbnRlbF93YWl0X2Zvcl92YmxhbmsoZGV2X3By
aXYsIHBpcGUpOwo+IC0JaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGRldl9wcml2LCBwaXBlKTsKPiAt
CWludGVsX3NldF9jcHVfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoZGV2X3ByaXYsIHBpcGUsIHRy
dWUpOwo+IC0JaW50ZWxfc2V0X3BjaF9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZfcHJpdiwg
UElQRV9BLCB0cnVlKTsKPiArCWludGVsX3dhaXRfZm9yX3ZibGFuayhpOTE1LCBwaXBlKTsKPiAr
CWludGVsX3dhaXRfZm9yX3ZibGFuayhpOTE1LCBwaXBlKTsKPiArCWludGVsX3NldF9jcHVfZmlm
b191bmRlcnJ1bl9yZXBvcnRpbmcoaTkxNSwgcGlwZSwgdHJ1ZSk7Cj4gKwlpbnRlbF9zZXRfcGNo
X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGk5MTUsIFBJUEVfQSwgdHJ1ZSk7Cj4gICB9Cj4gICAK
PiAgIHN0YXRpYyB2b2lkIGludGVsX2VuYWJsZV9jcnQoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCj4gQEAgLTMxMyw4ICszMTMsOCBAQCBpbnRlbF9jcnRfbW9kZV92YWxpZChzdHJ1Y3Qg
ZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+ICAgCQkgICAgIHN0cnVjdCBkcm1fZGlzcGxheV9t
b2RlICptb2RlKQo+ICAgewo+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjb25uZWN0b3It
PmRldjsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2
KTsKPiAtCWludCBtYXhfZG90Y2xrID0gZGV2X3ByaXYtPm1heF9kb3RjbGtfZnJlcTsKPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICsJaW50IG1heF9k
b3RjbGsgPSBpOTE1LT5tYXhfZG90Y2xrX2ZyZXE7Cj4gICAJaW50IG1heF9jbG9jazsKPiAgIAo+
ICAgCWlmIChtb2RlLT5mbGFncyAmIERSTV9NT0RFX0ZMQUdfREJMU0NBTikKPiBAQCAtMzIzLDE1
ICszMjMsMTUgQEAgaW50ZWxfY3J0X21vZGVfdmFsaWQoc3RydWN0IGRybV9jb25uZWN0b3IgKmNv
bm5lY3RvciwKPiAgIAlpZiAobW9kZS0+Y2xvY2sgPCAyNTAwMCkKPiAgIAkJcmV0dXJuIE1PREVf
Q0xPQ0tfTE9XOwo+ICAgCj4gLQlpZiAoSEFTX1BDSF9MUFQoZGV2X3ByaXYpKQo+ICsJaWYgKEhB
U19QQ0hfTFBUKGk5MTUpKQo+ICAgCQltYXhfY2xvY2sgPSAxODAwMDA7Cj4gLQllbHNlIGlmIChJ
U19WQUxMRVlWSUVXKGRldl9wcml2KSkKPiArCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkp
Cj4gICAJCS8qCj4gICAJCSAqIDI3MCBNSHogZHVlIHRvIGN1cnJlbnQgRFBMTCBsaW1pdHMsCj4g
ICAJCSAqIERBQyBsaW1pdCBzdXBwb3NlZGx5IDM1NSBNSHouCj4gICAJCSAqLwo+ICAgCQltYXhf
Y2xvY2sgPSAyNzAwMDA7Cj4gLQllbHNlIGlmIChJU19HRU5fUkFOR0UoZGV2X3ByaXYsIDMsIDQp
KQo+ICsJZWxzZSBpZiAoSVNfR0VOX1JBTkdFKGk5MTUsIDMsIDQpKQo+ICAgCQltYXhfY2xvY2sg
PSA0MDAwMDA7Cj4gICAJZWxzZQo+ICAgCQltYXhfY2xvY2sgPSAzNTAwMDA7Cj4gQEAgLTM0Miw3
ICszNDIsNyBAQCBpbnRlbF9jcnRfbW9kZV92YWxpZChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29u
bmVjdG9yLAo+ICAgCQlyZXR1cm4gTU9ERV9DTE9DS19ISUdIOwo+ICAgCj4gICAJLyogVGhlIEZE
SSByZWNlaXZlciBvbiBMUFQgb25seSBzdXBwb3J0cyA4YnBjIGFuZCBvbmx5IGhhcyAyIGxhbmVz
LiAqLwo+IC0JaWYgKEhBU19QQ0hfTFBUKGRldl9wcml2KSAmJgo+ICsJaWYgKEhBU19QQ0hfTFBU
KGk5MTUpICYmCj4gICAJICAgIChpcm9ubGFrZV9nZXRfbGFuZXNfcmVxdWlyZWQobW9kZS0+Y2xv
Y2ssIDI3MDAwMCwgMjQpID4gMikpCj4gICAJCXJldHVybiBNT0RFX0NMT0NLX0hJR0g7Cj4gICAK
PiBAQCAtMzg4LDcgKzM4OCw3IEBAIHN0YXRpYyBpbnQgaHN3X2NydF9jb21wdXRlX2NvbmZpZyhz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCQkgIHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpwaXBlX2NvbmZpZywKPiAgIAkJCQkgIHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRl
ICpjb25uX3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBkcm1fZGlz
cGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0KPiAgIAkJJnBpcGVfY29uZmlnLT5iYXNlLmFkanVz
dGVkX21vZGU7Cj4gICAKPiBAQCAtNDA0LDcgKzQwNCw3IEBAIHN0YXRpYyBpbnQgaHN3X2NydF9j
b21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAlwaXBlX2Nv
bmZpZy0+b3V0cHV0X2Zvcm1hdCA9IElOVEVMX09VVFBVVF9GT1JNQVRfUkdCOwo+ICAgCj4gICAJ
LyogTFBUIEZESSBSWCBvbmx5IHN1cHBvcnRzIDhicGMuICovCj4gLQlpZiAoSEFTX1BDSF9MUFQo
ZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSEFTX1BDSF9MUFQoaTkxNSkpIHsKPiAgIAkJaWYgKHBpcGVf
Y29uZmlnLT5id19jb25zdHJhaW5lZCAmJiBwaXBlX2NvbmZpZy0+cGlwZV9icHAgPCAyNCkgewo+
ICAgCQkJRFJNX0RFQlVHX0tNUygiTFBUIG9ubHkgc3VwcG9ydHMgMjRicHBcbiIpOwo+ICAgCQkJ
cmV0dXJuIC1FSU5WQUw7Cj4gQEAgLTQyMywxMyArNDIzLDEzIEBAIHN0YXRpYyBib29sIGludGVs
X2lyb25sYWtlX2NydF9kZXRlY3RfaG90cGx1ZyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVj
dG9yKQo+ICAgewo+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjb25uZWN0b3ItPmRldjsK
PiAgIAlzdHJ1Y3QgaW50ZWxfY3J0ICpjcnQgPSBpbnRlbF9hdHRhY2hlZF9jcnQoY29ubmVjdG9y
KTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsK
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXUz
MiBhZHBhOwo+ICAgCWJvb2wgcmV0Owo+ICAgCj4gICAJLyogVGhlIGZpcnN0IHRpbWUgdGhyb3Vn
aCwgdHJpZ2dlciBhbiBleHBsaWNpdCBkZXRlY3Rpb24gY3ljbGUgKi8KPiAgIAlpZiAoY3J0LT5m
b3JjZV9ob3RwbHVnX3JlcXVpcmVkKSB7Cj4gLQkJYm9vbCB0dXJuX29mZl9kYWMgPSBIQVNfUENI
X1NQTElUKGRldl9wcml2KTsKPiArCQlib29sIHR1cm5fb2ZmX2RhYyA9IEhBU19QQ0hfU1BMSVQo
aTkxNSk7Cj4gICAJCXUzMiBzYXZlX2FkcGE7Cj4gICAKPiAgIAkJY3J0LT5mb3JjZV9ob3RwbHVn
X3JlcXVpcmVkID0gMDsKPiBAQCAtNDQzLDcgKzQ0Myw3IEBAIHN0YXRpYyBib29sIGludGVsX2ly
b25sYWtlX2NydF9kZXRlY3RfaG90cGx1ZyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9y
KQo+ICAgCj4gICAJCUk5MTVfV1JJVEUoY3J0LT5hZHBhX3JlZywgYWRwYSk7Cj4gICAKPiAtCQlp
ZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gKwkJaWYgKGlu
dGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsCj4gICAJCQkJCSAgICBjcnQtPmFk
cGFfcmVnLAo+ICAgCQkJCQkgICAgQURQQV9DUlRfSE9UUExVR19GT1JDRV9UUklHR0VSLCAwLAo+
ICAgCQkJCQkgICAgMTAwMCkpCj4gQEAgLTQ3MCw3ICs0NzAsNyBAQCBzdGF0aWMgYm9vbCB2YWxs
ZXl2aWV3X2NydF9kZXRlY3RfaG90cGx1ZyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9y
KQo+ICAgewo+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjb25uZWN0b3ItPmRldjsKPiAg
IAlzdHJ1Y3QgaW50ZWxfY3J0ICpjcnQgPSBpbnRlbF9hdHRhY2hlZF9jcnQoY29ubmVjdG9yKTsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCWJvb2wg
cmVlbmFibGVfaHBkOwo+ICAgCXUzMiBhZHBhOwo+ICAgCWJvb2wgcmV0Owo+IEBAIC00ODgsNyAr
NDg4LDcgQEAgc3RhdGljIGJvb2wgdmFsbGV5dmlld19jcnRfZGV0ZWN0X2hvdHBsdWcoc3RydWN0
IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIAkgKgo+ICAgCSAqIEp1c3QgZGlzYWJsZSBI
UEQgaW50ZXJydXB0cyBoZXJlIHRvIHByZXZlbnQgdGhpcwo+ICAgCSAqLwo+IC0JcmVlbmFibGVf
aHBkID0gaW50ZWxfaHBkX2Rpc2FibGUoZGV2X3ByaXYsIGNydC0+YmFzZS5ocGRfcGluKTsKPiAr
CXJlZW5hYmxlX2hwZCA9IGludGVsX2hwZF9kaXNhYmxlKGk5MTUsIGNydC0+YmFzZS5ocGRfcGlu
KTsKPiAgIAo+ICAgCXNhdmVfYWRwYSA9IGFkcGEgPSBJOTE1X1JFQUQoY3J0LT5hZHBhX3JlZyk7
Cj4gICAJRFJNX0RFQlVHX0tNUygidHJpZ2dlciBob3RwbHVnIGRldGVjdCBjeWNsZTogYWRwYT0w
eCV4XG4iLCBhZHBhKTsKPiBAQCAtNDk3LDcgKzQ5Nyw3IEBAIHN0YXRpYyBib29sIHZhbGxleXZp
ZXdfY3J0X2RldGVjdF9ob3RwbHVnKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCj4g
ICAKPiAgIAlJOTE1X1dSSVRFKGNydC0+YWRwYV9yZWcsIGFkcGEpOwo+ICAgCj4gLQlpZiAoaW50
ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gKwlpZiAoaW50ZWxfd2Fp
dF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiAgIAkJCQkgICAgY3J0LT5hZHBhX3JlZywK
PiAgIAkJCQkgICAgQURQQV9DUlRfSE9UUExVR19GT1JDRV9UUklHR0VSLCAwLAo+ICAgCQkJCSAg
ICAxMDAwKSkgewo+IEBAIC01MTUsNyArNTE1LDcgQEAgc3RhdGljIGJvb2wgdmFsbGV5dmlld19j
cnRfZGV0ZWN0X2hvdHBsdWcoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIAlE
Uk1fREVCVUdfS01TKCJ2YWxsZXl2aWV3IGhvdHBsdWcgYWRwYT0weCV4LCByZXN1bHQgJWRcbiIs
IGFkcGEsIHJldCk7Cj4gICAKPiAgIAlpZiAocmVlbmFibGVfaHBkKQo+IC0JCWludGVsX2hwZF9l
bmFibGUoZGV2X3ByaXYsIGNydC0+YmFzZS5ocGRfcGluKTsKPiArCQlpbnRlbF9ocGRfZW5hYmxl
KGk5MTUsIGNydC0+YmFzZS5ocGRfcGluKTsKPiAgIAo+ICAgCXJldHVybiByZXQ7Cj4gICB9Cj4g
QEAgLTUyMywxNSArNTIzLDE1IEBAIHN0YXRpYyBib29sIHZhbGxleXZpZXdfY3J0X2RldGVjdF9o
b3RwbHVnKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCj4gICBzdGF0aWMgYm9vbCBp
bnRlbF9jcnRfZGV0ZWN0X2hvdHBsdWcoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikK
PiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY29ubmVjdG9yLT5kZXY7Cj4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAl1MzIgc3RhdDsK
PiAgIAlib29sIHJldCA9IGZhbHNlOwo+ICAgCWludCBpLCB0cmllcyA9IDA7Cj4gICAKPiAtCWlm
IChIQVNfUENIX1NQTElUKGRldl9wcml2KSkKPiArCWlmIChIQVNfUENIX1NQTElUKGk5MTUpKQo+
ICAgCQlyZXR1cm4gaW50ZWxfaXJvbmxha2VfY3J0X2RldGVjdF9ob3RwbHVnKGNvbm5lY3Rvcik7
Cj4gICAKPiAtCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkKPiArCWlmIChJU19WQUxMRVlW
SUVXKGk5MTUpKQo+ICAgCQlyZXR1cm4gdmFsbGV5dmlld19jcnRfZGV0ZWN0X2hvdHBsdWcoY29u
bmVjdG9yKTsKPiAgIAo+ICAgCS8qCj4gQEAgLTUzOSwxOCArNTM5LDE4IEBAIHN0YXRpYyBib29s
IGludGVsX2NydF9kZXRlY3RfaG90cGx1ZyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9y
KQo+ICAgCSAqIHRvIGdldCBhIHJlbGlhYmxlIHJlc3VsdC4KPiAgIAkgKi8KPiAgIAo+IC0JaWYg
KElTX0c0NShkZXZfcHJpdikpCj4gKwlpZiAoSVNfRzQ1KGk5MTUpKQo+ICAgCQl0cmllcyA9IDI7
Cj4gICAJZWxzZQo+ICAgCQl0cmllcyA9IDE7Cj4gICAKPiAgIAlmb3IgKGkgPSAwOyBpIDwgdHJp
ZXMgOyBpKyspIHsKPiAgIAkJLyogdHVybiBvbiB0aGUgRk9SQ0VfREVURUNUICovCj4gLQkJaTkx
NV9ob3RwbHVnX2ludGVycnVwdF91cGRhdGUoZGV2X3ByaXYsCj4gKwkJaTkxNV9ob3RwbHVnX2lu
dGVycnVwdF91cGRhdGUoaTkxNSwKPiAgIAkJCQkJICAgICAgQ1JUX0hPVFBMVUdfRk9SQ0VfREVU
RUNULAo+ICAgCQkJCQkgICAgICBDUlRfSE9UUExVR19GT1JDRV9ERVRFQ1QpOwo+ICAgCQkvKiB3
YWl0IGZvciBGT1JDRV9ERVRFQ1QgdG8gZ28gb2ZmICovCj4gLQkJaWYgKGludGVsX3dhaXRfZm9y
X3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLCBQT1JUX0hPVFBMVUdfRU4sCj4gKwkJaWYgKGlu
dGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsIFBPUlRfSE9UUExVR19FTiwKPiAg
IAkJCQkJICAgIENSVF9IT1RQTFVHX0ZPUkNFX0RFVEVDVCwgMCwKPiAgIAkJCQkJICAgIDEwMDAp
KQo+ICAgCQkJRFJNX0RFQlVHX0tNUygidGltZWQgb3V0IHdhaXRpbmcgZm9yIEZPUkNFX0RFVEVD
VCB0byBnbyBvZmYiKTsKPiBAQCAtNTYzLDcgKzU2Myw3IEBAIHN0YXRpYyBib29sIGludGVsX2Ny
dF9kZXRlY3RfaG90cGx1ZyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ICAgCS8q
IGNsZWFyIHRoZSBpbnRlcnJ1cHQgd2UganVzdCBnZW5lcmF0ZWQsIGlmIGFueSAqLwo+ICAgCUk5
MTVfV1JJVEUoUE9SVF9IT1RQTFVHX1NUQVQsIENSVF9IT1RQTFVHX0lOVF9TVEFUVVMpOwo+ICAg
Cj4gLQlpOTE1X2hvdHBsdWdfaW50ZXJydXB0X3VwZGF0ZShkZXZfcHJpdiwgQ1JUX0hPVFBMVUdf
Rk9SQ0VfREVURUNULCAwKTsKPiArCWk5MTVfaG90cGx1Z19pbnRlcnJ1cHRfdXBkYXRlKGk5MTUs
IENSVF9IT1RQTFVHX0ZPUkNFX0RFVEVDVCwgMCk7Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAg
fQo+IEBAIC02MDUsMTQgKzYwNSwxNCBAQCBzdGF0aWMgaW50IGludGVsX2NydF9kZGNfZ2V0X21v
ZGVzKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCj4gICBzdGF0aWMgYm9vbCBpbnRl
bF9jcnRfZGV0ZWN0X2RkYyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ICAgewo+
ICAgCXN0cnVjdCBpbnRlbF9jcnQgKmNydCA9IGludGVsX2F0dGFjaGVkX2NydChjb25uZWN0b3Ip
Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnQtPmJh
c2UuYmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGNydC0+YmFzZS5iYXNlLmRldik7Cj4gICAJc3RydWN0IGVkaWQgKmVkaWQ7Cj4gICAJc3RydWN0
IGkyY19hZGFwdGVyICppMmM7Cj4gICAJYm9vbCByZXQgPSBmYWxzZTsKPiAgIAo+ICAgCUJVR19P
TihjcnQtPmJhc2UudHlwZSAhPSBJTlRFTF9PVVRQVVRfQU5BTE9HKTsKPiAgIAo+IC0JaTJjID0g
aW50ZWxfZ21idXNfZ2V0X2FkYXB0ZXIoZGV2X3ByaXYsIGRldl9wcml2LT52YnQuY3J0X2RkY19w
aW4pOwo+ICsJaTJjID0gaW50ZWxfZ21idXNfZ2V0X2FkYXB0ZXIoaTkxNSwgaTkxNS0+dmJ0LmNy
dF9kZGNfcGluKTsKPiAgIAllZGlkID0gaW50ZWxfY3J0X2dldF9lZGlkKGNvbm5lY3RvciwgaTJj
KTsKPiAgIAo+ICAgCWlmIChlZGlkKSB7Cj4gQEAgLTY0Miw4ICs2NDIsOCBAQCBzdGF0aWMgZW51
bSBkcm1fY29ubmVjdG9yX3N0YXR1cwo+ICAgaW50ZWxfY3J0X2xvYWRfZGV0ZWN0KHN0cnVjdCBp
bnRlbF9jcnQgKmNydCwgdTMyIHBpcGUpCj4gICB7Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRl
diA9IGNydC0+YmFzZS5iYXNlLmRldjsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoZGV2KTsKPiAtCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZk
ZXZfcHJpdi0+dW5jb3JlOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGRldik7Cj4gKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+dW5jb3Jl
Owo+ICAgCXUzMiBzYXZlX2JjbHJwYXQ7Cj4gICAJdTMyIHNhdmVfdnRvdGFsOwo+ICAgCXUzMiB2
dG90YWwsIHZhY3RpdmU7Cj4gQEAgLTY3Nyw3ICs2NzcsNyBAQCBpbnRlbF9jcnRfbG9hZF9kZXRl
Y3Qoc3RydWN0IGludGVsX2NydCAqY3J0LCB1MzIgcGlwZSkKPiAgIAkvKiBTZXQgdGhlIGJvcmRl
ciBjb2xvciB0byBwdXJwbGUuICovCj4gICAJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgYmNs
cnBhdF9yZWcsIDB4NTAwMDUwKTsKPiAgIAo+IC0JaWYgKCFJU19HRU4oZGV2X3ByaXYsIDIpKSB7
Cj4gKwlpZiAoIUlTX0dFTihpOTE1LCAyKSkgewo+ICAgCQl1MzIgcGlwZWNvbmYgPSBpbnRlbF91
bmNvcmVfcmVhZCh1bmNvcmUsIHBpcGVjb25mX3JlZyk7Cj4gICAJCWludGVsX3VuY29yZV93cml0
ZSh1bmNvcmUsCj4gICAJCQkJICAgcGlwZWNvbmZfcmVnLAo+IEBAIC02ODUsNyArNjg1LDcgQEAg
aW50ZWxfY3J0X2xvYWRfZGV0ZWN0KHN0cnVjdCBpbnRlbF9jcnQgKmNydCwgdTMyIHBpcGUpCj4g
ICAJCWludGVsX3VuY29yZV9wb3N0aW5nX3JlYWQodW5jb3JlLCBwaXBlY29uZl9yZWcpOwo+ICAg
CQkvKiBXYWl0IGZvciBuZXh0IFZibGFuayB0byBzdWJzdGl0dWUKPiAgIAkJICogYm9yZGVyIGNv
bG9yIGZvciBDb2xvciBpbmZvICovCj4gLQkJaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGRldl9wcml2
LCBwaXBlKTsKPiArCQlpbnRlbF93YWl0X2Zvcl92YmxhbmsoaTkxNSwgcGlwZSk7Cj4gICAJCXN0
MDAgPSBpbnRlbF91bmNvcmVfcmVhZDgodW5jb3JlLCBfVkdBX01TUl9XUklURSk7Cj4gICAJCXN0
YXR1cyA9ICgoc3QwMCAmICgxIDw8IDQpKSAhPSAwKSA/Cj4gICAJCQljb25uZWN0b3Jfc3RhdHVz
X2Nvbm5lY3RlZCA6Cj4gQEAgLTc4OSw3ICs3ODksNyBAQCBpbnRlbF9jcnRfZGV0ZWN0KHN0cnVj
dCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCj4gICAJCSBzdHJ1Y3QgZHJtX21vZGVzZXRfYWNx
dWlyZV9jdHggKmN0eCwKPiAgIAkJIGJvb2wgZm9yY2UpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmRldik7Cj4gICAJ
c3RydWN0IGludGVsX2NydCAqY3J0ID0gaW50ZWxfYXR0YWNoZWRfY3J0KGNvbm5lY3Rvcik7Cj4g
ICAJc3RydWN0IGludGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIgPSAmY3J0LT5iYXNlOwo+ICAg
CWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+IEBAIC04MDEsNyArODAxLDcgQEAgaW50ZWxfY3J0
X2RldGVjdChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+ICAgCQkgICAgICBmb3Jj
ZSk7Cj4gICAKPiAgIAlpZiAoaTkxNV9tb2RwYXJhbXMubG9hZF9kZXRlY3RfdGVzdCkgewo+IC0J
CXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChkZXZfcHJpdiwKPiArCQl3YWtlcmVm
ID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoaTkxNSwKPiAgIAkJCQkJCSAgaW50ZWxfZW5jb2Rl
ci0+cG93ZXJfZG9tYWluKTsKPiAgIAkJZ290byBsb2FkX2RldGVjdDsKPiAgIAl9Cj4gQEAgLTgx
MCwxMCArODEwLDEwIEBAIGludGVsX2NydF9kZXRlY3Qoc3RydWN0IGRybV9jb25uZWN0b3IgKmNv
bm5lY3RvciwKPiAgIAlpZiAoZG1pX2NoZWNrX3N5c3RlbShpbnRlbF9zcHVyaW91c19jcnRfZGV0
ZWN0KSkKPiAgIAkJcmV0dXJuIGNvbm5lY3Rvcl9zdGF0dXNfZGlzY29ubmVjdGVkOwo+ICAgCj4g
LQl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoZGV2X3ByaXYsCj4gKwl3YWtlcmVm
ID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoaTkxNSwKPiAgIAkJCQkJICBpbnRlbF9lbmNvZGVy
LT5wb3dlcl9kb21haW4pOwo+ICAgCj4gLQlpZiAoSTkxNV9IQVNfSE9UUExVRyhkZXZfcHJpdikp
IHsKPiArCWlmIChJOTE1X0hBU19IT1RQTFVHKGk5MTUpKSB7Cj4gICAJCS8qIFdlIGNhbiBub3Qg
cmVseSBvbiB0aGUgSFBEIHBpbiBhbHdheXMgYmVpbmcgY29ycmVjdGx5IHdpcmVkCj4gICAJCSAq
IHVwLCBmb3IgZXhhbXBsZSBtYW55IEtWTSBkbyBub3QgcGFzcyBpdCB0aHJvdWdoLCBhbmQgc28K
PiAgIAkJICogb25seSB0cnVzdCBhbiBhc3NlcnRpb24gdGhhdCB0aGUgbW9uaXRvciBpcyBjb25u
ZWN0ZWQuCj4gQEAgLTgzNSw3ICs4MzUsNyBAQCBpbnRlbF9jcnRfZGV0ZWN0KHN0cnVjdCBkcm1f
Y29ubmVjdG9yICpjb25uZWN0b3IsCj4gICAJICogYnJva2VuIG1vbml0b3IgKHdpdGhvdXQgZWRp
ZCkgdG8gd29yayBiZWhpbmQgYSBicm9rZW4ga3ZtICh0aGF0IGZhaWxzCj4gICAJICogdG8gaGF2
ZSB0aGUgcmlnaHQgcmVzaXN0b3JzIGZvciBIUCBkZXRlY3Rpb24pIG5lZWRzIHRvIGZpeCB0aGlz
IHVwLgo+ICAgCSAqIEZvciBub3cganVzdCBiYWlsIG91dC4gKi8KPiAtCWlmIChJOTE1X0hBU19I
T1RQTFVHKGRldl9wcml2KSkgewo+ICsJaWYgKEk5MTVfSEFTX0hPVFBMVUcoaTkxNSkpIHsKPiAg
IAkJc3RhdHVzID0gY29ubmVjdG9yX3N0YXR1c19kaXNjb25uZWN0ZWQ7Cj4gICAJCWdvdG8gb3V0
Owo+ICAgCX0KPiBAQCAtODUxLDcgKzg1MSw3IEBAIGludGVsX2NydF9kZXRlY3Qoc3RydWN0IGRy
bV9jb25uZWN0b3IgKmNvbm5lY3RvciwKPiAgIAlpZiAocmV0ID4gMCkgewo+ICAgCQlpZiAoaW50
ZWxfY3J0X2RldGVjdF9kZGMoY29ubmVjdG9yKSkKPiAgIAkJCXN0YXR1cyA9IGNvbm5lY3Rvcl9z
dGF0dXNfY29ubmVjdGVkOwo+IC0JCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA0KQo+
ICsJCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA8IDQpCj4gICAJCQlzdGF0dXMgPSBpbnRlbF9j
cnRfbG9hZF9kZXRlY3QoY3J0LAo+ICAgCQkJCXRvX2ludGVsX2NydGMoY29ubmVjdG9yLT5zdGF0
ZS0+Y3J0YyktPnBpcGUpOwo+ICAgCQllbHNlIGlmIChpOTE1X21vZHBhcmFtcy5sb2FkX2RldGVj
dF90ZXN0KQo+IEBAIC04NjYsNDQgKzg2Niw0NCBAQCBpbnRlbF9jcnRfZGV0ZWN0KHN0cnVjdCBk
cm1fY29ubmVjdG9yICpjb25uZWN0b3IsCj4gICAJfQo+ICAgCj4gICBvdXQ6Cj4gLQlpbnRlbF9k
aXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwgaW50ZWxfZW5jb2Rlci0+cG93ZXJfZG9tYWluLCB3
YWtlcmVmKTsKPiArCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5MTUsIGludGVsX2VuY29kZXIt
PnBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gICAJcmV0dXJuIHN0YXR1czsKPiAgIH0KPiAgIAo+
ICAgc3RhdGljIGludCBpbnRlbF9jcnRfZ2V0X21vZGVzKHN0cnVjdCBkcm1fY29ubmVjdG9yICpj
b25uZWN0b3IpCj4gICB7Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNvbm5lY3Rvci0+
ZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJ
c3RydWN0IGludGVsX2NydCAqY3J0ID0gaW50ZWxfYXR0YWNoZWRfY3J0KGNvbm5lY3Rvcik7Cj4g
ICAJc3RydWN0IGludGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIgPSAmY3J0LT5iYXNlOwo+ICAg
CWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICAgCXN0cnVjdCBpMmNfYWRhcHRlciAqaTJjOwo+
ICAgCWludCByZXQ7Cj4gICAKPiAtCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChk
ZXZfcHJpdiwKPiArCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChpOTE1LAo+ICAg
CQkJCQkgIGludGVsX2VuY29kZXItPnBvd2VyX2RvbWFpbik7Cj4gICAKPiAtCWkyYyA9IGludGVs
X2dtYnVzX2dldF9hZGFwdGVyKGRldl9wcml2LCBkZXZfcHJpdi0+dmJ0LmNydF9kZGNfcGluKTsK
PiArCWkyYyA9IGludGVsX2dtYnVzX2dldF9hZGFwdGVyKGk5MTUsIGk5MTUtPnZidC5jcnRfZGRj
X3Bpbik7Cj4gICAJcmV0ID0gaW50ZWxfY3J0X2RkY19nZXRfbW9kZXMoY29ubmVjdG9yLCBpMmMp
Owo+IC0JaWYgKHJldCB8fCAhSVNfRzRYKGRldl9wcml2KSkKPiArCWlmIChyZXQgfHwgIUlTX0c0
WChpOTE1KSkKPiAgIAkJZ290byBvdXQ7Cj4gICAKPiAgIAkvKiBUcnkgdG8gcHJvYmUgZGlnaXRh
bCBwb3J0IGZvciBvdXRwdXQgaW4gRFZJLUkgLT4gVkdBIG1vZGUuICovCj4gLQlpMmMgPSBpbnRl
bF9nbWJ1c19nZXRfYWRhcHRlcihkZXZfcHJpdiwgR01CVVNfUElOX0RQQik7Cj4gKwlpMmMgPSBp
bnRlbF9nbWJ1c19nZXRfYWRhcHRlcihpOTE1LCBHTUJVU19QSU5fRFBCKTsKPiAgIAlyZXQgPSBp
bnRlbF9jcnRfZGRjX2dldF9tb2Rlcyhjb25uZWN0b3IsIGkyYyk7Cj4gICAKPiAgIG91dDoKPiAt
CWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBpbnRlbF9lbmNvZGVyLT5wb3dlcl9k
b21haW4sIHdha2VyZWYpOwo+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgaW50ZWxf
ZW5jb2Rlci0+cG93ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiAgIAo+ICAgCXJldHVybiByZXQ7Cj4g
ICB9Cj4gICAKPiAgIHZvaWQgaW50ZWxfY3J0X3Jlc2V0KHN0cnVjdCBkcm1fZW5jb2RlciAqZW5j
b2RlcikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoZW5jb2Rlci0+ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShlbmNvZGVyLT5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnQgKmNydCA9IGludGVsX2Vu
Y29kZXJfdG9fY3J0KHRvX2ludGVsX2VuY29kZXIoZW5jb2RlcikpOwo+ICAgCj4gLQlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA+PSA1KSB7Cj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDUpIHsK
PiAgIAkJdTMyIGFkcGE7Cj4gICAKPiAgIAkJYWRwYSA9IEk5MTVfUkVBRChjcnQtPmFkcGFfcmVn
KTsKPiBAQCAtOTQyLDcgKzk0Miw3IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2VuY29kZXJf
ZnVuY3MgaW50ZWxfY3J0X2VuY19mdW5jcyA9IHsKPiAgIAkuZGVzdHJveSA9IGludGVsX2VuY29k
ZXJfZGVzdHJveSwKPiAgIH07Cj4gICAKPiAtdm9pZCBpbnRlbF9jcnRfaW5pdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgaW50ZWxfY3J0X2luaXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RydWN0IGRybV9jb25uZWN0b3IgKmNv
bm5lY3RvcjsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0ICpjcnQ7Cj4gQEAgLTk1MCw5ICs5NTAsOSBA
QCB2b2lkIGludGVsX2NydF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiAgIAlpOTE1X3JlZ190IGFkcGFfcmVnOwo+ICAgCXUzMiBhZHBhOwo+ICAgCj4gLQlpZiAoSEFT
X1BDSF9TUExJVChkZXZfcHJpdikpCj4gKwlpZiAoSEFTX1BDSF9TUExJVChpOTE1KSkKPiAgIAkJ
YWRwYV9yZWcgPSBQQ0hfQURQQTsKPiAtCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYp
KQo+ICsJZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSkKPiAgIAkJYWRwYV9yZWcgPSBWTFZf
QURQQTsKPiAgIAllbHNlCj4gICAJCWFkcGFfcmVnID0gQURQQTsKPiBAQCAtOTg2LDIyICs5ODYs
MjIgQEAgdm9pZCBpbnRlbF9jcnRfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gICAKPiAgIAljb25uZWN0b3IgPSAmaW50ZWxfY29ubmVjdG9yLT5iYXNlOwo+ICAgCWNy
dC0+Y29ubmVjdG9yID0gaW50ZWxfY29ubmVjdG9yOwo+IC0JZHJtX2Nvbm5lY3Rvcl9pbml0KCZk
ZXZfcHJpdi0+ZHJtLCAmaW50ZWxfY29ubmVjdG9yLT5iYXNlLAo+ICsJZHJtX2Nvbm5lY3Rvcl9p
bml0KCZpOTE1LT5kcm0sICZpbnRlbF9jb25uZWN0b3ItPmJhc2UsCj4gICAJCQkgICAmaW50ZWxf
Y3J0X2Nvbm5lY3Rvcl9mdW5jcywgRFJNX01PREVfQ09OTkVDVE9SX1ZHQSk7Cj4gICAKPiAtCWRy
bV9lbmNvZGVyX2luaXQoJmRldl9wcml2LT5kcm0sICZjcnQtPmJhc2UuYmFzZSwgJmludGVsX2Ny
dF9lbmNfZnVuY3MsCj4gKwlkcm1fZW5jb2Rlcl9pbml0KCZpOTE1LT5kcm0sICZjcnQtPmJhc2Uu
YmFzZSwgJmludGVsX2NydF9lbmNfZnVuY3MsCj4gICAJCQkgRFJNX01PREVfRU5DT0RFUl9EQUMs
ICJDUlQiKTsKPiAgIAo+ICAgCWludGVsX2Nvbm5lY3Rvcl9hdHRhY2hfZW5jb2RlcihpbnRlbF9j
b25uZWN0b3IsICZjcnQtPmJhc2UpOwo+ICAgCj4gICAJY3J0LT5iYXNlLnR5cGUgPSBJTlRFTF9P
VVRQVVRfQU5BTE9HOwo+ICAgCWNydC0+YmFzZS5jbG9uZWFibGUgPSAoMSA8PCBJTlRFTF9PVVRQ
VVRfRFZPKSB8ICgxIDw8IElOVEVMX09VVFBVVF9IRE1JKTsKPiAtCWlmIChJU19JODMwKGRldl9w
cml2KSkKPiArCWlmIChJU19JODMwKGk5MTUpKQo+ICAgCQljcnQtPmJhc2UuY3J0Y19tYXNrID0g
KDEgPDwgMCk7Cj4gICAJZWxzZQo+ICAgCQljcnQtPmJhc2UuY3J0Y19tYXNrID0gKDEgPDwgMCkg
fCAoMSA8PCAxKSB8ICgxIDw8IDIpOwo+ICAgCj4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCAyKSkK
PiArCWlmIChJU19HRU4oaTkxNSwgMikpCj4gICAJCWNvbm5lY3Rvci0+aW50ZXJsYWNlX2FsbG93
ZWQgPSAwOwo+ICAgCWVsc2UKPiAgIAkJY29ubmVjdG9yLT5pbnRlcmxhY2VfYWxsb3dlZCA9IDE7
Cj4gQEAgLTEwMTEsMTMgKzEwMTEsMTMgQEAgdm9pZCBpbnRlbF9jcnRfaW5pdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAKPiAgIAljcnQtPmJhc2UucG93ZXJfZG9tYWlu
ID0gUE9XRVJfRE9NQUlOX1BPUlRfQ1JUOwo+ICAgCj4gLQlpZiAoSTkxNV9IQVNfSE9UUExVRyhk
ZXZfcHJpdikgJiYKPiArCWlmIChJOTE1X0hBU19IT1RQTFVHKGk5MTUpICYmCj4gICAJICAgICFk
bWlfY2hlY2tfc3lzdGVtKGludGVsX3NwdXJpb3VzX2NydF9kZXRlY3QpKSB7Cj4gICAJCWNydC0+
YmFzZS5ocGRfcGluID0gSFBEX0NSVDsKPiAgIAkJY3J0LT5iYXNlLmhvdHBsdWcgPSBpbnRlbF9l
bmNvZGVyX2hvdHBsdWc7Cj4gICAJfQo+ICAgCj4gLQlpZiAoSEFTX0RESShkZXZfcHJpdikpIHsK
PiArCWlmIChIQVNfRERJKGk5MTUpKSB7Cj4gICAJCWNydC0+YmFzZS5wb3J0ID0gUE9SVF9FOwo+
ICAgCQljcnQtPmJhc2UuZ2V0X2NvbmZpZyA9IGhzd19jcnRfZ2V0X2NvbmZpZzsKPiAgIAkJY3J0
LT5iYXNlLmdldF9od19zdGF0ZSA9IGludGVsX2RkaV9nZXRfaHdfc3RhdGU7Cj4gQEAgLTEwMjgs
NyArMTAyOCw3IEBAIHZvaWQgaW50ZWxfY3J0X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICAgCQljcnQtPmJhc2UuZGlzYWJsZSA9IGhzd19kaXNhYmxlX2NydDsKPiAg
IAkJY3J0LT5iYXNlLnBvc3RfZGlzYWJsZSA9IGhzd19wb3N0X2Rpc2FibGVfY3J0Owo+ICAgCX0g
ZWxzZSB7Cj4gLQkJaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3ByaXYpKSB7Cj4gKwkJaWYgKEhBU19Q
Q0hfU1BMSVQoaTkxNSkpIHsKPiAgIAkJCWNydC0+YmFzZS5jb21wdXRlX2NvbmZpZyA9IHBjaF9j
cnRfY29tcHV0ZV9jb25maWc7Cj4gICAJCQljcnQtPmJhc2UuZGlzYWJsZSA9IHBjaF9kaXNhYmxl
X2NydDsKPiAgIAkJCWNydC0+YmFzZS5wb3N0X2Rpc2FibGUgPSBwY2hfcG9zdF9kaXNhYmxlX2Ny
dDsKPiBAQCAtMTA0NSw3ICsxMDQ1LDcgQEAgdm9pZCBpbnRlbF9jcnRfaW5pdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAKPiAgIAlkcm1fY29ubmVjdG9yX2hlbHBlcl9h
ZGQoY29ubmVjdG9yLCAmaW50ZWxfY3J0X2Nvbm5lY3Rvcl9oZWxwZXJfZnVuY3MpOwo+ICAgCj4g
LQlpZiAoIUk5MTVfSEFTX0hPVFBMVUcoZGV2X3ByaXYpKQo+ICsJaWYgKCFJOTE1X0hBU19IT1RQ
TFVHKGk5MTUpKQo+ICAgCQlpbnRlbF9jb25uZWN0b3ItPnBvbGxlZCA9IERSTV9DT05ORUNUT1Jf
UE9MTF9DT05ORUNUOwo+ICAgCj4gICAJLyoKPiBAQCAtMTA1OCwxMSArMTA1OCwxMSBAQCB2b2lk
IGludGVsX2NydF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkg
KiBwb2xhcml0eSBhbmQgbGluayByZXZlcnNhbCBiaXRzIG9yIG5vdCwgaW5zdGVhZCBvZiByZWx5
aW5nIG9uIHRoZQo+ICAgCSAqIEJJT1MuCj4gICAJICovCj4gLQlpZiAoSEFTX1BDSF9MUFQoZGV2
X3ByaXYpKSB7Cj4gKwlpZiAoSEFTX1BDSF9MUFQoaTkxNSkpIHsKPiAgIAkJdTMyIGZkaV9jb25m
aWcgPSBGRElfUlhfUE9MQVJJVFlfUkVWRVJTRURfTFBUIHwKPiAgIAkJCQkgRkRJX1JYX0xJTktf
UkVWRVJTQUxfT1ZFUlJJREU7Cj4gICAKPiAtCQlkZXZfcHJpdi0+ZmRpX3J4X2NvbmZpZyA9IEk5
MTVfUkVBRChGRElfUlhfQ1RMKFBJUEVfQSkpICYgZmRpX2NvbmZpZzsKPiArCQlpOTE1LT5mZGlf
cnhfY29uZmlnID0gSTkxNV9SRUFEKEZESV9SWF9DVEwoUElQRV9BKSkgJiBmZGlfY29uZmlnOwo+
ICAgCX0KPiAgIAo+ICAgCWludGVsX2NydF9yZXNldCgmY3J0LT5iYXNlLmJhc2UpOwo+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jcnQuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX2NydC5oCj4gaW5kZXggMWIzZmJhMzU5ZWZjLi5mNzcxZmJjZjhiMjcgMTAw
NjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfY3J0LmgKPiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jcnQuaAo+IEBAIC0xMyw5ICsxMyw5IEBAIHN0cnVjdCBk
cm1fZW5jb2RlcjsKPiAgIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlOwo+ICAgc3RydWN0IGRybV9p
OTE1X3ByaXZhdGU7Cj4gICAKPiAtYm9vbCBpbnRlbF9jcnRfcG9ydF9lbmFibGVkKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArYm9vbCBpbnRlbF9jcnRfcG9ydF9lbmFibGVk
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgIGk5MTVfcmVnX3QgYWRw
YV9yZWcsIGVudW0gcGlwZSAqcGlwZSk7Cj4gLXZvaWQgaW50ZWxfY3J0X2luaXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiArdm9pZCBpbnRlbF9jcnRfaW5pdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICB2b2lkIGludGVsX2NydF9yZXNldChzdHJ1Y3Qg
ZHJtX2VuY29kZXIgKmVuY29kZXIpOwo+ICAgCj4gICAjZW5kaWYgLyogX19JTlRFTF9DUlRfSF9f
ICovCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Nzci5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfY3NyLmMKPiBpbmRleCBiZjBlZWJkMzg1YjkuLjI5ZWEz
Y2I2YmJhZiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jc3IuYwo+
ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Nzci5jCj4gQEAgLTIwNiwxOCArMjA2
LDE4IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3Qgc3RlcHBpbmdfaW5mbyBpY2xfc3RlcHBpbmdfaW5m
b1tdID0gewo+ICAgc3RhdGljIGNvbnN0IHN0cnVjdCBzdGVwcGluZ19pbmZvIG5vX3N0ZXBwaW5n
X2luZm8gPSB7ICcqJywgJyonIH07Cj4gICAKPiAgIHN0YXRpYyBjb25zdCBzdHJ1Y3Qgc3RlcHBp
bmdfaW5mbyAqCj4gLWludGVsX2dldF9zdGVwcGluZ19pbmZvKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiAraW50ZWxfZ2V0X3N0ZXBwaW5nX2luZm8oc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJY29uc3Qgc3RydWN0IHN0ZXBwaW5nX2luZm8gKnNp
Owo+ICAgCXVuc2lnbmVkIGludCBzaXplOwo+ICAgCj4gLQlpZiAoSVNfSUNFTEFLRShkZXZfcHJp
dikpIHsKPiArCWlmIChJU19JQ0VMQUtFKGk5MTUpKSB7Cj4gICAJCXNpemUgPSBBUlJBWV9TSVpF
KGljbF9zdGVwcGluZ19pbmZvKTsKPiAgIAkJc2kgPSBpY2xfc3RlcHBpbmdfaW5mbzsKPiAtCX0g
ZWxzZSBpZiAoSVNfU0tZTEFLRShkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAoSVNfU0tZTEFL
RShpOTE1KSkgewo+ICAgCQlzaXplID0gQVJSQVlfU0laRShza2xfc3RlcHBpbmdfaW5mbyk7Cj4g
ICAJCXNpID0gc2tsX3N0ZXBwaW5nX2luZm87Cj4gLQl9IGVsc2UgaWYgKElTX0JST1hUT04oZGV2
X3ByaXYpKSB7Cj4gKwl9IGVsc2UgaWYgKElTX0JST1hUT04oaTkxNSkpIHsKPiAgIAkJc2l6ZSA9
IEFSUkFZX1NJWkUoYnh0X3N0ZXBwaW5nX2luZm8pOwo+ICAgCQlzaSA9IGJ4dF9zdGVwcGluZ19p
bmZvOwo+ICAgCX0gZWxzZSB7Cj4gQEAgLTIyNSwxOSArMjI1LDE5IEBAIGludGVsX2dldF9zdGVw
cGluZ19pbmZvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkJc2kgPSBO
VUxMOwo+ICAgCX0KPiAgIAo+IC0JaWYgKElOVEVMX1JFVklEKGRldl9wcml2KSA8IHNpemUpCj4g
LQkJcmV0dXJuIHNpICsgSU5URUxfUkVWSUQoZGV2X3ByaXYpOwo+ICsJaWYgKElOVEVMX1JFVklE
KGk5MTUpIDwgc2l6ZSkKPiArCQlyZXR1cm4gc2kgKyBJTlRFTF9SRVZJRChpOTE1KTsKPiAgIAo+
ICAgCXJldHVybiAmbm9fc3RlcHBpbmdfaW5mbzsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBn
ZW45X3NldF9kY19zdGF0ZV9kZWJ1Z21hc2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICtzdGF0aWMgdm9pZCBnZW45X3NldF9kY19zdGF0ZV9kZWJ1Z21hc2soc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJdTMyIHZhbCwgbWFzazsKPiAgIAo+ICAg
CW1hc2sgPSBEQ19TVEFURV9ERUJVR19NQVNLX01FTU9SWV9VUDsKPiAgIAo+IC0JaWYgKElTX0dF
TjlfTFAoZGV2X3ByaXYpKQo+ICsJaWYgKElTX0dFTjlfTFAoaTkxNSkpCj4gICAJCW1hc2sgfD0g
RENfU1RBVEVfREVCVUdfTUFTS19DT1JFUzsKPiAgIAo+ICAgCS8qIFRoZSBiZWxvdyBiaXQgZG9l
c24ndCBuZWVkIHRvIGJlIGNsZWFyZWQgZXZlciBhZnRlcndhcmRzICovCj4gQEAgLTI1MSwyOSAr
MjUxLDI5IEBAIHN0YXRpYyB2b2lkIGdlbjlfc2V0X2RjX3N0YXRlX2RlYnVnbWFzayhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxfY3Ny
X2xvYWRfcHJvZ3JhbSgpIC0gd3JpdGUgdGhlIGZpcm13YXJlIGZyb20gbWVtb3J5IHRvIHJlZ2lz
dGVyLgo+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZHJtIGRldmljZS4KPiArICogQGk5MTU6IGk5MTUg
ZHJtIGRldmljZS4KPiAgICAqCj4gICAgKiBDU1IgZmlybXdhcmUgaXMgcmVhZCBmcm9tIGEgLmJp
biBmaWxlIGFuZCBrZXB0IGluIGludGVybmFsIG1lbW9yeSBvbmUgdGltZS4KPiAgICAqIEV2ZXJ5
dGltZSBkaXNwbGF5IGNvbWVzIGJhY2sgZnJvbSBsb3cgcG93ZXIgc3RhdGUgdGhpcyBmdW5jdGlv
biBpcyBjYWxsZWQgdG8KPiAgICAqIGNvcHkgdGhlIGZpcm13YXJlIGZyb20gaW50ZXJuYWwgbWVt
b3J5IHRvIHJlZ2lzdGVycy4KPiAgICAqLwo+IC12b2lkIGludGVsX2Nzcl9sb2FkX3Byb2dyYW0o
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGludGVsX2Nzcl9sb2Fk
X3Byb2dyYW0oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQl1MzIgKnBh
eWxvYWQgPSBkZXZfcHJpdi0+Y3NyLmRtY19wYXlsb2FkOwo+ICsJdTMyICpwYXlsb2FkID0gaTkx
NS0+Y3NyLmRtY19wYXlsb2FkOwo+ICAgCXUzMiBpLCBmd19zaXplOwo+ICAgCj4gLQlpZiAoIUhB
U19DU1IoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoIUhBU19DU1IoaTkxNSkpIHsKPiAgIAkJRFJNX0VS
Uk9SKCJObyBDU1Igc3VwcG9ydCBhdmFpbGFibGUgZm9yIHRoaXMgcGxhdGZvcm1cbiIpOwo+ICAg
CQlyZXR1cm47Cj4gICAJfQo+ICAgCj4gLQlpZiAoIWRldl9wcml2LT5jc3IuZG1jX3BheWxvYWQp
IHsKPiArCWlmICghaTkxNS0+Y3NyLmRtY19wYXlsb2FkKSB7Cj4gICAJCURSTV9FUlJPUigiVHJp
ZWQgdG8gcHJvZ3JhbSBDU1Igd2l0aCBlbXB0eSBwYXlsb2FkXG4iKTsKPiAgIAkJcmV0dXJuOwo+
ICAgCX0KPiAgIAo+IC0JZndfc2l6ZSA9IGRldl9wcml2LT5jc3IuZG1jX2Z3X3NpemU7Cj4gLQlh
c3NlcnRfcnBtX3dha2Vsb2NrX2hlbGQoZGV2X3ByaXYpOwo+ICsJZndfc2l6ZSA9IGk5MTUtPmNz
ci5kbWNfZndfc2l6ZTsKPiArCWFzc2VydF9ycG1fd2FrZWxvY2tfaGVsZChpOTE1KTsKPiAgIAo+
ICAgCXByZWVtcHRfZGlzYWJsZSgpOwo+ICAgCj4gQEAgLTI4MiwyNCArMjgyLDI0IEBAIHZvaWQg
aW50ZWxfY3NyX2xvYWRfcHJvZ3JhbShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gICAKPiAgIAlwcmVlbXB0X2VuYWJsZSgpOwo+ICAgCj4gLQlmb3IgKGkgPSAwOyBpIDwgZGV2
X3ByaXYtPmNzci5tbWlvX2NvdW50OyBpKyspIHsKPiAtCQlJOTE1X1dSSVRFKGRldl9wcml2LT5j
c3IubW1pb2FkZHJbaV0sCj4gLQkJCSAgIGRldl9wcml2LT5jc3IubW1pb2RhdGFbaV0pOwo+ICsJ
Zm9yIChpID0gMDsgaSA8IGk5MTUtPmNzci5tbWlvX2NvdW50OyBpKyspIHsKPiArCQlJOTE1X1dS
SVRFKGk5MTUtPmNzci5tbWlvYWRkcltpXSwKPiArCQkJICAgaTkxNS0+Y3NyLm1taW9kYXRhW2ld
KTsKPiAgIAl9Cj4gICAKPiAtCWRldl9wcml2LT5jc3IuZGNfc3RhdGUgPSAwOwo+ICsJaTkxNS0+
Y3NyLmRjX3N0YXRlID0gMDsKPiAgIAo+IC0JZ2VuOV9zZXRfZGNfc3RhdGVfZGVidWdtYXNrKGRl
dl9wcml2KTsKPiArCWdlbjlfc2V0X2RjX3N0YXRlX2RlYnVnbWFzayhpOTE1KTsKPiAgIH0KPiAg
IAo+IC1zdGF0aWMgdTMyICpwYXJzZV9jc3JfZncoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ICtzdGF0aWMgdTMyICpwYXJzZV9jc3JfZncoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gICAJCQkgY29uc3Qgc3RydWN0IGZpcm13YXJlICpmdykKPiAgIHsKPiAgIAlz
dHJ1Y3QgaW50ZWxfY3NzX2hlYWRlciAqY3NzX2hlYWRlcjsKPiAgIAlzdHJ1Y3QgaW50ZWxfcGFj
a2FnZV9oZWFkZXIgKnBhY2thZ2VfaGVhZGVyOwo+ICAgCXN0cnVjdCBpbnRlbF9kbWNfaGVhZGVy
ICpkbWNfaGVhZGVyOwo+IC0Jc3RydWN0IGludGVsX2NzciAqY3NyID0gJmRldl9wcml2LT5jc3I7
Cj4gLQljb25zdCBzdHJ1Y3Qgc3RlcHBpbmdfaW5mbyAqc2kgPSBpbnRlbF9nZXRfc3RlcHBpbmdf
aW5mbyhkZXZfcHJpdik7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3NyICpjc3IgPSAmaTkxNS0+Y3NyOwo+
ICsJY29uc3Qgc3RydWN0IHN0ZXBwaW5nX2luZm8gKnNpID0gaW50ZWxfZ2V0X3N0ZXBwaW5nX2lu
Zm8oaTkxNSk7Cj4gICAJdTMyIGRtY19vZmZzZXQgPSBDU1JfREVGQVVMVF9GV19PRkZTRVQsIHJl
YWRjb3VudCA9IDAsIG5ieXRlczsKPiAgIAl1MzIgaTsKPiAgIAl1MzIgKmRtY19wYXlsb2FkOwo+
IEBAIC00MzAsNDggKzQzMCw0OCBAQCBzdGF0aWMgdTMyICpwYXJzZV9jc3JfZncoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCXJldHVybiBOVUxMOwo+ICAgfQo+ICAgCj4g
LXN0YXRpYyB2b2lkIGludGVsX2Nzcl9ydW50aW1lX3BtX2dldChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGludGVsX2Nzcl9ydW50aW1lX3BtX2dldChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCVdBUk5fT04oZGV2X3ByaXYt
PmNzci53YWtlcmVmKTsKPiAtCWRldl9wcml2LT5jc3Iud2FrZXJlZiA9Cj4gLQkJaW50ZWxfZGlz
cGxheV9wb3dlcl9nZXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9JTklUKTsKPiArCVdBUk5fT04o
aTkxNS0+Y3NyLndha2VyZWYpOwo+ICsJaTkxNS0+Y3NyLndha2VyZWYgPQo+ICsJCWludGVsX2Rp
c3BsYXlfcG93ZXJfZ2V0KGk5MTUsIFBPV0VSX0RPTUFJTl9JTklUKTsKPiAgIH0KPiAgIAo+IC1z
dGF0aWMgdm9pZCBpbnRlbF9jc3JfcnVudGltZV9wbV9wdXQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBpbnRlbF9jc3JfcnVudGltZV9wbV9wdXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJaW50ZWxfd2FrZXJlZl90IHdh
a2VyZWYgX19tYXliZV91bnVzZWQgPQo+IC0JCWZldGNoX2FuZF96ZXJvKCZkZXZfcHJpdi0+Y3Ny
Lndha2VyZWYpOwo+ICsJCWZldGNoX2FuZF96ZXJvKCZpOTE1LT5jc3Iud2FrZXJlZik7Cj4gICAK
PiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBQT1dFUl9ET01BSU5fSU5JVCwg
d2FrZXJlZik7Cj4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChpOTE1LCBQT1dFUl9ET01BSU5f
SU5JVCwgd2FrZXJlZik7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIGNzcl9sb2FkX3dvcmtf
Zm4oc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTU7Cj4gICAJ
c3RydWN0IGludGVsX2NzciAqY3NyOwo+ICAgCWNvbnN0IHN0cnVjdCBmaXJtd2FyZSAqZncgPSBO
VUxMOwo+ICAgCj4gLQlkZXZfcHJpdiA9IGNvbnRhaW5lcl9vZih3b3JrLCB0eXBlb2YoKmRldl9w
cml2KSwgY3NyLndvcmspOwo+IC0JY3NyID0gJmRldl9wcml2LT5jc3I7Cj4gKwlpOTE1ID0gY29u
dGFpbmVyX29mKHdvcmssIHR5cGVvZigqaTkxNSksIGNzci53b3JrKTsKPiArCWNzciA9ICZpOTE1
LT5jc3I7Cj4gICAKPiAtCXJlcXVlc3RfZmlybXdhcmUoJmZ3LCBkZXZfcHJpdi0+Y3NyLmZ3X3Bh
dGgsICZkZXZfcHJpdi0+ZHJtLnBkZXYtPmRldik7Cj4gKwlyZXF1ZXN0X2Zpcm13YXJlKCZmdywg
aTkxNS0+Y3NyLmZ3X3BhdGgsICZpOTE1LT5kcm0ucGRldi0+ZGV2KTsKPiAgIAlpZiAoZncpCj4g
LQkJZGV2X3ByaXYtPmNzci5kbWNfcGF5bG9hZCA9IHBhcnNlX2Nzcl9mdyhkZXZfcHJpdiwgZncp
Owo+ICsJCWk5MTUtPmNzci5kbWNfcGF5bG9hZCA9IHBhcnNlX2Nzcl9mdyhpOTE1LCBmdyk7Cj4g
ICAKPiAtCWlmIChkZXZfcHJpdi0+Y3NyLmRtY19wYXlsb2FkKSB7Cj4gLQkJaW50ZWxfY3NyX2xv
YWRfcHJvZ3JhbShkZXZfcHJpdik7Cj4gLQkJaW50ZWxfY3NyX3J1bnRpbWVfcG1fcHV0KGRldl9w
cml2KTsKPiArCWlmIChpOTE1LT5jc3IuZG1jX3BheWxvYWQpIHsKPiArCQlpbnRlbF9jc3JfbG9h
ZF9wcm9ncmFtKGk5MTUpOwo+ICsJCWludGVsX2Nzcl9ydW50aW1lX3BtX3B1dChpOTE1KTsKPiAg
IAo+ICAgCQlEUk1fSU5GTygiRmluaXNoZWQgbG9hZGluZyBETUMgZmlybXdhcmUgJXMgKHYldS4l
dSlcbiIsCj4gLQkJCSBkZXZfcHJpdi0+Y3NyLmZ3X3BhdGgsCj4gKwkJCSBpOTE1LT5jc3IuZndf
cGF0aCwKPiAgIAkJCSBDU1JfVkVSU0lPTl9NQUpPUihjc3ItPnZlcnNpb24pLAo+ICAgCQkJIENT
Ul9WRVJTSU9OX01JTk9SKGNzci0+dmVyc2lvbikpOwo+ICAgCX0gZWxzZSB7Cj4gLQkJZGV2X25v
dGljZShkZXZfcHJpdi0+ZHJtLmRldiwKPiArCQlkZXZfbm90aWNlKGk5MTUtPmRybS5kZXYsCj4g
ICAJCQkgICAiRmFpbGVkIHRvIGxvYWQgRE1DIGZpcm13YXJlICVzLiIKPiAgIAkJCSAgICIgRGlz
YWJsaW5nIHJ1bnRpbWUgcG93ZXIgbWFuYWdlbWVudC5cbiIsCj4gICAJCQkgICBjc3ItPmZ3X3Bh
dGgpOwo+IC0JCWRldl9ub3RpY2UoZGV2X3ByaXYtPmRybS5kZXYsICJETUMgZmlybXdhcmUgaG9t
ZXBhZ2U6ICVzIiwKPiArCQlkZXZfbm90aWNlKGk5MTUtPmRybS5kZXYsICJETUMgZmlybXdhcmUg
aG9tZXBhZ2U6ICVzIiwKPiAgIAkJCSAgIElOVEVMX1VDX0ZJUk1XQVJFX1VSTCk7Cj4gICAJfQo+
ICAgCj4gQEAgLTQ4MCwxOCArNDgwLDE4IEBAIHN0YXRpYyB2b2lkIGNzcl9sb2FkX3dvcmtfZm4o
c3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAgCj4gICAvKioKPiAgICAqIGludGVsX2Nzcl91
Y29kZV9pbml0KCkgLSBpbml0aWFsaXplIHRoZSBmaXJtd2FyZSBsb2FkaW5nLgo+IC0gKiBAZGV2
X3ByaXY6IGk5MTUgZHJtIGRldmljZS4KPiArICogQGk5MTU6IGk5MTUgZHJtIGRldmljZS4KPiAg
ICAqCj4gICAgKiBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBhdCB0aGUgdGltZSBvZiBsb2FkaW5n
IHRoZSBkaXNwbGF5IGRyaXZlciB0byByZWFkCj4gICAgKiBmaXJtd2FyZSBmcm9tIGEgLmJpbiBm
aWxlIGFuZCBjb3BpZWQgaW50byBhIGludGVybmFsIG1lbW9yeS4KPiAgICAqLwo+IC12b2lkIGlu
dGVsX2Nzcl91Y29kZV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAr
dm9pZCBpbnRlbF9jc3JfdWNvZGVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiAgIHsKPiAtCXN0cnVjdCBpbnRlbF9jc3IgKmNzciA9ICZkZXZfcHJpdi0+Y3NyOwo+ICsJc3Ry
dWN0IGludGVsX2NzciAqY3NyID0gJmk5MTUtPmNzcjsKPiAgIAo+IC0JSU5JVF9XT1JLKCZkZXZf
cHJpdi0+Y3NyLndvcmssIGNzcl9sb2FkX3dvcmtfZm4pOwo+ICsJSU5JVF9XT1JLKCZpOTE1LT5j
c3Iud29yaywgY3NyX2xvYWRfd29ya19mbik7Cj4gICAKPiAtCWlmICghSEFTX0NTUihkZXZfcHJp
dikpCj4gKwlpZiAoIUhBU19DU1IoaTkxNSkpCj4gICAJCXJldHVybjsKPiAgIAo+ICAgCS8qCj4g
QEAgLTUwMiwzMiArNTAyLDMyIEBAIHZvaWQgaW50ZWxfY3NyX3Vjb2RlX2luaXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCSAqIHN1c3BlbmQgYXMgcnVudGltZSBzdXNw
ZW5kICpyZXF1aXJlcyogYSB3b3JraW5nIENTUiBmb3Igd2hhdGV2ZXIKPiAgIAkgKiByZWFzb24u
Cj4gICAJICovCj4gLQlpbnRlbF9jc3JfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOwo+ICsJaW50
ZWxfY3NyX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA+PSAxMikgewo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMikgewo+ICAgCQkvKiBB
bGxvdyB0byBsb2FkIGZ3IHZpYSBwYXJhbWV0ZXIgdXNpbmcgdGhlIGxhc3Qga25vd24gc2l6ZSAq
Lwo+ICAgCQljc3ItPm1heF9md19zaXplID0gR0VOMTJfQ1NSX01BWF9GV19TSVpFOwo+IC0JfSBl
bHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDExKSkgewo+ICsJfSBlbHNlIGlmIChJU19HRU4oaTkx
NSwgMTEpKSB7Cj4gICAJCWNzci0+ZndfcGF0aCA9IElDTF9DU1JfUEFUSDsKPiAgIAkJY3NyLT5y
ZXF1aXJlZF92ZXJzaW9uID0gSUNMX0NTUl9WRVJTSU9OX1JFUVVJUkVEOwo+ICAgCQljc3ItPm1h
eF9md19zaXplID0gSUNMX0NTUl9NQVhfRldfU0laRTsKPiAtCX0gZWxzZSBpZiAoSVNfQ0FOTk9O
TEFLRShkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShpOTE1KSkgewo+
ICAgCQljc3ItPmZ3X3BhdGggPSBDTkxfQ1NSX1BBVEg7Cj4gICAJCWNzci0+cmVxdWlyZWRfdmVy
c2lvbiA9IENOTF9DU1JfVkVSU0lPTl9SRVFVSVJFRDsKPiAgIAkJY3NyLT5tYXhfZndfc2l6ZSA9
IENOTF9DU1JfTUFYX0ZXX1NJWkU7Cj4gLQl9IGVsc2UgaWYgKElTX0dFTUlOSUxBS0UoZGV2X3By
aXYpKSB7Cj4gKwl9IGVsc2UgaWYgKElTX0dFTUlOSUxBS0UoaTkxNSkpIHsKPiAgIAkJY3NyLT5m
d19wYXRoID0gR0xLX0NTUl9QQVRIOwo+ICAgCQljc3ItPnJlcXVpcmVkX3ZlcnNpb24gPSBHTEtf
Q1NSX1ZFUlNJT05fUkVRVUlSRUQ7Cj4gICAJCWNzci0+bWF4X2Z3X3NpemUgPSBHTEtfQ1NSX01B
WF9GV19TSVpFOwo+IC0JfSBlbHNlIGlmIChJU19LQUJZTEFLRShkZXZfcHJpdikgfHwgSVNfQ09G
RkVFTEFLRShkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAoSVNfS0FCWUxBS0UoaTkxNSkgfHwg
SVNfQ09GRkVFTEFLRShpOTE1KSkgewo+ICAgCQljc3ItPmZ3X3BhdGggPSBLQkxfQ1NSX1BBVEg7
Cj4gICAJCWNzci0+cmVxdWlyZWRfdmVyc2lvbiA9IEtCTF9DU1JfVkVSU0lPTl9SRVFVSVJFRDsK
PiAgIAkJY3NyLT5tYXhfZndfc2l6ZSA9IEtCTF9DU1JfTUFYX0ZXX1NJWkU7Cj4gLQl9IGVsc2Ug
aWYgKElTX1NLWUxBS0UoZGV2X3ByaXYpKSB7Cj4gKwl9IGVsc2UgaWYgKElTX1NLWUxBS0UoaTkx
NSkpIHsKPiAgIAkJY3NyLT5md19wYXRoID0gU0tMX0NTUl9QQVRIOwo+ICAgCQljc3ItPnJlcXVp
cmVkX3ZlcnNpb24gPSBTS0xfQ1NSX1ZFUlNJT05fUkVRVUlSRUQ7Cj4gICAJCWNzci0+bWF4X2Z3
X3NpemUgPSBTS0xfQ1NSX01BWF9GV19TSVpFOwo+IC0JfSBlbHNlIGlmIChJU19CUk9YVE9OKGRl
dl9wcml2KSkgewo+ICsJfSBlbHNlIGlmIChJU19CUk9YVE9OKGk5MTUpKSB7Cj4gICAJCWNzci0+
ZndfcGF0aCA9IEJYVF9DU1JfUEFUSDsKPiAgIAkJY3NyLT5yZXF1aXJlZF92ZXJzaW9uID0gQlhU
X0NTUl9WRVJTSU9OX1JFUVVJUkVEOwo+ICAgCQljc3ItPm1heF9md19zaXplID0gQlhUX0NTUl9N
QVhfRldfU0laRTsKPiBAQCAtNTUxLDYzICs1NTEsNjMgQEAgdm9pZCBpbnRlbF9jc3JfdWNvZGVf
aW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJfQo+ICAgCj4gICAJ
RFJNX0RFQlVHX0tNUygiTG9hZGluZyAlc1xuIiwgY3NyLT5md19wYXRoKTsKPiAtCXNjaGVkdWxl
X3dvcmsoJmRldl9wcml2LT5jc3Iud29yayk7Cj4gKwlzY2hlZHVsZV93b3JrKCZpOTE1LT5jc3Iu
d29yayk7Cj4gICB9Cj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxfY3NyX3Vjb2RlX3N1c3BlbmQo
KSAtIHByZXBhcmUgQ1NSIGZpcm13YXJlIGJlZm9yZSBzeXN0ZW0gc3VzcGVuZAo+IC0gKiBAZGV2
X3ByaXY6IGk5MTUgZHJtIGRldmljZQo+ICsgKiBAaTkxNTogaTkxNSBkcm0gZGV2aWNlCj4gICAg
Kgo+ICAgICogUHJlcGFyZSB0aGUgRE1DIGZpcm13YXJlIGJlZm9yZSBlbnRlcmluZyBzeXN0ZW0g
c3VzcGVuZC4gVGhpcyBpbmNsdWRlcwo+ICAgICogZmx1c2hpbmcgcGVuZGluZyB3b3JrIGl0ZW1z
IGFuZCByZWxlYXNpbmcgYW55IHJlc291cmNlcyBhY3F1aXJlZCBkdXJpbmcKPiAgICAqIGluaXQu
Cj4gICAgKi8KPiAtdm9pZCBpbnRlbF9jc3JfdWNvZGVfc3VzcGVuZChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgaW50ZWxfY3NyX3Vjb2RlX3N1c3BlbmQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlpZiAoIUhBU19DU1IoZGV2X3ByaXYp
KQo+ICsJaWYgKCFIQVNfQ1NSKGk5MTUpKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCWZsdXNoX3dv
cmsoJmRldl9wcml2LT5jc3Iud29yayk7Cj4gKwlmbHVzaF93b3JrKCZpOTE1LT5jc3Iud29yayk7
Cj4gICAKPiAgIAkvKiBEcm9wIHRoZSByZWZlcmVuY2UgaGVsZCBpbiBjYXNlIERNQyBpc24ndCBs
b2FkZWQuICovCj4gLQlpZiAoIWRldl9wcml2LT5jc3IuZG1jX3BheWxvYWQpCj4gLQkJaW50ZWxf
Y3NyX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2KTsKPiArCWlmICghaTkxNS0+Y3NyLmRtY19wYXls
b2FkKQo+ICsJCWludGVsX2Nzcl9ydW50aW1lX3BtX3B1dChpOTE1KTsKPiAgIH0KPiAgIAo+ICAg
LyoqCj4gICAgKiBpbnRlbF9jc3JfdWNvZGVfcmVzdW1lKCkgLSBpbml0IENTUiBmaXJtd2FyZSBk
dXJpbmcgc3lzdGVtIHJlc3VtZQo+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZHJtIGRldmljZQo+ICsg
KiBAaTkxNTogaTkxNSBkcm0gZGV2aWNlCj4gICAgKgo+ICAgICogUmVpbml0aWFsaXplIHRoZSBE
TUMgZmlybXdhcmUgZHVyaW5nIHN5c3RlbSByZXN1bWUsIHJlYWNxdWlyaW5nIGFueQo+ICAgICog
cmVzb3VyY2VzIHJlbGVhc2VkIGluIGludGVsX2Nzcl91Y29kZV9zdXNwZW5kKCkuCj4gICAgKi8K
PiAtdm9pZCBpbnRlbF9jc3JfdWNvZGVfcmVzdW1lKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiArdm9pZCBpbnRlbF9jc3JfdWNvZGVfcmVzdW1lKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQo+ICAgewo+IC0JaWYgKCFIQVNfQ1NSKGRldl9wcml2KSkKPiArCWlmICgh
SEFTX0NTUihpOTE1KSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJLyoKPiAgIAkgKiBSZWFjcXVp
cmUgdGhlIHJlZmVyZW5jZSB0byBrZWVwIFJQTSBkaXNhYmxlZCBpbiBjYXNlIERNQyBpc24ndAo+
ICAgCSAqIGxvYWRlZC4KPiAgIAkgKi8KPiAtCWlmICghZGV2X3ByaXYtPmNzci5kbWNfcGF5bG9h
ZCkKPiAtCQlpbnRlbF9jc3JfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOwo+ICsJaWYgKCFpOTE1
LT5jc3IuZG1jX3BheWxvYWQpCj4gKwkJaW50ZWxfY3NyX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOwo+
ICAgfQo+ICAgCj4gICAvKioKPiAgICAqIGludGVsX2Nzcl91Y29kZV9maW5pKCkgLSB1bmxvYWQg
dGhlIENTUiBmaXJtd2FyZS4KPiAtICogQGRldl9wcml2OiBpOTE1IGRybSBkZXZpY2UuCj4gKyAq
IEBpOTE1OiBpOTE1IGRybSBkZXZpY2UuCj4gICAgKgo+ICAgICogRmlybW13YXJlIHVubG9hZGlu
ZyBpbmNsdWRlcyBmcmVlaW5nIHRoZSBpbnRlcm5hbCBtZW1vcnkgYW5kIHJlc2V0IHRoZQo+ICAg
ICogZmlybXdhcmUgbG9hZGluZyBzdGF0dXMuCj4gICAgKi8KPiAtdm9pZCBpbnRlbF9jc3JfdWNv
ZGVfZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgaW50ZWxf
Y3NyX3Vjb2RlX2Zpbmkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlp
ZiAoIUhBU19DU1IoZGV2X3ByaXYpKQo+ICsJaWYgKCFIQVNfQ1NSKGk5MTUpKQo+ICAgCQlyZXR1
cm47Cj4gICAKPiAtCWludGVsX2Nzcl91Y29kZV9zdXNwZW5kKGRldl9wcml2KTsKPiAtCVdBUk5f
T04oZGV2X3ByaXYtPmNzci53YWtlcmVmKTsKPiArCWludGVsX2Nzcl91Y29kZV9zdXNwZW5kKGk5
MTUpOwo+ICsJV0FSTl9PTihpOTE1LT5jc3Iud2FrZXJlZik7Cj4gICAKPiAtCWtmcmVlKGRldl9w
cml2LT5jc3IuZG1jX3BheWxvYWQpOwo+ICsJa2ZyZWUoaTkxNS0+Y3NyLmRtY19wYXlsb2FkKTsK
PiAgIH0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGRpLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kZGkuYwo+IGluZGV4IDc5MjVhMTc2ZjkwMC4uZWI2
MTczMWYxYWJjIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RkaS5j
Cj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGRpLmMKPiBAQCAtNTg2LDkgKzU4
Niw5IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaWNsX21nX3BoeV9kZGlfYnVmX3RyYW5zIGljbF9t
Z19waHlfZGRpX3RyYW5zbGF0aW9uc1tdID0gewo+ICAgfTsKPiAgIAo+ICAgc3RhdGljIGNvbnN0
IHN0cnVjdCBkZGlfYnVmX3RyYW5zICoKPiAtYmR3X2dldF9idWZfdHJhbnNfZWRwKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50ICpuX2VudHJpZXMpCj4gK2Jkd19nZXRfYnVm
X3RyYW5zX2VkcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50ICpuX2VudHJpZXMp
Cj4gICB7Cj4gLQlpZiAoZGV2X3ByaXYtPnZidC5lZHAubG93X3Zzd2luZykgewo+ICsJaWYgKGk5
MTUtPnZidC5lZHAubG93X3Zzd2luZykgewo+ICAgCQkqbl9lbnRyaWVzID0gQVJSQVlfU0laRShi
ZHdfZGRpX3RyYW5zbGF0aW9uc19lZHApOwo+ICAgCQlyZXR1cm4gYmR3X2RkaV90cmFuc2xhdGlv
bnNfZWRwOwo+ICAgCX0gZWxzZSB7Cj4gQEAgLTU5OCwxMiArNTk4LDEyIEBAIGJkd19nZXRfYnVm
X3RyYW5zX2VkcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCAqbl9lbnRy
aWVzKQo+ICAgfQo+ICAgCj4gICBzdGF0aWMgY29uc3Qgc3RydWN0IGRkaV9idWZfdHJhbnMgKgo+
IC1za2xfZ2V0X2J1Zl90cmFuc19kcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
IGludCAqbl9lbnRyaWVzKQo+ICtza2xfZ2V0X2J1Zl90cmFuc19kcChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwgaW50ICpuX2VudHJpZXMpCj4gICB7Cj4gLQlpZiAoSVNfU0tMX1VMWChk
ZXZfcHJpdikpIHsKPiArCWlmIChJU19TS0xfVUxYKGk5MTUpKSB7Cj4gICAJCSpuX2VudHJpZXMg
PSBBUlJBWV9TSVpFKHNrbF95X2RkaV90cmFuc2xhdGlvbnNfZHApOwo+ICAgCQlyZXR1cm4gc2ts
X3lfZGRpX3RyYW5zbGF0aW9uc19kcDsKPiAtCX0gZWxzZSBpZiAoSVNfU0tMX1VMVChkZXZfcHJp
dikpIHsKPiArCX0gZWxzZSBpZiAoSVNfU0tMX1VMVChpOTE1KSkgewo+ICAgCQkqbl9lbnRyaWVz
ID0gQVJSQVlfU0laRShza2xfdV9kZGlfdHJhbnNsYXRpb25zX2RwKTsKPiAgIAkJcmV0dXJuIHNr
bF91X2RkaV90cmFuc2xhdGlvbnNfZHA7Cj4gICAJfSBlbHNlIHsKPiBAQCAtNjEzLDEyICs2MTMs
MTIgQEAgc2tsX2dldF9idWZfdHJhbnNfZHAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LCBpbnQgKm5fZW50cmllcykKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGNvbnN0IHN0cnVjdCBk
ZGlfYnVmX3RyYW5zICoKPiAta2JsX2dldF9idWZfdHJhbnNfZHAoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LCBpbnQgKm5fZW50cmllcykKPiAra2JsX2dldF9idWZfdHJhbnNfZHAo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGludCAqbl9lbnRyaWVzKQo+ICAgewo+IC0J
aWYgKElTX0tCTF9VTFgoZGV2X3ByaXYpIHx8IElTX0NGTF9VTFgoZGV2X3ByaXYpKSB7Cj4gKwlp
ZiAoSVNfS0JMX1VMWChpOTE1KSB8fCBJU19DRkxfVUxYKGk5MTUpKSB7Cj4gICAJCSpuX2VudHJp
ZXMgPSBBUlJBWV9TSVpFKGtibF95X2RkaV90cmFuc2xhdGlvbnNfZHApOwo+ICAgCQlyZXR1cm4g
a2JsX3lfZGRpX3RyYW5zbGF0aW9uc19kcDsKPiAtCX0gZWxzZSBpZiAoSVNfS0JMX1VMVChkZXZf
cHJpdikgfHwgSVNfQ0ZMX1VMVChkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAoSVNfS0JMX1VM
VChpOTE1KSB8fCBJU19DRkxfVUxUKGk5MTUpKSB7Cj4gICAJCSpuX2VudHJpZXMgPSBBUlJBWV9T
SVpFKGtibF91X2RkaV90cmFuc2xhdGlvbnNfZHApOwo+ICAgCQlyZXR1cm4ga2JsX3VfZGRpX3Ry
YW5zbGF0aW9uc19kcDsKPiAgIAl9IGVsc2Ugewo+IEBAIC02MjgsMTUgKzYyOCwxNSBAQCBrYmxf
Z2V0X2J1Zl90cmFuc19kcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCAq
bl9lbnRyaWVzKQo+ICAgfQo+ICAgCj4gICBzdGF0aWMgY29uc3Qgc3RydWN0IGRkaV9idWZfdHJh
bnMgKgo+IC1za2xfZ2V0X2J1Zl90cmFuc19lZHAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LCBpbnQgKm5fZW50cmllcykKPiArc2tsX2dldF9idWZfdHJhbnNfZWRwKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LCBpbnQgKm5fZW50cmllcykKPiAgIHsKPiAtCWlmIChkZXZf
cHJpdi0+dmJ0LmVkcC5sb3dfdnN3aW5nKSB7Cj4gLQkJaWYgKElTX1NLTF9VTFgoZGV2X3ByaXYp
IHx8IElTX0tCTF9VTFgoZGV2X3ByaXYpIHx8Cj4gLQkJICAgIElTX0NGTF9VTFgoZGV2X3ByaXYp
KSB7Cj4gKwlpZiAoaTkxNS0+dmJ0LmVkcC5sb3dfdnN3aW5nKSB7Cj4gKwkJaWYgKElTX1NLTF9V
TFgoaTkxNSkgfHwgSVNfS0JMX1VMWChpOTE1KSB8fAo+ICsJCSAgICBJU19DRkxfVUxYKGk5MTUp
KSB7Cj4gICAJCQkqbl9lbnRyaWVzID0gQVJSQVlfU0laRShza2xfeV9kZGlfdHJhbnNsYXRpb25z
X2VkcCk7Cj4gICAJCQlyZXR1cm4gc2tsX3lfZGRpX3RyYW5zbGF0aW9uc19lZHA7Cj4gLQkJfSBl
bHNlIGlmIChJU19TS0xfVUxUKGRldl9wcml2KSB8fCBJU19LQkxfVUxUKGRldl9wcml2KSB8fAo+
IC0JCQkgICBJU19DRkxfVUxUKGRldl9wcml2KSkgewo+ICsJCX0gZWxzZSBpZiAoSVNfU0tMX1VM
VChpOTE1KSB8fCBJU19LQkxfVUxUKGk5MTUpIHx8Cj4gKwkJCSAgIElTX0NGTF9VTFQoaTkxNSkp
IHsKPiAgIAkJCSpuX2VudHJpZXMgPSBBUlJBWV9TSVpFKHNrbF91X2RkaV90cmFuc2xhdGlvbnNf
ZWRwKTsKPiAgIAkJCXJldHVybiBza2xfdV9kZGlfdHJhbnNsYXRpb25zX2VkcDsKPiAgIAkJfSBl
bHNlIHsKPiBAQCAtNjQ1LDE3ICs2NDUsMTcgQEAgc2tsX2dldF9idWZfdHJhbnNfZWRwKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50ICpuX2VudHJpZXMpCj4gICAJCX0KPiAg
IAl9Cj4gICAKPiAtCWlmIChJU19LQUJZTEFLRShkZXZfcHJpdikgfHwgSVNfQ09GRkVFTEFLRShk
ZXZfcHJpdikpCj4gLQkJcmV0dXJuIGtibF9nZXRfYnVmX3RyYW5zX2RwKGRldl9wcml2LCBuX2Vu
dHJpZXMpOwo+ICsJaWYgKElTX0tBQllMQUtFKGk5MTUpIHx8IElTX0NPRkZFRUxBS0UoaTkxNSkp
Cj4gKwkJcmV0dXJuIGtibF9nZXRfYnVmX3RyYW5zX2RwKGk5MTUsIG5fZW50cmllcyk7Cj4gICAJ
ZWxzZQo+IC0JCXJldHVybiBza2xfZ2V0X2J1Zl90cmFuc19kcChkZXZfcHJpdiwgbl9lbnRyaWVz
KTsKPiArCQlyZXR1cm4gc2tsX2dldF9idWZfdHJhbnNfZHAoaTkxNSwgbl9lbnRyaWVzKTsKPiAg
IH0KPiAgIAo+ICAgc3RhdGljIGNvbnN0IHN0cnVjdCBkZGlfYnVmX3RyYW5zICoKPiAtc2tsX2dl
dF9idWZfdHJhbnNfaGRtaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCAq
bl9lbnRyaWVzKQo+ICtza2xfZ2V0X2J1Zl90cmFuc19oZG1pKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LCBpbnQgKm5fZW50cmllcykKPiAgIHsKPiAtCWlmIChJU19TS0xfVUxYKGRldl9w
cml2KSB8fCBJU19LQkxfVUxYKGRldl9wcml2KSB8fAo+IC0JICAgIElTX0NGTF9VTFgoZGV2X3By
aXYpKSB7Cj4gKwlpZiAoSVNfU0tMX1VMWChpOTE1KSB8fCBJU19LQkxfVUxYKGk5MTUpIHx8Cj4g
KwkgICAgSVNfQ0ZMX1VMWChpOTE1KSkgewo+ICAgCQkqbl9lbnRyaWVzID0gQVJSQVlfU0laRShz
a2xfeV9kZGlfdHJhbnNsYXRpb25zX2hkbWkpOwo+ICAgCQlyZXR1cm4gc2tsX3lfZGRpX3RyYW5z
bGF0aW9uc19oZG1pOwo+ICAgCX0gZWxzZSB7Cj4gQEAgLTY3NCwyMyArNjc0LDIzIEBAIHN0YXRp
YyBpbnQgc2tsX2J1Zl90cmFuc19udW1fZW50cmllcyhlbnVtIHBvcnQgcG9ydCwgaW50IG5fZW50
cmllcykKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGNvbnN0IHN0cnVjdCBkZGlfYnVmX3RyYW5zICoK
PiAtaW50ZWxfZGRpX2dldF9idWZfdHJhbnNfZHAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ICtpbnRlbF9kZGlfZ2V0X2J1Zl90cmFuc19kcChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiAgIAkJCSAgIGVudW0gcG9ydCBwb3J0LCBpbnQgKm5fZW50cmllcykKPiAg
IHsKPiAtCWlmIChJU19LQUJZTEFLRShkZXZfcHJpdikgfHwgSVNfQ09GRkVFTEFLRShkZXZfcHJp
dikpIHsKPiArCWlmIChJU19LQUJZTEFLRShpOTE1KSB8fCBJU19DT0ZGRUVMQUtFKGk5MTUpKSB7
Cj4gICAJCWNvbnN0IHN0cnVjdCBkZGlfYnVmX3RyYW5zICpkZGlfdHJhbnNsYXRpb25zID0KPiAt
CQkJa2JsX2dldF9idWZfdHJhbnNfZHAoZGV2X3ByaXYsIG5fZW50cmllcyk7Cj4gKwkJCWtibF9n
ZXRfYnVmX3RyYW5zX2RwKGk5MTUsIG5fZW50cmllcyk7Cj4gICAJCSpuX2VudHJpZXMgPSBza2xf
YnVmX3RyYW5zX251bV9lbnRyaWVzKHBvcnQsICpuX2VudHJpZXMpOwo+ICAgCQlyZXR1cm4gZGRp
X3RyYW5zbGF0aW9uczsKPiAtCX0gZWxzZSBpZiAoSVNfU0tZTEFLRShkZXZfcHJpdikpIHsKPiAr
CX0gZWxzZSBpZiAoSVNfU0tZTEFLRShpOTE1KSkgewo+ICAgCQljb25zdCBzdHJ1Y3QgZGRpX2J1
Zl90cmFucyAqZGRpX3RyYW5zbGF0aW9ucyA9Cj4gLQkJCXNrbF9nZXRfYnVmX3RyYW5zX2RwKGRl
dl9wcml2LCBuX2VudHJpZXMpOwo+ICsJCQlza2xfZ2V0X2J1Zl90cmFuc19kcChpOTE1LCBuX2Vu
dHJpZXMpOwo+ICAgCQkqbl9lbnRyaWVzID0gc2tsX2J1Zl90cmFuc19udW1fZW50cmllcyhwb3J0
LCAqbl9lbnRyaWVzKTsKPiAgIAkJcmV0dXJuIGRkaV90cmFuc2xhdGlvbnM7Cj4gLQl9IGVsc2Ug
aWYgKElTX0JST0FEV0VMTChkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAoSVNfQlJPQURXRUxM
KGk5MTUpKSB7Cj4gICAJCSpuX2VudHJpZXMgPSBBUlJBWV9TSVpFKGJkd19kZGlfdHJhbnNsYXRp
b25zX2RwKTsKPiAgIAkJcmV0dXJuICBiZHdfZGRpX3RyYW5zbGF0aW9uc19kcDsKPiAtCX0gZWxz
ZSBpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAoSVNfSEFTV0VMTChp
OTE1KSkgewo+ICAgCQkqbl9lbnRyaWVzID0gQVJSQVlfU0laRShoc3dfZGRpX3RyYW5zbGF0aW9u
c19kcCk7Cj4gICAJCXJldHVybiBoc3dfZGRpX3RyYW5zbGF0aW9uc19kcDsKPiAgIAl9Cj4gQEAg
LTcwMCwxNyArNzAwLDE3IEBAIGludGVsX2RkaV9nZXRfYnVmX3RyYW5zX2RwKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGNvbnN0IHN0cnVj
dCBkZGlfYnVmX3RyYW5zICoKPiAtaW50ZWxfZGRpX2dldF9idWZfdHJhbnNfZWRwKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAraW50ZWxfZGRpX2dldF9idWZfdHJhbnNfZWRw
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgIGVudW0gcG9ydCBwb3J0
LCBpbnQgKm5fZW50cmllcykKPiAgIHsKPiAtCWlmIChJU19HRU45X0JDKGRldl9wcml2KSkgewo+
ICsJaWYgKElTX0dFTjlfQkMoaTkxNSkpIHsKPiAgIAkJY29uc3Qgc3RydWN0IGRkaV9idWZfdHJh
bnMgKmRkaV90cmFuc2xhdGlvbnMgPQo+IC0JCQlza2xfZ2V0X2J1Zl90cmFuc19lZHAoZGV2X3By
aXYsIG5fZW50cmllcyk7Cj4gKwkJCXNrbF9nZXRfYnVmX3RyYW5zX2VkcChpOTE1LCBuX2VudHJp
ZXMpOwo+ICAgCQkqbl9lbnRyaWVzID0gc2tsX2J1Zl90cmFuc19udW1fZW50cmllcyhwb3J0LCAq
bl9lbnRyaWVzKTsKPiAgIAkJcmV0dXJuIGRkaV90cmFuc2xhdGlvbnM7Cj4gLQl9IGVsc2UgaWYg
KElTX0JST0FEV0VMTChkZXZfcHJpdikpIHsKPiAtCQlyZXR1cm4gYmR3X2dldF9idWZfdHJhbnNf
ZWRwKGRldl9wcml2LCBuX2VudHJpZXMpOwo+IC0JfSBlbHNlIGlmIChJU19IQVNXRUxMKGRldl9w
cml2KSkgewo+ICsJfSBlbHNlIGlmIChJU19CUk9BRFdFTEwoaTkxNSkpIHsKPiArCQlyZXR1cm4g
YmR3X2dldF9idWZfdHJhbnNfZWRwKGk5MTUsIG5fZW50cmllcyk7Cj4gKwl9IGVsc2UgaWYgKElT
X0hBU1dFTEwoaTkxNSkpIHsKPiAgIAkJKm5fZW50cmllcyA9IEFSUkFZX1NJWkUoaHN3X2RkaV90
cmFuc2xhdGlvbnNfZHApOwo+ICAgCQlyZXR1cm4gaHN3X2RkaV90cmFuc2xhdGlvbnNfZHA7Cj4g
ICAJfQo+IEBAIC03MjAsMTMgKzcyMCwxMyBAQCBpbnRlbF9kZGlfZ2V0X2J1Zl90cmFuc19lZHAo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgfQo+ICAgCj4gICBzdGF0aWMg
Y29uc3Qgc3RydWN0IGRkaV9idWZfdHJhbnMgKgo+IC1pbnRlbF9kZGlfZ2V0X2J1Zl90cmFuc19m
ZGkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtpbnRlbF9kZGlfZ2V0X2J1
Zl90cmFuc19mZGkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICAgaW50
ICpuX2VudHJpZXMpCj4gICB7Cj4gLQlpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSkgewo+ICsJ
aWYgKElTX0JST0FEV0VMTChpOTE1KSkgewo+ICAgCQkqbl9lbnRyaWVzID0gQVJSQVlfU0laRShi
ZHdfZGRpX3RyYW5zbGF0aW9uc19mZGkpOwo+ICAgCQlyZXR1cm4gYmR3X2RkaV90cmFuc2xhdGlv
bnNfZmRpOwo+IC0JfSBlbHNlIGlmIChJU19IQVNXRUxMKGRldl9wcml2KSkgewo+ICsJfSBlbHNl
IGlmIChJU19IQVNXRUxMKGk5MTUpKSB7Cj4gICAJCSpuX2VudHJpZXMgPSBBUlJBWV9TSVpFKGhz
d19kZGlfdHJhbnNsYXRpb25zX2ZkaSk7Cj4gICAJCXJldHVybiBoc3dfZGRpX3RyYW5zbGF0aW9u
c19mZGk7Cj4gICAJfQo+IEBAIC03MzYsMTUgKzczNiwxNSBAQCBpbnRlbF9kZGlfZ2V0X2J1Zl90
cmFuc19mZGkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgfQo+ICAgCj4g
ICBzdGF0aWMgY29uc3Qgc3RydWN0IGRkaV9idWZfdHJhbnMgKgo+IC1pbnRlbF9kZGlfZ2V0X2J1
Zl90cmFuc19oZG1pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAraW50ZWxf
ZGRpX2dldF9idWZfdHJhbnNfaGRtaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAg
IAkJCSAgICAgaW50ICpuX2VudHJpZXMpCj4gICB7Cj4gLQlpZiAoSVNfR0VOOV9CQyhkZXZfcHJp
dikpIHsKPiAtCQlyZXR1cm4gc2tsX2dldF9idWZfdHJhbnNfaGRtaShkZXZfcHJpdiwgbl9lbnRy
aWVzKTsKPiAtCX0gZWxzZSBpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSkgewo+ICsJaWYgKElT
X0dFTjlfQkMoaTkxNSkpIHsKPiArCQlyZXR1cm4gc2tsX2dldF9idWZfdHJhbnNfaGRtaShpOTE1
LCBuX2VudHJpZXMpOwo+ICsJfSBlbHNlIGlmIChJU19CUk9BRFdFTEwoaTkxNSkpIHsKPiAgIAkJ
Km5fZW50cmllcyA9IEFSUkFZX1NJWkUoYmR3X2RkaV90cmFuc2xhdGlvbnNfaGRtaSk7Cj4gICAJ
CXJldHVybiBiZHdfZGRpX3RyYW5zbGF0aW9uc19oZG1pOwo+IC0JfSBlbHNlIGlmIChJU19IQVNX
RUxMKGRldl9wcml2KSkgewo+ICsJfSBlbHNlIGlmIChJU19IQVNXRUxMKGk5MTUpKSB7Cj4gICAJ
CSpuX2VudHJpZXMgPSBBUlJBWV9TSVpFKGhzd19kZGlfdHJhbnNsYXRpb25zX2hkbWkpOwo+ICAg
CQlyZXR1cm4gaHN3X2RkaV90cmFuc2xhdGlvbnNfaGRtaTsKPiAgIAl9Cj4gQEAgLTc1NCwzMiAr
NzU0LDMyIEBAIGludGVsX2RkaV9nZXRfYnVmX3RyYW5zX2hkbWkoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ICAgfQo+ICAgCj4gICBzdGF0aWMgY29uc3Qgc3RydWN0IGJ4dF9k
ZGlfYnVmX3RyYW5zICoKPiAtYnh0X2dldF9idWZfdHJhbnNfZHAoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LCBpbnQgKm5fZW50cmllcykKPiArYnh0X2dldF9idWZfdHJhbnNfZHAo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGludCAqbl9lbnRyaWVzKQo+ICAgewo+ICAg
CSpuX2VudHJpZXMgPSBBUlJBWV9TSVpFKGJ4dF9kZGlfdHJhbnNsYXRpb25zX2RwKTsKPiAgIAly
ZXR1cm4gYnh0X2RkaV90cmFuc2xhdGlvbnNfZHA7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBjb25z
dCBzdHJ1Y3QgYnh0X2RkaV9idWZfdHJhbnMgKgo+IC1ieHRfZ2V0X2J1Zl90cmFuc19lZHAoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgKm5fZW50cmllcykKPiArYnh0X2dl
dF9idWZfdHJhbnNfZWRwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBpbnQgKm5fZW50
cmllcykKPiAgIHsKPiAtCWlmIChkZXZfcHJpdi0+dmJ0LmVkcC5sb3dfdnN3aW5nKSB7Cj4gKwlp
ZiAoaTkxNS0+dmJ0LmVkcC5sb3dfdnN3aW5nKSB7Cj4gICAJCSpuX2VudHJpZXMgPSBBUlJBWV9T
SVpFKGJ4dF9kZGlfdHJhbnNsYXRpb25zX2VkcCk7Cj4gICAJCXJldHVybiBieHRfZGRpX3RyYW5z
bGF0aW9uc19lZHA7Cj4gICAJfQo+ICAgCj4gLQlyZXR1cm4gYnh0X2dldF9idWZfdHJhbnNfZHAo
ZGV2X3ByaXYsIG5fZW50cmllcyk7Cj4gKwlyZXR1cm4gYnh0X2dldF9idWZfdHJhbnNfZHAoaTkx
NSwgbl9lbnRyaWVzKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGNvbnN0IHN0cnVjdCBieHRfZGRp
X2J1Zl90cmFucyAqCj4gLWJ4dF9nZXRfYnVmX3RyYW5zX2hkbWkoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LCBpbnQgKm5fZW50cmllcykKPiArYnh0X2dldF9idWZfdHJhbnNfaGRt
aShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50ICpuX2VudHJpZXMpCj4gICB7Cj4g
ICAJKm5fZW50cmllcyA9IEFSUkFZX1NJWkUoYnh0X2RkaV90cmFuc2xhdGlvbnNfaGRtaSk7Cj4g
ICAJcmV0dXJuIGJ4dF9kZGlfdHJhbnNsYXRpb25zX2hkbWk7Cj4gICB9Cj4gICAKPiAgIHN0YXRp
YyBjb25zdCBzdHJ1Y3QgY25sX2RkaV9idWZfdHJhbnMgKgo+IC1jbmxfZ2V0X2J1Zl90cmFuc19o
ZG1pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50ICpuX2VudHJpZXMpCj4g
K2NubF9nZXRfYnVmX3RyYW5zX2hkbWkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGlu
dCAqbl9lbnRyaWVzKQo+ICAgewo+ICAgCXUzMiB2b2x0YWdlID0gSTkxNV9SRUFEKENOTF9QT1JU
X0NPTVBfRFczKSAmIFZPTFRBR0VfSU5GT19NQVNLOwo+ICAgCj4gQEAgLTgwMCw3ICs4MDAsNyBA
QCBjbmxfZ2V0X2J1Zl90cmFuc19oZG1pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwgaW50ICpuX2VudHJpZXMpCj4gICB9Cj4gICAKPiAgIHN0YXRpYyBjb25zdCBzdHJ1Y3QgY25s
X2RkaV9idWZfdHJhbnMgKgo+IC1jbmxfZ2V0X2J1Zl90cmFuc19kcChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsIGludCAqbl9lbnRyaWVzKQo+ICtjbmxfZ2V0X2J1Zl90cmFuc19k
cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50ICpuX2VudHJpZXMpCj4gICB7Cj4g
ICAJdTMyIHZvbHRhZ2UgPSBJOTE1X1JFQUQoQ05MX1BPUlRfQ09NUF9EVzMpICYgVk9MVEFHRV9J
TkZPX01BU0s7Cj4gICAKPiBAQCAtODIxLDExICs4MjEsMTEgQEAgY25sX2dldF9idWZfdHJhbnNf
ZHAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgKm5fZW50cmllcykKPiAg
IH0KPiAgIAo+ICAgc3RhdGljIGNvbnN0IHN0cnVjdCBjbmxfZGRpX2J1Zl90cmFucyAqCj4gLWNu
bF9nZXRfYnVmX3RyYW5zX2VkcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGlu
dCAqbl9lbnRyaWVzKQo+ICtjbmxfZ2V0X2J1Zl90cmFuc19lZHAoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsIGludCAqbl9lbnRyaWVzKQo+ICAgewo+ICAgCXUzMiB2b2x0YWdlID0gSTkx
NV9SRUFEKENOTF9QT1JUX0NPTVBfRFczKSAmIFZPTFRBR0VfSU5GT19NQVNLOwo+ICAgCj4gLQlp
ZiAoZGV2X3ByaXYtPnZidC5lZHAubG93X3Zzd2luZykgewo+ICsJaWYgKGk5MTUtPnZidC5lZHAu
bG93X3Zzd2luZykgewo+ICAgCQlpZiAodm9sdGFnZSA9PSBWT0xUQUdFX0lORk9fMF84NVYpIHsK
PiAgIAkJCSpuX2VudHJpZXMgPSBBUlJBWV9TSVpFKGNubF9kZGlfdHJhbnNsYXRpb25zX2VkcF8w
Xzg1Vik7Cj4gICAJCQlyZXR1cm4gY25sX2RkaV90cmFuc2xhdGlvbnNfZWRwXzBfODVWOwo+IEBA
IC04NDEsMTIgKzg0MSwxMiBAQCBjbmxfZ2V0X2J1Zl90cmFuc19lZHAoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgKm5fZW50cmllcykKPiAgIAkJfQo+ICAgCQlyZXR1cm4g
TlVMTDsKPiAgIAl9IGVsc2Ugewo+IC0JCXJldHVybiBjbmxfZ2V0X2J1Zl90cmFuc19kcChkZXZf
cHJpdiwgbl9lbnRyaWVzKTsKPiArCQlyZXR1cm4gY25sX2dldF9idWZfdHJhbnNfZHAoaTkxNSwg
bl9lbnRyaWVzKTsKPiAgIAl9Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBjb25zdCBzdHJ1Y3QgY25s
X2RkaV9idWZfdHJhbnMgKgo+IC1pY2xfZ2V0X2NvbWJvX2J1Zl90cmFucyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcG9ydCBwb3J0LAo+ICtpY2xfZ2V0X2NvbWJvX2J1
Zl90cmFucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBwb3J0IHBvcnQsCj4g
ICAJCQlpbnQgdHlwZSwgaW50IHJhdGUsIGludCAqbl9lbnRyaWVzKQo+ICAgewo+ICAgCWlmICh0
eXBlID09IElOVEVMX09VVFBVVF9IRE1JKSB7Cj4gQEAgLTg1NSw3ICs4NTUsNyBAQCBpY2xfZ2V0
X2NvbWJvX2J1Zl90cmFucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0g
cG9ydCBwb3J0LAo+ICAgCX0gZWxzZSBpZiAocmF0ZSA+IDU0MDAwMCAmJiB0eXBlID09IElOVEVM
X09VVFBVVF9FRFApIHsKPiAgIAkJKm5fZW50cmllcyA9IEFSUkFZX1NJWkUoaWNsX2NvbWJvX3Bo
eV9kZGlfdHJhbnNsYXRpb25zX2VkcF9oYnIzKTsKPiAgIAkJcmV0dXJuIGljbF9jb21ib19waHlf
ZGRpX3RyYW5zbGF0aW9uc19lZHBfaGJyMzsKPiAtCX0gZWxzZSBpZiAodHlwZSA9PSBJTlRFTF9P
VVRQVVRfRURQICYmIGRldl9wcml2LT52YnQuZWRwLmxvd192c3dpbmcpIHsKPiArCX0gZWxzZSBp
ZiAodHlwZSA9PSBJTlRFTF9PVVRQVVRfRURQICYmIGk5MTUtPnZidC5lZHAubG93X3Zzd2luZykg
ewo+ICAgCQkqbl9lbnRyaWVzID0gQVJSQVlfU0laRShpY2xfY29tYm9fcGh5X2RkaV90cmFuc2xh
dGlvbnNfZWRwX2hicjIpOwo+ICAgCQlyZXR1cm4gaWNsX2NvbWJvX3BoeV9kZGlfdHJhbnNsYXRp
b25zX2VkcF9oYnIyOwo+ICAgCX0KPiBAQCAtODY0LDMzICs4NjQsMzMgQEAgaWNsX2dldF9jb21i
b19idWZfdHJhbnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBvcnQg
cG9ydCwKPiAgIAlyZXR1cm4gaWNsX2NvbWJvX3BoeV9kZGlfdHJhbnNsYXRpb25zX2RwX2hicjI7
Cj4gICB9Cj4gICAKPiAtc3RhdGljIGludCBpbnRlbF9kZGlfaGRtaV9sZXZlbChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcG9ydCBwb3J0KQo+ICtzdGF0aWMgaW50IGlu
dGVsX2RkaV9oZG1pX2xldmVsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBv
cnQgcG9ydCkKPiAgIHsKPiAgIAlpbnQgbl9lbnRyaWVzLCBsZXZlbCwgZGVmYXVsdF9lbnRyeTsK
PiAgIAo+IC0JbGV2ZWwgPSBkZXZfcHJpdi0+dmJ0LmRkaV9wb3J0X2luZm9bcG9ydF0uaGRtaV9s
ZXZlbF9zaGlmdDsKPiArCWxldmVsID0gaTkxNS0+dmJ0LmRkaV9wb3J0X2luZm9bcG9ydF0uaGRt
aV9sZXZlbF9zaGlmdDsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpIHsK
PiAtCQlpZiAoaW50ZWxfcG9ydF9pc19jb21ib3BoeShkZXZfcHJpdiwgcG9ydCkpCj4gLQkJCWlj
bF9nZXRfY29tYm9fYnVmX3RyYW5zKGRldl9wcml2LCBwb3J0LCBJTlRFTF9PVVRQVVRfSERNSSwK
PiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpIHsKPiArCQlpZiAoaW50ZWxfcG9ydF9pc19j
b21ib3BoeShpOTE1LCBwb3J0KSkKPiArCQkJaWNsX2dldF9jb21ib19idWZfdHJhbnMoaTkxNSwg
cG9ydCwgSU5URUxfT1VUUFVUX0hETUksCj4gICAJCQkJCQkwLCAmbl9lbnRyaWVzKTsKPiAgIAkJ
ZWxzZQo+ICAgCQkJbl9lbnRyaWVzID0gQVJSQVlfU0laRShpY2xfbWdfcGh5X2RkaV90cmFuc2xh
dGlvbnMpOwo+ICAgCQlkZWZhdWx0X2VudHJ5ID0gbl9lbnRyaWVzIC0gMTsKPiAtCX0gZWxzZSBp
ZiAoSVNfQ0FOTk9OTEFLRShkZXZfcHJpdikpIHsKPiAtCQljbmxfZ2V0X2J1Zl90cmFuc19oZG1p
KGRldl9wcml2LCAmbl9lbnRyaWVzKTsKPiArCX0gZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShpOTE1
KSkgewo+ICsJCWNubF9nZXRfYnVmX3RyYW5zX2hkbWkoaTkxNSwgJm5fZW50cmllcyk7Cj4gICAJ
CWRlZmF1bHRfZW50cnkgPSBuX2VudHJpZXMgLSAxOwo+IC0JfSBlbHNlIGlmIChJU19HRU45X0xQ
KGRldl9wcml2KSkgewo+IC0JCWJ4dF9nZXRfYnVmX3RyYW5zX2hkbWkoZGV2X3ByaXYsICZuX2Vu
dHJpZXMpOwo+ICsJfSBlbHNlIGlmIChJU19HRU45X0xQKGk5MTUpKSB7Cj4gKwkJYnh0X2dldF9i
dWZfdHJhbnNfaGRtaShpOTE1LCAmbl9lbnRyaWVzKTsKPiAgIAkJZGVmYXVsdF9lbnRyeSA9IG5f
ZW50cmllcyAtIDE7Cj4gLQl9IGVsc2UgaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpKSB7Cj4gLQkJ
aW50ZWxfZGRpX2dldF9idWZfdHJhbnNfaGRtaShkZXZfcHJpdiwgJm5fZW50cmllcyk7Cj4gKwl9
IGVsc2UgaWYgKElTX0dFTjlfQkMoaTkxNSkpIHsKPiArCQlpbnRlbF9kZGlfZ2V0X2J1Zl90cmFu
c19oZG1pKGk5MTUsICZuX2VudHJpZXMpOwo+ICAgCQlkZWZhdWx0X2VudHJ5ID0gODsKPiAtCX0g
ZWxzZSBpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSkgewo+IC0JCWludGVsX2RkaV9nZXRfYnVm
X3RyYW5zX2hkbWkoZGV2X3ByaXYsICZuX2VudHJpZXMpOwo+ICsJfSBlbHNlIGlmIChJU19CUk9B
RFdFTEwoaTkxNSkpIHsKPiArCQlpbnRlbF9kZGlfZ2V0X2J1Zl90cmFuc19oZG1pKGk5MTUsICZu
X2VudHJpZXMpOwo+ICAgCQlkZWZhdWx0X2VudHJ5ID0gNzsKPiAtCX0gZWxzZSBpZiAoSVNfSEFT
V0VMTChkZXZfcHJpdikpIHsKPiAtCQlpbnRlbF9kZGlfZ2V0X2J1Zl90cmFuc19oZG1pKGRldl9w
cml2LCAmbl9lbnRyaWVzKTsKPiArCX0gZWxzZSBpZiAoSVNfSEFTV0VMTChpOTE1KSkgewo+ICsJ
CWludGVsX2RkaV9nZXRfYnVmX3RyYW5zX2hkbWkoaTkxNSwgJm5fZW50cmllcyk7Cj4gICAJCWRl
ZmF1bHRfZW50cnkgPSA2Owo+ICAgCX0gZWxzZSB7Cj4gICAJCVdBUk4oMSwgImRkaSB0cmFuc2xh
dGlvbiB0YWJsZSBtaXNzaW5nXG4iKTsKPiBAQCAtOTE3LDI1ICs5MTcsMjUgQEAgc3RhdGljIGlu
dCBpbnRlbF9kZGlfaGRtaV9sZXZlbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
IGVudW0gcG9ydCBwb3IKPiAgIHN0YXRpYyB2b2lkIGludGVsX3ByZXBhcmVfZHBfZGRpX2J1ZmZl
cnMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkJCSBjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAg
IAl1MzIgaWJvb3N0X2JpdCA9IDA7Cj4gICAJaW50IGksIG5fZW50cmllczsKPiAgIAllbnVtIHBv
cnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4gICAJY29uc3Qgc3RydWN0IGRkaV9idWZfdHJhbnMg
KmRkaV90cmFuc2xhdGlvbnM7Cj4gICAKPiAgIAlpZiAoaW50ZWxfY3J0Y19oYXNfdHlwZShjcnRj
X3N0YXRlLCBJTlRFTF9PVVRQVVRfQU5BTE9HKSkKPiAtCQlkZGlfdHJhbnNsYXRpb25zID0gaW50
ZWxfZGRpX2dldF9idWZfdHJhbnNfZmRpKGRldl9wcml2LAo+ICsJCWRkaV90cmFuc2xhdGlvbnMg
PSBpbnRlbF9kZGlfZ2V0X2J1Zl90cmFuc19mZGkoaTkxNSwKPiAgIAkJCQkJCQkgICAgICAgJm5f
ZW50cmllcyk7Cj4gICAJZWxzZSBpZiAoaW50ZWxfY3J0Y19oYXNfdHlwZShjcnRjX3N0YXRlLCBJ
TlRFTF9PVVRQVVRfRURQKSkKPiAtCQlkZGlfdHJhbnNsYXRpb25zID0gaW50ZWxfZGRpX2dldF9i
dWZfdHJhbnNfZWRwKGRldl9wcml2LCBwb3J0LAo+ICsJCWRkaV90cmFuc2xhdGlvbnMgPSBpbnRl
bF9kZGlfZ2V0X2J1Zl90cmFuc19lZHAoaTkxNSwgcG9ydCwKPiAgIAkJCQkJCQkgICAgICAgJm5f
ZW50cmllcyk7Cj4gICAJZWxzZQo+IC0JCWRkaV90cmFuc2xhdGlvbnMgPSBpbnRlbF9kZGlfZ2V0
X2J1Zl90cmFuc19kcChkZXZfcHJpdiwgcG9ydCwKPiArCQlkZGlfdHJhbnNsYXRpb25zID0gaW50
ZWxfZGRpX2dldF9idWZfdHJhbnNfZHAoaTkxNSwgcG9ydCwKPiAgIAkJCQkJCQkgICAgICAmbl9l
bnRyaWVzKTsKPiAgIAo+ICAgCS8qIElmIHdlJ3JlIGJvb3N0aW5nIHRoZSBjdXJyZW50LCBzZXQg
Yml0IDMxIG9mIHRyYW5zMSAqLwo+IC0JaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpICYmCj4gLQkg
ICAgZGV2X3ByaXYtPnZidC5kZGlfcG9ydF9pbmZvW3BvcnRdLmRwX2Jvb3N0X2xldmVsKQo+ICsJ
aWYgKElTX0dFTjlfQkMoaTkxNSkgJiYKPiArCSAgICBpOTE1LT52YnQuZGRpX3BvcnRfaW5mb1tw
b3J0XS5kcF9ib29zdF9sZXZlbCkKPiAgIAkJaWJvb3N0X2JpdCA9IERESV9CVUZfQkFMQU5DRV9M
RUdfRU5BQkxFOwo+ICAgCj4gICAJZm9yIChpID0gMDsgaSA8IG5fZW50cmllczsgaSsrKSB7Cj4g
QEAgLTk1NCwxMyArOTU0LDEzIEBAIHN0YXRpYyB2b2lkIGludGVsX3ByZXBhcmVfZHBfZGRpX2J1
ZmZlcnMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICBzdGF0aWMgdm9pZCBpbnRl
bF9wcmVwYXJlX2hkbWlfZGRpX2J1ZmZlcnMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
Cj4gICAJCQkJCSAgIGludCBsZXZlbCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAl1MzIg
aWJvb3N0X2JpdCA9IDA7Cj4gICAJaW50IG5fZW50cmllczsKPiAgIAllbnVtIHBvcnQgcG9ydCA9
IGVuY29kZXItPnBvcnQ7Cj4gICAJY29uc3Qgc3RydWN0IGRkaV9idWZfdHJhbnMgKmRkaV90cmFu
c2xhdGlvbnM7Cj4gICAKPiAtCWRkaV90cmFuc2xhdGlvbnMgPSBpbnRlbF9kZGlfZ2V0X2J1Zl90
cmFuc19oZG1pKGRldl9wcml2LCAmbl9lbnRyaWVzKTsKPiArCWRkaV90cmFuc2xhdGlvbnMgPSBp
bnRlbF9kZGlfZ2V0X2J1Zl90cmFuc19oZG1pKGk5MTUsICZuX2VudHJpZXMpOwo+ICAgCj4gICAJ
aWYgKFdBUk5fT05fT05DRSghZGRpX3RyYW5zbGF0aW9ucykpCj4gICAJCXJldHVybjsKPiBAQCAt
OTY4LDggKzk2OCw4IEBAIHN0YXRpYyB2b2lkIGludGVsX3ByZXBhcmVfaGRtaV9kZGlfYnVmZmVy
cyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJbGV2ZWwgPSBuX2VudHJpZXMg
LSAxOwo+ICAgCj4gICAJLyogSWYgd2UncmUgYm9vc3RpbmcgdGhlIGN1cnJlbnQsIHNldCBiaXQg
MzEgb2YgdHJhbnMxICovCj4gLQlpZiAoSVNfR0VOOV9CQyhkZXZfcHJpdikgJiYKPiAtCSAgICBk
ZXZfcHJpdi0+dmJ0LmRkaV9wb3J0X2luZm9bcG9ydF0uaGRtaV9ib29zdF9sZXZlbCkKPiArCWlm
IChJU19HRU45X0JDKGk5MTUpICYmCj4gKwkgICAgaTkxNS0+dmJ0LmRkaV9wb3J0X2luZm9bcG9y
dF0uaGRtaV9ib29zdF9sZXZlbCkKPiAgIAkJaWJvb3N0X2JpdCA9IERESV9CVUZfQkFMQU5DRV9M
RUdfRU5BQkxFOwo+ICAgCj4gICAJLyogRW50cnkgOSBpcyBmb3IgSERNSTogKi8KPiBAQCAtOTc5
LDcgKzk3OSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3ByZXBhcmVfaGRtaV9kZGlfYnVmZmVycyhz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJICAgZGRpX3RyYW5zbGF0aW9uc1ts
ZXZlbF0udHJhbnMyKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpbnRlbF93YWl0X2RkaV9i
dWZfaWRsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lk
IGludGVsX3dhaXRfZGRpX2J1Zl9pZGxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+
ICAgCQkJCSAgICBlbnVtIHBvcnQgcG9ydCkKPiAgIHsKPiAgIAlpOTE1X3JlZ190IHJlZyA9IERE
SV9CVUZfQ1RMKHBvcnQpOwo+IEBAIC0xMDY0LDcgKzEwNjQsNyBAQCB2b2lkIGhzd19mZGlfbGlu
a190cmFpbihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAkJCWNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgewo+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYgPSBjcnRjLT5iYXNlLmRldjsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShkZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyOwo+ICAgCXUzMiB0
ZW1wLCBpLCByeF9jdGxfdmFsLCBkZGlfcGxsX3NlbDsKPiAgIAo+IEBAIC0xMDg1LDcgKzEwODUs
NyBAQCB2b2lkIGhzd19mZGlfbGlua190cmFpbihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAg
IAkJCQkgIEZESV9SWF9UUDFfVE9fVFAyXzQ4IHwgRkRJX1JYX0ZESV9ERUxBWV85MCk7Cj4gICAK
PiAgIAkvKiBFbmFibGUgdGhlIFBDSCBSZWNlaXZlciBGREkgUExMICovCj4gLQlyeF9jdGxfdmFs
ID0gZGV2X3ByaXYtPmZkaV9yeF9jb25maWcgfCBGRElfUlhfRU5IQU5DRV9GUkFNRV9FTkFCTEUg
fAo+ICsJcnhfY3RsX3ZhbCA9IGk5MTUtPmZkaV9yeF9jb25maWcgfCBGRElfUlhfRU5IQU5DRV9G
UkFNRV9FTkFCTEUgfAo+ICAgCQkgICAgIEZESV9SWF9QTExfRU5BQkxFIHwKPiAgIAkJICAgICBG
RElfRFBfUE9SVF9XSURUSChjcnRjX3N0YXRlLT5mZGlfbGFuZXMpOwo+ICAgCUk5MTVfV1JJVEUo
RkRJX1JYX0NUTChQSVBFX0EpLCByeF9jdGxfdmFsKTsKPiBAQCAtMTE3NCw3ICsxMTc0LDcgQEAg
dm9pZCBoc3dfZmRpX2xpbmtfdHJhaW4oc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gICAJCUk5
MTVfV1JJVEUoRFBfVFBfQ1RMKFBPUlRfRSksIHRlbXApOwo+ICAgCQlQT1NUSU5HX1JFQUQoRFBf
VFBfQ1RMKFBPUlRfRSkpOwo+ICAgCj4gLQkJaW50ZWxfd2FpdF9kZGlfYnVmX2lkbGUoZGV2X3By
aXYsIFBPUlRfRSk7Cj4gKwkJaW50ZWxfd2FpdF9kZGlfYnVmX2lkbGUoaTkxNSwgUE9SVF9FKTsK
PiAgIAo+ICAgCQkvKiBSZXNldCBGRElfUlhfTUlTQyBwd3JkbiBsYW5lcyAqLwo+ICAgCQl0ZW1w
ID0gSTkxNV9SRUFEKEZESV9SWF9NSVNDKFBJUEVfQSkpOwo+IEBAIC0xMjIzLDcgKzEyMjMsNyBA
QCBpbnRlbF9kZGlfZ2V0X2NydGNfZW5jb2RlcihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiAg
IAlyZXR1cm4gcmV0Owo+ICAgfQo+ICAgCj4gLXN0YXRpYyBpbnQgaHN3X2RkaV9jYWxjX3dycGxs
X2xpbmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgaW50IGhz
d19kZGlfY2FsY193cnBsbF9saW5rKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAg
CQkJCSAgIGk5MTVfcmVnX3QgcmVnKQo+ICAgewo+ICAgCWludCByZWZjbGs7Cj4gQEAgLTEyMzgs
NyArMTIzOCw3IEBAIHN0YXRpYyBpbnQgaHN3X2RkaV9jYWxjX3dycGxsX2xpbmsoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCQkgKiBub24tU1NDIGZvciBub24tVUxUIEhT
Vy4gQ2hlY2sgRlVTRV9TVFJBUDMKPiAgIAkJICogZm9yIHRoZSBub24tU1NDIHJlZmVyZW5jZSBm
cmVxdWVuY3kuCj4gICAJCSAqLwo+IC0JCWlmIChJU19IQVNXRUxMKGRldl9wcml2KSAmJiAhSVNf
SFNXX1VMVChkZXZfcHJpdikpIHsKPiArCQlpZiAoSVNfSEFTV0VMTChpOTE1KSAmJiAhSVNfSFNX
X1VMVChpOTE1KSkgewo+ICAgCQkJaWYgKEk5MTVfUkVBRChGVVNFX1NUUkFQMykgJiBIU1dfUkVG
X0NMS19TRUxFQ1QpCj4gICAJCQkJcmVmY2xrID0gMjQ7Cj4gICAJCQllbHNlCj4gQEAgLTEzMjUs
NyArMTMyNSw3IEBAIHN0YXRpYyBpbnQgc2tsX2NhbGNfd3JwbGxfbGluayhjb25zdCBzdHJ1Y3Qg
aW50ZWxfZHBsbF9od19zdGF0ZSAqcGxsX3N0YXRlKQo+ICAgCXJldHVybiBkY29fZnJlcSAvIChw
MCAqIHAxICogcDIgKiA1KTsKPiAgIH0KPiAgIAo+IC1pbnQgY25sX2NhbGNfd3JwbGxfbGluayhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2ludCBjbmxfY2FsY193cnBsbF9s
aW5rKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJc3RydWN0IGludGVsX2Rw
bGxfaHdfc3RhdGUgKnBsbF9zdGF0ZSkKPiAgIHsKPiAgIAl1MzIgcDAsIHAxLCBwMiwgZGNvX2Zy
ZXEsIHJlZl9jbG9jazsKPiBAQCAtMTM2Nyw3ICsxMzY3LDcgQEAgaW50IGNubF9jYWxjX3dycGxs
X2xpbmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCQlicmVhazsKPiAg
IAl9Cj4gICAKPiAtCXJlZl9jbG9jayA9IGNubF9oZG1pX3BsbF9yZWZfY2xvY2soZGV2X3ByaXYp
Owo+ICsJcmVmX2Nsb2NrID0gY25sX2hkbWlfcGxsX3JlZl9jbG9jayhpOTE1KTsKPiAgIAo+ICAg
CWRjb19mcmVxID0gKHBsbF9zdGF0ZS0+Y2ZnY3IwICYgRFBMTF9DRkdDUjBfRENPX0lOVEVHRVJf
TUFTSykKPiAgIAkJKiByZWZfY2xvY2s7Cj4gQEAgLTEzODEsNyArMTM4MSw3IEBAIGludCBjbmxf
Y2FsY193cnBsbF9saW5rKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAly
ZXR1cm4gZGNvX2ZyZXEgLyAocDAgKiBwMSAqIHAyICogNSk7Cj4gICB9Cj4gICAKPiAtc3RhdGlj
IGludCBpY2xfY2FsY190YnRfcGxsX2xpbmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ICtzdGF0aWMgaW50IGljbF9jYWxjX3RidF9wbGxfbGluayhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgZW51bSBwb3J0IHBvcnQpCj4gICB7Cj4gICAJdTMyIHZh
bCA9IEk5MTVfUkVBRChERElfQ0xLX1NFTChwb3J0KSkgJiBERElfQ0xLX1NFTF9NQVNLOwo+IEBA
IC0xNDAzLDEzICsxNDAzLDEzIEBAIHN0YXRpYyBpbnQgaWNsX2NhbGNfdGJ0X3BsbF9saW5rKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAl9Cj4gICB9Cj4gICAKPiAtc3Rh
dGljIGludCBpY2xfY2FsY19tZ19wbGxfbGluayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gK3N0YXRpYyBpbnQgaWNsX2NhbGNfbWdfcGxsX2xpbmsoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJY29uc3Qgc3RydWN0IGludGVsX2RwbGxfaHdfc3RhdGUg
KnBsbF9zdGF0ZSkKPiAgIHsKPiAgIAl1MzIgbTEsIG0yX2ludCwgbTJfZnJhYywgZGl2MSwgZGl2
MiwgcmVmX2Nsb2NrOwo+ICAgCXU2NCB0bXA7Cj4gICAKPiAtCXJlZl9jbG9jayA9IGRldl9wcml2
LT5jZGNsay5ody5yZWY7Cj4gKwlyZWZfY2xvY2sgPSBpOTE1LT5jZGNsay5ody5yZWY7Cj4gICAK
PiAgIAltMSA9IHBsbF9zdGF0ZS0+bWdfcGxsX2RpdjEgJiBNR19QTExfRElWMV9GQlBSRURJVl9N
QVNLOwo+ICAgCW0yX2ludCA9IHBsbF9zdGF0ZS0+bWdfcGxsX2RpdjAgJiBNR19QTExfRElWMF9G
QkRJVl9JTlRfTUFTSzsKPiBAQCAtMTQ4MywyMSArMTQ4MywyMSBAQCBzdGF0aWMgdm9pZCBkZGlf
ZG90Y2xvY2tfZ2V0KHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiAgIHN0
YXRpYyB2b2lkIGljbF9kZGlfY2xvY2tfZ2V0KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ICAgCQkJICAgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ICAg
ewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVy
LT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
ZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9kcGxsX2h3X3N0YXRlICpwbGxf
c3RhdGUgPSAmcGlwZV9jb25maWctPmRwbGxfaHdfc3RhdGU7Cj4gICAJZW51bSBwb3J0IHBvcnQg
PSBlbmNvZGVyLT5wb3J0Owo+ICAgCWludCBsaW5rX2Nsb2NrOwo+ICAgCj4gLQlpZiAoaW50ZWxf
cG9ydF9pc19jb21ib3BoeShkZXZfcHJpdiwgcG9ydCkpIHsKPiAtCQlsaW5rX2Nsb2NrID0gY25s
X2NhbGNfd3JwbGxfbGluayhkZXZfcHJpdiwgcGxsX3N0YXRlKTsKPiArCWlmIChpbnRlbF9wb3J0
X2lzX2NvbWJvcGh5KGk5MTUsIHBvcnQpKSB7Cj4gKwkJbGlua19jbG9jayA9IGNubF9jYWxjX3dy
cGxsX2xpbmsoaTkxNSwgcGxsX3N0YXRlKTsKPiAgIAl9IGVsc2Ugewo+IC0JCWVudW0gaW50ZWxf
ZHBsbF9pZCBwbGxfaWQgPSBpbnRlbF9nZXRfc2hhcmVkX2RwbGxfaWQoZGV2X3ByaXYsCj4gKwkJ
ZW51bSBpbnRlbF9kcGxsX2lkIHBsbF9pZCA9IGludGVsX2dldF9zaGFyZWRfZHBsbF9pZChpOTE1
LAo+ICAgCQkJCQkJcGlwZV9jb25maWctPnNoYXJlZF9kcGxsKTsKPiAgIAo+ICAgCQlpZiAocGxs
X2lkID09IERQTExfSURfSUNMX1RCVFBMTCkKPiAtCQkJbGlua19jbG9jayA9IGljbF9jYWxjX3Ri
dF9wbGxfbGluayhkZXZfcHJpdiwgcG9ydCk7Cj4gKwkJCWxpbmtfY2xvY2sgPSBpY2xfY2FsY190
YnRfcGxsX2xpbmsoaTkxNSwgcG9ydCk7Cj4gICAJCWVsc2UKPiAtCQkJbGlua19jbG9jayA9IGlj
bF9jYWxjX21nX3BsbF9saW5rKGRldl9wcml2LCBwbGxfc3RhdGUpOwo+ICsJCQlsaW5rX2Nsb2Nr
ID0gaWNsX2NhbGNfbWdfcGxsX2xpbmsoaTkxNSwgcGxsX3N0YXRlKTsKPiAgIAl9Cj4gICAKPiAg
IAlwaXBlX2NvbmZpZy0+cG9ydF9jbG9jayA9IGxpbmtfY2xvY2s7Cj4gQEAgLTE1MDgsMTIgKzE1
MDgsMTIgQEAgc3RhdGljIHZvaWQgaWNsX2RkaV9jbG9ja19nZXQoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIsCj4gICBzdGF0aWMgdm9pZCBjbmxfZGRpX2Nsb2NrX2dldChzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCSAgICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpwaXBlX2NvbmZpZykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxf
ZHBsbF9od19zdGF0ZSAqcGxsX3N0YXRlID0gJnBpcGVfY29uZmlnLT5kcGxsX2h3X3N0YXRlOwo+
ICAgCWludCBsaW5rX2Nsb2NrOwo+ICAgCj4gICAJaWYgKHBsbF9zdGF0ZS0+Y2ZnY3IwICYgRFBM
TF9DRkdDUjBfSERNSV9NT0RFKSB7Cj4gLQkJbGlua19jbG9jayA9IGNubF9jYWxjX3dycGxsX2xp
bmsoZGV2X3ByaXYsIHBsbF9zdGF0ZSk7Cj4gKwkJbGlua19jbG9jayA9IGNubF9jYWxjX3dycGxs
X2xpbmsoaTkxNSwgcGxsX3N0YXRlKTsKPiAgIAl9IGVsc2Ugewo+ICAgCQlsaW5rX2Nsb2NrID0g
cGxsX3N0YXRlLT5jZmdjcjAgJiBEUExMX0NGR0NSMF9MSU5LX1JBVEVfTUFTSzsKPiAgIAo+IEBA
IC0xNjA0LDcgKzE2MDQsNyBAQCBzdGF0aWMgdm9pZCBza2xfZGRpX2Nsb2NrX2dldChzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIHN0YXRpYyB2b2lkIGhzd19kZGlfY2xvY2tfZ2V0
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJICAgICAgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCWlu
dCBsaW5rX2Nsb2NrID0gMDsKPiAgIAl1MzIgdmFsLCBwbGw7Cj4gICAKPiBAQCAtMTYyMCwxMCAr
MTYyMCwxMCBAQCBzdGF0aWMgdm9pZCBoc3dfZGRpX2Nsb2NrX2dldChzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKPiAgIAkJbGlua19jbG9jayA9IDI3MDAwMDsKPiAgIAkJYnJlYWs7Cj4g
ICAJY2FzZSBQT1JUX0NMS19TRUxfV1JQTEwxOgo+IC0JCWxpbmtfY2xvY2sgPSBoc3dfZGRpX2Nh
bGNfd3JwbGxfbGluayhkZXZfcHJpdiwgV1JQTExfQ1RMKDApKTsKPiArCQlsaW5rX2Nsb2NrID0g
aHN3X2RkaV9jYWxjX3dycGxsX2xpbmsoaTkxNSwgV1JQTExfQ1RMKDApKTsKPiAgIAkJYnJlYWs7
Cj4gICAJY2FzZSBQT1JUX0NMS19TRUxfV1JQTEwyOgo+IC0JCWxpbmtfY2xvY2sgPSBoc3dfZGRp
X2NhbGNfd3JwbGxfbGluayhkZXZfcHJpdiwgV1JQTExfQ1RMKDEpKTsKPiArCQlsaW5rX2Nsb2Nr
ID0gaHN3X2RkaV9jYWxjX3dycGxsX2xpbmsoaTkxNSwgV1JQTExfQ1RMKDEpKTsKPiAgIAkJYnJl
YWs7Cj4gICAJY2FzZSBQT1JUX0NMS19TRUxfU1BMTDoKPiAgIAkJcGxsID0gSTkxNV9SRUFEKFNQ
TExfQ1RMKSAmIFNQTExfRlJFUV9NQVNLOwo+IEBAIC0xNjc1LDI0ICsxNjc1LDI0IEBAIHN0YXRp
YyB2b2lkIGJ4dF9kZGlfY2xvY2tfZ2V0KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+
ICAgc3RhdGljIHZvaWQgaW50ZWxfZGRpX2Nsb2NrX2dldChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlciwKPiAgIAkJCQlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29k
ZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDExKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiAgIAkJaWNsX2RkaV9jbG9ja19n
ZXQoZW5jb2RlciwgcGlwZV9jb25maWcpOwo+IC0JZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShkZXZf
cHJpdikpCj4gKwllbHNlIGlmIChJU19DQU5OT05MQUtFKGk5MTUpKQo+ICAgCQljbmxfZGRpX2Ns
b2NrX2dldChlbmNvZGVyLCBwaXBlX2NvbmZpZyk7Cj4gLQllbHNlIGlmIChJU19HRU45X0xQKGRl
dl9wcml2KSkKPiArCWVsc2UgaWYgKElTX0dFTjlfTFAoaTkxNSkpCj4gICAJCWJ4dF9kZGlfY2xv
Y2tfZ2V0KGVuY29kZXIsIHBpcGVfY29uZmlnKTsKPiAtCWVsc2UgaWYgKElTX0dFTjlfQkMoZGV2
X3ByaXYpKQo+ICsJZWxzZSBpZiAoSVNfR0VOOV9CQyhpOTE1KSkKPiAgIAkJc2tsX2RkaV9jbG9j
a19nZXQoZW5jb2RlciwgcGlwZV9jb25maWcpOwo+IC0JZWxzZSBpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA8PSA4KQo+ICsJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpIDw9IDgpCj4gICAJCWhzd19k
ZGlfY2xvY2tfZ2V0KGVuY29kZXIsIHBpcGVfY29uZmlnKTsKPiAgIH0KPiAgIAo+ICAgdm9pZCBp
bnRlbF9kZGlfc2V0X3BpcGVfc2V0dGluZ3MoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gICAJZW51bSB0cmFu
c2NvZGVyIGNwdV90cmFuc2NvZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXI7Cj4gICAJ
dTMyIHRlbXA7Cj4gICAKPiBAQCAtMTc0Niw3ICsxNzQ2LDcgQEAgdm9pZCBpbnRlbF9kZGlfc2V0
X3ZjX3BheWxvYWRfYWxsb2MoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUsCj4gICAJCQkJICAgIGJvb2wgc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2NydGMg
KmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7
Cj4gICAJZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3Ry
YW5zY29kZXI7Cj4gICAJdTMyIHRlbXA7Cj4gICAKPiBAQCAtMTc2Miw3ICsxNzYyLDcgQEAgdm9p
ZCBpbnRlbF9kZGlfZW5hYmxlX3RyYW5zY29kZXJfZnVuYyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9
IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAgIAlzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciA9IGludGVsX2RkaV9nZXRfY3J0Y19lbmNvZGVyKGNydGMpOwo+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRl
dik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFz
ZS5kZXYpOwo+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgIAllbnVtIHRyYW5z
Y29kZXIgY3B1X3RyYW5zY29kZXIgPSBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcjsKPiAgIAll
bnVtIHBvcnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4gQEAgLTE4NDUsNyArMTg0NSw3IEBAIHZv
aWQgaW50ZWxfZGRpX2VuYWJsZV90cmFuc2NvZGVyX2Z1bmMoY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB2b2lkIGludGVsX2RkaV9kaXNhYmxlX3RyYW5zY29k
ZXJfZnVuYyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsK
PiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+
YmFzZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29k
ZXIgPSBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcjsKPiAgIAlpOTE1X3JlZ190IHJlZyA9IFRS
QU5TX0RESV9GVU5DX0NUTChjcHVfdHJhbnNjb2Rlcik7Cj4gICAJdTMyIHZhbCA9IEk5MTVfUkVB
RChyZWcpOwo+IEBAIC0xODU0LDcgKzE4NTQsNyBAQCB2b2lkIGludGVsX2RkaV9kaXNhYmxlX3Ry
YW5zY29kZXJfZnVuYyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZQo+
ICAgCXZhbCB8PSBUUkFOU19ERElfUE9SVF9OT05FOwo+ICAgCUk5MTVfV1JJVEUocmVnLCB2YWwp
Owo+ICAgCj4gLQlpZiAoZGV2X3ByaXYtPnF1aXJrcyAmIFFVSVJLX0lOQ1JFQVNFX0RESV9ESVNB
QkxFRF9USU1FICYmCj4gKwlpZiAoaTkxNS0+cXVpcmtzICYgUVVJUktfSU5DUkVBU0VfRERJX0RJ
U0FCTEVEX1RJTUUgJiYKPiAgIAkgICAgaW50ZWxfY3J0Y19oYXNfdHlwZShjcnRjX3N0YXRlLCBJ
TlRFTF9PVVRQVVRfSERNSSkpIHsKPiAgIAkJRFJNX0RFQlVHX0tNUygiUXVpcmsgSW5jcmVhc2Ug
RERJIGRpc2FibGVkIHRpbWVcbiIpOwo+ICAgCQkvKiBRdWlyayB0aW1lIGF0IDEwMG1zIGZvciBy
ZWxpYWJsZSBvcGVyYXRpb24gKi8KPiBAQCAtMTg2NiwxMyArMTg2NiwxMyBAQCBpbnQgaW50ZWxf
ZGRpX3RvZ2dsZV9oZGNwX3NpZ25hbGxpbmcoc3RydWN0IGludGVsX2VuY29kZXIgKmludGVsX2Vu
Y29kZXIsCj4gICAJCQkJICAgICBib29sIGVuYWJsZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2ID0gaW50ZWxfZW5jb2Rlci0+YmFzZS5kZXY7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsK
PiAgIAllbnVtIHBpcGUgcGlwZSA9IDA7Cj4gICAJaW50IHJldCA9IDA7Cj4gICAJdTMyIHRtcDsK
PiAgIAo+IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2
X3ByaXYsCj4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChp
OTE1LAo+ICAgCQkJCQkJICAgICBpbnRlbF9lbmNvZGVyLT5wb3dlcl9kb21haW4pOwo+ICAgCWlm
IChXQVJOX09OKCF3YWtlcmVmKSkKPiAgIAkJcmV0dXJuIC1FTlhJTzsKPiBAQCAtMTg4OSwxNCAr
MTg4OSwxNCBAQCBpbnQgaW50ZWxfZGRpX3RvZ2dsZV9oZGNwX3NpZ25hbGxpbmcoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIsCj4gICAJCXRtcCAmPSB+VFJBTlNfRERJX0hEQ1Bf
U0lHTkFMTElORzsKPiAgIAlJOTE1X1dSSVRFKFRSQU5TX0RESV9GVU5DX0NUTChwaXBlKSwgdG1w
KTsKPiAgIG91dDoKPiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBpbnRlbF9l
bmNvZGVyLT5wb3dlcl9kb21haW4sIHdha2VyZWYpOwo+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9w
dXQoaTkxNSwgaW50ZWxfZW5jb2Rlci0+cG93ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiAgIAlyZXR1
cm4gcmV0Owo+ICAgfQo+ICAgCj4gICBib29sIGludGVsX2RkaV9jb25uZWN0b3JfZ2V0X2h3X3N0
YXRlKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmludGVsX2Nvbm5lY3RvcikKPiAgIHsKPiAgIAlz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gaW50ZWxfY29ubmVjdG9yLT5iYXNlLmRldjsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyID0gaW50ZWxfY29ubmVjdG9yLT5lbmNvZGVyOwo+ICAgCWludCB0
eXBlID0gaW50ZWxfY29ubmVjdG9yLT5iYXNlLmNvbm5lY3Rvcl90eXBlOwo+ICAgCWVudW0gcG9y
dCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKPiBAQCAtMTkwNiw3ICsxOTA2LDcgQEAgYm9vbCBpbnRl
bF9kZGlfY29ubmVjdG9yX2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICppbnRl
bF9jb25uZWN0b3IpCj4gICAJdTMyIHRtcDsKPiAgIAlib29sIHJldDsKPiAgIAo+IC0Jd2FrZXJl
ZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2X3ByaXYsCj4gKwl3YWtl
cmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChpOTE1LAo+ICAgCQkJCQkJ
ICAgICBlbmNvZGVyLT5wb3dlcl9kb21haW4pOwo+ICAgCWlmICghd2FrZXJlZikKPiAgIAkJcmV0
dXJuIGZhbHNlOwo+IEBAIC0xOTE2LDcgKzE5MTYsNyBAQCBib29sIGludGVsX2RkaV9jb25uZWN0
b3JfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmludGVsX2Nvbm5lY3RvcikK
PiAgIAkJZ290byBvdXQ7Cj4gICAJfQo+ICAgCj4gLQlpZiAoSEFTX1RSQU5TQ09ERVJfRURQKGRl
dl9wcml2KSAmJiBwb3J0ID09IFBPUlRfQSkKPiArCWlmIChIQVNfVFJBTlNDT0RFUl9FRFAoaTkx
NSkgJiYgcG9ydCA9PSBQT1JUX0EpCj4gICAJCWNwdV90cmFuc2NvZGVyID0gVFJBTlNDT0RFUl9F
RFA7Cj4gICAJZWxzZQo+ICAgCQljcHVfdHJhbnNjb2RlciA9IChlbnVtIHRyYW5zY29kZXIpIHBp
cGU7Cj4gQEAgLTE5NTAsNyArMTk1MCw3IEBAIGJvb2wgaW50ZWxfZGRpX2Nvbm5lY3Rvcl9nZXRf
aHdfc3RhdGUoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqaW50ZWxfY29ubmVjdG9yKQo+ICAgCX0K
PiAgIAo+ICAgb3V0Ogo+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIGVuY29k
ZXItPnBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChp
OTE1LCBlbmNvZGVyLT5wb3dlcl9kb21haW4sIHdha2VyZWYpOwo+ICAgCj4gICAJcmV0dXJuIHJl
dDsKPiAgIH0KPiBAQCAtMTk1OSw3ICsxOTU5LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZGRpX2dl
dF9lbmNvZGVyX3BpcGVzKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCQl1
OCAqcGlwZV9tYXNrLCBib29sICppc19kcF9tc3QpCj4gICB7Cj4gICAJc3RydWN0IGRybV9kZXZp
Y2UgKmRldiA9IGVuY29kZXItPmJhc2UuZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGRldik7Cj4gICAJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+
ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICAgCWVudW0gcGlwZSBwOwo+IEBAIC0xOTY5
LDcgKzE5NjksNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfZ2V0X2VuY29kZXJfcGlwZXMoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJKnBpcGVfbWFzayA9IDA7Cj4gICAJKmlz
X2RwX21zdCA9IGZhbHNlOwo+ICAgCj4gLQl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9n
ZXRfaWZfZW5hYmxlZChkZXZfcHJpdiwKPiArCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2Vy
X2dldF9pZl9lbmFibGVkKGk5MTUsCj4gICAJCQkJCQkgICAgIGVuY29kZXItPnBvd2VyX2RvbWFp
bik7Cj4gICAJaWYgKCF3YWtlcmVmKQo+ICAgCQlyZXR1cm47Cj4gQEAgLTE5NzgsNyArMTk3OCw3
IEBAIHN0YXRpYyB2b2lkIGludGVsX2RkaV9nZXRfZW5jb2Rlcl9waXBlcyhzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKPiAgIAlpZiAoISh0bXAgJiBERElfQlVGX0NUTF9FTkFCTEUpKQo+
ICAgCQlnb3RvIG91dDsKPiAgIAo+IC0JaWYgKEhBU19UUkFOU0NPREVSX0VEUChkZXZfcHJpdikg
JiYgcG9ydCA9PSBQT1JUX0EpIHsKPiArCWlmIChIQVNfVFJBTlNDT0RFUl9FRFAoaTkxNSkgJiYg
cG9ydCA9PSBQT1JUX0EpIHsKPiAgIAkJdG1wID0gSTkxNV9SRUFEKFRSQU5TX0RESV9GVU5DX0NU
TChUUkFOU0NPREVSX0VEUCkpOwo+ICAgCj4gICAJCXN3aXRjaCAodG1wICYgVFJBTlNfRERJX0VE
UF9JTlBVVF9NQVNLKSB7Cj4gQEAgLTIwMDEsNyArMjAwMSw3IEBAIHN0YXRpYyB2b2lkIGludGVs
X2RkaV9nZXRfZW5jb2Rlcl9waXBlcyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAg
IAl9Cj4gICAKPiAgIAltc3RfcGlwZV9tYXNrID0gMDsKPiAtCWZvcl9lYWNoX3BpcGUoZGV2X3By
aXYsIHApIHsKPiArCWZvcl9lYWNoX3BpcGUoaTkxNSwgcCkgewo+ICAgCQllbnVtIHRyYW5zY29k
ZXIgY3B1X3RyYW5zY29kZXIgPSAoZW51bSB0cmFuc2NvZGVyKXA7Cj4gICAKPiAgIAkJdG1wID0g
STkxNV9SRUFEKFRSQU5TX0RESV9GVU5DX0NUTChjcHVfdHJhbnNjb2RlcikpOwo+IEBAIC0yMDMz
LDcgKzIwMzMsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfZ2V0X2VuY29kZXJfcGlwZXMoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCSppc19kcF9tc3QgPSBtc3RfcGlwZV9t
YXNrOwo+ICAgCj4gICBvdXQ6Cj4gLQlpZiAoKnBpcGVfbWFzayAmJiBJU19HRU45X0xQKGRldl9w
cml2KSkgewo+ICsJaWYgKCpwaXBlX21hc2sgJiYgSVNfR0VOOV9MUChpOTE1KSkgewo+ICAgCQl0
bXAgPSBJOTE1X1JFQUQoQlhUX1BIWV9DVEwocG9ydCkpOwo+ICAgCQlpZiAoKHRtcCAmIChCWFRf
UEhZX0NNTkxBTkVfUE9XRVJET1dOX0FDSyB8Cj4gICAJCQkgICAgQlhUX1BIWV9MQU5FX1BPV0VS
RE9XTl9BQ0sgfAo+IEBAIC0yMDQyLDcgKzIwNDIsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlf
Z2V0X2VuY29kZXJfcGlwZXMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkJ
ICAiKFBIWV9DVEwgJTA4eClcbiIsIHBvcnRfbmFtZShwb3J0KSwgdG1wKTsKPiAgIAl9Cj4gICAK
PiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBlbmNvZGVyLT5wb3dlcl9kb21h
aW4sIHdha2VyZWYpOwo+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgZW5jb2Rlci0+
cG93ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiAgIH0KPiAgIAo+ICAgYm9vbCBpbnRlbF9kZGlfZ2V0
X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+IEBAIC0yMDgzLDcgKzIw
ODMsNyBAQCBpbnRlbF9kZGlfbWFpbl9saW5rX2F1eF9kb21haW4oc3RydWN0IGludGVsX2RpZ2l0
YWxfcG9ydCAqZGlnX3BvcnQpCj4gICBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfZ2V0X3Bvd2VyX2Rv
bWFpbnMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkJCXN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0
cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0Owo+ICAgCj4gICAJLyoKPiBAQCAtMjA5
NSwyOSArMjA5NSwyOSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfZ2V0X3Bvd2VyX2RvbWFpbnMo
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCXJldHVybjsKPiAgIAo+ICAgCWRp
Z19wb3J0ID0gZW5jX3RvX2RpZ19wb3J0KCZlbmNvZGVyLT5iYXNlKTsKPiAtCWludGVsX2Rpc3Bs
YXlfcG93ZXJfZ2V0KGRldl9wcml2LCBkaWdfcG9ydC0+ZGRpX2lvX3Bvd2VyX2RvbWFpbik7Cj4g
KwlpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChpOTE1LCBkaWdfcG9ydC0+ZGRpX2lvX3Bvd2VyX2Rv
bWFpbik7Cj4gICAKPiAgIAkvKgo+ICAgCSAqIEFVWCBwb3dlciBpcyBvbmx5IG5lZWRlZCBmb3Ig
KGUpRFAgbW9kZSwgYW5kIGZvciBIRE1JIG1vZGUgb24gVEMKPiAgIAkgKiBwb3J0cy4KPiAgIAkg
Ki8KPiAgIAlpZiAoaW50ZWxfY3J0Y19oYXNfZHBfZW5jb2RlcihjcnRjX3N0YXRlKSB8fAo+IC0J
ICAgIGludGVsX3BvcnRfaXNfdGMoZGV2X3ByaXYsIGVuY29kZXItPnBvcnQpKQo+IC0JCWludGVs
X2Rpc3BsYXlfcG93ZXJfZ2V0KGRldl9wcml2LAo+ICsJICAgIGludGVsX3BvcnRfaXNfdGMoaTkx
NSwgZW5jb2Rlci0+cG9ydCkpCj4gKwkJaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoaTkxNSwKPiAg
IAkJCQkJaW50ZWxfZGRpX21haW5fbGlua19hdXhfZG9tYWluKGRpZ19wb3J0KSk7Cj4gICAKPiAg
IAkvKgo+ICAgCSAqIFZEU0MgcG93ZXIgaXMgbmVlZGVkIHdoZW4gRFNDIGlzIGVuYWJsZWQKPiAg
IAkgKi8KPiAgIAlpZiAoY3J0Y19zdGF0ZS0+ZHNjX3BhcmFtcy5jb21wcmVzc2lvbl9lbmFibGUp
Cj4gLQkJaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoZGV2X3ByaXYsCj4gKwkJaW50ZWxfZGlzcGxh
eV9wb3dlcl9nZXQoaTkxNSwKPiAgIAkJCQkJaW50ZWxfZHNjX3Bvd2VyX2RvbWFpbihjcnRjX3N0
YXRlKSk7Cj4gICB9Cj4gICAKPiAgIHZvaWQgaW50ZWxfZGRpX2VuYWJsZV9waXBlX2Nsb2NrKGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgewo+ICAgCXN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMp
Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5i
YXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyID0gaW50ZWxf
ZGRpX2dldF9jcnRjX2VuY29kZXIoY3J0Yyk7Cj4gICAJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVy
LT5wb3J0Owo+ICAgCWVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNjb2RlciA9IGNydGNfc3RhdGUt
PmNwdV90cmFuc2NvZGVyOwo+IEBAIC0yMTI5LDcgKzIxMjksNyBAQCB2b2lkIGludGVsX2RkaV9l
bmFibGVfcGlwZV9jbG9jayhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSkKPiAgIAo+ICAgdm9pZCBpbnRlbF9kZGlfZGlzYWJsZV9waXBlX2Nsb2NrKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+
YmFzZS5jcnRjLT5kZXYpOwo+ICAgCWVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNjb2RlciA9IGNy
dGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyOwo+ICAgCj4gICAJaWYgKGNwdV90cmFuc2NvZGVyICE9
IFRSQU5TQ09ERVJfRURQKQo+IEBAIC0yMTM3LDcgKzIxMzcsNyBAQCB2b2lkIGludGVsX2RkaV9k
aXNhYmxlX3BpcGVfY2xvY2soY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUpCj4gICAJCQkgICBUUkFOU19DTEtfU0VMX0RJU0FCTEVEKTsKPiAgIH0KPiAgIAo+IC1zdGF0
aWMgdm9pZCBfc2tsX2RkaV9zZXRfaWJvb3N0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiArc3RhdGljIHZvaWQgX3NrbF9kZGlfc2V0X2lib29zdChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQllbnVtIHBvcnQgcG9ydCwgdTggaWJvb3N0KQo+ICAgewo+
ICAgCXUzMiB0bXA7Cj4gQEAgLTIxNTUsMjUgKzIxNTUsMjUgQEAgc3RhdGljIHZvaWQgc2tsX2Rk
aV9zZXRfaWJvb3N0KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJICAgICAg
IGludCBsZXZlbCwgZW51bSBpbnRlbF9vdXRwdXRfdHlwZSB0eXBlKQo+ICAgewo+ICAgCXN0cnVj
dCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0ID0gZW5jX3RvX2RpZ19wb3J0KCZl
bmNvZGVyLT5iYXNlKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAllbnVtIHBvcnQgcG9ydCA9IGVu
Y29kZXItPnBvcnQ7Cj4gICAJdTggaWJvb3N0Owo+ICAgCj4gICAJaWYgKHR5cGUgPT0gSU5URUxf
T1VUUFVUX0hETUkpCj4gLQkJaWJvb3N0ID0gZGV2X3ByaXYtPnZidC5kZGlfcG9ydF9pbmZvW3Bv
cnRdLmhkbWlfYm9vc3RfbGV2ZWw7Cj4gKwkJaWJvb3N0ID0gaTkxNS0+dmJ0LmRkaV9wb3J0X2lu
Zm9bcG9ydF0uaGRtaV9ib29zdF9sZXZlbDsKPiAgIAllbHNlCj4gLQkJaWJvb3N0ID0gZGV2X3By
aXYtPnZidC5kZGlfcG9ydF9pbmZvW3BvcnRdLmRwX2Jvb3N0X2xldmVsOwo+ICsJCWlib29zdCA9
IGk5MTUtPnZidC5kZGlfcG9ydF9pbmZvW3BvcnRdLmRwX2Jvb3N0X2xldmVsOwo+ICAgCj4gICAJ
aWYgKGlib29zdCA9PSAwKSB7Cj4gICAJCWNvbnN0IHN0cnVjdCBkZGlfYnVmX3RyYW5zICpkZGlf
dHJhbnNsYXRpb25zOwo+ICAgCQlpbnQgbl9lbnRyaWVzOwo+ICAgCj4gICAJCWlmICh0eXBlID09
IElOVEVMX09VVFBVVF9IRE1JKQo+IC0JCQlkZGlfdHJhbnNsYXRpb25zID0gaW50ZWxfZGRpX2dl
dF9idWZfdHJhbnNfaGRtaShkZXZfcHJpdiwgJm5fZW50cmllcyk7Cj4gKwkJCWRkaV90cmFuc2xh
dGlvbnMgPSBpbnRlbF9kZGlfZ2V0X2J1Zl90cmFuc19oZG1pKGk5MTUsICZuX2VudHJpZXMpOwo+
ICAgCQllbHNlIGlmICh0eXBlID09IElOVEVMX09VVFBVVF9FRFApCj4gLQkJCWRkaV90cmFuc2xh
dGlvbnMgPSBpbnRlbF9kZGlfZ2V0X2J1Zl90cmFuc19lZHAoZGV2X3ByaXYsIHBvcnQsICZuX2Vu
dHJpZXMpOwo+ICsJCQlkZGlfdHJhbnNsYXRpb25zID0gaW50ZWxfZGRpX2dldF9idWZfdHJhbnNf
ZWRwKGk5MTUsIHBvcnQsICZuX2VudHJpZXMpOwo+ICAgCQllbHNlCj4gLQkJCWRkaV90cmFuc2xh
dGlvbnMgPSBpbnRlbF9kZGlfZ2V0X2J1Zl90cmFuc19kcChkZXZfcHJpdiwgcG9ydCwgJm5fZW50
cmllcyk7Cj4gKwkJCWRkaV90cmFuc2xhdGlvbnMgPSBpbnRlbF9kZGlfZ2V0X2J1Zl90cmFuc19k
cChpOTE1LCBwb3J0LCAmbl9lbnRyaWVzKTsKPiAgIAo+ICAgCQlpZiAoV0FSTl9PTl9PTkNFKCFk
ZGlfdHJhbnNsYXRpb25zKSkKPiAgIAkJCXJldHVybjsKPiBAQCAtMjE4OSwzMyArMjE4OSwzMyBA
QCBzdGF0aWMgdm9pZCBza2xfZGRpX3NldF9pYm9vc3Qoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCj4gICAJCXJldHVybjsKPiAgIAl9Cj4gICAKPiAtCV9za2xfZGRpX3NldF9pYm9vc3Qo
ZGV2X3ByaXYsIHBvcnQsIGlib29zdCk7Cj4gKwlfc2tsX2RkaV9zZXRfaWJvb3N0KGk5MTUsIHBv
cnQsIGlib29zdCk7Cj4gICAKPiAgIAlpZiAocG9ydCA9PSBQT1JUX0EgJiYgaW50ZWxfZGlnX3Bv
cnQtPm1heF9sYW5lcyA9PSA0KQo+IC0JCV9za2xfZGRpX3NldF9pYm9vc3QoZGV2X3ByaXYsIFBP
UlRfRSwgaWJvb3N0KTsKPiArCQlfc2tsX2RkaV9zZXRfaWJvb3N0KGk5MTUsIFBPUlRfRSwgaWJv
b3N0KTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgYnh0X2RkaV92c3dpbmdfc2VxdWVuY2Uo
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkJICAgIGludCBsZXZlbCwgZW51
bSBpbnRlbF9vdXRwdXRfdHlwZSB0eXBlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCWNv
bnN0IHN0cnVjdCBieHRfZGRpX2J1Zl90cmFucyAqZGRpX3RyYW5zbGF0aW9uczsKPiAgIAllbnVt
IHBvcnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4gICAJaW50IG5fZW50cmllczsKPiAgIAo+ICAg
CWlmICh0eXBlID09IElOVEVMX09VVFBVVF9IRE1JKQo+IC0JCWRkaV90cmFuc2xhdGlvbnMgPSBi
eHRfZ2V0X2J1Zl90cmFuc19oZG1pKGRldl9wcml2LCAmbl9lbnRyaWVzKTsKPiArCQlkZGlfdHJh
bnNsYXRpb25zID0gYnh0X2dldF9idWZfdHJhbnNfaGRtaShpOTE1LCAmbl9lbnRyaWVzKTsKPiAg
IAllbHNlIGlmICh0eXBlID09IElOVEVMX09VVFBVVF9FRFApCj4gLQkJZGRpX3RyYW5zbGF0aW9u
cyA9IGJ4dF9nZXRfYnVmX3RyYW5zX2VkcChkZXZfcHJpdiwgJm5fZW50cmllcyk7Cj4gKwkJZGRp
X3RyYW5zbGF0aW9ucyA9IGJ4dF9nZXRfYnVmX3RyYW5zX2VkcChpOTE1LCAmbl9lbnRyaWVzKTsK
PiAgIAllbHNlCj4gLQkJZGRpX3RyYW5zbGF0aW9ucyA9IGJ4dF9nZXRfYnVmX3RyYW5zX2RwKGRl
dl9wcml2LCAmbl9lbnRyaWVzKTsKPiArCQlkZGlfdHJhbnNsYXRpb25zID0gYnh0X2dldF9idWZf
dHJhbnNfZHAoaTkxNSwgJm5fZW50cmllcyk7Cj4gICAKPiAgIAlpZiAoV0FSTl9PTl9PTkNFKCFk
ZGlfdHJhbnNsYXRpb25zKSkKPiAgIAkJcmV0dXJuOwo+ICAgCWlmIChXQVJOX09OX09OQ0UobGV2
ZWwgPj0gbl9lbnRyaWVzKSkKPiAgIAkJbGV2ZWwgPSBuX2VudHJpZXMgLSAxOwo+ICAgCj4gLQli
eHRfZGRpX3BoeV9zZXRfc2lnbmFsX2xldmVsKGRldl9wcml2LCBwb3J0LAo+ICsJYnh0X2RkaV9w
aHlfc2V0X3NpZ25hbF9sZXZlbChpOTE1LCBwb3J0LAo+ICAgCQkJCSAgICAgZGRpX3RyYW5zbGF0
aW9uc1tsZXZlbF0ubWFyZ2luLAo+ICAgCQkJCSAgICAgZGRpX3RyYW5zbGF0aW9uc1tsZXZlbF0u
c2NhbGUsCj4gICAJCQkJICAgICBkZGlfdHJhbnNsYXRpb25zW2xldmVsXS5lbmFibGUsCj4gQEAg
LTIyMjQsMzIgKzIyMjQsMzIgQEAgc3RhdGljIHZvaWQgYnh0X2RkaV92c3dpbmdfc2VxdWVuY2Uo
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAKPiAgIHU4IGludGVsX2RkaV9kcF92
b2x0YWdlX21heChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIHsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gZW5jX3RvX2ludGVsX2Rw
KCZlbmNvZGVyLT5iYXNlKTsKPiAgIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4g
ICAJaW50IG5fZW50cmllczsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEp
IHsKPiAtCQlpZiAoaW50ZWxfcG9ydF9pc19jb21ib3BoeShkZXZfcHJpdiwgcG9ydCkpCj4gLQkJ
CWljbF9nZXRfY29tYm9fYnVmX3RyYW5zKGRldl9wcml2LCBwb3J0LCBlbmNvZGVyLT50eXBlLAo+
ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkgewo+ICsJCWlmIChpbnRlbF9wb3J0X2lzX2Nv
bWJvcGh5KGk5MTUsIHBvcnQpKQo+ICsJCQlpY2xfZ2V0X2NvbWJvX2J1Zl90cmFucyhpOTE1LCBw
b3J0LCBlbmNvZGVyLT50eXBlLAo+ICAgCQkJCQkJaW50ZWxfZHAtPmxpbmtfcmF0ZSwgJm5fZW50
cmllcyk7Cj4gICAJCWVsc2UKPiAgIAkJCW5fZW50cmllcyA9IEFSUkFZX1NJWkUoaWNsX21nX3Bo
eV9kZGlfdHJhbnNsYXRpb25zKTsKPiAtCX0gZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShkZXZfcHJp
dikpIHsKPiArCX0gZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShpOTE1KSkgewo+ICAgCQlpZiAoZW5j
b2Rlci0+dHlwZSA9PSBJTlRFTF9PVVRQVVRfRURQKQo+IC0JCQljbmxfZ2V0X2J1Zl90cmFuc19l
ZHAoZGV2X3ByaXYsICZuX2VudHJpZXMpOwo+ICsJCQljbmxfZ2V0X2J1Zl90cmFuc19lZHAoaTkx
NSwgJm5fZW50cmllcyk7Cj4gICAJCWVsc2UKPiAtCQkJY25sX2dldF9idWZfdHJhbnNfZHAoZGV2
X3ByaXYsICZuX2VudHJpZXMpOwo+IC0JfSBlbHNlIGlmIChJU19HRU45X0xQKGRldl9wcml2KSkg
ewo+ICsJCQljbmxfZ2V0X2J1Zl90cmFuc19kcChpOTE1LCAmbl9lbnRyaWVzKTsKPiArCX0gZWxz
ZSBpZiAoSVNfR0VOOV9MUChpOTE1KSkgewo+ICAgCQlpZiAoZW5jb2Rlci0+dHlwZSA9PSBJTlRF
TF9PVVRQVVRfRURQKQo+IC0JCQlieHRfZ2V0X2J1Zl90cmFuc19lZHAoZGV2X3ByaXYsICZuX2Vu
dHJpZXMpOwo+ICsJCQlieHRfZ2V0X2J1Zl90cmFuc19lZHAoaTkxNSwgJm5fZW50cmllcyk7Cj4g
ICAJCWVsc2UKPiAtCQkJYnh0X2dldF9idWZfdHJhbnNfZHAoZGV2X3ByaXYsICZuX2VudHJpZXMp
Owo+ICsJCQlieHRfZ2V0X2J1Zl90cmFuc19kcChpOTE1LCAmbl9lbnRyaWVzKTsKPiAgIAl9IGVs
c2Ugewo+ICAgCQlpZiAoZW5jb2Rlci0+dHlwZSA9PSBJTlRFTF9PVVRQVVRfRURQKQo+IC0JCQlp
bnRlbF9kZGlfZ2V0X2J1Zl90cmFuc19lZHAoZGV2X3ByaXYsIHBvcnQsICZuX2VudHJpZXMpOwo+
ICsJCQlpbnRlbF9kZGlfZ2V0X2J1Zl90cmFuc19lZHAoaTkxNSwgcG9ydCwgJm5fZW50cmllcyk7
Cj4gICAJCWVsc2UKPiAtCQkJaW50ZWxfZGRpX2dldF9idWZfdHJhbnNfZHAoZGV2X3ByaXYsIHBv
cnQsICZuX2VudHJpZXMpOwo+ICsJCQlpbnRlbF9kZGlfZ2V0X2J1Zl90cmFuc19kcChpOTE1LCBw
b3J0LCAmbl9lbnRyaWVzKTsKPiAgIAl9Cj4gICAKPiAgIAlpZiAoV0FSTl9PTihuX2VudHJpZXMg
PCAxKSkKPiBAQCAtMjI4NCwxOCArMjI4NCwxOCBAQCB1OCBpbnRlbF9kZGlfZHBfcHJlX2VtcGhh
c2lzX21heChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwgdTggdm9sdGFnZV9zd2luZwo+
ICAgc3RhdGljIHZvaWQgY25sX2RkaV92c3dpbmdfcHJvZ3JhbShzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiAgIAkJCQkgICBpbnQgbGV2ZWwsIGVudW0gaW50ZWxfb3V0cHV0X3R5cGUg
dHlwZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAljb25zdCBzdHJ1Y3QgY25sX2RkaV9i
dWZfdHJhbnMgKmRkaV90cmFuc2xhdGlvbnM7Cj4gICAJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVy
LT5wb3J0Owo+ICAgCWludCBuX2VudHJpZXMsIGxuOwo+ICAgCXUzMiB2YWw7Cj4gICAKPiAgIAlp
ZiAodHlwZSA9PSBJTlRFTF9PVVRQVVRfSERNSSkKPiAtCQlkZGlfdHJhbnNsYXRpb25zID0gY25s
X2dldF9idWZfdHJhbnNfaGRtaShkZXZfcHJpdiwgJm5fZW50cmllcyk7Cj4gKwkJZGRpX3RyYW5z
bGF0aW9ucyA9IGNubF9nZXRfYnVmX3RyYW5zX2hkbWkoaTkxNSwgJm5fZW50cmllcyk7Cj4gICAJ
ZWxzZSBpZiAodHlwZSA9PSBJTlRFTF9PVVRQVVRfRURQKQo+IC0JCWRkaV90cmFuc2xhdGlvbnMg
PSBjbmxfZ2V0X2J1Zl90cmFuc19lZHAoZGV2X3ByaXYsICZuX2VudHJpZXMpOwo+ICsJCWRkaV90
cmFuc2xhdGlvbnMgPSBjbmxfZ2V0X2J1Zl90cmFuc19lZHAoaTkxNSwgJm5fZW50cmllcyk7Cj4g
ICAJZWxzZQo+IC0JCWRkaV90cmFuc2xhdGlvbnMgPSBjbmxfZ2V0X2J1Zl90cmFuc19kcChkZXZf
cHJpdiwgJm5fZW50cmllcyk7Cj4gKwkJZGRpX3RyYW5zbGF0aW9ucyA9IGNubF9nZXRfYnVmX3Ry
YW5zX2RwKGk5MTUsICZuX2VudHJpZXMpOwo+ICAgCj4gICAJaWYgKFdBUk5fT05fT05DRSghZGRp
X3RyYW5zbGF0aW9ucykpCj4gICAJCXJldHVybjsKPiBAQCAtMjM0OCw3ICsyMzQ4LDcgQEAgc3Rh
dGljIHZvaWQgY25sX2RkaV92c3dpbmdfcHJvZ3JhbShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKPiAgIHN0YXRpYyB2b2lkIGNubF9kZGlfdnN3aW5nX3NlcXVlbmNlKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCSAgICBpbnQgbGV2ZWwsIGVudW0gaW50ZWxfb3V0
cHV0X3R5cGUgdHlwZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAllbnVtIHBvcnQgcG9y
dCA9IGVuY29kZXItPnBvcnQ7Cj4gICAJaW50IHdpZHRoLCByYXRlLCBsbjsKPiAgIAl1MzIgdmFs
Owo+IEBAIC0yNDEyLDcgKzI0MTIsNyBAQCBzdGF0aWMgdm9pZCBjbmxfZGRpX3Zzd2luZ19zZXF1
ZW5jZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAlJOTE1X1dSSVRFKENOTF9Q
T1JUX1RYX0RXNV9HUlAocG9ydCksIHZhbCk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaWNs
X2RkaV9jb21ib192c3dpbmdfcHJvZ3JhbShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gK3N0YXRpYyB2b2lkIGljbF9kZGlfY29tYm9fdnN3aW5nX3Byb2dyYW0oc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJCXUzMiBsZXZlbCwgZW51bSBwb3J0IHBvcnQs
IGludCB0eXBlLAo+ICAgCQkJCQlpbnQgcmF0ZSkKPiAgIHsKPiBAQCAtMjQyMCw3ICsyNDIwLDcg
QEAgc3RhdGljIHZvaWQgaWNsX2RkaV9jb21ib192c3dpbmdfcHJvZ3JhbShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJdTMyIG5fZW50cmllcywgdmFsOwo+ICAgCWludCBs
bjsKPiAgIAo+IC0JZGRpX3RyYW5zbGF0aW9ucyA9IGljbF9nZXRfY29tYm9fYnVmX3RyYW5zKGRl
dl9wcml2LCBwb3J0LCB0eXBlLAo+ICsJZGRpX3RyYW5zbGF0aW9ucyA9IGljbF9nZXRfY29tYm9f
YnVmX3RyYW5zKGk5MTUsIHBvcnQsIHR5cGUsCj4gICAJCQkJCQkgICByYXRlLCAmbl9lbnRyaWVz
KTsKPiAgIAlpZiAoIWRkaV90cmFuc2xhdGlvbnMpCj4gICAJCXJldHVybjsKPiBAQCAtMjQ3Miw3
ICsyNDcyLDcgQEAgc3RhdGljIHZvaWQgaWNsX2NvbWJvX3BoeV9kZGlfdnN3aW5nX3NlcXVlbmNl
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCQkgICAgICB1MzIgbGV2ZWws
Cj4gICAJCQkJCSAgICAgIGVudW0gaW50ZWxfb3V0cHV0X3R5cGUgdHlwZSkKPiAgIHsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5k
ZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiAgIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4gICAJaW50
IHdpZHRoID0gMDsKPiAgIAlpbnQgcmF0ZSA9IDA7Cj4gQEAgLTI1MzAsNyArMjUzMCw3IEBAIHN0
YXRpYyB2b2lkIGljbF9jb21ib19waHlfZGRpX3Zzd2luZ19zZXF1ZW5jZShzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKPiAgIAlJOTE1X1dSSVRFKElDTF9QT1JUX1RYX0RXNV9HUlAocG9y
dCksIHZhbCk7Cj4gICAKPiAgIAkvKiA1LiBQcm9ncmFtIHN3aW5nIGFuZCBkZS1lbXBoYXNpcyAq
Lwo+IC0JaWNsX2RkaV9jb21ib192c3dpbmdfcHJvZ3JhbShkZXZfcHJpdiwgbGV2ZWwsIHBvcnQs
IHR5cGUsIHJhdGUpOwo+ICsJaWNsX2RkaV9jb21ib192c3dpbmdfcHJvZ3JhbShpOTE1LCBsZXZl
bCwgcG9ydCwgdHlwZSwgcmF0ZSk7Cj4gICAKPiAgIAkvKiA2LiBTZXQgdHJhaW5pbmcgZW5hYmxl
IHRvIHRyaWdnZXIgdXBkYXRlICovCj4gICAJdmFsID0gSTkxNV9SRUFEKElDTF9QT1JUX1RYX0RX
NV9MTjAocG9ydCkpOwo+IEBAIC0yNTQyLDcgKzI1NDIsNyBAQCBzdGF0aWMgdm9pZCBpY2xfbWdf
cGh5X2RkaV92c3dpbmdfc2VxdWVuY2Uoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4g
ICAJCQkJCSAgIGludCBsaW5rX2Nsb2NrLAo+ICAgCQkJCQkgICB1MzIgbGV2ZWwpCj4gICB7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNv
ZGVyLT5iYXNlLmRldik7Cj4gICAJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+ICAg
CWNvbnN0IHN0cnVjdCBpY2xfbWdfcGh5X2RkaV9idWZfdHJhbnMgKmRkaV90cmFuc2xhdGlvbnM7
Cj4gICAJdTMyIG5fZW50cmllcywgdmFsOwo+IEBAIC0yNjYyLDEwICsyNjYyLDEwIEBAIHN0YXRp
YyB2b2lkIGljbF9kZGlfdnN3aW5nX3NlcXVlbmNlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyLAo+ICAgCQkJCSAgICB1MzIgbGV2ZWwsCj4gICAJCQkJICAgIGVudW0gaW50ZWxfb3V0cHV0
X3R5cGUgdHlwZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAllbnVtIHBvcnQgcG9ydCA9
IGVuY29kZXItPnBvcnQ7Cj4gICAKPiAtCWlmIChpbnRlbF9wb3J0X2lzX2NvbWJvcGh5KGRldl9w
cml2LCBwb3J0KSkKPiArCWlmIChpbnRlbF9wb3J0X2lzX2NvbWJvcGh5KGk5MTUsIHBvcnQpKQo+
ICAgCQlpY2xfY29tYm9fcGh5X2RkaV92c3dpbmdfc2VxdWVuY2UoZW5jb2RlciwgbGV2ZWwsIHR5
cGUpOwo+ICAgCWVsc2UKPiAgIAkJaWNsX21nX3BoeV9kZGlfdnN3aW5nX3NlcXVlbmNlKGVuY29k
ZXIsIGxpbmtfY2xvY2ssIGxldmVsKTsKPiBAQCAtMjY5OCwxNCArMjY5OCwxNCBAQCBzdGF0aWMg
dTMyIGludGVsX2RkaV9kcF9sZXZlbChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAgdTMy
IGJ4dF9zaWduYWxfbGV2ZWxzKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICB7Cj4gICAJ
c3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZHBvcnQgPSBkcF90b19kaWdfcG9ydChpbnRlbF9k
cCk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRwb3J0
LT5iYXNlLmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShkcG9ydC0+YmFzZS5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIgPSAmZHBvcnQtPmJhc2U7Cj4gICAJaW50IGxldmVsID0gaW50ZWxfZGRpX2RwX2xldmVs
KGludGVsX2RwKTsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCj4gKwlp
ZiAoSU5URUxfR0VOKGk5MTUpID49IDExKQo+ICAgCQlpY2xfZGRpX3Zzd2luZ19zZXF1ZW5jZShl
bmNvZGVyLCBpbnRlbF9kcC0+bGlua19yYXRlLAo+ICAgCQkJCQlsZXZlbCwgZW5jb2Rlci0+dHlw
ZSk7Cj4gLQllbHNlIGlmIChJU19DQU5OT05MQUtFKGRldl9wcml2KSkKPiArCWVsc2UgaWYgKElT
X0NBTk5PTkxBS0UoaTkxNSkpCj4gICAJCWNubF9kZGlfdnN3aW5nX3NlcXVlbmNlKGVuY29kZXIs
IGxldmVsLCBlbmNvZGVyLT50eXBlKTsKPiAgIAllbHNlCj4gICAJCWJ4dF9kZGlfdnN3aW5nX3Nl
cXVlbmNlKGVuY29kZXIsIGxldmVsLCBlbmNvZGVyLT50eXBlKTsKPiBAQCAtMjcxNiwyNCArMjcx
NiwyNCBAQCB1MzIgYnh0X3NpZ25hbF9sZXZlbHMoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkK
PiAgIHUzMiBkZGlfc2lnbmFsX2xldmVscyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAg
ewo+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRwb3J0ID0gZHBfdG9fZGlnX3BvcnQo
aW50ZWxfZHApOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShkcG9ydC0+YmFzZS5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoZHBvcnQtPmJhc2UuYmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyID0gJmRwb3J0LT5iYXNlOwo+ICAgCWludCBsZXZlbCA9IGludGVsX2RkaV9k
cF9sZXZlbChpbnRlbF9kcCk7Cj4gICAKPiAtCWlmIChJU19HRU45X0JDKGRldl9wcml2KSkKPiAr
CWlmIChJU19HRU45X0JDKGk5MTUpKQo+ICAgCQlza2xfZGRpX3NldF9pYm9vc3QoZW5jb2Rlciwg
bGV2ZWwsIGVuY29kZXItPnR5cGUpOwo+ICAgCj4gICAJcmV0dXJuIERESV9CVUZfVFJBTlNfU0VM
RUNUKGxldmVsKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGlubGluZQo+IC11MzIgaWNsX2RwY2xr
YV9jZmdjcjBfY2xrX29mZihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3Uz
MiBpY2xfZHBjbGthX2NmZ2NyMF9jbGtfb2ZmKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAo+ICAgCQkJICAgICAgZW51bSBwb3J0IHBvcnQpCj4gICB7Cj4gLQlpZiAoaW50ZWxfcG9ydF9p
c19jb21ib3BoeShkZXZfcHJpdiwgcG9ydCkpIHsKPiArCWlmIChpbnRlbF9wb3J0X2lzX2NvbWJv
cGh5KGk5MTUsIHBvcnQpKSB7Cj4gICAJCXJldHVybiBJQ0xfRFBDTEtBX0NGR0NSMF9ERElfQ0xL
X09GRihwb3J0KTsKPiAtCX0gZWxzZSBpZiAoaW50ZWxfcG9ydF9pc190YyhkZXZfcHJpdiwgcG9y
dCkpIHsKPiAtCQllbnVtIHRjX3BvcnQgdGNfcG9ydCA9IGludGVsX3BvcnRfdG9fdGMoZGV2X3By
aXYsIHBvcnQpOwo+ICsJfSBlbHNlIGlmIChpbnRlbF9wb3J0X2lzX3RjKGk5MTUsIHBvcnQpKSB7
Cj4gKwkJZW51bSB0Y19wb3J0IHRjX3BvcnQgPSBpbnRlbF9wb3J0X3RvX3RjKGk5MTUsIHBvcnQp
Owo+ICAgCj4gICAJCXJldHVybiBJQ0xfRFBDTEtBX0NGR0NSMF9UQ19DTEtfT0ZGKHRjX3BvcnQp
Owo+ICAgCX0KPiBAQCAtMjc0NCw0NyArMjc0NCw0NyBAQCB1MzIgaWNsX2RwY2xrYV9jZmdjcjBf
Y2xrX29mZihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICBzdGF0aWMgdm9p
ZCBpY2xfbWFwX3BsbHNfdG9fcG9ydHMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4g
ICAJCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+
YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVu
Y29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCA9IGNy
dGNfc3RhdGUtPnNoYXJlZF9kcGxsOwo+ICAgCWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9y
dDsKPiAgIAl1MzIgdmFsOwo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+ZHBsbF9sb2Nr
KTsKPiArCW11dGV4X2xvY2soJmk5MTUtPmRwbGxfbG9jayk7Cj4gICAKPiAgIAl2YWwgPSBJOTE1
X1JFQUQoRFBDTEtBX0NGR0NSMF9JQ0wpOwo+IC0JV0FSTl9PTigodmFsICYgaWNsX2RwY2xrYV9j
ZmdjcjBfY2xrX29mZihkZXZfcHJpdiwgcG9ydCkpID09IDApOwo+ICsJV0FSTl9PTigodmFsICYg
aWNsX2RwY2xrYV9jZmdjcjBfY2xrX29mZihpOTE1LCBwb3J0KSkgPT0gMCk7Cj4gICAKPiAtCWlm
IChpbnRlbF9wb3J0X2lzX2NvbWJvcGh5KGRldl9wcml2LCBwb3J0KSkgewo+ICsJaWYgKGludGVs
X3BvcnRfaXNfY29tYm9waHkoaTkxNSwgcG9ydCkpIHsKPiAgIAkJdmFsICY9IH5EUENMS0FfQ0ZH
Q1IwX0RESV9DTEtfU0VMX01BU0socG9ydCk7Cj4gICAJCXZhbCB8PSBEUENMS0FfQ0ZHQ1IwX0RE
SV9DTEtfU0VMKHBsbC0+aW5mby0+aWQsIHBvcnQpOwo+ICAgCQlJOTE1X1dSSVRFKERQQ0xLQV9D
RkdDUjBfSUNMLCB2YWwpOwo+ICAgCQlQT1NUSU5HX1JFQUQoRFBDTEtBX0NGR0NSMF9JQ0wpOwo+
ICAgCX0KPiAgIAo+IC0JdmFsICY9IH5pY2xfZHBjbGthX2NmZ2NyMF9jbGtfb2ZmKGRldl9wcml2
LCBwb3J0KTsKPiArCXZhbCAmPSB+aWNsX2RwY2xrYV9jZmdjcjBfY2xrX29mZihpOTE1LCBwb3J0
KTsKPiAgIAlJOTE1X1dSSVRFKERQQ0xLQV9DRkdDUjBfSUNMLCB2YWwpOwo+ICAgCj4gLQltdXRl
eF91bmxvY2soJmRldl9wcml2LT5kcGxsX2xvY2spOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5k
cGxsX2xvY2spOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZCBpY2xfdW5tYXBfcGxsc190b19w
b3J0cyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIHsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2
KTsKPiAgIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4gICAJdTMyIHZhbDsKPiAg
IAo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRwbGxfbG9jayk7Cj4gKwltdXRleF9sb2NrKCZp
OTE1LT5kcGxsX2xvY2spOwo+ICAgCj4gICAJdmFsID0gSTkxNV9SRUFEKERQQ0xLQV9DRkdDUjBf
SUNMKTsKPiAtCXZhbCB8PSBpY2xfZHBjbGthX2NmZ2NyMF9jbGtfb2ZmKGRldl9wcml2LCBwb3J0
KTsKPiArCXZhbCB8PSBpY2xfZHBjbGthX2NmZ2NyMF9jbGtfb2ZmKGk5MTUsIHBvcnQpOwo+ICAg
CUk5MTVfV1JJVEUoRFBDTEtBX0NGR0NSMF9JQ0wsIHZhbCk7Cj4gICAKPiAtCW11dGV4X3VubG9j
aygmZGV2X3ByaXYtPmRwbGxfbG9jayk7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPmRwbGxfbG9j
ayk7Cj4gICB9Cj4gICAKPiAgIHZvaWQgaWNsX3Nhbml0aXplX2VuY29kZXJfcGxsX21hcHBpbmco
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4g
ICAJdTMyIHZhbDsKPiAgIAllbnVtIHBvcnQgcG9ydDsKPiAgIAl1MzIgcG9ydF9tYXNrOwo+IEBA
IC0yODIxLDcgKzI4MjEsNyBAQCB2b2lkIGljbF9zYW5pdGl6ZV9lbmNvZGVyX3BsbF9tYXBwaW5n
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ICAgCQkgKiBTYW5pdHkgY2hlY2sgdGhh
dCB3ZSBoYXZlbid0IGluY29ycmVjdGx5IHJlZ2lzdGVyZWQgYW5vdGhlcgo+ICAgCQkgKiBlbmNv
ZGVyIHVzaW5nIGFueSBvZiB0aGUgcG9ydHMgb2YgdGhpcyBEU0kgZW5jb2Rlci4KPiAgIAkJICov
Cj4gLQkJZm9yX2VhY2hfaW50ZWxfZW5jb2RlcigmZGV2X3ByaXYtPmRybSwgb3RoZXJfZW5jb2Rl
cikgewo+ICsJCWZvcl9lYWNoX2ludGVsX2VuY29kZXIoJmk5MTUtPmRybSwgb3RoZXJfZW5jb2Rl
cikgewo+ICAgCQkJaWYgKG90aGVyX2VuY29kZXIgPT0gZW5jb2RlcikKPiAgIAkJCQljb250aW51
ZTsKPiAgIAo+IEBAIC0yODM4LDcgKzI4MzgsNyBAQCB2b2lkIGljbF9zYW5pdGl6ZV9lbmNvZGVy
X3BsbF9tYXBwaW5nKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ICAgCXZhbCA9IEk5
MTVfUkVBRChEUENMS0FfQ0ZHQ1IwX0lDTCk7Cj4gICAJZm9yX2VhY2hfcG9ydF9tYXNrZWQocG9y
dCwgcG9ydF9tYXNrKSB7Cj4gICAJCWJvb2wgZGRpX2Nsa191bmdhdGVkID0gISh2YWwgJgo+IC0J
CQkJCSBpY2xfZHBjbGthX2NmZ2NyMF9jbGtfb2ZmKGRldl9wcml2LAo+ICsJCQkJCSBpY2xfZHBj
bGthX2NmZ2NyMF9jbGtfb2ZmKGk5MTUsCj4gICAJCQkJCQkJCSAgIHBvcnQpKTsKPiAgIAo+ICAg
CQlpZiAoZGRpX2Nsa19uZWVkZWQgPT0gZGRpX2Nsa191bmdhdGVkKQo+IEBAIC0yODUzLDcgKzI4
NTMsNyBAQCB2b2lkIGljbF9zYW5pdGl6ZV9lbmNvZGVyX3BsbF9tYXBwaW5nKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyKQo+ICAgCj4gICAJCURSTV9OT1RFKCJQb3J0ICVjIGlzIGRpc2Fi
bGVkL2luIERTSSBtb2RlIHdpdGggYW4gdW5nYXRlZCBEREkgY2xvY2ssIGdhdGUgaXRcbiIsCj4g
ICAJCQkgcG9ydF9uYW1lKHBvcnQpKTsKPiAtCQl2YWwgfD0gaWNsX2RwY2xrYV9jZmdjcjBfY2xr
X29mZihkZXZfcHJpdiwgcG9ydCk7Cj4gKwkJdmFsIHw9IGljbF9kcGNsa2FfY2ZnY3IwX2Nsa19v
ZmYoaTkxNSwgcG9ydCk7Cj4gICAJCUk5MTVfV1JJVEUoRFBDTEtBX0NGR0NSMF9JQ0wsIHZhbCk7
Cj4gICAJfQo+ICAgfQo+IEBAIC0yODYxLDcgKzI4NjEsNyBAQCB2b2lkIGljbF9zYW5pdGl6ZV9l
bmNvZGVyX3BsbF9tYXBwaW5nKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ICAgc3Rh
dGljIHZvaWQgaW50ZWxfZGRpX2Nsa19zZWxlY3Qoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsCj4gICAJCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+
ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNv
ZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9y
dDsKPiAgIAl1MzIgdmFsOwo+ICAgCWNvbnN0IHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxs
ID0gY3J0Y19zdGF0ZS0+c2hhcmVkX2RwbGw7Cj4gQEAgLTI4NjksMTMgKzI4NjksMTMgQEAgc3Rh
dGljIHZvaWQgaW50ZWxfZGRpX2Nsa19zZWxlY3Qoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsCj4gICAJaWYgKFdBUk5fT04oIXBsbCkpCj4gICAJCXJldHVybjsKPiAgIAo+IC0JbXV0ZXhf
bG9jaygmZGV2X3ByaXYtPmRwbGxfbG9jayk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT5kcGxsX2xv
Y2spOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkgewo+IC0JCWlmICgh
aW50ZWxfcG9ydF9pc19jb21ib3BoeShkZXZfcHJpdiwgcG9ydCkpCj4gKwlpZiAoSU5URUxfR0VO
KGk5MTUpID49IDExKSB7Cj4gKwkJaWYgKCFpbnRlbF9wb3J0X2lzX2NvbWJvcGh5KGk5MTUsIHBv
cnQpKQo+ICAgCQkJSTkxNV9XUklURShERElfQ0xLX1NFTChwb3J0KSwKPiAgIAkJCQkgICBpY2xf
cGxsX3RvX2RkaV9jbGtfc2VsKGVuY29kZXIsIGNydGNfc3RhdGUpKTsKPiAtCX0gZWxzZSBpZiAo
SVNfQ0FOTk9OTEFLRShkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShp
OTE1KSkgewo+ICAgCQkvKiBDb25maWd1cmUgRFBDTEtBX0NGR0NSMCB0byBtYXAgdGhlIERQTEwg
dG8gdGhlIERESS4gKi8KPiAgIAkJdmFsID0gSTkxNV9SRUFEKERQQ0xLQV9DRkdDUjApOwo+ICAg
CQl2YWwgJj0gfkRQQ0xLQV9DRkdDUjBfRERJX0NMS19TRUxfTUFTSyhwb3J0KTsKPiBAQCAtMjg5
MCw3ICsyODkwLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZGRpX2Nsa19zZWxlY3Qoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCXZhbCA9IEk5MTVfUkVBRChEUENMS0FfQ0ZHQ1Iw
KTsKPiAgIAkJdmFsICY9IH5EUENMS0FfQ0ZHQ1IwX0RESV9DTEtfT0ZGKHBvcnQpOwo+ICAgCQlJ
OTE1X1dSSVRFKERQQ0xLQV9DRkdDUjAsIHZhbCk7Cj4gLQl9IGVsc2UgaWYgKElTX0dFTjlfQkMo
ZGV2X3ByaXYpKSB7Cj4gKwl9IGVsc2UgaWYgKElTX0dFTjlfQkMoaTkxNSkpIHsKPiAgIAkJLyog
RERJIC0+IFBMTCBtYXBwaW5nICAqLwo+ICAgCQl2YWwgPSBJOTE1X1JFQUQoRFBMTF9DVFJMMik7
Cj4gICAKPiBAQCAtMjkwMSwzNyArMjkwMSwzNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfY2xr
X3NlbGVjdChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAo+ICAgCQlJOTE1X1dS
SVRFKERQTExfQ1RSTDIsIHZhbCk7Cj4gICAKPiAtCX0gZWxzZSBpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA8IDkpIHsKPiArCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpIDwgOSkgewo+ICAgCQlJ
OTE1X1dSSVRFKFBPUlRfQ0xLX1NFTChwb3J0KSwgaHN3X3BsbF90b19kZGlfcGxsX3NlbChwbGwp
KTsKPiAgIAl9Cj4gICAKPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRwbGxfbG9jayk7Cj4g
KwltdXRleF91bmxvY2soJmk5MTUtPmRwbGxfbG9jayk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2
b2lkIGludGVsX2RkaV9jbGtfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikK
PiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5j
b2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXItPnBv
cnQ7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKSB7Cj4gLQkJaWYgKCFp
bnRlbF9wb3J0X2lzX2NvbWJvcGh5KGRldl9wcml2LCBwb3J0KSkKPiArCWlmIChJTlRFTF9HRU4o
aTkxNSkgPj0gMTEpIHsKPiArCQlpZiAoIWludGVsX3BvcnRfaXNfY29tYm9waHkoaTkxNSwgcG9y
dCkpCj4gICAJCQlJOTE1X1dSSVRFKERESV9DTEtfU0VMKHBvcnQpLCBERElfQ0xLX1NFTF9OT05F
KTsKPiAtCX0gZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBp
ZiAoSVNfQ0FOTk9OTEFLRShpOTE1KSkgewo+ICAgCQlJOTE1X1dSSVRFKERQQ0xLQV9DRkdDUjAs
IEk5MTVfUkVBRChEUENMS0FfQ0ZHQ1IwKSB8Cj4gICAJCQkgICBEUENMS0FfQ0ZHQ1IwX0RESV9D
TEtfT0ZGKHBvcnQpKTsKPiAtCX0gZWxzZSBpZiAoSVNfR0VOOV9CQyhkZXZfcHJpdikpIHsKPiAr
CX0gZWxzZSBpZiAoSVNfR0VOOV9CQyhpOTE1KSkgewo+ICAgCQlJOTE1X1dSSVRFKERQTExfQ1RS
TDIsIEk5MTVfUkVBRChEUExMX0NUUkwyKSB8Cj4gICAJCQkgICBEUExMX0NUUkwyX0RESV9DTEtf
T0ZGKHBvcnQpKTsKPiAtCX0gZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDkpIHsKPiAr
CX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpIDwgOSkgewo+ICAgCQlJOTE1X1dSSVRFKFBPUlRf
Q0xLX1NFTChwb3J0KSwgUE9SVF9DTEtfU0VMX05PTkUpOwo+ICAgCX0KPiAgIH0KPiAgIAo+ICAg
c3RhdGljIHZvaWQgaWNsX2VuYWJsZV9waHlfY2xvY2tfZ2F0aW5nKHN0cnVjdCBpbnRlbF9kaWdp
dGFsX3BvcnQgKmRpZ19wb3J0KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShkaWdfcG9ydC0+YmFzZS5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOwo+
ICAgCWVudW0gcG9ydCBwb3J0ID0gZGlnX3BvcnQtPmJhc2UucG9ydDsKPiAtCWVudW0gdGNfcG9y
dCB0Y19wb3J0ID0gaW50ZWxfcG9ydF90b190YyhkZXZfcHJpdiwgcG9ydCk7Cj4gKwllbnVtIHRj
X3BvcnQgdGNfcG9ydCA9IGludGVsX3BvcnRfdG9fdGMoaTkxNSwgcG9ydCk7Cj4gICAJdTMyIHZh
bDsKPiAgIAlpbnQgbG47Cj4gICAKPiBAQCAtMjk2MSw5ICsyOTYxLDkgQEAgc3RhdGljIHZvaWQg
aWNsX2VuYWJsZV9waHlfY2xvY2tfZ2F0aW5nKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRp
Z19wb3J0KQo+ICAgCj4gICBzdGF0aWMgdm9pZCBpY2xfZGlzYWJsZV9waHlfY2xvY2tfZ2F0aW5n
KHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KQo+ICAgewo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkaWdfcG9ydC0+YmFzZS5iYXNlLmRl
dik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGlnX3BvcnQt
PmJhc2UuYmFzZS5kZXYpOwo+ICAgCWVudW0gcG9ydCBwb3J0ID0gZGlnX3BvcnQtPmJhc2UucG9y
dDsKPiAtCWVudW0gdGNfcG9ydCB0Y19wb3J0ID0gaW50ZWxfcG9ydF90b190YyhkZXZfcHJpdiwg
cG9ydCk7Cj4gKwllbnVtIHRjX3BvcnQgdGNfcG9ydCA9IGludGVsX3BvcnRfdG9fdGMoaTkxNSwg
cG9ydCk7Cj4gICAJdTMyIHZhbDsKPiAgIAlpbnQgbG47Cj4gICAKPiBAQCAtMjk5Myw5ICsyOTkz
LDkgQEAgc3RhdGljIHZvaWQgaWNsX2Rpc2FibGVfcGh5X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgaW50
ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCkKPiAgIAo+ICAgc3RhdGljIHZvaWQgaWNsX3Byb2dy
YW1fbWdfZHBfbW9kZShzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCkK
PiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoaW50
ZWxfZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGludGVsX2RpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsKPiAgIAllbnVt
IHBvcnQgcG9ydCA9IGludGVsX2RpZ19wb3J0LT5iYXNlLnBvcnQ7Cj4gLQllbnVtIHRjX3BvcnQg
dGNfcG9ydCA9IGludGVsX3BvcnRfdG9fdGMoZGV2X3ByaXYsIHBvcnQpOwo+ICsJZW51bSB0Y19w
b3J0IHRjX3BvcnQgPSBpbnRlbF9wb3J0X3RvX3RjKGk5MTUsIHBvcnQpOwo+ICAgCXUzMiBsbjAs
IGxuMSwgbGFuZV9pbmZvOwo+ICAgCj4gICAJaWYgKHRjX3BvcnQgPT0gUE9SVF9UQ19OT05FIHx8
IGludGVsX2RpZ19wb3J0LT50Y190eXBlID09IFRDX1BPUlRfVEJUKQo+IEBAIC0zMDY5LDcgKzMw
NjksNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kcF9zaW5rX3NldF9mZWNfcmVhZHkoc3RydWN0IGlu
dGVsX2RwICppbnRlbF9kcCwKPiAgIHN0YXRpYyB2b2lkIGludGVsX2RkaV9lbmFibGVfZmVjKHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAllbnVt
IHBvcnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4gICAJdTMyIHZhbDsKPiAgIAo+IEBAIC0zMDgw
LDcgKzMwODAsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfZW5hYmxlX2ZlYyhzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAl2YWwgfD0gRFBfVFBfQ1RMX0ZFQ19FTkFCTEU7Cj4g
ICAJSTkxNV9XUklURShEUF9UUF9DVEwocG9ydCksIHZhbCk7Cj4gICAKPiAtCWlmIChpbnRlbF93
YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwgRFBfVFBfU1RBVFVTKHBvcnQpLAo+
ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsIERQX1RQX1NUQVRV
Uyhwb3J0KSwKPiAgIAkJCQkgICAgRFBfVFBfU1RBVFVTX0ZFQ19FTkFCTEVfTElWRSwKPiAgIAkJ
CQkgICAgRFBfVFBfU1RBVFVTX0ZFQ19FTkFCTEVfTElWRSwKPiAgIAkJCQkgICAgMSkpCj4gQEAg
LTMwOTAsNyArMzA5MCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RkaV9lbmFibGVfZmVjKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgc3RhdGljIHZvaWQgaW50ZWxfZGRpX2Rpc2Fi
bGVfZmVjX3N0YXRlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCQljb25z
dCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2Uu
ZGV2KTsKPiAgIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4gICAJdTMyIHZhbDsK
PiAgIAo+IEBAIC0zMTA4LDcgKzMxMDgsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfcHJlX2Vu
YWJsZV9kcChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCQkgICAgY29uc3Qg
c3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0
IGludGVsX2RwICppbnRlbF9kcCA9IGVuY190b19pbnRlbF9kcCgmZW5jb2Rlci0+YmFzZSk7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNv
ZGVyLT5iYXNlLmRldik7Cj4gICAJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+ICAg
CXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0ID0gZW5jX3RvX2RpZ19wb3J0KCZl
bmNvZGVyLT5iYXNlKTsKPiAgIAlib29sIGlzX21zdCA9IGludGVsX2NydGNfaGFzX3R5cGUoY3J0
Y19zdGF0ZSwgSU5URUxfT1VUUFVUX0RQX01TVCk7Cj4gQEAgLTMxMjMsMjYgKzMxMjMsMjYgQEAg
c3RhdGljIHZvaWQgaW50ZWxfZGRpX3ByZV9lbmFibGVfZHAoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4gICAKPiAgIAlpbnRlbF9kZGlfY2xrX3NlbGVjdChlbmNvZGVyLCBjcnRjX3N0
YXRlKTsKPiAgIAo+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoZGV2X3ByaXYsIGRpZ19wb3J0
LT5kZGlfaW9fcG93ZXJfZG9tYWluKTsKPiArCWludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGk5MTUs
IGRpZ19wb3J0LT5kZGlfaW9fcG93ZXJfZG9tYWluKTsKPiAgIAo+ICAgCWljbF9wcm9ncmFtX21n
X2RwX21vZGUoZGlnX3BvcnQpOwo+ICAgCWljbF9kaXNhYmxlX3BoeV9jbG9ja19nYXRpbmcoZGln
X3BvcnQpOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKPiArCWlmIChJ
TlRFTF9HRU4oaTkxNSkgPj0gMTEpCj4gICAJCWljbF9kZGlfdnN3aW5nX3NlcXVlbmNlKGVuY29k
ZXIsIGNydGNfc3RhdGUtPnBvcnRfY2xvY2ssCj4gICAJCQkJCWxldmVsLCBlbmNvZGVyLT50eXBl
KTsKPiAtCWVsc2UgaWYgKElTX0NBTk5PTkxBS0UoZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAoSVNf
Q0FOTk9OTEFLRShpOTE1KSkKPiAgIAkJY25sX2RkaV92c3dpbmdfc2VxdWVuY2UoZW5jb2Rlciwg
bGV2ZWwsIGVuY29kZXItPnR5cGUpOwo+IC0JZWxzZSBpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikp
Cj4gKwllbHNlIGlmIChJU19HRU45X0xQKGk5MTUpKQo+ICAgCQlieHRfZGRpX3Zzd2luZ19zZXF1
ZW5jZShlbmNvZGVyLCBsZXZlbCwgZW5jb2Rlci0+dHlwZSk7Cj4gICAJZWxzZQo+ICAgCQlpbnRl
bF9wcmVwYXJlX2RwX2RkaV9idWZmZXJzKGVuY29kZXIsIGNydGNfc3RhdGUpOwo+ICAgCj4gLQlp
ZiAoaW50ZWxfcG9ydF9pc19jb21ib3BoeShkZXZfcHJpdiwgcG9ydCkpIHsKPiArCWlmIChpbnRl
bF9wb3J0X2lzX2NvbWJvcGh5KGk5MTUsIHBvcnQpKSB7Cj4gICAJCWJvb2wgbGFuZV9yZXZlcnNh
bCA9Cj4gICAJCQlkaWdfcG9ydC0+c2F2ZWRfcG9ydF9iaXRzICYgRERJX0JVRl9QT1JUX1JFVkVS
U0FMOwo+ICAgCj4gLQkJaW50ZWxfY29tYm9fcGh5X3Bvd2VyX3VwX2xhbmVzKGRldl9wcml2LCBw
b3J0LCBmYWxzZSwKPiArCQlpbnRlbF9jb21ib19waHlfcG93ZXJfdXBfbGFuZXMoaTkxNSwgcG9y
dCwgZmFsc2UsCj4gICAJCQkJCSAgICAgICBjcnRjX3N0YXRlLT5sYW5lX2NvdW50LAo+ICAgCQkJ
CQkgICAgICAgbGFuZV9yZXZlcnNhbCk7Cj4gICAJfQo+IEBAIC0zMTU0LDcgKzMxNTQsNyBAQCBz
dGF0aWMgdm9pZCBpbnRlbF9kZGlfcHJlX2VuYWJsZV9kcChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlciwKPiAgIAkJCQkJICAgICAgdHJ1ZSk7Cj4gICAJaW50ZWxfZHBfc2lua19zZXRfZmVj
X3JlYWR5KGludGVsX2RwLCBjcnRjX3N0YXRlKTsKPiAgIAlpbnRlbF9kcF9zdGFydF9saW5rX3Ry
YWluKGludGVsX2RwKTsKPiAtCWlmIChwb3J0ICE9IFBPUlRfQSB8fCBJTlRFTF9HRU4oZGV2X3By
aXYpID49IDkpCj4gKwlpZiAocG9ydCAhPSBQT1JUX0EgfHwgSU5URUxfR0VOKGk5MTUpID49IDkp
Cj4gICAJCWludGVsX2RwX3N0b3BfbGlua190cmFpbihpbnRlbF9kcCk7Cj4gICAKPiAgIAlpbnRl
bF9kZGlfZW5hYmxlX2ZlYyhlbmNvZGVyLCBjcnRjX3N0YXRlKTsKPiBAQCAtMzE3MywzMiArMzE3
MywzMiBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfcHJlX2VuYWJsZV9oZG1pKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQg
KmludGVsX2RpZ19wb3J0ID0gZW5jX3RvX2RpZ19wb3J0KCZlbmNvZGVyLT5iYXNlKTsKPiAgIAlz
dHJ1Y3QgaW50ZWxfaGRtaSAqaW50ZWxfaGRtaSA9ICZpbnRlbF9kaWdfcG9ydC0+aGRtaTsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFz
ZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29k
ZXItPmJhc2UuZGV2KTsKPiAgIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4gLQlp
bnQgbGV2ZWwgPSBpbnRlbF9kZGlfaGRtaV9sZXZlbChkZXZfcHJpdiwgcG9ydCk7Cj4gKwlpbnQg
bGV2ZWwgPSBpbnRlbF9kZGlfaGRtaV9sZXZlbChpOTE1LCBwb3J0KTsKPiAgIAlzdHJ1Y3QgaW50
ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCA9IGVuY190b19kaWdfcG9ydCgmZW5jb2Rlci0+YmFz
ZSk7Cj4gICAKPiAgIAlpbnRlbF9kcF9kdWFsX21vZGVfc2V0X3RtZHNfb3V0cHV0KGludGVsX2hk
bWksIHRydWUpOwo+ICAgCWludGVsX2RkaV9jbGtfc2VsZWN0KGVuY29kZXIsIGNydGNfc3RhdGUp
Owo+ICAgCj4gLQlpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChkZXZfcHJpdiwgZGlnX3BvcnQtPmRk
aV9pb19wb3dlcl9kb21haW4pOwo+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoaTkxNSwgZGln
X3BvcnQtPmRkaV9pb19wb3dlcl9kb21haW4pOwo+ICAgCj4gICAJaWNsX3Byb2dyYW1fbWdfZHBf
bW9kZShkaWdfcG9ydCk7Cj4gICAJaWNsX2Rpc2FibGVfcGh5X2Nsb2NrX2dhdGluZyhkaWdfcG9y
dCk7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQo+ICsJaWYgKElOVEVM
X0dFTihpOTE1KSA+PSAxMSkKPiAgIAkJaWNsX2RkaV92c3dpbmdfc2VxdWVuY2UoZW5jb2Rlciwg
Y3J0Y19zdGF0ZS0+cG9ydF9jbG9jaywKPiAgIAkJCQkJbGV2ZWwsIElOVEVMX09VVFBVVF9IRE1J
KTsKPiAtCWVsc2UgaWYgKElTX0NBTk5PTkxBS0UoZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAoSVNf
Q0FOTk9OTEFLRShpOTE1KSkKPiAgIAkJY25sX2RkaV92c3dpbmdfc2VxdWVuY2UoZW5jb2Rlciwg
bGV2ZWwsIElOVEVMX09VVFBVVF9IRE1JKTsKPiAtCWVsc2UgaWYgKElTX0dFTjlfTFAoZGV2X3By
aXYpKQo+ICsJZWxzZSBpZiAoSVNfR0VOOV9MUChpOTE1KSkKPiAgIAkJYnh0X2RkaV92c3dpbmdf
c2VxdWVuY2UoZW5jb2RlciwgbGV2ZWwsIElOVEVMX09VVFBVVF9IRE1JKTsKPiAgIAllbHNlCj4g
ICAJCWludGVsX3ByZXBhcmVfaGRtaV9kZGlfYnVmZmVycyhlbmNvZGVyLCBsZXZlbCk7Cj4gICAK
PiAgIAlpY2xfZW5hYmxlX3BoeV9jbG9ja19nYXRpbmcoZGlnX3BvcnQpOwo+ICAgCj4gLQlpZiAo
SVNfR0VOOV9CQyhkZXZfcHJpdikpCj4gKwlpZiAoSVNfR0VOOV9CQyhpOTE1KSkKPiAgIAkJc2ts
X2RkaV9zZXRfaWJvb3N0KGVuY29kZXIsIGxldmVsLCBJTlRFTF9PVVRQVVRfSERNSSk7Cj4gICAK
PiAgIAlpbnRlbF9kZGlfZW5hYmxlX3BpcGVfY2xvY2soY3J0Y19zdGF0ZSk7Cj4gQEAgLTMyMTMs
NyArMzIxMyw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RkaV9wcmVfZW5hYmxlKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCSBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9z
dGF0ZSAqY29ubl9zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRv
X2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAllbnVt
IHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gICAKPiAgIAkvKgo+IEBAIC0zMjMxLDEwICszMjMx
LDEwIEBAIHN0YXRpYyB2b2lkIGludGVsX2RkaV9wcmVfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyLAo+ICAgCj4gICAJV0FSTl9PTihjcnRjX3N0YXRlLT5oYXNfcGNoX2VuY29k
ZXIpOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKPiArCWlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gMTEpCj4gICAJCWljbF9tYXBfcGxsc190b19wb3J0cyhlbmNvZGVyLCBj
cnRjX3N0YXRlKTsKPiAgIAo+IC0JaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGlu
ZyhkZXZfcHJpdiwgcGlwZSwgdHJ1ZSk7Cj4gKwlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5f
cmVwb3J0aW5nKGk5MTUsIHBpcGUsIHRydWUpOwo+ICAgCj4gICAJaWYgKGludGVsX2NydGNfaGFz
X3R5cGUoY3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVUX0hETUkpKSB7Cj4gICAJCWludGVsX2RkaV9w
cmVfZW5hYmxlX2hkbWkoZW5jb2RlciwgY3J0Y19zdGF0ZSwgY29ubl9zdGF0ZSk7Cj4gQEAgLTMy
NTcsNyArMzI1Nyw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RkaV9wcmVfZW5hYmxlKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgc3RhdGljIHZvaWQgaW50ZWxfZGlzYWJsZV9kZGlf
YnVmKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCSAgY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4g
ICAJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+ICAgCWJvb2wgd2FpdCA9IGZhbHNl
Owo+ICAgCXUzMiB2YWw7Cj4gQEAgLTMyNzgsMTQgKzMyNzgsMTQgQEAgc3RhdGljIHZvaWQgaW50
ZWxfZGlzYWJsZV9kZGlfYnVmKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCWlu
dGVsX2RkaV9kaXNhYmxlX2ZlY19zdGF0ZShlbmNvZGVyLCBjcnRjX3N0YXRlKTsKPiAgIAo+ICAg
CWlmICh3YWl0KQo+IC0JCWludGVsX3dhaXRfZGRpX2J1Zl9pZGxlKGRldl9wcml2LCBwb3J0KTsK
PiArCQlpbnRlbF93YWl0X2RkaV9idWZfaWRsZShpOTE1LCBwb3J0KTsKPiAgIH0KPiAgIAo+ICAg
c3RhdGljIHZvaWQgaW50ZWxfZGRpX3Bvc3RfZGlzYWJsZV9kcChzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiAgIAkJCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
b2xkX2NydGNfc3RhdGUsCj4gICAJCQkJICAgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jf
c3RhdGUgKm9sZF9jb25uX3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVj
dCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0ID0gZW5jX3RvX2RpZ19wb3J0KCZlbmNvZGVy
LT5iYXNlKTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gJmRpZ19wb3J0LT5kcDsK
PiAgIAlib29sIGlzX21zdCA9IGludGVsX2NydGNfaGFzX3R5cGUob2xkX2NydGNfc3RhdGUsCj4g
QEAgLTMzMDUsNyArMzMwNSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RkaV9wb3N0X2Rpc2FibGVf
ZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJaW50ZWxfZWRwX3BhbmVsX3Zk
ZF9vbihpbnRlbF9kcCk7Cj4gICAJaW50ZWxfZWRwX3BhbmVsX29mZihpbnRlbF9kcCk7Cj4gICAK
PiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X3VuY2hlY2tlZChkZXZfcHJpdiwKPiArCWludGVs
X2Rpc3BsYXlfcG93ZXJfcHV0X3VuY2hlY2tlZChpOTE1LAo+ICAgCQkJCQkgIGRpZ19wb3J0LT5k
ZGlfaW9fcG93ZXJfZG9tYWluKTsKPiAgIAo+ICAgCWludGVsX2RkaV9jbGtfZGlzYWJsZShlbmNv
ZGVyKTsKPiBAQCAtMzMxNSw3ICszMzE1LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZGRpX3Bvc3Rf
ZGlzYWJsZV9oZG1pKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCQljb25z
dCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCj4gICAJCQkJCWNvbnN0
IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKPiAgIHsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5k
ZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCA9IGVu
Y190b19kaWdfcG9ydCgmZW5jb2Rlci0+YmFzZSk7Cj4gICAJc3RydWN0IGludGVsX2hkbWkgKmlu
dGVsX2hkbWkgPSAmZGlnX3BvcnQtPmhkbWk7Cj4gICAKPiBAQCAtMzMyNiw3ICszMzI2LDcgQEAg
c3RhdGljIHZvaWQgaW50ZWxfZGRpX3Bvc3RfZGlzYWJsZV9oZG1pKHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyLAo+ICAgCj4gICAJaW50ZWxfZGlzYWJsZV9kZGlfYnVmKGVuY29kZXIsIG9s
ZF9jcnRjX3N0YXRlKTsKPiAgIAo+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfdW5jaGVja2Vk
KGRldl9wcml2LAo+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfdW5jaGVja2VkKGk5MTUsCj4g
ICAJCQkJCSAgZGlnX3BvcnQtPmRkaV9pb19wb3dlcl9kb21haW4pOwo+ICAgCj4gICAJaW50ZWxf
ZGRpX2Nsa19kaXNhYmxlKGVuY29kZXIpOwo+IEBAIC0zMzM4LDcgKzMzMzgsNyBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9kZGlfcG9zdF9kaXNhYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ICAgCQkJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0
ZSwKPiAgIAkJCQkgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5f
c3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAKPiAgIAkvKgo+ICAgCSAqIFdoZW4g
Y2FsbGVkIGZyb20gRFAgTVNUIGNvZGU6Cj4gQEAgLTMzNjAsNyArMzM2MCw3IEBAIHN0YXRpYyB2
b2lkIGludGVsX2RkaV9wb3N0X2Rpc2FibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
Cj4gICAJCWludGVsX2RkaV9wb3N0X2Rpc2FibGVfZHAoZW5jb2RlciwKPiAgIAkJCQkJICBvbGRf
Y3J0Y19zdGF0ZSwgb2xkX2Nvbm5fc3RhdGUpOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA+PSAxMSkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpCj4gICAJCWljbF91bm1h
cF9wbGxzX3RvX3BvcnRzKGVuY29kZXIpOwo+ICAgfQo+ICAgCj4gQEAgLTMzNjgsNyArMzM2OCw3
IEBAIHZvaWQgaW50ZWxfZGRpX2ZkaV9wb3N0X2Rpc2FibGUoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4gICAJCQkJY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRj
X3N0YXRlLAo+ICAgCQkJCWNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29u
bl9zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAl1MzIgdmFsOwo+ICAgCj4gICAJ
LyoKPiBAQCAtMzQwMiwxMSArMzQwMiwxMSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9lbmFibGVfZGRp
X2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCWNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCQkJCWNvbnN0IHN0cnVjdCBkcm1fY29u
bmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0
cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSBlbmNfdG9faW50ZWxfZHAoJmVuY29kZXItPmJhc2Up
Owo+ICAgCWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKPiAgIAo+IC0JaWYgKHBvcnQg
PT0gUE9SVF9BICYmIElOVEVMX0dFTihkZXZfcHJpdikgPCA5KQo+ICsJaWYgKHBvcnQgPT0gUE9S
VF9BICYmIElOVEVMX0dFTihpOTE1KSA8IDkpCj4gICAJCWludGVsX2RwX3N0b3BfbGlua190cmFp
bihpbnRlbF9kcCk7Cj4gICAKPiAgIAlpbnRlbF9lZHBfYmFja2xpZ2h0X29uKGNydGNfc3RhdGUs
IGNvbm5fc3RhdGUpOwo+IEBAIC0zNDE5LDcgKzM0MTksNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9l
bmFibGVfZGRpX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgfQo+ICAgCj4g
ICBzdGF0aWMgaTkxNV9yZWdfdAo+IC1nZW45X2NoaWNrZW5fdHJhbnNfcmVnX2J5X3BvcnQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtnZW45X2NoaWNrZW5fdHJhbnNfcmVn
X2J5X3BvcnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICAgICAgZW51
bSBwb3J0IHBvcnQpCj4gICB7Cj4gICAJc3RhdGljIGNvbnN0IGk5MTVfcmVnX3QgcmVnc1tdID0g
ewo+IEBAIC0zNDMwLDcgKzM0MzAsNyBAQCBnZW45X2NoaWNrZW5fdHJhbnNfcmVnX2J5X3BvcnQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCQlbUE9SVF9FXSA9IENISUNL
RU5fVFJBTlNfQSwKPiAgIAl9Owo+ICAgCj4gLQlXQVJOX09OKElOVEVMX0dFTihkZXZfcHJpdikg
PCA5KTsKPiArCVdBUk5fT04oSU5URUxfR0VOKGk5MTUpIDwgOSk7Cj4gICAKPiAgIAlpZiAoV0FS
Tl9PTihwb3J0IDwgUE9SVF9BIHx8IHBvcnQgPiBQT1JUX0UpKQo+ICAgCQlwb3J0ID0gUE9SVF9B
Owo+IEBAIC0zNDQyLDcgKzM0NDIsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9lbmFibGVfZGRpX2hk
bWkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkJICBjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJCQkgIGNvbnN0IHN0cnVjdCBkcm1f
Y29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAg
CXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0ID0gZW5jX3RvX2RpZ19wb3J0KCZl
bmNvZGVyLT5iYXNlKTsKPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gY29u
bl9zdGF0ZS0+Y29ubmVjdG9yOwo+ICAgCWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsK
PiBAQCAtMzQ1NCwxNCArMzQ1NCwxNCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9lbmFibGVfZGRpX2hk
bWkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkgIGNvbm5lY3Rvci0+YmFz
ZS5pZCwgY29ubmVjdG9yLT5uYW1lKTsKPiAgIAo+ICAgCS8qIERpc3BsYXkgV0EgIzExNDM6IHNr
bCxrYmwsY2ZsICovCj4gLQlpZiAoSVNfR0VOOV9CQyhkZXZfcHJpdikpIHsKPiArCWlmIChJU19H
RU45X0JDKGk5MTUpKSB7Cj4gICAJCS8qCj4gICAJCSAqIEZvciBzb21lIHJlYXNvbiB0aGVzZSBj
aGlja2VuIGJpdHMgaGF2ZSBiZWVuCj4gICAJCSAqIHN0dWZmZWQgaW50byBhIHRyYW5zY29kZXIg
cmVnaXN0ZXIsIGV2ZW50IHRob3VnaAo+ICAgCQkgKiB0aGUgYml0cyBhZmZlY3QgYSBzcGVjaWZp
YyBEREkgcG9ydCByYXRoZXIgdGhhbgo+ICAgCQkgKiBhIHNwZWNpZmljIHRyYW5zY29kZXIuCj4g
ICAJCSAqLwo+IC0JCWk5MTVfcmVnX3QgcmVnID0gZ2VuOV9jaGlja2VuX3RyYW5zX3JlZ19ieV9w
b3J0KGRldl9wcml2LCBwb3J0KTsKPiArCQlpOTE1X3JlZ190IHJlZyA9IGdlbjlfY2hpY2tlbl90
cmFuc19yZWdfYnlfcG9ydChpOTE1LCBwb3J0KTsKPiAgIAkJdTMyIHZhbDsKPiAgIAo+ICAgCQl2
YWwgPSBJOTE1X1JFQUQocmVnKTsKPiBAQCAtMzU5NSw5ICszNTk1LDkgQEAgc3RhdGljIHZvaWQg
aW50ZWxfZGRpX3NldF9maWFfbGFuZV9jb3VudChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKPiAgIAkJCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywK
PiAgIAkJCQkJIGVudW0gcG9ydCBwb3J0KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0
cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0ID0gZW5jX3RvX2RpZ19wb3J0KCZlbmNv
ZGVyLT5iYXNlKTsKPiAtCWVudW0gdGNfcG9ydCB0Y19wb3J0ID0gaW50ZWxfcG9ydF90b190Yyhk
ZXZfcHJpdiwgcG9ydCk7Cj4gKwllbnVtIHRjX3BvcnQgdGNfcG9ydCA9IGludGVsX3BvcnRfdG9f
dGMoaTkxNSwgcG9ydCk7Cj4gICAJdTMyIHZhbCA9IEk5MTVfUkVBRChQT1JUX1RYX0RGTEVYRFBN
TEUxKTsKPiAgIAlib29sIGxhbmVfcmV2ZXJzYWwgPSBkaWdfcG9ydC0+c2F2ZWRfcG9ydF9iaXRz
ICYgRERJX0JVRl9QT1JUX1JFVkVSU0FMOwo+ICAgCj4gQEAgLTM2MjUsMTYgKzM2MjUsMTYgQEAg
aW50ZWxfZGRpX3ByZV9wbGxfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+
ICAgCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCQkJ
IGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ICAgewo+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNl
LmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rl
ci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0ID0g
ZW5jX3RvX2RpZ19wb3J0KCZlbmNvZGVyLT5iYXNlKTsKPiAgIAllbnVtIHBvcnQgcG9ydCA9IGVu
Y29kZXItPnBvcnQ7Cj4gICAKPiAgIAlpZiAoaW50ZWxfY3J0Y19oYXNfZHBfZW5jb2RlcihjcnRj
X3N0YXRlKSB8fAo+IC0JICAgIGludGVsX3BvcnRfaXNfdGMoZGV2X3ByaXYsIGVuY29kZXItPnBv
cnQpKQo+IC0JCWludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGRldl9wcml2LAo+ICsJICAgIGludGVs
X3BvcnRfaXNfdGMoaTkxNSwgZW5jb2Rlci0+cG9ydCkpCj4gKwkJaW50ZWxfZGlzcGxheV9wb3dl
cl9nZXQoaTkxNSwKPiAgIAkJCQkJaW50ZWxfZGRpX21haW5fbGlua19hdXhfZG9tYWluKGRpZ19w
b3J0KSk7Cj4gICAKPiAtCWlmIChJU19HRU45X0xQKGRldl9wcml2KSkKPiArCWlmIChJU19HRU45
X0xQKGk5MTUpKQo+ICAgCQlieHRfZGRpX3BoeV9zZXRfbGFuZV9vcHRpbV9tYXNrKGVuY29kZXIs
Cj4gICAJCQkJCQljcnRjX3N0YXRlLT5sYW5lX2xhdF9vcHRpbV9tYXNrKTsKPiAgIAo+IEBAIC0z
NjU0LDE5ICszNjU0LDE5IEBAIGludGVsX2RkaV9wb3N0X3BsbF9kaXNhYmxlKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUsCj4gICAJCQkgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0
ZSAqY29ubl9zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxf
ZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCA9IGVuY190b19kaWdfcG9ydCgmZW5jb2Rlci0+YmFzZSk7
Cj4gICAKPiAgIAlpZiAoaW50ZWxfY3J0Y19oYXNfZHBfZW5jb2RlcihjcnRjX3N0YXRlKSB8fAo+
IC0JICAgIGludGVsX3BvcnRfaXNfdGMoZGV2X3ByaXYsIGVuY29kZXItPnBvcnQpKQo+IC0JCWlu
dGVsX2Rpc3BsYXlfcG93ZXJfcHV0X3VuY2hlY2tlZChkZXZfcHJpdiwKPiArCSAgICBpbnRlbF9w
b3J0X2lzX3RjKGk5MTUsIGVuY29kZXItPnBvcnQpKQo+ICsJCWludGVsX2Rpc3BsYXlfcG93ZXJf
cHV0X3VuY2hlY2tlZChpOTE1LAo+ICAgCQkJCQkJICBpbnRlbF9kZGlfbWFpbl9saW5rX2F1eF9k
b21haW4oZGlnX3BvcnQpKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgaW50ZWxfZGRpX3By
ZXBhcmVfbGlua19yZXRyYWluKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICB7Cj4gICAJ
c3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQgPSBkcF90b19kaWdfcG9y
dChpbnRlbF9kcCk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPQo+ICAgCQl0b19pOTE1KGludGVsX2RpZ19w
b3J0LT5iYXNlLmJhc2UuZGV2KTsKPiAgIAllbnVtIHBvcnQgcG9ydCA9IGludGVsX2RpZ19wb3J0
LT5iYXNlLnBvcnQ7Cj4gICAJdTMyIHZhbDsKPiBAQCAtMzY4Nyw3ICszNjg3LDcgQEAgc3RhdGlj
IHZvaWQgaW50ZWxfZGRpX3ByZXBhcmVfbGlua19yZXRyYWluKHN0cnVjdCBpbnRlbF9kcCAqaW50
ZWxfZHApCj4gICAJCVBPU1RJTkdfUkVBRChEUF9UUF9DVEwocG9ydCkpOwo+ICAgCj4gICAJCWlm
ICh3YWl0KQo+IC0JCQlpbnRlbF93YWl0X2RkaV9idWZfaWRsZShkZXZfcHJpdiwgcG9ydCk7Cj4g
KwkJCWludGVsX3dhaXRfZGRpX2J1Zl9pZGxlKGk5MTUsIHBvcnQpOwo+ICAgCX0KPiAgIAo+ICAg
CXZhbCA9IERQX1RQX0NUTF9FTkFCTEUgfAo+IEBAIC0zNzA5LDMyICszNzA5LDMyIEBAIHN0YXRp
YyB2b2lkIGludGVsX2RkaV9wcmVwYXJlX2xpbmtfcmV0cmFpbihzdHJ1Y3QgaW50ZWxfZHAgKmlu
dGVsX2RwKQo+ICAgCXVkZWxheSg2MDApOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBib29sIGludGVs
X2RkaV9pc19hdWRpb19lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiArc3RhdGljIGJvb2wgaW50ZWxfZGRpX2lzX2F1ZGlvX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgICAgIGVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNj
b2RlcikKPiAgIHsKPiAgIAlpZiAoY3B1X3RyYW5zY29kZXIgPT0gVFJBTlNDT0RFUl9FRFApCj4g
ICAJCXJldHVybiBmYWxzZTsKPiAgIAo+IC0JaWYgKCFpbnRlbF9kaXNwbGF5X3Bvd2VyX2lzX2Vu
YWJsZWQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9BVURJTykpCj4gKwlpZiAoIWludGVsX2Rpc3Bs
YXlfcG93ZXJfaXNfZW5hYmxlZChpOTE1LCBQT1dFUl9ET01BSU5fQVVESU8pKQo+ICAgCQlyZXR1
cm4gZmFsc2U7Cj4gICAKPiAgIAlyZXR1cm4gSTkxNV9SRUFEKEhTV19BVURfUElOX0VMRF9DUF9W
TEQpICYKPiAgIAkJQVVESU9fT1VUUFVUX0VOQUJMRShjcHVfdHJhbnNjb2Rlcik7Cj4gICB9Cj4g
ICAKPiAtdm9pZCBpbnRlbF9kZGlfY29tcHV0ZV9taW5fdm9sdGFnZV9sZXZlbChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3ZvaWQgaW50ZWxfZGRpX2NvbXB1dGVfbWluX3Zv
bHRhZ2VfbGV2ZWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJCSBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAtCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDExICYmIGNydGNfc3RhdGUtPnBvcnRfY2xvY2sgPiA1OTQwMDApCj4gKwlp
ZiAoSU5URUxfR0VOKGk5MTUpID49IDExICYmIGNydGNfc3RhdGUtPnBvcnRfY2xvY2sgPiA1OTQw
MDApCj4gICAJCWNydGNfc3RhdGUtPm1pbl92b2x0YWdlX2xldmVsID0gMTsKPiAtCWVsc2UgaWYg
KElTX0NBTk5PTkxBS0UoZGV2X3ByaXYpICYmIGNydGNfc3RhdGUtPnBvcnRfY2xvY2sgPiA1OTQw
MDApCj4gKwllbHNlIGlmIChJU19DQU5OT05MQUtFKGk5MTUpICYmIGNydGNfc3RhdGUtPnBvcnRf
Y2xvY2sgPiA1OTQwMDApCj4gICAJCWNydGNfc3RhdGUtPm1pbl92b2x0YWdlX2xldmVsID0gMjsK
PiAgIH0KPiAgIAo+ICAgdm9pZCBpbnRlbF9kZGlfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKPiAgIAkJCSAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29u
ZmlnKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRl
bF9jcnRjID0gdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+YmFzZS5jcnRjKTsKPiAgIAllbnVt
IHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBwaXBlX2NvbmZpZy0+Y3B1X3RyYW5zY29kZXI7
Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQ7Cj4gQEAgLTM4
MTYsMTAgKzM4MTYsMTAgQEAgdm9pZCBpbnRlbF9kZGlfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKPiAgIAl9Cj4gICAKPiAgIAlwaXBlX2NvbmZpZy0+aGFzX2F1ZGlv
ID0KPiAtCQlpbnRlbF9kZGlfaXNfYXVkaW9fZW5hYmxlZChkZXZfcHJpdiwgY3B1X3RyYW5zY29k
ZXIpOwo+ICsJCWludGVsX2RkaV9pc19hdWRpb19lbmFibGVkKGk5MTUsIGNwdV90cmFuc2NvZGVy
KTsKPiAgIAo+IC0JaWYgKGVuY29kZXItPnR5cGUgPT0gSU5URUxfT1VUUFVUX0VEUCAmJiBkZXZf
cHJpdi0+dmJ0LmVkcC5icHAgJiYKPiAtCSAgICBwaXBlX2NvbmZpZy0+cGlwZV9icHAgPiBkZXZf
cHJpdi0+dmJ0LmVkcC5icHApIHsKPiArCWlmIChlbmNvZGVyLT50eXBlID09IElOVEVMX09VVFBV
VF9FRFAgJiYgaTkxNS0+dmJ0LmVkcC5icHAgJiYKPiArCSAgICBwaXBlX2NvbmZpZy0+cGlwZV9i
cHAgPiBpOTE1LT52YnQuZWRwLmJwcCkgewo+ICAgCQkvKgo+ICAgCQkgKiBUaGlzIGlzIGEgYmln
IGZhdCB1Z2x5IGhhY2suCj4gICAJCSAqCj4gQEAgLTM4MzQsMTcgKzM4MzQsMTcgQEAgdm9pZCBp
bnRlbF9kZGlfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJ
ICogbG9hZC4KPiAgIAkJICovCj4gICAJCURSTV9ERUJVR19LTVMoInBpcGUgaGFzICVkIGJwcCBm
b3IgZURQIHBhbmVsLCBvdmVycmlkaW5nIEJJT1MtcHJvdmlkZWQgbWF4ICVkIGJwcFxuIiwKPiAt
CQkJICAgICAgcGlwZV9jb25maWctPnBpcGVfYnBwLCBkZXZfcHJpdi0+dmJ0LmVkcC5icHApOwo+
IC0JCWRldl9wcml2LT52YnQuZWRwLmJwcCA9IHBpcGVfY29uZmlnLT5waXBlX2JwcDsKPiArCQkJ
ICAgICAgcGlwZV9jb25maWctPnBpcGVfYnBwLCBpOTE1LT52YnQuZWRwLmJwcCk7Cj4gKwkJaTkx
NS0+dmJ0LmVkcC5icHAgPSBwaXBlX2NvbmZpZy0+cGlwZV9icHA7Cj4gICAJfQo+ICAgCj4gICAJ
aW50ZWxfZGRpX2Nsb2NrX2dldChlbmNvZGVyLCBwaXBlX2NvbmZpZyk7Cj4gICAKPiAtCWlmIChJ
U19HRU45X0xQKGRldl9wcml2KSkKPiArCWlmIChJU19HRU45X0xQKGk5MTUpKQo+ICAgCQlwaXBl
X2NvbmZpZy0+bGFuZV9sYXRfb3B0aW1fbWFzayA9Cj4gICAJCQlieHRfZGRpX3BoeV9nZXRfbGFu
ZV9sYXRfb3B0aW1fbWFzayhlbmNvZGVyKTsKPiAgIAo+IC0JaW50ZWxfZGRpX2NvbXB1dGVfbWlu
X3ZvbHRhZ2VfbGV2ZWwoZGV2X3ByaXYsIHBpcGVfY29uZmlnKTsKPiArCWludGVsX2RkaV9jb21w
dXRlX21pbl92b2x0YWdlX2xldmVsKGk5MTUsIHBpcGVfY29uZmlnKTsKPiAgIAo+ICAgCWludGVs
X2hkbWlfcmVhZF9nY3BfaW5mb2ZyYW1lKGVuY29kZXIsIHBpcGVfY29uZmlnKTsKPiAgIAo+IEBA
IC0zODg1LDExICszODg1LDExIEBAIHN0YXRpYyBpbnQgaW50ZWxfZGRpX2NvbXB1dGVfY29uZmln
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCSAgICBzdHJ1Y3QgZHJtX2Nv
bm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0Yyk7Cj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsK
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNl
LmRldik7Cj4gICAJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+ICAgCWludCByZXQ7
Cj4gICAKPiAtCWlmIChIQVNfVFJBTlNDT0RFUl9FRFAoZGV2X3ByaXYpICYmIHBvcnQgPT0gUE9S
VF9BKQo+ICsJaWYgKEhBU19UUkFOU0NPREVSX0VEUChpOTE1KSAmJiBwb3J0ID09IFBPUlRfQSkK
PiAgIAkJcGlwZV9jb25maWctPmNwdV90cmFuc2NvZGVyID0gVFJBTlNDT0RFUl9FRFA7Cj4gICAK
PiAgIAlpZiAoaW50ZWxfY3J0Y19oYXNfdHlwZShwaXBlX2NvbmZpZywgSU5URUxfT1VUUFVUX0hE
TUkpKQo+IEBAIC0zODk5LDE3ICszODk5LDE3IEBAIHN0YXRpYyBpbnQgaW50ZWxfZGRpX2NvbXB1
dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCWlmIChyZXQpCj4g
ICAJCXJldHVybiByZXQ7Cj4gICAKPiAtCWlmIChJU19IQVNXRUxMKGRldl9wcml2KSAmJiBjcnRj
LT5waXBlID09IFBJUEVfQSAmJgo+ICsJaWYgKElTX0hBU1dFTEwoaTkxNSkgJiYgY3J0Yy0+cGlw
ZSA9PSBQSVBFX0EgJiYKPiAgIAkgICAgcGlwZV9jb25maWctPmNwdV90cmFuc2NvZGVyID09IFRS
QU5TQ09ERVJfRURQKQo+ICAgCQlwaXBlX2NvbmZpZy0+cGNoX3BmaXQuZm9yY2VfdGhydSA9Cj4g
ICAJCQlwaXBlX2NvbmZpZy0+cGNoX3BmaXQuZW5hYmxlZCB8fAo+ICAgCQkJcGlwZV9jb25maWct
PmNyY19lbmFibGVkOwo+ICAgCj4gLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCj4gKwlpZiAo
SVNfR0VOOV9MUChpOTE1KSkKPiAgIAkJcGlwZV9jb25maWctPmxhbmVfbGF0X29wdGltX21hc2sg
PQo+ICAgCQkJYnh0X2RkaV9waHlfY2FsY19sYW5lX2xhdF9vcHRpbV9tYXNrKHBpcGVfY29uZmln
LT5sYW5lX2NvdW50KTsKPiAgIAo+IC0JaW50ZWxfZGRpX2NvbXB1dGVfbWluX3ZvbHRhZ2VfbGV2
ZWwoZGV2X3ByaXYsIHBpcGVfY29uZmlnKTsKPiArCWludGVsX2RkaV9jb21wdXRlX21pbl92b2x0
YWdlX2xldmVsKGk5MTUsIHBpcGVfY29uZmlnKTsKPiAgIAo+ICAgCXJldHVybiAwOwo+ICAgfQo+
IEBAIC00MDEzLDExICs0MDEzLDExIEBAIHN0YXRpYyBpbnQgbW9kZXNldF9waXBlKHN0cnVjdCBk
cm1fY3J0YyAqY3J0YywKPiAgIHN0YXRpYyBpbnQgaW50ZWxfaGRtaV9yZXNldF9saW5rKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCSBzdHJ1Y3QgZHJtX21vZGVzZXRfYWNx
dWlyZV9jdHggKmN0eCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxf
aGRtaSAqaGRtaSA9IGVuY190b19pbnRlbF9oZG1pKCZlbmNvZGVyLT5iYXNlKTsKPiAgIAlzdHJ1
Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IgPSBoZG1pLT5hdHRhY2hlZF9jb25uZWN0b3I7
Cj4gICAJc3RydWN0IGkyY19hZGFwdGVyICphZGFwdGVyID0KPiAtCQlpbnRlbF9nbWJ1c19nZXRf
YWRhcHRlcihkZXZfcHJpdiwgaGRtaS0+ZGRjX2J1cyk7Cj4gKwkJaW50ZWxfZ21idXNfZ2V0X2Fk
YXB0ZXIoaTkxNSwgaGRtaS0+ZGRjX2J1cyk7Cj4gICAJc3RydWN0IGRybV9jb25uZWN0b3Jfc3Rh
dGUgKmNvbm5fc3RhdGU7Cj4gICAJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGU7
Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4gQEAgLTQwMjcsNyArNDAyNyw3IEBAIHN0
YXRpYyBpbnQgaW50ZWxfaGRtaV9yZXNldF9saW5rKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyLAo+ICAgCWlmICghY29ubmVjdG9yIHx8IGNvbm5lY3Rvci0+YmFzZS5zdGF0dXMgIT0gY29u
bmVjdG9yX3N0YXR1c19jb25uZWN0ZWQpCj4gICAJCXJldHVybiAwOwo+ICAgCj4gLQlyZXQgPSBk
cm1fbW9kZXNldF9sb2NrKCZkZXZfcHJpdi0+ZHJtLm1vZGVfY29uZmlnLmNvbm5lY3Rpb25fbXV0
ZXgsCj4gKwlyZXQgPSBkcm1fbW9kZXNldF9sb2NrKCZpOTE1LT5kcm0ubW9kZV9jb25maWcuY29u
bmVjdGlvbl9tdXRleCwKPiAgIAkJCSAgICAgICBjdHgpOwo+ICAgCWlmIChyZXQpCj4gICAJCXJl
dHVybiByZXQ7Cj4gQEAgLTQxMzEsNyArNDEzMSw3IEBAIGludGVsX2RkaV9pbml0X2hkbWlfY29u
bmVjdG9yKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0KQo+ICAgCj4g
ICBzdGF0aWMgYm9vbCBpbnRlbF9kZGlfYV9mb3JjZV80X2xhbmVzKHN0cnVjdCBpbnRlbF9kaWdp
dGFsX3BvcnQgKmRwb3J0KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShkcG9ydC0+YmFzZS5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZHBvcnQtPmJhc2UuYmFzZS5kZXYpOwo+ICAgCj4gICAJ
aWYgKGRwb3J0LT5iYXNlLnBvcnQgIT0gUE9SVF9BKQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gQEAg
LTQxNDIsNyArNDE0Miw3IEBAIHN0YXRpYyBib29sIGludGVsX2RkaV9hX2ZvcmNlXzRfbGFuZXMo
c3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZHBvcnQpCj4gICAJLyogQnJveHRvbi9HZW1pbmls
YWtlOiBCc3BlYyBzYXlzIHRoYXQgRERJX0FfNF9MQU5FUyBpcyB0aGUgb25seQo+ICAgCSAqICAg
ICAgICAgICAgICAgICAgICAgc3VwcG9ydGVkIGNvbmZpZ3VyYXRpb24KPiAgIAkgKi8KPiAtCWlm
IChJU19HRU45X0xQKGRldl9wcml2KSkKPiArCWlmIChJU19HRU45X0xQKGk5MTUpKQo+ICAgCQly
ZXR1cm4gdHJ1ZTsKPiAgIAo+ICAgCS8qIENhbm5vbmxha2U6IE1vc3Qgb2YgU0tVcyBkb24ndCBz
dXBwb3J0IERESV9FLCBhbmQgdGhlIG9ubHkKPiBAQCAtNDE1MCw4ICs0MTUwLDggQEAgc3RhdGlj
IGJvb2wgaW50ZWxfZGRpX2FfZm9yY2VfNF9sYW5lcyhzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0
ICpkcG9ydCkKPiAgIAkgKiAgICAgICAgICAgICBERElfRiB3aGF0IG1ha2VzIERESV9FIHVzZWxl
c3MuIEhvd2V2ZXIgZm9yIHRoaXMKPiAgIAkgKiAgICAgICAgICAgICBjYXNlIGxldCdzIHRydXN0
IFZCVCBpbmZvLgo+ICAgCSAqLwo+IC0JaWYgKElTX0NBTk5PTkxBS0UoZGV2X3ByaXYpICYmCj4g
LQkgICAgIWludGVsX2Jpb3NfaXNfcG9ydF9wcmVzZW50KGRldl9wcml2LCBQT1JUX0UpKQo+ICsJ
aWYgKElTX0NBTk5PTkxBS0UoaTkxNSkgJiYKPiArCSAgICAhaW50ZWxfYmlvc19pc19wb3J0X3By
ZXNlbnQoaTkxNSwgUE9SVF9FKSkKPiAgIAkJcmV0dXJuIHRydWU7Cj4gICAKPiAgIAlyZXR1cm4g
ZmFsc2U7Cj4gQEAgLTQxNjAsMTEgKzQxNjAsMTEgQEAgc3RhdGljIGJvb2wgaW50ZWxfZGRpX2Ff
Zm9yY2VfNF9sYW5lcyhzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkcG9ydCkKPiAgIHN0YXRp
YyBpbnQKPiAgIGludGVsX2RkaV9tYXhfbGFuZXMoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAq
aW50ZWxfZHBvcnQpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGludGVsX2Rwb3J0LT5iYXNlLmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShpbnRlbF9kcG9ydC0+YmFzZS5iYXNlLmRldik7Cj4g
ICAJZW51bSBwb3J0IHBvcnQgPSBpbnRlbF9kcG9ydC0+YmFzZS5wb3J0Owo+ICAgCWludCBtYXhf
bGFuZXMgPSA0Owo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKPiArCWlm
IChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpCj4gICAJCXJldHVybiBtYXhfbGFuZXM7Cj4gICAKPiAg
IAlpZiAocG9ydCA9PSBQT1JUX0EgfHwgcG9ydCA9PSBQT1JUX0UpIHsKPiBAQCAtNDE4OSwxMCAr
NDE4OSwxMCBAQCBpbnRlbF9kZGlfbWF4X2xhbmVzKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQg
KmludGVsX2Rwb3J0KQo+ICAgCXJldHVybiBtYXhfbGFuZXM7Cj4gICB9Cj4gICAKPiAtdm9pZCBp
bnRlbF9kZGlfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcG9y
dCBwb3J0KQo+ICt2b2lkIGludGVsX2RkaV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LCBlbnVtIHBvcnQgcG9ydCkKPiAgIHsKPiAgIAlzdHJ1Y3QgZGRpX3ZidF9wb3J0X2luZm8g
KnBvcnRfaW5mbyA9Cj4gLQkJJmRldl9wcml2LT52YnQuZGRpX3BvcnRfaW5mb1twb3J0XTsKPiAr
CQkmaTkxNS0+dmJ0LmRkaV9wb3J0X2luZm9bcG9ydF07Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0
YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQ7Cj4gICAJc3RydWN0IGludGVsX2VuY29kZXIgKmludGVs
X2VuY29kZXI7Cj4gICAJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyOwo+IEBAIC00MjAyLDcg
KzQyMDIsNyBAQCB2b2lkIGludGVsX2RkaV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwgZW51bSBwb3J0IHBvcnQpCj4gICAJaW5pdF9oZG1pID0gcG9ydF9pbmZvLT5zdXBw
b3J0c19kdmkgfHwgcG9ydF9pbmZvLT5zdXBwb3J0c19oZG1pOwo+ICAgCWluaXRfZHAgPSBwb3J0
X2luZm8tPnN1cHBvcnRzX2RwOwo+ICAgCj4gLQlpZiAoaW50ZWxfYmlvc19pc19sc3Bjb25fcHJl
c2VudChkZXZfcHJpdiwgcG9ydCkpIHsKPiArCWlmIChpbnRlbF9iaW9zX2lzX2xzcGNvbl9wcmVz
ZW50KGk5MTUsIHBvcnQpKSB7Cj4gICAJCS8qCj4gICAJCSAqIExzcGNvbiBkZXZpY2UgbmVlZHMg
dG8gYmUgZHJpdmVuIHdpdGggRFAgY29ubmVjdG9yCj4gICAJCSAqIHdpdGggc3BlY2lhbCBkZXRl
Y3Rpb24gc2VxdWVuY2UuIFNvIG1ha2Ugc3VyZSBEUAo+IEBAIC00MjI3LDcgKzQyMjcsNyBAQCB2
b2lkIGludGVsX2RkaV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51
bSBwb3J0IHBvcnQpCj4gICAJaW50ZWxfZW5jb2RlciA9ICZpbnRlbF9kaWdfcG9ydC0+YmFzZTsK
PiAgIAllbmNvZGVyID0gJmludGVsX2VuY29kZXItPmJhc2U7Cj4gICAKPiAtCWRybV9lbmNvZGVy
X2luaXQoJmRldl9wcml2LT5kcm0sIGVuY29kZXIsICZpbnRlbF9kZGlfZnVuY3MsCj4gKwlkcm1f
ZW5jb2Rlcl9pbml0KCZpOTE1LT5kcm0sIGVuY29kZXIsICZpbnRlbF9kZGlfZnVuY3MsCj4gICAJ
CQkgRFJNX01PREVfRU5DT0RFUl9UTURTLCAiRERJICVjIiwgcG9ydF9uYW1lKHBvcnQpKTsKPiAg
IAo+ICAgCWludGVsX2VuY29kZXItPmhvdHBsdWcgPSBpbnRlbF9kZGlfaG90cGx1ZzsKPiBAQCAt
NDI0OCwxMCArNDI0OCwxMCBAQCB2b2lkIGludGVsX2RkaV9pbml0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBvcnQpCj4gICAJaW50ZWxfZW5jb2Rlci0+cG93
ZXJfZG9tYWluID0gaW50ZWxfcG9ydF90b19wb3dlcl9kb21haW4ocG9ydCk7Cj4gICAJaW50ZWxf
ZW5jb2Rlci0+cG9ydCA9IHBvcnQ7Cj4gICAJaW50ZWxfZW5jb2Rlci0+Y2xvbmVhYmxlID0gMDsK
PiAtCWZvcl9lYWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpCj4gKwlmb3JfZWFjaF9waXBlKGk5MTUs
IHBpcGUpCj4gICAJCWludGVsX2VuY29kZXItPmNydGNfbWFzayB8PSBCSVQocGlwZSk7Cj4gICAK
PiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1
KSA+PSAxMSkKPiAgIAkJaW50ZWxfZGlnX3BvcnQtPnNhdmVkX3BvcnRfYml0cyA9IEk5MTVfUkVB
RChERElfQlVGX0NUTChwb3J0KSkgJgo+ICAgCQkJRERJX0JVRl9QT1JUX1JFVkVSU0FMOwo+ICAg
CWVsc2UKPiBAQCAtNDI1OSw5ICs0MjU5LDkgQEAgdm9pZCBpbnRlbF9kZGlfaW5pdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcG9ydCBwb3J0KQo+ICAgCQkJKERESV9C
VUZfUE9SVF9SRVZFUlNBTCB8IERESV9BXzRfTEFORVMpOwo+ICAgCWludGVsX2RpZ19wb3J0LT5k
cC5vdXRwdXRfcmVnID0gSU5WQUxJRF9NTUlPX1JFRzsKPiAgIAlpbnRlbF9kaWdfcG9ydC0+bWF4
X2xhbmVzID0gaW50ZWxfZGRpX21heF9sYW5lcyhpbnRlbF9kaWdfcG9ydCk7Cj4gLQlpbnRlbF9k
aWdfcG9ydC0+YXV4X2NoID0gaW50ZWxfYmlvc19wb3J0X2F1eF9jaChkZXZfcHJpdiwgcG9ydCk7
Cj4gKwlpbnRlbF9kaWdfcG9ydC0+YXV4X2NoID0gaW50ZWxfYmlvc19wb3J0X2F1eF9jaChpOTE1
LCBwb3J0KTsKPiAgIAo+IC0JaW50ZWxfZGlnX3BvcnQtPnRjX2xlZ2FjeV9wb3J0ID0gaW50ZWxf
cG9ydF9pc190YyhkZXZfcHJpdiwgcG9ydCkgJiYKPiArCWludGVsX2RpZ19wb3J0LT50Y19sZWdh
Y3lfcG9ydCA9IGludGVsX3BvcnRfaXNfdGMoaTkxNSwgcG9ydCkgJiYKPiAgIAkJCQkJICFwb3J0
X2luZm8tPnN1cHBvcnRzX3R5cGVjX3VzYiAmJgo+ICAgCQkJCQkgIXBvcnRfaW5mby0+c3VwcG9y
dHNfdGJ0Owo+ICAgCj4gQEAgLTQzMjQsNyArNDMyNCw3IEBAIHZvaWQgaW50ZWxfZGRpX2luaXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBvcnQgcG9ydCkKPiAgIAo+
ICAgCWludGVsX2luZm9mcmFtZV9pbml0KGludGVsX2RpZ19wb3J0KTsKPiAgIAo+IC0JaWYgKGlu
dGVsX3BvcnRfaXNfdGMoZGV2X3ByaXYsIHBvcnQpKQo+ICsJaWYgKGludGVsX3BvcnRfaXNfdGMo
aTkxNSwgcG9ydCkpCj4gICAJCWludGVsX2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQoaW50ZWxfZW5j
b2Rlcik7Cj4gICAKPiAgIAlyZXR1cm47Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX2RkaS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGRpLmgKPiBpbmRl
eCBhMDgzNjVkYTI2NDMuLjUwZGQ2ZmFjNGUzYiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9kZGkuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rk
aS5oCj4gQEAgLTI0LDcgKzI0LDcgQEAgdm9pZCBpbnRlbF9kZGlfZmRpX3Bvc3RfZGlzYWJsZShz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqaW50ZWxfZW5jb2RlciwKPiAgIAkJCQljb25zdCBzdHJ1Y3Qg
ZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpOwo+ICAgdm9pZCBoc3dfZmRpX2xp
bmtfdHJhaW4oc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gICAJCQljb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7Cj4gLXZvaWQgaW50ZWxfZGRpX2luaXQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBvcnQgcG9ydCk7Cj4gK3ZvaWQgaW50
ZWxfZGRpX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gcG9ydCBwb3J0
KTsKPiAgIGJvb2wgaW50ZWxfZGRpX2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlciwgZW51bSBwaXBlICpwaXBlKTsKPiAgIHZvaWQgaW50ZWxfZGRpX2VuYWJsZV90cmFu
c2NvZGVyX2Z1bmMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpOwo+
ICAgdm9pZCBpbnRlbF9kZGlfZGlzYWJsZV90cmFuc2NvZGVyX2Z1bmMoY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpOwo+IEBAIC0zNiw3ICszNiw3IEBAIHZvaWQgaW50
ZWxfZGRpX2dldF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkg
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZyk7Cj4gICB2b2lkIGludGVsX2Rk
aV9zZXRfdmNfcGF5bG9hZF9hbGxvYyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSwKPiAgIAkJCQkgICAgYm9vbCBzdGF0ZSk7Cj4gLXZvaWQgaW50ZWxfZGRpX2NvbXB1
dGVfbWluX3ZvbHRhZ2VfbGV2ZWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICt2b2lkIGludGVsX2RkaV9jb21wdXRlX21pbl92b2x0YWdlX2xldmVsKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCQkJCQkgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUpOwo+ICAgdTMyIGJ4dF9zaWduYWxfbGV2ZWxzKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxf
ZHApOwo+ICAgdTMyIGRkaV9zaWduYWxfbGV2ZWxzKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAp
Owo+IEBAIC00Niw3ICs0Niw3IEBAIHU4IGludGVsX2RkaV9kcF9wcmVfZW1waGFzaXNfbWF4KHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgaW50IGludGVsX2RkaV90b2dnbGVfaGRj
cF9zaWduYWxsaW5nKHN0cnVjdCBpbnRlbF9lbmNvZGVyICppbnRlbF9lbmNvZGVyLAo+ICAgCQkJ
CSAgICAgYm9vbCBlbmFibGUpOwo+ICAgdm9pZCBpY2xfc2FuaXRpemVfZW5jb2Rlcl9wbGxfbWFw
cGluZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rlcik7Cj4gLWludCBjbmxfY2FsY193cnBs
bF9saW5rKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAraW50IGNubF9jYWxj
X3dycGxsX2xpbmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQlzdHJ1Y3Qg
aW50ZWxfZHBsbF9od19zdGF0ZSAqc3RhdGUpOwo+ICAgCj4gICAjZW5kaWYgLyogX19JTlRFTF9E
RElfSF9fICovCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rldmlj
ZV9pbmZvLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kZXZpY2VfaW5mby5jCj4gaW5k
ZXggNzEzNWQ4ZGMzMmE3Li5hNjcwODgxYjNmMWUgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfZGV2aWNlX2luZm8uYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2RldmljZV9pbmZvLmMKPiBAQCAtMTgyLDE1ICsxODIsMTUgQEAgc3RhdGljIHUxNiBj
b21wdXRlX2V1X3RvdGFsKGNvbnN0IHN0cnVjdCBzc2V1X2Rldl9pbmZvICpzc2V1KQo+ICAgCXJl
dHVybiB0b3RhbDsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBnZW4xMV9zc2V1X2luZm9faW5p
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGdlbjEx
X3NzZXVfaW5mb19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0J
c3RydWN0IHNzZXVfZGV2X2luZm8gKnNzZXUgPSAmUlVOVElNRV9JTkZPKGRldl9wcml2KS0+c3Nl
dTsKPiArCXN0cnVjdCBzc2V1X2Rldl9pbmZvICpzc2V1ID0gJlJVTlRJTUVfSU5GTyhpOTE1KS0+
c3NldTsKPiAgIAl1OCBzX2VuOwo+ICAgCXUzMiBzc19lbiwgc3NfZW5fbWFzazsKPiAgIAl1OCBl
dV9lbjsKPiAgIAlpbnQgczsKPiAgIAo+IC0JaWYgKElTX0VMS0hBUlRMQUtFKGRldl9wcml2KSkg
ewo+ICsJaWYgKElTX0VMS0hBUlRMQUtFKGk5MTUpKSB7Cj4gICAJCXNzZXUtPm1heF9zbGljZXMg
PSAxOwo+ICAgCQlzc2V1LT5tYXhfc3Vic2xpY2VzID0gNDsKPiAgIAkJc3NldS0+bWF4X2V1c19w
ZXJfc3Vic2xpY2UgPSA4Owo+IEBAIC0yMjcsOSArMjI3LDkgQEAgc3RhdGljIHZvaWQgZ2VuMTFf
c3NldV9pbmZvX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCXNz
ZXUtPmhhc19ldV9wZyA9IDE7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgZ2VuMTBfc3NldV9p
bmZvX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9p
ZCBnZW4xMF9zc2V1X2luZm9faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAg
IHsKPiAtCXN0cnVjdCBzc2V1X2Rldl9pbmZvICpzc2V1ID0gJlJVTlRJTUVfSU5GTyhkZXZfcHJp
diktPnNzZXU7Cj4gKwlzdHJ1Y3Qgc3NldV9kZXZfaW5mbyAqc3NldSA9ICZSVU5USU1FX0lORk8o
aTkxNSktPnNzZXU7Cj4gICAJY29uc3QgdTMyIGZ1c2UyID0gSTkxNV9SRUFEKEdFTjhfRlVTRTIp
Owo+ICAgCWludCBzLCBzczsKPiAgIAljb25zdCBpbnQgZXVfbWFzayA9IDB4ZmY7Cj4gQEAgLTMw
NSw5ICszMDUsOSBAQCBzdGF0aWMgdm9pZCBnZW4xMF9zc2V1X2luZm9faW5pdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJc3NldS0+aGFzX2V1X3BnID0gMTsKPiAgIH0K
PiAgIAo+IC1zdGF0aWMgdm9pZCBjaGVycnl2aWV3X3NzZXVfaW5mb19pbml0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgY2hlcnJ5dmlld19zc2V1X2lu
Zm9faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVjdCBz
c2V1X2Rldl9pbmZvICpzc2V1ID0gJlJVTlRJTUVfSU5GTyhkZXZfcHJpdiktPnNzZXU7Cj4gKwlz
dHJ1Y3Qgc3NldV9kZXZfaW5mbyAqc3NldSA9ICZSVU5USU1FX0lORk8oaTkxNSktPnNzZXU7Cj4g
ICAJdTMyIGZ1c2U7Cj4gICAKPiAgIAlmdXNlID0gSTkxNV9SRUFEKENIVl9GVVNFX0dUKTsKPiBA
QCAtMzU5LDEwICszNTksMTAgQEAgc3RhdGljIHZvaWQgY2hlcnJ5dmlld19zc2V1X2luZm9faW5p
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJc3NldS0+aGFzX2V1X3Bn
ID0gKHNzZXUtPmV1X3Blcl9zdWJzbGljZSA+IDIpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lk
IGdlbjlfc3NldV9pbmZvX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ICtzdGF0aWMgdm9pZCBnZW45X3NzZXVfaW5mb19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQo+ICAgewo+IC0Jc3RydWN0IGludGVsX2RldmljZV9pbmZvICppbmZvID0gbWt3cml0
ZV9kZXZpY2VfaW5mbyhkZXZfcHJpdik7Cj4gLQlzdHJ1Y3Qgc3NldV9kZXZfaW5mbyAqc3NldSA9
ICZSVU5USU1FX0lORk8oZGV2X3ByaXYpLT5zc2V1Owo+ICsJc3RydWN0IGludGVsX2RldmljZV9p
bmZvICppbmZvID0gbWt3cml0ZV9kZXZpY2VfaW5mbyhpOTE1KTsKPiArCXN0cnVjdCBzc2V1X2Rl
dl9pbmZvICpzc2V1ID0gJlJVTlRJTUVfSU5GTyhpOTE1KS0+c3NldTsKPiAgIAlpbnQgcywgc3M7
Cj4gICAJdTMyIGZ1c2UyLCBldV9kaXNhYmxlLCBzdWJzbGljZV9tYXNrOwo+ICAgCWNvbnN0IHU4
IGV1X21hc2sgPSAweGZmOwo+IEBAIC0zNzEsOCArMzcxLDggQEAgc3RhdGljIHZvaWQgZ2VuOV9z
c2V1X2luZm9faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJc3Nl
dS0+c2xpY2VfbWFzayA9IChmdXNlMiAmIEdFTjhfRjJfU19FTkFfTUFTSykgPj4gR0VOOF9GMl9T
X0VOQV9TSElGVDsKPiAgIAo+ICAgCS8qIEJYVCBoYXMgYSBzaW5nbGUgc2xpY2UgYW5kIGF0IG1v
c3QgMyBzdWJzbGljZXMuICovCj4gLQlzc2V1LT5tYXhfc2xpY2VzID0gSVNfR0VOOV9MUChkZXZf
cHJpdikgPyAxIDogMzsKPiAtCXNzZXUtPm1heF9zdWJzbGljZXMgPSBJU19HRU45X0xQKGRldl9w
cml2KSA/IDMgOiA0Owo+ICsJc3NldS0+bWF4X3NsaWNlcyA9IElTX0dFTjlfTFAoaTkxNSkgPyAx
IDogMzsKPiArCXNzZXUtPm1heF9zdWJzbGljZXMgPSBJU19HRU45X0xQKGk5MTUpID8gMyA6IDQ7
Cj4gICAJc3NldS0+bWF4X2V1c19wZXJfc3Vic2xpY2UgPSA4Owo+ICAgCj4gICAJLyoKPiBAQCAt
NDQyLDEyICs0NDIsMTIgQEAgc3RhdGljIHZvaWQgZ2VuOV9zc2V1X2luZm9faW5pdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICogcGFpciBwZXIgc3Vic2xpY2UuCj4g
ICAJKi8KPiAgIAlzc2V1LT5oYXNfc2xpY2VfcGcgPQo+IC0JCSFJU19HRU45X0xQKGRldl9wcml2
KSAmJiBod2VpZ2h0OChzc2V1LT5zbGljZV9tYXNrKSA+IDE7Cj4gKwkJIUlTX0dFTjlfTFAoaTkx
NSkgJiYgaHdlaWdodDgoc3NldS0+c2xpY2VfbWFzaykgPiAxOwo+ICAgCXNzZXUtPmhhc19zdWJz
bGljZV9wZyA9Cj4gLQkJSVNfR0VOOV9MUChkZXZfcHJpdikgJiYgaW50ZWxfc3NldV9zdWJzbGlj
ZV90b3RhbChzc2V1KSA+IDE7Cj4gKwkJSVNfR0VOOV9MUChpOTE1KSAmJiBpbnRlbF9zc2V1X3N1
YnNsaWNlX3RvdGFsKHNzZXUpID4gMTsKPiAgIAlzc2V1LT5oYXNfZXVfcGcgPSBzc2V1LT5ldV9w
ZXJfc3Vic2xpY2UgPiAyOwo+ICAgCj4gLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpIHsKPiAr
CWlmIChJU19HRU45X0xQKGk5MTUpKSB7Cj4gICAjZGVmaW5lIElTX1NTX0RJU0FCTEVEKHNzKQko
IShzc2V1LT5zdWJzbGljZV9tYXNrWzBdICYgQklUKHNzKSkpCj4gICAJCWluZm8tPmhhc19wb29s
ZWRfZXUgPSBod2VpZ2h0OChzc2V1LT5zdWJzbGljZV9tYXNrWzBdKSA9PSAzOwo+ICAgCj4gQEAg
LTQ2NCw5ICs0NjQsOSBAQCBzdGF0aWMgdm9pZCBnZW45X3NzZXVfaW5mb19pbml0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAl9Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZv
aWQgYnJvYWR3ZWxsX3NzZXVfaW5mb19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiArc3RhdGljIHZvaWQgYnJvYWR3ZWxsX3NzZXVfaW5mb19pbml0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RydWN0IHNzZXVfZGV2X2luZm8gKnNzZXUg
PSAmUlVOVElNRV9JTkZPKGRldl9wcml2KS0+c3NldTsKPiArCXN0cnVjdCBzc2V1X2Rldl9pbmZv
ICpzc2V1ID0gJlJVTlRJTUVfSU5GTyhpOTE1KS0+c3NldTsKPiAgIAlpbnQgcywgc3M7Cj4gICAJ
dTMyIGZ1c2UyLCBzdWJzbGljZV9tYXNrLCBldV9kaXNhYmxlWzNdOyAvKiBzX21heCAqLwo+ICAg
Cj4gQEAgLTU0Nyw5ICs1NDcsOSBAQCBzdGF0aWMgdm9pZCBicm9hZHdlbGxfc3NldV9pbmZvX2lu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCXNzZXUtPmhhc19ldV9w
ZyA9IDA7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaGFzd2VsbF9zc2V1X2luZm9faW5pdChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGhhc3dlbGxf
c3NldV9pbmZvX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlz
dHJ1Y3Qgc3NldV9kZXZfaW5mbyAqc3NldSA9ICZSVU5USU1FX0lORk8oZGV2X3ByaXYpLT5zc2V1
Owo+ICsJc3RydWN0IHNzZXVfZGV2X2luZm8gKnNzZXUgPSAmUlVOVElNRV9JTkZPKGk5MTUpLT5z
c2V1Owo+ICAgCXUzMiBmdXNlMTsKPiAgIAlpbnQgcywgc3M7Cj4gICAKPiBAQCAtNTU3LDkgKzU1
Nyw5IEBAIHN0YXRpYyB2b2lkIGhhc3dlbGxfc3NldV9pbmZvX2luaXQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCSAqIFRoZXJlIGlzbid0IGEgcmVnaXN0ZXIgdG8gdGVs
bCB1cyBob3cgbWFueSBzbGljZXMvc3Vic2xpY2VzLiBXZQo+ICAgCSAqIHdvcmsgb2ZmIHRoZSBQ
Q0ktaWRzIGhlcmUuCj4gICAJICovCj4gLQlzd2l0Y2ggKElOVEVMX0lORk8oZGV2X3ByaXYpLT5n
dCkgewo+ICsJc3dpdGNoIChJTlRFTF9JTkZPKGk5MTUpLT5ndCkgewo+ICAgCWRlZmF1bHQ6Cj4g
LQkJTUlTU0lOR19DQVNFKElOVEVMX0lORk8oZGV2X3ByaXYpLT5ndCk7Cj4gKwkJTUlTU0lOR19D
QVNFKElOVEVMX0lORk8oaTkxNSktPmd0KTsKPiAgIAkJLyogZmFsbCB0aHJvdWdoICovCj4gICAJ
Y2FzZSAxOgo+ICAgCQlzc2V1LT5zbGljZV9tYXNrID0gQklUKDApOwo+IEBAIC02MTIsNyArNjEy
LDcgQEAgc3RhdGljIHZvaWQgaGFzd2VsbF9zc2V1X2luZm9faW5pdChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJc3NldS0+aGFzX2V1X3BnID0gMDsKPiAgIH0KPiAgIAo+
IC1zdGF0aWMgdTMyIHJlYWRfcmVmZXJlbmNlX3RzX2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdTMyIHJlYWRfcmVmZXJlbmNlX3RzX2ZyZXEoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJdTMyIHRzX292ZXJyaWRlID0gSTkx
NV9SRUFEKEdFTjlfVElNRVNUQU1QX09WRVJSSURFKTsKPiAgIAl1MzIgYmFzZV9mcmVxLCBmcmFj
X2ZyZXE7Cj4gQEAgLTYyOSw3ICs2MjksNyBAQCBzdGF0aWMgdTMyIHJlYWRfcmVmZXJlbmNlX3Rz
X2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCXJldHVybiBiYXNl
X2ZyZXEgKyBmcmFjX2ZyZXE7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHUzMiBnZW4xMF9nZXRfY3J5
c3RhbF9jbG9ja19mcmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3Rh
dGljIHUzMiBnZW4xMF9nZXRfY3J5c3RhbF9jbG9ja19mcmVxKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAo+ICAgCQkJCQl1MzIgcnBtX2NvbmZpZ19yZWcpCj4gICB7Cj4gICAJdTMyIGYx
OV8yX21oeiA9IDE5MjAwOwo+IEBAIC02NDksNyArNjQ5LDcgQEAgc3RhdGljIHUzMiBnZW4xMF9n
ZXRfY3J5c3RhbF9jbG9ja19mcmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiAgIAl9Cj4gICB9Cj4gICAKPiAtc3RhdGljIHUzMiBnZW4xMV9nZXRfY3J5c3RhbF9jbG9ja19m
cmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHUzMiBnZW4x
MV9nZXRfY3J5c3RhbF9jbG9ja19mcmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+
ICAgCQkJCQl1MzIgcnBtX2NvbmZpZ19yZWcpCj4gICB7Cj4gICAJdTMyIGYxOV8yX21oeiA9IDE5
MjAwOwo+IEBAIC02NzUsMjEgKzY3NSwyMSBAQCBzdGF0aWMgdTMyIGdlbjExX2dldF9jcnlzdGFs
X2Nsb2NrX2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCX0KPiAg
IH0KPiAgIAo+IC1zdGF0aWMgdTMyIHJlYWRfdGltZXN0YW1wX2ZyZXF1ZW5jeShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB1MzIgcmVhZF90aW1lc3RhbXBfZnJl
cXVlbmN5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUzMiBmMTJf
NV9taHogPSAxMjUwMDsKPiAgIAl1MzIgZjE5XzJfbWh6ID0gMTkyMDA7Cj4gICAJdTMyIGYyNF9t
aHogPSAyNDAwMDsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPD0gNCkgewo+ICsJ
aWYgKElOVEVMX0dFTihpOTE1KSA8PSA0KSB7Cj4gICAJCS8qIFBSTXMgc2F5Ogo+ICAgCQkgKgo+
ICAgCQkgKiAgICAgIlRoZSB2YWx1ZSBpbiB0aGlzIHJlZ2lzdGVyIGluY3JlbWVudHMgb25jZSBl
dmVyeSAxNgo+ICAgCQkgKiAgICAgIGhjbGtzLiIgKHRocm91Z2ggdGhlIOKAnENsb2NraW5nIENv
bmZpZ3VyYXRpb27igJ0KPiAgIAkJICogICAgICAo4oCcQ0xLQ0ZH4oCdKSBNQ0hCQVIgcmVnaXN0
ZXIpCj4gICAJCSAqLwo+IC0JCXJldHVybiBkZXZfcHJpdi0+cmF3Y2xrX2ZyZXEgLyAxNjsKPiAt
CX0gZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8PSA4KSB7Cj4gKwkJcmV0dXJuIGk5MTUt
PnJhd2Nsa19mcmVxIC8gMTY7Cj4gKwl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA8PSA4KSB7
Cj4gICAJCS8qIFBSTXMgc2F5Ogo+ICAgCQkgKgo+ICAgCQkgKiAgICAgIlRoZSBQQ1UgVFNDIGNv
dW50cyAxMG5zIGluY3JlbWVudHM7IHRoaXMgdGltZXN0YW1wCj4gQEAgLTY5NywxNCArNjk3LDE0
IEBAIHN0YXRpYyB1MzIgcmVhZF90aW1lc3RhbXBfZnJlcXVlbmN5KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiAgIAkJICogICAgICByb2xsaW5nIG92ZXIgZXZlcnkgMS41IGhv
dXJzKS4KPiAgIAkJICovCj4gICAJCXJldHVybiBmMTJfNV9taHo7Cj4gLQl9IGVsc2UgaWYgKElO
VEVMX0dFTihkZXZfcHJpdikgPD0gOSkgewo+ICsJfSBlbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkg
PD0gOSkgewo+ICAgCQl1MzIgY3RjX3JlZyA9IEk5MTVfUkVBRChDVENfTU9ERSk7Cj4gICAJCXUz
MiBmcmVxID0gMDsKPiAgIAo+ICAgCQlpZiAoKGN0Y19yZWcgJiBDVENfU09VUkNFX1BBUkFNRVRF
Ul9NQVNLKSA9PSBDVENfU09VUkNFX0RJVklERV9MT0dJQykgewo+IC0JCQlmcmVxID0gcmVhZF9y
ZWZlcmVuY2VfdHNfZnJlcShkZXZfcHJpdik7Cj4gKwkJCWZyZXEgPSByZWFkX3JlZmVyZW5jZV90
c19mcmVxKGk5MTUpOwo+ICAgCQl9IGVsc2Ugewo+IC0JCQlmcmVxID0gSVNfR0VOOV9MUChkZXZf
cHJpdikgPyBmMTlfMl9taHogOiBmMjRfbWh6Owo+ICsJCQlmcmVxID0gSVNfR0VOOV9MUChpOTE1
KSA/IGYxOV8yX21oeiA6IGYyNF9taHo7Cj4gICAKPiAgIAkJCS8qIE5vdyBmaWd1cmUgb3V0IGhv
dyB0aGUgY29tbWFuZCBzdHJlYW0ncyB0aW1lc3RhbXAKPiAgIAkJCSAqIHJlZ2lzdGVyIGluY3Jl
bWVudHMgZnJvbSB0aGlzIGZyZXF1ZW5jeSAoaXQgbWlnaHQKPiBAQCAtNzE1LDcgKzcxNSw3IEBA
IHN0YXRpYyB1MzIgcmVhZF90aW1lc3RhbXBfZnJlcXVlbmN5KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiAgIAkJfQo+ICAgCj4gICAJCXJldHVybiBmcmVxOwo+IC0JfSBlbHNl
IGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDExKSB7Cj4gKwl9IGVsc2UgaWYgKElOVEVMX0dF
TihpOTE1KSA8PSAxMSkgewo+ICAgCQl1MzIgY3RjX3JlZyA9IEk5MTVfUkVBRChDVENfTU9ERSk7
Cj4gICAJCXUzMiBmcmVxID0gMDsKPiAgIAo+IEBAIC03MjUsMTUgKzcyNSwxNSBAQCBzdGF0aWMg
dTMyIHJlYWRfdGltZXN0YW1wX2ZyZXF1ZW5jeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gICAJCSAqIHRlbGxzIHVzIHdoaWNoIG9uZSB3ZSBzaG91bGQgdXNlLgo+ICAgCQkg
Ki8KPiAgIAkJaWYgKChjdGNfcmVnICYgQ1RDX1NPVVJDRV9QQVJBTUVURVJfTUFTSykgPT0gQ1RD
X1NPVVJDRV9ESVZJREVfTE9HSUMpIHsKPiAtCQkJZnJlcSA9IHJlYWRfcmVmZXJlbmNlX3RzX2Zy
ZXEoZGV2X3ByaXYpOwo+ICsJCQlmcmVxID0gcmVhZF9yZWZlcmVuY2VfdHNfZnJlcShpOTE1KTsK
PiAgIAkJfSBlbHNlIHsKPiAgIAkJCXUzMiBycG1fY29uZmlnX3JlZyA9IEk5MTVfUkVBRChSUE1f
Q09ORklHMCk7Cj4gICAKPiAtCQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPD0gMTApCj4gLQkJ
CQlmcmVxID0gZ2VuMTBfZ2V0X2NyeXN0YWxfY2xvY2tfZnJlcShkZXZfcHJpdiwKPiArCQkJaWYg
KElOVEVMX0dFTihpOTE1KSA8PSAxMCkKPiArCQkJCWZyZXEgPSBnZW4xMF9nZXRfY3J5c3RhbF9j
bG9ja19mcmVxKGk5MTUsCj4gICAJCQkJCQkJCXJwbV9jb25maWdfcmVnKTsKPiAgIAkJCWVsc2UK
PiAtCQkJCWZyZXEgPSBnZW4xMV9nZXRfY3J5c3RhbF9jbG9ja19mcmVxKGRldl9wcml2LAo+ICsJ
CQkJZnJlcSA9IGdlbjExX2dldF9jcnlzdGFsX2Nsb2NrX2ZyZXEoaTkxNSwKPiAgIAkJCQkJCQkJ
cnBtX2NvbmZpZ19yZWcpOwo+ICAgCj4gICAJCQkvKiBOb3cgZmlndXJlIG91dCBob3cgdGhlIGNv
bW1hbmQgc3RyZWFtJ3MgdGltZXN0YW1wCj4gQEAgLTg0MSw3ICs4NDEsNyBAQCB2b2lkIGludGVs
X2RldmljZV9pbmZvX3N1YnBsYXRmb3JtX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxfZGV2aWNlX2luZm9fcnVudGltZV9pbml0IC0g
aW5pdGlhbGl6ZSBydW50aW1lIGluZm8KPiAtICogQGRldl9wcml2OiB0aGUgaTkxNSBkZXZpY2UK
PiArICogQGk5MTU6IHRoZSBpOTE1IGRldmljZQo+ICAgICoKPiAgICAqIERldGVybWluZSB2YXJp
b3VzIGludGVsX2RldmljZV9pbmZvIGZpZWxkcyBhdCBydW50aW1lLgo+ICAgICoKPiBAQCAtODU1
LDE2ICs4NTUsMTYgQEAgdm9pZCBpbnRlbF9kZXZpY2VfaW5mb19zdWJwbGF0Zm9ybV9pbml0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgICogICAtIGFmdGVyIHRoZSBQQ0ggaGFz
IGJlZW4gZGV0ZWN0ZWQsCj4gICAgKiAgIC0gYmVmb3JlIHRoZSBmaXJzdCB1c2FnZSBvZiB0aGUg
ZmllbGRzIGl0IGNhbiB0d2Vhay4KPiAgICAqLwo+IC12b2lkIGludGVsX2RldmljZV9pbmZvX3J1
bnRpbWVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgaW50
ZWxfZGV2aWNlX2luZm9fcnVudGltZV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ICAgewo+IC0Jc3RydWN0IGludGVsX2RldmljZV9pbmZvICppbmZvID0gbWt3cml0ZV9kZXZp
Y2VfaW5mbyhkZXZfcHJpdik7Cj4gLQlzdHJ1Y3QgaW50ZWxfcnVudGltZV9pbmZvICpydW50aW1l
ID0gUlVOVElNRV9JTkZPKGRldl9wcml2KTsKPiArCXN0cnVjdCBpbnRlbF9kZXZpY2VfaW5mbyAq
aW5mbyA9IG1rd3JpdGVfZGV2aWNlX2luZm8oaTkxNSk7Cj4gKwlzdHJ1Y3QgaW50ZWxfcnVudGlt
ZV9pbmZvICpydW50aW1lID0gUlVOVElNRV9JTkZPKGk5MTUpOwo+ICAgCWVudW0gcGlwZSBwaXBl
Owo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCkgewo+IC0JCWZvcl9lYWNo
X3BpcGUoZGV2X3ByaXYsIHBpcGUpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDEwKSB7Cj4g
KwkJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKQo+ICAgCQkJcnVudGltZS0+bnVtX3NjYWxlcnNb
cGlwZV0gPSAyOwo+IC0JfSBlbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDkpKSB7Cj4gKwl9IGVs
c2UgaWYgKElTX0dFTihpOTE1LCA5KSkgewo+ICAgCQlydW50aW1lLT5udW1fc2NhbGVyc1tQSVBF
X0FdID0gMjsKPiAgIAkJcnVudGltZS0+bnVtX3NjYWxlcnNbUElQRV9CXSA9IDI7Cj4gICAJCXJ1
bnRpbWUtPm51bV9zY2FsZXJzW1BJUEVfQ10gPSAxOwo+IEBAIC04NzIsMTMgKzg3MiwxMyBAQCB2
b2lkIGludGVsX2RldmljZV9pbmZvX3J1bnRpbWVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gICAKPiAgIAlCVUlMRF9CVUdfT04oQklUU19QRVJfVFlQRShpbnRlbF9l
bmdpbmVfbWFza190KSA8IEk5MTVfTlVNX0VOR0lORVMpOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSAxMSkKPiAtCQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKQo+ICsJ
aWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiArCQlmb3JfZWFjaF9waXBlKGk5MTUsIHBpcGUp
Cj4gICAJCQlydW50aW1lLT5udW1fc3ByaXRlc1twaXBlXSA9IDY7Cj4gLQllbHNlIGlmIChJU19H
RU4oZGV2X3ByaXYsIDEwKSB8fCBJU19HRU1JTklMQUtFKGRldl9wcml2KSkKPiAtCQlmb3JfZWFj
aF9waXBlKGRldl9wcml2LCBwaXBlKQo+ICsJZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDEwKSB8fCBJ
U19HRU1JTklMQUtFKGk5MTUpKQo+ICsJCWZvcl9lYWNoX3BpcGUoaTkxNSwgcGlwZSkKPiAgIAkJ
CXJ1bnRpbWUtPm51bV9zcHJpdGVzW3BpcGVdID0gMzsKPiAtCWVsc2UgaWYgKElTX0JST1hUT04o
ZGV2X3ByaXYpKSB7Cj4gKwllbHNlIGlmIChJU19CUk9YVE9OKGk5MTUpKSB7Cj4gICAJCS8qCj4g
ICAJCSAqIFNreWxha2UgYW5kIEJyb3h0b24gY3VycmVudGx5IGRvbid0IGV4cG9zZSB0aGUgdG9w
bW9zdCBwbGFuZSBhcyBpdHMKPiAgIAkJICogdXNlIGlzIGV4Y2x1c2l2ZSB3aXRoIHRoZSBsZWdh
Y3kgY3Vyc29yIGFuZCB3ZSBvbmx5IHdhbnQgdG8gZXhwb3NlCj4gQEAgLTg5MSwyMCArODkxLDIw
IEBAIHZvaWQgaW50ZWxfZGV2aWNlX2luZm9fcnVudGltZV9pbml0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiAgIAkJcnVudGltZS0+bnVtX3Nwcml0ZXNbUElQRV9BXSA9IDI7
Cj4gICAJCXJ1bnRpbWUtPm51bV9zcHJpdGVzW1BJUEVfQl0gPSAyOwo+ICAgCQlydW50aW1lLT5u
dW1fc3ByaXRlc1tQSVBFX0NdID0gMTsKPiAtCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZf
cHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiAtCQlmb3JfZWFjaF9waXBlKGRl
dl9wcml2LCBwaXBlKQo+ICsJfSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NI
RVJSWVZJRVcoaTkxNSkpIHsKPiArCQlmb3JfZWFjaF9waXBlKGk5MTUsIHBpcGUpCj4gICAJCQly
dW50aW1lLT5udW1fc3ByaXRlc1twaXBlXSA9IDI7Cj4gLQl9IGVsc2UgaWYgKElOVEVMX0dFTihk
ZXZfcHJpdikgPj0gNSB8fCBJU19HNFgoZGV2X3ByaXYpKSB7Cj4gLQkJZm9yX2VhY2hfcGlwZShk
ZXZfcHJpdiwgcGlwZSkKPiArCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDUgfHwgSVNf
RzRYKGk5MTUpKSB7Cj4gKwkJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKQo+ICAgCQkJcnVudGlt
ZS0+bnVtX3Nwcml0ZXNbcGlwZV0gPSAxOwo+ICAgCX0KPiAgIAo+ICAgCWlmIChpOTE1X21vZHBh
cmFtcy5kaXNhYmxlX2Rpc3BsYXkpIHsKPiAgIAkJRFJNX0lORk8oIkRpc3BsYXkgZGlzYWJsZWQg
KG1vZHVsZSBwYXJhbWV0ZXIpXG4iKTsKPiAgIAkJaW5mby0+bnVtX3BpcGVzID0gMDsKPiAtCX0g
ZWxzZSBpZiAoSEFTX0RJU1BMQVkoZGV2X3ByaXYpICYmCj4gLQkJICAgKElTX0dFTl9SQU5HRShk
ZXZfcHJpdiwgNywgOCkpICYmCj4gLQkJICAgSEFTX1BDSF9TUExJVChkZXZfcHJpdikpIHsKPiAr
CX0gZWxzZSBpZiAoSEFTX0RJU1BMQVkoaTkxNSkgJiYKPiArCQkgICAoSVNfR0VOX1JBTkdFKGk5
MTUsIDcsIDgpKSAmJgo+ICsJCSAgIEhBU19QQ0hfU1BMSVQoaTkxNSkpIHsKPiAgIAkJdTMyIGZ1
c2Vfc3RyYXAgPSBJOTE1X1JFQUQoRlVTRV9TVFJBUCk7Cj4gICAJCXUzMiBzZnVzZV9zdHJhcCA9
IEk5MTVfUkVBRChTRlVTRV9TVFJBUCk7Cj4gICAKPiBAQCAtOTE5LDcgKzkxOSw3IEBAIHZvaWQg
aW50ZWxfZGV2aWNlX2luZm9fcnVudGltZV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiAgIAkJICovCj4gICAJCWlmIChmdXNlX3N0cmFwICYgSUxLX0lOVEVSTkFMX0RJ
U1BMQVlfRElTQUJMRSB8fAo+ICAgCQkgICAgc2Z1c2Vfc3RyYXAgJiBTRlVTRV9TVFJBUF9ESVNQ
TEFZX0RJU0FCTEVEIHx8Cj4gLQkJICAgIChIQVNfUENIX0NQVChkZXZfcHJpdikgJiYKPiArCQkg
ICAgKEhBU19QQ0hfQ1BUKGk5MTUpICYmCj4gICAJCSAgICAgIShzZnVzZV9zdHJhcCAmIFNGVVNF
X1NUUkFQX0ZVU0VfTE9DSykpKSB7Cj4gICAJCQlEUk1fSU5GTygiRGlzcGxheSBmdXNlZCBvZmYs
IGRpc2FibGluZ1xuIik7Cj4gICAJCQlpbmZvLT5udW1fcGlwZXMgPSAwOwo+IEBAIC05MjcsNyAr
OTI3LDcgQEAgdm9pZCBpbnRlbF9kZXZpY2VfaW5mb19ydW50aW1lX2luaXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQkJRFJNX0lORk8oIlBpcGVDIGZ1c2VkIG9mZlxu
Iik7Cj4gICAJCQlpbmZvLT5udW1fcGlwZXMgLT0gMTsKPiAgIAkJfQo+IC0JfSBlbHNlIGlmIChI
QVNfRElTUExBWShkZXZfcHJpdikgJiYgSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KSB7Cj4gKwl9
IGVsc2UgaWYgKEhBU19ESVNQTEFZKGk5MTUpICYmIElOVEVMX0dFTihpOTE1KSA+PSA5KSB7Cj4g
ICAJCXUzMiBkZnNtID0gSTkxNV9SRUFEKFNLTF9ERlNNKTsKPiAgIAkJdTggZGlzYWJsZWRfbWFz
ayA9IDA7Cj4gICAJCWJvb2wgaW52YWxpZDsKPiBAQCAtOTYxLDI2ICs5NjEsMjYgQEAgdm9pZCBp
bnRlbF9kZXZpY2VfaW5mb19ydW50aW1lX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ICAgCX0KPiAgIAo+ICAgCS8qIEluaXRpYWxpemUgc2xpY2Uvc3Vic2xpY2UvRVUg
aW5mbyAqLwo+IC0JaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpKQo+IC0JCWhhc3dlbGxfc3NldV9p
bmZvX2luaXQoZGV2X3ByaXYpOwo+IC0JZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikp
Cj4gLQkJY2hlcnJ5dmlld19zc2V1X2luZm9faW5pdChkZXZfcHJpdik7Cj4gLQllbHNlIGlmIChJ
U19CUk9BRFdFTEwoZGV2X3ByaXYpKQo+IC0JCWJyb2Fkd2VsbF9zc2V1X2luZm9faW5pdChkZXZf
cHJpdik7Cj4gLQllbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDkpKQo+IC0JCWdlbjlfc3NldV9p
bmZvX2luaXQoZGV2X3ByaXYpOwo+IC0JZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCAxMCkpCj4g
LQkJZ2VuMTBfc3NldV9pbmZvX2luaXQoZGV2X3ByaXYpOwo+IC0JZWxzZSBpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSAxMSkKPiAtCQlnZW4xMV9zc2V1X2luZm9faW5pdChkZXZfcHJpdik7Cj4g
LQo+IC0JaWYgKElTX0dFTihkZXZfcHJpdiwgNikgJiYgaW50ZWxfdnRkX2FjdGl2ZSgpKSB7Cj4g
KwlpZiAoSVNfSEFTV0VMTChpOTE1KSkKPiArCQloYXN3ZWxsX3NzZXVfaW5mb19pbml0KGk5MTUp
Owo+ICsJZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiArCQljaGVycnl2aWV3X3NzZXVf
aW5mb19pbml0KGk5MTUpOwo+ICsJZWxzZSBpZiAoSVNfQlJPQURXRUxMKGk5MTUpKQo+ICsJCWJy
b2Fkd2VsbF9zc2V1X2luZm9faW5pdChpOTE1KTsKPiArCWVsc2UgaWYgKElTX0dFTihpOTE1LCA5
KSkKPiArCQlnZW45X3NzZXVfaW5mb19pbml0KGk5MTUpOwo+ICsJZWxzZSBpZiAoSVNfR0VOKGk5
MTUsIDEwKSkKPiArCQlnZW4xMF9zc2V1X2luZm9faW5pdChpOTE1KTsKPiArCWVsc2UgaWYgKElO
VEVMX0dFTihpOTE1KSA+PSAxMSkKPiArCQlnZW4xMV9zc2V1X2luZm9faW5pdChpOTE1KTsKPiAr
Cj4gKwlpZiAoSVNfR0VOKGk5MTUsIDYpICYmIGludGVsX3Z0ZF9hY3RpdmUoKSkgewo+ICAgCQlE
Uk1fSU5GTygiRGlzYWJsaW5nIHBwR1RUIGZvciBWVC1kIHN1cHBvcnRcbiIpOwo+ICAgCQlpbmZv
LT5wcGd0dF90eXBlID0gSU5URUxfUFBHVFRfTk9ORTsKPiAgIAl9Cj4gICAKPiAgIAkvKiBJbml0
aWFsaXplIGNvbW1hbmQgc3RyZWFtIHRpbWVzdGFtcCBmcmVxdWVuY3kgKi8KPiAtCXJ1bnRpbWUt
PmNzX3RpbWVzdGFtcF9mcmVxdWVuY3lfa2h6ID0gcmVhZF90aW1lc3RhbXBfZnJlcXVlbmN5KGRl
dl9wcml2KTsKPiArCXJ1bnRpbWUtPmNzX3RpbWVzdGFtcF9mcmVxdWVuY3lfa2h6ID0gcmVhZF90
aW1lc3RhbXBfZnJlcXVlbmN5KGk5MTUpOwo+ICAgfQo+ICAgCj4gICB2b2lkIGludGVsX2RyaXZl
cl9jYXBzX3ByaW50KGNvbnN0IHN0cnVjdCBpbnRlbF9kcml2ZXJfY2FwcyAqY2FwcywKPiBAQCAt
OTk3LDE2ICs5OTcsMTYgQEAgdm9pZCBpbnRlbF9kcml2ZXJfY2Fwc19wcmludChjb25zdCBzdHJ1
Y3QgaW50ZWxfZHJpdmVyX2NhcHMgKmNhcHMsCj4gICAgKiB0aGlzIHBvaW50IChidXQgbGF0ZXIg
d2UgbmVlZCB0byBwcnVuZSB0aGUgZm9yY2V3YWtlIGRvbWFpbnMgZm9yIGVuZ2luZXMgdGhhdAo+
ICAgICogYXJlIGluZGVlZCBmdXNlZCBvZmYpLgo+ICAgICovCj4gLXZvaWQgaW50ZWxfZGV2aWNl
X2luZm9faW5pdF9tbWlvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9p
ZCBpbnRlbF9kZXZpY2VfaW5mb19pbml0X21taW8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfZGV2aWNlX2luZm8gKmluZm8gPSBta3dyaXRlX2Rl
dmljZV9pbmZvKGRldl9wcml2KTsKPiArCXN0cnVjdCBpbnRlbF9kZXZpY2VfaW5mbyAqaW5mbyA9
IG1rd3JpdGVfZGV2aWNlX2luZm8oaTkxNSk7Cj4gICAJdW5zaWduZWQgaW50IGxvZ2ljYWxfdmRi
b3ggPSAwOwo+ICAgCXVuc2lnbmVkIGludCBpOwo+ICAgCXUzMiBtZWRpYV9mdXNlOwo+ICAgCXUx
NiB2ZGJveF9tYXNrOwo+ICAgCXUxNiB2ZWJveF9tYXNrOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA8IDExKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8IDExKQo+ICAgCQlyZXR1
cm47Cj4gICAKPiAgIAltZWRpYV9mdXNlID0gfkk5MTVfUkVBRChHRU4xMV9HVF9WRUJPWF9WREJP
WF9ESVNBQkxFKTsKPiBAQCAtMTAxNiw3ICsxMDE2LDcgQEAgdm9pZCBpbnRlbF9kZXZpY2VfaW5m
b19pbml0X21taW8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQkgICAg
ICBHRU4xMV9HVF9WRUJPWF9ESVNBQkxFX1NISUZUOwo+ICAgCj4gICAJZm9yIChpID0gMDsgaSA8
IEk5MTVfTUFYX1ZDUzsgaSsrKSB7Cj4gLQkJaWYgKCFIQVNfRU5HSU5FKGRldl9wcml2LCBfVkNT
KGkpKSkKPiArCQlpZiAoIUhBU19FTkdJTkUoaTkxNSwgX1ZDUyhpKSkpCj4gICAJCQljb250aW51
ZTsKPiAgIAo+ICAgCQlpZiAoIShCSVQoaSkgJiB2ZGJveF9tYXNrKSkgewo+IEBAIC0xMDMwLDE0
ICsxMDMwLDE0IEBAIHZvaWQgaW50ZWxfZGV2aWNlX2luZm9faW5pdF9tbWlvKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkJICogaG9va2VkIHVwIHRvIGFuIFNGQyAoU2Nh
bGVyICYgRm9ybWF0IENvbnZlcnRlcikgdW5pdC4KPiAgIAkJICovCj4gICAJCWlmIChsb2dpY2Fs
X3ZkYm94KysgJSAyID09IDApCj4gLQkJCVJVTlRJTUVfSU5GTyhkZXZfcHJpdiktPnZkYm94X3Nm
Y19hY2Nlc3MgfD0gQklUKGkpOwo+ICsJCQlSVU5USU1FX0lORk8oaTkxNSktPnZkYm94X3NmY19h
Y2Nlc3MgfD0gQklUKGkpOwo+ICAgCX0KPiAgIAlEUk1fREVCVUdfRFJJVkVSKCJ2ZGJveCBlbmFi
bGU6ICUwNHgsIGluc3RhbmNlczogJTA0bHhcbiIsCj4gLQkJCSB2ZGJveF9tYXNrLCBWREJPWF9N
QVNLKGRldl9wcml2KSk7Cj4gLQlHRU1fQlVHX09OKHZkYm94X21hc2sgIT0gVkRCT1hfTUFTSyhk
ZXZfcHJpdikpOwo+ICsJCQkgdmRib3hfbWFzaywgVkRCT1hfTUFTSyhpOTE1KSk7Cj4gKwlHRU1f
QlVHX09OKHZkYm94X21hc2sgIT0gVkRCT1hfTUFTSyhpOTE1KSk7Cj4gICAKPiAgIAlmb3IgKGkg
PSAwOyBpIDwgSTkxNV9NQVhfVkVDUzsgaSsrKSB7Cj4gLQkJaWYgKCFIQVNfRU5HSU5FKGRldl9w
cml2LCBfVkVDUyhpKSkpCj4gKwkJaWYgKCFIQVNfRU5HSU5FKGk5MTUsIF9WRUNTKGkpKSkKPiAg
IAkJCWNvbnRpbnVlOwo+ICAgCj4gICAJCWlmICghKEJJVChpKSAmIHZlYm94X21hc2spKSB7Cj4g
QEAgLTEwNDYsNiArMTA0Niw2IEBAIHZvaWQgaW50ZWxfZGV2aWNlX2luZm9faW5pdF9tbWlvKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkJfQo+ICAgCX0KPiAgIAlEUk1f
REVCVUdfRFJJVkVSKCJ2ZWJveCBlbmFibGU6ICUwNHgsIGluc3RhbmNlczogJTA0bHhcbiIsCj4g
LQkJCSB2ZWJveF9tYXNrLCBWRUJPWF9NQVNLKGRldl9wcml2KSk7Cj4gLQlHRU1fQlVHX09OKHZl
Ym94X21hc2sgIT0gVkVCT1hfTUFTSyhkZXZfcHJpdikpOwo+ICsJCQkgdmVib3hfbWFzaywgVkVC
T1hfTUFTSyhpOTE1KSk7Cj4gKwlHRU1fQlVHX09OKHZlYm94X21hc2sgIT0gVkVCT1hfTUFTSyhp
OTE1KSk7Cj4gICB9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rl
dmljZV9pbmZvLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kZXZpY2VfaW5mby5oCj4g
aW5kZXggM2VhOTUzYTIzMGIzLi45M2U1Y2M5NWU1YzAgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfZGV2aWNlX2luZm8uaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX2RldmljZV9pbmZvLmgKPiBAQCAtMjE4LDggKzIxOCw4IEBAIHN0cnVjdCBpbnRl
bF9kcml2ZXJfY2FwcyB7Cj4gICAKPiAgIGNvbnN0IGNoYXIgKmludGVsX3BsYXRmb3JtX25hbWUo
ZW51bSBpbnRlbF9wbGF0Zm9ybSBwbGF0Zm9ybSk7Cj4gICAKPiAtdm9pZCBpbnRlbF9kZXZpY2Vf
aW5mb19zdWJwbGF0Zm9ybV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7
Cj4gLXZvaWQgaW50ZWxfZGV2aWNlX2luZm9fcnVudGltZV9pbml0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdik7Cj4gK3ZvaWQgaW50ZWxfZGV2aWNlX2luZm9fc3VicGxhdGZvcm1f
aW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgaW50ZWxfZGV2aWNl
X2luZm9fcnVudGltZV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAgIHZv
aWQgaW50ZWxfZGV2aWNlX2luZm9fZHVtcF9mbGFncyhjb25zdCBzdHJ1Y3QgaW50ZWxfZGV2aWNl
X2luZm8gKmluZm8sCj4gICAJCQkJICBzdHJ1Y3QgZHJtX3ByaW50ZXIgKnApOwo+ICAgdm9pZCBp
bnRlbF9kZXZpY2VfaW5mb19kdW1wX3J1bnRpbWUoY29uc3Qgc3RydWN0IGludGVsX3J1bnRpbWVf
aW5mbyAqaW5mbywKPiBAQCAtMjI3LDcgKzIyNyw3IEBAIHZvaWQgaW50ZWxfZGV2aWNlX2luZm9f
ZHVtcF9ydW50aW1lKGNvbnN0IHN0cnVjdCBpbnRlbF9ydW50aW1lX2luZm8gKmluZm8sCj4gICB2
b2lkIGludGVsX2RldmljZV9pbmZvX2R1bXBfdG9wb2xvZ3koY29uc3Qgc3RydWN0IHNzZXVfZGV2
X2luZm8gKnNzZXUsCj4gICAJCQkJICAgICBzdHJ1Y3QgZHJtX3ByaW50ZXIgKnApOwo+ICAgCj4g
LXZvaWQgaW50ZWxfZGV2aWNlX2luZm9faW5pdF9tbWlvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdik7Cj4gK3ZvaWQgaW50ZWxfZGV2aWNlX2luZm9faW5pdF9tbWlvKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAgIAo+ICAgdm9pZCBpbnRlbF9kcml2ZXJfY2Fwc19w
cmludChjb25zdCBzdHJ1Y3QgaW50ZWxfZHJpdmVyX2NhcHMgKmNhcHMsCj4gICAJCQkgICAgIHN0
cnVjdCBkcm1fcHJpbnRlciAqcCk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2Rpc3BsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rpc3BsYXkuYwo+
IGluZGV4IDFiMWRkYjQ4Y2E3YS4uYmUyNmFkOWZjMTk0IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX2Rpc3BsYXkuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2Rpc3BsYXkuYwo+IEBAIC0xNTYsMjQgKzE1NiwyNCBAQCBzdHJ1Y3QgaW50ZWxfbGlt
aXQgewo+ICAgfTsKPiAgIAo+ICAgLyogcmV0dXJucyBIUExMIGZyZXF1ZW5jeSBpbiBrSHogKi8K
PiAtaW50IHZsdl9nZXRfaHBsbF92Y28oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ICtpbnQgdmx2X2dldF9ocGxsX3ZjbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiAgIHsKPiAgIAlpbnQgaHBsbF9mcmVxLCB2Y29fZnJlcVtdID0geyA4MDAsIDE2MDAsIDIwMDAs
IDI0MDAgfTsKPiAgIAo+ICAgCS8qIE9idGFpbiBTS1UgaW5mb3JtYXRpb24gKi8KPiAtCWhwbGxf
ZnJlcSA9IHZsdl9jY2tfcmVhZChkZXZfcHJpdiwgQ0NLX0ZVU0VfUkVHKSAmCj4gKwlocGxsX2Zy
ZXEgPSB2bHZfY2NrX3JlYWQoaTkxNSwgQ0NLX0ZVU0VfUkVHKSAmCj4gICAJCUNDS19GVVNFX0hQ
TExfRlJFUV9NQVNLOwo+ICAgCj4gICAJcmV0dXJuIHZjb19mcmVxW2hwbGxfZnJlcV0gKiAxMDAw
Owo+ICAgfQo+ICAgCj4gLWludCB2bHZfZ2V0X2Nja19jbG9jayhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gK2ludCB2bHZfZ2V0X2Nja19jbG9jayhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKPiAgIAkJICAgICAgY29uc3QgY2hhciAqbmFtZSwgdTMyIHJlZywgaW50
IHJlZl9mcmVxKQo+ICAgewo+ICAgCXUzMiB2YWw7Cj4gICAJaW50IGRpdmlkZXI7Cj4gICAKPiAt
CXZhbCA9IHZsdl9jY2tfcmVhZChkZXZfcHJpdiwgcmVnKTsKPiArCXZhbCA9IHZsdl9jY2tfcmVh
ZChpOTE1LCByZWcpOwo+ICAgCWRpdmlkZXIgPSB2YWwgJiBDQ0tfRlJFUVVFTkNZX1ZBTFVFUzsK
PiAgIAo+ICAgCVdBUk4oKHZhbCAmIENDS19GUkVRVUVOQ1lfU1RBVFVTKSAhPQo+IEBAIC0xODMs
NDIgKzE4Myw0MiBAQCBpbnQgdmx2X2dldF9jY2tfY2xvY2soc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ICAgCXJldHVybiBESVZfUk9VTkRfQ0xPU0VTVChyZWZfZnJlcSA8PCAx
LCBkaXZpZGVyICsgMSk7Cj4gICB9Cj4gICAKPiAtaW50IHZsdl9nZXRfY2NrX2Nsb2NrX2hwbGwo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtpbnQgdmx2X2dldF9jY2tfY2xv
Y2tfaHBsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgIGNvbnN0IGNo
YXIgKm5hbWUsIHUzMiByZWcpCj4gICB7Cj4gICAJaW50IGhwbGw7Cj4gICAKPiAtCXZsdl9jY2tf
Z2V0KGRldl9wcml2KTsKPiArCXZsdl9jY2tfZ2V0KGk5MTUpOwo+ICAgCj4gLQlpZiAoZGV2X3By
aXYtPmhwbGxfZnJlcSA9PSAwKQo+IC0JCWRldl9wcml2LT5ocGxsX2ZyZXEgPSB2bHZfZ2V0X2hw
bGxfdmNvKGRldl9wcml2KTsKPiArCWlmIChpOTE1LT5ocGxsX2ZyZXEgPT0gMCkKPiArCQlpOTE1
LT5ocGxsX2ZyZXEgPSB2bHZfZ2V0X2hwbGxfdmNvKGk5MTUpOwo+ICAgCj4gLQlocGxsID0gdmx2
X2dldF9jY2tfY2xvY2soZGV2X3ByaXYsIG5hbWUsIHJlZywgZGV2X3ByaXYtPmhwbGxfZnJlcSk7
Cj4gKwlocGxsID0gdmx2X2dldF9jY2tfY2xvY2soaTkxNSwgbmFtZSwgcmVnLCBpOTE1LT5ocGxs
X2ZyZXEpOwo+ICAgCj4gLQl2bHZfY2NrX3B1dChkZXZfcHJpdik7Cj4gKwl2bHZfY2NrX3B1dChp
OTE1KTsKPiAgIAo+ICAgCXJldHVybiBocGxsOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGlu
dGVsX3VwZGF0ZV9jemNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0
YXRpYyB2b2lkIGludGVsX3VwZGF0ZV9jemNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiAgIHsKPiAtCWlmICghKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJ
RVcoZGV2X3ByaXYpKSkKPiArCWlmICghKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZ
VklFVyhpOTE1KSkpCj4gICAJCXJldHVybjsKPiAgIAo+IC0JZGV2X3ByaXYtPmN6Y2xrX2ZyZXEg
PSB2bHZfZ2V0X2Nja19jbG9ja19ocGxsKGRldl9wcml2LCAiY3pjbGsiLAo+ICsJaTkxNS0+Y3pj
bGtfZnJlcSA9IHZsdl9nZXRfY2NrX2Nsb2NrX2hwbGwoaTkxNSwgImN6Y2xrIiwKPiAgIAkJCQkJ
CSAgICAgIENDS19DWl9DTE9DS19DT05UUk9MKTsKPiAgIAo+IC0JRFJNX0RFQlVHX0RSSVZFUigi
Q1ogY2xvY2sgcmF0ZTogJWQga0h6XG4iLCBkZXZfcHJpdi0+Y3pjbGtfZnJlcSk7Cj4gKwlEUk1f
REVCVUdfRFJJVkVSKCJDWiBjbG9jayByYXRlOiAlZCBrSHpcbiIsIGk5MTUtPmN6Y2xrX2ZyZXEp
Owo+ICAgfQo+ICAgCj4gICBzdGF0aWMgaW5saW5lIHUzMiAvKiB1bml0cyBvZiAxMDBNSHogKi8K
PiAtaW50ZWxfZmRpX2xpbmtfZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gK2ludGVsX2ZkaV9saW5rX2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
ICAJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gICB7
Cj4gLQlpZiAoSEFTX0RESShkZXZfcHJpdikpCj4gKwlpZiAoSEFTX0RESShpOTE1KSkKPiAgIAkJ
cmV0dXJuIHBpcGVfY29uZmlnLT5wb3J0X2Nsb2NrOyAvKiBTUExMICovCj4gICAJZWxzZQo+IC0J
CXJldHVybiBkZXZfcHJpdi0+ZmRpX3BsbF9mcmVxOwo+ICsJCXJldHVybiBpOTE1LT5mZGlfcGxs
X2ZyZXE7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaW50ZWxfbGltaXQgaW50
ZWxfbGltaXRzX2k4eHhfZGFjID0gewo+IEBAIC00ODgsNyArNDg4LDcgQEAgc3RhdGljIGNvbnN0
IHN0cnVjdCBpbnRlbF9saW1pdCBpbnRlbF9saW1pdHNfYnh0ID0gewo+ICAgCj4gICAvKiBXQSBE
aXNwbGF5ICMwODI3OiBHZW45OmFsbCAqLwo+ICAgc3RhdGljIHZvaWQKPiAtc2tsX3dhXzgyNyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCBwaXBlLCBib29sIGVuYWJsZSkK
PiArc2tsX3dhXzgyNyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50IHBpcGUsIGJv
b2wgZW5hYmxlKQo+ICAgewo+ICAgCWlmIChlbmFibGUpCj4gICAJCUk5MTVfV1JJVEUoQ0xLR0FU
RV9ESVNfUFNMKHBpcGUpLAo+IEBAIC01MDIsNyArNTAyLDcgQEAgc2tsX3dhXzgyNyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCBwaXBlLCBib29sIGVuYWJsZSkKPiAgIAo+
ICAgLyogV2FfMjAwNjYwNDMxMjppY2wgKi8KPiAgIHN0YXRpYyB2b2lkCj4gLWljbF93YV9zY2Fs
ZXJjbGtnYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUg
cGlwZSwKPiAraWNsX3dhX3NjYWxlcmNsa2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwgZW51bSBwaXBlIHBpcGUsCj4gICAJCSAgICAgICBib29sIGVuYWJsZSkKPiAgIHsKPiAg
IAlpZiAoZW5hYmxlKQo+IEBAIC01ODgsNyArNTg4LDcgQEAgaW50IGNodl9jYWxjX2RwbGxfcGFy
YW1zKGludCByZWZjbGssIHN0cnVjdCBkcGxsICpjbG9jaykKPiAgICAqIFJldHVybnMgd2hldGhl
ciB0aGUgZ2l2ZW4gc2V0IG9mIGRpdmlzb3JzIGFyZSB2YWxpZCBmb3IgYSBnaXZlbiByZWZjbGsg
d2l0aAo+ICAgICogdGhlIGdpdmVuIGNvbm5lY3RvcnMuCj4gICAgKi8KPiAtc3RhdGljIGJvb2wg
aW50ZWxfUExMX2lzX3ZhbGlkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAr
c3RhdGljIGJvb2wgaW50ZWxfUExMX2lzX3ZhbGlkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ICAgCQkJICAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9saW1pdCAqbGltaXQsCj4gICAJ
CQkgICAgICAgY29uc3Qgc3RydWN0IGRwbGwgKmNsb2NrKQo+ICAgewo+IEBAIC02MDEsMTMgKzYw
MSwxMyBAQCBzdGF0aWMgYm9vbCBpbnRlbF9QTExfaXNfdmFsaWQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ICAgCWlmIChjbG9jay0+bTEgIDwgbGltaXQtPm0xLm1pbiAgfHwg
bGltaXQtPm0xLm1heCAgPCBjbG9jay0+bTEpCj4gICAJCUlOVEVMUGxsSW52YWxpZCgibTEgb3V0
IG9mIHJhbmdlXG4iKTsKPiAgIAo+IC0JaWYgKCFJU19QSU5FVklFVyhkZXZfcHJpdikgJiYgIUlT
X1ZBTExFWVZJRVcoZGV2X3ByaXYpICYmCj4gLQkgICAgIUlTX0NIRVJSWVZJRVcoZGV2X3ByaXYp
ICYmICFJU19HRU45X0xQKGRldl9wcml2KSkKPiArCWlmICghSVNfUElORVZJRVcoaTkxNSkgJiYg
IUlTX1ZBTExFWVZJRVcoaTkxNSkgJiYKPiArCSAgICAhSVNfQ0hFUlJZVklFVyhpOTE1KSAmJiAh
SVNfR0VOOV9MUChpOTE1KSkKPiAgIAkJaWYgKGNsb2NrLT5tMSA8PSBjbG9jay0+bTIpCj4gICAJ
CQlJTlRFTFBsbEludmFsaWQoIm0xIDw9IG0yXG4iKTsKPiAgIAo+IC0JaWYgKCFJU19WQUxMRVlW
SUVXKGRldl9wcml2KSAmJiAhSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikgJiYKPiAtCSAgICAhSVNf
R0VOOV9MUChkZXZfcHJpdikpIHsKPiArCWlmICghSVNfVkFMTEVZVklFVyhpOTE1KSAmJiAhSVNf
Q0hFUlJZVklFVyhpOTE1KSAmJgo+ICsJICAgICFJU19HRU45X0xQKGk5MTUpKSB7Cj4gICAJCWlm
IChjbG9jay0+cCA8IGxpbWl0LT5wLm1pbiB8fCBsaW1pdC0+cC5tYXggPCBjbG9jay0+cCkKPiAg
IAkJCUlOVEVMUGxsSW52YWxpZCgicCBvdXQgb2YgcmFuZ2VcbiIpOwo+ICAgCQlpZiAoY2xvY2st
Pm0gPCBsaW1pdC0+bS5taW4gfHwgbGltaXQtPm0ubWF4IDwgY2xvY2stPm0pCj4gQEAgLTYzMCw3
ICs2MzAsNyBAQCBpOXh4X3NlbGVjdF9wMl9kaXYoY29uc3Qgc3RydWN0IGludGVsX2xpbWl0ICps
aW1pdCwKPiAgIAkJICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
Cj4gICAJCSAgIGludCB0YXJnZXQpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMt
PmRldik7Cj4gICAKPiAgIAlpZiAoaW50ZWxfY3J0Y19oYXNfdHlwZShjcnRjX3N0YXRlLCBJTlRF
TF9PVVRQVVRfTFZEUykpIHsKPiAgIAkJLyoKPiBAQCAtNjM4LDcgKzYzOCw3IEBAIGk5eHhfc2Vs
ZWN0X3AyX2Rpdihjb25zdCBzdHJ1Y3QgaW50ZWxfbGltaXQgKmxpbWl0LAo+ICAgCQkgKiBXZSBo
YXZlbid0IGZpZ3VyZWQgb3V0IGhvdyB0byByZWxpYWJseSBzZXQgdXAgZGlmZmVyZW50Cj4gICAJ
CSAqIHNpbmdsZS9kdWFsIGNoYW5uZWwgc3RhdGUsIGlmIHdlIGV2ZW4gY2FuLgo+ICAgCQkgKi8K
PiAtCQlpZiAoaW50ZWxfaXNfZHVhbF9saW5rX2x2ZHMoZGV2X3ByaXYpKQo+ICsJCWlmIChpbnRl
bF9pc19kdWFsX2xpbmtfbHZkcyhpOTE1KSkKPiAgIAkJCXJldHVybiBsaW1pdC0+cDIucDJfZmFz
dDsKPiAgIAkJZWxzZQo+ICAgCQkJcmV0dXJuIGxpbWl0LT5wMi5wMl9zbG93Owo+IEBAIC0xMDE2
LDIyICsxMDE2LDIyIEBAIGJvb2wgaW50ZWxfY3J0Y19hY3RpdmUoc3RydWN0IGludGVsX2NydGMg
KmNydGMpCj4gICAJCWNydGMtPmNvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2s7
Cj4gICB9Cj4gICAKPiAtZW51bSB0cmFuc2NvZGVyIGludGVsX3BpcGVfdG9fY3B1X3RyYW5zY29k
ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtlbnVtIHRyYW5zY29kZXIg
aW50ZWxfcGlwZV90b19jcHVfdHJhbnNjb2RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiAgIAkJCQkJICAgICBlbnVtIHBpcGUgcGlwZSkKPiAgIHsKPiAtCXN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIHBpcGUpOwo+ICsJ
c3RydWN0IGludGVsX2NydGMgKmNydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShpOTE1LCBw
aXBlKTsKPiAgIAo+ICAgCXJldHVybiBjcnRjLT5jb25maWctPmNwdV90cmFuc2NvZGVyOwo+ICAg
fQo+ICAgCj4gLXN0YXRpYyBib29sIHBpcGVfc2NhbmxpbmVfaXNfbW92aW5nKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIGJvb2wgcGlwZV9zY2FubGluZV9pc19t
b3Zpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgIGVudW0gcGlw
ZSBwaXBlKQo+ICAgewo+ICAgCWk5MTVfcmVnX3QgcmVnID0gUElQRURTTChwaXBlKTsKPiAgIAl1
MzIgbGluZTEsIGxpbmUyOwo+ICAgCXUzMiBsaW5lX21hc2s7Cj4gICAKPiAtCWlmIChJU19HRU4o
ZGV2X3ByaXYsIDIpKQo+ICsJaWYgKElTX0dFTihpOTE1LCAyKSkKPiAgIAkJbGluZV9tYXNrID0g
RFNMX0xJTkVNQVNLX0dFTjI7Cj4gICAJZWxzZQo+ICAgCQlsaW5lX21hc2sgPSBEU0xfTElORU1B
U0tfR0VOMzsKPiBAQCAtMTA0NSwxMSArMTA0NSwxMSBAQCBzdGF0aWMgYm9vbCBwaXBlX3NjYW5s
aW5lX2lzX21vdmluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAKPiAg
IHN0YXRpYyB2b2lkIHdhaXRfZm9yX3BpcGVfc2NhbmxpbmVfbW92aW5nKHN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjLCBib29sIHN0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAgCWVudW0gcGlwZSBw
aXBlID0gY3J0Yy0+cGlwZTsKPiAgIAo+ICAgCS8qIFdhaXQgZm9yIHRoZSBkaXNwbGF5IGxpbmUg
dG8gc2V0dGxlL3N0YXJ0IG1vdmluZyAqLwo+IC0JaWYgKHdhaXRfZm9yKHBpcGVfc2NhbmxpbmVf
aXNfbW92aW5nKGRldl9wcml2LCBwaXBlKSA9PSBzdGF0ZSwgMTAwKSkKPiArCWlmICh3YWl0X2Zv
cihwaXBlX3NjYW5saW5lX2lzX21vdmluZyhpOTE1LCBwaXBlKSA9PSBzdGF0ZSwgMTAwKSkKPiAg
IAkJRFJNX0VSUk9SKCJwaXBlICVjIHNjYW5saW5lICVzIHdhaXQgdGltZWQgb3V0XG4iLAo+ICAg
CQkJICBwaXBlX25hbWUocGlwZSksIG9ub2ZmKHN0YXRlKSk7Cj4gICB9Cj4gQEAgLTEwNjgsMTQg
KzEwNjgsMTQgQEAgc3RhdGljIHZvaWQKPiAgIGludGVsX3dhaXRfZm9yX3BpcGVfb2ZmKGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMob2xkX2NydGNfc3RhdGUtPmJhc2Uu
Y3J0Yyk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNy
dGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShjcnRjLT5iYXNlLmRldik7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDQp
IHsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNCkgewo+ICAgCQllbnVtIHRyYW5zY29kZXIg
Y3B1X3RyYW5zY29kZXIgPSBvbGRfY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXI7Cj4gICAJCWk5
MTVfcmVnX3QgcmVnID0gUElQRUNPTkYoY3B1X3RyYW5zY29kZXIpOwo+ICAgCj4gICAJCS8qIFdh
aXQgZm9yIHRoZSBQaXBlIFN0YXRlIHRvIGdvIG9mZiAqLwo+IC0JCWlmIChpbnRlbF93YWl0X2Zv
cl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwKPiArCQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVn
aXN0ZXIoJmk5MTUtPnVuY29yZSwKPiAgIAkJCQkJICAgIHJlZywgSTk2NV9QSVBFQ09ORl9BQ1RJ
VkUsIDAsCj4gICAJCQkJCSAgICAxMDApKQo+ICAgCQkJV0FSTigxLCAicGlwZV9vZmYgd2FpdCB0
aW1lZCBvdXRcbiIpOwo+IEBAIC0xMDg1LDcgKzEwODUsNyBAQCBpbnRlbF93YWl0X2Zvcl9waXBl
X29mZihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUpCj4gICB9
Cj4gICAKPiAgIC8qIE9ubHkgZm9yIHByZS1JTEsgY29uZmlncyAqLwo+IC12b2lkIGFzc2VydF9w
bGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICt2b2lkIGFzc2VydF9wbGwo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCWVudW0gcGlwZSBwaXBlLCBib29s
IHN0YXRlKQo+ICAgewo+ICAgCXUzMiB2YWw7Cj4gQEAgLTEwOTksMTQgKzEwOTksMTQgQEAgdm9p
ZCBhc3NlcnRfcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIH0KPiAg
IAo+ICAgLyogWFhYOiB0aGUgZHNpIHBsbCBpcyBzaGFyZWQgYmV0d2VlbiBNSVBJIERTSSBwb3J0
cyAqLwo+IC12b2lkIGFzc2VydF9kc2lfcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwgYm9vbCBzdGF0ZSkKPiArdm9pZCBhc3NlcnRfZHNpX3BsbChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwgYm9vbCBzdGF0ZSkKPiAgIHsKPiAgIAl1MzIgdmFsOwo+ICAgCWJvb2wg
Y3VyX3N0YXRlOwo+ICAgCj4gLQl2bHZfY2NrX2dldChkZXZfcHJpdik7Cj4gLQl2YWwgPSB2bHZf
Y2NrX3JlYWQoZGV2X3ByaXYsIENDS19SRUdfRFNJX1BMTF9DT05UUk9MKTsKPiAtCXZsdl9jY2tf
cHV0KGRldl9wcml2KTsKPiArCXZsdl9jY2tfZ2V0KGk5MTUpOwo+ICsJdmFsID0gdmx2X2Nja19y
ZWFkKGk5MTUsIENDS19SRUdfRFNJX1BMTF9DT05UUk9MKTsKPiArCXZsdl9jY2tfcHV0KGk5MTUp
Owo+ICAgCj4gICAJY3VyX3N0YXRlID0gdmFsICYgRFNJX1BMTF9WQ09fRU47Cj4gICAJSTkxNV9T
VEFURV9XQVJOKGN1cl9zdGF0ZSAhPSBzdGF0ZSwKPiBAQCAtMTExNCwxNCArMTExNCwxNCBAQCB2
b2lkIGFzc2VydF9kc2lfcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgYm9v
bCBzdGF0ZSkKPiAgIAkJCW9ub2ZmKHN0YXRlKSwgb25vZmYoY3VyX3N0YXRlKSk7Cj4gICB9Cj4g
ICAKPiAtc3RhdGljIHZvaWQgYXNzZXJ0X2ZkaV90eChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGFzc2VydF9mZGlfdHgoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gICAJCQkgIGVudW0gcGlwZSBwaXBlLCBib29sIHN0YXRlKQo+ICAgewo+
ICAgCWJvb2wgY3VyX3N0YXRlOwo+IC0JZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0g
aW50ZWxfcGlwZV90b19jcHVfdHJhbnNjb2RlcihkZXZfcHJpdiwKPiArCWVudW0gdHJhbnNjb2Rl
ciBjcHVfdHJhbnNjb2RlciA9IGludGVsX3BpcGVfdG9fY3B1X3RyYW5zY29kZXIoaTkxNSwKPiAg
IAkJCQkJCQkJICAgICAgcGlwZSk7Cj4gICAKPiAtCWlmIChIQVNfRERJKGRldl9wcml2KSkgewo+
ICsJaWYgKEhBU19EREkoaTkxNSkpIHsKPiAgIAkJLyogRERJIGRvZXMgbm90IGhhdmUgYSBzcGVj
aWZpYyBGRElfVFggcmVnaXN0ZXIgKi8KPiAgIAkJdTMyIHZhbCA9IEk5MTVfUkVBRChUUkFOU19E
RElfRlVOQ19DVEwoY3B1X3RyYW5zY29kZXIpKTsKPiAgIAkJY3VyX3N0YXRlID0gISEodmFsICYg
VFJBTlNfRERJX0ZVTkNfRU5BQkxFKTsKPiBAQCAtMTEzNiw3ICsxMTM2LDcgQEAgc3RhdGljIHZv
aWQgYXNzZXJ0X2ZkaV90eChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAj
ZGVmaW5lIGFzc2VydF9mZGlfdHhfZW5hYmxlZChkLCBwKSBhc3NlcnRfZmRpX3R4KGQsIHAsIHRy
dWUpCj4gICAjZGVmaW5lIGFzc2VydF9mZGlfdHhfZGlzYWJsZWQoZCwgcCkgYXNzZXJ0X2ZkaV90
eChkLCBwLCBmYWxzZSkKPiAgIAo+IC1zdGF0aWMgdm9pZCBhc3NlcnRfZmRpX3J4KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgYXNzZXJ0X2ZkaV9yeChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgZW51bSBwaXBlIHBpcGUsIGJv
b2wgc3RhdGUpCj4gICB7Cj4gICAJdTMyIHZhbDsKPiBAQCAtMTE1MSwyNCArMTE1MSwyNCBAQCBz
dGF0aWMgdm9pZCBhc3NlcnRfZmRpX3J4KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiAgICNkZWZpbmUgYXNzZXJ0X2ZkaV9yeF9lbmFibGVkKGQsIHApIGFzc2VydF9mZGlfcngo
ZCwgcCwgdHJ1ZSkKPiAgICNkZWZpbmUgYXNzZXJ0X2ZkaV9yeF9kaXNhYmxlZChkLCBwKSBhc3Nl
cnRfZmRpX3J4KGQsIHAsIGZhbHNlKQo+ICAgCj4gLXN0YXRpYyB2b2lkIGFzc2VydF9mZGlfdHhf
cGxsX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMg
dm9pZCBhc3NlcnRfZmRpX3R4X3BsbF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ICAgCQkJCSAgICAgIGVudW0gcGlwZSBwaXBlKQo+ICAgewo+ICAgCXUzMiB2YWw7Cj4g
ICAKPiAgIAkvKiBJTEsgRkRJIFBMTCBpcyBhbHdheXMgZW5hYmxlZCAqLwo+IC0JaWYgKElTX0dF
TihkZXZfcHJpdiwgNSkpCj4gKwlpZiAoSVNfR0VOKGk5MTUsIDUpKQo+ICAgCQlyZXR1cm47Cj4g
ICAKPiAgIAkvKiBPbiBIYXN3ZWxsLCBEREkgcG9ydHMgYXJlIHJlc3BvbnNpYmxlIGZvciB0aGUg
RkRJIFBMTCBzZXR1cCAqLwo+IC0JaWYgKEhBU19EREkoZGV2X3ByaXYpKQo+ICsJaWYgKEhBU19E
REkoaTkxNSkpCj4gICAJCXJldHVybjsKPiAgIAo+ICAgCXZhbCA9IEk5MTVfUkVBRChGRElfVFhf
Q1RMKHBpcGUpKTsKPiAgIAlJOTE1X1NUQVRFX1dBUk4oISh2YWwgJiBGRElfVFhfUExMX0VOQUJM
RSksICJGREkgVFggUExMIGFzc2VydGlvbiBmYWlsdXJlLCBzaG91bGQgYmUgYWN0aXZlIGJ1dCBp
cyBkaXNhYmxlZFxuIik7Cj4gICB9Cj4gICAKPiAtdm9pZCBhc3NlcnRfZmRpX3J4X3BsbChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3ZvaWQgYXNzZXJ0X2ZkaV9yeF9wbGwo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCSAgICAgICBlbnVtIHBpcGUgcGlw
ZSwgYm9vbCBzdGF0ZSkKPiAgIHsKPiAgIAl1MzIgdmFsOwo+IEBAIC0xMTgxLDE3ICsxMTgxLDE3
IEBAIHZvaWQgYXNzZXJ0X2ZkaV9yeF9wbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ICAgCQkJb25vZmYoc3RhdGUpLCBvbm9mZihjdXJfc3RhdGUpKTsKPiAgIH0KPiAgIAo+
IC12b2lkIGFzc2VydF9wYW5lbF91bmxvY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsIGVudW0gcGlwZSBwaXBlKQo+ICt2b2lkIGFzc2VydF9wYW5lbF91bmxvY2tlZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBwaXBlIHBpcGUpCj4gICB7Cj4gICAJaTkx
NV9yZWdfdCBwcF9yZWc7Cj4gICAJdTMyIHZhbDsKPiAgIAllbnVtIHBpcGUgcGFuZWxfcGlwZSA9
IElOVkFMSURfUElQRTsKPiAgIAlib29sIGxvY2tlZCA9IHRydWU7Cj4gICAKPiAtCWlmIChXQVJO
X09OKEhBU19EREkoZGV2X3ByaXYpKSkKPiArCWlmIChXQVJOX09OKEhBU19EREkoaTkxNSkpKQo+
ICAgCQlyZXR1cm47Cj4gICAKPiAtCWlmIChIQVNfUENIX1NQTElUKGRldl9wcml2KSkgewo+ICsJ
aWYgKEhBU19QQ0hfU1BMSVQoaTkxNSkpIHsKPiAgIAkJdTMyIHBvcnRfc2VsOwo+ICAgCj4gICAJ
CXBwX3JlZyA9IFBQX0NPTlRST0woMCk7Cj4gQEAgLTExOTksMjIgKzExOTksMjIgQEAgdm9pZCBh
c3NlcnRfcGFuZWxfdW5sb2NrZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBl
bnVtIHBpcGUgcGlwZSkKPiAgIAo+ICAgCQlzd2l0Y2ggKHBvcnRfc2VsKSB7Cj4gICAJCWNhc2Ug
UEFORUxfUE9SVF9TRUxFQ1RfTFZEUzoKPiAtCQkJaW50ZWxfbHZkc19wb3J0X2VuYWJsZWQoZGV2
X3ByaXYsIFBDSF9MVkRTLCAmcGFuZWxfcGlwZSk7Cj4gKwkJCWludGVsX2x2ZHNfcG9ydF9lbmFi
bGVkKGk5MTUsIFBDSF9MVkRTLCAmcGFuZWxfcGlwZSk7Cj4gICAJCQlicmVhazsKPiAgIAkJY2Fz
ZSBQQU5FTF9QT1JUX1NFTEVDVF9EUEE6Cj4gLQkJCWludGVsX2RwX3BvcnRfZW5hYmxlZChkZXZf
cHJpdiwgRFBfQSwgUE9SVF9BLCAmcGFuZWxfcGlwZSk7Cj4gKwkJCWludGVsX2RwX3BvcnRfZW5h
YmxlZChpOTE1LCBEUF9BLCBQT1JUX0EsICZwYW5lbF9waXBlKTsKPiAgIAkJCWJyZWFrOwo+ICAg
CQljYXNlIFBBTkVMX1BPUlRfU0VMRUNUX0RQQzoKPiAtCQkJaW50ZWxfZHBfcG9ydF9lbmFibGVk
KGRldl9wcml2LCBQQ0hfRFBfQywgUE9SVF9DLCAmcGFuZWxfcGlwZSk7Cj4gKwkJCWludGVsX2Rw
X3BvcnRfZW5hYmxlZChpOTE1LCBQQ0hfRFBfQywgUE9SVF9DLCAmcGFuZWxfcGlwZSk7Cj4gICAJ
CQlicmVhazsKPiAgIAkJY2FzZSBQQU5FTF9QT1JUX1NFTEVDVF9EUEQ6Cj4gLQkJCWludGVsX2Rw
X3BvcnRfZW5hYmxlZChkZXZfcHJpdiwgUENIX0RQX0QsIFBPUlRfRCwgJnBhbmVsX3BpcGUpOwo+
ICsJCQlpbnRlbF9kcF9wb3J0X2VuYWJsZWQoaTkxNSwgUENIX0RQX0QsIFBPUlRfRCwgJnBhbmVs
X3BpcGUpOwo+ICAgCQkJYnJlYWs7Cj4gICAJCWRlZmF1bHQ6Cj4gICAJCQlNSVNTSU5HX0NBU0Uo
cG9ydF9zZWwpOwo+ICAgCQkJYnJlYWs7Cj4gICAJCX0KPiAtCX0gZWxzZSBpZiAoSVNfVkFMTEVZ
VklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBp
ZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gICAJCS8q
IHByZXN1bWFibHkgd3JpdGUgbG9jayBkZXBlbmRzIG9uIHBpcGUsIG5vdCBwb3J0IHNlbGVjdCAq
Lwo+ICAgCQlwcF9yZWcgPSBQUF9DT05UUk9MKHBpcGUpOwo+ICAgCQlwYW5lbF9waXBlID0gcGlw
ZTsKPiBAQCAtMTIyNSw3ICsxMjI1LDcgQEAgdm9pZCBhc3NlcnRfcGFuZWxfdW5sb2NrZWQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUgcGlwZSkKPiAgIAkJcG9y
dF9zZWwgPSBJOTE1X1JFQUQoUFBfT05fREVMQVlTKDApKSAmIFBBTkVMX1BPUlRfU0VMRUNUX01B
U0s7Cj4gICAKPiAgIAkJV0FSTl9PTihwb3J0X3NlbCAhPSBQQU5FTF9QT1JUX1NFTEVDVF9MVkRT
KTsKPiAtCQlpbnRlbF9sdmRzX3BvcnRfZW5hYmxlZChkZXZfcHJpdiwgTFZEUywgJnBhbmVsX3Bp
cGUpOwo+ICsJCWludGVsX2x2ZHNfcG9ydF9lbmFibGVkKGk5MTUsIExWRFMsICZwYW5lbF9waXBl
KTsKPiAgIAl9Cj4gICAKPiAgIAl2YWwgPSBJOTE1X1JFQUQocHBfcmVnKTsKPiBAQCAtMTIzOCwy
NiArMTIzOCwyNiBAQCB2b2lkIGFzc2VydF9wYW5lbF91bmxvY2tlZChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlwZSBwaXBlKQo+ICAgCSAgICAgcGlwZV9uYW1lKHBp
cGUpKTsKPiAgIH0KPiAgIAo+IC12b2lkIGFzc2VydF9waXBlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiArdm9pZCBhc3NlcnRfcGlwZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwKPiAgIAkJIGVudW0gcGlwZSBwaXBlLCBib29sIHN0YXRlKQo+ICAgewo+ICAgCWJv
b2wgY3VyX3N0YXRlOwo+IC0JZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0gaW50ZWxf
cGlwZV90b19jcHVfdHJhbnNjb2RlcihkZXZfcHJpdiwKPiArCWVudW0gdHJhbnNjb2RlciBjcHVf
dHJhbnNjb2RlciA9IGludGVsX3BpcGVfdG9fY3B1X3RyYW5zY29kZXIoaTkxNSwKPiAgIAkJCQkJ
CQkJICAgICAgcGlwZSk7Cj4gICAJZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBwb3dl
cl9kb21haW47Cj4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gICAKPiAgIAkvKiB3ZSBr
ZWVwIGJvdGggcGlwZXMgZW5hYmxlZCBvbiA4MzAgKi8KPiAtCWlmIChJU19JODMwKGRldl9wcml2
KSkKPiArCWlmIChJU19JODMwKGk5MTUpKQo+ICAgCQlzdGF0ZSA9IHRydWU7Cj4gICAKPiAgIAlw
b3dlcl9kb21haW4gPSBQT1dFUl9ET01BSU5fVFJBTlNDT0RFUihjcHVfdHJhbnNjb2Rlcik7Cj4g
LQl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChkZXZfcHJpdiwg
cG93ZXJfZG9tYWluKTsKPiArCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9l
bmFibGVkKGk5MTUsIHBvd2VyX2RvbWFpbik7Cj4gICAJaWYgKHdha2VyZWYpIHsKPiAgIAkJdTMy
IHZhbCA9IEk5MTVfUkVBRChQSVBFQ09ORihjcHVfdHJhbnNjb2RlcikpOwo+ICAgCQljdXJfc3Rh
dGUgPSAhISh2YWwgJiBQSVBFQ09ORl9FTkFCTEUpOwo+ICAgCj4gLQkJaW50ZWxfZGlzcGxheV9w
b3dlcl9wdXQoZGV2X3ByaXYsIHBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gKwkJaW50ZWxfZGlz
cGxheV9wb3dlcl9wdXQoaTkxNSwgcG93ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiAgIAl9IGVsc2Ug
ewo+ICAgCQljdXJfc3RhdGUgPSBmYWxzZTsKPiAgIAl9Cj4gQEAgLTEyODQsMTAgKzEyODQsMTAg
QEAgc3RhdGljIHZvaWQgYXNzZXJ0X3BsYW5lKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsIGJv
b2wgc3RhdGUpCj4gICAKPiAgIHN0YXRpYyB2b2lkIGFzc2VydF9wbGFuZXNfZGlzYWJsZWQoc3Ry
dWN0IGludGVsX2NydGMgKmNydGMpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVs
X3BsYW5lICpwbGFuZTsKPiAgIAo+IC0JZm9yX2VhY2hfaW50ZWxfcGxhbmVfb25fY3J0YygmZGV2
X3ByaXYtPmRybSwgY3J0YywgcGxhbmUpCj4gKwlmb3JfZWFjaF9pbnRlbF9wbGFuZV9vbl9jcnRj
KCZpOTE1LT5kcm0sIGNydGMsIHBsYW5lKQo+ICAgCQlhc3NlcnRfcGxhbmVfZGlzYWJsZWQocGxh
bmUpOwo+ICAgfQo+ICAgCj4gQEAgLTEyOTcsNyArMTI5Nyw3IEBAIHN0YXRpYyB2b2lkIGFzc2Vy
dF92YmxhbmtfZGlzYWJsZWQoc3RydWN0IGRybV9jcnRjICpjcnRjKQo+ICAgCQlkcm1fY3J0Y192
YmxhbmtfcHV0KGNydGMpOwo+ICAgfQo+ICAgCj4gLXZvaWQgYXNzZXJ0X3BjaF90cmFuc2NvZGVy
X2Rpc2FibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArdm9pZCBhc3Nl
cnRfcGNoX3RyYW5zY29kZXJfZGlzYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gICAJCQkJICAgIGVudW0gcGlwZSBwaXBlKQo+ICAgewo+ICAgCXUzMiB2YWw7Cj4gQEAgLTEz
MTAsNzggKzEzMTAsNzggQEAgdm9pZCBhc3NlcnRfcGNoX3RyYW5zY29kZXJfZGlzYWJsZWQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCSAgICAgcGlwZV9uYW1lKHBpcGUp
KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBhc3NlcnRfcGNoX2RwX2Rpc2FibGVkKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgYXNzZXJ0X3BjaF9k
cF9kaXNhYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICBlbnVt
IHBpcGUgcGlwZSwgZW51bSBwb3J0IHBvcnQsCj4gICAJCQkJICAgaTkxNV9yZWdfdCBkcF9yZWcp
Cj4gICB7Cj4gICAJZW51bSBwaXBlIHBvcnRfcGlwZTsKPiAgIAlib29sIHN0YXRlOwo+ICAgCj4g
LQlzdGF0ZSA9IGludGVsX2RwX3BvcnRfZW5hYmxlZChkZXZfcHJpdiwgZHBfcmVnLCBwb3J0LCAm
cG9ydF9waXBlKTsKPiArCXN0YXRlID0gaW50ZWxfZHBfcG9ydF9lbmFibGVkKGk5MTUsIGRwX3Jl
ZywgcG9ydCwgJnBvcnRfcGlwZSk7Cj4gICAKPiAgIAlJOTE1X1NUQVRFX1dBUk4oc3RhdGUgJiYg
cG9ydF9waXBlID09IHBpcGUsCj4gICAJCQkiUENIIERQICVjIGVuYWJsZWQgb24gdHJhbnNjb2Rl
ciAlYywgc2hvdWxkIGJlIGRpc2FibGVkXG4iLAo+ICAgCQkJcG9ydF9uYW1lKHBvcnQpLCBwaXBl
X25hbWUocGlwZSkpOwo+ICAgCj4gLQlJOTE1X1NUQVRFX1dBUk4oSEFTX1BDSF9JQlgoZGV2X3By
aXYpICYmICFzdGF0ZSAmJiBwb3J0X3BpcGUgPT0gUElQRV9CLAo+ICsJSTkxNV9TVEFURV9XQVJO
KEhBU19QQ0hfSUJYKGk5MTUpICYmICFzdGF0ZSAmJiBwb3J0X3BpcGUgPT0gUElQRV9CLAo+ICAg
CQkJIklCWCBQQ0ggRFAgJWMgc3RpbGwgdXNpbmcgdHJhbnNjb2RlciBCXG4iLAo+ICAgCQkJcG9y
dF9uYW1lKHBvcnQpKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBhc3NlcnRfcGNoX2hkbWlf
ZGlzYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9p
ZCBhc3NlcnRfcGNoX2hkbWlfZGlzYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gICAJCQkJICAgICBlbnVtIHBpcGUgcGlwZSwgZW51bSBwb3J0IHBvcnQsCj4gICAJCQkJICAg
ICBpOTE1X3JlZ190IGhkbWlfcmVnKQo+ICAgewo+ICAgCWVudW0gcGlwZSBwb3J0X3BpcGU7Cj4g
ICAJYm9vbCBzdGF0ZTsKPiAgIAo+IC0Jc3RhdGUgPSBpbnRlbF9zZHZvX3BvcnRfZW5hYmxlZChk
ZXZfcHJpdiwgaGRtaV9yZWcsICZwb3J0X3BpcGUpOwo+ICsJc3RhdGUgPSBpbnRlbF9zZHZvX3Bv
cnRfZW5hYmxlZChpOTE1LCBoZG1pX3JlZywgJnBvcnRfcGlwZSk7Cj4gICAKPiAgIAlJOTE1X1NU
QVRFX1dBUk4oc3RhdGUgJiYgcG9ydF9waXBlID09IHBpcGUsCj4gICAJCQkiUENIIEhETUkgJWMg
ZW5hYmxlZCBvbiB0cmFuc2NvZGVyICVjLCBzaG91bGQgYmUgZGlzYWJsZWRcbiIsCj4gICAJCQlw
b3J0X25hbWUocG9ydCksIHBpcGVfbmFtZShwaXBlKSk7Cj4gICAKPiAtCUk5MTVfU1RBVEVfV0FS
TihIQVNfUENIX0lCWChkZXZfcHJpdikgJiYgIXN0YXRlICYmIHBvcnRfcGlwZSA9PSBQSVBFX0Is
Cj4gKwlJOTE1X1NUQVRFX1dBUk4oSEFTX1BDSF9JQlgoaTkxNSkgJiYgIXN0YXRlICYmIHBvcnRf
cGlwZSA9PSBQSVBFX0IsCj4gICAJCQkiSUJYIFBDSCBIRE1JICVjIHN0aWxsIHVzaW5nIHRyYW5z
Y29kZXIgQlxuIiwKPiAgIAkJCXBvcnRfbmFtZShwb3J0KSk7Cj4gICB9Cj4gICAKPiAtc3RhdGlj
IHZvaWQgYXNzZXJ0X3BjaF9wb3J0c19kaXNhYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGFzc2VydF9wY2hfcG9ydHNfZGlzYWJsZWQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgICAgZW51bSBwaXBlIHBpcGUpCj4g
ICB7Cj4gICAJZW51bSBwaXBlIHBvcnRfcGlwZTsKPiAgIAo+IC0JYXNzZXJ0X3BjaF9kcF9kaXNh
YmxlZChkZXZfcHJpdiwgcGlwZSwgUE9SVF9CLCBQQ0hfRFBfQik7Cj4gLQlhc3NlcnRfcGNoX2Rw
X2Rpc2FibGVkKGRldl9wcml2LCBwaXBlLCBQT1JUX0MsIFBDSF9EUF9DKTsKPiAtCWFzc2VydF9w
Y2hfZHBfZGlzYWJsZWQoZGV2X3ByaXYsIHBpcGUsIFBPUlRfRCwgUENIX0RQX0QpOwo+ICsJYXNz
ZXJ0X3BjaF9kcF9kaXNhYmxlZChpOTE1LCBwaXBlLCBQT1JUX0IsIFBDSF9EUF9CKTsKPiArCWFz
c2VydF9wY2hfZHBfZGlzYWJsZWQoaTkxNSwgcGlwZSwgUE9SVF9DLCBQQ0hfRFBfQyk7Cj4gKwlh
c3NlcnRfcGNoX2RwX2Rpc2FibGVkKGk5MTUsIHBpcGUsIFBPUlRfRCwgUENIX0RQX0QpOwo+ICAg
Cj4gLQlJOTE1X1NUQVRFX1dBUk4oaW50ZWxfY3J0X3BvcnRfZW5hYmxlZChkZXZfcHJpdiwgUENI
X0FEUEEsICZwb3J0X3BpcGUpICYmCj4gKwlJOTE1X1NUQVRFX1dBUk4oaW50ZWxfY3J0X3BvcnRf
ZW5hYmxlZChpOTE1LCBQQ0hfQURQQSwgJnBvcnRfcGlwZSkgJiYKPiAgIAkJCXBvcnRfcGlwZSA9
PSBwaXBlLAo+ICAgCQkJIlBDSCBWR0EgZW5hYmxlZCBvbiB0cmFuc2NvZGVyICVjLCBzaG91bGQg
YmUgZGlzYWJsZWRcbiIsCj4gICAJCQlwaXBlX25hbWUocGlwZSkpOwo+ICAgCj4gLQlJOTE1X1NU
QVRFX1dBUk4oaW50ZWxfbHZkc19wb3J0X2VuYWJsZWQoZGV2X3ByaXYsIFBDSF9MVkRTLCAmcG9y
dF9waXBlKSAmJgo+ICsJSTkxNV9TVEFURV9XQVJOKGludGVsX2x2ZHNfcG9ydF9lbmFibGVkKGk5
MTUsIFBDSF9MVkRTLCAmcG9ydF9waXBlKSAmJgo+ICAgCQkJcG9ydF9waXBlID09IHBpcGUsCj4g
ICAJCQkiUENIIExWRFMgZW5hYmxlZCBvbiB0cmFuc2NvZGVyICVjLCBzaG91bGQgYmUgZGlzYWJs
ZWRcbiIsCj4gICAJCQlwaXBlX25hbWUocGlwZSkpOwo+ICAgCj4gICAJLyogUENIIFNEVk9CIG11
bHRpcGxleCB3aXRoIEhETUlCICovCj4gLQlhc3NlcnRfcGNoX2hkbWlfZGlzYWJsZWQoZGV2X3By
aXYsIHBpcGUsIFBPUlRfQiwgUENIX0hETUlCKTsKPiAtCWFzc2VydF9wY2hfaGRtaV9kaXNhYmxl
ZChkZXZfcHJpdiwgcGlwZSwgUE9SVF9DLCBQQ0hfSERNSUMpOwo+IC0JYXNzZXJ0X3BjaF9oZG1p
X2Rpc2FibGVkKGRldl9wcml2LCBwaXBlLCBQT1JUX0QsIFBDSF9IRE1JRCk7Cj4gKwlhc3NlcnRf
cGNoX2hkbWlfZGlzYWJsZWQoaTkxNSwgcGlwZSwgUE9SVF9CLCBQQ0hfSERNSUIpOwo+ICsJYXNz
ZXJ0X3BjaF9oZG1pX2Rpc2FibGVkKGk5MTUsIHBpcGUsIFBPUlRfQywgUENIX0hETUlDKTsKPiAr
CWFzc2VydF9wY2hfaGRtaV9kaXNhYmxlZChpOTE1LCBwaXBlLCBQT1JUX0QsIFBDSF9IRE1JRCk7
Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIF92bHZfZW5hYmxlX3BsbChzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YywKPiAgIAkJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlw
ZV9jb25maWcpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5w
aXBlOwo+ICAgCj4gICAJSTkxNV9XUklURShEUExMKHBpcGUpLCBwaXBlX2NvbmZpZy0+ZHBsbF9o
d19zdGF0ZS5kcGxsKTsKPiAgIAlQT1NUSU5HX1JFQUQoRFBMTChwaXBlKSk7Cj4gICAJdWRlbGF5
KDE1MCk7Cj4gICAKPiAtCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVu
Y29yZSwKPiArCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+ICAg
CQkJCSAgICBEUExMKHBpcGUpLAo+ICAgCQkJCSAgICBEUExMX0xPQ0tfVkxWLAo+ICAgCQkJCSAg
ICBEUExMX0xPQ0tfVkxWLAo+IEBAIC0xMzkyLDEzICsxMzkyLDEzIEBAIHN0YXRpYyB2b2lkIF92
bHZfZW5hYmxlX3BsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIHN0YXRpYyB2b2lkIHZs
dl9lbmFibGVfcGxsKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCQkJICAgY29uc3Qgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ICAgewo+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAg
CWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgIAo+IC0JYXNzZXJ0X3BpcGVfZGlzYWJs
ZWQoZGV2X3ByaXYsIHBpcGUpOwo+ICsJYXNzZXJ0X3BpcGVfZGlzYWJsZWQoaTkxNSwgcGlwZSk7
Cj4gICAKPiAgIAkvKiBQTEwgaXMgcHJvdGVjdGVkIGJ5IHBhbmVsLCBtYWtlIHN1cmUgd2UgY2Fu
IHdyaXRlIGl0ICovCj4gLQlhc3NlcnRfcGFuZWxfdW5sb2NrZWQoZGV2X3ByaXYsIHBpcGUpOwo+
ICsJYXNzZXJ0X3BhbmVsX3VubG9ja2VkKGk5MTUsIHBpcGUpOwo+ICAgCj4gICAJaWYgKHBpcGVf
Y29uZmlnLT5kcGxsX2h3X3N0YXRlLmRwbGwgJiBEUExMX1ZDT19FTkFCTEUpCj4gICAJCV92bHZf
ZW5hYmxlX3BsbChjcnRjLCBwaXBlX2NvbmZpZyk7Cj4gQEAgLTE0MTEsMTkgKzE0MTEsMTkgQEAg
c3RhdGljIHZvaWQgdmx2X2VuYWJsZV9wbGwoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gICBz
dGF0aWMgdm9pZCBfY2h2X2VuYWJsZV9wbGwoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gICAJ
CQkgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ICAgewo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNl
LmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+
YmFzZS5kZXYpOwo+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgIAllbnVtIGRw
aW9fY2hhbm5lbCBwb3J0ID0gdmx2X3BpcGVfdG9fY2hhbm5lbChwaXBlKTsKPiAgIAl1MzIgdG1w
Owo+ICAgCj4gLQl2bHZfZHBpb19nZXQoZGV2X3ByaXYpOwo+ICsJdmx2X2RwaW9fZ2V0KGk5MTUp
Owo+ICAgCj4gICAJLyogRW5hYmxlIGJhY2sgdGhlIDEwYml0IGNsb2NrIHRvIGRpc3BsYXkgY29u
dHJvbGxlciAqLwo+IC0JdG1wID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgQ0hWX0NN
Tl9EVzE0KHBvcnQpKTsKPiArCXRtcCA9IHZsdl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwgQ0hWX0NN
Tl9EVzE0KHBvcnQpKTsKPiAgIAl0bXAgfD0gRFBJT19EQ0xLUF9FTjsKPiAtCXZsdl9kcGlvX3dy
aXRlKGRldl9wcml2LCBwaXBlLCBDSFZfQ01OX0RXMTQocG9ydCksIHRtcCk7Cj4gKwl2bHZfZHBp
b193cml0ZShpOTE1LCBwaXBlLCBDSFZfQ01OX0RXMTQocG9ydCksIHRtcCk7Cj4gICAKPiAtCXZs
dl9kcGlvX3B1dChkZXZfcHJpdik7Cj4gKwl2bHZfZHBpb19wdXQoaTkxNSk7Cj4gICAKPiAgIAkv
Kgo+ICAgCSAqIE5lZWQgdG8gd2FpdCA+IDEwMG5zIGJldHdlZW4gZGNsa3AgY2xvY2sgZW5hYmxl
IGJpdCBhbmQgUExMIGVuYWJsZS4KPiBAQCAtMTQzNCw3ICsxNDM0LDcgQEAgc3RhdGljIHZvaWQg
X2Nodl9lbmFibGVfcGxsKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCUk5MTVfV1JJVEUo
RFBMTChwaXBlKSwgcGlwZV9jb25maWctPmRwbGxfaHdfc3RhdGUuZHBsbCk7Cj4gICAKPiAgIAkv
KiBDaGVjayBQTEwgaXMgbG9ja2VkICovCj4gLQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIo
JmRldl9wcml2LT51bmNvcmUsCj4gKwlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUt
PnVuY29yZSwKPiAgIAkJCQkgICAgRFBMTChwaXBlKSwgRFBMTF9MT0NLX1ZMViwgRFBMTF9MT0NL
X1ZMViwKPiAgIAkJCQkgICAgMSkpCj4gICAJCURSTV9FUlJPUigiUExMICVkIGZhaWxlZCB0byBs
b2NrXG4iLCBwaXBlKTsKPiBAQCAtMTQ0MywxMyArMTQ0MywxMyBAQCBzdGF0aWMgdm9pZCBfY2h2
X2VuYWJsZV9wbGwoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gICBzdGF0aWMgdm9pZCBjaHZf
ZW5hYmxlX3BsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAkJCSAgIGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAll
bnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gICAKPiAtCWFzc2VydF9waXBlX2Rpc2FibGVk
KGRldl9wcml2LCBwaXBlKTsKPiArCWFzc2VydF9waXBlX2Rpc2FibGVkKGk5MTUsIHBpcGUpOwo+
ICAgCj4gICAJLyogUExMIGlzIHByb3RlY3RlZCBieSBwYW5lbCwgbWFrZSBzdXJlIHdlIGNhbiB3
cml0ZSBpdCAqLwo+IC0JYXNzZXJ0X3BhbmVsX3VubG9ja2VkKGRldl9wcml2LCBwaXBlKTsKPiAr
CWFzc2VydF9wYW5lbF91bmxvY2tlZChpOTE1LCBwaXBlKTsKPiAgIAo+ICAgCWlmIChwaXBlX2Nv
bmZpZy0+ZHBsbF9od19zdGF0ZS5kcGxsICYgRFBMTF9WQ09fRU5BQkxFKQo+ICAgCQlfY2h2X2Vu
YWJsZV9wbGwoY3J0YywgcGlwZV9jb25maWcpOwo+IEBAIC0xNDY0LDcgKzE0NjQsNyBAQCBzdGF0
aWMgdm9pZCBjaHZfZW5hYmxlX3BsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAkJSTkx
NV9XUklURShDQlI0X1ZMViwgQ0JSX0RQTExCTURfUElQRShwaXBlKSk7Cj4gICAJCUk5MTVfV1JJ
VEUoRFBMTF9NRChQSVBFX0IpLCBwaXBlX2NvbmZpZy0+ZHBsbF9od19zdGF0ZS5kcGxsX21kKTsK
PiAgIAkJSTkxNV9XUklURShDQlI0X1ZMViwgMCk7Cj4gLQkJZGV2X3ByaXYtPmNodl9kcGxsX21k
W3BpcGVdID0gcGlwZV9jb25maWctPmRwbGxfaHdfc3RhdGUuZHBsbF9tZDsKPiArCQlpOTE1LT5j
aHZfZHBsbF9tZFtwaXBlXSA9IHBpcGVfY29uZmlnLT5kcGxsX2h3X3N0YXRlLmRwbGxfbWQ7Cj4g
ICAKPiAgIAkJLyoKPiAgIAkJICogRFBMTEIgVkdBIG1vZGUgYWxzbyBzZWVtcyB0byBjYXVzZSBw
cm9ibGVtcy4KPiBAQCAtMTQ3NywyNyArMTQ3NywyNyBAQCBzdGF0aWMgdm9pZCBjaHZfZW5hYmxl
X3BsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAl9Cj4gICB9Cj4gICAKPiAtc3RhdGlj
IGJvb2wgaTl4eF9oYXNfcHBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAr
c3RhdGljIGJvb2wgaTl4eF9oYXNfcHBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ICAgewo+IC0JaWYgKElTX0k4MzAoZGV2X3ByaXYpKQo+ICsJaWYgKElTX0k4MzAoaTkxNSkpCj4g
ICAJCXJldHVybiBmYWxzZTsKPiAgIAo+IC0JcmV0dXJuIElTX1BJTkVWSUVXKGRldl9wcml2KSB8
fCBJU19NT0JJTEUoZGV2X3ByaXYpOwo+ICsJcmV0dXJuIElTX1BJTkVWSUVXKGk5MTUpIHx8IElT
X01PQklMRShpOTE1KTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgaTl4eF9lbmFibGVfcGxs
KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCQkJICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAgCWk5MTVfcmVnX3Qg
cmVnID0gRFBMTChjcnRjLT5waXBlKTsKPiAgIAl1MzIgZHBsbCA9IGNydGNfc3RhdGUtPmRwbGxf
aHdfc3RhdGUuZHBsbDsKPiAgIAlpbnQgaTsKPiAgIAo+IC0JYXNzZXJ0X3BpcGVfZGlzYWJsZWQo
ZGV2X3ByaXYsIGNydGMtPnBpcGUpOwo+ICsJYXNzZXJ0X3BpcGVfZGlzYWJsZWQoaTkxNSwgY3J0
Yy0+cGlwZSk7Cj4gICAKPiAgIAkvKiBQTEwgaXMgcHJvdGVjdGVkIGJ5IHBhbmVsLCBtYWtlIHN1
cmUgd2UgY2FuIHdyaXRlIGl0ICovCj4gLQlpZiAoaTl4eF9oYXNfcHBzKGRldl9wcml2KSkKPiAt
CQlhc3NlcnRfcGFuZWxfdW5sb2NrZWQoZGV2X3ByaXYsIGNydGMtPnBpcGUpOwo+ICsJaWYgKGk5
eHhfaGFzX3BwcyhpOTE1KSkKPiArCQlhc3NlcnRfcGFuZWxfdW5sb2NrZWQoaTkxNSwgY3J0Yy0+
cGlwZSk7Cj4gICAKPiAgIAkvKgo+ICAgCSAqIEFwcGFyZW50bHkgd2UgbmVlZCB0byBoYXZlIFZH
QSBtb2RlIGVuYWJsZWQgcHJpb3IgdG8gY2hhbmdpbmcKPiBAQCAtMTUxMSw3ICsxNTExLDcgQEAg
c3RhdGljIHZvaWQgaTl4eF9lbmFibGVfcGxsKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAg
CVBPU1RJTkdfUkVBRChyZWcpOwo+ICAgCXVkZWxheSgxNTApOwo+ICAgCj4gLQlpZiAoSU5URUxf
R0VOKGRldl9wcml2KSA+PSA0KSB7Cj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDQpIHsKPiAg
IAkJSTkxNV9XUklURShEUExMX01EKGNydGMtPnBpcGUpLAo+ICAgCQkJICAgY3J0Y19zdGF0ZS0+
ZHBsbF9od19zdGF0ZS5kcGxsX21kKTsKPiAgIAl9IGVsc2Ugewo+IEBAIC0xNTM0LDI2ICsxNTM0
LDI2IEBAIHN0YXRpYyB2b2lkIGk5eHhfZW5hYmxlX3BsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YywKPiAgIHN0YXRpYyB2b2lkIGk5eHhfZGlzYWJsZV9wbGwoY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMg
PSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gICAJ
ZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAgCj4gICAJLyogRG9uJ3QgZGlzYWJsZSBw
aXBlIG9yIHBpcGUgUExMcyBpZiBuZWVkZWQgKi8KPiAtCWlmIChJU19JODMwKGRldl9wcml2KSkK
PiArCWlmIChJU19JODMwKGk5MTUpKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAkvKiBNYWtlIHN1
cmUgdGhlIHBpcGUgaXNuJ3Qgc3RpbGwgcmVseWluZyBvbiB1cyAqLwo+IC0JYXNzZXJ0X3BpcGVf
ZGlzYWJsZWQoZGV2X3ByaXYsIHBpcGUpOwo+ICsJYXNzZXJ0X3BpcGVfZGlzYWJsZWQoaTkxNSwg
cGlwZSk7Cj4gICAKPiAgIAlJOTE1X1dSSVRFKERQTEwocGlwZSksIERQTExfVkdBX01PREVfRElT
KTsKPiAgIAlQT1NUSU5HX1JFQUQoRFBMTChwaXBlKSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZv
aWQgdmx2X2Rpc2FibGVfcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51
bSBwaXBlIHBpcGUpCj4gK3N0YXRpYyB2b2lkIHZsdl9kaXNhYmxlX3BsbChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBwaXBlIHBpcGUpCj4gICB7Cj4gICAJdTMyIHZhbDsKPiAg
IAo+ICAgCS8qIE1ha2Ugc3VyZSB0aGUgcGlwZSBpc24ndCBzdGlsbCByZWx5aW5nIG9uIHVzICov
Cj4gLQlhc3NlcnRfcGlwZV9kaXNhYmxlZChkZXZfcHJpdiwgcGlwZSk7Cj4gKwlhc3NlcnRfcGlw
ZV9kaXNhYmxlZChpOTE1LCBwaXBlKTsKPiAgIAo+ICAgCXZhbCA9IERQTExfSU5URUdSQVRFRF9S
RUZfQ0xLX1ZMViB8Cj4gICAJCURQTExfUkVGX0NMS19FTkFCTEVfVkxWIHwgRFBMTF9WR0FfTU9E
RV9ESVM7Cj4gQEAgLTE1NjQsMTMgKzE1NjQsMTMgQEAgc3RhdGljIHZvaWQgdmx2X2Rpc2FibGVf
cGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUpCj4g
ICAJUE9TVElOR19SRUFEKERQTEwocGlwZSkpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGNo
dl9kaXNhYmxlX3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlw
ZSBwaXBlKQo+ICtzdGF0aWMgdm9pZCBjaHZfZGlzYWJsZV9wbGwoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsIGVudW0gcGlwZSBwaXBlKQo+ICAgewo+ICAgCWVudW0gZHBpb19jaGFubmVs
IHBvcnQgPSB2bHZfcGlwZV90b19jaGFubmVsKHBpcGUpOwo+ICAgCXUzMiB2YWw7Cj4gICAKPiAg
IAkvKiBNYWtlIHN1cmUgdGhlIHBpcGUgaXNuJ3Qgc3RpbGwgcmVseWluZyBvbiB1cyAqLwo+IC0J
YXNzZXJ0X3BpcGVfZGlzYWJsZWQoZGV2X3ByaXYsIHBpcGUpOwo+ICsJYXNzZXJ0X3BpcGVfZGlz
YWJsZWQoaTkxNSwgcGlwZSk7Cj4gICAKPiAgIAl2YWwgPSBEUExMX1NTQ19SRUZfQ0xLX0NIViB8
Cj4gICAJCURQTExfUkVGX0NMS19FTkFCTEVfVkxWIHwgRFBMTF9WR0FfTU9ERV9ESVM7Cj4gQEAg
LTE1ODAsMTcgKzE1ODAsMTcgQEAgc3RhdGljIHZvaWQgY2h2X2Rpc2FibGVfcGxsKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUpCj4gICAJSTkxNV9XUklU
RShEUExMKHBpcGUpLCB2YWwpOwo+ICAgCVBPU1RJTkdfUkVBRChEUExMKHBpcGUpKTsKPiAgIAo+
IC0Jdmx2X2RwaW9fZ2V0KGRldl9wcml2KTsKPiArCXZsdl9kcGlvX2dldChpOTE1KTsKPiAgIAo+
ICAgCS8qIERpc2FibGUgMTBiaXQgY2xvY2sgdG8gZGlzcGxheSBjb250cm9sbGVyICovCj4gLQl2
YWwgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBDSFZfQ01OX0RXMTQocG9ydCkpOwo+
ICsJdmFsID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBDSFZfQ01OX0RXMTQocG9ydCkpOwo+
ICAgCXZhbCAmPSB+RFBJT19EQ0xLUF9FTjsKPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBw
aXBlLCBDSFZfQ01OX0RXMTQocG9ydCksIHZhbCk7Cj4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBw
aXBlLCBDSFZfQ01OX0RXMTQocG9ydCksIHZhbCk7Cj4gICAKPiAtCXZsdl9kcGlvX3B1dChkZXZf
cHJpdik7Cj4gKwl2bHZfZHBpb19wdXQoaTkxNSk7Cj4gICB9Cj4gICAKPiAtdm9pZCB2bHZfd2Fp
dF9wb3J0X3JlYWR5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArdm9pZCB2
bHZfd2FpdF9wb3J0X3JlYWR5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJ
IHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRwb3J0LAo+ICAgCQkJIHVuc2lnbmVkIGludCBl
eHBlY3RlZF9tYXNrKQo+ICAgewo+IEBAIC0xNjE1LDcgKzE2MTUsNyBAQCB2b2lkIHZsdl93YWl0
X3BvcnRfcmVhZHkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCQlCVUco
KTsKPiAgIAl9Cj4gICAKPiAtCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYt
PnVuY29yZSwKPiArCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+
ICAgCQkJCSAgICBkcGxsX3JlZywgcG9ydF9tYXNrLCBleHBlY3RlZF9tYXNrLAo+ICAgCQkJCSAg
ICAxMDAwKSkKPiAgIAkJV0FSTigxLCAidGltZWQgb3V0IHdhaXRpbmcgZm9yIHBvcnQgJWMgcmVh
ZHk6IGdvdCAweCV4LCBleHBlY3RlZCAweCV4XG4iLAo+IEBAIC0xNjI2LDE5ICsxNjI2LDE5IEBA
IHZvaWQgdmx2X3dhaXRfcG9ydF9yZWFkeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gICBzdGF0aWMgdm9pZCBpcm9ubGFrZV9lbmFibGVfcGNoX3RyYW5zY29kZXIoY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2Uu
ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5i
YXNlLmRldik7Cj4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAgCWk5MTVfcmVn
X3QgcmVnOwo+ICAgCXUzMiB2YWwsIHBpcGVjb25mX3ZhbDsKPiAgIAo+ICAgCS8qIE1ha2Ugc3Vy
ZSBQQ0ggRFBMTCBpcyBlbmFibGVkICovCj4gLQlhc3NlcnRfc2hhcmVkX2RwbGxfZW5hYmxlZChk
ZXZfcHJpdiwgY3J0Y19zdGF0ZS0+c2hhcmVkX2RwbGwpOwo+ICsJYXNzZXJ0X3NoYXJlZF9kcGxs
X2VuYWJsZWQoaTkxNSwgY3J0Y19zdGF0ZS0+c2hhcmVkX2RwbGwpOwo+ICAgCj4gICAJLyogRkRJ
IG11c3QgYmUgZmVlZGluZyB1cyBiaXRzIGZvciBQQ0ggcG9ydHMgKi8KPiAtCWFzc2VydF9mZGlf
dHhfZW5hYmxlZChkZXZfcHJpdiwgcGlwZSk7Cj4gLQlhc3NlcnRfZmRpX3J4X2VuYWJsZWQoZGV2
X3ByaXYsIHBpcGUpOwo+ICsJYXNzZXJ0X2ZkaV90eF9lbmFibGVkKGk5MTUsIHBpcGUpOwo+ICsJ
YXNzZXJ0X2ZkaV9yeF9lbmFibGVkKGk5MTUsIHBpcGUpOwo+ICAgCj4gLQlpZiAoSEFTX1BDSF9D
UFQoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSEFTX1BDSF9DUFQoaTkxNSkpIHsKPiAgIAkJLyogV29y
a2Fyb3VuZDogU2V0IHRoZSB0aW1pbmcgb3ZlcnJpZGUgYml0IGJlZm9yZSBlbmFibGluZyB0aGUK
PiAgIAkJICogcGNoIHRyYW5zY29kZXIuICovCj4gICAJCXJlZyA9IFRSQU5TX0NISUNLRU4yKHBp
cGUpOwo+IEBAIC0xNjUxLDcgKzE2NTEsNyBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9lbmFibGVf
cGNoX3RyYW5zY29kZXIoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfcwo+ICAg
CXZhbCA9IEk5MTVfUkVBRChyZWcpOwo+ICAgCXBpcGVjb25mX3ZhbCA9IEk5MTVfUkVBRChQSVBF
Q09ORihwaXBlKSk7Cj4gICAKPiAtCWlmIChIQVNfUENIX0lCWChkZXZfcHJpdikpIHsKPiArCWlm
IChIQVNfUENIX0lCWChpOTE1KSkgewo+ICAgCQkvKgo+ICAgCQkgKiBNYWtlIHRoZSBCUEMgaW4g
dHJhbnNjb2RlciBiZSBjb25zaXN0ZW50IHdpdGgKPiAgIAkJICogdGhhdCBpbiBwaXBlY29uZiBy
ZWcuIEZvciBIRE1JIHdlIG11c3QgdXNlIDhicGMKPiBAQCAtMTY2Niw3ICsxNjY2LDcgQEAgc3Rh
dGljIHZvaWQgaXJvbmxha2VfZW5hYmxlX3BjaF90cmFuc2NvZGVyKGNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3MKPiAgIAo+ICAgCXZhbCAmPSB+VFJBTlNfSU5URVJMQUNFX01B
U0s7Cj4gICAJaWYgKChwaXBlY29uZl92YWwgJiBQSVBFQ09ORl9JTlRFUkxBQ0VfTUFTSykgPT0g
UElQRUNPTkZfSU5URVJMQUNFRF9JTEspIHsKPiAtCQlpZiAoSEFTX1BDSF9JQlgoZGV2X3ByaXYp
ICYmCj4gKwkJaWYgKEhBU19QQ0hfSUJYKGk5MTUpICYmCj4gICAJCSAgICBpbnRlbF9jcnRjX2hh
c190eXBlKGNydGNfc3RhdGUsIElOVEVMX09VVFBVVF9TRFZPKSkKPiAgIAkJCXZhbCB8PSBUUkFO
U19MRUdBQ1lfSU5URVJMQUNFRF9JTEs7Cj4gICAJCWVsc2UKPiBAQCAtMTY3NiwyMCArMTY3Niwy
MCBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9lbmFibGVfcGNoX3RyYW5zY29kZXIoY29uc3Qgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfcwo+ICAgCX0KPiAgIAo+ICAgCUk5MTVfV1JJVEUo
cmVnLCB2YWwgfCBUUkFOU19FTkFCTEUpOwo+IC0JaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVy
KCZkZXZfcHJpdi0+dW5jb3JlLAo+ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1
LT51bmNvcmUsCj4gICAJCQkJICAgIHJlZywgVFJBTlNfU1RBVEVfRU5BQkxFLCBUUkFOU19TVEFU
RV9FTkFCTEUsCj4gICAJCQkJICAgIDEwMCkpCj4gICAJCURSTV9FUlJPUigiZmFpbGVkIHRvIGVu
YWJsZSB0cmFuc2NvZGVyICVjXG4iLCBwaXBlX25hbWUocGlwZSkpOwo+ICAgfQo+ICAgCj4gLXN0
YXRpYyB2b2lkIGxwdF9lbmFibGVfcGNoX3RyYW5zY29kZXIoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBscHRfZW5hYmxlX3BjaF90cmFuc2NvZGVyKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgICAgIGVudW0gdHJhbnNjb2Rl
ciBjcHVfdHJhbnNjb2RlcikKPiAgIHsKPiAgIAl1MzIgdmFsLCBwaXBlY29uZl92YWw7Cj4gICAK
PiAgIAkvKiBGREkgbXVzdCBiZSBmZWVkaW5nIHVzIGJpdHMgZm9yIFBDSCBwb3J0cyAqLwo+IC0J
YXNzZXJ0X2ZkaV90eF9lbmFibGVkKGRldl9wcml2LCAoZW51bSBwaXBlKSBjcHVfdHJhbnNjb2Rl
cik7Cj4gLQlhc3NlcnRfZmRpX3J4X2VuYWJsZWQoZGV2X3ByaXYsIFBJUEVfQSk7Cj4gKwlhc3Nl
cnRfZmRpX3R4X2VuYWJsZWQoaTkxNSwgKGVudW0gcGlwZSkgY3B1X3RyYW5zY29kZXIpOwo+ICsJ
YXNzZXJ0X2ZkaV9yeF9lbmFibGVkKGk5MTUsIFBJUEVfQSk7Cj4gICAKPiAgIAkvKiBXb3JrYXJv
dW5kOiBzZXQgdGltaW5nIG92ZXJyaWRlIGJpdC4gKi8KPiAgIAl2YWwgPSBJOTE1X1JFQUQoVFJB
TlNfQ0hJQ0tFTjIoUElQRV9BKSk7Cj4gQEAgLTE3MDYsNyArMTcwNiw3IEBAIHN0YXRpYyB2b2lk
IGxwdF9lbmFibGVfcGNoX3RyYW5zY29kZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ICAgCQl2YWwgfD0gVFJBTlNfUFJPR1JFU1NJVkU7Cj4gICAKPiAgIAlJOTE1X1dSSVRF
KExQVF9UUkFOU0NPTkYsIHZhbCk7Cj4gLQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRl
dl9wcml2LT51bmNvcmUsCj4gKwlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVu
Y29yZSwKPiAgIAkJCQkgICAgTFBUX1RSQU5TQ09ORiwKPiAgIAkJCQkgICAgVFJBTlNfU1RBVEVf
RU5BQkxFLAo+ICAgCQkJCSAgICBUUkFOU19TVEFURV9FTkFCTEUsCj4gQEAgLTE3MTQsMzAgKzE3
MTQsMzAgQEAgc3RhdGljIHZvaWQgbHB0X2VuYWJsZV9wY2hfdHJhbnNjb2RlcihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJCURSTV9FUlJPUigiRmFpbGVkIHRvIGVuYWJs
ZSBQQ0ggdHJhbnNjb2RlclxuIik7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaXJvbmxha2Vf
ZGlzYWJsZV9wY2hfdHJhbnNjb2RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gK3N0YXRpYyB2b2lkIGlyb25sYWtlX2Rpc2FibGVfcGNoX3RyYW5zY29kZXIoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJCSAgICBlbnVtIHBpcGUgcGlwZSkKPiAgIHsK
PiAgIAlpOTE1X3JlZ190IHJlZzsKPiAgIAl1MzIgdmFsOwo+ICAgCj4gICAJLyogRkRJIHJlbGll
cyBvbiB0aGUgdHJhbnNjb2RlciAqLwo+IC0JYXNzZXJ0X2ZkaV90eF9kaXNhYmxlZChkZXZfcHJp
diwgcGlwZSk7Cj4gLQlhc3NlcnRfZmRpX3J4X2Rpc2FibGVkKGRldl9wcml2LCBwaXBlKTsKPiAr
CWFzc2VydF9mZGlfdHhfZGlzYWJsZWQoaTkxNSwgcGlwZSk7Cj4gKwlhc3NlcnRfZmRpX3J4X2Rp
c2FibGVkKGk5MTUsIHBpcGUpOwo+ICAgCj4gICAJLyogUG9ydHMgbXVzdCBiZSBvZmYgYXMgd2Vs
bCAqLwo+IC0JYXNzZXJ0X3BjaF9wb3J0c19kaXNhYmxlZChkZXZfcHJpdiwgcGlwZSk7Cj4gKwlh
c3NlcnRfcGNoX3BvcnRzX2Rpc2FibGVkKGk5MTUsIHBpcGUpOwo+ICAgCj4gICAJcmVnID0gUENI
X1RSQU5TQ09ORihwaXBlKTsKPiAgIAl2YWwgPSBJOTE1X1JFQUQocmVnKTsKPiAgIAl2YWwgJj0g
flRSQU5TX0VOQUJMRTsKPiAgIAlJOTE1X1dSSVRFKHJlZywgdmFsKTsKPiAgIAkvKiB3YWl0IGZv
ciBQQ0ggdHJhbnNjb2RlciBvZmYsIHRyYW5zY29kZXIgc3RhdGUgKi8KPiAtCWlmIChpbnRlbF93
YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwKPiArCWlmIChpbnRlbF93YWl0X2Zv
cl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+ICAgCQkJCSAgICByZWcsIFRSQU5TX1NUQVRFX0VO
QUJMRSwgMCwKPiAgIAkJCQkgICAgNTApKQo+ICAgCQlEUk1fRVJST1IoImZhaWxlZCB0byBkaXNh
YmxlIHRyYW5zY29kZXIgJWNcbiIsIHBpcGVfbmFtZShwaXBlKSk7Cj4gICAKPiAtCWlmIChIQVNf
UENIX0NQVChkZXZfcHJpdikpIHsKPiArCWlmIChIQVNfUENIX0NQVChpOTE1KSkgewo+ICAgCQkv
KiBXb3JrYXJvdW5kOiBDbGVhciB0aGUgdGltaW5nIG92ZXJyaWRlIGNoaWNrZW4gYml0IGFnYWlu
LiAqLwo+ICAgCQlyZWcgPSBUUkFOU19DSElDS0VOMihwaXBlKTsKPiAgIAkJdmFsID0gSTkxNV9S
RUFEKHJlZyk7Cj4gQEAgLTE3NDYsNyArMTc0Niw3IEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX2Rp
c2FibGVfcGNoX3RyYW5zY29kZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICAgCX0KPiAgIH0KPiAgIAo+IC12b2lkIGxwdF9kaXNhYmxlX3BjaF90cmFuc2NvZGVyKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBscHRfZGlzYWJsZV9wY2hfdHJh
bnNjb2RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAl1MzIgdmFs
Owo+ICAgCj4gQEAgLTE3NTQsNyArMTc1NCw3IEBAIHZvaWQgbHB0X2Rpc2FibGVfcGNoX3RyYW5z
Y29kZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCXZhbCAmPSB+VFJB
TlNfRU5BQkxFOwo+ICAgCUk5MTVfV1JJVEUoTFBUX1RSQU5TQ09ORiwgdmFsKTsKPiAgIAkvKiB3
YWl0IGZvciBQQ0ggdHJhbnNjb2RlciBvZmYsIHRyYW5zY29kZXIgc3RhdGUgKi8KPiAtCWlmIChp
bnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwKPiArCWlmIChpbnRlbF93
YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+ICAgCQkJCSAgICBMUFRfVFJBTlNDT05G
LCBUUkFOU19TVEFURV9FTkFCTEUsIDAsCj4gICAJCQkJICAgIDUwKSkKPiAgIAkJRFJNX0VSUk9S
KCJGYWlsZWQgdG8gZGlzYWJsZSBQQ0ggdHJhbnNjb2RlclxuIik7Cj4gQEAgLTE3NjcsOSArMTc2
Nyw5IEBAIHZvaWQgbHB0X2Rpc2FibGVfcGNoX3RyYW5zY29kZXIoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ICAgCj4gICBlbnVtIHBpcGUgaW50ZWxfY3J0Y19wY2hfdHJhbnNj
b2RlcihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAo+IC0J
aWYgKEhBU19QQ0hfTFBUKGRldl9wcml2KSkKPiArCWlmIChIQVNfUENIX0xQVChpOTE1KSkKPiAg
IAkJcmV0dXJuIFBJUEVfQTsKPiAgIAllbHNlCj4gICAJCXJldHVybiBjcnRjLT5waXBlOwo+IEBA
IC0xNzc3LDE5ICsxNzc3LDE5IEBAIGVudW0gcGlwZSBpbnRlbF9jcnRjX3BjaF90cmFuc2NvZGVy
KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+ICAgCj4gICBzdGF0aWMgdTMyIGludGVsX2NydGNf
bWF4X3ZibGFua19jb3VudChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
Y3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiAgIAo+ICAgCS8q
Cj4gICAJICogT24gaTk2NWdtIHRoZSBoYXJkd2FyZSBmcmFtZSBjb3VudGVyIHJlYWRzCj4gICAJ
ICogemVybyB3aGVuIHRoZSBUViBlbmNvZGVyIGlzIGVuYWJsZWQgOigKPiAgIAkgKi8KPiAtCWlm
IChJU19JOTY1R00oZGV2X3ByaXYpICYmCj4gKwlpZiAoSVNfSTk2NUdNKGk5MTUpICYmCj4gICAJ
ICAgIChjcnRjX3N0YXRlLT5vdXRwdXRfdHlwZXMgJiBCSVQoSU5URUxfT1VUUFVUX1RWT1VUKSkp
Cj4gICAJCXJldHVybiAwOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA1IHx8
IElTX0c0WChkZXZfcHJpdikpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDUgfHwgSVNfRzRY
KGk5MTUpKQo+ICAgCQlyZXR1cm4gMHhmZmZmZmZmZjsgLyogZnVsbCAzMiBiaXQgY291bnRlciAq
Lwo+IC0JZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAzKQo+ICsJZWxzZSBpZiAoSU5U
RUxfR0VOKGk5MTUpID49IDMpCj4gICAJCXJldHVybiAweGZmZmZmZjsgLyogb25seSAyNCBiaXRz
IG9mIGZyYW1lIGNvdW50ICovCj4gICAJZWxzZQo+ICAgCQlyZXR1cm4gMDsgLyogR2VuMiBkb2Vz
bid0IGhhdmUgYSBoYXJkd2FyZSBmcmFtZSBjb3VudGVyICovCj4gQEAgLTE4MDcsNyArMTgwNyw3
IEBAIHN0YXRpYyB2b2lkIGludGVsX2NydGNfdmJsYW5rX29uKGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX3BpcGUo
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+ICAgewo+ICAg
CXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhuZXdfY3J0Y19zdGF0ZS0+
YmFzZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29k
ZXIgPSBuZXdfY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXI7Cj4gICAJZW51bSBwaXBlIHBpcGUg
PSBjcnRjLT5waXBlOwo+ICAgCWk5MTVfcmVnX3QgcmVnOwo+IEBAIC0xODIyLDI5ICsxODIyLDI5
IEBAIHN0YXRpYyB2b2lkIGludGVsX2VuYWJsZV9waXBlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpuZXdfY3J0Y19zdGF0ZSkKPiAgIAkgKiBhIHBsYW5lLiAgT24gSUxLKyB0aGUgcGlw
ZSBQTExzIGFyZSBpbnRlZ3JhdGVkLCBzbyB3ZSBkb24ndAo+ICAgCSAqIG5lZWQgdGhlIGNoZWNr
Lgo+ICAgCSAqLwo+IC0JaWYgKEhBU19HTUNIKGRldl9wcml2KSkgewo+ICsJaWYgKEhBU19HTUNI
KGk5MTUpKSB7Cj4gICAJCWlmIChpbnRlbF9jcnRjX2hhc190eXBlKG5ld19jcnRjX3N0YXRlLCBJ
TlRFTF9PVVRQVVRfRFNJKSkKPiAtCQkJYXNzZXJ0X2RzaV9wbGxfZW5hYmxlZChkZXZfcHJpdik7
Cj4gKwkJCWFzc2VydF9kc2lfcGxsX2VuYWJsZWQoaTkxNSk7Cj4gICAJCWVsc2UKPiAtCQkJYXNz
ZXJ0X3BsbF9lbmFibGVkKGRldl9wcml2LCBwaXBlKTsKPiArCQkJYXNzZXJ0X3BsbF9lbmFibGVk
KGk5MTUsIHBpcGUpOwo+ICAgCX0gZWxzZSB7Cj4gICAJCWlmIChuZXdfY3J0Y19zdGF0ZS0+aGFz
X3BjaF9lbmNvZGVyKSB7Cj4gICAJCQkvKiBpZiBkcml2aW5nIHRoZSBQQ0gsIHdlIG5lZWQgRkRJ
IGVuYWJsZWQgKi8KPiAtCQkJYXNzZXJ0X2ZkaV9yeF9wbGxfZW5hYmxlZChkZXZfcHJpdiwKPiAr
CQkJYXNzZXJ0X2ZkaV9yeF9wbGxfZW5hYmxlZChpOTE1LAo+ICAgCQkJCQkJICBpbnRlbF9jcnRj
X3BjaF90cmFuc2NvZGVyKGNydGMpKTsKPiAtCQkJYXNzZXJ0X2ZkaV90eF9wbGxfZW5hYmxlZChk
ZXZfcHJpdiwKPiArCQkJYXNzZXJ0X2ZkaV90eF9wbGxfZW5hYmxlZChpOTE1LAo+ICAgCQkJCQkJ
ICAoZW51bSBwaXBlKSBjcHVfdHJhbnNjb2Rlcik7Cj4gICAJCX0KPiAgIAkJLyogRklYTUU6IGFz
c2VydCBDUFUgcG9ydCBjb25kaXRpb25zIGZvciBTTkIrICovCj4gICAJfQo+ICAgCj4gLQl0cmFj
ZV9pbnRlbF9waXBlX2VuYWJsZShkZXZfcHJpdiwgcGlwZSk7Cj4gKwl0cmFjZV9pbnRlbF9waXBl
X2VuYWJsZShpOTE1LCBwaXBlKTsKPiAgIAo+ICAgCXJlZyA9IFBJUEVDT05GKGNwdV90cmFuc2Nv
ZGVyKTsKPiAgIAl2YWwgPSBJOTE1X1JFQUQocmVnKTsKPiAgIAlpZiAodmFsICYgUElQRUNPTkZf
RU5BQkxFKSB7Cj4gICAJCS8qIHdlIGtlZXAgYm90aCBwaXBlcyBlbmFibGVkIG9uIDgzMCAqLwo+
IC0JCVdBUk5fT04oIUlTX0k4MzAoZGV2X3ByaXYpKTsKPiArCQlXQVJOX09OKCFJU19JODMwKGk5
MTUpKTsKPiAgIAkJcmV0dXJuOwo+ICAgCX0KPiAgIAo+IEBAIC0xODY1LDcgKzE4NjUsNyBAQCBz
dGF0aWMgdm9pZCBpbnRlbF9lbmFibGVfcGlwZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqbmV3X2NydGNfc3RhdGUpCj4gICBzdGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxlX3BpcGUoY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlKQo+ICAgewo+ICAgCXN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhvbGRfY3J0Y19zdGF0ZS0+YmFz
ZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
Y3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIg
PSBvbGRfY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXI7Cj4gICAJZW51bSBwaXBlIHBpcGUgPSBj
cnRjLT5waXBlOwo+ICAgCWk5MTVfcmVnX3QgcmVnOwo+IEBAIC0xODc5LDcgKzE4NzksNyBAQCBz
dGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxlX3BpcGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKm9sZF9jcnRjX3N0YXRlKQo+ICAgCSAqLwo+ICAgCWFzc2VydF9wbGFuZXNfZGlzYWJsZWQo
Y3J0Yyk7Cj4gICAKPiAtCXRyYWNlX2ludGVsX3BpcGVfZGlzYWJsZShkZXZfcHJpdiwgcGlwZSk7
Cj4gKwl0cmFjZV9pbnRlbF9waXBlX2Rpc2FibGUoaTkxNSwgcGlwZSk7Cj4gICAKPiAgIAlyZWcg
PSBQSVBFQ09ORihjcHVfdHJhbnNjb2Rlcik7Cj4gICAJdmFsID0gSTkxNV9SRUFEKHJlZyk7Cj4g
QEAgLTE4OTQsNyArMTg5NCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2Rpc2FibGVfcGlwZShjb25z
dCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUpCj4gICAJCXZhbCAmPSB+
UElQRUNPTkZfRE9VQkxFX1dJREU7Cj4gICAKPiAgIAkvKiBEb24ndCBkaXNhYmxlIHBpcGUgb3Ig
cGlwZSBQTExzIGlmIG5lZWRlZCAqLwo+IC0JaWYgKCFJU19JODMwKGRldl9wcml2KSkKPiArCWlm
ICghSVNfSTgzMChpOTE1KSkKPiAgIAkJdmFsICY9IH5QSVBFQ09ORl9FTkFCTEU7Cj4gICAKPiAg
IAlJOTE1X1dSSVRFKHJlZywgdmFsKTsKPiBAQCAtMTkwMiwyMiArMTkwMiwyMiBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9kaXNhYmxlX3BpcGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9s
ZF9jcnRjX3N0YXRlKQo+ICAgCQlpbnRlbF93YWl0X2Zvcl9waXBlX29mZihvbGRfY3J0Y19zdGF0
ZSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHVuc2lnbmVkIGludCBpbnRlbF90aWxlX3NpemUoY29u
c3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdW5zaWduZWQg
aW50IGludGVsX3RpbGVfc2l6ZShjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiAgIHsKPiAtCXJldHVybiBJU19HRU4oZGV2X3ByaXYsIDIpID8gMjA0OCA6IDQwOTY7Cj4gKwly
ZXR1cm4gSVNfR0VOKGk5MTUsIDIpID8gMjA0OCA6IDQwOTY7Cj4gICB9Cj4gICAKPiAgIHN0YXRp
YyB1bnNpZ25lZCBpbnQKPiAgIGludGVsX3RpbGVfd2lkdGhfYnl0ZXMoY29uc3Qgc3RydWN0IGRy
bV9mcmFtZWJ1ZmZlciAqZmIsIGludCBjb2xvcl9wbGFuZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZmItPmRldik7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZmItPmRldik7Cj4gICAJdW5zaWduZWQgaW50
IGNwcCA9IGZiLT5mb3JtYXQtPmNwcFtjb2xvcl9wbGFuZV07Cj4gICAKPiAgIAlzd2l0Y2ggKGZi
LT5tb2RpZmllcikgewo+ICAgCWNhc2UgRFJNX0ZPUk1BVF9NT0RfTElORUFSOgo+IC0JCXJldHVy
biBpbnRlbF90aWxlX3NpemUoZGV2X3ByaXYpOwo+ICsJCXJldHVybiBpbnRlbF90aWxlX3NpemUo
aTkxNSk7Cj4gICAJY2FzZSBJOTE1X0ZPUk1BVF9NT0RfWF9USUxFRDoKPiAtCQlpZiAoSVNfR0VO
KGRldl9wcml2LCAyKSkKPiArCQlpZiAoSVNfR0VOKGk5MTUsIDIpKQo+ICAgCQkJcmV0dXJuIDEy
ODsKPiAgIAkJZWxzZQo+ICAgCQkJcmV0dXJuIDUxMjsKPiBAQCAtMTkyNiw3ICsxOTI2LDcgQEAg
aW50ZWxfdGlsZV93aWR0aF9ieXRlcyhjb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiwg
aW50IGNvbG9yX3BsYW5lKQo+ICAgCQkJcmV0dXJuIDEyODsKPiAgIAkJLyogZmFsbCB0aHJvdWdo
ICovCj4gICAJY2FzZSBJOTE1X0ZPUk1BVF9NT0RfWV9USUxFRDoKPiAtCQlpZiAoSVNfR0VOKGRl
dl9wcml2LCAyKSB8fCBIQVNfMTI4X0JZVEVfWV9USUxJTkcoZGV2X3ByaXYpKQo+ICsJCWlmIChJ
U19HRU4oaTkxNSwgMikgfHwgSEFTXzEyOF9CWVRFX1lfVElMSU5HKGk5MTUpKQo+ICAgCQkJcmV0
dXJuIDEyODsKPiAgIAkJZWxzZQo+ICAgCQkJcmV0dXJuIDUxMjsKPiBAQCAtMjAxNywyNiArMjAx
NywyNiBAQCBpbnRlbF9maWxsX2ZiX2dndHRfdmlldyhzdHJ1Y3QgaTkxNV9nZ3R0X3ZpZXcgKnZp
ZXcsCj4gICAJfQo+ICAgfQo+ICAgCj4gLXN0YXRpYyB1bnNpZ25lZCBpbnQgaW50ZWxfY3Vyc29y
X2FsaWdubWVudChjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0
YXRpYyB1bnNpZ25lZCBpbnQgaW50ZWxfY3Vyc29yX2FsaWdubWVudChjb25zdCBzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCWlmIChJU19JODMwKGRldl9wcml2KSkKPiAr
CWlmIChJU19JODMwKGk5MTUpKQo+ICAgCQlyZXR1cm4gMTYgKiAxMDI0Owo+IC0JZWxzZSBpZiAo
SVNfSTg1WChkZXZfcHJpdikpCj4gKwllbHNlIGlmIChJU19JODVYKGk5MTUpKQo+ICAgCQlyZXR1
cm4gMjU2Owo+IC0JZWxzZSBpZiAoSVNfSTg0NUcoZGV2X3ByaXYpIHx8IElTX0k4NjVHKGRldl9w
cml2KSkKPiArCWVsc2UgaWYgKElTX0k4NDVHKGk5MTUpIHx8IElTX0k4NjVHKGk5MTUpKQo+ICAg
CQlyZXR1cm4gMzI7Cj4gICAJZWxzZQo+ICAgCQlyZXR1cm4gNCAqIDEwMjQ7Cj4gICB9Cj4gICAK
PiAtc3RhdGljIHVuc2lnbmVkIGludCBpbnRlbF9saW5lYXJfYWxpZ25tZW50KGNvbnN0IHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHVuc2lnbmVkIGludCBpbnRl
bF9saW5lYXJfYWxpZ25tZW50KGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ICAgewo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkKPiArCWlmIChJTlRFTF9HRU4o
aTkxNSkgPj0gOSkKPiAgIAkJcmV0dXJuIDI1NiAqIDEwMjQ7Cj4gLQllbHNlIGlmIChJU19JOTY1
RyhkZXZfcHJpdikgfHwgSVNfSTk2NUdNKGRldl9wcml2KSB8fAo+IC0JCSBJU19WQUxMRVlWSUVX
KGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiArCWVsc2UgaWYgKElTX0k5
NjVHKGk5MTUpIHx8IElTX0k5NjVHTShpOTE1KSB8fAo+ICsJCSBJU19WQUxMRVlWSUVXKGk5MTUp
IHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gICAJCXJldHVybiAxMjggKiAxMDI0Owo+IC0JZWxz
ZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA0KQo+ICsJZWxzZSBpZiAoSU5URUxfR0VOKGk5
MTUpID49IDQpCj4gICAJCXJldHVybiA0ICogMTAyNDsKPiAgIAllbHNlCj4gICAJCXJldHVybiAw
Owo+IEBAIC0yMDQ1LDcgKzIwNDUsNyBAQCBzdGF0aWMgdW5zaWduZWQgaW50IGludGVsX2xpbmVh
cl9hbGlnbm1lbnQoY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcgo+ICAgc3Rh
dGljIHVuc2lnbmVkIGludCBpbnRlbF9zdXJmX2FsaWdubWVudChjb25zdCBzdHJ1Y3QgZHJtX2Zy
YW1lYnVmZmVyICpmYiwKPiAgIAkJCQkJIGludCBjb2xvcl9wbGFuZSkKPiAgIHsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZmItPmRldik7Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZmItPmRldik7Cj4gICAKPiAgIAkv
KiBBVVhfRElTVCBuZWVkcyBvbmx5IDRLIGFsaWdubWVudCAqLwo+ICAgCWlmIChjb2xvcl9wbGFu
ZSA9PSAxKQo+IEBAIC0yMDUzLDkgKzIwNTMsOSBAQCBzdGF0aWMgdW5zaWduZWQgaW50IGludGVs
X3N1cmZfYWxpZ25tZW50KGNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLAo+ICAgCj4g
ICAJc3dpdGNoIChmYi0+bW9kaWZpZXIpIHsKPiAgIAljYXNlIERSTV9GT1JNQVRfTU9EX0xJTkVB
UjoKPiAtCQlyZXR1cm4gaW50ZWxfbGluZWFyX2FsaWdubWVudChkZXZfcHJpdik7Cj4gKwkJcmV0
dXJuIGludGVsX2xpbmVhcl9hbGlnbm1lbnQoaTkxNSk7Cj4gICAJY2FzZSBJOTE1X0ZPUk1BVF9N
T0RfWF9USUxFRDoKPiAtCQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KQo+ICsJCWlmIChJ
TlRFTF9HRU4oaTkxNSkgPj0gOSkKPiAgIAkJCXJldHVybiAyNTYgKiAxMDI0Owo+ICAgCQlyZXR1
cm4gMDsKPiAgIAljYXNlIEk5MTVfRk9STUFUX01PRF9ZX1RJTEVEX0NDUzoKPiBAQCAtMjA3Miw5
ICsyMDcyLDkgQEAgc3RhdGljIHVuc2lnbmVkIGludCBpbnRlbF9zdXJmX2FsaWdubWVudChjb25z
dCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiwKPiAgIHN0YXRpYyBib29sIGludGVsX3BsYW5l
X3VzZXNfZmVuY2UoY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkK
PiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lID0gdG9faW50ZWxfcGxhbmUocGxh
bmVfc3RhdGUtPmJhc2UucGxhbmUpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gICAKPiAtCXJldHVybiBJTlRF
TF9HRU4oZGV2X3ByaXYpIDwgNCB8fAo+ICsJcmV0dXJuIElOVEVMX0dFTihpOTE1KSA8IDQgfHwK
PiAgIAkJKHBsYW5lLT5oYXNfZmJjICYmCj4gICAJCSBwbGFuZV9zdGF0ZS0+dmlldy50eXBlID09
IEk5MTVfR0dUVF9WSUVXX05PUk1BTCk7Cj4gICB9Cj4gQEAgLTIwODYsNyArMjA4Niw3IEBAIGlu
dGVsX3Bpbl9hbmRfZmVuY2VfZmJfb2JqKHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLAo+ICAg
CQkJICAgdW5zaWduZWQgbG9uZyAqb3V0X2ZsYWdzKQo+ICAgewo+ICAgCXN0cnVjdCBkcm1fZGV2
aWNlICpkZXYgPSBmYi0+ZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGRldik7Cj4gICAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IGludGVsX2Zi
X29iaihmYik7Cj4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gICAJc3RydWN0IGk5MTVf
dm1hICp2bWE7Cj4gQEAgLTIxMDIsNyArMjEwMiw3IEBAIGludGVsX3Bpbl9hbmRfZmVuY2VfZmJf
b2JqKHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLAo+ICAgCSAqIHdlIHNob3VsZCBhbHdheXMg
aGF2ZSB2YWxpZCBQVEUgZm9sbG93aW5nIHRoZSBzY2Fub3V0IHByZXZlbnRpbmcKPiAgIAkgKiB0
aGUgVlQtZCB3YXJuaW5nLgo+ICAgCSAqLwo+IC0JaWYgKGludGVsX3NjYW5vdXRfbmVlZHNfdnRk
X3dhKGRldl9wcml2KSAmJiBhbGlnbm1lbnQgPCAyNTYgKiAxMDI0KQo+ICsJaWYgKGludGVsX3Nj
YW5vdXRfbmVlZHNfdnRkX3dhKGk5MTUpICYmIGFsaWdubWVudCA8IDI1NiAqIDEwMjQpCj4gICAJ
CWFsaWdubWVudCA9IDI1NiAqIDEwMjQ7Cj4gICAKPiAgIAkvKgo+IEBAIC0yMTEyLDEwICsyMTEy
LDEwIEBAIGludGVsX3Bpbl9hbmRfZmVuY2VfZmJfb2JqKHN0cnVjdCBkcm1fZnJhbWVidWZmZXIg
KmZiLAo+ICAgCSAqIGludGVsX3J1bnRpbWVfcG1fcHV0KCksIHNvIGl0IGlzIGNvcnJlY3QgdG8g
d3JhcCBvbmx5IHRoZQo+ICAgCSAqIHBpbi91bnBpbi9mZW5jZSBhbmQgbm90IG1vcmUuCj4gICAJ
ICovCj4gLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOwo+ICsJd2Fr
ZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOwo+ICAgCWk5MTVfZ2VtX29iamVjdF9s
b2NrKG9iaik7Cj4gICAKPiAtCWF0b21pY19pbmMoJmRldl9wcml2LT5ncHVfZXJyb3IucGVuZGlu
Z19mYl9waW4pOwo+ICsJYXRvbWljX2luYygmaTkxNS0+Z3B1X2Vycm9yLnBlbmRpbmdfZmJfcGlu
KTsKPiAgIAo+ICAgCXBpbmN0bCA9IDA7Cj4gICAKPiBAQCAtMjEyNiw3ICsyMTI2LDcgQEAgaW50
ZWxfcGluX2FuZF9mZW5jZV9mYl9vYmooc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIsCj4gICAJ
ICogY29tcGxpY2F0ZWQgdGhhbiB0aGlzLiBGb3IgZXhhbXBsZSwgQ2hlcnJ5dmlldyBhcHBlYXJz
IHF1aXRlCj4gICAJICogaGFwcHkgdG8gc2Nhbm91dCBmcm9tIGFueXdoZXJlIHdpdGhpbiBpdHMg
Z2xvYmFsIGFwZXJ0dXJlLgo+ICAgCSAqLwo+IC0JaWYgKEhBU19HTUNIKGRldl9wcml2KSkKPiAr
CWlmIChIQVNfR01DSChpOTE1KSkKPiAgIAkJcGluY3RsIHw9IFBJTl9NQVBQQUJMRTsKPiAgIAo+
ICAgCXZtYSA9IGk5MTVfZ2VtX29iamVjdF9waW5fdG9fZGlzcGxheV9wbGFuZShvYmosCj4gQEAg
LTIxNTQsNyArMjE1NCw3IEBAIGludGVsX3Bpbl9hbmRfZmVuY2VfZmJfb2JqKHN0cnVjdCBkcm1f
ZnJhbWVidWZmZXIgKmZiLAo+ICAgCQkgKiBtb2RlIHRoYXQgbWF0Y2hlcyB0aGUgdXNlciBjb25m
aWd1cmF0aW9uLgo+ICAgCQkgKi8KPiAgIAkJcmV0ID0gaTkxNV92bWFfcGluX2ZlbmNlKHZtYSk7
Cj4gLQkJaWYgKHJldCAhPSAwICYmIElOVEVMX0dFTihkZXZfcHJpdikgPCA0KSB7Cj4gKwkJaWYg
KHJldCAhPSAwICYmIElOVEVMX0dFTihpOTE1KSA8IDQpIHsKPiAgIAkJCWk5MTVfZ2VtX29iamVj
dF91bnBpbl9mcm9tX2Rpc3BsYXlfcGxhbmUodm1hKTsKPiAgIAkJCXZtYSA9IEVSUl9QVFIocmV0
KTsKPiAgIAkJCWdvdG8gZXJyOwo+IEBAIC0yMTY2LDEwICsyMTY2LDEwIEBAIGludGVsX3Bpbl9h
bmRfZmVuY2VfZmJfb2JqKHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLAo+ICAgCj4gICAJaTkx
NV92bWFfZ2V0KHZtYSk7Cj4gICBlcnI6Cj4gLQlhdG9taWNfZGVjKCZkZXZfcHJpdi0+Z3B1X2Vy
cm9yLnBlbmRpbmdfZmJfcGluKTsKPiArCWF0b21pY19kZWMoJmk5MTUtPmdwdV9lcnJvci5wZW5k
aW5nX2ZiX3Bpbik7Cj4gICAKPiAgIAlpOTE1X2dlbV9vYmplY3RfdW5sb2NrKG9iaik7Cj4gLQlp
bnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7Cj4gKwlpbnRlbF9ydW50aW1l
X3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKPiAgIAlyZXR1cm4gdm1hOwo+ICAgfQo+ICAgCj4gQEAg
LTIyNjUsNyArMjI2NSw3IEBAIHN0YXRpYyB1MzIgaW50ZWxfYWRqdXN0X2FsaWduZWRfb2Zmc2V0
KGludCAqeCwgaW50ICp5LAo+ICAgCQkJCSAgICAgICB1bnNpZ25lZCBpbnQgcGl0Y2gsCj4gICAJ
CQkJICAgICAgIHUzMiBvbGRfb2Zmc2V0LCB1MzIgbmV3X29mZnNldCkKPiAgIHsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZmItPmRldik7Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZmItPmRldik7Cj4gICAJdW5zaWdu
ZWQgaW50IGNwcCA9IGZiLT5mb3JtYXQtPmNwcFtjb2xvcl9wbGFuZV07Cj4gICAKPiAgIAlXQVJO
X09OKG5ld19vZmZzZXQgPiBvbGRfb2Zmc2V0KTsKPiBAQCAtMjI3NCw3ICsyMjc0LDcgQEAgc3Rh
dGljIHUzMiBpbnRlbF9hZGp1c3RfYWxpZ25lZF9vZmZzZXQoaW50ICp4LCBpbnQgKnksCj4gICAJ
CXVuc2lnbmVkIGludCB0aWxlX3NpemUsIHRpbGVfd2lkdGgsIHRpbGVfaGVpZ2h0Owo+ICAgCQl1
bnNpZ25lZCBpbnQgcGl0Y2hfdGlsZXM7Cj4gICAKPiAtCQl0aWxlX3NpemUgPSBpbnRlbF90aWxl
X3NpemUoZGV2X3ByaXYpOwo+ICsJCXRpbGVfc2l6ZSA9IGludGVsX3RpbGVfc2l6ZShpOTE1KTsK
PiAgIAkJaW50ZWxfdGlsZV9kaW1zKGZiLCBjb2xvcl9wbGFuZSwgJnRpbGVfd2lkdGgsICZ0aWxl
X2hlaWdodCk7Cj4gICAKPiAgIAkJaWYgKGRybV9yb3RhdGlvbl85MF9vcl8yNzAocm90YXRpb24p
KSB7Cj4gQEAgLTIzMjYsNyArMjMyNiw3IEBAIHN0YXRpYyB1MzIgaW50ZWxfcGxhbmVfYWRqdXN0
X2FsaWduZWRfb2Zmc2V0KGludCAqeCwgaW50ICp5LAo+ICAgICogdXNlZC4gVGhpcyBpcyB3aHkg
dGhlIHVzZXIgaGFzIHRvIHBhc3MgaW4gdGhlIHBpdGNoIHNpbmNlIGl0Cj4gICAgKiBpcyBzcGVj
aWZpZWQgaW4gdGhlIHJvdGF0ZWQgb3JpZW50YXRpb24uCj4gICAgKi8KPiAtc3RhdGljIHUzMiBp
bnRlbF9jb21wdXRlX2FsaWduZWRfb2Zmc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiArc3RhdGljIHUzMiBpbnRlbF9jb21wdXRlX2FsaWduZWRfb2Zmc2V0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCQlpbnQgKngsIGludCAqeSwKPiAgIAkJCQkJ
Y29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIsCj4gICAJCQkJCWludCBjb2xvcl9wbGFu
ZSwKPiBAQCAtMjM0NCw3ICsyMzQ0LDcgQEAgc3RhdGljIHUzMiBpbnRlbF9jb21wdXRlX2FsaWdu
ZWRfb2Zmc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkJdW5zaWdu
ZWQgaW50IHRpbGVfc2l6ZSwgdGlsZV93aWR0aCwgdGlsZV9oZWlnaHQ7Cj4gICAJCXVuc2lnbmVk
IGludCB0aWxlX3Jvd3MsIHRpbGVzLCBwaXRjaF90aWxlczsKPiAgIAo+IC0JCXRpbGVfc2l6ZSA9
IGludGVsX3RpbGVfc2l6ZShkZXZfcHJpdik7Cj4gKwkJdGlsZV9zaXplID0gaW50ZWxfdGlsZV9z
aXplKGk5MTUpOwo+ICAgCQlpbnRlbF90aWxlX2RpbXMoZmIsIGNvbG9yX3BsYW5lLCAmdGlsZV93
aWR0aCwgJnRpbGVfaGVpZ2h0KTsKPiAgIAo+ICAgCQlpZiAoZHJtX3JvdGF0aW9uXzkwX29yXzI3
MChyb3RhdGlvbikpIHsKPiBAQCAtMjM4MiwxOCArMjM4MiwxOCBAQCBzdGF0aWMgdTMyIGludGVs
X3BsYW5lX2NvbXB1dGVfYWxpZ25lZF9vZmZzZXQoaW50ICp4LCBpbnQgKnksCj4gICAJCQkJCSAg
ICAgIGludCBjb2xvcl9wbGFuZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfcGxhbmUgKmludGVs
X3BsYW5lID0gdG9faW50ZWxfcGxhbmUoc3RhdGUtPmJhc2UucGxhbmUpOwo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShpbnRlbF9wbGFuZS0+YmFzZS5kZXYp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGludGVsX3BsYW5l
LT5iYXNlLmRldik7Cj4gICAJY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBzdGF0
ZS0+YmFzZS5mYjsKPiAgIAl1bnNpZ25lZCBpbnQgcm90YXRpb24gPSBzdGF0ZS0+YmFzZS5yb3Rh
dGlvbjsKPiAgIAlpbnQgcGl0Y2ggPSBzdGF0ZS0+Y29sb3JfcGxhbmVbY29sb3JfcGxhbmVdLnN0
cmlkZTsKPiAgIAl1MzIgYWxpZ25tZW50Owo+ICAgCj4gICAJaWYgKGludGVsX3BsYW5lLT5pZCA9
PSBQTEFORV9DVVJTT1IpCj4gLQkJYWxpZ25tZW50ID0gaW50ZWxfY3Vyc29yX2FsaWdubWVudChk
ZXZfcHJpdik7Cj4gKwkJYWxpZ25tZW50ID0gaW50ZWxfY3Vyc29yX2FsaWdubWVudChpOTE1KTsK
PiAgIAllbHNlCj4gICAJCWFsaWdubWVudCA9IGludGVsX3N1cmZfYWxpZ25tZW50KGZiLCBjb2xv
cl9wbGFuZSk7Cj4gICAKPiAtCXJldHVybiBpbnRlbF9jb21wdXRlX2FsaWduZWRfb2Zmc2V0KGRl
dl9wcml2LCB4LCB5LCBmYiwgY29sb3JfcGxhbmUsCj4gKwlyZXR1cm4gaW50ZWxfY29tcHV0ZV9h
bGlnbmVkX29mZnNldChpOTE1LCB4LCB5LCBmYiwgY29sb3JfcGxhbmUsCj4gICAJCQkJCSAgICBw
aXRjaCwgcm90YXRpb24sIGFsaWdubWVudCk7Cj4gICB9Cj4gICAKPiBAQCAtMjQwMiwxMSArMjQw
MiwxMSBAQCBzdGF0aWMgaW50IGludGVsX2ZiX29mZnNldF90b194eShpbnQgKngsIGludCAqeSwK
PiAgIAkJCQkgY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIsCj4gICAJCQkJIGludCBj
b2xvcl9wbGFuZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZmItPmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoZmItPmRldik7Cj4gICAJdW5zaWduZWQgaW50IGhlaWdodDsKPiAgIAo+ICAgCWlmIChm
Yi0+bW9kaWZpZXIgIT0gRFJNX0ZPUk1BVF9NT0RfTElORUFSICYmCj4gLQkgICAgZmItPm9mZnNl
dHNbY29sb3JfcGxhbmVdICUgaW50ZWxfdGlsZV9zaXplKGRldl9wcml2KSkgewo+ICsJICAgIGZi
LT5vZmZzZXRzW2NvbG9yX3BsYW5lXSAlIGludGVsX3RpbGVfc2l6ZShpOTE1KSkgewo+ICAgCQlE
Uk1fREVCVUdfS01TKCJNaXNhbGlnbmVkIG9mZnNldCAweCUwOHggZm9yIGNvbG9yIHBsYW5lICVk
XG4iLAo+ICAgCQkJICAgICAgZmItPm9mZnNldHNbY29sb3JfcGxhbmVdLCBjb2xvcl9wbGFuZSk7
Cj4gICAJCXJldHVybiAtRUlOVkFMOwo+IEBAIC0yNTA3LDcgKzI1MDcsNyBAQCBib29sIGlzX2Nj
c19tb2RpZmllcih1NjQgbW9kaWZpZXIpCj4gICAJICAgICAgIG1vZGlmaWVyID09IEk5MTVfRk9S
TUFUX01PRF9ZZl9USUxFRF9DQ1M7Cj4gICB9Cj4gICAKPiAtdTMyIGludGVsX3BsYW5lX2ZiX21h
eF9zdHJpZGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICt1MzIgaW50ZWxf
cGxhbmVfZmJfbWF4X3N0cmlkZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJ
CSAgICAgIHUzMiBwaXhlbF9mb3JtYXQsIHU2NCBtb2RpZmllcikKPiAgIHsKPiAgIAlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YzsKPiBAQCAtMjUxNyw3ICsyNTE3LDcgQEAgdTMyIGludGVsX3BsYW5l
X2ZiX21heF9zdHJpZGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCSAq
IFdlIGFzc3VtZSB0aGUgcHJpbWFyeSBwbGFuZSBmb3IgcGlwZSBBIGhhcwo+ICAgCSAqIHRoZSBo
aWdoZXN0IHN0cmlkZSBsaW1pdHMgb2YgdGhlbSBhbGwuCj4gICAJICovCj4gLQljcnRjID0gaW50
ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIFBJUEVfQSk7Cj4gKwljcnRjID0gaW50ZWxf
Z2V0X2NydGNfZm9yX3BpcGUoaTkxNSwgUElQRV9BKTsKPiAgIAlwbGFuZSA9IHRvX2ludGVsX3Bs
YW5lKGNydGMtPmJhc2UucHJpbWFyeSk7Cj4gICAKPiAgIAlyZXR1cm4gcGxhbmUtPm1heF9zdHJp
ZGUocGxhbmUsIHBpeGVsX2Zvcm1hdCwgbW9kaWZpZXIsCj4gQEAgLTI1MjUsNyArMjUyNSw3IEBA
IHUzMiBpbnRlbF9wbGFuZV9mYl9tYXhfc3RyaWRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiAgIH0KPiAgIAo+ICAgc3RhdGljCj4gLXUzMiBpbnRlbF9mYl9tYXhfc3RyaWRl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArdTMyIGludGVsX2ZiX21heF9z
dHJpZGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQl1MzIgcGl4ZWxfZm9y
bWF0LCB1NjQgbW9kaWZpZXIpCj4gICB7Cj4gICAJLyoKPiBAQCAtMjUzNSwyMiArMjUzNSwyMiBA
QCB1MzIgaW50ZWxfZmJfbWF4X3N0cmlkZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gICAJICogVGhlIG5ldyBDQ1MgaGFzaCBtb2RlIG1ha2VzIHJlbWFwcGluZyBpbXBvc3Np
YmxlCj4gICAJICovCj4gICAJaWYgKCFpc19jY3NfbW9kaWZpZXIobW9kaWZpZXIpKSB7Cj4gLQkJ
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNykKPiArCQlpZiAoSU5URUxfR0VOKGk5MTUpID49
IDcpCj4gICAJCQlyZXR1cm4gMjU2KjEwMjQ7Cj4gLQkJZWxzZSBpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA+PSA0KQo+ICsJCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA0KQo+ICAgCQkJcmV0
dXJuIDEyOCoxMDI0Owo+ICAgCX0KPiAgIAo+IC0JcmV0dXJuIGludGVsX3BsYW5lX2ZiX21heF9z
dHJpZGUoZGV2X3ByaXYsIHBpeGVsX2Zvcm1hdCwgbW9kaWZpZXIpOwo+ICsJcmV0dXJuIGludGVs
X3BsYW5lX2ZiX21heF9zdHJpZGUoaTkxNSwgcGl4ZWxfZm9ybWF0LCBtb2RpZmllcik7Cj4gICB9
Cj4gICAKPiAgIHN0YXRpYyB1MzIKPiAgIGludGVsX2ZiX3N0cmlkZV9hbGlnbm1lbnQoY29uc3Qg
c3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIsIGludCBjb2xvcl9wbGFuZSkKPiAgIHsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZmItPmRldik7Cj4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZmItPmRldik7Cj4gICAKPiAg
IAlpZiAoZmItPm1vZGlmaWVyID09IERSTV9GT1JNQVRfTU9EX0xJTkVBUikgewo+IC0JCXUzMiBt
YXhfc3RyaWRlID0gaW50ZWxfcGxhbmVfZmJfbWF4X3N0cmlkZShkZXZfcHJpdiwKPiArCQl1MzIg
bWF4X3N0cmlkZSA9IGludGVsX3BsYW5lX2ZiX21heF9zdHJpZGUoaTkxNSwKPiAgIAkJCQkJCQkg
ICBmYi0+Zm9ybWF0LT5mb3JtYXQsCj4gICAJCQkJCQkJICAgZmItPm1vZGlmaWVyKTsKPiAgIAo+
IEBAIC0yNTU5LDcgKzI1NTksNyBAQCBpbnRlbF9mYl9zdHJpZGVfYWxpZ25tZW50KGNvbnN0IHN0
cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLCBpbnQgY29sb3JfcGxhbmUpCj4gICAJCSAqIHdlIG5l
ZWQgdGhlIHN0cmlkZSB0byBiZSBwYWdlIGFsaWduZWQuCj4gICAJCSAqLwo+ICAgCQlpZiAoZmIt
PnBpdGNoZXNbY29sb3JfcGxhbmVdID4gbWF4X3N0cmlkZSkKPiAtCQkJcmV0dXJuIGludGVsX3Rp
bGVfc2l6ZShkZXZfcHJpdik7Cj4gKwkJCXJldHVybiBpbnRlbF90aWxlX3NpemUoaTkxNSk7Cj4g
ICAJCWVsc2UKPiAgIAkJCXJldHVybiA2NDsKPiAgIAl9IGVsc2Ugewo+IEBAIC0yNTcwLDcgKzI1
NzAsNyBAQCBpbnRlbF9mYl9zdHJpZGVfYWxpZ25tZW50KGNvbnN0IHN0cnVjdCBkcm1fZnJhbWVi
dWZmZXIgKmZiLCBpbnQgY29sb3JfcGxhbmUpCj4gICBib29sIGludGVsX3BsYW5lX2Nhbl9yZW1h
cChjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+ICAgewo+ICAg
CXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUgPSB0b19pbnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+
YmFzZS5wbGFuZSk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiAgIAljb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVm
ZmVyICpmYiA9IHBsYW5lX3N0YXRlLT5iYXNlLmZiOwo+ICAgCWludCBpOwo+ICAgCj4gQEAgLTI1
ODQsNyArMjU4NCw3IEBAIGJvb2wgaW50ZWxfcGxhbmVfY2FuX3JlbWFwKGNvbnN0IHN0cnVjdCBp
bnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gICAJICogV291bGQgYWxzbyBuZWVkIHRv
IGRlYWwgd2l0aCB0aGUgZmVuY2UgUE9UIGFsaWdubWVudAo+ICAgCSAqIGFuZCBnZW4yIDJLaUIg
R1RUIHRpbGUgc2l6ZS4KPiAgIAkgKi8KPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNCkK
PiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA0KQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gICAKPiAg
IAkvKgo+IEBAIC0yNTk2LDcgKzI1OTYsNyBAQCBib29sIGludGVsX3BsYW5lX2Nhbl9yZW1hcChj
b25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+ICAgCj4gICAJLyog
TGluZWFyIG5lZWRzIGEgcGFnZSBhbGlnbmVkIHN0cmlkZSBmb3IgcmVtYXBwaW5nICovCj4gICAJ
aWYgKGZiLT5tb2RpZmllciA9PSBEUk1fRk9STUFUX01PRF9MSU5FQVIpIHsKPiAtCQl1bnNpZ25l
ZCBpbnQgYWxpZ25tZW50ID0gaW50ZWxfdGlsZV9zaXplKGRldl9wcml2KSAtIDE7Cj4gKwkJdW5z
aWduZWQgaW50IGFsaWdubWVudCA9IGludGVsX3RpbGVfc2l6ZShpOTE1KSAtIDE7Cj4gICAKPiAg
IAkJZm9yIChpID0gMDsgaSA8IGZiLT5mb3JtYXQtPm51bV9wbGFuZXM7IGkrKykgewo+ICAgCQkJ
aWYgKGZiLT5waXRjaGVzW2ldICYgYWxpZ25tZW50KQo+IEBAIC0yNjM2LDcgKzI2MzYsNyBAQCBz
dGF0aWMgYm9vbCBpbnRlbF9wbGFuZV9uZWVkc19yZW1hcChjb25zdCBzdHJ1Y3QgaW50ZWxfcGxh
bmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+ICAgfQo+ICAgCj4gICBzdGF0aWMgaW50Cj4gLWludGVs
X2ZpbGxfZmJfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2ludGVs
X2ZpbGxfZmJfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJICAgc3Ry
dWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2ZyYW1lYnVm
ZmVyICppbnRlbF9mYiA9IHRvX2ludGVsX2ZyYW1lYnVmZmVyKGZiKTsKPiBAQCAtMjY0NSw3ICsy
NjQ1LDcgQEAgaW50ZWxfZmlsbF9mYl9pbmZvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiAgIAl1MzIgZ3R0X29mZnNldF9yb3RhdGVkID0gMDsKPiAgIAl1bnNpZ25lZCBpbnQg
bWF4X3NpemUgPSAwOwo+ICAgCWludCBpLCBudW1fcGxhbmVzID0gZmItPmZvcm1hdC0+bnVtX3Bs
YW5lczsKPiAtCXVuc2lnbmVkIGludCB0aWxlX3NpemUgPSBpbnRlbF90aWxlX3NpemUoZGV2X3By
aXYpOwo+ICsJdW5zaWduZWQgaW50IHRpbGVfc2l6ZSA9IGludGVsX3RpbGVfc2l6ZShpOTE1KTsK
PiAgIAo+ICAgCWZvciAoaSA9IDA7IGkgPCBudW1fcGxhbmVzOyBpKyspIHsKPiAgIAkJdW5zaWdu
ZWQgaW50IHdpZHRoLCBoZWlnaHQ7Cj4gQEAgLTI3MTksNyArMjcxOSw3IEBAIGludGVsX2ZpbGxf
ZmJfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJCWludGVsX2Zi
LT5ub3JtYWxbaV0ueCA9IHg7Cj4gICAJCWludGVsX2ZiLT5ub3JtYWxbaV0ueSA9IHk7Cj4gICAK
PiAtCQlvZmZzZXQgPSBpbnRlbF9jb21wdXRlX2FsaWduZWRfb2Zmc2V0KGRldl9wcml2LCAmeCwg
JnksIGZiLCBpLAo+ICsJCW9mZnNldCA9IGludGVsX2NvbXB1dGVfYWxpZ25lZF9vZmZzZXQoaTkx
NSwgJngsICZ5LCBmYiwgaSwKPiAgIAkJCQkJCSAgICAgIGZiLT5waXRjaGVzW2ldLAo+ICAgCQkJ
CQkJICAgICAgRFJNX01PREVfUk9UQVRFXzAsCj4gICAJCQkJCQkgICAgICB0aWxlX3NpemUpOwo+
IEBAIC0yODAzLDE0ICsyODAzLDE0IEBAIGludGVsX2ZpbGxfZmJfaW5mbyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICBzdGF0aWMgdm9pZAo+ICAgaW50ZWxfcGxhbmVfcmVt
YXBfZ3R0KHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gICB7Cj4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPQo+ICAgCQl0b19pOTE1KHBsYW5lX3N0YXRlLT5iYXNlLnBsYW5lLT5kZXYp
Owo+ICAgCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxhbmVfc3RhdGUtPmJhc2UuZmI7
Cj4gICAJc3RydWN0IGludGVsX2ZyYW1lYnVmZmVyICppbnRlbF9mYiA9IHRvX2ludGVsX2ZyYW1l
YnVmZmVyKGZiKTsKPiAgIAlzdHJ1Y3QgaW50ZWxfcm90YXRpb25faW5mbyAqaW5mbyA9ICZwbGFu
ZV9zdGF0ZS0+dmlldy5yb3RhdGVkOwo+ICAgCXVuc2lnbmVkIGludCByb3RhdGlvbiA9IHBsYW5l
X3N0YXRlLT5iYXNlLnJvdGF0aW9uOwo+ICAgCWludCBpLCBudW1fcGxhbmVzID0gZmItPmZvcm1h
dC0+bnVtX3BsYW5lczsKPiAtCXVuc2lnbmVkIGludCB0aWxlX3NpemUgPSBpbnRlbF90aWxlX3Np
emUoZGV2X3ByaXYpOwo+ICsJdW5zaWduZWQgaW50IHRpbGVfc2l6ZSA9IGludGVsX3RpbGVfc2l6
ZShpOTE1KTsKPiAgIAl1bnNpZ25lZCBpbnQgc3JjX3gsIHNyY195Owo+ICAgCXVuc2lnbmVkIGlu
dCBzcmNfdywgc3JjX2g7Cj4gICAJdTMyIGd0dF9vZmZzZXQgPSAwOwo+IEBAIC0yODYwLDcgKzI4
NjAsNyBAQCBpbnRlbF9wbGFuZV9yZW1hcF9ndHQoc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpw
bGFuZV9zdGF0ZSkKPiAgIAkJeCArPSBpbnRlbF9mYi0+bm9ybWFsW2ldLng7Cj4gICAJCXkgKz0g
aW50ZWxfZmItPm5vcm1hbFtpXS55Owo+ICAgCj4gLQkJb2Zmc2V0ID0gaW50ZWxfY29tcHV0ZV9h
bGlnbmVkX29mZnNldChkZXZfcHJpdiwgJngsICZ5LAo+ICsJCW9mZnNldCA9IGludGVsX2NvbXB1
dGVfYWxpZ25lZF9vZmZzZXQoaTkxNSwgJngsICZ5LAo+ICAgCQkJCQkJICAgICAgZmIsIGksIGZi
LT5waXRjaGVzW2ldLAo+ICAgCQkJCQkJICAgICAgRFJNX01PREVfUk9UQVRFXzAsIHRpbGVfc2l6
ZSk7Cj4gICAJCW9mZnNldCAvPSB0aWxlX3NpemU7Cj4gQEAgLTMwNDYsNyArMzA0Niw3IEBAIGlu
dGVsX2FsbG9jX2luaXRpYWxfcGxhbmVfb2JqKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAg
CQkJICAgICAgc3RydWN0IGludGVsX2luaXRpYWxfcGxhbmVfY29uZmlnICpwbGFuZV9jb25maWcp
Cj4gICB7Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmJhc2UuZGV2Owo+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IE5VTEw7Cj4gICAJc3RydWN0IGRybV9tb2RlX2ZiX2Nt
ZDIgbW9kZV9jbWQgPSB7IDAgfTsKPiAgIAlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9ICZw
bGFuZV9jb25maWctPmZiLT5iYXNlOwo+IEBAIC0zMDYyLDcgKzMwNjIsNyBAQCBpbnRlbF9hbGxv
Y19pbml0aWFsX3BsYW5lX29iaihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAkvKiBJZiB0
aGUgRkIgaXMgdG9vIGJpZywganVzdCBkb24ndCB1c2UgaXQgc2luY2UgZmJkZXYgaXMgbm90IHZl
cnkKPiAgIAkgKiBpbXBvcnRhbnQgYW5kIHdlIHNob3VsZCBwcm9iYWJseSB1c2UgdGhhdCBzcGFj
ZSB3aXRoIEZCQyBvciBvdGhlcgo+ICAgCSAqIGZlYXR1cmVzLiAqLwo+IC0JaWYgKHNpemVfYWxp
Z25lZCAqIDIgPiBkZXZfcHJpdi0+c3RvbGVuX3VzYWJsZV9zaXplKQo+ICsJaWYgKHNpemVfYWxp
Z25lZCAqIDIgPiBpOTE1LT5zdG9sZW5fdXNhYmxlX3NpemUpCj4gICAJCXJldHVybiBmYWxzZTsK
PiAgIAo+ICAgCXN3aXRjaCAoZmItPm1vZGlmaWVyKSB7Cj4gQEAgLTMwNzcsNyArMzA3Nyw3IEBA
IGludGVsX2FsbG9jX2luaXRpYWxfcGxhbmVfb2JqKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+
ICAgCX0KPiAgIAo+ICAgCW11dGV4X2xvY2soJmRldi0+c3RydWN0X211dGV4KTsKPiAtCW9iaiA9
IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfc3RvbGVuX2Zvcl9wcmVhbGxvY2F0ZWQoZGV2X3ByaXYs
Cj4gKwlvYmogPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3N0b2xlbl9mb3JfcHJlYWxsb2NhdGVk
KGk5MTUsCj4gICAJCQkJCQkJICAgICBiYXNlX2FsaWduZWQsCj4gICAJCQkJCQkJICAgICBiYXNl
X2FsaWduZWQsCj4gICAJCQkJCQkJICAgICBzaXplX2FsaWduZWQpOwo+IEBAIC0zMTM1LDcgKzMx
MzUsNyBAQCBpbnRlbF9zZXRfcGxhbmVfdmlzaWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSwKPiAgIAo+ICAgc3RhdGljIHZvaWQgZml4dXBfYWN0aXZlX3BsYW5lcyhzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGNfc3RhdGUt
PmJhc2UuY3J0Yy0+ZGV2KTsKPiAgIAlzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZTsKPiAgIAo+ICAg
CS8qCj4gQEAgLTMxNDUsNyArMzE0NSw3IEBAIHN0YXRpYyB2b2lkIGZpeHVwX2FjdGl2ZV9wbGFu
ZXMoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICAJICovCj4gICAJY3J0
Y19zdGF0ZS0+YWN0aXZlX3BsYW5lcyA9IDA7Cj4gICAKPiAtCWRybV9mb3JfZWFjaF9wbGFuZV9t
YXNrKHBsYW5lLCAmZGV2X3ByaXYtPmRybSwKPiArCWRybV9mb3JfZWFjaF9wbGFuZV9tYXNrKHBs
YW5lLCAmaTkxNS0+ZHJtLAo+ICAgCQkJCWNydGNfc3RhdGUtPmJhc2UucGxhbmVfbWFzaykKPiAg
IAkJY3J0Y19zdGF0ZS0+YWN0aXZlX3BsYW5lcyB8PSBCSVQodG9faW50ZWxfcGxhbmUocGxhbmUp
LT5pZCk7Cj4gICB9Cj4gQEAgLTMxNzcsNyArMzE3Nyw3IEBAIGludGVsX2ZpbmRfaW5pdGlhbF9w
bGFuZV9vYmooc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMsCj4gICAJCQkgICAgIHN0cnVj
dCBpbnRlbF9pbml0aWFsX3BsYW5lX2NvbmZpZyAqcGxhbmVfY29uZmlnKQo+ICAgewo+ICAgCXN0
cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBpbnRlbF9jcnRjLT5iYXNlLmRldjsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXN0cnVjdCBkcm1fY3J0YyAq
YzsKPiAgIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwo+ICAgCXN0cnVjdCBkcm1f
cGxhbmUgKnByaW1hcnkgPSBpbnRlbF9jcnRjLT5iYXNlLnByaW1hcnk7Cj4gQEAgLTMyNzIsNyAr
MzI3Miw3IEBAIGludGVsX2ZpbmRfaW5pdGlhbF9wbGFuZV9vYmooc3RydWN0IGludGVsX2NydGMg
KmludGVsX2NydGMsCj4gICAJaW50ZWxfc3RhdGUtPmJhc2UuZHN0ID0gZHJtX3BsYW5lX3N0YXRl
X2Rlc3QocGxhbmVfc3RhdGUpOwo+ICAgCj4gICAJaWYgKGk5MTVfZ2VtX29iamVjdF9pc190aWxl
ZChvYmopKQo+IC0JCWRldl9wcml2LT5wcmVzZXJ2ZV9iaW9zX3N3aXp6bGUgPSB0cnVlOwo+ICsJ
CWk5MTUtPnByZXNlcnZlX2Jpb3Nfc3dpenpsZSA9IHRydWU7Cj4gICAKPiAgIAlwbGFuZV9zdGF0
ZS0+ZmIgPSBmYjsKPiAgIAlwbGFuZV9zdGF0ZS0+Y3J0YyA9ICZpbnRlbF9jcnRjLT5iYXNlOwo+
IEBAIC0zMzgxLDcgKzMzODEsNyBAQCBzdGF0aWMgYm9vbCBza2xfY2hlY2tfbWFpbl9jY3NfY29v
cmRpbmF0ZXMoc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZQo+ICAgCj4gICBz
dGF0aWMgaW50IHNrbF9jaGVja19tYWluX3N1cmZhY2Uoc3RydWN0IGludGVsX3BsYW5lX3N0YXRl
ICpwbGFuZV9zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUocGxhbmVfc3RhdGUtPmJhc2UucGxhbmUtPmRldik7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUocGxhbmVfc3RhdGUtPmJhc2UucGxhbmUtPmRl
dik7Cj4gICAJY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBwbGFuZV9zdGF0ZS0+
YmFzZS5mYjsKPiAgIAl1bnNpZ25lZCBpbnQgcm90YXRpb24gPSBwbGFuZV9zdGF0ZS0+YmFzZS5y
b3RhdGlvbjsKPiAgIAlpbnQgeCA9IHBsYW5lX3N0YXRlLT5iYXNlLnNyYy54MSA+PiAxNjsKPiBA
QCAtMzM5Miw5ICszMzkyLDkgQEAgc3RhdGljIGludCBza2xfY2hlY2tfbWFpbl9zdXJmYWNlKHN0
cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gICAJaW50IG1heF9oZWlnaHQg
PSA0MDk2Owo+ICAgCXUzMiBhbGlnbm1lbnQsIG9mZnNldCwgYXV4X29mZnNldCA9IHBsYW5lX3N0
YXRlLT5jb2xvcl9wbGFuZVsxXS5vZmZzZXQ7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDExKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiAgIAkJbWF4X3dpZHRo
ID0gaWNsX21heF9wbGFuZV93aWR0aChmYiwgMCwgcm90YXRpb24pOwo+IC0JZWxzZSBpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA+PSAxMCB8fCBJU19HRU1JTklMQUtFKGRldl9wcml2KSkKPiArCWVs
c2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMCB8fCBJU19HRU1JTklMQUtFKGk5MTUpKQo+ICAg
CQltYXhfd2lkdGggPSBnbGtfbWF4X3BsYW5lX3dpZHRoKGZiLCAwLCByb3RhdGlvbik7Cj4gICAJ
ZWxzZQo+ICAgCQltYXhfd2lkdGggPSBza2xfbWF4X3BsYW5lX3dpZHRoKGZiLCAwLCByb3RhdGlv
bik7Cj4gQEAgLTM1NjQsMTYgKzM1NjQsMTYgQEAgaTl4eF9wbGFuZV9tYXhfc3RyaWRlKHN0cnVj
dCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gICAJCSAgICAgIHUzMiBwaXhlbF9mb3JtYXQsIHU2NCBt
b2RpZmllciwKPiAgIAkJICAgICAgdW5zaWduZWQgaW50IHJvdGF0aW9uKQo+ICAgewo+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KHBsYW5lLT5iYXNl
LmRldik7Cj4gICAKPiAtCWlmICghSEFTX0dNQ0goZGV2X3ByaXYpKSB7Cj4gKwlpZiAoIUhBU19H
TUNIKGk5MTUpKSB7Cj4gICAJCXJldHVybiAzMioxMDI0Owo+IC0JfSBlbHNlIGlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDQpIHsKPiArCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDQp
IHsKPiAgIAkJaWYgKG1vZGlmaWVyID09IEk5MTVfRk9STUFUX01PRF9YX1RJTEVEKQo+ICAgCQkJ
cmV0dXJuIDE2KjEwMjQ7Cj4gICAJCWVsc2UKPiAgIAkJCXJldHVybiAzMioxMDI0Owo+IC0JfSBl
bHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDMpIHsKPiArCX0gZWxzZSBpZiAoSU5URUxf
R0VOKGk5MTUpID49IDMpIHsKPiAgIAkJaWYgKG1vZGlmaWVyID09IEk5MTVfRk9STUFUX01PRF9Y
X1RJTEVEKQo+ICAgCQkJcmV0dXJuIDgqMTAyNDsKPiAgIAkJZWxzZQo+IEBAIC0zNTg5LDcgKzM1
ODksNyBAQCBpOXh4X3BsYW5lX21heF9zdHJpZGUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwK
PiAgIHN0YXRpYyB1MzIgaTl4eF9wbGFuZV9jdGxfY3J0Yyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9
IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAl1
MzIgZHNwY250ciA9IDA7Cj4gICAKPiAgIAlpZiAoY3J0Y19zdGF0ZS0+Z2FtbWFfZW5hYmxlKQo+
IEBAIC0zNTk4LDcgKzM1OTgsNyBAQCBzdGF0aWMgdTMyIGk5eHhfcGxhbmVfY3RsX2NydGMoY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICAJaWYgKGNydGNfc3Rh
dGUtPmNzY19lbmFibGUpCj4gICAJCWRzcGNudHIgfD0gRElTUFBMQU5FX1BJUEVfQ1NDX0VOQUJM
RTsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA1KQo+ICsJaWYgKElOVEVMX0dF
TihpOTE1KSA8IDUpCj4gICAJCWRzcGNudHIgfD0gRElTUFBMQU5FX1NFTF9QSVBFKGNydGMtPnBp
cGUpOwo+ICAgCj4gICAJcmV0dXJuIGRzcGNudHI7Cj4gQEAgLTM2MDcsNyArMzYwNyw3IEBAIHN0
YXRpYyB1MzIgaTl4eF9wbGFuZV9jdGxfY3J0Yyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSkKPiAgIHN0YXRpYyB1MzIgaTl4eF9wbGFuZV9jdGwoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICAJCQkgIGNvbnN0IHN0cnVjdCBpbnRl
bF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPQo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPQo+ICAg
CQl0b19pOTE1KHBsYW5lX3N0YXRlLT5iYXNlLnBsYW5lLT5kZXYpOwo+ICAgCWNvbnN0IHN0cnVj
dCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxhbmVfc3RhdGUtPmJhc2UuZmI7Cj4gICAJdW5zaWdu
ZWQgaW50IHJvdGF0aW9uID0gcGxhbmVfc3RhdGUtPmJhc2Uucm90YXRpb247Cj4gQEAgLTM2MTUs
OCArMzYxNSw4IEBAIHN0YXRpYyB1MzIgaTl4eF9wbGFuZV9jdGwoY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICAKPiAgIAlkc3BjbnRyID0gRElTUExBWV9QTEFO
RV9FTkFCTEU7Cj4gICAKPiAtCWlmIChJU19HNFgoZGV2X3ByaXYpIHx8IElTX0dFTihkZXZfcHJp
diwgNSkgfHwKPiAtCSAgICBJU19HRU4oZGV2X3ByaXYsIDYpIHx8IElTX0lWWUJSSURHRShkZXZf
cHJpdikpCj4gKwlpZiAoSVNfRzRYKGk5MTUpIHx8IElTX0dFTihpOTE1LCA1KSB8fAo+ICsJICAg
IElTX0dFTihpOTE1LCA2KSB8fCBJU19JVllCUklER0UoaTkxNSkpCj4gICAJCWRzcGNudHIgfD0g
RElTUFBMQU5FX1RSSUNLTEVfRkVFRF9ESVNBQkxFOwo+ICAgCj4gICAJc3dpdGNoIChmYi0+Zm9y
bWF0LT5mb3JtYXQpIHsKPiBAQCAtMzY0Niw3ICszNjQ2LDcgQEAgc3RhdGljIHUzMiBpOXh4X3Bs
YW5lX2N0bChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJ
cmV0dXJuIDA7Cj4gICAJfQo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA0ICYm
Cj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDQgJiYKPiAgIAkgICAgZmItPm1vZGlmaWVyID09
IEk5MTVfRk9STUFUX01PRF9YX1RJTEVEKQo+ICAgCQlkc3BjbnRyIHw9IERJU1BQTEFORV9USUxF
RDsKPiAgIAo+IEBAIC0zNjYxLDcgKzM2NjEsNyBAQCBzdGF0aWMgdTMyIGk5eHhfcGxhbmVfY3Rs
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCj4gICBpbnQg
aTl4eF9jaGVja19wbGFuZV9zdXJmYWNlKHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVf
c3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPQo+ICAgCQl0b19pOTE1KHBsYW5lX3N0YXRl
LT5iYXNlLnBsYW5lLT5kZXYpOwo+ICAgCWludCBzcmNfeCwgc3JjX3k7Cj4gICAJdTMyIG9mZnNl
dDsKPiBAQCAtMzY3OSw3ICszNjc5LDcgQEAgaW50IGk5eHhfY2hlY2tfcGxhbmVfc3VyZmFjZShz
dHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+ICAgCj4gICAJaW50ZWxfYWRk
X2ZiX29mZnNldHMoJnNyY194LCAmc3JjX3ksIHBsYW5lX3N0YXRlLCAwKTsKPiAgIAo+IC0JaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNCkK
PiAgIAkJb2Zmc2V0ID0gaW50ZWxfcGxhbmVfY29tcHV0ZV9hbGlnbmVkX29mZnNldCgmc3JjX3gs
ICZzcmNfeSwKPiAgIAkJCQkJCQkgICAgcGxhbmVfc3RhdGUsIDApOwo+ICAgCWVsc2UKPiBAQCAt
MzY5NCw3ICszNjk0LDcgQEAgaW50IGk5eHhfY2hlY2tfcGxhbmVfc3VyZmFjZShzdHJ1Y3QgaW50
ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+ICAgCQkJICAgKHNyY195IDw8IDE2KSAtIHBs
YW5lX3N0YXRlLT5iYXNlLnNyYy55MSk7Cj4gICAKPiAgIAkvKiBIU1cvQkRXIGRvIHRoaXMgYXV0
b21hZ2ljYWxseSBpbiBoYXJkd2FyZSAqLwo+IC0JaWYgKCFJU19IQVNXRUxMKGRldl9wcml2KSAm
JiAhSVNfQlJPQURXRUxMKGRldl9wcml2KSkgewo+ICsJaWYgKCFJU19IQVNXRUxMKGk5MTUpICYm
ICFJU19CUk9BRFdFTEwoaTkxNSkpIHsKPiAgIAkJdW5zaWduZWQgaW50IHJvdGF0aW9uID0gcGxh
bmVfc3RhdGUtPmJhc2Uucm90YXRpb247Cj4gICAJCWludCBzcmNfdyA9IGRybV9yZWN0X3dpZHRo
KCZwbGFuZV9zdGF0ZS0+YmFzZS5zcmMpID4+IDE2Owo+ICAgCQlpbnQgc3JjX2ggPSBkcm1fcmVj
dF9oZWlnaHQoJnBsYW5lX3N0YXRlLT5iYXNlLnNyYykgPj4gMTY7Cj4gQEAgLTM3NTIsNyArMzc1
Miw3IEBAIHN0YXRpYyB2b2lkIGk5eHhfdXBkYXRlX3BsYW5lKHN0cnVjdCBpbnRlbF9wbGFuZSAq
cGxhbmUsCj4gICAJCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSwKPiAgIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVf
c3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiAgIAllbnVtIGk5eHhfcGxhbmVfaWQgaTl4eF9w
bGFuZSA9IHBsYW5lLT5pOXh4X3BsYW5lOwo+ICAgCXUzMiBsaW5lYXJfb2Zmc2V0Owo+ICAgCWlu
dCB4ID0gcGxhbmVfc3RhdGUtPmNvbG9yX3BsYW5lWzBdLng7Cj4gQEAgLTM3NjUsMTYgKzM3NjUs
MTYgQEAgc3RhdGljIHZvaWQgaTl4eF91cGRhdGVfcGxhbmUoc3RydWN0IGludGVsX3BsYW5lICpw
bGFuZSwKPiAgIAo+ICAgCWxpbmVhcl9vZmZzZXQgPSBpbnRlbF9mYl94eV90b19saW5lYXIoeCwg
eSwgcGxhbmVfc3RhdGUsIDApOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA0
KQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA0KQo+ICAgCQlkc3BhZGRyX29mZnNldCA9IHBs
YW5lX3N0YXRlLT5jb2xvcl9wbGFuZVswXS5vZmZzZXQ7Cj4gICAJZWxzZQo+ICAgCQlkc3BhZGRy
X29mZnNldCA9IGxpbmVhcl9vZmZzZXQ7Cj4gICAKPiAtCXNwaW5fbG9ja19pcnFzYXZlKCZkZXZf
cHJpdi0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiArCXNwaW5fbG9ja19pcnFzYXZlKCZpOTE1
LT51bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ICAgCj4gICAJSTkxNV9XUklURV9GVyhEU1BTVFJJ
REUoaTl4eF9wbGFuZSksIHBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVswXS5zdHJpZGUpOwo+ICAg
Cj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDQpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkx
NSkgPCA0KSB7Cj4gICAJCS8qIHBpcGVzcmMgYW5kIGRzcHNpemUgY29udHJvbCB0aGUgc2l6ZSB0
aGF0IGlzIHNjYWxlZCBmcm9tLAo+ICAgCQkgKiB3aGljaCBzaG91bGQgYWx3YXlzIGJlIHRoZSB1
c2VyJ3MgcmVxdWVzdGVkIHNpemUuCj4gICAJCSAqLwo+IEBAIC0zNzgyLDcgKzM3ODIsNyBAQCBz
dGF0aWMgdm9pZCBpOXh4X3VwZGF0ZV9wbGFuZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+
ICAgCQlJOTE1X1dSSVRFX0ZXKERTUFNJWkUoaTl4eF9wbGFuZSksCj4gICAJCQkgICAgICAoKGNy
dGNfc3RhdGUtPnBpcGVfc3JjX2ggLSAxKSA8PCAxNikgfAo+ICAgCQkJICAgICAgKGNydGNfc3Rh
dGUtPnBpcGVfc3JjX3cgLSAxKSk7Cj4gLQl9IGVsc2UgaWYgKElTX0NIRVJSWVZJRVcoZGV2X3By
aXYpICYmIGk5eHhfcGxhbmUgPT0gUExBTkVfQikgewo+ICsJfSBlbHNlIGlmIChJU19DSEVSUllW
SUVXKGk5MTUpICYmIGk5eHhfcGxhbmUgPT0gUExBTkVfQikgewo+ICAgCQlJOTE1X1dSSVRFX0ZX
KFBSSU1QT1MoaTl4eF9wbGFuZSksIDApOwo+ICAgCQlJOTE1X1dSSVRFX0ZXKFBSSU1TSVpFKGk5
eHhfcGxhbmUpLAo+ICAgCQkJICAgICAgKChjcnRjX3N0YXRlLT5waXBlX3NyY19oIC0gMSkgPDwg
MTYpIHwKPiBAQCAtMzc5MCw5ICszNzkwLDkgQEAgc3RhdGljIHZvaWQgaTl4eF91cGRhdGVfcGxh
bmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiAgIAkJSTkxNV9XUklURV9GVyhQUklNQ05T
VEFMUEhBKGk5eHhfcGxhbmUpLCAwKTsKPiAgIAl9Cj4gICAKPiAtCWlmIChJU19IQVNXRUxMKGRl
dl9wcml2KSB8fCBJU19CUk9BRFdFTEwoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfSEFTV0VMTChp
OTE1KSB8fCBJU19CUk9BRFdFTEwoaTkxNSkpIHsKPiAgIAkJSTkxNV9XUklURV9GVyhEU1BPRkZT
RVQoaTl4eF9wbGFuZSksICh5IDw8IDE2KSB8IHgpOwo+IC0JfSBlbHNlIGlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDQpIHsKPiArCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDQpIHsK
PiAgIAkJSTkxNV9XUklURV9GVyhEU1BMSU5PRkYoaTl4eF9wbGFuZSksIGxpbmVhcl9vZmZzZXQp
Owo+ICAgCQlJOTE1X1dSSVRFX0ZXKERTUFRJTEVPRkYoaTl4eF9wbGFuZSksICh5IDw8IDE2KSB8
IHgpOwo+ICAgCX0KPiBAQCAtMzgwMyw3ICszODAzLDcgQEAgc3RhdGljIHZvaWQgaTl4eF91cGRh
dGVfcGxhbmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiAgIAkgKiB0aGUgY29udHJvbCBy
ZWdpc3RlciBqdXN0IGJlZm9yZSB0aGUgc3VyZmFjZSByZWdpc3Rlci4KPiAgIAkgKi8KPiAgIAlJ
OTE1X1dSSVRFX0ZXKERTUENOVFIoaTl4eF9wbGFuZSksIGRzcGNudHIpOwo+IC0JaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPj0gNCkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNCkKPiAgIAkJ
STkxNV9XUklURV9GVyhEU1BTVVJGKGk5eHhfcGxhbmUpLAo+ICAgCQkJICAgICAgaW50ZWxfcGxh
bmVfZ2d0dF9vZmZzZXQocGxhbmVfc3RhdGUpICsKPiAgIAkJCSAgICAgIGRzcGFkZHJfb2Zmc2V0
KTsKPiBAQCAtMzgxMiwxMyArMzgxMiwxMyBAQCBzdGF0aWMgdm9pZCBpOXh4X3VwZGF0ZV9wbGFu
ZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ICAgCQkJICAgICAgaW50ZWxfcGxhbmVfZ2d0
dF9vZmZzZXQocGxhbmVfc3RhdGUpICsKPiAgIAkJCSAgICAgIGRzcGFkZHJfb2Zmc2V0KTsKPiAg
IAo+IC0Jc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZGV2X3ByaXYtPnVuY29yZS5sb2NrLCBpcnFm
bGFncyk7Cj4gKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpOTE1LT51bmNvcmUubG9jaywgaXJx
ZmxhZ3MpOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZCBpOXh4X2Rpc2FibGVfcGxhbmUoc3Ry
dWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiAgIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ICAgCWVudW0gaTl4
eF9wbGFuZV9pZCBpOXh4X3BsYW5lID0gcGxhbmUtPmk5eHhfcGxhbmU7Cj4gICAJdW5zaWduZWQg
bG9uZyBpcnFmbGFnczsKPiAgIAl1MzIgZHNwY250cjsKPiBAQCAtMzgzNSwyMSArMzgzNSwyMSBA
QCBzdGF0aWMgdm9pZCBpOXh4X2Rpc2FibGVfcGxhbmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFu
ZSwKPiAgIAkgKi8KPiAgIAlkc3BjbnRyID0gaTl4eF9wbGFuZV9jdGxfY3J0YyhjcnRjX3N0YXRl
KTsKPiAgIAo+IC0Jc3Bpbl9sb2NrX2lycXNhdmUoJmRldl9wcml2LT51bmNvcmUubG9jaywgaXJx
ZmxhZ3MpOwo+ICsJc3Bpbl9sb2NrX2lycXNhdmUoJmk5MTUtPnVuY29yZS5sb2NrLCBpcnFmbGFn
cyk7Cj4gICAKPiAgIAlJOTE1X1dSSVRFX0ZXKERTUENOVFIoaTl4eF9wbGFuZSksIGRzcGNudHIp
Owo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCkKPiArCWlmIChJTlRFTF9HRU4oaTkx
NSkgPj0gNCkKPiAgIAkJSTkxNV9XUklURV9GVyhEU1BTVVJGKGk5eHhfcGxhbmUpLCAwKTsKPiAg
IAllbHNlCj4gICAJCUk5MTVfV1JJVEVfRlcoRFNQQUREUihpOXh4X3BsYW5lKSwgMCk7Cj4gICAK
PiAtCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRldl9wcml2LT51bmNvcmUubG9jaywgaXJxZmxh
Z3MpOwo+ICsJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+dW5jb3JlLmxvY2ssIGlycWZs
YWdzKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGJvb2wgaTl4eF9wbGFuZV9nZXRfaHdfc3RhdGUo
c3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiAgIAkJCQkgICAgZW51bSBwaXBlICpwaXBlKQo+
ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShwbGFu
ZS0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KHBsYW5lLT5iYXNlLmRldik7Cj4gICAJZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBw
b3dlcl9kb21haW47Cj4gICAJZW51bSBpOXh4X3BsYW5lX2lkIGk5eHhfcGxhbmUgPSBwbGFuZS0+
aTl4eF9wbGFuZTsKPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiBAQCAtMzg2Miw3ICsz
ODYyLDcgQEAgc3RhdGljIGJvb2wgaTl4eF9wbGFuZV9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVs
X3BsYW5lICpwbGFuZSwKPiAgIAkgKiBkaXNwbGF5IHBvd2VyIHdlbGxzLgo+ICAgCSAqLwo+ICAg
CXBvd2VyX2RvbWFpbiA9IFBPV0VSX0RPTUFJTl9QSVBFKHBsYW5lLT5waXBlKTsKPiAtCXdha2Vy
ZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGRldl9wcml2LCBwb3dlcl9k
b21haW4pOwo+ICsJd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQo
aTkxNSwgcG93ZXJfZG9tYWluKTsKPiAgIAlpZiAoIXdha2VyZWYpCj4gICAJCXJldHVybiBmYWxz
ZTsKPiAgIAo+IEBAIC0zODcwLDEzICszODcwLDEzIEBAIHN0YXRpYyBib29sIGk5eHhfcGxhbmVf
Z2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gICAKPiAgIAlyZXQgPSB2
YWwgJiBESVNQTEFZX1BMQU5FX0VOQUJMRTsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJp
dikgPj0gNSkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNSkKPiAgIAkJKnBpcGUgPSBwbGFu
ZS0+cGlwZTsKPiAgIAllbHNlCj4gICAJCSpwaXBlID0gKHZhbCAmIERJU1BQTEFORV9TRUxfUElQ
RV9NQVNLKSA+Pgo+ICAgCQkJRElTUFBMQU5FX1NFTF9QSVBFX1NISUZUOwo+ICAgCj4gLQlpbnRl
bF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwgcG93ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiAr
CWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5MTUsIHBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4g
ICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+IEBAIC0zODg0LDcgKzM4ODQsNyBAQCBzdGF0aWMg
Ym9vbCBpOXh4X3BsYW5lX2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+
ICAgc3RhdGljIHZvaWQgc2tsX2RldGFjaF9zY2FsZXIoc3RydWN0IGludGVsX2NydGMgKmludGVs
X2NydGMsIGludCBpZCkKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gaW50ZWxf
Y3J0Yy0+YmFzZS5kZXY7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
ZGV2KTsKPiAgIAo+ICAgCUk5MTVfV1JJVEUoU0tMX1BTX0NUUkwoaW50ZWxfY3J0Yy0+cGlwZSwg
aWQpLCAwKTsKPiAgIAlJOTE1X1dSSVRFKFNLTF9QU19XSU5fUE9TKGludGVsX2NydGMtPnBpcGUs
IGlkKSwgMCk7Cj4gQEAgLTQwOTEsMTAgKzQwOTEsMTAgQEAgc3RhdGljIHUzMiBjbmxfcGxhbmVf
Y3RsX2ZsaXAodW5zaWduZWQgaW50IHJlZmxlY3QpCj4gICAKPiAgIHUzMiBza2xfcGxhbmVfY3Rs
X2NydGMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUt
PmJhc2UuY3J0Yy0+ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gICAJdTMyIHBsYW5lX2N0bCA9IDA7
Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwIHx8IElTX0dFTUlOSUxBS0Uo
ZGV2X3ByaXYpKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMCB8fCBJU19HRU1JTklMQUtF
KGk5MTUpKQo+ICAgCQlyZXR1cm4gcGxhbmVfY3RsOwo+ICAgCj4gICAJaWYgKGNydGNfc3RhdGUt
PmdhbW1hX2VuYWJsZSkKPiBAQCAtNDEwOSw3ICs0MTA5LDcgQEAgdTMyIHNrbF9wbGFuZV9jdGxf
Y3J0Yyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHUzMiBz
a2xfcGxhbmVfY3RsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+
ICAgCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPQo+ICAgCQl0b19pOTE1KHBsYW5lX3N0YXRlLT5iYXNlLnBsYW5l
LT5kZXYpOwo+ICAgCWNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxhbmVfc3Rh
dGUtPmJhc2UuZmI7Cj4gICAJdW5zaWduZWQgaW50IHJvdGF0aW9uID0gcGxhbmVfc3RhdGUtPmJh
c2Uucm90YXRpb247Cj4gQEAgLTQxMTgsNyArNDExOCw3IEBAIHUzMiBza2xfcGxhbmVfY3RsKGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCj4gICAJcGxhbmVf
Y3RsID0gUExBTkVfQ1RMX0VOQUJMRTsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
PCAxMCAmJiAhSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkx
NSkgPCAxMCAmJiAhSVNfR0VNSU5JTEFLRShpOTE1KSkgewo+ICAgCQlwbGFuZV9jdGwgfD0gc2ts
X3BsYW5lX2N0bF9hbHBoYShwbGFuZV9zdGF0ZSk7Cj4gICAJCXBsYW5lX2N0bCB8PSBQTEFORV9D
VExfUExBTkVfR0FNTUFfRElTQUJMRTsKPiAgIAo+IEBAIC00MTMzLDcgKzQxMzMsNyBAQCB1MzIg
c2tsX3BsYW5lX2N0bChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwK
PiAgIAlwbGFuZV9jdGwgfD0gc2tsX3BsYW5lX2N0bF90aWxpbmcoZmItPm1vZGlmaWVyKTsKPiAg
IAlwbGFuZV9jdGwgfD0gc2tsX3BsYW5lX2N0bF9yb3RhdGUocm90YXRpb24gJiBEUk1fTU9ERV9S
T1RBVEVfTUFTSyk7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwKQo+ICsJ
aWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMCkKPiAgIAkJcGxhbmVfY3RsIHw9IGNubF9wbGFuZV9j
dGxfZmxpcChyb3RhdGlvbiAmCj4gICAJCQkJCQlEUk1fTU9ERV9SRUZMRUNUX01BU0spOwo+ICAg
Cj4gQEAgLTQxNDcsMTAgKzQxNDcsMTAgQEAgdTMyIHNrbF9wbGFuZV9jdGwoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICAKPiAgIHUzMiBnbGtfcGxhbmVfY29s
b3JfY3RsX2NydGMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNf
c3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gICAJdTMyIHBsYW5lX2Nv
bG9yX2N0bCA9IDA7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQo+ICsJ
aWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiAgIAkJcmV0dXJuIHBsYW5lX2NvbG9yX2N0bDsK
PiAgIAo+ICAgCWlmIChjcnRjX3N0YXRlLT5nYW1tYV9lbmFibGUpCj4gQEAgLTQxNjUsNyArNDE2
NSw3IEBAIHUzMiBnbGtfcGxhbmVfY29sb3JfY3RsX2NydGMoY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB1MzIgZ2xrX3BsYW5lX2NvbG9yX2N0bChjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJCWNvbnN0IHN0cnVjdCBp
bnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPQo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPQo+
ICAgCQl0b19pOTE1KHBsYW5lX3N0YXRlLT5iYXNlLnBsYW5lLT5kZXYpOwo+ICAgCWNvbnN0IHN0
cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxhbmVfc3RhdGUtPmJhc2UuZmI7Cj4gICAJc3Ry
dWN0IGludGVsX3BsYW5lICpwbGFuZSA9IHRvX2ludGVsX3BsYW5lKHBsYW5lX3N0YXRlLT5iYXNl
LnBsYW5lKTsKPiBAQCAtNDE3NCw3ICs0MTc0LDcgQEAgdTMyIGdsa19wbGFuZV9jb2xvcl9jdGwo
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICAJcGxhbmVfY29s
b3JfY3RsIHw9IFBMQU5FX0NPTE9SX1BMQU5FX0dBTU1BX0RJU0FCTEU7Cj4gICAJcGxhbmVfY29s
b3JfY3RsIHw9IGdsa19wbGFuZV9jb2xvcl9jdGxfYWxwaGEocGxhbmVfc3RhdGUpOwo+ICAgCj4g
LQlpZiAoZmItPmZvcm1hdC0+aXNfeXV2ICYmICFpY2xfaXNfaGRyX3BsYW5lKGRldl9wcml2LCBw
bGFuZS0+aWQpKSB7Cj4gKwlpZiAoZmItPmZvcm1hdC0+aXNfeXV2ICYmICFpY2xfaXNfaGRyX3Bs
YW5lKGk5MTUsIHBsYW5lLT5pZCkpIHsKPiAgIAkJaWYgKHBsYW5lX3N0YXRlLT5iYXNlLmNvbG9y
X2VuY29kaW5nID09IERSTV9DT0xPUl9ZQ0JDUl9CVDcwOSkKPiAgIAkJCXBsYW5lX2NvbG9yX2N0
bCB8PSBQTEFORV9DT0xPUl9DU0NfTU9ERV9ZVVY3MDlfVE9fUkdCNzA5Owo+ICAgCQllbHNlCj4g
QEAgLTQyMjgsMzEgKzQyMjgsMzEgQEAgX19pbnRlbF9kaXNwbGF5X3Jlc3VtZShzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2LAo+ICAgCXJldHVybiByZXQ7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGJvb2wg
Z3B1X3Jlc2V0X2Nsb2JiZXJzX2Rpc3BsYXkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICtzdGF0aWMgYm9vbCBncHVfcmVzZXRfY2xvYmJlcnNfZGlzcGxheShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXJldHVybiAoSU5URUxfSU5GTyhkZXZfcHJp
diktPmdwdV9yZXNldF9jbG9iYmVyc19kaXNwbGF5ICYmCj4gLQkJaW50ZWxfaGFzX2dwdV9yZXNl
dChkZXZfcHJpdikpOwo+ICsJcmV0dXJuIChJTlRFTF9JTkZPKGk5MTUpLT5ncHVfcmVzZXRfY2xv
YmJlcnNfZGlzcGxheSAmJgo+ICsJCWludGVsX2hhc19ncHVfcmVzZXQoaTkxNSkpOwo+ICAgfQo+
ICAgCj4gLXZvaWQgaW50ZWxfcHJlcGFyZV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gK3ZvaWQgaW50ZWxfcHJlcGFyZV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYt
PmRybTsKPiAtCXN0cnVjdCBkcm1fbW9kZXNldF9hY3F1aXJlX2N0eCAqY3R4ID0gJmRldl9wcml2
LT5yZXNldF9jdHg7Cj4gKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmk5MTUtPmRybTsKPiAr
CXN0cnVjdCBkcm1fbW9kZXNldF9hY3F1aXJlX2N0eCAqY3R4ID0gJmk5MTUtPnJlc2V0X2N0eDsK
PiAgIAlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGU7Cj4gICAJaW50IHJldDsKPiAgIAo+
ICAgCS8qIHJlc2V0IGRvZXNuJ3QgdG91Y2ggdGhlIGRpc3BsYXkgKi8KPiAgIAlpZiAoIWk5MTVf
bW9kcGFyYW1zLmZvcmNlX3Jlc2V0X21vZGVzZXRfdGVzdCAmJgo+IC0JICAgICFncHVfcmVzZXRf
Y2xvYmJlcnNfZGlzcGxheShkZXZfcHJpdikpCj4gKwkgICAgIWdwdV9yZXNldF9jbG9iYmVyc19k
aXNwbGF5KGk5MTUpKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAkvKiBXZSBoYXZlIGEgbW9kZXNl
dCB2cyByZXNldCBkZWFkbG9jaywgZGVmZW5zaXZlbHkgdW5icmVhayBpdC4gKi8KPiAtCXNldF9i
aXQoSTkxNV9SRVNFVF9NT0RFU0VULCAmZGV2X3ByaXYtPmdwdV9lcnJvci5mbGFncyk7Cj4gLQl3
YWtlX3VwX2FsbCgmZGV2X3ByaXYtPmdwdV9lcnJvci53YWl0X3F1ZXVlKTsKPiArCXNldF9iaXQo
STkxNV9SRVNFVF9NT0RFU0VULCAmaTkxNS0+Z3B1X2Vycm9yLmZsYWdzKTsKPiArCXdha2VfdXBf
YWxsKCZpOTE1LT5ncHVfZXJyb3Iud2FpdF9xdWV1ZSk7Cj4gICAKPiAtCWlmIChhdG9taWNfcmVh
ZCgmZGV2X3ByaXYtPmdwdV9lcnJvci5wZW5kaW5nX2ZiX3BpbikpIHsKPiArCWlmIChhdG9taWNf
cmVhZCgmaTkxNS0+Z3B1X2Vycm9yLnBlbmRpbmdfZmJfcGluKSkgewo+ICAgCQlEUk1fREVCVUdf
S01TKCJNb2Rlc2V0IHBvdGVudGlhbGx5IHN0dWNrLCB1bmJyZWFraW5nIHRocm91Z2ggd2VkZ2lu
Z1xuIik7Cj4gLQkJaTkxNV9nZW1fc2V0X3dlZGdlZChkZXZfcHJpdik7Cj4gKwkJaTkxNV9nZW1f
c2V0X3dlZGdlZChpOTE1KTsKPiAgIAl9Cj4gICAKPiAgIAkvKgo+IEBAIC00Mjg2LDI3ICs0Mjg2
LDI3IEBAIHZvaWQgaW50ZWxfcHJlcGFyZV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gICAJCXJldHVybjsKPiAgIAl9Cj4gICAKPiAtCWRldl9wcml2LT5tb2Rlc2V0
X3Jlc3RvcmVfc3RhdGUgPSBzdGF0ZTsKPiArCWk5MTUtPm1vZGVzZXRfcmVzdG9yZV9zdGF0ZSA9
IHN0YXRlOwo+ICAgCXN0YXRlLT5hY3F1aXJlX2N0eCA9IGN0eDsKPiAgIH0KPiAgIAo+IC12b2lk
IGludGVsX2ZpbmlzaF9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
K3ZvaWQgaW50ZWxfZmluaXNoX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ICAgewo+IC0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZkZXZfcHJpdi0+ZHJtOwo+IC0Jc3Ry
dWN0IGRybV9tb2Rlc2V0X2FjcXVpcmVfY3R4ICpjdHggPSAmZGV2X3ByaXYtPnJlc2V0X2N0eDsK
PiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+ICsJc3RydWN0IGRybV9t
b2Rlc2V0X2FjcXVpcmVfY3R4ICpjdHggPSAmaTkxNS0+cmVzZXRfY3R4Owo+ICAgCXN0cnVjdCBk
cm1fYXRvbWljX3N0YXRlICpzdGF0ZTsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gICAJLyogcmVzZXQg
ZG9lc24ndCB0b3VjaCB0aGUgZGlzcGxheSAqLwo+IC0JaWYgKCF0ZXN0X2JpdChJOTE1X1JFU0VU
X01PREVTRVQsICZkZXZfcHJpdi0+Z3B1X2Vycm9yLmZsYWdzKSkKPiArCWlmICghdGVzdF9iaXQo
STkxNV9SRVNFVF9NT0RFU0VULCAmaTkxNS0+Z3B1X2Vycm9yLmZsYWdzKSkKPiAgIAkJcmV0dXJu
Owo+ICAgCj4gLQlzdGF0ZSA9IGZldGNoX2FuZF96ZXJvKCZkZXZfcHJpdi0+bW9kZXNldF9yZXN0
b3JlX3N0YXRlKTsKPiArCXN0YXRlID0gZmV0Y2hfYW5kX3plcm8oJmk5MTUtPm1vZGVzZXRfcmVz
dG9yZV9zdGF0ZSk7Cj4gICAJaWYgKCFzdGF0ZSkKPiAgIAkJZ290byB1bmxvY2s7Cj4gICAKPiAg
IAkvKiByZXNldCBkb2Vzbid0IHRvdWNoIHRoZSBkaXNwbGF5ICovCj4gLQlpZiAoIWdwdV9yZXNl
dF9jbG9iYmVyc19kaXNwbGF5KGRldl9wcml2KSkgewo+ICsJaWYgKCFncHVfcmVzZXRfY2xvYmJl
cnNfZGlzcGxheShpOTE1KSkgewo+ICAgCQkvKiBmb3IgdGVzdGluZyBvbmx5IHJlc3RvcmUgdGhl
IGRpc3BsYXkgKi8KPiAgIAkJcmV0ID0gX19pbnRlbF9kaXNwbGF5X3Jlc3VtZShkZXYsIHN0YXRl
LCBjdHgpOwo+ICAgCQlpZiAocmV0KQo+IEBAIC00MzE2LDIwICs0MzE2LDIwIEBAIHZvaWQgaW50
ZWxfZmluaXNoX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkJ
ICogVGhlIGRpc3BsYXkgaGFzIGJlZW4gcmVzZXQgYXMgd2VsbCwKPiAgIAkJICogc28gbmVlZCBh
IGZ1bGwgcmUtaW5pdGlhbGl6YXRpb24uCj4gICAJCSAqLwo+IC0JCWludGVsX3Bwc191bmxvY2tf
cmVnc193YShkZXZfcHJpdik7Cj4gKwkJaW50ZWxfcHBzX3VubG9ja19yZWdzX3dhKGk5MTUpOwo+
ICAgCQlpbnRlbF9tb2Rlc2V0X2luaXRfaHcoZGV2KTsKPiAtCQlpbnRlbF9pbml0X2Nsb2NrX2dh
dGluZyhkZXZfcHJpdik7Cj4gKwkJaW50ZWxfaW5pdF9jbG9ja19nYXRpbmcoaTkxNSk7Cj4gICAK
PiAtCQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+IC0JCWlmIChkZXZfcHJp
di0+ZGlzcGxheS5ocGRfaXJxX3NldHVwKQo+IC0JCQlkZXZfcHJpdi0+ZGlzcGxheS5ocGRfaXJx
X3NldHVwKGRldl9wcml2KTsKPiAtCQlzcGluX3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9j
ayk7Cj4gKwkJc3Bpbl9sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ICsJCWlmIChpOTE1LT5k
aXNwbGF5LmhwZF9pcnFfc2V0dXApCj4gKwkJCWk5MTUtPmRpc3BsYXkuaHBkX2lycV9zZXR1cChp
OTE1KTsKPiArCQlzcGluX3VubG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiAgIAo+ICAgCQly
ZXQgPSBfX2ludGVsX2Rpc3BsYXlfcmVzdW1lKGRldiwgc3RhdGUsIGN0eCk7Cj4gICAJCWlmIChy
ZXQpCj4gICAJCQlEUk1fRVJST1IoIlJlc3RvcmluZyBvbGQgc3RhdGUgZmFpbGVkIHdpdGggJWlc
biIsIHJldCk7Cj4gICAKPiAtCQlpbnRlbF9ocGRfaW5pdChkZXZfcHJpdik7Cj4gKwkJaW50ZWxf
aHBkX2luaXQoaTkxNSk7Cj4gICAJfQo+ICAgCj4gICAJZHJtX2F0b21pY19zdGF0ZV9wdXQoc3Rh
dGUpOwo+IEBAIC00MzM4LDEyICs0MzM4LDEyIEBAIHZvaWQgaW50ZWxfZmluaXNoX3Jlc2V0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAlkcm1fbW9kZXNldF9hY3F1aXJl
X2ZpbmkoY3R4KTsKPiAgIAltdXRleF91bmxvY2soJmRldi0+bW9kZV9jb25maWcubXV0ZXgpOwo+
ICAgCj4gLQljbGVhcl9iaXQoSTkxNV9SRVNFVF9NT0RFU0VULCAmZGV2X3ByaXYtPmdwdV9lcnJv
ci5mbGFncyk7Cj4gKwljbGVhcl9iaXQoSTkxNV9SRVNFVF9NT0RFU0VULCAmaTkxNS0+Z3B1X2Vy
cm9yLmZsYWdzKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgaWNsX3NldF9waXBlX2NoaWNr
ZW4oc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gICAJZW51bSBw
aXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAgCXUzMiB0bXA7Cj4gICAKPiBAQCAtNDM2OSw3ICs0
MzY5LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfdXBkYXRlX3BpcGVfY29uZmlnKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGEKPiAgIAkJCQkgICAgIGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMobmV3X2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJh
c2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7Cj4gICAKPiAgIAkvKiBkcm1fYXRvbWljX2hlbHBlcl91cGRhdGVfbGVnYWN5
X21vZGVzZXRfc3RhdGUgbWlnaHQgbm90IGJlIGNhbGxlZC4gKi8KPiAgIAljcnRjLT5iYXNlLm1v
ZGUgPSBuZXdfY3J0Y19zdGF0ZS0+YmFzZS5tb2RlOwo+IEBAIC00Mzg4LDI2ICs0Mzg4LDI2IEBA
IHN0YXRpYyB2b2lkIGludGVsX3VwZGF0ZV9waXBlX2NvbmZpZyhjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhCj4gICAJCSAgIChuZXdfY3J0Y19zdGF0ZS0+cGlwZV9z
cmNfaCAtIDEpKTsKPiAgIAo+ICAgCS8qIG9uIHNreWxha2UgdGhpcyBpcyBkb25lIGJ5IGRldGFj
aGluZyBzY2FsZXJzICovCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KSB7Cj4gKwlp
ZiAoSU5URUxfR0VOKGk5MTUpID49IDkpIHsKPiAgIAkJc2tsX2RldGFjaF9zY2FsZXJzKG5ld19j
cnRjX3N0YXRlKTsKPiAgIAo+ICAgCQlpZiAobmV3X2NydGNfc3RhdGUtPnBjaF9wZml0LmVuYWJs
ZWQpCj4gICAJCQlza3lsYWtlX3BmaXRfZW5hYmxlKG5ld19jcnRjX3N0YXRlKTsKPiAtCX0gZWxz
ZSBpZiAoSEFTX1BDSF9TUExJVChkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAoSEFTX1BDSF9T
UExJVChpOTE1KSkgewo+ICAgCQlpZiAobmV3X2NydGNfc3RhdGUtPnBjaF9wZml0LmVuYWJsZWQp
Cj4gICAJCQlpcm9ubGFrZV9wZml0X2VuYWJsZShuZXdfY3J0Y19zdGF0ZSk7Cj4gICAJCWVsc2Ug
aWYgKG9sZF9jcnRjX3N0YXRlLT5wY2hfcGZpdC5lbmFibGVkKQo+ICAgCQkJaXJvbmxha2VfcGZp
dF9kaXNhYmxlKG9sZF9jcnRjX3N0YXRlKTsKPiAgIAl9Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDExKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiAgIAkJaWNs
X3NldF9waXBlX2NoaWNrZW4oY3J0Yyk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIGludGVs
X2ZkaV9ub3JtYWxfdHJhaW4oc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gICB7Cj4gICAJc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmJhc2UuZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJaW50IHBpcGUgPSBjcnRjLT5waXBlOwo+
ICAgCWk5MTVfcmVnX3QgcmVnOwo+ICAgCXUzMiB0ZW1wOwo+IEBAIC00NDE1LDcgKzQ0MTUsNyBA
QCBzdGF0aWMgdm9pZCBpbnRlbF9mZGlfbm9ybWFsX3RyYWluKHN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjKQo+ICAgCS8qIGVuYWJsZSBub3JtYWwgdHJhaW4gKi8KPiAgIAlyZWcgPSBGRElfVFhfQ1RM
KHBpcGUpOwo+ICAgCXRlbXAgPSBJOTE1X1JFQUQocmVnKTsKPiAtCWlmIChJU19JVllCUklER0Uo
ZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfSVZZQlJJREdFKGk5MTUpKSB7Cj4gICAJCXRlbXAgJj0g
fkZESV9MSU5LX1RSQUlOX05PTkVfSVZCOwo+ICAgCQl0ZW1wIHw9IEZESV9MSU5LX1RSQUlOX05P
TkVfSVZCIHwgRkRJX1RYX0VOSEFOQ0VfRlJBTUVfRU5BQkxFOwo+ICAgCX0gZWxzZSB7Cj4gQEAg
LTQ0MjYsNyArNDQyNiw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2ZkaV9ub3JtYWxfdHJhaW4oc3Ry
dWN0IGludGVsX2NydGMgKmNydGMpCj4gICAKPiAgIAlyZWcgPSBGRElfUlhfQ1RMKHBpcGUpOwo+
ICAgCXRlbXAgPSBJOTE1X1JFQUQocmVnKTsKPiAtCWlmIChIQVNfUENIX0NQVChkZXZfcHJpdikp
IHsKPiArCWlmIChIQVNfUENIX0NQVChpOTE1KSkgewo+ICAgCQl0ZW1wICY9IH5GRElfTElOS19U
UkFJTl9QQVRURVJOX01BU0tfQ1BUOwo+ICAgCQl0ZW1wIHw9IEZESV9MSU5LX1RSQUlOX05PUk1B
TF9DUFQ7Cj4gICAJfSBlbHNlIHsKPiBAQCAtNDQ0MCw3ICs0NDQwLDcgQEAgc3RhdGljIHZvaWQg
aW50ZWxfZmRpX25vcm1hbF90cmFpbihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiAgIAl1ZGVs
YXkoMTAwMCk7Cj4gICAKPiAgIAkvKiBJVkIgd2FudHMgZXJyb3IgY29ycmVjdGlvbiBlbmFibGVk
ICovCj4gLQlpZiAoSVNfSVZZQlJJREdFKGRldl9wcml2KSkKPiArCWlmIChJU19JVllCUklER0Uo
aTkxNSkpCj4gICAJCUk5MTVfV1JJVEUocmVnLCBJOTE1X1JFQUQocmVnKSB8IEZESV9GU19FUlJD
X0VOQUJMRSB8Cj4gICAJCQkgICBGRElfRkVfRVJSQ19FTkFCTEUpOwo+ICAgfQo+IEBAIC00NDUw
LDEzICs0NDUwLDEzIEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX2ZkaV9saW5rX3RyYWluKHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCQkJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0
Yy0+YmFzZS5kZXY7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2
KTsKPiAgIAlpbnQgcGlwZSA9IGNydGMtPnBpcGU7Cj4gICAJaTkxNV9yZWdfdCByZWc7Cj4gICAJ
dTMyIHRlbXAsIHRyaWVzOwo+ICAgCj4gICAJLyogRkRJIG5lZWRzIGJpdHMgZnJvbSBwaXBlIGZp
cnN0ICovCj4gLQlhc3NlcnRfcGlwZV9lbmFibGVkKGRldl9wcml2LCBwaXBlKTsKPiArCWFzc2Vy
dF9waXBlX2VuYWJsZWQoaTkxNSwgcGlwZSk7Cj4gICAKPiAgIAkvKiBUcmFpbiAxOiB1bWFzayBG
REkgUlggSW50ZXJydXB0IHN5bWJvbF9sb2NrIGFuZCBiaXRfbG9jayBiaXQKPiAgIAkgICBmb3Ig
dHJhaW4gcmVzdWx0ICovCj4gQEAgLTQ1NTEsNyArNDU1MSw3IEBAIHN0YXRpYyB2b2lkIGdlbjZf
ZmRpX2xpbmtfdHJhaW4oc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gICAJCQkJY29uc3Qgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0IGRybV9k
ZXZpY2UgKmRldiA9IGNydGMtPmJhc2UuZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGRldik7Cj4gICAJaW50IHBpcGUgPSBjcnRjLT5waXBlOwo+ICAgCWk5MTVf
cmVnX3QgcmVnOwo+ICAgCXUzMiB0ZW1wLCBpLCByZXRyeTsKPiBAQCAtNDU4NCw3ICs0NTg0LDcg
QEAgc3RhdGljIHZvaWQgZ2VuNl9mZGlfbGlua190cmFpbihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YywKPiAgIAo+ICAgCXJlZyA9IEZESV9SWF9DVEwocGlwZSk7Cj4gICAJdGVtcCA9IEk5MTVfUkVB
RChyZWcpOwo+IC0JaWYgKEhBU19QQ0hfQ1BUKGRldl9wcml2KSkgewo+ICsJaWYgKEhBU19QQ0hf
Q1BUKGk5MTUpKSB7Cj4gICAJCXRlbXAgJj0gfkZESV9MSU5LX1RSQUlOX1BBVFRFUk5fTUFTS19D
UFQ7Cj4gICAJCXRlbXAgfD0gRkRJX0xJTktfVFJBSU5fUEFUVEVSTl8xX0NQVDsKPiAgIAl9IGVs
c2Ugewo+IEBAIC00NjI4LDcgKzQ2MjgsNyBAQCBzdGF0aWMgdm9pZCBnZW42X2ZkaV9saW5rX3Ry
YWluKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCXRlbXAgPSBJOTE1X1JFQUQocmVnKTsK
PiAgIAl0ZW1wICY9IH5GRElfTElOS19UUkFJTl9OT05FOwo+ICAgCXRlbXAgfD0gRkRJX0xJTktf
VFJBSU5fUEFUVEVSTl8yOwo+IC0JaWYgKElTX0dFTihkZXZfcHJpdiwgNikpIHsKPiArCWlmIChJ
U19HRU4oaTkxNSwgNikpIHsKPiAgIAkJdGVtcCAmPSB+RkRJX0xJTktfVFJBSU5fVk9MX0VNUF9N
QVNLOwo+ICAgCQkvKiBTTkItQiAqLwo+ICAgCQl0ZW1wIHw9IEZESV9MSU5LX1RSQUlOXzQwME1W
XzBEQl9TTkJfQjsKPiBAQCAtNDYzNyw3ICs0NjM3LDcgQEAgc3RhdGljIHZvaWQgZ2VuNl9mZGlf
bGlua190cmFpbihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAo+ICAgCXJlZyA9IEZESV9S
WF9DVEwocGlwZSk7Cj4gICAJdGVtcCA9IEk5MTVfUkVBRChyZWcpOwo+IC0JaWYgKEhBU19QQ0hf
Q1BUKGRldl9wcml2KSkgewo+ICsJaWYgKEhBU19QQ0hfQ1BUKGk5MTUpKSB7Cj4gICAJCXRlbXAg
Jj0gfkZESV9MSU5LX1RSQUlOX1BBVFRFUk5fTUFTS19DUFQ7Cj4gICAJCXRlbXAgfD0gRkRJX0xJ
TktfVFJBSU5fUEFUVEVSTl8yX0NQVDsKPiAgIAl9IGVsc2Ugewo+IEBAIC00Njg0LDcgKzQ2ODQs
NyBAQCBzdGF0aWMgdm9pZCBpdmJfbWFudWFsX2ZkaV9saW5rX3RyYWluKHN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjLAo+ICAgCQkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlKQo+ICAgewo+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5iYXNl
LmRldjsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2
KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAg
CWludCBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgIAlpOTE1X3JlZ190IHJlZzsKPiAgIAl1MzIgdGVt
cCwgaSwgajsKPiBAQCAtNDgwMiw3ICs0ODAyLDcgQEAgc3RhdGljIHZvaWQgaXZiX21hbnVhbF9m
ZGlfbGlua190cmFpbihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIHN0YXRpYyB2b2lkIGly
b25sYWtlX2ZkaV9wbGxfZW5hYmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50
ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShpbnRlbF9jcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoaW50ZWxfY3J0Yy0+YmFzZS5kZXYpOwo+
ICAgCWludCBwaXBlID0gaW50ZWxfY3J0Yy0+cGlwZTsKPiAgIAlpOTE1X3JlZ190IHJlZzsKPiAg
IAl1MzIgdGVtcDsKPiBAQCAtNDgzOSw3ICs0ODM5LDcgQEAgc3RhdGljIHZvaWQgaXJvbmxha2Vf
ZmRpX3BsbF9lbmFibGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUp
Cj4gICBzdGF0aWMgdm9pZCBpcm9ubGFrZV9mZGlfcGxsX2Rpc2FibGUoc3RydWN0IGludGVsX2Ny
dGMgKmludGVsX2NydGMpCj4gICB7Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGludGVs
X2NydGMtPmJhc2UuZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGRldik7Cj4gICAJaW50IHBpcGUgPSBpbnRlbF9jcnRjLT5waXBlOwo+ICAgCWk5MTVfcmVnX3Qg
cmVnOwo+ICAgCXUzMiB0ZW1wOwo+IEBAIC00ODY5LDcgKzQ4NjksNyBAQCBzdGF0aWMgdm9pZCBp
cm9ubGFrZV9mZGlfcGxsX2Rpc2FibGUoc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMpCj4g
ICBzdGF0aWMgdm9pZCBpcm9ubGFrZV9mZGlfZGlzYWJsZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMp
Cj4gICB7Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmRldjsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9j
cnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjKTsKPiAgIAlpbnQgcGlwZSA9IGlu
dGVsX2NydGMtPnBpcGU7Cj4gICAJaTkxNV9yZWdfdCByZWc7Cj4gQEAgLTQ4OTEsNyArNDg5MSw3
IEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX2ZkaV9kaXNhYmxlKHN0cnVjdCBkcm1fY3J0YyAqY3J0
YykKPiAgIAl1ZGVsYXkoMTAwKTsKPiAgIAo+ICAgCS8qIElyb25sYWtlIHdvcmthcm91bmQsIGRp
c2FibGUgY2xvY2sgcG9pbnRlciBhZnRlciBkb3duaW5nIEZESSAqLwo+IC0JaWYgKEhBU19QQ0hf
SUJYKGRldl9wcml2KSkKPiArCWlmIChIQVNfUENIX0lCWChpOTE1KSkKPiAgIAkJSTkxNV9XUklU
RShGRElfUlhfQ0hJQ0tFTihwaXBlKSwgRkRJX1JYX1BIQVNFX1NZTkNfUE9JTlRFUl9PVlIpOwo+
ICAgCj4gICAJLyogc3RpbGwgc2V0IHRyYWluIHBhdHRlcm4gMSAqLwo+IEBAIC00OTAzLDcgKzQ5
MDMsNyBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9mZGlfZGlzYWJsZShzdHJ1Y3QgZHJtX2NydGMg
KmNydGMpCj4gICAKPiAgIAlyZWcgPSBGRElfUlhfQ1RMKHBpcGUpOwo+ICAgCXRlbXAgPSBJOTE1
X1JFQUQocmVnKTsKPiAtCWlmIChIQVNfUENIX0NQVChkZXZfcHJpdikpIHsKPiArCWlmIChIQVNf
UENIX0NQVChpOTE1KSkgewo+ICAgCQl0ZW1wICY9IH5GRElfTElOS19UUkFJTl9QQVRURVJOX01B
U0tfQ1BUOwo+ICAgCQl0ZW1wIHw9IEZESV9MSU5LX1RSQUlOX1BBVFRFUk5fMV9DUFQ7Cj4gICAJ
fSBlbHNlIHsKPiBAQCAtNDkxOSwxMiArNDkxOSwxMiBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9m
ZGlfZGlzYWJsZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMpCj4gICAJdWRlbGF5KDEwMCk7Cj4gICB9
Cj4gICAKPiAtYm9vbCBpbnRlbF9oYXNfcGVuZGluZ19mYl91bnBpbihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gK2Jvb2wgaW50ZWxfaGFzX3BlbmRpbmdfZmJfdW5waW4oc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RydWN0IGRybV9jcnRjICpj
cnRjOwo+ICAgCWJvb2wgY2xlYW51cF9kb25lOwo+ICAgCj4gLQlkcm1fZm9yX2VhY2hfY3J0Yyhj
cnRjLCAmZGV2X3ByaXYtPmRybSkgewo+ICsJZHJtX2Zvcl9lYWNoX2NydGMoY3J0YywgJmk5MTUt
PmRybSkgewo+ICAgCQlzdHJ1Y3QgZHJtX2NydGNfY29tbWl0ICpjb21taXQ7Cj4gICAJCXNwaW5f
bG9jaygmY3J0Yy0+Y29tbWl0X2xvY2spOwo+ICAgCQljb21taXQgPSBsaXN0X2ZpcnN0X2VudHJ5
X29yX251bGwoJmNydGMtPmNvbW1pdF9saXN0LAo+IEBAIC00OTQ0LDMxICs0OTQ0LDMxIEBAIGJv
b2wgaW50ZWxfaGFzX3BlbmRpbmdfZmJfdW5waW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ICAgCXJldHVybiBmYWxzZTsKPiAgIH0KPiAgIAo+IC12b2lkIGxwdF9kaXNhYmxl
X2ljbGtpcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgbHB0X2Rp
c2FibGVfaWNsa2lwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUz
MiB0ZW1wOwo+ICAgCj4gICAJSTkxNV9XUklURShQSVhDTEtfR0FURSwgUElYQ0xLX0dBVEVfR0FU
RSk7Cj4gICAKPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5zYl9sb2NrKTsKPiArCW11dGV4X2xv
Y2soJmk5MTUtPnNiX2xvY2spOwo+ICAgCj4gLQl0ZW1wID0gaW50ZWxfc2JpX3JlYWQoZGV2X3By
aXYsIFNCSV9TU0NDVEw2LCBTQklfSUNMSyk7Cj4gKwl0ZW1wID0gaW50ZWxfc2JpX3JlYWQoaTkx
NSwgU0JJX1NTQ0NUTDYsIFNCSV9JQ0xLKTsKPiAgIAl0ZW1wIHw9IFNCSV9TU0NDVExfRElTQUJM
RTsKPiAtCWludGVsX3NiaV93cml0ZShkZXZfcHJpdiwgU0JJX1NTQ0NUTDYsIHRlbXAsIFNCSV9J
Q0xLKTsKPiArCWludGVsX3NiaV93cml0ZShpOTE1LCBTQklfU1NDQ1RMNiwgdGVtcCwgU0JJX0lD
TEspOwo+ICAgCj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5zYl9sb2NrKTsKPiArCW11dGV4
X3VubG9jaygmaTkxNS0+c2JfbG9jayk7Cj4gICB9Cj4gICAKPiAgIC8qIFByb2dyYW0gaUNMS0lQ
IGNsb2NrIHRvIHRoZSBkZXNpcmVkIGZyZXF1ZW5jeSAqLwo+ICAgc3RhdGljIHZvaWQgbHB0X3By
b2dyYW1faWNsa2lwKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+
ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0
YXRlLT5iYXNlLmNydGMpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAgCWludCBjbG9jayA9IGNydGNfc3RhdGUt
PmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrOwo+ICAgCXUzMiBkaXZzZWwsIHBoYXNlaW5j
LCBhdXhkaXYsIHBoYXNlZGlyID0gMDsKPiAgIAl1MzIgdGVtcDsKPiAgIAo+IC0JbHB0X2Rpc2Fi
bGVfaWNsa2lwKGRldl9wcml2KTsKPiArCWxwdF9kaXNhYmxlX2ljbGtpcChpOTE1KTsKPiAgIAo+
ICAgCS8qIFRoZSBpQ0xLIHZpcnR1YWwgY2xvY2sgcm9vdCBmcmVxdWVuY3kgaXMgaW4gTUh6LAo+
ICAgCSAqIGJ1dCB0aGUgYWRqdXN0ZWRfbW9kZS0+Y3J0Y19jbG9jayBpbiBpbiBLSHouIFRvIGdl
dCB0aGUKPiBAQCAtNTAwNywzMCArNTAwNywzMCBAQCBzdGF0aWMgdm9pZCBscHRfcHJvZ3JhbV9p
Y2xraXAoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICAJCQlw
aGFzZWRpciwKPiAgIAkJCXBoYXNlaW5jKTsKPiAgIAo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYt
PnNiX2xvY2spOwo+ICsJbXV0ZXhfbG9jaygmaTkxNS0+c2JfbG9jayk7Cj4gICAKPiAgIAkvKiBQ
cm9ncmFtIFNTQ0RJVklOVFBIQVNFNiAqLwo+IC0JdGVtcCA9IGludGVsX3NiaV9yZWFkKGRldl9w
cml2LCBTQklfU1NDRElWSU5UUEhBU0U2LCBTQklfSUNMSyk7Cj4gKwl0ZW1wID0gaW50ZWxfc2Jp
X3JlYWQoaTkxNSwgU0JJX1NTQ0RJVklOVFBIQVNFNiwgU0JJX0lDTEspOwo+ICAgCXRlbXAgJj0g
flNCSV9TU0NESVZJTlRQSEFTRV9ESVZTRUxfTUFTSzsKPiAgIAl0ZW1wIHw9IFNCSV9TU0NESVZJ
TlRQSEFTRV9ESVZTRUwoZGl2c2VsKTsKPiAgIAl0ZW1wICY9IH5TQklfU1NDRElWSU5UUEhBU0Vf
SU5DVkFMX01BU0s7Cj4gICAJdGVtcCB8PSBTQklfU1NDRElWSU5UUEhBU0VfSU5DVkFMKHBoYXNl
aW5jKTsKPiAgIAl0ZW1wIHw9IFNCSV9TU0NESVZJTlRQSEFTRV9ESVIocGhhc2VkaXIpOwo+ICAg
CXRlbXAgfD0gU0JJX1NTQ0RJVklOVFBIQVNFX1BST1BBR0FURTsKPiAtCWludGVsX3NiaV93cml0
ZShkZXZfcHJpdiwgU0JJX1NTQ0RJVklOVFBIQVNFNiwgdGVtcCwgU0JJX0lDTEspOwo+ICsJaW50
ZWxfc2JpX3dyaXRlKGk5MTUsIFNCSV9TU0NESVZJTlRQSEFTRTYsIHRlbXAsIFNCSV9JQ0xLKTsK
PiAgIAo+ICAgCS8qIFByb2dyYW0gU1NDQVVYRElWICovCj4gLQl0ZW1wID0gaW50ZWxfc2JpX3Jl
YWQoZGV2X3ByaXYsIFNCSV9TU0NBVVhESVY2LCBTQklfSUNMSyk7Cj4gKwl0ZW1wID0gaW50ZWxf
c2JpX3JlYWQoaTkxNSwgU0JJX1NTQ0FVWERJVjYsIFNCSV9JQ0xLKTsKPiAgIAl0ZW1wICY9IH5T
QklfU1NDQVVYRElWX0ZJTkFMRElWMlNFTCgxKTsKPiAgIAl0ZW1wIHw9IFNCSV9TU0NBVVhESVZf
RklOQUxESVYyU0VMKGF1eGRpdik7Cj4gLQlpbnRlbF9zYmlfd3JpdGUoZGV2X3ByaXYsIFNCSV9T
U0NBVVhESVY2LCB0ZW1wLCBTQklfSUNMSyk7Cj4gKwlpbnRlbF9zYmlfd3JpdGUoaTkxNSwgU0JJ
X1NTQ0FVWERJVjYsIHRlbXAsIFNCSV9JQ0xLKTsKPiAgIAo+ICAgCS8qIEVuYWJsZSBtb2R1bGF0
b3IgYW5kIGFzc29jaWF0ZWQgZGl2aWRlciAqLwo+IC0JdGVtcCA9IGludGVsX3NiaV9yZWFkKGRl
dl9wcml2LCBTQklfU1NDQ1RMNiwgU0JJX0lDTEspOwo+ICsJdGVtcCA9IGludGVsX3NiaV9yZWFk
KGk5MTUsIFNCSV9TU0NDVEw2LCBTQklfSUNMSyk7Cj4gICAJdGVtcCAmPSB+U0JJX1NTQ0NUTF9E
SVNBQkxFOwo+IC0JaW50ZWxfc2JpX3dyaXRlKGRldl9wcml2LCBTQklfU1NDQ1RMNiwgdGVtcCwg
U0JJX0lDTEspOwo+ICsJaW50ZWxfc2JpX3dyaXRlKGk5MTUsIFNCSV9TU0NDVEw2LCB0ZW1wLCBT
QklfSUNMSyk7Cj4gICAKPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPnNiX2xvY2spOwo+ICsJ
bXV0ZXhfdW5sb2NrKCZpOTE1LT5zYl9sb2NrKTsKPiAgIAo+ICAgCS8qIFdhaXQgZm9yIGluaXRp
YWxpemF0aW9uIHRpbWUgKi8KPiAgIAl1ZGVsYXkoMjQpOwo+IEBAIC01MDM4LDcgKzUwMzgsNyBA
QCBzdGF0aWMgdm9pZCBscHRfcHJvZ3JhbV9pY2xraXAoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCj4gICAJSTkxNV9XUklURShQSVhDTEtfR0FURSwgUElYQ0xLX0dB
VEVfVU5HQVRFKTsKPiAgIH0KPiAgIAo+IC1pbnQgbHB0X2dldF9pY2xraXAoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtpbnQgbHB0X2dldF9pY2xraXAoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJdTMyIGRpdnNlbCwgcGhhc2VpbmMsIGF1eGRp
djsKPiAgIAl1MzIgaWNsa192aXJ0dWFsX3Jvb3RfZnJlcSA9IDE3MjgwMCAqIDEwMDA7Cj4gQEAg
LTUwNDksMjUgKzUwNDksMjUgQEAgaW50IGxwdF9nZXRfaWNsa2lwKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiAgIAlpZiAoKEk5MTVfUkVBRChQSVhDTEtfR0FURSkgJiBQSVhD
TEtfR0FURV9VTkdBVEUpID09IDApCj4gICAJCXJldHVybiAwOwo+ICAgCj4gLQltdXRleF9sb2Nr
KCZkZXZfcHJpdi0+c2JfbG9jayk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT5zYl9sb2NrKTsKPiAg
IAo+IC0JdGVtcCA9IGludGVsX3NiaV9yZWFkKGRldl9wcml2LCBTQklfU1NDQ1RMNiwgU0JJX0lD
TEspOwo+ICsJdGVtcCA9IGludGVsX3NiaV9yZWFkKGk5MTUsIFNCSV9TU0NDVEw2LCBTQklfSUNM
Syk7Cj4gICAJaWYgKHRlbXAgJiBTQklfU1NDQ1RMX0RJU0FCTEUpIHsKPiAtCQltdXRleF91bmxv
Y2soJmRldl9wcml2LT5zYl9sb2NrKTsKPiArCQltdXRleF91bmxvY2soJmk5MTUtPnNiX2xvY2sp
Owo+ICAgCQlyZXR1cm4gMDsKPiAgIAl9Cj4gICAKPiAtCXRlbXAgPSBpbnRlbF9zYmlfcmVhZChk
ZXZfcHJpdiwgU0JJX1NTQ0RJVklOVFBIQVNFNiwgU0JJX0lDTEspOwo+ICsJdGVtcCA9IGludGVs
X3NiaV9yZWFkKGk5MTUsIFNCSV9TU0NESVZJTlRQSEFTRTYsIFNCSV9JQ0xLKTsKPiAgIAlkaXZz
ZWwgPSAodGVtcCAmIFNCSV9TU0NESVZJTlRQSEFTRV9ESVZTRUxfTUFTSykgPj4KPiAgIAkJU0JJ
X1NTQ0RJVklOVFBIQVNFX0RJVlNFTF9TSElGVDsKPiAgIAlwaGFzZWluYyA9ICh0ZW1wICYgU0JJ
X1NTQ0RJVklOVFBIQVNFX0lOQ1ZBTF9NQVNLKSA+Pgo+ICAgCQlTQklfU1NDRElWSU5UUEhBU0Vf
SU5DVkFMX1NISUZUOwo+ICAgCj4gLQl0ZW1wID0gaW50ZWxfc2JpX3JlYWQoZGV2X3ByaXYsIFNC
SV9TU0NBVVhESVY2LCBTQklfSUNMSyk7Cj4gKwl0ZW1wID0gaW50ZWxfc2JpX3JlYWQoaTkxNSwg
U0JJX1NTQ0FVWERJVjYsIFNCSV9JQ0xLKTsKPiAgIAlhdXhkaXYgPSAodGVtcCAmIFNCSV9TU0NB
VVhESVZfRklOQUxESVYyU0VMX01BU0spID4+Cj4gICAJCVNCSV9TU0NBVVhESVZfRklOQUxESVYy
U0VMX1NISUZUOwo+ICAgCj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5zYl9sb2NrKTsKPiAr
CW11dGV4X3VubG9jaygmaTkxNS0+c2JfbG9jayk7Cj4gICAKPiAgIAlkZXNpcmVkX2Rpdmlzb3Ig
PSAoZGl2c2VsICsgMikgKiBpY2xrX3BpX3JhbmdlICsgcGhhc2VpbmM7Cj4gICAKPiBAQCAtNTA3
OSw3ICs1MDc5LDcgQEAgc3RhdGljIHZvaWQgaXJvbmxha2VfcGNoX3RyYW5zY29kZXJfc2V0X3Rp
bWluZ3MoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmMKPiAgIAkJCQkJCWVudW0gcGlw
ZSBwY2hfdHJhbnNjb2RlcikKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRv
X2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAllbnVt
IHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcjsK
PiAgIAo+ICAgCUk5MTVfV1JJVEUoUENIX1RSQU5TX0hUT1RBTChwY2hfdHJhbnNjb2RlciksCj4g
QEAgLTUwOTksNyArNTA5OSw3IEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX3BjaF90cmFuc2NvZGVy
X3NldF90aW1pbmdzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjCj4gICAJCSAgIEk5
MTVfUkVBRChWU1lOQ1NISUZUKGNwdV90cmFuc2NvZGVyKSkpOwo+ICAgfQo+ICAgCj4gLXN0YXRp
YyB2b2lkIGNwdF9zZXRfZmRpX2JjX2JpZnVyY2F0aW9uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwgYm9vbCBlbmFibGUpCj4gK3N0YXRpYyB2b2lkIGNwdF9zZXRfZmRpX2JjX2Jp
ZnVyY2F0aW9uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBib29sIGVuYWJsZSkKPiAg
IHsKPiAgIAl1MzIgdGVtcDsKPiAgIAo+IEBAIC01MTIyLDIwICs1MTIyLDIwIEBAIHN0YXRpYyB2
b2lkIGNwdF9zZXRfZmRpX2JjX2JpZnVyY2F0aW9uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwgYm9vbCBlCj4gICBzdGF0aWMgdm9pZCBpdnlicmlkZ2VfdXBkYXRlX2ZkaV9iY19i
aWZ1cmNhdGlvbihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAg
IHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0
ZS0+YmFzZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAo+ICAgCXN3aXRjaCAoY3J0Yy0+cGlwZSkg
ewo+ICAgCWNhc2UgUElQRV9BOgo+ICAgCQlicmVhazsKPiAgIAljYXNlIFBJUEVfQjoKPiAgIAkJ
aWYgKGNydGNfc3RhdGUtPmZkaV9sYW5lcyA+IDIpCj4gLQkJCWNwdF9zZXRfZmRpX2JjX2JpZnVy
Y2F0aW9uKGRldl9wcml2LCBmYWxzZSk7Cj4gKwkJCWNwdF9zZXRfZmRpX2JjX2JpZnVyY2F0aW9u
KGk5MTUsIGZhbHNlKTsKPiAgIAkJZWxzZQo+IC0JCQljcHRfc2V0X2ZkaV9iY19iaWZ1cmNhdGlv
bihkZXZfcHJpdiwgdHJ1ZSk7Cj4gKwkJCWNwdF9zZXRfZmRpX2JjX2JpZnVyY2F0aW9uKGk5MTUs
IHRydWUpOwo+ICAgCj4gICAJCWJyZWFrOwo+ICAgCWNhc2UgUElQRV9DOgo+IC0JCWNwdF9zZXRf
ZmRpX2JjX2JpZnVyY2F0aW9uKGRldl9wcml2LCB0cnVlKTsKPiArCQljcHRfc2V0X2ZkaV9iY19i
aWZ1cmNhdGlvbihpOTE1LCB0cnVlKTsKPiAgIAo+ICAgCQlicmVhazsKPiAgIAlkZWZhdWx0Ogo+
IEBAIC01MTg1LDEzICs1MTg1LDEzIEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX3BjaF9lbmFibGUo
Y29uc3Qgc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4gICB7Cj4gICAJc3RydWN0
IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7
Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmJhc2UuZGV2Owo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJaW50IHBpcGUgPSBjcnRj
LT5waXBlOwo+ICAgCXUzMiB0ZW1wOwo+ICAgCj4gLQlhc3NlcnRfcGNoX3RyYW5zY29kZXJfZGlz
YWJsZWQoZGV2X3ByaXYsIHBpcGUpOwo+ICsJYXNzZXJ0X3BjaF90cmFuc2NvZGVyX2Rpc2FibGVk
KGk5MTUsIHBpcGUpOwo+ICAgCj4gLQlpZiAoSVNfSVZZQlJJREdFKGRldl9wcml2KSkKPiArCWlm
IChJU19JVllCUklER0UoaTkxNSkpCj4gICAJCWl2eWJyaWRnZV91cGRhdGVfZmRpX2JjX2JpZnVy
Y2F0aW9uKGNydGNfc3RhdGUpOwo+ICAgCj4gICAJLyogV3JpdGUgdGhlIFRVIHNpemUgYml0cyBi
ZWZvcmUgZmRpIGxpbmsgdHJhaW5pbmcsIHNvIHRoYXQgZXJyb3IKPiBAQCAtNTIwMCwxOCArNTIw
MCwxOCBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9wY2hfZW5hYmxlKGNvbnN0IHN0cnVjdCBpbnRl
bF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+ICAgCQkgICBJOTE1X1JFQUQoUElQRV9EQVRBX00xKHBp
cGUpKSAmIFRVX1NJWkVfTUFTSyk7Cj4gICAKPiAgIAkvKiBGb3IgUENIIG91dHB1dCwgdHJhaW5p
bmcgRkRJIGxpbmsgKi8KPiAtCWRldl9wcml2LT5kaXNwbGF5LmZkaV9saW5rX3RyYWluKGNydGMs
IGNydGNfc3RhdGUpOwo+ICsJaTkxNS0+ZGlzcGxheS5mZGlfbGlua190cmFpbihjcnRjLCBjcnRj
X3N0YXRlKTsKPiAgIAo+ICAgCS8qIFdlIG5lZWQgdG8gcHJvZ3JhbSB0aGUgcmlnaHQgY2xvY2sg
c2VsZWN0aW9uIGJlZm9yZSB3cml0aW5nIHRoZSBwaXhlbAo+ICAgCSAqIG11dGxpcGxpZXIgaW50
byB0aGUgRFBMTC4gKi8KPiAtCWlmIChIQVNfUENIX0NQVChkZXZfcHJpdikpIHsKPiArCWlmIChI
QVNfUENIX0NQVChpOTE1KSkgewo+ICAgCQl1MzIgc2VsOwo+ICAgCj4gICAJCXRlbXAgPSBJOTE1
X1JFQUQoUENIX0RQTExfU0VMKTsKPiAgIAkJdGVtcCB8PSBUUkFOU19EUExMX0VOQUJMRShwaXBl
KTsKPiAgIAkJc2VsID0gVFJBTlNfRFBMTEJfU0VMKHBpcGUpOwo+ICAgCQlpZiAoY3J0Y19zdGF0
ZS0+c2hhcmVkX2RwbGwgPT0KPiAtCQkgICAgaW50ZWxfZ2V0X3NoYXJlZF9kcGxsX2J5X2lkKGRl
dl9wcml2LCBEUExMX0lEX1BDSF9QTExfQikpCj4gKwkJICAgIGludGVsX2dldF9zaGFyZWRfZHBs
bF9ieV9pZChpOTE1LCBEUExMX0lEX1BDSF9QTExfQikpCj4gICAJCQl0ZW1wIHw9IHNlbDsKPiAg
IAkJZWxzZQo+ICAgCQkJdGVtcCAmPSB+c2VsOwo+IEBAIC01MjI4LDEzICs1MjI4LDEzIEBAIHN0
YXRpYyB2b2lkIGlyb25sYWtlX3BjaF9lbmFibGUoY29uc3Qgc3RydWN0IGludGVsX2F0b21pY19z
dGF0ZSAqc3RhdGUsCj4gICAJaW50ZWxfZW5hYmxlX3NoYXJlZF9kcGxsKGNydGNfc3RhdGUpOwo+
ICAgCj4gICAJLyogc2V0IHRyYW5zY29kZXIgdGltaW5nLCBwYW5lbCBtdXN0IGFsbG93IGl0ICov
Cj4gLQlhc3NlcnRfcGFuZWxfdW5sb2NrZWQoZGV2X3ByaXYsIHBpcGUpOwo+ICsJYXNzZXJ0X3Bh
bmVsX3VubG9ja2VkKGk5MTUsIHBpcGUpOwo+ICAgCWlyb25sYWtlX3BjaF90cmFuc2NvZGVyX3Nl
dF90aW1pbmdzKGNydGNfc3RhdGUsIHBpcGUpOwo+ICAgCj4gICAJaW50ZWxfZmRpX25vcm1hbF90
cmFpbihjcnRjKTsKPiAgIAo+ICAgCS8qIEZvciBQQ0ggRFAsIGVuYWJsZSBUUkFOU19EUF9DVEwg
Ki8KPiAtCWlmIChIQVNfUENIX0NQVChkZXZfcHJpdikgJiYKPiArCWlmIChIQVNfUENIX0NQVChp
OTE1KSAmJgo+ICAgCSAgICBpbnRlbF9jcnRjX2hhc19kcF9lbmNvZGVyKGNydGNfc3RhdGUpKSB7
Cj4gICAJCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0KPiAg
IAkJCSZjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gQEAgLTUyNjgsMjIgKzUyNjgs
MjIgQEAgc3RhdGljIHZvaWQgbHB0X3BjaF9lbmFibGUoY29uc3Qgc3RydWN0IGludGVsX2F0b21p
Y19zdGF0ZSAqc3RhdGUsCj4gICAJCQkgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVs
X2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAllbnVtIHRyYW5z
Y29kZXIgY3B1X3RyYW5zY29kZXIgPSBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcjsKPiAgIAo+
IC0JYXNzZXJ0X3BjaF90cmFuc2NvZGVyX2Rpc2FibGVkKGRldl9wcml2LCBQSVBFX0EpOwo+ICsJ
YXNzZXJ0X3BjaF90cmFuc2NvZGVyX2Rpc2FibGVkKGk5MTUsIFBJUEVfQSk7Cj4gICAKPiAgIAls
cHRfcHJvZ3JhbV9pY2xraXAoY3J0Y19zdGF0ZSk7Cj4gICAKPiAgIAkvKiBTZXQgdHJhbnNjb2Rl
ciB0aW1pbmcuICovCj4gICAJaXJvbmxha2VfcGNoX3RyYW5zY29kZXJfc2V0X3RpbWluZ3MoY3J0
Y19zdGF0ZSwgUElQRV9BKTsKPiAgIAo+IC0JbHB0X2VuYWJsZV9wY2hfdHJhbnNjb2RlcihkZXZf
cHJpdiwgY3B1X3RyYW5zY29kZXIpOwo+ICsJbHB0X2VuYWJsZV9wY2hfdHJhbnNjb2RlcihpOTE1
LCBjcHVfdHJhbnNjb2Rlcik7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIGNwdF92ZXJpZnlf
bW9kZXNldChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBpbnQgcGlwZSkKPiAgIHsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCWk5MTVfcmVnX3QgZHNs
cmVnID0gUElQRURTTChwaXBlKTsKPiAgIAl1MzIgdGVtcDsKPiAgIAo+IEBAIC01Mzg1LDcgKzUz
ODUsNyBAQCBza2xfdXBkYXRlX3NjYWxlcihzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSwgYm9vbCBmb3JjZV9kZXRhY2gsCj4gICAJCSZjcnRjX3N0YXRlLT5zY2FsZXJfc3RhdGU7
Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPQo+ICAgCQl0b19pbnRlbF9jcnRj
KGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGludGVsX2NydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShpbnRlbF9jcnRjLT5iYXNlLmRldik7Cj4gICAJY29u
c3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+ICAgCQkmY3J0Y19z
dGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICAgCj4gQEAgLTU0MDMsNyArNTQwMyw3IEBAIHNr
bF91cGRhdGVfc2NhbGVyKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLCBib29s
IGZvcmNlX2RldGFjaCwKPiAgIAkgKiBPbmNlIE5WMTIgaXMgZW5hYmxlZCwgaGFuZGxlIGl0IGhl
cmUgd2hpbGUgYWxsb2NhdGluZyBzY2FsZXIKPiAgIAkgKiBmb3IgTlYxMi4KPiAgIAkgKi8KPiAt
CWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkgJiYgY3J0Y19zdGF0ZS0+YmFzZS5lbmFibGUg
JiYKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSAmJiBjcnRjX3N0YXRlLT5iYXNlLmVuYWJs
ZSAmJgo+ICAgCSAgICBuZWVkX3NjYWxlciAmJiBhZGp1c3RlZF9tb2RlLT5mbGFncyAmIERSTV9N
T0RFX0ZMQUdfSU5URVJMQUNFKSB7Cj4gICAJCURSTV9ERUJVR19LTVMoIlBpcGUvUGxhbmUgc2Nh
bGluZyBub3Qgc3VwcG9ydGVkIHdpdGggSUYtSUQgbW9kZVxuIik7Cj4gICAJCXJldHVybiAtRUlO
VkFMOwo+IEBAIC01NDQyLDEwICs1NDQyLDEwIEBAIHNrbF91cGRhdGVfc2NhbGVyKHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLCBib29sIGZvcmNlX2RldGFjaCwKPiAgIAkvKiBy
YW5nZSBjaGVja3MgKi8KPiAgIAlpZiAoc3JjX3cgPCBTS0xfTUlOX1NSQ19XIHx8IHNyY19oIDwg
U0tMX01JTl9TUkNfSCB8fAo+ICAgCSAgICBkc3RfdyA8IFNLTF9NSU5fRFNUX1cgfHwgZHN0X2gg
PCBTS0xfTUlOX0RTVF9IIHx8Cj4gLQkgICAgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEgJiYK
PiArCSAgICAoSU5URUxfR0VOKGk5MTUpID49IDExICYmCj4gICAJICAgICAoc3JjX3cgPiBJQ0xf
TUFYX1NSQ19XIHx8IHNyY19oID4gSUNMX01BWF9TUkNfSCB8fAo+ICAgCSAgICAgIGRzdF93ID4g
SUNMX01BWF9EU1RfVyB8fCBkc3RfaCA+IElDTF9NQVhfRFNUX0gpKSB8fAo+IC0JICAgIChJTlRF
TF9HRU4oZGV2X3ByaXYpIDwgMTEgJiYKPiArCSAgICAoSU5URUxfR0VOKGk5MTUpIDwgMTEgJiYK
PiAgIAkgICAgIChzcmNfdyA+IFNLTF9NQVhfU1JDX1cgfHwgc3JjX2ggPiBTS0xfTUFYX1NSQ19I
IHx8Cj4gICAJICAgICAgZHN0X3cgPiBTS0xfTUFYX0RTVF9XIHx8IGRzdF9oID4gU0tMX01BWF9E
U1RfSCkpKQl7Cj4gICAJCURSTV9ERUJVR19LTVMoInNjYWxlcl91c2VyIGluZGV4ICV1LiV1OiBz
cmMgJXV4JXUgZHN0ICV1eCV1ICIKPiBAQCAtNTUwMiwxNCArNTUwMiwxNCBAQCBzdGF0aWMgaW50
IHNrbF91cGRhdGVfc2NhbGVyX3BsYW5lKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlLAo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9wbGFuZSAqaW50ZWxfcGxhbmUgPQo+ICAgCQl0
b19pbnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZSk7Cj4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGludGVsX3BsYW5lLT5iYXNlLmRldik7Cj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoaW50ZWxfcGxhbmUtPmJh
c2UuZGV2KTsKPiAgIAlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IHBsYW5lX3N0YXRlLT5i
YXNlLmZiOwo+ICAgCWludCByZXQ7Cj4gICAJYm9vbCBmb3JjZV9kZXRhY2ggPSAhZmIgfHwgIXBs
YW5lX3N0YXRlLT5iYXNlLnZpc2libGU7Cj4gICAJYm9vbCBuZWVkX3NjYWxlciA9IGZhbHNlOwo+
ICAgCj4gICAJLyogUHJlLWdlbjExIGFuZCBTRFIgcGxhbmVzIGFsd2F5cyBuZWVkIGEgc2NhbGVy
IGZvciBwbGFuYXIgZm9ybWF0cy4gKi8KPiAtCWlmICghaWNsX2lzX2hkcl9wbGFuZShkZXZfcHJp
diwgaW50ZWxfcGxhbmUtPmlkKSAmJgo+ICsJaWYgKCFpY2xfaXNfaGRyX3BsYW5lKGk5MTUsIGlu
dGVsX3BsYW5lLT5pZCkgJiYKPiAgIAkgICAgZmIgJiYgaXNfcGxhbmFyX3l1dl9mb3JtYXQoZmIt
PmZvcm1hdC0+Zm9ybWF0KSkKPiAgIAkJbmVlZF9zY2FsZXIgPSB0cnVlOwo+ICAgCj4gQEAgLTU1
ODIsNyArNTU4Miw3IEBAIHN0YXRpYyB2b2lkIHNreWxha2Vfc2NhbGVyX2Rpc2FibGUoc3RydWN0
IGludGVsX2NydGMgKmNydGMpCj4gICBzdGF0aWMgdm9pZCBza3lsYWtlX3BmaXRfZW5hYmxlKGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgewo+ICAgCXN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMp
Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5i
YXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwo+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgIAljb25z
dCBzdHJ1Y3QgaW50ZWxfY3J0Y19zY2FsZXJfc3RhdGUgKnNjYWxlcl9zdGF0ZSA9Cj4gICAJCSZj
cnRjX3N0YXRlLT5zY2FsZXJfc3RhdGU7Cj4gQEAgLTU2MTksNyArNTYxOSw3IEBAIHN0YXRpYyB2
b2lkIHNreWxha2VfcGZpdF9lbmFibGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUpCj4gICBzdGF0aWMgdm9pZCBpcm9ubGFrZV9wZml0X2VuYWJsZShjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2Uu
ZGV2KTsKPiAgIAlpbnQgcGlwZSA9IGNydGMtPnBpcGU7Cj4gICAKPiAgIAlpZiAoY3J0Y19zdGF0
ZS0+cGNoX3BmaXQuZW5hYmxlZCkgewo+IEBAIC01NjI3LDcgKzU2MjcsNyBAQCBzdGF0aWMgdm9p
ZCBpcm9ubGFrZV9wZml0X2VuYWJsZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSkKPiAgIAkJICogYXMgc29tZSBwcmUtcHJvZ3JhbW1lZCB2YWx1ZXMgYXJlIGJyb2tl
biwKPiAgIAkJICogZS5nLiB4MjAxLgo+ICAgCQkgKi8KPiAtCQlpZiAoSVNfSVZZQlJJREdFKGRl
dl9wcml2KSB8fCBJU19IQVNXRUxMKGRldl9wcml2KSkKPiArCQlpZiAoSVNfSVZZQlJJREdFKGk5
MTUpIHx8IElTX0hBU1dFTEwoaTkxNSkpCj4gICAJCQlJOTE1X1dSSVRFKFBGX0NUTChwaXBlKSwg
UEZfRU5BQkxFIHwgUEZfRklMVEVSX01FRF8zeDMgfAo+ICAgCQkJCQkJIFBGX1BJUEVfU0VMX0lW
QihwaXBlKSk7Cj4gICAJCWVsc2UKPiBAQCAtNTY0MSw3ICs1NjQxLDcgQEAgdm9pZCBoc3dfZW5h
YmxlX2lwcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsK
PiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+
YmFzZS5jcnRjKTsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAo+ICAg
CWlmICghY3J0Y19zdGF0ZS0+aXBzX2VuYWJsZWQpCj4gICAJCXJldHVybjsKPiBAQCAtNTY1Myw4
ICs1NjUzLDggQEAgdm9pZCBoc3dfZW5hYmxlX2lwcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIAkgKi8KPiAgIAlXQVJOX09OKCEoY3J0Y19zdGF0ZS0+YWN0
aXZlX3BsYW5lcyAmIH5CSVQoUExBTkVfQ1VSU09SKSkpOwo+ICAgCj4gLQlpZiAoSVNfQlJPQURX
RUxMKGRldl9wcml2KSkgewo+IC0JCVdBUk5fT04oc2FuZHlicmlkZ2VfcGNvZGVfd3JpdGUoZGV2
X3ByaXYsIERJU1BMQVlfSVBTX0NPTlRST0wsCj4gKwlpZiAoSVNfQlJPQURXRUxMKGk5MTUpKSB7
Cj4gKwkJV0FSTl9PTihzYW5keWJyaWRnZV9wY29kZV93cml0ZShpOTE1LCBESVNQTEFZX0lQU19D
T05UUk9MLAo+ICAgCQkJCQkJSVBTX0VOQUJMRSB8IElQU19QQ09ERV9DT05UUk9MKSk7Cj4gICAJ
CS8qIFF1b3RpbmcgQXJ0IFJ1bnlhbjogIml0cyBub3Qgc2FmZSB0byBleHBlY3QgYW55IHBhcnRp
Y3VsYXIKPiAgIAkJICogdmFsdWUgaW4gSVBTX0NUTCBiaXQgMzEgYWZ0ZXIgZW5hYmxpbmcgSVBT
IHRocm91Z2ggdGhlCj4gQEAgLTU2NjgsNyArNTY2OCw3IEBAIHZvaWQgaHN3X2VuYWJsZV9pcHMo
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICAJCSAqIGFuZCBk
b24ndCB3YWl0IGZvciB2YmxhbmtzIHVudGlsIHRoZSBlbmQgb2YgY3J0Y19lbmFibGUsIHRoZW4K
PiAgIAkJICogdGhlIEhXIHN0YXRlIHJlYWRvdXQgY29kZSB3aWxsIGNvbXBsYWluIHRoYXQgdGhl
IGV4cGVjdGVkCj4gICAJCSAqIElQU19DVEwgdmFsdWUgaXMgbm90IHRoZSBvbmUgd2UgcmVhZC4g
Ki8KPiAtCQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4g
KwkJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsCj4gICAJCQkJCSAg
ICBJUFNfQ1RMLCBJUFNfRU5BQkxFLCBJUFNfRU5BQkxFLAo+ICAgCQkJCQkgICAgNTApKQo+ICAg
CQkJRFJNX0VSUk9SKCJUaW1lZCBvdXQgd2FpdGluZyBmb3IgSVBTIGVuYWJsZVxuIik7Cj4gQEAg
LTU2NzksMTkgKzU2NzksMTkgQEAgdm9pZCBoc3dfZGlzYWJsZV9pcHMoY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2NydGMg
KmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gICAJc3RydWN0
IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmJhc2UuZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAKPiAgIAlpZiAoIWNydGNfc3RhdGUtPmlwc19l
bmFibGVkKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCWlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYp
KSB7Cj4gLQkJV0FSTl9PTihzYW5keWJyaWRnZV9wY29kZV93cml0ZShkZXZfcHJpdiwgRElTUExB
WV9JUFNfQ09OVFJPTCwgMCkpOwo+ICsJaWYgKElTX0JST0FEV0VMTChpOTE1KSkgewo+ICsJCVdB
Uk5fT04oc2FuZHlicmlkZ2VfcGNvZGVfd3JpdGUoaTkxNSwgRElTUExBWV9JUFNfQ09OVFJPTCwg
MCkpOwo+ICAgCQkvKgo+ICAgCQkgKiBXYWl0IGZvciBQQ09ERSB0byBmaW5pc2ggZGlzYWJsaW5n
IElQUy4gVGhlIEJTcGVjIHNwZWNpZmllZAo+ICAgCQkgKiA0Mm1zIHRpbWVvdXQgdmFsdWUgbGVh
ZHMgdG8gb2NjYXNpb25hbCB0aW1lb3V0cyBzbyB1c2UgMTAwbXMKPiAgIAkJICogaW5zdGVhZC4K
PiAgIAkJICovCj4gLQkJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5j
b3JlLAo+ICsJCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+ICAg
CQkJCQkgICAgSVBTX0NUTCwgSVBTX0VOQUJMRSwgMCwKPiAgIAkJCQkJICAgIDEwMCkpCj4gICAJ
CQlEUk1fRVJST1IoIlRpbWVkIG91dCB3YWl0aW5nIGZvciBJUFMgZGlzYWJsZVxuIik7Cj4gQEAg
LTU3MDEsNyArNTcwMSw3IEBAIHZvaWQgaHN3X2Rpc2FibGVfaXBzKGNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgCX0KPiAgIAo+ICAgCS8qIFdlIG5lZWQgdG8g
d2FpdCBmb3IgYSB2YmxhbmsgYmVmb3JlIHdlIGNhbiBkaXNhYmxlIHRoZSBwbGFuZS4gKi8KPiAt
CWludGVsX3dhaXRfZm9yX3ZibGFuayhkZXZfcHJpdiwgY3J0Yy0+cGlwZSk7Cj4gKwlpbnRlbF93
YWl0X2Zvcl92YmxhbmsoaTkxNSwgY3J0Yy0+cGlwZSk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2
b2lkIGludGVsX2NydGNfZHBtc19vdmVybGF5X2Rpc2FibGUoc3RydWN0IGludGVsX2NydGMgKmlu
dGVsX2NydGMpCj4gQEAgLTU3MzUsNyArNTczNSw3IEBAIGludGVsX3Bvc3RfZW5hYmxlX3ByaW1h
cnkoc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ICAgCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRl
diA9IGNydGMtPmRldjsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShk
ZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0Yyhj
cnRjKTsKPiAgIAlpbnQgcGlwZSA9IGludGVsX2NydGMtPnBpcGU7Cj4gICAKPiBAQCAtNTc0Niwx
MiArNTc0NiwxMiBAQCBpbnRlbF9wb3N0X2VuYWJsZV9wcmltYXJ5KHN0cnVjdCBkcm1fY3J0YyAq
Y3J0YywKPiAgIAkgKiBGSVhNRTogTmVlZCB0byBmaXggdGhlIGxvZ2ljIHRvIHdvcmsgd2hlbiB3
ZSB0dXJuIG9mZiBhbGwgcGxhbmVzCj4gICAJICogYnV0IGxlYXZlIHRoZSBwaXBlIHJ1bm5pbmcu
Cj4gICAJICovCj4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCAyKSkKPiAtCQlpbnRlbF9zZXRfY3B1
X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRldl9wcml2LCBwaXBlLCB0cnVlKTsKPiArCWlmIChJ
U19HRU4oaTkxNSwgMikpCj4gKwkJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGlu
ZyhpOTE1LCBwaXBlLCB0cnVlKTsKPiAgIAo+ICAgCS8qIFVuZGVycnVucyBkb24ndCBhbHdheXMg
cmFpc2UgaW50ZXJydXB0cywgc28gY2hlY2sgbWFudWFsbHkuICovCj4gLQlpbnRlbF9jaGVja19j
cHVfZmlmb191bmRlcnJ1bnMoZGV2X3ByaXYpOwo+IC0JaW50ZWxfY2hlY2tfcGNoX2ZpZm9fdW5k
ZXJydW5zKGRldl9wcml2KTsKPiArCWludGVsX2NoZWNrX2NwdV9maWZvX3VuZGVycnVucyhpOTE1
KTsKPiArCWludGVsX2NoZWNrX3BjaF9maWZvX3VuZGVycnVucyhpOTE1KTsKPiAgIH0KPiAgIAo+
ICAgLyogRklYTUUgZ2V0IHJpZCBvZiB0aGlzIGFuZCB1c2UgcHJlX3BsYW5lX3VwZGF0ZSAqLwo+
IEBAIC01NzU5LDcgKzU3NTksNyBAQCBzdGF0aWMgdm9pZAo+ICAgaW50ZWxfcHJlX2Rpc2FibGVf
cHJpbWFyeV9ub2F0b21pYyhzdHJ1Y3QgZHJtX2NydGMgKmNydGMpCj4gICB7Cj4gICAJc3RydWN0
IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmRldjsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0g
dG9faW50ZWxfY3J0YyhjcnRjKTsKPiAgIAlpbnQgcGlwZSA9IGludGVsX2NydGMtPnBpcGU7Cj4g
ICAKPiBAQCAtNTc2Nyw4ICs1NzY3LDggQEAgaW50ZWxfcHJlX2Rpc2FibGVfcHJpbWFyeV9ub2F0
b21pYyhzdHJ1Y3QgZHJtX2NydGMgKmNydGMpCj4gICAJICogR2VuMiByZXBvcnRzIHBpcGUgdW5k
ZXJydW5zIHdoZW5ldmVyIGFsbCBwbGFuZXMgYXJlIGRpc2FibGVkLgo+ICAgCSAqIFNvIGRpc2Fi
bGUgdW5kZXJydW4gcmVwb3J0aW5nIGJlZm9yZSBhbGwgdGhlIHBsYW5lcyBnZXQgZGlzYWJsZWQu
Cj4gICAJICovCj4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCAyKSkKPiAtCQlpbnRlbF9zZXRfY3B1
X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRldl9wcml2LCBwaXBlLCBmYWxzZSk7Cj4gKwlpZiAo
SVNfR0VOKGk5MTUsIDIpKQo+ICsJCWludGVsX3NldF9jcHVfZmlmb191bmRlcnJ1bl9yZXBvcnRp
bmcoaTkxNSwgcGlwZSwgZmFsc2UpOwo+ICAgCj4gICAJaHN3X2Rpc2FibGVfaXBzKHRvX2ludGVs
X2NydGNfc3RhdGUoY3J0Yy0+c3RhdGUpKTsKPiAgIAo+IEBAIC01NzgxLDE2ICs1NzgxLDE2IEBA
IGludGVsX3ByZV9kaXNhYmxlX3ByaW1hcnlfbm9hdG9taWMoc3RydWN0IGRybV9jcnRjICpjcnRj
KQo+ICAgCSAqIGV2ZW50IHdoaWNoIGlzIGFmdGVyIHRoZSB2Ymxhbmsgc3RhcnQgZXZlbnQsIHNv
IHdlIG5lZWQgdG8gaGF2ZSBhCj4gICAJICogd2FpdC1mb3ItdmJsYW5rIGJldHdlZW4gZGlzYWJs
aW5nIHRoZSBwbGFuZSBhbmQgdGhlIHBpcGUuCj4gICAJICovCj4gLQlpZiAoSEFTX0dNQ0goZGV2
X3ByaXYpICYmCj4gLQkgICAgaW50ZWxfc2V0X21lbW9yeV9jeHNyKGRldl9wcml2LCBmYWxzZSkp
Cj4gLQkJaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGRldl9wcml2LCBwaXBlKTsKPiArCWlmIChIQVNf
R01DSChpOTE1KSAmJgo+ICsJICAgIGludGVsX3NldF9tZW1vcnlfY3hzcihpOTE1LCBmYWxzZSkp
Cj4gKwkJaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGk5MTUsIHBpcGUpOwo+ICAgfQo+ICAgCj4gICBz
dGF0aWMgYm9vbCBoc3dfcHJlX3VwZGF0ZV9kaXNhYmxlX2lwcyhjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCj4gICAJCQkJICAgICAgIGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMobmV3X2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2Uu
ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5i
YXNlLmRldik7Cj4gICAKPiAgIAlpZiAoIW9sZF9jcnRjX3N0YXRlLT5pcHNfZW5hYmxlZCkKPiAg
IAkJcmV0dXJuIGZhbHNlOwo+IEBAIC01ODA0LDcgKzU4MDQsNyBAQCBzdGF0aWMgYm9vbCBoc3df
cHJlX3VwZGF0ZV9kaXNhYmxlX2lwcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xk
X2NydGNfcwo+ICAgCSAqCj4gICAJICogRGlzYWJsZSBJUFMgYmVmb3JlIHdlIHByb2dyYW0gdGhl
IExVVC4KPiAgIAkgKi8KPiAtCWlmIChJU19IQVNXRUxMKGRldl9wcml2KSAmJgo+ICsJaWYgKElT
X0hBU1dFTEwoaTkxNSkgJiYKPiAgIAkgICAgKG5ld19jcnRjX3N0YXRlLT5iYXNlLmNvbG9yX21n
bXRfY2hhbmdlZCB8fAo+ICAgCSAgICAgbmV3X2NydGNfc3RhdGUtPnVwZGF0ZV9waXBlKSAmJgo+
ICAgCSAgICBuZXdfY3J0Y19zdGF0ZS0+Z2FtbWFfbW9kZSA9PSBHQU1NQV9NT0RFX01PREVfU1BM
SVQpCj4gQEAgLTU4MTcsNyArNTgxNyw3IEBAIHN0YXRpYyBib29sIGhzd19wb3N0X3VwZGF0ZV9l
bmFibGVfaXBzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zCj4gICAJ
CQkJICAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0ZSkK
PiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMobmV3X2Ny
dGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gICAKPiAgIAlpZiAoIW5ld19jcnRj
X3N0YXRlLT5pcHNfZW5hYmxlZCkKPiAgIAkJcmV0dXJuIGZhbHNlOwo+IEBAIC01ODMxLDcgKzU4
MzEsNyBAQCBzdGF0aWMgYm9vbCBoc3dfcG9zdF91cGRhdGVfZW5hYmxlX2lwcyhjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfcwo+ICAgCSAqCj4gICAJICogUmUtZW5hYmxl
IElQUyBhZnRlciB0aGUgTFVUIGhhcyBiZWVuIHByb2dyYW1tZWQuCj4gICAJICovCj4gLQlpZiAo
SVNfSEFTV0VMTChkZXZfcHJpdikgJiYKPiArCWlmIChJU19IQVNXRUxMKGk5MTUpICYmCj4gICAJ
ICAgIChuZXdfY3J0Y19zdGF0ZS0+YmFzZS5jb2xvcl9tZ210X2NoYW5nZWQgfHwKPiAgIAkgICAg
IG5ld19jcnRjX3N0YXRlLT51cGRhdGVfcGlwZSkgJiYKPiAgIAkgICAgbmV3X2NydGNfc3RhdGUt
PmdhbW1hX21vZGUgPT0gR0FNTUFfTU9ERV9NT0RFX1NQTElUKQo+IEBAIC01ODQ4LDI0ICs1ODQ4
LDI0IEBAIHN0YXRpYyBib29sIGhzd19wb3N0X3VwZGF0ZV9lbmFibGVfaXBzKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zCj4gICAJcmV0dXJuICFvbGRfY3J0Y19zdGF0
ZS0+aXBzX2VuYWJsZWQ7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGJvb2wgbmVlZHNfbnYxMl93YShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBib29sIG5lZWRzX252
MTJfd2Eoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgIGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgewo+ICAgCWlmICghY3J0Y19zdGF0
ZS0+bnYxMl9wbGFuZXMpCj4gICAJCXJldHVybiBmYWxzZTsKPiAgIAo+ICAgCS8qIFdBIERpc3Bs
YXkgIzA4Mjc6IEdlbjk6YWxsICovCj4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCA5KSAmJiAhSVNf
R0VNSU5JTEFLRShkZXZfcHJpdikpCj4gKwlpZiAoSVNfR0VOKGk5MTUsIDkpICYmICFJU19HRU1J
TklMQUtFKGk5MTUpKQo+ICAgCQlyZXR1cm4gdHJ1ZTsKPiAgIAo+ICAgCXJldHVybiBmYWxzZTsK
PiAgIH0KPiAgIAo+IC1zdGF0aWMgYm9vbCBuZWVkc19zY2FsZXJjbGtfd2Eoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgYm9vbCBuZWVkc19zY2FsZXJjbGtfd2Eo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICAgICAgY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gICAJLyogV2FfMjAwNjYwNDMx
MjppY2wgKi8KPiAtCWlmIChjcnRjX3N0YXRlLT5zY2FsZXJfc3RhdGUuc2NhbGVyX3VzZXJzID4g
MCAmJiBJU19JQ0VMQUtFKGRldl9wcml2KSkKPiArCWlmIChjcnRjX3N0YXRlLT5zY2FsZXJfc3Rh
dGUuc2NhbGVyX3VzZXJzID4gMCAmJiBJU19JQ0VMQUtFKGk5MTUpKQo+ICAgCQlyZXR1cm4gdHJ1
ZTsKPiAgIAo+ICAgCXJldHVybiBmYWxzZTsKPiBAQCAtNTg3NSw3ICs1ODc1LDcgQEAgc3RhdGlj
IHZvaWQgaW50ZWxfcG9zdF9wbGFuZV91cGRhdGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9s
ZF9jcnRjX3N0YXRlKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50
ZWxfY3J0YyhvbGRfY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAgIAlzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoZGV2KTsKPiAgIAlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqb2xkX3N0YXRlID0g
b2xkX2NydGNfc3RhdGUtPmJhc2Uuc3RhdGU7Cj4gICAJc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KnBpcGVfY29uZmlnID0KPiAgIAkJaW50ZWxfYXRvbWljX2dldF9uZXdfY3J0Y19zdGF0ZSh0b19p
bnRlbF9hdG9taWNfc3RhdGUob2xkX3N0YXRlKSwKPiBAQCAtNTkwNCwxMyArNTkwNCwxMyBAQCBz
dGF0aWMgdm9pZCBpbnRlbF9wb3N0X3BsYW5lX3VwZGF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqb2xkX2NydGNfc3RhdGUpCj4gICAJCQlpbnRlbF9wb3N0X2VuYWJsZV9wcmltYXJ5KCZjcnRj
LT5iYXNlLCBwaXBlX2NvbmZpZyk7Cj4gICAJfQo+ICAgCj4gLQlpZiAobmVlZHNfbnYxMl93YShk
ZXZfcHJpdiwgb2xkX2NydGNfc3RhdGUpICYmCj4gLQkgICAgIW5lZWRzX252MTJfd2EoZGV2X3By
aXYsIHBpcGVfY29uZmlnKSkKPiAtCQlza2xfd2FfODI3KGRldl9wcml2LCBjcnRjLT5waXBlLCBm
YWxzZSk7Cj4gKwlpZiAobmVlZHNfbnYxMl93YShpOTE1LCBvbGRfY3J0Y19zdGF0ZSkgJiYKPiAr
CSAgICAhbmVlZHNfbnYxMl93YShpOTE1LCBwaXBlX2NvbmZpZykpCj4gKwkJc2tsX3dhXzgyNyhp
OTE1LCBjcnRjLT5waXBlLCBmYWxzZSk7Cj4gICAKPiAtCWlmIChuZWVkc19zY2FsZXJjbGtfd2Eo
ZGV2X3ByaXYsIG9sZF9jcnRjX3N0YXRlKSAmJgo+IC0JICAgICFuZWVkc19zY2FsZXJjbGtfd2Eo
ZGV2X3ByaXYsIHBpcGVfY29uZmlnKSkKPiAtCQlpY2xfd2Ffc2NhbGVyY2xrZ2F0aW5nKGRldl9w
cml2LCBjcnRjLT5waXBlLCBmYWxzZSk7Cj4gKwlpZiAobmVlZHNfc2NhbGVyY2xrX3dhKGk5MTUs
IG9sZF9jcnRjX3N0YXRlKSAmJgo+ICsJICAgICFuZWVkc19zY2FsZXJjbGtfd2EoaTkxNSwgcGlw
ZV9jb25maWcpKQo+ICsJCWljbF93YV9zY2FsZXJjbGtnYXRpbmcoaTkxNSwgY3J0Yy0+cGlwZSwg
ZmFsc2UpOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZCBpbnRlbF9wcmVfcGxhbmVfdXBkYXRl
KHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKPiBAQCAtNTkxOCw3ICs1
OTE4LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfcHJlX3BsYW5lX3VwZGF0ZShzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2NydGMg
KmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICAgCXN0
cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5iYXNlLmRldjsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRl
ICpvbGRfc3RhdGUgPSBvbGRfY3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZTsKPiAgIAlzdHJ1Y3QgZHJt
X3BsYW5lICpwcmltYXJ5ID0gY3J0Yy0+YmFzZS5wcmltYXJ5Owo+ICAgCXN0cnVjdCBkcm1fcGxh
bmVfc3RhdGUgKm9sZF9wcmltYXJ5X3N0YXRlID0KPiBAQCAtNTk0MCwyMCArNTk0MCwyMCBAQCBz
dGF0aWMgdm9pZCBpbnRlbF9wcmVfcGxhbmVfdXBkYXRlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpvbGRfY3J0Y19zdGF0ZSwKPiAgIAkJICogR2VuMiByZXBvcnRzIHBpcGUgdW5kZXJydW5zIHdo
ZW5ldmVyIGFsbCBwbGFuZXMgYXJlIGRpc2FibGVkLgo+ICAgCQkgKiBTbyBkaXNhYmxlIHVuZGVy
cnVuIHJlcG9ydGluZyBiZWZvcmUgYWxsIHRoZSBwbGFuZXMgZ2V0IGRpc2FibGVkLgo+ICAgCQkg
Ki8KPiAtCQlpZiAoSVNfR0VOKGRldl9wcml2LCAyKSAmJiBvbGRfcHJpbWFyeV9zdGF0ZS0+dmlz
aWJsZSAmJgo+ICsJCWlmIChJU19HRU4oaTkxNSwgMikgJiYgb2xkX3ByaW1hcnlfc3RhdGUtPnZp
c2libGUgJiYKPiAgIAkJICAgIChtb2Rlc2V0IHx8ICFuZXdfcHJpbWFyeV9zdGF0ZS0+YmFzZS52
aXNpYmxlKSkKPiAtCQkJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZf
cHJpdiwgY3J0Yy0+cGlwZSwgZmFsc2UpOwo+ICsJCQlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJy
dW5fcmVwb3J0aW5nKGk5MTUsIGNydGMtPnBpcGUsIGZhbHNlKTsKPiAgIAl9Cj4gICAKPiAgIAkv
KiBEaXNwbGF5IFdBIDgyNyAqLwo+IC0JaWYgKCFuZWVkc19udjEyX3dhKGRldl9wcml2LCBvbGRf
Y3J0Y19zdGF0ZSkgJiYKPiAtCSAgICBuZWVkc19udjEyX3dhKGRldl9wcml2LCBwaXBlX2NvbmZp
ZykpCj4gLQkJc2tsX3dhXzgyNyhkZXZfcHJpdiwgY3J0Yy0+cGlwZSwgdHJ1ZSk7Cj4gKwlpZiAo
IW5lZWRzX252MTJfd2EoaTkxNSwgb2xkX2NydGNfc3RhdGUpICYmCj4gKwkgICAgbmVlZHNfbnYx
Ml93YShpOTE1LCBwaXBlX2NvbmZpZykpCj4gKwkJc2tsX3dhXzgyNyhpOTE1LCBjcnRjLT5waXBl
LCB0cnVlKTsKPiAgIAo+ICAgCS8qIFdhXzIwMDY2MDQzMTI6aWNsICovCj4gLQlpZiAoIW5lZWRz
X3NjYWxlcmNsa193YShkZXZfcHJpdiwgb2xkX2NydGNfc3RhdGUpICYmCj4gLQkgICAgbmVlZHNf
c2NhbGVyY2xrX3dhKGRldl9wcml2LCBwaXBlX2NvbmZpZykpCj4gLQkJaWNsX3dhX3NjYWxlcmNs
a2dhdGluZyhkZXZfcHJpdiwgY3J0Yy0+cGlwZSwgdHJ1ZSk7Cj4gKwlpZiAoIW5lZWRzX3NjYWxl
cmNsa193YShpOTE1LCBvbGRfY3J0Y19zdGF0ZSkgJiYKPiArCSAgICBuZWVkc19zY2FsZXJjbGtf
d2EoaTkxNSwgcGlwZV9jb25maWcpKQo+ICsJCWljbF93YV9zY2FsZXJjbGtnYXRpbmcoaTkxNSwg
Y3J0Yy0+cGlwZSwgdHJ1ZSk7Cj4gICAKPiAgIAkvKgo+ICAgCSAqIFZibGFuayB0aW1lIHVwZGF0
ZXMgZnJvbSB0aGUgc2hhZG93IHRvIGxpdmUgcGxhbmUgY29udHJvbCByZWdpc3Rlcgo+IEBAIC01
OTY0LDkgKzU5NjQsOSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wcmVfcGxhbmVfdXBkYXRlKHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKPiAgIAkgKiBldmVudCB3aGljaCBp
cyBhZnRlciB0aGUgdmJsYW5rIHN0YXJ0IGV2ZW50LCBzbyB3ZSBuZWVkIHRvIGhhdmUgYQo+ICAg
CSAqIHdhaXQtZm9yLXZibGFuayBiZXR3ZWVuIGRpc2FibGluZyB0aGUgcGxhbmUgYW5kIHRoZSBw
aXBlLgo+ICAgCSAqLwo+IC0JaWYgKEhBU19HTUNIKGRldl9wcml2KSAmJiBvbGRfY3J0Y19zdGF0
ZS0+YmFzZS5hY3RpdmUgJiYKPiAtCSAgICBwaXBlX2NvbmZpZy0+ZGlzYWJsZV9jeHNyICYmIGlu
dGVsX3NldF9tZW1vcnlfY3hzcihkZXZfcHJpdiwgZmFsc2UpKQo+IC0JCWludGVsX3dhaXRfZm9y
X3ZibGFuayhkZXZfcHJpdiwgY3J0Yy0+cGlwZSk7Cj4gKwlpZiAoSEFTX0dNQ0goaTkxNSkgJiYg
b2xkX2NydGNfc3RhdGUtPmJhc2UuYWN0aXZlICYmCj4gKwkgICAgcGlwZV9jb25maWctPmRpc2Fi
bGVfY3hzciAmJiBpbnRlbF9zZXRfbWVtb3J5X2N4c3IoaTkxNSwgZmFsc2UpKQo+ICsJCWludGVs
X3dhaXRfZm9yX3ZibGFuayhpOTE1LCBjcnRjLT5waXBlKTsKPiAgIAo+ICAgCS8qCj4gICAJICog
SVZCIHdvcmthcm91bmQ6IG11c3QgZGlzYWJsZSBsb3cgcG93ZXIgd2F0ZXJtYXJrcyBmb3IgYXQg
bGVhc3QKPiBAQCAtNTk3Nyw3ICs1OTc3LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfcHJlX3BsYW5l
X3VwZGF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCj4gICAJICov
Cj4gICAJaWYgKHBpcGVfY29uZmlnLT5kaXNhYmxlX2xwX3dtICYmIGlsa19kaXNhYmxlX2xwX3dt
KGRldikgJiYKPiAgIAkgICAgb2xkX2NydGNfc3RhdGUtPmJhc2UuYWN0aXZlKQo+IC0JCWludGVs
X3dhaXRfZm9yX3ZibGFuayhkZXZfcHJpdiwgY3J0Yy0+cGlwZSk7Cj4gKwkJaW50ZWxfd2FpdF9m
b3JfdmJsYW5rKGk5MTUsIGNydGMtPnBpcGUpOwo+ICAgCj4gICAJLyoKPiAgIAkgKiBJZiB3ZSdy
ZSBkb2luZyBhIG1vZGVzZXQsIHdlJ3JlIGRvbmUuICBObyBuZWVkIHRvIGRvIGFueSBwcmUtdmJs
YW5rCj4gQEAgLTYwMDAsOCArNjAwMCw4IEBAIHN0YXRpYyB2b2lkIGludGVsX3ByZV9wbGFuZV91
cGRhdGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+ICAgCSAqIHdl
J2xsIGNvbnRpbnVlIHRvIHVwZGF0ZSB3YXRlcm1hcmtzIHRoZSBvbGQgd2F5LCBpZiBmbGFncyB0
ZWxsCj4gICAJICogdXMgdG8uCj4gICAJICovCj4gLQlpZiAoZGV2X3ByaXYtPmRpc3BsYXkuaW5p
dGlhbF93YXRlcm1hcmtzICE9IE5VTEwpCj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuaW5pdGlhbF93
YXRlcm1hcmtzKG9sZF9pbnRlbF9zdGF0ZSwKPiArCWlmIChpOTE1LT5kaXNwbGF5LmluaXRpYWxf
d2F0ZXJtYXJrcyAhPSBOVUxMKQo+ICsJCWk5MTUtPmRpc3BsYXkuaW5pdGlhbF93YXRlcm1hcmtz
KG9sZF9pbnRlbF9zdGF0ZSwKPiAgIAkJCQkJCSAgICAgcGlwZV9jb25maWcpOwo+ICAgCWVsc2Ug
aWYgKHBpcGVfY29uZmlnLT51cGRhdGVfd21fcHJlKQo+ICAgCQlpbnRlbF91cGRhdGVfd2F0ZXJt
YXJrcyhjcnRjKTsKPiBAQCAtNjAxMCw3ICs2MDEwLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfcHJl
X3BsYW5lX3VwZGF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCj4g
ICBzdGF0aWMgdm9pZCBpbnRlbF9jcnRjX2Rpc2FibGVfcGxhbmVzKHN0cnVjdCBpbnRlbF9hdG9t
aWNfc3RhdGUgKnN0YXRlLAo+ICAgCQkJCSAgICAgIHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+
ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
Y3J0Yy0+YmFzZS5kZXYpOwo+ICAgCWNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpuZXdf
Y3J0Y19zdGF0ZSA9Cj4gICAJCWludGVsX2F0b21pY19nZXRfbmV3X2NydGNfc3RhdGUoc3RhdGUs
IGNydGMpOwo+ICAgCXVuc2lnbmVkIGludCB1cGRhdGVfbWFzayA9IG5ld19jcnRjX3N0YXRlLT51
cGRhdGVfcGxhbmVzOwo+IEBAIC02MDMyLDcgKzYwMzIsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9j
cnRjX2Rpc2FibGVfcGxhbmVzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+ICAg
CQkJZmJfYml0cyB8PSBwbGFuZS0+ZnJvbnRidWZmZXJfYml0Owo+ICAgCX0KPiAgIAo+IC0JaW50
ZWxfZnJvbnRidWZmZXJfZmxpcChkZXZfcHJpdiwgZmJfYml0cyk7Cj4gKwlpbnRlbF9mcm9udGJ1
ZmZlcl9mbGlwKGk5MTUsIGZiX2JpdHMpOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZCBpbnRl
bF9lbmNvZGVyc19wcmVfcGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gQEAgLTYx
OTAsNyArNjE5MCw3IEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX2NydGNfZW5hYmxlKHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2NydGMg
KmNydGMgPSBwaXBlX2NvbmZpZy0+YmFzZS5jcnRjOwo+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYgPSBjcnRjLT5kZXY7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
ZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMo
Y3J0Yyk7Cj4gICAJaW50IHBpcGUgPSBpbnRlbF9jcnRjLT5waXBlOwo+ICAgCXN0cnVjdCBpbnRl
bF9hdG9taWNfc3RhdGUgKm9sZF9pbnRlbF9zdGF0ZSA9Cj4gQEAgLTYyMDksOCArNjIwOSw4IEBA
IHN0YXRpYyB2b2lkIGlyb25sYWtlX2NydGNfZW5hYmxlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpwaXBlX2NvbmZpZywKPiAgIAkgKgo+ICAgCSAqIFNwdXJpb3VzIFBDSCB1bmRlcnJ1bnMgYWxz
byBvY2N1ciBkdXJpbmcgUENIIGVuYWJsaW5nLgo+ICAgCSAqLwo+IC0JaW50ZWxfc2V0X2NwdV9m
aWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZfcHJpdiwgcGlwZSwgZmFsc2UpOwo+IC0JaW50ZWxf
c2V0X3BjaF9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZfcHJpdiwgcGlwZSwgZmFsc2UpOwo+
ICsJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhpOTE1LCBwaXBlLCBmYWxz
ZSk7Cj4gKwlpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGk5MTUsIHBpcGUs
IGZhbHNlKTsKPiAgIAo+ICAgCWlmIChwaXBlX2NvbmZpZy0+aGFzX3BjaF9lbmNvZGVyKQo+ICAg
CQlpbnRlbF9wcmVwYXJlX3NoYXJlZF9kcGxsKHBpcGVfY29uZmlnKTsKPiBAQCAtNjIzOCw4ICs2
MjM4LDggQEAgc3RhdGljIHZvaWQgaXJvbmxha2VfY3J0Y19lbmFibGUoc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ICAgCQkgKiBlbmFibGluZy4gKi8KPiAgIAkJaXJvbmxh
a2VfZmRpX3BsbF9lbmFibGUocGlwZV9jb25maWcpOwo+ICAgCX0gZWxzZSB7Cj4gLQkJYXNzZXJ0
X2ZkaV90eF9kaXNhYmxlZChkZXZfcHJpdiwgcGlwZSk7Cj4gLQkJYXNzZXJ0X2ZkaV9yeF9kaXNh
YmxlZChkZXZfcHJpdiwgcGlwZSk7Cj4gKwkJYXNzZXJ0X2ZkaV90eF9kaXNhYmxlZChpOTE1LCBw
aXBlKTsKPiArCQlhc3NlcnRfZmRpX3J4X2Rpc2FibGVkKGk5MTUsIHBpcGUpOwo+ICAgCX0KPiAg
IAo+ICAgCWlyb25sYWtlX3BmaXRfZW5hYmxlKHBpcGVfY29uZmlnKTsKPiBAQCAtNjI1Myw4ICs2
MjUzLDggQEAgc3RhdGljIHZvaWQgaXJvbmxha2VfY3J0Y19lbmFibGUoc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ICAgCS8qIHVwZGF0ZSBEU1BDTlRSIHRvIGNvbmZpZ3Vy
ZSBnYW1tYSBmb3IgcGlwZSBib3R0b20gY29sb3IgKi8KPiAgIAlpbnRlbF9kaXNhYmxlX3ByaW1h
cnlfcGxhbmUocGlwZV9jb25maWcpOwo+ICAgCj4gLQlpZiAoZGV2X3ByaXYtPmRpc3BsYXkuaW5p
dGlhbF93YXRlcm1hcmtzICE9IE5VTEwpCj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuaW5pdGlhbF93
YXRlcm1hcmtzKG9sZF9pbnRlbF9zdGF0ZSwgcGlwZV9jb25maWcpOwo+ICsJaWYgKGk5MTUtPmRp
c3BsYXkuaW5pdGlhbF93YXRlcm1hcmtzICE9IE5VTEwpCj4gKwkJaTkxNS0+ZGlzcGxheS5pbml0
aWFsX3dhdGVybWFya3Mob2xkX2ludGVsX3N0YXRlLCBwaXBlX2NvbmZpZyk7Cj4gICAJaW50ZWxf
ZW5hYmxlX3BpcGUocGlwZV9jb25maWcpOwo+ICAgCj4gICAJaWYgKHBpcGVfY29uZmlnLT5oYXNf
cGNoX2VuY29kZXIpCj4gQEAgLTYyNjUsNyArNjI2NSw3IEBAIHN0YXRpYyB2b2lkIGlyb25sYWtl
X2NydGNfZW5hYmxlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKPiAgIAo+
ICAgCWludGVsX2VuY29kZXJzX2VuYWJsZShjcnRjLCBwaXBlX2NvbmZpZywgb2xkX3N0YXRlKTsK
PiAgIAo+IC0JaWYgKEhBU19QQ0hfQ1BUKGRldl9wcml2KSkKPiArCWlmIChIQVNfUENIX0NQVChp
OTE1KSkKPiAgIAkJY3B0X3ZlcmlmeV9tb2Rlc2V0KGRldiwgaW50ZWxfY3J0Yy0+cGlwZSk7Cj4g
ICAKPiAgIAkvKgo+IEBAIC02Mjc1LDExICs2Mjc1LDExIEBAIHN0YXRpYyB2b2lkIGlyb25sYWtl
X2NydGNfZW5hYmxlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKPiAgIAkg
KiBpbiBjYXNlIHRoZXJlIGFyZSBtb3JlIGNvcm5lciBjYXNlcyB3ZSBkb24ndCBrbm93IGFib3V0
Lgo+ICAgCSAqLwo+ICAgCWlmIChwaXBlX2NvbmZpZy0+aGFzX3BjaF9lbmNvZGVyKSB7Cj4gLQkJ
aW50ZWxfd2FpdF9mb3JfdmJsYW5rKGRldl9wcml2LCBwaXBlKTsKPiAtCQlpbnRlbF93YWl0X2Zv
cl92YmxhbmsoZGV2X3ByaXYsIHBpcGUpOwo+ICsJCWludGVsX3dhaXRfZm9yX3ZibGFuayhpOTE1
LCBwaXBlKTsKPiArCQlpbnRlbF93YWl0X2Zvcl92YmxhbmsoaTkxNSwgcGlwZSk7Cj4gICAJfQo+
IC0JaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZfcHJpdiwgcGlwZSwg
dHJ1ZSk7Cj4gLQlpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRldl9wcml2
LCBwaXBlLCB0cnVlKTsKPiArCWludGVsX3NldF9jcHVfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmco
aTkxNSwgcGlwZSwgdHJ1ZSk7Cj4gKwlpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVwb3J0
aW5nKGk5MTUsIHBpcGUsIHRydWUpOwo+ICAgfQo+ICAgCj4gICAvKiBJUFMgb25seSBleGlzdHMg
b24gVUxUIG1hY2hpbmVzIGFuZCBpcyB0aWVkIHRvIHBpcGUgQS4gKi8KPiBAQCAtNjI4OCw3ICs2
Mjg4LDcgQEAgc3RhdGljIGJvb2wgaHN3X2NydGNfc3VwcG9ydHNfaXBzKHN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjKQo+ICAgCXJldHVybiBIQVNfSVBTKHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpKSAm
JiBjcnRjLT5waXBlID09IFBJUEVfQTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBnbGtfcGlw
ZV9zY2FsZXJfY2xvY2tfZ2F0aW5nX3dhKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiArc3RhdGljIHZvaWQgZ2xrX3BpcGVfc2NhbGVyX2Nsb2NrX2dhdGluZ193YShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkJICAgIGVudW0gcGlwZSBwaXBlLCBib29s
IGFwcGx5KQo+ICAgewo+ICAgCXUzMiB2YWwgPSBJOTE1X1JFQUQoQ0xLR0FURV9ESVNfUFNMKHBp
cGUpKTsKPiBAQCAtNjMwNCw3ICs2MzA0LDcgQEAgc3RhdGljIHZvaWQgZ2xrX3BpcGVfc2NhbGVy
X2Nsb2NrX2dhdGluZ193YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAK
PiAgIHN0YXRpYyB2b2lkIGljbF9waXBlX21idXNfZW5hYmxlKHN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsK
PiAgIAl1MzIgdmFsOwo+ICAgCj4gQEAgLTYzMTksNyArNjMxOSw3IEBAIHN0YXRpYyB2b2lkIGhh
c3dlbGxfY3J0Y19lbmFibGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+
ICAgCQkJCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpvbGRfc3RhdGUpCj4gICB7Cj4gICAJc3Ry
dWN0IGRybV9jcnRjICpjcnRjID0gcGlwZV9jb25maWctPmJhc2UuY3J0YzsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+ZGV2KTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5kZXYpOwo+ICAgCXN0cnVj
dCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjKTsKPiAgIAlpbnQg
cGlwZSA9IGludGVsX2NydGMtPnBpcGUsIGhzd193b3JrYXJvdW5kX3BpcGU7Cj4gICAJZW51bSB0
cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0gcGlwZV9jb25maWctPmNwdV90cmFuc2NvZGVyOwo+
IEBAIC02MzU5LDE4ICs2MzU5LDE4IEBAIHN0YXRpYyB2b2lkIGhhc3dlbGxfY3J0Y19lbmFibGUo
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ICAgCWlmICghdHJhbnNjb2Rl
cl9pc19kc2koY3B1X3RyYW5zY29kZXIpKQo+ICAgCQloYXN3ZWxsX3NldF9waXBlY29uZihwaXBl
X2NvbmZpZyk7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkgfHwgSVNfQlJP
QURXRUxMKGRldl9wcml2KSkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSB8fCBJU19CUk9B
RFdFTEwoaTkxNSkpCj4gICAJCWJkd19zZXRfcGlwZW1pc2MocGlwZV9jb25maWcpOwo+ICAgCj4g
ICAJaW50ZWxfY3J0Yy0+YWN0aXZlID0gdHJ1ZTsKPiAgIAo+ICAgCS8qIERpc3BsYXkgV0EgIzEx
ODA6IFdhRGlzYWJsZVNjYWxhckNsb2NrR2F0aW5nOiBnbGssIGNubCAqLwo+IC0JcHNsX2Nsa2dh
dGVfd2EgPSAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikgfHwgSVNfQ0FOTk9OTEFLRShkZXZfcHJp
dikpICYmCj4gKwlwc2xfY2xrZ2F0ZV93YSA9IChJU19HRU1JTklMQUtFKGk5MTUpIHx8IElTX0NB
Tk5PTkxBS0UoaTkxNSkpICYmCj4gICAJCQkgcGlwZV9jb25maWctPnBjaF9wZml0LmVuYWJsZWQ7
Cj4gICAJaWYgKHBzbF9jbGtnYXRlX3dhKQo+IC0JCWdsa19waXBlX3NjYWxlcl9jbG9ja19nYXRp
bmdfd2EoZGV2X3ByaXYsIHBpcGUsIHRydWUpOwo+ICsJCWdsa19waXBlX3NjYWxlcl9jbG9ja19n
YXRpbmdfd2EoaTkxNSwgcGlwZSwgdHJ1ZSk7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDkpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkpCj4gICAJCXNreWxha2VfcGZp
dF9lbmFibGUocGlwZV9jb25maWcpOwo+ICAgCWVsc2UKPiAgIAkJaXJvbmxha2VfcGZpdF9lbmFi
bGUocGlwZV9jb25maWcpOwo+IEBAIC02MzgyLDIwICs2MzgyLDIwIEBAIHN0YXRpYyB2b2lkIGhh
c3dlbGxfY3J0Y19lbmFibGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+
ICAgCWludGVsX2NvbG9yX2xvYWRfbHV0cyhwaXBlX2NvbmZpZyk7Cj4gICAJaW50ZWxfY29sb3Jf
Y29tbWl0KHBpcGVfY29uZmlnKTsKPiAgIAkvKiB1cGRhdGUgRFNQQ05UUiB0byBjb25maWd1cmUg
Z2FtbWEvY3NjIGZvciBwaXBlIGJvdHRvbSBjb2xvciAqLwo+IC0JaWYgKElOVEVMX0dFTihkZXZf
cHJpdikgPCA5KQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8IDkpCj4gICAJCWludGVsX2Rpc2Fi
bGVfcHJpbWFyeV9wbGFuZShwaXBlX2NvbmZpZyk7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2
X3ByaXYpID49IDExKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiAgIAkJaWNsX3Nl
dF9waXBlX2NoaWNrZW4oaW50ZWxfY3J0Yyk7Cj4gICAKPiAgIAlpbnRlbF9kZGlfc2V0X3BpcGVf
c2V0dGluZ3MocGlwZV9jb25maWcpOwo+ICAgCWlmICghdHJhbnNjb2Rlcl9pc19kc2koY3B1X3Ry
YW5zY29kZXIpKQo+ICAgCQlpbnRlbF9kZGlfZW5hYmxlX3RyYW5zY29kZXJfZnVuYyhwaXBlX2Nv
bmZpZyk7Cj4gICAKPiAtCWlmIChkZXZfcHJpdi0+ZGlzcGxheS5pbml0aWFsX3dhdGVybWFya3Mg
IT0gTlVMTCkKPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5pbml0aWFsX3dhdGVybWFya3Mob2xkX2lu
dGVsX3N0YXRlLCBwaXBlX2NvbmZpZyk7Cj4gKwlpZiAoaTkxNS0+ZGlzcGxheS5pbml0aWFsX3dh
dGVybWFya3MgIT0gTlVMTCkKPiArCQlpOTE1LT5kaXNwbGF5LmluaXRpYWxfd2F0ZXJtYXJrcyhv
bGRfaW50ZWxfc3RhdGUsIHBpcGVfY29uZmlnKTsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZf
cHJpdikgPj0gMTEpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKQo+ICAgCQlpY2xfcGlw
ZV9tYnVzX2VuYWJsZShpbnRlbF9jcnRjKTsKPiAgIAo+ICAgCS8qIFhYWDogRG8gdGhlIHBpcGUg
YXNzZXJ0aW9ucyBhdCB0aGUgcmlnaHQgcGxhY2UgZm9yIEJYVCBEU0kuICovCj4gQEAgLTY0MTQs
MjMgKzY0MTQsMjMgQEAgc3RhdGljIHZvaWQgaGFzd2VsbF9jcnRjX2VuYWJsZShzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4gICAJaW50ZWxfZW5jb2RlcnNfZW5hYmxlKGNy
dGMsIHBpcGVfY29uZmlnLCBvbGRfc3RhdGUpOwo+ICAgCj4gICAJaWYgKHBzbF9jbGtnYXRlX3dh
KSB7Cj4gLQkJaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGRldl9wcml2LCBwaXBlKTsKPiAtCQlnbGtf
cGlwZV9zY2FsZXJfY2xvY2tfZ2F0aW5nX3dhKGRldl9wcml2LCBwaXBlLCBmYWxzZSk7Cj4gKwkJ
aW50ZWxfd2FpdF9mb3JfdmJsYW5rKGk5MTUsIHBpcGUpOwo+ICsJCWdsa19waXBlX3NjYWxlcl9j
bG9ja19nYXRpbmdfd2EoaTkxNSwgcGlwZSwgZmFsc2UpOwo+ICAgCX0KPiAgIAo+ICAgCS8qIElm
IHdlIGNoYW5nZSB0aGUgcmVsYXRpdmUgb3JkZXIgYmV0d2VlbiBwaXBlL3BsYW5lcyBlbmFibGlu
Zywgd2UgbmVlZAo+ICAgCSAqIHRvIGNoYW5nZSB0aGUgd29ya2Fyb3VuZC4gKi8KPiAgIAloc3df
d29ya2Fyb3VuZF9waXBlID0gcGlwZV9jb25maWctPmhzd193b3JrYXJvdW5kX3BpcGU7Cj4gLQlp
ZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgJiYgaHN3X3dvcmthcm91bmRfcGlwZSAhPSBJTlZBTElE
X1BJUEUpIHsKPiAtCQlpbnRlbF93YWl0X2Zvcl92YmxhbmsoZGV2X3ByaXYsIGhzd193b3JrYXJv
dW5kX3BpcGUpOwo+IC0JCWludGVsX3dhaXRfZm9yX3ZibGFuayhkZXZfcHJpdiwgaHN3X3dvcmth
cm91bmRfcGlwZSk7Cj4gKwlpZiAoSVNfSEFTV0VMTChpOTE1KSAmJiBoc3dfd29ya2Fyb3VuZF9w
aXBlICE9IElOVkFMSURfUElQRSkgewo+ICsJCWludGVsX3dhaXRfZm9yX3ZibGFuayhpOTE1LCBo
c3dfd29ya2Fyb3VuZF9waXBlKTsKPiArCQlpbnRlbF93YWl0X2Zvcl92YmxhbmsoaTkxNSwgaHN3
X3dvcmthcm91bmRfcGlwZSk7Cj4gICAJfQo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZCBpcm9u
bGFrZV9wZml0X2Rpc2FibGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRj
X3N0YXRlKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0
YyhvbGRfY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAllbnVtIHBpcGUg
cGlwZSA9IGNydGMtPnBpcGU7Cj4gICAKPiAgIAkvKiBUbyBhdm9pZCB1cHNldHRpbmcgdGhlIHBv
d2VyIHdlbGwgb24gaGFzd2VsbCBvbmx5IGRpc2FibGUgdGhlIHBmaXQgaWYKPiBAQCAtNjQ0Nyw3
ICs2NDQ3LDcgQEAgc3RhdGljIHZvaWQgaXJvbmxha2VfY3J0Y19kaXNhYmxlKHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2NydGMg
KmNydGMgPSBvbGRfY3J0Y19zdGF0ZS0+YmFzZS5jcnRjOwo+ICAgCXN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYgPSBjcnRjLT5kZXY7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2Ny
dGMoY3J0Yyk7Cj4gICAJaW50IHBpcGUgPSBpbnRlbF9jcnRjLT5waXBlOwo+ICAgCj4gQEAgLTY0
NTYsOCArNjQ1Niw4IEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX2NydGNfZGlzYWJsZShzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCj4gICAJICogcGlwZSBpcyBhbHJlYWR5
IGRpc2FibGVkLCBidXQgRkRJIFJYL1RYIGlzIHN0aWxsIGVuYWJsZWQuCj4gICAJICogSGFwcGVu
cyBhdCBsZWFzdCB3aXRoIFZHQStIRE1JIGNsb25pbmcuIFN1cHByZXNzIHRoZW0uCj4gICAJICov
Cj4gLQlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRldl9wcml2LCBwaXBl
LCBmYWxzZSk7Cj4gLQlpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRldl9w
cml2LCBwaXBlLCBmYWxzZSk7Cj4gKwlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0
aW5nKGk5MTUsIHBpcGUsIGZhbHNlKTsKPiArCWludGVsX3NldF9wY2hfZmlmb191bmRlcnJ1bl9y
ZXBvcnRpbmcoaTkxNSwgcGlwZSwgZmFsc2UpOwo+ICAgCj4gICAJaW50ZWxfZW5jb2RlcnNfZGlz
YWJsZShjcnRjLCBvbGRfY3J0Y19zdGF0ZSwgb2xkX3N0YXRlKTsKPiAgIAo+IEBAIC02NDc0LDkg
KzY0NzQsOSBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9jcnRjX2Rpc2FibGUoc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+ICAgCWludGVsX2VuY29kZXJzX3Bvc3RfZGlz
YWJsZShjcnRjLCBvbGRfY3J0Y19zdGF0ZSwgb2xkX3N0YXRlKTsKPiAgIAo+ICAgCWlmIChvbGRf
Y3J0Y19zdGF0ZS0+aGFzX3BjaF9lbmNvZGVyKSB7Cj4gLQkJaXJvbmxha2VfZGlzYWJsZV9wY2hf
dHJhbnNjb2RlcihkZXZfcHJpdiwgcGlwZSk7Cj4gKwkJaXJvbmxha2VfZGlzYWJsZV9wY2hfdHJh
bnNjb2RlcihpOTE1LCBwaXBlKTsKPiAgIAo+IC0JCWlmIChIQVNfUENIX0NQVChkZXZfcHJpdikp
IHsKPiArCQlpZiAoSEFTX1BDSF9DUFQoaTkxNSkpIHsKPiAgIAkJCWk5MTVfcmVnX3QgcmVnOwo+
ICAgCQkJdTMyIHRlbXA7Cj4gICAKPiBAQCAtNjQ5NywxNSArNjQ5NywxNSBAQCBzdGF0aWMgdm9p
ZCBpcm9ubGFrZV9jcnRjX2Rpc2FibGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRj
X3N0YXRlLAo+ICAgCQlpcm9ubGFrZV9mZGlfcGxsX2Rpc2FibGUoaW50ZWxfY3J0Yyk7Cj4gICAJ
fQo+ICAgCj4gLQlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRldl9wcml2
LCBwaXBlLCB0cnVlKTsKPiAtCWludGVsX3NldF9wY2hfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmco
ZGV2X3ByaXYsIHBpcGUsIHRydWUpOwo+ICsJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3Jl
cG9ydGluZyhpOTE1LCBwaXBlLCB0cnVlKTsKPiArCWludGVsX3NldF9wY2hfZmlmb191bmRlcnJ1
bl9yZXBvcnRpbmcoaTkxNSwgcGlwZSwgdHJ1ZSk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lk
IGhhc3dlbGxfY3J0Y19kaXNhYmxlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19z
dGF0ZSwKPiAgIAkJCQkgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKm9sZF9zdGF0ZSkKPiAgIHsK
PiAgIAlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSBvbGRfY3J0Y19zdGF0ZS0+YmFzZS5jcnRjOwo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5kZXYp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmRldik7
Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGMp
Owo+ICAgCWVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNjb2RlciA9IG9sZF9jcnRjX3N0YXRlLT5j
cHVfdHJhbnNjb2RlcjsKPiAgIAo+IEBAIC02NTI2LDcgKzY1MjYsNyBAQCBzdGF0aWMgdm9pZCBo
YXN3ZWxsX2NydGNfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3Rh
dGUsCj4gICAKPiAgIAlpbnRlbF9kc2NfZGlzYWJsZShvbGRfY3J0Y19zdGF0ZSk7Cj4gICAKPiAt
CWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49
IDkpCj4gICAJCXNreWxha2Vfc2NhbGVyX2Rpc2FibGUoaW50ZWxfY3J0Yyk7Cj4gICAJZWxzZQo+
ICAgCQlpcm9ubGFrZV9wZml0X2Rpc2FibGUob2xkX2NydGNfc3RhdGUpOwo+IEBAIC02NTM5LDcg
KzY1MzksNyBAQCBzdGF0aWMgdm9pZCBoYXN3ZWxsX2NydGNfZGlzYWJsZShzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCj4gICBzdGF0aWMgdm9pZCBpOXh4X3BmaXRfZW5h
YmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgewo+ICAg
CXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNl
LmNydGMpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShj
cnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAgCj4gICAJaWYgKCFjcnRjX3N0YXRlLT5nbWNoX3BmaXQu
Y29udHJvbCkKPiAgIAkJcmV0dXJuOwo+IEBAIC02NTQ5LDcgKzY1NDksNyBAQCBzdGF0aWMgdm9p
ZCBpOXh4X3BmaXRfZW5hYmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlKQo+ICAgCSAqIGFjY29yZGluZyB0byByZWdpc3RlciBkZXNjcmlwdGlvbiBhbmQgUFJNLgo+
ICAgCSAqLwo+ICAgCVdBUk5fT04oSTkxNV9SRUFEKFBGSVRfQ09OVFJPTCkgJiBQRklUX0VOQUJM
RSk7Cj4gLQlhc3NlcnRfcGlwZV9kaXNhYmxlZChkZXZfcHJpdiwgY3J0Yy0+cGlwZSk7Cj4gKwlh
c3NlcnRfcGlwZV9kaXNhYmxlZChpOTE1LCBjcnRjLT5waXBlKTsKPiAgIAo+ICAgCUk5MTVfV1JJ
VEUoUEZJVF9QR01fUkFUSU9TLCBjcnRjX3N0YXRlLT5nbWNoX3BmaXQucGdtX3JhdGlvcyk7Cj4g
ICAJSTkxNV9XUklURShQRklUX0NPTlRST0wsIGNydGNfc3RhdGUtPmdtY2hfcGZpdC5jb250cm9s
KTsKPiBAQCAtNjU1OSwzMSArNjU1OSwzMSBAQCBzdGF0aWMgdm9pZCBpOXh4X3BmaXRfZW5hYmxl
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgCUk5MTVfV1JJ
VEUoQkNMUlBBVChjcnRjLT5waXBlKSwgMCk7Cj4gICB9Cj4gICAKPiAtYm9vbCBpbnRlbF9wb3J0
X2lzX2NvbWJvcGh5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0
IHBvcnQpCj4gK2Jvb2wgaW50ZWxfcG9ydF9pc19jb21ib3BoeShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwgZW51bSBwb3J0IHBvcnQpCj4gICB7Cj4gICAJaWYgKHBvcnQgPT0gUE9SVF9O
T05FKQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gICAKPiAtCWlmIChJU19FTEtIQVJUTEFLRShkZXZf
cHJpdikpCj4gKwlpZiAoSVNfRUxLSEFSVExBS0UoaTkxNSkpCj4gICAJCXJldHVybiBwb3J0IDw9
IFBPUlRfQzsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCj4gKwlpZiAo
SU5URUxfR0VOKGk5MTUpID49IDExKQo+ICAgCQlyZXR1cm4gcG9ydCA8PSBQT1JUX0I7Cj4gICAK
PiAgIAlyZXR1cm4gZmFsc2U7Cj4gICB9Cj4gICAKPiAtYm9vbCBpbnRlbF9wb3J0X2lzX3RjKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBvcnQpCj4gK2Jvb2wg
aW50ZWxfcG9ydF9pc190YyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBwb3J0
IHBvcnQpCj4gICB7Cj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSAmJiAhSVNfRUxL
SEFSVExBS0UoZGV2X3ByaXYpKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSAmJiAhSVNf
RUxLSEFSVExBS0UoaTkxNSkpCj4gICAJCXJldHVybiBwb3J0ID49IFBPUlRfQyAmJiBwb3J0IDw9
IFBPUlRfRjsKPiAgIAo+ICAgCXJldHVybiBmYWxzZTsKPiAgIH0KPiAgIAo+IC1lbnVtIHRjX3Bv
cnQgaW50ZWxfcG9ydF90b190YyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVu
dW0gcG9ydCBwb3J0KQo+ICtlbnVtIHRjX3BvcnQgaW50ZWxfcG9ydF90b190YyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBwb3J0IHBvcnQpCj4gICB7Cj4gLQlpZiAoIWludGVs
X3BvcnRfaXNfdGMoZGV2X3ByaXYsIHBvcnQpKQo+ICsJaWYgKCFpbnRlbF9wb3J0X2lzX3RjKGk5
MTUsIHBvcnQpKQo+ICAgCQlyZXR1cm4gUE9SVF9UQ19OT05FOwo+ICAgCj4gICAJcmV0dXJuIHBv
cnQgLSBQT1JUX0M7Cj4gQEAgLTY2MzYsNyArNjYzNiw3IEBAIHN0YXRpYyB1NjQgZ2V0X2NydGNf
cG93ZXJfZG9tYWlucyhzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gICAJCQkJICBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2ID0gY3J0Yy0+ZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGRldik7Cj4gICAJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyOwo+ICAgCXN0cnVjdCBpbnRl
bF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjKTsKPiAgIAllbnVtIHBpcGUg
cGlwZSA9IGludGVsX2NydGMtPnBpcGU7Cj4gQEAgLTY2NTgsNyArNjY1OCw3IEBAIHN0YXRpYyB1
NjQgZ2V0X2NydGNfcG93ZXJfZG9tYWlucyhzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gICAJCW1h
c2sgfD0gQklUX1VMTChpbnRlbF9lbmNvZGVyLT5wb3dlcl9kb21haW4pOwo+ICAgCX0KPiAgIAo+
IC0JaWYgKEhBU19EREkoZGV2X3ByaXYpICYmIGNydGNfc3RhdGUtPmhhc19hdWRpbykKPiArCWlm
IChIQVNfRERJKGk5MTUpICYmIGNydGNfc3RhdGUtPmhhc19hdWRpbykKPiAgIAkJbWFzayB8PSBC
SVRfVUxMKFBPV0VSX0RPTUFJTl9BVURJTyk7Cj4gICAKPiAgIAlpZiAoY3J0Y19zdGF0ZS0+c2hh
cmVkX2RwbGwpCj4gQEAgLTY2NzEsNyArNjY3MSw3IEBAIHN0YXRpYyB1NjQKPiAgIG1vZGVzZXRf
Z2V0X2NydGNfcG93ZXJfZG9tYWlucyhzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gICAJCQkgICAg
ICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmRldik7Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+ZGV2KTsKPiAgIAlzdHJ1
Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Yyk7Cj4gICAJZW51
bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBkb21haW47Cj4gICAJdTY0IGRvbWFpbnMsIG5l
d19kb21haW5zLCBvbGRfZG9tYWluczsKPiBAQCAtNjY4MywxOCArNjY4MywxOCBAQCBtb2Rlc2V0
X2dldF9jcnRjX3Bvd2VyX2RvbWFpbnMoc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ICAgCWRvbWFp
bnMgPSBuZXdfZG9tYWlucyAmIH5vbGRfZG9tYWluczsKPiAgIAo+ICAgCWZvcl9lYWNoX3Bvd2Vy
X2RvbWFpbihkb21haW4sIGRvbWFpbnMpCj4gLQkJaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoZGV2
X3ByaXYsIGRvbWFpbik7Cj4gKwkJaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoaTkxNSwgZG9tYWlu
KTsKPiAgIAo+ICAgCXJldHVybiBvbGRfZG9tYWlucyAmIH5uZXdfZG9tYWluczsKPiAgIH0KPiAg
IAo+IC1zdGF0aWMgdm9pZCBtb2Rlc2V0X3B1dF9wb3dlcl9kb21haW5zKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgbW9kZXNldF9wdXRfcG93ZXJfZG9t
YWlucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAgICB1NjQgZG9t
YWlucykKPiAgIHsKPiAgIAllbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbjsK
PiAgIAo+ICAgCWZvcl9lYWNoX3Bvd2VyX2RvbWFpbihkb21haW4sIGRvbWFpbnMpCj4gLQkJaW50
ZWxfZGlzcGxheV9wb3dlcl9wdXRfdW5jaGVja2VkKGRldl9wcml2LCBkb21haW4pOwo+ICsJCWlu
dGVsX2Rpc3BsYXlfcG93ZXJfcHV0X3VuY2hlY2tlZChpOTE1LCBkb21haW4pOwo+ICAgfQo+ICAg
Cj4gICBzdGF0aWMgdm9pZCB2YWxsZXl2aWV3X2NydGNfZW5hYmxlKHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpwaXBlX2NvbmZpZywKPiBAQCAtNjcwNCw3ICs2NzA0LDcgQEAgc3RhdGljIHZvaWQg
dmFsbGV5dmlld19jcnRjX2VuYWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25m
aWcsCj4gICAJCXRvX2ludGVsX2F0b21pY19zdGF0ZShvbGRfc3RhdGUpOwo+ICAgCXN0cnVjdCBk
cm1fY3J0YyAqY3J0YyA9IHBpcGVfY29uZmlnLT5iYXNlLmNydGM7Cj4gICAJc3RydWN0IGRybV9k
ZXZpY2UgKmRldiA9IGNydGMtPmRldjsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShkZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50
ZWxfY3J0YyhjcnRjKTsKPiAgIAlpbnQgcGlwZSA9IGludGVsX2NydGMtPnBpcGU7Cj4gICAKPiBA
QCAtNjcxNyw3ICs2NzE3LDcgQEAgc3RhdGljIHZvaWQgdmFsbGV5dmlld19jcnRjX2VuYWJsZShz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4gICAJaW50ZWxfc2V0X3BpcGVf
dGltaW5ncyhwaXBlX2NvbmZpZyk7Cj4gICAJaW50ZWxfc2V0X3BpcGVfc3JjX3NpemUocGlwZV9j
b25maWcpOwo+ICAgCj4gLQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikgJiYgcGlwZSA9PSBQ
SVBFX0IpIHsKPiArCWlmIChJU19DSEVSUllWSUVXKGk5MTUpICYmIHBpcGUgPT0gUElQRV9CKSB7
Cj4gICAJCUk5MTVfV1JJVEUoQ0hWX0JMRU5EKHBpcGUpLCBDSFZfQkxFTkRfTEVHQUNZKTsKPiAg
IAkJSTkxNV9XUklURShDSFZfQ0FOVkFTKHBpcGUpLCAwKTsKPiAgIAl9Cj4gQEAgLTY3MjYsMTEg
KzY3MjYsMTEgQEAgc3RhdGljIHZvaWQgdmFsbGV5dmlld19jcnRjX2VuYWJsZShzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4gICAKPiAgIAlpbnRlbF9jcnRjLT5hY3RpdmUg
PSB0cnVlOwo+ICAgCj4gLQlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRl
dl9wcml2LCBwaXBlLCB0cnVlKTsKPiArCWludGVsX3NldF9jcHVfZmlmb191bmRlcnJ1bl9yZXBv
cnRpbmcoaTkxNSwgcGlwZSwgdHJ1ZSk7Cj4gICAKPiAgIAlpbnRlbF9lbmNvZGVyc19wcmVfcGxs
X2VuYWJsZShjcnRjLCBwaXBlX2NvbmZpZywgb2xkX3N0YXRlKTsKPiAgIAo+IC0JaWYgKElTX0NI
RVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkgewo+ICAg
CQljaHZfcHJlcGFyZV9wbGwoaW50ZWxfY3J0YywgcGlwZV9jb25maWcpOwo+ICAgCQljaHZfZW5h
YmxlX3BsbChpbnRlbF9jcnRjLCBwaXBlX2NvbmZpZyk7Cj4gICAJfSBlbHNlIHsKPiBAQCAtNjc0
Nyw3ICs2NzQ3LDcgQEAgc3RhdGljIHZvaWQgdmFsbGV5dmlld19jcnRjX2VuYWJsZShzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4gICAJLyogdXBkYXRlIERTUENOVFIgdG8g
Y29uZmlndXJlIGdhbW1hIGZvciBwaXBlIGJvdHRvbSBjb2xvciAqLwo+ICAgCWludGVsX2Rpc2Fi
bGVfcHJpbWFyeV9wbGFuZShwaXBlX2NvbmZpZyk7Cj4gICAKPiAtCWRldl9wcml2LT5kaXNwbGF5
LmluaXRpYWxfd2F0ZXJtYXJrcyhvbGRfaW50ZWxfc3RhdGUsCj4gKwlpOTE1LT5kaXNwbGF5Lmlu
aXRpYWxfd2F0ZXJtYXJrcyhvbGRfaW50ZWxfc3RhdGUsCj4gICAJCQkJCSAgICAgcGlwZV9jb25m
aWcpOwo+ICAgCWludGVsX2VuYWJsZV9waXBlKHBpcGVfY29uZmlnKTsKPiAgIAo+IEBAIC02NzYw
LDcgKzY3NjAsNyBAQCBzdGF0aWMgdm9pZCB2YWxsZXl2aWV3X2NydGNfZW5hYmxlKHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKPiAgIHN0YXRpYyB2b2lkIGk5eHhfc2V0X3Bs
bF9kaXZpZGVycyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAg
IHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0
ZS0+YmFzZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAo+ICAgCUk5MTVfV1JJVEUoRlAwKGNydGMt
PnBpcGUpLCBjcnRjX3N0YXRlLT5kcGxsX2h3X3N0YXRlLmZwMCk7Cj4gICAJSTkxNV9XUklURShG
UDEoY3J0Yy0+cGlwZSksIGNydGNfc3RhdGUtPmRwbGxfaHdfc3RhdGUuZnAxKTsKPiBAQCAtNjc3
Myw3ICs2NzczLDcgQEAgc3RhdGljIHZvaWQgaTl4eF9jcnRjX2VuYWJsZShzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4gICAJCXRvX2ludGVsX2F0b21pY19zdGF0ZShvbGRf
c3RhdGUpOwo+ICAgCXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9IHBpcGVfY29uZmlnLT5iYXNlLmNy
dGM7Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmRldjsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRj
ICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjKTsKPiAgIAllbnVtIHBpcGUgcGlwZSA9
IGludGVsX2NydGMtPnBpcGU7Cj4gICAKPiBAQCAtNjc5Miw4ICs2NzkyLDggQEAgc3RhdGljIHZv
aWQgaTl4eF9jcnRjX2VuYWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcs
Cj4gICAKPiAgIAlpbnRlbF9jcnRjLT5hY3RpdmUgPSB0cnVlOwo+ICAgCj4gLQlpZiAoIUlTX0dF
TihkZXZfcHJpdiwgMikpCj4gLQkJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGlu
ZyhkZXZfcHJpdiwgcGlwZSwgdHJ1ZSk7Cj4gKwlpZiAoIUlTX0dFTihpOTE1LCAyKSkKPiArCQlp
bnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGk5MTUsIHBpcGUsIHRydWUpOwo+
ICAgCj4gICAJaW50ZWxfZW5jb2RlcnNfcHJlX2VuYWJsZShjcnRjLCBwaXBlX2NvbmZpZywgb2xk
X3N0YXRlKTsKPiAgIAo+IEBAIC02ODA2LDggKzY4MDYsOCBAQCBzdGF0aWMgdm9pZCBpOXh4X2Ny
dGNfZW5hYmxlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKPiAgIAkvKiB1
cGRhdGUgRFNQQ05UUiB0byBjb25maWd1cmUgZ2FtbWEgZm9yIHBpcGUgYm90dG9tIGNvbG9yICov
Cj4gICAJaW50ZWxfZGlzYWJsZV9wcmltYXJ5X3BsYW5lKHBpcGVfY29uZmlnKTsKPiAgIAo+IC0J
aWYgKGRldl9wcml2LT5kaXNwbGF5LmluaXRpYWxfd2F0ZXJtYXJrcyAhPSBOVUxMKQo+IC0JCWRl
dl9wcml2LT5kaXNwbGF5LmluaXRpYWxfd2F0ZXJtYXJrcyhvbGRfaW50ZWxfc3RhdGUsCj4gKwlp
ZiAoaTkxNS0+ZGlzcGxheS5pbml0aWFsX3dhdGVybWFya3MgIT0gTlVMTCkKPiArCQlpOTE1LT5k
aXNwbGF5LmluaXRpYWxfd2F0ZXJtYXJrcyhvbGRfaW50ZWxfc3RhdGUsCj4gICAJCQkJCQkgICAg
IHBpcGVfY29uZmlnKTsKPiAgIAllbHNlCj4gICAJCWludGVsX3VwZGF0ZV93YXRlcm1hcmtzKGlu
dGVsX2NydGMpOwo+IEBAIC02ODIyLDEyICs2ODIyLDEyIEBAIHN0YXRpYyB2b2lkIGk5eHhfY3J0
Y19lbmFibGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ICAgc3RhdGlj
IHZvaWQgaTl4eF9wZml0X2Rpc2FibGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9s
ZF9jcnRjX3N0YXRlKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50
ZWxfY3J0YyhvbGRfY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAo+ICAg
CWlmICghb2xkX2NydGNfc3RhdGUtPmdtY2hfcGZpdC5jb250cm9sKQo+ICAgCQlyZXR1cm47Cj4g
ICAKPiAtCWFzc2VydF9waXBlX2Rpc2FibGVkKGRldl9wcml2LCBjcnRjLT5waXBlKTsKPiArCWFz
c2VydF9waXBlX2Rpc2FibGVkKGk5MTUsIGNydGMtPnBpcGUpOwo+ICAgCj4gICAJRFJNX0RFQlVH
X0tNUygiZGlzYWJsaW5nIHBmaXQsIGN1cnJlbnQ6IDB4JTA4eFxuIiwKPiAgIAkJICAgICAgSTkx
NV9SRUFEKFBGSVRfQ09OVFJPTCkpOwo+IEBAIC02ODM5LDcgKzY4MzksNyBAQCBzdGF0aWMgdm9p
ZCBpOXh4X2NydGNfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3Rh
dGUsCj4gICB7Cj4gICAJc3RydWN0IGRybV9jcnRjICpjcnRjID0gb2xkX2NydGNfc3RhdGUtPmJh
c2UuY3J0YzsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+ZGV2Owo+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJc3RydWN0IGludGVs
X2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGMpOwo+ICAgCWludCBwaXBlID0g
aW50ZWxfY3J0Yy0+cGlwZTsKPiAgIAo+IEBAIC02ODQ3LDggKzY4NDcsOCBAQCBzdGF0aWMgdm9p
ZCBpOXh4X2NydGNfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3Rh
dGUsCj4gICAJICogT24gZ2VuMiBwbGFuZXMgYXJlIGRvdWJsZSBidWZmZXJlZCBidXQgdGhlIHBp
cGUgaXNuJ3QsIHNvIHdlIG11c3QKPiAgIAkgKiB3YWl0IGZvciBwbGFuZXMgdG8gZnVsbHkgdHVy
biBvZmYgYmVmb3JlIGRpc2FibGluZyB0aGUgcGlwZS4KPiAgIAkgKi8KPiAtCWlmIChJU19HRU4o
ZGV2X3ByaXYsIDIpKQo+IC0JCWludGVsX3dhaXRfZm9yX3ZibGFuayhkZXZfcHJpdiwgcGlwZSk7
Cj4gKwlpZiAoSVNfR0VOKGk5MTUsIDIpKQo+ICsJCWludGVsX3dhaXRfZm9yX3ZibGFuayhpOTE1
LCBwaXBlKTsKPiAgIAo+ICAgCWludGVsX2VuY29kZXJzX2Rpc2FibGUoY3J0Yywgb2xkX2NydGNf
c3RhdGUsIG9sZF9zdGF0ZSk7Cj4gICAKPiBAQCAtNjg2MiwyNSArNjg2MiwyNSBAQCBzdGF0aWMg
dm9pZCBpOXh4X2NydGNfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNf
c3RhdGUsCj4gICAJaW50ZWxfZW5jb2RlcnNfcG9zdF9kaXNhYmxlKGNydGMsIG9sZF9jcnRjX3N0
YXRlLCBvbGRfc3RhdGUpOwo+ICAgCj4gICAJaWYgKCFpbnRlbF9jcnRjX2hhc190eXBlKG9sZF9j
cnRjX3N0YXRlLCBJTlRFTF9PVVRQVVRfRFNJKSkgewo+IC0JCWlmIChJU19DSEVSUllWSUVXKGRl
dl9wcml2KSkKPiAtCQkJY2h2X2Rpc2FibGVfcGxsKGRldl9wcml2LCBwaXBlKTsKPiAtCQllbHNl
IGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkKPiAtCQkJdmx2X2Rpc2FibGVfcGxsKGRldl9w
cml2LCBwaXBlKTsKPiArCQlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiArCQkJY2h2X2Rpc2Fi
bGVfcGxsKGk5MTUsIHBpcGUpOwo+ICsJCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkpCj4g
KwkJCXZsdl9kaXNhYmxlX3BsbChpOTE1LCBwaXBlKTsKPiAgIAkJZWxzZQo+ICAgCQkJaTl4eF9k
aXNhYmxlX3BsbChvbGRfY3J0Y19zdGF0ZSk7Cj4gICAJfQo+ICAgCj4gICAJaW50ZWxfZW5jb2Rl
cnNfcG9zdF9wbGxfZGlzYWJsZShjcnRjLCBvbGRfY3J0Y19zdGF0ZSwgb2xkX3N0YXRlKTsKPiAg
IAo+IC0JaWYgKCFJU19HRU4oZGV2X3ByaXYsIDIpKQo+IC0JCWludGVsX3NldF9jcHVfZmlmb191
bmRlcnJ1bl9yZXBvcnRpbmcoZGV2X3ByaXYsIHBpcGUsIGZhbHNlKTsKPiArCWlmICghSVNfR0VO
KGk5MTUsIDIpKQo+ICsJCWludGVsX3NldF9jcHVfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoaTkx
NSwgcGlwZSwgZmFsc2UpOwo+ICAgCj4gLQlpZiAoIWRldl9wcml2LT5kaXNwbGF5LmluaXRpYWxf
d2F0ZXJtYXJrcykKPiArCWlmICghaTkxNS0+ZGlzcGxheS5pbml0aWFsX3dhdGVybWFya3MpCj4g
ICAJCWludGVsX3VwZGF0ZV93YXRlcm1hcmtzKGludGVsX2NydGMpOwo+ICAgCj4gICAJLyogY2xv
Y2sgdGhlIHBpcGUgZG93biB0byA2NDB4NDgwQDYwIHRvIHBvdGVudGlhbGx5IHNhdmUgcG93ZXIg
Ki8KPiAtCWlmIChJU19JODMwKGRldl9wcml2KSkKPiAtCQlpODMwX2VuYWJsZV9waXBlKGRldl9w
cml2LCBwaXBlKTsKPiArCWlmIChJU19JODMwKGk5MTUpKQo+ICsJCWk4MzBfZW5hYmxlX3BpcGUo
aTkxNSwgcGlwZSk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIGludGVsX2NydGNfZGlzYWJs
ZV9ub2F0b21pYyhzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gQEAgLTY4ODgsOSArNjg4OCw5IEBA
IHN0YXRpYyB2b2lkIGludGVsX2NydGNfZGlzYWJsZV9ub2F0b21pYyhzdHJ1Y3QgZHJtX2NydGMg
KmNydGMsCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXI7Cj4gICAJc3Ry
dWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGMpOwo+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5kZXYpOwo+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmRldik7Cj4gICAJ
c3RydWN0IGludGVsX2J3X3N0YXRlICpid19zdGF0ZSA9Cj4gLQkJdG9faW50ZWxfYndfc3RhdGUo
ZGV2X3ByaXYtPmJ3X29iai5zdGF0ZSk7Cj4gKwkJdG9faW50ZWxfYndfc3RhdGUoaTkxNS0+Yndf
b2JqLnN0YXRlKTsKPiAgIAllbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbjsK
PiAgIAlzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lOwo+ICAgCXU2NCBkb21haW5zOwo+IEBAIC02
OTAxLDcgKzY5MDEsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9jcnRjX2Rpc2FibGVfbm9hdG9taWMo
c3RydWN0IGRybV9jcnRjICpjcnRjLAo+ICAgCWlmICghaW50ZWxfY3J0Yy0+YWN0aXZlKQo+ICAg
CQlyZXR1cm47Cj4gICAKPiAtCWZvcl9lYWNoX2ludGVsX3BsYW5lX29uX2NydGMoJmRldl9wcml2
LT5kcm0sIGludGVsX2NydGMsIHBsYW5lKSB7Cj4gKwlmb3JfZWFjaF9pbnRlbF9wbGFuZV9vbl9j
cnRjKCZpOTE1LT5kcm0sIGludGVsX2NydGMsIHBsYW5lKSB7Cj4gICAJCWNvbnN0IHN0cnVjdCBp
bnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUgPQo+ICAgCQkJdG9faW50ZWxfcGxhbmVfc3Rh
dGUocGxhbmUtPmJhc2Uuc3RhdGUpOwo+ICAgCj4gQEAgLTY5MjQsNyArNjkyNCw3IEBAIHN0YXRp
YyB2b2lkIGludGVsX2NydGNfZGlzYWJsZV9ub2F0b21pYyhzdHJ1Y3QgZHJtX2NydGMgKmNydGMs
Cj4gICAKPiAgIAlXQVJOX09OKElTX0VSUihjcnRjX3N0YXRlKSB8fCByZXQpOwo+ICAgCj4gLQlk
ZXZfcHJpdi0+ZGlzcGxheS5jcnRjX2Rpc2FibGUoY3J0Y19zdGF0ZSwgc3RhdGUpOwo+ICsJaTkx
NS0+ZGlzcGxheS5jcnRjX2Rpc2FibGUoY3J0Y19zdGF0ZSwgc3RhdGUpOwo+ICAgCj4gICAJZHJt
X2F0b21pY19zdGF0ZV9wdXQoc3RhdGUpOwo+ICAgCj4gQEAgLTY5NDcsMTIgKzY5NDcsMTIgQEAg
c3RhdGljIHZvaWQgaW50ZWxfY3J0Y19kaXNhYmxlX25vYXRvbWljKHN0cnVjdCBkcm1fY3J0YyAq
Y3J0YywKPiAgIAo+ICAgCWRvbWFpbnMgPSBpbnRlbF9jcnRjLT5lbmFibGVkX3Bvd2VyX2RvbWFp
bnM7Cj4gICAJZm9yX2VhY2hfcG93ZXJfZG9tYWluKGRvbWFpbiwgZG9tYWlucykKPiAtCQlpbnRl
bF9kaXNwbGF5X3Bvd2VyX3B1dF91bmNoZWNrZWQoZGV2X3ByaXYsIGRvbWFpbik7Cj4gKwkJaW50
ZWxfZGlzcGxheV9wb3dlcl9wdXRfdW5jaGVja2VkKGk5MTUsIGRvbWFpbik7Cj4gICAJaW50ZWxf
Y3J0Yy0+ZW5hYmxlZF9wb3dlcl9kb21haW5zID0gMDsKPiAgIAo+IC0JZGV2X3ByaXYtPmFjdGl2
ZV9jcnRjcyAmPSB+KDEgPDwgaW50ZWxfY3J0Yy0+cGlwZSk7Cj4gLQlkZXZfcHJpdi0+bWluX2Nk
Y2xrW2ludGVsX2NydGMtPnBpcGVdID0gMDsKPiAtCWRldl9wcml2LT5taW5fdm9sdGFnZV9sZXZl
bFtpbnRlbF9jcnRjLT5waXBlXSA9IDA7Cj4gKwlpOTE1LT5hY3RpdmVfY3J0Y3MgJj0gfigxIDw8
IGludGVsX2NydGMtPnBpcGUpOwo+ICsJaTkxNS0+bWluX2NkY2xrW2ludGVsX2NydGMtPnBpcGVd
ID0gMDsKPiArCWk5MTUtPm1pbl92b2x0YWdlX2xldmVsW2ludGVsX2NydGMtPnBpcGVdID0gMDsK
PiAgIAo+ICAgCWJ3X3N0YXRlLT5kYXRhX3JhdGVbaW50ZWxfY3J0Yy0+cGlwZV0gPSAwOwo+ICAg
CWJ3X3N0YXRlLT5udW1fYWN0aXZlX3BsYW5lc1tpbnRlbF9jcnRjLT5waXBlXSA9IDA7Cj4gQEAg
LTY5NjQsNyArNjk2NCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2NydGNfZGlzYWJsZV9ub2F0b21p
YyhzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gICAgKi8KPiAgIGludCBpbnRlbF9kaXNwbGF5X3N1
c3BlbmQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpz
dGF0ZTsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gQEAgLTY5NzMsNyArNjk3Myw3IEBAIGludCBpbnRl
bF9kaXNwbGF5X3N1c3BlbmQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIAlpZiAocmV0KQo+
ICAgCQlEUk1fRVJST1IoIlN1c3BlbmRpbmcgY3J0YydzIGZhaWxlZCB3aXRoICVpXG4iLCByZXQp
Owo+ICAgCWVsc2UKPiAtCQlkZXZfcHJpdi0+bW9kZXNldF9yZXN0b3JlX3N0YXRlID0gc3RhdGU7
Cj4gKwkJaTkxNS0+bW9kZXNldF9yZXN0b3JlX3N0YXRlID0gc3RhdGU7Cj4gICAJcmV0dXJuIHJl
dDsKPiAgIH0KPiAgIAo+IEBAIC03MDM1LDcgKzcwMzUsNyBAQCBzdGF0aWMgaW50IHBpcGVfcmVx
dWlyZWRfZmRpX2xhbmVzKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAg
c3RhdGljIGludCBpcm9ubGFrZV9jaGVja19mZGlfbGFuZXMoc3RydWN0IGRybV9kZXZpY2UgKmRl
diwgZW51bSBwaXBlIHBpcGUsCj4gICAJCQkJICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
cGlwZV9jb25maWcpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoZGV2KTsKPiAgIAlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUgPSBwaXBlX2NvbmZp
Zy0+YmFzZS5zdGF0ZTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqb3RoZXJfY3J0YzsKPiAgIAlz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb3RoZXJfY3J0Y19zdGF0ZTsKPiBAQCAtNzA0OCw3ICs3
MDQ4LDcgQEAgc3RhdGljIGludCBpcm9ubGFrZV9jaGVja19mZGlfbGFuZXMoc3RydWN0IGRybV9k
ZXZpY2UgKmRldiwgZW51bSBwaXBlIHBpcGUsCj4gICAJCXJldHVybiAtRUlOVkFMOwo+ICAgCX0K
PiAgIAo+IC0JaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElTX0JST0FEV0VMTChkZXZfcHJp
dikpIHsKPiArCWlmIChJU19IQVNXRUxMKGk5MTUpIHx8IElTX0JST0FEV0VMTChpOTE1KSkgewo+
ICAgCQlpZiAocGlwZV9jb25maWctPmZkaV9sYW5lcyA+IDIpIHsKPiAgIAkJCURSTV9ERUJVR19L
TVMoIm9ubHkgMiBsYW5lcyBvbiBoYXN3ZWxsLCByZXF1aXJlZDogJWkgbGFuZXNcbiIsCj4gICAJ
CQkJICAgICAgcGlwZV9jb25maWctPmZkaV9sYW5lcyk7Cj4gQEAgLTcwNTgsNyArNzA1OCw3IEBA
IHN0YXRpYyBpbnQgaXJvbmxha2VfY2hlY2tfZmRpX2xhbmVzKHN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYsIGVudW0gcGlwZSBwaXBlLAo+ICAgCQl9Cj4gICAJfQo+ICAgCj4gLQlpZiAoSU5URUxfSU5G
TyhkZXZfcHJpdiktPm51bV9waXBlcyA9PSAyKQo+ICsJaWYgKElOVEVMX0lORk8oaTkxNSktPm51
bV9waXBlcyA9PSAyKQo+ICAgCQlyZXR1cm4gMDsKPiAgIAo+ICAgCS8qIEl2eWJyaWRnZSAzIHBp
cGUgaXMgcmVhbGx5IGNvbXBsaWNhdGVkICovCj4gQEAgLTcwNjksNyArNzA2OSw3IEBAIHN0YXRp
YyBpbnQgaXJvbmxha2VfY2hlY2tfZmRpX2xhbmVzKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIGVu
dW0gcGlwZSBwaXBlLAo+ICAgCQlpZiAocGlwZV9jb25maWctPmZkaV9sYW5lcyA8PSAyKQo+ICAg
CQkJcmV0dXJuIDA7Cj4gICAKPiAtCQlvdGhlcl9jcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9yX3Bp
cGUoZGV2X3ByaXYsIFBJUEVfQyk7Cj4gKwkJb3RoZXJfY3J0YyA9IGludGVsX2dldF9jcnRjX2Zv
cl9waXBlKGk5MTUsIFBJUEVfQyk7Cj4gICAJCW90aGVyX2NydGNfc3RhdGUgPQo+ICAgCQkJaW50
ZWxfYXRvbWljX2dldF9jcnRjX3N0YXRlKHN0YXRlLCBvdGhlcl9jcnRjKTsKPiAgIAkJaWYgKElT
X0VSUihvdGhlcl9jcnRjX3N0YXRlKSkKPiBAQCAtNzA4OCw3ICs3MDg4LDcgQEAgc3RhdGljIGlu
dCBpcm9ubGFrZV9jaGVja19mZGlfbGFuZXMoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgZW51bSBw
aXBlIHBpcGUsCj4gICAJCQlyZXR1cm4gLUVJTlZBTDsKPiAgIAkJfQo+ICAgCj4gLQkJb3RoZXJf
Y3J0YyA9IGludGVsX2dldF9jcnRjX2Zvcl9waXBlKGRldl9wcml2LCBQSVBFX0IpOwo+ICsJCW90
aGVyX2NydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShpOTE1LCBQSVBFX0IpOwo+ICAgCQlv
dGhlcl9jcnRjX3N0YXRlID0KPiAgIAkJCWludGVsX2F0b21pY19nZXRfY3J0Y19zdGF0ZShzdGF0
ZSwgb3RoZXJfY3J0Yyk7Cj4gICAJCWlmIChJU19FUlIob3RoZXJfY3J0Y19zdGF0ZSkpCj4gQEAg
LTcxNTYsNyArNzE1Niw3IEBAIHN0YXRpYyBpbnQgaXJvbmxha2VfZmRpX2NvbXB1dGVfY29uZmln
KHN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjLAo+ICAgYm9vbCBoc3dfY3J0Y19zdGF0ZV9p
cHNfY2FwYWJsZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAg
IHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0
ZS0+YmFzZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAo+ICAgCS8qIElQUyBvbmx5IGV4aXN0cyBv
biBVTFQgbWFjaGluZXMgYW5kIGlzIHRpZWQgdG8gcGlwZSBBLiAqLwo+ICAgCWlmICghaHN3X2Ny
dGNfc3VwcG9ydHNfaXBzKGNydGMpKQo+IEBAIC03MTc1LDggKzcxNzUsOCBAQCBib29sIGhzd19j
cnRjX3N0YXRlX2lwc19jYXBhYmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlKQo+ICAgCSAqCj4gICAJICogU2hvdWxkIG1lYXN1cmUgd2hldGhlciB1c2luZyBhIGxv
d2VyIGNkY2xrIHcvbyBJUFMKPiAgIAkgKi8KPiAtCWlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYp
ICYmCj4gLQkgICAgY3J0Y19zdGF0ZS0+cGl4ZWxfcmF0ZSA+IGRldl9wcml2LT5tYXhfY2RjbGtf
ZnJlcSAqIDk1IC8gMTAwKQo+ICsJaWYgKElTX0JST0FEV0VMTChpOTE1KSAmJgo+ICsJICAgIGNy
dGNfc3RhdGUtPnBpeGVsX3JhdGUgPiBpOTE1LT5tYXhfY2RjbGtfZnJlcSAqIDk1IC8gMTAwKQo+
ICAgCQlyZXR1cm4gZmFsc2U7Cj4gICAKPiAgIAlyZXR1cm4gdHJ1ZTsKPiBAQCAtNzE4NCw3ICs3
MTg0LDcgQEAgYm9vbCBoc3dfY3J0Y19zdGF0ZV9pcHNfY2FwYWJsZShjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIAo+ICAgc3RhdGljIGJvb2wgaHN3X2NvbXB1
dGVfaXBzX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9Cj4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9Cj4gICAJCXRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5k
ZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKmludGVsX3N0YXRlID0KPiAgIAkJ
dG9faW50ZWxfYXRvbWljX3N0YXRlKGNydGNfc3RhdGUtPmJhc2Uuc3RhdGUpOwo+IEBAIC03MjA2
LDcgKzcyMDYsNyBAQCBzdGF0aWMgYm9vbCBoc3dfY29tcHV0ZV9pcHNfY29uZmlnKHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gICAKPiAg
IAkvKiBwaXhlbCByYXRlIG11c3RuJ3QgZXhjZWVkIDk1JSBvZiBjZGNsayB3aXRoIElQUyBvbiBC
RFcgKi8KPiAtCWlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYpICYmCj4gKwlpZiAoSVNfQlJPQURX
RUxMKGk5MTUpICYmCj4gICAJICAgIGNydGNfc3RhdGUtPnBpeGVsX3JhdGUgPiBpbnRlbF9zdGF0
ZS0+Y2RjbGsubG9naWNhbC5jZGNsayAqIDk1IC8gMTAwKQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4g
ICAKPiBAQCAtNzIxNSwxMSArNzIxNSwxMSBAQCBzdGF0aWMgYm9vbCBoc3dfY29tcHV0ZV9pcHNf
Y29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgCj4gICBzdGF0
aWMgYm9vbCBpbnRlbF9jcnRjX3N1cHBvcnRzX2RvdWJsZV93aWRlKGNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjKQo+ICAgewo+IC0JY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwljb25zdCBzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAgCj4gICAJLyog
R0RHIGRvdWJsZSB3aWRlIG9uIGVpdGhlciBwaXBlLCBvdGhlcndpc2UgcGlwZSBBIG9ubHkgKi8K
PiAtCXJldHVybiBJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNCAmJgo+IC0JCShjcnRjLT5waXBlID09
IFBJUEVfQSB8fCBJU19JOTE1RyhkZXZfcHJpdikpOwo+ICsJcmV0dXJuIElOVEVMX0dFTihpOTE1
KSA8IDQgJiYKPiArCQkoY3J0Yy0+cGlwZSA9PSBQSVBFX0EgfHwgSVNfSTkxNUcoaTkxNSkpOwo+
ICAgfQo+ICAgCj4gICBzdGF0aWMgdTMyIGlsa19waXBlX3BpeGVsX3JhdGUoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+IEBAIC03MjU5LDkgKzcyNTksOSBAQCBz
dGF0aWMgdTMyIGlsa19waXBlX3BpeGVsX3JhdGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKnBpcGVfY29uZmlnKQo+ICAgCj4gICBzdGF0aWMgdm9pZCBpbnRlbF9jcnRjX2NvbXB1dGVf
cGl4ZWxfcmF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+
YmFzZS5jcnRjLT5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiAgIAo+IC0JaWYgKEhBU19HTUNIKGRl
dl9wcml2KSkKPiArCWlmIChIQVNfR01DSChpOTE1KSkKPiAgIAkJLyogRklYTUUgY2FsY3VsYXRl
IHByb3BlciBwaXBlIHBpeGVsIHJhdGUgZm9yIEdNQ0ggcGZpdCAqLwo+ICAgCQljcnRjX3N0YXRl
LT5waXhlbF9yYXRlID0KPiAgIAkJCWNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRj
X2Nsb2NrOwo+IEBAIC03MjczLDEyICs3MjczLDEyIEBAIHN0YXRpYyB2b2lkIGludGVsX2NydGNf
Y29tcHV0ZV9waXhlbF9yYXRlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+
ICAgc3RhdGljIGludCBpbnRlbF9jcnRjX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjLAo+ICAgCQkJCSAgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmln
KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShj
cnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAgCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICph
ZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gLQlpbnQg
Y2xvY2tfbGltaXQgPSBkZXZfcHJpdi0+bWF4X2RvdGNsa19mcmVxOwo+ICsJaW50IGNsb2NrX2xp
bWl0ID0gaTkxNS0+bWF4X2RvdGNsa19mcmVxOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA8IDQpIHsKPiAtCQljbG9ja19saW1pdCA9IGRldl9wcml2LT5tYXhfY2RjbGtfZnJlcSAq
IDkgLyAxMDsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA0KSB7Cj4gKwkJY2xvY2tfbGltaXQg
PSBpOTE1LT5tYXhfY2RjbGtfZnJlcSAqIDkgLyAxMDsKPiAgIAo+ICAgCQkvKgo+ICAgCQkgKiBF
bmFibGUgZG91YmxlIHdpZGUgbW9kZSB3aGVuIHRoZSBkb3QgY2xvY2sKPiBAQCAtNzI4Niw3ICs3
Mjg2LDcgQEAgc3RhdGljIGludCBpbnRlbF9jcnRjX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjLAo+ICAgCQkgKi8KPiAgIAkJaWYgKGludGVsX2NydGNfc3VwcG9ydHNfZG91
YmxlX3dpZGUoY3J0YykgJiYKPiAgIAkJICAgIGFkanVzdGVkX21vZGUtPmNydGNfY2xvY2sgPiBj
bG9ja19saW1pdCkgewo+IC0JCQljbG9ja19saW1pdCA9IGRldl9wcml2LT5tYXhfZG90Y2xrX2Zy
ZXE7Cj4gKwkJCWNsb2NrX2xpbWl0ID0gaTkxNS0+bWF4X2RvdGNsa19mcmVxOwo+ICAgCQkJcGlw
ZV9jb25maWctPmRvdWJsZV93aWRlID0gdHJ1ZTsKPiAgIAkJfQo+ICAgCX0KPiBAQCAtNzMyMyw3
ICs3MzIzLDcgQEAgc3RhdGljIGludCBpbnRlbF9jcnRjX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBp
bnRlbF9jcnRjICpjcnRjLAo+ICAgCQl9Cj4gICAKPiAgIAkJaWYgKGludGVsX2NydGNfaGFzX3R5
cGUocGlwZV9jb25maWcsIElOVEVMX09VVFBVVF9MVkRTKSAmJgo+IC0JCSAgICBpbnRlbF9pc19k
dWFsX2xpbmtfbHZkcyhkZXZfcHJpdikpIHsKPiArCQkgICAgaW50ZWxfaXNfZHVhbF9saW5rX2x2
ZHMoaTkxNSkpIHsKPiAgIAkJCURSTV9ERUJVR19LTVMoIk9kZCBwaXBlIHNvdXJjZSB3aWR0aCBu
b3Qgc3VwcG9ydGVkIHdpdGggZHVhbCBsaW5rIExWRFNcbiIpOwo+ICAgCQkJcmV0dXJuIC1FSU5W
QUw7Cj4gICAJCX0KPiBAQCAtNzMzMiw3ICs3MzMyLDcgQEAgc3RhdGljIGludCBpbnRlbF9jcnRj
X2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCS8qIENhbnRpZ2Er
IGNhbm5vdCBoYW5kbGUgbW9kZXMgd2l0aCBhIGhzeW5jIGZyb250IHBvcmNoIG9mIDAuCj4gICAJ
ICogV2FQcnVuZU1vZGVXaXRoSW5jb3JyZWN0SHN5bmNPZmZzZXQ6Y3RnLGVsayxpbGssc25iLGl2
Yix2bHYsaHN3Lgo+ICAgCSAqLwo+IC0JaWYgKChJTlRFTF9HRU4oZGV2X3ByaXYpID4gNCB8fCBJ
U19HNFgoZGV2X3ByaXYpKSAmJgo+ICsJaWYgKChJTlRFTF9HRU4oaTkxNSkgPiA0IHx8IElTX0c0
WChpOTE1KSkgJiYKPiAgIAkJYWRqdXN0ZWRfbW9kZS0+Y3J0Y19oc3luY19zdGFydCA9PSBhZGp1
c3RlZF9tb2RlLT5jcnRjX2hkaXNwbGF5KQo+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiAgIAo+IEBA
IC03MzkyLDEyICs3MzkyLDEyIEBAIGludGVsX2xpbmtfY29tcHV0ZV9tX24odTE2IGJpdHNfcGVy
X3BpeGVsLCBpbnQgbmxhbmVzLAo+ICAgCQkgICAgY29uc3RhbnRfbik7Cj4gICB9Cj4gICAKPiAt
c3RhdGljIGlubGluZSBib29sIGludGVsX3BhbmVsX3VzZV9zc2Moc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgaW5saW5lIGJvb2wgaW50ZWxfcGFuZWxfdXNlX3Nz
YyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAlpZiAoaTkxNV9tb2Rw
YXJhbXMucGFuZWxfdXNlX3NzYyA+PSAwKQo+ICAgCQlyZXR1cm4gaTkxNV9tb2RwYXJhbXMucGFu
ZWxfdXNlX3NzYyAhPSAwOwo+IC0JcmV0dXJuIGRldl9wcml2LT52YnQubHZkc191c2Vfc3NjCj4g
LQkJJiYgIShkZXZfcHJpdi0+cXVpcmtzICYgUVVJUktfTFZEU19TU0NfRElTQUJMRSk7Cj4gKwly
ZXR1cm4gaTkxNS0+dmJ0Lmx2ZHNfdXNlX3NzYwo+ICsJCSYmICEoaTkxNS0+cXVpcmtzICYgUVVJ
UktfTFZEU19TU0NfRElTQUJMRSk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB1MzIgcG52X2RwbGxf
Y29tcHV0ZV9mcChzdHJ1Y3QgZHBsbCAqZHBsbCkKPiBAQCAtNzQxNCwxMCArNzQxNCwxMCBAQCBz
dGF0aWMgdm9pZCBpOXh4X3VwZGF0ZV9wbGxfZGl2aWRlcnMoc3RydWN0IGludGVsX2NydGMgKmNy
dGMsCj4gICAJCQkJICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAg
IAkJCQkgICAgIHN0cnVjdCBkcGxsICpyZWR1Y2VkX2Nsb2NrKQo+ICAgewo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+
ICAgCXUzMiBmcCwgZnAyID0gMDsKPiAgIAo+IC0JaWYgKElTX1BJTkVWSUVXKGRldl9wcml2KSkg
ewo+ICsJaWYgKElTX1BJTkVWSUVXKGk5MTUpKSB7Cj4gICAJCWZwID0gcG52X2RwbGxfY29tcHV0
ZV9mcCgmY3J0Y19zdGF0ZS0+ZHBsbCk7Cj4gICAJCWlmIChyZWR1Y2VkX2Nsb2NrKQo+ICAgCQkJ
ZnAyID0gcG52X2RwbGxfY29tcHV0ZV9mcChyZWR1Y2VkX2Nsb2NrKTsKPiBAQCAtNzQzNyw3ICs3
NDM3LDcgQEAgc3RhdGljIHZvaWQgaTl4eF91cGRhdGVfcGxsX2RpdmlkZXJzKHN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjLAo+ICAgCX0KPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCB2bHZfcGxsYl9y
ZWNhbF9vcGFtcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlwZQo+
ICtzdGF0aWMgdm9pZCB2bHZfcGxsYl9yZWNhbF9vcGFtcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwgZW51bSBwaXBlCj4gICAJCXBpcGUpCj4gICB7Cj4gICAJdTMyIHJlZ192YWw7Cj4g
QEAgLTc0NDYsMzEgKzc0NDYsMzEgQEAgc3RhdGljIHZvaWQgdmx2X3BsbGJfcmVjYWxfb3BhbXAo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUKPiAgIAkgKiBQTExC
IG9wYW1wIGFsd2F5cyBjYWxpYnJhdGVzIHRvIG1heCB2YWx1ZSBvZiAweDNmLCBmb3JjZSBlbmFi
bGUgaXQKPiAgIAkgKiBhbmQgc2V0IGl0IHRvIGEgcmVhc29uYWJsZSB2YWx1ZSBpbnN0ZWFkLgo+
ICAgCSAqLwo+IC0JcmVnX3ZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIFZMVl9Q
TExfRFc5KDEpKTsKPiArCXJlZ192YWwgPSB2bHZfZHBpb19yZWFkKGk5MTUsIHBpcGUsIFZMVl9Q
TExfRFc5KDEpKTsKPiAgIAlyZWdfdmFsICY9IDB4ZmZmZmZmMDA7Cj4gICAJcmVnX3ZhbCB8PSAw
eDAwMDAwMDMwOwo+IC0Jdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9QTExfRFc5
KDEpLCByZWdfdmFsKTsKPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9QTExfRFc5
KDEpLCByZWdfdmFsKTsKPiAgIAo+IC0JcmVnX3ZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYs
IHBpcGUsIFZMVl9SRUZfRFcxMyk7Cj4gKwlyZWdfdmFsID0gdmx2X2RwaW9fcmVhZChpOTE1LCBw
aXBlLCBWTFZfUkVGX0RXMTMpOwo+ICAgCXJlZ192YWwgJj0gMHgwMGZmZmZmZjsKPiAgIAlyZWdf
dmFsIHw9IDB4OGMwMDAwMDA7Cj4gLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxW
X1JFRl9EVzEzLCByZWdfdmFsKTsKPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9S
RUZfRFcxMywgcmVnX3ZhbCk7Cj4gICAKPiAtCXJlZ192YWwgPSB2bHZfZHBpb19yZWFkKGRldl9w
cml2LCBwaXBlLCBWTFZfUExMX0RXOSgxKSk7Cj4gKwlyZWdfdmFsID0gdmx2X2RwaW9fcmVhZChp
OTE1LCBwaXBlLCBWTFZfUExMX0RXOSgxKSk7Cj4gICAJcmVnX3ZhbCAmPSAweGZmZmZmZjAwOwo+
IC0Jdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9QTExfRFc5KDEpLCByZWdfdmFs
KTsKPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9QTExfRFc5KDEpLCByZWdfdmFs
KTsKPiAgIAo+IC0JcmVnX3ZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIFZMVl9S
RUZfRFcxMyk7Cj4gKwlyZWdfdmFsID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBWTFZfUkVG
X0RXMTMpOwo+ICAgCXJlZ192YWwgJj0gMHgwMGZmZmZmZjsKPiAgIAlyZWdfdmFsIHw9IDB4YjAw
MDAwMDA7Cj4gLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1JFRl9EVzEzLCBy
ZWdfdmFsKTsKPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9SRUZfRFcxMywgcmVn
X3ZhbCk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIGludGVsX3BjaF90cmFuc2NvZGVyX3Nl
dF9tX24oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICAJCQkJ
CSBjb25zdCBzdHJ1Y3QgaW50ZWxfbGlua19tX24gKm1fbikKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5k
ZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJh
c2UuZGV2KTsKPiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gICAKPiAgIAlJOTE1
X1dSSVRFKFBDSF9UUkFOU19EQVRBX00xKHBpcGUpLCBUVV9TSVpFKG1fbi0+dHUpIHwgbV9uLT5n
bWNoX20pOwo+IEBAIC03NDc5LDE3ICs3NDc5LDE3IEBAIHN0YXRpYyB2b2lkIGludGVsX3BjaF90
cmFuc2NvZGVyX3NldF9tX24oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
Cj4gICAJSTkxNV9XUklURShQQ0hfVFJBTlNfTElOS19OMShwaXBlKSwgbV9uLT5saW5rX24pOwo+
ICAgfQo+ICAgCj4gLXN0YXRpYyBib29sIHRyYW5zY29kZXJfaGFzX20yX24yKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIGJvb2wgdHJhbnNjb2Rlcl9oYXNfbTJf
bjIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJIGVudW0gdHJhbnNjb2Rl
ciB0cmFuc2NvZGVyKQo+ICAgewo+IC0JaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpKQo+ICsJaWYg
KElTX0hBU1dFTEwoaTkxNSkpCj4gICAJCXJldHVybiB0cmFuc2NvZGVyID09IFRSQU5TQ09ERVJf
RURQOwo+ICAgCj4gICAJLyoKPiAgIAkgKiBTdHJpY3RseSBzcGVha2luZyBzb21lIHJlZ2lzdGVy
cyBhcmUgYXZhaWxhYmxlIGJlZm9yZQo+ICAgCSAqIGdlbjcsIGJ1dCB3ZSBvbmx5IHN1cHBvcnQg
RFJSUyBvbiBnZW43Kwo+ICAgCSAqLwo+IC0JcmV0dXJuIElTX0dFTihkZXZfcHJpdiwgNykgfHwg
SVNfQ0hFUlJZVklFVyhkZXZfcHJpdik7Cj4gKwlyZXR1cm4gSVNfR0VOKGk5MTUsIDcpIHx8IElT
X0NIRVJSWVZJRVcoaTkxNSk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIGludGVsX2NwdV90
cmFuc2NvZGVyX3NldF9tX24oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUsCj4gQEAgLTc0OTcsMTEgKzc0OTcsMTEgQEAgc3RhdGljIHZvaWQgaW50ZWxfY3B1X3RyYW5z
Y29kZXJfc2V0X21fbihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGEKPiAg
IAkJCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9saW5rX21fbiAqbTJfbjIpCj4gICB7Cj4gICAJc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0
Yyk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMt
PmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShj
cnRjLT5iYXNlLmRldik7Cj4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAgCWVu
dW0gdHJhbnNjb2RlciB0cmFuc2NvZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXI7Cj4g
ICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDUpIHsKPiArCWlmIChJTlRFTF9HRU4o
aTkxNSkgPj0gNSkgewo+ICAgCQlJOTE1X1dSSVRFKFBJUEVfREFUQV9NMSh0cmFuc2NvZGVyKSwg
VFVfU0laRShtX24tPnR1KSB8IG1fbi0+Z21jaF9tKTsKPiAgIAkJSTkxNV9XUklURShQSVBFX0RB
VEFfTjEodHJhbnNjb2RlciksIG1fbi0+Z21jaF9uKTsKPiAgIAkJSTkxNV9XUklURShQSVBFX0xJ
TktfTTEodHJhbnNjb2RlciksIG1fbi0+bGlua19tKTsKPiBAQCAtNzUxMSw3ICs3NTExLDcgQEAg
c3RhdGljIHZvaWQgaW50ZWxfY3B1X3RyYW5zY29kZXJfc2V0X21fbihjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGEKPiAgIAkJICogKHRvIG1ha2Ugc3VyZSB0aGUgcmVnaXN0
ZXJzIGFyZSBub3QgdW5uZWNlc3NhcmlseSBhY2Nlc3NlZCkuCj4gICAJCSAqLwo+ICAgCQlpZiAo
bTJfbjIgJiYgY3J0Y19zdGF0ZS0+aGFzX2RycnMgJiYKPiAtCQkgICAgdHJhbnNjb2Rlcl9oYXNf
bTJfbjIoZGV2X3ByaXYsIHRyYW5zY29kZXIpKSB7Cj4gKwkJICAgIHRyYW5zY29kZXJfaGFzX20y
X24yKGk5MTUsIHRyYW5zY29kZXIpKSB7Cj4gICAJCQlJOTE1X1dSSVRFKFBJUEVfREFUQV9NMih0
cmFuc2NvZGVyKSwKPiAgIAkJCQkJVFVfU0laRShtMl9uMi0+dHUpIHwgbTJfbjItPmdtY2hfbSk7
Cj4gICAJCQlJOTE1X1dSSVRFKFBJUEVfREFUQV9OMih0cmFuc2NvZGVyKSwgbTJfbjItPmdtY2hf
bik7Cj4gQEAgLTc1ODgsNyArNzU4OCw3IEBAIHN0YXRpYyB2b2lkIHZsdl9wcmVwYXJlX3BsbChz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAkJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gICB7Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9
IGNydGMtPmJhc2UuZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGRldik7Cj4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAgCXUzMiBtZGl2Owo+
ICAgCXUzMiBiZXN0biwgYmVzdG0xLCBiZXN0bTIsIGJlc3RwMSwgYmVzdHAyOwo+IEBAIC03NjAz
LDcgKzc2MDMsNyBAQCBzdGF0aWMgdm9pZCB2bHZfcHJlcGFyZV9wbGwoc3RydWN0IGludGVsX2Ny
dGMgKmNydGMsCj4gICAJaWYgKChwaXBlX2NvbmZpZy0+ZHBsbF9od19zdGF0ZS5kcGxsICYgRFBM
TF9WQ09fRU5BQkxFKSA9PSAwKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCXZsdl9kcGlvX2dldChk
ZXZfcHJpdik7Cj4gKwl2bHZfZHBpb19nZXQoaTkxNSk7Cj4gICAKPiAgIAliZXN0biA9IHBpcGVf
Y29uZmlnLT5kcGxsLm47Cj4gICAJYmVzdG0xID0gcGlwZV9jb25maWctPmRwbGwubTE7Cj4gQEAg
LTc2MTUsMTggKzc2MTUsMTggQEAgc3RhdGljIHZvaWQgdmx2X3ByZXBhcmVfcGxsKHN0cnVjdCBp
bnRlbF9jcnRjICpjcnRjLAo+ICAgCj4gICAJLyogUExMIEIgbmVlZHMgc3BlY2lhbCBoYW5kbGlu
ZyAqLwo+ICAgCWlmIChwaXBlID09IFBJUEVfQikKPiAtCQl2bHZfcGxsYl9yZWNhbF9vcGFtcChk
ZXZfcHJpdiwgcGlwZSk7Cj4gKwkJdmx2X3BsbGJfcmVjYWxfb3BhbXAoaTkxNSwgcGlwZSk7Cj4g
ICAKPiAgIAkvKiBTZXQgdXAgVHggdGFyZ2V0IGZvciBwZXJpb2RpYyBSY29tcCB1cGRhdGUgKi8K
PiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUExMX0RXOV9CQ0FTVCwgMHgw
MTAwMDAwZik7Cj4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBWTFZfUExMX0RXOV9CQ0FT
VCwgMHgwMTAwMDAwZik7Cj4gICAKPiAgIAkvKiBEaXNhYmxlIHRhcmdldCBJUmVmIG9uIFBMTCAq
Lwo+IC0JcmVnX3ZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIFZMVl9QTExfRFc4
KHBpcGUpKTsKPiArCXJlZ192YWwgPSB2bHZfZHBpb19yZWFkKGk5MTUsIHBpcGUsIFZMVl9QTExf
RFc4KHBpcGUpKTsKPiAgIAlyZWdfdmFsICY9IDB4MDBmZmZmZmY7Cj4gLQl2bHZfZHBpb193cml0
ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1BMTF9EVzgocGlwZSksIHJlZ192YWwpOwo+ICsJdmx2X2Rw
aW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxWX1BMTF9EVzgocGlwZSksIHJlZ192YWwpOwo+ICAgCj4g
ICAJLyogRGlzYWJsZSBmYXN0IGxvY2sgKi8KPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBw
aXBlLCBWTFZfQ01OX0RXMCwgMHg2MTApOwo+ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwg
VkxWX0NNTl9EVzAsIDB4NjEwKTsKPiAgIAo+ICAgCS8qIFNldCBpZHRhZmNyZWNhbCBiZWZvcmUg
UExMIGlzIGVuYWJsZWQgKi8KPiAgIAltZGl2ID0gKChiZXN0bTEgPDwgRFBJT19NMURJVl9TSElG
VCkgfCAoYmVzdG0yICYgRFBJT19NMkRJVl9NQVNLKSk7Cj4gQEAgLTc2NDAsNTUgKzc2NDAsNTUg
QEAgc3RhdGljIHZvaWQgdmx2X3ByZXBhcmVfcGxsKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+
ICAgCSAqIE5vdGU6IGRvbid0IHVzZSB0aGUgREFDIHBvc3QgZGl2aWRlciBhcyBpdCBzZWVtcyB1
bnN0YWJsZS4KPiAgIAkgKi8KPiAgIAltZGl2IHw9IChEUElPX1BPU1RfRElWX0hETUlEUCA8PCBE
UElPX1BPU1RfRElWX1NISUZUKTsKPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBW
TFZfUExMX0RXMyhwaXBlKSwgbWRpdik7Cj4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBW
TFZfUExMX0RXMyhwaXBlKSwgbWRpdik7Cj4gICAKPiAgIAltZGl2IHw9IERQSU9fRU5BQkxFX0NB
TElCUkFUSU9OOwo+IC0Jdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9QTExfRFcz
KHBpcGUpLCBtZGl2KTsKPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9QTExfRFcz
KHBpcGUpLCBtZGl2KTsKPiAgIAo+ICAgCS8qIFNldCBIQlIgYW5kIFJCUiBMUEYgY29lZmZpY2ll
bnRzICovCj4gICAJaWYgKHBpcGVfY29uZmlnLT5wb3J0X2Nsb2NrID09IDE2MjAwMCB8fAo+ICAg
CSAgICBpbnRlbF9jcnRjX2hhc190eXBlKHBpcGVfY29uZmlnLCBJTlRFTF9PVVRQVVRfQU5BTE9H
KSB8fAo+ICAgCSAgICBpbnRlbF9jcnRjX2hhc190eXBlKHBpcGVfY29uZmlnLCBJTlRFTF9PVVRQ
VVRfSERNSSkpCj4gLQkJdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9QTExfRFcx
MChwaXBlKSwKPiArCQl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBWTFZfUExMX0RXMTAocGlw
ZSksCj4gICAJCQkJIDB4MDA5ZjAwMDMpOwo+ICAgCWVsc2UKPiAtCQl2bHZfZHBpb193cml0ZShk
ZXZfcHJpdiwgcGlwZSwgVkxWX1BMTF9EVzEwKHBpcGUpLAo+ICsJCXZsdl9kcGlvX3dyaXRlKGk5
MTUsIHBpcGUsIFZMVl9QTExfRFcxMChwaXBlKSwKPiAgIAkJCQkgMHgwMGQwMDAwZik7Cj4gICAK
PiAgIAlpZiAoaW50ZWxfY3J0Y19oYXNfZHBfZW5jb2RlcihwaXBlX2NvbmZpZykpIHsKPiAgIAkJ
LyogVXNlIFNTQyBzb3VyY2UgKi8KPiAgIAkJaWYgKHBpcGUgPT0gUElQRV9BKQo+IC0JCQl2bHZf
ZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1BMTF9EVzUocGlwZSksCj4gKwkJCXZsdl9k
cGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9QTExfRFc1KHBpcGUpLAo+ICAgCQkJCQkgMHgwZGY0
MDAwMCk7Cj4gICAJCWVsc2UKPiAtCQkJdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZM
Vl9QTExfRFc1KHBpcGUpLAo+ICsJCQl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBWTFZfUExM
X0RXNShwaXBlKSwKPiAgIAkJCQkJIDB4MGRmNzAwMDApOwo+ICAgCX0gZWxzZSB7IC8qIEhETUkg
b3IgVkdBICovCj4gICAJCS8qIFVzZSBiZW5kIHNvdXJjZSAqLwo+ICAgCQlpZiAocGlwZSA9PSBQ
SVBFX0EpCj4gLQkJCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUExMX0RXNShw
aXBlKSwKPiArCQkJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxWX1BMTF9EVzUocGlwZSks
Cj4gICAJCQkJCSAweDBkZjcwMDAwKTsKPiAgIAkJZWxzZQo+IC0JCQl2bHZfZHBpb193cml0ZShk
ZXZfcHJpdiwgcGlwZSwgVkxWX1BMTF9EVzUocGlwZSksCj4gKwkJCXZsdl9kcGlvX3dyaXRlKGk5
MTUsIHBpcGUsIFZMVl9QTExfRFc1KHBpcGUpLAo+ICAgCQkJCQkgMHgwZGY0MDAwMCk7Cj4gICAJ
fQo+ICAgCj4gLQljb3JlY2xrID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgVkxWX1BM
TF9EVzcocGlwZSkpOwo+ICsJY29yZWNsayA9IHZsdl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwgVkxW
X1BMTF9EVzcocGlwZSkpOwo+ICAgCWNvcmVjbGsgPSAoY29yZWNsayAmIDB4MDAwMGZmMDApIHwg
MHgwMWMwMDAwMDsKPiAgIAlpZiAoaW50ZWxfY3J0Y19oYXNfZHBfZW5jb2RlcihwaXBlX2NvbmZp
ZykpCj4gICAJCWNvcmVjbGsgfD0gMHgwMTAwMDAwMDsKPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9w
cml2LCBwaXBlLCBWTFZfUExMX0RXNyhwaXBlKSwgY29yZWNsayk7Cj4gKwl2bHZfZHBpb193cml0
ZShpOTE1LCBwaXBlLCBWTFZfUExMX0RXNyhwaXBlKSwgY29yZWNsayk7Cj4gICAKPiAtCXZsdl9k
cGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUExMX0RXMTEocGlwZSksIDB4ODc4NzEwMDAp
Owo+ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxWX1BMTF9EVzExKHBpcGUpLCAweDg3
ODcxMDAwKTsKPiAgIAo+IC0Jdmx2X2RwaW9fcHV0KGRldl9wcml2KTsKPiArCXZsdl9kcGlvX3B1
dChpOTE1KTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgY2h2X3ByZXBhcmVfcGxsKHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCQkJICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpwaXBlX2NvbmZpZykKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0
Yy0+YmFzZS5kZXY7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2
KTsKPiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gICAJZW51bSBkcGlvX2NoYW5u
ZWwgcG9ydCA9IHZsdl9waXBlX3RvX2NoYW5uZWwocGlwZSk7Cj4gICAJdTMyIGxvb3BmaWx0ZXIs
IHRyaWJ1Zl9jYWxjbnRyOwo+IEBAIC03NzE0LDQyICs3NzE0LDQyIEBAIHN0YXRpYyB2b2lkIGNo
dl9wcmVwYXJlX3BsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAlkcGlvX3ZhbCA9IDA7
Cj4gICAJbG9vcGZpbHRlciA9IDA7Cj4gICAKPiAtCXZsdl9kcGlvX2dldChkZXZfcHJpdik7Cj4g
Kwl2bHZfZHBpb19nZXQoaTkxNSk7Cj4gICAKPiAgIAkvKiBwMSBhbmQgcDIgZGl2aWRlciAqLwo+
IC0Jdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIENIVl9DTU5fRFcxMyhwb3J0KSwKPiAr
CXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIENIVl9DTU5fRFcxMyhwb3J0KSwKPiAgIAkJCTUg
PDwgRFBJT19DSFZfUzFfRElWX1NISUZUIHwKPiAgIAkJCWJlc3RwMSA8PCBEUElPX0NIVl9QMV9E
SVZfU0hJRlQgfAo+ICAgCQkJYmVzdHAyIDw8IERQSU9fQ0hWX1AyX0RJVl9TSElGVCB8Cj4gICAJ
CQkxIDw8IERQSU9fQ0hWX0tfRElWX1NISUZUKTsKPiAgIAo+ICAgCS8qIEZlZWRiYWNrIHBvc3Qt
ZGl2aWRlciAtIG0yICovCj4gLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgQ0hWX1BM
TF9EVzAocG9ydCksIGJlc3RtMik7Cj4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBDSFZf
UExMX0RXMChwb3J0KSwgYmVzdG0yKTsKPiAgIAo+ICAgCS8qIEZlZWRiYWNrIHJlZmNsayBkaXZp
ZGVyIC0gbiBhbmQgbTEgKi8KPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBDSFZf
UExMX0RXMShwb3J0KSwKPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIENIVl9QTExfRFcx
KHBvcnQpLAo+ICAgCQkJRFBJT19DSFZfTTFfRElWX0JZXzIgfAo+ICAgCQkJMSA8PCBEUElPX0NI
Vl9OX0RJVl9TSElGVCk7Cj4gICAKPiAgIAkvKiBNMiBmcmFjdGlvbiBkaXZpc2lvbiAqLwo+IC0J
dmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIENIVl9QTExfRFcyKHBvcnQpLCBiZXN0bTJf
ZnJhYyk7Cj4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBDSFZfUExMX0RXMihwb3J0KSwg
YmVzdG0yX2ZyYWMpOwo+ICAgCj4gICAJLyogTTIgZnJhY3Rpb24gZGl2aXNpb24gZW5hYmxlICov
Cj4gLQlkcGlvX3ZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIENIVl9QTExfRFcz
KHBvcnQpKTsKPiArCWRwaW9fdmFsID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBDSFZfUExM
X0RXMyhwb3J0KSk7Cj4gICAJZHBpb192YWwgJj0gfihEUElPX0NIVl9GRUVERldEX0dBSU5fTUFT
SyB8IERQSU9fQ0hWX0ZSQUNfRElWX0VOKTsKPiAgIAlkcGlvX3ZhbCB8PSAoMiA8PCBEUElPX0NI
Vl9GRUVERldEX0dBSU5fU0hJRlQpOwo+ICAgCWlmIChiZXN0bTJfZnJhYykKPiAgIAkJZHBpb192
YWwgfD0gRFBJT19DSFZfRlJBQ19ESVZfRU47Cj4gLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwg
cGlwZSwgQ0hWX1BMTF9EVzMocG9ydCksIGRwaW9fdmFsKTsKPiArCXZsdl9kcGlvX3dyaXRlKGk5
MTUsIHBpcGUsIENIVl9QTExfRFczKHBvcnQpLCBkcGlvX3ZhbCk7Cj4gICAKPiAgIAkvKiBQcm9n
cmFtIGRpZ2l0YWwgbG9jayBkZXRlY3QgdGhyZXNob2xkICovCj4gLQlkcGlvX3ZhbCA9IHZsdl9k
cGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIENIVl9QTExfRFc5KHBvcnQpKTsKPiArCWRwaW9fdmFs
ID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBDSFZfUExMX0RXOShwb3J0KSk7Cj4gICAJZHBp
b192YWwgJj0gfihEUElPX0NIVl9JTlRfTE9DS19USFJFU0hPTERfTUFTSyB8Cj4gICAJCQkJCURQ
SU9fQ0hWX0lOVF9MT0NLX1RIUkVTSE9MRF9TRUxfQ09BUlNFKTsKPiAgIAlkcGlvX3ZhbCB8PSAo
MHg1IDw8IERQSU9fQ0hWX0lOVF9MT0NLX1RIUkVTSE9MRF9TSElGVCk7Cj4gICAJaWYgKCFiZXN0
bTJfZnJhYykKPiAgIAkJZHBpb192YWwgfD0gRFBJT19DSFZfSU5UX0xPQ0tfVEhSRVNIT0xEX1NF
TF9DT0FSU0U7Cj4gLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgQ0hWX1BMTF9EVzko
cG9ydCksIGRwaW9fdmFsKTsKPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIENIVl9QTExf
RFc5KHBvcnQpLCBkcGlvX3ZhbCk7Cj4gICAKPiAgIAkvKiBMb29wIGZpbHRlciAqLwo+ICAgCWlm
ICh2Y28gPT0gNTQwMDAwMCkgewo+IEBAIC03Nzc0LDI0ICs3Nzc0LDI0IEBAIHN0YXRpYyB2b2lk
IGNodl9wcmVwYXJlX3BsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAkJbG9vcGZpbHRl
ciB8PSAoMHgzIDw8IERQSU9fQ0hWX0dBSU5fQ1RSTF9TSElGVCk7Cj4gICAJCXRyaWJ1Zl9jYWxj
bnRyID0gMDsKPiAgIAl9Cj4gLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgQ0hWX1BM
TF9EVzYocG9ydCksIGxvb3BmaWx0ZXIpOwo+ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwg
Q0hWX1BMTF9EVzYocG9ydCksIGxvb3BmaWx0ZXIpOwo+ICAgCj4gLQlkcGlvX3ZhbCA9IHZsdl9k
cGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIENIVl9QTExfRFc4KHBvcnQpKTsKPiArCWRwaW9fdmFs
ID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBDSFZfUExMX0RXOChwb3J0KSk7Cj4gICAJZHBp
b192YWwgJj0gfkRQSU9fQ0hWX1REQ19UQVJHRVRfQ05UX01BU0s7Cj4gICAJZHBpb192YWwgfD0g
KHRyaWJ1Zl9jYWxjbnRyIDw8IERQSU9fQ0hWX1REQ19UQVJHRVRfQ05UX1NISUZUKTsKPiAtCXZs
dl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBDSFZfUExMX0RXOChwb3J0KSwgZHBpb192YWwp
Owo+ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgQ0hWX1BMTF9EVzgocG9ydCksIGRwaW9f
dmFsKTsKPiAgIAo+ICAgCS8qIEFGQyBSZWNhbCAqLwo+IC0Jdmx2X2RwaW9fd3JpdGUoZGV2X3By
aXYsIHBpcGUsIENIVl9DTU5fRFcxNChwb3J0KSwKPiAtCQkJdmx2X2RwaW9fcmVhZChkZXZfcHJp
diwgcGlwZSwgQ0hWX0NNTl9EVzE0KHBvcnQpKSB8Cj4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBw
aXBlLCBDSFZfQ01OX0RXMTQocG9ydCksCj4gKwkJCXZsdl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwg
Q0hWX0NNTl9EVzE0KHBvcnQpKSB8Cj4gICAJCQlEUElPX0FGQ19SRUNBTCk7Cj4gICAKPiAtCXZs
dl9kcGlvX3B1dChkZXZfcHJpdik7Cj4gKwl2bHZfZHBpb19wdXQoaTkxNSk7Cj4gICB9Cj4gICAK
PiAgIC8qKgo+ICAgICogdmx2X2ZvcmNlX3BsbF9vbiAtIGZvcmNpYmx5IGVuYWJsZSBqdXN0IHRo
ZSBQTEwKPiAtICogQGRldl9wcml2OiBpOTE1IHByaXZhdGUgc3RydWN0dXJlCj4gKyAqIEBpOTE1
OiBpOTE1IHByaXZhdGUgc3RydWN0dXJlCj4gICAgKiBAcGlwZTogcGlwZSBQTEwgdG8gZW5hYmxl
Cj4gICAgKiBAZHBsbDogUExMIGNvbmZpZ3VyYXRpb24KPiAgICAqCj4gQEAgLTc3OTksMTAgKzc3
OTksMTAgQEAgc3RhdGljIHZvaWQgY2h2X3ByZXBhcmVfcGxsKHN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjLAo+ICAgICogaW4gY2FzZXMgd2hlcmUgd2UgbmVlZCB0aGUgUExMIGVuYWJsZWQgZXZlbiB3
aGVuIEBwaXBlIGlzIG5vdCBnb2luZyB0bwo+ICAgICogYmUgZW5hYmxlZC4KPiAgICAqLwo+IC1p
bnQgdmx2X2ZvcmNlX3BsbF9vbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVu
dW0gcGlwZSBwaXBlLAo+ICtpbnQgdmx2X2ZvcmNlX3BsbF9vbihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwgZW51bSBwaXBlIHBpcGUsCj4gICAJCSAgICAgY29uc3Qgc3RydWN0IGRwbGwg
KmRwbGwpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IGludGVsX2dldF9jcnRj
X2Zvcl9waXBlKGRldl9wcml2LCBwaXBlKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0g
aW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoaTkxNSwgcGlwZSk7Cj4gICAJc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKnBpcGVfY29uZmlnOwo+ICAgCj4gICAJcGlwZV9jb25maWcgPSBremFsbG9jKHNp
emVvZigqcGlwZV9jb25maWcpLCBHRlBfS0VSTkVMKTsKPiBAQCAtNzgxMyw3ICs3ODEzLDcgQEAg
aW50IHZsdl9mb3JjZV9wbGxfb24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBl
bnVtIHBpcGUgcGlwZSwKPiAgIAlwaXBlX2NvbmZpZy0+cGl4ZWxfbXVsdGlwbGllciA9IDE7Cj4g
ICAJcGlwZV9jb25maWctPmRwbGwgPSAqZHBsbDsKPiAgIAo+IC0JaWYgKElTX0NIRVJSWVZJRVco
ZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkgewo+ICAgCQljaHZfY29t
cHV0ZV9kcGxsKGNydGMsIHBpcGVfY29uZmlnKTsKPiAgIAkJY2h2X3ByZXBhcmVfcGxsKGNydGMs
IHBpcGVfY29uZmlnKTsKPiAgIAkJY2h2X2VuYWJsZV9wbGwoY3J0YywgcGlwZV9jb25maWcpOwo+
IEBAIC03ODMwLDI1ICs3ODMwLDI1IEBAIGludCB2bHZfZm9yY2VfcGxsX29uKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUsCj4gICAKPiAgIC8qKgo+ICAg
ICogdmx2X2ZvcmNlX3BsbF9vZmYgLSBmb3JjaWJseSBkaXNhYmxlIGp1c3QgdGhlIFBMTAo+IC0g
KiBAZGV2X3ByaXY6IGk5MTUgcHJpdmF0ZSBzdHJ1Y3R1cmUKPiArICogQGk5MTU6IGk5MTUgcHJp
dmF0ZSBzdHJ1Y3R1cmUKPiAgICAqIEBwaXBlOiBwaXBlIFBMTCB0byBkaXNhYmxlCj4gICAgKgo+
ICAgICogRGlzYWJsZSB0aGUgUExMIGZvciBAcGlwZS4gVG8gYmUgdXNlZCBpbiBjYXNlcyB3aGVy
ZSB3ZSBuZWVkCj4gICAgKiB0aGUgUExMIGVuYWJsZWQgZXZlbiB3aGVuIEBwaXBlIGlzIG5vdCBn
b2luZyB0byBiZSBlbmFibGVkLgo+ICAgICovCj4gLXZvaWQgdmx2X2ZvcmNlX3BsbF9vZmYoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUgcGlwZSkKPiArdm9pZCB2
bHZfZm9yY2VfcGxsX29mZihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBwaXBl
IHBpcGUpCj4gICB7Cj4gLQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gLQkJY2h2X2Rp
c2FibGVfcGxsKGRldl9wcml2LCBwaXBlKTsKPiArCWlmIChJU19DSEVSUllWSUVXKGk5MTUpKQo+
ICsJCWNodl9kaXNhYmxlX3BsbChpOTE1LCBwaXBlKTsKPiAgIAllbHNlCj4gLQkJdmx2X2Rpc2Fi
bGVfcGxsKGRldl9wcml2LCBwaXBlKTsKPiArCQl2bHZfZGlzYWJsZV9wbGwoaTkxNSwgcGlwZSk7
Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIGk5eHhfY29tcHV0ZV9kcGxsKHN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjLAo+ICAgCQkJICAgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUsCj4gICAJCQkgICAgICBzdHJ1Y3QgZHBsbCAqcmVkdWNlZF9jbG9jaykKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5k
ZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJh
c2UuZGV2KTsKPiAgIAl1MzIgZHBsbDsKPiAgIAlzdHJ1Y3QgZHBsbCAqY2xvY2sgPSAmY3J0Y19z
dGF0ZS0+ZHBsbDsKPiAgIAo+IEBAIC03ODYxLDggKzc4NjEsOCBAQCBzdGF0aWMgdm9pZCBpOXh4
X2NvbXB1dGVfZHBsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAllbHNlCj4gICAJCWRw
bGwgfD0gRFBMTEJfTU9ERV9EQUNfU0VSSUFMOwo+ICAgCj4gLQlpZiAoSVNfSTk0NUcoZGV2X3By
aXYpIHx8IElTX0k5NDVHTShkZXZfcHJpdikgfHwKPiAtCSAgICBJU19HMzMoZGV2X3ByaXYpIHx8
IElTX1BJTkVWSUVXKGRldl9wcml2KSkgewo+ICsJaWYgKElTX0k5NDVHKGk5MTUpIHx8IElTX0k5
NDVHTShpOTE1KSB8fAo+ICsJICAgIElTX0czMyhpOTE1KSB8fCBJU19QSU5FVklFVyhpOTE1KSkg
ewo+ICAgCQlkcGxsIHw9IChjcnRjX3N0YXRlLT5waXhlbF9tdWx0aXBsaWVyIC0gMSkKPiAgIAkJ
CTw8IFNEVk9fTVVMVElQTElFUl9TSElGVF9ISVJFUzsKPiAgIAl9Cj4gQEAgLTc4NzUsMTEgKzc4
NzUsMTEgQEAgc3RhdGljIHZvaWQgaTl4eF9jb21wdXRlX2RwbGwoc3RydWN0IGludGVsX2NydGMg
KmNydGMsCj4gICAJCWRwbGwgfD0gRFBMTF9TRFZPX0hJR0hfU1BFRUQ7Cj4gICAKPiAgIAkvKiBj
b21wdXRlIGJpdG1hc2sgZnJvbSBwMSB2YWx1ZSAqLwo+IC0JaWYgKElTX1BJTkVWSUVXKGRldl9w
cml2KSkKPiArCWlmIChJU19QSU5FVklFVyhpOTE1KSkKPiAgIAkJZHBsbCB8PSAoMSA8PCAoY2xv
Y2stPnAxIC0gMSkpIDw8IERQTExfRlBBMDFfUDFfUE9TVF9ESVZfU0hJRlRfUElORVZJRVc7Cj4g
ICAJZWxzZSB7Cj4gICAJCWRwbGwgfD0gKDEgPDwgKGNsb2NrLT5wMSAtIDEpKSA8PCBEUExMX0ZQ
QTAxX1AxX1BPU1RfRElWX1NISUZUOwo+IC0JCWlmIChJU19HNFgoZGV2X3ByaXYpICYmIHJlZHVj
ZWRfY2xvY2spCj4gKwkJaWYgKElTX0c0WChpOTE1KSAmJiByZWR1Y2VkX2Nsb2NrKQo+ICAgCQkJ
ZHBsbCB8PSAoMSA8PCAocmVkdWNlZF9jbG9jay0+cDEgLSAxKSkgPDwgRFBMTF9GUEExX1AxX1BP
U1RfRElWX1NISUZUOwo+ICAgCX0KPiAgIAlzd2l0Y2ggKGNsb2NrLT5wMikgewo+IEBAIC03ODk2
LDEzICs3ODk2LDEzIEBAIHN0YXRpYyB2b2lkIGk5eHhfY29tcHV0ZV9kcGxsKHN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjLAo+ICAgCQlkcGxsIHw9IERQTExCX0xWRFNfUDJfQ0xPQ0tfRElWXzE0Owo+
ICAgCQlicmVhazsKPiAgIAl9Cj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA0KQo+ICsJ
aWYgKElOVEVMX0dFTihpOTE1KSA+PSA0KQo+ICAgCQlkcGxsIHw9ICg2IDw8IFBMTF9MT0FEX1BV
TFNFX1BIQVNFX1NISUZUKTsKPiAgIAo+ICAgCWlmIChjcnRjX3N0YXRlLT5zZHZvX3R2X2Nsb2Nr
KQo+ICAgCQlkcGxsIHw9IFBMTF9SRUZfSU5QVVRfVFZDTEtJTkJDOwo+ICAgCWVsc2UgaWYgKGlu
dGVsX2NydGNfaGFzX3R5cGUoY3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVUX0xWRFMpICYmCj4gLQkJ
IGludGVsX3BhbmVsX3VzZV9zc2MoZGV2X3ByaXYpKQo+ICsJCSBpbnRlbF9wYW5lbF91c2Vfc3Nj
KGk5MTUpKQo+ICAgCQlkcGxsIHw9IFBMTEJfUkVGX0lOUFVUX1NQUkVBRFNQRUNUUlVNSU47Cj4g
ICAJZWxzZQo+ICAgCQlkcGxsIHw9IFBMTF9SRUZfSU5QVVRfRFJFRkNMSzsKPiBAQCAtNzkxMCw3
ICs3OTEwLDcgQEAgc3RhdGljIHZvaWQgaTl4eF9jb21wdXRlX2RwbGwoc3RydWN0IGludGVsX2Ny
dGMgKmNydGMsCj4gICAJZHBsbCB8PSBEUExMX1ZDT19FTkFCTEU7Cj4gICAJY3J0Y19zdGF0ZS0+
ZHBsbF9od19zdGF0ZS5kcGxsID0gZHBsbDsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJp
dikgPj0gNCkgewo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA0KSB7Cj4gICAJCXUzMiBkcGxs
X21kID0gKGNydGNfc3RhdGUtPnBpeGVsX211bHRpcGxpZXIgLSAxKQo+ICAgCQkJPDwgRFBMTF9N
RF9VRElfTVVMVElQTElFUl9TSElGVDsKPiAgIAkJY3J0Y19zdGF0ZS0+ZHBsbF9od19zdGF0ZS5k
cGxsX21kID0gZHBsbF9tZDsKPiBAQCAtNzkyMiw3ICs3OTIyLDcgQEAgc3RhdGljIHZvaWQgaTh4
eF9jb21wdXRlX2RwbGwoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gICAJCQkgICAgICBzdHJ1
Y3QgZHBsbCAqcmVkdWNlZF9jbG9jaykKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
ID0gY3J0Yy0+YmFzZS5kZXY7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoZGV2KTsKPiAgIAl1MzIgZHBsbDsKPiAgIAlzdHJ1Y3QgZHBsbCAqY2xvY2sgPSAmY3J0Y19z
dGF0ZS0+ZHBsbDsKPiAgIAo+IEBAIC03OTUzLDEyICs3OTUzLDEyIEBAIHN0YXRpYyB2b2lkIGk4
eHhfY29tcHV0ZV9kcGxsKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCSAqIGJvdGggRFBM
TFMuIFRoZSBzcGVjIHNheXMgd2Ugc2hvdWxkIGRpc2FibGUgdGhlIERWTyAyWCBjbG9jawo+ICAg
CSAqIHdoZW4gbm90IG5lZWRlZCwgYnV0IHRoaXMgc2VlbXMgdG8gd29yayBmaW5lIGluIHByYWN0
aWNlLgo+ICAgCSAqLwo+IC0JaWYgKElTX0k4MzAoZGV2X3ByaXYpIHx8Cj4gKwlpZiAoSVNfSTgz
MChpOTE1KSB8fAo+ICAgCSAgICBpbnRlbF9jcnRjX2hhc190eXBlKGNydGNfc3RhdGUsIElOVEVM
X09VVFBVVF9EVk8pKQo+ICAgCQlkcGxsIHw9IERQTExfRFZPXzJYX01PREU7Cj4gICAKPiAgIAlp
ZiAoaW50ZWxfY3J0Y19oYXNfdHlwZShjcnRjX3N0YXRlLCBJTlRFTF9PVVRQVVRfTFZEUykgJiYK
PiAtCSAgICBpbnRlbF9wYW5lbF91c2Vfc3NjKGRldl9wcml2KSkKPiArCSAgICBpbnRlbF9wYW5l
bF91c2Vfc3NjKGk5MTUpKQo+ICAgCQlkcGxsIHw9IFBMTEJfUkVGX0lOUFVUX1NQUkVBRFNQRUNU
UlVNSU47Cj4gICAJZWxzZQo+ICAgCQlkcGxsIHw9IFBMTF9SRUZfSU5QVVRfRFJFRkNMSzsKPiBA
QCAtNzk3MCw3ICs3OTcwLDcgQEAgc3RhdGljIHZvaWQgaTh4eF9jb21wdXRlX2RwbGwoc3RydWN0
IGludGVsX2NydGMgKmNydGMsCj4gICBzdGF0aWMgdm9pZCBpbnRlbF9zZXRfcGlwZV90aW1pbmdz
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgewo+ICAgCXN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNy
dGMpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
Y3J0Yy0+YmFzZS5kZXYpOwo+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgIAll
bnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2Rl
cjsKPiAgIAljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZj
cnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gQEAgLTc5OTYsNyArNzk5Niw3IEBAIHN0
YXRpYyB2b2lkIGludGVsX3NldF9waXBlX3RpbWluZ3MoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCj4gICAJCQl2c3luY3NoaWZ0ICs9IGFkanVzdGVkX21vZGUtPmNy
dGNfaHRvdGFsOwo+ICAgCX0KPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPiAzKQo+
ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+IDMpCj4gICAJCUk5MTVfV1JJVEUoVlNZTkNTSElGVChj
cHVfdHJhbnNjb2RlciksIHZzeW5jc2hpZnQpOwo+ICAgCj4gICAJSTkxNV9XUklURShIVE9UQUwo
Y3B1X3RyYW5zY29kZXIpLAo+IEBAIC04MDIzLDcgKzgwMjMsNyBAQCBzdGF0aWMgdm9pZCBpbnRl
bF9zZXRfcGlwZV90aW1pbmdzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlKQo+ICAgCSAqIHByb2dyYW1tZWQgd2l0aCB0aGUgVlRPVEFMX0VEUCB2YWx1ZS4gU2FtZSBm
b3IgVlRPVEFMX0MuIFRoaXMgaXMKPiAgIAkgKiBkb2N1bWVudGVkIG9uIHRoZSBERElfRlVOQ19D
VEwgcmVnaXN0ZXIgZGVzY3JpcHRpb24sIEVEUCBJbnB1dCBTZWxlY3QKPiAgIAkgKiBiaXRzLiAq
Lwo+IC0JaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpICYmIGNwdV90cmFuc2NvZGVyID09IFRSQU5T
Q09ERVJfRURQICYmCj4gKwlpZiAoSVNfSEFTV0VMTChpOTE1KSAmJiBjcHVfdHJhbnNjb2RlciA9
PSBUUkFOU0NPREVSX0VEUCAmJgo+ICAgCSAgICAocGlwZSA9PSBQSVBFX0IgfHwgcGlwZSA9PSBQ
SVBFX0MpKQo+ICAgCQlJOTE1X1dSSVRFKFZUT1RBTChwaXBlKSwgSTkxNV9SRUFEKFZUT1RBTChj
cHVfdHJhbnNjb2RlcikpKTsKPiAgIAo+IEBAIC04MDMyLDcgKzgwMzIsNyBAQCBzdGF0aWMgdm9p
ZCBpbnRlbF9zZXRfcGlwZV90aW1pbmdzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlKQo+ICAgc3RhdGljIHZvaWQgaW50ZWxfc2V0X3BpcGVfc3JjX3NpemUoY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2Uu
ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5i
YXNlLmRldik7Cj4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAgCj4gICAJLyog
cGlwZXNyYyBjb250cm9scyB0aGUgc2l6ZSB0aGF0IGlzIHNjYWxlZCBmcm9tLCB3aGljaCBzaG91
bGQKPiBAQCAtODA0Nyw3ICs4MDQ3LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZ2V0X3BpcGVfdGlt
aW5ncyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAkJCQkgICBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gICB7Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9
IGNydGMtPmJhc2UuZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGRldik7Cj4gICAJZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0gcGlwZV9jb25maWct
PmNwdV90cmFuc2NvZGVyOwo+ICAgCXUzMiB0bXA7Cj4gICAKPiBAQCAtODA5Miw3ICs4MDkyLDcg
QEAgc3RhdGljIHZvaWQgaW50ZWxfZ2V0X3BpcGVfc3JjX3NpemUoc3RydWN0IGludGVsX2NydGMg
KmNydGMsCj4gICAJCQkJICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykK
PiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7Cj4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAl1MzIgdG1wOwo+
ICAgCj4gICAJdG1wID0gSTkxNV9SRUFEKFBJUEVTUkMoY3J0Yy0+cGlwZSkpOwo+IEBAIC04MTI5
LDIxICs4MTI5LDIxIEBAIHZvaWQgaW50ZWxfbW9kZV9mcm9tX3BpcGVfY29uZmlnKHN0cnVjdCBk
cm1fZGlzcGxheV9tb2RlICptb2RlLAo+ICAgc3RhdGljIHZvaWQgaTl4eF9zZXRfcGlwZWNvbmYo
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gICAJc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0
Yyk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMt
PmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShj
cnRjLT5iYXNlLmRldik7Cj4gICAJdTMyIHBpcGVjb25mOwo+ICAgCj4gICAJcGlwZWNvbmYgPSAw
Owo+ICAgCj4gICAJLyogd2Uga2VlcCBib3RoIHBpcGVzIGVuYWJsZWQgb24gODMwICovCj4gLQlp
ZiAoSVNfSTgzMChkZXZfcHJpdikpCj4gKwlpZiAoSVNfSTgzMChpOTE1KSkKPiAgIAkJcGlwZWNv
bmYgfD0gSTkxNV9SRUFEKFBJUEVDT05GKGNydGMtPnBpcGUpKSAmIFBJUEVDT05GX0VOQUJMRTsK
PiAgIAo+ICAgCWlmIChjcnRjX3N0YXRlLT5kb3VibGVfd2lkZSkKPiAgIAkJcGlwZWNvbmYgfD0g
UElQRUNPTkZfRE9VQkxFX1dJREU7Cj4gICAKPiAgIAkvKiBvbmx5IGc0eCBhbmQgbGF0ZXIgaGF2
ZSBmYW5jeSBicGMvZGl0aGVyIGNvbnRyb2xzICovCj4gLQlpZiAoSVNfRzRYKGRldl9wcml2KSB8
fCBJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fAo+IC0JICAgIElTX0NIRVJSWVZJRVcoZGV2X3By
aXYpKSB7Cj4gKwlpZiAoSVNfRzRYKGk5MTUpIHx8IElTX1ZBTExFWVZJRVcoaTkxNSkgfHwKPiAr
CSAgICBJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gICAJCS8qIEJzcGVjIGNsYWltcyB0aGF0IHdl
IGNhbid0IHVzZSBkaXRoZXJpbmcgZm9yIDMwYnBwIHBpcGVzLiAqLwo+ICAgCQlpZiAoY3J0Y19z
dGF0ZS0+ZGl0aGVyICYmIGNydGNfc3RhdGUtPnBpcGVfYnBwICE9IDMwKQo+ICAgCQkJcGlwZWNv
bmYgfD0gUElQRUNPTkZfRElUSEVSX0VOIHwKPiBAQCAtODE2Niw3ICs4MTY2LDcgQEAgc3RhdGlj
IHZvaWQgaTl4eF9zZXRfcGlwZWNvbmYoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUpCj4gICAJfQo+ICAgCj4gICAJaWYgKGNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRf
bW9kZS5mbGFncyAmIERSTV9NT0RFX0ZMQUdfSU5URVJMQUNFKSB7Cj4gLQkJaWYgKElOVEVMX0dF
TihkZXZfcHJpdikgPCA0IHx8Cj4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA8IDQgfHwKPiAgIAkJ
ICAgIGludGVsX2NydGNfaGFzX3R5cGUoY3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVUX1NEVk8pKQo+
ICAgCQkJcGlwZWNvbmYgfD0gUElQRUNPTkZfSU5URVJMQUNFX1dfRklFTERfSU5ESUNBVElPTjsK
PiAgIAkJZWxzZQo+IEBAIC04MTc1LDcgKzgxNzUsNyBAQCBzdGF0aWMgdm9pZCBpOXh4X3NldF9w
aXBlY29uZihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIAkJ
cGlwZWNvbmYgfD0gUElQRUNPTkZfUFJPR1JFU1NJVkU7Cj4gICAJfQo+ICAgCj4gLQlpZiAoKElT
X1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSAmJgo+ICsJ
aWYgKChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpICYmCj4gICAJ
ICAgICBjcnRjX3N0YXRlLT5saW1pdGVkX2NvbG9yX3JhbmdlKQo+ICAgCQlwaXBlY29uZiB8PSBQ
SVBFQ09ORl9DT0xPUl9SQU5HRV9TRUxFQ1Q7Cj4gICAKPiBAQCAtODE4OSw3ICs4MTg5LDcgQEAg
c3RhdGljIGludCBpOHh4X2NydGNfY29tcHV0ZV9jbG9jayhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YywKPiAgIAkJCQkgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsK
PiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7Cj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAljb25zdCBzdHJ1Y3QgaW50
ZWxfbGltaXQgKmxpbWl0Owo+ICAgCWludCByZWZjbGsgPSA0ODAwMDsKPiAgIAo+IEBAIC04MTk3
LDggKzgxOTcsOCBAQCBzdGF0aWMgaW50IGk4eHhfY3J0Y19jb21wdXRlX2Nsb2NrKHN0cnVjdCBp
bnRlbF9jcnRjICpjcnRjLAo+ICAgCSAgICAgICBzaXplb2YoY3J0Y19zdGF0ZS0+ZHBsbF9od19z
dGF0ZSkpOwo+ICAgCj4gICAJaWYgKGludGVsX2NydGNfaGFzX3R5cGUoY3J0Y19zdGF0ZSwgSU5U
RUxfT1VUUFVUX0xWRFMpKSB7Cj4gLQkJaWYgKGludGVsX3BhbmVsX3VzZV9zc2MoZGV2X3ByaXYp
KSB7Cj4gLQkJCXJlZmNsayA9IGRldl9wcml2LT52YnQubHZkc19zc2NfZnJlcTsKPiArCQlpZiAo
aW50ZWxfcGFuZWxfdXNlX3NzYyhpOTE1KSkgewo+ICsJCQlyZWZjbGsgPSBpOTE1LT52YnQubHZk
c19zc2NfZnJlcTsKPiAgIAkJCURSTV9ERUJVR19LTVMoInVzaW5nIFNTQyByZWZlcmVuY2UgY2xv
Y2sgb2YgJWQga0h6XG4iLCByZWZjbGspOwo+ICAgCQl9Cj4gICAKPiBAQCAtODIyNCw3ICs4MjI0
LDcgQEAgc3RhdGljIGludCBpOHh4X2NydGNfY29tcHV0ZV9jbG9jayhzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YywKPiAgIHN0YXRpYyBpbnQgZzR4X2NydGNfY29tcHV0ZV9jbG9jayhzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YywKPiAgIAkJCQkgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAgCWNvbnN0IHN0cnVjdCBpbnRlbF9saW1pdCAqbGlt
aXQ7Cj4gICAJaW50IHJlZmNsayA9IDk2MDAwOwo+ICAgCj4gQEAgLTgyMzIsMTIgKzgyMzIsMTIg
QEAgc3RhdGljIGludCBnNHhfY3J0Y19jb21wdXRlX2Nsb2NrKHN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjLAo+ICAgCSAgICAgICBzaXplb2YoY3J0Y19zdGF0ZS0+ZHBsbF9od19zdGF0ZSkpOwo+ICAg
Cj4gICAJaWYgKGludGVsX2NydGNfaGFzX3R5cGUoY3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVUX0xW
RFMpKSB7Cj4gLQkJaWYgKGludGVsX3BhbmVsX3VzZV9zc2MoZGV2X3ByaXYpKSB7Cj4gLQkJCXJl
ZmNsayA9IGRldl9wcml2LT52YnQubHZkc19zc2NfZnJlcTsKPiArCQlpZiAoaW50ZWxfcGFuZWxf
dXNlX3NzYyhpOTE1KSkgewo+ICsJCQlyZWZjbGsgPSBpOTE1LT52YnQubHZkc19zc2NfZnJlcTsK
PiAgIAkJCURSTV9ERUJVR19LTVMoInVzaW5nIFNTQyByZWZlcmVuY2UgY2xvY2sgb2YgJWQga0h6
XG4iLCByZWZjbGspOwo+ICAgCQl9Cj4gICAKPiAtCQlpZiAoaW50ZWxfaXNfZHVhbF9saW5rX2x2
ZHMoZGV2X3ByaXYpKQo+ICsJCWlmIChpbnRlbF9pc19kdWFsX2xpbmtfbHZkcyhpOTE1KSkKPiAg
IAkJCWxpbWl0ID0gJmludGVsX2xpbWl0c19nNHhfZHVhbF9jaGFubmVsX2x2ZHM7Cj4gICAJCWVs
c2UKPiAgIAkJCWxpbWl0ID0gJmludGVsX2xpbWl0c19nNHhfc2luZ2xlX2NoYW5uZWxfbHZkczsK
PiBAQCAtODI2Nyw3ICs4MjY3LDcgQEAgc3RhdGljIGludCBwbnZfY3J0Y19jb21wdXRlX2Nsb2Nr
KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCQkJCSAgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMt
PmJhc2UuZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7
Cj4gICAJY29uc3Qgc3RydWN0IGludGVsX2xpbWl0ICpsaW1pdDsKPiAgIAlpbnQgcmVmY2xrID0g
OTYwMDA7Cj4gICAKPiBAQCAtODI3NSw4ICs4Mjc1LDggQEAgc3RhdGljIGludCBwbnZfY3J0Y19j
b21wdXRlX2Nsb2NrKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCSAgICAgICBzaXplb2Yo
Y3J0Y19zdGF0ZS0+ZHBsbF9od19zdGF0ZSkpOwo+ICAgCj4gICAJaWYgKGludGVsX2NydGNfaGFz
X3R5cGUoY3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVUX0xWRFMpKSB7Cj4gLQkJaWYgKGludGVsX3Bh
bmVsX3VzZV9zc2MoZGV2X3ByaXYpKSB7Cj4gLQkJCXJlZmNsayA9IGRldl9wcml2LT52YnQubHZk
c19zc2NfZnJlcTsKPiArCQlpZiAoaW50ZWxfcGFuZWxfdXNlX3NzYyhpOTE1KSkgewo+ICsJCQly
ZWZjbGsgPSBpOTE1LT52YnQubHZkc19zc2NfZnJlcTsKPiAgIAkJCURSTV9ERUJVR19LTVMoInVz
aW5nIFNTQyByZWZlcmVuY2UgY2xvY2sgb2YgJWQga0h6XG4iLCByZWZjbGspOwo+ICAgCQl9Cj4g
ICAKPiBAQCAtODMwMSw3ICs4MzAxLDcgQEAgc3RhdGljIGludCBpOXh4X2NydGNfY29tcHV0ZV9j
bG9jayhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAkJCQkgICBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0g
Y3J0Yy0+YmFzZS5kZXY7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
ZGV2KTsKPiAgIAljb25zdCBzdHJ1Y3QgaW50ZWxfbGltaXQgKmxpbWl0Owo+ICAgCWludCByZWZj
bGsgPSA5NjAwMDsKPiAgIAo+IEBAIC04MzA5LDggKzgzMDksOCBAQCBzdGF0aWMgaW50IGk5eHhf
Y3J0Y19jb21wdXRlX2Nsb2NrKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCSAgICAgICBz
aXplb2YoY3J0Y19zdGF0ZS0+ZHBsbF9od19zdGF0ZSkpOwo+ICAgCj4gICAJaWYgKGludGVsX2Ny
dGNfaGFzX3R5cGUoY3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVUX0xWRFMpKSB7Cj4gLQkJaWYgKGlu
dGVsX3BhbmVsX3VzZV9zc2MoZGV2X3ByaXYpKSB7Cj4gLQkJCXJlZmNsayA9IGRldl9wcml2LT52
YnQubHZkc19zc2NfZnJlcTsKPiArCQlpZiAoaW50ZWxfcGFuZWxfdXNlX3NzYyhpOTE1KSkgewo+
ICsJCQlyZWZjbGsgPSBpOTE1LT52YnQubHZkc19zc2NfZnJlcTsKPiAgIAkJCURSTV9ERUJVR19L
TVMoInVzaW5nIFNTQyByZWZlcmVuY2UgY2xvY2sgb2YgJWQga0h6XG4iLCByZWZjbGspOwo+ICAg
CQl9Cj4gICAKPiBAQCAtODM3MywyMiArODM3MywyMiBAQCBzdGF0aWMgaW50IHZsdl9jcnRjX2Nv
bXB1dGVfY2xvY2soc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gICAJcmV0dXJuIDA7Cj4gICB9
Cj4gICAKPiAtc3RhdGljIGJvb2wgaTl4eF9oYXNfcGZpdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyBib29sIGk5eHhfaGFzX3BmaXQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlpZiAoSVNfSTgzMChkZXZfcHJpdikpCj4gKwlpZiAo
SVNfSTgzMChpOTE1KSkKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAgCj4gLQlyZXR1cm4gSU5URUxf
R0VOKGRldl9wcml2KSA+PSA0IHx8Cj4gLQkJSVNfUElORVZJRVcoZGV2X3ByaXYpIHx8IElTX01P
QklMRShkZXZfcHJpdik7Cj4gKwlyZXR1cm4gSU5URUxfR0VOKGk5MTUpID49IDQgfHwKPiArCQlJ
U19QSU5FVklFVyhpOTE1KSB8fCBJU19NT0JJTEUoaTkxNSk7Cj4gICB9Cj4gICAKPiAgIHN0YXRp
YyB2b2lkIGk5eHhfZ2V0X3BmaXRfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAg
CQkJCSBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gICB7Cj4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsK
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRl
dik7Cj4gICAJdTMyIHRtcDsKPiAgIAo+IC0JaWYgKCFpOXh4X2hhc19wZml0KGRldl9wcml2KSkK
PiArCWlmICghaTl4eF9oYXNfcGZpdChpOTE1KSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJdG1w
ID0gSTkxNV9SRUFEKFBGSVRfQ09OVFJPTCk7Cj4gQEAgLTgzOTYsNyArODM5Niw3IEBAIHN0YXRp
YyB2b2lkIGk5eHhfZ2V0X3BmaXRfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAg
CQlyZXR1cm47Cj4gICAKPiAgIAkvKiBDaGVjayB3aGV0aGVyIHRoZSBwZml0IGlzIGF0dGFjaGVk
IHRvIG91ciBwaXBlLiAqLwo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA0KSB7Cj4gKwlp
ZiAoSU5URUxfR0VOKGk5MTUpIDwgNCkgewo+ICAgCQlpZiAoY3J0Yy0+cGlwZSAhPSBQSVBFX0Ip
Cj4gICAJCQlyZXR1cm47Cj4gICAJfSBlbHNlIHsKPiBAQCAtODQxMiw3ICs4NDEyLDcgQEAgc3Rh
dGljIHZvaWQgdmx2X2NydGNfY2xvY2tfZ2V0KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAg
CQkJICAgICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiAgIHsKPiAg
IAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7Cj4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAlpbnQgcGlwZSA9IHBpcGVfY29u
ZmlnLT5jcHVfdHJhbnNjb2RlcjsKPiAgIAlzdHJ1Y3QgZHBsbCBjbG9jazsKPiAgIAl1MzIgbWRp
djsKPiBAQCAtODQyMiw5ICs4NDIyLDkgQEAgc3RhdGljIHZvaWQgdmx2X2NydGNfY2xvY2tfZ2V0
KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCWlmICgocGlwZV9jb25maWctPmRwbGxfaHdf
c3RhdGUuZHBsbCAmIERQTExfVkNPX0VOQUJMRSkgPT0gMCkKPiAgIAkJcmV0dXJuOwo+ICAgCj4g
LQl2bHZfZHBpb19nZXQoZGV2X3ByaXYpOwo+IC0JbWRpdiA9IHZsdl9kcGlvX3JlYWQoZGV2X3By
aXYsIHBpcGUsIFZMVl9QTExfRFczKHBpcGUpKTsKPiAtCXZsdl9kcGlvX3B1dChkZXZfcHJpdik7
Cj4gKwl2bHZfZHBpb19nZXQoaTkxNSk7Cj4gKwltZGl2ID0gdmx2X2RwaW9fcmVhZChpOTE1LCBw
aXBlLCBWTFZfUExMX0RXMyhwaXBlKSk7Cj4gKwl2bHZfZHBpb19wdXQoaTkxNSk7Cj4gICAKPiAg
IAljbG9jay5tMSA9IChtZGl2ID4+IERQSU9fTTFESVZfU0hJRlQpICYgNzsKPiAgIAljbG9jay5t
MiA9IG1kaXYgJiBEUElPX00yRElWX01BU0s7Cj4gQEAgLTg0NDAsNyArODQ0MCw3IEBAIGk5eHhf
Z2V0X2luaXRpYWxfcGxhbmVfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCQkJ
ICAgICAgc3RydWN0IGludGVsX2luaXRpYWxfcGxhbmVfY29uZmlnICpwbGFuZV9jb25maWcpCj4g
ICB7Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmJhc2UuZGV2Owo+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJc3RydWN0IGludGVs
X3BsYW5lICpwbGFuZSA9IHRvX2ludGVsX3BsYW5lKGNydGMtPmJhc2UucHJpbWFyeSk7Cj4gICAJ
ZW51bSBpOXh4X3BsYW5lX2lkIGk5eHhfcGxhbmUgPSBwbGFuZS0+aTl4eF9wbGFuZTsKPiAgIAll
bnVtIHBpcGUgcGlwZTsKPiBAQCAtODQ2Nyw3ICs4NDY3LDcgQEAgaTl4eF9nZXRfaW5pdGlhbF9w
bGFuZV9jb25maWcoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gICAKPiAgIAl2YWwgPSBJOTE1
X1JFQUQoRFNQQ05UUihpOXh4X3BsYW5lKSk7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDQpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNCkgewo+ICAgCQlpZiAodmFs
ICYgRElTUFBMQU5FX1RJTEVEKSB7Cj4gICAJCQlwbGFuZV9jb25maWctPnRpbGluZyA9IEk5MTVf
VElMSU5HX1g7Cj4gICAJCQlmYi0+bW9kaWZpZXIgPSBJOTE1X0ZPUk1BVF9NT0RfWF9USUxFRDsK
PiBAQCAtODQ3Nyw3ICs4NDc3LDcgQEAgaTl4eF9nZXRfaW5pdGlhbF9wbGFuZV9jb25maWcoc3Ry
dWN0IGludGVsX2NydGMgKmNydGMsCj4gICAJCQlwbGFuZV9jb25maWctPnJvdGF0aW9uID0gRFJN
X01PREVfUk9UQVRFXzE4MDsKPiAgIAl9Cj4gICAKPiAtCWlmIChJU19DSEVSUllWSUVXKGRldl9w
cml2KSAmJiBwaXBlID09IFBJUEVfQiAmJgo+ICsJaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkgJiYg
cGlwZSA9PSBQSVBFX0IgJiYKPiAgIAkgICAgdmFsICYgRElTUFBMQU5FX01JUlJPUikKPiAgIAkJ
cGxhbmVfY29uZmlnLT5yb3RhdGlvbiB8PSBEUk1fTU9ERV9SRUZMRUNUX1g7Cj4gICAKPiBAQCAt
ODQ4NSwxMCArODQ4NSwxMCBAQCBpOXh4X2dldF9pbml0aWFsX3BsYW5lX2NvbmZpZyhzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YywKPiAgIAlmb3VyY2MgPSBpOXh4X2Zvcm1hdF90b19mb3VyY2MocGl4
ZWxfZm9ybWF0KTsKPiAgIAlmYi0+Zm9ybWF0ID0gZHJtX2Zvcm1hdF9pbmZvKGZvdXJjYyk7Cj4g
ICAKPiAtCWlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8fCBJU19CUk9BRFdFTEwoZGV2X3ByaXYp
KSB7Cj4gKwlpZiAoSVNfSEFTV0VMTChpOTE1KSB8fCBJU19CUk9BRFdFTEwoaTkxNSkpIHsKPiAg
IAkJb2Zmc2V0ID0gSTkxNV9SRUFEKERTUE9GRlNFVChpOXh4X3BsYW5lKSk7Cj4gICAJCWJhc2Ug
PSBJOTE1X1JFQUQoRFNQU1VSRihpOXh4X3BsYW5lKSkgJiAweGZmZmZmMDAwOwo+IC0JfSBlbHNl
IGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDQpIHsKPiArCX0gZWxzZSBpZiAoSU5URUxfR0VO
KGk5MTUpID49IDQpIHsKPiAgIAkJaWYgKHBsYW5lX2NvbmZpZy0+dGlsaW5nKQo+ICAgCQkJb2Zm
c2V0ID0gSTkxNV9SRUFEKERTUFRJTEVPRkYoaTl4eF9wbGFuZSkpOwo+ICAgCQllbHNlCj4gQEAg
LTg1MjIsNyArODUyMiw3IEBAIHN0YXRpYyB2b2lkIGNodl9jcnRjX2Nsb2NrX2dldChzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YywKPiAgIAkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
cGlwZV9jb25maWcpCj4gICB7Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmJh
c2UuZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShk
ZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4g
ICAJaW50IHBpcGUgPSBwaXBlX2NvbmZpZy0+Y3B1X3RyYW5zY29kZXI7Cj4gICAJZW51bSBkcGlv
X2NoYW5uZWwgcG9ydCA9IHZsdl9waXBlX3RvX2NoYW5uZWwocGlwZSk7Cj4gICAJc3RydWN0IGRw
bGwgY2xvY2s7Cj4gQEAgLTg1MzMsMTMgKzg1MzMsMTMgQEAgc3RhdGljIHZvaWQgY2h2X2NydGNf
Y2xvY2tfZ2V0KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCWlmICgocGlwZV9jb25maWct
PmRwbGxfaHdfc3RhdGUuZHBsbCAmIERQTExfVkNPX0VOQUJMRSkgPT0gMCkKPiAgIAkJcmV0dXJu
Owo+ICAgCj4gLQl2bHZfZHBpb19nZXQoZGV2X3ByaXYpOwo+IC0JY21uX2R3MTMgPSB2bHZfZHBp
b19yZWFkKGRldl9wcml2LCBwaXBlLCBDSFZfQ01OX0RXMTMocG9ydCkpOwo+IC0JcGxsX2R3MCA9
IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIENIVl9QTExfRFcwKHBvcnQpKTsKPiAtCXBs
bF9kdzEgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBDSFZfUExMX0RXMShwb3J0KSk7
Cj4gLQlwbGxfZHcyID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgQ0hWX1BMTF9EVzIo
cG9ydCkpOwo+IC0JcGxsX2R3MyA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIENIVl9Q
TExfRFczKHBvcnQpKTsKPiAtCXZsdl9kcGlvX3B1dChkZXZfcHJpdik7Cj4gKwl2bHZfZHBpb19n
ZXQoaTkxNSk7Cj4gKwljbW5fZHcxMyA9IHZsdl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwgQ0hWX0NN
Tl9EVzEzKHBvcnQpKTsKPiArCXBsbF9kdzAgPSB2bHZfZHBpb19yZWFkKGk5MTUsIHBpcGUsIENI
Vl9QTExfRFcwKHBvcnQpKTsKPiArCXBsbF9kdzEgPSB2bHZfZHBpb19yZWFkKGk5MTUsIHBpcGUs
IENIVl9QTExfRFcxKHBvcnQpKTsKPiArCXBsbF9kdzIgPSB2bHZfZHBpb19yZWFkKGk5MTUsIHBp
cGUsIENIVl9QTExfRFcyKHBvcnQpKTsKPiArCXBsbF9kdzMgPSB2bHZfZHBpb19yZWFkKGk5MTUs
IHBpcGUsIENIVl9QTExfRFczKHBvcnQpKTsKPiArCXZsdl9kcGlvX3B1dChpOTE1KTsKPiAgIAo+
ICAgCWNsb2NrLm0xID0gKHBsbF9kdzEgJiAweDcpID09IERQSU9fQ0hWX00xX0RJVl9CWV8yID8g
MiA6IDA7Cj4gICAJY2xvY2subTIgPSAocGxsX2R3MCAmIDB4ZmYpIDw8IDIyOwo+IEBAIC04NTU1
LDEyICs4NTU1LDEyIEBAIHN0YXRpYyB2b2lkIGNodl9jcnRjX2Nsb2NrX2dldChzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YywKPiAgIHN0YXRpYyB2b2lkIGludGVsX2dldF9jcnRjX3ljYmNyX2NvbmZp
ZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAkJCQkJc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKnBpcGVfY29uZmlnKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAgCWVudW0gaW50ZWxfb3V0cHV0
X2Zvcm1hdCBvdXRwdXQgPSBJTlRFTF9PVVRQVVRfRk9STUFUX1JHQjsKPiAgIAo+ICAgCXBpcGVf
Y29uZmlnLT5sc3Bjb25fZG93bnNhbXBsaW5nID0gZmFsc2U7Cj4gICAKPiAtCWlmIChJU19CUk9B
RFdFTEwoZGV2X3ByaXYpIHx8IElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkgewo+ICsJaWYgKElT
X0JST0FEV0VMTChpOTE1KSB8fCBJTlRFTF9HRU4oaTkxNSkgPj0gOSkgewo+ICAgCQl1MzIgdG1w
ID0gSTkxNV9SRUFEKFBJUEVNSVNDKGNydGMtPnBpcGUpKTsKPiAgIAo+ICAgCQlpZiAodG1wICYg
UElQRU1JU0NfT1VUUFVUX0NPTE9SU1BBQ0VfWVVWKSB7Cj4gQEAgLTg1NzEsOCArODU3MSw4IEBA
IHN0YXRpYyB2b2lkIGludGVsX2dldF9jcnRjX3ljYmNyX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YywKPiAgIAkJCQkvKiBXZSBzdXBwb3J0IDQ6MjowIGluIGZ1bGwgYmxlbmQgbW9kZSBv
bmx5ICovCj4gICAJCQkJaWYgKCFibGVuZCkKPiAgIAkJCQkJb3V0cHV0ID0gSU5URUxfT1VUUFVU
X0ZPUk1BVF9JTlZBTElEOwo+IC0JCQkJZWxzZSBpZiAoIShJU19HRU1JTklMQUtFKGRldl9wcml2
KSB8fAo+IC0JCQkJCSAgIElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTApKQo+ICsJCQkJZWxzZSBp
ZiAoIShJU19HRU1JTklMQUtFKGk5MTUpIHx8Cj4gKwkJCQkJICAgSU5URUxfR0VOKGk5MTUpID49
IDEwKSkKPiAgIAkJCQkJb3V0cHV0ID0gSU5URUxfT1VUUFVUX0ZPUk1BVF9JTlZBTElEOwo+ICAg
CQkJCWVsc2UKPiAgIAkJCQkJb3V0cHV0ID0gSU5URUxfT1VUUFVUX0ZPUk1BVF9ZQ0JDUjQyMDsK
PiBAQCAtODU5OSw3ICs4NTk5LDcgQEAgc3RhdGljIHZvaWQgaTl4eF9nZXRfcGlwZV9jb2xvcl9j
b25maWcoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gICAJc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0
Yyk7Cj4gICAJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSA9IHRvX2ludGVsX3BsYW5lKGNydGMt
PmJhc2UucHJpbWFyeSk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gICAJZW51bSBpOXh4X3BsYW5lX2lkIGk5eHhf
cGxhbmUgPSBwbGFuZS0+aTl4eF9wbGFuZTsKPiAgIAl1MzIgdG1wOwo+ICAgCj4gQEAgLTg2MDgs
NyArODYwOCw3IEBAIHN0YXRpYyB2b2lkIGk5eHhfZ2V0X3BpcGVfY29sb3JfY29uZmlnKHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgCWlmICh0bXAgJiBESVNQUExBTkVf
R0FNTUFfRU5BQkxFKQo+ICAgCQljcnRjX3N0YXRlLT5nYW1tYV9lbmFibGUgPSB0cnVlOwo+ICAg
Cj4gLQlpZiAoIUhBU19HTUNIKGRldl9wcml2KSAmJgo+ICsJaWYgKCFIQVNfR01DSChpOTE1KSAm
Jgo+ICAgCSAgICB0bXAgJiBESVNQUExBTkVfUElQRV9DU0NfRU5BQkxFKQo+ICAgCQljcnRjX3N0
YXRlLT5jc2NfZW5hYmxlID0gdHJ1ZTsKPiAgIH0KPiBAQCAtODYxNiwxNCArODYxNiwxNCBAQCBz
dGF0aWMgdm9pZCBpOXh4X2dldF9waXBlX2NvbG9yX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHN0YXRpYyBib29sIGk5eHhfZ2V0X3BpcGVfY29uZmlnKHN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCQkJCSBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
cGlwZV9jb25maWcpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gICAJZW51bSBpbnRlbF9kaXNwbGF5X3Bv
d2VyX2RvbWFpbiBwb3dlcl9kb21haW47Cj4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4g
ICAJdTMyIHRtcDsKPiAgIAlib29sIHJldDsKPiAgIAo+ICAgCXBvd2VyX2RvbWFpbiA9IFBPV0VS
X0RPTUFJTl9QSVBFKGNydGMtPnBpcGUpOwo+IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93
ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2X3ByaXYsIHBvd2VyX2RvbWFpbik7Cj4gKwl3YWtlcmVmID0g
aW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChpOTE1LCBwb3dlcl9kb21haW4pOwo+
ICAgCWlmICghd2FrZXJlZikKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAgCj4gQEAgLTg2MzcsOCAr
ODYzNyw4IEBAIHN0YXRpYyBib29sIGk5eHhfZ2V0X3BpcGVfY29uZmlnKHN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjLAo+ICAgCWlmICghKHRtcCAmIFBJUEVDT05GX0VOQUJMRSkpCj4gICAJCWdvdG8g
b3V0Owo+ICAgCj4gLQlpZiAoSVNfRzRYKGRldl9wcml2KSB8fCBJU19WQUxMRVlWSUVXKGRldl9w
cml2KSB8fAo+IC0JICAgIElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfRzRY
KGk5MTUpIHx8IElTX1ZBTExFWVZJRVcoaTkxNSkgfHwKPiArCSAgICBJU19DSEVSUllWSUVXKGk5
MTUpKSB7Cj4gICAJCXN3aXRjaCAodG1wICYgUElQRUNPTkZfQlBDX01BU0spIHsKPiAgIAkJY2Fz
ZSBQSVBFQ09ORl82QlBDOgo+ICAgCQkJcGlwZV9jb25maWctPnBpcGVfYnBwID0gMTg7Cj4gQEAg
LTg2NTQsMjAgKzg2NTQsMjAgQEAgc3RhdGljIGJvb2wgaTl4eF9nZXRfcGlwZV9jb25maWcoc3Ry
dWN0IGludGVsX2NydGMgKmNydGMsCj4gICAJCX0KPiAgIAl9Cj4gICAKPiAtCWlmICgoSVNfVkFM
TEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpICYmCj4gKwlpZiAo
KElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkgJiYKPiAgIAkgICAg
KHRtcCAmIFBJUEVDT05GX0NPTE9SX1JBTkdFX1NFTEVDVCkpCj4gICAJCXBpcGVfY29uZmlnLT5s
aW1pdGVkX2NvbG9yX3JhbmdlID0gdHJ1ZTsKPiAgIAo+ICAgCXBpcGVfY29uZmlnLT5nYW1tYV9t
b2RlID0gKHRtcCAmIFBJUEVDT05GX0dBTU1BX01PREVfTUFTS19JOVhYKSA+Pgo+ICAgCQlQSVBF
Q09ORl9HQU1NQV9NT0RFX1NISUZUOwo+ICAgCj4gLQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJp
dikpCj4gKwlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiAgIAkJcGlwZV9jb25maWctPmNnbV9t
b2RlID0gSTkxNV9SRUFEKENHTV9QSVBFX01PREUoY3J0Yy0+cGlwZSkpOwo+ICAgCj4gICAJaTl4
eF9nZXRfcGlwZV9jb2xvcl9jb25maWcocGlwZV9jb25maWcpOwo+ICAgCWludGVsX2NvbG9yX2dl
dF9jb25maWcocGlwZV9jb25maWcpOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8
IDQpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgNCkKPiAgIAkJcGlwZV9jb25maWctPmRvdWJs
ZV93aWRlID0gdG1wICYgUElQRUNPTkZfRE9VQkxFX1dJREU7Cj4gICAKPiAgIAlpbnRlbF9nZXRf
cGlwZV90aW1pbmdzKGNydGMsIHBpcGVfY29uZmlnKTsKPiBAQCAtODY3NSwxOCArODY3NSwxOCBA
QCBzdGF0aWMgYm9vbCBpOXh4X2dldF9waXBlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YywKPiAgIAo+ICAgCWk5eHhfZ2V0X3BmaXRfY29uZmlnKGNydGMsIHBpcGVfY29uZmlnKTsKPiAg
IAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCkgewo+ICsJaWYgKElOVEVMX0dFTihp
OTE1KSA+PSA0KSB7Cj4gICAJCS8qIE5vIHdheSB0byByZWFkIGl0IG91dCBvbiBwaXBlcyBCIGFu
ZCBDICovCj4gLQkJaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpICYmIGNydGMtPnBpcGUgIT0g
UElQRV9BKQo+IC0JCQl0bXAgPSBkZXZfcHJpdi0+Y2h2X2RwbGxfbWRbY3J0Yy0+cGlwZV07Cj4g
KwkJaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkgJiYgY3J0Yy0+cGlwZSAhPSBQSVBFX0EpCj4gKwkJ
CXRtcCA9IGk5MTUtPmNodl9kcGxsX21kW2NydGMtPnBpcGVdOwo+ICAgCQllbHNlCj4gICAJCQl0
bXAgPSBJOTE1X1JFQUQoRFBMTF9NRChjcnRjLT5waXBlKSk7Cj4gICAJCXBpcGVfY29uZmlnLT5w
aXhlbF9tdWx0aXBsaWVyID0KPiAgIAkJCSgodG1wICYgRFBMTF9NRF9VRElfTVVMVElQTElFUl9N
QVNLKQo+ICAgCQkJID4+IERQTExfTURfVURJX01VTFRJUExJRVJfU0hJRlQpICsgMTsKPiAgIAkJ
cGlwZV9jb25maWctPmRwbGxfaHdfc3RhdGUuZHBsbF9tZCA9IHRtcDsKPiAtCX0gZWxzZSBpZiAo
SVNfSTk0NUcoZGV2X3ByaXYpIHx8IElTX0k5NDVHTShkZXZfcHJpdikgfHwKPiAtCQkgICBJU19H
MzMoZGV2X3ByaXYpIHx8IElTX1BJTkVWSUVXKGRldl9wcml2KSkgewo+ICsJfSBlbHNlIGlmIChJ
U19JOTQ1RyhpOTE1KSB8fCBJU19JOTQ1R00oaTkxNSkgfHwKPiArCQkgICBJU19HMzMoaTkxNSkg
fHwgSVNfUElORVZJRVcoaTkxNSkpIHsKPiAgIAkJdG1wID0gSTkxNV9SRUFEKERQTEwoY3J0Yy0+
cGlwZSkpOwo+ICAgCQlwaXBlX2NvbmZpZy0+cGl4ZWxfbXVsdGlwbGllciA9Cj4gICAJCQkoKHRt
cCAmIFNEVk9fTVVMVElQTElFUl9NQVNLKQo+IEBAIC04Njk4LDcgKzg2OTgsNyBAQCBzdGF0aWMg
Ym9vbCBpOXh4X2dldF9waXBlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAkJ
cGlwZV9jb25maWctPnBpeGVsX211bHRpcGxpZXIgPSAxOwo+ICAgCX0KPiAgIAlwaXBlX2NvbmZp
Zy0+ZHBsbF9od19zdGF0ZS5kcGxsID0gSTkxNV9SRUFEKERQTEwoY3J0Yy0+cGlwZSkpOwo+IC0J
aWYgKCFJU19WQUxMRVlWSUVXKGRldl9wcml2KSAmJiAhSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikp
IHsKPiArCWlmICghSVNfVkFMTEVZVklFVyhpOTE1KSAmJiAhSVNfQ0hFUlJZVklFVyhpOTE1KSkg
ewo+ICAgCQlwaXBlX2NvbmZpZy0+ZHBsbF9od19zdGF0ZS5mcDAgPSBJOTE1X1JFQUQoRlAwKGNy
dGMtPnBpcGUpKTsKPiAgIAkJcGlwZV9jb25maWctPmRwbGxfaHdfc3RhdGUuZnAxID0gSTkxNV9S
RUFEKEZQMShjcnRjLT5waXBlKSk7Cj4gICAJfSBlbHNlIHsKPiBAQCAtODcwOCw5ICs4NzA4LDkg
QEAgc3RhdGljIGJvb2wgaTl4eF9nZXRfcGlwZV9jb25maWcoc3RydWN0IGludGVsX2NydGMgKmNy
dGMsCj4gICAJCQkJCQkgICAgIERQTExfUE9SVEJfUkVBRFlfTUFTSyk7Cj4gICAJfQo+ICAgCj4g
LQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gKwlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1
KSkKPiAgIAkJY2h2X2NydGNfY2xvY2tfZ2V0KGNydGMsIHBpcGVfY29uZmlnKTsKPiAtCWVsc2Ug
aWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhp
OTE1KSkKPiAgIAkJdmx2X2NydGNfY2xvY2tfZ2V0KGNydGMsIHBpcGVfY29uZmlnKTsKPiAgIAll
bHNlCj4gICAJCWk5eHhfY3J0Y19jbG9ja19nZXQoY3J0YywgcGlwZV9jb25maWcpOwo+IEBAIC04
NzI2LDEyICs4NzI2LDEyIEBAIHN0YXRpYyBib29sIGk5eHhfZ2V0X3BpcGVfY29uZmlnKHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCXJldCA9IHRydWU7Cj4gICAKPiAgIG91dDoKPiAtCWlu
dGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBwb3dlcl9kb21haW4sIHdha2VyZWYpOwo+
ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgcG93ZXJfZG9tYWluLCB3YWtlcmVmKTsK
PiAgIAo+ICAgCXJldHVybiByZXQ7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaXJvbmxha2Vf
aW5pdF9wY2hfcmVmY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3Rh
dGljIHZvaWQgaXJvbmxha2VfaW5pdF9wY2hfcmVmY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyOwo+ICAgCWlu
dCBpOwo+IEBAIC04NzQ0LDcgKzg3NDQsNyBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9pbml0X3Bj
aF9yZWZjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCWJvb2wgdXNp
bmdfc3NjX3NvdXJjZSA9IGZhbHNlOwo+ICAgCj4gICAJLyogV2UgbmVlZCB0byB0YWtlIHRoZSBn
bG9iYWwgY29uZmlnIGludG8gYWNjb3VudCAqLwo+IC0JZm9yX2VhY2hfaW50ZWxfZW5jb2Rlcigm
ZGV2X3ByaXYtPmRybSwgZW5jb2Rlcikgewo+ICsJZm9yX2VhY2hfaW50ZWxfZW5jb2RlcigmaTkx
NS0+ZHJtLCBlbmNvZGVyKSB7Cj4gICAJCXN3aXRjaCAoZW5jb2Rlci0+dHlwZSkgewo+ICAgCQlj
YXNlIElOVEVMX09VVFBVVF9MVkRTOgo+ICAgCQkJaGFzX3BhbmVsID0gdHJ1ZTsKPiBAQCAtODc2
MCw4ICs4NzYwLDggQEAgc3RhdGljIHZvaWQgaXJvbmxha2VfaW5pdF9wY2hfcmVmY2xrKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkJfQo+ICAgCX0KPiAgIAo+IC0JaWYg
KEhBU19QQ0hfSUJYKGRldl9wcml2KSkgewo+IC0JCWhhc19jazUwNSA9IGRldl9wcml2LT52YnQu
ZGlzcGxheV9jbG9ja19tb2RlOwo+ICsJaWYgKEhBU19QQ0hfSUJYKGk5MTUpKSB7Cj4gKwkJaGFz
X2NrNTA1ID0gaTkxNS0+dmJ0LmRpc3BsYXlfY2xvY2tfbW9kZTsKPiAgIAkJY2FuX3NzYyA9IGhh
c19jazUwNTsKPiAgIAl9IGVsc2Ugewo+ICAgCQloYXNfY2s1MDUgPSBmYWxzZTsKPiBAQCAtODc2
OSw3ICs4NzY5LDcgQEAgc3RhdGljIHZvaWQgaXJvbmxha2VfaW5pdF9wY2hfcmVmY2xrKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAl9Cj4gICAKPiAgIAkvKiBDaGVjayBp
ZiBhbnkgRFBMTHMgYXJlIHVzaW5nIHRoZSBTU0Mgc291cmNlICovCj4gLQlmb3IgKGkgPSAwOyBp
IDwgZGV2X3ByaXYtPm51bV9zaGFyZWRfZHBsbDsgaSsrKSB7Cj4gKwlmb3IgKGkgPSAwOyBpIDwg
aTkxNS0+bnVtX3NoYXJlZF9kcGxsOyBpKyspIHsKPiAgIAkJdTMyIHRlbXAgPSBJOTE1X1JFQUQo
UENIX0RQTEwoaSkpOwo+ICAgCj4gICAJCWlmICghKHRlbXAgJiBEUExMX1ZDT19FTkFCTEUpKQo+
IEBAIC04ODEwLDExICs4ODEwLDExIEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX2luaXRfcGNoX3Jl
ZmNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJaWYgKGhhc19wYW5l
bCkgewo+ICAgCQlmaW5hbCB8PSBEUkVGX1NTQ19TT1VSQ0VfRU5BQkxFOwo+ICAgCj4gLQkJaWYg
KGludGVsX3BhbmVsX3VzZV9zc2MoZGV2X3ByaXYpICYmIGNhbl9zc2MpCj4gKwkJaWYgKGludGVs
X3BhbmVsX3VzZV9zc2MoaTkxNSkgJiYgY2FuX3NzYykKPiAgIAkJCWZpbmFsIHw9IERSRUZfU1ND
MV9FTkFCTEU7Cj4gICAKPiAgIAkJaWYgKGhhc19jcHVfZWRwKSB7Cj4gLQkJCWlmIChpbnRlbF9w
YW5lbF91c2Vfc3NjKGRldl9wcml2KSAmJiBjYW5fc3NjKQo+ICsJCQlpZiAoaW50ZWxfcGFuZWxf
dXNlX3NzYyhpOTE1KSAmJiBjYW5fc3NjKQo+ICAgCQkJCWZpbmFsIHw9IERSRUZfQ1BVX1NPVVJD
RV9PVVRQVVRfRE9XTlNQUkVBRDsKPiAgIAkJCWVsc2UKPiAgIAkJCQlmaW5hbCB8PSBEUkVGX0NQ
VV9TT1VSQ0VfT1VUUFVUX05PTlNQUkVBRDsKPiBAQCAtODg0MSw3ICs4ODQxLDcgQEAgc3RhdGlj
IHZvaWQgaXJvbmxha2VfaW5pdF9wY2hfcmVmY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiAgIAkJdmFsIHw9IERSRUZfU1NDX1NPVVJDRV9FTkFCTEU7Cj4gICAKPiAgIAkJ
LyogU1NDIG11c3QgYmUgdHVybmVkIG9uIGJlZm9yZSBlbmFibGluZyB0aGUgQ1BVIG91dHB1dCAg
Ki8KPiAtCQlpZiAoaW50ZWxfcGFuZWxfdXNlX3NzYyhkZXZfcHJpdikgJiYgY2FuX3NzYykgewo+
ICsJCWlmIChpbnRlbF9wYW5lbF91c2Vfc3NjKGk5MTUpICYmIGNhbl9zc2MpIHsKPiAgIAkJCURS
TV9ERUJVR19LTVMoIlVzaW5nIFNTQyBvbiBwYW5lbFxuIik7Cj4gICAJCQl2YWwgfD0gRFJFRl9T
U0MxX0VOQUJMRTsKPiAgIAkJfSBlbHNlCj4gQEAgLTg4NTYsNyArODg1Niw3IEBAIHN0YXRpYyB2
b2lkIGlyb25sYWtlX2luaXRfcGNoX3JlZmNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gICAKPiAgIAkJLyogRW5hYmxlIENQVSBzb3VyY2Ugb24gQ1BVIGF0dGFjaGVkIGVE
UCAqLwo+ICAgCQlpZiAoaGFzX2NwdV9lZHApIHsKPiAtCQkJaWYgKGludGVsX3BhbmVsX3VzZV9z
c2MoZGV2X3ByaXYpICYmIGNhbl9zc2MpIHsKPiArCQkJaWYgKGludGVsX3BhbmVsX3VzZV9zc2Mo
aTkxNSkgJiYgY2FuX3NzYykgewo+ICAgCQkJCURSTV9ERUJVR19LTVMoIlVzaW5nIFNTQyBvbiBl
RFBcbiIpOwo+ICAgCQkJCXZhbCB8PSBEUkVGX0NQVV9TT1VSQ0VfT1VUUFVUX0RPV05TUFJFQUQ7
Cj4gICAJCQl9IGVsc2UKPiBAQCAtODg5OCw3ICs4ODk4LDcgQEAgc3RhdGljIHZvaWQgaXJvbmxh
a2VfaW5pdF9wY2hfcmVmY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAg
IAlCVUdfT04odmFsICE9IGZpbmFsKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBscHRfcmVz
ZXRfZmRpX21waHkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMg
dm9pZCBscHRfcmVzZXRfZmRpX21waHkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
ICB7Cj4gICAJdTMyIHRtcDsKPiAgIAo+IEBAIC04OTIwLDc4ICs4OTIwLDc4IEBAIHN0YXRpYyB2
b2lkIGxwdF9yZXNldF9mZGlfbXBoeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gICB9Cj4gICAKPiAgIC8qIFdhTVBoeVByb2dyYW1taW5nOmhzdyAqLwo+IC1zdGF0aWMgdm9p
ZCBscHRfcHJvZ3JhbV9mZGlfbXBoeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gK3N0YXRpYyB2b2lkIGxwdF9wcm9ncmFtX2ZkaV9tcGh5KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ICAgewo+ICAgCXUzMiB0bXA7Cj4gICAKPiAtCXRtcCA9IGludGVsX3NiaV9y
ZWFkKGRldl9wcml2LCAweDgwMDgsIFNCSV9NUEhZKTsKPiArCXRtcCA9IGludGVsX3NiaV9yZWFk
KGk5MTUsIDB4ODAwOCwgU0JJX01QSFkpOwo+ICAgCXRtcCAmPSB+KDB4RkYgPDwgMjQpOwo+ICAg
CXRtcCB8PSAoMHgxMiA8PCAyNCk7Cj4gLQlpbnRlbF9zYmlfd3JpdGUoZGV2X3ByaXYsIDB4ODAw
OCwgdG1wLCBTQklfTVBIWSk7Cj4gKwlpbnRlbF9zYmlfd3JpdGUoaTkxNSwgMHg4MDA4LCB0bXAs
IFNCSV9NUEhZKTsKPiAgIAo+IC0JdG1wID0gaW50ZWxfc2JpX3JlYWQoZGV2X3ByaXYsIDB4MjAw
OCwgU0JJX01QSFkpOwo+ICsJdG1wID0gaW50ZWxfc2JpX3JlYWQoaTkxNSwgMHgyMDA4LCBTQklf
TVBIWSk7Cj4gICAJdG1wIHw9ICgxIDw8IDExKTsKPiAtCWludGVsX3NiaV93cml0ZShkZXZfcHJp
diwgMHgyMDA4LCB0bXAsIFNCSV9NUEhZKTsKPiArCWludGVsX3NiaV93cml0ZShpOTE1LCAweDIw
MDgsIHRtcCwgU0JJX01QSFkpOwo+ICAgCj4gLQl0bXAgPSBpbnRlbF9zYmlfcmVhZChkZXZfcHJp
diwgMHgyMTA4LCBTQklfTVBIWSk7Cj4gKwl0bXAgPSBpbnRlbF9zYmlfcmVhZChpOTE1LCAweDIx
MDgsIFNCSV9NUEhZKTsKPiAgIAl0bXAgfD0gKDEgPDwgMTEpOwo+IC0JaW50ZWxfc2JpX3dyaXRl
KGRldl9wcml2LCAweDIxMDgsIHRtcCwgU0JJX01QSFkpOwo+ICsJaW50ZWxfc2JpX3dyaXRlKGk5
MTUsIDB4MjEwOCwgdG1wLCBTQklfTVBIWSk7Cj4gICAKPiAtCXRtcCA9IGludGVsX3NiaV9yZWFk
KGRldl9wcml2LCAweDIwNkMsIFNCSV9NUEhZKTsKPiArCXRtcCA9IGludGVsX3NiaV9yZWFkKGk5
MTUsIDB4MjA2QywgU0JJX01QSFkpOwo+ICAgCXRtcCB8PSAoMSA8PCAyNCkgfCAoMSA8PCAyMSkg
fCAoMSA8PCAxOCk7Cj4gLQlpbnRlbF9zYmlfd3JpdGUoZGV2X3ByaXYsIDB4MjA2QywgdG1wLCBT
QklfTVBIWSk7Cj4gKwlpbnRlbF9zYmlfd3JpdGUoaTkxNSwgMHgyMDZDLCB0bXAsIFNCSV9NUEhZ
KTsKPiAgIAo+IC0JdG1wID0gaW50ZWxfc2JpX3JlYWQoZGV2X3ByaXYsIDB4MjE2QywgU0JJX01Q
SFkpOwo+ICsJdG1wID0gaW50ZWxfc2JpX3JlYWQoaTkxNSwgMHgyMTZDLCBTQklfTVBIWSk7Cj4g
ICAJdG1wIHw9ICgxIDw8IDI0KSB8ICgxIDw8IDIxKSB8ICgxIDw8IDE4KTsKPiAtCWludGVsX3Ni
aV93cml0ZShkZXZfcHJpdiwgMHgyMTZDLCB0bXAsIFNCSV9NUEhZKTsKPiArCWludGVsX3NiaV93
cml0ZShpOTE1LCAweDIxNkMsIHRtcCwgU0JJX01QSFkpOwo+ICAgCj4gLQl0bXAgPSBpbnRlbF9z
YmlfcmVhZChkZXZfcHJpdiwgMHgyMDgwLCBTQklfTVBIWSk7Cj4gKwl0bXAgPSBpbnRlbF9zYmlf
cmVhZChpOTE1LCAweDIwODAsIFNCSV9NUEhZKTsKPiAgIAl0bXAgJj0gfig3IDw8IDEzKTsKPiAg
IAl0bXAgfD0gKDUgPDwgMTMpOwo+IC0JaW50ZWxfc2JpX3dyaXRlKGRldl9wcml2LCAweDIwODAs
IHRtcCwgU0JJX01QSFkpOwo+ICsJaW50ZWxfc2JpX3dyaXRlKGk5MTUsIDB4MjA4MCwgdG1wLCBT
QklfTVBIWSk7Cj4gICAKPiAtCXRtcCA9IGludGVsX3NiaV9yZWFkKGRldl9wcml2LCAweDIxODAs
IFNCSV9NUEhZKTsKPiArCXRtcCA9IGludGVsX3NiaV9yZWFkKGk5MTUsIDB4MjE4MCwgU0JJX01Q
SFkpOwo+ICAgCXRtcCAmPSB+KDcgPDwgMTMpOwo+ICAgCXRtcCB8PSAoNSA8PCAxMyk7Cj4gLQlp
bnRlbF9zYmlfd3JpdGUoZGV2X3ByaXYsIDB4MjE4MCwgdG1wLCBTQklfTVBIWSk7Cj4gKwlpbnRl
bF9zYmlfd3JpdGUoaTkxNSwgMHgyMTgwLCB0bXAsIFNCSV9NUEhZKTsKPiAgIAo+IC0JdG1wID0g
aW50ZWxfc2JpX3JlYWQoZGV2X3ByaXYsIDB4MjA4QywgU0JJX01QSFkpOwo+ICsJdG1wID0gaW50
ZWxfc2JpX3JlYWQoaTkxNSwgMHgyMDhDLCBTQklfTVBIWSk7Cj4gICAJdG1wICY9IH4weEZGOwo+
ICAgCXRtcCB8PSAweDFDOwo+IC0JaW50ZWxfc2JpX3dyaXRlKGRldl9wcml2LCAweDIwOEMsIHRt
cCwgU0JJX01QSFkpOwo+ICsJaW50ZWxfc2JpX3dyaXRlKGk5MTUsIDB4MjA4QywgdG1wLCBTQklf
TVBIWSk7Cj4gICAKPiAtCXRtcCA9IGludGVsX3NiaV9yZWFkKGRldl9wcml2LCAweDIxOEMsIFNC
SV9NUEhZKTsKPiArCXRtcCA9IGludGVsX3NiaV9yZWFkKGk5MTUsIDB4MjE4QywgU0JJX01QSFkp
Owo+ICAgCXRtcCAmPSB+MHhGRjsKPiAgIAl0bXAgfD0gMHgxQzsKPiAtCWludGVsX3NiaV93cml0
ZShkZXZfcHJpdiwgMHgyMThDLCB0bXAsIFNCSV9NUEhZKTsKPiArCWludGVsX3NiaV93cml0ZShp
OTE1LCAweDIxOEMsIHRtcCwgU0JJX01QSFkpOwo+ICAgCj4gLQl0bXAgPSBpbnRlbF9zYmlfcmVh
ZChkZXZfcHJpdiwgMHgyMDk4LCBTQklfTVBIWSk7Cj4gKwl0bXAgPSBpbnRlbF9zYmlfcmVhZChp
OTE1LCAweDIwOTgsIFNCSV9NUEhZKTsKPiAgIAl0bXAgJj0gfigweEZGIDw8IDE2KTsKPiAgIAl0
bXAgfD0gKDB4MUMgPDwgMTYpOwo+IC0JaW50ZWxfc2JpX3dyaXRlKGRldl9wcml2LCAweDIwOTgs
IHRtcCwgU0JJX01QSFkpOwo+ICsJaW50ZWxfc2JpX3dyaXRlKGk5MTUsIDB4MjA5OCwgdG1wLCBT
QklfTVBIWSk7Cj4gICAKPiAtCXRtcCA9IGludGVsX3NiaV9yZWFkKGRldl9wcml2LCAweDIxOTgs
IFNCSV9NUEhZKTsKPiArCXRtcCA9IGludGVsX3NiaV9yZWFkKGk5MTUsIDB4MjE5OCwgU0JJX01Q
SFkpOwo+ICAgCXRtcCAmPSB+KDB4RkYgPDwgMTYpOwo+ICAgCXRtcCB8PSAoMHgxQyA8PCAxNik7
Cj4gLQlpbnRlbF9zYmlfd3JpdGUoZGV2X3ByaXYsIDB4MjE5OCwgdG1wLCBTQklfTVBIWSk7Cj4g
KwlpbnRlbF9zYmlfd3JpdGUoaTkxNSwgMHgyMTk4LCB0bXAsIFNCSV9NUEhZKTsKPiAgIAo+IC0J
dG1wID0gaW50ZWxfc2JpX3JlYWQoZGV2X3ByaXYsIDB4MjBDNCwgU0JJX01QSFkpOwo+ICsJdG1w
ID0gaW50ZWxfc2JpX3JlYWQoaTkxNSwgMHgyMEM0LCBTQklfTVBIWSk7Cj4gICAJdG1wIHw9ICgx
IDw8IDI3KTsKPiAtCWludGVsX3NiaV93cml0ZShkZXZfcHJpdiwgMHgyMEM0LCB0bXAsIFNCSV9N
UEhZKTsKPiArCWludGVsX3NiaV93cml0ZShpOTE1LCAweDIwQzQsIHRtcCwgU0JJX01QSFkpOwo+
ICAgCj4gLQl0bXAgPSBpbnRlbF9zYmlfcmVhZChkZXZfcHJpdiwgMHgyMUM0LCBTQklfTVBIWSk7
Cj4gKwl0bXAgPSBpbnRlbF9zYmlfcmVhZChpOTE1LCAweDIxQzQsIFNCSV9NUEhZKTsKPiAgIAl0
bXAgfD0gKDEgPDwgMjcpOwo+IC0JaW50ZWxfc2JpX3dyaXRlKGRldl9wcml2LCAweDIxQzQsIHRt
cCwgU0JJX01QSFkpOwo+ICsJaW50ZWxfc2JpX3dyaXRlKGk5MTUsIDB4MjFDNCwgdG1wLCBTQklf
TVBIWSk7Cj4gICAKPiAtCXRtcCA9IGludGVsX3NiaV9yZWFkKGRldl9wcml2LCAweDIwRUMsIFNC
SV9NUEhZKTsKPiArCXRtcCA9IGludGVsX3NiaV9yZWFkKGk5MTUsIDB4MjBFQywgU0JJX01QSFkp
Owo+ICAgCXRtcCAmPSB+KDB4RiA8PCAyOCk7Cj4gICAJdG1wIHw9ICg0IDw8IDI4KTsKPiAtCWlu
dGVsX3NiaV93cml0ZShkZXZfcHJpdiwgMHgyMEVDLCB0bXAsIFNCSV9NUEhZKTsKPiArCWludGVs
X3NiaV93cml0ZShpOTE1LCAweDIwRUMsIHRtcCwgU0JJX01QSFkpOwo+ICAgCj4gLQl0bXAgPSBp
bnRlbF9zYmlfcmVhZChkZXZfcHJpdiwgMHgyMUVDLCBTQklfTVBIWSk7Cj4gKwl0bXAgPSBpbnRl
bF9zYmlfcmVhZChpOTE1LCAweDIxRUMsIFNCSV9NUEhZKTsKPiAgIAl0bXAgJj0gfigweEYgPDwg
MjgpOwo+ICAgCXRtcCB8PSAoNCA8PCAyOCk7Cj4gLQlpbnRlbF9zYmlfd3JpdGUoZGV2X3ByaXYs
IDB4MjFFQywgdG1wLCBTQklfTVBIWSk7Cj4gKwlpbnRlbF9zYmlfd3JpdGUoaTkxNSwgMHgyMUVD
LCB0bXAsIFNCSV9NUEhZKTsKPiAgIH0KPiAgIAo+ICAgLyogSW1wbGVtZW50cyAzIGRpZmZlcmVu
dCBzZXF1ZW5jZXMgZnJvbSBCU3BlYyBjaGFwdGVyICJEaXNwbGF5IGlDTEsKPiBAQCAtOTAwMCw2
OSArOTAwMCw2OSBAQCBzdGF0aWMgdm9pZCBscHRfcHJvZ3JhbV9mZGlfbXBoeShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAgKiAtIFNlcXVlbmNlIHRvIGVuYWJsZSBDTEtP
VVRfRFAgd2l0aG91dCBzcHJlYWQKPiAgICAqIC0gU2VxdWVuY2UgdG8gZW5hYmxlIENMS09VVF9E
UCBmb3IgRkRJIHVzYWdlIGFuZCBjb25maWd1cmUgUENIIEZESSBJL08KPiAgICAqLwo+IC1zdGF0
aWMgdm9pZCBscHRfZW5hYmxlX2Nsa291dF9kcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGxwdF9lbmFibGVfY2xrb3V0X2RwKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSBib29sIHdpdGhfc3ByZWFkLCBib29sIHdpdGhfZmRp
KQo+ICAgewo+ICAgCXUzMiByZWcsIHRtcDsKPiAgIAo+ICAgCWlmIChXQVJOKHdpdGhfZmRpICYm
ICF3aXRoX3NwcmVhZCwgIkZESSByZXF1aXJlcyBkb3duc3ByZWFkXG4iKSkKPiAgIAkJd2l0aF9z
cHJlYWQgPSB0cnVlOwo+IC0JaWYgKFdBUk4oSEFTX1BDSF9MUFRfTFAoZGV2X3ByaXYpICYmCj4g
KwlpZiAoV0FSTihIQVNfUENIX0xQVF9MUChpOTE1KSAmJgo+ICAgCSAgICB3aXRoX2ZkaSwgIkxQ
IFBDSCBkb2Vzbid0IGhhdmUgRkRJXG4iKSkKPiAgIAkJd2l0aF9mZGkgPSBmYWxzZTsKPiAgIAo+
IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPnNiX2xvY2spOwo+ICsJbXV0ZXhfbG9jaygmaTkxNS0+
c2JfbG9jayk7Cj4gICAKPiAtCXRtcCA9IGludGVsX3NiaV9yZWFkKGRldl9wcml2LCBTQklfU1ND
Q1RMLCBTQklfSUNMSyk7Cj4gKwl0bXAgPSBpbnRlbF9zYmlfcmVhZChpOTE1LCBTQklfU1NDQ1RM
LCBTQklfSUNMSyk7Cj4gICAJdG1wICY9IH5TQklfU1NDQ1RMX0RJU0FCTEU7Cj4gICAJdG1wIHw9
IFNCSV9TU0NDVExfUEFUSEFMVDsKPiAtCWludGVsX3NiaV93cml0ZShkZXZfcHJpdiwgU0JJX1NT
Q0NUTCwgdG1wLCBTQklfSUNMSyk7Cj4gKwlpbnRlbF9zYmlfd3JpdGUoaTkxNSwgU0JJX1NTQ0NU
TCwgdG1wLCBTQklfSUNMSyk7Cj4gICAKPiAgIAl1ZGVsYXkoMjQpOwo+ICAgCj4gICAJaWYgKHdp
dGhfc3ByZWFkKSB7Cj4gLQkJdG1wID0gaW50ZWxfc2JpX3JlYWQoZGV2X3ByaXYsIFNCSV9TU0ND
VEwsIFNCSV9JQ0xLKTsKPiArCQl0bXAgPSBpbnRlbF9zYmlfcmVhZChpOTE1LCBTQklfU1NDQ1RM
LCBTQklfSUNMSyk7Cj4gICAJCXRtcCAmPSB+U0JJX1NTQ0NUTF9QQVRIQUxUOwo+IC0JCWludGVs
X3NiaV93cml0ZShkZXZfcHJpdiwgU0JJX1NTQ0NUTCwgdG1wLCBTQklfSUNMSyk7Cj4gKwkJaW50
ZWxfc2JpX3dyaXRlKGk5MTUsIFNCSV9TU0NDVEwsIHRtcCwgU0JJX0lDTEspOwo+ICAgCj4gICAJ
CWlmICh3aXRoX2ZkaSkgewo+IC0JCQlscHRfcmVzZXRfZmRpX21waHkoZGV2X3ByaXYpOwo+IC0J
CQlscHRfcHJvZ3JhbV9mZGlfbXBoeShkZXZfcHJpdik7Cj4gKwkJCWxwdF9yZXNldF9mZGlfbXBo
eShpOTE1KTsKPiArCQkJbHB0X3Byb2dyYW1fZmRpX21waHkoaTkxNSk7Cj4gICAJCX0KPiAgIAl9
Cj4gICAKPiAtCXJlZyA9IEhBU19QQ0hfTFBUX0xQKGRldl9wcml2KSA/IFNCSV9HRU4wIDogU0JJ
X0RCVUZGMDsKPiAtCXRtcCA9IGludGVsX3NiaV9yZWFkKGRldl9wcml2LCByZWcsIFNCSV9JQ0xL
KTsKPiArCXJlZyA9IEhBU19QQ0hfTFBUX0xQKGk5MTUpID8gU0JJX0dFTjAgOiBTQklfREJVRkYw
Owo+ICsJdG1wID0gaW50ZWxfc2JpX3JlYWQoaTkxNSwgcmVnLCBTQklfSUNMSyk7Cj4gICAJdG1w
IHw9IFNCSV9HRU4wX0NGR19CVUZGRU5BQkxFX0RJU0FCTEU7Cj4gLQlpbnRlbF9zYmlfd3JpdGUo
ZGV2X3ByaXYsIHJlZywgdG1wLCBTQklfSUNMSyk7Cj4gKwlpbnRlbF9zYmlfd3JpdGUoaTkxNSwg
cmVnLCB0bXAsIFNCSV9JQ0xLKTsKPiAgIAo+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+c2Jf
bG9jayk7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPnNiX2xvY2spOwo+ICAgfQo+ICAgCj4gICAv
KiBTZXF1ZW5jZSB0byBkaXNhYmxlIENMS09VVF9EUCAqLwo+IC12b2lkIGxwdF9kaXNhYmxlX2Ns
a291dF9kcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgbHB0X2Rp
c2FibGVfY2xrb3V0X2RwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAg
CXUzMiByZWcsIHRtcDsKPiAgIAo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPnNiX2xvY2spOwo+
ICsJbXV0ZXhfbG9jaygmaTkxNS0+c2JfbG9jayk7Cj4gICAKPiAtCXJlZyA9IEhBU19QQ0hfTFBU
X0xQKGRldl9wcml2KSA/IFNCSV9HRU4wIDogU0JJX0RCVUZGMDsKPiAtCXRtcCA9IGludGVsX3Ni
aV9yZWFkKGRldl9wcml2LCByZWcsIFNCSV9JQ0xLKTsKPiArCXJlZyA9IEhBU19QQ0hfTFBUX0xQ
KGk5MTUpID8gU0JJX0dFTjAgOiBTQklfREJVRkYwOwo+ICsJdG1wID0gaW50ZWxfc2JpX3JlYWQo
aTkxNSwgcmVnLCBTQklfSUNMSyk7Cj4gICAJdG1wICY9IH5TQklfR0VOMF9DRkdfQlVGRkVOQUJM
RV9ESVNBQkxFOwo+IC0JaW50ZWxfc2JpX3dyaXRlKGRldl9wcml2LCByZWcsIHRtcCwgU0JJX0lD
TEspOwo+ICsJaW50ZWxfc2JpX3dyaXRlKGk5MTUsIHJlZywgdG1wLCBTQklfSUNMSyk7Cj4gICAK
PiAtCXRtcCA9IGludGVsX3NiaV9yZWFkKGRldl9wcml2LCBTQklfU1NDQ1RMLCBTQklfSUNMSyk7
Cj4gKwl0bXAgPSBpbnRlbF9zYmlfcmVhZChpOTE1LCBTQklfU1NDQ1RMLCBTQklfSUNMSyk7Cj4g
ICAJaWYgKCEodG1wICYgU0JJX1NTQ0NUTF9ESVNBQkxFKSkgewo+ICAgCQlpZiAoISh0bXAgJiBT
QklfU1NDQ1RMX1BBVEhBTFQpKSB7Cj4gICAJCQl0bXAgfD0gU0JJX1NTQ0NUTF9QQVRIQUxUOwo+
IC0JCQlpbnRlbF9zYmlfd3JpdGUoZGV2X3ByaXYsIFNCSV9TU0NDVEwsIHRtcCwgU0JJX0lDTEsp
Owo+ICsJCQlpbnRlbF9zYmlfd3JpdGUoaTkxNSwgU0JJX1NTQ0NUTCwgdG1wLCBTQklfSUNMSyk7
Cj4gICAJCQl1ZGVsYXkoMzIpOwo+ICAgCQl9Cj4gICAJCXRtcCB8PSBTQklfU1NDQ1RMX0RJU0FC
TEU7Cj4gLQkJaW50ZWxfc2JpX3dyaXRlKGRldl9wcml2LCBTQklfU1NDQ1RMLCB0bXAsIFNCSV9J
Q0xLKTsKPiArCQlpbnRlbF9zYmlfd3JpdGUoaTkxNSwgU0JJX1NTQ0NUTCwgdG1wLCBTQklfSUNM
Syk7Cj4gICAJfQo+ICAgCj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5zYl9sb2NrKTsKPiAr
CW11dGV4X3VubG9jaygmaTkxNS0+c2JfbG9jayk7Cj4gICB9Cj4gICAKPiAgICNkZWZpbmUgQkVO
RF9JRFgoc3RlcHMpICgoNTAgKyAoc3RlcHMpKSAvIDUpCj4gQEAgLTkwOTcsNyArOTA5Nyw3IEBA
IHN0YXRpYyBjb25zdCB1MTYgc3NjZGl2aW50cGhhc2VbXSA9IHsKPiAgICAqIDwgMCBzbG93IGRv
d24gdGhlIGNsb2NrLCA+IDAgc3BlZWQgdXAgdGhlIGNsb2NrLCAwID09IG5vIGJlbmQgKDEzNU1I
eikKPiAgICAqIGNoYW5nZSBpbiBjbG9jayBwZXJpb2QgPSAtKHN0ZXBzIC8gMTApICogNS43ODcg
cHMKPiAgICAqLwo+IC1zdGF0aWMgdm9pZCBscHRfYmVuZF9jbGtvdXRfZHAoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgc3RlcHMpCj4gK3N0YXRpYyB2b2lkIGxwdF9iZW5k
X2Nsa291dF9kcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50IHN0ZXBzKQo+ICAg
ewo+ICAgCXUzMiB0bXA7Cj4gICAJaW50IGlkeCA9IEJFTkRfSURYKHN0ZXBzKTsKPiBAQCAtOTEw
OCwyNSArOTEwOCwyNSBAQCBzdGF0aWMgdm9pZCBscHRfYmVuZF9jbGtvdXRfZHAoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgc3RlcHMpCj4gICAJaWYgKFdBUk5fT04oaWR4
ID49IEFSUkFZX1NJWkUoc3NjZGl2aW50cGhhc2UpKSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQlt
dXRleF9sb2NrKCZkZXZfcHJpdi0+c2JfbG9jayk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT5zYl9s
b2NrKTsKPiAgIAo+ICAgCWlmIChzdGVwcyAlIDEwICE9IDApCj4gICAJCXRtcCA9IDB4QUFBQUFB
QUI7Cj4gICAJZWxzZQo+ICAgCQl0bXAgPSAweDAwMDAwMDAwOwo+IC0JaW50ZWxfc2JpX3dyaXRl
KGRldl9wcml2LCBTQklfU1NDRElUSFBIQVNFLCB0bXAsIFNCSV9JQ0xLKTsKPiArCWludGVsX3Ni
aV93cml0ZShpOTE1LCBTQklfU1NDRElUSFBIQVNFLCB0bXAsIFNCSV9JQ0xLKTsKPiAgIAo+IC0J
dG1wID0gaW50ZWxfc2JpX3JlYWQoZGV2X3ByaXYsIFNCSV9TU0NESVZJTlRQSEFTRSwgU0JJX0lD
TEspOwo+ICsJdG1wID0gaW50ZWxfc2JpX3JlYWQoaTkxNSwgU0JJX1NTQ0RJVklOVFBIQVNFLCBT
QklfSUNMSyk7Cj4gICAJdG1wICY9IDB4ZmZmZjAwMDA7Cj4gICAJdG1wIHw9IHNzY2RpdmludHBo
YXNlW2lkeF07Cj4gLQlpbnRlbF9zYmlfd3JpdGUoZGV2X3ByaXYsIFNCSV9TU0NESVZJTlRQSEFT
RSwgdG1wLCBTQklfSUNMSyk7Cj4gKwlpbnRlbF9zYmlfd3JpdGUoaTkxNSwgU0JJX1NTQ0RJVklO
VFBIQVNFLCB0bXAsIFNCSV9JQ0xLKTsKPiAgIAo+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+
c2JfbG9jayk7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPnNiX2xvY2spOwo+ICAgfQo+ICAgCj4g
ICAjdW5kZWYgQkVORF9JRFgKPiAgIAo+IC1zdGF0aWMgYm9vbCBzcGxsX3VzZXNfcGNoX3NzYyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyBib29sIHNwbGxfdXNl
c19wY2hfc3NjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUzMiBm
dXNlX3N0cmFwID0gSTkxNV9SRUFEKEZVU0VfU1RSQVApOwo+ICAgCXUzMiBjdGwgPSBJOTE1X1JF
QUQoU1BMTF9DVEwpOwo+IEBAIC05MTM4LDE0ICs5MTM4LDE0IEBAIHN0YXRpYyBib29sIHNwbGxf
dXNlc19wY2hfc3NjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkgICAg
KGZ1c2Vfc3RyYXAgJiBIU1dfQ1BVX1NTQ19FTkFCTEUpID09IDApCj4gICAJCXJldHVybiB0cnVl
Owo+ICAgCj4gLQlpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSAmJgo+ICsJaWYgKElTX0JST0FE
V0VMTChpOTE1KSAmJgo+ICAgCSAgICAoY3RsICYgU1BMTF9SRUZfTUFTSykgPT0gU1BMTF9SRUZf
UENIX1NTQ19CRFcpCj4gICAJCXJldHVybiB0cnVlOwo+ICAgCj4gICAJcmV0dXJuIGZhbHNlOwo+
ICAgfQo+ICAgCj4gLXN0YXRpYyBib29sIHdycGxsX3VzZXNfcGNoX3NzYyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBib29sIHdycGxsX3VzZXNfcGNoX3NzYyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgICBlbnVtIGludGVsX2Rw
bGxfaWQgaWQpCj4gICB7Cj4gICAJdTMyIGZ1c2Vfc3RyYXAgPSBJOTE1X1JFQUQoRlVTRV9TVFJB
UCk7Cj4gQEAgLTkxNTcsNyArOTE1Nyw3IEBAIHN0YXRpYyBib29sIHdycGxsX3VzZXNfcGNoX3Nz
YyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJaWYgKChjdGwgJiBXUlBM
TF9SRUZfTUFTSykgPT0gV1JQTExfUkVGX1BDSF9TU0MpCj4gICAJCXJldHVybiB0cnVlOwo+ICAg
Cj4gLQlpZiAoKElTX0JST0FEV0VMTChkZXZfcHJpdikgfHwgSVNfSFNXX1VMVChkZXZfcHJpdikp
ICYmCj4gKwlpZiAoKElTX0JST0FEV0VMTChpOTE1KSB8fCBJU19IU1dfVUxUKGk5MTUpKSAmJgo+
ICAgCSAgICAoY3RsICYgV1JQTExfUkVGX01BU0spID09IFdSUExMX1JFRl9NVVhFRF9TU0NfQkRX
ICYmCj4gICAJICAgIChmdXNlX3N0cmFwICYgSFNXX0NQVV9TU0NfRU5BQkxFKSA9PSAwKQo+ICAg
CQlyZXR1cm4gdHJ1ZTsKPiBAQCAtOTE2NSwxMyArOTE2NSwxMyBAQCBzdGF0aWMgYm9vbCB3cnBs
bF91c2VzX3BjaF9zc2Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCXJl
dHVybiBmYWxzZTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBscHRfaW5pdF9wY2hfcmVmY2xr
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgbHB0X2lu
aXRfcGNoX3JlZmNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAlz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcjsKPiAgIAlib29sIHBjaF9zc2NfaW5fdXNlID0g
ZmFsc2U7Cj4gICAJYm9vbCBoYXNfZmRpID0gZmFsc2U7Cj4gICAKPiAtCWZvcl9lYWNoX2ludGVs
X2VuY29kZXIoJmRldl9wcml2LT5kcm0sIGVuY29kZXIpIHsKPiArCWZvcl9lYWNoX2ludGVsX2Vu
Y29kZXIoJmk5MTUtPmRybSwgZW5jb2Rlcikgewo+ICAgCQlzd2l0Y2ggKGVuY29kZXItPnR5cGUp
IHsKPiAgIAkJY2FzZSBJTlRFTF9PVVRQVVRfQU5BTE9HOgo+ICAgCQkJaGFzX2ZkaSA9IHRydWU7
Cj4gQEAgLTkxOTYsMTcgKzkxOTYsMTcgQEAgc3RhdGljIHZvaWQgbHB0X2luaXRfcGNoX3JlZmNs
ayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICogY2xvY2sgaGllcmFy
Y2h5LiBUaGF0IHdvdWxkIGFsc28gYWxsb3cgdXMgdG8gZG8KPiAgIAkgKiBjbG9jayBiZW5kaW5n
IGZpbmFsbHkuCj4gICAJICovCj4gLQlpZiAoc3BsbF91c2VzX3BjaF9zc2MoZGV2X3ByaXYpKSB7
Cj4gKwlpZiAoc3BsbF91c2VzX3BjaF9zc2MoaTkxNSkpIHsKPiAgIAkJRFJNX0RFQlVHX0tNUygi
U1BMTCB1c2luZyBQQ0ggU1NDXG4iKTsKPiAgIAkJcGNoX3NzY19pbl91c2UgPSB0cnVlOwo+ICAg
CX0KPiAgIAo+IC0JaWYgKHdycGxsX3VzZXNfcGNoX3NzYyhkZXZfcHJpdiwgRFBMTF9JRF9XUlBM
TDEpKSB7Cj4gKwlpZiAod3JwbGxfdXNlc19wY2hfc3NjKGk5MTUsIERQTExfSURfV1JQTEwxKSkg
ewo+ICAgCQlEUk1fREVCVUdfS01TKCJXUlBMTDEgdXNpbmcgUENIIFNTQ1xuIik7Cj4gICAJCXBj
aF9zc2NfaW5fdXNlID0gdHJ1ZTsKPiAgIAl9Cj4gICAKPiAtCWlmICh3cnBsbF91c2VzX3BjaF9z
c2MoZGV2X3ByaXYsIERQTExfSURfV1JQTEwyKSkgewo+ICsJaWYgKHdycGxsX3VzZXNfcGNoX3Nz
YyhpOTE1LCBEUExMX0lEX1dSUExMMikpIHsKPiAgIAkJRFJNX0RFQlVHX0tNUygiV1JQTEwyIHVz
aW5nIFBDSCBTU0NcbiIpOwo+ICAgCQlwY2hfc3NjX2luX3VzZSA9IHRydWU7Cj4gICAJfQo+IEBA
IC05MjE1LDI4ICs5MjE1LDI4IEBAIHN0YXRpYyB2b2lkIGxwdF9pbml0X3BjaF9yZWZjbGsoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAlp
ZiAoaGFzX2ZkaSkgewo+IC0JCWxwdF9iZW5kX2Nsa291dF9kcChkZXZfcHJpdiwgMCk7Cj4gLQkJ
bHB0X2VuYWJsZV9jbGtvdXRfZHAoZGV2X3ByaXYsIHRydWUsIHRydWUpOwo+ICsJCWxwdF9iZW5k
X2Nsa291dF9kcChpOTE1LCAwKTsKPiArCQlscHRfZW5hYmxlX2Nsa291dF9kcChpOTE1LCB0cnVl
LCB0cnVlKTsKPiAgIAl9IGVsc2Ugewo+IC0JCWxwdF9kaXNhYmxlX2Nsa291dF9kcChkZXZfcHJp
dik7Cj4gKwkJbHB0X2Rpc2FibGVfY2xrb3V0X2RwKGk5MTUpOwo+ICAgCX0KPiAgIH0KPiAgIAo+
ICAgLyoKPiAgICAqIEluaXRpYWxpemUgcmVmZXJlbmNlIGNsb2NrcyB3aGVuIHRoZSBkcml2ZXIg
bG9hZHMKPiAgICAqLwo+IC12b2lkIGludGVsX2luaXRfcGNoX3JlZmNsayhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgaW50ZWxfaW5pdF9wY2hfcmVmY2xrKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JaWYgKEhBU19QQ0hfSUJYKGRldl9w
cml2KSB8fCBIQVNfUENIX0NQVChkZXZfcHJpdikpCj4gLQkJaXJvbmxha2VfaW5pdF9wY2hfcmVm
Y2xrKGRldl9wcml2KTsKPiAtCWVsc2UgaWYgKEhBU19QQ0hfTFBUKGRldl9wcml2KSkKPiAtCQls
cHRfaW5pdF9wY2hfcmVmY2xrKGRldl9wcml2KTsKPiArCWlmIChIQVNfUENIX0lCWChpOTE1KSB8
fCBIQVNfUENIX0NQVChpOTE1KSkKPiArCQlpcm9ubGFrZV9pbml0X3BjaF9yZWZjbGsoaTkxNSk7
Cj4gKwllbHNlIGlmIChIQVNfUENIX0xQVChpOTE1KSkKPiArCQlscHRfaW5pdF9wY2hfcmVmY2xr
KGk5MTUpOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZCBpcm9ubGFrZV9zZXRfcGlwZWNvbmYo
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gICAJc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0
Yyk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMt
PmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShj
cnRjLT5iYXNlLmRldik7Cj4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAgCXUz
MiB2YWw7Cj4gICAKPiBAQCAtOTI4MCwxMSArOTI4MCwxMSBAQCBzdGF0aWMgdm9pZCBpcm9ubGFr
ZV9zZXRfcGlwZWNvbmYoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUp
Cj4gICBzdGF0aWMgdm9pZCBoYXN3ZWxsX3NldF9waXBlY29uZihjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAg
IAllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBjcnRjX3N0YXRlLT5jcHVfdHJhbnNj
b2RlcjsKPiAgIAl1MzIgdmFsID0gMDsKPiAgIAo+IC0JaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYp
ICYmIGNydGNfc3RhdGUtPmRpdGhlcikKPiArCWlmIChJU19IQVNXRUxMKGk5MTUpICYmIGNydGNf
c3RhdGUtPmRpdGhlcikKPiAgIAkJdmFsIHw9IChQSVBFQ09ORl9ESVRIRVJfRU4gfCBQSVBFQ09O
Rl9ESVRIRVJfVFlQRV9TUCk7Cj4gICAKPiAgIAlpZiAoY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3Rl
ZF9tb2RlLmZsYWdzICYgRFJNX01PREVfRkxBR19JTlRFUkxBQ0UpCj4gQEAgLTkyOTksNyArOTI5
OSw3IEBAIHN0YXRpYyB2b2lkIGhhc3dlbGxfc2V0X3BpcGVjb25mKGNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgc3RhdGljIHZvaWQgYmR3X3NldF9waXBlbWlz
Yyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAgIAlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5j
cnRjKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGNydGMtPmJhc2UuZGV2KTsKPiAgIAl1MzIgdmFsID0gMDsKPiAgIAo+ICAgCXN3aXRjaCAoY3J0
Y19zdGF0ZS0+cGlwZV9icHApIHsKPiBAQCAtOTMzMSw3ICs5MzMxLDcgQEAgc3RhdGljIHZvaWQg
YmR3X3NldF9waXBlbWlzYyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSkKPiAgIAkJdmFsIHw9IFBJUEVNSVNDX1lVVjQyMF9FTkFCTEUgfAo+ICAgCQkJUElQRU1JU0Nf
WVVWNDIwX01PREVfRlVMTF9CTEVORDsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gMTEgJiYKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEgJiYKPiAgIAkgICAgKGNydGNf
c3RhdGUtPmFjdGl2ZV9wbGFuZXMgJiB+KGljbF9oZHJfcGxhbmVfbWFzaygpIHwKPiAgIAkJCQkJ
ICAgQklUKFBMQU5FX0NVUlNPUikpKSA9PSAwKQo+ICAgCQl2YWwgfD0gUElQRU1JU0NfSERSX01P
REVfUFJFQ0lTSU9OOwo+IEBAIC05MzQxLDcgKzkzNDEsNyBAQCBzdGF0aWMgdm9pZCBiZHdfc2V0
X3BpcGVtaXNjKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAg
Cj4gICBpbnQgYmR3X2dldF9waXBlbWlzY19icHAoc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMt
PmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShj
cnRjLT5iYXNlLmRldik7Cj4gICAJdTMyIHRtcDsKPiAgIAo+ICAgCXRtcCA9IEk5MTVfUkVBRChQ
SVBFTUlTQyhjcnRjLT5waXBlKSk7Cj4gQEAgLTkzODEsMTcgKzkzODEsMTcgQEAgc3RhdGljIHZv
aWQgaXJvbmxha2VfY29tcHV0ZV9kcGxsKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCQkJ
CSAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICAJCQkJICBzdHJ1Y3Qg
ZHBsbCAqcmVkdWNlZF9jbG9jaykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAl1MzIgZHBsbCwgZnAs
IGZwMjsKPiAgIAlpbnQgZmFjdG9yOwo+ICAgCj4gICAJLyogRW5hYmxlIGF1dG90dW5pbmcgb2Yg
dGhlIFBMTCBjbG9jayAoaWYgcGVybWlzc2libGUpICovCj4gICAJZmFjdG9yID0gMjE7Cj4gICAJ
aWYgKGludGVsX2NydGNfaGFzX3R5cGUoY3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVUX0xWRFMpKSB7
Cj4gLQkJaWYgKChpbnRlbF9wYW5lbF91c2Vfc3NjKGRldl9wcml2KSAmJgo+IC0JCSAgICAgZGV2
X3ByaXYtPnZidC5sdmRzX3NzY19mcmVxID09IDEwMDAwMCkgfHwKPiAtCQkgICAgKEhBU19QQ0hf
SUJYKGRldl9wcml2KSAmJgo+IC0JCSAgICAgaW50ZWxfaXNfZHVhbF9saW5rX2x2ZHMoZGV2X3By
aXYpKSkKPiArCQlpZiAoKGludGVsX3BhbmVsX3VzZV9zc2MoaTkxNSkgJiYKPiArCQkgICAgIGk5
MTUtPnZidC5sdmRzX3NzY19mcmVxID09IDEwMDAwMCkgfHwKPiArCQkgICAgKEhBU19QQ0hfSUJY
KGk5MTUpICYmCj4gKwkJICAgICBpbnRlbF9pc19kdWFsX2xpbmtfbHZkcyhpOTE1KSkpCj4gICAJ
CQlmYWN0b3IgPSAyNTsKPiAgIAl9IGVsc2UgaWYgKGNydGNfc3RhdGUtPnNkdm9fdHZfY2xvY2sp
IHsKPiAgIAkJZmFjdG9yID0gMjA7Cj4gQEAgLTk0NDIsNyArOTQ0Miw3IEBAIHN0YXRpYyB2b2lk
IGlyb25sYWtlX2NvbXB1dGVfZHBsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAkgKiBj
bGVhciBpZiBpdCcncyBhIHdpbiBvciBsb3NzIHBvd2VyIHdpc2UuIE5vIHBvaW50IGluIGRvaW5n
Cj4gICAJICogdGhpcyBvbiBJTEsgYXQgYWxsIHNpbmNlIGl0IGhhcyBhIGZpeGVkIERQTEw8LT5w
aXBlIG1hcHBpbmcuCj4gICAJICovCj4gLQlpZiAoSU5URUxfSU5GTyhkZXZfcHJpdiktPm51bV9w
aXBlcyA9PSAzICYmCj4gKwlpZiAoSU5URUxfSU5GTyhpOTE1KS0+bnVtX3BpcGVzID09IDMgJiYK
PiAgIAkgICAgaW50ZWxfY3J0Y19oYXNfdHlwZShjcnRjX3N0YXRlLCBJTlRFTF9PVVRQVVRfQU5B
TE9HKSkKPiAgIAkJZHBsbCB8PSBEUExMX1NEVk9fSElHSF9TUEVFRDsKPiAgIAo+IEBAIC05NDY3
LDcgKzk0NjcsNyBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9jb21wdXRlX2RwbGwoc3RydWN0IGlu
dGVsX2NydGMgKmNydGMsCj4gICAJfQo+ICAgCj4gICAJaWYgKGludGVsX2NydGNfaGFzX3R5cGUo
Y3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVUX0xWRFMpICYmCj4gLQkgICAgaW50ZWxfcGFuZWxfdXNl
X3NzYyhkZXZfcHJpdikpCj4gKwkgICAgaW50ZWxfcGFuZWxfdXNlX3NzYyhpOTE1KSkKPiAgIAkJ
ZHBsbCB8PSBQTExCX1JFRl9JTlBVVF9TUFJFQURTUEVDVFJVTUlOOwo+ICAgCWVsc2UKPiAgIAkJ
ZHBsbCB8PSBQTExfUkVGX0lOUFVUX0RSRUZDTEs7Cj4gQEAgLTk0ODIsNyArOTQ4Miw3IEBAIHN0
YXRpYyB2b2lkIGlyb25sYWtlX2NvbXB1dGVfZHBsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywK
PiAgIHN0YXRpYyBpbnQgaXJvbmxha2VfY3J0Y19jb21wdXRlX2Nsb2NrKHN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjLAo+ICAgCQkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAljb25zdCBzdHJ1Y3QgaW50ZWxfbGltaXQgKmxp
bWl0Owo+ICAgCWludCByZWZjbGsgPSAxMjAwMDA7Cj4gICAKPiBAQCAtOTQ5NCwxMyArOTQ5NCwx
MyBAQCBzdGF0aWMgaW50IGlyb25sYWtlX2NydGNfY29tcHV0ZV9jbG9jayhzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YywKPiAgIAkJcmV0dXJuIDA7Cj4gICAKPiAgIAlpZiAoaW50ZWxfY3J0Y19oYXNf
dHlwZShjcnRjX3N0YXRlLCBJTlRFTF9PVVRQVVRfTFZEUykpIHsKPiAtCQlpZiAoaW50ZWxfcGFu
ZWxfdXNlX3NzYyhkZXZfcHJpdikpIHsKPiArCQlpZiAoaW50ZWxfcGFuZWxfdXNlX3NzYyhpOTE1
KSkgewo+ICAgCQkJRFJNX0RFQlVHX0tNUygidXNpbmcgU1NDIHJlZmVyZW5jZSBjbG9jayBvZiAl
ZCBrSHpcbiIsCj4gLQkJCQkgICAgICBkZXZfcHJpdi0+dmJ0Lmx2ZHNfc3NjX2ZyZXEpOwo+IC0J
CQlyZWZjbGsgPSBkZXZfcHJpdi0+dmJ0Lmx2ZHNfc3NjX2ZyZXE7Cj4gKwkJCQkgICAgICBpOTE1
LT52YnQubHZkc19zc2NfZnJlcSk7Cj4gKwkJCXJlZmNsayA9IGk5MTUtPnZidC5sdmRzX3NzY19m
cmVxOwo+ICAgCQl9Cj4gICAKPiAtCQlpZiAoaW50ZWxfaXNfZHVhbF9saW5rX2x2ZHMoZGV2X3By
aXYpKSB7Cj4gKwkJaWYgKGludGVsX2lzX2R1YWxfbGlua19sdmRzKGk5MTUpKSB7Cj4gICAJCQlp
ZiAocmVmY2xrID09IDEwMDAwMCkKPiAgIAkJCQlsaW1pdCA9ICZpbnRlbF9saW1pdHNfaXJvbmxh
a2VfZHVhbF9sdmRzXzEwMG07Cj4gICAJCQllbHNlCj4gQEAgLTk1MzcsNyArOTUzNyw3IEBAIHN0
YXRpYyB2b2lkIGludGVsX3BjaF90cmFuc2NvZGVyX2dldF9tX24oc3RydWN0IGludGVsX2NydGMg
KmNydGMsCj4gICAJCQkJCSBzdHJ1Y3QgaW50ZWxfbGlua19tX24gKm1fbikKPiAgIHsKPiAgIAlz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7Cj4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMt
PnBpcGU7Cj4gICAKPiAgIAltX24tPmxpbmtfbSA9IEk5MTVfUkVBRChQQ0hfVFJBTlNfTElOS19N
MShwaXBlKSk7Cj4gQEAgLTk1NTQsMTAgKzk1NTQsMTAgQEAgc3RhdGljIHZvaWQgaW50ZWxfY3B1
X3RyYW5zY29kZXJfZ2V0X21fbihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAkJCQkJIHN0
cnVjdCBpbnRlbF9saW5rX21fbiAqbV9uLAo+ICAgCQkJCQkgc3RydWN0IGludGVsX2xpbmtfbV9u
ICptMl9uMikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBp
cGU7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDUpIHsKPiArCWlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gNSkgewo+ICAgCQltX24tPmxpbmtfbSA9IEk5MTVfUkVBRChQSVBFX0xJ
TktfTTEodHJhbnNjb2RlcikpOwo+ICAgCQltX24tPmxpbmtfbiA9IEk5MTVfUkVBRChQSVBFX0xJ
TktfTjEodHJhbnNjb2RlcikpOwo+ICAgCQltX24tPmdtY2hfbSA9IEk5MTVfUkVBRChQSVBFX0RB
VEFfTTEodHJhbnNjb2RlcikpCj4gQEAgLTk1NjYsNyArOTU2Niw3IEBAIHN0YXRpYyB2b2lkIGlu
dGVsX2NwdV90cmFuc2NvZGVyX2dldF9tX24oc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gICAJ
CW1fbi0+dHUgPSAoKEk5MTVfUkVBRChQSVBFX0RBVEFfTTEodHJhbnNjb2RlcikpCj4gICAJCQkg
ICAgJiBUVV9TSVpFX01BU0spID4+IFRVX1NJWkVfU0hJRlQpICsgMTsKPiAgIAo+IC0JCWlmICht
Ml9uMiAmJiB0cmFuc2NvZGVyX2hhc19tMl9uMihkZXZfcHJpdiwgdHJhbnNjb2RlcikpIHsKPiAr
CQlpZiAobTJfbjIgJiYgdHJhbnNjb2Rlcl9oYXNfbTJfbjIoaTkxNSwgdHJhbnNjb2RlcikpIHsK
PiAgIAkJCW0yX24yLT5saW5rX20gPSBJOTE1X1JFQUQoUElQRV9MSU5LX00yKHRyYW5zY29kZXIp
KTsKPiAgIAkJCW0yX24yLT5saW5rX24gPQlJOTE1X1JFQUQoUElQRV9MSU5LX04yKHRyYW5zY29k
ZXIpKTsKPiAgIAkJCW0yX24yLT5nbWNoX20gPQlJOTE1X1JFQUQoUElQRV9EQVRBX00yKHRyYW5z
Y29kZXIpKQo+IEBAIC05NjA4LDcgKzk2MDgsNyBAQCBzdGF0aWMgdm9pZCBza3lsYWtlX2dldF9w
Zml0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAkJCQkgICAgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ICAgewo+ICAgCXN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYgPSBjcnRjLT5iYXNlLmRldjsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShkZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjX3NjYWxlcl9zdGF0ZSAqc2NhbGVy
X3N0YXRlID0gJnBpcGVfY29uZmlnLT5zY2FsZXJfc3RhdGU7Cj4gICAJdTMyIHBzX2N0cmwgPSAw
Owo+ICAgCWludCBpZCA9IC0xOwo+IEBAIC05NjQwLDcgKzk2NDAsNyBAQCBza3lsYWtlX2dldF9p
bml0aWFsX3BsYW5lX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAkJCQkgc3Ry
dWN0IGludGVsX2luaXRpYWxfcGxhbmVfY29uZmlnICpwbGFuZV9jb25maWcpCj4gICB7Cj4gICAJ
c3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmJhc2UuZGV2Owo+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJc3RydWN0IGludGVsX3BsYW5lICpw
bGFuZSA9IHRvX2ludGVsX3BsYW5lKGNydGMtPmJhc2UucHJpbWFyeSk7Cj4gICAJZW51bSBwbGFu
ZV9pZCBwbGFuZV9pZCA9IHBsYW5lLT5pZDsKPiAgIAllbnVtIHBpcGUgcGlwZTsKPiBAQCAtOTY2
NywxMiArOTY2NywxMiBAQCBza3lsYWtlX2dldF9pbml0aWFsX3BsYW5lX2NvbmZpZyhzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YywKPiAgIAo+ICAgCXZhbCA9IEk5MTVfUkVBRChQTEFORV9DVEwocGlw
ZSwgcGxhbmVfaWQpKTsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCj4g
KwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKQo+ICAgCQlwaXhlbF9mb3JtYXQgPSB2YWwgJiBJ
Q0xfUExBTkVfQ1RMX0ZPUk1BVF9NQVNLOwo+ICAgCWVsc2UKPiAgIAkJcGl4ZWxfZm9ybWF0ID0g
dmFsICYgUExBTkVfQ1RMX0ZPUk1BVF9NQVNLOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA+PSAxMCB8fCBJU19HRU1JTklMQUtFKGRldl9wcml2KSkgewo+ICsJaWYgKElOVEVMX0dF
TihpOTE1KSA+PSAxMCB8fCBJU19HRU1JTklMQUtFKGk5MTUpKSB7Cj4gICAJCWFscGhhID0gSTkx
NV9SRUFEKFBMQU5FX0NPTE9SX0NUTChwaXBlLCBwbGFuZV9pZCkpOwo+ICAgCQlhbHBoYSAmPSBQ
TEFORV9DT0xPUl9BTFBIQV9NQVNLOwo+ICAgCX0gZWxzZSB7Cj4gQEAgLTk3MjksNyArOTcyOSw3
IEBAIHNreWxha2VfZ2V0X2luaXRpYWxfcGxhbmVfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjLAo+ICAgCQlicmVhazsKPiAgIAl9Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
ID49IDEwICYmCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDEwICYmCj4gICAJICAgIHZhbCAm
IFBMQU5FX0NUTF9GTElQX0hPUklaT05UQUwpCj4gICAJCXBsYW5lX2NvbmZpZy0+cm90YXRpb24g
fD0gRFJNX01PREVfUkVGTEVDVF9YOwo+ICAgCj4gQEAgLTk3NjYsNyArOTc2Niw3IEBAIHN0YXRp
YyB2b2lkIGlyb25sYWtlX2dldF9wZml0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywK
PiAgIAkJCQkgICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiAgIHsK
PiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7Cj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAl1MzIgdG1wOwo+ICAgCj4g
ICAJdG1wID0gSTkxNV9SRUFEKFBGX0NUTChjcnRjLT5waXBlKSk7Cj4gQEAgLTk3NzksNyArOTc3
OSw3IEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX2dldF9wZml0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YywKPiAgIAkJLyogV2UgY3VycmVudGx5IGRvIG5vdCBmcmVlIGFzc2lnbmVtZW50
cyBvZiBwYW5lbCBmaXR0ZXJzIG9uCj4gICAJCSAqIGl2Yi9oc3cgKHNpbmNlIHdlIGRvbid0IHVz
ZSB0aGUgaGlnaGVyIHVwc2NhbGluZyBtb2RlcyB3aGljaAo+ICAgCQkgKiBkaWZmZXJlbnRpYXRl
cyB0aGVtKSBzbyBqdXN0IFdBUk4gYWJvdXQgdGhpcyBjYXNlIGZvciBub3cuICovCj4gLQkJaWYg
KElTX0dFTihkZXZfcHJpdiwgNykpIHsKPiArCQlpZiAoSVNfR0VOKGk5MTUsIDcpKSB7Cj4gICAJ
CQlXQVJOX09OKCh0bXAgJiBQRl9QSVBFX1NFTF9NQVNLX0lWQikgIT0KPiAgIAkJCQlQRl9QSVBF
X1NFTF9JVkIoY3J0Yy0+cGlwZSkpOwo+ICAgCQl9Cj4gQEAgLTk3OTAsMTQgKzk3OTAsMTQgQEAg
c3RhdGljIGJvb2wgaXJvbmxha2VfZ2V0X3BpcGVfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjLAo+ICAgCQkJCSAgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+
ICAgewo+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5iYXNlLmRldjsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCWVudW0gaW50ZWxf
ZGlzcGxheV9wb3dlcl9kb21haW4gcG93ZXJfZG9tYWluOwo+ICAgCWludGVsX3dha2VyZWZfdCB3
YWtlcmVmOwo+ICAgCXUzMiB0bXA7Cj4gICAJYm9vbCByZXQ7Cj4gICAKPiAgIAlwb3dlcl9kb21h
aW4gPSBQT1dFUl9ET01BSU5fUElQRShjcnRjLT5waXBlKTsKPiAtCXdha2VyZWYgPSBpbnRlbF9k
aXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGRldl9wcml2LCBwb3dlcl9kb21haW4pOwo+ICsJ
d2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoaTkxNSwgcG93ZXJf
ZG9tYWluKTsKPiAgIAlpZiAoIXdha2VyZWYpCj4gICAJCXJldHVybiBmYWxzZTsKPiAgIAo+IEBA
IC05ODUwLDcgKzk4NTAsNyBAQCBzdGF0aWMgYm9vbCBpcm9ubGFrZV9nZXRfcGlwZV9jb25maWco
c3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gICAKPiAgIAkJaXJvbmxha2VfZ2V0X2ZkaV9tX25f
Y29uZmlnKGNydGMsIHBpcGVfY29uZmlnKTsKPiAgIAo+IC0JCWlmIChIQVNfUENIX0lCWChkZXZf
cHJpdikpIHsKPiArCQlpZiAoSEFTX1BDSF9JQlgoaTkxNSkpIHsKPiAgIAkJCS8qCj4gICAJCQkg
KiBUaGUgcGlwZS0+cGNoIHRyYW5zY29kZXIgYW5kIHBjaCB0cmFuc2NvZGVyLT5wbGwKPiAgIAkJ
CSAqIG1hcHBpbmcgaXMgZml4ZWQuCj4gQEAgLTk4NjUsMTAgKzk4NjUsMTAgQEAgc3RhdGljIGJv
b2wgaXJvbmxha2VfZ2V0X3BpcGVfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAg
CQl9Cj4gICAKPiAgIAkJcGlwZV9jb25maWctPnNoYXJlZF9kcGxsID0KPiAtCQkJaW50ZWxfZ2V0
X3NoYXJlZF9kcGxsX2J5X2lkKGRldl9wcml2LCBwbGxfaWQpOwo+ICsJCQlpbnRlbF9nZXRfc2hh
cmVkX2RwbGxfYnlfaWQoaTkxNSwgcGxsX2lkKTsKPiAgIAkJcGxsID0gcGlwZV9jb25maWctPnNo
YXJlZF9kcGxsOwo+ICAgCj4gLQkJV0FSTl9PTighcGxsLT5pbmZvLT5mdW5jcy0+Z2V0X2h3X3N0
YXRlKGRldl9wcml2LCBwbGwsCj4gKwkJV0FSTl9PTighcGxsLT5pbmZvLT5mdW5jcy0+Z2V0X2h3
X3N0YXRlKGk5MTUsIHBsbCwKPiAgIAkJCQkJCSZwaXBlX2NvbmZpZy0+ZHBsbF9od19zdGF0ZSkp
Owo+ICAgCj4gICAJCXRtcCA9IHBpcGVfY29uZmlnLT5kcGxsX2h3X3N0YXRlLmRwbGw7Cj4gQEAg
LTk4ODksMTkgKzk4ODksMTkgQEAgc3RhdGljIGJvb2wgaXJvbmxha2VfZ2V0X3BpcGVfY29uZmln
KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCXJldCA9IHRydWU7Cj4gICAKPiAgIG91dDoK
PiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBwb3dlcl9kb21haW4sIHdha2Vy
ZWYpOwo+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgcG93ZXJfZG9tYWluLCB3YWtl
cmVmKTsKPiAgIAo+ICAgCXJldHVybiByZXQ7Cj4gICB9Cj4gICBzdGF0aWMgaW50IGhhc3dlbGxf
Y3J0Y19jb21wdXRlX2Nsb2NrKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCQkJCSAgICAg
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+
ICAgCXN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlID0KPiAgIAkJdG9faW50ZWxfYXRv
bWljX3N0YXRlKGNydGNfc3RhdGUtPmJhc2Uuc3RhdGUpOwo+ICAgCj4gICAJaWYgKCFpbnRlbF9j
cnRjX2hhc190eXBlKGNydGNfc3RhdGUsIElOVEVMX09VVFBVVF9EU0kpIHx8Cj4gLQkgICAgSU5U
RUxfR0VOKGRldl9wcml2KSA+PSAxMSkgewo+ICsJICAgIElOVEVMX0dFTihpOTE1KSA+PSAxMSkg
ewo+ICAgCQlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciA9Cj4gICAJCQlpbnRlbF9nZXRf
Y3J0Y19uZXdfZW5jb2RlcihzdGF0ZSwgY3J0Y19zdGF0ZSk7Cj4gICAKPiBAQCAtOTkxNSw3ICs5
OTE1LDcgQEAgc3RhdGljIGludCBoYXN3ZWxsX2NydGNfY29tcHV0ZV9jbG9jayhzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YywKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBj
YW5ub25sYWtlX2dldF9kZGlfcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiArc3RhdGljIHZvaWQgY2Fubm9ubGFrZV9nZXRfZGRpX3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiAgIAkJCQkgICBlbnVtIHBvcnQgcG9ydCwKPiAgIAkJCQkgICBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gICB7Cj4gQEAgLTk5MjgsMTAgKzk5Mjgs
MTAgQEAgc3RhdGljIHZvaWQgY2Fubm9ubGFrZV9nZXRfZGRpX3BsbChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJaWYgKFdBUk5fT04oaWQgPCBTS0xfRFBMTDAgfHwgaWQg
PiBTS0xfRFBMTDIpKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCXBpcGVfY29uZmlnLT5zaGFyZWRf
ZHBsbCA9IGludGVsX2dldF9zaGFyZWRfZHBsbF9ieV9pZChkZXZfcHJpdiwgaWQpOwo+ICsJcGlw
ZV9jb25maWctPnNoYXJlZF9kcGxsID0gaW50ZWxfZ2V0X3NoYXJlZF9kcGxsX2J5X2lkKGk5MTUs
IGlkKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpY2VsYWtlX2dldF9kZGlfcGxsKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgaWNlbGFrZV9nZXRf
ZGRpX3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQllbnVtIHBvcnQg
cG9ydCwKPiAgIAkJCQlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gICB7
Cj4gQEAgLTk5MzksMjEgKzk5MzksMjEgQEAgc3RhdGljIHZvaWQgaWNlbGFrZV9nZXRfZGRpX3Bs
bChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJdTMyIHRlbXA7Cj4gICAK
PiAgIAkvKiBUT0RPOiBUQlQgcGxsIG5vdCBpbXBsZW1lbnRlZC4gKi8KPiAtCWlmIChpbnRlbF9w
b3J0X2lzX2NvbWJvcGh5KGRldl9wcml2LCBwb3J0KSkgewo+ICsJaWYgKGludGVsX3BvcnRfaXNf
Y29tYm9waHkoaTkxNSwgcG9ydCkpIHsKPiAgIAkJdGVtcCA9IEk5MTVfUkVBRChEUENMS0FfQ0ZH
Q1IwX0lDTCkgJgo+ICAgCQkgICAgICAgRFBDTEtBX0NGR0NSMF9ERElfQ0xLX1NFTF9NQVNLKHBv
cnQpOwo+ICAgCQlpZCA9IHRlbXAgPj4gRFBDTEtBX0NGR0NSMF9ERElfQ0xLX1NFTF9TSElGVChw
b3J0KTsKPiAtCX0gZWxzZSBpZiAoaW50ZWxfcG9ydF9pc190YyhkZXZfcHJpdiwgcG9ydCkpIHsK
PiAtCQlpZCA9IGljbF90Y19wb3J0X3RvX3BsbF9pZChpbnRlbF9wb3J0X3RvX3RjKGRldl9wcml2
LCBwb3J0KSk7Cj4gKwl9IGVsc2UgaWYgKGludGVsX3BvcnRfaXNfdGMoaTkxNSwgcG9ydCkpIHsK
PiArCQlpZCA9IGljbF90Y19wb3J0X3RvX3BsbF9pZChpbnRlbF9wb3J0X3RvX3RjKGk5MTUsIHBv
cnQpKTsKPiAgIAl9IGVsc2Ugewo+ICAgCQlXQVJOKDEsICJJbnZhbGlkIHBvcnQgJXhcbiIsIHBv
cnQpOwo+ICAgCQlyZXR1cm47Cj4gICAJfQo+ICAgCj4gLQlwaXBlX2NvbmZpZy0+c2hhcmVkX2Rw
bGwgPSBpbnRlbF9nZXRfc2hhcmVkX2RwbGxfYnlfaWQoZGV2X3ByaXYsIGlkKTsKPiArCXBpcGVf
Y29uZmlnLT5zaGFyZWRfZHBsbCA9IGludGVsX2dldF9zaGFyZWRfZHBsbF9ieV9pZChpOTE1LCBp
ZCk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgYnh0X2dldF9kZGlfcGxsKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgYnh0X2dldF9kZGlfcGxsKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCWVudW0gcG9ydCBwb3J0LAo+ICAg
CQkJCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiAgIHsKPiBAQCAtOTk3
NCwxMCArOTk3NCwxMCBAQCBzdGF0aWMgdm9pZCBieHRfZ2V0X2RkaV9wbGwoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCQlyZXR1cm47Cj4gICAJfQo+ICAgCj4gLQlwaXBl
X2NvbmZpZy0+c2hhcmVkX2RwbGwgPSBpbnRlbF9nZXRfc2hhcmVkX2RwbGxfYnlfaWQoZGV2X3By
aXYsIGlkKTsKPiArCXBpcGVfY29uZmlnLT5zaGFyZWRfZHBsbCA9IGludGVsX2dldF9zaGFyZWRf
ZHBsbF9ieV9pZChpOTE1LCBpZCk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgc2t5bGFrZV9n
ZXRfZGRpX3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2
b2lkIHNreWxha2VfZ2V0X2RkaV9wbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
ICAJCQkJZW51bSBwb3J0IHBvcnQsCj4gICAJCQkJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBp
cGVfY29uZmlnKQo+ICAgewo+IEBAIC05OTkwLDEwICs5OTkwLDEwIEBAIHN0YXRpYyB2b2lkIHNr
eWxha2VfZ2V0X2RkaV9wbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAg
CWlmIChXQVJOX09OKGlkIDwgU0tMX0RQTEwwIHx8IGlkID4gU0tMX0RQTEwzKSkKPiAgIAkJcmV0
dXJuOwo+ICAgCj4gLQlwaXBlX2NvbmZpZy0+c2hhcmVkX2RwbGwgPSBpbnRlbF9nZXRfc2hhcmVk
X2RwbGxfYnlfaWQoZGV2X3ByaXYsIGlkKTsKPiArCXBpcGVfY29uZmlnLT5zaGFyZWRfZHBsbCA9
IGludGVsX2dldF9zaGFyZWRfZHBsbF9ieV9pZChpOTE1LCBpZCk7Cj4gICB9Cj4gICAKPiAtc3Rh
dGljIHZvaWQgaGFzd2VsbF9nZXRfZGRpX3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGhhc3dlbGxfZ2V0X2RkaV9wbGwoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJZW51bSBwb3J0IHBvcnQsCj4gICAJCQkJc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ICAgewo+IEBAIC0xMDAyNiw3ICsxMDAyNiw3
IEBAIHN0YXRpYyB2b2lkIGhhc3dlbGxfZ2V0X2RkaV9wbGwoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ICAgCQlyZXR1cm47Cj4gICAJfQo+ICAgCj4gLQlwaXBlX2NvbmZpZy0+
c2hhcmVkX2RwbGwgPSBpbnRlbF9nZXRfc2hhcmVkX2RwbGxfYnlfaWQoZGV2X3ByaXYsIGlkKTsK
PiArCXBpcGVfY29uZmlnLT5zaGFyZWRfZHBsbCA9IGludGVsX2dldF9zaGFyZWRfZHBsbF9ieV9p
ZChpOTE1LCBpZCk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBib29sIGhzd19nZXRfdHJhbnNjb2Rl
cl9zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiBAQCAtMTAwMzUsNyArMTAwMzUsNyBA
QCBzdGF0aWMgYm9vbCBoc3dfZ2V0X3RyYW5zY29kZXJfc3RhdGUoc3RydWN0IGludGVsX2NydGMg
KmNydGMsCj4gICAJCQkJICAgICBpbnRlbF93YWtlcmVmX3QgKndha2VyZWZzKQo+ICAgewo+ICAg
CXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5iYXNlLmRldjsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCWVudW0gaW50ZWxfZGlzcGxheV9w
b3dlcl9kb21haW4gcG93ZXJfZG9tYWluOwo+ICAgCXVuc2lnbmVkIGxvbmcgcGFuZWxfdHJhbnNj
b2Rlcl9tYXNrID0gMDsKPiAgIAl1bnNpZ25lZCBsb25nIGVuYWJsZWRfcGFuZWxfdHJhbnNjb2Rl
cnMgPSAwOwo+IEBAIC0xMDA0MywxMSArMTAwNDMsMTEgQEAgc3RhdGljIGJvb2wgaHN3X2dldF90
cmFuc2NvZGVyX3N0YXRlKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCWludGVsX3dha2Vy
ZWZfdCB3ZjsKPiAgIAl1MzIgdG1wOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+
PSAxMSkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpCj4gICAJCXBhbmVsX3RyYW5zY29k
ZXJfbWFzayB8PQo+ICAgCQkJQklUKFRSQU5TQ09ERVJfRFNJXzApIHwgQklUKFRSQU5TQ09ERVJf
RFNJXzEpOwo+ICAgCj4gLQlpZiAoSEFTX1RSQU5TQ09ERVJfRURQKGRldl9wcml2KSkKPiArCWlm
IChIQVNfVFJBTlNDT0RFUl9FRFAoaTkxNSkpCj4gICAJCXBhbmVsX3RyYW5zY29kZXJfbWFzayB8
PSBCSVQoVFJBTlNDT0RFUl9FRFApOwo+ICAgCj4gICAJLyoKPiBAQCAtMTAwNjIsNyArMTAwNjIs
NyBAQCBzdGF0aWMgYm9vbCBoc3dfZ2V0X3RyYW5zY29kZXJfc3RhdGUoc3RydWN0IGludGVsX2Ny
dGMgKmNydGMsCj4gICAJICovCj4gICAJZm9yX2VhY2hfc2V0X2JpdChwYW5lbF90cmFuc2NvZGVy
LAo+ICAgCQkJICZwYW5lbF90cmFuc2NvZGVyX21hc2ssCj4gLQkJCSBBUlJBWV9TSVpFKElOVEVM
X0lORk8oZGV2X3ByaXYpLT50cmFuc19vZmZzZXRzKSkgewo+ICsJCQkgQVJSQVlfU0laRShJTlRF
TF9JTkZPKGk5MTUpLT50cmFuc19vZmZzZXRzKSkgewo+ICAgCQlib29sIGZvcmNlX3RocnUgPSBm
YWxzZTsKPiAgIAkJZW51bSBwaXBlIHRyYW5zX3BpcGU7Cj4gICAKPiBAQCAtMTAxMTMsNyArMTAx
MTMsNyBAQCBzdGF0aWMgYm9vbCBoc3dfZ2V0X3RyYW5zY29kZXJfc3RhdGUoc3RydWN0IGludGVs
X2NydGMgKmNydGMsCj4gICAJcG93ZXJfZG9tYWluID0gUE9XRVJfRE9NQUlOX1RSQU5TQ09ERVIo
cGlwZV9jb25maWctPmNwdV90cmFuc2NvZGVyKTsKPiAgIAlXQVJOX09OKCpwb3dlcl9kb21haW5f
bWFzayAmIEJJVF9VTEwocG93ZXJfZG9tYWluKSk7Cj4gICAKPiAtCXdmID0gaW50ZWxfZGlzcGxh
eV9wb3dlcl9nZXRfaWZfZW5hYmxlZChkZXZfcHJpdiwgcG93ZXJfZG9tYWluKTsKPiArCXdmID0g
aW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChpOTE1LCBwb3dlcl9kb21haW4pOwo+
ICAgCWlmICghd2YpCj4gICAJCXJldHVybiBmYWxzZTsKPiAgIAo+IEBAIC0xMDEzMSw3ICsxMDEz
MSw3IEBAIHN0YXRpYyBib29sIGJ4dF9nZXRfZHNpX3RyYW5zY29kZXJfc3RhdGUoc3RydWN0IGlu
dGVsX2NydGMgKmNydGMsCj4gICAJCQkJCSBpbnRlbF93YWtlcmVmX3QgKndha2VyZWZzKQo+ICAg
ewo+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5iYXNlLmRldjsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCWVudW0gaW50ZWxfZGlz
cGxheV9wb3dlcl9kb21haW4gcG93ZXJfZG9tYWluOwo+ICAgCWVudW0gdHJhbnNjb2RlciBjcHVf
dHJhbnNjb2RlcjsKPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2Y7Cj4gQEAgLTEwMTQ3LDcgKzEwMTQ3
LDcgQEAgc3RhdGljIGJvb2wgYnh0X2dldF9kc2lfdHJhbnNjb2Rlcl9zdGF0ZShzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YywKPiAgIAkJcG93ZXJfZG9tYWluID0gUE9XRVJfRE9NQUlOX1RSQU5TQ09E
RVIoY3B1X3RyYW5zY29kZXIpOwo+ICAgCQlXQVJOX09OKCpwb3dlcl9kb21haW5fbWFzayAmIEJJ
VF9VTEwocG93ZXJfZG9tYWluKSk7Cj4gICAKPiAtCQl3ZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJf
Z2V0X2lmX2VuYWJsZWQoZGV2X3ByaXYsIHBvd2VyX2RvbWFpbik7Cj4gKwkJd2YgPSBpbnRlbF9k
aXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGk5MTUsIHBvd2VyX2RvbWFpbik7Cj4gICAJCWlm
ICghd2YpCj4gICAJCQljb250aW51ZTsKPiAgIAo+IEBAIC0xMDE2MSw3ICsxMDE2MSw3IEBAIHN0
YXRpYyBib29sIGJ4dF9nZXRfZHNpX3RyYW5zY29kZXJfc3RhdGUoc3RydWN0IGludGVsX2NydGMg
KmNydGMsCj4gICAJCSAqIHJlZ2lzdGVycy9NSVBJW0JYVF0uIFdlIGNhbiBicmVhayBvdXQgaGVy
ZSBlYXJseSwgc2luY2Ugd2UKPiAgIAkJICogbmVlZCB0aGUgc2FtZSBEU0kgUExMIHRvIGJlIGVu
YWJsZWQgZm9yIGJvdGggRFNJIHBvcnRzLgo+ICAgCQkgKi8KPiAtCQlpZiAoIWJ4dF9kc2lfcGxs
X2lzX2VuYWJsZWQoZGV2X3ByaXYpKQo+ICsJCWlmICghYnh0X2RzaV9wbGxfaXNfZW5hYmxlZChp
OTE1KSkKPiAgIAkJCWJyZWFrOwo+ICAgCj4gICAJCS8qIFhYWDogdGhpcyB3b3JrcyBmb3Igdmlk
ZW8gbW9kZSBvbmx5ICovCj4gQEAgLTEwMTgzLDcgKzEwMTgzLDcgQEAgc3RhdGljIGJvb2wgYnh0
X2dldF9kc2lfdHJhbnNjb2Rlcl9zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIHN0
YXRpYyB2b2lkIGhhc3dlbGxfZ2V0X2RkaV9wb3J0X3N0YXRlKHN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjLAo+ICAgCQkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcp
Cj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNy
dGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShjcnRjLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGw7Cj4g
ICAJZW51bSBwb3J0IHBvcnQ7Cj4gICAJdTMyIHRtcDsKPiBAQCAtMTAxOTIsMjAgKzEwMTkyLDIw
IEBAIHN0YXRpYyB2b2lkIGhhc3dlbGxfZ2V0X2RkaV9wb3J0X3N0YXRlKHN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjLAo+ICAgCj4gICAJcG9ydCA9ICh0bXAgJiBUUkFOU19ERElfUE9SVF9NQVNLKSA+
PiBUUkFOU19ERElfUE9SVF9TSElGVDsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gMTEpCj4gLQkJaWNlbGFrZV9nZXRfZGRpX3BsbChkZXZfcHJpdiwgcG9ydCwgcGlwZV9jb25m
aWcpOwo+IC0JZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShkZXZfcHJpdikpCj4gLQkJY2Fubm9ubGFr
ZV9nZXRfZGRpX3BsbChkZXZfcHJpdiwgcG9ydCwgcGlwZV9jb25maWcpOwo+IC0JZWxzZSBpZiAo
SVNfR0VOOV9CQyhkZXZfcHJpdikpCj4gLQkJc2t5bGFrZV9nZXRfZGRpX3BsbChkZXZfcHJpdiwg
cG9ydCwgcGlwZV9jb25maWcpOwo+IC0JZWxzZSBpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCj4g
LQkJYnh0X2dldF9kZGlfcGxsKGRldl9wcml2LCBwb3J0LCBwaXBlX2NvbmZpZyk7Cj4gKwlpZiAo
SU5URUxfR0VOKGk5MTUpID49IDExKQo+ICsJCWljZWxha2VfZ2V0X2RkaV9wbGwoaTkxNSwgcG9y
dCwgcGlwZV9jb25maWcpOwo+ICsJZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShpOTE1KSkKPiArCQlj
YW5ub25sYWtlX2dldF9kZGlfcGxsKGk5MTUsIHBvcnQsIHBpcGVfY29uZmlnKTsKPiArCWVsc2Ug
aWYgKElTX0dFTjlfQkMoaTkxNSkpCj4gKwkJc2t5bGFrZV9nZXRfZGRpX3BsbChpOTE1LCBwb3J0
LCBwaXBlX2NvbmZpZyk7Cj4gKwllbHNlIGlmIChJU19HRU45X0xQKGk5MTUpKQo+ICsJCWJ4dF9n
ZXRfZGRpX3BsbChpOTE1LCBwb3J0LCBwaXBlX2NvbmZpZyk7Cj4gICAJZWxzZQo+IC0JCWhhc3dl
bGxfZ2V0X2RkaV9wbGwoZGV2X3ByaXYsIHBvcnQsIHBpcGVfY29uZmlnKTsKPiArCQloYXN3ZWxs
X2dldF9kZGlfcGxsKGk5MTUsIHBvcnQsIHBpcGVfY29uZmlnKTsKPiAgIAo+ICAgCXBsbCA9IHBp
cGVfY29uZmlnLT5zaGFyZWRfZHBsbDsKPiAgIAlpZiAocGxsKSB7Cj4gLQkJV0FSTl9PTighcGxs
LT5pbmZvLT5mdW5jcy0+Z2V0X2h3X3N0YXRlKGRldl9wcml2LCBwbGwsCj4gKwkJV0FSTl9PTigh
cGxsLT5pbmZvLT5mdW5jcy0+Z2V0X2h3X3N0YXRlKGk5MTUsIHBsbCwKPiAgIAkJCQkJCSZwaXBl
X2NvbmZpZy0+ZHBsbF9od19zdGF0ZSkpOwo+ICAgCX0KPiAgIAo+IEBAIC0xMDIxNCw3ICsxMDIx
NCw3IEBAIHN0YXRpYyB2b2lkIGhhc3dlbGxfZ2V0X2RkaV9wb3J0X3N0YXRlKHN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjLAo+ICAgCSAqIERESSBFLiBTbyBqdXN0IGNoZWNrIHdoZXRoZXIgdGhpcyBw
aXBlIGlzIHdpcmVkIHRvIERESSBFIGFuZCB3aGV0aGVyCj4gICAJICogdGhlIFBDSCB0cmFuc2Nv
ZGVyIGlzIG9uLgo+ICAgCSAqLwo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA5ICYmCj4g
KwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgOSAmJgo+ICAgCSAgICAocG9ydCA9PSBQT1JUX0UpICYm
IEk5MTVfUkVBRChMUFRfVFJBTlNDT05GKSAmIFRSQU5TX0VOQUJMRSkgewo+ICAgCQlwaXBlX2Nv
bmZpZy0+aGFzX3BjaF9lbmNvZGVyID0gdHJ1ZTsKPiAgIAo+IEBAIC0xMDIyOSw3ICsxMDIyOSw3
IEBAIHN0YXRpYyB2b2lkIGhhc3dlbGxfZ2V0X2RkaV9wb3J0X3N0YXRlKHN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjLAo+ICAgc3RhdGljIGJvb2wgaGFzd2VsbF9nZXRfcGlwZV9jb25maWcoc3RydWN0
IGludGVsX2NydGMgKmNydGMsCj4gICAJCQkJICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpw
aXBlX2NvbmZpZykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJl
ZnNbUE9XRVJfRE9NQUlOX05VTV0sIHdmOwo+ICAgCWVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9k
b21haW4gcG93ZXJfZG9tYWluOwo+ICAgCXU2NCBwb3dlcl9kb21haW5fbWFzazsKPiBAQCAtMTAy
MzgsNyArMTAyMzgsNyBAQCBzdGF0aWMgYm9vbCBoYXN3ZWxsX2dldF9waXBlX2NvbmZpZyhzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAlpbnRlbF9jcnRjX2luaXRfc2NhbGVycyhjcnRjLCBw
aXBlX2NvbmZpZyk7Cj4gICAKPiAgIAlwb3dlcl9kb21haW4gPSBQT1dFUl9ET01BSU5fUElQRShj
cnRjLT5waXBlKTsKPiAtCXdmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChk
ZXZfcHJpdiwgcG93ZXJfZG9tYWluKTsKPiArCXdmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRf
aWZfZW5hYmxlZChpOTE1LCBwb3dlcl9kb21haW4pOwo+ICAgCWlmICghd2YpCj4gICAJCXJldHVy
biBmYWxzZTsKPiAgIAo+IEBAIC0xMDI1MCw3ICsxMDI1MCw3IEBAIHN0YXRpYyBib29sIGhhc3dl
bGxfZ2V0X3BpcGVfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCWFjdGl2ZSA9
IGhzd19nZXRfdHJhbnNjb2Rlcl9zdGF0ZShjcnRjLCBwaXBlX2NvbmZpZywKPiAgIAkJCQkJICAm
cG93ZXJfZG9tYWluX21hc2ssIHdha2VyZWZzKTsKPiAgIAo+IC0JaWYgKElTX0dFTjlfTFAoZGV2
X3ByaXYpICYmCj4gKwlpZiAoSVNfR0VOOV9MUChpOTE1KSAmJgo+ICAgCSAgICBieHRfZ2V0X2Rz
aV90cmFuc2NvZGVyX3N0YXRlKGNydGMsIHBpcGVfY29uZmlnLAo+ICAgCQkJCQkgJnBvd2VyX2Rv
bWFpbl9tYXNrLCB3YWtlcmVmcykpIHsKPiAgIAkJV0FSTl9PTihhY3RpdmUpOwo+IEBAIC0xMDI2
MSw3ICsxMDI2MSw3IEBAIHN0YXRpYyBib29sIGhhc3dlbGxfZ2V0X3BpcGVfY29uZmlnKHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCQlnb3RvIG91dDsKPiAgIAo+ICAgCWlmICghdHJhbnNj
b2Rlcl9pc19kc2kocGlwZV9jb25maWctPmNwdV90cmFuc2NvZGVyKSB8fAo+IC0JICAgIElOVEVM
X0dFTihkZXZfcHJpdikgPj0gMTEpIHsKPiArCSAgICBJTlRFTF9HRU4oaTkxNSkgPj0gMTEpIHsK
PiAgIAkJaGFzd2VsbF9nZXRfZGRpX3BvcnRfc3RhdGUoY3J0YywgcGlwZV9jb25maWcpOwo+ICAg
CQlpbnRlbF9nZXRfcGlwZV90aW1pbmdzKGNydGMsIHBpcGVfY29uZmlnKTsKPiAgIAl9Cj4gQEAg
LTEwMjczLDcgKzEwMjczLDcgQEAgc3RhdGljIGJvb2wgaGFzd2VsbF9nZXRfcGlwZV9jb25maWco
c3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gICAKPiAgIAlwaXBlX2NvbmZpZy0+Y3NjX21vZGUg
PSBJOTE1X1JFQUQoUElQRV9DU0NfTU9ERShjcnRjLT5waXBlKSk7Cj4gICAKPiAtCWlmIChJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDkpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkgewo+
ICAgCQl1MzIgdG1wID0gSTkxNV9SRUFEKFNLTF9CT1RUT01fQ09MT1IoY3J0Yy0+cGlwZSkpOwo+
ICAgCj4gICAJCWlmICh0bXAgJiBTS0xfQk9UVE9NX0NPTE9SX0dBTU1BX0VOQUJMRSkKPiBAQCAt
MTAyOTAsMTkgKzEwMjkwLDE5IEBAIHN0YXRpYyBib29sIGhhc3dlbGxfZ2V0X3BpcGVfY29uZmln
KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCXBvd2VyX2RvbWFpbiA9IFBPV0VSX0RPTUFJ
Tl9QSVBFX1BBTkVMX0ZJVFRFUihjcnRjLT5waXBlKTsKPiAgIAlXQVJOX09OKHBvd2VyX2RvbWFp
bl9tYXNrICYgQklUX1VMTChwb3dlcl9kb21haW4pKTsKPiAgIAo+IC0Jd2YgPSBpbnRlbF9kaXNw
bGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGRldl9wcml2LCBwb3dlcl9kb21haW4pOwo+ICsJd2Yg
PSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGk5MTUsIHBvd2VyX2RvbWFpbik7
Cj4gICAJaWYgKHdmKSB7Cj4gICAJCXdha2VyZWZzW3Bvd2VyX2RvbWFpbl0gPSB3ZjsKPiAgIAkJ
cG93ZXJfZG9tYWluX21hc2sgfD0gQklUX1VMTChwb3dlcl9kb21haW4pOwo+ICAgCj4gLQkJaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkKPiArCQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkp
Cj4gICAJCQlza3lsYWtlX2dldF9wZml0X2NvbmZpZyhjcnRjLCBwaXBlX2NvbmZpZyk7Cj4gICAJ
CWVsc2UKPiAgIAkJCWlyb25sYWtlX2dldF9wZml0X2NvbmZpZyhjcnRjLCBwaXBlX2NvbmZpZyk7
Cj4gICAJfQo+ICAgCj4gICAJaWYgKGhzd19jcnRjX3N1cHBvcnRzX2lwcyhjcnRjKSkgewo+IC0J
CWlmIChJU19IQVNXRUxMKGRldl9wcml2KSkKPiArCQlpZiAoSVNfSEFTV0VMTChpOTE1KSkKPiAg
IAkJCXBpcGVfY29uZmlnLT5pcHNfZW5hYmxlZCA9IEk5MTVfUkVBRChJUFNfQ1RMKSAmIElQU19F
TkFCTEU7Cj4gICAJCWVsc2Ugewo+ICAgCQkJLyoKPiBAQCAtMTAzMjQsNyArMTAzMjQsNyBAQCBz
dGF0aWMgYm9vbCBoYXN3ZWxsX2dldF9waXBlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YywKPiAgIAo+ICAgb3V0Ogo+ICAgCWZvcl9lYWNoX3Bvd2VyX2RvbWFpbihwb3dlcl9kb21haW4s
IHBvd2VyX2RvbWFpbl9tYXNrKQo+IC0JCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2
LAo+ICsJCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5MTUsCj4gICAJCQkJCXBvd2VyX2RvbWFp
biwgd2FrZXJlZnNbcG93ZXJfZG9tYWluXSk7Cj4gICAKPiAgIAlyZXR1cm4gYWN0aXZlOwo+IEBA
IC0xMDMzMiwxMyArMTAzMzIsMTMgQEAgc3RhdGljIGJvb2wgaGFzd2VsbF9nZXRfcGlwZV9jb25m
aWcoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gICAKPiAgIHN0YXRpYyB1MzIgaW50ZWxfY3Vy
c29yX2Jhc2UoY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPiAg
IHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9Cj4gICAJCXRvX2k5MTUocGxhbmVfc3RhdGUtPmJhc2UucGxh
bmUtPmRldik7Cj4gICAJY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBwbGFuZV9z
dGF0ZS0+YmFzZS5mYjsKPiAgIAljb25zdCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2Jq
ID0gaW50ZWxfZmJfb2JqKGZiKTsKPiAgIAl1MzIgYmFzZTsKPiAgIAo+IC0JaWYgKElOVEVMX0lO
Rk8oZGV2X3ByaXYpLT5kaXNwbGF5LmN1cnNvcl9uZWVkc19waHlzaWNhbCkKPiArCWlmIChJTlRF
TF9JTkZPKGk5MTUpLT5kaXNwbGF5LmN1cnNvcl9uZWVkc19waHlzaWNhbCkKPiAgIAkJYmFzZSA9
IG9iai0+cGh5c19oYW5kbGUtPmJ1c2FkZHI7Cj4gICAJZWxzZQo+ICAgCQliYXNlID0gaW50ZWxf
cGxhbmVfZ2d0dF9vZmZzZXQocGxhbmVfc3RhdGUpOwo+IEBAIC0xMDM0Niw3ICsxMDM0Niw3IEBA
IHN0YXRpYyB1MzIgaW50ZWxfY3Vyc29yX2Jhc2UoY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0
YXRlICpwbGFuZV9zdGF0ZSkKPiAgIAliYXNlICs9IHBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVsw
XS5vZmZzZXQ7Cj4gICAKPiAgIAkvKiBJTEsrIGRvIHRoaXMgYXV0b21hZ2ljYWxseSAqLwo+IC0J
aWYgKEhBU19HTUNIKGRldl9wcml2KSAmJgo+ICsJaWYgKEhBU19HTUNIKGk5MTUpICYmCj4gICAJ
ICAgIHBsYW5lX3N0YXRlLT5iYXNlLnJvdGF0aW9uICYgRFJNX01PREVfUk9UQVRFXzE4MCkKPiAg
IAkJYmFzZSArPSAocGxhbmVfc3RhdGUtPmJhc2UuY3J0Y19oICoKPiAgIAkJCSBwbGFuZV9zdGF0
ZS0+YmFzZS5jcnRjX3cgLSAxKSAqIGZiLT5mb3JtYXQtPmNwcFswXTsKPiBAQCAtMTA1MzIsNyAr
MTA1MzIsNyBAQCBzdGF0aWMgdm9pZCBpODQ1X3VwZGF0ZV9jdXJzb3Ioc3RydWN0IGludGVsX3Bs
YW5lICpwbGFuZSwKPiAgIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSwKPiAgIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUg
KnBsYW5lX3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gICAJdTMyIGNudGwgPSAwLCBiYXNl
ID0gMCwgcG9zID0gMCwgc2l6ZSA9IDA7Cj4gICAJdW5zaWduZWQgbG9uZyBpcnFmbGFnczsKPiAg
IAo+IEBAIC0xMDU0OSw3ICsxMDU0OSw3IEBAIHN0YXRpYyB2b2lkIGk4NDVfdXBkYXRlX2N1cnNv
cihzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ICAgCQlwb3MgPSBpbnRlbF9jdXJzb3JfcG9z
aXRpb24ocGxhbmVfc3RhdGUpOwo+ICAgCX0KPiAgIAo+IC0Jc3Bpbl9sb2NrX2lycXNhdmUoJmRl
dl9wcml2LT51bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ICsJc3Bpbl9sb2NrX2lycXNhdmUoJmk5
MTUtPnVuY29yZS5sb2NrLCBpcnFmbGFncyk7Cj4gICAKPiAgIAkvKiBPbiB0aGVzZSBjaGlwc2V0
cyB3ZSBjYW4gb25seSBtb2RpZnkgdGhlIGJhc2Uvc2l6ZS9zdHJpZGUKPiAgIAkgKiB3aGlsc3Qg
dGhlIGN1cnNvciBpcyBkaXNhYmxlZC4KPiBAQCAtMTA1NzAsNyArMTA1NzAsNyBAQCBzdGF0aWMg
dm9pZCBpODQ1X3VwZGF0ZV9jdXJzb3Ioc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiAgIAkJ
STkxNV9XUklURV9GVyhDVVJQT1MoUElQRV9BKSwgcG9zKTsKPiAgIAl9Cj4gICAKPiAtCXNwaW5f
dW5sb2NrX2lycXJlc3RvcmUoJmRldl9wcml2LT51bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ICsJ
c3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiAg
IH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgaTg0NV9kaXNhYmxlX2N1cnNvcihzdHJ1Y3QgaW50ZWxf
cGxhbmUgKnBsYW5lLAo+IEBAIC0xMDU4MiwxMyArMTA1ODIsMTMgQEAgc3RhdGljIHZvaWQgaTg0
NV9kaXNhYmxlX2N1cnNvcihzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ICAgc3RhdGljIGJv
b2wgaTg0NV9jdXJzb3JfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4g
ICAJCQkJICAgICBlbnVtIHBpcGUgKnBpcGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiAgIAllbnVt
IGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIHBvd2VyX2RvbWFpbjsKPiAgIAlpbnRlbF93YWtl
cmVmX3Qgd2FrZXJlZjsKPiAgIAlib29sIHJldDsKPiAgIAo+ICAgCXBvd2VyX2RvbWFpbiA9IFBP
V0VSX0RPTUFJTl9QSVBFKFBJUEVfQSk7Cj4gLQl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dl
cl9nZXRfaWZfZW5hYmxlZChkZXZfcHJpdiwgcG93ZXJfZG9tYWluKTsKPiArCXdha2VyZWYgPSBp
bnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGk5MTUsIHBvd2VyX2RvbWFpbik7Cj4g
ICAJaWYgKCF3YWtlcmVmKQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gICAKPiBAQCAtMTA1OTYsNyAr
MTA1OTYsNyBAQCBzdGF0aWMgYm9vbCBpODQ1X2N1cnNvcl9nZXRfaHdfc3RhdGUoc3RydWN0IGlu
dGVsX3BsYW5lICpwbGFuZSwKPiAgIAo+ICAgCSpwaXBlID0gUElQRV9BOwo+ICAgCj4gLQlpbnRl
bF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwgcG93ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiAr
CWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5MTUsIHBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4g
ICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+IEBAIC0xMDYxMiwxMCArMTA2MTIsMTAgQEAgaTl4
eF9jdXJzb3JfbWF4X3N0cmlkZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ICAgc3RhdGlj
IHUzMiBpOXh4X2N1cnNvcl9jdGxfY3J0Yyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVs
X2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAl1MzIgY250bCA9
IDA7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQo+ICsJaWYgKElOVEVM
X0dFTihpOTE1KSA+PSAxMSkKPiAgIAkJcmV0dXJuIGNudGw7Cj4gICAKPiAgIAlpZiAoY3J0Y19z
dGF0ZS0+Z2FtbWFfZW5hYmxlKQo+IEBAIC0xMDYyNCw3ICsxMDYyNCw3IEBAIHN0YXRpYyB1MzIg
aTl4eF9jdXJzb3JfY3RsX2NydGMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUpCj4gICAJaWYgKGNydGNfc3RhdGUtPmNzY19lbmFibGUpCj4gICAJCWNudGwgfD0gTUNV
UlNPUl9QSVBFX0NTQ19FTkFCTEU7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwg
NSAmJiAhSVNfRzRYKGRldl9wcml2KSkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA1ICYmICFJ
U19HNFgoaTkxNSkpCj4gICAJCWNudGwgfD0gTUNVUlNPUl9QSVBFX1NFTEVDVChjcnRjLT5waXBl
KTsKPiAgIAo+ICAgCXJldHVybiBjbnRsOwo+IEBAIC0xMDYzMywxMSArMTA2MzMsMTEgQEAgc3Rh
dGljIHUzMiBpOXh4X2N1cnNvcl9jdGxfY3J0Yyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSkKPiAgIHN0YXRpYyB1MzIgaTl4eF9jdXJzb3JfY3RsKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCQkJICAgY29uc3Qgc3RydWN0IGlu
dGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9Cj4g
ICAJCXRvX2k5MTUocGxhbmVfc3RhdGUtPmJhc2UucGxhbmUtPmRldik7Cj4gICAJdTMyIGNudGwg
PSAwOwo+ICAgCj4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCA2KSB8fCBJU19JVllCUklER0UoZGV2
X3ByaXYpKQo+ICsJaWYgKElTX0dFTihpOTE1LCA2KSB8fCBJU19JVllCUklER0UoaTkxNSkpCj4g
ICAJCWNudGwgfD0gTUNVUlNPUl9UUklDS0xFX0ZFRURfRElTQUJMRTsKPiAgIAo+ICAgCXN3aXRj
aCAocGxhbmVfc3RhdGUtPmJhc2UuY3J0Y193KSB7Cj4gQEAgLTEwNjYzLDcgKzEwNjYzLDcgQEAg
c3RhdGljIHUzMiBpOXh4X2N1cnNvcl9jdGwoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUsCj4gICAKPiAgIHN0YXRpYyBib29sIGk5eHhfY3Vyc29yX3NpemVfb2soY29u
c3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPiAgIHsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9Cj4gICAJCXRvX2k5MTUocGxhbmVfc3RhdGUtPmJhc2UucGxhbmUtPmRldik7Cj4g
ICAJaW50IHdpZHRoID0gcGxhbmVfc3RhdGUtPmJhc2UuY3J0Y193Owo+ICAgCWludCBoZWlnaHQg
PSBwbGFuZV9zdGF0ZS0+YmFzZS5jcnRjX2g7Cj4gQEAgLTEwNjg3LDcgKzEwNjg3LDcgQEAgc3Rh
dGljIGJvb2wgaTl4eF9jdXJzb3Jfc2l6ZV9vayhjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3Rh
dGUgKnBsYW5lX3N0YXRlKQo+ICAgCSAqIGN1cnNvciBpcyBub3Qgcm90YXRlZC4gRXZlcnl0aGlu
ZyBlbHNlIHJlcXVpcmVzIHNxdWFyZQo+ICAgCSAqIGN1cnNvcnMuCj4gICAJICovCj4gLQlpZiAo
SEFTX0NVUl9GQkMoZGV2X3ByaXYpICYmCj4gKwlpZiAoSEFTX0NVUl9GQkMoaTkxNSkgJiYKPiAg
IAkgICAgcGxhbmVfc3RhdGUtPmJhc2Uucm90YXRpb24gJiBEUk1fTU9ERV9ST1RBVEVfMCkgewo+
ICAgCQlpZiAoaGVpZ2h0IDwgOCB8fCBoZWlnaHQgPiB3aWR0aCkKPiAgIAkJCXJldHVybiBmYWxz
ZTsKPiBAQCAtMTA3MDMsNyArMTA3MDMsNyBAQCBzdGF0aWMgaW50IGk5eHhfY2hlY2tfY3Vyc29y
KHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCQkJICAgICBzdHJ1Y3Qg
aW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9w
bGFuZSAqcGxhbmUgPSB0b19pbnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZSk7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5lLT5iYXNl
LmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUocGxhbmUt
PmJhc2UuZGV2KTsKPiAgIAljb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IHBsYW5l
X3N0YXRlLT5iYXNlLmZiOwo+ICAgCWVudW0gcGlwZSBwaXBlID0gcGxhbmUtPnBpcGU7Cj4gICAJ
aW50IHJldDsKPiBAQCAtMTA3NDMsNyArMTA3NDMsNyBAQCBzdGF0aWMgaW50IGk5eHhfY2hlY2tf
Y3Vyc29yKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCSAqIGRpc3Bs
YXkgcG93ZXIgd2VsbCBtdXN0IGJlIHR1cm5lZCBvZmYgYW5kIG9uIGFnYWluLgo+ICAgCSAqIFJl
ZnVzZSB0aGUgcHV0IHRoZSBjdXJzb3IgaW50byB0aGF0IGNvbXByb21pc2VkIHBvc2l0aW9uLgo+
ICAgCSAqLwo+IC0JaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpICYmIHBpcGUgPT0gUElQRV9D
ICYmCj4gKwlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSAmJiBwaXBlID09IFBJUEVfQyAmJgo+ICAg
CSAgICBwbGFuZV9zdGF0ZS0+YmFzZS52aXNpYmxlICYmIHBsYW5lX3N0YXRlLT5iYXNlLmNydGNf
eCA8IDApIHsKPiAgIAkJRFJNX0RFQlVHX0tNUygiQ0hWIGN1cnNvciBDIG5vdCBhbGxvd2VkIHRv
IHN0cmFkZGxlIHRoZSBsZWZ0IHNjcmVlbiBlZGdlXG4iKTsKPiAgIAkJcmV0dXJuIC1FSU5WQUw7
Cj4gQEAgLTEwNzU4LDcgKzEwNzU4LDcgQEAgc3RhdGljIHZvaWQgaTl4eF91cGRhdGVfY3Vyc29y
KHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gICAJCQkgICAgICAgY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICAJCQkgICAgICAgY29uc3Qgc3RydWN0IGlu
dGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ICAgCWVu
dW0gcGlwZSBwaXBlID0gcGxhbmUtPnBpcGU7Cj4gICAJdTMyIGNudGwgPSAwLCBiYXNlID0gMCwg
cG9zID0gMCwgZmJjX2N0bCA9IDA7Cj4gICAJdW5zaWduZWQgbG9uZyBpcnFmbGFnczsKPiBAQCAt
MTA3NzQsNyArMTA3NzQsNyBAQCBzdGF0aWMgdm9pZCBpOXh4X3VwZGF0ZV9jdXJzb3Ioc3RydWN0
IGludGVsX3BsYW5lICpwbGFuZSwKPiAgIAkJcG9zID0gaW50ZWxfY3Vyc29yX3Bvc2l0aW9uKHBs
YW5lX3N0YXRlKTsKPiAgIAl9Cj4gICAKPiAtCXNwaW5fbG9ja19pcnFzYXZlKCZkZXZfcHJpdi0+
dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiArCXNwaW5fbG9ja19pcnFzYXZlKCZpOTE1LT51bmNv
cmUubG9jaywgaXJxZmxhZ3MpOwo+ICAgCj4gICAJLyoKPiAgIAkgKiBPbiBzb21lIHBsYXRmb3Jt
cyB3cml0aW5nIENVUkNOVFIgZmlyc3Qgd2lsbCBhbHNvCj4gQEAgLTEwNzk2LDEzICsxMDc5Niwx
MyBAQCBzdGF0aWMgdm9pZCBpOXh4X3VwZGF0ZV9jdXJzb3Ioc3RydWN0IGludGVsX3BsYW5lICpw
bGFuZSwKPiAgIAkgKiB0aGUgQ1VSQ05UUiB3cml0ZSBhcm1zIHRoZSB1cGRhdGUuCj4gICAJICov
Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gKwlpZiAoSU5URUxfR0VO
KGk5MTUpID49IDkpCj4gICAJCXNrbF93cml0ZV9jdXJzb3Jfd20ocGxhbmUsIGNydGNfc3RhdGUp
Owo+ICAgCj4gICAJaWYgKHBsYW5lLT5jdXJzb3IuYmFzZSAhPSBiYXNlIHx8Cj4gICAJICAgIHBs
YW5lLT5jdXJzb3Iuc2l6ZSAhPSBmYmNfY3RsIHx8Cj4gICAJICAgIHBsYW5lLT5jdXJzb3IuY250
bCAhPSBjbnRsKSB7Cj4gLQkJaWYgKEhBU19DVVJfRkJDKGRldl9wcml2KSkKPiArCQlpZiAoSEFT
X0NVUl9GQkMoaTkxNSkpCj4gICAJCQlJOTE1X1dSSVRFX0ZXKENVUl9GQkNfQ1RMKHBpcGUpLCBm
YmNfY3RsKTsKPiAgIAkJSTkxNV9XUklURV9GVyhDVVJDTlRSKHBpcGUpLCBjbnRsKTsKPiAgIAkJ
STkxNV9XUklURV9GVyhDVVJQT1MocGlwZSksIHBvcyk7Cj4gQEAgLTEwODE2LDcgKzEwODE2LDcg
QEAgc3RhdGljIHZvaWQgaTl4eF91cGRhdGVfY3Vyc29yKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxh
bmUsCj4gICAJCUk5MTVfV1JJVEVfRlcoQ1VSQkFTRShwaXBlKSwgYmFzZSk7Cj4gICAJfQo+ICAg
Cj4gLQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZkZXZfcHJpdi0+dW5jb3JlLmxvY2ssIGlycWZs
YWdzKTsKPiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPnVuY29yZS5sb2NrLCBpcnFm
bGFncyk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIGk5eHhfZGlzYWJsZV9jdXJzb3Ioc3Ry
dWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiBAQCAtMTA4MjgsNyArMTA4MjgsNyBAQCBzdGF0aWMg
dm9pZCBpOXh4X2Rpc2FibGVfY3Vyc29yKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gICBz
dGF0aWMgYm9vbCBpOXh4X2N1cnNvcl9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVsX3BsYW5lICpw
bGFuZSwKPiAgIAkJCQkgICAgIGVudW0gcGlwZSAqcGlwZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+
ICAgCWVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gcG93ZXJfZG9tYWluOwo+ICAgCWlu
dGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICAgCWJvb2wgcmV0Owo+IEBAIC0xMDg0MCw3ICsxMDg0
MCw3IEBAIHN0YXRpYyBib29sIGk5eHhfY3Vyc29yX2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxf
cGxhbmUgKnBsYW5lLAo+ICAgCSAqIGRpc3BsYXkgcG93ZXIgd2VsbHMuCj4gICAJICovCj4gICAJ
cG93ZXJfZG9tYWluID0gUE9XRVJfRE9NQUlOX1BJUEUocGxhbmUtPnBpcGUpOwo+IC0Jd2FrZXJl
ZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2X3ByaXYsIHBvd2VyX2Rv
bWFpbik7Cj4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChp
OTE1LCBwb3dlcl9kb21haW4pOwo+ICAgCWlmICghd2FrZXJlZikKPiAgIAkJcmV0dXJuIGZhbHNl
Owo+ICAgCj4gQEAgLTEwODQ4LDEzICsxMDg0OCwxMyBAQCBzdGF0aWMgYm9vbCBpOXh4X2N1cnNv
cl9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiAgIAo+ICAgCXJldCA9
IHZhbCAmIE1DVVJTT1JfTU9ERTsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0g
NSB8fCBJU19HNFgoZGV2X3ByaXYpKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA1IHx8IElT
X0c0WChpOTE1KSkKPiAgIAkJKnBpcGUgPSBwbGFuZS0+cGlwZTsKPiAgIAllbHNlCj4gICAJCSpw
aXBlID0gKHZhbCAmIE1DVVJTT1JfUElQRV9TRUxFQ1RfTUFTSykgPj4KPiAgIAkJCU1DVVJTT1Jf
UElQRV9TRUxFQ1RfU0hJRlQ7Cj4gICAKPiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9w
cml2LCBwb3dlcl9kb21haW4sIHdha2VyZWYpOwo+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQo
aTkxNSwgcG93ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiAgIAo+ICAgCXJldHVybiByZXQ7Cj4gICB9
Cj4gQEAgLTEwOTI0LDcgKzEwOTI0LDcgQEAgaW50IGludGVsX2dldF9sb2FkX2RldGVjdF9waXBl
KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCj4gICAJc3RydWN0IGRybV9lbmNvZGVy
ICplbmNvZGVyID0gJmludGVsX2VuY29kZXItPmJhc2U7Cj4gICAJc3RydWN0IGRybV9jcnRjICpj
cnRjID0gTlVMTDsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gZW5jb2Rlci0+ZGV2Owo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJc3RydWN0
IGRybV9tb2RlX2NvbmZpZyAqY29uZmlnID0gJmRldi0+bW9kZV9jb25maWc7Cj4gICAJc3RydWN0
IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0gTlVMTCwgKnJlc3RvcmVfc3RhdGUgPSBOVUxMOwo+
ICAgCXN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uZWN0b3Jfc3RhdGU7Cj4gQEAgLTEx
MDUxLDcgKzExMDUxLDcgQEAgaW50IGludGVsX2dldF9sb2FkX2RldGVjdF9waXBlKHN0cnVjdCBk
cm1fY29ubmVjdG9yICpjb25uZWN0b3IsCj4gICAJZHJtX2F0b21pY19zdGF0ZV9wdXQoc3RhdGUp
Owo+ICAgCj4gICAJLyogbGV0IHRoZSBjb25uZWN0b3IgZ2V0IHRocm91Z2ggb25lIGZ1bGwgY3lj
bGUgYmVmb3JlIHRlc3RpbmcgKi8KPiAtCWludGVsX3dhaXRfZm9yX3ZibGFuayhkZXZfcHJpdiwg
aW50ZWxfY3J0Yy0+cGlwZSk7Cj4gKwlpbnRlbF93YWl0X2Zvcl92YmxhbmsoaTkxNSwgaW50ZWxf
Y3J0Yy0+cGlwZSk7Cj4gICAJcmV0dXJuIHRydWU7Cj4gICAKPiAgIGZhaWw6Cj4gQEAgLTExMDk2
LDE0ICsxMTA5NiwxNCBAQCB2b2lkIGludGVsX3JlbGVhc2VfbG9hZF9kZXRlY3RfcGlwZShzdHJ1
Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+ICAgc3RhdGljIGludCBpOXh4X3BsbF9yZWZj
bGsoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiAgIAkJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXUzMiBkcGxsID0gcGlwZV9jb25maWctPmRwbGxfaHdf
c3RhdGUuZHBsbDsKPiAgIAo+ICAgCWlmICgoZHBsbCAmIFBMTF9SRUZfSU5QVVRfTUFTSykgPT0g
UExMQl9SRUZfSU5QVVRfU1BSRUFEU1BFQ1RSVU1JTikKPiAtCQlyZXR1cm4gZGV2X3ByaXYtPnZi
dC5sdmRzX3NzY19mcmVxOwo+IC0JZWxzZSBpZiAoSEFTX1BDSF9TUExJVChkZXZfcHJpdikpCj4g
KwkJcmV0dXJuIGk5MTUtPnZidC5sdmRzX3NzY19mcmVxOwo+ICsJZWxzZSBpZiAoSEFTX1BDSF9T
UExJVChpOTE1KSkKPiAgIAkJcmV0dXJuIDEyMDAwMDsKPiAtCWVsc2UgaWYgKCFJU19HRU4oZGV2
X3ByaXYsIDIpKQo+ICsJZWxzZSBpZiAoIUlTX0dFTihpOTE1LCAyKSkKPiAgIAkJcmV0dXJuIDk2
MDAwOwo+ICAgCWVsc2UKPiAgIAkJcmV0dXJuIDQ4MDAwOwo+IEBAIC0xMTExNCw3ICsxMTExNCw3
IEBAIHN0YXRpYyB2b2lkIGk5eHhfY3J0Y19jbG9ja19nZXQoc3RydWN0IGludGVsX2NydGMgKmNy
dGMsCj4gICAJCQkJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ICAgewo+
ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5iYXNlLmRldjsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCWludCBwaXBlID0gcGlwZV9j
b25maWctPmNwdV90cmFuc2NvZGVyOwo+ICAgCXUzMiBkcGxsID0gcGlwZV9jb25maWctPmRwbGxf
aHdfc3RhdGUuZHBsbDsKPiAgIAl1MzIgZnA7Cj4gQEAgLTExMTI4LDcgKzExMTI4LDcgQEAgc3Rh
dGljIHZvaWQgaTl4eF9jcnRjX2Nsb2NrX2dldChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAg
IAkJZnAgPSBwaXBlX2NvbmZpZy0+ZHBsbF9od19zdGF0ZS5mcDE7Cj4gICAKPiAgIAljbG9jay5t
MSA9IChmcCAmIEZQX00xX0RJVl9NQVNLKSA+PiBGUF9NMV9ESVZfU0hJRlQ7Cj4gLQlpZiAoSVNf
UElORVZJRVcoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfUElORVZJRVcoaTkxNSkpIHsKPiAgIAkJ
Y2xvY2subiA9IGZmcygoZnAgJiBGUF9OX1BJTkVWSUVXX0RJVl9NQVNLKSA+PiBGUF9OX0RJVl9T
SElGVCkgLSAxOwo+ICAgCQljbG9jay5tMiA9IChmcCAmIEZQX00yX1BJTkVWSUVXX0RJVl9NQVNL
KSA+PiBGUF9NMl9ESVZfU0hJRlQ7Cj4gICAJfSBlbHNlIHsKPiBAQCAtMTExMzYsOCArMTExMzYs
OCBAQCBzdGF0aWMgdm9pZCBpOXh4X2NydGNfY2xvY2tfZ2V0KHN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjLAo+ICAgCQljbG9jay5tMiA9IChmcCAmIEZQX00yX0RJVl9NQVNLKSA+PiBGUF9NMl9ESVZf
U0hJRlQ7Cj4gICAJfQo+ICAgCj4gLQlpZiAoIUlTX0dFTihkZXZfcHJpdiwgMikpIHsKPiAtCQlp
ZiAoSVNfUElORVZJRVcoZGV2X3ByaXYpKQo+ICsJaWYgKCFJU19HRU4oaTkxNSwgMikpIHsKPiAr
CQlpZiAoSVNfUElORVZJRVcoaTkxNSkpCj4gICAJCQljbG9jay5wMSA9IGZmcygoZHBsbCAmIERQ
TExfRlBBMDFfUDFfUE9TVF9ESVZfTUFTS19QSU5FVklFVykgPj4KPiAgIAkJCQlEUExMX0ZQQTAx
X1AxX1BPU1RfRElWX1NISUZUX1BJTkVWSUVXKTsKPiAgIAkJZWxzZQo+IEBAIC0xMTE1OSwxMiAr
MTExNTksMTIgQEAgc3RhdGljIHZvaWQgaTl4eF9jcnRjX2Nsb2NrX2dldChzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YywKPiAgIAkJCXJldHVybjsKPiAgIAkJfQo+ICAgCj4gLQkJaWYgKElTX1BJTkVW
SUVXKGRldl9wcml2KSkKPiArCQlpZiAoSVNfUElORVZJRVcoaTkxNSkpCj4gICAJCQlwb3J0X2Ns
b2NrID0gcG52X2NhbGNfZHBsbF9wYXJhbXMocmVmY2xrLCAmY2xvY2spOwo+ICAgCQllbHNlCj4g
ICAJCQlwb3J0X2Nsb2NrID0gaTl4eF9jYWxjX2RwbGxfcGFyYW1zKHJlZmNsaywgJmNsb2NrKTsK
PiAgIAl9IGVsc2Ugewo+IC0JCXUzMiBsdmRzID0gSVNfSTgzMChkZXZfcHJpdikgPyAwIDogSTkx
NV9SRUFEKExWRFMpOwo+ICsJCXUzMiBsdmRzID0gSVNfSTgzMChpOTE1KSA/IDAgOiBJOTE1X1JF
QUQoTFZEUyk7Cj4gICAJCWJvb2wgaXNfbHZkcyA9IChwaXBlID09IDEpICYmIChsdmRzICYgTFZE
U19QT1JUX0VOKTsKPiAgIAo+ICAgCQlpZiAoaXNfbHZkcykgewo+IEBAIC0xMTIyMSw3ICsxMTIy
MSw3IEBAIGludCBpbnRlbF9kb3RjbG9ja19jYWxjdWxhdGUoaW50IGxpbmtfZnJlcSwKPiAgIHN0
YXRpYyB2b2lkIGlyb25sYWtlX3BjaF9jbG9ja19nZXQoc3RydWN0IGludGVsX2NydGMgKmNydGMs
Cj4gICAJCQkJICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ICAgewo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNl
LmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+
YmFzZS5kZXYpOwo+ICAgCj4gICAJLyogcmVhZCBvdXQgcG9ydF9jbG9jayBmcm9tIHRoZSBEUExM
ICovCj4gICAJaTl4eF9jcnRjX2Nsb2NrX2dldChjcnRjLCBwaXBlX2NvbmZpZyk7Cj4gQEAgLTEx
MjMyLDcgKzExMjMyLDcgQEAgc3RhdGljIHZvaWQgaXJvbmxha2VfcGNoX2Nsb2NrX2dldChzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAkgKiBDYWxjdWxhdGUgb25lIGJhc2VkIG9uIHRoZSBG
REkgY29uZmlndXJhdGlvbi4KPiAgIAkgKi8KPiAgIAlwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3Rl
ZF9tb2RlLmNydGNfY2xvY2sgPQo+IC0JCWludGVsX2RvdGNsb2NrX2NhbGN1bGF0ZShpbnRlbF9m
ZGlfbGlua19mcmVxKGRldl9wcml2LCBwaXBlX2NvbmZpZyksCj4gKwkJaW50ZWxfZG90Y2xvY2tf
Y2FsY3VsYXRlKGludGVsX2ZkaV9saW5rX2ZyZXEoaTkxNSwgcGlwZV9jb25maWcpLAo+ICAgCQkJ
CQkgJnBpcGVfY29uZmlnLT5mZGlfbV9uKTsKPiAgIH0KPiAgIAo+IEBAIC0xMTI0MCw3ICsxMTI0
MCw3IEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX3BjaF9jbG9ja19nZXQoc3RydWN0IGludGVsX2Ny
dGMgKmNydGMsCj4gICBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqCj4gICBpbnRlbF9lbmNvZGVy
X2N1cnJlbnRfbW9kZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIHsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5k
ZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZTsKPiAg
IAlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YzsKPiBAQCAtMTEyNDksNyArMTEyNDksNyBAQCBpbnRlbF9lbmNvZGVyX2N1cnJlbnRfbW9k
ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIAlpZiAoIWVuY29kZXItPmdldF9o
d19zdGF0ZShlbmNvZGVyLCAmcGlwZSkpCj4gICAJCXJldHVybiBOVUxMOwo+ICAgCj4gLQljcnRj
ID0gaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIHBpcGUpOwo+ICsJY3J0YyA9IGlu
dGVsX2dldF9jcnRjX2Zvcl9waXBlKGk5MTUsIHBpcGUpOwo+ICAgCj4gICAJbW9kZSA9IGt6YWxs
b2Moc2l6ZW9mKCptb2RlKSwgR0ZQX0tFUk5FTCk7Cj4gICAJaWYgKCFtb2RlKQo+IEBAIC0xMTI2
Myw3ICsxMTI2Myw3IEBAIGludGVsX2VuY29kZXJfY3VycmVudF9tb2RlKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyKQo+ICAgCj4gICAJY3J0Y19zdGF0ZS0+YmFzZS5jcnRjID0gJmNydGMt
PmJhc2U7Cj4gICAKPiAtCWlmICghZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X3BpcGVfY29uZmlnKGNy
dGMsIGNydGNfc3RhdGUpKSB7Cj4gKwlpZiAoIWk5MTUtPmRpc3BsYXkuZ2V0X3BpcGVfY29uZmln
KGNydGMsIGNydGNfc3RhdGUpKSB7Cj4gICAJCWtmcmVlKGNydGNfc3RhdGUpOwo+ICAgCQlrZnJl
ZShtb2RlKTsKPiAgIAkJcmV0dXJuIE5VTEw7Cj4gQEAgLTExMzM3LDcgKzExMzM3LDcgQEAgaW50
IGludGVsX3BsYW5lX2F0b21pY19jYWxjX2NoYW5nZXMoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKm9sZF9jcnRjX3N0YXQKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9
IHRvX2ludGVsX2NydGMoY3J0Yyk7Cj4gICAJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSA9IHRv
X2ludGVsX3BsYW5lKHBsYW5lX3N0YXRlLT5wbGFuZSk7Cj4gICAJc3RydWN0IGRybV9kZXZpY2Ug
KmRldiA9IGNydGMtPmRldjsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShkZXYpOwo+ICAgCWJvb2wgbW9kZV9jaGFuZ2VkID0gbmVlZHNfbW9kZXNldChjcnRjX3N0YXRl
KTsKPiAgIAlib29sIHdhc19jcnRjX2VuYWJsZWQgPSBvbGRfY3J0Y19zdGF0ZS0+YmFzZS5hY3Rp
dmU7Cj4gICAJYm9vbCBpc19jcnRjX2VuYWJsZWQgPSBjcnRjX3N0YXRlLT5hY3RpdmU7Cj4gQEAg
LTExMzQ1LDcgKzExMzQ1LDcgQEAgaW50IGludGVsX3BsYW5lX2F0b21pY19jYWxjX2NoYW5nZXMo
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXQKPiAgIAlzdHJ1Y3Qg
ZHJtX2ZyYW1lYnVmZmVyICpmYiA9IHBsYW5lX3N0YXRlLT5mYjsKPiAgIAlpbnQgcmV0Owo+ICAg
Cj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5ICYmIHBsYW5lLT5pZCAhPSBQTEFORV9D
VVJTT1IpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSAmJiBwbGFuZS0+aWQgIT0gUExB
TkVfQ1VSU09SKSB7Cj4gICAJCXJldCA9IHNrbF91cGRhdGVfc2NhbGVyX3BsYW5lKAo+ICAgCQkJ
dG9faW50ZWxfY3J0Y19zdGF0ZShjcnRjX3N0YXRlKSwKPiAgIAkJCXRvX2ludGVsX3BsYW5lX3N0
YXRlKHBsYW5lX3N0YXRlKSk7Cj4gQEAgLTExMzk1LDE0ICsxMTM5NSwxNCBAQCBpbnQgaW50ZWxf
cGxhbmVfYXRvbWljX2NhbGNfY2hhbmdlcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
b2xkX2NydGNfc3RhdAo+ICAgCQkJIHR1cm5fb2ZmLCB0dXJuX29uLCBtb2RlX2NoYW5nZWQpOwo+
ICAgCj4gICAJaWYgKHR1cm5fb24pIHsKPiAtCQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDUg
JiYgIUlTX0c0WChkZXZfcHJpdikpCj4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA8IDUgJiYgIUlT
X0c0WChpOTE1KSkKPiAgIAkJCXBpcGVfY29uZmlnLT51cGRhdGVfd21fcHJlID0gdHJ1ZTsKPiAg
IAo+ICAgCQkvKiBtdXN0IGRpc2FibGUgY3hzciBhcm91bmQgcGxhbmUgZW5hYmxlL2Rpc2FibGUg
Ki8KPiAgIAkJaWYgKHBsYW5lLT5pZCAhPSBQTEFORV9DVVJTT1IpCj4gICAJCQlwaXBlX2NvbmZp
Zy0+ZGlzYWJsZV9jeHNyID0gdHJ1ZTsKPiAgIAl9IGVsc2UgaWYgKHR1cm5fb2ZmKSB7Cj4gLQkJ
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA1ICYmICFJU19HNFgoZGV2X3ByaXYpKQo+ICsJCWlm
IChJTlRFTF9HRU4oaTkxNSkgPCA1ICYmICFJU19HNFgoaTkxNSkpCj4gICAJCQlwaXBlX2NvbmZp
Zy0+dXBkYXRlX3dtX3Bvc3QgPSB0cnVlOwo+ICAgCj4gICAJCS8qIG11c3QgZGlzYWJsZSBjeHNy
IGFyb3VuZCBwbGFuZSBlbmFibGUvZGlzYWJsZSAqLwo+IEBAIC0xMTQxMCw3ICsxMTQxMCw3IEBA
IGludCBpbnRlbF9wbGFuZV9hdG9taWNfY2FsY19jaGFuZ2VzKGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0Cj4gICAJCQlwaXBlX2NvbmZpZy0+ZGlzYWJsZV9jeHNy
ID0gdHJ1ZTsKPiAgIAl9IGVsc2UgaWYgKGludGVsX3dtX25lZWRfdXBkYXRlKHRvX2ludGVsX3Bs
YW5lX3N0YXRlKHBsYW5lLT5iYXNlLnN0YXRlKSwKPiAgIAkJCQkJdG9faW50ZWxfcGxhbmVfc3Rh
dGUocGxhbmVfc3RhdGUpKSkgewo+IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNSAmJiAh
SVNfRzRYKGRldl9wcml2KSkgewo+ICsJCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA1ICYmICFJU19H
NFgoaTkxNSkpIHsKPiAgIAkJCS8qIEZJWE1FIGJvbGxvY2tzICovCj4gICAJCQlwaXBlX2NvbmZp
Zy0+dXBkYXRlX3dtX3ByZSA9IHRydWU7Cj4gICAJCQlwaXBlX2NvbmZpZy0+dXBkYXRlX3dtX3Bv
c3QgPSB0cnVlOwo+IEBAIC0xMTQ1NCw4ICsxMTQ1NCw4IEBAIGludCBpbnRlbF9wbGFuZV9hdG9t
aWNfY2FsY19jaGFuZ2VzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19z
dGF0Cj4gICAJICogcGxhbmUsIG5vdCBvbmx5IHNwcml0ZSBwbGFuZS4KPiAgIAkgKi8KPiAgIAlp
ZiAocGxhbmUtPmlkICE9IFBMQU5FX0NVUlNPUiAmJgo+IC0JICAgIChJU19HRU5fUkFOR0UoZGV2
X3ByaXYsIDUsIDYpIHx8Cj4gLQkgICAgIElTX0lWWUJSSURHRShkZXZfcHJpdikpICYmCj4gKwkg
ICAgKElTX0dFTl9SQU5HRShpOTE1LCA1LCA2KSB8fAo+ICsJICAgICBJU19JVllCUklER0UoaTkx
NSkpICYmCj4gICAJICAgICh0dXJuX29uIHx8ICghbmVlZHNfc2NhbGluZyhvbGRfcGxhbmVfc3Rh
dGUpICYmCj4gICAJCQkgbmVlZHNfc2NhbGluZyh0b19pbnRlbF9wbGFuZV9zdGF0ZShwbGFuZV9z
dGF0ZSkpKSkpCj4gICAJCXBpcGVfY29uZmlnLT5kaXNhYmxlX2xwX3dtID0gdHJ1ZTsKPiBAQCAt
MTE1MTksMTMgKzExNTE5LDEzIEBAIHN0YXRpYyBpbnQgaWNsX2FkZF9saW5rZWRfcGxhbmVzKHN0
cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAgc3RhdGljIGludCBpY2xfY2hlY2tf
bnYxMl9wbGFuZXMoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4g
ICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJh
c2UuY3J0Yyk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShjcnRjLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3Rh
dGUgPSB0b19pbnRlbF9hdG9taWNfc3RhdGUoY3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZSk7Cj4gICAJ
c3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwgKmxpbmtlZDsKPiAgIAlzdHJ1Y3QgaW50ZWxfcGxh
bmVfc3RhdGUgKnBsYW5lX3N0YXRlOwo+ICAgCWludCBpOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA8IDExKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8IDExKQo+ICAgCQlyZXR1
cm4gMDsKPiAgIAo+ICAgCS8qCj4gQEAgLTExNTU1LDcgKzExNTU1LDcgQEAgc3RhdGljIGludCBp
Y2xfY2hlY2tfbnYxMl9wbGFuZXMoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUp
Cj4gICAJCSAgICAhKGNydGNfc3RhdGUtPm52MTJfcGxhbmVzICYgQklUKHBsYW5lLT5pZCkpKQo+
ICAgCQkJY29udGludWU7Cj4gICAKPiAtCQlmb3JfZWFjaF9pbnRlbF9wbGFuZV9vbl9jcnRjKCZk
ZXZfcHJpdi0+ZHJtLCBjcnRjLCBsaW5rZWQpIHsKPiArCQlmb3JfZWFjaF9pbnRlbF9wbGFuZV9v
bl9jcnRjKCZpOTE1LT5kcm0sIGNydGMsIGxpbmtlZCkgewo+ICAgCQkJaWYgKCFpY2xfaXNfbnYx
Ml95X3BsYW5lKGxpbmtlZC0+aWQpKQo+ICAgCQkJCWNvbnRpbnVlOwo+ICAgCj4gQEAgLTExNjAy
LDIxICsxMTYwMiwyMSBAQCBzdGF0aWMgYm9vbCBjOF9wbGFuZXNfY2hhbmdlZChjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUpCj4gICBzdGF0aWMgaW50IGludGVs
X2NydGNfYXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKPiAgIAkJCQkgICBzdHJ1
Y3QgZHJtX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+ZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxf
Y3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Yyk7Cj4gICAJc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKnBpcGVfY29uZmlnID0KPiAgIAkJdG9faW50ZWxfY3J0Y19zdGF0ZShjcnRj
X3N0YXRlKTsKPiAgIAlpbnQgcmV0Owo+ICAgCWJvb2wgbW9kZV9jaGFuZ2VkID0gbmVlZHNfbW9k
ZXNldChjcnRjX3N0YXRlKTsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA1ICYm
ICFJU19HNFgoZGV2X3ByaXYpICYmCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgNSAmJiAhSVNf
RzRYKGk5MTUpICYmCj4gICAJICAgIG1vZGVfY2hhbmdlZCAmJiAhY3J0Y19zdGF0ZS0+YWN0aXZl
KQo+ICAgCQlwaXBlX2NvbmZpZy0+dXBkYXRlX3dtX3Bvc3QgPSB0cnVlOwo+ICAgCj4gICAJaWYg
KG1vZGVfY2hhbmdlZCAmJiBjcnRjX3N0YXRlLT5lbmFibGUgJiYKPiAtCSAgICBkZXZfcHJpdi0+
ZGlzcGxheS5jcnRjX2NvbXB1dGVfY2xvY2sgJiYKPiArCSAgICBpOTE1LT5kaXNwbGF5LmNydGNf
Y29tcHV0ZV9jbG9jayAmJgo+ICAgCSAgICAhV0FSTl9PTihwaXBlX2NvbmZpZy0+c2hhcmVkX2Rw
bGwpKSB7Cj4gLQkJcmV0ID0gZGV2X3ByaXYtPmRpc3BsYXkuY3J0Y19jb21wdXRlX2Nsb2NrKGlu
dGVsX2NydGMsCj4gKwkJcmV0ID0gaTkxNS0+ZGlzcGxheS5jcnRjX2NvbXB1dGVfY2xvY2soaW50
ZWxfY3J0YywKPiAgIAkJCQkJCQkgICBwaXBlX2NvbmZpZyk7Cj4gICAJCWlmIChyZXQpCj4gICAJ
CQlyZXR1cm4gcmV0Owo+IEBAIC0xMTYzNywxNiArMTE2MzcsMTYgQEAgc3RhdGljIGludCBpbnRl
bF9jcnRjX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gICAJfQo+ICAgCj4g
ICAJcmV0ID0gMDsKPiAtCWlmIChkZXZfcHJpdi0+ZGlzcGxheS5jb21wdXRlX3BpcGVfd20pIHsK
PiAtCQlyZXQgPSBkZXZfcHJpdi0+ZGlzcGxheS5jb21wdXRlX3BpcGVfd20ocGlwZV9jb25maWcp
Owo+ICsJaWYgKGk5MTUtPmRpc3BsYXkuY29tcHV0ZV9waXBlX3dtKSB7Cj4gKwkJcmV0ID0gaTkx
NS0+ZGlzcGxheS5jb21wdXRlX3BpcGVfd20ocGlwZV9jb25maWcpOwo+ICAgCQlpZiAocmV0KSB7
Cj4gICAJCQlEUk1fREVCVUdfS01TKCJUYXJnZXQgcGlwZSB3YXRlcm1hcmtzIGFyZSBpbnZhbGlk
XG4iKTsKPiAgIAkJCXJldHVybiByZXQ7Cj4gICAJCX0KPiAgIAl9Cj4gICAKPiAtCWlmIChkZXZf
cHJpdi0+ZGlzcGxheS5jb21wdXRlX2ludGVybWVkaWF0ZV93bSkgewo+IC0JCWlmIChXQVJOX09O
KCFkZXZfcHJpdi0+ZGlzcGxheS5jb21wdXRlX3BpcGVfd20pKQo+ICsJaWYgKGk5MTUtPmRpc3Bs
YXkuY29tcHV0ZV9pbnRlcm1lZGlhdGVfd20pIHsKPiArCQlpZiAoV0FSTl9PTighaTkxNS0+ZGlz
cGxheS5jb21wdXRlX3BpcGVfd20pKQo+ICAgCQkJcmV0dXJuIDA7Cj4gICAKPiAgIAkJLyoKPiBA
QCAtMTE2NTQsMTQgKzExNjU0LDE0IEBAIHN0YXRpYyBpbnQgaW50ZWxfY3J0Y19hdG9taWNfY2hl
Y2soc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ICAgCQkgKiBvbGQgc3RhdGUgYW5kIHRoZSBuZXcg
c3RhdGUuICBXZSBjYW4gcHJvZ3JhbSB0aGVzZQo+ICAgCQkgKiBpbW1lZGlhdGVseS4KPiAgIAkJ
ICovCj4gLQkJcmV0ID0gZGV2X3ByaXYtPmRpc3BsYXkuY29tcHV0ZV9pbnRlcm1lZGlhdGVfd20o
cGlwZV9jb25maWcpOwo+ICsJCXJldCA9IGk5MTUtPmRpc3BsYXkuY29tcHV0ZV9pbnRlcm1lZGlh
dGVfd20ocGlwZV9jb25maWcpOwo+ICAgCQlpZiAocmV0KSB7Cj4gICAJCQlEUk1fREVCVUdfS01T
KCJObyB2YWxpZCBpbnRlcm1lZGlhdGUgcGlwZSB3YXRlcm1hcmtzIGFyZSBwb3NzaWJsZVxuIik7
Cj4gICAJCQlyZXR1cm4gcmV0Owo+ICAgCQl9Cj4gICAJfQo+ICAgCj4gLQlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSA5KSB7Cj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkpIHsKPiAgIAkJ
aWYgKG1vZGVfY2hhbmdlZCB8fCBwaXBlX2NvbmZpZy0+dXBkYXRlX3BpcGUpCj4gICAJCQlyZXQg
PSBza2xfdXBkYXRlX3NjYWxlcl9jcnRjKHBpcGVfY29uZmlnKTsKPiAgIAo+IEBAIC0xMTY3MSwx
MSArMTE2NzEsMTEgQEAgc3RhdGljIGludCBpbnRlbF9jcnRjX2F0b21pY19jaGVjayhzdHJ1Y3Qg
ZHJtX2NydGMgKmNydGMsCj4gICAJCQlyZXQgPSBza2xfY2hlY2tfcGlwZV9tYXhfcGl4ZWxfcmF0
ZShpbnRlbF9jcnRjLAo+ICAgCQkJCQkJCSAgICBwaXBlX2NvbmZpZyk7Cj4gICAJCWlmICghcmV0
KQo+IC0JCQlyZXQgPSBpbnRlbF9hdG9taWNfc2V0dXBfc2NhbGVycyhkZXZfcHJpdiwgaW50ZWxf
Y3J0YywKPiArCQkJcmV0ID0gaW50ZWxfYXRvbWljX3NldHVwX3NjYWxlcnMoaTkxNSwgaW50ZWxf
Y3J0YywKPiAgIAkJCQkJCQkgcGlwZV9jb25maWcpOwo+ICAgCX0KPiAgIAo+IC0JaWYgKEhBU19J
UFMoZGV2X3ByaXYpKQo+ICsJaWYgKEhBU19JUFMoaTkxNSkpCj4gICAJCXBpcGVfY29uZmlnLT5p
cHNfZW5hYmxlZCA9IGhzd19jb21wdXRlX2lwc19jb25maWcocGlwZV9jb25maWcpOwo+ICAgCj4g
ICAJcmV0dXJuIHJldDsKPiBAQCAtMTE3NTIsMTYgKzExNzUyLDE2IEBAIHN0YXRpYyBpbnQKPiAg
IGNvbXB1dGVfYmFzZWxpbmVfcGlwZV9icHAoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gICAJ
CQkgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiAgIHsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2
KTsKPiAgIAlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUgPSBwaXBlX2NvbmZpZy0+YmFz
ZS5zdGF0ZTsKPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yOwo+ICAgCXN0cnVj
dCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uZWN0b3Jfc3RhdGU7Cj4gICAJaW50IGJwcCwgaTsK
PiAgIAo+IC0JaWYgKChJU19HNFgoZGV2X3ByaXYpIHx8IElTX1ZBTExFWVZJRVcoZGV2X3ByaXYp
IHx8Cj4gLQkgICAgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpKQo+ICsJaWYgKChJU19HNFgoaTkx
NSkgfHwgSVNfVkFMTEVZVklFVyhpOTE1KSB8fAo+ICsJICAgIElTX0NIRVJSWVZJRVcoaTkxNSkp
KQo+ICAgCQlicHAgPSAxMCozOwo+IC0JZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA1
KQo+ICsJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDUpCj4gICAJCWJwcCA9IDEyKjM7Cj4g
ICAJZWxzZQo+ICAgCQlicHAgPSA4KjM7Cj4gQEAgLTExODA3LDEzICsxMTgwNywxMyBAQCBpbnRl
bF9kdW1wX21fbl9jb25maWcoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29u
ZmlnLAo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZAo+IC1pbnRlbF9kdW1wX2luZm9mcmFtZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2ludGVsX2R1bXBfaW5mb2ZyYW1l
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkgICAgIGNvbnN0IHVuaW9uIGhk
bWlfaW5mb2ZyYW1lICpmcmFtZSkKPiAgIHsKPiAgIAlpZiAoKGRybV9kZWJ1ZyAmIERSTV9VVF9L
TVMpID09IDApCj4gICAJCXJldHVybjsKPiAgIAo+IC0JaGRtaV9pbmZvZnJhbWVfbG9nKEtFUk5f
REVCVUcsIGRldl9wcml2LT5kcm0uZGV2LCBmcmFtZSk7Cj4gKwloZG1pX2luZm9mcmFtZV9sb2co
S0VSTl9ERUJVRywgaTkxNS0+ZHJtLmRldiwgZnJhbWUpOwo+ICAgfQo+ICAgCj4gICAjZGVmaW5l
IE9VVFBVVF9UWVBFKHgpIFtJTlRFTF9PVVRQVVRfICMjIHhdID0gI3gKPiBAQCAtMTE5MDcsNyAr
MTE5MDcsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kdW1wX3BpcGVfY29uZmlnKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKPiAgIAkJCQkgICBjb25zdCBjaGFyICpj
b250ZXh0KQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0
YyhwaXBlX2NvbmZpZy0+YmFzZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAljb25zdCBzdHJ1Y3Qg
aW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlOwo+ICAgCXN0cnVjdCBpbnRlbF9wbGFuZSAq
cGxhbmU7Cj4gICAJY2hhciBidWZbNjRdOwo+IEBAIC0xMTk1MywxMyArMTE5NTMsMTMgQEAgc3Rh
dGljIHZvaWQgaW50ZWxfZHVtcF9waXBlX2NvbmZpZyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqcGlwZV9jb25maWcsCj4gICAJCURSTV9ERUJVR19LTVMoIkdDUDogMHgleFxuIiwgcGlw
ZV9jb25maWctPmluZm9mcmFtZXMuZ2NwKTsKPiAgIAlpZiAocGlwZV9jb25maWctPmluZm9mcmFt
ZXMuZW5hYmxlICYKPiAgIAkgICAgaW50ZWxfaGRtaV9pbmZvZnJhbWVfZW5hYmxlKEhETUlfSU5G
T0ZSQU1FX1RZUEVfQVZJKSkKPiAtCQlpbnRlbF9kdW1wX2luZm9mcmFtZShkZXZfcHJpdiwgJnBp
cGVfY29uZmlnLT5pbmZvZnJhbWVzLmF2aSk7Cj4gKwkJaW50ZWxfZHVtcF9pbmZvZnJhbWUoaTkx
NSwgJnBpcGVfY29uZmlnLT5pbmZvZnJhbWVzLmF2aSk7Cj4gICAJaWYgKHBpcGVfY29uZmlnLT5p
bmZvZnJhbWVzLmVuYWJsZSAmCj4gICAJICAgIGludGVsX2hkbWlfaW5mb2ZyYW1lX2VuYWJsZShI
RE1JX0lORk9GUkFNRV9UWVBFX1NQRCkpCj4gLQkJaW50ZWxfZHVtcF9pbmZvZnJhbWUoZGV2X3By
aXYsICZwaXBlX2NvbmZpZy0+aW5mb2ZyYW1lcy5zcGQpOwo+ICsJCWludGVsX2R1bXBfaW5mb2Zy
YW1lKGk5MTUsICZwaXBlX2NvbmZpZy0+aW5mb2ZyYW1lcy5zcGQpOwo+ICAgCWlmIChwaXBlX2Nv
bmZpZy0+aW5mb2ZyYW1lcy5lbmFibGUgJgo+ICAgCSAgICBpbnRlbF9oZG1pX2luZm9mcmFtZV9l
bmFibGUoSERNSV9JTkZPRlJBTUVfVFlQRV9WRU5ET1IpKQo+IC0JCWludGVsX2R1bXBfaW5mb2Zy
YW1lKGRldl9wcml2LCAmcGlwZV9jb25maWctPmluZm9mcmFtZXMuaGRtaSk7Cj4gKwkJaW50ZWxf
ZHVtcF9pbmZvZnJhbWUoaTkxNSwgJnBpcGVfY29uZmlnLT5pbmZvZnJhbWVzLmhkbWkpOwo+ICAg
Cj4gICAJRFJNX0RFQlVHX0tNUygicmVxdWVzdGVkIG1vZGU6XG4iKTsKPiAgIAlkcm1fbW9kZV9k
ZWJ1Z19wcmludG1vZGVsaW5lKCZwaXBlX2NvbmZpZy0+YmFzZS5tb2RlKTsKPiBAQCAtMTE5NzEs
MTMgKzExOTcxLDEzIEBAIHN0YXRpYyB2b2lkIGludGVsX2R1bXBfcGlwZV9jb25maWcoY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ICAgCQkgICAgICBwaXBlX2Nv
bmZpZy0+cGlwZV9zcmNfdywgcGlwZV9jb25maWctPnBpcGVfc3JjX2gsCj4gICAJCSAgICAgIHBp
cGVfY29uZmlnLT5waXhlbF9yYXRlKTsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gOSkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkKPiAgIAkJRFJNX0RFQlVHX0tNUygi
bnVtX3NjYWxlcnM6ICVkLCBzY2FsZXJfdXNlcnM6IDB4JXgsIHNjYWxlcl9pZDogJWRcbiIsCj4g
ICAJCQkgICAgICBjcnRjLT5udW1fc2NhbGVycywKPiAgIAkJCSAgICAgIHBpcGVfY29uZmlnLT5z
Y2FsZXJfc3RhdGUuc2NhbGVyX3VzZXJzLAo+ICAgCQkgICAgICAgICAgICAgIHBpcGVfY29uZmln
LT5zY2FsZXJfc3RhdGUuc2NhbGVyX2lkKTsKPiAgIAo+IC0JaWYgKEhBU19HTUNIKGRldl9wcml2
KSkKPiArCWlmIChIQVNfR01DSChpOTE1KSkKPiAgIAkJRFJNX0RFQlVHX0tNUygiZ21jaCBwZml0
OiBjb250cm9sOiAweCUwOHgsIHJhdGlvczogMHglMDh4LCBsdmRzIGJvcmRlcjogMHglMDh4XG4i
LAo+ICAgCQkJICAgICAgcGlwZV9jb25maWctPmdtY2hfcGZpdC5jb250cm9sLAo+ICAgCQkJICAg
ICAgcGlwZV9jb25maWctPmdtY2hfcGZpdC5wZ21fcmF0aW9zLAo+IEBAIC0xMTk5Miw3ICsxMTk5
Miw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2R1bXBfcGlwZV9jb25maWcoY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ICAgCURSTV9ERUJVR19LTVMoImlwczogJWks
IGRvdWJsZSB3aWRlOiAlaVxuIiwKPiAgIAkJICAgICAgcGlwZV9jb25maWctPmlwc19lbmFibGVk
LCBwaXBlX2NvbmZpZy0+ZG91YmxlX3dpZGUpOwo+ICAgCj4gLQlpbnRlbF9kcGxsX2R1bXBfaHdf
c3RhdGUoZGV2X3ByaXYsICZwaXBlX2NvbmZpZy0+ZHBsbF9od19zdGF0ZSk7Cj4gKwlpbnRlbF9k
cGxsX2R1bXBfaHdfc3RhdGUoaTkxNSwgJnBpcGVfY29uZmlnLT5kcGxsX2h3X3N0YXRlKTsKPiAg
IAo+ICAgZHVtcF9wbGFuZXM6Cj4gICAJaWYgKCFzdGF0ZSkKPiBAQCAtMTIwNzMsNyArMTIwNzMs
NyBAQCBzdGF0aWMgYm9vbCBjaGVja19kaWdpdGFsX3BvcnRfY29uZmxpY3RzKHN0cnVjdCBpbnRl
bF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAgc3RhdGljIGludAo+ICAgY2xlYXJfaW50ZWxfY3J0
Y19zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9Cj4gICAJCXRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+
ICAgCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpzYXZlZF9zdGF0ZTsKPiAgIAo+IEBAIC0xMjA5
MCw4ICsxMjA5MCw4IEBAIGNsZWFyX2ludGVsX2NydGNfc3RhdGUoc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCj4gICAJc2F2ZWRfc3RhdGUtPnNoYXJlZF9kcGxsID0gY3J0Y19z
dGF0ZS0+c2hhcmVkX2RwbGw7Cj4gICAJc2F2ZWRfc3RhdGUtPmRwbGxfaHdfc3RhdGUgPSBjcnRj
X3N0YXRlLT5kcGxsX2h3X3N0YXRlOwo+ICAgCXNhdmVkX3N0YXRlLT5jcmNfZW5hYmxlZCA9IGNy
dGNfc3RhdGUtPmNyY19lbmFibGVkOwo+IC0JaWYgKElTX0c0WChkZXZfcHJpdikgfHwKPiAtCSAg
ICBJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiAr
CWlmIChJU19HNFgoaTkxNSkgfHwKPiArCSAgICBJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NI
RVJSWVZJRVcoaTkxNSkpCj4gICAJCXNhdmVkX3N0YXRlLT53bSA9IGNydGNfc3RhdGUtPndtOwo+
ICAgCj4gICAJLyogS2VlcCBiYXNlIGRybV9jcnRjX3N0YXRlIGludGFjdCwgb25seSBjbGVhciBv
dXIgZXh0ZW5kZWQgc3RydWN0ICovCj4gQEAgLTEyMzE2LDcgKzEyMzE2LDcgQEAgaW50ZWxfY29t
cGFyZV9pbmZvZnJhbWUoY29uc3QgdW5pb24gaGRtaV9pbmZvZnJhbWUgKmEsCj4gICB9Cj4gICAK
PiAgIHN0YXRpYyB2b2lkCj4gLXBpcGVfY29uZmlnX2luZm9mcmFtZV9lcnIoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtwaXBlX2NvbmZpZ19pbmZvZnJhbWVfZXJyKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICBib29sIGFkanVzdCwgY29uc3QgY2hh
ciAqbmFtZSwKPiAgIAkJCSAgY29uc3QgdW5pb24gaGRtaV9pbmZvZnJhbWUgKmEsCj4gICAJCQkg
IGNvbnN0IHVuaW9uIGhkbWlfaW5mb2ZyYW1lICpiKQo+IEBAIC0xMjMyNywxNSArMTIzMjcsMTUg
QEAgcGlwZV9jb25maWdfaW5mb2ZyYW1lX2VycihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gICAKPiAgIAkJZHJtX2RiZyhEUk1fVVRfS01TLCAibWlzbWF0Y2ggaW4gJXMgaW5m
b2ZyYW1lIiwgbmFtZSk7Cj4gICAJCWRybV9kYmcoRFJNX1VUX0tNUywgImV4cGVjdGVkOiIpOwo+
IC0JCWhkbWlfaW5mb2ZyYW1lX2xvZyhLRVJOX0RFQlVHLCBkZXZfcHJpdi0+ZHJtLmRldiwgYSk7
Cj4gKwkJaGRtaV9pbmZvZnJhbWVfbG9nKEtFUk5fREVCVUcsIGk5MTUtPmRybS5kZXYsIGEpOwo+
ICAgCQlkcm1fZGJnKERSTV9VVF9LTVMsICJmb3VuZCIpOwo+IC0JCWhkbWlfaW5mb2ZyYW1lX2xv
ZyhLRVJOX0RFQlVHLCBkZXZfcHJpdi0+ZHJtLmRldiwgYik7Cj4gKwkJaGRtaV9pbmZvZnJhbWVf
bG9nKEtFUk5fREVCVUcsIGk5MTUtPmRybS5kZXYsIGIpOwo+ICAgCX0gZWxzZSB7Cj4gICAJCWRy
bV9lcnIoIm1pc21hdGNoIGluICVzIGluZm9mcmFtZSIsIG5hbWUpOwo+ICAgCQlkcm1fZXJyKCJl
eHBlY3RlZDoiKTsKPiAtCQloZG1pX2luZm9mcmFtZV9sb2coS0VSTl9FUlIsIGRldl9wcml2LT5k
cm0uZGV2LCBhKTsKPiArCQloZG1pX2luZm9mcmFtZV9sb2coS0VSTl9FUlIsIGk5MTUtPmRybS5k
ZXYsIGEpOwo+ICAgCQlkcm1fZXJyKCJmb3VuZCIpOwo+IC0JCWhkbWlfaW5mb2ZyYW1lX2xvZyhL
RVJOX0VSUiwgZGV2X3ByaXYtPmRybS5kZXYsIGIpOwo+ICsJCWhkbWlfaW5mb2ZyYW1lX2xvZyhL
RVJOX0VSUiwgaTkxNS0+ZHJtLmRldiwgYik7Cj4gICAJfQo+ICAgfQo+ICAgCj4gQEAgLTEyMzU3
LDE3ICsxMjM1NywxNyBAQCBwaXBlX2NvbmZpZ19lcnIoYm9vbCBhZGp1c3QsIGNvbnN0IGNoYXIg
Km5hbWUsIGNvbnN0IGNoYXIgKmZvcm1hdCwgLi4uKQo+ICAgCXZhX2VuZChhcmdzKTsKPiAgIH0K
PiAgIAo+IC1zdGF0aWMgYm9vbCBmYXN0Ym9vdF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiArc3RhdGljIGJvb2wgZmFzdGJvb3RfZW5hYmxlZChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAlpZiAoaTkxNV9tb2RwYXJhbXMuZmFzdGJv
b3QgIT0gLTEpCj4gICAJCXJldHVybiBpOTE1X21vZHBhcmFtcy5mYXN0Ym9vdDsKPiAgIAo+ICAg
CS8qIEVuYWJsZSBmYXN0Ym9vdCBieSBkZWZhdWx0IG9uIFNreWxha2UgYW5kIG5ld2VyICovCj4g
LQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+
PSA5KQo+ICAgCQlyZXR1cm4gdHJ1ZTsKPiAgIAo+ICAgCS8qIEVuYWJsZSBmYXN0Ym9vdCBieSBk
ZWZhdWx0IG9uIFZMViBhbmQgQ0hWICovCj4gLQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikg
fHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gKwlpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8
fCBJU19DSEVSUllWSUVXKGk5MTUpKQo+ICAgCQlyZXR1cm4gdHJ1ZTsKPiAgIAo+ICAgCS8qIERp
c2FibGVkIGJ5IGRlZmF1bHQgb24gYWxsIG90aGVycyAqLwo+IEBAIC0xMjM3NSw3ICsxMjM3NSw3
IEBAIHN0YXRpYyBib29sIGZhc3Rib290X2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICAgfQo+ICAgCj4gICBzdGF0aWMgYm9vbAo+IC1pbnRlbF9waXBlX2NvbmZp
Z19jb21wYXJlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAraW50ZWxfcGlw
ZV9jb25maWdfY29tcGFyZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmN1cnJlbnRfY29uZmlnLAo+ICAgCQkJICBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4gICAJCQkgIGJvb2wgYWRqdXN0KQo+IEBA
IC0xMjM4NSw3ICsxMjM4NSw3IEBAIGludGVsX3BpcGVfY29uZmlnX2NvbXBhcmUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCQkoY3VycmVudF9jb25maWctPmJhc2UubW9k
ZS5wcml2YXRlX2ZsYWdzICYgSTkxNV9NT0RFX0ZMQUdfSU5IRVJJVEVEKSAmJgo+ICAgCQkhKHBp
cGVfY29uZmlnLT5iYXNlLm1vZGUucHJpdmF0ZV9mbGFncyAmIEk5MTVfTU9ERV9GTEFHX0lOSEVS
SVRFRCk7Cj4gICAKPiAtCWlmIChmaXh1cF9pbmhlcml0ZWQgJiYgIWZhc3Rib290X2VuYWJsZWQo
ZGV2X3ByaXYpKSB7Cj4gKwlpZiAoZml4dXBfaW5oZXJpdGVkICYmICFmYXN0Ym9vdF9lbmFibGVk
KGk5MTUpKSB7Cj4gICAJCURSTV9ERUJVR19LTVMoImluaXRpYWwgbW9kZXNldCBhbmQgZmFzdGJv
b3Qgbm90IHNldFxuIik7Cj4gICAJCXJldCA9IGZhbHNlOwo+ICAgCX0KPiBAQCAtMTI1MjUsNyAr
MTI1MjUsNyBAQCBpbnRlbF9waXBlX2NvbmZpZ19jb21wYXJlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiAgICNkZWZpbmUgUElQRV9DT05GX0NIRUNLX0lORk9GUkFNRShuYW1l
KSBkbyB7IFwKPiAgIAlpZiAoIWludGVsX2NvbXBhcmVfaW5mb2ZyYW1lKCZjdXJyZW50X2NvbmZp
Zy0+aW5mb2ZyYW1lcy5uYW1lLCBcCj4gICAJCQkJICAgICAmcGlwZV9jb25maWctPmluZm9mcmFt
ZXMubmFtZSkpIHsgXAo+IC0JCXBpcGVfY29uZmlnX2luZm9mcmFtZV9lcnIoZGV2X3ByaXYsIGFk
anVzdCwgX19zdHJpbmdpZnkobmFtZSksIFwKPiArCQlwaXBlX2NvbmZpZ19pbmZvZnJhbWVfZXJy
KGk5MTUsIGFkanVzdCwgX19zdHJpbmdpZnkobmFtZSksIFwKPiAgIAkJCQkJICAmY3VycmVudF9j
b25maWctPmluZm9mcmFtZXMubmFtZSwgXAo+ICAgCQkJCQkgICZwaXBlX2NvbmZpZy0+aW5mb2Zy
YW1lcy5uYW1lKTsgXAo+ICAgCQlyZXQgPSBmYWxzZTsgXAo+IEBAIC0xMjU0NCw3ICsxMjU0NCw3
IEBAIGludGVsX3BpcGVfY29uZmlnX2NvbXBhcmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ICAgCVBJUEVfQ09ORl9DSEVDS19JKGxhbmVfY291bnQpOwo+ICAgCVBJUEVfQ09O
Rl9DSEVDS19YKGxhbmVfbGF0X29wdGltX21hc2spOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRl
dl9wcml2KSA8IDgpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA4KSB7Cj4gICAJCVBJUEVf
Q09ORl9DSEVDS19NX04oZHBfbV9uKTsKPiAgIAo+ICAgCQlpZiAoY3VycmVudF9jb25maWctPmhh
c19kcnJzKQo+IEBAIC0xMjU3MSw4ICsxMjU3MSw4IEBAIGludGVsX3BpcGVfY29uZmlnX2NvbXBh
cmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCVBJUEVfQ09ORl9DSEVD
S19JKHBpeGVsX211bHRpcGxpZXIpOwo+ICAgCVBJUEVfQ09ORl9DSEVDS19JKG91dHB1dF9mb3Jt
YXQpOwo+ICAgCVBJUEVfQ09ORl9DSEVDS19CT09MKGhhc19oZG1pX3NpbmspOwo+IC0JaWYgKChJ
TlRFTF9HRU4oZGV2X3ByaXYpIDwgOCAmJiAhSVNfSEFTV0VMTChkZXZfcHJpdikpIHx8Cj4gLQkg
ICAgSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4g
KwlpZiAoKElOVEVMX0dFTihpOTE1KSA8IDggJiYgIUlTX0hBU1dFTEwoaTkxNSkpIHx8Cj4gKwkg
ICAgSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKQo+ICAgCQlQSVBF
X0NPTkZfQ0hFQ0tfQk9PTChsaW1pdGVkX2NvbG9yX3JhbmdlKTsKPiAgIAo+ICAgCVBJUEVfQ09O
Rl9DSEVDS19CT09MKGhkbWlfc2NyYW1ibGluZyk7Cj4gQEAgLTEyNTk3LDcgKzEyNTk3LDcgQEAg
aW50ZWxfcGlwZV9jb25maWdfY29tcGFyZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gICAKPiAgIAlQSVBFX0NPTkZfQ0hFQ0tfWChnbWNoX3BmaXQuY29udHJvbCk7Cj4gICAJ
LyogcGZpdCByYXRpb3MgYXJlIGF1dG9jb21wdXRlZCBieSB0aGUgaHcgb24gZ2VuNCsgKi8KPiAt
CWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNCkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA0
KQo+ICAgCQlQSVBFX0NPTkZfQ0hFQ0tfWChnbWNoX3BmaXQucGdtX3JhdGlvcyk7Cj4gICAJUElQ
RV9DT05GX0NIRUNLX1goZ21jaF9wZml0Lmx2ZHNfYm9yZGVyX2JpdHMpOwo+ICAgCj4gQEAgLTEy
NjIxLDcgKzEyNjIxLDcgQEAgaW50ZWxfcGlwZV9jb25maWdfY29tcGFyZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJCVBJUEVfQ09ORl9DSEVDS19DTE9DS19GVVpaWShw
aXhlbF9yYXRlKTsKPiAgIAo+ICAgCQlQSVBFX0NPTkZfQ0hFQ0tfWChnYW1tYV9tb2RlKTsKPiAt
CQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gKwkJaWYgKElTX0NIRVJSWVZJRVcoaTkx
NSkpCj4gICAJCQlQSVBFX0NPTkZfQ0hFQ0tfWChjZ21fbW9kZSk7Cj4gICAJCWVsc2UKPiAgIAkJ
CVBJUEVfQ09ORl9DSEVDS19YKGNzY19tb2RlKTsKPiBAQCAtMTI2NjcsNyArMTI2NjcsNyBAQCBp
bnRlbF9waXBlX2NvbmZpZ19jb21wYXJlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiAgIAlQSVBFX0NPTkZfQ0hFQ0tfWChkc2lfcGxsLmN0cmwpOwo+ICAgCVBJUEVfQ09ORl9D
SEVDS19YKGRzaV9wbGwuZGl2KTsKPiAgIAo+IC0JaWYgKElTX0c0WChkZXZfcHJpdikgfHwgSU5U
RUxfR0VOKGRldl9wcml2KSA+PSA1KQo+ICsJaWYgKElTX0c0WChpOTE1KSB8fCBJTlRFTF9HRU4o
aTkxNSkgPj0gNSkKPiAgIAkJUElQRV9DT05GX0NIRUNLX0kocGlwZV9icHApOwo+ICAgCj4gICAJ
UElQRV9DT05GX0NIRUNLX0NMT0NLX0ZVWlpZKGJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2Nr
KTsKPiBAQCAtMTI2OTQsMTEgKzEyNjk0LDExIEBAIGludGVsX3BpcGVfY29uZmlnX2NvbXBhcmUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCXJldHVybiByZXQ7Cj4gICB9
Cj4gICAKPiAtc3RhdGljIHZvaWQgaW50ZWxfcGlwZV9jb25maWdfc2FuaXR5X2NoZWNrKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgaW50ZWxfcGlwZV9j
b25maWdfc2FuaXR5X2NoZWNrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJ
CQkgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gICB7Cj4g
ICAJaWYgKHBpcGVfY29uZmlnLT5oYXNfcGNoX2VuY29kZXIpIHsKPiAtCQlpbnQgZmRpX2RvdGNs
b2NrID0gaW50ZWxfZG90Y2xvY2tfY2FsY3VsYXRlKGludGVsX2ZkaV9saW5rX2ZyZXEoZGV2X3By
aXYsIHBpcGVfY29uZmlnKSwKPiArCQlpbnQgZmRpX2RvdGNsb2NrID0gaW50ZWxfZG90Y2xvY2tf
Y2FsY3VsYXRlKGludGVsX2ZkaV9saW5rX2ZyZXEoaTkxNSwgcGlwZV9jb25maWcpLAo+ICAgCQkJ
CQkJCSAgICAmcGlwZV9jb25maWctPmZkaV9tX24pOwo+ICAgCQlpbnQgZG90Y2xvY2sgPSBwaXBl
X2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2s7Cj4gICAKPiBAQCAtMTI3MTUs
NyArMTI3MTUsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9waXBlX2NvbmZpZ19zYW5pdHlfY2hlY2so
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgc3RhdGljIHZvaWQgdmVyaWZ5
X3dtX3N0YXRlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKPiAgIAkJCSAgICBzdHJ1Y3QgZHJtX2Ny
dGNfc3RhdGUgKm5ld19zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShjcnRjLT5kZXYpOwo+ICAgCXN0cnVjdCBza2xfaHdfc3RhdGUgewo+
ICAgCQlzdHJ1Y3Qgc2tsX2RkYl9lbnRyeSBkZGJfeVtJOTE1X01BWF9QTEFORVNdOwo+ICAgCQlz
dHJ1Y3Qgc2tsX2RkYl9lbnRyeSBkZGJfdXZbSTkxNV9NQVhfUExBTkVTXTsKPiBAQCAtMTI3Mjcs
OSArMTI3MjcsOSBAQCBzdGF0aWMgdm9pZCB2ZXJpZnlfd21fc3RhdGUoc3RydWN0IGRybV9jcnRj
ICpjcnRjLAo+ICAgCXN0cnVjdCBza2xfZGRiX2VudHJ5ICpod19kZGJfZW50cnksICpzd19kZGJf
ZW50cnk7Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRj
KGNydGMpOwo+ICAgCWNvbnN0IGVudW0gcGlwZSBwaXBlID0gaW50ZWxfY3J0Yy0+cGlwZTsKPiAt
CWludCBwbGFuZSwgbGV2ZWwsIG1heF9sZXZlbCA9IGlsa193bV9tYXhfbGV2ZWwoZGV2X3ByaXYp
Owo+ICsJaW50IHBsYW5lLCBsZXZlbCwgbWF4X2xldmVsID0gaWxrX3dtX21heF9sZXZlbChpOTE1
KTsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA5IHx8ICFuZXdfc3RhdGUtPmFj
dGl2ZSkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA5IHx8ICFuZXdfc3RhdGUtPmFjdGl2ZSkK
PiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJaHcgPSBremFsbG9jKHNpemVvZigqaHcpLCBHRlBfS0VS
TkVMKTsKPiBAQCAtMTI3NDEsMTcgKzEyNzQxLDE3IEBAIHN0YXRpYyB2b2lkIHZlcmlmeV93bV9z
dGF0ZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gICAKPiAgIAlza2xfcGlwZV9kZGJfZ2V0X2h3
X3N0YXRlKGludGVsX2NydGMsIGh3LT5kZGJfeSwgaHctPmRkYl91dik7Cj4gICAKPiAtCXNrbF9k
ZGJfZ2V0X2h3X3N0YXRlKGRldl9wcml2LCAmaHctPmRkYik7Cj4gLQlzd19kZGIgPSAmZGV2X3By
aXYtPndtLnNrbF9ody5kZGI7Cj4gKwlza2xfZGRiX2dldF9od19zdGF0ZShpOTE1LCAmaHctPmRk
Yik7Cj4gKwlzd19kZGIgPSAmaTkxNS0+d20uc2tsX2h3LmRkYjsKPiAgIAo+IC0JaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPj0gMTEgJiYKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEgJiYK
PiAgIAkgICAgaHctPmRkYi5lbmFibGVkX3NsaWNlcyAhPSBzd19kZGItPmVuYWJsZWRfc2xpY2Vz
KQo+ICAgCQlEUk1fRVJST1IoIm1pc21hdGNoIGluIERCVUYgU2xpY2VzIChleHBlY3RlZCAldSwg
Z290ICV1KVxuIiwKPiAgIAkJCSAgc3dfZGRiLT5lbmFibGVkX3NsaWNlcywKPiAgIAkJCSAgaHct
PmRkYi5lbmFibGVkX3NsaWNlcyk7Cj4gICAKPiAgIAkvKiBwbGFuZXMgKi8KPiAtCWZvcl9lYWNo
X3VuaXZlcnNhbF9wbGFuZShkZXZfcHJpdiwgcGlwZSwgcGxhbmUpIHsKPiArCWZvcl9lYWNoX3Vu
aXZlcnNhbF9wbGFuZShpOTE1LCBwaXBlLCBwbGFuZSkgewo+ICAgCQlzdHJ1Y3Qgc2tsX3BsYW5l
X3dtICpod19wbGFuZV93bSwgKnN3X3BsYW5lX3dtOwo+ICAgCj4gICAJCWh3X3BsYW5lX3dtID0g
Jmh3LT53bS5wbGFuZXNbcGxhbmVdOwo+IEBAIC0xMjkzMyw3ICsxMjkzMyw3IEBAIHZlcmlmeV9j
cnRjX3N0YXRlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKPiAgIAkJICBzdHJ1Y3QgZHJtX2NydGNf
c3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+ICAgewo+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYg
PSBjcnRjLT5kZXY7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2
KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcjsKPiAgIAlzdHJ1Y3QgaW50ZWxf
Y3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Yyk7Cj4gICAJc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLCAqc3dfY29uZmlnOwo+IEBAIC0xMjk0OSwxMCArMTI5
NDksMTAgQEAgdmVyaWZ5X2NydGNfc3RhdGUoc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ICAgCj4g
ICAJRFJNX0RFQlVHX0tNUygiW0NSVEM6JWQ6JXNdXG4iLCBjcnRjLT5iYXNlLmlkLCBjcnRjLT5u
YW1lKTsKPiAgIAo+IC0JYWN0aXZlID0gZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X3BpcGVfY29uZmln
KGludGVsX2NydGMsIHBpcGVfY29uZmlnKTsKPiArCWFjdGl2ZSA9IGk5MTUtPmRpc3BsYXkuZ2V0
X3BpcGVfY29uZmlnKGludGVsX2NydGMsIHBpcGVfY29uZmlnKTsKPiAgIAo+ICAgCS8qIHdlIGtl
ZXAgYm90aCBwaXBlcyBlbmFibGVkIG9uIDgzMCAqLwo+IC0JaWYgKElTX0k4MzAoZGV2X3ByaXYp
KQo+ICsJaWYgKElTX0k4MzAoaTkxNSkpCj4gICAJCWFjdGl2ZSA9IG5ld19jcnRjX3N0YXRlLT5h
Y3RpdmU7Cj4gICAKPiAgIAlJOTE1X1NUQVRFX1dBUk4obmV3X2NydGNfc3RhdGUtPmFjdGl2ZSAh
PSBhY3RpdmUsCj4gQEAgLTEyOTg0LDEwICsxMjk4NCwxMCBAQCB2ZXJpZnlfY3J0Y19zdGF0ZShz
dHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gICAJaWYgKCFuZXdfY3J0Y19zdGF0ZS0+YWN0aXZlKQo+
ICAgCQlyZXR1cm47Cj4gICAKPiAtCWludGVsX3BpcGVfY29uZmlnX3Nhbml0eV9jaGVjayhkZXZf
cHJpdiwgcGlwZV9jb25maWcpOwo+ICsJaW50ZWxfcGlwZV9jb25maWdfc2FuaXR5X2NoZWNrKGk5
MTUsIHBpcGVfY29uZmlnKTsKPiAgIAo+ICAgCXN3X2NvbmZpZyA9IHRvX2ludGVsX2NydGNfc3Rh
dGUobmV3X2NydGNfc3RhdGUpOwo+IC0JaWYgKCFpbnRlbF9waXBlX2NvbmZpZ19jb21wYXJlKGRl
dl9wcml2LCBzd19jb25maWcsCj4gKwlpZiAoIWludGVsX3BpcGVfY29uZmlnX2NvbXBhcmUoaTkx
NSwgc3dfY29uZmlnLAo+ICAgCQkJCSAgICAgICBwaXBlX2NvbmZpZywgZmFsc2UpKSB7Cj4gICAJ
CUk5MTVfU1RBVEVfV0FSTigxLCAicGlwZSBzdGF0ZSBkb2Vzbid0IG1hdGNoIVxuIik7Cj4gICAJ
CWludGVsX2R1bXBfcGlwZV9jb25maWcocGlwZV9jb25maWcsIE5VTEwsICJbaHcgc3RhdGVdIik7
Cj4gQEAgLTEzMDA5LDcgKzEzMDA5LDcgQEAgaW50ZWxfdmVyaWZ5X3BsYW5lcyhzdHJ1Y3QgaW50
ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQKPiAtdmVy
aWZ5X3NpbmdsZV9kcGxsX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiArdmVyaWZ5X3NpbmdsZV9kcGxsX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAo+ICAgCQkJIHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsLAo+ICAgCQkJIHN0cnVjdCBk
cm1fY3J0YyAqY3J0YywKPiAgIAkJCSBzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKm5ld19zdGF0ZSkK
PiBAQCAtMTMwMjIsNyArMTMwMjIsNyBAQCB2ZXJpZnlfc2luZ2xlX2RwbGxfc3RhdGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCj4gICAJRFJNX0RFQlVHX0tNUygiJXNc
biIsIHBsbC0+aW5mby0+bmFtZSk7Cj4gICAKPiAtCWFjdGl2ZSA9IHBsbC0+aW5mby0+ZnVuY3Mt
PmdldF9od19zdGF0ZShkZXZfcHJpdiwgcGxsLCAmZHBsbF9od19zdGF0ZSk7Cj4gKwlhY3RpdmUg
PSBwbGwtPmluZm8tPmZ1bmNzLT5nZXRfaHdfc3RhdGUoaTkxNSwgcGxsLCAmZHBsbF9od19zdGF0
ZSk7Cj4gICAKPiAgIAlpZiAoIShwbGwtPmluZm8tPmZsYWdzICYgSU5URUxfRFBMTF9BTFdBWVNf
T04pKSB7Cj4gICAJCUk5MTVfU1RBVEVfV0FSTighcGxsLT5vbiAmJiBwbGwtPmFjdGl2ZV9tYXNr
LAo+IEBAIC0xMzA2OCwxMiArMTMwNjgsMTIgQEAgdmVyaWZ5X3NoYXJlZF9kcGxsX3N0YXRlKHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYsIHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKPiAgIAkJCSBzdHJ1
Y3QgZHJtX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+ICAgCQkJIHN0cnVjdCBkcm1fY3J0
Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX3N0
YXRlID0gdG9faW50ZWxfY3J0Y19zdGF0ZShvbGRfY3J0Y19zdGF0ZSk7Cj4gICAJc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKm5ld19zdGF0ZSA9IHRvX2ludGVsX2NydGNfc3RhdGUobmV3X2NydGNf
c3RhdGUpOwo+ICAgCj4gICAJaWYgKG5ld19zdGF0ZS0+c2hhcmVkX2RwbGwpCj4gLQkJdmVyaWZ5
X3NpbmdsZV9kcGxsX3N0YXRlKGRldl9wcml2LCBuZXdfc3RhdGUtPnNoYXJlZF9kcGxsLCBjcnRj
LCBuZXdfY3J0Y19zdGF0ZSk7Cj4gKwkJdmVyaWZ5X3NpbmdsZV9kcGxsX3N0YXRlKGk5MTUsIG5l
d19zdGF0ZS0+c2hhcmVkX2RwbGwsIGNydGMsIG5ld19jcnRjX3N0YXRlKTsKPiAgIAo+ICAgCWlm
IChvbGRfc3RhdGUtPnNoYXJlZF9kcGxsICYmCj4gICAJICAgIG9sZF9zdGF0ZS0+c2hhcmVkX2Rw
bGwgIT0gbmV3X3N0YXRlLT5zaGFyZWRfZHBsbCkgewo+IEBAIC0xMzEwOCwxMSArMTMxMDgsMTEg
QEAgaW50ZWxfbW9kZXNldF92ZXJpZnlfY3J0YyhzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gICBz
dGF0aWMgdm9pZAo+ICAgdmVyaWZ5X2Rpc2FibGVkX2RwbGxfc3RhdGUoc3RydWN0IGRybV9kZXZp
Y2UgKmRldikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShk
ZXYpOwo+ICAgCWludCBpOwo+ICAgCj4gLQlmb3IgKGkgPSAwOyBpIDwgZGV2X3ByaXYtPm51bV9z
aGFyZWRfZHBsbDsgaSsrKQo+IC0JCXZlcmlmeV9zaW5nbGVfZHBsbF9zdGF0ZShkZXZfcHJpdiwg
JmRldl9wcml2LT5zaGFyZWRfZHBsbHNbaV0sIE5VTEwsIE5VTEwpOwo+ICsJZm9yIChpID0gMDsg
aSA8IGk5MTUtPm51bV9zaGFyZWRfZHBsbDsgaSsrKQo+ICsJCXZlcmlmeV9zaW5nbGVfZHBsbF9z
dGF0ZShpOTE1LCAmaTkxNS0+c2hhcmVkX2RwbGxzW2ldLCBOVUxMLCBOVUxMKTsKPiAgIH0KPiAg
IAo+ICAgc3RhdGljIHZvaWQKPiBAQCAtMTMxMjcsNyArMTMxMjcsNyBAQCBpbnRlbF9tb2Rlc2V0
X3ZlcmlmeV9kaXNhYmxlZChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ICAgc3RhdGljIHZvaWQg
dXBkYXRlX3NjYW5saW5lX29mZnNldChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2Ny
dGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAo+ICAgCS8qCj4gICAJ
ICogVGhlIHNjYW5saW5lIGNvdW50ZXIgaW5jcmVtZW50cyBhdCB0aGUgbGVhZGluZyBlZGdlIG9m
IGhzeW5jLgo+IEBAIC0xMzE1Niw3ICsxMzE1Niw3IEBAIHN0YXRpYyB2b2lkIHVwZGF0ZV9zY2Fu
bGluZV9vZmZzZXQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4g
ICAJICogSG93ZXZlciBpZiBxdWVyaWVkIGp1c3QgYmVmb3JlIHRoZSBzdGFydCBvZiB2Ymxhbmsg
d2UnbGwgZ2V0IGFuCj4gICAJICogYW5zd2VyIHRoYXQncyBzbGlnaHRseSBpbiB0aGUgZnV0dXJl
Lgo+ICAgCSAqLwo+IC0JaWYgKElTX0dFTihkZXZfcHJpdiwgMikpIHsKPiArCWlmIChJU19HRU4o
aTkxNSwgMikpIHsKPiAgIAkJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVk
X21vZGUgPSAmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICAgCQlpbnQgdnRvdGFs
Owo+ICAgCj4gQEAgLTEzMTY1LDcgKzEzMTY1LDcgQEAgc3RhdGljIHZvaWQgdXBkYXRlX3NjYW5s
aW5lX29mZnNldChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAg
IAkJCXZ0b3RhbCAvPSAyOwo+ICAgCj4gICAJCWNydGMtPnNjYW5saW5lX29mZnNldCA9IHZ0b3Rh
bCAtIDE7Cj4gLQl9IGVsc2UgaWYgKEhBU19EREkoZGV2X3ByaXYpICYmCj4gKwl9IGVsc2UgaWYg
KEhBU19EREkoaTkxNSkgJiYKPiAgIAkJICAgaW50ZWxfY3J0Y19oYXNfdHlwZShjcnRjX3N0YXRl
LCBJTlRFTF9PVVRQVVRfSERNSSkpIHsKPiAgIAkJY3J0Yy0+c2NhbmxpbmVfb2Zmc2V0ID0gMjsK
PiAgIAl9IGVsc2UKPiBAQCAtMTMxNzQsMTIgKzEzMTc0LDEyIEBAIHN0YXRpYyB2b2lkIHVwZGF0
ZV9zY2FubGluZV9vZmZzZXQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUpCj4gICAKPiAgIHN0YXRpYyB2b2lkIGludGVsX21vZGVzZXRfY2xlYXJfcGxscyhzdHJ1Y3Qg
aW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoc3RhdGUtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShzdGF0ZS0+YmFzZS5kZXYpOwo+ICAgCXN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwgKm5ld19jcnRjX3N0YXRlOwo+ICAg
CXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOwo+ICAgCWludCBpOwo+ICAgCj4gLQlpZiAoIWRldl9w
cml2LT5kaXNwbGF5LmNydGNfY29tcHV0ZV9jbG9jaykKPiArCWlmICghaTkxNS0+ZGlzcGxheS5j
cnRjX2NvbXB1dGVfY2xvY2spCj4gICAJCXJldHVybjsKPiAgIAo+ICAgCWZvcl9lYWNoX29sZG5l
d19pbnRlbF9jcnRjX2luX3N0YXRlKHN0YXRlLCBjcnRjLCBvbGRfY3J0Y19zdGF0ZSwKPiBAQCAt
MTMzMTEsNyArMTMzMTEsNyBAQCBzdGF0aWMgaW50IGludGVsX21vZGVzZXRfYWxsX3BpcGVzKHN0
cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgIAo+ICAgc3RhdGljIGludCBpbnRlbF9t
b2Rlc2V0X2NoZWNrcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoc3RhdGUtPmJhc2Uu
ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShzdGF0ZS0+
YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwg
Km5ld19jcnRjX3N0YXRlOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOwo+ICAgCWludCBy
ZXQgPSAwLCBpOwo+IEBAIC0xMzMyMywxMiArMTMzMjMsMTIgQEAgc3RhdGljIGludCBpbnRlbF9t
b2Rlc2V0X2NoZWNrcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgIAo+ICAg
CS8qIGtlZXAgdGhlIGN1cnJlbnQgc2V0dGluZyAqLwo+ICAgCWlmICghc3RhdGUtPmNkY2xrLmZv
cmNlX21pbl9jZGNsa19jaGFuZ2VkKQo+IC0JCXN0YXRlLT5jZGNsay5mb3JjZV9taW5fY2RjbGsg
PSBkZXZfcHJpdi0+Y2RjbGsuZm9yY2VfbWluX2NkY2xrOwo+ICsJCXN0YXRlLT5jZGNsay5mb3Jj
ZV9taW5fY2RjbGsgPSBpOTE1LT5jZGNsay5mb3JjZV9taW5fY2RjbGs7Cj4gICAKPiAgIAlzdGF0
ZS0+bW9kZXNldCA9IHRydWU7Cj4gLQlzdGF0ZS0+YWN0aXZlX2NydGNzID0gZGV2X3ByaXYtPmFj
dGl2ZV9jcnRjczsKPiAtCXN0YXRlLT5jZGNsay5sb2dpY2FsID0gZGV2X3ByaXYtPmNkY2xrLmxv
Z2ljYWw7Cj4gLQlzdGF0ZS0+Y2RjbGsuYWN0dWFsID0gZGV2X3ByaXYtPmNkY2xrLmFjdHVhbDsK
PiArCXN0YXRlLT5hY3RpdmVfY3J0Y3MgPSBpOTE1LT5hY3RpdmVfY3J0Y3M7Cj4gKwlzdGF0ZS0+
Y2RjbGsubG9naWNhbCA9IGk5MTUtPmNkY2xrLmxvZ2ljYWw7Cj4gKwlzdGF0ZS0+Y2RjbGsuYWN0
dWFsID0gaTkxNS0+Y2RjbGsuYWN0dWFsOwo+ICAgCXN0YXRlLT5jZGNsay5waXBlID0gSU5WQUxJ
RF9QSVBFOwo+ICAgCj4gICAJZm9yX2VhY2hfb2xkbmV3X2ludGVsX2NydGNfaW5fc3RhdGUoc3Rh
dGUsIGNydGMsIG9sZF9jcnRjX3N0YXRlLAo+IEBAIC0xMzM0OSwxOSArMTMzNDksMTkgQEAgc3Rh
dGljIGludCBpbnRlbF9tb2Rlc2V0X2NoZWNrcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpz
dGF0ZSkKPiAgIAkgKiBtb2RlIHNldCBvbiB0aGlzIGNydGMuICBGb3Igb3RoZXIgY3J0Y3Mgd2Ug
bmVlZCB0byB1c2UgdGhlCj4gICAJICogYWRqdXN0ZWRfbW9kZSBiaXRzIGluIHRoZSBjcnRjIGRp
cmVjdGx5Lgo+ICAgCSAqLwo+IC0JaWYgKGRldl9wcml2LT5kaXNwbGF5Lm1vZGVzZXRfY2FsY19j
ZGNsaykgewo+ICsJaWYgKGk5MTUtPmRpc3BsYXkubW9kZXNldF9jYWxjX2NkY2xrKSB7Cj4gICAJ
CWVudW0gcGlwZSBwaXBlOwo+ICAgCj4gLQkJcmV0ID0gZGV2X3ByaXYtPmRpc3BsYXkubW9kZXNl
dF9jYWxjX2NkY2xrKHN0YXRlKTsKPiArCQlyZXQgPSBpOTE1LT5kaXNwbGF5Lm1vZGVzZXRfY2Fs
Y19jZGNsayhzdGF0ZSk7Cj4gICAJCWlmIChyZXQgPCAwKQo+ICAgCQkJcmV0dXJuIHJldDsKPiAg
IAo+ICAgCQkvKgo+IC0JCSAqIFdyaXRlcyB0byBkZXZfcHJpdi0+Y2RjbGsubG9naWNhbCBtdXN0
IHByb3RlY3RlZCBieQo+ICsJCSAqIFdyaXRlcyB0byBpOTE1LT5jZGNsay5sb2dpY2FsIG11c3Qg
cHJvdGVjdGVkIGJ5Cj4gICAJCSAqIGhvbGRpbmcgYWxsIHRoZSBjcnRjIGxvY2tzLCBldmVuIGlm
IHdlIGRvbid0IGVuZCB1cAo+ICAgCQkgKiB0b3VjaGluZyB0aGUgaGFyZHdhcmUKPiAgIAkJICov
Cj4gLQkJaWYgKGludGVsX2NkY2xrX2NoYW5nZWQoJmRldl9wcml2LT5jZGNsay5sb2dpY2FsLAo+
ICsJCWlmIChpbnRlbF9jZGNsa19jaGFuZ2VkKCZpOTE1LT5jZGNsay5sb2dpY2FsLAo+ICAgCQkJ
CQkmc3RhdGUtPmNkY2xrLmxvZ2ljYWwpKSB7Cj4gICAJCQlyZXQgPSBpbnRlbF9sb2NrX2FsbF9w
aXBlcygmc3RhdGUtPmJhc2UpOwo+ICAgCQkJaWYgKHJldCA8IDApCj4gQEAgLTEzMzczLDcgKzEz
MzczLDcgQEAgc3RhdGljIGludCBpbnRlbF9tb2Rlc2V0X2NoZWNrcyhzdHJ1Y3QgaW50ZWxfYXRv
bWljX3N0YXRlICpzdGF0ZSkKPiAgIAkJCXN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZTsKPiAgIAo+ICAgCQkJcGlwZSA9IGlsb2cyKHN0YXRlLT5hY3RpdmVfY3J0Y3MpOwo+IC0JCQlj
cnRjID0gJmludGVsX2dldF9jcnRjX2Zvcl9waXBlKGRldl9wcml2LCBwaXBlKS0+YmFzZTsKPiAr
CQkJY3J0YyA9ICZpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShpOTE1LCBwaXBlKS0+YmFzZTsKPiAg
IAkJCWNydGNfc3RhdGUgPSBkcm1fYXRvbWljX2dldF9uZXdfY3J0Y19zdGF0ZSgmc3RhdGUtPmJh
c2UsIGNydGMpOwo+ICAgCQkJaWYgKGNydGNfc3RhdGUgJiYgbmVlZHNfbW9kZXNldChjcnRjX3N0
YXRlKSkKPiAgIAkJCQlwaXBlID0gSU5WQUxJRF9QSVBFOwo+IEBAIC0xMzM4MywxNSArMTMzODMs
MTUgQEAgc3RhdGljIGludCBpbnRlbF9tb2Rlc2V0X2NoZWNrcyhzdHJ1Y3QgaW50ZWxfYXRvbWlj
X3N0YXRlICpzdGF0ZSkKPiAgIAo+ICAgCQkvKiBBbGwgcGlwZXMgbXVzdCBiZSBzd2l0Y2hlZCBv
ZmYgd2hpbGUgd2UgY2hhbmdlIHRoZSBjZGNsay4gKi8KPiAgIAkJaWYgKHBpcGUgIT0gSU5WQUxJ
RF9QSVBFICYmCj4gLQkJICAgIGludGVsX2NkY2xrX25lZWRzX2NkMnhfdXBkYXRlKGRldl9wcml2
LAo+IC0JCQkJCQkgICZkZXZfcHJpdi0+Y2RjbGsuYWN0dWFsLAo+ICsJCSAgICBpbnRlbF9jZGNs
a19uZWVkc19jZDJ4X3VwZGF0ZShpOTE1LAo+ICsJCQkJCQkgICZpOTE1LT5jZGNsay5hY3R1YWws
Cj4gICAJCQkJCQkgICZzdGF0ZS0+Y2RjbGsuYWN0dWFsKSkgewo+ICAgCQkJcmV0ID0gaW50ZWxf
bG9ja19hbGxfcGlwZXMoJnN0YXRlLT5iYXNlKTsKPiAgIAkJCWlmIChyZXQgPCAwKQo+ICAgCQkJ
CXJldHVybiByZXQ7Cj4gICAKPiAgIAkJCXN0YXRlLT5jZGNsay5waXBlID0gcGlwZTsKPiAtCQl9
IGVsc2UgaWYgKGludGVsX2NkY2xrX25lZWRzX21vZGVzZXQoJmRldl9wcml2LT5jZGNsay5hY3R1
YWwsCj4gKwkJfSBlbHNlIGlmIChpbnRlbF9jZGNsa19uZWVkc19tb2Rlc2V0KCZpOTE1LT5jZGNs
ay5hY3R1YWwsCj4gICAJCQkJCQkgICAgICZzdGF0ZS0+Y2RjbGsuYWN0dWFsKSkgewo+ICAgCQkJ
cmV0ID0gaW50ZWxfbW9kZXNldF9hbGxfcGlwZXMoJnN0YXRlLT5iYXNlKTsKPiAgIAkJCWlmIChy
ZXQgPCAwKQo+IEBAIC0xMzQxMCw3ICsxMzQxMCw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfbW9kZXNl
dF9jaGVja3Moc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gICAKPiAgIAlpbnRl
bF9tb2Rlc2V0X2NsZWFyX3BsbHMoc3RhdGUpOwo+ICAgCj4gLQlpZiAoSVNfSEFTV0VMTChkZXZf
cHJpdikpCj4gKwlpZiAoSVNfSEFTV0VMTChpOTE1KSkKPiAgIAkJcmV0dXJuIGhhc3dlbGxfbW9k
ZV9zZXRfcGxhbmVzX3dvcmthcm91bmQoc3RhdGUpOwo+ICAgCj4gICAJcmV0dXJuIDA7Cj4gQEAg
LTEzNDI0LDExICsxMzQyNCwxMSBAQCBzdGF0aWMgaW50IGludGVsX21vZGVzZXRfY2hlY2tzKHN0
cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAgc3RhdGljIGludCBjYWxjX3dhdGVy
bWFya19kYXRhKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAgewo+ICAgCXN0
cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBzdGF0ZS0+YmFzZS5kZXY7Cj4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAo+ICAgCS8qIElzIHRoZXJlIHBsYXRm
b3JtLXNwZWNpZmljIHdhdGVybWFyayBpbmZvcm1hdGlvbiB0byBjYWxjdWxhdGU/ICovCj4gLQlp
ZiAoZGV2X3ByaXYtPmRpc3BsYXkuY29tcHV0ZV9nbG9iYWxfd2F0ZXJtYXJrcykKPiAtCQlyZXR1
cm4gZGV2X3ByaXYtPmRpc3BsYXkuY29tcHV0ZV9nbG9iYWxfd2F0ZXJtYXJrcyhzdGF0ZSk7Cj4g
KwlpZiAoaTkxNS0+ZGlzcGxheS5jb21wdXRlX2dsb2JhbF93YXRlcm1hcmtzKQo+ICsJCXJldHVy
biBpOTE1LT5kaXNwbGF5LmNvbXB1dGVfZ2xvYmFsX3dhdGVybWFya3Moc3RhdGUpOwo+ICAgCj4g
ICAJcmV0dXJuIDA7Cj4gICB9Cj4gQEAgLTEzNDQxLDcgKzEzNDQxLDcgQEAgc3RhdGljIGludCBj
YWxjX3dhdGVybWFya19kYXRhKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAg
c3RhdGljIGludCBpbnRlbF9hdG9taWNfY2hlY2soc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiAg
IAkJCSAgICAgIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpfc3RhdGUpCj4gICB7Cj4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxf
YXRvbWljX3N0YXRlICpzdGF0ZSA9IHRvX2ludGVsX2F0b21pY19zdGF0ZShfc3RhdGUpOwo+ICAg
CXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwgKm5ld19jcnRjX3N0YXRl
Owo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOwo+IEBAIC0xMzQ3NCw3ICsxMzQ3NCw3IEBA
IHN0YXRpYyBpbnQgaW50ZWxfYXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4g
ICAJCWlmIChyZXQpCj4gICAJCQlnb3RvIGZhaWw7Cj4gICAKPiAtCQlpZiAoaW50ZWxfcGlwZV9j
b25maWdfY29tcGFyZShkZXZfcHJpdiwgb2xkX2NydGNfc3RhdGUsCj4gKwkJaWYgKGludGVsX3Bp
cGVfY29uZmlnX2NvbXBhcmUoaTkxNSwgb2xkX2NydGNfc3RhdGUsCj4gICAJCQkJCSAgICAgIG5l
d19jcnRjX3N0YXRlLCB0cnVlKSkgewo+ICAgCQkJbmV3X2NydGNfc3RhdGUtPmJhc2UubW9kZV9j
aGFuZ2VkID0gZmFsc2U7Cj4gICAJCQluZXdfY3J0Y19zdGF0ZS0+dXBkYXRlX3BpcGUgPSB0cnVl
Owo+IEBAIC0xMzQ5Myw3ICsxMzQ5Myw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfYXRvbWljX2NoZWNr
KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gICAJCWlmIChyZXQpCj4gICAJCQlnb3RvIGZhaWw7
Cj4gICAJfSBlbHNlIHsKPiAtCQlzdGF0ZS0+Y2RjbGsubG9naWNhbCA9IGRldl9wcml2LT5jZGNs
ay5sb2dpY2FsOwo+ICsJCXN0YXRlLT5jZGNsay5sb2dpY2FsID0gaTkxNS0+Y2RjbGsubG9naWNh
bDsKPiAgIAl9Cj4gICAKPiAgIAlyZXQgPSBpY2xfYWRkX2xpbmtlZF9wbGFuZXMoc3RhdGUpOwo+
IEBAIC0xMzUwNCw3ICsxMzUwNCw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfYXRvbWljX2NoZWNrKHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gICAJaWYgKHJldCkKPiAgIAkJZ290byBmYWlsOwo+ICAg
Cj4gLQlpbnRlbF9mYmNfY2hvb3NlX2NydGMoZGV2X3ByaXYsIHN0YXRlKTsKPiArCWludGVsX2Zi
Y19jaG9vc2VfY3J0YyhpOTE1LCBzdGF0ZSk7Cj4gICAJcmV0ID0gY2FsY193YXRlcm1hcmtfZGF0
YShzdGF0ZSk7Cj4gICAJaWYgKHJldCkKPiAgIAkJZ290byBmYWlsOwo+IEBAIC0xMzU2NCw3ICsx
MzU2NCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3VwZGF0ZV9jcnRjKHN0cnVjdCBkcm1fY3J0YyAq
Y3J0YywKPiAgIAkJCSAgICAgIHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUp
Cj4gICB7Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmRldjsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9j
cnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjKTsKPiAgIAlzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqcGlwZV9jb25maWcgPSB0b19pbnRlbF9jcnRjX3N0YXRlKG5ld19jcnRjX3N0
YXRlKTsKPiAgIAlib29sIG1vZGVzZXQgPSBuZWVkc19tb2Rlc2V0KG5ld19jcnRjX3N0YXRlKTsK
PiBAQCAtMTM1NzQsNyArMTM1NzQsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF91cGRhdGVfY3J0Yyhz
dHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gICAKPiAgIAlpZiAobW9kZXNldCkgewo+ICAgCQl1cGRh
dGVfc2NhbmxpbmVfb2Zmc2V0KHBpcGVfY29uZmlnKTsKPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5j
cnRjX2VuYWJsZShwaXBlX2NvbmZpZywgc3RhdGUpOwo+ICsJCWk5MTUtPmRpc3BsYXkuY3J0Y19l
bmFibGUocGlwZV9jb25maWcsIHN0YXRlKTsKPiAgIAo+ICAgCQkvKiB2YmxhbmtzIHdvcmsgYWdh
aW4sIHJlLWVuYWJsZSBwaXBlIENSQy4gKi8KPiAgIAkJaW50ZWxfY3J0Y19lbmFibGVfcGlwZV9j
cmMoaW50ZWxfY3J0Yyk7Cj4gQEAgLTEzNTkzLDcgKzEzNTkzLDcgQEAgc3RhdGljIHZvaWQgaW50
ZWxfdXBkYXRlX2NydGMoc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ICAgCj4gICAJaW50ZWxfYmVn
aW5fY3J0Y19jb21taXQodG9faW50ZWxfYXRvbWljX3N0YXRlKHN0YXRlKSwgaW50ZWxfY3J0Yyk7
Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gKwlpZiAoSU5URUxfR0VO
KGk5MTUpID49IDkpCj4gICAJCXNrbF91cGRhdGVfcGxhbmVzX29uX2NydGModG9faW50ZWxfYXRv
bWljX3N0YXRlKHN0YXRlKSwgaW50ZWxfY3J0Yyk7Cj4gICAJZWxzZQo+ICAgCQlpOXh4X3VwZGF0
ZV9wbGFuZXNfb25fY3J0Yyh0b19pbnRlbF9hdG9taWNfc3RhdGUoc3RhdGUpLCBpbnRlbF9jcnRj
KTsKPiBAQCAtMTM2MTgsNyArMTM2MTgsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF91cGRhdGVfY3J0
Y3Moc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAgCj4gICBzdGF0aWMgdm9pZCBz
a2xfdXBkYXRlX2NydGNzKHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoc3RhdGUtPmRldik7
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoc3RhdGUtPmRldik7
Cj4gICAJc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqaW50ZWxfc3RhdGUgPSB0b19pbnRlbF9h
dG9taWNfc3RhdGUoc3RhdGUpOwo+ICAgCXN0cnVjdCBkcm1fY3J0YyAqY3J0YzsKPiAgIAlzdHJ1
Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YzsKPiBAQCAtMTM2MjgsNyArMTM2MjgsNyBAQCBzdGF0
aWMgdm9pZCBza2xfdXBkYXRlX2NydGNzKHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkK
PiAgIAlib29sIHByb2dyZXNzOwo+ICAgCWVudW0gcGlwZSBwaXBlOwo+ICAgCWludCBpOwo+IC0J
dTggaHdfZW5hYmxlZF9zbGljZXMgPSBkZXZfcHJpdi0+d20uc2tsX2h3LmRkYi5lbmFibGVkX3Ns
aWNlczsKPiArCXU4IGh3X2VuYWJsZWRfc2xpY2VzID0gaTkxNS0+d20uc2tsX2h3LmRkYi5lbmFi
bGVkX3NsaWNlczsKPiAgIAl1OCByZXF1aXJlZF9zbGljZXMgPSBpbnRlbF9zdGF0ZS0+d21fcmVz
dWx0cy5kZGIuZW5hYmxlZF9zbGljZXM7Cj4gICAJc3RydWN0IHNrbF9kZGJfZW50cnkgZW50cmll
c1tJOTE1X01BWF9QSVBFU10gPSB7fTsKPiAgIAo+IEBAIC0xMzYzOCw4ICsxMzYzOCw4IEBAIHN0
YXRpYyB2b2lkIHNrbF91cGRhdGVfY3J0Y3Moc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRl
KQo+ICAgCQkJZW50cmllc1tpXSA9IHRvX2ludGVsX2NydGNfc3RhdGUob2xkX2NydGNfc3RhdGUp
LT53bS5za2wuZGRiOwo+ICAgCj4gICAJLyogSWYgMm5kIERCdWYgc2xpY2UgcmVxdWlyZWQsIGVu
YWJsZSBpdCBoZXJlICovCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSAmJiByZXF1
aXJlZF9zbGljZXMgPiBod19lbmFibGVkX3NsaWNlcykKPiAtCQlpY2xfZGJ1Zl9zbGljZXNfdXBk
YXRlKGRldl9wcml2LCByZXF1aXJlZF9zbGljZXMpOwo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+
PSAxMSAmJiByZXF1aXJlZF9zbGljZXMgPiBod19lbmFibGVkX3NsaWNlcykKPiArCQlpY2xfZGJ1
Zl9zbGljZXNfdXBkYXRlKGk5MTUsIHJlcXVpcmVkX3NsaWNlcyk7Cj4gICAKPiAgIAkvKgo+ICAg
CSAqIFdoZW5ldmVyIHRoZSBudW1iZXIgb2YgYWN0aXZlIHBpcGVzIGNoYW5nZXMsIHdlIG5lZWQg
dG8gbWFrZSBzdXJlIHdlCj4gQEAgLTEzNjYzLDcgKzEzNjYzLDcgQEAgc3RhdGljIHZvaWQgc2ts
X3VwZGF0ZV9jcnRjcyhzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gICAKPiAgIAkJ
CWlmIChza2xfZGRiX2FsbG9jYXRpb25fb3ZlcmxhcHMoJmNzdGF0ZS0+d20uc2tsLmRkYiwKPiAg
IAkJCQkJCQllbnRyaWVzLAo+IC0JCQkJCQkJSU5URUxfSU5GTyhkZXZfcHJpdiktPm51bV9waXBl
cywgaSkpCj4gKwkJCQkJCQlJTlRFTF9JTkZPKGk5MTUpLT5udW1fcGlwZXMsIGkpKQo+ICAgCQkJ
CWNvbnRpbnVlOwo+ICAgCj4gICAJCQl1cGRhdGVkIHw9IGNtYXNrOwo+IEBAIC0xMzY4NSw1NyAr
MTM2ODUsNTcgQEAgc3RhdGljIHZvaWQgc2tsX3VwZGF0ZV9jcnRjcyhzdHJ1Y3QgZHJtX2F0b21p
Y19zdGF0ZSAqc3RhdGUpCj4gICAJCQkJCSAgbmV3X2NydGNfc3RhdGUpOwo+ICAgCj4gICAJCQlp
ZiAodmJsX3dhaXQpCj4gLQkJCQlpbnRlbF93YWl0X2Zvcl92YmxhbmsoZGV2X3ByaXYsIHBpcGUp
Owo+ICsJCQkJaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGk5MTUsIHBpcGUpOwo+ICAgCj4gICAJCQlw
cm9ncmVzcyA9IHRydWU7Cj4gICAJCX0KPiAgIAl9IHdoaWxlIChwcm9ncmVzcyk7Cj4gICAKPiAg
IAkvKiBJZiAybmQgREJ1ZiBzbGljZSBpcyBubyBtb3JlIHJlcXVpcmVkIGRpc2FibGUgaXQgKi8K
PiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExICYmIHJlcXVpcmVkX3NsaWNlcyA8IGh3
X2VuYWJsZWRfc2xpY2VzKQo+IC0JCWljbF9kYnVmX3NsaWNlc191cGRhdGUoZGV2X3ByaXYsIHJl
cXVpcmVkX3NsaWNlcyk7Cj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExICYmIHJlcXVpcmVk
X3NsaWNlcyA8IGh3X2VuYWJsZWRfc2xpY2VzKQo+ICsJCWljbF9kYnVmX3NsaWNlc191cGRhdGUo
aTkxNSwgcmVxdWlyZWRfc2xpY2VzKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpbnRlbF9h
dG9taWNfaGVscGVyX2ZyZWVfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ICtzdGF0aWMgdm9pZCBpbnRlbF9hdG9taWNfaGVscGVyX2ZyZWVfc3RhdGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2F0b21pY19zdGF0
ZSAqc3RhdGUsICpuZXh0Owo+ICAgCXN0cnVjdCBsbGlzdF9ub2RlICpmcmVlZDsKPiAgIAo+IC0J
ZnJlZWQgPSBsbGlzdF9kZWxfYWxsKCZkZXZfcHJpdi0+YXRvbWljX2hlbHBlci5mcmVlX2xpc3Qp
Owo+ICsJZnJlZWQgPSBsbGlzdF9kZWxfYWxsKCZpOTE1LT5hdG9taWNfaGVscGVyLmZyZWVfbGlz
dCk7Cj4gICAJbGxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShzdGF0ZSwgbmV4dCwgZnJlZWQsIGZy
ZWVkKQo+ICAgCQlkcm1fYXRvbWljX3N0YXRlX3B1dCgmc3RhdGUtPmJhc2UpOwo+ICAgfQo+ICAg
Cj4gICBzdGF0aWMgdm9pZCBpbnRlbF9hdG9taWNfaGVscGVyX2ZyZWVfc3RhdGVfd29ya2VyKHN0
cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9Cj4gLQkJY29udGFpbmVyX29mKHdvcmssIHR5cGVvZigqZGV2X3ByaXYpLCBh
dG9taWNfaGVscGVyLmZyZWVfd29yayk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9Cj4gKwkJY29udGFpbmVyX29mKHdvcmssIHR5cGVvZigqaTkxNSksIGF0b21pY19oZWxwZXIu
ZnJlZV93b3JrKTsKPiAgIAo+IC0JaW50ZWxfYXRvbWljX2hlbHBlcl9mcmVlX3N0YXRlKGRldl9w
cml2KTsKPiArCWludGVsX2F0b21pY19oZWxwZXJfZnJlZV9zdGF0ZShpOTE1KTsKPiAgIH0KPiAg
IAo+ICAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX2NvbW1pdF9mZW5jZV93YWl0KHN0cnVjdCBp
bnRlbF9hdG9taWNfc3RhdGUgKmludGVsX3N0YXRlKQo+ICAgewo+ICAgCXN0cnVjdCB3YWl0X3F1
ZXVlX2VudHJ5IHdhaXRfZmVuY2UsIHdhaXRfcmVzZXQ7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGludGVsX3N0YXRlLT5iYXNlLmRldik7Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoaW50ZWxfc3RhdGUtPmJhc2UuZGV2
KTsKPiAgIAo+ICAgCWluaXRfd2FpdF9lbnRyeSgmd2FpdF9mZW5jZSwgMCk7Cj4gICAJaW5pdF93
YWl0X2VudHJ5KCZ3YWl0X3Jlc2V0LCAwKTsKPiAgIAlmb3IgKDs7KSB7Cj4gICAJCXByZXBhcmVf
dG9fd2FpdCgmaW50ZWxfc3RhdGUtPmNvbW1pdF9yZWFkeS53YWl0LAo+ICAgCQkJCSZ3YWl0X2Zl
bmNlLCBUQVNLX1VOSU5URVJSVVBUSUJMRSk7Cj4gLQkJcHJlcGFyZV90b193YWl0KCZkZXZfcHJp
di0+Z3B1X2Vycm9yLndhaXRfcXVldWUsCj4gKwkJcHJlcGFyZV90b193YWl0KCZpOTE1LT5ncHVf
ZXJyb3Iud2FpdF9xdWV1ZSwKPiAgIAkJCQkmd2FpdF9yZXNldCwgVEFTS19VTklOVEVSUlVQVElC
TEUpOwo+ICAgCj4gICAKPiAgIAkJaWYgKGk5MTVfc3dfZmVuY2VfZG9uZSgmaW50ZWxfc3RhdGUt
PmNvbW1pdF9yZWFkeSkKPiAtCQkgICAgfHwgdGVzdF9iaXQoSTkxNV9SRVNFVF9NT0RFU0VULCAm
ZGV2X3ByaXYtPmdwdV9lcnJvci5mbGFncykpCj4gKwkJICAgIHx8IHRlc3RfYml0KEk5MTVfUkVT
RVRfTU9ERVNFVCwgJmk5MTUtPmdwdV9lcnJvci5mbGFncykpCj4gICAJCQlicmVhazsKPiAgIAo+
ICAgCQlzY2hlZHVsZSgpOwo+ICAgCX0KPiAgIAlmaW5pc2hfd2FpdCgmaW50ZWxfc3RhdGUtPmNv
bW1pdF9yZWFkeS53YWl0LCAmd2FpdF9mZW5jZSk7Cj4gLQlmaW5pc2hfd2FpdCgmZGV2X3ByaXYt
PmdwdV9lcnJvci53YWl0X3F1ZXVlLCAmd2FpdF9yZXNldCk7Cj4gKwlmaW5pc2hfd2FpdCgmaTkx
NS0+Z3B1X2Vycm9yLndhaXRfcXVldWUsICZ3YWl0X3Jlc2V0KTsKPiAgIH0KPiAgIAo+ICAgc3Rh
dGljIHZvaWQgaW50ZWxfYXRvbWljX2NsZWFudXBfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndv
cmspCj4gQEAgLTEzNzU1LDcgKzEzNzU1LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX2Nv
bW1pdF90YWlsKHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2ID0gc3RhdGUtPmRldjsKPiAgIAlzdHJ1Y3QgaW50ZWxfYXRvbWlj
X3N0YXRlICppbnRlbF9zdGF0ZSA9IHRvX2ludGVsX2F0b21pY19zdGF0ZShzdGF0ZSk7Cj4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAlzdHJ1Y3QgZHJt
X2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLCAqbmV3X2NydGNfc3RhdGU7Cj4gICAJc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKm5ld19pbnRlbF9jcnRjX3N0YXRlLCAqb2xkX2ludGVsX2NydGNf
c3RhdGU7Cj4gICAJc3RydWN0IGRybV9jcnRjICpjcnRjOwo+IEBAIC0xMzc2OSw3ICsxMzc2OSw3
IEBAIHN0YXRpYyB2b2lkIGludGVsX2F0b21pY19jb21taXRfdGFpbChzdHJ1Y3QgZHJtX2F0b21p
Y19zdGF0ZSAqc3RhdGUpCj4gICAJZHJtX2F0b21pY19oZWxwZXJfd2FpdF9mb3JfZGVwZW5kZW5j
aWVzKHN0YXRlKTsKPiAgIAo+ICAgCWlmIChpbnRlbF9zdGF0ZS0+bW9kZXNldCkKPiAtCQl3YWtl
cmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9NT0RF
U0VUKTsKPiArCQl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoaTkxNSwgUE9XRVJf
RE9NQUlOX01PREVTRVQpOwo+ICAgCj4gICAJZm9yX2VhY2hfb2xkbmV3X2NydGNfaW5fc3RhdGUo
c3RhdGUsIGNydGMsIG9sZF9jcnRjX3N0YXRlLCBuZXdfY3J0Y19zdGF0ZSwgaSkgewo+ICAgCQlv
bGRfaW50ZWxfY3J0Y19zdGF0ZSA9IHRvX2ludGVsX2NydGNfc3RhdGUob2xkX2NydGNfc3RhdGUp
Owo+IEBAIC0xMzc5OCw3ICsxMzc5OCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2F0b21pY19jb21t
aXRfdGFpbChzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gICAJCQkgKi8KPiAgIAkJ
CWludGVsX2NydGNfZGlzYWJsZV9waXBlX2NyYyhpbnRlbF9jcnRjKTsKPiAgIAo+IC0JCQlkZXZf
cHJpdi0+ZGlzcGxheS5jcnRjX2Rpc2FibGUob2xkX2ludGVsX2NydGNfc3RhdGUsIHN0YXRlKTsK
PiArCQkJaTkxNS0+ZGlzcGxheS5jcnRjX2Rpc2FibGUob2xkX2ludGVsX2NydGNfc3RhdGUsIHN0
YXRlKTsKPiAgIAkJCWludGVsX2NydGMtPmFjdGl2ZSA9IGZhbHNlOwo+ICAgCQkJaW50ZWxfZmJj
X2Rpc2FibGUoaW50ZWxfY3J0Yyk7Cj4gICAJCQlpbnRlbF9kaXNhYmxlX3NoYXJlZF9kcGxsKG9s
ZF9pbnRlbF9jcnRjX3N0YXRlKTsKPiBAQCAtMTM4MDcsMTQgKzEzODA3LDE0IEBAIHN0YXRpYyB2
b2lkIGludGVsX2F0b21pY19jb21taXRfdGFpbChzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3Rh
dGUpCj4gICAJCQkgKiBVbmRlcnJ1bnMgZG9uJ3QgYWx3YXlzIHJhaXNlCj4gICAJCQkgKiBpbnRl
cnJ1cHRzLCBzbyBjaGVjayBtYW51YWxseS4KPiAgIAkJCSAqLwo+IC0JCQlpbnRlbF9jaGVja19j
cHVfZmlmb191bmRlcnJ1bnMoZGV2X3ByaXYpOwo+IC0JCQlpbnRlbF9jaGVja19wY2hfZmlmb191
bmRlcnJ1bnMoZGV2X3ByaXYpOwo+ICsJCQlpbnRlbF9jaGVja19jcHVfZmlmb191bmRlcnJ1bnMo
aTkxNSk7Cj4gKwkJCWludGVsX2NoZWNrX3BjaF9maWZvX3VuZGVycnVucyhpOTE1KTsKPiAgIAo+
ICAgCQkJLyogRklYTUUgdW5pZnkgdGhpcyBmb3IgYWxsIHBsYXRmb3JtcyAqLwo+ICAgCQkJaWYg
KCFuZXdfY3J0Y19zdGF0ZS0+YWN0aXZlICYmCj4gLQkJCSAgICAhSEFTX0dNQ0goZGV2X3ByaXYp
ICYmCj4gLQkJCSAgICBkZXZfcHJpdi0+ZGlzcGxheS5pbml0aWFsX3dhdGVybWFya3MpCj4gLQkJ
CQlkZXZfcHJpdi0+ZGlzcGxheS5pbml0aWFsX3dhdGVybWFya3MoaW50ZWxfc3RhdGUsCj4gKwkJ
CSAgICAhSEFTX0dNQ0goaTkxNSkgJiYKPiArCQkJICAgIGk5MTUtPmRpc3BsYXkuaW5pdGlhbF93
YXRlcm1hcmtzKQo+ICsJCQkJaTkxNS0+ZGlzcGxheS5pbml0aWFsX3dhdGVybWFya3MoaW50ZWxf
c3RhdGUsCj4gICAJCQkJCQkJCSAgICAgbmV3X2ludGVsX2NydGNfc3RhdGUpOwo+ICAgCQl9Cj4g
ICAJfQo+IEBAIC0xMzgyNiw5ICsxMzgyNiw5IEBAIHN0YXRpYyB2b2lkIGludGVsX2F0b21pY19j
b21taXRfdGFpbChzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gICAJaWYgKGludGVs
X3N0YXRlLT5tb2Rlc2V0KSB7Cj4gICAJCWRybV9hdG9taWNfaGVscGVyX3VwZGF0ZV9sZWdhY3lf
bW9kZXNldF9zdGF0ZShzdGF0ZS0+ZGV2LCBzdGF0ZSk7Cj4gICAKPiAtCQlpbnRlbF9zZXRfY2Rj
bGtfcHJlX3BsYW5lX3VwZGF0ZShkZXZfcHJpdiwKPiArCQlpbnRlbF9zZXRfY2RjbGtfcHJlX3Bs
YW5lX3VwZGF0ZShpOTE1LAo+ICAgCQkJCQkJICZpbnRlbF9zdGF0ZS0+Y2RjbGsuYWN0dWFsLAo+
IC0JCQkJCQkgJmRldl9wcml2LT5jZGNsay5hY3R1YWwsCj4gKwkJCQkJCSAmaTkxNS0+Y2RjbGsu
YWN0dWFsLAo+ICAgCQkJCQkJIGludGVsX3N0YXRlLT5jZGNsay5waXBlKTsKPiAgIAo+ICAgCQkv
Kgo+IEBAIC0xMzgzNiw3ICsxMzgzNiw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2F0b21pY19jb21t
aXRfdGFpbChzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gICAJCSAqIGhhdmUgbW9y
ZSB0aGVuIG9uZSBwaXBlIGVuYWJsZWQKPiAgIAkJICovCj4gICAJCWlmICghaW50ZWxfY2FuX2Vu
YWJsZV9zYWd2KHN0YXRlKSkKPiAtCQkJaW50ZWxfZGlzYWJsZV9zYWd2KGRldl9wcml2KTsKPiAr
CQkJaW50ZWxfZGlzYWJsZV9zYWd2KGk5MTUpOwo+ICAgCj4gICAJCWludGVsX21vZGVzZXRfdmVy
aWZ5X2Rpc2FibGVkKGRldiwgc3RhdGUpOwo+ICAgCX0KPiBAQCAtMTM4NTYsMTIgKzEzODU2LDEy
IEBAIHN0YXRpYyB2b2lkIGludGVsX2F0b21pY19jb21taXRfdGFpbChzdHJ1Y3QgZHJtX2F0b21p
Y19zdGF0ZSAqc3RhdGUpCj4gICAJfQo+ICAgCj4gICAJLyogTm93IGVuYWJsZSB0aGUgY2xvY2tz
LCBwbGFuZSwgcGlwZSwgYW5kIGNvbm5lY3RvcnMgdGhhdCB3ZSBzZXQgdXAuICovCj4gLQlkZXZf
cHJpdi0+ZGlzcGxheS51cGRhdGVfY3J0Y3Moc3RhdGUpOwo+ICsJaTkxNS0+ZGlzcGxheS51cGRh
dGVfY3J0Y3Moc3RhdGUpOwo+ICAgCj4gICAJaWYgKGludGVsX3N0YXRlLT5tb2Rlc2V0KQo+IC0J
CWludGVsX3NldF9jZGNsa19wb3N0X3BsYW5lX3VwZGF0ZShkZXZfcHJpdiwKPiArCQlpbnRlbF9z
ZXRfY2RjbGtfcG9zdF9wbGFuZV91cGRhdGUoaTkxNSwKPiAgIAkJCQkJCSAgJmludGVsX3N0YXRl
LT5jZGNsay5hY3R1YWwsCj4gLQkJCQkJCSAgJmRldl9wcml2LT5jZGNsay5hY3R1YWwsCj4gKwkJ
CQkJCSAgJmk5MTUtPmNkY2xrLmFjdHVhbCwKPiAgIAkJCQkJCSAgaW50ZWxfc3RhdGUtPmNkY2xr
LnBpcGUpOwo+ICAgCj4gICAJLyogRklYTUU6IFdlIHNob3VsZCBjYWxsIGRybV9hdG9taWNfaGVs
cGVyX2NvbW1pdF9od19kb25lKCkgaGVyZQo+IEBAIC0xMzg5NSw4ICsxMzg5NSw4IEBAIHN0YXRp
YyB2b2lkIGludGVsX2F0b21pY19jb21taXRfdGFpbChzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAq
c3RhdGUpCj4gICAJZm9yX2VhY2hfbmV3X2NydGNfaW5fc3RhdGUoc3RhdGUsIGNydGMsIG5ld19j
cnRjX3N0YXRlLCBpKSB7Cj4gICAJCW5ld19pbnRlbF9jcnRjX3N0YXRlID0gdG9faW50ZWxfY3J0
Y19zdGF0ZShuZXdfY3J0Y19zdGF0ZSk7Cj4gICAKPiAtCQlpZiAoZGV2X3ByaXYtPmRpc3BsYXku
b3B0aW1pemVfd2F0ZXJtYXJrcykKPiAtCQkJZGV2X3ByaXYtPmRpc3BsYXkub3B0aW1pemVfd2F0
ZXJtYXJrcyhpbnRlbF9zdGF0ZSwKPiArCQlpZiAoaTkxNS0+ZGlzcGxheS5vcHRpbWl6ZV93YXRl
cm1hcmtzKQo+ICsJCQlpOTE1LT5kaXNwbGF5Lm9wdGltaXplX3dhdGVybWFya3MoaW50ZWxfc3Rh
dGUsCj4gICAJCQkJCQkJICAgICAgbmV3X2ludGVsX2NydGNfc3RhdGUpOwo+ICAgCX0KPiAgIAo+
IEBAIC0xMzkwNCw3ICsxMzkwNCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2F0b21pY19jb21taXRf
dGFpbChzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gICAJCWludGVsX3Bvc3RfcGxh
bmVfdXBkYXRlKHRvX2ludGVsX2NydGNfc3RhdGUob2xkX2NydGNfc3RhdGUpKTsKPiAgIAo+ICAg
CQlpZiAocHV0X2RvbWFpbnNbaV0pCj4gLQkJCW1vZGVzZXRfcHV0X3Bvd2VyX2RvbWFpbnMoZGV2
X3ByaXYsIHB1dF9kb21haW5zW2ldKTsKPiArCQkJbW9kZXNldF9wdXRfcG93ZXJfZG9tYWlucyhp
OTE1LCBwdXRfZG9tYWluc1tpXSk7Cj4gICAKPiAgIAkJaW50ZWxfbW9kZXNldF92ZXJpZnlfY3J0
YyhjcnRjLCBzdGF0ZSwgb2xkX2NydGNfc3RhdGUsIG5ld19jcnRjX3N0YXRlKTsKPiAgIAl9Cj4g
QEAgLTEzOTEzLDcgKzEzOTEzLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX2NvbW1pdF90
YWlsKHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgIAkJaW50ZWxfdmVyaWZ5X3Bs
YW5lcyhpbnRlbF9zdGF0ZSk7Cj4gICAKPiAgIAlpZiAoaW50ZWxfc3RhdGUtPm1vZGVzZXQgJiYg
aW50ZWxfY2FuX2VuYWJsZV9zYWd2KHN0YXRlKSkKPiAtCQlpbnRlbF9lbmFibGVfc2FndihkZXZf
cHJpdik7Cj4gKwkJaW50ZWxfZW5hYmxlX3NhZ3YoaTkxNSk7Cj4gICAKPiAgIAlkcm1fYXRvbWlj
X2hlbHBlcl9jb21taXRfaHdfZG9uZShzdGF0ZSk7Cj4gICAKPiBAQCAtMTM5MjQsMTAgKzEzOTI0
LDEwIEBAIHN0YXRpYyB2b2lkIGludGVsX2F0b21pY19jb21taXRfdGFpbChzdHJ1Y3QgZHJtX2F0
b21pY19zdGF0ZSAqc3RhdGUpCj4gICAJCSAqIHNvIGVuYWJsZSBkZWJ1Z2dpbmcgZm9yIHRoZSBu
ZXh0IG1vZGVzZXQgLSBhbmQgaG9wZSB3ZSBjYXRjaAo+ICAgCQkgKiB0aGUgY3VscHJpdC4KPiAg
IAkJICovCj4gLQkJaW50ZWxfdW5jb3JlX2FybV91bmNsYWltZWRfbW1pb19kZXRlY3Rpb24oJmRl
dl9wcml2LT51bmNvcmUpOwo+IC0JCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBQ
T1dFUl9ET01BSU5fTU9ERVNFVCwgd2FrZXJlZik7Cj4gKwkJaW50ZWxfdW5jb3JlX2FybV91bmNs
YWltZWRfbW1pb19kZXRlY3Rpb24oJmk5MTUtPnVuY29yZSk7Cj4gKwkJaW50ZWxfZGlzcGxheV9w
b3dlcl9wdXQoaTkxNSwgUE9XRVJfRE9NQUlOX01PREVTRVQsIHdha2VyZWYpOwo+ICAgCX0KPiAt
CWludGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCBpbnRlbF9zdGF0ZS0+d2FrZXJlZik7Cj4g
KwlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCBpbnRlbF9zdGF0ZS0+d2FrZXJlZik7Cj4gICAK
PiAgIAkvKgo+ICAgCSAqIERlZmVyIHRoZSBjbGVhbnVwIG9mIHRoZSBvbGQgc3RhdGUgdG8gYSBz
ZXBhcmF0ZSB3b3JrZXIgdG8gbm90Cj4gQEAgLTE0MDAzLDEwICsxNDAwMywxMCBAQCBzdGF0aWMg
aW50IGludGVsX2F0b21pY19jb21taXQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiAgIAkJCSAg
ICAgICBib29sIG5vbmJsb2NrKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUg
KmludGVsX3N0YXRlID0gdG9faW50ZWxfYXRvbWljX3N0YXRlKHN0YXRlKTsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCWludCByZXQgPSAwOwo+ICAg
Cj4gLQlpbnRlbF9zdGF0ZS0+d2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2
KTsKPiArCWludGVsX3N0YXRlLT53YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7
Cj4gICAKPiAgIAlkcm1fYXRvbWljX3N0YXRlX2dldChzdGF0ZSk7Cj4gICAJaTkxNV9zd19mZW5j
ZV9pbml0KCZpbnRlbF9zdGF0ZS0+Y29tbWl0X3JlYWR5LAo+IEBAIC0xNDAyOSw3ICsxNDAyOSw3
IEBAIHN0YXRpYyBpbnQgaW50ZWxfYXRvbWljX2NvbW1pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
LAo+ICAgCSAqIEZJWE1FIGRvaW5nIHdhdGVybWFya3MgYW5kIGZiIGNsZWFudXAgZnJvbSBhIHZi
bGFuayB3b3JrZXIKPiAgIAkgKiAoYXNzdW1pbmcgd2UgaGFkIGFueSkgd291bGQgc29sdmUgdGhl
c2UgcHJvYmxlbXMuCj4gICAJICovCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDkgJiYg
c3RhdGUtPmxlZ2FjeV9jdXJzb3JfdXBkYXRlKSB7Cj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDwg
OSAmJiBzdGF0ZS0+bGVnYWN5X2N1cnNvcl91cGRhdGUpIHsKPiAgIAkJc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlOwo+ICAgCQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsK
PiAgIAkJaW50IGk7Cj4gQEAgLTE0MDQ0LDcgKzE0MDQ0LDcgQEAgc3RhdGljIGludCBpbnRlbF9h
dG9taWNfY29tbWl0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gICAJaWYgKHJldCkgewo+ICAg
CQlEUk1fREVCVUdfQVRPTUlDKCJQcmVwYXJpbmcgc3RhdGUgZmFpbGVkIHdpdGggJWlcbiIsIHJl
dCk7Cj4gICAJCWk5MTVfc3dfZmVuY2VfY29tbWl0KCZpbnRlbF9zdGF0ZS0+Y29tbWl0X3JlYWR5
KTsKPiAtCQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgaW50ZWxfc3RhdGUtPndha2Vy
ZWYpOwo+ICsJCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIGludGVsX3N0YXRlLT53YWtlcmVm
KTsKPiAgIAkJcmV0dXJuIHJldDsKPiAgIAl9Cj4gICAKPiBAQCAtMTQwNTYsMjEgKzE0MDU2LDIx
IEBAIHN0YXRpYyBpbnQgaW50ZWxfYXRvbWljX2NvbW1pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
LAo+ICAgCQlpOTE1X3N3X2ZlbmNlX2NvbW1pdCgmaW50ZWxfc3RhdGUtPmNvbW1pdF9yZWFkeSk7
Cj4gICAKPiAgIAkJZHJtX2F0b21pY19oZWxwZXJfY2xlYW51cF9wbGFuZXMoZGV2LCBzdGF0ZSk7
Cj4gLQkJaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIGludGVsX3N0YXRlLT53YWtlcmVm
KTsKPiArCQlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCBpbnRlbF9zdGF0ZS0+d2FrZXJlZik7
Cj4gICAJCXJldHVybiByZXQ7Cj4gICAJfQo+IC0JZGV2X3ByaXYtPndtLmRpc3RydXN0X2Jpb3Nf
d20gPSBmYWxzZTsKPiArCWk5MTUtPndtLmRpc3RydXN0X2Jpb3Nfd20gPSBmYWxzZTsKPiAgIAlp
bnRlbF9zaGFyZWRfZHBsbF9zd2FwX3N0YXRlKHN0YXRlKTsKPiAgIAlpbnRlbF9hdG9taWNfdHJh
Y2tfZmJzKHN0YXRlKTsKPiAgIAo+ICAgCWlmIChpbnRlbF9zdGF0ZS0+bW9kZXNldCkgewo+IC0J
CW1lbWNweShkZXZfcHJpdi0+bWluX2NkY2xrLCBpbnRlbF9zdGF0ZS0+bWluX2NkY2xrLAo+ICsJ
CW1lbWNweShpOTE1LT5taW5fY2RjbGssIGludGVsX3N0YXRlLT5taW5fY2RjbGssCj4gICAJCSAg
ICAgICBzaXplb2YoaW50ZWxfc3RhdGUtPm1pbl9jZGNsaykpOwo+IC0JCW1lbWNweShkZXZfcHJp
di0+bWluX3ZvbHRhZ2VfbGV2ZWwsCj4gKwkJbWVtY3B5KGk5MTUtPm1pbl92b2x0YWdlX2xldmVs
LAo+ICAgCQkgICAgICAgaW50ZWxfc3RhdGUtPm1pbl92b2x0YWdlX2xldmVsLAo+ICAgCQkgICAg
ICAgc2l6ZW9mKGludGVsX3N0YXRlLT5taW5fdm9sdGFnZV9sZXZlbCkpOwo+IC0JCWRldl9wcml2
LT5hY3RpdmVfY3J0Y3MgPSBpbnRlbF9zdGF0ZS0+YWN0aXZlX2NydGNzOwo+IC0JCWRldl9wcml2
LT5jZGNsay5mb3JjZV9taW5fY2RjbGsgPQo+ICsJCWk5MTUtPmFjdGl2ZV9jcnRjcyA9IGludGVs
X3N0YXRlLT5hY3RpdmVfY3J0Y3M7Cj4gKwkJaTkxNS0+Y2RjbGsuZm9yY2VfbWluX2NkY2xrID0K
PiAgIAkJCWludGVsX3N0YXRlLT5jZGNsay5mb3JjZV9taW5fY2RjbGs7Cj4gICAKPiAgIAkJaW50
ZWxfY2RjbGtfc3dhcF9zdGF0ZShpbnRlbF9zdGF0ZSk7Cj4gQEAgLTE0MDgxLDEyICsxNDA4MSwx
MiBAQCBzdGF0aWMgaW50IGludGVsX2F0b21pY19jb21taXQoc3RydWN0IGRybV9kZXZpY2UgKmRl
diwKPiAgIAo+ICAgCWk5MTVfc3dfZmVuY2VfY29tbWl0KCZpbnRlbF9zdGF0ZS0+Y29tbWl0X3Jl
YWR5KTsKPiAgIAlpZiAobm9uYmxvY2sgJiYgaW50ZWxfc3RhdGUtPm1vZGVzZXQpIHsKPiAtCQlx
dWV1ZV93b3JrKGRldl9wcml2LT5tb2Rlc2V0X3dxLCAmc3RhdGUtPmNvbW1pdF93b3JrKTsKPiAr
CQlxdWV1ZV93b3JrKGk5MTUtPm1vZGVzZXRfd3EsICZzdGF0ZS0+Y29tbWl0X3dvcmspOwo+ICAg
CX0gZWxzZSBpZiAobm9uYmxvY2spIHsKPiAgIAkJcXVldWVfd29yayhzeXN0ZW1fdW5ib3VuZF93
cSwgJnN0YXRlLT5jb21taXRfd29yayk7Cj4gICAJfSBlbHNlIHsKPiAgIAkJaWYgKGludGVsX3N0
YXRlLT5tb2Rlc2V0KQo+IC0JCQlmbHVzaF93b3JrcXVldWUoZGV2X3ByaXYtPm1vZGVzZXRfd3Ep
Owo+ICsJCQlmbHVzaF93b3JrcXVldWUoaTkxNS0+bW9kZXNldF93cSk7Cj4gICAJCWludGVsX2F0
b21pY19jb21taXRfdGFpbChzdGF0ZSk7Cj4gICAJfQo+ICAgCj4gQEAgLTE0MTY2LDE0ICsxNDE2
NiwxNCBAQCBzdGF0aWMgdm9pZCBhZGRfcnBzX2Jvb3N0X2FmdGVyX3ZibGFuayhzdHJ1Y3QgZHJt
X2NydGMgKmNydGMsCj4gICBzdGF0aWMgaW50IGludGVsX3BsYW5lX3Bpbl9mYihzdHJ1Y3QgaW50
ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9wbGFu
ZSAqcGxhbmUgPSB0b19pbnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZSk7Cj4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRl
dik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUocGxhbmUtPmJh
c2UuZGV2KTsKPiAgIAlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IHBsYW5lX3N0YXRlLT5i
YXNlLmZiOwo+ICAgCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwo+ICAgCj4gICAJaWYgKHBsYW5lLT5p
ZCA9PSBQTEFORV9DVVJTT1IgJiYKPiAtCSAgICBJTlRFTF9JTkZPKGRldl9wcml2KS0+ZGlzcGxh
eS5jdXJzb3JfbmVlZHNfcGh5c2ljYWwpIHsKPiArCSAgICBJTlRFTF9JTkZPKGk5MTUpLT5kaXNw
bGF5LmN1cnNvcl9uZWVkc19waHlzaWNhbCkgewo+ICAgCQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29i
amVjdCAqb2JqID0gaW50ZWxfZmJfb2JqKGZiKTsKPiAtCQljb25zdCBpbnQgYWxpZ24gPSBpbnRl
bF9jdXJzb3JfYWxpZ25tZW50KGRldl9wcml2KTsKPiArCQljb25zdCBpbnQgYWxpZ24gPSBpbnRl
bF9jdXJzb3JfYWxpZ25tZW50KGk5MTUpOwo+ICAgCQlpbnQgZXJyOwo+ICAgCj4gICAJCWVyciA9
IGk5MTVfZ2VtX29iamVjdF9hdHRhY2hfcGh5cyhvYmosIGFsaWduKTsKPiBAQCAtMTQyMzEsNyAr
MTQyMzEsNyBAQCBpbnRlbF9wcmVwYXJlX3BsYW5lX2ZiKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5l
LAo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKmludGVsX3N0YXRlID0KPiAg
IAkJdG9faW50ZWxfYXRvbWljX3N0YXRlKG5ld19zdGF0ZS0+c3RhdGUpOwo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShwbGFuZS0+ZGV2KTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShwbGFuZS0+ZGV2KTsKPiAgIAlzdHJ1
Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IG5ld19zdGF0ZS0+ZmI7Cj4gICAJc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3QgKm9iaiA9IGludGVsX2ZiX29iaihmYik7Cj4gICAJc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3QgKm9sZF9vYmogPSBpbnRlbF9mYl9vYmoocGxhbmUtPnN0YXRlLT5mYik7
Cj4gQEAgLTE0Mjc5LDcgKzE0Mjc5LDcgQEAgaW50ZWxfcHJlcGFyZV9wbGFuZV9mYihzdHJ1Y3Qg
ZHJtX3BsYW5lICpwbGFuZSwKPiAgIAlpZiAocmV0KQo+ICAgCQlyZXR1cm4gcmV0Owo+ICAgCj4g
LQlyZXQgPSBtdXRleF9sb2NrX2ludGVycnVwdGlibGUoJmRldl9wcml2LT5kcm0uc3RydWN0X211
dGV4KTsKPiArCXJldCA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmaTkxNS0+ZHJtLnN0cnVj
dF9tdXRleCk7Cj4gICAJaWYgKHJldCkgewo+ICAgCQlpOTE1X2dlbV9vYmplY3RfdW5waW5fcGFn
ZXMob2JqKTsKPiAgIAkJcmV0dXJuIHJldDsKPiBAQCAtMTQyODcsNyArMTQyODcsNyBAQCBpbnRl
bF9wcmVwYXJlX3BsYW5lX2ZiKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLAo+ICAgCj4gICAJcmV0
ID0gaW50ZWxfcGxhbmVfcGluX2ZiKHRvX2ludGVsX3BsYW5lX3N0YXRlKG5ld19zdGF0ZSkpOwo+
ICAgCj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiArCW11
dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAJaTkxNV9nZW1fb2JqZWN0
X3VucGluX3BhZ2VzKG9iaik7Cj4gICAJaWYgKHJldCkKPiAgIAkJcmV0dXJuIHJldDsKPiBAQCAt
MTQzMjMsNyArMTQzMjMsNyBAQCBpbnRlbF9wcmVwYXJlX3BsYW5lX2ZiKHN0cnVjdCBkcm1fcGxh
bmUgKnBsYW5lLAo+ICAgCSAqIG1heGltdW0gY2xvY2tzIGZvbGxvd2luZyBhIHZibGFuayBtaXNz
IChzZWUgZG9fcnBzX2Jvb3N0KCkpLgo+ICAgCSAqLwo+ICAgCWlmICghaW50ZWxfc3RhdGUtPnJw
c19pbnRlcmFjdGl2ZSkgewo+IC0JCWludGVsX3Jwc19tYXJrX2ludGVyYWN0aXZlKGRldl9wcml2
LCB0cnVlKTsKPiArCQlpbnRlbF9ycHNfbWFya19pbnRlcmFjdGl2ZShpOTE1LCB0cnVlKTsKPiAg
IAkJaW50ZWxfc3RhdGUtPnJwc19pbnRlcmFjdGl2ZSA9IHRydWU7Cj4gICAJfQo+ICAgCj4gQEAg
LTE0MzQ1LDE3ICsxNDM0NSwxNyBAQCBpbnRlbF9jbGVhbnVwX3BsYW5lX2ZiKHN0cnVjdCBkcm1f
cGxhbmUgKnBsYW5lLAo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKmludGVs
X3N0YXRlID0KPiAgIAkJdG9faW50ZWxfYXRvbWljX3N0YXRlKG9sZF9zdGF0ZS0+c3RhdGUpOwo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShwbGFuZS0+ZGV2
KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShwbGFuZS0+ZGV2
KTsKPiAgIAo+ICAgCWlmIChpbnRlbF9zdGF0ZS0+cnBzX2ludGVyYWN0aXZlKSB7Cj4gLQkJaW50
ZWxfcnBzX21hcmtfaW50ZXJhY3RpdmUoZGV2X3ByaXYsIGZhbHNlKTsKPiArCQlpbnRlbF9ycHNf
bWFya19pbnRlcmFjdGl2ZShpOTE1LCBmYWxzZSk7Cj4gICAJCWludGVsX3N0YXRlLT5ycHNfaW50
ZXJhY3RpdmUgPSBmYWxzZTsKPiAgIAl9Cj4gICAKPiAgIAkvKiBTaG91bGQgb25seSBiZSBjYWxs
ZWQgYWZ0ZXIgYSBzdWNjZXNzZnVsIGludGVsX3ByZXBhcmVfcGxhbmVfZmIoKSEgKi8KPiAtCW11
dGV4X2xvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiArCW11dGV4X2xvY2soJmk5
MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCWludGVsX3BsYW5lX3VucGluX2ZiKHRvX2ludGVs
X3BsYW5lX3N0YXRlKG9sZF9zdGF0ZSkpOwo+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJt
LnN0cnVjdF9tdXRleCk7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgp
Owo+ICAgfQo+ICAgCj4gICBpbnQKPiBAQCAtMTQzNjMsNyArMTQzNjMsNyBAQCBza2xfbWF4X3Nj
YWxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCSAgICAg
IHUzMiBwaXhlbF9mb3JtYXQpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0
b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gICAJaW50
IG1heF9zY2FsZSwgbXVsdDsKPiAgIAlpbnQgY3J0Y19jbG9jaywgbWF4X2RvdGNsaywgdG1wY2xr
MSwgdG1wY2xrMjsKPiAgIAo+IEBAIC0xNDM3Myw3ICsxNDM3Myw3IEBAIHNrbF9tYXhfc2NhbGUo
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICAJY3J0Y19jbG9j
ayA9IGNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrOwo+ICAgCW1heF9k
b3RjbGsgPSB0b19pbnRlbF9hdG9taWNfc3RhdGUoY3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZSktPmNk
Y2xrLmxvZ2ljYWwuY2RjbGs7Cj4gICAKPiAtCWlmIChJU19HRU1JTklMQUtFKGRldl9wcml2KSB8
fCBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwKQo+ICsJaWYgKElTX0dFTUlOSUxBS0UoaTkxNSkg
fHwgSU5URUxfR0VOKGk5MTUpID49IDEwKQo+ICAgCQltYXhfZG90Y2xrICo9IDI7Cj4gICAKPiAg
IAlpZiAoV0FSTl9PTl9PTkNFKCFjcnRjX2Nsb2NrIHx8IG1heF9kb3RjbGsgPCBjcnRjX2Nsb2Nr
KSkKPiBAQCAtMTQzOTYsNyArMTQzOTYsNyBAQCBza2xfbWF4X3NjYWxlKGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgc3RhdGljIHZvaWQgaW50ZWxfYmVnaW5f
Y3J0Y19jb21taXQoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4gICAJCQkJICAg
IHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSA9Cj4gICAJCWludGVsX2F0b21pY19nZXRf
b2xkX2NydGNfc3RhdGUoc3RhdGUsIGNydGMpOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpuZXdfY3J0Y19zdGF0ZSA9Cj4gQEAgLTE0NDE1LDMxICsxNDQxNSwzMSBAQCBzdGF0aWMgdm9p
ZCBpbnRlbF9iZWdpbl9jcnRjX2NvbW1pdChzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0
ZSwKPiAgIAo+ICAgCWlmIChuZXdfY3J0Y19zdGF0ZS0+dXBkYXRlX3BpcGUpCj4gICAJCWludGVs
X3VwZGF0ZV9waXBlX2NvbmZpZyhvbGRfY3J0Y19zdGF0ZSwgbmV3X2NydGNfc3RhdGUpOwo+IC0J
ZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KQo+ICsJZWxzZSBpZiAoSU5URUxfR0VO
KGk5MTUpID49IDkpCj4gICAJCXNrbF9kZXRhY2hfc2NhbGVycyhuZXdfY3J0Y19zdGF0ZSk7Cj4g
ICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkgfHwgSVNfQlJPQURXRUxMKGRldl9w
cml2KSkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSB8fCBJU19CUk9BRFdFTEwoaTkxNSkp
Cj4gICAJCWJkd19zZXRfcGlwZW1pc2MobmV3X2NydGNfc3RhdGUpOwo+ICAgCj4gICBvdXQ6Cj4g
LQlpZiAoZGV2X3ByaXYtPmRpc3BsYXkuYXRvbWljX3VwZGF0ZV93YXRlcm1hcmtzKQo+IC0JCWRl
dl9wcml2LT5kaXNwbGF5LmF0b21pY191cGRhdGVfd2F0ZXJtYXJrcyhzdGF0ZSwKPiArCWlmIChp
OTE1LT5kaXNwbGF5LmF0b21pY191cGRhdGVfd2F0ZXJtYXJrcykKPiArCQlpOTE1LT5kaXNwbGF5
LmF0b21pY191cGRhdGVfd2F0ZXJtYXJrcyhzdGF0ZSwKPiAgIAkJCQkJCQkgICBuZXdfY3J0Y19z
dGF0ZSk7Cj4gICB9Cj4gICAKPiAgIHZvaWQgaW50ZWxfY3J0Y19hcm1fZmlmb191bmRlcnJ1bihz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAkJCQkgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAgCj4gLQlpZiAoIUlTX0dFTihkZXZf
cHJpdiwgMikpCj4gLQkJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZf
cHJpdiwgY3J0Yy0+cGlwZSwgdHJ1ZSk7Cj4gKwlpZiAoIUlTX0dFTihpOTE1LCAyKSkKPiArCQlp
bnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGk5MTUsIGNydGMtPnBpcGUsIHRy
dWUpOwo+ICAgCj4gICAJaWYgKGNydGNfc3RhdGUtPmhhc19wY2hfZW5jb2Rlcikgewo+ICAgCQll
bnVtIHBpcGUgcGNoX3RyYW5zY29kZXIgPQo+ICAgCQkJaW50ZWxfY3J0Y19wY2hfdHJhbnNjb2Rl
cihjcnRjKTsKPiAgIAo+IC0JCWludGVsX3NldF9wY2hfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmco
ZGV2X3ByaXYsIHBjaF90cmFuc2NvZGVyLCB0cnVlKTsKPiArCQlpbnRlbF9zZXRfcGNoX2ZpZm9f
dW5kZXJydW5fcmVwb3J0aW5nKGk5MTUsIHBjaF90cmFuc2NvZGVyLCB0cnVlKTsKPiAgIAl9Cj4g
ICB9Cj4gICAKPiBAQCAtMTQ1NTksNyArMTQ1NTksNyBAQCBpbnRlbF9sZWdhY3lfY3Vyc29yX3Vw
ZGF0ZShzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKPiAgIAkJCSAgIHUzMiBzcmNfdywgdTMyIHNy
Y19oLAo+ICAgCQkJICAgc3RydWN0IGRybV9tb2Rlc2V0X2FjcXVpcmVfY3R4ICpjdHgpCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmRl
dik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+ZGV2
KTsKPiAgIAlpbnQgcmV0Owo+ICAgCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm9sZF9wbGFuZV9z
dGF0ZSwgKm5ld19wbGFuZV9zdGF0ZTsKPiAgIAlzdHJ1Y3QgaW50ZWxfcGxhbmUgKmludGVsX3Bs
YW5lID0gdG9faW50ZWxfcGxhbmUocGxhbmUpOwo+IEBAIC0xNDYyNiw3ICsxNDYyNiw3IEBAIGlu
dGVsX2xlZ2FjeV9jdXJzb3JfdXBkYXRlKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLAo+ICAgCWlm
IChyZXQpCj4gICAJCWdvdG8gb3V0X2ZyZWU7Cj4gICAKPiAtCXJldCA9IG11dGV4X2xvY2tfaW50
ZXJydXB0aWJsZSgmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJcmV0ID0gbXV0ZXhf
bG9ja19pbnRlcnJ1cHRpYmxlKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAlpZiAocmV0
KQo+ICAgCQlnb3RvIG91dF9mcmVlOwo+ICAgCj4gQEAgLTE0NjY0LDcgKzE0NjY0LDcgQEAgaW50
ZWxfbGVnYWN5X2N1cnNvcl91cGRhdGUoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsCj4gICAJaW50
ZWxfcGxhbmVfdW5waW5fZmIodG9faW50ZWxfcGxhbmVfc3RhdGUob2xkX3BsYW5lX3N0YXRlKSk7
Cj4gICAKPiAgIG91dF91bmxvY2s6Cj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5kcm0uc3Ry
dWN0X211dGV4KTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4g
ICBvdXRfZnJlZToKPiAgIAlpZiAobmV3X2NydGNfc3RhdGUpCj4gICAJCWludGVsX2NydGNfZGVz
dHJveV9zdGF0ZShjcnRjLCAmbmV3X2NydGNfc3RhdGUtPmJhc2UpOwo+IEBAIC0xNDY5MSwyNSAr
MTQ2OTEsMjUgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfZnVuY3MgaW50ZWxfY3Vy
c29yX3BsYW5lX2Z1bmNzID0gewo+ICAgCS5mb3JtYXRfbW9kX3N1cHBvcnRlZCA9IGludGVsX2N1
cnNvcl9mb3JtYXRfbW9kX3N1cHBvcnRlZCwKPiAgIH07Cj4gICAKPiAtc3RhdGljIGJvb2wgaTl4
eF9wbGFuZV9oYXNfZmJjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3Rh
dGljIGJvb2wgaTl4eF9wbGFuZV9oYXNfZmJjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAo+ICAgCQkJICAgICAgIGVudW0gaTl4eF9wbGFuZV9pZCBpOXh4X3BsYW5lKQo+ICAgewo+IC0J
aWYgKCFIQVNfRkJDKGRldl9wcml2KSkKPiArCWlmICghSEFTX0ZCQyhpOTE1KSkKPiAgIAkJcmV0
dXJuIGZhbHNlOwo+ICAgCj4gLQlpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSB8fCBJU19IQVNX
RUxMKGRldl9wcml2KSkKPiArCWlmIChJU19CUk9BRFdFTEwoaTkxNSkgfHwgSVNfSEFTV0VMTChp
OTE1KSkKPiAgIAkJcmV0dXJuIGk5eHhfcGxhbmUgPT0gUExBTkVfQTsgLyogdGllZCB0byBwaXBl
IEEgKi8KPiAtCWVsc2UgaWYgKElTX0lWWUJSSURHRShkZXZfcHJpdikpCj4gKwllbHNlIGlmIChJ
U19JVllCUklER0UoaTkxNSkpCj4gICAJCXJldHVybiBpOXh4X3BsYW5lID09IFBMQU5FX0EgfHwg
aTl4eF9wbGFuZSA9PSBQTEFORV9CIHx8Cj4gICAJCQlpOXh4X3BsYW5lID09IFBMQU5FX0M7Cj4g
LQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDQpCj4gKwllbHNlIGlmIChJTlRFTF9H
RU4oaTkxNSkgPj0gNCkKPiAgIAkJcmV0dXJuIGk5eHhfcGxhbmUgPT0gUExBTkVfQSB8fCBpOXh4
X3BsYW5lID09IFBMQU5FX0I7Cj4gICAJZWxzZQo+ICAgCQlyZXR1cm4gaTl4eF9wbGFuZSA9PSBQ
TEFORV9BOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgc3RydWN0IGludGVsX3BsYW5lICoKPiAtaW50
ZWxfcHJpbWFyeV9wbGFuZV9jcmVhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LCBlbnVtIHBpcGUgcGlwZSkKPiAraW50ZWxfcHJpbWFyeV9wbGFuZV9jcmVhdGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gcGlwZSBwaXBlKQo+ICAgewo+ICAgCXN0cnVjdCBp
bnRlbF9wbGFuZSAqcGxhbmU7Cj4gICAJY29uc3Qgc3RydWN0IGRybV9wbGFuZV9mdW5jcyAqcGxh
bmVfZnVuY3M7Cj4gQEAgLTE0NzIwLDggKzE0NzIwLDggQEAgaW50ZWxfcHJpbWFyeV9wbGFuZV9j
cmVhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUgcGlwZSkK
PiAgIAlpbnQgbnVtX2Zvcm1hdHM7Cj4gICAJaW50IHJldDsKPiAgIAo+IC0JaWYgKElOVEVMX0dF
TihkZXZfcHJpdikgPj0gOSkKPiAtCQlyZXR1cm4gc2tsX3VuaXZlcnNhbF9wbGFuZV9jcmVhdGUo
ZGV2X3ByaXYsIHBpcGUsCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkpCj4gKwkJcmV0dXJu
IHNrbF91bml2ZXJzYWxfcGxhbmVfY3JlYXRlKGk5MTUsIHBpcGUsCj4gICAJCQkJCQkgIFBMQU5F
X1BSSU1BUlkpOwo+ICAgCj4gICAJcGxhbmUgPSBpbnRlbF9wbGFuZV9hbGxvYygpOwo+IEBAIC0x
NDczMywyMSArMTQ3MzMsMjEgQEAgaW50ZWxfcHJpbWFyeV9wbGFuZV9jcmVhdGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUgcGlwZSkKPiAgIAkgKiBPbiBnZW4y
LzMgb25seSBwbGFuZSBBIGNhbiBkbyBGQkMsIGJ1dCB0aGUgcGFuZWwgZml0dGVyIGFuZCBMVkRT
Cj4gICAJICogcG9ydCBpcyBob29rZWQgdG8gcGlwZSBCLiBIZW5jZSB3ZSB3YW50IHBsYW5lIEEg
ZmVlZGluZyBwaXBlIEIuCj4gICAJICovCj4gLQlpZiAoSEFTX0ZCQyhkZXZfcHJpdikgJiYgSU5U
RUxfR0VOKGRldl9wcml2KSA8IDQpCj4gKwlpZiAoSEFTX0ZCQyhpOTE1KSAmJiBJTlRFTF9HRU4o
aTkxNSkgPCA0KQo+ICAgCQlwbGFuZS0+aTl4eF9wbGFuZSA9IChlbnVtIGk5eHhfcGxhbmVfaWQp
ICFwaXBlOwo+ICAgCWVsc2UKPiAgIAkJcGxhbmUtPmk5eHhfcGxhbmUgPSAoZW51bSBpOXh4X3Bs
YW5lX2lkKSBwaXBlOwo+ICAgCXBsYW5lLT5pZCA9IFBMQU5FX1BSSU1BUlk7Cj4gICAJcGxhbmUt
PmZyb250YnVmZmVyX2JpdCA9IElOVEVMX0ZST05UQlVGRkVSKHBpcGUsIHBsYW5lLT5pZCk7Cj4g
ICAKPiAtCXBsYW5lLT5oYXNfZmJjID0gaTl4eF9wbGFuZV9oYXNfZmJjKGRldl9wcml2LCBwbGFu
ZS0+aTl4eF9wbGFuZSk7Cj4gKwlwbGFuZS0+aGFzX2ZiYyA9IGk5eHhfcGxhbmVfaGFzX2ZiYyhp
OTE1LCBwbGFuZS0+aTl4eF9wbGFuZSk7Cj4gICAJaWYgKHBsYW5lLT5oYXNfZmJjKSB7Cj4gLQkJ
c3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmRldl9wcml2LT5mYmM7Cj4gKwkJc3RydWN0IGludGVs
X2ZiYyAqZmJjID0gJmk5MTUtPmZiYzsKPiAgIAo+ICAgCQlmYmMtPnBvc3NpYmxlX2ZyYW1lYnVm
ZmVyX2JpdHMgfD0gcGxhbmUtPmZyb250YnVmZmVyX2JpdDsKPiAgIAl9Cj4gICAKPiAtCWlmIChJ
TlRFTF9HRU4oZGV2X3ByaXYpID49IDQpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNCkg
ewo+ICAgCQlmb3JtYXRzID0gaTk2NV9wcmltYXJ5X2Zvcm1hdHM7Cj4gICAJCW51bV9mb3JtYXRz
ID0gQVJSQVlfU0laRShpOTY1X3ByaW1hcnlfZm9ybWF0cyk7Cj4gICAJCW1vZGlmaWVycyA9IGk5
eHhfZm9ybWF0X21vZGlmaWVyczsKPiBAQCAtMTQ3NzUsMTQgKzE0Nzc1LDE0IEBAIGludGVsX3By
aW1hcnlfcGxhbmVfY3JlYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51
bSBwaXBlIHBpcGUpCj4gICAKPiAgIAlwb3NzaWJsZV9jcnRjcyA9IEJJVChwaXBlKTsKPiAgIAo+
IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNSB8fCBJU19HNFgoZGV2X3ByaXYpKQo+IC0J
CXJldCA9IGRybV91bml2ZXJzYWxfcGxhbmVfaW5pdCgmZGV2X3ByaXYtPmRybSwgJnBsYW5lLT5i
YXNlLAo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA1IHx8IElTX0c0WChpOTE1KSkKPiArCQly
ZXQgPSBkcm1fdW5pdmVyc2FsX3BsYW5lX2luaXQoJmk5MTUtPmRybSwgJnBsYW5lLT5iYXNlLAo+
ICAgCQkJCQkgICAgICAgcG9zc2libGVfY3J0Y3MsIHBsYW5lX2Z1bmNzLAo+ICAgCQkJCQkgICAg
ICAgZm9ybWF0cywgbnVtX2Zvcm1hdHMsIG1vZGlmaWVycywKPiAgIAkJCQkJICAgICAgIERSTV9Q
TEFORV9UWVBFX1BSSU1BUlksCj4gICAJCQkJCSAgICAgICAicHJpbWFyeSAlYyIsIHBpcGVfbmFt
ZShwaXBlKSk7Cj4gICAJZWxzZQo+IC0JCXJldCA9IGRybV91bml2ZXJzYWxfcGxhbmVfaW5pdCgm
ZGV2X3ByaXYtPmRybSwgJnBsYW5lLT5iYXNlLAo+ICsJCXJldCA9IGRybV91bml2ZXJzYWxfcGxh
bmVfaW5pdCgmaTkxNS0+ZHJtLCAmcGxhbmUtPmJhc2UsCj4gICAJCQkJCSAgICAgICBwb3NzaWJs
ZV9jcnRjcywgcGxhbmVfZnVuY3MsCj4gICAJCQkJCSAgICAgICBmb3JtYXRzLCBudW1fZm9ybWF0
cywgbW9kaWZpZXJzLAo+ICAgCQkJCQkgICAgICAgRFJNX1BMQU5FX1RZUEVfUFJJTUFSWSwKPiBA
QCAtMTQ3OTEsMTggKzE0NzkxLDE4IEBAIGludGVsX3ByaW1hcnlfcGxhbmVfY3JlYXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUpCj4gICAJaWYgKHJl
dCkKPiAgIAkJZ290byBmYWlsOwo+ICAgCj4gLQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikg
JiYgcGlwZSA9PSBQSVBFX0IpIHsKPiArCWlmIChJU19DSEVSUllWSUVXKGk5MTUpICYmIHBpcGUg
PT0gUElQRV9CKSB7Cj4gICAJCXN1cHBvcnRlZF9yb3RhdGlvbnMgPQo+ICAgCQkJRFJNX01PREVf
Uk9UQVRFXzAgfCBEUk1fTU9ERV9ST1RBVEVfMTgwIHwKPiAgIAkJCURSTV9NT0RFX1JFRkxFQ1Rf
WDsKPiAtCX0gZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA0KSB7Cj4gKwl9IGVsc2Ug
aWYgKElOVEVMX0dFTihpOTE1KSA+PSA0KSB7Cj4gICAJCXN1cHBvcnRlZF9yb3RhdGlvbnMgPQo+
ICAgCQkJRFJNX01PREVfUk9UQVRFXzAgfCBEUk1fTU9ERV9ST1RBVEVfMTgwOwo+ICAgCX0gZWxz
ZSB7Cj4gICAJCXN1cHBvcnRlZF9yb3RhdGlvbnMgPSBEUk1fTU9ERV9ST1RBVEVfMDsKPiAgIAl9
Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDQpCj4gKwlpZiAoSU5URUxfR0VO
KGk5MTUpID49IDQpCj4gICAJCWRybV9wbGFuZV9jcmVhdGVfcm90YXRpb25fcHJvcGVydHkoJnBs
YW5lLT5iYXNlLAo+ICAgCQkJCQkJICAgRFJNX01PREVfUk9UQVRFXzAsCj4gICAJCQkJCQkgICBz
dXBwb3J0ZWRfcm90YXRpb25zKTsKPiBAQCAtMTQ4MTgsNyArMTQ4MTgsNyBAQCBpbnRlbF9wcmlt
YXJ5X3BsYW5lX2NyZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0g
cGlwZSBwaXBlKQo+ICAgfQo+ICAgCj4gICBzdGF0aWMgc3RydWN0IGludGVsX3BsYW5lICoKPiAt
aW50ZWxfY3Vyc29yX3BsYW5lX2NyZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gK2ludGVsX2N1cnNvcl9wbGFuZV9jcmVhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCj4gICAJCQkgIGVudW0gcGlwZSBwaXBlKQo+ICAgewo+ICAgCXVuc2lnbmVkIGludCBw
b3NzaWJsZV9jcnRjczsKPiBAQCAtMTQ4MzQsNyArMTQ4MzQsNyBAQCBpbnRlbF9jdXJzb3JfcGxh
bmVfY3JlYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAljdXJzb3It
PmlkID0gUExBTkVfQ1VSU09SOwo+ICAgCWN1cnNvci0+ZnJvbnRidWZmZXJfYml0ID0gSU5URUxf
RlJPTlRCVUZGRVIocGlwZSwgY3Vyc29yLT5pZCk7Cj4gICAKPiAtCWlmIChJU19JODQ1RyhkZXZf
cHJpdikgfHwgSVNfSTg2NUcoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfSTg0NUcoaTkxNSkgfHwg
SVNfSTg2NUcoaTkxNSkpIHsKPiAgIAkJY3Vyc29yLT5tYXhfc3RyaWRlID0gaTg0NV9jdXJzb3Jf
bWF4X3N0cmlkZTsKPiAgIAkJY3Vyc29yLT51cGRhdGVfcGxhbmUgPSBpODQ1X3VwZGF0ZV9jdXJz
b3I7Cj4gICAJCWN1cnNvci0+ZGlzYWJsZV9wbGFuZSA9IGk4NDVfZGlzYWJsZV9jdXJzb3I7Cj4g
QEAgLTE0ODUxLDEyICsxNDg1MSwxMiBAQCBpbnRlbF9jdXJzb3JfcGxhbmVfY3JlYXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAljdXJzb3ItPmN1cnNvci5iYXNlID0g
fjA7Cj4gICAJY3Vyc29yLT5jdXJzb3IuY250bCA9IH4wOwo+ICAgCj4gLQlpZiAoSVNfSTg0NUco
ZGV2X3ByaXYpIHx8IElTX0k4NjVHKGRldl9wcml2KSB8fCBIQVNfQ1VSX0ZCQyhkZXZfcHJpdikp
Cj4gKwlpZiAoSVNfSTg0NUcoaTkxNSkgfHwgSVNfSTg2NUcoaTkxNSkgfHwgSEFTX0NVUl9GQkMo
aTkxNSkpCj4gICAJCWN1cnNvci0+Y3Vyc29yLnNpemUgPSB+MDsKPiAgIAo+ICAgCXBvc3NpYmxl
X2NydGNzID0gQklUKHBpcGUpOwo+ICAgCj4gLQlyZXQgPSBkcm1fdW5pdmVyc2FsX3BsYW5lX2lu
aXQoJmRldl9wcml2LT5kcm0sICZjdXJzb3ItPmJhc2UsCj4gKwlyZXQgPSBkcm1fdW5pdmVyc2Fs
X3BsYW5lX2luaXQoJmk5MTUtPmRybSwgJmN1cnNvci0+YmFzZSwKPiAgIAkJCQkgICAgICAgcG9z
c2libGVfY3J0Y3MsICZpbnRlbF9jdXJzb3JfcGxhbmVfZnVuY3MsCj4gICAJCQkJICAgICAgIGlu
dGVsX2N1cnNvcl9mb3JtYXRzLAo+ICAgCQkJCSAgICAgICBBUlJBWV9TSVpFKGludGVsX2N1cnNv
cl9mb3JtYXRzKSwKPiBAQCAtMTQ4NjYsNyArMTQ4NjYsNyBAQCBpbnRlbF9jdXJzb3JfcGxhbmVf
Y3JlYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlpZiAocmV0KQo+
ICAgCQlnb3RvIGZhaWw7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDQpCj4g
KwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDQpCj4gICAJCWRybV9wbGFuZV9jcmVhdGVfcm90YXRp
b25fcHJvcGVydHkoJmN1cnNvci0+YmFzZSwKPiAgIAkJCQkJCSAgIERSTV9NT0RFX1JPVEFURV8w
LAo+ICAgCQkJCQkJICAgRFJNX01PREVfUk9UQVRFXzAgfAo+IEBAIC0xNDg4NywxMCArMTQ4ODcs
MTAgQEAgc3RhdGljIHZvaWQgaW50ZWxfY3J0Y19pbml0X3NjYWxlcnMoc3RydWN0IGludGVsX2Ny
dGMgKmNydGMsCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2NydGNfc2NhbGVyX3N0YXRlICpzY2Fs
ZXJfc3RhdGUgPQo+ICAgCQkmY3J0Y19zdGF0ZS0+c2NhbGVyX3N0YXRlOwo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+
ICAgCWludCBpOwo+ICAgCj4gLQljcnRjLT5udW1fc2NhbGVycyA9IFJVTlRJTUVfSU5GTyhkZXZf
cHJpdiktPm51bV9zY2FsZXJzW2NydGMtPnBpcGVdOwo+ICsJY3J0Yy0+bnVtX3NjYWxlcnMgPSBS
VU5USU1FX0lORk8oaTkxNSktPm51bV9zY2FsZXJzW2NydGMtPnBpcGVdOwo+ICAgCWlmICghY3J0
Yy0+bnVtX3NjYWxlcnMpCj4gICAJCXJldHVybjsKPiAgIAo+IEBAIC0xNDkwNCw3ICsxNDkwNCw3
IEBAIHN0YXRpYyB2b2lkIGludGVsX2NydGNfaW5pdF9zY2FsZXJzKHN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjLAo+ICAgCXNjYWxlcl9zdGF0ZS0+c2NhbGVyX2lkID0gLTE7Cj4gICB9Cj4gICAKPiAt
c3RhdGljIGludCBpbnRlbF9jcnRjX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LCBlbnVtIHBpcGUgcGlwZSkKPiArc3RhdGljIGludCBpbnRlbF9jcnRjX2luaXQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gcGlwZSBwaXBlKQo+ICAgewo+ICAgCXN0cnVj
dCBpbnRlbF9jcnRjICppbnRlbF9jcnRjOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlID0gTlVMTDsKPiBAQCAtMTQ5MjQsMTcgKzE0OTI0LDE3IEBAIHN0YXRpYyBpbnQg
aW50ZWxfY3J0Y19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBw
aXBlIHBpcGUpCj4gICAJX19kcm1fYXRvbWljX2hlbHBlcl9jcnRjX3Jlc2V0KCZpbnRlbF9jcnRj
LT5iYXNlLCAmY3J0Y19zdGF0ZS0+YmFzZSk7Cj4gICAJaW50ZWxfY3J0Yy0+Y29uZmlnID0gY3J0
Y19zdGF0ZTsKPiAgIAo+IC0JcHJpbWFyeSA9IGludGVsX3ByaW1hcnlfcGxhbmVfY3JlYXRlKGRl
dl9wcml2LCBwaXBlKTsKPiArCXByaW1hcnkgPSBpbnRlbF9wcmltYXJ5X3BsYW5lX2NyZWF0ZShp
OTE1LCBwaXBlKTsKPiAgIAlpZiAoSVNfRVJSKHByaW1hcnkpKSB7Cj4gICAJCXJldCA9IFBUUl9F
UlIocHJpbWFyeSk7Cj4gICAJCWdvdG8gZmFpbDsKPiAgIAl9Cj4gICAJaW50ZWxfY3J0Yy0+cGxh
bmVfaWRzX21hc2sgfD0gQklUKHByaW1hcnktPmlkKTsKPiAgIAo+IC0JZm9yX2VhY2hfc3ByaXRl
KGRldl9wcml2LCBwaXBlLCBzcHJpdGUpIHsKPiArCWZvcl9lYWNoX3Nwcml0ZShpOTE1LCBwaXBl
LCBzcHJpdGUpIHsKPiAgIAkJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZTsKPiAgIAo+IC0JCXBs
YW5lID0gaW50ZWxfc3ByaXRlX3BsYW5lX2NyZWF0ZShkZXZfcHJpdiwgcGlwZSwgc3ByaXRlKTsK
PiArCQlwbGFuZSA9IGludGVsX3Nwcml0ZV9wbGFuZV9jcmVhdGUoaTkxNSwgcGlwZSwgc3ByaXRl
KTsKPiAgIAkJaWYgKElTX0VSUihwbGFuZSkpIHsKPiAgIAkJCXJldCA9IFBUUl9FUlIocGxhbmUp
Owo+ICAgCQkJZ290byBmYWlsOwo+IEBAIC0xNDk0MiwxNCArMTQ5NDIsMTQgQEAgc3RhdGljIGlu
dCBpbnRlbF9jcnRjX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVt
IHBpcGUgcGlwZSkKPiAgIAkJaW50ZWxfY3J0Yy0+cGxhbmVfaWRzX21hc2sgfD0gQklUKHBsYW5l
LT5pZCk7Cj4gICAJfQo+ICAgCj4gLQljdXJzb3IgPSBpbnRlbF9jdXJzb3JfcGxhbmVfY3JlYXRl
KGRldl9wcml2LCBwaXBlKTsKPiArCWN1cnNvciA9IGludGVsX2N1cnNvcl9wbGFuZV9jcmVhdGUo
aTkxNSwgcGlwZSk7Cj4gICAJaWYgKElTX0VSUihjdXJzb3IpKSB7Cj4gICAJCXJldCA9IFBUUl9F
UlIoY3Vyc29yKTsKPiAgIAkJZ290byBmYWlsOwo+ICAgCX0KPiAgIAlpbnRlbF9jcnRjLT5wbGFu
ZV9pZHNfbWFzayB8PSBCSVQoY3Vyc29yLT5pZCk7Cj4gICAKPiAtCXJldCA9IGRybV9jcnRjX2lu
aXRfd2l0aF9wbGFuZXMoJmRldl9wcml2LT5kcm0sICZpbnRlbF9jcnRjLT5iYXNlLAo+ICsJcmV0
ID0gZHJtX2NydGNfaW5pdF93aXRoX3BsYW5lcygmaTkxNS0+ZHJtLCAmaW50ZWxfY3J0Yy0+YmFz
ZSwKPiAgIAkJCQkJJnByaW1hcnktPmJhc2UsICZjdXJzb3ItPmJhc2UsCj4gICAJCQkJCSZpbnRl
bF9jcnRjX2Z1bmNzLAo+ICAgCQkJCQkicGlwZSAlYyIsIHBpcGVfbmFtZShwaXBlKSk7Cj4gQEAg
LTE0OTYxLDE2ICsxNDk2MSwxNiBAQCBzdGF0aWMgaW50IGludGVsX2NydGNfaW5pdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlwZSBwaXBlKQo+ICAgCS8qIGluaXRp
YWxpemUgc2hhcmVkIHNjYWxlcnMgKi8KPiAgIAlpbnRlbF9jcnRjX2luaXRfc2NhbGVycyhpbnRl
bF9jcnRjLCBjcnRjX3N0YXRlKTsKPiAgIAo+IC0JQlVHX09OKHBpcGUgPj0gQVJSQVlfU0laRShk
ZXZfcHJpdi0+cGlwZV90b19jcnRjX21hcHBpbmcpIHx8Cj4gLQkgICAgICAgZGV2X3ByaXYtPnBp
cGVfdG9fY3J0Y19tYXBwaW5nW3BpcGVdICE9IE5VTEwpOwo+IC0JZGV2X3ByaXYtPnBpcGVfdG9f
Y3J0Y19tYXBwaW5nW3BpcGVdID0gaW50ZWxfY3J0YzsKPiArCUJVR19PTihwaXBlID49IEFSUkFZ
X1NJWkUoaTkxNS0+cGlwZV90b19jcnRjX21hcHBpbmcpIHx8Cj4gKwkgICAgICAgaTkxNS0+cGlw
ZV90b19jcnRjX21hcHBpbmdbcGlwZV0gIT0gTlVMTCk7Cj4gKwlpOTE1LT5waXBlX3RvX2NydGNf
bWFwcGluZ1twaXBlXSA9IGludGVsX2NydGM7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpIDwgOSkgewo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8IDkpIHsKPiAgIAkJZW51bSBpOXh4
X3BsYW5lX2lkIGk5eHhfcGxhbmUgPSBwcmltYXJ5LT5pOXh4X3BsYW5lOwo+ICAgCj4gLQkJQlVH
X09OKGk5eHhfcGxhbmUgPj0gQVJSQVlfU0laRShkZXZfcHJpdi0+cGxhbmVfdG9fY3J0Y19tYXBw
aW5nKSB8fAo+IC0JCSAgICAgICBkZXZfcHJpdi0+cGxhbmVfdG9fY3J0Y19tYXBwaW5nW2k5eHhf
cGxhbmVdICE9IE5VTEwpOwo+IC0JCWRldl9wcml2LT5wbGFuZV90b19jcnRjX21hcHBpbmdbaTl4
eF9wbGFuZV0gPSBpbnRlbF9jcnRjOwo+ICsJCUJVR19PTihpOXh4X3BsYW5lID49IEFSUkFZX1NJ
WkUoaTkxNS0+cGxhbmVfdG9fY3J0Y19tYXBwaW5nKSB8fAo+ICsJCSAgICAgICBpOTE1LT5wbGFu
ZV90b19jcnRjX21hcHBpbmdbaTl4eF9wbGFuZV0gIT0gTlVMTCk7Cj4gKwkJaTkxNS0+cGxhbmVf
dG9fY3J0Y19tYXBwaW5nW2k5eHhfcGxhbmVdID0gaW50ZWxfY3J0YzsKPiAgIAl9Cj4gICAKPiAg
IAlkcm1fY3J0Y19oZWxwZXJfYWRkKCZpbnRlbF9jcnRjLT5iYXNlLCAmaW50ZWxfaGVscGVyX2Z1
bmNzKTsKPiBAQCAtMTUwMjYsMjkgKzE1MDI2LDI5IEBAIHN0YXRpYyBpbnQgaW50ZWxfZW5jb2Rl
cl9jbG9uZXMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICAJcmV0dXJuIGluZGV4
X21hc2s7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGJvb2wgaWxrX2hhc19lZHBfYShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyBib29sIGlsa19oYXNfZWRwX2Eoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlpZiAoIUlTX01PQklMRShkZXZf
cHJpdikpCj4gKwlpZiAoIUlTX01PQklMRShpOTE1KSkKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAg
Cj4gICAJaWYgKChJOTE1X1JFQUQoRFBfQSkgJiBEUF9ERVRFQ1RFRCkgPT0gMCkKPiAgIAkJcmV0
dXJuIGZhbHNlOwo+ICAgCj4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCA1KSAmJiAoSTkxNV9SRUFE
KEZVU0VfU1RSQVApICYgSUxLX2VEUF9BX0RJU0FCTEUpKQo+ICsJaWYgKElTX0dFTihpOTE1LCA1
KSAmJiAoSTkxNV9SRUFEKEZVU0VfU1RSQVApICYgSUxLX2VEUF9BX0RJU0FCTEUpKQo+ICAgCQly
ZXR1cm4gZmFsc2U7Cj4gICAKPiAgIAlyZXR1cm4gdHJ1ZTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMg
Ym9vbCBpbnRlbF9kZGlfY3J0X3ByZXNlbnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICtzdGF0aWMgYm9vbCBpbnRlbF9kZGlfY3J0X3ByZXNlbnQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KQo+
ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gICAKPiAt
CWlmIChJU19IU1dfVUxUKGRldl9wcml2KSB8fCBJU19CRFdfVUxUKGRldl9wcml2KSkKPiArCWlm
IChJU19IU1dfVUxUKGk5MTUpIHx8IElTX0JEV19VTFQoaTkxNSkpCj4gICAJCXJldHVybiBmYWxz
ZTsKPiAgIAo+IC0JaWYgKEhBU19QQ0hfTFBUX0goZGV2X3ByaXYpICYmCj4gKwlpZiAoSEFTX1BD
SF9MUFRfSChpOTE1KSAmJgo+ICAgCSAgICBJOTE1X1JFQUQoU0ZVU0VfU1RSQVApICYgU0ZVU0Vf
U1RSQVBfQ1JUX0RJU0FCTEVEKQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gICAKPiBAQCAtMTUwNTYs
MjQgKzE1MDU2LDI0IEBAIHN0YXRpYyBib29sIGludGVsX2RkaV9jcnRfcHJlc2VudChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJaWYgKEk5MTVfUkVBRChERElfQlVGX0NU
TChQT1JUX0EpKSAmIERESV9BXzRfTEFORVMpCj4gICAJCXJldHVybiBmYWxzZTsKPiAgIAo+IC0J
aWYgKCFkZXZfcHJpdi0+dmJ0LmludF9jcnRfc3VwcG9ydCkKPiArCWlmICghaTkxNS0+dmJ0Lmlu
dF9jcnRfc3VwcG9ydCkKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAgCj4gICAJcmV0dXJuIHRydWU7
Cj4gICB9Cj4gICAKPiAtdm9pZCBpbnRlbF9wcHNfdW5sb2NrX3JlZ3Nfd2Eoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGludGVsX3Bwc191bmxvY2tfcmVnc193YShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAlpbnQgcHBzX251bTsKPiAg
IAlpbnQgcHBzX2lkeDsKPiAgIAo+IC0JaWYgKEhBU19EREkoZGV2X3ByaXYpKQo+ICsJaWYgKEhB
U19EREkoaTkxNSkpCj4gICAJCXJldHVybjsKPiAgIAkvKgo+ICAgCSAqIFRoaXMgdy9hIGlzIG5l
ZWRlZCBhdCBsZWFzdCBvbiBDUFQvUFBULCBidXQgdG8gYmUgc3VyZSBhcHBseSBpdAo+ICAgCSAq
IGV2ZXJ5d2hlcmUgd2hlcmUgcmVnaXN0ZXJzIGNhbiBiZSB3cml0ZSBwcm90ZWN0ZWQuCj4gICAJ
ICovCj4gLQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZf
cHJpdikpCj4gKwlpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUp
KQo+ICAgCQlwcHNfbnVtID0gMjsKPiAgIAllbHNlCj4gICAJCXBwc19udW0gPSAxOwo+IEBAIC0x
NTA4Niw2NSArMTUwODYsNjUgQEAgdm9pZCBpbnRlbF9wcHNfdW5sb2NrX3JlZ3Nfd2Eoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCX0KPiAgIH0KPiAgIAo+IC1zdGF0aWMg
dm9pZCBpbnRlbF9wcHNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
K3N0YXRpYyB2b2lkIGludGVsX3Bwc19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ICAgewo+IC0JaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3ByaXYpIHx8IElTX0dFTjlfTFAoZGV2
X3ByaXYpKQo+IC0JCWRldl9wcml2LT5wcHNfbW1pb19iYXNlID0gUENIX1BQU19CQVNFOwo+IC0J
ZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJp
dikpCj4gLQkJZGV2X3ByaXYtPnBwc19tbWlvX2Jhc2UgPSBWTFZfUFBTX0JBU0U7Cj4gKwlpZiAo
SEFTX1BDSF9TUExJVChpOTE1KSB8fCBJU19HRU45X0xQKGk5MTUpKQo+ICsJCWk5MTUtPnBwc19t
bWlvX2Jhc2UgPSBQQ0hfUFBTX0JBU0U7Cj4gKwllbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUp
IHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gKwkJaTkxNS0+cHBzX21taW9fYmFzZSA9IFZMVl9Q
UFNfQkFTRTsKPiAgIAllbHNlCj4gLQkJZGV2X3ByaXYtPnBwc19tbWlvX2Jhc2UgPSBQUFNfQkFT
RTsKPiArCQlpOTE1LT5wcHNfbW1pb19iYXNlID0gUFBTX0JBU0U7Cj4gICAKPiAtCWludGVsX3Bw
c191bmxvY2tfcmVnc193YShkZXZfcHJpdik7Cj4gKwlpbnRlbF9wcHNfdW5sb2NrX3JlZ3Nfd2Eo
aTkxNSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaW50ZWxfc2V0dXBfb3V0cHV0cyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGludGVsX3NldHVw
X291dHB1dHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXI7Cj4gICAJYm9vbCBkcGRfaXNfZWRwID0gZmFsc2U7Cj4g
ICAKPiAtCWludGVsX3Bwc19pbml0KGRldl9wcml2KTsKPiArCWludGVsX3Bwc19pbml0KGk5MTUp
Owo+ICAgCj4gLQlpZiAoIUhBU19ESVNQTEFZKGRldl9wcml2KSkKPiArCWlmICghSEFTX0RJU1BM
QVkoaTkxNSkpCj4gICAJCXJldHVybjsKPiAgIAo+IC0JaWYgKElTX0VMS0hBUlRMQUtFKGRldl9w
cml2KSkgewo+IC0JCWludGVsX2RkaV9pbml0KGRldl9wcml2LCBQT1JUX0EpOwo+IC0JCWludGVs
X2RkaV9pbml0KGRldl9wcml2LCBQT1JUX0IpOwo+IC0JCWludGVsX2RkaV9pbml0KGRldl9wcml2
LCBQT1JUX0MpOwo+IC0JCWljbF9kc2lfaW5pdChkZXZfcHJpdik7Cj4gLQl9IGVsc2UgaWYgKElO
VEVMX0dFTihkZXZfcHJpdikgPj0gMTEpIHsKPiAtCQlpbnRlbF9kZGlfaW5pdChkZXZfcHJpdiwg
UE9SVF9BKTsKPiAtCQlpbnRlbF9kZGlfaW5pdChkZXZfcHJpdiwgUE9SVF9CKTsKPiAtCQlpbnRl
bF9kZGlfaW5pdChkZXZfcHJpdiwgUE9SVF9DKTsKPiAtCQlpbnRlbF9kZGlfaW5pdChkZXZfcHJp
diwgUE9SVF9EKTsKPiAtCQlpbnRlbF9kZGlfaW5pdChkZXZfcHJpdiwgUE9SVF9FKTsKPiArCWlm
IChJU19FTEtIQVJUTEFLRShpOTE1KSkgewo+ICsJCWludGVsX2RkaV9pbml0KGk5MTUsIFBPUlRf
QSk7Cj4gKwkJaW50ZWxfZGRpX2luaXQoaTkxNSwgUE9SVF9CKTsKPiArCQlpbnRlbF9kZGlfaW5p
dChpOTE1LCBQT1JUX0MpOwo+ICsJCWljbF9kc2lfaW5pdChpOTE1KTsKPiArCX0gZWxzZSBpZiAo
SU5URUxfR0VOKGk5MTUpID49IDExKSB7Cj4gKwkJaW50ZWxfZGRpX2luaXQoaTkxNSwgUE9SVF9B
KTsKPiArCQlpbnRlbF9kZGlfaW5pdChpOTE1LCBQT1JUX0IpOwo+ICsJCWludGVsX2RkaV9pbml0
KGk5MTUsIFBPUlRfQyk7Cj4gKwkJaW50ZWxfZGRpX2luaXQoaTkxNSwgUE9SVF9EKTsKPiArCQlp
bnRlbF9kZGlfaW5pdChpOTE1LCBQT1JUX0UpOwo+ICAgCQkvKgo+ICAgCQkgKiBPbiBzb21lIElD
TCBTS1VzIHBvcnQgRiBpcyBub3QgcHJlc2VudC4gTm8gc3RyYXAgYml0cyBmb3IKPiAgIAkJICog
dGhpcywgc28gcmVseSBvbiBWQlQuCj4gICAJCSAqIFdvcmsgYXJvdW5kIGJyb2tlbiBWQlRzIG9u
IFNLVXMga25vd24gdG8gaGF2ZSBubyBwb3J0IEYuCj4gICAJCSAqLwo+IC0JCWlmIChJU19JQ0xf
V0lUSF9QT1JUX0YoZGV2X3ByaXYpICYmCj4gLQkJICAgIGludGVsX2Jpb3NfaXNfcG9ydF9wcmVz
ZW50KGRldl9wcml2LCBQT1JUX0YpKQo+IC0JCQlpbnRlbF9kZGlfaW5pdChkZXZfcHJpdiwgUE9S
VF9GKTsKPiArCQlpZiAoSVNfSUNMX1dJVEhfUE9SVF9GKGk5MTUpICYmCj4gKwkJICAgIGludGVs
X2Jpb3NfaXNfcG9ydF9wcmVzZW50KGk5MTUsIFBPUlRfRikpCj4gKwkJCWludGVsX2RkaV9pbml0
KGk5MTUsIFBPUlRfRik7Cj4gICAKPiAtCQlpY2xfZHNpX2luaXQoZGV2X3ByaXYpOwo+IC0JfSBl
bHNlIGlmIChJU19HRU45X0xQKGRldl9wcml2KSkgewo+ICsJCWljbF9kc2lfaW5pdChpOTE1KTsK
PiArCX0gZWxzZSBpZiAoSVNfR0VOOV9MUChpOTE1KSkgewo+ICAgCQkvKgo+ICAgCQkgKiBGSVhN
RTogQnJveHRvbiBkb2Vzbid0IHN1cHBvcnQgcG9ydCBkZXRlY3Rpb24gdmlhIHRoZQo+ICAgCQkg
KiBERElfQlVGX0NUTF9BIG9yIFNGVVNFX1NUUkFQIHJlZ2lzdGVycywgZmluZCBhbm90aGVyIHdh
eSB0bwo+ICAgCQkgKiBkZXRlY3QgdGhlIHBvcnRzLgo+ICAgCQkgKi8KPiAtCQlpbnRlbF9kZGlf
aW5pdChkZXZfcHJpdiwgUE9SVF9BKTsKPiAtCQlpbnRlbF9kZGlfaW5pdChkZXZfcHJpdiwgUE9S
VF9CKTsKPiAtCQlpbnRlbF9kZGlfaW5pdChkZXZfcHJpdiwgUE9SVF9DKTsKPiArCQlpbnRlbF9k
ZGlfaW5pdChpOTE1LCBQT1JUX0EpOwo+ICsJCWludGVsX2RkaV9pbml0KGk5MTUsIFBPUlRfQik7
Cj4gKwkJaW50ZWxfZGRpX2luaXQoaTkxNSwgUE9SVF9DKTsKPiAgIAo+IC0JCXZsdl9kc2lfaW5p
dChkZXZfcHJpdik7Cj4gLQl9IGVsc2UgaWYgKEhBU19EREkoZGV2X3ByaXYpKSB7Cj4gKwkJdmx2
X2RzaV9pbml0KGk5MTUpOwo+ICsJfSBlbHNlIGlmIChIQVNfRERJKGk5MTUpKSB7Cj4gICAJCWlu
dCBmb3VuZDsKPiAgIAo+IC0JCWlmIChpbnRlbF9kZGlfY3J0X3ByZXNlbnQoZGV2X3ByaXYpKQo+
IC0JCQlpbnRlbF9jcnRfaW5pdChkZXZfcHJpdik7Cj4gKwkJaWYgKGludGVsX2RkaV9jcnRfcHJl
c2VudChpOTE1KSkKPiArCQkJaW50ZWxfY3J0X2luaXQoaTkxNSk7Cj4gICAKPiAgIAkJLyoKPiAg
IAkJICogSGFzd2VsbCB1c2VzIERESSBmdW5jdGlvbnMgdG8gZGV0ZWN0IGRpZ2l0YWwgb3V0cHV0
cy4KPiBAQCAtMTUxNTMsMjkgKzE1MTUzLDI5IEBAIHN0YXRpYyB2b2lkIGludGVsX3NldHVwX291
dHB1dHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQkgKi8KPiAgIAkJ
Zm91bmQgPSBJOTE1X1JFQUQoRERJX0JVRl9DVEwoUE9SVF9BKSkgJiBERElfSU5JVF9ESVNQTEFZ
X0RFVEVDVEVEOwo+ICAgCQkvKiBXYUlnbm9yZURESUFTdHJhcDogc2tsICovCj4gLQkJaWYgKGZv
dW5kIHx8IElTX0dFTjlfQkMoZGV2X3ByaXYpKQo+IC0JCQlpbnRlbF9kZGlfaW5pdChkZXZfcHJp
diwgUE9SVF9BKTsKPiArCQlpZiAoZm91bmQgfHwgSVNfR0VOOV9CQyhpOTE1KSkKPiArCQkJaW50
ZWxfZGRpX2luaXQoaTkxNSwgUE9SVF9BKTsKPiAgIAo+ICAgCQkvKiBEREkgQiwgQywgRCwgYW5k
IEYgZGV0ZWN0aW9uIGlzIGluZGljYXRlZCBieSB0aGUgU0ZVU0VfU1RSQVAKPiAgIAkJICogcmVn
aXN0ZXIgKi8KPiAgIAkJZm91bmQgPSBJOTE1X1JFQUQoU0ZVU0VfU1RSQVApOwo+ICAgCj4gICAJ
CWlmIChmb3VuZCAmIFNGVVNFX1NUUkFQX0RESUJfREVURUNURUQpCj4gLQkJCWludGVsX2RkaV9p
bml0KGRldl9wcml2LCBQT1JUX0IpOwo+ICsJCQlpbnRlbF9kZGlfaW5pdChpOTE1LCBQT1JUX0Ip
Owo+ICAgCQlpZiAoZm91bmQgJiBTRlVTRV9TVFJBUF9ERElDX0RFVEVDVEVEKQo+IC0JCQlpbnRl
bF9kZGlfaW5pdChkZXZfcHJpdiwgUE9SVF9DKTsKPiArCQkJaW50ZWxfZGRpX2luaXQoaTkxNSwg
UE9SVF9DKTsKPiAgIAkJaWYgKGZvdW5kICYgU0ZVU0VfU1RSQVBfRERJRF9ERVRFQ1RFRCkKPiAt
CQkJaW50ZWxfZGRpX2luaXQoZGV2X3ByaXYsIFBPUlRfRCk7Cj4gKwkJCWludGVsX2RkaV9pbml0
KGk5MTUsIFBPUlRfRCk7Cj4gICAJCWlmIChmb3VuZCAmIFNGVVNFX1NUUkFQX0RESUZfREVURUNU
RUQpCj4gLQkJCWludGVsX2RkaV9pbml0KGRldl9wcml2LCBQT1JUX0YpOwo+ICsJCQlpbnRlbF9k
ZGlfaW5pdChpOTE1LCBQT1JUX0YpOwo+ICAgCQkvKgo+ICAgCQkgKiBPbiBTS0wgd2UgZG9uJ3Qg
aGF2ZSBhIHdheSB0byBkZXRlY3QgRERJLUUgc28gd2UgcmVseSBvbiBWQlQuCj4gICAJCSAqLwo+
IC0JCWlmIChJU19HRU45X0JDKGRldl9wcml2KSAmJgo+IC0JCSAgICBpbnRlbF9iaW9zX2lzX3Bv
cnRfcHJlc2VudChkZXZfcHJpdiwgUE9SVF9FKSkKPiAtCQkJaW50ZWxfZGRpX2luaXQoZGV2X3By
aXYsIFBPUlRfRSk7Cj4gKwkJaWYgKElTX0dFTjlfQkMoaTkxNSkgJiYKPiArCQkgICAgaW50ZWxf
Ymlvc19pc19wb3J0X3ByZXNlbnQoaTkxNSwgUE9SVF9FKSkKPiArCQkJaW50ZWxfZGRpX2luaXQo
aTkxNSwgUE9SVF9FKTsKPiAgIAo+IC0JfSBlbHNlIGlmIChIQVNfUENIX1NQTElUKGRldl9wcml2
KSkgewo+ICsJfSBlbHNlIGlmIChIQVNfUENIX1NQTElUKGk5MTUpKSB7Cj4gICAJCWludCBmb3Vu
ZDsKPiAgIAo+ICAgCQkvKgo+IEBAIC0xNTE4MywzOSArMTUxODMsMzkgQEAgc3RhdGljIHZvaWQg
aW50ZWxfc2V0dXBfb3V0cHV0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
ICAJCSAqIHRvIHByZXZlbnQgdGhlIHJlZ2lzdHJhdGlvbiBvZiBib3RoIGVEUCBhbmQgTFZEUyBh
bmQgdGhlCj4gICAJCSAqIGluY29ycmVjdCBzaGFyaW5nIG9mIHRoZSBQUFMuCj4gICAJCSAqLwo+
IC0JCWludGVsX2x2ZHNfaW5pdChkZXZfcHJpdik7Cj4gLQkJaW50ZWxfY3J0X2luaXQoZGV2X3By
aXYpOwo+ICsJCWludGVsX2x2ZHNfaW5pdChpOTE1KTsKPiArCQlpbnRlbF9jcnRfaW5pdChpOTE1
KTsKPiAgIAo+IC0JCWRwZF9pc19lZHAgPSBpbnRlbF9kcF9pc19wb3J0X2VkcChkZXZfcHJpdiwg
UE9SVF9EKTsKPiArCQlkcGRfaXNfZWRwID0gaW50ZWxfZHBfaXNfcG9ydF9lZHAoaTkxNSwgUE9S
VF9EKTsKPiAgIAo+IC0JCWlmIChpbGtfaGFzX2VkcF9hKGRldl9wcml2KSkKPiAtCQkJaW50ZWxf
ZHBfaW5pdChkZXZfcHJpdiwgRFBfQSwgUE9SVF9BKTsKPiArCQlpZiAoaWxrX2hhc19lZHBfYShp
OTE1KSkKPiArCQkJaW50ZWxfZHBfaW5pdChpOTE1LCBEUF9BLCBQT1JUX0EpOwo+ICAgCj4gICAJ
CWlmIChJOTE1X1JFQUQoUENIX0hETUlCKSAmIFNEVk9fREVURUNURUQpIHsKPiAgIAkJCS8qIFBD
SCBTRFZPQiBtdWx0aXBsZXggd2l0aCBIRE1JQiAqLwo+IC0JCQlmb3VuZCA9IGludGVsX3Nkdm9f
aW5pdChkZXZfcHJpdiwgUENIX1NEVk9CLCBQT1JUX0IpOwo+ICsJCQlmb3VuZCA9IGludGVsX3Nk
dm9faW5pdChpOTE1LCBQQ0hfU0RWT0IsIFBPUlRfQik7Cj4gICAJCQlpZiAoIWZvdW5kKQo+IC0J
CQkJaW50ZWxfaGRtaV9pbml0KGRldl9wcml2LCBQQ0hfSERNSUIsIFBPUlRfQik7Cj4gKwkJCQlp
bnRlbF9oZG1pX2luaXQoaTkxNSwgUENIX0hETUlCLCBQT1JUX0IpOwo+ICAgCQkJaWYgKCFmb3Vu
ZCAmJiAoSTkxNV9SRUFEKFBDSF9EUF9CKSAmIERQX0RFVEVDVEVEKSkKPiAtCQkJCWludGVsX2Rw
X2luaXQoZGV2X3ByaXYsIFBDSF9EUF9CLCBQT1JUX0IpOwo+ICsJCQkJaW50ZWxfZHBfaW5pdChp
OTE1LCBQQ0hfRFBfQiwgUE9SVF9CKTsKPiAgIAkJfQo+ICAgCj4gICAJCWlmIChJOTE1X1JFQUQo
UENIX0hETUlDKSAmIFNEVk9fREVURUNURUQpCj4gLQkJCWludGVsX2hkbWlfaW5pdChkZXZfcHJp
diwgUENIX0hETUlDLCBQT1JUX0MpOwo+ICsJCQlpbnRlbF9oZG1pX2luaXQoaTkxNSwgUENIX0hE
TUlDLCBQT1JUX0MpOwo+ICAgCj4gICAJCWlmICghZHBkX2lzX2VkcCAmJiBJOTE1X1JFQUQoUENI
X0hETUlEKSAmIFNEVk9fREVURUNURUQpCj4gLQkJCWludGVsX2hkbWlfaW5pdChkZXZfcHJpdiwg
UENIX0hETUlELCBQT1JUX0QpOwo+ICsJCQlpbnRlbF9oZG1pX2luaXQoaTkxNSwgUENIX0hETUlE
LCBQT1JUX0QpOwo+ICAgCj4gICAJCWlmIChJOTE1X1JFQUQoUENIX0RQX0MpICYgRFBfREVURUNU
RUQpCj4gLQkJCWludGVsX2RwX2luaXQoZGV2X3ByaXYsIFBDSF9EUF9DLCBQT1JUX0MpOwo+ICsJ
CQlpbnRlbF9kcF9pbml0KGk5MTUsIFBDSF9EUF9DLCBQT1JUX0MpOwo+ICAgCj4gICAJCWlmIChJ
OTE1X1JFQUQoUENIX0RQX0QpICYgRFBfREVURUNURUQpCj4gLQkJCWludGVsX2RwX2luaXQoZGV2
X3ByaXYsIFBDSF9EUF9ELCBQT1JUX0QpOwo+IC0JfSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGRl
dl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkgewo+ICsJCQlpbnRlbF9kcF9pbml0
KGk5MTUsIFBDSF9EUF9ELCBQT1JUX0QpOwo+ICsJfSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5
MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiAgIAkJYm9vbCBoYXNfZWRwLCBoYXNfcG9y
dDsKPiAgIAo+IC0JCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSAmJiBkZXZfcHJpdi0+dmJ0
LmludF9jcnRfc3VwcG9ydCkKPiAtCQkJaW50ZWxfY3J0X2luaXQoZGV2X3ByaXYpOwo+ICsJCWlm
IChJU19WQUxMRVlWSUVXKGk5MTUpICYmIGk5MTUtPnZidC5pbnRfY3J0X3N1cHBvcnQpCj4gKwkJ
CWludGVsX2NydF9pbml0KGk5MTUpOwo+ICAgCj4gICAJCS8qCj4gICAJCSAqIFRoZSBEUF9ERVRF
Q1RFRCBiaXQgaXMgdGhlIGxhdGNoZWQgc3RhdGUgb2YgdGhlIEREQwo+IEBAIC0xNTIzMiw5NyAr
MTUyMzIsOTcgQEAgc3RhdGljIHZvaWQgaW50ZWxfc2V0dXBfb3V0cHV0cyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCSAqIHRydXN0IHRoZSBwb3J0IHR5cGUgdGhlIFZC
VCBkZWNsYXJlcyBhcyB3ZSd2ZSBzZWVuIGF0IGxlYXN0Cj4gICAJCSAqIEhETUkgcG9ydHMgdGhh
dCB0aGUgVkJUIGNsYWltIGFyZSBEUCBvciBlRFAuCj4gICAJCSAqLwo+IC0JCWhhc19lZHAgPSBp
bnRlbF9kcF9pc19wb3J0X2VkcChkZXZfcHJpdiwgUE9SVF9CKTsKPiAtCQloYXNfcG9ydCA9IGlu
dGVsX2Jpb3NfaXNfcG9ydF9wcmVzZW50KGRldl9wcml2LCBQT1JUX0IpOwo+ICsJCWhhc19lZHAg
PSBpbnRlbF9kcF9pc19wb3J0X2VkcChpOTE1LCBQT1JUX0IpOwo+ICsJCWhhc19wb3J0ID0gaW50
ZWxfYmlvc19pc19wb3J0X3ByZXNlbnQoaTkxNSwgUE9SVF9CKTsKPiAgIAkJaWYgKEk5MTVfUkVB
RChWTFZfRFBfQikgJiBEUF9ERVRFQ1RFRCB8fCBoYXNfcG9ydCkKPiAtCQkJaGFzX2VkcCAmPSBp
bnRlbF9kcF9pbml0KGRldl9wcml2LCBWTFZfRFBfQiwgUE9SVF9CKTsKPiArCQkJaGFzX2VkcCAm
PSBpbnRlbF9kcF9pbml0KGk5MTUsIFZMVl9EUF9CLCBQT1JUX0IpOwo+ICAgCQlpZiAoKEk5MTVf
UkVBRChWTFZfSERNSUIpICYgU0RWT19ERVRFQ1RFRCB8fCBoYXNfcG9ydCkgJiYgIWhhc19lZHAp
Cj4gLQkJCWludGVsX2hkbWlfaW5pdChkZXZfcHJpdiwgVkxWX0hETUlCLCBQT1JUX0IpOwo+ICsJ
CQlpbnRlbF9oZG1pX2luaXQoaTkxNSwgVkxWX0hETUlCLCBQT1JUX0IpOwo+ICAgCj4gLQkJaGFz
X2VkcCA9IGludGVsX2RwX2lzX3BvcnRfZWRwKGRldl9wcml2LCBQT1JUX0MpOwo+IC0JCWhhc19w
b3J0ID0gaW50ZWxfYmlvc19pc19wb3J0X3ByZXNlbnQoZGV2X3ByaXYsIFBPUlRfQyk7Cj4gKwkJ
aGFzX2VkcCA9IGludGVsX2RwX2lzX3BvcnRfZWRwKGk5MTUsIFBPUlRfQyk7Cj4gKwkJaGFzX3Bv
cnQgPSBpbnRlbF9iaW9zX2lzX3BvcnRfcHJlc2VudChpOTE1LCBQT1JUX0MpOwo+ICAgCQlpZiAo
STkxNV9SRUFEKFZMVl9EUF9DKSAmIERQX0RFVEVDVEVEIHx8IGhhc19wb3J0KQo+IC0JCQloYXNf
ZWRwICY9IGludGVsX2RwX2luaXQoZGV2X3ByaXYsIFZMVl9EUF9DLCBQT1JUX0MpOwo+ICsJCQlo
YXNfZWRwICY9IGludGVsX2RwX2luaXQoaTkxNSwgVkxWX0RQX0MsIFBPUlRfQyk7Cj4gICAJCWlm
ICgoSTkxNV9SRUFEKFZMVl9IRE1JQykgJiBTRFZPX0RFVEVDVEVEIHx8IGhhc19wb3J0KSAmJiAh
aGFzX2VkcCkKPiAtCQkJaW50ZWxfaGRtaV9pbml0KGRldl9wcml2LCBWTFZfSERNSUMsIFBPUlRf
Qyk7Cj4gKwkJCWludGVsX2hkbWlfaW5pdChpOTE1LCBWTFZfSERNSUMsIFBPUlRfQyk7Cj4gICAK
PiAtCQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiArCQlpZiAoSVNfQ0hFUlJZVklF
VyhpOTE1KSkgewo+ICAgCQkJLyoKPiAgIAkJCSAqIGVEUCBub3Qgc3VwcG9ydGVkIG9uIHBvcnQg
RCwKPiAgIAkJCSAqIHNvIG5vIG5lZWQgdG8gd29ycnkgYWJvdXQgaXQKPiAgIAkJCSAqLwo+IC0J
CQloYXNfcG9ydCA9IGludGVsX2Jpb3NfaXNfcG9ydF9wcmVzZW50KGRldl9wcml2LCBQT1JUX0Qp
Owo+ICsJCQloYXNfcG9ydCA9IGludGVsX2Jpb3NfaXNfcG9ydF9wcmVzZW50KGk5MTUsIFBPUlRf
RCk7Cj4gICAJCQlpZiAoSTkxNV9SRUFEKENIVl9EUF9EKSAmIERQX0RFVEVDVEVEIHx8IGhhc19w
b3J0KQo+IC0JCQkJaW50ZWxfZHBfaW5pdChkZXZfcHJpdiwgQ0hWX0RQX0QsIFBPUlRfRCk7Cj4g
KwkJCQlpbnRlbF9kcF9pbml0KGk5MTUsIENIVl9EUF9ELCBQT1JUX0QpOwo+ICAgCQkJaWYgKEk5
MTVfUkVBRChDSFZfSERNSUQpICYgU0RWT19ERVRFQ1RFRCB8fCBoYXNfcG9ydCkKPiAtCQkJCWlu
dGVsX2hkbWlfaW5pdChkZXZfcHJpdiwgQ0hWX0hETUlELCBQT1JUX0QpOwo+ICsJCQkJaW50ZWxf
aGRtaV9pbml0KGk5MTUsIENIVl9IRE1JRCwgUE9SVF9EKTsKPiAgIAkJfQo+ICAgCj4gLQkJdmx2
X2RzaV9pbml0KGRldl9wcml2KTsKPiAtCX0gZWxzZSBpZiAoSVNfUElORVZJRVcoZGV2X3ByaXYp
KSB7Cj4gLQkJaW50ZWxfbHZkc19pbml0KGRldl9wcml2KTsKPiAtCQlpbnRlbF9jcnRfaW5pdChk
ZXZfcHJpdik7Cj4gLQl9IGVsc2UgaWYgKElTX0dFTl9SQU5HRShkZXZfcHJpdiwgMywgNCkpIHsK
PiArCQl2bHZfZHNpX2luaXQoaTkxNSk7Cj4gKwl9IGVsc2UgaWYgKElTX1BJTkVWSUVXKGk5MTUp
KSB7Cj4gKwkJaW50ZWxfbHZkc19pbml0KGk5MTUpOwo+ICsJCWludGVsX2NydF9pbml0KGk5MTUp
Owo+ICsJfSBlbHNlIGlmIChJU19HRU5fUkFOR0UoaTkxNSwgMywgNCkpIHsKPiAgIAkJYm9vbCBm
b3VuZCA9IGZhbHNlOwo+ICAgCj4gLQkJaWYgKElTX01PQklMRShkZXZfcHJpdikpCj4gLQkJCWlu
dGVsX2x2ZHNfaW5pdChkZXZfcHJpdik7Cj4gKwkJaWYgKElTX01PQklMRShpOTE1KSkKPiArCQkJ
aW50ZWxfbHZkc19pbml0KGk5MTUpOwo+ICAgCj4gLQkJaW50ZWxfY3J0X2luaXQoZGV2X3ByaXYp
Owo+ICsJCWludGVsX2NydF9pbml0KGk5MTUpOwo+ICAgCj4gICAJCWlmIChJOTE1X1JFQUQoR0VO
M19TRFZPQikgJiBTRFZPX0RFVEVDVEVEKSB7Cj4gICAJCQlEUk1fREVCVUdfS01TKCJwcm9iaW5n
IFNEVk9CXG4iKTsKPiAtCQkJZm91bmQgPSBpbnRlbF9zZHZvX2luaXQoZGV2X3ByaXYsIEdFTjNf
U0RWT0IsIFBPUlRfQik7Cj4gLQkJCWlmICghZm91bmQgJiYgSVNfRzRYKGRldl9wcml2KSkgewo+
ICsJCQlmb3VuZCA9IGludGVsX3Nkdm9faW5pdChpOTE1LCBHRU4zX1NEVk9CLCBQT1JUX0IpOwo+
ICsJCQlpZiAoIWZvdW5kICYmIElTX0c0WChpOTE1KSkgewo+ICAgCQkJCURSTV9ERUJVR19LTVMo
InByb2JpbmcgSERNSSBvbiBTRFZPQlxuIik7Cj4gLQkJCQlpbnRlbF9oZG1pX2luaXQoZGV2X3By
aXYsIEdFTjRfSERNSUIsIFBPUlRfQik7Cj4gKwkJCQlpbnRlbF9oZG1pX2luaXQoaTkxNSwgR0VO
NF9IRE1JQiwgUE9SVF9CKTsKPiAgIAkJCX0KPiAgIAo+IC0JCQlpZiAoIWZvdW5kICYmIElTX0c0
WChkZXZfcHJpdikpCj4gLQkJCQlpbnRlbF9kcF9pbml0KGRldl9wcml2LCBEUF9CLCBQT1JUX0Ip
Owo+ICsJCQlpZiAoIWZvdW5kICYmIElTX0c0WChpOTE1KSkKPiArCQkJCWludGVsX2RwX2luaXQo
aTkxNSwgRFBfQiwgUE9SVF9CKTsKPiAgIAkJfQo+ICAgCj4gICAJCS8qIEJlZm9yZSBHNFggU0RW
T0MgZG9lc24ndCBoYXZlIGl0cyBvd24gZGV0ZWN0IHJlZ2lzdGVyICovCj4gICAKPiAgIAkJaWYg
KEk5MTVfUkVBRChHRU4zX1NEVk9CKSAmIFNEVk9fREVURUNURUQpIHsKPiAgIAkJCURSTV9ERUJV
R19LTVMoInByb2JpbmcgU0RWT0NcbiIpOwo+IC0JCQlmb3VuZCA9IGludGVsX3Nkdm9faW5pdChk
ZXZfcHJpdiwgR0VOM19TRFZPQywgUE9SVF9DKTsKPiArCQkJZm91bmQgPSBpbnRlbF9zZHZvX2lu
aXQoaTkxNSwgR0VOM19TRFZPQywgUE9SVF9DKTsKPiAgIAkJfQo+ICAgCj4gICAJCWlmICghZm91
bmQgJiYgKEk5MTVfUkVBRChHRU4zX1NEVk9DKSAmIFNEVk9fREVURUNURUQpKSB7Cj4gICAKPiAt
CQkJaWYgKElTX0c0WChkZXZfcHJpdikpIHsKPiArCQkJaWYgKElTX0c0WChpOTE1KSkgewo+ICAg
CQkJCURSTV9ERUJVR19LTVMoInByb2JpbmcgSERNSSBvbiBTRFZPQ1xuIik7Cj4gLQkJCQlpbnRl
bF9oZG1pX2luaXQoZGV2X3ByaXYsIEdFTjRfSERNSUMsIFBPUlRfQyk7Cj4gKwkJCQlpbnRlbF9o
ZG1pX2luaXQoaTkxNSwgR0VONF9IRE1JQywgUE9SVF9DKTsKPiAgIAkJCX0KPiAtCQkJaWYgKElT
X0c0WChkZXZfcHJpdikpCj4gLQkJCQlpbnRlbF9kcF9pbml0KGRldl9wcml2LCBEUF9DLCBQT1JU
X0MpOwo+ICsJCQlpZiAoSVNfRzRYKGk5MTUpKQo+ICsJCQkJaW50ZWxfZHBfaW5pdChpOTE1LCBE
UF9DLCBQT1JUX0MpOwo+ICAgCQl9Cj4gICAKPiAtCQlpZiAoSVNfRzRYKGRldl9wcml2KSAmJiAo
STkxNV9SRUFEKERQX0QpICYgRFBfREVURUNURUQpKQo+IC0JCQlpbnRlbF9kcF9pbml0KGRldl9w
cml2LCBEUF9ELCBQT1JUX0QpOwo+ICsJCWlmIChJU19HNFgoaTkxNSkgJiYgKEk5MTVfUkVBRChE
UF9EKSAmIERQX0RFVEVDVEVEKSkKPiArCQkJaW50ZWxfZHBfaW5pdChpOTE1LCBEUF9ELCBQT1JU
X0QpOwo+ICAgCj4gLQkJaWYgKFNVUFBPUlRTX1RWKGRldl9wcml2KSkKPiAtCQkJaW50ZWxfdHZf
aW5pdChkZXZfcHJpdik7Cj4gLQl9IGVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgMikpIHsKPiAt
CQlpZiAoSVNfSTg1WChkZXZfcHJpdikpCj4gLQkJCWludGVsX2x2ZHNfaW5pdChkZXZfcHJpdik7
Cj4gKwkJaWYgKFNVUFBPUlRTX1RWKGk5MTUpKQo+ICsJCQlpbnRlbF90dl9pbml0KGk5MTUpOwo+
ICsJfSBlbHNlIGlmIChJU19HRU4oaTkxNSwgMikpIHsKPiArCQlpZiAoSVNfSTg1WChpOTE1KSkK
PiArCQkJaW50ZWxfbHZkc19pbml0KGk5MTUpOwo+ICAgCj4gLQkJaW50ZWxfY3J0X2luaXQoZGV2
X3ByaXYpOwo+IC0JCWludGVsX2R2b19pbml0KGRldl9wcml2KTsKPiArCQlpbnRlbF9jcnRfaW5p
dChpOTE1KTsKPiArCQlpbnRlbF9kdm9faW5pdChpOTE1KTsKPiAgIAl9Cj4gICAKPiAtCWludGVs
X3Bzcl9pbml0KGRldl9wcml2KTsKPiArCWludGVsX3Bzcl9pbml0KGk5MTUpOwo+ICAgCj4gLQlm
b3JfZWFjaF9pbnRlbF9lbmNvZGVyKCZkZXZfcHJpdi0+ZHJtLCBlbmNvZGVyKSB7Cj4gKwlmb3Jf
ZWFjaF9pbnRlbF9lbmNvZGVyKCZpOTE1LT5kcm0sIGVuY29kZXIpIHsKPiAgIAkJZW5jb2Rlci0+
YmFzZS5wb3NzaWJsZV9jcnRjcyA9IGVuY29kZXItPmNydGNfbWFzazsKPiAgIAkJZW5jb2Rlci0+
YmFzZS5wb3NzaWJsZV9jbG9uZXMgPQo+ICAgCQkJaW50ZWxfZW5jb2Rlcl9jbG9uZXMoZW5jb2Rl
cik7Cj4gICAJfQo+ICAgCj4gLQlpbnRlbF9pbml0X3BjaF9yZWZjbGsoZGV2X3ByaXYpOwo+ICsJ
aW50ZWxfaW5pdF9wY2hfcmVmY2xrKGk5MTUpOwo+ICAgCj4gLQlkcm1faGVscGVyX21vdmVfcGFu
ZWxfY29ubmVjdG9yc190b19oZWFkKCZkZXZfcHJpdi0+ZHJtKTsKPiArCWRybV9oZWxwZXJfbW92
ZV9wYW5lbF9jb25uZWN0b3JzX3RvX2hlYWQoJmk5MTUtPmRybSk7Cj4gICB9Cj4gICAKPiAgIHN0
YXRpYyB2b2lkIGludGVsX3VzZXJfZnJhbWVidWZmZXJfZGVzdHJveShzdHJ1Y3QgZHJtX2ZyYW1l
YnVmZmVyICpmYikKPiBAQCAtMTUzNzksNyArMTUzNzksNyBAQCBzdGF0aWMgaW50IGludGVsX2Zy
YW1lYnVmZmVyX2luaXQoc3RydWN0IGludGVsX2ZyYW1lYnVmZmVyICppbnRlbF9mYiwKPiAgIAkJ
CQkgIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCj4gICAJCQkJICBzdHJ1Y3QgZHJt
X21vZGVfZmJfY21kMiAqbW9kZV9jbWQpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KG9iai0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KG9iai0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBkcm1f
ZnJhbWVidWZmZXIgKmZiID0gJmludGVsX2ZiLT5iYXNlOwo+ICAgCXUzMiBtYXhfc3RyaWRlOwo+
ICAgCXVuc2lnbmVkIGludCB0aWxpbmcsIHN0cmlkZTsKPiBAQCAtMTU0MTEsNyArMTU0MTEsNyBA
QCBzdGF0aWMgaW50IGludGVsX2ZyYW1lYnVmZmVyX2luaXQoc3RydWN0IGludGVsX2ZyYW1lYnVm
ZmVyICppbnRlbF9mYiwKPiAgIAkJfQo+ICAgCX0KPiAgIAo+IC0JaWYgKCFkcm1fYW55X3BsYW5l
X2hhc19mb3JtYXQoJmRldl9wcml2LT5kcm0sCj4gKwlpZiAoIWRybV9hbnlfcGxhbmVfaGFzX2Zv
cm1hdCgmaTkxNS0+ZHJtLAo+ICAgCQkJCSAgICAgIG1vZGVfY21kLT5waXhlbF9mb3JtYXQsCj4g
ICAJCQkJICAgICAgbW9kZV9jbWQtPm1vZGlmaWVyWzBdKSkgewo+ICAgCQlzdHJ1Y3QgZHJtX2Zv
cm1hdF9uYW1lX2J1ZiBmb3JtYXRfbmFtZTsKPiBAQCAtMTU0MjcsMTMgKzE1NDI3LDEzIEBAIHN0
YXRpYyBpbnQgaW50ZWxfZnJhbWVidWZmZXJfaW5pdChzdHJ1Y3QgaW50ZWxfZnJhbWVidWZmZXIg
KmludGVsX2ZiLAo+ICAgCSAqIGdlbjIvMyBkaXNwbGF5IGVuZ2luZSB1c2VzIHRoZSBmZW5jZSBp
ZiBwcmVzZW50LAo+ICAgCSAqIHNvIHRoZSB0aWxpbmcgbW9kZSBtdXN0IG1hdGNoIHRoZSBmYiBt
b2RpZmllciBleGFjdGx5Lgo+ICAgCSAqLwo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA0
ICYmCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgNCAmJgo+ICAgCSAgICB0aWxpbmcgIT0gaW50
ZWxfZmJfbW9kaWZpZXJfdG9fdGlsaW5nKG1vZGVfY21kLT5tb2RpZmllclswXSkpIHsKPiAgIAkJ
RFJNX0RFQlVHX0tNUygidGlsaW5nX21vZGUgbXVzdCBtYXRjaCBmYiBtb2RpZmllciBleGFjdGx5
IG9uIGdlbjIvM1xuIik7Cj4gICAJCWdvdG8gZXJyOwo+ICAgCX0KPiAgIAo+IC0JbWF4X3N0cmlk
ZSA9IGludGVsX2ZiX21heF9zdHJpZGUoZGV2X3ByaXYsIG1vZGVfY21kLT5waXhlbF9mb3JtYXQs
Cj4gKwltYXhfc3RyaWRlID0gaW50ZWxfZmJfbWF4X3N0cmlkZShpOTE1LCBtb2RlX2NtZC0+cGl4
ZWxfZm9ybWF0LAo+ICAgCQkJCQkgbW9kZV9jbWQtPm1vZGlmaWVyWzBdKTsKPiAgIAlpZiAobW9k
ZV9jbWQtPnBpdGNoZXNbMF0gPiBtYXhfc3RyaWRlKSB7Cj4gICAJCURSTV9ERUJVR19LTVMoIiVz
IHBpdGNoICgldSkgbXVzdCBiZSBhdCBtb3N0ICVkXG4iLAo+IEBAIC0xNTQ1Nyw3ICsxNTQ1Nyw3
IEBAIHN0YXRpYyBpbnQgaW50ZWxfZnJhbWVidWZmZXJfaW5pdChzdHJ1Y3QgaW50ZWxfZnJhbWVi
dWZmZXIgKmludGVsX2ZiLAo+ICAgCWlmIChtb2RlX2NtZC0+b2Zmc2V0c1swXSAhPSAwKQo+ICAg
CQlnb3RvIGVycjsKPiAgIAo+IC0JZHJtX2hlbHBlcl9tb2RlX2ZpbGxfZmJfc3RydWN0KCZkZXZf
cHJpdi0+ZHJtLCBmYiwgbW9kZV9jbWQpOwo+ICsJZHJtX2hlbHBlcl9tb2RlX2ZpbGxfZmJfc3Ry
dWN0KCZpOTE1LT5kcm0sIGZiLCBtb2RlX2NtZCk7Cj4gICAKPiAgIAlmb3IgKGkgPSAwOyBpIDwg
ZmItPmZvcm1hdC0+bnVtX3BsYW5lczsgaSsrKSB7Cj4gICAJCXUzMiBzdHJpZGVfYWxpZ25tZW50
Owo+IEBAIC0xNTQ3OCw3ICsxNTQ3OCw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfZnJhbWVidWZmZXJf
aW5pdChzdHJ1Y3QgaW50ZWxfZnJhbWVidWZmZXIgKmludGVsX2ZiLAo+ICAgCQkgKiByZXF1aXJl
IHRoZSBlbnRpcmUgZmIgdG8gYWNjb21tb2RhdGUgdGhhdCB0byBhdm9pZAo+ICAgCQkgKiBwb3Rl
bnRpYWwgcnVudGltZSBlcnJvcnMgYXQgcGxhbmUgY29uZmlndXJhdGlvbiB0aW1lLgo+ICAgCQkg
Ki8KPiAtCQlpZiAoSVNfR0VOKGRldl9wcml2LCA5KSAmJiBpID09IDAgJiYgZmItPndpZHRoID4g
Mzg0MCAmJgo+ICsJCWlmIChJU19HRU4oaTkxNSwgOSkgJiYgaSA9PSAwICYmIGZiLT53aWR0aCA+
IDM4NDAgJiYKPiAgIAkJICAgIGlzX2Njc19tb2RpZmllcihmYi0+bW9kaWZpZXIpKQo+ICAgCQkJ
c3RyaWRlX2FsaWdubWVudCAqPSA0Owo+ICAgCj4gQEAgLTE1NDkxLDExICsxNTQ5MSwxMSBAQCBz
dGF0aWMgaW50IGludGVsX2ZyYW1lYnVmZmVyX2luaXQoc3RydWN0IGludGVsX2ZyYW1lYnVmZmVy
ICppbnRlbF9mYiwKPiAgIAkJZmItPm9ialtpXSA9ICZvYmotPmJhc2U7Cj4gICAJfQo+ICAgCj4g
LQlyZXQgPSBpbnRlbF9maWxsX2ZiX2luZm8oZGV2X3ByaXYsIGZiKTsKPiArCXJldCA9IGludGVs
X2ZpbGxfZmJfaW5mbyhpOTE1LCBmYik7Cj4gICAJaWYgKHJldCkKPiAgIAkJZ290byBlcnI7Cj4g
ICAKPiAtCXJldCA9IGRybV9mcmFtZWJ1ZmZlcl9pbml0KCZkZXZfcHJpdi0+ZHJtLCBmYiwgJmlu
dGVsX2ZiX2Z1bmNzKTsKPiArCXJldCA9IGRybV9mcmFtZWJ1ZmZlcl9pbml0KCZpOTE1LT5kcm0s
IGZiLCAmaW50ZWxfZmJfZnVuY3MpOwo+ICAgCWlmIChyZXQpIHsKPiAgIAkJRFJNX0VSUk9SKCJm
cmFtZWJ1ZmZlciBpbml0IGZhaWxlZCAlZFxuIiwgcmV0KTsKPiAgIAkJZ290byBlcnI7Cj4gQEAg
LTE1NTQ1LDcgKzE1NTQ1LDcgQEAgc3RhdGljIGVudW0gZHJtX21vZGVfc3RhdHVzCj4gICBpbnRl
bF9tb2RlX3ZhbGlkKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gICAJCSBjb25zdCBzdHJ1Y3Qg
ZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCWludCBoZGlzcGxheV9tYXgsIGh0b3RhbF9tYXg7Cj4g
ICAJaW50IHZkaXNwbGF5X21heCwgdnRvdGFsX21heDsKPiAgIAo+IEBAIC0xNTU3OCwxMyArMTU1
NzgsMTMgQEAgaW50ZWxfbW9kZV92YWxpZChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ICAgCQkJ
ICAgRFJNX01PREVfRkxBR19DTEtESVYyKSkKPiAgIAkJcmV0dXJuIE1PREVfQkFEOwo+ICAgCj4g
LQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5IHx8Cj4gLQkgICAgSVNfQlJPQURXRUxMKGRl
dl9wcml2KSB8fCBJU19IQVNXRUxMKGRldl9wcml2KSkgewo+ICsJaWYgKElOVEVMX0dFTihpOTE1
KSA+PSA5IHx8Cj4gKwkgICAgSVNfQlJPQURXRUxMKGk5MTUpIHx8IElTX0hBU1dFTEwoaTkxNSkp
IHsKPiAgIAkJaGRpc3BsYXlfbWF4ID0gODE5MjsgLyogRkRJIG1heCA0MDk2IGhhbmRsZWQgZWxz
ZXdoZXJlICovCj4gICAJCXZkaXNwbGF5X21heCA9IDQwOTY7Cj4gICAJCWh0b3RhbF9tYXggPSA4
MTkyOwo+ICAgCQl2dG90YWxfbWF4ID0gODE5MjsKPiAtCX0gZWxzZSBpZiAoSU5URUxfR0VOKGRl
dl9wcml2KSA+PSAzKSB7Cj4gKwl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSAzKSB7Cj4g
ICAJCWhkaXNwbGF5X21heCA9IDQwOTY7Cj4gICAJCXZkaXNwbGF5X21heCA9IDQwOTY7Cj4gICAJ
CWh0b3RhbF9tYXggPSA4MTkyOwo+IEBAIC0xNTYyNSwxMTMgKzE1NjI1LDExMyBAQCBzdGF0aWMg
Y29uc3Qgc3RydWN0IGRybV9tb2RlX2NvbmZpZ19mdW5jcyBpbnRlbF9tb2RlX2Z1bmNzID0gewo+
ICAgCj4gICAvKioKPiAgICAqIGludGVsX2luaXRfZGlzcGxheV9ob29rcyAtIGluaXRpYWxpemUg
dGhlIGRpc3BsYXkgbW9kZXNldHRpbmcgaG9va3MKPiAtICogQGRldl9wcml2OiBkZXZpY2UgcHJp
dmF0ZQo+ICsgKiBAaTkxNTogZGV2aWNlIHByaXZhdGUKPiAgICAqLwo+IC12b2lkIGludGVsX2lu
aXRfZGlzcGxheV9ob29rcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3Zv
aWQgaW50ZWxfaW5pdF9kaXNwbGF5X2hvb2tzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ICAgewo+IC0JaW50ZWxfaW5pdF9jZGNsa19ob29rcyhkZXZfcHJpdik7Cj4gKwlpbnRlbF9p
bml0X2NkY2xrX2hvb2tzKGk5MTUpOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+
PSA5KSB7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X3BpcGVfY29uZmlnID0gaGFzd2VsbF9n
ZXRfcGlwZV9jb25maWc7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X2luaXRpYWxfcGxhbmVf
Y29uZmlnID0KPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkgewo+ICsJCWk5MTUtPmRpc3Bs
YXkuZ2V0X3BpcGVfY29uZmlnID0gaGFzd2VsbF9nZXRfcGlwZV9jb25maWc7Cj4gKwkJaTkxNS0+
ZGlzcGxheS5nZXRfaW5pdGlhbF9wbGFuZV9jb25maWcgPQo+ICAgCQkJc2t5bGFrZV9nZXRfaW5p
dGlhbF9wbGFuZV9jb25maWc7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuY3J0Y19jb21wdXRlX2Ns
b2NrID0KPiArCQlpOTE1LT5kaXNwbGF5LmNydGNfY29tcHV0ZV9jbG9jayA9Cj4gICAJCQloYXN3
ZWxsX2NydGNfY29tcHV0ZV9jbG9jazsKPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5jcnRjX2VuYWJs
ZSA9IGhhc3dlbGxfY3J0Y19lbmFibGU7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuY3J0Y19kaXNh
YmxlID0gaGFzd2VsbF9jcnRjX2Rpc2FibGU7Cj4gLQl9IGVsc2UgaWYgKEhBU19EREkoZGV2X3By
aXYpKSB7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X3BpcGVfY29uZmlnID0gaGFzd2VsbF9n
ZXRfcGlwZV9jb25maWc7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X2luaXRpYWxfcGxhbmVf
Y29uZmlnID0KPiArCQlpOTE1LT5kaXNwbGF5LmNydGNfZW5hYmxlID0gaGFzd2VsbF9jcnRjX2Vu
YWJsZTsKPiArCQlpOTE1LT5kaXNwbGF5LmNydGNfZGlzYWJsZSA9IGhhc3dlbGxfY3J0Y19kaXNh
YmxlOwo+ICsJfSBlbHNlIGlmIChIQVNfRERJKGk5MTUpKSB7Cj4gKwkJaTkxNS0+ZGlzcGxheS5n
ZXRfcGlwZV9jb25maWcgPSBoYXN3ZWxsX2dldF9waXBlX2NvbmZpZzsKPiArCQlpOTE1LT5kaXNw
bGF5LmdldF9pbml0aWFsX3BsYW5lX2NvbmZpZyA9Cj4gICAJCQlpOXh4X2dldF9pbml0aWFsX3Bs
YW5lX2NvbmZpZzsKPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5jcnRjX2NvbXB1dGVfY2xvY2sgPQo+
ICsJCWk5MTUtPmRpc3BsYXkuY3J0Y19jb21wdXRlX2Nsb2NrID0KPiAgIAkJCWhhc3dlbGxfY3J0
Y19jb21wdXRlX2Nsb2NrOwo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmNydGNfZW5hYmxlID0gaGFz
d2VsbF9jcnRjX2VuYWJsZTsKPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5jcnRjX2Rpc2FibGUgPSBo
YXN3ZWxsX2NydGNfZGlzYWJsZTsKPiAtCX0gZWxzZSBpZiAoSEFTX1BDSF9TUExJVChkZXZfcHJp
dikpIHsKPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5nZXRfcGlwZV9jb25maWcgPSBpcm9ubGFrZV9n
ZXRfcGlwZV9jb25maWc7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X2luaXRpYWxfcGxhbmVf
Y29uZmlnID0KPiArCQlpOTE1LT5kaXNwbGF5LmNydGNfZW5hYmxlID0gaGFzd2VsbF9jcnRjX2Vu
YWJsZTsKPiArCQlpOTE1LT5kaXNwbGF5LmNydGNfZGlzYWJsZSA9IGhhc3dlbGxfY3J0Y19kaXNh
YmxlOwo+ICsJfSBlbHNlIGlmIChIQVNfUENIX1NQTElUKGk5MTUpKSB7Cj4gKwkJaTkxNS0+ZGlz
cGxheS5nZXRfcGlwZV9jb25maWcgPSBpcm9ubGFrZV9nZXRfcGlwZV9jb25maWc7Cj4gKwkJaTkx
NS0+ZGlzcGxheS5nZXRfaW5pdGlhbF9wbGFuZV9jb25maWcgPQo+ICAgCQkJaTl4eF9nZXRfaW5p
dGlhbF9wbGFuZV9jb25maWc7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuY3J0Y19jb21wdXRlX2Ns
b2NrID0KPiArCQlpOTE1LT5kaXNwbGF5LmNydGNfY29tcHV0ZV9jbG9jayA9Cj4gICAJCQlpcm9u
bGFrZV9jcnRjX2NvbXB1dGVfY2xvY2s7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuY3J0Y19lbmFi
bGUgPSBpcm9ubGFrZV9jcnRjX2VuYWJsZTsKPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5jcnRjX2Rp
c2FibGUgPSBpcm9ubGFrZV9jcnRjX2Rpc2FibGU7Cj4gLQl9IGVsc2UgaWYgKElTX0NIRVJSWVZJ
RVcoZGV2X3ByaXYpKSB7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X3BpcGVfY29uZmlnID0g
aTl4eF9nZXRfcGlwZV9jb25maWc7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X2luaXRpYWxf
cGxhbmVfY29uZmlnID0KPiArCQlpOTE1LT5kaXNwbGF5LmNydGNfZW5hYmxlID0gaXJvbmxha2Vf
Y3J0Y19lbmFibGU7Cj4gKwkJaTkxNS0+ZGlzcGxheS5jcnRjX2Rpc2FibGUgPSBpcm9ubGFrZV9j
cnRjX2Rpc2FibGU7Cj4gKwl9IGVsc2UgaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiArCQlp
OTE1LT5kaXNwbGF5LmdldF9waXBlX2NvbmZpZyA9IGk5eHhfZ2V0X3BpcGVfY29uZmlnOwo+ICsJ
CWk5MTUtPmRpc3BsYXkuZ2V0X2luaXRpYWxfcGxhbmVfY29uZmlnID0KPiAgIAkJCWk5eHhfZ2V0
X2luaXRpYWxfcGxhbmVfY29uZmlnOwo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmNydGNfY29tcHV0
ZV9jbG9jayA9IGNodl9jcnRjX2NvbXB1dGVfY2xvY2s7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXku
Y3J0Y19lbmFibGUgPSB2YWxsZXl2aWV3X2NydGNfZW5hYmxlOwo+IC0JCWRldl9wcml2LT5kaXNw
bGF5LmNydGNfZGlzYWJsZSA9IGk5eHhfY3J0Y19kaXNhYmxlOwo+IC0JfSBlbHNlIGlmIChJU19W
QUxMRVlWSUVXKGRldl9wcml2KSkgewo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmdldF9waXBlX2Nv
bmZpZyA9IGk5eHhfZ2V0X3BpcGVfY29uZmlnOwo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmdldF9p
bml0aWFsX3BsYW5lX2NvbmZpZyA9Cj4gKwkJaTkxNS0+ZGlzcGxheS5jcnRjX2NvbXB1dGVfY2xv
Y2sgPSBjaHZfY3J0Y19jb21wdXRlX2Nsb2NrOwo+ICsJCWk5MTUtPmRpc3BsYXkuY3J0Y19lbmFi
bGUgPSB2YWxsZXl2aWV3X2NydGNfZW5hYmxlOwo+ICsJCWk5MTUtPmRpc3BsYXkuY3J0Y19kaXNh
YmxlID0gaTl4eF9jcnRjX2Rpc2FibGU7Cj4gKwl9IGVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkx
NSkpIHsKPiArCQlpOTE1LT5kaXNwbGF5LmdldF9waXBlX2NvbmZpZyA9IGk5eHhfZ2V0X3BpcGVf
Y29uZmlnOwo+ICsJCWk5MTUtPmRpc3BsYXkuZ2V0X2luaXRpYWxfcGxhbmVfY29uZmlnID0KPiAg
IAkJCWk5eHhfZ2V0X2luaXRpYWxfcGxhbmVfY29uZmlnOwo+IC0JCWRldl9wcml2LT5kaXNwbGF5
LmNydGNfY29tcHV0ZV9jbG9jayA9IHZsdl9jcnRjX2NvbXB1dGVfY2xvY2s7Cj4gLQkJZGV2X3By
aXYtPmRpc3BsYXkuY3J0Y19lbmFibGUgPSB2YWxsZXl2aWV3X2NydGNfZW5hYmxlOwo+IC0JCWRl
dl9wcml2LT5kaXNwbGF5LmNydGNfZGlzYWJsZSA9IGk5eHhfY3J0Y19kaXNhYmxlOwo+IC0JfSBl
bHNlIGlmIChJU19HNFgoZGV2X3ByaXYpKSB7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X3Bp
cGVfY29uZmlnID0gaTl4eF9nZXRfcGlwZV9jb25maWc7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXku
Z2V0X2luaXRpYWxfcGxhbmVfY29uZmlnID0KPiArCQlpOTE1LT5kaXNwbGF5LmNydGNfY29tcHV0
ZV9jbG9jayA9IHZsdl9jcnRjX2NvbXB1dGVfY2xvY2s7Cj4gKwkJaTkxNS0+ZGlzcGxheS5jcnRj
X2VuYWJsZSA9IHZhbGxleXZpZXdfY3J0Y19lbmFibGU7Cj4gKwkJaTkxNS0+ZGlzcGxheS5jcnRj
X2Rpc2FibGUgPSBpOXh4X2NydGNfZGlzYWJsZTsKPiArCX0gZWxzZSBpZiAoSVNfRzRYKGk5MTUp
KSB7Cj4gKwkJaTkxNS0+ZGlzcGxheS5nZXRfcGlwZV9jb25maWcgPSBpOXh4X2dldF9waXBlX2Nv
bmZpZzsKPiArCQlpOTE1LT5kaXNwbGF5LmdldF9pbml0aWFsX3BsYW5lX2NvbmZpZyA9Cj4gICAJ
CQlpOXh4X2dldF9pbml0aWFsX3BsYW5lX2NvbmZpZzsKPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5j
cnRjX2NvbXB1dGVfY2xvY2sgPSBnNHhfY3J0Y19jb21wdXRlX2Nsb2NrOwo+IC0JCWRldl9wcml2
LT5kaXNwbGF5LmNydGNfZW5hYmxlID0gaTl4eF9jcnRjX2VuYWJsZTsKPiAtCQlkZXZfcHJpdi0+
ZGlzcGxheS5jcnRjX2Rpc2FibGUgPSBpOXh4X2NydGNfZGlzYWJsZTsKPiAtCX0gZWxzZSBpZiAo
SVNfUElORVZJRVcoZGV2X3ByaXYpKSB7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X3BpcGVf
Y29uZmlnID0gaTl4eF9nZXRfcGlwZV9jb25maWc7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0
X2luaXRpYWxfcGxhbmVfY29uZmlnID0KPiArCQlpOTE1LT5kaXNwbGF5LmNydGNfY29tcHV0ZV9j
bG9jayA9IGc0eF9jcnRjX2NvbXB1dGVfY2xvY2s7Cj4gKwkJaTkxNS0+ZGlzcGxheS5jcnRjX2Vu
YWJsZSA9IGk5eHhfY3J0Y19lbmFibGU7Cj4gKwkJaTkxNS0+ZGlzcGxheS5jcnRjX2Rpc2FibGUg
PSBpOXh4X2NydGNfZGlzYWJsZTsKPiArCX0gZWxzZSBpZiAoSVNfUElORVZJRVcoaTkxNSkpIHsK
PiArCQlpOTE1LT5kaXNwbGF5LmdldF9waXBlX2NvbmZpZyA9IGk5eHhfZ2V0X3BpcGVfY29uZmln
Owo+ICsJCWk5MTUtPmRpc3BsYXkuZ2V0X2luaXRpYWxfcGxhbmVfY29uZmlnID0KPiAgIAkJCWk5
eHhfZ2V0X2luaXRpYWxfcGxhbmVfY29uZmlnOwo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmNydGNf
Y29tcHV0ZV9jbG9jayA9IHBudl9jcnRjX2NvbXB1dGVfY2xvY2s7Cj4gLQkJZGV2X3ByaXYtPmRp
c3BsYXkuY3J0Y19lbmFibGUgPSBpOXh4X2NydGNfZW5hYmxlOwo+IC0JCWRldl9wcml2LT5kaXNw
bGF5LmNydGNfZGlzYWJsZSA9IGk5eHhfY3J0Y19kaXNhYmxlOwo+IC0JfSBlbHNlIGlmICghSVNf
R0VOKGRldl9wcml2LCAyKSkgewo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmdldF9waXBlX2NvbmZp
ZyA9IGk5eHhfZ2V0X3BpcGVfY29uZmlnOwo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmdldF9pbml0
aWFsX3BsYW5lX2NvbmZpZyA9Cj4gKwkJaTkxNS0+ZGlzcGxheS5jcnRjX2NvbXB1dGVfY2xvY2sg
PSBwbnZfY3J0Y19jb21wdXRlX2Nsb2NrOwo+ICsJCWk5MTUtPmRpc3BsYXkuY3J0Y19lbmFibGUg
PSBpOXh4X2NydGNfZW5hYmxlOwo+ICsJCWk5MTUtPmRpc3BsYXkuY3J0Y19kaXNhYmxlID0gaTl4
eF9jcnRjX2Rpc2FibGU7Cj4gKwl9IGVsc2UgaWYgKCFJU19HRU4oaTkxNSwgMikpIHsKPiArCQlp
OTE1LT5kaXNwbGF5LmdldF9waXBlX2NvbmZpZyA9IGk5eHhfZ2V0X3BpcGVfY29uZmlnOwo+ICsJ
CWk5MTUtPmRpc3BsYXkuZ2V0X2luaXRpYWxfcGxhbmVfY29uZmlnID0KPiAgIAkJCWk5eHhfZ2V0
X2luaXRpYWxfcGxhbmVfY29uZmlnOwo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmNydGNfY29tcHV0
ZV9jbG9jayA9IGk5eHhfY3J0Y19jb21wdXRlX2Nsb2NrOwo+IC0JCWRldl9wcml2LT5kaXNwbGF5
LmNydGNfZW5hYmxlID0gaTl4eF9jcnRjX2VuYWJsZTsKPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5j
cnRjX2Rpc2FibGUgPSBpOXh4X2NydGNfZGlzYWJsZTsKPiArCQlpOTE1LT5kaXNwbGF5LmNydGNf
Y29tcHV0ZV9jbG9jayA9IGk5eHhfY3J0Y19jb21wdXRlX2Nsb2NrOwo+ICsJCWk5MTUtPmRpc3Bs
YXkuY3J0Y19lbmFibGUgPSBpOXh4X2NydGNfZW5hYmxlOwo+ICsJCWk5MTUtPmRpc3BsYXkuY3J0
Y19kaXNhYmxlID0gaTl4eF9jcnRjX2Rpc2FibGU7Cj4gICAJfSBlbHNlIHsKPiAtCQlkZXZfcHJp
di0+ZGlzcGxheS5nZXRfcGlwZV9jb25maWcgPSBpOXh4X2dldF9waXBlX2NvbmZpZzsKPiAtCQlk
ZXZfcHJpdi0+ZGlzcGxheS5nZXRfaW5pdGlhbF9wbGFuZV9jb25maWcgPQo+ICsJCWk5MTUtPmRp
c3BsYXkuZ2V0X3BpcGVfY29uZmlnID0gaTl4eF9nZXRfcGlwZV9jb25maWc7Cj4gKwkJaTkxNS0+
ZGlzcGxheS5nZXRfaW5pdGlhbF9wbGFuZV9jb25maWcgPQo+ICAgCQkJaTl4eF9nZXRfaW5pdGlh
bF9wbGFuZV9jb25maWc7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuY3J0Y19jb21wdXRlX2Nsb2Nr
ID0gaTh4eF9jcnRjX2NvbXB1dGVfY2xvY2s7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuY3J0Y19l
bmFibGUgPSBpOXh4X2NydGNfZW5hYmxlOwo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmNydGNfZGlz
YWJsZSA9IGk5eHhfY3J0Y19kaXNhYmxlOwo+ICsJCWk5MTUtPmRpc3BsYXkuY3J0Y19jb21wdXRl
X2Nsb2NrID0gaTh4eF9jcnRjX2NvbXB1dGVfY2xvY2s7Cj4gKwkJaTkxNS0+ZGlzcGxheS5jcnRj
X2VuYWJsZSA9IGk5eHhfY3J0Y19lbmFibGU7Cj4gKwkJaTkxNS0+ZGlzcGxheS5jcnRjX2Rpc2Fi
bGUgPSBpOXh4X2NydGNfZGlzYWJsZTsKPiAgIAl9Cj4gICAKPiAtCWlmIChJU19HRU4oZGV2X3By
aXYsIDUpKSB7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZmRpX2xpbmtfdHJhaW4gPSBpcm9ubGFr
ZV9mZGlfbGlua190cmFpbjsKPiAtCX0gZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCA2KSkgewo+
IC0JCWRldl9wcml2LT5kaXNwbGF5LmZkaV9saW5rX3RyYWluID0gZ2VuNl9mZGlfbGlua190cmFp
bjsKPiAtCX0gZWxzZSBpZiAoSVNfSVZZQlJJREdFKGRldl9wcml2KSkgewo+ICsJaWYgKElTX0dF
TihpOTE1LCA1KSkgewo+ICsJCWk5MTUtPmRpc3BsYXkuZmRpX2xpbmtfdHJhaW4gPSBpcm9ubGFr
ZV9mZGlfbGlua190cmFpbjsKPiArCX0gZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDYpKSB7Cj4gKwkJ
aTkxNS0+ZGlzcGxheS5mZGlfbGlua190cmFpbiA9IGdlbjZfZmRpX2xpbmtfdHJhaW47Cj4gKwl9
IGVsc2UgaWYgKElTX0lWWUJSSURHRShpOTE1KSkgewo+ICAgCQkvKiBGSVhNRTogZGV0ZWN0IEIw
KyBzdGVwcGluZyBhbmQgdXNlIGF1dG8gdHJhaW5pbmcgKi8KPiAtCQlkZXZfcHJpdi0+ZGlzcGxh
eS5mZGlfbGlua190cmFpbiA9IGl2Yl9tYW51YWxfZmRpX2xpbmtfdHJhaW47Cj4gLQl9IGVsc2Ug
aWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElTX0JST0FEV0VMTChkZXZfcHJpdikpIHsKPiAt
CQlkZXZfcHJpdi0+ZGlzcGxheS5mZGlfbGlua190cmFpbiA9IGhzd19mZGlfbGlua190cmFpbjsK
PiArCQlpOTE1LT5kaXNwbGF5LmZkaV9saW5rX3RyYWluID0gaXZiX21hbnVhbF9mZGlfbGlua190
cmFpbjsKPiArCX0gZWxzZSBpZiAoSVNfSEFTV0VMTChpOTE1KSB8fCBJU19CUk9BRFdFTEwoaTkx
NSkpIHsKPiArCQlpOTE1LT5kaXNwbGF5LmZkaV9saW5rX3RyYWluID0gaHN3X2ZkaV9saW5rX3Ry
YWluOwo+ICAgCX0KPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkKPiAtCQlk
ZXZfcHJpdi0+ZGlzcGxheS51cGRhdGVfY3J0Y3MgPSBza2xfdXBkYXRlX2NydGNzOwo+ICsJaWYg
KElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ICsJCWk5MTUtPmRpc3BsYXkudXBkYXRlX2NydGNzID0g
c2tsX3VwZGF0ZV9jcnRjczsKPiAgIAllbHNlCj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkudXBkYXRl
X2NydGNzID0gaW50ZWxfdXBkYXRlX2NydGNzOwo+ICsJCWk5MTUtPmRpc3BsYXkudXBkYXRlX2Ny
dGNzID0gaW50ZWxfdXBkYXRlX2NydGNzOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBpOTE1X3JlZ190
IGk5MTVfdmdhY250cmxfcmVnKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAr
c3RhdGljIGk5MTVfcmVnX3QgaTkxNV92Z2FjbnRybF9yZWcoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCj4gICB7Cj4gLQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hF
UlJZVklFVyhkZXZfcHJpdikpCj4gKwlpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVS
UllWSUVXKGk5MTUpKQo+ICAgCQlyZXR1cm4gVkxWX1ZHQUNOVFJMOwo+IC0JZWxzZSBpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA+PSA1KQo+ICsJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDUp
Cj4gICAJCXJldHVybiBDUFVfVkdBQ05UUkw7Cj4gICAJZWxzZQo+ICAgCQlyZXR1cm4gVkdBQ05U
Ukw7Cj4gICB9Cj4gICAKPiAgIC8qIERpc2FibGUgdGhlIFZHQSBwbGFuZSB0aGF0IHdlIG5ldmVy
IHVzZSAqLwo+IC1zdGF0aWMgdm9pZCBpOTE1X2Rpc2FibGVfdmdhKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaTkxNV9kaXNhYmxlX3ZnYShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0g
ZGV2X3ByaXYtPmRybS5wZGV2Owo+ICsJc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBpOTE1LT5kcm0u
cGRldjsKPiAgIAl1OCBzcjE7Cj4gLQlpOTE1X3JlZ190IHZnYV9yZWcgPSBpOTE1X3ZnYWNudHJs
X3JlZyhkZXZfcHJpdik7Cj4gKwlpOTE1X3JlZ190IHZnYV9yZWcgPSBpOTE1X3ZnYWNudHJsX3Jl
ZyhpOTE1KTsKPiAgIAo+ICAgCS8qIFdhRW5hYmxlVkdBQWNjZXNzVGhyb3VnaElPUG9ydDpjdGcs
ZWxrLGlsayxzbmIsaXZiLHZsdixoc3cgKi8KPiAgIAl2Z2FfZ2V0X3VuaW50ZXJydXB0aWJsZShw
ZGV2LCBWR0FfUlNSQ19MRUdBQ1lfSU8pOwo+IEBAIC0xNTc0NywxMSArMTU3NDcsMTEgQEAgc3Rh
dGljIHZvaWQgaTkxNV9kaXNhYmxlX3ZnYShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gICAKPiAgIHZvaWQgaW50ZWxfbW9kZXNldF9pbml0X2h3KHN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2
KTsKPiAgIAo+IC0JaW50ZWxfdXBkYXRlX2NkY2xrKGRldl9wcml2KTsKPiAtCWludGVsX2R1bXBf
Y2RjbGtfc3RhdGUoJmRldl9wcml2LT5jZGNsay5odywgIkN1cnJlbnQgQ0RDTEsiKTsKPiAtCWRl
dl9wcml2LT5jZGNsay5sb2dpY2FsID0gZGV2X3ByaXYtPmNkY2xrLmFjdHVhbCA9IGRldl9wcml2
LT5jZGNsay5odzsKPiArCWludGVsX3VwZGF0ZV9jZGNsayhpOTE1KTsKPiArCWludGVsX2R1bXBf
Y2RjbGtfc3RhdGUoJmk5MTUtPmNkY2xrLmh3LCAiQ3VycmVudCBDRENMSyIpOwo+ICsJaTkxNS0+
Y2RjbGsubG9naWNhbCA9IGk5MTUtPmNkY2xrLmFjdHVhbCA9IGk5MTUtPmNkY2xrLmh3Owo+ICAg
fQo+ICAgCj4gICAvKgo+IEBAIC0xNTc2Niw3ICsxNTc2Niw3IEBAIHZvaWQgaW50ZWxfbW9kZXNl
dF9pbml0X2h3KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gICAgKi8KPiAgIHN0YXRpYyB2b2lk
IHNhbml0aXplX3dhdGVybWFya3Moc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIHsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXN0cnVjdCBkcm1f
YXRvbWljX3N0YXRlICpzdGF0ZTsKPiAgIAlzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICppbnRl
bF9zdGF0ZTsKPiAgIAlzdHJ1Y3QgZHJtX2NydGMgKmNydGM7Cj4gQEAgLTE1Nzc2LDcgKzE1Nzc2
LDcgQEAgc3RhdGljIHZvaWQgc2FuaXRpemVfd2F0ZXJtYXJrcyhzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2KQo+ICAgCWludCBpOwo+ICAgCj4gICAJLyogT25seSBzdXBwb3J0ZWQgb24gcGxhdGZvcm1z
IHRoYXQgdXNlIGF0b21pYyB3YXRlcm1hcmsgZGVzaWduICovCj4gLQlpZiAoIWRldl9wcml2LT5k
aXNwbGF5Lm9wdGltaXplX3dhdGVybWFya3MpCj4gKwlpZiAoIWk5MTUtPmRpc3BsYXkub3B0aW1p
emVfd2F0ZXJtYXJrcykKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJLyoKPiBAQCAtMTU4MDQsNyAr
MTU4MDQsNyBAQCBzdGF0aWMgdm9pZCBzYW5pdGl6ZV93YXRlcm1hcmtzKHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYpCj4gICAJICogaW50ZXJtZWRpYXRlIHdhdGVybWFya3MgKHNpbmNlIHdlIGRvbid0
IHRydXN0IHRoZSBjdXJyZW50Cj4gICAJICogd2F0ZXJtYXJrcykuCj4gICAJICovCj4gLQlpZiAo
IUhBU19HTUNIKGRldl9wcml2KSkKPiArCWlmICghSEFTX0dNQ0goaTkxNSkpCj4gICAJCWludGVs
X3N0YXRlLT5za2lwX2ludGVybWVkaWF0ZV93bSA9IHRydWU7Cj4gICAKPiAgIAlyZXQgPSBpbnRl
bF9hdG9taWNfY2hlY2soZGV2LCBzdGF0ZSk7Cj4gQEAgLTE1ODI5LDcgKzE1ODI5LDcgQEAgc3Rh
dGljIHZvaWQgc2FuaXRpemVfd2F0ZXJtYXJrcyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAg
CQlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3MgPSB0b19pbnRlbF9jcnRjX3N0YXRlKGNzdGF0
ZSk7Cj4gICAKPiAgIAkJY3MtPndtLm5lZWRfcG9zdHZibF91cGRhdGUgPSB0cnVlOwo+IC0JCWRl
dl9wcml2LT5kaXNwbGF5Lm9wdGltaXplX3dhdGVybWFya3MoaW50ZWxfc3RhdGUsIGNzKTsKPiAr
CQlpOTE1LT5kaXNwbGF5Lm9wdGltaXplX3dhdGVybWFya3MoaW50ZWxfc3RhdGUsIGNzKTsKPiAg
IAo+ICAgCQl0b19pbnRlbF9jcnRjX3N0YXRlKGNydGMtPnN0YXRlKS0+d20gPSBjcy0+d207Cj4g
ICAJfQo+IEBAIC0xNTg0MSwyMCArMTU4NDEsMjAgQEAgc3RhdGljIHZvaWQgc2FuaXRpemVfd2F0
ZXJtYXJrcyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAgCWRybV9tb2Rlc2V0X2FjcXVpcmVf
ZmluaSgmY3R4KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpbnRlbF91cGRhdGVfZmRpX3Bs
bF9mcmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQg
aW50ZWxfdXBkYXRlX2ZkaV9wbGxfZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiAgIHsKPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDUpKSB7Cj4gKwlpZiAoSVNfR0VOKGk5MTUs
IDUpKSB7Cj4gICAJCXUzMiBmZGlfcGxsX2NsayA9Cj4gICAJCQlJOTE1X1JFQUQoRkRJX1BMTF9C
SU9TXzApICYgRkRJX1BMTF9GQl9DTE9DS19NQVNLOwo+ICAgCj4gLQkJZGV2X3ByaXYtPmZkaV9w
bGxfZnJlcSA9IChmZGlfcGxsX2NsayArIDIpICogMTAwMDA7Cj4gLQl9IGVsc2UgaWYgKElTX0dF
TihkZXZfcHJpdiwgNikgfHwgSVNfSVZZQlJJREdFKGRldl9wcml2KSkgewo+IC0JCWRldl9wcml2
LT5mZGlfcGxsX2ZyZXEgPSAyNzAwMDA7Cj4gKwkJaTkxNS0+ZmRpX3BsbF9mcmVxID0gKGZkaV9w
bGxfY2xrICsgMikgKiAxMDAwMDsKPiArCX0gZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDYpIHx8IElT
X0lWWUJSSURHRShpOTE1KSkgewo+ICsJCWk5MTUtPmZkaV9wbGxfZnJlcSA9IDI3MDAwMDsKPiAg
IAl9IGVsc2Ugewo+ICAgCQlyZXR1cm47Cj4gICAJfQo+ICAgCj4gLQlEUk1fREVCVUdfRFJJVkVS
KCJGREkgUExMIGZyZXE9JWRcbiIsIGRldl9wcml2LT5mZGlfcGxsX2ZyZXEpOwo+ICsJRFJNX0RF
QlVHX0RSSVZFUigiRkRJIFBMTCBmcmVxPSVkXG4iLCBpOTE1LT5mZGlfcGxsX2ZyZXEpOwo+ICAg
fQo+ICAgCj4gICBzdGF0aWMgaW50IGludGVsX2luaXRpYWxfY29tbWl0KHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYpCj4gQEAgLTE1OTE1LDE3ICsxNTkxNSwxNyBAQCBzdGF0aWMgaW50IGludGVsX2lu
aXRpYWxfY29tbWl0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gICAKPiAgIGludCBpbnRlbF9t
b2Rlc2V0X2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIHsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiAtCXN0cnVjdCBpOTE1X2dn
dHQgKmdndHQgPSAmZGV2X3ByaXYtPmdndHQ7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBpOTE1X2dndHQgKmdndHQgPSAmaTkxNS0+
Z2d0dDsKPiAgIAllbnVtIHBpcGUgcGlwZTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsK
PiAgIAlpbnQgcmV0Owo+ICAgCj4gLQlkZXZfcHJpdi0+bW9kZXNldF93cSA9IGFsbG9jX29yZGVy
ZWRfd29ya3F1ZXVlKCJpOTE1X21vZGVzZXQiLCAwKTsKPiArCWk5MTUtPm1vZGVzZXRfd3EgPSBh
bGxvY19vcmRlcmVkX3dvcmtxdWV1ZSgiaTkxNV9tb2Rlc2V0IiwgMCk7Cj4gICAKPiAgIAlkcm1f
bW9kZV9jb25maWdfaW5pdChkZXYpOwo+ICAgCj4gLQlyZXQgPSBpbnRlbF9id19pbml0KGRldl9w
cml2KTsKPiArCXJldCA9IGludGVsX2J3X2luaXQoaTkxNSk7Cj4gICAJaWYgKHJldCkKPiAgIAkJ
cmV0dXJuIHJldDsKPiAgIAo+IEBAIC0xNTkzOSwxNSArMTU5MzksMTUgQEAgaW50IGludGVsX21v
ZGVzZXRfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAgCj4gICAJZGV2LT5tb2RlX2Nv
bmZpZy5mdW5jcyA9ICZpbnRlbF9tb2RlX2Z1bmNzOwo+ICAgCj4gLQlpbml0X2xsaXN0X2hlYWQo
JmRldl9wcml2LT5hdG9taWNfaGVscGVyLmZyZWVfbGlzdCk7Cj4gLQlJTklUX1dPUksoJmRldl9w
cml2LT5hdG9taWNfaGVscGVyLmZyZWVfd29yaywKPiArCWluaXRfbGxpc3RfaGVhZCgmaTkxNS0+
YXRvbWljX2hlbHBlci5mcmVlX2xpc3QpOwo+ICsJSU5JVF9XT1JLKCZpOTE1LT5hdG9taWNfaGVs
cGVyLmZyZWVfd29yaywKPiAgIAkJICBpbnRlbF9hdG9taWNfaGVscGVyX2ZyZWVfc3RhdGVfd29y
a2VyKTsKPiAgIAo+IC0JaW50ZWxfaW5pdF9xdWlya3MoZGV2X3ByaXYpOwo+ICsJaW50ZWxfaW5p
dF9xdWlya3MoaTkxNSk7Cj4gICAKPiAtCWludGVsX2ZiY19pbml0KGRldl9wcml2KTsKPiArCWlu
dGVsX2ZiY19pbml0KGk5MTUpOwo+ICAgCj4gLQlpbnRlbF9pbml0X3BtKGRldl9wcml2KTsKPiAr
CWludGVsX2luaXRfcG0oaTkxNSk7Cj4gICAKPiAgIAkvKgo+ICAgCSAqIFRoZXJlIG1heSBiZSBu
byBWQlQ7IGFuZCBpZiB0aGUgQklPUyBlbmFibGVkIFNTQyB3ZSBjYW4KPiBAQCAtMTU5NTUsMTUg
KzE1OTU1LDE1IEBAIGludCBpbnRlbF9tb2Rlc2V0X2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRl
dikKPiAgIAkgKiBCSU9TIGlzbid0IHVzaW5nIGl0LCBkb24ndCBhc3N1bWUgaXQgd2lsbCB3b3Jr
IGV2ZW4gaWYgdGhlIFZCVAo+ICAgCSAqIGluZGljYXRlcyBhcyBtdWNoLgo+ICAgCSAqLwo+IC0J
aWYgKEhBU19QQ0hfSUJYKGRldl9wcml2KSB8fCBIQVNfUENIX0NQVChkZXZfcHJpdikpIHsKPiAr
CWlmIChIQVNfUENIX0lCWChpOTE1KSB8fCBIQVNfUENIX0NQVChpOTE1KSkgewo+ICAgCQlib29s
IGJpb3NfbHZkc191c2Vfc3NjID0gISEoSTkxNV9SRUFEKFBDSF9EUkVGX0NPTlRST0wpICYKPiAg
IAkJCQkJICAgIERSRUZfU1NDMV9FTkFCTEUpOwo+ICAgCj4gLQkJaWYgKGRldl9wcml2LT52YnQu
bHZkc191c2Vfc3NjICE9IGJpb3NfbHZkc191c2Vfc3NjKSB7Cj4gKwkJaWYgKGk5MTUtPnZidC5s
dmRzX3VzZV9zc2MgIT0gYmlvc19sdmRzX3VzZV9zc2MpIHsKPiAgIAkJCURSTV9ERUJVR19LTVMo
IlNTQyAlc2FibGVkIGJ5IEJJT1MsIG92ZXJyaWRpbmcgVkJUIHdoaWNoIHNheXMgJXNhYmxlZFxu
IiwKPiAgIAkJCQkgICAgIGJpb3NfbHZkc191c2Vfc3NjID8gImVuIiA6ICJkaXMiLAo+IC0JCQkJ
ICAgICBkZXZfcHJpdi0+dmJ0Lmx2ZHNfdXNlX3NzYyA/ICJlbiIgOiAiZGlzIik7Cj4gLQkJCWRl
dl9wcml2LT52YnQubHZkc191c2Vfc3NjID0gYmlvc19sdmRzX3VzZV9zc2M7Cj4gKwkJCQkgICAg
IGk5MTUtPnZidC5sdmRzX3VzZV9zc2MgPyAiZW4iIDogImRpcyIpOwo+ICsJCQlpOTE1LT52YnQu
bHZkc191c2Vfc3NjID0gYmlvc19sdmRzX3VzZV9zc2M7Cj4gICAJCX0KPiAgIAl9Cj4gICAKPiBA
QCAtMTU5NzEsMTMgKzE1OTcxLDEzIEBAIGludCBpbnRlbF9tb2Rlc2V0X2luaXQoc3RydWN0IGRy
bV9kZXZpY2UgKmRldikKPiAgIAkgKiBNYXhpbXVtIGZyYW1lYnVmZmVyIGRpbWVuc2lvbnMsIGNo
b3NlbiB0byBtYXRjaAo+ICAgCSAqIHRoZSBtYXhpbXVtIHJlbmRlciBlbmdpbmUgc3VyZmFjZSBz
aXplIG9uIGdlbjQrLgo+ICAgCSAqLwo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNykg
ewo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA3KSB7Cj4gICAJCWRldi0+bW9kZV9jb25maWcu
bWF4X3dpZHRoID0gMTYzODQ7Cj4gICAJCWRldi0+bW9kZV9jb25maWcubWF4X2hlaWdodCA9IDE2
Mzg0Owo+IC0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDQpIHsKPiArCX0gZWxz
ZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDQpIHsKPiAgIAkJZGV2LT5tb2RlX2NvbmZpZy5tYXhf
d2lkdGggPSA4MTkyOwo+ICAgCQlkZXYtPm1vZGVfY29uZmlnLm1heF9oZWlnaHQgPSA4MTkyOwo+
IC0JfSBlbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDMpKSB7Cj4gKwl9IGVsc2UgaWYgKElTX0dF
TihpOTE1LCAzKSkgewo+ICAgCQlkZXYtPm1vZGVfY29uZmlnLm1heF93aWR0aCA9IDQwOTY7Cj4g
ICAJCWRldi0+bW9kZV9jb25maWcubWF4X2hlaWdodCA9IDQwOTY7Cj4gICAJfSBlbHNlIHsKPiBA
QCAtMTU5ODUsMTAgKzE1OTg1LDEwIEBAIGludCBpbnRlbF9tb2Rlc2V0X2luaXQoc3RydWN0IGRy
bV9kZXZpY2UgKmRldikKPiAgIAkJZGV2LT5tb2RlX2NvbmZpZy5tYXhfaGVpZ2h0ID0gMjA0ODsK
PiAgIAl9Cj4gICAKPiAtCWlmIChJU19JODQ1RyhkZXZfcHJpdikgfHwgSVNfSTg2NUcoZGV2X3By
aXYpKSB7Cj4gLQkJZGV2LT5tb2RlX2NvbmZpZy5jdXJzb3Jfd2lkdGggPSBJU19JODQ1RyhkZXZf
cHJpdikgPyA2NCA6IDUxMjsKPiArCWlmIChJU19JODQ1RyhpOTE1KSB8fCBJU19JODY1RyhpOTE1
KSkgewo+ICsJCWRldi0+bW9kZV9jb25maWcuY3Vyc29yX3dpZHRoID0gSVNfSTg0NUcoaTkxNSkg
PyA2NCA6IDUxMjsKPiAgIAkJZGV2LT5tb2RlX2NvbmZpZy5jdXJzb3JfaGVpZ2h0ID0gMTAyMzsK
PiAtCX0gZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCAyKSkgewo+ICsJfSBlbHNlIGlmIChJU19H
RU4oaTkxNSwgMikpIHsKPiAgIAkJZGV2LT5tb2RlX2NvbmZpZy5jdXJzb3Jfd2lkdGggPSA2NDsK
PiAgIAkJZGV2LT5tb2RlX2NvbmZpZy5jdXJzb3JfaGVpZ2h0ID0gNjQ7Cj4gICAJfSBlbHNlIHsK
PiBAQCAtMTU5OTksMTEgKzE1OTk5LDExIEBAIGludCBpbnRlbF9tb2Rlc2V0X2luaXQoc3RydWN0
IGRybV9kZXZpY2UgKmRldikKPiAgIAlkZXYtPm1vZGVfY29uZmlnLmZiX2Jhc2UgPSBnZ3R0LT5n
bWFkci5zdGFydDsKPiAgIAo+ICAgCURSTV9ERUJVR19LTVMoIiVkIGRpc3BsYXkgcGlwZSVzIGF2
YWlsYWJsZS5cbiIsCj4gLQkJICAgICAgSU5URUxfSU5GTyhkZXZfcHJpdiktPm51bV9waXBlcywK
PiAtCQkgICAgICBJTlRFTF9JTkZPKGRldl9wcml2KS0+bnVtX3BpcGVzID4gMSA/ICJzIiA6ICIi
KTsKPiArCQkgICAgICBJTlRFTF9JTkZPKGk5MTUpLT5udW1fcGlwZXMsCj4gKwkJICAgICAgSU5U
RUxfSU5GTyhpOTE1KS0+bnVtX3BpcGVzID4gMSA/ICJzIiA6ICIiKTsKPiAgIAo+IC0JZm9yX2Vh
Y2hfcGlwZShkZXZfcHJpdiwgcGlwZSkgewo+IC0JCXJldCA9IGludGVsX2NydGNfaW5pdChkZXZf
cHJpdiwgcGlwZSk7Cj4gKwlmb3JfZWFjaF9waXBlKGk5MTUsIHBpcGUpIHsKPiArCQlyZXQgPSBp
bnRlbF9jcnRjX2luaXQoaTkxNSwgcGlwZSk7Cj4gICAJCWlmIChyZXQpIHsKPiAgIAkJCWRybV9t
b2RlX2NvbmZpZ19jbGVhbnVwKGRldik7Cj4gICAJCQlyZXR1cm4gcmV0Owo+IEBAIC0xNjAxMSwx
OSArMTYwMTEsMTkgQEAgaW50IGludGVsX21vZGVzZXRfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2KQo+ICAgCX0KPiAgIAo+ICAgCWludGVsX3NoYXJlZF9kcGxsX2luaXQoZGV2KTsKPiAtCWlu
dGVsX3VwZGF0ZV9mZGlfcGxsX2ZyZXEoZGV2X3ByaXYpOwo+ICsJaW50ZWxfdXBkYXRlX2ZkaV9w
bGxfZnJlcShpOTE1KTsKPiAgIAo+IC0JaW50ZWxfdXBkYXRlX2N6Y2xrKGRldl9wcml2KTsKPiAr
CWludGVsX3VwZGF0ZV9jemNsayhpOTE1KTsKPiAgIAlpbnRlbF9tb2Rlc2V0X2luaXRfaHcoZGV2
KTsKPiAgIAo+IC0JaW50ZWxfaGRjcF9jb21wb25lbnRfaW5pdChkZXZfcHJpdik7Cj4gKwlpbnRl
bF9oZGNwX2NvbXBvbmVudF9pbml0KGk5MTUpOwo+ICAgCj4gLQlpZiAoZGV2X3ByaXYtPm1heF9j
ZGNsa19mcmVxID09IDApCj4gLQkJaW50ZWxfdXBkYXRlX21heF9jZGNsayhkZXZfcHJpdik7Cj4g
KwlpZiAoaTkxNS0+bWF4X2NkY2xrX2ZyZXEgPT0gMCkKPiArCQlpbnRlbF91cGRhdGVfbWF4X2Nk
Y2xrKGk5MTUpOwo+ICAgCj4gICAJLyogSnVzdCBkaXNhYmxlIGl0IG9uY2UgYXQgc3RhcnR1cCAq
Lwo+IC0JaTkxNV9kaXNhYmxlX3ZnYShkZXZfcHJpdik7Cj4gLQlpbnRlbF9zZXR1cF9vdXRwdXRz
KGRldl9wcml2KTsKPiArCWk5MTVfZGlzYWJsZV92Z2EoaTkxNSk7Cj4gKwlpbnRlbF9zZXR1cF9v
dXRwdXRzKGk5MTUpOwo+ICAgCj4gICAJZHJtX21vZGVzZXRfbG9ja19hbGwoZGV2KTsKPiAgIAlp
bnRlbF9tb2Rlc2V0X3NldHVwX2h3X3N0YXRlKGRldiwgZGV2LT5tb2RlX2NvbmZpZy5hY3F1aXJl
X2N0eCk7Cj4gQEAgLTE2MDQyLDcgKzE2MDQyLDcgQEAgaW50IGludGVsX21vZGVzZXRfaW5pdChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAgCQkgKiBjYW4gZXZlbiBhbGxvdyBmb3Igc21vb3Ro
IGJvb3QgdHJhbnNpdGlvbnMgaWYgdGhlIEJJT1MKPiAgIAkJICogZmIgaXMgbGFyZ2UgZW5vdWdo
IGZvciB0aGUgYWN0aXZlIHBpcGUgY29uZmlndXJhdGlvbi4KPiAgIAkJICovCj4gLQkJZGV2X3By
aXYtPmRpc3BsYXkuZ2V0X2luaXRpYWxfcGxhbmVfY29uZmlnKGNydGMsCj4gKwkJaTkxNS0+ZGlz
cGxheS5nZXRfaW5pdGlhbF9wbGFuZV9jb25maWcoY3J0YywKPiAgIAkJCQkJCQkgICAmcGxhbmVf
Y29uZmlnKTsKPiAgIAo+ICAgCQkvKgo+IEBAIC0xNjA1Nyw3ICsxNjA1Nyw3IEBAIGludCBpbnRl
bF9tb2Rlc2V0X2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIAkgKiBOb3RlIHRoYXQg
d2UgbmVlZCB0byBkbyB0aGlzIGFmdGVyIHJlY29uc3RydWN0aW5nIHRoZSBCSU9TIGZiJ3MKPiAg
IAkgKiBzaW5jZSB0aGUgd2F0ZXJtYXJrIGNhbGN1bGF0aW9uIGRvbmUgaGVyZSB3aWxsIHVzZSBw
c3RhdGUtPmZiLgo+ICAgCSAqLwo+IC0JaWYgKCFIQVNfR01DSChkZXZfcHJpdikpCj4gKwlpZiAo
IUhBU19HTUNIKGk5MTUpKQo+ICAgCQlzYW5pdGl6ZV93YXRlcm1hcmtzKGRldik7Cj4gICAKPiAg
IAkvKgo+IEBAIC0xNjA3Myw5ICsxNjA3Myw5IEBAIGludCBpbnRlbF9tb2Rlc2V0X2luaXQoc3Ry
dWN0IGRybV9kZXZpY2UgKmRldikKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+IC12b2lkIGk4
MzBfZW5hYmxlX3BpcGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBp
cGUgcGlwZSkKPiArdm9pZCBpODMwX2VuYWJsZV9waXBlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LCBlbnVtIHBpcGUgcGlwZSkKPiAgIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
ID0gaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIHBpcGUpOwo+ICsJc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShpOTE1LCBwaXBlKTsKPiAg
IAkvKiA2NDB4NDgwQDYwSHosIH4yNTE3NSBrSHogKi8KPiAgIAlzdHJ1Y3QgZHBsbCBjbG9jayA9
IHsKPiAgIAkJLm0xID0gMTgsCj4gQEAgLTE2MTQzLDkgKzE2MTQzLDkgQEAgdm9pZCBpODMwX2Vu
YWJsZV9waXBlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBp
cGUpCj4gICAJaW50ZWxfd2FpdF9mb3JfcGlwZV9zY2FubGluZV9tb3ZpbmcoY3J0Yyk7Cj4gICB9
Cj4gICAKPiAtdm9pZCBpODMwX2Rpc2FibGVfcGlwZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsIGVudW0gcGlwZSBwaXBlKQo+ICt2b2lkIGk4MzBfZGlzYWJsZV9waXBlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBpcGUgcGlwZSkKPiAgIHsKPiAtCXN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIHBp
cGUpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3JfcGlw
ZShpOTE1LCBwaXBlKTsKPiAgIAo+ICAgCURSTV9ERUJVR19LTVMoImRpc2FibGluZyBwaXBlICVj
IGR1ZSB0byBmb3JjZSBxdWlya1xuIiwKPiAgIAkJICAgICAgcGlwZV9uYW1lKHBpcGUpKTsKPiBA
QCAtMTYxNjYsMTQgKzE2MTY2LDE0IEBAIHZvaWQgaTgzMF9kaXNhYmxlX3BpcGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUgcGlwZSkKPiAgIH0KPiAgIAo+ICAg
c3RhdGljIHZvaWQKPiAtaW50ZWxfc2FuaXRpemVfcGxhbmVfbWFwcGluZyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK2ludGVsX3Nhbml0aXplX3BsYW5lX21hcHBpbmcoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2NydGMg
KmNydGM7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDQpCj4gKwlpZiAoSU5U
RUxfR0VOKGk5MTUpID49IDQpCj4gICAJCXJldHVybjsKPiAgIAo+IC0JZm9yX2VhY2hfaW50ZWxf
Y3J0YygmZGV2X3ByaXYtPmRybSwgY3J0Yykgewo+ICsJZm9yX2VhY2hfaW50ZWxfY3J0YygmaTkx
NS0+ZHJtLCBjcnRjKSB7Cj4gICAJCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUgPQo+ICAgCQkJ
dG9faW50ZWxfcGxhbmUoY3J0Yy0+YmFzZS5wcmltYXJ5KTsKPiAgIAkJc3RydWN0IGludGVsX2Ny
dGMgKnBsYW5lX2NydGM7Cj4gQEAgLTE2MTg4LDcgKzE2MTg4LDcgQEAgaW50ZWxfc2FuaXRpemVf
cGxhbmVfbWFwcGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCURS
TV9ERUJVR19LTVMoIltQTEFORTolZDolc10gYXR0YWNoZWQgdG8gdGhlIHdyb25nIHBpcGUsIGRp
c2FibGluZyBwbGFuZVxuIiwKPiAgIAkJCSAgICAgIHBsYW5lLT5iYXNlLmJhc2UuaWQsIHBsYW5l
LT5iYXNlLm5hbWUpOwo+ICAgCj4gLQkJcGxhbmVfY3J0YyA9IGludGVsX2dldF9jcnRjX2Zvcl9w
aXBlKGRldl9wcml2LCBwaXBlKTsKPiArCQlwbGFuZV9jcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9y
X3BpcGUoaTkxNSwgcGlwZSk7Cj4gICAJCWludGVsX3BsYW5lX2Rpc2FibGVfbm9hdG9taWMocGxh
bmVfY3J0YywgcGxhbmUpOwo+ICAgCX0KPiAgIH0KPiBAQCAtMTYyMTUsMTggKzE2MjE1LDE4IEBA
IHN0YXRpYyBzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICppbnRlbF9lbmNvZGVyX2ZpbmRfY29ubmVj
dG9yKHN0cnVjdCBpbnRlbF9lbmNvZGVyCj4gICAJcmV0dXJuIE5VTEw7Cj4gICB9Cj4gICAKPiAt
c3RhdGljIGJvb2wgaGFzX3BjaF90cmFuY29kZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ICtzdGF0aWMgYm9vbCBoYXNfcGNoX3RyYW5jb2RlcihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgIGVudW0gcGlwZSBwY2hfdHJhbnNjb2RlcikKPiAg
IHsKPiAtCXJldHVybiBIQVNfUENIX0lCWChkZXZfcHJpdikgfHwgSEFTX1BDSF9DUFQoZGV2X3By
aXYpIHx8Cj4gLQkJKEhBU19QQ0hfTFBUX0goZGV2X3ByaXYpICYmIHBjaF90cmFuc2NvZGVyID09
IFBJUEVfQSk7Cj4gKwlyZXR1cm4gSEFTX1BDSF9JQlgoaTkxNSkgfHwgSEFTX1BDSF9DUFQoaTkx
NSkgfHwKPiArCQkoSEFTX1BDSF9MUFRfSChpOTE1KSAmJiBwY2hfdHJhbnNjb2RlciA9PSBQSVBF
X0EpOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZCBpbnRlbF9zYW5pdGl6ZV9jcnRjKHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCQkJCXN0cnVjdCBkcm1fbW9kZXNldF9hY3F1aXJlX2N0
eCAqY3R4KQo+ICAgewo+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5iYXNlLmRl
djsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsK
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlID0gdG9faW50ZWxfY3J0Y19zdGF0ZShj
cnRjLT5iYXNlLnN0YXRlKTsKPiAgIAllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBj
cnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcjsKPiAgIAo+IEBAIC0xNjI1NSw3ICsxNjI1NSw3IEBA
IHN0YXRpYyB2b2lkIGludGVsX3Nhbml0aXplX2NydGMoc3RydWN0IGludGVsX2NydGMgKmNydGMs
Cj4gICAJCSAqIERpc2FibGUgYW55IGJhY2tncm91bmQgY29sb3Igc2V0IGJ5IHRoZSBCSU9TLCBi
dXQgZW5hYmxlIHRoZQo+ICAgCQkgKiBnYW1tYSBhbmQgQ1NDIHRvIG1hdGNoIGhvdyB3ZSBwcm9n
cmFtIG91ciBwbGFuZXMuCj4gICAJCSAqLwo+IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDkpCj4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ICAgCQkJSTkxNV9XUklURShTS0xf
Qk9UVE9NX0NPTE9SKGNydGMtPnBpcGUpLAo+ICAgCQkJCSAgIFNLTF9CT1RUT01fQ09MT1JfR0FN
TUFfRU5BQkxFIHwKPiAgIAkJCQkgICBTS0xfQk9UVE9NX0NPTE9SX0NTQ19FTkFCTEUpOwo+IEBA
IC0xNjI2Niw3ICsxNjI2Niw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3Nhbml0aXplX2NydGMoc3Ry
dWN0IGludGVsX2NydGMgKmNydGMsCj4gICAJaWYgKGNydGNfc3RhdGUtPmJhc2UuYWN0aXZlICYm
ICFpbnRlbF9jcnRjX2hhc19lbmNvZGVycyhjcnRjKSkKPiAgIAkJaW50ZWxfY3J0Y19kaXNhYmxl
X25vYXRvbWljKCZjcnRjLT5iYXNlLCBjdHgpOwo+ICAgCj4gLQlpZiAoY3J0Y19zdGF0ZS0+YmFz
ZS5hY3RpdmUgfHwgSEFTX0dNQ0goZGV2X3ByaXYpKSB7Cj4gKwlpZiAoY3J0Y19zdGF0ZS0+YmFz
ZS5hY3RpdmUgfHwgSEFTX0dNQ0goaTkxNSkpIHsKPiAgIAkJLyoKPiAgIAkJICogV2Ugc3RhcnQg
b3V0IHdpdGggdW5kZXJydW4gcmVwb3J0aW5nIGRpc2FibGVkIHRvIGF2b2lkIHJhY2VzLgo+ICAg
CQkgKiBGb3IgY29ycmVjdCBib29ra2VlcGluZyBtYXJrIHRoaXMgb24gYWN0aXZlIGNydGNzLgo+
IEBAIC0xNjI5MCwxNCArMTYyOTAsMTQgQEAgc3RhdGljIHZvaWQgaW50ZWxfc2FuaXRpemVfY3J0
YyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAkJICogUENIIHRyYW5zY29kZXJzIEIgYW5k
IEMgd291bGQgcHJldmVudCBlbmFibGluZyB0aGUgc291dGgKPiAgIAkJICogZXJyb3IgaW50ZXJy
dXB0IChzZWUgY3B0X2Nhbl9lbmFibGVfc2Vycl9pbnQoKSkuCj4gICAJCSAqLwo+IC0JCWlmICho
YXNfcGNoX3RyYW5jb2RlcihkZXZfcHJpdiwgY3J0Yy0+cGlwZSkpCj4gKwkJaWYgKGhhc19wY2hf
dHJhbmNvZGVyKGk5MTUsIGNydGMtPnBpcGUpKQo+ICAgCQkJY3J0Yy0+cGNoX2ZpZm9fdW5kZXJy
dW5fZGlzYWJsZWQgPSB0cnVlOwo+ICAgCX0KPiAgIH0KPiAgIAo+ICAgc3RhdGljIGJvb2wgaGFz
X2JvZ3VzX2RwbGxfY29uZmlnKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICAgCj4gICAJ
LyoKPiAgIAkgKiBTb21lIFNOQiBCSU9TZW4gKGVnLiBBU1VTIEs1M1NWKSBhcmUga25vd24gdG8g
bWlzcHJvZ3JhbQo+IEBAIC0xNjMwOSw3ICsxNjMwOSw3IEBAIHN0YXRpYyBib29sIGhhc19ib2d1
c19kcGxsX2NvbmZpZyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkK
PiAgIAkgKiB3aXRob3V0IHNldmVyYWwgV0FSTnMsIGJ1dCBmb3Igbm93IGxldCdzIHRha2UgdGhl
IGVhc3kKPiAgIAkgKiByb2FkLgo+ICAgCSAqLwo+IC0JcmV0dXJuIElTX0dFTihkZXZfcHJpdiwg
NikgJiYKPiArCXJldHVybiBJU19HRU4oaTkxNSwgNikgJiYKPiAgIAkJY3J0Y19zdGF0ZS0+YmFz
ZS5hY3RpdmUgJiYKPiAgIAkJY3J0Y19zdGF0ZS0+c2hhcmVkX2RwbGwgJiYKPiAgIAkJY3J0Y19z
dGF0ZS0+cG9ydF9jbG9jayA9PSAwOwo+IEBAIC0xNjMxNyw3ICsxNjMxNyw3IEBAIHN0YXRpYyBi
b29sIGhhc19ib2d1c19kcGxsX2NvbmZpZyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSkKPiAgIAo+ICAgc3RhdGljIHZvaWQgaW50ZWxfc2FuaXRpemVfZW5jb2Rlcihz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAg
IAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3I7Cj4gICAJc3RydWN0IGludGVsX2Ny
dGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGVuY29kZXItPmJhc2UuY3J0Yyk7Cj4gICAJc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUgPSBjcnRjID8KPiBAQCAtMTYzNzgsMjEgKzE2
Mzc4LDIxIEBAIHN0YXRpYyB2b2lkIGludGVsX3Nhbml0aXplX2VuY29kZXIoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIpCj4gICAJLyogbm90aWZ5IG9wcmVnaW9uIG9mIHRoZSBzYW5pdGl6
ZWQgZW5jb2RlciBzdGF0ZSAqLwo+ICAgCWludGVsX29wcmVnaW9uX25vdGlmeV9lbmNvZGVyKGVu
Y29kZXIsIGNvbm5lY3RvciAmJiBoYXNfYWN0aXZlX2NydGMpOwo+ICAgCj4gLQlpZiAoSU5URUxf
R0VOKGRldl9wcml2KSA+PSAxMSkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpCj4gICAJ
CWljbF9zYW5pdGl6ZV9lbmNvZGVyX3BsbF9tYXBwaW5nKGVuY29kZXIpOwo+ICAgfQo+ICAgCj4g
LXZvaWQgaTkxNV9yZWRpc2FibGVfdmdhX3Bvd2VyX29uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiArdm9pZCBpOTE1X3JlZGlzYWJsZV92Z2FfcG93ZXJfb24oc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlpOTE1X3JlZ190IHZnYV9yZWcgPSBpOTE1
X3ZnYWNudHJsX3JlZyhkZXZfcHJpdik7Cj4gKwlpOTE1X3JlZ190IHZnYV9yZWcgPSBpOTE1X3Zn
YWNudHJsX3JlZyhpOTE1KTsKPiAgIAo+ICAgCWlmICghKEk5MTVfUkVBRCh2Z2FfcmVnKSAmIFZH
QV9ESVNQX0RJU0FCTEUpKSB7Cj4gICAJCURSTV9ERUJVR19LTVMoIlNvbWV0aGluZyBlbmFibGVk
IFZHQSBwbGFuZSwgZGlzYWJsaW5nIGl0XG4iKTsKPiAtCQlpOTE1X2Rpc2FibGVfdmdhKGRldl9w
cml2KTsKPiArCQlpOTE1X2Rpc2FibGVfdmdhKGk5MTUpOwo+ICAgCX0KPiAgIH0KPiAgIAo+IC12
b2lkIGk5MTVfcmVkaXNhYmxlX3ZnYShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gK3ZvaWQgaTkxNV9yZWRpc2FibGVfdmdhKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ICAgewo+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICAgCj4gQEAgLTE2NDA1LDIz
ICsxNjQwNSwyMyBAQCB2b2lkIGk5MTVfcmVkaXNhYmxlX3ZnYShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gICAJICogZm9sbG93IHRoZSAiZG9uJ3QgdG91Y2ggdGhlIHBvd2Vy
IHdlbGwgaWYgd2UgZG9uJ3QgbmVlZCBpdCIgcG9saWN5Cj4gICAJICogdGhlIHJlc3Qgb2YgdGhl
IGRyaXZlciB1c2VzLgo+ICAgCSAqLwo+IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJf
Z2V0X2lmX2VuYWJsZWQoZGV2X3ByaXYsCj4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dl
cl9nZXRfaWZfZW5hYmxlZChpOTE1LAo+ICAgCQkJCQkJICAgICBQT1dFUl9ET01BSU5fVkdBKTsK
PiAgIAlpZiAoIXdha2VyZWYpCj4gICAJCXJldHVybjsKPiAgIAo+IC0JaTkxNV9yZWRpc2FibGVf
dmdhX3Bvd2VyX29uKGRldl9wcml2KTsKPiArCWk5MTVfcmVkaXNhYmxlX3ZnYV9wb3dlcl9vbihp
OTE1KTsKPiAgIAo+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIFBPV0VSX0RP
TUFJTl9WR0EsIHdha2VyZWYpOwo+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgUE9X
RVJfRE9NQUlOX1ZHQSwgd2FrZXJlZik7Cj4gICB9Cj4gICAKPiAgIC8qIEZJWE1FIHJlYWQgb3V0
IGZ1bGwgcGxhbmUgc3RhdGUgZm9yIGFsbCBwbGFuZXMgKi8KPiAtc3RhdGljIHZvaWQgcmVhZG91
dF9wbGFuZV9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRp
YyB2b2lkIHJlYWRvdXRfcGxhbmVfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gICB7Cj4gICAJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZTsKPiAgIAlzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YzsKPiAgIAo+IC0JZm9yX2VhY2hfaW50ZWxfcGxhbmUoJmRldl9wcml2LT5kcm0s
IHBsYW5lKSB7Cj4gKwlmb3JfZWFjaF9pbnRlbF9wbGFuZSgmaTkxNS0+ZHJtLCBwbGFuZSkgewo+
ICAgCQlzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlID0KPiAgIAkJCXRvX2lu
dGVsX3BsYW5lX3N0YXRlKHBsYW5lLT5iYXNlLnN0YXRlKTsKPiAgIAkJc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGU7Cj4gQEAgLTE2NDMwLDcgKzE2NDMwLDcgQEAgc3RhdGljIHZv
aWQgcmVhZG91dF9wbGFuZV9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gICAKPiAgIAkJdmlzaWJsZSA9IHBsYW5lLT5nZXRfaHdfc3RhdGUocGxhbmUsICZwaXBlKTsK
PiAgIAo+IC0JCWNydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShkZXZfcHJpdiwgcGlwZSk7
Cj4gKwkJY3J0YyA9IGludGVsX2dldF9jcnRjX2Zvcl9waXBlKGk5MTUsIHBpcGUpOwo+ICAgCQlj
cnRjX3N0YXRlID0gdG9faW50ZWxfY3J0Y19zdGF0ZShjcnRjLT5iYXNlLnN0YXRlKTsKPiAgIAo+
ICAgCQlpbnRlbF9zZXRfcGxhbmVfdmlzaWJsZShjcnRjX3N0YXRlLCBwbGFuZV9zdGF0ZSwgdmlz
aWJsZSk7Cj4gQEAgLTE2NDQwLDcgKzE2NDQwLDcgQEAgc3RhdGljIHZvaWQgcmVhZG91dF9wbGFu
ZV9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCQkgICAgICBl
bmFibGVkZGlzYWJsZWQodmlzaWJsZSksIHBpcGVfbmFtZShwaXBlKSk7Cj4gICAJfQo+ICAgCj4g
LQlmb3JfZWFjaF9pbnRlbF9jcnRjKCZkZXZfcHJpdi0+ZHJtLCBjcnRjKSB7Cj4gKwlmb3JfZWFj
aF9pbnRlbF9jcnRjKCZpOTE1LT5kcm0sIGNydGMpIHsKPiAgIAkJc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUgPQo+ICAgCQkJdG9faW50ZWxfY3J0Y19zdGF0ZShjcnRjLT5iYXNl
LnN0YXRlKTsKPiAgIAo+IEBAIC0xNjQ1MCw3ICsxNjQ1MCw3IEBAIHN0YXRpYyB2b2lkIHJlYWRv
dXRfcGxhbmVfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCj4g
ICBzdGF0aWMgdm9pZCBpbnRlbF9tb2Rlc2V0X3JlYWRvdXRfaHdfc3RhdGUoc3RydWN0IGRybV9k
ZXZpY2UgKmRldikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShkZXYpOwo+ICAgCWVudW0gcGlwZSBwaXBlOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
Owo+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyOwo+IEBAIC0xNjQ1OCw3ICsxNjQ1
OCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX21vZGVzZXRfcmVhZG91dF9od19zdGF0ZShzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2KQo+ICAgCXN0cnVjdCBkcm1fY29ubmVjdG9yX2xpc3RfaXRlciBjb25u
X2l0ZXI7Cj4gICAJaW50IGk7Cj4gICAKPiAtCWRldl9wcml2LT5hY3RpdmVfY3J0Y3MgPSAwOwo+
ICsJaTkxNS0+YWN0aXZlX2NydGNzID0gMDsKPiAgIAo+ICAgCWZvcl9lYWNoX2ludGVsX2NydGMo
ZGV2LCBjcnRjKSB7Cj4gICAJCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlID0K
PiBAQCAtMTY0NjksMjUgKzE2NDY5LDI1IEBAIHN0YXRpYyB2b2lkIGludGVsX21vZGVzZXRfcmVh
ZG91dF9od19zdGF0ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAgCQlfX2RybV9hdG9taWNf
aGVscGVyX2NydGNfcmVzZXQoJmNydGMtPmJhc2UsICZjcnRjX3N0YXRlLT5iYXNlKTsKPiAgIAo+
ICAgCQljcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSA9IGNydGNfc3RhdGUtPmJhc2UuZW5hYmxlID0K
PiAtCQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X3BpcGVfY29uZmlnKGNydGMsIGNydGNfc3RhdGUp
Owo+ICsJCQlpOTE1LT5kaXNwbGF5LmdldF9waXBlX2NvbmZpZyhjcnRjLCBjcnRjX3N0YXRlKTsK
PiAgIAo+ICAgCQljcnRjLT5iYXNlLmVuYWJsZWQgPSBjcnRjX3N0YXRlLT5iYXNlLmVuYWJsZTsK
PiAgIAkJY3J0Yy0+YWN0aXZlID0gY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmU7Cj4gICAKPiAgIAkJ
aWYgKGNydGNfc3RhdGUtPmJhc2UuYWN0aXZlKQo+IC0JCQlkZXZfcHJpdi0+YWN0aXZlX2NydGNz
IHw9IDEgPDwgY3J0Yy0+cGlwZTsKPiArCQkJaTkxNS0+YWN0aXZlX2NydGNzIHw9IDEgPDwgY3J0
Yy0+cGlwZTsKPiAgIAo+ICAgCQlEUk1fREVCVUdfS01TKCJbQ1JUQzolZDolc10gaHcgc3RhdGUg
cmVhZG91dDogJXNcbiIsCj4gICAJCQkgICAgICBjcnRjLT5iYXNlLmJhc2UuaWQsIGNydGMtPmJh
c2UubmFtZSwKPiAgIAkJCSAgICAgIGVuYWJsZWRkaXNhYmxlZChjcnRjX3N0YXRlLT5iYXNlLmFj
dGl2ZSkpOwo+ICAgCX0KPiAgIAo+IC0JcmVhZG91dF9wbGFuZV9zdGF0ZShkZXZfcHJpdik7Cj4g
KwlyZWFkb3V0X3BsYW5lX3N0YXRlKGk5MTUpOwo+ICAgCj4gLQlmb3IgKGkgPSAwOyBpIDwgZGV2
X3ByaXYtPm51bV9zaGFyZWRfZHBsbDsgaSsrKSB7Cj4gLQkJc3RydWN0IGludGVsX3NoYXJlZF9k
cGxsICpwbGwgPSAmZGV2X3ByaXYtPnNoYXJlZF9kcGxsc1tpXTsKPiArCWZvciAoaSA9IDA7IGkg
PCBpOTE1LT5udW1fc2hhcmVkX2RwbGw7IGkrKykgewo+ICsJCXN0cnVjdCBpbnRlbF9zaGFyZWRf
ZHBsbCAqcGxsID0gJmk5MTUtPnNoYXJlZF9kcGxsc1tpXTsKPiAgIAo+IC0JCXBsbC0+b24gPSBw
bGwtPmluZm8tPmZ1bmNzLT5nZXRfaHdfc3RhdGUoZGV2X3ByaXYsIHBsbCwKPiArCQlwbGwtPm9u
ID0gcGxsLT5pbmZvLT5mdW5jcy0+Z2V0X2h3X3N0YXRlKGk5MTUsIHBsbCwKPiAgIAkJCQkJCQkm
cGxsLT5zdGF0ZS5od19zdGF0ZSk7Cj4gICAJCXBsbC0+c3RhdGUuY3J0Y19tYXNrID0gMDsKPiAg
IAkJZm9yX2VhY2hfaW50ZWxfY3J0YyhkZXYsIGNydGMpIHsKPiBAQCAtMTY1MTAsNyArMTY1MTAs
NyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9tb2Rlc2V0X3JlYWRvdXRfaHdfc3RhdGUoc3RydWN0IGRy
bV9kZXZpY2UgKmRldikKPiAgIAkJaWYgKGVuY29kZXItPmdldF9od19zdGF0ZShlbmNvZGVyLCAm
cGlwZSkpIHsKPiAgIAkJCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlOwo+ICAg
Cj4gLQkJCWNydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShkZXZfcHJpdiwgcGlwZSk7Cj4g
KwkJCWNydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShpOTE1LCBwaXBlKTsKPiAgIAkJCWNy
dGNfc3RhdGUgPSB0b19pbnRlbF9jcnRjX3N0YXRlKGNydGMtPmJhc2Uuc3RhdGUpOwo+ICAgCj4g
ICAJCQllbmNvZGVyLT5iYXNlLmNydGMgPSAmY3J0Yy0+YmFzZTsKPiBAQCAtMTY1NTgsNyArMTY1
NTgsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9tb2Rlc2V0X3JlYWRvdXRfaHdfc3RhdGUoc3RydWN0
IGRybV9kZXZpY2UgKmRldikKPiAgIAo+ICAgCWZvcl9lYWNoX2ludGVsX2NydGMoZGV2LCBjcnRj
KSB7Cj4gICAJCXN0cnVjdCBpbnRlbF9id19zdGF0ZSAqYndfc3RhdGUgPQo+IC0JCQl0b19pbnRl
bF9id19zdGF0ZShkZXZfcHJpdi0+Yndfb2JqLnN0YXRlKTsKPiArCQkJdG9faW50ZWxfYndfc3Rh
dGUoaTkxNS0+Yndfb2JqLnN0YXRlKTsKPiAgIAkJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUgPQo+ICAgCQkJdG9faW50ZWxfY3J0Y19zdGF0ZShjcnRjLT5iYXNlLnN0YXRlKTsK
PiAgIAkJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZTsKPiBAQCAtMTY1ODUsNyArMTY1ODUsNyBA
QCBzdGF0aWMgdm9pZCBpbnRlbF9tb2Rlc2V0X3JlYWRvdXRfaHdfc3RhdGUoc3RydWN0IGRybV9k
ZXZpY2UgKmRldikKPiAgIAo+ICAgCQkJaW50ZWxfY3J0Y19jb21wdXRlX3BpeGVsX3JhdGUoY3J0
Y19zdGF0ZSk7Cj4gICAKPiAtCQkJaWYgKGRldl9wcml2LT5kaXNwbGF5Lm1vZGVzZXRfY2FsY19j
ZGNsaykgewo+ICsJCQlpZiAoaTkxNS0+ZGlzcGxheS5tb2Rlc2V0X2NhbGNfY2RjbGspIHsKPiAg
IAkJCQltaW5fY2RjbGsgPSBpbnRlbF9jcnRjX2NvbXB1dGVfbWluX2NkY2xrKGNydGNfc3RhdGUp
Owo+ICAgCQkJCWlmIChXQVJOX09OKG1pbl9jZGNsayA8IDApKQo+ICAgCQkJCQltaW5fY2RjbGsg
PSAwOwo+IEBAIC0xNjU5NiwxMSArMTY1OTYsMTEgQEAgc3RhdGljIHZvaWQgaW50ZWxfbW9kZXNl
dF9yZWFkb3V0X2h3X3N0YXRlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gICAJCQl1cGRhdGVf
c2NhbmxpbmVfb2Zmc2V0KGNydGNfc3RhdGUpOwo+ICAgCQl9Cj4gICAKPiAtCQlkZXZfcHJpdi0+
bWluX2NkY2xrW2NydGMtPnBpcGVdID0gbWluX2NkY2xrOwo+IC0JCWRldl9wcml2LT5taW5fdm9s
dGFnZV9sZXZlbFtjcnRjLT5waXBlXSA9Cj4gKwkJaTkxNS0+bWluX2NkY2xrW2NydGMtPnBpcGVd
ID0gbWluX2NkY2xrOwo+ICsJCWk5MTUtPm1pbl92b2x0YWdlX2xldmVsW2NydGMtPnBpcGVdID0K
PiAgIAkJCWNydGNfc3RhdGUtPm1pbl92b2x0YWdlX2xldmVsOwo+ICAgCj4gLQkJZm9yX2VhY2hf
aW50ZWxfcGxhbmVfb25fY3J0YygmZGV2X3ByaXYtPmRybSwgY3J0YywgcGxhbmUpIHsKPiArCQlm
b3JfZWFjaF9pbnRlbF9wbGFuZV9vbl9jcnRjKCZpOTE1LT5kcm0sIGNydGMsIHBsYW5lKSB7Cj4g
ICAJCQljb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlID0KPiAgIAkJ
CQl0b19pbnRlbF9wbGFuZV9zdGF0ZShwbGFuZS0+YmFzZS5zdGF0ZSk7Cj4gICAKPiBAQCAtMTY2
MTUsMTYgKzE2NjE1LDE2IEBAIHN0YXRpYyB2b2lkIGludGVsX21vZGVzZXRfcmVhZG91dF9od19z
dGF0ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAgCj4gICAJCWludGVsX2J3X2NydGNfdXBk
YXRlKGJ3X3N0YXRlLCBjcnRjX3N0YXRlKTsKPiAgIAo+IC0JCWludGVsX3BpcGVfY29uZmlnX3Nh
bml0eV9jaGVjayhkZXZfcHJpdiwgY3J0Y19zdGF0ZSk7Cj4gKwkJaW50ZWxfcGlwZV9jb25maWdf
c2FuaXR5X2NoZWNrKGk5MTUsIGNydGNfc3RhdGUpOwo+ICAgCX0KPiAgIH0KPiAgIAo+ICAgc3Rh
dGljIHZvaWQKPiAtZ2V0X2VuY29kZXJfcG93ZXJfZG9tYWlucyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gK2dldF9lbmNvZGVyX3Bvd2VyX2RvbWFpbnMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXI7Cj4gICAKPiAtCWZvcl9lYWNoX2ludGVsX2VuY29kZXIoJmRldl9wcml2LT5kcm0sIGVuY29k
ZXIpIHsKPiArCWZvcl9lYWNoX2ludGVsX2VuY29kZXIoJmk5MTUtPmRybSwgZW5jb2Rlcikgewo+
ICAgCQlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZTsKPiAgIAo+ICAgCQlpZiAo
IWVuY29kZXItPmdldF9wb3dlcl9kb21haW5zKQo+IEBAIC0xNjY0MiwxNCArMTY2NDIsMTQgQEAg
Z2V0X2VuY29kZXJfcG93ZXJfZG9tYWlucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gICAJfQo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGludGVsX2Vhcmx5X2Rpc3BsYXlf
d2FzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaW50
ZWxfZWFybHlfZGlzcGxheV93YXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7
Cj4gICAJLyogRGlzcGxheSBXQSAjMTE4NSBXYURpc2FibGVEQVJCRkNsa0dhdGluZzpjbmwsZ2xr
ICovCj4gLQlpZiAoSVNfQ0FOTk9OTEFLRShkZXZfcHJpdikgfHwgSVNfR0VNSU5JTEFLRShkZXZf
cHJpdikpCj4gKwlpZiAoSVNfQ0FOTk9OTEFLRShpOTE1KSB8fCBJU19HRU1JTklMQUtFKGk5MTUp
KQo+ICAgCQlJOTE1X1dSSVRFKEdFTjlfQ0xLR0FURV9ESVNfMCwgSTkxNV9SRUFEKEdFTjlfQ0xL
R0FURV9ESVNfMCkgfAo+ICAgCQkJICAgREFSQkZfR0FUSU5HX0RJUyk7Cj4gICAKPiAtCWlmIChJ
U19IQVNXRUxMKGRldl9wcml2KSkgewo+ICsJaWYgKElTX0hBU1dFTEwoaTkxNSkpIHsKPiAgIAkJ
LyoKPiAgIAkJICogV2FSc1BrZ0NTdGF0ZURpc3BsYXlQTVJlcTpoc3cKPiAgIAkJICogU3lzdGVt
IGhhbmcgaWYgdGhpcyBpc24ndCBkb25lIGJlZm9yZSBkaXNhYmxpbmcgYWxsIHBsYW5lcyEKPiBA
QCAtMTY2NTksNyArMTY2NTksNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9lYXJseV9kaXNwbGF5X3dh
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJfQo+ICAgfQo+ICAgCj4g
LXN0YXRpYyB2b2lkIGlieF9zYW5pdGl6ZV9wY2hfaGRtaV9wb3J0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgaWJ4X3Nhbml0aXplX3BjaF9oZG1pX3Bv
cnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgICAgIGVudW0gcG9y
dCBwb3J0LCBpOTE1X3JlZ190IGhkbWlfcmVnKQo+ICAgewo+ICAgCXUzMiB2YWwgPSBJOTE1X1JF
QUQoaGRtaV9yZWcpOwo+IEBAIC0xNjY3Nyw3ICsxNjY3Nyw3IEBAIHN0YXRpYyB2b2lkIGlieF9z
YW5pdGl6ZV9wY2hfaGRtaV9wb3J0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiAgIAlJOTE1X1dSSVRFKGhkbWlfcmVnLCB2YWwpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lk
IGlieF9zYW5pdGl6ZV9wY2hfZHBfcG9ydChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gK3N0YXRpYyB2b2lkIGlieF9zYW5pdGl6ZV9wY2hfZHBfcG9ydChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAgIGVudW0gcG9ydCBwb3J0LCBpOTE1X3JlZ190
IGRwX3JlZykKPiAgIHsKPiAgIAl1MzIgdmFsID0gSTkxNV9SRUFEKGRwX3JlZyk7Cj4gQEAgLTE2
Njk1LDcgKzE2Njk1LDcgQEAgc3RhdGljIHZvaWQgaWJ4X3Nhbml0aXplX3BjaF9kcF9wb3J0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlJOTE1X1dSSVRFKGRwX3JlZywg
dmFsKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpYnhfc2FuaXRpemVfcGNoX3BvcnRzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaWJ4X3Nhbml0
aXplX3BjaF9wb3J0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAkv
Kgo+ICAgCSAqIFRoZSBCSU9TIG1heSBzZWxlY3QgdHJhbnNjb2RlciBCIG9uIHNvbWUgb2YgdGhl
IFBDSAo+IEBAIC0xNjcwOCwxNCArMTY3MDgsMTQgQEAgc3RhdGljIHZvaWQgaWJ4X3Nhbml0aXpl
X3BjaF9wb3J0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICogKHNl
ZS4gaW50ZWxfZHBfbGlua19kb3duKCksIGludGVsX2Rpc2FibGVfaGRtaSgpLAo+ICAgCSAqIGlu
dGVsX2Rpc2FibGVfc2R2bygpKS4KPiAgIAkgKi8KPiAtCWlieF9zYW5pdGl6ZV9wY2hfZHBfcG9y
dChkZXZfcHJpdiwgUE9SVF9CLCBQQ0hfRFBfQik7Cj4gLQlpYnhfc2FuaXRpemVfcGNoX2RwX3Bv
cnQoZGV2X3ByaXYsIFBPUlRfQywgUENIX0RQX0MpOwo+IC0JaWJ4X3Nhbml0aXplX3BjaF9kcF9w
b3J0KGRldl9wcml2LCBQT1JUX0QsIFBDSF9EUF9EKTsKPiArCWlieF9zYW5pdGl6ZV9wY2hfZHBf
cG9ydChpOTE1LCBQT1JUX0IsIFBDSF9EUF9CKTsKPiArCWlieF9zYW5pdGl6ZV9wY2hfZHBfcG9y
dChpOTE1LCBQT1JUX0MsIFBDSF9EUF9DKTsKPiArCWlieF9zYW5pdGl6ZV9wY2hfZHBfcG9ydChp
OTE1LCBQT1JUX0QsIFBDSF9EUF9EKTsKPiAgIAo+ICAgCS8qIFBDSCBTRFZPQiBtdWx0aXBsZXgg
d2l0aCBIRE1JQiAqLwo+IC0JaWJ4X3Nhbml0aXplX3BjaF9oZG1pX3BvcnQoZGV2X3ByaXYsIFBP
UlRfQiwgUENIX0hETUlCKTsKPiAtCWlieF9zYW5pdGl6ZV9wY2hfaGRtaV9wb3J0KGRldl9wcml2
LCBQT1JUX0MsIFBDSF9IRE1JQyk7Cj4gLQlpYnhfc2FuaXRpemVfcGNoX2hkbWlfcG9ydChkZXZf
cHJpdiwgUE9SVF9ELCBQQ0hfSERNSUQpOwo+ICsJaWJ4X3Nhbml0aXplX3BjaF9oZG1pX3BvcnQo
aTkxNSwgUE9SVF9CLCBQQ0hfSERNSUIpOwo+ICsJaWJ4X3Nhbml0aXplX3BjaF9oZG1pX3BvcnQo
aTkxNSwgUE9SVF9DLCBQQ0hfSERNSUMpOwo+ICsJaWJ4X3Nhbml0aXplX3BjaF9oZG1pX3BvcnQo
aTkxNSwgUE9SVF9ELCBQQ0hfSERNSUQpOwo+ICAgfQo+ICAgCj4gICAvKiBTY2FuIG91dCB0aGUg
Y3VycmVudCBodyBtb2Rlc2V0IHN0YXRlLAo+IEBAIC0xNjcyNSwyOSArMTY3MjUsMjkgQEAgc3Rh
dGljIHZvaWQKPiAgIGludGVsX21vZGVzZXRfc2V0dXBfaHdfc3RhdGUoc3RydWN0IGRybV9kZXZp
Y2UgKmRldiwKPiAgIAkJCSAgICAgc3RydWN0IGRybV9tb2Rlc2V0X2FjcXVpcmVfY3R4ICpjdHgp
Cj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRl
dik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAg
IAlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZTsKPiAgIAlzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlcjsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsKPiAgIAlpbnRl
bF93YWtlcmVmX3Qgd2FrZXJlZjsKPiAgIAlpbnQgaTsKPiAgIAo+IC0Jd2FrZXJlZiA9IGludGVs
X2Rpc3BsYXlfcG93ZXJfZ2V0KGRldl9wcml2LCBQT1dFUl9ET01BSU5fSU5JVCk7Cj4gKwl3YWtl
cmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoaTkxNSwgUE9XRVJfRE9NQUlOX0lOSVQpOwo+
ICAgCj4gLQlpbnRlbF9lYXJseV9kaXNwbGF5X3dhcyhkZXZfcHJpdik7Cj4gKwlpbnRlbF9lYXJs
eV9kaXNwbGF5X3dhcyhpOTE1KTsKPiAgIAlpbnRlbF9tb2Rlc2V0X3JlYWRvdXRfaHdfc3RhdGUo
ZGV2KTsKPiAgIAo+ICAgCS8qIEhXIHN0YXRlIGlzIHJlYWQgb3V0LCBub3cgd2UgbmVlZCB0byBz
YW5pdGl6ZSB0aGlzIG1lc3MuICovCj4gLQlnZXRfZW5jb2Rlcl9wb3dlcl9kb21haW5zKGRldl9w
cml2KTsKPiArCWdldF9lbmNvZGVyX3Bvd2VyX2RvbWFpbnMoaTkxNSk7Cj4gICAKPiAtCWlmIChI
QVNfUENIX0lCWChkZXZfcHJpdikpCj4gLQkJaWJ4X3Nhbml0aXplX3BjaF9wb3J0cyhkZXZfcHJp
dik7Cj4gKwlpZiAoSEFTX1BDSF9JQlgoaTkxNSkpCj4gKwkJaWJ4X3Nhbml0aXplX3BjaF9wb3J0
cyhpOTE1KTsKPiAgIAo+ICAgCS8qCj4gICAJICogaW50ZWxfc2FuaXRpemVfcGxhbmVfbWFwcGlu
ZygpIG1heSBuZWVkIHRvIGRvIHZibGFuawo+ICAgCSAqIHdhaXRzLCBzbyB3ZSBuZWVkIHZibGFu
ayBpbnRlcnJ1cHRzIHJlc3RvcmVkIGJlZm9yZWhhbmQuCj4gICAJICovCj4gLQlmb3JfZWFjaF9p
bnRlbF9jcnRjKCZkZXZfcHJpdi0+ZHJtLCBjcnRjKSB7Cj4gKwlmb3JfZWFjaF9pbnRlbF9jcnRj
KCZpOTE1LT5kcm0sIGNydGMpIHsKPiAgIAkJY3J0Y19zdGF0ZSA9IHRvX2ludGVsX2NydGNfc3Rh
dGUoY3J0Yy0+YmFzZS5zdGF0ZSk7Cj4gICAKPiAgIAkJZHJtX2NydGNfdmJsYW5rX3Jlc2V0KCZj
cnRjLT5iYXNlKTsKPiBAQCAtMTY3NTYsMTIgKzE2NzU2LDEyIEBAIGludGVsX21vZGVzZXRfc2V0
dXBfaHdfc3RhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiAgIAkJCWludGVsX2NydGNfdmJs
YW5rX29uKGNydGNfc3RhdGUpOwo+ICAgCX0KPiAgIAo+IC0JaW50ZWxfc2FuaXRpemVfcGxhbmVf
bWFwcGluZyhkZXZfcHJpdik7Cj4gKwlpbnRlbF9zYW5pdGl6ZV9wbGFuZV9tYXBwaW5nKGk5MTUp
Owo+ICAgCj4gICAJZm9yX2VhY2hfaW50ZWxfZW5jb2RlcihkZXYsIGVuY29kZXIpCj4gICAJCWlu
dGVsX3Nhbml0aXplX2VuY29kZXIoZW5jb2Rlcik7Cj4gICAKPiAtCWZvcl9lYWNoX2ludGVsX2Ny
dGMoJmRldl9wcml2LT5kcm0sIGNydGMpIHsKPiArCWZvcl9lYWNoX2ludGVsX2NydGMoJmk5MTUt
PmRybSwgY3J0Yykgewo+ICAgCQljcnRjX3N0YXRlID0gdG9faW50ZWxfY3J0Y19zdGF0ZShjcnRj
LT5iYXNlLnN0YXRlKTsKPiAgIAkJaW50ZWxfc2FuaXRpemVfY3J0YyhjcnRjLCBjdHgpOwo+ICAg
CQlpbnRlbF9kdW1wX3BpcGVfY29uZmlnKGNydGNfc3RhdGUsIE5VTEwsICJbc2V0dXBfaHdfc3Rh
dGVdIik7Cj4gQEAgLTE2NzY5LDggKzE2NzY5LDggQEAgaW50ZWxfbW9kZXNldF9zZXR1cF9od19z
dGF0ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ICAgCj4gICAJaW50ZWxfbW9kZXNldF91cGRh
dGVfY29ubmVjdG9yX2F0b21pY19zdGF0ZShkZXYpOwo+ICAgCj4gLQlmb3IgKGkgPSAwOyBpIDwg
ZGV2X3ByaXYtPm51bV9zaGFyZWRfZHBsbDsgaSsrKSB7Cj4gLQkJc3RydWN0IGludGVsX3NoYXJl
ZF9kcGxsICpwbGwgPSAmZGV2X3ByaXYtPnNoYXJlZF9kcGxsc1tpXTsKPiArCWZvciAoaSA9IDA7
IGkgPCBpOTE1LT5udW1fc2hhcmVkX2RwbGw7IGkrKykgewo+ICsJCXN0cnVjdCBpbnRlbF9zaGFy
ZWRfZHBsbCAqcGxsID0gJmk5MTUtPnNoYXJlZF9kcGxsc1tpXTsKPiAgIAo+ICAgCQlpZiAoIXBs
bC0+b24gfHwgcGxsLT5hY3RpdmVfbWFzaykKPiAgIAkJCWNvbnRpbnVlOwo+IEBAIC0xNjc3OCwy
MCArMTY3NzgsMjAgQEAgaW50ZWxfbW9kZXNldF9zZXR1cF9od19zdGF0ZShzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LAo+ICAgCQlEUk1fREVCVUdfS01TKCIlcyBlbmFibGVkIGJ1dCBub3QgaW4gdXNl
LCBkaXNhYmxpbmdcbiIsCj4gICAJCQkgICAgICBwbGwtPmluZm8tPm5hbWUpOwo+ICAgCj4gLQkJ
cGxsLT5pbmZvLT5mdW5jcy0+ZGlzYWJsZShkZXZfcHJpdiwgcGxsKTsKPiArCQlwbGwtPmluZm8t
PmZ1bmNzLT5kaXNhYmxlKGk5MTUsIHBsbCk7Cj4gICAJCXBsbC0+b24gPSBmYWxzZTsKPiAgIAl9
Cj4gICAKPiAtCWlmIChJU19HNFgoZGV2X3ByaXYpKSB7Cj4gLQkJZzR4X3dtX2dldF9od19zdGF0
ZShkZXZfcHJpdik7Cj4gLQkJZzR4X3dtX3Nhbml0aXplKGRldl9wcml2KTsKPiAtCX0gZWxzZSBp
ZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsK
PiAtCQl2bHZfd21fZ2V0X2h3X3N0YXRlKGRldl9wcml2KTsKPiAtCQl2bHZfd21fc2FuaXRpemUo
ZGV2X3ByaXYpOwo+IC0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpIHsKPiAt
CQlza2xfd21fZ2V0X2h3X3N0YXRlKGRldl9wcml2KTsKPiAtCX0gZWxzZSBpZiAoSEFTX1BDSF9T
UExJVChkZXZfcHJpdikpIHsKPiAtCQlpbGtfd21fZ2V0X2h3X3N0YXRlKGRldl9wcml2KTsKPiAr
CWlmIChJU19HNFgoaTkxNSkpIHsKPiArCQlnNHhfd21fZ2V0X2h3X3N0YXRlKGk5MTUpOwo+ICsJ
CWc0eF93bV9zYW5pdGl6ZShpOTE1KTsKPiArCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1
KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gKwkJdmx2X3dtX2dldF9od19zdGF0ZShpOTE1
KTsKPiArCQl2bHZfd21fc2FuaXRpemUoaTkxNSk7Cj4gKwl9IGVsc2UgaWYgKElOVEVMX0dFTihp
OTE1KSA+PSA5KSB7Cj4gKwkJc2tsX3dtX2dldF9od19zdGF0ZShpOTE1KTsKPiArCX0gZWxzZSBp
ZiAoSEFTX1BDSF9TUExJVChpOTE1KSkgewo+ICsJCWlsa193bV9nZXRfaHdfc3RhdGUoaTkxNSk7
Cj4gICAJfQo+ICAgCj4gICAJZm9yX2VhY2hfaW50ZWxfY3J0YyhkZXYsIGNydGMpIHsKPiBAQCAt
MTY4MDAsMjIgKzE2ODAwLDIyIEBAIGludGVsX21vZGVzZXRfc2V0dXBfaHdfc3RhdGUoc3RydWN0
IGRybV9kZXZpY2UgKmRldiwKPiAgIAkJY3J0Y19zdGF0ZSA9IHRvX2ludGVsX2NydGNfc3RhdGUo
Y3J0Yy0+YmFzZS5zdGF0ZSk7Cj4gICAJCXB1dF9kb21haW5zID0gbW9kZXNldF9nZXRfY3J0Y19w
b3dlcl9kb21haW5zKCZjcnRjLT5iYXNlLCBjcnRjX3N0YXRlKTsKPiAgIAkJaWYgKFdBUk5fT04o
cHV0X2RvbWFpbnMpKQo+IC0JCQltb2Rlc2V0X3B1dF9wb3dlcl9kb21haW5zKGRldl9wcml2LCBw
dXRfZG9tYWlucyk7Cj4gKwkJCW1vZGVzZXRfcHV0X3Bvd2VyX2RvbWFpbnMoaTkxNSwgcHV0X2Rv
bWFpbnMpOwo+ICAgCX0KPiAgIAo+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYs
IFBPV0VSX0RPTUFJTl9JTklULCB3YWtlcmVmKTsKPiArCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0
KGk5MTUsIFBPV0VSX0RPTUFJTl9JTklULCB3YWtlcmVmKTsKPiAgIAo+IC0JaW50ZWxfZmJjX2lu
aXRfcGlwZV9zdGF0ZShkZXZfcHJpdik7Cj4gKwlpbnRlbF9mYmNfaW5pdF9waXBlX3N0YXRlKGk5
MTUpOwo+ICAgfQo+ICAgCj4gICB2b2lkIGludGVsX2Rpc3BsYXlfcmVzdW1lKHN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGRldik7Cj4gLQlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUgPSBkZXZf
cHJpdi0+bW9kZXNldF9yZXN0b3JlX3N0YXRlOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUg
PSBpOTE1LT5tb2Rlc2V0X3Jlc3RvcmVfc3RhdGU7Cj4gICAJc3RydWN0IGRybV9tb2Rlc2V0X2Fj
cXVpcmVfY3R4IGN0eDsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gLQlkZXZfcHJpdi0+bW9kZXNldF9y
ZXN0b3JlX3N0YXRlID0gTlVMTDsKPiArCWk5MTUtPm1vZGVzZXRfcmVzdG9yZV9zdGF0ZSA9IE5V
TEw7Cj4gICAJaWYgKHN0YXRlKQo+ICAgCQlzdGF0ZS0+YWNxdWlyZV9jdHggPSAmY3R4Owo+ICAg
Cj4gQEAgLTE2ODMyLDcgKzE2ODMyLDcgQEAgdm9pZCBpbnRlbF9kaXNwbGF5X3Jlc3VtZShzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAgCWlmICghcmV0KQo+ICAgCQlyZXQgPSBfX2ludGVsX2Rp
c3BsYXlfcmVzdW1lKGRldiwgc3RhdGUsICZjdHgpOwo+ICAgCj4gLQlpbnRlbF9lbmFibGVfaXBj
KGRldl9wcml2KTsKPiArCWludGVsX2VuYWJsZV9pcGMoaTkxNSk7Cj4gICAJZHJtX21vZGVzZXRf
ZHJvcF9sb2NrcygmY3R4KTsKPiAgIAlkcm1fbW9kZXNldF9hY3F1aXJlX2ZpbmkoJmN0eCk7Cj4g
ICAKPiBAQCAtMTY4NjIsMTkgKzE2ODYyLDE5IEBAIHN0YXRpYyB2b2lkIGludGVsX2hwZF9wb2xs
X2Zpbmkoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIAo+ICAgdm9pZCBpbnRlbF9tb2Rlc2V0
X2NsZWFudXAoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCj4gLQlmbHVzaF93b3JrcXVldWUoZGV2
X3ByaXYtPm1vZGVzZXRfd3EpOwo+ICsJZmx1c2hfd29ya3F1ZXVlKGk5MTUtPm1vZGVzZXRfd3Ep
Owo+ICAgCj4gLQlmbHVzaF93b3JrKCZkZXZfcHJpdi0+YXRvbWljX2hlbHBlci5mcmVlX3dvcmsp
Owo+IC0JV0FSTl9PTighbGxpc3RfZW1wdHkoJmRldl9wcml2LT5hdG9taWNfaGVscGVyLmZyZWVf
bGlzdCkpOwo+ICsJZmx1c2hfd29yaygmaTkxNS0+YXRvbWljX2hlbHBlci5mcmVlX3dvcmspOwo+
ICsJV0FSTl9PTighbGxpc3RfZW1wdHkoJmk5MTUtPmF0b21pY19oZWxwZXIuZnJlZV9saXN0KSk7
Cj4gICAKPiAgIAkvKgo+ICAgCSAqIEludGVycnVwdHMgYW5kIHBvbGxpbmcgYXMgdGhlIGZpcnN0
IHRoaW5nIHRvIGF2b2lkIGNyZWF0aW5nIGhhdm9jLgo+ICAgCSAqIFRvbyBtdWNoIHN0dWZmIGhl
cmUgKHR1cm5pbmcgb2YgY29ubmVjdG9ycywgLi4uKSB3b3VsZAo+ICAgCSAqIGV4cGVyaWVuY2Ug
ZmFuY3kgcmFjZXMgb3RoZXJ3aXNlLgo+ICAgCSAqLwo+IC0JaW50ZWxfaXJxX3VuaW5zdGFsbChk
ZXZfcHJpdik7Cj4gKwlpbnRlbF9pcnFfdW5pbnN0YWxsKGk5MTUpOwo+ICAgCj4gICAJLyoKPiAg
IAkgKiBEdWUgdG8gdGhlIGhwZCBpcnEgc3Rvcm0gaGFuZGxpbmcgdGhlIGhvdHBsdWcgd29yayBj
YW4gcmUtYXJtIHRoZQo+IEBAIC0xNjg4MywzNyArMTY4ODMsMzcgQEAgdm9pZCBpbnRlbF9tb2Rl
c2V0X2NsZWFudXAoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIAlpbnRlbF9ocGRfcG9sbF9m
aW5pKGRldik7Cj4gICAKPiAgIAkvKiBwb2xsIHdvcmsgY2FuIGNhbGwgaW50byBmYmRldiwgaGVu
Y2UgY2xlYW4gdGhhdCB1cCBhZnRlcndhcmRzICovCj4gLQlpbnRlbF9mYmRldl9maW5pKGRldl9w
cml2KTsKPiArCWludGVsX2ZiZGV2X2ZpbmkoaTkxNSk7Cj4gICAKPiAgIAlpbnRlbF91bnJlZ2lz
dGVyX2RzbV9oYW5kbGVyKCk7Cj4gICAKPiAtCWludGVsX2ZiY19nbG9iYWxfZGlzYWJsZShkZXZf
cHJpdik7Cj4gKwlpbnRlbF9mYmNfZ2xvYmFsX2Rpc2FibGUoaTkxNSk7Cj4gICAKPiAgIAkvKiBm
bHVzaCBhbnkgZGVsYXllZCB0YXNrcyBvciBwZW5kaW5nIHdvcmsgKi8KPiAgIAlmbHVzaF9zY2hl
ZHVsZWRfd29yaygpOwo+ICAgCj4gLQlpbnRlbF9oZGNwX2NvbXBvbmVudF9maW5pKGRldl9wcml2
KTsKPiArCWludGVsX2hkY3BfY29tcG9uZW50X2ZpbmkoaTkxNSk7Cj4gICAKPiAgIAlkcm1fbW9k
ZV9jb25maWdfY2xlYW51cChkZXYpOwo+ICAgCj4gLQlpbnRlbF9vdmVybGF5X2NsZWFudXAoZGV2
X3ByaXYpOwo+ICsJaW50ZWxfb3ZlcmxheV9jbGVhbnVwKGk5MTUpOwo+ICAgCj4gLQlpbnRlbF9n
bWJ1c190ZWFyZG93bihkZXZfcHJpdik7Cj4gKwlpbnRlbF9nbWJ1c190ZWFyZG93bihpOTE1KTsK
PiAgIAo+IC0JZGVzdHJveV93b3JrcXVldWUoZGV2X3ByaXYtPm1vZGVzZXRfd3EpOwo+ICsJZGVz
dHJveV93b3JrcXVldWUoaTkxNS0+bW9kZXNldF93cSk7Cj4gICAKPiAtCWludGVsX2ZiY19jbGVh
bnVwX2NmYihkZXZfcHJpdik7Cj4gKwlpbnRlbF9mYmNfY2xlYW51cF9jZmIoaTkxNSk7Cj4gICB9
Cj4gICAKPiAgIC8qCj4gICAgKiBzZXQgdmdhIGRlY29kZSBzdGF0ZSAtIHRydWUgPT0gZW5hYmxl
IFZHQSBkZWNvZGUKPiAgICAqLwo+IC1pbnQgaW50ZWxfbW9kZXNldF92Z2Ffc2V0X3N0YXRlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgYm9vbCBzdGF0ZSkKPiAraW50IGludGVs
X21vZGVzZXRfdmdhX3NldF9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgYm9v
bCBzdGF0ZSkKPiAgIHsKPiAtCXVuc2lnbmVkIHJlZyA9IElOVEVMX0dFTihkZXZfcHJpdikgPj0g
NiA/IFNOQl9HTUNIX0NUUkwgOiBJTlRFTF9HTUNIX0NUUkw7Cj4gKwl1bnNpZ25lZCByZWcgPSBJ
TlRFTF9HRU4oaTkxNSkgPj0gNiA/IFNOQl9HTUNIX0NUUkwgOiBJTlRFTF9HTUNIX0NUUkw7Cj4g
ICAJdTE2IGdtY2hfY3RybDsKPiAgIAo+IC0JaWYgKHBjaV9yZWFkX2NvbmZpZ193b3JkKGRldl9w
cml2LT5icmlkZ2VfZGV2LCByZWcsICZnbWNoX2N0cmwpKSB7Cj4gKwlpZiAocGNpX3JlYWRfY29u
ZmlnX3dvcmQoaTkxNS0+YnJpZGdlX2RldiwgcmVnLCAmZ21jaF9jdHJsKSkgewo+ICAgCQlEUk1f
RVJST1IoImZhaWxlZCB0byByZWFkIGNvbnRyb2wgd29yZFxuIik7Cj4gICAJCXJldHVybiAtRUlP
Owo+ICAgCX0KPiBAQCAtMTY5MjYsNyArMTY5MjYsNyBAQCBpbnQgaW50ZWxfbW9kZXNldF92Z2Ff
c2V0X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgYm9vbCBzdGF0ZSkK
PiAgIAllbHNlCj4gICAJCWdtY2hfY3RybCB8PSBJTlRFTF9HTUNIX1ZHQV9ESVNBQkxFOwo+ICAg
Cj4gLQlpZiAocGNpX3dyaXRlX2NvbmZpZ193b3JkKGRldl9wcml2LT5icmlkZ2VfZGV2LCByZWcs
IGdtY2hfY3RybCkpIHsKPiArCWlmIChwY2lfd3JpdGVfY29uZmlnX3dvcmQoaTkxNS0+YnJpZGdl
X2RldiwgcmVnLCBnbWNoX2N0cmwpKSB7Cj4gICAJCURSTV9FUlJPUigiZmFpbGVkIHRvIHdyaXRl
IGNvbnRyb2wgd29yZFxuIik7Cj4gICAJCXJldHVybiAtRUlPOwo+ICAgCX0KPiBAQCAtMTY5ODAs
NyArMTY5ODAsNyBAQCBzdHJ1Y3QgaW50ZWxfZGlzcGxheV9lcnJvcl9zdGF0ZSB7Cj4gICB9Owo+
ICAgCj4gICBzdHJ1Y3QgaW50ZWxfZGlzcGxheV9lcnJvcl9zdGF0ZSAqCj4gLWludGVsX2Rpc3Bs
YXlfY2FwdHVyZV9lcnJvcl9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gK2ludGVsX2Rpc3BsYXlfY2FwdHVyZV9lcnJvcl9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZGlzcGxheV9lcnJvcl9zdGF0ZSAq
ZXJyb3I7Cj4gICAJaW50IHRyYW5zY29kZXJzW10gPSB7Cj4gQEAgLTE2OTkzLDE5ICsxNjk5Mywx
OSBAQCBpbnRlbF9kaXNwbGF5X2NhcHR1cmVfZXJyb3Jfc3RhdGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ICAgCj4gICAJQlVJTERfQlVHX09OKEFSUkFZX1NJWkUodHJhbnNj
b2RlcnMpICE9IEFSUkFZX1NJWkUoZXJyb3ItPnRyYW5zY29kZXIpKTsKPiAgIAo+IC0JaWYgKCFI
QVNfRElTUExBWShkZXZfcHJpdikpCj4gKwlpZiAoIUhBU19ESVNQTEFZKGk5MTUpKQo+ICAgCQly
ZXR1cm4gTlVMTDsKPiAgIAo+ICAgCWVycm9yID0ga3phbGxvYyhzaXplb2YoKmVycm9yKSwgR0ZQ
X0FUT01JQyk7Cj4gICAJaWYgKGVycm9yID09IE5VTEwpCj4gICAJCXJldHVybiBOVUxMOwo+ICAg
Cj4gLQlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgfHwgSVNfQlJPQURXRUxMKGRldl9wcml2KSkK
PiArCWlmIChJU19IQVNXRUxMKGk5MTUpIHx8IElTX0JST0FEV0VMTChpOTE1KSkKPiAgIAkJZXJy
b3ItPnBvd2VyX3dlbGxfZHJpdmVyID0gSTkxNV9SRUFEKEhTV19QV1JfV0VMTF9DVEwyKTsKPiAg
IAo+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgaSkgewo+ICsJZm9yX2VhY2hfcGlwZShpOTE1
LCBpKSB7Cj4gICAJCWVycm9yLT5waXBlW2ldLnBvd2VyX2RvbWFpbl9vbiA9Cj4gLQkJCV9faW50
ZWxfZGlzcGxheV9wb3dlcl9pc19lbmFibGVkKGRldl9wcml2LAo+ICsJCQlfX2ludGVsX2Rpc3Bs
YXlfcG93ZXJfaXNfZW5hYmxlZChpOTE1LAo+ICAgCQkJCQkJCSBQT1dFUl9ET01BSU5fUElQRShp
KSk7Cj4gICAJCWlmICghZXJyb3ItPnBpcGVbaV0ucG93ZXJfZG9tYWluX29uKQo+ICAgCQkJY29u
dGludWU7Cj4gQEAgLTE3MDE2LDMyICsxNzAxNiwzMiBAQCBpbnRlbF9kaXNwbGF5X2NhcHR1cmVf
ZXJyb3Jfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCj4gICAJ
CWVycm9yLT5wbGFuZVtpXS5jb250cm9sID0gSTkxNV9SRUFEKERTUENOVFIoaSkpOwo+ICAgCQll
cnJvci0+cGxhbmVbaV0uc3RyaWRlID0gSTkxNV9SRUFEKERTUFNUUklERShpKSk7Cj4gLQkJaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPD0gMykgewo+ICsJCWlmIChJTlRFTF9HRU4oaTkxNSkgPD0g
Mykgewo+ICAgCQkJZXJyb3ItPnBsYW5lW2ldLnNpemUgPSBJOTE1X1JFQUQoRFNQU0laRShpKSk7
Cj4gICAJCQllcnJvci0+cGxhbmVbaV0ucG9zID0gSTkxNV9SRUFEKERTUFBPUyhpKSk7Cj4gICAJ
CX0KPiAtCQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8PSA3ICYmICFJU19IQVNXRUxMKGRldl9w
cml2KSkKPiArCQlpZiAoSU5URUxfR0VOKGk5MTUpIDw9IDcgJiYgIUlTX0hBU1dFTEwoaTkxNSkp
Cj4gICAJCQllcnJvci0+cGxhbmVbaV0uYWRkciA9IEk5MTVfUkVBRChEU1BBRERSKGkpKTsKPiAt
CQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA0KSB7Cj4gKwkJaWYgKElOVEVMX0dFTihpOTE1
KSA+PSA0KSB7Cj4gICAJCQllcnJvci0+cGxhbmVbaV0uc3VyZmFjZSA9IEk5MTVfUkVBRChEU1BT
VVJGKGkpKTsKPiAgIAkJCWVycm9yLT5wbGFuZVtpXS50aWxlX29mZnNldCA9IEk5MTVfUkVBRChE
U1BUSUxFT0ZGKGkpKTsKPiAgIAkJfQo+ICAgCj4gICAJCWVycm9yLT5waXBlW2ldLnNvdXJjZSA9
IEk5MTVfUkVBRChQSVBFU1JDKGkpKTsKPiAgIAo+IC0JCWlmIChIQVNfR01DSChkZXZfcHJpdikp
Cj4gKwkJaWYgKEhBU19HTUNIKGk5MTUpKQo+ICAgCQkJZXJyb3ItPnBpcGVbaV0uc3RhdCA9IEk5
MTVfUkVBRChQSVBFU1RBVChpKSk7Cj4gICAJfQo+ICAgCj4gICAJZm9yIChpID0gMDsgaSA8IEFS
UkFZX1NJWkUoZXJyb3ItPnRyYW5zY29kZXIpOyBpKyspIHsKPiAgIAkJZW51bSB0cmFuc2NvZGVy
IGNwdV90cmFuc2NvZGVyID0gdHJhbnNjb2RlcnNbaV07Cj4gICAKPiAtCQlpZiAoIUlOVEVMX0lO
Rk8oZGV2X3ByaXYpLT50cmFuc19vZmZzZXRzW2NwdV90cmFuc2NvZGVyXSkKPiArCQlpZiAoIUlO
VEVMX0lORk8oaTkxNSktPnRyYW5zX29mZnNldHNbY3B1X3RyYW5zY29kZXJdKQo+ICAgCQkJY29u
dGludWU7Cj4gICAKPiAgIAkJZXJyb3ItPnRyYW5zY29kZXJbaV0uYXZhaWxhYmxlID0gdHJ1ZTsK
PiAgIAkJZXJyb3ItPnRyYW5zY29kZXJbaV0ucG93ZXJfZG9tYWluX29uID0KPiAtCQkJX19pbnRl
bF9kaXNwbGF5X3Bvd2VyX2lzX2VuYWJsZWQoZGV2X3ByaXYsCj4gKwkJCV9faW50ZWxfZGlzcGxh
eV9wb3dlcl9pc19lbmFibGVkKGk5MTUsCj4gICAJCQkJUE9XRVJfRE9NQUlOX1RSQU5TQ09ERVIo
Y3B1X3RyYW5zY29kZXIpKTsKPiAgIAkJaWYgKCFlcnJvci0+dHJhbnNjb2RlcltpXS5wb3dlcl9k
b21haW5fb24pCj4gICAJCQljb250aW51ZTsKPiBAQCAtMTcwNjYsMTcgKzE3MDY2LDE3IEBAIHZv
aWQKPiAgIGludGVsX2Rpc3BsYXlfcHJpbnRfZXJyb3Jfc3RhdGUoc3RydWN0IGRybV9pOTE1X2Vy
cm9yX3N0YXRlX2J1ZiAqbSwKPiAgIAkJCQlzdHJ1Y3QgaW50ZWxfZGlzcGxheV9lcnJvcl9zdGF0
ZSAqZXJyb3IpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBt
LT5pOTE1Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBtLT5pOTE1Owo+ICAg
CWludCBpOwo+ICAgCj4gICAJaWYgKCFlcnJvcikKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQllcnJf
cHJpbnRmKG0sICJOdW0gUGlwZXM6ICVkXG4iLCBJTlRFTF9JTkZPKGRldl9wcml2KS0+bnVtX3Bp
cGVzKTsKPiAtCWlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8fCBJU19CUk9BRFdFTEwoZGV2X3By
aXYpKQo+ICsJZXJyX3ByaW50ZihtLCAiTnVtIFBpcGVzOiAlZFxuIiwgSU5URUxfSU5GTyhpOTE1
KS0+bnVtX3BpcGVzKTsKPiArCWlmIChJU19IQVNXRUxMKGk5MTUpIHx8IElTX0JST0FEV0VMTChp
OTE1KSkKPiAgIAkJZXJyX3ByaW50ZihtLCAiUFdSX1dFTExfQ1RMMjogJTA4eFxuIiwKPiAgIAkJ
CSAgIGVycm9yLT5wb3dlcl93ZWxsX2RyaXZlcik7Cj4gLQlmb3JfZWFjaF9waXBlKGRldl9wcml2
LCBpKSB7Cj4gKwlmb3JfZWFjaF9waXBlKGk5MTUsIGkpIHsKPiAgIAkJZXJyX3ByaW50ZihtLCAi
UGlwZSBbJWRdOlxuIiwgaSk7Cj4gICAJCWVycl9wcmludGYobSwgIiAgUG93ZXI6ICVzXG4iLAo+
ICAgCQkJICAgb25vZmYoZXJyb3ItPnBpcGVbaV0ucG93ZXJfZG9tYWluX29uKSk7Cj4gQEAgLTE3
MDg2LDEzICsxNzA4NiwxMyBAQCBpbnRlbF9kaXNwbGF5X3ByaW50X2Vycm9yX3N0YXRlKHN0cnVj
dCBkcm1faTkxNV9lcnJvcl9zdGF0ZV9idWYgKm0sCj4gICAJCWVycl9wcmludGYobSwgIlBsYW5l
IFslZF06XG4iLCBpKTsKPiAgIAkJZXJyX3ByaW50ZihtLCAiICBDTlRSOiAlMDh4XG4iLCBlcnJv
ci0+cGxhbmVbaV0uY29udHJvbCk7Cj4gICAJCWVycl9wcmludGYobSwgIiAgU1RSSURFOiAlMDh4
XG4iLCBlcnJvci0+cGxhbmVbaV0uc3RyaWRlKTsKPiAtCQlpZiAoSU5URUxfR0VOKGRldl9wcml2
KSA8PSAzKSB7Cj4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA8PSAzKSB7Cj4gICAJCQllcnJfcHJp
bnRmKG0sICIgIFNJWkU6ICUwOHhcbiIsIGVycm9yLT5wbGFuZVtpXS5zaXplKTsKPiAgIAkJCWVy
cl9wcmludGYobSwgIiAgUE9TOiAlMDh4XG4iLCBlcnJvci0+cGxhbmVbaV0ucG9zKTsKPiAgIAkJ
fQo+IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDcgJiYgIUlTX0hBU1dFTEwoZGV2X3By
aXYpKQo+ICsJCWlmIChJTlRFTF9HRU4oaTkxNSkgPD0gNyAmJiAhSVNfSEFTV0VMTChpOTE1KSkK
PiAgIAkJCWVycl9wcmludGYobSwgIiAgQUREUjogJTA4eFxuIiwgZXJyb3ItPnBsYW5lW2ldLmFk
ZHIpOwo+IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDQpIHsKPiArCQlpZiAoSU5URUxf
R0VOKGk5MTUpID49IDQpIHsKPiAgIAkJCWVycl9wcmludGYobSwgIiAgU1VSRjogJTA4eFxuIiwg
ZXJyb3ItPnBsYW5lW2ldLnN1cmZhY2UpOwo+ICAgCQkJZXJyX3ByaW50ZihtLCAiICBUSUxFT0ZG
OiAlMDh4XG4iLCBlcnJvci0+cGxhbmVbaV0udGlsZV9vZmZzZXQpOwo+ICAgCQl9Cj4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rpc3BsYXkuaCBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX2Rpc3BsYXkuaAo+IGluZGV4IGVlNmI4MTk0YTQ1OS4uN2U0YjRiMWMw
YWM2IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rpc3BsYXkuaAo+
ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rpc3BsYXkuaAo+IEBAIC0xMjUsNyAr
MTI1LDcgQEAgZW51bSBpOXh4X3BsYW5lX2lkIHsKPiAgIH07Cj4gICAKPiAgICNkZWZpbmUgcGxh
bmVfbmFtZShwKSAoKHApICsgJ0EnKQo+IC0jZGVmaW5lIHNwcml0ZV9uYW1lKHAsIHMpICgocCkg
KiBSVU5USU1FX0lORk8oZGV2X3ByaXYpLT5udW1fc3ByaXRlc1socCldICsgKHMpICsgJ0EnKQo+
ICsjZGVmaW5lIHNwcml0ZV9uYW1lKHAsIHMpICgocCkgKiBSVU5USU1FX0lORk8oaTkxNSktPm51
bV9zcHJpdGVzWyhwKV0gKyAocykgKyAnQScpCj4gICAKPiAgIC8qCj4gICAgKiBQZXItcGlwZSBw
bGFuZSBpZGVudGlmaWVyLgo+IEBAIC0zNTMsOCArMzUzLDggQEAgdm9pZCBpbnRlbF9saW5rX2Nv
bXB1dGVfbV9uKHUxNiBicHAsIGludCBubGFuZXMsCj4gICAJCQkgICAgc3RydWN0IGludGVsX2xp
bmtfbV9uICptX24sCj4gICAJCQkgICAgYm9vbCBjb25zdGFudF9uKTsKPiAgIGJvb2wgaXNfY2Nz
X21vZGlmaWVyKHU2NCBtb2RpZmllcik7Cj4gLXZvaWQgbHB0X2Rpc2FibGVfY2xrb3V0X2RwKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gLXUzMiBpbnRlbF9wbGFuZV9mYl9t
YXhfc3RyaWRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArdm9pZCBscHRf
ZGlzYWJsZV9jbGtvdXRfZHAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt1MzIg
aW50ZWxfcGxhbmVfZmJfbWF4X3N0cmlkZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
PiAgIAkJCSAgICAgIHUzMiBwaXhlbF9mb3JtYXQsIHU2NCBtb2RpZmllcik7Cj4gICBib29sIGlu
dGVsX3BsYW5lX2Nhbl9yZW1hcChjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5l
X3N0YXRlKTsKPiAgIAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9k
aXNwbGF5X3Bvd2VyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kaXNwbGF5X3Bvd2Vy
LmMKPiBpbmRleCBiYjllZjFjZWE1ZGIuLjlhY2ZhZDVjODNlZiAxMDA2NDQKPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmMKPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmMKPiBAQCAtMTcsNyArMTcsNyBAQAo+ICAg
I2luY2x1ZGUgImludGVsX2hvdHBsdWcuaCIKPiAgICNpbmNsdWRlICJpbnRlbF9zaWRlYmFuZC5o
Igo+ICAgCj4gLWJvb2wgaW50ZWxfZGlzcGxheV9wb3dlcl93ZWxsX2lzX2VuYWJsZWQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtib29sIGludGVsX2Rpc3BsYXlfcG93ZXJf
d2VsbF9pc19lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCQkg
ZW51bSBpOTE1X3Bvd2VyX3dlbGxfaWQgcG93ZXJfd2VsbF9pZCk7Cj4gICAKPiAgIGNvbnN0IGNo
YXIgKgo+IEBAIC0xMjIsNDIgKzEyMiw0MiBAQCBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbl9z
dHIoZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBkb21haW4pCj4gICAJfQo+ICAgfQo+
ICAgCj4gLXN0YXRpYyB2b2lkIGludGVsX3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgaW50ZWxfcG93ZXJfd2VsbF9lbmFi
bGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgIHN0cnVjdCBpOTE1
X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4gICB7Cj4gICAJRFJNX0RFQlVHX0tNUygiZW5hYmxp
bmcgJXNcbiIsIHBvd2VyX3dlbGwtPmRlc2MtPm5hbWUpOwo+IC0JcG93ZXJfd2VsbC0+ZGVzYy0+
b3BzLT5lbmFibGUoZGV2X3ByaXYsIHBvd2VyX3dlbGwpOwo+ICsJcG93ZXJfd2VsbC0+ZGVzYy0+
b3BzLT5lbmFibGUoaTkxNSwgcG93ZXJfd2VsbCk7Cj4gICAJcG93ZXJfd2VsbC0+aHdfZW5hYmxl
ZCA9IHRydWU7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaW50ZWxfcG93ZXJfd2VsbF9kaXNh
YmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgaW50
ZWxfcG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAg
CQkJCSAgICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKPiAgIHsKPiAgIAlE
Uk1fREVCVUdfS01TKCJkaXNhYmxpbmcgJXNcbiIsIHBvd2VyX3dlbGwtPmRlc2MtPm5hbWUpOwo+
ICAgCXBvd2VyX3dlbGwtPmh3X2VuYWJsZWQgPSBmYWxzZTsKPiAtCXBvd2VyX3dlbGwtPmRlc2Mt
Pm9wcy0+ZGlzYWJsZShkZXZfcHJpdiwgcG93ZXJfd2VsbCk7Cj4gKwlwb3dlcl93ZWxsLT5kZXNj
LT5vcHMtPmRpc2FibGUoaTkxNSwgcG93ZXJfd2VsbCk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZv
aWQgaW50ZWxfcG93ZXJfd2VsbF9nZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ICtzdGF0aWMgdm9pZCBpbnRlbF9wb3dlcl93ZWxsX2dldChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiAgIAkJCQkgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkK
PiAgIHsKPiAgIAlpZiAoIXBvd2VyX3dlbGwtPmNvdW50KyspCj4gLQkJaW50ZWxfcG93ZXJfd2Vs
bF9lbmFibGUoZGV2X3ByaXYsIHBvd2VyX3dlbGwpOwo+ICsJCWludGVsX3Bvd2VyX3dlbGxfZW5h
YmxlKGk5MTUsIHBvd2VyX3dlbGwpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGludGVsX3Bv
d2VyX3dlbGxfcHV0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGlj
IHZvaWQgaW50ZWxfcG93ZXJfd2VsbF9wdXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gICAJCQkJIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4gICB7Cj4gICAJ
V0FSTighcG93ZXJfd2VsbC0+Y291bnQsICJVc2UgY291bnQgb24gcG93ZXIgd2VsbCAlcyBpcyBh
bHJlYWR5IHplcm8iLAo+ICAgCSAgICAgcG93ZXJfd2VsbC0+ZGVzYy0+bmFtZSk7Cj4gICAKPiAg
IAlpZiAoIS0tcG93ZXJfd2VsbC0+Y291bnQpCj4gLQkJaW50ZWxfcG93ZXJfd2VsbF9kaXNhYmxl
KGRldl9wcml2LCBwb3dlcl93ZWxsKTsKPiArCQlpbnRlbF9wb3dlcl93ZWxsX2Rpc2FibGUoaTkx
NSwgcG93ZXJfd2VsbCk7Cj4gICB9Cj4gICAKPiAgIC8qKgo+ICAgICogX19pbnRlbF9kaXNwbGF5
X3Bvd2VyX2lzX2VuYWJsZWQgLSB1bmxvY2tlZCBjaGVjayBmb3IgYSBwb3dlciBkb21haW4KPiAt
ICogQGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ICsgKiBAaTkxNTogaTkxNSBkZXZp
Y2UgaW5zdGFuY2UKPiAgICAqIEBkb21haW46IHBvd2VyIGRvbWFpbiB0byBjaGVjawo+ICAgICoK
PiAgICAqIFRoaXMgaXMgdGhlIHVubG9ja2VkIHZlcnNpb24gb2YgaW50ZWxfZGlzcGxheV9wb3dl
cl9pc19lbmFibGVkKCkgYW5kIHNob3VsZAo+IEBAIC0xNjcsMTggKzE2NywxOCBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9wb3dlcl93ZWxsX3B1dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gICAgKiBSZXR1cm5zOgo+ICAgICogVHJ1ZSB3aGVuIHRoZSBwb3dlciBkb21haW4gaXMg
ZW5hYmxlZCwgZmFsc2Ugb3RoZXJ3aXNlLgo+ICAgICovCj4gLWJvb2wgX19pbnRlbF9kaXNwbGF5
X3Bvd2VyX2lzX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICti
b29sIF9faW50ZWxfZGlzcGxheV9wb3dlcl9pc19lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAo+ICAgCQkJCSAgICAgIGVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4g
ZG9tYWluKQo+ICAgewo+ICAgCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGw7Cj4g
ICAJYm9vbCBpc19lbmFibGVkOwo+ICAgCj4gLQlpZiAoZGV2X3ByaXYtPnJ1bnRpbWVfcG0uc3Vz
cGVuZGVkKQo+ICsJaWYgKGk5MTUtPnJ1bnRpbWVfcG0uc3VzcGVuZGVkKQo+ICAgCQlyZXR1cm4g
ZmFsc2U7Cj4gICAKPiAgIAlpc19lbmFibGVkID0gdHJ1ZTsKPiAgIAo+IC0JZm9yX2VhY2hfcG93
ZXJfZG9tYWluX3dlbGxfcmV2ZXJzZShkZXZfcHJpdiwgcG93ZXJfd2VsbCwgQklUX1VMTChkb21h
aW4pKSB7Cj4gKwlmb3JfZWFjaF9wb3dlcl9kb21haW5fd2VsbF9yZXZlcnNlKGk5MTUsIHBvd2Vy
X3dlbGwsIEJJVF9VTEwoZG9tYWluKSkgewo+ICAgCQlpZiAocG93ZXJfd2VsbC0+ZGVzYy0+YWx3
YXlzX29uKQo+ICAgCQkJY29udGludWU7Cj4gICAKPiBAQCAtMTkzLDcgKzE5Myw3IEBAIGJvb2wg
X19pbnRlbF9kaXNwbGF5X3Bvd2VyX2lzX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICAgCj4gICAvKioKPiAgICAqIGludGVsX2Rpc3BsYXlfcG93ZXJfaXNfZW5h
YmxlZCAtIGNoZWNrIGZvciBhIHBvd2VyIGRvbWFpbgo+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2
aWNlIGluc3RhbmNlCj4gKyAqIEBpOTE1OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ICAgICogQGRv
bWFpbjogcG93ZXIgZG9tYWluIHRvIGNoZWNrCj4gICAgKgo+ICAgICogVGhpcyBmdW5jdGlvbiBj
YW4gYmUgdXNlZCB0byBjaGVjayB0aGUgaHcgcG93ZXIgZG9tYWluIHN0YXRlLiBJdCBpcyBtb3N0
bHkKPiBAQCAtMjA4LDE2ICsyMDgsMTYgQEAgYm9vbCBfX2ludGVsX2Rpc3BsYXlfcG93ZXJfaXNf
ZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAgKiBSZXR1cm5z
Ogo+ICAgICogVHJ1ZSB3aGVuIHRoZSBwb3dlciBkb21haW4gaXMgZW5hYmxlZCwgZmFsc2Ugb3Ro
ZXJ3aXNlLgo+ICAgICovCj4gLWJvb2wgaW50ZWxfZGlzcGxheV9wb3dlcl9pc19lbmFibGVkKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArYm9vbCBpbnRlbF9kaXNwbGF5X3Bv
d2VyX2lzX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAg
IGVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluKQo+ICAgewo+ICAgCXN0cnVj
dCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnM7Cj4gICAJYm9vbCByZXQ7Cj4gICAK
PiAtCXBvd2VyX2RvbWFpbnMgPSAmZGV2X3ByaXYtPnBvd2VyX2RvbWFpbnM7Cj4gKwlwb3dlcl9k
b21haW5zID0gJmk5MTUtPnBvd2VyX2RvbWFpbnM7Cj4gICAKPiAgIAltdXRleF9sb2NrKCZwb3dl
cl9kb21haW5zLT5sb2NrKTsKPiAtCXJldCA9IF9faW50ZWxfZGlzcGxheV9wb3dlcl9pc19lbmFi
bGVkKGRldl9wcml2LCBkb21haW4pOwo+ICsJcmV0ID0gX19pbnRlbF9kaXNwbGF5X3Bvd2VyX2lz
X2VuYWJsZWQoaTkxNSwgZG9tYWluKTsKPiAgIAltdXRleF91bmxvY2soJnBvd2VyX2RvbWFpbnMt
PmxvY2spOwo+ICAgCj4gICAJcmV0dXJuIHJldDsKPiBAQCAtMjI5LDEwICsyMjksMTAgQEAgYm9v
bCBpbnRlbF9kaXNwbGF5X3Bvd2VyX2lzX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICAgICogdG8gYmUgZW5hYmxlZCwgYW5kIGl0IHdpbGwgb25seSBiZSBkaXNh
YmxlZCBpZiBub25lIG9mIHRoZSByZWdpc3RlcnMgaXMKPiAgICAqIHJlcXVlc3RpbmcgaXQgdG8g
YmUgZW5hYmxlZC4KPiAgICAqLwo+IC1zdGF0aWMgdm9pZCBoc3dfcG93ZXJfd2VsbF9wb3N0X2Vu
YWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGhz
d19wb3dlcl93ZWxsX3Bvc3RfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+
ICAgCQkJCSAgICAgICB1OCBpcnFfcGlwZV9tYXNrLCBib29sIGhhc192Z2EpCj4gICB7Cj4gLQlz
dHJ1Y3QgcGNpX2RldiAqcGRldiA9IGRldl9wcml2LT5kcm0ucGRldjsKPiArCXN0cnVjdCBwY2lf
ZGV2ICpwZGV2ID0gaTkxNS0+ZHJtLnBkZXY7Cj4gICAKPiAgIAkvKgo+ICAgCSAqIEFmdGVyIHdl
IHJlLWVuYWJsZSB0aGUgcG93ZXIgd2VsbCwgaWYgd2UgdG91Y2ggVkdBIHJlZ2lzdGVyIDB4M2Q1
Cj4gQEAgLTI1MSwzMSArMjUxLDMxIEBAIHN0YXRpYyB2b2lkIGhzd19wb3dlcl93ZWxsX3Bvc3Rf
ZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAl9Cj4gICAKPiAg
IAlpZiAoaXJxX3BpcGVfbWFzaykKPiAtCQlnZW44X2lycV9wb3dlcl93ZWxsX3Bvc3RfZW5hYmxl
KGRldl9wcml2LCBpcnFfcGlwZV9tYXNrKTsKPiArCQlnZW44X2lycV9wb3dlcl93ZWxsX3Bvc3Rf
ZW5hYmxlKGk5MTUsIGlycV9waXBlX21hc2spOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGhz
d19wb3dlcl93ZWxsX3ByZV9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiArc3RhdGljIHZvaWQgaHN3X3Bvd2VyX3dlbGxfcHJlX2Rpc2FibGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgICAgIHU4IGlycV9waXBlX21hc2spCj4gICB7
Cj4gICAJaWYgKGlycV9waXBlX21hc2spCj4gLQkJZ2VuOF9pcnFfcG93ZXJfd2VsbF9wcmVfZGlz
YWJsZShkZXZfcHJpdiwgaXJxX3BpcGVfbWFzayk7Cj4gKwkJZ2VuOF9pcnFfcG93ZXJfd2VsbF9w
cmVfZGlzYWJsZShpOTE1LCBpcnFfcGlwZV9tYXNrKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9p
ZCBoc3dfd2FpdF9mb3JfcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBoc3dfd2FpdF9mb3JfcG93ZXJfd2VsbF9lbmFibGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJCSAgIHN0cnVjdCBpOTE1X3Bv
d2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4gICB7Cj4gICAJY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJf
d2VsbF9yZWdzICpyZWdzID0gcG93ZXJfd2VsbC0+ZGVzYy0+aHN3LnJlZ3M7Cj4gICAJaW50IHB3
X2lkeCA9IHBvd2VyX3dlbGwtPmRlc2MtPmhzdy5pZHg7Cj4gICAKPiAgIAkvKiBUaW1lb3V0IGZv
ciBQVzE6MTAgdXMsIEFVWDpub3Qgc3BlY2lmaWVkLCBvdGhlciBQV3M6MjAgdXMuICovCj4gLQlX
QVJOX09OKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLAo+ICsJV0FS
Tl9PTihpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+ICAgCQkJCQlyZWdz
LT5kcml2ZXIsCj4gICAJCQkJCUhTV19QV1JfV0VMTF9DVExfU1RBVEUocHdfaWR4KSwKPiAgIAkJ
CQkJSFNXX1BXUl9XRUxMX0NUTF9TVEFURShwd19pZHgpLAo+ICAgCQkJCQkxKSk7Cj4gICB9Cj4g
ICAKPiAtc3RhdGljIHUzMiBoc3dfcG93ZXJfd2VsbF9yZXF1ZXN0ZXJzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHUzMiBoc3dfcG93ZXJfd2VsbF9yZXF1ZXN0
ZXJzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgICAgY29uc3Qgc3Ry
dWN0IGk5MTVfcG93ZXJfd2VsbF9yZWdzICpyZWdzLAo+ICAgCQkJCSAgICAgaW50IHB3X2lkeCkK
PiAgIHsKPiBAQCAtMjkxLDcgKzI5MSw3IEBAIHN0YXRpYyB1MzIgaHN3X3Bvd2VyX3dlbGxfcmVx
dWVzdGVycyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJcmV0dXJuIHJl
dDsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBoc3dfd2FpdF9mb3JfcG93ZXJfd2VsbF9kaXNh
YmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgaHN3
X3dhaXRfZm9yX3Bvd2VyX3dlbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiAgIAkJCQkJICAgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4gICB7
Cj4gICAJY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJfd2VsbF9yZWdzICpyZWdzID0gcG93ZXJfd2Vs
bC0+ZGVzYy0+aHN3LnJlZ3M7Cj4gQEAgLTMxMCw3ICszMTAsNyBAQCBzdGF0aWMgdm9pZCBoc3df
d2FpdF9mb3JfcG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiAgIAkgKi8KPiAgIAl3YWl0X2ZvcigoZGlzYWJsZWQgPSAhKEk5MTVfUkVBRChyZWdz
LT5kcml2ZXIpICYKPiAgIAkJCSAgICAgICBIU1dfUFdSX1dFTExfQ1RMX1NUQVRFKHB3X2lkeCkp
KSB8fAo+IC0JCSAocmVxcyA9IGhzd19wb3dlcl93ZWxsX3JlcXVlc3RlcnMoZGV2X3ByaXYsIHJl
Z3MsIHB3X2lkeCkpLCAxKTsKPiArCQkgKHJlcXMgPSBoc3dfcG93ZXJfd2VsbF9yZXF1ZXN0ZXJz
KGk5MTUsIHJlZ3MsIHB3X2lkeCkpLCAxKTsKPiAgIAlpZiAoZGlzYWJsZWQpCj4gICAJCXJldHVy
bjsKPiAgIAo+IEBAIC0zMTksMTYgKzMxOSwxNiBAQCBzdGF0aWMgdm9pZCBoc3dfd2FpdF9mb3Jf
cG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAg
IAkJICAgICAgISEocmVxcyAmIDEpLCAhIShyZXFzICYgMiksICEhKHJlcXMgJiA0KSwgISEocmVx
cyAmIDgpKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBnZW45X3dhaXRfZm9yX3Bvd2VyX3dl
bGxfZnVzZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9p
ZCBnZW45X3dhaXRfZm9yX3Bvd2VyX3dlbGxfZnVzZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCj4gICAJCQkJCSAgIGVudW0gc2tsX3Bvd2VyX2dhdGUgcGcpCj4gICB7Cj4gICAJLyog
VGltZW91dCA1dXMgZm9yIFBHIzAsIGZvciBvdGhlciBQR3MgMXVzICovCj4gLQlXQVJOX09OKGlu
dGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLCBTS0xfRlVTRV9TVEFUVVMs
Cj4gKwlXQVJOX09OKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsIFNLTF9G
VVNFX1NUQVRVUywKPiAgIAkJCQkJU0tMX0ZVU0VfUEdfRElTVF9TVEFUVVMocGcpLAo+ICAgCQkJ
CQlTS0xfRlVTRV9QR19ESVNUX1NUQVRVUyhwZyksIDEpKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMg
dm9pZCBoc3dfcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ICtzdGF0aWMgdm9pZCBoc3dfcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93
ZWxsKQo+ICAgewo+ICAgCWNvbnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfcmVncyAqcmVncyA9
IHBvd2VyX3dlbGwtPmRlc2MtPmhzdy5yZWdzOwo+IEBAIC0zMzgsNyArMzM4LDcgQEAgc3RhdGlj
IHZvaWQgaHN3X3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiAgIAl1MzIgdmFsOwo+ICAgCj4gICAJaWYgKHdhaXRfZnVzZXMpIHsKPiAtCQlwZyA9
IElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEgPyBJQ0xfUFdfQ1RMX0lEWF9UT19QRyhwd19pZHgp
IDoKPiArCQlwZyA9IElOVEVMX0dFTihpOTE1KSA+PSAxMSA/IElDTF9QV19DVExfSURYX1RPX1BH
KHB3X2lkeCkgOgo+ICAgCQkJCQkJIFNLTF9QV19DVExfSURYX1RPX1BHKHB3X2lkeCk7Cj4gICAJ
CS8qCj4gICAJCSAqIEZvciBQVzEgd2UgaGF2ZSB0byB3YWl0IGJvdGggZm9yIHRoZSBQVzAvUEcw
IGZ1c2Ugc3RhdGUKPiBAQCAtMzQ4LDE1ICszNDgsMTUgQEAgc3RhdGljIHZvaWQgaHN3X3Bvd2Vy
X3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkJICog
YWZ0ZXIgdGhlIGVuYWJsaW5nLgo+ICAgCQkgKi8KPiAgIAkJaWYgKHBnID09IFNLTF9QRzEpCj4g
LQkJCWdlbjlfd2FpdF9mb3JfcG93ZXJfd2VsbF9mdXNlcyhkZXZfcHJpdiwgU0tMX1BHMCk7Cj4g
KwkJCWdlbjlfd2FpdF9mb3JfcG93ZXJfd2VsbF9mdXNlcyhpOTE1LCBTS0xfUEcwKTsKPiAgIAl9
Cj4gICAKPiAgIAl2YWwgPSBJOTE1X1JFQUQocmVncy0+ZHJpdmVyKTsKPiAgIAlJOTE1X1dSSVRF
KHJlZ3MtPmRyaXZlciwgdmFsIHwgSFNXX1BXUl9XRUxMX0NUTF9SRVEocHdfaWR4KSk7Cj4gLQlo
c3dfd2FpdF9mb3JfcG93ZXJfd2VsbF9lbmFibGUoZGV2X3ByaXYsIHBvd2VyX3dlbGwpOwo+ICsJ
aHN3X3dhaXRfZm9yX3Bvd2VyX3dlbGxfZW5hYmxlKGk5MTUsIHBvd2VyX3dlbGwpOwo+ICAgCj4g
ICAJLyogRGlzcGxheSBXQSAjMTE3ODogY25sICovCj4gLQlpZiAoSVNfQ0FOTk9OTEFLRShkZXZf
cHJpdikgJiYKPiArCWlmIChJU19DQU5OT05MQUtFKGk5MTUpICYmCj4gICAJICAgIHB3X2lkeCA+
PSBHTEtfUFdfQ1RMX0lEWF9BVVhfQiAmJgo+ICAgCSAgICBwd19pZHggPD0gQ05MX1BXX0NUTF9J
RFhfQVVYX0YpIHsKPiAgIAkJdmFsID0gSTkxNV9SRUFEKENOTF9BVVhfQU5BT1ZSRDEocHdfaWR4
KSk7Cj4gQEAgLTM2NSwzMiArMzY1LDMyIEBAIHN0YXRpYyB2b2lkIGhzd19wb3dlcl93ZWxsX2Vu
YWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJfQo+ICAgCj4gICAJ
aWYgKHdhaXRfZnVzZXMpCj4gLQkJZ2VuOV93YWl0X2Zvcl9wb3dlcl93ZWxsX2Z1c2VzKGRldl9w
cml2LCBwZyk7Cj4gKwkJZ2VuOV93YWl0X2Zvcl9wb3dlcl93ZWxsX2Z1c2VzKGk5MTUsIHBnKTsK
PiAgIAo+IC0JaHN3X3Bvd2VyX3dlbGxfcG9zdF9lbmFibGUoZGV2X3ByaXYsCj4gKwloc3dfcG93
ZXJfd2VsbF9wb3N0X2VuYWJsZShpOTE1LAo+ICAgCQkJCSAgIHBvd2VyX3dlbGwtPmRlc2MtPmhz
dy5pcnFfcGlwZV9tYXNrLAo+ICAgCQkJCSAgIHBvd2VyX3dlbGwtPmRlc2MtPmhzdy5oYXNfdmdh
KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBoc3dfcG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgaHN3X3Bvd2VyX3dl
bGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICBzdHJ1
Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQo+ICAgewo+ICAgCWNvbnN0IHN0cnVjdCBp
OTE1X3Bvd2VyX3dlbGxfcmVncyAqcmVncyA9IHBvd2VyX3dlbGwtPmRlc2MtPmhzdy5yZWdzOwo+
ICAgCWludCBwd19pZHggPSBwb3dlcl93ZWxsLT5kZXNjLT5oc3cuaWR4Owo+ICAgCXUzMiB2YWw7
Cj4gICAKPiAtCWhzd19wb3dlcl93ZWxsX3ByZV9kaXNhYmxlKGRldl9wcml2LAo+ICsJaHN3X3Bv
d2VyX3dlbGxfcHJlX2Rpc2FibGUoaTkxNSwKPiAgIAkJCQkgICBwb3dlcl93ZWxsLT5kZXNjLT5o
c3cuaXJxX3BpcGVfbWFzayk7Cj4gICAKPiAgIAl2YWwgPSBJOTE1X1JFQUQocmVncy0+ZHJpdmVy
KTsKPiAgIAlJOTE1X1dSSVRFKHJlZ3MtPmRyaXZlciwgdmFsICYgfkhTV19QV1JfV0VMTF9DVExf
UkVRKHB3X2lkeCkpOwo+IC0JaHN3X3dhaXRfZm9yX3Bvd2VyX3dlbGxfZGlzYWJsZShkZXZfcHJp
diwgcG93ZXJfd2VsbCk7Cj4gKwloc3dfd2FpdF9mb3JfcG93ZXJfd2VsbF9kaXNhYmxlKGk5MTUs
IHBvd2VyX3dlbGwpOwo+ICAgfQo+ICAgCj4gICAjZGVmaW5lIElDTF9BVVhfUFdfVE9fUE9SVChw
d19pZHgpCSgocHdfaWR4KSAtIElDTF9QV19DVExfSURYX0FVWF9BKQo+ICAgCj4gICBzdGF0aWMg
dm9pZAo+IC1pY2xfY29tYm9fcGh5X2F1eF9wb3dlcl93ZWxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2ljbF9jb21ib19waHlfYXV4X3Bvd2VyX3dlbGxfZW5h
YmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgICBzdHJ1Y3QgaTkx
NV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQo+ICAgewo+ICAgCWNvbnN0IHN0cnVjdCBpOTE1X3Bv
d2VyX3dlbGxfcmVncyAqcmVncyA9IHBvd2VyX3dlbGwtPmRlc2MtPmhzdy5yZWdzOwo+IEBAIC00
MDQsMTIgKzQwNCwxMiBAQCBpY2xfY29tYm9fcGh5X2F1eF9wb3dlcl93ZWxsX2VuYWJsZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJdmFsID0gSTkxNV9SRUFEKElDTF9Q
T1JUX0NMX0RXMTIocG9ydCkpOwo+ICAgCUk5MTVfV1JJVEUoSUNMX1BPUlRfQ0xfRFcxMihwb3J0
KSwgdmFsIHwgSUNMX0xBTkVfRU5BQkxFX0FVWCk7Cj4gICAKPiAtCWhzd193YWl0X2Zvcl9wb3dl
cl93ZWxsX2VuYWJsZShkZXZfcHJpdiwgcG93ZXJfd2VsbCk7Cj4gKwloc3dfd2FpdF9mb3JfcG93
ZXJfd2VsbF9lbmFibGUoaTkxNSwgcG93ZXJfd2VsbCk7Cj4gICAKPiAgIAkvKiBEaXNwbGF5IFdB
ICMxMTc4OiBpY2wgKi8KPiAtCWlmIChJU19JQ0VMQUtFKGRldl9wcml2KSAmJgo+ICsJaWYgKElT
X0lDRUxBS0UoaTkxNSkgJiYKPiAgIAkgICAgcHdfaWR4ID49IElDTF9QV19DVExfSURYX0FVWF9B
ICYmIHB3X2lkeCA8PSBJQ0xfUFdfQ1RMX0lEWF9BVVhfQiAmJgo+IC0JICAgICFpbnRlbF9iaW9z
X2lzX3BvcnRfZWRwKGRldl9wcml2LCBwb3J0KSkgewo+ICsJICAgICFpbnRlbF9iaW9zX2lzX3Bv
cnRfZWRwKGk5MTUsIHBvcnQpKSB7Cj4gICAJCXZhbCA9IEk5MTVfUkVBRChJQ0xfQVVYX0FOQU9W
UkQxKHB3X2lkeCkpOwo+ICAgCQl2YWwgfD0gSUNMX0FVWF9BTkFPVlJEMV9FTkFCTEUgfCBJQ0xf
QVVYX0FOQU9WUkQxX0xET19CWVBBU1M7Cj4gICAJCUk5MTVfV1JJVEUoSUNMX0FVWF9BTkFPVlJE
MShwd19pZHgpLCB2YWwpOwo+IEBAIC00MTcsNyArNDE3LDcgQEAgaWNsX2NvbWJvX3BoeV9hdXhf
cG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAg
fQo+ICAgCj4gICBzdGF0aWMgdm9pZAo+IC1pY2xfY29tYm9fcGh5X2F1eF9wb3dlcl93ZWxsX2Rp
c2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtpY2xfY29tYm9fcGh5
X2F1eF9wb3dlcl93ZWxsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
ICAJCQkJICAgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQo+ICAgewo+ICAg
CWNvbnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfcmVncyAqcmVncyA9IHBvd2VyX3dlbGwtPmRl
c2MtPmhzdy5yZWdzOwo+IEBAIC00MzEsMTQgKzQzMSwxNCBAQCBpY2xfY29tYm9fcGh5X2F1eF9w
b3dlcl93ZWxsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAg
CXZhbCA9IEk5MTVfUkVBRChyZWdzLT5kcml2ZXIpOwo+ICAgCUk5MTVfV1JJVEUocmVncy0+ZHJp
dmVyLCB2YWwgJiB+SFNXX1BXUl9XRUxMX0NUTF9SRVEocHdfaWR4KSk7Cj4gICAKPiAtCWhzd193
YWl0X2Zvcl9wb3dlcl93ZWxsX2Rpc2FibGUoZGV2X3ByaXYsIHBvd2VyX3dlbGwpOwo+ICsJaHN3
X3dhaXRfZm9yX3Bvd2VyX3dlbGxfZGlzYWJsZShpOTE1LCBwb3dlcl93ZWxsKTsKPiAgIH0KPiAg
IAo+ICAgI2RlZmluZSBJQ0xfQVVYX1BXX1RPX0NIKHB3X2lkeCkJXAo+ICAgCSgocHdfaWR4KSAt
IElDTF9QV19DVExfSURYX0FVWF9BICsgQVVYX0NIX0EpCj4gICAKPiAgIHN0YXRpYyB2b2lkCj4g
LWljbF90Y19waHlfYXV4X3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiAraWNsX3RjX3BoeV9hdXhfcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBv
d2VyX3dlbGwpCj4gICB7Cj4gICAJZW51bSBhdXhfY2ggYXV4X2NoID0gSUNMX0FVWF9QV19UT19D
SChwb3dlcl93ZWxsLT5kZXNjLT5oc3cuaWR4KTsKPiBAQCAtNDUwLDcgKzQ1MCw3IEBAIGljbF90
Y19waHlfYXV4X3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiAgIAkJdmFsIHw9IERQX0FVWF9DSF9DVExfVEJUX0lPOwo+ICAgCUk5MTVfV1JJVEUo
RFBfQVVYX0NIX0NUTChhdXhfY2gpLCB2YWwpOwo+ICAgCj4gLQloc3dfcG93ZXJfd2VsbF9lbmFi
bGUoZGV2X3ByaXYsIHBvd2VyX3dlbGwpOwo+ICsJaHN3X3Bvd2VyX3dlbGxfZW5hYmxlKGk5MTUs
IHBvd2VyX3dlbGwpOwo+ICAgfQo+ICAgCj4gICAvKgo+IEBAIC00NTgsNyArNDU4LDcgQEAgaWNs
X3RjX3BoeV9hdXhfcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ICAgICogZW5hYmxlIGl0LCBzbyBjaGVjayBpZiBpdCdzIGVuYWJsZWQgYW5kIGFs
c28gY2hlY2sgaWYgd2UndmUgcmVxdWVzdGVkIGl0IHRvCj4gICAgKiBiZSBlbmFibGVkLgo+ICAg
ICovCj4gLXN0YXRpYyBib29sIGhzd19wb3dlcl93ZWxsX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgYm9vbCBoc3dfcG93ZXJfd2VsbF9lbmFibGVk
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgIHN0cnVjdCBpOTE1X3Bv
d2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4gICB7Cj4gICAJY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJf
d2VsbF9yZWdzICpyZWdzID0gcG93ZXJfd2VsbC0+ZGVzYy0+aHN3LnJlZ3M7Cj4gQEAgLTQ3Niwx
NCArNDc2LDE0IEBAIHN0YXRpYyBib29sIGhzd19wb3dlcl93ZWxsX2VuYWJsZWQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCSAqIEJJT1MncyBvd24gcmVxdWVzdCBiaXRz
LCB3aGljaCBhcmUgZm9yY2VkLW9uIGZvciB0aGVzZSBwb3dlciB3ZWxscwo+ICAgCSAqIHdoZW4g
ZXhpdGluZyBEQzUvNi4KPiAgIAkgKi8KPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDkpICYmICFJ
U19HRU45X0xQKGRldl9wcml2KSAmJgo+ICsJaWYgKElTX0dFTihpOTE1LCA5KSAmJiAhSVNfR0VO
OV9MUChpOTE1KSAmJgo+ICAgCSAgICAoaWQgPT0gU0tMX0RJU1BfUFdfMSB8fCBpZCA9PSBTS0xf
RElTUF9QV19NSVNDX0lPKSkKPiAgIAkJdmFsIHw9IEk5MTVfUkVBRChyZWdzLT5iaW9zKTsKPiAg
IAo+ICAgCXJldHVybiAodmFsICYgbWFzaykgPT0gbWFzazsKPiAgIH0KPiAgIAo+IC1zdGF0aWMg
dm9pZCBhc3NlcnRfY2FuX2VuYWJsZV9kYzkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICtzdGF0aWMgdm9pZCBhc3NlcnRfY2FuX2VuYWJsZV9kYzkoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJV0FSTl9PTkNFKChJOTE1X1JFQUQoRENfU1RBVEVf
RU4pICYgRENfU1RBVEVfRU5fREM5KSwKPiAgIAkJICAiREM5IGFscmVhZHkgcHJvZ3JhbW1lZCB0
byBiZSBlbmFibGVkLlxuIik7Cj4gQEAgLTQ5Miw3ICs0OTIsNyBAQCBzdGF0aWMgdm9pZCBhc3Nl
cnRfY2FuX2VuYWJsZV9kYzkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAg
CVdBUk5fT05DRShJOTE1X1JFQUQoSFNXX1BXUl9XRUxMX0NUTDIpICYKPiAgIAkJICBIU1dfUFdS
X1dFTExfQ1RMX1JFUShTS0xfUFdfQ1RMX0lEWF9QV18yKSwKPiAgIAkJICAiUG93ZXIgd2VsbCAy
IG9uLlxuIik7Cj4gLQlXQVJOX09OQ0UoaW50ZWxfaXJxc19lbmFibGVkKGRldl9wcml2KSwKPiAr
CVdBUk5fT05DRShpbnRlbF9pcnFzX2VuYWJsZWQoaTkxNSksCj4gICAJCSAgIkludGVycnVwdHMg
bm90IGRpc2FibGVkIHlldC5cbiIpOwo+ICAgCj4gICAJIC8qCj4gQEAgLTUwNCw5ICs1MDQsOSBA
QCBzdGF0aWMgdm9pZCBhc3NlcnRfY2FuX2VuYWJsZV9kYzkoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ICAgCSAgKi8KPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBhc3NlcnRf
Y2FuX2Rpc2FibGVfZGM5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3Rh
dGljIHZvaWQgYXNzZXJ0X2Nhbl9kaXNhYmxlX2RjOShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiAgIHsKPiAtCVdBUk5fT05DRShpbnRlbF9pcnFzX2VuYWJsZWQoZGV2X3ByaXYpLAo+
ICsJV0FSTl9PTkNFKGludGVsX2lycXNfZW5hYmxlZChpOTE1KSwKPiAgIAkJICAiSW50ZXJydXB0
cyBub3QgZGlzYWJsZWQgeWV0LlxuIik7Cj4gICAJV0FSTl9PTkNFKEk5MTVfUkVBRChEQ19TVEFU
RV9FTikgJiBEQ19TVEFURV9FTl9VUFRPX0RDNSwKPiAgIAkJICAiREM1IHN0aWxsIG5vdCBkaXNh
YmxlZC5cbiIpOwo+IEBAIC01MjAsNyArNTIwLDcgQEAgc3RhdGljIHZvaWQgYXNzZXJ0X2Nhbl9k
aXNhYmxlX2RjOShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICAqLwo+
ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGdlbjlfd3JpdGVfZGNfc3RhdGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBnZW45X3dyaXRlX2RjX3N0YXRl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCXUzMiBzdGF0ZSkKPiAgIHsK
PiAgIAlpbnQgcmV3cml0ZXMgPSAwOwo+IEBAIC01NTcsMTQgKzU1NywxNCBAQCBzdGF0aWMgdm9p
ZCBnZW45X3dyaXRlX2RjX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiAgIAkJCSAgICAgIHN0YXRlLCByZXdyaXRlcyk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHUzMiBn
ZW45X2RjX21hc2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMg
dTMyIGdlbjlfZGNfbWFzayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAg
IAl1MzIgbWFzazsKPiAgIAo+ICAgCW1hc2sgPSBEQ19TVEFURV9FTl9VUFRPX0RDNTsKPiAtCWlm
IChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAx
MSkKPiAgIAkJbWFzayB8PSBEQ19TVEFURV9FTl9VUFRPX0RDNiB8IERDX1NUQVRFX0VOX0RDOTsK
PiAtCWVsc2UgaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAoSVNfR0VOOV9M
UChpOTE1KSkKPiAgIAkJbWFzayB8PSBEQ19TVEFURV9FTl9EQzk7Cj4gICAJZWxzZQo+ICAgCQlt
YXNrIHw9IERDX1NUQVRFX0VOX1VQVE9fREM2Owo+IEBAIC01NzIsMjAgKzU3MiwyMCBAQCBzdGF0
aWMgdTMyIGdlbjlfZGNfbWFzayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
ICAJcmV0dXJuIG1hc2s7Cj4gICB9Cj4gICAKPiAtdm9pZCBnZW45X3Nhbml0aXplX2RjX3N0YXRl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBnZW45X3Nhbml0aXpl
X2RjX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUzMiB2
YWw7Cj4gICAKPiAtCXZhbCA9IEk5MTVfUkVBRChEQ19TVEFURV9FTikgJiBnZW45X2RjX21hc2so
ZGV2X3ByaXYpOwo+ICsJdmFsID0gSTkxNV9SRUFEKERDX1NUQVRFX0VOKSAmIGdlbjlfZGNfbWFz
ayhpOTE1KTsKPiAgIAo+ICAgCURSTV9ERUJVR19LTVMoIlJlc2V0dGluZyBEQyBzdGF0ZSB0cmFj
a2luZyBmcm9tICUwMnggdG8gJTAyeFxuIiwKPiAtCQkgICAgICBkZXZfcHJpdi0+Y3NyLmRjX3N0
YXRlLCB2YWwpOwo+IC0JZGV2X3ByaXYtPmNzci5kY19zdGF0ZSA9IHZhbDsKPiArCQkgICAgICBp
OTE1LT5jc3IuZGNfc3RhdGUsIHZhbCk7Cj4gKwlpOTE1LT5jc3IuZGNfc3RhdGUgPSB2YWw7Cj4g
ICB9Cj4gICAKPiAgIC8qKgo+ICAgICogZ2VuOV9zZXRfZGNfc3RhdGUgLSBzZXQgdGFyZ2V0IGRp
c3BsYXkgQyBwb3dlciBzdGF0ZQo+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIGluc3RhbmNl
Cj4gKyAqIEBpOTE1OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ICAgICogQHN0YXRlOiB0YXJnZXQg
REMgcG93ZXIgc3RhdGUKPiAgICAqIC0gRENfU1RBVEVfRElTQUJMRQo+ICAgICogLSBEQ19TVEFU
RV9FTl9VUFRPX0RDNQo+IEBAIC02MDYsMzUgKzYwNiwzNSBAQCB2b2lkIGdlbjlfc2FuaXRpemVf
ZGNfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgICogYmFjayBv
biBhbmQgcmVnaXN0ZXIgc3RhdGUgaXMgcmVzdG9yZWQuIFRoaXMgaXMgZ3VhcmFudGVlZCBieSB0
aGUgTU1JTyB3cml0ZQo+ICAgICogdG8gRENfU1RBVEVfRU4gYmxvY2tpbmcgdW50aWwgdGhlIHN0
YXRlIGlzIHJlc3RvcmVkLgo+ICAgICovCj4gLXN0YXRpYyB2b2lkIGdlbjlfc2V0X2RjX3N0YXRl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIHN0YXRlKQo+ICtzdGF0aWMg
dm9pZCBnZW45X3NldF9kY19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMy
IHN0YXRlKQo+ICAgewo+ICAgCXUzMiB2YWw7Cj4gICAJdTMyIG1hc2s7Cj4gICAKPiAtCWlmIChX
QVJOX09OX09OQ0Uoc3RhdGUgJiB+ZGV2X3ByaXYtPmNzci5hbGxvd2VkX2RjX21hc2spKQo+IC0J
CXN0YXRlICY9IGRldl9wcml2LT5jc3IuYWxsb3dlZF9kY19tYXNrOwo+ICsJaWYgKFdBUk5fT05f
T05DRShzdGF0ZSAmIH5pOTE1LT5jc3IuYWxsb3dlZF9kY19tYXNrKSkKPiArCQlzdGF0ZSAmPSBp
OTE1LT5jc3IuYWxsb3dlZF9kY19tYXNrOwo+ICAgCj4gICAJdmFsID0gSTkxNV9SRUFEKERDX1NU
QVRFX0VOKTsKPiAtCW1hc2sgPSBnZW45X2RjX21hc2soZGV2X3ByaXYpOwo+ICsJbWFzayA9IGdl
bjlfZGNfbWFzayhpOTE1KTsKPiAgIAlEUk1fREVCVUdfS01TKCJTZXR0aW5nIERDIHN0YXRlIGZy
b20gJTAyeCB0byAlMDJ4XG4iLAo+ICAgCQkgICAgICB2YWwgJiBtYXNrLCBzdGF0ZSk7Cj4gICAK
PiAgIAkvKiBDaGVjayBpZiBETUMgaXMgaWdub3Jpbmcgb3VyIERDIHN0YXRlIHJlcXVlc3RzICov
Cj4gLQlpZiAoKHZhbCAmIG1hc2spICE9IGRldl9wcml2LT5jc3IuZGNfc3RhdGUpCj4gKwlpZiAo
KHZhbCAmIG1hc2spICE9IGk5MTUtPmNzci5kY19zdGF0ZSkKPiAgIAkJRFJNX0VSUk9SKCJEQyBz
dGF0ZSBtaXNtYXRjaCAoMHgleCAtPiAweCV4KVxuIiwKPiAtCQkJICBkZXZfcHJpdi0+Y3NyLmRj
X3N0YXRlLCB2YWwgJiBtYXNrKTsKPiArCQkJICBpOTE1LT5jc3IuZGNfc3RhdGUsIHZhbCAmIG1h
c2spOwo+ICAgCj4gICAJdmFsICY9IH5tYXNrOwo+ICAgCXZhbCB8PSBzdGF0ZTsKPiAgIAo+IC0J
Z2VuOV93cml0ZV9kY19zdGF0ZShkZXZfcHJpdiwgdmFsKTsKPiArCWdlbjlfd3JpdGVfZGNfc3Rh
dGUoaTkxNSwgdmFsKTsKPiAgIAo+IC0JZGV2X3ByaXYtPmNzci5kY19zdGF0ZSA9IHZhbCAmIG1h
c2s7Cj4gKwlpOTE1LT5jc3IuZGNfc3RhdGUgPSB2YWwgJiBtYXNrOwo+ICAgfQo+ICAgCj4gLXZv
aWQgYnh0X2VuYWJsZV9kYzkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2
b2lkIGJ4dF9lbmFibGVfZGM5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+
IC0JYXNzZXJ0X2Nhbl9lbmFibGVfZGM5KGRldl9wcml2KTsKPiArCWFzc2VydF9jYW5fZW5hYmxl
X2RjOShpOTE1KTsKPiAgIAo+ICAgCURSTV9ERUJVR19LTVMoIkVuYWJsaW5nIERDOVxuIik7Cj4g
ICAJLyoKPiBAQCAtNjQyLDIzICs2NDIsMjMgQEAgdm9pZCBieHRfZW5hYmxlX2RjOShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICogcGxhdGZvcm1zIHdpdGggU291dGgg
RGlzcGxheSBFbmdpbmUgb24gUENILAo+ICAgCSAqIGJlY2F1c2UgUFBTIHJlZ2lzdGVycyBhcmUg
YWx3YXlzIG9uLgo+ICAgCSAqLwo+IC0JaWYgKCFIQVNfUENIX1NQTElUKGRldl9wcml2KSkKPiAt
CQlpbnRlbF9wb3dlcl9zZXF1ZW5jZXJfcmVzZXQoZGV2X3ByaXYpOwo+IC0JZ2VuOV9zZXRfZGNf
c3RhdGUoZGV2X3ByaXYsIERDX1NUQVRFX0VOX0RDOSk7Cj4gKwlpZiAoIUhBU19QQ0hfU1BMSVQo
aTkxNSkpCj4gKwkJaW50ZWxfcG93ZXJfc2VxdWVuY2VyX3Jlc2V0KGk5MTUpOwo+ICsJZ2VuOV9z
ZXRfZGNfc3RhdGUoaTkxNSwgRENfU1RBVEVfRU5fREM5KTsKPiAgIH0KPiAgIAo+IC12b2lkIGJ4
dF9kaXNhYmxlX2RjOShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQg
Ynh0X2Rpc2FibGVfZGM5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0J
YXNzZXJ0X2Nhbl9kaXNhYmxlX2RjOShkZXZfcHJpdik7Cj4gKwlhc3NlcnRfY2FuX2Rpc2FibGVf
ZGM5KGk5MTUpOwo+ICAgCj4gICAJRFJNX0RFQlVHX0tNUygiRGlzYWJsaW5nIERDOVxuIik7Cj4g
ICAKPiAtCWdlbjlfc2V0X2RjX3N0YXRlKGRldl9wcml2LCBEQ19TVEFURV9ESVNBQkxFKTsKPiAr
CWdlbjlfc2V0X2RjX3N0YXRlKGk5MTUsIERDX1NUQVRFX0RJU0FCTEUpOwo+ICAgCj4gLQlpbnRl
bF9wcHNfdW5sb2NrX3JlZ3Nfd2EoZGV2X3ByaXYpOwo+ICsJaW50ZWxfcHBzX3VubG9ja19yZWdz
X3dhKGk5MTUpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGFzc2VydF9jc3JfbG9hZGVkKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgYXNzZXJ0X2Nz
cl9sb2FkZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJV0FSTl9P
TkNFKCFJOTE1X1JFQUQoQ1NSX1BST0dSQU0oMCkpLAo+ICAgCQkgICJDU1IgcHJvZ3JhbSBzdG9y
YWdlIHN0YXJ0IGlzIE5VTExcbiIpOwo+IEBAIC02NjcsMTIgKzY2NywxMiBAQCBzdGF0aWMgdm9p
ZCBhc3NlcnRfY3NyX2xvYWRlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
ICB9Cj4gICAKPiAgIHN0YXRpYyBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICoKPiAtbG9va3VwX3Bv
d2VyX3dlbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtsb29rdXBfcG93
ZXJfd2VsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJICBlbnVtIGk5MTVf
cG93ZXJfd2VsbF9pZCBwb3dlcl93ZWxsX2lkKQo+ICAgewo+ICAgCXN0cnVjdCBpOTE1X3Bvd2Vy
X3dlbGwgKnBvd2VyX3dlbGw7Cj4gICAKPiAtCWZvcl9lYWNoX3Bvd2VyX3dlbGwoZGV2X3ByaXYs
IHBvd2VyX3dlbGwpCj4gKwlmb3JfZWFjaF9wb3dlcl93ZWxsKGk5MTUsIHBvd2VyX3dlbGwpCj4g
ICAJCWlmIChwb3dlcl93ZWxsLT5kZXNjLT5pZCA9PSBwb3dlcl93ZWxsX2lkKQo+ICAgCQkJcmV0
dXJuIHBvd2VyX3dlbGw7Cj4gICAKPiBAQCAtNjg0LDYyICs2ODQsNjIgQEAgbG9va3VwX3Bvd2Vy
X3dlbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCSAqIG91ciBkcml2
ZXIuCj4gICAJICovCj4gICAJV0FSTigxLCAiUG93ZXIgd2VsbCAlZCBub3QgZGVmaW5lZCBmb3Ig
dGhpcyBwbGF0Zm9ybVxuIiwgcG93ZXJfd2VsbF9pZCk7Cj4gLQlyZXR1cm4gJmRldl9wcml2LT5w
b3dlcl9kb21haW5zLnBvd2VyX3dlbGxzWzBdOwo+ICsJcmV0dXJuICZpOTE1LT5wb3dlcl9kb21h
aW5zLnBvd2VyX3dlbGxzWzBdOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGFzc2VydF9jYW5f
ZW5hYmxlX2RjNShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2
b2lkIGFzc2VydF9jYW5fZW5hYmxlX2RjNShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiAgIHsKPiAtCWJvb2wgcGcyX2VuYWJsZWQgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX3dlbGxfaXNf
ZW5hYmxlZChkZXZfcHJpdiwKPiArCWJvb2wgcGcyX2VuYWJsZWQgPSBpbnRlbF9kaXNwbGF5X3Bv
d2VyX3dlbGxfaXNfZW5hYmxlZChpOTE1LAo+ICAgCQkJCQlTS0xfRElTUF9QV18yKTsKPiAgIAo+
ICAgCVdBUk5fT05DRShwZzJfZW5hYmxlZCwgIlBHMiBub3QgZGlzYWJsZWQgdG8gZW5hYmxlIERD
NS5cbiIpOwo+ICAgCj4gICAJV0FSTl9PTkNFKChJOTE1X1JFQUQoRENfU1RBVEVfRU4pICYgRENf
U1RBVEVfRU5fVVBUT19EQzUpLAo+ICAgCQkgICJEQzUgYWxyZWFkeSBwcm9ncmFtbWVkIHRvIGJl
IGVuYWJsZWQuXG4iKTsKPiAtCWFzc2VydF9ycG1fd2FrZWxvY2tfaGVsZChkZXZfcHJpdik7Cj4g
Kwlhc3NlcnRfcnBtX3dha2Vsb2NrX2hlbGQoaTkxNSk7Cj4gICAKPiAtCWFzc2VydF9jc3JfbG9h
ZGVkKGRldl9wcml2KTsKPiArCWFzc2VydF9jc3JfbG9hZGVkKGk5MTUpOwo+ICAgfQo+ICAgCj4g
LXZvaWQgZ2VuOV9lbmFibGVfZGM1KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiArdm9pZCBnZW45X2VuYWJsZV9kYzUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
ICB7Cj4gLQlhc3NlcnRfY2FuX2VuYWJsZV9kYzUoZGV2X3ByaXYpOwo+ICsJYXNzZXJ0X2Nhbl9l
bmFibGVfZGM1KGk5MTUpOwo+ICAgCj4gICAJRFJNX0RFQlVHX0tNUygiRW5hYmxpbmcgREM1XG4i
KTsKPiAgIAo+ICAgCS8qIFdhIERpc3BsYXkgIzExODM6IHNrbCxrYmwsY2ZsICovCj4gLQlpZiAo
SVNfR0VOOV9CQyhkZXZfcHJpdikpCj4gKwlpZiAoSVNfR0VOOV9CQyhpOTE1KSkKPiAgIAkJSTkx
NV9XUklURShHRU44X0NISUNLRU5fRENQUl8xLCBJOTE1X1JFQUQoR0VOOF9DSElDS0VOX0RDUFJf
MSkgfAo+ICAgCQkJICAgU0tMX1NFTEVDVF9BTFRFUk5BVEVfRENfRVhJVCk7Cj4gICAKPiAtCWdl
bjlfc2V0X2RjX3N0YXRlKGRldl9wcml2LCBEQ19TVEFURV9FTl9VUFRPX0RDNSk7Cj4gKwlnZW45
X3NldF9kY19zdGF0ZShpOTE1LCBEQ19TVEFURV9FTl9VUFRPX0RDNSk7Cj4gICB9Cj4gICAKPiAt
c3RhdGljIHZvaWQgYXNzZXJ0X2Nhbl9lbmFibGVfZGM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgYXNzZXJ0X2Nhbl9lbmFibGVfZGM2KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCVdBUk5fT05DRShJOTE1X1JFQUQoVVRJ
TF9QSU5fQ1RMKSAmIFVUSUxfUElOX0VOQUJMRSwKPiAgIAkJICAiQmFja2xpZ2h0IGlzIG5vdCBk
aXNhYmxlZC5cbiIpOwo+ICAgCVdBUk5fT05DRSgoSTkxNV9SRUFEKERDX1NUQVRFX0VOKSAmIERD
X1NUQVRFX0VOX1VQVE9fREM2KSwKPiAgIAkJICAiREM2IGFscmVhZHkgcHJvZ3JhbW1lZCB0byBi
ZSBlbmFibGVkLlxuIik7Cj4gICAKPiAtCWFzc2VydF9jc3JfbG9hZGVkKGRldl9wcml2KTsKPiAr
CWFzc2VydF9jc3JfbG9hZGVkKGk5MTUpOwo+ICAgfQo+ICAgCj4gLXZvaWQgc2tsX2VuYWJsZV9k
YzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIHNrbF9lbmFibGVf
ZGM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JYXNzZXJ0X2Nhbl9l
bmFibGVfZGM2KGRldl9wcml2KTsKPiArCWFzc2VydF9jYW5fZW5hYmxlX2RjNihpOTE1KTsKPiAg
IAo+ICAgCURSTV9ERUJVR19LTVMoIkVuYWJsaW5nIERDNlxuIik7Cj4gICAKPiAgIAkvKiBXYSBE
aXNwbGF5ICMxMTgzOiBza2wsa2JsLGNmbCAqLwo+IC0JaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYp
KQo+ICsJaWYgKElTX0dFTjlfQkMoaTkxNSkpCj4gICAJCUk5MTVfV1JJVEUoR0VOOF9DSElDS0VO
X0RDUFJfMSwgSTkxNV9SRUFEKEdFTjhfQ0hJQ0tFTl9EQ1BSXzEpIHwKPiAgIAkJCSAgIFNLTF9T
RUxFQ1RfQUxURVJOQVRFX0RDX0VYSVQpOwo+ICAgCj4gLQlnZW45X3NldF9kY19zdGF0ZShkZXZf
cHJpdiwgRENfU1RBVEVfRU5fVVBUT19EQzYpOwo+ICsJZ2VuOV9zZXRfZGNfc3RhdGUoaTkxNSwg
RENfU1RBVEVfRU5fVVBUT19EQzYpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGhzd19wb3dl
cl93ZWxsX3N5bmNfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0
aWMgdm9pZCBoc3dfcG93ZXJfd2VsbF9zeW5jX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ICAgCQkJCSAgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4gICB7
Cj4gICAJY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJfd2VsbF9yZWdzICpyZWdzID0gcG93ZXJfd2Vs
bC0+ZGVzYy0+aHN3LnJlZ3M7Cj4gQEAgLTc1Nyw1MiArNzU3LDUyIEBAIHN0YXRpYyB2b2lkIGhz
d19wb3dlcl93ZWxsX3N5bmNfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICAgCX0KPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBieHRfZHBpb19jbW5fcG93ZXJfd2VsbF9l
bmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBi
eHRfZHBpb19jbW5fcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gICAJCQkJCSAgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4gICB7
Cj4gLQlieHRfZGRpX3BoeV9pbml0KGRldl9wcml2LCBwb3dlcl93ZWxsLT5kZXNjLT5ieHQucGh5
KTsKPiArCWJ4dF9kZGlfcGh5X2luaXQoaTkxNSwgcG93ZXJfd2VsbC0+ZGVzYy0+Ynh0LnBoeSk7
Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgYnh0X2RwaW9fY21uX3Bvd2VyX3dlbGxfZGlzYWJs
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGJ4dF9k
cGlvX2Ntbl9wb3dlcl93ZWxsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gICAJCQkJCSAgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQo+ICAgewo+
IC0JYnh0X2RkaV9waHlfdW5pbml0KGRldl9wcml2LCBwb3dlcl93ZWxsLT5kZXNjLT5ieHQucGh5
KTsKPiArCWJ4dF9kZGlfcGh5X3VuaW5pdChpOTE1LCBwb3dlcl93ZWxsLT5kZXNjLT5ieHQucGh5
KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgYm9vbCBieHRfZHBpb19jbW5fcG93ZXJfd2VsbF9lbmFi
bGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIGJvb2wgYnh0
X2RwaW9fY21uX3Bvd2VyX3dlbGxfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiAgIAkJCQkJICAgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4gICB7
Cj4gLQlyZXR1cm4gYnh0X2RkaV9waHlfaXNfZW5hYmxlZChkZXZfcHJpdiwgcG93ZXJfd2VsbC0+
ZGVzYy0+Ynh0LnBoeSk7Cj4gKwlyZXR1cm4gYnh0X2RkaV9waHlfaXNfZW5hYmxlZChpOTE1LCBw
b3dlcl93ZWxsLT5kZXNjLT5ieHQucGh5KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBieHRf
dmVyaWZ5X2RkaV9waHlfcG93ZXJfd2VsbHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICtzdGF0aWMgdm9pZCBieHRfdmVyaWZ5X2RkaV9waHlfcG93ZXJfd2VsbHMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RydWN0IGk5MTVfcG93ZXJfd2Vs
bCAqcG93ZXJfd2VsbDsKPiAgIAo+IC0JcG93ZXJfd2VsbCA9IGxvb2t1cF9wb3dlcl93ZWxsKGRl
dl9wcml2LCBCWFRfRElTUF9QV19EUElPX0NNTl9BKTsKPiArCXBvd2VyX3dlbGwgPSBsb29rdXBf
cG93ZXJfd2VsbChpOTE1LCBCWFRfRElTUF9QV19EUElPX0NNTl9BKTsKPiAgIAlpZiAocG93ZXJf
d2VsbC0+Y291bnQgPiAwKQo+IC0JCWJ4dF9kZGlfcGh5X3ZlcmlmeV9zdGF0ZShkZXZfcHJpdiwg
cG93ZXJfd2VsbC0+ZGVzYy0+Ynh0LnBoeSk7Cj4gKwkJYnh0X2RkaV9waHlfdmVyaWZ5X3N0YXRl
KGk5MTUsIHBvd2VyX3dlbGwtPmRlc2MtPmJ4dC5waHkpOwo+ICAgCj4gLQlwb3dlcl93ZWxsID0g
bG9va3VwX3Bvd2VyX3dlbGwoZGV2X3ByaXYsIFZMVl9ESVNQX1BXX0RQSU9fQ01OX0JDKTsKPiAr
CXBvd2VyX3dlbGwgPSBsb29rdXBfcG93ZXJfd2VsbChpOTE1LCBWTFZfRElTUF9QV19EUElPX0NN
Tl9CQyk7Cj4gICAJaWYgKHBvd2VyX3dlbGwtPmNvdW50ID4gMCkKPiAtCQlieHRfZGRpX3BoeV92
ZXJpZnlfc3RhdGUoZGV2X3ByaXYsIHBvd2VyX3dlbGwtPmRlc2MtPmJ4dC5waHkpOwo+ICsJCWJ4
dF9kZGlfcGh5X3ZlcmlmeV9zdGF0ZShpOTE1LCBwb3dlcl93ZWxsLT5kZXNjLT5ieHQucGh5KTsK
PiAgIAo+IC0JaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKSB7Cj4gLQkJcG93ZXJfd2VsbCA9
IGxvb2t1cF9wb3dlcl93ZWxsKGRldl9wcml2LAo+ICsJaWYgKElTX0dFTUlOSUxBS0UoaTkxNSkp
IHsKPiArCQlwb3dlcl93ZWxsID0gbG9va3VwX3Bvd2VyX3dlbGwoaTkxNSwKPiAgIAkJCQkJICAg
ICAgIEdMS19ESVNQX1BXX0RQSU9fQ01OX0MpOwo+ICAgCQlpZiAocG93ZXJfd2VsbC0+Y291bnQg
PiAwKQo+IC0JCQlieHRfZGRpX3BoeV92ZXJpZnlfc3RhdGUoZGV2X3ByaXYsCj4gKwkJCWJ4dF9k
ZGlfcGh5X3ZlcmlmeV9zdGF0ZShpOTE1LAo+ICAgCQkJCQkJIHBvd2VyX3dlbGwtPmRlc2MtPmJ4
dC5waHkpOwo+ICAgCX0KPiAgIH0KPiAgIAo+IC1zdGF0aWMgYm9vbCBnZW45X2RjX29mZl9wb3dl
cl93ZWxsX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0
aWMgYm9vbCBnZW45X2RjX29mZl9wb3dlcl93ZWxsX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gICAJCQkJCSAgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dl
bGwpCj4gICB7Cj4gICAJcmV0dXJuIChJOTE1X1JFQUQoRENfU1RBVEVfRU4pICYgRENfU1RBVEVf
RU5fVVBUT19EQzVfREM2X01BU0spID09IDA7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgZ2Vu
OV9hc3NlcnRfZGJ1Zl9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiArc3RhdGljIHZvaWQgZ2VuOV9hc3NlcnRfZGJ1Zl9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUzMiB0bXAgPSBJOTE1X1JFQUQoREJVRl9DVEwpOwo+
ICAgCj4gQEAgLTgxMSw5MiArODExLDkyIEBAIHN0YXRpYyB2b2lkIGdlbjlfYXNzZXJ0X2RidWZf
ZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICAgICAiVW5l
eHBlY3RlZCBEQnVmIHBvd2VyIHBvd2VyIHN0YXRlICgweCUwOHgpXG4iLCB0bXApOwo+ICAgfQo+
ICAgCj4gLXN0YXRpYyB2b2lkIGdlbjlfZGNfb2ZmX3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgZ2VuOV9kY19vZmZfcG93
ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJCSAg
c3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50
ZWxfY2RjbGtfc3RhdGUgY2RjbGtfc3RhdGUgPSB7fTsKPiAgIAo+IC0JZ2VuOV9zZXRfZGNfc3Rh
dGUoZGV2X3ByaXYsIERDX1NUQVRFX0RJU0FCTEUpOwo+ICsJZ2VuOV9zZXRfZGNfc3RhdGUoaTkx
NSwgRENfU1RBVEVfRElTQUJMRSk7Cj4gICAKPiAtCWRldl9wcml2LT5kaXNwbGF5LmdldF9jZGNs
ayhkZXZfcHJpdiwgJmNkY2xrX3N0YXRlKTsKPiArCWk5MTUtPmRpc3BsYXkuZ2V0X2NkY2xrKGk5
MTUsICZjZGNsa19zdGF0ZSk7Cj4gICAJLyogQ2FuJ3QgcmVhZCBvdXQgdm9sdGFnZV9sZXZlbCBz
byBjYW4ndCB1c2UgaW50ZWxfY2RjbGtfY2hhbmdlZCgpICovCj4gLQlXQVJOX09OKGludGVsX2Nk
Y2xrX25lZWRzX21vZGVzZXQoJmRldl9wcml2LT5jZGNsay5odywgJmNkY2xrX3N0YXRlKSk7Cj4g
KwlXQVJOX09OKGludGVsX2NkY2xrX25lZWRzX21vZGVzZXQoJmk5MTUtPmNkY2xrLmh3LCAmY2Rj
bGtfc3RhdGUpKTsKPiAgIAo+IC0JZ2VuOV9hc3NlcnRfZGJ1Zl9lbmFibGVkKGRldl9wcml2KTsK
PiArCWdlbjlfYXNzZXJ0X2RidWZfZW5hYmxlZChpOTE1KTsKPiAgIAo+IC0JaWYgKElTX0dFTjlf
TFAoZGV2X3ByaXYpKQo+IC0JCWJ4dF92ZXJpZnlfZGRpX3BoeV9wb3dlcl93ZWxscyhkZXZfcHJp
dik7Cj4gKwlpZiAoSVNfR0VOOV9MUChpOTE1KSkKPiArCQlieHRfdmVyaWZ5X2RkaV9waHlfcG93
ZXJfd2VsbHMoaTkxNSk7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQo+
ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiAgIAkJLyoKPiAgIAkJICogRE1DIHJldGFp
bnMgSFcgY29udGV4dCBvbmx5IGZvciBwb3J0IEEsIHRoZSBvdGhlciBjb21ibwo+ICAgCQkgKiBQ
SFkncyBIVyBjb250ZXh0IGZvciBwb3J0IEIgaXMgbG9zdCBhZnRlciBEQyB0cmFuc2l0aW9ucywK
PiAgIAkJICogc28gd2UgbmVlZCB0byByZXN0b3JlIGl0IG1hbnVhbGx5Lgo+ICAgCQkgKi8KPiAt
CQlpbnRlbF9jb21ib19waHlfaW5pdChkZXZfcHJpdik7Cj4gKwkJaW50ZWxfY29tYm9fcGh5X2lu
aXQoaTkxNSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgZ2VuOV9kY19vZmZfcG93ZXJfd2Vs
bF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZv
aWQgZ2VuOV9kY19vZmZfcG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAo+ICAgCQkJCQkgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQo+
ICAgewo+IC0JaWYgKCFkZXZfcHJpdi0+Y3NyLmRtY19wYXlsb2FkKQo+ICsJaWYgKCFpOTE1LT5j
c3IuZG1jX3BheWxvYWQpCj4gICAJCXJldHVybjsKPiAgIAo+IC0JaWYgKGRldl9wcml2LT5jc3Iu
YWxsb3dlZF9kY19tYXNrICYgRENfU1RBVEVfRU5fVVBUT19EQzYpCj4gLQkJc2tsX2VuYWJsZV9k
YzYoZGV2X3ByaXYpOwo+IC0JZWxzZSBpZiAoZGV2X3ByaXYtPmNzci5hbGxvd2VkX2RjX21hc2sg
JiBEQ19TVEFURV9FTl9VUFRPX0RDNSkKPiAtCQlnZW45X2VuYWJsZV9kYzUoZGV2X3ByaXYpOwo+
ICsJaWYgKGk5MTUtPmNzci5hbGxvd2VkX2RjX21hc2sgJiBEQ19TVEFURV9FTl9VUFRPX0RDNikK
PiArCQlza2xfZW5hYmxlX2RjNihpOTE1KTsKPiArCWVsc2UgaWYgKGk5MTUtPmNzci5hbGxvd2Vk
X2RjX21hc2sgJiBEQ19TVEFURV9FTl9VUFRPX0RDNSkKPiArCQlnZW45X2VuYWJsZV9kYzUoaTkx
NSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaTl4eF9wb3dlcl93ZWxsX3N5bmNfaHdfbm9v
cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGk5eHhf
cG93ZXJfd2VsbF9zeW5jX2h3X25vb3Aoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
ICAJCQkJCSBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQo+ICAgewo+ICAgfQo+
ICAgCj4gLXN0YXRpYyB2b2lkIGk5eHhfYWx3YXlzX29uX3Bvd2VyX3dlbGxfbm9vcChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGk5eHhfYWx3YXlzX29u
X3Bvd2VyX3dlbGxfbm9vcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkJ
ICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKPiAgIHsKPiAgIH0KPiAgIAo+
IC1zdGF0aWMgYm9vbCBpOXh4X2Fsd2F5c19vbl9wb3dlcl93ZWxsX2VuYWJsZWQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgYm9vbCBpOXh4X2Fsd2F5c19vbl9w
b3dlcl93ZWxsX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJ
CSAgICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKPiAgIHsKPiAgIAlyZXR1
cm4gdHJ1ZTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpODMwX3BpcGVzX3Bvd2VyX3dlbGxf
ZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQg
aTgzMF9waXBlc19wb3dlcl93ZWxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiAgIAkJCQkJIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4gICB7Cj4g
ICAJaWYgKChJOTE1X1JFQUQoUElQRUNPTkYoUElQRV9BKSkgJiBQSVBFQ09ORl9FTkFCTEUpID09
IDApCj4gLQkJaTgzMF9lbmFibGVfcGlwZShkZXZfcHJpdiwgUElQRV9BKTsKPiArCQlpODMwX2Vu
YWJsZV9waXBlKGk5MTUsIFBJUEVfQSk7Cj4gICAJaWYgKChJOTE1X1JFQUQoUElQRUNPTkYoUElQ
RV9CKSkgJiBQSVBFQ09ORl9FTkFCTEUpID09IDApCj4gLQkJaTgzMF9lbmFibGVfcGlwZShkZXZf
cHJpdiwgUElQRV9CKTsKPiArCQlpODMwX2VuYWJsZV9waXBlKGk5MTUsIFBJUEVfQik7Cj4gICB9
Cj4gICAKPiAtc3RhdGljIHZvaWQgaTgzMF9waXBlc19wb3dlcl93ZWxsX2Rpc2FibGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBpODMwX3BpcGVzX3Bv
d2VyX3dlbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkJ
ICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQo+ICAgewo+IC0JaTgzMF9kaXNh
YmxlX3BpcGUoZGV2X3ByaXYsIFBJUEVfQik7Cj4gLQlpODMwX2Rpc2FibGVfcGlwZShkZXZfcHJp
diwgUElQRV9BKTsKPiArCWk4MzBfZGlzYWJsZV9waXBlKGk5MTUsIFBJUEVfQik7Cj4gKwlpODMw
X2Rpc2FibGVfcGlwZShpOTE1LCBQSVBFX0EpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBib29sIGk4
MzBfcGlwZXNfcG93ZXJfd2VsbF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiArc3RhdGljIGJvb2wgaTgzMF9waXBlc19wb3dlcl93ZWxsX2VuYWJsZWQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJCSAgc3RydWN0IGk5MTVfcG93ZXJfd2Vs
bCAqcG93ZXJfd2VsbCkKPiAgIHsKPiAgIAlyZXR1cm4gSTkxNV9SRUFEKFBJUEVDT05GKFBJUEVf
QSkpICYgUElQRUNPTkZfRU5BQkxFICYmCj4gICAJCUk5MTVfUkVBRChQSVBFQ09ORihQSVBFX0Ip
KSAmIFBJUEVDT05GX0VOQUJMRTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpODMwX3BpcGVz
X3Bvd2VyX3dlbGxfc3luY19odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
K3N0YXRpYyB2b2lkIGk4MzBfcGlwZXNfcG93ZXJfd2VsbF9zeW5jX2h3KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCQkJCQkgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2Vy
X3dlbGwpCj4gICB7Cj4gICAJaWYgKHBvd2VyX3dlbGwtPmNvdW50ID4gMCkKPiAtCQlpODMwX3Bp
cGVzX3Bvd2VyX3dlbGxfZW5hYmxlKGRldl9wcml2LCBwb3dlcl93ZWxsKTsKPiArCQlpODMwX3Bp
cGVzX3Bvd2VyX3dlbGxfZW5hYmxlKGk5MTUsIHBvd2VyX3dlbGwpOwo+ICAgCWVsc2UKPiAtCQlp
ODMwX3BpcGVzX3Bvd2VyX3dlbGxfZGlzYWJsZShkZXZfcHJpdiwgcG93ZXJfd2VsbCk7Cj4gKwkJ
aTgzMF9waXBlc19wb3dlcl93ZWxsX2Rpc2FibGUoaTkxNSwgcG93ZXJfd2VsbCk7Cj4gICB9Cj4g
ICAKPiAtc3RhdGljIHZvaWQgdmx2X3NldF9wb3dlcl93ZWxsKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgdmx2X3NldF9wb3dlcl93ZWxsKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgICAgIHN0cnVjdCBpOTE1X3Bvd2VyX3dl
bGwgKnBvd2VyX3dlbGwsIGJvb2wgZW5hYmxlKQo+ICAgewo+ICAgCWludCBwd19pZHggPSBwb3dl
cl93ZWxsLT5kZXNjLT52bHYuaWR4Owo+IEBAIC05MDgsNDMgKzkwOCw0MyBAQCBzdGF0aWMgdm9p
ZCB2bHZfc2V0X3Bvd2VyX3dlbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICAgCXN0YXRlID0gZW5hYmxlID8gUFVOSVRfUFdSR1RfUFdSX09OKHB3X2lkeCkgOgo+ICAgCQkJ
IFBVTklUX1BXUkdUX1BXUl9HQVRFKHB3X2lkeCk7Cj4gICAKPiAtCXZsdl9wdW5pdF9nZXQoZGV2
X3ByaXYpOwo+ICsJdmx2X3B1bml0X2dldChpOTE1KTsKPiAgIAo+ICAgI2RlZmluZSBDT05EIFwK
PiAtCSgodmx2X3B1bml0X3JlYWQoZGV2X3ByaXYsIFBVTklUX1JFR19QV1JHVF9TVEFUVVMpICYg
bWFzaykgPT0gc3RhdGUpCj4gKwkoKHZsdl9wdW5pdF9yZWFkKGk5MTUsIFBVTklUX1JFR19QV1JH
VF9TVEFUVVMpICYgbWFzaykgPT0gc3RhdGUpCj4gICAKPiAgIAlpZiAoQ09ORCkKPiAgIAkJZ290
byBvdXQ7Cj4gICAKPiAtCWN0cmwgPSB2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgUFVOSVRfUkVH
X1BXUkdUX0NUUkwpOwo+ICsJY3RybCA9IHZsdl9wdW5pdF9yZWFkKGk5MTUsIFBVTklUX1JFR19Q
V1JHVF9DVFJMKTsKPiAgIAljdHJsICY9IH5tYXNrOwo+ICAgCWN0cmwgfD0gc3RhdGU7Cj4gLQl2
bHZfcHVuaXRfd3JpdGUoZGV2X3ByaXYsIFBVTklUX1JFR19QV1JHVF9DVFJMLCBjdHJsKTsKPiAr
CXZsdl9wdW5pdF93cml0ZShpOTE1LCBQVU5JVF9SRUdfUFdSR1RfQ1RSTCwgY3RybCk7Cj4gICAK
PiAgIAlpZiAod2FpdF9mb3IoQ09ORCwgMTAwKSkKPiAgIAkJRFJNX0VSUk9SKCJ0aW1lb3V0IHNl
dHRpbmcgcG93ZXIgd2VsbCBzdGF0ZSAlMDh4ICglMDh4KVxuIiwKPiAgIAkJCSAgc3RhdGUsCj4g
LQkJCSAgdmx2X3B1bml0X3JlYWQoZGV2X3ByaXYsIFBVTklUX1JFR19QV1JHVF9DVFJMKSk7Cj4g
KwkJCSAgdmx2X3B1bml0X3JlYWQoaTkxNSwgUFVOSVRfUkVHX1BXUkdUX0NUUkwpKTsKPiAgIAo+
ICAgI3VuZGVmIENPTkQKPiAgIAo+ICAgb3V0Ogo+IC0Jdmx2X3B1bml0X3B1dChkZXZfcHJpdik7
Cj4gKwl2bHZfcHVuaXRfcHV0KGk5MTUpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIHZsdl9w
b3dlcl93ZWxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0
YXRpYyB2b2lkIHZsdl9wb3dlcl93ZWxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiAgIAkJCQkgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4gICB7
Cj4gLQl2bHZfc2V0X3Bvd2VyX3dlbGwoZGV2X3ByaXYsIHBvd2VyX3dlbGwsIHRydWUpOwo+ICsJ
dmx2X3NldF9wb3dlcl93ZWxsKGk5MTUsIHBvd2VyX3dlbGwsIHRydWUpOwo+ICAgfQo+ICAgCj4g
LXN0YXRpYyB2b2lkIHZsdl9wb3dlcl93ZWxsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCB2bHZfcG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgIHN0cnVjdCBpOTE1X3Bvd2VyX3dl
bGwgKnBvd2VyX3dlbGwpCj4gICB7Cj4gLQl2bHZfc2V0X3Bvd2VyX3dlbGwoZGV2X3ByaXYsIHBv
d2VyX3dlbGwsIGZhbHNlKTsKPiArCXZsdl9zZXRfcG93ZXJfd2VsbChpOTE1LCBwb3dlcl93ZWxs
LCBmYWxzZSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGJvb2wgdmx2X3Bvd2VyX3dlbGxfZW5hYmxl
ZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBib29sIHZsdl9w
b3dlcl93ZWxsX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJ
ICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKPiAgIHsKPiAgIAlpbnQgcHdf
aWR4ID0gcG93ZXJfd2VsbC0+ZGVzYy0+dmx2LmlkeDsKPiBAQCAtOTU2LDkgKzk1Niw5IEBAIHN0
YXRpYyBib29sIHZsdl9wb3dlcl93ZWxsX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICAgCW1hc2sgPSBQVU5JVF9QV1JHVF9NQVNLKHB3X2lkeCk7Cj4gICAJY3Ry
bCA9IFBVTklUX1BXUkdUX1BXUl9PTihwd19pZHgpOwo+ICAgCj4gLQl2bHZfcHVuaXRfZ2V0KGRl
dl9wcml2KTsKPiArCXZsdl9wdW5pdF9nZXQoaTkxNSk7Cj4gICAKPiAtCXN0YXRlID0gdmx2X3B1
bml0X3JlYWQoZGV2X3ByaXYsIFBVTklUX1JFR19QV1JHVF9TVEFUVVMpICYgbWFzazsKPiArCXN0
YXRlID0gdmx2X3B1bml0X3JlYWQoaTkxNSwgUFVOSVRfUkVHX1BXUkdUX1NUQVRVUykgJiBtYXNr
Owo+ICAgCS8qCj4gICAJICogV2Ugb25seSBldmVyIHNldCB0aGUgcG93ZXItb24gYW5kIHBvd2Vy
LWdhdGUgc3RhdGVzLCBhbnl0aGluZwo+ICAgCSAqIGVsc2UgaXMgdW5leHBlY3RlZC4KPiBAQCAt
OTcyLDE1ICs5NzIsMTUgQEAgc3RhdGljIGJvb2wgdmx2X3Bvd2VyX3dlbGxfZW5hYmxlZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJICogQSB0cmFuc2llbnQgc3RhdGUg
YXQgdGhpcyBwb2ludCB3b3VsZCBtZWFuIHNvbWUgdW5leHBlY3RlZCBwYXJ0eQo+ICAgCSAqIGlz
IHBva2luZyBhdCB0aGUgcG93ZXIgY29udHJvbHMgdG9vLgo+ICAgCSAqLwo+IC0JY3RybCA9IHZs
dl9wdW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfUFdSR1RfQ1RSTCkgJiBtYXNrOwo+ICsJ
Y3RybCA9IHZsdl9wdW5pdF9yZWFkKGk5MTUsIFBVTklUX1JFR19QV1JHVF9DVFJMKSAmIG1hc2s7
Cj4gICAJV0FSTl9PTihjdHJsICE9IHN0YXRlKTsKPiAgIAo+IC0Jdmx2X3B1bml0X3B1dChkZXZf
cHJpdik7Cj4gKwl2bHZfcHVuaXRfcHV0KGk5MTUpOwo+ICAgCj4gICAJcmV0dXJuIGVuYWJsZWQ7
Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgdmx2X2luaXRfZGlzcGxheV9jbG9ja19nYXRpbmco
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCB2bHZfaW5p
dF9kaXNwbGF5X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAg
IHsKPiAgIAl1MzIgdmFsOwo+ICAgCj4gQEAgLTEwMDEsMTMgKzEwMDEsMTMgQEAgc3RhdGljIHZv
aWQgdmx2X2luaXRfZGlzcGxheV9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICAgCUk5MTVfV1JJVEUoTUlfQVJCX1ZMViwgTUlfQVJCX0RJU1BMQVlfVFJJ
Q0tMRV9GRUVEX0RJU0FCTEUpOwo+ICAgCUk5MTVfV1JJVEUoQ0JSMV9WTFYsIDApOwo+ICAgCj4g
LQlXQVJOX09OKGRldl9wcml2LT5yYXdjbGtfZnJlcSA9PSAwKTsKPiArCVdBUk5fT04oaTkxNS0+
cmF3Y2xrX2ZyZXEgPT0gMCk7Cj4gICAKPiAgIAlJOTE1X1dSSVRFKFJBV0NMS19GUkVRX1ZMViwK
PiAtCQkgICBESVZfUk9VTkRfQ0xPU0VTVChkZXZfcHJpdi0+cmF3Y2xrX2ZyZXEsIDEwMDApKTsK
PiArCQkgICBESVZfUk9VTkRfQ0xPU0VTVChpOTE1LT5yYXdjbGtfZnJlcSwgMTAwMCkpOwo+ICAg
fQo+ICAgCj4gLXN0YXRpYyB2b2lkIHZsdl9kaXNwbGF5X3Bvd2VyX3dlbGxfaW5pdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIHZsdl9kaXNwbGF5X3Bv
d2VyX3dlbGxfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAlz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcjsKPiAgIAllbnVtIHBpcGUgcGlwZTsKPiBAQCAt
MTAyMCw3ICsxMDIwLDcgQEAgc3RhdGljIHZvaWQgdmx2X2Rpc3BsYXlfcG93ZXJfd2VsbF9pbml0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkgKgo+ICAgCSAqIENIViBE
UExMIEIvQyBoYXZlIHNvbWUgaXNzdWVzIGlmIFZHQSBtb2RlIGlzIGVuYWJsZWQuCj4gICAJICov
Cj4gLQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKSB7Cj4gKwlmb3JfZWFjaF9waXBlKGk5
MTUsIHBpcGUpIHsKPiAgIAkJdTMyIHZhbCA9IEk5MTVfUkVBRChEUExMKHBpcGUpKTsKPiAgIAo+
ICAgCQl2YWwgfD0gRFBMTF9SRUZfQ0xLX0VOQUJMRV9WTFYgfCBEUExMX1ZHQV9NT0RFX0RJUzsK
PiBAQCAtMTAzMCw3MSArMTAzMCw3MSBAQCBzdGF0aWMgdm9pZCB2bHZfZGlzcGxheV9wb3dlcl93
ZWxsX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQlJOTE1X1dS
SVRFKERQTEwocGlwZSksIHZhbCk7Cj4gICAJfQo+ICAgCj4gLQl2bHZfaW5pdF9kaXNwbGF5X2Ns
b2NrX2dhdGluZyhkZXZfcHJpdik7Cj4gKwl2bHZfaW5pdF9kaXNwbGF5X2Nsb2NrX2dhdGluZyhp
OTE1KTsKPiAgIAo+IC0Jc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiAtCXZh
bGxleXZpZXdfZW5hYmxlX2Rpc3BsYXlfaXJxcyhkZXZfcHJpdik7Cj4gLQlzcGluX3VubG9ja19p
cnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gKwlzcGluX2xvY2tfaXJxKCZpOTE1LT5pcnFfbG9j
ayk7Cj4gKwl2YWxsZXl2aWV3X2VuYWJsZV9kaXNwbGF5X2lycXMoaTkxNSk7Cj4gKwlzcGluX3Vu
bG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiAgIAo+ICAgCS8qCj4gICAJICogRHVyaW5nIGRy
aXZlciBpbml0aWFsaXphdGlvbi9yZXN1bWUgd2UgY2FuIGF2b2lkIHJlc3RvcmluZyB0aGUKPiAg
IAkgKiBwYXJ0IG9mIHRoZSBIVy9TVyBzdGF0ZSB0aGF0IHdpbGwgYmUgaW5pdGVkIGFueXdheSBl
eHBsaWNpdGx5Lgo+ICAgCSAqLwo+IC0JaWYgKGRldl9wcml2LT5wb3dlcl9kb21haW5zLmluaXRp
YWxpemluZykKPiArCWlmIChpOTE1LT5wb3dlcl9kb21haW5zLmluaXRpYWxpemluZykKPiAgIAkJ
cmV0dXJuOwo+ICAgCj4gLQlpbnRlbF9ocGRfaW5pdChkZXZfcHJpdik7Cj4gKwlpbnRlbF9ocGRf
aW5pdChpOTE1KTsKPiAgIAo+ICAgCS8qIFJlLWVuYWJsZSB0aGUgQURQQSwgaWYgd2UgaGF2ZSBv
bmUgKi8KPiAtCWZvcl9lYWNoX2ludGVsX2VuY29kZXIoJmRldl9wcml2LT5kcm0sIGVuY29kZXIp
IHsKPiArCWZvcl9lYWNoX2ludGVsX2VuY29kZXIoJmk5MTUtPmRybSwgZW5jb2Rlcikgewo+ICAg
CQlpZiAoZW5jb2Rlci0+dHlwZSA9PSBJTlRFTF9PVVRQVVRfQU5BTE9HKQo+ICAgCQkJaW50ZWxf
Y3J0X3Jlc2V0KCZlbmNvZGVyLT5iYXNlKTsKPiAgIAl9Cj4gICAKPiAtCWk5MTVfcmVkaXNhYmxl
X3ZnYV9wb3dlcl9vbihkZXZfcHJpdik7Cj4gKwlpOTE1X3JlZGlzYWJsZV92Z2FfcG93ZXJfb24o
aTkxNSk7Cj4gICAKPiAtCWludGVsX3Bwc191bmxvY2tfcmVnc193YShkZXZfcHJpdik7Cj4gKwlp
bnRlbF9wcHNfdW5sb2NrX3JlZ3Nfd2EoaTkxNSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQg
dmx2X2Rpc3BsYXlfcG93ZXJfd2VsbF9kZWluaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ICtzdGF0aWMgdm9pZCB2bHZfZGlzcGxheV9wb3dlcl93ZWxsX2RlaW5pdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXNwaW5fbG9ja19pcnEoJmRldl9w
cml2LT5pcnFfbG9jayk7Cj4gLQl2YWxsZXl2aWV3X2Rpc2FibGVfZGlzcGxheV9pcnFzKGRldl9w
cml2KTsKPiAtCXNwaW5fdW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiArCXNwaW5f
bG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiArCXZhbGxleXZpZXdfZGlzYWJsZV9kaXNwbGF5
X2lycXMoaTkxNSk7Cj4gKwlzcGluX3VubG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiAgIAo+
ICAgCS8qIG1ha2Ugc3VyZSB3ZSdyZSBkb25lIHByb2Nlc3NpbmcgZGlzcGxheSBpcnFzICovCj4g
LQlzeW5jaHJvbml6ZV9pcnEoZGV2X3ByaXYtPmRybS5pcnEpOwo+ICsJc3luY2hyb25pemVfaXJx
KGk5MTUtPmRybS5pcnEpOwo+ICAgCj4gLQlpbnRlbF9wb3dlcl9zZXF1ZW5jZXJfcmVzZXQoZGV2
X3ByaXYpOwo+ICsJaW50ZWxfcG93ZXJfc2VxdWVuY2VyX3Jlc2V0KGk5MTUpOwo+ICAgCj4gICAJ
LyogUHJldmVudCB1cyBmcm9tIHJlLWVuYWJsaW5nIHBvbGxpbmcgb24gYWNjaWRlbnQgaW4gbGF0
ZSBzdXNwZW5kICovCj4gLQlpZiAoIWRldl9wcml2LT5kcm0uZGV2LT5wb3dlci5pc19zdXNwZW5k
ZWQpCj4gLQkJaW50ZWxfaHBkX3BvbGxfaW5pdChkZXZfcHJpdik7Cj4gKwlpZiAoIWk5MTUtPmRy
bS5kZXYtPnBvd2VyLmlzX3N1c3BlbmRlZCkKPiArCQlpbnRlbF9ocGRfcG9sbF9pbml0KGk5MTUp
Owo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIHZsdl9kaXNwbGF5X3Bvd2VyX3dlbGxfZW5hYmxl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgdmx2X2Rp
c3BsYXlfcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
ICAJCQkJCSAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKPiAgIHsKPiAtCXZs
dl9zZXRfcG93ZXJfd2VsbChkZXZfcHJpdiwgcG93ZXJfd2VsbCwgdHJ1ZSk7Cj4gKwl2bHZfc2V0
X3Bvd2VyX3dlbGwoaTkxNSwgcG93ZXJfd2VsbCwgdHJ1ZSk7Cj4gICAKPiAtCXZsdl9kaXNwbGF5
X3Bvd2VyX3dlbGxfaW5pdChkZXZfcHJpdik7Cj4gKwl2bHZfZGlzcGxheV9wb3dlcl93ZWxsX2lu
aXQoaTkxNSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgdmx2X2Rpc3BsYXlfcG93ZXJfd2Vs
bF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZv
aWQgdmx2X2Rpc3BsYXlfcG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAo+ICAgCQkJCQkgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQo+
ICAgewo+IC0Jdmx2X2Rpc3BsYXlfcG93ZXJfd2VsbF9kZWluaXQoZGV2X3ByaXYpOwo+ICsJdmx2
X2Rpc3BsYXlfcG93ZXJfd2VsbF9kZWluaXQoaTkxNSk7Cj4gICAKPiAtCXZsdl9zZXRfcG93ZXJf
d2VsbChkZXZfcHJpdiwgcG93ZXJfd2VsbCwgZmFsc2UpOwo+ICsJdmx2X3NldF9wb3dlcl93ZWxs
KGk5MTUsIHBvd2VyX3dlbGwsIGZhbHNlKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCB2bHZf
ZHBpb19jbW5fcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ICtzdGF0aWMgdm9pZCB2bHZfZHBpb19jbW5fcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJCSAgIHN0cnVjdCBpOTE1X3Bvd2VyX3dl
bGwgKnBvd2VyX3dlbGwpCj4gICB7Cj4gICAJLyogc2luY2UgcmVmL2NyaSBjbG9jayB3YXMgZW5h
YmxlZCAqLwo+ICAgCXVkZWxheSgxKTsgLyogPjEwbnMgZm9yIGNtbnJlc2V0LCA+MG5zIGZvciBz
aWRlcmVzZXQgKi8KPiAgIAo+IC0Jdmx2X3NldF9wb3dlcl93ZWxsKGRldl9wcml2LCBwb3dlcl93
ZWxsLCB0cnVlKTsKPiArCXZsdl9zZXRfcG93ZXJfd2VsbChpOTE1LCBwb3dlcl93ZWxsLCB0cnVl
KTsKPiAgIAo+ICAgCS8qCj4gICAJICogRnJvbSBWTFYyQTBfRFBfZURQX0RQSU9fZHJpdmVyX3Zi
aW9zX25vdGVzXzEwLmRvY3ggLQo+IEBAIC0xMTEwLDMxICsxMTEwLDMxIEBAIHN0YXRpYyB2b2lk
IHZsdl9kcGlvX2Ntbl9wb3dlcl93ZWxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gICAJSTkxNV9XUklURShEUElPX0NUTCwgSTkxNV9SRUFEKERQSU9fQ1RMKSB8
IERQSU9fQ01OUlNUKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCB2bHZfZHBpb19jbW5fcG93
ZXJfd2VsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3Rh
dGljIHZvaWQgdmx2X2RwaW9fY21uX3Bvd2VyX3dlbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkJICAgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2Vy
X3dlbGwpCj4gICB7Cj4gICAJZW51bSBwaXBlIHBpcGU7Cj4gICAKPiAtCWZvcl9lYWNoX3BpcGUo
ZGV2X3ByaXYsIHBpcGUpCj4gLQkJYXNzZXJ0X3BsbF9kaXNhYmxlZChkZXZfcHJpdiwgcGlwZSk7
Cj4gKwlmb3JfZWFjaF9waXBlKGk5MTUsIHBpcGUpCj4gKwkJYXNzZXJ0X3BsbF9kaXNhYmxlZChp
OTE1LCBwaXBlKTsKPiAgIAo+ICAgCS8qIEFzc2VydCBjb21tb24gcmVzZXQgKi8KPiAgIAlJOTE1
X1dSSVRFKERQSU9fQ1RMLCBJOTE1X1JFQUQoRFBJT19DVEwpICYgfkRQSU9fQ01OUlNUKTsKPiAg
IAo+IC0Jdmx2X3NldF9wb3dlcl93ZWxsKGRldl9wcml2LCBwb3dlcl93ZWxsLCBmYWxzZSk7Cj4g
Kwl2bHZfc2V0X3Bvd2VyX3dlbGwoaTkxNSwgcG93ZXJfd2VsbCwgZmFsc2UpOwo+ICAgfQo+ICAg
Cj4gICAjZGVmaW5lIFBPV0VSX0RPTUFJTl9NQVNLIChHRU5NQVNLX1VMTChQT1dFUl9ET01BSU5f
TlVNIC0gMSwgMCkpCj4gICAKPiAgICNkZWZpbmUgQklUU19TRVQodmFsLCBiaXRzKSAoKCh2YWwp
ICYgKGJpdHMpKSA9PSAoYml0cykpCj4gICAKPiAtc3RhdGljIHZvaWQgYXNzZXJ0X2Nodl9waHlf
c3RhdHVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQg
YXNzZXJ0X2Nodl9waHlfc3RhdHVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAg
ewo+ICAgCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKmNtbl9iYyA9Cj4gLQkJbG9va3VwX3Bvd2Vy
X3dlbGwoZGV2X3ByaXYsIFZMVl9ESVNQX1BXX0RQSU9fQ01OX0JDKTsKPiArCQlsb29rdXBfcG93
ZXJfd2VsbChpOTE1LCBWTFZfRElTUF9QV19EUElPX0NNTl9CQyk7Cj4gICAJc3RydWN0IGk5MTVf
cG93ZXJfd2VsbCAqY21uX2QgPQo+IC0JCWxvb2t1cF9wb3dlcl93ZWxsKGRldl9wcml2LCBDSFZf
RElTUF9QV19EUElPX0NNTl9EKTsKPiAtCXUzMiBwaHlfY29udHJvbCA9IGRldl9wcml2LT5jaHZf
cGh5X2NvbnRyb2w7Cj4gKwkJbG9va3VwX3Bvd2VyX3dlbGwoaTkxNSwgQ0hWX0RJU1BfUFdfRFBJ
T19DTU5fRCk7Cj4gKwl1MzIgcGh5X2NvbnRyb2wgPSBpOTE1LT5jaHZfcGh5X2NvbnRyb2w7Cj4g
ICAJdTMyIHBoeV9zdGF0dXMgPSAwOwo+ICAgCXUzMiBwaHlfc3RhdHVzX21hc2sgPSAweGZmZmZm
ZmZmOwo+ICAgCj4gQEAgLTExNDUsNyArMTE0NSw3IEBAIHN0YXRpYyB2b2lkIGFzc2VydF9jaHZf
cGh5X3N0YXR1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICogcmVz
ZXQgKGllLiB0aGUgcG93ZXIgd2VsbCBoYXMgYmVlbiBkaXNhYmxlZCBhdAo+ICAgCSAqIGxlYXN0
IG9uY2UpLgo+ICAgCSAqLwo+IC0JaWYgKCFkZXZfcHJpdi0+Y2h2X3BoeV9hc3NlcnRbRFBJT19Q
SFkwXSkKPiArCWlmICghaTkxNS0+Y2h2X3BoeV9hc3NlcnRbRFBJT19QSFkwXSkKPiAgIAkJcGh5
X3N0YXR1c19tYXNrICY9IH4oUEhZX1NUQVRVU19DTU5fTERPKERQSU9fUEhZMCwgRFBJT19DSDAp
IHwKPiAgIAkJCQkgICAgIFBIWV9TVEFUVVNfU1BMSU5FX0xETyhEUElPX1BIWTAsIERQSU9fQ0gw
LCAwKSB8Cj4gICAJCQkJICAgICBQSFlfU1RBVFVTX1NQTElORV9MRE8oRFBJT19QSFkwLCBEUElP
X0NIMCwgMSkgfAo+IEBAIC0xMTUzLDEyICsxMTUzLDEyIEBAIHN0YXRpYyB2b2lkIGFzc2VydF9j
aHZfcGh5X3N0YXR1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCQkJ
ICAgICBQSFlfU1RBVFVTX1NQTElORV9MRE8oRFBJT19QSFkwLCBEUElPX0NIMSwgMCkgfAo+ICAg
CQkJCSAgICAgUEhZX1NUQVRVU19TUExJTkVfTERPKERQSU9fUEhZMCwgRFBJT19DSDEsIDEpKTsK
PiAgIAo+IC0JaWYgKCFkZXZfcHJpdi0+Y2h2X3BoeV9hc3NlcnRbRFBJT19QSFkxXSkKPiArCWlm
ICghaTkxNS0+Y2h2X3BoeV9hc3NlcnRbRFBJT19QSFkxXSkKPiAgIAkJcGh5X3N0YXR1c19tYXNr
ICY9IH4oUEhZX1NUQVRVU19DTU5fTERPKERQSU9fUEhZMSwgRFBJT19DSDApIHwKPiAgIAkJCQkg
ICAgIFBIWV9TVEFUVVNfU1BMSU5FX0xETyhEUElPX1BIWTEsIERQSU9fQ0gwLCAwKSB8Cj4gICAJ
CQkJICAgICBQSFlfU1RBVFVTX1NQTElORV9MRE8oRFBJT19QSFkxLCBEUElPX0NIMCwgMSkpOwo+
ICAgCj4gLQlpZiAoY21uX2JjLT5kZXNjLT5vcHMtPmlzX2VuYWJsZWQoZGV2X3ByaXYsIGNtbl9i
YykpIHsKPiArCWlmIChjbW5fYmMtPmRlc2MtPm9wcy0+aXNfZW5hYmxlZChpOTE1LCBjbW5fYmMp
KSB7Cj4gICAJCXBoeV9zdGF0dXMgfD0gUEhZX1BPV0VSR09PRChEUElPX1BIWTApOwo+ICAgCj4g
ICAJCS8qIHRoaXMgYXNzdW1lcyBvdmVycmlkZSBpcyBvbmx5IHVzZWQgdG8gZW5hYmxlIGxhbmVz
ICovCj4gQEAgLTExOTksNyArMTE5OSw3IEBAIHN0YXRpYyB2b2lkIGFzc2VydF9jaHZfcGh5X3N0
YXR1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCQlwaHlfc3RhdHVz
IHw9IFBIWV9TVEFUVVNfU1BMSU5FX0xETyhEUElPX1BIWTAsIERQSU9fQ0gxLCAxKTsKPiAgIAl9
Cj4gICAKPiAtCWlmIChjbW5fZC0+ZGVzYy0+b3BzLT5pc19lbmFibGVkKGRldl9wcml2LCBjbW5f
ZCkpIHsKPiArCWlmIChjbW5fZC0+ZGVzYy0+b3BzLT5pc19lbmFibGVkKGk5MTUsIGNtbl9kKSkg
ewo+ICAgCQlwaHlfc3RhdHVzIHw9IFBIWV9QT1dFUkdPT0QoRFBJT19QSFkxKTsKPiAgIAo+ICAg
CQkvKiB0aGlzIGFzc3VtZXMgb3ZlcnJpZGUgaXMgb25seSB1c2VkIHRvIGVuYWJsZSBsYW5lcyAq
Lwo+IEBAIC0xMjI0LDE5ICsxMjI0LDE5IEBAIHN0YXRpYyB2b2lkIGFzc2VydF9jaHZfcGh5X3N0
YXR1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICogVGhlIFBIWSBt
YXkgYmUgYnVzeSB3aXRoIHNvbWUgaW5pdGlhbCBjYWxpYnJhdGlvbiBhbmQgd2hhdG5vdCwKPiAg
IAkgKiBzbyB0aGUgcG93ZXIgc3RhdGUgY2FuIHRha2UgYSB3aGlsZSB0byBhY3R1YWxseSBjaGFu
Z2UuCj4gICAJICovCj4gLQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51
bmNvcmUsCj4gKwlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiAg
IAkJCQkgICAgRElTUExBWV9QSFlfU1RBVFVTLAo+ICAgCQkJCSAgICBwaHlfc3RhdHVzX21hc2ss
Cj4gICAJCQkJICAgIHBoeV9zdGF0dXMsCj4gICAJCQkJICAgIDEwKSkKPiAgIAkJRFJNX0VSUk9S
KCJVbmV4cGVjdGVkIFBIWV9TVEFUVVMgMHglMDh4LCBleHBlY3RlZCAweCUwOHggKFBIWV9DT05U
Uk9MPTB4JTA4eClcbiIsCj4gICAJCQkgIEk5MTVfUkVBRChESVNQTEFZX1BIWV9TVEFUVVMpICYg
cGh5X3N0YXR1c19tYXNrLAo+IC0JCQkgICBwaHlfc3RhdHVzLCBkZXZfcHJpdi0+Y2h2X3BoeV9j
b250cm9sKTsKPiArCQkJICAgcGh5X3N0YXR1cywgaTkxNS0+Y2h2X3BoeV9jb250cm9sKTsKPiAg
IH0KPiAgIAo+ICAgI3VuZGVmIEJJVFNfU0VUCj4gICAKPiAtc3RhdGljIHZvaWQgY2h2X2RwaW9f
Y21uX3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiArc3RhdGljIHZvaWQgY2h2X2RwaW9fY21uX3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCQkgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpw
b3dlcl93ZWxsKQo+ICAgewo+ICAgCWVudW0gZHBpb19waHkgcGh5Owo+IEBAIC0xMjU2LDUxICsx
MjU2LDUxIEBAIHN0YXRpYyB2b2lkIGNodl9kcGlvX2Ntbl9wb3dlcl93ZWxsX2VuYWJsZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAKPiAgIAkvKiBzaW5jZSByZWYvY3Jp
IGNsb2NrIHdhcyBlbmFibGVkICovCj4gICAJdWRlbGF5KDEpOyAvKiA+MTBucyBmb3IgY21ucmVz
ZXQsID4wbnMgZm9yIHNpZGVyZXNldCAqLwo+IC0Jdmx2X3NldF9wb3dlcl93ZWxsKGRldl9wcml2
LCBwb3dlcl93ZWxsLCB0cnVlKTsKPiArCXZsdl9zZXRfcG93ZXJfd2VsbChpOTE1LCBwb3dlcl93
ZWxsLCB0cnVlKTsKPiAgIAo+ICAgCS8qIFBvbGwgZm9yIHBoeXB3cmdvb2Qgc2lnbmFsICovCj4g
LQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gKwlpZiAo
aW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiAgIAkJCQkgICAgRElTUExB
WV9QSFlfU1RBVFVTLAo+ICAgCQkJCSAgICBQSFlfUE9XRVJHT09EKHBoeSksCj4gICAJCQkJICAg
IFBIWV9QT1dFUkdPT0QocGh5KSwKPiAgIAkJCQkgICAgMSkpCj4gICAJCURSTV9FUlJPUigiRGlz
cGxheSBQSFkgJWQgaXMgbm90IHBvd2VyIHVwXG4iLCBwaHkpOwo+ICAgCj4gLQl2bHZfZHBpb19n
ZXQoZGV2X3ByaXYpOwo+ICsJdmx2X2RwaW9fZ2V0KGk5MTUpOwo+ICAgCj4gICAJLyogRW5hYmxl
IGR5bmFtaWMgcG93ZXIgZG93biAqLwo+IC0JdG1wID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwg
cGlwZSwgQ0hWX0NNTl9EVzI4KTsKPiArCXRtcCA9IHZsdl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwg
Q0hWX0NNTl9EVzI4KTsKPiAgIAl0bXAgfD0gRFBJT19EWU5QV1JET1dORU5fQ0gwIHwgRFBJT19D
TDFQT1dFUkRPV05FTiB8Cj4gICAJCURQSU9fU1VTX0NMS19DT05GSUdfR0FURV9DTEtSRVE7Cj4g
LQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgQ0hWX0NNTl9EVzI4LCB0bXApOwo+ICsJ
dmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgQ0hWX0NNTl9EVzI4LCB0bXApOwo+ICAgCj4gICAJ
aWYgKHBvd2VyX3dlbGwtPmRlc2MtPmlkID09IFZMVl9ESVNQX1BXX0RQSU9fQ01OX0JDKSB7Cj4g
LQkJdG1wID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgX0NIVl9DTU5fRFc2X0NIMSk7
Cj4gKwkJdG1wID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBfQ0hWX0NNTl9EVzZfQ0gxKTsK
PiAgIAkJdG1wIHw9IERQSU9fRFlOUFdSRE9XTkVOX0NIMTsKPiAtCQl2bHZfZHBpb193cml0ZShk
ZXZfcHJpdiwgcGlwZSwgX0NIVl9DTU5fRFc2X0NIMSwgdG1wKTsKPiArCQl2bHZfZHBpb193cml0
ZShpOTE1LCBwaXBlLCBfQ0hWX0NNTl9EVzZfQ0gxLCB0bXApOwo+ICAgCX0gZWxzZSB7Cj4gICAJ
CS8qCj4gICAJCSAqIEZvcmNlIHRoZSBub24tZXhpc3RpbmcgQ0wyIG9mZi4gQlhUIGRvZXMgdGhp
cwo+ICAgCQkgKiB0b28sIHNvIG1heWJlIGl0IHNhdmVzIHNvbWUgcG93ZXIgZXZlbiB0aG91Z2gK
PiAgIAkJICogQ0wyIGRvZXNuJ3QgZXhpc3Q/Cj4gICAJCSAqLwo+IC0JCXRtcCA9IHZsdl9kcGlv
X3JlYWQoZGV2X3ByaXYsIHBpcGUsIENIVl9DTU5fRFczMCk7Cj4gKwkJdG1wID0gdmx2X2RwaW9f
cmVhZChpOTE1LCBwaXBlLCBDSFZfQ01OX0RXMzApOwo+ICAgCQl0bXAgfD0gRFBJT19DTDJfTERP
RlVTRV9QV1JFTkI7Cj4gLQkJdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIENIVl9DTU5f
RFczMCwgdG1wKTsKPiArCQl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBDSFZfQ01OX0RXMzAs
IHRtcCk7Cj4gICAJfQo+ICAgCj4gLQl2bHZfZHBpb19wdXQoZGV2X3ByaXYpOwo+ICsJdmx2X2Rw
aW9fcHV0KGk5MTUpOwo+ICAgCj4gLQlkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sIHw9IFBIWV9D
T01fTEFORV9SRVNFVF9ERUFTU0VSVChwaHkpOwo+IC0JSTkxNV9XUklURShESVNQTEFZX1BIWV9D
T05UUk9MLCBkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sKTsKPiArCWk5MTUtPmNodl9waHlfY29u
dHJvbCB8PSBQSFlfQ09NX0xBTkVfUkVTRVRfREVBU1NFUlQocGh5KTsKPiArCUk5MTVfV1JJVEUo
RElTUExBWV9QSFlfQ09OVFJPTCwgaTkxNS0+Y2h2X3BoeV9jb250cm9sKTsKPiAgIAo+ICAgCURS
TV9ERUJVR19LTVMoIkVuYWJsZWQgRFBJTyBQSFklZCAoUEhZX0NPTlRST0w9MHglMDh4KVxuIiwK
PiAtCQkgICAgICBwaHksIGRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wpOwo+ICsJCSAgICAgIHBo
eSwgaTkxNS0+Y2h2X3BoeV9jb250cm9sKTsKPiAgIAo+IC0JYXNzZXJ0X2Nodl9waHlfc3RhdHVz
KGRldl9wcml2KTsKPiArCWFzc2VydF9jaHZfcGh5X3N0YXR1cyhpOTE1KTsKPiAgIH0KPiAgIAo+
IC1zdGF0aWMgdm9pZCBjaHZfZHBpb19jbW5fcG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgY2h2X2RwaW9fY21uX3Bvd2Vy
X3dlbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkJICAg
IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4gICB7Cj4gICAJZW51bSBkcGlv
X3BoeSBwaHk7Cj4gQEAgLTEzMTAsMjggKzEzMTAsMjggQEAgc3RhdGljIHZvaWQgY2h2X2RwaW9f
Y21uX3Bvd2VyX3dlbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gICAKPiAgIAlpZiAocG93ZXJfd2VsbC0+ZGVzYy0+aWQgPT0gVkxWX0RJU1BfUFdfRFBJT19D
TU5fQkMpIHsKPiAgIAkJcGh5ID0gRFBJT19QSFkwOwo+IC0JCWFzc2VydF9wbGxfZGlzYWJsZWQo
ZGV2X3ByaXYsIFBJUEVfQSk7Cj4gLQkJYXNzZXJ0X3BsbF9kaXNhYmxlZChkZXZfcHJpdiwgUElQ
RV9CKTsKPiArCQlhc3NlcnRfcGxsX2Rpc2FibGVkKGk5MTUsIFBJUEVfQSk7Cj4gKwkJYXNzZXJ0
X3BsbF9kaXNhYmxlZChpOTE1LCBQSVBFX0IpOwo+ICAgCX0gZWxzZSB7Cj4gICAJCXBoeSA9IERQ
SU9fUEhZMTsKPiAtCQlhc3NlcnRfcGxsX2Rpc2FibGVkKGRldl9wcml2LCBQSVBFX0MpOwo+ICsJ
CWFzc2VydF9wbGxfZGlzYWJsZWQoaTkxNSwgUElQRV9DKTsKPiAgIAl9Cj4gICAKPiAtCWRldl9w
cml2LT5jaHZfcGh5X2NvbnRyb2wgJj0gflBIWV9DT01fTEFORV9SRVNFVF9ERUFTU0VSVChwaHkp
Owo+IC0JSTkxNV9XUklURShESVNQTEFZX1BIWV9DT05UUk9MLCBkZXZfcHJpdi0+Y2h2X3BoeV9j
b250cm9sKTsKPiArCWk5MTUtPmNodl9waHlfY29udHJvbCAmPSB+UEhZX0NPTV9MQU5FX1JFU0VU
X0RFQVNTRVJUKHBoeSk7Cj4gKwlJOTE1X1dSSVRFKERJU1BMQVlfUEhZX0NPTlRST0wsIGk5MTUt
PmNodl9waHlfY29udHJvbCk7Cj4gICAKPiAtCXZsdl9zZXRfcG93ZXJfd2VsbChkZXZfcHJpdiwg
cG93ZXJfd2VsbCwgZmFsc2UpOwo+ICsJdmx2X3NldF9wb3dlcl93ZWxsKGk5MTUsIHBvd2VyX3dl
bGwsIGZhbHNlKTsKPiAgIAo+ICAgCURSTV9ERUJVR19LTVMoIkRpc2FibGVkIERQSU8gUEhZJWQg
KFBIWV9DT05UUk9MPTB4JTA4eClcbiIsCj4gLQkJICAgICAgcGh5LCBkZXZfcHJpdi0+Y2h2X3Bo
eV9jb250cm9sKTsKPiArCQkgICAgICBwaHksIGk5MTUtPmNodl9waHlfY29udHJvbCk7Cj4gICAK
PiAgIAkvKiBQSFkgaXMgZnVsbHkgcmVzZXQgbm93LCBzbyB3ZSBjYW4gZW5hYmxlIHRoZSBQSFkg
c3RhdGUgYXNzZXJ0cyAqLwo+IC0JZGV2X3ByaXYtPmNodl9waHlfYXNzZXJ0W3BoeV0gPSB0cnVl
Owo+ICsJaTkxNS0+Y2h2X3BoeV9hc3NlcnRbcGh5XSA9IHRydWU7Cj4gICAKPiAtCWFzc2VydF9j
aHZfcGh5X3N0YXR1cyhkZXZfcHJpdik7Cj4gKwlhc3NlcnRfY2h2X3BoeV9zdGF0dXMoaTkxNSk7
Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgYXNzZXJ0X2Nodl9waHlfcG93ZXJnYXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBkcGlvX3BoeSBwaHksCj4gK3N0YXRp
YyB2b2lkIGFzc2VydF9jaHZfcGh5X3Bvd2VyZ2F0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwgZW51bSBkcGlvX3BoeSBwaHksCj4gICAJCQkJICAgICBlbnVtIGRwaW9fY2hhbm5lbCBj
aCwgYm9vbCBvdmVycmlkZSwgdW5zaWduZWQgaW50IG1hc2spCj4gICB7Cj4gICAJZW51bSBwaXBl
IHBpcGUgPSBwaHkgPT0gRFBJT19QSFkwID8gUElQRV9BIDogUElQRV9DOwo+IEBAIC0xMzQ0LDcg
KzEzNDQsNyBAQCBzdGF0aWMgdm9pZCBhc3NlcnRfY2h2X3BoeV9wb3dlcmdhdGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIGRwaQo+ICAgCSAqIHJlc2V0IChpZS4gdGhl
IHBvd2VyIHdlbGwgaGFzIGJlZW4gZGlzYWJsZWQgYXQKPiAgIAkgKiBsZWFzdCBvbmNlKS4KPiAg
IAkgKi8KPiAtCWlmICghZGV2X3ByaXYtPmNodl9waHlfYXNzZXJ0W3BoeV0pCj4gKwlpZiAoIWk5
MTUtPmNodl9waHlfYXNzZXJ0W3BoeV0pCj4gICAJCXJldHVybjsKPiAgIAo+ICAgCWlmIChjaCA9
PSBEUElPX0NIMCkKPiBAQCAtMTM1Miw5ICsxMzUyLDkgQEAgc3RhdGljIHZvaWQgYXNzZXJ0X2No
dl9waHlfcG93ZXJnYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBk
cGkKPiAgIAllbHNlCj4gICAJCXJlZyA9IF9DSFZfQ01OX0RXNl9DSDE7Cj4gICAKPiAtCXZsdl9k
cGlvX2dldChkZXZfcHJpdik7Cj4gLQl2YWwgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBl
LCByZWcpOwo+IC0Jdmx2X2RwaW9fcHV0KGRldl9wcml2KTsKPiArCXZsdl9kcGlvX2dldChpOTE1
KTsKPiArCXZhbCA9IHZsdl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwgcmVnKTsKPiArCXZsdl9kcGlv
X3B1dChpOTE1KTsKPiAgIAo+ICAgCS8qCj4gICAJICogVGhpcyBhc3N1bWVzICFvdmVycmlkZSBp
cyBvbmx5IHVzZWQgd2hlbiB0aGUgcG9ydCBpcyBkaXNhYmxlZC4KPiBAQCAtMTM5MywzMCArMTM5
MywzMCBAQCBzdGF0aWMgdm9pZCBhc3NlcnRfY2h2X3BoeV9wb3dlcmdhdGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIGRwaQo+ICAgCSAgICAgcmVnLCB2YWwpOwo+ICAg
fQo+ICAgCj4gLWJvb2wgY2h2X3BoeV9wb3dlcmdhdGVfY2goc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LCBlbnVtIGRwaW9fcGh5IHBoeSwKPiArYm9vbCBjaHZfcGh5X3Bvd2VyZ2F0
ZV9jaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBkcGlvX3BoeSBwaHksCj4g
ICAJCQkgIGVudW0gZHBpb19jaGFubmVsIGNoLCBib29sIG92ZXJyaWRlKQo+ICAgewo+IC0Jc3Ry
dWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93ZXJf
ZG9tYWluczsKPiArCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAm
aTkxNS0+cG93ZXJfZG9tYWluczsKPiAgIAlib29sIHdhc19vdmVycmlkZTsKPiAgIAo+ICAgCW11
dGV4X2xvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwo+ICAgCj4gLQl3YXNfb3ZlcnJpZGUgPSBk
ZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sICYgUEhZX0NIX1BPV0VSX0RPV05fT1ZSRF9FTihwaHks
IGNoKTsKPiArCXdhc19vdmVycmlkZSA9IGk5MTUtPmNodl9waHlfY29udHJvbCAmIFBIWV9DSF9Q
T1dFUl9ET1dOX09WUkRfRU4ocGh5LCBjaCk7Cj4gICAKPiAgIAlpZiAob3ZlcnJpZGUgPT0gd2Fz
X292ZXJyaWRlKQo+ICAgCQlnb3RvIG91dDsKPiAgIAo+ICAgCWlmIChvdmVycmlkZSkKPiAtCQlk
ZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sIHw9IFBIWV9DSF9QT1dFUl9ET1dOX09WUkRfRU4ocGh5
LCBjaCk7Cj4gKwkJaTkxNS0+Y2h2X3BoeV9jb250cm9sIHw9IFBIWV9DSF9QT1dFUl9ET1dOX09W
UkRfRU4ocGh5LCBjaCk7Cj4gICAJZWxzZQo+IC0JCWRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wg
Jj0gflBIWV9DSF9QT1dFUl9ET1dOX09WUkRfRU4ocGh5LCBjaCk7Cj4gKwkJaTkxNS0+Y2h2X3Bo
eV9jb250cm9sICY9IH5QSFlfQ0hfUE9XRVJfRE9XTl9PVlJEX0VOKHBoeSwgY2gpOwo+ICAgCj4g
LQlJOTE1X1dSSVRFKERJU1BMQVlfUEhZX0NPTlRST0wsIGRldl9wcml2LT5jaHZfcGh5X2NvbnRy
b2wpOwo+ICsJSTkxNV9XUklURShESVNQTEFZX1BIWV9DT05UUk9MLCBpOTE1LT5jaHZfcGh5X2Nv
bnRyb2wpOwo+ICAgCj4gICAJRFJNX0RFQlVHX0tNUygiUG93ZXIgZ2F0aW5nIERQSU8gUEhZJWQg
Q0glZCAoRFBJT19QSFlfQ09OVFJPTD0weCUwOHgpXG4iLAo+IC0JCSAgICAgIHBoeSwgY2gsIGRl
dl9wcml2LT5jaHZfcGh5X2NvbnRyb2wpOwo+ICsJCSAgICAgIHBoeSwgY2gsIGk5MTUtPmNodl9w
aHlfY29udHJvbCk7Cj4gICAKPiAtCWFzc2VydF9jaHZfcGh5X3N0YXR1cyhkZXZfcHJpdik7Cj4g
Kwlhc3NlcnRfY2h2X3BoeV9zdGF0dXMoaTkxNSk7Cj4gICAKPiAgIG91dDoKPiAgIAltdXRleF91
bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwo+IEBAIC0xNDI3LDQzICsxNDI3LDQzIEBAIGJv
b2wgY2h2X3BoeV9wb3dlcmdhdGVfY2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LCBlbnVtIGRwaW9fcGh5IHBoeSwKPiAgIHZvaWQgY2h2X3BoeV9wb3dlcmdhdGVfbGFuZXMoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkgICAgIGJvb2wgb3ZlcnJpZGUsIHVu
c2lnbmVkIGludCBtYXNrKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gLQlzdHJ1Y3QgaTkxNV9wb3dlcl9k
b21haW5zICpwb3dlcl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOwo+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsK
PiArCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmaTkxNS0+cG93
ZXJfZG9tYWluczsKPiAgIAllbnVtIGRwaW9fcGh5IHBoeSA9IHZsdl9kcG9ydF90b19waHkoZW5j
X3RvX2RpZ19wb3J0KCZlbmNvZGVyLT5iYXNlKSk7Cj4gICAJZW51bSBkcGlvX2NoYW5uZWwgY2gg
PSB2bHZfZHBvcnRfdG9fY2hhbm5lbChlbmNfdG9fZGlnX3BvcnQoJmVuY29kZXItPmJhc2UpKTsK
PiAgIAo+ICAgCW11dGV4X2xvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwo+ICAgCj4gLQlkZXZf
cHJpdi0+Y2h2X3BoeV9jb250cm9sICY9IH5QSFlfQ0hfUE9XRVJfRE9XTl9PVlJEKDB4ZiwgcGh5
LCBjaCk7Cj4gLQlkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sIHw9IFBIWV9DSF9QT1dFUl9ET1dO
X09WUkQobWFzaywgcGh5LCBjaCk7Cj4gKwlpOTE1LT5jaHZfcGh5X2NvbnRyb2wgJj0gflBIWV9D
SF9QT1dFUl9ET1dOX09WUkQoMHhmLCBwaHksIGNoKTsKPiArCWk5MTUtPmNodl9waHlfY29udHJv
bCB8PSBQSFlfQ0hfUE9XRVJfRE9XTl9PVlJEKG1hc2ssIHBoeSwgY2gpOwo+ICAgCj4gICAJaWYg
KG92ZXJyaWRlKQo+IC0JCWRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wgfD0gUEhZX0NIX1BPV0VS
X0RPV05fT1ZSRF9FTihwaHksIGNoKTsKPiArCQlpOTE1LT5jaHZfcGh5X2NvbnRyb2wgfD0gUEhZ
X0NIX1BPV0VSX0RPV05fT1ZSRF9FTihwaHksIGNoKTsKPiAgIAllbHNlCj4gLQkJZGV2X3ByaXYt
PmNodl9waHlfY29udHJvbCAmPSB+UEhZX0NIX1BPV0VSX0RPV05fT1ZSRF9FTihwaHksIGNoKTsK
PiArCQlpOTE1LT5jaHZfcGh5X2NvbnRyb2wgJj0gflBIWV9DSF9QT1dFUl9ET1dOX09WUkRfRU4o
cGh5LCBjaCk7Cj4gICAKPiAtCUk5MTVfV1JJVEUoRElTUExBWV9QSFlfQ09OVFJPTCwgZGV2X3By
aXYtPmNodl9waHlfY29udHJvbCk7Cj4gKwlJOTE1X1dSSVRFKERJU1BMQVlfUEhZX0NPTlRST0ws
IGk5MTUtPmNodl9waHlfY29udHJvbCk7Cj4gICAKPiAgIAlEUk1fREVCVUdfS01TKCJQb3dlciBn
YXRpbmcgRFBJTyBQSFklZCBDSCVkIGxhbmVzIDB4JXggKFBIWV9DT05UUk9MPTB4JTA4eClcbiIs
Cj4gLQkJICAgICAgcGh5LCBjaCwgbWFzaywgZGV2X3ByaXYtPmNodl9waHlfY29udHJvbCk7Cj4g
KwkJICAgICAgcGh5LCBjaCwgbWFzaywgaTkxNS0+Y2h2X3BoeV9jb250cm9sKTsKPiAgIAo+IC0J
YXNzZXJ0X2Nodl9waHlfc3RhdHVzKGRldl9wcml2KTsKPiArCWFzc2VydF9jaHZfcGh5X3N0YXR1
cyhpOTE1KTsKPiAgIAo+IC0JYXNzZXJ0X2Nodl9waHlfcG93ZXJnYXRlKGRldl9wcml2LCBwaHks
IGNoLCBvdmVycmlkZSwgbWFzayk7Cj4gKwlhc3NlcnRfY2h2X3BoeV9wb3dlcmdhdGUoaTkxNSwg
cGh5LCBjaCwgb3ZlcnJpZGUsIG1hc2spOwo+ICAgCj4gICAJbXV0ZXhfdW5sb2NrKCZwb3dlcl9k
b21haW5zLT5sb2NrKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgYm9vbCBjaHZfcGlwZV9wb3dlcl93
ZWxsX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMg
Ym9vbCBjaHZfcGlwZV9wb3dlcl93ZWxsX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCj4gICAJCQkJCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4gICB7
Cj4gICAJZW51bSBwaXBlIHBpcGUgPSBQSVBFX0E7Cj4gICAJYm9vbCBlbmFibGVkOwo+ICAgCXUz
MiBzdGF0ZSwgY3RybDsKPiAgIAo+IC0Jdmx2X3B1bml0X2dldChkZXZfcHJpdik7Cj4gKwl2bHZf
cHVuaXRfZ2V0KGk5MTUpOwo+ICAgCj4gLQlzdGF0ZSA9IHZsdl9wdW5pdF9yZWFkKGRldl9wcml2
LCBQVU5JVF9SRUdfRFNQU1NQTSkgJiBEUF9TU1NfTUFTSyhwaXBlKTsKPiArCXN0YXRlID0gdmx2
X3B1bml0X3JlYWQoaTkxNSwgUFVOSVRfUkVHX0RTUFNTUE0pICYgRFBfU1NTX01BU0socGlwZSk7
Cj4gICAJLyoKPiAgIAkgKiBXZSBvbmx5IGV2ZXIgc2V0IHRoZSBwb3dlci1vbiBhbmQgcG93ZXIt
Z2F0ZSBzdGF0ZXMsIGFueXRoaW5nCj4gICAJICogZWxzZSBpcyB1bmV4cGVjdGVkLgo+IEBAIC0x
NDc1LDE1ICsxNDc1LDE1IEBAIHN0YXRpYyBib29sIGNodl9waXBlX3Bvd2VyX3dlbGxfZW5hYmxl
ZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJICogQSB0cmFuc2llbnQg
c3RhdGUgYXQgdGhpcyBwb2ludCB3b3VsZCBtZWFuIHNvbWUgdW5leHBlY3RlZCBwYXJ0eQo+ICAg
CSAqIGlzIHBva2luZyBhdCB0aGUgcG93ZXIgY29udHJvbHMgdG9vLgo+ICAgCSAqLwo+IC0JY3Ry
bCA9IHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfRFNQU1NQTSkgJiBEUF9TU0Nf
TUFTSyhwaXBlKTsKPiArCWN0cmwgPSB2bHZfcHVuaXRfcmVhZChpOTE1LCBQVU5JVF9SRUdfRFNQ
U1NQTSkgJiBEUF9TU0NfTUFTSyhwaXBlKTsKPiAgIAlXQVJOX09OKGN0cmwgPDwgMTYgIT0gc3Rh
dGUpOwo+ICAgCj4gLQl2bHZfcHVuaXRfcHV0KGRldl9wcml2KTsKPiArCXZsdl9wdW5pdF9wdXQo
aTkxNSk7Cj4gICAKPiAgIAlyZXR1cm4gZW5hYmxlZDsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9p
ZCBjaHZfc2V0X3BpcGVfcG93ZXJfd2VsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gK3N0YXRpYyB2b2lkIGNodl9zZXRfcGlwZV9wb3dlcl93ZWxsKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dl
cl93ZWxsLAo+ICAgCQkJCSAgICBib29sIGVuYWJsZSkKPiAgIHsKPiBAQCAtMTQ5Myw0NCArMTQ5
Myw0NCBAQCBzdGF0aWMgdm9pZCBjaHZfc2V0X3BpcGVfcG93ZXJfd2VsbChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAKPiAgIAlzdGF0ZSA9IGVuYWJsZSA/IERQX1NTU19Q
V1JfT04ocGlwZSkgOiBEUF9TU1NfUFdSX0dBVEUocGlwZSk7Cj4gICAKPiAtCXZsdl9wdW5pdF9n
ZXQoZGV2X3ByaXYpOwo+ICsJdmx2X3B1bml0X2dldChpOTE1KTsKPiAgIAo+ICAgI2RlZmluZSBD
T05EIFwKPiAtCSgodmx2X3B1bml0X3JlYWQoZGV2X3ByaXYsIFBVTklUX1JFR19EU1BTU1BNKSAm
IERQX1NTU19NQVNLKHBpcGUpKSA9PSBzdGF0ZSkKPiArCSgodmx2X3B1bml0X3JlYWQoaTkxNSwg
UFVOSVRfUkVHX0RTUFNTUE0pICYgRFBfU1NTX01BU0socGlwZSkpID09IHN0YXRlKQo+ICAgCj4g
ICAJaWYgKENPTkQpCj4gICAJCWdvdG8gb3V0Owo+ICAgCj4gLQljdHJsID0gdmx2X3B1bml0X3Jl
YWQoZGV2X3ByaXYsIFBVTklUX1JFR19EU1BTU1BNKTsKPiArCWN0cmwgPSB2bHZfcHVuaXRfcmVh
ZChpOTE1LCBQVU5JVF9SRUdfRFNQU1NQTSk7Cj4gICAJY3RybCAmPSB+RFBfU1NDX01BU0socGlw
ZSk7Cj4gICAJY3RybCB8PSBlbmFibGUgPyBEUF9TU0NfUFdSX09OKHBpcGUpIDogRFBfU1NDX1BX
Ul9HQVRFKHBpcGUpOwo+IC0Jdmx2X3B1bml0X3dyaXRlKGRldl9wcml2LCBQVU5JVF9SRUdfRFNQ
U1NQTSwgY3RybCk7Cj4gKwl2bHZfcHVuaXRfd3JpdGUoaTkxNSwgUFVOSVRfUkVHX0RTUFNTUE0s
IGN0cmwpOwo+ICAgCj4gICAJaWYgKHdhaXRfZm9yKENPTkQsIDEwMCkpCj4gICAJCURSTV9FUlJP
UigidGltZW91dCBzZXR0aW5nIHBvd2VyIHdlbGwgc3RhdGUgJTA4eCAoJTA4eClcbiIsCj4gICAJ
CQkgIHN0YXRlLAo+IC0JCQkgIHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfRFNQ
U1NQTSkpOwo+ICsJCQkgIHZsdl9wdW5pdF9yZWFkKGk5MTUsIFBVTklUX1JFR19EU1BTU1BNKSk7
Cj4gICAKPiAgICN1bmRlZiBDT05ECj4gICAKPiAgIG91dDoKPiAtCXZsdl9wdW5pdF9wdXQoZGV2
X3ByaXYpOwo+ICsJdmx2X3B1bml0X3B1dChpOTE1KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9p
ZCBjaHZfcGlwZV9wb3dlcl93ZWxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGNodl9waXBlX3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgICAgICBzdHJ1Y3QgaTkxNV9wb3dlcl93
ZWxsICpwb3dlcl93ZWxsKQo+ICAgewo+IC0JY2h2X3NldF9waXBlX3Bvd2VyX3dlbGwoZGV2X3By
aXYsIHBvd2VyX3dlbGwsIHRydWUpOwo+ICsJY2h2X3NldF9waXBlX3Bvd2VyX3dlbGwoaTkxNSwg
cG93ZXJfd2VsbCwgdHJ1ZSk7Cj4gICAKPiAtCXZsdl9kaXNwbGF5X3Bvd2VyX3dlbGxfaW5pdChk
ZXZfcHJpdik7Cj4gKwl2bHZfZGlzcGxheV9wb3dlcl93ZWxsX2luaXQoaTkxNSk7Cj4gICB9Cj4g
ICAKPiAtc3RhdGljIHZvaWQgY2h2X3BpcGVfcG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgY2h2X3BpcGVfcG93ZXJfd2Vs
bF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCQlzdHJ1Y3Qg
aTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQo+ICAgewo+IC0Jdmx2X2Rpc3BsYXlfcG93ZXJf
d2VsbF9kZWluaXQoZGV2X3ByaXYpOwo+ICsJdmx2X2Rpc3BsYXlfcG93ZXJfd2VsbF9kZWluaXQo
aTkxNSk7Cj4gICAKPiAtCWNodl9zZXRfcGlwZV9wb3dlcl93ZWxsKGRldl9wcml2LCBwb3dlcl93
ZWxsLCBmYWxzZSk7Cj4gKwljaHZfc2V0X3BpcGVfcG93ZXJfd2VsbChpOTE1LCBwb3dlcl93ZWxs
LCBmYWxzZSk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB1NjQgX19hc3luY19wdXRfZG9tYWluc19t
YXNrKHN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMpCj4gQEAgLTE2Mjcs
MTAgKzE2MjcsMTAgQEAgYXN5bmNfcHV0X2RvbWFpbnNfY2xlYXJfZG9tYWluKHN0cnVjdCBpOTE1
X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMsCj4gICB9Cj4gICAKPiAgIHN0YXRpYyBib29s
Cj4gLWludGVsX2Rpc3BsYXlfcG93ZXJfZ3JhYl9hc3luY19wdXRfcmVmKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiAraW50ZWxfZGlzcGxheV9wb3dlcl9ncmFiX2FzeW5jX3B1
dF9yZWYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgICAgIGVudW0g
aW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluKQo+ICAgewo+IC0Jc3RydWN0IGk5MTVf
cG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9tYWluczsK
PiArCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmaTkxNS0+cG93
ZXJfZG9tYWluczsKPiAgIAlib29sIHJldCA9IGZhbHNlOwo+ICAgCj4gICAJaWYgKCEoYXN5bmNf
cHV0X2RvbWFpbnNfbWFzayhwb3dlcl9kb21haW5zKSAmIEJJVF9VTEwoZG9tYWluKSkpCj4gQEAg
LTE2NDQsNyArMTY0NCw3IEBAIGludGVsX2Rpc3BsYXlfcG93ZXJfZ3JhYl9hc3luY19wdXRfcmVm
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkJZ290byBvdXRfdmVyaWZ5
Owo+ICAgCj4gICAJY2FuY2VsX2RlbGF5ZWRfd29yaygmcG93ZXJfZG9tYWlucy0+YXN5bmNfcHV0
X3dvcmspOwo+IC0JaW50ZWxfcnVudGltZV9wbV9wdXRfcmF3KGRldl9wcml2LAo+ICsJaW50ZWxf
cnVudGltZV9wbV9wdXRfcmF3KGk5MTUsCj4gICAJCQkJIGZldGNoX2FuZF96ZXJvKCZwb3dlcl9k
b21haW5zLT5hc3luY19wdXRfd2FrZXJlZikpOwo+ICAgb3V0X3ZlcmlmeToKPiAgIAl2ZXJpZnlf
YXN5bmNfcHV0X2RvbWFpbnNfc3RhdGUocG93ZXJfZG9tYWlucyk7Cj4gQEAgLTE2NTMsMjQgKzE2
NTMsMjQgQEAgaW50ZWxfZGlzcGxheV9wb3dlcl9ncmFiX2FzeW5jX3B1dF9yZWYoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZAo+IC1f
X2ludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2RvbWFpbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gK19faW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfZG9tYWluKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSBlbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9t
YWluIGRvbWFpbikKPiAgIHsKPiAtCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2Rv
bWFpbnMgPSAmZGV2X3ByaXYtPnBvd2VyX2RvbWFpbnM7Cj4gKwlzdHJ1Y3QgaTkxNV9wb3dlcl9k
b21haW5zICpwb3dlcl9kb21haW5zID0gJmk5MTUtPnBvd2VyX2RvbWFpbnM7Cj4gICAJc3RydWN0
IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbDsKPiAgIAo+IC0JaWYgKGludGVsX2Rpc3BsYXlf
cG93ZXJfZ3JhYl9hc3luY19wdXRfcmVmKGRldl9wcml2LCBkb21haW4pKQo+ICsJaWYgKGludGVs
X2Rpc3BsYXlfcG93ZXJfZ3JhYl9hc3luY19wdXRfcmVmKGk5MTUsIGRvbWFpbikpCj4gICAJCXJl
dHVybjsKPiAgIAo+IC0JZm9yX2VhY2hfcG93ZXJfZG9tYWluX3dlbGwoZGV2X3ByaXYsIHBvd2Vy
X3dlbGwsIEJJVF9VTEwoZG9tYWluKSkKPiAtCQlpbnRlbF9wb3dlcl93ZWxsX2dldChkZXZfcHJp
diwgcG93ZXJfd2VsbCk7Cj4gKwlmb3JfZWFjaF9wb3dlcl9kb21haW5fd2VsbChpOTE1LCBwb3dl
cl93ZWxsLCBCSVRfVUxMKGRvbWFpbikpCj4gKwkJaW50ZWxfcG93ZXJfd2VsbF9nZXQoaTkxNSwg
cG93ZXJfd2VsbCk7Cj4gICAKPiAgIAlwb3dlcl9kb21haW5zLT5kb21haW5fdXNlX2NvdW50W2Rv
bWFpbl0rKzsKPiAgIH0KPiAgIAo+ICAgLyoqCj4gICAgKiBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dl
dCAtIGdyYWIgYSBwb3dlciBkb21haW4gcmVmZXJlbmNlCj4gLSAqIEBkZXZfcHJpdjogaTkxNSBk
ZXZpY2UgaW5zdGFuY2UKPiArICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gICAgKiBA
ZG9tYWluOiBwb3dlciBkb21haW4gdG8gcmVmZXJlbmNlCj4gICAgKgo+ICAgICogVGhpcyBmdW5j
dGlvbiBncmFicyBhIHBvd2VyIGRvbWFpbiByZWZlcmVuY2UgZm9yIEBkb21haW4gYW5kIGVuc3Vy
ZXMgdGhhdCB0aGUKPiBAQCAtMTY4MCwxNCArMTY4MCwxNCBAQCBfX2ludGVsX2Rpc3BsYXlfcG93
ZXJfZ2V0X2RvbWFpbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAgKiBB
bnkgcG93ZXIgZG9tYWluIHJlZmVyZW5jZSBvYnRhaW5lZCBieSB0aGlzIGZ1bmN0aW9uIG11c3Qg
aGF2ZSBhIHN5bW1ldHJpYwo+ICAgICogY2FsbCB0byBpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dCgp
IHRvIHJlbGVhc2UgdGhlIHJlZmVyZW5jZSBhZ2Fpbi4KPiAgICAqLwo+IC1pbnRlbF93YWtlcmVm
X3QgaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ICtpbnRlbF93YWtlcmVmX3QgaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJCWVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9k
b21haW4gZG9tYWluKQo+ICAgewo+IC0Jc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJf
ZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9tYWluczsKPiAtCWludGVsX3dha2VyZWZfdCB3
YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOwo+ICsJc3RydWN0IGk5MTVf
cG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucyA9ICZpOTE1LT5wb3dlcl9kb21haW5zOwo+ICsJ
aW50ZWxfd2FrZXJlZl90IHdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKPiAg
IAo+ICAgCW11dGV4X2xvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwo+IC0JX19pbnRlbF9kaXNw
bGF5X3Bvd2VyX2dldF9kb21haW4oZGV2X3ByaXYsIGRvbWFpbik7Cj4gKwlfX2ludGVsX2Rpc3Bs
YXlfcG93ZXJfZ2V0X2RvbWFpbihpOTE1LCBkb21haW4pOwo+ICAgCW11dGV4X3VubG9jaygmcG93
ZXJfZG9tYWlucy0+bG9jayk7Cj4gICAKPiAgIAlyZXR1cm4gd2FrZXJlZjsKPiBAQCAtMTY5NSw3
ICsxNjk1LDcgQEAgaW50ZWxfd2FrZXJlZl90IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAo+ICAgLyoqCj4gICAgKiBpbnRlbF9k
aXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkIC0gZ3JhYiBhIHJlZmVyZW5jZSBmb3IgYW4gZW5h
YmxlZCBkaXNwbGF5IHBvd2VyIGRvbWFpbgo+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIGlu
c3RhbmNlCj4gKyAqIEBpOTE1OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ICAgICogQGRvbWFpbjog
cG93ZXIgZG9tYWluIHRvIHJlZmVyZW5jZQo+ICAgICoKPiAgICAqIFRoaXMgZnVuY3Rpb24gZ3Jh
YnMgYSBwb3dlciBkb21haW4gcmVmZXJlbmNlIGZvciBAZG9tYWluIGFuZCBlbnN1cmVzIHRoYXQg
dGhlCj4gQEAgLTE3MDYsMjEgKzE3MDYsMjEgQEAgaW50ZWxfd2FrZXJlZl90IGludGVsX2Rpc3Bs
YXlfcG93ZXJfZ2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgICAqIGNh
bGwgdG8gaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoKSB0byByZWxlYXNlIHRoZSByZWZlcmVuY2Ug
YWdhaW4uCj4gICAgKi8KPiAgIGludGVsX3dha2VyZWZfdAo+IC1pbnRlbF9kaXNwbGF5X3Bvd2Vy
X2dldF9pZl9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAraW50
ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiAgIAkJCQkgICBlbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbikK
PiAgIHsKPiAtCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmZGV2
X3ByaXYtPnBvd2VyX2RvbWFpbnM7Cj4gKwlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dl
cl9kb21haW5zID0gJmk5MTUtPnBvd2VyX2RvbWFpbnM7Cj4gICAJaW50ZWxfd2FrZXJlZl90IHdh
a2VyZWY7Cj4gICAJYm9vbCBpc19lbmFibGVkOwo+ICAgCj4gLQl3YWtlcmVmID0gaW50ZWxfcnVu
dGltZV9wbV9nZXRfaWZfaW5fdXNlKGRldl9wcml2KTsKPiArCXdha2VyZWYgPSBpbnRlbF9ydW50
aW1lX3BtX2dldF9pZl9pbl91c2UoaTkxNSk7Cj4gICAJaWYgKCF3YWtlcmVmKQo+ICAgCQlyZXR1
cm4gZmFsc2U7Cj4gICAKPiAgIAltdXRleF9sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKPiAg
IAo+IC0JaWYgKF9faW50ZWxfZGlzcGxheV9wb3dlcl9pc19lbmFibGVkKGRldl9wcml2LCBkb21h
aW4pKSB7Cj4gLQkJX19pbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9kb21haW4oZGV2X3ByaXYsIGRv
bWFpbik7Cj4gKwlpZiAoX19pbnRlbF9kaXNwbGF5X3Bvd2VyX2lzX2VuYWJsZWQoaTkxNSwgZG9t
YWluKSkgewo+ICsJCV9faW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfZG9tYWluKGk5MTUsIGRvbWFp
bik7Cj4gICAJCWlzX2VuYWJsZWQgPSB0cnVlOwo+ICAgCX0gZWxzZSB7Cj4gICAJCWlzX2VuYWJs
ZWQgPSBmYWxzZTsKPiBAQCAtMTcyOSw3ICsxNzI5LDcgQEAgaW50ZWxfZGlzcGxheV9wb3dlcl9n
ZXRfaWZfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJbXV0
ZXhfdW5sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKPiAgIAo+ICAgCWlmICghaXNfZW5hYmxl
ZCkgewo+IC0JCWludGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKPiArCQlp
bnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKPiAgIAkJd2FrZXJlZiA9IDA7Cj4g
ICAJfQo+ICAgCj4gQEAgLTE3MzcsMTQgKzE3MzcsMTQgQEAgaW50ZWxfZGlzcGxheV9wb3dlcl9n
ZXRfaWZfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICB9Cj4g
ICAKPiAgIHN0YXRpYyB2b2lkCj4gLV9faW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfZG9tYWluKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArX19pbnRlbF9kaXNwbGF5X3Bvd2Vy
X3B1dF9kb21haW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJIGVudW0g
aW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluKQo+ICAgewo+ICAgCXN0cnVjdCBpOTE1
X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnM7Cj4gICAJc3RydWN0IGk5MTVfcG93ZXJfd2Vs
bCAqcG93ZXJfd2VsbDsKPiAgIAljb25zdCBjaGFyICpuYW1lID0gaW50ZWxfZGlzcGxheV9wb3dl
cl9kb21haW5fc3RyKGRvbWFpbik7Cj4gICAKPiAtCXBvd2VyX2RvbWFpbnMgPSAmZGV2X3ByaXYt
PnBvd2VyX2RvbWFpbnM7Cj4gKwlwb3dlcl9kb21haW5zID0gJmk5MTUtPnBvd2VyX2RvbWFpbnM7
Cj4gICAKPiAgIAlXQVJOKCFwb3dlcl9kb21haW5zLT5kb21haW5fdXNlX2NvdW50W2RvbWFpbl0s
Cj4gICAJICAgICAiVXNlIGNvdW50IG9uIGRvbWFpbiAlcyBpcyBhbHJlYWR5IHplcm9cbiIsCj4g
QEAgLTE3NTUsMjMgKzE3NTUsMjMgQEAgX19pbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dF9kb21haW4o
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCj4gICAJcG93ZXJfZG9tYWlu
cy0+ZG9tYWluX3VzZV9jb3VudFtkb21haW5dLS07Cj4gICAKPiAtCWZvcl9lYWNoX3Bvd2VyX2Rv
bWFpbl93ZWxsX3JldmVyc2UoZGV2X3ByaXYsIHBvd2VyX3dlbGwsIEJJVF9VTEwoZG9tYWluKSkK
PiAtCQlpbnRlbF9wb3dlcl93ZWxsX3B1dChkZXZfcHJpdiwgcG93ZXJfd2VsbCk7Cj4gKwlmb3Jf
ZWFjaF9wb3dlcl9kb21haW5fd2VsbF9yZXZlcnNlKGk5MTUsIHBvd2VyX3dlbGwsIEJJVF9VTEwo
ZG9tYWluKSkKPiArCQlpbnRlbF9wb3dlcl93ZWxsX3B1dChpOTE1LCBwb3dlcl93ZWxsKTsKPiAg
IH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBfX2ludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgX19pbnRlbF9kaXNwbGF5
X3Bvd2VyX3B1dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAgICBl
bnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbikKPiAgIHsKPiAtCXN0cnVjdCBp
OTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmZGV2X3ByaXYtPnBvd2VyX2RvbWFp
bnM7Cj4gKwlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmk5MTUt
PnBvd2VyX2RvbWFpbnM7Cj4gICAKPiAgIAltdXRleF9sb2NrKCZwb3dlcl9kb21haW5zLT5sb2Nr
KTsKPiAtCV9faW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfZG9tYWluKGRldl9wcml2LCBkb21haW4p
Owo+ICsJX19pbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dF9kb21haW4oaTkxNSwgZG9tYWluKTsKPiAg
IAltdXRleF91bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwo+ICAgfQo+ICAgCj4gICAvKioK
PiAgICAqIGludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X3VuY2hlY2tlZCAtIHJlbGVhc2UgYW4gdW5j
aGVja2VkIHBvd2VyIGRvbWFpbiByZWZlcmVuY2UKPiAtICogQGRldl9wcml2OiBpOTE1IGRldmlj
ZSBpbnN0YW5jZQo+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiAgICAqIEBkb21h
aW46IHBvd2VyIGRvbWFpbiB0byByZWZlcmVuY2UKPiAgICAqCj4gICAgKiBUaGlzIGZ1bmN0aW9u
IGRyb3BzIHRoZSBwb3dlciBkb21haW4gcmVmZXJlbmNlIG9idGFpbmVkIGJ5Cj4gQEAgLTE3ODIs
MTEgKzE3ODIsMTEgQEAgc3RhdGljIHZvaWQgX19pbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAgKiBuZXcgY29kZSwgYXMgdGhlIGNv
cnJlY3RuZXNzIG9mIGl0cyB1c2UgY2Fubm90IGJlIGNoZWNrZWQuIEFsd2F5cyB1c2UKPiAgICAq
IGludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KCkgaW5zdGVhZC4KPiAgICAqLwo+IC12b2lkIGludGVs
X2Rpc3BsYXlfcG93ZXJfcHV0X3VuY2hlY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gK3ZvaWQgaW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfdW5jaGVja2VkKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgICAgICBlbnVtIGludGVsX2Rpc3BsYXlf
cG93ZXJfZG9tYWluIGRvbWFpbikKPiAgIHsKPiAtCV9faW50ZWxfZGlzcGxheV9wb3dlcl9wdXQo
ZGV2X3ByaXYsIGRvbWFpbik7Cj4gLQlpbnRlbF9ydW50aW1lX3BtX3B1dF91bmNoZWNrZWQoZGV2
X3ByaXYpOwo+ICsJX19pbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChpOTE1LCBkb21haW4pOwo+ICsJ
aW50ZWxfcnVudGltZV9wbV9wdXRfdW5jaGVja2VkKGk5MTUpOwo+ICAgfQo+ICAgCj4gICBzdGF0
aWMgdm9pZAo+IEBAIC0xODAzLDcgKzE4MDMsNyBAQCBxdWV1ZV9hc3luY19wdXRfZG9tYWluc193
b3JrKHN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMsCj4gICBzdGF0aWMg
dm9pZAo+ICAgcmVsZWFzZV9hc3luY19wdXRfZG9tYWlucyhzdHJ1Y3QgaTkxNV9wb3dlcl9kb21h
aW5zICpwb3dlcl9kb21haW5zLCB1NjQgbWFzaykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9Cj4g
ICAJCWNvbnRhaW5lcl9vZihwb3dlcl9kb21haW5zLCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSwK
PiAgIAkJCSAgICAgcG93ZXJfZG9tYWlucyk7Cj4gICAJZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2Vy
X2RvbWFpbiBkb21haW47Cj4gQEAgLTE4MTQsMjYgKzE4MTQsMjYgQEAgcmVsZWFzZV9hc3luY19w
dXRfZG9tYWlucyhzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zLCB1NjQg
bWFzaykKPiAgIAkgKiB3YWtlcmVmIHRvIG1ha2UgdGhlIHN0YXRlIGNoZWNrZXIgaGFwcHkgYWJv
dXQgdGhlIEhXIGFjY2VzcyBkdXJpbmcKPiAgIAkgKiBwb3dlciB3ZWxsIGRpc2FibGluZy4KPiAg
IAkgKi8KPiAtCWFzc2VydF9ycG1fcmF3X3dha2VyZWZfaGVsZChkZXZfcHJpdik7Cj4gLQl3YWtl
cmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOwo+ICsJYXNzZXJ0X3JwbV9yYXdf
d2FrZXJlZl9oZWxkKGk5MTUpOwo+ICsJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5
MTUpOwo+ICAgCj4gICAJZm9yX2VhY2hfcG93ZXJfZG9tYWluKGRvbWFpbiwgbWFzaykgewo+ICAg
CQkvKiBDbGVhciBiZWZvcmUgcHV0LCBzbyBwdXQncyBzYW5pdHkgY2hlY2sgaXMgaGFwcHkuICov
Cj4gICAJCWFzeW5jX3B1dF9kb21haW5zX2NsZWFyX2RvbWFpbihwb3dlcl9kb21haW5zLCBkb21h
aW4pOwo+IC0JCV9faW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfZG9tYWluKGRldl9wcml2LCBkb21h
aW4pOwo+ICsJCV9faW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfZG9tYWluKGk5MTUsIGRvbWFpbik7
Cj4gICAJfQo+ICAgCj4gLQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7
Cj4gKwlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKPiAgIH0KPiAgIAo+ICAg
c3RhdGljIHZvaWQKPiAgIGludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X2FzeW5jX3dvcmsoc3RydWN0
IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0KPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0KPiAgIAkJY29udGFp
bmVyX29mKHdvcmssIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlLAo+ICAgCQkJICAgICBwb3dlcl9k
b21haW5zLmFzeW5jX3B1dF93b3JrLndvcmspOwo+IC0Jc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlu
cyAqcG93ZXJfZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9tYWluczsKPiAtCWludGVsX3dh
a2VyZWZfdCBuZXdfd29ya193YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXRfcmF3KGRldl9w
cml2KTsKPiArCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmaTkx
NS0+cG93ZXJfZG9tYWluczsKPiArCWludGVsX3dha2VyZWZfdCBuZXdfd29ya193YWtlcmVmID0g
aW50ZWxfcnVudGltZV9wbV9nZXRfcmF3KGk5MTUpOwo+ICAgCWludGVsX3dha2VyZWZfdCBvbGRf
d29ya193YWtlcmVmID0gMDsKPiAgIAo+ICAgCW11dGV4X2xvY2soJnBvd2VyX2RvbWFpbnMtPmxv
Y2spOwo+IEBAIC0xODYzLDkgKzE4NjMsOSBAQCBpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dF9hc3lu
Y193b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiAgIAltdXRleF91bmxvY2soJnBvd2Vy
X2RvbWFpbnMtPmxvY2spOwo+ICAgCj4gICAJaWYgKG9sZF93b3JrX3dha2VyZWYpCj4gLQkJaW50
ZWxfcnVudGltZV9wbV9wdXRfcmF3KGRldl9wcml2LCBvbGRfd29ya193YWtlcmVmKTsKPiArCQlp
bnRlbF9ydW50aW1lX3BtX3B1dF9yYXcoaTkxNSwgb2xkX3dvcmtfd2FrZXJlZik7Cj4gICAJaWYg
KG5ld193b3JrX3dha2VyZWYpCj4gLQkJaW50ZWxfcnVudGltZV9wbV9wdXRfcmF3KGRldl9wcml2
LCBuZXdfd29ya193YWtlcmVmKTsKPiArCQlpbnRlbF9ydW50aW1lX3BtX3B1dF9yYXcoaTkxNSwg
bmV3X3dvcmtfd2FrZXJlZik7Cj4gICB9Cj4gICAKPiAgIC8qKgo+IEBAIC0xOTc0LDcgKzE5NzQs
NyBAQCBpbnRlbF9kaXNwbGF5X3Bvd2VyX2ZsdXNoX3dvcmtfc3luYyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKPiAgICNpZiBJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9ERUJVR19S
VU5USU1FX1BNKQo+ICAgLyoqCj4gICAgKiBpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dCAtIHJlbGVh
c2UgYSBwb3dlciBkb21haW4gcmVmZXJlbmNlCj4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2Ug
aW5zdGFuY2UKPiArICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gICAgKiBAZG9tYWlu
OiBwb3dlciBkb21haW4gdG8gcmVmZXJlbmNlCj4gICAgKiBAd2FrZXJlZjogd2FrZXJlZiBhY3F1
aXJlZCBmb3IgdGhlIHJlZmVyZW5jZSB0aGF0IGlzIGJlaW5nIHJlbGVhc2VkCj4gICAgKgo+IEBA
IC0xOTgyLDEyICsxOTgyLDEyIEBAIGludGVsX2Rpc3BsYXlfcG93ZXJfZmx1c2hfd29ya19zeW5j
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgICogaW50ZWxfZGlzcGxheV9wb3dl
cl9nZXQoKSBhbmQgbWlnaHQgcG93ZXIgZG93biB0aGUgY29ycmVzcG9uZGluZyBoYXJkd2FyZQo+
ICAgICogYmxvY2sgcmlnaHQgYXdheSBpZiB0aGlzIGlzIHRoZSBsYXN0IHJlZmVyZW5jZS4KPiAg
ICAqLwo+IC12b2lkIGludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiArdm9pZCBpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2Vy
X2RvbWFpbiBkb21haW4sCj4gICAJCQkgICAgIGludGVsX3dha2VyZWZfdCB3YWtlcmVmKQo+ICAg
ewo+IC0JX19pbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwgZG9tYWluKTsKPiAtCWlu
dGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKPiArCV9faW50ZWxfZGlzcGxh
eV9wb3dlcl9wdXQoaTkxNSwgZG9tYWluKTsKPiArCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUs
IHdha2VyZWYpOwo+ICAgfQo+ICAgI2VuZGlmCj4gICAKPiBAQCAtMjY1NSwxNCArMjY1NSwxNCBA
QCBzdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJfd2VsbF9kZXNjIGNodl9wb3dlcl93ZWxs
c1tdID0gewo+ICAgCX0sCj4gICB9Owo+ICAgCj4gLWJvb2wgaW50ZWxfZGlzcGxheV9wb3dlcl93
ZWxsX2lzX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtib29s
IGludGVsX2Rpc3BsYXlfcG93ZXJfd2VsbF9pc19lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAo+ICAgCQkJCQkgZW51bSBpOTE1X3Bvd2VyX3dlbGxfaWQgcG93ZXJfd2VsbF9p
ZCkKPiAgIHsKPiAgIAlzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsOwo+ICAgCWJv
b2wgcmV0Owo+ICAgCj4gLQlwb3dlcl93ZWxsID0gbG9va3VwX3Bvd2VyX3dlbGwoZGV2X3ByaXYs
IHBvd2VyX3dlbGxfaWQpOwo+IC0JcmV0ID0gcG93ZXJfd2VsbC0+ZGVzYy0+b3BzLT5pc19lbmFi
bGVkKGRldl9wcml2LCBwb3dlcl93ZWxsKTsKPiArCXBvd2VyX3dlbGwgPSBsb29rdXBfcG93ZXJf
d2VsbChpOTE1LCBwb3dlcl93ZWxsX2lkKTsKPiArCXJldCA9IHBvd2VyX3dlbGwtPmRlc2MtPm9w
cy0+aXNfZW5hYmxlZChpOTE1LCBwb3dlcl93ZWxsKTsKPiAgIAo+ICAgCXJldHVybiByZXQ7Cj4g
ICB9Cj4gQEAgLTMzNTIsNyArMzM1Miw3IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9wb3dl
cl93ZWxsX2Rlc2MgaWNsX3Bvd2VyX3dlbGxzW10gPSB7Cj4gICB9Owo+ICAgCj4gICBzdGF0aWMg
aW50Cj4gLXNhbml0aXplX2Rpc2FibGVfcG93ZXJfd2VsbF9vcHRpb24oY29uc3Qgc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzYW5pdGl6ZV9kaXNhYmxlX3Bvd2VyX3dlbGxf
b3B0aW9uKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgIGlu
dCBkaXNhYmxlX3Bvd2VyX3dlbGwpCj4gICB7Cj4gICAJaWYgKGRpc2FibGVfcG93ZXJfd2VsbCA+
PSAwKQo+IEBAIC0zMzYxLDE0ICszMzYxLDE0IEBAIHNhbml0aXplX2Rpc2FibGVfcG93ZXJfd2Vs
bF9vcHRpb24oY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCXJl
dHVybiAxOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB1MzIgZ2V0X2FsbG93ZWRfZGNfbWFzayhjb25z
dCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB1MzIgZ2V0X2Fs
bG93ZWRfZGNfbWFzayhjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJ
CSAgICAgICBpbnQgZW5hYmxlX2RjKQo+ICAgewo+ICAgCXUzMiBtYXNrOwo+ICAgCWludCByZXF1
ZXN0ZWRfZGM7Cj4gICAJaW50IG1heF9kYzsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJp
dikgPj0gMTEpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpIHsKPiAgIAkJbWF4X2Rj
ID0gMjsKPiAgIAkJLyoKPiAgIAkJICogREM5IGhhcyBhIHNlcGFyYXRlIEhXIGZsb3cgZnJvbSB0
aGUgcmVzdCBvZiB0aGUgREMgc3RhdGVzLAo+IEBAIC0zMzc2LDEwICszMzc2LDEwIEBAIHN0YXRp
YyB1MzIgZ2V0X2FsbG93ZWRfZGNfbWFzayhjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gICAJCSAqIHN1c3BlbmQvcmVzdW1lLCBzbyBhbGxvdyBpdCB1bmNvbmRpdGlv
bmFsbHkuCj4gICAJCSAqLwo+ICAgCQltYXNrID0gRENfU1RBVEVfRU5fREM5Owo+IC0JfSBlbHNl
IGlmIChJU19HRU4oZGV2X3ByaXYsIDEwKSB8fCBJU19HRU45X0JDKGRldl9wcml2KSkgewo+ICsJ
fSBlbHNlIGlmIChJU19HRU4oaTkxNSwgMTApIHx8IElTX0dFTjlfQkMoaTkxNSkpIHsKPiAgIAkJ
bWF4X2RjID0gMjsKPiAgIAkJbWFzayA9IDA7Cj4gLQl9IGVsc2UgaWYgKElTX0dFTjlfTFAoZGV2
X3ByaXYpKSB7Cj4gKwl9IGVsc2UgaWYgKElTX0dFTjlfTFAoaTkxNSkpIHsKPiAgIAkJbWF4X2Rj
ID0gMTsKPiAgIAkJbWFzayA9IERDX1NUQVRFX0VOX0RDOTsKPiAgIAl9IGVsc2Ugewo+IEBAIC0z
NDUxLDIxICszNDUxLDIxIEBAIF9fc2V0X3Bvd2VyX3dlbGxzKHN0cnVjdCBpOTE1X3Bvd2VyX2Rv
bWFpbnMgKnBvd2VyX2RvbWFpbnMsCj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxfcG93ZXJfZG9t
YWluc19pbml0IC0gaW5pdGlhbGl6ZXMgdGhlIHBvd2VyIGRvbWFpbiBzdHJ1Y3R1cmVzCj4gLSAq
IEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiArICogQGk5MTU6IGk5MTUgZGV2aWNl
IGluc3RhbmNlCj4gICAgKgo+IC0gKiBJbml0aWFsaXplcyB0aGUgcG93ZXIgZG9tYWluIHN0cnVj
dHVyZXMgZm9yIEBkZXZfcHJpdiBkZXBlbmRpbmcgdXBvbiB0aGUKPiArICogSW5pdGlhbGl6ZXMg
dGhlIHBvd2VyIGRvbWFpbiBzdHJ1Y3R1cmVzIGZvciBAaTkxNSBkZXBlbmRpbmcgdXBvbiB0aGUK
PiAgICAqIHN1cHBvcnRlZCBwbGF0Zm9ybS4KPiAgICAqLwo+IC1pbnQgaW50ZWxfcG93ZXJfZG9t
YWluc19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAraW50IGludGVs
X3Bvd2VyX2RvbWFpbnNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsK
PiAtCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmZGV2X3ByaXYt
PnBvd2VyX2RvbWFpbnM7Cj4gKwlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21h
aW5zID0gJmk5MTUtPnBvd2VyX2RvbWFpbnM7Cj4gICAJaW50IGVycjsKPiAgIAo+ICAgCWk5MTVf
bW9kcGFyYW1zLmRpc2FibGVfcG93ZXJfd2VsbCA9Cj4gLQkJc2FuaXRpemVfZGlzYWJsZV9wb3dl
cl93ZWxsX29wdGlvbihkZXZfcHJpdiwKPiArCQlzYW5pdGl6ZV9kaXNhYmxlX3Bvd2VyX3dlbGxf
b3B0aW9uKGk5MTUsCj4gICAJCQkJCQkgICBpOTE1X21vZHBhcmFtcy5kaXNhYmxlX3Bvd2VyX3dl
bGwpOwo+IC0JZGV2X3ByaXYtPmNzci5hbGxvd2VkX2RjX21hc2sgPQo+IC0JCWdldF9hbGxvd2Vk
X2RjX21hc2soZGV2X3ByaXYsIGk5MTVfbW9kcGFyYW1zLmVuYWJsZV9kYyk7Cj4gKwlpOTE1LT5j
c3IuYWxsb3dlZF9kY19tYXNrID0KPiArCQlnZXRfYWxsb3dlZF9kY19tYXNrKGk5MTUsIGk5MTVf
bW9kcGFyYW1zLmVuYWJsZV9kYyk7Cj4gICAKPiAgIAlCVUlMRF9CVUdfT04oUE9XRVJfRE9NQUlO
X05VTSA+IDY0KTsKPiAgIAo+IEBAIC0zNDc4LDkgKzM0NzgsOSBAQCBpbnQgaW50ZWxfcG93ZXJf
ZG9tYWluc19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkgKiBU
aGUgZW5hYmxpbmcgb3JkZXIgd2lsbCBiZSBmcm9tIGxvd2VyIHRvIGhpZ2hlciBpbmRleGVkIHdl
bGxzLAo+ICAgCSAqIHRoZSBkaXNhYmxpbmcgb3JkZXIgaXMgcmV2ZXJzZWQuCj4gICAJICovCj4g
LQlpZiAoSVNfR0VOKGRldl9wcml2LCAxMSkpIHsKPiArCWlmIChJU19HRU4oaTkxNSwgMTEpKSB7
Cj4gICAJCWVyciA9IHNldF9wb3dlcl93ZWxscyhwb3dlcl9kb21haW5zLCBpY2xfcG93ZXJfd2Vs
bHMpOwo+IC0JfSBlbHNlIGlmIChJU19DQU5OT05MQUtFKGRldl9wcml2KSkgewo+ICsJfSBlbHNl
IGlmIChJU19DQU5OT05MQUtFKGk5MTUpKSB7Cj4gICAJCWVyciA9IHNldF9wb3dlcl93ZWxscyhw
b3dlcl9kb21haW5zLCBjbmxfcG93ZXJfd2VsbHMpOwo+ICAgCj4gICAJCS8qCj4gQEAgLTM0ODks
MjMgKzM0ODksMjMgQEAgaW50IGludGVsX3Bvd2VyX2RvbWFpbnNfaW5pdChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCSAqIHRpbWVvdXRzLCBsZXRzIHJlbW92ZSB0aGVt
IGZyb20gdGhlIGxpc3QKPiAgIAkJICogZm9yIHRoZSBTS1VzIHdpdGhvdXQgcG9ydCBGLgo+ICAg
CQkgKi8KPiAtCQlpZiAoIUlTX0NOTF9XSVRIX1BPUlRfRihkZXZfcHJpdikpCj4gKwkJaWYgKCFJ
U19DTkxfV0lUSF9QT1JUX0YoaTkxNSkpCj4gICAJCQlwb3dlcl9kb21haW5zLT5wb3dlcl93ZWxs
X2NvdW50IC09IDI7Cj4gLQl9IGVsc2UgaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKSB7Cj4g
Kwl9IGVsc2UgaWYgKElTX0dFTUlOSUxBS0UoaTkxNSkpIHsKPiAgIAkJZXJyID0gc2V0X3Bvd2Vy
X3dlbGxzKHBvd2VyX2RvbWFpbnMsIGdsa19wb3dlcl93ZWxscyk7Cj4gLQl9IGVsc2UgaWYgKElT
X0JST1hUT04oZGV2X3ByaXYpKSB7Cj4gKwl9IGVsc2UgaWYgKElTX0JST1hUT04oaTkxNSkpIHsK
PiAgIAkJZXJyID0gc2V0X3Bvd2VyX3dlbGxzKHBvd2VyX2RvbWFpbnMsIGJ4dF9wb3dlcl93ZWxs
cyk7Cj4gLQl9IGVsc2UgaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpKSB7Cj4gKwl9IGVsc2UgaWYg
KElTX0dFTjlfQkMoaTkxNSkpIHsKPiAgIAkJZXJyID0gc2V0X3Bvd2VyX3dlbGxzKHBvd2VyX2Rv
bWFpbnMsIHNrbF9wb3dlcl93ZWxscyk7Cj4gLQl9IGVsc2UgaWYgKElTX0NIRVJSWVZJRVcoZGV2
X3ByaXYpKSB7Cj4gKwl9IGVsc2UgaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiAgIAkJZXJy
ID0gc2V0X3Bvd2VyX3dlbGxzKHBvd2VyX2RvbWFpbnMsIGNodl9wb3dlcl93ZWxscyk7Cj4gLQl9
IGVsc2UgaWYgKElTX0JST0FEV0VMTChkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAoSVNfQlJP
QURXRUxMKGk5MTUpKSB7Cj4gICAJCWVyciA9IHNldF9wb3dlcl93ZWxscyhwb3dlcl9kb21haW5z
LCBiZHdfcG93ZXJfd2VsbHMpOwo+IC0JfSBlbHNlIGlmIChJU19IQVNXRUxMKGRldl9wcml2KSkg
ewo+ICsJfSBlbHNlIGlmIChJU19IQVNXRUxMKGk5MTUpKSB7Cj4gICAJCWVyciA9IHNldF9wb3dl
cl93ZWxscyhwb3dlcl9kb21haW5zLCBoc3dfcG93ZXJfd2VsbHMpOwo+IC0JfSBlbHNlIGlmIChJ
U19WQUxMRVlWSUVXKGRldl9wcml2KSkgewo+ICsJfSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5
MTUpKSB7Cj4gICAJCWVyciA9IHNldF9wb3dlcl93ZWxscyhwb3dlcl9kb21haW5zLCB2bHZfcG93
ZXJfd2VsbHMpOwo+IC0JfSBlbHNlIGlmIChJU19JODMwKGRldl9wcml2KSkgewo+ICsJfSBlbHNl
IGlmIChJU19JODMwKGk5MTUpKSB7Cj4gICAJCWVyciA9IHNldF9wb3dlcl93ZWxscyhwb3dlcl9k
b21haW5zLCBpODMwX3Bvd2VyX3dlbGxzKTsKPiAgIAl9IGVsc2Ugewo+ICAgCQllcnIgPSBzZXRf
cG93ZXJfd2VsbHMocG93ZXJfZG9tYWlucywgaTl4eF9hbHdheXNfb25fcG93ZXJfd2VsbCk7Cj4g
QEAgLTM1MTYsMzEgKzM1MTYsMzEgQEAgaW50IGludGVsX3Bvd2VyX2RvbWFpbnNfaW5pdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxf
cG93ZXJfZG9tYWluc19jbGVhbnVwIC0gY2xlYW4gdXAgcG93ZXIgZG9tYWlucyByZXNvdXJjZXMK
PiAtICogQGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ICsgKiBAaTkxNTogaTkxNSBk
ZXZpY2UgaW5zdGFuY2UKPiAgICAqCj4gICAgKiBSZWxlYXNlIGFueSByZXNvdXJjZXMgYWNxdWly
ZWQgYnkgaW50ZWxfcG93ZXJfZG9tYWluc19pbml0KCkKPiAgICAqLwo+IC12b2lkIGludGVsX3Bv
d2VyX2RvbWFpbnNfY2xlYW51cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
K3ZvaWQgaW50ZWxfcG93ZXJfZG9tYWluc19jbGVhbnVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQo+ICAgewo+IC0Ja2ZyZWUoZGV2X3ByaXYtPnBvd2VyX2RvbWFpbnMucG93ZXJfd2Vs
bHMpOwo+ICsJa2ZyZWUoaTkxNS0+cG93ZXJfZG9tYWlucy5wb3dlcl93ZWxscyk7Cj4gICB9Cj4g
ICAKPiAtc3RhdGljIHZvaWQgaW50ZWxfcG93ZXJfZG9tYWluc19zeW5jX2h3KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaW50ZWxfcG93ZXJfZG9tYWlu
c19zeW5jX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RydWN0
IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9t
YWluczsKPiArCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmaTkx
NS0+cG93ZXJfZG9tYWluczsKPiAgIAlzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxs
Owo+ICAgCj4gICAJbXV0ZXhfbG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7Cj4gLQlmb3JfZWFj
aF9wb3dlcl93ZWxsKGRldl9wcml2LCBwb3dlcl93ZWxsKSB7Cj4gLQkJcG93ZXJfd2VsbC0+ZGVz
Yy0+b3BzLT5zeW5jX2h3KGRldl9wcml2LCBwb3dlcl93ZWxsKTsKPiArCWZvcl9lYWNoX3Bvd2Vy
X3dlbGwoaTkxNSwgcG93ZXJfd2VsbCkgewo+ICsJCXBvd2VyX3dlbGwtPmRlc2MtPm9wcy0+c3lu
Y19odyhpOTE1LCBwb3dlcl93ZWxsKTsKPiAgIAkJcG93ZXJfd2VsbC0+aHdfZW5hYmxlZCA9Cj4g
LQkJCXBvd2VyX3dlbGwtPmRlc2MtPm9wcy0+aXNfZW5hYmxlZChkZXZfcHJpdiwgcG93ZXJfd2Vs
bCk7Cj4gKwkJCXBvd2VyX3dlbGwtPmRlc2MtPm9wcy0+aXNfZW5hYmxlZChpOTE1LCBwb3dlcl93
ZWxsKTsKPiAgIAl9Cj4gICAJbXV0ZXhfdW5sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKPiAg
IH0KPiAgIAo+ICAgc3RhdGljIGlubGluZQo+IC1ib29sIGludGVsX2RidWZfc2xpY2Vfc2V0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArYm9vbCBpbnRlbF9kYnVmX3NsaWNl
X3NldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgaTkxNV9yZWdfdCBy
ZWcsIGJvb2wgZW5hYmxlKQo+ICAgewo+ICAgCXUzMiB2YWwsIHN0YXR1czsKPiBAQCAtMzU2MCwz
MCArMzU2MCwzMCBAQCBib29sIGludGVsX2RidWZfc2xpY2Vfc2V0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiAgIAlyZXR1cm4gdHJ1ZTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMg
dm9pZCBnZW45X2RidWZfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiArc3RhdGljIHZvaWQgZ2VuOV9kYnVmX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiAgIHsKPiAtCWludGVsX2RidWZfc2xpY2Vfc2V0KGRldl9wcml2LCBEQlVGX0NUTCwg
dHJ1ZSk7Cj4gKwlpbnRlbF9kYnVmX3NsaWNlX3NldChpOTE1LCBEQlVGX0NUTCwgdHJ1ZSk7Cj4g
ICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgZ2VuOV9kYnVmX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBnZW45X2RidWZfZGlzYWJsZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCWludGVsX2RidWZfc2xpY2Vfc2V0
KGRldl9wcml2LCBEQlVGX0NUTCwgZmFsc2UpOwo+ICsJaW50ZWxfZGJ1Zl9zbGljZV9zZXQoaTkx
NSwgREJVRl9DVEwsIGZhbHNlKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdTggaW50ZWxfZGJ1Zl9t
YXhfc2xpY2VzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHU4
IGludGVsX2RidWZfbWF4X3NsaWNlcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAg
IHsKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgMTEpCj4gKwlpZiAoSU5URUxfR0VOKGk5
MTUpIDwgMTEpCj4gICAJCXJldHVybiAxOwo+ICAgCXJldHVybiAyOwo+ICAgfQo+ICAgCj4gLXZv
aWQgaWNsX2RidWZfc2xpY2VzX3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gK3ZvaWQgaWNsX2RidWZfc2xpY2VzX3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwKPiAgIAkJCSAgICB1OCByZXFfc2xpY2VzKQo+ICAgewo+IC0JY29uc3QgdTggaHdf
ZW5hYmxlZF9zbGljZXMgPSBkZXZfcHJpdi0+d20uc2tsX2h3LmRkYi5lbmFibGVkX3NsaWNlczsK
PiArCWNvbnN0IHU4IGh3X2VuYWJsZWRfc2xpY2VzID0gaTkxNS0+d20uc2tsX2h3LmRkYi5lbmFi
bGVkX3NsaWNlczsKPiAgIAlib29sIHJldDsKPiAgIAo+IC0JaWYgKHJlcV9zbGljZXMgPiBpbnRl
bF9kYnVmX21heF9zbGljZXMoZGV2X3ByaXYpKSB7Cj4gKwlpZiAocmVxX3NsaWNlcyA+IGludGVs
X2RidWZfbWF4X3NsaWNlcyhpOTE1KSkgewo+ICAgCQlEUk1fRVJST1IoIkludmFsaWQgbnVtYmVy
IG9mIGRidWYgc2xpY2VzIHJlcXVlc3RlZFxuIik7Cj4gICAJCXJldHVybjsKPiAgIAl9Cj4gQEAg
LTM1OTIsMTUgKzM1OTIsMTUgQEAgdm9pZCBpY2xfZGJ1Zl9zbGljZXNfdXBkYXRlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJaWYgKHJl
cV9zbGljZXMgPiBod19lbmFibGVkX3NsaWNlcykKPiAtCQlyZXQgPSBpbnRlbF9kYnVmX3NsaWNl
X3NldChkZXZfcHJpdiwgREJVRl9DVExfUzIsIHRydWUpOwo+ICsJCXJldCA9IGludGVsX2RidWZf
c2xpY2Vfc2V0KGk5MTUsIERCVUZfQ1RMX1MyLCB0cnVlKTsKPiAgIAllbHNlCj4gLQkJcmV0ID0g
aW50ZWxfZGJ1Zl9zbGljZV9zZXQoZGV2X3ByaXYsIERCVUZfQ1RMX1MyLCBmYWxzZSk7Cj4gKwkJ
cmV0ID0gaW50ZWxfZGJ1Zl9zbGljZV9zZXQoaTkxNSwgREJVRl9DVExfUzIsIGZhbHNlKTsKPiAg
IAo+ICAgCWlmIChyZXQpCj4gLQkJZGV2X3ByaXYtPndtLnNrbF9ody5kZGIuZW5hYmxlZF9zbGlj
ZXMgPSByZXFfc2xpY2VzOwo+ICsJCWk5MTUtPndtLnNrbF9ody5kZGIuZW5hYmxlZF9zbGljZXMg
PSByZXFfc2xpY2VzOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGljbF9kYnVmX2VuYWJsZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGljbF9kYnVm
X2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAlJOTE1X1dS
SVRFKERCVUZfQ1RMX1MxLCBJOTE1X1JFQUQoREJVRl9DVExfUzEpIHwgREJVRl9QT1dFUl9SRVFV
RVNUKTsKPiAgIAlJOTE1X1dSSVRFKERCVUZfQ1RMX1MyLCBJOTE1X1JFQUQoREJVRl9DVExfUzIp
IHwgREJVRl9QT1dFUl9SRVFVRVNUKTsKPiBAQCAtMzYxNiwxMCArMzYxNiwxMCBAQCBzdGF0aWMg
dm9pZCBpY2xfZGJ1Zl9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ICAgCQkgKiBGSVhNRTogZm9yIG5vdyBwcmV0ZW5kIHRoYXQgd2Ugb25seSBoYXZlIDEgc2xpY2Us
IHNlZQo+ICAgCQkgKiBpbnRlbF9lbmFibGVkX2RidWZfc2xpY2VzX251bSgpLgo+ICAgCQkgKi8K
PiAtCQlkZXZfcHJpdi0+d20uc2tsX2h3LmRkYi5lbmFibGVkX3NsaWNlcyA9IDE7Cj4gKwkJaTkx
NS0+d20uc2tsX2h3LmRkYi5lbmFibGVkX3NsaWNlcyA9IDE7Cj4gICB9Cj4gICAKPiAtc3RhdGlj
IHZvaWQgaWNsX2RidWZfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gK3N0YXRpYyB2b2lkIGljbF9kYnVmX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCj4gICB7Cj4gICAJSTkxNV9XUklURShEQlVGX0NUTF9TMSwgSTkxNV9SRUFEKERCVUZf
Q1RMX1MxKSAmIH5EQlVGX1BPV0VSX1JFUVVFU1QpOwo+ICAgCUk5MTVfV1JJVEUoREJVRl9DVExf
UzIsIEk5MTVfUkVBRChEQlVGX0NUTF9TMikgJiB+REJVRl9QT1dFUl9SRVFVRVNUKTsKPiBAQCAt
MzYzNSwxMCArMzYzNSwxMCBAQCBzdGF0aWMgdm9pZCBpY2xfZGJ1Zl9kaXNhYmxlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkJICogRklYTUU6IGZvciBub3cgcHJldGVu
ZCB0aGF0IHRoZSBmaXJzdCBzbGljZSBpcyBhbHdheXMKPiAgIAkJICogZW5hYmxlZCwgc2VlIGlu
dGVsX2VuYWJsZWRfZGJ1Zl9zbGljZXNfbnVtKCkuCj4gICAJCSAqLwo+IC0JCWRldl9wcml2LT53
bS5za2xfaHcuZGRiLmVuYWJsZWRfc2xpY2VzID0gMTsKPiArCQlpOTE1LT53bS5za2xfaHcuZGRi
LmVuYWJsZWRfc2xpY2VzID0gMTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpY2xfbWJ1c19p
bml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaWNs
X21idXNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAl1MzIg
dmFsOwo+ICAgCj4gQEAgLTM2NTAsNyArMzY1MCw3IEBAIHN0YXRpYyB2b2lkIGljbF9tYnVzX2lu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCUk5MTVfV1JJVEUoTUJV
U19BQk9YX0NUTCwgdmFsKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBoc3dfYXNzZXJ0X2Nk
Y2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaHN3
X2Fzc2VydF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAl1
MzIgdmFsID0gSTkxNV9SRUFEKExDUExMX0NUTCk7Cj4gICAKPiBAQCAtMzY3MCw5ICszNjcwLDkg
QEAgc3RhdGljIHZvaWQgaHN3X2Fzc2VydF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gICAJCURSTV9FUlJPUigiTENQTEwgbm90IHVzaW5nIG5vbi1TU0MgcmVmZXJl
bmNlXG4iKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBhc3NlcnRfY2FuX2Rpc2FibGVfbGNw
bGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBhc3Nl
cnRfY2FuX2Rpc2FibGVfbGNwbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmRldl9wcml2LT5kcm07Cj4gKwlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2ID0gJmk5MTUtPmRybTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YzsKPiAgIAo+ICAgCWZvcl9lYWNoX2ludGVsX2NydGMoZGV2LCBjcnRjKQo+IEBAIC0zNjkxLDcg
KzM2OTEsNyBAQCBzdGF0aWMgdm9pZCBhc3NlcnRfY2FuX2Rpc2FibGVfbGNwbGwoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQkJIlBhbmVsIHBvd2VyIG9uXG4iKTsKPiAg
IAlJOTE1X1NUQVRFX1dBUk4oSTkxNV9SRUFEKEJMQ19QV01fQ1BVX0NUTDIpICYgQkxNX1BXTV9F
TkFCTEUsCj4gICAJCQkiQ1BVIFBXTTEgZW5hYmxlZFxuIik7Cj4gLQlpZiAoSVNfSEFTV0VMTChk
ZXZfcHJpdikpCj4gKwlpZiAoSVNfSEFTV0VMTChpOTE1KSkKPiAgIAkJSTkxNV9TVEFURV9XQVJO
KEk5MTVfUkVBRChIU1dfQkxDX1BXTTJfQ1RMKSAmIEJMTV9QV01fRU5BQkxFLAo+ICAgCQkJCSJD
UFUgUFdNMiBlbmFibGVkXG4iKTsKPiAgIAlJOTE1X1NUQVRFX1dBUk4oSTkxNV9SRUFEKEJMQ19Q
V01fUENIX0NUTDEpICYgQkxNX1BDSF9QV01fRU5BQkxFLAo+IEBAIC0zNzA3LDIxICszNzA3LDIx
IEBAIHN0YXRpYyB2b2lkIGFzc2VydF9jYW5fZGlzYWJsZV9sY3BsbChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICogZ2VuLXNwZWNpZmljIGFuZCBzaW5jZSB3ZSBvbmx5
IGRpc2FibGUgTENQTEwgYWZ0ZXIgd2UgZnVsbHkgZGlzYWJsZQo+ICAgCSAqIHRoZSBpbnRlcnJ1
cHRzLCB0aGUgY2hlY2sgYmVsb3cgc2hvdWxkIGJlIGVub3VnaC4KPiAgIAkgKi8KPiAtCUk5MTVf
U1RBVEVfV0FSTihpbnRlbF9pcnFzX2VuYWJsZWQoZGV2X3ByaXYpLCAiSVJRcyBlbmFibGVkXG4i
KTsKPiArCUk5MTVfU1RBVEVfV0FSTihpbnRlbF9pcnFzX2VuYWJsZWQoaTkxNSksICJJUlFzIGVu
YWJsZWRcbiIpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB1MzIgaHN3X3JlYWRfZGNvbXAoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdTMyIGhzd19yZWFkX2Rjb21w
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JaWYgKElTX0hBU1dFTEwo
ZGV2X3ByaXYpKQo+ICsJaWYgKElTX0hBU1dFTEwoaTkxNSkpCj4gICAJCXJldHVybiBJOTE1X1JF
QUQoRF9DT01QX0hTVyk7Cj4gICAJZWxzZQo+ICAgCQlyZXR1cm4gSTkxNV9SRUFEKERfQ09NUF9C
RFcpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGhzd193cml0ZV9kY29tcChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiB2YWwpCj4gK3N0YXRpYyB2b2lkIGhzd193cml0
ZV9kY29tcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIHZhbCkKPiAgIHsKPiAt
CWlmIChJU19IQVNXRUxMKGRldl9wcml2KSkgewo+IC0JCWlmIChzYW5keWJyaWRnZV9wY29kZV93
cml0ZShkZXZfcHJpdiwKPiArCWlmIChJU19IQVNXRUxMKGk5MTUpKSB7Cj4gKwkJaWYgKHNhbmR5
YnJpZGdlX3Bjb2RlX3dyaXRlKGk5MTUsCj4gICAJCQkJCSAgICBHRU42X1BDT0RFX1dSSVRFX0Rf
Q09NUCwgdmFsKSkKPiAgIAkJCURSTV9ERUJVR19LTVMoIkZhaWxlZCB0byB3cml0ZSB0byBEX0NP
TVBcbiIpOwo+ICAgCX0gZWxzZSB7Cj4gQEAgLTM3MzgsMTIgKzM3MzgsMTIgQEAgc3RhdGljIHZv
aWQgaHN3X3dyaXRlX2Rjb21wKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMy
IHZhbCkKPiAgICAqIHJlZ2lzdGVyLiBDYWxsZXJzIHNob3VsZCB0YWtlIGNhcmUgb2YgZGlzYWJs
aW5nIGFsbCB0aGUgZGlzcGxheSBlbmdpbmUKPiAgICAqIGZ1bmN0aW9ucywgZG9pbmcgdGhlIG1v
ZGUgdW5zZXQsIGZpeGluZyBpbnRlcnJ1cHRzLCBldGMuCj4gICAgKi8KPiAtc3RhdGljIHZvaWQg
aHN3X2Rpc2FibGVfbGNwbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtz
dGF0aWMgdm9pZCBoc3dfZGlzYWJsZV9sY3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiAgIAkJCSAgICAgIGJvb2wgc3dpdGNoX3RvX2ZjbGssIGJvb2wgYWxsb3dfcG93ZXJfZG93
bikKPiAgIHsKPiAgIAl1MzIgdmFsOwo+ICAgCj4gLQlhc3NlcnRfY2FuX2Rpc2FibGVfbGNwbGwo
ZGV2X3ByaXYpOwo+ICsJYXNzZXJ0X2Nhbl9kaXNhYmxlX2xjcGxsKGk5MTUpOwo+ICAgCj4gICAJ
dmFsID0gSTkxNV9SRUFEKExDUExMX0NUTCk7Cj4gICAKPiBAQCAtMzc2MiwxNiArMzc2MiwxNiBA
QCBzdGF0aWMgdm9pZCBoc3dfZGlzYWJsZV9sY3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gICAJSTkxNV9XUklURShMQ1BMTF9DVEwsIHZhbCk7Cj4gICAJUE9TVElOR19S
RUFEKExDUExMX0NUTCk7Cj4gICAKPiAtCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2
X3ByaXYtPnVuY29yZSwgTENQTExfQ1RMLAo+ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVy
KCZpOTE1LT51bmNvcmUsIExDUExMX0NUTCwKPiAgIAkJCQkgICAgTENQTExfUExMX0xPQ0ssIDAs
IDEpKQo+ICAgCQlEUk1fRVJST1IoIkxDUExMIHN0aWxsIGxvY2tlZFxuIik7Cj4gICAKPiAtCXZh
bCA9IGhzd19yZWFkX2Rjb21wKGRldl9wcml2KTsKPiArCXZhbCA9IGhzd19yZWFkX2Rjb21wKGk5
MTUpOwo+ICAgCXZhbCB8PSBEX0NPTVBfQ09NUF9ESVNBQkxFOwo+IC0JaHN3X3dyaXRlX2Rjb21w
KGRldl9wcml2LCB2YWwpOwo+ICsJaHN3X3dyaXRlX2Rjb21wKGk5MTUsIHZhbCk7Cj4gICAJbmRl
bGF5KDEwMCk7Cj4gICAKPiAtCWlmICh3YWl0X2ZvcigoaHN3X3JlYWRfZGNvbXAoZGV2X3ByaXYp
ICYKPiArCWlmICh3YWl0X2ZvcigoaHN3X3JlYWRfZGNvbXAoaTkxNSkgJgo+ICAgCQkgICAgICBE
X0NPTVBfUkNPTVBfSU5fUFJPR1JFU1MpID09IDAsIDEpKQo+ICAgCQlEUk1fRVJST1IoIkRfQ09N
UCBSQ09NUCBzdGlsbCBpbiBwcm9ncmVzc1xuIik7Cj4gICAKPiBAQCAtMzc4Nyw3ICszNzg3LDcg
QEAgc3RhdGljIHZvaWQgaHN3X2Rpc2FibGVfbGNwbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICAgICogRnVsbHkgcmVzdG9yZXMgTENQTEwsIGRpc2FsbG93aW5nIHBvd2Vy
IGRvd24gYW5kIHN3aXRjaGluZyBiYWNrIHRvIExDUExMCj4gICAgKiBzb3VyY2UuCj4gICAgKi8K
PiAtc3RhdGljIHZvaWQgaHN3X3Jlc3RvcmVfbGNwbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBoc3dfcmVzdG9yZV9sY3BsbChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAl1MzIgdmFsOwo+ICAgCj4gQEAgLTM4MDEsNyAr
MzgwMSw3IEBAIHN0YXRpYyB2b2lkIGhzd19yZXN0b3JlX2xjcGxsKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiAgIAkgKiBNYWtlIHN1cmUgd2UncmUgbm90IG9uIFBDOCBzdGF0
ZSBiZWZvcmUgZGlzYWJsaW5nIFBDOCwgb3RoZXJ3aXNlCj4gICAJICogd2UnbGwgaGFuZyB0aGUg
bWFjaGluZS4gVG8gcHJldmVudCBQQzggc3RhdGUsIGp1c3QgZW5hYmxlIGZvcmNlX3dha2UuCj4g
ICAJICovCj4gLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwg
Rk9SQ0VXQUtFX0FMTCk7Cj4gKwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmaTkxNS0+dW5j
b3JlLCBGT1JDRVdBS0VfQUxMKTsKPiAgIAo+ICAgCWlmICh2YWwgJiBMQ1BMTF9QT1dFUl9ET1dO
X0FMTE9XKSB7Cj4gICAJCXZhbCAmPSB+TENQTExfUE9XRVJfRE9XTl9BTExPVzsKPiBAQCAtMzgw
OSwxNiArMzgwOSwxNiBAQCBzdGF0aWMgdm9pZCBoc3dfcmVzdG9yZV9sY3BsbChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCVBPU1RJTkdfUkVBRChMQ1BMTF9DVEwpOwo+
ICAgCX0KPiAgIAo+IC0JdmFsID0gaHN3X3JlYWRfZGNvbXAoZGV2X3ByaXYpOwo+ICsJdmFsID0g
aHN3X3JlYWRfZGNvbXAoaTkxNSk7Cj4gICAJdmFsIHw9IERfQ09NUF9DT01QX0ZPUkNFOwo+ICAg
CXZhbCAmPSB+RF9DT01QX0NPTVBfRElTQUJMRTsKPiAtCWhzd193cml0ZV9kY29tcChkZXZfcHJp
diwgdmFsKTsKPiArCWhzd193cml0ZV9kY29tcChpOTE1LCB2YWwpOwo+ICAgCj4gICAJdmFsID0g
STkxNV9SRUFEKExDUExMX0NUTCk7Cj4gICAJdmFsICY9IH5MQ1BMTF9QTExfRElTQUJMRTsKPiAg
IAlJOTE1X1dSSVRFKExDUExMX0NUTCwgdmFsKTsKPiAgIAo+IC0JaWYgKGludGVsX3dhaXRfZm9y
X3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLCBMQ1BMTF9DVEwsCj4gKwlpZiAoaW50ZWxfd2Fp
dF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwgTENQTExfQ1RMLAo+ICAgCQkJCSAgICBMQ1BM
TF9QTExfTE9DSywgTENQTExfUExMX0xPQ0ssIDUpKQo+ICAgCQlEUk1fRVJST1IoIkxDUExMIG5v
dCBsb2NrZWQgeWV0XG4iKTsKPiAgIAo+IEBAIC0zODMyLDEwICszODMyLDEwIEBAIHN0YXRpYyB2
b2lkIGhzd19yZXN0b3JlX2xjcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiAgIAkJCURSTV9FUlJPUigiU3dpdGNoaW5nIGJhY2sgdG8gTENQTEwgZmFpbGVkXG4iKTsKPiAg
IAl9Cj4gICAKPiAtCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZkZXZfcHJpdi0+dW5jb3Jl
LCBGT1JDRVdBS0VfQUxMKTsKPiArCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZpOTE1LT51
bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ICAgCj4gLQlpbnRlbF91cGRhdGVfY2RjbGsoZGV2X3By
aXYpOwo+IC0JaW50ZWxfZHVtcF9jZGNsa19zdGF0ZSgmZGV2X3ByaXYtPmNkY2xrLmh3LCAiQ3Vy
cmVudCBDRENMSyIpOwo+ICsJaW50ZWxfdXBkYXRlX2NkY2xrKGk5MTUpOwo+ICsJaW50ZWxfZHVt
cF9jZGNsa19zdGF0ZSgmaTkxNS0+Y2RjbGsuaHcsICJDdXJyZW50IENEQ0xLIik7Cj4gICB9Cj4g
ICAKPiAgIC8qCj4gQEAgLTM4NjEsNDUgKzM4NjEsNDUgQEAgc3RhdGljIHZvaWQgaHN3X3Jlc3Rv
cmVfbGNwbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgICogRm9yIG1v
cmUsIHJlYWQgIkRpc3BsYXkgU2VxdWVuY2VzIGZvciBQYWNrYWdlIEM4IiBvbiB0aGUgaGFyZHdh
cmUKPiAgICAqIGRvY3VtZW50YXRpb24uCj4gICAgKi8KPiAtdm9pZCBoc3dfZW5hYmxlX3BjOChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgaHN3X2VuYWJsZV9wYzgo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJdTMyIHZhbDsKPiAgIAo+
ICAgCURSTV9ERUJVR19LTVMoIkVuYWJsaW5nIHBhY2thZ2UgQzgrXG4iKTsKPiAgIAo+IC0JaWYg
KEhBU19QQ0hfTFBUX0xQKGRldl9wcml2KSkgewo+ICsJaWYgKEhBU19QQ0hfTFBUX0xQKGk5MTUp
KSB7Cj4gICAJCXZhbCA9IEk5MTVfUkVBRChTT1VUSF9EU1BDTEtfR0FURV9EKTsKPiAgIAkJdmFs
ICY9IH5QQ0hfTFBfUEFSVElUSU9OX0xFVkVMX0RJU0FCTEU7Cj4gICAJCUk5MTVfV1JJVEUoU09V
VEhfRFNQQ0xLX0dBVEVfRCwgdmFsKTsKPiAgIAl9Cj4gICAKPiAtCWxwdF9kaXNhYmxlX2Nsa291
dF9kcChkZXZfcHJpdik7Cj4gLQloc3dfZGlzYWJsZV9sY3BsbChkZXZfcHJpdiwgdHJ1ZSwgdHJ1
ZSk7Cj4gKwlscHRfZGlzYWJsZV9jbGtvdXRfZHAoaTkxNSk7Cj4gKwloc3dfZGlzYWJsZV9sY3Bs
bChpOTE1LCB0cnVlLCB0cnVlKTsKPiAgIH0KPiAgIAo+IC12b2lkIGhzd19kaXNhYmxlX3BjOChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgaHN3X2Rpc2FibGVfcGM4
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUzMiB2YWw7Cj4gICAK
PiAgIAlEUk1fREVCVUdfS01TKCJEaXNhYmxpbmcgcGFja2FnZSBDOCtcbiIpOwo+ICAgCj4gLQlo
c3dfcmVzdG9yZV9sY3BsbChkZXZfcHJpdik7Cj4gLQlpbnRlbF9pbml0X3BjaF9yZWZjbGsoZGV2
X3ByaXYpOwo+ICsJaHN3X3Jlc3RvcmVfbGNwbGwoaTkxNSk7Cj4gKwlpbnRlbF9pbml0X3BjaF9y
ZWZjbGsoaTkxNSk7Cj4gICAKPiAtCWlmIChIQVNfUENIX0xQVF9MUChkZXZfcHJpdikpIHsKPiAr
CWlmIChIQVNfUENIX0xQVF9MUChpOTE1KSkgewo+ICAgCQl2YWwgPSBJOTE1X1JFQUQoU09VVEhf
RFNQQ0xLX0dBVEVfRCk7Cj4gICAJCXZhbCB8PSBQQ0hfTFBfUEFSVElUSU9OX0xFVkVMX0RJU0FC
TEU7Cj4gICAJCUk5MTVfV1JJVEUoU09VVEhfRFNQQ0xLX0dBVEVfRCwgdmFsKTsKPiAgIAl9Cj4g
ICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaW50ZWxfcGNoX3Jlc2V0X2hhbmRzaGFrZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGludGVsX3BjaF9yZXNl
dF9oYW5kc2hha2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgICAg
Ym9vbCBlbmFibGUpCj4gICB7Cj4gICAJaTkxNV9yZWdfdCByZWc7Cj4gICAJdTMyIHJlc2V0X2Jp
dHMsIHZhbDsKPiAgIAo+IC0JaWYgKElTX0lWWUJSSURHRShkZXZfcHJpdikpIHsKPiArCWlmIChJ
U19JVllCUklER0UoaTkxNSkpIHsKPiAgIAkJcmVnID0gR0VON19NU0dfQ1RMOwo+ICAgCQlyZXNl
dF9iaXRzID0gV0FJVF9GT1JfUENIX0ZMUl9BQ0sgfCBXQUlUX0ZPUl9QQ0hfUkVTRVRfQUNLOwo+
ICAgCX0gZWxzZSB7Cj4gQEAgLTM5MTcsNDYgKzM5MTcsNDYgQEAgc3RhdGljIHZvaWQgaW50ZWxf
cGNoX3Jlc2V0X2hhbmRzaGFrZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
ICAJSTkxNV9XUklURShyZWcsIHZhbCk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgc2tsX2Rp
c3BsYXlfY29yZV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3Rh
dGljIHZvaWQgc2tsX2Rpc3BsYXlfY29yZV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ICAgCQkJCSAgYm9vbCByZXN1bWUpCj4gICB7Cj4gLQlzdHJ1Y3QgaTkxNV9wb3dlcl9k
b21haW5zICpwb3dlcl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOwo+ICsJc3Ry
dWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucyA9ICZpOTE1LT5wb3dlcl9kb21h
aW5zOwo+ICAgCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKndlbGw7Cj4gICAKPiAtCWdlbjlfc2V0
X2RjX3N0YXRlKGRldl9wcml2LCBEQ19TVEFURV9ESVNBQkxFKTsKPiArCWdlbjlfc2V0X2RjX3N0
YXRlKGk5MTUsIERDX1NUQVRFX0RJU0FCTEUpOwo+ICAgCj4gICAJLyogZW5hYmxlIFBDSCByZXNl
dCBoYW5kc2hha2UgKi8KPiAtCWludGVsX3BjaF9yZXNldF9oYW5kc2hha2UoZGV2X3ByaXYsICFI
QVNfUENIX05PUChkZXZfcHJpdikpOwo+ICsJaW50ZWxfcGNoX3Jlc2V0X2hhbmRzaGFrZShpOTE1
LCAhSEFTX1BDSF9OT1AoaTkxNSkpOwo+ICAgCj4gICAJLyogZW5hYmxlIFBHMSBhbmQgTWlzYyBJ
L08gKi8KPiAgIAltdXRleF9sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKPiAgIAo+IC0Jd2Vs
bCA9IGxvb2t1cF9wb3dlcl93ZWxsKGRldl9wcml2LCBTS0xfRElTUF9QV18xKTsKPiAtCWludGVs
X3Bvd2VyX3dlbGxfZW5hYmxlKGRldl9wcml2LCB3ZWxsKTsKPiArCXdlbGwgPSBsb29rdXBfcG93
ZXJfd2VsbChpOTE1LCBTS0xfRElTUF9QV18xKTsKPiArCWludGVsX3Bvd2VyX3dlbGxfZW5hYmxl
KGk5MTUsIHdlbGwpOwo+ICAgCj4gLQl3ZWxsID0gbG9va3VwX3Bvd2VyX3dlbGwoZGV2X3ByaXYs
IFNLTF9ESVNQX1BXX01JU0NfSU8pOwo+IC0JaW50ZWxfcG93ZXJfd2VsbF9lbmFibGUoZGV2X3By
aXYsIHdlbGwpOwo+ICsJd2VsbCA9IGxvb2t1cF9wb3dlcl93ZWxsKGk5MTUsIFNLTF9ESVNQX1BX
X01JU0NfSU8pOwo+ICsJaW50ZWxfcG93ZXJfd2VsbF9lbmFibGUoaTkxNSwgd2VsbCk7Cj4gICAK
PiAgIAltdXRleF91bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwo+ICAgCj4gLQlpbnRlbF9j
ZGNsa19pbml0KGRldl9wcml2KTsKPiArCWludGVsX2NkY2xrX2luaXQoaTkxNSk7Cj4gICAKPiAt
CWdlbjlfZGJ1Zl9lbmFibGUoZGV2X3ByaXYpOwo+ICsJZ2VuOV9kYnVmX2VuYWJsZShpOTE1KTsK
PiAgIAo+IC0JaWYgKHJlc3VtZSAmJiBkZXZfcHJpdi0+Y3NyLmRtY19wYXlsb2FkKQo+IC0JCWlu
dGVsX2Nzcl9sb2FkX3Byb2dyYW0oZGV2X3ByaXYpOwo+ICsJaWYgKHJlc3VtZSAmJiBpOTE1LT5j
c3IuZG1jX3BheWxvYWQpCj4gKwkJaW50ZWxfY3NyX2xvYWRfcHJvZ3JhbShpOTE1KTsKPiAgIH0K
PiAgIAo+IC1zdGF0aWMgdm9pZCBza2xfZGlzcGxheV9jb3JlX3VuaW5pdChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIHNrbF9kaXNwbGF5X2NvcmVfdW5p
bml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RydWN0IGk5MTVf
cG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9tYWluczsK
PiArCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmaTkxNS0+cG93
ZXJfZG9tYWluczsKPiAgIAlzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICp3ZWxsOwo+ICAgCj4gLQln
ZW45X3NldF9kY19zdGF0ZShkZXZfcHJpdiwgRENfU1RBVEVfRElTQUJMRSk7Cj4gKwlnZW45X3Nl
dF9kY19zdGF0ZShpOTE1LCBEQ19TVEFURV9ESVNBQkxFKTsKPiAgIAo+IC0JZ2VuOV9kYnVmX2Rp
c2FibGUoZGV2X3ByaXYpOwo+ICsJZ2VuOV9kYnVmX2Rpc2FibGUoaTkxNSk7Cj4gICAKPiAtCWlu
dGVsX2NkY2xrX3VuaW5pdChkZXZfcHJpdik7Cj4gKwlpbnRlbF9jZGNsa191bmluaXQoaTkxNSk7
Cj4gICAKPiAgIAkvKiBUaGUgc3BlYyBkb2Vzbid0IGNhbGwgZm9yIHJlbW92aW5nIHRoZSByZXNl
dCBoYW5kc2hha2UgZmxhZyAqLwo+ICAgCS8qIGRpc2FibGUgUEcxIGFuZCBNaXNjIEkvTyAqLwo+
IEBAIC0zOTY5LDIxICszOTY5LDIxIEBAIHN0YXRpYyB2b2lkIHNrbF9kaXNwbGF5X2NvcmVfdW5p
bml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkgKiBOb3RlIHRoYXQg
ZXZlbiB0aG91Z2ggdGhlIGRyaXZlcidzIHJlcXVlc3QgaXMgcmVtb3ZlZCBwb3dlciB3ZWxsIDEK
PiAgIAkgKiBtYXkgc3RheSBlbmFibGVkIGFmdGVyIHRoaXMgZHVlIHRvIERNQydzIG93biByZXF1
ZXN0IG9uIGl0Lgo+ICAgCSAqLwo+IC0Jd2VsbCA9IGxvb2t1cF9wb3dlcl93ZWxsKGRldl9wcml2
LCBTS0xfRElTUF9QV18xKTsKPiAtCWludGVsX3Bvd2VyX3dlbGxfZGlzYWJsZShkZXZfcHJpdiwg
d2VsbCk7Cj4gKwl3ZWxsID0gbG9va3VwX3Bvd2VyX3dlbGwoaTkxNSwgU0tMX0RJU1BfUFdfMSk7
Cj4gKwlpbnRlbF9wb3dlcl93ZWxsX2Rpc2FibGUoaTkxNSwgd2VsbCk7Cj4gICAKPiAgIAltdXRl
eF91bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwo+ICAgCj4gICAJdXNsZWVwX3JhbmdlKDEw
LCAzMCk7CQkvKiAxMCB1cyBkZWxheSBwZXIgQnNwZWMgKi8KPiAgIH0KPiAgIAo+IC12b2lkIGJ4
dF9kaXNwbGF5X2NvcmVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
K3ZvaWQgYnh0X2Rpc3BsYXlfY29yZV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAo+ICAgCQkJICAgYm9vbCByZXN1bWUpCj4gICB7Cj4gLQlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21h
aW5zICpwb3dlcl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOwo+ICsJc3RydWN0
IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucyA9ICZpOTE1LT5wb3dlcl9kb21haW5z
Owo+ICAgCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKndlbGw7Cj4gICAKPiAtCWdlbjlfc2V0X2Rj
X3N0YXRlKGRldl9wcml2LCBEQ19TVEFURV9ESVNBQkxFKTsKPiArCWdlbjlfc2V0X2RjX3N0YXRl
KGk5MTUsIERDX1NUQVRFX0RJU0FCTEUpOwo+ICAgCj4gICAJLyoKPiAgIAkgKiBOREVfUlNUV1JO
X09QVCBSU1QgUENIIEhhbmRzaGFrZSBFbiBtdXN0IGFsd2F5cyBiZSAwYiBvbiBCWFQKPiBAQCAt
Mzk5MSwzNCArMzk5MSwzNCBAQCB2b2lkIGJ4dF9kaXNwbGF5X2NvcmVfaW5pdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJICogTW92ZSB0aGUgaGFuZHNoYWtlIHByb2dy
YW1taW5nIHRvIGluaXRpYWxpemF0aW9uIHNlcXVlbmNlLgo+ICAgCSAqIFByZXZpb3VzbHkgd2Fz
IGxlZnQgdXAgdG8gQklPUy4KPiAgIAkgKi8KPiAtCWludGVsX3BjaF9yZXNldF9oYW5kc2hha2Uo
ZGV2X3ByaXYsIGZhbHNlKTsKPiArCWludGVsX3BjaF9yZXNldF9oYW5kc2hha2UoaTkxNSwgZmFs
c2UpOwo+ICAgCj4gICAJLyogRW5hYmxlIFBHMSAqLwo+ICAgCW11dGV4X2xvY2soJnBvd2VyX2Rv
bWFpbnMtPmxvY2spOwo+ICAgCj4gLQl3ZWxsID0gbG9va3VwX3Bvd2VyX3dlbGwoZGV2X3ByaXYs
IFNLTF9ESVNQX1BXXzEpOwo+IC0JaW50ZWxfcG93ZXJfd2VsbF9lbmFibGUoZGV2X3ByaXYsIHdl
bGwpOwo+ICsJd2VsbCA9IGxvb2t1cF9wb3dlcl93ZWxsKGk5MTUsIFNLTF9ESVNQX1BXXzEpOwo+
ICsJaW50ZWxfcG93ZXJfd2VsbF9lbmFibGUoaTkxNSwgd2VsbCk7Cj4gICAKPiAgIAltdXRleF91
bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwo+ICAgCj4gLQlpbnRlbF9jZGNsa19pbml0KGRl
dl9wcml2KTsKPiArCWludGVsX2NkY2xrX2luaXQoaTkxNSk7Cj4gICAKPiAtCWdlbjlfZGJ1Zl9l
bmFibGUoZGV2X3ByaXYpOwo+ICsJZ2VuOV9kYnVmX2VuYWJsZShpOTE1KTsKPiAgIAo+IC0JaWYg
KHJlc3VtZSAmJiBkZXZfcHJpdi0+Y3NyLmRtY19wYXlsb2FkKQo+IC0JCWludGVsX2Nzcl9sb2Fk
X3Byb2dyYW0oZGV2X3ByaXYpOwo+ICsJaWYgKHJlc3VtZSAmJiBpOTE1LT5jc3IuZG1jX3BheWxv
YWQpCj4gKwkJaW50ZWxfY3NyX2xvYWRfcHJvZ3JhbShpOTE1KTsKPiAgIH0KPiAgIAo+IC12b2lk
IGJ4dF9kaXNwbGF5X2NvcmVfdW5pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiArdm9pZCBieHRfZGlzcGxheV9jb3JlX3VuaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFp
bnMgPSAmZGV2X3ByaXYtPnBvd2VyX2RvbWFpbnM7Cj4gKwlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21h
aW5zICpwb3dlcl9kb21haW5zID0gJmk5MTUtPnBvd2VyX2RvbWFpbnM7Cj4gICAJc3RydWN0IGk5
MTVfcG93ZXJfd2VsbCAqd2VsbDsKPiAgIAo+IC0JZ2VuOV9zZXRfZGNfc3RhdGUoZGV2X3ByaXYs
IERDX1NUQVRFX0RJU0FCTEUpOwo+ICsJZ2VuOV9zZXRfZGNfc3RhdGUoaTkxNSwgRENfU1RBVEVf
RElTQUJMRSk7Cj4gICAKPiAtCWdlbjlfZGJ1Zl9kaXNhYmxlKGRldl9wcml2KTsKPiArCWdlbjlf
ZGJ1Zl9kaXNhYmxlKGk5MTUpOwo+ICAgCj4gLQlpbnRlbF9jZGNsa191bmluaXQoZGV2X3ByaXYp
Owo+ICsJaW50ZWxfY2RjbGtfdW5pbml0KGk5MTUpOwo+ICAgCj4gICAJLyogVGhlIHNwZWMgZG9l
c24ndCBjYWxsIGZvciByZW1vdmluZyB0aGUgcmVzZXQgaGFuZHNoYWtlIGZsYWcgKi8KPiAgIAo+
IEBAIC00MDI5LDYwICs0MDI5LDYwIEBAIHZvaWQgYnh0X2Rpc3BsYXlfY29yZV91bmluaXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCSAqLwo+ICAgCW11dGV4X2xvY2so
JnBvd2VyX2RvbWFpbnMtPmxvY2spOwo+ICAgCj4gLQl3ZWxsID0gbG9va3VwX3Bvd2VyX3dlbGwo
ZGV2X3ByaXYsIFNLTF9ESVNQX1BXXzEpOwo+IC0JaW50ZWxfcG93ZXJfd2VsbF9kaXNhYmxlKGRl
dl9wcml2LCB3ZWxsKTsKPiArCXdlbGwgPSBsb29rdXBfcG93ZXJfd2VsbChpOTE1LCBTS0xfRElT
UF9QV18xKTsKPiArCWludGVsX3Bvd2VyX3dlbGxfZGlzYWJsZShpOTE1LCB3ZWxsKTsKPiAgIAo+
ICAgCW11dGV4X3VubG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7Cj4gICAKPiAgIAl1c2xlZXBf
cmFuZ2UoMTAsIDMwKTsJCS8qIDEwIHVzIGRlbGF5IHBlciBCc3BlYyAqLwo+ICAgfQo+ICAgCj4g
LXN0YXRpYyB2b2lkIGNubF9kaXNwbGF5X2NvcmVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsIGJvb2wgcmVzdW1lKQo+ICtzdGF0aWMgdm9pZCBjbmxfZGlzcGxheV9jb3Jl
X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGJvb2wgcmVzdW1lKQo+ICAgewo+
IC0Jc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucyA9ICZkZXZfcHJpdi0+
cG93ZXJfZG9tYWluczsKPiArCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFp
bnMgPSAmaTkxNS0+cG93ZXJfZG9tYWluczsKPiAgIAlzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICp3
ZWxsOwo+ICAgCj4gLQlnZW45X3NldF9kY19zdGF0ZShkZXZfcHJpdiwgRENfU1RBVEVfRElTQUJM
RSk7Cj4gKwlnZW45X3NldF9kY19zdGF0ZShpOTE1LCBEQ19TVEFURV9ESVNBQkxFKTsKPiAgIAo+
ICAgCS8qIDEuIEVuYWJsZSBQQ0ggUmVzZXQgSGFuZHNoYWtlICovCj4gLQlpbnRlbF9wY2hfcmVz
ZXRfaGFuZHNoYWtlKGRldl9wcml2LCAhSEFTX1BDSF9OT1AoZGV2X3ByaXYpKTsKPiArCWludGVs
X3BjaF9yZXNldF9oYW5kc2hha2UoaTkxNSwgIUhBU19QQ0hfTk9QKGk5MTUpKTsKPiAgIAo+ICAg
CS8qIDItMy4gKi8KPiAtCWludGVsX2NvbWJvX3BoeV9pbml0KGRldl9wcml2KTsKPiArCWludGVs
X2NvbWJvX3BoeV9pbml0KGk5MTUpOwo+ICAgCj4gICAJLyoKPiAgIAkgKiA0LiBFbmFibGUgUG93
ZXIgV2VsbCAxIChQRzEpLgo+ICAgCSAqICAgIFRoZSBBVVggSU8gcG93ZXIgd2VsbHMgd2lsbCBi
ZSBlbmFibGVkIG9uIGRlbWFuZC4KPiAgIAkgKi8KPiAgIAltdXRleF9sb2NrKCZwb3dlcl9kb21h
aW5zLT5sb2NrKTsKPiAtCXdlbGwgPSBsb29rdXBfcG93ZXJfd2VsbChkZXZfcHJpdiwgU0tMX0RJ
U1BfUFdfMSk7Cj4gLQlpbnRlbF9wb3dlcl93ZWxsX2VuYWJsZShkZXZfcHJpdiwgd2VsbCk7Cj4g
Kwl3ZWxsID0gbG9va3VwX3Bvd2VyX3dlbGwoaTkxNSwgU0tMX0RJU1BfUFdfMSk7Cj4gKwlpbnRl
bF9wb3dlcl93ZWxsX2VuYWJsZShpOTE1LCB3ZWxsKTsKPiAgIAltdXRleF91bmxvY2soJnBvd2Vy
X2RvbWFpbnMtPmxvY2spOwo+ICAgCj4gICAJLyogNS4gRW5hYmxlIENEIGNsb2NrICovCj4gLQlp
bnRlbF9jZGNsa19pbml0KGRldl9wcml2KTsKPiArCWludGVsX2NkY2xrX2luaXQoaTkxNSk7Cj4g
ICAKPiAgIAkvKiA2LiBFbmFibGUgREJVRiAqLwo+IC0JZ2VuOV9kYnVmX2VuYWJsZShkZXZfcHJp
dik7Cj4gKwlnZW45X2RidWZfZW5hYmxlKGk5MTUpOwo+ICAgCj4gLQlpZiAocmVzdW1lICYmIGRl
dl9wcml2LT5jc3IuZG1jX3BheWxvYWQpCj4gLQkJaW50ZWxfY3NyX2xvYWRfcHJvZ3JhbShkZXZf
cHJpdik7Cj4gKwlpZiAocmVzdW1lICYmIGk5MTUtPmNzci5kbWNfcGF5bG9hZCkKPiArCQlpbnRl
bF9jc3JfbG9hZF9wcm9ncmFtKGk5MTUpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGNubF9k
aXNwbGF5X2NvcmVfdW5pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAr
c3RhdGljIHZvaWQgY25sX2Rpc3BsYXlfY29yZV91bmluaXQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21h
aW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOwo+ICsJc3RydWN0IGk5MTVfcG93ZXJfZG9t
YWlucyAqcG93ZXJfZG9tYWlucyA9ICZpOTE1LT5wb3dlcl9kb21haW5zOwo+ICAgCXN0cnVjdCBp
OTE1X3Bvd2VyX3dlbGwgKndlbGw7Cj4gICAKPiAtCWdlbjlfc2V0X2RjX3N0YXRlKGRldl9wcml2
LCBEQ19TVEFURV9ESVNBQkxFKTsKPiArCWdlbjlfc2V0X2RjX3N0YXRlKGk5MTUsIERDX1NUQVRF
X0RJU0FCTEUpOwo+ICAgCj4gICAJLyogMS4gRGlzYWJsZSBhbGwgZGlzcGxheSBlbmdpbmUgZnVu
Y3Rpb25zIC0+IGFyZWFkeSBkb25lICovCj4gICAKPiAgIAkvKiAyLiBEaXNhYmxlIERCVUYgKi8K
PiAtCWdlbjlfZGJ1Zl9kaXNhYmxlKGRldl9wcml2KTsKPiArCWdlbjlfZGJ1Zl9kaXNhYmxlKGk5
MTUpOwo+ICAgCj4gICAJLyogMy4gRGlzYWJsZSBDRCBjbG9jayAqLwo+IC0JaW50ZWxfY2RjbGtf
dW5pbml0KGRldl9wcml2KTsKPiArCWludGVsX2NkY2xrX3VuaW5pdChpOTE1KTsKPiAgIAo+ICAg
CS8qCj4gICAJICogNC4gRGlzYWJsZSBQb3dlciBXZWxsIDEgKFBHMSkuCj4gQEAgLTQwOTAsNjYg
KzQwOTAsNjYgQEAgc3RhdGljIHZvaWQgY25sX2Rpc3BsYXlfY29yZV91bmluaXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCSAqICAgIGRpc2FibGVkIGF0IHRoaXMgcG9p
bnQuCj4gICAJICovCj4gICAJbXV0ZXhfbG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7Cj4gLQl3
ZWxsID0gbG9va3VwX3Bvd2VyX3dlbGwoZGV2X3ByaXYsIFNLTF9ESVNQX1BXXzEpOwo+IC0JaW50
ZWxfcG93ZXJfd2VsbF9kaXNhYmxlKGRldl9wcml2LCB3ZWxsKTsKPiArCXdlbGwgPSBsb29rdXBf
cG93ZXJfd2VsbChpOTE1LCBTS0xfRElTUF9QV18xKTsKPiArCWludGVsX3Bvd2VyX3dlbGxfZGlz
YWJsZShpOTE1LCB3ZWxsKTsKPiAgIAltdXRleF91bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2sp
Owo+ICAgCj4gICAJdXNsZWVwX3JhbmdlKDEwLCAzMCk7CQkvKiAxMCB1cyBkZWxheSBwZXIgQnNw
ZWMgKi8KPiAgIAo+ICAgCS8qIDUuICovCj4gLQlpbnRlbF9jb21ib19waHlfdW5pbml0KGRldl9w
cml2KTsKPiArCWludGVsX2NvbWJvX3BoeV91bmluaXQoaTkxNSk7Cj4gICB9Cj4gICAKPiAtdm9p
ZCBpY2xfZGlzcGxheV9jb3JlX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ICt2b2lkIGljbF9kaXNwbGF5X2NvcmVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiAgIAkJCSAgIGJvb2wgcmVzdW1lKQo+ICAgewo+IC0Jc3RydWN0IGk5MTVfcG93ZXJf
ZG9tYWlucyAqcG93ZXJfZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9tYWluczsKPiArCXN0
cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmaTkxNS0+cG93ZXJfZG9t
YWluczsKPiAgIAlzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICp3ZWxsOwo+ICAgCj4gLQlnZW45X3Nl
dF9kY19zdGF0ZShkZXZfcHJpdiwgRENfU1RBVEVfRElTQUJMRSk7Cj4gKwlnZW45X3NldF9kY19z
dGF0ZShpOTE1LCBEQ19TVEFURV9ESVNBQkxFKTsKPiAgIAo+ICAgCS8qIDEuIEVuYWJsZSBQQ0gg
cmVzZXQgaGFuZHNoYWtlLiAqLwo+IC0JaW50ZWxfcGNoX3Jlc2V0X2hhbmRzaGFrZShkZXZfcHJp
diwgIUhBU19QQ0hfTk9QKGRldl9wcml2KSk7Cj4gKwlpbnRlbF9wY2hfcmVzZXRfaGFuZHNoYWtl
KGk5MTUsICFIQVNfUENIX05PUChpOTE1KSk7Cj4gICAKPiAgIAkvKiAyLiBJbml0aWFsaXplIGFs
bCBjb21ibyBwaHlzICovCj4gLQlpbnRlbF9jb21ib19waHlfaW5pdChkZXZfcHJpdik7Cj4gKwlp
bnRlbF9jb21ib19waHlfaW5pdChpOTE1KTsKPiAgIAo+ICAgCS8qCj4gICAJICogMy4gRW5hYmxl
IFBvd2VyIFdlbGwgMSAoUEcxKS4KPiAgIAkgKiAgICBUaGUgQVVYIElPIHBvd2VyIHdlbGxzIHdp
bGwgYmUgZW5hYmxlZCBvbiBkZW1hbmQuCj4gICAJICovCj4gICAJbXV0ZXhfbG9jaygmcG93ZXJf
ZG9tYWlucy0+bG9jayk7Cj4gLQl3ZWxsID0gbG9va3VwX3Bvd2VyX3dlbGwoZGV2X3ByaXYsIFNL
TF9ESVNQX1BXXzEpOwo+IC0JaW50ZWxfcG93ZXJfd2VsbF9lbmFibGUoZGV2X3ByaXYsIHdlbGwp
Owo+ICsJd2VsbCA9IGxvb2t1cF9wb3dlcl93ZWxsKGk5MTUsIFNLTF9ESVNQX1BXXzEpOwo+ICsJ
aW50ZWxfcG93ZXJfd2VsbF9lbmFibGUoaTkxNSwgd2VsbCk7Cj4gICAJbXV0ZXhfdW5sb2NrKCZw
b3dlcl9kb21haW5zLT5sb2NrKTsKPiAgIAo+ICAgCS8qIDQuIEVuYWJsZSBDRENMSy4gKi8KPiAt
CWludGVsX2NkY2xrX2luaXQoZGV2X3ByaXYpOwo+ICsJaW50ZWxfY2RjbGtfaW5pdChpOTE1KTsK
PiAgIAo+ICAgCS8qIDUuIEVuYWJsZSBEQlVGLiAqLwo+IC0JaWNsX2RidWZfZW5hYmxlKGRldl9w
cml2KTsKPiArCWljbF9kYnVmX2VuYWJsZShpOTE1KTsKPiAgIAo+ICAgCS8qIDYuIFNldHVwIE1C
VVMuICovCj4gLQlpY2xfbWJ1c19pbml0KGRldl9wcml2KTsKPiArCWljbF9tYnVzX2luaXQoaTkx
NSk7Cj4gICAKPiAtCWlmIChyZXN1bWUgJiYgZGV2X3ByaXYtPmNzci5kbWNfcGF5bG9hZCkKPiAt
CQlpbnRlbF9jc3JfbG9hZF9wcm9ncmFtKGRldl9wcml2KTsKPiArCWlmIChyZXN1bWUgJiYgaTkx
NS0+Y3NyLmRtY19wYXlsb2FkKQo+ICsJCWludGVsX2Nzcl9sb2FkX3Byb2dyYW0oaTkxNSk7Cj4g
ICB9Cj4gICAKPiAtdm9pZCBpY2xfZGlzcGxheV9jb3JlX3VuaW5pdChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgaWNsX2Rpc3BsYXlfY29yZV91bmluaXQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21h
aW5zICpwb3dlcl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOwo+ICsJc3RydWN0
IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucyA9ICZpOTE1LT5wb3dlcl9kb21haW5z
Owo+ICAgCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKndlbGw7Cj4gICAKPiAtCWdlbjlfc2V0X2Rj
X3N0YXRlKGRldl9wcml2LCBEQ19TVEFURV9ESVNBQkxFKTsKPiArCWdlbjlfc2V0X2RjX3N0YXRl
KGk5MTUsIERDX1NUQVRFX0RJU0FCTEUpOwo+ICAgCj4gICAJLyogMS4gRGlzYWJsZSBhbGwgZGlz
cGxheSBlbmdpbmUgZnVuY3Rpb25zIC0+IGFyZWFkeSBkb25lICovCj4gICAKPiAgIAkvKiAyLiBE
aXNhYmxlIERCVUYgKi8KPiAtCWljbF9kYnVmX2Rpc2FibGUoZGV2X3ByaXYpOwo+ICsJaWNsX2Ri
dWZfZGlzYWJsZShpOTE1KTsKPiAgIAo+ICAgCS8qIDMuIERpc2FibGUgQ0QgY2xvY2sgKi8KPiAt
CWludGVsX2NkY2xrX3VuaW5pdChkZXZfcHJpdik7Cj4gKwlpbnRlbF9jZGNsa191bmluaXQoaTkx
NSk7Cj4gICAKPiAgIAkvKgo+ICAgCSAqIDQuIERpc2FibGUgUG93ZXIgV2VsbCAxIChQRzEpLgo+
IEBAIC00MTU3LDIwICs0MTU3LDIwIEBAIHZvaWQgaWNsX2Rpc3BsYXlfY29yZV91bmluaXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCSAqICAgIGRpc2FibGVkIGF0IHRo
aXMgcG9pbnQuCj4gICAJICovCj4gICAJbXV0ZXhfbG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7
Cj4gLQl3ZWxsID0gbG9va3VwX3Bvd2VyX3dlbGwoZGV2X3ByaXYsIFNLTF9ESVNQX1BXXzEpOwo+
IC0JaW50ZWxfcG93ZXJfd2VsbF9kaXNhYmxlKGRldl9wcml2LCB3ZWxsKTsKPiArCXdlbGwgPSBs
b29rdXBfcG93ZXJfd2VsbChpOTE1LCBTS0xfRElTUF9QV18xKTsKPiArCWludGVsX3Bvd2VyX3dl
bGxfZGlzYWJsZShpOTE1LCB3ZWxsKTsKPiAgIAltdXRleF91bmxvY2soJnBvd2VyX2RvbWFpbnMt
PmxvY2spOwo+ICAgCj4gICAJLyogNS4gKi8KPiAtCWludGVsX2NvbWJvX3BoeV91bmluaXQoZGV2
X3ByaXYpOwo+ICsJaW50ZWxfY29tYm9fcGh5X3VuaW5pdChpOTE1KTsKPiAgIH0KPiAgIAo+IC1z
dGF0aWMgdm9pZCBjaHZfcGh5X2NvbnRyb2xfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGNodl9waHlfY29udHJvbF9pbml0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKmNt
bl9iYyA9Cj4gLQkJbG9va3VwX3Bvd2VyX3dlbGwoZGV2X3ByaXYsIFZMVl9ESVNQX1BXX0RQSU9f
Q01OX0JDKTsKPiArCQlsb29rdXBfcG93ZXJfd2VsbChpOTE1LCBWTFZfRElTUF9QV19EUElPX0NN
Tl9CQyk7Cj4gICAJc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqY21uX2QgPQo+IC0JCWxvb2t1cF9w
b3dlcl93ZWxsKGRldl9wcml2LCBDSFZfRElTUF9QV19EUElPX0NNTl9EKTsKPiArCQlsb29rdXBf
cG93ZXJfd2VsbChpOTE1LCBDSFZfRElTUF9QV19EUElPX0NNTl9EKTsKPiAgIAo+ICAgCS8qCj4g
ICAJICogRElTUExBWV9QSFlfQ09OVFJPTCBjYW4gZ2V0IGNvcnJ1cHRlZCBpZiByZWFkLiBBcyBh
Cj4gQEAgLTQxNzksNyArNDE3OSw3IEBAIHN0YXRpYyB2b2lkIGNodl9waHlfY29udHJvbF9pbml0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkgKiBwb3dlciB3ZWxsIHN0
YXRlIGFuZCBsYW5lIHN0YXR1cyB0byByZWNvbnN0cnVjdCB0aGUKPiAgIAkgKiBleHBlY3RlZCBp
bml0aWFsIHZhbHVlLgo+ICAgCSAqLwo+IC0JZGV2X3ByaXYtPmNodl9waHlfY29udHJvbCA9Cj4g
KwlpOTE1LT5jaHZfcGh5X2NvbnRyb2wgPQo+ICAgCQlQSFlfTERPX1NFUV9ERUxBWShQSFlfTERP
X0RFTEFZXzYwME5TLCBEUElPX1BIWTApIHwKPiAgIAkJUEhZX0xET19TRVFfREVMQVkoUEhZX0xE
T19ERUxBWV82MDBOUywgRFBJT19QSFkxKSB8Cj4gICAJCVBIWV9DSF9QT1dFUl9NT0RFKFBIWV9D
SF9ERUVQX1BTUiwgRFBJT19QSFkwLCBEUElPX0NIMCkgfAo+IEBAIC00MTkzLDcgKzQxOTMsNyBA
QCBzdGF0aWMgdm9pZCBjaHZfcGh5X2NvbnRyb2xfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gICAJICogb3ZlcnJpZGUgYW5kIHNldCB0aGUgbGFuZSBwb3dlcmRvd24g
Yml0cyBhY2NkaW5nIHRvIHRoZQo+ICAgCSAqIGN1cnJlbnQgbGFuZSBzdGF0dXMuCj4gICAJICov
Cj4gLQlpZiAoY21uX2JjLT5kZXNjLT5vcHMtPmlzX2VuYWJsZWQoZGV2X3ByaXYsIGNtbl9iYykp
IHsKPiArCWlmIChjbW5fYmMtPmRlc2MtPm9wcy0+aXNfZW5hYmxlZChpOTE1LCBjbW5fYmMpKSB7
Cj4gICAJCXUzMiBzdGF0dXMgPSBJOTE1X1JFQUQoRFBMTChQSVBFX0EpKTsKPiAgIAkJdW5zaWdu
ZWQgaW50IG1hc2s7Cj4gICAKPiBAQCAtNDIwMSwzMCArNDIwMSwzMCBAQCBzdGF0aWMgdm9pZCBj
aHZfcGh5X2NvbnRyb2xfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
ICAJCWlmIChtYXNrID09IDB4ZikKPiAgIAkJCW1hc2sgPSAweDA7Cj4gICAJCWVsc2UKPiAtCQkJ
ZGV2X3ByaXYtPmNodl9waHlfY29udHJvbCB8PQo+ICsJCQlpOTE1LT5jaHZfcGh5X2NvbnRyb2wg
fD0KPiAgIAkJCQlQSFlfQ0hfUE9XRVJfRE9XTl9PVlJEX0VOKERQSU9fUEhZMCwgRFBJT19DSDAp
Owo+ICAgCj4gLQkJZGV2X3ByaXYtPmNodl9waHlfY29udHJvbCB8PQo+ICsJCWk5MTUtPmNodl9w
aHlfY29udHJvbCB8PQo+ICAgCQkJUEhZX0NIX1BPV0VSX0RPV05fT1ZSRChtYXNrLCBEUElPX1BI
WTAsIERQSU9fQ0gwKTsKPiAgIAo+ICAgCQltYXNrID0gKHN0YXR1cyAmIERQTExfUE9SVENfUkVB
RFlfTUFTSykgPj4gNDsKPiAgIAkJaWYgKG1hc2sgPT0gMHhmKQo+ICAgCQkJbWFzayA9IDB4MDsK
PiAgIAkJZWxzZQo+IC0JCQlkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sIHw9Cj4gKwkJCWk5MTUt
PmNodl9waHlfY29udHJvbCB8PQo+ICAgCQkJCVBIWV9DSF9QT1dFUl9ET1dOX09WUkRfRU4oRFBJ
T19QSFkwLCBEUElPX0NIMSk7Cj4gICAKPiAtCQlkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sIHw9
Cj4gKwkJaTkxNS0+Y2h2X3BoeV9jb250cm9sIHw9Cj4gICAJCQlQSFlfQ0hfUE9XRVJfRE9XTl9P
VlJEKG1hc2ssIERQSU9fUEhZMCwgRFBJT19DSDEpOwo+ICAgCj4gLQkJZGV2X3ByaXYtPmNodl9w
aHlfY29udHJvbCB8PSBQSFlfQ09NX0xBTkVfUkVTRVRfREVBU1NFUlQoRFBJT19QSFkwKTsKPiAr
CQlpOTE1LT5jaHZfcGh5X2NvbnRyb2wgfD0gUEhZX0NPTV9MQU5FX1JFU0VUX0RFQVNTRVJUKERQ
SU9fUEhZMCk7Cj4gICAKPiAtCQlkZXZfcHJpdi0+Y2h2X3BoeV9hc3NlcnRbRFBJT19QSFkwXSA9
IGZhbHNlOwo+ICsJCWk5MTUtPmNodl9waHlfYXNzZXJ0W0RQSU9fUEhZMF0gPSBmYWxzZTsKPiAg
IAl9IGVsc2Ugewo+IC0JCWRldl9wcml2LT5jaHZfcGh5X2Fzc2VydFtEUElPX1BIWTBdID0gdHJ1
ZTsKPiArCQlpOTE1LT5jaHZfcGh5X2Fzc2VydFtEUElPX1BIWTBdID0gdHJ1ZTsKPiAgIAl9Cj4g
ICAKPiAtCWlmIChjbW5fZC0+ZGVzYy0+b3BzLT5pc19lbmFibGVkKGRldl9wcml2LCBjbW5fZCkp
IHsKPiArCWlmIChjbW5fZC0+ZGVzYy0+b3BzLT5pc19lbmFibGVkKGk5MTUsIGNtbl9kKSkgewo+
ICAgCQl1MzIgc3RhdHVzID0gSTkxNV9SRUFEKERQSU9fUEhZX1NUQVRVUyk7Cj4gICAJCXVuc2ln
bmVkIGludCBtYXNrOwo+ICAgCj4gQEAgLTQyMzMsNDIgKzQyMzMsNDIgQEAgc3RhdGljIHZvaWQg
Y2h2X3BoeV9jb250cm9sX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ICAgCQlpZiAobWFzayA9PSAweGYpCj4gICAJCQltYXNrID0gMHgwOwo+ICAgCQllbHNlCj4gLQkJ
CWRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wgfD0KPiArCQkJaTkxNS0+Y2h2X3BoeV9jb250cm9s
IHw9Cj4gICAJCQkJUEhZX0NIX1BPV0VSX0RPV05fT1ZSRF9FTihEUElPX1BIWTEsIERQSU9fQ0gw
KTsKPiAgIAo+IC0JCWRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wgfD0KPiArCQlpOTE1LT5jaHZf
cGh5X2NvbnRyb2wgfD0KPiAgIAkJCVBIWV9DSF9QT1dFUl9ET1dOX09WUkQobWFzaywgRFBJT19Q
SFkxLCBEUElPX0NIMCk7Cj4gICAKPiAtCQlkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sIHw9IFBI
WV9DT01fTEFORV9SRVNFVF9ERUFTU0VSVChEUElPX1BIWTEpOwo+ICsJCWk5MTUtPmNodl9waHlf
Y29udHJvbCB8PSBQSFlfQ09NX0xBTkVfUkVTRVRfREVBU1NFUlQoRFBJT19QSFkxKTsKPiAgIAo+
IC0JCWRldl9wcml2LT5jaHZfcGh5X2Fzc2VydFtEUElPX1BIWTFdID0gZmFsc2U7Cj4gKwkJaTkx
NS0+Y2h2X3BoeV9hc3NlcnRbRFBJT19QSFkxXSA9IGZhbHNlOwo+ICAgCX0gZWxzZSB7Cj4gLQkJ
ZGV2X3ByaXYtPmNodl9waHlfYXNzZXJ0W0RQSU9fUEhZMV0gPSB0cnVlOwo+ICsJCWk5MTUtPmNo
dl9waHlfYXNzZXJ0W0RQSU9fUEhZMV0gPSB0cnVlOwo+ICAgCX0KPiAgIAo+IC0JSTkxNV9XUklU
RShESVNQTEFZX1BIWV9DT05UUk9MLCBkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sKTsKPiArCUk5
MTVfV1JJVEUoRElTUExBWV9QSFlfQ09OVFJPTCwgaTkxNS0+Y2h2X3BoeV9jb250cm9sKTsKPiAg
IAo+ICAgCURSTV9ERUJVR19LTVMoIkluaXRpYWwgUEhZX0NPTlRST0w9MHglMDh4XG4iLAo+IC0J
CSAgICAgIGRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wpOwo+ICsJCSAgICAgIGk5MTUtPmNodl9w
aHlfY29udHJvbCk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgdmx2X2NtbmxhbmVfd2Eoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCB2bHZfY21ubGFu
ZV93YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaTkx
NV9wb3dlcl93ZWxsICpjbW4gPQo+IC0JCWxvb2t1cF9wb3dlcl93ZWxsKGRldl9wcml2LCBWTFZf
RElTUF9QV19EUElPX0NNTl9CQyk7Cj4gKwkJbG9va3VwX3Bvd2VyX3dlbGwoaTkxNSwgVkxWX0RJ
U1BfUFdfRFBJT19DTU5fQkMpOwo+ICAgCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKmRpc3AyZCA9
Cj4gLQkJbG9va3VwX3Bvd2VyX3dlbGwoZGV2X3ByaXYsIFZMVl9ESVNQX1BXX0RJU1AyRCk7Cj4g
KwkJbG9va3VwX3Bvd2VyX3dlbGwoaTkxNSwgVkxWX0RJU1BfUFdfRElTUDJEKTsKPiAgIAo+ICAg
CS8qIElmIHRoZSBkaXNwbGF5IG1pZ2h0IGJlIGFscmVhZHkgYWN0aXZlIHNraXAgdGhpcyAqLwo+
IC0JaWYgKGNtbi0+ZGVzYy0+b3BzLT5pc19lbmFibGVkKGRldl9wcml2LCBjbW4pICYmCj4gLQkg
ICAgZGlzcDJkLT5kZXNjLT5vcHMtPmlzX2VuYWJsZWQoZGV2X3ByaXYsIGRpc3AyZCkgJiYKPiAr
CWlmIChjbW4tPmRlc2MtPm9wcy0+aXNfZW5hYmxlZChpOTE1LCBjbW4pICYmCj4gKwkgICAgZGlz
cDJkLT5kZXNjLT5vcHMtPmlzX2VuYWJsZWQoaTkxNSwgZGlzcDJkKSAmJgo+ICAgCSAgICBJOTE1
X1JFQUQoRFBJT19DVEwpICYgRFBJT19DTU5SU1QpCj4gICAJCXJldHVybjsKPiAgIAo+ICAgCURS
TV9ERUJVR19LTVMoInRvZ2dsaW5nIGRpc3BsYXkgUEhZIHNpZGUgcmVzZXRcbiIpOwo+ICAgCj4g
ICAJLyogY21ubGFuZSBuZWVkcyBEUExMIHJlZ2lzdGVycyAqLwo+IC0JZGlzcDJkLT5kZXNjLT5v
cHMtPmVuYWJsZShkZXZfcHJpdiwgZGlzcDJkKTsKPiArCWRpc3AyZC0+ZGVzYy0+b3BzLT5lbmFi
bGUoaTkxNSwgZGlzcDJkKTsKPiAgIAo+ICAgCS8qCj4gICAJICogRnJvbSBWTFYyQTBfRFBfZURQ
X0hETUlfRFBJT19kcml2ZXJfdmJpb3Nfbm90ZXNfMTEuZG9jeDoKPiBAQCAtNDI3NywyNyArNDI3
NywyNyBAQCBzdGF0aWMgdm9pZCB2bHZfY21ubGFuZV93YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gICAJICogU2ltcGx5IHVuZ2F0aW5nIGlzbid0IGVub3VnaCB0byByZXNl
dCB0aGUgUEhZIGVub3VnaCB0byBnZXQKPiAgIAkgKiBwb3J0cyBhbmQgbGFuZXMgcnVubmluZy4K
PiAgIAkgKi8KPiAtCWNtbi0+ZGVzYy0+b3BzLT5kaXNhYmxlKGRldl9wcml2LCBjbW4pOwo+ICsJ
Y21uLT5kZXNjLT5vcHMtPmRpc2FibGUoaTkxNSwgY21uKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMg
Ym9vbCB2bHZfcHVuaXRfaXNfcG93ZXJfZ2F0ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LCB1MzIgcmVnMCkKPiArc3RhdGljIGJvb2wgdmx2X3B1bml0X2lzX3Bvd2VyX2dhdGVk
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgcmVnMCkKPiAgIHsKPiAgIAlib29s
IHJldDsKPiAgIAo+IC0Jdmx2X3B1bml0X2dldChkZXZfcHJpdik7Cj4gLQlyZXQgPSAodmx2X3B1
bml0X3JlYWQoZGV2X3ByaXYsIHJlZzApICYgU1NQTTBfU1NDX01BU0spID09IFNTUE0wX1NTQ19Q
V1JfR0FURTsKPiAtCXZsdl9wdW5pdF9wdXQoZGV2X3ByaXYpOwo+ICsJdmx2X3B1bml0X2dldChp
OTE1KTsKPiArCXJldCA9ICh2bHZfcHVuaXRfcmVhZChpOTE1LCByZWcwKSAmIFNTUE0wX1NTQ19N
QVNLKSA9PSBTU1BNMF9TU0NfUFdSX0dBVEU7Cj4gKwl2bHZfcHVuaXRfcHV0KGk5MTUpOwo+ICAg
Cj4gICAJcmV0dXJuIHJldDsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBhc3NlcnRfdmVkX3Bv
d2VyX2dhdGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZv
aWQgYXNzZXJ0X3ZlZF9wb3dlcl9nYXRlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiAgIHsKPiAtCVdBUk4oIXZsdl9wdW5pdF9pc19wb3dlcl9nYXRlZChkZXZfcHJpdiwgUFVOSVRf
UkVHX1ZFRFNTUE0wKSwKPiArCVdBUk4oIXZsdl9wdW5pdF9pc19wb3dlcl9nYXRlZChpOTE1LCBQ
VU5JVF9SRUdfVkVEU1NQTTApLAo+ICAgCSAgICAgIlZFRCBub3QgcG93ZXIgZ2F0ZWRcbiIpOwo+
ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGFzc2VydF9pc3BfcG93ZXJfZ2F0ZWQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBhc3NlcnRfaXNwX3Bvd2Vy
X2dhdGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXN0YXRpYyBj
b25zdCBzdHJ1Y3QgcGNpX2RldmljZV9pZCBpc3BfaWRzW10gPSB7Cj4gICAJCXtQQ0lfREVWSUNF
KFBDSV9WRU5ET1JfSURfSU5URUwsIDB4MGYzOCl9LAo+IEBAIC00MzA2LDExICs0MzA2LDExIEBA
IHN0YXRpYyB2b2lkIGFzc2VydF9pc3BfcG93ZXJfZ2F0ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ICAgCX07Cj4gICAKPiAgIAlXQVJOKCFwY2lfZGV2X3ByZXNlbnQoaXNw
X2lkcykgJiYKPiAtCSAgICAgIXZsdl9wdW5pdF9pc19wb3dlcl9nYXRlZChkZXZfcHJpdiwgUFVO
SVRfUkVHX0lTUFNTUE0wKSwKPiArCSAgICAgIXZsdl9wdW5pdF9pc19wb3dlcl9nYXRlZChpOTE1
LCBQVU5JVF9SRUdfSVNQU1NQTTApLAo+ICAgCSAgICAgIklTUCBub3QgcG93ZXIgZ2F0ZWRcbiIp
Owo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGludGVsX3Bvd2VyX2RvbWFpbnNfdmVyaWZ5X3N0
YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gK3N0YXRpYyB2b2lkIGlu
dGVsX3Bvd2VyX2RvbWFpbnNfdmVyaWZ5X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KTsKPiAgIAo+ICAgLyoqCj4gICAgKiBpbnRlbF9wb3dlcl9kb21haW5zX2luaXRfaHcgLSBp
bml0aWFsaXplIGhhcmR3YXJlIHBvd2VyIGRvbWFpbiBzdGF0ZQo+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmggYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmgKPiBpbmRleCBmZjU3YjBhN2ZlNTkuLjAzMTBmZTEx
NGVjYyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kaXNwbGF5X3Bv
d2VyLmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmgK
PiBAQCAtODAsMjMgKzgwLDIzIEBAIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfb3BzIHsKPiAgIAkg
KiBkdXJpbmcgZHJpdmVyIGluaXQgYW5kIHJlc3VtZSB0aW1lLCBwb3NzaWJseSBhZnRlciBmaXJz
dCBjYWxsaW5nCj4gICAJICogdGhlIGVuYWJsZS9kaXNhYmxlIGhhbmRsZXJzLgo+ICAgCSAqLwo+
IC0Jdm9pZCAoKnN5bmNfaHcpKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAr
CXZvaWQgKCpzeW5jX2h3KShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCXN0
cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpOwo+ICAgCS8qCj4gICAJICogRW5hYmxl
IHRoZSB3ZWxsIGFuZCByZXNvdXJjZXMgdGhhdCBkZXBlbmQgb24gaXQgKGZvciBleGFtcGxlCj4g
ICAJICogaW50ZXJydXB0cyBsb2NhdGVkIG9uIHRoZSB3ZWxsKS4gQ2FsbGVkIGFmdGVyIHRoZSAw
LT4xIHJlZmNvdW50Cj4gICAJICogdHJhbnNpdGlvbi4KPiAgIAkgKi8KPiAtCXZvaWQgKCplbmFi
bGUpKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArCXZvaWQgKCplbmFibGUp
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkgICAgICAgc3RydWN0IGk5MTVf
cG93ZXJfd2VsbCAqcG93ZXJfd2VsbCk7Cj4gICAJLyoKPiAgIAkgKiBEaXNhYmxlIHRoZSB3ZWxs
IGFuZCByZXNvdXJjZXMgdGhhdCBkZXBlbmQgb24gaXQuIENhbGxlZCBhZnRlcgo+ICAgCSAqIHRo
ZSAxLT4wIHJlZmNvdW50IHRyYW5zaXRpb24uCj4gICAJICovCj4gLQl2b2lkICgqZGlzYWJsZSko
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICsJdm9pZCAoKmRpc2FibGUpKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJc3RydWN0IGk5MTVfcG93ZXJfd2Vs
bCAqcG93ZXJfd2VsbCk7Cj4gICAJLyogUmV0dXJucyB0aGUgaHcgZW5hYmxlZCBzdGF0ZS4gKi8K
PiAtCWJvb2wgKCppc19lbmFibGVkKShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gKwlib29sICgqaXNfZW5hYmxlZCkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
ICAJCQkgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKTsKPiAgIH07Cj4gICAK
PiBAQCAtMjA0LDQ4ICsyMDQsNDggQEAgc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyB7Cj4gICAJ
Zm9yX2VhY2hfcG93ZXJfd2VsbF9yZXZlcnNlKF9fZGV2X3ByaXYsIF9fcG93ZXJfd2VsbCkJCSAg
ICAgICAgXAo+ICAgCQlmb3JfZWFjaF9pZigoX19wb3dlcl93ZWxsKS0+ZGVzYy0+ZG9tYWlucyAm
IChfX2RvbWFpbl9tYXNrKSkKPiAgIAo+IC12b2lkIHNrbF9lbmFibGVfZGM2KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gLXZvaWQgZ2VuOV9zYW5pdGl6ZV9kY19zdGF0ZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGJ4dF9lbmFibGVfZGM5
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gLXZvaWQgYnh0X2Rpc2FibGVf
ZGM5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gLXZvaWQgZ2VuOV9lbmFi
bGVfZGM1KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gK3ZvaWQgc2tsX2Vu
YWJsZV9kYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lkIGdlbjlfc2Fu
aXRpemVfZGNfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lkIGJ4
dF9lbmFibGVfZGM5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiArdm9pZCBieHRf
ZGlzYWJsZV9kYzkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lkIGdlbjlf
ZW5hYmxlX2RjNShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICAKPiAtaW50IGlu
dGVsX3Bvd2VyX2RvbWFpbnNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Owo+IC12b2lkIGludGVsX3Bvd2VyX2RvbWFpbnNfY2xlYW51cChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGludGVsX3Bvd2VyX2RvbWFpbnNfaW5pdF9odyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGJvb2wgcmVzdW1lKTsKPiAtdm9pZCBpbnRl
bF9wb3dlcl9kb21haW5zX2ZpbmlfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KTsKPiAtdm9pZCBpY2xfZGlzcGxheV9jb3JlX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LCBib29sIHJlc3VtZSk7Cj4gLXZvaWQgaWNsX2Rpc3BsYXlfY29yZV91bmluaXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtdm9pZCBpbnRlbF9wb3dlcl9k
b21haW5zX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lk
IGludGVsX3Bvd2VyX2RvbWFpbnNfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpOwo+IC12b2lkIGludGVsX3Bvd2VyX2RvbWFpbnNfc3VzcGVuZChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2ludCBpbnRlbF9wb3dlcl9kb21haW5zX2luaXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lkIGludGVsX3Bvd2VyX2RvbWFpbnNf
Y2xlYW51cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgaW50ZWxfcG93
ZXJfZG9tYWluc19pbml0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBib29sIHJl
c3VtZSk7Cj4gK3ZvaWQgaW50ZWxfcG93ZXJfZG9tYWluc19maW5pX2h3KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KTsKPiArdm9pZCBpY2xfZGlzcGxheV9jb3JlX2luaXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsIGJvb2wgcmVzdW1lKTsKPiArdm9pZCBpY2xfZGlzcGxheV9j
b3JlX3VuaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgaW50ZWxf
cG93ZXJfZG9tYWluc19lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2
b2lkIGludGVsX3Bvd2VyX2RvbWFpbnNfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSk7Cj4gK3ZvaWQgaW50ZWxfcG93ZXJfZG9tYWluc19zdXNwZW5kKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSBlbnVtIGk5MTVfZHJtX3N1c3BlbmRfbW9kZSk7Cj4g
LXZvaWQgaW50ZWxfcG93ZXJfZG9tYWluc19yZXN1bWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KTsKPiAtdm9pZCBoc3dfZW5hYmxlX3BjOChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGhzd19kaXNhYmxlX3BjOChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGJ4dF9kaXNwbGF5X2NvcmVfaW5pdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGJvb2wgcmVzdW1lKTsKPiAtdm9pZCBieHRfZGlzcGxh
eV9jb3JlX3VuaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ICt2b2lk
IGludGVsX3Bvd2VyX2RvbWFpbnNfcmVzdW1lKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KTsKPiArdm9pZCBoc3dfZW5hYmxlX3BjOChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7
Cj4gK3ZvaWQgaHN3X2Rpc2FibGVfcGM4KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsK
PiArdm9pZCBieHRfZGlzcGxheV9jb3JlX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsIGJvb2wgcmVzdW1lKTsKPiArdm9pZCBieHRfZGlzcGxheV9jb3JlX3VuaW5pdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICAKPiAgIGNvbnN0IGNoYXIgKgo+ICAgaW50ZWxf
ZGlzcGxheV9wb3dlcl9kb21haW5fc3RyKGVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4g
ZG9tYWluKTsKPiAgIAo+IC1ib29sIGludGVsX2Rpc3BsYXlfcG93ZXJfaXNfZW5hYmxlZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2Jvb2wgaW50ZWxfZGlzcGxheV9wb3dl
cl9pc19lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgICBl
bnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbik7Cj4gLWJvb2wgX19pbnRlbF9k
aXNwbGF5X3Bvd2VyX2lzX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ICtib29sIF9faW50ZWxfZGlzcGxheV9wb3dlcl9pc19lbmFibGVkKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgICAgIGVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9k
b21haW4gZG9tYWluKTsKPiAtaW50ZWxfd2FrZXJlZl90IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAraW50ZWxfd2FrZXJlZl90IGlu
dGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAg
CQkJCQllbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbik7Cj4gICBpbnRlbF93
YWtlcmVmX3QKPiAtaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2ludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2Vu
YWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgZW51bSBpbnRl
bF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBkb21haW4pOwo+IC12b2lkIGludGVsX2Rpc3BsYXlfcG93
ZXJfcHV0X3VuY2hlY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3Zv
aWQgaW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfdW5jaGVja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAo+ICAgCQkJCSAgICAgICBlbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWlu
IGRvbWFpbik7Cj4gICB2b2lkIF9faW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfYXN5bmMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgICBlbnVtIGludGVsX2Rpc3BsYXlf
cG93ZXJfZG9tYWluIGRvbWFpbiwKPiAgIAkJCQkgICAgIGludGVsX3dha2VyZWZfdCB3YWtlcmVm
KTsKPiAgIHZvaWQgaW50ZWxfZGlzcGxheV9wb3dlcl9mbHVzaF93b3JrKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KTsKPiAgICNpZiBJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9ERUJV
R19SVU5USU1FX1BNKQo+IC12b2lkIGludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArdm9pZCBpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgZW51bSBpbnRlbF9kaXNw
bGF5X3Bvd2VyX2RvbWFpbiBkb21haW4sCj4gICAJCQkgICAgIGludGVsX3dha2VyZWZfdCB3YWtl
cmVmKTsKPiAgIHN0YXRpYyBpbmxpbmUgdm9pZAo+IEBAIC0yNzcsMTIgKzI3NywxMiBAQCBpbnRl
bF9kaXNwbGF5X3Bvd2VyX3B1dF9hc3luYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
PiAgIAlmb3IgKCh3ZikgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldCgoaTkxNSksIChkb21haW4p
KTsgKHdmKTsgXAo+ICAgCSAgICAgaW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfYXN5bmMoKGk5MTUp
LCAoZG9tYWluKSwgKHdmKSksICh3ZikgPSAwKQo+ICAgCj4gLXZvaWQgaWNsX2RidWZfc2xpY2Vz
X3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3ZvaWQgaWNsX2Ri
dWZfc2xpY2VzX3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAg
ICB1OCByZXFfc2xpY2VzKTsKPiAgIAo+ICAgdm9pZCBjaHZfcGh5X3Bvd2VyZ2F0ZV9sYW5lcyhz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCSAgICAgYm9vbCBvdmVycmlkZSwg
dW5zaWduZWQgaW50IG1hc2spOwo+IC1ib29sIGNodl9waHlfcG93ZXJnYXRlX2NoKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBkcGlvX3BoeSBwaHksCj4gK2Jvb2wgY2h2
X3BoeV9wb3dlcmdhdGVfY2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gZHBp
b19waHkgcGh5LAo+ICAgCQkJICBlbnVtIGRwaW9fY2hhbm5lbCBjaCwgYm9vbCBvdmVycmlkZSk7
Cj4gICAKPiAgICNlbmRpZiAvKiBfX0lOVEVMX0RJU1BMQVlfUE9XRVJfSF9fICovCj4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RwLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9kcC5jCj4gaW5kZXggNDMzNmRmNDZmZTc4Li5kNGRjMmI5NTA2ZTUgMTAwNjQ0
Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHAuYwo+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX2RwLmMKPiBAQCAtMTYwLDcgKzE2MCw3IEBAIHN0YXRpYyBib29s
IGVkcF9wYW5lbF92ZGRfb24oc3RydWN0IGludGVsX2RwICppbnRlbF9kcCk7Cj4gICBzdGF0aWMg
dm9pZCBlZHBfcGFuZWxfdmRkX29mZihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLCBib29sIHN5
bmMpOwo+ICAgc3RhdGljIHZvaWQgdmx2X2luaXRfcGFuZWxfcG93ZXJfc2VxdWVuY2VyKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCQkgICBjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7Cj4gLXN0YXRpYyB2b2lkIHZsdl9zdGVhbF9wb3dlcl9z
ZXF1ZW5jZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9p
ZCB2bHZfc3RlYWxfcG93ZXJfc2VxdWVuY2VyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAo+ICAgCQkJCSAgICAgIGVudW0gcGlwZSBwaXBlKTsKPiAgIHN0YXRpYyB2b2lkIGludGVsX2Rw
X3Vuc2V0X2VkaWQoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCk7Cj4gICAKPiBAQCAtMjE0LDgg
KzIxNCw4IEBAIHN0YXRpYyBpbnQgaW50ZWxfZHBfbWF4X2NvbW1vbl9yYXRlKHN0cnVjdCBpbnRl
bF9kcCAqaW50ZWxfZHApCj4gICBzdGF0aWMgaW50IGludGVsX2RwX2dldF9maWFfc3VwcG9ydGVk
X2xhbmVfY291bnQoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiAgIHsKPiAgIAlzdHJ1Y3Qg
aW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCA9IGRwX3RvX2RpZ19wb3J0KGludGVsX2RwKTsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGlnX3BvcnQt
PmJhc2UuYmFzZS5kZXYpOwo+IC0JZW51bSB0Y19wb3J0IHRjX3BvcnQgPSBpbnRlbF9wb3J0X3Rv
X3RjKGRldl9wcml2LCBkaWdfcG9ydC0+YmFzZS5wb3J0KTsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShkaWdfcG9ydC0+YmFzZS5iYXNlLmRldik7Cj4gKwllbnVt
IHRjX3BvcnQgdGNfcG9ydCA9IGludGVsX3BvcnRfdG9fdGMoaTkxNSwgZGlnX3BvcnQtPmJhc2Uu
cG9ydCk7Cj4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gICAJdTMyIGxhbmVfaW5mbzsK
PiAgIAo+IEBAIC0yMjMsNyArMjIzLDcgQEAgc3RhdGljIGludCBpbnRlbF9kcF9nZXRfZmlhX3N1
cHBvcnRlZF9sYW5lX2NvdW50KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICAJCXJldHVy
biA0Owo+ICAgCj4gICAJbGFuZV9pbmZvID0gMDsKPiAtCXdpdGhfaW50ZWxfZGlzcGxheV9wb3dl
cihkZXZfcHJpdiwgUE9XRVJfRE9NQUlOX0RJU1BMQVlfQ09SRSwgd2FrZXJlZikKPiArCXdpdGhf
aW50ZWxfZGlzcGxheV9wb3dlcihpOTE1LCBQT1dFUl9ET01BSU5fRElTUExBWV9DT1JFLCB3YWtl
cmVmKQo+ICAgCQlsYW5lX2luZm8gPSAoSTkxNV9SRUFEKFBPUlRfVFhfREZMRVhEUFNQKSAmCj4g
ICAJCQkgICAgIERQX0xBTkVfQVNTSUdOTUVOVF9NQVNLKHRjX3BvcnQpKSA+Pgo+ICAgCQkJCURQ
X0xBTkVfQVNTSUdOTUVOVF9TSElGVCh0Y19wb3J0KTsKPiBAQCAtMjg0LDggKzI4NCw4IEBAIGlu
dGVsX2RwX2Rvd25zdHJlYW1fbWF4X2RvdGNsb2NrKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAp
Cj4gICB7Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQgPSBk
cF90b19kaWdfcG9ydChpbnRlbF9kcCk7Cj4gICAJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIgPSAmaW50ZWxfZGlnX3BvcnQtPmJhc2U7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAtCWludCBtYXhfZG90Y2xr
ID0gZGV2X3ByaXYtPm1heF9kb3RjbGtfZnJlcTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlpbnQgbWF4X2RvdGNsayA9
IGk5MTUtPm1heF9kb3RjbGtfZnJlcTsKPiAgIAlpbnQgZHNfbWF4X2RvdGNsazsKPiAgIAo+ICAg
CWludCB0eXBlID0gaW50ZWxfZHAtPmRvd25zdHJlYW1fcG9ydHNbMF0gJiBEUF9EU19QT1JUX1RZ
UEVfTUFTSzsKPiBAQCAtMzA1LDcgKzMwNSw3IEBAIGludGVsX2RwX2Rvd25zdHJlYW1fbWF4X2Rv
dGNsb2NrKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICBzdGF0aWMgaW50IGNubF9tYXhf
c291cmNlX3JhdGUoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiAgIHsKPiAgIAlzdHJ1Y3Qg
aW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCA9IGRwX3RvX2RpZ19wb3J0KGludGVsX2RwKTsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGlnX3BvcnQt
PmJhc2UuYmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsKPiAgIAllbnVtIHBvcnQgcG9ydCA9IGRpZ19w
b3J0LT5iYXNlLnBvcnQ7Cj4gICAKPiAgIAl1MzIgdm9sdGFnZSA9IEk5MTVfUkVBRChDTkxfUE9S
VF9DT01QX0RXMykgJiBWT0xUQUdFX0lORk9fTUFTSzsKPiBAQCAtMzE1LDcgKzMxNSw3IEBAIHN0
YXRpYyBpbnQgY25sX21heF9zb3VyY2VfcmF0ZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+
ICAgCQlyZXR1cm4gNTQwMDAwOwo+ICAgCj4gICAJLyogRm9yIHRoaXMgU0tVIDguMUcgaXMgc3Vw
cG9ydGVkIGluIGFsbCBwb3J0cyAqLwo+IC0JaWYgKElTX0NOTF9XSVRIX1BPUlRfRihkZXZfcHJp
dikpCj4gKwlpZiAoSVNfQ05MX1dJVEhfUE9SVF9GKGk5MTUpKQo+ICAgCQlyZXR1cm4gODEwMDAw
Owo+ICAgCj4gICAJLyogRm9yIG90aGVyIFNLVXMsIG1heCByYXRlIG9uIHBvcnRzIEEgYW5kIEQg
aXMgNS40RyAqLwo+IEBAIC0zMjgsMTEgKzMyOCwxMSBAQCBzdGF0aWMgaW50IGNubF9tYXhfc291
cmNlX3JhdGUoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiAgIHN0YXRpYyBpbnQgaWNsX21h
eF9zb3VyY2VfcmF0ZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAgewo+ICAgCXN0cnVj
dCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0ID0gZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHAp
Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkaWdfcG9y
dC0+YmFzZS5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOwo+ICAgCWVudW0gcG9ydCBwb3J0ID0gZGln
X3BvcnQtPmJhc2UucG9ydDsKPiAgIAo+IC0JaWYgKGludGVsX3BvcnRfaXNfY29tYm9waHkoZGV2
X3ByaXYsIHBvcnQpICYmCj4gLQkgICAgIUlTX0VMS0hBUlRMQUtFKGRldl9wcml2KSAmJgo+ICsJ
aWYgKGludGVsX3BvcnRfaXNfY29tYm9waHkoaTkxNSwgcG9ydCkgJiYKPiArCSAgICAhSVNfRUxL
SEFSVExBS0UoaTkxNSkgJiYKPiAgIAkgICAgIWludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkpCj4g
ICAJCXJldHVybiA1NDAwMDA7Cj4gICAKPiBAQCAtMzU5LDMwICszNTksMzAgQEAgaW50ZWxfZHBf
c2V0X3NvdXJjZV9yYXRlcyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAgCQkxNjIwMDAs
IDI3MDAwMAo+ICAgCX07Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQg
PSBkcF90b19kaWdfcG9ydChpbnRlbF9kcCk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkaWdfcG9ydC0+YmFzZS5iYXNlLmRldik7
Cj4gICAJY29uc3Qgc3RydWN0IGRkaV92YnRfcG9ydF9pbmZvICppbmZvID0KPiAtCQkmZGV2X3By
aXYtPnZidC5kZGlfcG9ydF9pbmZvW2RpZ19wb3J0LT5iYXNlLnBvcnRdOwo+ICsJCSZpOTE1LT52
YnQuZGRpX3BvcnRfaW5mb1tkaWdfcG9ydC0+YmFzZS5wb3J0XTsKPiAgIAljb25zdCBpbnQgKnNv
dXJjZV9yYXRlczsKPiAgIAlpbnQgc2l6ZSwgbWF4X3JhdGUgPSAwLCB2YnRfbWF4X3JhdGUgPSBp
bmZvLT5kcF9tYXhfbGlua19yYXRlOwo+ICAgCj4gICAJLyogVGhpcyBzaG91bGQgb25seSBiZSBk
b25lIG9uY2UgKi8KPiAgIAlXQVJOX09OKGludGVsX2RwLT5zb3VyY2VfcmF0ZXMgfHwgaW50ZWxf
ZHAtPm51bV9zb3VyY2VfcmF0ZXMpOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+
PSAxMCkgewo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMCkgewo+ICAgCQlzb3VyY2VfcmF0
ZXMgPSBjbmxfcmF0ZXM7Cj4gICAJCXNpemUgPSBBUlJBWV9TSVpFKGNubF9yYXRlcyk7Cj4gLQkJ
aWYgKElTX0dFTihkZXZfcHJpdiwgMTApKQo+ICsJCWlmIChJU19HRU4oaTkxNSwgMTApKQo+ICAg
CQkJbWF4X3JhdGUgPSBjbmxfbWF4X3NvdXJjZV9yYXRlKGludGVsX2RwKTsKPiAgIAkJZWxzZQo+
ICAgCQkJbWF4X3JhdGUgPSBpY2xfbWF4X3NvdXJjZV9yYXRlKGludGVsX2RwKTsKPiAtCX0gZWxz
ZSBpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAoSVNfR0VOOV9MUChp
OTE1KSkgewo+ICAgCQlzb3VyY2VfcmF0ZXMgPSBieHRfcmF0ZXM7Cj4gICAJCXNpemUgPSBBUlJB
WV9TSVpFKGJ4dF9yYXRlcyk7Cj4gLQl9IGVsc2UgaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpKSB7
Cj4gKwl9IGVsc2UgaWYgKElTX0dFTjlfQkMoaTkxNSkpIHsKPiAgIAkJc291cmNlX3JhdGVzID0g
c2tsX3JhdGVzOwo+ICAgCQlzaXplID0gQVJSQVlfU0laRShza2xfcmF0ZXMpOwo+IC0JfSBlbHNl
IGlmICgoSVNfSEFTV0VMTChkZXZfcHJpdikgJiYgIUlTX0hTV19VTFgoZGV2X3ByaXYpKSB8fAo+
IC0JCSAgIElTX0JST0FEV0VMTChkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAoKElTX0hBU1dF
TEwoaTkxNSkgJiYgIUlTX0hTV19VTFgoaTkxNSkpIHx8Cj4gKwkJICAgSVNfQlJPQURXRUxMKGk5
MTUpKSB7Cj4gICAJCXNvdXJjZV9yYXRlcyA9IGhzd19yYXRlczsKPiAgIAkJc2l6ZSA9IEFSUkFZ
X1NJWkUoaHN3X3JhdGVzKTsKPiAgIAl9IGVsc2Ugewo+IEBAIC01MzIsNyArNTMyLDcgQEAgaW50
ZWxfZHBfbW9kZV92YWxpZChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+ICAgCXN0
cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSBpbnRlbF9hdHRhY2hlZF9kcChjb25uZWN0b3IpOwo+
ICAgCXN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmludGVsX2Nvbm5lY3RvciA9IHRvX2ludGVsX2Nv
bm5lY3Rvcihjb25uZWN0b3IpOwo+ICAgCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICpmaXhlZF9t
b2RlID0gaW50ZWxfY29ubmVjdG9yLT5wYW5lbC5maXhlZF9tb2RlOwo+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmRldik7Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOwo+ICAg
CWludCB0YXJnZXRfY2xvY2sgPSBtb2RlLT5jbG9jazsKPiAgIAlpbnQgbWF4X3JhdGUsIG1vZGVf
cmF0ZSwgbWF4X2xhbmVzLCBtYXhfbGlua19jbG9jazsKPiAgIAlpbnQgbWF4X2RvdGNsazsKPiBA
QCAtNTY0LDcgKzU2NCw3IEBAIGludGVsX2RwX21vZGVfdmFsaWQoc3RydWN0IGRybV9jb25uZWN0
b3IgKmNvbm5lY3RvciwKPiAgIAkgKiBPdXRwdXQgYnBwIGlzIHN0b3JlZCBpbiA2LjQgZm9ybWF0
IHNvIHJpZ2h0IHNoaWZ0IGJ5IDQgdG8gZ2V0IHRoZQo+ICAgCSAqIGludGVnZXIgdmFsdWUgc2lu
Y2Ugd2Ugc3VwcG9ydCBvbmx5IGludGVnZXIgdmFsdWVzIG9mIGJwcC4KPiAgIAkgKi8KPiAtCWlm
ICgoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCB8fCBJU19HRU1JTklMQUtFKGRldl9wcml2KSkg
JiYKPiArCWlmICgoSU5URUxfR0VOKGk5MTUpID49IDEwIHx8IElTX0dFTUlOSUxBS0UoaTkxNSkp
ICYmCj4gICAJICAgIGRybV9kcF9zaW5rX3N1cHBvcnRzX2RzYyhpbnRlbF9kcC0+ZHNjX2RwY2Qp
KSB7Cj4gICAJCWlmIChpbnRlbF9kcF9pc19lZHAoaW50ZWxfZHApKSB7Cj4gICAJCQlkc2NfbWF4
X291dHB1dF9icHAgPQo+IEBAIC02MzAsMTcgKzYzMCwxNyBAQCBpbnRlbF9kcF9wcHNfaW5pdChz
dHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKTsKPiAgIHN0YXRpYyBpbnRlbF93YWtlcmVmX3QKPiAg
IHBwc19sb2NrKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICB7Cj4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gICAJaW50
ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gICAKPiAgIAkvKgo+ICAgCSAqIFNlZSBpbnRlbF9wb3dl
cl9zZXF1ZW5jZXJfcmVzZXQoKSB3aHkgd2UgbmVlZAo+ICAgCSAqIGEgcG93ZXIgZG9tYWluIHJl
ZmVyZW5jZSBoZXJlLgo+ICAgCSAqLwo+IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJf
Z2V0KGRldl9wcml2LAo+ICsJd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGk5MTUs
Cj4gICAJCQkJCSAgaW50ZWxfYXV4X3Bvd2VyX2RvbWFpbihkcF90b19kaWdfcG9ydChpbnRlbF9k
cCkpKTsKPiAgIAo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPnBwc19tdXRleCk7Cj4gKwltdXRl
eF9sb2NrKCZpOTE1LT5wcHNfbXV0ZXgpOwo+ICAgCj4gICAJcmV0dXJuIHdha2VyZWY7Cj4gICB9
Cj4gQEAgLTY0OCwxMCArNjQ4LDEwIEBAIHBwc19sb2NrKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxf
ZHApCj4gICBzdGF0aWMgaW50ZWxfd2FrZXJlZl90Cj4gICBwcHNfdW5sb2NrKHN0cnVjdCBpbnRl
bF9kcCAqaW50ZWxfZHAsIGludGVsX3dha2VyZWZfdCB3YWtlcmVmKQo+ICAgewo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ICAg
Cj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5wcHNfbXV0ZXgpOwo+IC0JaW50ZWxfZGlzcGxh
eV9wb3dlcl9wdXQoZGV2X3ByaXYsCj4gKwltdXRleF91bmxvY2soJmk5MTUtPnBwc19tdXRleCk7
Cj4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChpOTE1LAo+ICAgCQkJCWludGVsX2F1eF9wb3dl
cl9kb21haW4oZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApKSwKPiAgIAkJCQl3YWtlcmVmKTsKPiAg
IAlyZXR1cm4gMDsKPiBAQCAtNjYzLDcgKzY2Myw3IEBAIHBwc191bmxvY2soc3RydWN0IGludGVs
X2RwICppbnRlbF9kcCwgaW50ZWxfd2FrZXJlZl90IHdha2VyZWYpCj4gICBzdGF0aWMgdm9pZAo+
ICAgdmx2X3Bvd2VyX3NlcXVlbmNlcl9raWNrKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGlu
dGVsX2RwKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShp
bnRlbF9kcCk7Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQg
PSBkcF90b19kaWdfcG9ydChpbnRlbF9kcCk7Cj4gICAJZW51bSBwaXBlIHBpcGUgPSBpbnRlbF9k
cC0+cHBzX3BpcGU7Cj4gICAJYm9vbCBwbGxfZW5hYmxlZCwgcmVsZWFzZV9jbF9vdmVycmlkZSA9
IGZhbHNlOwo+IEBAIC02ODcsNyArNjg3LDcgQEAgdmx2X3Bvd2VyX3NlcXVlbmNlcl9raWNrKHN0
cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICAJRFAgfD0gRFBfUE9SVF9XSURUSCgxKTsKPiAg
IAlEUCB8PSBEUF9MSU5LX1RSQUlOX1BBVF8xOwo+ICAgCj4gLQlpZiAoSVNfQ0hFUlJZVklFVyhk
ZXZfcHJpdikpCj4gKwlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiAgIAkJRFAgfD0gRFBfUElQ
RV9TRUxfQ0hWKHBpcGUpOwo+ICAgCWVsc2UKPiAgIAkJRFAgfD0gRFBfUElQRV9TRUwocGlwZSk7
Cj4gQEAgLTY5OSwxMCArNjk5LDEwIEBAIHZsdl9wb3dlcl9zZXF1ZW5jZXJfa2ljayhzdHJ1Y3Qg
aW50ZWxfZHAgKmludGVsX2RwKQo+ICAgCSAqIFNvIGVuYWJsZSB0ZW1wb3JhcmlseSBpdCBpZiBp
dCdzIG5vdCBhbHJlYWR5IGVuYWJsZWQuCj4gICAJICovCj4gICAJaWYgKCFwbGxfZW5hYmxlZCkg
ewo+IC0JCXJlbGVhc2VfY2xfb3ZlcnJpZGUgPSBJU19DSEVSUllWSUVXKGRldl9wcml2KSAmJgo+
IC0JCQkhY2h2X3BoeV9wb3dlcmdhdGVfY2goZGV2X3ByaXYsIHBoeSwgY2gsIHRydWUpOwo+ICsJ
CXJlbGVhc2VfY2xfb3ZlcnJpZGUgPSBJU19DSEVSUllWSUVXKGk5MTUpICYmCj4gKwkJCSFjaHZf
cGh5X3Bvd2VyZ2F0ZV9jaChpOTE1LCBwaHksIGNoLCB0cnVlKTsKPiAgIAo+IC0JCWlmICh2bHZf
Zm9yY2VfcGxsX29uKGRldl9wcml2LCBwaXBlLCBJU19DSEVSUllWSUVXKGRldl9wcml2KSA/Cj4g
KwkJaWYgKHZsdl9mb3JjZV9wbGxfb24oaTkxNSwgcGlwZSwgSVNfQ0hFUlJZVklFVyhpOTE1KSA/
Cj4gICAJCQkJICAgICAmY2h2X2RwbGxbMF0uZHBsbCA6ICZ2bHZfZHBsbFswXS5kcGxsKSkgewo+
ICAgCQkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gZm9yY2Ugb24gcGxsIGZvciBwaXBlICVjIVxuIiwK
PiAgIAkJCQkgIHBpcGVfbmFtZShwaXBlKSk7Cj4gQEAgLTcyNiwxNCArNzI2LDE0IEBAIHZsdl9w
b3dlcl9zZXF1ZW5jZXJfa2ljayhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAgCVBPU1RJ
TkdfUkVBRChpbnRlbF9kcC0+b3V0cHV0X3JlZyk7Cj4gICAKPiAgIAlpZiAoIXBsbF9lbmFibGVk
KSB7Cj4gLQkJdmx2X2ZvcmNlX3BsbF9vZmYoZGV2X3ByaXYsIHBpcGUpOwo+ICsJCXZsdl9mb3Jj
ZV9wbGxfb2ZmKGk5MTUsIHBpcGUpOwo+ICAgCj4gICAJCWlmIChyZWxlYXNlX2NsX292ZXJyaWRl
KQo+IC0JCQljaHZfcGh5X3Bvd2VyZ2F0ZV9jaChkZXZfcHJpdiwgcGh5LCBjaCwgZmFsc2UpOwo+
ICsJCQljaHZfcGh5X3Bvd2VyZ2F0ZV9jaChpOTE1LCBwaHksIGNoLCBmYWxzZSk7Cj4gICAJfQo+
ICAgfQo+ICAgCj4gLXN0YXRpYyBlbnVtIHBpcGUgdmx2X2ZpbmRfZnJlZV9wcHMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgZW51bSBwaXBlIHZsdl9maW5kX2Zy
ZWVfcHBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyOwo+ICAgCXVuc2lnbmVkIGludCBwaXBlcyA9ICgxIDw8IFBJ
UEVfQSkgfCAoMSA8PCBQSVBFX0IpOwo+IEBAIC03NDIsNyArNzQyLDcgQEAgc3RhdGljIGVudW0g
cGlwZSB2bHZfZmluZF9mcmVlX3BwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gICAJICogV2UgZG9uJ3QgaGF2ZSBwb3dlciBzZXF1ZW5jZXIgY3VycmVudGx5Lgo+ICAgCSAq
IFBpY2sgb25lIHRoYXQncyBub3QgdXNlZCBieSBvdGhlciBwb3J0cy4KPiAgIAkgKi8KPiAtCWZv
cl9lYWNoX2ludGVsX2RwKCZkZXZfcHJpdi0+ZHJtLCBlbmNvZGVyKSB7Cj4gKwlmb3JfZWFjaF9p
bnRlbF9kcCgmaTkxNS0+ZHJtLCBlbmNvZGVyKSB7Cj4gICAJCXN0cnVjdCBpbnRlbF9kcCAqaW50
ZWxfZHAgPSBlbmNfdG9faW50ZWxfZHAoJmVuY29kZXItPmJhc2UpOwo+ICAgCj4gICAJCWlmIChl
bmNvZGVyLT50eXBlID09IElOVEVMX09VVFBVVF9FRFApIHsKPiBAQCAtNzY4LDExICs3NjgsMTEg
QEAgc3RhdGljIGVudW0gcGlwZSB2bHZfZmluZF9mcmVlX3BwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gICBzdGF0aWMgZW51bSBwaXBlCj4gICB2bHZfcG93ZXJfc2VxdWVu
Y2VyX3BpcGUoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiAgIAlzdHJ1
Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCA9IGRwX3RvX2RpZ19wb3J0KGlu
dGVsX2RwKTsKPiAgIAllbnVtIHBpcGUgcGlwZTsKPiAgIAo+IC0JbG9ja2RlcF9hc3NlcnRfaGVs
ZCgmZGV2X3ByaXYtPnBwc19tdXRleCk7Cj4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5w
cHNfbXV0ZXgpOwo+ICAgCj4gICAJLyogV2Ugc2hvdWxkIG5ldmVyIGxhbmQgaGVyZSB3aXRoIHJl
Z3VsYXIgRFAgcG9ydHMgKi8KPiAgIAlXQVJOX09OKCFpbnRlbF9kcF9pc19lZHAoaW50ZWxfZHAp
KTsKPiBAQCAtNzgzLDcgKzc4Myw3IEBAIHZsdl9wb3dlcl9zZXF1ZW5jZXJfcGlwZShzdHJ1Y3Qg
aW50ZWxfZHAgKmludGVsX2RwKQo+ICAgCWlmIChpbnRlbF9kcC0+cHBzX3BpcGUgIT0gSU5WQUxJ
RF9QSVBFKQo+ICAgCQlyZXR1cm4gaW50ZWxfZHAtPnBwc19waXBlOwo+ICAgCj4gLQlwaXBlID0g
dmx2X2ZpbmRfZnJlZV9wcHMoZGV2X3ByaXYpOwo+ICsJcGlwZSA9IHZsdl9maW5kX2ZyZWVfcHBz
KGk5MTUpOwo+ICAgCj4gICAJLyoKPiAgIAkgKiBEaWRuJ3QgZmluZCBvbmUuIFRoaXMgc2hvdWxk
IG5vdCBoYXBwZW4gc2luY2UgdGhlcmUKPiBAQCAtNzkyLDcgKzc5Miw3IEBAIHZsdl9wb3dlcl9z
ZXF1ZW5jZXJfcGlwZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAgCWlmIChXQVJOX09O
KHBpcGUgPT0gSU5WQUxJRF9QSVBFKSkKPiAgIAkJcGlwZSA9IFBJUEVfQTsKPiAgIAo+IC0Jdmx2
X3N0ZWFsX3Bvd2VyX3NlcXVlbmNlcihkZXZfcHJpdiwgcGlwZSk7Cj4gKwl2bHZfc3RlYWxfcG93
ZXJfc2VxdWVuY2VyKGk5MTUsIHBpcGUpOwo+ICAgCWludGVsX2RwLT5wcHNfcGlwZSA9IHBpcGU7
Cj4gICAKPiAgIAlEUk1fREVCVUdfS01TKCJwaWNrZWQgcGlwZSAlYyBwb3dlciBzZXF1ZW5jZXIg
Zm9yIHBvcnQgJWNcbiIsCj4gQEAgLTgxNSwxMCArODE1LDEwIEBAIHZsdl9wb3dlcl9zZXF1ZW5j
ZXJfcGlwZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAgc3RhdGljIGludAo+ICAgYnh0
X3Bvd2VyX3NlcXVlbmNlcl9pZHgoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHAp
Owo+IC0JaW50IGJhY2tsaWdodF9jb250cm9sbGVyID0gZGV2X3ByaXYtPnZidC5iYWNrbGlnaHQu
Y29udHJvbGxlcjsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkx
NShpbnRlbF9kcCk7Cj4gKwlpbnQgYmFja2xpZ2h0X2NvbnRyb2xsZXIgPSBpOTE1LT52YnQuYmFj
a2xpZ2h0LmNvbnRyb2xsZXI7Cj4gICAKPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2
LT5wcHNfbXV0ZXgpOwo+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+cHBzX211dGV4KTsK
PiAgIAo+ICAgCS8qIFdlIHNob3VsZCBuZXZlciBsYW5kIGhlcmUgd2l0aCByZWd1bGFyIERQIHBv
cnRzICovCj4gICAJV0FSTl9PTighaW50ZWxfZHBfaXNfZWRwKGludGVsX2RwKSk7Cj4gQEAgLTgz
NywyOSArODM3LDI5IEBAIGJ4dF9wb3dlcl9zZXF1ZW5jZXJfaWR4KHN0cnVjdCBpbnRlbF9kcCAq
aW50ZWxfZHApCj4gICAJcmV0dXJuIGJhY2tsaWdodF9jb250cm9sbGVyOwo+ICAgfQo+ICAgCj4g
LXR5cGVkZWYgYm9vbCAoKnZsdl9waXBlX2NoZWNrKShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gK3R5cGVkZWYgYm9vbCAoKnZsdl9waXBlX2NoZWNrKShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgICBlbnVtIHBpcGUgcGlwZSk7Cj4gICAKPiAt
c3RhdGljIGJvb2wgdmx2X3BpcGVfaGFzX3BwX29uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiArc3RhdGljIGJvb2wgdmx2X3BpcGVfaGFzX3BwX29uKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgICAgIGVudW0gcGlwZSBwaXBlKQo+ICAgewo+ICAg
CXJldHVybiBJOTE1X1JFQUQoUFBfU1RBVFVTKHBpcGUpKSAmIFBQX09OOwo+ICAgfQo+ICAgCj4g
LXN0YXRpYyBib29sIHZsdl9waXBlX2hhc192ZGRfb24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICtzdGF0aWMgYm9vbCB2bHZfcGlwZV9oYXNfdmRkX29uKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCWVudW0gcGlwZSBwaXBlKQo+ICAgewo+ICAgCXJl
dHVybiBJOTE1X1JFQUQoUFBfQ09OVFJPTChwaXBlKSkgJiBFRFBfRk9SQ0VfVkREOwo+ICAgfQo+
ICAgCj4gLXN0YXRpYyBib29sIHZsdl9waXBlX2FueShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gK3N0YXRpYyBib29sIHZsdl9waXBlX2FueShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiAgIAkJCSBlbnVtIHBpcGUgcGlwZSkKPiAgIHsKPiAgIAlyZXR1cm4gdHJ1
ZTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGVudW0gcGlwZQo+IC12bHZfaW5pdGlhbF9wcHNfcGlw
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3Zsdl9pbml0aWFsX3Bwc19w
aXBlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkgICAgIGVudW0gcG9ydCBw
b3J0LAo+ICAgCQkgICAgIHZsdl9waXBlX2NoZWNrIHBpcGVfY2hlY2spCj4gICB7Cj4gQEAgLTg3
Miw3ICs4NzIsNyBAQCB2bHZfaW5pdGlhbF9wcHNfcGlwZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gICAJCWlmIChwb3J0X3NlbCAhPSBQQU5FTF9QT1JUX1NFTEVDVF9WTFYo
cG9ydCkpCj4gICAJCQljb250aW51ZTsKPiAgIAo+IC0JCWlmICghcGlwZV9jaGVjayhkZXZfcHJp
diwgcGlwZSkpCj4gKwkJaWYgKCFwaXBlX2NoZWNrKGk5MTUsIHBpcGUpKQo+ICAgCQkJY29udGlu
dWU7Cj4gICAKPiAgIAkJcmV0dXJuIHBpcGU7Cj4gQEAgLTg4NCwyMyArODg0LDIzIEBAIHZsdl9p
bml0aWFsX3Bwc19waXBlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIHN0
YXRpYyB2b2lkCj4gICB2bHZfaW5pdGlhbF9wb3dlcl9zZXF1ZW5jZXJfc2V0dXAoc3RydWN0IGlu
dGVsX2RwICppbnRlbF9kcCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9w
b3J0ICppbnRlbF9kaWdfcG9ydCA9IGRwX3RvX2RpZ19wb3J0KGludGVsX2RwKTsKPiAgIAllbnVt
IHBvcnQgcG9ydCA9IGludGVsX2RpZ19wb3J0LT5iYXNlLnBvcnQ7Cj4gICAKPiAtCWxvY2tkZXBf
YXNzZXJ0X2hlbGQoJmRldl9wcml2LT5wcHNfbXV0ZXgpOwo+ICsJbG9ja2RlcF9hc3NlcnRfaGVs
ZCgmaTkxNS0+cHBzX211dGV4KTsKPiAgIAo+ICAgCS8qIHRyeSB0byBmaW5kIGEgcGlwZSB3aXRo
IHRoaXMgcG9ydCBzZWxlY3RlZCAqLwo+ICAgCS8qIGZpcnN0IHBpY2sgb25lIHdoZXJlIHRoZSBw
YW5lbCBpcyBvbiAqLwo+IC0JaW50ZWxfZHAtPnBwc19waXBlID0gdmx2X2luaXRpYWxfcHBzX3Bp
cGUoZGV2X3ByaXYsIHBvcnQsCj4gKwlpbnRlbF9kcC0+cHBzX3BpcGUgPSB2bHZfaW5pdGlhbF9w
cHNfcGlwZShpOTE1LCBwb3J0LAo+ICAgCQkJCQkJICB2bHZfcGlwZV9oYXNfcHBfb24pOwo+ICAg
CS8qIGRpZG4ndCBmaW5kIG9uZT8gcGljayBvbmUgd2hlcmUgdmRkIGlzIG9uICovCj4gICAJaWYg
KGludGVsX2RwLT5wcHNfcGlwZSA9PSBJTlZBTElEX1BJUEUpCj4gLQkJaW50ZWxfZHAtPnBwc19w
aXBlID0gdmx2X2luaXRpYWxfcHBzX3BpcGUoZGV2X3ByaXYsIHBvcnQsCj4gKwkJaW50ZWxfZHAt
PnBwc19waXBlID0gdmx2X2luaXRpYWxfcHBzX3BpcGUoaTkxNSwgcG9ydCwKPiAgIAkJCQkJCQkg
IHZsdl9waXBlX2hhc192ZGRfb24pOwo+ICAgCS8qIGRpZG4ndCBmaW5kIG9uZT8gcGljayBvbmUg
d2l0aCBqdXN0IHRoZSBjb3JyZWN0IHBvcnQgKi8KPiAgIAlpZiAoaW50ZWxfZHAtPnBwc19waXBl
ID09IElOVkFMSURfUElQRSkKPiAtCQlpbnRlbF9kcC0+cHBzX3BpcGUgPSB2bHZfaW5pdGlhbF9w
cHNfcGlwZShkZXZfcHJpdiwgcG9ydCwKPiArCQlpbnRlbF9kcC0+cHBzX3BpcGUgPSB2bHZfaW5p
dGlhbF9wcHNfcGlwZShpOTE1LCBwb3J0LAo+ICAgCQkJCQkJCSAgdmx2X3BpcGVfYW55KTsKPiAg
IAo+ICAgCS8qIGRpZG4ndCBmaW5kIG9uZT8ganVzdCBsZXQgdmx2X3Bvd2VyX3NlcXVlbmNlcl9w
aXBlKCkgcGljayBvbmUgd2hlbiBuZWVkZWQgKi8KPiBAQCAtOTE3LDEyICs5MTcsMTIgQEAgdmx2
X2luaXRpYWxfcG93ZXJfc2VxdWVuY2VyX3NldHVwKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAp
Cj4gICAJaW50ZWxfZHBfaW5pdF9wYW5lbF9wb3dlcl9zZXF1ZW5jZXJfcmVnaXN0ZXJzKGludGVs
X2RwLCBmYWxzZSk7Cj4gICB9Cj4gICAKPiAtdm9pZCBpbnRlbF9wb3dlcl9zZXF1ZW5jZXJfcmVz
ZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGludGVsX3Bvd2Vy
X3NlcXVlbmNlcl9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAg
IAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcjsKPiAgIAo+IC0JaWYgKFdBUk5fT04oIUlT
X1ZBTExFWVZJRVcoZGV2X3ByaXYpICYmICFJU19DSEVSUllWSUVXKGRldl9wcml2KSAmJgo+IC0J
CSAgICAhSVNfR0VOOV9MUChkZXZfcHJpdikpKQo+ICsJaWYgKFdBUk5fT04oIUlTX1ZBTExFWVZJ
RVcoaTkxNSkgJiYgIUlTX0NIRVJSWVZJRVcoaTkxNSkgJiYKPiArCQkgICAgIUlTX0dFTjlfTFAo
aTkxNSkpKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAkvKgo+IEBAIC05MzUsNyArOTM1LDcgQEAg
dm9pZCBpbnRlbF9wb3dlcl9zZXF1ZW5jZXJfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICAgCSAqIHNob3VsZCB1c2UgdGhlbSBhbHdheXMuCj4gICAJICovCj4gICAK
PiAtCWZvcl9lYWNoX2ludGVsX2RwKCZkZXZfcHJpdi0+ZHJtLCBlbmNvZGVyKSB7Cj4gKwlmb3Jf
ZWFjaF9pbnRlbF9kcCgmaTkxNS0+ZHJtLCBlbmNvZGVyKSB7Cj4gICAJCXN0cnVjdCBpbnRlbF9k
cCAqaW50ZWxfZHAgPSBlbmNfdG9faW50ZWxfZHAoJmVuY29kZXItPmJhc2UpOwo+ICAgCj4gICAJ
CVdBUk5fT04oaW50ZWxfZHAtPmFjdGl2ZV9waXBlICE9IElOVkFMSURfUElQRSk7Cj4gQEAgLTk0
Myw3ICs5NDMsNyBAQCB2b2lkIGludGVsX3Bvd2VyX3NlcXVlbmNlcl9yZXNldChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCWlmIChlbmNvZGVyLT50eXBlICE9IElOVEVM
X09VVFBVVF9FRFApCj4gICAJCQljb250aW51ZTsKPiAgIAo+IC0JCWlmIChJU19HRU45X0xQKGRl
dl9wcml2KSkKPiArCQlpZiAoSVNfR0VOOV9MUChpOTE1KSkKPiAgIAkJCWludGVsX2RwLT5wcHNf
cmVzZXQgPSB0cnVlOwo+ICAgCQllbHNlCj4gICAJCQlpbnRlbF9kcC0+cHBzX3BpcGUgPSBJTlZB
TElEX1BJUEU7Cj4gQEAgLTk2MSwxNCArOTYxLDE0IEBAIHN0cnVjdCBwcHNfcmVnaXN0ZXJzIHsK
PiAgIHN0YXRpYyB2b2lkIGludGVsX3Bwc19nZXRfcmVnaXN0ZXJzKHN0cnVjdCBpbnRlbF9kcCAq
aW50ZWxfZHAsCj4gICAJCQkJICAgIHN0cnVjdCBwcHNfcmVnaXN0ZXJzICpyZWdzKQo+ICAgewo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9k
cCk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxf
ZHApOwo+ICAgCWludCBwcHNfaWR4ID0gMDsKPiAgIAo+ICAgCW1lbXNldChyZWdzLCAwLCBzaXpl
b2YoKnJlZ3MpKTsKPiAgIAo+IC0JaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKQo+ICsJaWYgKElT
X0dFTjlfTFAoaTkxNSkpCj4gICAJCXBwc19pZHggPSBieHRfcG93ZXJfc2VxdWVuY2VyX2lkeChp
bnRlbF9kcCk7Cj4gLQllbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVS
UllWSUVXKGRldl9wcml2KSkKPiArCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNf
Q0hFUlJZVklFVyhpOTE1KSkKPiAgIAkJcHBzX2lkeCA9IHZsdl9wb3dlcl9zZXF1ZW5jZXJfcGlw
ZShpbnRlbF9kcCk7Cj4gICAKPiAgIAlyZWdzLT5wcF9jdHJsID0gUFBfQ09OVFJPTChwcHNfaWR4
KTsKPiBAQCAtOTc3LDcgKzk3Nyw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3Bwc19nZXRfcmVnaXN0
ZXJzKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gICAJcmVncy0+cHBfb2ZmID0gUFBfT0ZG
X0RFTEFZUyhwcHNfaWR4KTsKPiAgIAo+ICAgCS8qIEN5Y2xlIGRlbGF5IG1vdmVkIGZyb20gUFBf
RElWSVNPUiB0byBQUF9DT05UUk9MICovCj4gLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikgfHwg
SU5URUxfUENIX1RZUEUoZGV2X3ByaXYpID49IFBDSF9DTlApCj4gKwlpZiAoSVNfR0VOOV9MUChp
OTE1KSB8fCBJTlRFTF9QQ0hfVFlQRShpOTE1KSA+PSBQQ0hfQ05QKQo+ICAgCQlyZWdzLT5wcF9k
aXYgPSBJTlZBTElEX01NSU9fUkVHOwo+ICAgCWVsc2UKPiAgIAkJcmVncy0+cHBfZGl2ID0gUFBf
RElWSVNPUihwcHNfaWR4KTsKPiBAQCAtMTAxMCwxNCArMTAxMCwxNCBAQCBzdGF0aWMgaW50IGVk
cF9ub3RpZnlfaGFuZGxlcihzdHJ1Y3Qgbm90aWZpZXJfYmxvY2sgKnRoaXMsIHVuc2lnbmVkIGxv
bmcgY29kZSwKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gY29udGFpbmVy
X29mKHRoaXMsIHR5cGVvZigqIGludGVsX2RwKSwKPiAgIAkJCQkJCSBlZHBfbm90aWZpZXIpOwo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9k
cCk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxf
ZHApOwo+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICAgCj4gICAJaWYgKCFpbnRlbF9k
cF9pc19lZHAoaW50ZWxfZHApIHx8IGNvZGUgIT0gU1lTX1JFU1RBUlQpCj4gICAJCXJldHVybiAw
Owo+ICAgCj4gICAJd2l0aF9wcHNfbG9jayhpbnRlbF9kcCwgd2FrZXJlZikgewo+IC0JCWlmIChJ
U19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkgewo+ICsJ
CWlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiAgIAkJ
CWVudW0gcGlwZSBwaXBlID0gdmx2X3Bvd2VyX3NlcXVlbmNlcl9waXBlKGludGVsX2RwKTsKPiAg
IAkJCWk5MTVfcmVnX3QgcHBfY3RybF9yZWcsIHBwX2Rpdl9yZWc7Cj4gICAJCQl1MzIgcHBfZGl2
Owo+IEBAIC0xMDM5LDExICsxMDM5LDExIEBAIHN0YXRpYyBpbnQgZWRwX25vdGlmeV9oYW5kbGVy
KHN0cnVjdCBub3RpZmllcl9ibG9jayAqdGhpcywgdW5zaWduZWQgbG9uZyBjb2RlLAo+ICAgCj4g
ICBzdGF0aWMgYm9vbCBlZHBfaGF2ZV9wYW5lbF9wb3dlcihzdHJ1Y3QgaW50ZWxfZHAgKmludGVs
X2RwKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9f
aTkxNShpbnRlbF9kcCk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3Rv
X2k5MTUoaW50ZWxfZHApOwo+ICAgCj4gLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+
cHBzX211dGV4KTsKPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPnBwc19tdXRleCk7Cj4g
ICAKPiAtCWlmICgoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZf
cHJpdikpICYmCj4gKwlpZiAoKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhp
OTE1KSkgJiYKPiAgIAkgICAgaW50ZWxfZHAtPnBwc19waXBlID09IElOVkFMSURfUElQRSkKPiAg
IAkJcmV0dXJuIGZhbHNlOwo+ICAgCj4gQEAgLTEwNTIsMTEgKzEwNTIsMTEgQEAgc3RhdGljIGJv
b2wgZWRwX2hhdmVfcGFuZWxfcG93ZXIoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiAgIAo+
ICAgc3RhdGljIGJvb2wgZWRwX2hhdmVfcGFuZWxfdmRkKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxf
ZHApCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19p
OTE1KGludGVsX2RwKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9f
aTkxNShpbnRlbF9kcCk7Cj4gICAKPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5w
cHNfbXV0ZXgpOwo+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+cHBzX211dGV4KTsKPiAg
IAo+IC0JaWYgKChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9w
cml2KSkgJiYKPiArCWlmICgoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5
MTUpKSAmJgo+ICAgCSAgICBpbnRlbF9kcC0+cHBzX3BpcGUgPT0gSU5WQUxJRF9QSVBFKQo+ICAg
CQlyZXR1cm4gZmFsc2U7Cj4gICAKPiBAQCAtMTA2Niw3ICsxMDY2LDcgQEAgc3RhdGljIGJvb2wg
ZWRwX2hhdmVfcGFuZWxfdmRkKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICBzdGF0aWMg
dm9pZAo+ICAgaW50ZWxfZHBfY2hlY2tfZWRwKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGlu
dGVsX2RwKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShp
bnRlbF9kcCk7Cj4gICAKPiAgIAlpZiAoIWludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkpCj4gICAJ
CXJldHVybjsKPiBAQCAtMTEwMyw3ICsxMTAzLDcgQEAgaW50ZWxfZHBfYXV4X3dhaXRfZG9uZShz
dHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAgCj4gICBzdGF0aWMgdTMyIGc0eF9nZXRfYXV4
X2Nsb2NrX2RpdmlkZXIoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwgaW50IGluZGV4KQo+ICAg
ewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRl
bF9kcCk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50
ZWxfZHApOwo+ICAgCj4gICAJaWYgKGluZGV4KQo+ICAgCQlyZXR1cm4gMDsKPiBAQCAtMTExMiwx
MiArMTExMiwxMiBAQCBzdGF0aWMgdTMyIGc0eF9nZXRfYXV4X2Nsb2NrX2RpdmlkZXIoc3RydWN0
IGludGVsX2RwICppbnRlbF9kcCwgaW50IGluZGV4KQo+ICAgCSAqIFRoZSBjbG9jayBkaXZpZGVy
IGlzIGJhc2VkIG9mZiB0aGUgaHJhd2NsaywgYW5kIHdvdWxkIGxpa2UgdG8gcnVuIGF0Cj4gICAJ
ICogMk1Iei4gIFNvLCB0YWtlIHRoZSBocmF3Y2xrIHZhbHVlIGFuZCBkaXZpZGUgYnkgMjAwMCBh
bmQgdXNlIHRoYXQKPiAgIAkgKi8KPiAtCXJldHVybiBESVZfUk9VTkRfQ0xPU0VTVChkZXZfcHJp
di0+cmF3Y2xrX2ZyZXEsIDIwMDApOwo+ICsJcmV0dXJuIERJVl9ST1VORF9DTE9TRVNUKGk5MTUt
PnJhd2Nsa19mcmVxLCAyMDAwKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHUzMiBpbGtfZ2V0X2F1
eF9jbG9ja19kaXZpZGVyKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsIGludCBpbmRleCkKPiAg
IHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50
ZWxfZHApOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19pOTE1KGlu
dGVsX2RwKTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCA9IGRwX3Rv
X2RpZ19wb3J0KGludGVsX2RwKTsKPiAgIAo+ICAgCWlmIChpbmRleCkKPiBAQCAtMTEyOSwxNyAr
MTEyOSwxNyBAQCBzdGF0aWMgdTMyIGlsa19nZXRfYXV4X2Nsb2NrX2RpdmlkZXIoc3RydWN0IGlu
dGVsX2RwICppbnRlbF9kcCwgaW50IGluZGV4KQo+ICAgCSAqIGRpdmlkZSBieSAyMDAwIGFuZCB1
c2UgdGhhdAo+ICAgCSAqLwo+ICAgCWlmIChkaWdfcG9ydC0+YXV4X2NoID09IEFVWF9DSF9BKQo+
IC0JCXJldHVybiBESVZfUk9VTkRfQ0xPU0VTVChkZXZfcHJpdi0+Y2RjbGsuaHcuY2RjbGssIDIw
MDApOwo+ICsJCXJldHVybiBESVZfUk9VTkRfQ0xPU0VTVChpOTE1LT5jZGNsay5ody5jZGNsaywg
MjAwMCk7Cj4gICAJZWxzZQo+IC0JCXJldHVybiBESVZfUk9VTkRfQ0xPU0VTVChkZXZfcHJpdi0+
cmF3Y2xrX2ZyZXEsIDIwMDApOwo+ICsJCXJldHVybiBESVZfUk9VTkRfQ0xPU0VTVChpOTE1LT5y
YXdjbGtfZnJlcSwgMjAwMCk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB1MzIgaHN3X2dldF9hdXhf
Y2xvY2tfZGl2aWRlcihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLCBpbnQgaW5kZXgpCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVs
X2RwKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRl
bF9kcCk7Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQgPSBkcF90b19k
aWdfcG9ydChpbnRlbF9kcCk7Cj4gICAKPiAtCWlmIChkaWdfcG9ydC0+YXV4X2NoICE9IEFVWF9D
SF9BICYmIEhBU19QQ0hfTFBUX0goZGV2X3ByaXYpKSB7Cj4gKwlpZiAoZGlnX3BvcnQtPmF1eF9j
aCAhPSBBVVhfQ0hfQSAmJiBIQVNfUENIX0xQVF9IKGk5MTUpKSB7Cj4gICAJCS8qIFdvcmthcm91
bmQgZm9yIG5vbi1VTFQgSFNXICovCj4gICAJCXN3aXRjaCAoaW5kZXgpIHsKPiAgIAkJY2FzZSAw
OiByZXR1cm4gNjM7Cj4gQEAgLTExNjYsMTYgKzExNjYsMTYgQEAgc3RhdGljIHUzMiBnNHhfZ2V0
X2F1eF9zZW5kX2N0bChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ICAgCQkJCXUzMiBhdXhf
Y2xvY2tfZGl2aWRlcikKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRl
bF9kaWdfcG9ydCA9IGRwX3RvX2RpZ19wb3J0KGludGVsX2RwKTsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
Cj4gICAJCQl0b19pOTE1KGludGVsX2RpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsKPiAgIAl1MzIg
cHJlY2hhcmdlLCB0aW1lb3V0Owo+ICAgCj4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCA2KSkKPiAr
CWlmIChJU19HRU4oaTkxNSwgNikpCj4gICAJCXByZWNoYXJnZSA9IDM7Cj4gICAJZWxzZQo+ICAg
CQlwcmVjaGFyZ2UgPSA1Owo+ICAgCj4gLQlpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSkKPiAr
CWlmIChJU19CUk9BRFdFTEwoaTkxNSkpCj4gICAJCXRpbWVvdXQgPSBEUF9BVVhfQ0hfQ1RMX1RJ
TUVfT1VUXzYwMHVzOwo+ICAgCWVsc2UKPiAgIAkJdGltZW91dCA9IERQX0FVWF9DSF9DVExfVElN
RV9PVVRfNDAwdXM7Cj4gQEAgLTE0ODEsNyArMTQ4MSw3IEBAIGludGVsX2RwX2F1eF90cmFuc2Zl
cihzdHJ1Y3QgZHJtX2RwX2F1eCAqYXV4LCBzdHJ1Y3QgZHJtX2RwX2F1eF9tc2cgKm1zZykKPiAg
IAo+ICAgc3RhdGljIGk5MTVfcmVnX3QgZzR4X2F1eF9jdGxfcmVnKHN0cnVjdCBpbnRlbF9kcCAq
aW50ZWxfZHApCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBk
cF90b19pOTE1KGludGVsX2RwKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
ZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGln
X3BvcnQgPSBkcF90b19kaWdfcG9ydChpbnRlbF9kcCk7Cj4gICAJZW51bSBhdXhfY2ggYXV4X2No
ID0gZGlnX3BvcnQtPmF1eF9jaDsKPiAgIAo+IEBAIC0xNDk4LDcgKzE0OTgsNyBAQCBzdGF0aWMg
aTkxNV9yZWdfdCBnNHhfYXV4X2N0bF9yZWcoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiAg
IAo+ICAgc3RhdGljIGk5MTVfcmVnX3QgZzR4X2F1eF9kYXRhX3JlZyhzdHJ1Y3QgaW50ZWxfZHAg
KmludGVsX2RwLCBpbnQgaW5kZXgpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0
YWxfcG9ydCAqZGlnX3BvcnQgPSBkcF90b19kaWdfcG9ydChpbnRlbF9kcCk7Cj4gICAJZW51bSBh
dXhfY2ggYXV4X2NoID0gZGlnX3BvcnQtPmF1eF9jaDsKPiAgIAo+IEBAIC0xNTE1LDcgKzE1MTUs
NyBAQCBzdGF0aWMgaTkxNV9yZWdfdCBnNHhfYXV4X2RhdGFfcmVnKHN0cnVjdCBpbnRlbF9kcCAq
aW50ZWxfZHAsIGludCBpbmRleCkKPiAgIAo+ICAgc3RhdGljIGk5MTVfcmVnX3QgaWxrX2F1eF9j
dGxfcmVnKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gICAJc3RydWN0
IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQgPSBkcF90b19kaWdfcG9ydChpbnRlbF9kcCk7
Cj4gICAJZW51bSBhdXhfY2ggYXV4X2NoID0gZGlnX3BvcnQtPmF1eF9jaDsKPiAgIAo+IEBAIC0x
NTM0LDcgKzE1MzQsNyBAQCBzdGF0aWMgaTkxNV9yZWdfdCBpbGtfYXV4X2N0bF9yZWcoc3RydWN0
IGludGVsX2RwICppbnRlbF9kcCkKPiAgIAo+ICAgc3RhdGljIGk5MTVfcmVnX3QgaWxrX2F1eF9k
YXRhX3JlZyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLCBpbnQgaW5kZXgpCj4gICB7Cj4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsK
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7
Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQgPSBkcF90b19kaWdfcG9y
dChpbnRlbF9kcCk7Cj4gICAJZW51bSBhdXhfY2ggYXV4X2NoID0gZGlnX3BvcnQtPmF1eF9jaDsK
PiAgIAo+IEBAIC0xNTUzLDcgKzE1NTMsNyBAQCBzdGF0aWMgaTkxNV9yZWdfdCBpbGtfYXV4X2Rh
dGFfcmVnKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsIGludCBpbmRleCkKPiAgIAo+ICAgc3Rh
dGljIGk5MTVfcmVnX3Qgc2tsX2F1eF9jdGxfcmVnKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAp
Cj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1
KGludGVsX2RwKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkx
NShpbnRlbF9kcCk7Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQgPSBk
cF90b19kaWdfcG9ydChpbnRlbF9kcCk7Cj4gICAJZW51bSBhdXhfY2ggYXV4X2NoID0gZGlnX3Bv
cnQtPmF1eF9jaDsKPiAgIAo+IEBAIC0xNTczLDcgKzE1NzMsNyBAQCBzdGF0aWMgaTkxNV9yZWdf
dCBza2xfYXV4X2N0bF9yZWcoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiAgIAo+ICAgc3Rh
dGljIGk5MTVfcmVnX3Qgc2tsX2F1eF9kYXRhX3JlZyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2Rw
LCBpbnQgaW5kZXgpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSBkcF90b19pOTE1KGludGVsX2RwKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAq
ZGlnX3BvcnQgPSBkcF90b19kaWdfcG9ydChpbnRlbF9kcCk7Cj4gICAJZW51bSBhdXhfY2ggYXV4
X2NoID0gZGlnX3BvcnQtPmF1eF9jaDsKPiAgIAo+IEBAIC0xNjAwLDE0ICsxNjAwLDE0IEBAIGlu
dGVsX2RwX2F1eF9maW5pKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICBzdGF0aWMgdm9p
ZAo+ICAgaW50ZWxfZHBfYXV4X2luaXQoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiAgIHsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxf
ZHApOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19pOTE1KGludGVs
X2RwKTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCA9IGRwX3RvX2Rp
Z19wb3J0KGludGVsX2RwKTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciA9ICZk
aWdfcG9ydC0+YmFzZTsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkgewo+
ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KSB7Cj4gICAJCWludGVsX2RwLT5hdXhfY2hfY3Rs
X3JlZyA9IHNrbF9hdXhfY3RsX3JlZzsKPiAgIAkJaW50ZWxfZHAtPmF1eF9jaF9kYXRhX3JlZyA9
IHNrbF9hdXhfZGF0YV9yZWc7Cj4gLQl9IGVsc2UgaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3ByaXYp
KSB7Cj4gKwl9IGVsc2UgaWYgKEhBU19QQ0hfU1BMSVQoaTkxNSkpIHsKPiAgIAkJaW50ZWxfZHAt
PmF1eF9jaF9jdGxfcmVnID0gaWxrX2F1eF9jdGxfcmVnOwo+ICAgCQlpbnRlbF9kcC0+YXV4X2No
X2RhdGFfcmVnID0gaWxrX2F1eF9kYXRhX3JlZzsKPiAgIAl9IGVsc2Ugewo+IEBAIC0xNjE1LDE2
ICsxNjE1LDE2IEBAIGludGVsX2RwX2F1eF9pbml0KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAp
Cj4gICAJCWludGVsX2RwLT5hdXhfY2hfZGF0YV9yZWcgPSBnNHhfYXV4X2RhdGFfcmVnOwo+ICAg
CX0KPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkKPiArCWlmIChJTlRFTF9H
RU4oaTkxNSkgPj0gOSkKPiAgIAkJaW50ZWxfZHAtPmdldF9hdXhfY2xvY2tfZGl2aWRlciA9IHNr
bF9nZXRfYXV4X2Nsb2NrX2RpdmlkZXI7Cj4gLQllbHNlIGlmIChJU19CUk9BRFdFTEwoZGV2X3By
aXYpIHx8IElTX0hBU1dFTEwoZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAoSVNfQlJPQURXRUxMKGk5
MTUpIHx8IElTX0hBU1dFTEwoaTkxNSkpCj4gICAJCWludGVsX2RwLT5nZXRfYXV4X2Nsb2NrX2Rp
dmlkZXIgPSBoc3dfZ2V0X2F1eF9jbG9ja19kaXZpZGVyOwo+IC0JZWxzZSBpZiAoSEFTX1BDSF9T
UExJVChkZXZfcHJpdikpCj4gKwllbHNlIGlmIChIQVNfUENIX1NQTElUKGk5MTUpKQo+ICAgCQlp
bnRlbF9kcC0+Z2V0X2F1eF9jbG9ja19kaXZpZGVyID0gaWxrX2dldF9hdXhfY2xvY2tfZGl2aWRl
cjsKPiAgIAllbHNlCj4gICAJCWludGVsX2RwLT5nZXRfYXV4X2Nsb2NrX2RpdmlkZXIgPSBnNHhf
Z2V0X2F1eF9jbG9ja19kaXZpZGVyOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+
PSA5KQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ICAgCQlpbnRlbF9kcC0+Z2V0X2F1
eF9zZW5kX2N0bCA9IHNrbF9nZXRfYXV4X3NlbmRfY3RsOwo+ICAgCWVsc2UKPiAgIAkJaW50ZWxf
ZHAtPmdldF9hdXhfc2VuZF9jdGwgPSBnNHhfZ2V0X2F1eF9zZW5kX2N0bDsKPiBAQCAtMTY1NSwy
MCArMTY1NSwyMCBAQCBzdGF0aWMgdm9pZAo+ICAgaW50ZWxfZHBfc2V0X2Nsb2NrKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
cGlwZV9jb25maWcpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJY29uc3Qgc3RydWN0IGRw
X2xpbmtfZHBsbCAqZGl2aXNvciA9IE5VTEw7Cj4gICAJaW50IGksIGNvdW50ID0gMDsKPiAgIAo+
IC0JaWYgKElTX0c0WChkZXZfcHJpdikpIHsKPiArCWlmIChJU19HNFgoaTkxNSkpIHsKPiAgIAkJ
ZGl2aXNvciA9IGc0eF9kcGxsOwo+ICAgCQljb3VudCA9IEFSUkFZX1NJWkUoZzR4X2RwbGwpOwo+
IC0JfSBlbHNlIGlmIChIQVNfUENIX1NQTElUKGRldl9wcml2KSkgewo+ICsJfSBlbHNlIGlmIChI
QVNfUENIX1NQTElUKGk5MTUpKSB7Cj4gICAJCWRpdmlzb3IgPSBwY2hfZHBsbDsKPiAgIAkJY291
bnQgPSBBUlJBWV9TSVpFKHBjaF9kcGxsKTsKPiAtCX0gZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhk
ZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkgewo+ICAgCQlk
aXZpc29yID0gY2h2X2RwbGw7Cj4gICAJCWNvdW50ID0gQVJSQVlfU0laRShjaHZfZHBsbCk7Cj4g
LQl9IGVsc2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpKSB7Cj4gKwl9IGVsc2UgaWYgKElT
X1ZBTExFWVZJRVcoaTkxNSkpIHsKPiAgIAkJZGl2aXNvciA9IHZsdl9kcGxsOwo+ICAgCQljb3Vu
dCA9IEFSUkFZX1NJWkUodmx2X2RwbGwpOwo+ICAgCX0KPiBAQCAtMTc2MCw5ICsxNzYwLDkgQEAg
dm9pZCBpbnRlbF9kcF9jb21wdXRlX3JhdGUoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwgaW50
IHBvcnRfY2xvY2ssCj4gICBzdGF0aWMgYm9vbCBpbnRlbF9kcF9zb3VyY2Vfc3VwcG9ydHNfZmVj
KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gICAJCQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gICAKPiAtCXJldHVybiBJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDExICYmCj4gKwlyZXR1cm4gSU5URUxfR0VOKGk5MTUpID49IDEx
ICYmCj4gICAJCXBpcGVfY29uZmlnLT5jcHVfdHJhbnNjb2RlciAhPSBUUkFOU0NPREVSX0E7Cj4g
ICB9Cj4gICAKPiBAQCAtMTc3Niw5ICsxNzc2LDkgQEAgc3RhdGljIGJvb2wgaW50ZWxfZHBfc3Vw
cG9ydHNfZmVjKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gICBzdGF0aWMgYm9vbCBpbnRl
bF9kcF9zb3VyY2Vfc3VwcG9ydHNfZHNjKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gICAJ
CQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gICB7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2Rw
KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9k
cCk7Cj4gICAKPiAtCXJldHVybiBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwICYmCj4gKwlyZXR1
cm4gSU5URUxfR0VOKGk5MTUpID49IDEwICYmCj4gICAJCXBpcGVfY29uZmlnLT5jcHVfdHJhbnNj
b2RlciAhPSBUUkFOU0NPREVSX0E7Cj4gICB9Cj4gICAKPiBAQCAtMTc5NSw3ICsxNzk1LDcgQEAg
c3RhdGljIGJvb2wgaW50ZWxfZHBfc3VwcG9ydHNfZHNjKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxf
ZHAsCj4gICBzdGF0aWMgaW50IGludGVsX2RwX2NvbXB1dGVfYnBwKHN0cnVjdCBpbnRlbF9kcCAq
aW50ZWxfZHAsCj4gICAJCQkJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+
ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShp
bnRlbF9kcCk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUo
aW50ZWxfZHApOwo+ICAgCXN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmludGVsX2Nvbm5lY3RvciA9
IGludGVsX2RwLT5hdHRhY2hlZF9jb25uZWN0b3I7Cj4gICAJaW50IGJwcCwgYnBjOwo+ICAgCj4g
QEAgLTE4MDgsMTAgKzE4MDgsMTAgQEAgc3RhdGljIGludCBpbnRlbF9kcF9jb21wdXRlX2JwcChz
dHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ICAgCWlmIChpbnRlbF9kcF9pc19lZHAoaW50ZWxf
ZHApKSB7Cj4gICAJCS8qIEdldCBicHAgZnJvbSB2YnQgb25seSBmb3IgcGFuZWxzIHRoYXQgZG9u
dCBoYXZlIGJwcCBpbiBlZGlkICovCj4gICAJCWlmIChpbnRlbF9jb25uZWN0b3ItPmJhc2UuZGlz
cGxheV9pbmZvLmJwYyA9PSAwICYmCj4gLQkJICAgIGRldl9wcml2LT52YnQuZWRwLmJwcCAmJiBk
ZXZfcHJpdi0+dmJ0LmVkcC5icHAgPCBicHApIHsKPiArCQkgICAgaTkxNS0+dmJ0LmVkcC5icHAg
JiYgaTkxNS0+dmJ0LmVkcC5icHAgPCBicHApIHsKPiAgIAkJCURSTV9ERUJVR19LTVMoImNsYW1w
aW5nIGJwcCBmb3IgZURQIHBhbmVsIHRvIEJJT1MtcHJvdmlkZWQgJWlcbiIsCj4gLQkJCQkgICAg
ICBkZXZfcHJpdi0+dmJ0LmVkcC5icHApOwo+IC0JCQlicHAgPSBkZXZfcHJpdi0+dmJ0LmVkcC5i
cHA7Cj4gKwkJCQkgICAgICBpOTE1LT52YnQuZWRwLmJwcCk7Cj4gKwkJCWJwcCA9IGk5MTUtPnZi
dC5lZHAuYnBwOwo+ICAgCQl9Cj4gICAJfQo+ICAgCj4gQEAgLTE5MjQsNyArMTkyNCw3IEBAIHN0
YXRpYyBpbnQgaW50ZWxfZHBfZHNjX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9kcCAqaW50
ZWxfZHAsCj4gICAJCQkJICAgICAgIHN0cnVjdCBsaW5rX2NvbmZpZ19saW1pdHMgKmxpbWl0cykK
PiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCA9IGRwX3RvX2Rp
Z19wb3J0KGludGVsX2RwKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsKPiAgIAlzdHJ1
Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+YmFzZS5h
ZGp1c3RlZF9tb2RlOwo+ICAgCXU4IGRzY19tYXhfYnBjOwo+ICAgCWludCBwaXBlX2JwcDsKPiBA
QCAtMTk4OCw3ICsxOTg4LDcgQEAgc3RhdGljIGludCBpbnRlbF9kcF9kc2NfY29tcHV0ZV9jb25m
aWcoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiAgIAkgKiBpcyBncmVhdGVyIHRoYW4gdGhl
IG1heGltdW0gQ2RjbG9jayBhbmQgaWYgc2xpY2UgY291bnQgaXMgZXZlbgo+ICAgCSAqIHRoZW4g
d2UgbmVlZCB0byB1c2UgMiBWRFNDIGluc3RhbmNlcy4KPiAgIAkgKi8KPiAtCWlmIChhZGp1c3Rl
ZF9tb2RlLT5jcnRjX2Nsb2NrID4gZGV2X3ByaXYtPm1heF9jZGNsa19mcmVxKSB7Cj4gKwlpZiAo
YWRqdXN0ZWRfbW9kZS0+Y3J0Y19jbG9jayA+IGk5MTUtPm1heF9jZGNsa19mcmVxKSB7Cj4gICAJ
CWlmIChwaXBlX2NvbmZpZy0+ZHNjX3BhcmFtcy5zbGljZV9jb3VudCA+IDEpIHsKPiAgIAkJCXBp
cGVfY29uZmlnLT5kc2NfcGFyYW1zLmRzY19zcGxpdCA9IHRydWU7Cj4gICAJCX0gZWxzZSB7Cj4g
QEAgLTIxNjgsNyArMjE2OCw3IEBAIGludGVsX2RwX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVf
Y29uZmlnLAo+ICAgCQkJc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29k
ZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVz
dGVkX21vZGUgPSAmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPiAgIAlzdHJ1Y3Qg
aW50ZWxfZHAgKmludGVsX2RwID0gZW5jX3RvX2ludGVsX2RwKCZlbmNvZGVyLT5iYXNlKTsKPiAg
IAlzdHJ1Y3QgaW50ZWxfbHNwY29uICpsc3Bjb24gPSBlbmNfdG9faW50ZWxfbHNwY29uKCZlbmNv
ZGVyLT5iYXNlKTsKPiBAQCAtMjE4MSw3ICsyMTgxLDcgQEAgaW50ZWxfZHBfY29tcHV0ZV9jb25m
aWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkJCSAgIERQX0RQQ0RfUVVJ
UktfQ09OU1RBTlRfTik7Cj4gICAJaW50IHJldCA9IDAsIG91dHB1dF9icHA7Cj4gICAKPiAtCWlm
IChIQVNfUENIX1NQTElUKGRldl9wcml2KSAmJiAhSEFTX0RESShkZXZfcHJpdikgJiYgcG9ydCAh
PSBQT1JUX0EpCj4gKwlpZiAoSEFTX1BDSF9TUExJVChpOTE1KSAmJiAhSEFTX0RESShpOTE1KSAm
JiBwb3J0ICE9IFBPUlRfQSkKPiAgIAkJcGlwZV9jb25maWctPmhhc19wY2hfZW5jb2RlciA9IHRy
dWU7Cj4gICAKPiAgIAlwaXBlX2NvbmZpZy0+b3V0cHV0X2Zvcm1hdCA9IElOVEVMX09VVFBVVF9G
T1JNQVRfUkdCOwo+IEBAIC0yMTk1LDcgKzIxOTUsNyBAQCBpbnRlbF9kcF9jb21wdXRlX2NvbmZp
ZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJcmV0dXJuIHJldDsKPiAgIAo+
ICAgCXBpcGVfY29uZmlnLT5oYXNfZHJycyA9IGZhbHNlOwo+IC0JaWYgKElTX0c0WChkZXZfcHJp
dikgfHwgcG9ydCA9PSBQT1JUX0EpCj4gKwlpZiAoSVNfRzRYKGk5MTUpIHx8IHBvcnQgPT0gUE9S
VF9BKQo+ICAgCQlwaXBlX2NvbmZpZy0+aGFzX2F1ZGlvID0gZmFsc2U7Cj4gICAJZWxzZSBpZiAo
aW50ZWxfY29ubl9zdGF0ZS0+Zm9yY2VfYXVkaW8gPT0gSERNSV9BVURJT19BVVRPKQo+ICAgCQlw
aXBlX2NvbmZpZy0+aGFzX2F1ZGlvID0gaW50ZWxfZHAtPmhhc19hdWRpbzsKPiBAQCAtMjIwNiwx
MyArMjIwNiwxMyBAQCBpbnRlbF9kcF9jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiAgIAkJaW50ZWxfZml4ZWRfcGFuZWxfbW9kZShpbnRlbF9jb25uZWN0b3It
PnBhbmVsLmZpeGVkX21vZGUsCj4gICAJCQkJICAgICAgIGFkanVzdGVkX21vZGUpOwo+ICAgCj4g
LQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkgewo+ICsJCWlmIChJTlRFTF9HRU4oaTkx
NSkgPj0gOSkgewo+ICAgCQkJcmV0ID0gc2tsX3VwZGF0ZV9zY2FsZXJfY3J0YyhwaXBlX2NvbmZp
Zyk7Cj4gICAJCQlpZiAocmV0KQo+ICAgCQkJCXJldHVybiByZXQ7Cj4gICAJCX0KPiAgIAo+IC0J
CWlmIChIQVNfR01DSChkZXZfcHJpdikpCj4gKwkJaWYgKEhBU19HTUNIKGk5MTUpKQo+ICAgCQkJ
aW50ZWxfZ21jaF9wYW5lbF9maXR0aW5nKGludGVsX2NydGMsIHBpcGVfY29uZmlnLAo+ICAgCQkJ
CQkJIGNvbm5fc3RhdGUtPnNjYWxpbmdfbW9kZSk7Cj4gICAJCWVsc2UKPiBAQCAtMjIyMyw3ICsy
MjIzLDcgQEAgaW50ZWxfZHBfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCj4gICAJaWYgKGFkanVzdGVkX21vZGUtPmZsYWdzICYgRFJNX01PREVfRkxBR19EQkxT
Q0FOKQo+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiAgIAo+IC0JaWYgKEhBU19HTUNIKGRldl9wcml2
KSAmJgo+ICsJaWYgKEhBU19HTUNIKGk5MTUpICYmCj4gICAJICAgIGFkanVzdGVkX21vZGUtPmZs
YWdzICYgRFJNX01PREVfRkxBR19JTlRFUkxBQ0UpCj4gICAJCXJldHVybiAtRUlOVkFMOwo+ICAg
Cj4gQEAgLTIyNTAsNyArMjI1MCw3IEBAIGludGVsX2RwX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJICAgICAgIGNvbnN0YW50X24pOwo+ICAgCj4g
ICAJaWYgKGludGVsX2Nvbm5lY3Rvci0+cGFuZWwuZG93bmNsb2NrX21vZGUgIT0gTlVMTCAmJgo+
IC0JCWRldl9wcml2LT5kcnJzLnR5cGUgPT0gU0VBTUxFU1NfRFJSU19TVVBQT1JUKSB7Cj4gKwkJ
aTkxNS0+ZHJycy50eXBlID09IFNFQU1MRVNTX0RSUlNfU1VQUE9SVCkgewo+ICAgCQkJcGlwZV9j
b25maWctPmhhc19kcnJzID0gdHJ1ZTsKPiAgIAkJCWludGVsX2xpbmtfY29tcHV0ZV9tX24ob3V0
cHV0X2JwcCwKPiAgIAkJCQkJICAgICAgIHBpcGVfY29uZmlnLT5sYW5lX2NvdW50LAo+IEBAIC0y
MjYwLDcgKzIyNjAsNyBAQCBpbnRlbF9kcF9jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKPiAgIAkJCQkJICAgICAgIGNvbnN0YW50X24pOwo+ICAgCX0KPiAgIAo+
IC0JaWYgKCFIQVNfRERJKGRldl9wcml2KSkKPiArCWlmICghSEFTX0RESShpOTE1KSkKPiAgIAkJ
aW50ZWxfZHBfc2V0X2Nsb2NrKGVuY29kZXIsIHBpcGVfY29uZmlnKTsKPiAgIAo+ICAgCWludGVs
X3Bzcl9jb21wdXRlX2NvbmZpZyhpbnRlbF9kcCwgcGlwZV9jb25maWcpOwo+IEBAIC0yMjgxLDcg
KzIyODEsNyBAQCB2b2lkIGludGVsX2RwX3NldF9saW5rX3BhcmFtcyhzdHJ1Y3QgaW50ZWxfZHAg
KmludGVsX2RwLAo+ICAgc3RhdGljIHZvaWQgaW50ZWxfZHBfcHJlcGFyZShzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCSAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKnBpcGVfY29uZmlnKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRl
bF9kcCAqaW50ZWxfZHAgPSBlbmNfdG9faW50ZWxfZHAoJmVuY29kZXItPmJhc2UpOwo+ICAgCWVu
dW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0Yyk7Cj4gQEAgLTIzMjAsNyAr
MjMyMCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RwX3ByZXBhcmUoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIsCj4gICAKPiAgIAkvKiBTcGxpdCBvdXQgdGhlIElCWC9DUFUgdnMgQ1BUIHNl
dHRpbmdzICovCj4gICAKPiAtCWlmIChJU19JVllCUklER0UoZGV2X3ByaXYpICYmIHBvcnQgPT0g
UE9SVF9BKSB7Cj4gKwlpZiAoSVNfSVZZQlJJREdFKGk5MTUpICYmIHBvcnQgPT0gUE9SVF9BKSB7
Cj4gICAJCWlmIChhZGp1c3RlZF9tb2RlLT5mbGFncyAmIERSTV9NT0RFX0ZMQUdfUEhTWU5DKQo+
ICAgCQkJaW50ZWxfZHAtPkRQIHw9IERQX1NZTkNfSFNfSElHSDsKPiAgIAkJaWYgKGFkanVzdGVk
X21vZGUtPmZsYWdzICYgRFJNX01PREVfRkxBR19QVlNZTkMpCj4gQEAgLTIzMzEsNyArMjMzMSw3
IEBAIHN0YXRpYyB2b2lkIGludGVsX2RwX3ByZXBhcmUoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCj4gICAJCQlpbnRlbF9kcC0+RFAgfD0gRFBfRU5IQU5DRURfRlJBTUlORzsKPiAgIAo+
ICAgCQlpbnRlbF9kcC0+RFAgfD0gRFBfUElQRV9TRUxfSVZCKGNydGMtPnBpcGUpOwo+IC0JfSBl
bHNlIGlmIChIQVNfUENIX0NQVChkZXZfcHJpdikgJiYgcG9ydCAhPSBQT1JUX0EpIHsKPiArCX0g
ZWxzZSBpZiAoSEFTX1BDSF9DUFQoaTkxNSkgJiYgcG9ydCAhPSBQT1JUX0EpIHsKPiAgIAkJdTMy
IHRyYW5zX2RwOwo+ICAgCj4gICAJCWludGVsX2RwLT5EUCB8PSBEUF9MSU5LX1RSQUlOX09GRl9D
UFQ7Cj4gQEAgLTIzNDMsNyArMjM0Myw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RwX3ByZXBhcmUo
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQl0cmFuc19kcCAmPSB+VFJBTlNf
RFBfRU5IX0ZSQU1JTkc7Cj4gICAJCUk5MTVfV1JJVEUoVFJBTlNfRFBfQ1RMKGNydGMtPnBpcGUp
LCB0cmFuc19kcCk7Cj4gICAJfSBlbHNlIHsKPiAtCQlpZiAoSVNfRzRYKGRldl9wcml2KSAmJiBw
aXBlX2NvbmZpZy0+bGltaXRlZF9jb2xvcl9yYW5nZSkKPiArCQlpZiAoSVNfRzRYKGk5MTUpICYm
IHBpcGVfY29uZmlnLT5saW1pdGVkX2NvbG9yX3JhbmdlKQo+ICAgCQkJaW50ZWxfZHAtPkRQIHw9
IERQX0NPTE9SX1JBTkdFXzE2XzIzNTsKPiAgIAo+ICAgCQlpZiAoYWRqdXN0ZWRfbW9kZS0+Zmxh
Z3MgJiBEUk1fTU9ERV9GTEFHX1BIU1lOQykKPiBAQCAtMjM1NSw3ICsyMzU1LDcgQEAgc3RhdGlj
IHZvaWQgaW50ZWxfZHBfcHJlcGFyZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAg
IAkJaWYgKGRybV9kcF9lbmhhbmNlZF9mcmFtZV9jYXAoaW50ZWxfZHAtPmRwY2QpKQo+ICAgCQkJ
aW50ZWxfZHAtPkRQIHw9IERQX0VOSEFOQ0VEX0ZSQU1JTkc7Cj4gICAKPiAtCQlpZiAoSVNfQ0hF
UlJZVklFVyhkZXZfcHJpdikpCj4gKwkJaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gICAJCQlp
bnRlbF9kcC0+RFAgfD0gRFBfUElQRV9TRUxfQ0hWKGNydGMtPnBpcGUpOwo+ICAgCQllbHNlCj4g
ICAJCQlpbnRlbF9kcC0+RFAgfD0gRFBfUElQRV9TRUwoY3J0Yy0+cGlwZSk7Cj4gQEAgLTIzNzcs
MTAgKzIzNzcsMTAgQEAgc3RhdGljIHZvaWQgd2FpdF9wYW5lbF9zdGF0dXMoc3RydWN0IGludGVs
X2RwICppbnRlbF9kcCwKPiAgIAkJCQkgICAgICAgdTMyIG1hc2ssCj4gICAJCQkJICAgICAgIHUz
MiB2YWx1ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRw
X3RvX2k5MTUoaW50ZWxfZHApOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBk
cF90b19pOTE1KGludGVsX2RwKTsKPiAgIAlpOTE1X3JlZ190IHBwX3N0YXRfcmVnLCBwcF9jdHJs
X3JlZzsKPiAgIAo+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPnBwc19tdXRleCk7
Cj4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5wcHNfbXV0ZXgpOwo+ICAgCj4gICAJaW50
ZWxfcHBzX3ZlcmlmeV9zdGF0ZShpbnRlbF9kcCk7Cj4gICAKPiBAQCAtMjM5Miw3ICsyMzkyLDcg
QEAgc3RhdGljIHZvaWQgd2FpdF9wYW5lbF9zdGF0dXMoc3RydWN0IGludGVsX2RwICppbnRlbF9k
cCwKPiAgIAkJCUk5MTVfUkVBRChwcF9zdGF0X3JlZyksCj4gICAJCQlJOTE1X1JFQUQocHBfY3Ry
bF9yZWcpKTsKPiAgIAo+IC0JaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+
dW5jb3JlLAo+ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsCj4g
ICAJCQkJICAgIHBwX3N0YXRfcmVnLCBtYXNrLCB2YWx1ZSwKPiAgIAkJCQkgICAgNTAwMCkpCj4g
ICAJCURSTV9FUlJPUigiUGFuZWwgc3RhdHVzIHRpbWVvdXQ6IHN0YXR1cyAlMDh4IGNvbnRyb2wg
JTA4eFxuIiwKPiBAQCAtMjQ1MywxMyArMjQ1MywxMyBAQCBzdGF0aWMgdm9pZCBlZHBfd2FpdF9i
YWNrbGlnaHRfb2ZmKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICAKPiAgIHN0YXRpYyAg
dTMyIGlyb25sYWtlX2dldF9wcF9jb250cm9sKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGlu
dGVsX2RwKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShp
bnRlbF9kcCk7Cj4gICAJdTMyIGNvbnRyb2w7Cj4gICAKPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQo
JmRldl9wcml2LT5wcHNfbXV0ZXgpOwo+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+cHBz
X211dGV4KTsKPiAgIAo+ICAgCWNvbnRyb2wgPSBJOTE1X1JFQUQoX3BwX2N0cmxfcmVnKGludGVs
X2RwKSk7Cj4gLQlpZiAoV0FSTl9PTighSEFTX0RESShkZXZfcHJpdikgJiYKPiArCWlmIChXQVJO
X09OKCFIQVNfRERJKGk5MTUpICYmCj4gICAJCSAgICAoY29udHJvbCAmIFBBTkVMX1VOTE9DS19N
QVNLKSAhPSBQQU5FTF9VTkxPQ0tfUkVHUykpIHsKPiAgIAkJY29udHJvbCAmPSB+UEFORUxfVU5M
T0NLX01BU0s7Cj4gICAJCWNvbnRyb2wgfD0gUEFORUxfVU5MT0NLX1JFR1M7Cj4gQEAgLTI0NzQs
MTMgKzI0NzQsMTMgQEAgc3RhdGljICB1MzIgaXJvbmxha2VfZ2V0X3BwX2NvbnRyb2woc3RydWN0
IGludGVsX2RwICppbnRlbF9kcCkKPiAgICAqLwo+ICAgc3RhdGljIGJvb2wgZWRwX3BhbmVsX3Zk
ZF9vbihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ICAgCXN0cnVjdCBp
bnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0ID0gZHBfdG9fZGlnX3BvcnQoaW50ZWxf
ZHApOwo+ICAgCXUzMiBwcDsKPiAgIAlpOTE1X3JlZ190IHBwX3N0YXRfcmVnLCBwcF9jdHJsX3Jl
ZzsKPiAgIAlib29sIG5lZWRfdG9fZGlzYWJsZSA9ICFpbnRlbF9kcC0+d2FudF9wYW5lbF92ZGQ7
Cj4gICAKPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5wcHNfbXV0ZXgpOwo+ICsJ
bG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+cHBzX211dGV4KTsKPiAgIAo+ICAgCWlmICghaW50
ZWxfZHBfaXNfZWRwKGludGVsX2RwKSkKPiAgIAkJcmV0dXJuIGZhbHNlOwo+IEBAIC0yNDkxLDcg
KzI0OTEsNyBAQCBzdGF0aWMgYm9vbCBlZHBfcGFuZWxfdmRkX29uKHN0cnVjdCBpbnRlbF9kcCAq
aW50ZWxfZHApCj4gICAJaWYgKGVkcF9oYXZlX3BhbmVsX3ZkZChpbnRlbF9kcCkpCj4gICAJCXJl
dHVybiBuZWVkX3RvX2Rpc2FibGU7Cj4gICAKPiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGRl
dl9wcml2LAo+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoaTkxNSwKPiAgIAkJCQlpbnRlbF9h
dXhfcG93ZXJfZG9tYWluKGludGVsX2RpZ19wb3J0KSk7Cj4gICAKPiAgIAlEUk1fREVCVUdfS01T
KCJUdXJuaW5nIGVEUCBwb3J0ICVjIFZERCBvblxuIiwKPiBAQCAtMjU0NiwxMyArMjU0NiwxMyBA
QCB2b2lkIGludGVsX2VkcF9wYW5lbF92ZGRfb24oc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkK
PiAgIAo+ICAgc3RhdGljIHZvaWQgZWRwX3BhbmVsX3ZkZF9vZmZfc3luYyhzdHJ1Y3QgaW50ZWxf
ZHAgKmludGVsX2RwKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQg
KmludGVsX2RpZ19wb3J0ID0KPiAgIAkJZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApOwo+ICAgCXUz
MiBwcDsKPiAgIAlpOTE1X3JlZ190IHBwX3N0YXRfcmVnLCBwcF9jdHJsX3JlZzsKPiAgIAo+IC0J
bG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPnBwc19tdXRleCk7Cj4gKwlsb2NrZGVwX2Fz
c2VydF9oZWxkKCZpOTE1LT5wcHNfbXV0ZXgpOwo+ICAgCj4gICAJV0FSTl9PTihpbnRlbF9kcC0+
d2FudF9wYW5lbF92ZGQpOwo+ICAgCj4gQEAgLTI1NzgsNyArMjU3OCw3IEBAIHN0YXRpYyB2b2lk
IGVkcF9wYW5lbF92ZGRfb2ZmX3N5bmMoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiAgIAlp
ZiAoKHBwICYgUEFORUxfUE9XRVJfT04pID09IDApCj4gICAJCWludGVsX2RwLT5wYW5lbF9wb3dl
cl9vZmZfdGltZSA9IGt0aW1lX2dldF9ib290dGltZSgpOwo+ICAgCj4gLQlpbnRlbF9kaXNwbGF5
X3Bvd2VyX3B1dF91bmNoZWNrZWQoZGV2X3ByaXYsCj4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1
dF91bmNoZWNrZWQoaTkxNSwKPiAgIAkJCQkJICBpbnRlbF9hdXhfcG93ZXJfZG9tYWluKGludGVs
X2RpZ19wb3J0KSk7Cj4gICB9Cj4gICAKPiBAQCAtMjYxNSw5ICsyNjE1LDkgQEAgc3RhdGljIHZv
aWQgZWRwX3BhbmVsX3ZkZF9zY2hlZHVsZV9vZmYoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkK
PiAgICAqLwo+ICAgc3RhdGljIHZvaWQgZWRwX3BhbmVsX3ZkZF9vZmYoc3RydWN0IGludGVsX2Rw
ICppbnRlbF9kcCwgYm9vbCBzeW5jKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ICAgCj4gLQlsb2NrZGVwX2Fzc2Vy
dF9oZWxkKCZkZXZfcHJpdi0+cHBzX211dGV4KTsKPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5
MTUtPnBwc19tdXRleCk7Cj4gICAKPiAgIAlpZiAoIWludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkp
Cj4gICAJCXJldHVybjsKPiBAQCAtMjYzNSwxMSArMjYzNSwxMSBAQCBzdGF0aWMgdm9pZCBlZHBf
cGFuZWxfdmRkX29mZihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLCBib29sIHN5bmMpCj4gICAK
PiAgIHN0YXRpYyB2b2lkIGVkcF9wYW5lbF9vbihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+
ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShp
bnRlbF9kcCk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUo
aW50ZWxfZHApOwo+ICAgCXUzMiBwcDsKPiAgIAlpOTE1X3JlZ190IHBwX2N0cmxfcmVnOwo+ICAg
Cj4gLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+cHBzX211dGV4KTsKPiArCWxvY2tk
ZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPnBwc19tdXRleCk7Cj4gICAKPiAgIAlpZiAoIWludGVsX2Rw
X2lzX2VkcChpbnRlbF9kcCkpCj4gICAJCXJldHVybjsKPiBAQCAtMjY1Niw3ICsyNjU2LDcgQEAg
c3RhdGljIHZvaWQgZWRwX3BhbmVsX29uKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICAK
PiAgIAlwcF9jdHJsX3JlZyA9IF9wcF9jdHJsX3JlZyhpbnRlbF9kcCk7Cj4gICAJcHAgPSBpcm9u
bGFrZV9nZXRfcHBfY29udHJvbChpbnRlbF9kcCk7Cj4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCA1
KSkgewo+ICsJaWYgKElTX0dFTihpOTE1LCA1KSkgewo+ICAgCQkvKiBJTEsgd29ya2Fyb3VuZDog
ZGlzYWJsZSByZXNldCBhcm91bmQgcG93ZXIgc2VxdWVuY2UgKi8KPiAgIAkJcHAgJj0gflBBTkVM
X1BPV0VSX1JFU0VUOwo+ICAgCQlJOTE1X1dSSVRFKHBwX2N0cmxfcmVnLCBwcCk7Cj4gQEAgLTI2
NjQsNyArMjY2NCw3IEBAIHN0YXRpYyB2b2lkIGVkcF9wYW5lbF9vbihzdHJ1Y3QgaW50ZWxfZHAg
KmludGVsX2RwKQo+ICAgCX0KPiAgIAo+ICAgCXBwIHw9IFBBTkVMX1BPV0VSX09OOwo+IC0JaWYg
KCFJU19HRU4oZGV2X3ByaXYsIDUpKQo+ICsJaWYgKCFJU19HRU4oaTkxNSwgNSkpCj4gICAJCXBw
IHw9IFBBTkVMX1BPV0VSX1JFU0VUOwo+ICAgCj4gICAJSTkxNV9XUklURShwcF9jdHJsX3JlZywg
cHApOwo+IEBAIC0yNjczLDcgKzI2NzMsNyBAQCBzdGF0aWMgdm9pZCBlZHBfcGFuZWxfb24oc3Ry
dWN0IGludGVsX2RwICppbnRlbF9kcCkKPiAgIAl3YWl0X3BhbmVsX29uKGludGVsX2RwKTsKPiAg
IAlpbnRlbF9kcC0+bGFzdF9wb3dlcl9vbiA9IGppZmZpZXM7Cj4gICAKPiAtCWlmIChJU19HRU4o
ZGV2X3ByaXYsIDUpKSB7Cj4gKwlpZiAoSVNfR0VOKGk5MTUsIDUpKSB7Cj4gICAJCXBwIHw9IFBB
TkVMX1BPV0VSX1JFU0VUOyAvKiByZXN0b3JlIHBhbmVsIHJlc2V0IGJpdCAqLwo+ICAgCQlJOTE1
X1dSSVRFKHBwX2N0cmxfcmVnLCBwcCk7Cj4gICAJCVBPU1RJTkdfUkVBRChwcF9jdHJsX3JlZyk7
Cj4gQEAgLTI2OTQsMTIgKzI2OTQsMTIgQEAgdm9pZCBpbnRlbF9lZHBfcGFuZWxfb24oc3RydWN0
IGludGVsX2RwICppbnRlbF9kcCkKPiAgIAo+ICAgc3RhdGljIHZvaWQgZWRwX3BhbmVsX29mZihz
dHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ICAgCXN0cnVjdCBpbnRlbF9k
aWdpdGFsX3BvcnQgKmRpZ19wb3J0ID0gZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApOwo+ICAgCXUz
MiBwcDsKPiAgIAlpOTE1X3JlZ190IHBwX2N0cmxfcmVnOwo+ICAgCj4gLQlsb2NrZGVwX2Fzc2Vy
dF9oZWxkKCZkZXZfcHJpdi0+cHBzX211dGV4KTsKPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5
MTUtPnBwc19tdXRleCk7Cj4gICAKPiAgIAlpZiAoIWludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkp
Cj4gICAJCXJldHVybjsKPiBAQCAtMjcyNyw3ICsyNzI3LDcgQEAgc3RhdGljIHZvaWQgZWRwX3Bh
bmVsX29mZihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAgCWludGVsX2RwLT5wYW5lbF9w
b3dlcl9vZmZfdGltZSA9IGt0aW1lX2dldF9ib290dGltZSgpOwo+ICAgCj4gICAJLyogV2UgZ290
IGEgcmVmZXJlbmNlIHdoZW4gd2UgZW5hYmxlZCB0aGUgVkRELiAqLwo+IC0JaW50ZWxfZGlzcGxh
eV9wb3dlcl9wdXRfdW5jaGVja2VkKGRldl9wcml2LCBpbnRlbF9hdXhfcG93ZXJfZG9tYWluKGRp
Z19wb3J0KSk7Cj4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dF91bmNoZWNrZWQoaTkxNSwgaW50
ZWxfYXV4X3Bvd2VyX2RvbWFpbihkaWdfcG9ydCkpOwo+ICAgfQo+ICAgCj4gICB2b2lkIGludGVs
X2VkcF9wYW5lbF9vZmYoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiBAQCAtMjc0NCw3ICsy
NzQ0LDcgQEAgdm9pZCBpbnRlbF9lZHBfcGFuZWxfb2ZmKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxf
ZHApCj4gICAvKiBFbmFibGUgYmFja2xpZ2h0IGluIHRoZSBwYW5lbCBwb3dlciBjb250cm9sLiAq
Lwo+ICAgc3RhdGljIHZvaWQgX2ludGVsX2VkcF9iYWNrbGlnaHRfb24oc3RydWN0IGludGVsX2Rw
ICppbnRlbF9kcCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSBkcF90b19pOTE1KGludGVsX2RwKTsKPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiAg
IAo+ICAgCS8qCj4gQEAgLTI3ODUsNyArMjc4NSw3IEBAIHZvaWQgaW50ZWxfZWRwX2JhY2tsaWdo
dF9vbihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIC8qIERp
c2FibGUgYmFja2xpZ2h0IGluIHRoZSBwYW5lbCBwb3dlciBjb250cm9sLiAqLwo+ICAgc3RhdGlj
IHZvaWQgX2ludGVsX2VkcF9iYWNrbGlnaHRfb2ZmKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAp
Cj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1
KGludGVsX2RwKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkx
NShpbnRlbF9kcCk7Cj4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gICAKPiAgIAlpZiAo
IWludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkpCj4gQEAgLTI4NDksNyArMjg0OSw3IEBAIHN0YXRp
YyB2b2lkIGludGVsX2VkcF9iYWNrbGlnaHRfcG93ZXIoc3RydWN0IGludGVsX2Nvbm5lY3RvciAq
Y29ubmVjdG9yLAo+ICAgc3RhdGljIHZvaWQgYXNzZXJ0X2RwX3BvcnQoc3RydWN0IGludGVsX2Rw
ICppbnRlbF9kcCwgYm9vbCBzdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9w
b3J0ICpkaWdfcG9ydCA9IGRwX3RvX2RpZ19wb3J0KGludGVsX2RwKTsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRpZ19wb3J0LT5i
YXNlLmJhc2UuZGV2KTsKPiAgIAlib29sIGN1cl9zdGF0ZSA9IEk5MTVfUkVBRChpbnRlbF9kcC0+
b3V0cHV0X3JlZykgJiBEUF9QT1JUX0VOOwo+ICAgCj4gICAJSTkxNV9TVEFURV9XQVJOKGN1cl9z
dGF0ZSAhPSBzdGF0ZSwKPiBAQCAtMjg1OSw3ICsyODU5LDcgQEAgc3RhdGljIHZvaWQgYXNzZXJ0
X2RwX3BvcnQoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwgYm9vbCBzdGF0ZSkKPiAgIH0KPiAg
ICNkZWZpbmUgYXNzZXJ0X2RwX3BvcnRfZGlzYWJsZWQoZCkgYXNzZXJ0X2RwX3BvcnQoKGQpLCBm
YWxzZSkKPiAgIAo+IC1zdGF0aWMgdm9pZCBhc3NlcnRfZWRwX3BsbChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsIGJvb2wgc3RhdGUpCj4gK3N0YXRpYyB2b2lkIGFzc2VydF9lZHBf
cGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBib29sIHN0YXRlKQo+ICAgewo+ICAg
CWJvb2wgY3VyX3N0YXRlID0gSTkxNV9SRUFEKERQX0EpICYgRFBfUExMX0VOQUJMRTsKPiAgIAo+
IEBAIC0yODc0LDExICsyODc0LDExIEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX2VkcF9wbGxfb24o
c3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiAgIAkJCQljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMg
PSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT5iYXNlLmNydGMpOwo+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAg
Cj4gLQlhc3NlcnRfcGlwZV9kaXNhYmxlZChkZXZfcHJpdiwgY3J0Yy0+cGlwZSk7Cj4gKwlhc3Nl
cnRfcGlwZV9kaXNhYmxlZChpOTE1LCBjcnRjLT5waXBlKTsKPiAgIAlhc3NlcnRfZHBfcG9ydF9k
aXNhYmxlZChpbnRlbF9kcCk7Cj4gLQlhc3NlcnRfZWRwX3BsbF9kaXNhYmxlZChkZXZfcHJpdik7
Cj4gKwlhc3NlcnRfZWRwX3BsbF9kaXNhYmxlZChpOTE1KTsKPiAgIAo+ICAgCURSTV9ERUJVR19L
TVMoImVuYWJsaW5nIGVEUCBQTEwgZm9yIGNsb2NrICVkXG4iLAo+ICAgCQkgICAgICBwaXBlX2Nv
bmZpZy0+cG9ydF9jbG9jayk7Cj4gQEAgLTI5MDAsOCArMjkwMCw4IEBAIHN0YXRpYyB2b2lkIGly
b25sYWtlX2VkcF9wbGxfb24oc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiAgIAkgKiAxLiBX
YWl0IGZvciB0aGUgc3RhcnQgb2YgdmVydGljYWwgYmxhbmsgb24gdGhlIGVuYWJsZWQgcGlwZSBn
b2luZyB0byBGREkKPiAgIAkgKiAyLiBQcm9ncmFtIERQIFBMTCBlbmFibGUKPiAgIAkgKi8KPiAt
CWlmIChJU19HRU4oZGV2X3ByaXYsIDUpKQo+IC0JCWludGVsX3dhaXRfZm9yX3ZibGFua19pZl9h
Y3RpdmUoZGV2X3ByaXYsICFjcnRjLT5waXBlKTsKPiArCWlmIChJU19HRU4oaTkxNSwgNSkpCj4g
KwkJaW50ZWxfd2FpdF9mb3JfdmJsYW5rX2lmX2FjdGl2ZShpOTE1LCAhY3J0Yy0+cGlwZSk7Cj4g
ICAKPiAgIAlpbnRlbF9kcC0+RFAgfD0gRFBfUExMX0VOQUJMRTsKPiAgIAo+IEBAIC0yOTE0LDEx
ICsyOTE0LDExIEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX2VkcF9wbGxfb2ZmKHN0cnVjdCBpbnRl
bF9kcCAqaW50ZWxfZHAsCj4gICAJCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpv
bGRfY3J0Y19zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMob2xkX2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gICAKPiAt
CWFzc2VydF9waXBlX2Rpc2FibGVkKGRldl9wcml2LCBjcnRjLT5waXBlKTsKPiArCWFzc2VydF9w
aXBlX2Rpc2FibGVkKGk5MTUsIGNydGMtPnBpcGUpOwo+ICAgCWFzc2VydF9kcF9wb3J0X2Rpc2Fi
bGVkKGludGVsX2RwKTsKPiAtCWFzc2VydF9lZHBfcGxsX2VuYWJsZWQoZGV2X3ByaXYpOwo+ICsJ
YXNzZXJ0X2VkcF9wbGxfZW5hYmxlZChpOTE1KTsKPiAgIAo+ICAgCURSTV9ERUJVR19LTVMoImRp
c2FibGluZyBlRFAgUExMXG4iKTsKPiAgIAo+IEBAIC0yOTk5LDEyICsyOTk5LDEyIEBAIHZvaWQg
aW50ZWxfZHBfc2lua19kcG1zKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsIGludCBtb2RlKQo+
ICAgCQkJICAgICAgbW9kZSA9PSBEUk1fTU9ERV9EUE1TX09OID8gImVuYWJsZSIgOiAiZGlzYWJs
ZSIpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBib29sIGNwdF9kcF9wb3J0X3NlbGVjdGVkKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIGJvb2wgY3B0X2RwX3BvcnRf
c2VsZWN0ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJIGVudW0gcG9y
dCBwb3J0LCBlbnVtIHBpcGUgKnBpcGUpCj4gICB7Cj4gICAJZW51bSBwaXBlIHA7Cj4gICAKPiAt
CWZvcl9lYWNoX3BpcGUoZGV2X3ByaXYsIHApIHsKPiArCWZvcl9lYWNoX3BpcGUoaTkxNSwgcCkg
ewo+ICAgCQl1MzIgdmFsID0gSTkxNV9SRUFEKFRSQU5TX0RQX0NUTChwKSk7Cj4gICAKPiAgIAkJ
aWYgKCh2YWwgJiBUUkFOU19EUF9QT1JUX1NFTF9NQVNLKSA9PSBUUkFOU19EUF9QT1JUX1NFTChw
b3J0KSkgewo+IEBAIC0zMDIxLDcgKzMwMjEsNyBAQCBzdGF0aWMgYm9vbCBjcHRfZHBfcG9ydF9z
ZWxlY3RlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJcmV0dXJuIGZh
bHNlOwo+ICAgfQo+ICAgCj4gLWJvb2wgaW50ZWxfZHBfcG9ydF9lbmFibGVkKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArYm9vbCBpbnRlbF9kcF9wb3J0X2VuYWJsZWQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICBpOTE1X3JlZ190IGRwX3JlZywg
ZW51bSBwb3J0IHBvcnQsCj4gICAJCQkgICBlbnVtIHBpcGUgKnBpcGUpCj4gICB7Cj4gQEAgLTMw
MzMsMTEgKzMwMzMsMTEgQEAgYm9vbCBpbnRlbF9kcF9wb3J0X2VuYWJsZWQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCXJldCA9IHZhbCAmIERQX1BPUlRfRU47Cj4gICAK
PiAgIAkvKiBhc3NlcnRzIHdhbnQgdG8ga25vdyB0aGUgcGlwZSBldmVuIGlmIHRoZSBwb3J0IGlz
IGRpc2FibGVkICovCj4gLQlpZiAoSVNfSVZZQlJJREdFKGRldl9wcml2KSAmJiBwb3J0ID09IFBP
UlRfQSkKPiArCWlmIChJU19JVllCUklER0UoaTkxNSkgJiYgcG9ydCA9PSBQT1JUX0EpCj4gICAJ
CSpwaXBlID0gKHZhbCAmIERQX1BJUEVfU0VMX01BU0tfSVZCKSA+PiBEUF9QSVBFX1NFTF9TSElG
VF9JVkI7Cj4gLQllbHNlIGlmIChIQVNfUENIX0NQVChkZXZfcHJpdikgJiYgcG9ydCAhPSBQT1JU
X0EpCj4gLQkJcmV0ICY9IGNwdF9kcF9wb3J0X3NlbGVjdGVkKGRldl9wcml2LCBwb3J0LCBwaXBl
KTsKPiAtCWVsc2UgaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAoSEFT
X1BDSF9DUFQoaTkxNSkgJiYgcG9ydCAhPSBQT1JUX0EpCj4gKwkJcmV0ICY9IGNwdF9kcF9wb3J0
X3NlbGVjdGVkKGk5MTUsIHBvcnQsIHBpcGUpOwo+ICsJZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhp
OTE1KSkKPiAgIAkJKnBpcGUgPSAodmFsICYgRFBfUElQRV9TRUxfTUFTS19DSFYpID4+IERQX1BJ
UEVfU0VMX1NISUZUX0NIVjsKPiAgIAllbHNlCj4gICAJCSpwaXBlID0gKHZhbCAmIERQX1BJUEVf
U0VMX01BU0spID4+IERQX1BJUEVfU0VMX1NISUZUOwo+IEBAIC0zMDQ4LDIwICszMDQ4LDIwIEBA
IGJvb2wgaW50ZWxfZHBfcG9ydF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiAgIHN0YXRpYyBib29sIGludGVsX2RwX2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCQkgIGVudW0gcGlwZSAqcGlwZSkKPiAgIHsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5k
ZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gZW5jX3RvX2ludGVs
X2RwKCZlbmNvZGVyLT5iYXNlKTsKPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiAgIAli
b29sIHJldDsKPiAgIAo+IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2Vu
YWJsZWQoZGV2X3ByaXYsCj4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZf
ZW5hYmxlZChpOTE1LAo+ICAgCQkJCQkJICAgICBlbmNvZGVyLT5wb3dlcl9kb21haW4pOwo+ICAg
CWlmICghd2FrZXJlZikKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAgCj4gLQlyZXQgPSBpbnRlbF9k
cF9wb3J0X2VuYWJsZWQoZGV2X3ByaXYsIGludGVsX2RwLT5vdXRwdXRfcmVnLAo+ICsJcmV0ID0g
aW50ZWxfZHBfcG9ydF9lbmFibGVkKGk5MTUsIGludGVsX2RwLT5vdXRwdXRfcmVnLAo+ICAgCQkJ
CSAgICBlbmNvZGVyLT5wb3J0LCBwaXBlKTsKPiAgIAo+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9w
dXQoZGV2X3ByaXYsIGVuY29kZXItPnBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gKwlpbnRlbF9k
aXNwbGF5X3Bvd2VyX3B1dChpOTE1LCBlbmNvZGVyLT5wb3dlcl9kb21haW4sIHdha2VyZWYpOwo+
ICAgCj4gICAJcmV0dXJuIHJldDsKPiAgIH0KPiBAQCAtMzA2OSw3ICszMDY5LDcgQEAgc3RhdGlj
IGJvb2wgaW50ZWxfZHBfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ICAgc3RhdGljIHZvaWQgaW50ZWxfZHBfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiAgIAkJCQlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcp
Cj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVu
Y29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9
IGVuY190b19pbnRlbF9kcCgmZW5jb2Rlci0+YmFzZSk7Cj4gICAJdTMyIHRtcCwgZmxhZ3MgPSAw
Owo+ICAgCWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKPiBAQCAtMzA4NCw3ICszMDg0
LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHBfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiAgIAo+ICAgCXBpcGVfY29uZmlnLT5oYXNfYXVkaW8gPSB0bXAgJiBEUF9B
VURJT19PVVRQVVRfRU5BQkxFICYmIHBvcnQgIT0gUE9SVF9BOwo+ICAgCj4gLQlpZiAoSEFTX1BD
SF9DUFQoZGV2X3ByaXYpICYmIHBvcnQgIT0gUE9SVF9BKSB7Cj4gKwlpZiAoSEFTX1BDSF9DUFQo
aTkxNSkgJiYgcG9ydCAhPSBQT1JUX0EpIHsKPiAgIAkJdTMyIHRyYW5zX2RwID0gSTkxNV9SRUFE
KFRSQU5TX0RQX0NUTChjcnRjLT5waXBlKSk7Cj4gICAKPiAgIAkJaWYgKHRyYW5zX2RwICYgVFJB
TlNfRFBfSFNZTkNfQUNUSVZFX0hJR0gpCj4gQEAgLTMxMTAsNyArMzExMCw3IEBAIHN0YXRpYyB2
b2lkIGludGVsX2RwX2dldF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4g
ICAKPiAgIAlwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmZsYWdzIHw9IGZsYWdzOwo+
ICAgCj4gLQlpZiAoSVNfRzRYKGRldl9wcml2KSAmJiB0bXAgJiBEUF9DT0xPUl9SQU5HRV8xNl8y
MzUpCj4gKwlpZiAoSVNfRzRYKGk5MTUpICYmIHRtcCAmIERQX0NPTE9SX1JBTkdFXzE2XzIzNSkK
PiAgIAkJcGlwZV9jb25maWctPmxpbWl0ZWRfY29sb3JfcmFuZ2UgPSB0cnVlOwo+ICAgCj4gICAJ
cGlwZV9jb25maWctPmxhbmVfY291bnQgPQo+IEBAIC0zMTI5LDggKzMxMjksOCBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9kcF9nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+
ICAgCQlpbnRlbF9kb3RjbG9ja19jYWxjdWxhdGUocGlwZV9jb25maWctPnBvcnRfY2xvY2ssCj4g
ICAJCQkJCSAmcGlwZV9jb25maWctPmRwX21fbik7Cj4gICAKPiAtCWlmIChpbnRlbF9kcF9pc19l
ZHAoaW50ZWxfZHApICYmIGRldl9wcml2LT52YnQuZWRwLmJwcCAmJgo+IC0JICAgIHBpcGVfY29u
ZmlnLT5waXBlX2JwcCA+IGRldl9wcml2LT52YnQuZWRwLmJwcCkgewo+ICsJaWYgKGludGVsX2Rw
X2lzX2VkcChpbnRlbF9kcCkgJiYgaTkxNS0+dmJ0LmVkcC5icHAgJiYKPiArCSAgICBwaXBlX2Nv
bmZpZy0+cGlwZV9icHAgPiBpOTE1LT52YnQuZWRwLmJwcCkgewo+ICAgCQkvKgo+ICAgCQkgKiBU
aGlzIGlzIGEgYmlnIGZhdCB1Z2x5IGhhY2suCj4gICAJCSAqCj4gQEAgLTMxNDUsOCArMzE0NSw4
IEBAIHN0YXRpYyB2b2lkIGludGVsX2RwX2dldF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4gICAJCSAqIGxvYWQuCj4gICAJCSAqLwo+ICAgCQlEUk1fREVCVUdfS01TKCJw
aXBlIGhhcyAlZCBicHAgZm9yIGVEUCBwYW5lbCwgb3ZlcnJpZGluZyBCSU9TLXByb3ZpZGVkIG1h
eCAlZCBicHBcbiIsCj4gLQkJCSAgICAgIHBpcGVfY29uZmlnLT5waXBlX2JwcCwgZGV2X3ByaXYt
PnZidC5lZHAuYnBwKTsKPiAtCQlkZXZfcHJpdi0+dmJ0LmVkcC5icHAgPSBwaXBlX2NvbmZpZy0+
cGlwZV9icHA7Cj4gKwkJCSAgICAgIHBpcGVfY29uZmlnLT5waXBlX2JwcCwgaTkxNS0+dmJ0LmVk
cC5icHApOwo+ICsJCWk5MTUtPnZidC5lZHAuYnBwID0gcGlwZV9jb25maWctPnBpcGVfYnBwOwo+
ICAgCX0KPiAgIH0KPiAgIAo+IEBAIC0zMjE1LDE2ICszMjE1LDE2IEBAIHN0YXRpYyB2b2lkIGNo
dl9wb3N0X2Rpc2FibGVfZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkJ
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+ICAgCQkJCWNv
bnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFz
ZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29k
ZXItPmJhc2UuZGV2KTsKPiAgIAo+ICAgCWludGVsX2RwX2xpbmtfZG93bihlbmNvZGVyLCBvbGRf
Y3J0Y19zdGF0ZSk7Cj4gICAKPiAtCXZsdl9kcGlvX2dldChkZXZfcHJpdik7Cj4gKwl2bHZfZHBp
b19nZXQoaTkxNSk7Cj4gICAKPiAgIAkvKiBBc3NlcnQgZGF0YSBsYW5lIHJlc2V0ICovCj4gICAJ
Y2h2X2RhdGFfbGFuZV9zb2Z0X3Jlc2V0KGVuY29kZXIsIG9sZF9jcnRjX3N0YXRlLCB0cnVlKTsK
PiAgIAo+IC0Jdmx2X2RwaW9fcHV0KGRldl9wcml2KTsKPiArCXZsdl9kcGlvX3B1dChpOTE1KTsK
PiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQKPiBAQCAtMzIzMiw3ICszMjMyLDcgQEAgX2ludGVs
X2RwX3NldF9saW5rX3RyYWluKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gICAJCQkgdTMy
ICpEUCwKPiAgIAkJCSB1OCBkcF90cmFpbl9wYXQpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gICAJc3RydWN0IGlu
dGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQgPSBkcF90b19kaWdfcG9ydChpbnRlbF9k
cCk7Cj4gICAJZW51bSBwb3J0IHBvcnQgPSBpbnRlbF9kaWdfcG9ydC0+YmFzZS5wb3J0Owo+ICAg
CXU4IHRyYWluX3BhdF9tYXNrID0gZHJtX2RwX3RyYWluaW5nX3BhdHRlcm5fbWFzayhpbnRlbF9k
cC0+ZHBjZCk7Cj4gQEAgLTMyNDEsNyArMzI0MSw3IEBAIF9pbnRlbF9kcF9zZXRfbGlua190cmFp
bihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ICAgCQlEUk1fREVCVUdfS01TKCJVc2luZyBE
UCB0cmFpbmluZyBwYXR0ZXJuIFRQUyVkXG4iLAo+ICAgCQkJICAgICAgZHBfdHJhaW5fcGF0ICYg
dHJhaW5fcGF0X21hc2spOwo+ICAgCj4gLQlpZiAoSEFTX0RESShkZXZfcHJpdikpIHsKPiArCWlm
IChIQVNfRERJKGk5MTUpKSB7Cj4gICAJCXUzMiB0ZW1wID0gSTkxNV9SRUFEKERQX1RQX0NUTChw
b3J0KSk7Cj4gICAKPiAgIAkJaWYgKGRwX3RyYWluX3BhdCAmIERQX0xJTktfU0NSQU1CTElOR19E
SVNBQkxFKQo+IEBAIC0zMjcwLDggKzMyNzAsOCBAQCBfaW50ZWxfZHBfc2V0X2xpbmtfdHJhaW4o
c3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiAgIAkJfQo+ICAgCQlJOTE1X1dSSVRFKERQX1RQ
X0NUTChwb3J0KSwgdGVtcCk7Cj4gICAKPiAtCX0gZWxzZSBpZiAoKElTX0lWWUJSSURHRShkZXZf
cHJpdikgJiYgcG9ydCA9PSBQT1JUX0EpIHx8Cj4gLQkJICAgKEhBU19QQ0hfQ1BUKGRldl9wcml2
KSAmJiBwb3J0ICE9IFBPUlRfQSkpIHsKPiArCX0gZWxzZSBpZiAoKElTX0lWWUJSSURHRShpOTE1
KSAmJiBwb3J0ID09IFBPUlRfQSkgfHwKPiArCQkgICAoSEFTX1BDSF9DUFQoaTkxNSkgJiYgcG9y
dCAhPSBQT1JUX0EpKSB7Cj4gICAJCSpEUCAmPSB+RFBfTElOS19UUkFJTl9NQVNLX0NQVDsKPiAg
IAo+ICAgCQlzd2l0Y2ggKGRwX3RyYWluX3BhdCAmIERQX1RSQUlOSU5HX1BBVFRFUk5fTUFTSykg
ewo+IEBAIC0zMzE0LDcgKzMzMTQsNyBAQCBfaW50ZWxfZHBfc2V0X2xpbmtfdHJhaW4oc3RydWN0
IGludGVsX2RwICppbnRlbF9kcCwKPiAgIHN0YXRpYyB2b2lkIGludGVsX2RwX2VuYWJsZV9wb3J0
KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gICAJCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiAgIAo+ICAgCS8qIGVuYWJs
ZSB3aXRoIHBhdHRlcm4gMSAoYXMgcGVyIHNwZWMpICovCj4gICAKPiBAQCAtMzMzOCw3ICszMzM4
LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAo+ICAgCQkJICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2Nv
bmZpZywKPiAgIAkJCSAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9z
dGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVs
X2RwID0gZW5jX3RvX2ludGVsX2RwKCZlbmNvZGVyLT5iYXNlKTsKPiAgIAlzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0Yyk7Cj4gICAJ
dTMyIGRwX3JlZyA9IEk5MTVfUkVBRChpbnRlbF9kcC0+b3V0cHV0X3JlZyk7Cj4gQEAgLTMzNDks
NyArMzM0OSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2VuYWJsZV9kcChzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJd2l0aF9wcHNfbG9jayhpbnRl
bF9kcCwgd2FrZXJlZikgewo+IC0JCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19D
SEVSUllWSUVXKGRldl9wcml2KSkKPiArCQlpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19D
SEVSUllWSUVXKGk5MTUpKQo+ICAgCQkJdmx2X2luaXRfcGFuZWxfcG93ZXJfc2VxdWVuY2VyKGVu
Y29kZXIsIHBpcGVfY29uZmlnKTsKPiAgIAo+ICAgCQlpbnRlbF9kcF9lbmFibGVfcG9ydChpbnRl
bF9kcCwgcGlwZV9jb25maWcpOwo+IEBAIC0zMzU5LDEzICszMzU5LDEzIEBAIHN0YXRpYyB2b2lk
IGludGVsX2VuYWJsZV9kcChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJZWRw
X3BhbmVsX3ZkZF9vZmYoaW50ZWxfZHAsIHRydWUpOwo+ICAgCX0KPiAgIAo+IC0JaWYgKElTX1ZB
TExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gKwlpZiAo
SVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gICAJCXVuc2ln
bmVkIGludCBsYW5lX21hc2sgPSAweDA7Cj4gICAKPiAtCQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZf
cHJpdikpCj4gKwkJaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gICAJCQlsYW5lX21hc2sgPSBp
bnRlbF9kcF91bnVzZWRfbGFuZV9tYXNrKHBpcGVfY29uZmlnLT5sYW5lX2NvdW50KTsKPiAgIAo+
IC0JCXZsdl93YWl0X3BvcnRfcmVhZHkoZGV2X3ByaXYsIGRwX3RvX2RpZ19wb3J0KGludGVsX2Rw
KSwKPiArCQl2bHZfd2FpdF9wb3J0X3JlYWR5KGk5MTUsIGRwX3RvX2RpZ19wb3J0KGludGVsX2Rw
KSwKPiAgIAkJCQkgICAgbGFuZV9tYXNrKTsKPiAgIAl9Cj4gICAKPiBAQCAtMzQxMiw3ICszNDEy
LDcgQEAgc3RhdGljIHZvaWQgZzR4X3ByZV9lbmFibGVfZHAoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4gICBzdGF0aWMgdm9pZCB2bHZfZGV0YWNoX3Bvd2VyX3NlcXVlbmNlcihzdHJ1
Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3Bv
cnQgKmludGVsX2RpZ19wb3J0ID0gZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApOwo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShpbnRlbF9kaWdfcG9ydC0+YmFz
ZS5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
aW50ZWxfZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOwo+ICAgCWVudW0gcGlwZSBwaXBlID0gaW50
ZWxfZHAtPnBwc19waXBlOwo+ICAgCWk5MTVfcmVnX3QgcHBfb25fcmVnID0gUFBfT05fREVMQVlT
KHBpcGUpOwo+ICAgCj4gQEAgLTM0NDAsMTQgKzM0NDAsMTQgQEAgc3RhdGljIHZvaWQgdmx2X2Rl
dGFjaF9wb3dlcl9zZXF1ZW5jZXIoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiAgIAlpbnRl
bF9kcC0+cHBzX3BpcGUgPSBJTlZBTElEX1BJUEU7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQg
dmx2X3N0ZWFsX3Bvd2VyX3NlcXVlbmNlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gK3N0YXRpYyB2b2lkIHZsdl9zdGVhbF9wb3dlcl9zZXF1ZW5jZXIoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgICAgZW51bSBwaXBlIHBpcGUpCj4gICB7Cj4g
ICAJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXI7Cj4gICAKPiAtCWxvY2tkZXBfYXNzZXJ0
X2hlbGQoJmRldl9wcml2LT5wcHNfbXV0ZXgpOwo+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkx
NS0+cHBzX211dGV4KTsKPiAgIAo+IC0JZm9yX2VhY2hfaW50ZWxfZHAoJmRldl9wcml2LT5kcm0s
IGVuY29kZXIpIHsKPiArCWZvcl9lYWNoX2ludGVsX2RwKCZpOTE1LT5kcm0sIGVuY29kZXIpIHsK
PiAgIAkJc3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9IGVuY190b19pbnRlbF9kcCgmZW5jb2Rl
ci0+YmFzZSk7Cj4gICAJCWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKPiAgIAo+IEBA
IC0zNDY5LDExICszNDY5LDExIEBAIHN0YXRpYyB2b2lkIHZsdl9zdGVhbF9wb3dlcl9zZXF1ZW5j
ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgc3RhdGljIHZvaWQgdmx2
X2luaXRfcGFuZWxfcG93ZXJfc2VxdWVuY2VyKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ICAgCQkJCQkgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkK
PiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5j
b2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0g
ZW5jX3RvX2ludGVsX2RwKCZlbmNvZGVyLT5iYXNlKTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAgIAo+IC0JbG9j
a2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPnBwc19tdXRleCk7Cj4gKwlsb2NrZGVwX2Fzc2Vy
dF9oZWxkKCZpOTE1LT5wcHNfbXV0ZXgpOwo+ICAgCj4gICAJV0FSTl9PTihpbnRlbF9kcC0+YWN0
aXZlX3BpcGUgIT0gSU5WQUxJRF9QSVBFKTsKPiAgIAo+IEBAIC0zNDkxLDcgKzM0OTEsNyBAQCBz
dGF0aWMgdm9pZCB2bHZfaW5pdF9wYW5lbF9wb3dlcl9zZXF1ZW5jZXIoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmVuY29kZXIsCj4gICAJICogV2UgbWF5IGJlIHN0ZWFsaW5nIHRoZSBwb3dlcgo+ICAg
CSAqIHNlcXVlbmNlciBmcm9tIGFub3RoZXIgcG9ydC4KPiAgIAkgKi8KPiAtCXZsdl9zdGVhbF9w
b3dlcl9zZXF1ZW5jZXIoZGV2X3ByaXYsIGNydGMtPnBpcGUpOwo+ICsJdmx2X3N0ZWFsX3Bvd2Vy
X3NlcXVlbmNlcihpOTE1LCBjcnRjLT5waXBlKTsKPiAgIAo+ICAgCWludGVsX2RwLT5hY3RpdmVf
cGlwZSA9IGNydGMtPnBpcGU7Cj4gICAKPiBAQCAtMzU3MCwxNyArMzU3MCwxNyBAQCBpbnRlbF9k
cF9nZXRfbGlua19zdGF0dXMoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwgdTggbGlua19zdGF0
dXNbRFBfTElOS19TVEFUVQo+ICAgdTgKPiAgIGludGVsX2RwX3ZvbHRhZ2VfbWF4KHN0cnVjdCBp
bnRlbF9kcCAqaW50ZWxfZHApCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gICAJc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIgPSAmZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApLT5iYXNlOwo+ICAgCWVudW0gcG9y
dCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKPiAgIAo+IC0JaWYgKEhBU19EREkoZGV2X3ByaXYpKQo+
ICsJaWYgKEhBU19EREkoaTkxNSkpCj4gICAJCXJldHVybiBpbnRlbF9kZGlfZHBfdm9sdGFnZV9t
YXgoZW5jb2Rlcik7Cj4gLQllbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19D
SEVSUllWSUVXKGRldl9wcml2KSkKPiArCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwg
SVNfQ0hFUlJZVklFVyhpOTE1KSkKPiAgIAkJcmV0dXJuIERQX1RSQUlOX1ZPTFRBR0VfU1dJTkdf
TEVWRUxfMzsKPiAtCWVsc2UgaWYgKElTX0lWWUJSSURHRShkZXZfcHJpdikgJiYgcG9ydCA9PSBQ
T1JUX0EpCj4gKwllbHNlIGlmIChJU19JVllCUklER0UoaTkxNSkgJiYgcG9ydCA9PSBQT1JUX0Ep
Cj4gICAJCXJldHVybiBEUF9UUkFJTl9WT0xUQUdFX1NXSU5HX0xFVkVMXzI7Cj4gLQllbHNlIGlm
IChIQVNfUENIX0NQVChkZXZfcHJpdikgJiYgcG9ydCAhPSBQT1JUX0EpCj4gKwllbHNlIGlmIChI
QVNfUENIX0NQVChpOTE1KSAmJiBwb3J0ICE9IFBPUlRfQSkKPiAgIAkJcmV0dXJuIERQX1RSQUlO
X1ZPTFRBR0VfU1dJTkdfTEVWRUxfMzsKPiAgIAllbHNlCj4gICAJCXJldHVybiBEUF9UUkFJTl9W
T0xUQUdFX1NXSU5HX0xFVkVMXzI7Cj4gQEAgLTM1ODksMTMgKzM1ODksMTMgQEAgaW50ZWxfZHBf
dm9sdGFnZV9tYXgoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiAgIHU4Cj4gICBpbnRlbF9k
cF9wcmVfZW1waGFzaXNfbWF4KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsIHU4IHZvbHRhZ2Vf
c3dpbmcpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90
b19pOTE1KGludGVsX2RwKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBf
dG9faTkxNShpbnRlbF9kcCk7Cj4gICAJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIgPSAm
ZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApLT5iYXNlOwo+ICAgCWVudW0gcG9ydCBwb3J0ID0gZW5j
b2Rlci0+cG9ydDsKPiAgIAo+IC0JaWYgKEhBU19EREkoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSEFT
X0RESShpOTE1KSkgewo+ICAgCQlyZXR1cm4gaW50ZWxfZGRpX2RwX3ByZV9lbXBoYXNpc19tYXgo
ZW5jb2Rlciwgdm9sdGFnZV9zd2luZyk7Cj4gLQl9IGVsc2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2
X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gKwl9IGVsc2UgaWYgKElTX1ZB
TExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkgewo+ICAgCQlzd2l0Y2ggKHZv
bHRhZ2Vfc3dpbmcgJiBEUF9UUkFJTl9WT0xUQUdFX1NXSU5HX01BU0spIHsKPiAgIAkJY2FzZSBE
UF9UUkFJTl9WT0xUQUdFX1NXSU5HX0xFVkVMXzA6Cj4gICAJCQlyZXR1cm4gRFBfVFJBSU5fUFJF
X0VNUEhfTEVWRUxfMzsKPiBAQCAtMzYwNyw3ICszNjA3LDcgQEAgaW50ZWxfZHBfcHJlX2VtcGhh
c2lzX21heChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLCB1OCB2b2x0YWdlX3N3aW5nKQo+ICAg
CQlkZWZhdWx0Ogo+ICAgCQkJcmV0dXJuIERQX1RSQUlOX1BSRV9FTVBIX0xFVkVMXzA7Cj4gICAJ
CX0KPiAtCX0gZWxzZSBpZiAoSVNfSVZZQlJJREdFKGRldl9wcml2KSAmJiBwb3J0ID09IFBPUlRf
QSkgewo+ICsJfSBlbHNlIGlmIChJU19JVllCUklER0UoaTkxNSkgJiYgcG9ydCA9PSBQT1JUX0Ep
IHsKPiAgIAkJc3dpdGNoICh2b2x0YWdlX3N3aW5nICYgRFBfVFJBSU5fVk9MVEFHRV9TV0lOR19N
QVNLKSB7Cj4gICAJCWNhc2UgRFBfVFJBSU5fVk9MVEFHRV9TV0lOR19MRVZFTF8wOgo+ICAgCQkJ
cmV0dXJuIERQX1RSQUlOX1BSRV9FTVBIX0xFVkVMXzI7Cj4gQEAgLTM5MDEsMjUgKzM5MDEsMjUg
QEAgaXZiX2NwdV9lZHBfc2lnbmFsX2xldmVscyh1OCB0cmFpbl9zZXQpCj4gICB2b2lkCj4gICBp
bnRlbF9kcF9zZXRfc2lnbmFsX2xldmVscyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAg
ewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRl
bF9kcCk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50
ZWxfZHApOwo+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0ID0g
ZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApOwo+ICAgCWVudW0gcG9ydCBwb3J0ID0gaW50ZWxfZGln
X3BvcnQtPmJhc2UucG9ydDsKPiAgIAl1MzIgc2lnbmFsX2xldmVscywgbWFzayA9IDA7Cj4gICAJ
dTggdHJhaW5fc2V0ID0gaW50ZWxfZHAtPnRyYWluX3NldFswXTsKPiAgIAo+IC0JaWYgKElTX0dF
TjlfTFAoZGV2X3ByaXYpIHx8IElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTApIHsKPiArCWlmIChJ
U19HRU45X0xQKGk5MTUpIHx8IElOVEVMX0dFTihpOTE1KSA+PSAxMCkgewo+ICAgCQlzaWduYWxf
bGV2ZWxzID0gYnh0X3NpZ25hbF9sZXZlbHMoaW50ZWxfZHApOwo+IC0JfSBlbHNlIGlmIChIQVNf
RERJKGRldl9wcml2KSkgewo+ICsJfSBlbHNlIGlmIChIQVNfRERJKGk5MTUpKSB7Cj4gICAJCXNp
Z25hbF9sZXZlbHMgPSBkZGlfc2lnbmFsX2xldmVscyhpbnRlbF9kcCk7Cj4gICAJCW1hc2sgPSBE
RElfQlVGX0VNUF9NQVNLOwo+IC0JfSBlbHNlIGlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkg
ewo+ICsJfSBlbHNlIGlmIChJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gICAJCXNpZ25hbF9sZXZl
bHMgPSBjaHZfc2lnbmFsX2xldmVscyhpbnRlbF9kcCk7Cj4gLQl9IGVsc2UgaWYgKElTX1ZBTExF
WVZJRVcoZGV2X3ByaXYpKSB7Cj4gKwl9IGVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkpIHsK
PiAgIAkJc2lnbmFsX2xldmVscyA9IHZsdl9zaWduYWxfbGV2ZWxzKGludGVsX2RwKTsKPiAtCX0g
ZWxzZSBpZiAoSVNfSVZZQlJJREdFKGRldl9wcml2KSAmJiBwb3J0ID09IFBPUlRfQSkgewo+ICsJ
fSBlbHNlIGlmIChJU19JVllCUklER0UoaTkxNSkgJiYgcG9ydCA9PSBQT1JUX0EpIHsKPiAgIAkJ
c2lnbmFsX2xldmVscyA9IGl2Yl9jcHVfZWRwX3NpZ25hbF9sZXZlbHModHJhaW5fc2V0KTsKPiAg
IAkJbWFzayA9IEVEUF9MSU5LX1RSQUlOX1ZPTF9FTVBfTUFTS19JVkI7Cj4gLQl9IGVsc2UgaWYg
KElTX0dFTihkZXZfcHJpdiwgNikgJiYgcG9ydCA9PSBQT1JUX0EpIHsKPiArCX0gZWxzZSBpZiAo
SVNfR0VOKGk5MTUsIDYpICYmIHBvcnQgPT0gUE9SVF9BKSB7Cj4gICAJCXNpZ25hbF9sZXZlbHMg
PSBzbmJfY3B1X2VkcF9zaWduYWxfbGV2ZWxzKHRyYWluX3NldCk7Cj4gICAJCW1hc2sgPSBFRFBf
TElOS19UUkFJTl9WT0xfRU1QX01BU0tfU05COwo+ICAgCX0gZWxzZSB7Cj4gQEAgLTM5NDcsNyAr
Mzk0Nyw3IEBAIGludGVsX2RwX3Byb2dyYW1fbGlua190cmFpbmluZ19wYXR0ZXJuKHN0cnVjdCBp
bnRlbF9kcCAqaW50ZWxfZHAsCj4gICAJCQkJICAgICAgIHU4IGRwX3RyYWluX3BhdCkKPiAgIHsK
PiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCA9IGRwX3RvX2Rp
Z19wb3J0KGludGVsX2RwKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9Cj4gICAJCXRvX2k5MTUoaW50ZWxf
ZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOwo+ICAgCj4gICAJX2ludGVsX2RwX3NldF9saW5rX3Ry
YWluKGludGVsX2RwLCAmaW50ZWxfZHAtPkRQLCBkcF90cmFpbl9wYXQpOwo+IEBAIC0zOTU4LDEy
ICszOTU4LDEyIEBAIGludGVsX2RwX3Byb2dyYW1fbGlua190cmFpbmluZ19wYXR0ZXJuKHN0cnVj
dCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gICAKPiAgIHZvaWQgaW50ZWxfZHBfc2V0X2lkbGVfbGlu
a190cmFpbihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAgewo+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ICAgCXN0cnVj
dCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0ID0gZHBfdG9fZGlnX3BvcnQoaW50
ZWxfZHApOwo+ICAgCWVudW0gcG9ydCBwb3J0ID0gaW50ZWxfZGlnX3BvcnQtPmJhc2UucG9ydDsK
PiAgIAl1MzIgdmFsOwo+ICAgCj4gLQlpZiAoIUhBU19EREkoZGV2X3ByaXYpKQo+ICsJaWYgKCFI
QVNfRERJKGk5MTUpKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAl2YWwgPSBJOTE1X1JFQUQoRFBf
VFBfQ1RMKHBvcnQpKTsKPiBAQCAtMzk4MSw3ICszOTgxLDcgQEAgdm9pZCBpbnRlbF9kcF9zZXRf
aWRsZV9saW5rX3RyYWluKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICAJaWYgKHBvcnQg
PT0gUE9SVF9BKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdp
c3RlcigmZGV2X3ByaXYtPnVuY29yZSwgRFBfVFBfU1RBVFVTKHBvcnQpLAo+ICsJaWYgKGludGVs
X3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsIERQX1RQX1NUQVRVUyhwb3J0KSwKPiAg
IAkJCQkgICAgRFBfVFBfU1RBVFVTX0lETEVfRE9ORSwKPiAgIAkJCQkgICAgRFBfVFBfU1RBVFVT
X0lETEVfRE9ORSwKPiAgIAkJCQkgICAgMSkpCj4gQEAgLTM5OTIsNyArMzk5Miw3IEBAIHN0YXRp
YyB2b2lkCj4gICBpbnRlbF9kcF9saW5rX2Rvd24oc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsCj4gICAJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0
ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2Rw
ID0gZW5jX3RvX2ludGVsX2RwKCZlbmNvZGVyLT5iYXNlKTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YyA9IHRvX2ludGVsX2NydGMob2xkX2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gICAJ
ZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+IEBAIC00MDAzLDggKzQwMDMsOCBAQCBp
bnRlbF9kcF9saW5rX2Rvd24oc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAKPiAg
IAlEUk1fREVCVUdfS01TKCJcbiIpOwo+ICAgCj4gLQlpZiAoKElTX0lWWUJSSURHRShkZXZfcHJp
dikgJiYgcG9ydCA9PSBQT1JUX0EpIHx8Cj4gLQkgICAgKEhBU19QQ0hfQ1BUKGRldl9wcml2KSAm
JiBwb3J0ICE9IFBPUlRfQSkpIHsKPiArCWlmICgoSVNfSVZZQlJJREdFKGk5MTUpICYmIHBvcnQg
PT0gUE9SVF9BKSB8fAo+ICsJICAgIChIQVNfUENIX0NQVChpOTE1KSAmJiBwb3J0ICE9IFBPUlRf
QSkpIHsKPiAgIAkJRFAgJj0gfkRQX0xJTktfVFJBSU5fTUFTS19DUFQ7Cj4gICAJCURQIHw9IERQ
X0xJTktfVFJBSU5fUEFUX0lETEVfQ1BUOwo+ICAgCX0gZWxzZSB7Cj4gQEAgLTQwMjMsMTMgKzQw
MjMsMTMgQEAgaW50ZWxfZHBfbGlua19kb3duKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ICAgCSAqIHRvIHRyYW5zY29kZXIgQSBhZnRlciBkaXNhYmxpbmcgaXQgdG8gYWxsb3cgdGhl
Cj4gICAJICogbWF0Y2hpbmcgSERNSSBwb3J0IHRvIGJlIGVuYWJsZWQgb24gdHJhbnNjb2RlciBB
Lgo+ICAgCSAqLwo+IC0JaWYgKEhBU19QQ0hfSUJYKGRldl9wcml2KSAmJiBjcnRjLT5waXBlID09
IFBJUEVfQiAmJiBwb3J0ICE9IFBPUlRfQSkgewo+ICsJaWYgKEhBU19QQ0hfSUJYKGk5MTUpICYm
IGNydGMtPnBpcGUgPT0gUElQRV9CICYmIHBvcnQgIT0gUE9SVF9BKSB7Cj4gICAJCS8qCj4gICAJ
CSAqIFdlIGdldCBDUFUvUENIIEZJRk8gdW5kZXJydW5zIG9uIHRoZSBvdGhlciBwaXBlIHdoZW4K
PiAgIAkJICogZG9pbmcgdGhlIHdvcmthcm91bmQuIFN3ZWVwIHRoZW0gdW5kZXIgdGhlIHJ1Zy4K
PiAgIAkJICovCj4gLQkJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZf
cHJpdiwgUElQRV9BLCBmYWxzZSk7Cj4gLQkJaW50ZWxfc2V0X3BjaF9maWZvX3VuZGVycnVuX3Jl
cG9ydGluZyhkZXZfcHJpdiwgUElQRV9BLCBmYWxzZSk7Cj4gKwkJaW50ZWxfc2V0X2NwdV9maWZv
X3VuZGVycnVuX3JlcG9ydGluZyhpOTE1LCBQSVBFX0EsIGZhbHNlKTsKPiArCQlpbnRlbF9zZXRf
cGNoX2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGk5MTUsIFBJUEVfQSwgZmFsc2UpOwo+ICAgCj4g
ICAJCS8qIGFsd2F5cyBlbmFibGUgd2l0aCBwYXR0ZXJuIDEgKGFzIHBlciBzcGVjKSAqLwo+ICAg
CQlEUCAmPSB+KERQX1BJUEVfU0VMX01BU0sgfCBEUF9MSU5LX1RSQUlOX01BU0spOwo+IEBAIC00
MDQyLDE2ICs0MDQyLDE2IEBAIGludGVsX2RwX2xpbmtfZG93bihzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiAgIAkJSTkxNV9XUklURShpbnRlbF9kcC0+b3V0cHV0X3JlZywgRFApOwo+
ICAgCQlQT1NUSU5HX1JFQUQoaW50ZWxfZHAtPm91dHB1dF9yZWcpOwo+ICAgCj4gLQkJaW50ZWxf
d2FpdF9mb3JfdmJsYW5rX2lmX2FjdGl2ZShkZXZfcHJpdiwgUElQRV9BKTsKPiAtCQlpbnRlbF9z
ZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRldl9wcml2LCBQSVBFX0EsIHRydWUpOwo+
IC0JCWludGVsX3NldF9wY2hfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoZGV2X3ByaXYsIFBJUEVf
QSwgdHJ1ZSk7Cj4gKwkJaW50ZWxfd2FpdF9mb3JfdmJsYW5rX2lmX2FjdGl2ZShpOTE1LCBQSVBF
X0EpOwo+ICsJCWludGVsX3NldF9jcHVfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoaTkxNSwgUElQ
RV9BLCB0cnVlKTsKPiArCQlpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGk5
MTUsIFBJUEVfQSwgdHJ1ZSk7Cj4gICAJfQo+ICAgCj4gICAJbXNsZWVwKGludGVsX2RwLT5wYW5l
bF9wb3dlcl9kb3duX2RlbGF5KTsKPiAgIAo+ICAgCWludGVsX2RwLT5EUCA9IERQOwo+ICAgCj4g
LQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikp
IHsKPiArCWlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpIHsK
PiAgIAkJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gICAKPiAgIAkJd2l0aF9wcHNfbG9jayhp
bnRlbF9kcCwgd2FrZXJlZikKPiBAQCAtNDE1Niw3ICs0MTU2LDcgQEAgc3RhdGljIHZvaWQgaW50
ZWxfZHBfZ2V0X2RzY19zaW5rX2NhcChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAgc3Rh
dGljIGJvb2wKPiAgIGludGVsX2VkcF9pbml0X2RwY2Qoc3RydWN0IGludGVsX2RwICppbnRlbF9k
cCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9Cj4gICAJCXRvX2k5MTUoZHBfdG9fZGlnX3BvcnQo
aW50ZWxfZHApLT5iYXNlLmJhc2UuZGV2KTsKPiAgIAo+ICAgCS8qIHRoaXMgZnVuY3Rpb24gaXMg
bWVhbnQgdG8gYmUgY2FsbGVkIG9ubHkgb25jZSAqLwo+IEBAIC00MTY5LDcgKzQxNjksNyBAQCBp
bnRlbF9lZHBfaW5pdF9kcGNkKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICAJCQkgZHJt
X2RwX2lzX2JyYW5jaChpbnRlbF9kcC0+ZHBjZCkpOwo+ICAgCj4gICAJaWYgKGludGVsX2RwLT5k
cGNkW0RQX0RQQ0RfUkVWXSA+PSAweDExKQo+IC0JCWRldl9wcml2LT5ub19hdXhfaGFuZHNoYWtl
ID0gaW50ZWxfZHAtPmRwY2RbRFBfTUFYX0RPV05TUFJFQURdICYKPiArCQlpOTE1LT5ub19hdXhf
aGFuZHNoYWtlID0gaW50ZWxfZHAtPmRwY2RbRFBfTUFYX0RPV05TUFJFQURdICYKPiAgIAkJCURQ
X05PX0FVWF9IQU5EU0hBS0VfTElOS19UUkFJTklORzsKPiAgIAo+ICAgCS8qCj4gQEAgLTQyMzAs
NyArNDIzMCw3IEBAIGludGVsX2VkcF9pbml0X2RwY2Qoc3RydWN0IGludGVsX2RwICppbnRlbF9k
cCkKPiAgIAlpbnRlbF9kcF9zZXRfY29tbW9uX3JhdGVzKGludGVsX2RwKTsKPiAgIAo+ICAgCS8q
IFJlYWQgdGhlIGVEUCBEU0MgRFBDRCByZWdpc3RlcnMgKi8KPiAtCWlmIChJTlRFTF9HRU4oZGV2
X3ByaXYpID49IDEwIHx8IElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKQo+ICsJaWYgKElOVEVMX0dF
TihpOTE1KSA+PSAxMCB8fCBJU19HRU1JTklMQUtFKGk5MTUpKQo+ICAgCQlpbnRlbF9kcF9nZXRf
ZHNjX3NpbmtfY2FwKGludGVsX2RwKTsKPiAgIAo+ICAgCXJldHVybiB0cnVlOwo+IEBAIC00ODA0
LDcgKzQ4MDQsNyBAQCBpbnRlbF9kcF9uZWVkc19saW5rX3JldHJhaW4oc3RydWN0IGludGVsX2Rw
ICppbnRlbF9kcCkKPiAgIGludCBpbnRlbF9kcF9yZXRyYWluX2xpbmsoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmVuY29kZXIsCj4gICAJCQkgIHN0cnVjdCBkcm1fbW9kZXNldF9hY3F1aXJlX2N0eCAq
Y3R4KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxf
ZHAgPSBlbmNfdG9faW50ZWxfZHAoJmVuY29kZXItPmJhc2UpOwo+ICAgCXN0cnVjdCBpbnRlbF9j
b25uZWN0b3IgKmNvbm5lY3RvciA9IGludGVsX2RwLT5hdHRhY2hlZF9jb25uZWN0b3I7Cj4gICAJ
c3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGU7Cj4gQEAgLTQ4MTcsNyArNDgx
Nyw3IEBAIGludCBpbnRlbF9kcF9yZXRyYWluX2xpbmsoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCj4gICAJaWYgKCFjb25uZWN0b3IgfHwgY29ubmVjdG9yLT5iYXNlLnN0YXR1cyAhPSBj
b25uZWN0b3Jfc3RhdHVzX2Nvbm5lY3RlZCkKPiAgIAkJcmV0dXJuIDA7Cj4gICAKPiAtCXJldCA9
IGRybV9tb2Rlc2V0X2xvY2soJmRldl9wcml2LT5kcm0ubW9kZV9jb25maWcuY29ubmVjdGlvbl9t
dXRleCwKPiArCXJldCA9IGRybV9tb2Rlc2V0X2xvY2soJmk5MTUtPmRybS5tb2RlX2NvbmZpZy5j
b25uZWN0aW9uX211dGV4LAo+ICAgCQkJICAgICAgIGN0eCk7Cj4gICAJaWYgKHJldCkKPiAgIAkJ
cmV0dXJuIHJldDsKPiBAQCAtNDg0NywyMCArNDg0NywyMCBAQCBpbnQgaW50ZWxfZHBfcmV0cmFp
bl9saW5rKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQlyZXR1cm4gMDsKPiAg
IAo+ICAgCS8qIFN1cHByZXNzIHVuZGVycnVucyBjYXVzZWQgYnkgcmUtdHJhaW5pbmcgKi8KPiAt
CWludGVsX3NldF9jcHVfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoZGV2X3ByaXYsIGNydGMtPnBp
cGUsIGZhbHNlKTsKPiArCWludGVsX3NldF9jcHVfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoaTkx
NSwgY3J0Yy0+cGlwZSwgZmFsc2UpOwo+ICAgCWlmIChjcnRjX3N0YXRlLT5oYXNfcGNoX2VuY29k
ZXIpCj4gLQkJaW50ZWxfc2V0X3BjaF9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZfcHJpdiwK
PiArCQlpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGk5MTUsCj4gICAJCQkJ
CQkgICAgICBpbnRlbF9jcnRjX3BjaF90cmFuc2NvZGVyKGNydGMpLCBmYWxzZSk7Cj4gICAKPiAg
IAlpbnRlbF9kcF9zdGFydF9saW5rX3RyYWluKGludGVsX2RwKTsKPiAgIAlpbnRlbF9kcF9zdG9w
X2xpbmtfdHJhaW4oaW50ZWxfZHApOwo+ICAgCj4gICAJLyogS2VlcCB1bmRlcnJ1biByZXBvcnRp
bmcgZGlzYWJsZWQgdW50aWwgdGhpbmdzIGFyZSBzdGFibGUgKi8KPiAtCWludGVsX3dhaXRfZm9y
X3ZibGFuayhkZXZfcHJpdiwgY3J0Yy0+cGlwZSk7Cj4gKwlpbnRlbF93YWl0X2Zvcl92Ymxhbmso
aTkxNSwgY3J0Yy0+cGlwZSk7Cj4gICAKPiAtCWludGVsX3NldF9jcHVfZmlmb191bmRlcnJ1bl9y
ZXBvcnRpbmcoZGV2X3ByaXYsIGNydGMtPnBpcGUsIHRydWUpOwo+ICsJaW50ZWxfc2V0X2NwdV9m
aWZvX3VuZGVycnVuX3JlcG9ydGluZyhpOTE1LCBjcnRjLT5waXBlLCB0cnVlKTsKPiAgIAlpZiAo
Y3J0Y19zdGF0ZS0+aGFzX3BjaF9lbmNvZGVyKQo+IC0JCWludGVsX3NldF9wY2hfZmlmb191bmRl
cnJ1bl9yZXBvcnRpbmcoZGV2X3ByaXYsCj4gKwkJaW50ZWxfc2V0X3BjaF9maWZvX3VuZGVycnVu
X3JlcG9ydGluZyhpOTE1LAo+ICAgCQkJCQkJICAgICAgaW50ZWxfY3J0Y19wY2hfdHJhbnNjb2Rl
cihjcnRjKSwgdHJ1ZSk7Cj4gICAKPiAgIAlyZXR1cm4gMDsKPiBAQCAtNDk0Niw3ICs0OTQ2LDcg
QEAgc3RhdGljIHZvaWQgaW50ZWxfZHBfY2hlY2tfc2VydmljZV9pcnEoc3RydWN0IGludGVsX2Rw
ICppbnRlbF9kcCkKPiAgIHN0YXRpYyBib29sCj4gICBpbnRlbF9kcF9zaG9ydF9wdWxzZShzdHJ1
Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ICAgCXU4IG9sZF9zaW5rX2NvdW50
ID0gaW50ZWxfZHAtPnNpbmtfY291bnQ7Cj4gICAJYm9vbCByZXQ7Cj4gICAKPiBAQCAtNDk4Myw3
ICs0OTgzLDcgQEAgaW50ZWxfZHBfc2hvcnRfcHVsc2Uoc3RydWN0IGludGVsX2RwICppbnRlbF9k
cCkKPiAgIAlpZiAoaW50ZWxfZHAtPmNvbXBsaWFuY2UudGVzdF90eXBlID09IERQX1RFU1RfTElO
S19UUkFJTklORykgewo+ICAgCQlEUk1fREVCVUdfS01TKCJMaW5rIFRyYWluaW5nIENvbXBsaWFu
Y2UgVGVzdCByZXF1ZXN0ZWRcbiIpOwo+ICAgCQkvKiBTZW5kIGEgSG90cGx1ZyBVZXZlbnQgdG8g
dXNlcnNwYWNlIHRvIHN0YXJ0IG1vZGVzZXQgKi8KPiAtCQlkcm1fa21zX2hlbHBlcl9ob3RwbHVn
X2V2ZW50KCZkZXZfcHJpdi0+ZHJtKTsKPiArCQlkcm1fa21zX2hlbHBlcl9ob3RwbHVnX2V2ZW50
KCZpOTE1LT5kcm0pOwo+ICAgCX0KPiAgIAo+ICAgCXJldHVybiB0cnVlOwo+IEBAIC01MDUyLDcg
KzUwNTIsNyBAQCBlZHBfZGV0ZWN0KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICAKPiAg
IHN0YXRpYyBib29sIGlieF9kaWdpdGFsX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXUzMiBiaXQ7Cj4gICAK
PiAgIAlzd2l0Y2ggKGVuY29kZXItPmhwZF9waW4pIHsKPiBAQCAtNTA3NSw3ICs1MDc1LDcgQEAg
c3RhdGljIGJvb2wgaWJ4X2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIpCj4gICAKPiAgIHN0YXRpYyBib29sIGNwdF9kaWdpdGFsX3BvcnRfY29ubmVj
dGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ICAgewo+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYp
Owo+ICAgCXUzMiBiaXQ7Cj4gICAKPiAgIAlzd2l0Y2ggKGVuY29kZXItPmhwZF9waW4pIHsKPiBA
QCAtNTA5OCw3ICs1MDk4LDcgQEAgc3RhdGljIGJvb2wgY3B0X2RpZ2l0YWxfcG9ydF9jb25uZWN0
ZWQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICAKPiAgIHN0YXRpYyBib29sIHNw
dF9kaWdpdGFsX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+
ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNv
ZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXUzMiBiaXQ7Cj4gICAKPiAgIAlzd2l0Y2ggKGVu
Y29kZXItPmhwZF9waW4pIHsKPiBAQCAtNTExNyw3ICs1MTE3LDcgQEAgc3RhdGljIGJvb2wgc3B0
X2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4g
ICAKPiAgIHN0YXRpYyBib29sIGc0eF9kaWdpdGFsX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXUzMiBiaXQ7
Cj4gICAKPiAgIAlzd2l0Y2ggKGVuY29kZXItPmhwZF9waW4pIHsKPiBAQCAtNTE0MCw3ICs1MTQw
LDcgQEAgc3RhdGljIGJvb2wgZzR4X2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIpCj4gICAKPiAgIHN0YXRpYyBib29sIGdtNDVfZGlnaXRhbF9wb3J0
X2Nvbm5lY3RlZChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIHsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiAgIAl1MzIgYml0Owo+ICAgCj4gICAJc3dpdGNoIChlbmNvZGVyLT5ocGRfcGlu
KSB7Cj4gQEAgLTUxNjMsNyArNTE2Myw3IEBAIHN0YXRpYyBib29sIGdtNDVfZGlnaXRhbF9wb3J0
X2Nvbm5lY3RlZChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIAo+ICAgc3RhdGlj
IGJvb2wgaWxrX2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAKPiAgIAlpZiAoZW5jb2Rlci0+aHBk
X3BpbiA9PSBIUERfUE9SVF9BKQo+ICAgCQlyZXR1cm4gSTkxNV9SRUFEKERFSVNSKSAmIERFX0RQ
X0FfSE9UUExVRzsKPiBAQCAtNTE3Myw3ICs1MTczLDcgQEAgc3RhdGljIGJvb2wgaWxrX2RpZ2l0
YWxfcG9ydF9jb25uZWN0ZWQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICAKPiAg
IHN0YXRpYyBib29sIHNuYl9kaWdpdGFsX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCj4gICAJaWYgKGVuY29k
ZXItPmhwZF9waW4gPT0gSFBEX1BPUlRfQSkKPiAgIAkJcmV0dXJuIEk5MTVfUkVBRChERUlTUikg
JiBERV9EUF9BX0hPVFBMVUc7Cj4gQEAgLTUxODMsNyArNTE4Myw3IEBAIHN0YXRpYyBib29sIHNu
Yl9kaWdpdGFsX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+
ICAgCj4gICBzdGF0aWMgYm9vbCBpdmJfZGlnaXRhbF9wb3J0X2Nvbm5lY3RlZChzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAo+ICAgCWlm
IChlbmNvZGVyLT5ocGRfcGluID09IEhQRF9QT1JUX0EpCj4gICAJCXJldHVybiBJOTE1X1JFQUQo
REVJU1IpICYgREVfRFBfQV9IT1RQTFVHX0lWQjsKPiBAQCAtNTE5Myw3ICs1MTkzLDcgQEAgc3Rh
dGljIGJvb2wgaXZiX2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIpCj4gICAKPiAgIHN0YXRpYyBib29sIGJkd19kaWdpdGFsX3BvcnRfY29ubmVjdGVk
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+
ICAgCj4gICAJaWYgKGVuY29kZXItPmhwZF9waW4gPT0gSFBEX1BPUlRfQSkKPiAgIAkJcmV0dXJu
IEk5MTVfUkVBRChHRU44X0RFX1BPUlRfSVNSKSAmIEdFTjhfUE9SVF9EUF9BX0hPVFBMVUc7Cj4g
QEAgLTUyMDMsNyArNTIwMyw3IEBAIHN0YXRpYyBib29sIGJkd19kaWdpdGFsX3BvcnRfY29ubmVj
dGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ICAgCj4gICBzdGF0aWMgYm9vbCBi
eHRfZGlnaXRhbF9wb3J0X2Nvbm5lY3RlZChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikK
PiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5j
b2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAl1MzIgYml0Owo+ICAgCj4gICAJc3dpdGNoIChl
bmNvZGVyLT5ocGRfcGluKSB7Cj4gQEAgLTUyMjQsNyArNTIyNCw3IEBAIHN0YXRpYyBib29sIGJ4
dF9kaWdpdGFsX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+
ICAgCXJldHVybiBJOTE1X1JFQUQoR0VOOF9ERV9QT1JUX0lTUikgJiBiaXQ7Cj4gICB9Cj4gICAK
PiAtc3RhdGljIGJvb2wgaWNsX2NvbWJvX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIGJvb2wgaWNsX2NvbWJvX3BvcnRfY29ubmVjdGVk
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgICAgc3RydWN0IGludGVs
X2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQpCj4gICB7Cj4gICAJZW51bSBwb3J0IHBvcnQg
PSBpbnRlbF9kaWdfcG9ydC0+YmFzZS5wb3J0Owo+IEBAIC01MjQ3LDcgKzUyNDcsNyBAQCBzdGF0
aWMgY29uc3QgY2hhciAqdGNfdHlwZV9uYW1lKGVudW0gdGNfcG9ydF90eXBlIHR5cGUpCj4gICAJ
cmV0dXJuIG5hbWVzW3R5cGVdOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGljbF91cGRhdGVf
dGNfcG9ydF90eXBlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGlj
IHZvaWQgaWNsX3VwZGF0ZV90Y19wb3J0X3R5cGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gICAJCQkJICAgIHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0
LAo+ICAgCQkJCSAgICBib29sIGlzX2xlZ2FjeSwgYm9vbCBpc190eXBlYywgYm9vbCBpc190YnQp
Cj4gICB7Cj4gQEAgLTUyOTUsMTAgKzUyOTUsMTAgQEAgc3RhdGljIHZvaWQgaWNsX3VwZGF0ZV90
Y19wb3J0X3R5cGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgICogd2ls
bCByZXF1aXJlIGEgbG90IG9mIGNvb3JkaW5hdGlvbiB3aXRoIHVzZXIgc3BhY2UgYW5kIHRob3Jv
dWdoIHRlc3RpbmcgZm9yCj4gICAgKiB0aGUgZXh0cmEgcG9zc2libGUgY2FzZXMuCj4gICAgKi8K
PiAtc3RhdGljIGJvb2wgaWNsX3RjX3BoeV9jb25uZWN0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiArc3RhdGljIGJvb2wgaWNsX3RjX3BoeV9jb25uZWN0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgICAgIHN0cnVjdCBpbnRlbF9kaWdpdGFsX3Bv
cnQgKmRpZ19wb3J0KQo+ICAgewo+IC0JZW51bSB0Y19wb3J0IHRjX3BvcnQgPSBpbnRlbF9wb3J0
X3RvX3RjKGRldl9wcml2LCBkaWdfcG9ydC0+YmFzZS5wb3J0KTsKPiArCWVudW0gdGNfcG9ydCB0
Y19wb3J0ID0gaW50ZWxfcG9ydF90b190YyhpOTE1LCBkaWdfcG9ydC0+YmFzZS5wb3J0KTsKPiAg
IAl1MzIgdmFsOwo+ICAgCj4gICAJaWYgKGRpZ19wb3J0LT50Y190eXBlICE9IFRDX1BPUlRfTEVH
QUNZICYmCj4gQEAgLTUzMjksNyArNTMyOSw3IEBAIHN0YXRpYyBib29sIGljbF90Y19waHlfY29u
bmVjdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJaWYgKGRpZ19wb3J0
LT50Y190eXBlID09IFRDX1BPUlRfVFlQRUMgJiYKPiAgIAkgICAgIShJOTE1X1JFQUQoUE9SVF9U
WF9ERkxFWERQU1ApICYgVENfTElWRV9TVEFURV9UQyh0Y19wb3J0KSkpIHsKPiAgIAkJRFJNX0RF
QlVHX0tNUygiVEMgUEhZICVkIHN1ZGRlbiBkaXNjb25uZWN0LlxuIiwgdGNfcG9ydCk7Cj4gLQkJ
aWNsX3RjX3BoeV9kaXNjb25uZWN0KGRldl9wcml2LCBkaWdfcG9ydCk7Cj4gKwkJaWNsX3RjX3Bo
eV9kaXNjb25uZWN0KGk5MTUsIGRpZ19wb3J0KTsKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAgCX0K
PiAgIAo+IEBAIC01MzQwLDEwICs1MzQwLDEwIEBAIHN0YXRpYyBib29sIGljbF90Y19waHlfY29u
bmVjdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAgKiBTZWUgdGhlIGNv
bW1lbnQgYXQgdGhlIGNvbm5lY3QgZnVuY3Rpb24uIFRoaXMgaW1wbGVtZW50cyB0aGUgRGlzY29u
bmVjdAo+ICAgICogRmxvdy4KPiAgICAqLwo+IC12b2lkIGljbF90Y19waHlfZGlzY29ubmVjdChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3ZvaWQgaWNsX3RjX3BoeV9kaXNj
b25uZWN0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgc3RydWN0IGlu
dGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQpCj4gICB7Cj4gLQllbnVtIHRjX3BvcnQgdGNfcG9y
dCA9IGludGVsX3BvcnRfdG9fdGMoZGV2X3ByaXYsIGRpZ19wb3J0LT5iYXNlLnBvcnQpOwo+ICsJ
ZW51bSB0Y19wb3J0IHRjX3BvcnQgPSBpbnRlbF9wb3J0X3RvX3RjKGk5MTUsIGRpZ19wb3J0LT5i
YXNlLnBvcnQpOwo+ICAgCj4gICAJaWYgKGRpZ19wb3J0LT50Y190eXBlID09IFRDX1BPUlRfVU5L
Tk9XTikKPiAgIAkJcmV0dXJuOwo+IEBAIC01Mzc4LDExICs1Mzc4LDExIEBAIHZvaWQgaWNsX3Rj
X3BoeV9kaXNjb25uZWN0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgICAq
IGNvbm5lY3RlZCBwb3J0cyBhcmUgdXNhYmxlLCBhbmQgYXZvaWRzIGV4cG9zaW5nIHRvIHRoZSB1
c2VycyBvYmplY3RzIHRoZXkKPiAgICAqIGNhbid0IHJlYWxseSB1c2UuCj4gICAgKi8KPiAtc3Rh
dGljIGJvb2wgaWNsX3RjX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiArc3RhdGljIGJvb2wgaWNsX3RjX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAq
aW50ZWxfZGlnX3BvcnQpCj4gICB7Cj4gICAJZW51bSBwb3J0IHBvcnQgPSBpbnRlbF9kaWdfcG9y
dC0+YmFzZS5wb3J0Owo+IC0JZW51bSB0Y19wb3J0IHRjX3BvcnQgPSBpbnRlbF9wb3J0X3RvX3Rj
KGRldl9wcml2LCBwb3J0KTsKPiArCWVudW0gdGNfcG9ydCB0Y19wb3J0ID0gaW50ZWxfcG9ydF90
b190YyhpOTE1LCBwb3J0KTsKPiAgIAlib29sIGlzX2xlZ2FjeSwgaXNfdHlwZWMsIGlzX3RidDsK
PiAgIAl1MzIgZHBzcDsKPiAgIAo+IEBAIC01NDA3LDE1ICs1NDA3LDE1IEBAIHN0YXRpYyBib29s
IGljbF90Y19wb3J0X2Nvbm5lY3RlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gICAJaXNfdGJ0ID0gZHBzcCAmIFRDX0xJVkVfU1RBVEVfVEJUKHRjX3BvcnQpOwo+ICAgCj4g
ICAJaWYgKCFpc19sZWdhY3kgJiYgIWlzX3R5cGVjICYmICFpc190YnQpIHsKPiAtCQlpY2xfdGNf
cGh5X2Rpc2Nvbm5lY3QoZGV2X3ByaXYsIGludGVsX2RpZ19wb3J0KTsKPiArCQlpY2xfdGNfcGh5
X2Rpc2Nvbm5lY3QoaTkxNSwgaW50ZWxfZGlnX3BvcnQpOwo+ICAgCj4gICAJCXJldHVybiBmYWxz
ZTsKPiAgIAl9Cj4gICAKPiAtCWljbF91cGRhdGVfdGNfcG9ydF90eXBlKGRldl9wcml2LCBpbnRl
bF9kaWdfcG9ydCwgaXNfbGVnYWN5LCBpc190eXBlYywKPiArCWljbF91cGRhdGVfdGNfcG9ydF90
eXBlKGk5MTUsIGludGVsX2RpZ19wb3J0LCBpc19sZWdhY3ksIGlzX3R5cGVjLAo+ICAgCQkJCWlz
X3RidCk7Cj4gICAKPiAtCWlmICghaWNsX3RjX3BoeV9jb25uZWN0KGRldl9wcml2LCBpbnRlbF9k
aWdfcG9ydCkpCj4gKwlpZiAoIWljbF90Y19waHlfY29ubmVjdChpOTE1LCBpbnRlbF9kaWdfcG9y
dCkpCj4gICAJCXJldHVybiBmYWxzZTsKPiAgIAo+ICAgCXJldHVybiB0cnVlOwo+IEBAIC01NDIz
LDEzICs1NDIzLDEzIEBAIHN0YXRpYyBib29sIGljbF90Y19wb3J0X2Nvbm5lY3RlZChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAKPiAgIHN0YXRpYyBib29sIGljbF9kaWdp
dGFsX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ICAgewo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5i
YXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5j
b2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0
ID0gZW5jX3RvX2RpZ19wb3J0KCZlbmNvZGVyLT5iYXNlKTsKPiAgIAo+IC0JaWYgKGludGVsX3Bv
cnRfaXNfY29tYm9waHkoZGV2X3ByaXYsIGVuY29kZXItPnBvcnQpKQo+IC0JCXJldHVybiBpY2xf
Y29tYm9fcG9ydF9jb25uZWN0ZWQoZGV2X3ByaXYsIGRpZ19wb3J0KTsKPiAtCWVsc2UgaWYgKGlu
dGVsX3BvcnRfaXNfdGMoZGV2X3ByaXYsIGVuY29kZXItPnBvcnQpKQo+IC0JCXJldHVybiBpY2xf
dGNfcG9ydF9jb25uZWN0ZWQoZGV2X3ByaXYsIGRpZ19wb3J0KTsKPiArCWlmIChpbnRlbF9wb3J0
X2lzX2NvbWJvcGh5KGk5MTUsIGVuY29kZXItPnBvcnQpKQo+ICsJCXJldHVybiBpY2xfY29tYm9f
cG9ydF9jb25uZWN0ZWQoaTkxNSwgZGlnX3BvcnQpOwo+ICsJZWxzZSBpZiAoaW50ZWxfcG9ydF9p
c190YyhpOTE1LCBlbmNvZGVyLT5wb3J0KSkKPiArCQlyZXR1cm4gaWNsX3RjX3BvcnRfY29ubmVj
dGVkKGk5MTUsIGRpZ19wb3J0KTsKPiAgIAllbHNlCj4gICAJCU1JU1NJTkdfQ0FTRShlbmNvZGVy
LT5ocGRfcGluKTsKPiAgIAo+IEBAIC01NDQ5LDQxICs1NDQ5LDQxIEBAIHN0YXRpYyBib29sIGlj
bF9kaWdpdGFsX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+
ICAgICovCj4gICBzdGF0aWMgYm9vbCBfX2ludGVsX2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAK
PiAtCWlmIChIQVNfR01DSChkZXZfcHJpdikpIHsKPiAtCQlpZiAoSVNfR000NShkZXZfcHJpdikp
Cj4gKwlpZiAoSEFTX0dNQ0goaTkxNSkpIHsKPiArCQlpZiAoSVNfR000NShpOTE1KSkKPiAgIAkJ
CXJldHVybiBnbTQ1X2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQoZW5jb2Rlcik7Cj4gICAJCWVsc2UK
PiAgIAkJCXJldHVybiBnNHhfZGlnaXRhbF9wb3J0X2Nvbm5lY3RlZChlbmNvZGVyKTsKPiAgIAl9
Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQo+ICsJaWYgKElOVEVMX0dF
TihpOTE1KSA+PSAxMSkKPiAgIAkJcmV0dXJuIGljbF9kaWdpdGFsX3BvcnRfY29ubmVjdGVkKGVu
Y29kZXIpOwo+IC0JZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCAxMCkgfHwgSVNfR0VOOV9CQyhk
ZXZfcHJpdikpCj4gKwllbHNlIGlmIChJU19HRU4oaTkxNSwgMTApIHx8IElTX0dFTjlfQkMoaTkx
NSkpCj4gICAJCXJldHVybiBzcHRfZGlnaXRhbF9wb3J0X2Nvbm5lY3RlZChlbmNvZGVyKTsKPiAt
CWVsc2UgaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAoSVNfR0VOOV9MUChp
OTE1KSkKPiAgIAkJcmV0dXJuIGJ4dF9kaWdpdGFsX3BvcnRfY29ubmVjdGVkKGVuY29kZXIpOwo+
IC0JZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCA4KSkKPiArCWVsc2UgaWYgKElTX0dFTihpOTE1
LCA4KSkKPiAgIAkJcmV0dXJuIGJkd19kaWdpdGFsX3BvcnRfY29ubmVjdGVkKGVuY29kZXIpOwo+
IC0JZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCA3KSkKPiArCWVsc2UgaWYgKElTX0dFTihpOTE1
LCA3KSkKPiAgIAkJcmV0dXJuIGl2Yl9kaWdpdGFsX3BvcnRfY29ubmVjdGVkKGVuY29kZXIpOwo+
IC0JZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCA2KSkKPiArCWVsc2UgaWYgKElTX0dFTihpOTE1
LCA2KSkKPiAgIAkJcmV0dXJuIHNuYl9kaWdpdGFsX3BvcnRfY29ubmVjdGVkKGVuY29kZXIpOwo+
IC0JZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCA1KSkKPiArCWVsc2UgaWYgKElTX0dFTihpOTE1
LCA1KSkKPiAgIAkJcmV0dXJuIGlsa19kaWdpdGFsX3BvcnRfY29ubmVjdGVkKGVuY29kZXIpOwo+
ICAgCj4gLQlNSVNTSU5HX0NBU0UoSU5URUxfR0VOKGRldl9wcml2KSk7Cj4gKwlNSVNTSU5HX0NB
U0UoSU5URUxfR0VOKGk5MTUpKTsKPiAgIAlyZXR1cm4gZmFsc2U7Cj4gICB9Cj4gICAKPiAgIGJv
b2wgaW50ZWxfZGlnaXRhbF9wb3J0X2Nvbm5lY3RlZChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlcikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlib29sIGlzX2Nvbm5lY3RlZCA9IGZh
bHNlOwo+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICAgCj4gLQl3aXRoX2ludGVsX2Rp
c3BsYXlfcG93ZXIoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9ESVNQTEFZX0NPUkUsIHdha2VyZWYp
Cj4gKwl3aXRoX2ludGVsX2Rpc3BsYXlfcG93ZXIoaTkxNSwgUE9XRVJfRE9NQUlOX0RJU1BMQVlf
Q09SRSwgd2FrZXJlZikKPiAgIAkJaXNfY29ubmVjdGVkID0gX19pbnRlbF9kaWdpdGFsX3BvcnRf
Y29ubmVjdGVkKGVuY29kZXIpOwo+ICAgCj4gICAJcmV0dXJuIGlzX2Nvbm5lY3RlZDsKPiBAQCAt
NTUzNyw3ICs1NTM3LDcgQEAgaW50ZWxfZHBfZGV0ZWN0KHN0cnVjdCBkcm1fY29ubmVjdG9yICpj
b25uZWN0b3IsCj4gICAJCXN0cnVjdCBkcm1fbW9kZXNldF9hY3F1aXJlX2N0eCAqY3R4LAo+ICAg
CQlib29sIGZvcmNlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShjb25uZWN0b3ItPmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9kcCAqaW50
ZWxfZHAgPSBpbnRlbF9hdHRhY2hlZF9kcChjb25uZWN0b3IpOwo+ICAgCXN0cnVjdCBpbnRlbF9k
aWdpdGFsX3BvcnQgKmRpZ19wb3J0ID0gZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApOwo+ICAgCXN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyID0gJmRpZ19wb3J0LT5iYXNlOwo+IEBAIC01NTQ1
LDcgKzU1NDUsNyBAQCBpbnRlbF9kcF9kZXRlY3Qoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5l
Y3RvciwKPiAgIAo+ICAgCURSTV9ERUJVR19LTVMoIltDT05ORUNUT1I6JWQ6JXNdXG4iLAo+ICAg
CQkgICAgICBjb25uZWN0b3ItPmJhc2UuaWQsIGNvbm5lY3Rvci0+bmFtZSk7Cj4gLQlXQVJOX09O
KCFkcm1fbW9kZXNldF9pc19sb2NrZWQoJmRldl9wcml2LT5kcm0ubW9kZV9jb25maWcuY29ubmVj
dGlvbl9tdXRleCkpOwo+ICsJV0FSTl9PTighZHJtX21vZGVzZXRfaXNfbG9ja2VkKCZpOTE1LT5k
cm0ubW9kZV9jb25maWcuY29ubmVjdGlvbl9tdXRleCkpOwo+ICAgCj4gICAJLyogQ2FuJ3QgZGlz
Y29ubmVjdCBlRFAgKi8KPiAgIAlpZiAoaW50ZWxfZHBfaXNfZWRwKGludGVsX2RwKSkKPiBAQCAt
NTU4NCw3ICs1NTg0LDcgQEAgaW50ZWxfZHBfZGV0ZWN0KHN0cnVjdCBkcm1fY29ubmVjdG9yICpj
b25uZWN0b3IsCj4gICAJaW50ZWxfZHBfcHJpbnRfcmF0ZXMoaW50ZWxfZHApOwo+ICAgCj4gICAJ
LyogUmVhZCBEUCBTaW5rIERTQyBDYXAgRFBDRCByZWdzIGZvciBEUCB2MS40ICovCj4gLQlpZiAo
SU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEp
Cj4gICAJCWludGVsX2RwX2dldF9kc2Nfc2lua19jYXAoaW50ZWxfZHApOwo+ICAgCj4gICAJZHJt
X2RwX3JlYWRfZGVzYygmaW50ZWxfZHAtPmF1eCwgJmludGVsX2RwLT5kZXNjLAo+IEBAIC01NjQy
LDcgKzU2NDIsNyBAQCBpbnRlbF9kcF9mb3JjZShzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVj
dG9yKQo+ICAgCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSBpbnRlbF9hdHRhY2hlZF9kcChj
b25uZWN0b3IpOwo+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0ID0gZHBf
dG9fZGlnX3BvcnQoaW50ZWxfZHApOwo+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICppbnRlbF9l
bmNvZGVyID0gJmRpZ19wb3J0LT5iYXNlOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShpbnRlbF9lbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoaW50ZWxfZW5jb2Rlci0+YmFzZS5kZXYpOwo+
ICAgCWVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gYXV4X2RvbWFpbiA9Cj4gICAJCWlu
dGVsX2F1eF9wb3dlcl9kb21haW4oZGlnX3BvcnQpOwo+ICAgCWludGVsX3dha2VyZWZfdCB3YWtl
cmVmOwo+IEBAIC01NjU0LDExICs1NjU0LDExIEBAIGludGVsX2RwX2ZvcmNlKHN0cnVjdCBkcm1f
Y29ubmVjdG9yICpjb25uZWN0b3IpCj4gICAJaWYgKGNvbm5lY3Rvci0+c3RhdHVzICE9IGNvbm5l
Y3Rvcl9zdGF0dXNfY29ubmVjdGVkKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCXdha2VyZWYgPSBp
bnRlbF9kaXNwbGF5X3Bvd2VyX2dldChkZXZfcHJpdiwgYXV4X2RvbWFpbik7Cj4gKwl3YWtlcmVm
ID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoaTkxNSwgYXV4X2RvbWFpbik7Cj4gICAKPiAgIAlp
bnRlbF9kcF9zZXRfZWRpZChpbnRlbF9kcCk7Cj4gICAKPiAtCWludGVsX2Rpc3BsYXlfcG93ZXJf
cHV0KGRldl9wcml2LCBhdXhfZG9tYWluLCB3YWtlcmVmKTsKPiArCWludGVsX2Rpc3BsYXlfcG93
ZXJfcHV0KGk5MTUsIGF1eF9kb21haW4sIHdha2VyZWYpOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMg
aW50IGludGVsX2RwX2dldF9tb2RlcyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+
IEBAIC02MzYyLDEwICs2MzYyLDEwIEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaW50ZWxfaGRjcF9z
aGltIGludGVsX2RwX2hkY3Bfc2hpbSA9IHsKPiAgIAo+ICAgc3RhdGljIHZvaWQgaW50ZWxfZWRw
X3BhbmVsX3ZkZF9zYW5pdGl6ZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAgewo+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxfZHAp
Owo+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0ID0gZHBfdG9fZGlnX3Bv
cnQoaW50ZWxfZHApOwo+ICAgCj4gLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+cHBz
X211dGV4KTsKPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPnBwc19tdXRleCk7Cj4gICAK
PiAgIAlpZiAoIWVkcF9oYXZlX3BhbmVsX3ZkZChpbnRlbF9kcCkpCj4gICAJCXJldHVybjsKPiBA
QCAtNjM3NywxOCArNjM3NywxOCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9lZHBfcGFuZWxfdmRkX3Nh
bml0aXplKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICAJICogaW5kZWZpbml0ZWx5Lgo+
ICAgCSAqLwo+ICAgCURSTV9ERUJVR19LTVMoIlZERCBsZWZ0IG9uIGJ5IEJJT1MsIGFkanVzdGlu
ZyBzdGF0ZSB0cmFja2luZ1xuIik7Cj4gLQlpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChkZXZfcHJp
diwgaW50ZWxfYXV4X3Bvd2VyX2RvbWFpbihkaWdfcG9ydCkpOwo+ICsJaW50ZWxfZGlzcGxheV9w
b3dlcl9nZXQoaTkxNSwgaW50ZWxfYXV4X3Bvd2VyX2RvbWFpbihkaWdfcG9ydCkpOwo+ICAgCj4g
ICAJZWRwX3BhbmVsX3ZkZF9zY2hlZHVsZV9vZmYoaW50ZWxfZHApOwo+ICAgfQo+ICAgCj4gICBz
dGF0aWMgZW51bSBwaXBlIHZsdl9hY3RpdmVfcGlwZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2Rw
KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkx
NShpbnRlbF9kcCk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5
MTUoaW50ZWxfZHApOwo+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyID0gJmRwX3Rv
X2RpZ19wb3J0KGludGVsX2RwKS0+YmFzZTsKPiAgIAllbnVtIHBpcGUgcGlwZTsKPiAgIAo+IC0J
aWYgKGludGVsX2RwX3BvcnRfZW5hYmxlZChkZXZfcHJpdiwgaW50ZWxfZHAtPm91dHB1dF9yZWcs
Cj4gKwlpZiAoaW50ZWxfZHBfcG9ydF9lbmFibGVkKGk5MTUsIGludGVsX2RwLT5vdXRwdXRfcmVn
LAo+ICAgCQkJCSAgZW5jb2Rlci0+cG9ydCwgJnBpcGUpKQo+ICAgCQlyZXR1cm4gcGlwZTsKPiAg
IAo+IEBAIC02Mzk3LDEyICs2Mzk3LDEyIEBAIHN0YXRpYyBlbnVtIHBpcGUgdmx2X2FjdGl2ZV9w
aXBlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICAKPiAgIHZvaWQgaW50ZWxfZHBfZW5j
b2Rlcl9yZXNldChzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIpCj4gICB7Cj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmRldik7Cj4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+ZGV2KTsKPiAg
IAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gZW5jX3RvX2ludGVsX2RwKGVuY29kZXIpOwo+
ICAgCXN0cnVjdCBpbnRlbF9sc3Bjb24gKmxzcGNvbiA9IGRwX3RvX2xzcGNvbihpbnRlbF9kcCk7
Cj4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gICAKPiAtCWlmICghSEFTX0RESShkZXZf
cHJpdikpCj4gKwlpZiAoIUhBU19EREkoaTkxNSkpCj4gICAJCWludGVsX2RwLT5EUCA9IEk5MTVf
UkVBRChpbnRlbF9kcC0+b3V0cHV0X3JlZyk7Cj4gICAKPiAgIAlpZiAobHNwY29uLT5hY3RpdmUp
Cj4gQEAgLTY0MTAsMTIgKzY0MTAsMTIgQEAgdm9pZCBpbnRlbF9kcF9lbmNvZGVyX3Jlc2V0KHN0
cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcikKPiAgIAo+ICAgCWludGVsX2RwLT5yZXNldF9saW5r
X3BhcmFtcyA9IHRydWU7Cj4gICAKPiAtCWlmICghSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgJiYg
IUlTX0NIRVJSWVZJRVcoZGV2X3ByaXYpICYmCj4gKwlpZiAoIUlTX1ZBTExFWVZJRVcoaTkxNSkg
JiYgIUlTX0NIRVJSWVZJRVcoaTkxNSkgJiYKPiAgIAkgICAgIWludGVsX2RwX2lzX2VkcChpbnRl
bF9kcCkpCj4gICAJCXJldHVybjsKPiAgIAo+ICAgCXdpdGhfcHBzX2xvY2soaW50ZWxfZHAsIHdh
a2VyZWYpIHsKPiAtCQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklF
VyhkZXZfcHJpdikpCj4gKwkJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklF
VyhpOTE1KSkKPiAgIAkJCWludGVsX2RwLT5hY3RpdmVfcGlwZSA9IHZsdl9hY3RpdmVfcGlwZShp
bnRlbF9kcCk7Cj4gICAKPiAgIAkJaWYgKGludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkpIHsKPiBA
QCAtNjUwOCw0MSArNjUwOCw0MSBAQCBpbnRlbF9kcF9ocGRfcHVsc2Uoc3RydWN0IGludGVsX2Rp
Z2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsIGJvb2wgbG9uZ19ocGQpCj4gICB9Cj4gICAKPiAg
IC8qIGNoZWNrIHRoZSBWQlQgdG8gc2VlIHdoZXRoZXIgdGhlIGVEUCBpcyBvbiBhbm90aGVyIHBv
cnQgKi8KPiAtYm9vbCBpbnRlbF9kcF9pc19wb3J0X2VkcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsIGVudW0gcG9ydCBwb3J0KQo+ICtib29sIGludGVsX2RwX2lzX3BvcnRfZWRw
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBvcnQgcG9ydCkKPiAgIHsKPiAg
IAkvKgo+ICAgCSAqIGVEUCBub3Qgc3VwcG9ydGVkIG9uIGc0eC4gc28gYmFpbCBvdXQgZWFybHkg
anVzdAo+ICAgCSAqIGZvciBhIGJpdCBleHRyYSBzYWZldHkgaW4gY2FzZSB0aGUgVkJUIGlzIGJv
bmtlcnMuCj4gICAJICovCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDUpCj4gKwlpZiAo
SU5URUxfR0VOKGk5MTUpIDwgNSkKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAgCj4gLQlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA8IDkgJiYgcG9ydCA9PSBQT1JUX0EpCj4gKwlpZiAoSU5URUxfR0VO
KGk5MTUpIDwgOSAmJiBwb3J0ID09IFBPUlRfQSkKPiAgIAkJcmV0dXJuIHRydWU7Cj4gICAKPiAt
CXJldHVybiBpbnRlbF9iaW9zX2lzX3BvcnRfZWRwKGRldl9wcml2LCBwb3J0KTsKPiArCXJldHVy
biBpbnRlbF9iaW9zX2lzX3BvcnRfZWRwKGk5MTUsIHBvcnQpOwo+ICAgfQo+ICAgCj4gICBzdGF0
aWMgdm9pZAo+ICAgaW50ZWxfZHBfYWRkX3Byb3BlcnRpZXMoc3RydWN0IGludGVsX2RwICppbnRl
bF9kcCwgc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIHsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOwo+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsK
PiAgIAllbnVtIHBvcnQgcG9ydCA9IGRwX3RvX2RpZ19wb3J0KGludGVsX2RwKS0+YmFzZS5wb3J0
Owo+ICAgCj4gLQlpZiAoIUlTX0c0WChkZXZfcHJpdikgJiYgcG9ydCAhPSBQT1JUX0EpCj4gKwlp
ZiAoIUlTX0c0WChpOTE1KSAmJiBwb3J0ICE9IFBPUlRfQSkKPiAgIAkJaW50ZWxfYXR0YWNoX2Zv
cmNlX2F1ZGlvX3Byb3BlcnR5KGNvbm5lY3Rvcik7Cj4gICAKPiAgIAlpbnRlbF9hdHRhY2hfYnJv
YWRjYXN0X3JnYl9wcm9wZXJ0eShjb25uZWN0b3IpOwo+IC0JaWYgKEhBU19HTUNIKGRldl9wcml2
KSkKPiArCWlmIChIQVNfR01DSChpOTE1KSkKPiAgIAkJZHJtX2Nvbm5lY3Rvcl9hdHRhY2hfbWF4
X2JwY19wcm9wZXJ0eShjb25uZWN0b3IsIDYsIDEwKTsKPiAtCWVsc2UgaWYgKElOVEVMX0dFTihk
ZXZfcHJpdikgPj0gNSkKPiArCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA1KQo+ICAgCQlk
cm1fY29ubmVjdG9yX2F0dGFjaF9tYXhfYnBjX3Byb3BlcnR5KGNvbm5lY3RvciwgNiwgMTIpOwo+
ICAgCj4gICAJaWYgKGludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkpIHsKPiAgIAkJdTMyIGFsbG93
ZWRfc2NhbGVyczsKPiAgIAo+ICAgCQlhbGxvd2VkX3NjYWxlcnMgPSBCSVQoRFJNX01PREVfU0NB
TEVfQVNQRUNUKSB8IEJJVChEUk1fTU9ERV9TQ0FMRV9GVUxMU0NSRUVOKTsKPiAtCQlpZiAoIUhB
U19HTUNIKGRldl9wcml2KSkKPiArCQlpZiAoIUhBU19HTUNIKGk5MTUpKQo+ICAgCQkJYWxsb3dl
ZF9zY2FsZXJzIHw9IEJJVChEUk1fTU9ERV9TQ0FMRV9DRU5URVIpOwo+ICAgCj4gICAJCWRybV9j
b25uZWN0b3JfYXR0YWNoX3NjYWxpbmdfbW9kZV9wcm9wZXJ0eShjb25uZWN0b3IsIGFsbG93ZWRf
c2NhbGVycyk7Cj4gQEAgLTY1NjIsNyArNjU2Miw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RwX2lu
aXRfcGFuZWxfcG93ZXJfdGltZXN0YW1wcyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAg
c3RhdGljIHZvaWQKPiAgIGludGVsX3Bwc19yZWFkb3V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9k
cCAqaW50ZWxfZHAsIHN0cnVjdCBlZHBfcG93ZXJfc2VxICpzZXEpCj4gICB7Cj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gICAJ
dTMyIHBwX29uLCBwcF9vZmYsIHBwX2N0bDsKPiAgIAlzdHJ1Y3QgcHBzX3JlZ2lzdGVycyByZWdz
Owo+ICAgCj4gQEAgLTY1NzEsNyArNjU3MSw3IEBAIGludGVsX3Bwc19yZWFkb3V0X2h3X3N0YXRl
KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsIHN0cnVjdCBlZHBfcG93ZXJfc2VxICpzZXEpCj4g
ICAJcHBfY3RsID0gaXJvbmxha2VfZ2V0X3BwX2NvbnRyb2woaW50ZWxfZHApOwo+ICAgCj4gICAJ
LyogRW5zdXJlIFBQUyBpcyB1bmxvY2tlZCAqLwo+IC0JaWYgKCFIQVNfRERJKGRldl9wcml2KSkK
PiArCWlmICghSEFTX0RESShpOTE1KSkKPiAgIAkJSTkxNV9XUklURShyZWdzLnBwX2N0cmwsIHBw
X2N0bCk7Cj4gICAKPiAgIAlwcF9vbiA9IEk5MTVfUkVBRChyZWdzLnBwX29uKTsKPiBAQCAtNjYy
MSwxMSArNjYyMSwxMSBAQCBpbnRlbF9wcHNfdmVyaWZ5X3N0YXRlKHN0cnVjdCBpbnRlbF9kcCAq
aW50ZWxfZHApCj4gICBzdGF0aWMgdm9pZAo+ICAgaW50ZWxfZHBfaW5pdF9wYW5lbF9wb3dlcl9z
ZXF1ZW5jZXIoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiAgIAlzdHJ1
Y3QgZWRwX3Bvd2VyX3NlcSBjdXIsIHZidCwgc3BlYywKPiAgIAkJKmZpbmFsID0gJmludGVsX2Rw
LT5wcHNfZGVsYXlzOwo+ICAgCj4gLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+cHBz
X211dGV4KTsKPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPnBwc19tdXRleCk7Cj4gICAK
PiAgIAkvKiBhbHJlYWR5IGluaXRpYWxpemVkPyAqLwo+ICAgCWlmIChmaW5hbC0+dDExX3QxMiAh
PSAwKQo+IEBAIC02NjM1LDEzICs2NjM1LDEzIEBAIGludGVsX2RwX2luaXRfcGFuZWxfcG93ZXJf
c2VxdWVuY2VyKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICAKPiAgIAlpbnRlbF9wcHNf
ZHVtcF9zdGF0ZSgiY3VyIiwgJmN1cik7Cj4gICAKPiAtCXZidCA9IGRldl9wcml2LT52YnQuZWRw
LnBwczsKPiArCXZidCA9IGk5MTUtPnZidC5lZHAucHBzOwo+ICAgCS8qIE9uIFRvc2hpYmEgU2F0
ZWxsaXRlIFA1MC1DLTE4QyBzeXN0ZW0gdGhlIFZCVCBUMTIgZGVsYXkKPiAgIAkgKiBvZiA1MDBt
cyBhcHBlYXJzIHRvIGJlIHRvbyBzaG9ydC4gT2Nhc3Npb25hbGx5IHRoZSBwYW5lbAo+ICAgCSAq
IGp1c3QgZmFpbHMgdG8gcG93ZXIgYmFjayBvbi4gSW5jcmVhc2luZyB0aGUgZGVsYXkgdG8gODAw
bXMKPiAgIAkgKiBzZWVtcyBzdWZmaWNpZW50IHRvIGF2b2lkIHRoaXMgcHJvYmxlbS4KPiAgIAkg
Ki8KPiAtCWlmIChkZXZfcHJpdi0+cXVpcmtzICYgUVVJUktfSU5DUkVBU0VfVDEyX0RFTEFZKSB7
Cj4gKwlpZiAoaTkxNS0+cXVpcmtzICYgUVVJUktfSU5DUkVBU0VfVDEyX0RFTEFZKSB7Cj4gICAJ
CXZidC50MTFfdDEyID0gbWF4X3QodTE2LCB2YnQudDExX3QxMiwgMTMwMCAqIDEwKTsKPiAgIAkJ
RFJNX0RFQlVHX0tNUygiSW5jcmVhc2luZyBUMTIgcGFuZWwgZGVsYXkgYXMgcGVyIHRoZSBxdWly
ayB0byAlZFxuIiwKPiAgIAkJCSAgICAgIHZidC50MTFfdDEyKTsKPiBAQCAtNjcxNCwxNCArNjcx
NCwxNCBAQCBzdGF0aWMgdm9pZAo+ICAgaW50ZWxfZHBfaW5pdF9wYW5lbF9wb3dlcl9zZXF1ZW5j
ZXJfcmVnaXN0ZXJzKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gICAJCQkJCSAgICAgIGJv
b2wgZm9yY2VfZGlzYWJsZV92ZGQpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gICAJdTMyIHBwX29uLCBwcF9vZmYs
IHBvcnRfc2VsID0gMDsKPiAtCWludCBkaXYgPSBkZXZfcHJpdi0+cmF3Y2xrX2ZyZXEgLyAxMDAw
Owo+ICsJaW50IGRpdiA9IGk5MTUtPnJhd2Nsa19mcmVxIC8gMTAwMDsKPiAgIAlzdHJ1Y3QgcHBz
X3JlZ2lzdGVycyByZWdzOwo+ICAgCWVudW0gcG9ydCBwb3J0ID0gZHBfdG9fZGlnX3BvcnQoaW50
ZWxfZHApLT5iYXNlLnBvcnQ7Cj4gICAJY29uc3Qgc3RydWN0IGVkcF9wb3dlcl9zZXEgKnNlcSA9
ICZpbnRlbF9kcC0+cHBzX2RlbGF5czsKPiAgIAo+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2
X3ByaXYtPnBwc19tdXRleCk7Cj4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5wcHNfbXV0
ZXgpOwo+ICAgCj4gICAJaW50ZWxfcHBzX2dldF9yZWdpc3RlcnMoaW50ZWxfZHAsICZyZWdzKTsK
PiAgIAo+IEBAIC02NzU3LDkgKzY3NTcsOSBAQCBpbnRlbF9kcF9pbml0X3BhbmVsX3Bvd2VyX3Nl
cXVlbmNlcl9yZWdpc3RlcnMoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiAgIAo+ICAgCS8q
IEhhc3dlbGwgZG9lc24ndCBoYXZlIGFueSBwb3J0IHNlbGVjdGlvbiBiaXRzIGZvciB0aGUgcGFu
ZWwKPiAgIAkgKiBwb3dlciBzZXF1ZW5jZXIgYW55IG1vcmUuICovCj4gLQlpZiAoSVNfVkFMTEVZ
VklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiArCWlmIChJU19W
QUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiAgIAkJcG9ydF9zZWwg
PSBQQU5FTF9QT1JUX1NFTEVDVF9WTFYocG9ydCk7Cj4gLQl9IGVsc2UgaWYgKEhBU19QQ0hfSUJY
KGRldl9wcml2KSB8fCBIQVNfUENIX0NQVChkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAoSEFT
X1BDSF9JQlgoaTkxNSkgfHwgSEFTX1BDSF9DUFQoaTkxNSkpIHsKPiAgIAkJc3dpdGNoIChwb3J0
KSB7Cj4gICAJCWNhc2UgUE9SVF9BOgo+ICAgCQkJcG9ydF9zZWwgPSBQQU5FTF9QT1JUX1NFTEVD
VF9EUEE7Cj4gQEAgLTY4MDcsOSArNjgwNyw5IEBAIGludGVsX2RwX2luaXRfcGFuZWxfcG93ZXJf
c2VxdWVuY2VyX3JlZ2lzdGVycyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ICAgCj4gICBz
dGF0aWMgdm9pZCBpbnRlbF9kcF9wcHNfaW5pdChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+
ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShp
bnRlbF9kcCk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUo
aW50ZWxfZHApOwo+ICAgCj4gLQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hF
UlJZVklFVyhkZXZfcHJpdikpIHsKPiArCWlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NI
RVJSWVZJRVcoaTkxNSkpIHsKPiAgIAkJdmx2X2luaXRpYWxfcG93ZXJfc2VxdWVuY2VyX3NldHVw
KGludGVsX2RwKTsKPiAgIAl9IGVsc2Ugewo+ICAgCQlpbnRlbF9kcF9pbml0X3BhbmVsX3Bvd2Vy
X3NlcXVlbmNlcihpbnRlbF9kcCk7Cj4gQEAgLTY4MTksNyArNjgxOSw3IEBAIHN0YXRpYyB2b2lk
IGludGVsX2RwX3Bwc19pbml0KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICAKPiAgIC8q
Kgo+ICAgICogaW50ZWxfZHBfc2V0X2RycnNfc3RhdGUgLSBwcm9ncmFtIHJlZ2lzdGVycyBmb3Ig
UlIgc3dpdGNoIHRvIHRha2UgZWZmZWN0Cj4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UKPiAr
ICogQGk5MTU6IGk5MTUgZGV2aWNlCj4gICAgKiBAY3J0Y19zdGF0ZTogYSBwb2ludGVyIHRvIHRo
ZSBhY3RpdmUgaW50ZWxfY3J0Y19zdGF0ZQo+ICAgICogQHJlZnJlc2hfcmF0ZTogUlIgdG8gYmUg
cHJvZ3JhbW1lZAo+ICAgICoKPiBAQCAtNjgyOCwxNSArNjgyOCwxNSBAQCBzdGF0aWMgdm9pZCBp
bnRlbF9kcF9wcHNfaW5pdChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAgICogc3VwcG9y
dGVkIGJ5IHRoZSBwYW5lbCBvciB0byBhbnkgb3RoZXIgUlIgYmFzZWQgb24gbWVkaWEgcGxheWJh
Y2sgKGluCj4gICAgKiB0aGlzIGNhc2UsIFJSIHZhbHVlIG5lZWRzIHRvIGJlIHBhc3NlZCBmcm9t
IHVzZXIgc3BhY2UpLgo+ICAgICoKPiAtICogVGhlIGNhbGxlciBvZiB0aGlzIGZ1bmN0aW9uIG5l
ZWRzIHRvIHRha2UgYSBsb2NrIG9uIGRldl9wcml2LT5kcnJzLgo+ICsgKiBUaGUgY2FsbGVyIG9m
IHRoaXMgZnVuY3Rpb24gbmVlZHMgdG8gdGFrZSBhIGxvY2sgb24gaTkxNS0+ZHJycy4KPiAgICAq
Lwo+IC1zdGF0aWMgdm9pZCBpbnRlbF9kcF9zZXRfZHJyc19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGludGVsX2RwX3NldF9kcnJzX3N0YXRl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgICBjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJCQkgICAgaW50IHJlZnJlc2hfcmF0
ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcjsKPiAgIAlzdHJ1Y3Qg
aW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCA9IE5VTEw7Cj4gLQlzdHJ1Y3QgaW50ZWxfZHAg
KmludGVsX2RwID0gZGV2X3ByaXYtPmRycnMuZHA7Cj4gKwlzdHJ1Y3QgaW50ZWxfZHAgKmludGVs
X2RwID0gaTkxNS0+ZHJycy5kcDsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9
IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAgIAllbnVtIGRycnNfcmVm
cmVzaF9yYXRlX3R5cGUgaW5kZXggPSBEUlJTX0hJR0hfUlI7Cj4gICAKPiBAQCAtNjg1OCw3ICs2
ODU4LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHBfc2V0X2RycnNfc3RhdGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCQlyZXR1cm47Cj4gICAJfQo+ICAgCj4gLQlpZiAo
ZGV2X3ByaXYtPmRycnMudHlwZSA8IFNFQU1MRVNTX0RSUlNfU1VQUE9SVCkgewo+ICsJaWYgKGk5
MTUtPmRycnMudHlwZSA8IFNFQU1MRVNTX0RSUlNfU1VQUE9SVCkgewo+ICAgCQlEUk1fREVCVUdf
S01TKCJPbmx5IFNlYW1sZXNzIERSUlMgc3VwcG9ydGVkLlxuIik7Cj4gICAJCXJldHVybjsKPiAg
IAl9Cj4gQEAgLTY4NjcsNyArNjg2Nyw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RwX3NldF9kcnJz
X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkJCXJlZnJlc2hf
cmF0ZSkKPiAgIAkJaW5kZXggPSBEUlJTX0xPV19SUjsKPiAgIAo+IC0JaWYgKGluZGV4ID09IGRl
dl9wcml2LT5kcnJzLnJlZnJlc2hfcmF0ZV90eXBlKSB7Cj4gKwlpZiAoaW5kZXggPT0gaTkxNS0+
ZHJycy5yZWZyZXNoX3JhdGVfdHlwZSkgewo+ICAgCQlEUk1fREVCVUdfS01TKAo+ICAgCQkJIkRS
UlMgcmVxdWVzdGVkIGZvciBwcmV2aW91c2x5IHNldCBSUi4uLmlnbm9yaW5nXG4iKTsKPiAgIAkJ
cmV0dXJuOwo+IEBAIC02ODc4LDcgKzY4NzgsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kcF9zZXRf
ZHJyc19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJCXJldHVy
bjsKPiAgIAl9Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDggJiYgIUlTX0NI
RVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDggJiYgIUlT
X0NIRVJSWVZJRVcoaTkxNSkpIHsKPiAgIAkJc3dpdGNoIChpbmRleCkgewo+ICAgCQljYXNlIERS
UlNfSElHSF9SUjoKPiAgIAkJCWludGVsX2RwX3NldF9tX24oY3J0Y19zdGF0ZSwgTTFfTjEpOwo+
IEBAIC02ODkwLDE4ICs2ODkwLDE4IEBAIHN0YXRpYyB2b2lkIGludGVsX2RwX3NldF9kcnJzX3N0
YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkJZGVmYXVsdDoKPiAg
IAkJCURSTV9FUlJPUigiVW5zdXBwb3J0ZWQgcmVmcmVzaHJhdGUgdHlwZVxuIik7Cj4gICAJCX0K
PiAtCX0gZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+IDYpIHsKPiArCX0gZWxzZSBpZiAo
SU5URUxfR0VOKGk5MTUpID4gNikgewo+ICAgCQlpOTE1X3JlZ190IHJlZyA9IFBJUEVDT05GKGNy
dGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyKTsKPiAgIAkJdTMyIHZhbDsKPiAgIAo+ICAgCQl2YWwg
PSBJOTE1X1JFQUQocmVnKTsKPiAgIAkJaWYgKGluZGV4ID4gRFJSU19ISUdIX1JSKSB7Cj4gLQkJ
CWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkK
PiArCQkJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiAg
IAkJCQl2YWwgfD0gUElQRUNPTkZfRURQX1JSX01PREVfU1dJVENIX1ZMVjsKPiAgIAkJCWVsc2UK
PiAgIAkJCQl2YWwgfD0gUElQRUNPTkZfRURQX1JSX01PREVfU1dJVENIOwo+ICAgCQl9IGVsc2Ug
ewo+IC0JCQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZf
cHJpdikpCj4gKwkJCWlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkx
NSkpCj4gICAJCQkJdmFsICY9IH5QSVBFQ09ORl9FRFBfUlJfTU9ERV9TV0lUQ0hfVkxWOwo+ICAg
CQkJZWxzZQo+ICAgCQkJCXZhbCAmPSB+UElQRUNPTkZfRURQX1JSX01PREVfU1dJVENIOwo+IEBA
IC02OTA5LDcgKzY5MDksNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kcF9zZXRfZHJyc19zdGF0ZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJCUk5MTVfV1JJVEUocmVnLCB2
YWwpOwo+ICAgCX0KPiAgIAo+IC0JZGV2X3ByaXYtPmRycnMucmVmcmVzaF9yYXRlX3R5cGUgPSBp
bmRleDsKPiArCWk5MTUtPmRycnMucmVmcmVzaF9yYXRlX3R5cGUgPSBpbmRleDsKPiAgIAo+ICAg
CURSTV9ERUJVR19LTVMoImVEUCBSZWZyZXNoIFJhdGUgc2V0IHRvIDogJWRIelxuIiwgcmVmcmVz
aF9yYXRlKTsKPiAgIH0KPiBAQCAtNjkyNCwzMCArNjkyNCwzMCBAQCBzdGF0aWMgdm9pZCBpbnRl
bF9kcF9zZXRfZHJyc19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
ICB2b2lkIGludGVsX2VkcF9kcnJzX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+
ICAgCQkJICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVs
X2RwKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRl
bF9kcCk7Cj4gICAKPiAgIAlpZiAoIWNydGNfc3RhdGUtPmhhc19kcnJzKSB7Cj4gICAJCURSTV9E
RUJVR19LTVMoIlBhbmVsIGRvZXNuJ3Qgc3VwcG9ydCBEUlJTXG4iKTsKPiAgIAkJcmV0dXJuOwo+
ICAgCX0KPiAgIAo+IC0JaWYgKGRldl9wcml2LT5wc3IuZW5hYmxlZCkgewo+ICsJaWYgKGk5MTUt
PnBzci5lbmFibGVkKSB7Cj4gICAJCURSTV9ERUJVR19LTVMoIlBTUiBlbmFibGVkLiBOb3QgZW5h
YmxpbmcgRFJSUy5cbiIpOwo+ICAgCQlyZXR1cm47Cj4gICAJfQo+ICAgCj4gLQltdXRleF9sb2Nr
KCZkZXZfcHJpdi0+ZHJycy5tdXRleCk7Cj4gLQlpZiAoZGV2X3ByaXYtPmRycnMuZHApIHsKPiAr
CW11dGV4X2xvY2soJmk5MTUtPmRycnMubXV0ZXgpOwo+ICsJaWYgKGk5MTUtPmRycnMuZHApIHsK
PiAgIAkJRFJNX0RFQlVHX0tNUygiRFJSUyBhbHJlYWR5IGVuYWJsZWRcbiIpOwo+ICAgCQlnb3Rv
IHVubG9jazsKPiAgIAl9Cj4gICAKPiAtCWRldl9wcml2LT5kcnJzLmJ1c3lfZnJvbnRidWZmZXJf
Yml0cyA9IDA7Cj4gKwlpOTE1LT5kcnJzLmJ1c3lfZnJvbnRidWZmZXJfYml0cyA9IDA7Cj4gICAK
PiAtCWRldl9wcml2LT5kcnJzLmRwID0gaW50ZWxfZHA7Cj4gKwlpOTE1LT5kcnJzLmRwID0gaW50
ZWxfZHA7Cj4gICAKPiAgIHVubG9jazoKPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRycnMu
bXV0ZXgpOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcnJzLm11dGV4KTsKPiAgIH0KPiAgIAo+
ICAgLyoqCj4gQEAgLTY5NTksMzYgKzY5NTksMzYgQEAgdm9pZCBpbnRlbF9lZHBfZHJyc19lbmFi
bGUoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiAgIHZvaWQgaW50ZWxfZWRwX2RycnNfZGlz
YWJsZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ICAgCQkJICAgIGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiAgIAo+ICAgCWlm
ICghb2xkX2NydGNfc3RhdGUtPmhhc19kcnJzKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCW11dGV4
X2xvY2soJmRldl9wcml2LT5kcnJzLm11dGV4KTsKPiAtCWlmICghZGV2X3ByaXYtPmRycnMuZHAp
IHsKPiAtCQltdXRleF91bmxvY2soJmRldl9wcml2LT5kcnJzLm11dGV4KTsKPiArCW11dGV4X2xv
Y2soJmk5MTUtPmRycnMubXV0ZXgpOwo+ICsJaWYgKCFpOTE1LT5kcnJzLmRwKSB7Cj4gKwkJbXV0
ZXhfdW5sb2NrKCZpOTE1LT5kcnJzLm11dGV4KTsKPiAgIAkJcmV0dXJuOwo+ICAgCX0KPiAgIAo+
IC0JaWYgKGRldl9wcml2LT5kcnJzLnJlZnJlc2hfcmF0ZV90eXBlID09IERSUlNfTE9XX1JSKQo+
IC0JCWludGVsX2RwX3NldF9kcnJzX3N0YXRlKGRldl9wcml2LCBvbGRfY3J0Y19zdGF0ZSwKPiAr
CWlmIChpOTE1LT5kcnJzLnJlZnJlc2hfcmF0ZV90eXBlID09IERSUlNfTE9XX1JSKQo+ICsJCWlu
dGVsX2RwX3NldF9kcnJzX3N0YXRlKGk5MTUsIG9sZF9jcnRjX3N0YXRlLAo+ICAgCQkJaW50ZWxf
ZHAtPmF0dGFjaGVkX2Nvbm5lY3Rvci0+cGFuZWwuZml4ZWRfbW9kZS0+dnJlZnJlc2gpOwo+ICAg
Cj4gLQlkZXZfcHJpdi0+ZHJycy5kcCA9IE5VTEw7Cj4gLQltdXRleF91bmxvY2soJmRldl9wcml2
LT5kcnJzLm11dGV4KTsKPiArCWk5MTUtPmRycnMuZHAgPSBOVUxMOwo+ICsJbXV0ZXhfdW5sb2Nr
KCZpOTE1LT5kcnJzLm11dGV4KTsKPiAgIAo+IC0JY2FuY2VsX2RlbGF5ZWRfd29ya19zeW5jKCZk
ZXZfcHJpdi0+ZHJycy53b3JrKTsKPiArCWNhbmNlbF9kZWxheWVkX3dvcmtfc3luYygmaTkxNS0+
ZHJycy53b3JrKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgaW50ZWxfZWRwX2RycnNfZG93
bmNsb2NrX3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAgewo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0KPiAtCQljb250YWluZXJfb2Yod29yaywgdHlwZW9m
KCpkZXZfcHJpdiksIGRycnMud29yay53b3JrKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0KPiArCQljb250YWluZXJfb2Yod29yaywgdHlwZW9mKCppOTE1KSwgZHJycy53b3Jr
LndvcmspOwo+ICAgCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHA7Cj4gICAKPiAtCW11dGV4X2xv
Y2soJmRldl9wcml2LT5kcnJzLm11dGV4KTsKPiArCW11dGV4X2xvY2soJmk5MTUtPmRycnMubXV0
ZXgpOwo+ICAgCj4gLQlpbnRlbF9kcCA9IGRldl9wcml2LT5kcnJzLmRwOwo+ICsJaW50ZWxfZHAg
PSBpOTE1LT5kcnJzLmRwOwo+ICAgCj4gICAJaWYgKCFpbnRlbF9kcCkKPiAgIAkJZ290byB1bmxv
Y2s7Cj4gQEAgLTY5OTgsMjMgKzY5OTgsMjMgQEAgc3RhdGljIHZvaWQgaW50ZWxfZWRwX2RycnNf
ZG93bmNsb2NrX3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAgCSAqIHJlY2hlY2su
Cj4gICAJICovCj4gICAKPiAtCWlmIChkZXZfcHJpdi0+ZHJycy5idXN5X2Zyb250YnVmZmVyX2Jp
dHMpCj4gKwlpZiAoaTkxNS0+ZHJycy5idXN5X2Zyb250YnVmZmVyX2JpdHMpCj4gICAJCWdvdG8g
dW5sb2NrOwo+ICAgCj4gLQlpZiAoZGV2X3ByaXYtPmRycnMucmVmcmVzaF9yYXRlX3R5cGUgIT0g
RFJSU19MT1dfUlIpIHsKPiArCWlmIChpOTE1LT5kcnJzLnJlZnJlc2hfcmF0ZV90eXBlICE9IERS
UlNfTE9XX1JSKSB7Cj4gICAJCXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9IGRwX3RvX2RpZ19wb3J0
KGludGVsX2RwKS0+YmFzZS5iYXNlLmNydGM7Cj4gICAKPiAtCQlpbnRlbF9kcF9zZXRfZHJyc19z
dGF0ZShkZXZfcHJpdiwgdG9faW50ZWxfY3J0YyhjcnRjKS0+Y29uZmlnLAo+ICsJCWludGVsX2Rw
X3NldF9kcnJzX3N0YXRlKGk5MTUsIHRvX2ludGVsX2NydGMoY3J0YyktPmNvbmZpZywKPiAgIAkJ
CWludGVsX2RwLT5hdHRhY2hlZF9jb25uZWN0b3ItPnBhbmVsLmRvd25jbG9ja19tb2RlLT52cmVm
cmVzaCk7Cj4gICAJfQo+ICAgCj4gICB1bmxvY2s6Cj4gLQltdXRleF91bmxvY2soJmRldl9wcml2
LT5kcnJzLm11dGV4KTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHJycy5tdXRleCk7Cj4gICB9
Cj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxfZWRwX2RycnNfaW52YWxpZGF0ZSAtIERpc2FibGUg
SWRsZW5lc3MgRFJSUwo+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlCj4gKyAqIEBpOTE1OiBp
OTE1IGRldmljZQo+ICAgICogQGZyb250YnVmZmVyX2JpdHM6IGZyb250YnVmZmVyIHBsYW5lIHRy
YWNraW5nIGJpdHMKPiAgICAqCj4gICAgKiBUaGlzIGZ1bmN0aW9uIGdldHMgY2FsbGVkIGV2ZXJ5
dGltZSByZW5kZXJpbmcgb24gdGhlIGdpdmVuIHBsYW5lcyBzdGFydC4KPiBAQCAtNzAyMiw0MCAr
NzAyMiw0MCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9lZHBfZHJyc19kb3duY2xvY2tfd29yayhzdHJ1
Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gICAgKgo+ICAgICogRGlydHkgZnJvbnRidWZmZXJzIHJl
bGV2YW50IHRvIERSUlMgYXJlIHRyYWNrZWQgaW4gYnVzeV9mcm9udGJ1ZmZlcl9iaXRzLgo+ICAg
ICovCj4gLXZvaWQgaW50ZWxfZWRwX2RycnNfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gK3ZvaWQgaW50ZWxfZWRwX2RycnNfaW52YWxpZGF0ZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgICB1bnNpZ25lZCBpbnQgZnJvbnRi
dWZmZXJfYml0cykKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2NydGMgKmNydGM7Cj4gICAJZW51bSBw
aXBlIHBpcGU7Cj4gICAKPiAtCWlmIChkZXZfcHJpdi0+ZHJycy50eXBlID09IERSUlNfTk9UX1NV
UFBPUlRFRCkKPiArCWlmIChpOTE1LT5kcnJzLnR5cGUgPT0gRFJSU19OT1RfU1VQUE9SVEVEKQo+
ICAgCQlyZXR1cm47Cj4gICAKPiAtCWNhbmNlbF9kZWxheWVkX3dvcmsoJmRldl9wcml2LT5kcnJz
LndvcmspOwo+ICsJY2FuY2VsX2RlbGF5ZWRfd29yaygmaTkxNS0+ZHJycy53b3JrKTsKPiAgIAo+
IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRycnMubXV0ZXgpOwo+IC0JaWYgKCFkZXZfcHJpdi0+
ZHJycy5kcCkgewo+IC0JCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRycnMubXV0ZXgpOwo+ICsJ
bXV0ZXhfbG9jaygmaTkxNS0+ZHJycy5tdXRleCk7Cj4gKwlpZiAoIWk5MTUtPmRycnMuZHApIHsK
PiArCQltdXRleF91bmxvY2soJmk5MTUtPmRycnMubXV0ZXgpOwo+ICAgCQlyZXR1cm47Cj4gICAJ
fQo+ICAgCj4gLQljcnRjID0gZHBfdG9fZGlnX3BvcnQoZGV2X3ByaXYtPmRycnMuZHApLT5iYXNl
LmJhc2UuY3J0YzsKPiArCWNydGMgPSBkcF90b19kaWdfcG9ydChpOTE1LT5kcnJzLmRwKS0+YmFz
ZS5iYXNlLmNydGM7Cj4gICAJcGlwZSA9IHRvX2ludGVsX2NydGMoY3J0YyktPnBpcGU7Cj4gICAK
PiAgIAlmcm9udGJ1ZmZlcl9iaXRzICY9IElOVEVMX0ZST05UQlVGRkVSX0FMTF9NQVNLKHBpcGUp
Owo+IC0JZGV2X3ByaXYtPmRycnMuYnVzeV9mcm9udGJ1ZmZlcl9iaXRzIHw9IGZyb250YnVmZmVy
X2JpdHM7Cj4gKwlpOTE1LT5kcnJzLmJ1c3lfZnJvbnRidWZmZXJfYml0cyB8PSBmcm9udGJ1ZmZl
cl9iaXRzOwo+ICAgCj4gICAJLyogaW52YWxpZGF0ZSBtZWFucyBidXN5IHNjcmVlbiBoZW5jZSB1
cGNsb2NrICovCj4gLQlpZiAoZnJvbnRidWZmZXJfYml0cyAmJiBkZXZfcHJpdi0+ZHJycy5yZWZy
ZXNoX3JhdGVfdHlwZSA9PSBEUlJTX0xPV19SUikKPiAtCQlpbnRlbF9kcF9zZXRfZHJyc19zdGF0
ZShkZXZfcHJpdiwgdG9faW50ZWxfY3J0YyhjcnRjKS0+Y29uZmlnLAo+IC0JCQlkZXZfcHJpdi0+
ZHJycy5kcC0+YXR0YWNoZWRfY29ubmVjdG9yLT5wYW5lbC5maXhlZF9tb2RlLT52cmVmcmVzaCk7
Cj4gKwlpZiAoZnJvbnRidWZmZXJfYml0cyAmJiBpOTE1LT5kcnJzLnJlZnJlc2hfcmF0ZV90eXBl
ID09IERSUlNfTE9XX1JSKQo+ICsJCWludGVsX2RwX3NldF9kcnJzX3N0YXRlKGk5MTUsIHRvX2lu
dGVsX2NydGMoY3J0YyktPmNvbmZpZywKPiArCQkJaTkxNS0+ZHJycy5kcC0+YXR0YWNoZWRfY29u
bmVjdG9yLT5wYW5lbC5maXhlZF9tb2RlLT52cmVmcmVzaCk7Cj4gICAKPiAtCW11dGV4X3VubG9j
aygmZGV2X3ByaXYtPmRycnMubXV0ZXgpOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcnJzLm11
dGV4KTsKPiAgIH0KPiAgIAo+ICAgLyoqCj4gICAgKiBpbnRlbF9lZHBfZHJyc19mbHVzaCAtIFJl
c3RhcnQgSWRsZW5lc3MgRFJSUwo+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlCj4gKyAqIEBp
OTE1OiBpOTE1IGRldmljZQo+ICAgICogQGZyb250YnVmZmVyX2JpdHM6IGZyb250YnVmZmVyIHBs
YW5lIHRyYWNraW5nIGJpdHMKPiAgICAqCj4gICAgKiBUaGlzIGZ1bmN0aW9uIGdldHMgY2FsbGVk
IGV2ZXJ5IHRpbWUgcmVuZGVyaW5nIG9uIHRoZSBnaXZlbiBwbGFuZXMgaGFzCj4gQEAgLTcwNjUs
NDIgKzcwNjUsNDIgQEAgdm9pZCBpbnRlbF9lZHBfZHJyc19pbnZhbGlkYXRlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgICAqCj4gICAgKiBEaXJ0eSBmcm9udGJ1ZmZlcnMg
cmVsZXZhbnQgdG8gRFJSUyBhcmUgdHJhY2tlZCBpbiBidXN5X2Zyb250YnVmZmVyX2JpdHMuCj4g
ICAgKi8KPiAtdm9pZCBpbnRlbF9lZHBfZHJyc19mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gK3ZvaWQgaW50ZWxfZWRwX2RycnNfZmx1c2goc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgIHVuc2lnbmVkIGludCBmcm9udGJ1ZmZlcl9iaXRzKQo+
ICAgewo+ICAgCXN0cnVjdCBkcm1fY3J0YyAqY3J0YzsKPiAgIAllbnVtIHBpcGUgcGlwZTsKPiAg
IAo+IC0JaWYgKGRldl9wcml2LT5kcnJzLnR5cGUgPT0gRFJSU19OT1RfU1VQUE9SVEVEKQo+ICsJ
aWYgKGk5MTUtPmRycnMudHlwZSA9PSBEUlJTX05PVF9TVVBQT1JURUQpCj4gICAJCXJldHVybjsK
PiAgIAo+IC0JY2FuY2VsX2RlbGF5ZWRfd29yaygmZGV2X3ByaXYtPmRycnMud29yayk7Cj4gKwlj
YW5jZWxfZGVsYXllZF93b3JrKCZpOTE1LT5kcnJzLndvcmspOwo+ICAgCj4gLQltdXRleF9sb2Nr
KCZkZXZfcHJpdi0+ZHJycy5tdXRleCk7Cj4gLQlpZiAoIWRldl9wcml2LT5kcnJzLmRwKSB7Cj4g
LQkJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJycy5tdXRleCk7Cj4gKwltdXRleF9sb2NrKCZp
OTE1LT5kcnJzLm11dGV4KTsKPiArCWlmICghaTkxNS0+ZHJycy5kcCkgewo+ICsJCW11dGV4X3Vu
bG9jaygmaTkxNS0+ZHJycy5tdXRleCk7Cj4gICAJCXJldHVybjsKPiAgIAl9Cj4gICAKPiAtCWNy
dGMgPSBkcF90b19kaWdfcG9ydChkZXZfcHJpdi0+ZHJycy5kcCktPmJhc2UuYmFzZS5jcnRjOwo+
ICsJY3J0YyA9IGRwX3RvX2RpZ19wb3J0KGk5MTUtPmRycnMuZHApLT5iYXNlLmJhc2UuY3J0YzsK
PiAgIAlwaXBlID0gdG9faW50ZWxfY3J0YyhjcnRjKS0+cGlwZTsKPiAgIAo+ICAgCWZyb250YnVm
ZmVyX2JpdHMgJj0gSU5URUxfRlJPTlRCVUZGRVJfQUxMX01BU0socGlwZSk7Cj4gLQlkZXZfcHJp
di0+ZHJycy5idXN5X2Zyb250YnVmZmVyX2JpdHMgJj0gfmZyb250YnVmZmVyX2JpdHM7Cj4gKwlp
OTE1LT5kcnJzLmJ1c3lfZnJvbnRidWZmZXJfYml0cyAmPSB+ZnJvbnRidWZmZXJfYml0czsKPiAg
IAo+ICAgCS8qIGZsdXNoIG1lYW5zIGJ1c3kgc2NyZWVuIGhlbmNlIHVwY2xvY2sgKi8KPiAtCWlm
IChmcm9udGJ1ZmZlcl9iaXRzICYmIGRldl9wcml2LT5kcnJzLnJlZnJlc2hfcmF0ZV90eXBlID09
IERSUlNfTE9XX1JSKQo+IC0JCWludGVsX2RwX3NldF9kcnJzX3N0YXRlKGRldl9wcml2LCB0b19p
bnRlbF9jcnRjKGNydGMpLT5jb25maWcsCj4gLQkJCQlkZXZfcHJpdi0+ZHJycy5kcC0+YXR0YWNo
ZWRfY29ubmVjdG9yLT5wYW5lbC5maXhlZF9tb2RlLT52cmVmcmVzaCk7Cj4gKwlpZiAoZnJvbnRi
dWZmZXJfYml0cyAmJiBpOTE1LT5kcnJzLnJlZnJlc2hfcmF0ZV90eXBlID09IERSUlNfTE9XX1JS
KQo+ICsJCWludGVsX2RwX3NldF9kcnJzX3N0YXRlKGk5MTUsIHRvX2ludGVsX2NydGMoY3J0Yykt
PmNvbmZpZywKPiArCQkJCWk5MTUtPmRycnMuZHAtPmF0dGFjaGVkX2Nvbm5lY3Rvci0+cGFuZWwu
Zml4ZWRfbW9kZS0+dnJlZnJlc2gpOwo+ICAgCj4gICAJLyoKPiAgIAkgKiBmbHVzaCBhbHNvIG1l
YW5zIG5vIG1vcmUgYWN0aXZpdHkgaGVuY2Ugc2NoZWR1bGUgZG93bmNsb2NrLCBpZiBhbGwKPiAg
IAkgKiBvdGhlciBmYnMgYXJlIHF1aWVzY2VudCB0b28KPiAgIAkgKi8KPiAtCWlmICghZGV2X3By
aXYtPmRycnMuYnVzeV9mcm9udGJ1ZmZlcl9iaXRzKQo+IC0JCXNjaGVkdWxlX2RlbGF5ZWRfd29y
aygmZGV2X3ByaXYtPmRycnMud29yaywKPiArCWlmICghaTkxNS0+ZHJycy5idXN5X2Zyb250YnVm
ZmVyX2JpdHMpCj4gKwkJc2NoZWR1bGVfZGVsYXllZF93b3JrKCZpOTE1LT5kcnJzLndvcmssCj4g
ICAJCQkJbXNlY3NfdG9famlmZmllcygxMDAwKSk7Cj4gLQltdXRleF91bmxvY2soJmRldl9wcml2
LT5kcnJzLm11dGV4KTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHJycy5tdXRleCk7Cj4gICB9
Cj4gICAKPiAgIC8qKgo+IEBAIC03MTU3LDE4ICs3MTU3LDE4IEBAIHN0YXRpYyBzdHJ1Y3QgZHJt
X2Rpc3BsYXlfbW9kZSAqCj4gICBpbnRlbF9kcF9kcnJzX2luaXQoc3RydWN0IGludGVsX2Nvbm5l
Y3RvciAqY29ubmVjdG9yLAo+ICAgCQkgICBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqZml4ZWRf
bW9kZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGRybV9kaXNwbGF5
X21vZGUgKmRvd25jbG9ja19tb2RlID0gTlVMTDsKPiAgIAo+IC0JSU5JVF9ERUxBWUVEX1dPUkso
JmRldl9wcml2LT5kcnJzLndvcmssIGludGVsX2VkcF9kcnJzX2Rvd25jbG9ja193b3JrKTsKPiAt
CW11dGV4X2luaXQoJmRldl9wcml2LT5kcnJzLm11dGV4KTsKPiArCUlOSVRfREVMQVlFRF9XT1JL
KCZpOTE1LT5kcnJzLndvcmssIGludGVsX2VkcF9kcnJzX2Rvd25jbG9ja193b3JrKTsKPiArCW11
dGV4X2luaXQoJmk5MTUtPmRycnMubXV0ZXgpOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA8PSA2KSB7Cj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDw9IDYpIHsKPiAgIAkJRFJNX0RF
QlVHX0tNUygiRFJSUyBzdXBwb3J0ZWQgZm9yIEdlbjcgYW5kIGFib3ZlXG4iKTsKPiAgIAkJcmV0
dXJuIE5VTEw7Cj4gICAJfQo+ICAgCj4gLQlpZiAoZGV2X3ByaXYtPnZidC5kcnJzX3R5cGUgIT0g
U0VBTUxFU1NfRFJSU19TVVBQT1JUKSB7Cj4gKwlpZiAoaTkxNS0+dmJ0LmRycnNfdHlwZSAhPSBT
RUFNTEVTU19EUlJTX1NVUFBPUlQpIHsKPiAgIAkJRFJNX0RFQlVHX0tNUygiVkJUIGRvZXNuJ3Qg
c3VwcG9ydCBEUlJTXG4iKTsKPiAgIAkJcmV0dXJuIE5VTEw7Cj4gICAJfQo+IEBAIC03MTc5LDkg
KzcxNzksOSBAQCBpbnRlbF9kcF9kcnJzX2luaXQoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29u
bmVjdG9yLAo+ICAgCQlyZXR1cm4gTlVMTDsKPiAgIAl9Cj4gICAKPiAtCWRldl9wcml2LT5kcnJz
LnR5cGUgPSBkZXZfcHJpdi0+dmJ0LmRycnNfdHlwZTsKPiArCWk5MTUtPmRycnMudHlwZSA9IGk5
MTUtPnZidC5kcnJzX3R5cGU7Cj4gICAKPiAtCWRldl9wcml2LT5kcnJzLnJlZnJlc2hfcmF0ZV90
eXBlID0gRFJSU19ISUdIX1JSOwo+ICsJaTkxNS0+ZHJycy5yZWZyZXNoX3JhdGVfdHlwZSA9IERS
UlNfSElHSF9SUjsKPiAgIAlEUk1fREVCVUdfS01TKCJzZWFtbGVzcyBEUlJTIHN1cHBvcnRlZCBm
b3IgZURQIHBhbmVsLlxuIik7Cj4gICAJcmV0dXJuIGRvd25jbG9ja19tb2RlOwo+ICAgfQo+IEBA
IC03MTg5LDggKzcxODksOCBAQCBpbnRlbF9kcF9kcnJzX2luaXQoc3RydWN0IGludGVsX2Nvbm5l
Y3RvciAqY29ubmVjdG9yLAo+ICAgc3RhdGljIGJvb2wgaW50ZWxfZWRwX2luaXRfY29ubmVjdG9y
KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gICAJCQkJICAgICBzdHJ1Y3QgaW50ZWxfY29u
bmVjdG9yICppbnRlbF9jb25uZWN0b3IpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiAtCXN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmk5
MTUtPmRybTsKPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gJmludGVsX2Nv
bm5lY3Rvci0+YmFzZTsKPiAgIAlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqZml4ZWRfbW9kZSA9
IE5VTEw7Cj4gICAJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmRvd25jbG9ja19tb2RlID0gTlVM
TDsKPiBAQCAtNzIxMCw4ICs3MjEwLDggQEAgc3RhdGljIGJvb2wgaW50ZWxfZWRwX2luaXRfY29u
bmVjdG9yKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gICAJICogZURQIGFuZCBMVkRTIGJh
aWwgb3V0IGVhcmx5IGluIHRoaXMgY2FzZSB0byBwcmV2ZW50IGludGVyZmVyaW5nCj4gICAJICog
d2l0aCBhbiBhbHJlYWR5IHBvd2VyZWQtb24gTFZEUyBwb3dlciBzZXF1ZW5jZXIuCj4gICAJICov
Cj4gLQlpZiAoaW50ZWxfZ2V0X2x2ZHNfZW5jb2RlcihkZXZfcHJpdikpIHsKPiAtCQlXQVJOX09O
KCEoSEFTX1BDSF9JQlgoZGV2X3ByaXYpIHx8IEhBU19QQ0hfQ1BUKGRldl9wcml2KSkpOwo+ICsJ
aWYgKGludGVsX2dldF9sdmRzX2VuY29kZXIoaTkxNSkpIHsKPiArCQlXQVJOX09OKCEoSEFTX1BD
SF9JQlgoaTkxNSkgfHwgSEFTX1BDSF9DUFQoaTkxNSkpKTsKPiAgIAkJRFJNX0lORk8oIkxWRFMg
d2FzIGRldGVjdGVkLCBub3QgcmVnaXN0ZXJpbmcgZURQXG4iKTsKPiAgIAo+ICAgCQlyZXR1cm4g
ZmFsc2U7Cj4gQEAgLTcyNTYsNyArNzI1Niw3IEBAIHN0YXRpYyBib29sIGludGVsX2VkcF9pbml0
X2Nvbm5lY3RvcihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ICAgCQlmaXhlZF9tb2RlID0g
aW50ZWxfcGFuZWxfdmJ0X2ZpeGVkX21vZGUoaW50ZWxfY29ubmVjdG9yKTsKPiAgIAltdXRleF91
bmxvY2soJmRldi0+bW9kZV9jb25maWcubXV0ZXgpOwo+ICAgCj4gLQlpZiAoSVNfVkFMTEVZVklF
VyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiArCWlmIChJU19WQUxM
RVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiAgIAkJaW50ZWxfZHAtPmVk
cF9ub3RpZmllci5ub3RpZmllcl9jYWxsID0gZWRwX25vdGlmeV9oYW5kbGVyOwo+ICAgCQlyZWdp
c3Rlcl9yZWJvb3Rfbm90aWZpZXIoJmludGVsX2RwLT5lZHBfbm90aWZpZXIpOwo+ICAgCj4gQEAg
LTczMzAsNyArNzMzMCw3IEBAIGludGVsX2RwX2luaXRfY29ubmVjdG9yKHN0cnVjdCBpbnRlbF9k
aWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0LAo+ICAgCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxf
ZHAgPSAmaW50ZWxfZGlnX3BvcnQtPmRwOwo+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICppbnRl
bF9lbmNvZGVyID0gJmludGVsX2RpZ19wb3J0LT5iYXNlOwo+ICAgCXN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYgPSBpbnRlbF9lbmNvZGVyLT5iYXNlLmRldjsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCWVudW0gcG9ydCBwb3J0ID0gaW50ZWxfZW5jb2Rl
ci0+cG9ydDsKPiAgIAlpbnQgdHlwZTsKPiAgIAo+IEBAIC03MzUzLDE4ICs3MzUzLDE4IEBAIGlu
dGVsX2RwX2luaXRfY29ubmVjdG9yKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2Rp
Z19wb3J0LAo+ICAgCWludGVsX2RwLT5EUCA9IEk5MTVfUkVBRChpbnRlbF9kcC0+b3V0cHV0X3Jl
Zyk7Cj4gICAJaW50ZWxfZHAtPmF0dGFjaGVkX2Nvbm5lY3RvciA9IGludGVsX2Nvbm5lY3RvcjsK
PiAgIAo+IC0JaWYgKGludGVsX2RwX2lzX3BvcnRfZWRwKGRldl9wcml2LCBwb3J0KSkgewo+ICsJ
aWYgKGludGVsX2RwX2lzX3BvcnRfZWRwKGk5MTUsIHBvcnQpKSB7Cj4gICAJCS8qCj4gICAJCSAq
IEN1cnJlbnRseSB3ZSBkb24ndCBzdXBwb3J0IGVEUCBvbiBUeXBlQyBwb3J0cywgYWx0aG91Z2gg
aW4KPiAgIAkJICogdGhlb3J5IGl0IGNvdWxkIHdvcmsgb24gVHlwZUMgbGVnYWN5IHBvcnRzLgo+
ICAgCQkgKi8KPiAtCQlXQVJOX09OKGludGVsX3BvcnRfaXNfdGMoZGV2X3ByaXYsIHBvcnQpKTsK
PiArCQlXQVJOX09OKGludGVsX3BvcnRfaXNfdGMoaTkxNSwgcG9ydCkpOwo+ICAgCQl0eXBlID0g
RFJNX01PREVfQ09OTkVDVE9SX2VEUDsKPiAgIAl9IGVsc2Ugewo+ICAgCQl0eXBlID0gRFJNX01P
REVfQ09OTkVDVE9SX0Rpc3BsYXlQb3J0Owo+ICAgCX0KPiAgIAo+IC0JaWYgKElTX1ZBTExFWVZJ
RVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ICsJaWYgKElTX1ZBTExF
WVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiAgIAkJaW50ZWxfZHAtPmFjdGl2
ZV9waXBlID0gdmx2X2FjdGl2ZV9waXBlKGludGVsX2RwKTsKPiAgIAo+ICAgCS8qCj4gQEAgLTcz
NzYsNyArNzM3Niw3IEBAIGludGVsX2RwX2luaXRfY29ubmVjdG9yKHN0cnVjdCBpbnRlbF9kaWdp
dGFsX3BvcnQgKmludGVsX2RpZ19wb3J0LAo+ICAgCQlpbnRlbF9lbmNvZGVyLT50eXBlID0gSU5U
RUxfT1VUUFVUX0VEUDsKPiAgIAo+ICAgCS8qIGVEUCBvbmx5IG9uIHBvcnQgQiBhbmQvb3IgQyBv
biB2bHYvY2h2ICovCj4gLQlpZiAoV0FSTl9PTigoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwg
SVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpICYmCj4gKwlpZiAoV0FSTl9PTigoSVNfVkFMTEVZVklF
VyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKSAmJgo+ICAgCQkgICAgaW50ZWxfZHBfaXNf
ZWRwKGludGVsX2RwKSAmJgo+ICAgCQkgICAgcG9ydCAhPSBQT1JUX0IgJiYgcG9ydCAhPSBQT1JU
X0MpKQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gQEAgLTczODgsMjYgKzczODgsMjYgQEAgaW50ZWxf
ZHBfaW5pdF9jb25uZWN0b3Ioc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3Bv
cnQsCj4gICAJZHJtX2Nvbm5lY3Rvcl9pbml0KGRldiwgY29ubmVjdG9yLCAmaW50ZWxfZHBfY29u
bmVjdG9yX2Z1bmNzLCB0eXBlKTsKPiAgIAlkcm1fY29ubmVjdG9yX2hlbHBlcl9hZGQoY29ubmVj
dG9yLCAmaW50ZWxfZHBfY29ubmVjdG9yX2hlbHBlcl9mdW5jcyk7Cj4gICAKPiAtCWlmICghSEFT
X0dNQ0goZGV2X3ByaXYpKQo+ICsJaWYgKCFIQVNfR01DSChpOTE1KSkKPiAgIAkJY29ubmVjdG9y
LT5pbnRlcmxhY2VfYWxsb3dlZCA9IHRydWU7Cj4gICAJY29ubmVjdG9yLT5kb3VibGVzY2FuX2Fs
bG93ZWQgPSAwOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKPiArCWlm
IChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpCj4gICAJCWNvbm5lY3Rvci0+eWNiY3JfNDIwX2FsbG93
ZWQgPSB0cnVlOwo+ICAgCj4gLQlpbnRlbF9lbmNvZGVyLT5ocGRfcGluID0gaW50ZWxfaHBkX3Bp
bl9kZWZhdWx0KGRldl9wcml2LCBwb3J0KTsKPiArCWludGVsX2VuY29kZXItPmhwZF9waW4gPSBp
bnRlbF9ocGRfcGluX2RlZmF1bHQoaTkxNSwgcG9ydCk7Cj4gICAKPiAgIAlpbnRlbF9kcF9hdXhf
aW5pdChpbnRlbF9kcCk7Cj4gICAKPiAgIAlpbnRlbF9jb25uZWN0b3JfYXR0YWNoX2VuY29kZXIo
aW50ZWxfY29ubmVjdG9yLCBpbnRlbF9lbmNvZGVyKTsKPiAgIAo+IC0JaWYgKEhBU19EREkoZGV2
X3ByaXYpKQo+ICsJaWYgKEhBU19EREkoaTkxNSkpCj4gICAJCWludGVsX2Nvbm5lY3Rvci0+Z2V0
X2h3X3N0YXRlID0gaW50ZWxfZGRpX2Nvbm5lY3Rvcl9nZXRfaHdfc3RhdGU7Cj4gICAJZWxzZQo+
ICAgCQlpbnRlbF9jb25uZWN0b3ItPmdldF9od19zdGF0ZSA9IGludGVsX2Nvbm5lY3Rvcl9nZXRf
aHdfc3RhdGU7Cj4gICAKPiAgIAkvKiBpbml0IE1TVCBvbiBwb3J0cyB0aGF0IGNhbiBzdXBwb3J0
IGl0ICovCj4gLQlpZiAoSEFTX0RQX01TVChkZXZfcHJpdikgJiYgIWludGVsX2RwX2lzX2VkcChp
bnRlbF9kcCkgJiYKPiArCWlmIChIQVNfRFBfTVNUKGk5MTUpICYmICFpbnRlbF9kcF9pc19lZHAo
aW50ZWxfZHApICYmCj4gICAJICAgIChwb3J0ID09IFBPUlRfQiB8fCBwb3J0ID09IFBPUlRfQyB8
fAo+ICAgCSAgICAgcG9ydCA9PSBQT1JUX0QgfHwgcG9ydCA9PSBQT1JUX0YpKQo+ICAgCQlpbnRl
bF9kcF9tc3RfZW5jb2Rlcl9pbml0KGludGVsX2RpZ19wb3J0LAo+IEBAIC03NDIxLDcgKzc0MjEs
NyBAQCBpbnRlbF9kcF9pbml0X2Nvbm5lY3RvcihzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpp
bnRlbF9kaWdfcG9ydCwKPiAgIAo+ICAgCWludGVsX2RwX2FkZF9wcm9wZXJ0aWVzKGludGVsX2Rw
LCBjb25uZWN0b3IpOwo+ICAgCj4gLQlpZiAoaXNfaGRjcF9zdXBwb3J0ZWQoZGV2X3ByaXYsIHBv
cnQpICYmICFpbnRlbF9kcF9pc19lZHAoaW50ZWxfZHApKSB7Cj4gKwlpZiAoaXNfaGRjcF9zdXBw
b3J0ZWQoaTkxNSwgcG9ydCkgJiYgIWludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkpIHsKPiAgIAkJ
aW50IHJldCA9IGludGVsX2hkY3BfaW5pdChpbnRlbF9jb25uZWN0b3IsICZpbnRlbF9kcF9oZGNw
X3NoaW0pOwo+ICAgCQlpZiAocmV0KQo+ICAgCQkJRFJNX0RFQlVHX0tNUygiSERDUCBpbml0IGZh
aWxlZCwgc2tpcHBpbmcuXG4iKTsKPiBAQCAtNzQzMSw3ICs3NDMxLDcgQEAgaW50ZWxfZHBfaW5p
dF9jb25uZWN0b3Ioc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCj4g
ICAJICogMHhkLiAgRmFpbHVyZSB0byBkbyBzbyB3aWxsIHJlc3VsdCBpbiBzcHVyaW91cyBpbnRl
cnJ1cHRzIGJlaW5nCj4gICAJICogZ2VuZXJhdGVkIG9uIHRoZSBwb3J0IHdoZW4gYSBjYWJsZSBp
cyBub3QgYXR0YWNoZWQuCj4gICAJICovCj4gLQlpZiAoSVNfRzQ1KGRldl9wcml2KSkgewo+ICsJ
aWYgKElTX0c0NShpOTE1KSkgewo+ICAgCQl1MzIgdGVtcCA9IEk5MTVfUkVBRChQRUdfQkFORF9H
QVBfREFUQSk7Cj4gICAJCUk5MTVfV1JJVEUoUEVHX0JBTkRfR0FQX0RBVEEsICh0ZW1wICYgfjB4
ZikgfCAweGQpOwo+ICAgCX0KPiBAQCAtNzQ0NCw3ICs3NDQ0LDcgQEAgaW50ZWxfZHBfaW5pdF9j
b25uZWN0b3Ioc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCj4gICAJ
cmV0dXJuIGZhbHNlOwo+ICAgfQo+ICAgCj4gLWJvb2wgaW50ZWxfZHBfaW5pdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2Jvb2wgaW50ZWxfZHBfaW5pdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJICAgaTkxNV9yZWdfdCBvdXRwdXRfcmVnLAo+ICAg
CQkgICBlbnVtIHBvcnQgcG9ydCkKPiAgIHsKPiBAQCAtNzQ2NCw3ICs3NDY0LDcgQEAgYm9vbCBp
bnRlbF9kcF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlpbnRl
bF9lbmNvZGVyID0gJmludGVsX2RpZ19wb3J0LT5iYXNlOwo+ICAgCWVuY29kZXIgPSAmaW50ZWxf
ZW5jb2Rlci0+YmFzZTsKPiAgIAo+IC0JaWYgKGRybV9lbmNvZGVyX2luaXQoJmRldl9wcml2LT5k
cm0sICZpbnRlbF9lbmNvZGVyLT5iYXNlLAo+ICsJaWYgKGRybV9lbmNvZGVyX2luaXQoJmk5MTUt
PmRybSwgJmludGVsX2VuY29kZXItPmJhc2UsCj4gICAJCQkgICAgICZpbnRlbF9kcF9lbmNfZnVu
Y3MsIERSTV9NT0RFX0VOQ09ERVJfVE1EUywKPiAgIAkJCSAgICAgIkRQICVjIiwgcG9ydF9uYW1l
KHBvcnQpKSkKPiAgIAkJZ290byBlcnJfZW5jb2Rlcl9pbml0Owo+IEBAIC03NDc1LDE0ICs3NDc1
LDE0IEBAIGJvb2wgaW50ZWxfZHBfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gICAJaW50ZWxfZW5jb2Rlci0+Z2V0X2NvbmZpZyA9IGludGVsX2RwX2dldF9jb25maWc7
Cj4gICAJaW50ZWxfZW5jb2Rlci0+dXBkYXRlX3BpcGUgPSBpbnRlbF9wYW5lbF91cGRhdGVfYmFj
a2xpZ2h0Owo+ICAgCWludGVsX2VuY29kZXItPnN1c3BlbmQgPSBpbnRlbF9kcF9lbmNvZGVyX3N1
c3BlbmQ7Cj4gLQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiArCWlmIChJU19DSEVS
UllWSUVXKGk5MTUpKSB7Cj4gICAJCWludGVsX2VuY29kZXItPnByZV9wbGxfZW5hYmxlID0gY2h2
X2RwX3ByZV9wbGxfZW5hYmxlOwo+ICAgCQlpbnRlbF9lbmNvZGVyLT5wcmVfZW5hYmxlID0gY2h2
X3ByZV9lbmFibGVfZHA7Cj4gICAJCWludGVsX2VuY29kZXItPmVuYWJsZSA9IHZsdl9lbmFibGVf
ZHA7Cj4gICAJCWludGVsX2VuY29kZXItPmRpc2FibGUgPSB2bHZfZGlzYWJsZV9kcDsKPiAgIAkJ
aW50ZWxfZW5jb2Rlci0+cG9zdF9kaXNhYmxlID0gY2h2X3Bvc3RfZGlzYWJsZV9kcDsKPiAgIAkJ
aW50ZWxfZW5jb2Rlci0+cG9zdF9wbGxfZGlzYWJsZSA9IGNodl9kcF9wb3N0X3BsbF9kaXNhYmxl
Owo+IC0JfSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkgewo+ICsJfSBlbHNlIGlm
IChJU19WQUxMRVlWSUVXKGk5MTUpKSB7Cj4gICAJCWludGVsX2VuY29kZXItPnByZV9wbGxfZW5h
YmxlID0gdmx2X2RwX3ByZV9wbGxfZW5hYmxlOwo+ICAgCQlpbnRlbF9lbmNvZGVyLT5wcmVfZW5h
YmxlID0gdmx2X3ByZV9lbmFibGVfZHA7Cj4gICAJCWludGVsX2VuY29kZXItPmVuYWJsZSA9IHZs
dl9lbmFibGVfZHA7Cj4gQEAgLTc1MDAsNyArNzUwMCw3IEBAIGJvb2wgaW50ZWxfZHBfaW5pdChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAKPiAgIAlpbnRlbF9lbmNvZGVy
LT50eXBlID0gSU5URUxfT1VUUFVUX0RQOwo+ICAgCWludGVsX2VuY29kZXItPnBvd2VyX2RvbWFp
biA9IGludGVsX3BvcnRfdG9fcG93ZXJfZG9tYWluKHBvcnQpOwo+IC0JaWYgKElTX0NIRVJSWVZJ
RVcoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkgewo+ICAgCQlpZiAo
cG9ydCA9PSBQT1JUX0QpCj4gICAJCQlpbnRlbF9lbmNvZGVyLT5jcnRjX21hc2sgPSAxIDw8IDI7
Cj4gICAJCWVsc2UKPiBAQCAtNzUxNiw3ICs3NTE2LDcgQEAgYm9vbCBpbnRlbF9kcF9pbml0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlpZiAocG9ydCAhPSBQT1JUX0Ep
Cj4gICAJCWludGVsX2luZm9mcmFtZV9pbml0KGludGVsX2RpZ19wb3J0KTsKPiAgIAo+IC0JaW50
ZWxfZGlnX3BvcnQtPmF1eF9jaCA9IGludGVsX2Jpb3NfcG9ydF9hdXhfY2goZGV2X3ByaXYsIHBv
cnQpOwo+ICsJaW50ZWxfZGlnX3BvcnQtPmF1eF9jaCA9IGludGVsX2Jpb3NfcG9ydF9hdXhfY2go
aTkxNSwgcG9ydCk7Cj4gICAJaWYgKCFpbnRlbF9kcF9pbml0X2Nvbm5lY3RvcihpbnRlbF9kaWdf
cG9ydCwgaW50ZWxfY29ubmVjdG9yKSkKPiAgIAkJZ290byBlcnJfaW5pdF9jb25uZWN0b3I7Cj4g
ICAKPiBAQCAtNzUzMSwxMSArNzUzMSwxMSBAQCBib29sIGludGVsX2RwX2luaXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCXJldHVybiBmYWxzZTsKPiAgIH0KPiAgIAo+
IC12b2lkIGludGVsX2RwX21zdF9zdXNwZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiArdm9pZCBpbnRlbF9kcF9tc3Rfc3VzcGVuZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcjsKPiAgIAo+
IC0JZm9yX2VhY2hfaW50ZWxfZW5jb2RlcigmZGV2X3ByaXYtPmRybSwgZW5jb2Rlcikgewo+ICsJ
Zm9yX2VhY2hfaW50ZWxfZW5jb2RlcigmaTkxNS0+ZHJtLCBlbmNvZGVyKSB7Cj4gICAJCXN0cnVj
dCBpbnRlbF9kcCAqaW50ZWxfZHA7Cj4gICAKPiAgIAkJaWYgKGVuY29kZXItPnR5cGUgIT0gSU5U
RUxfT1VUUFVUX0RESSkKPiBAQCAtNzU1MSwxMSArNzU1MSwxMSBAQCB2b2lkIGludGVsX2RwX21z
dF9zdXNwZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAl9Cj4gICB9
Cj4gICAKPiAtdm9pZCBpbnRlbF9kcF9tc3RfcmVzdW1lKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiArdm9pZCBpbnRlbF9kcF9tc3RfcmVzdW1lKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyOwo+
ICAgCj4gLQlmb3JfZWFjaF9pbnRlbF9lbmNvZGVyKCZkZXZfcHJpdi0+ZHJtLCBlbmNvZGVyKSB7
Cj4gKwlmb3JfZWFjaF9pbnRlbF9lbmNvZGVyKCZpOTE1LT5kcm0sIGVuY29kZXIpIHsKPiAgIAkJ
c3RydWN0IGludGVsX2RwICppbnRlbF9kcDsKPiAgIAkJaW50IHJldDsKPiAgIAo+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfZHAuaAo+IGluZGV4IGRhNzBiMWE0MWM4My4uYjZmZWNiMTg1YjIzIDEwMDY0NAo+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RwLmgKPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF9kcC5oCj4gQEAgLTM1LDEwICszNSwxMCBAQCB2b2lkIGludGVsX2Rw
X2FkanVzdF9jb21wbGlhbmNlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ICAg
Ym9vbCBpbnRlbF9kcF9saW1pdGVkX2NvbG9yX3JhbmdlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCQkJCSAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jf
c3RhdGUgKmNvbm5fc3RhdGUpOwo+ICAgaW50IGludGVsX2RwX21pbl9icHAoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpOwo+IC1ib29sIGludGVsX2RwX3BvcnRfZW5h
YmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2Jvb2wgaW50ZWxfZHBf
cG9ydF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgaTkx
NV9yZWdfdCBkcF9yZWcsIGVudW0gcG9ydCBwb3J0LAo+ICAgCQkJICAgZW51bSBwaXBlICpwaXBl
KTsKPiAtYm9vbCBpbnRlbF9kcF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwgaTkxNV9yZWdfdCBvdXRwdXRfcmVnLAo+ICtib29sIGludGVsX2RwX2luaXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsIGk5MTVfcmVnX3Qgb3V0cHV0X3JlZywKPiAgIAkJICAgZW51
bSBwb3J0IHBvcnQpOwo+ICAgYm9vbCBpbnRlbF9kcF9pbml0X2Nvbm5lY3RvcihzdHJ1Y3QgaW50
ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCwKPiAgIAkJCSAgICAgc3RydWN0IGludGVs
X2Nvbm5lY3RvciAqaW50ZWxfY29ubmVjdG9yKTsKPiBAQCAtNjAsNyArNjAsNyBAQCBpbnQgaW50
ZWxfZHBfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJ
CQkgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ICAgCQkJICAgIHN0
cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKTsKPiAgIGJvb2wgaW50ZWxfZHBf
aXNfZWRwKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApOwo+IC1ib29sIGludGVsX2RwX2lzX3Bv
cnRfZWRwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBvcnQp
Owo+ICtib29sIGludGVsX2RwX2lzX3BvcnRfZWRwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LCBlbnVtIHBvcnQgcG9ydCk7Cj4gICBlbnVtIGlycXJldHVybiBpbnRlbF9kcF9ocGRfcHVs
c2Uoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCj4gICAJCQkJICBi
b29sIGxvbmdfaHBkKTsKPiAgIHZvaWQgaW50ZWxfZWRwX2JhY2tsaWdodF9vbihjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiBAQCAtNjksMjEgKzY5LDIxIEBAIHZv
aWQgaW50ZWxfZWRwX2JhY2tsaWdodF9vZmYoY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3Rh
dGUgKmNvbm5fc3RhdGUpOwo+ICAgdm9pZCBpbnRlbF9lZHBfcGFuZWxfdmRkX29uKHN0cnVjdCBp
bnRlbF9kcCAqaW50ZWxfZHApOwo+ICAgdm9pZCBpbnRlbF9lZHBfcGFuZWxfb24oc3RydWN0IGlu
dGVsX2RwICppbnRlbF9kcCk7Cj4gICB2b2lkIGludGVsX2VkcF9wYW5lbF9vZmYoc3RydWN0IGlu
dGVsX2RwICppbnRlbF9kcCk7Cj4gLXZvaWQgaW50ZWxfZHBfbXN0X3N1c3BlbmQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtdm9pZCBpbnRlbF9kcF9tc3RfcmVzdW1lKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gK3ZvaWQgaW50ZWxfZHBfbXN0X3N1
c3BlbmQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lkIGludGVsX2RwX21z
dF9yZXN1bWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgaW50IGludGVsX2Rw
X21heF9saW5rX3JhdGUoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCk7Cj4gICBpbnQgaW50ZWxf
ZHBfbWF4X2xhbmVfY291bnQoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCk7Cj4gICBpbnQgaW50
ZWxfZHBfcmF0ZV9zZWxlY3Qoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwgaW50IHJhdGUpOwo+
IC12b2lkIGludGVsX3Bvd2VyX3NlcXVlbmNlcl9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpOwo+ICt2b2lkIGludGVsX3Bvd2VyX3NlcXVlbmNlcl9yZXNldChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICB1MzIgaW50ZWxfZHBfcGFja19hdXgoY29uc3Qg
dTggKnNyYywgaW50IHNyY19ieXRlcyk7Cj4gICAKPiAgIHZvaWQgaW50ZWxfZWRwX2RycnNfZW5h
YmxlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gICAJCQkgICBjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7Cj4gICB2b2lkIGludGVsX2VkcF9kcnJzX2Rpc2Fi
bGUoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiAgIAkJCSAgICBjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7Cj4gLXZvaWQgaW50ZWxfZWRwX2RycnNfaW52YWxp
ZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3ZvaWQgaW50ZWxfZWRw
X2RycnNfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAg
ICAgICB1bnNpZ25lZCBpbnQgZnJvbnRidWZmZXJfYml0cyk7Cj4gLXZvaWQgaW50ZWxfZWRwX2Ry
cnNfZmx1c2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICt2b2lkIGludGVs
X2VkcF9kcnJzX2ZsdXNoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICB1
bnNpZ25lZCBpbnQgZnJvbnRidWZmZXJfYml0cyk7Cj4gICAKPiAgIHZvaWQKPiBAQCAtMTEyLDcg
KzExMiw3IEBAIGJvb2wgaW50ZWxfZHBfZ2V0X2NvbG9yaW1ldHJ5X3N0YXR1cyhzdHJ1Y3QgaW50
ZWxfZHAgKmludGVsX2RwKTsKPiAgIGludCBpbnRlbF9kcF9saW5rX3JlcXVpcmVkKGludCBwaXhl
bF9jbG9jaywgaW50IGJwcCk7Cj4gICBpbnQgaW50ZWxfZHBfbWF4X2RhdGFfcmF0ZShpbnQgbWF4
X2xpbmtfY2xvY2ssIGludCBtYXhfbGFuZXMpOwo+ICAgYm9vbCBpbnRlbF9kaWdpdGFsX3BvcnRf
Y29ubmVjdGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKTsKPiAtdm9pZCBpY2xfdGNf
cGh5X2Rpc2Nvbm5lY3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICt2b2lk
IGljbF90Y19waHlfZGlzY29ubmVjdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAg
IAkJCSAgIHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KTsKPiAgIAo+ICAgc3Rh
dGljIGlubGluZSB1bnNpZ25lZCBpbnQgaW50ZWxfZHBfdW51c2VkX2xhbmVfbWFzayhpbnQgbGFu
ZV9jb3VudCkKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHBfYXV4
X2JhY2tsaWdodC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHBfYXV4X2JhY2tsaWdo
dC5jCj4gaW5kZXggN2RlZDk1YTMzNGRiLi43YTNiZDI5ZGNmMGIgMTAwNjQ0Cj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHBfYXV4X2JhY2tsaWdodC5jCj4gKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfZHBfYXV4X2JhY2tsaWdodC5jCj4gQEAgLTEwOSw3ICsxMDks
NyBAQCBpbnRlbF9kcF9hdXhfc2V0X2JhY2tsaWdodChjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
cl9zdGF0ZSAqY29ubl9zdGF0ZSwgdTMyIGxldgo+ICAgICovCj4gICBzdGF0aWMgYm9vbCBpbnRl
bF9kcF9hdXhfc2V0X3B3bV9mcmVxKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikK
PiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29u
bmVjdG9yLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2RwICppbnRlbF9k
cCA9IGVuY190b19pbnRlbF9kcCgmY29ubmVjdG9yLT5lbmNvZGVyLT5iYXNlKTsKPiAgIAlpbnQg
ZnJlcSwgZnhwLCBmeHBfbWluLCBmeHBfbWF4LCBmeHBfYWN0dWFsLCBmID0gMTsKPiAgIAl1OCBw
biwgcG5fbWluLCBwbl9tYXg7Cj4gQEAgLTExOCw3ICsxMTgsNyBAQCBzdGF0aWMgYm9vbCBpbnRl
bF9kcF9hdXhfc2V0X3B3bV9mcmVxKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikK
PiAgIAkgKiBOb3RlIHRoYXQsIGlmIEYgeCBQIGlzIG91dCBvZiBzdXBwb3J0ZWQgcmFuZ2UsIHRo
ZSBtYXhpbXVtIHZhbHVlIG9yCj4gICAJICogbWluaW11bSB2YWx1ZSB3aWxsIGFwcGxpZWQgYXV0
b21hdGljYWxseS4gU28gbm8gbmVlZCB0byBjaGVjayB0aGF0Lgo+ICAgCSAqLwo+IC0JZnJlcSA9
IGRldl9wcml2LT52YnQuYmFja2xpZ2h0LnB3bV9mcmVxX2h6Owo+ICsJZnJlcSA9IGk5MTUtPnZi
dC5iYWNrbGlnaHQucHdtX2ZyZXFfaHo7Cj4gICAJRFJNX0RFQlVHX0tNUygiVkJUIGRlZmluZWQg
YmFja2xpZ2h0IGZyZXF1ZW5jeSAldSBIelxuIiwgZnJlcSk7Cj4gICAJaWYgKCFmcmVxKSB7Cj4g
ICAJCURSTV9ERUJVR19LTVMoIlVzZSBwYW5lbCBkZWZhdWx0IGJhY2tsaWdodCBmcmVxdWVuY3lc
biIpOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcF9tc3QuYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RwX21zdC5jCj4gaW5kZXggMGNhZjY0NWZiYmI4
Li5hYjIxZGM2OTBjOWYgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
ZHBfbXN0LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcF9tc3QuYwo+IEBA
IC05MSw3ICs5MSw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfZHBfbXN0X2NvbXB1dGVfY29uZmlnKHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCSAgICAgICBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4gICAJCQkJICAgICAgIHN0cnVjdCBkcm1fY29ubmVj
dG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVj
dCBpbnRlbF9kcF9tc3RfZW5jb2RlciAqaW50ZWxfbXN0ID0gZW5jX3RvX21zdCgmZW5jb2Rlci0+
YmFzZSk7Cj4gICAJc3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9ICZpbnRlbF9tc3QtPnByaW1h
cnktPmRwOwo+ICAgCXN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciA9Cj4gQEAgLTE0
MCwxMSArMTQwLDExIEBAIHN0YXRpYyBpbnQgaW50ZWxfZHBfbXN0X2NvbXB1dGVfY29uZmlnKHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCXBpcGVfY29uZmlnLT5saW1pdGVkX2Nv
bG9yX3JhbmdlID0KPiAgIAkJaW50ZWxfZHBfbGltaXRlZF9jb2xvcl9yYW5nZShwaXBlX2NvbmZp
ZywgY29ubl9zdGF0ZSk7Cj4gICAKPiAtCWlmIChJU19HRU45X0xQKGRldl9wcml2KSkKPiArCWlm
IChJU19HRU45X0xQKGk5MTUpKQo+ICAgCQlwaXBlX2NvbmZpZy0+bGFuZV9sYXRfb3B0aW1fbWFz
ayA9Cj4gICAJCQlieHRfZGRpX3BoeV9jYWxjX2xhbmVfbGF0X29wdGltX21hc2socGlwZV9jb25m
aWctPmxhbmVfY291bnQpOwo+ICAgCj4gLQlpbnRlbF9kZGlfY29tcHV0ZV9taW5fdm9sdGFnZV9s
ZXZlbChkZXZfcHJpdiwgcGlwZV9jb25maWcpOwo+ICsJaW50ZWxfZGRpX2NvbXB1dGVfbWluX3Zv
bHRhZ2VfbGV2ZWwoaTkxNSwgcGlwZV9jb25maWcpOwo+ICAgCj4gICAJcmV0dXJuIDA7Cj4gICB9
Cj4gQEAgLTI4NSw3ICsyODUsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9tc3RfcHJlX2VuYWJsZV9k
cChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAlzdHJ1Y3QgaW50ZWxfZHBfbXN0
X2VuY29kZXIgKmludGVsX21zdCA9IGVuY190b19tc3QoJmVuY29kZXItPmJhc2UpOwo+ICAgCXN0
cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0ID0gaW50ZWxfbXN0LT5wcmlt
YXJ5Owo+ICAgCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSAmaW50ZWxfZGlnX3BvcnQtPmRw
Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVy
LT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
ZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCWVudW0gcG9ydCBwb3J0ID0gaW50ZWxfZGlnX3BvcnQt
PmJhc2UucG9ydDsKPiAgIAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IgPQo+ICAg
CQl0b19pbnRlbF9jb25uZWN0b3IoY29ubl9zdGF0ZS0+Y29ubmVjdG9yKTsKPiBAQCAtMzMyLDEy
ICszMzIsMTIgQEAgc3RhdGljIHZvaWQgaW50ZWxfbXN0X2VuYWJsZV9kcChzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKPiAgIAlzdHJ1Y3QgaW50ZWxfZHBfbXN0X2VuY29kZXIgKmludGVs
X21zdCA9IGVuY190b19tc3QoJmVuY29kZXItPmJhc2UpOwo+ICAgCXN0cnVjdCBpbnRlbF9kaWdp
dGFsX3BvcnQgKmludGVsX2RpZ19wb3J0ID0gaW50ZWxfbXN0LT5wcmltYXJ5Owo+ICAgCXN0cnVj
dCBpbnRlbF9kcCAqaW50ZWxfZHAgPSAmaW50ZWxfZGlnX3BvcnQtPmRwOwo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5k
ZXYpOwo+ICAgCWVudW0gcG9ydCBwb3J0ID0gaW50ZWxfZGlnX3BvcnQtPmJhc2UucG9ydDsKPiAg
IAo+ICAgCURSTV9ERUJVR19LTVMoImFjdGl2ZSBsaW5rcyAlZFxuIiwgaW50ZWxfZHAtPmFjdGl2
ZV9tc3RfbGlua3MpOwo+ICAgCj4gLQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9w
cml2LT51bmNvcmUsCj4gKwlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29y
ZSwKPiAgIAkJCQkgICAgRFBfVFBfU1RBVFVTKHBvcnQpLAo+ICAgCQkJCSAgICBEUF9UUF9TVEFU
VVNfQUNUX1NFTlQsCj4gICAJCQkJICAgIERQX1RQX1NUQVRVU19BQ1RfU0VOVCwKPiBAQCAtNDk1
LDcgKzQ5NSw3IEBAIHN0YXRpYyBzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqaW50ZWxfZHBfYWRkX21z
dF9jb25uZWN0b3Ioc3RydWN0IGRybV9kcF9tc3RfdG9wb2xvCj4gICAJc3RydWN0IGludGVsX2Rw
ICppbnRlbF9kcCA9IGNvbnRhaW5lcl9vZihtZ3IsIHN0cnVjdCBpbnRlbF9kcCwgbXN0X21ncik7
Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQgPSBkcF90b19k
aWdfcG9ydChpbnRlbF9kcCk7Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGludGVsX2Rp
Z19wb3J0LT5iYXNlLmJhc2UuZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGRldik7Cj4gICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqaW50ZWxfY29ubmVjdG9y
Owo+ICAgCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3I7Cj4gICAJZW51bSBwaXBlIHBp
cGU7Cj4gQEAgLTUyMCw3ICs1MjAsNyBAQCBzdGF0aWMgc3RydWN0IGRybV9jb25uZWN0b3IgKmlu
dGVsX2RwX2FkZF9tc3RfY29ubmVjdG9yKHN0cnVjdCBkcm1fZHBfbXN0X3RvcG9sbwo+ICAgCj4g
ICAJZHJtX2Nvbm5lY3Rvcl9oZWxwZXJfYWRkKGNvbm5lY3RvciwgJmludGVsX2RwX21zdF9jb25u
ZWN0b3JfaGVscGVyX2Z1bmNzKTsKPiAgIAo+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlw
ZSkgewo+ICsJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKSB7Cj4gICAJCXN0cnVjdCBkcm1fZW5j
b2RlciAqZW5jID0KPiAgIAkJCSZpbnRlbF9kcC0+bXN0X2VuY29kZXJzW3BpcGVdLT5iYXNlLmJh
c2U7Cj4gICAKPiBAQCAtNTQ5LDEwICs1NDksMTAgQEAgc3RhdGljIHN0cnVjdCBkcm1fY29ubmVj
dG9yICppbnRlbF9kcF9hZGRfbXN0X2Nvbm5lY3RvcihzdHJ1Y3QgZHJtX2RwX21zdF90b3BvbG8K
PiAgIAo+ICAgc3RhdGljIHZvaWQgaW50ZWxfZHBfcmVnaXN0ZXJfbXN0X2Nvbm5lY3RvcihzdHJ1
Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmRldik7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOwo+ICAgCj4gLQlp
ZiAoZGV2X3ByaXYtPmZiZGV2KQo+IC0JCWRybV9mYl9oZWxwZXJfYWRkX29uZV9jb25uZWN0b3Io
JmRldl9wcml2LT5mYmRldi0+aGVscGVyLAo+ICsJaWYgKGk5MTUtPmZiZGV2KQo+ICsJCWRybV9m
Yl9oZWxwZXJfYWRkX29uZV9jb25uZWN0b3IoJmk5MTUtPmZiZGV2LT5oZWxwZXIsCj4gICAJCQkJ
CQljb25uZWN0b3IpOwo+ICAgCj4gICAJZHJtX2Nvbm5lY3Rvcl9yZWdpc3Rlcihjb25uZWN0b3Ip
Owo+IEBAIC01NjEsMTMgKzU2MSwxMyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kcF9yZWdpc3Rlcl9t
c3RfY29ubmVjdG9yKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCj4gICBzdGF0aWMg
dm9pZCBpbnRlbF9kcF9kZXN0cm95X21zdF9jb25uZWN0b3Ioc3RydWN0IGRybV9kcF9tc3RfdG9w
b2xvZ3lfbWdyICptZ3IsCj4gICAJCQkJCSAgIHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0
b3IpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGNvbm5lY3Rvci0+ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShjb25uZWN0b3ItPmRldik7Cj4gICAKPiAgIAlEUk1fREVCVUdfS01TKCJbQ09OTkVDVE9S
OiVkOiVzXVxuIiwgY29ubmVjdG9yLT5iYXNlLmlkLCBjb25uZWN0b3ItPm5hbWUpOwo+ICAgCWRy
bV9jb25uZWN0b3JfdW5yZWdpc3Rlcihjb25uZWN0b3IpOwo+ICAgCj4gLQlpZiAoZGV2X3ByaXYt
PmZiZGV2KQo+IC0JCWRybV9mYl9oZWxwZXJfcmVtb3ZlX29uZV9jb25uZWN0b3IoJmRldl9wcml2
LT5mYmRldi0+aGVscGVyLAo+ICsJaWYgKGk5MTUtPmZiZGV2KQo+ICsJCWRybV9mYl9oZWxwZXJf
cmVtb3ZlX29uZV9jb25uZWN0b3IoJmk5MTUtPmZiZGV2LT5oZWxwZXIsCj4gICAJCQkJCQkgICBj
b25uZWN0b3IpOwo+ICAgCj4gICAJZHJtX2Nvbm5lY3Rvcl9wdXQoY29ubmVjdG9yKTsKPiBAQCAt
NjIyLDEwICs2MjIsMTAgQEAgc3RhdGljIGJvb2wKPiAgIGludGVsX2RwX2NyZWF0ZV9mYWtlX21z
dF9lbmNvZGVycyhzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCkKPiAg
IHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gJmludGVsX2RpZ19wb3J0LT5kcDsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoaW50ZWxfZGln
X3BvcnQtPmJhc2UuYmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGludGVsX2RpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsKPiAgIAllbnVtIHBpcGUg
cGlwZTsKPiAgIAo+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkKPiArCWZvcl9lYWNo
X3BpcGUoaTkxNSwgcGlwZSkKPiAgIAkJaW50ZWxfZHAtPm1zdF9lbmNvZGVyc1twaXBlXSA9IGlu
dGVsX2RwX2NyZWF0ZV9mYWtlX21zdF9lbmNvZGVyKGludGVsX2RpZ19wb3J0LCBwaXBlKTsKPiAg
IAlyZXR1cm4gdHJ1ZTsKPiAgIH0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfZHBpb19waHkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RwaW9fcGh5LmMK
PiBpbmRleCBiZGJlNDE3NTk4MjcuLmM4NTY3MmJiMWE3ZCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9kcGlvX3BoeS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfZHBpb19waHkuYwo+IEBAIC0yMTIsOSArMjEyLDkgQEAgc3RhdGljIGNvbnN0IHN0
cnVjdCBieHRfZGRpX3BoeV9pbmZvIGdsa19kZGlfcGh5X2luZm9bXSA9IHsKPiAgIH07Cj4gICAK
PiAgIHN0YXRpYyBjb25zdCBzdHJ1Y3QgYnh0X2RkaV9waHlfaW5mbyAqCj4gLWJ4dF9nZXRfcGh5
X2xpc3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgKmNvdW50KQo+ICti
eHRfZ2V0X3BoeV9saXN0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBpbnQgKmNvdW50
KQo+ICAgewo+IC0JaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfR0VN
SU5JTEFLRShpOTE1KSkgewo+ICAgCQkqY291bnQgPSAgQVJSQVlfU0laRShnbGtfZGRpX3BoeV9p
bmZvKTsKPiAgIAkJcmV0dXJuIGdsa19kZGlfcGh5X2luZm87Cj4gICAJfSBlbHNlIHsKPiBAQCAt
MjI0LDIyICsyMjQsMjIgQEAgYnh0X2dldF9waHlfbGlzdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsIGludCAqY291bnQpCj4gICB9Cj4gICAKPiAgIHN0YXRpYyBjb25zdCBzdHJ1
Y3QgYnh0X2RkaV9waHlfaW5mbyAqCj4gLWJ4dF9nZXRfcGh5X2luZm8oc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIGRwaW9fcGh5IHBoeSkKPiArYnh0X2dldF9waHlfaW5m
byhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBkcGlvX3BoeSBwaHkpCj4gICB7
Cj4gICAJaW50IGNvdW50Owo+ICAgCWNvbnN0IHN0cnVjdCBieHRfZGRpX3BoeV9pbmZvICpwaHlf
bGlzdCA9Cj4gLQkJYnh0X2dldF9waHlfbGlzdChkZXZfcHJpdiwgJmNvdW50KTsKPiArCQlieHRf
Z2V0X3BoeV9saXN0KGk5MTUsICZjb3VudCk7Cj4gICAKPiAgIAlyZXR1cm4gJnBoeV9saXN0W3Bo
eV07Cj4gICB9Cj4gICAKPiAtdm9pZCBieHRfcG9ydF90b19waHlfY2hhbm5lbChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcG9ydCBwb3J0LAo+ICt2b2lkIGJ4dF9wb3J0
X3RvX3BoeV9jaGFubmVsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBvcnQg
cG9ydCwKPiAgIAkJCSAgICAgZW51bSBkcGlvX3BoeSAqcGh5LCBlbnVtIGRwaW9fY2hhbm5lbCAq
Y2gpCj4gICB7Cj4gICAJY29uc3Qgc3RydWN0IGJ4dF9kZGlfcGh5X2luZm8gKnBoeV9pbmZvLCAq
cGh5czsKPiAgIAlpbnQgaSwgY291bnQ7Cj4gICAKPiAtCXBoeXMgPSBieHRfZ2V0X3BoeV9saXN0
KGRldl9wcml2LCAmY291bnQpOwo+ICsJcGh5cyA9IGJ4dF9nZXRfcGh5X2xpc3QoaTkxNSwgJmNv
dW50KTsKPiAgIAo+ICAgCWZvciAoaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7Cj4gICAJCXBoeV9p
bmZvID0gJnBoeXNbaV07Cj4gQEAgLTI2Myw3ICsyNjMsNyBAQCB2b2lkIGJ4dF9wb3J0X3RvX3Bo
eV9jaGFubmVsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBv
cnQsCj4gICAJKmNoID0gRFBJT19DSDA7Cj4gICB9Cj4gICAKPiAtdm9pZCBieHRfZGRpX3BoeV9z
ZXRfc2lnbmFsX2xldmVsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArdm9p
ZCBieHRfZGRpX3BoeV9zZXRfc2lnbmFsX2xldmVsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ICAgCQkJCSAgZW51bSBwb3J0IHBvcnQsIHUzMiBtYXJnaW4sIHUzMiBzY2FsZSwKPiAg
IAkJCQkgIHUzMiBlbmFibGUsIHUzMiBkZWVtcGhhc2lzKQo+ICAgewo+IEBAIC0yNzEsNyArMjcx
LDcgQEAgdm9pZCBieHRfZGRpX3BoeV9zZXRfc2lnbmFsX2xldmVsKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiAgIAllbnVtIGRwaW9fcGh5IHBoeTsKPiAgIAllbnVtIGRwaW9f
Y2hhbm5lbCBjaDsKPiAgIAo+IC0JYnh0X3BvcnRfdG9fcGh5X2NoYW5uZWwoZGV2X3ByaXYsIHBv
cnQsICZwaHksICZjaCk7Cj4gKwlieHRfcG9ydF90b19waHlfY2hhbm5lbChpOTE1LCBwb3J0LCAm
cGh5LCAmY2gpOwo+ICAgCj4gICAJLyoKPiAgIAkgKiBXaGlsZSB3ZSB3cml0ZSB0byB0aGUgZ3Jv
dXAgcmVnaXN0ZXIgdG8gcHJvZ3JhbSBhbGwgbGFuZXMgYXQgb25jZSB3ZQo+IEBAIC0zMDYsMTIg
KzMwNiwxMiBAQCB2b2lkIGJ4dF9kZGlfcGh5X3NldF9zaWduYWxfbGV2ZWwoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCUk5MTVfV1JJVEUoQlhUX1BPUlRfUENTX0RXMTBf
R1JQKHBoeSwgY2gpLCB2YWwpOwo+ICAgfQo+ICAgCj4gLWJvb2wgYnh0X2RkaV9waHlfaXNfZW5h
YmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2Jvb2wgYnh0X2RkaV9w
aHlfaXNfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICBl
bnVtIGRwaW9fcGh5IHBoeSkKPiAgIHsKPiAgIAljb25zdCBzdHJ1Y3QgYnh0X2RkaV9waHlfaW5m
byAqcGh5X2luZm87Cj4gICAKPiAtCXBoeV9pbmZvID0gYnh0X2dldF9waHlfaW5mbyhkZXZfcHJp
diwgcGh5KTsKPiArCXBoeV9pbmZvID0gYnh0X2dldF9waHlfaW5mbyhpOTE1LCBwaHkpOwo+ICAg
Cj4gICAJaWYgKCEoSTkxNV9SRUFEKEJYVF9QX0NSX0dUX0RJU1BfUFdST04pICYgcGh5X2luZm8t
PnB3cm9uX21hc2spKQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gQEAgLTMzNCwzNyArMzM0LDM3IEBA
IGJvb2wgYnh0X2RkaV9waHlfaXNfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gICAJcmV0dXJuIHRydWU7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHUzMiBieHRfZ2V0
X2dyYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gZHBpb19waHkgcGh5
KQo+ICtzdGF0aWMgdTMyIGJ4dF9nZXRfZ3JjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LCBlbnVtIGRwaW9fcGh5IHBoeSkKPiAgIHsKPiAgIAl1MzIgdmFsID0gSTkxNV9SRUFEKEJYVF9Q
T1JUX1JFRl9EVzYocGh5KSk7Cj4gICAKPiAgIAlyZXR1cm4gKHZhbCAmIEdSQ19DT0RFX01BU0sp
ID4+IEdSQ19DT0RFX1NISUZUOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGJ4dF9waHlfd2Fp
dF9ncmNfZG9uZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2
b2lkIGJ4dF9waHlfd2FpdF9ncmNfZG9uZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
PiAgIAkJCQkgIGVudW0gZHBpb19waHkgcGh5KQo+ICAgewo+IC0JaWYgKGludGVsX3dhaXRfZm9y
X3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLAo+ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lz
dGVyKCZpOTE1LT51bmNvcmUsCj4gICAJCQkJICAgIEJYVF9QT1JUX1JFRl9EVzMocGh5KSwKPiAg
IAkJCQkgICAgR1JDX0RPTkUsIEdSQ19ET05FLAo+ICAgCQkJCSAgICAxMCkpCj4gICAJCURSTV9F
UlJPUigidGltZW91dCB3YWl0aW5nIGZvciBQSFklZCBHUkNcbiIsIHBoeSk7Cj4gICB9Cj4gICAK
PiAtc3RhdGljIHZvaWQgX2J4dF9kZGlfcGh5X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBfYnh0X2RkaV9waHlfaW5pdChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgIGVudW0gZHBpb19waHkgcGh5KQo+ICAgewo+
ICAgCWNvbnN0IHN0cnVjdCBieHRfZGRpX3BoeV9pbmZvICpwaHlfaW5mbzsKPiAgIAl1MzIgdmFs
Owo+ICAgCj4gLQlwaHlfaW5mbyA9IGJ4dF9nZXRfcGh5X2luZm8oZGV2X3ByaXYsIHBoeSk7Cj4g
KwlwaHlfaW5mbyA9IGJ4dF9nZXRfcGh5X2luZm8oaTkxNSwgcGh5KTsKPiAgIAo+IC0JaWYgKGJ4
dF9kZGlfcGh5X2lzX2VuYWJsZWQoZGV2X3ByaXYsIHBoeSkpIHsKPiArCWlmIChieHRfZGRpX3Bo
eV9pc19lbmFibGVkKGk5MTUsIHBoeSkpIHsKPiAgIAkJLyogU3RpbGwgcmVhZCBvdXQgdGhlIEdS
QyB2YWx1ZSBmb3Igc3RhdGUgdmVyaWZpY2F0aW9uICovCj4gICAJCWlmIChwaHlfaW5mby0+cmNv
bXBfcGh5ICE9IC0xKQo+IC0JCQlkZXZfcHJpdi0+Ynh0X3BoeV9ncmMgPSBieHRfZ2V0X2dyYyhk
ZXZfcHJpdiwgcGh5KTsKPiArCQkJaTkxNS0+Ynh0X3BoeV9ncmMgPSBieHRfZ2V0X2dyYyhpOTE1
LCBwaHkpOwo+ICAgCj4gLQkJaWYgKGJ4dF9kZGlfcGh5X3ZlcmlmeV9zdGF0ZShkZXZfcHJpdiwg
cGh5KSkgewo+ICsJCWlmIChieHRfZGRpX3BoeV92ZXJpZnlfc3RhdGUoaTkxNSwgcGh5KSkgewo+
ICAgCQkJRFJNX0RFQlVHX0RSSVZFUigiRERJIFBIWSAlZCBhbHJlYWR5IGVuYWJsZWQsICIKPiAg
IAkJCQkJICJ3b24ndCByZXByb2dyYW0gaXRcbiIsIHBoeSk7Cj4gICAJCQlyZXR1cm47Cj4gQEAg
LTM4Niw3ICszODYsNyBAQCBzdGF0aWMgdm9pZCBfYnh0X2RkaV9waHlfaW5pdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJICogVGhlIGZsYWcgc2hvdWxkIGdldCBzZXQg
aW4gMTAwdXMgYWNjb3JkaW5nIHRvIHRoZSBIVyB0ZWFtLCBidXQKPiAgIAkgKiB1c2UgMW1zIGR1
ZSB0byBvY2Nhc2lvbmFsIHRpbWVvdXRzIG9ic2VydmVkIHdpdGggdGhhdC4KPiAgIAkgKi8KPiAt
CWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3Rlcl9mdygmZGV2X3ByaXYtPnVuY29yZSwKPiArCWlm
IChpbnRlbF93YWl0X2Zvcl9yZWdpc3Rlcl9mdygmaTkxNS0+dW5jb3JlLAo+ICAgCQkJCSAgICAg
ICBCWFRfUE9SVF9DTDFDTV9EVzAocGh5KSwKPiAgIAkJCQkgICAgICAgUEhZX1JFU0VSVkVEIHwg
UEhZX1BPV0VSX0dPT0QsCj4gICAJCQkJICAgICAgIFBIWV9QT1dFUl9HT09ELAo+IEBAIC00MTks
MTQgKzQxOSwxNCBAQCBzdGF0aWMgdm9pZCBfYnh0X2RkaV9waHlfaW5pdChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJaWYgKHBoeV9pbmZvLT5yY29tcF9waHkgIT0gLTEp
IHsKPiAgIAkJdTMyIGdyY19jb2RlOwo+ICAgCj4gLQkJYnh0X3BoeV93YWl0X2dyY19kb25lKGRl
dl9wcml2LCBwaHlfaW5mby0+cmNvbXBfcGh5KTsKPiArCQlieHRfcGh5X3dhaXRfZ3JjX2RvbmUo
aTkxNSwgcGh5X2luZm8tPnJjb21wX3BoeSk7Cj4gICAKPiAgIAkJLyoKPiAgIAkJICogUEhZMCBp
c24ndCBjb25uZWN0ZWQgdG8gYW4gUkNPTVAgcmVzaXN0b3Igc28gY29weSBvdmVyCj4gICAJCSAq
IHRoZSBjb3JyZXNwb25kaW5nIGNhbGlicmF0ZWQgdmFsdWUgZnJvbSBQSFkxLCBhbmQgZGlzYWJs
ZQo+ICAgCQkgKiB0aGUgYXV0b21hdGljIGNhbGlicmF0aW9uIG9uIFBIWTAuCj4gICAJCSAqLwo+
IC0JCXZhbCA9IGRldl9wcml2LT5ieHRfcGh5X2dyYyA9IGJ4dF9nZXRfZ3JjKGRldl9wcml2LAo+
ICsJCXZhbCA9IGk5MTUtPmJ4dF9waHlfZ3JjID0gYnh0X2dldF9ncmMoaTkxNSwKPiAgIAkJCQkJ
CQkgIHBoeV9pbmZvLT5yY29tcF9waHkpOwo+ICAgCQlncmNfY29kZSA9IHZhbCA8PCBHUkNfQ09E
RV9GQVNUX1NISUZUIHwKPiAgIAkJCSAgIHZhbCA8PCBHUkNfQ09ERV9TTE9XX1NISUZUIHwKPiBA
QCAtNDQ2LDEyICs0NDYsMTIgQEAgc3RhdGljIHZvaWQgX2J4dF9kZGlfcGh5X2luaXQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCUk5MTVfV1JJVEUoQlhUX1BIWV9DVExf
RkFNSUxZKHBoeSksIHZhbCk7Cj4gICB9Cj4gICAKPiAtdm9pZCBieHRfZGRpX3BoeV91bmluaXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIGRwaW9fcGh5IHBoeSkKPiAr
dm9pZCBieHRfZGRpX3BoeV91bmluaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVu
dW0gZHBpb19waHkgcGh5KQo+ICAgewo+ICAgCWNvbnN0IHN0cnVjdCBieHRfZGRpX3BoeV9pbmZv
ICpwaHlfaW5mbzsKPiAgIAl1MzIgdmFsOwo+ICAgCj4gLQlwaHlfaW5mbyA9IGJ4dF9nZXRfcGh5
X2luZm8oZGV2X3ByaXYsIHBoeSk7Cj4gKwlwaHlfaW5mbyA9IGJ4dF9nZXRfcGh5X2luZm8oaTkx
NSwgcGh5KTsKPiAgIAo+ICAgCXZhbCA9IEk5MTVfUkVBRChCWFRfUEhZX0NUTF9GQU1JTFkocGh5
KSk7Cj4gICAJdmFsICY9IH5DT01NT05fUkVTRVRfRElTOwo+IEBAIC00NjIsMzQgKzQ2MiwzNCBA
QCB2b2lkIGJ4dF9kZGlfcGh5X3VuaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsIGVudW0gZHBpb19waHkgcGh5KQo+ICAgCUk5MTVfV1JJVEUoQlhUX1BfQ1JfR1RfRElTUF9Q
V1JPTiwgdmFsKTsKPiAgIH0KPiAgIAo+IC12b2lkIGJ4dF9kZGlfcGh5X2luaXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIGRwaW9fcGh5IHBoeSkKPiArdm9pZCBieHRf
ZGRpX3BoeV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIGRwaW9fcGh5
IHBoeSkKPiAgIHsKPiAgIAljb25zdCBzdHJ1Y3QgYnh0X2RkaV9waHlfaW5mbyAqcGh5X2luZm8g
PQo+IC0JCWJ4dF9nZXRfcGh5X2luZm8oZGV2X3ByaXYsIHBoeSk7Cj4gKwkJYnh0X2dldF9waHlf
aW5mbyhpOTE1LCBwaHkpOwo+ICAgCWVudW0gZHBpb19waHkgcmNvbXBfcGh5ID0gcGh5X2luZm8t
PnJjb21wX3BoeTsKPiAgIAlib29sIHdhc19lbmFibGVkOwo+ICAgCj4gLQlsb2NrZGVwX2Fzc2Vy
dF9oZWxkKCZkZXZfcHJpdi0+cG93ZXJfZG9tYWlucy5sb2NrKTsKPiArCWxvY2tkZXBfYXNzZXJ0
X2hlbGQoJmk5MTUtPnBvd2VyX2RvbWFpbnMubG9jayk7Cj4gICAKPiAgIAl3YXNfZW5hYmxlZCA9
IHRydWU7Cj4gICAJaWYgKHJjb21wX3BoeSAhPSAtMSkKPiAtCQl3YXNfZW5hYmxlZCA9IGJ4dF9k
ZGlfcGh5X2lzX2VuYWJsZWQoZGV2X3ByaXYsIHJjb21wX3BoeSk7Cj4gKwkJd2FzX2VuYWJsZWQg
PSBieHRfZGRpX3BoeV9pc19lbmFibGVkKGk5MTUsIHJjb21wX3BoeSk7Cj4gICAKPiAgIAkvKgo+
ICAgCSAqIFdlIG5lZWQgdG8gY29weSB0aGUgR1JDIGNhbGlicmF0aW9uIHZhbHVlIGZyb20gcmNv
bXBfcGh5LAo+ICAgCSAqIHNvIG1ha2Ugc3VyZSBpdCdzIHBvd2VyZWQgdXAuCj4gICAJICovCj4g
ICAJaWYgKCF3YXNfZW5hYmxlZCkKPiAtCQlfYnh0X2RkaV9waHlfaW5pdChkZXZfcHJpdiwgcmNv
bXBfcGh5KTsKPiArCQlfYnh0X2RkaV9waHlfaW5pdChpOTE1LCByY29tcF9waHkpOwo+ICAgCj4g
LQlfYnh0X2RkaV9waHlfaW5pdChkZXZfcHJpdiwgcGh5KTsKPiArCV9ieHRfZGRpX3BoeV9pbml0
KGk5MTUsIHBoeSk7Cj4gICAKPiAgIAlpZiAoIXdhc19lbmFibGVkKQo+IC0JCWJ4dF9kZGlfcGh5
X3VuaW5pdChkZXZfcHJpdiwgcmNvbXBfcGh5KTsKPiArCQlieHRfZGRpX3BoeV91bmluaXQoaTkx
NSwgcmNvbXBfcGh5KTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGJvb2wgX19wcmludGYoNiwgNykK
PiAtX19waHlfcmVnX3ZlcmlmeV9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsIGVudW0gZHBpb19waHkgcGh5LAo+ICtfX3BoeV9yZWdfdmVyaWZ5X3N0YXRlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIGRwaW9fcGh5IHBoeSwKPiAgIAkJICAgICAgIGk5
MTVfcmVnX3QgcmVnLCB1MzIgbWFzaywgdTMyIGV4cGVjdGVkLAo+ICAgCQkgICAgICAgY29uc3Qg
Y2hhciAqcmVnX2ZtdCwgLi4uKQo+ICAgewo+IEBAIC01MTUsMjAgKzUxNSwyMCBAQCBfX3BoeV9y
ZWdfdmVyaWZ5X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBk
cGlvX3BoeSBwaHksCj4gICAJcmV0dXJuIGZhbHNlOwo+ICAgfQo+ICAgCj4gLWJvb2wgYnh0X2Rk
aV9waHlfdmVyaWZ5X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAr
Ym9vbCBieHRfZGRpX3BoeV92ZXJpZnlfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gICAJCQkgICAgICBlbnVtIGRwaW9fcGh5IHBoeSkKPiAgIHsKPiAgIAljb25zdCBzdHJ1
Y3QgYnh0X2RkaV9waHlfaW5mbyAqcGh5X2luZm87Cj4gICAJdTMyIG1hc2s7Cj4gICAJYm9vbCBv
azsKPiAgIAo+IC0JcGh5X2luZm8gPSBieHRfZ2V0X3BoeV9pbmZvKGRldl9wcml2LCBwaHkpOwo+
ICsJcGh5X2luZm8gPSBieHRfZ2V0X3BoeV9pbmZvKGk5MTUsIHBoeSk7Cj4gICAKPiAgICNkZWZp
bmUgX0NISyhyZWcsIG1hc2ssIGV4cCwgZm10LCAuLi4pCQkJCQlcCj4gLQlfX3BoeV9yZWdfdmVy
aWZ5X3N0YXRlKGRldl9wcml2LCBwaHksIHJlZywgbWFzaywgZXhwLCBmbXQsCVwKPiArCV9fcGh5
X3JlZ192ZXJpZnlfc3RhdGUoaTkxNSwgcGh5LCByZWcsIG1hc2ssIGV4cCwgZm10LAlcCj4gICAJ
CQkgICAgICAgIyMgX19WQV9BUkdTX18pCj4gICAKPiAtCWlmICghYnh0X2RkaV9waHlfaXNfZW5h
YmxlZChkZXZfcHJpdiwgcGh5KSkKPiArCWlmICghYnh0X2RkaV9waHlfaXNfZW5hYmxlZChpOTE1
LCBwaHkpKQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gICAKPiAgIAlvayA9IHRydWU7Cj4gQEAgLTU1
Miw3ICs1NTIsNyBAQCBib29sIGJ4dF9kZGlfcGh5X3ZlcmlmeV9zdGF0ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJCQkgICAiQlhUX1BPUlRfQ0wyQ01fRFc2KCVkKSIs
IHBoeSk7Cj4gICAKPiAgIAlpZiAocGh5X2luZm8tPnJjb21wX3BoeSAhPSAtMSkgewo+IC0JCXUz
MiBncmNfY29kZSA9IGRldl9wcml2LT5ieHRfcGh5X2dyYzsKPiArCQl1MzIgZ3JjX2NvZGUgPSBp
OTE1LT5ieHRfcGh5X2dyYzsKPiAgIAo+ICAgCQlncmNfY29kZSA9IGdyY19jb2RlIDw8IEdSQ19D
T0RFX0ZBU1RfU0hJRlQgfAo+ICAgCQkJICAgZ3JjX2NvZGUgPDwgR1JDX0NPREVfU0xPV19TSElG
VCB8Cj4gQEAgLTU5MSwxMyArNTkxLDEzIEBAIGJ4dF9kZGlfcGh5X2NhbGNfbGFuZV9sYXRfb3B0
aW1fbWFzayh1OCBsYW5lX2NvdW50KQo+ICAgdm9pZCBieHRfZGRpX3BoeV9zZXRfbGFuZV9vcHRp
bV9tYXNrKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCSAgICAgdTggbGFu
ZV9sYXRfb3B0aW1fbWFzaykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAllbnVtIHBvcnQg
cG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4gICAJZW51bSBkcGlvX3BoeSBwaHk7Cj4gICAJZW51bSBk
cGlvX2NoYW5uZWwgY2g7Cj4gICAJaW50IGxhbmU7Cj4gICAKPiAtCWJ4dF9wb3J0X3RvX3BoeV9j
aGFubmVsKGRldl9wcml2LCBwb3J0LCAmcGh5LCAmY2gpOwo+ICsJYnh0X3BvcnRfdG9fcGh5X2No
YW5uZWwoaTkxNSwgcG9ydCwgJnBoeSwgJmNoKTsKPiAgIAo+ICAgCWZvciAobGFuZSA9IDA7IGxh
bmUgPCA0OyBsYW5lKyspIHsKPiAgIAkJdTMyIHZhbCA9IEk5MTVfUkVBRChCWFRfUE9SVF9UWF9E
VzE0X0xOKHBoeSwgY2gsIGxhbmUpKTsKPiBAQCAtNjE3LDE0ICs2MTcsMTQgQEAgdm9pZCBieHRf
ZGRpX3BoeV9zZXRfbGFuZV9vcHRpbV9tYXNrKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ICAgdTgKPiAgIGJ4dF9kZGlfcGh5X2dldF9sYW5lX2xhdF9vcHRpbV9tYXNrKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCWVudW0g
cG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKPiAgIAllbnVtIGRwaW9fcGh5IHBoeTsKPiAgIAll
bnVtIGRwaW9fY2hhbm5lbCBjaDsKPiAgIAlpbnQgbGFuZTsKPiAgIAl1OCBtYXNrOwo+ICAgCj4g
LQlieHRfcG9ydF90b19waHlfY2hhbm5lbChkZXZfcHJpdiwgcG9ydCwgJnBoeSwgJmNoKTsKPiAr
CWJ4dF9wb3J0X3RvX3BoeV9jaGFubmVsKGk5MTUsIHBvcnQsICZwaHksICZjaCk7Cj4gICAKPiAg
IAltYXNrID0gMDsKPiAgIAlmb3IgKGxhbmUgPSAwOyBsYW5lIDwgNDsgbGFuZSsrKSB7Cj4gQEAg
LTY0Miw3ICs2NDIsNyBAQCB2b2lkIGNodl9zZXRfcGh5X3NpZ25hbF9sZXZlbChzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCSAgICAgIHUzMiBkZWVtcGhfcmVnX3ZhbHVlLCB1
MzIgbWFyZ2luX3JlZ192YWx1ZSwKPiAgIAkJCSAgICAgIGJvb2wgdW5pcV90cmFuc19zY2FsZSkK
PiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5j
b2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpk
cG9ydCA9IGVuY190b19kaWdfcG9ydCgmZW5jb2Rlci0+YmFzZSk7Cj4gICAJc3RydWN0IGludGVs
X2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGVuY29kZXItPmJhc2UuY3J0Yyk7Cj4g
ICAJZW51bSBkcGlvX2NoYW5uZWwgY2ggPSB2bHZfZHBvcnRfdG9fY2hhbm5lbChkcG9ydCk7Cj4g
QEAgLTY1MCw0NiArNjUwLDQ2IEBAIHZvaWQgY2h2X3NldF9waHlfc2lnbmFsX2xldmVsKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCXUzMiB2YWw7Cj4gICAJaW50IGk7Cj4gICAK
PiAtCXZsdl9kcGlvX2dldChkZXZfcHJpdik7Cj4gKwl2bHZfZHBpb19nZXQoaTkxNSk7Cj4gICAK
PiAgIAkvKiBDbGVhciBjYWxjIGluaXQgKi8KPiAtCXZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3By
aXYsIHBpcGUsIFZMVl9QQ1MwMV9EVzEwKGNoKSk7Cj4gKwl2YWwgPSB2bHZfZHBpb19yZWFkKGk5
MTUsIHBpcGUsIFZMVl9QQ1MwMV9EVzEwKGNoKSk7Cj4gICAJdmFsICY9IH4oRFBJT19QQ1NfU1dJ
TkdfQ0FMQ19UWDBfVFgyIHwgRFBJT19QQ1NfU1dJTkdfQ0FMQ19UWDFfVFgzKTsKPiAgIAl2YWwg
Jj0gfihEUElPX1BDU19UWDFERUVNUF9NQVNLIHwgRFBJT19QQ1NfVFgyREVFTVBfTUFTSyk7Cj4g
ICAJdmFsIHw9IERQSU9fUENTX1RYMURFRU1QXzlQNSB8IERQSU9fUENTX1RYMkRFRU1QXzlQNTsK
PiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUENTMDFfRFcxMChjaCksIHZh
bCk7Cj4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBWTFZfUENTMDFfRFcxMChjaCksIHZh
bCk7Cj4gICAKPiAgIAlpZiAoaW50ZWxfY3J0Yy0+Y29uZmlnLT5sYW5lX2NvdW50ID4gMikgewo+
IC0JCXZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIFZMVl9QQ1MyM19EVzEwKGNo
KSk7Cj4gKwkJdmFsID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBWTFZfUENTMjNfRFcxMChj
aCkpOwo+ICAgCQl2YWwgJj0gfihEUElPX1BDU19TV0lOR19DQUxDX1RYMF9UWDIgfCBEUElPX1BD
U19TV0lOR19DQUxDX1RYMV9UWDMpOwo+ICAgCQl2YWwgJj0gfihEUElPX1BDU19UWDFERUVNUF9N
QVNLIHwgRFBJT19QQ1NfVFgyREVFTVBfTUFTSyk7Cj4gICAJCXZhbCB8PSBEUElPX1BDU19UWDFE
RUVNUF85UDUgfCBEUElPX1BDU19UWDJERUVNUF85UDU7Cj4gLQkJdmx2X2RwaW9fd3JpdGUoZGV2
X3ByaXYsIHBpcGUsIFZMVl9QQ1MyM19EVzEwKGNoKSwgdmFsKTsKPiArCQl2bHZfZHBpb193cml0
ZShpOTE1LCBwaXBlLCBWTFZfUENTMjNfRFcxMChjaCksIHZhbCk7Cj4gICAJfQo+ICAgCj4gLQl2
YWwgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBWTFZfUENTMDFfRFc5KGNoKSk7Cj4g
Kwl2YWwgPSB2bHZfZHBpb19yZWFkKGk5MTUsIHBpcGUsIFZMVl9QQ1MwMV9EVzkoY2gpKTsKPiAg
IAl2YWwgJj0gfihEUElPX1BDU19UWDFNQVJHSU5fTUFTSyB8IERQSU9fUENTX1RYMk1BUkdJTl9N
QVNLKTsKPiAgIAl2YWwgfD0gRFBJT19QQ1NfVFgxTUFSR0lOXzAwMCB8IERQSU9fUENTX1RYMk1B
UkdJTl8wMDA7Cj4gLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1BDUzAxX0RX
OShjaCksIHZhbCk7Cj4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBWTFZfUENTMDFfRFc5
KGNoKSwgdmFsKTsKPiAgIAo+ICAgCWlmIChpbnRlbF9jcnRjLT5jb25maWctPmxhbmVfY291bnQg
PiAyKSB7Cj4gLQkJdmFsID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgVkxWX1BDUzIz
X0RXOShjaCkpOwo+ICsJCXZhbCA9IHZsdl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwgVkxWX1BDUzIz
X0RXOShjaCkpOwo+ICAgCQl2YWwgJj0gfihEUElPX1BDU19UWDFNQVJHSU5fTUFTSyB8IERQSU9f
UENTX1RYMk1BUkdJTl9NQVNLKTsKPiAgIAkJdmFsIHw9IERQSU9fUENTX1RYMU1BUkdJTl8wMDAg
fCBEUElPX1BDU19UWDJNQVJHSU5fMDAwOwo+IC0JCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBw
aXBlLCBWTFZfUENTMjNfRFc5KGNoKSwgdmFsKTsKPiArCQl2bHZfZHBpb193cml0ZShpOTE1LCBw
aXBlLCBWTFZfUENTMjNfRFc5KGNoKSwgdmFsKTsKPiAgIAl9Cj4gICAKPiAgIAkvKiBQcm9ncmFt
IHN3aW5nIGRlZW1waCAqLwo+ICAgCWZvciAoaSA9IDA7IGkgPCBpbnRlbF9jcnRjLT5jb25maWct
PmxhbmVfY291bnQ7IGkrKykgewo+IC0JCXZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBp
cGUsIENIVl9UWF9EVzQoY2gsIGkpKTsKPiArCQl2YWwgPSB2bHZfZHBpb19yZWFkKGk5MTUsIHBp
cGUsIENIVl9UWF9EVzQoY2gsIGkpKTsKPiAgIAkJdmFsICY9IH5EUElPX1NXSU5HX0RFRU1QSDlQ
NV9NQVNLOwo+ICAgCQl2YWwgfD0gZGVlbXBoX3JlZ192YWx1ZSA8PCBEUElPX1NXSU5HX0RFRU1Q
SDlQNV9TSElGVDsKPiAtCQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgQ0hWX1RYX0RX
NChjaCwgaSksIHZhbCk7Cj4gKwkJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgQ0hWX1RYX0RX
NChjaCwgaSksIHZhbCk7Cj4gICAJfQo+ICAgCj4gICAJLyogUHJvZ3JhbSBzd2luZyBtYXJnaW4g
Ki8KPiAgIAlmb3IgKGkgPSAwOyBpIDwgaW50ZWxfY3J0Yy0+Y29uZmlnLT5sYW5lX2NvdW50OyBp
KyspIHsKPiAtCQl2YWwgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBDSFZfVFhfRFcy
KGNoLCBpKSk7Cj4gKwkJdmFsID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBDSFZfVFhfRFcy
KGNoLCBpKSk7Cj4gICAKPiAgIAkJdmFsICY9IH5EUElPX1NXSU5HX01BUkdJTjAwMF9NQVNLOwo+
ICAgCQl2YWwgfD0gbWFyZ2luX3JlZ192YWx1ZSA8PCBEUElPX1NXSU5HX01BUkdJTjAwMF9TSElG
VDsKPiBAQCAtNzAyLDcgKzcwMiw3IEBAIHZvaWQgY2h2X3NldF9waHlfc2lnbmFsX2xldmVsKHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQl2YWwgJj0gfigweGZmIDw8IERQSU9f
VU5JUV9UUkFOU19TQ0FMRV9TSElGVCk7Cj4gICAJCXZhbCB8PSAweDlhIDw8IERQSU9fVU5JUV9U
UkFOU19TQ0FMRV9TSElGVDsKPiAgIAo+IC0JCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBl
LCBDSFZfVFhfRFcyKGNoLCBpKSwgdmFsKTsKPiArCQl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBl
LCBDSFZfVFhfRFcyKGNoLCBpKSwgdmFsKTsKPiAgIAl9Cj4gICAKPiAgIAkvKgo+IEBAIC03MTIs
NzAgKzcxMiw3MCBAQCB2b2lkIGNodl9zZXRfcGh5X3NpZ25hbF9sZXZlbChzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKPiAgIAkgKiAyNyBmb3IgY2gwIGFuZCBjaDEuCj4gICAJICovCj4g
ICAJZm9yIChpID0gMDsgaSA8IGludGVsX2NydGMtPmNvbmZpZy0+bGFuZV9jb3VudDsgaSsrKSB7
Cj4gLQkJdmFsID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgQ0hWX1RYX0RXMyhjaCwg
aSkpOwo+ICsJCXZhbCA9IHZsdl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwgQ0hWX1RYX0RXMyhjaCwg
aSkpOwo+ICAgCQlpZiAodW5pcV90cmFuc19zY2FsZSkKPiAgIAkJCXZhbCB8PSBEUElPX1RYX1VO
SVFfVFJBTlNfU0NBTEVfRU47Cj4gICAJCWVsc2UKPiAgIAkJCXZhbCAmPSB+RFBJT19UWF9VTklR
X1RSQU5TX1NDQUxFX0VOOwo+IC0JCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBDSFZf
VFhfRFczKGNoLCBpKSwgdmFsKTsKPiArCQl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBDSFZf
VFhfRFczKGNoLCBpKSwgdmFsKTsKPiAgIAl9Cj4gICAKPiAgIAkvKiBTdGFydCBzd2luZyBjYWxj
dWxhdGlvbiAqLwo+IC0JdmFsID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgVkxWX1BD
UzAxX0RXMTAoY2gpKTsKPiArCXZhbCA9IHZsdl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwgVkxWX1BD
UzAxX0RXMTAoY2gpKTsKPiAgIAl2YWwgfD0gRFBJT19QQ1NfU1dJTkdfQ0FMQ19UWDBfVFgyIHwg
RFBJT19QQ1NfU1dJTkdfQ0FMQ19UWDFfVFgzOwo+IC0Jdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYs
IHBpcGUsIFZMVl9QQ1MwMV9EVzEwKGNoKSwgdmFsKTsKPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUs
IHBpcGUsIFZMVl9QQ1MwMV9EVzEwKGNoKSwgdmFsKTsKPiAgIAo+ICAgCWlmIChpbnRlbF9jcnRj
LT5jb25maWctPmxhbmVfY291bnQgPiAyKSB7Cj4gLQkJdmFsID0gdmx2X2RwaW9fcmVhZChkZXZf
cHJpdiwgcGlwZSwgVkxWX1BDUzIzX0RXMTAoY2gpKTsKPiArCQl2YWwgPSB2bHZfZHBpb19yZWFk
KGk5MTUsIHBpcGUsIFZMVl9QQ1MyM19EVzEwKGNoKSk7Cj4gICAJCXZhbCB8PSBEUElPX1BDU19T
V0lOR19DQUxDX1RYMF9UWDIgfCBEUElPX1BDU19TV0lOR19DQUxDX1RYMV9UWDM7Cj4gLQkJdmx2
X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9QQ1MyM19EVzEwKGNoKSwgdmFsKTsKPiAr
CQl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBWTFZfUENTMjNfRFcxMChjaCksIHZhbCk7Cj4g
ICAJfQo+ICAgCj4gLQl2bHZfZHBpb19wdXQoZGV2X3ByaXYpOwo+ICsJdmx2X2RwaW9fcHV0KGk5
MTUpOwo+ICAgfQo+ICAgCj4gICB2b2lkIGNodl9kYXRhX2xhbmVfc29mdF9yZXNldChzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCQkJICAgICAgYm9vbCByZXNldCkKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFz
ZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29k
ZXItPmJhc2UuZGV2KTsKPiAgIAllbnVtIGRwaW9fY2hhbm5lbCBjaCA9IHZsdl9kcG9ydF90b19j
aGFubmVsKGVuY190b19kaWdfcG9ydCgmZW5jb2Rlci0+YmFzZSkpOwo+ICAgCXN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICAg
CWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgIAl1MzIgdmFsOwo+ICAgCj4gLQl2YWwg
PSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBWTFZfUENTMDFfRFcwKGNoKSk7Cj4gKwl2
YWwgPSB2bHZfZHBpb19yZWFkKGk5MTUsIHBpcGUsIFZMVl9QQ1MwMV9EVzAoY2gpKTsKPiAgIAlp
ZiAocmVzZXQpCj4gICAJCXZhbCAmPSB+KERQSU9fUENTX1RYX0xBTkUyX1JFU0VUIHwgRFBJT19Q
Q1NfVFhfTEFORTFfUkVTRVQpOwo+ICAgCWVsc2UKPiAgIAkJdmFsIHw9IERQSU9fUENTX1RYX0xB
TkUyX1JFU0VUIHwgRFBJT19QQ1NfVFhfTEFORTFfUkVTRVQ7Cj4gLQl2bHZfZHBpb193cml0ZShk
ZXZfcHJpdiwgcGlwZSwgVkxWX1BDUzAxX0RXMChjaCksIHZhbCk7Cj4gKwl2bHZfZHBpb193cml0
ZShpOTE1LCBwaXBlLCBWTFZfUENTMDFfRFcwKGNoKSwgdmFsKTsKPiAgIAo+ICAgCWlmIChjcnRj
X3N0YXRlLT5sYW5lX2NvdW50ID4gMikgewo+IC0JCXZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3By
aXYsIHBpcGUsIFZMVl9QQ1MyM19EVzAoY2gpKTsKPiArCQl2YWwgPSB2bHZfZHBpb19yZWFkKGk5
MTUsIHBpcGUsIFZMVl9QQ1MyM19EVzAoY2gpKTsKPiAgIAkJaWYgKHJlc2V0KQo+ICAgCQkJdmFs
ICY9IH4oRFBJT19QQ1NfVFhfTEFORTJfUkVTRVQgfCBEUElPX1BDU19UWF9MQU5FMV9SRVNFVCk7
Cj4gICAJCWVsc2UKPiAgIAkJCXZhbCB8PSBEUElPX1BDU19UWF9MQU5FMl9SRVNFVCB8IERQSU9f
UENTX1RYX0xBTkUxX1JFU0VUOwo+IC0JCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBW
TFZfUENTMjNfRFcwKGNoKSwgdmFsKTsKPiArCQl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBW
TFZfUENTMjNfRFcwKGNoKSwgdmFsKTsKPiAgIAl9Cj4gICAKPiAtCXZhbCA9IHZsdl9kcGlvX3Jl
YWQoZGV2X3ByaXYsIHBpcGUsIFZMVl9QQ1MwMV9EVzEoY2gpKTsKPiArCXZhbCA9IHZsdl9kcGlv
X3JlYWQoaTkxNSwgcGlwZSwgVkxWX1BDUzAxX0RXMShjaCkpOwo+ICAgCXZhbCB8PSBDSFZfUENT
X1JFUV9TT0ZUUkVTRVRfRU47Cj4gICAJaWYgKHJlc2V0KQo+ICAgCQl2YWwgJj0gfkRQSU9fUENT
X0NMS19TT0ZUX1JFU0VUOwo+ICAgCWVsc2UKPiAgIAkJdmFsIHw9IERQSU9fUENTX0NMS19TT0ZU
X1JFU0VUOwo+IC0Jdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9QQ1MwMV9EVzEo
Y2gpLCB2YWwpOwo+ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxWX1BDUzAxX0RXMShj
aCksIHZhbCk7Cj4gICAKPiAgIAlpZiAoY3J0Y19zdGF0ZS0+bGFuZV9jb3VudCA+IDIpIHsKPiAt
CQl2YWwgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBWTFZfUENTMjNfRFcxKGNoKSk7
Cj4gKwkJdmFsID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBWTFZfUENTMjNfRFcxKGNoKSk7
Cj4gICAJCXZhbCB8PSBDSFZfUENTX1JFUV9TT0ZUUkVTRVRfRU47Cj4gICAJCWlmIChyZXNldCkK
PiAgIAkJCXZhbCAmPSB+RFBJT19QQ1NfQ0xLX1NPRlRfUkVTRVQ7Cj4gICAJCWVsc2UKPiAgIAkJ
CXZhbCB8PSBEUElPX1BDU19DTEtfU09GVF9SRVNFVDsKPiAtCQl2bHZfZHBpb193cml0ZShkZXZf
cHJpdiwgcGlwZSwgVkxWX1BDUzIzX0RXMShjaCksIHZhbCk7Cj4gKwkJdmx2X2RwaW9fd3JpdGUo
aTkxNSwgcGlwZSwgVkxWX1BDUzIzX0RXMShjaCksIHZhbCk7Cj4gICAJfQo+ICAgfQo+ICAgCj4g
QEAgLTc4Myw3ICs3ODMsNyBAQCB2b2lkIGNodl9waHlfcHJlX3BsbF9lbmFibGUoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAq
ZHBvcnQgPSBlbmNfdG9fZGlnX3BvcnQoJmVuY29kZXItPmJhc2UpOwo+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYp
Owo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRl
LT5iYXNlLmNydGMpOwo+ICAgCWVudW0gZHBpb19jaGFubmVsIGNoID0gdmx2X2Rwb3J0X3RvX2No
YW5uZWwoZHBvcnQpOwo+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiBAQCAtNzk3
LDUxICs3OTcsNTEgQEAgdm9pZCBjaHZfcGh5X3ByZV9wbGxfZW5hYmxlKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+ICAgCSAqLwo+ICAgCWlmIChjaCA9PSBEUElPX0NIMCAmJiBwaXBl
ID09IFBJUEVfQikKPiAgIAkJZHBvcnQtPnJlbGVhc2VfY2wyX292ZXJyaWRlID0KPiAtCQkJIWNo
dl9waHlfcG93ZXJnYXRlX2NoKGRldl9wcml2LCBEUElPX1BIWTAsIERQSU9fQ0gxLCB0cnVlKTsK
PiArCQkJIWNodl9waHlfcG93ZXJnYXRlX2NoKGk5MTUsIERQSU9fUEhZMCwgRFBJT19DSDEsIHRy
dWUpOwo+ICAgCj4gICAJY2h2X3BoeV9wb3dlcmdhdGVfbGFuZXMoZW5jb2RlciwgdHJ1ZSwgbGFu
ZV9tYXNrKTsKPiAgIAo+IC0Jdmx2X2RwaW9fZ2V0KGRldl9wcml2KTsKPiArCXZsdl9kcGlvX2dl
dChpOTE1KTsKPiAgIAo+ICAgCS8qIEFzc2VydCBkYXRhIGxhbmUgcmVzZXQgKi8KPiAgIAljaHZf
ZGF0YV9sYW5lX3NvZnRfcmVzZXQoZW5jb2RlciwgY3J0Y19zdGF0ZSwgdHJ1ZSk7Cj4gICAKPiAg
IAkvKiBwcm9ncmFtIGxlZnQvcmlnaHQgY2xvY2sgZGlzdHJpYnV0aW9uICovCj4gICAJaWYgKHBp
cGUgIT0gUElQRV9CKSB7Cj4gLQkJdmFsID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwg
X0NIVl9DTU5fRFc1X0NIMCk7Cj4gKwkJdmFsID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBf
Q0hWX0NNTl9EVzVfQ0gwKTsKPiAgIAkJdmFsICY9IH4oQ0hWX0JVRkxFRlRFTkExX01BU0sgfCBD
SFZfQlVGUklHSFRFTkExX01BU0spOwo+ICAgCQlpZiAoY2ggPT0gRFBJT19DSDApCj4gICAJCQl2
YWwgfD0gQ0hWX0JVRkxFRlRFTkExX0ZPUkNFOwo+ICAgCQlpZiAoY2ggPT0gRFBJT19DSDEpCj4g
ICAJCQl2YWwgfD0gQ0hWX0JVRlJJR0hURU5BMV9GT1JDRTsKPiAtCQl2bHZfZHBpb193cml0ZShk
ZXZfcHJpdiwgcGlwZSwgX0NIVl9DTU5fRFc1X0NIMCwgdmFsKTsKPiArCQl2bHZfZHBpb193cml0
ZShpOTE1LCBwaXBlLCBfQ0hWX0NNTl9EVzVfQ0gwLCB2YWwpOwo+ICAgCX0gZWxzZSB7Cj4gLQkJ
dmFsID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgX0NIVl9DTU5fRFcxX0NIMSk7Cj4g
KwkJdmFsID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBfQ0hWX0NNTl9EVzFfQ0gxKTsKPiAg
IAkJdmFsICY9IH4oQ0hWX0JVRkxFRlRFTkEyX01BU0sgfCBDSFZfQlVGUklHSFRFTkEyX01BU0sp
Owo+ICAgCQlpZiAoY2ggPT0gRFBJT19DSDApCj4gICAJCQl2YWwgfD0gQ0hWX0JVRkxFRlRFTkEy
X0ZPUkNFOwo+ICAgCQlpZiAoY2ggPT0gRFBJT19DSDEpCj4gICAJCQl2YWwgfD0gQ0hWX0JVRlJJ
R0hURU5BMl9GT1JDRTsKPiAtCQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgX0NIVl9D
TU5fRFcxX0NIMSwgdmFsKTsKPiArCQl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBfQ0hWX0NN
Tl9EVzFfQ0gxLCB2YWwpOwo+ICAgCX0KPiAgIAo+ICAgCS8qIHByb2dyYW0gY2xvY2sgY2hhbm5l
bCB1c2FnZSAqLwo+IC0JdmFsID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgVkxWX1BD
UzAxX0RXOChjaCkpOwo+ICsJdmFsID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBWTFZfUENT
MDFfRFc4KGNoKSk7Cj4gICAJdmFsIHw9IENIVl9QQ1NfVVNFRENMS0NIQU5ORUxfT1ZSUklERTsK
PiAgIAlpZiAocGlwZSAhPSBQSVBFX0IpCj4gICAJCXZhbCAmPSB+Q0hWX1BDU19VU0VEQ0xLQ0hB
Tk5FTDsKPiAgIAllbHNlCj4gICAJCXZhbCB8PSBDSFZfUENTX1VTRURDTEtDSEFOTkVMOwo+IC0J
dmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9QQ1MwMV9EVzgoY2gpLCB2YWwpOwo+
ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxWX1BDUzAxX0RXOChjaCksIHZhbCk7Cj4g
ICAKPiAgIAlpZiAoY3J0Y19zdGF0ZS0+bGFuZV9jb3VudCA+IDIpIHsKPiAtCQl2YWwgPSB2bHZf
ZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBWTFZfUENTMjNfRFc4KGNoKSk7Cj4gKwkJdmFsID0g
dmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBWTFZfUENTMjNfRFc4KGNoKSk7Cj4gICAJCXZhbCB8
PSBDSFZfUENTX1VTRURDTEtDSEFOTkVMX09WUlJJREU7Cj4gICAJCWlmIChwaXBlICE9IFBJUEVf
QikKPiAgIAkJCXZhbCAmPSB+Q0hWX1BDU19VU0VEQ0xLQ0hBTk5FTDsKPiAgIAkJZWxzZQo+ICAg
CQkJdmFsIHw9IENIVl9QQ1NfVVNFRENMS0NIQU5ORUw7Cj4gLQkJdmx2X2RwaW9fd3JpdGUoZGV2
X3ByaXYsIHBpcGUsIFZMVl9QQ1MyM19EVzgoY2gpLCB2YWwpOwo+ICsJCXZsdl9kcGlvX3dyaXRl
KGk5MTUsIHBpcGUsIFZMVl9QQ1MyM19EVzgoY2gpLCB2YWwpOwo+ICAgCX0KPiAgIAo+ICAgCS8q
Cj4gQEAgLTg0OSwxNCArODQ5LDE0IEBAIHZvaWQgY2h2X3BoeV9wcmVfcGxsX2VuYWJsZShzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkgKiBtYXRjaGVzIHRoZSBwaXBlLCBidXQg
aGVyZSB3ZSBuZWVkIHRvCj4gICAJICogcGljayB0aGUgQ0wgYmFzZWQgb24gdGhlIHBvcnQuCj4g
ICAJICovCj4gLQl2YWwgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBDSFZfQ01OX0RX
MTkoY2gpKTsKPiArCXZhbCA9IHZsdl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwgQ0hWX0NNTl9EVzE5
KGNoKSk7Cj4gICAJaWYgKHBpcGUgIT0gUElQRV9CKQo+ICAgCQl2YWwgJj0gfkNIVl9DTU5fVVNF
RENMS0NIQU5ORUw7Cj4gICAJZWxzZQo+ICAgCQl2YWwgfD0gQ0hWX0NNTl9VU0VEQ0xLQ0hBTk5F
TDsKPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBDSFZfQ01OX0RXMTkoY2gpLCB2
YWwpOwo+ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgQ0hWX0NNTl9EVzE5KGNoKSwgdmFs
KTsKPiAgIAo+IC0Jdmx2X2RwaW9fcHV0KGRldl9wcml2KTsKPiArCXZsdl9kcGlvX3B1dChpOTE1
KTsKPiAgIH0KPiAgIAo+ICAgdm9pZCBjaHZfcGh5X3ByZV9lbmNvZGVyX2VuYWJsZShzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiBAQCAtODY0LDI0ICs4NjQsMjQgQEAgdm9pZCBjaHZf
cGh5X3ByZV9lbmNvZGVyX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAg
IHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gZW5jX3RvX2ludGVsX2RwKCZlbmNv
ZGVyLT5iYXNlKTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkcG9ydCA9IGRwX3Rv
X2RpZ19wb3J0KGludGVsX2RwKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAgIAll
bnVtIGRwaW9fY2hhbm5lbCBjaCA9IHZsdl9kcG9ydF90b19jaGFubmVsKGRwb3J0KTsKPiAgIAll
bnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gICAJaW50IGRhdGEsIGksIHN0YWdnZXI7Cj4g
ICAJdTMyIHZhbDsKPiAgIAo+IC0Jdmx2X2RwaW9fZ2V0KGRldl9wcml2KTsKPiArCXZsdl9kcGlv
X2dldChpOTE1KTsKPiAgIAo+ICAgCS8qIGFsbG93IGhhcmR3YXJlIHRvIG1hbmFnZSBUWCBGSUZP
IHJlc2V0IHNvdXJjZSAqLwo+IC0JdmFsID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwg
VkxWX1BDUzAxX0RXMTEoY2gpKTsKPiArCXZhbCA9IHZsdl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwg
VkxWX1BDUzAxX0RXMTEoY2gpKTsKPiAgIAl2YWwgJj0gfkRQSU9fTEFORURFU0tFV19TVFJBUF9P
VlJEOwo+IC0Jdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9QQ1MwMV9EVzExKGNo
KSwgdmFsKTsKPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9QQ1MwMV9EVzExKGNo
KSwgdmFsKTsKPiAgIAo+ICAgCWlmIChjcnRjX3N0YXRlLT5sYW5lX2NvdW50ID4gMikgewo+IC0J
CXZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIFZMVl9QQ1MyM19EVzExKGNoKSk7
Cj4gKwkJdmFsID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBWTFZfUENTMjNfRFcxMShjaCkp
Owo+ICAgCQl2YWwgJj0gfkRQSU9fTEFORURFU0tFV19TVFJBUF9PVlJEOwo+IC0JCXZsdl9kcGlv
X3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUENTMjNfRFcxMShjaCksIHZhbCk7Cj4gKwkJdmx2
X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxWX1BDUzIzX0RXMTEoY2gpLCB2YWwpOwo+ICAgCX0K
PiAgIAo+ICAgCS8qIFByb2dyYW0gVHggbGFuZSBsYXRlbmN5IG9wdGltYWwgc2V0dGluZyovCj4g
QEAgLTg5MSw3ICs4OTEsNyBAQCB2b2lkIGNodl9waHlfcHJlX2VuY29kZXJfZW5hYmxlKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJZGF0YSA9IDB4MDsKPiAgIAkJZWxzZQo+
ICAgCQkJZGF0YSA9IChpID09IDEpID8gMHgwIDogMHgxOwo+IC0JCXZsdl9kcGlvX3dyaXRlKGRl
dl9wcml2LCBwaXBlLCBDSFZfVFhfRFcxNChjaCwgaSksCj4gKwkJdmx2X2RwaW9fd3JpdGUoaTkx
NSwgcGlwZSwgQ0hWX1RYX0RXMTQoY2gsIGkpLAo+ICAgCQkJCWRhdGEgPDwgRFBJT19VUEFSX1NI
SUZUKTsKPiAgIAl9Cj4gICAKPiBAQCAtOTA3LDE3ICs5MDcsMTcgQEAgdm9pZCBjaHZfcGh5X3By
ZV9lbmNvZGVyX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAllbHNl
Cj4gICAJCXN0YWdnZXIgPSAweDI7Cj4gICAKPiAtCXZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3By
aXYsIHBpcGUsIFZMVl9QQ1MwMV9EVzExKGNoKSk7Cj4gKwl2YWwgPSB2bHZfZHBpb19yZWFkKGk5
MTUsIHBpcGUsIFZMVl9QQ1MwMV9EVzExKGNoKSk7Cj4gICAJdmFsIHw9IERQSU9fVFgyX1NUQUdH
RVJfTUFTSygweDFmKTsKPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUENT
MDFfRFcxMShjaCksIHZhbCk7Cj4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBWTFZfUENT
MDFfRFcxMShjaCksIHZhbCk7Cj4gICAKPiAgIAlpZiAoY3J0Y19zdGF0ZS0+bGFuZV9jb3VudCA+
IDIpIHsKPiAtCQl2YWwgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBWTFZfUENTMjNf
RFcxMShjaCkpOwo+ICsJCXZhbCA9IHZsdl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwgVkxWX1BDUzIz
X0RXMTEoY2gpKTsKPiAgIAkJdmFsIHw9IERQSU9fVFgyX1NUQUdHRVJfTUFTSygweDFmKTsKPiAt
CQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1BDUzIzX0RXMTEoY2gpLCB2YWwp
Owo+ICsJCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9QQ1MyM19EVzExKGNoKSwgdmFs
KTsKPiAgIAl9Cj4gICAKPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUENT
MDFfRFcxMihjaCksCj4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBWTFZfUENTMDFfRFcx
MihjaCksCj4gICAJCSAgICAgICBEUElPX0xBTkVTVEFHR0VSX1NUUkFQKHN0YWdnZXIpIHwKPiAg
IAkJICAgICAgIERQSU9fTEFORVNUQUdHRVJfU1RSQVBfT1ZSRCB8Cj4gICAJCSAgICAgICBEUElP
X1RYMV9TVEFHR0VSX01BU0soMHgxZikgfAo+IEBAIC05MjUsNyArOTI1LDcgQEAgdm9pZCBjaHZf
cGh5X3ByZV9lbmNvZGVyX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAg
IAkJICAgICAgIERQSU9fVFgyX1NUQUdHRVJfTVVMVCgwKSk7Cj4gICAKPiAgIAlpZiAoY3J0Y19z
dGF0ZS0+bGFuZV9jb3VudCA+IDIpIHsKPiAtCQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlw
ZSwgVkxWX1BDUzIzX0RXMTIoY2gpLAo+ICsJCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZM
Vl9QQ1MyM19EVzEyKGNoKSwKPiAgIAkJCSAgICAgICBEUElPX0xBTkVTVEFHR0VSX1NUUkFQKHN0
YWdnZXIpIHwKPiAgIAkJCSAgICAgICBEUElPX0xBTkVTVEFHR0VSX1NUUkFQX09WUkQgfAo+ICAg
CQkJICAgICAgIERQSU9fVFgxX1NUQUdHRVJfTUFTSygweDFmKSB8Cj4gQEAgLTkzNiwxNiArOTM2
LDE2IEBAIHZvaWQgY2h2X3BoeV9wcmVfZW5jb2Rlcl9lbmFibGUoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIsCj4gICAJLyogRGVhc3NlcnQgZGF0YSBsYW5lIHJlc2V0ICovCj4gICAJY2h2
X2RhdGFfbGFuZV9zb2Z0X3Jlc2V0KGVuY29kZXIsIGNydGNfc3RhdGUsIGZhbHNlKTsKPiAgIAo+
IC0Jdmx2X2RwaW9fcHV0KGRldl9wcml2KTsKPiArCXZsdl9kcGlvX3B1dChpOTE1KTsKPiAgIH0K
PiAgIAo+ICAgdm9pZCBjaHZfcGh5X3JlbGVhc2VfY2wyX292ZXJyaWRlKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRw
b3J0ID0gZW5jX3RvX2RpZ19wb3J0KCZlbmNvZGVyLT5iYXNlKTsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsK
PiAgIAo+ICAgCWlmIChkcG9ydC0+cmVsZWFzZV9jbDJfb3ZlcnJpZGUpIHsKPiAtCQljaHZfcGh5
X3Bvd2VyZ2F0ZV9jaChkZXZfcHJpdiwgRFBJT19QSFkwLCBEUElPX0NIMSwgZmFsc2UpOwo+ICsJ
CWNodl9waHlfcG93ZXJnYXRlX2NoKGk5MTUsIERQSU9fUEhZMCwgRFBJT19DSDEsIGZhbHNlKTsK
PiAgIAkJZHBvcnQtPnJlbGVhc2VfY2wyX292ZXJyaWRlID0gZmFsc2U7Cj4gICAJfQo+ICAgfQo+
IEBAIC05NTMsMjQgKzk1MywyNCBAQCB2b2lkIGNodl9waHlfcmVsZWFzZV9jbDJfb3ZlcnJpZGUo
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICB2b2lkIGNodl9waHlfcG9zdF9wbGxf
ZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCSAgICAgIGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKPiAgIHsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiAgIAllbnVtIHBpcGUgcGlwZSA9IHRvX2ludGVsX2NydGMob2xkX2NydGNfc3Rh
dGUtPmJhc2UuY3J0YyktPnBpcGU7Cj4gICAJdTMyIHZhbDsKPiAgIAo+IC0Jdmx2X2RwaW9fZ2V0
KGRldl9wcml2KTsKPiArCXZsdl9kcGlvX2dldChpOTE1KTsKPiAgIAo+ICAgCS8qIGRpc2FibGUg
bGVmdC9yaWdodCBjbG9jayBkaXN0cmlidXRpb24gKi8KPiAgIAlpZiAocGlwZSAhPSBQSVBFX0Ip
IHsKPiAtCQl2YWwgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBfQ0hWX0NNTl9EVzVf
Q0gwKTsKPiArCQl2YWwgPSB2bHZfZHBpb19yZWFkKGk5MTUsIHBpcGUsIF9DSFZfQ01OX0RXNV9D
SDApOwo+ICAgCQl2YWwgJj0gfihDSFZfQlVGTEVGVEVOQTFfTUFTSyB8IENIVl9CVUZSSUdIVEVO
QTFfTUFTSyk7Cj4gLQkJdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIF9DSFZfQ01OX0RX
NV9DSDAsIHZhbCk7Cj4gKwkJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgX0NIVl9DTU5fRFc1
X0NIMCwgdmFsKTsKPiAgIAl9IGVsc2Ugewo+IC0JCXZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3By
aXYsIHBpcGUsIF9DSFZfQ01OX0RXMV9DSDEpOwo+ICsJCXZhbCA9IHZsdl9kcGlvX3JlYWQoaTkx
NSwgcGlwZSwgX0NIVl9DTU5fRFcxX0NIMSk7Cj4gICAJCXZhbCAmPSB+KENIVl9CVUZMRUZURU5B
Ml9NQVNLIHwgQ0hWX0JVRlJJR0hURU5BMl9NQVNLKTsKPiAtCQl2bHZfZHBpb193cml0ZShkZXZf
cHJpdiwgcGlwZSwgX0NIVl9DTU5fRFcxX0NIMSwgdmFsKTsKPiArCQl2bHZfZHBpb193cml0ZShp
OTE1LCBwaXBlLCBfQ0hWX0NNTl9EVzFfQ0gxLCB2YWwpOwo+ICAgCX0KPiAgIAo+IC0Jdmx2X2Rw
aW9fcHV0KGRldl9wcml2KTsKPiArCXZsdl9kcGlvX3B1dChpOTE1KTsKPiAgIAo+ICAgCS8qCj4g
ICAJICogTGVhdmUgdGhlIHBvd2VyIGRvd24gYml0IGNsZWFyZWQgZm9yIGF0IGxlYXN0IG9uZQo+
IEBAIC05ODgsNTcgKzk4OCw1NyBAQCB2b2lkIHZsdl9zZXRfcGh5X3NpZ25hbF9sZXZlbChzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCSAgICAgIHUzMiBkZW1waF9yZWdfdmFs
dWUsIHUzMiBwcmVlbXBoX3JlZ192YWx1ZSwKPiAgIAkJCSAgICAgIHUzMiB1bmlxdHJhbnNjYWxl
X3JlZ192YWx1ZSwgdTMyIHR4M19kZW1waCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlz
dHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoZW5jb2Rlci0+YmFz
ZS5jcnRjKTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkcG9ydCA9IGVuY190b19k
aWdfcG9ydCgmZW5jb2Rlci0+YmFzZSk7Cj4gICAJZW51bSBkcGlvX2NoYW5uZWwgcG9ydCA9IHZs
dl9kcG9ydF90b19jaGFubmVsKGRwb3J0KTsKPiAgIAllbnVtIHBpcGUgcGlwZSA9IGludGVsX2Ny
dGMtPnBpcGU7Cj4gICAKPiAtCXZsdl9kcGlvX2dldChkZXZfcHJpdik7Cj4gKwl2bHZfZHBpb19n
ZXQoaTkxNSk7Cj4gICAKPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfVFhf
RFc1KHBvcnQpLCAweDAwMDAwMDAwKTsKPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBl
LCBWTFZfVFhfRFc0KHBvcnQpLCBkZW1waF9yZWdfdmFsdWUpOwo+IC0Jdmx2X2RwaW9fd3JpdGUo
ZGV2X3ByaXYsIHBpcGUsIFZMVl9UWF9EVzIocG9ydCksCj4gKwl2bHZfZHBpb193cml0ZShpOTE1
LCBwaXBlLCBWTFZfVFhfRFc1KHBvcnQpLCAweDAwMDAwMDAwKTsKPiArCXZsdl9kcGlvX3dyaXRl
KGk5MTUsIHBpcGUsIFZMVl9UWF9EVzQocG9ydCksIGRlbXBoX3JlZ192YWx1ZSk7Cj4gKwl2bHZf
ZHBpb193cml0ZShpOTE1LCBwaXBlLCBWTFZfVFhfRFcyKHBvcnQpLAo+ICAgCQkJIHVuaXF0cmFu
c2NhbGVfcmVnX3ZhbHVlKTsKPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZf
VFhfRFczKHBvcnQpLCAweDBDNzgyMDQwKTsKPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUs
IFZMVl9UWF9EVzMocG9ydCksIDB4MEM3ODIwNDApOwo+ICAgCj4gICAJaWYgKHR4M19kZW1waCkK
PiAtCQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1RYM19EVzQocG9ydCksIHR4
M19kZW1waCk7Cj4gKwkJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxWX1RYM19EVzQocG9y
dCksIHR4M19kZW1waCk7Cj4gICAKPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBW
TFZfUENTX0RXMTEocG9ydCksIDB4MDAwMzAwMDApOwo+IC0Jdmx2X2RwaW9fd3JpdGUoZGV2X3By
aXYsIHBpcGUsIFZMVl9QQ1NfRFc5KHBvcnQpLCBwcmVlbXBoX3JlZ192YWx1ZSk7Cj4gLQl2bHZf
ZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1RYX0RXNShwb3J0KSwgRFBJT19UWF9PQ0FM
SU5JVF9FTik7Cj4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBWTFZfUENTX0RXMTEocG9y
dCksIDB4MDAwMzAwMDApOwo+ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxWX1BDU19E
VzkocG9ydCksIHByZWVtcGhfcmVnX3ZhbHVlKTsKPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBp
cGUsIFZMVl9UWF9EVzUocG9ydCksIERQSU9fVFhfT0NBTElOSVRfRU4pOwo+ICAgCj4gLQl2bHZf
ZHBpb19wdXQoZGV2X3ByaXYpOwo+ICsJdmx2X2RwaW9fcHV0KGk5MTUpOwo+ICAgfQo+ICAgCj4g
ICB2b2lkIHZsdl9waHlfcHJlX3BsbF9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsCj4gICAJCQkgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUp
Cj4gICB7Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZHBvcnQgPSBlbmNfdG9fZGln
X3BvcnQoJmVuY29kZXItPmJhc2UpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICAg
CWVudW0gZHBpb19jaGFubmVsIHBvcnQgPSB2bHZfZHBvcnRfdG9fY2hhbm5lbChkcG9ydCk7Cj4g
ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAgCj4gICAJLyogUHJvZ3JhbSBUeCBs
YW5lIHJlc2V0cyB0byBkZWZhdWx0ICovCj4gLQl2bHZfZHBpb19nZXQoZGV2X3ByaXYpOwo+ICsJ
dmx2X2RwaW9fZ2V0KGk5MTUpOwo+ICAgCj4gLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlw
ZSwgVkxWX1BDU19EVzAocG9ydCksCj4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBWTFZf
UENTX0RXMChwb3J0KSwKPiAgIAkJCSBEUElPX1BDU19UWF9MQU5FMl9SRVNFVCB8Cj4gICAJCQkg
RFBJT19QQ1NfVFhfTEFORTFfUkVTRVQpOwo+IC0Jdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBp
cGUsIFZMVl9QQ1NfRFcxKHBvcnQpLAo+ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxW
X1BDU19EVzEocG9ydCksCj4gICAJCQkgRFBJT19QQ1NfQ0xLX0NSSV9SWEVCX0VJT1NfRU4gfAo+
ICAgCQkJIERQSU9fUENTX0NMS19DUklfUlhESUdGSUxUU0dfRU4gfAo+ICAgCQkJICgxPDxEUElP
X1BDU19DTEtfREFUQVdJRFRIX1NISUZUKSB8Cj4gICAJCQkJIERQSU9fUENTX0NMS19TT0ZUX1JF
U0VUKTsKPiAgIAo+ICAgCS8qIEZpeCB1cCBpbnRlci1wYWlyIHNrZXcgZmFpbHVyZSAqLwo+IC0J
dmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9QQ1NfRFcxMihwb3J0KSwgMHgwMDc1
MGYwMCk7Cj4gLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1RYX0RXMTEocG9y
dCksIDB4MDAwMDE1MDApOwo+IC0Jdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9U
WF9EVzE0KHBvcnQpLCAweDQwNDAwMDAwKTsKPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUs
IFZMVl9QQ1NfRFcxMihwb3J0KSwgMHgwMDc1MGYwMCk7Cj4gKwl2bHZfZHBpb193cml0ZShpOTE1
LCBwaXBlLCBWTFZfVFhfRFcxMShwb3J0KSwgMHgwMDAwMTUwMCk7Cj4gKwl2bHZfZHBpb193cml0
ZShpOTE1LCBwaXBlLCBWTFZfVFhfRFcxNChwb3J0KSwgMHg0MDQwMDAwMCk7Cj4gICAKPiAtCXZs
dl9kcGlvX3B1dChkZXZfcHJpdik7Cj4gKwl2bHZfZHBpb19wdXQoaTkxNSk7Cj4gICB9Cj4gICAK
PiAgIHZvaWQgdmx2X3BoeV9wcmVfZW5jb2Rlcl9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4gQEAgLTEwNDYsNDIgKzEwNDYsNDIgQEAgdm9pZCB2bHZfcGh5X3ByZV9lbmNv
ZGVyX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIHsKPiAgIAlzdHJ1
Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gZW5jX3RvX2ludGVsX2RwKCZlbmNvZGVyLT5iYXNlKTsK
PiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkcG9ydCA9IGRwX3RvX2RpZ19wb3J0KGlu
dGVsX2RwKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9
IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAgIAllbnVtIGRwaW9fY2hh
bm5lbCBwb3J0ID0gdmx2X2Rwb3J0X3RvX2NoYW5uZWwoZHBvcnQpOwo+ICAgCWVudW0gcGlwZSBw
aXBlID0gY3J0Yy0+cGlwZTsKPiAgIAl1MzIgdmFsOwo+ICAgCj4gLQl2bHZfZHBpb19nZXQoZGV2
X3ByaXYpOwo+ICsJdmx2X2RwaW9fZ2V0KGk5MTUpOwo+ICAgCj4gICAJLyogRW5hYmxlIGNsb2Nr
IGNoYW5uZWxzIGZvciB0aGlzIHBvcnQgKi8KPiAtCXZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3By
aXYsIHBpcGUsIFZMVl9QQ1MwMV9EVzgocG9ydCkpOwo+ICsJdmFsID0gdmx2X2RwaW9fcmVhZChp
OTE1LCBwaXBlLCBWTFZfUENTMDFfRFc4KHBvcnQpKTsKPiAgIAl2YWwgPSAwOwo+ICAgCWlmIChw
aXBlKQo+ICAgCQl2YWwgfD0gKDE8PDIxKTsKPiAgIAllbHNlCj4gICAJCXZhbCAmPSB+KDE8PDIx
KTsKPiAgIAl2YWwgfD0gMHgwMDEwMDBjNDsKPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBw
aXBlLCBWTFZfUENTX0RXOChwb3J0KSwgdmFsKTsKPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBp
cGUsIFZMVl9QQ1NfRFc4KHBvcnQpLCB2YWwpOwo+ICAgCj4gICAJLyogUHJvZ3JhbSBsYW5lIGNs
b2NrICovCj4gLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1BDU19EVzE0KHBv
cnQpLCAweDAwNzYwMDE4KTsKPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZf
UENTX0RXMjMocG9ydCksIDB4MDA0MDA4ODgpOwo+ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlw
ZSwgVkxWX1BDU19EVzE0KHBvcnQpLCAweDAwNzYwMDE4KTsKPiArCXZsdl9kcGlvX3dyaXRlKGk5
MTUsIHBpcGUsIFZMVl9QQ1NfRFcyMyhwb3J0KSwgMHgwMDQwMDg4OCk7Cj4gICAKPiAtCXZsdl9k
cGlvX3B1dChkZXZfcHJpdik7Cj4gKwl2bHZfZHBpb19wdXQoaTkxNSk7Cj4gICB9Cj4gICAKPiAg
IHZvaWQgdmx2X3BoeV9yZXNldF9sYW5lcyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwK
PiAgIAkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUpCj4g
ICB7Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZHBvcnQgPSBlbmNfdG9fZGlnX3Bv
cnQoJmVuY29kZXItPmJhc2UpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhvbGRfY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAg
IAllbnVtIGRwaW9fY2hhbm5lbCBwb3J0ID0gdmx2X2Rwb3J0X3RvX2NoYW5uZWwoZHBvcnQpOwo+
ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgIAo+IC0Jdmx2X2RwaW9fZ2V0KGRl
dl9wcml2KTsKPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUENTX0RXMChw
b3J0KSwgMHgwMDAwMDAwMCk7Cj4gLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxW
X1BDU19EVzEocG9ydCksIDB4MDBlMDAwNjApOwo+IC0Jdmx2X2RwaW9fcHV0KGRldl9wcml2KTsK
PiArCXZsdl9kcGlvX2dldChpOTE1KTsKPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZM
Vl9QQ1NfRFcwKHBvcnQpLCAweDAwMDAwMDAwKTsKPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBp
cGUsIFZMVl9QQ1NfRFcxKHBvcnQpLCAweDAwZTAwMDYwKTsKPiArCXZsdl9kcGlvX3B1dChpOTE1
KTsKPiAgIH0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHBpb19w
aHkuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RwaW9fcGh5LmgKPiBpbmRleCBmNDE4
YWFiOTBiN2UuLmQ0YzkzOTNiZWJjZSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9kcGlvX3BoeS5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHBp
b19waHkuaAo+IEBAIC0xNSwxNiArMTUsMTYgQEAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGU7Cj4g
ICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZTsKPiAgIHN0cnVjdCBpbnRlbF9lbmNvZGVyOwo+ICAg
Cj4gLXZvaWQgYnh0X3BvcnRfdG9fcGh5X2NoYW5uZWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LCBlbnVtIHBvcnQgcG9ydCwKPiArdm9pZCBieHRfcG9ydF90b19waHlfY2hhbm5l
bChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBwb3J0IHBvcnQsCj4gICAJCQkg
ICAgIGVudW0gZHBpb19waHkgKnBoeSwgZW51bSBkcGlvX2NoYW5uZWwgKmNoKTsKPiAtdm9pZCBi
eHRfZGRpX3BoeV9zZXRfc2lnbmFsX2xldmVsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiArdm9pZCBieHRfZGRpX3BoeV9zZXRfc2lnbmFsX2xldmVsKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgZW51bSBwb3J0IHBvcnQsIHUzMiBtYXJnaW4sIHUz
MiBzY2FsZSwKPiAgIAkJCQkgIHUzMiBlbmFibGUsIHUzMiBkZWVtcGhhc2lzKTsKPiAtdm9pZCBi
eHRfZGRpX3BoeV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBk
cGlvX3BoeSBwaHkpOwo+IC12b2lkIGJ4dF9kZGlfcGh5X3VuaW5pdChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gZHBpb19waHkgcGh5KTsKPiAtYm9vbCBieHRfZGRpX3Bo
eV9pc19lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArdm9pZCBi
eHRfZGRpX3BoeV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIGRwaW9f
cGh5IHBoeSk7Cj4gK3ZvaWQgYnh0X2RkaV9waHlfdW5pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LCBlbnVtIGRwaW9fcGh5IHBoeSk7Cj4gK2Jvb2wgYnh0X2RkaV9waHlfaXNfZW5h
YmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICBlbnVtIGRwaW9f
cGh5IHBoeSk7Cj4gLWJvb2wgYnh0X2RkaV9waHlfdmVyaWZ5X3N0YXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiArYm9vbCBieHRfZGRpX3BoeV92ZXJpZnlfc3RhdGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICAgICBlbnVtIGRwaW9fcGh5IHBo
eSk7Cj4gICB1OCBieHRfZGRpX3BoeV9jYWxjX2xhbmVfbGF0X29wdGltX21hc2sodTggbGFuZV9j
b3VudCk7Cj4gICB2b2lkIGJ4dF9kZGlfcGh5X3NldF9sYW5lX29wdGltX21hc2soc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIsCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2RwbGxfbWdyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcGxsX21nci5j
Cj4gaW5kZXggMmQ0ZTdiOWE3YjlkLi4yZGFiY2RmMjdkZjQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfZHBsbF9tZ3IuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX2RwbGxfbWdyLmMKPiBAQCAtNDUsMTQgKzQ1LDE0IEBACj4gICAgKi8KPiAgIAo+
ICAgc3RhdGljIHZvaWQKPiAtaW50ZWxfYXRvbWljX2R1cGxpY2F0ZV9kcGxsX3N0YXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAraW50ZWxfYXRvbWljX2R1cGxpY2F0ZV9k
cGxsX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgc3RydWN0
IGludGVsX3NoYXJlZF9kcGxsX3N0YXRlICpzaGFyZWRfZHBsbCkKPiAgIHsKPiAgIAllbnVtIGlu
dGVsX2RwbGxfaWQgaTsKPiAgIAo+ICAgCS8qIENvcHkgc2hhcmVkIGRwbGwgc3RhdGUgKi8KPiAt
CWZvciAoaSA9IDA7IGkgPCBkZXZfcHJpdi0+bnVtX3NoYXJlZF9kcGxsOyBpKyspIHsKPiAtCQlz
dHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCA9ICZkZXZfcHJpdi0+c2hhcmVkX2RwbGxzW2ld
Owo+ICsJZm9yIChpID0gMDsgaSA8IGk5MTUtPm51bV9zaGFyZWRfZHBsbDsgaSsrKSB7Cj4gKwkJ
c3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGwgPSAmaTkxNS0+c2hhcmVkX2RwbGxzW2ldOwo+
ICAgCj4gICAJCXNoYXJlZF9kcGxsW2ldID0gcGxsLT5zdGF0ZTsKPiAgIAl9Cj4gQEAgLTc3LDQw
ICs3Nyw0MCBAQCBpbnRlbF9hdG9taWNfZ2V0X3NoYXJlZF9kcGxsX3N0YXRlKHN0cnVjdCBkcm1f
YXRvbWljX3N0YXRlICpzKQo+ICAgCj4gICAvKioKPiAgICAqIGludGVsX2dldF9zaGFyZWRfZHBs
bF9ieV9pZCAtIGdldCBhIERQTEwgZ2l2ZW4gaXRzIGlkCj4gLSAqIEBkZXZfcHJpdjogaTkxNSBk
ZXZpY2UgaW5zdGFuY2UKPiArICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gICAgKiBA
aWQ6IHBsbCBpZAo+ICAgICoKPiAgICAqIFJldHVybnM6Cj4gICAgKiBBIHBvaW50ZXIgdG8gdGhl
IERQTEwgd2l0aCBAaWQKPiAgICAqLwo+ICAgc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICoKPiAt
aW50ZWxfZ2V0X3NoYXJlZF9kcGxsX2J5X2lkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiAraW50ZWxfZ2V0X3NoYXJlZF9kcGxsX2J5X2lkKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAo+ICAgCQkJICAgIGVudW0gaW50ZWxfZHBsbF9pZCBpZCkKPiAgIHsKPiAtCXJl
dHVybiAmZGV2X3ByaXYtPnNoYXJlZF9kcGxsc1tpZF07Cj4gKwlyZXR1cm4gJmk5MTUtPnNoYXJl
ZF9kcGxsc1tpZF07Cj4gICB9Cj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxfZ2V0X3NoYXJlZF9k
cGxsX2lkIC0gZ2V0IHRoZSBpZCBvZiBhIERQTEwKPiAtICogQGRldl9wcml2OiBpOTE1IGRldmlj
ZSBpbnN0YW5jZQo+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiAgICAqIEBwbGw6
IHRoZSBEUExMCj4gICAgKgo+ICAgICogUmV0dXJuczoKPiAgICAqIFRoZSBpZCBvZiBAcGxsCj4g
ICAgKi8KPiAgIGVudW0gaW50ZWxfZHBsbF9pZAo+IC1pbnRlbF9nZXRfc2hhcmVkX2RwbGxfaWQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtpbnRlbF9nZXRfc2hhcmVkX2Rw
bGxfaWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgc3RydWN0IGludGVs
X3NoYXJlZF9kcGxsICpwbGwpCj4gICB7Cj4gLQlpZiAoV0FSTl9PTihwbGwgPCBkZXZfcHJpdi0+
c2hhcmVkX2RwbGxzfHwKPiAtCQkgICAgcGxsID4gJmRldl9wcml2LT5zaGFyZWRfZHBsbHNbZGV2
X3ByaXYtPm51bV9zaGFyZWRfZHBsbF0pKQo+ICsJaWYgKFdBUk5fT04ocGxsIDwgaTkxNS0+c2hh
cmVkX2RwbGxzfHwKPiArCQkgICAgcGxsID4gJmk5MTUtPnNoYXJlZF9kcGxsc1tpOTE1LT5udW1f
c2hhcmVkX2RwbGxdKSkKPiAgIAkJcmV0dXJuIC0xOwo+ICAgCj4gLQlyZXR1cm4gKGVudW0gaW50
ZWxfZHBsbF9pZCkgKHBsbCAtIGRldl9wcml2LT5zaGFyZWRfZHBsbHMpOwo+ICsJcmV0dXJuIChl
bnVtIGludGVsX2RwbGxfaWQpIChwbGwgLSBpOTE1LT5zaGFyZWRfZHBsbHMpOwo+ICAgfQo+ICAg
Cj4gICAvKiBGb3IgSUxLKyAqLwo+IC12b2lkIGFzc2VydF9zaGFyZWRfZHBsbChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3ZvaWQgYXNzZXJ0X3NoYXJlZF9kcGxsKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJc3RydWN0IGludGVsX3NoYXJlZF9kcGxs
ICpwbGwsCj4gICAJCQlib29sIHN0YXRlKQo+ICAgewo+IEBAIC0xMjAsNyArMTIwLDcgQEAgdm9p
ZCBhc3NlcnRfc2hhcmVkX2RwbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICAgCWlmIChXQVJOKCFwbGwsICJhc3NlcnRpbmcgRFBMTCAlcyB3aXRoIG5vIERQTExcbiIsIG9u
b2ZmKHN0YXRlKSkpCj4gICAJCXJldHVybjsKPiAgIAo+IC0JY3VyX3N0YXRlID0gcGxsLT5pbmZv
LT5mdW5jcy0+Z2V0X2h3X3N0YXRlKGRldl9wcml2LCBwbGwsICZod19zdGF0ZSk7Cj4gKwljdXJf
c3RhdGUgPSBwbGwtPmluZm8tPmZ1bmNzLT5nZXRfaHdfc3RhdGUoaTkxNSwgcGxsLCAmaHdfc3Rh
dGUpOwo+ICAgCUk5MTVfU1RBVEVfV0FSTihjdXJfc3RhdGUgIT0gc3RhdGUsCj4gICAJICAgICAi
JXMgYXNzZXJ0aW9uIGZhaWx1cmUgKGV4cGVjdGVkICVzLCBjdXJyZW50ICVzKVxuIiwKPiAgIAkJ
CXBsbC0+aW5mby0+bmFtZSwgb25vZmYoc3RhdGUpLCBvbm9mZihjdXJfc3RhdGUpKTsKPiBAQCAt
MTM2LDIyICsxMzYsMjIgQEAgdm9pZCBhc3NlcnRfc2hhcmVkX2RwbGwoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgdm9pZCBpbnRlbF9wcmVwYXJlX3NoYXJlZF9kcGxsKGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgewo+ICAgCXN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMp
Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5i
YXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsID0gY3J0Y19z
dGF0ZS0+c2hhcmVkX2RwbGw7Cj4gICAKPiAgIAlpZiAoV0FSTl9PTihwbGwgPT0gTlVMTCkpCj4g
ICAJCXJldHVybjsKPiAgIAo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRwbGxfbG9jayk7Cj4g
KwltdXRleF9sb2NrKCZpOTE1LT5kcGxsX2xvY2spOwo+ICAgCVdBUk5fT04oIXBsbC0+c3RhdGUu
Y3J0Y19tYXNrKTsKPiAgIAlpZiAoIXBsbC0+YWN0aXZlX21hc2spIHsKPiAgIAkJRFJNX0RFQlVH
X0RSSVZFUigic2V0dGluZyB1cCAlc1xuIiwgcGxsLT5pbmZvLT5uYW1lKTsKPiAgIAkJV0FSTl9P
TihwbGwtPm9uKTsKPiAtCQlhc3NlcnRfc2hhcmVkX2RwbGxfZGlzYWJsZWQoZGV2X3ByaXYsIHBs
bCk7Cj4gKwkJYXNzZXJ0X3NoYXJlZF9kcGxsX2Rpc2FibGVkKGk5MTUsIHBsbCk7Cj4gICAKPiAt
CQlwbGwtPmluZm8tPmZ1bmNzLT5wcmVwYXJlKGRldl9wcml2LCBwbGwpOwo+ICsJCXBsbC0+aW5m
by0+ZnVuY3MtPnByZXBhcmUoaTkxNSwgcGxsKTsKPiAgIAl9Cj4gLQltdXRleF91bmxvY2soJmRl
dl9wcml2LT5kcGxsX2xvY2spOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcGxsX2xvY2spOwo+
ICAgfQo+ICAgCj4gICAvKioKPiBAQCAtMTYzLDcgKzE2Myw3IEBAIHZvaWQgaW50ZWxfcHJlcGFy
ZV9zaGFyZWRfZHBsbChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkK
PiAgIHZvaWQgaW50ZWxfZW5hYmxlX3NoYXJlZF9kcGxsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0g
dG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAgCXN0
cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsID0gY3J0Y19zdGF0ZS0+c2hhcmVkX2RwbGw7Cj4g
ICAJdW5zaWduZWQgaW50IGNydGNfbWFzayA9IGRybV9jcnRjX21hc2soJmNydGMtPmJhc2UpOwo+
ICAgCXVuc2lnbmVkIGludCBvbGRfbWFzazsKPiBAQCAtMTcxLDcgKzE3MSw3IEBAIHZvaWQgaW50
ZWxfZW5hYmxlX3NoYXJlZF9kcGxsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlKQo+ICAgCWlmIChXQVJOX09OKHBsbCA9PSBOVUxMKSkKPiAgIAkJcmV0dXJuOwo+ICAg
Cj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+ZHBsbF9sb2NrKTsKPiArCW11dGV4X2xvY2soJmk5
MTUtPmRwbGxfbG9jayk7Cj4gICAJb2xkX21hc2sgPSBwbGwtPmFjdGl2ZV9tYXNrOwo+ICAgCj4g
ICAJaWYgKFdBUk5fT04oIShwbGwtPnN0YXRlLmNydGNfbWFzayAmIGNydGNfbWFzaykpIHx8Cj4g
QEAgLTE4NiwxNyArMTg2LDE3IEBAIHZvaWQgaW50ZWxfZW5hYmxlX3NoYXJlZF9kcGxsKGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgCj4gICAJaWYgKG9sZF9t
YXNrKSB7Cj4gICAJCVdBUk5fT04oIXBsbC0+b24pOwo+IC0JCWFzc2VydF9zaGFyZWRfZHBsbF9l
bmFibGVkKGRldl9wcml2LCBwbGwpOwo+ICsJCWFzc2VydF9zaGFyZWRfZHBsbF9lbmFibGVkKGk5
MTUsIHBsbCk7Cj4gICAJCWdvdG8gb3V0Owo+ICAgCX0KPiAgIAlXQVJOX09OKHBsbC0+b24pOwo+
ICAgCj4gICAJRFJNX0RFQlVHX0tNUygiZW5hYmxpbmcgJXNcbiIsIHBsbC0+aW5mby0+bmFtZSk7
Cj4gLQlwbGwtPmluZm8tPmZ1bmNzLT5lbmFibGUoZGV2X3ByaXYsIHBsbCk7Cj4gKwlwbGwtPmlu
Zm8tPmZ1bmNzLT5lbmFibGUoaTkxNSwgcGxsKTsKPiAgIAlwbGwtPm9uID0gdHJ1ZTsKPiAgIAo+
ICAgb3V0Ogo+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHBsbF9sb2NrKTsKPiArCW11dGV4
X3VubG9jaygmaTkxNS0+ZHBsbF9sb2NrKTsKPiAgIH0KPiAgIAo+ICAgLyoqCj4gQEAgLTIwOCwx
OCArMjA4LDE4IEBAIHZvaWQgaW50ZWxfZW5hYmxlX3NoYXJlZF9kcGxsKGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgdm9pZCBpbnRlbF9kaXNhYmxlX3NoYXJl
ZF9kcGxsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgewo+
ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5i
YXNlLmNydGMpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxs
ID0gY3J0Y19zdGF0ZS0+c2hhcmVkX2RwbGw7Cj4gICAJdW5zaWduZWQgaW50IGNydGNfbWFzayA9
IGRybV9jcnRjX21hc2soJmNydGMtPmJhc2UpOwo+ICAgCj4gICAJLyogUENIIG9ubHkgYXZhaWxh
YmxlIG9uIElMSysgKi8KPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNSkKPiArCWlmIChJ
TlRFTF9HRU4oaTkxNSkgPCA1KQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAlpZiAocGxsID09IE5V
TEwpCj4gICAJCXJldHVybjsKPiAgIAo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRwbGxfbG9j
ayk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT5kcGxsX2xvY2spOwo+ICAgCWlmIChXQVJOX09OKCEo
cGxsLT5hY3RpdmVfbWFzayAmIGNydGNfbWFzaykpKQo+ICAgCQlnb3RvIG91dDsKPiAgIAo+IEBA
IC0yMjcsNyArMjI3LDcgQEAgdm9pZCBpbnRlbF9kaXNhYmxlX3NoYXJlZF9kcGxsKGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgCQkgICAgICBwbGwtPmluZm8t
Pm5hbWUsIHBsbC0+YWN0aXZlX21hc2ssIHBsbC0+b24sCj4gICAJCSAgICAgIGNydGMtPmJhc2Uu
YmFzZS5pZCk7Cj4gICAKPiAtCWFzc2VydF9zaGFyZWRfZHBsbF9lbmFibGVkKGRldl9wcml2LCBw
bGwpOwo+ICsJYXNzZXJ0X3NoYXJlZF9kcGxsX2VuYWJsZWQoaTkxNSwgcGxsKTsKPiAgIAlXQVJO
X09OKCFwbGwtPm9uKTsKPiAgIAo+ICAgCXBsbC0+YWN0aXZlX21hc2sgJj0gfmNydGNfbWFzazsK
PiBAQCAtMjM1LDExICsyMzUsMTEgQEAgdm9pZCBpbnRlbF9kaXNhYmxlX3NoYXJlZF9kcGxsKGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgCQlnb3RvIG91dDsK
PiAgIAo+ICAgCURSTV9ERUJVR19LTVMoImRpc2FibGluZyAlc1xuIiwgcGxsLT5pbmZvLT5uYW1l
KTsKPiAtCXBsbC0+aW5mby0+ZnVuY3MtPmRpc2FibGUoZGV2X3ByaXYsIHBsbCk7Cj4gKwlwbGwt
PmluZm8tPmZ1bmNzLT5kaXNhYmxlKGk5MTUsIHBsbCk7Cj4gICAJcGxsLT5vbiA9IGZhbHNlOwo+
ICAgCj4gICBvdXQ6Cj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5kcGxsX2xvY2spOwo+ICsJ
bXV0ZXhfdW5sb2NrKCZpOTE1LT5kcGxsX2xvY2spOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgc3Ry
dWN0IGludGVsX3NoYXJlZF9kcGxsICoKPiBAQCAtMjQ4LDcgKzI0OCw3IEBAIGludGVsX2ZpbmRf
c2hhcmVkX2RwbGwoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICAJCSAg
ICAgICBlbnVtIGludGVsX2RwbGxfaWQgcmFuZ2VfbWF4KQo+ICAgewo+ICAgCXN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRl
dik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFz
ZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsLCAqdW51c2VkX3BsbCA9
IE5VTEw7Cj4gICAJc3RydWN0IGludGVsX3NoYXJlZF9kcGxsX3N0YXRlICpzaGFyZWRfZHBsbDsK
PiAgIAllbnVtIGludGVsX2RwbGxfaWQgaTsKPiBAQCAtMjU2LDcgKzI1Niw3IEBAIGludGVsX2Zp
bmRfc2hhcmVkX2RwbGwoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICAJ
c2hhcmVkX2RwbGwgPSBpbnRlbF9hdG9taWNfZ2V0X3NoYXJlZF9kcGxsX3N0YXRlKGNydGNfc3Rh
dGUtPmJhc2Uuc3RhdGUpOwo+ICAgCj4gICAJZm9yIChpID0gcmFuZ2VfbWluOyBpIDw9IHJhbmdl
X21heDsgaSsrKSB7Cj4gLQkJcGxsID0gJmRldl9wcml2LT5zaGFyZWRfZHBsbHNbaV07Cj4gKwkJ
cGxsID0gJmk5MTUtPnNoYXJlZF9kcGxsc1tpXTsKPiAgIAo+ICAgCQkvKiBPbmx5IHdhbnQgdG8g
Y2hlY2sgZW5hYmxlZCB0aW1pbmdzIGZpcnN0ICovCj4gICAJCWlmIChzaGFyZWRfZHBsbFtpXS5j
cnRjX21hc2sgPT0gMCkgewo+IEBAIC0zMjIsNyArMzIyLDcgQEAgaW50ZWxfcmVmZXJlbmNlX3No
YXJlZF9kcGxsKHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsLAo+ICAgICovCj4gICB2b2lk
IGludGVsX3NoYXJlZF9kcGxsX3N3YXBfc3RhdGUoc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0
YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShzdGF0ZS0+ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShzdGF0ZS0+ZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGxfc3RhdGUgKnNoYXJl
ZF9kcGxsOwo+ICAgCXN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsOwo+ICAgCWVudW0gaW50
ZWxfZHBsbF9pZCBpOwo+IEBAIC0zMzEsMTAgKzMzMSwxMCBAQCB2b2lkIGludGVsX3NoYXJlZF9k
cGxsX3N3YXBfc3RhdGUoc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAgCQlyZXR1
cm47Cj4gICAKPiAgIAlzaGFyZWRfZHBsbCA9IHRvX2ludGVsX2F0b21pY19zdGF0ZShzdGF0ZSkt
PnNoYXJlZF9kcGxsOwo+IC0JZm9yIChpID0gMDsgaSA8IGRldl9wcml2LT5udW1fc2hhcmVkX2Rw
bGw7IGkrKykgewo+ICsJZm9yIChpID0gMDsgaSA8IGk5MTUtPm51bV9zaGFyZWRfZHBsbDsgaSsr
KSB7Cj4gICAJCXN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbF9zdGF0ZSB0bXA7Cj4gICAKPiAtCQlw
bGwgPSAmZGV2X3ByaXYtPnNoYXJlZF9kcGxsc1tpXTsKPiArCQlwbGwgPSAmaTkxNS0+c2hhcmVk
X2RwbGxzW2ldOwo+ICAgCj4gICAJCXRtcCA9IHBsbC0+c3RhdGU7Cj4gICAJCXBsbC0+c3RhdGUg
PSBzaGFyZWRfZHBsbFtpXTsKPiBAQCAtMzQyLDcgKzM0Miw3IEBAIHZvaWQgaW50ZWxfc2hhcmVk
X2RwbGxfc3dhcF9zdGF0ZShzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gICAJfQo+
ICAgfQo+ICAgCj4gLXN0YXRpYyBib29sIGlieF9wY2hfZHBsbF9nZXRfaHdfc3RhdGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgYm9vbCBpYnhfcGNoX2RwbGxf
Z2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgICAg
IHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsLAo+ICAgCQkJCSAgICAgIHN0cnVjdCBpbnRl
bF9kcGxsX2h3X3N0YXRlICpod19zdGF0ZSkKPiAgIHsKPiBAQCAtMzUwLDcgKzM1MCw3IEBAIHN0
YXRpYyBib29sIGlieF9wY2hfZHBsbF9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICAgCXUzMiB2YWw7
Cj4gICAKPiAtCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGRl
dl9wcml2LAo+ICsJd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQo
aTkxNSwKPiAgIAkJCQkJCSAgICAgUE9XRVJfRE9NQUlOX0RJU1BMQVlfQ09SRSk7Cj4gICAJaWYg
KCF3YWtlcmVmKQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gQEAgLTM2MCwxMiArMzYwLDEyIEBAIHN0
YXRpYyBib29sIGlieF9wY2hfZHBsbF9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ICAgCWh3X3N0YXRlLT5mcDAgPSBJOTE1X1JFQUQoUENIX0ZQMChpZCkp
Owo+ICAgCWh3X3N0YXRlLT5mcDEgPSBJOTE1X1JFQUQoUENIX0ZQMShpZCkpOwo+ICAgCj4gLQlp
bnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwgUE9XRVJfRE9NQUlOX0RJU1BMQVlfQ09S
RSwgd2FrZXJlZik7Cj4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChpOTE1LCBQT1dFUl9ET01B
SU5fRElTUExBWV9DT1JFLCB3YWtlcmVmKTsKPiAgIAo+ICAgCXJldHVybiB2YWwgJiBEUExMX1ZD
T19FTkFCTEU7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaWJ4X3BjaF9kcGxsX3ByZXBhcmUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBpYnhfcGNo
X2RwbGxfcHJlcGFyZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgc3Ry
dWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGwpCj4gICB7Cj4gICAJY29uc3QgZW51bSBpbnRlbF9k
cGxsX2lkIGlkID0gcGxsLT5pbmZvLT5pZDsKPiBAQCAtMzc0LDEyICszNzQsMTIgQEAgc3RhdGlj
IHZvaWQgaWJ4X3BjaF9kcGxsX3ByZXBhcmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ICAgCUk5MTVfV1JJVEUoUENIX0ZQMShpZCksIHBsbC0+c3RhdGUuaHdfc3RhdGUuZnAx
KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpYnhfYXNzZXJ0X3BjaF9yZWZjbGtfZW5hYmxl
ZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGlieF9h
c3NlcnRfcGNoX3JlZmNsa19lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ICAgewo+ICAgCXUzMiB2YWw7Cj4gICAJYm9vbCBlbmFibGVkOwo+ICAgCj4gLQlJOTE1X1NUQVRF
X1dBUk5fT04oIShIQVNfUENIX0lCWChkZXZfcHJpdikgfHwgSEFTX1BDSF9DUFQoZGV2X3ByaXYp
KSk7Cj4gKwlJOTE1X1NUQVRFX1dBUk5fT04oIShIQVNfUENIX0lCWChpOTE1KSB8fCBIQVNfUENI
X0NQVChpOTE1KSkpOwo+ICAgCj4gICAJdmFsID0gSTkxNV9SRUFEKFBDSF9EUkVGX0NPTlRST0wp
Owo+ICAgCWVuYWJsZWQgPSAhISh2YWwgJiAoRFJFRl9TU0NfU09VUkNFX01BU0sgfCBEUkVGX05P
TlNQUkVBRF9TT1VSQ0VfTUFTSyB8Cj4gQEAgLTM4NywxMyArMzg3LDEzIEBAIHN0YXRpYyB2b2lk
IGlieF9hc3NlcnRfcGNoX3JlZmNsa19lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiAgIAlJOTE1X1NUQVRFX1dBUk4oIWVuYWJsZWQsICJQQ0ggcmVmY2xrIGFzc2Vy
dGlvbiBmYWlsdXJlLCBzaG91bGQgYmUgYWN0aXZlIGJ1dCBpcyBkaXNhYmxlZFxuIik7Cj4gICB9
Cj4gICAKPiAtc3RhdGljIHZvaWQgaWJ4X3BjaF9kcGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGlieF9wY2hfZHBsbF9lbmFibGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJc3RydWN0IGludGVsX3NoYXJlZF9k
cGxsICpwbGwpCj4gICB7Cj4gICAJY29uc3QgZW51bSBpbnRlbF9kcGxsX2lkIGlkID0gcGxsLT5p
bmZvLT5pZDsKPiAgIAo+ICAgCS8qIFBDSCByZWZjbG9jayBtdXN0IGJlIGVuYWJsZWQgZmlyc3Qg
Ki8KPiAtCWlieF9hc3NlcnRfcGNoX3JlZmNsa19lbmFibGVkKGRldl9wcml2KTsKPiArCWlieF9h
c3NlcnRfcGNoX3JlZmNsa19lbmFibGVkKGk5MTUpOwo+ICAgCj4gICAJSTkxNV9XUklURShQQ0hf
RFBMTChpZCksIHBsbC0+c3RhdGUuaHdfc3RhdGUuZHBsbCk7Cj4gICAKPiBAQCAtNDExLDcgKzQx
MSw3IEBAIHN0YXRpYyB2b2lkIGlieF9wY2hfZHBsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ICAgCXVkZWxheSgyMDApOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2
b2lkIGlieF9wY2hfZHBsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiArc3RhdGljIHZvaWQgaWJ4X3BjaF9kcGxsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gICAJCQkJIHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsKQo+ICAg
ewo+ICAgCWNvbnN0IGVudW0gaW50ZWxfZHBsbF9pZCBpZCA9IHBsbC0+aW5mby0+aWQ7Cj4gQEAg
LTQyNiwxNCArNDI2LDE0IEBAIGlieF9nZXRfZHBsbChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSwKPiAgIAkgICAgIHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ICAg
ewo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRl
LT5iYXNlLmNydGMpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAq
cGxsOwo+ICAgCWVudW0gaW50ZWxfZHBsbF9pZCBpOwo+ICAgCj4gLQlpZiAoSEFTX1BDSF9JQlgo
ZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSEFTX1BDSF9JQlgoaTkxNSkpIHsKPiAgIAkJLyogSXJvbmxh
a2UgUENIIGhhcyBhIGZpeGVkIFBMTC0+UENIIHBpcGUgbWFwcGluZy4gKi8KPiAgIAkJaSA9IChl
bnVtIGludGVsX2RwbGxfaWQpIGNydGMtPnBpcGU7Cj4gLQkJcGxsID0gJmRldl9wcml2LT5zaGFy
ZWRfZHBsbHNbaV07Cj4gKwkJcGxsID0gJmk5MTUtPnNoYXJlZF9kcGxsc1tpXTsKPiAgIAo+ICAg
CQlEUk1fREVCVUdfS01TKCJbQ1JUQzolZDolc10gdXNpbmcgcHJlLWFsbG9jYXRlZCAlc1xuIiwK
PiAgIAkJCSAgICAgIGNydGMtPmJhc2UuYmFzZS5pZCwgY3J0Yy0+YmFzZS5uYW1lLAo+IEBAIC00
NTMsNyArNDUzLDcgQEAgaWJ4X2dldF9kcGxsKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlLAo+ICAgCXJldHVybiBwbGw7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaWJ4X2R1
bXBfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMg
dm9pZCBpYnhfZHVtcF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAg
IAkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9kcGxsX2h3X3N0YXRlICpod19zdGF0ZSkKPiAg
IHsKPiAgIAlEUk1fREVCVUdfS01TKCJkcGxsX2h3X3N0YXRlOiBkcGxsOiAweCV4LCBkcGxsX21k
OiAweCV4LCAiCj4gQEAgLTQ3MSw3ICs0NzEsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGludGVs
X3NoYXJlZF9kcGxsX2Z1bmNzIGlieF9wY2hfZHBsbF9mdW5jcyA9IHsKPiAgIAkuZ2V0X2h3X3N0
YXRlID0gaWJ4X3BjaF9kcGxsX2dldF9od19zdGF0ZSwKPiAgIH07Cj4gICAKPiAtc3RhdGljIHZv
aWQgaHN3X2RkaV93cnBsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ICtzdGF0aWMgdm9pZCBoc3dfZGRpX3dycGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCkK
PiAgIHsKPiAgIAljb25zdCBlbnVtIGludGVsX2RwbGxfaWQgaWQgPSBwbGwtPmluZm8tPmlkOwo+
IEBAIC00ODEsNyArNDgxLDcgQEAgc3RhdGljIHZvaWQgaHN3X2RkaV93cnBsbF9lbmFibGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCXVkZWxheSgyMCk7Cj4gICB9Cj4g
ICAKPiAtc3RhdGljIHZvaWQgaHN3X2RkaV9zcGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGhzd19kZGlfc3BsbF9lbmFibGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJc3RydWN0IGludGVsX3NoYXJlZF9kcGxs
ICpwbGwpCj4gICB7Cj4gICAJSTkxNV9XUklURShTUExMX0NUTCwgcGxsLT5zdGF0ZS5od19zdGF0
ZS5zcGxsKTsKPiBAQCAtNDg5LDcgKzQ4OSw3IEBAIHN0YXRpYyB2b2lkIGhzd19kZGlfc3BsbF9l
bmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCXVkZWxheSgyMCk7
Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaHN3X2RkaV93cnBsbF9kaXNhYmxlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgaHN3X2RkaV93cnBsbF9k
aXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgc3RydWN0IGlu
dGVsX3NoYXJlZF9kcGxsICpwbGwpCj4gICB7Cj4gICAJY29uc3QgZW51bSBpbnRlbF9kcGxsX2lk
IGlkID0gcGxsLT5pbmZvLT5pZDsKPiBAQCAtNTAwLDcgKzUwMCw3IEBAIHN0YXRpYyB2b2lkIGhz
d19kZGlfd3JwbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
ICAJUE9TVElOR19SRUFEKFdSUExMX0NUTChpZCkpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lk
IGhzd19kZGlfc3BsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiArc3RhdGljIHZvaWQgaHN3X2RkaV9zcGxsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gICAJCQkJIHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsKQo+ICAgewo+
ICAgCXUzMiB2YWw7Cj4gQEAgLTUxMCw3ICs1MTAsNyBAQCBzdGF0aWMgdm9pZCBoc3dfZGRpX3Nw
bGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJUE9TVElO
R19SRUFEKFNQTExfQ1RMKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgYm9vbCBoc3dfZGRpX3dycGxs
X2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRp
YyBib29sIGhzd19kZGlfd3JwbGxfZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAo+ICAgCQkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCwKPiAg
IAkJCQkgICAgICAgc3RydWN0IGludGVsX2RwbGxfaHdfc3RhdGUgKmh3X3N0YXRlKQo+ICAgewo+
IEBAIC01MTgsNyArNTE4LDcgQEAgc3RhdGljIGJvb2wgaHN3X2RkaV93cnBsbF9nZXRfaHdfc3Rh
dGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCWludGVsX3dha2VyZWZf
dCB3YWtlcmVmOwo+ICAgCXUzMiB2YWw7Cj4gICAKPiAtCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5
X3Bvd2VyX2dldF9pZl9lbmFibGVkKGRldl9wcml2LAo+ICsJd2FrZXJlZiA9IGludGVsX2Rpc3Bs
YXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoaTkxNSwKPiAgIAkJCQkJCSAgICAgUE9XRVJfRE9NQUlO
X0RJU1BMQVlfQ09SRSk7Cj4gICAJaWYgKCF3YWtlcmVmKQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4g
QEAgLTUyNiwxOSArNTI2LDE5IEBAIHN0YXRpYyBib29sIGhzd19kZGlfd3JwbGxfZ2V0X2h3X3N0
YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAl2YWwgPSBJOTE1X1JF
QUQoV1JQTExfQ1RMKGlkKSk7Cj4gICAJaHdfc3RhdGUtPndycGxsID0gdmFsOwo+ICAgCj4gLQlp
bnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwgUE9XRVJfRE9NQUlOX0RJU1BMQVlfQ09S
RSwgd2FrZXJlZik7Cj4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChpOTE1LCBQT1dFUl9ET01B
SU5fRElTUExBWV9DT1JFLCB3YWtlcmVmKTsKPiAgIAo+ICAgCXJldHVybiB2YWwgJiBXUlBMTF9Q
TExfRU5BQkxFOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBib29sIGhzd19kZGlfc3BsbF9nZXRfaHdf
c3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgYm9vbCBo
c3dfZGRpX3NwbGxfZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+
ICAgCQkJCSAgICAgIHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsLAo+ICAgCQkJCSAgICAg
IHN0cnVjdCBpbnRlbF9kcGxsX2h3X3N0YXRlICpod19zdGF0ZSkKPiAgIHsKPiAgIAlpbnRlbF93
YWtlcmVmX3Qgd2FrZXJlZjsKPiAgIAl1MzIgdmFsOwo+ICAgCj4gLQl3YWtlcmVmID0gaW50ZWxf
ZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChkZXZfcHJpdiwKPiArCXdha2VyZWYgPSBpbnRl
bF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGk5MTUsCj4gICAJCQkJCQkgICAgIFBPV0VS
X0RPTUFJTl9ESVNQTEFZX0NPUkUpOwo+ICAgCWlmICghd2FrZXJlZikKPiAgIAkJcmV0dXJuIGZh
bHNlOwo+IEBAIC01NDYsNyArNTQ2LDcgQEAgc3RhdGljIGJvb2wgaHN3X2RkaV9zcGxsX2dldF9o
d19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJdmFsID0gSTkx
NV9SRUFEKFNQTExfQ1RMKTsKPiAgIAlod19zdGF0ZS0+c3BsbCA9IHZhbDsKPiAgIAo+IC0JaW50
ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9ESVNQTEFZX0NPUkUs
IHdha2VyZWYpOwo+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgUE9XRVJfRE9NQUlO
X0RJU1BMQVlfQ09SRSwgd2FrZXJlZik7Cj4gICAKPiAgIAlyZXR1cm4gdmFsICYgU1BMTF9QTExf
RU5BQkxFOwo+ICAgfQo+IEBAIC03OTMsNyArNzkzLDcgQEAgc3RhdGljIHN0cnVjdCBpbnRlbF9z
aGFyZWRfZHBsbCAqaHN3X2RkaV9oZG1pX2dldF9kcGxsKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICoKPiAgIHN0YXRpYyBzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKgo+ICAgaHN3X2RkaV9kcF9n
ZXRfZHBsbChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFz
ZS5jcnRjLT5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfc2hhcmVkX2Rw
bGwgKnBsbDsKPiAgIAllbnVtIGludGVsX2RwbGxfaWQgcGxsX2lkOwo+ICAgCWludCBjbG9jayA9
IGNydGNfc3RhdGUtPnBvcnRfY2xvY2s7Cj4gQEAgLTgxMyw3ICs4MTMsNyBAQCBoc3dfZGRpX2Rw
X2dldF9kcGxsKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgCQlyZXR1
cm4gTlVMTDsKPiAgIAl9Cj4gICAKPiAtCXBsbCA9IGludGVsX2dldF9zaGFyZWRfZHBsbF9ieV9p
ZChkZXZfcHJpdiwgcGxsX2lkKTsKPiArCXBsbCA9IGludGVsX2dldF9zaGFyZWRfZHBsbF9ieV9p
ZChpOTE1LCBwbGxfaWQpOwo+ICAgCj4gICAJaWYgKCFwbGwpCj4gICAJCXJldHVybiBOVUxMOwo+
IEBAIC04NTUsNyArODU1LDcgQEAgaHN3X2dldF9kcGxsKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlLAo+ICAgCXJldHVybiBwbGw7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQg
aHN3X2R1bXBfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtz
dGF0aWMgdm9pZCBoc3dfZHVtcF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiAgIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9kcGxsX2h3X3N0YXRlICpod19zdGF0
ZSkKPiAgIHsKPiAgIAlEUk1fREVCVUdfS01TKCJkcGxsX2h3X3N0YXRlOiB3cnBsbDogMHgleCBz
cGxsOiAweCV4XG4iLAo+IEBAIC04NzQsMTcgKzg3NCwxNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0
IGludGVsX3NoYXJlZF9kcGxsX2Z1bmNzIGhzd19kZGlfc3BsbF9mdW5jcyA9IHsKPiAgIAkuZ2V0
X2h3X3N0YXRlID0gaHN3X2RkaV9zcGxsX2dldF9od19zdGF0ZSwKPiAgIH07Cj4gICAKPiAtc3Rh
dGljIHZvaWQgaHN3X2RkaV9sY3BsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ICtzdGF0aWMgdm9pZCBoc3dfZGRpX2xjcGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGwp
Cj4gICB7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaHN3X2RkaV9sY3BsbF9kaXNhYmxlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgaHN3X2RkaV9s
Y3BsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgc3Ry
dWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGwpCj4gICB7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGJv
b2wgaHN3X2RkaV9sY3BsbF9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ICtzdGF0aWMgYm9vbCBoc3dfZGRpX2xjcGxsX2dldF9od19zdGF0ZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAgICAgc3RydWN0IGludGVsX3NoYXJl
ZF9kcGxsICpwbGwsCj4gICAJCQkJICAgICAgIHN0cnVjdCBpbnRlbF9kcGxsX2h3X3N0YXRlICpo
d19zdGF0ZSkKPiAgIHsKPiBAQCAtOTI4LDcgKzkyOCw3IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3Qg
c2tsX2RwbGxfcmVncyBza2xfZHBsbF9yZWdzWzRdID0gewo+ICAgCX0sCj4gICB9Owo+ICAgCj4g
LXN0YXRpYyB2b2lkIHNrbF9kZGlfcGxsX3dyaXRlX2N0cmwxKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgc2tsX2RkaV9wbGxfd3JpdGVfY3RybDEoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgIHN0cnVjdCBpbnRlbF9zaGFy
ZWRfZHBsbCAqcGxsKQo+ICAgewo+ICAgCWNvbnN0IGVudW0gaW50ZWxfZHBsbF9pZCBpZCA9IHBs
bC0+aW5mby0+aWQ7Cj4gQEAgLTk0NSwxMyArOTQ1LDEzIEBAIHN0YXRpYyB2b2lkIHNrbF9kZGlf
cGxsX3dyaXRlX2N0cmwxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlQ
T1NUSU5HX1JFQUQoRFBMTF9DVFJMMSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgc2tsX2Rk
aV9wbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGlj
IHZvaWQgc2tsX2RkaV9wbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+
ICAgCQkJICAgICAgIHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsKQo+ICAgewo+ICAgCWNv
bnN0IHN0cnVjdCBza2xfZHBsbF9yZWdzICpyZWdzID0gc2tsX2RwbGxfcmVnczsKPiAgIAljb25z
dCBlbnVtIGludGVsX2RwbGxfaWQgaWQgPSBwbGwtPmluZm8tPmlkOwo+ICAgCj4gLQlza2xfZGRp
X3BsbF93cml0ZV9jdHJsMShkZXZfcHJpdiwgcGxsKTsKPiArCXNrbF9kZGlfcGxsX3dyaXRlX2N0
cmwxKGk5MTUsIHBsbCk7Cj4gICAKPiAgIAlJOTE1X1dSSVRFKHJlZ3NbaWRdLmNmZ2NyMSwgcGxs
LT5zdGF0ZS5od19zdGF0ZS5jZmdjcjEpOwo+ICAgCUk5MTVfV1JJVEUocmVnc1tpZF0uY2ZnY3Iy
LCBwbGwtPnN0YXRlLmh3X3N0YXRlLmNmZ2NyMik7Cj4gQEAgLTk2Miw3ICs5NjIsNyBAQCBzdGF0
aWMgdm9pZCBza2xfZGRpX3BsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ICAgCUk5MTVfV1JJVEUocmVnc1tpZF0uY3RsLAo+ICAgCQkgICBJOTE1X1JFQUQocmVn
c1tpZF0uY3RsKSB8IExDUExMX1BMTF9FTkFCTEUpOwo+ICAgCj4gLQlpZiAoaW50ZWxfd2FpdF9m
b3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gKwlpZiAoaW50ZWxfd2FpdF9mb3JfcmVn
aXN0ZXIoJmk5MTUtPnVuY29yZSwKPiAgIAkJCQkgICAgRFBMTF9TVEFUVVMsCj4gICAJCQkJICAg
IERQTExfTE9DSyhpZCksCj4gICAJCQkJICAgIERQTExfTE9DSyhpZCksCj4gQEAgLTk3MCwxMyAr
OTcwLDEzIEBAIHN0YXRpYyB2b2lkIHNrbF9kZGlfcGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJCURSTV9FUlJPUigiRFBMTCAlZCBub3QgbG9ja2VkXG4i
LCBpZCk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgc2tsX2RkaV9kcGxsMF9lbmFibGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBza2xfZGRpX2Rw
bGwwX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgc3RydWN0
IGludGVsX3NoYXJlZF9kcGxsICpwbGwpCj4gICB7Cj4gLQlza2xfZGRpX3BsbF93cml0ZV9jdHJs
MShkZXZfcHJpdiwgcGxsKTsKPiArCXNrbF9kZGlfcGxsX3dyaXRlX2N0cmwxKGk5MTUsIHBsbCk7
Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgc2tsX2RkaV9wbGxfZGlzYWJsZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIHNrbF9kZGlfcGxsX2Rpc2Fi
bGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJc3RydWN0IGludGVsX3No
YXJlZF9kcGxsICpwbGwpCj4gICB7Cj4gICAJY29uc3Qgc3RydWN0IHNrbF9kcGxsX3JlZ3MgKnJl
Z3MgPSBza2xfZHBsbF9yZWdzOwo+IEBAIC05ODgsMTIgKzk4OCwxMiBAQCBzdGF0aWMgdm9pZCBz
a2xfZGRpX3BsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAg
IAlQT1NUSU5HX1JFQUQocmVnc1tpZF0uY3RsKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBz
a2xfZGRpX2RwbGwwX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICtzdGF0aWMgdm9pZCBza2xfZGRpX2RwbGwwX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gICAJCQkJICBzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCkKPiAgIHsK
PiAgIH0KPiAgIAo+IC1zdGF0aWMgYm9vbCBza2xfZGRpX3BsbF9nZXRfaHdfc3RhdGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgYm9vbCBza2xfZGRpX3BsbF9n
ZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgICBz
dHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCwKPiAgIAkJCQkgICAgIHN0cnVjdCBpbnRlbF9k
cGxsX2h3X3N0YXRlICpod19zdGF0ZSkKPiAgIHsKPiBAQCAtMTAwMyw3ICsxMDAzLDcgQEAgc3Rh
dGljIGJvb2wgc2tsX2RkaV9wbGxfZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiAgIAlib29sIHJldDsK
PiAgIAo+IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2
X3ByaXYsCj4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChp
OTE1LAo+ICAgCQkJCQkJICAgICBQT1dFUl9ET01BSU5fRElTUExBWV9DT1JFKTsKPiAgIAlpZiAo
IXdha2VyZWYpCj4gICAJCXJldHVybiBmYWxzZTsKPiBAQCAtMTAyNSwxMiArMTAyNSwxMiBAQCBz
dGF0aWMgYm9vbCBza2xfZGRpX3BsbF9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ICAgCXJldCA9IHRydWU7Cj4gICAKPiAgIG91dDoKPiAtCWludGVsX2Rp
c3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBQT1dFUl9ET01BSU5fRElTUExBWV9DT1JFLCB3YWtl
cmVmKTsKPiArCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5MTUsIFBPV0VSX0RPTUFJTl9ESVNQ
TEFZX0NPUkUsIHdha2VyZWYpOwo+ICAgCj4gICAJcmV0dXJuIHJldDsKPiAgIH0KPiAgIAo+IC1z
dGF0aWMgYm9vbCBza2xfZGRpX2RwbGwwX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBib29sIHNrbF9kZGlfZHBsbDBfZ2V0X2h3X3N0YXRl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgICAgICBzdHJ1Y3QgaW50
ZWxfc2hhcmVkX2RwbGwgKnBsbCwKPiAgIAkJCQkgICAgICAgc3RydWN0IGludGVsX2RwbGxfaHdf
c3RhdGUgKmh3X3N0YXRlKQo+ICAgewo+IEBAIC0xMDQwLDcgKzEwNDAsNyBAQCBzdGF0aWMgYm9v
bCBza2xfZGRpX2RwbGwwX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gICAJdTMyIHZhbDsKPiAgIAlib29sIHJldDsKPiAgIAo+IC0Jd2FrZXJlZiA9IGlu
dGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2X3ByaXYsCj4gKwl3YWtlcmVmID0g
aW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChpOTE1LAo+ICAgCQkJCQkJICAgICBQ
T1dFUl9ET01BSU5fRElTUExBWV9DT1JFKTsKPiAgIAlpZiAoIXdha2VyZWYpCj4gICAJCXJldHVy
biBmYWxzZTsKPiBAQCAtMTA1OCw3ICsxMDU4LDcgQEAgc3RhdGljIGJvb2wgc2tsX2RkaV9kcGxs
MF9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCXJl
dCA9IHRydWU7Cj4gICAKPiAgIG91dDoKPiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9w
cml2LCBQT1dFUl9ET01BSU5fRElTUExBWV9DT1JFLCB3YWtlcmVmKTsKPiArCWludGVsX2Rpc3Bs
YXlfcG93ZXJfcHV0KGk5MTUsIFBPV0VSX0RPTUFJTl9ESVNQTEFZX0NPUkUsIHdha2VyZWYpOwo+
ICAgCj4gICAJcmV0dXJuIHJldDsKPiAgIH0KPiBAQCAtMTQyNCw3ICsxNDI0LDcgQEAgc2tsX2dl
dF9kcGxsKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCXJldHVybiBw
bGw7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgc2tsX2R1bXBfaHdfc3RhdGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBza2xfZHVtcF9od19zdGF0
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgIGNvbnN0IHN0cnVj
dCBpbnRlbF9kcGxsX2h3X3N0YXRlICpod19zdGF0ZSkKPiAgIHsKPiAgIAlEUk1fREVCVUdfS01T
KCJkcGxsX2h3X3N0YXRlOiAiCj4gQEAgLTE0NDYsNyArMTQ0Niw3IEBAIHN0YXRpYyBjb25zdCBz
dHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGxfZnVuY3Mgc2tsX2RkaV9kcGxsMF9mdW5jcyA9IHsKPiAg
IAkuZ2V0X2h3X3N0YXRlID0gc2tsX2RkaV9kcGxsMF9nZXRfaHdfc3RhdGUsCj4gICB9Owo+ICAg
Cj4gLXN0YXRpYyB2b2lkIGJ4dF9kZGlfcGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGJ4dF9kZGlfcGxsX2VuYWJsZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQlzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBs
bCkKPiAgIHsKPiAgIAl1MzIgdGVtcDsKPiBAQCAtMTQ1NCwxNCArMTQ1NCwxNCBAQCBzdGF0aWMg
dm9pZCBieHRfZGRpX3BsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ICAgCWVudW0gZHBpb19waHkgcGh5Owo+ICAgCWVudW0gZHBpb19jaGFubmVsIGNoOwo+ICAg
Cj4gLQlieHRfcG9ydF90b19waHlfY2hhbm5lbChkZXZfcHJpdiwgcG9ydCwgJnBoeSwgJmNoKTsK
PiArCWJ4dF9wb3J0X3RvX3BoeV9jaGFubmVsKGk5MTUsIHBvcnQsICZwaHksICZjaCk7Cj4gICAK
PiAgIAkvKiBOb24tU1NDIHJlZmVyZW5jZSAqLwo+ICAgCXRlbXAgPSBJOTE1X1JFQUQoQlhUX1BP
UlRfUExMX0VOQUJMRShwb3J0KSk7Cj4gICAJdGVtcCB8PSBQT1JUX1BMTF9SRUZfU0VMOwo+ICAg
CUk5MTVfV1JJVEUoQlhUX1BPUlRfUExMX0VOQUJMRShwb3J0KSwgdGVtcCk7Cj4gICAKPiAtCWlm
IChJU19HRU1JTklMQUtFKGRldl9wcml2KSkgewo+ICsJaWYgKElTX0dFTUlOSUxBS0UoaTkxNSkp
IHsKPiAgIAkJdGVtcCA9IEk5MTVfUkVBRChCWFRfUE9SVF9QTExfRU5BQkxFKHBvcnQpKTsKPiAg
IAkJdGVtcCB8PSBQT1JUX1BMTF9QT1dFUl9FTkFCTEU7Cj4gICAJCUk5MTVfV1JJVEUoQlhUX1BP
UlRfUExMX0VOQUJMRShwb3J0KSwgdGVtcCk7Cj4gQEAgLTE1NDksNyArMTU0OSw3IEBAIHN0YXRp
YyB2b2lkIGJ4dF9kZGlfcGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gICAJCQkyMDApKQo+ICAgCQlEUk1fRVJST1IoIlBMTCAlZCBub3QgbG9ja2VkXG4iLCBw
b3J0KTsKPiAgIAo+IC0JaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNf
R0VNSU5JTEFLRShpOTE1KSkgewo+ICAgCQl0ZW1wID0gSTkxNV9SRUFEKEJYVF9QT1JUX1RYX0RX
NV9MTjAocGh5LCBjaCkpOwo+ICAgCQl0ZW1wIHw9IERDQ19ERUxBWV9SQU5HRV8yOwo+ICAgCQlJ
OTE1X1dSSVRFKEJYVF9QT1JUX1RYX0RXNV9HUlAocGh5LCBjaCksIHRlbXApOwo+IEBAIC0xNTY2
LDcgKzE1NjYsNyBAQCBzdGF0aWMgdm9pZCBieHRfZGRpX3BsbF9lbmFibGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCUk5MTVfV1JJVEUoQlhUX1BPUlRfUENTX0RXMTJf
R1JQKHBoeSwgY2gpLCB0ZW1wKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBieHRfZGRpX3Bs
bF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZv
aWQgYnh0X2RkaV9wbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAg
IAkJCQkJc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGwpCj4gICB7Cj4gICAJZW51bSBwb3J0
IHBvcnQgPSAoZW51bSBwb3J0KXBsbC0+aW5mby0+aWQ7IC8qIDE6MSBwb3J0LT5QTEwgbWFwcGlu
ZyAqLwo+IEBAIC0xNTc3LDcgKzE1NzcsNyBAQCBzdGF0aWMgdm9pZCBieHRfZGRpX3BsbF9kaXNh
YmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlJOTE1X1dSSVRFKEJY
VF9QT1JUX1BMTF9FTkFCTEUocG9ydCksIHRlbXApOwo+ICAgCVBPU1RJTkdfUkVBRChCWFRfUE9S
VF9QTExfRU5BQkxFKHBvcnQpKTsKPiAgIAo+IC0JaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYp
KSB7Cj4gKwlpZiAoSVNfR0VNSU5JTEFLRShpOTE1KSkgewo+ICAgCQl0ZW1wID0gSTkxNV9SRUFE
KEJYVF9QT1JUX1BMTF9FTkFCTEUocG9ydCkpOwo+ICAgCQl0ZW1wICY9IH5QT1JUX1BMTF9QT1dF
Ul9FTkFCTEU7Cj4gICAJCUk5MTVfV1JJVEUoQlhUX1BPUlRfUExMX0VOQUJMRShwb3J0KSwgdGVt
cCk7Cj4gQEAgLTE1ODgsNyArMTU4OCw3IEBAIHN0YXRpYyB2b2lkIGJ4dF9kZGlfcGxsX2Rpc2Fi
bGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCX0KPiAgIH0KPiAgIAo+
IC1zdGF0aWMgYm9vbCBieHRfZGRpX3BsbF9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgYm9vbCBieHRfZGRpX3BsbF9nZXRfaHdfc3RhdGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJCXN0cnVjdCBpbnRlbF9zaGFy
ZWRfZHBsbCAqcGxsLAo+ICAgCQkJCQlzdHJ1Y3QgaW50ZWxfZHBsbF9od19zdGF0ZSAqaHdfc3Rh
dGUpCj4gICB7Cj4gQEAgLTE1OTksOSArMTU5OSw5IEBAIHN0YXRpYyBib29sIGJ4dF9kZGlfcGxs
X2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJdTMy
IHZhbDsKPiAgIAlib29sIHJldDsKPiAgIAo+IC0JYnh0X3BvcnRfdG9fcGh5X2NoYW5uZWwoZGV2
X3ByaXYsIHBvcnQsICZwaHksICZjaCk7Cj4gKwlieHRfcG9ydF90b19waHlfY2hhbm5lbChpOTE1
LCBwb3J0LCAmcGh5LCAmY2gpOwo+ICAgCj4gLQl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dl
cl9nZXRfaWZfZW5hYmxlZChkZXZfcHJpdiwKPiArCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bv
d2VyX2dldF9pZl9lbmFibGVkKGk5MTUsCj4gICAJCQkJCQkgICAgIFBPV0VSX0RPTUFJTl9ESVNQ
TEFZX0NPUkUpOwo+ICAgCWlmICghd2FrZXJlZikKPiAgIAkJcmV0dXJuIGZhbHNlOwo+IEBAIC0x
NjYwLDcgKzE2NjAsNyBAQCBzdGF0aWMgYm9vbCBieHRfZGRpX3BsbF9nZXRfaHdfc3RhdGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCXJldCA9IHRydWU7Cj4gICAKPiAg
IG91dDoKPiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBQT1dFUl9ET01BSU5f
RElTUExBWV9DT1JFLCB3YWtlcmVmKTsKPiArCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5MTUs
IFBPV0VSX0RPTUFJTl9ESVNQTEFZX0NPUkUsIHdha2VyZWYpOwo+ICAgCj4gICAJcmV0dXJuIHJl
dDsKPiAgIH0KPiBAQCAtMTgzMiw3ICsxODMyLDcgQEAgYnh0X2dldF9kcGxsKHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCSAgICAgc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9j
cnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVs
X3NoYXJlZF9kcGxsICpwbGw7Cj4gICAJZW51bSBpbnRlbF9kcGxsX2lkIGlkOwo+ICAgCj4gQEAg
LTE4NDYsNyArMTg0Niw3IEBAIGJ4dF9nZXRfZHBsbChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSwKPiAgIAo+ICAgCS8qIDE6MSBtYXBwaW5nIGJldHdlZW4gcG9ydHMgYW5kIFBM
THMgKi8KPiAgIAlpZCA9IChlbnVtIGludGVsX2RwbGxfaWQpIGVuY29kZXItPnBvcnQ7Cj4gLQlw
bGwgPSBpbnRlbF9nZXRfc2hhcmVkX2RwbGxfYnlfaWQoZGV2X3ByaXYsIGlkKTsKPiArCXBsbCA9
IGludGVsX2dldF9zaGFyZWRfZHBsbF9ieV9pZChpOTE1LCBpZCk7Cj4gICAKPiAgIAlEUk1fREVC
VUdfS01TKCJbQ1JUQzolZDolc10gdXNpbmcgcHJlLWFsbG9jYXRlZCAlc1xuIiwKPiAgIAkJICAg
ICAgY3J0Yy0+YmFzZS5iYXNlLmlkLCBjcnRjLT5iYXNlLm5hbWUsIHBsbC0+aW5mby0+bmFtZSk7
Cj4gQEAgLTE4NTYsNyArMTg1Niw3IEBAIGJ4dF9nZXRfZHBsbChzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIAlyZXR1cm4gcGxsOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2
b2lkIGJ4dF9kdW1wX2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiArc3RhdGljIHZvaWQgYnh0X2R1bXBfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCj4gICAJCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfZHBsbF9od19zdGF0ZSAqaHdf
c3RhdGUpCj4gICB7Cj4gICAJRFJNX0RFQlVHX0tNUygiZHBsbF9od19zdGF0ZTogZWJiMDogMHgl
eCwgZWJiNDogMHgleCwiCj4gQEAgLTE4ODcsNyArMTg4Nyw3IEBAIHN0cnVjdCBpbnRlbF9kcGxs
X21nciB7Cj4gICAJc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICooKmdldF9kcGxsKShzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJCQkJICAgICAgc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIpOwo+ICAgCj4gLQl2b2lkICgqZHVtcF9od19zdGF0ZSkoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICsJdm9pZCAoKmR1bXBfaHdfc3RhdGUpKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgICAgY29uc3Qgc3RydWN0IGlu
dGVsX2RwbGxfaHdfc3RhdGUgKmh3X3N0YXRlKTsKPiAgIH07Cj4gICAKPiBAQCAtMTk0Niw3ICsx
OTQ2LDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBpbnRlbF9kcGxsX21nciBieHRfcGxsX21nciA9
IHsKPiAgIAkuZHVtcF9od19zdGF0ZSA9IGJ4dF9kdW1wX2h3X3N0YXRlLAo+ICAgfTsKPiAgIAo+
IC1zdGF0aWMgdm9pZCBjbmxfZGRpX3BsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBjbmxfZGRpX3BsbF9lbmFibGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICAgICAgc3RydWN0IGludGVsX3NoYXJlZF9kcGxs
ICpwbGwpCj4gICB7Cj4gICAJY29uc3QgZW51bSBpbnRlbF9kcGxsX2lkIGlkID0gcGxsLT5pbmZv
LT5pZDsKPiBAQCAtMTk1OCw3ICsxOTU4LDcgQEAgc3RhdGljIHZvaWQgY25sX2RkaV9wbGxfZW5h
YmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlJOTE1X1dSSVRFKENO
TF9EUExMX0VOQUJMRShpZCksIHZhbCk7Cj4gICAKPiAgIAkvKiAyLiBXYWl0IGZvciBEUExMIHBv
d2VyIHN0YXRlIGVuYWJsZWQgaW4gRFBMTF9FTkFCTEUuICovCj4gLQlpZiAoaW50ZWxfd2FpdF9m
b3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gKwlpZiAoaW50ZWxfd2FpdF9mb3JfcmVn
aXN0ZXIoJmk5MTUtPnVuY29yZSwKPiAgIAkJCQkgICAgQ05MX0RQTExfRU5BQkxFKGlkKSwKPiAg
IAkJCQkgICAgUExMX1BPV0VSX1NUQVRFLAo+ICAgCQkJCSAgICBQTExfUE9XRVJfU1RBVEUsCj4g
QEAgLTE5OTksNyArMTk5OSw3IEBAIHN0YXRpYyB2b2lkIGNubF9kZGlfcGxsX2VuYWJsZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJSTkxNV9XUklURShDTkxfRFBMTF9F
TkFCTEUoaWQpLCB2YWwpOwo+ICAgCj4gICAJLyogNy4gV2FpdCBmb3IgUExMIGxvY2sgc3RhdHVz
IGluIERQTExfRU5BQkxFLiAqLwo+IC0JaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZf
cHJpdi0+dW5jb3JlLAo+ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNv
cmUsCj4gICAJCQkJICAgIENOTF9EUExMX0VOQUJMRShpZCksCj4gICAJCQkJICAgIFBMTF9MT0NL
LAo+ICAgCQkJCSAgICBQTExfTE9DSywKPiBAQCAtMjAyMSw3ICsyMDIxLDcgQEAgc3RhdGljIHZv
aWQgY25sX2RkaV9wbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiAgIAkgKi8KPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBjbmxfZGRpX3BsbF9kaXNhYmxlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgY25sX2RkaV9w
bGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQlzdHJ1Y3Qg
aW50ZWxfc2hhcmVkX2RwbGwgKnBsbCkKPiAgIHsKPiAgIAljb25zdCBlbnVtIGludGVsX2RwbGxf
aWQgaWQgPSBwbGwtPmluZm8tPmlkOwo+IEBAIC0yMDQ3LDcgKzIwNDcsNyBAQCBzdGF0aWMgdm9p
ZCBjbmxfZGRpX3BsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiAgIAlJOTE1X1dSSVRFKENOTF9EUExMX0VOQUJMRShpZCksIHZhbCk7Cj4gICAKPiAgIAkvKiA0
LiBXYWl0IGZvciBQTEwgbm90IGxvY2tlZCBzdGF0dXMgaW4gRFBMTF9FTkFCTEUuICovCj4gLQlp
ZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gKwlpZiAoaW50
ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiAgIAkJCQkgICAgQ05MX0RQTExf
RU5BQkxFKGlkKSwKPiAgIAkJCQkgICAgUExMX0xPQ0ssCj4gICAJCQkJICAgIDAsCj4gQEAgLTIw
NjksNyArMjA2OSw3IEBAIHN0YXRpYyB2b2lkIGNubF9kZGlfcGxsX2Rpc2FibGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCUk5MTVfV1JJVEUoQ05MX0RQTExfRU5BQkxF
KGlkKSwgdmFsKTsKPiAgIAo+ICAgCS8qIDcuIFdhaXQgZm9yIERQTEwgcG93ZXIgc3RhdGUgZGlz
YWJsZWQgaW4gRFBMTF9FTkFCTEUuICovCj4gLQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIo
JmRldl9wcml2LT51bmNvcmUsCj4gKwlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUt
PnVuY29yZSwKPiAgIAkJCQkgICAgQ05MX0RQTExfRU5BQkxFKGlkKSwKPiAgIAkJCQkgICAgUExM
X1BPV0VSX1NUQVRFLAo+ICAgCQkJCSAgICAwLAo+IEBAIC0yMDc3LDcgKzIwNzcsNyBAQCBzdGF0
aWMgdm9pZCBjbmxfZGRpX3BsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiAgIAkJRFJNX0VSUk9SKCJQTEwgJWQgUG93ZXIgbm90IGRpc2FibGVkXG4iLCBpZCk7
Cj4gICB9Cj4gICAKPiAtc3RhdGljIGJvb2wgY25sX2RkaV9wbGxfZ2V0X2h3X3N0YXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIGJvb2wgY25sX2RkaV9wbGxf
Z2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgICAg
c3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGwsCj4gICAJCQkJICAgICBzdHJ1Y3QgaW50ZWxf
ZHBsbF9od19zdGF0ZSAqaHdfc3RhdGUpCj4gICB7Cj4gQEAgLTIwODYsNyArMjA4Niw3IEBAIHN0
YXRpYyBib29sIGNubF9kZGlfcGxsX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gICAJdTMyIHZhbDsKPiAgIAlib29sIHJldDsKPiAgIAo+IC0Jd2FrZXJl
ZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2X3ByaXYsCj4gKwl3YWtl
cmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChpOTE1LAo+ICAgCQkJCQkJ
ICAgICBQT1dFUl9ET01BSU5fRElTUExBWV9DT1JFKTsKPiAgIAlpZiAoIXdha2VyZWYpCj4gICAJ
CXJldHVybiBmYWxzZTsKPiBAQCAtMjEwNyw3ICsyMTA3LDcgQEAgc3RhdGljIGJvb2wgY25sX2Rk
aV9wbGxfZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAg
IAlyZXQgPSB0cnVlOwo+ICAgCj4gICBvdXQ6Cj4gLQlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChk
ZXZfcHJpdiwgUE9XRVJfRE9NQUlOX0RJU1BMQVlfQ09SRSwgd2FrZXJlZik7Cj4gKwlpbnRlbF9k
aXNwbGF5X3Bvd2VyX3B1dChpOTE1LCBQT1dFUl9ET01BSU5fRElTUExBWV9DT1JFLCB3YWtlcmVm
KTsKPiAgIAo+ICAgCXJldHVybiByZXQ7Cj4gICB9Cj4gQEAgLTIxOTksMTUgKzIxOTksMTUgQEAg
c3RhdGljIHZvaWQgY25sX3dycGxsX3BhcmFtc19wb3B1bGF0ZShzdHJ1Y3Qgc2tsX3dycGxsX3Bh
cmFtcyAqcGFyYW1zLAo+ICAgCXBhcmFtcy0+ZGNvX2ZyYWN0aW9uID0gZGNvICYgMHg3ZmZmOwo+
ICAgfQo+ICAgCj4gLWludCBjbmxfaGRtaV9wbGxfcmVmX2Nsb2NrKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiAraW50IGNubF9oZG1pX3BsbF9yZWZfY2xvY2soc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlpbnQgcmVmX2Nsb2NrID0gZGV2X3ByaXYt
PmNkY2xrLmh3LnJlZjsKPiArCWludCByZWZfY2xvY2sgPSBpOTE1LT5jZGNsay5ody5yZWY7Cj4g
ICAKPiAgIAkvKgo+ICAgCSAqIEZvciBJQ0wrLCB0aGUgc3BlYyBzdGF0ZXM6IGlmIHJlZmVyZW5j
ZSBmcmVxdWVuY3kgaXMgMzguNCwKPiAgIAkgKiB1c2UgMTkuMiBiZWNhdXNlIHRoZSBEUExMIGF1
dG9tYXRpY2FsbHkgZGl2aWRlcyB0aGF0IGJ5IDIuCj4gICAJICovCj4gLQlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSAxMSAmJiByZWZfY2xvY2sgPT0gMzg0MDApCj4gKwlpZiAoSU5URUxfR0VO
KGk5MTUpID49IDExICYmIHJlZl9jbG9jayA9PSAzODQwMCkKPiAgIAkJcmVmX2Nsb2NrID0gMTky
MDA7Cj4gICAKPiAgIAlyZXR1cm4gcmVmX2Nsb2NrOwo+IEBAIC0yMjE3LDcgKzIyMTcsNyBAQCBz
dGF0aWMgYm9vbAo+ICAgY25sX2RkaV9jYWxjdWxhdGVfd3JwbGwoc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUsCj4gICAJCQlzdHJ1Y3Qgc2tsX3dycGxsX3BhcmFtcyAqd3JwbGxf
cGFyYW1zKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICAgCXUz
MiBhZmVfY2xvY2sgPSBjcnRjX3N0YXRlLT5wb3J0X2Nsb2NrICogNTsKPiAgIAl1MzIgcmVmX2Ns
b2NrOwo+ICAgCXUzMiBkY29fbWluID0gNzk5ODAwMDsKPiBAQCAtMjI1Miw3ICsyMjUyLDcgQEAg
Y25sX2RkaV9jYWxjdWxhdGVfd3JwbGwoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUsCj4gICAKPiAgIAljbmxfd3JwbGxfZ2V0X211bHRpcGxpZXJzKGJlc3RfZGl2LCAmcGRpdiwg
JnFkaXYsICZrZGl2KTsKPiAgIAo+IC0JcmVmX2Nsb2NrID0gY25sX2hkbWlfcGxsX3JlZl9jbG9j
ayhkZXZfcHJpdik7Cj4gKwlyZWZfY2xvY2sgPSBjbmxfaGRtaV9wbGxfcmVmX2Nsb2NrKGk5MTUp
Owo+ICAgCj4gICAJY25sX3dycGxsX3BhcmFtc19wb3B1bGF0ZSh3cnBsbF9wYXJhbXMsIGJlc3Rf
ZGNvLCByZWZfY2xvY2ssCj4gICAJCQkJICBwZGl2LCBxZGl2LCBrZGl2KTsKPiBAQCAtMjM3MCw3
ICsyMzcwLDcgQEAgY25sX2dldF9kcGxsKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlLAo+ICAgCXJldHVybiBwbGw7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgY25sX2R1bXBf
aHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9p
ZCBjbmxfZHVtcF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJ
CSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9kcGxsX2h3X3N0YXRlICpod19zdGF0ZSkKPiAgIHsK
PiAgIAlEUk1fREVCVUdfS01TKCJkcGxsX2h3X3N0YXRlOiAiCj4gQEAgLTI0NzYsOSArMjQ3Niw5
IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3Qgc2tsX3dycGxsX3BhcmFtcyBpY2xfdGJ0X3BsbF8xOV8y
TUh6X3ZhbHVlcyA9IHsKPiAgIHN0YXRpYyBib29sIGljbF9jYWxjX2RwX2NvbWJvX3BsbChzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJCQkgIHN0cnVjdCBza2xfd3Jw
bGxfcGFyYW1zICpwbGxfcGFyYW1zKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRj
LT5kZXYpOwo+ICAgCWNvbnN0IHN0cnVjdCBpY2xfY29tYm9fcGxsX3BhcmFtcyAqcGFyYW1zID0K
PiAtCQlkZXZfcHJpdi0+Y2RjbGsuaHcucmVmID09IDI0MDAwID8KPiArCQlpOTE1LT5jZGNsay5o
dy5yZWYgPT0gMjQwMDAgPwo+ICAgCQlpY2xfZHBfY29tYm9fcGxsXzI0TUh6X3ZhbHVlcyA6Cj4g
ICAJCWljbF9kcF9jb21ib19wbGxfMTlfMk1Iel92YWx1ZXM7Cj4gICAJaW50IGNsb2NrID0gY3J0
Y19zdGF0ZS0+cG9ydF9jbG9jazsKPiBAQCAtMjQ5OCw5ICsyNDk4LDkgQEAgc3RhdGljIGJvb2wg
aWNsX2NhbGNfZHBfY29tYm9fcGxsKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
LAo+ICAgc3RhdGljIGJvb2wgaWNsX2NhbGNfdGJ0X3BsbChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJCSAgICAgc3RydWN0IHNrbF93cnBsbF9wYXJhbXMgKnBsbF9w
YXJhbXMpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gICAKPiAt
CSpwbGxfcGFyYW1zID0gZGV2X3ByaXYtPmNkY2xrLmh3LnJlZiA9PSAyNDAwMCA/Cj4gKwkqcGxs
X3BhcmFtcyA9IGk5MTUtPmNkY2xrLmh3LnJlZiA9PSAyNDAwMCA/Cj4gICAJCQlpY2xfdGJ0X3Bs
bF8yNE1Iel92YWx1ZXMgOiBpY2xfdGJ0X3BsbF8xOV8yTUh6X3ZhbHVlczsKPiAgIAlyZXR1cm4g
dHJ1ZTsKPiAgIH0KPiBAQCAtMjUwOCwxMiArMjUwOCwxMiBAQCBzdGF0aWMgYm9vbCBpY2xfY2Fs
Y190YnRfcGxsKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgc3RhdGlj
IGJvb2wgaWNsX2NhbGNfZHBsbF9zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSwKPiAgIAkJCQlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIHsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFz
ZS5jcnRjLT5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiAgIAl1MzIgY2ZnY3IwLCBjZmdjcjE7Cj4g
ICAJc3RydWN0IHNrbF93cnBsbF9wYXJhbXMgcGxsX3BhcmFtcyA9IHsgMCB9Owo+ICAgCWJvb2wg
cmV0Owo+ICAgCj4gLQlpZiAoaW50ZWxfcG9ydF9pc190YyhkZXZfcHJpdiwgZW5jb2Rlci0+cG9y
dCkpCj4gKwlpZiAoaW50ZWxfcG9ydF9pc190YyhpOTE1LCBlbmNvZGVyLT5wb3J0KSkKPiAgIAkJ
cmV0ID0gaWNsX2NhbGNfdGJ0X3BsbChjcnRjX3N0YXRlLCAmcGxsX3BhcmFtcyk7Cj4gICAJZWxz
ZSBpZiAoaW50ZWxfY3J0Y19oYXNfdHlwZShjcnRjX3N0YXRlLCBJTlRFTF9PVVRQVVRfSERNSSkg
fHwKPiAgIAkJIGludGVsX2NydGNfaGFzX3R5cGUoY3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVUX0RT
SSkpCj4gQEAgLTI2MjksOSArMjYyOSw5IEBAIHN0YXRpYyBib29sIGljbF9tZ19wbGxfZmluZF9k
aXZpc29ycyhpbnQgY2xvY2tfa2h6LCBib29sIGlzX2RwLCBib29sIHVzZV9zc2MsCj4gICAgKi8K
PiAgIHN0YXRpYyBib29sIGljbF9jYWxjX21nX3BsbF9zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2
KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHBsbF9od19zdGF0ZSAqcGxsX3N0YXRlID0gJmNydGNfc3Rh
dGUtPmRwbGxfaHdfc3RhdGU7Cj4gLQlpbnQgcmVmY2xrX2toeiA9IGRldl9wcml2LT5jZGNsay5o
dy5yZWY7Cj4gKwlpbnQgcmVmY2xrX2toeiA9IGk5MTUtPmNkY2xrLmh3LnJlZjsKPiAgIAlpbnQg
Y2xvY2sgPSBjcnRjX3N0YXRlLT5wb3J0X2Nsb2NrOwo+ICAgCXUzMiBkY29fa2h6LCBtMWRpdiwg
bTJkaXZfaW50LCBtMmRpdl9yZW0sIG0yZGl2X2ZyYWM7Cj4gICAJdTMyIGlyZWZfbmRpdiwgaXJl
Zl90cmltLCBpcmVmX3B1bHNlX3c7Cj4gQEAgLTI3OTYsMTggKzI3OTYsMTggQEAgc3RhdGljIHN0
cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqCj4gICBpY2xfZ2V0X2RwbGwoc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICAJICAgICBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlcikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiAgIAlzdHJ1
Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydDsKPiAgIAlzdHJ1Y3QgaW50ZWxf
c2hhcmVkX2RwbGwgKnBsbDsKPiAgIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4g
ICAJZW51bSBpbnRlbF9kcGxsX2lkIG1pbiwgbWF4Owo+ICAgCWJvb2wgcmV0Owo+ICAgCj4gLQlp
ZiAoaW50ZWxfcG9ydF9pc19jb21ib3BoeShkZXZfcHJpdiwgcG9ydCkpIHsKPiArCWlmIChpbnRl
bF9wb3J0X2lzX2NvbWJvcGh5KGk5MTUsIHBvcnQpKSB7Cj4gICAJCW1pbiA9IERQTExfSURfSUNM
X0RQTEwwOwo+ICAgCQltYXggPSBEUExMX0lEX0lDTF9EUExMMTsKPiAgIAkJcmV0ID0gaWNsX2Nh
bGNfZHBsbF9zdGF0ZShjcnRjX3N0YXRlLCBlbmNvZGVyKTsKPiAtCX0gZWxzZSBpZiAoaW50ZWxf
cG9ydF9pc190YyhkZXZfcHJpdiwgcG9ydCkpIHsKPiArCX0gZWxzZSBpZiAoaW50ZWxfcG9ydF9p
c190YyhpOTE1LCBwb3J0KSkgewo+ICAgCQlpZiAoZW5jb2Rlci0+dHlwZSA9PSBJTlRFTF9PVVRQ
VVRfRFBfTVNUKSB7Cj4gICAJCQlzdHJ1Y3QgaW50ZWxfZHBfbXN0X2VuY29kZXIgKm1zdF9lbmNv
ZGVyOwo+ICAgCj4gQEAgLTI4MjQsNyArMjgyNCw3IEBAIGljbF9nZXRfZHBsbChzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJfSBlbHNlIHsKPiAgIAkJCWVudW0gdGNf
cG9ydCB0Y19wb3J0Owo+ICAgCj4gLQkJCXRjX3BvcnQgPSBpbnRlbF9wb3J0X3RvX3RjKGRldl9w
cml2LCBwb3J0KTsKPiArCQkJdGNfcG9ydCA9IGludGVsX3BvcnRfdG9fdGMoaTkxNSwgcG9ydCk7
Cj4gICAJCQltaW4gPSBpY2xfdGNfcG9ydF90b19wbGxfaWQodGNfcG9ydCk7Cj4gICAJCQltYXgg
PSBtaW47Cj4gICAJCQlyZXQgPSBpY2xfY2FsY19tZ19wbGxfc3RhdGUoY3J0Y19zdGF0ZSk7Cj4g
QEAgLTI4NTEsNyArMjg1MSw3IEBAIGljbF9nZXRfZHBsbChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSwKPiAgIAlyZXR1cm4gcGxsOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBib29s
IG1nX3BsbF9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICtzdGF0aWMgYm9vbCBtZ19wbGxfZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAo+ICAgCQkJCXN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsLAo+ICAgCQkJCXN0
cnVjdCBpbnRlbF9kcGxsX2h3X3N0YXRlICpod19zdGF0ZSkKPiAgIHsKPiBAQCAtMjg2MSw3ICsy
ODYxLDcgQEAgc3RhdGljIGJvb2wgbWdfcGxsX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJYm9vbCByZXQgPSBmYWxzZTsKPiAgIAl1MzIgdmFsOwo+
ICAgCj4gLQl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChkZXZf
cHJpdiwKPiArCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGk5
MTUsCj4gICAJCQkJCQkgICAgIFBPV0VSX0RPTUFJTl9ESVNQTEFZX0NPUkUpOwo+ICAgCWlmICgh
d2FrZXJlZikKPiAgIAkJcmV0dXJuIGZhbHNlOwo+IEBAIC0yODk2LDcgKzI4OTYsNyBAQCBzdGF0
aWMgYm9vbCBtZ19wbGxfZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiAgIAlod19zdGF0ZS0+bWdfcGxsX3RkY19jb2xkc3RfYmlhcyA9Cj4gICAJCUk5MTVf
UkVBRChNR19QTExfVERDX0NPTERTVF9CSUFTKHRjX3BvcnQpKTsKPiAgIAo+IC0JaWYgKGRldl9w
cml2LT5jZGNsay5ody5yZWYgPT0gMzg0MDApIHsKPiArCWlmIChpOTE1LT5jZGNsay5ody5yZWYg
PT0gMzg0MDApIHsKPiAgIAkJaHdfc3RhdGUtPm1nX3BsbF90ZGNfY29sZHN0X2JpYXNfbWFzayA9
IE1HX1BMTF9URENfQ09MRFNUX0NPTERTVEFSVDsKPiAgIAkJaHdfc3RhdGUtPm1nX3BsbF9iaWFz
X21hc2sgPSAwOwo+ICAgCX0gZWxzZSB7Cj4gQEAgLTI5MDksMTEgKzI5MDksMTEgQEAgc3RhdGlj
IGJvb2wgbWdfcGxsX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gICAKPiAgIAlyZXQgPSB0cnVlOwo+ICAgb3V0Ogo+IC0JaW50ZWxfZGlzcGxheV9wb3dl
cl9wdXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9ESVNQTEFZX0NPUkUsIHdha2VyZWYpOwo+ICsJ
aW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgUE9XRVJfRE9NQUlOX0RJU1BMQVlfQ09SRSwg
d2FrZXJlZik7Cj4gICAJcmV0dXJuIHJldDsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgYm9vbCBpY2xf
cGxsX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0
YXRpYyBib29sIGljbF9wbGxfZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ICAgCQkJCSBzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCwKPiAgIAkJCQkgc3Ry
dWN0IGludGVsX2RwbGxfaHdfc3RhdGUgKmh3X3N0YXRlLAo+ICAgCQkJCSBpOTE1X3JlZ190IGVu
YWJsZV9yZWcpCj4gQEAgLTI5MjMsNyArMjkyMyw3IEBAIHN0YXRpYyBib29sIGljbF9wbGxfZ2V0
X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlib29sIHJl
dCA9IGZhbHNlOwo+ICAgCXUzMiB2YWw7Cj4gICAKPiAtCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5
X3Bvd2VyX2dldF9pZl9lbmFibGVkKGRldl9wcml2LAo+ICsJd2FrZXJlZiA9IGludGVsX2Rpc3Bs
YXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoaTkxNSwKPiAgIAkJCQkJCSAgICAgUE9XRVJfRE9NQUlO
X0RJU1BMQVlfQ09SRSk7Cj4gICAJaWYgKCF3YWtlcmVmKQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4g
QEAgLTI5MzcsMjYgKzI5MzcsMjYgQEAgc3RhdGljIGJvb2wgaWNsX3BsbF9nZXRfaHdfc3RhdGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCj4gICAJcmV0ID0gdHJ1ZTsK
PiAgIG91dDoKPiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBQT1dFUl9ET01B
SU5fRElTUExBWV9DT1JFLCB3YWtlcmVmKTsKPiArCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5
MTUsIFBPV0VSX0RPTUFJTl9ESVNQTEFZX0NPUkUsIHdha2VyZWYpOwo+ICAgCXJldHVybiByZXQ7
Cj4gICB9Cj4gICAKPiAtc3RhdGljIGJvb2wgY29tYm9fcGxsX2dldF9od19zdGF0ZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBib29sIGNvbWJvX3BsbF9nZXRf
aHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgc3RydWN0
IGludGVsX3NoYXJlZF9kcGxsICpwbGwsCj4gICAJCQkJICAgc3RydWN0IGludGVsX2RwbGxfaHdf
c3RhdGUgKmh3X3N0YXRlKQo+ICAgewo+IC0JcmV0dXJuIGljbF9wbGxfZ2V0X2h3X3N0YXRlKGRl
dl9wcml2LCBwbGwsIGh3X3N0YXRlLAo+ICsJcmV0dXJuIGljbF9wbGxfZ2V0X2h3X3N0YXRlKGk5
MTUsIHBsbCwgaHdfc3RhdGUsCj4gICAJCQkJICAgIENOTF9EUExMX0VOQUJMRShwbGwtPmluZm8t
PmlkKSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGJvb2wgdGJ0X3BsbF9nZXRfaHdfc3RhdGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgYm9vbCB0YnRfcGxsX2dl
dF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgc3RydWN0
IGludGVsX3NoYXJlZF9kcGxsICpwbGwsCj4gICAJCQkJIHN0cnVjdCBpbnRlbF9kcGxsX2h3X3N0
YXRlICpod19zdGF0ZSkKPiAgIHsKPiAtCXJldHVybiBpY2xfcGxsX2dldF9od19zdGF0ZShkZXZf
cHJpdiwgcGxsLCBod19zdGF0ZSwgVEJUX1BMTF9FTkFCTEUpOwo+ICsJcmV0dXJuIGljbF9wbGxf
Z2V0X2h3X3N0YXRlKGk5MTUsIHBsbCwgaHdfc3RhdGUsIFRCVF9QTExfRU5BQkxFKTsKPiAgIH0K
PiAgIAo+IC1zdGF0aWMgdm9pZCBpY2xfZHBsbF93cml0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGljbF9kcGxsX3dyaXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGwp
Cj4gICB7Cj4gICAJc3RydWN0IGludGVsX2RwbGxfaHdfc3RhdGUgKmh3X3N0YXRlID0gJnBsbC0+
c3RhdGUuaHdfc3RhdGU7Cj4gQEAgLTI5NjcsNyArMjk2Nyw3IEBAIHN0YXRpYyB2b2lkIGljbF9k
cGxsX3dyaXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlQT1NUSU5H
X1JFQUQoSUNMX0RQTExfQ0ZHQ1IxKGlkKSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaWNs
X21nX3BsbF93cml0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRp
YyB2b2lkIGljbF9tZ19wbGxfd3JpdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
ICAJCQkgICAgIHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsKQo+ICAgewo+ICAgCXN0cnVj
dCBpbnRlbF9kcGxsX2h3X3N0YXRlICpod19zdGF0ZSA9ICZwbGwtPnN0YXRlLmh3X3N0YXRlOwo+
IEBAIC0zMDE3LDcgKzMwMTcsNyBAQCBzdGF0aWMgdm9pZCBpY2xfbWdfcGxsX3dyaXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlQT1NUSU5HX1JFQUQoTUdfUExMX1RE
Q19DT0xEU1RfQklBUyh0Y19wb3J0KSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaWNsX3Bs
bF9wb3dlcl9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0
aWMgdm9pZCBpY2xfcGxsX3Bvd2VyX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiAgIAkJCQkgc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGwsCj4gICAJCQkJIGk5MTVf
cmVnX3QgZW5hYmxlX3JlZykKPiAgIHsKPiBAQCAtMzAzMSwxMiArMzAzMSwxMiBAQCBzdGF0aWMg
dm9pZCBpY2xfcGxsX3Bvd2VyX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gICAJICogVGhlIHNwZWMgc2F5cyB3ZSBuZWVkIHRvICJ3YWl0IiBidXQgaXQgYWxzbyBz
YXlzIGl0IHNob3VsZCBiZQo+ICAgCSAqIGltbWVkaWF0ZS4KPiAgIAkgKi8KPiAtCWlmIChpbnRl
bF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwgZW5hYmxlX3JlZywKPiArCWlm
IChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLCBlbmFibGVfcmVnLAo+ICAg
CQkJCSAgICBQTExfUE9XRVJfU1RBVEUsIFBMTF9QT1dFUl9TVEFURSwgMSkpCj4gICAJCURSTV9F
UlJPUigiUExMICVkIFBvd2VyIG5vdCBlbmFibGVkXG4iLCBwbGwtPmluZm8tPmlkKTsKPiAgIH0K
PiAgIAo+IC1zdGF0aWMgdm9pZCBpY2xfcGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGljbF9wbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGws
Cj4gICAJCQkgICBpOTE1X3JlZ190IGVuYWJsZV9yZWcpCj4gICB7Cj4gQEAgLTMwNDcsMTkgKzMw
NDcsMTkgQEAgc3RhdGljIHZvaWQgaWNsX3BsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ICAgCUk5MTVfV1JJVEUoZW5hYmxlX3JlZywgdmFsKTsKPiAgIAo+ICAg
CS8qIFRpbWVvdXQgaXMgYWN0dWFsbHkgNjAwdXMuICovCj4gLQlpZiAoaW50ZWxfd2FpdF9mb3Jf
cmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsIGVuYWJsZV9yZWcsCj4gKwlpZiAoaW50ZWxfd2Fp
dF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwgZW5hYmxlX3JlZywKPiAgIAkJCQkgICAgUExM
X0xPQ0ssIFBMTF9MT0NLLCAxKSkKPiAgIAkJRFJNX0VSUk9SKCJQTEwgJWQgbm90IGxvY2tlZFxu
IiwgcGxsLT5pbmZvLT5pZCk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgY29tYm9fcGxsX2Vu
YWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGNv
bWJvX3BsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICAg
IHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsKQo+ICAgewo+ICAgCWk5MTVfcmVnX3QgZW5h
YmxlX3JlZyA9IENOTF9EUExMX0VOQUJMRShwbGwtPmluZm8tPmlkKTsKPiAgIAo+IC0JaWNsX3Bs
bF9wb3dlcl9lbmFibGUoZGV2X3ByaXYsIHBsbCwgZW5hYmxlX3JlZyk7Cj4gKwlpY2xfcGxsX3Bv
d2VyX2VuYWJsZShpOTE1LCBwbGwsIGVuYWJsZV9yZWcpOwo+ICAgCj4gLQlpY2xfZHBsbF93cml0
ZShkZXZfcHJpdiwgcGxsKTsKPiArCWljbF9kcGxsX3dyaXRlKGk5MTUsIHBsbCk7Cj4gICAKPiAg
IAkvKgo+ICAgCSAqIERWRlMgcHJlIHNlcXVlbmNlIHdvdWxkIGJlIGhlcmUsIGJ1dCBpbiBvdXIg
ZHJpdmVyIHRoZSBjZGNsayBjb2RlCj4gQEAgLTMwNjcsMTcgKzMwNjcsMTcgQEAgc3RhdGljIHZv
aWQgY29tYm9fcGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
ICAJICogbm90aGluZyBoZXJlLgo+ICAgCSAqLwo+ICAgCj4gLQlpY2xfcGxsX2VuYWJsZShkZXZf
cHJpdiwgcGxsLCBlbmFibGVfcmVnKTsKPiArCWljbF9wbGxfZW5hYmxlKGk5MTUsIHBsbCwgZW5h
YmxlX3JlZyk7Cj4gICAKPiAgIAkvKiBEVkZTIHBvc3Qgc2VxdWVuY2Ugd291bGQgYmUgaGVyZS4g
U2VlIHRoZSBjb21tZW50IGFib3ZlLiAqLwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIHRidF9w
bGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZv
aWQgdGJ0X3BsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkg
ICBzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCkKPiAgIHsKPiAtCWljbF9wbGxfcG93ZXJf
ZW5hYmxlKGRldl9wcml2LCBwbGwsIFRCVF9QTExfRU5BQkxFKTsKPiArCWljbF9wbGxfcG93ZXJf
ZW5hYmxlKGk5MTUsIHBsbCwgVEJUX1BMTF9FTkFCTEUpOwo+ICAgCj4gLQlpY2xfZHBsbF93cml0
ZShkZXZfcHJpdiwgcGxsKTsKPiArCWljbF9kcGxsX3dyaXRlKGk5MTUsIHBsbCk7Cj4gICAKPiAg
IAkvKgo+ICAgCSAqIERWRlMgcHJlIHNlcXVlbmNlIHdvdWxkIGJlIGhlcmUsIGJ1dCBpbiBvdXIg
ZHJpdmVyIHRoZSBjZGNsayBjb2RlCj4gQEAgLTMwODUsMjAgKzMwODUsMjAgQEAgc3RhdGljIHZv
aWQgdGJ0X3BsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAg
CSAqIG5vdGhpbmcgaGVyZS4KPiAgIAkgKi8KPiAgIAo+IC0JaWNsX3BsbF9lbmFibGUoZGV2X3By
aXYsIHBsbCwgVEJUX1BMTF9FTkFCTEUpOwo+ICsJaWNsX3BsbF9lbmFibGUoaTkxNSwgcGxsLCBU
QlRfUExMX0VOQUJMRSk7Cj4gICAKPiAgIAkvKiBEVkZTIHBvc3Qgc2VxdWVuY2Ugd291bGQgYmUg
aGVyZS4gU2VlIHRoZSBjb21tZW50IGFib3ZlLiAqLwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lk
IG1nX3BsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0
aWMgdm9pZCBtZ19wbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAg
CQkJICBzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCkKPiAgIHsKPiAgIAlpOTE1X3JlZ190
IGVuYWJsZV9yZWcgPQo+ICAgCQlNR19QTExfRU5BQkxFKGljbF9wbGxfaWRfdG9fdGNfcG9ydChw
bGwtPmluZm8tPmlkKSk7Cj4gICAKPiAtCWljbF9wbGxfcG93ZXJfZW5hYmxlKGRldl9wcml2LCBw
bGwsIGVuYWJsZV9yZWcpOwo+ICsJaWNsX3BsbF9wb3dlcl9lbmFibGUoaTkxNSwgcGxsLCBlbmFi
bGVfcmVnKTsKPiAgIAo+IC0JaWNsX21nX3BsbF93cml0ZShkZXZfcHJpdiwgcGxsKTsKPiArCWlj
bF9tZ19wbGxfd3JpdGUoaTkxNSwgcGxsKTsKPiAgIAo+ICAgCS8qCj4gICAJICogRFZGUyBwcmUg
c2VxdWVuY2Ugd291bGQgYmUgaGVyZSwgYnV0IGluIG91ciBkcml2ZXIgdGhlIGNkY2xrIGNvZGUK
PiBAQCAtMzEwNiwxMiArMzEwNiwxMiBAQCBzdGF0aWMgdm9pZCBtZ19wbGxfZW5hYmxlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkgKiBub3RoaW5nIGhlcmUuCj4gICAJ
ICovCj4gICAKPiAtCWljbF9wbGxfZW5hYmxlKGRldl9wcml2LCBwbGwsIGVuYWJsZV9yZWcpOwo+
ICsJaWNsX3BsbF9lbmFibGUoaTkxNSwgcGxsLCBlbmFibGVfcmVnKTsKPiAgIAo+ICAgCS8qIERW
RlMgcG9zdCBzZXF1ZW5jZSB3b3VsZCBiZSBoZXJlLiBTZWUgdGhlIGNvbW1lbnQgYWJvdmUuICov
Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaWNsX3BsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgaWNsX3BsbF9kaXNhYmxlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgIHN0cnVjdCBpbnRlbF9zaGFyZWRf
ZHBsbCAqcGxsLAo+ICAgCQkJICAgIGk5MTVfcmVnX3QgZW5hYmxlX3JlZykKPiAgIHsKPiBAQCAt
MzEzMCw3ICszMTMwLDcgQEAgc3RhdGljIHZvaWQgaWNsX3BsbF9kaXNhYmxlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlJOTE1X1dSSVRFKGVuYWJsZV9yZWcsIHZhbCk7
Cj4gICAKPiAgIAkvKiBUaW1lb3V0IGlzIGFjdHVhbGx5IDF1cy4gKi8KPiAtCWlmIChpbnRlbF93
YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwKPiArCWlmIChpbnRlbF93YWl0X2Zv
cl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+ICAgCQkJCSAgICBlbmFibGVfcmVnLCBQTExfTE9D
SywgMCwgMSkpCj4gICAJCURSTV9FUlJPUigiUExMICVkIGxvY2tlZFxuIiwgcGxsLT5pbmZvLT5p
ZCk7Cj4gICAKPiBAQCAtMzE0NCwzMyArMzE0NCwzMyBAQCBzdGF0aWMgdm9pZCBpY2xfcGxsX2Rp
c2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCSAqIFRoZSBzcGVj
IHNheXMgd2UgbmVlZCB0byAid2FpdCIgYnV0IGl0IGFsc28gc2F5cyBpdCBzaG91bGQgYmUKPiAg
IAkgKiBpbW1lZGlhdGUuCj4gICAJICovCj4gLQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIo
JmRldl9wcml2LT51bmNvcmUsCj4gKwlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUt
PnVuY29yZSwKPiAgIAkJCQkgICAgZW5hYmxlX3JlZywgUExMX1BPV0VSX1NUQVRFLCAwLCAxKSkK
PiAgIAkJRFJNX0VSUk9SKCJQTEwgJWQgUG93ZXIgbm90IGRpc2FibGVkXG4iLCBwbGwtPmluZm8t
PmlkKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBjb21ib19wbGxfZGlzYWJsZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGNvbWJvX3BsbF9kaXNh
YmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgICAgc3RydWN0IGlu
dGVsX3NoYXJlZF9kcGxsICpwbGwpCj4gICB7Cj4gLQlpY2xfcGxsX2Rpc2FibGUoZGV2X3ByaXYs
IHBsbCwgQ05MX0RQTExfRU5BQkxFKHBsbC0+aW5mby0+aWQpKTsKPiArCWljbF9wbGxfZGlzYWJs
ZShpOTE1LCBwbGwsIENOTF9EUExMX0VOQUJMRShwbGwtPmluZm8tPmlkKSk7Cj4gICB9Cj4gICAK
PiAtc3RhdGljIHZvaWQgdGJ0X3BsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgdGJ0X3BsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAo+ICAgCQkJICAgIHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsKQo+
ICAgewo+IC0JaWNsX3BsbF9kaXNhYmxlKGRldl9wcml2LCBwbGwsIFRCVF9QTExfRU5BQkxFKTsK
PiArCWljbF9wbGxfZGlzYWJsZShpOTE1LCBwbGwsIFRCVF9QTExfRU5BQkxFKTsKPiAgIH0KPiAg
IAo+IC1zdGF0aWMgdm9pZCBtZ19wbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIG1nX3BsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAo+ICAgCQkJICAgc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGwpCj4g
ICB7Cj4gICAJaTkxNV9yZWdfdCBlbmFibGVfcmVnID0KPiAgIAkJTUdfUExMX0VOQUJMRShpY2xf
cGxsX2lkX3RvX3RjX3BvcnQocGxsLT5pbmZvLT5pZCkpOwo+ICAgCj4gLQlpY2xfcGxsX2Rpc2Fi
bGUoZGV2X3ByaXYsIHBsbCwgZW5hYmxlX3JlZyk7Cj4gKwlpY2xfcGxsX2Rpc2FibGUoaTkxNSwg
cGxsLCBlbmFibGVfcmVnKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpY2xfZHVtcF9od19z
dGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGlj
bF9kdW1wX2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAg
ICAgY29uc3Qgc3RydWN0IGludGVsX2RwbGxfaHdfc3RhdGUgKmh3X3N0YXRlKQo+ICAgewo+ICAg
CURSTV9ERUJVR19LTVMoImRwbGxfaHdfc3RhdGU6IGNmZ2NyMDogMHgleCwgY2ZnY3IxOiAweCV4
LCAiCj4gQEAgLTMyNDcsMjggKzMyNDcsMjggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBpbnRlbF9k
cGxsX21nciBlaGxfcGxsX21nciA9IHsKPiAgICAqLwo+ICAgdm9pZCBpbnRlbF9zaGFyZWRfZHBs
bF9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAljb25zdCBzdHJ1Y3QgaW50ZWxfZHBsbF9t
Z3IgKmRwbGxfbWdyID0gTlVMTDsKPiAgIAljb25zdCBzdHJ1Y3QgZHBsbF9pbmZvICpkcGxsX2lu
Zm87Cj4gICAJaW50IGk7Cj4gICAKPiAtCWlmIChJU19FTEtIQVJUTEFLRShkZXZfcHJpdikpCj4g
KwlpZiAoSVNfRUxLSEFSVExBS0UoaTkxNSkpCj4gICAJCWRwbGxfbWdyID0gJmVobF9wbGxfbWdy
Owo+IC0JZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKPiArCWVsc2UgaWYgKElO
VEVMX0dFTihpOTE1KSA+PSAxMSkKPiAgIAkJZHBsbF9tZ3IgPSAmaWNsX3BsbF9tZ3I7Cj4gLQll
bHNlIGlmIChJU19DQU5OT05MQUtFKGRldl9wcml2KSkKPiArCWVsc2UgaWYgKElTX0NBTk5PTkxB
S0UoaTkxNSkpCj4gICAJCWRwbGxfbWdyID0gJmNubF9wbGxfbWdyOwo+IC0JZWxzZSBpZiAoSVNf
R0VOOV9CQyhkZXZfcHJpdikpCj4gKwllbHNlIGlmIChJU19HRU45X0JDKGk5MTUpKQo+ICAgCQlk
cGxsX21nciA9ICZza2xfcGxsX21ncjsKPiAtCWVsc2UgaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYp
KQo+ICsJZWxzZSBpZiAoSVNfR0VOOV9MUChpOTE1KSkKPiAgIAkJZHBsbF9tZ3IgPSAmYnh0X3Bs
bF9tZ3I7Cj4gLQllbHNlIGlmIChIQVNfRERJKGRldl9wcml2KSkKPiArCWVsc2UgaWYgKEhBU19E
REkoaTkxNSkpCj4gICAJCWRwbGxfbWdyID0gJmhzd19wbGxfbWdyOwo+IC0JZWxzZSBpZiAoSEFT
X1BDSF9JQlgoZGV2X3ByaXYpIHx8IEhBU19QQ0hfQ1BUKGRldl9wcml2KSkKPiArCWVsc2UgaWYg
KEhBU19QQ0hfSUJYKGk5MTUpIHx8IEhBU19QQ0hfQ1BUKGk5MTUpKQo+ICAgCQlkcGxsX21nciA9
ICZwY2hfcGxsX21ncjsKPiAgIAo+ICAgCWlmICghZHBsbF9tZ3IpIHsKPiAtCQlkZXZfcHJpdi0+
bnVtX3NoYXJlZF9kcGxsID0gMDsKPiArCQlpOTE1LT5udW1fc2hhcmVkX2RwbGwgPSAwOwo+ICAg
CQlyZXR1cm47Cj4gICAJfQo+ICAgCj4gQEAgLTMyNzYsMTQgKzMyNzYsMTQgQEAgdm9pZCBpbnRl
bF9zaGFyZWRfZHBsbF9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gICAKPiAgIAlmb3Ig
KGkgPSAwOyBkcGxsX2luZm9baV0ubmFtZTsgaSsrKSB7Cj4gICAJCVdBUk5fT04oaSAhPSBkcGxs
X2luZm9baV0uaWQpOwo+IC0JCWRldl9wcml2LT5zaGFyZWRfZHBsbHNbaV0uaW5mbyA9ICZkcGxs
X2luZm9baV07Cj4gKwkJaTkxNS0+c2hhcmVkX2RwbGxzW2ldLmluZm8gPSAmZHBsbF9pbmZvW2ld
Owo+ICAgCX0KPiAgIAo+IC0JZGV2X3ByaXYtPmRwbGxfbWdyID0gZHBsbF9tZ3I7Cj4gLQlkZXZf
cHJpdi0+bnVtX3NoYXJlZF9kcGxsID0gaTsKPiAtCW11dGV4X2luaXQoJmRldl9wcml2LT5kcGxs
X2xvY2spOwo+ICsJaTkxNS0+ZHBsbF9tZ3IgPSBkcGxsX21ncjsKPiArCWk5MTUtPm51bV9zaGFy
ZWRfZHBsbCA9IGk7Cj4gKwltdXRleF9pbml0KCZpOTE1LT5kcGxsX2xvY2spOwo+ICAgCj4gLQlC
VUdfT04oZGV2X3ByaXYtPm51bV9zaGFyZWRfZHBsbCA+IEk5MTVfTlVNX1BMTFMpOwo+ICsJQlVH
X09OKGk5MTUtPm51bV9zaGFyZWRfZHBsbCA+IEk5MTVfTlVNX1BMTFMpOwo+ICAgfQo+ICAgCj4g
ICAvKioKPiBAQCAtMzMwNCw4ICszMzA0LDggQEAgc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICoK
PiAgIGludGVsX2dldF9zaGFyZWRfZHBsbChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSwKPiAgIAkJICAgICAgc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICB7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUt
PmJhc2UuY3J0Yy0+ZGV2KTsKPiAtCWNvbnN0IHN0cnVjdCBpbnRlbF9kcGxsX21nciAqZHBsbF9t
Z3IgPSBkZXZfcHJpdi0+ZHBsbF9tZ3I7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICsJY29uc3Qgc3RydWN0
IGludGVsX2RwbGxfbWdyICpkcGxsX21nciA9IGk5MTUtPmRwbGxfbWdyOwo+ICAgCj4gICAJaWYg
KFdBUk5fT04oIWRwbGxfbWdyKSkKPiAgIAkJcmV0dXJuIE5VTEw7Cj4gQEAgLTMzMzUsMTYgKzMz
MzUsMTYgQEAgdm9pZCBpbnRlbF9yZWxlYXNlX3NoYXJlZF9kcGxsKHN0cnVjdCBpbnRlbF9zaGFy
ZWRfZHBsbCAqZHBsbCwKPiAgIAo+ICAgLyoqCj4gICAgKiBpbnRlbF9zaGFyZWRfZHBsbF9kdW1w
X2h3X3N0YXRlIC0gd3JpdGUgaHdfc3RhdGUgdG8gZG1lc2cKPiAtICogQGRldl9wcml2OiBpOTE1
IGRybSBkZXZpY2UKPiArICogQGk5MTU6IGk5MTUgZHJtIGRldmljZQo+ICAgICogQGh3X3N0YXRl
OiBodyBzdGF0ZSB0byBiZSB3cml0dGVuIHRvIHRoZSBsb2cKPiAgICAqCj4gICAgKiBXcml0ZSB0
aGUgcmVsZXZhbnQgdmFsdWVzIGluIEBod19zdGF0ZSB0byBkbWVzZyB1c2luZyBEUk1fREVCVUdf
S01TLgo+ICAgICovCj4gLXZvaWQgaW50ZWxfZHBsbF9kdW1wX2h3X3N0YXRlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArdm9pZCBpbnRlbF9kcGxsX2R1bXBfaHdfc3RhdGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICAgICBjb25zdCBzdHJ1Y3Qg
aW50ZWxfZHBsbF9od19zdGF0ZSAqaHdfc3RhdGUpCj4gICB7Cj4gLQlpZiAoZGV2X3ByaXYtPmRw
bGxfbWdyKSB7Cj4gLQkJZGV2X3ByaXYtPmRwbGxfbWdyLT5kdW1wX2h3X3N0YXRlKGRldl9wcml2
LCBod19zdGF0ZSk7Cj4gKwlpZiAoaTkxNS0+ZHBsbF9tZ3IpIHsKPiArCQlpOTE1LT5kcGxsX21n
ci0+ZHVtcF9od19zdGF0ZShpOTE1LCBod19zdGF0ZSk7Cj4gICAJfSBlbHNlIHsKPiAgIAkJLyog
ZmFsbGJhY2sgZm9yIHBsYXRmb3JtcyB0aGF0IGRvbid0IHVzZSB0aGUgc2hhcmVkIGRwbGwKPiAg
IAkJICogaW5mcmFzdHJ1Y3R1cmUKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfZHBsbF9tZ3IuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RwbGxfbWdyLmgK
PiBpbmRleCBkMDU3MDQxNGYzZDEuLmIwNjhjODQ0MTMyOCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9kcGxsX21nci5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfZHBsbF9tZ3IuaAo+IEBAIC0yMjEsNyArMjIxLDcgQEAgc3RydWN0IGludGVsX3No
YXJlZF9kcGxsX2Z1bmNzIHsKPiAgIAkgKiBDYWxsZWQgZnJvbSBpbnRlbF9wcmVwYXJlX3NoYXJl
ZF9kcGxsKCkgZnVuY3Rpb24gdW5sZXNzIHRoZSBQTEwKPiAgIAkgKiBpcyBhbHJlYWR5IGVuYWJs
ZWQuCj4gICAJICovCj4gLQl2b2lkICgqcHJlcGFyZSkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICsJdm9pZCAoKnByZXBhcmUpKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ICAgCQkJc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGwpOwo+ICAgCj4gICAJLyoq
Cj4gQEAgLTIzMCw3ICsyMzAsNyBAQCBzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGxfZnVuY3Mgewo+
ICAgCSAqIEhvb2sgZm9yIGVuYWJsaW5nIHRoZSBwbGwsIGNhbGxlZCBmcm9tIGludGVsX2VuYWJs
ZV9zaGFyZWRfZHBsbCgpCj4gICAJICogaWYgdGhlIHBsbCBpcyBub3QgYWxyZWFkeSBlbmFibGVk
Lgo+ICAgCSAqLwo+IC0Jdm9pZCAoKmVuYWJsZSkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ICsJdm9pZCAoKmVuYWJsZSkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gICAJCSAgICAgICBzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCk7Cj4gICAKPiAgIAkv
KioKPiBAQCAtMjQwLDcgKzI0MCw3IEBAIHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbF9mdW5jcyB7
Cj4gICAJICogb25seSB3aGVuIGl0IGlzIHNhZmUgdG8gZGlzYWJsZSB0aGUgcGxsLCBpLmUuLCB0
aGVyZSBhcmUgbm8gbW9yZQo+ICAgCSAqIHRyYWNrZWQgdXNlcnMgZm9yIGl0Lgo+ICAgCSAqLwo+
IC0Jdm9pZCAoKmRpc2FibGUpKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAr
CXZvaWQgKCpkaXNhYmxlKShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCXN0
cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsKTsKPiAgIAo+ICAgCS8qKgo+IEBAIC0yNTAsNyAr
MjUwLDcgQEAgc3RydWN0IGludGVsX3NoYXJlZF9kcGxsX2Z1bmNzIHsKPiAgIAkgKiByZWdpc3Rl
cnMuIFRoaXMgaXMgdXNlZCBmb3IgaW5pdGlhbCBodyBzdGF0ZSByZWFkb3V0IGFuZCBzdGF0ZQo+
ICAgCSAqIHZlcmlmaWNhdGlvbiBhZnRlciBhIG1vZGUgc2V0Lgo+ICAgCSAqLwo+IC0JYm9vbCAo
KmdldF9od19zdGF0ZSkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICsJYm9v
bCAoKmdldF9od19zdGF0ZSkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkg
ICAgIHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsLAo+ICAgCQkJICAgICBzdHJ1Y3QgaW50
ZWxfZHBsbF9od19zdGF0ZSAqaHdfc3RhdGUpOwo+ICAgfTsKPiBAQCAtMjcxLDcgKzI3MSw3IEBA
IHN0cnVjdCBkcGxsX2luZm8gewo+ICAgCj4gICAJLyoqCj4gICAJICogQGlkOiB1bmlxdWUgaW5k
ZW50aWZpZXIgZm9yIHRoaXMgRFBMTDsgc2hvdWxkIG1hdGNoIHRoZSBpbmRleCBpbiB0aGUKPiAt
CSAqIGRldl9wcml2LT5zaGFyZWRfZHBsbHMgYXJyYXkKPiArCSAqIGk5MTUtPnNoYXJlZF9kcGxs
cyBhcnJheQo+ICAgCSAqLwo+ICAgCWVudW0gaW50ZWxfZHBsbF9pZCBpZDsKPiAgIAo+IEBAIC0z
MjEsMTIgKzMyMSwxMiBAQCBzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgewo+ICAgCj4gICAvKiBz
aGFyZWQgZHBsbCBmdW5jdGlvbnMgKi8KPiAgIHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqCj4g
LWludGVsX2dldF9zaGFyZWRfZHBsbF9ieV9pZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gK2ludGVsX2dldF9zaGFyZWRfZHBsbF9ieV9pZChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiAgIAkJCSAgICBlbnVtIGludGVsX2RwbGxfaWQgaWQpOwo+ICAgZW51bSBp
bnRlbF9kcGxsX2lkCj4gLWludGVsX2dldF9zaGFyZWRfZHBsbF9pZChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2ludGVsX2dldF9zaGFyZWRfZHBsbF9pZChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSBzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBs
bCk7Cj4gLXZvaWQgYXNzZXJ0X3NoYXJlZF9kcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiArdm9pZCBhc3NlcnRfc2hhcmVkX2RwbGwoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gICAJCQlzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCwKPiAgIAkJCWJv
b2wgc3RhdGUpOwo+ICAgI2RlZmluZSBhc3NlcnRfc2hhcmVkX2RwbGxfZW5hYmxlZChkLCBwKSBh
c3NlcnRfc2hhcmVkX2RwbGwoZCwgcCwgdHJ1ZSkKPiBAQCAtMzQyLDkgKzM0Miw5IEBAIHZvaWQg
aW50ZWxfZGlzYWJsZV9zaGFyZWRfZHBsbChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSk7Cj4gICB2b2lkIGludGVsX3NoYXJlZF9kcGxsX3N3YXBfc3RhdGUoc3RydWN0
IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKTsKPiAgIHZvaWQgaW50ZWxfc2hhcmVkX2RwbGxfaW5p
dChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KTsKPiAgIAo+IC12b2lkIGludGVsX2RwbGxfZHVtcF9o
d19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3ZvaWQgaW50ZWxf
ZHBsbF9kdW1wX2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJ
ICAgICAgY29uc3Qgc3RydWN0IGludGVsX2RwbGxfaHdfc3RhdGUgKmh3X3N0YXRlKTsKPiAtaW50
IGNubF9oZG1pX3BsbF9yZWZfY2xvY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KTsKPiAraW50IGNubF9oZG1pX3BsbF9yZWZfY2xvY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpOwo+ICAgZW51bSBpbnRlbF9kcGxsX2lkIGljbF90Y19wb3J0X3RvX3BsbF9pZChlbnVt
IHRjX3BvcnQgdGNfcG9ydCk7Cj4gICBib29sIGludGVsX2RwbGxfaXNfY29tYm9waHkoZW51bSBp
bnRlbF9kcGxsX2lkIGlkKTsKPiAgIAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rydi5oCj4gaW5kZXgg
M2UzMzczMTdmNzdlLi4yMzA2NWRkYTgyZDkgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfZHJ2LmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcnYu
aAo+IEBAIC05NjMsNyArOTYzLDcgQEAgc3RydWN0IGludGVsX2NydGMgewo+ICAgCj4gICAJc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNvbmZpZzsKPiAgIAo+IC0JLyogQWNjZXNzIHRvIHRoZXNl
IHNob3VsZCBiZSBwcm90ZWN0ZWQgYnkgZGV2X3ByaXYtPmlycV9sb2NrLiAqLwo+ICsJLyogQWNj
ZXNzIHRvIHRoZXNlIHNob3VsZCBiZSBwcm90ZWN0ZWQgYnkgaTkxNS0+aXJxX2xvY2suICovCj4g
ICAJYm9vbCBjcHVfZmlmb191bmRlcnJ1bl9kaXNhYmxlZDsKPiAgIAlib29sIHBjaF9maWZvX3Vu
ZGVycnVuX2Rpc2FibGVkOwo+ICAgCj4gQEAgLTEyOTMsMTUgKzEyOTMsMTUgQEAgdmx2X3BpcGVf
dG9fY2hhbm5lbChlbnVtIHBpcGUgcGlwZSkKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGlubGluZSBz
dHJ1Y3QgaW50ZWxfY3J0YyAqCj4gLWludGVsX2dldF9jcnRjX2Zvcl9waXBlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUpCj4gK2ludGVsX2dldF9jcnRj
X2Zvcl9waXBlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBpcGUgcGlwZSkK
PiAgIHsKPiAtCXJldHVybiBkZXZfcHJpdi0+cGlwZV90b19jcnRjX21hcHBpbmdbcGlwZV07Cj4g
KwlyZXR1cm4gaTkxNS0+cGlwZV90b19jcnRjX21hcHBpbmdbcGlwZV07Cj4gICB9Cj4gICAKPiAg
IHN0YXRpYyBpbmxpbmUgc3RydWN0IGludGVsX2NydGMgKgo+IC1pbnRlbF9nZXRfY3J0Y19mb3Jf
cGxhbmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIGk5eHhfcGxhbmVf
aWQgcGxhbmUpCj4gK2ludGVsX2dldF9jcnRjX2Zvcl9wbGFuZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwgZW51bSBpOXh4X3BsYW5lX2lkIHBsYW5lKQo+ICAgewo+IC0JcmV0dXJuIGRl
dl9wcml2LT5wbGFuZV90b19jcnRjX21hcHBpbmdbcGxhbmVdOwo+ICsJcmV0dXJuIGk5MTUtPnBs
YW5lX3RvX2NydGNfbWFwcGluZ1twbGFuZV07Cj4gICB9Cj4gICAKPiAgIHN0cnVjdCBpbnRlbF9s
b2FkX2RldGVjdF9waXBlIHsKPiBAQCAtMTQ0NywxNyArMTQ0NywxNyBAQCBpbnRlbF9hdG9taWNf
Z2V0X25ld19jcnRjX3N0YXRlKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+ICAg
Cj4gICAvKiBpbnRlbF9kaXNwbGF5LmMgKi8KPiAgIHZvaWQgaW50ZWxfcGxhbmVfZGVzdHJveShz
dHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSk7Cj4gLXZvaWQgaTgzMF9lbmFibGVfcGlwZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlwZSBwaXBlKTsKPiAtdm9pZCBpODMw
X2Rpc2FibGVfcGlwZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlw
ZSBwaXBlKTsKPiArdm9pZCBpODMwX2VuYWJsZV9waXBlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LCBlbnVtIHBpcGUgcGlwZSk7Cj4gK3ZvaWQgaTgzMF9kaXNhYmxlX3BpcGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gcGlwZSBwaXBlKTsKPiAgIGVudW0gcGlwZSBp
bnRlbF9jcnRjX3BjaF90cmFuc2NvZGVyKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKTsKPiAtaW50
IHZsdl9nZXRfaHBsbF92Y28oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAt
aW50IHZsdl9nZXRfY2NrX2Nsb2NrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiAraW50IHZsdl9nZXRfaHBsbF92Y28oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+
ICtpbnQgdmx2X2dldF9jY2tfY2xvY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
ICAJCSAgICAgIGNvbnN0IGNoYXIgKm5hbWUsIHUzMiByZWcsIGludCByZWZfZnJlcSk7Cj4gLWlu
dCB2bHZfZ2V0X2Nja19jbG9ja19ocGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiAraW50IHZsdl9nZXRfY2NrX2Nsb2NrX2hwbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCj4gICAJCQkgICBjb25zdCBjaGFyICpuYW1lLCB1MzIgcmVnKTsKPiAtdm9pZCBscHRf
ZGlzYWJsZV9wY2hfdHJhbnNjb2RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Owo+IC12b2lkIGxwdF9kaXNhYmxlX2ljbGtpcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpOwo+IC12b2lkIGludGVsX2luaXRfZGlzcGxheV9ob29rcyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpOwo+ICt2b2lkIGxwdF9kaXNhYmxlX3BjaF90cmFuc2NvZGVyKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiArdm9pZCBscHRfZGlzYWJsZV9pY2xraXAo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lkIGludGVsX2luaXRfZGlzcGxh
eV9ob29rcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICB1bnNpZ25lZCBpbnQg
aW50ZWxfZmJfeHlfdG9fbGluZWFyKGludCB4LCBpbnQgeSwKPiAgIAkJCQkgICBjb25zdCBzdHJ1
Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnN0YXRlLAo+ICAgCQkJCSAgIGludCBwbGFuZSk7Cj4gQEAg
LTE0NjcsMTkgKzE0NjcsMTkgQEAgdm9pZCBpbnRlbF9hZGRfZmJfb2Zmc2V0cyhpbnQgKngsIGlu
dCAqeSwKPiAgIAkJCSAgY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpzdGF0ZSwgaW50
IHBsYW5lKTsKPiAgIHVuc2lnbmVkIGludCBpbnRlbF9yb3RhdGlvbl9pbmZvX3NpemUoY29uc3Qg
c3RydWN0IGludGVsX3JvdGF0aW9uX2luZm8gKnJvdF9pbmZvKTsKPiAgIHVuc2lnbmVkIGludCBp
bnRlbF9yZW1hcHBlZF9pbmZvX3NpemUoY29uc3Qgc3RydWN0IGludGVsX3JlbWFwcGVkX2luZm8g
KnJlbV9pbmZvKTsKPiAtYm9vbCBpbnRlbF9oYXNfcGVuZGluZ19mYl91bnBpbihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ICtib29sIGludGVsX2hhc19wZW5kaW5nX2ZiX3Vu
cGluKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAgIGludCBpbnRlbF9kaXNwbGF5
X3N1c3BlbmQoc3RydWN0IGRybV9kZXZpY2UgKmRldik7Cj4gLXZvaWQgaW50ZWxfcHBzX3VubG9j
a19yZWdzX3dhKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gK3ZvaWQgaW50
ZWxfcHBzX3VubG9ja19yZWdzX3dhKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAg
IHZvaWQgaW50ZWxfZW5jb2Rlcl9kZXN0cm95KHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2Rlcik7
Cj4gICBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqCj4gICBpbnRlbF9lbmNvZGVyX2N1cnJlbnRf
bW9kZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rlcik7Cj4gLWJvb2wgaW50ZWxfcG9ydF9p
c19jb21ib3BoeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcG9ydCBw
b3J0KTsKPiAtYm9vbCBpbnRlbF9wb3J0X2lzX3RjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwgZW51bSBwb3J0IHBvcnQpOwo+IC1lbnVtIHRjX3BvcnQgaW50ZWxfcG9ydF90b190
YyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2Jvb2wgaW50ZWxfcG9ydF9p
c19jb21ib3BoeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBwb3J0IHBvcnQp
Owo+ICtib29sIGludGVsX3BvcnRfaXNfdGMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
IGVudW0gcG9ydCBwb3J0KTsKPiArZW51bSB0Y19wb3J0IGludGVsX3BvcnRfdG9fdGMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICAgICBlbnVtIHBvcnQgcG9ydCk7Cj4g
ICBpbnQgaW50ZWxfZ2V0X3BpcGVfZnJvbV9jcnRjX2lkX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYsIHZvaWQgKmRhdGEsCj4gICAJCQkJICAgICAgc3RydWN0IGRybV9maWxlICpmaWxlX3By
aXYpOwo+IC1lbnVtIHRyYW5zY29kZXIgaW50ZWxfcGlwZV90b19jcHVfdHJhbnNjb2RlcihzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2VudW0gdHJhbnNjb2RlciBpbnRlbF9w
aXBlX3RvX2NwdV90cmFuc2NvZGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAg
CQkJCQkgICAgIGVudW0gcGlwZSBwaXBlKTsKPiAgIHN0YXRpYyBpbmxpbmUgYm9vbAo+ICAgaW50
ZWxfY3J0Y19oYXNfdHlwZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSwKPiBAQCAtMTQ5NiwyMyArMTQ5NiwyMyBAQCBpbnRlbF9jcnRjX2hhc19kcF9lbmNvZGVyKGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgCQkgKDEgPDwgSU5U
RUxfT1VUUFVUX0VEUCkpOwo+ICAgfQo+ICAgc3RhdGljIGlubGluZSB2b2lkCj4gLWludGVsX3dh
aXRfZm9yX3ZibGFuayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlw
ZSBwaXBlKQo+ICtpbnRlbF93YWl0X2Zvcl92Ymxhbmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsIGVudW0gcGlwZSBwaXBlKQo+ICAgewo+IC0JZHJtX3dhaXRfb25lX3ZibGFuaygmZGV2
X3ByaXYtPmRybSwgcGlwZSk7Cj4gKwlkcm1fd2FpdF9vbmVfdmJsYW5rKCZpOTE1LT5kcm0sIHBp
cGUpOwo+ICAgfQo+ICAgc3RhdGljIGlubGluZSB2b2lkCj4gLWludGVsX3dhaXRfZm9yX3ZibGFu
a19pZl9hY3RpdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgcGlwZSkK
PiAraW50ZWxfd2FpdF9mb3JfdmJsYW5rX2lmX2FjdGl2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwgaW50IHBpcGUpCj4gICB7Cj4gLQljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YyA9IGludGVsX2dldF9jcnRjX2Zvcl9waXBlKGRldl9wcml2LCBwaXBlKTsKPiArCWNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoaTkxNSwgcGlw
ZSk7Cj4gICAKPiAgIAlpZiAoY3J0Yy0+YWN0aXZlKQo+IC0JCWludGVsX3dhaXRfZm9yX3ZibGFu
ayhkZXZfcHJpdiwgcGlwZSk7Cj4gKwkJaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGk5MTUsIHBpcGUp
Owo+ICAgfQo+ICAgCj4gICB1MzIgaW50ZWxfY3J0Y19nZXRfdmJsYW5rX2NvdW50ZXIoc3RydWN0
IGludGVsX2NydGMgKmNydGMpOwo+ICAgCj4gICBpbnQgaXJvbmxha2VfZ2V0X2xhbmVzX3JlcXVp
cmVkKGludCB0YXJnZXRfY2xvY2ssIGludCBsaW5rX2J3LCBpbnQgYnBwKTsKPiAtdm9pZCB2bHZf
d2FpdF9wb3J0X3JlYWR5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArdm9p
ZCB2bHZfd2FpdF9wb3J0X3JlYWR5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAg
CQkJIHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRwb3J0LAo+ICAgCQkJIHVuc2lnbmVkIGlu
dCBleHBlY3RlZF9tYXNrKTsKPiAgIGludCBpbnRlbF9nZXRfbG9hZF9kZXRlY3RfcGlwZShzdHJ1
Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+IEBAIC0xNTM2LDM0ICsxNTM2LDM0IEBAIGlu
dCBpbnRlbF9wcmVwYXJlX3BsYW5lX2ZiKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLAo+ICAgdm9p
ZCBpbnRlbF9jbGVhbnVwX3BsYW5lX2ZiKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLAo+ICAgCQkJ
ICAgIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm9sZF9zdGF0ZSk7Cj4gICAKPiAtdm9pZCBhc3Nl
cnRfcGNoX3RyYW5zY29kZXJfZGlzYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ICt2b2lkIGFzc2VydF9wY2hfdHJhbnNjb2Rlcl9kaXNhYmxlZChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAgZW51bSBwaXBlIHBpcGUpOwo+ICAgCj4gLWlu
dCB2bHZfZm9yY2VfcGxsX29uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51
bSBwaXBlIHBpcGUsCj4gK2ludCB2bHZfZm9yY2VfcGxsX29uKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LCBlbnVtIHBpcGUgcGlwZSwKPiAgIAkJICAgICBjb25zdCBzdHJ1Y3QgZHBsbCAq
ZHBsbCk7Cj4gLXZvaWQgdmx2X2ZvcmNlX3BsbF9vZmYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LCBlbnVtIHBpcGUgcGlwZSk7Cj4gLWludCBscHRfZ2V0X2ljbGtpcChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ICt2b2lkIHZsdl9mb3JjZV9wbGxfb2ZmKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBpcGUgcGlwZSk7Cj4gK2ludCBscHRf
Z2V0X2ljbGtpcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICBib29sIGludGVs
X2Z1enp5X2Nsb2NrX2NoZWNrKGludCBjbG9jazEsIGludCBjbG9jazIpOwo+ICAgCj4gICAvKiBt
b2Rlc2V0dGluZyBhc3NlcnRzICovCj4gLXZvaWQgYXNzZXJ0X3BhbmVsX3VubG9ja2VkKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArdm9pZCBhc3NlcnRfcGFuZWxfdW5sb2Nr
ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICBlbnVtIHBpcGUgcGlw
ZSk7Cj4gLXZvaWQgYXNzZXJ0X3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gK3ZvaWQgYXNzZXJ0X3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJ
ZW51bSBwaXBlIHBpcGUsIGJvb2wgc3RhdGUpOwo+ICAgI2RlZmluZSBhc3NlcnRfcGxsX2VuYWJs
ZWQoZCwgcCkgYXNzZXJ0X3BsbChkLCBwLCB0cnVlKQo+ICAgI2RlZmluZSBhc3NlcnRfcGxsX2Rp
c2FibGVkKGQsIHApIGFzc2VydF9wbGwoZCwgcCwgZmFsc2UpCj4gLXZvaWQgYXNzZXJ0X2RzaV9w
bGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBib29sIHN0YXRlKTsKPiArdm9p
ZCBhc3NlcnRfZHNpX3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgYm9vbCBzdGF0
ZSk7Cj4gICAjZGVmaW5lIGFzc2VydF9kc2lfcGxsX2VuYWJsZWQoZCkgYXNzZXJ0X2RzaV9wbGwo
ZCwgdHJ1ZSkKPiAgICNkZWZpbmUgYXNzZXJ0X2RzaV9wbGxfZGlzYWJsZWQoZCkgYXNzZXJ0X2Rz
aV9wbGwoZCwgZmFsc2UpCj4gLXZvaWQgYXNzZXJ0X2ZkaV9yeF9wbGwoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ICt2b2lkIGFzc2VydF9mZGlfcnhfcGxsKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkgICAgICAgZW51bSBwaXBlIHBpcGUsIGJvb2wgc3Rh
dGUpOwo+ICAgI2RlZmluZSBhc3NlcnRfZmRpX3J4X3BsbF9lbmFibGVkKGQsIHApIGFzc2VydF9m
ZGlfcnhfcGxsKGQsIHAsIHRydWUpCj4gICAjZGVmaW5lIGFzc2VydF9mZGlfcnhfcGxsX2Rpc2Fi
bGVkKGQsIHApIGFzc2VydF9mZGlfcnhfcGxsKGQsIHAsIGZhbHNlKQo+IC12b2lkIGFzc2VydF9w
aXBlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUsIGJv
b2wgc3RhdGUpOwo+ICt2b2lkIGFzc2VydF9waXBlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LCBlbnVtIHBpcGUgcGlwZSwgYm9vbCBzdGF0ZSk7Cj4gICAjZGVmaW5lIGFzc2VydF9waXBl
X2VuYWJsZWQoZCwgcCkgYXNzZXJ0X3BpcGUoZCwgcCwgdHJ1ZSkKPiAgICNkZWZpbmUgYXNzZXJ0
X3BpcGVfZGlzYWJsZWQoZCwgcCkgYXNzZXJ0X3BpcGUoZCwgcCwgZmFsc2UpCj4gLXZvaWQgaW50
ZWxfcHJlcGFyZV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC12
b2lkIGludGVsX2ZpbmlzaF9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Owo+ICt2b2lkIGludGVsX3ByZXBhcmVfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpOwo+ICt2b2lkIGludGVsX2ZpbmlzaF9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSk7Cj4gICB2b2lkIGludGVsX2RwX2dldF9tX24oc3RydWN0IGludGVsX2NydGMgKmNydGMs
Cj4gICAJCSAgICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZyk7Cj4gICB2
b2lkIGludGVsX2RwX3NldF9tX24oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUsCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RzaS5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHNpLmMKPiBpbmRleCA1ZmVjMDJhY2VhZWQuLjA5
NDE0ZGEzZDgxOCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kc2ku
Ywo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RzaS5jCj4gQEAgLTExMywxNCAr
MTEzLDE0IEBAIHN0cnVjdCBpbnRlbF9kc2lfaG9zdCAqaW50ZWxfZHNpX2hvc3RfaW5pdChzdHJ1
Y3QgaW50ZWxfZHNpICppbnRlbF9kc2ksCj4gICBlbnVtIGRybV9wYW5lbF9vcmllbnRhdGlvbgo+
ICAgaW50ZWxfZHNpX2dldF9wYW5lbF9vcmllbnRhdGlvbihzdHJ1Y3QgaW50ZWxfY29ubmVjdG9y
ICpjb25uZWN0b3IpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICAgCWVudW0gZHJtX3Bh
bmVsX29yaWVudGF0aW9uIG9yaWVudGF0aW9uOwo+ICAgCj4gLQlvcmllbnRhdGlvbiA9IGRldl9w
cml2LT52YnQuZHNpLm9yaWVudGF0aW9uOwo+ICsJb3JpZW50YXRpb24gPSBpOTE1LT52YnQuZHNp
Lm9yaWVudGF0aW9uOwo+ICAgCWlmIChvcmllbnRhdGlvbiAhPSBEUk1fTU9ERV9QQU5FTF9PUklF
TlRBVElPTl9VTktOT1dOKQo+ICAgCQlyZXR1cm4gb3JpZW50YXRpb247Cj4gICAKPiAtCW9yaWVu
dGF0aW9uID0gZGV2X3ByaXYtPnZidC5vcmllbnRhdGlvbjsKPiArCW9yaWVudGF0aW9uID0gaTkx
NS0+dmJ0Lm9yaWVudGF0aW9uOwo+ICAgCWlmIChvcmllbnRhdGlvbiAhPSBEUk1fTU9ERV9QQU5F
TF9PUklFTlRBVElPTl9VTktOT1dOKQo+ICAgCQlyZXR1cm4gb3JpZW50YXRpb247Cj4gICAKPiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHNpLmggYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF9kc2kuaAo+IGluZGV4IDZkMjA0MzQ2MzZjZC4uMmY0NzcyNjNkMWY2
IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RzaS5oCj4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHNpLmgKPiBAQCAtMTU1LDcgKzE1NSw3IEBAIHN0
YXRpYyBpbmxpbmUgdTE2IGludGVsX2RzaV9lbmNvZGVyX3BvcnRzKHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyKQo+ICAgfQo+ICAgCj4gICAvKiBpY2xfZHNpLmMgKi8KPiAtdm9pZCBpY2xf
ZHNpX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiArdm9pZCBpY2xf
ZHNpX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgCj4gICAvKiBpbnRl
bF9kc2kuYyAqLwo+ICAgaW50IGludGVsX2RzaV9iaXRyYXRlKGNvbnN0IHN0cnVjdCBpbnRlbF9k
c2kgKmludGVsX2RzaSk7Cj4gQEAgLTE3Miw3ICsxNzIsNyBAQCBlbnVtIGRybV9tb2RlX3N0YXR1
cyBpbnRlbF9kc2lfbW9kZV92YWxpZChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+
ICAgc3RydWN0IGludGVsX2RzaV9ob3N0ICppbnRlbF9kc2lfaG9zdF9pbml0KHN0cnVjdCBpbnRl
bF9kc2kgKmludGVsX2RzaSwKPiAgIAkJCQkJICAgY29uc3Qgc3RydWN0IG1pcGlfZHNpX2hvc3Rf
b3BzICpmdW5jcywKPiAgIAkJCQkJICAgZW51bSBwb3J0IHBvcnQpOwo+IC12b2lkIHZsdl9kc2lf
aW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ICt2b2lkIHZsdl9kc2lf
aW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICAKPiAgIC8qIHZsdl9kc2lf
cGxsLmMgKi8KPiAgIGludCB2bHZfZHNpX3BsbF9jb21wdXRlKHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLAo+IEBAIC0xODQsNyArMTg0LDcgQEAgdTMyIHZsdl9kc2lfZ2V0X3BjbGsoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCSAgICAgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNvbmZpZyk7Cj4gICB2b2lkIHZsdl9kc2lfcmVzZXRfY2xvY2tzKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLCBlbnVtIHBvcnQgcG9ydCk7Cj4gICAKPiAtYm9vbCBieHRfZHNp
X3BsbF9pc19lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gK2Jv
b2wgYnh0X2RzaV9wbGxfaXNfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7
Cj4gICBpbnQgYnh0X2RzaV9wbGxfY29tcHV0ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKPiAgIAkJCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjb25maWcpOwo+ICAgdm9pZCBieHRf
ZHNpX3BsbF9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RzaV9kY3NfYmFja2xpZ2h0LmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kc2lfZGNzX2JhY2tsaWdodC5jCj4gaW5kZXggOGMzMzI2
MmNiMGIyLi5lNWRkNDk2MjcwNWMgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfZHNpX2Rjc19iYWNrbGlnaHQuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX2RzaV9kY3NfYmFja2xpZ2h0LmMKPiBAQCAtMTU5LDExICsxNTksMTEgQEAgc3RhdGljIGlu
dCBkY3Nfc2V0dXBfYmFja2xpZ2h0KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwK
PiAgIGludCBpbnRlbF9kc2lfZGNzX2luaXRfYmFja2xpZ2h0X2Z1bmNzKHN0cnVjdCBpbnRlbF9j
b25uZWN0b3IgKmludGVsX2Nvbm5lY3RvcikKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2ID0gaW50ZWxfY29ubmVjdG9yLT5iYXNlLmRldjsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
ID0gaW50ZWxfY29ubmVjdG9yLT5lbmNvZGVyOwo+ICAgCXN0cnVjdCBpbnRlbF9wYW5lbCAqcGFu
ZWwgPSAmaW50ZWxfY29ubmVjdG9yLT5wYW5lbDsKPiAgIAo+IC0JaWYgKGRldl9wcml2LT52YnQu
YmFja2xpZ2h0LnR5cGUgIT0gSU5URUxfQkFDS0xJR0hUX0RTSV9EQ1MpCj4gKwlpZiAoaTkxNS0+
dmJ0LmJhY2tsaWdodC50eXBlICE9IElOVEVMX0JBQ0tMSUdIVF9EU0lfRENTKQo+ICAgCQlyZXR1
cm4gLUVOT0RFVjsKPiAgIAo+ICAgCWlmIChXQVJOX09OKGVuY29kZXItPnR5cGUgIT0gSU5URUxf
T1VUUFVUX0RTSSkpCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rz
aV92YnQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RzaV92YnQuYwo+IGluZGV4IGU1
YjE3ODY2MDQwOC4uZDQ0ZWJkZmQ4NzYwIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX2RzaV92YnQuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rz
aV92YnQuYwo+IEBAIC0xMjEsNyArMTIxLDcgQEAgc3RhdGljIGlubGluZSBlbnVtIHBvcnQgaW50
ZWxfZHNpX3NlcV9wb3J0X3RvX3BvcnQodTggcG9ydCkKPiAgIHN0YXRpYyBjb25zdCB1OCAqbWlw
aV9leGVjX3NlbmRfcGFja2V0KHN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSwKPiAgIAkJCQkg
ICAgICAgY29uc3QgdTggKmRhdGEpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGludGVsX2RzaS0+YmFzZS5iYXNlLmRldik7Cj4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoaW50ZWxfZHNpLT5iYXNlLmJhc2UuZGV2
KTsKPiAgIAlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkc2lfZGV2aWNlOwo+ICAgCXU4IHR5cGUs
IGZsYWdzLCBzZXFfcG9ydDsKPiAgIAl1MTYgbGVuOwo+IEBAIC0xOTIsNyArMTkyLDcgQEAgc3Rh
dGljIGNvbnN0IHU4ICptaXBpX2V4ZWNfc2VuZF9wYWNrZXQoc3RydWN0IGludGVsX2RzaSAqaW50
ZWxfZHNpLAo+ICAgCQlicmVhazsKPiAgIAl9Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpIDwgMTEpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgMTEpCj4gICAJCXZsdl9kc2lfd2Fp
dF9mb3JfZmlmb19lbXB0eShpbnRlbF9kc2ksIHBvcnQpOwo+ICAgCj4gICBvdXQ6Cj4gQEAgLTIx
Myw3ICsyMTMsNyBAQCBzdGF0aWMgY29uc3QgdTggKm1pcGlfZXhlY19kZWxheShzdHJ1Y3QgaW50
ZWxfZHNpICppbnRlbF9kc2ksIGNvbnN0IHU4ICpkYXRhKQo+ICAgCXJldHVybiBkYXRhOwo+ICAg
fQo+ICAgCj4gLXN0YXRpYyB2b2lkIHZsdl9leGVjX2dwaW8oc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCB2bHZfZXhlY19ncGlvKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCQkJICB1OCBncGlvX3NvdXJjZSwgdTggZ3Bpb19pbmRleCwg
Ym9vbCB2YWx1ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgZ3Bpb19tYXAgKm1hcDsKPiBAQCAtMjI4LDcg
KzIyOCw3IEBAIHN0YXRpYyB2b2lkIHZsdl9leGVjX2dwaW8oc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ICAgCj4gICAJbWFwID0gJnZsdl9ncGlvX3RhYmxlW2dwaW9faW5kZXhd
Owo+ICAgCj4gLQlpZiAoZGV2X3ByaXYtPnZidC5kc2kuc2VxX3ZlcnNpb24gPj0gMykgewo+ICsJ
aWYgKGk5MTUtPnZidC5kc2kuc2VxX3ZlcnNpb24gPj0gMykgewo+ICAgCQkvKiBYWFg6IHRoaXMg
YXNzdW1lcyB2bHZfZ3Bpb190YWJsZSBvbmx5IGhhcyBOQyBHUElPcy4gKi8KPiAgIAkJcG9ydCA9
IElPU0ZfUE9SVF9HUElPX05DOwo+ICAgCX0gZWxzZSB7Cj4gQEAgLTI0NiwyNiArMjQ2LDI2IEBA
IHN0YXRpYyB2b2lkIHZsdl9leGVjX2dwaW8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ICAgCXBjb25mMCA9IFZMVl9HUElPX1BDT05GMChtYXAtPmJhc2Vfb2Zmc2V0KTsKPiAg
IAlwYWR2YWwgPSBWTFZfR1BJT19QQURfVkFMKG1hcC0+YmFzZV9vZmZzZXQpOwo+ICAgCj4gLQl2
bHZfaW9zZl9zYl9nZXQoZGV2X3ByaXYsIEJJVChWTFZfSU9TRl9TQl9HUElPKSk7Cj4gKwl2bHZf
aW9zZl9zYl9nZXQoaTkxNSwgQklUKFZMVl9JT1NGX1NCX0dQSU8pKTsKPiAgIAlpZiAoIW1hcC0+
aW5pdCkgewo+ICAgCQkvKiBGSVhNRTogcmVtb3ZlIGNvbnN0YW50IGJlbG93ICovCj4gLQkJdmx2
X2lvc2Zfc2Jfd3JpdGUoZGV2X3ByaXYsIHBvcnQsIHBjb25mMCwgMHgyMDAwQ0MwMCk7Cj4gKwkJ
dmx2X2lvc2Zfc2Jfd3JpdGUoaTkxNSwgcG9ydCwgcGNvbmYwLCAweDIwMDBDQzAwKTsKPiAgIAkJ
bWFwLT5pbml0ID0gdHJ1ZTsKPiAgIAl9Cj4gICAKPiAgIAl0bXAgPSAweDQgfCB2YWx1ZTsKPiAt
CXZsdl9pb3NmX3NiX3dyaXRlKGRldl9wcml2LCBwb3J0LCBwYWR2YWwsIHRtcCk7Cj4gLQl2bHZf
aW9zZl9zYl9wdXQoZGV2X3ByaXYsIEJJVChWTFZfSU9TRl9TQl9HUElPKSk7Cj4gKwl2bHZfaW9z
Zl9zYl93cml0ZShpOTE1LCBwb3J0LCBwYWR2YWwsIHRtcCk7Cj4gKwl2bHZfaW9zZl9zYl9wdXQo
aTkxNSwgQklUKFZMVl9JT1NGX1NCX0dQSU8pKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBj
aHZfZXhlY19ncGlvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGlj
IHZvaWQgY2h2X2V4ZWNfZ3BpbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJ
CSAgdTggZ3Bpb19zb3VyY2UsIHU4IGdwaW9faW5kZXgsIGJvb2wgdmFsdWUpCj4gICB7Cj4gICAJ
dTE2IGNmZzAsIGNmZzE7Cj4gICAJdTE2IGZhbWlseV9udW07Cj4gICAJdTggcG9ydDsKPiAgIAo+
IC0JaWYgKGRldl9wcml2LT52YnQuZHNpLnNlcV92ZXJzaW9uID49IDMpIHsKPiArCWlmIChpOTE1
LT52YnQuZHNpLnNlcV92ZXJzaW9uID49IDMpIHsKPiAgIAkJaWYgKGdwaW9faW5kZXggPj0gQ0hW
X0dQSU9fSURYX1NUQVJUX1NFKSB7Cj4gICAJCQkvKiBYWFg6IGl0J3MgdW5jbGVhciB3aGV0aGVy
IDI1NS0+NTcgaXMgcGFydCBvZiBTRS4gKi8KPiAgIAkJCWdwaW9faW5kZXggLT0gQ0hWX0dQSU9f
SURYX1NUQVJUX1NFOwo+IEBAIC0zMDEsMTUgKzMwMSwxNSBAQCBzdGF0aWMgdm9pZCBjaHZfZXhl
Y19ncGlvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAljZmcwID0gQ0hW
X0dQSU9fUEFEX0NGRzAoZmFtaWx5X251bSwgZ3Bpb19pbmRleCk7Cj4gICAJY2ZnMSA9IENIVl9H
UElPX1BBRF9DRkcxKGZhbWlseV9udW0sIGdwaW9faW5kZXgpOwo+ICAgCj4gLQl2bHZfaW9zZl9z
Yl9nZXQoZGV2X3ByaXYsIEJJVChWTFZfSU9TRl9TQl9HUElPKSk7Cj4gLQl2bHZfaW9zZl9zYl93
cml0ZShkZXZfcHJpdiwgcG9ydCwgY2ZnMSwgMCk7Cj4gLQl2bHZfaW9zZl9zYl93cml0ZShkZXZf
cHJpdiwgcG9ydCwgY2ZnMCwKPiArCXZsdl9pb3NmX3NiX2dldChpOTE1LCBCSVQoVkxWX0lPU0Zf
U0JfR1BJTykpOwo+ICsJdmx2X2lvc2Zfc2Jfd3JpdGUoaTkxNSwgcG9ydCwgY2ZnMSwgMCk7Cj4g
Kwl2bHZfaW9zZl9zYl93cml0ZShpOTE1LCBwb3J0LCBjZmcwLAo+ICAgCQkJICBDSFZfR1BJT19H
UElPRU4gfCBDSFZfR1BJT19HUElPQ0ZHX0dQTyB8Cj4gICAJCQkgIENIVl9HUElPX0dQSU9UWFNU
QVRFKHZhbHVlKSk7Cj4gLQl2bHZfaW9zZl9zYl9wdXQoZGV2X3ByaXYsIEJJVChWTFZfSU9TRl9T
Ql9HUElPKSk7Cj4gKwl2bHZfaW9zZl9zYl9wdXQoaTkxNSwgQklUKFZMVl9JT1NGX1NCX0dQSU8p
KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBieHRfZXhlY19ncGlvKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgYnh0X2V4ZWNfZ3BpbyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgdTggZ3Bpb19zb3VyY2UsIHU4IGdwaW9f
aW5kZXgsIGJvb2wgdmFsdWUpCj4gICB7Cj4gICAJLyogWFhYOiB0aGlzIHRhYmxlIGlzIGEgcXVp
Y2sgdWdseSBoYWNrLiAqLwo+IEBAIC0zMTcsNyArMzE3LDcgQEAgc3RhdGljIHZvaWQgYnh0X2V4
ZWNfZ3BpbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJc3RydWN0IGdw
aW9fZGVzYyAqZ3Bpb19kZXNjID0gYnh0X2dwaW9fdGFibGVbZ3Bpb19pbmRleF07Cj4gICAKPiAg
IAlpZiAoIWdwaW9fZGVzYykgewo+IC0JCWdwaW9fZGVzYyA9IGRldm1fZ3Bpb2RfZ2V0X2luZGV4
KGRldl9wcml2LT5kcm0uZGV2LAo+ICsJCWdwaW9fZGVzYyA9IGRldm1fZ3Bpb2RfZ2V0X2luZGV4
KGk5MTUtPmRybS5kZXYsCj4gICAJCQkJCQkgTlVMTCwgZ3Bpb19pbmRleCwKPiAgIAkJCQkJCSB2
YWx1ZSA/IEdQSU9EX09VVF9MT1cgOgo+ICAgCQkJCQkJIEdQSU9EX09VVF9ISUdIKTsKPiBAQCAt
MzM0LDcgKzMzNCw3IEBAIHN0YXRpYyB2b2lkIGJ4dF9leGVjX2dwaW8oc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCWdwaW9kX3NldF92YWx1ZShncGlvX2Rlc2MsIHZhbHVl
KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpY2xfZXhlY19ncGlvKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgaWNsX2V4ZWNfZ3BpbyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgdTggZ3Bpb19zb3VyY2UsIHU4IGdwaW9f
aW5kZXgsIGJvb2wgdmFsdWUpCj4gICB7Cj4gICAJRFJNX0RFQlVHX0tNUygiU2tpcHBpbmcgSUNM
IEdQSU8gZWxlbWVudCBleGVjdXRpb25cbiIpOwo+IEBAIC0zNDMsMTkgKzM0MywxOSBAQCBzdGF0
aWMgdm9pZCBpY2xfZXhlY19ncGlvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiAgIHN0YXRpYyBjb25zdCB1OCAqbWlwaV9leGVjX2dwaW8oc3RydWN0IGludGVsX2RzaSAqaW50
ZWxfZHNpLCBjb25zdCB1OCAqZGF0YSkKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
ID0gaW50ZWxfZHNpLT5iYXNlLmJhc2UuZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGRldik7Cj4gICAJdTggZ3Bpb19zb3VyY2UsIGdwaW9faW5kZXggPSAwLCBn
cGlvX251bWJlcjsKPiAgIAlib29sIHZhbHVlOwo+ICAgCj4gICAJRFJNX0RFQlVHX0tNUygiXG4i
KTsKPiAgIAo+IC0JaWYgKGRldl9wcml2LT52YnQuZHNpLnNlcV92ZXJzaW9uID49IDMpCj4gKwlp
ZiAoaTkxNS0+dmJ0LmRzaS5zZXFfdmVyc2lvbiA+PSAzKQo+ICAgCQlncGlvX2luZGV4ID0gKmRh
dGErKzsKPiAgIAo+ICAgCWdwaW9fbnVtYmVyID0gKmRhdGErKzsKPiAgIAo+ICAgCS8qIGdwaW8g
c291cmNlIGluIHNlcXVlbmNlIHYyIG9ubHkgKi8KPiAtCWlmIChkZXZfcHJpdi0+dmJ0LmRzaS5z
ZXFfdmVyc2lvbiA9PSAyKQo+ICsJaWYgKGk5MTUtPnZidC5kc2kuc2VxX3ZlcnNpb24gPT0gMikK
PiAgIAkJZ3Bpb19zb3VyY2UgPSAoKmRhdGEgPj4gMSkgJiAzOwo+ICAgCWVsc2UKPiAgIAkJZ3Bp
b19zb3VyY2UgPSAwOwo+IEBAIC0zNjMsMTQgKzM2MywxNCBAQCBzdGF0aWMgY29uc3QgdTggKm1p
cGlfZXhlY19ncGlvKHN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSwgY29uc3QgdTggKmRhdGEp
Cj4gICAJLyogcHVsbCB1cC9kb3duICovCj4gICAJdmFsdWUgPSAqZGF0YSsrICYgMTsKPiAgIAo+
IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCj4gLQkJaWNsX2V4ZWNfZ3BpbyhkZXZf
cHJpdiwgZ3Bpb19zb3VyY2UsIGdwaW9faW5kZXgsIHZhbHVlKTsKPiAtCWVsc2UgaWYgKElTX1ZB
TExFWVZJRVcoZGV2X3ByaXYpKQo+IC0JCXZsdl9leGVjX2dwaW8oZGV2X3ByaXYsIGdwaW9fc291
cmNlLCBncGlvX251bWJlciwgdmFsdWUpOwo+IC0JZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhkZXZf
cHJpdikpCj4gLQkJY2h2X2V4ZWNfZ3BpbyhkZXZfcHJpdiwgZ3Bpb19zb3VyY2UsIGdwaW9fbnVt
YmVyLCB2YWx1ZSk7Cj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKQo+ICsJCWljbF9leGVj
X2dwaW8oaTkxNSwgZ3Bpb19zb3VyY2UsIGdwaW9faW5kZXgsIHZhbHVlKTsKPiArCWVsc2UgaWYg
KElTX1ZBTExFWVZJRVcoaTkxNSkpCj4gKwkJdmx2X2V4ZWNfZ3BpbyhpOTE1LCBncGlvX3NvdXJj
ZSwgZ3Bpb19udW1iZXIsIHZhbHVlKTsKPiArCWVsc2UgaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkp
Cj4gKwkJY2h2X2V4ZWNfZ3BpbyhpOTE1LCBncGlvX3NvdXJjZSwgZ3Bpb19udW1iZXIsIHZhbHVl
KTsKPiAgIAllbHNlCj4gLQkJYnh0X2V4ZWNfZ3BpbyhkZXZfcHJpdiwgZ3Bpb19zb3VyY2UsIGdw
aW9faW5kZXgsIHZhbHVlKTsKPiArCQlieHRfZXhlY19ncGlvKGk5MTUsIGdwaW9fc291cmNlLCBn
cGlvX2luZGV4LCB2YWx1ZSk7Cj4gICAKPiAgIAlyZXR1cm4gZGF0YTsKPiAgIH0KPiBAQCAtNDU2
LDE0ICs0NTYsMTQgQEAgc3RhdGljIGNvbnN0IGNoYXIgKnNlcXVlbmNlX25hbWUoZW51bSBtaXBp
X3NlcSBzZXFfaWQpCj4gICB2b2lkIGludGVsX2RzaV92YnRfZXhlY19zZXF1ZW5jZShzdHJ1Y3Qg
aW50ZWxfZHNpICppbnRlbF9kc2ksCj4gICAJCQkJIGVudW0gbWlwaV9zZXEgc2VxX2lkKQo+ICAg
ewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShpbnRlbF9k
c2ktPmJhc2UuYmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGludGVsX2RzaS0+YmFzZS5iYXNlLmRldik7Cj4gICAJY29uc3QgdTggKmRhdGE7Cj4g
ICAJZm5fbWlwaV9lbGVtX2V4ZWMgbWlwaV9lbGVtX2V4ZWM7Cj4gICAKPiAtCWlmIChXQVJOX09O
KHNlcV9pZCA+PSBBUlJBWV9TSVpFKGRldl9wcml2LT52YnQuZHNpLnNlcXVlbmNlKSkpCj4gKwlp
ZiAoV0FSTl9PTihzZXFfaWQgPj0gQVJSQVlfU0laRShpOTE1LT52YnQuZHNpLnNlcXVlbmNlKSkp
Cj4gICAJCXJldHVybjsKPiAgIAo+IC0JZGF0YSA9IGRldl9wcml2LT52YnQuZHNpLnNlcXVlbmNl
W3NlcV9pZF07Cj4gKwlkYXRhID0gaTkxNS0+dmJ0LmRzaS5zZXF1ZW5jZVtzZXFfaWRdOwo+ICAg
CWlmICghZGF0YSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gQEAgLTQ3Niw3ICs0NzYsNyBAQCB2b2lk
IGludGVsX2RzaV92YnRfZXhlY19zZXF1ZW5jZShzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2ks
Cj4gICAJZGF0YSsrOwo+ICAgCj4gICAJLyogU2tpcCBTaXplIG9mIFNlcXVlbmNlLiAqLwo+IC0J
aWYgKGRldl9wcml2LT52YnQuZHNpLnNlcV92ZXJzaW9uID49IDMpCj4gKwlpZiAoaTkxNS0+dmJ0
LmRzaS5zZXFfdmVyc2lvbiA+PSAzKQo+ICAgCQlkYXRhICs9IDQ7Cj4gICAKPiAgIAl3aGlsZSAo
MSkgewo+IEBAIC00OTIsNyArNDkyLDcgQEAgdm9pZCBpbnRlbF9kc2lfdmJ0X2V4ZWNfc2VxdWVu
Y2Uoc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpLAo+ICAgCQkJbWlwaV9lbGVtX2V4ZWMgPSBO
VUxMOwo+ICAgCj4gICAJCS8qIFNpemUgb2YgT3BlcmF0aW9uLiAqLwo+IC0JCWlmIChkZXZfcHJp
di0+dmJ0LmRzaS5zZXFfdmVyc2lvbiA+PSAzKQo+ICsJCWlmIChpOTE1LT52YnQuZHNpLnNlcV92
ZXJzaW9uID49IDMpCj4gICAJCQlvcGVyYXRpb25fc2l6ZSA9ICpkYXRhKys7Cj4gICAKPiAgIAkJ
aWYgKG1pcGlfZWxlbV9leGVjKSB7Cj4gQEAgLTUyMSwxMCArNTIxLDEwIEBAIHZvaWQgaW50ZWxf
ZHNpX3ZidF9leGVjX3NlcXVlbmNlKHN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSwKPiAgIAo+
ICAgdm9pZCBpbnRlbF9kc2lfbXNsZWVwKHN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSwgaW50
IG1zZWMpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGludGVsX2RzaS0+YmFzZS5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoaW50ZWxfZHNpLT5iYXNlLmJhc2UuZGV2KTsKPiAgIAo+ICAgCS8q
IEZvciB2MyBWQlRzIGluIHZpZC1tb2RlIHRoZSBkZWxheXMgYXJlIHBhcnQgb2YgdGhlIFZCVCBz
ZXF1ZW5jZXMgKi8KPiAtCWlmIChpc192aWRfbW9kZShpbnRlbF9kc2kpICYmIGRldl9wcml2LT52
YnQuZHNpLnNlcV92ZXJzaW9uID49IDMpCj4gKwlpZiAoaXNfdmlkX21vZGUoaW50ZWxfZHNpKSAm
JiBpOTE1LT52YnQuZHNpLnNlcV92ZXJzaW9uID49IDMpCj4gICAJCXJldHVybjsKPiAgIAo+ICAg
CW1zbGVlcChtc2VjKTsKPiBAQCAtNTcxLDEwICs1NzEsMTAgQEAgdm9pZCBpbnRlbF9kc2lfbG9n
X3BhcmFtcyhzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kpCj4gICBib29sIGludGVsX2RzaV92
YnRfaW5pdChzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2ksIHUxNiBwYW5lbF9pZCkKPiAgIHsK
PiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gaW50ZWxfZHNpLT5iYXNlLmJhc2UuZGV2Owo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+IC0J
c3RydWN0IG1pcGlfY29uZmlnICptaXBpX2NvbmZpZyA9IGRldl9wcml2LT52YnQuZHNpLmNvbmZp
ZzsKPiAtCXN0cnVjdCBtaXBpX3Bwc19kYXRhICpwcHMgPSBkZXZfcHJpdi0+dmJ0LmRzaS5wcHM7
Cj4gLQlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSA9IGRldl9wcml2LT52YnQubGZwX2x2
ZHNfdmJ0X21vZGU7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
ZGV2KTsKPiArCXN0cnVjdCBtaXBpX2NvbmZpZyAqbWlwaV9jb25maWcgPSBpOTE1LT52YnQuZHNp
LmNvbmZpZzsKPiArCXN0cnVjdCBtaXBpX3Bwc19kYXRhICpwcHMgPSBpOTE1LT52YnQuZHNpLnBw
czsKPiArCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlID0gaTkxNS0+dmJ0LmxmcF9sdmRz
X3ZidF9tb2RlOwo+ICAgCXUxNiBidXJzdF9tb2RlX3JhdGlvOwo+ICAgCWVudW0gcG9ydCBwb3J0
Owo+ICAgCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2R2by5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHZvLmMKPiBpbmRleCAyMjY2NmQyOGY0YWEuLjZj
ZWQ5NWI3MzUzOCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kdm8u
Ywo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2R2by5jCj4gQEAgLTEzMyw3ICsx
MzMsNyBAQCBzdGF0aWMgc3RydWN0IGludGVsX2R2byAqaW50ZWxfYXR0YWNoZWRfZHZvKHN0cnVj
dCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCj4gICBzdGF0aWMgYm9vbCBpbnRlbF9kdm9fY29u
bmVjdG9yX2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4g
ICB7Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNvbm5lY3Rvci0+YmFzZS5kZXY7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAlzdHJ1Y3Qg
aW50ZWxfZHZvICppbnRlbF9kdm8gPSBpbnRlbF9hdHRhY2hlZF9kdm8oJmNvbm5lY3Rvci0+YmFz
ZSk7Cj4gICAJdTMyIHRtcDsKPiAgIAo+IEBAIC0xNDgsNyArMTQ4LDcgQEAgc3RhdGljIGJvb2wg
aW50ZWxfZHZvX2Nvbm5lY3Rvcl9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVsX2Nvbm5lY3RvciAq
Y29ubmVjdG9yKQo+ICAgc3RhdGljIGJvb2wgaW50ZWxfZHZvX2dldF9od19zdGF0ZShzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCQkgICBlbnVtIHBpcGUgKnBpcGUpCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShl
bmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2R2byAqaW50ZWxfZHZvID0gZW5j
X3RvX2R2byhlbmNvZGVyKTsKPiAgIAl1MzIgdG1wOwo+ICAgCj4gQEAgLTE2Miw3ICsxNjIsNyBA
QCBzdGF0aWMgYm9vbCBpbnRlbF9kdm9fZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLAo+ICAgc3RhdGljIHZvaWQgaW50ZWxfZHZvX2dldF9jb25maWcoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkJIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpw
aXBlX2NvbmZpZykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHZv
ICppbnRlbF9kdm8gPSBlbmNfdG9fZHZvKGVuY29kZXIpOwo+ICAgCXUzMiB0bXAsIGZsYWdzID0g
MDsKPiAgIAo+IEBAIC0xODcsNyArMTg3LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZGlzYWJsZV9k
dm8oc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkgICAgICBjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCj4gICAJCQkgICAgICBjb25zdCBz
dHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCj4gICB7Cj4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2
KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5i
YXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2R2byAqaW50ZWxfZHZvID0gZW5jX3RvX2R2byhl
bmNvZGVyKTsKPiAgIAlpOTE1X3JlZ190IGR2b19yZWcgPSBpbnRlbF9kdm8tPmRldi5kdm9fcmVn
Owo+ICAgCXUzMiB0ZW1wID0gSTkxNV9SRUFEKGR2b19yZWcpOwo+IEBAIC0yMDEsNyArMjAxLDcg
QEAgc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX2R2byhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKPiAgIAkJCSAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29u
ZmlnLAo+ICAgCQkJICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9z
dGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHZvICppbnRl
bF9kdm8gPSBlbmNfdG9fZHZvKGVuY29kZXIpOwo+ICAgCWk5MTVfcmVnX3QgZHZvX3JlZyA9IGlu
dGVsX2R2by0+ZGV2LmR2b19yZWc7Cj4gICAJdTMyIHRlbXAgPSBJOTE1X1JFQUQoZHZvX3JlZyk7
Cj4gQEAgLTI3Niw3ICsyNzYsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kdm9fcHJlX2VuYWJsZShz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCQkgY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ICAgCQkJCSBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5l
Y3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0
Yyk7Cj4gICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAm
cGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHZvICpp
bnRlbF9kdm8gPSBlbmNfdG9fZHZvKGVuY29kZXIpOwo+IEBAIC0zMTksNyArMzE5LDcgQEAgaW50
ZWxfZHZvX2RldGVjdChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLCBib29sIGZvcmNl
KQo+ICAgCj4gICBzdGF0aWMgaW50IGludGVsX2R2b19nZXRfbW9kZXMoc3RydWN0IGRybV9jb25u
ZWN0b3IgKmNvbm5lY3RvcikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsKPiAgIAljb25zdCBzdHJ1Y3QgZHJt
X2Rpc3BsYXlfbW9kZSAqZml4ZWRfbW9kZSA9Cj4gICAJCXRvX2ludGVsX2Nvbm5lY3Rvcihjb25u
ZWN0b3IpLT5wYW5lbC5maXhlZF9tb2RlOwo+ICAgCj4gQEAgLTMzMCw3ICszMzAsNyBAQCBzdGF0
aWMgaW50IGludGVsX2R2b19nZXRfbW9kZXMoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3Rv
cikKPiAgIAkgKiB0aGF0J3Mgbm90IHRoZSBjYXNlLgo+ICAgCSAqLwo+ICAgCWludGVsX2RkY19n
ZXRfbW9kZXMoY29ubmVjdG9yLAo+IC0JCQkgICAgaW50ZWxfZ21idXNfZ2V0X2FkYXB0ZXIoZGV2
X3ByaXYsIEdNQlVTX1BJTl9EUEMpKTsKPiArCQkJICAgIGludGVsX2dtYnVzX2dldF9hZGFwdGVy
KGk5MTUsIEdNQlVTX1BJTl9EUEMpKTsKPiAgIAlpZiAoIWxpc3RfZW1wdHkoJmNvbm5lY3Rvci0+
cHJvYmVkX21vZGVzKSkKPiAgIAkJcmV0dXJuIDE7Cj4gICAKPiBAQCAtNDA2LDcgKzQwNiw3IEBA
IHN0YXRpYyBlbnVtIHBvcnQgaW50ZWxfZHZvX3BvcnQoaTkxNV9yZWdfdCBkdm9fcmVnKQo+ICAg
CQlyZXR1cm4gUE9SVF9DOwo+ICAgfQo+ICAgCj4gLXZvaWQgaW50ZWxfZHZvX2luaXQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGludGVsX2R2b19pbml0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVy
ICppbnRlbF9lbmNvZGVyOwo+ICAgCXN0cnVjdCBpbnRlbF9kdm8gKmludGVsX2R2bzsKPiBAQCAt
NDUyLDcgKzQ1Miw3IEBAIHZvaWQgaW50ZWxfZHZvX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ICAgCQkgKiBzcGVjaWFsIGNhc2VzLCBidXQgb3RoZXJ3aXNlIGRlZmF1
bHQgdG8gd2hhdCdzIGRlZmluZWQKPiAgIAkJICogaW4gdGhlIHNwZWMuCj4gICAJCSAqLwo+IC0J
CWlmIChpbnRlbF9nbWJ1c19pc192YWxpZF9waW4oZGV2X3ByaXYsIGR2by0+Z3BpbykpCj4gKwkJ
aWYgKGludGVsX2dtYnVzX2lzX3ZhbGlkX3BpbihpOTE1LCBkdm8tPmdwaW8pKQo+ICAgCQkJZ3Bp
byA9IGR2by0+Z3BpbzsKPiAgIAkJZWxzZSBpZiAoZHZvLT50eXBlID09IElOVEVMX0RWT19DSElQ
X0xWRFMpCj4gICAJCQlncGlvID0gR01CVVNfUElOX1NTQzsKPiBAQCAtNDY0LDcgKzQ2NCw3IEBA
IHZvaWQgaW50ZWxfZHZvX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ICAgCQkgKiBJdCBhcHBlYXJzIHRoYXQgZXZlcnl0aGluZyBpcyBvbiBHUElPRSBleGNlcHQgZm9y
IHBhbmVscwo+ICAgCQkgKiBvbiBpODMwIGxhcHRvcHMsIHdoaWNoIGFyZSBvbiBHUElPQiAoRFZP
QSkuCj4gICAJCSAqLwo+IC0JCWkyYyA9IGludGVsX2dtYnVzX2dldF9hZGFwdGVyKGRldl9wcml2
LCBncGlvKTsKPiArCQlpMmMgPSBpbnRlbF9nbWJ1c19nZXRfYWRhcHRlcihpOTE1LCBncGlvKTsK
PiAgIAo+ICAgCQlpbnRlbF9kdm8tPmRldiA9ICpkdm87Cj4gICAKPiBAQCAtNDgwLDcgKzQ4MCw3
IEBAIHZvaWQgaW50ZWxfZHZvX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ICAgCQkgKiBoYXZlIHRoZSBjbG9jayBlbmFibGVkIGJlZm9yZSB3ZSBhdHRlbXB0IHRvCj4g
ICAJCSAqIGluaXRpYWxpemUgdGhlIGRldmljZS4KPiAgIAkJICovCj4gLQkJZm9yX2VhY2hfcGlw
ZShkZXZfcHJpdiwgcGlwZSkgewo+ICsJCWZvcl9lYWNoX3BpcGUoaTkxNSwgcGlwZSkgewo+ICAg
CQkJZHBsbFtwaXBlXSA9IEk5MTVfUkVBRChEUExMKHBpcGUpKTsKPiAgIAkJCUk5MTVfV1JJVEUo
RFBMTChwaXBlKSwgZHBsbFtwaXBlXSB8IERQTExfRFZPXzJYX01PREUpOwo+ICAgCQl9Cj4gQEAg
LTQ4OCw3ICs0ODgsNyBAQCB2b2lkIGludGVsX2R2b19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiAgIAkJZHZvaW5pdCA9IGR2by0+ZGV2X29wcy0+aW5pdCgmaW50ZWxf
ZHZvLT5kZXYsIGkyYyk7Cj4gICAKPiAgIAkJLyogcmVzdG9yZSB0aGUgRFZPIDJ4IGNsb2NrIHN0
YXRlIHRvIG9yaWdpbmFsICovCj4gLQkJZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkgewo+
ICsJCWZvcl9lYWNoX3BpcGUoaTkxNSwgcGlwZSkgewo+ICAgCQkJSTkxNV9XUklURShEUExMKHBp
cGUpLCBkcGxsW3BpcGVdKTsKPiAgIAkJfQo+ICAgCj4gQEAgLTQ5OCw3ICs0OTgsNyBAQCB2b2lk
IGludGVsX2R2b19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkJ
CWNvbnRpbnVlOwo+ICAgCj4gICAJCXBvcnQgPSBpbnRlbF9kdm9fcG9ydChkdm8tPmR2b19yZWcp
Owo+IC0JCWRybV9lbmNvZGVyX2luaXQoJmRldl9wcml2LT5kcm0sICZpbnRlbF9lbmNvZGVyLT5i
YXNlLAo+ICsJCWRybV9lbmNvZGVyX2luaXQoJmk5MTUtPmRybSwgJmludGVsX2VuY29kZXItPmJh
c2UsCj4gICAJCQkJICZpbnRlbF9kdm9fZW5jX2Z1bmNzLCBlbmNvZGVyX3R5cGUsCj4gICAJCQkJ
ICJEVk8gJWMiLCBwb3J0X25hbWUocG9ydCkpOwo+ICAgCj4gQEAgLTUxMSwxNCArNTExLDE0IEBA
IHZvaWQgaW50ZWxfZHZvX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ICAgCQljYXNlIElOVEVMX0RWT19DSElQX1RNRFM6Cj4gICAJCQlpbnRlbF9lbmNvZGVyLT5jbG9u
ZWFibGUgPSAoMSA8PCBJTlRFTF9PVVRQVVRfQU5BTE9HKSB8Cj4gICAJCQkJKDEgPDwgSU5URUxf
T1VUUFVUX0RWTyk7Cj4gLQkJCWRybV9jb25uZWN0b3JfaW5pdCgmZGV2X3ByaXYtPmRybSwgY29u
bmVjdG9yLAo+ICsJCQlkcm1fY29ubmVjdG9yX2luaXQoJmk5MTUtPmRybSwgY29ubmVjdG9yLAo+
ICAgCQkJCQkgICAmaW50ZWxfZHZvX2Nvbm5lY3Rvcl9mdW5jcywKPiAgIAkJCQkJICAgRFJNX01P
REVfQ09OTkVDVE9SX0RWSUkpOwo+ICAgCQkJZW5jb2Rlcl90eXBlID0gRFJNX01PREVfRU5DT0RF
Ul9UTURTOwo+ICAgCQkJYnJlYWs7Cj4gICAJCWNhc2UgSU5URUxfRFZPX0NISVBfTFZEUzoKPiAg
IAkJCWludGVsX2VuY29kZXItPmNsb25lYWJsZSA9IDA7Cj4gLQkJCWRybV9jb25uZWN0b3JfaW5p
dCgmZGV2X3ByaXYtPmRybSwgY29ubmVjdG9yLAo+ICsJCQlkcm1fY29ubmVjdG9yX2luaXQoJmk5
MTUtPmRybSwgY29ubmVjdG9yLAo+ICAgCQkJCQkgICAmaW50ZWxfZHZvX2Nvbm5lY3Rvcl9mdW5j
cywKPiAgIAkJCQkJICAgRFJNX01PREVfQ09OTkVDVE9SX0xWRFMpOwo+ICAgCQkJZW5jb2Rlcl90
eXBlID0gRFJNX01PREVfRU5DT0RFUl9MVkRTOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9kdm8uaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2R2by5oCj4g
aW5kZXggM2VkMGZkZjhlZmZmLi5kODY1Y2Q0MzliYjcgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfZHZvLmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9kdm8uaAo+IEBAIC04LDYgKzgsNiBAQAo+ICAgCj4gICBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZTsKPiAgIAo+IC12b2lkIGludGVsX2R2b19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdik7Cj4gK3ZvaWQgaW50ZWxfZHZvX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpOwo+ICAgCj4gICAjZW5kaWYgLyogX19JTlRFTF9EVk9fSF9fICovCj4gZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2R2b19kZXYuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX2R2b19kZXYuaAo+IGluZGV4IDk0YTZhZTFlMDI5Mi4uMWQxODRkYzc5MjJi
IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2R2b19kZXYuaAo+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2R2b19kZXYuaAo+IEBAIC00MCw3ICs0MCw3
IEBAIHN0cnVjdCBpbnRlbF9kdm9fZGV2aWNlIHsKPiAgIAlpbnQgc2xhdmVfYWRkcjsKPiAgIAo+
ICAgCWNvbnN0IHN0cnVjdCBpbnRlbF9kdm9fZGV2X29wcyAqZGV2X29wczsKPiAtCXZvaWQgKmRl
dl9wcml2Owo+ICsJdm9pZCAqaTkxNTsKPiAgIAlzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmkyY19idXM7
Cj4gICB9Owo+ICAgCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Zi
Yy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZmJjLmMKPiBpbmRleCA1Njc5ZjJmZmZi
N2MuLjYyN2ZlZDJhNTVkMiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9mYmMuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2ZiYy5jCj4gQEAgLTQ1
LDE0ICs0NSwxNCBAQAo+ICAgI2luY2x1ZGUgImludGVsX2ZiYy5oIgo+ICAgI2luY2x1ZGUgImlu
dGVsX2Zyb250YnVmZmVyLmgiCj4gICAKPiAtc3RhdGljIGlubGluZSBib29sIGZiY19zdXBwb3J0
ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgaW5saW5lIGJv
b2wgZmJjX3N1cHBvcnRlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAt
CXJldHVybiBIQVNfRkJDKGRldl9wcml2KTsKPiArCXJldHVybiBIQVNfRkJDKGk5MTUpOwo+ICAg
fQo+ICAgCj4gLXN0YXRpYyBpbmxpbmUgYm9vbCBub19mYmNfb25fbXVsdGlwbGVfcGlwZXMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgaW5saW5lIGJvb2wgbm9f
ZmJjX29uX211bHRpcGxlX3BpcGVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAg
ewo+IC0JcmV0dXJuIElOVEVMX0dFTihkZXZfcHJpdikgPD0gMzsKPiArCXJldHVybiBJTlRFTF9H
RU4oaTkxNSkgPD0gMzsKPiAgIH0KPiAgIAo+ICAgLyoKPiBAQCAtODIsMjIgKzgyLDIyIEBAIHN0
YXRpYyB2b2lkIGludGVsX2ZiY19nZXRfcGxhbmVfc291cmNlX3NpemUoc3RydWN0IGludGVsX2Zi
Y19zdGF0ZV9jYWNoZSAqY2FjaGUsCj4gICAJCSpoZWlnaHQgPSBjYWNoZS0+cGxhbmUuc3JjX2g7
Cj4gICB9Cj4gICAKPiAtc3RhdGljIGludCBpbnRlbF9mYmNfY2FsY3VsYXRlX2NmYl9zaXplKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIGludCBpbnRlbF9mYmNf
Y2FsY3VsYXRlX2NmYl9zaXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJ
CQlzdHJ1Y3QgaW50ZWxfZmJjX3N0YXRlX2NhY2hlICpjYWNoZSkKPiAgIHsKPiAgIAlpbnQgbGlu
ZXM7Cj4gICAKPiAgIAlpbnRlbF9mYmNfZ2V0X3BsYW5lX3NvdXJjZV9zaXplKGNhY2hlLCBOVUxM
LCAmbGluZXMpOwo+IC0JaWYgKElTX0dFTihkZXZfcHJpdiwgNykpCj4gKwlpZiAoSVNfR0VOKGk5
MTUsIDcpKQo+ICAgCQlsaW5lcyA9IG1pbihsaW5lcywgMjA0OCk7Cj4gLQllbHNlIGlmIChJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDgpCj4gKwllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOCkK
PiAgIAkJbGluZXMgPSBtaW4obGluZXMsIDI1NjApOwo+ICAgCj4gICAJLyogSGFyZHdhcmUgbmVl
ZHMgdGhlIGZ1bGwgYnVmZmVyIHN0cmlkZSwgbm90IGp1c3QgdGhlIGFjdGl2ZSBhcmVhLiAqLwo+
ICAgCXJldHVybiBsaW5lcyAqIGNhY2hlLT5mYi5zdHJpZGU7Cj4gICB9Cj4gICAKPiAtc3RhdGlj
IHZvaWQgaTh4eF9mYmNfZGVhY3RpdmF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gK3N0YXRpYyB2b2lkIGk4eHhfZmJjX2RlYWN0aXZhdGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJdTMyIGZiY19jdGw7Cj4gICAKPiBAQCAtMTEwLDcgKzEx
MCw3IEBAIHN0YXRpYyB2b2lkIGk4eHhfZmJjX2RlYWN0aXZhdGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ICAgCUk5MTVfV1JJVEUoRkJDX0NPTlRST0wsIGZiY19jdGwpOwo+
ICAgCj4gICAJLyogV2FpdCBmb3IgY29tcHJlc3NpbmcgYml0IHRvIGNsZWFyICovCj4gLQlpZiAo
aW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gKwlpZiAoaW50ZWxf
d2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiAgIAkJCQkgICAgRkJDX1NUQVRVUywg
RkJDX1NUQVRfQ09NUFJFU1NJTkcsIDAsCj4gICAJCQkJICAgIDEwKSkgewo+ICAgCQlEUk1fREVC
VUdfS01TKCJGQkMgaWRsZSB0aW1lZCBvdXRcbiIpOwo+IEBAIC0xMTgsOSArMTE4LDkgQEAgc3Rh
dGljIHZvaWQgaTh4eF9mYmNfZGVhY3RpdmF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gICAJfQo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGk4eHhfZmJjX2FjdGl2YXRl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaTh4eF9m
YmNfYWN0aXZhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1
Y3QgaW50ZWxfZmJjX3JlZ19wYXJhbXMgKnBhcmFtcyA9ICZkZXZfcHJpdi0+ZmJjLnBhcmFtczsK
PiArCXN0cnVjdCBpbnRlbF9mYmNfcmVnX3BhcmFtcyAqcGFyYW1zID0gJmk5MTUtPmZiYy5wYXJh
bXM7Cj4gICAJaW50IGNmYl9waXRjaDsKPiAgIAlpbnQgaTsKPiAgIAl1MzIgZmJjX2N0bDsKPiBA
QCAtMTMxLDcgKzEzMSw3IEBAIHN0YXRpYyB2b2lkIGk4eHhfZmJjX2FjdGl2YXRlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkJY2ZiX3BpdGNoID0gcGFyYW1zLT5mYi5z
dHJpZGU7Cj4gICAKPiAgIAkvKiBGQkNfQ1RMIHdhbnRzIDMyQiBvciA2NEIgdW5pdHMgKi8KPiAt
CWlmIChJU19HRU4oZGV2X3ByaXYsIDIpKQo+ICsJaWYgKElTX0dFTihpOTE1LCAyKSkKPiAgIAkJ
Y2ZiX3BpdGNoID0gKGNmYl9waXRjaCAvIDMyKSAtIDE7Cj4gICAJZWxzZQo+ICAgCQljZmJfcGl0
Y2ggPSAoY2ZiX3BpdGNoIC8gNjQpIC0gMTsKPiBAQCAtMTQwLDcgKzE0MCw3IEBAIHN0YXRpYyB2
b2lkIGk4eHhfZmJjX2FjdGl2YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiAgIAlmb3IgKGkgPSAwOyBpIDwgKEZCQ19MTF9TSVpFIC8gMzIpICsgMTsgaSsrKQo+ICAgCQlJ
OTE1X1dSSVRFKEZCQ19UQUcoaSksIDApOwo+ICAgCj4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCA0
KSkgewo+ICsJaWYgKElTX0dFTihpOTE1LCA0KSkgewo+ICAgCQl1MzIgZmJjX2N0bDI7Cj4gICAK
PiAgIAkJLyogU2V0IGl0IHVwLi4uICovCj4gQEAgLTE1NCwyMSArMTU0LDIxIEBAIHN0YXRpYyB2
b2lkIGk4eHhfZmJjX2FjdGl2YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiAgIAlmYmNfY3RsID0gSTkxNV9SRUFEKEZCQ19DT05UUk9MKTsKPiAgIAlmYmNfY3RsICY9IDB4
M2ZmZiA8PCBGQkNfQ1RMX0lOVEVSVkFMX1NISUZUOwo+ICAgCWZiY19jdGwgfD0gRkJDX0NUTF9F
TiB8IEZCQ19DVExfUEVSSU9ESUM7Cj4gLQlpZiAoSVNfSTk0NUdNKGRldl9wcml2KSkKPiArCWlm
IChJU19JOTQ1R00oaTkxNSkpCj4gICAJCWZiY19jdGwgfD0gRkJDX0NUTF9DM19JRExFOyAvKiA5
NDUgbmVlZHMgc3BlY2lhbCBTUiBoYW5kbGluZyAqLwo+ICAgCWZiY19jdGwgfD0gKGNmYl9waXRj
aCAmIDB4ZmYpIDw8IEZCQ19DVExfU1RSSURFX1NISUZUOwo+ICAgCWZiY19jdGwgfD0gcGFyYW1z
LT52bWEtPmZlbmNlLT5pZDsKPiAgIAlJOTE1X1dSSVRFKEZCQ19DT05UUk9MLCBmYmNfY3RsKTsK
PiAgIH0KPiAgIAo+IC1zdGF0aWMgYm9vbCBpOHh4X2ZiY19pc19hY3RpdmUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgYm9vbCBpOHh4X2ZiY19pc19hY3RpdmUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJcmV0dXJuIEk5MTVfUkVB
RChGQkNfQ09OVFJPTCkgJiBGQkNfQ1RMX0VOOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGc0
eF9mYmNfYWN0aXZhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0
aWMgdm9pZCBnNHhfZmJjX2FjdGl2YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ICAgewo+IC0Jc3RydWN0IGludGVsX2ZiY19yZWdfcGFyYW1zICpwYXJhbXMgPSAmZGV2X3ByaXYt
PmZiYy5wYXJhbXM7Cj4gKwlzdHJ1Y3QgaW50ZWxfZmJjX3JlZ19wYXJhbXMgKnBhcmFtcyA9ICZp
OTE1LT5mYmMucGFyYW1zOwo+ICAgCXUzMiBkcGZjX2N0bDsKPiAgIAo+ICAgCWRwZmNfY3RsID0g
RFBGQ19DVExfUExBTkUocGFyYW1zLT5jcnRjLmk5eHhfcGxhbmUpIHwgRFBGQ19TUl9FTjsKPiBA
QCAtMTg4LDcgKzE4OCw3IEBAIHN0YXRpYyB2b2lkIGc0eF9mYmNfYWN0aXZhdGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCUk5MTVfV1JJVEUoRFBGQ19DT05UUk9MLCBk
cGZjX2N0bCB8IERQRkNfQ1RMX0VOKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBnNHhfZmJj
X2RlYWN0aXZhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMg
dm9pZCBnNHhfZmJjX2RlYWN0aXZhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
ICB7Cj4gICAJdTMyIGRwZmNfY3RsOwo+ICAgCj4gQEAgLTIwMCwyMyArMjAwLDIzIEBAIHN0YXRp
YyB2b2lkIGc0eF9mYmNfZGVhY3RpdmF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gICAJfQo+ICAgfQo+ICAgCj4gLXN0YXRpYyBib29sIGc0eF9mYmNfaXNfYWN0aXZlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIGJvb2wgZzR4X2ZiY19p
c19hY3RpdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJcmV0dXJu
IEk5MTVfUkVBRChEUEZDX0NPTlRST0wpICYgRFBGQ19DVExfRU47Cj4gICB9Cj4gICAKPiAgIC8q
IFRoaXMgZnVuY3Rpb24gZm9yY2VzIGEgQ0ZCIHJlY29tcHJlc3Npb24gdGhyb3VnaCB0aGUgbnVr
ZSBvcGVyYXRpb24uICovCj4gLXN0YXRpYyB2b2lkIGludGVsX2ZiY19yZWNvbXByZXNzKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaW50ZWxfZmJjX3Jl
Y29tcHJlc3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJSTkxNV9X
UklURShNU0dfRkJDX1JFTkRfU1RBVEUsIEZCQ19SRU5EX05VS0UpOwo+ICAgCVBPU1RJTkdfUkVB
RChNU0dfRkJDX1JFTkRfU1RBVEUpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGlsa19mYmNf
YWN0aXZhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9p
ZCBpbGtfZmJjX2FjdGl2YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+
IC0Jc3RydWN0IGludGVsX2ZiY19yZWdfcGFyYW1zICpwYXJhbXMgPSAmZGV2X3ByaXYtPmZiYy5w
YXJhbXM7Cj4gKwlzdHJ1Y3QgaW50ZWxfZmJjX3JlZ19wYXJhbXMgKnBhcmFtcyA9ICZpOTE1LT5m
YmMucGFyYW1zOwo+ICAgCXUzMiBkcGZjX2N0bDsKPiAtCWludCB0aHJlc2hvbGQgPSBkZXZfcHJp
di0+ZmJjLnRocmVzaG9sZDsKPiArCWludCB0aHJlc2hvbGQgPSBpOTE1LT5mYmMudGhyZXNob2xk
Owo+ICAgCj4gICAJZHBmY19jdGwgPSBEUEZDX0NUTF9QTEFORShwYXJhbXMtPmNydGMuaTl4eF9w
bGFuZSk7Cj4gICAJaWYgKHBhcmFtcy0+ZmIuZm9ybWF0LT5jcHBbMF0gPT0gMikKPiBAQCAtMjM3
LDkgKzIzNyw5IEBAIHN0YXRpYyB2b2lkIGlsa19mYmNfYWN0aXZhdGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCj4gICAJaWYgKHBhcmFtcy0+ZmxhZ3MgJiBQTEFORV9I
QVNfRkVOQ0UpIHsKPiAgIAkJZHBmY19jdGwgfD0gRFBGQ19DVExfRkVOQ0VfRU47Cj4gLQkJaWYg
KElTX0dFTihkZXZfcHJpdiwgNSkpCj4gKwkJaWYgKElTX0dFTihpOTE1LCA1KSkKPiAgIAkJCWRw
ZmNfY3RsIHw9IHBhcmFtcy0+dm1hLT5mZW5jZS0+aWQ7Cj4gLQkJaWYgKElTX0dFTihkZXZfcHJp
diwgNikpIHsKPiArCQlpZiAoSVNfR0VOKGk5MTUsIDYpKSB7Cj4gICAJCQlJOTE1X1dSSVRFKFNO
Ql9EUEZDX0NUTF9TQSwKPiAgIAkJCQkgICBTTkJfQ1BVX0ZFTkNFX0VOQUJMRSB8Cj4gICAJCQkJ
ICAgcGFyYW1zLT52bWEtPmZlbmNlLT5pZCk7Cj4gQEAgLTI0Nyw3ICsyNDcsNyBAQCBzdGF0aWMg
dm9pZCBpbGtfZmJjX2FjdGl2YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiAgIAkJCQkgICBwYXJhbXMtPmNydGMuZmVuY2VfeV9vZmZzZXQpOwo+ICAgCQl9Cj4gICAJfSBl
bHNlIHsKPiAtCQlpZiAoSVNfR0VOKGRldl9wcml2LCA2KSkgewo+ICsJCWlmIChJU19HRU4oaTkx
NSwgNikpIHsKPiAgIAkJCUk5MTVfV1JJVEUoU05CX0RQRkNfQ1RMX1NBLCAwKTsKPiAgIAkJCUk5
MTVfV1JJVEUoRFBGQ19DUFVfRkVOQ0VfT0ZGU0VULCAwKTsKPiAgIAkJfQo+IEBAIC0yNTksMTAg
KzI1OSwxMCBAQCBzdGF0aWMgdm9pZCBpbGtfZmJjX2FjdGl2YXRlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiAgIAkvKiBlbmFibGUgaXQuLi4gKi8KPiAgIAlJOTE1X1dSSVRF
KElMS19EUEZDX0NPTlRST0wsIGRwZmNfY3RsIHwgRFBGQ19DVExfRU4pOwo+ICAgCj4gLQlpbnRl
bF9mYmNfcmVjb21wcmVzcyhkZXZfcHJpdik7Cj4gKwlpbnRlbF9mYmNfcmVjb21wcmVzcyhpOTE1
KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpbGtfZmJjX2RlYWN0aXZhdGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBpbGtfZmJjX2RlYWN0aXZh
dGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJdTMyIGRwZmNfY3Rs
Owo+ICAgCj4gQEAgLTI3NCwxOSArMjc0LDE5IEBAIHN0YXRpYyB2b2lkIGlsa19mYmNfZGVhY3Rp
dmF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJfQo+ICAgfQo+ICAg
Cj4gLXN0YXRpYyBib29sIGlsa19mYmNfaXNfYWN0aXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiArc3RhdGljIGJvb2wgaWxrX2ZiY19pc19hY3RpdmUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJcmV0dXJuIEk5MTVfUkVBRChJTEtfRFBGQ19D
T05UUk9MKSAmIERQRkNfQ1RMX0VOOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGdlbjdfZmJj
X2FjdGl2YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZv
aWQgZ2VuN19mYmNfYWN0aXZhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7
Cj4gLQlzdHJ1Y3QgaW50ZWxfZmJjX3JlZ19wYXJhbXMgKnBhcmFtcyA9ICZkZXZfcHJpdi0+ZmJj
LnBhcmFtczsKPiArCXN0cnVjdCBpbnRlbF9mYmNfcmVnX3BhcmFtcyAqcGFyYW1zID0gJmk5MTUt
PmZiYy5wYXJhbXM7Cj4gICAJdTMyIGRwZmNfY3RsOwo+IC0JaW50IHRocmVzaG9sZCA9IGRldl9w
cml2LT5mYmMudGhyZXNob2xkOwo+ICsJaW50IHRocmVzaG9sZCA9IGk5MTUtPmZiYy50aHJlc2hv
bGQ7Cj4gICAKPiAgIAkvKiBEaXNwbGF5IFdBICMwNTI5OiBza2wsIGtibCwgYnh0LiAqLwo+IC0J
aWYgKElTX0dFTihkZXZfcHJpdiwgOSkgJiYgIUlTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKSB7Cj4g
KwlpZiAoSVNfR0VOKGk5MTUsIDkpICYmICFJU19HRU1JTklMQUtFKGk5MTUpKSB7Cj4gICAJCXUz
MiB2YWwgPSBJOTE1X1JFQUQoQ0hJQ0tFTl9NSVNDXzQpOwo+ICAgCj4gICAJCXZhbCAmPSB+KEZC
Q19TVFJJREVfT1ZFUlJJREUgfCBGQkNfU1RSSURFX01BU0spOwo+IEBAIC0yOTksNyArMjk5LDcg
QEAgc3RhdGljIHZvaWQgZ2VuN19mYmNfYWN0aXZhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICAgCX0KPiAgIAo+ICAgCWRwZmNfY3RsID0gMDsKPiAtCWlmIChJU19JVllC
UklER0UoZGV2X3ByaXYpKQo+ICsJaWYgKElTX0lWWUJSSURHRShpOTE1KSkKPiAgIAkJZHBmY19j
dGwgfD0gSVZCX0RQRkNfQ1RMX1BMQU5FKHBhcmFtcy0+Y3J0Yy5pOXh4X3BsYW5lKTsKPiAgIAo+
ICAgCWlmIChwYXJhbXMtPmZiLmZvcm1hdC0+Y3BwWzBdID09IDIpCj4gQEAgLTMyOSwxNSArMzI5
LDE1IEBAIHN0YXRpYyB2b2lkIGdlbjdfZmJjX2FjdGl2YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiAgIAkJSTkxNV9XUklURShEUEZDX0NQVV9GRU5DRV9PRkZTRVQsIDAp
Owo+ICAgCX0KPiAgIAo+IC0JaWYgKGRldl9wcml2LT5mYmMuZmFsc2VfY29sb3IpCj4gKwlpZiAo
aTkxNS0+ZmJjLmZhbHNlX2NvbG9yKQo+ICAgCQlkcGZjX2N0bCB8PSBGQkNfQ1RMX0ZBTFNFX0NP
TE9SOwo+ICAgCj4gLQlpZiAoSVNfSVZZQlJJREdFKGRldl9wcml2KSkgewo+ICsJaWYgKElTX0lW
WUJSSURHRShpOTE1KSkgewo+ICAgCQkvKiBXYUZiY0FzeW5jaEZsaXBEaXNhYmxlRmJjUXVldWU6
aXZiICovCj4gICAJCUk5MTVfV1JJVEUoSUxLX0RJU1BMQVlfQ0hJQ0tFTjEsCj4gICAJCQkgICBJ
OTE1X1JFQUQoSUxLX0RJU1BMQVlfQ0hJQ0tFTjEpIHwKPiAgIAkJCSAgIElMS19GQkNRX0RJUyk7
Cj4gLQl9IGVsc2UgaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElTX0JST0FEV0VMTChkZXZf
cHJpdikpIHsKPiArCX0gZWxzZSBpZiAoSVNfSEFTV0VMTChpOTE1KSB8fCBJU19CUk9BRFdFTEwo
aTkxNSkpIHsKPiAgIAkJLyogV2FGYmNBc3luY2hGbGlwRGlzYWJsZUZiY1F1ZXVlOmhzdyxiZHcg
Ki8KPiAgIAkJSTkxNV9XUklURShDSElDS0VOX1BJUEVTTF8xKHBhcmFtcy0+Y3J0Yy5waXBlKSwK
PiAgIAkJCSAgIEk5MTVfUkVBRChDSElDS0VOX1BJUEVTTF8xKHBhcmFtcy0+Y3J0Yy5waXBlKSkg
fAo+IEBAIC0zNDYsNzIgKzM0Niw3MiBAQCBzdGF0aWMgdm9pZCBnZW43X2ZiY19hY3RpdmF0ZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAKPiAgIAlJOTE1X1dSSVRFKElM
S19EUEZDX0NPTlRST0wsIGRwZmNfY3RsIHwgRFBGQ19DVExfRU4pOwo+ICAgCj4gLQlpbnRlbF9m
YmNfcmVjb21wcmVzcyhkZXZfcHJpdik7Cj4gKwlpbnRlbF9mYmNfcmVjb21wcmVzcyhpOTE1KTsK
PiAgIH0KPiAgIAo+IC1zdGF0aWMgYm9vbCBpbnRlbF9mYmNfaHdfaXNfYWN0aXZlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIGJvb2wgaW50ZWxfZmJjX2h3X2lz
X2FjdGl2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCWlmIChJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDUpCj4gLQkJcmV0dXJuIGlsa19mYmNfaXNfYWN0aXZlKGRldl9w
cml2KTsKPiAtCWVsc2UgaWYgKElTX0dNNDUoZGV2X3ByaXYpKQo+IC0JCXJldHVybiBnNHhfZmJj
X2lzX2FjdGl2ZShkZXZfcHJpdik7Cj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDUpCj4gKwkJ
cmV0dXJuIGlsa19mYmNfaXNfYWN0aXZlKGk5MTUpOwo+ICsJZWxzZSBpZiAoSVNfR000NShpOTE1
KSkKPiArCQlyZXR1cm4gZzR4X2ZiY19pc19hY3RpdmUoaTkxNSk7Cj4gICAJZWxzZQo+IC0JCXJl
dHVybiBpOHh4X2ZiY19pc19hY3RpdmUoZGV2X3ByaXYpOwo+ICsJCXJldHVybiBpOHh4X2ZiY19p
c19hY3RpdmUoaTkxNSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaW50ZWxfZmJjX2h3X2Fj
dGl2YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQg
aW50ZWxfZmJjX2h3X2FjdGl2YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAg
ewo+IC0Jc3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmRldl9wcml2LT5mYmM7Cj4gKwlzdHJ1Y3Qg
aW50ZWxfZmJjICpmYmMgPSAmaTkxNS0+ZmJjOwo+ICAgCj4gICAJZmJjLT5hY3RpdmUgPSB0cnVl
Owo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA3KQo+IC0JCWdlbjdfZmJjX2Fj
dGl2YXRlKGRldl9wcml2KTsKPiAtCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNSkK
PiAtCQlpbGtfZmJjX2FjdGl2YXRlKGRldl9wcml2KTsKPiAtCWVsc2UgaWYgKElTX0dNNDUoZGV2
X3ByaXYpKQo+IC0JCWc0eF9mYmNfYWN0aXZhdGUoZGV2X3ByaXYpOwo+ICsJaWYgKElOVEVMX0dF
TihpOTE1KSA+PSA3KQo+ICsJCWdlbjdfZmJjX2FjdGl2YXRlKGk5MTUpOwo+ICsJZWxzZSBpZiAo
SU5URUxfR0VOKGk5MTUpID49IDUpCj4gKwkJaWxrX2ZiY19hY3RpdmF0ZShpOTE1KTsKPiArCWVs
c2UgaWYgKElTX0dNNDUoaTkxNSkpCj4gKwkJZzR4X2ZiY19hY3RpdmF0ZShpOTE1KTsKPiAgIAll
bHNlCj4gLQkJaTh4eF9mYmNfYWN0aXZhdGUoZGV2X3ByaXYpOwo+ICsJCWk4eHhfZmJjX2FjdGl2
YXRlKGk5MTUpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGludGVsX2ZiY19od19kZWFjdGl2
YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaW50
ZWxfZmJjX2h3X2RlYWN0aXZhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7
Cj4gLQlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmZGV2X3ByaXYtPmZiYzsKPiArCXN0cnVjdCBp
bnRlbF9mYmMgKmZiYyA9ICZpOTE1LT5mYmM7Cj4gICAKPiAgIAlmYmMtPmFjdGl2ZSA9IGZhbHNl
Owo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA1KQo+IC0JCWlsa19mYmNfZGVh
Y3RpdmF0ZShkZXZfcHJpdik7Cj4gLQllbHNlIGlmIChJU19HTTQ1KGRldl9wcml2KSkKPiAtCQln
NHhfZmJjX2RlYWN0aXZhdGUoZGV2X3ByaXYpOwo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA1
KQo+ICsJCWlsa19mYmNfZGVhY3RpdmF0ZShpOTE1KTsKPiArCWVsc2UgaWYgKElTX0dNNDUoaTkx
NSkpCj4gKwkJZzR4X2ZiY19kZWFjdGl2YXRlKGk5MTUpOwo+ICAgCWVsc2UKPiAtCQlpOHh4X2Zi
Y19kZWFjdGl2YXRlKGRldl9wcml2KTsKPiArCQlpOHh4X2ZiY19kZWFjdGl2YXRlKGk5MTUpOwo+
ICAgfQo+ICAgCj4gICAvKioKPiAgICAqIGludGVsX2ZiY19pc19hY3RpdmUgLSBJcyBGQkMgYWN0
aXZlPwo+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gKyAqIEBpOTE1OiBp
OTE1IGRldmljZSBpbnN0YW5jZQo+ICAgICoKPiAgICAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0
byB2ZXJpZnkgdGhlIGN1cnJlbnQgc3RhdGUgb2YgRkJDLgo+ICAgICoKPiAgICAqIEZJWE1FOiBU
aGlzIHNob3VsZCBiZSB0cmFja2VkIGluIHRoZSBwbGFuZSBjb25maWcgZXZlbnR1YWxseQo+ICAg
ICogaW5zdGVhZCBvZiBxdWVyaWVkIGF0IHJ1bnRpbWUgZm9yIG1vc3QgY2FsbGVycy4KPiAgICAq
Lwo+IC1ib29sIGludGVsX2ZiY19pc19hY3RpdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ICtib29sIGludGVsX2ZiY19pc19hY3RpdmUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCj4gICB7Cj4gLQlyZXR1cm4gZGV2X3ByaXYtPmZiYy5hY3RpdmU7Cj4gKwlyZXR1
cm4gaTkxNS0+ZmJjLmFjdGl2ZTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpbnRlbF9mYmNf
ZGVhY3RpdmF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2
b2lkIGludGVsX2ZiY19kZWFjdGl2YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+
ICAgCQkJCSBjb25zdCBjaGFyICpyZWFzb24pCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfZmJjICpm
YmMgPSAmZGV2X3ByaXYtPmZiYzsKPiArCXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZpOTE1LT5m
YmM7Cj4gICAKPiAgIAlXQVJOX09OKCFtdXRleF9pc19sb2NrZWQoJmZiYy0+bG9jaykpOwo+ICAg
Cj4gICAJaWYgKGZiYy0+YWN0aXZlKQo+IC0JCWludGVsX2ZiY19od19kZWFjdGl2YXRlKGRldl9w
cml2KTsKPiArCQlpbnRlbF9mYmNfaHdfZGVhY3RpdmF0ZShpOTE1KTsKPiAgIAo+ICAgCWZiYy0+
bm9fZmJjX3JlYXNvbiA9IHJlYXNvbjsKPiAgIH0KPiBAQCAtNDE5LDEyICs0MTksMTIgQEAgc3Rh
dGljIHZvaWQgaW50ZWxfZmJjX2RlYWN0aXZhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ICAgc3RhdGljIGJvb2wgbXVsdGlwbGVfcGlwZXNfb2soc3RydWN0IGludGVsX2Ny
dGMgKmNydGMsCj4gICAJCQkgICAgICBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0
YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjcnRjLT5iYXNlLmRldik7Cj4gLQlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmZGV2X3ByaXYt
PmZiYzsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5i
YXNlLmRldik7Cj4gKwlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmaTkxNS0+ZmJjOwo+ICAgCWVu
dW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgIAo+ICAgCS8qIERvbid0IGV2ZW4gYm90aGVy
IHRyYWNraW5nIGFueXRoaW5nIHdlIGRvbid0IG5lZWQuICovCj4gLQlpZiAoIW5vX2ZiY19vbl9t
dWx0aXBsZV9waXBlcyhkZXZfcHJpdikpCj4gKwlpZiAoIW5vX2ZiY19vbl9tdWx0aXBsZV9waXBl
cyhpOTE1KSkKPiAgIAkJcmV0dXJuIHRydWU7Cj4gICAKPiAgIAlpZiAocGxhbmVfc3RhdGUtPmJh
c2UudmlzaWJsZSkKPiBAQCAtNDM1LDcgKzQzNSw3IEBAIHN0YXRpYyBib29sIG11bHRpcGxlX3Bp
cGVzX29rKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAgCXJldHVybiAoZmJjLT52aXNpYmxl
X3BpcGVzX21hc2sgJiB+KDEgPDwgcGlwZSkpICE9IDA7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGlu
dCBmaW5kX2NvbXByZXNzaW9uX3RocmVzaG9sZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gK3N0YXRpYyBpbnQgZmluZF9jb21wcmVzc2lvbl90aHJlc2hvbGQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgICAgc3RydWN0IGRybV9tbV9ub2RlICpu
b2RlLAo+ICAgCQkJCSAgICAgIGludCBzaXplLAo+ICAgCQkJCSAgICAgIGludCBmYl9jcHApCj4g
QEAgLTQ0OCw4ICs0NDgsOCBAQCBzdGF0aWMgaW50IGZpbmRfY29tcHJlc3Npb25fdGhyZXNob2xk
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkgKiByZXNlcnZlZCByYW5n
ZSBzaXplLCBzbyBpdCBhbHdheXMgYXNzdW1lcyB0aGUgbWF4aW11bSAoOG1iKSBpcyB1c2VkLgo+
ICAgCSAqIElmIHdlIGVuYWJsZSBGQkMgdXNpbmcgYSBDRkIgb24gdGhhdCBtZW1vcnkgcmFuZ2Ug
d2UnbGwgZ2V0IEZJRk8KPiAgIAkgKiB1bmRlcnJ1bnMsIGV2ZW4gaWYgdGhhdCByYW5nZSBpcyBu
b3QgcmVzZXJ2ZWQgYnkgdGhlIEJJT1MuICovCj4gLQlpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2
KSB8fCBJU19HRU45X0JDKGRldl9wcml2KSkKPiAtCQllbmQgPSByZXNvdXJjZV9zaXplKCZkZXZf
cHJpdi0+ZHNtKSAtIDggKiAxMDI0ICogMTAyNDsKPiArCWlmIChJU19CUk9BRFdFTEwoaTkxNSkg
fHwgSVNfR0VOOV9CQyhpOTE1KSkKPiArCQllbmQgPSByZXNvdXJjZV9zaXplKCZpOTE1LT5kc20p
IC0gOCAqIDEwMjQgKiAxMDI0Owo+ICAgCWVsc2UKPiAgIAkJZW5kID0gVTY0X01BWDsKPiAgIAo+
IEBAIC00NjEsNyArNDYxLDcgQEAgc3RhdGljIGludCBmaW5kX2NvbXByZXNzaW9uX3RocmVzaG9s
ZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJICovCj4gICAKPiAgIAkv
KiBUcnkgdG8gb3Zlci1hbGxvY2F0ZSB0byByZWR1Y2UgcmVhbGxvY2F0aW9ucyBhbmQgZnJhZ21l
bnRhdGlvbi4gKi8KPiAtCXJldCA9IGk5MTVfZ2VtX3N0b2xlbl9pbnNlcnRfbm9kZV9pbl9yYW5n
ZShkZXZfcHJpdiwgbm9kZSwgc2l6ZSA8PD0gMSwKPiArCXJldCA9IGk5MTVfZ2VtX3N0b2xlbl9p
bnNlcnRfbm9kZV9pbl9yYW5nZShpOTE1LCBub2RlLCBzaXplIDw8PSAxLAo+ICAgCQkJCQkJICAg
NDA5NiwgMCwgZW5kKTsKPiAgIAlpZiAocmV0ID09IDApCj4gICAJCXJldHVybiBjb21wcmVzc2lv
bl90aHJlc2hvbGQ7Cj4gQEAgLTQ3Miw5ICs0NzIsOSBAQCBzdGF0aWMgaW50IGZpbmRfY29tcHJl
c3Npb25fdGhyZXNob2xkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkg
ICAgKGZiX2NwcCA9PSAyICYmIGNvbXByZXNzaW9uX3RocmVzaG9sZCA9PSAyKSkKPiAgIAkJcmV0
dXJuIDA7Cj4gICAKPiAtCXJldCA9IGk5MTVfZ2VtX3N0b2xlbl9pbnNlcnRfbm9kZV9pbl9yYW5n
ZShkZXZfcHJpdiwgbm9kZSwgc2l6ZSA+Pj0gMSwKPiArCXJldCA9IGk5MTVfZ2VtX3N0b2xlbl9p
bnNlcnRfbm9kZV9pbl9yYW5nZShpOTE1LCBub2RlLCBzaXplID4+PSAxLAo+ICAgCQkJCQkJICAg
NDA5NiwgMCwgZW5kKTsKPiAtCWlmIChyZXQgJiYgSU5URUxfR0VOKGRldl9wcml2KSA8PSA0KSB7
Cj4gKwlpZiAocmV0ICYmIElOVEVMX0dFTihpOTE1KSA8PSA0KSB7Cj4gICAJCXJldHVybiAwOwo+
ICAgCX0gZWxzZSBpZiAocmV0KSB7Cj4gICAJCWNvbXByZXNzaW9uX3RocmVzaG9sZCA8PD0gMTsK
PiBAQCAtNDg2LDE3ICs0ODYsMTcgQEAgc3RhdGljIGludCBmaW5kX2NvbXByZXNzaW9uX3RocmVz
aG9sZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAKPiAgIHN0YXRpYyBp
bnQgaW50ZWxfZmJjX2FsbG9jX2NmYihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5k
ZXYpOwo+IC0Jc3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmRldl9wcml2LT5mYmM7Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJ
c3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmk5MTUtPmZiYzsKPiAgIAlzdHJ1Y3QgZHJtX21tX25v
ZGUgKnVuaW5pdGlhbGl6ZWRfdmFyKGNvbXByZXNzZWRfbGxiKTsKPiAgIAlpbnQgc2l6ZSwgZmJf
Y3BwLCByZXQ7Cj4gICAKPiAgIAlXQVJOX09OKGRybV9tbV9ub2RlX2FsbG9jYXRlZCgmZmJjLT5j
b21wcmVzc2VkX2ZiKSk7Cj4gICAKPiAtCXNpemUgPSBpbnRlbF9mYmNfY2FsY3VsYXRlX2NmYl9z
aXplKGRldl9wcml2LCAmZmJjLT5zdGF0ZV9jYWNoZSk7Cj4gKwlzaXplID0gaW50ZWxfZmJjX2Nh
bGN1bGF0ZV9jZmJfc2l6ZShpOTE1LCAmZmJjLT5zdGF0ZV9jYWNoZSk7Cj4gICAJZmJfY3BwID0g
ZmJjLT5zdGF0ZV9jYWNoZS5mYi5mb3JtYXQtPmNwcFswXTsKPiAgIAo+IC0JcmV0ID0gZmluZF9j
b21wcmVzc2lvbl90aHJlc2hvbGQoZGV2X3ByaXYsICZmYmMtPmNvbXByZXNzZWRfZmIsCj4gKwly
ZXQgPSBmaW5kX2NvbXByZXNzaW9uX3RocmVzaG9sZChpOTE1LCAmZmJjLT5jb21wcmVzc2VkX2Zi
LAo+ICAgCQkJCQkgc2l6ZSwgZmJfY3BwKTsKPiAgIAlpZiAoIXJldCkKPiAgIAkJZ290byBlcnJf
bGxiOwo+IEBAIC01MDcsMzIgKzUwNywzMiBAQCBzdGF0aWMgaW50IGludGVsX2ZiY19hbGxvY19j
ZmIoc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gICAKPiAgIAlmYmMtPnRocmVzaG9sZCA9IHJl
dDsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNSkKPiArCWlmIChJTlRFTF9H
RU4oaTkxNSkgPj0gNSkKPiAgIAkJSTkxNV9XUklURShJTEtfRFBGQ19DQl9CQVNFLCBmYmMtPmNv
bXByZXNzZWRfZmIuc3RhcnQpOwo+IC0JZWxzZSBpZiAoSVNfR000NShkZXZfcHJpdikpIHsKPiAr
CWVsc2UgaWYgKElTX0dNNDUoaTkxNSkpIHsKPiAgIAkJSTkxNV9XUklURShEUEZDX0NCX0JBU0Us
IGZiYy0+Y29tcHJlc3NlZF9mYi5zdGFydCk7Cj4gICAJfSBlbHNlIHsKPiAgIAkJY29tcHJlc3Nl
ZF9sbGIgPSBremFsbG9jKHNpemVvZigqY29tcHJlc3NlZF9sbGIpLCBHRlBfS0VSTkVMKTsKPiAg
IAkJaWYgKCFjb21wcmVzc2VkX2xsYikKPiAgIAkJCWdvdG8gZXJyX2ZiOwo+ICAgCj4gLQkJcmV0
ID0gaTkxNV9nZW1fc3RvbGVuX2luc2VydF9ub2RlKGRldl9wcml2LCBjb21wcmVzc2VkX2xsYiwK
PiArCQlyZXQgPSBpOTE1X2dlbV9zdG9sZW5faW5zZXJ0X25vZGUoaTkxNSwgY29tcHJlc3NlZF9s
bGIsCj4gICAJCQkJCQkgIDQwOTYsIDQwOTYpOwo+ICAgCQlpZiAocmV0KQo+ICAgCQkJZ290byBl
cnJfZmI7Cj4gICAKPiAgIAkJZmJjLT5jb21wcmVzc2VkX2xsYiA9IGNvbXByZXNzZWRfbGxiOwo+
ICAgCj4gLQkJR0VNX0JVR19PTihyYW5nZV9vdmVyZmxvd3NfdCh1NjQsIGRldl9wcml2LT5kc20u
c3RhcnQsCj4gKwkJR0VNX0JVR19PTihyYW5nZV9vdmVyZmxvd3NfdCh1NjQsIGk5MTUtPmRzbS5z
dGFydCwKPiAgIAkJCQkJICAgICBmYmMtPmNvbXByZXNzZWRfZmIuc3RhcnQsCj4gICAJCQkJCSAg
ICAgVTMyX01BWCkpOwo+IC0JCUdFTV9CVUdfT04ocmFuZ2Vfb3ZlcmZsb3dzX3QodTY0LCBkZXZf
cHJpdi0+ZHNtLnN0YXJ0LAo+ICsJCUdFTV9CVUdfT04ocmFuZ2Vfb3ZlcmZsb3dzX3QodTY0LCBp
OTE1LT5kc20uc3RhcnQsCj4gICAJCQkJCSAgICAgZmJjLT5jb21wcmVzc2VkX2xsYi0+c3RhcnQs
Cj4gICAJCQkJCSAgICAgVTMyX01BWCkpOwo+ICAgCQlJOTE1X1dSSVRFKEZCQ19DRkJfQkFTRSwK
PiAtCQkJICAgZGV2X3ByaXYtPmRzbS5zdGFydCArIGZiYy0+Y29tcHJlc3NlZF9mYi5zdGFydCk7
Cj4gKwkJCSAgIGk5MTUtPmRzbS5zdGFydCArIGZiYy0+Y29tcHJlc3NlZF9mYi5zdGFydCk7Cj4g
ICAJCUk5MTVfV1JJVEUoRkJDX0xMX0JBU0UsCj4gLQkJCSAgIGRldl9wcml2LT5kc20uc3RhcnQg
KyBjb21wcmVzc2VkX2xsYi0+c3RhcnQpOwo+ICsJCQkgICBpOTE1LT5kc20uc3RhcnQgKyBjb21w
cmVzc2VkX2xsYi0+c3RhcnQpOwo+ICAgCX0KPiAgIAo+ICAgCURSTV9ERUJVR19LTVMoInJlc2Vy
dmVkICVsbHUgYnl0ZXMgb2YgY29udGlndW91cyBzdG9sZW4gc3BhY2UgZm9yIEZCQywgdGhyZXNo
b2xkOiAlZFxuIiwKPiBAQCAtNTQyLDM5ICs1NDIsMzkgQEAgc3RhdGljIGludCBpbnRlbF9mYmNf
YWxsb2NfY2ZiKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+ICAgCj4gICBlcnJfZmI6Cj4gICAJ
a2ZyZWUoY29tcHJlc3NlZF9sbGIpOwo+IC0JaTkxNV9nZW1fc3RvbGVuX3JlbW92ZV9ub2RlKGRl
dl9wcml2LCAmZmJjLT5jb21wcmVzc2VkX2ZiKTsKPiArCWk5MTVfZ2VtX3N0b2xlbl9yZW1vdmVf
bm9kZShpOTE1LCAmZmJjLT5jb21wcmVzc2VkX2ZiKTsKPiAgIGVycl9sbGI6Cj4gLQlpZiAoZHJt
X21tX2luaXRpYWxpemVkKCZkZXZfcHJpdi0+bW0uc3RvbGVuKSkKPiArCWlmIChkcm1fbW1faW5p
dGlhbGl6ZWQoJmk5MTUtPm1tLnN0b2xlbikpCj4gICAJCXByX2luZm9fb25jZSgiZHJtOiBub3Qg
ZW5vdWdoIHN0b2xlbiBzcGFjZSBmb3IgY29tcHJlc3NlZCBidWZmZXIgKG5lZWQgJWQgbW9yZSBi
eXRlcyksIGRpc2FibGluZy4gSGludDogeW91IG1heSBiZSBhYmxlIHRvIGluY3JlYXNlIHN0b2xl
biBtZW1vcnkgc2l6ZSBpbiB0aGUgQklPUyB0byBhdm9pZCB0aGlzLlxuIiwgc2l6ZSk7Cj4gICAJ
cmV0dXJuIC1FTk9TUEM7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgX19pbnRlbF9mYmNfY2xl
YW51cF9jZmIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9p
ZCBfX2ludGVsX2ZiY19jbGVhbnVwX2NmYihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiAgIHsKPiAtCXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZkZXZfcHJpdi0+ZmJjOwo+ICsJc3Ry
dWN0IGludGVsX2ZiYyAqZmJjID0gJmk5MTUtPmZiYzsKPiAgIAo+ICAgCWlmIChkcm1fbW1fbm9k
ZV9hbGxvY2F0ZWQoJmZiYy0+Y29tcHJlc3NlZF9mYikpCj4gLQkJaTkxNV9nZW1fc3RvbGVuX3Jl
bW92ZV9ub2RlKGRldl9wcml2LCAmZmJjLT5jb21wcmVzc2VkX2ZiKTsKPiArCQlpOTE1X2dlbV9z
dG9sZW5fcmVtb3ZlX25vZGUoaTkxNSwgJmZiYy0+Y29tcHJlc3NlZF9mYik7Cj4gICAKPiAgIAlp
ZiAoZmJjLT5jb21wcmVzc2VkX2xsYikgewo+IC0JCWk5MTVfZ2VtX3N0b2xlbl9yZW1vdmVfbm9k
ZShkZXZfcHJpdiwgZmJjLT5jb21wcmVzc2VkX2xsYik7Cj4gKwkJaTkxNV9nZW1fc3RvbGVuX3Jl
bW92ZV9ub2RlKGk5MTUsIGZiYy0+Y29tcHJlc3NlZF9sbGIpOwo+ICAgCQlrZnJlZShmYmMtPmNv
bXByZXNzZWRfbGxiKTsKPiAgIAl9Cj4gICB9Cj4gICAKPiAtdm9pZCBpbnRlbF9mYmNfY2xlYW51
cF9jZmIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGludGVsX2Zi
Y19jbGVhbnVwX2NmYihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0
cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZkZXZfcHJpdi0+ZmJjOwo+ICsJc3RydWN0IGludGVsX2Zi
YyAqZmJjID0gJmk5MTUtPmZiYzsKPiAgIAo+IC0JaWYgKCFmYmNfc3VwcG9ydGVkKGRldl9wcml2
KSkKPiArCWlmICghZmJjX3N1cHBvcnRlZChpOTE1KSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJ
bXV0ZXhfbG9jaygmZmJjLT5sb2NrKTsKPiAtCV9faW50ZWxfZmJjX2NsZWFudXBfY2ZiKGRldl9w
cml2KTsKPiArCV9faW50ZWxfZmJjX2NsZWFudXBfY2ZiKGk5MTUpOwo+ICAgCW11dGV4X3VubG9j
aygmZmJjLT5sb2NrKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgYm9vbCBzdHJpZGVfaXNfdmFsaWQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgYm9vbCBzdHJpZGVf
aXNfdmFsaWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICAgdW5zaWdu
ZWQgaW50IHN0cmlkZSkKPiAgIHsKPiAgIAkvKiBUaGlzIHNob3VsZCBoYXZlIGJlZW4gY2F1Z2h0
IGVhcmxpZXIuICovCj4gQEAgLTU4NSwxMCArNTg1LDEwIEBAIHN0YXRpYyBib29sIHN0cmlkZV9p
c192YWxpZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJaWYgKHN0cmlk
ZSA8IDUxMikKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAgCj4gLQlpZiAoSVNfR0VOKGRldl9wcml2
LCAyKSB8fCBJU19HRU4oZGV2X3ByaXYsIDMpKQo+ICsJaWYgKElTX0dFTihpOTE1LCAyKSB8fCBJ
U19HRU4oaTkxNSwgMykpCj4gICAJCXJldHVybiBzdHJpZGUgPT0gNDA5NiB8fCBzdHJpZGUgPT0g
ODE5MjsKPiAgIAo+IC0JaWYgKElTX0dFTihkZXZfcHJpdiwgNCkgJiYgIUlTX0c0WChkZXZfcHJp
dikgJiYgc3RyaWRlIDwgMjA0OCkKPiArCWlmIChJU19HRU4oaTkxNSwgNCkgJiYgIUlTX0c0WChp
OTE1KSAmJiBzdHJpZGUgPCAyMDQ4KQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gICAKPiAgIAlpZiAo
c3RyaWRlID4gMTYzODQpCj4gQEAgLTU5Nyw3ICs1OTcsNyBAQCBzdGF0aWMgYm9vbCBzdHJpZGVf
aXNfdmFsaWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCXJldHVybiB0
cnVlOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBib29sIHBpeGVsX2Zvcm1hdF9pc192YWxpZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBib29sIHBpeGVsX2Zvcm1h
dF9pc192YWxpZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgIHUzMiBw
aXhlbF9mb3JtYXQpCj4gICB7Cj4gICAJc3dpdGNoIChwaXhlbF9mb3JtYXQpIHsKPiBAQCAtNjA3
LDEwICs2MDcsMTAgQEAgc3RhdGljIGJvb2wgcGl4ZWxfZm9ybWF0X2lzX3ZhbGlkKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAljYXNlIERSTV9GT1JNQVRfWFJHQjE1NTU6
Cj4gICAJY2FzZSBEUk1fRk9STUFUX1JHQjU2NToKPiAgIAkJLyogMTZicHAgbm90IHN1cHBvcnRl
ZCBvbiBnZW4yICovCj4gLQkJaWYgKElTX0dFTihkZXZfcHJpdiwgMikpCj4gKwkJaWYgKElTX0dF
TihpOTE1LCAyKSkKPiAgIAkJCXJldHVybiBmYWxzZTsKPiAgIAkJLyogV2FGYmNPbmx5MXRvMVJh
dGlvOmN0ZyAqLwo+IC0JCWlmIChJU19HNFgoZGV2X3ByaXYpKQo+ICsJCWlmIChJU19HNFgoaTkx
NSkpCj4gICAJCQlyZXR1cm4gZmFsc2U7Cj4gICAJCXJldHVybiB0cnVlOwo+ICAgCWRlZmF1bHQ6
Cj4gQEAgLTYyNiwxNyArNjI2LDE3IEBAIHN0YXRpYyBib29sIHBpeGVsX2Zvcm1hdF9pc192YWxp
ZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAgKi8KPiAgIHN0YXRpYyBi
b29sIGludGVsX2ZiY19od190cmFja2luZ19jb3ZlcnNfc2NyZWVuKHN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShjcnRjLT5iYXNlLmRldik7Cj4gLQlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmZGV2X3By
aXYtPmZiYzsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmaTkxNS0+ZmJjOwo+ICAg
CXVuc2lnbmVkIGludCBlZmZlY3RpdmVfdywgZWZmZWN0aXZlX2gsIG1heF93LCBtYXhfaDsKPiAg
IAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgfHwgSVNfR0VNSU5JTEFLRShkZXZf
cHJpdikpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTAgfHwgSVNfR0VNSU5JTEFLRShp
OTE1KSkgewo+ICAgCQltYXhfdyA9IDUxMjA7Cj4gICAJCW1heF9oID0gNDA5NjsKPiAtCX0gZWxz
ZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA4IHx8IElTX0hBU1dFTEwoZGV2X3ByaXYpKSB7
Cj4gKwl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA4IHx8IElTX0hBU1dFTEwoaTkxNSkp
IHsKPiAgIAkJbWF4X3cgPSA0MDk2Owo+ICAgCQltYXhfaCA9IDQwOTY7Cj4gLQl9IGVsc2UgaWYg
KElTX0c0WChkZXZfcHJpdikgfHwgSU5URUxfR0VOKGRldl9wcml2KSA+PSA1KSB7Cj4gKwl9IGVs
c2UgaWYgKElTX0c0WChpOTE1KSB8fCBJTlRFTF9HRU4oaTkxNSkgPj0gNSkgewo+ICAgCQltYXhf
dyA9IDQwOTY7Cj4gICAJCW1heF9oID0gMjA0ODsKPiAgIAl9IGVsc2Ugewo+IEBAIC02NTYsOCAr
NjU2LDggQEAgc3RhdGljIHZvaWQgaW50ZWxfZmJjX3VwZGF0ZV9zdGF0ZV9jYWNoZShzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YywKPiAgIAkJCQkJIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlLAo+ICAgCQkJCQkgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkK
PiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwo+IC0Jc3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmRldl9wcml2LT5mYmM7
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5k
ZXYpOwo+ICsJc3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmk5MTUtPmZiYzsKPiAgIAlzdHJ1Y3Qg
aW50ZWxfZmJjX3N0YXRlX2NhY2hlICpjYWNoZSA9ICZmYmMtPnN0YXRlX2NhY2hlOwo+ICAgCXN0
cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxhbmVfc3RhdGUtPmJhc2UuZmI7Cj4gICAKPiBA
QCAtNjY1LDcgKzY2NSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2ZiY191cGRhdGVfc3RhdGVfY2Fj
aGUoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gICAJY2FjaGUtPmZsYWdzID0gMDsKPiAgIAo+
ICAgCWNhY2hlLT5jcnRjLm1vZGVfZmxhZ3MgPSBjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21v
ZGUuZmxhZ3M7Cj4gLQlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgfHwgSVNfQlJPQURXRUxMKGRl
dl9wcml2KSkKPiArCWlmIChJU19IQVNXRUxMKGk5MTUpIHx8IElTX0JST0FEV0VMTChpOTE1KSkK
PiAgIAkJY2FjaGUtPmNydGMuaHN3X2Jkd19waXhlbF9yYXRlID0gY3J0Y19zdGF0ZS0+cGl4ZWxf
cmF0ZTsKPiAgIAo+ICAgCWNhY2hlLT5wbGFuZS5yb3RhdGlvbiA9IHBsYW5lX3N0YXRlLT5iYXNl
LnJvdGF0aW9uOwo+IEBAIC02OTcsOCArNjk3LDggQEAgc3RhdGljIHZvaWQgaW50ZWxfZmJjX3Vw
ZGF0ZV9zdGF0ZV9jYWNoZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAo+ICAgc3RhdGlj
IGJvb2wgaW50ZWxfZmJjX2Nhbl9hY3RpdmF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiAg
IHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+
YmFzZS5kZXYpOwo+IC0Jc3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmRldl9wcml2LT5mYmM7Cj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYp
Owo+ICsJc3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmk5MTUtPmZiYzsKPiAgIAlzdHJ1Y3QgaW50
ZWxfZmJjX3N0YXRlX2NhY2hlICpjYWNoZSA9ICZmYmMtPnN0YXRlX2NhY2hlOwo+ICAgCj4gICAJ
LyogV2UgZG9uJ3QgbmVlZCB0byB1c2UgYSBzdGF0ZSBjYWNoZSBoZXJlIHNpbmNlIHRoaXMgaW5m
b3JtYXRpb24gaXMKPiBAQCAtNzQxLDE4ICs3NDEsMTggQEAgc3RhdGljIGJvb2wgaW50ZWxfZmJj
X2Nhbl9hY3RpdmF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiAgIAkJZmJjLT5ub19mYmNf
cmVhc29uID0gImZyYW1lYnVmZmVyIG5vdCB0aWxlZCBvciBmZW5jZWQiOwo+ICAgCQlyZXR1cm4g
ZmFsc2U7Cj4gICAJfQo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPD0gNCAmJiAhSVNfRzRY
KGRldl9wcml2KSAmJgo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8PSA0ICYmICFJU19HNFgoaTkx
NSkgJiYKPiAgIAkgICAgY2FjaGUtPnBsYW5lLnJvdGF0aW9uICE9IERSTV9NT0RFX1JPVEFURV8w
KSB7Cj4gICAJCWZiYy0+bm9fZmJjX3JlYXNvbiA9ICJyb3RhdGlvbiB1bnN1cHBvcnRlZCI7Cj4g
ICAJCXJldHVybiBmYWxzZTsKPiAgIAl9Cj4gICAKPiAtCWlmICghc3RyaWRlX2lzX3ZhbGlkKGRl
dl9wcml2LCBjYWNoZS0+ZmIuc3RyaWRlKSkgewo+ICsJaWYgKCFzdHJpZGVfaXNfdmFsaWQoaTkx
NSwgY2FjaGUtPmZiLnN0cmlkZSkpIHsKPiAgIAkJZmJjLT5ub19mYmNfcmVhc29uID0gImZyYW1l
YnVmZmVyIHN0cmlkZSBub3Qgc3VwcG9ydGVkIjsKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAgCX0K
PiAgIAo+IC0JaWYgKCFwaXhlbF9mb3JtYXRfaXNfdmFsaWQoZGV2X3ByaXYsIGNhY2hlLT5mYi5m
b3JtYXQtPmZvcm1hdCkpIHsKPiArCWlmICghcGl4ZWxfZm9ybWF0X2lzX3ZhbGlkKGk5MTUsIGNh
Y2hlLT5mYi5mb3JtYXQtPmZvcm1hdCkpIHsKPiAgIAkJZmJjLT5ub19mYmNfcmVhc29uID0gInBp
eGVsIGZvcm1hdCBpcyBpbnZhbGlkIjsKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAgCX0KPiBAQCAt
NzY0LDggKzc2NCw4IEBAIHN0YXRpYyBib29sIGludGVsX2ZiY19jYW5fYWN0aXZhdGUoc3RydWN0
IGludGVsX2NydGMgKmNydGMpCj4gICAJfQo+ICAgCj4gICAJLyogV2FGYmNFeGNlZWRDZENsb2Nr
VGhyZXNob2xkOmhzdyxiZHcgKi8KPiAtCWlmICgoSVNfSEFTV0VMTChkZXZfcHJpdikgfHwgSVNf
QlJPQURXRUxMKGRldl9wcml2KSkgJiYKPiAtCSAgICBjYWNoZS0+Y3J0Yy5oc3dfYmR3X3BpeGVs
X3JhdGUgPj0gZGV2X3ByaXYtPmNkY2xrLmh3LmNkY2xrICogOTUgLyAxMDApIHsKPiArCWlmICgo
SVNfSEFTV0VMTChpOTE1KSB8fCBJU19CUk9BRFdFTEwoaTkxNSkpICYmCj4gKwkgICAgY2FjaGUt
PmNydGMuaHN3X2Jkd19waXhlbF9yYXRlID49IGk5MTUtPmNkY2xrLmh3LmNkY2xrICogOTUgLyAx
MDApIHsKPiAgIAkJZmJjLT5ub19mYmNfcmVhc29uID0gInBpeGVsIHJhdGUgaXMgdG9vIGJpZyI7
Cj4gICAJCXJldHVybiBmYWxzZTsKPiAgIAl9Cj4gQEAgLTc4MCw3ICs3ODAsNyBAQCBzdGF0aWMg
Ym9vbCBpbnRlbF9mYmNfY2FuX2FjdGl2YXRlKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+ICAg
CSAqIHdlIGRpZG4ndCBnZXQgYW55IGludmFsaWRhdGUvZGVhY3RpdmF0ZSBjYWxscywgYnV0IHRo
aXMgd291bGQgcmVxdWlyZQo+ICAgCSAqIGEgbG90IG9mIHRyYWNraW5nIGp1c3QgZm9yIGEgc3Bl
Y2lmaWMgY2FzZS4gSWYgd2UgY29uY2x1ZGUgaXQncyBhbgo+ICAgCSAqIGltcG9ydGFudCBjYXNl
LCB3ZSBjYW4gaW1wbGVtZW50IGl0IGxhdGVyLiAqLwo+IC0JaWYgKGludGVsX2ZiY19jYWxjdWxh
dGVfY2ZiX3NpemUoZGV2X3ByaXYsICZmYmMtPnN0YXRlX2NhY2hlKSA+Cj4gKwlpZiAoaW50ZWxf
ZmJjX2NhbGN1bGF0ZV9jZmJfc2l6ZShpOTE1LCAmZmJjLT5zdGF0ZV9jYWNoZSkgPgo+ICAgCSAg
ICBmYmMtPmNvbXByZXNzZWRfZmIuc2l6ZSAqIGZiYy0+dGhyZXNob2xkKSB7Cj4gICAJCWZiYy0+
bm9fZmJjX3JlYXNvbiA9ICJDRkIgcmVxdWlyZW1lbnRzIGNoYW5nZWQiOwo+ICAgCQlyZXR1cm4g
ZmFsc2U7Cj4gQEAgLTc5MSw3ICs3OTEsNyBAQCBzdGF0aWMgYm9vbCBpbnRlbF9mYmNfY2FuX2Fj
dGl2YXRlKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+ICAgCSAqIGhhdmluZyBhIFkgb2Zmc2V0
IHRoYXQgaXNuJ3QgZGl2aXNpYmxlIGJ5IDQgY2F1c2VzIEZJRk8gdW5kZXJydW4KPiAgIAkgKiBh
bmQgc2NyZWVuIGZsaWNrZXIuCj4gICAJICovCj4gLQlpZiAoSVNfR0VOX1JBTkdFKGRldl9wcml2
LCA5LCAxMCkgJiYKPiArCWlmIChJU19HRU5fUkFOR0UoaTkxNSwgOSwgMTApICYmCj4gICAJICAg
IChmYmMtPnN0YXRlX2NhY2hlLnBsYW5lLmFkanVzdGVkX3kgJiAzKSkgewo+ICAgCQlmYmMtPm5v
X2ZiY19yZWFzb24gPSAicGxhbmUgWSBvZmZzZXQgaXMgbWlzYWxpZ25lZCI7Cj4gICAJCXJldHVy
biBmYWxzZTsKPiBAQCAtODAwLDExICs4MDAsMTEgQEAgc3RhdGljIGJvb2wgaW50ZWxfZmJjX2Nh
bl9hY3RpdmF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiAgIAlyZXR1cm4gdHJ1ZTsKPiAg
IH0KPiAgIAo+IC1zdGF0aWMgYm9vbCBpbnRlbF9mYmNfY2FuX2VuYWJsZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyBib29sIGludGVsX2ZiY19jYW5fZW5hYmxl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RydWN0IGludGVsX2Zi
YyAqZmJjID0gJmRldl9wcml2LT5mYmM7Cj4gKwlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmaTkx
NS0+ZmJjOwo+ICAgCj4gLQlpZiAoaW50ZWxfdmdwdV9hY3RpdmUoZGV2X3ByaXYpKSB7Cj4gKwlp
ZiAoaW50ZWxfdmdwdV9hY3RpdmUoaTkxNSkpIHsKPiAgIAkJZmJjLT5ub19mYmNfcmVhc29uID0g
IlZHUFUgaXMgYWN0aXZlIjsKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAgCX0KPiBAQCAtODI1LDgg
KzgyNSw4IEBAIHN0YXRpYyBib29sIGludGVsX2ZiY19jYW5fZW5hYmxlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiAgIHN0YXRpYyB2b2lkIGludGVsX2ZiY19nZXRfcmVnX3Bh
cmFtcyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAkJCQkgICAgIHN0cnVjdCBpbnRlbF9m
YmNfcmVnX3BhcmFtcyAqcGFyYW1zKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gLQlzdHJ1Y3QgaW50ZWxfZmJj
ICpmYmMgPSAmZGV2X3ByaXYtPmZiYzsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAm
aTkxNS0+ZmJjOwo+ICAgCXN0cnVjdCBpbnRlbF9mYmNfc3RhdGVfY2FjaGUgKmNhY2hlID0gJmZi
Yy0+c3RhdGVfY2FjaGU7Cj4gICAKPiAgIAkvKiBTaW5jZSBhbGwgb3VyIGZpZWxkcyBhcmUgaW50
ZWdlciB0eXBlcywgdXNlIG1lbXNldCBoZXJlIHNvIHRoZQo+IEBAIC04NDQsOSArODQ0LDkgQEAg
c3RhdGljIHZvaWQgaW50ZWxfZmJjX2dldF9yZWdfcGFyYW1zKHN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjLAo+ICAgCXBhcmFtcy0+ZmIuZm9ybWF0ID0gY2FjaGUtPmZiLmZvcm1hdDsKPiAgIAlwYXJh
bXMtPmZiLnN0cmlkZSA9IGNhY2hlLT5mYi5zdHJpZGU7Cj4gICAKPiAtCXBhcmFtcy0+Y2ZiX3Np
emUgPSBpbnRlbF9mYmNfY2FsY3VsYXRlX2NmYl9zaXplKGRldl9wcml2LCBjYWNoZSk7Cj4gKwlw
YXJhbXMtPmNmYl9zaXplID0gaW50ZWxfZmJjX2NhbGN1bGF0ZV9jZmJfc2l6ZShpOTE1LCBjYWNo
ZSk7Cj4gICAKPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDkpICYmICFJU19HRU1JTklMQUtFKGRl
dl9wcml2KSkKPiArCWlmIChJU19HRU4oaTkxNSwgOSkgJiYgIUlTX0dFTUlOSUxBS0UoaTkxNSkp
Cj4gICAJCXBhcmFtcy0+Z2VuOV93YV9jZmJfc3RyaWRlID0gRElWX1JPVU5EX1VQKGNhY2hlLT5w
bGFuZS5zcmNfdywKPiAgIAkJCQkJCTMyICogZmJjLT50aHJlc2hvbGQpICogODsKPiAgIH0KPiBA
QCAtODU1LDExICs4NTUsMTEgQEAgdm9pZCBpbnRlbF9mYmNfcHJlX3VwZGF0ZShzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YywKPiAgIAkJCSAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUsCj4gICAJCQkgIHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJh
c2UuZGV2KTsKPiAtCXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZkZXZfcHJpdi0+ZmJjOwo+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsK
PiArCXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZpOTE1LT5mYmM7Cj4gICAJY29uc3QgY2hhciAq
cmVhc29uID0gInVwZGF0ZSBwZW5kaW5nIjsKPiAgIAo+IC0JaWYgKCFmYmNfc3VwcG9ydGVkKGRl
dl9wcml2KSkKPiArCWlmICghZmJjX3N1cHBvcnRlZChpOTE1KSkKPiAgIAkJcmV0dXJuOwo+ICAg
Cj4gICAJbXV0ZXhfbG9jaygmZmJjLT5sb2NrKTsKPiBAQCAtODc2LDIxICs4NzYsMjEgQEAgdm9p
ZCBpbnRlbF9mYmNfcHJlX3VwZGF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAlmYmMt
PmZsaXBfcGVuZGluZyA9IHRydWU7Cj4gICAKPiAgIGRlYWN0aXZhdGU6Cj4gLQlpbnRlbF9mYmNf
ZGVhY3RpdmF0ZShkZXZfcHJpdiwgcmVhc29uKTsKPiArCWludGVsX2ZiY19kZWFjdGl2YXRlKGk5
MTUsIHJlYXNvbik7Cj4gICB1bmxvY2s6Cj4gICAJbXV0ZXhfdW5sb2NrKCZmYmMtPmxvY2spOwo+
ICAgfQo+ICAgCj4gICAvKioKPiAgICAqIF9faW50ZWxfZmJjX2Rpc2FibGUgLSBkaXNhYmxlIEZC
Qwo+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gKyAqIEBpOTE1OiBpOTE1
IGRldmljZSBpbnN0YW5jZQo+ICAgICoKPiAgICAqIFRoaXMgaXMgdGhlIGxvdyBsZXZlbCBmdW5j
dGlvbiB0aGF0IGFjdHVhbGx5IGRpc2FibGVzIEZCQy4gQ2FsbGVycyBzaG91bGQKPiAgICAqIGdy
YWIgdGhlIEZCQyBsb2NrLgo+ICAgICovCj4gLXN0YXRpYyB2b2lkIF9faW50ZWxfZmJjX2Rpc2Fi
bGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBfX2lu
dGVsX2ZiY19kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0J
c3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmRldl9wcml2LT5mYmM7Cj4gKwlzdHJ1Y3QgaW50ZWxf
ZmJjICpmYmMgPSAmaTkxNS0+ZmJjOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gZmJj
LT5jcnRjOwo+ICAgCj4gICAJV0FSTl9PTighbXV0ZXhfaXNfbG9ja2VkKCZmYmMtPmxvY2spKTsK
PiBAQCAtODk5LDcgKzg5OSw3IEBAIHN0YXRpYyB2b2lkIF9faW50ZWxfZmJjX2Rpc2FibGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCj4gICAJRFJNX0RFQlVHX0tNUygi
RGlzYWJsaW5nIEZCQyBvbiBwaXBlICVjXG4iLCBwaXBlX25hbWUoY3J0Yy0+cGlwZSkpOwo+ICAg
Cj4gLQlfX2ludGVsX2ZiY19jbGVhbnVwX2NmYihkZXZfcHJpdik7Cj4gKwlfX2ludGVsX2ZiY19j
bGVhbnVwX2NmYihpOTE1KTsKPiAgIAo+ICAgCWZiYy0+ZW5hYmxlZCA9IGZhbHNlOwo+ICAgCWZi
Yy0+Y3J0YyA9IE5VTEw7Cj4gQEAgLTkwNyw4ICs5MDcsOCBAQCBzdGF0aWMgdm9pZCBfX2ludGVs
X2ZiY19kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAo+ICAg
c3RhdGljIHZvaWQgX19pbnRlbF9mYmNfcG9zdF91cGRhdGUoc3RydWN0IGludGVsX2NydGMgKmNy
dGMpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGNydGMtPmJhc2UuZGV2KTsKPiAtCXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZkZXZfcHJpdi0+
ZmJjOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJh
c2UuZGV2KTsKPiArCXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZpOTE1LT5mYmM7Cj4gICAKPiAg
IAlXQVJOX09OKCFtdXRleF9pc19sb2NrZWQoJmZiYy0+bG9jaykpOwo+ICAgCj4gQEAgLTkxOSw4
ICs5MTksOCBAQCBzdGF0aWMgdm9pZCBfX2ludGVsX2ZiY19wb3N0X3VwZGF0ZShzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YykKPiAgIAlXQVJOX09OKGZiYy0+YWN0aXZlKTsKPiAgIAo+ICAgCWlmICgh
aTkxNV9tb2RwYXJhbXMuZW5hYmxlX2ZiYykgewo+IC0JCWludGVsX2ZiY19kZWFjdGl2YXRlKGRl
dl9wcml2LCAiZGlzYWJsZWQgYXQgcnVudGltZSBwZXIgbW9kdWxlIHBhcmFtIik7Cj4gLQkJX19p
bnRlbF9mYmNfZGlzYWJsZShkZXZfcHJpdik7Cj4gKwkJaW50ZWxfZmJjX2RlYWN0aXZhdGUoaTkx
NSwgImRpc2FibGVkIGF0IHJ1bnRpbWUgcGVyIG1vZHVsZSBwYXJhbSIpOwo+ICsJCV9faW50ZWxf
ZmJjX2Rpc2FibGUoaTkxNSk7Cj4gICAKPiAgIAkJcmV0dXJuOwo+ICAgCX0KPiBAQCAtOTMxLDE4
ICs5MzEsMTggQEAgc3RhdGljIHZvaWQgX19pbnRlbF9mYmNfcG9zdF91cGRhdGUoc3RydWN0IGlu
dGVsX2NydGMgKmNydGMpCj4gICAJCXJldHVybjsKPiAgIAo+ICAgCWlmICghZmJjLT5idXN5X2Jp
dHMpIHsKPiAtCQlpbnRlbF9mYmNfZGVhY3RpdmF0ZShkZXZfcHJpdiwgIkZCQyBlbmFibGVkIChh
Y3RpdmUgb3Igc2NoZWR1bGVkKSIpOwo+IC0JCWludGVsX2ZiY19od19hY3RpdmF0ZShkZXZfcHJp
dik7Cj4gKwkJaW50ZWxfZmJjX2RlYWN0aXZhdGUoaTkxNSwgIkZCQyBlbmFibGVkIChhY3RpdmUg
b3Igc2NoZWR1bGVkKSIpOwo+ICsJCWludGVsX2ZiY19od19hY3RpdmF0ZShpOTE1KTsKPiAgIAl9
IGVsc2UKPiAtCQlpbnRlbF9mYmNfZGVhY3RpdmF0ZShkZXZfcHJpdiwgImZyb250YnVmZmVyIHdy
aXRlIik7Cj4gKwkJaW50ZWxfZmJjX2RlYWN0aXZhdGUoaTkxNSwgImZyb250YnVmZmVyIHdyaXRl
Iik7Cj4gICB9Cj4gICAKPiAgIHZvaWQgaW50ZWxfZmJjX3Bvc3RfdXBkYXRlKHN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gLQlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAm
ZGV2X3ByaXYtPmZiYzsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmaTkxNS0+ZmJj
Owo+ICAgCj4gLQlpZiAoIWZiY19zdXBwb3J0ZWQoZGV2X3ByaXYpKQo+ICsJaWYgKCFmYmNfc3Vw
cG9ydGVkKGk5MTUpKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAltdXRleF9sb2NrKCZmYmMtPmxv
Y2spOwo+IEBAIC05NTgsMTMgKzk1OCwxMyBAQCBzdGF0aWMgdW5zaWduZWQgaW50IGludGVsX2Zi
Y19nZXRfZnJvbnRidWZmZXJfYml0KHN0cnVjdCBpbnRlbF9mYmMgKmZiYykKPiAgIAkJcmV0dXJu
IGZiYy0+cG9zc2libGVfZnJhbWVidWZmZXJfYml0czsKPiAgIH0KPiAgIAo+IC12b2lkIGludGVs
X2ZiY19pbnZhbGlkYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArdm9p
ZCBpbnRlbF9mYmNfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAg
IAkJCSAgdW5zaWduZWQgaW50IGZyb250YnVmZmVyX2JpdHMsCj4gICAJCQkgIGVudW0gZmJfb3Bf
b3JpZ2luIG9yaWdpbikKPiAgIHsKPiAtCXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZkZXZfcHJp
di0+ZmJjOwo+ICsJc3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmk5MTUtPmZiYzsKPiAgIAo+IC0J
aWYgKCFmYmNfc3VwcG9ydGVkKGRldl9wcml2KSkKPiArCWlmICghZmJjX3N1cHBvcnRlZChpOTE1
KSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJaWYgKG9yaWdpbiA9PSBPUklHSU5fR1RUIHx8IG9y
aWdpbiA9PSBPUklHSU5fRkxJUCkKPiBAQCAtOTc1LDE3ICs5NzUsMTcgQEAgdm9pZCBpbnRlbF9m
YmNfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJZmJj
LT5idXN5X2JpdHMgfD0gaW50ZWxfZmJjX2dldF9mcm9udGJ1ZmZlcl9iaXQoZmJjKSAmIGZyb250
YnVmZmVyX2JpdHM7Cj4gICAKPiAgIAlpZiAoZmJjLT5lbmFibGVkICYmIGZiYy0+YnVzeV9iaXRz
KQo+IC0JCWludGVsX2ZiY19kZWFjdGl2YXRlKGRldl9wcml2LCAiZnJvbnRidWZmZXIgd3JpdGUi
KTsKPiArCQlpbnRlbF9mYmNfZGVhY3RpdmF0ZShpOTE1LCAiZnJvbnRidWZmZXIgd3JpdGUiKTsK
PiAgIAo+ICAgCW11dGV4X3VubG9jaygmZmJjLT5sb2NrKTsKPiAgIH0KPiAgIAo+IC12b2lkIGlu
dGVsX2ZiY19mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3ZvaWQg
aW50ZWxfZmJjX2ZsdXNoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkgICAg
IHVuc2lnbmVkIGludCBmcm9udGJ1ZmZlcl9iaXRzLCBlbnVtIGZiX29wX29yaWdpbiBvcmlnaW4p
Cj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmZGV2X3ByaXYtPmZiYzsKPiArCXN0
cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZpOTE1LT5mYmM7Cj4gICAKPiAtCWlmICghZmJjX3N1cHBv
cnRlZChkZXZfcHJpdikpCj4gKwlpZiAoIWZiY19zdXBwb3J0ZWQoaTkxNSkpCj4gICAJCXJldHVy
bjsKPiAgIAo+ICAgCW11dGV4X2xvY2soJmZiYy0+bG9jayk7Cj4gQEAgLTk5OCw3ICs5OTgsNyBA
QCB2b2lkIGludGVsX2ZiY19mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gICAJaWYgKCFmYmMtPmJ1c3lfYml0cyAmJiBmYmMtPmVuYWJsZWQgJiYKPiAgIAkgICAgKGZy
b250YnVmZmVyX2JpdHMgJiBpbnRlbF9mYmNfZ2V0X2Zyb250YnVmZmVyX2JpdChmYmMpKSkgewo+
ICAgCQlpZiAoZmJjLT5hY3RpdmUpCj4gLQkJCWludGVsX2ZiY19yZWNvbXByZXNzKGRldl9wcml2
KTsKPiArCQkJaW50ZWxfZmJjX3JlY29tcHJlc3MoaTkxNSk7Cj4gICAJCWVsc2UgaWYgKCFmYmMt
PmZsaXBfcGVuZGluZykKPiAgIAkJCV9faW50ZWxfZmJjX3Bvc3RfdXBkYXRlKGZiYy0+Y3J0Yyk7
Cj4gICAJfQo+IEBAIC0xMDA5LDcgKzEwMDksNyBAQCB2b2lkIGludGVsX2ZiY19mbHVzaChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxf
ZmJjX2Nob29zZV9jcnRjIC0gc2VsZWN0IGEgQ1JUQyB0byBlbmFibGUgRkJDIG9uCj4gLSAqIEBk
ZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiArICogQGk5MTU6IGk5MTUgZGV2aWNlIGlu
c3RhbmNlCj4gICAgKiBAc3RhdGU6IHRoZSBhdG9taWMgc3RhdGUgc3RydWN0dXJlCj4gICAgKgo+
ICAgICogVGhpcyBmdW5jdGlvbiBsb29rcyBhdCB0aGUgcHJvcG9zZWQgc3RhdGUgZm9yIENSVENz
IGFuZCBwbGFuZXMsIHRoZW4gY2hvb3Nlcwo+IEBAIC0xMDE3LDEyICsxMDE3LDEyIEBAIHZvaWQg
aW50ZWxfZmJjX2ZsdXNoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgICAq
IHRydWUuCj4gICAgKgo+ICAgICogTGF0ZXIsIGludGVsX2ZiY19lbmFibGUgaXMgZ29pbmcgdG8g
bG9vayBmb3Igc3RhdGUtPmVuYWJsZV9mYmMgYW5kIHRoZW4gbWF5YmUKPiAtICogZW5hYmxlIEZC
QyBmb3IgdGhlIGNob3NlbiBDUlRDLiBJZiBpdCBkb2VzLCBpdCB3aWxsIHNldCBkZXZfcHJpdi0+
ZmJjLmNydGMuCj4gKyAqIGVuYWJsZSBGQkMgZm9yIHRoZSBjaG9zZW4gQ1JUQy4gSWYgaXQgZG9l
cywgaXQgd2lsbCBzZXQgaTkxNS0+ZmJjLmNydGMuCj4gICAgKi8KPiAtdm9pZCBpbnRlbF9mYmNf
Y2hvb3NlX2NydGMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICt2b2lkIGlu
dGVsX2ZiY19jaG9vc2VfY3J0YyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJ
CSAgIHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGlu
dGVsX2ZiYyAqZmJjID0gJmRldl9wcml2LT5mYmM7Cj4gKwlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMg
PSAmaTkxNS0+ZmJjOwo+ICAgCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmU7Cj4gICAJc3RydWN0
IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZTsKPiAgIAlib29sIGNydGNfY2hvc2VuID0g
ZmFsc2U7Cj4gQEAgLTEwMzUsNyArMTAzNSw3IEBAIHZvaWQgaW50ZWxfZmJjX2Nob29zZV9jcnRj
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkgICAgIWludGVsX2F0b21p
Y19nZXRfbmV3X2NydGNfc3RhdGUoc3RhdGUsIGZiYy0+Y3J0YykpCj4gICAJCWdvdG8gb3V0Owo+
ICAgCj4gLQlpZiAoIWludGVsX2ZiY19jYW5fZW5hYmxlKGRldl9wcml2KSkKPiArCWlmICghaW50
ZWxfZmJjX2Nhbl9lbmFibGUoaTkxNSkpCj4gICAJCWdvdG8gb3V0Owo+ICAgCj4gICAJLyogU2lt
cGx5IGNob29zZSB0aGUgZmlyc3QgQ1JUQyB0aGF0IGlzIGNvbXBhdGlibGUgYW5kIGhhcyBhIHZp
c2libGUKPiBAQCAtMTA4MSwxMCArMTA4MSwxMCBAQCB2b2lkIGludGVsX2ZiY19lbmFibGUoc3Ry
dWN0IGludGVsX2NydGMgKmNydGMsCj4gICAJCSAgICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlLAo+ICAgCQkgICAgICBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5l
X3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShjcnRjLT5iYXNlLmRldik7Cj4gLQlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmZGV2X3By
aXYtPmZiYzsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmaTkxNS0+ZmJjOwo+ICAg
Cj4gLQlpZiAoIWZiY19zdXBwb3J0ZWQoZGV2X3ByaXYpKQo+ICsJaWYgKCFmYmNfc3VwcG9ydGVk
KGk5MTUpKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAltdXRleF9sb2NrKCZmYmMtPmxvY2spOwo+
IEBAIC0xMTI3LDQ0ICsxMTI3LDQ0IEBAIHZvaWQgaW50ZWxfZmJjX2VuYWJsZShzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YywKPiAgICAqLwo+ICAgdm9pZCBpbnRlbF9mYmNfZGlzYWJsZShzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+IC0Jc3RydWN0IGludGVsX2ZiYyAqZmJj
ID0gJmRldl9wcml2LT5mYmM7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmk5MTUt
PmZiYzsKPiAgIAo+IC0JaWYgKCFmYmNfc3VwcG9ydGVkKGRldl9wcml2KSkKPiArCWlmICghZmJj
X3N1cHBvcnRlZChpOTE1KSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJbXV0ZXhfbG9jaygmZmJj
LT5sb2NrKTsKPiAgIAlpZiAoZmJjLT5jcnRjID09IGNydGMpCj4gLQkJX19pbnRlbF9mYmNfZGlz
YWJsZShkZXZfcHJpdik7Cj4gKwkJX19pbnRlbF9mYmNfZGlzYWJsZShpOTE1KTsKPiAgIAltdXRl
eF91bmxvY2soJmZiYy0+bG9jayk7Cj4gICB9Cj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxfZmJj
X2dsb2JhbF9kaXNhYmxlIC0gZ2xvYmFsbHkgZGlzYWJsZSBGQkMKPiAtICogQGRldl9wcml2OiBp
OTE1IGRldmljZSBpbnN0YW5jZQo+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiAg
ICAqCj4gICAgKiBUaGlzIGZ1bmN0aW9uIGRpc2FibGVzIEZCQyByZWdhcmRsZXNzIG9mIHdoaWNo
IENSVEMgaXMgYXNzb2NpYXRlZCB3aXRoIGl0Lgo+ICAgICovCj4gLXZvaWQgaW50ZWxfZmJjX2ds
b2JhbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBp
bnRlbF9mYmNfZ2xvYmFsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmZGV2X3ByaXYtPmZiYzsKPiArCXN0cnVj
dCBpbnRlbF9mYmMgKmZiYyA9ICZpOTE1LT5mYmM7Cj4gICAKPiAtCWlmICghZmJjX3N1cHBvcnRl
ZChkZXZfcHJpdikpCj4gKwlpZiAoIWZiY19zdXBwb3J0ZWQoaTkxNSkpCj4gICAJCXJldHVybjsK
PiAgIAo+ICAgCW11dGV4X2xvY2soJmZiYy0+bG9jayk7Cj4gICAJaWYgKGZiYy0+ZW5hYmxlZCkg
ewo+ICAgCQlXQVJOX09OKGZiYy0+Y3J0Yy0+YWN0aXZlKTsKPiAtCQlfX2ludGVsX2ZiY19kaXNh
YmxlKGRldl9wcml2KTsKPiArCQlfX2ludGVsX2ZiY19kaXNhYmxlKGk5MTUpOwo+ICAgCX0KPiAg
IAltdXRleF91bmxvY2soJmZiYy0+bG9jayk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIGlu
dGVsX2ZiY191bmRlcnJ1bl93b3JrX2ZuKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiAgIHsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9Cj4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9Cj4gICAJCWNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSwgZmJjLnVuZGVycnVuX3dvcmspOwo+IC0Jc3RydWN0IGludGVsX2ZiYyAqZmJj
ID0gJmRldl9wcml2LT5mYmM7Cj4gKwlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmaTkxNS0+ZmJj
Owo+ICAgCj4gICAJbXV0ZXhfbG9jaygmZmJjLT5sb2NrKTsKPiAgIAo+IEBAIC0xMTc1LDQyICsx
MTc1LDQyIEBAIHN0YXRpYyB2b2lkIGludGVsX2ZiY191bmRlcnJ1bl93b3JrX2ZuKHN0cnVjdCB3
b3JrX3N0cnVjdCAqd29yaykKPiAgIAlEUk1fREVCVUdfS01TKCJEaXNhYmxpbmcgRkJDIGR1ZSB0
byBGSUZPIHVuZGVycnVuLlxuIik7Cj4gICAJZmJjLT51bmRlcnJ1bl9kZXRlY3RlZCA9IHRydWU7
Cj4gICAKPiAtCWludGVsX2ZiY19kZWFjdGl2YXRlKGRldl9wcml2LCAiRklGTyB1bmRlcnJ1biIp
Owo+ICsJaW50ZWxfZmJjX2RlYWN0aXZhdGUoaTkxNSwgIkZJRk8gdW5kZXJydW4iKTsKPiAgIG91
dDoKPiAgIAltdXRleF91bmxvY2soJmZiYy0+bG9jayk7Cj4gICB9Cj4gICAKPiAgIC8qCj4gICAg
KiBpbnRlbF9mYmNfcmVzZXRfdW5kZXJydW4gLSByZXNldCBGQkMgZmlmbyB1bmRlcnJ1biBzdGF0
dXMuCj4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiArICogQGk5MTU6IGk5
MTUgZGV2aWNlIGluc3RhbmNlCj4gICAgKgo+ICAgICogU2VlIGludGVsX2ZiY19oYW5kbGVfZmlm
b191bmRlcnJ1bl9pcnEoKS4gRm9yIGF1dG9tYXRlZCB0ZXN0aW5nIHdlCj4gICAgKiB3YW50IHRv
IHJlLWVuYWJsZSBGQkMgYWZ0ZXIgYW4gdW5kZXJydW4gdG8gaW5jcmVhc2UgdGVzdCBjb3ZlcmFn
ZS4KPiAgICAqLwo+IC1pbnQgaW50ZWxfZmJjX3Jlc2V0X3VuZGVycnVuKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiAraW50IGludGVsX2ZiY19yZXNldF91bmRlcnJ1bihzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gLQlj
YW5jZWxfd29ya19zeW5jKCZkZXZfcHJpdi0+ZmJjLnVuZGVycnVuX3dvcmspOwo+ICsJY2FuY2Vs
X3dvcmtfc3luYygmaTkxNS0+ZmJjLnVuZGVycnVuX3dvcmspOwo+ICAgCj4gLQlyZXQgPSBtdXRl
eF9sb2NrX2ludGVycnVwdGlibGUoJmRldl9wcml2LT5mYmMubG9jayk7Cj4gKwlyZXQgPSBtdXRl
eF9sb2NrX2ludGVycnVwdGlibGUoJmk5MTUtPmZiYy5sb2NrKTsKPiAgIAlpZiAocmV0KQo+ICAg
CQlyZXR1cm4gcmV0Owo+ICAgCj4gLQlpZiAoZGV2X3ByaXYtPmZiYy51bmRlcnJ1bl9kZXRlY3Rl
ZCkgewo+ICsJaWYgKGk5MTUtPmZiYy51bmRlcnJ1bl9kZXRlY3RlZCkgewo+ICAgCQlEUk1fREVC
VUdfS01TKCJSZS1hbGxvd2luZyBGQkMgYWZ0ZXIgZmlmbyB1bmRlcnJ1blxuIik7Cj4gLQkJZGV2
X3ByaXYtPmZiYy5ub19mYmNfcmVhc29uID0gIkZJRk8gdW5kZXJydW4gY2xlYXJlZCI7Cj4gKwkJ
aTkxNS0+ZmJjLm5vX2ZiY19yZWFzb24gPSAiRklGTyB1bmRlcnJ1biBjbGVhcmVkIjsKPiAgIAl9
Cj4gICAKPiAtCWRldl9wcml2LT5mYmMudW5kZXJydW5fZGV0ZWN0ZWQgPSBmYWxzZTsKPiAtCW11
dGV4X3VubG9jaygmZGV2X3ByaXYtPmZiYy5sb2NrKTsKPiArCWk5MTUtPmZiYy51bmRlcnJ1bl9k
ZXRlY3RlZCA9IGZhbHNlOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5mYmMubG9jayk7Cj4gICAK
PiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+ICAgLyoqCj4gICAgKiBpbnRlbF9mYmNfaGFuZGxl
X2ZpZm9fdW5kZXJydW5faXJxIC0gZGlzYWJsZSBGQkMgd2hlbiB3ZSBnZXQgYSBGSUZPIHVuZGVy
cnVuCj4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiArICogQGk5MTU6IGk5
MTUgZGV2aWNlIGluc3RhbmNlCj4gICAgKgo+ICAgICogV2l0aG91dCBGQkMsIG1vc3QgdW5kZXJy
dW5zIGFyZSBoYXJtbGVzcyBhbmQgZG9uJ3QgcmVhbGx5IGNhdXNlIHRvbyBtYW55Cj4gICAgKiBw
cm9ibGVtcywgZXhjZXB0IGZvciBhbiBhbm5veWluZyBtZXNzYWdlIG9uIGRtZXNnLiBXaXRoIEZC
QywgdW5kZXJydW5zIGNhbgo+IEBAIC0xMjIyLDExICsxMjIyLDExIEBAIGludCBpbnRlbF9mYmNf
cmVzZXRfdW5kZXJydW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgICoK
PiAgICAqIFRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGZyb20gdGhlIElSUSBoYW5kbGVyLgo+ICAg
ICovCj4gLXZvaWQgaW50ZWxfZmJjX2hhbmRsZV9maWZvX3VuZGVycnVuX2lycShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgaW50ZWxfZmJjX2hhbmRsZV9maWZvX3Vu
ZGVycnVuX2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVj
dCBpbnRlbF9mYmMgKmZiYyA9ICZkZXZfcHJpdi0+ZmJjOwo+ICsJc3RydWN0IGludGVsX2ZiYyAq
ZmJjID0gJmk5MTUtPmZiYzsKPiAgIAo+IC0JaWYgKCFmYmNfc3VwcG9ydGVkKGRldl9wcml2KSkK
PiArCWlmICghZmJjX3N1cHBvcnRlZChpOTE1KSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJLyog
VGhlcmUncyBubyBndWFyYW50ZWUgdGhhdCB1bmRlcnJ1bl9kZXRlY3RlZCB3b24ndCBiZSBzZXQg
dG8gdHJ1ZQo+IEBAIC0xMjQzLDI0ICsxMjQzLDI0IEBAIHZvaWQgaW50ZWxfZmJjX2hhbmRsZV9m
aWZvX3VuZGVycnVuX2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAK
PiAgIC8qKgo+ICAgICogaW50ZWxfZmJjX2luaXRfcGlwZV9zdGF0ZSAtIGluaXRpYWxpemUgRkJD
J3MgQ1JUQyB2aXNpYmlsaXR5IHRyYWNraW5nCj4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2Ug
aW5zdGFuY2UKPiArICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gICAgKgo+ICAgICog
VGhlIEZCQyBjb2RlIG5lZWRzIHRvIHRyYWNrIENSVEMgdmlzaWJpbGl0eSBzaW5jZSB0aGUgb2xk
ZXIgcGxhdGZvcm1zIGNhbid0Cj4gICAgKiBoYXZlIEZCQyBlbmFibGVkIHdoaWxlIG11bHRpcGxl
IHBpcGVzIGFyZSB1c2VkLiBUaGlzIGZ1bmN0aW9uIGRvZXMgdGhlCj4gICAgKiBpbml0aWFsIHNl
dHVwIGF0IGRyaXZlciBsb2FkIHRvIG1ha2Ugc3VyZSBGQkMgaXMgbWF0Y2hpbmcgdGhlIHJlYWwg
aGFyZHdhcmUuCj4gICAgKi8KPiAtdm9pZCBpbnRlbF9mYmNfaW5pdF9waXBlX3N0YXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBpbnRlbF9mYmNfaW5pdF9waXBl
X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXN0cnVjdCBp
bnRlbF9jcnRjICpjcnRjOwo+ICAgCj4gICAJLyogRG9uJ3QgZXZlbiBib3RoZXIgdHJhY2tpbmcg
YW55dGhpbmcgaWYgd2UgZG9uJ3QgbmVlZC4gKi8KPiAtCWlmICghbm9fZmJjX29uX211bHRpcGxl
X3BpcGVzKGRldl9wcml2KSkKPiArCWlmICghbm9fZmJjX29uX211bHRpcGxlX3BpcGVzKGk5MTUp
KQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCWZvcl9lYWNoX2ludGVsX2NydGMoJmRldl9wcml2LT5k
cm0sIGNydGMpCj4gKwlmb3JfZWFjaF9pbnRlbF9jcnRjKCZpOTE1LT5kcm0sIGNydGMpCj4gICAJ
CWlmIChpbnRlbF9jcnRjX2FjdGl2ZShjcnRjKSAmJgo+ICAgCQkgICAgY3J0Yy0+YmFzZS5wcmlt
YXJ5LT5zdGF0ZS0+dmlzaWJsZSkKPiAtCQkJZGV2X3ByaXYtPmZiYy52aXNpYmxlX3BpcGVzX21h
c2sgfD0gKDEgPDwgY3J0Yy0+cGlwZSk7Cj4gKwkJCWk5MTUtPmZiYy52aXNpYmxlX3BpcGVzX21h
c2sgfD0gKDEgPDwgY3J0Yy0+cGlwZSk7Cj4gICB9Cj4gICAKPiAgIC8qCj4gQEAgLTEyNzIsMjkg
KzEyNzIsMjkgQEAgdm9pZCBpbnRlbF9mYmNfaW5pdF9waXBlX3N0YXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiAgICAqIHNwYWNlIHRvIGNoYW5nZSB0aGUgdmFsdWUgZHVy
aW5nIHJ1bnRpbWUgd2l0aG91dCBzYW5pdGl6aW5nIGl0IGFnYWluLiBJR1QKPiAgICAqIHJlbGll
cyBvbiBiZWluZyBhYmxlIHRvIGNoYW5nZSBpOTE1LmVuYWJsZV9mYmMgYXQgcnVudGltZS4KPiAg
ICAqLwo+IC1zdGF0aWMgaW50IGludGVsX3Nhbml0aXplX2ZiY19vcHRpb24oc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgaW50IGludGVsX3Nhbml0aXplX2ZiY19v
cHRpb24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJaWYgKGk5MTVf
bW9kcGFyYW1zLmVuYWJsZV9mYmMgPj0gMCkKPiAgIAkJcmV0dXJuICEhaTkxNV9tb2RwYXJhbXMu
ZW5hYmxlX2ZiYzsKPiAgIAo+IC0JaWYgKCFIQVNfRkJDKGRldl9wcml2KSkKPiArCWlmICghSEFT
X0ZCQyhpOTE1KSkKPiAgIAkJcmV0dXJuIDA7Cj4gICAKPiAgIAkvKiBodHRwczovL2J1Z3MuZnJl
ZWRlc2t0b3Aub3JnL3Nob3dfYnVnLmNnaT9pZD0xMDgwODUgKi8KPiAtCWlmIChJU19HRU1JTklM
QUtFKGRldl9wcml2KSkKPiArCWlmIChJU19HRU1JTklMQUtFKGk5MTUpKQo+ICAgCQlyZXR1cm4g
MDsKPiAgIAo+IC0JaWYgKElTX0JST0FEV0VMTChkZXZfcHJpdikgfHwgSU5URUxfR0VOKGRldl9w
cml2KSA+PSA5KQo+ICsJaWYgKElTX0JST0FEV0VMTChpOTE1KSB8fCBJTlRFTF9HRU4oaTkxNSkg
Pj0gOSkKPiAgIAkJcmV0dXJuIDE7Cj4gICAKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+IC1z
dGF0aWMgYm9vbCBuZWVkX2ZiY192dGRfd2Eoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICtzdGF0aWMgYm9vbCBuZWVkX2ZiY192dGRfd2Eoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCj4gICB7Cj4gICAJLyogV2FGYmNUdXJuT2ZmRmJjV2hlbkh5cGVyVmlzb3JJc1Vz
ZWQ6c2tsLGJ4dCAqLwo+ICAgCWlmIChpbnRlbF92dGRfYWN0aXZlKCkgJiYKPiAtCSAgICAoSVNf
U0tZTEFLRShkZXZfcHJpdikgfHwgSVNfQlJPWFRPTihkZXZfcHJpdikpKSB7Cj4gKwkgICAgKElT
X1NLWUxBS0UoaTkxNSkgfHwgSVNfQlJPWFRPTihpOTE1KSkpIHsKPiAgIAkJRFJNX0lORk8oIkRp
c2FibGluZyBmcmFtZWJ1ZmZlciBjb21wcmVzc2lvbiAoRkJDKSB0byBwcmV2ZW50IHNjcmVlbiBm
bGlja2VyIHdpdGggVlQtZCBlbmFibGVkXG4iKTsKPiAgIAkJcmV0dXJuIHRydWU7Cj4gICAJfQo+
IEBAIC0xMzA0LDM4ICsxMzA0LDM4IEBAIHN0YXRpYyBib29sIG5lZWRfZmJjX3Z0ZF93YShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxf
ZmJjX2luaXQgLSBJbml0aWFsaXplIEZCQwo+IC0gKiBAZGV2X3ByaXY6IHRoZSBpOTE1IGRldmlj
ZQo+ICsgKiBAaTkxNTogdGhlIGk5MTUgZGV2aWNlCj4gICAgKgo+ICAgICogVGhpcyBmdW5jdGlv
biBtaWdodCBiZSBjYWxsZWQgZHVyaW5nIFBNIGluaXQgcHJvY2Vzcy4KPiAgICAqLwo+IC12b2lk
IGludGVsX2ZiY19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9p
ZCBpbnRlbF9mYmNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAt
CXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZkZXZfcHJpdi0+ZmJjOwo+ICsJc3RydWN0IGludGVs
X2ZiYyAqZmJjID0gJmk5MTUtPmZiYzsKPiAgIAo+ICAgCUlOSVRfV09SSygmZmJjLT51bmRlcnJ1
bl93b3JrLCBpbnRlbF9mYmNfdW5kZXJydW5fd29ya19mbik7Cj4gICAJbXV0ZXhfaW5pdCgmZmJj
LT5sb2NrKTsKPiAgIAlmYmMtPmVuYWJsZWQgPSBmYWxzZTsKPiAgIAlmYmMtPmFjdGl2ZSA9IGZh
bHNlOwo+ICAgCj4gLQlpZiAobmVlZF9mYmNfdnRkX3dhKGRldl9wcml2KSkKPiAtCQlta3dyaXRl
X2RldmljZV9pbmZvKGRldl9wcml2KS0+ZGlzcGxheS5oYXNfZmJjID0gZmFsc2U7Cj4gKwlpZiAo
bmVlZF9mYmNfdnRkX3dhKGk5MTUpKQo+ICsJCW1rd3JpdGVfZGV2aWNlX2luZm8oaTkxNSktPmRp
c3BsYXkuaGFzX2ZiYyA9IGZhbHNlOwo+ICAgCj4gLQlpOTE1X21vZHBhcmFtcy5lbmFibGVfZmJj
ID0gaW50ZWxfc2FuaXRpemVfZmJjX29wdGlvbihkZXZfcHJpdik7Cj4gKwlpOTE1X21vZHBhcmFt
cy5lbmFibGVfZmJjID0gaW50ZWxfc2FuaXRpemVfZmJjX29wdGlvbihpOTE1KTsKPiAgIAlEUk1f
REVCVUdfS01TKCJTYW5pdGl6ZWQgZW5hYmxlX2ZiYyB2YWx1ZTogJWRcbiIsCj4gICAJCSAgICAg
IGk5MTVfbW9kcGFyYW1zLmVuYWJsZV9mYmMpOwo+ICAgCj4gLQlpZiAoIUhBU19GQkMoZGV2X3By
aXYpKSB7Cj4gKwlpZiAoIUhBU19GQkMoaTkxNSkpIHsKPiAgIAkJZmJjLT5ub19mYmNfcmVhc29u
ID0gInVuc3VwcG9ydGVkIGJ5IHRoaXMgY2hpcHNldCI7Cj4gICAJCXJldHVybjsKPiAgIAl9Cj4g
ICAKPiAgIAkvKiBUaGlzIHZhbHVlIHdhcyBwdWxsZWQgb3V0IG9mIHNvbWVvbmUncyBoYXQgKi8K
PiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDQgJiYgIUlTX0dNNDUoZGV2X3ByaXYpKQo+
ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8PSA0ICYmICFJU19HTTQ1KGk5MTUpKQo+ICAgCQlJOTE1
X1dSSVRFKEZCQ19DT05UUk9MLCA1MDAgPDwgRkJDX0NUTF9JTlRFUlZBTF9TSElGVCk7Cj4gICAK
PiAgIAkvKiBXZSBzdGlsbCBkb24ndCBoYXZlIGFueSBzb3J0IG9mIGhhcmR3YXJlIHN0YXRlIHJl
YWRvdXQgZm9yIEZCQywgc28KPiAgIAkgKiBkZWFjdGl2YXRlIGl0IGluIGNhc2UgdGhlIEJJT1Mg
YWN0aXZhdGVkIGl0IHRvIG1ha2Ugc3VyZSBzb2Z0d2FyZQo+ICAgCSAqIG1hdGNoZXMgdGhlIGhh
cmR3YXJlIHN0YXRlLiAqLwo+IC0JaWYgKGludGVsX2ZiY19od19pc19hY3RpdmUoZGV2X3ByaXYp
KQo+IC0JCWludGVsX2ZiY19od19kZWFjdGl2YXRlKGRldl9wcml2KTsKPiArCWlmIChpbnRlbF9m
YmNfaHdfaXNfYWN0aXZlKGk5MTUpKQo+ICsJCWludGVsX2ZiY19od19kZWFjdGl2YXRlKGk5MTUp
Owo+ICAgfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9mYmMuaCBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2ZiYy5oCj4gaW5kZXggNTAyNzJlZGE4ZDQzLi5i
N2RjNmNiNDM0OTcgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZmJj
LmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9mYmMuaAo+IEBAIC0xNiwyNyAr
MTYsMjcgQEAgc3RydWN0IGludGVsX2NydGM7Cj4gICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZTsK
PiAgIHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZTsKPiAgIAo+IC12b2lkIGludGVsX2ZiY19jaG9v
c2VfY3J0YyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3ZvaWQgaW50ZWxf
ZmJjX2Nob29zZV9jcnRjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAg
c3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpOwo+IC1ib29sIGludGVsX2ZiY19pc19h
Y3RpdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiArYm9vbCBpbnRlbF9m
YmNfaXNfYWN0aXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAgIHZvaWQgaW50
ZWxfZmJjX3ByZV91cGRhdGUoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gICAJCQkgIHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCQkJICBzdHJ1Y3QgaW50ZWxfcGxh
bmVfc3RhdGUgKnBsYW5lX3N0YXRlKTsKPiAgIHZvaWQgaW50ZWxfZmJjX3Bvc3RfdXBkYXRlKHN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjKTsKPiAtdm9pZCBpbnRlbF9mYmNfaW5pdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGludGVsX2ZiY19pbml0X3BpcGVfc3Rh
dGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiArdm9pZCBpbnRlbF9mYmNf
aW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgaW50ZWxfZmJjX2lu
aXRfcGlwZV9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICB2b2lkIGlu
dGVsX2ZiY19lbmFibGUoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gICAJCSAgICAgIHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCQkgICAgICBzdHJ1Y3QgaW50ZWxf
cGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKTsKPiAgIHZvaWQgaW50ZWxfZmJjX2Rpc2FibGUoc3Ry
dWN0IGludGVsX2NydGMgKmNydGMpOwo+IC12b2lkIGludGVsX2ZiY19nbG9iYWxfZGlzYWJsZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGludGVsX2ZiY19pbnZh
bGlkYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArdm9pZCBpbnRlbF9m
YmNfZ2xvYmFsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lk
IGludGVsX2ZiY19pbnZhbGlkYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAg
CQkJICB1bnNpZ25lZCBpbnQgZnJvbnRidWZmZXJfYml0cywKPiAgIAkJCSAgZW51bSBmYl9vcF9v
cmlnaW4gb3JpZ2luKTsKPiAtdm9pZCBpbnRlbF9mYmNfZmx1c2goc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ICt2b2lkIGludGVsX2ZiY19mbHVzaChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKPiAgIAkJICAgICB1bnNpZ25lZCBpbnQgZnJvbnRidWZmZXJfYml0cywg
ZW51bSBmYl9vcF9vcmlnaW4gb3JpZ2luKTsKPiAtdm9pZCBpbnRlbF9mYmNfY2xlYW51cF9jZmIo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtdm9pZCBpbnRlbF9mYmNfaGFu
ZGxlX2ZpZm9fdW5kZXJydW5faXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7
Cj4gLWludCBpbnRlbF9mYmNfcmVzZXRfdW5kZXJydW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KTsKPiArdm9pZCBpbnRlbF9mYmNfY2xlYW51cF9jZmIoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lkIGludGVsX2ZiY19oYW5kbGVfZmlmb191bmRlcnJ1bl9p
cnEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICtpbnQgaW50ZWxfZmJjX3Jlc2V0
X3VuZGVycnVuKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAgIAo+ICAgI2VuZGlm
IC8qIF9fSU5URUxfRkJDX0hfXyAqLwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9mYmRldi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZmJkZXYuYwo+IGlu
ZGV4IDBkM2E2ZmE2NzRlNi4uOTNkZWU5ZmY1YTU4IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX2ZiZGV2LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9mYmRldi5jCj4gQEAgLTExNyw3ICsxMTcsNyBAQCBzdGF0aWMgaW50IGludGVsZmJfYWxsb2Mo
c3RydWN0IGRybV9mYl9oZWxwZXIgKmhlbHBlciwKPiAgIAkJY29udGFpbmVyX29mKGhlbHBlciwg
c3RydWN0IGludGVsX2ZiZGV2LCBoZWxwZXIpOwo+ICAgCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIg
KmZiOwo+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBoZWxwZXItPmRldjsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXN0cnVjdCBkcm1fbW9k
ZV9mYl9jbWQyIG1vZGVfY21kID0ge307Cj4gICAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iajsKPiAgIAlpbnQgc2l6ZSwgcmV0Owo+IEBAIC0xNDEsMTAgKzE0MSwxMCBAQCBzdGF0aWMg
aW50IGludGVsZmJfYWxsb2Moc3RydWN0IGRybV9mYl9oZWxwZXIgKmhlbHBlciwKPiAgIAkgKiBp
bXBvcnRhbnQgYW5kIHdlIHNob3VsZCBwcm9iYWJseSB1c2UgdGhhdCBzcGFjZSB3aXRoIEZCQyBv
ciBvdGhlcgo+ICAgCSAqIGZlYXR1cmVzLiAqLwo+ICAgCW9iaiA9IE5VTEw7Cj4gLQlpZiAoc2l6
ZSAqIDIgPCBkZXZfcHJpdi0+c3RvbGVuX3VzYWJsZV9zaXplKQo+IC0JCW9iaiA9IGk5MTVfZ2Vt
X29iamVjdF9jcmVhdGVfc3RvbGVuKGRldl9wcml2LCBzaXplKTsKPiArCWlmIChzaXplICogMiA8
IGk5MTUtPnN0b2xlbl91c2FibGVfc2l6ZSkKPiArCQlvYmogPSBpOTE1X2dlbV9vYmplY3RfY3Jl
YXRlX3N0b2xlbihpOTE1LCBzaXplKTsKPiAgIAlpZiAob2JqID09IE5VTEwpCj4gLQkJb2JqID0g
aTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zaG1lbShkZXZfcHJpdiwgc2l6ZSk7Cj4gKwkJb2JqID0g
aTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zaG1lbShpOTE1LCBzaXplKTsKPiAgIAlpZiAoSVNfRVJS
KG9iaikpIHsKPiAgIAkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gYWxsb2NhdGUgZnJhbWVidWZmZXJc
biIpOwo+ICAgCQlyZXQgPSBQVFJfRVJSKG9iaik7Cj4gQEAgLTE3NCw5ICsxNzQsOSBAQCBzdGF0
aWMgaW50IGludGVsZmJfY3JlYXRlKHN0cnVjdCBkcm1fZmJfaGVscGVyICpoZWxwZXIsCj4gICAJ
CWNvbnRhaW5lcl9vZihoZWxwZXIsIHN0cnVjdCBpbnRlbF9mYmRldiwgaGVscGVyKTsKPiAgIAlz
dHJ1Y3QgaW50ZWxfZnJhbWVidWZmZXIgKmludGVsX2ZiID0gaWZiZGV2LT5mYjsKPiAgIAlzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2ID0gaGVscGVyLT5kZXY7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gLQlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9
IGRldl9wcml2LT5kcm0ucGRldjsKPiAtCXN0cnVjdCBpOTE1X2dndHQgKmdndHQgPSAmZGV2X3By
aXYtPmdndHQ7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2
KTsKPiArCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gaTkxNS0+ZHJtLnBkZXY7Cj4gKwlzdHJ1Y3Qg
aTkxNV9nZ3R0ICpnZ3R0ID0gJmk5MTUtPmdndHQ7Cj4gICAJY29uc3Qgc3RydWN0IGk5MTVfZ2d0
dF92aWV3IHZpZXcgPSB7Cj4gICAJCS50eXBlID0gSTkxNV9HR1RUX1ZJRVdfTk9STUFMLAo+ICAg
CX07Cj4gQEAgLTIxMyw3ICsyMTMsNyBAQCBzdGF0aWMgaW50IGludGVsZmJfY3JlYXRlKHN0cnVj
dCBkcm1fZmJfaGVscGVyICpoZWxwZXIsCj4gICAJfQo+ICAgCj4gICAJbXV0ZXhfbG9jaygmZGV2
LT5zdHJ1Y3RfbXV0ZXgpOwo+IC0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9w
cml2KTsKPiArCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKPiAgIAo+ICAg
CS8qIFBpbiB0aGUgR0dUVCB2bWEgZm9yIG91ciBhY2Nlc3MgdmlhIGluZm8tPnNjcmVlbl9iYXNl
Lgo+ICAgCSAqIFRoaXMgYWxzbyB2YWxpZGF0ZXMgdGhhdCBhbnkgZXhpc3RpbmcgZmIgaW5oZXJp
dGVkIGZyb20gdGhlCj4gQEAgLTI3Miw3ICsyNzIsNyBAQCBzdGF0aWMgaW50IGludGVsZmJfY3Jl
YXRlKHN0cnVjdCBkcm1fZmJfaGVscGVyICpoZWxwZXIsCj4gICAJaWZiZGV2LT52bWEgPSB2bWE7
Cj4gICAJaWZiZGV2LT52bWFfZmxhZ3MgPSBmbGFnczsKPiAgIAo+IC0JaW50ZWxfcnVudGltZV9w
bV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOwo+ICsJaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwg
d2FrZXJlZik7Cj4gICAJbXV0ZXhfdW5sb2NrKCZkZXYtPnN0cnVjdF9tdXRleCk7Cj4gICAJdmdh
X3N3aXRjaGVyb29fY2xpZW50X2ZiX3NldChwZGV2LCBpbmZvKTsKPiAgIAlyZXR1cm4gMDsKPiBA
QCAtMjgwLDcgKzI4MCw3IEBAIHN0YXRpYyBpbnQgaW50ZWxmYl9jcmVhdGUoc3RydWN0IGRybV9m
Yl9oZWxwZXIgKmhlbHBlciwKPiAgIG91dF91bnBpbjoKPiAgIAlpbnRlbF91bnBpbl9mYl92bWEo
dm1hLCBmbGFncyk7Cj4gICBvdXRfdW5sb2NrOgo+IC0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2
X3ByaXYsIHdha2VyZWYpOwo+ICsJaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7
Cj4gICAJbXV0ZXhfdW5sb2NrKCZkZXYtPnN0cnVjdF9tdXRleCk7Cj4gICAJcmV0dXJuIHJldDsK
PiAgIH0KPiBAQCAtNDQ3LDExICs0NDcsMTEgQEAgc3RhdGljIHZvaWQgaW50ZWxfZmJkZXZfc3Vz
cGVuZF93b3JrZXIoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAgCj4gICBpbnQgaW50ZWxf
ZmJkZXZfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAgewo+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJc3RydWN0IGludGVsX2ZiZGV2ICpp
ZmJkZXY7Cj4gICAJaW50IHJldDsKPiAgIAo+IC0JaWYgKFdBUk5fT04oIUhBU19ESVNQTEFZKGRl
dl9wcml2KSkpCj4gKwlpZiAoV0FSTl9PTighSEFTX0RJU1BMQVkoaTkxNSkpKQo+ICAgCQlyZXR1
cm4gLUVOT0RFVjsKPiAgIAo+ICAgCWlmYmRldiA9IGt6YWxsb2Moc2l6ZW9mKHN0cnVjdCBpbnRl
bF9mYmRldiksIEdGUF9LRVJORUwpOwo+IEBAIC00NzAsOCArNDcwLDggQEAgaW50IGludGVsX2Zi
ZGV2X2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIAkJcmV0dXJuIHJldDsKPiAgIAl9
Cj4gICAKPiAtCWRldl9wcml2LT5mYmRldiA9IGlmYmRldjsKPiAtCUlOSVRfV09SSygmZGV2X3By
aXYtPmZiZGV2X3N1c3BlbmRfd29yaywgaW50ZWxfZmJkZXZfc3VzcGVuZF93b3JrZXIpOwo+ICsJ
aTkxNS0+ZmJkZXYgPSBpZmJkZXY7Cj4gKwlJTklUX1dPUksoJmk5MTUtPmZiZGV2X3N1c3BlbmRf
d29yaywgaW50ZWxfZmJkZXZfc3VzcGVuZF93b3JrZXIpOwo+ICAgCj4gICAJZHJtX2ZiX2hlbHBl
cl9zaW5nbGVfYWRkX2FsbF9jb25uZWN0b3JzKCZpZmJkZXYtPmhlbHBlcik7Cj4gICAKPiBAQCAt
NTA4LDIzICs1MDgsMjMgQEAgc3RhdGljIHZvaWQgaW50ZWxfZmJkZXZfc3luYyhzdHJ1Y3QgaW50
ZWxfZmJkZXYgKmlmYmRldikKPiAgIAlpZmJkZXYtPmNvb2tpZSA9IDA7Cj4gICB9Cj4gICAKPiAt
dm9pZCBpbnRlbF9mYmRldl91bnJlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiArdm9pZCBpbnRlbF9mYmRldl91bnJlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ICAgewo+IC0Jc3RydWN0IGludGVsX2ZiZGV2ICppZmJkZXYgPSBkZXZfcHJp
di0+ZmJkZXY7Cj4gKwlzdHJ1Y3QgaW50ZWxfZmJkZXYgKmlmYmRldiA9IGk5MTUtPmZiZGV2Owo+
ICAgCj4gICAJaWYgKCFpZmJkZXYpCj4gICAJCXJldHVybjsKPiAgIAo+IC0JY2FuY2VsX3dvcmtf
c3luYygmZGV2X3ByaXYtPmZiZGV2X3N1c3BlbmRfd29yayk7Cj4gKwljYW5jZWxfd29ya19zeW5j
KCZpOTE1LT5mYmRldl9zdXNwZW5kX3dvcmspOwo+ICAgCWlmICghY3VycmVudF9pc19hc3luYygp
KQo+ICAgCQlpbnRlbF9mYmRldl9zeW5jKGlmYmRldik7Cj4gICAKPiAgIAlkcm1fZmJfaGVscGVy
X3VucmVnaXN0ZXJfZmJpKCZpZmJkZXYtPmhlbHBlcik7Cj4gICB9Cj4gICAKPiAtdm9pZCBpbnRl
bF9mYmRldl9maW5pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBp
bnRlbF9mYmRldl9maW5pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0J
c3RydWN0IGludGVsX2ZiZGV2ICppZmJkZXYgPSBmZXRjaF9hbmRfemVybygmZGV2X3ByaXYtPmZi
ZGV2KTsKPiArCXN0cnVjdCBpbnRlbF9mYmRldiAqaWZiZGV2ID0gZmV0Y2hfYW5kX3plcm8oJmk5
MTUtPmZiZGV2KTsKPiAgIAo+ICAgCWlmICghaWZiZGV2KQo+ICAgCQlyZXR1cm47Cj4gQEAgLTU1
NCw4ICs1NTQsOCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9mYmRldl9ocGRfc2V0X3N1c3BlbmQoc3Ry
dWN0IGludGVsX2ZiZGV2ICppZmJkZXYsIGludCBzdGF0ZSkKPiAgIAo+ICAgdm9pZCBpbnRlbF9m
YmRldl9zZXRfc3VzcGVuZChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBpbnQgc3RhdGUsIGJvb2wg
c3luY2hyb25vdXMpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGRldik7Cj4gLQlzdHJ1Y3QgaW50ZWxfZmJkZXYgKmlmYmRldiA9IGRldl9wcml2
LT5mYmRldjsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYp
Owo+ICsJc3RydWN0IGludGVsX2ZiZGV2ICppZmJkZXYgPSBpOTE1LT5mYmRldjsKPiAgIAlzdHJ1
Y3QgZmJfaW5mbyAqaW5mbzsKPiAgIAo+ICAgCWlmICghaWZiZGV2IHx8ICFpZmJkZXYtPnZtYSkK
PiBAQCAtNTcyLDcgKzU3Miw3IEBAIHZvaWQgaW50ZWxfZmJkZXZfc2V0X3N1c3BlbmQoc3RydWN0
IGRybV9kZXZpY2UgKmRldiwgaW50IHN0YXRlLCBib29sIHN5bmNocm9ub3VzCj4gICAJCSAqIG91
cnNlbHZlcywgc28gb25seSBmbHVzaCBvdXRzdGFuZGluZyB3b3JrIHVwb24gc3VzcGVuZCEKPiAg
IAkJICovCj4gICAJCWlmIChzdGF0ZSAhPSBGQklORk9fU1RBVEVfUlVOTklORykKPiAtCQkJZmx1
c2hfd29yaygmZGV2X3ByaXYtPmZiZGV2X3N1c3BlbmRfd29yayk7Cj4gKwkJCWZsdXNoX3dvcmso
Jmk5MTUtPmZiZGV2X3N1c3BlbmRfd29yayk7Cj4gICAKPiAgIAkJY29uc29sZV9sb2NrKCk7Cj4g
ICAJfSBlbHNlIHsKPiBAQCAtNTg2LDcgKzU4Niw3IEBAIHZvaWQgaW50ZWxfZmJkZXZfc2V0X3N1
c3BlbmQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgaW50IHN0YXRlLCBib29sIHN5bmNocm9ub3Vz
Cj4gICAJCQkvKiBEb24ndCBibG9jayBvdXIgb3duIHdvcmtxdWV1ZSBhcyB0aGlzIGNhbgo+ICAg
CQkJICogYmUgcnVuIGluIHBhcmFsbGVsIHdpdGggb3RoZXIgaTkxNS5rbyB0YXNrcy4KPiAgIAkJ
CSAqLwo+IC0JCQlzY2hlZHVsZV93b3JrKCZkZXZfcHJpdi0+ZmJkZXZfc3VzcGVuZF93b3JrKTsK
PiArCQkJc2NoZWR1bGVfd29yaygmaTkxNS0+ZmJkZXZfc3VzcGVuZF93b3JrKTsKPiAgIAkJCXJl
dHVybjsKPiAgIAkJfQo+ICAgCX0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfZmJkZXYuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2ZiZGV2LmgKPiBpbmRl
eCBkZTdjODQyNTBlYjUuLjRkMGM4Yzg1MWE1ZSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9mYmRldi5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
ZmJkZXYuaAo+IEBAIC0xNCw4ICsxNCw4IEBAIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlOwo+ICAg
I2lmZGVmIENPTkZJR19EUk1fRkJERVZfRU1VTEFUSU9OCj4gICBpbnQgaW50ZWxfZmJkZXZfaW5p
dChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KTsKPiAgIHZvaWQgaW50ZWxfZmJkZXZfaW5pdGlhbF9j
b25maWdfYXN5bmMoc3RydWN0IGRybV9kZXZpY2UgKmRldik7Cj4gLXZvaWQgaW50ZWxfZmJkZXZf
dW5yZWdpc3RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGlu
dGVsX2ZiZGV2X2Zpbmkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiArdm9p
ZCBpbnRlbF9mYmRldl91bnJlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsK
PiArdm9pZCBpbnRlbF9mYmRldl9maW5pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsK
PiAgIHZvaWQgaW50ZWxfZmJkZXZfc2V0X3N1c3BlbmQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwg
aW50IHN0YXRlLCBib29sIHN5bmNocm9ub3VzKTsKPiAgIHZvaWQgaW50ZWxfZmJkZXZfb3V0cHV0
X3BvbGxfY2hhbmdlZChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KTsKPiAgIHZvaWQgaW50ZWxfZmJk
ZXZfcmVzdG9yZV9tb2RlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpOwo+IEBAIC0yOSwxMSArMjks
MTEgQEAgc3RhdGljIGlubGluZSB2b2lkIGludGVsX2ZiZGV2X2luaXRpYWxfY29uZmlnX2FzeW5j
KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gICB7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGlubGlu
ZSB2b2lkIGludGVsX2ZiZGV2X3VucmVnaXN0ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ICtzdGF0aWMgaW5saW5lIHZvaWQgaW50ZWxfZmJkZXZfdW5yZWdpc3RlcihzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgaW5s
aW5lIHZvaWQgaW50ZWxfZmJkZXZfZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gK3N0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9mYmRldl9maW5pKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgfQo+ICAgCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX2ZpZm9fdW5kZXJydW4uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2ZpZm9fdW5kZXJydW4uYwo+IGluZGV4IDg1NDVhZDMyYmI1MC4uMDhmMDkyYWRkYWUy
IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2ZpZm9fdW5kZXJydW4u
Ywo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2ZpZm9fdW5kZXJydW4uYwo+IEBA
IC01MiwxNCArNTIsMTQgQEAKPiAgIAo+ICAgc3RhdGljIGJvb2wgaXZiX2Nhbl9lbmFibGVfZXJy
X2ludChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4g
ICAJZW51bSBwaXBlIHBpcGU7Cj4gICAKPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2
LT5pcnFfbG9jayk7Cj4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5pcnFfbG9jayk7Cj4g
ICAKPiAtCWZvcl9lYWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpIHsKPiAtCQljcnRjID0gaW50ZWxf
Z2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIHBpcGUpOwo+ICsJZm9yX2VhY2hfcGlwZShpOTE1
LCBwaXBlKSB7Cj4gKwkJY3J0YyA9IGludGVsX2dldF9jcnRjX2Zvcl9waXBlKGk5MTUsIHBpcGUp
Owo+ICAgCj4gICAJCWlmIChjcnRjLT5jcHVfZmlmb191bmRlcnJ1bl9kaXNhYmxlZCkKPiAgIAkJ
CXJldHVybiBmYWxzZTsKPiBAQCAtNzAsMTQgKzcwLDE0IEBAIHN0YXRpYyBib29sIGl2Yl9jYW5f
ZW5hYmxlX2Vycl9pbnQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIAo+ICAgc3RhdGljIGJv
b2wgY3B0X2Nhbl9lbmFibGVfc2Vycl9pbnQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgIHsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCWVudW0g
cGlwZSBwaXBlOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOwo+ICAgCj4gLQlsb2NrZGVw
X2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ICsJbG9ja2RlcF9hc3NlcnRfaGVs
ZCgmaTkxNS0+aXJxX2xvY2spOwo+ICAgCj4gLQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBl
KSB7Cj4gLQkJY3J0YyA9IGludGVsX2dldF9jcnRjX2Zvcl9waXBlKGRldl9wcml2LCBwaXBlKTsK
PiArCWZvcl9lYWNoX3BpcGUoaTkxNSwgcGlwZSkgewo+ICsJCWNydGMgPSBpbnRlbF9nZXRfY3J0
Y19mb3JfcGlwZShpOTE1LCBwaXBlKTsKPiAgIAo+ICAgCQlpZiAoY3J0Yy0+cGNoX2ZpZm9fdW5k
ZXJydW5fZGlzYWJsZWQpCj4gICAJCQlyZXR1cm4gZmFsc2U7Cj4gQEAgLTg4LDIwICs4OCwyMCBA
QCBzdGF0aWMgYm9vbCBjcHRfY2FuX2VuYWJsZV9zZXJyX2ludChzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2KQo+ICAgCj4gICBzdGF0aWMgdm9pZCBpOXh4X2NoZWNrX2ZpZm9fdW5kZXJydW5zKHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAgCWk5MTVfcmVnX3QgcmVn
ID0gUElQRVNUQVQoY3J0Yy0+cGlwZSk7Cj4gICAJdTMyIGVuYWJsZV9tYXNrOwo+ICAgCj4gLQls
b2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ICsJbG9ja2RlcF9hc3Nl
cnRfaGVsZCgmaTkxNS0+aXJxX2xvY2spOwo+ICAgCj4gICAJaWYgKChJOTE1X1JFQUQocmVnKSAm
IFBJUEVfRklGT19VTkRFUlJVTl9TVEFUVVMpID09IDApCj4gICAJCXJldHVybjsKPiAgIAo+IC0J
ZW5hYmxlX21hc2sgPSBpOTE1X3BpcGVzdGF0X2VuYWJsZV9tYXNrKGRldl9wcml2LCBjcnRjLT5w
aXBlKTsKPiArCWVuYWJsZV9tYXNrID0gaTkxNV9waXBlc3RhdF9lbmFibGVfbWFzayhpOTE1LCBj
cnRjLT5waXBlKTsKPiAgIAlJOTE1X1dSSVRFKHJlZywgZW5hYmxlX21hc2sgfCBQSVBFX0ZJRk9f
VU5ERVJSVU5fU1RBVFVTKTsKPiAgIAlQT1NUSU5HX1JFQUQocmVnKTsKPiAgIAo+IC0JdHJhY2Vf
aW50ZWxfY3B1X2ZpZm9fdW5kZXJydW4oZGV2X3ByaXYsIGNydGMtPnBpcGUpOwo+ICsJdHJhY2Vf
aW50ZWxfY3B1X2ZpZm9fdW5kZXJydW4oaTkxNSwgY3J0Yy0+cGlwZSk7Cj4gICAJRFJNX0VSUk9S
KCJwaXBlICVjIHVuZGVycnVuXG4iLCBwaXBlX25hbWUoY3J0Yy0+cGlwZSkpOwo+ICAgfQo+ICAg
Cj4gQEAgLTEwOSwxMyArMTA5LDEzIEBAIHN0YXRpYyB2b2lkIGk5eHhfc2V0X2ZpZm9fdW5kZXJy
dW5fcmVwb3J0aW5nKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gICAJCQkJCSAgICAgZW51bSBw
aXBlIHBpcGUsCj4gICAJCQkJCSAgICAgYm9vbCBlbmFibGUsIGJvb2wgb2xkKQo+ICAgewo+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJaTkxNV9yZWdf
dCByZWcgPSBQSVBFU1RBVChwaXBlKTsKPiAgIAo+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2
X3ByaXYtPmlycV9sb2NrKTsKPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmlycV9sb2Nr
KTsKPiAgIAo+ICAgCWlmIChlbmFibGUpIHsKPiAtCQl1MzIgZW5hYmxlX21hc2sgPSBpOTE1X3Bp
cGVzdGF0X2VuYWJsZV9tYXNrKGRldl9wcml2LCBwaXBlKTsKPiArCQl1MzIgZW5hYmxlX21hc2sg
PSBpOTE1X3BpcGVzdGF0X2VuYWJsZV9tYXNrKGk5MTUsIHBpcGUpOwo+ICAgCj4gICAJCUk5MTVf
V1JJVEUocmVnLCBlbmFibGVfbWFzayB8IFBJUEVfRklGT19VTkRFUlJVTl9TVEFUVVMpOwo+ICAg
CQlQT1NUSU5HX1JFQUQocmVnKTsKPiBAQCAtMTI4LDIzICsxMjgsMjMgQEAgc3RhdGljIHZvaWQg
aTl4eF9zZXRfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoc3RydWN0IGRybV9kZXZpY2UgKmRldiwK
PiAgIHN0YXRpYyB2b2lkIGlyb25sYWtlX3NldF9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2LAo+ICAgCQkJCQkJIGVudW0gcGlwZSBwaXBlLCBib29sIGVuYWJs
ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+
ICAgCXUzMiBiaXQgPSAocGlwZSA9PSBQSVBFX0EpID8KPiAgIAkJREVfUElQRUFfRklGT19VTkRF
UlJVTiA6IERFX1BJUEVCX0ZJRk9fVU5ERVJSVU47Cj4gICAKPiAgIAlpZiAoZW5hYmxlKQo+IC0J
CWlsa19lbmFibGVfZGlzcGxheV9pcnEoZGV2X3ByaXYsIGJpdCk7Cj4gKwkJaWxrX2VuYWJsZV9k
aXNwbGF5X2lycShpOTE1LCBiaXQpOwo+ICAgCWVsc2UKPiAtCQlpbGtfZGlzYWJsZV9kaXNwbGF5
X2lycShkZXZfcHJpdiwgYml0KTsKPiArCQlpbGtfZGlzYWJsZV9kaXNwbGF5X2lycShpOTE1LCBi
aXQpOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZCBpdnlicmlkZ2VfY2hlY2tfZmlmb191bmRl
cnJ1bnMoc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gICAJZW51
bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAgCXUzMiBlcnJfaW50ID0gSTkxNV9SRUFEKEdF
TjdfRVJSX0lOVCk7Cj4gICAKPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5pcnFf
bG9jayk7Cj4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5pcnFfbG9jayk7Cj4gICAKPiAg
IAlpZiAoKGVycl9pbnQgJiBFUlJfSU5UX0ZJRk9fVU5ERVJSVU4ocGlwZSkpID09IDApCj4gICAJ
CXJldHVybjsKPiBAQCAtMTUyLDcgKzE1Miw3IEBAIHN0YXRpYyB2b2lkIGl2eWJyaWRnZV9jaGVj
a19maWZvX3VuZGVycnVucyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiAgIAlJOTE1X1dSSVRF
KEdFTjdfRVJSX0lOVCwgRVJSX0lOVF9GSUZPX1VOREVSUlVOKHBpcGUpKTsKPiAgIAlQT1NUSU5H
X1JFQUQoR0VON19FUlJfSU5UKTsKPiAgIAo+IC0JdHJhY2VfaW50ZWxfY3B1X2ZpZm9fdW5kZXJy
dW4oZGV2X3ByaXYsIHBpcGUpOwo+ICsJdHJhY2VfaW50ZWxfY3B1X2ZpZm9fdW5kZXJydW4oaTkx
NSwgcGlwZSk7Cj4gICAJRFJNX0VSUk9SKCJmaWZvIHVuZGVycnVuIG9uIHBpcGUgJWNcbiIsIHBp
cGVfbmFtZShwaXBlKSk7Cj4gICB9Cj4gICAKPiBAQCAtMTYwLDE2ICsxNjAsMTYgQEAgc3RhdGlj
IHZvaWQgaXZ5YnJpZGdlX3NldF9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LAo+ICAgCQkJCQkJICBlbnVtIHBpcGUgcGlwZSwKPiAgIAkJCQkJCSAgYm9vbCBl
bmFibGUsIGJvb2wgb2xkKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGRldik7Cj4gICAJaWYgKGVuYWJsZSkgewo+ICAgCQlJOTE1X1dSSVRFKEdFTjdfRVJS
X0lOVCwgRVJSX0lOVF9GSUZPX1VOREVSUlVOKHBpcGUpKTsKPiAgIAo+ICAgCQlpZiAoIWl2Yl9j
YW5fZW5hYmxlX2Vycl9pbnQoZGV2KSkKPiAgIAkJCXJldHVybjsKPiAgIAo+IC0JCWlsa19lbmFi
bGVfZGlzcGxheV9pcnEoZGV2X3ByaXYsIERFX0VSUl9JTlRfSVZCKTsKPiArCQlpbGtfZW5hYmxl
X2Rpc3BsYXlfaXJxKGk5MTUsIERFX0VSUl9JTlRfSVZCKTsKPiAgIAl9IGVsc2Ugewo+IC0JCWls
a19kaXNhYmxlX2Rpc3BsYXlfaXJxKGRldl9wcml2LCBERV9FUlJfSU5UX0lWQik7Cj4gKwkJaWxr
X2Rpc2FibGVfZGlzcGxheV9pcnEoaTkxNSwgREVfRVJSX0lOVF9JVkIpOwo+ICAgCj4gICAJCWlm
IChvbGQgJiYKPiAgIAkJICAgIEk5MTVfUkVBRChHRU43X0VSUl9JTlQpICYgRVJSX0lOVF9GSUZP
X1VOREVSUlVOKHBpcGUpKSB7Cj4gQEAgLTE4MiwzNSArMTgyLDM1IEBAIHN0YXRpYyB2b2lkIGl2
eWJyaWRnZV9zZXRfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoc3RydWN0IGRybV9kZXZpY2UgKmRl
diwKPiAgIHN0YXRpYyB2b2lkIGJyb2Fkd2VsbF9zZXRfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmco
c3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiAgIAkJCQkJCSAgZW51bSBwaXBlIHBpcGUsIGJvb2wg
ZW5hYmxlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRl
dik7Cj4gICAKPiAgIAlpZiAoZW5hYmxlKQo+IC0JCWJkd19lbmFibGVfcGlwZV9pcnEoZGV2X3By
aXYsIHBpcGUsIEdFTjhfUElQRV9GSUZPX1VOREVSUlVOKTsKPiArCQliZHdfZW5hYmxlX3BpcGVf
aXJxKGk5MTUsIHBpcGUsIEdFTjhfUElQRV9GSUZPX1VOREVSUlVOKTsKPiAgIAllbHNlCj4gLQkJ
YmR3X2Rpc2FibGVfcGlwZV9pcnEoZGV2X3ByaXYsIHBpcGUsIEdFTjhfUElQRV9GSUZPX1VOREVS
UlVOKTsKPiArCQliZHdfZGlzYWJsZV9waXBlX2lycShpOTE1LCBwaXBlLCBHRU44X1BJUEVfRklG
T19VTkRFUlJVTik7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIGlieF9zZXRfZmlmb191bmRl
cnJ1bl9yZXBvcnRpbmcoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiAgIAkJCQkJICAgIGVudW0g
cGlwZSBwY2hfdHJhbnNjb2RlciwKPiAgIAkJCQkJICAgIGJvb2wgZW5hYmxlKQo+ICAgewo+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJdTMyIGJpdCA9
IChwY2hfdHJhbnNjb2RlciA9PSBQSVBFX0EpID8KPiAgIAkJU0RFX1RSQU5TQV9GSUZPX1VOREVS
IDogU0RFX1RSQU5TQl9GSUZPX1VOREVSOwo+ICAgCj4gICAJaWYgKGVuYWJsZSkKPiAtCQlpYnhf
ZW5hYmxlX2Rpc3BsYXlfaW50ZXJydXB0KGRldl9wcml2LCBiaXQpOwo+ICsJCWlieF9lbmFibGVf
ZGlzcGxheV9pbnRlcnJ1cHQoaTkxNSwgYml0KTsKPiAgIAllbHNlCj4gLQkJaWJ4X2Rpc2FibGVf
ZGlzcGxheV9pbnRlcnJ1cHQoZGV2X3ByaXYsIGJpdCk7Cj4gKwkJaWJ4X2Rpc2FibGVfZGlzcGxh
eV9pbnRlcnJ1cHQoaTkxNSwgYml0KTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgY3B0X2No
ZWNrX3BjaF9maWZvX3VuZGVycnVucyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5k
ZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJh
c2UuZGV2KTsKPiAgIAllbnVtIHBpcGUgcGNoX3RyYW5zY29kZXIgPSBjcnRjLT5waXBlOwo+ICAg
CXUzMiBzZXJyX2ludCA9IEk5MTVfUkVBRChTRVJSX0lOVCk7Cj4gICAKPiAtCWxvY2tkZXBfYXNz
ZXJ0X2hlbGQoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZp
OTE1LT5pcnFfbG9jayk7Cj4gICAKPiAgIAlpZiAoKHNlcnJfaW50ICYgU0VSUl9JTlRfVFJBTlNf
RklGT19VTkRFUlJVTihwY2hfdHJhbnNjb2RlcikpID09IDApCj4gICAJCXJldHVybjsKPiBAQCAt
MjE4LDcgKzIxOCw3IEBAIHN0YXRpYyB2b2lkIGNwdF9jaGVja19wY2hfZmlmb191bmRlcnJ1bnMo
c3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gICAJSTkxNV9XUklURShTRVJSX0lOVCwgU0VSUl9J
TlRfVFJBTlNfRklGT19VTkRFUlJVTihwY2hfdHJhbnNjb2RlcikpOwo+ICAgCVBPU1RJTkdfUkVB
RChTRVJSX0lOVCk7Cj4gICAKPiAtCXRyYWNlX2ludGVsX3BjaF9maWZvX3VuZGVycnVuKGRldl9w
cml2LCBwY2hfdHJhbnNjb2Rlcik7Cj4gKwl0cmFjZV9pbnRlbF9wY2hfZmlmb191bmRlcnJ1bihp
OTE1LCBwY2hfdHJhbnNjb2Rlcik7Cj4gICAJRFJNX0VSUk9SKCJwY2ggZmlmbyB1bmRlcnJ1biBv
biBwY2ggdHJhbnNjb2RlciAlY1xuIiwKPiAgIAkJICBwaXBlX25hbWUocGNoX3RyYW5zY29kZXIp
KTsKPiAgIH0KPiBAQCAtMjI3LDcgKzIyNyw3IEBAIHN0YXRpYyB2b2lkIGNwdF9zZXRfZmlmb191
bmRlcnJ1bl9yZXBvcnRpbmcoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiAgIAkJCQkJICAgIGVu
dW0gcGlwZSBwY2hfdHJhbnNjb2RlciwKPiAgIAkJCQkJICAgIGJvb2wgZW5hYmxlLCBib29sIG9s
ZCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+
ICAgCj4gICAJaWYgKGVuYWJsZSkgewo+ICAgCQlJOTE1X1dSSVRFKFNFUlJfSU5ULAo+IEBAIC0y
MzYsOSArMjM2LDkgQEAgc3RhdGljIHZvaWQgY3B0X3NldF9maWZvX3VuZGVycnVuX3JlcG9ydGlu
ZyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ICAgCQlpZiAoIWNwdF9jYW5fZW5hYmxlX3NlcnJf
aW50KGRldikpCj4gICAJCQlyZXR1cm47Cj4gICAKPiAtCQlpYnhfZW5hYmxlX2Rpc3BsYXlfaW50
ZXJydXB0KGRldl9wcml2LCBTREVfRVJST1JfQ1BUKTsKPiArCQlpYnhfZW5hYmxlX2Rpc3BsYXlf
aW50ZXJydXB0KGk5MTUsIFNERV9FUlJPUl9DUFQpOwo+ICAgCX0gZWxzZSB7Cj4gLQkJaWJ4X2Rp
c2FibGVfZGlzcGxheV9pbnRlcnJ1cHQoZGV2X3ByaXYsIFNERV9FUlJPUl9DUFQpOwo+ICsJCWli
eF9kaXNhYmxlX2Rpc3BsYXlfaW50ZXJydXB0KGk5MTUsIFNERV9FUlJPUl9DUFQpOwo+ICAgCj4g
ICAJCWlmIChvbGQgJiYgSTkxNV9SRUFEKFNFUlJfSU5UKSAmCj4gICAJCSAgICBTRVJSX0lOVF9U
UkFOU19GSUZPX1VOREVSUlVOKHBjaF90cmFuc2NvZGVyKSkgewo+IEBAIC0yNTEsMjIgKzI1MSwy
MiBAQCBzdGF0aWMgdm9pZCBjcHRfc2V0X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKHN0cnVjdCBk
cm1fZGV2aWNlICpkZXYsCj4gICBzdGF0aWMgYm9vbCBfX2ludGVsX3NldF9jcHVfZmlmb191bmRl
cnJ1bl9yZXBvcnRpbmcoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiAgIAkJCQkJCSAgICBlbnVt
IHBpcGUgcGlwZSwgYm9vbCBlbmFibGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9
IGludGVsX2dldF9jcnRjX2Zvcl9waXBlKGRldl9wcml2LCBwaXBlKTsKPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGludGVsX2NydGMg
KmNydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShpOTE1LCBwaXBlKTsKPiAgIAlib29sIG9s
ZDsKPiAgIAo+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiAr
CWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmlycV9sb2NrKTsKPiAgIAo+ICAgCW9sZCA9ICFj
cnRjLT5jcHVfZmlmb191bmRlcnJ1bl9kaXNhYmxlZDsKPiAgIAljcnRjLT5jcHVfZmlmb191bmRl
cnJ1bl9kaXNhYmxlZCA9ICFlbmFibGU7Cj4gICAKPiAtCWlmIChIQVNfR01DSChkZXZfcHJpdikp
Cj4gKwlpZiAoSEFTX0dNQ0goaTkxNSkpCj4gICAJCWk5eHhfc2V0X2ZpZm9fdW5kZXJydW5fcmVw
b3J0aW5nKGRldiwgcGlwZSwgZW5hYmxlLCBvbGQpOwo+IC0JZWxzZSBpZiAoSVNfR0VOX1JBTkdF
KGRldl9wcml2LCA1LCA2KSkKPiArCWVsc2UgaWYgKElTX0dFTl9SQU5HRShpOTE1LCA1LCA2KSkK
PiAgIAkJaXJvbmxha2Vfc2V0X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRldiwgcGlwZSwgZW5h
YmxlKTsKPiAtCWVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgNykpCj4gKwllbHNlIGlmIChJU19H
RU4oaTkxNSwgNykpCj4gICAJCWl2eWJyaWRnZV9zZXRfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmco
ZGV2LCBwaXBlLCBlbmFibGUsIG9sZCk7Cj4gLQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
ID49IDgpCj4gKwllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOCkKPiAgIAkJYnJvYWR3ZWxs
X3NldF9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXYsIHBpcGUsIGVuYWJsZSk7Cj4gICAKPiAg
IAlyZXR1cm4gb2xkOwo+IEBAIC0yNzQsNyArMjc0LDcgQEAgc3RhdGljIGJvb2wgX19pbnRlbF9z
ZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4g
ICAKPiAgIC8qKgo+ICAgICogaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyAt
IHNldCBjcHUgZmlmbyB1bmRlcnJydW4gcmVwb3J0aW5nIHN0YXRlCj4gLSAqIEBkZXZfcHJpdjog
aTkxNSBkZXZpY2UgaW5zdGFuY2UKPiArICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4g
ICAgKiBAcGlwZTogKENQVSkgcGlwZSB0byBzZXQgc3RhdGUgZm9yCj4gICAgKiBAZW5hYmxlOiB3
aGV0aGVyIHVuZGVycnVucyBzaG91bGQgYmUgcmVwb3J0ZWQgb3Igbm90Cj4gICAgKgo+IEBAIC0y
ODgsMjMgKzI4OCwyMyBAQCBzdGF0aWMgYm9vbCBfX2ludGVsX3NldF9jcHVfZmlmb191bmRlcnJ1
bl9yZXBvcnRpbmcoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiAgICAqCj4gICAgKiBSZXR1cm5z
IHRoZSBwcmV2aW91cyBzdGF0ZSBvZiB1bmRlcnJ1biByZXBvcnRpbmcuCj4gICAgKi8KPiAtYm9v
bCBpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiArYm9vbCBpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVw
b3J0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCQkgICBlbnVtIHBp
cGUgcGlwZSwgYm9vbCBlbmFibGUpCj4gICB7Cj4gICAJdW5zaWduZWQgbG9uZyBmbGFnczsKPiAg
IAlib29sIHJldDsKPiAgIAo+IC0Jc3Bpbl9sb2NrX2lycXNhdmUoJmRldl9wcml2LT5pcnFfbG9j
aywgZmxhZ3MpOwo+IC0JcmV0ID0gX19pbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0
aW5nKCZkZXZfcHJpdi0+ZHJtLCBwaXBlLAo+ICsJc3Bpbl9sb2NrX2lycXNhdmUoJmk5MTUtPmly
cV9sb2NrLCBmbGFncyk7Cj4gKwlyZXQgPSBfX2ludGVsX3NldF9jcHVfZmlmb191bmRlcnJ1bl9y
ZXBvcnRpbmcoJmk5MTUtPmRybSwgcGlwZSwKPiAgIAkJCQkJCSAgICAgIGVuYWJsZSk7Cj4gLQlz
cGluX3VubG9ja19pcnFyZXN0b3JlKCZkZXZfcHJpdi0+aXJxX2xvY2ssIGZsYWdzKTsKPiArCXNw
aW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPmlycV9sb2NrLCBmbGFncyk7Cj4gICAKPiAgIAly
ZXR1cm4gcmV0Owo+ICAgfQo+ICAgCj4gICAvKioKPiAgICAqIGludGVsX3NldF9wY2hfZmlmb191
bmRlcnJ1bl9yZXBvcnRpbmcgLSBzZXQgUENIIGZpZm8gdW5kZXJydW4gcmVwb3J0aW5nIHN0YXRl
Cj4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiArICogQGk5MTU6IGk5MTUg
ZGV2aWNlIGluc3RhbmNlCj4gICAgKiBAcGNoX3RyYW5zY29kZXI6IHRoZSBQQ0ggdHJhbnNjb2Rl
ciAoc2FtZSBhcyBwaXBlIG9uIElWQiBhbmQgb2xkZXIpCj4gICAgKiBAZW5hYmxlOiB3aGV0aGVy
IHVuZGVycnVucyBzaG91bGQgYmUgcmVwb3J0ZWQgb3Igbm90Cj4gICAgKgo+IEBAIC0zMTYsMTIg
KzMxNiwxMiBAQCBib29sIGludGVsX3NldF9jcHVfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgICoKPiAgICAqIFJldHVybnMgdGhl
IHByZXZpb3VzIHN0YXRlIG9mIHVuZGVycnVuIHJlcG9ydGluZy4KPiAgICAqLwo+IC1ib29sIGlu
dGVsX3NldF9wY2hfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ICtib29sIGludGVsX3NldF9wY2hfZmlmb191bmRlcnJ1bl9yZXBvcnRp
bmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJCSAgIGVudW0gcGlwZSBw
Y2hfdHJhbnNjb2RlciwKPiAgIAkJCQkJICAgYm9vbCBlbmFibGUpCj4gICB7Cj4gICAJc3RydWN0
IGludGVsX2NydGMgKmNydGMgPQo+IC0JCWludGVsX2dldF9jcnRjX2Zvcl9waXBlKGRldl9wcml2
LCBwY2hfdHJhbnNjb2Rlcik7Cj4gKwkJaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoaTkxNSwgcGNo
X3RyYW5zY29kZXIpOwo+ICAgCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4gICAJYm9vbCBvbGQ7Cj4g
ICAKPiBAQCAtMzM0LDcxICszMzQsNzEgQEAgYm9vbCBpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJy
dW5fcmVwb3J0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkgKiBj
cnRjIG9uIExQVCB3b24ndCBjYXVzZSBpc3N1ZXMuCj4gICAJICovCj4gICAKPiAtCXNwaW5fbG9j
a19pcnFzYXZlKCZkZXZfcHJpdi0+aXJxX2xvY2ssIGZsYWdzKTsKPiArCXNwaW5fbG9ja19pcnFz
YXZlKCZpOTE1LT5pcnFfbG9jaywgZmxhZ3MpOwo+ICAgCj4gICAJb2xkID0gIWNydGMtPnBjaF9m
aWZvX3VuZGVycnVuX2Rpc2FibGVkOwo+ICAgCWNydGMtPnBjaF9maWZvX3VuZGVycnVuX2Rpc2Fi
bGVkID0gIWVuYWJsZTsKPiAgIAo+IC0JaWYgKEhBU19QQ0hfSUJYKGRldl9wcml2KSkKPiAtCQlp
Ynhfc2V0X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKCZkZXZfcHJpdi0+ZHJtLAo+ICsJaWYgKEhB
U19QQ0hfSUJYKGk5MTUpKQo+ICsJCWlieF9zZXRfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoJmk5
MTUtPmRybSwKPiAgIAkJCQkJCXBjaF90cmFuc2NvZGVyLAo+ICAgCQkJCQkJZW5hYmxlKTsKPiAg
IAllbHNlCj4gLQkJY3B0X3NldF9maWZvX3VuZGVycnVuX3JlcG9ydGluZygmZGV2X3ByaXYtPmRy
bSwKPiArCQljcHRfc2V0X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKCZpOTE1LT5kcm0sCj4gICAJ
CQkJCQlwY2hfdHJhbnNjb2RlciwKPiAgIAkJCQkJCWVuYWJsZSwgb2xkKTsKPiAgIAo+IC0Jc3Bp
bl91bmxvY2tfaXJxcmVzdG9yZSgmZGV2X3ByaXYtPmlycV9sb2NrLCBmbGFncyk7Cj4gKwlzcGlu
X3VubG9ja19pcnFyZXN0b3JlKCZpOTE1LT5pcnFfbG9jaywgZmxhZ3MpOwo+ICAgCXJldHVybiBv
bGQ7Cj4gICB9Cj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxfY3B1X2ZpZm9fdW5kZXJydW5faXJx
X2hhbmRsZXIgLSBoYW5kbGUgQ1BVIGZpZm8gdW5kZXJydW4gaW50ZXJydXB0Cj4gLSAqIEBkZXZf
cHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiArICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3Rh
bmNlCj4gICAgKiBAcGlwZTogKENQVSkgcGlwZSB0byBzZXQgc3RhdGUgZm9yCj4gICAgKgo+ICAg
ICogVGhpcyBoYW5kbGVzIGEgQ1BVIGZpZm8gdW5kZXJydW4gaW50ZXJydXB0LCBnZW5lcmF0aW5n
IGFuIHVuZGVycnVuIHdhcm5pbmcKPiAgICAqIGludG8gZG1lc2cgaWYgdW5kZXJydW4gcmVwb3J0
aW5nIGlzIGVuYWJsZWQgYW5kIHRoZW4gZGlzYWJsZXMgdGhlIHVuZGVycnVuCj4gICAgKiBpbnRl
cnJ1cHQgdG8gYXZvaWQgYW4gaXJxIHN0b3JtLgo+ICAgICovCj4gLXZvaWQgaW50ZWxfY3B1X2Zp
Zm9fdW5kZXJydW5faXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ICt2b2lkIGludGVsX2NwdV9maWZvX3VuZGVycnVuX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCQkgZW51bSBwaXBlIHBpcGUpCj4gICB7Cj4gLQlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IGludGVsX2dldF9jcnRjX2Zvcl9waXBlKGRldl9wcml2
LCBwaXBlKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9y
X3BpcGUoaTkxNSwgcGlwZSk7Cj4gICAKPiAgIAkvKiBXZSBtYXkgYmUgY2FsbGVkIHRvbyBlYXJs
eSBpbiBpbml0LCB0aGFua3MgQklPUyEgKi8KPiAgIAlpZiAoY3J0YyA9PSBOVUxMKQo+ICAgCQly
ZXR1cm47Cj4gICAKPiAgIAkvKiBHTUNIIGNhbid0IGRpc2FibGUgZmlmbyB1bmRlcnJ1bnMsIGZp
bHRlciB0aGVtLiAqLwo+IC0JaWYgKEhBU19HTUNIKGRldl9wcml2KSAmJgo+ICsJaWYgKEhBU19H
TUNIKGk5MTUpICYmCj4gICAJICAgIGNydGMtPmNwdV9maWZvX3VuZGVycnVuX2Rpc2FibGVkKQo+
ICAgCQlyZXR1cm47Cj4gICAKPiAtCWlmIChpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVw
b3J0aW5nKGRldl9wcml2LCBwaXBlLCBmYWxzZSkpIHsKPiAtCQl0cmFjZV9pbnRlbF9jcHVfZmlm
b191bmRlcnJ1bihkZXZfcHJpdiwgcGlwZSk7Cj4gKwlpZiAoaW50ZWxfc2V0X2NwdV9maWZvX3Vu
ZGVycnVuX3JlcG9ydGluZyhpOTE1LCBwaXBlLCBmYWxzZSkpIHsKPiArCQl0cmFjZV9pbnRlbF9j
cHVfZmlmb191bmRlcnJ1bihpOTE1LCBwaXBlKTsKPiAgIAkJRFJNX0VSUk9SKCJDUFUgcGlwZSAl
YyBGSUZPIHVuZGVycnVuXG4iLAo+ICAgCQkJICBwaXBlX25hbWUocGlwZSkpOwo+ICAgCX0KPiAg
IAo+IC0JaW50ZWxfZmJjX2hhbmRsZV9maWZvX3VuZGVycnVuX2lycShkZXZfcHJpdik7Cj4gKwlp
bnRlbF9mYmNfaGFuZGxlX2ZpZm9fdW5kZXJydW5faXJxKGk5MTUpOwo+ICAgfQo+ICAgCj4gICAv
KioKPiAgICAqIGludGVsX3BjaF9maWZvX3VuZGVycnVuX2lycV9oYW5kbGVyIC0gaGFuZGxlIFBD
SCBmaWZvIHVuZGVycnVuIGludGVycnVwdAo+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIGlu
c3RhbmNlCj4gKyAqIEBpOTE1OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ICAgICogQHBjaF90cmFu
c2NvZGVyOiB0aGUgUENIIHRyYW5zY29kZXIgKHNhbWUgYXMgcGlwZSBvbiBJVkIgYW5kIG9sZGVy
KQo+ICAgICoKPiAgICAqIFRoaXMgaGFuZGxlcyBhIFBDSCBmaWZvIHVuZGVycnVuIGludGVycnVw
dCwgZ2VuZXJhdGluZyBhbiB1bmRlcnJ1biB3YXJuaW5nCj4gICAgKiBpbnRvIGRtZXNnIGlmIHVu
ZGVycnVuIHJlcG9ydGluZyBpcyBlbmFibGVkIGFuZCB0aGVuIGRpc2FibGVzIHRoZSB1bmRlcnJ1
bgo+ICAgICogaW50ZXJydXB0IHRvIGF2b2lkIGFuIGlycSBzdG9ybS4KPiAgICAqLwo+IC12b2lk
IGludGVsX3BjaF9maWZvX3VuZGVycnVuX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiArdm9pZCBpbnRlbF9wY2hfZmlmb191bmRlcnJ1bl9pcnFfaGFuZGxl
cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkJIGVudW0gcGlwZSBwY2hf
dHJhbnNjb2RlcikKPiAgIHsKPiAtCWlmIChpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVw
b3J0aW5nKGRldl9wcml2LCBwY2hfdHJhbnNjb2RlciwKPiArCWlmIChpbnRlbF9zZXRfcGNoX2Zp
Zm9fdW5kZXJydW5fcmVwb3J0aW5nKGk5MTUsIHBjaF90cmFuc2NvZGVyLAo+ICAgCQkJCQkJICBm
YWxzZSkpIHsKPiAtCQl0cmFjZV9pbnRlbF9wY2hfZmlmb191bmRlcnJ1bihkZXZfcHJpdiwgcGNo
X3RyYW5zY29kZXIpOwo+ICsJCXRyYWNlX2ludGVsX3BjaF9maWZvX3VuZGVycnVuKGk5MTUsIHBj
aF90cmFuc2NvZGVyKTsKPiAgIAkJRFJNX0VSUk9SKCJQQ0ggdHJhbnNjb2RlciAlYyBGSUZPIHVu
ZGVycnVuXG4iLAo+ICAgCQkJICBwaXBlX25hbWUocGNoX3RyYW5zY29kZXIpKTsKPiAgIAl9Cj4g
QEAgLTQwNiw1MyArNDA2LDUzIEBAIHZvaWQgaW50ZWxfcGNoX2ZpZm9fdW5kZXJydW5faXJxX2hh
bmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCj4gICAvKioKPiAg
ICAqIGludGVsX2NoZWNrX2NwdV9maWZvX3VuZGVycnVucyAtIGNoZWNrIGZvciBDUFUgZmlmbyB1
bmRlcnJ1bnMgaW1tZWRpYXRlbHkKPiAtICogQGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5j
ZQo+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiAgICAqCj4gICAgKiBDaGVjayBm
b3IgQ1BVIGZpZm8gdW5kZXJydW5zIGltbWVkaWF0ZWx5LiBVc2VmdWwgb24gSVZCL0hTVyB3aGVy
ZSB0aGUgc2hhcmVkCj4gICAgKiBlcnJvciBpbnRlcnJ1cHQgbWF5IGhhdmUgYmVlbiBkaXNhYmxl
ZCwgYW5kIHNvIENQVSBmaWZvIHVuZGVycnVucyB3b24ndAo+ICAgICogbmVjZXNzYXJpbHkgcmFp
c2UgYW4gaW50ZXJydXB0LCBhbmQgb24gR01DSCBwbGF0Zm9ybXMgd2hlcmUgdW5kZXJydW5zIG5l
dmVyCj4gICAgKiByYWlzZSBhbiBpbnRlcnJ1cHQuCj4gICAgKi8KPiAtdm9pZCBpbnRlbF9jaGVj
a19jcHVfZmlmb191bmRlcnJ1bnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ICt2b2lkIGludGVsX2NoZWNrX2NwdV9maWZvX3VuZGVycnVucyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsKPiAgIAo+IC0J
c3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiArCXNwaW5fbG9ja19pcnEoJmk5
MTUtPmlycV9sb2NrKTsKPiAgIAo+IC0JZm9yX2VhY2hfaW50ZWxfY3J0YygmZGV2X3ByaXYtPmRy
bSwgY3J0Yykgewo+ICsJZm9yX2VhY2hfaW50ZWxfY3J0YygmaTkxNS0+ZHJtLCBjcnRjKSB7Cj4g
ICAJCWlmIChjcnRjLT5jcHVfZmlmb191bmRlcnJ1bl9kaXNhYmxlZCkKPiAgIAkJCWNvbnRpbnVl
Owo+ICAgCj4gLQkJaWYgKEhBU19HTUNIKGRldl9wcml2KSkKPiArCQlpZiAoSEFTX0dNQ0goaTkx
NSkpCj4gICAJCQlpOXh4X2NoZWNrX2ZpZm9fdW5kZXJydW5zKGNydGMpOwo+IC0JCWVsc2UgaWYg
KElTX0dFTihkZXZfcHJpdiwgNykpCj4gKwkJZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDcpKQo+ICAg
CQkJaXZ5YnJpZGdlX2NoZWNrX2ZpZm9fdW5kZXJydW5zKGNydGMpOwo+ICAgCX0KPiAgIAo+IC0J
c3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ICsJc3Bpbl91bmxvY2tfaXJx
KCZpOTE1LT5pcnFfbG9jayk7Cj4gICB9Cj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxfY2hlY2tf
cGNoX2ZpZm9fdW5kZXJydW5zIC0gY2hlY2sgZm9yIFBDSCBmaWZvIHVuZGVycnVucyBpbW1lZGlh
dGVseQo+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gKyAqIEBpOTE1OiBp
OTE1IGRldmljZSBpbnN0YW5jZQo+ICAgICoKPiAgICAqIENoZWNrIGZvciBQQ0ggZmlmbyB1bmRl
cnJ1bnMgaW1tZWRpYXRlbHkuIFVzZWZ1bCBvbiBDUFQvUFBUIHdoZXJlIHRoZSBzaGFyZWQKPiAg
ICAqIGVycm9yIGludGVycnVwdCBtYXkgaGF2ZSBiZWVuIGRpc2FibGVkLCBhbmQgc28gUENIIGZp
Zm8gdW5kZXJydW5zIHdvbid0Cj4gICAgKiBuZWNlc3NhcmlseSByYWlzZSBhbiBpbnRlcnJ1cHQu
Cj4gICAgKi8KPiAtdm9pZCBpbnRlbF9jaGVja19wY2hfZmlmb191bmRlcnJ1bnMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGludGVsX2NoZWNrX3BjaF9maWZvX3Vu
ZGVycnVucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YzsKPiAgIAo+IC0Jc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9s
b2NrKTsKPiArCXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiAgIAo+IC0JZm9yX2Vh
Y2hfaW50ZWxfY3J0YygmZGV2X3ByaXYtPmRybSwgY3J0Yykgewo+ICsJZm9yX2VhY2hfaW50ZWxf
Y3J0YygmaTkxNS0+ZHJtLCBjcnRjKSB7Cj4gICAJCWlmIChjcnRjLT5wY2hfZmlmb191bmRlcnJ1
bl9kaXNhYmxlZCkKPiAgIAkJCWNvbnRpbnVlOwo+ICAgCj4gLQkJaWYgKEhBU19QQ0hfQ1BUKGRl
dl9wcml2KSkKPiArCQlpZiAoSEFTX1BDSF9DUFQoaTkxNSkpCj4gICAJCQljcHRfY2hlY2tfcGNo
X2ZpZm9fdW5kZXJydW5zKGNydGMpOwo+ICAgCX0KPiAgIAo+IC0Jc3Bpbl91bmxvY2tfaXJxKCZk
ZXZfcHJpdi0+aXJxX2xvY2spOwo+ICsJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7
Cj4gICB9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2ZpZm9fdW5k
ZXJydW4uaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2ZpZm9fdW5kZXJydW4uaAo+IGlu
ZGV4IGUwNGYyMmFjMWY0OS4uMjkwOTA5YTY3ZGU4IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX2ZpZm9fdW5kZXJydW4uaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX2ZpZm9fdW5kZXJydW4uaAo+IEBAIC0xMiwxNiArMTIsMTYgQEAKPiAgIAo+ICAg
c3RydWN0IGRybV9pOTE1X3ByaXZhdGU7Cj4gICAKPiAtYm9vbCBpbnRlbF9zZXRfY3B1X2ZpZm9f
dW5kZXJydW5fcmVwb3J0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAr
Ym9vbCBpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCQkJCQkgICBlbnVtIHBpcGUgcGlwZSwgYm9vbCBlbmFibGUp
Owo+IC1ib29sIGludGVsX3NldF9wY2hfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtib29sIGludGVsX3NldF9wY2hfZmlmb191bmRl
cnJ1bl9yZXBvcnRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJCSAg
IGVudW0gcGlwZSBwY2hfdHJhbnNjb2RlciwKPiAgIAkJCQkJICAgYm9vbCBlbmFibGUpOwo+IC12
b2lkIGludGVsX2NwdV9maWZvX3VuZGVycnVuX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiArdm9pZCBpbnRlbF9jcHVfZmlmb191bmRlcnJ1bl9pcnFfaGFu
ZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkJIGVudW0gcGlwZSBw
aXBlKTsKPiAtdm9pZCBpbnRlbF9wY2hfZmlmb191bmRlcnJ1bl9pcnFfaGFuZGxlcihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3ZvaWQgaW50ZWxfcGNoX2ZpZm9fdW5kZXJy
dW5faXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJCSBl
bnVtIHBpcGUgcGNoX3RyYW5zY29kZXIpOwo+IC12b2lkIGludGVsX2NoZWNrX2NwdV9maWZvX3Vu
ZGVycnVucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGludGVs
X2NoZWNrX3BjaF9maWZvX3VuZGVycnVucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpOwo+ICt2b2lkIGludGVsX2NoZWNrX2NwdV9maWZvX3VuZGVycnVucyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgaW50ZWxfY2hlY2tfcGNoX2ZpZm9fdW5kZXJydW5z
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAgIAo+ICAgI2VuZGlmIC8qIF9fSU5U
RUxfRklGT19VTkRFUlJVTl9IX18gKi8KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfZnJvbnRidWZmZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Zyb250
YnVmZmVyLmMKPiBpbmRleCBkNjAzNmI5YWQxNmEuLjE2MTEzOWRlM2YyOCAxMDA2NDQKPiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9mcm9udGJ1ZmZlci5jCj4gKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfZnJvbnRidWZmZXIuYwo+IEBAIC02NiwyNCArNjYsMjQgQEAg
dm9pZCBfX2ludGVsX2ZiX29ial9pbnZhbGlkYXRlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0
ICpvYmosCj4gICAJCQkgICAgICAgZW51bSBmYl9vcF9vcmlnaW4gb3JpZ2luLAo+ICAgCQkJICAg
ICAgIHVuc2lnbmVkIGludCBmcm9udGJ1ZmZlcl9iaXRzKQo+ICAgewo+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShvYmotPmJhc2UuZGV2KTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShvYmotPmJhc2UuZGV2KTsKPiAgIAo+
ICAgCWlmIChvcmlnaW4gPT0gT1JJR0lOX0NTKSB7Cj4gLQkJc3Bpbl9sb2NrKCZkZXZfcHJpdi0+
ZmJfdHJhY2tpbmcubG9jayk7Cj4gLQkJZGV2X3ByaXYtPmZiX3RyYWNraW5nLmJ1c3lfYml0cyB8
PSBmcm9udGJ1ZmZlcl9iaXRzOwo+IC0JCWRldl9wcml2LT5mYl90cmFja2luZy5mbGlwX2JpdHMg
Jj0gfmZyb250YnVmZmVyX2JpdHM7Cj4gLQkJc3Bpbl91bmxvY2soJmRldl9wcml2LT5mYl90cmFj
a2luZy5sb2NrKTsKPiArCQlzcGluX2xvY2soJmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOwo+ICsJ
CWk5MTUtPmZiX3RyYWNraW5nLmJ1c3lfYml0cyB8PSBmcm9udGJ1ZmZlcl9iaXRzOwo+ICsJCWk5
MTUtPmZiX3RyYWNraW5nLmZsaXBfYml0cyAmPSB+ZnJvbnRidWZmZXJfYml0czsKPiArCQlzcGlu
X3VubG9jaygmaTkxNS0+ZmJfdHJhY2tpbmcubG9jayk7Cj4gICAJfQo+ICAgCj4gICAJbWlnaHRf
c2xlZXAoKTsKPiAtCWludGVsX3Bzcl9pbnZhbGlkYXRlKGRldl9wcml2LCBmcm9udGJ1ZmZlcl9i
aXRzLCBvcmlnaW4pOwo+IC0JaW50ZWxfZWRwX2RycnNfaW52YWxpZGF0ZShkZXZfcHJpdiwgZnJv
bnRidWZmZXJfYml0cyk7Cj4gLQlpbnRlbF9mYmNfaW52YWxpZGF0ZShkZXZfcHJpdiwgZnJvbnRi
dWZmZXJfYml0cywgb3JpZ2luKTsKPiArCWludGVsX3Bzcl9pbnZhbGlkYXRlKGk5MTUsIGZyb250
YnVmZmVyX2JpdHMsIG9yaWdpbik7Cj4gKwlpbnRlbF9lZHBfZHJyc19pbnZhbGlkYXRlKGk5MTUs
IGZyb250YnVmZmVyX2JpdHMpOwo+ICsJaW50ZWxfZmJjX2ludmFsaWRhdGUoaTkxNSwgZnJvbnRi
dWZmZXJfYml0cywgb3JpZ2luKTsKPiAgIH0KPiAgIAo+ICAgLyoqCj4gICAgKiBpbnRlbF9mcm9u
dGJ1ZmZlcl9mbHVzaCAtIGZsdXNoIGZyb250YnVmZmVyCj4gLSAqIEBkZXZfcHJpdjogaTkxNSBk
ZXZpY2UKPiArICogQGk5MTU6IGk5MTUgZGV2aWNlCj4gICAgKiBAZnJvbnRidWZmZXJfYml0czog
ZnJvbnRidWZmZXIgcGxhbmUgdHJhY2tpbmcgYml0cwo+ICAgICogQG9yaWdpbjogd2hpY2ggb3Bl
cmF0aW9uIGNhdXNlZCB0aGUgZmx1c2gKPiAgICAqCj4gQEAgLTkzLDQ1ICs5Myw0NSBAQCB2b2lk
IF9faW50ZWxfZmJfb2JqX2ludmFsaWRhdGUoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
aiwKPiAgICAqCj4gICAgKiBDYW4gYmUgY2FsbGVkIHdpdGhvdXQgYW55IGxvY2tzIGhlbGQuCj4g
ICAgKi8KPiAtc3RhdGljIHZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmx1c2goc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBpbnRlbF9mcm9udGJ1ZmZlcl9m
bHVzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAgdW5zaWduZWQg
ZnJvbnRidWZmZXJfYml0cywKPiAgIAkJCQkgICAgZW51bSBmYl9vcF9vcmlnaW4gb3JpZ2luKQo+
ICAgewo+ICAgCS8qIERlbGF5IGZsdXNoaW5nIHdoZW4gcmluZ3MgYXJlIHN0aWxsIGJ1c3kuKi8K
PiAtCXNwaW5fbG9jaygmZGV2X3ByaXYtPmZiX3RyYWNraW5nLmxvY2spOwo+IC0JZnJvbnRidWZm
ZXJfYml0cyAmPSB+ZGV2X3ByaXYtPmZiX3RyYWNraW5nLmJ1c3lfYml0czsKPiAtCXNwaW5fdW5s
b2NrKCZkZXZfcHJpdi0+ZmJfdHJhY2tpbmcubG9jayk7Cj4gKwlzcGluX2xvY2soJmk5MTUtPmZi
X3RyYWNraW5nLmxvY2spOwo+ICsJZnJvbnRidWZmZXJfYml0cyAmPSB+aTkxNS0+ZmJfdHJhY2tp
bmcuYnVzeV9iaXRzOwo+ICsJc3Bpbl91bmxvY2soJmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOwo+
ICAgCj4gICAJaWYgKCFmcm9udGJ1ZmZlcl9iaXRzKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAlt
aWdodF9zbGVlcCgpOwo+IC0JaW50ZWxfZWRwX2RycnNfZmx1c2goZGV2X3ByaXYsIGZyb250YnVm
ZmVyX2JpdHMpOwo+IC0JaW50ZWxfcHNyX2ZsdXNoKGRldl9wcml2LCBmcm9udGJ1ZmZlcl9iaXRz
LCBvcmlnaW4pOwo+IC0JaW50ZWxfZmJjX2ZsdXNoKGRldl9wcml2LCBmcm9udGJ1ZmZlcl9iaXRz
LCBvcmlnaW4pOwo+ICsJaW50ZWxfZWRwX2RycnNfZmx1c2goaTkxNSwgZnJvbnRidWZmZXJfYml0
cyk7Cj4gKwlpbnRlbF9wc3JfZmx1c2goaTkxNSwgZnJvbnRidWZmZXJfYml0cywgb3JpZ2luKTsK
PiArCWludGVsX2ZiY19mbHVzaChpOTE1LCBmcm9udGJ1ZmZlcl9iaXRzLCBvcmlnaW4pOwo+ICAg
fQo+ICAgCj4gICB2b2lkIF9faW50ZWxfZmJfb2JqX2ZsdXNoKHN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0ICpvYmosCj4gICAJCQkgIGVudW0gZmJfb3Bfb3JpZ2luIG9yaWdpbiwKPiAgIAkJCSAg
dW5zaWduZWQgaW50IGZyb250YnVmZmVyX2JpdHMpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KG9iai0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KG9iai0+YmFzZS5kZXYpOwo+ICAgCj4gICAJ
aWYgKG9yaWdpbiA9PSBPUklHSU5fQ1MpIHsKPiAtCQlzcGluX2xvY2soJmRldl9wcml2LT5mYl90
cmFja2luZy5sb2NrKTsKPiArCQlzcGluX2xvY2soJmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOwo+
ICAgCQkvKiBGaWx0ZXIgb3V0IG5ldyBiaXRzIHNpbmNlIHJlbmRlcmluZyBzdGFydGVkLiAqLwo+
IC0JCWZyb250YnVmZmVyX2JpdHMgJj0gZGV2X3ByaXYtPmZiX3RyYWNraW5nLmJ1c3lfYml0czsK
PiAtCQlkZXZfcHJpdi0+ZmJfdHJhY2tpbmcuYnVzeV9iaXRzICY9IH5mcm9udGJ1ZmZlcl9iaXRz
Owo+IC0JCXNwaW5fdW5sb2NrKCZkZXZfcHJpdi0+ZmJfdHJhY2tpbmcubG9jayk7Cj4gKwkJZnJv
bnRidWZmZXJfYml0cyAmPSBpOTE1LT5mYl90cmFja2luZy5idXN5X2JpdHM7Cj4gKwkJaTkxNS0+
ZmJfdHJhY2tpbmcuYnVzeV9iaXRzICY9IH5mcm9udGJ1ZmZlcl9iaXRzOwo+ICsJCXNwaW5fdW5s
b2NrKCZpOTE1LT5mYl90cmFja2luZy5sb2NrKTsKPiAgIAl9Cj4gICAKPiAgIAlpZiAoZnJvbnRi
dWZmZXJfYml0cykKPiAtCQlpbnRlbF9mcm9udGJ1ZmZlcl9mbHVzaChkZXZfcHJpdiwgZnJvbnRi
dWZmZXJfYml0cywgb3JpZ2luKTsKPiArCQlpbnRlbF9mcm9udGJ1ZmZlcl9mbHVzaChpOTE1LCBm
cm9udGJ1ZmZlcl9iaXRzLCBvcmlnaW4pOwo+ICAgfQo+ICAgCj4gICAvKioKPiAgICAqIGludGVs
X2Zyb250YnVmZmVyX2ZsaXBfcHJlcGFyZSAtIHByZXBhcmUgYXN5bmNocm9ub3VzIGZyb250YnVm
ZmVyIGZsaXAKPiAtICogQGRldl9wcml2OiBpOTE1IGRldmljZQo+ICsgKiBAaTkxNTogaTkxNSBk
ZXZpY2UKPiAgICAqIEBmcm9udGJ1ZmZlcl9iaXRzOiBmcm9udGJ1ZmZlciBwbGFuZSB0cmFja2lu
ZyBiaXRzCj4gICAgKgo+ICAgICogVGhpcyBmdW5jdGlvbiBnZXRzIGNhbGxlZCBhZnRlciBzY2hl
ZHVsaW5nIGEgZmxpcCBvbiBAb2JqLiBUaGUgYWN0dWFsCj4gQEAgLTE0MSwxOSArMTQxLDE5IEBA
IHZvaWQgX19pbnRlbF9mYl9vYmpfZmx1c2goc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
aiwKPiAgICAqCj4gICAgKiBDYW4gYmUgY2FsbGVkIHdpdGhvdXQgYW55IGxvY2tzIGhlbGQuCj4g
ICAgKi8KPiAtdm9pZCBpbnRlbF9mcm9udGJ1ZmZlcl9mbGlwX3ByZXBhcmUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICt2b2lkIGludGVsX2Zyb250YnVmZmVyX2ZsaXBfcHJl
cGFyZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAgdW5zaWduZWQg
ZnJvbnRidWZmZXJfYml0cykKPiAgIHsKPiAtCXNwaW5fbG9jaygmZGV2X3ByaXYtPmZiX3RyYWNr
aW5nLmxvY2spOwo+IC0JZGV2X3ByaXYtPmZiX3RyYWNraW5nLmZsaXBfYml0cyB8PSBmcm9udGJ1
ZmZlcl9iaXRzOwo+ICsJc3Bpbl9sb2NrKCZpOTE1LT5mYl90cmFja2luZy5sb2NrKTsKPiArCWk5
MTUtPmZiX3RyYWNraW5nLmZsaXBfYml0cyB8PSBmcm9udGJ1ZmZlcl9iaXRzOwo+ICAgCS8qIFJl
bW92ZSBzdGFsZSBidXN5IGJpdHMgZHVlIHRvIHRoZSBvbGQgYnVmZmVyLiAqLwo+IC0JZGV2X3By
aXYtPmZiX3RyYWNraW5nLmJ1c3lfYml0cyAmPSB+ZnJvbnRidWZmZXJfYml0czsKPiAtCXNwaW5f
dW5sb2NrKCZkZXZfcHJpdi0+ZmJfdHJhY2tpbmcubG9jayk7Cj4gKwlpOTE1LT5mYl90cmFja2lu
Zy5idXN5X2JpdHMgJj0gfmZyb250YnVmZmVyX2JpdHM7Cj4gKwlzcGluX3VubG9jaygmaTkxNS0+
ZmJfdHJhY2tpbmcubG9jayk7Cj4gICB9Cj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxfZnJvbnRi
dWZmZXJfZmxpcF9jb21wbGV0ZSAtIGNvbXBsZXRlIGFzeW5jaHJvbm91cyBmcm9udGJ1ZmZlciBm
bGlwCj4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UKPiArICogQGk5MTU6IGk5MTUgZGV2aWNl
Cj4gICAgKiBAZnJvbnRidWZmZXJfYml0czogZnJvbnRidWZmZXIgcGxhbmUgdHJhY2tpbmcgYml0
cwo+ICAgICoKPiAgICAqIFRoaXMgZnVuY3Rpb24gZ2V0cyBjYWxsZWQgYWZ0ZXIgdGhlIGZsaXAg
aGFzIGJlZW4gbGF0Y2hlZCBhbmQgd2lsbCBjb21wbGV0ZQo+IEBAIC0xNjEsMjMgKzE2MSwyMyBA
QCB2b2lkIGludGVsX2Zyb250YnVmZmVyX2ZsaXBfcHJlcGFyZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gICAgKgo+ICAgICogQ2FuIGJlIGNhbGxlZCB3aXRob3V0IGFueSBs
b2NrcyBoZWxkLgo+ICAgICovCj4gLXZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmxpcF9jb21wbGV0
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3ZvaWQgaW50ZWxfZnJvbnRi
dWZmZXJfZmxpcF9jb21wbGV0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJ
CQkgICAgIHVuc2lnbmVkIGZyb250YnVmZmVyX2JpdHMpCj4gICB7Cj4gLQlzcGluX2xvY2soJmRl
dl9wcml2LT5mYl90cmFja2luZy5sb2NrKTsKPiArCXNwaW5fbG9jaygmaTkxNS0+ZmJfdHJhY2tp
bmcubG9jayk7Cj4gICAJLyogTWFzayBhbnkgY2FuY2VsbGVkIGZsaXBzLiAqLwo+IC0JZnJvbnRi
dWZmZXJfYml0cyAmPSBkZXZfcHJpdi0+ZmJfdHJhY2tpbmcuZmxpcF9iaXRzOwo+IC0JZGV2X3By
aXYtPmZiX3RyYWNraW5nLmZsaXBfYml0cyAmPSB+ZnJvbnRidWZmZXJfYml0czsKPiAtCXNwaW5f
dW5sb2NrKCZkZXZfcHJpdi0+ZmJfdHJhY2tpbmcubG9jayk7Cj4gKwlmcm9udGJ1ZmZlcl9iaXRz
ICY9IGk5MTUtPmZiX3RyYWNraW5nLmZsaXBfYml0czsKPiArCWk5MTUtPmZiX3RyYWNraW5nLmZs
aXBfYml0cyAmPSB+ZnJvbnRidWZmZXJfYml0czsKPiArCXNwaW5fdW5sb2NrKCZpOTE1LT5mYl90
cmFja2luZy5sb2NrKTsKPiAgIAo+ICAgCWlmIChmcm9udGJ1ZmZlcl9iaXRzKQo+IC0JCWludGVs
X2Zyb250YnVmZmVyX2ZsdXNoKGRldl9wcml2LAo+ICsJCWludGVsX2Zyb250YnVmZmVyX2ZsdXNo
KGk5MTUsCj4gICAJCQkJCWZyb250YnVmZmVyX2JpdHMsIE9SSUdJTl9GTElQKTsKPiAgIH0KPiAg
IAo+ICAgLyoqCj4gICAgKiBpbnRlbF9mcm9udGJ1ZmZlcl9mbGlwIC0gc3luY2hyb25vdXMgZnJv
bnRidWZmZXIgZmxpcAo+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlCj4gKyAqIEBpOTE1OiBp
OTE1IGRldmljZQo+ICAgICogQGZyb250YnVmZmVyX2JpdHM6IGZyb250YnVmZmVyIHBsYW5lIHRy
YWNraW5nIGJpdHMKPiAgICAqCj4gICAgKiBUaGlzIGZ1bmN0aW9uIGdldHMgY2FsbGVkIGFmdGVy
IHNjaGVkdWxpbmcgYSBmbGlwIG9uIEBvYmouIFRoaXMgaXMgZm9yCj4gQEAgLTE4NiwxMyArMTg2
LDEzIEBAIHZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmxpcF9jb21wbGV0ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAgKgo+ICAgICogQ2FuIGJlIGNhbGxlZCB3aXRob3V0
IGFueSBsb2NrcyBoZWxkLgo+ICAgICovCj4gLXZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmxpcChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3ZvaWQgaW50ZWxfZnJvbnRidWZm
ZXJfZmxpcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICB1bnNpZ25l
ZCBmcm9udGJ1ZmZlcl9iaXRzKQo+ICAgewo+IC0Jc3Bpbl9sb2NrKCZkZXZfcHJpdi0+ZmJfdHJh
Y2tpbmcubG9jayk7Cj4gKwlzcGluX2xvY2soJmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOwo+ICAg
CS8qIFJlbW92ZSBzdGFsZSBidXN5IGJpdHMgZHVlIHRvIHRoZSBvbGQgYnVmZmVyLiAqLwo+IC0J
ZGV2X3ByaXYtPmZiX3RyYWNraW5nLmJ1c3lfYml0cyAmPSB+ZnJvbnRidWZmZXJfYml0czsKPiAt
CXNwaW5fdW5sb2NrKCZkZXZfcHJpdi0+ZmJfdHJhY2tpbmcubG9jayk7Cj4gKwlpOTE1LT5mYl90
cmFja2luZy5idXN5X2JpdHMgJj0gfmZyb250YnVmZmVyX2JpdHM7Cj4gKwlzcGluX3VubG9jaygm
aTkxNS0+ZmJfdHJhY2tpbmcubG9jayk7Cj4gICAKPiAtCWludGVsX2Zyb250YnVmZmVyX2ZsdXNo
KGRldl9wcml2LCBmcm9udGJ1ZmZlcl9iaXRzLCBPUklHSU5fRkxJUCk7Cj4gKwlpbnRlbF9mcm9u
dGJ1ZmZlcl9mbHVzaChpOTE1LCBmcm9udGJ1ZmZlcl9iaXRzLCBPUklHSU5fRkxJUCk7Cj4gICB9
Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Zyb250YnVmZmVyLmgg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9mcm9udGJ1ZmZlci5oCj4gaW5kZXggNTcyNzMy
MGM4MDg0Li41NWM0MmVmZWU3Y2UgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfZnJvbnRidWZmZXIuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Zy
b250YnVmZmVyLmgKPiBAQCAtMzcsMTEgKzM3LDExIEBAIGVudW0gZmJfb3Bfb3JpZ2luIHsKPiAg
IAlPUklHSU5fRElSVFlGQiwKPiAgIH07Cj4gICAKPiAtdm9pZCBpbnRlbF9mcm9udGJ1ZmZlcl9m
bGlwX3ByZXBhcmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICt2b2lkIGlu
dGVsX2Zyb250YnVmZmVyX2ZsaXBfcHJlcGFyZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiAgIAkJCQkgICAgdW5zaWduZWQgZnJvbnRidWZmZXJfYml0cyk7Cj4gLXZvaWQgaW50ZWxf
ZnJvbnRidWZmZXJfZmxpcF9jb21wbGV0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gK3ZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmxpcF9jb21wbGV0ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAgIHVuc2lnbmVkIGZyb250YnVmZmVyX2JpdHMp
Owo+IC12b2lkIGludGVsX2Zyb250YnVmZmVyX2ZsaXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICt2b2lkIGludGVsX2Zyb250YnVmZmVyX2ZsaXAoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICAgdW5zaWduZWQgZnJvbnRidWZmZXJfYml0cyk7Cj4g
ICAKPiAgIHZvaWQgX19pbnRlbF9mYl9vYmpfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdCAqb2JqLAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9n
bWJ1cy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ21idXMuYwo+IGluZGV4IGFhODhl
NmU3Y2M2NS4uZjFiOTg0NGI1OTFlIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2dtYnVzLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9nbWJ1cy5j
Cj4gQEAgLTg5LDQyICs4OSw0MiBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGdtYnVzX3BpbiBnbWJ1
c19waW5zX2ljcFtdID0gewo+ICAgfTsKPiAgIAo+ICAgLyogcGluIGlzIGV4cGVjdGVkIHRvIGJl
IHZhbGlkICovCj4gLXN0YXRpYyBjb25zdCBzdHJ1Y3QgZ21idXNfcGluICpnZXRfZ21idXNfcGlu
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIGNvbnN0IHN0cnVj
dCBnbWJ1c19waW4gKmdldF9nbWJ1c19waW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gICAJCQkJCSAgICAgdW5zaWduZWQgaW50IHBpbikKPiAgIHsKPiAtCWlmIChIQVNfUENIX0lD
UChkZXZfcHJpdikpCj4gKwlpZiAoSEFTX1BDSF9JQ1AoaTkxNSkpCj4gICAJCXJldHVybiAmZ21i
dXNfcGluc19pY3BbcGluXTsKPiAtCWVsc2UgaWYgKEhBU19QQ0hfQ05QKGRldl9wcml2KSkKPiAr
CWVsc2UgaWYgKEhBU19QQ0hfQ05QKGk5MTUpKQo+ICAgCQlyZXR1cm4gJmdtYnVzX3BpbnNfY25w
W3Bpbl07Cj4gLQllbHNlIGlmIChJU19HRU45X0xQKGRldl9wcml2KSkKPiArCWVsc2UgaWYgKElT
X0dFTjlfTFAoaTkxNSkpCj4gICAJCXJldHVybiAmZ21idXNfcGluc19ieHRbcGluXTsKPiAtCWVs
c2UgaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAoSVNfR0VOOV9CQyhpOTE1
KSkKPiAgIAkJcmV0dXJuICZnbWJ1c19waW5zX3NrbFtwaW5dOwo+IC0JZWxzZSBpZiAoSVNfQlJP
QURXRUxMKGRldl9wcml2KSkKPiArCWVsc2UgaWYgKElTX0JST0FEV0VMTChpOTE1KSkKPiAgIAkJ
cmV0dXJuICZnbWJ1c19waW5zX2Jkd1twaW5dOwo+ICAgCWVsc2UKPiAgIAkJcmV0dXJuICZnbWJ1
c19waW5zW3Bpbl07Cj4gICB9Cj4gICAKPiAtYm9vbCBpbnRlbF9nbWJ1c19pc192YWxpZF9waW4o
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtib29sIGludGVsX2dtYnVzX2lz
X3ZhbGlkX3BpbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgIHVu
c2lnbmVkIGludCBwaW4pCj4gICB7Cj4gICAJdW5zaWduZWQgaW50IHNpemU7Cj4gICAKPiAtCWlm
IChIQVNfUENIX0lDUChkZXZfcHJpdikpCj4gKwlpZiAoSEFTX1BDSF9JQ1AoaTkxNSkpCj4gICAJ
CXNpemUgPSBBUlJBWV9TSVpFKGdtYnVzX3BpbnNfaWNwKTsKPiAtCWVsc2UgaWYgKEhBU19QQ0hf
Q05QKGRldl9wcml2KSkKPiArCWVsc2UgaWYgKEhBU19QQ0hfQ05QKGk5MTUpKQo+ICAgCQlzaXpl
ID0gQVJSQVlfU0laRShnbWJ1c19waW5zX2NucCk7Cj4gLQllbHNlIGlmIChJU19HRU45X0xQKGRl
dl9wcml2KSkKPiArCWVsc2UgaWYgKElTX0dFTjlfTFAoaTkxNSkpCj4gICAJCXNpemUgPSBBUlJB
WV9TSVpFKGdtYnVzX3BpbnNfYnh0KTsKPiAtCWVsc2UgaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYp
KQo+ICsJZWxzZSBpZiAoSVNfR0VOOV9CQyhpOTE1KSkKPiAgIAkJc2l6ZSA9IEFSUkFZX1NJWkUo
Z21idXNfcGluc19za2wpOwo+IC0JZWxzZSBpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSkKPiAr
CWVsc2UgaWYgKElTX0JST0FEV0VMTChpOTE1KSkKPiAgIAkJc2l6ZSA9IEFSUkFZX1NJWkUoZ21i
dXNfcGluc19iZHcpOwo+ICAgCWVsc2UKPiAgIAkJc2l6ZSA9IEFSUkFZX1NJWkUoZ21idXNfcGlu
cyk7Cj4gICAKPiAtCXJldHVybiBwaW4gPCBzaXplICYmIGdldF9nbWJ1c19waW4oZGV2X3ByaXYs
IHBpbiktPm5hbWU7Cj4gKwlyZXR1cm4gcGluIDwgc2l6ZSAmJiBnZXRfZ21idXNfcGluKGk5MTUs
IHBpbiktPm5hbWU7Cj4gICB9Cj4gICAKPiAgIC8qIEludGVsIEdQSU8gYWNjZXNzIGZ1bmN0aW9u
cyAqLwo+IEBAIC0xMzgsMTMgKzEzOCwxMyBAQCB0b19pbnRlbF9nbWJ1cyhzdHJ1Y3QgaTJjX2Fk
YXB0ZXIgKmkyYykKPiAgIH0KPiAgIAo+ICAgdm9pZAo+IC1pbnRlbF9nbWJ1c19yZXNldChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK2ludGVsX2dtYnVzX3Jlc2V0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCUk5MTVfV1JJVEUoR01CVVMwLCAw
KTsKPiAgIAlJOTE1X1dSSVRFKEdNQlVTNCwgMCk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQg
cG52X2dtYnVzX2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gK3N0YXRpYyB2b2lkIHBudl9nbWJ1c19jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gICAJCQkJICAgYm9vbCBlbmFibGUpCj4gICB7Cj4gICAJdTMyIHZhbDsK
PiBAQCAtMTU4LDcgKzE1OCw3IEBAIHN0YXRpYyB2b2lkIHBudl9nbWJ1c19jbG9ja19nYXRpbmco
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCUk5MTVfV1JJVEUoRFNQQ0xL
X0dBVEVfRCwgdmFsKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBwY2hfZ21idXNfY2xvY2tf
Z2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHZvaWQg
cGNoX2dtYnVzX2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAg
IAkJCQkgICBib29sIGVuYWJsZSkKPiAgIHsKPiAgIAl1MzIgdmFsOwo+IEBAIC0xNzEsNyArMTcx
LDcgQEAgc3RhdGljIHZvaWQgcGNoX2dtYnVzX2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJSTkxNV9XUklURShTT1VUSF9EU1BDTEtfR0FURV9ELCB2
YWwpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGJ4dF9nbWJ1c19jbG9ja19nYXRpbmcoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBieHRfZ21idXNf
Y2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgIGJv
b2wgZW5hYmxlKQo+ICAgewo+ICAgCXUzMiB2YWw7Cj4gQEAgLTE4Niw3ICsxODYsNyBAQCBzdGF0
aWMgdm9pZCBieHRfZ21idXNfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiAgIAo+ICAgc3RhdGljIHUzMiBnZXRfcmVzZXJ2ZWQoc3RydWN0IGludGVsX2dt
YnVzICpidXMpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGJ1cy0+
ZGV2X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGJ1cy0+aTkxNTsK
PiAgIAlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwo+ICAgCXUz
MiByZXNlcnZlZCA9IDA7Cj4gICAKPiBAQCAtMjAyLDcgKzIwMiw3IEBAIHN0YXRpYyB1MzIgZ2V0
X3Jlc2VydmVkKHN0cnVjdCBpbnRlbF9nbWJ1cyAqYnVzKQo+ICAgc3RhdGljIGludCBnZXRfY2xv
Y2sodm9pZCAqZGF0YSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZ21idXMgKmJ1cyA9IGRhdGE7
Cj4gLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmYnVzLT5kZXZfcHJpdi0+dW5jb3Jl
Owo+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmJ1cy0+aTkxNS0+dW5jb3JlOwo+
ICAgCXUzMiByZXNlcnZlZCA9IGdldF9yZXNlcnZlZChidXMpOwo+ICAgCj4gICAJaW50ZWxfdW5j
b3JlX3dyaXRlX25vdHJhY2UodW5jb3JlLAo+IEBAIC0yMTcsNyArMjE3LDcgQEAgc3RhdGljIGlu
dCBnZXRfY2xvY2sodm9pZCAqZGF0YSkKPiAgIHN0YXRpYyBpbnQgZ2V0X2RhdGEodm9pZCAqZGF0
YSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZ21idXMgKmJ1cyA9IGRhdGE7Cj4gLQlzdHJ1Y3Qg
aW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmYnVzLT5kZXZfcHJpdi0+dW5jb3JlOwo+ICsJc3RydWN0
IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmJ1cy0+aTkxNS0+dW5jb3JlOwo+ICAgCXUzMiByZXNl
cnZlZCA9IGdldF9yZXNlcnZlZChidXMpOwo+ICAgCj4gICAJaW50ZWxfdW5jb3JlX3dyaXRlX25v
dHJhY2UodW5jb3JlLAo+IEBAIC0yMzIsNyArMjMyLDcgQEAgc3RhdGljIGludCBnZXRfZGF0YSh2
b2lkICpkYXRhKQo+ICAgc3RhdGljIHZvaWQgc2V0X2Nsb2NrKHZvaWQgKmRhdGEsIGludCBzdGF0
ZV9oaWdoKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9nbWJ1cyAqYnVzID0gZGF0YTsKPiAtCXN0
cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZidXMtPmRldl9wcml2LT51bmNvcmU7Cj4gKwlz
dHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmYnVzLT5pOTE1LT51bmNvcmU7Cj4gICAJdTMy
IHJlc2VydmVkID0gZ2V0X3Jlc2VydmVkKGJ1cyk7Cj4gICAJdTMyIGNsb2NrX2JpdHM7Cj4gICAK
PiBAQCAtMjUxLDcgKzI1MSw3IEBAIHN0YXRpYyB2b2lkIHNldF9jbG9jayh2b2lkICpkYXRhLCBp
bnQgc3RhdGVfaGlnaCkKPiAgIHN0YXRpYyB2b2lkIHNldF9kYXRhKHZvaWQgKmRhdGEsIGludCBz
dGF0ZV9oaWdoKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9nbWJ1cyAqYnVzID0gZGF0YTsKPiAt
CXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZidXMtPmRldl9wcml2LT51bmNvcmU7Cj4g
KwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmYnVzLT5pOTE1LT51bmNvcmU7Cj4gICAJ
dTMyIHJlc2VydmVkID0gZ2V0X3Jlc2VydmVkKGJ1cyk7Cj4gICAJdTMyIGRhdGFfYml0czsKPiAg
IAo+IEBAIC0yNzEsMTIgKzI3MSwxMiBAQCBpbnRlbF9ncGlvX3ByZV94ZmVyKHN0cnVjdCBpMmNf
YWRhcHRlciAqYWRhcHRlcikKPiAgIAlzdHJ1Y3QgaW50ZWxfZ21idXMgKmJ1cyA9IGNvbnRhaW5l
cl9vZihhZGFwdGVyLAo+ICAgCQkJCQkgICAgICAgc3RydWN0IGludGVsX2dtYnVzLAo+ICAgCQkJ
CQkgICAgICAgYWRhcHRlcik7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSBidXMtPmRldl9wcml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBidXMt
Pmk5MTU7Cj4gICAKPiAtCWludGVsX2dtYnVzX3Jlc2V0KGRldl9wcml2KTsKPiArCWludGVsX2dt
YnVzX3Jlc2V0KGk5MTUpOwo+ICAgCj4gLQlpZiAoSVNfUElORVZJRVcoZGV2X3ByaXYpKQo+IC0J
CXBudl9nbWJ1c19jbG9ja19nYXRpbmcoZGV2X3ByaXYsIGZhbHNlKTsKPiArCWlmIChJU19QSU5F
VklFVyhpOTE1KSkKPiArCQlwbnZfZ21idXNfY2xvY2tfZ2F0aW5nKGk5MTUsIGZhbHNlKTsKPiAg
IAo+ICAgCXNldF9kYXRhKGJ1cywgMSk7Cj4gICAJc2V0X2Nsb2NrKGJ1cywgMSk7Cj4gQEAgLTI5
MCwyNCArMjkwLDI0IEBAIGludGVsX2dwaW9fcG9zdF94ZmVyKHN0cnVjdCBpMmNfYWRhcHRlciAq
YWRhcHRlcikKPiAgIAlzdHJ1Y3QgaW50ZWxfZ21idXMgKmJ1cyA9IGNvbnRhaW5lcl9vZihhZGFw
dGVyLAo+ICAgCQkJCQkgICAgICAgc3RydWN0IGludGVsX2dtYnVzLAo+ICAgCQkJCQkgICAgICAg
YWRhcHRlcik7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBidXMtPmRl
dl9wcml2Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBidXMtPmk5MTU7Cj4g
ICAKPiAgIAlzZXRfZGF0YShidXMsIDEpOwo+ICAgCXNldF9jbG9jayhidXMsIDEpOwo+ICAgCj4g
LQlpZiAoSVNfUElORVZJRVcoZGV2X3ByaXYpKQo+IC0JCXBudl9nbWJ1c19jbG9ja19nYXRpbmco
ZGV2X3ByaXYsIHRydWUpOwo+ICsJaWYgKElTX1BJTkVWSUVXKGk5MTUpKQo+ICsJCXBudl9nbWJ1
c19jbG9ja19nYXRpbmcoaTkxNSwgdHJ1ZSk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkCj4g
ICBpbnRlbF9ncGlvX3NldHVwKHN0cnVjdCBpbnRlbF9nbWJ1cyAqYnVzLCB1bnNpZ25lZCBpbnQg
cGluKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gYnVzLT5k
ZXZfcHJpdjsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYnVzLT5pOTE1Owo+
ICAgCXN0cnVjdCBpMmNfYWxnb19iaXRfZGF0YSAqYWxnbzsKPiAgIAo+ICAgCWFsZ28gPSAmYnVz
LT5iaXRfYWxnbzsKPiAgIAo+IC0JYnVzLT5ncGlvX3JlZyA9IEdQSU8oZ2V0X2dtYnVzX3Bpbihk
ZXZfcHJpdiwgcGluKS0+Z3Bpbyk7Cj4gKwlidXMtPmdwaW9fcmVnID0gR1BJTyhnZXRfZ21idXNf
cGluKGk5MTUsIHBpbiktPmdwaW8pOwo+ICAgCWJ1cy0+YWRhcHRlci5hbGdvX2RhdGEgPSBhbGdv
Owo+ICAgCWFsZ28tPnNldHNkYSA9IHNldF9kYXRhOwo+ICAgCWFsZ28tPnNldHNjbCA9IHNldF9j
bG9jazsKPiBAQCAtMzIwLDcgKzMyMCw3IEBAIGludGVsX2dwaW9fc2V0dXAoc3RydWN0IGludGVs
X2dtYnVzICpidXMsIHVuc2lnbmVkIGludCBwaW4pCj4gICAJYWxnby0+ZGF0YSA9IGJ1czsKPiAg
IH0KPiAgIAo+IC1zdGF0aWMgaW50IGdtYnVzX3dhaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LCB1MzIgc3RhdHVzLCB1MzIgaXJxX2VuKQo+ICtzdGF0aWMgaW50IGdtYnVzX3dh
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBzdGF0dXMsIHUzMiBpcnFfZW4p
Cj4gICB7Cj4gICAJREVGSU5FX1dBSVQod2FpdCk7Cj4gICAJdTMyIGdtYnVzMjsKPiBAQCAtMzMw
LDEwICszMzAsMTAgQEAgc3RhdGljIGludCBnbWJ1c193YWl0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwgdTMyIHN0YXR1cywgdTMyIGlycV9lbikKPiAgIAkgKiB3ZSBhbHNvIG5l
ZWQgdG8gY2hlY2sgZm9yIE5BS3MgYmVzaWRlcyB0aGUgaHcgcmVhZHkvaWRsZSBzaWduYWwsIHdl
Cj4gICAJICogbmVlZCB0byB3YWtlIHVwIHBlcmlvZGljYWxseSBhbmQgY2hlY2sgdGhhdCBvdXJz
ZWx2ZXMuCj4gICAJICovCj4gLQlpZiAoIUhBU19HTUJVU19JUlEoZGV2X3ByaXYpKQo+ICsJaWYg
KCFIQVNfR01CVVNfSVJRKGk5MTUpKQo+ICAgCQlpcnFfZW4gPSAwOwo+ICAgCj4gLQlhZGRfd2Fp
dF9xdWV1ZSgmZGV2X3ByaXYtPmdtYnVzX3dhaXRfcXVldWUsICZ3YWl0KTsKPiArCWFkZF93YWl0
X3F1ZXVlKCZpOTE1LT5nbWJ1c193YWl0X3F1ZXVlLCAmd2FpdCk7Cj4gICAJSTkxNV9XUklURV9G
VyhHTUJVUzQsIGlycV9lbik7Cj4gICAKPiAgIAlzdGF0dXMgfD0gR01CVVNfU0FUT0VSOwo+IEBA
IC0zNDIsNyArMzQyLDcgQEAgc3RhdGljIGludCBnbWJ1c193YWl0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwgdTMyIHN0YXR1cywgdTMyIGlycV9lbikKPiAgIAkJcmV0ID0gd2Fp
dF9mb3IoKGdtYnVzMiA9IEk5MTVfUkVBRF9GVyhHTUJVUzIpKSAmIHN0YXR1cywgNTApOwo+ICAg
Cj4gICAJSTkxNV9XUklURV9GVyhHTUJVUzQsIDApOwo+IC0JcmVtb3ZlX3dhaXRfcXVldWUoJmRl
dl9wcml2LT5nbWJ1c193YWl0X3F1ZXVlLCAmd2FpdCk7Cj4gKwlyZW1vdmVfd2FpdF9xdWV1ZSgm
aTkxNS0+Z21idXNfd2FpdF9xdWV1ZSwgJndhaXQpOwo+ICAgCj4gICAJaWYgKGdtYnVzMiAmIEdN
QlVTX1NBVE9FUikKPiAgIAkJcmV0dXJuIC1FTlhJTzsKPiBAQCAtMzUxLDcgKzM1MSw3IEBAIHN0
YXRpYyBpbnQgZ21idXNfd2FpdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUz
MiBzdGF0dXMsIHUzMiBpcnFfZW4pCj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQKPiAtZ21idXNf
d2FpdF9pZGxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArZ21idXNfd2Fp
dF9pZGxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCURFRklORV9X
QUlUKHdhaXQpOwo+ICAgCXUzMiBpcnFfZW5hYmxlOwo+IEBAIC0zNTksMzYgKzM1OSwzNiBAQCBn
bWJ1c193YWl0X2lkbGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCj4g
ICAJLyogSW1wb3J0YW50OiBUaGUgaHcgaGFuZGxlcyBvbmx5IHRoZSBmaXJzdCBiaXQsIHNvIHNl
dCBvbmx5IG9uZSEgKi8KPiAgIAlpcnFfZW5hYmxlID0gMDsKPiAtCWlmIChIQVNfR01CVVNfSVJR
KGRldl9wcml2KSkKPiArCWlmIChIQVNfR01CVVNfSVJRKGk5MTUpKQo+ICAgCQlpcnFfZW5hYmxl
ID0gR01CVVNfSURMRV9FTjsKPiAgIAo+IC0JYWRkX3dhaXRfcXVldWUoJmRldl9wcml2LT5nbWJ1
c193YWl0X3F1ZXVlLCAmd2FpdCk7Cj4gKwlhZGRfd2FpdF9xdWV1ZSgmaTkxNS0+Z21idXNfd2Fp
dF9xdWV1ZSwgJndhaXQpOwo+ICAgCUk5MTVfV1JJVEVfRlcoR01CVVM0LCBpcnFfZW5hYmxlKTsK
PiAgIAo+IC0JcmV0ID0gaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXJfZncoJmRldl9wcml2LT51bmNv
cmUsCj4gKwlyZXQgPSBpbnRlbF93YWl0X2Zvcl9yZWdpc3Rlcl9mdygmaTkxNS0+dW5jb3JlLAo+
ICAgCQkJCQkgR01CVVMyLCBHTUJVU19BQ1RJVkUsIDAsCj4gICAJCQkJCSAxMCk7Cj4gICAKPiAg
IAlJOTE1X1dSSVRFX0ZXKEdNQlVTNCwgMCk7Cj4gLQlyZW1vdmVfd2FpdF9xdWV1ZSgmZGV2X3By
aXYtPmdtYnVzX3dhaXRfcXVldWUsICZ3YWl0KTsKPiArCXJlbW92ZV93YWl0X3F1ZXVlKCZpOTE1
LT5nbWJ1c193YWl0X3F1ZXVlLCAmd2FpdCk7Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+
ICAgCj4gICBzdGF0aWMgaW5saW5lCj4gLXVuc2lnbmVkIGludCBnbWJ1c19tYXhfeGZlcl9zaXpl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdW5zaWduZWQgaW50IGdtYnVz
X21heF94ZmVyX3NpemUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQly
ZXR1cm4gSU5URUxfR0VOKGRldl9wcml2KSA+PSA5ID8gR0VOOV9HTUJVU19CWVRFX0NPVU5UX01B
WCA6Cj4gKwlyZXR1cm4gSU5URUxfR0VOKGk5MTUpID49IDkgPyBHRU45X0dNQlVTX0JZVEVfQ09V
TlRfTUFYIDoKPiAgIAkgICAgICAgR01CVVNfQllURV9DT1VOVF9NQVg7Cj4gICB9Cj4gICAKPiAg
IHN0YXRpYyBpbnQKPiAtZ21idXNfeGZlcl9yZWFkX2NodW5rKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiArZ21idXNfeGZlcl9yZWFkX2NodW5rKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAo+ICAgCQkgICAgICB1bnNpZ25lZCBzaG9ydCBhZGRyLCB1OCAqYnVmLCB1
bnNpZ25lZCBpbnQgbGVuLAo+ICAgCQkgICAgICB1MzIgZ21idXMwX3JlZywgdTMyIGdtYnVzMV9p
bmRleCkKPiAgIHsKPiAgIAl1bnNpZ25lZCBpbnQgc2l6ZSA9IGxlbjsKPiAtCWJvb2wgYnVyc3Rf
cmVhZCA9IGxlbiA+IGdtYnVzX21heF94ZmVyX3NpemUoZGV2X3ByaXYpOwo+ICsJYm9vbCBidXJz
dF9yZWFkID0gbGVuID4gZ21idXNfbWF4X3hmZXJfc2l6ZShpOTE1KTsKPiAgIAlib29sIGV4dHJh
X2J5dGVfYWRkZWQgPSBmYWxzZTsKPiAgIAo+ICAgCWlmIChidXJzdF9yZWFkKSB7Cj4gQEAgLTQx
NCw3ICs0MTQsNyBAQCBnbWJ1c194ZmVyX3JlYWRfY2h1bmsoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ICAgCQlpbnQgcmV0Owo+ICAgCQl1MzIgdmFsLCBsb29wID0gMDsKPiAg
IAo+IC0JCXJldCA9IGdtYnVzX3dhaXQoZGV2X3ByaXYsIEdNQlVTX0hXX1JEWSwgR01CVVNfSFdf
UkRZX0VOKTsKPiArCQlyZXQgPSBnbWJ1c193YWl0KGk5MTUsIEdNQlVTX0hXX1JEWSwgR01CVVNf
SFdfUkRZX0VOKTsKPiAgIAkJaWYgKHJldCkKPiAgIAkJCXJldHVybiByZXQ7Cj4gICAKPiBAQCAt
NDQ2LDcgKzQ0Niw3IEBAIGdtYnVzX3hmZXJfcmVhZF9jaHVuayhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gICAjZGVmaW5lIElOVEVMX0dNQlVTX0JVUlNUX1JFQURfTUFYX0xF
TgkJNzY3VQo+ICAgCj4gICBzdGF0aWMgaW50Cj4gLWdtYnVzX3hmZXJfcmVhZChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHN0cnVjdCBpMmNfbXNnICptc2csCj4gK2dtYnVzX3hm
ZXJfcmVhZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgc3RydWN0IGkyY19tc2cgKm1z
ZywKPiAgIAkJdTMyIGdtYnVzMF9yZWcsIHUzMiBnbWJ1czFfaW5kZXgpCj4gICB7Cj4gICAJdTgg
KmJ1ZiA9IG1zZy0+YnVmOwo+IEBAIC00NTUsMTIgKzQ1NSwxMiBAQCBnbWJ1c194ZmVyX3JlYWQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBzdHJ1Y3QgaTJjX21zZyAqbXNnLAo+
ICAgCWludCByZXQ7Cj4gICAKPiAgIAlkbyB7Cj4gLQkJaWYgKEhBU19HTUJVU19CVVJTVF9SRUFE
KGRldl9wcml2KSkKPiArCQlpZiAoSEFTX0dNQlVTX0JVUlNUX1JFQUQoaTkxNSkpCj4gICAJCQls
ZW4gPSBtaW4ocnhfc2l6ZSwgSU5URUxfR01CVVNfQlVSU1RfUkVBRF9NQVhfTEVOKTsKPiAgIAkJ
ZWxzZQo+IC0JCQlsZW4gPSBtaW4ocnhfc2l6ZSwgZ21idXNfbWF4X3hmZXJfc2l6ZShkZXZfcHJp
dikpOwo+ICsJCQlsZW4gPSBtaW4ocnhfc2l6ZSwgZ21idXNfbWF4X3hmZXJfc2l6ZShpOTE1KSk7
Cj4gICAKPiAtCQlyZXQgPSBnbWJ1c194ZmVyX3JlYWRfY2h1bmsoZGV2X3ByaXYsIG1zZy0+YWRk
ciwgYnVmLCBsZW4sCj4gKwkJcmV0ID0gZ21idXNfeGZlcl9yZWFkX2NodW5rKGk5MTUsIG1zZy0+
YWRkciwgYnVmLCBsZW4sCj4gICAJCQkJCSAgICBnbWJ1czBfcmVnLCBnbWJ1czFfaW5kZXgpOwo+
ICAgCQlpZiAocmV0KQo+ICAgCQkJcmV0dXJuIHJldDsKPiBAQCAtNDczLDcgKzQ3Myw3IEBAIGdt
YnVzX3hmZXJfcmVhZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHN0cnVjdCBp
MmNfbXNnICptc2csCj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQKPiAtZ21idXNfeGZlcl93cml0
ZV9jaHVuayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2dtYnVzX3hmZXJf
d3JpdGVfY2h1bmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCSAgICAgICB1
bnNpZ25lZCBzaG9ydCBhZGRyLCB1OCAqYnVmLCB1bnNpZ25lZCBpbnQgbGVuLAo+ICAgCQkgICAg
ICAgdTMyIGdtYnVzMV9pbmRleCkKPiAgIHsKPiBAQCAtNTAyLDcgKzUwMiw3IEBAIGdtYnVzX3hm
ZXJfd3JpdGVfY2h1bmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCj4g
ICAJCUk5MTVfV1JJVEVfRlcoR01CVVMzLCB2YWwpOwo+ICAgCj4gLQkJcmV0ID0gZ21idXNfd2Fp
dChkZXZfcHJpdiwgR01CVVNfSFdfUkRZLCBHTUJVU19IV19SRFlfRU4pOwo+ICsJCXJldCA9IGdt
YnVzX3dhaXQoaTkxNSwgR01CVVNfSFdfUkRZLCBHTUJVU19IV19SRFlfRU4pOwo+ICAgCQlpZiAo
cmV0KQo+ICAgCQkJcmV0dXJuIHJldDsKPiAgIAl9Cj4gQEAgLTUxMSw3ICs1MTEsNyBAQCBnbWJ1
c194ZmVyX3dyaXRlX2NodW5rKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAg
IH0KPiAgIAo+ICAgc3RhdGljIGludAo+IC1nbWJ1c194ZmVyX3dyaXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwgc3RydWN0IGkyY19tc2cgKm1zZywKPiArZ21idXNfeGZlcl93
cml0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgc3RydWN0IGkyY19tc2cgKm1zZywK
PiAgIAkJIHUzMiBnbWJ1czFfaW5kZXgpCj4gICB7Cj4gICAJdTggKmJ1ZiA9IG1zZy0+YnVmOwo+
IEBAIC01MjAsOSArNTIwLDkgQEAgZ21idXNfeGZlcl93cml0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsIHN0cnVjdCBpMmNfbXNnICptc2csCj4gICAJaW50IHJldDsKPiAgIAo+
ICAgCWRvIHsKPiAtCQlsZW4gPSBtaW4odHhfc2l6ZSwgZ21idXNfbWF4X3hmZXJfc2l6ZShkZXZf
cHJpdikpOwo+ICsJCWxlbiA9IG1pbih0eF9zaXplLCBnbWJ1c19tYXhfeGZlcl9zaXplKGk5MTUp
KTsKPiAgIAo+IC0JCXJldCA9IGdtYnVzX3hmZXJfd3JpdGVfY2h1bmsoZGV2X3ByaXYsIG1zZy0+
YWRkciwgYnVmLCBsZW4sCj4gKwkJcmV0ID0gZ21idXNfeGZlcl93cml0ZV9jaHVuayhpOTE1LCBt
c2ctPmFkZHIsIGJ1ZiwgbGVuLAo+ICAgCQkJCQkgICAgIGdtYnVzMV9pbmRleCk7Cj4gICAJCWlm
IChyZXQpCj4gICAJCQlyZXR1cm4gcmV0Owo+IEBAIC01NDksNyArNTQ5LDcgQEAgZ21idXNfaXNf
aW5kZXhfeGZlcihzdHJ1Y3QgaTJjX21zZyAqbXNncywgaW50IGksIGludCBudW0pCj4gICB9Cj4g
ICAKPiAgIHN0YXRpYyBpbnQKPiAtZ21idXNfaW5kZXhfeGZlcihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsIHN0cnVjdCBpMmNfbXNnICptc2dzLAo+ICtnbWJ1c19pbmRleF94ZmVy
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBzdHJ1Y3QgaTJjX21zZyAqbXNncywKPiAg
IAkJIHUzMiBnbWJ1czBfcmVnKQo+ICAgewo+ICAgCXUzMiBnbWJ1czFfaW5kZXggPSAwOwo+IEBA
IC01NjgsMTAgKzU2OCwxMCBAQCBnbWJ1c19pbmRleF94ZmVyKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwgc3RydWN0IGkyY19tc2cgKm1zZ3MsCj4gICAJCUk5MTVfV1JJVEVfRlco
R01CVVM1LCBnbWJ1czUpOwo+ICAgCj4gICAJaWYgKG1zZ3NbMV0uZmxhZ3MgJiBJMkNfTV9SRCkK
PiAtCQlyZXQgPSBnbWJ1c194ZmVyX3JlYWQoZGV2X3ByaXYsICZtc2dzWzFdLCBnbWJ1czBfcmVn
LAo+ICsJCXJldCA9IGdtYnVzX3hmZXJfcmVhZChpOTE1LCAmbXNnc1sxXSwgZ21idXMwX3JlZywK
PiAgIAkJCQkgICAgICBnbWJ1czFfaW5kZXgpOwo+ICAgCWVsc2UKPiAtCQlyZXQgPSBnbWJ1c194
ZmVyX3dyaXRlKGRldl9wcml2LCAmbXNnc1sxXSwgZ21idXMxX2luZGV4KTsKPiArCQlyZXQgPSBn
bWJ1c194ZmVyX3dyaXRlKGk5MTUsICZtc2dzWzFdLCBnbWJ1czFfaW5kZXgpOwo+ICAgCj4gICAJ
LyogQ2xlYXIgR01CVVM1IGFmdGVyIGVhY2ggaW5kZXggdHJhbnNmZXIgKi8KPiAgIAlpZiAoZ21i
dXM1KQo+IEBAIC01ODcsMTUgKzU4NywxNSBAQCBkb19nbWJ1c194ZmVyKHN0cnVjdCBpMmNfYWRh
cHRlciAqYWRhcHRlciwgc3RydWN0IGkyY19tc2cgKm1zZ3MsIGludCBudW0sCj4gICAJc3RydWN0
IGludGVsX2dtYnVzICpidXMgPSBjb250YWluZXJfb2YoYWRhcHRlciwKPiAgIAkJCQkJICAgICAg
IHN0cnVjdCBpbnRlbF9nbWJ1cywKPiAgIAkJCQkJICAgICAgIGFkYXB0ZXIpOwo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gYnVzLT5kZXZfcHJpdjsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gYnVzLT5pOTE1Owo+ICAgCWludCBpID0gMCwgaW5jLCB0
cnkgPSAwOwo+ICAgCWludCByZXQgPSAwOwo+ICAgCj4gICAJLyogRGlzcGxheSBXQSAjMDg2ODog
c2tsLGJ4dCxrYmwsY2ZsLGdsayxjbmwgKi8KPiAtCWlmIChJU19HRU45X0xQKGRldl9wcml2KSkK
PiAtCQlieHRfZ21idXNfY2xvY2tfZ2F0aW5nKGRldl9wcml2LCBmYWxzZSk7Cj4gLQllbHNlIGlm
IChIQVNfUENIX1NQVChkZXZfcHJpdikgfHwgSEFTX1BDSF9DTlAoZGV2X3ByaXYpKQo+IC0JCXBj
aF9nbWJ1c19jbG9ja19nYXRpbmcoZGV2X3ByaXYsIGZhbHNlKTsKPiArCWlmIChJU19HRU45X0xQ
KGk5MTUpKQo+ICsJCWJ4dF9nbWJ1c19jbG9ja19nYXRpbmcoaTkxNSwgZmFsc2UpOwo+ICsJZWxz
ZSBpZiAoSEFTX1BDSF9TUFQoaTkxNSkgfHwgSEFTX1BDSF9DTlAoaTkxNSkpCj4gKwkJcGNoX2dt
YnVzX2Nsb2NrX2dhdGluZyhpOTE1LCBmYWxzZSk7Cj4gICAKPiAgIHJldHJ5Ogo+ICAgCUk5MTVf
V1JJVEVfRlcoR01CVVMwLCBnbWJ1czBfc291cmNlIHwgYnVzLT5yZWcwKTsKPiBAQCAtNjAzLDE4
ICs2MDMsMTggQEAgZG9fZ21idXNfeGZlcihzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIsIHN0
cnVjdCBpMmNfbXNnICptc2dzLCBpbnQgbnVtLAo+ICAgCWZvciAoOyBpIDwgbnVtOyBpICs9IGlu
Yykgewo+ICAgCQlpbmMgPSAxOwo+ICAgCQlpZiAoZ21idXNfaXNfaW5kZXhfeGZlcihtc2dzLCBp
LCBudW0pKSB7Cj4gLQkJCXJldCA9IGdtYnVzX2luZGV4X3hmZXIoZGV2X3ByaXYsICZtc2dzW2ld
LAo+ICsJCQlyZXQgPSBnbWJ1c19pbmRleF94ZmVyKGk5MTUsICZtc2dzW2ldLAo+ICAgCQkJCQkg
ICAgICAgZ21idXMwX3NvdXJjZSB8IGJ1cy0+cmVnMCk7Cj4gICAJCQlpbmMgPSAyOyAvKiBhbiBp
bmRleCB0cmFuc21pc3Npb24gaXMgdHdvIG1zZ3MgKi8KPiAgIAkJfSBlbHNlIGlmIChtc2dzW2ld
LmZsYWdzICYgSTJDX01fUkQpIHsKPiAtCQkJcmV0ID0gZ21idXNfeGZlcl9yZWFkKGRldl9wcml2
LCAmbXNnc1tpXSwKPiArCQkJcmV0ID0gZ21idXNfeGZlcl9yZWFkKGk5MTUsICZtc2dzW2ldLAo+
ICAgCQkJCQkgICAgICBnbWJ1czBfc291cmNlIHwgYnVzLT5yZWcwLCAwKTsKPiAgIAkJfSBlbHNl
IHsKPiAtCQkJcmV0ID0gZ21idXNfeGZlcl93cml0ZShkZXZfcHJpdiwgJm1zZ3NbaV0sIDApOwo+
ICsJCQlyZXQgPSBnbWJ1c194ZmVyX3dyaXRlKGk5MTUsICZtc2dzW2ldLCAwKTsKPiAgIAkJfQo+
ICAgCj4gICAJCWlmICghcmV0KQo+IC0JCQlyZXQgPSBnbWJ1c193YWl0KGRldl9wcml2LAo+ICsJ
CQlyZXQgPSBnbWJ1c193YWl0KGk5MTUsCj4gICAJCQkJCSBHTUJVU19IV19XQUlUX1BIQVNFLCBH
TUJVU19IV19XQUlUX0VOKTsKPiAgIAkJaWYgKHJldCA9PSAtRVRJTUVET1VUKQo+ICAgCQkJZ290
byB0aW1lb3V0Owo+IEBAIC02MzIsNyArNjMyLDcgQEAgZG9fZ21idXNfeGZlcihzdHJ1Y3QgaTJj
X2FkYXB0ZXIgKmFkYXB0ZXIsIHN0cnVjdCBpMmNfbXNnICptc2dzLCBpbnQgbnVtLAo+ICAgCSAq
IFdlIHdpbGwgcmUtZW5hYmxlIGl0IGF0IHRoZSBzdGFydCBvZiB0aGUgbmV4dCB4ZmVyLAo+ICAg
CSAqIHRpbGwgdGhlbiBsZXQgaXQgc2xlZXAuCj4gICAJICovCj4gLQlpZiAoZ21idXNfd2FpdF9p
ZGxlKGRldl9wcml2KSkgewo+ICsJaWYgKGdtYnVzX3dhaXRfaWRsZShpOTE1KSkgewo+ICAgCQlE
Uk1fREVCVUdfS01TKCJHTUJVUyBbJXNdIHRpbWVkIG91dCB3YWl0aW5nIGZvciBpZGxlXG4iLAo+
ICAgCQkJIGFkYXB0ZXItPm5hbWUpOwo+ICAgCQlyZXQgPSAtRVRJTUVET1VUOwo+IEBAIC02NTYs
NyArNjU2LDcgQEAgZG9fZ21idXNfeGZlcihzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIsIHN0
cnVjdCBpMmNfbXNnICptc2dzLCBpbnQgbnVtLAo+ICAgCSAqIGl0J3Mgc2xvdyByZXNwb25kaW5n
IGFuZCBvbmx5IGFuc3dlcnMgb24gdGhlIDJuZCByZXRyeS4KPiAgIAkgKi8KPiAgIAlyZXQgPSAt
RU5YSU87Cj4gLQlpZiAoZ21idXNfd2FpdF9pZGxlKGRldl9wcml2KSkgewo+ICsJaWYgKGdtYnVz
X3dhaXRfaWRsZShpOTE1KSkgewo+ICAgCQlEUk1fREVCVUdfS01TKCJHTUJVUyBbJXNdIHRpbWVk
IG91dCBhZnRlciBOQUtcbiIsCj4gICAJCQkgICAgICBhZGFwdGVyLT5uYW1lKTsKPiAgIAkJcmV0
ID0gLUVUSU1FRE9VVDsKPiBAQCAtNzAxLDEwICs3MDEsMTAgQEAgZG9fZ21idXNfeGZlcihzdHJ1
Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIsIHN0cnVjdCBpMmNfbXNnICptc2dzLCBpbnQgbnVtLAo+
ICAgCj4gICBvdXQ6Cj4gICAJLyogRGlzcGxheSBXQSAjMDg2ODogc2tsLGJ4dCxrYmwsY2ZsLGds
ayxjbmwgKi8KPiAtCWlmIChJU19HRU45X0xQKGRldl9wcml2KSkKPiAtCQlieHRfZ21idXNfY2xv
Y2tfZ2F0aW5nKGRldl9wcml2LCB0cnVlKTsKPiAtCWVsc2UgaWYgKEhBU19QQ0hfU1BUKGRldl9w
cml2KSB8fCBIQVNfUENIX0NOUChkZXZfcHJpdikpCj4gLQkJcGNoX2dtYnVzX2Nsb2NrX2dhdGlu
ZyhkZXZfcHJpdiwgdHJ1ZSk7Cj4gKwlpZiAoSVNfR0VOOV9MUChpOTE1KSkKPiArCQlieHRfZ21i
dXNfY2xvY2tfZ2F0aW5nKGk5MTUsIHRydWUpOwo+ICsJZWxzZSBpZiAoSEFTX1BDSF9TUFQoaTkx
NSkgfHwgSEFTX1BDSF9DTlAoaTkxNSkpCj4gKwkJcGNoX2dtYnVzX2Nsb2NrX2dhdGluZyhpOTE1
LCB0cnVlKTsKPiAgIAo+ICAgCXJldHVybiByZXQ7Cj4gICB9Cj4gQEAgLTcxNCwxMSArNzE0LDEx
IEBAIGdtYnVzX3hmZXIoc3RydWN0IGkyY19hZGFwdGVyICphZGFwdGVyLCBzdHJ1Y3QgaTJjX21z
ZyAqbXNncywgaW50IG51bSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZ21idXMgKmJ1cyA9Cj4g
ICAJCWNvbnRhaW5lcl9vZihhZGFwdGVyLCBzdHJ1Y3QgaW50ZWxfZ21idXMsIGFkYXB0ZXIpOwo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gYnVzLT5kZXZfcHJpdjsKPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYnVzLT5pOTE1Owo+ICAgCWludGVsX3dh
a2VyZWZfdCB3YWtlcmVmOwo+ICAgCWludCByZXQ7Cj4gICAKPiAtCXdha2VyZWYgPSBpbnRlbF9k
aXNwbGF5X3Bvd2VyX2dldChkZXZfcHJpdiwgUE9XRVJfRE9NQUlOX0dNQlVTKTsKPiArCXdha2Vy
ZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChpOTE1LCBQT1dFUl9ET01BSU5fR01CVVMpOwo+
ICAgCj4gICAJaWYgKGJ1cy0+Zm9yY2VfYml0KSB7Cj4gICAJCXJldCA9IGkyY19iaXRfYWxnby5t
YXN0ZXJfeGZlcihhZGFwdGVyLCBtc2dzLCBudW0pOwo+IEBAIC03MzAsNyArNzMwLDcgQEAgZ21i
dXNfeGZlcihzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIsIHN0cnVjdCBpMmNfbXNnICptc2dz
LCBpbnQgbnVtKQo+ICAgCQkJYnVzLT5mb3JjZV9iaXQgfD0gR01CVVNfRk9SQ0VfQklUX1JFVFJZ
Owo+ICAgCX0KPiAgIAo+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIFBPV0VS
X0RPTUFJTl9HTUJVUywgd2FrZXJlZik7Cj4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChpOTE1
LCBQT1dFUl9ET01BSU5fR01CVVMsIHdha2VyZWYpOwo+ICAgCj4gICAJcmV0dXJuIHJldDsKPiAg
IH0KPiBAQCAtNzM5LDcgKzczOSw3IEBAIGludCBpbnRlbF9nbWJ1c19vdXRwdXRfYWtzdihzdHJ1
Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2dtYnVzICpi
dXMgPQo+ICAgCQljb250YWluZXJfb2YoYWRhcHRlciwgc3RydWN0IGludGVsX2dtYnVzLCBhZGFw
dGVyKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGJ1cy0+ZGV2X3By
aXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGJ1cy0+aTkxNTsKPiAgIAl1
OCBjbWQgPSBEUk1fSERDUF9ERENfQUtTVjsKPiAgIAl1OCBidWZbRFJNX0hEQ1BfS1NWX0xFTl0g
PSB7IDAgfTsKPiAgIAlzdHJ1Y3QgaTJjX21zZyBtc2dzW10gPSB7Cj4gQEAgLTc1OSw4ICs3NTks
OCBAQCBpbnQgaW50ZWxfZ21idXNfb3V0cHV0X2Frc3Yoc3RydWN0IGkyY19hZGFwdGVyICphZGFw
dGVyKQo+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICAgCWludCByZXQ7Cj4gICAKPiAt
CXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChkZXZfcHJpdiwgUE9XRVJfRE9NQUlO
X0dNQlVTKTsKPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5nbWJ1c19tdXRleCk7Cj4gKwl3YWtl
cmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoaTkxNSwgUE9XRVJfRE9NQUlOX0dNQlVTKTsK
PiArCW11dGV4X2xvY2soJmk5MTUtPmdtYnVzX211dGV4KTsKPiAgIAo+ICAgCS8qCj4gICAJICog
SW4gb3JkZXIgdG8gb3V0cHV0IEFrc3YgdG8gdGhlIHJlY2VpdmVyLCB1c2UgYW4gaW5kZXhlZCB3
cml0ZSB0bwo+IEBAIC03NjksOCArNzY5LDggQEAgaW50IGludGVsX2dtYnVzX291dHB1dF9ha3N2
KHN0cnVjdCBpMmNfYWRhcHRlciAqYWRhcHRlcikKPiAgIAkgKi8KPiAgIAlyZXQgPSBkb19nbWJ1
c194ZmVyKGFkYXB0ZXIsIG1zZ3MsIEFSUkFZX1NJWkUobXNncyksIEdNQlVTX0FLU1ZfU0VMRUNU
KTsKPiAgIAo+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+Z21idXNfbXV0ZXgpOwo+IC0JaW50
ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9HTUJVUywgd2FrZXJl
Zik7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPmdtYnVzX211dGV4KTsKPiArCWludGVsX2Rpc3Bs
YXlfcG93ZXJfcHV0KGk5MTUsIFBPV0VSX0RPTUFJTl9HTUJVUywgd2FrZXJlZik7Cj4gICAKPiAg
IAlyZXR1cm4gcmV0Owo+ICAgfQo+IEBAIC03OTMsMjcgKzc5MywyNyBAQCBzdGF0aWMgdm9pZCBn
bWJ1c19sb2NrX2J1cyhzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIsCj4gICAJCQkgICB1bnNp
Z25lZCBpbnQgZmxhZ3MpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2dtYnVzICpidXMgPSB0b19p
bnRlbF9nbWJ1cyhhZGFwdGVyKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IGJ1cy0+ZGV2X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGJ1
cy0+aTkxNTsKPiAgIAo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmdtYnVzX211dGV4KTsKPiAr
CW11dGV4X2xvY2soJmk5MTUtPmdtYnVzX211dGV4KTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGlu
dCBnbWJ1c190cnlsb2NrX2J1cyhzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIsCj4gICAJCQkg
ICAgIHVuc2lnbmVkIGludCBmbGFncykKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZ21idXMgKmJ1
cyA9IHRvX2ludGVsX2dtYnVzKGFkYXB0ZXIpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gYnVzLT5kZXZfcHJpdjsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gYnVzLT5pOTE1Owo+ICAgCj4gLQlyZXR1cm4gbXV0ZXhfdHJ5bG9jaygmZGV2X3ByaXYt
PmdtYnVzX211dGV4KTsKPiArCXJldHVybiBtdXRleF90cnlsb2NrKCZpOTE1LT5nbWJ1c19tdXRl
eCk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIGdtYnVzX3VubG9ja19idXMoc3RydWN0IGky
Y19hZGFwdGVyICphZGFwdGVyLAo+ICAgCQkJICAgICB1bnNpZ25lZCBpbnQgZmxhZ3MpCj4gICB7
Cj4gICAJc3RydWN0IGludGVsX2dtYnVzICpidXMgPSB0b19pbnRlbF9nbWJ1cyhhZGFwdGVyKTsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGJ1cy0+ZGV2X3ByaXY7Cj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGJ1cy0+aTkxNTsKPiAgIAo+IC0JbXV0
ZXhfdW5sb2NrKCZkZXZfcHJpdi0+Z21idXNfbXV0ZXgpOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1
LT5nbWJ1c19tdXRleCk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaTJjX2xv
Y2tfb3BlcmF0aW9ucyBnbWJ1c19sb2NrX29wcyA9IHsKPiBAQCAtODI0LDQ1ICs4MjQsNDUgQEAg
c3RhdGljIGNvbnN0IHN0cnVjdCBpMmNfbG9ja19vcGVyYXRpb25zIGdtYnVzX2xvY2tfb3BzID0g
ewo+ICAgCj4gICAvKioKPiAgICAqIGludGVsX2dtYnVzX3NldHVwIC0gaW5zdGFudGlhdGUgYWxs
IEludGVsIGkyYyBHTUJ1c2VzCj4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgcHJpdmF0ZQo+
ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UgcHJpdmF0ZQo+ICAgICovCj4gLWludCBpbnRlbF9nbWJ1
c19zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK2ludCBpbnRlbF9n
bWJ1c19zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVj
dCBwY2lfZGV2ICpwZGV2ID0gZGV2X3ByaXYtPmRybS5wZGV2Owo+ICsJc3RydWN0IHBjaV9kZXYg
KnBkZXYgPSBpOTE1LT5kcm0ucGRldjsKPiAgIAlzdHJ1Y3QgaW50ZWxfZ21idXMgKmJ1czsKPiAg
IAl1bnNpZ25lZCBpbnQgcGluOwo+ICAgCWludCByZXQ7Cj4gICAKPiAtCWlmICghSEFTX0RJU1BM
QVkoZGV2X3ByaXYpKQo+ICsJaWYgKCFIQVNfRElTUExBWShpOTE1KSkKPiAgIAkJcmV0dXJuIDA7
Cj4gICAKPiAtCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRl
dl9wcml2KSkKPiAtCQlkZXZfcHJpdi0+Z3Bpb19tbWlvX2Jhc2UgPSBWTFZfRElTUExBWV9CQVNF
Owo+IC0JZWxzZSBpZiAoIUhBU19HTUNIKGRldl9wcml2KSkKPiArCWlmIChJU19WQUxMRVlWSUVX
KGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gKwkJaTkxNS0+Z3Bpb19tbWlvX2Jhc2Ug
PSBWTFZfRElTUExBWV9CQVNFOwo+ICsJZWxzZSBpZiAoIUhBU19HTUNIKGk5MTUpKQo+ICAgCQkv
Kgo+ICAgCQkgKiBCcm94dG9uIHVzZXMgdGhlIHNhbWUgUENIIG9mZnNldHMgZm9yIFNvdXRoIERp
c3BsYXkgRW5naW5lLAo+ICAgCQkgKiBldmVuIHRob3VnaCBpdCBkb2Vzbid0IGhhdmUgYSBQQ0gu
Cj4gICAJCSAqLwo+IC0JCWRldl9wcml2LT5ncGlvX21taW9fYmFzZSA9IFBDSF9ESVNQTEFZX0JB
U0U7Cj4gKwkJaTkxNS0+Z3Bpb19tbWlvX2Jhc2UgPSBQQ0hfRElTUExBWV9CQVNFOwo+ICAgCj4g
LQltdXRleF9pbml0KCZkZXZfcHJpdi0+Z21idXNfbXV0ZXgpOwo+IC0JaW5pdF93YWl0cXVldWVf
aGVhZCgmZGV2X3ByaXYtPmdtYnVzX3dhaXRfcXVldWUpOwo+ICsJbXV0ZXhfaW5pdCgmaTkxNS0+
Z21idXNfbXV0ZXgpOwo+ICsJaW5pdF93YWl0cXVldWVfaGVhZCgmaTkxNS0+Z21idXNfd2FpdF9x
dWV1ZSk7Cj4gICAKPiAtCWZvciAocGluID0gMDsgcGluIDwgQVJSQVlfU0laRShkZXZfcHJpdi0+
Z21idXMpOyBwaW4rKykgewo+IC0JCWlmICghaW50ZWxfZ21idXNfaXNfdmFsaWRfcGluKGRldl9w
cml2LCBwaW4pKQo+ICsJZm9yIChwaW4gPSAwOyBwaW4gPCBBUlJBWV9TSVpFKGk5MTUtPmdtYnVz
KTsgcGluKyspIHsKPiArCQlpZiAoIWludGVsX2dtYnVzX2lzX3ZhbGlkX3BpbihpOTE1LCBwaW4p
KQo+ICAgCQkJY29udGludWU7Cj4gICAKPiAtCQlidXMgPSAmZGV2X3ByaXYtPmdtYnVzW3Bpbl07
Cj4gKwkJYnVzID0gJmk5MTUtPmdtYnVzW3Bpbl07Cj4gICAKPiAgIAkJYnVzLT5hZGFwdGVyLm93
bmVyID0gVEhJU19NT0RVTEU7Cj4gICAJCWJ1cy0+YWRhcHRlci5jbGFzcyA9IEkyQ19DTEFTU19E
REM7Cj4gICAJCXNucHJpbnRmKGJ1cy0+YWRhcHRlci5uYW1lLAo+ICAgCQkJIHNpemVvZihidXMt
PmFkYXB0ZXIubmFtZSksCj4gICAJCQkgImk5MTUgZ21idXMgJXMiLAo+IC0JCQkgZ2V0X2dtYnVz
X3BpbihkZXZfcHJpdiwgcGluKS0+bmFtZSk7Cj4gKwkJCSBnZXRfZ21idXNfcGluKGk5MTUsIHBp
biktPm5hbWUpOwo+ICAgCj4gICAJCWJ1cy0+YWRhcHRlci5kZXYucGFyZW50ID0gJnBkZXYtPmRl
djsKPiAtCQlidXMtPmRldl9wcml2ID0gZGV2X3ByaXY7Cj4gKwkJYnVzLT5pOTE1ID0gaTkxNTsK
PiAgIAo+ICAgCQlidXMtPmFkYXB0ZXIuYWxnbyA9ICZnbWJ1c19hbGdvcml0aG07Cj4gICAJCWJ1
cy0+YWRhcHRlci5sb2NrX29wcyA9ICZnbWJ1c19sb2NrX29wczsKPiBAQCAtODc3LDcgKzg3Nyw3
IEBAIGludCBpbnRlbF9nbWJ1c19zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gICAJCWJ1cy0+cmVnMCA9IHBpbiB8IEdNQlVTX1JBVEVfMTAwS0haOwo+ICAgCj4gICAJ
CS8qIGdtYnVzIHNlZW1zIHRvIGJlIGJyb2tlbiBvbiBpODMwICovCj4gLQkJaWYgKElTX0k4MzAo
ZGV2X3ByaXYpKQo+ICsJCWlmIChJU19JODMwKGk5MTUpKQo+ICAgCQkJYnVzLT5mb3JjZV9iaXQg
PSAxOwo+ICAgCj4gICAJCWludGVsX2dwaW9fc2V0dXAoYnVzLCBwaW4pOwo+IEBAIC04ODcsMjgg
Kzg4NywyOCBAQCBpbnQgaW50ZWxfZ21idXNfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICAgCQkJZ290byBlcnI7Cj4gICAJfQo+ICAgCj4gLQlpbnRlbF9nbWJ1c19y
ZXNldChkZXZfcHJpdik7Cj4gKwlpbnRlbF9nbWJ1c19yZXNldChpOTE1KTsKPiAgIAo+ICAgCXJl
dHVybiAwOwo+ICAgCj4gICBlcnI6Cj4gICAJd2hpbGUgKHBpbi0tKSB7Cj4gLQkJaWYgKCFpbnRl
bF9nbWJ1c19pc192YWxpZF9waW4oZGV2X3ByaXYsIHBpbikpCj4gKwkJaWYgKCFpbnRlbF9nbWJ1
c19pc192YWxpZF9waW4oaTkxNSwgcGluKSkKPiAgIAkJCWNvbnRpbnVlOwo+ICAgCj4gLQkJYnVz
ID0gJmRldl9wcml2LT5nbWJ1c1twaW5dOwo+ICsJCWJ1cyA9ICZpOTE1LT5nbWJ1c1twaW5dOwo+
ICAgCQlpMmNfZGVsX2FkYXB0ZXIoJmJ1cy0+YWRhcHRlcik7Cj4gICAJfQo+ICAgCXJldHVybiBy
ZXQ7Cj4gICB9Cj4gICAKPiAtc3RydWN0IGkyY19hZGFwdGVyICppbnRlbF9nbWJ1c19nZXRfYWRh
cHRlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0cnVjdCBpMmNfYWRh
cHRlciAqaW50ZWxfZ21idXNfZ2V0X2FkYXB0ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gICAJCQkJCSAgICB1bnNpZ25lZCBpbnQgcGluKQo+ICAgewo+IC0JaWYgKFdBUk5fT04o
IWludGVsX2dtYnVzX2lzX3ZhbGlkX3BpbihkZXZfcHJpdiwgcGluKSkpCj4gKwlpZiAoV0FSTl9P
TighaW50ZWxfZ21idXNfaXNfdmFsaWRfcGluKGk5MTUsIHBpbikpKQo+ICAgCQlyZXR1cm4gTlVM
TDsKPiAgIAo+IC0JcmV0dXJuICZkZXZfcHJpdi0+Z21idXNbcGluXS5hZGFwdGVyOwo+ICsJcmV0
dXJuICZpOTE1LT5nbWJ1c1twaW5dLmFkYXB0ZXI7Cj4gICB9Cj4gICAKPiAgIHZvaWQgaW50ZWxf
Z21idXNfc2V0X3NwZWVkKHN0cnVjdCBpMmNfYWRhcHRlciAqYWRhcHRlciwgaW50IHNwZWVkKQo+
IEBAIC05MjEsMTYgKzkyMSwxNiBAQCB2b2lkIGludGVsX2dtYnVzX3NldF9zcGVlZChzdHJ1Y3Qg
aTJjX2FkYXB0ZXIgKmFkYXB0ZXIsIGludCBzcGVlZCkKPiAgIHZvaWQgaW50ZWxfZ21idXNfZm9y
Y2VfYml0KHN0cnVjdCBpMmNfYWRhcHRlciAqYWRhcHRlciwgYm9vbCBmb3JjZV9iaXQpCj4gICB7
Cj4gICAJc3RydWN0IGludGVsX2dtYnVzICpidXMgPSB0b19pbnRlbF9nbWJ1cyhhZGFwdGVyKTsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGJ1cy0+ZGV2X3ByaXY7Cj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGJ1cy0+aTkxNTsKPiAgIAo+IC0JbXV0
ZXhfbG9jaygmZGV2X3ByaXYtPmdtYnVzX211dGV4KTsKPiArCW11dGV4X2xvY2soJmk5MTUtPmdt
YnVzX211dGV4KTsKPiAgIAo+ICAgCWJ1cy0+Zm9yY2VfYml0ICs9IGZvcmNlX2JpdCA/IDEgOiAt
MTsKPiAgIAlEUk1fREVCVUdfS01TKCIlc2FibGluZyBiaXQtYmFuZ2luZyBvbiAlcy4gZm9yY2Ug
Yml0IG5vdyAlZFxuIiwKPiAgIAkJICAgICAgZm9yY2VfYml0ID8gImVuIiA6ICJkaXMiLCBhZGFw
dGVyLT5uYW1lLAo+ICAgCQkgICAgICBidXMtPmZvcmNlX2JpdCk7Cj4gICAKPiAtCW11dGV4X3Vu
bG9jaygmZGV2X3ByaXYtPmdtYnVzX211dGV4KTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+Z21i
dXNfbXV0ZXgpOwo+ICAgfQo+ICAgCj4gICBib29sIGludGVsX2dtYnVzX2lzX2ZvcmNlZF9iaXQo
c3RydWN0IGkyY19hZGFwdGVyICphZGFwdGVyKQo+IEBAIC05NDAsMTYgKzk0MCwxNiBAQCBib29s
IGludGVsX2dtYnVzX2lzX2ZvcmNlZF9iaXQoc3RydWN0IGkyY19hZGFwdGVyICphZGFwdGVyKQo+
ICAgCXJldHVybiBidXMtPmZvcmNlX2JpdDsKPiAgIH0KPiAgIAo+IC12b2lkIGludGVsX2dtYnVz
X3RlYXJkb3duKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBpbnRl
bF9nbWJ1c190ZWFyZG93bihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAg
IAlzdHJ1Y3QgaW50ZWxfZ21idXMgKmJ1czsKPiAgIAl1bnNpZ25lZCBpbnQgcGluOwo+ICAgCj4g
LQlmb3IgKHBpbiA9IDA7IHBpbiA8IEFSUkFZX1NJWkUoZGV2X3ByaXYtPmdtYnVzKTsgcGluKysp
IHsKPiAtCQlpZiAoIWludGVsX2dtYnVzX2lzX3ZhbGlkX3BpbihkZXZfcHJpdiwgcGluKSkKPiAr
CWZvciAocGluID0gMDsgcGluIDwgQVJSQVlfU0laRShpOTE1LT5nbWJ1cyk7IHBpbisrKSB7Cj4g
KwkJaWYgKCFpbnRlbF9nbWJ1c19pc192YWxpZF9waW4oaTkxNSwgcGluKSkKPiAgIAkJCWNvbnRp
bnVlOwo+ICAgCj4gLQkJYnVzID0gJmRldl9wcml2LT5nbWJ1c1twaW5dOwo+ICsJCWJ1cyA9ICZp
OTE1LT5nbWJ1c1twaW5dOwo+ICAgCQlpMmNfZGVsX2FkYXB0ZXIoJmJ1cy0+YWRhcHRlcik7Cj4g
ICAJfQo+ICAgfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9nbWJ1
cy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ21idXMuaAo+IGluZGV4IGQ5ODkwODVi
OGQyMi4uNGE0MTk2Y2E4MzQzIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX2dtYnVzLmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9nbWJ1cy5oCj4g
QEAgLTExLDE3ICsxMSwxNyBAQAo+ICAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGU7Cj4gICBzdHJ1
Y3QgaTJjX2FkYXB0ZXI7Cj4gICAKPiAtaW50IGludGVsX2dtYnVzX3NldHVwKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gLXZvaWQgaW50ZWxfZ21idXNfdGVhcmRvd24oc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtYm9vbCBpbnRlbF9nbWJ1c19pc192
YWxpZF9waW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtpbnQgaW50ZWxf
Z21idXNfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lkIGludGVs
X2dtYnVzX3RlYXJkb3duKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiArYm9vbCBp
bnRlbF9nbWJ1c19pc192YWxpZF9waW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
ICAJCQkgICAgICB1bnNpZ25lZCBpbnQgcGluKTsKPiAgIGludCBpbnRlbF9nbWJ1c19vdXRwdXRf
YWtzdihzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIpOwo+ICAgCj4gICBzdHJ1Y3QgaTJjX2Fk
YXB0ZXIgKgo+IC1pbnRlbF9nbWJ1c19nZXRfYWRhcHRlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsIHVuc2lnbmVkIGludCBwaW4pOwo+ICtpbnRlbF9nbWJ1c19nZXRfYWRhcHRl
cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdW5zaWduZWQgaW50IHBpbik7Cj4gICB2
b2lkIGludGVsX2dtYnVzX3NldF9zcGVlZChzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIsIGlu
dCBzcGVlZCk7Cj4gICB2b2lkIGludGVsX2dtYnVzX2ZvcmNlX2JpdChzdHJ1Y3QgaTJjX2FkYXB0
ZXIgKmFkYXB0ZXIsIGJvb2wgZm9yY2VfYml0KTsKPiAgIGJvb2wgaW50ZWxfZ21idXNfaXNfZm9y
Y2VkX2JpdChzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIpOwo+IC12b2lkIGludGVsX2dtYnVz
X3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gK3ZvaWQgaW50ZWxf
Z21idXNfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgCj4gICAjZW5k
aWYgLyogX19JTlRFTF9HTUJVU19IX18gKi8KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfZ3VjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWMuYwo+IGlu
ZGV4IGM0MGE2ZWZkZDMzYS4uZjA4YWMyOWMyYTRmIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX2d1Yy5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
Z3VjLmMKPiBAQCAtMjksMTQgKzI5LDE0IEBACj4gICAKPiAgIHN0YXRpYyB2b2lkIGdlbjhfZ3Vj
X3JhaXNlX2lycShzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndWNfdG9faTkxNShndWMpOwo+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSBndWNfdG9faTkxNShndWMpOwo+ICAgCj4gICAJSTkxNV9XUklU
RShHVUNfU0VORF9JTlRFUlJVUFQsIEdVQ19TRU5EX1RSSUdHRVIpOwo+ICAgfQo+ICAgCj4gICBz
dGF0aWMgdm9pZCBnZW4xMV9ndWNfcmFpc2VfaXJxKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKPiAg
IHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGd1Y190b19pOTE1KGd1
Yyk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd1Y190b19pOTE1KGd1Yyk7
Cj4gICAKPiAgIAlJOTE1X1dSSVRFKEdFTjExX0dVQ19IT1NUX0lOVEVSUlVQVCwgMCk7Cj4gICB9
Cj4gQEAgLTUyLDExICs1MiwxMSBAQCBzdGF0aWMgaW5saW5lIGk5MTVfcmVnX3QgZ3VjX3NlbmRf
cmVnKHN0cnVjdCBpbnRlbF9ndWMgKmd1YywgdTMyIGkpCj4gICAKPiAgIHZvaWQgaW50ZWxfZ3Vj
X2luaXRfc2VuZF9yZWdzKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKPiAgIHsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGd1Y190b19pOTE1KGd1Yyk7Cj4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd1Y190b19pOTE1KGd1Yyk7Cj4gICAJZW51bSBmb3Jj
ZXdha2VfZG9tYWlucyBmd19kb21haW5zID0gMDsKPiAgIAl1bnNpZ25lZCBpbnQgaTsKPiAgIAo+
IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkx
NSkgPj0gMTEpIHsKPiAgIAkJZ3VjLT5zZW5kX3JlZ3MuYmFzZSA9Cj4gICAJCQkJaTkxNV9tbWlv
X3JlZ19vZmZzZXQoR0VOMTFfU09GVF9TQ1JBVENIKDApKTsKPiAgIAkJZ3VjLT5zZW5kX3JlZ3Mu
Y291bnQgPSBHRU4xMV9TT0ZUX1NDUkFUQ0hfQ09VTlQ7Cj4gQEAgLTY3LDcgKzY3LDcgQEAgdm9p
ZCBpbnRlbF9ndWNfaW5pdF9zZW5kX3JlZ3Moc3RydWN0IGludGVsX2d1YyAqZ3VjKQo+ICAgCX0K
PiAgIAo+ICAgCWZvciAoaSA9IDA7IGkgPCBndWMtPnNlbmRfcmVncy5jb3VudDsgaSsrKSB7Cj4g
LQkJZndfZG9tYWlucyB8PSBpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2Zvcl9yZWcoJmRldl9wcml2
LT51bmNvcmUsCj4gKwkJZndfZG9tYWlucyB8PSBpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2Zvcl9y
ZWcoJmk5MTUtPnVuY29yZSwKPiAgIAkJCQkJZ3VjX3NlbmRfcmVnKGd1YywgaSksCj4gICAJCQkJ
CUZXX1JFR19SRUFEIHwgRldfUkVHX1dSSVRFKTsKPiAgIAl9Cj4gQEAgLTEwMSw3ICsxMDEsNyBA
QCB2b2lkIGludGVsX2d1Y19pbml0X2Vhcmx5KHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKPiAgIAo+
ICAgc3RhdGljIGludCBndWNfaW5pdF93cShzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCj4gICB7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndWNfdG9faTkxNShndWMpOwo+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndWNfdG9faTkxNShndWMpOwo+ICAg
Cj4gICAJLyoKPiAgIAkgKiBHdUMgbG9nIGJ1ZmZlciBmbHVzaCB3b3JrIGl0ZW0gaGFzIHRvIGRv
IHJlZ2lzdGVyIGFjY2VzcyB0bwo+IEBAIC0xMzUsOCArMTM1LDggQEAgc3RhdGljIGludCBndWNf
aW5pdF93cShzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCj4gICAJICogdG8gbWFrZSBzdXJlIHdlJ3Jl
IGFsd2F5cyBzZW5kaW5nIGEgc2luZ2xlIHByZWVtcHRpb24gcmVxdWVzdCB3aXRoIGEKPiAgIAkg
KiBzaW5nbGUgd29ya2l0ZW0uCj4gICAJICovCj4gLQlpZiAoSEFTX0xPR0lDQUxfUklOR19QUkVF
TVBUSU9OKGRldl9wcml2KSAmJgo+IC0JICAgIFVTRVNfR1VDX1NVQk1JU1NJT04oZGV2X3ByaXYp
KSB7Cj4gKwlpZiAoSEFTX0xPR0lDQUxfUklOR19QUkVFTVBUSU9OKGk5MTUpICYmCj4gKwkgICAg
VVNFU19HVUNfU1VCTUlTU0lPTihpOTE1KSkgewo+ICAgCQlndWMtPnByZWVtcHRfd3EgPSBhbGxv
Y19vcmRlcmVkX3dvcmtxdWV1ZSgiaTkxNS1ndWNfcHJlZW1wdCIsCj4gICAJCQkJCQkJICBXUV9I
SUdIUFJJKTsKPiAgIAkJaWYgKCFndWMtPnByZWVtcHRfd3EpIHsKPiBAQCAtMjExLDcgKzIxMSw3
IEBAIHN0YXRpYyB2b2lkIGd1Y19zaGFyZWRfZGF0YV9kZXN0cm95KHN0cnVjdCBpbnRlbF9ndWMg
Kmd1YykKPiAgIAo+ICAgaW50IGludGVsX2d1Y19pbml0KHN0cnVjdCBpbnRlbF9ndWMgKmd1YykK
PiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGd1Y190b19pOTE1
KGd1Yyk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd1Y190b19pOTE1KGd1
Yyk7Cj4gICAJaW50IHJldDsKPiAgIAo+ICAgCXJldCA9IGludGVsX3VjX2Z3X2luaXQoJmd1Yy0+
ZncpOwo+IEBAIC0yMzcsNyArMjM3LDcgQEAgaW50IGludGVsX2d1Y19pbml0KHN0cnVjdCBpbnRl
bF9ndWMgKmd1YykKPiAgIAkJZ290byBlcnJfYWRzOwo+ICAgCj4gICAJLyogV2UgbmVlZCB0byBu
b3RpZnkgdGhlIGd1YyB3aGVuZXZlciB3ZSBjaGFuZ2UgdGhlIEdHVFQgKi8KPiAtCWk5MTVfZ2d0
dF9lbmFibGVfZ3VjKGRldl9wcml2KTsKPiArCWk5MTVfZ2d0dF9lbmFibGVfZ3VjKGk5MTUpOwo+
ICAgCj4gICAJcmV0dXJuIDA7Cj4gICAKPiBAQCAtMjU2LDkgKzI1Niw5IEBAIGludCBpbnRlbF9n
dWNfaW5pdChzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCj4gICAKPiAgIHZvaWQgaW50ZWxfZ3VjX2Zp
bmkoc3RydWN0IGludGVsX2d1YyAqZ3VjKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiAgIAo+IC0JaTkxNV9nZ3R0X2Rpc2FibGVf
Z3VjKGRldl9wcml2KTsKPiArCWk5MTVfZ2d0dF9kaXNhYmxlX2d1YyhpOTE1KTsKPiAgIAo+ICAg
CWludGVsX2d1Y19jdF9maW5pKCZndWMtPmN0KTsKPiAgIAo+IEBAIC0zNjYsNyArMzY2LDcgQEAg
c3RhdGljIHUzMiBndWNfY3RsX2Fkc19mbGFncyhzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCj4gICAg
Ki8KPiAgIHZvaWQgaW50ZWxfZ3VjX2luaXRfcGFyYW1zKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykK
PiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGd1Y190b19pOTE1
KGd1Yyk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd1Y190b19pOTE1KGd1
Yyk7Cj4gICAJdTMyIHBhcmFtc1tHVUNfQ1RMX01BWF9EV09SRFNdOwo+ICAgCWludCBpOwo+ICAg
Cj4gQEAgLTM4NiwxNCArMzg2LDE0IEBAIHZvaWQgaW50ZWxfZ3VjX2luaXRfcGFyYW1zKHN0cnVj
dCBpbnRlbF9ndWMgKmd1YykKPiAgIAkgKiB0aGV5IGFyZSBwb3dlciBjb250ZXh0IHNhdmVkIHNv
IGl0J3Mgb2sgdG8gcmVsZWFzZSBmb3JjZXdha2UKPiAgIAkgKiB3aGVuIHdlIGFyZSBkb25lIGhl
cmUgYW5kIHRha2UgaXQgYWdhaW4gYXQgeGZlciB0aW1lLgo+ICAgCSAqLwo+IC0JaW50ZWxfdW5j
b3JlX2ZvcmNld2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9CTElUVEVSKTsK
PiArCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9C
TElUVEVSKTsKPiAgIAo+ICAgCUk5MTVfV1JJVEUoU09GVF9TQ1JBVENIKDApLCAwKTsKPiAgIAo+
ICAgCWZvciAoaSA9IDA7IGkgPCBHVUNfQ1RMX01BWF9EV09SRFM7IGkrKykKPiAgIAkJSTkxNV9X
UklURShTT0ZUX1NDUkFUQ0goMSArIGkpLCBwYXJhbXNbaV0pOwo+ICAgCj4gLQlpbnRlbF91bmNv
cmVfZm9yY2V3YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0JMSVRURVIpOwo+
ICsJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtFX0JM
SVRURVIpOwo+ICAgfQo+ICAgCj4gICBpbnQgaW50ZWxfZ3VjX3NlbmRfbm9wKHN0cnVjdCBpbnRl
bF9ndWMgKmd1YywgY29uc3QgdTMyICphY3Rpb24sIHUzMiBsZW4sCj4gQEAgLTQxNCw4ICs0MTQs
OCBAQCB2b2lkIGludGVsX2d1Y190b19ob3N0X2V2ZW50X2hhbmRsZXJfbm9wKHN0cnVjdCBpbnRl
bF9ndWMgKmd1YykKPiAgIGludCBpbnRlbF9ndWNfc2VuZF9tbWlvKHN0cnVjdCBpbnRlbF9ndWMg
Kmd1YywgY29uc3QgdTMyICphY3Rpb24sIHUzMiBsZW4sCj4gICAJCQl1MzIgKnJlc3BvbnNlX2J1
ZiwgdTMyIHJlc3BvbnNlX2J1Zl9zaXplKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiAtCXN0cnVjdCBpbnRlbF91bmNvcmUg
KnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBndWNfdG9faTkxNShndWMpOwo+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3Jl
ID0gJmk5MTUtPnVuY29yZTsKPiAgIAl1MzIgc3RhdHVzOwo+ICAgCWludCBpOwo+ICAgCWludCBy
ZXQ7Cj4gQEAgLTQ5NywxMiArNDk3LDEyIEBAIGludCBpbnRlbF9ndWNfdG9faG9zdF9wcm9jZXNz
X3JlY3ZfbXNnKHN0cnVjdCBpbnRlbF9ndWMgKmd1YywKPiAgIAo+ICAgaW50IGludGVsX2d1Y19z
YW1wbGVfZm9yY2V3YWtlKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKPiAgIHsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGd1Y190b19pOTE1KGd1Yyk7Cj4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd1Y190b19pOTE1KGd1Yyk7Cj4gICAJdTMyIGFjdGlv
blsyXTsKPiAgIAo+ICAgCWFjdGlvblswXSA9IElOVEVMX0dVQ19BQ1RJT05fU0FNUExFX0ZPUkNF
V0FLRTsKPiAgIAkvKiBXYVJzRGlzYWJsZUNvYXJzZVBvd2VyR2F0aW5nOnNrbCxjbmwgKi8KPiAt
CWlmICghSEFTX1JDNihkZXZfcHJpdikgfHwgTkVFRFNfV2FSc0Rpc2FibGVDb2Fyc2VQb3dlckdh
dGluZyhkZXZfcHJpdikpCj4gKwlpZiAoIUhBU19SQzYoaTkxNSkgfHwgTkVFRFNfV2FSc0Rpc2Fi
bGVDb2Fyc2VQb3dlckdhdGluZyhpOTE1KSkKPiAgIAkJYWN0aW9uWzFdID0gMDsKPiAgIAllbHNl
Cj4gICAJCS8qIGJpdCAwIGFuZCAxIGFyZSBmb3IgUmVuZGVyIGFuZCBNZWRpYSBkb21haW4gc2Vw
YXJhdGVseSAqLwo+IEBAIC01MzgsNyArNTM4LDcgQEAgaW50IGludGVsX2d1Y19hdXRoX2h1Yyhz
dHJ1Y3QgaW50ZWxfZ3VjICpndWMsIHUzMiByc2Ffb2Zmc2V0KQo+ICAgICovCj4gICBpbnQgaW50
ZWxfZ3VjX3N1c3BlbmQoc3RydWN0IGludGVsX2d1YyAqZ3VjKQo+ICAgewo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiAgIAlpbnQgcmV0Owo+
ICAgCXUzMiBzdGF0dXM7Cj4gICAJdTMyIGFjdGlvbltdID0gewo+IEBAIC01NjIsNyArNTYyLDcg
QEAgaW50IGludGVsX2d1Y19zdXNwZW5kKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKPiAgIAlpZiAo
cmV0KQo+ICAgCQlyZXR1cm4gcmV0Owo+ICAgCj4gLQlyZXQgPSBfX2ludGVsX3dhaXRfZm9yX3Jl
Z2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLCBTT0ZUX1NDUkFUQ0goMTQpLAo+ICsJcmV0ID0gX19p
bnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLCBTT0ZUX1NDUkFUQ0goMTQpLAo+
ICAgCQkJCQlJTlRFTF9HVUNfU0xFRVBfU1RBVEVfSU5WQUxJRF9NQVNLLAo+ICAgCQkJCQkwLCAw
LCAxMCwgJnN0YXR1cyk7Cj4gICAJaWYgKHJldCkKPiBAQCAtNjU4LDE3ICs2NTgsMTcgQEAgaW50
IGludGVsX2d1Y19yZXN1bWUoc3RydWN0IGludGVsX2d1YyAqZ3VjKQo+ICAgICovCj4gICBzdHJ1
Y3QgaTkxNV92bWEgKmludGVsX2d1Y19hbGxvY2F0ZV92bWEoc3RydWN0IGludGVsX2d1YyAqZ3Vj
LCB1MzIgc2l6ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IGd1Y190b19pOTE1KGd1Yyk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd1
Y190b19pOTE1KGd1Yyk7Cj4gICAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKPiAg
IAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKPiAgIAl1NjQgZmxhZ3M7Cj4gICAJaW50IHJldDsKPiAg
IAo+IC0Jb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zaG1lbShkZXZfcHJpdiwgc2l6ZSk7
Cj4gKwlvYmogPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3NobWVtKGk5MTUsIHNpemUpOwo+ICAg
CWlmIChJU19FUlIob2JqKSkKPiAgIAkJcmV0dXJuIEVSUl9DQVNUKG9iaik7Cj4gICAKPiAtCXZt
YSA9IGk5MTVfdm1hX2luc3RhbmNlKG9iaiwgJmRldl9wcml2LT5nZ3R0LnZtLCBOVUxMKTsKPiAr
CXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9iaiwgJmk5MTUtPmdndHQudm0sIE5VTEwpOwo+ICAg
CWlmIChJU19FUlIodm1hKSkKPiAgIAkJZ290byBlcnI7Cj4gICAKPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2Fkcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfZ3VjX2Fkcy5jCj4gaW5kZXggZWNiNjlmYzk0MjE4Li40YWM5ZWQyZGQ0NjcgMTAwNjQ0
Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2Fkcy5jCj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2Fkcy5jCj4gQEAgLTg1LDcgKzg1LDcgQEAgc3Ry
dWN0IF9fZ3VjX2Fkc19ibG9iIHsKPiAgIAo+ICAgc3RhdGljIGludCBfX2d1Y19hZHNfaW5pdChz
dHJ1Y3QgaW50ZWxfZ3VjICpndWMpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBndWNfdG9faTkxNShndWMpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBndWNfdG9faTkxNShndWMpOwo+ICAgCXN0cnVjdCBfX2d1Y19hZHNfYmxvYiAqYmxv
YjsKPiAgIAljb25zdCB1MzIgc2tpcHBlZF9zaXplID0gTFJDX1BQSFdTUF9TWiAqIFBBR0VfU0la
RSArIExSX0hXX0NPTlRFWFRfU0laRTsKPiAgIAl1MzIgYmFzZTsKPiBAQCAtMTE1LDE4ICsxMTUs
MTggQEAgc3RhdGljIGludCBfX2d1Y19hZHNfaW5pdChzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCj4g
ICAJCSAqLwo+ICAgCQlibG9iLT5hZHMuZ29sZGVuX2NvbnRleHRfbHJjYVtlbmdpbmVfY2xhc3Nd
ID0gMDsKPiAgIAkJYmxvYi0+YWRzLmVuZ19zdGF0ZV9zaXplW2VuZ2luZV9jbGFzc10gPQo+IC0J
CQlpbnRlbF9lbmdpbmVfY29udGV4dF9zaXplKGRldl9wcml2LCBlbmdpbmVfY2xhc3MpIC0KPiAr
CQkJaW50ZWxfZW5naW5lX2NvbnRleHRfc2l6ZShpOTE1LCBlbmdpbmVfY2xhc3MpIC0KPiAgIAkJ
CXNraXBwZWRfc2l6ZTsKPiAgIAl9Cj4gICAKPiAgIAkvKiBTeXN0ZW0gaW5mbyAqLwo+IC0JYmxv
Yi0+c3lzdGVtX2luZm8uc2xpY2VfZW5hYmxlZCA9IGh3ZWlnaHQ4KFJVTlRJTUVfSU5GTyhkZXZf
cHJpdiktPnNzZXUuc2xpY2VfbWFzayk7Cj4gKwlibG9iLT5zeXN0ZW1faW5mby5zbGljZV9lbmFi
bGVkID0gaHdlaWdodDgoUlVOVElNRV9JTkZPKGk5MTUpLT5zc2V1LnNsaWNlX21hc2spOwo+ICAg
CWJsb2ItPnN5c3RlbV9pbmZvLnJjc19lbmFibGVkID0gMTsKPiAgIAlibG9iLT5zeXN0ZW1faW5m
by5iY3NfZW5hYmxlZCA9IDE7Cj4gICAKPiAtCWJsb2ItPnN5c3RlbV9pbmZvLnZkYm94X2VuYWJs
ZV9tYXNrID0gVkRCT1hfTUFTSyhkZXZfcHJpdik7Cj4gLQlibG9iLT5zeXN0ZW1faW5mby52ZWJv
eF9lbmFibGVfbWFzayA9IFZFQk9YX01BU0soZGV2X3ByaXYpOwo+IC0JYmxvYi0+c3lzdGVtX2lu
Zm8udmRib3hfc2ZjX3N1cHBvcnRfbWFzayA9IFJVTlRJTUVfSU5GTyhkZXZfcHJpdiktPnZkYm94
X3NmY19hY2Nlc3M7Cj4gKwlibG9iLT5zeXN0ZW1faW5mby52ZGJveF9lbmFibGVfbWFzayA9IFZE
Qk9YX01BU0soaTkxNSk7Cj4gKwlibG9iLT5zeXN0ZW1faW5mby52ZWJveF9lbmFibGVfbWFzayA9
IFZFQk9YX01BU0soaTkxNSk7Cj4gKwlibG9iLT5zeXN0ZW1faW5mby52ZGJveF9zZmNfc3VwcG9y
dF9tYXNrID0gUlVOVElNRV9JTkZPKGk5MTUpLT52ZGJveF9zZmNfYWNjZXNzOwo+ICAgCj4gICAJ
YmFzZSA9IGludGVsX2d1Y19nZ3R0X29mZnNldChndWMsIGd1Yy0+YWRzX3ZtYSk7Cj4gICAKPiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2Z3LmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfZncuYwo+IGluZGV4IDcyY2RhZmQ5NjM2YS4uMmJlYjkw
YzYyYTQwIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Y19mdy5j
Cj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2Z3LmMKPiBAQCAtMTI1LDcg
KzEyNSw3IEBAIHZvaWQgaW50ZWxfZ3VjX2Z3X2luaXRfZWFybHkoc3RydWN0IGludGVsX2d1YyAq
Z3VjKQo+ICAgCj4gICBzdGF0aWMgdm9pZCBndWNfcHJlcGFyZV94ZmVyKHN0cnVjdCBpbnRlbF9n
dWMgKmd1YykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGd1
Y190b19pOTE1KGd1Yyk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd1Y190
b19pOTE1KGd1Yyk7Cj4gICAKPiAgIAkvKiBNdXN0IHByb2dyYW0gdGhpcyByZWdpc3RlciBiZWZv
cmUgbG9hZGluZyB0aGUgdWNvZGUgd2l0aCBETUEgKi8KPiAgIAlJOTE1X1dSSVRFKEdVQ19TSElN
X0NPTlRST0wsIEdVQ19ESVNBQkxFX1NSQU1fSU5JVF9UT19aRVJPRVMgfAo+IEBAIC0xMzUsMTIg
KzEzNSwxMiBAQCBzdGF0aWMgdm9pZCBndWNfcHJlcGFyZV94ZmVyKHN0cnVjdCBpbnRlbF9ndWMg
Kmd1YykKPiAgIAkJCQkgICAgIEdVQ19FTkFCTEVfUkVBRF9DQUNIRV9GT1JfV09QQ01fREFUQSB8
Cj4gICAJCQkJICAgICBHVUNfRU5BQkxFX01JQV9DTE9DS19HQVRJTkcpOwo+ICAgCj4gLQlpZiAo
SVNfR0VOOV9MUChkZXZfcHJpdikpCj4gKwlpZiAoSVNfR0VOOV9MUChpOTE1KSkKPiAgIAkJSTkx
NV9XUklURShHRU45TFBfR1RfUE1fQ09ORklHLCBHVF9ET09SQkVMTF9FTkFCTEUpOwo+ICAgCWVs
c2UKPiAgIAkJSTkxNV9XUklURShHRU45X0dUX1BNX0NPTkZJRywgR1RfRE9PUkJFTExfRU5BQkxF
KTsKPiAgIAo+IC0JaWYgKElTX0dFTihkZXZfcHJpdiwgOSkpIHsKPiArCWlmIChJU19HRU4oaTkx
NSwgOSkpIHsKPiAgIAkJLyogRE9QIENsb2NrIEdhdGluZyBFbmFibGUgZm9yIEd1QyBjbG9ja3Mg
Ki8KPiAgIAkJSTkxNV9XUklURShHRU43X01JU0NDUENUTCwgKEdFTjhfRE9QX0NMT0NLX0dBVEVf
R1VDX0VOQUJMRSB8Cj4gICAJCQkJCSAgICBJOTE1X1JFQUQoR0VON19NSVNDQ1BDVEwpKSk7Cj4g
QEAgLTE1Myw3ICsxNTMsNyBAQCBzdGF0aWMgdm9pZCBndWNfcHJlcGFyZV94ZmVyKHN0cnVjdCBp
bnRlbF9ndWMgKmd1YykKPiAgIC8qIENvcHkgUlNBIHNpZ25hdHVyZSBmcm9tIHRoZSBmdyBpbWFn
ZSB0byBIVyBmb3IgdmVyaWZpY2F0aW9uICovCj4gICBzdGF0aWMgdm9pZCBndWNfeGZlcl9yc2Eo
c3RydWN0IGludGVsX2d1YyAqZ3VjKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiAgIAlzdHJ1Y3QgaW50ZWxfdWNfZncgKmZ3ID0g
Jmd1Yy0+Znc7Cj4gICAJc3RydWN0IHNnX3RhYmxlICpwYWdlcyA9IGZ3LT5vYmotPm1tLnBhZ2Vz
Owo+ICAgCXUzMiByc2FbVU9TX1JTQV9TQ1JBVENIX0NPVU5UXTsKPiBAQCAtMTY4LDcgKzE2OCw3
IEBAIHN0YXRpYyB2b2lkIGd1Y194ZmVyX3JzYShzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCj4gICAK
PiAgIHN0YXRpYyBib29sIGd1Y194ZmVyX2NvbXBsZXRlZChzdHJ1Y3QgaW50ZWxfZ3VjICpndWMs
IHUzMiAqc3RhdHVzKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
Z3VjX3RvX2k5MTUoZ3VjKTsKPiAgIAo+ICAgCS8qIERpZCB3ZSBjb21wbGV0ZSB0aGUgeGZlcj8g
Ki8KPiAgIAkqc3RhdHVzID0gSTkxNV9SRUFEKERNQV9DVFJMKTsKPiBAQCAtMTg2LDcgKzE4Niw3
IEBAIHN0YXRpYyBib29sIGd1Y194ZmVyX2NvbXBsZXRlZChzdHJ1Y3QgaW50ZWxfZ3VjICpndWMs
IHUzMiAqc3RhdHVzKQo+ICAgICovCj4gICBzdGF0aWMgaW5saW5lIGJvb2wgZ3VjX3JlYWR5KHN0
cnVjdCBpbnRlbF9ndWMgKmd1YywgdTMyICpzdGF0dXMpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndWNfdG9faTkxNShndWMpOwo+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSBndWNfdG9faTkxNShndWMpOwo+ICAgCXUzMiB2YWwgPSBJOTE1
X1JFQUQoR1VDX1NUQVRVUyk7Cj4gICAJdTMyIHVrX3ZhbCA9IHZhbCAmIEdTX1VLRVJORUxfTUFT
SzsKPiAgIAo+IEBAIC0yMzQsNyArMjM0LDcgQEAgc3RhdGljIGludCBndWNfd2FpdF91Y29kZShz
dHJ1Y3QgaW50ZWxfZ3VjICpndWMpCj4gICAgKi8KPiAgIHN0YXRpYyBpbnQgZ3VjX3hmZXJfdWNv
ZGUoc3RydWN0IGludGVsX2d1YyAqZ3VjKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiAgIAlzdHJ1Y3QgaW50ZWxfdWNfZncgKmd1
Y19mdyA9ICZndWMtPmZ3Owo+ICAgCXVuc2lnbmVkIGxvbmcgb2Zmc2V0Owo+ICAgCj4gQEAgLTI2
NywxMiArMjY3LDEyIEBAIHN0YXRpYyBpbnQgZ3VjX3hmZXJfdWNvZGUoc3RydWN0IGludGVsX2d1
YyAqZ3VjKQo+ICAgc3RhdGljIGludCBndWNfZndfeGZlcihzdHJ1Y3QgaW50ZWxfdWNfZncgKmd1
Y19mdykKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZ3VjICpndWMgPSBjb250YWluZXJfb2YoZ3Vj
X2Z3LCBzdHJ1Y3QgaW50ZWxfZ3VjLCBmdyk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBndWNfdG9faTkxNShndWMpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBndWNfdG9faTkxNShndWMpOwo+ICAgCWludCByZXQ7Cj4gICAKPiAgIAlHRU1fQlVH
X09OKGd1Y19mdy0+dHlwZSAhPSBJTlRFTF9VQ19GV19UWVBFX0dVQyk7Cj4gICAKPiAtCWludGVs
X3VuY29yZV9mb3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsK
PiArCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9B
TEwpOwo+ICAgCj4gICAJZ3VjX3ByZXBhcmVfeGZlcihndWMpOwo+ICAgCj4gQEAgLTI4NSw3ICsy
ODUsNyBAQCBzdGF0aWMgaW50IGd1Y19md194ZmVyKHN0cnVjdCBpbnRlbF91Y19mdyAqZ3VjX2Z3
KQo+ICAgCj4gICAJcmV0ID0gZ3VjX3hmZXJfdWNvZGUoZ3VjKTsKPiAgIAo+IC0JaW50ZWxfdW5j
b3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ICsJ
aW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7
Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9ndWNfbG9nLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNf
bG9nLmMKPiBpbmRleCA2N2VhZGM4MmMzOTYuLjMwMGVkOTQwZjBiNyAxMDA2NDQKPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfbG9nLmMKPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9ndWNfbG9nLmMKPiBAQCAtMzkwLDcgKzM5MCw3IEBAIHZvaWQgaW50ZWxf
Z3VjX2xvZ19pbml0X2Vhcmx5KHN0cnVjdCBpbnRlbF9ndWNfbG9nICpsb2cpCj4gICBzdGF0aWMg
aW50IGd1Y19sb2dfcmVsYXlfY3JlYXRlKHN0cnVjdCBpbnRlbF9ndWNfbG9nICpsb2cpCj4gICB7
Cj4gICAJc3RydWN0IGludGVsX2d1YyAqZ3VjID0gbG9nX3RvX2d1Yyhsb2cpOwo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiAgIAlzdHJ1Y3Qg
cmNoYW4gKmd1Y19sb2dfcmVsYXlfY2hhbjsKPiAgIAlzaXplX3Qgbl9zdWJidWZzLCBzdWJidWZf
c2l6ZTsKPiAgIAlpbnQgcmV0Owo+IEBAIC00MDksOSArNDA5LDkgQEAgc3RhdGljIGludCBndWNf
bG9nX3JlbGF5X2NyZWF0ZShzdHJ1Y3QgaW50ZWxfZ3VjX2xvZyAqbG9nKQo+ICAgCW5fc3ViYnVm
cyA9IDg7Cj4gICAKPiAgIAlndWNfbG9nX3JlbGF5X2NoYW4gPSByZWxheV9vcGVuKCJndWNfbG9n
IiwKPiAtCQkJCQlkZXZfcHJpdi0+ZHJtLnByaW1hcnktPmRlYnVnZnNfcm9vdCwKPiArCQkJCQlp
OTE1LT5kcm0ucHJpbWFyeS0+ZGVidWdmc19yb290LAo+ICAgCQkJCQlzdWJidWZfc2l6ZSwgbl9z
dWJidWZzLAo+IC0JCQkJCSZyZWxheV9jYWxsYmFja3MsIGRldl9wcml2KTsKPiArCQkJCQkmcmVs
YXlfY2FsbGJhY2tzLCBpOTE1KTsKPiAgIAlpZiAoIWd1Y19sb2dfcmVsYXlfY2hhbikgewo+ICAg
CQlEUk1fRVJST1IoIkNvdWxkbid0IGNyZWF0ZSByZWxheSBjaGFuIGZvciBHdUMgbG9nZ2luZ1xu
Iik7Cj4gICAKPiBAQCAtNDM2LDcgKzQzNiw3IEBAIHN0YXRpYyB2b2lkIGd1Y19sb2dfcmVsYXlf
ZGVzdHJveShzdHJ1Y3QgaW50ZWxfZ3VjX2xvZyAqbG9nKQo+ICAgc3RhdGljIHZvaWQgZ3VjX2xv
Z19jYXB0dXJlX2xvZ3Moc3RydWN0IGludGVsX2d1Y19sb2cgKmxvZykKPiAgIHsKPiAgIAlzdHJ1
Y3QgaW50ZWxfZ3VjICpndWMgPSBsb2dfdG9fZ3VjKGxvZyk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSBndWNfdG9faTkxNShndWMpOwo+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSBndWNfdG9faTkxNShndWMpOwo+ICAgCWludGVsX3dha2VyZWZfdCB3
YWtlcmVmOwo+ICAgCj4gICAJZ3VjX3JlYWRfdXBkYXRlX2xvZ19idWZmZXIobG9nKTsKPiBAQCAt
NDQ1LDcgKzQ0NSw3IEBAIHN0YXRpYyB2b2lkIGd1Y19sb2dfY2FwdHVyZV9sb2dzKHN0cnVjdCBp
bnRlbF9ndWNfbG9nICpsb2cpCj4gICAJICogR2VuZXJhbGx5IGRldmljZSBpcyBleHBlY3RlZCB0
byBiZSBhY3RpdmUgb25seSBhdCB0aGlzCj4gICAJICogdGltZSwgc28gZ2V0L3B1dCBzaG91bGQg
YmUgcmVhbGx5IHF1aWNrLgo+ICAgCSAqLwo+IC0Jd2l0aF9pbnRlbF9ydW50aW1lX3BtKGRldl9w
cml2LCB3YWtlcmVmKQo+ICsJd2l0aF9pbnRlbF9ydW50aW1lX3BtKGk5MTUsIHdha2VyZWYpCj4g
ICAJCWd1Y19hY3Rpb25fZmx1c2hfbG9nX2NvbXBsZXRlKGd1Yyk7Cj4gICB9Cj4gICAKPiBAQCAt
NTA1LDcgKzUwNSw3IEBAIHZvaWQgaW50ZWxfZ3VjX2xvZ19kZXN0cm95KHN0cnVjdCBpbnRlbF9n
dWNfbG9nICpsb2cpCj4gICBpbnQgaW50ZWxfZ3VjX2xvZ19zZXRfbGV2ZWwoc3RydWN0IGludGVs
X2d1Y19sb2cgKmxvZywgdTMyIGxldmVsKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9ndWMgKmd1
YyA9IGxvZ190b19ndWMobG9nKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IGd1Y190b19pOTE1KGd1Yyk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IGd1Y190b19pOTE1KGd1Yyk7Cj4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gICAJaW50
IHJldCA9IDA7Cj4gICAKPiBAQCAtNTE5LDEyICs1MTksMTIgQEAgaW50IGludGVsX2d1Y19sb2df
c2V0X2xldmVsKHN0cnVjdCBpbnRlbF9ndWNfbG9nICpsb2csIHUzMiBsZXZlbCkKPiAgIAlpZiAo
bGV2ZWwgPCBHVUNfTE9HX0xFVkVMX0RJU0FCTEVEIHx8IGxldmVsID4gR1VDX0xPR19MRVZFTF9N
QVgpCj4gICAJCXJldHVybiAtRUlOVkFMOwo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+
ZHJtLnN0cnVjdF9tdXRleCk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4
KTsKPiAgIAo+ICAgCWlmIChsb2ctPmxldmVsID09IGxldmVsKQo+ICAgCQlnb3RvIG91dF91bmxv
Y2s7Cj4gICAKPiAtCXdpdGhfaW50ZWxfcnVudGltZV9wbShkZXZfcHJpdiwgd2FrZXJlZikKPiAr
CXdpdGhfaW50ZWxfcnVudGltZV9wbShpOTE1LCB3YWtlcmVmKQo+ICAgCQlyZXQgPSBndWNfYWN0
aW9uX2NvbnRyb2xfbG9nKGd1YywKPiAgIAkJCQkJICAgICBHVUNfTE9HX0xFVkVMX0lTX1ZFUkJP
U0UobGV2ZWwpLAo+ICAgCQkJCQkgICAgIEdVQ19MT0dfTEVWRUxfSVNfRU5BQkxFRChsZXZlbCks
Cj4gQEAgLTUzNyw3ICs1MzcsNyBAQCBpbnQgaW50ZWxfZ3VjX2xvZ19zZXRfbGV2ZWwoc3RydWN0
IGludGVsX2d1Y19sb2cgKmxvZywgdTMyIGxldmVsKQo+ICAgCWxvZy0+bGV2ZWwgPSBsZXZlbDsK
PiAgIAo+ICAgb3V0X3VubG9jazoKPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1
Y3RfbXV0ZXgpOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAg
IAo+ICAgCXJldHVybiByZXQ7Cj4gICB9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX2d1Y19zdWJtaXNzaW9uLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9n
dWNfc3VibWlzc2lvbi5jCj4gaW5kZXggOTdmNjk3MGQ4ZGE4Li4wMTNkODUyNzgyNzAgMTAwNjQ0
Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYwo+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Y19zdWJtaXNzaW9uLmMKPiBAQCAtMjAz
LDcgKzIwMyw3IEBAIHN0YXRpYyBzdHJ1Y3QgZ3VjX2Rvb3JiZWxsX2luZm8gKl9fZ2V0X2Rvb3Ji
ZWxsKHN0cnVjdCBpbnRlbF9ndWNfY2xpZW50ICpjbGllbnQpCj4gICAKPiAgIHN0YXRpYyBib29s
IF9fZG9vcmJlbGxfdmFsaWQoc3RydWN0IGludGVsX2d1YyAqZ3VjLCB1MTYgZGJfaWQpCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndWNfdG9faTkxNShndWMp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndWNfdG9faTkxNShndWMpOwo+
ICAgCj4gICAJR0VNX0JVR19PTihkYl9pZCA+PSBHVUNfTlVNX0RPT1JCRUxMUyk7Cj4gICAJcmV0
dXJuIEk5MTVfUkVBRChHRU44X0RSQlJFR0woZGJfaWQpKSAmIEdFTjhfRFJCX1ZBTElEOwo+IEBA
IC0xMDE0LDcgKzEwMTQsNyBAQCBzdGF0aWMgYm9vbCBndWNfdmVyaWZ5X2Rvb3JiZWxscyhzdHJ1
Y3QgaW50ZWxfZ3VjICpndWMpCj4gICAKPiAgIC8qKgo+ICAgICogZ3VjX2NsaWVudF9hbGxvYygp
IC0gQWxsb2NhdGUgYW4gaW50ZWxfZ3VjX2NsaWVudAo+IC0gKiBAZGV2X3ByaXY6CWRyaXZlciBw
cml2YXRlIGRhdGEgc3RydWN0dXJlCj4gKyAqIEBpOTE1Oglkcml2ZXIgcHJpdmF0ZSBkYXRhIHN0
cnVjdHVyZQo+ICAgICogQGVuZ2luZXM6CVRoZSBzZXQgb2YgZW5naW5lcyB0byBlbmFibGUgZm9y
IHRoaXMgY2xpZW50Cj4gICAgKiBAcHJpb3JpdHk6CWZvdXIgbGV2ZWxzIHByaW9yaXR5IF9DUklU
SUNBTCwgX0hJR0gsIF9OT1JNQUwgYW5kIF9MT1cKPiAgICAqCQlUaGUga2VybmVsIGNsaWVudCB0
byByZXBsYWNlIEV4ZWNMaXN0IHN1Ym1pc3Npb24gaXMgY3JlYXRlZCB3aXRoCj4gQEAgLTEwMjYs
MTMgKzEwMjYsMTMgQEAgc3RhdGljIGJvb2wgZ3VjX3ZlcmlmeV9kb29yYmVsbHMoc3RydWN0IGlu
dGVsX2d1YyAqZ3VjKQo+ICAgICogUmV0dXJuOglBbiBpbnRlbF9ndWNfY2xpZW50IG9iamVjdCBp
ZiBzdWNjZXNzLCBlbHNlIE5VTEwuCj4gICAgKi8KPiAgIHN0YXRpYyBzdHJ1Y3QgaW50ZWxfZ3Vj
X2NsaWVudCAqCj4gLWd1Y19jbGllbnRfYWxsb2Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ICtndWNfY2xpZW50X2FsbG9jKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAo+ICAgCQkgdTMyIGVuZ2luZXMsCj4gICAJCSB1MzIgcHJpb3JpdHksCj4gICAJCSBzdHJ1Y3Qg
aTkxNV9nZW1fY29udGV4dCAqY3R4KQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9ndWNfY2xpZW50
ICpjbGllbnQ7Cj4gLQlzdHJ1Y3QgaW50ZWxfZ3VjICpndWMgPSAmZGV2X3ByaXYtPmd1YzsKPiAr
CXN0cnVjdCBpbnRlbF9ndWMgKmd1YyA9ICZpOTE1LT5ndWM7Cj4gICAJc3RydWN0IGk5MTVfdm1h
ICp2bWE7Cj4gICAJdm9pZCAqdmFkZHI7Cj4gICAJaW50IHJldDsKPiBAQCAtMTEyOSwyNyArMTEy
OSwyNyBAQCBzdGF0aWMgaW5saW5lIGJvb2wgY3R4X3NhdmVfcmVzdG9yZV9kaXNhYmxlZChzdHJ1
Y3QgaW50ZWxfY29udGV4dCAqY2UpCj4gICAKPiAgIHN0YXRpYyBpbnQgZ3VjX2NsaWVudHNfY3Jl
YXRlKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IGd1Y190b19pOTE1KGd1Yyk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IGd1Y190b19pOTE1KGd1Yyk7Cj4gICAJc3RydWN0IGludGVsX2d1Y19jbGll
bnQgKmNsaWVudDsKPiAgIAo+ICAgCUdFTV9CVUdfT04oZ3VjLT5leGVjYnVmX2NsaWVudCk7Cj4g
ICAJR0VNX0JVR19PTihndWMtPnByZWVtcHRfY2xpZW50KTsKPiAgIAo+IC0JY2xpZW50ID0gZ3Vj
X2NsaWVudF9hbGxvYyhkZXZfcHJpdiwKPiAtCQkJCSAgSU5URUxfSU5GTyhkZXZfcHJpdiktPmVu
Z2luZV9tYXNrLAo+ICsJY2xpZW50ID0gZ3VjX2NsaWVudF9hbGxvYyhpOTE1LAo+ICsJCQkJICBJ
TlRFTF9JTkZPKGk5MTUpLT5lbmdpbmVfbWFzaywKPiAgIAkJCQkgIEdVQ19DTElFTlRfUFJJT1JJ
VFlfS01EX05PUk1BTCwKPiAtCQkJCSAgZGV2X3ByaXYtPmtlcm5lbF9jb250ZXh0KTsKPiArCQkJ
CSAgaTkxNS0+a2VybmVsX2NvbnRleHQpOwo+ICAgCWlmIChJU19FUlIoY2xpZW50KSkgewo+ICAg
CQlEUk1fRVJST1IoIkZhaWxlZCB0byBjcmVhdGUgR3VDIGNsaWVudCBmb3Igc3VibWlzc2lvbiFc
biIpOwo+ICAgCQlyZXR1cm4gUFRSX0VSUihjbGllbnQpOwo+ICAgCX0KPiAgIAlndWMtPmV4ZWNi
dWZfY2xpZW50ID0gY2xpZW50Owo+ICAgCj4gLQlpZiAoZGV2X3ByaXYtPnByZWVtcHRfY29udGV4
dCkgewo+IC0JCWNsaWVudCA9IGd1Y19jbGllbnRfYWxsb2MoZGV2X3ByaXYsCj4gLQkJCQkJICBJ
TlRFTF9JTkZPKGRldl9wcml2KS0+ZW5naW5lX21hc2ssCj4gKwlpZiAoaTkxNS0+cHJlZW1wdF9j
b250ZXh0KSB7Cj4gKwkJY2xpZW50ID0gZ3VjX2NsaWVudF9hbGxvYyhpOTE1LAo+ICsJCQkJCSAg
SU5URUxfSU5GTyhpOTE1KS0+ZW5naW5lX21hc2ssCj4gICAJCQkJCSAgR1VDX0NMSUVOVF9QUklP
UklUWV9LTURfSElHSCwKPiAtCQkJCQkgIGRldl9wcml2LT5wcmVlbXB0X2NvbnRleHQpOwo+ICsJ
CQkJCSAgaTkxNS0+cHJlZW1wdF9jb250ZXh0KTsKPiAgIAkJaWYgKElTX0VSUihjbGllbnQpKSB7
Cj4gICAJCQlEUk1fRVJST1IoIkZhaWxlZCB0byBjcmVhdGUgR3VDIGNsaWVudCBmb3IgcHJlZW1w
dGlvbiFcbiIpOwo+ICAgCQkJZ3VjX2NsaWVudF9mcmVlKGd1Yy0+ZXhlY2J1Zl9jbGllbnQpOwo+
IEBAIC0xMjQ0LDcgKzEyNDQsNyBAQCBzdGF0aWMgdm9pZCBndWNfY2xpZW50c19kaXNhYmxlKHN0
cnVjdCBpbnRlbF9ndWMgKmd1YykKPiAgICAqLwo+ICAgaW50IGludGVsX2d1Y19zdWJtaXNzaW9u
X2luaXQoc3RydWN0IGludGVsX2d1YyAqZ3VjKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmU7Cj4gICAJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Cj4gICAJaW50IHJldDsK
PiBAQCAtMTI2Niw3ICsxMjY2LDcgQEAgaW50IGludGVsX2d1Y19zdWJtaXNzaW9uX2luaXQoc3Ry
dWN0IGludGVsX2d1YyAqZ3VjKQo+ICAgCWlmIChyZXQpCj4gICAJCWdvdG8gZXJyX3Bvb2w7Cj4g
ICAKPiAtCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGRldl9wcml2LCBpZCkgewo+ICsJZm9yX2Vh
Y2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKPiAgIAkJZ3VjLT5wcmVlbXB0X3dvcmtbaWRd
LmVuZ2luZSA9IGVuZ2luZTsKPiAgIAkJSU5JVF9XT1JLKCZndWMtPnByZWVtcHRfd29ya1tpZF0u
d29yaywgaW5qZWN0X3ByZWVtcHRfY29udGV4dCk7Cj4gICAJfQo+IEBAIC0xMjgwLDExICsxMjgw
LDExIEBAIGludCBpbnRlbF9ndWNfc3VibWlzc2lvbl9pbml0KHN0cnVjdCBpbnRlbF9ndWMgKmd1
YykKPiAgIAo+ICAgdm9pZCBpbnRlbF9ndWNfc3VibWlzc2lvbl9maW5pKHN0cnVjdCBpbnRlbF9n
dWMgKmd1YykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGd1
Y190b19pOTE1KGd1Yyk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd1Y190
b19pOTE1KGd1Yyk7Cj4gICAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwo+ICAgCWVu
dW0gaW50ZWxfZW5naW5lX2lkIGlkOwo+ICAgCj4gLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBk
ZXZfcHJpdiwgaWQpCj4gKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkKPiAgIAkJ
Y2FuY2VsX3dvcmtfc3luYygmZ3VjLT5wcmVlbXB0X3dvcmtbaWRdLndvcmspOwo+ICAgCj4gICAJ
Z3VjX2NsaWVudHNfZGVzdHJveShndWMpOwo+IEBAIC0xMjk0LDkgKzEyOTQsOSBAQCB2b2lkIGlu
dGVsX2d1Y19zdWJtaXNzaW9uX2Zpbmkoc3RydWN0IGludGVsX2d1YyAqZ3VjKQo+ICAgCQlndWNf
c3RhZ2VfZGVzY19wb29sX2Rlc3Ryb3koZ3VjKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBn
dWNfaW50ZXJydXB0c19jYXB0dXJlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiArc3RhdGljIHZvaWQgZ3VjX2ludGVycnVwdHNfY2FwdHVyZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+
Z3RfcG0ucnBzOwo+ICsJc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmk5MTUtPmd0X3BtLnJwczsK
PiAgIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4gICAJZW51bSBpbnRlbF9lbmdp
bmVfaWQgaWQ7Cj4gICAJaW50IGlycXM7Cj4gQEAgLTEzMDUsNyArMTMwNSw3IEBAIHN0YXRpYyB2
b2lkIGd1Y19pbnRlcnJ1cHRzX2NhcHR1cmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICAgCSAqIHRvIEd1Qwo+ICAgCSAqLwo+ICAgCWlycXMgPSBfTUFTS0VEX0JJVF9FTkFC
TEUoR0ZYX0lOVEVSUlVQVF9TVEVFUklORyk7Cj4gLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBk
ZXZfcHJpdiwgaWQpCj4gKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkKPiAgIAkJ
RU5HSU5FX1dSSVRFKGVuZ2luZSwgUklOR19NT0RFX0dFTjcsIGlycXMpOwo+ICAgCj4gICAJLyog
cm91dGUgVVNFUl9JTlRFUlJVUFQgdG8gSG9zdCwgYWxsIG90aGVycyBhcmUgc2VudCB0byBHdUMu
ICovCj4gQEAgLTEzMzksOSArMTMzOSw5IEBAIHN0YXRpYyB2b2lkIGd1Y19pbnRlcnJ1cHRzX2Nh
cHR1cmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCXJwcy0+cG1faW50
cm1za19tYnogJj0gfkdFTjhfUE1JTlRSX0RJU0FCTEVfUkVESVJFQ1RfVE9fR1VDOwo+ICAgfQo+
ICAgCj4gLXN0YXRpYyB2b2lkIGd1Y19pbnRlcnJ1cHRzX3JlbGVhc2Uoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBndWNfaW50ZXJydXB0c19yZWxlYXNl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RydWN0IGludGVsX3Jw
cyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Cj4gKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMg
PSAmaTkxNS0+Z3RfcG0ucnBzOwo+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsK
PiAgIAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKPiAgIAlpbnQgaXJxczsKPiBAQCAtMTM1Miw3
ICsxMzUyLDcgQEAgc3RhdGljIHZvaWQgZ3VjX2ludGVycnVwdHNfcmVsZWFzZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICovCj4gICAJaXJxcyA9IF9NQVNLRURfRklF
TEQoR0ZYX0ZPUldBUkRfVkJMQU5LX01BU0ssIEdGWF9GT1JXQVJEX1ZCTEFOS19ORVZFUik7Cj4g
ICAJaXJxcyB8PSBfTUFTS0VEX0JJVF9ESVNBQkxFKEdGWF9JTlRFUlJVUFRfU1RFRVJJTkcpOwo+
IC0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYsIGlkKQo+ICsJZm9yX2VhY2hfZW5n
aW5lKGVuZ2luZSwgaTkxNSwgaWQpCj4gICAJCUVOR0lORV9XUklURShlbmdpbmUsIFJJTkdfTU9E
RV9HRU43LCBpcnFzKTsKPiAgIAo+ICAgCS8qIHJvdXRlIGFsbCBHVCBpbnRlcnJ1cHRzIHRvIHRo
ZSBob3N0ICovCj4gQEAgLTE0MDgsNyArMTQwOCw3IEBAIHN0YXRpYyB2b2lkIGd1Y19zZXRfZGVm
YXVsdF9zdWJtaXNzaW9uKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiAgIAo+ICAg
aW50IGludGVsX2d1Y19zdWJtaXNzaW9uX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndWNfdG9faTkxNShn
dWMpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndWNfdG9faTkxNShndWMp
Owo+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKPiAgIAllbnVtIGludGVsX2Vu
Z2luZV9pZCBpZDsKPiAgIAlpbnQgZXJyOwo+IEBAIC0xNDMzLDkgKzE0MzMsOSBAQCBpbnQgaW50
ZWxfZ3VjX3N1Ym1pc3Npb25fZW5hYmxlKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKPiAgIAkJcmV0
dXJuIGVycjsKPiAgIAo+ICAgCS8qIFRha2Ugb3ZlciBmcm9tIG1hbnVhbCBjb250cm9sIG9mIEVM
U1AgKGV4ZWNsaXN0cykgKi8KPiAtCWd1Y19pbnRlcnJ1cHRzX2NhcHR1cmUoZGV2X3ByaXYpOwo+
ICsJZ3VjX2ludGVycnVwdHNfY2FwdHVyZShpOTE1KTsKPiAgIAo+IC0JZm9yX2VhY2hfZW5naW5l
KGVuZ2luZSwgZGV2X3ByaXYsIGlkKSB7Cj4gKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1
LCBpZCkgewo+ICAgCQllbmdpbmUtPnNldF9kZWZhdWx0X3N1Ym1pc3Npb24gPSBndWNfc2V0X2Rl
ZmF1bHRfc3VibWlzc2lvbjsKPiAgIAkJZW5naW5lLT5zZXRfZGVmYXVsdF9zdWJtaXNzaW9uKGVu
Z2luZSk7Cj4gICAJfQo+IEBAIC0xNDQ1LDExICsxNDQ1LDExIEBAIGludCBpbnRlbF9ndWNfc3Vi
bWlzc2lvbl9lbmFibGUoc3RydWN0IGludGVsX2d1YyAqZ3VjKQo+ICAgCj4gICB2b2lkIGludGVs
X2d1Y19zdWJtaXNzaW9uX2Rpc2FibGUoc3RydWN0IGludGVsX2d1YyAqZ3VjKQo+ICAgewo+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiAgIAo+
IC0JR0VNX0JVR19PTihkZXZfcHJpdi0+Z3QuYXdha2UpOyAvKiBHVCBzaG91bGQgYmUgcGFya2Vk
IGZpcnN0ICovCj4gKwlHRU1fQlVHX09OKGk5MTUtPmd0LmF3YWtlKTsgLyogR1Qgc2hvdWxkIGJl
IHBhcmtlZCBmaXJzdCAqLwo+ICAgCj4gLQlndWNfaW50ZXJydXB0c19yZWxlYXNlKGRldl9wcml2
KTsKPiArCWd1Y19pbnRlcnJ1cHRzX3JlbGVhc2UoaTkxNSk7Cj4gICAJZ3VjX2NsaWVudHNfZGlz
YWJsZShndWMpOwo+ICAgfQo+ICAgCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2d2dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3Z0LmMKPiBpbmRleCAx
ZDdkMjZlNGNmMTQuLmI1MGQzMWEyZTA5NSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9ndnQuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d2dC5j
Cj4gQEAgLTM5LDE3ICszOSwxNyBAQAo+ICAgICogZG9jIGlzIGF2YWlsYWJsZSBvbiBodHRwczov
LzAxLm9yZy9ncm91cC8yMjMwL2RvY3VtZW50YXRpb24tbGlzdC4KPiAgICAqLwo+ICAgCj4gLXN0
YXRpYyBib29sIGlzX3N1cHBvcnRlZF9kZXZpY2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ICtzdGF0aWMgYm9vbCBpc19zdXBwb3J0ZWRfZGV2aWNlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JaWYgKElTX0JST0FEV0VMTChkZXZfcHJpdikpCj4g
KwlpZiAoSVNfQlJPQURXRUxMKGk5MTUpKQo+ICAgCQlyZXR1cm4gdHJ1ZTsKPiAtCWlmIChJU19T
S1lMQUtFKGRldl9wcml2KSkKPiArCWlmIChJU19TS1lMQUtFKGk5MTUpKQo+ICAgCQlyZXR1cm4g
dHJ1ZTsKPiAtCWlmIChJU19LQUJZTEFLRShkZXZfcHJpdikpCj4gKwlpZiAoSVNfS0FCWUxBS0Uo
aTkxNSkpCj4gICAJCXJldHVybiB0cnVlOwo+IC0JaWYgKElTX0JST1hUT04oZGV2X3ByaXYpKQo+
ICsJaWYgKElTX0JST1hUT04oaTkxNSkpCj4gICAJCXJldHVybiB0cnVlOwo+IC0JaWYgKElTX0NP
RkZFRUxBS0UoZGV2X3ByaXYpKQo+ICsJaWYgKElTX0NPRkZFRUxBS0UoaTkxNSkpCj4gICAJCXJl
dHVybiB0cnVlOwo+ICAgCj4gICAJcmV0dXJuIGZhbHNlOwo+IEBAIC01NywyMSArNTcsMjEgQEAg
c3RhdGljIGJvb2wgaXNfc3VwcG9ydGVkX2RldmljZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxfZ3Z0X3Nhbml0aXplX29wdGlvbnMg
LSBzYW5pdGl6ZSBHVlQgcmVsYXRlZCBvcHRpb25zCj4gLSAqIEBkZXZfcHJpdjogZHJtIGk5MTUg
cHJpdmF0ZSBkYXRhCj4gKyAqIEBpOTE1OiBkcm0gaTkxNSBwcml2YXRlIGRhdGEKPiAgICAqCj4g
ICAgKiBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBhdCB0aGUgaTkxNSBvcHRpb25zIHNhbml0aXpl
IHN0YWdlLgo+ICAgICovCj4gLXZvaWQgaW50ZWxfZ3Z0X3Nhbml0aXplX29wdGlvbnMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGludGVsX2d2dF9zYW5pdGl6ZV9v
cHRpb25zKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCWlmICghaTkx
NV9tb2RwYXJhbXMuZW5hYmxlX2d2dCkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQlpZiAoaW50ZWxf
dmdwdV9hY3RpdmUoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoaW50ZWxfdmdwdV9hY3RpdmUoaTkxNSkp
IHsKPiAgIAkJRFJNX0lORk8oIkdWVC1nIGlzIGRpc2FibGVkIGZvciBndWVzdFxuIik7Cj4gICAJ
CWdvdG8gYmFpbDsKPiAgIAl9Cj4gICAKPiAtCWlmICghaXNfc3VwcG9ydGVkX2RldmljZShkZXZf
cHJpdikpIHsKPiArCWlmICghaXNfc3VwcG9ydGVkX2RldmljZShpOTE1KSkgewo+ICAgCQlEUk1f
SU5GTygiVW5zdXBwb3J0ZWQgZGV2aWNlLiBHVlQtZyBpcyBkaXNhYmxlZFxuIik7Cj4gICAJCWdv
dG8gYmFpbDsKPiAgIAl9Cj4gQEAgLTgzLDcgKzgzLDcgQEAgdm9pZCBpbnRlbF9ndnRfc2FuaXRp
emVfb3B0aW9ucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAKPiAgIC8q
Kgo+ICAgICogaW50ZWxfZ3Z0X2luaXQgLSBpbml0aWFsaXplIEdWVCBjb21wb25lbnRzCj4gLSAq
IEBkZXZfcHJpdjogZHJtIGk5MTUgcHJpdmF0ZSBkYXRhCj4gKyAqIEBpOTE1OiBkcm0gaTkxNSBw
cml2YXRlIGRhdGEKPiAgICAqCj4gICAgKiBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBhdCB0aGUg
aW5pdGlhbGl6YXRpb24gc3RhZ2UgdG8gY3JlYXRlIGEgR1ZUIGRldmljZS4KPiAgICAqCj4gQEAg
LTkxLDcgKzkxLDcgQEAgdm9pZCBpbnRlbF9ndnRfc2FuaXRpemVfb3B0aW9ucyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAgKiBaZXJvIG9uIHN1Y2Nlc3MsIG5lZ2F0aXZl
IGVycm9yIGNvZGUgaWYgZmFpbGVkLgo+ICAgICoKPiAgICAqLwo+IC1pbnQgaW50ZWxfZ3Z0X2lu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtpbnQgaW50ZWxfZ3Z0X2lu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJaW50IHJldDsKPiAg
IAo+IEBAIC0xMDMsMTIgKzEwMywxMiBAQCBpbnQgaW50ZWxfZ3Z0X2luaXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQlyZXR1cm4gMDsKPiAgIAl9Cj4gICAKPiAtCWlm
IChVU0VTX0dVQ19TVUJNSVNTSU9OKGRldl9wcml2KSkgewo+ICsJaWYgKFVTRVNfR1VDX1NVQk1J
U1NJT04oaTkxNSkpIHsKPiAgIAkJRFJNX0VSUk9SKCJpOTE1IEdWVC1nIGxvYWRpbmcgZmFpbGVk
IGR1ZSB0byBHcmFwaGljcyB2aXJ0dWFsaXphdGlvbiBpcyBub3QgeWV0IHN1cHBvcnRlZCB3aXRo
IEd1QyBzdWJtaXNzaW9uXG4iKTsKPiAgIAkJcmV0dXJuIC1FSU87Cj4gICAJfQo+ICAgCj4gLQly
ZXQgPSBpbnRlbF9ndnRfaW5pdF9kZXZpY2UoZGV2X3ByaXYpOwo+ICsJcmV0ID0gaW50ZWxfZ3Z0
X2luaXRfZGV2aWNlKGk5MTUpOwo+ICAgCWlmIChyZXQpIHsKPiAgIAkJRFJNX0RFQlVHX0RSSVZF
UigiRmFpbCB0byBpbml0IEdWVCBkZXZpY2VcbiIpOwo+ICAgCQlnb3RvIGJhaWw7Cj4gQEAgLTEy
MywxNSArMTIzLDE1IEBAIGludCBpbnRlbF9ndnRfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxfZ3Z0X2NsZWFudXAgLSBjbGVh
bnVwIEdWVCBjb21wb25lbnRzIHdoZW4gaTkxNSBkcml2ZXIgaXMgdW5sb2FkaW5nCj4gLSAqIEBk
ZXZfcHJpdjogZHJtIGk5MTUgcHJpdmF0ZSAqCj4gKyAqIEBpOTE1OiBkcm0gaTkxNSBwcml2YXRl
ICoKPiAgICAqCj4gICAgKiBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBhdCB0aGUgaTkxNSBkcml2
ZXIgdW5sb2FkaW5nIHN0YWdlLCB0byBzaHV0ZG93bgo+ICAgICogR1ZUIGNvbXBvbmVudHMgYW5k
IHJlbGVhc2UgdGhlIHJlbGF0ZWQgcmVzb3VyY2VzLgo+ICAgICovCj4gLXZvaWQgaW50ZWxfZ3Z0
X2NsZWFudXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGludGVs
X2d2dF9jbGVhbnVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JaWYg
KCFpbnRlbF9ndnRfYWN0aXZlKGRldl9wcml2KSkKPiArCWlmICghaW50ZWxfZ3Z0X2FjdGl2ZShp
OTE1KSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQlpbnRlbF9ndnRfY2xlYW5fZGV2aWNlKGRldl9w
cml2KTsKPiArCWludGVsX2d2dF9jbGVhbl9kZXZpY2UoaTkxNSk7Cj4gICB9Cj4gZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d2dC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfZ3Z0LmgKPiBpbmRleCA2MWIyNDY0NzAyODIuLjZmODFlMjZjYjlhZCAxMDA2NDQK
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndnQuaAo+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX2d2dC5oCj4gQEAgLTI3LDIyICsyNywyMiBAQAo+ICAgc3RydWN0
IGludGVsX2d2dDsKPiAgIAo+ICAgI2lmZGVmIENPTkZJR19EUk1fSTkxNV9HVlQKPiAtaW50IGlu
dGVsX2d2dF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gLXZvaWQg
aW50ZWxfZ3Z0X2NsZWFudXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAt
aW50IGludGVsX2d2dF9pbml0X2RldmljZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpOwo+IC12b2lkIGludGVsX2d2dF9jbGVhbl9kZXZpY2Uoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KTsKPiAraW50IGludGVsX2d2dF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KTsKPiArdm9pZCBpbnRlbF9ndnRfY2xlYW51cChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSk7Cj4gK2ludCBpbnRlbF9ndnRfaW5pdF9kZXZpY2Uoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lkIGludGVsX2d2dF9jbGVhbl9kZXZpY2Uoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgaW50IGludGVsX2d2dF9pbml0X2hvc3Qodm9pZCk7
Cj4gLXZvaWQgaW50ZWxfZ3Z0X3Nhbml0aXplX29wdGlvbnMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KTsKPiArdm9pZCBpbnRlbF9ndnRfc2FuaXRpemVfb3B0aW9ucyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICAjZWxzZQo+IC1zdGF0aWMgaW5saW5lIGludCBp
bnRlbF9ndnRfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRp
YyBpbmxpbmUgaW50IGludGVsX2d2dF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ICAgewo+ICAgCXJldHVybiAwOwo+ICAgfQo+IC1zdGF0aWMgaW5saW5lIHZvaWQgaW50ZWxf
Z3Z0X2NsZWFudXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMg
aW5saW5lIHZvaWQgaW50ZWxfZ3Z0X2NsZWFudXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCj4gICB7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGlubGluZSB2b2lkIGludGVsX2d2dF9zYW5p
dGl6ZV9vcHRpb25zKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGlj
IGlubGluZSB2b2lkIGludGVsX2d2dF9zYW5pdGl6ZV9vcHRpb25zKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQo+ICAgewo+ICAgfQo+ICAgI2VuZGlmCj4gZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX2hkY3AuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X2hkY3AuYwo+IGluZGV4IGJjM2E5NGQ0OTFjNC4uN2RmNWYxOWI1MmQ1IDEwMDY0NAo+IC0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2hkY3AuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX2hkY3AuYwo+IEBAIC04MSw3ICs4MSw3IEBAIGJvb2wgaW50ZWxfaGRjcF9j
YXBhYmxlKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIC8qIElzIEhEQ1Ay
LjIgY2FwYWJsZSBvbiBQbGF0Zm9ybSBhbmQgU2luayAqLwo+ICAgYm9vbCBpbnRlbF9oZGNwMl9j
YXBhYmxlKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIHsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRl
dik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9y
LT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3Bv
cnQgPSBjb25uX3RvX2RpZ19wb3J0KGNvbm5lY3Rvcik7Cj4gICAJc3RydWN0IGludGVsX2hkY3Ag
KmhkY3AgPSAmY29ubmVjdG9yLT5oZGNwOwo+ICAgCWJvb2wgY2FwYWJsZSA9IGZhbHNlOwo+IEBA
IC05MSwxMiArOTEsMTIgQEAgYm9vbCBpbnRlbF9oZGNwMl9jYXBhYmxlKHN0cnVjdCBpbnRlbF9j
b25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAgCj4gICAJLyogTUVJ
IGludGVyZmFjZSBpcyBzb2xpZCAqLwo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmhkY3BfY29t
cF9tdXRleCk7Cj4gLQlpZiAoIWRldl9wcml2LT5oZGNwX2NvbXBfYWRkZWQgfHwgICFkZXZfcHJp
di0+aGRjcF9tYXN0ZXIpIHsKPiAtCQltdXRleF91bmxvY2soJmRldl9wcml2LT5oZGNwX2NvbXBf
bXV0ZXgpOwo+ICsJbXV0ZXhfbG9jaygmaTkxNS0+aGRjcF9jb21wX211dGV4KTsKPiArCWlmICgh
aTkxNS0+aGRjcF9jb21wX2FkZGVkIHx8ICAhaTkxNS0+aGRjcF9tYXN0ZXIpIHsKPiArCQltdXRl
eF91bmxvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gICAJCXJldHVybiBmYWxzZTsKPiAg
IAl9Cj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ICsJbXV0
ZXhfdW5sb2NrKCZpOTE1LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ICAgCj4gICAJLyogU2luaydzIGNh
cGFiaWxpdHkgZm9yIEhEQ1AyLjIgKi8KPiAgIAloZGNwLT5zaGltLT5oZGNwXzJfMl9jYXBhYmxl
KGludGVsX2RpZ19wb3J0LCAmY2FwYWJsZSk7Cj4gQEAgLTEwNiw3ICsxMDYsNyBAQCBib29sIGlu
dGVsX2hkY3AyX2NhcGFibGUoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ICAg
Cj4gICBzdGF0aWMgaW5saW5lIGJvb2wgaW50ZWxfaGRjcF9pbl91c2Uoc3RydWN0IGludGVsX2Nv
bm5lY3RvciAqY29ubmVjdG9yKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiAgIAllbnVt
IHBvcnQgcG9ydCA9IGNvbm5lY3Rvci0+ZW5jb2Rlci0+cG9ydDsKPiAgIAl1MzIgcmVnOwo+ICAg
Cj4gQEAgLTExNiw3ICsxMTYsNyBAQCBzdGF0aWMgaW5saW5lIGJvb2wgaW50ZWxfaGRjcF9pbl91
c2Uoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ICAgCj4gICBzdGF0aWMgaW5s
aW5lIGJvb2wgaW50ZWxfaGRjcDJfaW5fdXNlKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5l
Y3RvcikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gICAJZW51bSBwb3J0IHBvcnQgPSBj
b25uZWN0b3ItPmVuY29kZXItPnBvcnQ7Cj4gICAJdTMyIHJlZzsKPiAgIAo+IEBAIC0xNDUsOSAr
MTQ1LDkgQEAgc3RhdGljIGludCBpbnRlbF9oZGNwX3BvbGxfa3N2X2ZpZm8oc3RydWN0IGludGVs
X2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCj4gICAJcmV0dXJuIDA7Cj4gICB9Cj4gICAK
PiAtc3RhdGljIGJvb2wgaGRjcF9rZXlfbG9hZGFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICtzdGF0aWMgYm9vbCBoZGNwX2tleV9sb2FkYWJsZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBv
d2VyX2RvbWFpbnMgPSAmZGV2X3ByaXYtPnBvd2VyX2RvbWFpbnM7Cj4gKwlzdHJ1Y3QgaTkxNV9w
b3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmk5MTUtPnBvd2VyX2RvbWFpbnM7Cj4gICAJ
c3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbDsKPiAgIAllbnVtIGk5MTVfcG93ZXJf
d2VsbF9pZCBpZDsKPiAgIAlib29sIGVuYWJsZWQgPSBmYWxzZTsKPiBAQCAtMTU2LDcgKzE1Niw3
IEBAIHN0YXRpYyBib29sIGhkY3Bfa2V5X2xvYWRhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiAgIAkgKiBPbiBIU1cgYW5kIEJEVywgRGlzcGxheSBIVyBsb2FkcyB0aGUg
S2V5IGFzIHNvb24gYXMgRGlzcGxheSByZXN1bWVzLgo+ICAgCSAqIE9uIGFsbCBCWFQrLCBTVyBj
YW4gbG9hZCB0aGUga2V5cyBvbmx5IHdoZW4gdGhlIFBXIzEgaXMgdHVybmVkIG9uLgo+ICAgCSAq
Lwo+IC0JaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElTX0JST0FEV0VMTChkZXZfcHJpdikp
Cj4gKwlpZiAoSVNfSEFTV0VMTChpOTE1KSB8fCBJU19CUk9BRFdFTEwoaTkxNSkpCj4gICAJCWlk
ID0gSFNXX0RJU1BfUFdfR0xPQkFMOwo+ICAgCWVsc2UKPiAgIAkJaWQgPSBTS0xfRElTUF9QV18x
Owo+IEBAIC0xNjQsOSArMTY0LDkgQEAgc3RhdGljIGJvb2wgaGRjcF9rZXlfbG9hZGFibGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCW11dGV4X2xvY2soJnBvd2VyX2Rv
bWFpbnMtPmxvY2spOwo+ICAgCj4gICAJLyogUEcxIChwb3dlciB3ZWxsICMxKSBuZWVkcyB0byBi
ZSBlbmFibGVkICovCj4gLQlmb3JfZWFjaF9wb3dlcl93ZWxsKGRldl9wcml2LCBwb3dlcl93ZWxs
KSB7Cj4gKwlmb3JfZWFjaF9wb3dlcl93ZWxsKGk5MTUsIHBvd2VyX3dlbGwpIHsKPiAgIAkJaWYg
KHBvd2VyX3dlbGwtPmRlc2MtPmlkID09IGlkKSB7Cj4gLQkJCWVuYWJsZWQgPSBwb3dlcl93ZWxs
LT5kZXNjLT5vcHMtPmlzX2VuYWJsZWQoZGV2X3ByaXYsCj4gKwkJCWVuYWJsZWQgPSBwb3dlcl93
ZWxsLT5kZXNjLT5vcHMtPmlzX2VuYWJsZWQoaTkxNSwKPiAgIAkJCQkJCQkJICAgIHBvd2VyX3dl
bGwpOwo+ICAgCQkJYnJlYWs7Cj4gICAJCX0KPiBAQCAtMTgyLDE0ICsxODIsMTQgQEAgc3RhdGlj
IGJvb2wgaGRjcF9rZXlfbG9hZGFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ICAgCXJldHVybiBlbmFibGVkOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGludGVsX2hk
Y3BfY2xlYXJfa2V5cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRp
YyB2b2lkIGludGVsX2hkY3BfY2xlYXJfa2V5cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiAgIHsKPiAgIAlJOTE1X1dSSVRFKEhEQ1BfS0VZX0NPTkYsIEhEQ1BfQ0xFQVJfS0VZU19U
UklHR0VSKTsKPiAgIAlJOTE1X1dSSVRFKEhEQ1BfS0VZX1NUQVRVUywgSERDUF9LRVlfTE9BRF9E
T05FIHwgSERDUF9LRVlfTE9BRF9TVEFUVVMgfAo+ICAgCQkgICBIRENQX0ZVU0VfSU5fUFJPR1JF
U1MgfCBIRENQX0ZVU0VfRVJST1IgfCBIRENQX0ZVU0VfRE9ORSk7Cj4gICB9Cj4gICAKPiAtc3Rh
dGljIGludCBpbnRlbF9oZGNwX2xvYWRfa2V5cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gK3N0YXRpYyBpbnQgaW50ZWxfaGRjcF9sb2FkX2tleXMoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJaW50IHJldDsKPiAgIAl1MzIgdmFsOwo+IEBAIC0y
MDIsNyArMjAyLDcgQEAgc3RhdGljIGludCBpbnRlbF9oZGNwX2xvYWRfa2V5cyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICogT24gSFNXIGFuZCBCRFcgSFcgbG9hZHMg
dGhlIEhEQ1AxLjQgS2V5IHdoZW4gRGlzcGxheSBjb21lcwo+ICAgCSAqIG91dCBvZiByZXNldC4g
U28gaWYgS2V5IGlzIG5vdCBhbHJlYWR5IGxvYWRlZCwgaXRzIGFuIGVycm9yIHN0YXRlLgo+ICAg
CSAqLwo+IC0JaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElTX0JST0FEV0VMTChkZXZfcHJp
dikpCj4gKwlpZiAoSVNfSEFTV0VMTChpOTE1KSB8fCBJU19CUk9BRFdFTEwoaTkxNSkpCj4gICAJ
CWlmICghKEk5MTVfUkVBRChIRENQX0tFWV9TVEFUVVMpICYgSERDUF9LRVlfTE9BRF9ET05FKSkK
PiAgIAkJCXJldHVybiAtRU5YSU87Cj4gICAKPiBAQCAtMjEzLDggKzIxMyw4IEBAIHN0YXRpYyBp
bnQgaW50ZWxfaGRjcF9sb2FkX2tleXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ICAgCSAqIHBsYXRmb3JtcyBleGNlcHQgQlhUIGFuZCBHTEssIGRpZmZlciBpbiB0aGUga2V5
IGxvYWQgdHJpZ2dlciBwcm9jZXNzCj4gICAJICogZnJvbSBvdGhlciBwbGF0Zm9ybXMuIFNvIEdF
TjlfQkMgdXNlcyB0aGUgR1QgRHJpdmVyIE1haWxib3ggaS9mLgo+ICAgCSAqLwo+IC0JaWYgKElT
X0dFTjlfQkMoZGV2X3ByaXYpKSB7Cj4gLQkJcmV0ID0gc2FuZHlicmlkZ2VfcGNvZGVfd3JpdGUo
ZGV2X3ByaXYsCj4gKwlpZiAoSVNfR0VOOV9CQyhpOTE1KSkgewo+ICsJCXJldCA9IHNhbmR5YnJp
ZGdlX3Bjb2RlX3dyaXRlKGk5MTUsCj4gICAJCQkJCSAgICAgIFNLTF9QQ09ERV9MT0FEX0hEQ1Bf
S0VZUywgMSk7Cj4gICAJCWlmIChyZXQpIHsKPiAgIAkJCURSTV9FUlJPUigiRmFpbGVkIHRvIGlu
aXRpYXRlIEhEQ1Aga2V5IGxvYWQgKCVkKVxuIiwKPiBAQCAtMjI2LDcgKzIyNiw3IEBAIHN0YXRp
YyBpbnQgaW50ZWxfaGRjcF9sb2FkX2tleXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICAgCX0KPiAgIAo+ICAgCS8qIFdhaXQgZm9yIHRoZSBrZXlzIHRvIGxvYWQgKDUwMHVz
KSAqLwo+IC0JcmV0ID0gX19pbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29y
ZSwgSERDUF9LRVlfU1RBVFVTLAo+ICsJcmV0ID0gX19pbnRlbF93YWl0X2Zvcl9yZWdpc3Rlcigm
aTkxNS0+dW5jb3JlLCBIRENQX0tFWV9TVEFUVVMsCj4gICAJCQkJCUhEQ1BfS0VZX0xPQURfRE9O
RSwgSERDUF9LRVlfTE9BRF9ET05FLAo+ICAgCQkJCQkxMCwgMSwgJnZhbCk7Cj4gICAJaWYgKHJl
dCkKPiBAQCAtMjQxLDEwICsyNDEsMTAgQEAgc3RhdGljIGludCBpbnRlbF9oZGNwX2xvYWRfa2V5
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICB9Cj4gICAKPiAgIC8qIFJl
dHVybnMgdXBkYXRlZCBTSEEtMSBpbmRleCAqLwo+IC1zdGF0aWMgaW50IGludGVsX3dyaXRlX3No
YV90ZXh0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIHNoYV90ZXh0KQo+
ICtzdGF0aWMgaW50IGludGVsX3dyaXRlX3NoYV90ZXh0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LCB1MzIgc2hhX3RleHQpCj4gICB7Cj4gICAJSTkxNV9XUklURShIRENQX1NIQV9URVhU
LCBzaGFfdGV4dCk7Cj4gLQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51
bmNvcmUsIEhEQ1BfUkVQX0NUTCwKPiArCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmaTkx
NS0+dW5jb3JlLCBIRENQX1JFUF9DVEwsCj4gICAJCQkJICAgIEhEQ1BfU0hBMV9SRUFEWSwgSERD
UF9TSEExX1JFQURZLCAxKSkgewo+ICAgCQlEUk1fRVJST1IoIlRpbWVkIG91dCB3YWl0aW5nIGZv
ciBTSEExIHJlYWR5XG4iKTsKPiAgIAkJcmV0dXJuIC1FVElNRURPVVQ7Cj4gQEAgLTI3OSwxMSAr
Mjc5LDExIEBAIGludCBpbnRlbF9oZGNwX3ZhbGlkYXRlX3ZfcHJpbWUoc3RydWN0IGludGVsX2Rp
Z2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCj4gICAJCQkJY29uc3Qgc3RydWN0IGludGVsX2hk
Y3Bfc2hpbSAqc2hpbSwKPiAgIAkJCQl1OCAqa3N2X2ZpZm8sIHU4IG51bV9kb3duc3RyZWFtLCB1
OCAqYnN0YXR1cykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdjsK
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1Owo+ICAgCXUzMiB2cHJpbWUsIHNoYV90
ZXh0LCBzaGFfbGVmdG92ZXJzLCByZXBfY3RsOwo+ICAgCWludCByZXQsIGksIGosIHNoYV9pZHg7
Cj4gICAKPiAtCWRldl9wcml2ID0gaW50ZWxfZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYtPmRldl9w
cml2YXRlOwo+ICsJaTkxNSA9IGludGVsX2RpZ19wb3J0LT5iYXNlLmJhc2UuZGV2LT5kZXZfcHJp
dmF0ZTsKPiAgIAo+ICAgCS8qIFByb2Nlc3MgVicgdmFsdWVzIGZyb20gdGhlIHJlY2VpdmVyICov
Cj4gICAJZm9yIChpID0gMDsgaSA8IERSTV9IRENQX1ZfUFJJTUVfTlVNX1BBUlRTOyBpKyspIHsK
PiBAQCAtMzE3LDcgKzMxNyw3IEBAIGludCBpbnRlbF9oZGNwX3ZhbGlkYXRlX3ZfcHJpbWUoc3Ry
dWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCj4gICAJCWZvciAoaiA9IDA7
IGogPCBzaGFfZW1wdHk7IGorKykKPiAgIAkJCXNoYV90ZXh0IHw9IGtzdltqXSA8PCAoKHNpemVv
ZihzaGFfdGV4dCkgLSBqIC0gMSkgKiA4KTsKPiAgIAo+IC0JCXJldCA9IGludGVsX3dyaXRlX3No
YV90ZXh0KGRldl9wcml2LCBzaGFfdGV4dCk7Cj4gKwkJcmV0ID0gaW50ZWxfd3JpdGVfc2hhX3Rl
eHQoaTkxNSwgc2hhX3RleHQpOwo+ICAgCQlpZiAocmV0IDwgMCkKPiAgIAkJCXJldHVybiByZXQ7
Cj4gICAKPiBAQCAtMzQwLDcgKzM0MCw3IEBAIGludCBpbnRlbF9oZGNwX3ZhbGlkYXRlX3ZfcHJp
bWUoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCj4gICAJCWlmIChz
aXplb2Yoc2hhX3RleHQpID4gc2hhX2xlZnRvdmVycykKPiAgIAkJCWNvbnRpbnVlOwo+ICAgCj4g
LQkJcmV0ID0gaW50ZWxfd3JpdGVfc2hhX3RleHQoZGV2X3ByaXYsIHNoYV90ZXh0KTsKPiArCQly
ZXQgPSBpbnRlbF93cml0ZV9zaGFfdGV4dChpOTE1LCBzaGFfdGV4dCk7Cj4gICAJCWlmIChyZXQg
PCAwKQo+ICAgCQkJcmV0dXJuIHJldDsKPiAgIAkJc2hhX2xlZnRvdmVycyA9IDA7Cj4gQEAgLTM1
Nyw3ICszNTcsNyBAQCBpbnQgaW50ZWxfaGRjcF92YWxpZGF0ZV92X3ByaW1lKHN0cnVjdCBpbnRl
bF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0LAo+ICAgCWlmIChzaGFfbGVmdG92ZXJzID09
IDApIHsKPiAgIAkJLyogV3JpdGUgMTYgYml0cyBvZiB0ZXh0LCAxNiBiaXRzIG9mIE0wICovCj4g
ICAJCUk5MTVfV1JJVEUoSERDUF9SRVBfQ1RMLCByZXBfY3RsIHwgSERDUF9TSEExX1RFWFRfMTYp
Owo+IC0JCXJldCA9IGludGVsX3dyaXRlX3NoYV90ZXh0KGRldl9wcml2LAo+ICsJCXJldCA9IGlu
dGVsX3dyaXRlX3NoYV90ZXh0KGk5MTUsCj4gICAJCQkJCSAgIGJzdGF0dXNbMF0gPDwgOCB8IGJz
dGF0dXNbMV0pOwo+ICAgCQlpZiAocmV0IDwgMCkKPiAgIAkJCXJldHVybiByZXQ7Cj4gQEAgLTM2
NSwxNCArMzY1LDE0IEBAIGludCBpbnRlbF9oZGNwX3ZhbGlkYXRlX3ZfcHJpbWUoc3RydWN0IGlu
dGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCj4gICAKPiAgIAkJLyogV3JpdGUgMzIg
Yml0cyBvZiBNMCAqLwo+ICAgCQlJOTE1X1dSSVRFKEhEQ1BfUkVQX0NUTCwgcmVwX2N0bCB8IEhE
Q1BfU0hBMV9URVhUXzApOwo+IC0JCXJldCA9IGludGVsX3dyaXRlX3NoYV90ZXh0KGRldl9wcml2
LCAwKTsKPiArCQlyZXQgPSBpbnRlbF93cml0ZV9zaGFfdGV4dChpOTE1LCAwKTsKPiAgIAkJaWYg
KHJldCA8IDApCj4gICAJCQlyZXR1cm4gcmV0Owo+ICAgCQlzaGFfaWR4ICs9IHNpemVvZihzaGFf
dGV4dCk7Cj4gICAKPiAgIAkJLyogV3JpdGUgMTYgYml0cyBvZiBNMCAqLwo+ICAgCQlJOTE1X1dS
SVRFKEhEQ1BfUkVQX0NUTCwgcmVwX2N0bCB8IEhEQ1BfU0hBMV9URVhUXzE2KTsKPiAtCQlyZXQg
PSBpbnRlbF93cml0ZV9zaGFfdGV4dChkZXZfcHJpdiwgMCk7Cj4gKwkJcmV0ID0gaW50ZWxfd3Jp
dGVfc2hhX3RleHQoaTkxNSwgMCk7Cj4gICAJCWlmIChyZXQgPCAwKQo+ICAgCQkJcmV0dXJuIHJl
dDsKPiAgIAkJc2hhX2lkeCArPSBzaXplb2Yoc2hhX3RleHQpOwo+IEBAIC0zODMsMjEgKzM4Mywy
MSBAQCBpbnQgaW50ZWxfaGRjcF92YWxpZGF0ZV92X3ByaW1lKHN0cnVjdCBpbnRlbF9kaWdpdGFs
X3BvcnQgKmludGVsX2RpZ19wb3J0LAo+ICAgCQlzaGFfdGV4dCB8PSBic3RhdHVzWzBdIDw8IDE2
IHwgYnN0YXR1c1sxXSA8PCA4Owo+ICAgCQkvKiBPbmx5IDI0LWJpdHMgb2YgZGF0YSwgbXVzdCBi
ZSBpbiB0aGUgTFNCICovCj4gICAJCXNoYV90ZXh0ID0gKHNoYV90ZXh0ICYgMHhmZmZmZmYwMCkg
Pj4gODsKPiAtCQlyZXQgPSBpbnRlbF93cml0ZV9zaGFfdGV4dChkZXZfcHJpdiwgc2hhX3RleHQp
Owo+ICsJCXJldCA9IGludGVsX3dyaXRlX3NoYV90ZXh0KGk5MTUsIHNoYV90ZXh0KTsKPiAgIAkJ
aWYgKHJldCA8IDApCj4gICAJCQlyZXR1cm4gcmV0Owo+ICAgCQlzaGFfaWR4ICs9IHNpemVvZihz
aGFfdGV4dCk7Cj4gICAKPiAgIAkJLyogV3JpdGUgMzIgYml0cyBvZiBNMCAqLwo+ICAgCQlJOTE1
X1dSSVRFKEhEQ1BfUkVQX0NUTCwgcmVwX2N0bCB8IEhEQ1BfU0hBMV9URVhUXzApOwo+IC0JCXJl
dCA9IGludGVsX3dyaXRlX3NoYV90ZXh0KGRldl9wcml2LCAwKTsKPiArCQlyZXQgPSBpbnRlbF93
cml0ZV9zaGFfdGV4dChpOTE1LCAwKTsKPiAgIAkJaWYgKHJldCA8IDApCj4gICAJCQlyZXR1cm4g
cmV0Owo+ICAgCQlzaGFfaWR4ICs9IHNpemVvZihzaGFfdGV4dCk7Cj4gICAKPiAgIAkJLyogV3Jp
dGUgMjQgYml0cyBvZiBNMCAqLwo+ICAgCQlJOTE1X1dSSVRFKEhEQ1BfUkVQX0NUTCwgcmVwX2N0
bCB8IEhEQ1BfU0hBMV9URVhUXzgpOwo+IC0JCXJldCA9IGludGVsX3dyaXRlX3NoYV90ZXh0KGRl
dl9wcml2LCAwKTsKPiArCQlyZXQgPSBpbnRlbF93cml0ZV9zaGFfdGV4dChpOTE1LCAwKTsKPiAg
IAkJaWYgKHJldCA8IDApCj4gICAJCQlyZXR1cm4gcmV0Owo+ICAgCQlzaGFfaWR4ICs9IHNpemVv
ZihzaGFfdGV4dCk7Cj4gQEAgLTQwNiw3ICs0MDYsNyBAQCBpbnQgaW50ZWxfaGRjcF92YWxpZGF0
ZV92X3ByaW1lKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0LAo+ICAg
CQkvKiBXcml0ZSAzMiBiaXRzIG9mIHRleHQgKi8KPiAgIAkJSTkxNV9XUklURShIRENQX1JFUF9D
VEwsIHJlcF9jdGwgfCBIRENQX1NIQTFfVEVYVF8zMik7Cj4gICAJCXNoYV90ZXh0IHw9IGJzdGF0
dXNbMF0gPDwgMjQgfCBic3RhdHVzWzFdIDw8IDE2Owo+IC0JCXJldCA9IGludGVsX3dyaXRlX3No
YV90ZXh0KGRldl9wcml2LCBzaGFfdGV4dCk7Cj4gKwkJcmV0ID0gaW50ZWxfd3JpdGVfc2hhX3Rl
eHQoaTkxNSwgc2hhX3RleHQpOwo+ICAgCQlpZiAocmV0IDwgMCkKPiAgIAkJCXJldHVybiByZXQ7
Cj4gICAJCXNoYV9pZHggKz0gc2l6ZW9mKHNoYV90ZXh0KTsKPiBAQCAtNDE0LDcgKzQxNCw3IEBA
IGludCBpbnRlbF9oZGNwX3ZhbGlkYXRlX3ZfcHJpbWUoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9y
dCAqaW50ZWxfZGlnX3BvcnQsCj4gICAJCS8qIFdyaXRlIDY0IGJpdHMgb2YgTTAgKi8KPiAgIAkJ
STkxNV9XUklURShIRENQX1JFUF9DVEwsIHJlcF9jdGwgfCBIRENQX1NIQTFfVEVYVF8wKTsKPiAg
IAkJZm9yIChpID0gMDsgaSA8IDI7IGkrKykgewo+IC0JCQlyZXQgPSBpbnRlbF93cml0ZV9zaGFf
dGV4dChkZXZfcHJpdiwgMCk7Cj4gKwkJCXJldCA9IGludGVsX3dyaXRlX3NoYV90ZXh0KGk5MTUs
IDApOwo+ICAgCQkJaWYgKHJldCA8IDApCj4gICAJCQkJcmV0dXJuIHJldDsKPiAgIAkJCXNoYV9p
ZHggKz0gc2l6ZW9mKHNoYV90ZXh0KTsKPiBAQCAtNDIzLDI4ICs0MjMsMjggQEAgaW50IGludGVs
X2hkY3BfdmFsaWRhdGVfdl9wcmltZShzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9k
aWdfcG9ydCwKPiAgIAkJLyogV3JpdGUgMzIgYml0cyBvZiB0ZXh0ICovCj4gICAJCUk5MTVfV1JJ
VEUoSERDUF9SRVBfQ1RMLCByZXBfY3RsIHwgSERDUF9TSEExX1RFWFRfMzIpOwo+ICAgCQlzaGFf
dGV4dCB8PSBic3RhdHVzWzBdIDw8IDI0Owo+IC0JCXJldCA9IGludGVsX3dyaXRlX3NoYV90ZXh0
KGRldl9wcml2LCBzaGFfdGV4dCk7Cj4gKwkJcmV0ID0gaW50ZWxfd3JpdGVfc2hhX3RleHQoaTkx
NSwgc2hhX3RleHQpOwo+ICAgCQlpZiAocmV0IDwgMCkKPiAgIAkJCXJldHVybiByZXQ7Cj4gICAJ
CXNoYV9pZHggKz0gc2l6ZW9mKHNoYV90ZXh0KTsKPiAgIAo+ICAgCQkvKiBXcml0ZSA4IGJpdHMg
b2YgdGV4dCwgMjQgYml0cyBvZiBNMCAqLwo+ICAgCQlJOTE1X1dSSVRFKEhEQ1BfUkVQX0NUTCwg
cmVwX2N0bCB8IEhEQ1BfU0hBMV9URVhUXzgpOwo+IC0JCXJldCA9IGludGVsX3dyaXRlX3NoYV90
ZXh0KGRldl9wcml2LCBic3RhdHVzWzFdKTsKPiArCQlyZXQgPSBpbnRlbF93cml0ZV9zaGFfdGV4
dChpOTE1LCBic3RhdHVzWzFdKTsKPiAgIAkJaWYgKHJldCA8IDApCj4gICAJCQlyZXR1cm4gcmV0
Owo+ICAgCQlzaGFfaWR4ICs9IHNpemVvZihzaGFfdGV4dCk7Cj4gICAKPiAgIAkJLyogV3JpdGUg
MzIgYml0cyBvZiBNMCAqLwo+ICAgCQlJOTE1X1dSSVRFKEhEQ1BfUkVQX0NUTCwgcmVwX2N0bCB8
IEhEQ1BfU0hBMV9URVhUXzApOwo+IC0JCXJldCA9IGludGVsX3dyaXRlX3NoYV90ZXh0KGRldl9w
cml2LCAwKTsKPiArCQlyZXQgPSBpbnRlbF93cml0ZV9zaGFfdGV4dChpOTE1LCAwKTsKPiAgIAkJ
aWYgKHJldCA8IDApCj4gICAJCQlyZXR1cm4gcmV0Owo+ICAgCQlzaGFfaWR4ICs9IHNpemVvZihz
aGFfdGV4dCk7Cj4gICAKPiAgIAkJLyogV3JpdGUgOCBiaXRzIG9mIE0wICovCj4gICAJCUk5MTVf
V1JJVEUoSERDUF9SRVBfQ1RMLCByZXBfY3RsIHwgSERDUF9TSEExX1RFWFRfMjQpOwo+IC0JCXJl
dCA9IGludGVsX3dyaXRlX3NoYV90ZXh0KGRldl9wcml2LCAwKTsKPiArCQlyZXQgPSBpbnRlbF93
cml0ZV9zaGFfdGV4dChpOTE1LCAwKTsKPiAgIAkJaWYgKHJldCA8IDApCj4gICAJCQlyZXR1cm4g
cmV0Owo+ICAgCQlzaGFfaWR4ICs9IHNpemVvZihzaGFfdGV4dCk7Cj4gQEAgLTQ1Nyw3ICs0NTcs
NyBAQCBpbnQgaW50ZWxfaGRjcF92YWxpZGF0ZV92X3ByaW1lKHN0cnVjdCBpbnRlbF9kaWdpdGFs
X3BvcnQgKmludGVsX2RpZ19wb3J0LAo+ICAgCUk5MTVfV1JJVEUoSERDUF9SRVBfQ1RMLCByZXBf
Y3RsIHwgSERDUF9TSEExX1RFWFRfMzIpOwo+ICAgCS8qIEZpbGwgdXAgdG8gNjQtNCBieXRlcyB3
aXRoIHplcm9zIChsZWF2ZSB0aGUgbGFzdCB3cml0ZSBmb3IgbGVuZ3RoKSAqLwo+ICAgCXdoaWxl
ICgoc2hhX2lkeCAlIDY0KSA8ICg2NCAtIHNpemVvZihzaGFfdGV4dCkpKSB7Cj4gLQkJcmV0ID0g
aW50ZWxfd3JpdGVfc2hhX3RleHQoZGV2X3ByaXYsIDApOwo+ICsJCXJldCA9IGludGVsX3dyaXRl
X3NoYV90ZXh0KGk5MTUsIDApOwo+ICAgCQlpZiAocmV0IDwgMCkKPiAgIAkJCXJldHVybiByZXQ7
Cj4gICAJCXNoYV9pZHggKz0gc2l6ZW9mKHNoYV90ZXh0KTsKPiBAQCAtNDY5LDEzICs0NjksMTMg
QEAgaW50IGludGVsX2hkY3BfdmFsaWRhdGVfdl9wcmltZShzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9w
b3J0ICppbnRlbF9kaWdfcG9ydCwKPiAgIAkgKiAgLSAxMCBieXRlcyBmb3IgQklORk8vQlNUQVRV
UygyKSwgTTAoOCkKPiAgIAkgKi8KPiAgIAlzaGFfdGV4dCA9IChudW1fZG93bnN0cmVhbSAqIDUg
KyAxMCkgKiA4Owo+IC0JcmV0ID0gaW50ZWxfd3JpdGVfc2hhX3RleHQoZGV2X3ByaXYsIHNoYV90
ZXh0KTsKPiArCXJldCA9IGludGVsX3dyaXRlX3NoYV90ZXh0KGk5MTUsIHNoYV90ZXh0KTsKPiAg
IAlpZiAocmV0IDwgMCkKPiAgIAkJcmV0dXJuIHJldDsKPiAgIAo+ICAgCS8qIFRlbGwgdGhlIEhX
IHdlJ3JlIGRvbmUgd2l0aCB0aGUgaGFzaCBhbmQgd2FpdCBmb3IgaXQgdG8gQUNLICovCj4gICAJ
STkxNV9XUklURShIRENQX1JFUF9DVEwsIHJlcF9jdGwgfCBIRENQX1NIQTFfQ09NUExFVEVfSEFT
SCk7Cj4gLQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsIEhE
Q1BfUkVQX0NUTCwKPiArCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3Jl
LCBIRENQX1JFUF9DVEwsCj4gICAJCQkJICAgIEhEQ1BfU0hBMV9DT01QTEVURSwKPiAgIAkJCQkg
ICAgSERDUF9TSEExX0NPTVBMRVRFLCAxKSkgewo+ICAgCQlEUk1fRVJST1IoIlRpbWVkIG91dCB3
YWl0aW5nIGZvciBTSEExIGNvbXBsZXRlXG4iKTsKPiBAQCAtNTcxLDcgKzU3MSw3IEBAIHN0YXRp
YyBpbnQgaW50ZWxfaGRjcF9hdXRoKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikK
PiAgIAlzdHJ1Y3QgaW50ZWxfaGRjcCAqaGRjcCA9ICZjb25uZWN0b3ItPmhkY3A7Cj4gICAJc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiA9IGNvbm5lY3Rvci0+YmFzZS5kZXY7Cj4gICAJY29uc3Qgc3Ry
dWN0IGludGVsX2hkY3Bfc2hpbSAqc2hpbSA9IGhkY3AtPnNoaW07Cj4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXY7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNTsK
PiAgIAllbnVtIHBvcnQgcG9ydDsKPiAgIAl1bnNpZ25lZCBsb25nIHIwX3ByaW1lX2dlbl9zdGFy
dDsKPiAgIAlpbnQgcmV0LCBpLCB0cmllcyA9IDI7Cj4gQEAgLTU4OSw3ICs1ODksNyBAQCBzdGF0
aWMgaW50IGludGVsX2hkY3BfYXV0aChzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3Ip
Cj4gICAJfSByaTsKPiAgIAlib29sIHJlcGVhdGVyX3ByZXNlbnQsIGhkY3BfY2FwYWJsZTsKPiAg
IAo+IC0JZGV2X3ByaXYgPSBpbnRlbF9kaWdfcG9ydC0+YmFzZS5iYXNlLmRldi0+ZGV2X3ByaXZh
dGU7Cj4gKwlpOTE1ID0gaW50ZWxfZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYtPmRldl9wcml2YXRl
Owo+ICAgCj4gICAJcG9ydCA9IGludGVsX2RpZ19wb3J0LT5iYXNlLnBvcnQ7Cj4gICAKPiBAQCAt
NjE1LDcgKzYxNSw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfaGRjcF9hdXRoKHN0cnVjdCBpbnRlbF9j
b25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIAlJOTE1X1dSSVRFKFBPUlRfSERDUF9DT05GKHBvcnQp
LCBIRENQX0NPTkZfQ0FQVFVSRV9BTik7Cj4gICAKPiAgIAkvKiBXYWl0IGZvciBBbiB0byBiZSBh
Y3F1aXJlZCAqLwo+IC0JaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5j
b3JlLCBQT1JUX0hEQ1BfU1RBVFVTKHBvcnQpLAo+ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lz
dGVyKCZpOTE1LT51bmNvcmUsIFBPUlRfSERDUF9TVEFUVVMocG9ydCksCj4gICAJCQkJICAgIEhE
Q1BfU1RBVFVTX0FOX1JFQURZLAo+ICAgCQkJCSAgICBIRENQX1NUQVRVU19BTl9SRUFEWSwgMSkp
IHsKPiAgIAkJRFJNX0VSUk9SKCJUaW1lZCBvdXQgd2FpdGluZyBmb3IgQW5cbiIpOwo+IEBAIC03
MDEsNyArNzAxLDcgQEAgc3RhdGljIGludCBpbnRlbF9oZGNwX2F1dGgoc3RydWN0IGludGVsX2Nv
bm5lY3RvciAqY29ubmVjdG9yKQo+ICAgCX0KPiAgIAo+ICAgCS8qIFdhaXQgZm9yIGVuY3J5cHRp
b24gY29uZmlybWF0aW9uICovCj4gLQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9w
cml2LT51bmNvcmUsIFBPUlRfSERDUF9TVEFUVVMocG9ydCksCj4gKwlpZiAoaW50ZWxfd2FpdF9m
b3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwgUE9SVF9IRENQX1NUQVRVUyhwb3J0KSwKPiAgIAkJ
CQkgICAgSERDUF9TVEFUVVNfRU5DLCBIRENQX1NUQVRVU19FTkMsCj4gICAJCQkJICAgIEVOQ1JZ
UFRfU1RBVFVTX0NIQU5HRV9USU1FT1VUX01TKSkgewo+ICAgCQlEUk1fRVJST1IoIlRpbWVkIG91
dCB3YWl0aW5nIGZvciBlbmNyeXB0aW9uXG4iKTsKPiBAQCAtNzIzLDcgKzcyMyw3IEBAIHN0YXRp
YyBpbnQgaW50ZWxfaGRjcF9hdXRoKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikK
PiAgIHN0YXRpYyBpbnQgX2ludGVsX2hkY3BfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9y
ICpjb25uZWN0b3IpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2hkY3AgKmhkY3AgPSAmY29ubmVj
dG9yLT5oZGNwOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gY29ubmVj
dG9yLT5iYXNlLmRldi0+ZGV2X3ByaXZhdGU7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IGNvbm5lY3Rvci0+YmFzZS5kZXYtPmRldl9wcml2YXRlOwo+ICAgCXN0cnVjdCBpbnRl
bF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0ID0gY29ubl90b19kaWdfcG9ydChjb25uZWN0
b3IpOwo+ICAgCWVudW0gcG9ydCBwb3J0ID0gaW50ZWxfZGlnX3BvcnQtPmJhc2UucG9ydDsKPiAg
IAlpbnQgcmV0Owo+IEBAIC03MzMsNyArNzMzLDcgQEAgc3RhdGljIGludCBfaW50ZWxfaGRjcF9k
aXNhYmxlKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIAo+ICAgCWhkY3At
PmhkY3BfZW5jcnlwdGVkID0gZmFsc2U7Cj4gICAJSTkxNV9XUklURShQT1JUX0hEQ1BfQ09ORihw
b3J0KSwgMCk7Cj4gLQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNv
cmUsCj4gKwlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiAgIAkJ
CQkgICAgUE9SVF9IRENQX1NUQVRVUyhwb3J0KSwgfjAsIDAsCj4gICAJCQkJICAgIEVOQ1JZUFRf
U1RBVFVTX0NIQU5HRV9USU1FT1VUX01TKSkgewo+ICAgCQlEUk1fRVJST1IoIkZhaWxlZCB0byBk
aXNhYmxlIEhEQ1AsIHRpbWVvdXQgY2xlYXJpbmcgc3RhdHVzXG4iKTsKPiBAQCAtNzUzLDIyICs3
NTMsMjIgQEAgc3RhdGljIGludCBfaW50ZWxfaGRjcF9kaXNhYmxlKHN0cnVjdCBpbnRlbF9jb25u
ZWN0b3IgKmNvbm5lY3RvcikKPiAgIHN0YXRpYyBpbnQgX2ludGVsX2hkY3BfZW5hYmxlKHN0cnVj
dCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfaGRj
cCAqaGRjcCA9ICZjb25uZWN0b3ItPmhkY3A7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBjb25uZWN0b3ItPmJhc2UuZGV2LT5kZXZfcHJpdmF0ZTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gY29ubmVjdG9yLT5iYXNlLmRldi0+ZGV2X3ByaXZhdGU7
Cj4gICAJaW50IGksIHJldCwgdHJpZXMgPSAzOwo+ICAgCj4gICAJRFJNX0RFQlVHX0tNUygiWyVz
OiVkXSBIRENQIGlzIGJlaW5nIGVuYWJsZWQuLi5cbiIsCj4gICAJCSAgICAgIGNvbm5lY3Rvci0+
YmFzZS5uYW1lLCBjb25uZWN0b3ItPmJhc2UuYmFzZS5pZCk7Cj4gICAKPiAtCWlmICghaGRjcF9r
ZXlfbG9hZGFibGUoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoIWhkY3Bfa2V5X2xvYWRhYmxlKGk5MTUp
KSB7Cj4gICAJCURSTV9FUlJPUigiSERDUCBrZXkgTG9hZCBpcyBub3QgcG9zc2libGVcbiIpOwo+
ICAgCQlyZXR1cm4gLUVOWElPOwo+ICAgCX0KPiAgIAo+ICAgCWZvciAoaSA9IDA7IGkgPCBLRVlf
TE9BRF9UUklFUzsgaSsrKSB7Cj4gLQkJcmV0ID0gaW50ZWxfaGRjcF9sb2FkX2tleXMoZGV2X3By
aXYpOwo+ICsJCXJldCA9IGludGVsX2hkY3BfbG9hZF9rZXlzKGk5MTUpOwo+ICAgCQlpZiAoIXJl
dCkKPiAgIAkJCWJyZWFrOwo+IC0JCWludGVsX2hkY3BfY2xlYXJfa2V5cyhkZXZfcHJpdik7Cj4g
KwkJaW50ZWxfaGRjcF9jbGVhcl9rZXlzKGk5MTUpOwo+ICAgCX0KPiAgIAlpZiAocmV0KSB7Cj4g
ICAJCURSTV9FUlJPUigiQ291bGQgbm90IGxvYWQgSERDUCBrZXlzLCAoJWQpXG4iLCByZXQpOwo+
IEBAIC04MDMsNyArODAzLDcgQEAgc3RydWN0IGludGVsX2Nvbm5lY3RvciAqaW50ZWxfaGRjcF90
b19jb25uZWN0b3Ioc3RydWN0IGludGVsX2hkY3AgKmhkY3ApCj4gICBzdGF0aWMgaW50IGludGVs
X2hkY3BfY2hlY2tfbGluayhzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gICB7
Cj4gICAJc3RydWN0IGludGVsX2hkY3AgKmhkY3AgPSAmY29ubmVjdG9yLT5oZGNwOwo+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gY29ubmVjdG9yLT5iYXNlLmRldi0+ZGV2
X3ByaXZhdGU7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGNvbm5lY3Rvci0+
YmFzZS5kZXYtPmRldl9wcml2YXRlOwo+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmlu
dGVsX2RpZ19wb3J0ID0gY29ubl90b19kaWdfcG9ydChjb25uZWN0b3IpOwo+ICAgCWVudW0gcG9y
dCBwb3J0ID0gaW50ZWxfZGlnX3BvcnQtPmJhc2UucG9ydDsKPiAgIAlpbnQgcmV0ID0gMDsKPiBA
QCAtODg0LDEwICs4ODQsMTAgQEAgc3RhdGljIHZvaWQgaW50ZWxfaGRjcF9wcm9wX3dvcmsoc3Ry
dWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAgCWRybV9tb2Rlc2V0X3VubG9jaygmZGV2LT5tb2Rl
X2NvbmZpZy5jb25uZWN0aW9uX211dGV4KTsKPiAgIH0KPiAgIAo+IC1ib29sIGlzX2hkY3Bfc3Vw
cG9ydGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBvcnQp
Cj4gK2Jvb2wgaXNfaGRjcF9zdXBwb3J0ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
IGVudW0gcG9ydCBwb3J0KQo+ICAgewo+ICAgCS8qIFBPUlQgRSBkb2Vzbid0IGhhdmUgSERDUCwg
YW5kIFBPUlQgRiBpcyBkaXNhYmxlZCAqLwo+IC0JcmV0dXJuIElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gOSAmJiBwb3J0IDwgUE9SVF9FOwo+ICsJcmV0dXJuIElOVEVMX0dFTihpOTE1KSA+PSA5ICYm
IHBvcnQgPCBQT1JUX0U7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQKPiBAQCAtODk1LDIyICs4
OTUsMjIgQEAgaGRjcDJfcHJlcGFyZV9ha2VfaW5pdChzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpj
b25uZWN0b3IsCj4gICAJCSAgICAgICBzdHJ1Y3QgaGRjcDJfYWtlX2luaXQgKmFrZV9kYXRhKQo+
ICAgewo+ICAgCXN0cnVjdCBoZGNwX3BvcnRfZGF0YSAqZGF0YSA9ICZjb25uZWN0b3ItPmhkY3Au
cG9ydF9kYXRhOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaTkxNV9oZGNwX2Nv
bXBfbWFzdGVyICpjb21wOwo+ICAgCWludCByZXQ7Cj4gICAKPiAtCW11dGV4X2xvY2soJmRldl9w
cml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+IC0JY29tcCA9IGRldl9wcml2LT5oZGNwX21hc3RlcjsK
PiArCW11dGV4X2xvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gKwljb21wID0gaTkxNS0+
aGRjcF9tYXN0ZXI7Cj4gICAKPiAgIAlpZiAoIWNvbXAgfHwgIWNvbXAtPm9wcykgewo+IC0JCW11
dGV4X3VubG9jaygmZGV2X3ByaXYtPmhkY3BfY29tcF9tdXRleCk7Cj4gKwkJbXV0ZXhfdW5sb2Nr
KCZpOTE1LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiAgIAl9Cj4g
ICAKPiAgIAlyZXQgPSBjb21wLT5vcHMtPmluaXRpYXRlX2hkY3AyX3Nlc3Npb24oY29tcC0+bWVp
X2RldiwgZGF0YSwgYWtlX2RhdGEpOwo+ICAgCWlmIChyZXQpCj4gICAJCURSTV9ERUJVR19LTVMo
IlByZXBhcmVfYWtlX2luaXQgZmFpbGVkLiAlZFxuIiwgcmV0KTsKPiAtCW11dGV4X3VubG9jaygm
ZGV2X3ByaXYtPmhkY3BfY29tcF9tdXRleCk7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPmhkY3Bf
Y29tcF9tdXRleCk7Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+IEBAIC05MjMsMTUgKzky
MywxNSBAQCBoZGNwMl92ZXJpZnlfcnhfY2VydF9wcmVwYXJlX2ttKHN0cnVjdCBpbnRlbF9jb25u
ZWN0b3IgKmNvbm5lY3RvciwKPiAgIAkJCQlzaXplX3QgKm1zZ19zeikKPiAgIHsKPiAgIAlzdHJ1
Y3QgaGRjcF9wb3J0X2RhdGEgKmRhdGEgPSAmY29ubmVjdG9yLT5oZGNwLnBvcnRfZGF0YTsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5i
YXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29u
bmVjdG9yLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGk5MTVfaGRjcF9jb21wX21hc3RlciAqY29t
cDsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+aGRjcF9jb21w
X211dGV4KTsKPiAtCWNvbXAgPSBkZXZfcHJpdi0+aGRjcF9tYXN0ZXI7Cj4gKwltdXRleF9sb2Nr
KCZpOTE1LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ICsJY29tcCA9IGk5MTUtPmhkY3BfbWFzdGVyOwo+
ICAgCj4gICAJaWYgKCFjb21wIHx8ICFjb21wLT5vcHMpIHsKPiAtCQltdXRleF91bmxvY2soJmRl
dl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ICsJCW11dGV4X3VubG9jaygmaTkxNS0+aGRjcF9j
b21wX211dGV4KTsKPiAgIAkJcmV0dXJuIC1FSU5WQUw7Cj4gICAJfQo+ICAgCj4gQEAgLTk0MCw3
ICs5NDAsNyBAQCBoZGNwMl92ZXJpZnlfcnhfY2VydF9wcmVwYXJlX2ttKHN0cnVjdCBpbnRlbF9j
b25uZWN0b3IgKmNvbm5lY3RvciwKPiAgIAkJCQkJCQkgZWtfcHViX2ttLCBtc2dfc3opOwo+ICAg
CWlmIChyZXQgPCAwKQo+ICAgCQlEUk1fREVCVUdfS01TKCJWZXJpZnkgcnhfY2VydCBmYWlsZWQu
ICVkXG4iLCByZXQpOwo+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+aGRjcF9jb21wX211dGV4
KTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+aGRjcF9jb21wX211dGV4KTsKPiAgIAo+ICAgCXJl
dHVybiByZXQ7Cj4gICB9Cj4gQEAgLTk0OSwyMiArOTQ5LDIyIEBAIHN0YXRpYyBpbnQgaGRjcDJf
dmVyaWZ5X2hwcmltZShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IsCj4gICAJCQkg
ICAgICAgc3RydWN0IGhkY3AyX2FrZV9zZW5kX2hwcmltZSAqcnhfaHByaW1lKQo+ICAgewo+ICAg
CXN0cnVjdCBoZGNwX3BvcnRfZGF0YSAqZGF0YSA9ICZjb25uZWN0b3ItPmhkY3AucG9ydF9kYXRh
Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0
b3ItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaTkxNV9oZGNwX2NvbXBfbWFzdGVy
ICpjb21wOwo+ICAgCWludCByZXQ7Cj4gICAKPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5oZGNw
X2NvbXBfbXV0ZXgpOwo+IC0JY29tcCA9IGRldl9wcml2LT5oZGNwX21hc3RlcjsKPiArCW11dGV4
X2xvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gKwljb21wID0gaTkxNS0+aGRjcF9tYXN0
ZXI7Cj4gICAKPiAgIAlpZiAoIWNvbXAgfHwgIWNvbXAtPm9wcykgewo+IC0JCW11dGV4X3VubG9j
aygmZGV2X3ByaXYtPmhkY3BfY29tcF9tdXRleCk7Cj4gKwkJbXV0ZXhfdW5sb2NrKCZpOTE1LT5o
ZGNwX2NvbXBfbXV0ZXgpOwo+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiAgIAl9Cj4gICAKPiAgIAly
ZXQgPSBjb21wLT5vcHMtPnZlcmlmeV9ocHJpbWUoY29tcC0+bWVpX2RldiwgZGF0YSwgcnhfaHBy
aW1lKTsKPiAgIAlpZiAocmV0IDwgMCkKPiAgIAkJRFJNX0RFQlVHX0tNUygiVmVyaWZ5IGhwcmlt
ZSBmYWlsZWQuICVkXG4iLCByZXQpOwo+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+aGRjcF9j
b21wX211dGV4KTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+aGRjcF9jb21wX211dGV4KTsKPiAg
IAo+ICAgCXJldHVybiByZXQ7Cj4gICB9Cj4gQEAgLTk3NCwyMiArOTc0LDIyIEBAIGhkY3AyX3N0
b3JlX3BhaXJpbmdfaW5mbyhzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IsCj4gICAJ
CQkgc3RydWN0IGhkY3AyX2FrZV9zZW5kX3BhaXJpbmdfaW5mbyAqcGFpcmluZ19pbmZvKQo+ICAg
ewo+ICAgCXN0cnVjdCBoZGNwX3BvcnRfZGF0YSAqZGF0YSA9ICZjb25uZWN0b3ItPmhkY3AucG9y
dF9kYXRhOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShj
b25uZWN0b3ItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaTkxNV9oZGNwX2NvbXBf
bWFzdGVyICpjb21wOwo+ICAgCWludCByZXQ7Cj4gICAKPiAtCW11dGV4X2xvY2soJmRldl9wcml2
LT5oZGNwX2NvbXBfbXV0ZXgpOwo+IC0JY29tcCA9IGRldl9wcml2LT5oZGNwX21hc3RlcjsKPiAr
CW11dGV4X2xvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gKwljb21wID0gaTkxNS0+aGRj
cF9tYXN0ZXI7Cj4gICAKPiAgIAlpZiAoIWNvbXAgfHwgIWNvbXAtPm9wcykgewo+IC0JCW11dGV4
X3VubG9jaygmZGV2X3ByaXYtPmhkY3BfY29tcF9tdXRleCk7Cj4gKwkJbXV0ZXhfdW5sb2NrKCZp
OTE1LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiAgIAl9Cj4gICAK
PiAgIAlyZXQgPSBjb21wLT5vcHMtPnN0b3JlX3BhaXJpbmdfaW5mbyhjb21wLT5tZWlfZGV2LCBk
YXRhLCBwYWlyaW5nX2luZm8pOwo+ICAgCWlmIChyZXQgPCAwKQo+ICAgCQlEUk1fREVCVUdfS01T
KCJTdG9yZSBwYWlyaW5nIGluZm8gZmFpbGVkLiAlZFxuIiwgcmV0KTsKPiAtCW11dGV4X3VubG9j
aygmZGV2X3ByaXYtPmhkY3BfY29tcF9tdXRleCk7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPmhk
Y3BfY29tcF9tdXRleCk7Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+IEBAIC05OTksMjIg
Kzk5OSwyMiBAQCBoZGNwMl9wcmVwYXJlX2xjX2luaXQoc3RydWN0IGludGVsX2Nvbm5lY3RvciAq
Y29ubmVjdG9yLAo+ICAgCQkgICAgICBzdHJ1Y3QgaGRjcDJfbGNfaW5pdCAqbGNfaW5pdCkKPiAg
IHsKPiAgIAlzdHJ1Y3QgaGRjcF9wb3J0X2RhdGEgKmRhdGEgPSAmY29ubmVjdG9yLT5oZGNwLnBv
cnRfZGF0YTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
Y29ubmVjdG9yLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGk5MTVfaGRjcF9jb21w
X21hc3RlciAqY29tcDsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZfcHJp
di0+aGRjcF9jb21wX211dGV4KTsKPiAtCWNvbXAgPSBkZXZfcHJpdi0+aGRjcF9tYXN0ZXI7Cj4g
KwltdXRleF9sb2NrKCZpOTE1LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ICsJY29tcCA9IGk5MTUtPmhk
Y3BfbWFzdGVyOwo+ICAgCj4gICAJaWYgKCFjb21wIHx8ICFjb21wLT5vcHMpIHsKPiAtCQltdXRl
eF91bmxvY2soJmRldl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ICsJCW11dGV4X3VubG9jaygm
aTkxNS0+aGRjcF9jb21wX211dGV4KTsKPiAgIAkJcmV0dXJuIC1FSU5WQUw7Cj4gICAJfQo+ICAg
Cj4gICAJcmV0ID0gY29tcC0+b3BzLT5pbml0aWF0ZV9sb2NhbGl0eV9jaGVjayhjb21wLT5tZWlf
ZGV2LCBkYXRhLCBsY19pbml0KTsKPiAgIAlpZiAocmV0IDwgMCkKPiAgIAkJRFJNX0RFQlVHX0tN
UygiUHJlcGFyZSBsY19pbml0IGZhaWxlZC4gJWRcbiIsIHJldCk7Cj4gLQltdXRleF91bmxvY2so
JmRldl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5oZGNw
X2NvbXBfbXV0ZXgpOwo+ICAgCj4gICAJcmV0dXJuIHJldDsKPiAgIH0KPiBAQCAtMTAyNCwyMiAr
MTAyNCwyMiBAQCBoZGNwMl92ZXJpZnlfbHByaW1lKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNv
bm5lY3RvciwKPiAgIAkJICAgIHN0cnVjdCBoZGNwMl9sY19zZW5kX2xwcmltZSAqcnhfbHByaW1l
KQo+ICAgewo+ICAgCXN0cnVjdCBoZGNwX3BvcnRfZGF0YSAqZGF0YSA9ICZjb25uZWN0b3ItPmhk
Y3AucG9ydF9kYXRhOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaTkxNV9oZGNw
X2NvbXBfbWFzdGVyICpjb21wOwo+ICAgCWludCByZXQ7Cj4gICAKPiAtCW11dGV4X2xvY2soJmRl
dl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+IC0JY29tcCA9IGRldl9wcml2LT5oZGNwX21hc3Rl
cjsKPiArCW11dGV4X2xvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gKwljb21wID0gaTkx
NS0+aGRjcF9tYXN0ZXI7Cj4gICAKPiAgIAlpZiAoIWNvbXAgfHwgIWNvbXAtPm9wcykgewo+IC0J
CW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmhkY3BfY29tcF9tdXRleCk7Cj4gKwkJbXV0ZXhfdW5s
b2NrKCZpOTE1LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiAgIAl9
Cj4gICAKPiAgIAlyZXQgPSBjb21wLT5vcHMtPnZlcmlmeV9scHJpbWUoY29tcC0+bWVpX2Rldiwg
ZGF0YSwgcnhfbHByaW1lKTsKPiAgIAlpZiAocmV0IDwgMCkKPiAgIAkJRFJNX0RFQlVHX0tNUygi
VmVyaWZ5IExfUHJpbWUgZmFpbGVkLiAlZFxuIiwgcmV0KTsKPiAtCW11dGV4X3VubG9jaygmZGV2
X3ByaXYtPmhkY3BfY29tcF9tdXRleCk7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPmhkY3BfY29t
cF9tdXRleCk7Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+IEBAIC0xMDQ4LDIyICsxMDQ4
LDIyIEBAIHN0YXRpYyBpbnQgaGRjcDJfcHJlcGFyZV9za2V5KHN0cnVjdCBpbnRlbF9jb25uZWN0
b3IgKmNvbm5lY3RvciwKPiAgIAkJCSAgICAgIHN0cnVjdCBoZGNwMl9za2Vfc2VuZF9la3MgKnNr
ZV9kYXRhKQo+ICAgewo+ICAgCXN0cnVjdCBoZGNwX3BvcnRfZGF0YSAqZGF0YSA9ICZjb25uZWN0
b3ItPmhkY3AucG9ydF9kYXRhOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaTkx
NV9oZGNwX2NvbXBfbWFzdGVyICpjb21wOwo+ICAgCWludCByZXQ7Cj4gICAKPiAtCW11dGV4X2xv
Y2soJmRldl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+IC0JY29tcCA9IGRldl9wcml2LT5oZGNw
X21hc3RlcjsKPiArCW11dGV4X2xvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gKwljb21w
ID0gaTkxNS0+aGRjcF9tYXN0ZXI7Cj4gICAKPiAgIAlpZiAoIWNvbXAgfHwgIWNvbXAtPm9wcykg
ewo+IC0JCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmhkY3BfY29tcF9tdXRleCk7Cj4gKwkJbXV0
ZXhfdW5sb2NrKCZpOTE1LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ICAgCQlyZXR1cm4gLUVJTlZBTDsK
PiAgIAl9Cj4gICAKPiAgIAlyZXQgPSBjb21wLT5vcHMtPmdldF9zZXNzaW9uX2tleShjb21wLT5t
ZWlfZGV2LCBkYXRhLCBza2VfZGF0YSk7Cj4gICAJaWYgKHJldCA8IDApCj4gICAJCURSTV9ERUJV
R19LTVMoIkdldCBzZXNzaW9uIGtleSBmYWlsZWQuICVkXG4iLCByZXQpOwo+IC0JbXV0ZXhfdW5s
b2NrKCZkZXZfcHJpdi0+aGRjcF9jb21wX211dGV4KTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+
aGRjcF9jb21wX211dGV4KTsKPiAgIAo+ICAgCXJldHVybiByZXQ7Cj4gICB9Cj4gQEAgLTEwNzUs
MTUgKzEwNzUsMTUgQEAgaGRjcDJfdmVyaWZ5X3JlcF90b3BvbG9neV9wcmVwYXJlX2FjayhzdHJ1
Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IsCj4gICAJCQkJICAgICAgc3RydWN0IGhkY3Ay
X3JlcF9zZW5kX2FjayAqcmVwX3NlbmRfYWNrKQo+ICAgewo+ICAgCXN0cnVjdCBoZGNwX3BvcnRf
ZGF0YSAqZGF0YSA9ICZjb25uZWN0b3ItPmhkY3AucG9ydF9kYXRhOwo+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2Uu
ZGV2KTsKPiAgIAlzdHJ1Y3QgaTkxNV9oZGNwX2NvbXBfbWFzdGVyICpjb21wOwo+ICAgCWludCBy
ZXQ7Cj4gICAKPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+IC0J
Y29tcCA9IGRldl9wcml2LT5oZGNwX21hc3RlcjsKPiArCW11dGV4X2xvY2soJmk5MTUtPmhkY3Bf
Y29tcF9tdXRleCk7Cj4gKwljb21wID0gaTkxNS0+aGRjcF9tYXN0ZXI7Cj4gICAKPiAgIAlpZiAo
IWNvbXAgfHwgIWNvbXAtPm9wcykgewo+IC0JCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmhkY3Bf
Y29tcF9tdXRleCk7Cj4gKwkJbXV0ZXhfdW5sb2NrKCZpOTE1LT5oZGNwX2NvbXBfbXV0ZXgpOwo+
ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiAgIAl9Cj4gICAKPiBAQCAtMTA5Miw3ICsxMDkyLDcgQEAg
aGRjcDJfdmVyaWZ5X3JlcF90b3BvbG9neV9wcmVwYXJlX2FjayhzdHJ1Y3QgaW50ZWxfY29ubmVj
dG9yICpjb25uZWN0b3IsCj4gICAJCQkJCQkJIHJlcF9zZW5kX2Fjayk7Cj4gICAJaWYgKHJldCA8
IDApCj4gICAJCURSTV9ERUJVR19LTVMoIlZlcmlmeSByZXAgdG9wb2xvZ3kgZmFpbGVkLiAlZFxu
IiwgcmV0KTsKPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmhkY3BfY29tcF9tdXRleCk7Cj4g
KwltdXRleF91bmxvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gICAKPiAgIAlyZXR1cm4g
cmV0Owo+ICAgfQo+IEBAIC0xMTAyLDIyICsxMTAyLDIyIEBAIGhkY3AyX3ZlcmlmeV9tcHJpbWUo
c3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+ICAgCQkgICAgc3RydWN0IGhkY3Ay
X3JlcF9zdHJlYW1fcmVhZHkgKnN0cmVhbV9yZWFkeSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaGRjcF9w
b3J0X2RhdGEgKmRhdGEgPSAmY29ubmVjdG9yLT5oZGNwLnBvcnRfZGF0YTsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5i
YXNlLmRldik7Cj4gICAJc3RydWN0IGk5MTVfaGRjcF9jb21wX21hc3RlciAqY29tcDsKPiAgIAlp
bnQgcmV0Owo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+aGRjcF9jb21wX211dGV4KTsK
PiAtCWNvbXAgPSBkZXZfcHJpdi0+aGRjcF9tYXN0ZXI7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT5o
ZGNwX2NvbXBfbXV0ZXgpOwo+ICsJY29tcCA9IGk5MTUtPmhkY3BfbWFzdGVyOwo+ICAgCj4gICAJ
aWYgKCFjb21wIHx8ICFjb21wLT5vcHMpIHsKPiAtCQltdXRleF91bmxvY2soJmRldl9wcml2LT5o
ZGNwX2NvbXBfbXV0ZXgpOwo+ICsJCW11dGV4X3VubG9jaygmaTkxNS0+aGRjcF9jb21wX211dGV4
KTsKPiAgIAkJcmV0dXJuIC1FSU5WQUw7Cj4gICAJfQo+ICAgCj4gICAJcmV0ID0gY29tcC0+b3Bz
LT52ZXJpZnlfbXByaW1lKGNvbXAtPm1laV9kZXYsIGRhdGEsIHN0cmVhbV9yZWFkeSk7Cj4gICAJ
aWYgKHJldCA8IDApCj4gICAJCURSTV9ERUJVR19LTVMoIlZlcmlmeSBtcHJpbWUgZmFpbGVkLiAl
ZFxuIiwgcmV0KTsKPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmhkY3BfY29tcF9tdXRleCk7
Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gICAKPiAgIAlyZXR1
cm4gcmV0Owo+ICAgfQo+IEBAIC0xMTI1LDQzICsxMTI1LDQzIEBAIGhkY3AyX3ZlcmlmeV9tcHJp
bWUoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+ICAgc3RhdGljIGludCBoZGNw
Ml9hdXRoZW50aWNhdGVfcG9ydChzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4g
ICB7Cj4gICAJc3RydWN0IGhkY3BfcG9ydF9kYXRhICpkYXRhID0gJmNvbm5lY3Rvci0+aGRjcC5w
b3J0X2RhdGE7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpOTE1X2hkY3BfY29t
cF9tYXN0ZXIgKmNvbXA7Cj4gICAJaW50IHJldDsKPiAgIAo+IC0JbXV0ZXhfbG9jaygmZGV2X3By
aXYtPmhkY3BfY29tcF9tdXRleCk7Cj4gLQljb21wID0gZGV2X3ByaXYtPmhkY3BfbWFzdGVyOwo+
ICsJbXV0ZXhfbG9jaygmaTkxNS0+aGRjcF9jb21wX211dGV4KTsKPiArCWNvbXAgPSBpOTE1LT5o
ZGNwX21hc3RlcjsKPiAgIAo+ICAgCWlmICghY29tcCB8fCAhY29tcC0+b3BzKSB7Cj4gLQkJbXV0
ZXhfdW5sb2NrKCZkZXZfcHJpdi0+aGRjcF9jb21wX211dGV4KTsKPiArCQltdXRleF91bmxvY2so
Jmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gICAJCXJldHVybiAtRUlOVkFMOwo+ICAgCX0KPiAg
IAo+ICAgCXJldCA9IGNvbXAtPm9wcy0+ZW5hYmxlX2hkY3BfYXV0aGVudGljYXRpb24oY29tcC0+
bWVpX2RldiwgZGF0YSk7Cj4gICAJaWYgKHJldCA8IDApCj4gICAJCURSTV9ERUJVR19LTVMoIkVu
YWJsZSBoZGNwIGF1dGggZmFpbGVkLiAlZFxuIiwgcmV0KTsKPiAtCW11dGV4X3VubG9jaygmZGV2
X3ByaXYtPmhkY3BfY29tcF9tdXRleCk7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPmhkY3BfY29t
cF9tdXRleCk7Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+ICAgCj4gICBzdGF0aWMgaW50
IGhkY3AyX2Nsb3NlX21laV9zZXNzaW9uKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3Rv
cikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
Y29ubmVjdG9yLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGk5MTVfaGRjcF9jb21w
X21hc3RlciAqY29tcDsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZfcHJp
di0+aGRjcF9jb21wX211dGV4KTsKPiAtCWNvbXAgPSBkZXZfcHJpdi0+aGRjcF9tYXN0ZXI7Cj4g
KwltdXRleF9sb2NrKCZpOTE1LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ICsJY29tcCA9IGk5MTUtPmhk
Y3BfbWFzdGVyOwo+ICAgCj4gICAJaWYgKCFjb21wIHx8ICFjb21wLT5vcHMpIHsKPiAtCQltdXRl
eF91bmxvY2soJmRldl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ICsJCW11dGV4X3VubG9jaygm
aTkxNS0+aGRjcF9jb21wX211dGV4KTsKPiAgIAkJcmV0dXJuIC1FSU5WQUw7Cj4gICAJfQo+ICAg
Cj4gICAJcmV0ID0gY29tcC0+b3BzLT5jbG9zZV9oZGNwX3Nlc3Npb24oY29tcC0+bWVpX2RldiwK
PiAgIAkJCQkJICAgICAmY29ubmVjdG9yLT5oZGNwLnBvcnRfZGF0YSk7Cj4gLQltdXRleF91bmxv
Y2soJmRldl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5o
ZGNwX2NvbXBfbXV0ZXgpOwo+ICAgCj4gICAJcmV0dXJuIHJldDsKPiAgIH0KPiBAQCAtMTQ4OCw3
ICsxNDg4LDcgQEAgc3RhdGljIGludCBoZGNwMl9hdXRoZW50aWNhdGVfc2luayhzdHJ1Y3QgaW50
ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gICBzdGF0aWMgaW50IGhkY3AyX2VuYWJsZV9lbmNy
eXB0aW9uKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIHsKPiAgIAlzdHJ1
Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCA9IGNvbm5fdG9fZGlnX3BvcnQo
Y29ubmVjdG9yKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2hkY3Ag
KmhkY3AgPSAmY29ubmVjdG9yLT5oZGNwOwo+ICAgCWVudW0gcG9ydCBwb3J0ID0gY29ubmVjdG9y
LT5lbmNvZGVyLT5wb3J0Owo+ICAgCWludCByZXQ7Cj4gQEAgLTE1MTEsNyArMTUxMSw3IEBAIHN0
YXRpYyBpbnQgaGRjcDJfZW5hYmxlX2VuY3J5cHRpb24oc3RydWN0IGludGVsX2Nvbm5lY3RvciAq
Y29ubmVjdG9yKQo+ICAgCQkJICAgQ1RMX0xJTktfRU5DUllQVElPTl9SRVEpOwo+ICAgCX0KPiAg
IAo+IC0JcmV0ID0gaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsIEhE
Q1AyX1NUQVRVU19EREkocG9ydCksCj4gKwlyZXQgPSBpbnRlbF93YWl0X2Zvcl9yZWdpc3Rlcigm
aTkxNS0+dW5jb3JlLCBIRENQMl9TVEFUVVNfRERJKHBvcnQpLAo+ICAgCQkJCSAgICAgIExJTktf
RU5DUllQVElPTl9TVEFUVVMsCj4gICAJCQkJICAgICAgTElOS19FTkNSWVBUSU9OX1NUQVRVUywK
PiAgIAkJCQkgICAgICBFTkNSWVBUX1NUQVRVU19DSEFOR0VfVElNRU9VVF9NUyk7Cj4gQEAgLTE1
MjIsNyArMTUyMiw3IEBAIHN0YXRpYyBpbnQgaGRjcDJfZW5hYmxlX2VuY3J5cHRpb24oc3RydWN0
IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ICAgc3RhdGljIGludCBoZGNwMl9kaXNhYmxl
X2VuY3J5cHRpb24oc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ICAgewo+ICAg
CXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0ID0gY29ubl90b19kaWdf
cG9ydChjb25uZWN0b3IpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxf
aGRjcCAqaGRjcCA9ICZjb25uZWN0b3ItPmhkY3A7Cj4gICAJZW51bSBwb3J0IHBvcnQgPSBjb25u
ZWN0b3ItPmVuY29kZXItPnBvcnQ7Cj4gICAJaW50IHJldDsKPiBAQCAtMTUzMiw3ICsxNTMyLDcg
QEAgc3RhdGljIGludCBoZGNwMl9kaXNhYmxlX2VuY3J5cHRpb24oc3RydWN0IGludGVsX2Nvbm5l
Y3RvciAqY29ubmVjdG9yKQo+ICAgCUk5MTVfV1JJVEUoSERDUDJfQ1RMX0RESShwb3J0KSwKPiAg
IAkJICAgSTkxNV9SRUFEKEhEQ1AyX0NUTF9EREkocG9ydCkpICYgfkNUTF9MSU5LX0VOQ1JZUFRJ
T05fUkVRKTsKPiAgIAo+IC0JcmV0ID0gaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2
LT51bmNvcmUsIEhEQ1AyX1NUQVRVU19EREkocG9ydCksCj4gKwlyZXQgPSBpbnRlbF93YWl0X2Zv
cl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLCBIRENQMl9TVEFUVVNfRERJKHBvcnQpLAo+ICAgCQkJ
CSAgICAgIExJTktfRU5DUllQVElPTl9TVEFUVVMsIDB4MCwKPiAgIAkJCQkgICAgICBFTkNSWVBU
X1NUQVRVU19DSEFOR0VfVElNRU9VVF9NUyk7Cj4gICAJaWYgKHJldCA9PSAtRVRJTUVET1VUKQo+
IEBAIC0xNjI4LDcgKzE2MjgsNyBAQCBzdGF0aWMgaW50IF9pbnRlbF9oZGNwMl9kaXNhYmxlKHN0
cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIHN0YXRpYyBpbnQgaW50ZWxfaGRj
cDJfY2hlY2tfbGluayhzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gICB7Cj4g
ICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQgPSBjb25uX3RvX2Rp
Z19wb3J0KGNvbm5lY3Rvcik7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRl
bF9oZGNwICpoZGNwID0gJmNvbm5lY3Rvci0+aGRjcDsKPiAgIAllbnVtIHBvcnQgcG9ydCA9IGNv
bm5lY3Rvci0+ZW5jb2Rlci0+cG9ydDsKPiAgIAlpbnQgcmV0ID0gMDsKPiBAQCAtMTcyMSwxMyAr
MTcyMSwxMyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9oZGNwX2NoZWNrX3dvcmsoc3RydWN0IHdvcmtf
c3RydWN0ICp3b3JrKQo+ICAgc3RhdGljIGludCBpOTE1X2hkY3BfY29tcG9uZW50X2JpbmQoc3Ry
dWN0IGRldmljZSAqaTkxNV9rZGV2LAo+ICAgCQkJCSAgICBzdHJ1Y3QgZGV2aWNlICptZWlfa2Rl
diwgdm9pZCAqZGF0YSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IGtkZXZfdG9faTkxNShpOTE1X2tkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBrZGV2X3RvX2k5MTUoaTkxNV9rZGV2KTsKPiAgIAo+ICAgCURSTV9ERUJVRygiSTkx
NSBIRENQIGNvbXAgYmluZFxuIik7Cj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+aGRjcF9jb21w
X211dGV4KTsKPiAtCWRldl9wcml2LT5oZGNwX21hc3RlciA9IChzdHJ1Y3QgaTkxNV9oZGNwX2Nv
bXBfbWFzdGVyICopZGF0YTsKPiAtCWRldl9wcml2LT5oZGNwX21hc3Rlci0+bWVpX2RldiA9IG1l
aV9rZGV2Owo+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+aGRjcF9jb21wX211dGV4KTsKPiAr
CW11dGV4X2xvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gKwlpOTE1LT5oZGNwX21hc3Rl
ciA9IChzdHJ1Y3QgaTkxNV9oZGNwX2NvbXBfbWFzdGVyICopZGF0YTsKPiArCWk5MTUtPmhkY3Bf
bWFzdGVyLT5tZWlfZGV2ID0gbWVpX2tkZXY7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPmhkY3Bf
Y29tcF9tdXRleCk7Cj4gICAKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiBAQCAtMTczNSwxMiArMTcz
NSwxMiBAQCBzdGF0aWMgaW50IGk5MTVfaGRjcF9jb21wb25lbnRfYmluZChzdHJ1Y3QgZGV2aWNl
ICppOTE1X2tkZXYsCj4gICBzdGF0aWMgdm9pZCBpOTE1X2hkY3BfY29tcG9uZW50X3VuYmluZChz
dHJ1Y3QgZGV2aWNlICppOTE1X2tkZXYsCj4gICAJCQkJICAgICAgIHN0cnVjdCBkZXZpY2UgKm1l
aV9rZGV2LCB2b2lkICpkYXRhKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0ga2Rldl90b19pOTE1KGk5MTVfa2Rldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IGtkZXZfdG9faTkxNShpOTE1X2tkZXYpOwo+ICAgCj4gICAJRFJNX0RFQlVH
KCJJOTE1IEhEQ1AgY29tcCB1bmJpbmRcbiIpOwo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmhk
Y3BfY29tcF9tdXRleCk7Cj4gLQlkZXZfcHJpdi0+aGRjcF9tYXN0ZXIgPSBOVUxMOwo+IC0JbXV0
ZXhfdW5sb2NrKCZkZXZfcHJpdi0+aGRjcF9jb21wX211dGV4KTsKPiArCW11dGV4X2xvY2soJmk5
MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gKwlpOTE1LT5oZGNwX21hc3RlciA9IE5VTEw7Cj4gKwlt
dXRleF91bmxvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gICB9Cj4gICAKPiAgIHN0YXRp
YyBjb25zdCBzdHJ1Y3QgY29tcG9uZW50X29wcyBpOTE1X2hkY3BfY29tcG9uZW50X29wcyA9IHsK
PiBAQCAtMTc3MywzNCArMTc3MywzNCBAQCBzdGF0aWMgaW5saW5lIGludCBpbml0aWFsaXplX2hk
Y3BfcG9ydF9kYXRhKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIAlyZXR1
cm4gMDsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgYm9vbCBpc19oZGNwMl9zdXBwb3J0ZWQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgYm9vbCBpc19oZGNwMl9zdXBw
b3J0ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJaWYgKCFJU19F
TkFCTEVEKENPTkZJR19JTlRFTF9NRUlfSERDUCkpCj4gICAJCXJldHVybiBmYWxzZTsKPiAgIAo+
IC0JcmV0dXJuIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwIHx8IElTX0dFTUlOSUxBS0UoZGV2
X3ByaXYpIHx8Cj4gLQkJSVNfS0FCWUxBS0UoZGV2X3ByaXYpKTsKPiArCXJldHVybiAoSU5URUxf
R0VOKGk5MTUpID49IDEwIHx8IElTX0dFTUlOSUxBS0UoaTkxNSkgfHwKPiArCQlJU19LQUJZTEFL
RShpOTE1KSk7Cj4gICB9Cj4gICAKPiAtdm9pZCBpbnRlbF9oZGNwX2NvbXBvbmVudF9pbml0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBpbnRlbF9oZGNwX2NvbXBv
bmVudF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCWludCBy
ZXQ7Cj4gICAKPiAtCWlmICghaXNfaGRjcDJfc3VwcG9ydGVkKGRldl9wcml2KSkKPiArCWlmICgh
aXNfaGRjcDJfc3VwcG9ydGVkKGk5MTUpKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCW11dGV4X2xv
Y2soJmRldl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+IC0JV0FSTl9PTihkZXZfcHJpdi0+aGRj
cF9jb21wX2FkZGVkKTsKPiArCW11dGV4X2xvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4g
KwlXQVJOX09OKGk5MTUtPmhkY3BfY29tcF9hZGRlZCk7Cj4gICAKPiAtCWRldl9wcml2LT5oZGNw
X2NvbXBfYWRkZWQgPSB0cnVlOwo+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+aGRjcF9jb21w
X211dGV4KTsKPiAtCXJldCA9IGNvbXBvbmVudF9hZGRfdHlwZWQoZGV2X3ByaXYtPmRybS5kZXYs
ICZpOTE1X2hkY3BfY29tcG9uZW50X29wcywKPiArCWk5MTUtPmhkY3BfY29tcF9hZGRlZCA9IHRy
dWU7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gKwlyZXQgPSBj
b21wb25lbnRfYWRkX3R5cGVkKGk5MTUtPmRybS5kZXYsICZpOTE1X2hkY3BfY29tcG9uZW50X29w
cywKPiAgIAkJCQkgIEk5MTVfQ09NUE9ORU5UX0hEQ1ApOwo+ICAgCWlmIChyZXQgPCAwKSB7Cj4g
ICAJCURSTV9ERUJVR19LTVMoIkZhaWxlZCBhdCBjb21wb25lbnQgYWRkKCVkKVxuIiwgcmV0KTsK
PiAtCQltdXRleF9sb2NrKCZkZXZfcHJpdi0+aGRjcF9jb21wX211dGV4KTsKPiAtCQlkZXZfcHJp
di0+aGRjcF9jb21wX2FkZGVkID0gZmFsc2U7Cj4gLQkJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+
aGRjcF9jb21wX211dGV4KTsKPiArCQltdXRleF9sb2NrKCZpOTE1LT5oZGNwX2NvbXBfbXV0ZXgp
Owo+ICsJCWk5MTUtPmhkY3BfY29tcF9hZGRlZCA9IGZhbHNlOwo+ICsJCW11dGV4X3VubG9jaygm
aTkxNS0+aGRjcF9jb21wX211dGV4KTsKPiAgIAkJcmV0dXJuOwo+ICAgCX0KPiAgIH0KPiBAQCAt
MTgyMiw3ICsxODIyLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfaGRjcDJfaW5pdChzdHJ1Y3QgaW50
ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gICBpbnQgaW50ZWxfaGRjcF9pbml0KHN0cnVjdCBp
bnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwKPiAgIAkJICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9o
ZGNwX3NoaW0gKnNoaW0pCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBp
bnRlbF9oZGNwICpoZGNwID0gJmNvbm5lY3Rvci0+aGRjcDsKPiAgIAlpbnQgcmV0Owo+ICAgCj4g
QEAgLTE4MzgsNyArMTgzOCw3IEBAIGludCBpbnRlbF9oZGNwX2luaXQoc3RydWN0IGludGVsX2Nv
bm5lY3RvciAqY29ubmVjdG9yLAo+ICAgCUlOSVRfREVMQVlFRF9XT1JLKCZoZGNwLT5jaGVja193
b3JrLCBpbnRlbF9oZGNwX2NoZWNrX3dvcmspOwo+ICAgCUlOSVRfV09SSygmaGRjcC0+cHJvcF93
b3JrLCBpbnRlbF9oZGNwX3Byb3Bfd29yayk7Cj4gICAKPiAtCWlmIChpc19oZGNwMl9zdXBwb3J0
ZWQoZGV2X3ByaXYpKQo+ICsJaWYgKGlzX2hkY3AyX3N1cHBvcnRlZChpOTE1KSkKPiAgIAkJaW50
ZWxfaGRjcDJfaW5pdChjb25uZWN0b3IpOwo+ICAgCWluaXRfd2FpdHF1ZXVlX2hlYWQoJmhkY3At
PmNwX2lycV9xdWV1ZSk7Cj4gICAKPiBAQCAtMTkwNSwxOCArMTkwNSwxOCBAQCBpbnQgaW50ZWxf
aGRjcF9kaXNhYmxlKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIAlyZXR1
cm4gcmV0Owo+ICAgfQo+ICAgCj4gLXZvaWQgaW50ZWxfaGRjcF9jb21wb25lbnRfZmluaShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgaW50ZWxfaGRjcF9jb21wb25l
bnRfZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCW11dGV4X2xv
Y2soJmRldl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+IC0JaWYgKCFkZXZfcHJpdi0+aGRjcF9j
b21wX2FkZGVkKSB7Cj4gLQkJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+aGRjcF9jb21wX211dGV4
KTsKPiArCW11dGV4X2xvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gKwlpZiAoIWk5MTUt
PmhkY3BfY29tcF9hZGRlZCkgewo+ICsJCW11dGV4X3VubG9jaygmaTkxNS0+aGRjcF9jb21wX211
dGV4KTsKPiAgIAkJcmV0dXJuOwo+ICAgCX0KPiAgIAo+IC0JZGV2X3ByaXYtPmhkY3BfY29tcF9h
ZGRlZCA9IGZhbHNlOwo+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+aGRjcF9jb21wX211dGV4
KTsKPiArCWk5MTUtPmhkY3BfY29tcF9hZGRlZCA9IGZhbHNlOwo+ICsJbXV0ZXhfdW5sb2NrKCZp
OTE1LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ICAgCj4gLQljb21wb25lbnRfZGVsKGRldl9wcml2LT5k
cm0uZGV2LCAmaTkxNV9oZGNwX2NvbXBvbmVudF9vcHMpOwo+ICsJY29tcG9uZW50X2RlbChpOTE1
LT5kcm0uZGV2LCAmaTkxNV9oZGNwX2NvbXBvbmVudF9vcHMpOwo+ICAgfQo+ICAgCj4gICB2b2lk
IGludGVsX2hkY3BfY2xlYW51cChzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4g
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2hkY3AuaCBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX2hkY3AuaAo+IGluZGV4IGJlOGRhODVjODY2YS4uMjQwNzlkZGEx
YWM0IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2hkY3AuaAo+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2hkY3AuaAo+IEBAIC0yMywxMSArMjMsMTEg
QEAgaW50IGludGVsX2hkY3BfaW5pdChzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3Is
Cj4gICAJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfaGRjcF9zaGltICpoZGNwX3NoaW0pOwo+ICAg
aW50IGludGVsX2hkY3BfZW5hYmxlKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3Rvcik7
Cj4gICBpbnQgaW50ZWxfaGRjcF9kaXNhYmxlKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5l
Y3Rvcik7Cj4gLWJvb2wgaXNfaGRjcF9zdXBwb3J0ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LCBlbnVtIHBvcnQgcG9ydCk7Cj4gK2Jvb2wgaXNfaGRjcF9zdXBwb3J0ZWQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gcG9ydCBwb3J0KTsKPiAgIGJvb2wgaW50
ZWxfaGRjcF9jYXBhYmxlKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3Rvcik7Cj4gICBi
b29sIGludGVsX2hkY3AyX2NhcGFibGUoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9y
KTsKPiAtdm9pZCBpbnRlbF9oZGNwX2NvbXBvbmVudF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdik7Cj4gLXZvaWQgaW50ZWxfaGRjcF9jb21wb25lbnRfZmluaShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ICt2b2lkIGludGVsX2hkY3BfY29tcG9uZW50
X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lkIGludGVsX2hkY3Bf
Y29tcG9uZW50X2Zpbmkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgdm9pZCBp
bnRlbF9oZGNwX2NsZWFudXAoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKTsKPiAg
IHZvaWQgaW50ZWxfaGRjcF9oYW5kbGVfY3BfaXJxKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNv
bm5lY3Rvcik7Cj4gICAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
aGRtaS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfaGRtaS5jCj4gaW5kZXggMTg3YTJi
ODI4Yjk3Li5jNWJlNDFiYTM2ZGEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfaGRtaS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfaGRtaS5jCj4g
QEAgLTY3LDE3ICs2NywxNyBAQCBzdGF0aWMgdm9pZAo+ICAgYXNzZXJ0X2hkbWlfcG9ydF9kaXNh
YmxlZChzdHJ1Y3QgaW50ZWxfaGRtaSAqaW50ZWxfaGRtaSkKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2ID0gaW50ZWxfaGRtaV90b19kZXYoaW50ZWxfaGRtaSk7Cj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAl1MzIgZW5hYmxlZF9iaXRz
Owo+ICAgCj4gLQllbmFibGVkX2JpdHMgPSBIQVNfRERJKGRldl9wcml2KSA/IERESV9CVUZfQ1RM
X0VOQUJMRSA6IFNEVk9fRU5BQkxFOwo+ICsJZW5hYmxlZF9iaXRzID0gSEFTX0RESShpOTE1KSA/
IERESV9CVUZfQ1RMX0VOQUJMRSA6IFNEVk9fRU5BQkxFOwo+ICAgCj4gICAJV0FSTihJOTE1X1JF
QUQoaW50ZWxfaGRtaS0+aGRtaV9yZWcpICYgZW5hYmxlZF9iaXRzLAo+ICAgCSAgICAgIkhETUkg
cG9ydCBlbmFibGVkLCBleHBlY3RpbmcgZGlzYWJsZWRcbiIpOwo+ICAgfQo+ICAgCj4gICBzdGF0
aWMgdm9pZAo+IC1hc3NlcnRfaGRtaV90cmFuc2NvZGVyX2Z1bmNfZGlzYWJsZWQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICthc3NlcnRfaGRtaV90cmFuc2NvZGVyX2Z1bmNf
ZGlzYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgICBlbnVt
IHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIpCj4gICB7Cj4gICAJV0FSTihJOTE1X1JFQUQoVFJB
TlNfRERJX0ZVTkNfQ1RMKGNwdV90cmFuc2NvZGVyKSkgJgo+IEBAIC0xNjMsNyArMTYzLDcgQEAg
c3RhdGljIHUzMiBoc3dfaW5mb2ZyYW1lX2VuYWJsZSh1bnNpZ25lZCBpbnQgdHlwZSkKPiAgIH0K
PiAgIAo+ICAgc3RhdGljIGk5MTVfcmVnX3QKPiAtaHN3X2RpcF9kYXRhX3JlZyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2hzd19kaXBfZGF0YV9yZWcoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCSBlbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIs
Cj4gICAJCSB1bnNpZ25lZCBpbnQgdHlwZSwKPiAgIAkJIGludCBpKQo+IEBAIC0yMDcsNyArMjA3
LDcgQEAgc3RhdGljIHZvaWQgZzR4X3dyaXRlX2luZm9mcmFtZShzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiAgIAkJCQljb25zdCB2b2lkICpmcmFtZSwgc3NpemVfdCBsZW4pCj4gICB7
Cj4gICAJY29uc3QgdTMyICpkYXRhID0gZnJhbWU7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJdTMy
IHZhbCA9IEk5MTVfUkVBRChWSURFT19ESVBfQ1RMKTsKPiAgIAlpbnQgaTsKPiAgIAo+IEBAIC0y
NDEsNyArMjQxLDcgQEAgc3RhdGljIHZvaWQgZzR4X3JlYWRfaW5mb2ZyYW1lKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJICAgICAgIHVuc2lnbmVkIGludCB0eXBlLAo+ICAg
CQkJICAgICAgIHZvaWQgKmZyYW1lLCBzc2l6ZV90IGxlbikKPiAgIHsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2
KTsKPiAgIAl1MzIgdmFsLCAqZGF0YSA9IGZyYW1lOwo+ICAgCWludCBpOwo+ICAgCj4gQEAgLTI1
OSw3ICsyNTksNyBAQCBzdGF0aWMgdm9pZCBnNHhfcmVhZF9pbmZvZnJhbWUoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsCj4gICBzdGF0aWMgdTMyIGc0eF9pbmZvZnJhbWVzX2VuYWJsZWQo
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkJICBjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJ
dTMyIHZhbCA9IEk5MTVfUkVBRChWSURFT19ESVBfQ1RMKTsKPiAgIAo+ICAgCWlmICgodmFsICYg
VklERU9fRElQX0VOQUJMRSkgPT0gMCkKPiBAQCAtMjc4LDcgKzI3OCw3IEBAIHN0YXRpYyB2b2lk
IGlieF93cml0ZV9pbmZvZnJhbWUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJ
CQkJY29uc3Qgdm9pZCAqZnJhbWUsIHNzaXplX3QgbGVuKQo+ICAgewo+ICAgCWNvbnN0IHUzMiAq
ZGF0YSA9IGZyYW1lOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpp
bnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICAgCWk5
MTVfcmVnX3QgcmVnID0gVFZJREVPX0RJUF9DVEwoaW50ZWxfY3J0Yy0+cGlwZSk7Cj4gICAJdTMy
IHZhbCA9IEk5MTVfUkVBRChyZWcpOwo+IEBAIC0zMTQsNyArMzE0LDcgQEAgc3RhdGljIHZvaWQg
aWJ4X3JlYWRfaW5mb2ZyYW1lKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJ
ICAgICAgIHVuc2lnbmVkIGludCB0eXBlLAo+ICAgCQkJICAgICAgIHZvaWQgKmZyYW1lLCBzc2l6
ZV90IGxlbikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAgIAl1MzIgdmFs
LCAqZGF0YSA9IGZyYW1lOwo+ICAgCWludCBpOwo+IEBAIC0zMzMsNyArMzMzLDcgQEAgc3RhdGlj
IHZvaWQgaWJ4X3JlYWRfaW5mb2ZyYW1lKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+
ICAgc3RhdGljIHUzMiBpYnhfaW5mb2ZyYW1lc19lbmFibGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLAo+ICAgCQkJCSAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVf
Y29uZmlnKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCWVudW0gcGlwZSBwaXBlID0gdG9f
aW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+YmFzZS5jcnRjKS0+cGlwZTsKPiAgIAlpOTE1X3JlZ190
IHJlZyA9IFRWSURFT19ESVBfQ1RMKHBpcGUpOwo+ICAgCXUzMiB2YWwgPSBJOTE1X1JFQUQocmVn
KTsKPiBAQCAtMzU1LDcgKzM1NSw3IEBAIHN0YXRpYyB2b2lkIGNwdF93cml0ZV9pbmZvZnJhbWUo
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkJY29uc3Qgdm9pZCAqZnJhbWUs
IHNzaXplX3QgbGVuKQo+ICAgewo+ICAgCWNvbnN0IHUzMiAqZGF0YSA9IGZyYW1lOwo+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRl
dik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+
YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxf
Y3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICAgCWk5MTVfcmVnX3QgcmVnID0gVFZJREVP
X0RJUF9DVEwoaW50ZWxfY3J0Yy0+cGlwZSk7Cj4gICAJdTMyIHZhbCA9IEk5MTVfUkVBRChyZWcp
Owo+IEBAIC0zOTQsNyArMzk0LDcgQEAgc3RhdGljIHZvaWQgY3B0X3JlYWRfaW5mb2ZyYW1lKHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJICAgICAgIHVuc2lnbmVkIGludCB0
eXBlLAo+ICAgCQkJICAgICAgIHZvaWQgKmZyYW1lLCBzc2l6ZV90IGxlbikKPiAgIHsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5k
ZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMo
Y3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAgIAl1MzIgdmFsLCAqZGF0YSA9IGZyYW1lOwo+ICAg
CWludCBpOwo+IEBAIC00MTMsNyArNDEzLDcgQEAgc3RhdGljIHZvaWQgY3B0X3JlYWRfaW5mb2Zy
YW1lKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgc3RhdGljIHUzMiBjcHRfaW5m
b2ZyYW1lc19lbmFibGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCSAg
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ICAgewo+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRl
dik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+
YmFzZS5kZXYpOwo+ICAgCWVudW0gcGlwZSBwaXBlID0gdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZp
Zy0+YmFzZS5jcnRjKS0+cGlwZTsKPiAgIAl1MzIgdmFsID0gSTkxNV9SRUFEKFRWSURFT19ESVBf
Q1RMKHBpcGUpKTsKPiAgIAo+IEBAIC00MzEsNyArNDMxLDcgQEAgc3RhdGljIHZvaWQgdmx2X3dy
aXRlX2luZm9mcmFtZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCQljb25z
dCB2b2lkICpmcmFtZSwgc3NpemVfdCBsZW4pCj4gICB7Cj4gICAJY29uc3QgdTMyICpkYXRhID0g
ZnJhbWU7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVu
Y29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmludGVsX2Ny
dGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gICAJaTkxNV9yZWdf
dCByZWcgPSBWTFZfVFZJREVPX0RJUF9DVEwoaW50ZWxfY3J0Yy0+cGlwZSk7Cj4gICAJdTMyIHZh
bCA9IEk5MTVfUkVBRChyZWcpOwo+IEBAIC00NjcsNyArNDY3LDcgQEAgc3RhdGljIHZvaWQgdmx2
X3JlYWRfaW5mb2ZyYW1lKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJICAg
ICAgIHVuc2lnbmVkIGludCB0eXBlLAo+ICAgCQkJICAgICAgIHZvaWQgKmZyYW1lLCBzc2l6ZV90
IGxlbikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAgIAl1MzIgdmFsLCAq
ZGF0YSA9IGZyYW1lOwo+ICAgCWludCBpOwo+IEBAIC00ODYsNyArNDg2LDcgQEAgc3RhdGljIHZv
aWQgdmx2X3JlYWRfaW5mb2ZyYW1lKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAg
c3RhdGljIHUzMiB2bHZfaW5mb2ZyYW1lc19lbmFibGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAo+ICAgCQkJCSAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29u
ZmlnKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCWVudW0gcGlwZSBwaXBlID0gdG9faW50
ZWxfY3J0YyhwaXBlX2NvbmZpZy0+YmFzZS5jcnRjKS0+cGlwZTsKPiAgIAl1MzIgdmFsID0gSTkx
NV9SRUFEKFZMVl9UVklERU9fRElQX0NUTChwaXBlKSk7Cj4gICAKPiBAQCAtNTA3LDcgKzUwNyw3
IEBAIHN0YXRpYyB2b2lkIGhzd193cml0ZV9pbmZvZnJhbWUoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4gICAJCQkJY29uc3Qgdm9pZCAqZnJhbWUsIHNzaXplX3QgbGVuKQo+ICAgewo+
ICAgCWNvbnN0IHUzMiAqZGF0YSA9IGZyYW1lOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCWVudW0g
dHJhbnNjb2RlciBjcHVfdHJhbnNjb2RlciA9IGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyOwo+
ICAgCWk5MTVfcmVnX3QgY3RsX3JlZyA9IEhTV19UVklERU9fRElQX0NUTChjcHVfdHJhbnNjb2Rl
cik7Cj4gICAJaW50IGRhdGFfc2l6ZTsKPiBAQCAtNTIwLDEzICs1MjAsMTMgQEAgc3RhdGljIHZv
aWQgaHN3X3dyaXRlX2luZm9mcmFtZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAg
IAlJOTE1X1dSSVRFKGN0bF9yZWcsIHZhbCk7Cj4gICAKPiAgIAlmb3IgKGkgPSAwOyBpIDwgbGVu
OyBpICs9IDQpIHsKPiAtCQlJOTE1X1dSSVRFKGhzd19kaXBfZGF0YV9yZWcoZGV2X3ByaXYsIGNw
dV90cmFuc2NvZGVyLAo+ICsJCUk5MTVfV1JJVEUoaHN3X2RpcF9kYXRhX3JlZyhpOTE1LCBjcHVf
dHJhbnNjb2RlciwKPiAgIAkJCQkJICAgIHR5cGUsIGkgPj4gMiksICpkYXRhKTsKPiAgIAkJZGF0
YSsrOwo+ICAgCX0KPiAgIAkvKiBXcml0ZSBldmVyeSBwb3NzaWJsZSBkYXRhIGJ5dGUgdG8gZm9y
Y2UgY29ycmVjdCBFQ0MgY2FsY3VsYXRpb24uICovCj4gICAJZm9yICg7IGkgPCBkYXRhX3NpemU7
IGkgKz0gNCkKPiAtCQlJOTE1X1dSSVRFKGhzd19kaXBfZGF0YV9yZWcoZGV2X3ByaXYsIGNwdV90
cmFuc2NvZGVyLAo+ICsJCUk5MTVfV1JJVEUoaHN3X2RpcF9kYXRhX3JlZyhpOTE1LCBjcHVfdHJh
bnNjb2RlciwKPiAgIAkJCQkJICAgIHR5cGUsIGkgPj4gMiksIDApOwo+ICAgCj4gICAJdmFsIHw9
IGhzd19pbmZvZnJhbWVfZW5hYmxlKHR5cGUpOwo+IEBAIC01MzksNyArNTM5LDcgQEAgc3RhdGlj
IHZvaWQgaHN3X3JlYWRfaW5mb2ZyYW1lKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+
ICAgCQkJICAgICAgIHVuc2lnbmVkIGludCB0eXBlLAo+ICAgCQkJICAgICAgIHZvaWQgKmZyYW1l
LCBzc2l6ZV90IGxlbikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAllbnVtIHRyYW5zY29k
ZXIgY3B1X3RyYW5zY29kZXIgPSBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcjsKPiAgIAl1MzIg
dmFsLCAqZGF0YSA9IGZyYW1lOwo+ICAgCWludCBpOwo+IEBAIC01NDcsMTQgKzU0NywxNCBAQCBz
dGF0aWMgdm9pZCBoc3dfcmVhZF9pbmZvZnJhbWUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsCj4gICAJdmFsID0gSTkxNV9SRUFEKEhTV19UVklERU9fRElQX0NUTChjcHVfdHJhbnNjb2Rl
cikpOwo+ICAgCj4gICAJZm9yIChpID0gMDsgaSA8IGxlbjsgaSArPSA0KQo+IC0JCSpkYXRhKysg
PSBJOTE1X1JFQUQoaHN3X2RpcF9kYXRhX3JlZyhkZXZfcHJpdiwgY3B1X3RyYW5zY29kZXIsCj4g
KwkJKmRhdGErKyA9IEk5MTVfUkVBRChoc3dfZGlwX2RhdGFfcmVnKGk5MTUsIGNwdV90cmFuc2Nv
ZGVyLAo+ICAgCQkJCQkJICAgICB0eXBlLCBpID4+IDIpKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGlj
IHUzMiBoc3dfaW5mb2ZyYW1lc19lbmFibGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ICAgCQkJCSAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+
ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNv
ZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXUzMiB2YWwgPSBJOTE1X1JFQUQoSFNXX1RWSURF
T19ESVBfQ1RMKHBpcGVfY29uZmlnLT5jcHVfdHJhbnNjb2RlcikpOwo+ICAgCXUzMiBtYXNrOwo+
ICAgCj4gQEAgLTU2Miw3ICs1NjIsNyBAQCBzdGF0aWMgdTMyIGhzd19pbmZvZnJhbWVzX2VuYWJs
ZWQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCVZJREVPX0RJUF9FTkFCTEVf
R0NQX0hTVyB8IFZJREVPX0RJUF9FTkFCTEVfVlNfSFNXIHwKPiAgIAkJVklERU9fRElQX0VOQUJM
RV9HTVBfSFNXIHwgVklERU9fRElQX0VOQUJMRV9TUERfSFNXKTsKPiAgIAo+IC0JaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPj0gMTAgfHwgSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpCj4gKwlpZiAo
SU5URUxfR0VOKGk5MTUpID49IDEwIHx8IElTX0dFTUlOSUxBS0UoaTkxNSkpCj4gICAJCW1hc2sg
fD0gVklERU9fRElQX0VOQUJMRV9EUk1fR0xLOwo+ICAgCj4gICAJcmV0dXJuIHZhbCAmIG1hc2s7
Cj4gQEAgLTU5Myw3ICs1OTMsNyBAQCB1MzIgaW50ZWxfaGRtaV9pbmZvZnJhbWVfZW5hYmxlKHVu
c2lnbmVkIGludCB0eXBlKQo+ICAgdTMyIGludGVsX2hkbWlfaW5mb2ZyYW1lc19lbmFibGVkKHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCSAgY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3Ry
dWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQgPSBlbmNfdG9fZGlnX3BvcnQoJmVuY29k
ZXItPmJhc2UpOwo+ICAgCXUzMiB2YWwsIHJldCA9IDA7Cj4gICAJaW50IGk7Cj4gQEAgLTYwNCw3
ICs2MDQsNyBAQCB1MzIgaW50ZWxfaGRtaV9pbmZvZnJhbWVzX2VuYWJsZWQoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsCj4gICAJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoaW5mb2Zy
YW1lX3R5cGVfdG9faWR4KTsgaSsrKSB7Cj4gICAJCXVuc2lnbmVkIGludCB0eXBlID0gaW5mb2Zy
YW1lX3R5cGVfdG9faWR4W2ldOwo+ICAgCj4gLQkJaWYgKEhBU19EREkoZGV2X3ByaXYpKSB7Cj4g
KwkJaWYgKEhBU19EREkoaTkxNSkpIHsKPiAgIAkJCWlmICh2YWwgJiBoc3dfaW5mb2ZyYW1lX2Vu
YWJsZSh0eXBlKSkKPiAgIAkJCQlyZXQgfD0gQklUKGkpOwo+ICAgCQl9IGVsc2Ugewo+IEBAIC04
MDQsMTAgKzgwNCwxMCBAQCBpbnRlbF9oZG1pX2NvbXB1dGVfZHJtX2luZm9mcmFtZShzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCQkgc3RydWN0IGRybV9jb25uZWN0b3Jfc3Rh
dGUgKmNvbm5fc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0IGhkbWlfZHJtX2luZm9mcmFtZSAqZnJh
bWUgPSAmY3J0Y19zdGF0ZS0+aW5mb2ZyYW1lcy5kcm0uZHJtOwo+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+
ICAgCWludCByZXQ7Cj4gICAKPiAtCWlmICghKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgfHwg
SVNfR0VNSU5JTEFLRShkZXZfcHJpdikpKQo+ICsJaWYgKCEoSU5URUxfR0VOKGk5MTUpID49IDEw
IHx8IElTX0dFTUlOSUxBS0UoaTkxNSkpKQo+ICAgCQlyZXR1cm4gdHJ1ZTsKPiAgIAo+ICAgCWlm
ICghY3J0Y19zdGF0ZS0+aGFzX2luZm9mcmFtZSkKPiBAQCAtODM3LDcgKzgzNyw3IEBAIHN0YXRp
YyB2b2lkIGc0eF9zZXRfaW5mb2ZyYW1lcyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwK
PiAgIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwK
PiAgIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0
ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0
ICppbnRlbF9kaWdfcG9ydCA9IGVuY190b19kaWdfcG9ydCgmZW5jb2Rlci0+YmFzZSk7Cj4gICAJ
c3RydWN0IGludGVsX2hkbWkgKmludGVsX2hkbWkgPSAmaW50ZWxfZGlnX3BvcnQtPmhkbWk7Cj4g
ICAJaTkxNV9yZWdfdCByZWcgPSBWSURFT19ESVBfQ1RMOwo+IEBAIC05NDcsNyArOTQ3LDcgQEAg
c3RhdGljIGJvb2wgaW50ZWxfaGRtaV9zZXRfZ2NwX2luZm9mcmFtZShzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKPiAgIAkJCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLAo+ICAgCQkJCQkgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNv
bm5fc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2NydGMg
KmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gICAJaTkxNV9y
ZWdfdCByZWc7Cj4gICAKPiBAQCAtOTU1LDExICs5NTUsMTEgQEAgc3RhdGljIGJvb2wgaW50ZWxf
aGRtaV9zZXRfZ2NwX2luZm9mcmFtZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAg
IAkgICAgIGludGVsX2hkbWlfaW5mb2ZyYW1lX2VuYWJsZShIRE1JX1BBQ0tFVF9UWVBFX0dFTkVS
QUxfQ09OVFJPTCkpID09IDApCj4gICAJCXJldHVybiBmYWxzZTsKPiAgIAo+IC0JaWYgKEhBU19E
REkoZGV2X3ByaXYpKQo+ICsJaWYgKEhBU19EREkoaTkxNSkpCj4gICAJCXJlZyA9IEhTV19UVklE
RU9fRElQX0dDUChjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2Rlcik7Cj4gLQllbHNlIGlmIChJU19W
QUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiArCWVsc2Ug
aWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiAgIAkJcmVn
ID0gVkxWX1RWSURFT19ESVBfR0NQKGNydGMtPnBpcGUpOwo+IC0JZWxzZSBpZiAoSEFTX1BDSF9T
UExJVChkZXZfcHJpdikpCj4gKwllbHNlIGlmIChIQVNfUENIX1NQTElUKGk5MTUpKQo+ICAgCQly
ZWcgPSBUVklERU9fRElQX0dDUChjcnRjLT5waXBlKTsKPiAgIAllbHNlCj4gICAJCXJldHVybiBm
YWxzZTsKPiBAQCAtOTcyLDcgKzk3Miw3IEBAIHN0YXRpYyBib29sIGludGVsX2hkbWlfc2V0X2dj
cF9pbmZvZnJhbWUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICB2b2lkIGludGVs
X2hkbWlfcmVhZF9nY3BfaW5mb2ZyYW1lKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+
ICAgCQkJCSAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgewo+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNl
LmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rl
ci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0
YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICAgCWk5MTVfcmVnX3QgcmVnOwo+ICAgCj4gQEAg
LTk4MCwxMSArOTgwLDExIEBAIHZvaWQgaW50ZWxfaGRtaV9yZWFkX2djcF9pbmZvZnJhbWUoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJICAgICBpbnRlbF9oZG1pX2luZm9mcmFt
ZV9lbmFibGUoSERNSV9QQUNLRVRfVFlQRV9HRU5FUkFMX0NPTlRST0wpKSA9PSAwKQo+ICAgCQly
ZXR1cm47Cj4gICAKPiAtCWlmIChIQVNfRERJKGRldl9wcml2KSkKPiArCWlmIChIQVNfRERJKGk5
MTUpKQo+ICAgCQlyZWcgPSBIU1dfVFZJREVPX0RJUF9HQ1AoY3J0Y19zdGF0ZS0+Y3B1X3RyYW5z
Y29kZXIpOwo+IC0JZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZ
VklFVyhkZXZfcHJpdikpCj4gKwllbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NI
RVJSWVZJRVcoaTkxNSkpCj4gICAJCXJlZyA9IFZMVl9UVklERU9fRElQX0dDUChjcnRjLT5waXBl
KTsKPiAtCWVsc2UgaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAoSEFT
X1BDSF9TUExJVChpOTE1KSkKPiAgIAkJcmVnID0gVFZJREVPX0RJUF9HQ1AoY3J0Yy0+cGlwZSk7
Cj4gICAJZWxzZQo+ICAgCQlyZXR1cm47Cj4gQEAgLTk5Niw5ICs5OTYsOSBAQCBzdGF0aWMgdm9p
ZCBpbnRlbF9oZG1pX2NvbXB1dGVfZ2NwX2luZm9mcmFtZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlciwKPiAgIAkJCQkJICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSwKPiAgIAkJCQkJICAgICBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkK
PiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5j
b2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAo+IC0JaWYgKElTX0c0WChkZXZfcHJpdikgfHwg
IWNydGNfc3RhdGUtPmhhc19pbmZvZnJhbWUpCj4gKwlpZiAoSVNfRzRYKGk5MTUpIHx8ICFjcnRj
X3N0YXRlLT5oYXNfaW5mb2ZyYW1lKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAljcnRjX3N0YXRl
LT5pbmZvZnJhbWVzLmVuYWJsZSB8PQo+IEBAIC0xMDE5LDcgKzEwMTksNyBAQCBzdGF0aWMgdm9p
ZCBpYnhfc2V0X2luZm9mcmFtZXMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJ
CQkgICAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICAJ
CQkgICAgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29k
ZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMg
PSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gICAJc3RydWN0IGludGVs
X2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQgPSBlbmNfdG9fZGlnX3BvcnQoJmVuY29kZXIt
PmJhc2UpOwo+ICAgCXN0cnVjdCBpbnRlbF9oZG1pICppbnRlbF9oZG1pID0gJmludGVsX2RpZ19w
b3J0LT5oZG1pOwo+IEBAIC0xMDc4LDcgKzEwNzgsNyBAQCBzdGF0aWMgdm9pZCBjcHRfc2V0X2lu
Zm9mcmFtZXMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkgICAgICAgY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICAJCQkgICAgICAgY29u
c3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4gICB7Cj4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2
KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5i
YXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9j
cnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gICAJc3RydWN0IGludGVsX2hkbWkgKmludGVs
X2hkbWkgPSBlbmNfdG9faW50ZWxfaGRtaSgmZW5jb2Rlci0+YmFzZSk7Cj4gICAJaTkxNV9yZWdf
dCByZWcgPSBUVklERU9fRElQX0NUTChpbnRlbF9jcnRjLT5waXBlKTsKPiBAQCAtMTEyNyw3ICsx
MTI3LDcgQEAgc3RhdGljIHZvaWQgdmx2X3NldF9pbmZvZnJhbWVzKHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyLAo+ICAgCQkJICAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlLAo+ICAgCQkJICAgICAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0
YXRlICpjb25uX3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRl
bF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMp
Owo+ICAgCXN0cnVjdCBpbnRlbF9oZG1pICppbnRlbF9oZG1pID0gZW5jX3RvX2ludGVsX2hkbWko
JmVuY29kZXItPmJhc2UpOwo+ICAgCWk5MTVfcmVnX3QgcmVnID0gVkxWX1RWSURFT19ESVBfQ1RM
KGludGVsX2NydGMtPnBpcGUpOwo+IEBAIC0xMTg1LDExICsxMTg1LDExIEBAIHN0YXRpYyB2b2lk
IGhzd19zZXRfaW5mb2ZyYW1lcyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJ
CSAgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJ
CSAgICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiAg
IHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rl
ci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlpOTE1X3JlZ190IHJlZyA9IEhTV19UVklERU9fRElQ
X0NUTChjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2Rlcik7Cj4gICAJdTMyIHZhbCA9IEk5MTVfUkVB
RChyZWcpOwo+ICAgCj4gLQlhc3NlcnRfaGRtaV90cmFuc2NvZGVyX2Z1bmNfZGlzYWJsZWQoZGV2
X3ByaXYsCj4gKwlhc3NlcnRfaGRtaV90cmFuc2NvZGVyX2Z1bmNfZGlzYWJsZWQoaTkxNSwKPiAg
IAkJCQkJICAgICBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2Rlcik7Cj4gICAKPiAgIAl2YWwgJj0g
fihWSURFT19ESVBfRU5BQkxFX1ZTQ19IU1cgfCBWSURFT19ESVBfRU5BQkxFX0FWSV9IU1cgfAo+
IEBAIC0xMjI1LDkgKzEyMjUsOSBAQCBzdGF0aWMgdm9pZCBoc3dfc2V0X2luZm9mcmFtZXMoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAKPiAgIHZvaWQgaW50ZWxfZHBfZHVhbF9t
b2RlX3NldF90bWRzX291dHB1dChzdHJ1Y3QgaW50ZWxfaGRtaSAqaGRtaSwgYm9vbCBlbmFibGUp
Cj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGlu
dGVsX2hkbWlfdG9fZGV2KGhkbWkpKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShpbnRlbF9oZG1pX3RvX2RldihoZG1pKSk7Cj4gICAJc3RydWN0IGkyY19hZGFw
dGVyICphZGFwdGVyID0KPiAtCQlpbnRlbF9nbWJ1c19nZXRfYWRhcHRlcihkZXZfcHJpdiwgaGRt
aS0+ZGRjX2J1cyk7Cj4gKwkJaW50ZWxfZ21idXNfZ2V0X2FkYXB0ZXIoaTkxNSwgaGRtaS0+ZGRj
X2J1cyk7Cj4gICAKPiAgIAlpZiAoaGRtaS0+ZHBfZHVhbF9tb2RlLnR5cGUgPCBEUk1fRFBfRFVB
TF9NT0RFX1RZUEUyX0RWSSkKPiAgIAkJcmV0dXJuOwo+IEBAIC0xMjQzLDkgKzEyNDMsOSBAQCBz
dGF0aWMgaW50IGludGVsX2hkbWlfaGRjcF9yZWFkKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQg
KmludGVsX2RpZ19wb3J0LAo+ICAgCQkJCXVuc2lnbmVkIGludCBvZmZzZXQsIHZvaWQgKmJ1ZmZl
ciwgc2l6ZV90IHNpemUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2hkbWkgKmhkbWkgPSAmaW50
ZWxfZGlnX3BvcnQtPmhkbWk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PQo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPQo+ICAgCQlpbnRlbF9kaWdfcG9y
dC0+YmFzZS5iYXNlLmRldi0+ZGV2X3ByaXZhdGU7Cj4gLQlzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFk
YXB0ZXIgPSBpbnRlbF9nbWJ1c19nZXRfYWRhcHRlcihkZXZfcHJpdiwKPiArCXN0cnVjdCBpMmNf
YWRhcHRlciAqYWRhcHRlciA9IGludGVsX2dtYnVzX2dldF9hZGFwdGVyKGk5MTUsCj4gICAJCQkJ
CQkJICAgICAgaGRtaS0+ZGRjX2J1cyk7Cj4gICAJaW50IHJldDsKPiAgIAl1OCBzdGFydCA9IG9m
ZnNldCAmIDB4ZmY7Cj4gQEAgLTEyNzMsOSArMTI3Myw5IEBAIHN0YXRpYyBpbnQgaW50ZWxfaGRt
aV9oZGNwX3dyaXRlKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0LAo+
ICAgCQkJCSB1bnNpZ25lZCBpbnQgb2Zmc2V0LCB2b2lkICpidWZmZXIsIHNpemVfdCBzaXplKQo+
ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9oZG1pICpoZG1pID0gJmludGVsX2RpZ19wb3J0LT5oZG1p
Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0KPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0KPiAgIAkJaW50ZWxfZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYt
PmRldl9wcml2YXRlOwo+IC0Jc3RydWN0IGkyY19hZGFwdGVyICphZGFwdGVyID0gaW50ZWxfZ21i
dXNfZ2V0X2FkYXB0ZXIoZGV2X3ByaXYsCj4gKwlzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIg
PSBpbnRlbF9nbWJ1c19nZXRfYWRhcHRlcihpOTE1LAo+ICAgCQkJCQkJCSAgICAgIGhkbWktPmRk
Y19idXMpOwo+ICAgCWludCByZXQ7Cj4gICAJdTggKndyaXRlX2J1ZjsKPiBAQCAtMTMwOCw5ICsx
MzA4LDkgQEAgaW50IGludGVsX2hkbWlfaGRjcF93cml0ZV9hbl9ha3N2KHN0cnVjdCBpbnRlbF9k
aWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0LAo+ICAgCQkJCSAgdTggKmFuKQo+ICAgewo+ICAg
CXN0cnVjdCBpbnRlbF9oZG1pICpoZG1pID0gJmludGVsX2RpZ19wb3J0LT5oZG1pOwo+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0KPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0KPiAgIAkJaW50ZWxfZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYtPmRldl9wcml2
YXRlOwo+IC0Jc3RydWN0IGkyY19hZGFwdGVyICphZGFwdGVyID0gaW50ZWxfZ21idXNfZ2V0X2Fk
YXB0ZXIoZGV2X3ByaXYsCj4gKwlzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIgPSBpbnRlbF9n
bWJ1c19nZXRfYWRhcHRlcihpOTE1LAo+ICAgCQkJCQkJCSAgICAgIGhkbWktPmRkY19idXMpOwo+
ICAgCWludCByZXQ7Cj4gICAKPiBAQCAtMTQyOCw3ICsxNDI4LDcgQEAgaW50IGludGVsX2hkbWlf
aGRjcF9yZWFkX3ZfcHJpbWVfcGFydChzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9k
aWdfcG9ydCwKPiAgIAo+ICAgc3RhdGljIGludCBrYmxfcmVwb3NpdGlvbmluZ19lbmNfZW5fc2ln
bmFsKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIHsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5i
YXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQg
PSBjb25uX3RvX2RpZ19wb3J0KGNvbm5lY3Rvcik7Cj4gICAJc3RydWN0IGRybV9jcnRjICpjcnRj
ID0gY29ubmVjdG9yLT5iYXNlLnN0YXRlLT5jcnRjOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpp
bnRlbF9jcnRjID0gY29udGFpbmVyX29mKGNydGMsCj4gQEAgLTE0NjMsNyArMTQ2Myw3IEBAIGlu
dCBpbnRlbF9oZG1pX2hkY3BfdG9nZ2xlX3NpZ25hbGxpbmcoc3RydWN0IGludGVsX2RpZ2l0YWxf
cG9ydCAqaW50ZWxfZGlnX3BvcnQsCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2hkbWkgKmhkbWkg
PSAmaW50ZWxfZGlnX3BvcnQtPmhkbWk7Cj4gICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29u
bmVjdG9yID0gaGRtaS0+YXR0YWNoZWRfY29ubmVjdG9yOwo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsK
PiAgIAlpbnQgcmV0Owo+ICAgCj4gICAJaWYgKCFlbmFibGUpCj4gQEAgLTE0ODAsNyArMTQ4MCw3
IEBAIGludCBpbnRlbF9oZG1pX2hkY3BfdG9nZ2xlX3NpZ25hbGxpbmcoc3RydWN0IGludGVsX2Rp
Z2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCj4gICAJICogV0E6IFRvIGZpeCBpbmNvcnJlY3Qg
cG9zaXRpb25pbmcgb2YgdGhlIHdpbmRvdyBvZgo+ICAgCSAqIG9wcG9ydHVuaXR5IGFuZCBlbmNf
ZW4gc2lnbmFsbGluZyBpbiBLQUJZTEFLRS4KPiAgIAkgKi8KPiAtCWlmIChJU19LQUJZTEFLRShk
ZXZfcHJpdikgJiYgZW5hYmxlKQo+ICsJaWYgKElTX0tBQllMQUtFKGk5MTUpICYmIGVuYWJsZSkK
PiAgIAkJcmV0dXJuIGtibF9yZXBvc2l0aW9uaW5nX2VuY19lbl9zaWduYWwoY29ubmVjdG9yKTsK
PiAgIAo+ICAgCXJldHVybiAwOwo+IEBAIC0xNDg5LDcgKzE0ODksNyBAQCBpbnQgaW50ZWxfaGRt
aV9oZGNwX3RvZ2dsZV9zaWduYWxsaW5nKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVs
X2RpZ19wb3J0LAo+ICAgc3RhdGljCj4gICBib29sIGludGVsX2hkbWlfaGRjcF9jaGVja19saW5r
KHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0KQo+ICAgewo+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0KPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0KPiAgIAkJaW50ZWxfZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYtPmRldl9wcml2
YXRlOwo+ICAgCWVudW0gcG9ydCBwb3J0ID0gaW50ZWxfZGlnX3BvcnQtPmJhc2UucG9ydDsKPiAg
IAlpbnQgcmV0Owo+IEBAIC0xNzIwLDcgKzE3MjAsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9oZG1p
X3ByZXBhcmUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkgICAgICAgY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0
IGRybV9kZXZpY2UgKmRldiA9IGVuY29kZXItPmJhc2UuZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMg
PSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gICAJc3RydWN0IGludGVs
X2hkbWkgKmludGVsX2hkbWkgPSBlbmNfdG9faW50ZWxfaGRtaSgmZW5jb2Rlci0+YmFzZSk7Cj4g
ICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmY3J0Y19z
dGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+IEBAIC0xNzI5LDcgKzE3MjksNyBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9oZG1pX3ByZXBhcmUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4g
ICAJaW50ZWxfZHBfZHVhbF9tb2RlX3NldF90bWRzX291dHB1dChpbnRlbF9oZG1pLCB0cnVlKTsK
PiAgIAo+ICAgCWhkbWlfdmFsID0gU0RWT19FTkNPRElOR19IRE1JOwo+IC0JaWYgKCFIQVNfUENI
X1NQTElUKGRldl9wcml2KSAmJiBjcnRjX3N0YXRlLT5saW1pdGVkX2NvbG9yX3JhbmdlKQo+ICsJ
aWYgKCFIQVNfUENIX1NQTElUKGk5MTUpICYmIGNydGNfc3RhdGUtPmxpbWl0ZWRfY29sb3JfcmFu
Z2UpCj4gICAJCWhkbWlfdmFsIHw9IEhETUlfQ09MT1JfUkFOR0VfMTZfMjM1Owo+ICAgCWlmIChh
ZGp1c3RlZF9tb2RlLT5mbGFncyAmIERSTV9NT0RFX0ZMQUdfUFZTWU5DKQo+ICAgCQloZG1pX3Zh
bCB8PSBTRFZPX1ZTWU5DX0FDVElWRV9ISUdIOwo+IEBAIC0xNzQ0LDkgKzE3NDQsOSBAQCBzdGF0
aWMgdm9pZCBpbnRlbF9oZG1pX3ByZXBhcmUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
Cj4gICAJaWYgKGNydGNfc3RhdGUtPmhhc19oZG1pX3NpbmspCj4gICAJCWhkbWlfdmFsIHw9IEhE
TUlfTU9ERV9TRUxFQ1RfSERNSTsKPiAgIAo+IC0JaWYgKEhBU19QQ0hfQ1BUKGRldl9wcml2KSkK
PiArCWlmIChIQVNfUENIX0NQVChpOTE1KSkKPiAgIAkJaGRtaV92YWwgfD0gU0RWT19QSVBFX1NF
TF9DUFQoY3J0Yy0+cGlwZSk7Cj4gLQllbHNlIGlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkK
PiArCWVsc2UgaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gICAJCWhkbWlfdmFsIHw9IFNEVk9f
UElQRV9TRUxfQ0hWKGNydGMtPnBpcGUpOwo+ICAgCWVsc2UKPiAgIAkJaGRtaV92YWwgfD0gU0RW
T19QSVBFX1NFTChjcnRjLT5waXBlKTsKPiBAQCAtMTc1OCwxOSArMTc1OCwxOSBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9oZG1pX3ByZXBhcmUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4g
ICBzdGF0aWMgYm9vbCBpbnRlbF9oZG1pX2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiAgIAkJCQkgICAgZW51bSBwaXBlICpwaXBlKQo+ICAgewo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFz
ZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9oZG1pICppbnRlbF9oZG1pID0gZW5jX3RvX2ludGVs
X2hkbWkoJmVuY29kZXItPmJhc2UpOwo+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICAg
CWJvb2wgcmV0Owo+ICAgCj4gLQl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZf
ZW5hYmxlZChkZXZfcHJpdiwKPiArCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9p
Zl9lbmFibGVkKGk5MTUsCj4gICAJCQkJCQkgICAgIGVuY29kZXItPnBvd2VyX2RvbWFpbik7Cj4g
ICAJaWYgKCF3YWtlcmVmKQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gICAKPiAtCXJldCA9IGludGVs
X3Nkdm9fcG9ydF9lbmFibGVkKGRldl9wcml2LCBpbnRlbF9oZG1pLT5oZG1pX3JlZywgcGlwZSk7
Cj4gKwlyZXQgPSBpbnRlbF9zZHZvX3BvcnRfZW5hYmxlZChpOTE1LCBpbnRlbF9oZG1pLT5oZG1p
X3JlZywgcGlwZSk7Cj4gICAKPiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBl
bmNvZGVyLT5wb3dlcl9kb21haW4sIHdha2VyZWYpOwo+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9w
dXQoaTkxNSwgZW5jb2Rlci0+cG93ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiAgIAo+ICAgCXJldHVy
biByZXQ7Cj4gICB9Cj4gQEAgLTE3ODAsNyArMTc4MCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2hk
bWlfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIHsKPiAgIAlz
dHJ1Y3QgaW50ZWxfaGRtaSAqaW50ZWxfaGRtaSA9IGVuY190b19pbnRlbF9oZG1pKCZlbmNvZGVy
LT5iYXNlKTsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gZW5jb2Rlci0+YmFzZS5kZXY7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAl1MzIg
dG1wLCBmbGFncyA9IDA7Cj4gICAJaW50IGRvdGNsb2NrOwo+ICAgCj4gQEAgLTE4MTAsNyArMTgx
MCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2hkbWlfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKPiAgIAlpZiAodG1wICYgSERNSV9BVURJT19FTkFCTEUpCj4gICAJCXBp
cGVfY29uZmlnLT5oYXNfYXVkaW8gPSB0cnVlOwo+ICAgCj4gLQlpZiAoIUhBU19QQ0hfU1BMSVQo
ZGV2X3ByaXYpICYmCj4gKwlpZiAoIUhBU19QQ0hfU1BMSVQoaTkxNSkgJiYKPiAgIAkgICAgdG1w
ICYgSERNSV9DT0xPUl9SQU5HRV8xNl8yMzUpCj4gICAJCXBpcGVfY29uZmlnLT5saW1pdGVkX2Nv
bG9yX3JhbmdlID0gdHJ1ZTsKPiAgIAo+IEBAIC0xODU4LDcgKzE4NTgsNyBAQCBzdGF0aWMgdm9p
ZCBnNHhfZW5hYmxlX2hkbWkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkg
ICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4gICB7Cj4g
ICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGVuY29kZXItPmJhc2UuZGV2Owo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJc3RydWN0IGludGVsX2hk
bWkgKmludGVsX2hkbWkgPSBlbmNfdG9faW50ZWxfaGRtaSgmZW5jb2Rlci0+YmFzZSk7Cj4gICAJ
dTMyIHRlbXA7Cj4gICAKPiBAQCAtMTg4MCw3ICsxODgwLDcgQEAgc3RhdGljIHZvaWQgaWJ4X2Vu
YWJsZV9oZG1pKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJICAgIGNvbnN0
IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ICAgewo+ICAgCXN0cnVj
dCBkcm1fZGV2aWNlICpkZXYgPSBlbmNvZGVyLT5iYXNlLmRldjsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9oZG1pICppbnRl
bF9oZG1pID0gZW5jX3RvX2ludGVsX2hkbWkoJmVuY29kZXItPmJhc2UpOwo+ICAgCXUzMiB0ZW1w
Owo+ICAgCj4gQEAgLTE5MzAsNyArMTkzMCw3IEBAIHN0YXRpYyB2b2lkIGNwdF9lbmFibGVfaGRt
aShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCSAgICBjb25zdCBzdHJ1Y3Qg
ZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2ID0gZW5jb2Rlci0+YmFzZS5kZXY7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0Yyk7Cj4gICAJc3RydWN0IGludGVsX2hkbWkg
KmludGVsX2hkbWkgPSBlbmNfdG9faW50ZWxfaGRtaSgmZW5jb2Rlci0+YmFzZSk7Cj4gICAJZW51
bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+IEBAIC0xOTkxLDcgKzE5OTEsNyBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9kaXNhYmxlX2hkbWkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4g
ICAJCQkgICAgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKm9sZF9jb25uX3N0
YXRlKQo+ICAgewo+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBlbmNvZGVyLT5iYXNlLmRl
djsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsK
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXN0
cnVjdCBpbnRlbF9oZG1pICppbnRlbF9oZG1pID0gZW5jX3RvX2ludGVsX2hkbWkoJmVuY29kZXIt
PmJhc2UpOwo+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0ID0K
PiAgIAkJaGRtaV90b19kaWdfcG9ydChpbnRlbF9oZG1pKTsKPiBAQCAtMjAwOSwxMyArMjAwOSwx
MyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxlX2hkbWkoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4gICAJICogdG8gdHJhbnNjb2RlciBBIGFmdGVyIGRpc2FibGluZyBpdCB0byBh
bGxvdyB0aGUKPiAgIAkgKiBtYXRjaGluZyBEUCBwb3J0IHRvIGJlIGVuYWJsZWQgb24gdHJhbnNj
b2RlciBBLgo+ICAgCSAqLwo+IC0JaWYgKEhBU19QQ0hfSUJYKGRldl9wcml2KSAmJiBjcnRjLT5w
aXBlID09IFBJUEVfQikgewo+ICsJaWYgKEhBU19QQ0hfSUJYKGk5MTUpICYmIGNydGMtPnBpcGUg
PT0gUElQRV9CKSB7Cj4gICAJCS8qCj4gICAJCSAqIFdlIGdldCBDUFUvUENIIEZJRk8gdW5kZXJy
dW5zIG9uIHRoZSBvdGhlciBwaXBlIHdoZW4KPiAgIAkJICogZG9pbmcgdGhlIHdvcmthcm91bmQu
IFN3ZWVwIHRoZW0gdW5kZXIgdGhlIHJ1Zy4KPiAgIAkJICovCj4gLQkJaW50ZWxfc2V0X2NwdV9m
aWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZfcHJpdiwgUElQRV9BLCBmYWxzZSk7Cj4gLQkJaW50
ZWxfc2V0X3BjaF9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZfcHJpdiwgUElQRV9BLCBmYWxz
ZSk7Cj4gKwkJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhpOTE1LCBQSVBF
X0EsIGZhbHNlKTsKPiArCQlpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGk5
MTUsIFBJUEVfQSwgZmFsc2UpOwo+ICAgCj4gICAJCXRlbXAgJj0gflNEVk9fUElQRV9TRUxfTUFT
SzsKPiAgIAkJdGVtcCB8PSBTRFZPX0VOQUJMRSB8IFNEVk9fUElQRV9TRUwoUElQRV9BKTsKPiBA
QCAtMjAzMiw5ICsyMDMyLDkgQEAgc3RhdGljIHZvaWQgaW50ZWxfZGlzYWJsZV9oZG1pKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQlJOTE1X1dSSVRFKGludGVsX2hkbWktPmhk
bWlfcmVnLCB0ZW1wKTsKPiAgIAkJUE9TVElOR19SRUFEKGludGVsX2hkbWktPmhkbWlfcmVnKTsK
PiAgIAo+IC0JCWludGVsX3dhaXRfZm9yX3ZibGFua19pZl9hY3RpdmUoZGV2X3ByaXYsIFBJUEVf
QSk7Cj4gLQkJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZfcHJpdiwg
UElQRV9BLCB0cnVlKTsKPiAtCQlpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5n
KGRldl9wcml2LCBQSVBFX0EsIHRydWUpOwo+ICsJCWludGVsX3dhaXRfZm9yX3ZibGFua19pZl9h
Y3RpdmUoaTkxNSwgUElQRV9BKTsKPiArCQlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVw
b3J0aW5nKGk5MTUsIFBJUEVfQSwgdHJ1ZSk7Cj4gKwkJaW50ZWxfc2V0X3BjaF9maWZvX3VuZGVy
cnVuX3JlcG9ydGluZyhpOTE1LCBQSVBFX0EsIHRydWUpOwo+ICAgCX0KPiAgIAo+ICAgCWludGVs
X2RpZ19wb3J0LT5zZXRfaW5mb2ZyYW1lcyhlbmNvZGVyLAo+IEBAIC0yMDczLDE2ICsyMDczLDE2
IEBAIHN0YXRpYyB2b2lkIHBjaF9wb3N0X2Rpc2FibGVfaGRtaShzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiAgIAo+ICAgc3RhdGljIGludCBpbnRlbF9oZG1pX3NvdXJjZV9tYXhfdG1k
c19jbG9jayhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIHsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2Uu
ZGV2KTsKPiAgIAljb25zdCBzdHJ1Y3QgZGRpX3ZidF9wb3J0X2luZm8gKmluZm8gPQo+IC0JCSZk
ZXZfcHJpdi0+dmJ0LmRkaV9wb3J0X2luZm9bZW5jb2Rlci0+cG9ydF07Cj4gKwkJJmk5MTUtPnZi
dC5kZGlfcG9ydF9pbmZvW2VuY29kZXItPnBvcnRdOwo+ICAgCWludCBtYXhfdG1kc19jbG9jazsK
PiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgfHwgSVNfR0VNSU5JTEFLRShk
ZXZfcHJpdikpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDEwIHx8IElTX0dFTUlOSUxBS0Uo
aTkxNSkpCj4gICAJCW1heF90bWRzX2Nsb2NrID0gNTk0MDAwOwo+IC0JZWxzZSBpZiAoSU5URUxf
R0VOKGRldl9wcml2KSA+PSA4IHx8IElTX0hBU1dFTEwoZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAo
SU5URUxfR0VOKGk5MTUpID49IDggfHwgSVNfSEFTV0VMTChpOTE1KSkKPiAgIAkJbWF4X3RtZHNf
Y2xvY2sgPSAzMDAwMDA7Cj4gLQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDUpCj4g
KwllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNSkKPiAgIAkJbWF4X3RtZHNfY2xvY2sgPSAy
MjUwMDA7Cj4gICAJZWxzZQo+ICAgCQltYXhfdG1kc19jbG9jayA9IDE2NTAwMDsKPiBAQCAtMjEy
Myw3ICsyMTIzLDcgQEAgaGRtaV9wb3J0X2Nsb2NrX3ZhbGlkKHN0cnVjdCBpbnRlbF9oZG1pICpo
ZG1pLAo+ICAgCQkgICAgICBpbnQgY2xvY2ssIGJvb2wgcmVzcGVjdF9kb3duc3RyZWFtX2xpbWl0
cywKPiAgIAkJICAgICAgYm9vbCBmb3JjZV9kdmkpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGludGVsX2hkbWlfdG9fZGV2KGhkbWkpKTsKPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShpbnRlbF9oZG1pX3RvX2Rl
dihoZG1pKSk7Cj4gICAKPiAgIAlpZiAoY2xvY2sgPCAyNTAwMCkKPiAgIAkJcmV0dXJuIE1PREVf
Q0xPQ0tfTE9XOwo+IEBAIC0yMTMxLDExICsyMTMxLDExIEBAIGhkbWlfcG9ydF9jbG9ja192YWxp
ZChzdHJ1Y3QgaW50ZWxfaGRtaSAqaGRtaSwKPiAgIAkJcmV0dXJuIE1PREVfQ0xPQ0tfSElHSDsK
PiAgIAo+ICAgCS8qIEJYVCBEUExMIGNhbid0IGdlbmVyYXRlIDIyMy0yNDAgTUh6ICovCj4gLQlp
ZiAoSVNfR0VOOV9MUChkZXZfcHJpdikgJiYgY2xvY2sgPiAyMjMzMzMgJiYgY2xvY2sgPCAyNDAw
MDApCj4gKwlpZiAoSVNfR0VOOV9MUChpOTE1KSAmJiBjbG9jayA+IDIyMzMzMyAmJiBjbG9jayA8
IDI0MDAwMCkKPiAgIAkJcmV0dXJuIE1PREVfQ0xPQ0tfUkFOR0U7Cj4gICAKPiAgIAkvKiBDSFYg
RFBMTCBjYW4ndCBnZW5lcmF0ZSAyMTYtMjQwIE1IeiAqLwo+IC0JaWYgKElTX0NIRVJSWVZJRVco
ZGV2X3ByaXYpICYmIGNsb2NrID4gMjE2MDAwICYmIGNsb2NrIDwgMjQwMDAwKQo+ICsJaWYgKElT
X0NIRVJSWVZJRVcoaTkxNSkgJiYgY2xvY2sgPiAyMTYwMDAgJiYgY2xvY2sgPCAyNDAwMDApCj4g
ICAJCXJldHVybiBNT0RFX0NMT0NLX1JBTkdFOwo+ICAgCj4gICAJcmV0dXJuIE1PREVfT0s7Cj4g
QEAgLTIxNDcsNyArMjE0Nyw3IEBAIGludGVsX2hkbWlfbW9kZV92YWxpZChzdHJ1Y3QgZHJtX2Nv
bm5lY3RvciAqY29ubmVjdG9yLAo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9oZG1pICpoZG1pID0g
aW50ZWxfYXR0YWNoZWRfaGRtaShjb25uZWN0b3IpOwo+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYgPSBpbnRlbF9oZG1pX3RvX2RldihoZG1pKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCWVudW0gZHJtX21vZGVfc3RhdHVzIHN0YXR1czsKPiAg
IAlpbnQgY2xvY2s7Cj4gICAJaW50IG1heF9kb3RjbGsgPSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2
KS0+bWF4X2RvdGNsa19mcmVxOwo+IEBAIC0yMTc2LDEyICsyMTc2LDEyIEBAIGludGVsX2hkbWlf
bW9kZV92YWxpZChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+ICAgCj4gICAJaWYg
KGhkbWktPmhhc19oZG1pX3NpbmsgJiYgIWZvcmNlX2R2aSkgewo+ICAgCQkvKiBpZiB3ZSBjYW4n
dCBkbyA4YnBjIHdlIG1heSBzdGlsbCBiZSBhYmxlIHRvIGRvIDEyYnBjICovCj4gLQkJaWYgKHN0
YXR1cyAhPSBNT0RFX09LICYmICFIQVNfR01DSChkZXZfcHJpdikpCj4gKwkJaWYgKHN0YXR1cyAh
PSBNT0RFX09LICYmICFIQVNfR01DSChpOTE1KSkKPiAgIAkJCXN0YXR1cyA9IGhkbWlfcG9ydF9j
bG9ja192YWxpZChoZG1pLCBjbG9jayAqIDMgLyAyLAo+ICAgCQkJCQkJICAgICAgIHRydWUsIGZv
cmNlX2R2aSk7Cj4gICAKPiAgIAkJLyogaWYgd2UgY2FuJ3QgZG8gOCwxMmJwYyB3ZSBtYXkgc3Rp
bGwgYmUgYWJsZSB0byBkbyAxMGJwYyAqLwo+IC0JCWlmIChzdGF0dXMgIT0gTU9ERV9PSyAmJiBJ
TlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQo+ICsJCWlmIChzdGF0dXMgIT0gTU9ERV9PSyAmJiBJ
TlRFTF9HRU4oaTkxNSkgPj0gMTEpCj4gICAJCQlzdGF0dXMgPSBoZG1pX3BvcnRfY2xvY2tfdmFs
aWQoaGRtaSwgY2xvY2sgKiA1IC8gNCwKPiAgIAkJCQkJCSAgICAgICB0cnVlLCBmb3JjZV9kdmkp
Owo+ICAgCX0KPiBAQCAtMjE5Miw3ICsyMTkyLDcgQEAgaW50ZWxfaGRtaV9tb2RlX3ZhbGlkKHN0
cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCj4gICBzdGF0aWMgYm9vbCBoZG1pX2RlZXBf
Y29sb3JfcG9zc2libGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
Cj4gICAJCQkJICAgICBpbnQgYnBjKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0KPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0KPiAgIAkJdG9f
aTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gICAJc3RydWN0IGRybV9hdG9taWNf
c3RhdGUgKnN0YXRlID0gY3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZTsKPiAgIAlzdHJ1Y3QgZHJtX2Nv
bm5lY3Rvcl9zdGF0ZSAqY29ubmVjdG9yX3N0YXRlOwo+IEBAIC0yMjAxLDEwICsyMjAxLDEwIEBA
IHN0YXRpYyBib29sIGhkbWlfZGVlcF9jb2xvcl9wb3NzaWJsZShjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJJmNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRf
bW9kZTsKPiAgIAlpbnQgaTsKPiAgIAo+IC0JaWYgKEhBU19HTUNIKGRldl9wcml2KSkKPiArCWlm
IChIQVNfR01DSChpOTE1KSkKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAgCj4gLQlpZiAoYnBjID09
IDEwICYmIElOVEVMX0dFTihkZXZfcHJpdikgPCAxMSkKPiArCWlmIChicGMgPT0gMTAgJiYgSU5U
RUxfR0VOKGk5MTUpIDwgMTEpCj4gICAJCXJldHVybiBmYWxzZTsKPiAgIAo+ICAgCWlmIChjcnRj
X3N0YXRlLT5waXBlX2JwcCA8IGJwYyAqIDMpCj4gQEAgLTIyNDYsMTMgKzIyNDYsMTMgQEAgc3Rh
dGljIGJvb2wgaGRtaV9kZWVwX2NvbG9yX3Bvc3NpYmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCX0KPiAgIAo+ICAgCS8qIERpc3BsYXkgV0EgIzExMzk6
IGdsayAqLwo+IC0JaWYgKGJwYyA9PSAxMiAmJiBJU19HTEtfUkVWSUQoZGV2X3ByaXYsIDAsIEdM
S19SRVZJRF9BMSkgJiYKPiArCWlmIChicGMgPT0gMTIgJiYgSVNfR0xLX1JFVklEKGk5MTUsIDAs
IEdMS19SRVZJRF9BMSkgJiYKPiAgIAkgICAgYWRqdXN0ZWRfbW9kZS0+aHRvdGFsID4gNTQ2MCkK
PiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAgCj4gICAJLyogRGlzcGxheSBXYV8xNDA1NTEwMDU3Omlj
bCAqLwo+ICAgCWlmIChjcnRjX3N0YXRlLT5vdXRwdXRfZm9ybWF0ID09IElOVEVMX09VVFBVVF9G
T1JNQVRfWUNCQ1I0MjAgJiYKPiAtCSAgICBicGMgPT0gMTAgJiYgSU5URUxfR0VOKGRldl9wcml2
KSA+PSAxMSAmJgo+ICsJICAgIGJwYyA9PSAxMCAmJiBJTlRFTF9HRU4oaTkxNSkgPj0gMTEgJiYK
PiAgIAkgICAgKGFkanVzdGVkX21vZGUtPmNydGNfaGJsYW5rX2VuZCAtCj4gICAJICAgICBhZGp1
c3RlZF9tb2RlLT5jcnRjX2hibGFua19zdGFydCkgJSA4ID09IDIpCj4gICAJCXJldHVybiBmYWxz
ZTsKPiBAQCAtMjI5Nyw3ICsyMjk3LDcgQEAgaW50IGludGVsX2hkbWlfY29tcHV0ZV9jb25maWco
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkgICAgICBzdHJ1Y3QgZHJtX2Nv
bm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfaGRtaSAq
aW50ZWxfaGRtaSA9IGVuY190b19pbnRlbF9oZG1pKCZlbmNvZGVyLT5iYXNlKTsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiAgIAlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZw
aXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICAgCXN0cnVjdCBkcm1fY29ubmVjdG9y
ICpjb25uZWN0b3IgPSBjb25uX3N0YXRlLT5jb25uZWN0b3I7Cj4gICAJc3RydWN0IGRybV9zY2Rj
ICpzY2RjID0gJmNvbm5lY3Rvci0+ZGlzcGxheV9pbmZvLmhkbWkuc2NkYzsKPiBAQCAtMjM0NSw3
ICsyMzQ1LDcgQEAgaW50IGludGVsX2hkbWlfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmVuY29kZXIsCj4gICAJCX0KPiAgIAl9Cj4gICAKPiAtCWlmIChIQVNfUENIX1NQTElU
KGRldl9wcml2KSAmJiAhSEFTX0RESShkZXZfcHJpdikpCj4gKwlpZiAoSEFTX1BDSF9TUExJVChp
OTE1KSAmJiAhSEFTX0RESShpOTE1KSkKPiAgIAkJcGlwZV9jb25maWctPmhhc19wY2hfZW5jb2Rl
ciA9IHRydWU7Cj4gICAKPiAgIAlpZiAocGlwZV9jb25maWctPmhhc19oZG1pX3NpbmspIHsKPiBA
QCAtMjM5OSw4ICsyMzk5LDggQEAgaW50IGludGVsX2hkbWlfY29tcHV0ZV9jb25maWcoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAKPiAgIAlwaXBlX2NvbmZpZy0+bGFuZV9jb3Vu
dCA9IDQ7Cj4gICAKPiAtCWlmIChzY2RjLT5zY3JhbWJsaW5nLnN1cHBvcnRlZCAmJiAoSU5URUxf
R0VOKGRldl9wcml2KSA+PSAxMCB8fAo+IC0JCQkJCSAgIElTX0dFTUlOSUxBS0UoZGV2X3ByaXYp
KSkgewo+ICsJaWYgKHNjZGMtPnNjcmFtYmxpbmcuc3VwcG9ydGVkICYmIChJTlRFTF9HRU4oaTkx
NSkgPj0gMTAgfHwKPiArCQkJCQkgICBJU19HRU1JTklMQUtFKGk5MTUpKSkgewo+ICAgCQlpZiAo
c2NkYy0+c2NyYW1ibGluZy5sb3dfcmF0ZXMpCj4gICAJCQlwaXBlX2NvbmZpZy0+aGRtaV9zY3Jh
bWJsaW5nID0gdHJ1ZTsKPiAgIAo+IEBAIC0yNDUzLDExICsyNDUzLDExIEBAIGludGVsX2hkbWlf
dW5zZXRfZWRpZChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ICAgc3RhdGljIHZv
aWQKPiAgIGludGVsX2hkbWlfZHBfZHVhbF9tb2RlX2RldGVjdChzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
ciAqY29ubmVjdG9yLCBib29sIGhhc19lZGlkKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmRldik7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOwo+ICAgCXN0cnVj
dCBpbnRlbF9oZG1pICpoZG1pID0gaW50ZWxfYXR0YWNoZWRfaGRtaShjb25uZWN0b3IpOwo+ICAg
CWVudW0gcG9ydCBwb3J0ID0gaGRtaV90b19kaWdfcG9ydChoZG1pKS0+YmFzZS5wb3J0Owo+ICAg
CXN0cnVjdCBpMmNfYWRhcHRlciAqYWRhcHRlciA9Cj4gLQkJaW50ZWxfZ21idXNfZ2V0X2FkYXB0
ZXIoZGV2X3ByaXYsIGhkbWktPmRkY19idXMpOwo+ICsJCWludGVsX2dtYnVzX2dldF9hZGFwdGVy
KGk5MTUsIGhkbWktPmRkY19idXMpOwo+ICAgCWVudW0gZHJtX2RwX2R1YWxfbW9kZV90eXBlIHR5
cGUgPSBkcm1fZHBfZHVhbF9tb2RlX2RldGVjdChhZGFwdGVyKTsKPiAgIAo+ICAgCS8qCj4gQEAg
LTI0NzcsNyArMjQ3Nyw3IEBAIGludGVsX2hkbWlfZHBfZHVhbF9tb2RlX2RldGVjdChzdHJ1Y3Qg
ZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLCBib29sIGhhc19lZGlkKQo+ICAgCQkgKiBNYWtlIHN1
cmUgbm90IHRvIHNldCBsaW1pdHMgZm9yIHRoYXQgcG9ydC4KPiAgIAkJICovCj4gICAJCWlmICho
YXNfZWRpZCAmJiAhY29ubmVjdG9yLT5vdmVycmlkZV9lZGlkICYmCj4gLQkJICAgIGludGVsX2Jp
b3NfaXNfcG9ydF9kcF9kdWFsX21vZGUoZGV2X3ByaXYsIHBvcnQpKSB7Cj4gKwkJICAgIGludGVs
X2Jpb3NfaXNfcG9ydF9kcF9kdWFsX21vZGUoaTkxNSwgcG9ydCkpIHsKPiAgIAkJCURSTV9ERUJV
R19LTVMoIkFzc3VtaW5nIERQIGR1YWwgbW9kZSBhZGFwdG9yIHByZXNlbmNlIGJhc2VkIG9uIFZC
VFxuIik7Cj4gICAJCQl0eXBlID0gRFJNX0RQX0RVQUxfTU9ERV9UWVBFMV9EVkk7Cj4gICAJCX0g
ZWxzZSB7Cj4gQEAgLTI1MDAsMTYgKzI1MDAsMTYgQEAgaW50ZWxfaGRtaV9kcF9kdWFsX21vZGVf
ZGV0ZWN0KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsIGJvb2wgaGFzX2VkaWQpCj4g
ICBzdGF0aWMgYm9vbAo+ICAgaW50ZWxfaGRtaV9zZXRfZWRpZChzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
ciAqY29ubmVjdG9yKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShjb25uZWN0b3ItPmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9oZG1pICpp
bnRlbF9oZG1pID0gaW50ZWxfYXR0YWNoZWRfaGRtaShjb25uZWN0b3IpOwo+ICAgCWludGVsX3dh
a2VyZWZfdCB3YWtlcmVmOwo+ICAgCXN0cnVjdCBlZGlkICplZGlkOwo+ICAgCWJvb2wgY29ubmVj
dGVkID0gZmFsc2U7Cj4gICAJc3RydWN0IGkyY19hZGFwdGVyICppMmM7Cj4gICAKPiAtCXdha2Vy
ZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChkZXZfcHJpdiwgUE9XRVJfRE9NQUlOX0dNQlVT
KTsKPiArCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChpOTE1LCBQT1dFUl9ET01B
SU5fR01CVVMpOwo+ICAgCj4gLQlpMmMgPSBpbnRlbF9nbWJ1c19nZXRfYWRhcHRlcihkZXZfcHJp
diwgaW50ZWxfaGRtaS0+ZGRjX2J1cyk7Cj4gKwlpMmMgPSBpbnRlbF9nbWJ1c19nZXRfYWRhcHRl
cihpOTE1LCBpbnRlbF9oZG1pLT5kZGNfYnVzKTsKPiAgIAo+ICAgCWVkaWQgPSBkcm1fZ2V0X2Vk
aWQoY29ubmVjdG9yLCBpMmMpOwo+ICAgCj4gQEAgLTI1MjIsNyArMjUyMiw3IEBAIGludGVsX2hk
bWlfc2V0X2VkaWQoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIAo+ICAgCWlu
dGVsX2hkbWlfZHBfZHVhbF9tb2RlX2RldGVjdChjb25uZWN0b3IsIGVkaWQgIT0gTlVMTCk7Cj4g
ICAKPiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBQT1dFUl9ET01BSU5fR01C
VVMsIHdha2VyZWYpOwo+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgUE9XRVJfRE9N
QUlOX0dNQlVTLCB3YWtlcmVmKTsKPiAgIAo+ICAgCXRvX2ludGVsX2Nvbm5lY3Rvcihjb25uZWN0
b3IpLT5kZXRlY3RfZWRpZCA9IGVkaWQ7Cj4gICAJaWYgKGVkaWQgJiYgZWRpZC0+aW5wdXQgJiBE
Uk1fRURJRF9JTlBVVF9ESUdJVEFMKSB7Cj4gQEAgLTI1NDEsNyArMjU0MSw3IEBAIHN0YXRpYyBl
bnVtIGRybV9jb25uZWN0b3Jfc3RhdHVzCj4gICBpbnRlbF9oZG1pX2RldGVjdChzdHJ1Y3QgZHJt
X2Nvbm5lY3RvciAqY29ubmVjdG9yLCBib29sIGZvcmNlKQo+ICAgewo+ICAgCWVudW0gZHJtX2Nv
bm5lY3Rvcl9zdGF0dXMgc3RhdHVzID0gY29ubmVjdG9yX3N0YXR1c19kaXNjb25uZWN0ZWQ7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+
ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0
b3ItPmRldik7Cj4gICAJc3RydWN0IGludGVsX2hkbWkgKmludGVsX2hkbWkgPSBpbnRlbF9hdHRh
Y2hlZF9oZG1pKGNvbm5lY3Rvcik7Cj4gICAJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIg
PSAmaGRtaV90b19kaWdfcG9ydChpbnRlbF9oZG1pKS0+YmFzZTsKPiAgIAlpbnRlbF93YWtlcmVm
X3Qgd2FrZXJlZjsKPiBAQCAtMjU0OSw5ICsyNTQ5LDkgQEAgaW50ZWxfaGRtaV9kZXRlY3Qoc3Ry
dWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwgYm9vbCBmb3JjZSkKPiAgIAlEUk1fREVCVUdf
S01TKCJbQ09OTkVDVE9SOiVkOiVzXVxuIiwKPiAgIAkJICAgICAgY29ubmVjdG9yLT5iYXNlLmlk
LCBjb25uZWN0b3ItPm5hbWUpOwo+ICAgCj4gLQl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dl
cl9nZXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9HTUJVUyk7Cj4gKwl3YWtlcmVmID0gaW50ZWxf
ZGlzcGxheV9wb3dlcl9nZXQoaTkxNSwgUE9XRVJfRE9NQUlOX0dNQlVTKTsKPiAgIAo+IC0JaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEgJiYKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0g
MTEgJiYKPiAgIAkgICAgIWludGVsX2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQoZW5jb2RlcikpCj4g
ICAJCWdvdG8gb3V0Owo+ICAgCj4gQEAgLTI1NjEsNyArMjU2MSw3IEBAIGludGVsX2hkbWlfZGV0
ZWN0KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsIGJvb2wgZm9yY2UpCj4gICAJCXN0
YXR1cyA9IGNvbm5lY3Rvcl9zdGF0dXNfY29ubmVjdGVkOwo+ICAgCj4gICBvdXQ6Cj4gLQlpbnRl
bF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwgUE9XRVJfRE9NQUlOX0dNQlVTLCB3YWtlcmVm
KTsKPiArCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5MTUsIFBPV0VSX0RPTUFJTl9HTUJVUywg
d2FrZXJlZik7Cj4gICAKPiAgIAlpZiAoc3RhdHVzICE9IGNvbm5lY3Rvcl9zdGF0dXNfY29ubmVj
dGVkKQo+ICAgCQljZWNfbm90aWZpZXJfcGh5c19hZGRyX2ludmFsaWRhdGUoaW50ZWxfaGRtaS0+
Y2VjX25vdGlmaWVyKTsKPiBAQCAtMjYxMyw3ICsyNjEzLDcgQEAgc3RhdGljIHZvaWQgdmx2X2hk
bWlfcHJlX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCQljb25z
dCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1
Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkcG9ydCA9IGVuY190b19kaWdfcG9ydCgmZW5jb2Rlci0+
YmFzZSk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVu
Y29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAKPiAgIAl2bHZfcGh5X3ByZV9lbmNvZGVyX2Vu
YWJsZShlbmNvZGVyLCBwaXBlX2NvbmZpZyk7Cj4gICAKPiBAQCAtMjYyNyw3ICsyNjI3LDcgQEAg
c3RhdGljIHZvaWQgdmx2X2hkbWlfcHJlX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKPiAgIAo+ICAgCWc0eF9lbmFibGVfaGRtaShlbmNvZGVyLCBwaXBlX2NvbmZpZywgY29u
bl9zdGF0ZSk7Cj4gICAKPiAtCXZsdl93YWl0X3BvcnRfcmVhZHkoZGV2X3ByaXYsIGRwb3J0LCAw
eDApOwo+ICsJdmx2X3dhaXRfcG9ydF9yZWFkeShpOTE1LCBkcG9ydCwgMHgwKTsKPiAgIH0KPiAg
IAo+ICAgc3RhdGljIHZvaWQgdmx2X2hkbWlfcHJlX3BsbF9lbmFibGUoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmVuY29kZXIsCj4gQEAgLTI2NjgsMTQgKzI2NjgsMTQgQEAgc3RhdGljIHZvaWQgY2h2
X2hkbWlfcG9zdF9kaXNhYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJ
CSAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKm9sZF9jb25uX3N0YXRlKQo+ICAg
ewo+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBlbmNvZGVyLT5iYXNlLmRldjsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCj4gLQl2bHZfZHBp
b19nZXQoZGV2X3ByaXYpOwo+ICsJdmx2X2RwaW9fZ2V0KGk5MTUpOwo+ICAgCj4gICAJLyogQXNz
ZXJ0IGRhdGEgbGFuZSByZXNldCAqLwo+ICAgCWNodl9kYXRhX2xhbmVfc29mdF9yZXNldChlbmNv
ZGVyLCBvbGRfY3J0Y19zdGF0ZSwgdHJ1ZSk7Cj4gICAKPiAtCXZsdl9kcGlvX3B1dChkZXZfcHJp
dik7Cj4gKwl2bHZfZHBpb19wdXQoaTkxNSk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIGNo
dl9oZG1pX3ByZV9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gQEAgLTI2
ODQsNyArMjY4NCw3IEBAIHN0YXRpYyB2b2lkIGNodl9oZG1pX3ByZV9lbmFibGUoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9y
dCAqZHBvcnQgPSBlbmNfdG9fZGlnX3BvcnQoJmVuY29kZXItPmJhc2UpOwo+ICAgCXN0cnVjdCBk
cm1fZGV2aWNlICpkZXYgPSBlbmNvZGVyLT5iYXNlLmRldjsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCj4gICAJY2h2X3BoeV9wcmVfZW5jb2Rlcl9l
bmFibGUoZW5jb2RlciwgcGlwZV9jb25maWcpOwo+ICAgCj4gQEAgLTI2OTgsNyArMjY5OCw3IEBA
IHN0YXRpYyB2b2lkIGNodl9oZG1pX3ByZV9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCj4gICAKPiAgIAlnNHhfZW5hYmxlX2hkbWkoZW5jb2RlciwgcGlwZV9jb25maWcsIGNv
bm5fc3RhdGUpOwo+ICAgCj4gLQl2bHZfd2FpdF9wb3J0X3JlYWR5KGRldl9wcml2LCBkcG9ydCwg
MHgwKTsKPiArCXZsdl93YWl0X3BvcnRfcmVhZHkoaTkxNSwgZHBvcnQsIDB4MCk7Cj4gICAKPiAg
IAkvKiBTZWNvbmQgY29tbW9uIGxhbmUgd2lsbCBzdGF5IGFsaXZlIG9uIGl0cyBvd24gbm93ICov
Cj4gICAJY2h2X3BoeV9yZWxlYXNlX2NsMl9vdmVycmlkZShlbmNvZGVyKTsKPiBAQCAtMjcwNywx
MCArMjcwNywxMCBAQCBzdGF0aWMgdm9pZCBjaHZfaGRtaV9wcmVfZW5hYmxlKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+ICAgc3RhdGljIHN0cnVjdCBpMmNfYWRhcHRlciAqCj4gICBp
bnRlbF9oZG1pX2dldF9pMmNfYWRhcHRlcihzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9y
KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShj
b25uZWN0b3ItPmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoY29ubmVjdG9yLT5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9oZG1pICppbnRlbF9oZG1pID0g
aW50ZWxfYXR0YWNoZWRfaGRtaShjb25uZWN0b3IpOwo+ICAgCj4gLQlyZXR1cm4gaW50ZWxfZ21i
dXNfZ2V0X2FkYXB0ZXIoZGV2X3ByaXYsIGludGVsX2hkbWktPmRkY19idXMpOwo+ICsJcmV0dXJu
IGludGVsX2dtYnVzX2dldF9hZGFwdGVyKGk5MTUsIGludGVsX2hkbWktPmRkY19idXMpOwo+ICAg
fQo+ICAgCj4gICBzdGF0aWMgdm9pZCBpbnRlbF9oZG1pX2NyZWF0ZV9pMmNfc3ltbGluayhzdHJ1
Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+IEBAIC0yNzkxLDcgKzI3OTEsNyBAQCBzdGF0
aWMgY29uc3Qgc3RydWN0IGRybV9lbmNvZGVyX2Z1bmNzIGludGVsX2hkbWlfZW5jX2Z1bmNzID0g
ewo+ICAgc3RhdGljIHZvaWQKPiAgIGludGVsX2hkbWlfYWRkX3Byb3BlcnRpZXMoc3RydWN0IGlu
dGVsX2hkbWkgKmludGVsX2hkbWksIHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5l
Y3Rvci0+ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShj
b25uZWN0b3ItPmRldik7Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGln
X3BvcnQgPQo+ICAgCQkJCWhkbWlfdG9fZGlnX3BvcnQoaW50ZWxfaGRtaSk7Cj4gICAKPiBAQCAt
MjgxMCwxMSArMjgxMCwxMSBAQCBpbnRlbF9oZG1pX2FkZF9wcm9wZXJ0aWVzKHN0cnVjdCBpbnRl
bF9oZG1pICppbnRlbF9oZG1pLCBzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqYwo+ICAgCWRybV9jb25u
ZWN0b3JfYXR0YWNoX2NvbnRlbnRfdHlwZV9wcm9wZXJ0eShjb25uZWN0b3IpOwo+ICAgCWNvbm5l
Y3Rvci0+c3RhdGUtPnBpY3R1cmVfYXNwZWN0X3JhdGlvID0gSERNSV9QSUNUVVJFX0FTUEVDVF9O
T05FOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCB8fCBJU19HRU1JTklM
QUtFKGRldl9wcml2KSkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTAgfHwgSVNfR0VNSU5J
TEFLRShpOTE1KSkKPiAgIAkJZHJtX29iamVjdF9hdHRhY2hfcHJvcGVydHkoJmNvbm5lY3Rvci0+
YmFzZSwKPiAgIAkJCWNvbm5lY3Rvci0+ZGV2LT5tb2RlX2NvbmZpZy5oZHJfb3V0cHV0X21ldGFk
YXRhX3Byb3BlcnR5LCAwKTsKPiAgIAo+IC0JaWYgKCFIQVNfR01DSChkZXZfcHJpdikpCj4gKwlp
ZiAoIUhBU19HTUNIKGk5MTUpKQo+ICAgCQlkcm1fY29ubmVjdG9yX2F0dGFjaF9tYXhfYnBjX3By
b3BlcnR5KGNvbm5lY3RvciwgOCwgMTIpOwo+ICAgfQo+ICAgCj4gQEAgLTI4NDEsMTIgKzI4NDEs
MTIgQEAgYm9vbCBpbnRlbF9oZG1pX2hhbmRsZV9zaW5rX3NjcmFtYmxpbmcoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkJICAgICAgIGJvb2wgaGlnaF90bWRzX2Nsb2NrX3Jh
dGlvLAo+ICAgCQkJCSAgICAgICBib29sIHNjcmFtYmxpbmcpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRl
dik7Cj4gICAJc3RydWN0IGludGVsX2hkbWkgKmludGVsX2hkbWkgPSBlbmNfdG9faW50ZWxfaGRt
aSgmZW5jb2Rlci0+YmFzZSk7Cj4gICAJc3RydWN0IGRybV9zY3JhbWJsaW5nICpzaW5rX3NjcmFt
YmxpbmcgPQo+ICAgCQkmY29ubmVjdG9yLT5kaXNwbGF5X2luZm8uaGRtaS5zY2RjLnNjcmFtYmxp
bmc7Cj4gICAJc3RydWN0IGkyY19hZGFwdGVyICphZGFwdGVyID0KPiAtCQlpbnRlbF9nbWJ1c19n
ZXRfYWRhcHRlcihkZXZfcHJpdiwgaW50ZWxfaGRtaS0+ZGRjX2J1cyk7Cj4gKwkJaW50ZWxfZ21i
dXNfZ2V0X2FkYXB0ZXIoaTkxNSwgaW50ZWxfaGRtaS0+ZGRjX2J1cyk7Cj4gICAKPiAgIAlpZiAo
IXNpbmtfc2NyYW1ibGluZy0+c3VwcG9ydGVkKQo+ICAgCQlyZXR1cm4gdHJ1ZTsKPiBAQCAtMjg2
MSw3ICsyODYxLDcgQEAgYm9vbCBpbnRlbF9oZG1pX2hhbmRsZV9zaW5rX3NjcmFtYmxpbmcoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCWRybV9zY2RjX3NldF9zY3JhbWJsaW5n
KGFkYXB0ZXIsIHNjcmFtYmxpbmcpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB1OCBjaHZfcG9ydF90
b19kZGNfcGluKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBv
cnQpCj4gK3N0YXRpYyB1OCBjaHZfcG9ydF90b19kZGNfcGluKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LCBlbnVtIHBvcnQgcG9ydCkKPiAgIHsKPiAgIAl1OCBkZGNfcGluOwo+ICAgCj4g
QEAgLTI4ODMsNyArMjg4Myw3IEBAIHN0YXRpYyB1OCBjaHZfcG9ydF90b19kZGNfcGluKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBvcnQpCj4gICAJcmV0dXJu
IGRkY19waW47Cj4gICB9Cj4gICAKPiAtc3RhdGljIHU4IGJ4dF9wb3J0X3RvX2RkY19waW4oc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBvcnQgcG9ydCkKPiArc3RhdGlj
IHU4IGJ4dF9wb3J0X3RvX2RkY19waW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVu
dW0gcG9ydCBwb3J0KQo+ICAgewo+ICAgCXU4IGRkY19waW47Cj4gICAKPiBAQCAtMjkwMiw3ICsy
OTAyLDcgQEAgc3RhdGljIHU4IGJ4dF9wb3J0X3RvX2RkY19waW4oc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LCBlbnVtIHBvcnQgcG9ydCkKPiAgIAlyZXR1cm4gZGRjX3BpbjsKPiAg
IH0KPiAgIAo+IC1zdGF0aWMgdTggY25wX3BvcnRfdG9fZGRjX3BpbihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB1OCBjbnBfcG9ydF90b19kZGNfcGluKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgICAgZW51bSBwb3J0IHBvcnQpCj4g
ICB7Cj4gICAJdTggZGRjX3BpbjsKPiBAQCAtMjkyOCw3ICsyOTI4LDcgQEAgc3RhdGljIHU4IGNu
cF9wb3J0X3RvX2RkY19waW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAg
CXJldHVybiBkZGNfcGluOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB1OCBpY2xfcG9ydF90b19kZGNf
cGluKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBvcnQpCj4g
K3N0YXRpYyB1OCBpY2xfcG9ydF90b19kZGNfcGluKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LCBlbnVtIHBvcnQgcG9ydCkKPiAgIHsKPiAgIAl1OCBkZGNfcGluOwo+ICAgCj4gQEAgLTI5
NTksNyArMjk1OSw3IEBAIHN0YXRpYyB1OCBpY2xfcG9ydF90b19kZGNfcGluKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBvcnQpCj4gICAJcmV0dXJuIGRkY19w
aW47Cj4gICB9Cj4gICAKPiAtc3RhdGljIHU4IGc0eF9wb3J0X3RvX2RkY19waW4oc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdTggZzR4X3BvcnRfdG9fZGRjX3Bp
bihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgIGVudW0gcG9ydCBw
b3J0KQo+ICAgewo+ICAgCXU4IGRkY19waW47Cj4gQEAgLTI5ODIsMTEgKzI5ODIsMTEgQEAgc3Rh
dGljIHU4IGc0eF9wb3J0X3RvX2RkY19waW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ICAgCXJldHVybiBkZGNfcGluOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB1OCBpbnRlbF9o
ZG1pX2RkY19waW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMg
dTggaW50ZWxfaGRtaV9kZGNfcGluKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAg
CQkJICAgICBlbnVtIHBvcnQgcG9ydCkKPiAgIHsKPiAgIAljb25zdCBzdHJ1Y3QgZGRpX3ZidF9w
b3J0X2luZm8gKmluZm8gPQo+IC0JCSZkZXZfcHJpdi0+dmJ0LmRkaV9wb3J0X2luZm9bcG9ydF07
Cj4gKwkJJmk5MTUtPnZidC5kZGlfcG9ydF9pbmZvW3BvcnRdOwo+ICAgCXU4IGRkY19waW47Cj4g
ICAKPiAgIAlpZiAoaW5mby0+YWx0ZXJuYXRlX2RkY19waW4pIHsKPiBAQCAtMjk5NSwxNiArMjk5
NSwxNiBAQCBzdGF0aWMgdTggaW50ZWxfaGRtaV9kZGNfcGluKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiAgIAkJcmV0dXJuIGluZm8tPmFsdGVybmF0ZV9kZGNfcGluOwo+ICAg
CX0KPiAgIAo+IC0JaWYgKEhBU19QQ0hfSUNQKGRldl9wcml2KSkKPiAtCQlkZGNfcGluID0gaWNs
X3BvcnRfdG9fZGRjX3BpbihkZXZfcHJpdiwgcG9ydCk7Cj4gLQllbHNlIGlmIChIQVNfUENIX0NO
UChkZXZfcHJpdikpCj4gLQkJZGRjX3BpbiA9IGNucF9wb3J0X3RvX2RkY19waW4oZGV2X3ByaXYs
IHBvcnQpOwo+IC0JZWxzZSBpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCj4gLQkJZGRjX3BpbiA9
IGJ4dF9wb3J0X3RvX2RkY19waW4oZGV2X3ByaXYsIHBvcnQpOwo+IC0JZWxzZSBpZiAoSVNfQ0hF
UlJZVklFVyhkZXZfcHJpdikpCj4gLQkJZGRjX3BpbiA9IGNodl9wb3J0X3RvX2RkY19waW4oZGV2
X3ByaXYsIHBvcnQpOwo+ICsJaWYgKEhBU19QQ0hfSUNQKGk5MTUpKQo+ICsJCWRkY19waW4gPSBp
Y2xfcG9ydF90b19kZGNfcGluKGk5MTUsIHBvcnQpOwo+ICsJZWxzZSBpZiAoSEFTX1BDSF9DTlAo
aTkxNSkpCj4gKwkJZGRjX3BpbiA9IGNucF9wb3J0X3RvX2RkY19waW4oaTkxNSwgcG9ydCk7Cj4g
KwllbHNlIGlmIChJU19HRU45X0xQKGk5MTUpKQo+ICsJCWRkY19waW4gPSBieHRfcG9ydF90b19k
ZGNfcGluKGk5MTUsIHBvcnQpOwo+ICsJZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiAr
CQlkZGNfcGluID0gY2h2X3BvcnRfdG9fZGRjX3BpbihpOTE1LCBwb3J0KTsKPiAgIAllbHNlCj4g
LQkJZGRjX3BpbiA9IGc0eF9wb3J0X3RvX2RkY19waW4oZGV2X3ByaXYsIHBvcnQpOwo+ICsJCWRk
Y19waW4gPSBnNHhfcG9ydF90b19kZGNfcGluKGk5MTUsIHBvcnQpOwo+ICAgCj4gICAJRFJNX0RF
QlVHX0tNUygiVXNpbmcgRERDIHBpbiAweCV4IGZvciBwb3J0ICVjIChwbGF0Zm9ybSBkZWZhdWx0
KVxuIiwKPiAgIAkJICAgICAgZGRjX3BpbiwgcG9ydF9uYW1lKHBvcnQpKTsKPiBAQCAtMzAxNCwy
MCArMzAxNCwyMCBAQCBzdGF0aWMgdTggaW50ZWxfaGRtaV9kZGNfcGluKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAo+ICAgdm9pZCBpbnRlbF9pbmZvZnJhbWVfaW5pdChz
dHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCkKPiAgIHsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9Cj4gICAJCXRvX2k5MTUoaW50ZWxfZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOwo+
ICAgCj4gLQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZf
cHJpdikpIHsKPiArCWlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkx
NSkpIHsKPiAgIAkJaW50ZWxfZGlnX3BvcnQtPndyaXRlX2luZm9mcmFtZSA9IHZsdl93cml0ZV9p
bmZvZnJhbWU7Cj4gICAJCWludGVsX2RpZ19wb3J0LT5yZWFkX2luZm9mcmFtZSA9IHZsdl9yZWFk
X2luZm9mcmFtZTsKPiAgIAkJaW50ZWxfZGlnX3BvcnQtPnNldF9pbmZvZnJhbWVzID0gdmx2X3Nl
dF9pbmZvZnJhbWVzOwo+ICAgCQlpbnRlbF9kaWdfcG9ydC0+aW5mb2ZyYW1lc19lbmFibGVkID0g
dmx2X2luZm9mcmFtZXNfZW5hYmxlZDsKPiAtCX0gZWxzZSBpZiAoSVNfRzRYKGRldl9wcml2KSkg
ewo+ICsJfSBlbHNlIGlmIChJU19HNFgoaTkxNSkpIHsKPiAgIAkJaW50ZWxfZGlnX3BvcnQtPndy
aXRlX2luZm9mcmFtZSA9IGc0eF93cml0ZV9pbmZvZnJhbWU7Cj4gICAJCWludGVsX2RpZ19wb3J0
LT5yZWFkX2luZm9mcmFtZSA9IGc0eF9yZWFkX2luZm9mcmFtZTsKPiAgIAkJaW50ZWxfZGlnX3Bv
cnQtPnNldF9pbmZvZnJhbWVzID0gZzR4X3NldF9pbmZvZnJhbWVzOwo+ICAgCQlpbnRlbF9kaWdf
cG9ydC0+aW5mb2ZyYW1lc19lbmFibGVkID0gZzR4X2luZm9mcmFtZXNfZW5hYmxlZDsKPiAtCX0g
ZWxzZSBpZiAoSEFTX0RESShkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAoSEFTX0RESShpOTE1
KSkgewo+ICAgCQlpZiAoaW50ZWxfZGlnX3BvcnQtPmxzcGNvbi5hY3RpdmUpIHsKPiAgIAkJCWlu
dGVsX2RpZ19wb3J0LT53cml0ZV9pbmZvZnJhbWUgPSBsc3Bjb25fd3JpdGVfaW5mb2ZyYW1lOwo+
ICAgCQkJaW50ZWxfZGlnX3BvcnQtPnJlYWRfaW5mb2ZyYW1lID0gbHNwY29uX3JlYWRfaW5mb2Zy
YW1lOwo+IEBAIC0zMDM5LDcgKzMwMzksNyBAQCB2b2lkIGludGVsX2luZm9mcmFtZV9pbml0KHN0
cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0KQo+ICAgCQkJaW50ZWxfZGln
X3BvcnQtPnNldF9pbmZvZnJhbWVzID0gaHN3X3NldF9pbmZvZnJhbWVzOwo+ICAgCQkJaW50ZWxf
ZGlnX3BvcnQtPmluZm9mcmFtZXNfZW5hYmxlZCA9IGhzd19pbmZvZnJhbWVzX2VuYWJsZWQ7Cj4g
ICAJCX0KPiAtCX0gZWxzZSBpZiAoSEFTX1BDSF9JQlgoZGV2X3ByaXYpKSB7Cj4gKwl9IGVsc2Ug
aWYgKEhBU19QQ0hfSUJYKGk5MTUpKSB7Cj4gICAJCWludGVsX2RpZ19wb3J0LT53cml0ZV9pbmZv
ZnJhbWUgPSBpYnhfd3JpdGVfaW5mb2ZyYW1lOwo+ICAgCQlpbnRlbF9kaWdfcG9ydC0+cmVhZF9p
bmZvZnJhbWUgPSBpYnhfcmVhZF9pbmZvZnJhbWU7Cj4gICAJCWludGVsX2RpZ19wb3J0LT5zZXRf
aW5mb2ZyYW1lcyA9IGlieF9zZXRfaW5mb2ZyYW1lczsKPiBAQCAtMzA1OSw3ICszMDU5LDcgQEAg
dm9pZCBpbnRlbF9oZG1pX2luaXRfY29ubmVjdG9yKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQg
KmludGVsX2RpZ19wb3J0LAo+ICAgCXN0cnVjdCBpbnRlbF9oZG1pICppbnRlbF9oZG1pID0gJmlu
dGVsX2RpZ19wb3J0LT5oZG1pOwo+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICppbnRlbF9lbmNv
ZGVyID0gJmludGVsX2RpZ19wb3J0LT5iYXNlOwo+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYg
PSBpbnRlbF9lbmNvZGVyLT5iYXNlLmRldjsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShkZXYpOwo+ICAgCWVudW0gcG9ydCBwb3J0ID0gaW50ZWxfZW5jb2Rlci0+cG9y
dDsKPiAgIAo+ICAgCURSTV9ERUJVR19LTVMoIkFkZGluZyBIRE1JIGNvbm5lY3RvciBvbiBwb3J0
ICVjXG4iLAo+IEBAIC0zMDc4LDE2ICszMDc4LDE2IEBAIHZvaWQgaW50ZWxfaGRtaV9pbml0X2Nv
bm5lY3RvcihzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCwKPiAgIAlj
b25uZWN0b3ItPmRvdWJsZXNjYW5fYWxsb3dlZCA9IDA7Cj4gICAJY29ubmVjdG9yLT5zdGVyZW9f
YWxsb3dlZCA9IDE7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwIHx8IElT
X0dFTUlOSUxBS0UoZGV2X3ByaXYpKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMCB8fCBJ
U19HRU1JTklMQUtFKGk5MTUpKQo+ICAgCQljb25uZWN0b3ItPnljYmNyXzQyMF9hbGxvd2VkID0g
dHJ1ZTsKPiAgIAo+IC0JaW50ZWxfaGRtaS0+ZGRjX2J1cyA9IGludGVsX2hkbWlfZGRjX3Bpbihk
ZXZfcHJpdiwgcG9ydCk7Cj4gKwlpbnRlbF9oZG1pLT5kZGNfYnVzID0gaW50ZWxfaGRtaV9kZGNf
cGluKGk5MTUsIHBvcnQpOwo+ICAgCj4gICAJaWYgKFdBUk5fT04ocG9ydCA9PSBQT1JUX0EpKQo+
ICAgCQlyZXR1cm47Cj4gLQlpbnRlbF9lbmNvZGVyLT5ocGRfcGluID0gaW50ZWxfaHBkX3Bpbl9k
ZWZhdWx0KGRldl9wcml2LCBwb3J0KTsKPiArCWludGVsX2VuY29kZXItPmhwZF9waW4gPSBpbnRl
bF9ocGRfcGluX2RlZmF1bHQoaTkxNSwgcG9ydCk7Cj4gICAKPiAtCWlmIChIQVNfRERJKGRldl9w
cml2KSkKPiArCWlmIChIQVNfRERJKGk5MTUpKQo+ICAgCQlpbnRlbF9jb25uZWN0b3ItPmdldF9o
d19zdGF0ZSA9IGludGVsX2RkaV9jb25uZWN0b3JfZ2V0X2h3X3N0YXRlOwo+ICAgCWVsc2UKPiAg
IAkJaW50ZWxfY29ubmVjdG9yLT5nZXRfaHdfc3RhdGUgPSBpbnRlbF9jb25uZWN0b3JfZ2V0X2h3
X3N0YXRlOwo+IEBAIC0zMDk3LDcgKzMwOTcsNyBAQCB2b2lkIGludGVsX2hkbWlfaW5pdF9jb25u
ZWN0b3Ioc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCj4gICAJaW50
ZWxfY29ubmVjdG9yX2F0dGFjaF9lbmNvZGVyKGludGVsX2Nvbm5lY3RvciwgaW50ZWxfZW5jb2Rl
cik7Cj4gICAJaW50ZWxfaGRtaS0+YXR0YWNoZWRfY29ubmVjdG9yID0gaW50ZWxfY29ubmVjdG9y
Owo+ICAgCj4gLQlpZiAoaXNfaGRjcF9zdXBwb3J0ZWQoZGV2X3ByaXYsIHBvcnQpKSB7Cj4gKwlp
ZiAoaXNfaGRjcF9zdXBwb3J0ZWQoaTkxNSwgcG9ydCkpIHsKPiAgIAkJaW50IHJldCA9IGludGVs
X2hkY3BfaW5pdChpbnRlbF9jb25uZWN0b3IsCj4gICAJCQkJCSAgJmludGVsX2hkbWlfaGRjcF9z
aGltKTsKPiAgIAkJaWYgKHJldCkKPiBAQCAtMzEwOCw3ICszMTA4LDcgQEAgdm9pZCBpbnRlbF9o
ZG1pX2luaXRfY29ubmVjdG9yKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19w
b3J0LAo+ICAgCSAqIDB4ZC4gIEZhaWx1cmUgdG8gZG8gc28gd2lsbCByZXN1bHQgaW4gc3B1cmlv
dXMgaW50ZXJydXB0cyBiZWluZwo+ICAgCSAqIGdlbmVyYXRlZCBvbiB0aGUgcG9ydCB3aGVuIGEg
Y2FibGUgaXMgbm90IGF0dGFjaGVkLgo+ICAgCSAqLwo+IC0JaWYgKElTX0c0NShkZXZfcHJpdikp
IHsKPiArCWlmIChJU19HNDUoaTkxNSkpIHsKPiAgIAkJdTMyIHRlbXAgPSBJOTE1X1JFQUQoUEVH
X0JBTkRfR0FQX0RBVEEpOwo+ICAgCQlJOTE1X1dSSVRFKFBFR19CQU5EX0dBUF9EQVRBLCAodGVt
cCAmIH4weGYpIHwgMHhkKTsKPiAgIAl9Cj4gQEAgLTMxMTksNyArMzExOSw3IEBAIHZvaWQgaW50
ZWxfaGRtaV9pbml0X2Nvbm5lY3RvcihzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9k
aWdfcG9ydCwKPiAgIAkJRFJNX0RFQlVHX0tNUygiQ0VDIG5vdGlmaWVyIGdldCBmYWlsZWRcbiIp
Owo+ICAgfQo+ICAgCj4gLXZvaWQgaW50ZWxfaGRtaV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiArdm9pZCBpbnRlbF9oZG1pX2luaXQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gICAJCSAgICAgaTkxNV9yZWdfdCBoZG1pX3JlZywgZW51bSBwb3J0IHBv
cnQpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQ7
Cj4gQEAgLTMxMzgsMTMgKzMxMzgsMTMgQEAgdm9pZCBpbnRlbF9oZG1pX2luaXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCj4gICAJaW50ZWxfZW5jb2RlciA9ICZpbnRl
bF9kaWdfcG9ydC0+YmFzZTsKPiAgIAo+IC0JZHJtX2VuY29kZXJfaW5pdCgmZGV2X3ByaXYtPmRy
bSwgJmludGVsX2VuY29kZXItPmJhc2UsCj4gKwlkcm1fZW5jb2Rlcl9pbml0KCZpOTE1LT5kcm0s
ICZpbnRlbF9lbmNvZGVyLT5iYXNlLAo+ICAgCQkJICZpbnRlbF9oZG1pX2VuY19mdW5jcywgRFJN
X01PREVfRU5DT0RFUl9UTURTLAo+ICAgCQkJICJIRE1JICVjIiwgcG9ydF9uYW1lKHBvcnQpKTsK
PiAgIAo+ICAgCWludGVsX2VuY29kZXItPmhvdHBsdWcgPSBpbnRlbF9lbmNvZGVyX2hvdHBsdWc7
Cj4gICAJaW50ZWxfZW5jb2Rlci0+Y29tcHV0ZV9jb25maWcgPSBpbnRlbF9oZG1pX2NvbXB1dGVf
Y29uZmlnOwo+IC0JaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSEFTX1BD
SF9TUExJVChpOTE1KSkgewo+ICAgCQlpbnRlbF9lbmNvZGVyLT5kaXNhYmxlID0gcGNoX2Rpc2Fi
bGVfaGRtaTsKPiAgIAkJaW50ZWxfZW5jb2Rlci0+cG9zdF9kaXNhYmxlID0gcGNoX3Bvc3RfZGlz
YWJsZV9oZG1pOwo+ICAgCX0gZWxzZSB7Cj4gQEAgLTMxNTIsMjIgKzMxNTIsMjIgQEAgdm9pZCBp
bnRlbF9oZG1pX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCX0K
PiAgIAlpbnRlbF9lbmNvZGVyLT5nZXRfaHdfc3RhdGUgPSBpbnRlbF9oZG1pX2dldF9od19zdGF0
ZTsKPiAgIAlpbnRlbF9lbmNvZGVyLT5nZXRfY29uZmlnID0gaW50ZWxfaGRtaV9nZXRfY29uZmln
Owo+IC0JaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfQ0hFUlJZVklF
VyhpOTE1KSkgewo+ICAgCQlpbnRlbF9lbmNvZGVyLT5wcmVfcGxsX2VuYWJsZSA9IGNodl9oZG1p
X3ByZV9wbGxfZW5hYmxlOwo+ICAgCQlpbnRlbF9lbmNvZGVyLT5wcmVfZW5hYmxlID0gY2h2X2hk
bWlfcHJlX2VuYWJsZTsKPiAgIAkJaW50ZWxfZW5jb2Rlci0+ZW5hYmxlID0gdmx2X2VuYWJsZV9o
ZG1pOwo+ICAgCQlpbnRlbF9lbmNvZGVyLT5wb3N0X2Rpc2FibGUgPSBjaHZfaGRtaV9wb3N0X2Rp
c2FibGU7Cj4gICAJCWludGVsX2VuY29kZXItPnBvc3RfcGxsX2Rpc2FibGUgPSBjaHZfaGRtaV9w
b3N0X3BsbF9kaXNhYmxlOwo+IC0JfSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkg
ewo+ICsJfSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpKSB7Cj4gICAJCWludGVsX2VuY29k
ZXItPnByZV9wbGxfZW5hYmxlID0gdmx2X2hkbWlfcHJlX3BsbF9lbmFibGU7Cj4gICAJCWludGVs
X2VuY29kZXItPnByZV9lbmFibGUgPSB2bHZfaGRtaV9wcmVfZW5hYmxlOwo+ICAgCQlpbnRlbF9l
bmNvZGVyLT5lbmFibGUgPSB2bHZfZW5hYmxlX2hkbWk7Cj4gICAJCWludGVsX2VuY29kZXItPnBv
c3RfZGlzYWJsZSA9IHZsdl9oZG1pX3Bvc3RfZGlzYWJsZTsKPiAgIAl9IGVsc2Ugewo+ICAgCQlp
bnRlbF9lbmNvZGVyLT5wcmVfZW5hYmxlID0gaW50ZWxfaGRtaV9wcmVfZW5hYmxlOwo+IC0JCWlm
IChIQVNfUENIX0NQVChkZXZfcHJpdikpCj4gKwkJaWYgKEhBU19QQ0hfQ1BUKGk5MTUpKQo+ICAg
CQkJaW50ZWxfZW5jb2Rlci0+ZW5hYmxlID0gY3B0X2VuYWJsZV9oZG1pOwo+IC0JCWVsc2UgaWYg
KEhBU19QQ0hfSUJYKGRldl9wcml2KSkKPiArCQllbHNlIGlmIChIQVNfUENIX0lCWChpOTE1KSkK
PiAgIAkJCWludGVsX2VuY29kZXItPmVuYWJsZSA9IGlieF9lbmFibGVfaGRtaTsKPiAgIAkJZWxz
ZQo+ICAgCQkJaW50ZWxfZW5jb2Rlci0+ZW5hYmxlID0gZzR4X2VuYWJsZV9oZG1pOwo+IEBAIC0z
MTc2LDcgKzMxNzYsNyBAQCB2b2lkIGludGVsX2hkbWlfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gICAJaW50ZWxfZW5jb2Rlci0+dHlwZSA9IElOVEVMX09VVFBVVF9I
RE1JOwo+ICAgCWludGVsX2VuY29kZXItPnBvd2VyX2RvbWFpbiA9IGludGVsX3BvcnRfdG9fcG93
ZXJfZG9tYWluKHBvcnQpOwo+ICAgCWludGVsX2VuY29kZXItPnBvcnQgPSBwb3J0Owo+IC0JaWYg
KElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkg
ewo+ICAgCQlpZiAocG9ydCA9PSBQT1JUX0QpCj4gICAJCQlpbnRlbF9lbmNvZGVyLT5jcnRjX21h
c2sgPSAxIDw8IDI7Cj4gICAJCWVsc2UKPiBAQCAtMzE5MCw3ICszMTkwLDcgQEAgdm9pZCBpbnRl
bF9oZG1pX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCSAqIHRv
IHdvcmsgb24gcmVhbCBoYXJkd2FyZS4gQW5kIHNpbmNlIGc0eCBjYW4gc2VuZCBpbmZvZnJhbWVz
IHRvCj4gICAJICogb25seSBvbmUgcG9ydCBhbnl3YXksIG5vdGhpbmcgaXMgbG9zdCBieSBhbGxv
d2luZyBpdC4KPiAgIAkgKi8KPiAtCWlmIChJU19HNFgoZGV2X3ByaXYpKQo+ICsJaWYgKElTX0c0
WChpOTE1KSkKPiAgIAkJaW50ZWxfZW5jb2Rlci0+Y2xvbmVhYmxlIHw9IDEgPDwgSU5URUxfT1VU
UFVUX0hETUk7Cj4gICAKPiAgIAlpbnRlbF9kaWdfcG9ydC0+aGRtaS5oZG1pX3JlZyA9IGhkbWlf
cmVnOwo+IEBAIC0zMTk5LDYgKzMxOTksNiBAQCB2b2lkIGludGVsX2hkbWlfaW5pdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAKPiAgIAlpbnRlbF9pbmZvZnJhbWVfaW5p
dChpbnRlbF9kaWdfcG9ydCk7Cj4gICAKPiAtCWludGVsX2RpZ19wb3J0LT5hdXhfY2ggPSBpbnRl
bF9iaW9zX3BvcnRfYXV4X2NoKGRldl9wcml2LCBwb3J0KTsKPiArCWludGVsX2RpZ19wb3J0LT5h
dXhfY2ggPSBpbnRlbF9iaW9zX3BvcnRfYXV4X2NoKGk5MTUsIHBvcnQpOwo+ICAgCWludGVsX2hk
bWlfaW5pdF9jb25uZWN0b3IoaW50ZWxfZGlnX3BvcnQsIGludGVsX2Nvbm5lY3Rvcik7Cj4gICB9
Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2hkbWkuaCBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX2hkbWkuaAo+IGluZGV4IDEwNmMyZTBiYzNjOS4uNDZmMDMz
NTZiNTRiIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2hkbWkuaAo+
ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2hkbWkuaAo+IEBAIC0yNCw3ICsyNCw3
IEBAIHN0cnVjdCBpbnRlbF9oZG1pOwo+ICAgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGU7Cj4g
ICB1bmlvbiBoZG1pX2luZm9mcmFtZTsKPiAgIAo+IC12b2lkIGludGVsX2hkbWlfaW5pdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGk5MTVfcmVnX3QgaGRtaV9yZWcsCj4gK3Zv
aWQgaW50ZWxfaGRtaV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBpOTE1X3Jl
Z190IGhkbWlfcmVnLAo+ICAgCQkgICAgIGVudW0gcG9ydCBwb3J0KTsKPiAgIHZvaWQgaW50ZWxf
aGRtaV9pbml0X2Nvbm5lY3RvcihzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdf
cG9ydCwKPiAgIAkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICppbnRlbF9jb25uZWN0
b3IpOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ob3RwbHVnLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ob3RwbHVnLmMKPiBpbmRleCBmZjllYjNjODU1
ZDMuLmE1NTFiOWFiMmUxNyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9ob3RwbHVnLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ob3RwbHVnLmMK
PiBAQCAtNzgsNyArNzgsNyBAQAo+ICAgCj4gICAvKioKPiAgICAqIGludGVsX2hwZF9waW5fZGVm
YXVsdCAtIHJldHVybiBkZWZhdWx0IHBpbiBhc3NvY2lhdGVkIHdpdGggY2VydGFpbiBwb3J0Lgo+
IC0gKiBAZGV2X3ByaXY6IHByaXZhdGUgZHJpdmVyIGRhdGEgcG9pbnRlcgo+ICsgKiBAaTkxNTog
cHJpdmF0ZSBkcml2ZXIgZGF0YSBwb2ludGVyCj4gICAgKiBAcG9ydDogdGhlIGhwZCBwb3J0IHRv
IGdldCBhc3NvY2lhdGVkIHBpbgo+ICAgICoKPiAgICAqIEl0IGlzIG9ubHkgdmFsaWQgYW5kIHVz
ZWQgYnkgZGlnaXRhbCBwb3J0IGVuY29kZXIuCj4gQEAgLTg2LDcgKzg2LDcgQEAKPiAgICAqIFJl
dHVybiBwaW4gdGhhdCBpcyBhc3NvY2lhdGFkZSB3aXRoIEBwb3J0IGFuZCBIRFBfTk9ORSBpZiBu
byBwaW4gaXMKPiAgICAqIGhhcmQgYXNzb2NpYXRlZCB3aXRoIHRoYXQgQHBvcnQuCj4gICAgKi8K
PiAtZW51bSBocGRfcGluIGludGVsX2hwZF9waW5fZGVmYXVsdChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gK2VudW0gaHBkX3BpbiBpbnRlbF9ocGRfcGluX2RlZmF1bHQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgZW51bSBwb3J0IHBvcnQpCj4g
ICB7Cj4gICAJc3dpdGNoIChwb3J0KSB7Cj4gQEAgLTEwMSw3ICsxMDEsNyBAQCBlbnVtIGhwZF9w
aW4gaW50ZWxfaHBkX3Bpbl9kZWZhdWx0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiAgIAljYXNlIFBPUlRfRToKPiAgIAkJcmV0dXJuIEhQRF9QT1JUX0U7Cj4gICAJY2FzZSBQ
T1JUX0Y6Cj4gLQkJaWYgKElTX0NOTF9XSVRIX1BPUlRfRihkZXZfcHJpdikpCj4gKwkJaWYgKElT
X0NOTF9XSVRIX1BPUlRfRihpOTE1KSkKPiAgIAkJCXJldHVybiBIUERfUE9SVF9FOwo+ICAgCQly
ZXR1cm4gSFBEX1BPUlRfRjsKPiAgIAlkZWZhdWx0Ogo+IEBAIC0xMTUsNyArMTE1LDcgQEAgZW51
bSBocGRfcGluIGludGVsX2hwZF9waW5fZGVmYXVsdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxfaHBkX2lycV9zdG9ybV9kZXRlY3Qg
LSBnYXRoZXIgc3RhdHMgYW5kIGRldGVjdCBIUEQgSVJRIHN0b3JtIG9uIGEgcGluCj4gLSAqIEBk
ZXZfcHJpdjogcHJpdmF0ZSBkcml2ZXIgZGF0YSBwb2ludGVyCj4gKyAqIEBpOTE1OiBwcml2YXRl
IGRyaXZlciBkYXRhIHBvaW50ZXIKPiAgICAqIEBwaW46IHRoZSBwaW4gdG8gZ2F0aGVyIHN0YXRz
IG9uCj4gICAgKiBAbG9uZ19ocGQ6IHdoZXRoZXIgdGhlIEhQRCBJUlEgd2FzIGxvbmcgb3Igc2hv
cnQKPiAgICAqCj4gQEAgLTEyNCwxMyArMTI0LDEzIEBAIGVudW0gaHBkX3BpbiBpbnRlbF9ocGRf
cGluX2RlZmF1bHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgICogcmVz
cG9uc2libGUgZm9yIGZ1cnRoZXIgYWN0aW9uLgo+ICAgICoKPiAgICAqIFRoZSBudW1iZXIgb2Yg
SVJRcyB0aGF0IGFyZSBhbGxvd2VkIHdpdGhpbiBASFBEX1NUT1JNX0RFVEVDVF9QRVJJT0QgaXMK
PiAtICogc3RvcmVkIGluIEBkZXZfcHJpdi0+aG90cGx1Zy5ocGRfc3Rvcm1fdGhyZXNob2xkIHdo
aWNoIGRlZmF1bHRzIHRvCj4gKyAqIHN0b3JlZCBpbiBAaTkxNS0+aG90cGx1Zy5ocGRfc3Rvcm1f
dGhyZXNob2xkIHdoaWNoIGRlZmF1bHRzIHRvCj4gICAgKiBASFBEX1NUT1JNX0RFRkFVTFRfVEhS
RVNIT0xELiBMb25nIElSUXMgY291bnQgYXMgKzEwIHRvIHRoaXMgdGhyZXNob2xkLCBhbmQKPiAg
ICAqIHNob3J0IElSUXMgY291bnQgYXMgKzEuIElmIHRoaXMgdGhyZXNob2xkIGlzIGV4Y2VlZGVk
LCBpdCdzIGNvbnNpZGVyZWQgYW4KPiAgICAqIElSUSBzdG9ybSBhbmQgdGhlIElSUSBzdGF0ZSBp
cyBzZXQgdG8gQEhQRF9NQVJLX0RJU0FCTEVELgo+ICAgICoKPiAgICAqIEJ5IGRlZmF1bHQsIG1v
c3Qgc3lzdGVtcyB3aWxsIG9ubHkgY291bnQgbG9uZyBJUlFzIHRvd2FyZHMKPiAtICogJmRldl9w
cml2LT5ob3RwbHVnLmhwZF9zdG9ybV90aHJlc2hvbGQuIEhvd2V2ZXIsIHNvbWUgb2xkZXIgc3lz
dGVtcyBhbHNvCj4gKyAqICZpOTE1LT5ob3RwbHVnLmhwZF9zdG9ybV90aHJlc2hvbGQuIEhvd2V2
ZXIsIHNvbWUgb2xkZXIgc3lzdGVtcyBhbHNvCj4gICAgKiBzdWZmZXIgZnJvbSBzaG9ydCBJUlEg
c3Rvcm1zIGFuZCBtdXN0IGFsc28gdHJhY2sgdGhlc2UuIEJlY2F1c2Ugc2hvcnQgSVJRCj4gICAg
KiBzdG9ybXMgYXJlIG5hdHVyYWxseSBjYXVzZWQgYnkgc2lkZWJhbmQgaW50ZXJhY3Rpb25zIHdp
dGggRFAgTVNUIGRldmljZXMsCj4gICAgKiBzaG9ydCBJUlEgZGV0ZWN0aW9uIGlzIG9ubHkgZW5h
YmxlZCBmb3Igc3lzdGVtcyB3aXRob3V0IERQIE1TVCBzdXBwb3J0Lgo+IEBAIC0xNDIsMTAgKzE0
MiwxMCBAQCBlbnVtIGhwZF9waW4gaW50ZWxfaHBkX3Bpbl9kZWZhdWx0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiAgICAqCj4gICAgKiBSZXR1cm4gdHJ1ZSBpZiBhbiBJUlEg
c3Rvcm0gd2FzIGRldGVjdGVkIG9uIEBwaW4uCj4gICAgKi8KPiAtc3RhdGljIGJvb2wgaW50ZWxf
aHBkX2lycV9zdG9ybV9kZXRlY3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICtzdGF0aWMgYm9vbCBpbnRlbF9ocGRfaXJxX3N0b3JtX2RldGVjdChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAgICAgZW51bSBocGRfcGluIHBpbiwgYm9vbCBsb25n
X2hwZCkKPiAgIHsKPiAtCXN0cnVjdCBpOTE1X2hvdHBsdWcgKmhwZCA9ICZkZXZfcHJpdi0+aG90
cGx1ZzsKPiArCXN0cnVjdCBpOTE1X2hvdHBsdWcgKmhwZCA9ICZpOTE1LT5ob3RwbHVnOwo+ICAg
CXVuc2lnbmVkIGxvbmcgc3RhcnQgPSBocGQtPnN0YXRzW3Bpbl0ubGFzdF9qaWZmaWVzOwo+ICAg
CXVuc2lnbmVkIGxvbmcgZW5kID0gc3RhcnQgKyBtc2Vjc190b19qaWZmaWVzKEhQRF9TVE9STV9E
RVRFQ1RfUEVSSU9EKTsKPiAgIAljb25zdCBpbnQgaW5jcmVtZW50ID0gbG9uZ19ocGQgPyAxMCA6
IDE7Cj4gQEAgLTE1Myw3ICsxNTMsNyBAQCBzdGF0aWMgYm9vbCBpbnRlbF9ocGRfaXJxX3N0b3Jt
X2RldGVjdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJYm9vbCBzdG9y
bSA9IGZhbHNlOwo+ICAgCj4gICAJaWYgKCF0aHJlc2hvbGQgfHwKPiAtCSAgICAoIWxvbmdfaHBk
ICYmICFkZXZfcHJpdi0+aG90cGx1Zy5ocGRfc2hvcnRfc3Rvcm1fZW5hYmxlZCkpCj4gKwkgICAg
KCFsb25nX2hwZCAmJiAhaTkxNS0+aG90cGx1Zy5ocGRfc2hvcnRfc3Rvcm1fZW5hYmxlZCkpCj4g
ICAJCXJldHVybiBmYWxzZTsKPiAgIAo+ICAgCWlmICghdGltZV9pbl9yYW5nZShqaWZmaWVzLCBz
dGFydCwgZW5kKSkgewo+IEBAIC0xNzUsOSArMTc1LDkgQEAgc3RhdGljIGJvb2wgaW50ZWxfaHBk
X2lycV9zdG9ybV9kZXRlY3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAg
fQo+ICAgCj4gICBzdGF0aWMgdm9pZAo+IC1pbnRlbF9ocGRfaXJxX3N0b3JtX3N3aXRjaF90b19w
b2xsaW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAraW50ZWxfaHBkX2ly
cV9zdG9ybV9zd2l0Y2hfdG9fcG9sbGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiAgIHsKPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKPiArCXN0
cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+ICAgCXN0cnVjdCBpbnRlbF9jb25u
ZWN0b3IgKmludGVsX2Nvbm5lY3RvcjsKPiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqaW50ZWxf
ZW5jb2RlcjsKPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yOwo+IEBAIC0xODUs
NyArMTg1LDcgQEAgaW50ZWxfaHBkX2lycV9zdG9ybV9zd2l0Y2hfdG9fcG9sbGluZyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJZW51bSBocGRfcGluIHBpbjsKPiAgIAli
b29sIGhwZF9kaXNhYmxlZCA9IGZhbHNlOwo+ICAgCj4gLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZk
ZXZfcHJpdi0+aXJxX2xvY2spOwo+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+aXJxX2xv
Y2spOwo+ICAgCj4gICAJZHJtX2Nvbm5lY3Rvcl9saXN0X2l0ZXJfYmVnaW4oZGV2LCAmY29ubl9p
dGVyKTsKPiAgIAlkcm1fZm9yX2VhY2hfY29ubmVjdG9yX2l0ZXIoY29ubmVjdG9yLCAmY29ubl9p
dGVyKSB7Cj4gQEAgLTE5OSwxNCArMTk5LDE0IEBAIGludGVsX2hwZF9pcnFfc3Rvcm1fc3dpdGNo
X3RvX3BvbGxpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCj4gICAJ
CXBpbiA9IGludGVsX2VuY29kZXItPmhwZF9waW47Cj4gICAJCWlmIChwaW4gPT0gSFBEX05PTkUg
fHwKPiAtCQkgICAgZGV2X3ByaXYtPmhvdHBsdWcuc3RhdHNbcGluXS5zdGF0ZSAhPSBIUERfTUFS
S19ESVNBQkxFRCkKPiArCQkgICAgaTkxNS0+aG90cGx1Zy5zdGF0c1twaW5dLnN0YXRlICE9IEhQ
RF9NQVJLX0RJU0FCTEVEKQo+ICAgCQkJY29udGludWU7Cj4gICAKPiAgIAkJRFJNX0lORk8oIkhQ
RCBpbnRlcnJ1cHQgc3Rvcm0gZGV0ZWN0ZWQgb24gY29ubmVjdG9yICVzOiAiCj4gICAJCQkgInN3
aXRjaGluZyBmcm9tIGhvdHBsdWcgZGV0ZWN0aW9uIHRvIHBvbGxpbmdcbiIsCj4gICAJCQkgY29u
bmVjdG9yLT5uYW1lKTsKPiAgIAo+IC0JCWRldl9wcml2LT5ob3RwbHVnLnN0YXRzW3Bpbl0uc3Rh
dGUgPSBIUERfRElTQUJMRUQ7Cj4gKwkJaTkxNS0+aG90cGx1Zy5zdGF0c1twaW5dLnN0YXRlID0g
SFBEX0RJU0FCTEVEOwo+ICAgCQljb25uZWN0b3ItPnBvbGxlZCA9IERSTV9DT05ORUNUT1JfUE9M
TF9DT05ORUNUCj4gICAJCQl8IERSTV9DT05ORUNUT1JfUE9MTF9ESVNDT05ORUNUOwo+ICAgCQlo
cGRfZGlzYWJsZWQgPSB0cnVlOwo+IEBAIC0yMTYsMzEgKzIxNiwzMSBAQCBpbnRlbF9ocGRfaXJx
X3N0b3JtX3N3aXRjaF90b19wb2xsaW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiAgIAkvKiBFbmFibGUgcG9sbGluZyBhbmQgcXVldWUgaG90cGx1ZyByZS1lbmFibGluZy4g
Ki8KPiAgIAlpZiAoaHBkX2Rpc2FibGVkKSB7Cj4gICAJCWRybV9rbXNfaGVscGVyX3BvbGxfZW5h
YmxlKGRldik7Cj4gLQkJbW9kX2RlbGF5ZWRfd29yayhzeXN0ZW1fd3EsICZkZXZfcHJpdi0+aG90
cGx1Zy5yZWVuYWJsZV93b3JrLAo+ICsJCW1vZF9kZWxheWVkX3dvcmsoc3lzdGVtX3dxLCAmaTkx
NS0+aG90cGx1Zy5yZWVuYWJsZV93b3JrLAo+ICAgCQkJCSBtc2Vjc190b19qaWZmaWVzKEhQRF9T
VE9STV9SRUVOQUJMRV9ERUxBWSkpOwo+ICAgCX0KPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQg
aW50ZWxfaHBkX2lycV9zdG9ybV9yZWVuYWJsZV93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29y
aykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9Cj4gLQkJY29u
dGFpbmVyX29mKHdvcmssIHR5cGVvZigqZGV2X3ByaXYpLAo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPQo+ICsJCWNvbnRhaW5lcl9vZih3b3JrLCB0eXBlb2YoKmk5MTUpLAo+ICAg
CQkJICAgICBob3RwbHVnLnJlZW5hYmxlX3dvcmsud29yayk7Cj4gLQlzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2ID0gJmRldl9wcml2LT5kcm07Cj4gKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmk5
MTUtPmRybTsKPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiAgIAllbnVtIGhwZF9waW4g
cGluOwo+ICAgCj4gLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOwo+
ICsJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOwo+ICAgCj4gLQlzcGluX2xv
Y2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ICsJc3Bpbl9sb2NrX2lycSgmaTkxNS0+aXJx
X2xvY2spOwo+ICAgCWZvcl9lYWNoX2hwZF9waW4ocGluKSB7Cj4gICAJCXN0cnVjdCBkcm1fY29u
bmVjdG9yICpjb25uZWN0b3I7Cj4gICAJCXN0cnVjdCBkcm1fY29ubmVjdG9yX2xpc3RfaXRlciBj
b25uX2l0ZXI7Cj4gICAKPiAtCQlpZiAoZGV2X3ByaXYtPmhvdHBsdWcuc3RhdHNbcGluXS5zdGF0
ZSAhPSBIUERfRElTQUJMRUQpCj4gKwkJaWYgKGk5MTUtPmhvdHBsdWcuc3RhdHNbcGluXS5zdGF0
ZSAhPSBIUERfRElTQUJMRUQpCj4gICAJCQljb250aW51ZTsKPiAgIAo+IC0JCWRldl9wcml2LT5o
b3RwbHVnLnN0YXRzW3Bpbl0uc3RhdGUgPSBIUERfRU5BQkxFRDsKPiArCQlpOTE1LT5ob3RwbHVn
LnN0YXRzW3Bpbl0uc3RhdGUgPSBIUERfRU5BQkxFRDsKPiAgIAo+ICAgCQlkcm1fY29ubmVjdG9y
X2xpc3RfaXRlcl9iZWdpbihkZXYsICZjb25uX2l0ZXIpOwo+ICAgCQlkcm1fZm9yX2VhY2hfY29u
bmVjdG9yX2l0ZXIoY29ubmVjdG9yLCAmY29ubl9pdGVyKSB7Cj4gQEAgLTI1OSwxMSArMjU5LDEx
IEBAIHN0YXRpYyB2b2lkIGludGVsX2hwZF9pcnFfc3Rvcm1fcmVlbmFibGVfd29yayhzdHJ1Y3Qg
d29ya19zdHJ1Y3QgKndvcmspCj4gICAJCX0KPiAgIAkJZHJtX2Nvbm5lY3Rvcl9saXN0X2l0ZXJf
ZW5kKCZjb25uX2l0ZXIpOwo+ICAgCX0KPiAtCWlmIChkZXZfcHJpdi0+ZGlzcGxheV9pcnFzX2Vu
YWJsZWQgJiYgZGV2X3ByaXYtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCkKPiAtCQlkZXZfcHJpdi0+
ZGlzcGxheS5ocGRfaXJxX3NldHVwKGRldl9wcml2KTsKPiAtCXNwaW5fdW5sb2NrX2lycSgmZGV2
X3ByaXYtPmlycV9sb2NrKTsKPiArCWlmIChpOTE1LT5kaXNwbGF5X2lycXNfZW5hYmxlZCAmJiBp
OTE1LT5kaXNwbGF5LmhwZF9pcnFfc2V0dXApCj4gKwkJaTkxNS0+ZGlzcGxheS5ocGRfaXJxX3Nl
dHVwKGk5MTUpOwo+ICsJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gICAKPiAt
CWludGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKPiArCWludGVsX3J1bnRp
bWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOwo+ICAgfQo+ICAgCj4gICBib29sIGludGVsX2VuY29k
ZXJfaG90cGx1ZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiBAQCAtMjk4LDIwICsy
OTgsMjAgQEAgc3RhdGljIGJvb2wgaW50ZWxfZW5jb2Rlcl9oYXNfaHBkX3B1bHNlKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ICAgCj4gICBzdGF0aWMgdm9pZCBpOTE1X2RpZ3BvcnRf
d29ya19mdW5jKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiAgIHsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9Cj4gICAJCWNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSwgaG90
cGx1Zy5kaWdfcG9ydF93b3JrKTsKPiAgIAl1MzIgbG9uZ19wb3J0X21hc2ssIHNob3J0X3BvcnRf
bWFzazsKPiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcjsKPiAgIAl1MzIgb2xkX2Jp
dHMgPSAwOwo+ICAgCj4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+IC0J
bG9uZ19wb3J0X21hc2sgPSBkZXZfcHJpdi0+aG90cGx1Zy5sb25nX3BvcnRfbWFzazsKPiAtCWRl
dl9wcml2LT5ob3RwbHVnLmxvbmdfcG9ydF9tYXNrID0gMDsKPiAtCXNob3J0X3BvcnRfbWFzayA9
IGRldl9wcml2LT5ob3RwbHVnLnNob3J0X3BvcnRfbWFzazsKPiAtCWRldl9wcml2LT5ob3RwbHVn
LnNob3J0X3BvcnRfbWFzayA9IDA7Cj4gLQlzcGluX3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFf
bG9jayk7Cj4gKwlzcGluX2xvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gKwlsb25nX3BvcnRf
bWFzayA9IGk5MTUtPmhvdHBsdWcubG9uZ19wb3J0X21hc2s7Cj4gKwlpOTE1LT5ob3RwbHVnLmxv
bmdfcG9ydF9tYXNrID0gMDsKPiArCXNob3J0X3BvcnRfbWFzayA9IGk5MTUtPmhvdHBsdWcuc2hv
cnRfcG9ydF9tYXNrOwo+ICsJaTkxNS0+aG90cGx1Zy5zaG9ydF9wb3J0X21hc2sgPSAwOwo+ICsJ
c3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gICAKPiAtCWZvcl9lYWNoX2ludGVs
X2VuY29kZXIoJmRldl9wcml2LT5kcm0sIGVuY29kZXIpIHsKPiArCWZvcl9lYWNoX2ludGVsX2Vu
Y29kZXIoJmk5MTUtPmRybSwgZW5jb2Rlcikgewo+ICAgCQlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9w
b3J0ICpkaWdfcG9ydDsKPiAgIAkJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+ICAg
CQlib29sIGxvbmdfaHBkLCBzaG9ydF9ocGQ7Cj4gQEAgLTMzNiwxMCArMzM2LDEwIEBAIHN0YXRp
YyB2b2lkIGk5MTVfZGlncG9ydF93b3JrX2Z1bmMoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+
ICAgCX0KPiAgIAo+ICAgCWlmIChvbGRfYml0cykgewo+IC0JCXNwaW5fbG9ja19pcnEoJmRldl9w
cml2LT5pcnFfbG9jayk7Cj4gLQkJZGV2X3ByaXYtPmhvdHBsdWcuZXZlbnRfYml0cyB8PSBvbGRf
Yml0czsKPiAtCQlzcGluX3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gLQkJc2No
ZWR1bGVfd29yaygmZGV2X3ByaXYtPmhvdHBsdWcuaG90cGx1Z193b3JrKTsKPiArCQlzcGluX2xv
Y2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gKwkJaTkxNS0+aG90cGx1Zy5ldmVudF9iaXRzIHw9
IG9sZF9iaXRzOwo+ICsJCXNwaW5fdW5sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ICsJCXNj
aGVkdWxlX3dvcmsoJmk5MTUtPmhvdHBsdWcuaG90cGx1Z193b3JrKTsKPiAgIAl9Cj4gICB9Cj4g
ICAKPiBAQCAtMzQ4LDkgKzM0OCw5IEBAIHN0YXRpYyB2b2lkIGk5MTVfZGlncG9ydF93b3JrX2Z1
bmMoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAgICovCj4gICBzdGF0aWMgdm9pZCBpOTE1
X2hvdHBsdWdfd29ya19mdW5jKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiAgIHsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9Cj4gICAJCWNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSwgaG90cGx1Zy5ob3RwbHVnX3dvcmspOwo+IC0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9
ICZkZXZfcHJpdi0+ZHJtOwo+ICsJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZpOTE1LT5kcm07
Cj4gICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqaW50ZWxfY29ubmVjdG9yOwo+ICAgCXN0cnVj
dCBpbnRlbF9lbmNvZGVyICppbnRlbF9lbmNvZGVyOwo+ICAgCXN0cnVjdCBkcm1fY29ubmVjdG9y
ICpjb25uZWN0b3I7Cj4gQEAgLTM2MSwxNSArMzYxLDE1IEBAIHN0YXRpYyB2b2lkIGk5MTVfaG90
cGx1Z193b3JrX2Z1bmMoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAgCW11dGV4X2xvY2so
JmRldi0+bW9kZV9jb25maWcubXV0ZXgpOwo+ICAgCURSTV9ERUJVR19LTVMoInJ1bm5pbmcgZW5j
b2RlciBob3RwbHVnIGZ1bmN0aW9uc1xuIik7Cj4gICAKPiAtCXNwaW5fbG9ja19pcnEoJmRldl9w
cml2LT5pcnFfbG9jayk7Cj4gKwlzcGluX2xvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gICAK
PiAtCWhwZF9ldmVudF9iaXRzID0gZGV2X3ByaXYtPmhvdHBsdWcuZXZlbnRfYml0czsKPiAtCWRl
dl9wcml2LT5ob3RwbHVnLmV2ZW50X2JpdHMgPSAwOwo+ICsJaHBkX2V2ZW50X2JpdHMgPSBpOTE1
LT5ob3RwbHVnLmV2ZW50X2JpdHM7Cj4gKwlpOTE1LT5ob3RwbHVnLmV2ZW50X2JpdHMgPSAwOwo+
ICAgCj4gICAJLyogRW5hYmxlIHBvbGxpbmcgZm9yIGNvbm5lY3RvcnMgd2hpY2ggaGFkIEhQRCBJ
UlEgc3Rvcm1zICovCj4gLQlpbnRlbF9ocGRfaXJxX3N0b3JtX3N3aXRjaF90b19wb2xsaW5nKGRl
dl9wcml2KTsKPiArCWludGVsX2hwZF9pcnFfc3Rvcm1fc3dpdGNoX3RvX3BvbGxpbmcoaTkxNSk7
Cj4gICAKPiAtCXNwaW5fdW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiArCXNwaW5f
dW5sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ICAgCj4gICAJZHJtX2Nvbm5lY3Rvcl9saXN0
X2l0ZXJfYmVnaW4oZGV2LCAmY29ubl9pdGVyKTsKPiAgIAlkcm1fZm9yX2VhY2hfY29ubmVjdG9y
X2l0ZXIoY29ubmVjdG9yLCAmY29ubl9pdGVyKSB7Cj4gQEAgLTM5NSw3ICszOTUsNyBAQCBzdGF0
aWMgdm9pZCBpOTE1X2hvdHBsdWdfd29ya19mdW5jKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykK
PiAgIAo+ICAgLyoqCj4gICAgKiBpbnRlbF9ocGRfaXJxX2hhbmRsZXIgLSBtYWluIGhvdHBsdWcg
aXJxIGhhbmRsZXIKPiAtICogQGRldl9wcml2OiBkcm1faTkxNV9wcml2YXRlCj4gKyAqIEBpOTE1
OiBkcm1faTkxNV9wcml2YXRlCj4gICAgKiBAcGluX21hc2s6IGEgbWFzayBvZiBocGQgcGlucyB0
aGF0IGhhdmUgdHJpZ2dlcmVkIHRoZSBpcnEKPiAgICAqIEBsb25nX21hc2s6IGEgbWFzayBvZiBo
cGQgcGlucyB0aGF0IG1heSBiZSBsb25nIGhwZCBwdWxzZXMKPiAgICAqCj4gQEAgLTQwOSw3ICs0
MDksNyBAQCBzdGF0aWMgdm9pZCBpOTE1X2hvdHBsdWdfd29ya19mdW5jKHN0cnVjdCB3b3JrX3N0
cnVjdCAqd29yaykKPiAgICAqIEhlcmUsIHdlIGRvIGhvdHBsdWcgaXJxIHN0b3JtIGRldGVjdGlv
biBhbmQgbWl0aWdhdGlvbiwgYW5kIHBhc3MgZnVydGhlcgo+ICAgICogcHJvY2Vzc2luZyB0byBh
cHByb3ByaWF0ZSBib3R0b20gaGFsdmVzLgo+ICAgICovCj4gLXZvaWQgaW50ZWxfaHBkX2lycV9o
YW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArdm9pZCBpbnRlbF9o
cGRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICB1
MzIgcGluX21hc2ssIHUzMiBsb25nX21hc2spCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXI7Cj4gQEAgLTQyMiw3ICs0MjIsNyBAQCB2b2lkIGludGVsX2hwZF9pcnFfaGFu
ZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJaWYgKCFwaW5fbWFz
aykKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQlzcGluX2xvY2soJmRldl9wcml2LT5pcnFfbG9jayk7
Cj4gKwlzcGluX2xvY2soJmk5MTUtPmlycV9sb2NrKTsKPiAgIAo+ICAgCS8qCj4gICAJICogRGV0
ZXJtaW5lIHdoZXRoZXIgLT5ocGRfcHVsc2UoKSBleGlzdHMgZm9yIGVhY2ggcGluLCBhbmQKPiBA
QCAtNDMwLDcgKzQzMCw3IEBAIHZvaWQgaW50ZWxfaHBkX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkgKiBhcyBlYWNoIHBpbiBtYXkgaGF2ZSB1cCB0
byB0d28gZW5jb2RlcnMgKEhETUkgYW5kIERQKSBhbmQKPiAgIAkgKiBvbmx5IHRoZSBvbmUgb2Yg
dGhlbSAoRFApIHdpbGwgaGF2ZSAtPmhwZF9wdWxzZSgpLgo+ICAgCSAqLwo+IC0JZm9yX2VhY2hf
aW50ZWxfZW5jb2RlcigmZGV2X3ByaXYtPmRybSwgZW5jb2Rlcikgewo+ICsJZm9yX2VhY2hfaW50
ZWxfZW5jb2RlcigmaTkxNS0+ZHJtLCBlbmNvZGVyKSB7Cj4gICAJCWJvb2wgaGFzX2hwZF9wdWxz
ZSA9IGludGVsX2VuY29kZXJfaGFzX2hwZF9wdWxzZShlbmNvZGVyKTsKPiAgIAkJZW51bSBwb3J0
IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+ICAgCQlib29sIGxvbmdfaHBkOwo+IEBAIC00NTAsMTAg
KzQ1MCwxMCBAQCB2b2lkIGludGVsX2hwZF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gICAKPiAgIAkJaWYgKGxvbmdfaHBkKSB7Cj4gICAJCQlsb25nX2hw
ZF9wdWxzZV9tYXNrIHw9IEJJVChwaW4pOwo+IC0JCQlkZXZfcHJpdi0+aG90cGx1Zy5sb25nX3Bv
cnRfbWFzayB8PSBCSVQocG9ydCk7Cj4gKwkJCWk5MTUtPmhvdHBsdWcubG9uZ19wb3J0X21hc2sg
fD0gQklUKHBvcnQpOwo+ICAgCQl9IGVsc2Ugewo+ICAgCQkJc2hvcnRfaHBkX3B1bHNlX21hc2sg
fD0gQklUKHBpbik7Cj4gLQkJCWRldl9wcml2LT5ob3RwbHVnLnNob3J0X3BvcnRfbWFzayB8PSBC
SVQocG9ydCk7Cj4gKwkJCWk5MTUtPmhvdHBsdWcuc2hvcnRfcG9ydF9tYXNrIHw9IEJJVChwb3J0
KTsKPiAgIAkJfQo+ICAgCX0KPiAgIAo+IEBAIC00NjQsMTkgKzQ2NCwxOSBAQCB2b2lkIGludGVs
X2hwZF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJ
CWlmICghKEJJVChwaW4pICYgcGluX21hc2spKQo+ICAgCQkJY29udGludWU7Cj4gICAKPiAtCQlp
ZiAoZGV2X3ByaXYtPmhvdHBsdWcuc3RhdHNbcGluXS5zdGF0ZSA9PSBIUERfRElTQUJMRUQpIHsK
PiArCQlpZiAoaTkxNS0+aG90cGx1Zy5zdGF0c1twaW5dLnN0YXRlID09IEhQRF9ESVNBQkxFRCkg
ewo+ICAgCQkJLyoKPiAgIAkJCSAqIE9uIEdNQ0ggcGxhdGZvcm1zIHRoZSBpbnRlcnJ1cHQgbWFz
ayBiaXRzIG9ubHkKPiAgIAkJCSAqIHByZXZlbnQgaXJxIGdlbmVyYXRpb24sIG5vdCB0aGUgc2V0
dGluZyBvZiB0aGUKPiAgIAkJCSAqIGhvdHBsdWcgYml0cyBpdHNlbGYuIFNvIG9ubHkgV0FSTiBh
Ym91dCB1bmV4cGVjdGVkCj4gICAJCQkgKiBpbnRlcnJ1cHRzIG9uIHNhbmVyIHBsYXRmb3Jtcy4K
PiAgIAkJCSAqLwo+IC0JCQlXQVJOX09OQ0UoIUhBU19HTUNIKGRldl9wcml2KSwKPiArCQkJV0FS
Tl9PTkNFKCFIQVNfR01DSChpOTE1KSwKPiAgIAkJCQkgICJSZWNlaXZlZCBIUEQgaW50ZXJydXB0
IG9uIHBpbiAlZCBhbHRob3VnaCBkaXNhYmxlZFxuIiwgcGluKTsKPiAgIAkJCWNvbnRpbnVlOwo+
ICAgCQl9Cj4gICAKPiAtCQlpZiAoZGV2X3ByaXYtPmhvdHBsdWcuc3RhdHNbcGluXS5zdGF0ZSAh
PSBIUERfRU5BQkxFRCkKPiArCQlpZiAoaTkxNS0+aG90cGx1Zy5zdGF0c1twaW5dLnN0YXRlICE9
IEhQRF9FTkFCTEVEKQo+ICAgCQkJY29udGludWU7Cj4gICAKPiAgIAkJLyoKPiBAQCAtNDg3LDEz
ICs0ODcsMTMgQEAgdm9pZCBpbnRlbF9ocGRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ICAgCQlpZiAoKChzaG9ydF9ocGRfcHVsc2VfbWFzayB8IGxvbmdf
aHBkX3B1bHNlX21hc2spICYgQklUKHBpbikpKSB7Cj4gICAJCQlsb25nX2hwZCA9IGxvbmdfaHBk
X3B1bHNlX21hc2sgJiBCSVQocGluKTsKPiAgIAkJfSBlbHNlIHsKPiAtCQkJZGV2X3ByaXYtPmhv
dHBsdWcuZXZlbnRfYml0cyB8PSBCSVQocGluKTsKPiArCQkJaTkxNS0+aG90cGx1Zy5ldmVudF9i
aXRzIHw9IEJJVChwaW4pOwo+ICAgCQkJbG9uZ19ocGQgPSB0cnVlOwo+ICAgCQkJcXVldWVfaHAg
PSB0cnVlOwo+ICAgCQl9Cj4gICAKPiAtCQlpZiAoaW50ZWxfaHBkX2lycV9zdG9ybV9kZXRlY3Qo
ZGV2X3ByaXYsIHBpbiwgbG9uZ19ocGQpKSB7Cj4gLQkJCWRldl9wcml2LT5ob3RwbHVnLmV2ZW50
X2JpdHMgJj0gfkJJVChwaW4pOwo+ICsJCWlmIChpbnRlbF9ocGRfaXJxX3N0b3JtX2RldGVjdChp
OTE1LCBwaW4sIGxvbmdfaHBkKSkgewo+ICsJCQlpOTE1LT5ob3RwbHVnLmV2ZW50X2JpdHMgJj0g
fkJJVChwaW4pOwo+ICAgCQkJc3Rvcm1fZGV0ZWN0ZWQgPSB0cnVlOwo+ICAgCQkJcXVldWVfaHAg
PSB0cnVlOwo+ICAgCQl9Cj4gQEAgLTUwMyw5ICs1MDMsOSBAQCB2b2lkIGludGVsX2hwZF9pcnFf
aGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJICogRGlzYWJs
ZSBhbnkgSVJRcyB0aGF0IHN0b3JtcyB3ZXJlIGRldGVjdGVkIG9uLiBQb2xsaW5nIGVuYWJsZW1l
bnQKPiAgIAkgKiBoYXBwZW5zIGxhdGVyIGluIG91ciBob3RwbHVnIHdvcmsuCj4gICAJICovCj4g
LQlpZiAoc3Rvcm1fZGV0ZWN0ZWQgJiYgZGV2X3ByaXYtPmRpc3BsYXlfaXJxc19lbmFibGVkKQo+
IC0JCWRldl9wcml2LT5kaXNwbGF5LmhwZF9pcnFfc2V0dXAoZGV2X3ByaXYpOwo+IC0Jc3Bpbl91
bmxvY2soJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gKwlpZiAoc3Rvcm1fZGV0ZWN0ZWQgJiYgaTkx
NS0+ZGlzcGxheV9pcnFzX2VuYWJsZWQpCj4gKwkJaTkxNS0+ZGlzcGxheS5ocGRfaXJxX3NldHVw
KGk5MTUpOwo+ICsJc3Bpbl91bmxvY2soJmk5MTUtPmlycV9sb2NrKTsKPiAgIAo+ICAgCS8qCj4g
ICAJICogT3VyIGhvdHBsdWcgaGFuZGxlciBjYW4gZ3JhYiBtb2Rlc2V0IGxvY2tzIChieSBjYWxs
aW5nIGRvd24gaW50byB0aGUKPiBAQCAtNTE0LDE0ICs1MTQsMTQgQEAgdm9pZCBpbnRlbF9ocGRf
aXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCSAqIGRl
YWRsb2NrLgo+ICAgCSAqLwo+ICAgCWlmIChxdWV1ZV9kaWcpCj4gLQkJcXVldWVfd29yayhkZXZf
cHJpdi0+aG90cGx1Zy5kcF93cSwgJmRldl9wcml2LT5ob3RwbHVnLmRpZ19wb3J0X3dvcmspOwo+
ICsJCXF1ZXVlX3dvcmsoaTkxNS0+aG90cGx1Zy5kcF93cSwgJmk5MTUtPmhvdHBsdWcuZGlnX3Bv
cnRfd29yayk7Cj4gICAJaWYgKHF1ZXVlX2hwKQo+IC0JCXNjaGVkdWxlX3dvcmsoJmRldl9wcml2
LT5ob3RwbHVnLmhvdHBsdWdfd29yayk7Cj4gKwkJc2NoZWR1bGVfd29yaygmaTkxNS0+aG90cGx1
Zy5ob3RwbHVnX3dvcmspOwo+ICAgfQo+ICAgCj4gICAvKioKPiAgICAqIGludGVsX2hwZF9pbml0
IC0gaW5pdGlhbGl6ZXMgYW5kIGVuYWJsZXMgaHBkIHN1cHBvcnQKPiAtICogQGRldl9wcml2OiBp
OTE1IGRldmljZSBpbnN0YW5jZQo+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiAg
ICAqCj4gICAgKiBUaGlzIGZ1bmN0aW9uIGVuYWJsZXMgdGhlIGhvdHBsdWcgc3VwcG9ydC4gSXQg
cmVxdWlyZXMgdGhhdCBpbnRlcnJ1cHRzIGhhdmUKPiAgICAqIGFscmVhZHkgYmVlbiBlbmFibGVk
IHdpdGggaW50ZWxfaXJxX2luaXRfaHcoKS4gRnJvbSB0aGlzIHBvaW50IG9uIGhvdHBsdWcgYW5k
Cj4gQEAgLTUzMyw0MyArNTMzLDQzIEBAIHZvaWQgaW50ZWxfaHBkX2lycV9oYW5kbGVyKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgICAqCj4gICAgKiBBbHNvIHNlZTogaW50
ZWxfaHBkX3BvbGxfaW5pdCgpLCB3aGljaCBlbmFibGVzIGNvbm5lY3RvciBwb2xsaW5nCj4gICAg
Ki8KPiAtdm9pZCBpbnRlbF9ocGRfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gK3ZvaWQgaW50ZWxfaHBkX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gICB7Cj4gICAJaW50IGk7Cj4gICAKPiAgIAlmb3JfZWFjaF9ocGRfcGluKGkpIHsKPiAtCQlk
ZXZfcHJpdi0+aG90cGx1Zy5zdGF0c1tpXS5jb3VudCA9IDA7Cj4gLQkJZGV2X3ByaXYtPmhvdHBs
dWcuc3RhdHNbaV0uc3RhdGUgPSBIUERfRU5BQkxFRDsKPiArCQlpOTE1LT5ob3RwbHVnLnN0YXRz
W2ldLmNvdW50ID0gMDsKPiArCQlpOTE1LT5ob3RwbHVnLnN0YXRzW2ldLnN0YXRlID0gSFBEX0VO
QUJMRUQ7Cj4gICAJfQo+ICAgCj4gLQlXUklURV9PTkNFKGRldl9wcml2LT5ob3RwbHVnLnBvbGxf
ZW5hYmxlZCwgZmFsc2UpOwo+IC0Jc2NoZWR1bGVfd29yaygmZGV2X3ByaXYtPmhvdHBsdWcucG9s
bF9pbml0X3dvcmspOwo+ICsJV1JJVEVfT05DRShpOTE1LT5ob3RwbHVnLnBvbGxfZW5hYmxlZCwg
ZmFsc2UpOwo+ICsJc2NoZWR1bGVfd29yaygmaTkxNS0+aG90cGx1Zy5wb2xsX2luaXRfd29yayk7
Cj4gICAKPiAgIAkvKgo+ICAgCSAqIEludGVycnVwdCBzZXR1cCBpcyBhbHJlYWR5IGd1YXJhbnRl
ZWQgdG8gYmUgc2luZ2xlLXRocmVhZGVkLCB0aGlzIGlzCj4gICAJICoganVzdCB0byBtYWtlIHRo
ZSBhc3NlcnRfc3Bpbl9sb2NrZWQgY2hlY2tzIGhhcHB5Lgo+ICAgCSAqLwo+IC0JaWYgKGRldl9w
cml2LT5kaXNwbGF5X2lycXNfZW5hYmxlZCAmJiBkZXZfcHJpdi0+ZGlzcGxheS5ocGRfaXJxX3Nl
dHVwKSB7Cj4gLQkJc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiAtCQlpZiAo
ZGV2X3ByaXYtPmRpc3BsYXlfaXJxc19lbmFibGVkKQo+IC0JCQlkZXZfcHJpdi0+ZGlzcGxheS5o
cGRfaXJxX3NldHVwKGRldl9wcml2KTsKPiAtCQlzcGluX3VubG9ja19pcnEoJmRldl9wcml2LT5p
cnFfbG9jayk7Cj4gKwlpZiAoaTkxNS0+ZGlzcGxheV9pcnFzX2VuYWJsZWQgJiYgaTkxNS0+ZGlz
cGxheS5ocGRfaXJxX3NldHVwKSB7Cj4gKwkJc3Bpbl9sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2sp
Owo+ICsJCWlmIChpOTE1LT5kaXNwbGF5X2lycXNfZW5hYmxlZCkKPiArCQkJaTkxNS0+ZGlzcGxh
eS5ocGRfaXJxX3NldHVwKGk5MTUpOwo+ICsJCXNwaW5fdW5sb2NrX2lycSgmaTkxNS0+aXJxX2xv
Y2spOwo+ICAgCX0KPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgaTkxNV9ocGRfcG9sbF9pbml0
X3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0KPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0K
PiAgIAkJY29udGFpbmVyX29mKHdvcmssIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlLAo+ICAgCQkJ
ICAgICBob3RwbHVnLnBvbGxfaW5pdF93b3JrKTsKPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYg
PSAmZGV2X3ByaXYtPmRybTsKPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJt
Owo+ICAgCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3I7Cj4gICAJc3RydWN0IGRybV9j
b25uZWN0b3JfbGlzdF9pdGVyIGNvbm5faXRlcjsKPiAgIAlib29sIGVuYWJsZWQ7Cj4gICAKPiAg
IAltdXRleF9sb2NrKCZkZXYtPm1vZGVfY29uZmlnLm11dGV4KTsKPiAgIAo+IC0JZW5hYmxlZCA9
IFJFQURfT05DRShkZXZfcHJpdi0+aG90cGx1Zy5wb2xsX2VuYWJsZWQpOwo+ICsJZW5hYmxlZCA9
IFJFQURfT05DRShpOTE1LT5ob3RwbHVnLnBvbGxfZW5hYmxlZCk7Cj4gICAKPiAgIAlkcm1fY29u
bmVjdG9yX2xpc3RfaXRlcl9iZWdpbihkZXYsICZjb25uX2l0ZXIpOwo+ICAgCWRybV9mb3JfZWFj
aF9jb25uZWN0b3JfaXRlcihjb25uZWN0b3IsICZjb25uX2l0ZXIpIHsKPiBAQCAtNTgyLDcgKzU4
Miw3IEBAIHN0YXRpYyB2b2lkIGk5MTVfaHBkX3BvbGxfaW5pdF93b3JrKHN0cnVjdCB3b3JrX3N0
cnVjdCAqd29yaykKPiAgIAkJaWYgKGludGVsX2Nvbm5lY3Rvci0+bXN0X3BvcnQpCj4gICAJCQlj
b250aW51ZTsKPiAgIAo+IC0JCWlmICghY29ubmVjdG9yLT5wb2xsZWQgJiYgSTkxNV9IQVNfSE9U
UExVRyhkZXZfcHJpdikgJiYKPiArCQlpZiAoIWNvbm5lY3Rvci0+cG9sbGVkICYmIEk5MTVfSEFT
X0hPVFBMVUcoaTkxNSkgJiYKPiAgIAkJICAgIGludGVsX2Nvbm5lY3Rvci0+ZW5jb2Rlci0+aHBk
X3BpbiA+IEhQRF9OT05FKSB7Cj4gICAJCQljb25uZWN0b3ItPnBvbGxlZCA9IGVuYWJsZWQgPwo+
ICAgCQkJCURSTV9DT05ORUNUT1JfUE9MTF9DT05ORUNUIHwKPiBAQCAtNjA3LDcgKzYwNyw3IEBA
IHN0YXRpYyB2b2lkIGk5MTVfaHBkX3BvbGxfaW5pdF93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAq
d29yaykKPiAgIAo+ICAgLyoqCj4gICAgKiBpbnRlbF9ocGRfcG9sbF9pbml0IC0gZW5hYmxlcy9k
aXNhYmxlcyBwb2xsaW5nIGZvciBjb25uZWN0b3JzIHdpdGggaHBkCj4gLSAqIEBkZXZfcHJpdjog
aTkxNSBkZXZpY2UgaW5zdGFuY2UKPiArICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4g
ICAgKgo+ICAgICogVGhpcyBmdW5jdGlvbiBlbmFibGVzIHBvbGxpbmcgZm9yIGFsbCBjb25uZWN0
b3JzLCByZWdhcmRsZXNzIG9mIHdoZXRoZXIgb3IKPiAgICAqIG5vdCB0aGV5IHN1cHBvcnQgaG90
cGx1ZyBkZXRlY3Rpb24uIFVuZGVyIGNlcnRhaW4gY29uZGl0aW9ucyBIUEQgbWF5IG5vdCBiZQo+
IEBAIC02MjEsOSArNjIxLDkgQEAgc3RhdGljIHZvaWQgaTkxNV9ocGRfcG9sbF9pbml0X3dvcmso
c3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAgICoKPiAgICAqIEFsc28gc2VlOiBpbnRlbF9o
cGRfaW5pdCgpLCB3aGljaCByZXN0b3JlcyBocGQgaGFuZGxpbmcuCj4gICAgKi8KPiAtdm9pZCBp
bnRlbF9ocGRfcG9sbF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAr
dm9pZCBpbnRlbF9ocGRfcG9sbF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ICAgewo+IC0JV1JJVEVfT05DRShkZXZfcHJpdi0+aG90cGx1Zy5wb2xsX2VuYWJsZWQsIHRydWUp
Owo+ICsJV1JJVEVfT05DRShpOTE1LT5ob3RwbHVnLnBvbGxfZW5hYmxlZCwgdHJ1ZSk7Cj4gICAK
PiAgIAkvKgo+ICAgCSAqIFdlIG1pZ2h0IGFscmVhZHkgYmUgaG9sZGluZyBkZXYtPm1vZGVfY29u
ZmlnLm11dGV4LCBzbyBkbyB0aGlzIGluIGEKPiBAQCAtNjMxLDU3ICs2MzEsNTcgQEAgdm9pZCBp
bnRlbF9ocGRfcG9sbF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAg
IAkgKiBBcyB3ZWxsLCB0aGVyZSdzIG5vIGlzc3VlIGlmIHdlIHJhY2UgaGVyZSBzaW5jZSB3ZSBh
bHdheXMgcmVzY2hlZHVsZQo+ICAgCSAqIHRoaXMgd29ya2VyIGFueXdheQo+ICAgCSAqLwo+IC0J
c2NoZWR1bGVfd29yaygmZGV2X3ByaXYtPmhvdHBsdWcucG9sbF9pbml0X3dvcmspOwo+ICsJc2No
ZWR1bGVfd29yaygmaTkxNS0+aG90cGx1Zy5wb2xsX2luaXRfd29yayk7Cj4gICB9Cj4gICAKPiAt
dm9pZCBpbnRlbF9ocGRfaW5pdF93b3JrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiArdm9pZCBpbnRlbF9ocGRfaW5pdF93b3JrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ICAgewo+IC0JSU5JVF9XT1JLKCZkZXZfcHJpdi0+aG90cGx1Zy5ob3RwbHVnX3dvcmss
IGk5MTVfaG90cGx1Z193b3JrX2Z1bmMpOwo+IC0JSU5JVF9XT1JLKCZkZXZfcHJpdi0+aG90cGx1
Zy5kaWdfcG9ydF93b3JrLCBpOTE1X2RpZ3BvcnRfd29ya19mdW5jKTsKPiAtCUlOSVRfV09SSygm
ZGV2X3ByaXYtPmhvdHBsdWcucG9sbF9pbml0X3dvcmssIGk5MTVfaHBkX3BvbGxfaW5pdF93b3Jr
KTsKPiAtCUlOSVRfREVMQVlFRF9XT1JLKCZkZXZfcHJpdi0+aG90cGx1Zy5yZWVuYWJsZV93b3Jr
LAo+ICsJSU5JVF9XT1JLKCZpOTE1LT5ob3RwbHVnLmhvdHBsdWdfd29yaywgaTkxNV9ob3RwbHVn
X3dvcmtfZnVuYyk7Cj4gKwlJTklUX1dPUksoJmk5MTUtPmhvdHBsdWcuZGlnX3BvcnRfd29yaywg
aTkxNV9kaWdwb3J0X3dvcmtfZnVuYyk7Cj4gKwlJTklUX1dPUksoJmk5MTUtPmhvdHBsdWcucG9s
bF9pbml0X3dvcmssIGk5MTVfaHBkX3BvbGxfaW5pdF93b3JrKTsKPiArCUlOSVRfREVMQVlFRF9X
T1JLKCZpOTE1LT5ob3RwbHVnLnJlZW5hYmxlX3dvcmssCj4gICAJCQkgIGludGVsX2hwZF9pcnFf
c3Rvcm1fcmVlbmFibGVfd29yayk7Cj4gICB9Cj4gICAKPiAtdm9pZCBpbnRlbF9ocGRfY2FuY2Vs
X3dvcmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGludGVsX2hw
ZF9jYW5jZWxfd29yayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXNw
aW5fbG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gKwlzcGluX2xvY2tfaXJxKCZpOTE1
LT5pcnFfbG9jayk7Cj4gICAKPiAtCWRldl9wcml2LT5ob3RwbHVnLmxvbmdfcG9ydF9tYXNrID0g
MDsKPiAtCWRldl9wcml2LT5ob3RwbHVnLnNob3J0X3BvcnRfbWFzayA9IDA7Cj4gLQlkZXZfcHJp
di0+aG90cGx1Zy5ldmVudF9iaXRzID0gMDsKPiArCWk5MTUtPmhvdHBsdWcubG9uZ19wb3J0X21h
c2sgPSAwOwo+ICsJaTkxNS0+aG90cGx1Zy5zaG9ydF9wb3J0X21hc2sgPSAwOwo+ICsJaTkxNS0+
aG90cGx1Zy5ldmVudF9iaXRzID0gMDsKPiAgIAo+IC0Jc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJp
di0+aXJxX2xvY2spOwo+ICsJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gICAK
PiAtCWNhbmNlbF93b3JrX3N5bmMoJmRldl9wcml2LT5ob3RwbHVnLmRpZ19wb3J0X3dvcmspOwo+
IC0JY2FuY2VsX3dvcmtfc3luYygmZGV2X3ByaXYtPmhvdHBsdWcuaG90cGx1Z193b3JrKTsKPiAt
CWNhbmNlbF93b3JrX3N5bmMoJmRldl9wcml2LT5ob3RwbHVnLnBvbGxfaW5pdF93b3JrKTsKPiAt
CWNhbmNlbF9kZWxheWVkX3dvcmtfc3luYygmZGV2X3ByaXYtPmhvdHBsdWcucmVlbmFibGVfd29y
ayk7Cj4gKwljYW5jZWxfd29ya19zeW5jKCZpOTE1LT5ob3RwbHVnLmRpZ19wb3J0X3dvcmspOwo+
ICsJY2FuY2VsX3dvcmtfc3luYygmaTkxNS0+aG90cGx1Zy5ob3RwbHVnX3dvcmspOwo+ICsJY2Fu
Y2VsX3dvcmtfc3luYygmaTkxNS0+aG90cGx1Zy5wb2xsX2luaXRfd29yayk7Cj4gKwljYW5jZWxf
ZGVsYXllZF93b3JrX3N5bmMoJmk5MTUtPmhvdHBsdWcucmVlbmFibGVfd29yayk7Cj4gICB9Cj4g
ICAKPiAtYm9vbCBpbnRlbF9ocGRfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsIGVudW0gaHBkX3BpbiBwaW4pCj4gK2Jvb2wgaW50ZWxfaHBkX2Rpc2FibGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gaHBkX3BpbiBwaW4pCj4gICB7Cj4gICAJYm9v
bCByZXQgPSBmYWxzZTsKPiAgIAo+ICAgCWlmIChwaW4gPT0gSFBEX05PTkUpCj4gICAJCXJldHVy
biBmYWxzZTsKPiAgIAo+IC0Jc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiAt
CWlmIChkZXZfcHJpdi0+aG90cGx1Zy5zdGF0c1twaW5dLnN0YXRlID09IEhQRF9FTkFCTEVEKSB7
Cj4gLQkJZGV2X3ByaXYtPmhvdHBsdWcuc3RhdHNbcGluXS5zdGF0ZSA9IEhQRF9ESVNBQkxFRDsK
PiArCXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiArCWlmIChpOTE1LT5ob3RwbHVn
LnN0YXRzW3Bpbl0uc3RhdGUgPT0gSFBEX0VOQUJMRUQpIHsKPiArCQlpOTE1LT5ob3RwbHVnLnN0
YXRzW3Bpbl0uc3RhdGUgPSBIUERfRElTQUJMRUQ7Cj4gICAJCXJldCA9IHRydWU7Cj4gICAJfQo+
IC0Jc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ICsJc3Bpbl91bmxvY2tf
aXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+ICAgCj4g
LXZvaWQgaW50ZWxfaHBkX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
IGVudW0gaHBkX3BpbiBwaW4pCj4gK3ZvaWQgaW50ZWxfaHBkX2VuYWJsZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBocGRfcGluIHBpbikKPiAgIHsKPiAgIAlpZiAocGluID09
IEhQRF9OT05FKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCXNwaW5fbG9ja19pcnEoJmRldl9wcml2
LT5pcnFfbG9jayk7Cj4gLQlkZXZfcHJpdi0+aG90cGx1Zy5zdGF0c1twaW5dLnN0YXRlID0gSFBE
X0VOQUJMRUQ7Cj4gLQlzcGluX3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gKwlz
cGluX2xvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gKwlpOTE1LT5ob3RwbHVnLnN0YXRzW3Bp
bl0uc3RhdGUgPSBIUERfRU5BQkxFRDsKPiArCXNwaW5fdW5sb2NrX2lycSgmaTkxNS0+aXJxX2xv
Y2spOwo+ICAgfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ob3Rw
bHVnLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ob3RwbHVnLmgKPiBpbmRleCA4MDVm
ODk3ZGJiN2EuLjJmY2MzMTQ4YjM2OSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9ob3RwbHVnLmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ob3Rw
bHVnLmgKPiBAQCAtMTQsMTcgKzE0LDE3IEBAIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlOwo+ICAg
c3RydWN0IGludGVsX2Nvbm5lY3RvcjsKPiAgIHN0cnVjdCBpbnRlbF9lbmNvZGVyOwo+ICAgCj4g
LXZvaWQgaW50ZWxfaHBkX3BvbGxfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpOwo+ICt2b2lkIGludGVsX2hwZF9wb2xsX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpOwo+ICAgYm9vbCBpbnRlbF9lbmNvZGVyX2hvdHBsdWcoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIsCj4gICAJCQkgICBzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3Ip
Owo+IC12b2lkIGludGVsX2hwZF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gK3ZvaWQgaW50ZWxfaHBkX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAo+ICAgCQkJICAgdTMyIHBpbl9tYXNrLCB1MzIgbG9uZ19tYXNrKTsKPiAt
dm9pZCBpbnRlbF9ocGRfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+
IC12b2lkIGludGVsX2hwZF9pbml0X3dvcmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KTsKPiAtdm9pZCBpbnRlbF9ocGRfY2FuY2VsX3dvcmsoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KTsKPiAtZW51bSBocGRfcGluIGludGVsX2hwZF9waW5fZGVmYXVsdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3ZvaWQgaW50ZWxfaHBkX2luaXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lkIGludGVsX2hwZF9pbml0X3dvcmso
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lkIGludGVsX2hwZF9jYW5jZWxf
d29yayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK2VudW0gaHBkX3BpbiBpbnRl
bF9ocGRfcGluX2RlZmF1bHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJ
ICAgZW51bSBwb3J0IHBvcnQpOwo+IC1ib29sIGludGVsX2hwZF9kaXNhYmxlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBocGRfcGluIHBpbik7Cj4gLXZvaWQgaW50ZWxf
aHBkX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gaHBkX3Bp
biBwaW4pOwo+ICtib29sIGludGVsX2hwZF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LCBlbnVtIGhwZF9waW4gcGluKTsKPiArdm9pZCBpbnRlbF9ocGRfZW5hYmxlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIGhwZF9waW4gcGluKTsKPiAgIAo+ICAgI2Vu
ZGlmIC8qIF9fSU5URUxfSE9UUExVR19IX18gKi8KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfaHVjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9odWMuYwo+
IGluZGV4IDg1NzJhMDU4OGVmYy4uMmIyMzY2MjY5OGE5IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX2h1Yy5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50
ZWxfaHVjLmMKPiBAQCAtMTY3LDE0ICsxNjcsMTQgQEAgaW50IGludGVsX2h1Y19hdXRoKHN0cnVj
dCBpbnRlbF9odWMgKmh1YykKPiAgICAqLwo+ICAgaW50IGludGVsX2h1Y19jaGVja19zdGF0dXMo
c3RydWN0IGludGVsX2h1YyAqaHVjKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gaHVjX3RvX2k5MTUoaHVjKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gaHVjX3RvX2k5MTUoaHVjKTsKPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsK
PiAgIAlib29sIHN0YXR1cyA9IGZhbHNlOwo+ICAgCj4gLQlpZiAoIUhBU19IVUMoZGV2X3ByaXYp
KQo+ICsJaWYgKCFIQVNfSFVDKGk5MTUpKQo+ICAgCQlyZXR1cm4gLUVOT0RFVjsKPiAgIAo+IC0J
d2l0aF9pbnRlbF9ydW50aW1lX3BtKGRldl9wcml2LCB3YWtlcmVmKQo+ICsJd2l0aF9pbnRlbF9y
dW50aW1lX3BtKGk5MTUsIHdha2VyZWYpCj4gICAJCXN0YXR1cyA9IChJOTE1X1JFQUQoaHVjLT5z
dGF0dXMucmVnKSAmIGh1Yy0+c3RhdHVzLm1hc2spID09Cj4gICAJCQkgIGh1Yy0+c3RhdHVzLnZh
bHVlOwo+ICAgCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2h1Y19m
dy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfaHVjX2Z3LmMKPiBpbmRleCAwNWNiZjgz
MzhmNTMuLjAzYWVkMDY2NDcyNiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9odWNfZncuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2h1Y19mdy5j
Cj4gQEAgLTY5LDM0ICs2OSwzNCBAQCBNT0RVTEVfRklSTVdBUkUoSTkxNV9JQ0xfSFVDX1VDT0RF
KTsKPiAgIHN0YXRpYyB2b2lkIGh1Y19md19zZWxlY3Qoc3RydWN0IGludGVsX3VjX2Z3ICpodWNf
ZncpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2h1YyAqaHVjID0gY29udGFpbmVyX29mKGh1Y19m
dywgc3RydWN0IGludGVsX2h1YywgZncpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gaHVjX3RvX2k5MTUoaHVjKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gaHVjX3RvX2k5MTUoaHVjKTsKPiAgIAo+ICAgCUdFTV9CVUdfT04oaHVjX2Z3LT50eXBl
ICE9IElOVEVMX1VDX0ZXX1RZUEVfSFVDKTsKPiAgIAo+IC0JaWYgKCFIQVNfSFVDKGRldl9wcml2
KSkKPiArCWlmICghSEFTX0hVQyhpOTE1KSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJaWYgKGk5
MTVfbW9kcGFyYW1zLmh1Y19maXJtd2FyZV9wYXRoKSB7Cj4gICAJCWh1Y19mdy0+cGF0aCA9IGk5
MTVfbW9kcGFyYW1zLmh1Y19maXJtd2FyZV9wYXRoOwo+ICAgCQlodWNfZnctPm1ham9yX3Zlcl93
YW50ZWQgPSAwOwo+ICAgCQlodWNfZnctPm1pbm9yX3Zlcl93YW50ZWQgPSAwOwo+IC0JfSBlbHNl
IGlmIChJU19TS1lMQUtFKGRldl9wcml2KSkgewo+ICsJfSBlbHNlIGlmIChJU19TS1lMQUtFKGk5
MTUpKSB7Cj4gICAJCWh1Y19mdy0+cGF0aCA9IEk5MTVfU0tMX0hVQ19VQ09ERTsKPiAgIAkJaHVj
X2Z3LT5tYWpvcl92ZXJfd2FudGVkID0gU0tMX0hVQ19GV19NQUpPUjsKPiAgIAkJaHVjX2Z3LT5t
aW5vcl92ZXJfd2FudGVkID0gU0tMX0hVQ19GV19NSU5PUjsKPiAtCX0gZWxzZSBpZiAoSVNfQlJP
WFRPTihkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAoSVNfQlJPWFRPTihpOTE1KSkgewo+ICAg
CQlodWNfZnctPnBhdGggPSBJOTE1X0JYVF9IVUNfVUNPREU7Cj4gICAJCWh1Y19mdy0+bWFqb3Jf
dmVyX3dhbnRlZCA9IEJYVF9IVUNfRldfTUFKT1I7Cj4gICAJCWh1Y19mdy0+bWlub3JfdmVyX3dh
bnRlZCA9IEJYVF9IVUNfRldfTUlOT1I7Cj4gLQl9IGVsc2UgaWYgKElTX0tBQllMQUtFKGRldl9w
cml2KSB8fCBJU19DT0ZGRUVMQUtFKGRldl9wcml2KSkgewo+ICsJfSBlbHNlIGlmIChJU19LQUJZ
TEFLRShpOTE1KSB8fCBJU19DT0ZGRUVMQUtFKGk5MTUpKSB7Cj4gICAJCWh1Y19mdy0+cGF0aCA9
IEk5MTVfS0JMX0hVQ19VQ09ERTsKPiAgIAkJaHVjX2Z3LT5tYWpvcl92ZXJfd2FudGVkID0gS0JM
X0hVQ19GV19NQUpPUjsKPiAgIAkJaHVjX2Z3LT5taW5vcl92ZXJfd2FudGVkID0gS0JMX0hVQ19G
V19NSU5PUjsKPiAtCX0gZWxzZSBpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpIHsKPiArCX0g
ZWxzZSBpZiAoSVNfR0VNSU5JTEFLRShpOTE1KSkgewo+ICAgCQlodWNfZnctPnBhdGggPSBJOTE1
X0dMS19IVUNfVUNPREU7Cj4gICAJCWh1Y19mdy0+bWFqb3JfdmVyX3dhbnRlZCA9IEdMS19IVUNf
RldfTUFKT1I7Cj4gICAJCWh1Y19mdy0+bWlub3JfdmVyX3dhbnRlZCA9IEdMS19IVUNfRldfTUlO
T1I7Cj4gLQl9IGVsc2UgaWYgKElTX0lDRUxBS0UoZGV2X3ByaXYpKSB7Cj4gKwl9IGVsc2UgaWYg
KElTX0lDRUxBS0UoaTkxNSkpIHsKPiAgIAkJaHVjX2Z3LT5wYXRoID0gSTkxNV9JQ0xfSFVDX1VD
T0RFOwo+ICAgCQlodWNfZnctPm1ham9yX3Zlcl93YW50ZWQgPSBJQ0xfSFVDX0ZXX01BSk9SOwo+
ICAgCQlodWNfZnctPm1pbm9yX3Zlcl93YW50ZWQgPSBJQ0xfSFVDX0ZXX01JTk9SOwo+IEBAIC0x
MzUsOCArMTM1LDggQEAgc3RhdGljIHZvaWQgaHVjX3hmZXJfcnNhKHN0cnVjdCBpbnRlbF9odWMg
Kmh1YykKPiAgIHN0YXRpYyBpbnQgaHVjX3hmZXJfdWNvZGUoc3RydWN0IGludGVsX2h1YyAqaHVj
KQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF91Y19mdyAqaHVjX2Z3ID0gJmh1Yy0+Znc7Cj4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBodWNfdG9faTkxNShodWMpOwo+IC0J
c3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmRldl9wcml2LT51bmNvcmU7Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGh1Y190b19pOTE1KGh1Yyk7Cj4gKwlzdHJ1Y3Qg
aW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwo+ICAgCXVuc2lnbmVkIGxvbmcg
b2Zmc2V0ID0gMDsKPiAgIAl1MzIgc2l6ZTsKPiAgIAlpbnQgcmV0Owo+IGRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9scGVfYXVkaW8uYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX2xwZV9hdWRpby5jCj4gaW5kZXggYjE5ODAwYjU4NDQyLi5kOTVhZTA1Y2NlYmMg
MTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfbHBlX2F1ZGlvLmMKPiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9scGVfYXVkaW8uYwo+IEBAIC03MywxMiAr
NzMsMTIgQEAKPiAgICNpbmNsdWRlICJpOTE1X2Rydi5oIgo+ICAgI2luY2x1ZGUgImludGVsX2xw
ZV9hdWRpby5oIgo+ICAgCj4gLSNkZWZpbmUgSEFTX0xQRV9BVURJTyhkZXZfcHJpdikgKChkZXZf
cHJpdiktPmxwZV9hdWRpby5wbGF0ZGV2ICE9IE5VTEwpCj4gKyNkZWZpbmUgSEFTX0xQRV9BVURJ
TyhpOTE1KSAoKGk5MTUpLT5scGVfYXVkaW8ucGxhdGRldiAhPSBOVUxMKQo+ICAgCj4gICBzdGF0
aWMgc3RydWN0IHBsYXRmb3JtX2RldmljZSAqCj4gLWxwZV9hdWRpb19wbGF0ZGV2X2NyZWF0ZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK2xwZV9hdWRpb19wbGF0ZGV2X2Ny
ZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYg
PSAmaTkxNS0+ZHJtOwo+ICAgCXN0cnVjdCBwbGF0Zm9ybV9kZXZpY2VfaW5mbyBwaW5mbyA9IHt9
Owo+ICAgCXN0cnVjdCByZXNvdXJjZSAqcnNjOwo+ICAgCXN0cnVjdCBwbGF0Zm9ybV9kZXZpY2Ug
KnBsYXRkZXY7Cj4gQEAgLTk0LDcgKzk0LDcgQEAgbHBlX2F1ZGlvX3BsYXRkZXZfY3JlYXRlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkJcmV0dXJuIEVSUl9QVFIoLUVO
T01FTSk7Cj4gICAJfQo+ICAgCj4gLQlyc2NbMF0uc3RhcnQgICAgPSByc2NbMF0uZW5kID0gZGV2
X3ByaXYtPmxwZV9hdWRpby5pcnE7Cj4gKwlyc2NbMF0uc3RhcnQgICAgPSByc2NbMF0uZW5kID0g
aTkxNS0+bHBlX2F1ZGlvLmlycTsKPiAgIAlyc2NbMF0uZmxhZ3MgICAgPSBJT1JFU09VUkNFX0lS
UTsKPiAgIAlyc2NbMF0ubmFtZSAgICAgPSAiaGRtaS1scGUtYXVkaW8taXJxIjsKPiAgIAo+IEBA
IC0xMTQsOCArMTE0LDggQEAgbHBlX2F1ZGlvX3BsYXRkZXZfY3JlYXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAlwaW5mby5zaXplX2RhdGEgPSBzaXplb2YoKnBkYXRh
KTsKPiAgIAlwaW5mby5kbWFfbWFzayA9IERNQV9CSVRfTUFTSygzMik7Cj4gICAKPiAtCXBkYXRh
LT5udW1fcGlwZXMgPSBJTlRFTF9JTkZPKGRldl9wcml2KS0+bnVtX3BpcGVzOwo+IC0JcGRhdGEt
Pm51bV9wb3J0cyA9IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpID8gMyA6IDI7IC8qIEIsQyxEIG9y
IEIsQyAqLwo+ICsJcGRhdGEtPm51bV9waXBlcyA9IElOVEVMX0lORk8oaTkxNSktPm51bV9waXBl
czsKPiArCXBkYXRhLT5udW1fcG9ydHMgPSBJU19DSEVSUllWSUVXKGk5MTUpID8gMyA6IDI7IC8q
IEIsQyxEIG9yIEIsQyAqLwo+ICAgCXBkYXRhLT5wb3J0WzBdLnBpcGUgPSAtMTsKPiAgIAlwZGF0
YS0+cG9ydFsxXS5waXBlID0gLTE7Cj4gICAJcGRhdGEtPnBvcnRbMl0ucGlwZSA9IC0xOwo+IEBA
IC0xMzUsNyArMTM1LDcgQEAgbHBlX2F1ZGlvX3BsYXRkZXZfY3JlYXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAlyZXR1cm4gcGxhdGRldjsKPiAgIH0KPiAgIAo+IC1z
dGF0aWMgdm9pZCBscGVfYXVkaW9fcGxhdGRldl9kZXN0cm95KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgbHBlX2F1ZGlvX3BsYXRkZXZfZGVzdHJveShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAkvKiBYWFggTm90ZSB0aGF0
IHBsYXRmb3JtX2RldmljZV9yZWdpc3Rlcl9mdWxsKCkgYWxsb2NhdGVzIGEgZG1hX21hc2sKPiAg
IAkgKiBhbmQgbmV2ZXIgZnJlZXMgaXQuIFdlIGNhbid0IGZyZWUgaXQgaGVyZSBhcyB3ZSBjYW5u
b3QgZ3VhcmFudGVlCj4gQEAgLTE0NSw3ICsxNDUsNyBAQCBzdGF0aWMgdm9pZCBscGVfYXVkaW9f
cGxhdGRldl9kZXN0cm95KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkg
KiB0aGFuIHVzIGZpZGRsZSB3aXRoIGl0cyBpbnRlcm5hbHMuCj4gICAJICovCj4gICAKPiAtCXBs
YXRmb3JtX2RldmljZV91bnJlZ2lzdGVyKGRldl9wcml2LT5scGVfYXVkaW8ucGxhdGRldik7Cj4g
KwlwbGF0Zm9ybV9kZXZpY2VfdW5yZWdpc3RlcihpOTE1LT5scGVfYXVkaW8ucGxhdGRldik7Cj4g
ICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIGxwZV9hdWRpb19pcnFfdW5tYXNrKHN0cnVjdCBpcnFf
ZGF0YSAqZCkKPiBAQCAtMTYyLDI0ICsxNjIsMjQgQEAgc3RhdGljIHN0cnVjdCBpcnFfY2hpcCBs
cGVfYXVkaW9faXJxY2hpcCA9IHsKPiAgIAkuaXJxX3VubWFzayA9IGxwZV9hdWRpb19pcnFfdW5t
YXNrLAo+ICAgfTsKPiAgIAo+IC1zdGF0aWMgaW50IGxwZV9hdWRpb19pcnFfaW5pdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyBpbnQgbHBlX2F1ZGlvX2lycV9p
bml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JaW50IGlycSA9IGRl
dl9wcml2LT5scGVfYXVkaW8uaXJxOwo+ICsJaW50IGlycSA9IGk5MTUtPmxwZV9hdWRpby5pcnE7
Cj4gICAKPiAtCVdBUk5fT04oIWludGVsX2lycXNfZW5hYmxlZChkZXZfcHJpdikpOwo+ICsJV0FS
Tl9PTighaW50ZWxfaXJxc19lbmFibGVkKGk5MTUpKTsKPiAgIAlpcnFfc2V0X2NoaXBfYW5kX2hh
bmRsZXJfbmFtZShpcnEsCj4gICAJCQkJJmxwZV9hdWRpb19pcnFjaGlwLAo+ICAgCQkJCWhhbmRs
ZV9zaW1wbGVfaXJxLAo+ICAgCQkJCSJoZG1pX2xwZV9hdWRpb19pcnFfaGFuZGxlciIpOwo+ICAg
Cj4gLQlyZXR1cm4gaXJxX3NldF9jaGlwX2RhdGEoaXJxLCBkZXZfcHJpdik7Cj4gKwlyZXR1cm4g
aXJxX3NldF9jaGlwX2RhdGEoaXJxLCBpOTE1KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgYm9vbCBs
cGVfYXVkaW9fZGV0ZWN0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3Rh
dGljIGJvb2wgbHBlX2F1ZGlvX2RldGVjdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiAgIHsKPiAgIAlpbnQgbHBlX3ByZXNlbnQgPSBmYWxzZTsKPiAgIAo+IC0JaWYgKElTX1ZBTExF
WVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNf
VkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gICAJCXN0YXRpYyBj
b25zdCBzdHJ1Y3QgcGNpX2RldmljZV9pZCBhdG9tX2hkYXVkaW9faWRzW10gPSB7Cj4gICAJCQkv
KiBCYXl0cmFpbCAqLwo+ICAgCQkJe1BDSV9ERVZJQ0UoUENJX1ZFTkRPUl9JRF9JTlRFTCwgMHgw
ZjA0KX0sCj4gQEAgLTE5NiwyMSArMTk2LDIxIEBAIHN0YXRpYyBib29sIGxwZV9hdWRpb19kZXRl
Y3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCXJldHVybiBscGVfcHJl
c2VudDsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgaW50IGxwZV9hdWRpb19zZXR1cChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyBpbnQgbHBlX2F1ZGlvX3NldHVwKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCWludCByZXQ7Cj4gICAKPiAt
CWRldl9wcml2LT5scGVfYXVkaW8uaXJxID0gaXJxX2FsbG9jX2Rlc2MoMCk7Cj4gLQlpZiAoZGV2
X3ByaXYtPmxwZV9hdWRpby5pcnEgPCAwKSB7Cj4gKwlpOTE1LT5scGVfYXVkaW8uaXJxID0gaXJx
X2FsbG9jX2Rlc2MoMCk7Cj4gKwlpZiAoaTkxNS0+bHBlX2F1ZGlvLmlycSA8IDApIHsKPiAgIAkJ
RFJNX0VSUk9SKCJGYWlsZWQgdG8gYWxsb2NhdGUgSVJRIGRlc2M6ICVkXG4iLAo+IC0JCQlkZXZf
cHJpdi0+bHBlX2F1ZGlvLmlycSk7Cj4gLQkJcmV0ID0gZGV2X3ByaXYtPmxwZV9hdWRpby5pcnE7
Cj4gKwkJCWk5MTUtPmxwZV9hdWRpby5pcnEpOwo+ICsJCXJldCA9IGk5MTUtPmxwZV9hdWRpby5p
cnE7Cj4gICAJCWdvdG8gZXJyOwo+ICAgCX0KPiAgIAo+IC0JRFJNX0RFQlVHKCJpcnEgPSAlZFxu
IiwgZGV2X3ByaXYtPmxwZV9hdWRpby5pcnEpOwo+ICsJRFJNX0RFQlVHKCJpcnEgPSAlZFxuIiwg
aTkxNS0+bHBlX2F1ZGlvLmlycSk7Cj4gICAKPiAtCXJldCA9IGxwZV9hdWRpb19pcnFfaW5pdChk
ZXZfcHJpdik7Cj4gKwlyZXQgPSBscGVfYXVkaW9faXJxX2luaXQoaTkxNSk7Cj4gICAKPiAgIAlp
ZiAocmV0KSB7Cj4gICAJCURSTV9FUlJPUigiRmFpbGVkIHRvIGluaXRpYWxpemUgaXJxY2hpcCBm
b3IgbHBlIGF1ZGlvOiAlZFxuIiwKPiBAQCAtMjE4LDEwICsyMTgsMTAgQEAgc3RhdGljIGludCBs
cGVfYXVkaW9fc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQln
b3RvIGVycl9mcmVlX2lycTsKPiAgIAl9Cj4gICAKPiAtCWRldl9wcml2LT5scGVfYXVkaW8ucGxh
dGRldiA9IGxwZV9hdWRpb19wbGF0ZGV2X2NyZWF0ZShkZXZfcHJpdik7Cj4gKwlpOTE1LT5scGVf
YXVkaW8ucGxhdGRldiA9IGxwZV9hdWRpb19wbGF0ZGV2X2NyZWF0ZShpOTE1KTsKPiAgIAo+IC0J
aWYgKElTX0VSUihkZXZfcHJpdi0+bHBlX2F1ZGlvLnBsYXRkZXYpKSB7Cj4gLQkJcmV0ID0gUFRS
X0VSUihkZXZfcHJpdi0+bHBlX2F1ZGlvLnBsYXRkZXYpOwo+ICsJaWYgKElTX0VSUihpOTE1LT5s
cGVfYXVkaW8ucGxhdGRldikpIHsKPiArCQlyZXQgPSBQVFJfRVJSKGk5MTUtPmxwZV9hdWRpby5w
bGF0ZGV2KTsKPiAgIAkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gY3JlYXRlIGxwZSBhdWRpbyBwbGF0
Zm9ybSBkZXZpY2U6ICVkXG4iLAo+ICAgCQkJcmV0KTsKPiAgIAkJZ290byBlcnJfZnJlZV9pcnE7
Cj4gQEAgLTIzNCwyOCArMjM0LDI4IEBAIHN0YXRpYyBpbnQgbHBlX2F1ZGlvX3NldHVwKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAo+ICAgCXJldHVybiAwOwo+ICAgZXJy
X2ZyZWVfaXJxOgo+IC0JaXJxX2ZyZWVfZGVzYyhkZXZfcHJpdi0+bHBlX2F1ZGlvLmlycSk7Cj4g
KwlpcnFfZnJlZV9kZXNjKGk5MTUtPmxwZV9hdWRpby5pcnEpOwo+ICAgZXJyOgo+IC0JZGV2X3By
aXYtPmxwZV9hdWRpby5pcnEgPSAtMTsKPiAtCWRldl9wcml2LT5scGVfYXVkaW8ucGxhdGRldiA9
IE5VTEw7Cj4gKwlpOTE1LT5scGVfYXVkaW8uaXJxID0gLTE7Cj4gKwlpOTE1LT5scGVfYXVkaW8u
cGxhdGRldiA9IE5VTEw7Cj4gICAJcmV0dXJuIHJldDsKPiAgIH0KPiAgIAo+ICAgLyoqCj4gICAg
KiBpbnRlbF9scGVfYXVkaW9faXJxX2hhbmRsZXIoKSAtIGZvcndhcmRzIHRoZSBMUEUgYXVkaW8g
aXJxCj4gLSAqIEBkZXZfcHJpdjogdGhlIGk5MTUgZHJtIGRldmljZSBwcml2YXRlIGRhdGEKPiAr
ICogQGk5MTU6IHRoZSBpOTE1IGRybSBkZXZpY2UgcHJpdmF0ZSBkYXRhCj4gICAgKgo+ICAgICog
dGhlIExQRSBBdWRpbyBpcnEgaXMgZm9yd2FyZGVkIHRvIHRoZSBpcnEgaGFuZGxlciByZWdpc3Rl
cmVkIGJ5IExQRSBhdWRpbwo+ICAgICogZHJpdmVyLgo+ICAgICovCj4gLXZvaWQgaW50ZWxfbHBl
X2F1ZGlvX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAr
dm9pZCBpbnRlbF9scGVfYXVkaW9faXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCj4gICB7Cj4gICAJaW50IHJldDsKPiAgIAo+IC0JaWYgKCFIQVNfTFBFX0FVRElPKGRl
dl9wcml2KSkKPiArCWlmICghSEFTX0xQRV9BVURJTyhpOTE1KSkKPiAgIAkJcmV0dXJuOwo+ICAg
Cj4gLQlyZXQgPSBnZW5lcmljX2hhbmRsZV9pcnEoZGV2X3ByaXYtPmxwZV9hdWRpby5pcnEpOwo+
ICsJcmV0ID0gZ2VuZXJpY19oYW5kbGVfaXJxKGk5MTUtPmxwZV9hdWRpby5pcnEpOwo+ICAgCWlm
IChyZXQpCj4gICAJCURSTV9FUlJPUl9SQVRFTElNSVRFRCgiZXJyb3IgaGFuZGxpbmcgTFBFIGF1
ZGlvIGlycTogJWRcbiIsCj4gICAJCQkJcmV0KTsKPiBAQCAtMjY0LDE3ICsyNjQsMTcgQEAgdm9p
ZCBpbnRlbF9scGVfYXVkaW9faXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ICAgLyoqCj4gICAgKiBpbnRlbF9scGVfYXVkaW9faW5pdCgpIC0gZGV0ZWN0IGFu
ZCBzZXR1cCB0aGUgYnJpZGdlIGJldHdlZW4gSERNSSBMUEUgQXVkaW8KPiAgICAqIGRyaXZlciBh
bmQgaTkxNQo+IC0gKiBAZGV2X3ByaXY6IHRoZSBpOTE1IGRybSBkZXZpY2UgcHJpdmF0ZSBkYXRh
Cj4gKyAqIEBpOTE1OiB0aGUgaTkxNSBkcm0gZGV2aWNlIHByaXZhdGUgZGF0YQo+ICAgICoKPiAg
ICAqIFJldHVybjogMCBpZiBzdWNjZXNzZnVsLiBub24temVybyBpZiBkZXRlY3Rpb24gb3IKPiAg
ICAqIGxsb2NhdGlvbi9pbml0aWFsaXphdGlvbiBmYWlscwo+ICAgICovCj4gLWludCBpbnRlbF9s
cGVfYXVkaW9faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK2ludCBp
bnRlbF9scGVfYXVkaW9faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsK
PiAgIAlpbnQgcmV0ID0gLUVOT0RFVjsKPiAgIAo+IC0JaWYgKGxwZV9hdWRpb19kZXRlY3QoZGV2
X3ByaXYpKSB7Cj4gLQkJcmV0ID0gbHBlX2F1ZGlvX3NldHVwKGRldl9wcml2KTsKPiArCWlmIChs
cGVfYXVkaW9fZGV0ZWN0KGk5MTUpKSB7Cj4gKwkJcmV0ID0gbHBlX2F1ZGlvX3NldHVwKGk5MTUp
Owo+ICAgCQlpZiAocmV0IDwgMCkKPiAgIAkJCURSTV9FUlJPUigiZmFpbGVkIHRvIHNldHVwIExQ
RSBBdWRpbyBicmlkZ2VcbiIpOwo+ICAgCX0KPiBAQCAtMjg0LDMxICsyODQsMzEgQEAgaW50IGlu
dGVsX2xwZV9hdWRpb19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAg
IC8qKgo+ICAgICogaW50ZWxfbHBlX2F1ZGlvX3RlYXJkb3duKCkgLSBkZXN0cm95IHRoZSBicmlk
Z2UgYmV0d2VlbiBIRE1JIExQRQo+ICAgICogYXVkaW8gZHJpdmVyIGFuZCBpOTE1Cj4gLSAqIEBk
ZXZfcHJpdjogdGhlIGk5MTUgZHJtIGRldmljZSBwcml2YXRlIGRhdGEKPiArICogQGk5MTU6IHRo
ZSBpOTE1IGRybSBkZXZpY2UgcHJpdmF0ZSBkYXRhCj4gICAgKgo+ICAgICogcmVsZWFzZSBhbGwg
dGhlIHJlc291cmNlcyBmb3IgTFBFIGF1ZGlvIDwtPiBpOTE1IGJyaWRnZS4KPiAgICAqLwo+IC12
b2lkIGludGVsX2xwZV9hdWRpb190ZWFyZG93bihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gK3ZvaWQgaW50ZWxfbHBlX2F1ZGlvX3RlYXJkb3duKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQo+ICAgewo+ICAgCXN0cnVjdCBpcnFfZGVzYyAqZGVzYzsKPiAgIAo+IC0J
aWYgKCFIQVNfTFBFX0FVRElPKGRldl9wcml2KSkKPiArCWlmICghSEFTX0xQRV9BVURJTyhpOTE1
KSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQlkZXNjID0gaXJxX3RvX2Rlc2MoZGV2X3ByaXYtPmxw
ZV9hdWRpby5pcnEpOwo+ICsJZGVzYyA9IGlycV90b19kZXNjKGk5MTUtPmxwZV9hdWRpby5pcnEp
Owo+ICAgCj4gLQlscGVfYXVkaW9fcGxhdGRldl9kZXN0cm95KGRldl9wcml2KTsKPiArCWxwZV9h
dWRpb19wbGF0ZGV2X2Rlc3Ryb3koaTkxNSk7Cj4gICAKPiAtCWlycV9mcmVlX2Rlc2MoZGV2X3By
aXYtPmxwZV9hdWRpby5pcnEpOwo+ICsJaXJxX2ZyZWVfZGVzYyhpOTE1LT5scGVfYXVkaW8uaXJx
KTsKPiAgIAo+IC0JZGV2X3ByaXYtPmxwZV9hdWRpby5pcnEgPSAtMTsKPiAtCWRldl9wcml2LT5s
cGVfYXVkaW8ucGxhdGRldiA9IE5VTEw7Cj4gKwlpOTE1LT5scGVfYXVkaW8uaXJxID0gLTE7Cj4g
KwlpOTE1LT5scGVfYXVkaW8ucGxhdGRldiA9IE5VTEw7Cj4gICB9Cj4gICAKPiAgIC8qKgo+ICAg
ICogaW50ZWxfbHBlX2F1ZGlvX25vdGlmeSgpIC0gbm90aWZ5IGxwZSBhdWRpbyBldmVudAo+ICAg
ICogYXVkaW8gZHJpdmVyIGFuZCBpOTE1Cj4gLSAqIEBkZXZfcHJpdjogdGhlIGk5MTUgZHJtIGRl
dmljZSBwcml2YXRlIGRhdGEKPiArICogQGk5MTU6IHRoZSBpOTE1IGRybSBkZXZpY2UgcHJpdmF0
ZSBkYXRhCj4gICAgKiBAcGlwZTogcGlwZQo+ICAgICogQHBvcnQ6IHBvcnQKPiAgICAqIEBlbGQg
OiBFTEQgZGF0YQo+IEBAIC0zMTcsNyArMzE3LDcgQEAgdm9pZCBpbnRlbF9scGVfYXVkaW9fdGVh
cmRvd24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgICoKPiAgICAqIE5v
dGlmeSBscGUgYXVkaW8gZHJpdmVyIG9mIGVsZCBjaGFuZ2UuCj4gICAgKi8KPiAtdm9pZCBpbnRl
bF9scGVfYXVkaW9fbm90aWZ5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAr
dm9pZCBpbnRlbF9scGVfYXVkaW9fbm90aWZ5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAo+ICAgCQkJICAgIGVudW0gcGlwZSBwaXBlLCBlbnVtIHBvcnQgcG9ydCwKPiAgIAkJCSAgICBj
b25zdCB2b2lkICplbGQsIGludCBsc19jbG9jaywgYm9vbCBkcF9vdXRwdXQpCj4gICB7Cj4gQEAg
LTMyNiwxMCArMzI2LDEwIEBAIHZvaWQgaW50ZWxfbHBlX2F1ZGlvX25vdGlmeShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJc3RydWN0IGludGVsX2hkbWlfbHBlX2F1ZGlv
X3BvcnRfcGRhdGEgKnBwZGF0YTsKPiAgIAl1MzIgYXVkaW9fZW5hYmxlOwo+ICAgCj4gLQlpZiAo
IUhBU19MUEVfQVVESU8oZGV2X3ByaXYpKQo+ICsJaWYgKCFIQVNfTFBFX0FVRElPKGk5MTUpKQo+
ICAgCQlyZXR1cm47Cj4gICAKPiAtCXBkYXRhID0gZGV2X2dldF9wbGF0ZGF0YSgmZGV2X3ByaXYt
PmxwZV9hdWRpby5wbGF0ZGV2LT5kZXYpOwo+ICsJcGRhdGEgPSBkZXZfZ2V0X3BsYXRkYXRhKCZp
OTE1LT5scGVfYXVkaW8ucGxhdGRldi0+ZGV2KTsKPiAgIAlwcGRhdGEgPSAmcGRhdGEtPnBvcnRb
cG9ydCAtIFBPUlRfQl07Cj4gICAKPiAgIAlzcGluX2xvY2tfaXJxc2F2ZSgmcGRhdGEtPmxwZV9h
dWRpb19zbG9jaywgaXJxZmxhZ3MpOwo+IEBAIC0zNTcsNyArMzU3LDcgQEAgdm9pZCBpbnRlbF9s
cGVfYXVkaW9fbm90aWZ5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAl9
Cj4gICAKPiAgIAlpZiAocGRhdGEtPm5vdGlmeV9hdWRpb19scGUpCj4gLQkJcGRhdGEtPm5vdGlm
eV9hdWRpb19scGUoZGV2X3ByaXYtPmxwZV9hdWRpby5wbGF0ZGV2LCBwb3J0IC0gUE9SVF9CKTsK
PiArCQlwZGF0YS0+bm90aWZ5X2F1ZGlvX2xwZShpOTE1LT5scGVfYXVkaW8ucGxhdGRldiwgcG9y
dCAtIFBPUlRfQik7Cj4gICAKPiAgIAlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZwZGF0YS0+bHBl
X2F1ZGlvX3Nsb2NrLCBpcnFmbGFncyk7Cj4gICB9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX2xwZV9hdWRpby5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
bHBlX2F1ZGlvLmgKPiBpbmRleCBmODQ4YzUwMzg3MTQuLmRmNDNhYmNlM2M5NSAxMDA2NDQKPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9scGVfYXVkaW8uaAo+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX2xwZV9hdWRpby5oCj4gQEAgLTEyLDEwICsxMiwxMCBAQCBl
bnVtIHBpcGU7Cj4gICBlbnVtIHBvcnQ7Cj4gICBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKPiAg
IAo+IC1pbnQgIGludGVsX2xwZV9hdWRpb19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdik7Cj4gLXZvaWQgaW50ZWxfbHBlX2F1ZGlvX3RlYXJkb3duKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdik7Cj4gLXZvaWQgaW50ZWxfbHBlX2F1ZGlvX2lycV9oYW5kbGVy
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gLXZvaWQgaW50ZWxfbHBlX2F1
ZGlvX25vdGlmeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2ludCAgaW50
ZWxfbHBlX2F1ZGlvX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lk
IGludGVsX2xwZV9hdWRpb190ZWFyZG93bihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7
Cj4gK3ZvaWQgaW50ZWxfbHBlX2F1ZGlvX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KTsKPiArdm9pZCBpbnRlbF9scGVfYXVkaW9fbm90aWZ5KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgIGVudW0gcGlwZSBwaXBlLCBlbnVtIHBvcnQgcG9y
dCwKPiAgIAkJCSAgICBjb25zdCB2b2lkICplbGQsIGludCBsc19jbG9jaywgYm9vbCBkcF9vdXRw
dXQpOwo+ICAgCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2xzcGNv
bi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfbHNwY29uLmMKPiBpbmRleCA3MDI4ZDBj
ZjNiYjEuLjY5NTQ2NWY5NzE5NSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9sc3Bjb24uYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2xzcGNvbi5j
Cj4gQEAgLTU1NSwxMCArNTU1LDEwIEBAIGJvb2wgbHNwY29uX2luaXQoc3RydWN0IGludGVsX2Rp
Z2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQpCj4gICAJc3RydWN0IGludGVsX2RwICpkcCA9ICZp
bnRlbF9kaWdfcG9ydC0+ZHA7Cj4gICAJc3RydWN0IGludGVsX2xzcGNvbiAqbHNwY29uID0gJmlu
dGVsX2RpZ19wb3J0LT5sc3Bjb247Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGludGVs
X2RpZ19wb3J0LT5iYXNlLmJhc2UuZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGRldik7Cj4gICAJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciA9ICZk
cC0+YXR0YWNoZWRfY29ubmVjdG9yLT5iYXNlOwo+ICAgCj4gLQlpZiAoIUhBU19MU1BDT04oZGV2
X3ByaXYpKSB7Cj4gKwlpZiAoIUhBU19MU1BDT04oaTkxNSkpIHsKPiAgIAkJRFJNX0VSUk9SKCJM
U1BDT04gaXMgbm90IHN1cHBvcnRlZCBvbiB0aGlzIHBsYXRmb3JtXG4iKTsKPiAgIAkJcmV0dXJu
IGZhbHNlOwo+ICAgCX0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
bHZkcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfbHZkcy5jCj4gaW5kZXggZWZlZmVk
NjJhN2Y4Li4wNDA1Zjk4MzQ4MjcgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfbHZkcy5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfbHZkcy5jCj4g
QEAgLTgwLDcgKzgwLDcgQEAgc3RhdGljIHN0cnVjdCBpbnRlbF9sdmRzX2VuY29kZXIgKnRvX2x2
ZHNfZW5jb2RlcihzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIpCj4gICAJcmV0dXJuIGNvbnRh
aW5lcl9vZihlbmNvZGVyLCBzdHJ1Y3QgaW50ZWxfbHZkc19lbmNvZGVyLCBiYXNlLmJhc2UpOwo+
ICAgfQo+ICAgCj4gLWJvb2wgaW50ZWxfbHZkc19wb3J0X2VuYWJsZWQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ICtib29sIGludGVsX2x2ZHNfcG9ydF9lbmFibGVkKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgICBpOTE1X3JlZ190IGx2ZHNfcmVn
LCBlbnVtIHBpcGUgKnBpcGUpCj4gICB7Cj4gICAJdTMyIHZhbDsKPiBAQCAtODgsNyArODgsNyBA
QCBib29sIGludGVsX2x2ZHNfcG9ydF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiAgIAl2YWwgPSBJOTE1X1JFQUQobHZkc19yZWcpOwo+ICAgCj4gICAJLyogYXNz
ZXJ0cyB3YW50IHRvIGtub3cgdGhlIHBpcGUgZXZlbiBpZiB0aGUgcG9ydCBpcyBkaXNhYmxlZCAq
Lwo+IC0JaWYgKEhBU19QQ0hfQ1BUKGRldl9wcml2KSkKPiArCWlmIChIQVNfUENIX0NQVChpOTE1
KSkKPiAgIAkJKnBpcGUgPSAodmFsICYgTFZEU19QSVBFX1NFTF9NQVNLX0NQVCkgPj4gTFZEU19Q
SVBFX1NFTF9TSElGVF9DUFQ7Cj4gICAJZWxzZQo+ICAgCQkqcGlwZSA9ICh2YWwgJiBMVkRTX1BJ
UEVfU0VMX01BU0spID4+IExWRFNfUElQRV9TRUxfU0hJRlQ7Cj4gQEAgLTk5LDE5ICs5OSwxOSBA
QCBib29sIGludGVsX2x2ZHNfcG9ydF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiAgIHN0YXRpYyBib29sIGludGVsX2x2ZHNfZ2V0X2h3X3N0YXRlKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCSAgICBlbnVtIHBpcGUgKnBpcGUpCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShl
bmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2x2ZHNfZW5jb2RlciAqbHZkc19l
bmNvZGVyID0gdG9fbHZkc19lbmNvZGVyKCZlbmNvZGVyLT5iYXNlKTsKPiAgIAlpbnRlbF93YWtl
cmVmX3Qgd2FrZXJlZjsKPiAgIAlib29sIHJldDsKPiAgIAo+IC0Jd2FrZXJlZiA9IGludGVsX2Rp
c3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2X3ByaXYsCj4gKwl3YWtlcmVmID0gaW50ZWxf
ZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChpOTE1LAo+ICAgCQkJCQkJICAgICBlbmNvZGVy
LT5wb3dlcl9kb21haW4pOwo+ICAgCWlmICghd2FrZXJlZikKPiAgIAkJcmV0dXJuIGZhbHNlOwo+
ICAgCj4gLQlyZXQgPSBpbnRlbF9sdmRzX3BvcnRfZW5hYmxlZChkZXZfcHJpdiwgbHZkc19lbmNv
ZGVyLT5yZWcsIHBpcGUpOwo+ICsJcmV0ID0gaW50ZWxfbHZkc19wb3J0X2VuYWJsZWQoaTkxNSwg
bHZkc19lbmNvZGVyLT5yZWcsIHBpcGUpOwo+ICAgCj4gLQlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1
dChkZXZfcHJpdiwgZW5jb2Rlci0+cG93ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiArCWludGVsX2Rp
c3BsYXlfcG93ZXJfcHV0KGk5MTUsIGVuY29kZXItPnBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4g
ICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+IEBAIC0xMTksNyArMTE5LDcgQEAgc3RhdGljIGJv
b2wgaW50ZWxfbHZkc19nZXRfaHdfc3RhdGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
Cj4gICBzdGF0aWMgdm9pZCBpbnRlbF9sdmRzX2dldF9jb25maWcoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIsCj4gICAJCQkJICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25m
aWcpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2x2ZHNfZW5jb2Rl
ciAqbHZkc19lbmNvZGVyID0gdG9fbHZkc19lbmNvZGVyKCZlbmNvZGVyLT5iYXNlKTsKPiAgIAl1
MzIgdG1wLCBmbGFncyA9IDA7Cj4gICAKPiBAQCAtMTM3LDEyICsxMzcsMTIgQEAgc3RhdGljIHZv
aWQgaW50ZWxfbHZkc19nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+
ICAgCj4gICAJcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5mbGFncyB8PSBmbGFnczsK
PiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA1KQo+ICsJaWYgKElOVEVMX0dFTihp
OTE1KSA8IDUpCj4gICAJCXBpcGVfY29uZmlnLT5nbWNoX3BmaXQubHZkc19ib3JkZXJfYml0cyA9
Cj4gICAJCQl0bXAgJiBMVkRTX0JPUkRFUl9FTkFCTEU7Cj4gICAKPiAgIAkvKiBnZW4yLzMgc3Rv
cmUgZGl0aGVyIHN0YXRlIGluIHBmaXQgY29udHJvbCwgbmVlZHMgdG8gbWF0Y2ggKi8KPiAtCWlm
IChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNCkgewo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8IDQp
IHsKPiAgIAkJdG1wID0gSTkxNV9SRUFEKFBGSVRfQ09OVFJPTCk7Cj4gICAKPiAgIAkJcGlwZV9j
b25maWctPmdtY2hfcGZpdC5jb250cm9sIHw9IHRtcCAmIFBBTkVMXzhUTzZfRElUSEVSX0VOQUJM
RTsKPiBAQCAtMTUxLDcgKzE1MSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2x2ZHNfZ2V0X2NvbmZp
ZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAlwaXBlX2NvbmZpZy0+YmFzZS5h
ZGp1c3RlZF9tb2RlLmNydGNfY2xvY2sgPSBwaXBlX2NvbmZpZy0+cG9ydF9jbG9jazsKPiAgIH0K
PiAgIAo+IC1zdGF0aWMgdm9pZCBpbnRlbF9sdmRzX3Bwc19nZXRfaHdfc3RhdGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBpbnRlbF9sdmRzX3Bwc19n
ZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJCXN0cnVj
dCBpbnRlbF9sdmRzX3BwcyAqcHBzKQo+ICAgewo+ICAgCXUzMiB2YWw7Cj4gQEAgLTE4MCw3ICsx
ODAsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9sdmRzX3Bwc19nZXRfaHdfc3RhdGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCS8qIENvbnZlcnQgZnJvbSAxMDBtcyB0byAx
MDB1cyB1bml0cyAqLwo+ICAgCXBwcy0+dDQgPSB2YWwgKiAxMDAwOwo+ICAgCj4gLQlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA8PSA0ICYmCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDw9IDQgJiYK
PiAgIAkgICAgcHBzLT50MV90MiA9PSAwICYmIHBwcy0+dDUgPT0gMCAmJiBwcHMtPnQzID09IDAg
JiYgcHBzLT50eCA9PSAwKSB7Cj4gICAJCURSTV9ERUJVR19LTVMoIlBhbmVsIHBvd2VyIHRpbWlu
Z3MgdW5pbml0aWFsaXplZCwgIgo+ICAgCQkJICAgICAgInNldHRpbmcgZGVmYXVsdHNcbiIpOwo+
IEBAIC0xOTgsNyArMTk4LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfbHZkc19wcHNfZ2V0X2h3X3N0
YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkJCSBwcHMtPmRpdmlk
ZXIsIHBwcy0+cG9ydCwgcHBzLT5wb3dlcmRvd25fb25fcmVzZXQpOwo+ICAgfQo+ICAgCj4gLXN0
YXRpYyB2b2lkIGludGVsX2x2ZHNfcHBzX2luaXRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBpbnRlbF9sdmRzX3Bwc19pbml0X2h3KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgIHN0cnVjdCBpbnRlbF9sdmRzX3BwcyAq
cHBzKQo+ICAgewo+ICAgCXUzMiB2YWw7Cj4gQEAgLTIyOSwyNiArMjI5LDI2IEBAIHN0YXRpYyB2
b2lkIGludGVsX3ByZV9lbmFibGVfbHZkcyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwK
PiAgIAkJCQkgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+
ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9sdmRzX2VuY29kZXIgKmx2ZHNfZW5jb2RlciA9IHRvX2x2
ZHNfZW5jb2RlcigmZW5jb2Rlci0+YmFzZSk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0
IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT5iYXNlLmNydGMp
Owo+ICAgCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBp
cGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gICAJaW50IHBpcGUgPSBjcnRjLT5waXBl
Owo+ICAgCXUzMiB0ZW1wOwo+ICAgCj4gLQlpZiAoSEFTX1BDSF9TUExJVChkZXZfcHJpdikpIHsK
PiAtCQlhc3NlcnRfZmRpX3J4X3BsbF9kaXNhYmxlZChkZXZfcHJpdiwgcGlwZSk7Cj4gLQkJYXNz
ZXJ0X3NoYXJlZF9kcGxsX2Rpc2FibGVkKGRldl9wcml2LAo+ICsJaWYgKEhBU19QQ0hfU1BMSVQo
aTkxNSkpIHsKPiArCQlhc3NlcnRfZmRpX3J4X3BsbF9kaXNhYmxlZChpOTE1LCBwaXBlKTsKPiAr
CQlhc3NlcnRfc2hhcmVkX2RwbGxfZGlzYWJsZWQoaTkxNSwKPiAgIAkJCQkJICAgIHBpcGVfY29u
ZmlnLT5zaGFyZWRfZHBsbCk7Cj4gICAJfSBlbHNlIHsKPiAtCQlhc3NlcnRfcGxsX2Rpc2FibGVk
KGRldl9wcml2LCBwaXBlKTsKPiArCQlhc3NlcnRfcGxsX2Rpc2FibGVkKGk5MTUsIHBpcGUpOwo+
ICAgCX0KPiAgIAo+IC0JaW50ZWxfbHZkc19wcHNfaW5pdF9odyhkZXZfcHJpdiwgJmx2ZHNfZW5j
b2Rlci0+aW5pdF9wcHMpOwo+ICsJaW50ZWxfbHZkc19wcHNfaW5pdF9odyhpOTE1LCAmbHZkc19l
bmNvZGVyLT5pbml0X3Bwcyk7Cj4gICAKPiAgIAl0ZW1wID0gbHZkc19lbmNvZGVyLT5pbml0X2x2
ZHNfdmFsOwo+ICAgCXRlbXAgfD0gTFZEU19QT1JUX0VOIHwgTFZEU19BMEEyX0NMS0FfUE9XRVJf
VVA7Cj4gICAKPiAtCWlmIChIQVNfUENIX0NQVChkZXZfcHJpdikpIHsKPiArCWlmIChIQVNfUENI
X0NQVChpOTE1KSkgewo+ICAgCQl0ZW1wICY9IH5MVkRTX1BJUEVfU0VMX01BU0tfQ1BUOwo+ICAg
CQl0ZW1wIHw9IExWRFNfUElQRV9TRUxfQ1BUKHBpcGUpOwo+ICAgCX0gZWxzZSB7Cj4gQEAgLTI4
Myw3ICsyODMsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wcmVfZW5hYmxlX2x2ZHMoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJICogc3BlY2lhbCBsdmRzIGRpdGhlciBjb250cm9s
IGJpdCBvbiBwY2gtc3BsaXQgcGxhdGZvcm1zLCBkaXRoZXJpbmcgaXMKPiAgIAkgKiBvbmx5IGNv
bnRyb2xsZWQgdGhyb3VnaCB0aGUgUElQRUNPTkYgcmVnLgo+ICAgCSAqLwo+IC0JaWYgKElTX0dF
TihkZXZfcHJpdiwgNCkpIHsKPiArCWlmIChJU19HRU4oaTkxNSwgNCkpIHsKPiAgIAkJLyoKPiAg
IAkJICogQnNwZWMgd29yZGluZyBzdWdnZXN0cyB0aGF0IExWRFMgcG9ydCBkaXRoZXJpbmcgb25s
eSBleGlzdHMKPiAgIAkJICogZm9yIDE4YnBwIHBhbmVscy4KPiBAQCAtMzExLDE0ICszMTEsMTQg
QEAgc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX2x2ZHMoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCj4gICB7Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGVuY29kZXItPmJhc2Uu
ZGV2Owo+ICAgCXN0cnVjdCBpbnRlbF9sdmRzX2VuY29kZXIgKmx2ZHNfZW5jb2RlciA9IHRvX2x2
ZHNfZW5jb2RlcigmZW5jb2Rlci0+YmFzZSk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoZGV2KTsKPiAgIAo+ICAgCUk5MTVfV1JJVEUobHZkc19lbmNvZGVyLT5yZWcs
IEk5MTVfUkVBRChsdmRzX2VuY29kZXItPnJlZykgfCBMVkRTX1BPUlRfRU4pOwo+ICAgCj4gICAJ
STkxNV9XUklURShQUF9DT05UUk9MKDApLCBJOTE1X1JFQUQoUFBfQ09OVFJPTCgwKSkgfCBQQU5F
TF9QT1dFUl9PTik7Cj4gICAJUE9TVElOR19SRUFEKGx2ZHNfZW5jb2Rlci0+cmVnKTsKPiAgIAo+
IC0JaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLAo+ICsJaWYg
KGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsCj4gICAJCQkJICAgIFBQX1NU
QVRVUygwKSwgUFBfT04sIFBQX09OLCA1MDAwKSkKPiAgIAkJRFJNX0VSUk9SKCJ0aW1lZCBvdXQg
d2FpdGluZyBmb3IgcGFuZWwgdG8gcG93ZXIgb25cbiIpOwo+ICAgCj4gQEAgLTMzMCwxMCArMzMw
LDEwIEBAIHN0YXRpYyB2b2lkIGludGVsX2Rpc2FibGVfbHZkcyhzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiAgIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0
ZSAqb2xkX2Nvbm5fc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2x2ZHNfZW5jb2RlciAq
bHZkc19lbmNvZGVyID0gdG9fbHZkc19lbmNvZGVyKCZlbmNvZGVyLT5iYXNlKTsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiAgIAo+ICAgCUk5MTVfV1JJVEUoUFBfQ09OVFJPTCgwKSwgSTkxNV9SRUFEKFBQ
X0NPTlRST0woMCkpICYgflBBTkVMX1BPV0VSX09OKTsKPiAtCWlmIChpbnRlbF93YWl0X2Zvcl9y
ZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwKPiArCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3Rl
cigmaTkxNS0+dW5jb3JlLAo+ICAgCQkJCSAgICBQUF9TVEFUVVMoMCksIFBQX09OLCAwLCAxMDAw
KSkKPiAgIAkJRFJNX0VSUk9SKCJ0aW1lZCBvdXQgd2FpdGluZyBmb3IgcGFuZWwgdG8gcG93ZXIg
b2ZmXG4iKTsKPiAgIAo+IEBAIC0zODksNyArMzg5LDcgQEAgc3RhdGljIGludCBpbnRlbF9sdmRz
X2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICppbnRlbF9lbmNvZGVyLAo+ICAg
CQkJCSAgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ICAgCQkJCSAg
ICAgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4gICB7Cj4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGludGVsX2VuY29kZXItPmJh
c2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShpbnRl
bF9lbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2x2ZHNfZW5jb2RlciAqbHZk
c19lbmNvZGVyID0KPiAgIAkJdG9fbHZkc19lbmNvZGVyKCZpbnRlbF9lbmNvZGVyLT5iYXNlKTsK
PiAgIAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICppbnRlbF9jb25uZWN0b3IgPQo+IEBAIC0zOTks
NyArMzk5LDcgQEAgc3RhdGljIGludCBpbnRlbF9sdmRzX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICppbnRlbF9lbmNvZGVyLAo+ICAgCXVuc2lnbmVkIGludCBsdmRzX2JwcDsK
PiAgIAo+ICAgCS8qIFNob3VsZCBuZXZlciBoYXBwZW4hISAqLwo+IC0JaWYgKElOVEVMX0dFTihk
ZXZfcHJpdikgPCA0ICYmIGludGVsX2NydGMtPnBpcGUgPT0gMCkgewo+ICsJaWYgKElOVEVMX0dF
TihpOTE1KSA8IDQgJiYgaW50ZWxfY3J0Yy0+cGlwZSA9PSAwKSB7Cj4gICAJCURSTV9FUlJPUigi
Q2FuJ3Qgc3VwcG9ydCBMVkRTIG9uIHBpcGUgQVxuIik7Cj4gICAJCXJldHVybiAtRUlOVkFMOwo+
ICAgCX0KPiBAQCAtNDI5LDcgKzQyOSw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfbHZkc19jb21wdXRl
X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqaW50ZWxfZW5jb2RlciwKPiAgIAlpZiAoYWRq
dXN0ZWRfbW9kZS0+ZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX0RCTFNDQU4pCj4gICAJCXJldHVybiAt
RUlOVkFMOwo+ICAgCj4gLQlpZiAoSEFTX1BDSF9TUExJVChkZXZfcHJpdikpIHsKPiArCWlmIChI
QVNfUENIX1NQTElUKGk5MTUpKSB7Cj4gICAJCXBpcGVfY29uZmlnLT5oYXNfcGNoX2VuY29kZXIg
PSB0cnVlOwo+ICAgCj4gICAJCWludGVsX3BjaF9wYW5lbF9maXR0aW5nKGludGVsX2NydGMsIHBp
cGVfY29uZmlnLAo+IEBAIC03NTEsMTEgKzc1MSwxMSBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGRt
aV9zeXN0ZW1faWQgaW50ZWxfZHVhbF9saW5rX2x2ZHNbXSA9IHsKPiAgIAl7IH0JLyogdGVybWlu
YXRpbmcgZW50cnkgKi8KPiAgIH07Cj4gICAKPiAtc3RydWN0IGludGVsX2VuY29kZXIgKmludGVs
X2dldF9sdmRzX2VuY29kZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqaW50ZWxfZ2V0X2x2ZHNfZW5jb2RlcihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
cjsKPiAgIAo+IC0JZm9yX2VhY2hfaW50ZWxfZW5jb2RlcigmZGV2X3ByaXYtPmRybSwgZW5jb2Rl
cikgewo+ICsJZm9yX2VhY2hfaW50ZWxfZW5jb2RlcigmaTkxNS0+ZHJtLCBlbmNvZGVyKSB7Cj4g
ICAJCWlmIChlbmNvZGVyLT50eXBlID09IElOVEVMX09VVFBVVF9MVkRTKQo+ICAgCQkJcmV0dXJu
IGVuY29kZXI7Cj4gICAJfQo+IEBAIC03NjMsOSArNzYzLDkgQEAgc3RydWN0IGludGVsX2VuY29k
ZXIgKmludGVsX2dldF9sdmRzX2VuY29kZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICAgCXJldHVybiBOVUxMOwo+ICAgfQo+ICAgCj4gLWJvb2wgaW50ZWxfaXNfZHVhbF9s
aW5rX2x2ZHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtib29sIGludGVs
X2lzX2R1YWxfbGlua19sdmRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+
IC0Jc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIgPSBpbnRlbF9nZXRfbHZkc19lbmNvZGVy
KGRldl9wcml2KTsKPiArCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyID0gaW50ZWxfZ2V0
X2x2ZHNfZW5jb2RlcihpOTE1KTsKPiAgIAo+ICAgCXJldHVybiBlbmNvZGVyICYmIHRvX2x2ZHNf
ZW5jb2RlcigmZW5jb2Rlci0+YmFzZSktPmlzX2R1YWxfbGluazsKPiAgIH0KPiBAQCAtNzc0LDcg
Kzc3NCw3IEBAIHN0YXRpYyBib29sIGNvbXB1dGVfaXNfZHVhbF9saW5rX2x2ZHMoc3RydWN0IGlu
dGVsX2x2ZHNfZW5jb2RlciAqbHZkc19lbmNvZGVyKQo+ICAgewo+ICAgCXN0cnVjdCBkcm1fZGV2
aWNlICpkZXYgPSBsdmRzX2VuY29kZXItPmJhc2UuYmFzZS5kZXY7Cj4gICAJdW5zaWduZWQgaW50
IHZhbDsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2
KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAg
Cj4gICAJLyogdXNlIHRoZSBtb2R1bGUgb3B0aW9uIHZhbHVlIGlmIHNwZWNpZmllZCAqLwo+ICAg
CWlmIChpOTE1X21vZHBhcmFtcy5sdmRzX2NoYW5uZWxfbW9kZSA+IDApCj4gQEAgLTc5NCwyNiAr
Nzk0LDI2IEBAIHN0YXRpYyBib29sIGNvbXB1dGVfaXNfZHVhbF9saW5rX2x2ZHMoc3RydWN0IGlu
dGVsX2x2ZHNfZW5jb2RlciAqbHZkc19lbmNvZGVyKQo+ICAgCSAqIHJlZ2lzdGVyIGlzIHVuaW5p
dGlhbGl6ZWQuCj4gICAJICovCj4gICAJdmFsID0gSTkxNV9SRUFEKGx2ZHNfZW5jb2Rlci0+cmVn
KTsKPiAtCWlmIChIQVNfUENIX0NQVChkZXZfcHJpdikpCj4gKwlpZiAoSEFTX1BDSF9DUFQoaTkx
NSkpCj4gICAJCXZhbCAmPSB+KExWRFNfREVURUNURUQgfCBMVkRTX1BJUEVfU0VMX01BU0tfQ1BU
KTsKPiAgIAllbHNlCj4gICAJCXZhbCAmPSB+KExWRFNfREVURUNURUQgfCBMVkRTX1BJUEVfU0VM
X01BU0spOwo+ICAgCWlmICh2YWwgPT0gMCkKPiAtCQl2YWwgPSBkZXZfcHJpdi0+dmJ0LmJpb3Nf
bHZkc192YWw7Cj4gKwkJdmFsID0gaTkxNS0+dmJ0LmJpb3NfbHZkc192YWw7Cj4gICAKPiAgIAly
ZXR1cm4gKHZhbCAmIExWRFNfQ0xLQl9QT1dFUl9NQVNLKSA9PSBMVkRTX0NMS0JfUE9XRVJfVVA7
Cj4gICB9Cj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxfbHZkc19pbml0IC0gc2V0dXAgTFZEUyBj
b25uZWN0b3JzIG9uIHRoaXMgZGV2aWNlCj4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UKPiAr
ICogQGk5MTU6IGk5MTUgZGV2aWNlCj4gICAgKgo+ICAgICogQ3JlYXRlIHRoZSBjb25uZWN0b3Is
IHJlZ2lzdGVyIHRoZSBMVkRTIEREQyBidXMsIGFuZCB0cnkgdG8gZmlndXJlIG91dCB3aGF0Cj4g
ICAgKiBtb2RlcyB3ZSBjYW4gZGlzcGxheSBvbiB0aGUgTFZEUyBwYW5lbCAoaWYgcHJlc2VudCku
Cj4gICAgKi8KPiAtdm9pZCBpbnRlbF9sdmRzX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICt2b2lkIGludGVsX2x2ZHNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRy
bTsKPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+ICAgCXN0cnVjdCBp
bnRlbF9sdmRzX2VuY29kZXIgKmx2ZHNfZW5jb2RlcjsKPiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqaW50ZWxfZW5jb2RlcjsKPiAgIAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICppbnRlbF9jb25u
ZWN0b3I7Cj4gQEAgLTgyOSwzMCArODI5LDMwIEBAIHZvaWQgaW50ZWxfbHZkc19pbml0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAo+ICAgCS8qIFNraXAgaW5pdCBvbiBt
YWNoaW5lcyB3ZSBrbm93IGZhbHNlbHkgcmVwb3J0IExWRFMgKi8KPiAgIAlpZiAoZG1pX2NoZWNr
X3N5c3RlbShpbnRlbF9ub19sdmRzKSkgewo+IC0JCVdBUk4oIWRldl9wcml2LT52YnQuaW50X2x2
ZHNfc3VwcG9ydCwKPiArCQlXQVJOKCFpOTE1LT52YnQuaW50X2x2ZHNfc3VwcG9ydCwKPiAgIAkJ
ICAgICAiVXNlbGVzcyBETUkgbWF0Y2guIEludGVybmFsIExWRFMgc3VwcG9ydCBkaXNhYmxlZCBi
eSBWQlRcbiIpOwo+ICAgCQlyZXR1cm47Cj4gICAJfQo+ICAgCj4gLQlpZiAoIWRldl9wcml2LT52
YnQuaW50X2x2ZHNfc3VwcG9ydCkgewo+ICsJaWYgKCFpOTE1LT52YnQuaW50X2x2ZHNfc3VwcG9y
dCkgewo+ICAgCQlEUk1fREVCVUdfS01TKCJJbnRlcm5hbCBMVkRTIHN1cHBvcnQgZGlzYWJsZWQg
YnkgVkJUXG4iKTsKPiAgIAkJcmV0dXJuOwo+ICAgCX0KPiAgIAo+IC0JaWYgKEhBU19QQ0hfU1BM
SVQoZGV2X3ByaXYpKQo+ICsJaWYgKEhBU19QQ0hfU1BMSVQoaTkxNSkpCj4gICAJCWx2ZHNfcmVn
ID0gUENIX0xWRFM7Cj4gICAJZWxzZQo+ICAgCQlsdmRzX3JlZyA9IExWRFM7Cj4gICAKPiAgIAls
dmRzID0gSTkxNV9SRUFEKGx2ZHNfcmVnKTsKPiAgIAo+IC0JaWYgKEhBU19QQ0hfU1BMSVQoZGV2
X3ByaXYpKSB7Cj4gKwlpZiAoSEFTX1BDSF9TUExJVChpOTE1KSkgewo+ICAgCQlpZiAoKGx2ZHMg
JiBMVkRTX0RFVEVDVEVEKSA9PSAwKQo+ICAgCQkJcmV0dXJuOwo+ICAgCX0KPiAgIAo+ICAgCXBp
biA9IEdNQlVTX1BJTl9QQU5FTDsKPiAtCWlmICghaW50ZWxfYmlvc19pc19sdmRzX3ByZXNlbnQo
ZGV2X3ByaXYsICZwaW4pKSB7Cj4gKwlpZiAoIWludGVsX2Jpb3NfaXNfbHZkc19wcmVzZW50KGk5
MTUsICZwaW4pKSB7Cj4gICAJCWlmICgobHZkcyAmIExWRFNfUE9SVF9FTikgPT0gMCkgewo+ICAg
CQkJRFJNX0RFQlVHX0tNUygiTFZEUyBpcyBub3QgcHJlc2VudCBpbiBWQlRcbiIpOwo+ICAgCQkJ
cmV0dXJuOwo+IEBAIC04ODQsNyArODg0LDcgQEAgdm9pZCBpbnRlbF9sdmRzX2luaXQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCWludGVsX2VuY29kZXItPmVuYWJsZSA9
IGludGVsX2VuYWJsZV9sdmRzOwo+ICAgCWludGVsX2VuY29kZXItPnByZV9lbmFibGUgPSBpbnRl
bF9wcmVfZW5hYmxlX2x2ZHM7Cj4gICAJaW50ZWxfZW5jb2Rlci0+Y29tcHV0ZV9jb25maWcgPSBp
bnRlbF9sdmRzX2NvbXB1dGVfY29uZmlnOwo+IC0JaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3ByaXYp
KSB7Cj4gKwlpZiAoSEFTX1BDSF9TUExJVChpOTE1KSkgewo+ICAgCQlpbnRlbF9lbmNvZGVyLT5k
aXNhYmxlID0gcGNoX2Rpc2FibGVfbHZkczsKPiAgIAkJaW50ZWxfZW5jb2Rlci0+cG9zdF9kaXNh
YmxlID0gcGNoX3Bvc3RfZGlzYWJsZV9sdmRzOwo+ICAgCX0gZWxzZSB7Cj4gQEAgLTkwMSw5ICs5
MDEsOSBAQCB2b2lkIGludGVsX2x2ZHNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gICAJaW50ZWxfZW5jb2Rlci0+cG93ZXJfZG9tYWluID0gUE9XRVJfRE9NQUlOX1BP
UlRfT1RIRVI7Cj4gICAJaW50ZWxfZW5jb2Rlci0+cG9ydCA9IFBPUlRfTk9ORTsKPiAgIAlpbnRl
bF9lbmNvZGVyLT5jbG9uZWFibGUgPSAwOwo+IC0JaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3ByaXYp
KQo+ICsJaWYgKEhBU19QQ0hfU1BMSVQoaTkxNSkpCj4gICAJCWludGVsX2VuY29kZXItPmNydGNf
bWFzayA9ICgxIDw8IDApIHwgKDEgPDwgMSkgfCAoMSA8PCAyKTsKPiAtCWVsc2UgaWYgKElTX0dF
TihkZXZfcHJpdiwgNCkpCj4gKwllbHNlIGlmIChJU19HRU4oaTkxNSwgNCkpCj4gICAJCWludGVs
X2VuY29kZXItPmNydGNfbWFzayA9ICgxIDw8IDApIHwgKDEgPDwgMSk7Cj4gICAJZWxzZQo+ICAg
CQlpbnRlbF9lbmNvZGVyLT5jcnRjX21hc2sgPSAoMSA8PCAxKTsKPiBAQCAtOTIyLDcgKzkyMiw3
IEBAIHZvaWQgaW50ZWxfbHZkc19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiAgIAlkcm1fY29ubmVjdG9yX2F0dGFjaF9zY2FsaW5nX21vZGVfcHJvcGVydHkoY29ubmVj
dG9yLCBhbGxvd2VkX3NjYWxlcnMpOwo+ICAgCWNvbm5lY3Rvci0+c3RhdGUtPnNjYWxpbmdfbW9k
ZSA9IERSTV9NT0RFX1NDQUxFX0FTUEVDVDsKPiAgIAo+IC0JaW50ZWxfbHZkc19wcHNfZ2V0X2h3
X3N0YXRlKGRldl9wcml2LCAmbHZkc19lbmNvZGVyLT5pbml0X3Bwcyk7Cj4gKwlpbnRlbF9sdmRz
X3Bwc19nZXRfaHdfc3RhdGUoaTkxNSwgJmx2ZHNfZW5jb2Rlci0+aW5pdF9wcHMpOwo+ICAgCWx2
ZHNfZW5jb2Rlci0+aW5pdF9sdmRzX3ZhbCA9IGx2ZHM7Cj4gICAKPiAgIAkvKgo+IEBAIC05NDAs
MTAgKzk0MCwxMCBAQCB2b2lkIGludGVsX2x2ZHNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gICAJbXV0ZXhfbG9jaygmZGV2LT5tb2RlX2NvbmZpZy5tdXRleCk7Cj4g
ICAJaWYgKHZnYV9zd2l0Y2hlcm9vX2hhbmRsZXJfZmxhZ3MoKSAmIFZHQV9TV0lUQ0hFUk9PX0NB
Tl9TV0lUQ0hfRERDKQo+ICAgCQllZGlkID0gZHJtX2dldF9lZGlkX3N3aXRjaGVyb28oY29ubmVj
dG9yLAo+IC0JCQkJICAgIGludGVsX2dtYnVzX2dldF9hZGFwdGVyKGRldl9wcml2LCBwaW4pKTsK
PiArCQkJCSAgICBpbnRlbF9nbWJ1c19nZXRfYWRhcHRlcihpOTE1LCBwaW4pKTsKPiAgIAllbHNl
Cj4gICAJCWVkaWQgPSBkcm1fZ2V0X2VkaWQoY29ubmVjdG9yLAo+IC0JCQkJICAgIGludGVsX2dt
YnVzX2dldF9hZGFwdGVyKGRldl9wcml2LCBwaW4pKTsKPiArCQkJCSAgICBpbnRlbF9nbWJ1c19n
ZXRfYWRhcHRlcihpOTE1LCBwaW4pKTsKPiAgIAlpZiAoZWRpZCkgewo+ICAgCQlpZiAoZHJtX2Fk
ZF9lZGlkX21vZGVzKGNvbm5lY3RvciwgZWRpZCkpIHsKPiAgIAkJCWRybV9jb25uZWN0b3JfdXBk
YXRlX2VkaWRfcHJvcGVydHkoY29ubmVjdG9yLAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9sdmRzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9sdmRzLmgK
PiBpbmRleCBiYzljOGI4NGJhMmYuLjRhZmRjYjRkNjM1MiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9sdmRzLmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9sdmRzLmgKPiBAQCAtMTMsMTAgKzEzLDEwIEBACj4gICBlbnVtIHBpcGU7Cj4gICBzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKPiAgIAo+IC1ib29sIGludGVsX2x2ZHNfcG9ydF9lbmFibGVk
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArYm9vbCBpbnRlbF9sdmRzX3Bv
cnRfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgaTkx
NV9yZWdfdCBsdmRzX3JlZywgZW51bSBwaXBlICpwaXBlKTsKPiAtdm9pZCBpbnRlbF9sdmRzX2lu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtc3RydWN0IGludGVsX2Vu
Y29kZXIgKmludGVsX2dldF9sdmRzX2VuY29kZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KTsKPiAtYm9vbCBpbnRlbF9pc19kdWFsX2xpbmtfbHZkcyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpOwo+ICt2b2lkIGludGVsX2x2ZHNfaW5pdChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3N0cnVjdCBpbnRlbF9lbmNvZGVyICppbnRlbF9nZXRfbHZk
c19lbmNvZGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiArYm9vbCBpbnRlbF9p
c19kdWFsX2xpbmtfbHZkcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICAKPiAg
ICNlbmRpZiAvKiBfX0lOVEVMX0xWRFNfSF9fICovCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX29wcmVnaW9uLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9v
cHJlZ2lvbi5jCj4gaW5kZXggOGZhMTE1OWQwOTdmLi42Y2JlNzc1ZDc1MzcgMTAwNjQ0Cj4gLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfb3ByZWdpb24uYwo+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX29wcmVnaW9uLmMKPiBAQCAtMjY2LDExICsyNjYsMTEgQEAgc3Ry
dWN0IG9wcmVnaW9uX2FzbGVfZXh0IHsKPiAgIAo+ICAgI2RlZmluZSBNQVhfRFNMUAkxNTAwCj4g
ICAKPiAtc3RhdGljIGludCBzd3NjaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gK3N0YXRpYyBpbnQgc3dzY2koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJ
CSB1MzIgZnVuY3Rpb24sIHUzMiBwYXJtLCB1MzIgKnBhcm1fb3V0KQo+ICAgewo+IC0Jc3RydWN0
IG9wcmVnaW9uX3N3c2NpICpzd3NjaSA9IGRldl9wcml2LT5vcHJlZ2lvbi5zd3NjaTsKPiAtCXN0
cnVjdCBwY2lfZGV2ICpwZGV2ID0gZGV2X3ByaXYtPmRybS5wZGV2Owo+ICsJc3RydWN0IG9wcmVn
aW9uX3N3c2NpICpzd3NjaSA9IGk5MTUtPm9wcmVnaW9uLnN3c2NpOwo+ICsJc3RydWN0IHBjaV9k
ZXYgKnBkZXYgPSBpOTE1LT5kcm0ucGRldjsKPiAgIAl1MzIgbWFpbl9mdW5jdGlvbiwgc3ViX2Z1
bmN0aW9uLCBzY2ljOwo+ICAgCXUxNiBzd3NjaV92YWw7Cj4gICAJdTMyIGRzbHA7Cj4gQEAgLTI4
NSwxMSArMjg1LDExIEBAIHN0YXRpYyBpbnQgc3dzY2koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICAgCj4gICAJLyogQ2hlY2sgaWYgd2UgY2FuIGNhbGwgdGhlIGZ1bmN0aW9u
LiBTZWUgc3dzY2lfc2V0dXAgZm9yIGRldGFpbHMuICovCj4gICAJaWYgKG1haW5fZnVuY3Rpb24g
PT0gU1dTQ0lfU0JDQikgewo+IC0JCWlmICgoZGV2X3ByaXYtPm9wcmVnaW9uLnN3c2NpX3NiY2Jf
c3ViX2Z1bmN0aW9ucyAmCj4gKwkJaWYgKChpOTE1LT5vcHJlZ2lvbi5zd3NjaV9zYmNiX3N1Yl9m
dW5jdGlvbnMgJgo+ICAgCQkgICAgICgxIDw8IHN1Yl9mdW5jdGlvbikpID09IDApCj4gICAJCQly
ZXR1cm4gLUVJTlZBTDsKPiAgIAl9IGVsc2UgaWYgKG1haW5fZnVuY3Rpb24gPT0gU1dTQ0lfR0JE
QSkgewo+IC0JCWlmICgoZGV2X3ByaXYtPm9wcmVnaW9uLnN3c2NpX2diZGFfc3ViX2Z1bmN0aW9u
cyAmCj4gKwkJaWYgKChpOTE1LT5vcHJlZ2lvbi5zd3NjaV9nYmRhX3N1Yl9mdW5jdGlvbnMgJgo+
ICAgCQkgICAgICgxIDw8IHN1Yl9mdW5jdGlvbikpID09IDApCj4gICAJCQlyZXR1cm4gLUVJTlZB
TDsKPiAgIAl9Cj4gQEAgLTM2MywxMyArMzYzLDEzIEBAIHN0YXRpYyBpbnQgc3dzY2koc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgaW50IGludGVsX29wcmVnaW9uX25vdGlm
eV9lbmNvZGVyKHN0cnVjdCBpbnRlbF9lbmNvZGVyICppbnRlbF9lbmNvZGVyLAo+ICAgCQkJCSAg
Ym9vbCBlbmFibGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGludGVsX2VuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShpbnRlbF9lbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJdTMy
IHBhcm0gPSAwOwo+ICAgCXUzMiB0eXBlID0gMDsKPiAgIAl1MzIgcG9ydDsKPiAgIAo+ICAgCS8q
IGRvbid0IGNhcmUgYWJvdXQgb2xkIHN0dWZmIGZvciBub3cgKi8KPiAtCWlmICghSEFTX0RESShk
ZXZfcHJpdikpCj4gKwlpZiAoIUhBU19EREkoaTkxNSkpCj4gICAJCXJldHVybiAwOwo+ICAgCj4g
ICAJaWYgKGludGVsX2VuY29kZXItPnR5cGUgPT0gSU5URUxfT1VUUFVUX0RTSSkKPiBAQCAtNDA5
LDcgKzQwOSw3IEBAIGludCBpbnRlbF9vcHJlZ2lvbl9ub3RpZnlfZW5jb2RlcihzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqaW50ZWxfZW5jb2RlciwKPiAgIAo+ICAgCXBhcm0gfD0gdHlwZSA8PCAoMTYg
KyBwb3J0ICogMyk7Cj4gICAKPiAtCXJldHVybiBzd3NjaShkZXZfcHJpdiwgU1dTQ0lfU0JDQl9E
SVNQTEFZX1BPV0VSX1NUQVRFLCBwYXJtLCBOVUxMKTsKPiArCXJldHVybiBzd3NjaShpOTE1LCBT
V1NDSV9TQkNCX0RJU1BMQVlfUE9XRVJfU1RBVEUsIHBhcm0sIE5VTEwpOwo+ICAgfQo+ICAgCj4g
ICBzdGF0aWMgY29uc3Qgc3RydWN0IHsKPiBAQCAtNDIzLDI5ICs0MjMsMjkgQEAgc3RhdGljIGNv
bnN0IHN0cnVjdCB7Cj4gICAJeyBQQ0lfRDNjb2xkLAkweDA0IH0sCj4gICB9Owo+ICAgCj4gLWlu
dCBpbnRlbF9vcHJlZ2lvbl9ub3RpZnlfYWRhcHRlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gK2ludCBpbnRlbF9vcHJlZ2lvbl9ub3RpZnlfYWRhcHRlcihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgIHBjaV9wb3dlcl90IHN0YXRlKQo+ICAgewo+
ICAgCWludCBpOwo+ICAgCj4gLQlpZiAoIUhBU19EREkoZGV2X3ByaXYpKQo+ICsJaWYgKCFIQVNf
RERJKGk5MTUpKQo+ICAgCQlyZXR1cm4gMDsKPiAgIAo+ICAgCWZvciAoaSA9IDA7IGkgPCBBUlJB
WV9TSVpFKHBvd2VyX3N0YXRlX21hcCk7IGkrKykgewo+ICAgCQlpZiAoc3RhdGUgPT0gcG93ZXJf
c3RhdGVfbWFwW2ldLnBjaV9wb3dlcl9zdGF0ZSkKPiAtCQkJcmV0dXJuIHN3c2NpKGRldl9wcml2
LCBTV1NDSV9TQkNCX0FEQVBURVJfUE9XRVJfU1RBVEUsCj4gKwkJCXJldHVybiBzd3NjaShpOTE1
LCBTV1NDSV9TQkNCX0FEQVBURVJfUE9XRVJfU1RBVEUsCj4gICAJCQkJICAgICBwb3dlcl9zdGF0
ZV9tYXBbaV0ucGFybSwgTlVMTCk7Cj4gICAJfQo+ICAgCj4gICAJcmV0dXJuIC1FSU5WQUw7Cj4g
ICB9Cj4gICAKPiAtc3RhdGljIHUzMiBhc2xlX3NldF9iYWNrbGlnaHQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgYmNscCkKPiArc3RhdGljIHUzMiBhc2xlX3NldF9iYWNr
bGlnaHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBiY2xwKQo+ICAgewo+ICAg
CXN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcjsKPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5l
Y3Rvcl9saXN0X2l0ZXIgY29ubl9pdGVyOwo+IC0Jc3RydWN0IG9wcmVnaW9uX2FzbGUgKmFzbGUg
PSBkZXZfcHJpdi0+b3ByZWdpb24uYXNsZTsKPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAm
ZGV2X3ByaXYtPmRybTsKPiArCXN0cnVjdCBvcHJlZ2lvbl9hc2xlICphc2xlID0gaTkxNS0+b3By
ZWdpb24uYXNsZTsKPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+ICAg
Cj4gICAJRFJNX0RFQlVHX0RSSVZFUigiYmNscCA9IDB4JTA4eFxuIiwgYmNscCk7Cj4gICAKPiBA
QCAtNDgwLDcgKzQ4MCw3IEBAIHN0YXRpYyB1MzIgYXNsZV9zZXRfYmFja2xpZ2h0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIGJjbHApCj4gICAJcmV0dXJuIDA7Cj4gICB9
Cj4gICAKPiAtc3RhdGljIHUzMiBhc2xlX3NldF9hbHNfaWxsdW0oc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LCB1MzIgYWxzaSkKPiArc3RhdGljIHUzMiBhc2xlX3NldF9hbHNfaWxs
dW0oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBhbHNpKQo+ICAgewo+ICAgCS8q
IGFsc2kgaXMgdGhlIGN1cnJlbnQgQUxTIHJlYWRpbmcgaW4gbHV4LiAwIGluZGljYXRlcyBiZWxv
dyBzZW5zb3IKPiAgIAkgICByYW5nZSwgMHhmZmZmIGluZGljYXRlcyBhYm92ZSBzZW5zb3IgcmFu
Z2UuIDEtMHhmZmZlIGFyZSB2YWxpZCAqLwo+IEBAIC00ODgsMTMgKzQ4OCwxMyBAQCBzdGF0aWMg
dTMyIGFzbGVfc2V0X2Fsc19pbGx1bShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
IHUzMiBhbHNpKQo+ICAgCXJldHVybiBBU0xDX0FMU19JTExVTV9GQUlMRUQ7Cj4gICB9Cj4gICAK
PiAtc3RhdGljIHUzMiBhc2xlX3NldF9wd21fZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsIHUzMiBwZm1iKQo+ICtzdGF0aWMgdTMyIGFzbGVfc2V0X3B3bV9mcmVxKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgcGZtYikKPiAgIHsKPiAgIAlEUk1fREVCVUdf
RFJJVkVSKCJQV00gZnJlcSBpcyBub3Qgc3VwcG9ydGVkXG4iKTsKPiAgIAlyZXR1cm4gQVNMQ19Q
V01fRlJFUV9GQUlMRUQ7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHUzMiBhc2xlX3NldF9wZml0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIHBmaXQpCj4gK3N0YXRpYyB1MzIg
YXNsZV9zZXRfcGZpdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIHBmaXQpCj4g
ICB7Cj4gICAJLyogUGFuZWwgZml0dGluZyBpcyBjdXJyZW50bHkgY29udHJvbGxlZCBieSB0aGUg
WCBjb2RlLCBzbyB0aGlzIGlzIGEKPiAgIAkgICBub29wIHVudGlsIG1vZGVzZXR0aW5nIHN1cHBv
cnQgd29ya3MgZnVsbHkgKi8KPiBAQCAtNTAyLDEzICs1MDIsMTMgQEAgc3RhdGljIHUzMiBhc2xl
X3NldF9wZml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIHBmaXQpCj4g
ICAJcmV0dXJuIEFTTENfUEZJVF9GQUlMRUQ7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHUzMiBhc2xl
X3NldF9zdXBwb3J0ZWRfcm90YXRpb25fYW5nbGVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwgdTMyIHNyb3QpCj4gK3N0YXRpYyB1MzIgYXNsZV9zZXRfc3VwcG9ydGVkX3JvdGF0
aW9uX2FuZ2xlcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIHNyb3QpCj4gICB7
Cj4gICAJRFJNX0RFQlVHX0RSSVZFUigiU1JPVCBpcyBub3Qgc3VwcG9ydGVkXG4iKTsKPiAgIAly
ZXR1cm4gQVNMQ19ST1RBVElPTl9BTkdMRVNfRkFJTEVEOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB1
MzIgYXNsZV9zZXRfYnV0dG9uX2FycmF5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwgdTMyIGl1ZXIpCj4gK3N0YXRpYyB1MzIgYXNsZV9zZXRfYnV0dG9uX2FycmF5KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgaXVlcikKPiAgIHsKPiAgIAlpZiAoIWl1ZXIpCj4g
ICAJCURSTV9ERUJVR19EUklWRVIoIkJ1dHRvbiBhcnJheSBldmVudCBpcyBub3Qgc3VwcG9ydGVk
IChub3RoaW5nKVxuIik7Cj4gQEAgLTUyNiw3ICs1MjYsNyBAQCBzdGF0aWMgdTMyIGFzbGVfc2V0
X2J1dHRvbl9hcnJheShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBpdWVy
KQo+ICAgCXJldHVybiBBU0xDX0JVVFRPTl9BUlJBWV9GQUlMRUQ7Cj4gICB9Cj4gICAKPiAtc3Rh
dGljIHUzMiBhc2xlX3NldF9jb252ZXJ0aWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsIHUzMiBpdWVyKQo+ICtzdGF0aWMgdTMyIGFzbGVfc2V0X2NvbnZlcnRpYmxlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgaXVlcikKPiAgIHsKPiAgIAlpZiAoaXVlciAm
IEFTTEVfSVVFUl9DT05WRVJUSUJMRSkKPiAgIAkJRFJNX0RFQlVHX0RSSVZFUigiQ29udmVydGli
bGUgaXMgbm90IHN1cHBvcnRlZCAoY2xhbXNoZWxsKVxuIik7Cj4gQEAgLTUzNiw3ICs1MzYsNyBA
QCBzdGF0aWMgdTMyIGFzbGVfc2V0X2NvbnZlcnRpYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwgdTMyIGl1ZXIpCj4gICAJcmV0dXJuIEFTTENfQ09OVkVSVElCTEVfRkFJTEVE
Owo+ICAgfQo+ICAgCj4gLXN0YXRpYyB1MzIgYXNsZV9zZXRfZG9ja2luZyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBpdWVyKQo+ICtzdGF0aWMgdTMyIGFzbGVfc2V0X2Rv
Y2tpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBpdWVyKQo+ICAgewo+ICAg
CWlmIChpdWVyICYgQVNMRV9JVUVSX0RPQ0tJTkcpCj4gICAJCURSTV9ERUJVR19EUklWRVIoIkRv
Y2tpbmcgaXMgbm90IHN1cHBvcnRlZCAoZG9ja2VkKVxuIik7Cj4gQEAgLTU0Niw3ICs1NDYsNyBA
QCBzdGF0aWMgdTMyIGFzbGVfc2V0X2RvY2tpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LCB1MzIgaXVlcikKPiAgIAlyZXR1cm4gQVNMQ19ET0NLSU5HX0ZBSUxFRDsKPiAgIH0K
PiAgIAo+IC1zdGF0aWMgdTMyIGFzbGVfaXNjdF9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB1MzIgYXNsZV9pc2N0X3N0YXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCURSTV9ERUJVR19EUklWRVIoIklTQ1QgaXMgbm90
IHN1cHBvcnRlZFxuIik7Cj4gICAJcmV0dXJuIEFTTENfSVNDVF9TVEFURV9GQUlMRUQ7Cj4gQEAg
LTU1Niw5ICs1NTYsOSBAQCBzdGF0aWMgdm9pZCBhc2xlX3dvcmsoc3RydWN0IHdvcmtfc3RydWN0
ICp3b3JrKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9vcHJlZ2lvbiAqb3ByZWdpb24gPQo+ICAg
CQljb250YWluZXJfb2Yod29yaywgc3RydWN0IGludGVsX29wcmVnaW9uLCBhc2xlX3dvcmspOwo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0KPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0KPiAgIAkJY29udGFpbmVyX29mKG9wcmVnaW9uLCBzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSwgb3ByZWdpb24pOwo+IC0Jc3RydWN0IG9wcmVnaW9uX2FzbGUgKmFzbGUg
PSBkZXZfcHJpdi0+b3ByZWdpb24uYXNsZTsKPiArCXN0cnVjdCBvcHJlZ2lvbl9hc2xlICphc2xl
ID0gaTkxNS0+b3ByZWdpb24uYXNsZTsKPiAgIAl1MzIgYXNsY19zdGF0ID0gMDsKPiAgIAl1MzIg
YXNsY19yZXE7Cj4gICAKPiBAQCAtNTc0LDQwICs1NzQsNDAgQEAgc3RhdGljIHZvaWQgYXNsZV93
b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiAgIAl9Cj4gICAKPiAgIAlpZiAoYXNsY19y
ZXEgJiBBU0xDX1NFVF9BTFNfSUxMVU0pCj4gLQkJYXNsY19zdGF0IHw9IGFzbGVfc2V0X2Fsc19p
bGx1bShkZXZfcHJpdiwgYXNsZS0+YWxzaSk7Cj4gKwkJYXNsY19zdGF0IHw9IGFzbGVfc2V0X2Fs
c19pbGx1bShpOTE1LCBhc2xlLT5hbHNpKTsKPiAgIAo+ICAgCWlmIChhc2xjX3JlcSAmIEFTTENf
U0VUX0JBQ0tMSUdIVCkKPiAtCQlhc2xjX3N0YXQgfD0gYXNsZV9zZXRfYmFja2xpZ2h0KGRldl9w
cml2LCBhc2xlLT5iY2xwKTsKPiArCQlhc2xjX3N0YXQgfD0gYXNsZV9zZXRfYmFja2xpZ2h0KGk5
MTUsIGFzbGUtPmJjbHApOwo+ICAgCj4gICAJaWYgKGFzbGNfcmVxICYgQVNMQ19TRVRfUEZJVCkK
PiAtCQlhc2xjX3N0YXQgfD0gYXNsZV9zZXRfcGZpdChkZXZfcHJpdiwgYXNsZS0+cGZpdCk7Cj4g
KwkJYXNsY19zdGF0IHw9IGFzbGVfc2V0X3BmaXQoaTkxNSwgYXNsZS0+cGZpdCk7Cj4gICAKPiAg
IAlpZiAoYXNsY19yZXEgJiBBU0xDX1NFVF9QV01fRlJFUSkKPiAtCQlhc2xjX3N0YXQgfD0gYXNs
ZV9zZXRfcHdtX2ZyZXEoZGV2X3ByaXYsIGFzbGUtPnBmbWIpOwo+ICsJCWFzbGNfc3RhdCB8PSBh
c2xlX3NldF9wd21fZnJlcShpOTE1LCBhc2xlLT5wZm1iKTsKPiAgIAo+ICAgCWlmIChhc2xjX3Jl
cSAmIEFTTENfU1VQUE9SVEVEX1JPVEFUSU9OX0FOR0xFUykKPiAtCQlhc2xjX3N0YXQgfD0gYXNs
ZV9zZXRfc3VwcG9ydGVkX3JvdGF0aW9uX2FuZ2xlcyhkZXZfcHJpdiwKPiArCQlhc2xjX3N0YXQg
fD0gYXNsZV9zZXRfc3VwcG9ydGVkX3JvdGF0aW9uX2FuZ2xlcyhpOTE1LAo+ICAgCQkJCQkJCWFz
bGUtPnNyb3QpOwo+ICAgCj4gICAJaWYgKGFzbGNfcmVxICYgQVNMQ19CVVRUT05fQVJSQVkpCj4g
LQkJYXNsY19zdGF0IHw9IGFzbGVfc2V0X2J1dHRvbl9hcnJheShkZXZfcHJpdiwgYXNsZS0+aXVl
cik7Cj4gKwkJYXNsY19zdGF0IHw9IGFzbGVfc2V0X2J1dHRvbl9hcnJheShpOTE1LCBhc2xlLT5p
dWVyKTsKPiAgIAo+ICAgCWlmIChhc2xjX3JlcSAmIEFTTENfQ09OVkVSVElCTEVfSU5ESUNBVE9S
KQo+IC0JCWFzbGNfc3RhdCB8PSBhc2xlX3NldF9jb252ZXJ0aWJsZShkZXZfcHJpdiwgYXNsZS0+
aXVlcik7Cj4gKwkJYXNsY19zdGF0IHw9IGFzbGVfc2V0X2NvbnZlcnRpYmxlKGk5MTUsIGFzbGUt
Pml1ZXIpOwo+ICAgCj4gICAJaWYgKGFzbGNfcmVxICYgQVNMQ19ET0NLSU5HX0lORElDQVRPUikK
PiAtCQlhc2xjX3N0YXQgfD0gYXNsZV9zZXRfZG9ja2luZyhkZXZfcHJpdiwgYXNsZS0+aXVlcik7
Cj4gKwkJYXNsY19zdGF0IHw9IGFzbGVfc2V0X2RvY2tpbmcoaTkxNSwgYXNsZS0+aXVlcik7Cj4g
ICAKPiAgIAlpZiAoYXNsY19yZXEgJiBBU0xDX0lTQ1RfU1RBVEVfQ0hBTkdFKQo+IC0JCWFzbGNf
c3RhdCB8PSBhc2xlX2lzY3Rfc3RhdGUoZGV2X3ByaXYpOwo+ICsJCWFzbGNfc3RhdCB8PSBhc2xl
X2lzY3Rfc3RhdGUoaTkxNSk7Cj4gICAKPiAgIAlhc2xlLT5hc2xjID0gYXNsY19zdGF0Owo+ICAg
fQo+ICAgCj4gLXZvaWQgaW50ZWxfb3ByZWdpb25fYXNsZV9pbnRyKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBpbnRlbF9vcHJlZ2lvbl9hc2xlX2ludHIoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlpZiAoZGV2X3ByaXYtPm9wcmVnaW9u
LmFzbGUpCj4gLQkJc2NoZWR1bGVfd29yaygmZGV2X3ByaXYtPm9wcmVnaW9uLmFzbGVfd29yayk7
Cj4gKwlpZiAoaTkxNS0+b3ByZWdpb24uYXNsZSkKPiArCQlzY2hlZHVsZV93b3JrKCZpOTE1LT5v
cHJlZ2lvbi5hc2xlX3dvcmspOwo+ICAgfQo+ICAgCj4gICAjZGVmaW5lIEFDUElfRVZfRElTUExB
WV9TV0lUQ0ggKDE8PDApCj4gQEAgLTcwMiw5ICs3MDIsOSBAQCBzdGF0aWMgdTMyIGFjcGlfZGlz
cGxheV90eXBlKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIAlyZXR1cm4g
ZGlzcGxheV90eXBlOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGludGVsX2RpZGxfb3V0cHV0
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGludGVs
X2RpZGxfb3V0cHV0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0
cnVjdCBpbnRlbF9vcHJlZ2lvbiAqb3ByZWdpb24gPSAmZGV2X3ByaXYtPm9wcmVnaW9uOwo+ICsJ
c3RydWN0IGludGVsX29wcmVnaW9uICpvcHJlZ2lvbiA9ICZpOTE1LT5vcHJlZ2lvbjsKPiAgIAlz
dHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3I7Cj4gICAJc3RydWN0IGRybV9jb25uZWN0
b3JfbGlzdF9pdGVyIGNvbm5faXRlcjsKPiAgIAlpbnQgaSA9IDAsIG1heF9vdXRwdXRzOwo+IEBA
IC03MjAsNyArNzIwLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZGlkbF9vdXRwdXRzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAltYXhfb3V0cHV0cyA9IEFSUkFZX1NJWkUo
b3ByZWdpb24tPmFjcGktPmRpZGwpICsKPiAgIAkJQVJSQVlfU0laRShvcHJlZ2lvbi0+YWNwaS0+
ZGlkMik7Cj4gICAKPiAtCWRybV9jb25uZWN0b3JfbGlzdF9pdGVyX2JlZ2luKCZkZXZfcHJpdi0+
ZHJtLCAmY29ubl9pdGVyKTsKPiArCWRybV9jb25uZWN0b3JfbGlzdF9pdGVyX2JlZ2luKCZpOTE1
LT5kcm0sICZjb25uX2l0ZXIpOwo+ICAgCWZvcl9lYWNoX2ludGVsX2Nvbm5lY3Rvcl9pdGVyKGNv
bm5lY3RvciwgJmNvbm5faXRlcikgewo+ICAgCQl1MzIgZGV2aWNlX2lkLCB0eXBlOwo+ICAgCj4g
QEAgLTc0OSw5ICs3NDksOSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kaWRsX291dHB1dHMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQlzZXRfZGlkKG9wcmVnaW9uLCBpLCAw
KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpbnRlbF9zZXR1cF9jYWRscyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGludGVsX3NldHVwX2NhZGxz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RydWN0IGludGVsX29w
cmVnaW9uICpvcHJlZ2lvbiA9ICZkZXZfcHJpdi0+b3ByZWdpb247Cj4gKwlzdHJ1Y3QgaW50ZWxf
b3ByZWdpb24gKm9wcmVnaW9uID0gJmk5MTUtPm9wcmVnaW9uOwo+ICAgCXN0cnVjdCBpbnRlbF9j
b25uZWN0b3IgKmNvbm5lY3RvcjsKPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9saXN0X2l0ZXIg
Y29ubl9pdGVyOwo+ICAgCWludCBpID0gMDsKPiBAQCAtNzY2LDcgKzc2Niw3IEBAIHN0YXRpYyB2
b2lkIGludGVsX3NldHVwX2NhZGxzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiAgIAkgKiBOb3RlIHRoYXQgaW50ZXJuYWwgcGFuZWxzIHNob3VsZCBiZSBhdCB0aGUgZnJvbnQg
b2YgdGhlIGNvbm5lY3Rvcgo+ICAgCSAqIGxpc3QgYWxyZWFkeSwgZW5zdXJpbmcgdGhleSdyZSBu
b3QgbGVmdCBvdXQuCj4gICAJICovCj4gLQlkcm1fY29ubmVjdG9yX2xpc3RfaXRlcl9iZWdpbigm
ZGV2X3ByaXYtPmRybSwgJmNvbm5faXRlcik7Cj4gKwlkcm1fY29ubmVjdG9yX2xpc3RfaXRlcl9i
ZWdpbigmaTkxNS0+ZHJtLCAmY29ubl9pdGVyKTsKPiAgIAlmb3JfZWFjaF9pbnRlbF9jb25uZWN0
b3JfaXRlcihjb25uZWN0b3IsICZjb25uX2l0ZXIpIHsKPiAgIAkJaWYgKGkgPj0gQVJSQVlfU0la
RShvcHJlZ2lvbi0+YWNwaS0+Y2FkbCkpCj4gICAJCQlicmVhazsKPiBAQCAtNzc5LDkgKzc3OSw5
IEBAIHN0YXRpYyB2b2lkIGludGVsX3NldHVwX2NhZGxzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiAgIAkJb3ByZWdpb24tPmFjcGktPmNhZGxbaV0gPSAwOwo+ICAgfQo+ICAg
Cj4gLXN0YXRpYyB2b2lkIHN3c2NpX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiArc3RhdGljIHZvaWQgc3dzY2lfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfb3ByZWdpb24gKm9wcmVnaW9uID0gJmRldl9w
cml2LT5vcHJlZ2lvbjsKPiArCXN0cnVjdCBpbnRlbF9vcHJlZ2lvbiAqb3ByZWdpb24gPSAmaTkx
NS0+b3ByZWdpb247Cj4gICAJYm9vbCByZXF1ZXN0ZWRfY2FsbGJhY2tzID0gZmFsc2U7Cj4gICAJ
dTMyIHRtcDsKPiAgIAo+IEBAIC03OTAsNyArNzkwLDcgQEAgc3RhdGljIHZvaWQgc3dzY2lfc2V0
dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCW9wcmVnaW9uLT5zd3Nj
aV9zYmNiX3N1Yl9mdW5jdGlvbnMgPSAxOwo+ICAgCj4gICAJLyogV2UgdXNlIEdCREEgdG8gYXNr
IGZvciBzdXBwb3J0ZWQgR0JEQSBjYWxscy4gKi8KPiAtCWlmIChzd3NjaShkZXZfcHJpdiwgU1dT
Q0lfR0JEQV9TVVBQT1JURURfQ0FMTFMsIDAsICZ0bXApID09IDApIHsKPiArCWlmIChzd3NjaShp
OTE1LCBTV1NDSV9HQkRBX1NVUFBPUlRFRF9DQUxMUywgMCwgJnRtcCkgPT0gMCkgewo+ICAgCQkv
KiBtYWtlIHRoZSBiaXRzIG1hdGNoIHRoZSBzdWItZnVuY3Rpb24gY29kZXMgKi8KPiAgIAkJdG1w
IDw8PSAxOwo+ICAgCQlvcHJlZ2lvbi0+c3dzY2lfZ2JkYV9zdWJfZnVuY3Rpb25zIHw9IHRtcDsK
PiBAQCAtODAxLDcgKzgwMSw3IEBAIHN0YXRpYyB2b2lkIHN3c2NpX3NldHVwKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkgKiBtdXN0IG5vdCBjYWxsIGludGVyZmFjZXMg
dGhhdCBhcmUgbm90IHNwZWNpZmljYWxseSByZXF1ZXN0ZWQgYnkgdGhlCj4gICAJICogYmlvcy4K
PiAgIAkgKi8KPiAtCWlmIChzd3NjaShkZXZfcHJpdiwgU1dTQ0lfR0JEQV9SRVFVRVNURURfQ0FM
TEJBQ0tTLCAwLCAmdG1wKSA9PSAwKSB7Cj4gKwlpZiAoc3dzY2koaTkxNSwgU1dTQ0lfR0JEQV9S
RVFVRVNURURfQ0FMTEJBQ0tTLCAwLCAmdG1wKSA9PSAwKSB7Cj4gICAJCS8qIGhlcmUsIHRoZSBi
aXRzIGFscmVhZHkgbWF0Y2ggc3ViLWZ1bmN0aW9uIGNvZGVzICovCj4gICAJCW9wcmVnaW9uLT5z
d3NjaV9zYmNiX3N1Yl9mdW5jdGlvbnMgfD0gdG1wOwo+ICAgCQlyZXF1ZXN0ZWRfY2FsbGJhY2tz
ID0gdHJ1ZTsKPiBAQCAtODEyLDcgKzgxMiw3IEBAIHN0YXRpYyB2b2lkIHN3c2NpX3NldHVwKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkgKiB0aGUgY2FsbGJhY2sgaXMg
X3JlcXVlc3RlZF8uIEJ1dCB3ZSBzdGlsbCBjYW4ndCBjYWxsIGludGVyZmFjZXMgdGhhdAo+ICAg
CSAqIGFyZSBub3QgcmVxdWVzdGVkLgo+ICAgCSAqLwo+IC0JaWYgKHN3c2NpKGRldl9wcml2LCBT
V1NDSV9TQkNCX1NVUFBPUlRFRF9DQUxMQkFDS1MsIDAsICZ0bXApID09IDApIHsKPiArCWlmIChz
d3NjaShpOTE1LCBTV1NDSV9TQkNCX1NVUFBPUlRFRF9DQUxMQkFDS1MsIDAsICZ0bXApID09IDAp
IHsKPiAgIAkJLyogbWFrZSB0aGUgYml0cyBtYXRjaCB0aGUgc3ViLWZ1bmN0aW9uIGNvZGVzICov
Cj4gICAJCXUzMiBsb3cgPSB0bXAgJiAweDdmZjsKPiAgIAkJdTMyIGhpZ2ggPSB0bXAgJiB+MHhm
ZmY7IC8qIGJpdCAxMSBpcyByZXNlcnZlZCAqLwo+IEBAIC04NTQsOSArODU0LDkgQEAgc3RhdGlj
IGNvbnN0IHN0cnVjdCBkbWlfc3lzdGVtX2lkIGludGVsX25vX29wcmVnaW9uX3ZidFtdID0gewo+
ICAgCXsgfQo+ICAgfTsKPiAgIAo+IC1zdGF0aWMgaW50IGludGVsX2xvYWRfdmJ0X2Zpcm13YXJl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIGludCBpbnRlbF9s
b2FkX3ZidF9maXJtd2FyZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAt
CXN0cnVjdCBpbnRlbF9vcHJlZ2lvbiAqb3ByZWdpb24gPSAmZGV2X3ByaXYtPm9wcmVnaW9uOwo+
ICsJc3RydWN0IGludGVsX29wcmVnaW9uICpvcHJlZ2lvbiA9ICZpOTE1LT5vcHJlZ2lvbjsKPiAg
IAljb25zdCBzdHJ1Y3QgZmlybXdhcmUgKmZ3ID0gTlVMTDsKPiAgIAljb25zdCBjaGFyICpuYW1l
ID0gaTkxNV9tb2RwYXJhbXMudmJ0X2Zpcm13YXJlOwo+ICAgCWludCByZXQ7Cj4gQEAgLTg2NCw3
ICs4NjQsNyBAQCBzdGF0aWMgaW50IGludGVsX2xvYWRfdmJ0X2Zpcm13YXJlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAlpZiAoIW5hbWUgfHwgISpuYW1lKQo+ICAgCQly
ZXR1cm4gLUVOT0VOVDsKPiAgIAo+IC0JcmV0ID0gcmVxdWVzdF9maXJtd2FyZSgmZncsIG5hbWUs
ICZkZXZfcHJpdi0+ZHJtLnBkZXYtPmRldik7Cj4gKwlyZXQgPSByZXF1ZXN0X2Zpcm13YXJlKCZm
dywgbmFtZSwgJmk5MTUtPmRybS5wZGV2LT5kZXYpOwo+ICAgCWlmIChyZXQpIHsKPiAgIAkJRFJN
X0VSUk9SKCJSZXF1ZXN0aW5nIFZCVCBmaXJtd2FyZSBcIiVzXCIgZmFpbGVkICglZClcbiIsCj4g
ICAJCQkgIG5hbWUsIHJldCk7Cj4gQEAgLTg5MSwxMCArODkxLDEwIEBAIHN0YXRpYyBpbnQgaW50
ZWxfbG9hZF92YnRfZmlybXdhcmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ICAgCXJldHVybiByZXQ7Cj4gICB9Cj4gICAKPiAtaW50IGludGVsX29wcmVnaW9uX3NldHVwKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAraW50IGludGVsX29wcmVnaW9uX3Nl
dHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RydWN0IGludGVs
X29wcmVnaW9uICpvcHJlZ2lvbiA9ICZkZXZfcHJpdi0+b3ByZWdpb247Cj4gLQlzdHJ1Y3QgcGNp
X2RldiAqcGRldiA9IGRldl9wcml2LT5kcm0ucGRldjsKPiArCXN0cnVjdCBpbnRlbF9vcHJlZ2lv
biAqb3ByZWdpb24gPSAmaTkxNS0+b3ByZWdpb247Cj4gKwlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9
IGk5MTUtPmRybS5wZGV2Owo+ICAgCXUzMiBhc2xzLCBtYm94ZXM7Cj4gICAJY2hhciBidWZbc2l6
ZW9mKE9QUkVHSU9OX1NJR05BVFVSRSldOwo+ICAgCWludCBlcnIgPSAwOwo+IEBAIC05NDUsNyAr
OTQ1LDcgQEAgaW50IGludGVsX29wcmVnaW9uX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiAgIAlpZiAobWJveGVzICYgTUJPWF9TV1NDSSkgewo+ICAgCQlEUk1fREVC
VUdfRFJJVkVSKCJTV1NDSSBzdXBwb3J0ZWRcbiIpOwo+ICAgCQlvcHJlZ2lvbi0+c3dzY2kgPSBi
YXNlICsgT1BSRUdJT05fU1dTQ0lfT0ZGU0VUOwo+IC0JCXN3c2NpX3NldHVwKGRldl9wcml2KTsK
PiArCQlzd3NjaV9zZXR1cChpOTE1KTsKPiAgIAl9Cj4gICAKPiAgIAlpZiAobWJveGVzICYgTUJP
WF9BU0xFKSB7Cj4gQEAgLTk1OCw3ICs5NTgsNyBAQCBpbnQgaW50ZWxfb3ByZWdpb25fc2V0dXAo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCWlmIChtYm94ZXMgJiBNQk9Y
X0FTTEVfRVhUKQo+ICAgCQlEUk1fREVCVUdfRFJJVkVSKCJBU0xFIGV4dGVuc2lvbiBzdXBwb3J0
ZWRcbiIpOwo+ICAgCj4gLQlpZiAoaW50ZWxfbG9hZF92YnRfZmlybXdhcmUoZGV2X3ByaXYpID09
IDApCj4gKwlpZiAoaW50ZWxfbG9hZF92YnRfZmlybXdhcmUoaTkxNSkgPT0gMCkKPiAgIAkJZ290
byBvdXQ7Cj4gICAKPiAgIAlpZiAoZG1pX2NoZWNrX3N5c3RlbShpbnRlbF9ub19vcHJlZ2lvbl92
YnQpKQo+IEBAIC0xMDQzLDEyICsxMDQzLDEyIEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZG1pX3N5
c3RlbV9pZCBpbnRlbF91c2Vfb3ByZWdpb25fcGFuZWxfdHlwZVtdID0gewo+ICAgfTsKPiAgIAo+
ICAgaW50Cj4gLWludGVsX29wcmVnaW9uX2dldF9wYW5lbF90eXBlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiAraW50ZWxfb3ByZWdpb25fZ2V0X3BhbmVsX3R5cGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJdTMyIHBhbmVsX2RldGFpbHM7Cj4g
ICAJaW50IHJldDsKPiAgIAo+IC0JcmV0ID0gc3dzY2koZGV2X3ByaXYsIFNXU0NJX0dCREFfUEFO
RUxfREVUQUlMUywgMHgwLCAmcGFuZWxfZGV0YWlscyk7Cj4gKwlyZXQgPSBzd3NjaShpOTE1LCBT
V1NDSV9HQkRBX1BBTkVMX0RFVEFJTFMsIDB4MCwgJnBhbmVsX2RldGFpbHMpOwo+ICAgCWlmIChy
ZXQpIHsKPiAgIAkJRFJNX0RFQlVHX0tNUygiRmFpbGVkIHRvIGdldCBwYW5lbCBkZXRhaWxzIGZy
b20gT3BSZWdpb24gKCVkKVxuIiwKPiAgIAkJCSAgICAgIHJldCk7Cj4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX29wcmVnaW9uLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9vcHJlZ2lvbi5oCj4gaW5kZXggNGFhNjhmZmJkMzBlLi44ZTBiN2JkZWNiZTQgMTAw
NjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfb3ByZWdpb24uaAo+ICsrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX29wcmVnaW9uLmgKPiBAQCAtNTYsNDcgKzU2LDQ3
IEBAIHN0cnVjdCBpbnRlbF9vcHJlZ2lvbiB7Cj4gICAKPiAgICNpZmRlZiBDT05GSUdfQUNQSQo+
ICAgCj4gLWludCBpbnRlbF9vcHJlZ2lvbl9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpOwo+ICtpbnQgaW50ZWxfb3ByZWdpb25fc2V0dXAoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpOwo+ICAgCj4gLXZvaWQgaW50ZWxfb3ByZWdpb25fcmVnaXN0ZXIoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtdm9pZCBpbnRlbF9vcHJlZ2lvbl91bnJl
Z2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gK3ZvaWQgaW50ZWxf
b3ByZWdpb25fcmVnaXN0ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lk
IGludGVsX29wcmVnaW9uX3VucmVnaXN0ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Owo+ICAgCj4gLXZvaWQgaW50ZWxfb3ByZWdpb25fcmVzdW1lKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdik7Cj4gLXZvaWQgaW50ZWxfb3ByZWdpb25fc3VzcGVuZChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3ZvaWQgaW50ZWxfb3ByZWdpb25fcmVzdW1lKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiArdm9pZCBpbnRlbF9vcHJlZ2lvbl9zdXNw
ZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgIHBjaV9wb3dlcl90
IHN0YXRlKTsKPiAgIAo+IC12b2lkIGludGVsX29wcmVnaW9uX2FzbGVfaW50cihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ICt2b2lkIGludGVsX29wcmVnaW9uX2FzbGVfaW50
cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICBpbnQgaW50ZWxfb3ByZWdpb25f
bm90aWZ5X2VuY29kZXIoc3RydWN0IGludGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIsCj4gICAJ
CQkJICBib29sIGVuYWJsZSk7Cj4gLWludCBpbnRlbF9vcHJlZ2lvbl9ub3RpZnlfYWRhcHRlcihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2ludCBpbnRlbF9vcHJlZ2lvbl9u
b3RpZnlfYWRhcHRlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgIHBj
aV9wb3dlcl90IHN0YXRlKTsKPiAtaW50IGludGVsX29wcmVnaW9uX2dldF9wYW5lbF90eXBlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gK2ludCBpbnRlbF9vcHJlZ2lvbl9n
ZXRfcGFuZWxfdHlwZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICAKPiAgICNl
bHNlIC8qIENPTkZJR19BQ1BJKi8KPiAgIAo+IC1zdGF0aWMgaW5saW5lIGludCBpbnRlbF9vcHJl
Z2lvbl9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyBp
bmxpbmUgaW50IGludGVsX29wcmVnaW9uX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ICAgewo+ICAgCXJldHVybiAwOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBpbmxpbmUgdm9p
ZCBpbnRlbF9vcHJlZ2lvbl9yZWdpc3RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gK3N0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9vcHJlZ2lvbl9yZWdpc3RlcihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgaW5saW5l
IHZvaWQgaW50ZWxfb3ByZWdpb25fdW5yZWdpc3RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gK3N0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9vcHJlZ2lvbl91bnJlZ2lzdGVy
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgfQo+ICAgCj4gLXN0YXRp
YyBpbmxpbmUgdm9pZCBpbnRlbF9vcHJlZ2lvbl9yZXN1bWUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ICtzdGF0aWMgaW5saW5lIHZvaWQgaW50ZWxfb3ByZWdpb25fcmVzdW1l
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgfQo+ICAgCj4gLXN0YXRp
YyBpbmxpbmUgdm9pZCBpbnRlbF9vcHJlZ2lvbl9zdXNwZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIGlubGluZSB2b2lkIGludGVsX29wcmVnaW9uX3N1c3Bl
bmQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJCSAgcGNpX3Bvd2VyX3Qg
c3RhdGUpCj4gICB7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGlubGluZSB2b2lkIGludGVsX29wcmVn
aW9uX2FzbGVfaW50cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRp
YyBpbmxpbmUgdm9pZCBpbnRlbF9vcHJlZ2lvbl9hc2xlX2ludHIoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCj4gICB7Cj4gICB9Cj4gICAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfb3ZlcmxheS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfb3Zl
cmxheS5jCj4gaW5kZXggYTJhYzA2YTA4NzE1Li44MDJiYzRjNzJlY2QgMTAwNjQ0Cj4gLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfb3ZlcmxheS5jCj4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfb3ZlcmxheS5jCj4gQEAgLTE5MywxMCArMTkzLDEwIEBAIHN0cnVjdCBp
bnRlbF9vdmVybGF5IHsKPiAgIAlzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCBsYXN0X2ZsaXA7
Cj4gICB9Owo+ICAgCj4gLXN0YXRpYyB2b2lkIGk4MzBfb3ZlcmxheV9jbG9ja19nYXRpbmcoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBpODMwX292ZXJs
YXlfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAg
ICAgIGJvb2wgZW5hYmxlKQo+ICAgewo+IC0Jc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBkZXZfcHJp
di0+ZHJtLnBkZXY7Cj4gKwlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGk5MTUtPmRybS5wZGV2Owo+
ICAgCXU4IHZhbDsKPiAgIAo+ICAgCS8qIFdBX09WRVJMQVlfQ0xLR0FURTphbG0gKi8KPiBAQCAt
MjQ3LDcgKzI0Nyw3IEBAIHN0YXRpYyBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICphbGxvY19yZXF1ZXN0
KHN0cnVjdCBpbnRlbF9vdmVybGF5ICpvdmVybGF5KQo+ICAgLyogb3ZlcmxheSBuZWVkcyB0byBi
ZSBkaXNhYmxlIGluIE9DTUQgcmVnICovCj4gICBzdGF0aWMgaW50IGludGVsX292ZXJsYXlfb24o
c3RydWN0IGludGVsX292ZXJsYXkgKm92ZXJsYXkpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSBvdmVybGF5LT5pOTE1Owo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSBvdmVybGF5LT5pOTE1Owo+ICAgCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJx
Owo+ICAgCXUzMiAqY3M7Cj4gICAKPiBAQCAtMjY1LDggKzI2NSw4IEBAIHN0YXRpYyBpbnQgaW50
ZWxfb3ZlcmxheV9vbihzdHJ1Y3QgaW50ZWxfb3ZlcmxheSAqb3ZlcmxheSkKPiAgIAo+ICAgCW92
ZXJsYXktPmFjdGl2ZSA9IHRydWU7Cj4gICAKPiAtCWlmIChJU19JODMwKGRldl9wcml2KSkKPiAt
CQlpODMwX292ZXJsYXlfY2xvY2tfZ2F0aW5nKGRldl9wcml2LCBmYWxzZSk7Cj4gKwlpZiAoSVNf
STgzMChpOTE1KSkKPiArCQlpODMwX292ZXJsYXlfY2xvY2tfZ2F0aW5nKGk5MTUsIGZhbHNlKTsK
PiAgIAo+ICAgCSpjcysrID0gTUlfT1ZFUkxBWV9GTElQIHwgTUlfT1ZFUkxBWV9PTjsKPiAgIAkq
Y3MrKyA9IG92ZXJsYXktPmZsaXBfYWRkciB8IE9GQ19VUERBVEU7Cj4gQEAgLTMwMyw3ICszMDMs
NyBAQCBzdGF0aWMgaW50IGludGVsX292ZXJsYXlfY29udGludWUoc3RydWN0IGludGVsX292ZXJs
YXkgKm92ZXJsYXksCj4gICAJCQkJICBzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKPiAgIAkJCQkgIGJv
b2wgbG9hZF9wb2x5cGhhc2VfZmlsdGVyKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gb3ZlcmxheS0+aTkxNTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gb3ZlcmxheS0+aTkxNTsKPiAgIAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKPiAg
IAl1MzIgZmxpcF9hZGRyID0gb3ZlcmxheS0+ZmxpcF9hZGRyOwo+ICAgCXUzMiB0bXAsICpjczsK
PiBAQCAtMzY5LDcgKzM2OSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX292ZXJsYXlfb2ZmX3RhaWwo
c3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2ZSwKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50
ZWxfb3ZlcmxheSAqb3ZlcmxheSA9Cj4gICAJCWNvbnRhaW5lcl9vZihhY3RpdmUsIHR5cGVvZigq
b3ZlcmxheSksIGxhc3RfZmxpcCk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSBvdmVybGF5LT5pOTE1Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBv
dmVybGF5LT5pOTE1Owo+ICAgCj4gICAJaW50ZWxfb3ZlcmxheV9yZWxlYXNlX29sZF92bWEob3Zl
cmxheSk7Cj4gICAKPiBAQCAtMzc3LDggKzM3Nyw4IEBAIHN0YXRpYyB2b2lkIGludGVsX292ZXJs
YXlfb2ZmX3RhaWwoc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2ZSwKPiAgIAlvdmVy
bGF5LT5jcnRjID0gTlVMTDsKPiAgIAlvdmVybGF5LT5hY3RpdmUgPSBmYWxzZTsKPiAgIAo+IC0J
aWYgKElTX0k4MzAoZGV2X3ByaXYpKQo+IC0JCWk4MzBfb3ZlcmxheV9jbG9ja19nYXRpbmcoZGV2
X3ByaXYsIHRydWUpOwo+ICsJaWYgKElTX0k4MzAoaTkxNSkpCj4gKwkJaTgzMF9vdmVybGF5X2Ns
b2NrX2dhdGluZyhpOTE1LCB0cnVlKTsKPiAgIH0KPiAgIAo+ICAgLyogb3ZlcmxheSBuZWVkcyB0
byBiZSBkaXNhYmxlZCBpbiBPQ01EIHJlZyAqLwo+IEBAIC00MzcsMTEgKzQzNywxMSBAQCBzdGF0
aWMgaW50IGludGVsX292ZXJsYXlfcmVjb3Zlcl9mcm9tX2ludGVycnVwdChzdHJ1Y3QgaW50ZWxf
b3ZlcmxheSAqb3ZlcmxheSkKPiAgICAqLwo+ICAgc3RhdGljIGludCBpbnRlbF9vdmVybGF5X3Jl
bGVhc2Vfb2xkX3ZpZChzdHJ1Y3QgaW50ZWxfb3ZlcmxheSAqb3ZlcmxheSkKPiAgIHsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG92ZXJsYXktPmk5MTU7Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG92ZXJsYXktPmk5MTU7Cj4gICAJdTMyICpjczsK
PiAgIAlpbnQgcmV0Owo+ICAgCj4gLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+ZHJt
LnN0cnVjdF9tdXRleCk7Cj4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5kcm0uc3RydWN0
X211dGV4KTsKPiAgIAo+ICAgCS8qIE9ubHkgd2FpdCBpZiB0aGVyZSBpcyBhY3R1YWxseSBhbiBv
bGQgZnJhbWUgdG8gcmVsZWFzZSB0bwo+ICAgCSAqIGd1YXJhbnRlZSBmb3J3YXJkIHByb2dyZXNz
Lgo+IEBAIC00NzcsOSArNDc3LDkgQEAgc3RhdGljIGludCBpbnRlbF9vdmVybGF5X3JlbGVhc2Vf
b2xkX3ZpZChzdHJ1Y3QgaW50ZWxfb3ZlcmxheSAqb3ZlcmxheSkKPiAgIAlyZXR1cm4gMDsKPiAg
IH0KPiAgIAo+IC12b2lkIGludGVsX292ZXJsYXlfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ICt2b2lkIGludGVsX292ZXJsYXlfcmVzZXQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfb3ZlcmxheSAqb3ZlcmxheSA9
IGRldl9wcml2LT5vdmVybGF5Owo+ICsJc3RydWN0IGludGVsX292ZXJsYXkgKm92ZXJsYXkgPSBp
OTE1LT5vdmVybGF5Owo+ICAgCj4gICAJaWYgKCFvdmVybGF5KQo+ICAgCQlyZXR1cm47Cj4gQEAg
LTU0MCwxMSArNTQwLDExIEBAIHN0YXRpYyBpbnQgdXZfdnN1YnNhbXBsaW5nKHUzMiBmb3JtYXQp
Cj4gICAJfQo+ICAgfQo+ICAgCj4gLXN0YXRpYyB1MzIgY2FsY19zd2lkdGhzdyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBvZmZzZXQsIHUzMiB3aWR0aCkKPiArc3RhdGlj
IHUzMiBjYWxjX3N3aWR0aHN3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgb2Zm
c2V0LCB1MzIgd2lkdGgpCj4gICB7Cj4gICAJdTMyIHN3Owo+ICAgCj4gLQlpZiAoSVNfR0VOKGRl
dl9wcml2LCAyKSkKPiArCWlmIChJU19HRU4oaTkxNSwgMikpCj4gICAJCXN3ID0gQUxJR04oKG9m
ZnNldCAmIDMxKSArIHdpZHRoLCAzMik7Cj4gICAJZWxzZQo+ICAgCQlzdyA9IEFMSUdOKChvZmZz
ZXQgJiA2MykgKyB3aWR0aCwgNjQpOwo+IEBAIC03NDksMjEgKzc0OSwyMSBAQCBzdGF0aWMgaW50
IGludGVsX292ZXJsYXlfZG9fcHV0X2ltYWdlKHN0cnVjdCBpbnRlbF9vdmVybGF5ICpvdmVybGF5
LAo+ICAgCQkJCSAgICAgIHN0cnVjdCBkcm1faW50ZWxfb3ZlcmxheV9wdXRfaW1hZ2UgKnBhcmFt
cykKPiAgIHsKPiAgIAlzdHJ1Y3Qgb3ZlcmxheV9yZWdpc3RlcnMgX19pb21lbSAqcmVncyA9IG92
ZXJsYXktPnJlZ3M7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBvdmVy
bGF5LT5pOTE1Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBvdmVybGF5LT5p
OTE1Owo+ICAgCXUzMiBzd2lkdGgsIHN3aWR0aHN3LCBzaGVpZ2h0LCBvc3RyaWRlOwo+ICAgCWVu
dW0gcGlwZSBwaXBlID0gb3ZlcmxheS0+Y3J0Yy0+cGlwZTsKPiAgIAlib29sIHNjYWxlX2NoYW5n
ZWQgPSBmYWxzZTsKPiAgIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKPiAgIAlpbnQgcmV0LCB0bXBf
d2lkdGg7Cj4gICAKPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5kcm0uc3RydWN0
X211dGV4KTsKPiAtCVdBUk5fT04oIWRybV9tb2Rlc2V0X2lzX2xvY2tlZCgmZGV2X3ByaXYtPmRy
bS5tb2RlX2NvbmZpZy5jb25uZWN0aW9uX211dGV4KSk7Cj4gKwlsb2NrZGVwX2Fzc2VydF9oZWxk
KCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiArCVdBUk5fT04oIWRybV9tb2Rlc2V0X2lzX2xv
Y2tlZCgmaTkxNS0+ZHJtLm1vZGVfY29uZmlnLmNvbm5lY3Rpb25fbXV0ZXgpKTsKPiAgIAo+ICAg
CXJldCA9IGludGVsX292ZXJsYXlfcmVsZWFzZV9vbGRfdmlkKG92ZXJsYXkpOwo+ICAgCWlmIChy
ZXQgIT0gMCkKPiAgIAkJcmV0dXJuIHJldDsKPiAgIAo+IC0JYXRvbWljX2luYygmZGV2X3ByaXYt
PmdwdV9lcnJvci5wZW5kaW5nX2ZiX3Bpbik7Cj4gKwlhdG9taWNfaW5jKCZpOTE1LT5ncHVfZXJy
b3IucGVuZGluZ19mYl9waW4pOwo+ICAgCj4gICAJaTkxNV9nZW1fb2JqZWN0X2xvY2sobmV3X2Jv
KTsKPiAgIAl2bWEgPSBpOTE1X2dlbV9vYmplY3RfcGluX3RvX2Rpc3BsYXlfcGxhbmUobmV3X2Jv
LAo+IEBAIC03ODMsNyArNzgzLDcgQEAgc3RhdGljIGludCBpbnRlbF9vdmVybGF5X2RvX3B1dF9p
bWFnZShzdHJ1Y3QgaW50ZWxfb3ZlcmxheSAqb3ZlcmxheSwKPiAgIAkJdTMyIG9jb25maWc7Cj4g
ICAKPiAgIAkJb2NvbmZpZyA9IE9DT05GX0NDX09VVF84QklUOwo+IC0JCWlmIChJU19HRU4oZGV2
X3ByaXYsIDQpKQo+ICsJCWlmIChJU19HRU4oaTkxNSwgNCkpCj4gICAJCQlvY29uZmlnIHw9IE9D
T05GX0NTQ19NT0RFX0JUNzA5Owo+ICAgCQlvY29uZmlnIHw9IHBpcGUgPT0gMCA/Cj4gICAJCQlP
Q09ORl9QSVBFX0EgOiBPQ09ORl9QSVBFX0I7Cj4gQEAgLTgwNCw3ICs4MDQsNyBAQCBzdGF0aWMg
aW50IGludGVsX292ZXJsYXlfZG9fcHV0X2ltYWdlKHN0cnVjdCBpbnRlbF9vdmVybGF5ICpvdmVy
bGF5LAo+ICAgCQl0bXBfd2lkdGggPSBwYXJhbXMtPnNyY193aWR0aDsKPiAgIAo+ICAgCXN3aWR0
aCA9IHBhcmFtcy0+c3JjX3dpZHRoOwo+IC0Jc3dpZHRoc3cgPSBjYWxjX3N3aWR0aHN3KGRldl9w
cml2LCBwYXJhbXMtPm9mZnNldF9ZLCB0bXBfd2lkdGgpOwo+ICsJc3dpZHRoc3cgPSBjYWxjX3N3
aWR0aHN3KGk5MTUsIHBhcmFtcy0+b2Zmc2V0X1ksIHRtcF93aWR0aCk7Cj4gICAJc2hlaWdodCA9
IHBhcmFtcy0+c3JjX2hlaWdodDsKPiAgIAlpb3dyaXRlMzIoaTkxNV9nZ3R0X29mZnNldCh2bWEp
ICsgcGFyYW1zLT5vZmZzZXRfWSwgJnJlZ3MtPk9CVUZfMFkpOwo+ICAgCW9zdHJpZGUgPSBwYXJh
bXMtPnN0cmlkZV9ZOwo+IEBAIC04MTcsOSArODE3LDkgQEAgc3RhdGljIGludCBpbnRlbF9vdmVy
bGF5X2RvX3B1dF9pbWFnZShzdHJ1Y3QgaW50ZWxfb3ZlcmxheSAqb3ZlcmxheSwKPiAgIAkJc3dp
ZHRoIHw9IChwYXJhbXMtPnNyY193aWR0aCAvIHV2X2hzY2FsZSkgPDwgMTY7Cj4gICAJCXNoZWln
aHQgfD0gKHBhcmFtcy0+c3JjX2hlaWdodCAvIHV2X3ZzY2FsZSkgPDwgMTY7Cj4gICAKPiAtCQl0
bXBfVSA9IGNhbGNfc3dpZHRoc3coZGV2X3ByaXYsIHBhcmFtcy0+b2Zmc2V0X1UsCj4gKwkJdG1w
X1UgPSBjYWxjX3N3aWR0aHN3KGk5MTUsIHBhcmFtcy0+b2Zmc2V0X1UsCj4gICAJCQkJICAgICAg
cGFyYW1zLT5zcmNfd2lkdGggLyB1dl9oc2NhbGUpOwo+IC0JCXRtcF9WID0gY2FsY19zd2lkdGhz
dyhkZXZfcHJpdiwgcGFyYW1zLT5vZmZzZXRfViwKPiArCQl0bXBfViA9IGNhbGNfc3dpZHRoc3co
aTkxNSwgcGFyYW1zLT5vZmZzZXRfViwKPiAgIAkJCQkgICAgICBwYXJhbXMtPnNyY193aWR0aCAv
IHV2X2hzY2FsZSk7Cj4gICAJCXN3aWR0aHN3IHw9IG1heCh0bXBfVSwgdG1wX1YpIDw8IDE2Owo+
ICAgCj4gQEAgLTg1MSwxOCArODUxLDE4IEBAIHN0YXRpYyBpbnQgaW50ZWxfb3ZlcmxheV9kb19w
dXRfaW1hZ2Uoc3RydWN0IGludGVsX292ZXJsYXkgKm92ZXJsYXksCj4gICBvdXRfdW5waW46Cj4g
ICAJaTkxNV9nZW1fb2JqZWN0X3VucGluX2Zyb21fZGlzcGxheV9wbGFuZSh2bWEpOwo+ICAgb3V0
X3Bpbl9zZWN0aW9uOgo+IC0JYXRvbWljX2RlYygmZGV2X3ByaXYtPmdwdV9lcnJvci5wZW5kaW5n
X2ZiX3Bpbik7Cj4gKwlhdG9taWNfZGVjKCZpOTE1LT5ncHVfZXJyb3IucGVuZGluZ19mYl9waW4p
Owo+ICAgCj4gICAJcmV0dXJuIHJldDsKPiAgIH0KPiAgIAo+ICAgaW50IGludGVsX292ZXJsYXlf
c3dpdGNoX29mZihzdHJ1Y3QgaW50ZWxfb3ZlcmxheSAqb3ZlcmxheSkKPiAgIHsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG92ZXJsYXktPmk5MTU7Cj4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG92ZXJsYXktPmk5MTU7Cj4gICAJaW50IHJldDsKPiAg
IAo+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+
IC0JV0FSTl9PTighZHJtX21vZGVzZXRfaXNfbG9ja2VkKCZkZXZfcHJpdi0+ZHJtLm1vZGVfY29u
ZmlnLmNvbm5lY3Rpb25fbXV0ZXgpKTsKPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmRy
bS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJV0FSTl9PTighZHJtX21vZGVzZXRfaXNfbG9ja2VkKCZpOTE1
LT5kcm0ubW9kZV9jb25maWcuY29ubmVjdGlvbl9tdXRleCkpOwo+ICAgCj4gICAJcmV0ID0gaW50
ZWxfb3ZlcmxheV9yZWNvdmVyX2Zyb21faW50ZXJydXB0KG92ZXJsYXkpOwo+ICAgCWlmIChyZXQg
IT0gMCkKPiBAQCAtODk1LDE0ICs4OTUsMTQgQEAgc3RhdGljIGludCBjaGVja19vdmVybGF5X3Bv
c3NpYmxlX29uX2NydGMoc3RydWN0IGludGVsX292ZXJsYXkgKm92ZXJsYXksCj4gICAKPiAgIHN0
YXRpYyB2b2lkIHVwZGF0ZV9wZml0X3ZzY2FsZV9yYXRpbyhzdHJ1Y3QgaW50ZWxfb3ZlcmxheSAq
b3ZlcmxheSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG92
ZXJsYXktPmk5MTU7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG92ZXJsYXkt
Pmk5MTU7Cj4gICAJdTMyIHBmaXRfY29udHJvbCA9IEk5MTVfUkVBRChQRklUX0NPTlRST0wpOwo+
ICAgCXUzMiByYXRpbzsKPiAgIAo+ICAgCS8qIFhYWDogVGhpcyBpcyBub3QgdGhlIHNhbWUgbG9n
aWMgYXMgaW4gdGhlIHhvcmcgZHJpdmVyLCBidXQgbW9yZSBpbgo+ICAgCSAqIGxpbmUgd2l0aCB0
aGUgaW50ZWwgZG9jdW1lbnRhdGlvbiBmb3IgdGhlIGk5NjUKPiAgIAkgKi8KPiAtCWlmIChJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDQpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNCkgewo+
ICAgCQkvKiBvbiBpOTY1IHVzZSB0aGUgUEdNIHJlZyB0byByZWFkIG91dCB0aGUgYXV0b3NjYWxl
ciB2YWx1ZXMgKi8KPiAgIAkJcmF0aW8gPSBJOTE1X1JFQUQoUEZJVF9QR01fUkFUSU9TKSA+PiBQ
RklUX1ZFUlRfU0NBTEVfU0hJRlRfOTY1Owo+ICAgCX0gZWxzZSB7Cj4gQEAgLTk0Nyw3ICs5NDcs
NyBAQCBzdGF0aWMgaW50IGNoZWNrX292ZXJsYXlfc2NhbGluZyhzdHJ1Y3QgZHJtX2ludGVsX292
ZXJsYXlfcHV0X2ltYWdlICpyZWMpCj4gICAJcmV0dXJuIDA7Cj4gICB9Cj4gICAKPiAtc3RhdGlj
IGludCBjaGVja19vdmVybGF5X3NyYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gK3N0YXRpYyBpbnQgY2hlY2tfb3ZlcmxheV9zcmMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCj4gICAJCQkgICAgIHN0cnVjdCBkcm1faW50ZWxfb3ZlcmxheV9wdXRfaW1hZ2UgKnJl
YywKPiAgIAkJCSAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm5ld19ibykKPiAgIHsK
PiBAQCAtOTU4LDcgKzk1OCw3IEBAIHN0YXRpYyBpbnQgY2hlY2tfb3ZlcmxheV9zcmMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCXUzMiB0bXA7Cj4gICAKPiAgIAkvKiBj
aGVjayBzcmMgZGltZW5zaW9ucyAqLwo+IC0JaWYgKElTX0k4NDVHKGRldl9wcml2KSB8fCBJU19J
ODMwKGRldl9wcml2KSkgewo+ICsJaWYgKElTX0k4NDVHKGk5MTUpIHx8IElTX0k4MzAoaTkxNSkp
IHsKPiAgIAkJaWYgKHJlYy0+c3JjX2hlaWdodCA+IElNQUdFX01BWF9IRUlHSFRfTEVHQUNZIHx8
Cj4gICAJCSAgICByZWMtPnNyY193aWR0aCAgPiBJTUFHRV9NQVhfV0lEVEhfTEVHQUNZKQo+ICAg
CQkJcmV0dXJuIC1FSU5WQUw7Cj4gQEAgLTEwMTAsMTQgKzEwMTAsMTQgQEAgc3RhdGljIGludCBj
aGVja19vdmVybGF5X3NyYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJ
CXJldHVybiAtRUlOVkFMOwo+ICAgCj4gICAJLyogc3RyaWRlIGNoZWNraW5nICovCj4gLQlpZiAo
SVNfSTgzMChkZXZfcHJpdikgfHwgSVNfSTg0NUcoZGV2X3ByaXYpKQo+ICsJaWYgKElTX0k4MzAo
aTkxNSkgfHwgSVNfSTg0NUcoaTkxNSkpCj4gICAJCXN0cmlkZV9tYXNrID0gMjU1Owo+ICAgCWVs
c2UKPiAgIAkJc3RyaWRlX21hc2sgPSA2MzsKPiAgIAo+ICAgCWlmIChyZWMtPnN0cmlkZV9ZICYg
c3RyaWRlX21hc2sgfHwgcmVjLT5zdHJpZGVfVVYgJiBzdHJpZGVfbWFzaykKPiAgIAkJcmV0dXJu
IC1FSU5WQUw7Cj4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCA0KSAmJiByZWMtPnN0cmlkZV9ZIDwg
NTEyKQo+ICsJaWYgKElTX0dFTihpOTE1LCA0KSAmJiByZWMtPnN0cmlkZV9ZIDwgNTEyKQo+ICAg
CQlyZXR1cm4gLUVJTlZBTDsKPiAgIAo+ICAgCXRtcCA9IChyZWMtPmZsYWdzICYgSTkxNV9PVkVS
TEFZX1RZUEVfTUFTSykgPT0gSTkxNV9PVkVSTEFZX1lVVl9QTEFOQVIgPwo+IEBAIC0xMDYyLDE0
ICsxMDYyLDE0IEBAIGludCBpbnRlbF9vdmVybGF5X3B1dF9pbWFnZV9pb2N0bChzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ICAgCQkJCSAgc3RydWN0IGRybV9maWxlICpmaWxl
X3ByaXYpCj4gICB7Cj4gICAJc3RydWN0IGRybV9pbnRlbF9vdmVybGF5X3B1dF9pbWFnZSAqcGFy
YW1zID0gZGF0YTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYp
Owo+ICAgCXN0cnVjdCBpbnRlbF9vdmVybGF5ICpvdmVybGF5Owo+ICAgCXN0cnVjdCBkcm1fY3J0
YyAqZHJtbW9kZV9jcnRjOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOwo+ICAgCXN0cnVj
dCBkcm1faTkxNV9nZW1fb2JqZWN0ICpuZXdfYm87Cj4gICAJaW50IHJldDsKPiAgIAo+IC0Jb3Zl
cmxheSA9IGRldl9wcml2LT5vdmVybGF5Owo+ICsJb3ZlcmxheSA9IGk5MTUtPm92ZXJsYXk7Cj4g
ICAJaWYgKCFvdmVybGF5KSB7Cj4gICAJCURSTV9ERUJVRygidXNlcnNwYWNlIGJ1Zzogbm8gb3Zl
cmxheVxuIik7Cj4gICAJCXJldHVybiAtRU5PREVWOwo+IEBAIC0xMTQ4LDcgKzExNDgsNyBAQCBp
bnQgaW50ZWxfb3ZlcmxheV9wdXRfaW1hZ2VfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwg
dm9pZCAqZGF0YSwKPiAgIAkJZ290byBvdXRfdW5sb2NrOwo+ICAgCX0KPiAgIAo+IC0JcmV0ID0g
Y2hlY2tfb3ZlcmxheV9zcmMoZGV2X3ByaXYsIHBhcmFtcywgbmV3X2JvKTsKPiArCXJldCA9IGNo
ZWNrX292ZXJsYXlfc3JjKGk5MTUsIHBhcmFtcywgbmV3X2JvKTsKPiAgIAlpZiAocmV0ICE9IDAp
Cj4gICAJCWdvdG8gb3V0X3VubG9jazsKPiAgIAo+IEBAIC0xMjMxLDExICsxMjMxLDExIEBAIGlu
dCBpbnRlbF9vdmVybGF5X2F0dHJzX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQg
KmRhdGEsCj4gICAJCQkgICAgICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdikKPiAgIHsKPiAg
IAlzdHJ1Y3QgZHJtX2ludGVsX292ZXJsYXlfYXR0cnMgKmF0dHJzID0gZGF0YTsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9v
dmVybGF5ICpvdmVybGF5Owo+ICAgCWludCByZXQ7Cj4gICAKPiAtCW92ZXJsYXkgPSBkZXZfcHJp
di0+b3ZlcmxheTsKPiArCW92ZXJsYXkgPSBpOTE1LT5vdmVybGF5Owo+ICAgCWlmICghb3Zlcmxh
eSkgewo+ICAgCQlEUk1fREVCVUcoInVzZXJzcGFjZSBidWc6IG5vIG92ZXJsYXlcbiIpOwo+ICAg
CQlyZXR1cm4gLUVOT0RFVjsKPiBAQCAtMTI1MSw3ICsxMjUxLDcgQEAgaW50IGludGVsX292ZXJs
YXlfYXR0cnNfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKPiAgIAkJ
YXR0cnMtPmNvbnRyYXN0ICAgPSBvdmVybGF5LT5jb250cmFzdDsKPiAgIAkJYXR0cnMtPnNhdHVy
YXRpb24gPSBvdmVybGF5LT5zYXR1cmF0aW9uOwo+ICAgCj4gLQkJaWYgKCFJU19HRU4oZGV2X3By
aXYsIDIpKSB7Cj4gKwkJaWYgKCFJU19HRU4oaTkxNSwgMikpIHsKPiAgIAkJCWF0dHJzLT5nYW1t
YTAgPSBJOTE1X1JFQUQoT0dBTUMwKTsKPiAgIAkJCWF0dHJzLT5nYW1tYTEgPSBJOTE1X1JFQUQo
T0dBTUMxKTsKPiAgIAkJCWF0dHJzLT5nYW1tYTIgPSBJOTE1X1JFQUQoT0dBTUMyKTsKPiBAQCAt
MTI3NSw3ICsxMjc1LDcgQEAgaW50IGludGVsX292ZXJsYXlfYXR0cnNfaW9jdGwoc3RydWN0IGRy
bV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKPiAgIAkJdXBkYXRlX3JlZ19hdHRycyhvdmVybGF5
LCBvdmVybGF5LT5yZWdzKTsKPiAgIAo+ICAgCQlpZiAoYXR0cnMtPmZsYWdzICYgSTkxNV9PVkVS
TEFZX1VQREFURV9HQU1NQSkgewo+IC0JCQlpZiAoSVNfR0VOKGRldl9wcml2LCAyKSkKPiArCQkJ
aWYgKElTX0dFTihpOTE1LCAyKSkKPiAgIAkJCQlnb3RvIG91dF91bmxvY2s7Cj4gICAKPiAgIAkJ
CWlmIChvdmVybGF5LT5hY3RpdmUpIHsKPiBAQCAtMTM1MSwxOSArMTM1MSwxOSBAQCBzdGF0aWMg
aW50IGdldF9yZWdpc3RlcnMoc3RydWN0IGludGVsX292ZXJsYXkgKm92ZXJsYXksIGJvb2wgdXNl
X3BoeXMpCj4gICAJcmV0dXJuIGVycjsKPiAgIH0KPiAgIAo+IC12b2lkIGludGVsX292ZXJsYXlf
c2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGludGVsX292
ZXJsYXlfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3Ry
dWN0IGludGVsX292ZXJsYXkgKm92ZXJsYXk7Cj4gICAJaW50IHJldDsKPiAgIAo+IC0JaWYgKCFI
QVNfT1ZFUkxBWShkZXZfcHJpdikpCj4gKwlpZiAoIUhBU19PVkVSTEFZKGk5MTUpKQo+ICAgCQly
ZXR1cm47Cj4gICAKPiAgIAlvdmVybGF5ID0ga3phbGxvYyhzaXplb2YoKm92ZXJsYXkpLCBHRlBf
S0VSTkVMKTsKPiAgIAlpZiAoIW92ZXJsYXkpCj4gICAJCXJldHVybjsKPiAgIAo+IC0Jb3Zlcmxh
eS0+aTkxNSA9IGRldl9wcml2Owo+ICsJb3ZlcmxheS0+aTkxNSA9IGk5MTU7Cj4gICAKPiAgIAlv
dmVybGF5LT5jb2xvcl9rZXkgPSAweDAxMDFmZTsKPiAgIAlvdmVybGF5LT5jb2xvcl9rZXlfZW5h
YmxlZCA9IHRydWU7Cj4gQEAgLTEzNzMsNyArMTM3Myw3IEBAIHZvaWQgaW50ZWxfb3ZlcmxheV9z
ZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAKPiAgIAlJTklUX0FD
VElWRV9SRVFVRVNUKCZvdmVybGF5LT5sYXN0X2ZsaXApOwo+ICAgCj4gLQlyZXQgPSBnZXRfcmVn
aXN0ZXJzKG92ZXJsYXksIE9WRVJMQVlfTkVFRFNfUEhZU0lDQUwoZGV2X3ByaXYpKTsKPiArCXJl
dCA9IGdldF9yZWdpc3RlcnMob3ZlcmxheSwgT1ZFUkxBWV9ORUVEU19QSFlTSUNBTChpOTE1KSk7
Cj4gICAJaWYgKHJldCkKPiAgIAkJZ290byBvdXRfZnJlZTsKPiAgIAo+IEBAIC0xMzg3LDcgKzEz
ODcsNyBAQCB2b2lkIGludGVsX292ZXJsYXlfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICAgCXVwZGF0ZV9wb2x5cGhhc2VfZmlsdGVyKG92ZXJsYXktPnJlZ3MpOwo+
ICAgCXVwZGF0ZV9yZWdfYXR0cnMob3ZlcmxheSwgb3ZlcmxheS0+cmVncyk7Cj4gICAKPiAtCWRl
dl9wcml2LT5vdmVybGF5ID0gb3ZlcmxheTsKPiArCWk5MTUtPm92ZXJsYXkgPSBvdmVybGF5Owo+
ICAgCURSTV9JTkZPKCJJbml0aWFsaXplZCBvdmVybGF5IHN1cHBvcnQuXG4iKTsKPiAgIAlyZXR1
cm47Cj4gICAKPiBAQCAtMTM5NywxMSArMTM5NywxMSBAQCB2b2lkIGludGVsX292ZXJsYXlfc2V0
dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCWtmcmVlKG92ZXJsYXkp
Owo+ICAgfQo+ICAgCj4gLXZvaWQgaW50ZWxfb3ZlcmxheV9jbGVhbnVwKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBpbnRlbF9vdmVybGF5X2NsZWFudXAoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX292ZXJsYXkg
Km92ZXJsYXk7Cj4gICAKPiAtCW92ZXJsYXkgPSBmZXRjaF9hbmRfemVybygmZGV2X3ByaXYtPm92
ZXJsYXkpOwo+ICsJb3ZlcmxheSA9IGZldGNoX2FuZF96ZXJvKCZpOTE1LT5vdmVybGF5KTsKPiAg
IAlpZiAoIW92ZXJsYXkpCj4gICAJCXJldHVybjsKPiAgIAo+IEBAIC0xNDI3LDkgKzE0MjcsOSBA
QCBzdHJ1Y3QgaW50ZWxfb3ZlcmxheV9lcnJvcl9zdGF0ZSB7Cj4gICB9Owo+ICAgCj4gICBzdHJ1
Y3QgaW50ZWxfb3ZlcmxheV9lcnJvcl9zdGF0ZSAqCj4gLWludGVsX292ZXJsYXlfY2FwdHVyZV9l
cnJvcl9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK2ludGVsX292
ZXJsYXlfY2FwdHVyZV9lcnJvcl9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiAgIHsKPiAtCXN0cnVjdCBpbnRlbF9vdmVybGF5ICpvdmVybGF5ID0gZGV2X3ByaXYtPm92ZXJs
YXk7Cj4gKwlzdHJ1Y3QgaW50ZWxfb3ZlcmxheSAqb3ZlcmxheSA9IGk5MTUtPm92ZXJsYXk7Cj4g
ICAJc3RydWN0IGludGVsX292ZXJsYXlfZXJyb3Jfc3RhdGUgKmVycm9yOwo+ICAgCj4gICAJaWYg
KCFvdmVybGF5IHx8ICFvdmVybGF5LT5hY3RpdmUpCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX292ZXJsYXkuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX292
ZXJsYXkuaAo+IGluZGV4IGExNjdjMjhhY2QyNy4uMmU4NzcxY2ZmZWU5IDEwMDY0NAo+IC0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX292ZXJsYXkuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX292ZXJsYXkuaAo+IEBAIC0xMywxNiArMTMsMTYgQEAgc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGU7Cj4gICBzdHJ1Y3QgaW50ZWxfb3ZlcmxheTsKPiAgIHN0cnVjdCBpbnRl
bF9vdmVybGF5X2Vycm9yX3N0YXRlOwo+ICAgCj4gLXZvaWQgaW50ZWxfb3ZlcmxheV9zZXR1cChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGludGVsX292ZXJsYXlf
Y2xlYW51cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ICt2b2lkIGludGVs
X292ZXJsYXlfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lkIGlu
dGVsX292ZXJsYXlfY2xlYW51cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICBp
bnQgaW50ZWxfb3ZlcmxheV9zd2l0Y2hfb2ZmKHN0cnVjdCBpbnRlbF9vdmVybGF5ICpvdmVybGF5
KTsKPiAgIGludCBpbnRlbF9vdmVybGF5X3B1dF9pbWFnZV9pb2N0bChzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2LCB2b2lkICpkYXRhLAo+ICAgCQkJCSAgc3RydWN0IGRybV9maWxlICpmaWxlX3ByaXYp
Owo+ICAgaW50IGludGVsX292ZXJsYXlfYXR0cnNfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRl
diwgdm9pZCAqZGF0YSwKPiAgIAkJCSAgICAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wcml2KTsK
PiAtdm9pZCBpbnRlbF9vdmVybGF5X3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdik7Cj4gK3ZvaWQgaW50ZWxfb3ZlcmxheV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSk7Cj4gICBzdHJ1Y3QgaW50ZWxfb3ZlcmxheV9lcnJvcl9zdGF0ZSAqCj4gLWludGVs
X292ZXJsYXlfY2FwdHVyZV9lcnJvcl9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpOwo+ICtpbnRlbF9vdmVybGF5X2NhcHR1cmVfZXJyb3Jfc3RhdGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgdm9pZCBpbnRlbF9vdmVybGF5X3ByaW50X2Vycm9yX3N0
YXRlKHN0cnVjdCBkcm1faTkxNV9lcnJvcl9zdGF0ZV9idWYgKmUsCj4gICAJCQkJICAgICBzdHJ1
Y3QgaW50ZWxfb3ZlcmxheV9lcnJvcl9zdGF0ZSAqZXJyb3IpOwo+ICAgCj4gZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BhbmVsLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9wYW5lbC5jCj4gaW5kZXggOWNkNGUzN2UzOTM0Li5kODAxMTUwODk0NDUgMTAwNjQ0
Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcGFuZWwuYwo+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX3BhbmVsLmMKPiBAQCAtNjUsNyArNjUsNyBAQCBzdHJ1Y3Qg
ZHJtX2Rpc3BsYXlfbW9kZSAqCj4gICBpbnRlbF9wYW5lbF9lZGlkX2Rvd25jbG9ja19tb2RlKHN0
cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwKPiAgIAkJCQljb25zdCBzdHJ1Y3QgZHJt
X2Rpc3BsYXlfbW9kZSAqZml4ZWRfbW9kZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4g
ICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKnNjYW4sICpiZXN0X21vZGUgPSBOVUxM
Owo+ICAgCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICpkb3duY2xvY2tfbW9kZTsKPiAgIAlpbnQg
YmVzdF9jbG9jayA9IGZpeGVkX21vZGUtPmNsb2NrOwo+IEBAIC05Miw3ICs5Miw3IEBAIGludGVs
X3BhbmVsX2VkaWRfZG93bmNsb2NrX21vZGUoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVj
dG9yLAo+ICAgCWlmICghYmVzdF9tb2RlKQo+ICAgCQlyZXR1cm4gTlVMTDsKPiAgIAo+IC0JZG93
bmNsb2NrX21vZGUgPSBkcm1fbW9kZV9kdXBsaWNhdGUoJmRldl9wcml2LT5kcm0sIGJlc3RfbW9k
ZSk7Cj4gKwlkb3duY2xvY2tfbW9kZSA9IGRybV9tb2RlX2R1cGxpY2F0ZSgmaTkxNS0+ZHJtLCBi
ZXN0X21vZGUpOwo+ICAgCWlmICghZG93bmNsb2NrX21vZGUpCj4gICAJCXJldHVybiBOVUxMOwo+
ICAgCj4gQEAgLTEwNiw3ICsxMDYsNyBAQCBpbnRlbF9wYW5lbF9lZGlkX2Rvd25jbG9ja19tb2Rl
KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwKPiAgIHN0cnVjdCBkcm1fZGlzcGxh
eV9tb2RlICoKPiAgIGludGVsX3BhbmVsX2VkaWRfZml4ZWRfbW9kZShzdHJ1Y3QgaW50ZWxfY29u
bmVjdG9yICpjb25uZWN0b3IpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICAgCWNvbnN0
IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICpzY2FuOwo+ICAgCXN0cnVjdCBkcm1fZGlzcGxheV9t
b2RlICpmaXhlZF9tb2RlOwo+ICAgCj4gQEAgLTExOCw3ICsxMTgsNyBAQCBpbnRlbF9wYW5lbF9l
ZGlkX2ZpeGVkX21vZGUoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ICAgCQlp
ZiAoKHNjYW4tPnR5cGUgJiBEUk1fTU9ERV9UWVBFX1BSRUZFUlJFRCkgPT0gMCkKPiAgIAkJCWNv
bnRpbnVlOwo+ICAgCj4gLQkJZml4ZWRfbW9kZSA9IGRybV9tb2RlX2R1cGxpY2F0ZSgmZGV2X3By
aXYtPmRybSwgc2Nhbik7Cj4gKwkJZml4ZWRfbW9kZSA9IGRybV9tb2RlX2R1cGxpY2F0ZSgmaTkx
NS0+ZHJtLCBzY2FuKTsKPiAgIAkJaWYgKCFmaXhlZF9tb2RlKQo+ICAgCQkJcmV0dXJuIE5VTEw7
Cj4gICAKPiBAQCAtMTMyLDcgKzEzMiw3IEBAIGludGVsX3BhbmVsX2VkaWRfZml4ZWRfbW9kZShz
dHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gICAJc2NhbiA9IGxpc3RfZmlyc3Rf
ZW50cnkoJmNvbm5lY3Rvci0+YmFzZS5wcm9iZWRfbW9kZXMsCj4gICAJCQkJdHlwZW9mKCpzY2Fu
KSwgaGVhZCk7Cj4gICAKPiAtCWZpeGVkX21vZGUgPSBkcm1fbW9kZV9kdXBsaWNhdGUoJmRldl9w
cml2LT5kcm0sIHNjYW4pOwo+ICsJZml4ZWRfbW9kZSA9IGRybV9tb2RlX2R1cGxpY2F0ZSgmaTkx
NS0+ZHJtLCBzY2FuKTsKPiAgIAlpZiAoIWZpeGVkX21vZGUpCj4gICAJCXJldHVybiBOVUxMOwo+
ICAgCj4gQEAgLTE0OCwxNSArMTQ4LDE1IEBAIGludGVsX3BhbmVsX2VkaWRfZml4ZWRfbW9kZShz
dHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gICBzdHJ1Y3QgZHJtX2Rpc3BsYXlf
bW9kZSAqCj4gICBpbnRlbF9wYW5lbF92YnRfZml4ZWRfbW9kZShzdHJ1Y3QgaW50ZWxfY29ubmVj
dG9yICpjb25uZWN0b3IpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBk
cm1fZGlzcGxheV9pbmZvICppbmZvID0gJmNvbm5lY3Rvci0+YmFzZS5kaXNwbGF5X2luZm87Cj4g
ICAJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmZpeGVkX21vZGU7Cj4gICAKPiAtCWlmICghZGV2
X3ByaXYtPnZidC5sZnBfbHZkc192YnRfbW9kZSkKPiArCWlmICghaTkxNS0+dmJ0LmxmcF9sdmRz
X3ZidF9tb2RlKQo+ICAgCQlyZXR1cm4gTlVMTDsKPiAgIAo+IC0JZml4ZWRfbW9kZSA9IGRybV9t
b2RlX2R1cGxpY2F0ZSgmZGV2X3ByaXYtPmRybSwKPiAtCQkJCQlkZXZfcHJpdi0+dmJ0LmxmcF9s
dmRzX3ZidF9tb2RlKTsKPiArCWZpeGVkX21vZGUgPSBkcm1fbW9kZV9kdXBsaWNhdGUoJmk5MTUt
PmRybSwKPiArCQkJCQlpOTE1LT52YnQubGZwX2x2ZHNfdmJ0X21vZGUpOwo+ICAgCWlmICghZml4
ZWRfbW9kZSkKPiAgIAkJcmV0dXJuIE5VTEw7Cj4gICAKPiBAQCAtMzc4LDcgKzM3OCw3IEBAIHZv
aWQgaW50ZWxfZ21jaF9wYW5lbF9maXR0aW5nKHN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRj
LAo+ICAgCQkJICAgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ICAg
CQkJICAgICAgaW50IGZpdHRpbmdfbW9kZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoaW50ZWxfY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGludGVsX2NydGMtPmJhc2UuZGV2KTsK
PiAgIAl1MzIgcGZpdF9jb250cm9sID0gMCwgcGZpdF9wZ21fcmF0aW9zID0gMCwgYm9yZGVyID0g
MDsKPiAgIAlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2Nv
bmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICAgCj4gQEAgLTM5OSw3ICszOTksNyBAQCB2b2lk
IGludGVsX2dtY2hfcGFuZWxfZml0dGluZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YywK
PiAgIAkJYnJlYWs7Cj4gICAJY2FzZSBEUk1fTU9ERV9TQ0FMRV9BU1BFQ1Q6Cj4gICAJCS8qIFNj
YWxlIGJ1dCBwcmVzZXJ2ZSB0aGUgYXNwZWN0IHJhdGlvICovCj4gLQkJaWYgKElOVEVMX0dFTihk
ZXZfcHJpdikgPj0gNCkKPiArCQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDQpCj4gICAJCQlpOTY1
X3NjYWxlX2FzcGVjdChwaXBlX2NvbmZpZywgJnBmaXRfY29udHJvbCk7Cj4gICAJCWVsc2UKPiAg
IAkJCWk5eHhfc2NhbGVfYXNwZWN0KHBpcGVfY29uZmlnLCAmcGZpdF9jb250cm9sLAo+IEBAIC00
MTMsNyArNDEzLDcgQEAgdm9pZCBpbnRlbF9nbWNoX3BhbmVsX2ZpdHRpbmcoc3RydWN0IGludGVs
X2NydGMgKmludGVsX2NydGMsCj4gICAJCWlmIChwaXBlX2NvbmZpZy0+cGlwZV9zcmNfaCAhPSBh
ZGp1c3RlZF9tb2RlLT5jcnRjX3ZkaXNwbGF5IHx8Cj4gICAJCSAgICBwaXBlX2NvbmZpZy0+cGlw
ZV9zcmNfdyAhPSBhZGp1c3RlZF9tb2RlLT5jcnRjX2hkaXNwbGF5KSB7Cj4gICAJCQlwZml0X2Nv
bnRyb2wgfD0gUEZJVF9FTkFCTEU7Cj4gLQkJCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDQp
Cj4gKwkJCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNCkKPiAgIAkJCQlwZml0X2NvbnRyb2wgfD0g
UEZJVF9TQ0FMSU5HX0FVVE87Cj4gICAJCQllbHNlCj4gICAJCQkJcGZpdF9jb250cm9sIHw9IChW
RVJUX0FVVE9fU0NBTEUgfAo+IEBAIC00MjksNyArNDI5LDcgQEAgdm9pZCBpbnRlbF9nbWNoX3Bh
bmVsX2ZpdHRpbmcoc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMsCj4gICAKPiAgIAkvKiA5
NjUrIHdhbnRzIGZ1enp5IGZpdHRpbmcgKi8KPiAgIAkvKiBGSVhNRTogaGFuZGxlIG11bHRpcGxl
IHBhbmVscyBieSBmYWlsaW5nIGdyYWNlZnVsbHkgKi8KPiAtCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDQpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDQpCj4gICAJCXBmaXRfY29udHJv
bCB8PSAoKGludGVsX2NydGMtPnBpcGUgPDwgUEZJVF9QSVBFX1NISUZUKSB8Cj4gICAJCQkJIFBG
SVRfRklMVEVSX0ZVWlpZKTsKPiAgIAo+IEBAIC00NDAsNyArNDQwLDcgQEAgdm9pZCBpbnRlbF9n
bWNoX3BhbmVsX2ZpdHRpbmcoc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMsCj4gICAJfQo+
ICAgCj4gICAJLyogTWFrZSBzdXJlIHByZS05NjUgc2V0IGRpdGhlciBjb3JyZWN0bHkgZm9yIDE4
YnBwIHBhbmVscy4gKi8KPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNCAmJiBwaXBlX2Nv
bmZpZy0+cGlwZV9icHAgPT0gMTgpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgNCAmJiBwaXBl
X2NvbmZpZy0+cGlwZV9icHAgPT0gMTgpCj4gICAJCXBmaXRfY29udHJvbCB8PSBQQU5FTF84VE82
X0RJVEhFUl9FTkFCTEU7Cj4gICAKPiAgIAlwaXBlX2NvbmZpZy0+Z21jaF9wZml0LmNvbnRyb2wg
PSBwZml0X2NvbnRyb2w7Cj4gQEAgLTUxNyw3ICs1MTcsNyBAQCBzdGF0aWMgaW5saW5lIHUzMiBz
Y2FsZV9od190b191c2VyKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwKPiAgIHN0
YXRpYyB1MzIgaW50ZWxfcGFuZWxfY29tcHV0ZV9icmlnaHRuZXNzKHN0cnVjdCBpbnRlbF9jb25u
ZWN0b3IgKmNvbm5lY3RvciwKPiAgIAkJCQkJICB1MzIgdmFsKQo+ICAgewo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsK
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJh
c2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfcGFuZWwgKnBhbmVsID0gJmNvbm5lY3Rvci0+cGFu
ZWw7Cj4gICAKPiAgIAlXQVJOX09OKHBhbmVsLT5iYWNrbGlnaHQubWF4ID09IDApOwo+IEBAIC01
MjYsNyArNTI2LDcgQEAgc3RhdGljIHUzMiBpbnRlbF9wYW5lbF9jb21wdXRlX2JyaWdodG5lc3Mo
c3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+ICAgCQlyZXR1cm4gdmFsOwo+ICAg
Cj4gICAJaWYgKGk5MTVfbW9kcGFyYW1zLmludmVydF9icmlnaHRuZXNzID4gMCB8fAo+IC0JICAg
IGRldl9wcml2LT5xdWlya3MgJiBRVUlSS19JTlZFUlRfQlJJR0hUTkVTUykgewo+ICsJICAgIGk5
MTUtPnF1aXJrcyAmIFFVSVJLX0lOVkVSVF9CUklHSFRORVNTKSB7Cj4gICAJCXJldHVybiBwYW5l
bC0+YmFja2xpZ2h0Lm1heCAtIHZhbCArIHBhbmVsLT5iYWNrbGlnaHQubWluOwo+ICAgCX0KPiAg
IAo+IEBAIC01MzUsMzkgKzUzNSwzOSBAQCBzdGF0aWMgdTMyIGludGVsX3BhbmVsX2NvbXB1dGVf
YnJpZ2h0bmVzcyhzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IsCj4gICAKPiAgIHN0
YXRpYyB1MzIgbHB0X2dldF9iYWNrbGlnaHQoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVj
dG9yKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiAgIAo+ICAgCXJldHVybiBJOTE1X1JF
QUQoQkxDX1BXTV9QQ0hfQ1RMMikgJiBCQUNLTElHSFRfRFVUWV9DWUNMRV9NQVNLOwo+ICAgfQo+
ICAgCj4gICBzdGF0aWMgdTMyIHBjaF9nZXRfYmFja2xpZ2h0KHN0cnVjdCBpbnRlbF9jb25uZWN0
b3IgKmNvbm5lY3RvcikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gICAKPiAgIAlyZXR1
cm4gSTkxNV9SRUFEKEJMQ19QV01fQ1BVX0NUTCkgJiBCQUNLTElHSFRfRFVUWV9DWUNMRV9NQVNL
Owo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdTMyIGk5eHhfZ2V0X2JhY2tsaWdodChzdHJ1Y3QgaW50
ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICAg
CXN0cnVjdCBpbnRlbF9wYW5lbCAqcGFuZWwgPSAmY29ubmVjdG9yLT5wYW5lbDsKPiAgIAl1MzIg
dmFsOwo+ICAgCj4gICAJdmFsID0gSTkxNV9SRUFEKEJMQ19QV01fQ1RMKSAmIEJBQ0tMSUdIVF9E
VVRZX0NZQ0xFX01BU0s7Cj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDQpCj4gKwlpZiAo
SU5URUxfR0VOKGk5MTUpIDwgNCkKPiAgIAkJdmFsID4+PSAxOwo+ICAgCj4gICAJaWYgKHBhbmVs
LT5iYWNrbGlnaHQuY29tYmluYXRpb25fbW9kZSkgewo+ICAgCQl1OCBsYnBjOwo+ICAgCj4gLQkJ
cGNpX3JlYWRfY29uZmlnX2J5dGUoZGV2X3ByaXYtPmRybS5wZGV2LCBMQlBDLCAmbGJwYyk7Cj4g
KwkJcGNpX3JlYWRfY29uZmlnX2J5dGUoaTkxNS0+ZHJtLnBkZXYsIExCUEMsICZsYnBjKTsKPiAg
IAkJdmFsICo9IGxicGM7Cj4gICAJfQo+ICAgCj4gICAJcmV0dXJuIHZhbDsKPiAgIH0KPiAgIAo+
IC1zdGF0aWMgdTMyIF92bHZfZ2V0X2JhY2tsaWdodChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsIGVudW0gcGlwZSBwaXBlKQo+ICtzdGF0aWMgdTMyIF92bHZfZ2V0X2JhY2tsaWdo
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBwaXBlIHBpcGUpCj4gICB7Cj4g
ICAJaWYgKFdBUk5fT04ocGlwZSAhPSBQSVBFX0EgJiYgcGlwZSAhPSBQSVBFX0IpKQo+ICAgCQly
ZXR1cm4gMDsKPiBAQCAtNTc3LDE1ICs1NzcsMTUgQEAgc3RhdGljIHUzMiBfdmx2X2dldF9iYWNr
bGlnaHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUgcGlwZSkK
PiAgIAo+ICAgc3RhdGljIHUzMiB2bHZfZ2V0X2JhY2tsaWdodChzdHJ1Y3QgaW50ZWxfY29ubmVj
dG9yICpjb25uZWN0b3IpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICAgCWVudW0gcGlw
ZSBwaXBlID0gaW50ZWxfY29ubmVjdG9yX2dldF9waXBlKGNvbm5lY3Rvcik7Cj4gICAKPiAtCXJl
dHVybiBfdmx2X2dldF9iYWNrbGlnaHQoZGV2X3ByaXYsIHBpcGUpOwo+ICsJcmV0dXJuIF92bHZf
Z2V0X2JhY2tsaWdodChpOTE1LCBwaXBlKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHUzMiBieHRf
Z2V0X2JhY2tsaWdodChzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gICB7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+
YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNv
bm5lY3Rvci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9wYW5lbCAqcGFuZWwgPSAmY29u
bmVjdG9yLT5wYW5lbDsKPiAgIAo+ICAgCXJldHVybiBJOTE1X1JFQUQoQlhUX0JMQ19QV01fRFVU
WShwYW5lbC0+YmFja2xpZ2h0LmNvbnRyb2xsZXIpKTsKPiBAQCAtNjAzLDcgKzYwMyw3IEBAIHN0
YXRpYyB1MzIgcHdtX2dldF9iYWNrbGlnaHQoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVj
dG9yKQo+ICAgc3RhdGljIHZvaWQgbHB0X3NldF9iYWNrbGlnaHQoY29uc3Qgc3RydWN0IGRybV9j
b25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUsIHUzMiBsZXZlbCkKPiAgIHsKPiAgIAlzdHJ1Y3Qg
aW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IgPSB0b19pbnRlbF9jb25uZWN0b3IoY29ubl9zdGF0
ZS0+Y29ubmVjdG9yKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gICAKPiAgIAl1MzIgdmFsID0g
STkxNV9SRUFEKEJMQ19QV01fUENIX0NUTDIpICYgfkJBQ0tMSUdIVF9EVVRZX0NZQ0xFX01BU0s7
Cj4gICAJSTkxNV9XUklURShCTENfUFdNX1BDSF9DVEwyLCB2YWwgfCBsZXZlbCk7Cj4gQEAgLTYx
Miw3ICs2MTIsNyBAQCBzdGF0aWMgdm9pZCBscHRfc2V0X2JhY2tsaWdodChjb25zdCBzdHJ1Y3Qg
ZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSwgdTMyCj4gICBzdGF0aWMgdm9pZCBwY2hf
c2V0X2JhY2tsaWdodChjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0
ZSwgdTMyIGxldmVsKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3Rv
ciA9IHRvX2ludGVsX2Nvbm5lY3Rvcihjb25uX3N0YXRlLT5jb25uZWN0b3IpOwo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2
KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3It
PmJhc2UuZGV2KTsKPiAgIAl1MzIgdG1wOwo+ICAgCj4gICAJdG1wID0gSTkxNV9SRUFEKEJMQ19Q
V01fQ1BVX0NUTCkgJiB+QkFDS0xJR0hUX0RVVFlfQ1lDTEVfTUFTSzsKPiBAQCAtNjIyLDcgKzYy
Miw3IEBAIHN0YXRpYyB2b2lkIHBjaF9zZXRfYmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBkcm1fY29u
bmVjdG9yX3N0YXRlICpjb25uX3N0YXRlLCB1MzIKPiAgIHN0YXRpYyB2b2lkIGk5eHhfc2V0X2Jh
Y2tsaWdodChjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSwgdTMy
IGxldmVsKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciA9IHRv
X2ludGVsX2Nvbm5lY3Rvcihjb25uX3N0YXRlLT5jb25uZWN0b3IpOwo+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2Uu
ZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfcGFuZWwgKnBhbmVsID0gJmNvbm5lY3Rvci0+cGFuZWw7
Cj4gICAJdTMyIHRtcCwgbWFzazsKPiAgIAo+IEBAIC02MzMsMTAgKzYzMywxMCBAQCBzdGF0aWMg
dm9pZCBpOXh4X3NldF9iYWNrbGlnaHQoY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUg
KmNvbm5fc3RhdGUsIHUzMgo+ICAgCj4gICAJCWxicGMgPSBsZXZlbCAqIDB4ZmUgLyBwYW5lbC0+
YmFja2xpZ2h0Lm1heCArIDE7Cj4gICAJCWxldmVsIC89IGxicGM7Cj4gLQkJcGNpX3dyaXRlX2Nv
bmZpZ19ieXRlKGRldl9wcml2LT5kcm0ucGRldiwgTEJQQywgbGJwYyk7Cj4gKwkJcGNpX3dyaXRl
X2NvbmZpZ19ieXRlKGk5MTUtPmRybS5wZGV2LCBMQlBDLCBsYnBjKTsKPiAgIAl9Cj4gICAKPiAt
CWlmIChJU19HRU4oZGV2X3ByaXYsIDQpKSB7Cj4gKwlpZiAoSVNfR0VOKGk5MTUsIDQpKSB7Cj4g
ICAJCW1hc2sgPSBCQUNLTElHSFRfRFVUWV9DWUNMRV9NQVNLOwo+ICAgCX0gZWxzZSB7Cj4gICAJ
CWxldmVsIDw8PSAxOwo+IEBAIC02NTAsNyArNjUwLDcgQEAgc3RhdGljIHZvaWQgaTl4eF9zZXRf
YmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlLCB1
MzIKPiAgIHN0YXRpYyB2b2lkIHZsdl9zZXRfYmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBkcm1fY29u
bmVjdG9yX3N0YXRlICpjb25uX3N0YXRlLCB1MzIgbGV2ZWwpCj4gICB7Cj4gICAJc3RydWN0IGlu
dGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gdG9faW50ZWxfY29ubmVjdG9yKGNvbm5fc3RhdGUt
PmNvbm5lY3Rvcik7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICAgCWVudW0gcGlwZSBwaXBlID0g
dG9faW50ZWxfY3J0Yyhjb25uX3N0YXRlLT5jcnRjKS0+cGlwZTsKPiAgIAl1MzIgdG1wOwo+ICAg
Cj4gQEAgLTY2MSw3ICs2NjEsNyBAQCBzdGF0aWMgdm9pZCB2bHZfc2V0X2JhY2tsaWdodChjb25z
dCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSwgdTMyCj4gICBzdGF0aWMg
dm9pZCBieHRfc2V0X2JhY2tsaWdodChjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAq
Y29ubl9zdGF0ZSwgdTMyIGxldmVsKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9jb25uZWN0b3Ig
KmNvbm5lY3RvciA9IHRvX2ludGVsX2Nvbm5lY3Rvcihjb25uX3N0YXRlLT5jb25uZWN0b3IpOwo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3It
PmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShj
b25uZWN0b3ItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfcGFuZWwgKnBhbmVsID0gJmNv
bm5lY3Rvci0+cGFuZWw7Cj4gICAKPiAgIAlJOTE1X1dSSVRFKEJYVF9CTENfUFdNX0RVVFkocGFu
ZWwtPmJhY2tsaWdodC5jb250cm9sbGVyKSwgbGV2ZWwpOwo+IEBAIC02OTQsNyArNjk0LDcgQEAg
dm9pZCBpbnRlbF9wYW5lbF9zZXRfYmFja2xpZ2h0X2FjcGkoY29uc3Qgc3RydWN0IGRybV9jb25u
ZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUKPiAgIAkJCQkgICAgdTMyIHVzZXJfbGV2ZWwsIHUzMiB1
c2VyX21heCkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IgPSB0
b19pbnRlbF9jb25uZWN0b3IoY29ubl9zdGF0ZS0+Y29ubmVjdG9yKTsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNl
LmRldik7Cj4gICAJc3RydWN0IGludGVsX3BhbmVsICpwYW5lbCA9ICZjb25uZWN0b3ItPnBhbmVs
Owo+ICAgCXUzMiBod19sZXZlbDsKPiAgIAo+IEBAIC03MDcsNyArNzA3LDcgQEAgdm9pZCBpbnRl
bF9wYW5lbF9zZXRfYmFja2xpZ2h0X2FjcGkoY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3Rh
dGUgKmNvbm5fc3RhdGUKPiAgIAlpZiAoIXBhbmVsLT5iYWNrbGlnaHQucHJlc2VudCB8fCAhY29u
bl9zdGF0ZS0+Y3J0YykKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZfcHJp
di0+YmFja2xpZ2h0X2xvY2spOwo+ICsJbXV0ZXhfbG9jaygmaTkxNS0+YmFja2xpZ2h0X2xvY2sp
Owo+ICAgCj4gICAJV0FSTl9PTihwYW5lbC0+YmFja2xpZ2h0Lm1heCA9PSAwKTsKPiAgIAo+IEBA
IC03MjMsMTMgKzcyMywxMyBAQCB2b2lkIGludGVsX3BhbmVsX3NldF9iYWNrbGlnaHRfYWNwaShj
b25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZQo+ICAgCWlmIChwYW5l
bC0+YmFja2xpZ2h0LmVuYWJsZWQpCj4gICAJCWludGVsX3BhbmVsX2FjdHVhbGx5X3NldF9iYWNr
bGlnaHQoY29ubl9zdGF0ZSwgaHdfbGV2ZWwpOwo+ICAgCj4gLQltdXRleF91bmxvY2soJmRldl9w
cml2LT5iYWNrbGlnaHRfbG9jayk7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPmJhY2tsaWdodF9s
b2NrKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgbHB0X2Rpc2FibGVfYmFja2xpZ2h0KGNv
bnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKPiAgIHsKPiAg
IAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IgPSB0b19pbnRlbF9jb25uZWN0b3Io
b2xkX2Nvbm5fc3RhdGUtPmNvbm5lY3Rvcik7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICAgCXUz
MiB0bXA7Cj4gICAKPiAgIAlpbnRlbF9wYW5lbF9hY3R1YWxseV9zZXRfYmFja2xpZ2h0KG9sZF9j
b25uX3N0YXRlLCAwKTsKPiBAQCAtNzU1LDcgKzc1NSw3IEBAIHN0YXRpYyB2b2lkIGxwdF9kaXNh
YmxlX2JhY2tsaWdodChjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5f
c3RhCj4gICBzdGF0aWMgdm9pZCBwY2hfZGlzYWJsZV9iYWNrbGlnaHQoY29uc3Qgc3RydWN0IGRy
bV9jb25uZWN0b3Jfc3RhdGUgKm9sZF9jb25uX3N0YXRlKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRl
bF9jb25uZWN0b3IgKmNvbm5lY3RvciA9IHRvX2ludGVsX2Nvbm5lY3RvcihvbGRfY29ubl9zdGF0
ZS0+Y29ubmVjdG9yKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gICAJdTMyIHRtcDsKPiAgIAo+
ICAgCWludGVsX3BhbmVsX2FjdHVhbGx5X3NldF9iYWNrbGlnaHQob2xkX2Nvbm5fc3RhdGUsIDAp
Owo+IEBAIC03NzQsNyArNzc0LDcgQEAgc3RhdGljIHZvaWQgaTl4eF9kaXNhYmxlX2JhY2tsaWdo
dChjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3QKPiAgIAo+ICAg
c3RhdGljIHZvaWQgaTk2NV9kaXNhYmxlX2JhY2tsaWdodChjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5l
Y3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KG9sZF9jb25uX3N0YXRlLT5jb25uZWN0b3ItPmRldik7
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUob2xkX2Nvbm5fc3Rh
dGUtPmNvbm5lY3Rvci0+ZGV2KTsKPiAgIAl1MzIgdG1wOwo+ICAgCj4gICAJaW50ZWxfcGFuZWxf
YWN0dWFsbHlfc2V0X2JhY2tsaWdodChvbGRfY29ubl9zdGF0ZSwgMCk7Cj4gQEAgLTc4Niw3ICs3
ODYsNyBAQCBzdGF0aWMgdm9pZCBpOTY1X2Rpc2FibGVfYmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBk
cm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdAo+ICAgc3RhdGljIHZvaWQgdmx2X2Rpc2Fi
bGVfYmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9z
dGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IgPSB0b19p
bnRlbF9jb25uZWN0b3Iob2xkX2Nvbm5fc3RhdGUtPmNvbm5lY3Rvcik7Cj4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFz
ZS5kZXYpOwo+ICAgCWVudW0gcGlwZSBwaXBlID0gdG9faW50ZWxfY3J0YyhvbGRfY29ubl9zdGF0
ZS0+Y3J0YyktPnBpcGU7Cj4gICAJdTMyIHRtcDsKPiAgIAo+IEBAIC03OTksNyArNzk5LDcgQEAg
c3RhdGljIHZvaWQgdmx2X2Rpc2FibGVfYmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBkcm1fY29ubmVj
dG9yX3N0YXRlICpvbGRfY29ubl9zdGEKPiAgIHN0YXRpYyB2b2lkIGJ4dF9kaXNhYmxlX2JhY2ts
aWdodChjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCj4g
ICB7Cj4gICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gdG9faW50ZWxfY29u
bmVjdG9yKG9sZF9jb25uX3N0YXRlLT5jb25uZWN0b3IpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsK
PiAgIAlzdHJ1Y3QgaW50ZWxfcGFuZWwgKnBhbmVsID0gJmNvbm5lY3Rvci0+cGFuZWw7Cj4gICAJ
dTMyIHRtcCwgdmFsOwo+ICAgCj4gQEAgLTgxOSw3ICs4MTksNyBAQCBzdGF0aWMgdm9pZCBieHRf
ZGlzYWJsZV9iYWNrbGlnaHQoY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKm9sZF9j
b25uX3N0YQo+ICAgc3RhdGljIHZvaWQgY25wX2Rpc2FibGVfYmFja2xpZ2h0KGNvbnN0IHN0cnVj
dCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3Qg
aW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IgPSB0b19pbnRlbF9jb25uZWN0b3Iob2xkX2Nvbm5f
c3RhdGUtPmNvbm5lY3Rvcik7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRl
bF9wYW5lbCAqcGFuZWwgPSAmY29ubmVjdG9yLT5wYW5lbDsKPiAgIAl1MzIgdG1wOwo+ICAgCj4g
QEAgLTg0NCw3ICs4NDQsNyBAQCBzdGF0aWMgdm9pZCBwd21fZGlzYWJsZV9iYWNrbGlnaHQoY29u
c3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKm9sZF9jb25uX3N0YQo+ICAgdm9pZCBpbnRl
bF9wYW5lbF9kaXNhYmxlX2JhY2tsaWdodChjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0
ZSAqb2xkX2Nvbm5fc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29u
bmVjdG9yID0gdG9faW50ZWxfY29ubmVjdG9yKG9sZF9jb25uX3N0YXRlLT5jb25uZWN0b3IpOwo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3It
PmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShj
b25uZWN0b3ItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfcGFuZWwgKnBhbmVsID0gJmNv
bm5lY3Rvci0+cGFuZWw7Cj4gICAKPiAgIAlpZiAoIXBhbmVsLT5iYWNrbGlnaHQucHJlc2VudCkK
PiBAQCAtODU2LDI2ICs4NTYsMjYgQEAgdm9pZCBpbnRlbF9wYW5lbF9kaXNhYmxlX2JhY2tsaWdo
dChjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3QKPiAgIAkgKiBi
YWNrbGlnaHQuIFRoaXMgd2lsbCBsZWF2ZSB0aGUgYmFja2xpZ2h0IG9uIHVubmVjZXNzYXJpbHkg
d2hlbgo+ICAgCSAqIGFub3RoZXIgY2xpZW50IGlzIG5vdCBhY3RpdmF0ZWQuCj4gICAJICovCj4g
LQlpZiAoZGV2X3ByaXYtPmRybS5zd2l0Y2hfcG93ZXJfc3RhdGUgPT0gRFJNX1NXSVRDSF9QT1dF
Ul9DSEFOR0lORykgewo+ICsJaWYgKGk5MTUtPmRybS5zd2l0Y2hfcG93ZXJfc3RhdGUgPT0gRFJN
X1NXSVRDSF9QT1dFUl9DSEFOR0lORykgewo+ICAgCQlEUk1fREVCVUdfRFJJVkVSKCJTa2lwcGlu
ZyBiYWNrbGlnaHQgZGlzYWJsZSBvbiB2Z2Egc3dpdGNoXG4iKTsKPiAgIAkJcmV0dXJuOwo+ICAg
CX0KPiAgIAo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmJhY2tsaWdodF9sb2NrKTsKPiArCW11
dGV4X2xvY2soJmk5MTUtPmJhY2tsaWdodF9sb2NrKTsKPiAgIAo+ICAgCWlmIChwYW5lbC0+YmFj
a2xpZ2h0LmRldmljZSkKPiAgIAkJcGFuZWwtPmJhY2tsaWdodC5kZXZpY2UtPnByb3BzLnBvd2Vy
ID0gRkJfQkxBTktfUE9XRVJET1dOOwo+ICAgCXBhbmVsLT5iYWNrbGlnaHQuZW5hYmxlZCA9IGZh
bHNlOwo+ICAgCXBhbmVsLT5iYWNrbGlnaHQuZGlzYWJsZShvbGRfY29ubl9zdGF0ZSk7Cj4gICAK
PiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmJhY2tsaWdodF9sb2NrKTsKPiArCW11dGV4X3Vu
bG9jaygmaTkxNS0+YmFja2xpZ2h0X2xvY2spOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZCBs
cHRfZW5hYmxlX2JhY2tsaWdodChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSwKPiAgIAkJCQkgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3Rh
dGUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gdG9faW50
ZWxfY29ubmVjdG9yKGNvbm5fc3RhdGUtPmNvbm5lY3Rvcik7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYp
Owo+ICAgCXN0cnVjdCBpbnRlbF9wYW5lbCAqcGFuZWwgPSAmY29ubmVjdG9yLT5wYW5lbDsKPiAg
IAl1MzIgcGNoX2N0bDEsIHBjaF9jdGwyLCBzY2hpY2tlbjsKPiAgIAo+IEBAIC04ODYsNyArODg2
LDcgQEAgc3RhdGljIHZvaWQgbHB0X2VuYWJsZV9iYWNrbGlnaHQoY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICAJCUk5MTVfV1JJVEUoQkxDX1BXTV9QQ0hfQ1RM
MSwgcGNoX2N0bDEpOwo+ICAgCX0KPiAgIAo+IC0JaWYgKEhBU19QQ0hfTFBUKGRldl9wcml2KSkg
ewo+ICsJaWYgKEhBU19QQ0hfTFBUKGk5MTUpKSB7Cj4gICAJCXNjaGlja2VuID0gSTkxNV9SRUFE
KFNPVVRIX0NISUNLRU4yKTsKPiAgIAkJaWYgKHBhbmVsLT5iYWNrbGlnaHQuYWx0ZXJuYXRlX3B3
bV9pbmNyZW1lbnQpCj4gICAJCQlzY2hpY2tlbiB8PSBMUFRfUFdNX0dSQU5VTEFSSVRZOwo+IEBA
IC05MTAsNyArOTEwLDcgQEAgc3RhdGljIHZvaWQgbHB0X2VuYWJsZV9iYWNrbGlnaHQoY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICAJCXBjaF9jdGwxIHw9IEJM
TV9QQ0hfUE9MQVJJVFk7Cj4gICAKPiAgIAkvKiBBZnRlciBMUFQsIG92ZXJyaWRlIGlzIHRoZSBk
ZWZhdWx0LiAqLwo+IC0JaWYgKEhBU19QQ0hfTFBUKGRldl9wcml2KSkKPiArCWlmIChIQVNfUENI
X0xQVChpOTE1KSkKPiAgIAkJcGNoX2N0bDEgfD0gQkxNX1BDSF9PVkVSUklERV9FTkFCTEU7Cj4g
ICAKPiAgIAlJOTE1X1dSSVRFKEJMQ19QV01fUENIX0NUTDEsIHBjaF9jdGwxKTsKPiBAQCAtOTI1
LDcgKzkyNSw3IEBAIHN0YXRpYyB2b2lkIHBjaF9lbmFibGVfYmFja2xpZ2h0KGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCQkJCSBjb25zdCBzdHJ1Y3QgZHJt
X2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY29u
bmVjdG9yICpjb25uZWN0b3IgPSB0b19pbnRlbF9jb25uZWN0b3IoY29ubl9zdGF0ZS0+Y29ubmVj
dG9yKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29u
bmVjdG9yLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX3BhbmVsICpwYW5l
bCA9ICZjb25uZWN0b3ItPnBhbmVsOwo+ICAgCWVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNjb2Rl
ciA9IGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyOwo+ICAgCXUzMiBjcHVfY3RsMiwgcGNoX2N0
bDEsIHBjaF9jdGwyOwo+IEBAIC05NzEsNyArOTcxLDcgQEAgc3RhdGljIHZvaWQgaTl4eF9lbmFi
bGVfYmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+
ICAgCQkJCSAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4g
ICB7Cj4gICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gdG9faW50ZWxfY29u
bmVjdG9yKGNvbm5fc3RhdGUtPmNvbm5lY3Rvcik7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICAg
CXN0cnVjdCBpbnRlbF9wYW5lbCAqcGFuZWwgPSAmY29ubmVjdG9yLT5wYW5lbDsKPiAgIAl1MzIg
Y3RsLCBmcmVxOwo+ICAgCj4gQEAgLTk4OCw3ICs5ODgsNyBAQCBzdGF0aWMgdm9pZCBpOXh4X2Vu
YWJsZV9iYWNrbGlnaHQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
Cj4gICAJY3RsID0gZnJlcSA8PCAxNzsKPiAgIAlpZiAocGFuZWwtPmJhY2tsaWdodC5jb21iaW5h
dGlvbl9tb2RlKQo+ICAgCQljdGwgfD0gQkxNX0xFR0FDWV9NT0RFOwo+IC0JaWYgKElTX1BJTkVW
SUVXKGRldl9wcml2KSAmJiBwYW5lbC0+YmFja2xpZ2h0LmFjdGl2ZV9sb3dfcHdtKQo+ICsJaWYg
KElTX1BJTkVWSUVXKGk5MTUpICYmIHBhbmVsLT5iYWNrbGlnaHQuYWN0aXZlX2xvd19wd20pCj4g
ICAJCWN0bCB8PSBCTE1fUE9MQVJJVFlfUE5WOwo+ICAgCj4gICAJSTkxNV9XUklURShCTENfUFdN
X0NUTCwgY3RsKTsKPiBAQCAtMTAwMiw3ICsxMDAyLDcgQEAgc3RhdGljIHZvaWQgaTl4eF9lbmFi
bGVfYmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+
ICAgCSAqIDg1NWdtIG9ubHksIGJ1dCBjaGVja2luZyBmb3IgZ2VuMiBpcyBzYWZlLCBhcyA4NTVn
bSBpcyB0aGUgb25seSBnZW4yCj4gICAJICogdGhhdCBoYXMgYmFja2xpZ2h0Lgo+ICAgCSAqLwo+
IC0JaWYgKElTX0dFTihkZXZfcHJpdiwgMikpCj4gKwlpZiAoSVNfR0VOKGk5MTUsIDIpKQo+ICAg
CQlJOTE1X1dSSVRFKEJMQ19ISVNUX0NUTCwgQkxNX0hJU1RPR1JBTV9FTkFCTEUpOwo+ICAgfQo+
ICAgCj4gQEAgLTEwMTAsNyArMTAxMCw3IEBAIHN0YXRpYyB2b2lkIGk5NjVfZW5hYmxlX2JhY2ts
aWdodChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJCQkg
IGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ICAgewo+ICAg
CXN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciA9IHRvX2ludGVsX2Nvbm5lY3Rvcihj
b25uX3N0YXRlLT5jb25uZWN0b3IpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3Qg
aW50ZWxfcGFuZWwgKnBhbmVsID0gJmNvbm5lY3Rvci0+cGFuZWw7Cj4gICAJZW51bSBwaXBlIHBp
cGUgPSB0b19pbnRlbF9jcnRjKGNvbm5fc3RhdGUtPmNydGMpLT5waXBlOwo+ICAgCXUzMiBjdGws
IGN0bDIsIGZyZXE7Cj4gQEAgLTEwNDUsNyArMTA0NSw3IEBAIHN0YXRpYyB2b2lkIHZsdl9lbmFi
bGVfYmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+
ICAgCQkJCSBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiAg
IHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IgPSB0b19pbnRlbF9jb25u
ZWN0b3IoY29ubl9zdGF0ZS0+Y29ubmVjdG9yKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gICAJ
c3RydWN0IGludGVsX3BhbmVsICpwYW5lbCA9ICZjb25uZWN0b3ItPnBhbmVsOwo+ICAgCWVudW0g
cGlwZSBwaXBlID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpLT5waXBlOwo+
ICAgCXUzMiBjdGwsIGN0bDI7Cj4gQEAgLTEwNzUsNyArMTA3NSw3IEBAIHN0YXRpYyB2b2lkIGJ4
dF9lbmFibGVfYmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlLAo+ICAgCQkJCSBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0
ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IgPSB0b19pbnRl
bF9jb25uZWN0b3IoY29ubl9zdGF0ZS0+Y29ubmVjdG9yKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7
Cj4gICAJc3RydWN0IGludGVsX3BhbmVsICpwYW5lbCA9ICZjb25uZWN0b3ItPnBhbmVsOwo+ICAg
CWVudW0gcGlwZSBwaXBlID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpLT5w
aXBlOwo+ICAgCXUzMiBwd21fY3RsLCB2YWw7Cj4gQEAgLTExMjMsNyArMTEyMyw3IEBAIHN0YXRp
YyB2b2lkIGNucF9lbmFibGVfYmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlLAo+ICAgCQkJCSBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAq
Y29ubl9zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3Ig
PSB0b19pbnRlbF9jb25uZWN0b3IoY29ubl9zdGF0ZS0+Y29ubmVjdG9yKTsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5i
YXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX3BhbmVsICpwYW5lbCA9ICZjb25uZWN0b3ItPnBh
bmVsOwo+ICAgCXUzMiBwd21fY3RsOwo+ICAgCj4gQEAgLTExODcsNyArMTE4Nyw3IEBAIHZvaWQg
aW50ZWxfcGFuZWxfZW5hYmxlX2JhY2tsaWdodChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJCQkgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRl
ICpjb25uX3N0YXRlKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3Rv
ciA9IHRvX2ludGVsX2Nvbm5lY3Rvcihjb25uX3N0YXRlLT5jb25uZWN0b3IpOwo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2
KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3It
PmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfcGFuZWwgKnBhbmVsID0gJmNvbm5lY3Rvci0+
cGFuZWw7Cj4gICAJZW51bSBwaXBlIHBpcGUgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJh
c2UuY3J0YyktPnBpcGU7Cj4gICAKPiBAQCAtMTE5NiwyOCArMTE5NiwyOCBAQCB2b2lkIGludGVs
X3BhbmVsX2VuYWJsZV9iYWNrbGlnaHQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUsCj4gICAKPiAgIAlEUk1fREVCVUdfS01TKCJwaXBlICVjXG4iLCBwaXBlX25hbWUo
cGlwZSkpOwo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+YmFja2xpZ2h0X2xvY2spOwo+
ICsJbXV0ZXhfbG9jaygmaTkxNS0+YmFja2xpZ2h0X2xvY2spOwo+ICAgCj4gICAJX19pbnRlbF9w
YW5lbF9lbmFibGVfYmFja2xpZ2h0KGNydGNfc3RhdGUsIGNvbm5fc3RhdGUpOwo+ICAgCj4gLQlt
dXRleF91bmxvY2soJmRldl9wcml2LT5iYWNrbGlnaHRfbG9jayk7Cj4gKwltdXRleF91bmxvY2so
Jmk5MTUtPmJhY2tsaWdodF9sb2NrKTsKPiAgIH0KPiAgIAo+ICAgI2lmIElTX0VOQUJMRUQoQ09O
RklHX0JBQ0tMSUdIVF9DTEFTU19ERVZJQ0UpCj4gICBzdGF0aWMgdTMyIGludGVsX3BhbmVsX2dl
dF9iYWNrbGlnaHQoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ICAgewo+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJh
c2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25u
ZWN0b3ItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfcGFuZWwgKnBhbmVsID0gJmNvbm5l
Y3Rvci0+cGFuZWw7Cj4gICAJdTMyIHZhbCA9IDA7Cj4gICAKPiAtCW11dGV4X2xvY2soJmRldl9w
cml2LT5iYWNrbGlnaHRfbG9jayk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT5iYWNrbGlnaHRfbG9j
ayk7Cj4gICAKPiAgIAlpZiAocGFuZWwtPmJhY2tsaWdodC5lbmFibGVkKSB7Cj4gICAJCXZhbCA9
IHBhbmVsLT5iYWNrbGlnaHQuZ2V0KGNvbm5lY3Rvcik7Cj4gICAJCXZhbCA9IGludGVsX3BhbmVs
X2NvbXB1dGVfYnJpZ2h0bmVzcyhjb25uZWN0b3IsIHZhbCk7Cj4gICAJfQo+ICAgCj4gLQltdXRl
eF91bmxvY2soJmRldl9wcml2LT5iYWNrbGlnaHRfbG9jayk7Cj4gKwltdXRleF91bmxvY2soJmk5
MTUtPmJhY2tsaWdodF9sb2NrKTsKPiAgIAo+ICAgCURSTV9ERUJVR19EUklWRVIoImdldCBiYWNr
bGlnaHQgUFdNID0gJWRcbiIsIHZhbCk7Cj4gICAJcmV0dXJuIHZhbDsKPiBAQCAtMTIyOCwxNCAr
MTIyOCwxNCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wYW5lbF9zZXRfYmFja2xpZ2h0KGNvbnN0IHN0
cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YQo+ICAgCQkJCSAgICAgIHUzMiB1c2Vy
X2xldmVsLCB1MzIgdXNlcl9tYXgpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAq
Y29ubmVjdG9yID0gdG9faW50ZWxfY29ubmVjdG9yKGNvbm5fc3RhdGUtPmNvbm5lY3Rvcik7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+
YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNv
bm5lY3Rvci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9wYW5lbCAqcGFuZWwgPSAmY29u
bmVjdG9yLT5wYW5lbDsKPiAgIAl1MzIgaHdfbGV2ZWw7Cj4gICAKPiAgIAlpZiAoIXBhbmVsLT5i
YWNrbGlnaHQucHJlc2VudCkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZf
cHJpdi0+YmFja2xpZ2h0X2xvY2spOwo+ICsJbXV0ZXhfbG9jaygmaTkxNS0+YmFja2xpZ2h0X2xv
Y2spOwo+ICAgCj4gICAJV0FSTl9PTihwYW5lbC0+YmFja2xpZ2h0Lm1heCA9PSAwKTsKPiAgIAo+
IEBAIC0xMjQ1LDcgKzEyNDUsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wYW5lbF9zZXRfYmFja2xp
Z2h0KGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YQo+ICAgCWlmIChw
YW5lbC0+YmFja2xpZ2h0LmVuYWJsZWQpCj4gICAJCWludGVsX3BhbmVsX2FjdHVhbGx5X3NldF9i
YWNrbGlnaHQoY29ubl9zdGF0ZSwgaHdfbGV2ZWwpOwo+ICAgCj4gLQltdXRleF91bmxvY2soJmRl
dl9wcml2LT5iYWNrbGlnaHRfbG9jayk7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPmJhY2tsaWdo
dF9sb2NrKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGludCBpbnRlbF9iYWNrbGlnaHRfZGV2aWNl
X3VwZGF0ZV9zdGF0dXMoc3RydWN0IGJhY2tsaWdodF9kZXZpY2UgKmJkKQo+IEBAIC0xMjg0LDEx
ICsxMjg0LDExIEBAIHN0YXRpYyBpbnQgaW50ZWxfYmFja2xpZ2h0X2RldmljZV9nZXRfYnJpZ2h0
bmVzcyhzdHJ1Y3QgYmFja2xpZ2h0X2RldmljZSAqYmQpCj4gICB7Cj4gICAJc3RydWN0IGludGVs
X2Nvbm5lY3RvciAqY29ubmVjdG9yID0gYmxfZ2V0X2RhdGEoYmQpOwo+ICAgCXN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYgPSBjb25uZWN0b3ItPmJhc2UuZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4g
ICAJaW50IHJldCA9IDA7Cj4gICAKPiAtCXdpdGhfaW50ZWxfcnVudGltZV9wbShkZXZfcHJpdiwg
d2FrZXJlZikgewo+ICsJd2l0aF9pbnRlbF9ydW50aW1lX3BtKGk5MTUsIHdha2VyZWYpIHsKPiAg
IAkJdTMyIGh3X2xldmVsOwo+ICAgCj4gICAJCWRybV9tb2Rlc2V0X2xvY2soJmRldi0+bW9kZV9j
b25maWcuY29ubmVjdGlvbl9tdXRleCwgTlVMTCk7Cj4gQEAgLTEzNzgsOSArMTM3OCw5IEBAIHZv
aWQgaW50ZWxfYmFja2xpZ2h0X2RldmljZV91bnJlZ2lzdGVyKHN0cnVjdCBpbnRlbF9jb25uZWN0
b3IgKmNvbm5lY3RvcikKPiAgICAqLwo+ICAgc3RhdGljIHUzMiBjbnBfaHpfdG9fcHdtKHN0cnVj
dCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwgdTMyIHB3bV9mcmVxX2h6KQo+ICAgewo+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJh
c2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25u
ZWN0b3ItPmJhc2UuZGV2KTsKPiAgIAo+IC0JcmV0dXJuIERJVl9ST1VORF9DTE9TRVNUKEtIeihk
ZXZfcHJpdi0+cmF3Y2xrX2ZyZXEpLCBwd21fZnJlcV9oeik7Cj4gKwlyZXR1cm4gRElWX1JPVU5E
X0NMT1NFU1QoS0h6KGk5MTUtPnJhd2Nsa19mcmVxKSwgcHdtX2ZyZXFfaHopOwo+ICAgfQo+ICAg
Cj4gICAvKgo+IEBAIC0xNDE2LDcgKzE0MTYsNyBAQCBzdGF0aWMgdTMyIHNwdF9oel90b19wd20o
c3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLCB1MzIgcHdtX2ZyZXFfaHopCj4gICAg
Ki8KPiAgIHN0YXRpYyB1MzIgbHB0X2h6X3RvX3B3bShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpj
b25uZWN0b3IsIHUzMiBwd21fZnJlcV9oeikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4g
ICAJc3RydWN0IGludGVsX3BhbmVsICpwYW5lbCA9ICZjb25uZWN0b3ItPnBhbmVsOwo+ICAgCXUz
MiBtdWwsIGNsb2NrOwo+ICAgCj4gQEAgLTE0MjUsNyArMTQyNSw3IEBAIHN0YXRpYyB1MzIgbHB0
X2h6X3RvX3B3bShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IsIHUzMiBwd21fZnJl
cV9oeikKPiAgIAllbHNlCj4gICAJCW11bCA9IDEyODsKPiAgIAo+IC0JaWYgKEhBU19QQ0hfTFBU
X0goZGV2X3ByaXYpKQo+ICsJaWYgKEhBU19QQ0hfTFBUX0goaTkxNSkpCj4gICAJCWNsb2NrID0g
TUh6KDEzNSk7IC8qIExQVDpIICovCj4gICAJZWxzZQo+ICAgCQljbG9jayA9IE1IeigyNCk7IC8q
IExQVDpMUCAqLwo+IEBAIC0xNDM5LDkgKzE0MzksOSBAQCBzdGF0aWMgdTMyIGxwdF9oel90b19w
d20oc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLCB1MzIgcHdtX2ZyZXFfaHopCj4g
ICAgKi8KPiAgIHN0YXRpYyB1MzIgcGNoX2h6X3RvX3B3bShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9y
ICpjb25uZWN0b3IsIHUzMiBwd21fZnJlcV9oeikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7
Cj4gICAKPiAtCXJldHVybiBESVZfUk9VTkRfQ0xPU0VTVChLSHooZGV2X3ByaXYtPnJhd2Nsa19m
cmVxKSwgcHdtX2ZyZXFfaHogKiAxMjgpOwo+ICsJcmV0dXJuIERJVl9ST1VORF9DTE9TRVNUKEtI
eihpOTE1LT5yYXdjbGtfZnJlcSksIHB3bV9mcmVxX2h6ICogMTI4KTsKPiAgIH0KPiAgIAo+ICAg
LyoKPiBAQCAtMTQ1NCwxMyArMTQ1NCwxMyBAQCBzdGF0aWMgdTMyIHBjaF9oel90b19wd20oc3Ry
dWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLCB1MzIgcHdtX2ZyZXFfaHopCj4gICAgKi8K
PiAgIHN0YXRpYyB1MzIgaTl4eF9oel90b19wd20oc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29u
bmVjdG9yLCB1MzIgcHdtX2ZyZXFfaHopCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICAg
CWludCBjbG9jazsKPiAgIAo+IC0JaWYgKElTX1BJTkVWSUVXKGRldl9wcml2KSkKPiAtCQljbG9j
ayA9IEtIeihkZXZfcHJpdi0+cmF3Y2xrX2ZyZXEpOwo+ICsJaWYgKElTX1BJTkVWSUVXKGk5MTUp
KQo+ICsJCWNsb2NrID0gS0h6KGk5MTUtPnJhd2Nsa19mcmVxKTsKPiAgIAllbHNlCj4gLQkJY2xv
Y2sgPSBLSHooZGV2X3ByaXYtPmNkY2xrLmh3LmNkY2xrKTsKPiArCQljbG9jayA9IEtIeihpOTE1
LT5jZGNsay5ody5jZGNsayk7Cj4gICAKPiAgIAlyZXR1cm4gRElWX1JPVU5EX0NMT1NFU1QoY2xv
Y2ssIHB3bV9mcmVxX2h6ICogMzIpOwo+ICAgfQo+IEBAIC0xNDcyLDEzICsxNDcyLDEzIEBAIHN0
YXRpYyB1MzIgaTl4eF9oel90b19wd20oc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9y
LCB1MzIgcHdtX2ZyZXFfaHopCj4gICAgKi8KPiAgIHN0YXRpYyB1MzIgaTk2NV9oel90b19wd20o
c3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLCB1MzIgcHdtX2ZyZXFfaHopCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rv
ci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICAgCWludCBjbG9jazsKPiAgIAo+IC0JaWYgKElTX0c0
WChkZXZfcHJpdikpCj4gLQkJY2xvY2sgPSBLSHooZGV2X3ByaXYtPnJhd2Nsa19mcmVxKTsKPiAr
CWlmIChJU19HNFgoaTkxNSkpCj4gKwkJY2xvY2sgPSBLSHooaTkxNS0+cmF3Y2xrX2ZyZXEpOwo+
ICAgCWVsc2UKPiAtCQljbG9jayA9IEtIeihkZXZfcHJpdi0+Y2RjbGsuaHcuY2RjbGspOwo+ICsJ
CWNsb2NrID0gS0h6KGk5MTUtPmNkY2xrLmh3LmNkY2xrKTsKPiAgIAo+ICAgCXJldHVybiBESVZf
Uk9VTkRfQ0xPU0VTVChjbG9jaywgcHdtX2ZyZXFfaHogKiAxMjgpOwo+ICAgfQo+IEBAIC0xNDkw
LDE3ICsxNDkwLDE3IEBAIHN0YXRpYyB1MzIgaTk2NV9oel90b19wd20oc3RydWN0IGludGVsX2Nv
bm5lY3RvciAqY29ubmVjdG9yLCB1MzIgcHdtX2ZyZXFfaHopCj4gICAgKi8KPiAgIHN0YXRpYyB1
MzIgdmx2X2h6X3RvX3B3bShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IsIHUzMiBw
d21fZnJlcV9oeikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gICAJaW50IG11bCwgY2xv
Y2s7Cj4gICAKPiAgIAlpZiAoKEk5MTVfUkVBRChDQlIxX1ZMVikgJiBDQlJfUFdNX0NMT0NLX01V
WF9TRUxFQ1QpID09IDApIHsKPiAtCQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gKwkJ
aWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gICAJCQljbG9jayA9IEtIeigxOTIwMCk7Cj4gICAJ
CWVsc2UKPiAgIAkJCWNsb2NrID0gTUh6KDI1KTsKPiAgIAkJbXVsID0gMTY7Cj4gICAJfSBlbHNl
IHsKPiAtCQljbG9jayA9IEtIeihkZXZfcHJpdi0+cmF3Y2xrX2ZyZXEpOwo+ICsJCWNsb2NrID0g
S0h6KGk5MTUtPnJhd2Nsa19mcmVxKTsKPiAgIAkJbXVsID0gMTI4Owo+ICAgCX0KPiAgIAo+IEBA
IC0xNTA5LDkgKzE1MDksOSBAQCBzdGF0aWMgdTMyIHZsdl9oel90b19wd20oc3RydWN0IGludGVs
X2Nvbm5lY3RvciAqY29ubmVjdG9yLCB1MzIgcHdtX2ZyZXFfaHopCj4gICAKPiAgIHN0YXRpYyB1
MzIgZ2V0X2JhY2tsaWdodF9tYXhfdmJ0KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3Rv
cikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
Y29ubmVjdG9yLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX3BhbmVsICpw
YW5lbCA9ICZjb25uZWN0b3ItPnBhbmVsOwo+IC0JdTE2IHB3bV9mcmVxX2h6ID0gZGV2X3ByaXYt
PnZidC5iYWNrbGlnaHQucHdtX2ZyZXFfaHo7Cj4gKwl1MTYgcHdtX2ZyZXFfaHogPSBpOTE1LT52
YnQuYmFja2xpZ2h0LnB3bV9mcmVxX2h6Owo+ICAgCXUzMiBwd207Cj4gICAKPiAgIAlpZiAoIXBh
bmVsLT5iYWNrbGlnaHQuaHpfdG9fcHdtKSB7Cj4gQEAgLTE1NDIsNyArMTU0Miw3IEBAIHN0YXRp
YyB1MzIgZ2V0X2JhY2tsaWdodF9tYXhfdmJ0KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5l
Y3RvcikKPiAgICAqLwo+ICAgc3RhdGljIHUzMiBnZXRfYmFja2xpZ2h0X21pbl92YnQoc3RydWN0
IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsK
PiAgIAlzdHJ1Y3QgaW50ZWxfcGFuZWwgKnBhbmVsID0gJmNvbm5lY3Rvci0+cGFuZWw7Cj4gICAJ
aW50IG1pbjsKPiAgIAo+IEBAIC0xNTU1LDEwICsxNTU1LDEwIEBAIHN0YXRpYyB1MzIgZ2V0X2Jh
Y2tsaWdodF9taW5fdmJ0KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIAkg
KiBhZ2FpbnN0IHRoaXMgYnkgbGV0dGluZyB0aGUgbWluaW11bSBiZSBhdCBtb3N0IChhcmJpdHJh
cmlseSBjaG9zZW4pCj4gICAJICogMjUlIG9mIHRoZSBtYXguCj4gICAJICovCj4gLQltaW4gPSBj
bGFtcF90KGludCwgZGV2X3ByaXYtPnZidC5iYWNrbGlnaHQubWluX2JyaWdodG5lc3MsIDAsIDY0
KTsKPiAtCWlmIChtaW4gIT0gZGV2X3ByaXYtPnZidC5iYWNrbGlnaHQubWluX2JyaWdodG5lc3Mp
IHsKPiArCW1pbiA9IGNsYW1wX3QoaW50LCBpOTE1LT52YnQuYmFja2xpZ2h0Lm1pbl9icmlnaHRu
ZXNzLCAwLCA2NCk7Cj4gKwlpZiAobWluICE9IGk5MTUtPnZidC5iYWNrbGlnaHQubWluX2JyaWdo
dG5lc3MpIHsKPiAgIAkJRFJNX0RFQlVHX0tNUygiY2xhbXBpbmcgVkJUIG1pbiBiYWNrbGlnaHQg
JWQvMjU1IHRvICVkLzI1NVxuIiwKPiAtCQkJICAgICAgZGV2X3ByaXYtPnZidC5iYWNrbGlnaHQu
bWluX2JyaWdodG5lc3MsIG1pbik7Cj4gKwkJCSAgICAgIGk5MTUtPnZidC5iYWNrbGlnaHQubWlu
X2JyaWdodG5lc3MsIG1pbik7Cj4gICAJfQo+ICAgCj4gICAJLyogdmJ0IHZhbHVlIGlzIGEgY29l
ZmZpY2llbnQgaW4gcmFuZ2UgWzAuLjI1NV0gKi8KPiBAQCAtMTU2NywxMiArMTU2NywxMiBAQCBz
dGF0aWMgdTMyIGdldF9iYWNrbGlnaHRfbWluX3ZidChzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpj
b25uZWN0b3IpCj4gICAKPiAgIHN0YXRpYyBpbnQgbHB0X3NldHVwX2JhY2tsaWdodChzdHJ1Y3Qg
aW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IsIGVudW0gcGlwZSB1bnVzZWQpCj4gICB7Cj4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFz
ZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5l
Y3Rvci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9wYW5lbCAqcGFuZWwgPSAmY29ubmVj
dG9yLT5wYW5lbDsKPiAgIAl1MzIgY3B1X2N0bDIsIHBjaF9jdGwxLCBwY2hfY3RsMiwgdmFsOwo+
ICAgCWJvb2wgYWx0LCBjcHVfbW9kZTsKPiAgIAo+IC0JaWYgKEhBU19QQ0hfTFBUKGRldl9wcml2
KSkKPiArCWlmIChIQVNfUENIX0xQVChpOTE1KSkKPiAgIAkJYWx0ID0gSTkxNV9SRUFEKFNPVVRI
X0NISUNLRU4yKSAmIExQVF9QV01fR1JBTlVMQVJJVFk7Cj4gICAJZWxzZQo+ICAgCQlhbHQgPSBJ
OTE1X1JFQUQoU09VVEhfQ0hJQ0tFTjEpICYgU1BUX1BXTV9HUkFOVUxBUklUWTsKPiBAQCAtMTU5
Niw3ICsxNTk2LDcgQEAgc3RhdGljIGludCBscHRfc2V0dXBfYmFja2xpZ2h0KHN0cnVjdCBpbnRl
bF9jb25uZWN0b3IgKmNvbm5lY3RvciwgZW51bSBwaXBlIHVudXMKPiAgIAo+ICAgCXBhbmVsLT5i
YWNrbGlnaHQuZW5hYmxlZCA9IHBjaF9jdGwxICYgQkxNX1BDSF9QV01fRU5BQkxFOwo+ICAgCj4g
LQljcHVfbW9kZSA9IHBhbmVsLT5iYWNrbGlnaHQuZW5hYmxlZCAmJiBIQVNfUENIX0xQVChkZXZf
cHJpdikgJiYKPiArCWNwdV9tb2RlID0gcGFuZWwtPmJhY2tsaWdodC5lbmFibGVkICYmIEhBU19Q
Q0hfTFBUKGk5MTUpICYmCj4gICAJCSAgICEocGNoX2N0bDEgJiBCTE1fUENIX09WRVJSSURFX0VO
QUJMRSkgJiYKPiAgIAkJICAgKGNwdV9jdGwyICYgQkxNX1BXTV9FTkFCTEUpOwo+ICAgCWlmIChj
cHVfbW9kZSkKPiBAQCAtMTYyMiw3ICsxNjIyLDcgQEAgc3RhdGljIGludCBscHRfc2V0dXBfYmFj
a2xpZ2h0KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwgZW51bSBwaXBlIHVudXMK
PiAgIAo+ICAgc3RhdGljIGludCBwY2hfc2V0dXBfYmFja2xpZ2h0KHN0cnVjdCBpbnRlbF9jb25u
ZWN0b3IgKmNvbm5lY3RvciwgZW51bSBwaXBlIHVudXNlZCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNl
LmRldik7Cj4gICAJc3RydWN0IGludGVsX3BhbmVsICpwYW5lbCA9ICZjb25uZWN0b3ItPnBhbmVs
Owo+ICAgCXUzMiBjcHVfY3RsMiwgcGNoX2N0bDEsIHBjaF9jdGwyLCB2YWw7Cj4gICAKPiBAQCAt
MTY1NCwxNiArMTY1NCwxNiBAQCBzdGF0aWMgaW50IHBjaF9zZXR1cF9iYWNrbGlnaHQoc3RydWN0
IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLCBlbnVtIHBpcGUgdW51cwo+ICAgCj4gICBzdGF0
aWMgaW50IGk5eHhfc2V0dXBfYmFja2xpZ2h0KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5l
Y3RvciwgZW51bSBwaXBlIHVudXNlZCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gICAJ
c3RydWN0IGludGVsX3BhbmVsICpwYW5lbCA9ICZjb25uZWN0b3ItPnBhbmVsOwo+ICAgCXUzMiBj
dGwsIHZhbDsKPiAgIAo+ICAgCWN0bCA9IEk5MTVfUkVBRChCTENfUFdNX0NUTCk7Cj4gICAKPiAt
CWlmIChJU19HRU4oZGV2X3ByaXYsIDIpIHx8IElTX0k5MTVHTShkZXZfcHJpdikgfHwgSVNfSTk0
NUdNKGRldl9wcml2KSkKPiArCWlmIChJU19HRU4oaTkxNSwgMikgfHwgSVNfSTkxNUdNKGk5MTUp
IHx8IElTX0k5NDVHTShpOTE1KSkKPiAgIAkJcGFuZWwtPmJhY2tsaWdodC5jb21iaW5hdGlvbl9t
b2RlID0gY3RsICYgQkxNX0xFR0FDWV9NT0RFOwo+ICAgCj4gLQlpZiAoSVNfUElORVZJRVcoZGV2
X3ByaXYpKQo+ICsJaWYgKElTX1BJTkVWSUVXKGk5MTUpKQo+ICAgCQlwYW5lbC0+YmFja2xpZ2h0
LmFjdGl2ZV9sb3dfcHdtID0gY3RsICYgQkxNX1BPTEFSSVRZX1BOVjsKPiAgIAo+ICAgCXBhbmVs
LT5iYWNrbGlnaHQubWF4ID0gY3RsID4+IDE3Owo+IEBAIC0xNjkzLDcgKzE2OTMsNyBAQCBzdGF0
aWMgaW50IGk5eHhfc2V0dXBfYmFja2xpZ2h0KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5l
Y3RvciwgZW51bSBwaXBlIHVudQo+ICAgCj4gICBzdGF0aWMgaW50IGk5NjVfc2V0dXBfYmFja2xp
Z2h0KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwgZW51bSBwaXBlIHVudXNlZCkK
PiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29u
bmVjdG9yLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX3BhbmVsICpwYW5l
bCA9ICZjb25uZWN0b3ItPnBhbmVsOwo+ICAgCXUzMiBjdGwsIGN0bDIsIHZhbDsKPiAgIAo+IEBA
IC0xNzI3LDcgKzE3MjcsNyBAQCBzdGF0aWMgaW50IGk5NjVfc2V0dXBfYmFja2xpZ2h0KHN0cnVj
dCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwgZW51bSBwaXBlIHVudQo+ICAgCj4gICBzdGF0
aWMgaW50IHZsdl9zZXR1cF9iYWNrbGlnaHQoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVj
dG9yLCBlbnVtIHBpcGUgcGlwZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gICAJc3Ry
dWN0IGludGVsX3BhbmVsICpwYW5lbCA9ICZjb25uZWN0b3ItPnBhbmVsOwo+ICAgCXUzMiBjdGws
IGN0bDIsIHZhbDsKPiAgIAo+IEBAIC0xNzQ4LDcgKzE3NDgsNyBAQCBzdGF0aWMgaW50IHZsdl9z
ZXR1cF9iYWNrbGlnaHQoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLCBlbnVtIHBp
cGUgcGlwZQo+ICAgCj4gICAJcGFuZWwtPmJhY2tsaWdodC5taW4gPSBnZXRfYmFja2xpZ2h0X21p
bl92YnQoY29ubmVjdG9yKTsKPiAgIAo+IC0JdmFsID0gX3Zsdl9nZXRfYmFja2xpZ2h0KGRldl9w
cml2LCBwaXBlKTsKPiArCXZhbCA9IF92bHZfZ2V0X2JhY2tsaWdodChpOTE1LCBwaXBlKTsKPiAg
IAl2YWwgPSBpbnRlbF9wYW5lbF9jb21wdXRlX2JyaWdodG5lc3MoY29ubmVjdG9yLCB2YWwpOwo+
ICAgCXBhbmVsLT5iYWNrbGlnaHQubGV2ZWwgPSBjbGFtcCh2YWwsIHBhbmVsLT5iYWNrbGlnaHQu
bWluLAo+ICAgCQkJCSAgICAgICBwYW5lbC0+YmFja2xpZ2h0Lm1heCk7Cj4gQEAgLTE3NjEsMTEg
KzE3NjEsMTEgQEAgc3RhdGljIGludCB2bHZfc2V0dXBfYmFja2xpZ2h0KHN0cnVjdCBpbnRlbF9j
b25uZWN0b3IgKmNvbm5lY3RvciwgZW51bSBwaXBlIHBpcGUKPiAgIHN0YXRpYyBpbnQKPiAgIGJ4
dF9zZXR1cF9iYWNrbGlnaHQoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLCBlbnVt
IHBpcGUgdW51c2VkKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50
ZWxfcGFuZWwgKnBhbmVsID0gJmNvbm5lY3Rvci0+cGFuZWw7Cj4gICAJdTMyIHB3bV9jdGwsIHZh
bDsKPiAgIAo+IC0JcGFuZWwtPmJhY2tsaWdodC5jb250cm9sbGVyID0gZGV2X3ByaXYtPnZidC5i
YWNrbGlnaHQuY29udHJvbGxlcjsKPiArCXBhbmVsLT5iYWNrbGlnaHQuY29udHJvbGxlciA9IGk5
MTUtPnZidC5iYWNrbGlnaHQuY29udHJvbGxlcjsKPiAgIAo+ICAgCXB3bV9jdGwgPSBJOTE1X1JF
QUQoQlhUX0JMQ19QV01fQ1RMKHBhbmVsLT5iYWNrbGlnaHQuY29udHJvbGxlcikpOwo+ICAgCj4g
QEAgLTE4MDEsNyArMTgwMSw3IEBAIGJ4dF9zZXR1cF9iYWNrbGlnaHQoc3RydWN0IGludGVsX2Nv
bm5lY3RvciAqY29ubmVjdG9yLCBlbnVtIHBpcGUgdW51c2VkKQo+ICAgc3RhdGljIGludAo+ICAg
Y25wX3NldHVwX2JhY2tsaWdodChzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IsIGVu
dW0gcGlwZSB1bnVzZWQpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBp
bnRlbF9wYW5lbCAqcGFuZWwgPSAmY29ubmVjdG9yLT5wYW5lbDsKPiAgIAl1MzIgcHdtX2N0bCwg
dmFsOwo+ICAgCj4gQEAgLTE4ODEsMjggKzE4ODEsMjggQEAgdm9pZCBpbnRlbF9wYW5lbF91cGRh
dGVfYmFja2xpZ2h0KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCSAgY29u
c3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4gICB7Cj4gICAJc3Ry
dWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gdG9faW50ZWxfY29ubmVjdG9yKGNvbm5f
c3RhdGUtPmNvbm5lY3Rvcik7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRl
bF9wYW5lbCAqcGFuZWwgPSAmY29ubmVjdG9yLT5wYW5lbDsKPiAgIAo+ICAgCWlmICghcGFuZWwt
PmJhY2tsaWdodC5wcmVzZW50KQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCW11dGV4X2xvY2soJmRl
dl9wcml2LT5iYWNrbGlnaHRfbG9jayk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT5iYWNrbGlnaHRf
bG9jayk7Cj4gICAJaWYgKCFwYW5lbC0+YmFja2xpZ2h0LmVuYWJsZWQpCj4gICAJCV9faW50ZWxf
cGFuZWxfZW5hYmxlX2JhY2tsaWdodChjcnRjX3N0YXRlLCBjb25uX3N0YXRlKTsKPiAgIAo+IC0J
bXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+YmFja2xpZ2h0X2xvY2spOwo+ICsJbXV0ZXhfdW5sb2Nr
KCZpOTE1LT5iYWNrbGlnaHRfbG9jayk7Cj4gICB9Cj4gICAKPiAgIGludCBpbnRlbF9wYW5lbF9z
ZXR1cF9iYWNrbGlnaHQoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwgZW51bSBwaXBl
IHBpcGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGNvbm5lY3Rvci0+ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShjb25uZWN0b3ItPmRldik7Cj4gICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqaW50
ZWxfY29ubmVjdG9yID0gdG9faW50ZWxfY29ubmVjdG9yKGNvbm5lY3Rvcik7Cj4gICAJc3RydWN0
IGludGVsX3BhbmVsICpwYW5lbCA9ICZpbnRlbF9jb25uZWN0b3ItPnBhbmVsOwo+ICAgCWludCBy
ZXQ7Cj4gICAKPiAtCWlmICghZGV2X3ByaXYtPnZidC5iYWNrbGlnaHQucHJlc2VudCkgewo+IC0J
CWlmIChkZXZfcHJpdi0+cXVpcmtzICYgUVVJUktfQkFDS0xJR0hUX1BSRVNFTlQpIHsKPiArCWlm
ICghaTkxNS0+dmJ0LmJhY2tsaWdodC5wcmVzZW50KSB7Cj4gKwkJaWYgKGk5MTUtPnF1aXJrcyAm
IFFVSVJLX0JBQ0tMSUdIVF9QUkVTRU5UKSB7Cj4gICAJCQlEUk1fREVCVUdfS01TKCJubyBiYWNr
bGlnaHQgcHJlc2VudCBwZXIgVkJULCBidXQgcHJlc2VudCBwZXIgcXVpcmtcbiIpOwo+ICAgCQl9
IGVsc2Ugewo+ICAgCQkJRFJNX0RFQlVHX0tNUygibm8gYmFja2xpZ2h0IHByZXNlbnQgcGVyIFZC
VFxuIik7Cj4gQEAgLTE5MTUsOSArMTkxNSw5IEBAIGludCBpbnRlbF9wYW5lbF9zZXR1cF9iYWNr
bGlnaHQoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwgZW51bSBwaXBlIHBpcGUpCj4g
ICAJCXJldHVybiAtRU5PREVWOwo+ICAgCj4gICAJLyogc2V0IGxldmVsIGFuZCBtYXggaW4gcGFu
ZWwgc3RydWN0ICovCj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+YmFja2xpZ2h0X2xvY2spOwo+
ICsJbXV0ZXhfbG9jaygmaTkxNS0+YmFja2xpZ2h0X2xvY2spOwo+ICAgCXJldCA9IHBhbmVsLT5i
YWNrbGlnaHQuc2V0dXAoaW50ZWxfY29ubmVjdG9yLCBwaXBlKTsKPiAtCW11dGV4X3VubG9jaygm
ZGV2X3ByaXYtPmJhY2tsaWdodF9sb2NrKTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+YmFja2xp
Z2h0X2xvY2spOwo+ICAgCj4gICAJaWYgKHJldCkgewo+ICAgCQlEUk1fREVCVUdfS01TKCJmYWls
ZWQgdG8gc2V0dXAgYmFja2xpZ2h0IGZvciBjb25uZWN0b3IgJXNcbiIsCj4gQEAgLTE5NTAsNyAr
MTk1MCw3IEBAIGludGVsX3BhbmVsX2luaXRfYmFja2xpZ2h0X2Z1bmNzKHN0cnVjdCBpbnRlbF9w
YW5lbCAqcGFuZWwpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9y
ID0KPiAgIAkJY29udGFpbmVyX29mKHBhbmVsLCBzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yLCBwYW5l
bCk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5l
Y3Rvci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICAgCj4gICAJaWYgKGNvbm5lY3Rvci0+YmFzZS5j
b25uZWN0b3JfdHlwZSA9PSBEUk1fTU9ERV9DT05ORUNUT1JfZURQICYmCj4gICAJICAgIGludGVs
X2RwX2F1eF9pbml0X2JhY2tsaWdodF9mdW5jcyhjb25uZWN0b3IpID09IDApCj4gQEAgLTE5NjAs
MzggKzE5NjAsMzggQEAgaW50ZWxfcGFuZWxfaW5pdF9iYWNrbGlnaHRfZnVuY3Moc3RydWN0IGlu
dGVsX3BhbmVsICpwYW5lbCkKPiAgIAkgICAgaW50ZWxfZHNpX2Rjc19pbml0X2JhY2tsaWdodF9m
dW5jcyhjb25uZWN0b3IpID09IDApCj4gICAJCXJldHVybjsKPiAgIAo+IC0JaWYgKElTX0dFTjlf
TFAoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfR0VOOV9MUChpOTE1KSkgewo+ICAgCQlwYW5lbC0+
YmFja2xpZ2h0LnNldHVwID0gYnh0X3NldHVwX2JhY2tsaWdodDsKPiAgIAkJcGFuZWwtPmJhY2ts
aWdodC5lbmFibGUgPSBieHRfZW5hYmxlX2JhY2tsaWdodDsKPiAgIAkJcGFuZWwtPmJhY2tsaWdo
dC5kaXNhYmxlID0gYnh0X2Rpc2FibGVfYmFja2xpZ2h0Owo+ICAgCQlwYW5lbC0+YmFja2xpZ2h0
LnNldCA9IGJ4dF9zZXRfYmFja2xpZ2h0Owo+ICAgCQlwYW5lbC0+YmFja2xpZ2h0LmdldCA9IGJ4
dF9nZXRfYmFja2xpZ2h0Owo+ICAgCQlwYW5lbC0+YmFja2xpZ2h0Lmh6X3RvX3B3bSA9IGJ4dF9o
el90b19wd207Cj4gLQl9IGVsc2UgaWYgKElOVEVMX1BDSF9UWVBFKGRldl9wcml2KSA+PSBQQ0hf
Q05QKSB7Cj4gKwl9IGVsc2UgaWYgKElOVEVMX1BDSF9UWVBFKGk5MTUpID49IFBDSF9DTlApIHsK
PiAgIAkJcGFuZWwtPmJhY2tsaWdodC5zZXR1cCA9IGNucF9zZXR1cF9iYWNrbGlnaHQ7Cj4gICAJ
CXBhbmVsLT5iYWNrbGlnaHQuZW5hYmxlID0gY25wX2VuYWJsZV9iYWNrbGlnaHQ7Cj4gICAJCXBh
bmVsLT5iYWNrbGlnaHQuZGlzYWJsZSA9IGNucF9kaXNhYmxlX2JhY2tsaWdodDsKPiAgIAkJcGFu
ZWwtPmJhY2tsaWdodC5zZXQgPSBieHRfc2V0X2JhY2tsaWdodDsKPiAgIAkJcGFuZWwtPmJhY2ts
aWdodC5nZXQgPSBieHRfZ2V0X2JhY2tsaWdodDsKPiAgIAkJcGFuZWwtPmJhY2tsaWdodC5oel90
b19wd20gPSBjbnBfaHpfdG9fcHdtOwo+IC0JfSBlbHNlIGlmIChJTlRFTF9QQ0hfVFlQRShkZXZf
cHJpdikgPj0gUENIX0xQVCkgewo+ICsJfSBlbHNlIGlmIChJTlRFTF9QQ0hfVFlQRShpOTE1KSA+
PSBQQ0hfTFBUKSB7Cj4gICAJCXBhbmVsLT5iYWNrbGlnaHQuc2V0dXAgPSBscHRfc2V0dXBfYmFj
a2xpZ2h0Owo+ICAgCQlwYW5lbC0+YmFja2xpZ2h0LmVuYWJsZSA9IGxwdF9lbmFibGVfYmFja2xp
Z2h0Owo+ICAgCQlwYW5lbC0+YmFja2xpZ2h0LmRpc2FibGUgPSBscHRfZGlzYWJsZV9iYWNrbGln
aHQ7Cj4gICAJCXBhbmVsLT5iYWNrbGlnaHQuc2V0ID0gbHB0X3NldF9iYWNrbGlnaHQ7Cj4gICAJ
CXBhbmVsLT5iYWNrbGlnaHQuZ2V0ID0gbHB0X2dldF9iYWNrbGlnaHQ7Cj4gLQkJaWYgKEhBU19Q
Q0hfTFBUKGRldl9wcml2KSkKPiArCQlpZiAoSEFTX1BDSF9MUFQoaTkxNSkpCj4gICAJCQlwYW5l
bC0+YmFja2xpZ2h0Lmh6X3RvX3B3bSA9IGxwdF9oel90b19wd207Cj4gICAJCWVsc2UKPiAgIAkJ
CXBhbmVsLT5iYWNrbGlnaHQuaHpfdG9fcHdtID0gc3B0X2h6X3RvX3B3bTsKPiAtCX0gZWxzZSBp
ZiAoSEFTX1BDSF9TUExJVChkZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAoSEFTX1BDSF9TUExJ
VChpOTE1KSkgewo+ICAgCQlwYW5lbC0+YmFja2xpZ2h0LnNldHVwID0gcGNoX3NldHVwX2JhY2ts
aWdodDsKPiAgIAkJcGFuZWwtPmJhY2tsaWdodC5lbmFibGUgPSBwY2hfZW5hYmxlX2JhY2tsaWdo
dDsKPiAgIAkJcGFuZWwtPmJhY2tsaWdodC5kaXNhYmxlID0gcGNoX2Rpc2FibGVfYmFja2xpZ2h0
Owo+ICAgCQlwYW5lbC0+YmFja2xpZ2h0LnNldCA9IHBjaF9zZXRfYmFja2xpZ2h0Owo+ICAgCQlw
YW5lbC0+YmFja2xpZ2h0LmdldCA9IHBjaF9nZXRfYmFja2xpZ2h0Owo+ICAgCQlwYW5lbC0+YmFj
a2xpZ2h0Lmh6X3RvX3B3bSA9IHBjaF9oel90b19wd207Cj4gLQl9IGVsc2UgaWYgKElTX1ZBTExF
WVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gKwl9IGVsc2Ug
aWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkgewo+ICAgCQlp
ZiAoY29ubmVjdG9yLT5iYXNlLmNvbm5lY3Rvcl90eXBlID09IERSTV9NT0RFX0NPTk5FQ1RPUl9E
U0kpIHsKPiAgIAkJCXBhbmVsLT5iYWNrbGlnaHQuc2V0dXAgPSBwd21fc2V0dXBfYmFja2xpZ2h0
Owo+ICAgCQkJcGFuZWwtPmJhY2tsaWdodC5lbmFibGUgPSBwd21fZW5hYmxlX2JhY2tsaWdodDsK
PiBAQCAtMjAwNiw3ICsyMDA2LDcgQEAgaW50ZWxfcGFuZWxfaW5pdF9iYWNrbGlnaHRfZnVuY3Mo
c3RydWN0IGludGVsX3BhbmVsICpwYW5lbCkKPiAgIAkJCXBhbmVsLT5iYWNrbGlnaHQuZ2V0ID0g
dmx2X2dldF9iYWNrbGlnaHQ7Cj4gICAJCQlwYW5lbC0+YmFja2xpZ2h0Lmh6X3RvX3B3bSA9IHZs
dl9oel90b19wd207Cj4gICAJCX0KPiAtCX0gZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCA0KSkg
ewo+ICsJfSBlbHNlIGlmIChJU19HRU4oaTkxNSwgNCkpIHsKPiAgIAkJcGFuZWwtPmJhY2tsaWdo
dC5zZXR1cCA9IGk5NjVfc2V0dXBfYmFja2xpZ2h0Owo+ICAgCQlwYW5lbC0+YmFja2xpZ2h0LmVu
YWJsZSA9IGk5NjVfZW5hYmxlX2JhY2tsaWdodDsKPiAgIAkJcGFuZWwtPmJhY2tsaWdodC5kaXNh
YmxlID0gaTk2NV9kaXNhYmxlX2JhY2tsaWdodDsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfcGlwZV9jcmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3Bp
cGVfY3JjLmMKPiBpbmRleCAxZTJjNDMwN2QwNWEuLjRhNDQwOWY0MDc2ZiAxMDA2NDQKPiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9waXBlX2NyYy5jCj4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfcGlwZV9jcmMuYwo+IEBAIC03MCwxMSArNzAsMTEgQEAgc3RhdGlj
IGludCBpOHh4X3BpcGVfY3JjX2N0bF9yZWcoZW51bSBpbnRlbF9waXBlX2NyY19zb3VyY2UgKnNv
dXJjZSwKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgaW50IGk5eHhfcGlwZV9j
cmNfYXV0b19zb3VyY2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0
aWMgaW50IGk5eHhfcGlwZV9jcmNfYXV0b19zb3VyY2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCj4gICAJCQkJICAgICBlbnVtIHBpcGUgcGlwZSwKPiAgIAkJCQkgICAgIGVudW0gaW50
ZWxfcGlwZV9jcmNfc291cmNlICpzb3VyY2UpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2ID0gJmRldl9wcml2LT5kcm07Cj4gKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmk5MTUt
PmRybTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcjsKPiAgIAlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YzsKPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydDsK
PiBAQCAtMTI0LDcgKzEyNCw3IEBAIHN0YXRpYyBpbnQgaTl4eF9waXBlX2NyY19hdXRvX3NvdXJj
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJcmV0dXJuIHJldDsKPiAg
IH0KPiAgIAo+IC1zdGF0aWMgaW50IHZsdl9waXBlX2NyY19jdGxfcmVnKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIGludCB2bHZfcGlwZV9jcmNfY3RsX3JlZyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQllbnVtIHBpcGUgcGlwZSwKPiAg
IAkJCQllbnVtIGludGVsX3BpcGVfY3JjX3NvdXJjZSAqc291cmNlLAo+ICAgCQkJCXUzMiAqdmFs
KQo+IEBAIC0xMzIsNyArMTMyLDcgQEAgc3RhdGljIGludCB2bHZfcGlwZV9jcmNfY3RsX3JlZyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJYm9vbCBuZWVkX3N0YWJsZV9z
eW1ib2xzID0gZmFsc2U7Cj4gICAKPiAgIAlpZiAoKnNvdXJjZSA9PSBJTlRFTF9QSVBFX0NSQ19T
T1VSQ0VfQVVUTykgewo+IC0JCWludCByZXQgPSBpOXh4X3BpcGVfY3JjX2F1dG9fc291cmNlKGRl
dl9wcml2LCBwaXBlLCBzb3VyY2UpOwo+ICsJCWludCByZXQgPSBpOXh4X3BpcGVfY3JjX2F1dG9f
c291cmNlKGk5MTUsIHBpcGUsIHNvdXJjZSk7Cj4gICAJCWlmIChyZXQpCj4gICAJCQlyZXR1cm4g
cmV0Owo+ICAgCX0KPiBAQCAtMTUwLDcgKzE1MCw3IEBAIHN0YXRpYyBpbnQgdmx2X3BpcGVfY3Jj
X2N0bF9yZWcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCQluZWVkX3N0
YWJsZV9zeW1ib2xzID0gdHJ1ZTsKPiAgIAkJYnJlYWs7Cj4gICAJY2FzZSBJTlRFTF9QSVBFX0NS
Q19TT1VSQ0VfRFBfRDoKPiAtCQlpZiAoIUlTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ICsJCWlm
ICghSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiAgIAkJCXJldHVybiAtRUlOVkFMOwo+ICAgCQkqdmFs
ID0gUElQRV9DUkNfRU5BQkxFIHwgUElQRV9DUkNfU09VUkNFX0RQX0RfVkxWOwo+ICAgCQluZWVk
X3N0YWJsZV9zeW1ib2xzID0gdHJ1ZTsKPiBAQCAtMTk0LDEzICsxOTQsMTMgQEAgc3RhdGljIGlu
dCB2bHZfcGlwZV9jcmNfY3RsX3JlZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gICAJcmV0dXJuIDA7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGludCBpOXh4X3BpcGVfY3JjX2N0
bF9yZWcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgaW50IGk5
eHhfcGlwZV9jcmNfY3RsX3JlZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJ
CQkgZW51bSBwaXBlIHBpcGUsCj4gICAJCQkJIGVudW0gaW50ZWxfcGlwZV9jcmNfc291cmNlICpz
b3VyY2UsCj4gICAJCQkJIHUzMiAqdmFsKQo+ICAgewo+ICAgCWlmICgqc291cmNlID09IElOVEVM
X1BJUEVfQ1JDX1NPVVJDRV9BVVRPKSB7Cj4gLQkJaW50IHJldCA9IGk5eHhfcGlwZV9jcmNfYXV0
b19zb3VyY2UoZGV2X3ByaXYsIHBpcGUsIHNvdXJjZSk7Cj4gKwkJaW50IHJldCA9IGk5eHhfcGlw
ZV9jcmNfYXV0b19zb3VyY2UoaTkxNSwgcGlwZSwgc291cmNlKTsKPiAgIAkJaWYgKHJldCkKPiAg
IAkJCXJldHVybiByZXQ7Cj4gICAJfQo+IEBAIC0yMTAsNyArMjEwLDcgQEAgc3RhdGljIGludCBp
OXh4X3BpcGVfY3JjX2N0bF9yZWcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICAgCQkqdmFsID0gUElQRV9DUkNfRU5BQkxFIHwgUElQRV9DUkNfU09VUkNFX1BJUEVfSTlYWDsK
PiAgIAkJYnJlYWs7Cj4gICAJY2FzZSBJTlRFTF9QSVBFX0NSQ19TT1VSQ0VfVFY6Cj4gLQkJaWYg
KCFTVVBQT1JUU19UVihkZXZfcHJpdikpCj4gKwkJaWYgKCFTVVBQT1JUU19UVihpOTE1KSkKPiAg
IAkJCXJldHVybiAtRUlOVkFMOwo+ICAgCQkqdmFsID0gUElQRV9DUkNfRU5BQkxFIHwgUElQRV9D
UkNfU09VUkNFX1RWX1BSRTsKPiAgIAkJYnJlYWs7Cj4gQEAgLTIzNCw3ICsyMzQsNyBAQCBzdGF0
aWMgaW50IGk5eHhfcGlwZV9jcmNfY3RsX3JlZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gICAJcmV0dXJuIDA7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgdmx2X3VuZG9f
cGlwZV9zY3JhbWJsZV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
K3N0YXRpYyB2b2lkIHZsdl91bmRvX3BpcGVfc2NyYW1ibGVfcmVzZXQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJCSBlbnVtIHBpcGUgcGlwZSkKPiAgIHsKPiAgIAl1MzIg
dG1wID0gSTkxNV9SRUFEKFBPUlRfREZUMl9HNFgpOwo+IEBAIC0yODYsNyArMjg2LDcgQEAgc3Rh
dGljIGludCBpbGtfcGlwZV9jcmNfY3RsX3JlZyhlbnVtIGludGVsX3BpcGVfY3JjX3NvdXJjZSAq
c291cmNlLAo+ICAgc3RhdGljIHZvaWQKPiAgIGludGVsX2NydGNfY3JjX3NldHVwX3dvcmthcm91
bmRzKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLCBib29sIGVuYWJsZSkKPiAgIHsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2
KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWc7Cj4gICAJc3RydWN0
IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlOwo+ICAgCXN0cnVjdCBkcm1fbW9kZXNldF9hY3F1aXJl
X2N0eCBjdHg7Cj4gQEAgLTI5NCw3ICsyOTQsNyBAQCBpbnRlbF9jcnRjX2NyY19zZXR1cF93b3Jr
YXJvdW5kcyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywgYm9vbCBlbmFibGUpCj4gICAKPiAgIAlk
cm1fbW9kZXNldF9hY3F1aXJlX2luaXQoJmN0eCwgMCk7Cj4gICAKPiAtCXN0YXRlID0gZHJtX2F0
b21pY19zdGF0ZV9hbGxvYygmZGV2X3ByaXYtPmRybSk7Cj4gKwlzdGF0ZSA9IGRybV9hdG9taWNf
c3RhdGVfYWxsb2MoJmk5MTUtPmRybSk7Cj4gICAJaWYgKCFzdGF0ZSkgewo+ICAgCQlyZXQgPSAt
RU5PTUVNOwo+ICAgCQlnb3RvIHVubG9jazsKPiBAQCAtMzEyLDcgKzMxMiw3IEBAIGludGVsX2Ny
dGNfY3JjX3NldHVwX3dvcmthcm91bmRzKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLCBib29sIGVu
YWJsZSkKPiAgIAlwaXBlX2NvbmZpZy0+YmFzZS5tb2RlX2NoYW5nZWQgPSBwaXBlX2NvbmZpZy0+
aGFzX3BzcjsKPiAgIAlwaXBlX2NvbmZpZy0+Y3JjX2VuYWJsZWQgPSBlbmFibGU7Cj4gICAKPiAt
CWlmIChJU19IQVNXRUxMKGRldl9wcml2KSAmJgo+ICsJaWYgKElTX0hBU1dFTEwoaTkxNSkgJiYK
PiAgIAkgICAgcGlwZV9jb25maWctPmJhc2UuYWN0aXZlICYmIGNydGMtPnBpcGUgPT0gUElQRV9B
ICYmCj4gICAJICAgIHBpcGVfY29uZmlnLT5jcHVfdHJhbnNjb2RlciA9PSBUUkFOU0NPREVSX0VE
UCkKPiAgIAkJcGlwZV9jb25maWctPmJhc2UubW9kZV9jaGFuZ2VkID0gdHJ1ZTsKPiBAQCAtMzMz
LDcgKzMzMyw3IEBAIGludGVsX2NydGNfY3JjX3NldHVwX3dvcmthcm91bmRzKHN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjLCBib29sIGVuYWJsZSkKPiAgIAlkcm1fbW9kZXNldF9hY3F1aXJlX2Zpbmko
JmN0eCk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGludCBpdmJfcGlwZV9jcmNfY3RsX3JlZyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBpbnQgaXZiX3BpcGVfY3Jj
X2N0bF9yZWcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJZW51bSBwaXBl
IHBpcGUsCj4gICAJCQkJZW51bSBpbnRlbF9waXBlX2NyY19zb3VyY2UgKnNvdXJjZSwKPiAgIAkJ
CQl1MzIgKnZhbCkKPiBAQCAtMzYxLDcgKzM2MSw3IEBAIHN0YXRpYyBpbnQgaXZiX3BpcGVfY3Jj
X2N0bF9yZWcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCXJldHVybiAw
Owo+ICAgfQo+ICAgCj4gLXN0YXRpYyBpbnQgc2tsX3BpcGVfY3JjX2N0bF9yZWcoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgaW50IHNrbF9waXBlX2NyY19jdGxf
cmVnKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCWVudW0gcGlwZSBwaXBl
LAo+ICAgCQkJCWVudW0gaW50ZWxfcGlwZV9jcmNfc291cmNlICpzb3VyY2UsCj4gICAJCQkJdTMy
ICp2YWwpCj4gQEAgLTQwNCwyMiArNDA0LDIyIEBAIHN0YXRpYyBpbnQgc2tsX3BpcGVfY3JjX2N0
bF9yZWcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCXJldHVybiAwOwo+
ICAgfQo+ICAgCj4gLXN0YXRpYyBpbnQgZ2V0X25ld19jcmNfY3RsX3JlZyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBpbnQgZ2V0X25ld19jcmNfY3RsX3JlZyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgICBlbnVtIHBpcGUgcGlw
ZSwKPiAgIAkJCSAgICAgICBlbnVtIGludGVsX3BpcGVfY3JjX3NvdXJjZSAqc291cmNlLCB1MzIg
KnZhbCkKPiAgIHsKPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDIpKQo+ICsJaWYgKElTX0dFTihp
OTE1LCAyKSkKPiAgIAkJcmV0dXJuIGk4eHhfcGlwZV9jcmNfY3RsX3JlZyhzb3VyY2UsIHZhbCk7
Cj4gLQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNSkKPiAtCQlyZXR1cm4gaTl4eF9w
aXBlX2NyY19jdGxfcmVnKGRldl9wcml2LCBwaXBlLCBzb3VyY2UsIHZhbCk7Cj4gLQllbHNlIGlm
IChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiAt
CQlyZXR1cm4gdmx2X3BpcGVfY3JjX2N0bF9yZWcoZGV2X3ByaXYsIHBpcGUsIHNvdXJjZSwgdmFs
KTsKPiAtCWVsc2UgaWYgKElTX0dFTl9SQU5HRShkZXZfcHJpdiwgNSwgNikpCj4gKwllbHNlIGlm
IChJTlRFTF9HRU4oaTkxNSkgPCA1KQo+ICsJCXJldHVybiBpOXh4X3BpcGVfY3JjX2N0bF9yZWco
aTkxNSwgcGlwZSwgc291cmNlLCB2YWwpOwo+ICsJZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1
KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKQo+ICsJCXJldHVybiB2bHZfcGlwZV9jcmNfY3RsX3Jl
ZyhpOTE1LCBwaXBlLCBzb3VyY2UsIHZhbCk7Cj4gKwllbHNlIGlmIChJU19HRU5fUkFOR0UoaTkx
NSwgNSwgNikpCj4gICAJCXJldHVybiBpbGtfcGlwZV9jcmNfY3RsX3JlZyhzb3VyY2UsIHZhbCk7
Cj4gLQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgOSkKPiAtCQlyZXR1cm4gaXZiX3Bp
cGVfY3JjX2N0bF9yZWcoZGV2X3ByaXYsIHBpcGUsIHNvdXJjZSwgdmFsKTsKPiArCWVsc2UgaWYg
KElOVEVMX0dFTihpOTE1KSA8IDkpCj4gKwkJcmV0dXJuIGl2Yl9waXBlX2NyY19jdGxfcmVnKGk5
MTUsIHBpcGUsIHNvdXJjZSwgdmFsKTsKPiAgIAllbHNlCj4gLQkJcmV0dXJuIHNrbF9waXBlX2Ny
Y19jdGxfcmVnKGRldl9wcml2LCBwaXBlLCBzb3VyY2UsIHZhbCk7Cj4gKwkJcmV0dXJuIHNrbF9w
aXBlX2NyY19jdGxfcmVnKGk5MTUsIHBpcGUsIHNvdXJjZSwgdmFsKTsKPiAgIH0KPiAgIAo+ICAg
c3RhdGljIGludAo+IEBAIC00NDAsMTggKzQ0MCwxOCBAQCBkaXNwbGF5X2NyY19jdGxfcGFyc2Vf
c291cmNlKGNvbnN0IGNoYXIgKmJ1ZiwgZW51bSBpbnRlbF9waXBlX2NyY19zb3VyY2UgKnMpCj4g
ICAJcmV0dXJuIDA7Cj4gICB9Cj4gICAKPiAtdm9pZCBpbnRlbF9kaXNwbGF5X2NyY19pbml0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBpbnRlbF9kaXNwbGF5X2Ny
Y19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCWVudW0gcGlw
ZSBwaXBlOwo+ICAgCj4gLQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKSB7Cj4gLQkJc3Ry
dWN0IGludGVsX3BpcGVfY3JjICpwaXBlX2NyYyA9ICZkZXZfcHJpdi0+cGlwZV9jcmNbcGlwZV07
Cj4gKwlmb3JfZWFjaF9waXBlKGk5MTUsIHBpcGUpIHsKPiArCQlzdHJ1Y3QgaW50ZWxfcGlwZV9j
cmMgKnBpcGVfY3JjID0gJmk5MTUtPnBpcGVfY3JjW3BpcGVdOwo+ICAgCj4gICAJCXNwaW5fbG9j
a19pbml0KCZwaXBlX2NyYy0+bG9jayk7Cj4gICAJfQo+ICAgfQo+ICAgCj4gLXN0YXRpYyBpbnQg
aTh4eF9jcmNfc291cmNlX3ZhbGlkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiArc3RhdGljIGludCBpOHh4X2NyY19zb3VyY2VfdmFsaWQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gICAJCQkJIGNvbnN0IGVudW0gaW50ZWxfcGlwZV9jcmNfc291cmNlIHNvdXJj
ZSkKPiAgIHsKPiAgIAlzd2l0Y2ggKHNvdXJjZSkgewo+IEBAIC00NjMsNyArNDYzLDcgQEAgc3Rh
dGljIGludCBpOHh4X2NyY19zb3VyY2VfdmFsaWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ICAgCX0KPiAgIH0KPiAgIAo+IC1zdGF0aWMgaW50IGk5eHhfY3JjX3NvdXJjZV92
YWxpZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBpbnQgaTl4
eF9jcmNfc291cmNlX3ZhbGlkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJ
CSBjb25zdCBlbnVtIGludGVsX3BpcGVfY3JjX3NvdXJjZSBzb3VyY2UpCj4gICB7Cj4gICAJc3dp
dGNoIChzb3VyY2UpIHsKPiBAQCAtNDc2LDcgKzQ3Niw3IEBAIHN0YXRpYyBpbnQgaTl4eF9jcmNf
c291cmNlX3ZhbGlkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAl9Cj4g
ICB9Cj4gICAKPiAtc3RhdGljIGludCB2bHZfY3JjX3NvdXJjZV92YWxpZChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBpbnQgdmx2X2NyY19zb3VyY2VfdmFsaWQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJY29uc3QgZW51bSBpbnRlbF9w
aXBlX2NyY19zb3VyY2Ugc291cmNlKQo+ICAgewo+ICAgCXN3aXRjaCAoc291cmNlKSB7Cj4gQEAg
LTQ5MSw3ICs0OTEsNyBAQCBzdGF0aWMgaW50IHZsdl9jcmNfc291cmNlX3ZhbGlkKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAl9Cj4gICB9Cj4gICAKPiAtc3RhdGljIGlu
dCBpbGtfY3JjX3NvdXJjZV92YWxpZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gK3N0YXRpYyBpbnQgaWxrX2NyY19zb3VyY2VfdmFsaWQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gICAJCQkJY29uc3QgZW51bSBpbnRlbF9waXBlX2NyY19zb3VyY2Ugc291cmNl
KQo+ICAgewo+ICAgCXN3aXRjaCAoc291cmNlKSB7Cj4gQEAgLTUwNSw3ICs1MDUsNyBAQCBzdGF0
aWMgaW50IGlsa19jcmNfc291cmNlX3ZhbGlkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiAgIAl9Cj4gICB9Cj4gICAKPiAtc3RhdGljIGludCBpdmJfY3JjX3NvdXJjZV92YWxp
ZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBpbnQgaXZiX2Ny
Y19zb3VyY2VfdmFsaWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJY29u
c3QgZW51bSBpbnRlbF9waXBlX2NyY19zb3VyY2Ugc291cmNlKQo+ICAgewo+ICAgCXN3aXRjaCAo
c291cmNlKSB7Cj4gQEAgLTUxOSw3ICs1MTksNyBAQCBzdGF0aWMgaW50IGl2Yl9jcmNfc291cmNl
X3ZhbGlkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAl9Cj4gICB9Cj4g
ICAKPiAtc3RhdGljIGludCBza2xfY3JjX3NvdXJjZV92YWxpZChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBpbnQgc2tsX2NyY19zb3VyY2VfdmFsaWQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJY29uc3QgZW51bSBpbnRlbF9waXBlX2Ny
Y19zb3VyY2Ugc291cmNlKQo+ICAgewo+ICAgCXN3aXRjaCAoc291cmNlKSB7Cj4gQEAgLTUzOSwy
MSArNTM5LDIxIEBAIHN0YXRpYyBpbnQgc2tsX2NyY19zb3VyY2VfdmFsaWQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgfQo+ICAgCj4gICBzdGF0aWMgaW50Cj4gLWludGVs
X2lzX3ZhbGlkX2NyY19zb3VyY2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICtpbnRlbF9pc192YWxpZF9jcmNfc291cmNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAo+ICAgCQkJICBjb25zdCBlbnVtIGludGVsX3BpcGVfY3JjX3NvdXJjZSBzb3VyY2UpCj4gICB7
Cj4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCAyKSkKPiAtCQlyZXR1cm4gaTh4eF9jcmNfc291cmNl
X3ZhbGlkKGRldl9wcml2LCBzb3VyY2UpOwo+IC0JZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2
KSA8IDUpCj4gLQkJcmV0dXJuIGk5eHhfY3JjX3NvdXJjZV92YWxpZChkZXZfcHJpdiwgc291cmNl
KTsKPiAtCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVco
ZGV2X3ByaXYpKQo+IC0JCXJldHVybiB2bHZfY3JjX3NvdXJjZV92YWxpZChkZXZfcHJpdiwgc291
cmNlKTsKPiAtCWVsc2UgaWYgKElTX0dFTl9SQU5HRShkZXZfcHJpdiwgNSwgNikpCj4gLQkJcmV0
dXJuIGlsa19jcmNfc291cmNlX3ZhbGlkKGRldl9wcml2LCBzb3VyY2UpOwo+IC0JZWxzZSBpZiAo
SU5URUxfR0VOKGRldl9wcml2KSA8IDkpCj4gLQkJcmV0dXJuIGl2Yl9jcmNfc291cmNlX3ZhbGlk
KGRldl9wcml2LCBzb3VyY2UpOwo+ICsJaWYgKElTX0dFTihpOTE1LCAyKSkKPiArCQlyZXR1cm4g
aTh4eF9jcmNfc291cmNlX3ZhbGlkKGk5MTUsIHNvdXJjZSk7Cj4gKwllbHNlIGlmIChJTlRFTF9H
RU4oaTkxNSkgPCA1KQo+ICsJCXJldHVybiBpOXh4X2NyY19zb3VyY2VfdmFsaWQoaTkxNSwgc291
cmNlKTsKPiArCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhp
OTE1KSkKPiArCQlyZXR1cm4gdmx2X2NyY19zb3VyY2VfdmFsaWQoaTkxNSwgc291cmNlKTsKPiAr
CWVsc2UgaWYgKElTX0dFTl9SQU5HRShpOTE1LCA1LCA2KSkKPiArCQlyZXR1cm4gaWxrX2NyY19z
b3VyY2VfdmFsaWQoaTkxNSwgc291cmNlKTsKPiArCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA8
IDkpCj4gKwkJcmV0dXJuIGl2Yl9jcmNfc291cmNlX3ZhbGlkKGk5MTUsIHNvdXJjZSk7Cj4gICAJ
ZWxzZQo+IC0JCXJldHVybiBza2xfY3JjX3NvdXJjZV92YWxpZChkZXZfcHJpdiwgc291cmNlKTsK
PiArCQlyZXR1cm4gc2tsX2NyY19zb3VyY2VfdmFsaWQoaTkxNSwgc291cmNlKTsKPiAgIH0KPiAg
IAo+ICAgY29uc3QgY2hhciAqY29uc3QgKmludGVsX2NydGNfZ2V0X2NyY19zb3VyY2VzKHN0cnVj
dCBkcm1fY3J0YyAqY3J0YywKPiBAQCAtNTY2LDcgKzU2Niw3IEBAIGNvbnN0IGNoYXIgKmNvbnN0
ICppbnRlbF9jcnRjX2dldF9jcmNfc291cmNlcyhzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gICBp
bnQgaW50ZWxfY3J0Y192ZXJpZnlfY3JjX3NvdXJjZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMsIGNv
bnN0IGNoYXIgKnNvdXJjZV9uYW1lLAo+ICAgCQkJCSBzaXplX3QgKnZhbHVlc19jbnQpCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmRl
dik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+ZGV2
KTsKPiAgIAllbnVtIGludGVsX3BpcGVfY3JjX3NvdXJjZSBzb3VyY2U7Cj4gICAKPiAgIAlpZiAo
ZGlzcGxheV9jcmNfY3RsX3BhcnNlX3NvdXJjZShzb3VyY2VfbmFtZSwgJnNvdXJjZSkgPCAwKSB7
Cj4gQEAgLTU3NSw3ICs1NzUsNyBAQCBpbnQgaW50ZWxfY3J0Y192ZXJpZnlfY3JjX3NvdXJjZShz
dHJ1Y3QgZHJtX2NydGMgKmNydGMsIGNvbnN0IGNoYXIgKnNvdXJjZV9uYW1lLAo+ICAgCX0KPiAg
IAo+ICAgCWlmIChzb3VyY2UgPT0gSU5URUxfUElQRV9DUkNfU09VUkNFX0FVVE8gfHwKPiAtCSAg
ICBpbnRlbF9pc192YWxpZF9jcmNfc291cmNlKGRldl9wcml2LCBzb3VyY2UpID09IDApIHsKPiAr
CSAgICBpbnRlbF9pc192YWxpZF9jcmNfc291cmNlKGk5MTUsIHNvdXJjZSkgPT0gMCkgewo+ICAg
CQkqdmFsdWVzX2NudCA9IDU7Cj4gICAJCXJldHVybiAwOwo+ICAgCX0KPiBAQCAtNTg1LDggKzU4
NSw4IEBAIGludCBpbnRlbF9jcnRjX3ZlcmlmeV9jcmNfc291cmNlKHN0cnVjdCBkcm1fY3J0YyAq
Y3J0YywgY29uc3QgY2hhciAqc291cmNlX25hbWUsCj4gICAKPiAgIGludCBpbnRlbF9jcnRjX3Nl
dF9jcmNfc291cmNlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywgY29uc3QgY2hhciAqc291cmNlX25h
bWUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGNydGMtPmRldik7Cj4gLQlzdHJ1Y3QgaW50ZWxfcGlwZV9jcmMgKnBpcGVfY3JjID0gJmRldl9w
cml2LT5waXBlX2NyY1tjcnRjLT5pbmRleF07Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoY3J0Yy0+ZGV2KTsKPiArCXN0cnVjdCBpbnRlbF9waXBlX2NyYyAqcGlw
ZV9jcmMgPSAmaTkxNS0+cGlwZV9jcmNbY3J0Yy0+aW5kZXhdOwo+ICAgCWVudW0gaW50ZWxfZGlz
cGxheV9wb3dlcl9kb21haW4gcG93ZXJfZG9tYWluOwo+ICAgCWVudW0gaW50ZWxfcGlwZV9jcmNf
c291cmNlIHNvdXJjZTsKPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiBAQCAtNjAwLDcg
KzYwMCw3IEBAIGludCBpbnRlbF9jcnRjX3NldF9jcmNfc291cmNlKHN0cnVjdCBkcm1fY3J0YyAq
Y3J0YywgY29uc3QgY2hhciAqc291cmNlX25hbWUpCj4gICAJfQo+ICAgCj4gICAJcG93ZXJfZG9t
YWluID0gUE9XRVJfRE9NQUlOX1BJUEUoY3J0Yy0+aW5kZXgpOwo+IC0Jd2FrZXJlZiA9IGludGVs
X2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2X3ByaXYsIHBvd2VyX2RvbWFpbik7Cj4g
Kwl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChpOTE1LCBwb3dl
cl9kb21haW4pOwo+ICAgCWlmICghd2FrZXJlZikgewo+ICAgCQlEUk1fREVCVUdfS01TKCJUcnlp
bmcgdG8gY2FwdHVyZSBDUkMgd2hpbGUgcGlwZSBpcyBvZmZcbiIpOwo+ICAgCQlyZXR1cm4gLUVJ
TzsKPiBAQCAtNjEwLDcgKzYxMCw3IEBAIGludCBpbnRlbF9jcnRjX3NldF9jcmNfc291cmNlKHN0
cnVjdCBkcm1fY3J0YyAqY3J0YywgY29uc3QgY2hhciAqc291cmNlX25hbWUpCj4gICAJaWYgKGVu
YWJsZSkKPiAgIAkJaW50ZWxfY3J0Y19jcmNfc2V0dXBfd29ya2Fyb3VuZHModG9faW50ZWxfY3J0
YyhjcnRjKSwgdHJ1ZSk7Cj4gICAKPiAtCXJldCA9IGdldF9uZXdfY3JjX2N0bF9yZWcoZGV2X3By
aXYsIGNydGMtPmluZGV4LCAmc291cmNlLCAmdmFsKTsKPiArCXJldCA9IGdldF9uZXdfY3JjX2N0
bF9yZWcoaTkxNSwgY3J0Yy0+aW5kZXgsICZzb3VyY2UsICZ2YWwpOwo+ICAgCWlmIChyZXQgIT0g
MCkKPiAgIAkJZ290byBvdXQ7Cj4gICAKPiBAQCAtNjE5LDggKzYxOSw4IEBAIGludCBpbnRlbF9j
cnRjX3NldF9jcmNfc291cmNlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywgY29uc3QgY2hhciAqc291
cmNlX25hbWUpCj4gICAJUE9TVElOR19SRUFEKFBJUEVfQ1JDX0NUTChjcnRjLT5pbmRleCkpOwo+
ICAgCj4gICAJaWYgKCFzb3VyY2UpIHsKPiAtCQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikg
fHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gLQkJCXZsdl91bmRvX3BpcGVfc2NyYW1ibGVf
cmVzZXQoZGV2X3ByaXYsIGNydGMtPmluZGV4KTsKPiArCQlpZiAoSVNfVkFMTEVZVklFVyhpOTE1
KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKQo+ICsJCQl2bHZfdW5kb19waXBlX3NjcmFtYmxlX3Jl
c2V0KGk5MTUsIGNydGMtPmluZGV4KTsKPiAgIAl9Cj4gICAKPiAgIAlwaXBlX2NyYy0+c2tpcHBl
ZCA9IDA7Cj4gQEAgLTYyOSw3ICs2MjksNyBAQCBpbnQgaW50ZWxfY3J0Y19zZXRfY3JjX3NvdXJj
ZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMsIGNvbnN0IGNoYXIgKnNvdXJjZV9uYW1lKQo+ICAgCWlm
ICghZW5hYmxlKQo+ICAgCQlpbnRlbF9jcnRjX2NyY19zZXR1cF93b3JrYXJvdW5kcyh0b19pbnRl
bF9jcnRjKGNydGMpLCBmYWxzZSk7Cj4gICAKPiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRl
dl9wcml2LCBwb3dlcl9kb21haW4sIHdha2VyZWYpOwo+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9w
dXQoaTkxNSwgcG93ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiAgIAo+ICAgCXJldHVybiByZXQ7Cj4g
ICB9Cj4gQEAgLTYzNywxNCArNjM3LDE0IEBAIGludCBpbnRlbF9jcnRjX3NldF9jcmNfc291cmNl
KHN0cnVjdCBkcm1fY3J0YyAqY3J0YywgY29uc3QgY2hhciAqc291cmNlX25hbWUpCj4gICB2b2lk
IGludGVsX2NydGNfZW5hYmxlX3BpcGVfY3JjKHN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRj
KQo+ICAgewo+ICAgCXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9ICZpbnRlbF9jcnRjLT5iYXNlOwo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5kZXYp
Owo+IC0Jc3RydWN0IGludGVsX3BpcGVfY3JjICpwaXBlX2NyYyA9ICZkZXZfcHJpdi0+cGlwZV9j
cmNbY3J0Yy0+aW5kZXhdOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGNydGMtPmRldik7Cj4gKwlzdHJ1Y3QgaW50ZWxfcGlwZV9jcmMgKnBpcGVfY3JjID0gJmk5
MTUtPnBpcGVfY3JjW2NydGMtPmluZGV4XTsKPiAgIAl1MzIgdmFsID0gMDsKPiAgIAo+ICAgCWlm
ICghY3J0Yy0+Y3JjLm9wZW5lZCkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQlpZiAoZ2V0X25ld19j
cmNfY3RsX3JlZyhkZXZfcHJpdiwgY3J0Yy0+aW5kZXgsICZwaXBlX2NyYy0+c291cmNlLCAmdmFs
KSA8IDApCj4gKwlpZiAoZ2V0X25ld19jcmNfY3RsX3JlZyhpOTE1LCBjcnRjLT5pbmRleCwgJnBp
cGVfY3JjLT5zb3VyY2UsICZ2YWwpIDwgMCkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJLyogRG9u
J3QgbmVlZCBwaXBlX2NyYy0+bG9jayBoZXJlLCBJUlFzIGFyZSBub3QgZ2VuZXJhdGVkLiAqLwo+
IEBAIC02NTcsOCArNjU3LDggQEAgdm9pZCBpbnRlbF9jcnRjX2VuYWJsZV9waXBlX2NyYyhzdHJ1
Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YykKPiAgIHZvaWQgaW50ZWxfY3J0Y19kaXNhYmxlX3Bp
cGVfY3JjKHN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjKQo+ICAgewo+ICAgCXN0cnVjdCBk
cm1fY3J0YyAqY3J0YyA9ICZpbnRlbF9jcnRjLT5iYXNlOwo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5kZXYpOwo+IC0Jc3RydWN0IGludGVsX3Bp
cGVfY3JjICpwaXBlX2NyYyA9ICZkZXZfcHJpdi0+cGlwZV9jcmNbY3J0Yy0+aW5kZXhdOwo+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmRldik7Cj4gKwlz
dHJ1Y3QgaW50ZWxfcGlwZV9jcmMgKnBpcGVfY3JjID0gJmk5MTUtPnBpcGVfY3JjW2NydGMtPmlu
ZGV4XTsKPiAgIAo+ICAgCS8qIFN3YWxsb3cgY3JjJ3MgdW50aWwgd2Ugc3RvcCBnZW5lcmF0aW5n
IHRoZW0uICovCj4gICAJc3Bpbl9sb2NrX2lycSgmcGlwZV9jcmMtPmxvY2spOwo+IEBAIC02Njcs
NSArNjY3LDUgQEAgdm9pZCBpbnRlbF9jcnRjX2Rpc2FibGVfcGlwZV9jcmMoc3RydWN0IGludGVs
X2NydGMgKmludGVsX2NydGMpCj4gICAKPiAgIAlJOTE1X1dSSVRFKFBJUEVfQ1JDX0NUTChjcnRj
LT5pbmRleCksIDApOwo+ICAgCVBPU1RJTkdfUkVBRChQSVBFX0NSQ19DVEwoY3J0Yy0+aW5kZXgp
KTsKPiAtCXN5bmNocm9uaXplX2lycShkZXZfcHJpdi0+ZHJtLmlycSk7Cj4gKwlzeW5jaHJvbml6
ZV9pcnEoaTkxNS0+ZHJtLmlycSk7Cj4gICB9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX3BpcGVfY3JjLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9waXBl
X2NyYy5oCj4gaW5kZXggZGIyNThhNzU2ZmM2Li40MjA0OGFiMTM5MWEgMTAwNjQ0Cj4gLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcGlwZV9jcmMuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX3BpcGVfY3JjLmgKPiBAQCAtMTMsNyArMTMsNyBAQCBzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZTsKPiAgIHN0cnVjdCBpbnRlbF9jcnRjOwo+ICAgCj4gICAjaWZkZWYgQ09O
RklHX0RFQlVHX0ZTCj4gLXZvaWQgaW50ZWxfZGlzcGxheV9jcmNfaW5pdChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ICt2b2lkIGludGVsX2Rpc3BsYXlfY3JjX2luaXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgaW50IGludGVsX2NydGNfc2V0X2NyY19z
b3VyY2Uoc3RydWN0IGRybV9jcnRjICpjcnRjLCBjb25zdCBjaGFyICpzb3VyY2VfbmFtZSk7Cj4g
ICBpbnQgaW50ZWxfY3J0Y192ZXJpZnlfY3JjX3NvdXJjZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMs
Cj4gICAJCQkJIGNvbnN0IGNoYXIgKnNvdXJjZV9uYW1lLCBzaXplX3QgKnZhbHVlc19jbnQpOwo+
IEBAIC0yMiw3ICsyMiw3IEBAIGNvbnN0IGNoYXIgKmNvbnN0ICppbnRlbF9jcnRjX2dldF9jcmNf
c291cmNlcyhzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gICB2b2lkIGludGVsX2NydGNfZGlzYWJs
ZV9waXBlX2NyYyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0Yyk7Cj4gICB2b2lkIGludGVsX2NydGNf
ZW5hYmxlX3BpcGVfY3JjKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKTsKPiAgICNlbHNlCj4gLXN0
YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9kaXNwbGF5X2NyY19pbml0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikge30KPiArc3RhdGljIGlubGluZSB2b2lkIGludGVsX2Rpc3BsYXlf
Y3JjX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpIHt9Cj4gICAjZGVmaW5lIGlu
dGVsX2NydGNfc2V0X2NyY19zb3VyY2UgTlVMTAo+ICAgI2RlZmluZSBpbnRlbF9jcnRjX3Zlcmlm
eV9jcmNfc291cmNlIE5VTEwKPiAgICNkZWZpbmUgaW50ZWxfY3J0Y19nZXRfY3JjX3NvdXJjZXMg
TlVMTAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYwo+IGluZGV4IDJjN2YzZWJjMDExNy4uNGI5Mzkx
NjBjZDk1IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMKPiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5jCj4gQEAgLTYzLDkgKzYzLDkgQEAK
PiAgICAqIHJlcXVpcmUgaGlnaGVyIGxhdGVuY3kgdG8gc3dpdGNoIHRvIGFuZCB3YWtlIHVwLgo+
ICAgICovCj4gICAKPiAtc3RhdGljIHZvaWQgZ2VuOV9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGdlbjlfaW5pdF9jbG9j
a19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlpZiAoSEFT
X0xMQyhkZXZfcHJpdikpIHsKPiArCWlmIChIQVNfTExDKGk5MTUpKSB7Cj4gICAJCS8qCj4gICAJ
CSAqIFdhQ29tcHJlc3NlZFJlc291cmNlRGlzcGxheU5ld0hhc2hNb2RlOnNrbCxrYmwKPiAgIAkJ
ICogRGlzcGxheSBXQSAjMDM5MDogc2tsLGtibAo+IEBAIC05NiwxNiArOTYsMTYgQEAgc3RhdGlj
IHZvaWQgZ2VuOV9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gICAJSTkxNV9XUklURShJTEtfRFBGQ19DSElDS0VOLCBJOTE1X1JFQUQoSUxLX0RQ
RkNfQ0hJQ0tFTikgfAo+ICAgCQkgICBJTEtfRFBGQ19ESVNBQkxFX0RVTU1ZMCk7Cj4gICAKPiAt
CWlmIChJU19TS1lMQUtFKGRldl9wcml2KSkgewo+ICsJaWYgKElTX1NLWUxBS0UoaTkxNSkpIHsK
PiAgIAkJLyogV2FEaXNhYmxlRG9wQ2xvY2tHYXRpbmcgKi8KPiAgIAkJSTkxNV9XUklURShHRU43
X01JU0NDUENUTCwgSTkxNV9SRUFEKEdFTjdfTUlTQ0NQQ1RMKQo+ICAgCQkJICAgJiB+R0VON19E
T1BfQ0xPQ0tfR0FURV9FTkFCTEUpOwo+ICAgCX0KPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBi
eHRfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ICtzdGF0aWMgdm9pZCBieHRfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCj4gICB7Cj4gLQlnZW45X2luaXRfY2xvY2tfZ2F0aW5nKGRldl9wcml2KTsKPiAr
CWdlbjlfaW5pdF9jbG9ja19nYXRpbmcoaTkxNSk7Cj4gICAKPiAgIAkvKiBXYURpc2FibGVTREVV
bml0Q2xvY2tHYXRpbmc6Ynh0ICovCj4gICAJSTkxNV9XUklURShHRU44X1VDR0NUTDYsIEk5MTVf
UkVBRChHRU44X1VDR0NUTDYpIHwKPiBAQCAtMTI2LDkgKzEyNiw5IEBAIHN0YXRpYyB2b2lkIGJ4
dF9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
ICAJCSAgIFBXTTFfR0FUSU5HX0RJUyB8IFBXTTJfR0FUSU5HX0RJUyk7Cj4gICB9Cj4gICAKPiAt
c3RhdGljIHZvaWQgZ2xrX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgZ2xrX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JZ2VuOV9pbml0X2Nsb2NrX2dhdGluZyhk
ZXZfcHJpdik7Cj4gKwlnZW45X2luaXRfY2xvY2tfZ2F0aW5nKGk5MTUpOwo+ICAgCj4gICAJLyoK
PiAgIAkgKiBXYURpc2FibGVQV01DbG9ja0dhdGluZzpnbGsKPiBAQCAtMTM5LDcgKzEzOSw3IEBA
IHN0YXRpYyB2b2lkIGdsa19pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gICAJCSAgIFBXTTFfR0FUSU5HX0RJUyB8IFBXTTJfR0FUSU5HX0RJUyk7
Cj4gICAKPiAgIAkvKiBXYURESUlPVGltZW91dDpnbGsgKi8KPiAtCWlmIChJU19HTEtfUkVWSUQo
ZGV2X3ByaXYsIDAsIEdMS19SRVZJRF9BMSkpIHsKPiArCWlmIChJU19HTEtfUkVWSUQoaTkxNSwg
MCwgR0xLX1JFVklEX0ExKSkgewo+ICAgCQl1MzIgdmFsID0gSTkxNV9SRUFEKENISUNLRU5fTUlT
Q18yKTsKPiAgIAkJdmFsICY9IH4oR0xLX0NMMF9QV1JfRE9XTiB8Cj4gICAJCQkgR0xLX0NMMV9Q
V1JfRE9XTiB8Cj4gQEAgLTE0OSw3ICsxNDksNyBAQCBzdGF0aWMgdm9pZCBnbGtfaW5pdF9jbG9j
a19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCj4gICB9Cj4g
ICAKPiAtc3RhdGljIHZvaWQgaTkxNV9waW5ldmlld19nZXRfbWVtX2ZyZXEoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBpOTE1X3BpbmV2aWV3X2dldF9t
ZW1fZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAl1MzIgdG1w
Owo+ICAgCj4gQEAgLTE1NywxMDAgKzE1NywxMDAgQEAgc3RhdGljIHZvaWQgaTkxNV9waW5ldmll
d19nZXRfbWVtX2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCj4g
ICAJc3dpdGNoICh0bXAgJiBDTEtDRkdfRlNCX01BU0spIHsKPiAgIAljYXNlIENMS0NGR19GU0Jf
NTMzOgo+IC0JCWRldl9wcml2LT5mc2JfZnJlcSA9IDUzMzsgLyogMTMzKjQgKi8KPiArCQlpOTE1
LT5mc2JfZnJlcSA9IDUzMzsgLyogMTMzKjQgKi8KPiAgIAkJYnJlYWs7Cj4gICAJY2FzZSBDTEtD
RkdfRlNCXzgwMDoKPiAtCQlkZXZfcHJpdi0+ZnNiX2ZyZXEgPSA4MDA7IC8qIDIwMCo0ICovCj4g
KwkJaTkxNS0+ZnNiX2ZyZXEgPSA4MDA7IC8qIDIwMCo0ICovCj4gICAJCWJyZWFrOwo+ICAgCWNh
c2UgQ0xLQ0ZHX0ZTQl82Njc6Cj4gLQkJZGV2X3ByaXYtPmZzYl9mcmVxID0gIDY2NzsgLyogMTY3
KjQgKi8KPiArCQlpOTE1LT5mc2JfZnJlcSA9ICA2Njc7IC8qIDE2Nyo0ICovCj4gICAJCWJyZWFr
Owo+ICAgCWNhc2UgQ0xLQ0ZHX0ZTQl80MDA6Cj4gLQkJZGV2X3ByaXYtPmZzYl9mcmVxID0gNDAw
OyAvKiAxMDAqNCAqLwo+ICsJCWk5MTUtPmZzYl9mcmVxID0gNDAwOyAvKiAxMDAqNCAqLwo+ICAg
CQlicmVhazsKPiAgIAl9Cj4gICAKPiAgIAlzd2l0Y2ggKHRtcCAmIENMS0NGR19NRU1fTUFTSykg
ewo+ICAgCWNhc2UgQ0xLQ0ZHX01FTV81MzM6Cj4gLQkJZGV2X3ByaXYtPm1lbV9mcmVxID0gNTMz
Owo+ICsJCWk5MTUtPm1lbV9mcmVxID0gNTMzOwo+ICAgCQlicmVhazsKPiAgIAljYXNlIENMS0NG
R19NRU1fNjY3Ogo+IC0JCWRldl9wcml2LT5tZW1fZnJlcSA9IDY2NzsKPiArCQlpOTE1LT5tZW1f
ZnJlcSA9IDY2NzsKPiAgIAkJYnJlYWs7Cj4gICAJY2FzZSBDTEtDRkdfTUVNXzgwMDoKPiAtCQlk
ZXZfcHJpdi0+bWVtX2ZyZXEgPSA4MDA7Cj4gKwkJaTkxNS0+bWVtX2ZyZXEgPSA4MDA7Cj4gICAJ
CWJyZWFrOwo+ICAgCX0KPiAgIAo+ICAgCS8qIGRldGVjdCBwaW5ldmlldyBERFIzIHNldHRpbmcg
Ki8KPiAgIAl0bXAgPSBJOTE1X1JFQUQoQ1NIUkREUjNDVEwpOwo+IC0JZGV2X3ByaXYtPmlzX2Rk
cjMgPSAodG1wICYgQ1NIUkREUjNDVExfRERSMykgPyAxIDogMDsKPiArCWk5MTUtPmlzX2RkcjMg
PSAodG1wICYgQ1NIUkREUjNDVExfRERSMykgPyAxIDogMDsKPiAgIH0KPiAgIAo+IC1zdGF0aWMg
dm9pZCBpOTE1X2lyb25sYWtlX2dldF9tZW1fZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGk5MTVfaXJvbmxha2VfZ2V0X21lbV9mcmVxKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUxNiBkZHJwbGwsIGNzaXBsbDsK
PiAgIAo+IC0JZGRycGxsID0gaW50ZWxfdW5jb3JlX3JlYWQxNigmZGV2X3ByaXYtPnVuY29yZSwg
RERSTVBMTDEpOwo+IC0JY3NpcGxsID0gaW50ZWxfdW5jb3JlX3JlYWQxNigmZGV2X3ByaXYtPnVu
Y29yZSwgQ1NJUExMMCk7Cj4gKwlkZHJwbGwgPSBpbnRlbF91bmNvcmVfcmVhZDE2KCZpOTE1LT51
bmNvcmUsIEREUk1QTEwxKTsKPiArCWNzaXBsbCA9IGludGVsX3VuY29yZV9yZWFkMTYoJmk5MTUt
PnVuY29yZSwgQ1NJUExMMCk7Cj4gICAKPiAgIAlzd2l0Y2ggKGRkcnBsbCAmIDB4ZmYpIHsKPiAg
IAljYXNlIDB4YzoKPiAtCQlkZXZfcHJpdi0+bWVtX2ZyZXEgPSA4MDA7Cj4gKwkJaTkxNS0+bWVt
X2ZyZXEgPSA4MDA7Cj4gICAJCWJyZWFrOwo+ICAgCWNhc2UgMHgxMDoKPiAtCQlkZXZfcHJpdi0+
bWVtX2ZyZXEgPSAxMDY2Owo+ICsJCWk5MTUtPm1lbV9mcmVxID0gMTA2NjsKPiAgIAkJYnJlYWs7
Cj4gICAJY2FzZSAweDE0Ogo+IC0JCWRldl9wcml2LT5tZW1fZnJlcSA9IDEzMzM7Cj4gKwkJaTkx
NS0+bWVtX2ZyZXEgPSAxMzMzOwo+ICAgCQlicmVhazsKPiAgIAljYXNlIDB4MTg6Cj4gLQkJZGV2
X3ByaXYtPm1lbV9mcmVxID0gMTYwMDsKPiArCQlpOTE1LT5tZW1fZnJlcSA9IDE2MDA7Cj4gICAJ
CWJyZWFrOwo+ICAgCWRlZmF1bHQ6Cj4gICAJCURSTV9ERUJVR19EUklWRVIoInVua25vd24gbWVt
b3J5IGZyZXF1ZW5jeSAweCUwMnhcbiIsCj4gICAJCQkJIGRkcnBsbCAmIDB4ZmYpOwo+IC0JCWRl
dl9wcml2LT5tZW1fZnJlcSA9IDA7Cj4gKwkJaTkxNS0+bWVtX2ZyZXEgPSAwOwo+ICAgCQlicmVh
azsKPiAgIAl9Cj4gICAKPiAtCWRldl9wcml2LT5pcHMucl90ID0gZGV2X3ByaXYtPm1lbV9mcmVx
Owo+ICsJaTkxNS0+aXBzLnJfdCA9IGk5MTUtPm1lbV9mcmVxOwo+ICAgCj4gICAJc3dpdGNoIChj
c2lwbGwgJiAweDNmZikgewo+ICAgCWNhc2UgMHgwMGM6Cj4gLQkJZGV2X3ByaXYtPmZzYl9mcmVx
ID0gMzIwMDsKPiArCQlpOTE1LT5mc2JfZnJlcSA9IDMyMDA7Cj4gICAJCWJyZWFrOwo+ICAgCWNh
c2UgMHgwMGU6Cj4gLQkJZGV2X3ByaXYtPmZzYl9mcmVxID0gMzczMzsKPiArCQlpOTE1LT5mc2Jf
ZnJlcSA9IDM3MzM7Cj4gICAJCWJyZWFrOwo+ICAgCWNhc2UgMHgwMTA6Cj4gLQkJZGV2X3ByaXYt
PmZzYl9mcmVxID0gNDI2NjsKPiArCQlpOTE1LT5mc2JfZnJlcSA9IDQyNjY7Cj4gICAJCWJyZWFr
Owo+ICAgCWNhc2UgMHgwMTI6Cj4gLQkJZGV2X3ByaXYtPmZzYl9mcmVxID0gNDgwMDsKPiArCQlp
OTE1LT5mc2JfZnJlcSA9IDQ4MDA7Cj4gICAJCWJyZWFrOwo+ICAgCWNhc2UgMHgwMTQ6Cj4gLQkJ
ZGV2X3ByaXYtPmZzYl9mcmVxID0gNTMzMzsKPiArCQlpOTE1LT5mc2JfZnJlcSA9IDUzMzM7Cj4g
ICAJCWJyZWFrOwo+ICAgCWNhc2UgMHgwMTY6Cj4gLQkJZGV2X3ByaXYtPmZzYl9mcmVxID0gNTg2
NjsKPiArCQlpOTE1LT5mc2JfZnJlcSA9IDU4NjY7Cj4gICAJCWJyZWFrOwo+ICAgCWNhc2UgMHgw
MTg6Cj4gLQkJZGV2X3ByaXYtPmZzYl9mcmVxID0gNjQwMDsKPiArCQlpOTE1LT5mc2JfZnJlcSA9
IDY0MDA7Cj4gICAJCWJyZWFrOwo+ICAgCWRlZmF1bHQ6Cj4gICAJCURSTV9ERUJVR19EUklWRVIo
InVua25vd24gZnNiIGZyZXF1ZW5jeSAweCUwNHhcbiIsCj4gICAJCQkJIGNzaXBsbCAmIDB4M2Zm
KTsKPiAtCQlkZXZfcHJpdi0+ZnNiX2ZyZXEgPSAwOwo+ICsJCWk5MTUtPmZzYl9mcmVxID0gMDsK
PiAgIAkJYnJlYWs7Cj4gICAJfQo+ICAgCj4gLQlpZiAoZGV2X3ByaXYtPmZzYl9mcmVxID09IDMy
MDApIHsKPiAtCQlkZXZfcHJpdi0+aXBzLmNfbSA9IDA7Cj4gLQl9IGVsc2UgaWYgKGRldl9wcml2
LT5mc2JfZnJlcSA+IDMyMDAgJiYgZGV2X3ByaXYtPmZzYl9mcmVxIDw9IDQ4MDApIHsKPiAtCQlk
ZXZfcHJpdi0+aXBzLmNfbSA9IDE7Cj4gKwlpZiAoaTkxNS0+ZnNiX2ZyZXEgPT0gMzIwMCkgewo+
ICsJCWk5MTUtPmlwcy5jX20gPSAwOwo+ICsJfSBlbHNlIGlmIChpOTE1LT5mc2JfZnJlcSA+IDMy
MDAgJiYgaTkxNS0+ZnNiX2ZyZXEgPD0gNDgwMCkgewo+ICsJCWk5MTUtPmlwcy5jX20gPSAxOwo+
ICAgCX0gZWxzZSB7Cj4gLQkJZGV2X3ByaXYtPmlwcy5jX20gPSAyOwo+ICsJCWk5MTUtPmlwcy5j
X20gPSAyOwo+ICAgCX0KPiAgIH0KPiAgIAo+IEBAIC0zMTYsNjEgKzMxNiw2MSBAQCBzdGF0aWMg
Y29uc3Qgc3RydWN0IGN4c3JfbGF0ZW5jeSAqaW50ZWxfZ2V0X2N4c3JfbGF0ZW5jeShib29sIGlz
X2Rlc2t0b3AsCj4gICAJcmV0dXJuIE5VTEw7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgY2h2
X3NldF9tZW1vcnlfZHZmcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGJvb2wg
ZW5hYmxlKQo+ICtzdGF0aWMgdm9pZCBjaHZfc2V0X21lbW9yeV9kdmZzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LCBib29sIGVuYWJsZSkKPiAgIHsKPiAgIAl1MzIgdmFsOwo+ICAgCj4g
LQl2bHZfcHVuaXRfZ2V0KGRldl9wcml2KTsKPiArCXZsdl9wdW5pdF9nZXQoaTkxNSk7Cj4gICAK
PiAtCXZhbCA9IHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfRERSX1NFVFVQMik7
Cj4gKwl2YWwgPSB2bHZfcHVuaXRfcmVhZChpOTE1LCBQVU5JVF9SRUdfRERSX1NFVFVQMik7Cj4g
ICAJaWYgKGVuYWJsZSkKPiAgIAkJdmFsICY9IH5GT1JDRV9ERFJfSElHSF9GUkVROwo+ICAgCWVs
c2UKPiAgIAkJdmFsIHw9IEZPUkNFX0REUl9ISUdIX0ZSRVE7Cj4gICAJdmFsICY9IH5GT1JDRV9E
RFJfTE9XX0ZSRVE7Cj4gICAJdmFsIHw9IEZPUkNFX0REUl9GUkVRX1JFUV9BQ0s7Cj4gLQl2bHZf
cHVuaXRfd3JpdGUoZGV2X3ByaXYsIFBVTklUX1JFR19ERFJfU0VUVVAyLCB2YWwpOwo+ICsJdmx2
X3B1bml0X3dyaXRlKGk5MTUsIFBVTklUX1JFR19ERFJfU0VUVVAyLCB2YWwpOwo+ICAgCj4gLQlp
ZiAod2FpdF9mb3IoKHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfRERSX1NFVFVQ
MikgJgo+ICsJaWYgKHdhaXRfZm9yKCh2bHZfcHVuaXRfcmVhZChpOTE1LCBQVU5JVF9SRUdfRERS
X1NFVFVQMikgJgo+ICAgCQkgICAgICBGT1JDRV9ERFJfRlJFUV9SRVFfQUNLKSA9PSAwLCAzKSkK
PiAgIAkJRFJNX0VSUk9SKCJ0aW1lZCBvdXQgd2FpdGluZyBmb3IgUHVuaXQgRERSIERWRlMgcmVx
dWVzdFxuIik7Cj4gICAKPiAtCXZsdl9wdW5pdF9wdXQoZGV2X3ByaXYpOwo+ICsJdmx2X3B1bml0
X3B1dChpOTE1KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBjaHZfc2V0X21lbW9yeV9wbTUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBib29sIGVuYWJsZSkKPiArc3RhdGlj
IHZvaWQgY2h2X3NldF9tZW1vcnlfcG01KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBi
b29sIGVuYWJsZSkKPiAgIHsKPiAgIAl1MzIgdmFsOwo+ICAgCj4gLQl2bHZfcHVuaXRfZ2V0KGRl
dl9wcml2KTsKPiArCXZsdl9wdW5pdF9nZXQoaTkxNSk7Cj4gICAKPiAtCXZhbCA9IHZsdl9wdW5p
dF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfRFNQU1NQTSk7Cj4gKwl2YWwgPSB2bHZfcHVuaXRf
cmVhZChpOTE1LCBQVU5JVF9SRUdfRFNQU1NQTSk7Cj4gICAJaWYgKGVuYWJsZSkKPiAgIAkJdmFs
IHw9IERTUF9NQVhGSUZPX1BNNV9FTkFCTEU7Cj4gICAJZWxzZQo+ICAgCQl2YWwgJj0gfkRTUF9N
QVhGSUZPX1BNNV9FTkFCTEU7Cj4gLQl2bHZfcHVuaXRfd3JpdGUoZGV2X3ByaXYsIFBVTklUX1JF
R19EU1BTU1BNLCB2YWwpOwo+ICsJdmx2X3B1bml0X3dyaXRlKGk5MTUsIFBVTklUX1JFR19EU1BT
U1BNLCB2YWwpOwo+ICAgCj4gLQl2bHZfcHVuaXRfcHV0KGRldl9wcml2KTsKPiArCXZsdl9wdW5p
dF9wdXQoaTkxNSk7Cj4gICB9Cj4gICAKPiAgICNkZWZpbmUgRldfV00odmFsdWUsIHBsYW5lKSBc
Cj4gICAJKCgodmFsdWUpIDw8IERTUEZXXyAjIyBwbGFuZSAjIyBfU0hJRlQpICYgRFNQRldfICMj
IHBsYW5lICMjIF9NQVNLKQo+ICAgCj4gLXN0YXRpYyBib29sIF9pbnRlbF9zZXRfbWVtb3J5X2N4
c3Ioc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBib29sIGVuYWJsZSkKPiArc3Rh
dGljIGJvb2wgX2ludGVsX3NldF9tZW1vcnlfY3hzcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwgYm9vbCBlbmFibGUpCj4gICB7Cj4gICAJYm9vbCB3YXNfZW5hYmxlZDsKPiAgIAl1MzIg
dmFsOwo+ICAgCj4gLQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklF
VyhkZXZfcHJpdikpIHsKPiArCWlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJ
RVcoaTkxNSkpIHsKPiAgIAkJd2FzX2VuYWJsZWQgPSBJOTE1X1JFQUQoRldfQkxDX1NFTEZfVkxW
KSAmIEZXX0NTUFdSRFdORU47Cj4gICAJCUk5MTVfV1JJVEUoRldfQkxDX1NFTEZfVkxWLCBlbmFi
bGUgPyBGV19DU1BXUkRXTkVOIDogMCk7Cj4gICAJCVBPU1RJTkdfUkVBRChGV19CTENfU0VMRl9W
TFYpOwo+IC0JfSBlbHNlIGlmIChJU19HNFgoZGV2X3ByaXYpIHx8IElTX0k5NjVHTShkZXZfcHJp
dikpIHsKPiArCX0gZWxzZSBpZiAoSVNfRzRYKGk5MTUpIHx8IElTX0k5NjVHTShpOTE1KSkgewo+
ICAgCQl3YXNfZW5hYmxlZCA9IEk5MTVfUkVBRChGV19CTENfU0VMRikgJiBGV19CTENfU0VMRl9F
TjsKPiAgIAkJSTkxNV9XUklURShGV19CTENfU0VMRiwgZW5hYmxlID8gRldfQkxDX1NFTEZfRU4g
OiAwKTsKPiAgIAkJUE9TVElOR19SRUFEKEZXX0JMQ19TRUxGKTsKPiAtCX0gZWxzZSBpZiAoSVNf
UElORVZJRVcoZGV2X3ByaXYpKSB7Cj4gKwl9IGVsc2UgaWYgKElTX1BJTkVWSUVXKGk5MTUpKSB7
Cj4gICAJCXZhbCA9IEk5MTVfUkVBRChEU1BGVzMpOwo+ICAgCQl3YXNfZW5hYmxlZCA9IHZhbCAm
IFBJTkVWSUVXX1NFTEZfUkVGUkVTSF9FTjsKPiAgIAkJaWYgKGVuYWJsZSkKPiBAQCAtMzc5LDEz
ICszNzksMTMgQEAgc3RhdGljIGJvb2wgX2ludGVsX3NldF9tZW1vcnlfY3hzcihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGJvb2wgZW5hYmwKPiAgIAkJCXZhbCAmPSB+UElORVZJ
RVdfU0VMRl9SRUZSRVNIX0VOOwo+ICAgCQlJOTE1X1dSSVRFKERTUEZXMywgdmFsKTsKPiAgIAkJ
UE9TVElOR19SRUFEKERTUEZXMyk7Cj4gLQl9IGVsc2UgaWYgKElTX0k5NDVHKGRldl9wcml2KSB8
fCBJU19JOTQ1R00oZGV2X3ByaXYpKSB7Cj4gKwl9IGVsc2UgaWYgKElTX0k5NDVHKGk5MTUpIHx8
IElTX0k5NDVHTShpOTE1KSkgewo+ICAgCQl3YXNfZW5hYmxlZCA9IEk5MTVfUkVBRChGV19CTENf
U0VMRikgJiBGV19CTENfU0VMRl9FTjsKPiAgIAkJdmFsID0gZW5hYmxlID8gX01BU0tFRF9CSVRf
RU5BQkxFKEZXX0JMQ19TRUxGX0VOKSA6Cj4gICAJCQkgICAgICAgX01BU0tFRF9CSVRfRElTQUJM
RShGV19CTENfU0VMRl9FTik7Cj4gICAJCUk5MTVfV1JJVEUoRldfQkxDX1NFTEYsIHZhbCk7Cj4g
ICAJCVBPU1RJTkdfUkVBRChGV19CTENfU0VMRik7Cj4gLQl9IGVsc2UgaWYgKElTX0k5MTVHTShk
ZXZfcHJpdikpIHsKPiArCX0gZWxzZSBpZiAoSVNfSTkxNUdNKGk5MTUpKSB7Cj4gICAJCS8qCj4g
ICAJCSAqIEZJWE1FIGNhbid0IGZpbmQgYSBiaXQgbGlrZSB0aGlzIGZvciA5MTVHLCBhbmQKPiAg
IAkJICogYW5kIHlldCBpdCBkb2VzIGhhdmUgdGhlIHJlbGF0ZWQgd2F0ZXJtYXJrIGluCj4gQEAg
LTQwMCw3ICs0MDAsNyBAQCBzdGF0aWMgYm9vbCBfaW50ZWxfc2V0X21lbW9yeV9jeHNyKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgYm9vbCBlbmFibAo+ICAgCQlyZXR1cm4gZmFs
c2U7Cj4gICAJfQo+ICAgCj4gLQl0cmFjZV9pbnRlbF9tZW1vcnlfY3hzcihkZXZfcHJpdiwgd2Fz
X2VuYWJsZWQsIGVuYWJsZSk7Cj4gKwl0cmFjZV9pbnRlbF9tZW1vcnlfY3hzcihpOTE1LCB3YXNf
ZW5hYmxlZCwgZW5hYmxlKTsKPiAgIAo+ICAgCURSTV9ERUJVR19LTVMoIm1lbW9yeSBzZWxmLXJl
ZnJlc2ggaXMgJXMgKHdhcyAlcylcbiIsCj4gICAJCSAgICAgIGVuYWJsZWRkaXNhYmxlZChlbmFi
bGUpLAo+IEBAIC00MTEsNyArNDExLDcgQEAgc3RhdGljIGJvb2wgX2ludGVsX3NldF9tZW1vcnlf
Y3hzcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGJvb2wgZW5hYmwKPiAgIAo+
ICAgLyoqCj4gICAgKiBpbnRlbF9zZXRfbWVtb3J5X2N4c3IgLSBDb25maWd1cmUgQ3hTUiBzdGF0
ZQo+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlCj4gKyAqIEBpOTE1OiBpOTE1IGRldmljZQo+
ICAgICogQGVuYWJsZTogQWxsb3cgdnMuIGRpc2FsbG93IEN4U1IKPiAgICAqCj4gICAgKiBBbGxv
dyBvciBkaXNhbGxvdyB0aGUgc3lzdGVtIHRvIGVudGVyIGEgc3BlY2lhbCBDeFNSCj4gQEAgLTQ0
NiwxNyArNDQ2LDE3IEBAIHN0YXRpYyBib29sIF9pbnRlbF9zZXRfbWVtb3J5X2N4c3Ioc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBib29sIGVuYWJsCj4gICAgKiB0aGUgaGFyZHdh
cmUgdy5yLnQuIEhQTEwgU1Igd2hlbiB3cml0aW5nIHRvIHBsYW5lIHJlZ2lzdGVycy4KPiAgICAq
IERpc2FsbG93aW5nIGp1c3QgQ3hTUiBpcyBzdWZmaWNpZW50Lgo+ICAgICovCj4gLWJvb2wgaW50
ZWxfc2V0X21lbW9yeV9jeHNyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgYm9v
bCBlbmFibGUpCj4gK2Jvb2wgaW50ZWxfc2V0X21lbW9yeV9jeHNyKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LCBib29sIGVuYWJsZSkKPiAgIHsKPiAgIAlib29sIHJldDsKPiAgIAo+IC0J
bXV0ZXhfbG9jaygmZGV2X3ByaXYtPndtLndtX211dGV4KTsKPiAtCXJldCA9IF9pbnRlbF9zZXRf
bWVtb3J5X2N4c3IoZGV2X3ByaXYsIGVuYWJsZSk7Cj4gLQlpZiAoSVNfVkFMTEVZVklFVyhkZXZf
cHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gLQkJZGV2X3ByaXYtPndtLnZsdi5j
eHNyID0gZW5hYmxlOwo+IC0JZWxzZSBpZiAoSVNfRzRYKGRldl9wcml2KSkKPiAtCQlkZXZfcHJp
di0+d20uZzR4LmN4c3IgPSBlbmFibGU7Cj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT53bS53
bV9tdXRleCk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT53bS53bV9tdXRleCk7Cj4gKwlyZXQgPSBf
aW50ZWxfc2V0X21lbW9yeV9jeHNyKGk5MTUsIGVuYWJsZSk7Cj4gKwlpZiAoSVNfVkFMTEVZVklF
VyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKQo+ICsJCWk5MTUtPndtLnZsdi5jeHNyID0g
ZW5hYmxlOwo+ICsJZWxzZSBpZiAoSVNfRzRYKGk5MTUpKQo+ICsJCWk5MTUtPndtLmc0eC5jeHNy
ID0gZW5hYmxlOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT53bS53bV9tdXRleCk7Cj4gICAKPiAg
IAlyZXR1cm4gcmV0Owo+ICAgfQo+IEBAIC00ODMsNyArNDgzLDcgQEAgc3RhdGljIGNvbnN0IGlu
dCBwZXNzaW1hbF9sYXRlbmN5X25zID0gNTAwMDsKPiAgIHN0YXRpYyB2b2lkIHZsdl9nZXRfZmlm
b19zaXplKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgewo+ICAgCXN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNy
dGMpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
Y3J0Yy0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCB2bHZfZmlmb19zdGF0ZSAqZmlmb19zdGF0ZSA9
ICZjcnRjX3N0YXRlLT53bS52bHYuZmlmb19zdGF0ZTsKPiAgIAllbnVtIHBpcGUgcGlwZSA9IGNy
dGMtPnBpcGU7Cj4gICAJaW50IHNwcml0ZTBfc3RhcnQsIHNwcml0ZTFfc3RhcnQ7Cj4gQEAgLTUx
OSw3ICs1MTksNyBAQCBzdGF0aWMgdm9pZCB2bHZfZ2V0X2ZpZm9fc2l6ZShzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIAlmaWZvX3N0YXRlLT5wbGFuZVtQTEFORV9DVVJT
T1JdID0gNjM7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGludCBpOXh4X2dldF9maWZvX3NpemUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgaW50IGk5eHhfZ2V0X2Zp
Zm9fc2l6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgIGVudW0g
aTl4eF9wbGFuZV9pZCBpOXh4X3BsYW5lKQo+ICAgewo+ICAgCXUzMiBkc3BhcmIgPSBJOTE1X1JF
QUQoRFNQQVJCKTsKPiBAQCAtNTM1LDcgKzUzNSw3IEBAIHN0YXRpYyBpbnQgaTl4eF9nZXRfZmlm
b19zaXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlyZXR1cm4gc2l6
ZTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgaW50IGk4MzBfZ2V0X2ZpZm9fc2l6ZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBpbnQgaTgzMF9nZXRfZmlmb19zaXpl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgICAgZW51bSBpOXh4X3Bs
YW5lX2lkIGk5eHhfcGxhbmUpCj4gICB7Cj4gICAJdTMyIGRzcGFyYiA9IEk5MTVfUkVBRChEU1BB
UkIpOwo+IEBAIC01NTIsNyArNTUyLDcgQEAgc3RhdGljIGludCBpODMwX2dldF9maWZvX3NpemUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCXJldHVybiBzaXplOwo+ICAg
fQo+ICAgCj4gLXN0YXRpYyBpbnQgaTg0NV9nZXRfZmlmb19zaXplKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIGludCBpODQ1X2dldF9maWZvX3NpemUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICAgICBlbnVtIGk5eHhfcGxhbmVfaWQg
aTl4eF9wbGFuZSkKPiAgIHsKPiAgIAl1MzIgZHNwYXJiID0gSTkxNV9SRUFEKERTUEFSQik7Cj4g
QEAgLTgwNSw5ICs4MDUsOSBAQCBzdGF0aWMgYm9vbCBpc19lbmFibGluZyhpbnQgb2xkLCBpbnQg
bmV3LCBpbnQgdGhyZXNob2xkKQo+ICAgCXJldHVybiBvbGQgPCB0aHJlc2hvbGQgJiYgbmV3ID49
IHRocmVzaG9sZDsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgaW50IGludGVsX3dtX251bV9sZXZlbHMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgaW50IGludGVsX3dt
X251bV9sZXZlbHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlyZXR1
cm4gZGV2X3ByaXYtPndtLm1heF9sZXZlbCArIDE7Cj4gKwlyZXR1cm4gaTkxNS0+d20ubWF4X2xl
dmVsICsgMTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGJvb2wgaW50ZWxfd21fcGxhbmVfdmlzaWJs
ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiBAQCAtODMzLDEx
ICs4MzMsMTEgQEAgc3RhdGljIGJvb2wgaW50ZWxfd21fcGxhbmVfdmlzaWJsZShjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJcmV0dXJuIHBsYW5lX3N0YXRl
LT5iYXNlLnZpc2libGU7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHN0cnVjdCBpbnRlbF9jcnRjICpz
aW5nbGVfZW5hYmxlZF9jcnRjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAr
c3RhdGljIHN0cnVjdCBpbnRlbF9jcnRjICpzaW5nbGVfZW5hYmxlZF9jcnRjKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLCAq
ZW5hYmxlZCA9IE5VTEw7Cj4gICAKPiAtCWZvcl9lYWNoX2ludGVsX2NydGMoJmRldl9wcml2LT5k
cm0sIGNydGMpIHsKPiArCWZvcl9lYWNoX2ludGVsX2NydGMoJmk5MTUtPmRybSwgY3J0Yykgewo+
ICAgCQlpZiAoaW50ZWxfY3J0Y19hY3RpdmUoY3J0YykpIHsKPiAgIAkJCWlmIChlbmFibGVkKQo+
ICAgCQkJCXJldHVybiBOVUxMOwo+IEBAIC04NTAsMjMgKzg1MCwyMyBAQCBzdGF0aWMgc3RydWN0
IGludGVsX2NydGMgKnNpbmdsZV9lbmFibGVkX2NydGMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICAgCj4gICBzdGF0aWMgdm9pZCBwaW5ldmlld191cGRhdGVfd20oc3RydWN0
IGludGVsX2NydGMgKnVudXNlZF9jcnRjKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNSh1bnVzZWRfY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KHVudXNlZF9jcnRjLT5iYXNlLmRldik7
Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4gICAJY29uc3Qgc3RydWN0IGN4c3JfbGF0
ZW5jeSAqbGF0ZW5jeTsKPiAgIAl1MzIgcmVnOwo+ICAgCXVuc2lnbmVkIGludCB3bTsKPiAgIAo+
IC0JbGF0ZW5jeSA9IGludGVsX2dldF9jeHNyX2xhdGVuY3koIUlTX01PQklMRShkZXZfcHJpdiks
Cj4gLQkJCQkJIGRldl9wcml2LT5pc19kZHIzLAo+IC0JCQkJCSBkZXZfcHJpdi0+ZnNiX2ZyZXEs
Cj4gLQkJCQkJIGRldl9wcml2LT5tZW1fZnJlcSk7Cj4gKwlsYXRlbmN5ID0gaW50ZWxfZ2V0X2N4
c3JfbGF0ZW5jeSghSVNfTU9CSUxFKGk5MTUpLAo+ICsJCQkJCSBpOTE1LT5pc19kZHIzLAo+ICsJ
CQkJCSBpOTE1LT5mc2JfZnJlcSwKPiArCQkJCQkgaTkxNS0+bWVtX2ZyZXEpOwo+ICAgCWlmICgh
bGF0ZW5jeSkgewo+ICAgCQlEUk1fREVCVUdfS01TKCJVbmtub3duIEZTQi9NRU0gZm91bmQsIGRp
c2FibGUgQ3hTUlxuIik7Cj4gLQkJaW50ZWxfc2V0X21lbW9yeV9jeHNyKGRldl9wcml2LCBmYWxz
ZSk7Cj4gKwkJaW50ZWxfc2V0X21lbW9yeV9jeHNyKGk5MTUsIGZhbHNlKTsKPiAgIAkJcmV0dXJu
Owo+ICAgCX0KPiAgIAo+IC0JY3J0YyA9IHNpbmdsZV9lbmFibGVkX2NydGMoZGV2X3ByaXYpOwo+
ICsJY3J0YyA9IHNpbmdsZV9lbmFibGVkX2NydGMoaTkxNSk7Cj4gICAJaWYgKGNydGMpIHsKPiAg
IAkJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+ICAgCQkJ
JmNydGMtPmNvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+IEBAIC05MTMsOSArOTEzLDkgQEAg
c3RhdGljIHZvaWQgcGluZXZpZXdfdXBkYXRlX3dtKHN0cnVjdCBpbnRlbF9jcnRjICp1bnVzZWRf
Y3J0YykKPiAgIAkJSTkxNV9XUklURShEU1BGVzMsIHJlZyk7Cj4gICAJCURSTV9ERUJVR19LTVMo
IkRTUEZXMyByZWdpc3RlciBpcyAleFxuIiwgcmVnKTsKPiAgIAo+IC0JCWludGVsX3NldF9tZW1v
cnlfY3hzcihkZXZfcHJpdiwgdHJ1ZSk7Cj4gKwkJaW50ZWxfc2V0X21lbW9yeV9jeHNyKGk5MTUs
IHRydWUpOwo+ICAgCX0gZWxzZSB7Cj4gLQkJaW50ZWxfc2V0X21lbW9yeV9jeHNyKGRldl9wcml2
LCBmYWxzZSk7Cj4gKwkJaW50ZWxfc2V0X21lbW9yeV9jeHNyKGk5MTUsIGZhbHNlKTsKPiAgIAl9
Cj4gICB9Cj4gICAKPiBAQCAtOTM2LDEzICs5MzYsMTMgQEAgc3RhdGljIHVuc2lnbmVkIGludCBn
NHhfdGxiX21pc3Nfd2EoaW50IGZpZm9fc2l6ZSwgaW50IHdpZHRoLCBpbnQgY3BwKQo+ICAgCXJl
dHVybiBtYXgoMCwgdGxiX21pc3MpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGc0eF93cml0
ZV93bV92YWx1ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMg
dm9pZCBnNHhfd3JpdGVfd21fdmFsdWVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+
ICAgCQkJCWNvbnN0IHN0cnVjdCBnNHhfd21fdmFsdWVzICp3bSkKPiAgIHsKPiAgIAllbnVtIHBp
cGUgcGlwZTsKPiAgIAo+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkKPiAtCQl0cmFj
ZV9nNHhfd20oaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIHBpcGUpLCB3bSk7Cj4g
Kwlmb3JfZWFjaF9waXBlKGk5MTUsIHBpcGUpCj4gKwkJdHJhY2VfZzR4X3dtKGludGVsX2dldF9j
cnRjX2Zvcl9waXBlKGk5MTUsIHBpcGUpLCB3bSk7Cj4gICAKPiAgIAlJOTE1X1dSSVRFKERTUEZX
MSwKPiAgIAkJICAgRldfV00od20tPnNyLnBsYW5lLCBTUikgfAo+IEBAIC05NjgsMTMgKzk2OCwx
MyBAQCBzdGF0aWMgdm9pZCBnNHhfd3JpdGVfd21fdmFsdWVzKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiAgICNkZWZpbmUgRldfV01fVkxWKHZhbHVlLCBwbGFuZSkgXAo+ICAg
CSgoKHZhbHVlKSA8PCBEU1BGV18gIyMgcGxhbmUgIyMgX1NISUZUKSAmIERTUEZXXyAjIyBwbGFu
ZSAjIyBfTUFTS19WTFYpCj4gICAKPiAtc3RhdGljIHZvaWQgdmx2X3dyaXRlX3dtX3ZhbHVlcyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIHZsdl93cml0
ZV93bV92YWx1ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJY29uc3Qg
c3RydWN0IHZsdl93bV92YWx1ZXMgKndtKQo+ICAgewo+ICAgCWVudW0gcGlwZSBwaXBlOwo+ICAg
Cj4gLQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKSB7Cj4gLQkJdHJhY2Vfdmx2X3dtKGlu
dGVsX2dldF9jcnRjX2Zvcl9waXBlKGRldl9wcml2LCBwaXBlKSwgd20pOwo+ICsJZm9yX2VhY2hf
cGlwZShpOTE1LCBwaXBlKSB7Cj4gKwkJdHJhY2Vfdmx2X3dtKGludGVsX2dldF9jcnRjX2Zvcl9w
aXBlKGk5MTUsIHBpcGUpLCB3bSk7Cj4gICAKPiAgIAkJSTkxNV9XUklURShWTFZfRERMKHBpcGUp
LAo+ICAgCQkJICAgKHdtLT5kZGxbcGlwZV0ucGxhbmVbUExBTkVfQ1VSU09SXSA8PCBERExfQ1VS
U09SX1NISUZUKSB8Cj4gQEAgLTEwMDYsNyArMTAwNiw3IEBAIHN0YXRpYyB2b2lkIHZsdl93cml0
ZV93bV92YWx1ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCUk5MTVf
V1JJVEUoRFNQRlczLAo+ICAgCQkgICBGV19XTSh3bS0+c3IuY3Vyc29yLCBDVVJTT1JfU1IpKTsK
PiAgIAo+IC0JaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfQ0hFUlJZ
VklFVyhpOTE1KSkgewo+ICAgCQlJOTE1X1dSSVRFKERTUEZXN19DSFYsCj4gICAJCQkgICBGV19X
TV9WTFYod20tPnBpcGVbUElQRV9CXS5wbGFuZVtQTEFORV9TUFJJVEUxXSwgU1BSSVRFRCkgfAo+
ICAgCQkJICAgRldfV01fVkxWKHdtLT5waXBlW1BJUEVfQl0ucGxhbmVbUExBTkVfU1BSSVRFMF0s
IFNQUklURUMpKTsKPiBAQCAtMTA0NiwxNCArMTA0NiwxNCBAQCBzdGF0aWMgdm9pZCB2bHZfd3Jp
dGVfd21fdmFsdWVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAo+ICAg
I3VuZGVmIEZXX1dNX1ZMVgo+ICAgCj4gLXN0YXRpYyB2b2lkIGc0eF9zZXR1cF93bV9sYXRlbmN5
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgZzR4X3Nl
dHVwX3dtX2xhdGVuY3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJ
LyogYWxsIGxhdGVuY2llcyBpbiB1c2VjICovCj4gLQlkZXZfcHJpdi0+d20ucHJpX2xhdGVuY3lb
RzRYX1dNX0xFVkVMX05PUk1BTF0gPSA1Owo+IC0JZGV2X3ByaXYtPndtLnByaV9sYXRlbmN5W0c0
WF9XTV9MRVZFTF9TUl0gPSAxMjsKPiAtCWRldl9wcml2LT53bS5wcmlfbGF0ZW5jeVtHNFhfV01f
TEVWRUxfSFBMTF0gPSAzNTsKPiArCWk5MTUtPndtLnByaV9sYXRlbmN5W0c0WF9XTV9MRVZFTF9O
T1JNQUxdID0gNTsKPiArCWk5MTUtPndtLnByaV9sYXRlbmN5W0c0WF9XTV9MRVZFTF9TUl0gPSAx
MjsKPiArCWk5MTUtPndtLnByaV9sYXRlbmN5W0c0WF9XTV9MRVZFTF9IUExMXSA9IDM1Owo+ICAg
Cj4gLQlkZXZfcHJpdi0+d20ubWF4X2xldmVsID0gRzRYX1dNX0xFVkVMX0hQTEw7Cj4gKwlpOTE1
LT53bS5tYXhfbGV2ZWwgPSBHNFhfV01fTEVWRUxfSFBMTDsKPiAgIH0KPiAgIAo+ICAgc3RhdGlj
IGludCBnNHhfcGxhbmVfZmlmb19zaXplKGVudW0gcGxhbmVfaWQgcGxhbmVfaWQsIGludCBsZXZl
bCkKPiBAQCAtMTEwMywxMCArMTEwMywxMCBAQCBzdGF0aWMgdTE2IGc0eF9jb21wdXRlX3dtKGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCQkJICBpbnQgbGV2
ZWwpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSA9IHRvX2ludGVsX3BsYW5l
KHBsYW5lX3N0YXRlLT5iYXNlLnBsYW5lKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ICAgCWNvbnN0IHN0cnVj
dCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0KPiAgIAkJJmNydGNfc3RhdGUtPmJh
c2UuYWRqdXN0ZWRfbW9kZTsKPiAtCXVuc2lnbmVkIGludCBsYXRlbmN5ID0gZGV2X3ByaXYtPndt
LnByaV9sYXRlbmN5W2xldmVsXSAqIDEwOwo+ICsJdW5zaWduZWQgaW50IGxhdGVuY3kgPSBpOTE1
LT53bS5wcmlfbGF0ZW5jeVtsZXZlbF0gKiAxMDsKPiAgIAl1bnNpZ25lZCBpbnQgY2xvY2ssIGh0
b3RhbCwgY3BwLCB3aWR0aCwgd207Cj4gICAKPiAgIAlpZiAobGF0ZW5jeSA9PSAwKQo+IEBAIC0x
MTI2LDcgKzExMjYsNyBAQCBzdGF0aWMgdTE2IGc0eF9jb21wdXRlX3dtKGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCSAqIHRoZSBIUExMIHdhdGVybWFyaywg
d2hpY2ggc2VlbXMgYSBsaXR0bGUgc3RyYW5nZS4KPiAgIAkgKiBMZXQncyB1c2UgMzJicHAgZm9y
IHRoZSBIUExMIHdhdGVybWFyayBhcyB3ZWxsLgo+ICAgCSAqLwo+IC0JaWYgKElTX0dNNDUoZGV2
X3ByaXYpICYmIHBsYW5lLT5pZCA9PSBQTEFORV9QUklNQVJZICYmCj4gKwlpZiAoSVNfR000NShp
OTE1KSAmJiBwbGFuZS0+aWQgPT0gUExBTkVfUFJJTUFSWSAmJgo+ICAgCSAgICBsZXZlbCAhPSBH
NFhfV01fTEVWRUxfTk9STUFMKQo+ICAgCQljcHAgPSA0Owo+ICAgCWVsc2UKPiBAQCAtMTE2NSwx
MCArMTE2NSwxMCBAQCBzdGF0aWMgdTE2IGc0eF9jb21wdXRlX3dtKGNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgc3RhdGljIGJvb2wgZzR4X3Jhd19wbGFuZV93
bV9zZXQoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICAJCQkJIGludCBs
ZXZlbCwgZW51bSBwbGFuZV9pZCBwbGFuZV9pZCwgdTE2IHZhbHVlKQo+ICAgewo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNy
dGMtPmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0
Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICAgCWJvb2wgZGlydHkgPSBmYWxzZTsKPiAgIAo+
IC0JZm9yICg7IGxldmVsIDwgaW50ZWxfd21fbnVtX2xldmVscyhkZXZfcHJpdik7IGxldmVsKysp
IHsKPiArCWZvciAoOyBsZXZlbCA8IGludGVsX3dtX251bV9sZXZlbHMoaTkxNSk7IGxldmVsKysp
IHsKPiAgIAkJc3RydWN0IGc0eF9waXBlX3dtICpyYXcgPSAmY3J0Y19zdGF0ZS0+d20uZzR4LnJh
d1tsZXZlbF07Cj4gICAKPiAgIAkJZGlydHkgfD0gcmF3LT5wbGFuZVtwbGFuZV9pZF0gIT0gdmFs
dWU7Cj4gQEAgLTExODEsMTMgKzExODEsMTMgQEAgc3RhdGljIGJvb2wgZzR4X3Jhd19wbGFuZV93
bV9zZXQoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICBzdGF0aWMgYm9v
bCBnNHhfcmF3X2ZiY193bV9zZXQoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
Cj4gICAJCQkgICAgICAgaW50IGxldmVsLCB1MTYgdmFsdWUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+
ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjX3N0
YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gICAJYm9vbCBkaXJ0eSA9IGZhbHNlOwo+ICAgCj4gICAJ
LyogTk9STUFMIGxldmVsIGRvZXNuJ3QgaGF2ZSBhbiBGQkMgd2F0ZXJtYXJrICovCj4gICAJbGV2
ZWwgPSBtYXgobGV2ZWwsIEc0WF9XTV9MRVZFTF9TUik7Cj4gICAKPiAtCWZvciAoOyBsZXZlbCA8
IGludGVsX3dtX251bV9sZXZlbHMoZGV2X3ByaXYpOyBsZXZlbCsrKSB7Cj4gKwlmb3IgKDsgbGV2
ZWwgPCBpbnRlbF93bV9udW1fbGV2ZWxzKGk5MTUpOyBsZXZlbCsrKSB7Cj4gICAJCXN0cnVjdCBn
NHhfcGlwZV93bSAqcmF3ID0gJmNydGNfc3RhdGUtPndtLmc0eC5yYXdbbGV2ZWxdOwo+ICAgCj4g
ICAJCWRpcnR5IHw9IHJhdy0+ZmJjICE9IHZhbHVlOwo+IEBAIC0xMjgzLDkgKzEyODMsOSBAQCBz
dGF0aWMgYm9vbCBnNHhfcmF3X3BsYW5lX3dtX2lzX3ZhbGlkKGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgc3RhdGljIGJvb2wgZzR4X3Jhd19jcnRjX3dtX2lz
X3ZhbGlkKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCQkJ
CSAgICAgaW50IGxldmVsKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYp
Owo+ICAgCj4gLQlpZiAobGV2ZWwgPiBkZXZfcHJpdi0+d20ubWF4X2xldmVsKQo+ICsJaWYgKGxl
dmVsID4gaTkxNS0+d20ubWF4X2xldmVsKQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gICAKPiAgIAly
ZXR1cm4gZzR4X3Jhd19wbGFuZV93bV9pc192YWxpZChjcnRjX3N0YXRlLCBQTEFORV9QUklNQVJZ
LCBsZXZlbCkgJiYKPiBAQCAtMTQ4NCw3ICsxNDg0LDcgQEAgc3RhdGljIGludCBnNHhfY29tcHV0
ZV9pbnRlcm1lZGlhdGVfd20oc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRl
KQo+ICAgCXJldHVybiAwOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGc0eF9tZXJnZV93bShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGc0eF9tZXJn
ZV93bShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSBzdHJ1Y3QgZzR4X3dt
X3ZhbHVlcyAqd20pCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4gQEAgLTE0
OTQsNyArMTQ5NCw3IEBAIHN0YXRpYyB2b2lkIGc0eF9tZXJnZV93bShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJd20tPmhwbGxfZW4gPSB0cnVlOwo+ICAgCXdtLT5mYmNf
ZW4gPSB0cnVlOwo+ICAgCj4gLQlmb3JfZWFjaF9pbnRlbF9jcnRjKCZkZXZfcHJpdi0+ZHJtLCBj
cnRjKSB7Cj4gKwlmb3JfZWFjaF9pbnRlbF9jcnRjKCZpOTE1LT5kcm0sIGNydGMpIHsKPiAgIAkJ
Y29uc3Qgc3RydWN0IGc0eF93bV9zdGF0ZSAqd21fc3RhdGUgPSAmY3J0Yy0+d20uYWN0aXZlLmc0
eDsKPiAgIAo+ICAgCQlpZiAoIWNydGMtPmFjdGl2ZSkKPiBAQCAtMTUxNiw3ICsxNTE2LDcgQEAg
c3RhdGljIHZvaWQgZzR4X21lcmdlX3dtKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiAgIAkJd20tPmZiY19lbiA9IGZhbHNlOwo+ICAgCX0KPiAgIAo+IC0JZm9yX2VhY2hfaW50
ZWxfY3J0YygmZGV2X3ByaXYtPmRybSwgY3J0Yykgewo+ICsJZm9yX2VhY2hfaW50ZWxfY3J0Yygm
aTkxNS0+ZHJtLCBjcnRjKSB7Cj4gICAJCWNvbnN0IHN0cnVjdCBnNHhfd21fc3RhdGUgKndtX3N0
YXRlID0gJmNydGMtPndtLmFjdGl2ZS5nNHg7Cj4gICAJCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+
cGlwZTsKPiAgIAo+IEBAIC0xNTI4LDIzICsxNTI4LDIzIEBAIHN0YXRpYyB2b2lkIGc0eF9tZXJn
ZV93bShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJfQo+ICAgfQo+ICAg
Cj4gLXN0YXRpYyB2b2lkIGc0eF9wcm9ncmFtX3dhdGVybWFya3Moc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBnNHhfcHJvZ3JhbV93YXRlcm1hcmtzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RydWN0IGc0eF93bV92YWx1
ZXMgKm9sZF93bSA9ICZkZXZfcHJpdi0+d20uZzR4Owo+ICsJc3RydWN0IGc0eF93bV92YWx1ZXMg
Km9sZF93bSA9ICZpOTE1LT53bS5nNHg7Cj4gICAJc3RydWN0IGc0eF93bV92YWx1ZXMgbmV3X3dt
ID0ge307Cj4gICAKPiAtCWc0eF9tZXJnZV93bShkZXZfcHJpdiwgJm5ld193bSk7Cj4gKwlnNHhf
bWVyZ2Vfd20oaTkxNSwgJm5ld193bSk7Cj4gICAKPiAgIAlpZiAobWVtY21wKG9sZF93bSwgJm5l
d193bSwgc2l6ZW9mKG5ld193bSkpID09IDApCj4gICAJCXJldHVybjsKPiAgIAo+ICAgCWlmIChp
c19kaXNhYmxpbmcob2xkX3dtLT5jeHNyLCBuZXdfd20uY3hzciwgdHJ1ZSkpCj4gLQkJX2ludGVs
X3NldF9tZW1vcnlfY3hzcihkZXZfcHJpdiwgZmFsc2UpOwo+ICsJCV9pbnRlbF9zZXRfbWVtb3J5
X2N4c3IoaTkxNSwgZmFsc2UpOwo+ICAgCj4gLQlnNHhfd3JpdGVfd21fdmFsdWVzKGRldl9wcml2
LCAmbmV3X3dtKTsKPiArCWc0eF93cml0ZV93bV92YWx1ZXMoaTkxNSwgJm5ld193bSk7Cj4gICAK
PiAgIAlpZiAoaXNfZW5hYmxpbmcob2xkX3dtLT5jeHNyLCBuZXdfd20uY3hzciwgdHJ1ZSkpCj4g
LQkJX2ludGVsX3NldF9tZW1vcnlfY3hzcihkZXZfcHJpdiwgdHJ1ZSk7Cj4gKwkJX2ludGVsX3Nl
dF9tZW1vcnlfY3hzcihpOTE1LCB0cnVlKTsKPiAgIAo+ICAgCSpvbGRfd20gPSBuZXdfd207Cj4g
ICB9Cj4gQEAgLTE1NTIsMjggKzE1NTIsMjggQEAgc3RhdGljIHZvaWQgZzR4X3Byb2dyYW1fd2F0
ZXJtYXJrcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICBzdGF0aWMgdm9p
ZCBnNHhfaW5pdGlhbF93YXRlcm1hcmtzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRl
LAo+ICAgCQkJCSAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgewo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRl
LT5iYXNlLmNydGMtPmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICAgCj4gLQlt
dXRleF9sb2NrKCZkZXZfcHJpdi0+d20ud21fbXV0ZXgpOwo+ICsJbXV0ZXhfbG9jaygmaTkxNS0+
d20ud21fbXV0ZXgpOwo+ICAgCWNydGMtPndtLmFjdGl2ZS5nNHggPSBjcnRjX3N0YXRlLT53bS5n
NHguaW50ZXJtZWRpYXRlOwo+IC0JZzR4X3Byb2dyYW1fd2F0ZXJtYXJrcyhkZXZfcHJpdik7Cj4g
LQltdXRleF91bmxvY2soJmRldl9wcml2LT53bS53bV9tdXRleCk7Cj4gKwlnNHhfcHJvZ3JhbV93
YXRlcm1hcmtzKGk5MTUpOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT53bS53bV9tdXRleCk7Cj4g
ICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIGc0eF9vcHRpbWl6ZV93YXRlcm1hcmtzKHN0cnVjdCBp
bnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+ICAgCQkJCSAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2
KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0
Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAgIAo+ICAgCWlmICghY3J0Y19zdGF0ZS0+d20ubmVlZF9w
b3N0dmJsX3VwZGF0ZSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZfcHJp
di0+d20ud21fbXV0ZXgpOwo+ICsJbXV0ZXhfbG9jaygmaTkxNS0+d20ud21fbXV0ZXgpOwo+ICAg
CWludGVsX2NydGMtPndtLmFjdGl2ZS5nNHggPSBjcnRjX3N0YXRlLT53bS5nNHgub3B0aW1hbDsK
PiAtCWc0eF9wcm9ncmFtX3dhdGVybWFya3MoZGV2X3ByaXYpOwo+IC0JbXV0ZXhfdW5sb2NrKCZk
ZXZfcHJpdi0+d20ud21fbXV0ZXgpOwo+ICsJZzR4X3Byb2dyYW1fd2F0ZXJtYXJrcyhpOTE1KTsK
PiArCW11dGV4X3VubG9jaygmaTkxNS0+d20ud21fbXV0ZXgpOwo+ICAgfQo+ICAgCj4gICAvKiBs
YXRlbmN5IG11c3QgYmUgaW4gMC4xdXMgdW5pdHMuICovCj4gQEAgLTE1OTIsMTggKzE1OTIsMTgg
QEAgc3RhdGljIHVuc2lnbmVkIGludCB2bHZfd21fbWV0aG9kMih1bnNpZ25lZCBpbnQgcGl4ZWxf
cmF0ZSwKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIHZsdl9zZXR1
cF93bV9sYXRlbmN5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGlj
IHZvaWQgdmx2X3NldHVwX3dtX2xhdGVuY3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gICB7Cj4gICAJLyogYWxsIGxhdGVuY2llcyBpbiB1c2VjICovCj4gLQlkZXZfcHJpdi0+d20u
cHJpX2xhdGVuY3lbVkxWX1dNX0xFVkVMX1BNMl0gPSAzOwo+ICsJaTkxNS0+d20ucHJpX2xhdGVu
Y3lbVkxWX1dNX0xFVkVMX1BNMl0gPSAzOwo+ICAgCj4gLQlkZXZfcHJpdi0+d20ubWF4X2xldmVs
ID0gVkxWX1dNX0xFVkVMX1BNMjsKPiArCWk5MTUtPndtLm1heF9sZXZlbCA9IFZMVl9XTV9MRVZF
TF9QTTI7Cj4gICAKPiAtCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkgewo+IC0JCWRldl9w
cml2LT53bS5wcmlfbGF0ZW5jeVtWTFZfV01fTEVWRUxfUE01XSA9IDEyOwo+IC0JCWRldl9wcml2
LT53bS5wcmlfbGF0ZW5jeVtWTFZfV01fTEVWRUxfRERSX0RWRlNdID0gMzM7Cj4gKwlpZiAoSVNf
Q0hFUlJZVklFVyhpOTE1KSkgewo+ICsJCWk5MTUtPndtLnByaV9sYXRlbmN5W1ZMVl9XTV9MRVZF
TF9QTTVdID0gMTI7Cj4gKwkJaTkxNS0+d20ucHJpX2xhdGVuY3lbVkxWX1dNX0xFVkVMX0REUl9E
VkZTXSA9IDMzOwo+ICAgCj4gLQkJZGV2X3ByaXYtPndtLm1heF9sZXZlbCA9IFZMVl9XTV9MRVZF
TF9ERFJfRFZGUzsKPiArCQlpOTE1LT53bS5tYXhfbGV2ZWwgPSBWTFZfV01fTEVWRUxfRERSX0RW
RlM7Cj4gICAJfQo+ICAgfQo+ICAgCj4gQEAgLTE2MTIsMTIgKzE2MTIsMTIgQEAgc3RhdGljIHUx
NiB2bHZfY29tcHV0ZV93bV9sZXZlbChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSwKPiAgIAkJCQlpbnQgbGV2ZWwpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX3BsYW5l
ICpwbGFuZSA9IHRvX2ludGVsX3BsYW5lKHBsYW5lX3N0YXRlLT5iYXNlLnBsYW5lKTsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2
KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShwbGFuZS0+YmFz
ZS5kZXYpOwo+ICAgCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2Rl
ID0KPiAgIAkJJmNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPiAgIAl1bnNpZ25lZCBp
bnQgY2xvY2ssIGh0b3RhbCwgY3BwLCB3aWR0aCwgd207Cj4gICAKPiAtCWlmIChkZXZfcHJpdi0+
d20ucHJpX2xhdGVuY3lbbGV2ZWxdID09IDApCj4gKwlpZiAoaTkxNS0+d20ucHJpX2xhdGVuY3lb
bGV2ZWxdID09IDApCj4gICAJCXJldHVybiBVU0hSVF9NQVg7Cj4gICAKPiAgIAlpZiAoIWludGVs
X3dtX3BsYW5lX3Zpc2libGUoY3J0Y19zdGF0ZSwgcGxhbmVfc3RhdGUpKQo+IEBAIC0xNjM4LDcg
KzE2MzgsNyBAQCBzdGF0aWMgdTE2IHZsdl9jb21wdXRlX3dtX2xldmVsKGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCQl3bSA9IDYzOwo+ICAgCX0gZWxzZSB7
Cj4gICAJCXdtID0gdmx2X3dtX21ldGhvZDIoY2xvY2ssIGh0b3RhbCwgd2lkdGgsIGNwcCwKPiAt
CQkJCSAgICBkZXZfcHJpdi0+d20ucHJpX2xhdGVuY3lbbGV2ZWxdICogMTApOwo+ICsJCQkJICAg
IGk5MTUtPndtLnByaV9sYXRlbmN5W2xldmVsXSAqIDEwKTsKPiAgIAl9Cj4gICAKPiAgIAlyZXR1
cm4gbWluX3QodW5zaWduZWQgaW50LCB3bSwgVVNIUlRfTUFYKTsKPiBAQCAtMTczNiw5ICsxNzM2
LDkgQEAgc3RhdGljIGludCB2bHZfY29tcHV0ZV9maWZvKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlKQo+ICAgc3RhdGljIHZvaWQgdmx2X2ludmFsaWRhdGVfd21zKHN0cnVjdCBp
bnRlbF9jcnRjICpjcnRjLAo+ICAgCQkJICAgICAgIHN0cnVjdCB2bHZfd21fc3RhdGUgKndtX3N0
YXRlLCBpbnQgbGV2ZWwpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gICAKPiAtCWZvciAoOyBsZXZlbCA8
IGludGVsX3dtX251bV9sZXZlbHMoZGV2X3ByaXYpOyBsZXZlbCsrKSB7Cj4gKwlmb3IgKDsgbGV2
ZWwgPCBpbnRlbF93bV9udW1fbGV2ZWxzKGk5MTUpOyBsZXZlbCsrKSB7Cj4gICAJCWVudW0gcGxh
bmVfaWQgcGxhbmVfaWQ7Cj4gICAKPiAgIAkJZm9yX2VhY2hfcGxhbmVfaWRfb25fY3J0YyhjcnRj
LCBwbGFuZV9pZCkKPiBAQCAtMTc2NCw4ICsxNzY0LDggQEAgc3RhdGljIHUxNiB2bHZfaW52ZXJ0
X3dtX3ZhbHVlKHUxNiB3bSwgdTE2IGZpZm9fc2l6ZSkKPiAgIHN0YXRpYyBib29sIHZsdl9yYXdf
cGxhbmVfd21fc2V0KHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCQkJ
CSBpbnQgbGV2ZWwsIGVudW0gcGxhbmVfaWQgcGxhbmVfaWQsIHUxNiB2YWx1ZSkKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+
YmFzZS5jcnRjLT5kZXYpOwo+IC0JaW50IG51bV9sZXZlbHMgPSBpbnRlbF93bV9udW1fbGV2ZWxz
KGRldl9wcml2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShj
cnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gKwlpbnQgbnVtX2xldmVscyA9IGludGVsX3dt
X251bV9sZXZlbHMoaTkxNSk7Cj4gICAJYm9vbCBkaXJ0eSA9IGZhbHNlOwo+ICAgCj4gICAJZm9y
ICg7IGxldmVsIDwgbnVtX2xldmVsczsgbGV2ZWwrKykgewo+IEBAIC0xODQwLDcgKzE4NDAsNyBA
QCBzdGF0aWMgYm9vbCB2bHZfcmF3X2NydGNfd21faXNfdmFsaWQoY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICBzdGF0aWMgaW50IHZsdl9jb21wdXRlX3BpcGVf
d20oc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0
IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJh
c2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUgPQo+ICAg
CQl0b19pbnRlbF9hdG9taWNfc3RhdGUoY3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZSk7Cj4gICAJc3Ry
dWN0IHZsdl93bV9zdGF0ZSAqd21fc3RhdGUgPSAmY3J0Y19zdGF0ZS0+d20udmx2Lm9wdGltYWw7
Cj4gQEAgLTE4OTcsNyArMTg5Nyw3IEBAIHN0YXRpYyBpbnQgdmx2X2NvbXB1dGVfcGlwZV93bShz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIAl9Cj4gICAKPiAgIAkvKiBp
bml0aWFsbHkgYWxsb3cgYWxsIGxldmVscyAqLwo+IC0Jd21fc3RhdGUtPm51bV9sZXZlbHMgPSBp
bnRlbF93bV9udW1fbGV2ZWxzKGRldl9wcml2KTsKPiArCXdtX3N0YXRlLT5udW1fbGV2ZWxzID0g
aW50ZWxfd21fbnVtX2xldmVscyhpOTE1KTsKPiAgIAkvKgo+ICAgCSAqIE5vdGUgdGhhdCBlbmFi
bGluZyBjeHNyIHdpdGggbm8gcHJpbWFyeS9zcHJpdGUgcGxhbmVzCj4gICAJICogZW5hYmxlZCBj
YW4gd2VkZ2UgdGhlIHBpcGUuIEhlbmNlIHdlIG9ubHkgYWxsb3cgY3hzcgo+IEBAIC0xOTA3LDcg
KzE5MDcsNyBAQCBzdGF0aWMgaW50IHZsdl9jb21wdXRlX3BpcGVfd20oc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICAKPiAgIAlmb3IgKGxldmVsID0gMDsgbGV2ZWwgPCB3
bV9zdGF0ZS0+bnVtX2xldmVsczsgbGV2ZWwrKykgewo+ICAgCQljb25zdCBzdHJ1Y3QgZzR4X3Bp
cGVfd20gKnJhdyA9ICZjcnRjX3N0YXRlLT53bS52bHYucmF3W2xldmVsXTsKPiAtCQljb25zdCBp
bnQgc3JfZmlmb19zaXplID0gSU5URUxfSU5GTyhkZXZfcHJpdiktPm51bV9waXBlcyAqIDUxMiAt
IDE7Cj4gKwkJY29uc3QgaW50IHNyX2ZpZm9fc2l6ZSA9IElOVEVMX0lORk8oaTkxNSktPm51bV9w
aXBlcyAqIDUxMiAtIDE7Cj4gICAKPiAgIAkJaWYgKCF2bHZfcmF3X2NydGNfd21faXNfdmFsaWQo
Y3J0Y19zdGF0ZSwgbGV2ZWwpKQo+ICAgCQkJYnJlYWs7Cj4gQEAgLTE5NDgsOCArMTk0OCw4IEBA
IHN0YXRpYyB2b2lkIHZsdl9hdG9taWNfdXBkYXRlX2ZpZm8oc3RydWN0IGludGVsX2F0b21pY19z
dGF0ZSAqc3RhdGUsCj4gICAJCQkJICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNy
dGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAtCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVu
Y29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVu
Y29yZSA9ICZpOTE1LT51bmNvcmU7Cj4gICAJY29uc3Qgc3RydWN0IHZsdl9maWZvX3N0YXRlICpm
aWZvX3N0YXRlID0KPiAgIAkJJmNydGNfc3RhdGUtPndtLnZsdi5maWZvX3N0YXRlOwo+ICAgCWlu
dCBzcHJpdGUwX3N0YXJ0LCBzcHJpdGUxX3N0YXJ0LCBmaWZvX3NpemU7Cj4gQEAgLTIwOTIsMTYg
KzIwOTIsMTYgQEAgc3RhdGljIGludCB2bHZfY29tcHV0ZV9pbnRlcm1lZGlhdGVfd20oc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+ICAgCXJldHVybiAwOwo+ICAgfQo+
ICAgCj4gLXN0YXRpYyB2b2lkIHZsdl9tZXJnZV93bShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIHZsdl9tZXJnZV93bShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiAgIAkJCSBzdHJ1Y3Qgdmx2X3dtX3ZhbHVlcyAqd20pCj4gICB7Cj4gICAJ
c3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4gICAJaW50IG51bV9hY3RpdmVfY3J0Y3MgPSAwOwo+
ICAgCj4gLQl3bS0+bGV2ZWwgPSBkZXZfcHJpdi0+d20ubWF4X2xldmVsOwo+ICsJd20tPmxldmVs
ID0gaTkxNS0+d20ubWF4X2xldmVsOwo+ICAgCXdtLT5jeHNyID0gdHJ1ZTsKPiAgIAo+IC0JZm9y
X2VhY2hfaW50ZWxfY3J0YygmZGV2X3ByaXYtPmRybSwgY3J0Yykgewo+ICsJZm9yX2VhY2hfaW50
ZWxfY3J0YygmaTkxNS0+ZHJtLCBjcnRjKSB7Cj4gICAJCWNvbnN0IHN0cnVjdCB2bHZfd21fc3Rh
dGUgKndtX3N0YXRlID0gJmNydGMtPndtLmFjdGl2ZS52bHY7Cj4gICAKPiAgIAkJaWYgKCFjcnRj
LT5hY3RpdmUpCj4gQEAgLTIxMjAsNyArMjEyMCw3IEBAIHN0YXRpYyB2b2lkIHZsdl9tZXJnZV93
bShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJaWYgKG51bV9hY3RpdmVf
Y3J0Y3MgPiAxKQo+ICAgCQl3bS0+bGV2ZWwgPSBWTFZfV01fTEVWRUxfUE0yOwo+ICAgCj4gLQlm
b3JfZWFjaF9pbnRlbF9jcnRjKCZkZXZfcHJpdi0+ZHJtLCBjcnRjKSB7Cj4gKwlmb3JfZWFjaF9p
bnRlbF9jcnRjKCZpOTE1LT5kcm0sIGNydGMpIHsKPiAgIAkJY29uc3Qgc3RydWN0IHZsdl93bV9z
dGF0ZSAqd21fc3RhdGUgPSAmY3J0Yy0+d20uYWN0aXZlLnZsdjsKPiAgIAkJZW51bSBwaXBlIHBp
cGUgPSBjcnRjLT5waXBlOwo+ICAgCj4gQEAgLTIxMzUsMzUgKzIxMzUsMzUgQEAgc3RhdGljIHZv
aWQgdmx2X21lcmdlX3dtKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAl9
Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgdmx2X3Byb2dyYW1fd2F0ZXJtYXJrcyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIHZsdl9wcm9ncmFtX3dh
dGVybWFya3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3Qg
dmx2X3dtX3ZhbHVlcyAqb2xkX3dtID0gJmRldl9wcml2LT53bS52bHY7Cj4gKwlzdHJ1Y3Qgdmx2
X3dtX3ZhbHVlcyAqb2xkX3dtID0gJmk5MTUtPndtLnZsdjsKPiAgIAlzdHJ1Y3Qgdmx2X3dtX3Zh
bHVlcyBuZXdfd20gPSB7fTsKPiAgIAo+IC0Jdmx2X21lcmdlX3dtKGRldl9wcml2LCAmbmV3X3dt
KTsKPiArCXZsdl9tZXJnZV93bShpOTE1LCAmbmV3X3dtKTsKPiAgIAo+ICAgCWlmIChtZW1jbXAo
b2xkX3dtLCAmbmV3X3dtLCBzaXplb2YobmV3X3dtKSkgPT0gMCkKPiAgIAkJcmV0dXJuOwo+ICAg
Cj4gICAJaWYgKGlzX2Rpc2FibGluZyhvbGRfd20tPmxldmVsLCBuZXdfd20ubGV2ZWwsIFZMVl9X
TV9MRVZFTF9ERFJfRFZGUykpCj4gLQkJY2h2X3NldF9tZW1vcnlfZHZmcyhkZXZfcHJpdiwgZmFs
c2UpOwo+ICsJCWNodl9zZXRfbWVtb3J5X2R2ZnMoaTkxNSwgZmFsc2UpOwo+ICAgCj4gICAJaWYg
KGlzX2Rpc2FibGluZyhvbGRfd20tPmxldmVsLCBuZXdfd20ubGV2ZWwsIFZMVl9XTV9MRVZFTF9Q
TTUpKQo+IC0JCWNodl9zZXRfbWVtb3J5X3BtNShkZXZfcHJpdiwgZmFsc2UpOwo+ICsJCWNodl9z
ZXRfbWVtb3J5X3BtNShpOTE1LCBmYWxzZSk7Cj4gICAKPiAgIAlpZiAoaXNfZGlzYWJsaW5nKG9s
ZF93bS0+Y3hzciwgbmV3X3dtLmN4c3IsIHRydWUpKQo+IC0JCV9pbnRlbF9zZXRfbWVtb3J5X2N4
c3IoZGV2X3ByaXYsIGZhbHNlKTsKPiArCQlfaW50ZWxfc2V0X21lbW9yeV9jeHNyKGk5MTUsIGZh
bHNlKTsKPiAgIAo+IC0Jdmx2X3dyaXRlX3dtX3ZhbHVlcyhkZXZfcHJpdiwgJm5ld193bSk7Cj4g
Kwl2bHZfd3JpdGVfd21fdmFsdWVzKGk5MTUsICZuZXdfd20pOwo+ICAgCj4gICAJaWYgKGlzX2Vu
YWJsaW5nKG9sZF93bS0+Y3hzciwgbmV3X3dtLmN4c3IsIHRydWUpKQo+IC0JCV9pbnRlbF9zZXRf
bWVtb3J5X2N4c3IoZGV2X3ByaXYsIHRydWUpOwo+ICsJCV9pbnRlbF9zZXRfbWVtb3J5X2N4c3Io
aTkxNSwgdHJ1ZSk7Cj4gICAKPiAgIAlpZiAoaXNfZW5hYmxpbmcob2xkX3dtLT5sZXZlbCwgbmV3
X3dtLmxldmVsLCBWTFZfV01fTEVWRUxfUE01KSkKPiAtCQljaHZfc2V0X21lbW9yeV9wbTUoZGV2
X3ByaXYsIHRydWUpOwo+ICsJCWNodl9zZXRfbWVtb3J5X3BtNShpOTE1LCB0cnVlKTsKPiAgIAo+
ICAgCWlmIChpc19lbmFibGluZyhvbGRfd20tPmxldmVsLCBuZXdfd20ubGV2ZWwsIFZMVl9XTV9M
RVZFTF9ERFJfRFZGUykpCj4gLQkJY2h2X3NldF9tZW1vcnlfZHZmcyhkZXZfcHJpdiwgdHJ1ZSk7
Cj4gKwkJY2h2X3NldF9tZW1vcnlfZHZmcyhpOTE1LCB0cnVlKTsKPiAgIAo+ICAgCSpvbGRfd20g
PSBuZXdfd207Cj4gICB9Cj4gQEAgLTIxNzEsNDAgKzIxNzEsNDAgQEAgc3RhdGljIHZvaWQgdmx2
X3Byb2dyYW1fd2F0ZXJtYXJrcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
ICBzdGF0aWMgdm9pZCB2bHZfaW5pdGlhbF93YXRlcm1hcmtzKHN0cnVjdCBpbnRlbF9hdG9taWNf
c3RhdGUgKnN0YXRlLAo+ICAgCQkJCSAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICAgCXN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMp
Owo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+d20ud21fbXV0ZXgpOwo+ICsJbXV0ZXhf
bG9jaygmaTkxNS0+d20ud21fbXV0ZXgpOwo+ICAgCWNydGMtPndtLmFjdGl2ZS52bHYgPSBjcnRj
X3N0YXRlLT53bS52bHYuaW50ZXJtZWRpYXRlOwo+IC0Jdmx2X3Byb2dyYW1fd2F0ZXJtYXJrcyhk
ZXZfcHJpdik7Cj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT53bS53bV9tdXRleCk7Cj4gKwl2
bHZfcHJvZ3JhbV93YXRlcm1hcmtzKGk5MTUpOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT53bS53
bV9tdXRleCk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIHZsdl9vcHRpbWl6ZV93YXRlcm1h
cmtzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+ICAgCQkJCSAgICBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJh
c2UuY3J0Yy0+ZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2lu
dGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAgIAo+ICAgCWlmICghY3J0Y19zdGF0
ZS0+d20ubmVlZF9wb3N0dmJsX3VwZGF0ZSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQltdXRleF9s
b2NrKCZkZXZfcHJpdi0+d20ud21fbXV0ZXgpOwo+ICsJbXV0ZXhfbG9jaygmaTkxNS0+d20ud21f
bXV0ZXgpOwo+ICAgCWludGVsX2NydGMtPndtLmFjdGl2ZS52bHYgPSBjcnRjX3N0YXRlLT53bS52
bHYub3B0aW1hbDsKPiAtCXZsdl9wcm9ncmFtX3dhdGVybWFya3MoZGV2X3ByaXYpOwo+IC0JbXV0
ZXhfdW5sb2NrKCZkZXZfcHJpdi0+d20ud21fbXV0ZXgpOwo+ICsJdmx2X3Byb2dyYW1fd2F0ZXJt
YXJrcyhpOTE1KTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+d20ud21fbXV0ZXgpOwo+ICAgfQo+
ICAgCj4gICBzdGF0aWMgdm9pZCBpOTY1X3VwZGF0ZV93bShzdHJ1Y3QgaW50ZWxfY3J0YyAqdW51
c2VkX2NydGMpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KHVudXNlZF9jcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUodW51c2VkX2NydGMtPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YzsKPiAgIAlpbnQgc3J3bSA9IDE7Cj4gICAJaW50IGN1cnNvcl9zciA9IDE2
Owo+ICAgCWJvb2wgY3hzcl9lbmFibGVkOwo+ICAgCj4gICAJLyogQ2FsYyBzciBlbnRyaWVzIGZv
ciBvbmUgcGxhbmUgY29uZmlncyAqLwo+IC0JY3J0YyA9IHNpbmdsZV9lbmFibGVkX2NydGMoZGV2
X3ByaXYpOwo+ICsJY3J0YyA9IHNpbmdsZV9lbmFibGVkX2NydGMoaTkxNSk7Cj4gICAJaWYgKGNy
dGMpIHsKPiAgIAkJLyogc2VsZi1yZWZyZXNoIGhhcyBtdWNoIGhpZ2hlciBsYXRlbmN5ICovCj4g
ICAJCXN0YXRpYyBjb25zdCBpbnQgc3JfbGF0ZW5jeV9ucyA9IDEyMDAwOwo+IEBAIC0yMjQ2LDcg
KzIyNDYsNyBAQCBzdGF0aWMgdm9pZCBpOTY1X3VwZGF0ZV93bShzdHJ1Y3QgaW50ZWxfY3J0YyAq
dW51c2VkX2NydGMpCj4gICAJfSBlbHNlIHsKPiAgIAkJY3hzcl9lbmFibGVkID0gZmFsc2U7Cj4g
ICAJCS8qIFR1cm4gb2ZmIHNlbGYgcmVmcmVzaCBpZiBib3RoIHBpcGVzIGFyZSBlbmFibGVkICov
Cj4gLQkJaW50ZWxfc2V0X21lbW9yeV9jeHNyKGRldl9wcml2LCBmYWxzZSk7Cj4gKwkJaW50ZWxf
c2V0X21lbW9yeV9jeHNyKGk5MTUsIGZhbHNlKTsKPiAgIAl9Cj4gICAKPiAgIAlEUk1fREVCVUdf
S01TKCJTZXR0aW5nIEZJRk8gd2F0ZXJtYXJrcyAtIEE6IDgsIEI6IDgsIEM6IDgsIFNSICVkXG4i
LAo+IEBAIC0yMjYzLDE0ICsyMjYzLDE0IEBAIHN0YXRpYyB2b2lkIGk5NjVfdXBkYXRlX3dtKHN0
cnVjdCBpbnRlbF9jcnRjICp1bnVzZWRfY3J0YykKPiAgIAlJOTE1X1dSSVRFKERTUEZXMywgRldf
V00oY3Vyc29yX3NyLCBDVVJTT1JfU1IpKTsKPiAgIAo+ICAgCWlmIChjeHNyX2VuYWJsZWQpCj4g
LQkJaW50ZWxfc2V0X21lbW9yeV9jeHNyKGRldl9wcml2LCB0cnVlKTsKPiArCQlpbnRlbF9zZXRf
bWVtb3J5X2N4c3IoaTkxNSwgdHJ1ZSk7Cj4gICB9Cj4gICAKPiAgICN1bmRlZiBGV19XTQo+ICAg
Cj4gICBzdGF0aWMgdm9pZCBpOXh4X3VwZGF0ZV93bShzdHJ1Y3QgaW50ZWxfY3J0YyAqdW51c2Vk
X2NydGMpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KHVudXNlZF9jcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUodW51c2VkX2NydGMtPmJhc2UuZGV2KTsKPiAgIAljb25zdCBzdHJ1Y3Qg
aW50ZWxfd2F0ZXJtYXJrX3BhcmFtcyAqd21faW5mbzsKPiAgIAl1MzIgZndhdGVyX2xvOwo+ICAg
CXUzMiBmd2F0ZXJfaGk7Cj4gQEAgLTIyNzksMTUgKzIyNzksMTUgQEAgc3RhdGljIHZvaWQgaTl4
eF91cGRhdGVfd20oc3RydWN0IGludGVsX2NydGMgKnVudXNlZF9jcnRjKQo+ICAgCWludCBwbGFu
ZWFfd20sIHBsYW5lYl93bTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywgKmVuYWJsZWQg
PSBOVUxMOwo+ICAgCj4gLQlpZiAoSVNfSTk0NUdNKGRldl9wcml2KSkKPiArCWlmIChJU19JOTQ1
R00oaTkxNSkpCj4gICAJCXdtX2luZm8gPSAmaTk0NV93bV9pbmZvOwo+IC0JZWxzZSBpZiAoIUlT
X0dFTihkZXZfcHJpdiwgMikpCj4gKwllbHNlIGlmICghSVNfR0VOKGk5MTUsIDIpKQo+ICAgCQl3
bV9pbmZvID0gJmk5MTVfd21faW5mbzsKPiAgIAllbHNlCj4gICAJCXdtX2luZm8gPSAmaTgzMF9h
X3dtX2luZm87Cj4gICAKPiAtCWZpZm9fc2l6ZSA9IGRldl9wcml2LT5kaXNwbGF5LmdldF9maWZv
X3NpemUoZGV2X3ByaXYsIFBMQU5FX0EpOwo+IC0JY3J0YyA9IGludGVsX2dldF9jcnRjX2Zvcl9w
bGFuZShkZXZfcHJpdiwgUExBTkVfQSk7Cj4gKwlmaWZvX3NpemUgPSBpOTE1LT5kaXNwbGF5Lmdl
dF9maWZvX3NpemUoaTkxNSwgUExBTkVfQSk7Cj4gKwljcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9y
X3BsYW5lKGk5MTUsIFBMQU5FX0EpOwo+ICAgCWlmIChpbnRlbF9jcnRjX2FjdGl2ZShjcnRjKSkg
ewo+ICAgCQljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9Cj4g
ICAJCQkmY3J0Yy0+Y29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gQEAgLTIyOTUsNyArMjI5
NSw3IEBAIHN0YXRpYyB2b2lkIGk5eHhfdXBkYXRlX3dtKHN0cnVjdCBpbnRlbF9jcnRjICp1bnVz
ZWRfY3J0YykKPiAgIAkJCWNydGMtPmJhc2UucHJpbWFyeS0+c3RhdGUtPmZiOwo+ICAgCQlpbnQg
Y3BwOwo+ICAgCj4gLQkJaWYgKElTX0dFTihkZXZfcHJpdiwgMikpCj4gKwkJaWYgKElTX0dFTihp
OTE1LCAyKSkKPiAgIAkJCWNwcCA9IDQ7Cj4gICAJCWVsc2UKPiAgIAkJCWNwcCA9IGZiLT5mb3Jt
YXQtPmNwcFswXTsKPiBAQCAtMjMxMCwxMSArMjMxMCwxMSBAQCBzdGF0aWMgdm9pZCBpOXh4X3Vw
ZGF0ZV93bShzdHJ1Y3QgaW50ZWxfY3J0YyAqdW51c2VkX2NydGMpCj4gICAJCQlwbGFuZWFfd20g
PSB3bV9pbmZvLT5tYXhfd207Cj4gICAJfQo+ICAgCj4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCAy
KSkKPiArCWlmIChJU19HRU4oaTkxNSwgMikpCj4gICAJCXdtX2luZm8gPSAmaTgzMF9iY193bV9p
bmZvOwo+ICAgCj4gLQlmaWZvX3NpemUgPSBkZXZfcHJpdi0+ZGlzcGxheS5nZXRfZmlmb19zaXpl
KGRldl9wcml2LCBQTEFORV9CKTsKPiAtCWNydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3JfcGxhbmUo
ZGV2X3ByaXYsIFBMQU5FX0IpOwo+ICsJZmlmb19zaXplID0gaTkxNS0+ZGlzcGxheS5nZXRfZmlm
b19zaXplKGk5MTUsIFBMQU5FX0IpOwo+ICsJY3J0YyA9IGludGVsX2dldF9jcnRjX2Zvcl9wbGFu
ZShpOTE1LCBQTEFORV9CKTsKPiAgIAlpZiAoaW50ZWxfY3J0Y19hY3RpdmUoY3J0YykpIHsKPiAg
IAkJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+ICAgCQkJ
JmNydGMtPmNvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+IEBAIC0yMzIyLDcgKzIzMjIsNyBA
QCBzdGF0aWMgdm9pZCBpOXh4X3VwZGF0ZV93bShzdHJ1Y3QgaW50ZWxfY3J0YyAqdW51c2VkX2Ny
dGMpCj4gICAJCQljcnRjLT5iYXNlLnByaW1hcnktPnN0YXRlLT5mYjsKPiAgIAkJaW50IGNwcDsK
PiAgIAo+IC0JCWlmIChJU19HRU4oZGV2X3ByaXYsIDIpKQo+ICsJCWlmIChJU19HRU4oaTkxNSwg
MikpCj4gICAJCQljcHAgPSA0Owo+ICAgCQllbHNlCj4gICAJCQljcHAgPSBmYi0+Zm9ybWF0LT5j
cHBbMF07Cj4gQEAgLTIzNDIsNyArMjM0Miw3IEBAIHN0YXRpYyB2b2lkIGk5eHhfdXBkYXRlX3dt
KHN0cnVjdCBpbnRlbF9jcnRjICp1bnVzZWRfY3J0YykKPiAgIAo+ICAgCURSTV9ERUJVR19LTVMo
IkZJRk8gd2F0ZXJtYXJrcyAtIEE6ICVkLCBCOiAlZFxuIiwgcGxhbmVhX3dtLCBwbGFuZWJfd20p
Owo+ICAgCj4gLQlpZiAoSVNfSTkxNUdNKGRldl9wcml2KSAmJiBlbmFibGVkKSB7Cj4gKwlpZiAo
SVNfSTkxNUdNKGk5MTUpICYmIGVuYWJsZWQpIHsKPiAgIAkJc3RydWN0IGRybV9pOTE1X2dlbV9v
YmplY3QgKm9iajsKPiAgIAo+ICAgCQlvYmogPSBpbnRlbF9mYl9vYmooZW5hYmxlZC0+YmFzZS5w
cmltYXJ5LT5zdGF0ZS0+ZmIpOwo+IEBAIC0yMzU4LDEwICsyMzU4LDEwIEBAIHN0YXRpYyB2b2lk
IGk5eHhfdXBkYXRlX3dtKHN0cnVjdCBpbnRlbF9jcnRjICp1bnVzZWRfY3J0YykKPiAgIAljd20g
PSAyOwo+ICAgCj4gICAJLyogUGxheSBzYWZlIGFuZCBkaXNhYmxlIHNlbGYtcmVmcmVzaCBiZWZv
cmUgYWRqdXN0aW5nIHdhdGVybWFya3MuICovCj4gLQlpbnRlbF9zZXRfbWVtb3J5X2N4c3IoZGV2
X3ByaXYsIGZhbHNlKTsKPiArCWludGVsX3NldF9tZW1vcnlfY3hzcihpOTE1LCBmYWxzZSk7Cj4g
ICAKPiAgIAkvKiBDYWxjIHNyIGVudHJpZXMgZm9yIG9uZSBwbGFuZSBjb25maWdzICovCj4gLQlp
ZiAoSEFTX0ZXX0JMQyhkZXZfcHJpdikgJiYgZW5hYmxlZCkgewo+ICsJaWYgKEhBU19GV19CTEMo
aTkxNSkgJiYgZW5hYmxlZCkgewo+ICAgCQkvKiBzZWxmLXJlZnJlc2ggaGFzIG11Y2ggaGlnaGVy
IGxhdGVuY3kgKi8KPiAgIAkJc3RhdGljIGNvbnN0IGludCBzcl9sYXRlbmN5X25zID0gNjAwMDsK
PiAgIAkJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+IEBA
IC0yMzc0LDcgKzIzNzQsNyBAQCBzdGF0aWMgdm9pZCBpOXh4X3VwZGF0ZV93bShzdHJ1Y3QgaW50
ZWxfY3J0YyAqdW51c2VkX2NydGMpCj4gICAJCWludCBjcHA7Cj4gICAJCWludCBlbnRyaWVzOwo+
ICAgCj4gLQkJaWYgKElTX0k5MTVHTShkZXZfcHJpdikgfHwgSVNfSTk0NUdNKGRldl9wcml2KSkK
PiArCQlpZiAoSVNfSTkxNUdNKGk5MTUpIHx8IElTX0k5NDVHTShpOTE1KSkKPiAgIAkJCWNwcCA9
IDQ7Cj4gICAJCWVsc2UKPiAgIAkJCWNwcCA9IGZiLT5mb3JtYXQtPmNwcFswXTsKPiBAQCAtMjM4
Nyw3ICsyMzg3LDcgQEAgc3RhdGljIHZvaWQgaTl4eF91cGRhdGVfd20oc3RydWN0IGludGVsX2Ny
dGMgKnVudXNlZF9jcnRjKQo+ICAgCQlpZiAoc3J3bSA8IDApCj4gICAJCQlzcndtID0gMTsKPiAg
IAo+IC0JCWlmIChJU19JOTQ1RyhkZXZfcHJpdikgfHwgSVNfSTk0NUdNKGRldl9wcml2KSkKPiAr
CQlpZiAoSVNfSTk0NUcoaTkxNSkgfHwgSVNfSTk0NUdNKGk5MTUpKQo+ICAgCQkJSTkxNV9XUklU
RShGV19CTENfU0VMRiwKPiAgIAkJCQkgICBGV19CTENfU0VMRl9GSUZPX01BU0sgfCAoc3J3bSAm
IDB4ZmYpKTsKPiAgIAkJZWxzZQo+IEBAIC0yNDA4LDI1ICsyNDA4LDI1IEBAIHN0YXRpYyB2b2lk
IGk5eHhfdXBkYXRlX3dtKHN0cnVjdCBpbnRlbF9jcnRjICp1bnVzZWRfY3J0YykKPiAgIAlJOTE1
X1dSSVRFKEZXX0JMQzIsIGZ3YXRlcl9oaSk7Cj4gICAKPiAgIAlpZiAoZW5hYmxlZCkKPiAtCQlp
bnRlbF9zZXRfbWVtb3J5X2N4c3IoZGV2X3ByaXYsIHRydWUpOwo+ICsJCWludGVsX3NldF9tZW1v
cnlfY3hzcihpOTE1LCB0cnVlKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgaTg0NV91cGRh
dGVfd20oc3RydWN0IGludGVsX2NydGMgKnVudXNlZF9jcnRjKQo+ICAgewo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNSh1bnVzZWRfY3J0Yy0+YmFzZS5kZXYp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KHVudXNlZF9jcnRj
LT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4gICAJY29uc3Qgc3Ry
dWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGU7Cj4gICAJdTMyIGZ3YXRlcl9sbzsK
PiAgIAlpbnQgcGxhbmVhX3dtOwo+ICAgCj4gLQljcnRjID0gc2luZ2xlX2VuYWJsZWRfY3J0Yyhk
ZXZfcHJpdik7Cj4gKwljcnRjID0gc2luZ2xlX2VuYWJsZWRfY3J0YyhpOTE1KTsKPiAgIAlpZiAo
Y3J0YyA9PSBOVUxMKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAlhZGp1c3RlZF9tb2RlID0gJmNy
dGMtPmNvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICAgCXBsYW5lYV93bSA9IGludGVsX2Nh
bGN1bGF0ZV93bShhZGp1c3RlZF9tb2RlLT5jcnRjX2Nsb2NrLAo+ICAgCQkJCSAgICAgICAmaTg0
NV93bV9pbmZvLAo+IC0JCQkJICAgICAgIGRldl9wcml2LT5kaXNwbGF5LmdldF9maWZvX3NpemUo
ZGV2X3ByaXYsIFBMQU5FX0EpLAo+ICsJCQkJICAgICAgIGk5MTUtPmRpc3BsYXkuZ2V0X2ZpZm9f
c2l6ZShpOTE1LCBQTEFORV9BKSwKPiAgIAkJCQkgICAgICAgNCwgcGVzc2ltYWxfbGF0ZW5jeV9u
cyk7Cj4gICAJZndhdGVyX2xvID0gSTkxNV9SRUFEKEZXX0JMQykgJiB+MHhmZmY7Cj4gICAJZndh
dGVyX2xvIHw9ICgzPDw4KSB8IHBsYW5lYV93bTsKPiBAQCAtMjU4NiwyNCArMjU4NiwyNCBAQCBz
dGF0aWMgdTMyIGlsa19jb21wdXRlX2ZiY193bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3N0YXRlLAo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdW5zaWduZWQgaW50Cj4gLWlsa19kaXNw
bGF5X2ZpZm9fc2l6ZShjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
K2lsa19kaXNwbGF5X2ZpZm9fc2l6ZShjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiAgIHsKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDgpCj4gKwlpZiAoSU5URUxf
R0VOKGk5MTUpID49IDgpCj4gICAJCXJldHVybiAzMDcyOwo+IC0JZWxzZSBpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSA3KQo+ICsJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDcpCj4gICAJ
CXJldHVybiA3Njg7Cj4gICAJZWxzZQo+ICAgCQlyZXR1cm4gNTEyOwo+ICAgfQo+ICAgCj4gICBz
dGF0aWMgdW5zaWduZWQgaW50Cj4gLWlsa19wbGFuZV93bV9yZWdfbWF4KGNvbnN0IHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAraWxrX3BsYW5lX3dtX3JlZ19tYXgoY29uc3Qg
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCSAgICAgaW50IGxldmVsLCBib29s
IGlzX3Nwcml0ZSkKPiAgIHsKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDgpCj4gKwlp
ZiAoSU5URUxfR0VOKGk5MTUpID49IDgpCj4gICAJCS8qIEJEVyBwcmltYXJ5L3Nwcml0ZSBwbGFu
ZSB3YXRlcm1hcmtzICovCj4gICAJCXJldHVybiBsZXZlbCA9PSAwID8gMjU1IDogMjA0NzsKPiAt
CWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNykKPiArCWVsc2UgaWYgKElOVEVMX0dF
TihpOTE1KSA+PSA3KQo+ICAgCQkvKiBJVkIvSFNXIHByaW1hcnkvc3ByaXRlIHBsYW5lIHdhdGVy
bWFya3MgKi8KPiAgIAkJcmV0dXJuIGxldmVsID09IDAgPyAxMjcgOiAxMDIzOwo+ICAgCWVsc2Ug
aWYgKCFpc19zcHJpdGUpCj4gQEAgLTI2MTUsMzAgKzI2MTUsMzAgQEAgaWxrX3BsYW5lX3dtX3Jl
Z19tYXgoY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgfQo+ICAg
Cj4gICBzdGF0aWMgdW5zaWduZWQgaW50Cj4gLWlsa19jdXJzb3Jfd21fcmVnX21heChjb25zdCBz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCBsZXZlbCkKPiAraWxrX2N1cnNv
cl93bV9yZWdfbWF4KGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBpbnQgbGV2
ZWwpCj4gICB7Cj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA3KQo+ICsJaWYgKElOVEVM
X0dFTihpOTE1KSA+PSA3KQo+ICAgCQlyZXR1cm4gbGV2ZWwgPT0gMCA/IDYzIDogMjU1Owo+ICAg
CWVsc2UKPiAgIAkJcmV0dXJuIGxldmVsID09IDAgPyAzMSA6IDYzOwo+ICAgfQo+ICAgCj4gLXN0
YXRpYyB1bnNpZ25lZCBpbnQgaWxrX2ZiY193bV9yZWdfbWF4KGNvbnN0IHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHVuc2lnbmVkIGludCBpbGtfZmJjX3dtX3Jl
Z19tYXgoY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlpZiAo
SU5URUxfR0VOKGRldl9wcml2KSA+PSA4KQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA4KQo+
ICAgCQlyZXR1cm4gMzE7Cj4gICAJZWxzZQo+ICAgCQlyZXR1cm4gMTU7Cj4gICB9Cj4gICAKPiAg
IC8qIENhbGN1bGF0ZSB0aGUgbWF4aW11bSBwcmltYXJ5L3Nwcml0ZSBwbGFuZSB3YXRlcm1hcmsg
Ki8KPiAtc3RhdGljIHVuc2lnbmVkIGludCBpbGtfcGxhbmVfd21fbWF4KGNvbnN0IHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIHVuc2lnbmVkIGludCBpbGtfcGxh
bmVfd21fbWF4KGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAg
ICAgaW50IGxldmVsLAo+ICAgCQkJCSAgICAgY29uc3Qgc3RydWN0IGludGVsX3dtX2NvbmZpZyAq
Y29uZmlnLAo+ICAgCQkJCSAgICAgZW51bSBpbnRlbF9kZGJfcGFydGl0aW9uaW5nIGRkYl9wYXJ0
aXRpb25pbmcsCj4gICAJCQkJICAgICBib29sIGlzX3Nwcml0ZSkKPiAgIHsKPiAtCXVuc2lnbmVk
IGludCBmaWZvX3NpemUgPSBpbGtfZGlzcGxheV9maWZvX3NpemUoZGV2X3ByaXYpOwo+ICsJdW5z
aWduZWQgaW50IGZpZm9fc2l6ZSA9IGlsa19kaXNwbGF5X2ZpZm9fc2l6ZShpOTE1KTsKPiAgIAo+
ICAgCS8qIGlmIHNwcml0ZXMgYXJlbid0IGVuYWJsZWQsIHNwcml0ZXMgZ2V0IG5vdGhpbmcgKi8K
PiAgIAlpZiAoaXNfc3ByaXRlICYmICFjb25maWctPnNwcml0ZXNfZW5hYmxlZCkKPiBAQCAtMjY0
NiwxNCArMjY0NiwxNCBAQCBzdGF0aWMgdW5zaWduZWQgaW50IGlsa19wbGFuZV93bV9tYXgoY29u
c3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCj4gICAJLyogSFNXIGFs
bG93cyBMUDErIHdhdGVybWFya3MgZXZlbiB3aXRoIG11bHRpcGxlIHBpcGVzICovCj4gICAJaWYg
KGxldmVsID09IDAgfHwgY29uZmlnLT5udW1fcGlwZXNfYWN0aXZlID4gMSkgewo+IC0JCWZpZm9f
c2l6ZSAvPSBJTlRFTF9JTkZPKGRldl9wcml2KS0+bnVtX3BpcGVzOwo+ICsJCWZpZm9fc2l6ZSAv
PSBJTlRFTF9JTkZPKGk5MTUpLT5udW1fcGlwZXM7Cj4gICAKPiAgIAkJLyoKPiAgIAkJICogRm9y
IHNvbWUgcmVhc29uIHRoZSBub24gc2VsZiByZWZyZXNoCj4gICAJCSAqIEZJRk8gc2l6ZSBpcyBv
bmx5IGhhbGYgb2YgdGhlIHNlbGYKPiAgIAkJICogcmVmcmVzaCBGSUZPIHNpemUgb24gSUxLL1NO
Qi4KPiAgIAkJICovCj4gLQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPD0gNikKPiArCQlpZiAo
SU5URUxfR0VOKGk5MTUpIDw9IDYpCj4gICAJCQlmaWZvX3NpemUgLz0gMjsKPiAgIAl9Cj4gICAK
PiBAQCAtMjY2OSwxMSArMjY2OSwxMSBAQCBzdGF0aWMgdW5zaWduZWQgaW50IGlsa19wbGFuZV93
bV9tYXgoY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCX0KPiAg
IAo+ICAgCS8qIGNsYW1wIHRvIG1heCB0aGF0IHRoZSByZWdpc3RlcnMgY2FuIGhvbGQgKi8KPiAt
CXJldHVybiBtaW4oZmlmb19zaXplLCBpbGtfcGxhbmVfd21fcmVnX21heChkZXZfcHJpdiwgbGV2
ZWwsIGlzX3Nwcml0ZSkpOwo+ICsJcmV0dXJuIG1pbihmaWZvX3NpemUsIGlsa19wbGFuZV93bV9y
ZWdfbWF4KGk5MTUsIGxldmVsLCBpc19zcHJpdGUpKTsKPiAgIH0KPiAgIAo+ICAgLyogQ2FsY3Vs
YXRlIHRoZSBtYXhpbXVtIGN1cnNvciBwbGFuZSB3YXRlcm1hcmsgKi8KPiAtc3RhdGljIHVuc2ln
bmVkIGludCBpbGtfY3Vyc29yX3dtX21heChjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gK3N0YXRpYyB1bnNpZ25lZCBpbnQgaWxrX2N1cnNvcl93bV9tYXgoY29uc3Qg
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgICAgaW50IGxldmVsLAo+
ICAgCQkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF93bV9jb25maWcgKmNvbmZpZykKPiAgIHsK
PiBAQCAtMjY4MiwyOSArMjY4MiwyOSBAQCBzdGF0aWMgdW5zaWduZWQgaW50IGlsa19jdXJzb3Jf
d21fbWF4KGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkJcmV0
dXJuIDY0Owo+ICAgCj4gICAJLyogb3RoZXJ3aXNlIGp1c3QgcmVwb3J0IG1heCB0aGF0IHJlZ2lz
dGVycyBjYW4gaG9sZCAqLwo+IC0JcmV0dXJuIGlsa19jdXJzb3Jfd21fcmVnX21heChkZXZfcHJp
diwgbGV2ZWwpOwo+ICsJcmV0dXJuIGlsa19jdXJzb3Jfd21fcmVnX21heChpOTE1LCBsZXZlbCk7
Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaWxrX2NvbXB1dGVfd21fbWF4aW11bXMoY29uc3Qg
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBpbGtfY29t
cHV0ZV93bV9tYXhpbXVtcyhjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAg
IAkJCQkgICAgaW50IGxldmVsLAo+ICAgCQkJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfd21fY29u
ZmlnICpjb25maWcsCj4gICAJCQkJICAgIGVudW0gaW50ZWxfZGRiX3BhcnRpdGlvbmluZyBkZGJf
cGFydGl0aW9uaW5nLAo+ICAgCQkJCSAgICBzdHJ1Y3QgaWxrX3dtX21heGltdW1zICptYXgpCj4g
ICB7Cj4gLQltYXgtPnByaSA9IGlsa19wbGFuZV93bV9tYXgoZGV2X3ByaXYsIGxldmVsLCBjb25m
aWcsIGRkYl9wYXJ0aXRpb25pbmcsIGZhbHNlKTsKPiAtCW1heC0+c3ByID0gaWxrX3BsYW5lX3dt
X21heChkZXZfcHJpdiwgbGV2ZWwsIGNvbmZpZywgZGRiX3BhcnRpdGlvbmluZywgdHJ1ZSk7Cj4g
LQltYXgtPmN1ciA9IGlsa19jdXJzb3Jfd21fbWF4KGRldl9wcml2LCBsZXZlbCwgY29uZmlnKTsK
PiAtCW1heC0+ZmJjID0gaWxrX2ZiY193bV9yZWdfbWF4KGRldl9wcml2KTsKPiArCW1heC0+cHJp
ID0gaWxrX3BsYW5lX3dtX21heChpOTE1LCBsZXZlbCwgY29uZmlnLCBkZGJfcGFydGl0aW9uaW5n
LCBmYWxzZSk7Cj4gKwltYXgtPnNwciA9IGlsa19wbGFuZV93bV9tYXgoaTkxNSwgbGV2ZWwsIGNv
bmZpZywgZGRiX3BhcnRpdGlvbmluZywgdHJ1ZSk7Cj4gKwltYXgtPmN1ciA9IGlsa19jdXJzb3Jf
d21fbWF4KGk5MTUsIGxldmVsLCBjb25maWcpOwo+ICsJbWF4LT5mYmMgPSBpbGtfZmJjX3dtX3Jl
Z19tYXgoaTkxNSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaWxrX2NvbXB1dGVfd21fcmVn
X21heGltdW1zKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3Rh
dGljIHZvaWQgaWxrX2NvbXB1dGVfd21fcmVnX21heGltdW1zKGNvbnN0IHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ICAgCQkJCQlpbnQgbGV2ZWwsCj4gICAJCQkJCXN0cnVjdCBpbGtf
d21fbWF4aW11bXMgKm1heCkKPiAgIHsKPiAtCW1heC0+cHJpID0gaWxrX3BsYW5lX3dtX3JlZ19t
YXgoZGV2X3ByaXYsIGxldmVsLCBmYWxzZSk7Cj4gLQltYXgtPnNwciA9IGlsa19wbGFuZV93bV9y
ZWdfbWF4KGRldl9wcml2LCBsZXZlbCwgdHJ1ZSk7Cj4gLQltYXgtPmN1ciA9IGlsa19jdXJzb3Jf
d21fcmVnX21heChkZXZfcHJpdiwgbGV2ZWwpOwo+IC0JbWF4LT5mYmMgPSBpbGtfZmJjX3dtX3Jl
Z19tYXgoZGV2X3ByaXYpOwo+ICsJbWF4LT5wcmkgPSBpbGtfcGxhbmVfd21fcmVnX21heChpOTE1
LCBsZXZlbCwgZmFsc2UpOwo+ICsJbWF4LT5zcHIgPSBpbGtfcGxhbmVfd21fcmVnX21heChpOTE1
LCBsZXZlbCwgdHJ1ZSk7Cj4gKwltYXgtPmN1ciA9IGlsa19jdXJzb3Jfd21fcmVnX21heChpOTE1
LCBsZXZlbCk7Cj4gKwltYXgtPmZiYyA9IGlsa19mYmNfd21fcmVnX21heChpOTE1KTsKPiAgIH0K
PiAgIAo+ICAgc3RhdGljIGJvb2wgaWxrX3ZhbGlkYXRlX3dtX2xldmVsKGludCBsZXZlbCwKPiBA
QCAtMjc0OCw3ICsyNzQ4LDcgQEAgc3RhdGljIGJvb2wgaWxrX3ZhbGlkYXRlX3dtX2xldmVsKGlu
dCBsZXZlbCwKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGlsa19j
b21wdXRlX3dtX2xldmVsKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiArc3RhdGljIHZvaWQgaWxrX2NvbXB1dGVfd21fbGV2ZWwoY29uc3Qgc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9j
cnRjLAo+ICAgCQkJCSBpbnQgbGV2ZWwsCj4gICAJCQkJIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjc3RhdGUsCj4gQEAgLTI3NTcsOSArMjc1Nyw5IEBAIHN0YXRpYyB2b2lkIGlsa19jb21wdXRl
X3dtX2xldmVsKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkJ
CQkgY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpjdXJzdGF0ZSwKPiAgIAkJCQkgc3Ry
dWN0IGludGVsX3dtX2xldmVsICpyZXN1bHQpCj4gICB7Cj4gLQl1MTYgcHJpX2xhdGVuY3kgPSBk
ZXZfcHJpdi0+d20ucHJpX2xhdGVuY3lbbGV2ZWxdOwo+IC0JdTE2IHNwcl9sYXRlbmN5ID0gZGV2
X3ByaXYtPndtLnNwcl9sYXRlbmN5W2xldmVsXTsKPiAtCXUxNiBjdXJfbGF0ZW5jeSA9IGRldl9w
cml2LT53bS5jdXJfbGF0ZW5jeVtsZXZlbF07Cj4gKwl1MTYgcHJpX2xhdGVuY3kgPSBpOTE1LT53
bS5wcmlfbGF0ZW5jeVtsZXZlbF07Cj4gKwl1MTYgc3ByX2xhdGVuY3kgPSBpOTE1LT53bS5zcHJf
bGF0ZW5jeVtsZXZlbF07Cj4gKwl1MTYgY3VyX2xhdGVuY3kgPSBpOTE1LT53bS5jdXJfbGF0ZW5j
eVtsZXZlbF07Cj4gICAKPiAgIAkvKiBXTTErIGxhdGVuY3kgdmFsdWVzIHN0b3JlZCBpbiAwLjV1
cyB1bml0cyAqLwo+ICAgCWlmIChsZXZlbCA+IDApIHsKPiBAQCAtMjgxMSwxOSArMjgxMSwxOSBA
QCBoc3dfY29tcHV0ZV9saW5ldGltZV93bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3N0YXRlKQo+ICAgCSAgICAgICBQSVBFX1dNX0xJTkVUSU1FX1RJTUUobGluZXRpbWUpOwo+ICAg
fQo+ICAgCj4gLXN0YXRpYyB2b2lkIGludGVsX3JlYWRfd21fbGF0ZW5jeShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGludGVsX3JlYWRfd21fbGF0ZW5j
eShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgIHUxNiB3bVs4XSkKPiAg
IHsKPiAtCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwo+
ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsKPiAgIAo+IC0J
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkgewo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+
PSA5KSB7Cj4gICAJCXUzMiB2YWw7Cj4gICAJCWludCByZXQsIGk7Cj4gLQkJaW50IGxldmVsLCBt
YXhfbGV2ZWwgPSBpbGtfd21fbWF4X2xldmVsKGRldl9wcml2KTsKPiArCQlpbnQgbGV2ZWwsIG1h
eF9sZXZlbCA9IGlsa193bV9tYXhfbGV2ZWwoaTkxNSk7Cj4gICAKPiAgIAkJLyogcmVhZCB0aGUg
Zmlyc3Qgc2V0IG9mIG1lbW9yeSBsYXRlbmNpZXNbMDozXSAqLwo+ICAgCQl2YWwgPSAwOyAvKiBk
YXRhMCB0byBiZSBwcm9ncmFtbWVkIHRvIDAgZm9yIGZpcnN0IHNldCAqLwo+IC0JCXJldCA9IHNh
bmR5YnJpZGdlX3Bjb2RlX3JlYWQoZGV2X3ByaXYsCj4gKwkJcmV0ID0gc2FuZHlicmlkZ2VfcGNv
ZGVfcmVhZChpOTE1LAo+ICAgCQkJCQkgICAgIEdFTjlfUENPREVfUkVBRF9NRU1fTEFURU5DWSwK
PiAgIAkJCQkJICAgICAmdmFsLCBOVUxMKTsKPiAgIAo+IEBAIC0yODQyLDcgKzI4NDIsNyBAQCBz
dGF0aWMgdm9pZCBpbnRlbF9yZWFkX3dtX2xhdGVuY3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICAgCj4gICAJCS8qIHJlYWQgdGhlIHNlY29uZCBzZXQgb2YgbWVtb3J5IGxh
dGVuY2llc1s0OjddICovCj4gICAJCXZhbCA9IDE7IC8qIGRhdGEwIHRvIGJlIHByb2dyYW1tZWQg
dG8gMSBmb3Igc2Vjb25kIHNldCAqLwo+IC0JCXJldCA9IHNhbmR5YnJpZGdlX3Bjb2RlX3JlYWQo
ZGV2X3ByaXYsCj4gKwkJcmV0ID0gc2FuZHlicmlkZ2VfcGNvZGVfcmVhZChpOTE1LAo+ICAgCQkJ
CQkgICAgIEdFTjlfUENPREVfUkVBRF9NRU1fTEFURU5DWSwKPiAgIAkJCQkJICAgICAmdmFsLCBO
VUxMKTsKPiAgIAkJaWYgKHJldCkgewo+IEBAIC0yODkzLDEwICsyODkzLDEwIEBAIHN0YXRpYyB2
b2lkIGludGVsX3JlYWRfd21fbGF0ZW5jeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gICAJCSAqIGFueSB1bmRlcnJ1bi4gSWYgbm90IGFibGUgdG8gZ2V0IERpbW0gaW5mbyBh
c3N1bWUgMTZHQiBkaW1tCj4gICAJCSAqIHRvIGF2b2lkIGFueSB1bmRlcnJ1bi4KPiAgIAkJICov
Cj4gLQkJaWYgKGRldl9wcml2LT5kcmFtX2luZm8uaXNfMTZnYl9kaW1tKQo+ICsJCWlmIChpOTE1
LT5kcmFtX2luZm8uaXNfMTZnYl9kaW1tKQo+ICAgCQkJd21bMF0gKz0gMTsKPiAgIAo+IC0JfSBl
bHNlIGlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8fCBJU19CUk9BRFdFTEwoZGV2X3ByaXYpKSB7
Cj4gKwl9IGVsc2UgaWYgKElTX0hBU1dFTEwoaTkxNSkgfHwgSVNfQlJPQURXRUxMKGk5MTUpKSB7
Cj4gICAJCXU2NCBzc2twZCA9IGludGVsX3VuY29yZV9yZWFkNjQodW5jb3JlLCBNQ0hfU1NLUEQp
Owo+ICAgCj4gICAJCXdtWzBdID0gKHNza3BkID4+IDU2KSAmIDB4RkY7Cj4gQEAgLTI5MDYsMTQg
KzI5MDYsMTQgQEAgc3RhdGljIHZvaWQgaW50ZWxfcmVhZF93bV9sYXRlbmN5KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkJd21bMl0gPSAoc3NrcGQgPj4gMTIpICYgMHhG
RjsKPiAgIAkJd21bM10gPSAoc3NrcGQgPj4gMjApICYgMHgxRkY7Cj4gICAJCXdtWzRdID0gKHNz
a3BkID4+IDMyKSAmIDB4MUZGOwo+IC0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDYpIHsKPiArCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDYpIHsKPiAgIAkJdTMyIHNz
a3BkID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBNQ0hfU1NLUEQpOwo+ICAgCj4gICAJCXdt
WzBdID0gKHNza3BkID4+IFNTS1BEX1dNMF9TSElGVCkgJiBTU0tQRF9XTV9NQVNLOwo+ICAgCQl3
bVsxXSA9IChzc2twZCA+PiBTU0tQRF9XTTFfU0hJRlQpICYgU1NLUERfV01fTUFTSzsKPiAgIAkJ
d21bMl0gPSAoc3NrcGQgPj4gU1NLUERfV00yX1NISUZUKSAmIFNTS1BEX1dNX01BU0s7Cj4gICAJ
CXdtWzNdID0gKHNza3BkID4+IFNTS1BEX1dNM19TSElGVCkgJiBTU0tQRF9XTV9NQVNLOwo+IC0J
fSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDUpIHsKPiArCX0gZWxzZSBpZiAoSU5U
RUxfR0VOKGk5MTUpID49IDUpIHsKPiAgIAkJdTMyIG1sdHIgPSBpbnRlbF91bmNvcmVfcmVhZCh1
bmNvcmUsIE1MVFJfSUxLKTsKPiAgIAo+ICAgCQkvKiBJTEsgcHJpbWFyeSBMUDAgbGF0ZW5jeSBp
cyA3MDAgbnMgKi8KPiBAQCAtMjkyMSw0NCArMjkyMSw0NCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9y
ZWFkX3dtX2xhdGVuY3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCQl3
bVsxXSA9IChtbHRyID4+IE1MVFJfV00xX1NISUZUKSAmIElMS19TUkxUX01BU0s7Cj4gICAJCXdt
WzJdID0gKG1sdHIgPj4gTUxUUl9XTTJfU0hJRlQpICYgSUxLX1NSTFRfTUFTSzsKPiAgIAl9IGVs
c2Ugewo+IC0JCU1JU1NJTkdfQ0FTRShJTlRFTF9ERVZJRChkZXZfcHJpdikpOwo+ICsJCU1JU1NJ
TkdfQ0FTRShJTlRFTF9ERVZJRChpOTE1KSk7Cj4gICAJfQo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2
b2lkIGludGVsX2ZpeHVwX3Nwcl93bV9sYXRlbmN5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiArc3RhdGljIHZvaWQgaW50ZWxfZml4dXBfc3ByX3dtX2xhdGVuY3koc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgICAgIHUxNiB3bVs1XSkKPiAgIHsK
PiAgIAkvKiBJTEsgc3ByaXRlIExQMCBsYXRlbmN5IGlzIDEzMDAgbnMgKi8KPiAtCWlmIChJU19H
RU4oZGV2X3ByaXYsIDUpKQo+ICsJaWYgKElTX0dFTihpOTE1LCA1KSkKPiAgIAkJd21bMF0gPSAx
MzsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpbnRlbF9maXh1cF9jdXJfd21fbGF0ZW5jeShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGludGVsX2Zp
eHVwX2N1cl93bV9sYXRlbmN5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJ
CSAgICAgICB1MTYgd21bNV0pCj4gICB7Cj4gICAJLyogSUxLIGN1cnNvciBMUDAgbGF0ZW5jeSBp
cyAxMzAwIG5zICovCj4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCA1KSkKPiArCWlmIChJU19HRU4o
aTkxNSwgNSkpCj4gICAJCXdtWzBdID0gMTM7Cj4gICB9Cj4gICAKPiAtaW50IGlsa193bV9tYXhf
bGV2ZWwoY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtpbnQgaWxr
X3dtX21heF9sZXZlbChjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsK
PiAgIAkvKiBob3cgbWFueSBXTSBsZXZlbHMgYXJlIHdlIGV4cGVjdGluZyAqLwo+IC0JaWYgKElO
VEVMX0dFTihkZXZfcHJpdikgPj0gOSkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkKPiAg
IAkJcmV0dXJuIDc7Cj4gLQllbHNlIGlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8fCBJU19CUk9B
RFdFTEwoZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAoSVNfSEFTV0VMTChpOTE1KSB8fCBJU19CUk9B
RFdFTEwoaTkxNSkpCj4gICAJCXJldHVybiA0Owo+IC0JZWxzZSBpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA+PSA2KQo+ICsJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDYpCj4gICAJCXJldHVy
biAzOwo+ICAgCWVsc2UKPiAgIAkJcmV0dXJuIDI7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQg
aW50ZWxfcHJpbnRfd21fbGF0ZW5jeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gK3N0YXRpYyB2b2lkIGludGVsX3ByaW50X3dtX2xhdGVuY3koc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gICAJCQkJICAgY29uc3QgY2hhciAqbmFtZSwKPiAgIAkJCQkgICBjb25z
dCB1MTYgd21bOF0pCj4gICB7Cj4gLQlpbnQgbGV2ZWwsIG1heF9sZXZlbCA9IGlsa193bV9tYXhf
bGV2ZWwoZGV2X3ByaXYpOwo+ICsJaW50IGxldmVsLCBtYXhfbGV2ZWwgPSBpbGtfd21fbWF4X2xl
dmVsKGk5MTUpOwo+ICAgCj4gICAJZm9yIChsZXZlbCA9IDA7IGxldmVsIDw9IG1heF9sZXZlbDsg
bGV2ZWwrKykgewo+ICAgCQl1bnNpZ25lZCBpbnQgbGF0ZW5jeSA9IHdtW2xldmVsXTsKPiBAQCAt
Mjk3Myw3ICsyOTczLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfcHJpbnRfd21fbGF0ZW5jeShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJCSAqIC0gbGF0ZW5jaWVzIGFyZSBp
biB1cyBvbiBnZW45Lgo+ICAgCQkgKiAtIGJlZm9yZSB0aGVuLCBXTTErIGxhdGVuY3kgdmFsdWVz
IGFyZSBpbiAwLjV1cyB1bml0cwo+ICAgCQkgKi8KPiAtCQlpZiAoSU5URUxfR0VOKGRldl9wcml2
KSA+PSA5KQo+ICsJCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkKPiAgIAkJCWxhdGVuY3kgKj0g
MTA7Cj4gICAJCWVsc2UgaWYgKGxldmVsID4gMCkKPiAgIAkJCWxhdGVuY3kgKj0gNTsKPiBAQCAt
Mjk4NCwxMCArMjk4NCwxMCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wcmludF93bV9sYXRlbmN5KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAl9Cj4gICB9Cj4gICAKPiAtc3Rh
dGljIGJvb2wgaWxrX2luY3JlYXNlX3dtX2xhdGVuY3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICtzdGF0aWMgYm9vbCBpbGtfaW5jcmVhc2Vfd21fbGF0ZW5jeShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAgdTE2IHdtWzVdLCB1MTYgbWluKQo+
ICAgewo+IC0JaW50IGxldmVsLCBtYXhfbGV2ZWwgPSBpbGtfd21fbWF4X2xldmVsKGRldl9wcml2
KTsKPiArCWludCBsZXZlbCwgbWF4X2xldmVsID0gaWxrX3dtX21heF9sZXZlbChpOTE1KTsKPiAg
IAo+ICAgCWlmICh3bVswXSA+PSBtaW4pCj4gICAJCXJldHVybiBmYWxzZTsKPiBAQCAtMjk5OSw3
ICsyOTk5LDcgQEAgc3RhdGljIGJvb2wgaWxrX2luY3JlYXNlX3dtX2xhdGVuY3koc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCXJldHVybiB0cnVlOwo+ICAgfQo+ICAgCj4g
LXN0YXRpYyB2b2lkIHNuYl93bV9sYXRlbmN5X3F1aXJrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgc25iX3dtX2xhdGVuY3lfcXVpcmsoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJYm9vbCBjaGFuZ2VkOwo+ICAgCj4gQEAg
LTMwMDcsMjAgKzMwMDcsMjAgQEAgc3RhdGljIHZvaWQgc25iX3dtX2xhdGVuY3lfcXVpcmsoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCSAqIFRoZSBCSU9TIHByb3ZpZGVk
IFdNIG1lbW9yeSBsYXRlbmN5IHZhbHVlcyBhcmUgb2Z0ZW4KPiAgIAkgKiBpbmFkZXF1YXRlIGZv
ciBoaWdoIHJlc29sdXRpb24gZGlzcGxheXMuIEFkanVzdCB0aGVtLgo+ICAgCSAqLwo+IC0JY2hh
bmdlZCA9IGlsa19pbmNyZWFzZV93bV9sYXRlbmN5KGRldl9wcml2LCBkZXZfcHJpdi0+d20ucHJp
X2xhdGVuY3ksIDEyKSB8Cj4gLQkJaWxrX2luY3JlYXNlX3dtX2xhdGVuY3koZGV2X3ByaXYsIGRl
dl9wcml2LT53bS5zcHJfbGF0ZW5jeSwgMTIpIHwKPiAtCQlpbGtfaW5jcmVhc2Vfd21fbGF0ZW5j
eShkZXZfcHJpdiwgZGV2X3ByaXYtPndtLmN1cl9sYXRlbmN5LCAxMik7Cj4gKwljaGFuZ2VkID0g
aWxrX2luY3JlYXNlX3dtX2xhdGVuY3koaTkxNSwgaTkxNS0+d20ucHJpX2xhdGVuY3ksIDEyKSB8
Cj4gKwkJaWxrX2luY3JlYXNlX3dtX2xhdGVuY3koaTkxNSwgaTkxNS0+d20uc3ByX2xhdGVuY3ks
IDEyKSB8Cj4gKwkJaWxrX2luY3JlYXNlX3dtX2xhdGVuY3koaTkxNSwgaTkxNS0+d20uY3VyX2xh
dGVuY3ksIDEyKTsKPiAgIAo+ICAgCWlmICghY2hhbmdlZCkKPiAgIAkJcmV0dXJuOwo+ICAgCj4g
ICAJRFJNX0RFQlVHX0tNUygiV00gbGF0ZW5jeSB2YWx1ZXMgaW5jcmVhc2VkIHRvIGF2b2lkIHBv
dGVudGlhbCB1bmRlcnJ1bnNcbiIpOwo+IC0JaW50ZWxfcHJpbnRfd21fbGF0ZW5jeShkZXZfcHJp
diwgIlByaW1hcnkiLCBkZXZfcHJpdi0+d20ucHJpX2xhdGVuY3kpOwo+IC0JaW50ZWxfcHJpbnRf
d21fbGF0ZW5jeShkZXZfcHJpdiwgIlNwcml0ZSIsIGRldl9wcml2LT53bS5zcHJfbGF0ZW5jeSk7
Cj4gLQlpbnRlbF9wcmludF93bV9sYXRlbmN5KGRldl9wcml2LCAiQ3Vyc29yIiwgZGV2X3ByaXYt
PndtLmN1cl9sYXRlbmN5KTsKPiArCWludGVsX3ByaW50X3dtX2xhdGVuY3koaTkxNSwgIlByaW1h
cnkiLCBpOTE1LT53bS5wcmlfbGF0ZW5jeSk7Cj4gKwlpbnRlbF9wcmludF93bV9sYXRlbmN5KGk5
MTUsICJTcHJpdGUiLCBpOTE1LT53bS5zcHJfbGF0ZW5jeSk7Cj4gKwlpbnRlbF9wcmludF93bV9s
YXRlbmN5KGk5MTUsICJDdXJzb3IiLCBpOTE1LT53bS5jdXJfbGF0ZW5jeSk7Cj4gICB9Cj4gICAK
PiAtc3RhdGljIHZvaWQgc25iX3dtX2xwM19pcnFfcXVpcmsoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBzbmJfd21fbHAzX2lycV9xdWlyayhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAkvKgo+ICAgCSAqIE9uIHNvbWUgU05C
IG1hY2hpbmVzIChUaGlua3BhZCBYMjIwIFRhYmxldCBhdCBsZWFzdCkKPiBAQCAtMzAzMyw1MCAr
MzAzMyw1MCBAQCBzdGF0aWMgdm9pZCBzbmJfd21fbHAzX2lycV9xdWlyayhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICogaW50ZXJydXB0cyBvbmx5LiBUbyBwbGF5IGl0
IHNhZmUgd2UgZGlzYWJsZSBMUDMKPiAgIAkgKiB3YXRlcm1hcmtzIGVudGlyZWx5Lgo+ICAgCSAq
Lwo+IC0JaWYgKGRldl9wcml2LT53bS5wcmlfbGF0ZW5jeVszXSA9PSAwICYmCj4gLQkgICAgZGV2
X3ByaXYtPndtLnNwcl9sYXRlbmN5WzNdID09IDAgJiYKPiAtCSAgICBkZXZfcHJpdi0+d20uY3Vy
X2xhdGVuY3lbM10gPT0gMCkKPiArCWlmIChpOTE1LT53bS5wcmlfbGF0ZW5jeVszXSA9PSAwICYm
Cj4gKwkgICAgaTkxNS0+d20uc3ByX2xhdGVuY3lbM10gPT0gMCAmJgo+ICsJICAgIGk5MTUtPndt
LmN1cl9sYXRlbmN5WzNdID09IDApCj4gICAJCXJldHVybjsKPiAgIAo+IC0JZGV2X3ByaXYtPndt
LnByaV9sYXRlbmN5WzNdID0gMDsKPiAtCWRldl9wcml2LT53bS5zcHJfbGF0ZW5jeVszXSA9IDA7
Cj4gLQlkZXZfcHJpdi0+d20uY3VyX2xhdGVuY3lbM10gPSAwOwo+ICsJaTkxNS0+d20ucHJpX2xh
dGVuY3lbM10gPSAwOwo+ICsJaTkxNS0+d20uc3ByX2xhdGVuY3lbM10gPSAwOwo+ICsJaTkxNS0+
d20uY3VyX2xhdGVuY3lbM10gPSAwOwo+ICAgCj4gICAJRFJNX0RFQlVHX0tNUygiTFAzIHdhdGVy
bWFya3MgZGlzYWJsZWQgZHVlIHRvIHBvdGVudGlhbCBmb3IgbG9zdCBpbnRlcnJ1cHRzXG4iKTsK
PiAtCWludGVsX3ByaW50X3dtX2xhdGVuY3koZGV2X3ByaXYsICJQcmltYXJ5IiwgZGV2X3ByaXYt
PndtLnByaV9sYXRlbmN5KTsKPiAtCWludGVsX3ByaW50X3dtX2xhdGVuY3koZGV2X3ByaXYsICJT
cHJpdGUiLCBkZXZfcHJpdi0+d20uc3ByX2xhdGVuY3kpOwo+IC0JaW50ZWxfcHJpbnRfd21fbGF0
ZW5jeShkZXZfcHJpdiwgIkN1cnNvciIsIGRldl9wcml2LT53bS5jdXJfbGF0ZW5jeSk7Cj4gKwlp
bnRlbF9wcmludF93bV9sYXRlbmN5KGk5MTUsICJQcmltYXJ5IiwgaTkxNS0+d20ucHJpX2xhdGVu
Y3kpOwo+ICsJaW50ZWxfcHJpbnRfd21fbGF0ZW5jeShpOTE1LCAiU3ByaXRlIiwgaTkxNS0+d20u
c3ByX2xhdGVuY3kpOwo+ICsJaW50ZWxfcHJpbnRfd21fbGF0ZW5jeShpOTE1LCAiQ3Vyc29yIiwg
aTkxNS0+d20uY3VyX2xhdGVuY3kpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGlsa19zZXR1
cF93bV9sYXRlbmN5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGlj
IHZvaWQgaWxrX3NldHVwX3dtX2xhdGVuY3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gICB7Cj4gLQlpbnRlbF9yZWFkX3dtX2xhdGVuY3koZGV2X3ByaXYsIGRldl9wcml2LT53bS5w
cmlfbGF0ZW5jeSk7Cj4gKwlpbnRlbF9yZWFkX3dtX2xhdGVuY3koaTkxNSwgaTkxNS0+d20ucHJp
X2xhdGVuY3kpOwo+ICAgCj4gLQltZW1jcHkoZGV2X3ByaXYtPndtLnNwcl9sYXRlbmN5LCBkZXZf
cHJpdi0+d20ucHJpX2xhdGVuY3ksCj4gLQkgICAgICAgc2l6ZW9mKGRldl9wcml2LT53bS5wcmlf
bGF0ZW5jeSkpOwo+IC0JbWVtY3B5KGRldl9wcml2LT53bS5jdXJfbGF0ZW5jeSwgZGV2X3ByaXYt
PndtLnByaV9sYXRlbmN5LAo+IC0JICAgICAgIHNpemVvZihkZXZfcHJpdi0+d20ucHJpX2xhdGVu
Y3kpKTsKPiArCW1lbWNweShpOTE1LT53bS5zcHJfbGF0ZW5jeSwgaTkxNS0+d20ucHJpX2xhdGVu
Y3ksCj4gKwkgICAgICAgc2l6ZW9mKGk5MTUtPndtLnByaV9sYXRlbmN5KSk7Cj4gKwltZW1jcHko
aTkxNS0+d20uY3VyX2xhdGVuY3ksIGk5MTUtPndtLnByaV9sYXRlbmN5LAo+ICsJICAgICAgIHNp
emVvZihpOTE1LT53bS5wcmlfbGF0ZW5jeSkpOwo+ICAgCj4gLQlpbnRlbF9maXh1cF9zcHJfd21f
bGF0ZW5jeShkZXZfcHJpdiwgZGV2X3ByaXYtPndtLnNwcl9sYXRlbmN5KTsKPiAtCWludGVsX2Zp
eHVwX2N1cl93bV9sYXRlbmN5KGRldl9wcml2LCBkZXZfcHJpdi0+d20uY3VyX2xhdGVuY3kpOwo+
ICsJaW50ZWxfZml4dXBfc3ByX3dtX2xhdGVuY3koaTkxNSwgaTkxNS0+d20uc3ByX2xhdGVuY3kp
Owo+ICsJaW50ZWxfZml4dXBfY3VyX3dtX2xhdGVuY3koaTkxNSwgaTkxNS0+d20uY3VyX2xhdGVu
Y3kpOwo+ICAgCj4gLQlpbnRlbF9wcmludF93bV9sYXRlbmN5KGRldl9wcml2LCAiUHJpbWFyeSIs
IGRldl9wcml2LT53bS5wcmlfbGF0ZW5jeSk7Cj4gLQlpbnRlbF9wcmludF93bV9sYXRlbmN5KGRl
dl9wcml2LCAiU3ByaXRlIiwgZGV2X3ByaXYtPndtLnNwcl9sYXRlbmN5KTsKPiAtCWludGVsX3By
aW50X3dtX2xhdGVuY3koZGV2X3ByaXYsICJDdXJzb3IiLCBkZXZfcHJpdi0+d20uY3VyX2xhdGVu
Y3kpOwo+ICsJaW50ZWxfcHJpbnRfd21fbGF0ZW5jeShpOTE1LCAiUHJpbWFyeSIsIGk5MTUtPndt
LnByaV9sYXRlbmN5KTsKPiArCWludGVsX3ByaW50X3dtX2xhdGVuY3koaTkxNSwgIlNwcml0ZSIs
IGk5MTUtPndtLnNwcl9sYXRlbmN5KTsKPiArCWludGVsX3ByaW50X3dtX2xhdGVuY3koaTkxNSwg
IkN1cnNvciIsIGk5MTUtPndtLmN1cl9sYXRlbmN5KTsKPiAgIAo+IC0JaWYgKElTX0dFTihkZXZf
cHJpdiwgNikpIHsKPiAtCQlzbmJfd21fbGF0ZW5jeV9xdWlyayhkZXZfcHJpdik7Cj4gLQkJc25i
X3dtX2xwM19pcnFfcXVpcmsoZGV2X3ByaXYpOwo+ICsJaWYgKElTX0dFTihpOTE1LCA2KSkgewo+
ICsJCXNuYl93bV9sYXRlbmN5X3F1aXJrKGk5MTUpOwo+ICsJCXNuYl93bV9scDNfaXJxX3F1aXJr
KGk5MTUpOwo+ICAgCX0KPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBza2xfc2V0dXBfd21fbGF0
ZW5jeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIHNr
bF9zZXR1cF93bV9sYXRlbmN5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+
IC0JaW50ZWxfcmVhZF93bV9sYXRlbmN5KGRldl9wcml2LCBkZXZfcHJpdi0+d20uc2tsX2xhdGVu
Y3kpOwo+IC0JaW50ZWxfcHJpbnRfd21fbGF0ZW5jeShkZXZfcHJpdiwgIkdlbjkgUGxhbmUiLCBk
ZXZfcHJpdi0+d20uc2tsX2xhdGVuY3kpOwo+ICsJaW50ZWxfcmVhZF93bV9sYXRlbmN5KGk5MTUs
IGk5MTUtPndtLnNrbF9sYXRlbmN5KTsKPiArCWludGVsX3ByaW50X3dtX2xhdGVuY3koaTkxNSwg
IkdlbjkgUGxhbmUiLCBpOTE1LT53bS5za2xfbGF0ZW5jeSk7Cj4gICB9Cj4gICAKPiAtc3RhdGlj
IGJvb2wgaWxrX3ZhbGlkYXRlX3BpcGVfd20oY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICtzdGF0aWMgYm9vbCBpbGtfdmFsaWRhdGVfcGlwZV93bShjb25zdCBzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgc3RydWN0IGludGVsX3BpcGVfd20g
KnBpcGVfd20pCj4gICB7Cj4gICAJLyogTFAwIHdhdGVybWFyayBtYXhpbXVtcyBkZXBlbmQgb24g
dGhpcyBwaXBlIGFsb25lICovCj4gQEAgLTMwODgsNyArMzA4OCw3IEBAIHN0YXRpYyBib29sIGls
a192YWxpZGF0ZV9waXBlX3dtKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiAgIAlzdHJ1Y3QgaWxrX3dtX21heGltdW1zIG1heDsKPiAgIAo+ICAgCS8qIExQMCB3YXRl
cm1hcmtzIGFsd2F5cyB1c2UgMS8yIEREQiBwYXJ0aXRpb25pbmcgKi8KPiAtCWlsa19jb21wdXRl
X3dtX21heGltdW1zKGRldl9wcml2LCAwLCAmY29uZmlnLCBJTlRFTF9EREJfUEFSVF8xXzIsICZt
YXgpOwo+ICsJaWxrX2NvbXB1dGVfd21fbWF4aW11bXMoaTkxNSwgMCwgJmNvbmZpZywgSU5URUxf
RERCX1BBUlRfMV8yLCAmbWF4KTsKPiAgIAo+ICAgCS8qIEF0IGxlYXN0IExQMCBtdXN0IGJlIHZh
bGlkICovCj4gICAJaWYgKCFpbGtfdmFsaWRhdGVfd21fbGV2ZWwoMCwgJm1heCwgJnBpcGVfd20t
PndtWzBdKSkgewo+IEBAIC0zMTA2LDEzICszMTA2LDEzIEBAIHN0YXRpYyBpbnQgaWxrX2NvbXB1
dGVfcGlwZV93bShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlKQo+ICAgCXN0cnVjdCBp
bnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0Yyhjc3RhdGUtPmJhc2UuY3J0Yyk7
Cj4gICAJc3RydWN0IGludGVsX3BpcGVfd20gKnBpcGVfd207Cj4gICAJc3RydWN0IGRybV9kZXZp
Y2UgKmRldiA9IHN0YXRlLT5kZXY7Cj4gLQljb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwljb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAlzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZTsKPiAg
IAljb25zdCBzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZTsKPiAgIAljb25zdCBz
dHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnByaXN0YXRlID0gTlVMTDsKPiAgIAljb25zdCBzdHJ1
Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnNwcnN0YXRlID0gTlVMTDsKPiAgIAljb25zdCBzdHJ1Y3Qg
aW50ZWxfcGxhbmVfc3RhdGUgKmN1cnN0YXRlID0gTlVMTDsKPiAtCWludCBsZXZlbCwgbWF4X2xl
dmVsID0gaWxrX3dtX21heF9sZXZlbChkZXZfcHJpdiksIHVzYWJsZV9sZXZlbDsKPiArCWludCBs
ZXZlbCwgbWF4X2xldmVsID0gaWxrX3dtX21heF9sZXZlbChpOTE1KSwgdXNhYmxlX2xldmVsOwo+
ICAgCXN0cnVjdCBpbGtfd21fbWF4aW11bXMgbWF4Owo+ICAgCj4gICAJcGlwZV93bSA9ICZjc3Rh
dGUtPndtLmlsay5vcHRpbWFsOwo+IEBAIC0zMTM5LDcgKzMxMzksNyBAQCBzdGF0aWMgaW50IGls
a19jb21wdXRlX3BpcGVfd20oc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZSkKPiAgIAl1
c2FibGVfbGV2ZWwgPSBtYXhfbGV2ZWw7Cj4gICAKPiAgIAkvKiBJTEsvU05COiBMUDIrIHdhdGVy
bWFya3Mgb25seSB3L28gc3ByaXRlcyAqLwo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPD0g
NiAmJiBwaXBlX3dtLT5zcHJpdGVzX2VuYWJsZWQpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDw9
IDYgJiYgcGlwZV93bS0+c3ByaXRlc19lbmFibGVkKQo+ICAgCQl1c2FibGVfbGV2ZWwgPSAxOwo+
ICAgCj4gICAJLyogSUxLL1NOQi9JVkI6IExQMSsgd2F0ZXJtYXJrcyBvbmx5IHcvbyBzY2FsaW5n
ICovCj4gQEAgLTMxNDcsMjEgKzMxNDcsMjEgQEAgc3RhdGljIGludCBpbGtfY29tcHV0ZV9waXBl
X3dtKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUpCj4gICAJCXVzYWJsZV9sZXZlbCA9
IDA7Cj4gICAKPiAgIAltZW1zZXQoJnBpcGVfd20tPndtLCAwLCBzaXplb2YocGlwZV93bS0+d20p
KTsKPiAtCWlsa19jb21wdXRlX3dtX2xldmVsKGRldl9wcml2LCBpbnRlbF9jcnRjLCAwLCBjc3Rh
dGUsCj4gKwlpbGtfY29tcHV0ZV93bV9sZXZlbChpOTE1LCBpbnRlbF9jcnRjLCAwLCBjc3RhdGUs
Cj4gICAJCQkgICAgIHByaXN0YXRlLCBzcHJzdGF0ZSwgY3Vyc3RhdGUsICZwaXBlX3dtLT53bVsw
XSk7Cj4gICAKPiAtCWlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8fCBJU19CUk9BRFdFTEwoZGV2
X3ByaXYpKQo+ICsJaWYgKElTX0hBU1dFTEwoaTkxNSkgfHwgSVNfQlJPQURXRUxMKGk5MTUpKQo+
ICAgCQlwaXBlX3dtLT5saW5ldGltZSA9IGhzd19jb21wdXRlX2xpbmV0aW1lX3dtKGNzdGF0ZSk7
Cj4gICAKPiAtCWlmICghaWxrX3ZhbGlkYXRlX3BpcGVfd20oZGV2X3ByaXYsIHBpcGVfd20pKQo+
ICsJaWYgKCFpbGtfdmFsaWRhdGVfcGlwZV93bShpOTE1LCBwaXBlX3dtKSkKPiAgIAkJcmV0dXJu
IC1FSU5WQUw7Cj4gICAKPiAtCWlsa19jb21wdXRlX3dtX3JlZ19tYXhpbXVtcyhkZXZfcHJpdiwg
MSwgJm1heCk7Cj4gKwlpbGtfY29tcHV0ZV93bV9yZWdfbWF4aW11bXMoaTkxNSwgMSwgJm1heCk7
Cj4gICAKPiAgIAlmb3IgKGxldmVsID0gMTsgbGV2ZWwgPD0gdXNhYmxlX2xldmVsOyBsZXZlbCsr
KSB7Cj4gICAJCXN0cnVjdCBpbnRlbF93bV9sZXZlbCAqd20gPSAmcGlwZV93bS0+d21bbGV2ZWxd
Owo+ICAgCj4gLQkJaWxrX2NvbXB1dGVfd21fbGV2ZWwoZGV2X3ByaXYsIGludGVsX2NydGMsIGxl
dmVsLCBjc3RhdGUsCj4gKwkJaWxrX2NvbXB1dGVfd21fbGV2ZWwoaTkxNSwgaW50ZWxfY3J0Yywg
bGV2ZWwsIGNzdGF0ZSwKPiAgIAkJCQkgICAgIHByaXN0YXRlLCBzcHJzdGF0ZSwgY3Vyc3RhdGUs
IHdtKTsKPiAgIAo+ICAgCQkvKgo+IEBAIC0zMTg2LDE0ICszMTg2LDE0IEBAIHN0YXRpYyBpbnQg
aWxrX2NvbXB1dGVfcGlwZV93bShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlKQo+ICAg
c3RhdGljIGludCBpbGtfY29tcHV0ZV9pbnRlcm1lZGlhdGVfd20oc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKm5ld3N0YXRlKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRj
ID0gdG9faW50ZWxfY3J0YyhuZXdzdGF0ZS0+YmFzZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoaW50ZWxfY3J0Yy0+YmFzZS5kZXYpOwo+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGludGVsX2NydGMtPmJhc2Uu
ZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfcGlwZV93bSAqYSA9ICZuZXdzdGF0ZS0+d20uaWxrLmlu
dGVybWVkaWF0ZTsKPiAgIAlzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICppbnRlbF9zdGF0ZSA9
Cj4gICAJCXRvX2ludGVsX2F0b21pY19zdGF0ZShuZXdzdGF0ZS0+YmFzZS5zdGF0ZSk7Cj4gICAJ
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZHN0YXRlID0KPiAgIAkJaW50ZWxfYXRv
bWljX2dldF9vbGRfY3J0Y19zdGF0ZShpbnRlbF9zdGF0ZSwgaW50ZWxfY3J0Yyk7Cj4gICAJY29u
c3Qgc3RydWN0IGludGVsX3BpcGVfd20gKmIgPSAmb2xkc3RhdGUtPndtLmlsay5vcHRpbWFsOwo+
IC0JaW50IGxldmVsLCBtYXhfbGV2ZWwgPSBpbGtfd21fbWF4X2xldmVsKGRldl9wcml2KTsKPiAr
CWludCBsZXZlbCwgbWF4X2xldmVsID0gaWxrX3dtX21heF9sZXZlbChpOTE1KTsKPiAgIAo+ICAg
CS8qCj4gICAJICogU3RhcnQgd2l0aCB0aGUgZmluYWwsIHRhcmdldCB3YXRlcm1hcmtzLCB0aGVu
IGNvbWJpbmUgd2l0aCB0aGUKPiBAQCAtMzIyNiw3ICszMjI2LDcgQEAgc3RhdGljIGludCBpbGtf
Y29tcHV0ZV9pbnRlcm1lZGlhdGVfd20oc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld3N0YXRl
KQo+ICAgCSAqIHRoZXJlJ3Mgbm8gc2FmZSB3YXkgdG8gdHJhbnNpdGlvbiBmcm9tIHRoZSBvbGQg
c3RhdGUgdG8KPiAgIAkgKiB0aGUgbmV3IHN0YXRlLCBzbyB3ZSBuZWVkIHRvIGZhaWwgdGhlIGF0
b21pYyB0cmFuc2FjdGlvbi4KPiAgIAkgKi8KPiAtCWlmICghaWxrX3ZhbGlkYXRlX3BpcGVfd20o
ZGV2X3ByaXYsIGEpKQo+ICsJaWYgKCFpbGtfdmFsaWRhdGVfcGlwZV93bShpOTE1LCBhKSkKPiAg
IAkJcmV0dXJuIC1FSU5WQUw7Cj4gICAKPiAgIAkvKgo+IEBAIC0zMjQyLDcgKzMyNDIsNyBAQCBz
dGF0aWMgaW50IGlsa19jb21wdXRlX2ludGVybWVkaWF0ZV93bShzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqbmV3c3RhdGUpCj4gICAvKgo+ICAgICogTWVyZ2UgdGhlIHdhdGVybWFya3MgZnJvbSBh
bGwgYWN0aXZlIHBpcGVzIGZvciBhIHNwZWNpZmljIGxldmVsLgo+ICAgICovCj4gLXN0YXRpYyB2
b2lkIGlsa19tZXJnZV93bV9sZXZlbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gK3N0YXRpYyB2b2lkIGlsa19tZXJnZV93bV9sZXZlbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwKPiAgIAkJCSAgICAgICBpbnQgbGV2ZWwsCj4gICAJCQkgICAgICAgc3RydWN0IGlu
dGVsX3dtX2xldmVsICpyZXRfd20pCj4gICB7Cj4gQEAgLTMyNTAsNyArMzI1MCw3IEBAIHN0YXRp
YyB2b2lkIGlsa19tZXJnZV93bV9sZXZlbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gICAKPiAgIAlyZXRfd20tPmVuYWJsZSA9IHRydWU7Cj4gICAKPiAtCWZvcl9lYWNoX2lu
dGVsX2NydGMoJmRldl9wcml2LT5kcm0sIGludGVsX2NydGMpIHsKPiArCWZvcl9lYWNoX2ludGVs
X2NydGMoJmk5MTUtPmRybSwgaW50ZWxfY3J0Yykgewo+ICAgCQljb25zdCBzdHJ1Y3QgaW50ZWxf
cGlwZV93bSAqYWN0aXZlID0gJmludGVsX2NydGMtPndtLmFjdGl2ZS5pbGs7Cj4gICAJCWNvbnN0
IHN0cnVjdCBpbnRlbF93bV9sZXZlbCAqd20gPSAmYWN0aXZlLT53bVtsZXZlbF07Cj4gICAKPiBA
QCAtMzI3NSwyNyArMzI3NSwyNyBAQCBzdGF0aWMgdm9pZCBpbGtfbWVyZ2Vfd21fbGV2ZWwoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgLyoKPiAgICAqIE1lcmdlIGFsbCBs
b3cgcG93ZXIgd2F0ZXJtYXJrcyBmb3IgYWxsIGFjdGl2ZSBwaXBlcy4KPiAgICAqLwo+IC1zdGF0
aWMgdm9pZCBpbGtfd21fbWVyZ2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICtzdGF0aWMgdm9pZCBpbGtfd21fbWVyZ2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gICAJCQkgY29uc3Qgc3RydWN0IGludGVsX3dtX2NvbmZpZyAqY29uZmlnLAo+ICAgCQkJIGNv
bnN0IHN0cnVjdCBpbGtfd21fbWF4aW11bXMgKm1heCwKPiAgIAkJCSBzdHJ1Y3QgaW50ZWxfcGlw
ZV93bSAqbWVyZ2VkKQo+ICAgewo+IC0JaW50IGxldmVsLCBtYXhfbGV2ZWwgPSBpbGtfd21fbWF4
X2xldmVsKGRldl9wcml2KTsKPiArCWludCBsZXZlbCwgbWF4X2xldmVsID0gaWxrX3dtX21heF9s
ZXZlbChpOTE1KTsKPiAgIAlpbnQgbGFzdF9lbmFibGVkX2xldmVsID0gbWF4X2xldmVsOwo+ICAg
Cj4gICAJLyogSUxLL1NOQi9JVkI6IExQMSsgd2F0ZXJtYXJrcyBvbmx5IHcvIHNpbmdsZSBwaXBl
ICovCj4gLQlpZiAoKElOVEVMX0dFTihkZXZfcHJpdikgPD0gNiB8fCBJU19JVllCUklER0UoZGV2
X3ByaXYpKSAmJgo+ICsJaWYgKChJTlRFTF9HRU4oaTkxNSkgPD0gNiB8fCBJU19JVllCUklER0Uo
aTkxNSkpICYmCj4gICAJICAgIGNvbmZpZy0+bnVtX3BpcGVzX2FjdGl2ZSA+IDEpCj4gICAJCWxh
c3RfZW5hYmxlZF9sZXZlbCA9IDA7Cj4gICAKPiAgIAkvKiBJTEs6IEZCQyBXTSBtdXN0IGJlIGRp
c2FibGVkIGFsd2F5cyAqLwo+IC0JbWVyZ2VkLT5mYmNfd21fZW5hYmxlZCA9IElOVEVMX0dFTihk
ZXZfcHJpdikgPj0gNjsKPiArCW1lcmdlZC0+ZmJjX3dtX2VuYWJsZWQgPSBJTlRFTF9HRU4oaTkx
NSkgPj0gNjsKPiAgIAo+ICAgCS8qIG1lcmdlIGVhY2ggV00xKyBsZXZlbCAqLwo+ICAgCWZvciAo
bGV2ZWwgPSAxOyBsZXZlbCA8PSBtYXhfbGV2ZWw7IGxldmVsKyspIHsKPiAgIAkJc3RydWN0IGlu
dGVsX3dtX2xldmVsICp3bSA9ICZtZXJnZWQtPndtW2xldmVsXTsKPiAgIAo+IC0JCWlsa19tZXJn
ZV93bV9sZXZlbChkZXZfcHJpdiwgbGV2ZWwsIHdtKTsKPiArCQlpbGtfbWVyZ2Vfd21fbGV2ZWwo
aTkxNSwgbGV2ZWwsIHdtKTsKPiAgIAo+ICAgCQlpZiAobGV2ZWwgPiBsYXN0X2VuYWJsZWRfbGV2
ZWwpCj4gICAJCQl3bS0+ZW5hYmxlID0gZmFsc2U7Cj4gQEAgLTMzMjAsOCArMzMyMCw4IEBAIHN0
YXRpYyB2b2lkIGlsa193bV9tZXJnZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gICAJICogV2hhdCB3ZSBzaG91bGQgY2hlY2sgaGVyZSBpcyB3aGV0aGVyIEZCQyBjYW4gYmUK
PiAgIAkgKiBlbmFibGVkIHNvbWV0aW1lIGxhdGVyLgo+ICAgCSAqLwo+IC0JaWYgKElTX0dFTihk
ZXZfcHJpdiwgNSkgJiYgIW1lcmdlZC0+ZmJjX3dtX2VuYWJsZWQgJiYKPiAtCSAgICBpbnRlbF9m
YmNfaXNfYWN0aXZlKGRldl9wcml2KSkgewo+ICsJaWYgKElTX0dFTihpOTE1LCA1KSAmJiAhbWVy
Z2VkLT5mYmNfd21fZW5hYmxlZCAmJgo+ICsJICAgIGludGVsX2ZiY19pc19hY3RpdmUoaTkxNSkp
IHsKPiAgIAkJZm9yIChsZXZlbCA9IDI7IGxldmVsIDw9IG1heF9sZXZlbDsgbGV2ZWwrKykgewo+
ICAgCQkJc3RydWN0IGludGVsX3dtX2xldmVsICp3bSA9ICZtZXJnZWQtPndtW2xldmVsXTsKPiAg
IAo+IEBAIC0zMzM3LDE2ICszMzM3LDE2IEBAIHN0YXRpYyBpbnQgaWxrX3dtX2xwX3RvX2xldmVs
KGludCB3bV9scCwgY29uc3Qgc3RydWN0IGludGVsX3BpcGVfd20gKnBpcGVfd20pCj4gICB9Cj4g
ICAKPiAgIC8qIFRoZSB2YWx1ZSB3ZSBuZWVkIHRvIHByb2dyYW0gaW50byB0aGUgV01fTFB4IGxh
dGVuY3kgZmllbGQgKi8KPiAtc3RhdGljIHVuc2lnbmVkIGludCBpbGtfd21fbHBfbGF0ZW5jeShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB1bnNpZ25lZCBpbnQg
aWxrX3dtX2xwX2xhdGVuY3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJ
ICAgICAgaW50IGxldmVsKQo+ICAgewo+IC0JaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElT
X0JST0FEV0VMTChkZXZfcHJpdikpCj4gKwlpZiAoSVNfSEFTV0VMTChpOTE1KSB8fCBJU19CUk9B
RFdFTEwoaTkxNSkpCj4gICAJCXJldHVybiAyICogbGV2ZWw7Cj4gICAJZWxzZQo+IC0JCXJldHVy
biBkZXZfcHJpdi0+d20ucHJpX2xhdGVuY3lbbGV2ZWxdOwo+ICsJCXJldHVybiBpOTE1LT53bS5w
cmlfbGF0ZW5jeVtsZXZlbF07Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaWxrX2NvbXB1dGVf
d21fcmVzdWx0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2
b2lkIGlsa19jb21wdXRlX3dtX3Jlc3VsdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gICAJCQkJICAgY29uc3Qgc3RydWN0IGludGVsX3BpcGVfd20gKm1lcmdlZCwKPiAgIAkJCQkg
ICBlbnVtIGludGVsX2RkYl9wYXJ0aXRpb25pbmcgcGFydGl0aW9uaW5nLAo+ICAgCQkJCSAgIHN0
cnVjdCBpbGtfd21fdmFsdWVzICpyZXN1bHRzKQo+IEBAIC0zMzcwLDE0ICszMzcwLDE0IEBAIHN0
YXRpYyB2b2lkIGlsa19jb21wdXRlX3dtX3Jlc3VsdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICAgCQkgKiBkaXNhYmxlZC4gRG9pbmcgb3RoZXJ3aXNlIGNvdWxkIGNhdXNl
IHVuZGVycnVucy4KPiAgIAkJICovCj4gICAJCXJlc3VsdHMtPndtX2xwW3dtX2xwIC0gMV0gPQo+
IC0JCQkoaWxrX3dtX2xwX2xhdGVuY3koZGV2X3ByaXYsIGxldmVsKSA8PCBXTTFfTFBfTEFURU5D
WV9TSElGVCkgfAo+ICsJCQkoaWxrX3dtX2xwX2xhdGVuY3koaTkxNSwgbGV2ZWwpIDw8IFdNMV9M
UF9MQVRFTkNZX1NISUZUKSB8Cj4gICAJCQkoci0+cHJpX3ZhbCA8PCBXTTFfTFBfU1JfU0hJRlQp
IHwKPiAgIAkJCXItPmN1cl92YWw7Cj4gICAKPiAgIAkJaWYgKHItPmVuYWJsZSkKPiAgIAkJCXJl
c3VsdHMtPndtX2xwW3dtX2xwIC0gMV0gfD0gV00xX0xQX1NSX0VOOwo+ICAgCj4gLQkJaWYgKElO
VEVMX0dFTihkZXZfcHJpdikgPj0gOCkKPiArCQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDgpCj4g
ICAJCQlyZXN1bHRzLT53bV9scFt3bV9scCAtIDFdIHw9Cj4gICAJCQkJci0+ZmJjX3ZhbCA8PCBX
TTFfTFBfRkJDX1NISUZUX0JEVzsKPiAgIAkJZWxzZQo+IEBAIC0zMzg4LDcgKzMzODgsNyBAQCBz
dGF0aWMgdm9pZCBpbGtfY29tcHV0ZV93bV9yZXN1bHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiAgIAkJICogQWx3YXlzIHNldCBXTTFTX0xQX0VOIHdoZW4gc3ByX3ZhbCAh
PSAwLCBldmVuIGlmIHRoZQo+ICAgCQkgKiBsZXZlbCBpcyBkaXNhYmxlZC4gRG9pbmcgb3RoZXJ3
aXNlIGNvdWxkIGNhdXNlIHVuZGVycnVucy4KPiAgIAkJICovCj4gLQkJaWYgKElOVEVMX0dFTihk
ZXZfcHJpdikgPD0gNiAmJiByLT5zcHJfdmFsKSB7Cj4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA8
PSA2ICYmIHItPnNwcl92YWwpIHsKPiAgIAkJCVdBUk5fT04od21fbHAgIT0gMSk7Cj4gICAJCQly
ZXN1bHRzLT53bV9scF9zcHJbd21fbHAgLSAxXSA9IFdNMVNfTFBfRU4gfCByLT5zcHJfdmFsOwo+
ICAgCQl9IGVsc2UKPiBAQCAtMzM5Niw3ICszMzk2LDcgQEAgc3RhdGljIHZvaWQgaWxrX2NvbXB1
dGVfd21fcmVzdWx0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJfQo+
ICAgCj4gICAJLyogTFAwIHJlZ2lzdGVyIHZhbHVlcyAqLwo+IC0JZm9yX2VhY2hfaW50ZWxfY3J0
YygmZGV2X3ByaXYtPmRybSwgaW50ZWxfY3J0Yykgewo+ICsJZm9yX2VhY2hfaW50ZWxfY3J0Yygm
aTkxNS0+ZHJtLCBpbnRlbF9jcnRjKSB7Cj4gICAJCWVudW0gcGlwZSBwaXBlID0gaW50ZWxfY3J0
Yy0+cGlwZTsKPiAgIAkJY29uc3Qgc3RydWN0IGludGVsX3dtX2xldmVsICpyID0KPiAgIAkJCSZp
bnRlbF9jcnRjLT53bS5hY3RpdmUuaWxrLndtWzBdOwo+IEBAIC0zNDE2LDExICszNDE2LDExIEBA
IHN0YXRpYyB2b2lkIGlsa19jb21wdXRlX3dtX3Jlc3VsdHMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ICAgLyogRmluZCB0aGUgcmVzdWx0IHdpdGggdGhlIGhpZ2hlc3QgbGV2
ZWwgZW5hYmxlZC4gQ2hlY2sgZm9yIGVuYWJsZV9mYmNfd20gaW4KPiAgICAqIGNhc2UgYm90aCBh
cmUgYXQgdGhlIHNhbWUgbGV2ZWwuIFByZWZlciByMSBpbiBjYXNlIHRoZXkncmUgdGhlIHNhbWUu
ICovCj4gICBzdGF0aWMgc3RydWN0IGludGVsX3BpcGVfd20gKgo+IC1pbGtfZmluZF9iZXN0X3Jl
c3VsdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2lsa19maW5kX2Jlc3Rf
cmVzdWx0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkgICAgIHN0cnVjdCBp
bnRlbF9waXBlX3dtICpyMSwKPiAgIAkJICAgICBzdHJ1Y3QgaW50ZWxfcGlwZV93bSAqcjIpCj4g
ICB7Cj4gLQlpbnQgbGV2ZWwsIG1heF9sZXZlbCA9IGlsa193bV9tYXhfbGV2ZWwoZGV2X3ByaXYp
Owo+ICsJaW50IGxldmVsLCBtYXhfbGV2ZWwgPSBpbGtfd21fbWF4X2xldmVsKGk5MTUpOwo+ICAg
CWludCBsZXZlbDEgPSAwLCBsZXZlbDIgPSAwOwo+ICAgCj4gICAJZm9yIChsZXZlbCA9IDE7IGxl
dmVsIDw9IG1heF9sZXZlbDsgbGV2ZWwrKykgewo+IEBAIC0zNDUwLDcgKzM0NTAsNyBAQCBpbGtf
ZmluZF9iZXN0X3Jlc3VsdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAj
ZGVmaW5lIFdNX0RJUlRZX0ZCQyAoMSA8PCAyNCkKPiAgICNkZWZpbmUgV01fRElSVFlfRERCICgx
IDw8IDI1KQo+ICAgCj4gLXN0YXRpYyB1bnNpZ25lZCBpbnQgaWxrX2NvbXB1dGVfd21fZGlydHko
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdW5zaWduZWQgaW50
IGlsa19jb21wdXRlX3dtX2RpcnR5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAg
CQkJCQkgY29uc3Qgc3RydWN0IGlsa193bV92YWx1ZXMgKm9sZCwKPiAgIAkJCQkJIGNvbnN0IHN0
cnVjdCBpbGtfd21fdmFsdWVzICpuZXcpCj4gICB7Cj4gQEAgLTM0NTgsNyArMzQ1OCw3IEBAIHN0
YXRpYyB1bnNpZ25lZCBpbnQgaWxrX2NvbXB1dGVfd21fZGlydHkoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ICAgCWVudW0gcGlwZSBwaXBlOwo+ICAgCWludCB3bV9scDsKPiAg
IAo+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkgewo+ICsJZm9yX2VhY2hfcGlwZShp
OTE1LCBwaXBlKSB7Cj4gICAJCWlmIChvbGQtPndtX2xpbmV0aW1lW3BpcGVdICE9IG5ldy0+d21f
bGluZXRpbWVbcGlwZV0pIHsKPiAgIAkJCWRpcnR5IHw9IFdNX0RJUlRZX0xJTkVUSU1FKHBpcGUp
Owo+ICAgCQkJLyogTXVzdCBkaXNhYmxlIExQMSsgd2F0ZXJtYXJrcyB0b28gKi8KPiBAQCAtMzUw
MiwxMCArMzUwMiwxMCBAQCBzdGF0aWMgdW5zaWduZWQgaW50IGlsa19jb21wdXRlX3dtX2RpcnR5
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlyZXR1cm4gZGlydHk7Cj4g
ICB9Cj4gICAKPiAtc3RhdGljIGJvb2wgX2lsa19kaXNhYmxlX2xwX3dtKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGljIGJvb2wgX2lsa19kaXNhYmxlX2xwX3dtKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgICAgIHVuc2lnbmVkIGludCBk
aXJ0eSkKPiAgIHsKPiAtCXN0cnVjdCBpbGtfd21fdmFsdWVzICpwcmV2aW91cyA9ICZkZXZfcHJp
di0+d20uaHc7Cj4gKwlzdHJ1Y3QgaWxrX3dtX3ZhbHVlcyAqcHJldmlvdXMgPSAmaTkxNS0+d20u
aHc7Cj4gICAJYm9vbCBjaGFuZ2VkID0gZmFsc2U7Cj4gICAKPiAgIAlpZiAoZGlydHkgJiBXTV9E
SVJUWV9MUCgzKSAmJiBwcmV2aW91cy0+d21fbHBbMl0gJiBXTTFfTFBfU1JfRU4pIHsKPiBAQCAt
MzUzNiwxOCArMzUzNiwxOCBAQCBzdGF0aWMgYm9vbCBfaWxrX2Rpc2FibGVfbHBfd20oc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgICogVGhlIHNwZWMgc2F5cyB3ZSBzaG91
bGRuJ3Qgd3JpdGUgd2hlbiB3ZSBkb24ndCBuZWVkLCBiZWNhdXNlIGV2ZXJ5IHdyaXRlCj4gICAg
KiBjYXVzZXMgV01zIHRvIGJlIHJlLWV2YWx1YXRlZCwgZXhwZW5kaW5nIHNvbWUgcG93ZXIuCj4g
ICAgKi8KPiAtc3RhdGljIHZvaWQgaWxrX3dyaXRlX3dtX3ZhbHVlcyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGlsa193cml0ZV93bV92YWx1ZXMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJc3RydWN0IGlsa193bV92YWx1ZXMg
KnJlc3VsdHMpCj4gICB7Cj4gLQlzdHJ1Y3QgaWxrX3dtX3ZhbHVlcyAqcHJldmlvdXMgPSAmZGV2
X3ByaXYtPndtLmh3Owo+ICsJc3RydWN0IGlsa193bV92YWx1ZXMgKnByZXZpb3VzID0gJmk5MTUt
PndtLmh3Owo+ICAgCXVuc2lnbmVkIGludCBkaXJ0eTsKPiAgIAl1MzIgdmFsOwo+ICAgCj4gLQlk
aXJ0eSA9IGlsa19jb21wdXRlX3dtX2RpcnR5KGRldl9wcml2LCBwcmV2aW91cywgcmVzdWx0cyk7
Cj4gKwlkaXJ0eSA9IGlsa19jb21wdXRlX3dtX2RpcnR5KGk5MTUsIHByZXZpb3VzLCByZXN1bHRz
KTsKPiAgIAlpZiAoIWRpcnR5KQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCV9pbGtfZGlzYWJsZV9s
cF93bShkZXZfcHJpdiwgZGlydHkpOwo+ICsJX2lsa19kaXNhYmxlX2xwX3dtKGk5MTUsIGRpcnR5
KTsKPiAgIAo+ICAgCWlmIChkaXJ0eSAmIFdNX0RJUlRZX1BJUEUoUElQRV9BKSkKPiAgIAkJSTkx
NV9XUklURShXTTBfUElQRUFfSUxLLCByZXN1bHRzLT53bV9waXBlWzBdKTsKPiBAQCAtMzU2NCw3
ICszNTY0LDcgQEAgc3RhdGljIHZvaWQgaWxrX3dyaXRlX3dtX3ZhbHVlcyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJCUk5MTVfV1JJVEUoUElQRV9XTV9MSU5FVElNRShQ
SVBFX0MpLCByZXN1bHRzLT53bV9saW5ldGltZVsyXSk7Cj4gICAKPiAgIAlpZiAoZGlydHkgJiBX
TV9ESVJUWV9EREIpIHsKPiAtCQlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgfHwgSVNfQlJPQURX
RUxMKGRldl9wcml2KSkgewo+ICsJCWlmIChJU19IQVNXRUxMKGk5MTUpIHx8IElTX0JST0FEV0VM
TChpOTE1KSkgewo+ICAgCQkJdmFsID0gSTkxNV9SRUFEKFdNX01JU0MpOwo+ICAgCQkJaWYgKHJl
c3VsdHMtPnBhcnRpdGlvbmluZyA9PSBJTlRFTF9EREJfUEFSVF8xXzIpCj4gICAJCQkJdmFsICY9
IH5XTV9NSVNDX0RBVEFfUEFSVElUSU9OXzVfNjsKPiBAQCAtMzU5NCw3ICszNTk0LDcgQEAgc3Rh
dGljIHZvaWQgaWxrX3dyaXRlX3dtX3ZhbHVlcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gICAJICAgIHByZXZpb3VzLT53bV9scF9zcHJbMF0gIT0gcmVzdWx0cy0+d21fbHBf
c3ByWzBdKQo+ICAgCQlJOTE1X1dSSVRFKFdNMVNfTFBfSUxLLCByZXN1bHRzLT53bV9scF9zcHJb
MF0pOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA3KSB7Cj4gKwlpZiAoSU5U
RUxfR0VOKGk5MTUpID49IDcpIHsKPiAgIAkJaWYgKGRpcnR5ICYgV01fRElSVFlfTFAoMikgJiYg
cHJldmlvdXMtPndtX2xwX3NwclsxXSAhPSByZXN1bHRzLT53bV9scF9zcHJbMV0pCj4gICAJCQlJ
OTE1X1dSSVRFKFdNMlNfTFBfSVZCLCByZXN1bHRzLT53bV9scF9zcHJbMV0pOwo+ICAgCQlpZiAo
ZGlydHkgJiBXTV9ESVJUWV9MUCgzKSAmJiBwcmV2aW91cy0+d21fbHBfc3ByWzJdICE9IHJlc3Vs
dHMtPndtX2xwX3NwclsyXSkKPiBAQCAtMzYwOCwxNyArMzYwOCwxNyBAQCBzdGF0aWMgdm9pZCBp
bGtfd3JpdGVfd21fdmFsdWVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAg
IAlpZiAoZGlydHkgJiBXTV9ESVJUWV9MUCgzKSAmJiBwcmV2aW91cy0+d21fbHBbMl0gIT0gcmVz
dWx0cy0+d21fbHBbMl0pCj4gICAJCUk5MTVfV1JJVEUoV00zX0xQX0lMSywgcmVzdWx0cy0+d21f
bHBbMl0pOwo+ICAgCj4gLQlkZXZfcHJpdi0+d20uaHcgPSAqcmVzdWx0czsKPiArCWk5MTUtPndt
Lmh3ID0gKnJlc3VsdHM7Cj4gICB9Cj4gICAKPiAgIGJvb2wgaWxrX2Rpc2FibGVfbHBfd20oc3Ry
dWN0IGRybV9kZXZpY2UgKmRldikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShkZXYpOwo+ICAgCj4gLQlyZXR1cm4gX2lsa19kaXNhYmxlX2xwX3dtKGRldl9w
cml2LCBXTV9ESVJUWV9MUF9BTEwpOwo+ICsJcmV0dXJuIF9pbGtfZGlzYWJsZV9scF93bShpOTE1
LCBXTV9ESVJUWV9MUF9BTEwpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB1OCBpbnRlbF9lbmFibGVk
X2RidWZfc2xpY2VzX251bShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0
YXRpYyB1OCBpbnRlbF9lbmFibGVkX2RidWZfc2xpY2VzX251bShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAl1OCBlbmFibGVkX3NsaWNlczsKPiAgIAo+IEBAIC0zNjI2
LDcgKzM2MjYsNyBAQCBzdGF0aWMgdTggaW50ZWxfZW5hYmxlZF9kYnVmX3NsaWNlc19udW0oc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCWVuYWJsZWRfc2xpY2VzID0gMTsK
PiAgIAo+ICAgCS8qIEdlbiBwcmlvciB0byBHRU4xMSBoYXZlIG9ubHkgb25lIERCdWYgc2xpY2Ug
Ki8KPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgMTEpCj4gKwlpZiAoSU5URUxfR0VOKGk5
MTUpIDwgMTEpCj4gICAJCXJldHVybiBlbmFibGVkX3NsaWNlczsKPiAgIAo+ICAgCS8qCj4gQEAg
LTM2NDQsMTYgKzM2NDQsMTYgQEAgc3RhdGljIHU4IGludGVsX2VuYWJsZWRfZGJ1Zl9zbGljZXNf
bnVtKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgICAqIEZJWE1FOiBXZSBz
dGlsbCBkb24ndCBoYXZlIHRoZSBwcm9wZXIgY29kZSBkZXRlY3QgaWYgd2UgbmVlZCB0byBhcHBs
eSB0aGUgV0EsCj4gICAgKiBzbyBhc3N1bWUgd2UnbGwgYWx3YXlzIG5lZWQgaXQgaW4gb3JkZXIg
dG8gYXZvaWQgdW5kZXJydW5zLgo+ICAgICovCj4gLXN0YXRpYyBib29sIHNrbF9uZWVkc19tZW1v
cnlfYndfd2Eoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgYm9v
bCBza2xfbmVlZHNfbWVtb3J5X2J3X3dhKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ICAgewo+IC0JcmV0dXJuIElTX0dFTjlfQkMoZGV2X3ByaXYpIHx8IElTX0JST1hUT04oZGV2X3By
aXYpOwo+ICsJcmV0dXJuIElTX0dFTjlfQkMoaTkxNSkgfHwgSVNfQlJPWFRPTihpOTE1KTsKPiAg
IH0KPiAgIAo+ICAgc3RhdGljIGJvb2wKPiAtaW50ZWxfaGFzX3NhZ3Yoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ICtpbnRlbF9oYXNfc2FndihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXJldHVybiAoSVNfR0VOOV9CQyhkZXZfcHJpdikgfHwgSU5U
RUxfR0VOKGRldl9wcml2KSA+PSAxMCkgJiYKPiAtCQlkZXZfcHJpdi0+c2Fndl9zdGF0dXMgIT0g
STkxNV9TQUdWX05PVF9DT05UUk9MTEVEOwo+ICsJcmV0dXJuIChJU19HRU45X0JDKGk5MTUpIHx8
IElOVEVMX0dFTihpOTE1KSA+PSAxMCkgJiYKPiArCQlpOTE1LT5zYWd2X3N0YXR1cyAhPSBJOTE1
X1NBR1ZfTk9UX0NPTlRST0xMRUQ7Cj4gICB9Cj4gICAKPiAgIC8qCj4gQEAgLTM2NjgsMTggKzM2
NjgsMTggQEAgaW50ZWxfaGFzX3NhZ3Yoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ICAgICogIC0gV2UncmUgbm90IHVzaW5nIGFuIGludGVybGFjZWQgZGlzcGxheSBjb25maWd1
cmF0aW9uCj4gICAgKi8KPiAgIGludAo+IC1pbnRlbF9lbmFibGVfc2FndihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK2ludGVsX2VuYWJsZV9zYWd2KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCWludCByZXQ7Cj4gICAKPiAtCWlmICghaW50ZWxf
aGFzX3NhZ3YoZGV2X3ByaXYpKQo+ICsJaWYgKCFpbnRlbF9oYXNfc2FndihpOTE1KSkKPiAgIAkJ
cmV0dXJuIDA7Cj4gICAKPiAtCWlmIChkZXZfcHJpdi0+c2Fndl9zdGF0dXMgPT0gSTkxNV9TQUdW
X0VOQUJMRUQpCj4gKwlpZiAoaTkxNS0+c2Fndl9zdGF0dXMgPT0gSTkxNV9TQUdWX0VOQUJMRUQp
Cj4gICAJCXJldHVybiAwOwo+ICAgCj4gICAJRFJNX0RFQlVHX0tNUygiRW5hYmxpbmcgU0FHVlxu
Iik7Cj4gLQlyZXQgPSBzYW5keWJyaWRnZV9wY29kZV93cml0ZShkZXZfcHJpdiwgR0VOOV9QQ09E
RV9TQUdWX0NPTlRST0wsCj4gKwlyZXQgPSBzYW5keWJyaWRnZV9wY29kZV93cml0ZShpOTE1LCBH
RU45X1BDT0RFX1NBR1ZfQ09OVFJPTCwKPiAgIAkJCQkgICAgICBHRU45X1NBR1ZfRU5BQkxFKTsK
PiAgIAo+ICAgCS8qIFdlIGRvbid0IG5lZWQgdG8gd2FpdCBmb3IgU0FHViB3aGVuIGVuYWJsaW5n
ICovCj4gQEAgLTM2ODgsMzMgKzM2ODgsMzMgQEAgaW50ZWxfZW5hYmxlX3NhZ3Yoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCSAqIFNvbWUgc2tsIHN5c3RlbXMsIHByZS1y
ZWxlYXNlIG1hY2hpbmVzIGluIHBhcnRpY3VsYXIsCj4gICAJICogZG9uJ3QgYWN0dWFsbHkgaGF2
ZSBTQUdWLgo+ICAgCSAqLwo+IC0JaWYgKElTX1NLWUxBS0UoZGV2X3ByaXYpICYmIHJldCA9PSAt
RU5YSU8pIHsKPiArCWlmIChJU19TS1lMQUtFKGk5MTUpICYmIHJldCA9PSAtRU5YSU8pIHsKPiAg
IAkJRFJNX0RFQlVHX0RSSVZFUigiTm8gU0FHViBmb3VuZCBvbiBzeXN0ZW0sIGlnbm9yaW5nXG4i
KTsKPiAtCQlkZXZfcHJpdi0+c2Fndl9zdGF0dXMgPSBJOTE1X1NBR1ZfTk9UX0NPTlRST0xMRUQ7
Cj4gKwkJaTkxNS0+c2Fndl9zdGF0dXMgPSBJOTE1X1NBR1ZfTk9UX0NPTlRST0xMRUQ7Cj4gICAJ
CXJldHVybiAwOwo+ICAgCX0gZWxzZSBpZiAocmV0IDwgMCkgewo+ICAgCQlEUk1fRVJST1IoIkZh
aWxlZCB0byBlbmFibGUgU0FHVlxuIik7Cj4gICAJCXJldHVybiByZXQ7Cj4gICAJfQo+ICAgCj4g
LQlkZXZfcHJpdi0+c2Fndl9zdGF0dXMgPSBJOTE1X1NBR1ZfRU5BQkxFRDsKPiArCWk5MTUtPnNh
Z3Zfc3RhdHVzID0gSTkxNV9TQUdWX0VOQUJMRUQ7Cj4gICAJcmV0dXJuIDA7Cj4gICB9Cj4gICAK
PiAgIGludAo+IC1pbnRlbF9kaXNhYmxlX3NhZ3Yoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ICtpbnRlbF9kaXNhYmxlX3NhZ3Yoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCj4gICB7Cj4gICAJaW50IHJldDsKPiAgIAo+IC0JaWYgKCFpbnRlbF9oYXNfc2FndihkZXZf
cHJpdikpCj4gKwlpZiAoIWludGVsX2hhc19zYWd2KGk5MTUpKQo+ICAgCQlyZXR1cm4gMDsKPiAg
IAo+IC0JaWYgKGRldl9wcml2LT5zYWd2X3N0YXR1cyA9PSBJOTE1X1NBR1ZfRElTQUJMRUQpCj4g
KwlpZiAoaTkxNS0+c2Fndl9zdGF0dXMgPT0gSTkxNV9TQUdWX0RJU0FCTEVEKQo+ICAgCQlyZXR1
cm4gMDsKPiAgIAo+ICAgCURSTV9ERUJVR19LTVMoIkRpc2FibGluZyBTQUdWXG4iKTsKPiAgIAkv
KiBic3BlYyBzYXlzIHRvIGtlZXAgcmV0cnlpbmcgZm9yIGF0IGxlYXN0IDEgbXMgKi8KPiAtCXJl
dCA9IHNrbF9wY29kZV9yZXF1ZXN0KGRldl9wcml2LCBHRU45X1BDT0RFX1NBR1ZfQ09OVFJPTCwK
PiArCXJldCA9IHNrbF9wY29kZV9yZXF1ZXN0KGk5MTUsIEdFTjlfUENPREVfU0FHVl9DT05UUk9M
LAo+ICAgCQkJCUdFTjlfU0FHVl9ESVNBQkxFLAo+ICAgCQkJCUdFTjlfU0FHVl9JU19ESVNBQkxF
RCwgR0VOOV9TQUdWX0lTX0RJU0FCTEVELAo+ICAgCQkJCTEpOwo+IEBAIC0zNzIyLDIzICszNzIy
LDIzIEBAIGludGVsX2Rpc2FibGVfc2FndihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gICAJICogU29tZSBza2wgc3lzdGVtcywgcHJlLXJlbGVhc2UgbWFjaGluZXMgaW4gcGFy
dGljdWxhciwKPiAgIAkgKiBkb24ndCBhY3R1YWxseSBoYXZlIFNBR1YuCj4gICAJICovCj4gLQlp
ZiAoSVNfU0tZTEFLRShkZXZfcHJpdikgJiYgcmV0ID09IC1FTlhJTykgewo+ICsJaWYgKElTX1NL
WUxBS0UoaTkxNSkgJiYgcmV0ID09IC1FTlhJTykgewo+ICAgCQlEUk1fREVCVUdfRFJJVkVSKCJO
byBTQUdWIGZvdW5kIG9uIHN5c3RlbSwgaWdub3JpbmdcbiIpOwo+IC0JCWRldl9wcml2LT5zYWd2
X3N0YXR1cyA9IEk5MTVfU0FHVl9OT1RfQ09OVFJPTExFRDsKPiArCQlpOTE1LT5zYWd2X3N0YXR1
cyA9IEk5MTVfU0FHVl9OT1RfQ09OVFJPTExFRDsKPiAgIAkJcmV0dXJuIDA7Cj4gICAJfSBlbHNl
IGlmIChyZXQgPCAwKSB7Cj4gICAJCURSTV9FUlJPUigiRmFpbGVkIHRvIGRpc2FibGUgU0FHViAo
JWQpXG4iLCByZXQpOwo+ICAgCQlyZXR1cm4gcmV0Owo+ICAgCX0KPiAgIAo+IC0JZGV2X3ByaXYt
PnNhZ3Zfc3RhdHVzID0gSTkxNV9TQUdWX0RJU0FCTEVEOwo+ICsJaTkxNS0+c2Fndl9zdGF0dXMg
PSBJOTE1X1NBR1ZfRElTQUJMRUQ7Cj4gICAJcmV0dXJuIDA7Cj4gICB9Cj4gICAKPiAgIGJvb2wg
aW50ZWxfY2FuX2VuYWJsZV9zYWd2KHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAg
IHsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gc3RhdGUtPmRldjsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9hdG9t
aWNfc3RhdGUgKmludGVsX3N0YXRlID0gdG9faW50ZWxfYXRvbWljX3N0YXRlKHN0YXRlKTsKPiAg
IAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsKPiAgIAlzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5l
Owo+IEBAIC0zNzQ3LDEyICszNzQ3LDEyIEBAIGJvb2wgaW50ZWxfY2FuX2VuYWJsZV9zYWd2KHN0
cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgIAlpbnQgbGV2ZWwsIGxhdGVuY3k7Cj4g
ICAJaW50IHNhZ3ZfYmxvY2tfdGltZV91czsKPiAgIAo+IC0JaWYgKCFpbnRlbF9oYXNfc2Fndihk
ZXZfcHJpdikpCj4gKwlpZiAoIWludGVsX2hhc19zYWd2KGk5MTUpKQo+ICAgCQlyZXR1cm4gZmFs
c2U7Cj4gICAKPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDkpKQo+ICsJaWYgKElTX0dFTihpOTE1
LCA5KSkKPiAgIAkJc2Fndl9ibG9ja190aW1lX3VzID0gMzA7Cj4gLQllbHNlIGlmIChJU19HRU4o
ZGV2X3ByaXYsIDEwKSkKPiArCWVsc2UgaWYgKElTX0dFTihpOTE1LCAxMCkpCj4gICAJCXNhZ3Zf
YmxvY2tfdGltZV91cyA9IDIwOwo+ICAgCWVsc2UKPiAgIAkJc2Fndl9ibG9ja190aW1lX3VzID0g
MTA7Cj4gQEAgLTM3NzIsNyArMzc3Miw3IEBAIGJvb2wgaW50ZWxfY2FuX2VuYWJsZV9zYWd2KHN0
cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgIAo+ICAgCS8qIFNpbmNlIHdlJ3JlIG5v
dyBndWFyYW50ZWVkIHRvIG9ubHkgaGF2ZSBvbmUgYWN0aXZlIENSVEMuLi4gKi8KPiAgIAlwaXBl
ID0gZmZzKGludGVsX3N0YXRlLT5hY3RpdmVfY3J0Y3MpIC0gMTsKPiAtCWNydGMgPSBpbnRlbF9n
ZXRfY3J0Y19mb3JfcGlwZShkZXZfcHJpdiwgcGlwZSk7Cj4gKwljcnRjID0gaW50ZWxfZ2V0X2Ny
dGNfZm9yX3BpcGUoaTkxNSwgcGlwZSk7Cj4gICAJY3N0YXRlID0gdG9faW50ZWxfY3J0Y19zdGF0
ZShjcnRjLT5iYXNlLnN0YXRlKTsKPiAgIAo+ICAgCWlmIChjcnRjLT5iYXNlLnN0YXRlLT5hZGp1
c3RlZF9tb2RlLmZsYWdzICYgRFJNX01PREVfRkxBR19JTlRFUkxBQ0UpCj4gQEAgLTM3ODcsMTMg
KzM3ODcsMTMgQEAgYm9vbCBpbnRlbF9jYW5fZW5hYmxlX3NhZ3Yoc3RydWN0IGRybV9hdG9taWNf
c3RhdGUgKnN0YXRlKQo+ICAgCQkJY29udGludWU7Cj4gICAKPiAgIAkJLyogRmluZCB0aGUgaGln
aGVzdCBlbmFibGVkIHdtIGxldmVsIGZvciB0aGlzIHBsYW5lICovCj4gLQkJZm9yIChsZXZlbCA9
IGlsa193bV9tYXhfbGV2ZWwoZGV2X3ByaXYpOwo+ICsJCWZvciAobGV2ZWwgPSBpbGtfd21fbWF4
X2xldmVsKGk5MTUpOwo+ICAgCQkgICAgICF3bS0+d21bbGV2ZWxdLnBsYW5lX2VuOyAtLWxldmVs
KQo+ICAgCQkgICAgIHsgfQo+ICAgCj4gLQkJbGF0ZW5jeSA9IGRldl9wcml2LT53bS5za2xfbGF0
ZW5jeVtsZXZlbF07Cj4gKwkJbGF0ZW5jeSA9IGk5MTUtPndtLnNrbF9sYXRlbmN5W2xldmVsXTsK
PiAgIAo+IC0JCWlmIChza2xfbmVlZHNfbWVtb3J5X2J3X3dhKGRldl9wcml2KSAmJgo+ICsJCWlm
IChza2xfbmVlZHNfbWVtb3J5X2J3X3dhKGk5MTUpICYmCj4gICAJCSAgICBwbGFuZS0+YmFzZS5z
dGF0ZS0+ZmItPm1vZGlmaWVyID09Cj4gICAJCSAgICBJOTE1X0ZPUk1BVF9NT0RfWF9USUxFRCkK
PiAgIAkJCWxhdGVuY3kgKz0gMTU7Cj4gQEAgLTM4MTAsNyArMzgxMCw3IEBAIGJvb2wgaW50ZWxf
Y2FuX2VuYWJsZV9zYWd2KHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgIAlyZXR1
cm4gdHJ1ZTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdTE2IGludGVsX2dldF9kZGJfc2l6ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB1MTYgaW50ZWxfZ2V0X2Rk
Yl9zaXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgICAgY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiAgIAkJCSAgICAgIGNvbnN0IHU2NCB0
b3RhbF9kYXRhX3JhdGUsCj4gICAJCQkgICAgICBjb25zdCBpbnQgbnVtX2FjdGl2ZSwKPiBAQCAt
MzgxOCwxMSArMzgxOCwxMSBAQCBzdGF0aWMgdTE2IGludGVsX2dldF9kZGJfc2l6ZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICB7Cj4gICAJY29uc3Qgc3RydWN0IGRybV9k
aXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGU7Cj4gICAJdTY0IHRvdGFsX2RhdGFfYnc7Cj4gLQl1
MTYgZGRiX3NpemUgPSBJTlRFTF9JTkZPKGRldl9wcml2KS0+ZGRiX3NpemU7Cj4gKwl1MTYgZGRi
X3NpemUgPSBJTlRFTF9JTkZPKGk5MTUpLT5kZGJfc2l6ZTsKPiAgIAo+ICAgCVdBUk5fT04oZGRi
X3NpemUgPT0gMCk7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgMTEpCj4gKwlp
ZiAoSU5URUxfR0VOKGk5MTUpIDwgMTEpCj4gICAJCXJldHVybiBkZGJfc2l6ZSAtIDQ7IC8qIDQg
YmxvY2tzIGZvciBieXBhc3MgcGF0aCBhbGxvY2F0aW9uICovCj4gICAKPiAgIAlhZGp1c3RlZF9t
b2RlID0gJmNzdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+IEBAIC0zODQ3LDcgKzM4NDcsNyBA
QCBzdGF0aWMgdTE2IGludGVsX2dldF9kZGJfc2l6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkCj4gLXNrbF9kZGJfZ2V0X3BpcGVf
YWxsb2NhdGlvbl9saW1pdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtz
a2xfZGRiX2dldF9waXBlX2FsbG9jYXRpb25fbGltaXRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAo+ICAgCQkJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUs
Cj4gICAJCQkJICAgY29uc3QgdTY0IHRvdGFsX2RhdGFfcmF0ZSwKPiAgIAkJCQkgICBzdHJ1Y3Qg
c2tsX2RkYl9hbGxvY2F0aW9uICpkZGIsCj4gQEAgLTM4NjcsMTYgKzM4NjcsMTYgQEAgc2tsX2Rk
Yl9nZXRfcGlwZV9hbGxvY2F0aW9uX2xpbWl0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gICAJaWYgKFdBUk5fT04oIXN0YXRlKSB8fCAhY3N0YXRlLT5iYXNlLmFjdGl2ZSkg
ewo+ICAgCQlhbGxvYy0+c3RhcnQgPSAwOwo+ICAgCQlhbGxvYy0+ZW5kID0gMDsKPiAtCQkqbnVt
X2FjdGl2ZSA9IGh3ZWlnaHQzMihkZXZfcHJpdi0+YWN0aXZlX2NydGNzKTsKPiArCQkqbnVtX2Fj
dGl2ZSA9IGh3ZWlnaHQzMihpOTE1LT5hY3RpdmVfY3J0Y3MpOwo+ICAgCQlyZXR1cm47Cj4gICAJ
fQo+ICAgCj4gICAJaWYgKGludGVsX3N0YXRlLT5hY3RpdmVfcGlwZV9jaGFuZ2VzKQo+ICAgCQkq
bnVtX2FjdGl2ZSA9IGh3ZWlnaHQzMihpbnRlbF9zdGF0ZS0+YWN0aXZlX2NydGNzKTsKPiAgIAll
bHNlCj4gLQkJKm51bV9hY3RpdmUgPSBod2VpZ2h0MzIoZGV2X3ByaXYtPmFjdGl2ZV9jcnRjcyk7
Cj4gKwkJKm51bV9hY3RpdmUgPSBod2VpZ2h0MzIoaTkxNS0+YWN0aXZlX2NydGNzKTsKPiAgIAo+
IC0JZGRiX3NpemUgPSBpbnRlbF9nZXRfZGRiX3NpemUoZGV2X3ByaXYsIGNzdGF0ZSwgdG90YWxf
ZGF0YV9yYXRlLAo+ICsJZGRiX3NpemUgPSBpbnRlbF9nZXRfZGRiX3NpemUoaTkxNSwgY3N0YXRl
LCB0b3RhbF9kYXRhX3JhdGUsCj4gICAJCQkJICAgICAgKm51bV9hY3RpdmUsIGRkYik7Cj4gICAK
PiAgIAkvKgo+IEBAIC0zOTM5LDggKzM5MzksOCBAQCBzdGF0aWMgdW5zaWduZWQgaW50Cj4gICBz
a2xfY3Vyc29yX2FsbG9jYXRpb24oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUsCj4gICAJCSAgICAgIGludCBudW1fYWN0aXZlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRl
dik7Cj4gLQlpbnQgbGV2ZWwsIG1heF9sZXZlbCA9IGlsa193bV9tYXhfbGV2ZWwoZGV2X3ByaXYp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGNfc3RhdGUt
PmJhc2UuY3J0Yy0+ZGV2KTsKPiArCWludCBsZXZlbCwgbWF4X2xldmVsID0gaWxrX3dtX21heF9s
ZXZlbChpOTE1KTsKPiAgIAlzdHJ1Y3Qgc2tsX3dtX2xldmVsIHdtID0ge307Cj4gICAJaW50IHJl
dCwgbWluX2RkYl9hbGxvYyA9IDA7Cj4gICAJc3RydWN0IHNrbF93bV9wYXJhbXMgd3A7Cj4gQEAg
LTM5NjMsNyArMzk2Myw3IEBAIHNrbF9jdXJzb3JfYWxsb2NhdGlvbihjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIAlyZXR1cm4gbWF4KG51bV9hY3RpdmUgPT0g
MSA/IDMyIDogOCwgbWluX2RkYl9hbGxvYyk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgc2ts
X2RkYl9lbnRyeV9pbml0X2Zyb21faHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ICtzdGF0aWMgdm9pZCBza2xfZGRiX2VudHJ5X2luaXRfZnJvbV9odyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAgICAgc3RydWN0IHNrbF9kZGJfZW50cnkgKmVu
dHJ5LCB1MzIgcmVnKQo+ICAgewo+ICAgCj4gQEAgLTM5NzUsNyArMzk3NSw3IEBAIHN0YXRpYyB2
b2lkIHNrbF9kZGJfZW50cnlfaW5pdF9mcm9tX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQKPiAtc2tsX2RkYl9nZXRfaHdfcGxh
bmVfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtza2xfZGRiX2dl
dF9od19wbGFuZV9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAg
IGNvbnN0IGVudW0gcGlwZSBwaXBlLAo+ICAgCQkJICAgY29uc3QgZW51bSBwbGFuZV9pZCBwbGFu
ZV9pZCwKPiAgIAkJCSAgIHN0cnVjdCBza2xfZGRiX2VudHJ5ICpkZGJfeSwKPiBAQCAtMzk4Nyw3
ICszOTg3LDcgQEAgc2tsX2RkYl9nZXRfaHdfcGxhbmVfc3RhdGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ICAgCS8qIEN1cnNvciBkb2Vzbid0IHN1cHBvcnQgTlYxMi9wbGFu
YXIsIHNvIG5vIGV4dHJhIGNhbGN1bGF0aW9uIG5lZWRlZCAqLwo+ICAgCWlmIChwbGFuZV9pZCA9
PSBQTEFORV9DVVJTT1IpIHsKPiAgIAkJdmFsID0gSTkxNV9SRUFEKENVUl9CVUZfQ0ZHKHBpcGUp
KTsKPiAtCQlza2xfZGRiX2VudHJ5X2luaXRfZnJvbV9odyhkZXZfcHJpdiwgZGRiX3ksIHZhbCk7
Cj4gKwkJc2tsX2RkYl9lbnRyeV9pbml0X2Zyb21faHcoaTkxNSwgZGRiX3ksIHZhbCk7Cj4gICAJ
CXJldHVybjsKPiAgIAl9Cj4gICAKPiBAQCAtMzk5OSw5ICszOTk5LDkgQEAgc2tsX2RkYl9nZXRf
aHdfcGxhbmVfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCQkJ
CQkgICAgICB2YWwgJiBQTEFORV9DVExfT1JERVJfUkdCWCwKPiAgIAkJCQkJICAgICAgdmFsICYg
UExBTkVfQ1RMX0FMUEhBX01BU0spOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+
PSAxMSkgewo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkgewo+ICAgCQl2YWwgPSBJOTE1
X1JFQUQoUExBTkVfQlVGX0NGRyhwaXBlLCBwbGFuZV9pZCkpOwo+IC0JCXNrbF9kZGJfZW50cnlf
aW5pdF9mcm9tX2h3KGRldl9wcml2LCBkZGJfeSwgdmFsKTsKPiArCQlza2xfZGRiX2VudHJ5X2lu
aXRfZnJvbV9odyhpOTE1LCBkZGJfeSwgdmFsKTsKPiAgIAl9IGVsc2Ugewo+ICAgCQl2YWwgPSBJ
OTE1X1JFQUQoUExBTkVfQlVGX0NGRyhwaXBlLCBwbGFuZV9pZCkpOwo+ICAgCQl2YWwyID0gSTkx
NV9SRUFEKFBMQU5FX05WMTJfQlVGX0NGRyhwaXBlLCBwbGFuZV9pZCkpOwo+IEBAIC00MDA5LDgg
KzQwMDksOCBAQCBza2xfZGRiX2dldF9od19wbGFuZV9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gICAJCWlmIChpc19wbGFuYXJfeXV2X2Zvcm1hdChmb3VyY2MpKQo+
ICAgCQkJc3dhcCh2YWwsIHZhbDIpOwo+ICAgCj4gLQkJc2tsX2RkYl9lbnRyeV9pbml0X2Zyb21f
aHcoZGV2X3ByaXYsIGRkYl95LCB2YWwpOwo+IC0JCXNrbF9kZGJfZW50cnlfaW5pdF9mcm9tX2h3
KGRldl9wcml2LCBkZGJfdXYsIHZhbDIpOwo+ICsJCXNrbF9kZGJfZW50cnlfaW5pdF9mcm9tX2h3
KGk5MTUsIGRkYl95LCB2YWwpOwo+ICsJCXNrbF9kZGJfZW50cnlfaW5pdF9mcm9tX2h3KGk5MTUs
IGRkYl91diwgdmFsMik7Cj4gICAJfQo+ICAgfQo+ICAgCj4gQEAgLTQwMTgsMzAgKzQwMTgsMzAg
QEAgdm9pZCBza2xfcGlwZV9kZGJfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
LAo+ICAgCQkJICAgICAgIHN0cnVjdCBza2xfZGRiX2VudHJ5ICpkZGJfeSwKPiAgIAkJCSAgICAg
ICBzdHJ1Y3Qgc2tsX2RkYl9lbnRyeSAqZGRiX3V2KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAgCWVu
dW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gcG93ZXJfZG9tYWluOwo+ICAgCWVudW0gcGlw
ZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiAgIAll
bnVtIHBsYW5lX2lkIHBsYW5lX2lkOwo+ICAgCj4gICAJcG93ZXJfZG9tYWluID0gUE9XRVJfRE9N
QUlOX1BJUEUocGlwZSk7Cj4gLQl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZf
ZW5hYmxlZChkZXZfcHJpdiwgcG93ZXJfZG9tYWluKTsKPiArCXdha2VyZWYgPSBpbnRlbF9kaXNw
bGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGk5MTUsIHBvd2VyX2RvbWFpbik7Cj4gICAJaWYgKCF3
YWtlcmVmKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAlmb3JfZWFjaF9wbGFuZV9pZF9vbl9jcnRj
KGNydGMsIHBsYW5lX2lkKQo+IC0JCXNrbF9kZGJfZ2V0X2h3X3BsYW5lX3N0YXRlKGRldl9wcml2
LCBwaXBlLAo+ICsJCXNrbF9kZGJfZ2V0X2h3X3BsYW5lX3N0YXRlKGk5MTUsIHBpcGUsCj4gICAJ
CQkJCSAgIHBsYW5lX2lkLAo+ICAgCQkJCQkgICAmZGRiX3lbcGxhbmVfaWRdLAo+ICAgCQkJCQkg
ICAmZGRiX3V2W3BsYW5lX2lkXSk7Cj4gICAKPiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRl
dl9wcml2LCBwb3dlcl9kb21haW4sIHdha2VyZWYpOwo+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9w
dXQoaTkxNSwgcG93ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiAgIH0KPiAgIAo+IC12b2lkIHNrbF9k
ZGJfZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArdm9p
ZCBza2xfZGRiX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAg
IAkJCSAgc3RydWN0IHNrbF9kZGJfYWxsb2NhdGlvbiAqZGRiIC8qIG91dCAqLykKPiAgIHsKPiAt
CWRkYi0+ZW5hYmxlZF9zbGljZXMgPSBpbnRlbF9lbmFibGVkX2RidWZfc2xpY2VzX251bShkZXZf
cHJpdik7Cj4gKwlkZGItPmVuYWJsZWRfc2xpY2VzID0gaW50ZWxfZW5hYmxlZF9kYnVmX3NsaWNl
c19udW0oaTkxNSk7Cj4gICB9Cj4gICAKPiAgIC8qCj4gQEAgLTQxMzgsNyArNDEzOCw3IEBAIHNr
bF9waXBlX2Rvd25zY2FsZV9hbW91bnQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUpCj4gICBpbnQgc2tsX2NoZWNrX3BpcGVfbWF4X3BpeGVsX3JhdGUoc3RydWN0IGlu
dGVsX2NydGMgKmludGVsX2NydGMsCj4gICAJCQkJICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShpbnRlbF9jcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoaW50ZWxfY3J0Yy0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBkcm1fY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9ICZjc3RhdGUtPmJhc2U7Cj4gICAJc3RydWN0IGRybV9hdG9t
aWNfc3RhdGUgKnN0YXRlID0gY3J0Y19zdGF0ZS0+c3RhdGU7Cj4gICAJc3RydWN0IGRybV9wbGFu
ZSAqcGxhbmU7Cj4gQEAgLTQxODEsNyArNDE4MSw3IEBAIGludCBza2xfY2hlY2tfcGlwZV9tYXhf
cGl4ZWxfcmF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YywKPiAgIAljcnRjX2Nsb2Nr
ID0gY3J0Y19zdGF0ZS0+YWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrOwo+ICAgCWRvdGNsayA9IHRv
X2ludGVsX2F0b21pY19zdGF0ZShzdGF0ZSktPmNkY2xrLmxvZ2ljYWwuY2RjbGs7Cj4gICAKPiAt
CWlmIChJU19HRU1JTklMQUtFKGRldl9wcml2KSB8fCBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEw
KQo+ICsJaWYgKElTX0dFTUlOSUxBS0UoaTkxNSkgfHwgSU5URUxfR0VOKGk5MTUpID49IDEwKQo+
ICAgCQlkb3RjbGsgKj0gMjsKPiAgIAo+ICAgCXBpcGVfbWF4X3BpeGVsX3JhdGUgPSBkaXZfcm91
bmRfdXBfdTMyX2ZpeGVkMTYoZG90Y2xrLCBwaXBlX2Rvd25zY2FsZSk7Cj4gQEAgLTQzNDEsNyAr
NDM0MSw3IEBAIHNrbF9hbGxvY2F0ZV9waXBlX2RkYihzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3N0YXRlLAo+ICAgewo+ICAgCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSA9IGNzdGF0
ZS0+YmFzZS5zdGF0ZTsKPiAgIAlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSBjc3RhdGUtPmJhc2Uu
Y3J0YzsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0
Yy0+ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRj
LT5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0
YyhjcnRjKTsKPiAgIAlzdHJ1Y3Qgc2tsX2RkYl9lbnRyeSAqYWxsb2MgPSAmY3N0YXRlLT53bS5z
a2wuZGRiOwo+ICAgCXUxNiBhbGxvY19zaXplLCBzdGFydCA9IDA7Cj4gQEAgLTQzNjcsNyArNDM2
Nyw3IEBAIHNrbF9hbGxvY2F0ZV9waXBlX2RkYihzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0
YXRlLAo+ICAgCQlyZXR1cm4gMDsKPiAgIAl9Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDExKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiAgIAkJdG90YWxfZGF0
YV9yYXRlID0KPiAgIAkJCWljbF9nZXRfdG90YWxfcmVsYXRpdmVfZGF0YV9yYXRlKGNzdGF0ZSwK
PiAgIAkJCQkJCQkgcGxhbmVfZGF0YV9yYXRlKTsKPiBAQCAtNDM3OCw3ICs0Mzc4LDcgQEAgc2ts
X2FsbG9jYXRlX3BpcGVfZGRiKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUsCj4gICAJ
CQkJCQkJIHV2X3BsYW5lX2RhdGFfcmF0ZSk7Cj4gICAKPiAgIAo+IC0Jc2tsX2RkYl9nZXRfcGlw
ZV9hbGxvY2F0aW9uX2xpbWl0cyhkZXZfcHJpdiwgY3N0YXRlLCB0b3RhbF9kYXRhX3JhdGUsCj4g
Kwlza2xfZGRiX2dldF9waXBlX2FsbG9jYXRpb25fbGltaXRzKGk5MTUsIGNzdGF0ZSwgdG90YWxf
ZGF0YV9yYXRlLAo+ICAgCQkJCQkgICBkZGIsIGFsbG9jLCAmbnVtX2FjdGl2ZSk7Cj4gICAJYWxs
b2Nfc2l6ZSA9IHNrbF9kZGJfZW50cnlfc2l6ZShhbGxvYyk7Cj4gICAJaWYgKGFsbG9jX3NpemUg
PT0gMCkKPiBAQCAtNDM5OCw3ICs0Mzk4LDcgQEAgc2tsX2FsbG9jYXRlX3BpcGVfZGRiKHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUsCj4gICAJICogRmluZCB0aGUgaGlnaGVzdCB3YXRl
cm1hcmsgbGV2ZWwgZm9yIHdoaWNoIHdlIGNhbiBzYXRpc2Z5IHRoZSBibG9jawo+ICAgCSAqIHJl
cXVpcmVtZW50IG9mIGFjdGl2ZSBwbGFuZXMuCj4gICAJICovCj4gLQlmb3IgKGxldmVsID0gaWxr
X3dtX21heF9sZXZlbChkZXZfcHJpdik7IGxldmVsID49IDA7IGxldmVsLS0pIHsKPiArCWZvciAo
bGV2ZWwgPSBpbGtfd21fbWF4X2xldmVsKGk5MTUpOyBsZXZlbCA+PSAwOyBsZXZlbC0tKSB7Cj4g
ICAJCWJsb2NrcyA9IDA7Cj4gICAJCWZvcl9lYWNoX3BsYW5lX2lkX29uX2NydGMoaW50ZWxfY3J0
YywgcGxhbmVfaWQpIHsKPiAgIAkJCWNvbnN0IHN0cnVjdCBza2xfcGxhbmVfd20gKndtID0KPiBA
QCAtNDQ4NCw3ICs0NDg0LDcgQEAgc2tsX2FsbG9jYXRlX3BpcGVfZGRiKHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjc3RhdGUsCj4gICAJCQljb250aW51ZTsKPiAgIAo+ICAgCQkvKiBHZW4xMSsg
dXNlcyBhIHNlcGFyYXRlIHBsYW5lIGZvciBVViB3YXRlcm1hcmtzICovCj4gLQkJV0FSTl9PTihJ
TlRFTF9HRU4oZGV2X3ByaXYpID49IDExICYmIHV2X3RvdGFsW3BsYW5lX2lkXSk7Cj4gKwkJV0FS
Tl9PTihJTlRFTF9HRU4oaTkxNSkgPj0gMTEgJiYgdXZfdG90YWxbcGxhbmVfaWRdKTsKPiAgIAo+
ICAgCQkvKiBMZWF2ZSBkaXNhYmxlZCBwbGFuZXMgYXQgKDAsMCkgKi8KPiAgIAkJaWYgKHRvdGFs
W3BsYW5lX2lkXSkgewo+IEBAIC00NTA2LDcgKzQ1MDYsNyBAQCBza2xfYWxsb2NhdGVfcGlwZV9k
ZGIoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiAgIAkgKiBhbGwgbGV2ZWxzIGFz
ICJlbmFibGVkLiIgIEdvIGJhY2sgbm93IGFuZCBkaXNhYmxlIHRoZSBvbmVzCj4gICAJICogdGhh
dCBhcmVuJ3QgYWN0dWFsbHkgcG9zc2libGUuCj4gICAJICovCj4gLQlmb3IgKGxldmVsKys7IGxl
dmVsIDw9IGlsa193bV9tYXhfbGV2ZWwoZGV2X3ByaXYpOyBsZXZlbCsrKSB7Cj4gKwlmb3IgKGxl
dmVsKys7IGxldmVsIDw9IGlsa193bV9tYXhfbGV2ZWwoaTkxNSk7IGxldmVsKyspIHsKPiAgIAkJ
Zm9yX2VhY2hfcGxhbmVfaWRfb25fY3J0YyhpbnRlbF9jcnRjLCBwbGFuZV9pZCkgewo+ICAgCQkJ
c3RydWN0IHNrbF9wbGFuZV93bSAqd20gPQo+ICAgCQkJCSZjc3RhdGUtPndtLnNrbC5vcHRpbWFs
LnBsYW5lc1twbGFuZV9pZF07Cj4gQEAgLTQ1MzEsNyArNDUzMSw3IEBAIHNrbF9hbGxvY2F0ZV9w
aXBlX2RkYihzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlLAo+ICAgCQkJICogV2FfMTQw
ODk2MTAwODppY2wsIGVobAo+ICAgCQkJICogVW5kZXJydW5zIHdpdGggV00xKyBkaXNhYmxlZAo+
ICAgCQkJICovCj4gLQkJCWlmIChJU19HRU4oZGV2X3ByaXYsIDExKSAmJgo+ICsJCQlpZiAoSVNf
R0VOKGk5MTUsIDExKSAmJgo+ICAgCQkJICAgIGxldmVsID09IDEgJiYgd20tPndtWzBdLnBsYW5l
X2VuKSB7Cj4gICAJCQkJd20tPndtW2xldmVsXS5wbGFuZV9yZXNfYiA9IHdtLT53bVswXS5wbGFu
ZV9yZXNfYjsKPiAgIAkJCQl3bS0+d21bbGV2ZWxdLnBsYW5lX3Jlc19sID0gd20tPndtWzBdLnBs
YW5lX3Jlc19sOwo+IEBAIC00NTYyLDcgKzQ1NjIsNyBAQCBza2xfYWxsb2NhdGVfcGlwZV9kZGIo
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiAgICAqIDJ4Y2RjbGsgaXMgMTM1MCBN
SHogYW5kIHRoZSBwaXhlbCByYXRlIHNob3VsZCBuZXZlciBleGNlZWQgdGhhdC4KPiAgICovCj4g
ICBzdGF0aWMgdWludF9maXhlZF8xNl8xNl90Cj4gLXNrbF93bV9tZXRob2QxKGNvbnN0IHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIHBpeGVsX3JhdGUsCj4gK3NrbF93bV9t
ZXRob2QxKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgcGl4ZWxfcmF0
ZSwKPiAgIAkgICAgICAgdTggY3BwLCB1MzIgbGF0ZW5jeSwgdTMyIGRidWZfYmxvY2tfc2l6ZSkK
PiAgIHsKPiAgIAl1MzIgd21faW50ZXJtZWRpYXRlX3ZhbDsKPiBAQCAtNDU3NCw3ICs0NTc0LDcg
QEAgc2tsX3dtX21ldGhvZDEoY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LCB1MzIgcGl4ZWxfcmF0ZSwKPiAgIAl3bV9pbnRlcm1lZGlhdGVfdmFsID0gbGF0ZW5jeSAqIHBp
eGVsX3JhdGUgKiBjcHA7Cj4gICAJcmV0ID0gZGl2X2ZpeGVkMTYod21faW50ZXJtZWRpYXRlX3Zh
bCwgMTAwMCAqIGRidWZfYmxvY2tfc2l6ZSk7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDEwKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMCkKPiAgIAkJcmV0ID0gYWRk
X2ZpeGVkMTZfdTMyKHJldCwgMSk7Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+IEBAIC00NjQ4LDcg
KzQ2NDgsNyBAQCBza2xfY29tcHV0ZV93bV9wYXJhbXMoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUsCj4gICAJCSAgICAgIGludCBjb2xvcl9wbGFuZSkKPiAgIHsKPiAg
IAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFz
ZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
Y3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAl1MzIgaW50ZXJtX3BicGw7Cj4gICAKPiAgIAkvKiBv
bmx5IHBsYW5hciBmb3JtYXQgaGFzIHR3byBwbGFuZXMgKi8KPiBAQCAtNDY3Myw3ICs0NjczLDcg
QEAgc2tsX2NvbXB1dGVfd21fcGFyYW1zKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLAo+ICAgCXdwLT5jcHAgPSBmb3JtYXQtPmNwcFtjb2xvcl9wbGFuZV07Cj4gICAJ
d3AtPnBsYW5lX3BpeGVsX3JhdGUgPSBwbGFuZV9waXhlbF9yYXRlOwo+ICAgCj4gLQlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA+PSAxMSAmJgo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSAm
Jgo+ICAgCSAgICBtb2RpZmllciA9PSBJOTE1X0ZPUk1BVF9NT0RfWWZfVElMRUQgICYmIHdwLT5j
cHAgPT0gMSkKPiAgIAkJd3AtPmRidWZfYmxvY2tfc2l6ZSA9IDI1NjsKPiAgIAllbHNlCj4gQEAg
LTQ2OTgsNyArNDY5OCw3IEBAIHNrbF9jb21wdXRlX3dtX3BhcmFtcyhjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJd3AtPnlfbWluX3NjYW5saW5lcyA9IDQ7
Cj4gICAJfQo+ICAgCj4gLQlpZiAoc2tsX25lZWRzX21lbW9yeV9id193YShkZXZfcHJpdikpCj4g
KwlpZiAoc2tsX25lZWRzX21lbW9yeV9id193YShpOTE1KSkKPiAgIAkJd3AtPnlfbWluX3NjYW5s
aW5lcyAqPSAyOwo+ICAgCj4gICAJd3AtPnBsYW5lX2J5dGVzX3Blcl9saW5lID0gd3AtPndpZHRo
ICogd3AtPmNwcDsKPiBAQCAtNDcwNywxMiArNDcwNywxMiBAQCBza2xfY29tcHV0ZV93bV9wYXJh
bXMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICAJCQkJCSAg
IHdwLT55X21pbl9zY2FubGluZXMsCj4gICAJCQkJCSAgIHdwLT5kYnVmX2Jsb2NrX3NpemUpOwo+
ICAgCj4gLQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTApCj4gKwkJaWYgKElOVEVMX0dF
TihpOTE1KSA+PSAxMCkKPiAgIAkJCWludGVybV9wYnBsKys7Cj4gICAKPiAgIAkJd3AtPnBsYW5l
X2Jsb2Nrc19wZXJfbGluZSA9IGRpdl9maXhlZDE2KGludGVybV9wYnBsLAo+ICAgCQkJCQkJCXdw
LT55X21pbl9zY2FubGluZXMpOwo+IC0JfSBlbHNlIGlmICh3cC0+eF90aWxlZCAmJiBJU19HRU4o
ZGV2X3ByaXYsIDkpKSB7Cj4gKwl9IGVsc2UgaWYgKHdwLT54X3RpbGVkICYmIElTX0dFTihpOTE1
LCA5KSkgewo+ICAgCQlpbnRlcm1fcGJwbCA9IERJVl9ST1VORF9VUCh3cC0+cGxhbmVfYnl0ZXNf
cGVyX2xpbmUsCj4gICAJCQkJCSAgIHdwLT5kYnVmX2Jsb2NrX3NpemUpOwo+ICAgCQl3cC0+cGxh
bmVfYmxvY2tzX3Blcl9saW5lID0gdTMyX3RvX2ZpeGVkMTYoaW50ZXJtX3BicGwpOwo+IEBAIC00
NzU4LDkgKzQ3NTgsOSBAQCBza2xfY29tcHV0ZV9wbGFuZV93bV9wYXJhbXMoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICAJCQkJICAgICB3cCwgY29sb3JfcGxh
bmUpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBib29sIHNrbF93bV9oYXNfbGluZXMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgbGV2ZWwpCj4gK3N0YXRpYyBib29sIHNrbF93
bV9oYXNfbGluZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGludCBsZXZlbCkKPiAg
IHsKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwIHx8IElTX0dFTUlOSUxBS0UoZGV2
X3ByaXYpKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMCB8fCBJU19HRU1JTklMQUtFKGk5
MTUpKQo+ICAgCQlyZXR1cm4gdHJ1ZTsKPiAgIAo+ICAgCS8qIFRoZSBudW1iZXIgb2YgbGluZXMg
YXJlIGlnbm9yZWQgZm9yIHRoZSBsZXZlbCAwIHdhdGVybWFyay4gKi8KPiBAQCAtNDc3Myw4ICs0
NzczLDggQEAgc3RhdGljIHZvaWQgc2tsX2NvbXB1dGVfcGxhbmVfd20oY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiAgIAkJCQkgY29uc3Qgc3RydWN0IHNrbF93bV9sZXZl
bCAqcmVzdWx0X3ByZXYsCj4gICAJCQkJIHN0cnVjdCBza2xfd21fbGV2ZWwgKnJlc3VsdCAvKiBv
dXQgKi8pCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGNzdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+IC0JdTMyIGxhdGVuY3kgPSBkZXZfcHJpdi0+
d20uc2tsX2xhdGVuY3lbbGV2ZWxdOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGNzdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICsJdTMyIGxhdGVuY3kgPSBpOTE1
LT53bS5za2xfbGF0ZW5jeVtsZXZlbF07Cj4gICAJdWludF9maXhlZF8xNl8xNl90IG1ldGhvZDEs
IG1ldGhvZDI7Cj4gICAJdWludF9maXhlZF8xNl8xNl90IHNlbGVjdGVkX3Jlc3VsdDsKPiAgIAl1
MzIgcmVzX2Jsb2NrcywgcmVzX2xpbmVzLCBtaW5fZGRiX2FsbG9jID0gMDsKPiBAQCAtNDc4OSwx
NCArNDc4OSwxNCBAQCBzdGF0aWMgdm9pZCBza2xfY29tcHV0ZV9wbGFuZV93bShjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlLAo+ICAgCSAqIFdhSW5jcmVhc2VMYXRlbmN5SVBD
RW5hYmxlZDoga2JsLGNmbAo+ICAgCSAqIERpc3BsYXkgV0EgIzExNDE6IGtibCxjZmwKPiAgIAkg
Ki8KPiAtCWlmICgoSVNfS0FCWUxBS0UoZGV2X3ByaXYpIHx8IElTX0NPRkZFRUxBS0UoZGV2X3By
aXYpKSB8fAo+IC0JICAgIGRldl9wcml2LT5pcGNfZW5hYmxlZCkKPiArCWlmICgoSVNfS0FCWUxB
S0UoaTkxNSkgfHwgSVNfQ09GRkVFTEFLRShpOTE1KSkgfHwKPiArCSAgICBpOTE1LT5pcGNfZW5h
YmxlZCkKPiAgIAkJbGF0ZW5jeSArPSA0Owo+ICAgCj4gLQlpZiAoc2tsX25lZWRzX21lbW9yeV9i
d193YShkZXZfcHJpdikgJiYgd3AtPnhfdGlsZWQpCj4gKwlpZiAoc2tsX25lZWRzX21lbW9yeV9i
d193YShpOTE1KSAmJiB3cC0+eF90aWxlZCkKPiAgIAkJbGF0ZW5jeSArPSAxNTsKPiAgIAo+IC0J
bWV0aG9kMSA9IHNrbF93bV9tZXRob2QxKGRldl9wcml2LCB3cC0+cGxhbmVfcGl4ZWxfcmF0ZSwK
PiArCW1ldGhvZDEgPSBza2xfd21fbWV0aG9kMShpOTE1LCB3cC0+cGxhbmVfcGl4ZWxfcmF0ZSwK
PiAgIAkJCQkgd3AtPmNwcCwgbGF0ZW5jeSwgd3AtPmRidWZfYmxvY2tfc2l6ZSk7Cj4gICAJbWV0
aG9kMiA9IHNrbF93bV9tZXRob2QyKHdwLT5wbGFuZV9waXhlbF9yYXRlLAo+ICAgCQkJCSBjc3Rh
dGUtPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2h0b3RhbCwKPiBAQCAtNDgxMSw4ICs0ODExLDgg
QEAgc3RhdGljIHZvaWQgc2tsX2NvbXB1dGVfcGxhbmVfd20oY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNzdGF0ZSwKPiAgIAkJICAgICAod3AtPnBsYW5lX2J5dGVzX3Blcl9saW5lIC8g
d3AtPmRidWZfYmxvY2tfc2l6ZSA8IDEpKSB7Cj4gICAJCQlzZWxlY3RlZF9yZXN1bHQgPSBtZXRo
b2QyOwo+ICAgCQl9IGVsc2UgaWYgKGxhdGVuY3kgPj0gd3AtPmxpbmV0aW1lX3VzKSB7Cj4gLQkJ
CWlmIChJU19HRU4oZGV2X3ByaXYsIDkpICYmCj4gLQkJCSAgICAhSVNfR0VNSU5JTEFLRShkZXZf
cHJpdikpCj4gKwkJCWlmIChJU19HRU4oaTkxNSwgOSkgJiYKPiArCQkJICAgICFJU19HRU1JTklM
QUtFKGk5MTUpKQo+ICAgCQkJCXNlbGVjdGVkX3Jlc3VsdCA9IG1pbl9maXhlZDE2KG1ldGhvZDEs
IG1ldGhvZDIpOwo+ICAgCQkJZWxzZQo+ICAgCQkJCXNlbGVjdGVkX3Jlc3VsdCA9IG1ldGhvZDI7
Cj4gQEAgLTQ4MjUsNyArNDgyNSw3IEBAIHN0YXRpYyB2b2lkIHNrbF9jb21wdXRlX3BsYW5lX3dt
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUsCj4gICAJcmVzX2xpbmVzID0g
ZGl2X3JvdW5kX3VwX2ZpeGVkMTYoc2VsZWN0ZWRfcmVzdWx0LAo+ICAgCQkJCQkgd3AtPnBsYW5l
X2Jsb2Nrc19wZXJfbGluZSk7Cj4gICAKPiAtCWlmIChJU19HRU45X0JDKGRldl9wcml2KSB8fCBJ
U19CUk9YVE9OKGRldl9wcml2KSkgewo+ICsJaWYgKElTX0dFTjlfQkMoaTkxNSkgfHwgSVNfQlJP
WFRPTihpOTE1KSkgewo+ICAgCQkvKiBEaXNwbGF5IFdBICMxMTI1OiBza2wsYnh0LGtibCAqLwo+
ICAgCQlpZiAobGV2ZWwgPT0gMCAmJiB3cC0+cmNfc3VyZmFjZSkKPiAgIAkJCXJlc19ibG9ja3Mg
Kz0KPiBAQCAtNDg1Miw3ICs0ODUyLDcgQEAgc3RhdGljIHZvaWQgc2tsX2NvbXB1dGVfcGxhbmVf
d20oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiAgIAkJfQo+ICAgCX0K
PiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpIHsKPiArCWlmIChJTlRFTF9H
RU4oaTkxNSkgPj0gMTEpIHsKPiAgIAkJaWYgKHdwLT55X3RpbGVkKSB7Cj4gICAJCQlpbnQgZXh0
cmFfbGluZXM7Cj4gICAKPiBAQCAtNDg3MCw3ICs0ODcwLDcgQEAgc3RhdGljIHZvaWQgc2tsX2Nv
bXB1dGVfcGxhbmVfd20oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiAg
IAkJfQo+ICAgCX0KPiAgIAo+IC0JaWYgKCFza2xfd21faGFzX2xpbmVzKGRldl9wcml2LCBsZXZl
bCkpCj4gKwlpZiAoIXNrbF93bV9oYXNfbGluZXMoaTkxNSwgbGV2ZWwpKQo+ICAgCQlyZXNfbGlu
ZXMgPSAwOwo+ICAgCj4gICAJaWYgKHJlc19saW5lcyA+IDMxKSB7Cj4gQEAgLTQ4OTcsOCArNDg5
Nyw4IEBAIHNrbF9jb21wdXRlX3dtX2xldmVscyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3N0YXRlLAo+ICAgCQkgICAgICBjb25zdCBzdHJ1Y3Qgc2tsX3dtX3BhcmFtcyAqd21fcGFy
YW1zLAo+ICAgCQkgICAgICBzdHJ1Y3Qgc2tsX3dtX2xldmVsICpsZXZlbHMpCj4gICB7Cj4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNzdGF0ZS0+YmFzZS5j
cnRjLT5kZXYpOwo+IC0JaW50IGxldmVsLCBtYXhfbGV2ZWwgPSBpbGtfd21fbWF4X2xldmVsKGRl
dl9wcml2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjc3Rh
dGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiArCWludCBsZXZlbCwgbWF4X2xldmVsID0gaWxrX3dtX21h
eF9sZXZlbChpOTE1KTsKPiAgIAlzdHJ1Y3Qgc2tsX3dtX2xldmVsICpyZXN1bHRfcHJldiA9ICZs
ZXZlbHNbMF07Cj4gICAKPiAgIAlmb3IgKGxldmVsID0gMDsgbGV2ZWwgPD0gbWF4X2xldmVsOyBs
ZXZlbCsrKSB7Cj4gQEAgLTQ5MTUsNyArNDkxNSw3IEBAIHN0YXRpYyB1MzIKPiAgIHNrbF9jb21w
dXRlX2xpbmV0aW1lX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUpCj4g
ICB7Cj4gICAJc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0gY3N0YXRlLT5iYXNlLnN0
YXRlOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShzdGF0
ZS0+ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShzdGF0
ZS0+ZGV2KTsKPiAgIAl1aW50X2ZpeGVkXzE2XzE2X3QgbGluZXRpbWVfdXM7Cj4gICAJdTMyIGxp
bmV0aW1lX3dtOwo+ICAgCj4gQEAgLTQ5MjMsNyArNDkyMyw3IEBAIHNrbF9jb21wdXRlX2xpbmV0
aW1lX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUpCj4gICAJbGluZXRp
bWVfd20gPSBmaXhlZDE2X3RvX3UzMl9yb3VuZF91cChtdWxfdTMyX2ZpeGVkMTYoOCwgbGluZXRp
bWVfdXMpKTsKPiAgIAo+ICAgCS8qIERpc3BsYXkgV0EgIzExMzU6IEJYVDpBTEwgR0xLOkFMTCAq
Lwo+IC0JaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpICYmIGRldl9wcml2LT5pcGNfZW5hYmxlZCkK
PiArCWlmIChJU19HRU45X0xQKGk5MTUpICYmIGk5MTUtPmlwY19lbmFibGVkKQo+ICAgCQlsaW5l
dGltZV93bSAvPSAyOwo+ICAgCj4gICAJcmV0dXJuIGxpbmV0aW1lX3dtOwo+IEBAIC00OTM0LDIx
ICs0OTM0LDIxIEBAIHN0YXRpYyB2b2lkIHNrbF9jb21wdXRlX3RyYW5zaXRpb25fd20oY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiAgIAkJCQkgICAgICBzdHJ1Y3Qgc2ts
X3BsYW5lX3dtICp3bSkKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3N0YXRl
LT5iYXNlLmNydGMtPmRldjsKPiAtCWNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCWNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXUxNiB0cmFuc19taW4sIHRyYW5zX3lfdGlsZV9taW47
Cj4gICAJY29uc3QgdTE2IHRyYW5zX2Ftb3VudCA9IDEwOyAvKiBUaGlzIGlzIGNvbmZpZ3VyYWJs
ZSBhbW91bnQgKi8KPiAgIAl1MTYgd20wX3NlbF9yZXNfYiwgdHJhbnNfb2Zmc2V0X2IsIHJlc19i
bG9ja3M7Cj4gICAKPiAgIAkvKiBUcmFuc2l0aW9uIFdNIGFyZSBub3QgcmVjb21tZW5kZWQgYnkg
SFcgdGVhbSBmb3IgR0VOOSAqLwo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPD0gOSkKPiAr
CWlmIChJTlRFTF9HRU4oaTkxNSkgPD0gOSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJLyogVHJh
bnNpdGlvbiBXTSBkb24ndCBtYWtlIGFueSBzZW5zZSBpZiBpcGMgaXMgZGlzYWJsZWQgKi8KPiAt
CWlmICghZGV2X3ByaXYtPmlwY19lbmFibGVkKQo+ICsJaWYgKCFpOTE1LT5pcGNfZW5hYmxlZCkK
PiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJdHJhbnNfbWluID0gMTQ7Cj4gLQlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSAxMSkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpCj4gICAJCXRy
YW5zX21pbiA9IDQ7Cj4gICAKPiAgIAl0cmFuc19vZmZzZXRfYiA9IHRyYW5zX21pbiArIHRyYW5z
X2Ftb3VudDsKPiBAQCAtNDk3NCw3ICs0OTc0LDcgQEAgc3RhdGljIHZvaWQgc2tsX2NvbXB1dGVf
dHJhbnNpdGlvbl93bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlLAo+ICAg
CQlyZXNfYmxvY2tzID0gd20wX3NlbF9yZXNfYiArIHRyYW5zX29mZnNldF9iOwo+ICAgCj4gICAJ
CS8qIFdBIEJVRzoxOTM4NDY2IGFkZCBvbmUgYmxvY2sgZm9yIG5vbiB5LXRpbGUgcGxhbmVzICov
Cj4gLQkJaWYgKElTX0NOTF9SRVZJRChkZXZfcHJpdiwgQ05MX1JFVklEX0EwLCBDTkxfUkVWSURf
QTApKQo+ICsJCWlmIChJU19DTkxfUkVWSUQoaTkxNSwgQ05MX1JFVklEX0EwLCBDTkxfUkVWSURf
QTApKQo+ICAgCQkJcmVzX2Jsb2NrcyArPSAxOwo+ICAgCj4gICAJfQo+IEBAIC01MDkzLDcgKzUw
OTMsNyBAQCBzdGF0aWMgaW50IGljbF9idWlsZF9wbGFuZV93bShzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIAo+ICAgc3RhdGljIGludCBza2xfYnVpbGRfcGlwZV93bShz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjc3RhdGUtPmJhc2UuY3J0
Yy0+ZGV2KTsKPiAgIAlzdHJ1Y3Qgc2tsX3BpcGVfd20gKnBpcGVfd20gPSAmY3N0YXRlLT53bS5z
a2wub3B0aW1hbDsKPiAgIAlzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKmNydGNfc3RhdGUgPSAmY3N0
YXRlLT5iYXNlOwo+ICAgCXN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lOwo+IEBAIC01MTEwLDcgKzUx
MTAsNyBAQCBzdGF0aWMgaW50IHNrbF9idWlsZF9waXBlX3dtKHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjc3RhdGUpCj4gICAJCWNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqaW50ZWxf
cHN0YXRlID0KPiAgIAkJCQkJCXRvX2ludGVsX3BsYW5lX3N0YXRlKHBzdGF0ZSk7Cj4gICAKPiAt
CQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKPiArCQlpZiAoSU5URUxfR0VOKGk5MTUp
ID49IDExKQo+ICAgCQkJcmV0ID0gaWNsX2J1aWxkX3BsYW5lX3dtKGNzdGF0ZSwgaW50ZWxfcHN0
YXRlKTsKPiAgIAkJZWxzZQo+ICAgCQkJcmV0ID0gc2tsX2J1aWxkX3BsYW5lX3dtKGNzdGF0ZSwg
aW50ZWxfcHN0YXRlKTsKPiBAQCAtNTEyMyw3ICs1MTIzLDcgQEAgc3RhdGljIGludCBza2xfYnVp
bGRfcGlwZV93bShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlKQo+ICAgCXJldHVybiAw
Owo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIHNrbF9kZGJfZW50cnlfd3JpdGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBza2xfZGRiX2VudHJ5X3dy
aXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCWk5MTVfcmVnX3QgcmVn
LAo+ICAgCQkJCWNvbnN0IHN0cnVjdCBza2xfZGRiX2VudHJ5ICplbnRyeSkKPiAgIHsKPiBAQCAt
NTEzMyw3ICs1MTMzLDcgQEAgc3RhdGljIHZvaWQgc2tsX2RkYl9lbnRyeV93cml0ZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJCUk5MTVfV1JJVEVfRlcocmVnLCAwKTsK
PiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBza2xfd3JpdGVfd21fbGV2ZWwoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBza2xfd3JpdGVfd21fbGV2ZWwo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgICAgICAgaTkxNV9yZWdfdCBy
ZWcsCj4gICAJCQkgICAgICAgY29uc3Qgc3RydWN0IHNrbF93bV9sZXZlbCAqbGV2ZWwpCj4gICB7
Cj4gQEAgLTUxNTIsOCArNTE1Miw4IEBAIHN0YXRpYyB2b2lkIHNrbF93cml0ZV93bV9sZXZlbChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICB2b2lkIHNrbF93cml0ZV9wbGFu
ZV93bShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ICAgCQkJY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gLQlpbnQgbGV2ZWwsIG1h
eF9sZXZlbCA9IGlsa193bV9tYXhfbGV2ZWwoZGV2X3ByaXYpOwo+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gKwlpbnQgbGV2ZWws
IG1heF9sZXZlbCA9IGlsa193bV9tYXhfbGV2ZWwoaTkxNSk7Cj4gICAJZW51bSBwbGFuZV9pZCBw
bGFuZV9pZCA9IHBsYW5lLT5pZDsKPiAgIAllbnVtIHBpcGUgcGlwZSA9IHBsYW5lLT5waXBlOwo+
ICAgCWNvbnN0IHN0cnVjdCBza2xfcGxhbmVfd20gKndtID0KPiBAQCAtNTE2NCwxNCArNTE2NCwx
NCBAQCB2b2lkIHNrbF93cml0ZV9wbGFuZV93bShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+
ICAgCQkmY3J0Y19zdGF0ZS0+d20uc2tsLnBsYW5lX2RkYl91dltwbGFuZV9pZF07Cj4gICAKPiAg
IAlmb3IgKGxldmVsID0gMDsgbGV2ZWwgPD0gbWF4X2xldmVsOyBsZXZlbCsrKSB7Cj4gLQkJc2ts
X3dyaXRlX3dtX2xldmVsKGRldl9wcml2LCBQTEFORV9XTShwaXBlLCBwbGFuZV9pZCwgbGV2ZWwp
LAo+ICsJCXNrbF93cml0ZV93bV9sZXZlbChpOTE1LCBQTEFORV9XTShwaXBlLCBwbGFuZV9pZCwg
bGV2ZWwpLAo+ICAgCQkJCSAgICZ3bS0+d21bbGV2ZWxdKTsKPiAgIAl9Cj4gLQlza2xfd3JpdGVf
d21fbGV2ZWwoZGV2X3ByaXYsIFBMQU5FX1dNX1RSQU5TKHBpcGUsIHBsYW5lX2lkKSwKPiArCXNr
bF93cml0ZV93bV9sZXZlbChpOTE1LCBQTEFORV9XTV9UUkFOUyhwaXBlLCBwbGFuZV9pZCksCj4g
ICAJCQkgICAmd20tPnRyYW5zX3dtKTsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gMTEpIHsKPiAtCQlza2xfZGRiX2VudHJ5X3dyaXRlKGRldl9wcml2LAo+ICsJaWYgKElOVEVM
X0dFTihpOTE1KSA+PSAxMSkgewo+ICsJCXNrbF9kZGJfZW50cnlfd3JpdGUoaTkxNSwKPiAgIAkJ
CQkgICAgUExBTkVfQlVGX0NGRyhwaXBlLCBwbGFuZV9pZCksIGRkYl95KTsKPiAgIAkJcmV0dXJu
Owo+ICAgCX0KPiBAQCAtNTE3OSwxNyArNTE3OSwxNyBAQCB2b2lkIHNrbF93cml0ZV9wbGFuZV93
bShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ICAgCWlmICh3bS0+aXNfcGxhbmFyKQo+ICAg
CQlzd2FwKGRkYl95LCBkZGJfdXYpOwo+ICAgCj4gLQlza2xfZGRiX2VudHJ5X3dyaXRlKGRldl9w
cml2LAo+ICsJc2tsX2RkYl9lbnRyeV93cml0ZShpOTE1LAo+ICAgCQkJICAgIFBMQU5FX0JVRl9D
RkcocGlwZSwgcGxhbmVfaWQpLCBkZGJfeSk7Cj4gLQlza2xfZGRiX2VudHJ5X3dyaXRlKGRldl9w
cml2LAo+ICsJc2tsX2RkYl9lbnRyeV93cml0ZShpOTE1LAo+ICAgCQkJICAgIFBMQU5FX05WMTJf
QlVGX0NGRyhwaXBlLCBwbGFuZV9pZCksIGRkYl91dik7Cj4gICB9Cj4gICAKPiAgIHZvaWQgc2ts
X3dyaXRlX2N1cnNvcl93bShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ICAgCQkJIGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+IC0J
aW50IGxldmVsLCBtYXhfbGV2ZWwgPSBpbGtfd21fbWF4X2xldmVsKGRldl9wcml2KTsKPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+
ICsJaW50IGxldmVsLCBtYXhfbGV2ZWwgPSBpbGtfd21fbWF4X2xldmVsKGk5MTUpOwo+ICAgCWVu
dW0gcGxhbmVfaWQgcGxhbmVfaWQgPSBwbGFuZS0+aWQ7Cj4gICAJZW51bSBwaXBlIHBpcGUgPSBw
bGFuZS0+cGlwZTsKPiAgIAljb25zdCBzdHJ1Y3Qgc2tsX3BsYW5lX3dtICp3bSA9Cj4gQEAgLTUx
OTgsMTIgKzUxOTgsMTIgQEAgdm9pZCBza2xfd3JpdGVfY3Vyc29yX3dtKHN0cnVjdCBpbnRlbF9w
bGFuZSAqcGxhbmUsCj4gICAJCSZjcnRjX3N0YXRlLT53bS5za2wucGxhbmVfZGRiX3lbcGxhbmVf
aWRdOwo+ICAgCj4gICAJZm9yIChsZXZlbCA9IDA7IGxldmVsIDw9IG1heF9sZXZlbDsgbGV2ZWwr
Kykgewo+IC0JCXNrbF93cml0ZV93bV9sZXZlbChkZXZfcHJpdiwgQ1VSX1dNKHBpcGUsIGxldmVs
KSwKPiArCQlza2xfd3JpdGVfd21fbGV2ZWwoaTkxNSwgQ1VSX1dNKHBpcGUsIGxldmVsKSwKPiAg
IAkJCQkgICAmd20tPndtW2xldmVsXSk7Cj4gICAJfQo+IC0Jc2tsX3dyaXRlX3dtX2xldmVsKGRl
dl9wcml2LCBDVVJfV01fVFJBTlMocGlwZSksICZ3bS0+dHJhbnNfd20pOwo+ICsJc2tsX3dyaXRl
X3dtX2xldmVsKGk5MTUsIENVUl9XTV9UUkFOUyhwaXBlKSwgJndtLT50cmFuc193bSk7Cj4gICAK
PiAtCXNrbF9kZGJfZW50cnlfd3JpdGUoZGV2X3ByaXYsIENVUl9CVUZfQ0ZHKHBpcGUpLCBkZGIp
Owo+ICsJc2tsX2RkYl9lbnRyeV93cml0ZShpOTE1LCBDVVJfQlVGX0NGRyhwaXBlKSwgZGRiKTsK
PiAgIH0KPiAgIAo+ICAgYm9vbCBza2xfd21fbGV2ZWxfZXF1YWxzKGNvbnN0IHN0cnVjdCBza2xf
d21fbGV2ZWwgKmwxLAo+IEBAIC01MjE1LDExICs1MjE1LDExIEBAIGJvb2wgc2tsX3dtX2xldmVs
X2VxdWFscyhjb25zdCBzdHJ1Y3Qgc2tsX3dtX2xldmVsICpsMSwKPiAgIAkJbDEtPnBsYW5lX3Jl
c19iID09IGwyLT5wbGFuZV9yZXNfYjsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgYm9vbCBza2xfcGxh
bmVfd21fZXF1YWxzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGlj
IGJvb2wgc2tsX3BsYW5lX3dtX2VxdWFscyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
PiAgIAkJCQljb25zdCBzdHJ1Y3Qgc2tsX3BsYW5lX3dtICp3bTEsCj4gICAJCQkJY29uc3Qgc3Ry
dWN0IHNrbF9wbGFuZV93bSAqd20yKQo+ICAgewo+IC0JaW50IGxldmVsLCBtYXhfbGV2ZWwgPSBp
bGtfd21fbWF4X2xldmVsKGRldl9wcml2KTsKPiArCWludCBsZXZlbCwgbWF4X2xldmVsID0gaWxr
X3dtX21heF9sZXZlbChpOTE1KTsKPiAgIAo+ICAgCWZvciAobGV2ZWwgPSAwOyBsZXZlbCA8PSBt
YXhfbGV2ZWw7IGxldmVsKyspIHsKPiAgIAkJaWYgKCFza2xfd21fbGV2ZWxfZXF1YWxzKCZ3bTEt
PndtW2xldmVsXSwgJndtMi0+d21bbGV2ZWxdKSB8fAo+IEBAIC01MjM0LDExICs1MjM0LDExIEBA
IHN0YXRpYyBib29sIHNrbF9waXBlX3dtX2VxdWFscyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywK
PiAgIAkJCSAgICAgICBjb25zdCBzdHJ1Y3Qgc2tsX3BpcGVfd20gKndtMSwKPiAgIAkJCSAgICAg
ICBjb25zdCBzdHJ1Y3Qgc2tsX3BpcGVfd20gKndtMikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgIAll
bnVtIHBsYW5lX2lkIHBsYW5lX2lkOwo+ICAgCj4gICAJZm9yX2VhY2hfcGxhbmVfaWRfb25fY3J0
YyhjcnRjLCBwbGFuZV9pZCkgewo+IC0JCWlmICghc2tsX3BsYW5lX3dtX2VxdWFscyhkZXZfcHJp
diwKPiArCQlpZiAoIXNrbF9wbGFuZV93bV9lcXVhbHMoaTkxNSwKPiAgIAkJCQkJICZ3bTEtPnBs
YW5lc1twbGFuZV9pZF0sCj4gICAJCQkJCSAmd20yLT5wbGFuZXNbcGxhbmVfaWRdKSkKPiAgIAkJ
CXJldHVybiBmYWxzZTsKPiBAQCAtNTI4NywxMCArNTI4NywxMCBAQCBza2xfZGRiX2FkZF9hZmZl
Y3RlZF9wbGFuZXMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRl
LAo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlID0gdG9faW50ZWxf
YXRvbWljX3N0YXRlKG5ld19jcnRjX3N0YXRlLT5iYXNlLnN0YXRlKTsKPiAgIAlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMobmV3X2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJh
c2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZTsKPiAgIAo+IC0JZm9y
X2VhY2hfaW50ZWxfcGxhbmVfb25fY3J0YygmZGV2X3ByaXYtPmRybSwgY3J0YywgcGxhbmUpIHsK
PiArCWZvcl9lYWNoX2ludGVsX3BsYW5lX29uX2NydGMoJmk5MTUtPmRybSwgY3J0YywgcGxhbmUp
IHsKPiAgIAkJc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZTsKPiAgIAkJZW51
bSBwbGFuZV9pZCBwbGFuZV9pZCA9IHBsYW5lLT5pZDsKPiAgIAo+IEBAIC01MzEzLDE0ICs1MzEz
LDE0IEBAIHNrbF9kZGJfYWRkX2FmZmVjdGVkX3BsYW5lcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCj4gICBzdGF0aWMgaW50Cj4gICBza2xfY29tcHV0ZV9k
ZGIoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gICB7Cj4gLQljb25zdCBzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHN0YXRlLT5iYXNlLmRldik7
Cj4gKwljb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoc3RhdGUt
PmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3Qgc2tsX2RkYl9hbGxvY2F0aW9uICpkZGIgPSAmc3RhdGUt
PndtX3Jlc3VsdHMuZGRiOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19z
dGF0ZTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGU7Cj4gICAJ
c3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4gICAJaW50IHJldCwgaTsKPiAgIAo+IC0JbWVtY3B5
KGRkYiwgJmRldl9wcml2LT53bS5za2xfaHcuZGRiLCBzaXplb2YoKmRkYikpOwo+ICsJbWVtY3B5
KGRkYiwgJmk5MTUtPndtLnNrbF9ody5kZGIsIHNpemVvZigqZGRiKSk7Cj4gICAKPiAgIAlmb3Jf
ZWFjaF9vbGRuZXdfaW50ZWxfY3J0Y19pbl9zdGF0ZShzdGF0ZSwgY3J0Yywgb2xkX2NydGNfc3Rh
dGUsCj4gICAJCQkJCSAgICBuZXdfY3J0Y19zdGF0ZSwgaSkgewo+IEBAIC01MzQ1LDcgKzUzNDUs
NyBAQCBzdGF0aWMgY2hhciBlbmFzdChib29sIGVuYWJsZSkKPiAgIHN0YXRpYyB2b2lkCj4gICBz
a2xfcHJpbnRfd21fY2hhbmdlcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAg
IHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoc3RhdGUt
PmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShz
dGF0ZS0+YmFzZS5kZXYpOwo+ICAgCWNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRf
Y3J0Y19zdGF0ZTsKPiAgIAljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNf
c3RhdGU7Cj4gICAJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZTsKPiBAQCAtNTM2Miw3ICs1MzYy
LDcgQEAgc2tsX3ByaW50X3dtX2NoYW5nZXMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3Rh
dGUpCj4gICAJCW9sZF9waXBlX3dtID0gJm9sZF9jcnRjX3N0YXRlLT53bS5za2wub3B0aW1hbDsK
PiAgIAkJbmV3X3BpcGVfd20gPSAmbmV3X2NydGNfc3RhdGUtPndtLnNrbC5vcHRpbWFsOwo+ICAg
Cj4gLQkJZm9yX2VhY2hfaW50ZWxfcGxhbmVfb25fY3J0YygmZGV2X3ByaXYtPmRybSwgY3J0Yywg
cGxhbmUpIHsKPiArCQlmb3JfZWFjaF9pbnRlbF9wbGFuZV9vbl9jcnRjKCZpOTE1LT5kcm0sIGNy
dGMsIHBsYW5lKSB7Cj4gICAJCQllbnVtIHBsYW5lX2lkIHBsYW5lX2lkID0gcGxhbmUtPmlkOwo+
ICAgCQkJY29uc3Qgc3RydWN0IHNrbF9kZGJfZW50cnkgKm9sZCwgKm5ldzsKPiAgIAo+IEBAIC01
Mzc4LDE0ICs1Mzc4LDE0IEBAIHNrbF9wcmludF93bV9jaGFuZ2VzKHN0cnVjdCBpbnRlbF9hdG9t
aWNfc3RhdGUgKnN0YXRlKQo+ICAgCQkJCSAgICAgIHNrbF9kZGJfZW50cnlfc2l6ZShvbGQpLCBz
a2xfZGRiX2VudHJ5X3NpemUobmV3KSk7Cj4gICAJCX0KPiAgIAo+IC0JCWZvcl9lYWNoX2ludGVs
X3BsYW5lX29uX2NydGMoJmRldl9wcml2LT5kcm0sIGNydGMsIHBsYW5lKSB7Cj4gKwkJZm9yX2Vh
Y2hfaW50ZWxfcGxhbmVfb25fY3J0YygmaTkxNS0+ZHJtLCBjcnRjLCBwbGFuZSkgewo+ICAgCQkJ
ZW51bSBwbGFuZV9pZCBwbGFuZV9pZCA9IHBsYW5lLT5pZDsKPiAgIAkJCWNvbnN0IHN0cnVjdCBz
a2xfcGxhbmVfd20gKm9sZF93bSwgKm5ld193bTsKPiAgIAo+ICAgCQkJb2xkX3dtID0gJm9sZF9w
aXBlX3dtLT5wbGFuZXNbcGxhbmVfaWRdOwo+ICAgCQkJbmV3X3dtID0gJm5ld19waXBlX3dtLT5w
bGFuZXNbcGxhbmVfaWRdOwo+ICAgCj4gLQkJCWlmIChza2xfcGxhbmVfd21fZXF1YWxzKGRldl9w
cml2LCBvbGRfd20sIG5ld193bSkpCj4gKwkJCWlmIChza2xfcGxhbmVfd21fZXF1YWxzKGk5MTUs
IG9sZF93bSwgbmV3X3dtKSkKPiAgIAkJCQljb250aW51ZTsKPiAgIAo+ICAgCQkJRFJNX0RFQlVH
X0tNUygiW1BMQU5FOiVkOiVzXSAgIGxldmVsICVjd20wLCVjd20xLCVjd20yLCVjd20zLCVjd200
LCVjd201LCVjd202LCVjd203LCVjdHdtIgo+IEBAIC01NDYwLDcgKzU0NjAsNyBAQCBzdGF0aWMg
aW50Cj4gICBza2xfZGRiX2FkZF9hZmZlY3RlZF9waXBlcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0
YXRlICpzdGF0ZSwgYm9vbCAqY2hhbmdlZCkKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2ID0gc3RhdGUtPmJhc2UuZGV2Owo+IC0JY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4g
ICAJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGU7Cj4gICAJdTMyIHJlYWxsb2Nf
cGlwZXMgPSBwaXBlc19tb2RpZmllZChzdGF0ZSk7Cj4gQEAgLTU0NzAsMTQgKzU0NzAsMTQgQEAg
c2tsX2RkYl9hZGRfYWZmZWN0ZWRfcGlwZXMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3Rh
dGUsIGJvb2wgKmNoYW5nZWQpCj4gICAJICogV2hlbiB3ZSBkaXN0cnVzdCBiaW9zIHdtIHdlIGFs
d2F5cyBuZWVkIHRvIHJlY29tcHV0ZSB0byBzZXQgdGhlCj4gICAJICogZXhwZWN0ZWQgRERCIGFs
bG9jYXRpb25zIGZvciBlYWNoIENSVEMuCj4gICAJICovCj4gLQlpZiAoZGV2X3ByaXYtPndtLmRp
c3RydXN0X2Jpb3Nfd20pCj4gKwlpZiAoaTkxNS0+d20uZGlzdHJ1c3RfYmlvc193bSkKPiAgIAkJ
KCpjaGFuZ2VkKSA9IHRydWU7Cj4gICAKPiAgIAkvKgo+ICAgCSAqIElmIHRoaXMgdHJhbnNhY3Rp
b24gaXNuJ3QgYWN0dWFsbHkgdG91Y2hpbmcgYW55IENSVEMncywgZG9uJ3QKPiAgIAkgKiBib3Ro
ZXIgd2l0aCB3YXRlcm1hcmsgY2FsY3VsYXRpb24uICBOb3RlIHRoYXQgaWYgd2UgcGFzcyB0aGlz
Cj4gICAJICogdGVzdCwgd2UncmUgZ3VhcmFudGVlZCB0byBob2xkIGF0IGxlYXN0IG9uZSBDUlRD
IHN0YXRlIG11dGV4LAo+IC0JICogd2hpY2ggbWVhbnMgd2UgY2FuIHNhZmVseSB1c2UgdmFsdWVz
IGxpa2UgZGV2X3ByaXYtPmFjdGl2ZV9jcnRjcwo+ICsJICogd2hpY2ggbWVhbnMgd2UgY2FuIHNh
ZmVseSB1c2UgdmFsdWVzIGxpa2UgaTkxNS0+YWN0aXZlX2NydGNzCj4gICAJICogc2luY2UgYW55
IHJhY2luZyBjb21taXRzIHRoYXQgd2FudCB0byB1cGRhdGUgdGhlbSB3b3VsZCBuZWVkIHRvCj4g
ICAJICogaG9sZCBfYWxsXyBDUlRDIHN0YXRlIG11dGV4ZXMuCj4gICAJICovCj4gQEAgLTU0OTMs
NyArNTQ5Myw3IEBAIHNrbF9kZGJfYWRkX2FmZmVjdGVkX3BpcGVzKHN0cnVjdCBpbnRlbF9hdG9t
aWNfc3RhdGUgKnN0YXRlLCBib29sICpjaGFuZ2VkKQo+ICAgCSAqIHByZXRlbmQgdGhhdCBhbGwg
cGlwZXMgc3dpdGNoZWQgYWN0aXZlIHN0YXR1cyBzbyB0aGF0IHdlJ2xsCj4gICAJICogZW5zdXJl
IGEgZnVsbCBEREIgcmVjb21wdXRlLgo+ICAgCSAqLwo+IC0JaWYgKGRldl9wcml2LT53bS5kaXN0
cnVzdF9iaW9zX3dtKSB7Cj4gKwlpZiAoaTkxNS0+d20uZGlzdHJ1c3RfYmlvc193bSkgewo+ICAg
CQlyZXQgPSBkcm1fbW9kZXNldF9sb2NrKCZkZXYtPm1vZGVfY29uZmlnLmNvbm5lY3Rpb25fbXV0
ZXgsCj4gICAJCQkJICAgICAgIHN0YXRlLT5iYXNlLmFjcXVpcmVfY3R4KTsKPiAgIAkJaWYgKHJl
dCkKPiBAQCAtNTUwOCw3ICs1NTA4LDcgQEAgc2tsX2RkYl9hZGRfYWZmZWN0ZWRfcGlwZXMoc3Ry
dWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsIGJvb2wgKmNoYW5nZWQpCj4gICAJCSAqIG9u
IHRoZSBmaXJzdCBjb21taXQgdG9vLgo+ICAgCQkgKi8KPiAgIAkJaWYgKCFzdGF0ZS0+bW9kZXNl
dCkKPiAtCQkJc3RhdGUtPmFjdGl2ZV9jcnRjcyA9IGRldl9wcml2LT5hY3RpdmVfY3J0Y3M7Cj4g
KwkJCXN0YXRlLT5hY3RpdmVfY3J0Y3MgPSBpOTE1LT5hY3RpdmVfY3J0Y3M7Cj4gICAJfQo+ICAg
Cj4gICAJLyoKPiBAQCAtNTU2NywxNCArNTU2NywxNCBAQCBza2xfZGRiX2FkZF9hZmZlY3RlZF9w
aXBlcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwgYm9vbCAqY2hhbmdlZCkKPiAg
IHN0YXRpYyBpbnQgc2tsX3dtX2FkZF9hZmZlY3RlZF9wbGFuZXMoc3RydWN0IGludGVsX2F0b21p
Y19zdGF0ZSAqc3RhdGUsCj4gICAJCQkJICAgICAgc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMt
PmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShj
cnRjLT5iYXNlLmRldik7Cj4gICAJY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9j
cnRjX3N0YXRlID0KPiAgIAkJaW50ZWxfYXRvbWljX2dldF9vbGRfY3J0Y19zdGF0ZShzdGF0ZSwg
Y3J0Yyk7Cj4gICAJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlID0KPiAg
IAkJaW50ZWxfYXRvbWljX2dldF9uZXdfY3J0Y19zdGF0ZShzdGF0ZSwgY3J0Yyk7Cj4gICAJc3Ry
dWN0IGludGVsX3BsYW5lICpwbGFuZTsKPiAgIAo+IC0JZm9yX2VhY2hfaW50ZWxfcGxhbmVfb25f
Y3J0YygmZGV2X3ByaXYtPmRybSwgY3J0YywgcGxhbmUpIHsKPiArCWZvcl9lYWNoX2ludGVsX3Bs
YW5lX29uX2NydGMoJmk5MTUtPmRybSwgY3J0YywgcGxhbmUpIHsKPiAgIAkJc3RydWN0IGludGVs
X3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZTsKPiAgIAkJZW51bSBwbGFuZV9pZCBwbGFuZV9pZCA9
IHBsYW5lLT5pZDsKPiAgIAo+IEBAIC01NTg3LDcgKzU1ODcsNyBAQCBzdGF0aWMgaW50IHNrbF93
bV9hZGRfYWZmZWN0ZWRfcGxhbmVzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+
ICAgCQkgKiB3aXRoIHRoZSBzb2Z0d2FyZSBzdGF0ZS4KPiAgIAkJICovCj4gICAJCWlmICghZHJt
X2F0b21pY19jcnRjX25lZWRzX21vZGVzZXQoJm5ld19jcnRjX3N0YXRlLT5iYXNlKSAmJgo+IC0J
CSAgICBza2xfcGxhbmVfd21fZXF1YWxzKGRldl9wcml2LAo+ICsJCSAgICBza2xfcGxhbmVfd21f
ZXF1YWxzKGk5MTUsCj4gICAJCQkJCSZvbGRfY3J0Y19zdGF0ZS0+d20uc2tsLm9wdGltYWwucGxh
bmVzW3BsYW5lX2lkXSwKPiAgIAkJCQkJJm5ld19jcnRjX3N0YXRlLT53bS5za2wub3B0aW1hbC5w
bGFuZXNbcGxhbmVfaWRdKSkKPiAgIAkJCWNvbnRpbnVlOwo+IEBAIC01NjU0LDcgKzU2NTQsNyBA
QCBzdGF0aWMgdm9pZCBza2xfYXRvbWljX3VwZGF0ZV9jcnRjX3dtKHN0cnVjdCBpbnRlbF9hdG9t
aWNfc3RhdGUgKnN0YXRlLAo+ICAgCQkJCSAgICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
c3RhdGUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRj
KGNzdGF0ZS0+YmFzZS5jcnRjKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoc3RhdGUtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShzdGF0ZS0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBza2xfcGlwZV93
bSAqcGlwZV93bSA9ICZjc3RhdGUtPndtLnNrbC5vcHRpbWFsOwo+ICAgCWVudW0gcGlwZSBwaXBl
ID0gY3J0Yy0+cGlwZTsKPiAgIAo+IEBAIC01NjY5LDI3ICs1NjY5LDI3IEBAIHN0YXRpYyB2b2lk
IHNrbF9pbml0aWFsX3dtKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+ICAgewo+
ICAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0Yyhjc3RhdGUt
PmJhc2UuY3J0Yyk7Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGludGVsX2NydGMtPmJh
c2UuZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShk
ZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4g
ICAJc3RydWN0IHNrbF9kZGJfdmFsdWVzICpyZXN1bHRzID0gJnN0YXRlLT53bV9yZXN1bHRzOwo+
ICAgCj4gICAJaWYgKChyZXN1bHRzLT5kaXJ0eV9waXBlcyAmIGRybV9jcnRjX21hc2soJmludGVs
X2NydGMtPmJhc2UpKSA9PSAwKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCW11dGV4X2xvY2soJmRl
dl9wcml2LT53bS53bV9tdXRleCk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT53bS53bV9tdXRleCk7
Cj4gICAKPiAgIAlpZiAoY3N0YXRlLT5iYXNlLmFjdGl2ZV9jaGFuZ2VkKQo+ICAgCQlza2xfYXRv
bWljX3VwZGF0ZV9jcnRjX3dtKHN0YXRlLCBjc3RhdGUpOwo+ICAgCj4gLQltdXRleF91bmxvY2so
JmRldl9wcml2LT53bS53bV9tdXRleCk7Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPndtLndtX211
dGV4KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpbGtfY29tcHV0ZV93bV9jb25maWcoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCBpbGtfY29tcHV0
ZV93bV9jb25maWcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICBzdHJ1
Y3QgaW50ZWxfd21fY29uZmlnICpjb25maWcpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2NydGMg
KmNydGM7Cj4gICAKPiAgIAkvKiBDb21wdXRlIHRoZSBjdXJyZW50bHkgX2FjdGl2ZV8gY29uZmln
ICovCj4gLQlmb3JfZWFjaF9pbnRlbF9jcnRjKCZkZXZfcHJpdi0+ZHJtLCBjcnRjKSB7Cj4gKwlm
b3JfZWFjaF9pbnRlbF9jcnRjKCZpOTE1LT5kcm0sIGNydGMpIHsKPiAgIAkJY29uc3Qgc3RydWN0
IGludGVsX3BpcGVfd20gKndtID0gJmNydGMtPndtLmFjdGl2ZS5pbGs7Cj4gICAKPiAgIAkJaWYg
KCF3bS0+cGlwZV9lbmFibGVkKQo+IEBAIC01NzAxLDcgKzU3MDEsNyBAQCBzdGF0aWMgdm9pZCBp
bGtfY29tcHV0ZV93bV9jb25maWcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICAgCX0KPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpbGtfcHJvZ3JhbV93YXRlcm1hcmtzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaWxrX3Byb2dy
YW1fd2F0ZXJtYXJrcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAlz
dHJ1Y3QgaW50ZWxfcGlwZV93bSBscF93bV8xXzIgPSB7fSwgbHBfd21fNV82ID0ge30sICpiZXN0
X2xwX3dtOwo+ICAgCXN0cnVjdCBpbGtfd21fbWF4aW11bXMgbWF4Owo+IEBAIC01NzA5LDE4ICs1
NzA5LDE4IEBAIHN0YXRpYyB2b2lkIGlsa19wcm9ncmFtX3dhdGVybWFya3Moc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCXN0cnVjdCBpbGtfd21fdmFsdWVzIHJlc3VsdHMg
PSB7fTsKPiAgIAllbnVtIGludGVsX2RkYl9wYXJ0aXRpb25pbmcgcGFydGl0aW9uaW5nOwo+ICAg
Cj4gLQlpbGtfY29tcHV0ZV93bV9jb25maWcoZGV2X3ByaXYsICZjb25maWcpOwo+ICsJaWxrX2Nv
bXB1dGVfd21fY29uZmlnKGk5MTUsICZjb25maWcpOwo+ICAgCj4gLQlpbGtfY29tcHV0ZV93bV9t
YXhpbXVtcyhkZXZfcHJpdiwgMSwgJmNvbmZpZywgSU5URUxfRERCX1BBUlRfMV8yLCAmbWF4KTsK
PiAtCWlsa193bV9tZXJnZShkZXZfcHJpdiwgJmNvbmZpZywgJm1heCwgJmxwX3dtXzFfMik7Cj4g
KwlpbGtfY29tcHV0ZV93bV9tYXhpbXVtcyhpOTE1LCAxLCAmY29uZmlnLCBJTlRFTF9EREJfUEFS
VF8xXzIsICZtYXgpOwo+ICsJaWxrX3dtX21lcmdlKGk5MTUsICZjb25maWcsICZtYXgsICZscF93
bV8xXzIpOwo+ICAgCj4gICAJLyogNS82IHNwbGl0IG9ubHkgaW4gc2luZ2xlIHBpcGUgY29uZmln
IG9uIElWQisgKi8KPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDcgJiYKPiArCWlmIChJ
TlRFTF9HRU4oaTkxNSkgPj0gNyAmJgo+ICAgCSAgICBjb25maWcubnVtX3BpcGVzX2FjdGl2ZSA9
PSAxICYmIGNvbmZpZy5zcHJpdGVzX2VuYWJsZWQpIHsKPiAtCQlpbGtfY29tcHV0ZV93bV9tYXhp
bXVtcyhkZXZfcHJpdiwgMSwgJmNvbmZpZywgSU5URUxfRERCX1BBUlRfNV82LCAmbWF4KTsKPiAt
CQlpbGtfd21fbWVyZ2UoZGV2X3ByaXYsICZjb25maWcsICZtYXgsICZscF93bV81XzYpOwo+ICsJ
CWlsa19jb21wdXRlX3dtX21heGltdW1zKGk5MTUsIDEsICZjb25maWcsIElOVEVMX0REQl9QQVJU
XzVfNiwgJm1heCk7Cj4gKwkJaWxrX3dtX21lcmdlKGk5MTUsICZjb25maWcsICZtYXgsICZscF93
bV81XzYpOwo+ICAgCj4gLQkJYmVzdF9scF93bSA9IGlsa19maW5kX2Jlc3RfcmVzdWx0KGRldl9w
cml2LCAmbHBfd21fMV8yLCAmbHBfd21fNV82KTsKPiArCQliZXN0X2xwX3dtID0gaWxrX2ZpbmRf
YmVzdF9yZXN1bHQoaTkxNSwgJmxwX3dtXzFfMiwgJmxwX3dtXzVfNik7Cj4gICAJfSBlbHNlIHsK
PiAgIAkJYmVzdF9scF93bSA9ICZscF93bV8xXzI7Cj4gICAJfQo+IEBAIC01NzI4LDM1ICs1NzI4
LDM1IEBAIHN0YXRpYyB2b2lkIGlsa19wcm9ncmFtX3dhdGVybWFya3Moc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCXBhcnRpdGlvbmluZyA9IChiZXN0X2xwX3dtID09ICZs
cF93bV8xXzIpID8KPiAgIAkJICAgICAgIElOVEVMX0REQl9QQVJUXzFfMiA6IElOVEVMX0REQl9Q
QVJUXzVfNjsKPiAgIAo+IC0JaWxrX2NvbXB1dGVfd21fcmVzdWx0cyhkZXZfcHJpdiwgYmVzdF9s
cF93bSwgcGFydGl0aW9uaW5nLCAmcmVzdWx0cyk7Cj4gKwlpbGtfY29tcHV0ZV93bV9yZXN1bHRz
KGk5MTUsIGJlc3RfbHBfd20sIHBhcnRpdGlvbmluZywgJnJlc3VsdHMpOwo+ICAgCj4gLQlpbGtf
d3JpdGVfd21fdmFsdWVzKGRldl9wcml2LCAmcmVzdWx0cyk7Cj4gKwlpbGtfd3JpdGVfd21fdmFs
dWVzKGk5MTUsICZyZXN1bHRzKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgaWxrX2luaXRp
YWxfd2F0ZXJtYXJrcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKPiAgIAkJCQkg
ICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsK
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjc3RhdGUtPmJhc2Uu
Y3J0Yy0+ZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVs
X2NydGMoY3N0YXRlLT5iYXNlLmNydGMpOwo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+
d20ud21fbXV0ZXgpOwo+ICsJbXV0ZXhfbG9jaygmaTkxNS0+d20ud21fbXV0ZXgpOwo+ICAgCWlu
dGVsX2NydGMtPndtLmFjdGl2ZS5pbGsgPSBjc3RhdGUtPndtLmlsay5pbnRlcm1lZGlhdGU7Cj4g
LQlpbGtfcHJvZ3JhbV93YXRlcm1hcmtzKGRldl9wcml2KTsKPiAtCW11dGV4X3VubG9jaygmZGV2
X3ByaXYtPndtLndtX211dGV4KTsKPiArCWlsa19wcm9ncmFtX3dhdGVybWFya3MoaTkxNSk7Cj4g
KwltdXRleF91bmxvY2soJmk5MTUtPndtLndtX211dGV4KTsKPiAgIH0KPiAgIAo+ICAgc3RhdGlj
IHZvaWQgaWxrX29wdGltaXplX3dhdGVybWFya3Moc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAq
c3RhdGUsCj4gICAJCQkJICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUpCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNzdGF0ZS0+
YmFzZS5jcnRjLT5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGNzdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRl
bF9jcnRjID0gdG9faW50ZWxfY3J0Yyhjc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gICAKPiAtCW11dGV4
X2xvY2soJmRldl9wcml2LT53bS53bV9tdXRleCk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT53bS53
bV9tdXRleCk7Cj4gICAJaWYgKGNzdGF0ZS0+d20ubmVlZF9wb3N0dmJsX3VwZGF0ZSkgewo+ICAg
CQlpbnRlbF9jcnRjLT53bS5hY3RpdmUuaWxrID0gY3N0YXRlLT53bS5pbGsub3B0aW1hbDsKPiAt
CQlpbGtfcHJvZ3JhbV93YXRlcm1hcmtzKGRldl9wcml2KTsKPiArCQlpbGtfcHJvZ3JhbV93YXRl
cm1hcmtzKGk5MTUpOwo+ICAgCX0KPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPndtLndtX211
dGV4KTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+d20ud21fbXV0ZXgpOwo+ICAgfQo+ICAgCj4g
ICBzdGF0aWMgaW5saW5lIHZvaWQgc2tsX3dtX2xldmVsX2Zyb21fcmVnX3ZhbCh1MzIgdmFsLAo+
IEBAIC01NzcyLDEzICs1NzcyLDEzIEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBza2xfd21fbGV2ZWxf
ZnJvbV9yZWdfdmFsKHUzMiB2YWwsCj4gICB2b2lkIHNrbF9waXBlX3dtX2dldF9od19zdGF0ZShz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAkJCSAgICAgIHN0cnVjdCBza2xfcGlwZV93bSAq
b3V0KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsK
PiAgIAlpbnQgbGV2ZWwsIG1heF9sZXZlbDsKPiAgIAllbnVtIHBsYW5lX2lkIHBsYW5lX2lkOwo+
ICAgCXUzMiB2YWw7Cj4gICAKPiAtCW1heF9sZXZlbCA9IGlsa193bV9tYXhfbGV2ZWwoZGV2X3By
aXYpOwo+ICsJbWF4X2xldmVsID0gaWxrX3dtX21heF9sZXZlbChpOTE1KTsKPiAgIAo+ICAgCWZv
cl9lYWNoX3BsYW5lX2lkX29uX2NydGMoY3J0YywgcGxhbmVfaWQpIHsKPiAgIAkJc3RydWN0IHNr
bF9wbGFuZV93bSAqd20gPSAmb3V0LT5wbGFuZXNbcGxhbmVfaWRdOwo+IEBAIC01ODA2LDE1ICs1
ODA2LDE1IEBAIHZvaWQgc2tsX3BpcGVfd21fZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjLAo+ICAgCW91dC0+bGluZXRpbWUgPSBJOTE1X1JFQUQoUElQRV9XTV9MSU5FVElNRShw
aXBlKSk7Cj4gICB9Cj4gICAKPiAtdm9pZCBza2xfd21fZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBza2xfd21fZ2V0X2h3X3N0YXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3RydWN0IHNrbF9kZGJfdmFsdWVz
ICpodyA9ICZkZXZfcHJpdi0+d20uc2tsX2h3Owo+IC0Jc3RydWN0IHNrbF9kZGJfYWxsb2NhdGlv
biAqZGRiID0gJmRldl9wcml2LT53bS5za2xfaHcuZGRiOwo+ICsJc3RydWN0IHNrbF9kZGJfdmFs
dWVzICpodyA9ICZpOTE1LT53bS5za2xfaHc7Cj4gKwlzdHJ1Y3Qgc2tsX2RkYl9hbGxvY2F0aW9u
ICpkZGIgPSAmaTkxNS0+d20uc2tsX2h3LmRkYjsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YzsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlOwo+ICAgCj4gLQlza2xfZGRi
X2dldF9od19zdGF0ZShkZXZfcHJpdiwgZGRiKTsKPiAtCWZvcl9lYWNoX2ludGVsX2NydGMoJmRl
dl9wcml2LT5kcm0sIGNydGMpIHsKPiArCXNrbF9kZGJfZ2V0X2h3X3N0YXRlKGk5MTUsIGRkYik7
Cj4gKwlmb3JfZWFjaF9pbnRlbF9jcnRjKCZpOTE1LT5kcm0sIGNydGMpIHsKPiAgIAkJY3N0YXRl
ID0gdG9faW50ZWxfY3J0Y19zdGF0ZShjcnRjLT5iYXNlLnN0YXRlKTsKPiAgIAo+ICAgCQlza2xf
cGlwZV93bV9nZXRfaHdfc3RhdGUoY3J0YywgJmNzdGF0ZS0+d20uc2tsLm9wdGltYWwpOwo+IEBA
IC01ODIzLDE3ICs1ODIzLDE3IEBAIHZvaWQgc2tsX3dtX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCQlody0+ZGlydHlfcGlwZXMgfD0gZHJtX2Ny
dGNfbWFzaygmY3J0Yy0+YmFzZSk7Cj4gICAJfQo+ICAgCj4gLQlpZiAoZGV2X3ByaXYtPmFjdGl2
ZV9jcnRjcykgewo+ICsJaWYgKGk5MTUtPmFjdGl2ZV9jcnRjcykgewo+ICAgCQkvKiBGdWxseSBy
ZWNvbXB1dGUgRERCIG9uIGZpcnN0IGF0b21pYyBjb21taXQgKi8KPiAtCQlkZXZfcHJpdi0+d20u
ZGlzdHJ1c3RfYmlvc193bSA9IHRydWU7Cj4gKwkJaTkxNS0+d20uZGlzdHJ1c3RfYmlvc193bSA9
IHRydWU7Cj4gICAJfQo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZCBpbGtfcGlwZV93bV9nZXRf
aHdfc3RhdGUoc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gICB7Cj4gICAJc3RydWN0IGRybV9k
ZXZpY2UgKmRldiA9IGNydGMtPmJhc2UuZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+IC0Jc3RydWN0IGlsa193bV92YWx1ZXMgKmh3ID0g
JmRldl9wcml2LT53bS5odzsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShkZXYpOwo+ICsJc3RydWN0IGlsa193bV92YWx1ZXMgKmh3ID0gJmk5MTUtPndtLmh3Owo+
ICAgCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUgPSB0b19pbnRlbF9jcnRjX3N0YXRl
KGNydGMtPmJhc2Uuc3RhdGUpOwo+ICAgCXN0cnVjdCBpbnRlbF9waXBlX3dtICphY3RpdmUgPSAm
Y3N0YXRlLT53bS5pbGsub3B0aW1hbDsKPiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7
Cj4gQEAgLTU4NDQsNyArNTg0NCw3IEBAIHN0YXRpYyB2b2lkIGlsa19waXBlX3dtX2dldF9od19z
dGF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiAgIAl9Owo+ICAgCj4gICAJaHctPndtX3Bp
cGVbcGlwZV0gPSBJOTE1X1JFQUQod20wX3BpcGVfcmVnW3BpcGVdKTsKPiAtCWlmIChJU19IQVNX
RUxMKGRldl9wcml2KSB8fCBJU19CUk9BRFdFTEwoZGV2X3ByaXYpKQo+ICsJaWYgKElTX0hBU1dF
TEwoaTkxNSkgfHwgSVNfQlJPQURXRUxMKGk5MTUpKQo+ICAgCQlody0+d21fbGluZXRpbWVbcGlw
ZV0gPSBJOTE1X1JFQUQoUElQRV9XTV9MSU5FVElNRShwaXBlKSk7Cj4gICAKPiAgIAltZW1zZXQo
YWN0aXZlLCAwLCBzaXplb2YoKmFjdGl2ZSkpOwo+IEBAIC01ODY2LDcgKzU4NjYsNyBAQCBzdGF0
aWMgdm9pZCBpbGtfcGlwZV93bV9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVsX2NydGMgKmNydGMp
Cj4gICAJCWFjdGl2ZS0+d21bMF0uY3VyX3ZhbCA9IHRtcCAmIFdNMF9QSVBFX0NVUlNPUl9NQVNL
Owo+ICAgCQlhY3RpdmUtPmxpbmV0aW1lID0gaHctPndtX2xpbmV0aW1lW3BpcGVdOwo+ICAgCX0g
ZWxzZSB7Cj4gLQkJaW50IGxldmVsLCBtYXhfbGV2ZWwgPSBpbGtfd21fbWF4X2xldmVsKGRldl9w
cml2KTsKPiArCQlpbnQgbGV2ZWwsIG1heF9sZXZlbCA9IGlsa193bV9tYXhfbGV2ZWwoaTkxNSk7
Cj4gICAKPiAgIAkJLyoKPiAgIAkJICogRm9yIGluYWN0aXZlIHBpcGVzLCBhbGwgd2F0ZXJtYXJr
IGxldmVscwo+IEBAIC01ODg1LDcgKzU4ODUsNyBAQCBzdGF0aWMgdm9pZCBpbGtfcGlwZV93bV9n
ZXRfaHdfc3RhdGUoc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gICAjZGVmaW5lIF9GV19XTV9W
TFYodmFsdWUsIHBsYW5lKSBcCj4gICAJKCgodmFsdWUpICYgRFNQRldfICMjIHBsYW5lICMjIF9N
QVNLX1ZMVikgPj4gRFNQRldfICMjIHBsYW5lICMjIF9TSElGVCkKPiAgIAo+IC1zdGF0aWMgdm9p
ZCBnNHhfcmVhZF93bV92YWx1ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICtzdGF0aWMgdm9pZCBnNHhfcmVhZF93bV92YWx1ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCj4gICAJCQkgICAgICAgc3RydWN0IGc0eF93bV92YWx1ZXMgKndtKQo+ICAgewo+ICAg
CXUzMiB0bXA7Cj4gQEAgLTU5MTEsMTMgKzU5MTEsMTMgQEAgc3RhdGljIHZvaWQgZzR4X3JlYWRf
d21fdmFsdWVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAl3bS0+aHBs
bC5wbGFuZSA9IF9GV19XTSh0bXAsIEhQTExfU1IpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lk
IHZsdl9yZWFkX3dtX3ZhbHVlcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
K3N0YXRpYyB2b2lkIHZsdl9yZWFkX3dtX3ZhbHVlcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiAgIAkJCSAgICAgICBzdHJ1Y3Qgdmx2X3dtX3ZhbHVlcyAqd20pCj4gICB7Cj4gICAJ
ZW51bSBwaXBlIHBpcGU7Cj4gICAJdTMyIHRtcDsKPiAgIAo+IC0JZm9yX2VhY2hfcGlwZShkZXZf
cHJpdiwgcGlwZSkgewo+ICsJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKSB7Cj4gICAJCXRtcCA9
IEk5MTVfUkVBRChWTFZfRERMKHBpcGUpKTsKPiAgIAo+ICAgCQl3bS0+ZGRsW3BpcGVdLnBsYW5l
W1BMQU5FX1BSSU1BUlldID0KPiBAQCAtNTk0NCw3ICs1OTQ0LDcgQEAgc3RhdGljIHZvaWQgdmx2
X3JlYWRfd21fdmFsdWVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAl0
bXAgPSBJOTE1X1JFQUQoRFNQRlczKTsKPiAgIAl3bS0+c3IuY3Vyc29yID0gX0ZXX1dNKHRtcCwg
Q1VSU09SX1NSKTsKPiAgIAo+IC0JaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gKwlp
ZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkgewo+ICAgCQl0bXAgPSBJOTE1X1JFQUQoRFNQRlc3X0NI
Vik7Cj4gICAJCXdtLT5waXBlW1BJUEVfQl0ucGxhbmVbUExBTkVfU1BSSVRFMV0gPSBfRldfV01f
VkxWKHRtcCwgU1BSSVRFRCk7Cj4gICAJCXdtLT5waXBlW1BJUEVfQl0ucGxhbmVbUExBTkVfU1BS
SVRFMF0gPSBfRldfV01fVkxWKHRtcCwgU1BSSVRFQyk7Cj4gQEAgLTU5ODcsMTYgKzU5ODcsMTYg
QEAgc3RhdGljIHZvaWQgdmx2X3JlYWRfd21fdmFsdWVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiAgICN1bmRlZiBfRldfV00KPiAgICN1bmRlZiBfRldfV01fVkxWCj4gICAK
PiAtdm9pZCBnNHhfd21fZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiArdm9pZCBnNHhfd21fZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQo+ICAgewo+IC0Jc3RydWN0IGc0eF93bV92YWx1ZXMgKndtID0gJmRldl9wcml2LT53
bS5nNHg7Cj4gKwlzdHJ1Y3QgZzR4X3dtX3ZhbHVlcyAqd20gPSAmaTkxNS0+d20uZzR4Owo+ICAg
CXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOwo+ICAgCj4gLQlnNHhfcmVhZF93bV92YWx1ZXMoZGV2
X3ByaXYsIHdtKTsKPiArCWc0eF9yZWFkX3dtX3ZhbHVlcyhpOTE1LCB3bSk7Cj4gICAKPiAgIAl3
bS0+Y3hzciA9IEk5MTVfUkVBRChGV19CTENfU0VMRikgJiBGV19CTENfU0VMRl9FTjsKPiAgIAo+
IC0JZm9yX2VhY2hfaW50ZWxfY3J0YygmZGV2X3ByaXYtPmRybSwgY3J0Yykgewo+ICsJZm9yX2Vh
Y2hfaW50ZWxfY3J0YygmaTkxNS0+ZHJtLCBjcnRjKSB7Cj4gICAJCXN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlID0KPiAgIAkJCXRvX2ludGVsX2NydGNfc3RhdGUoY3J0Yy0+YmFz
ZS5zdGF0ZSk7Cj4gICAJCXN0cnVjdCBnNHhfd21fc3RhdGUgKmFjdGl2ZSA9ICZjcnRjLT53bS5h
Y3RpdmUuZzR4Owo+IEBAIC02MDcxLDE2ICs2MDcxLDE2IEBAIHZvaWQgZzR4X3dtX2dldF9od19z
dGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCSAgICAgIHllc25v
KHdtLT5jeHNyKSwgeWVzbm8od20tPmhwbGxfZW4pLCB5ZXNubyh3bS0+ZmJjX2VuKSk7Cj4gICB9
Cj4gICAKPiAtdm9pZCBnNHhfd21fc2FuaXRpemUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ICt2b2lkIGc0eF93bV9zYW5pdGl6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lOwo+ICAgCXN0cnVjdCBp
bnRlbF9jcnRjICpjcnRjOwo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+d20ud21fbXV0
ZXgpOwo+ICsJbXV0ZXhfbG9jaygmaTkxNS0+d20ud21fbXV0ZXgpOwo+ICAgCj4gLQlmb3JfZWFj
aF9pbnRlbF9wbGFuZSgmZGV2X3ByaXYtPmRybSwgcGxhbmUpIHsKPiArCWZvcl9lYWNoX2ludGVs
X3BsYW5lKCZpOTE1LT5kcm0sIHBsYW5lKSB7Cj4gICAJCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
ID0KPiAtCQkJaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIHBsYW5lLT5waXBlKTsK
PiArCQkJaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoaTkxNSwgcGxhbmUtPnBpcGUpOwo+ICAgCQlz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9Cj4gICAJCQl0b19pbnRlbF9jcnRj
X3N0YXRlKGNydGMtPmJhc2Uuc3RhdGUpOwo+ICAgCQlzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUg
KnBsYW5lX3N0YXRlID0KPiBAQCAtNjExMyw3ICs2MTEzLDcgQEAgdm9pZCBnNHhfd21fc2FuaXRp
emUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQl9Cj4gICAJfQo+ICAg
Cj4gLQlmb3JfZWFjaF9pbnRlbF9jcnRjKCZkZXZfcHJpdi0+ZHJtLCBjcnRjKSB7Cj4gKwlmb3Jf
ZWFjaF9pbnRlbF9jcnRjKCZpOTE1LT5kcm0sIGNydGMpIHsKPiAgIAkJc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUgPQo+ICAgCQkJdG9faW50ZWxfY3J0Y19zdGF0ZShjcnRjLT5i
YXNlLnN0YXRlKTsKPiAgIAo+IEBAIC02MTIyLDI2ICs2MTIyLDI2IEBAIHZvaWQgZzR4X3dtX3Nh
bml0aXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkJY3J0Yy0+d20u
YWN0aXZlLmc0eCA9IGNydGNfc3RhdGUtPndtLmc0eC5vcHRpbWFsOwo+ICAgCX0KPiAgIAo+IC0J
ZzR4X3Byb2dyYW1fd2F0ZXJtYXJrcyhkZXZfcHJpdik7Cj4gKwlnNHhfcHJvZ3JhbV93YXRlcm1h
cmtzKGk5MTUpOwo+ICAgCj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT53bS53bV9tdXRleCk7
Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPndtLndtX211dGV4KTsKPiAgIH0KPiAgIAo+IC12b2lk
IHZsdl93bV9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ICt2b2lkIHZsdl93bV9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gICB7Cj4gLQlzdHJ1Y3Qgdmx2X3dtX3ZhbHVlcyAqd20gPSAmZGV2X3ByaXYtPndtLnZsdjsK
PiArCXN0cnVjdCB2bHZfd21fdmFsdWVzICp3bSA9ICZpOTE1LT53bS52bHY7Cj4gICAJc3RydWN0
IGludGVsX2NydGMgKmNydGM7Cj4gICAJdTMyIHZhbDsKPiAgIAo+IC0Jdmx2X3JlYWRfd21fdmFs
dWVzKGRldl9wcml2LCB3bSk7Cj4gKwl2bHZfcmVhZF93bV92YWx1ZXMoaTkxNSwgd20pOwo+ICAg
Cj4gICAJd20tPmN4c3IgPSBJOTE1X1JFQUQoRldfQkxDX1NFTEZfVkxWKSAmIEZXX0NTUFdSRFdO
RU47Cj4gICAJd20tPmxldmVsID0gVkxWX1dNX0xFVkVMX1BNMjsKPiAgIAo+IC0JaWYgKElTX0NI
RVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gLQkJdmx2X3B1bml0X2dldChkZXZfcHJpdik7Cj4gKwlp
ZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkgewo+ICsJCXZsdl9wdW5pdF9nZXQoaTkxNSk7Cj4gICAK
PiAtCQl2YWwgPSB2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgUFVOSVRfUkVHX0RTUFNTUE0pOwo+
ICsJCXZhbCA9IHZsdl9wdW5pdF9yZWFkKGk5MTUsIFBVTklUX1JFR19EU1BTU1BNKTsKPiAgIAkJ
aWYgKHZhbCAmIERTUF9NQVhGSUZPX1BNNV9FTkFCTEUpCj4gICAJCQl3bS0+bGV2ZWwgPSBWTFZf
V01fTEVWRUxfUE01Owo+ICAgCj4gQEAgLTYxNTQsMjUgKzYxNTQsMjUgQEAgdm9pZCB2bHZfd21f
Z2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkJICog
SElHSC9MT1cgYml0cyBzbyB0aGF0IHdlIGRvbid0IGFjdHVhbGx5IGNoYW5nZQo+ICAgCQkgKiB0
aGUgY3VycmVudCBzdGF0ZS4KPiAgIAkJICovCj4gLQkJdmFsID0gdmx2X3B1bml0X3JlYWQoZGV2
X3ByaXYsIFBVTklUX1JFR19ERFJfU0VUVVAyKTsKPiArCQl2YWwgPSB2bHZfcHVuaXRfcmVhZChp
OTE1LCBQVU5JVF9SRUdfRERSX1NFVFVQMik7Cj4gICAJCXZhbCB8PSBGT1JDRV9ERFJfRlJFUV9S
RVFfQUNLOwo+IC0JCXZsdl9wdW5pdF93cml0ZShkZXZfcHJpdiwgUFVOSVRfUkVHX0REUl9TRVRV
UDIsIHZhbCk7Cj4gKwkJdmx2X3B1bml0X3dyaXRlKGk5MTUsIFBVTklUX1JFR19ERFJfU0VUVVAy
LCB2YWwpOwo+ICAgCj4gLQkJaWYgKHdhaXRfZm9yKCh2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwg
UFVOSVRfUkVHX0REUl9TRVRVUDIpICYKPiArCQlpZiAod2FpdF9mb3IoKHZsdl9wdW5pdF9yZWFk
KGk5MTUsIFBVTklUX1JFR19ERFJfU0VUVVAyKSAmCj4gICAJCQkgICAgICBGT1JDRV9ERFJfRlJF
UV9SRVFfQUNLKSA9PSAwLCAzKSkgewo+ICAgCQkJRFJNX0RFQlVHX0tNUygiUHVuaXQgbm90IGFj
a2luZyBERFIgRFZGUyByZXF1ZXN0LCAiCj4gICAJCQkJICAgICAgImFzc3VtaW5nIEREUiBEVkZT
IGlzIGRpc2FibGVkXG4iKTsKPiAtCQkJZGV2X3ByaXYtPndtLm1heF9sZXZlbCA9IFZMVl9XTV9M
RVZFTF9QTTU7Cj4gKwkJCWk5MTUtPndtLm1heF9sZXZlbCA9IFZMVl9XTV9MRVZFTF9QTTU7Cj4g
ICAJCX0gZWxzZSB7Cj4gLQkJCXZhbCA9IHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9S
RUdfRERSX1NFVFVQMik7Cj4gKwkJCXZhbCA9IHZsdl9wdW5pdF9yZWFkKGk5MTUsIFBVTklUX1JF
R19ERFJfU0VUVVAyKTsKPiAgIAkJCWlmICgodmFsICYgRk9SQ0VfRERSX0hJR0hfRlJFUSkgPT0g
MCkKPiAgIAkJCQl3bS0+bGV2ZWwgPSBWTFZfV01fTEVWRUxfRERSX0RWRlM7Cj4gICAJCX0KPiAg
IAo+IC0JCXZsdl9wdW5pdF9wdXQoZGV2X3ByaXYpOwo+ICsJCXZsdl9wdW5pdF9wdXQoaTkxNSk7
Cj4gICAJfQo+ICAgCj4gLQlmb3JfZWFjaF9pbnRlbF9jcnRjKCZkZXZfcHJpdi0+ZHJtLCBjcnRj
KSB7Cj4gKwlmb3JfZWFjaF9pbnRlbF9jcnRjKCZpOTE1LT5kcm0sIGNydGMpIHsKPiAgIAkJc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUgPQo+ICAgCQkJdG9faW50ZWxfY3J0Y19z
dGF0ZShjcnRjLT5iYXNlLnN0YXRlKTsKPiAgIAkJc3RydWN0IHZsdl93bV9zdGF0ZSAqYWN0aXZl
ID0gJmNydGMtPndtLmFjdGl2ZS52bHY7Cj4gQEAgLTYyMjQsMTYgKzYyMjQsMTYgQEAgdm9pZCB2
bHZfd21fZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAg
IAkJICAgICAgd20tPnNyLnBsYW5lLCB3bS0+c3IuY3Vyc29yLCB3bS0+bGV2ZWwsIHdtLT5jeHNy
KTsKPiAgIH0KPiAgIAo+IC12b2lkIHZsdl93bV9zYW5pdGl6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgdmx2X3dtX3Nhbml0aXplKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmU7Cj4gICAJ
c3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4gICAKPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT53
bS53bV9tdXRleCk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT53bS53bV9tdXRleCk7Cj4gICAKPiAt
CWZvcl9lYWNoX2ludGVsX3BsYW5lKCZkZXZfcHJpdi0+ZHJtLCBwbGFuZSkgewo+ICsJZm9yX2Vh
Y2hfaW50ZWxfcGxhbmUoJmk5MTUtPmRybSwgcGxhbmUpIHsKPiAgIAkJc3RydWN0IGludGVsX2Ny
dGMgKmNydGMgPQo+IC0JCQlpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShkZXZfcHJpdiwgcGxhbmUt
PnBpcGUpOwo+ICsJCQlpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShpOTE1LCBwbGFuZS0+cGlwZSk7
Cj4gICAJCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlID0KPiAgIAkJCXRvX2lu
dGVsX2NydGNfc3RhdGUoY3J0Yy0+YmFzZS5zdGF0ZSk7Cj4gICAJCXN0cnVjdCBpbnRlbF9wbGFu
ZV9zdGF0ZSAqcGxhbmVfc3RhdGUgPQo+IEBAIC02MjU5LDcgKzYyNTksNyBAQCB2b2lkIHZsdl93
bV9zYW5pdGl6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCX0KPiAg
IAl9Cj4gICAKPiAtCWZvcl9lYWNoX2ludGVsX2NydGMoJmRldl9wcml2LT5kcm0sIGNydGMpIHsK
PiArCWZvcl9lYWNoX2ludGVsX2NydGMoJmk5MTUtPmRybSwgY3J0Yykgewo+ICAgCQlzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9Cj4gICAJCQl0b19pbnRlbF9jcnRjX3N0YXRl
KGNydGMtPmJhc2Uuc3RhdGUpOwo+ICAgCj4gQEAgLTYyNjgsMTYgKzYyNjgsMTYgQEAgdm9pZCB2
bHZfd21fc2FuaXRpemUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQlj
cnRjLT53bS5hY3RpdmUudmx2ID0gY3J0Y19zdGF0ZS0+d20udmx2Lm9wdGltYWw7Cj4gICAJfQo+
ICAgCj4gLQl2bHZfcHJvZ3JhbV93YXRlcm1hcmtzKGRldl9wcml2KTsKPiArCXZsdl9wcm9ncmFt
X3dhdGVybWFya3MoaTkxNSk7Cj4gICAKPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPndtLndt
X211dGV4KTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+d20ud21fbXV0ZXgpOwo+ICAgfQo+ICAg
Cj4gICAvKgo+ICAgICogRklYTUUgc2hvdWxkIHByb2JhYmx5IGtpbGwgdGhpcyBhbmQgaW1wcm92
ZQo+ICAgICogdGhlIHJlYWwgd2F0ZXJtYXJrIHJlYWRvdXQvc2FuaXRhdGlvbiBpbnN0ZWFkCj4g
ICAgKi8KPiAtc3RhdGljIHZvaWQgaWxrX2luaXRfbHBfd2F0ZXJtYXJrcyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGlsa19pbml0X2xwX3dhdGVybWFy
a3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJSTkxNV9XUklURShX
TTNfTFBfSUxLLCBJOTE1X1JFQUQoV00zX0xQX0lMSykgJiB+V00xX0xQX1NSX0VOKTsKPiAgIAlJ
OTE1X1dSSVRFKFdNMl9MUF9JTEssIEk5MTVfUkVBRChXTTJfTFBfSUxLKSAmIH5XTTFfTFBfU1Jf
RU4pOwo+IEBAIC02Mjg5LDE0ICs2Mjg5LDE0IEBAIHN0YXRpYyB2b2lkIGlsa19pbml0X2xwX3dh
dGVybWFya3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCSAqLwo+ICAg
fQo+ICAgCj4gLXZvaWQgaWxrX3dtX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgaWxrX3dtX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVjdCBpbGtfd21fdmFsdWVzICpodyA9ICZkZXZf
cHJpdi0+d20uaHc7Cj4gKwlzdHJ1Y3QgaWxrX3dtX3ZhbHVlcyAqaHcgPSAmaTkxNS0+d20uaHc7
Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4gICAKPiAtCWlsa19pbml0X2xwX3dhdGVy
bWFya3MoZGV2X3ByaXYpOwo+ICsJaWxrX2luaXRfbHBfd2F0ZXJtYXJrcyhpOTE1KTsKPiAgIAo+
IC0JZm9yX2VhY2hfaW50ZWxfY3J0YygmZGV2X3ByaXYtPmRybSwgY3J0YykKPiArCWZvcl9lYWNo
X2ludGVsX2NydGMoJmk5MTUtPmRybSwgY3J0YykKPiAgIAkJaWxrX3BpcGVfd21fZ2V0X2h3X3N0
YXRlKGNydGMpOwo+ICAgCj4gICAJaHctPndtX2xwWzBdID0gSTkxNV9SRUFEKFdNMV9MUF9JTEsp
Owo+IEBAIC02MzA0LDE1ICs2MzA0LDE1IEBAIHZvaWQgaWxrX3dtX2dldF9od19zdGF0ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJaHctPndtX2xwWzJdID0gSTkxNV9S
RUFEKFdNM19MUF9JTEspOwo+ICAgCj4gICAJaHctPndtX2xwX3NwclswXSA9IEk5MTVfUkVBRChX
TTFTX0xQX0lMSyk7Cj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA3KSB7Cj4gKwlpZiAo
SU5URUxfR0VOKGk5MTUpID49IDcpIHsKPiAgIAkJaHctPndtX2xwX3NwclsxXSA9IEk5MTVfUkVB
RChXTTJTX0xQX0lWQik7Cj4gICAJCWh3LT53bV9scF9zcHJbMl0gPSBJOTE1X1JFQUQoV00zU19M
UF9JVkIpOwo+ICAgCX0KPiAgIAo+IC0JaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElTX0JS
T0FEV0VMTChkZXZfcHJpdikpCj4gKwlpZiAoSVNfSEFTV0VMTChpOTE1KSB8fCBJU19CUk9BRFdF
TEwoaTkxNSkpCj4gICAJCWh3LT5wYXJ0aXRpb25pbmcgPSAoSTkxNV9SRUFEKFdNX01JU0MpICYg
V01fTUlTQ19EQVRBX1BBUlRJVElPTl81XzYpID8KPiAgIAkJCUlOVEVMX0REQl9QQVJUXzVfNiA6
IElOVEVMX0REQl9QQVJUXzFfMjsKPiAtCWVsc2UgaWYgKElTX0lWWUJSSURHRShkZXZfcHJpdikp
Cj4gKwllbHNlIGlmIChJU19JVllCUklER0UoaTkxNSkpCj4gICAJCWh3LT5wYXJ0aXRpb25pbmcg
PSAoSTkxNV9SRUFEKERJU1BfQVJCX0NUTDIpICYgRElTUF9EQVRBX1BBUlRJVElPTl81XzYpID8K
PiAgIAkJCUlOVEVMX0REQl9QQVJUXzVfNiA6IElOVEVMX0REQl9QQVJUXzFfMjsKPiAgIAo+IEBA
IC02MzU1LDIyICs2MzU1LDIyIEBAIHZvaWQgaWxrX3dtX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAgKi8KPiAgIHZvaWQgaW50ZWxfdXBkYXRlX3dh
dGVybWFya3Moc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gICAK
PiAtCWlmIChkZXZfcHJpdi0+ZGlzcGxheS51cGRhdGVfd20pCj4gLQkJZGV2X3ByaXYtPmRpc3Bs
YXkudXBkYXRlX3dtKGNydGMpOwo+ICsJaWYgKGk5MTUtPmRpc3BsYXkudXBkYXRlX3dtKQo+ICsJ
CWk5MTUtPmRpc3BsYXkudXBkYXRlX3dtKGNydGMpOwo+ICAgfQo+ICAgCj4gLXZvaWQgaW50ZWxf
ZW5hYmxlX2lwYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQgaW50
ZWxfZW5hYmxlX2lwYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAl1
MzIgdmFsOwo+ICAgCj4gLQlpZiAoIUhBU19JUEMoZGV2X3ByaXYpKQo+ICsJaWYgKCFIQVNfSVBD
KGk5MTUpKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAl2YWwgPSBJOTE1X1JFQUQoRElTUF9BUkJf
Q1RMMik7Cj4gICAKPiAtCWlmIChkZXZfcHJpdi0+aXBjX2VuYWJsZWQpCj4gKwlpZiAoaTkxNS0+
aXBjX2VuYWJsZWQpCj4gICAJCXZhbCB8PSBESVNQX0lQQ19FTkFCTEU7Cj4gICAJZWxzZQo+ICAg
CQl2YWwgJj0gfkRJU1BfSVBDX0VOQUJMRTsKPiBAQCAtNjM3OCwyNyArNjM3OCwyNyBAQCB2b2lk
IGludGVsX2VuYWJsZV9pcGMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAg
CUk5MTVfV1JJVEUoRElTUF9BUkJfQ1RMMiwgdmFsKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgYm9v
bCBpbnRlbF9jYW5fZW5hYmxlX2lwYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gK3N0YXRpYyBib29sIGludGVsX2Nhbl9lbmFibGVfaXBjKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ICAgewo+ICAgCS8qIERpc3BsYXkgV0EgIzA0NzcgV2FEaXNhYmxlSVBDOiBz
a2wgKi8KPiAtCWlmIChJU19TS1lMQUtFKGRldl9wcml2KSkKPiArCWlmIChJU19TS1lMQUtFKGk5
MTUpKQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gICAKPiAgIAkvKiBEaXNwbGF5IFdBICMxMTQxOiBT
S0w6YWxsIEtCTDphbGwgQ0ZMICovCj4gLQlpZiAoSVNfS0FCWUxBS0UoZGV2X3ByaXYpIHx8IElT
X0NPRkZFRUxBS0UoZGV2X3ByaXYpKQo+IC0JCXJldHVybiBkZXZfcHJpdi0+ZHJhbV9pbmZvLnN5
bW1ldHJpY19tZW1vcnk7Cj4gKwlpZiAoSVNfS0FCWUxBS0UoaTkxNSkgfHwgSVNfQ09GRkVFTEFL
RShpOTE1KSkKPiArCQlyZXR1cm4gaTkxNS0+ZHJhbV9pbmZvLnN5bW1ldHJpY19tZW1vcnk7Cj4g
ICAKPiAgIAlyZXR1cm4gdHJ1ZTsKPiAgIH0KPiAgIAo+IC12b2lkIGludGVsX2luaXRfaXBjKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBpbnRlbF9pbml0X2lwYyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCWlmICghSEFTX0lQQyhkZXZf
cHJpdikpCj4gKwlpZiAoIUhBU19JUEMoaTkxNSkpCj4gICAJCXJldHVybjsKPiAgIAo+IC0JZGV2
X3ByaXYtPmlwY19lbmFibGVkID0gaW50ZWxfY2FuX2VuYWJsZV9pcGMoZGV2X3ByaXYpOwo+ICsJ
aTkxNS0+aXBjX2VuYWJsZWQgPSBpbnRlbF9jYW5fZW5hYmxlX2lwYyhpOTE1KTsKPiAgIAo+IC0J
aW50ZWxfZW5hYmxlX2lwYyhkZXZfcHJpdik7Cj4gKwlpbnRlbF9lbmFibGVfaXBjKGk5MTUpOwo+
ICAgfQo+ICAgCj4gICAvKgo+IEBAIC02NDMwLDkgKzY0MzAsOSBAQCBib29sIGlyb25sYWtlX3Nl
dF9kcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1OCB2YWwpCj4gICAJcmV0dXJu
IHRydWU7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgaXJvbmxha2VfZW5hYmxlX2RycHMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBpcm9ubGFrZV9l
bmFibGVfZHJwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVj
dCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwo+ICsJc3RydWN0IGlu
dGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsKPiAgIAl1MzIgcmd2bW9kZWN0bDsK
PiAgIAl1OCBmbWF4LCBmbWluLCBmc3RhcnQsIHZzdGFydDsKPiAgIAo+IEBAIC02NDYzLDEyICs2
NDYzLDEyIEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX2VuYWJsZV9kcnBzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAl2c3RhcnQgPSAoaW50ZWxfdW5jb3JlX3JlYWQodW5j
b3JlLCBQWFZGUkVRKGZzdGFydCkpICYKPiAgIAkJICBQWFZGUkVRX1BYX01BU0spID4+IFBYVkZS
RVFfUFhfU0hJRlQ7Cj4gICAKPiAtCWRldl9wcml2LT5pcHMuZm1heCA9IGZtYXg7IC8qIElQUyBj
YWxsYmFjayB3aWxsIGluY3JlYXNlIHRoaXMgKi8KPiAtCWRldl9wcml2LT5pcHMuZnN0YXJ0ID0g
ZnN0YXJ0Owo+ICsJaTkxNS0+aXBzLmZtYXggPSBmbWF4OyAvKiBJUFMgY2FsbGJhY2sgd2lsbCBp
bmNyZWFzZSB0aGlzICovCj4gKwlpOTE1LT5pcHMuZnN0YXJ0ID0gZnN0YXJ0Owo+ICAgCj4gLQlk
ZXZfcHJpdi0+aXBzLm1heF9kZWxheSA9IGZzdGFydDsKPiAtCWRldl9wcml2LT5pcHMubWluX2Rl
bGF5ID0gZm1pbjsKPiAtCWRldl9wcml2LT5pcHMuY3VyX2RlbGF5ID0gZnN0YXJ0Owo+ICsJaTkx
NS0+aXBzLm1heF9kZWxheSA9IGZzdGFydDsKPiArCWk5MTUtPmlwcy5taW5fZGVsYXkgPSBmbWlu
Owo+ICsJaTkxNS0+aXBzLmN1cl9kZWxheSA9IGZzdGFydDsKPiAgIAo+ICAgCURSTV9ERUJVR19E
UklWRVIoImZtYXg6ICVkLCBmbWluOiAlZCwgZnN0YXJ0OiAlZFxuIiwKPiAgIAkJCSBmbWF4LCBm
bWluLCBmc3RhcnQpOwo+IEBAIC02NDkyLDE1ICs2NDkyLDE1IEBAIHN0YXRpYyB2b2lkIGlyb25s
YWtlX2VuYWJsZV9kcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkJ
RFJNX0VSUk9SKCJzdHVjayB0cnlpbmcgdG8gY2hhbmdlIHBlcmYgbW9kZVxuIik7Cj4gICAJbWRl
bGF5KDEpOwo+ICAgCj4gLQlpcm9ubGFrZV9zZXRfZHJwcyhkZXZfcHJpdiwgZnN0YXJ0KTsKPiAr
CWlyb25sYWtlX3NldF9kcnBzKGk5MTUsIGZzdGFydCk7Cj4gICAKPiAtCWRldl9wcml2LT5pcHMu
bGFzdF9jb3VudDEgPQo+ICsJaTkxNS0+aXBzLmxhc3RfY291bnQxID0KPiAgIAkJaW50ZWxfdW5j
b3JlX3JlYWQodW5jb3JlLCBETUlFQykgKwo+ICAgCQlpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUs
IEREUkVDKSArCj4gICAJCWludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgQ1NJRUMpOwo+IC0JZGV2
X3ByaXYtPmlwcy5sYXN0X3RpbWUxID0gamlmZmllc190b19tc2VjcyhqaWZmaWVzKTsKPiAtCWRl
dl9wcml2LT5pcHMubGFzdF9jb3VudDIgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdGWEVD
KTsKPiAtCWRldl9wcml2LT5pcHMubGFzdF90aW1lMiA9IGt0aW1lX2dldF9yYXdfbnMoKTsKPiAr
CWk5MTUtPmlwcy5sYXN0X3RpbWUxID0gamlmZmllc190b19tc2VjcyhqaWZmaWVzKTsKPiArCWk5
MTUtPmlwcy5sYXN0X2NvdW50MiA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0ZYRUMpOwo+
ICsJaTkxNS0+aXBzLmxhc3RfdGltZTIgPSBrdGltZV9nZXRfcmF3X25zKCk7Cj4gICAKPiAgIAlz
cGluX3VubG9ja19pcnEoJm1jaGRldl9sb2NrKTsKPiAgIH0KPiBAQCAtNjU0Myw5ICs2NTQzLDkg
QEAgc3RhdGljIHZvaWQgaXJvbmxha2VfZGlzYWJsZV9kcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ICAgICogb3Vyc2VsdmVzLCBpbnN0ZWFkIG9mIGRvaW5nIGEgcm13IGN5Y2xl
ICh3aGljaCBtaWdodCByZXN1bHQgaW4gdXMgY2xlYXJpbmcKPiAgICAqIGFsbCBsaW1pdHMgYW5k
IHRoZSBncHUgc3R1Y2sgYXQgd2hhdGV2ZXIgZnJlcXVlbmN5IGl0IGlzIGF0IGF0bSkuCj4gICAg
Ki8KPiAtc3RhdGljIHUzMiBpbnRlbF9ycHNfbGltaXRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwgdTggdmFsKQo+ICtzdGF0aWMgdTMyIGludGVsX3Jwc19saW1pdHMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHU4IHZhbCkKPiAgIHsKPiAtCXN0cnVjdCBpbnRlbF9y
cHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwo+ICsJc3RydWN0IGludGVsX3JwcyAqcnBz
ID0gJmk5MTUtPmd0X3BtLnJwczsKPiAgIAl1MzIgbGltaXRzOwo+ICAgCj4gICAJLyogT25seSBz
ZXQgdGhlIGRvd24gbGltaXQgd2hlbiB3ZSd2ZSByZWFjaGVkIHRoZSBsb3dlc3QgbGV2ZWwgdG8g
YXZvaWQKPiBAQCAtNjU1NCw3ICs2NTU0LDcgQEAgc3RhdGljIHUzMiBpbnRlbF9ycHNfbGltaXRz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTggdmFsKQo+ICAgCSAqIHRoZSBo
dyBydW5zIGF0IHRoZSBtaW5pbWFsIGNsb2NrIGJlZm9yZSBzZWxlY3RpbmcgdGhlIGRlc2lyZWQK
PiAgIAkgKiBmcmVxdWVuY3ksIGlmIHRoZSBkb3duIHRocmVzaG9sZCBleHBpcmVzIGluIHRoYXQg
d2luZG93IHdlIHdpbGwgbm90Cj4gICAJICogcmVjZWl2ZSBhIGRvd24gaW50ZXJydXB0LiAqLwo+
IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkgewo+ICsJaWYgKElOVEVMX0dFTihpOTE1
KSA+PSA5KSB7Cj4gICAJCWxpbWl0cyA9IChycHMtPm1heF9mcmVxX3NvZnRsaW1pdCkgPDwgMjM7
Cj4gICAJCWlmICh2YWwgPD0gcnBzLT5taW5fZnJlcV9zb2Z0bGltaXQpCj4gICAJCQlsaW1pdHMg
fD0gKHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0KSA8PCAxNDsKPiBAQCAtNjU2Nyw5ICs2NTY3LDkg
QEAgc3RhdGljIHUzMiBpbnRlbF9ycHNfbGltaXRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwgdTggdmFsKQo+ICAgCXJldHVybiBsaW1pdHM7Cj4gICB9Cj4gICAKPiAtc3RhdGlj
IHZvaWQgcnBzX3NldF9wb3dlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGlu
dCBuZXdfcG93ZXIpCj4gK3N0YXRpYyB2b2lkIHJwc19zZXRfcG93ZXIoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsIGludCBuZXdfcG93ZXIpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfcnBz
ICpycHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKPiArCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9
ICZpOTE1LT5ndF9wbS5ycHM7Cj4gICAJdTMyIHRocmVzaG9sZF91cCA9IDAsIHRocmVzaG9sZF9k
b3duID0gMDsgLyogaW4gJSAqLwo+ICAgCXUzMiBlaV91cCA9IDAsIGVpX2Rvd24gPSAwOwo+ICAg
Cj4gQEAgLTY2MTQsMjMgKzY2MTQsMjMgQEAgc3RhdGljIHZvaWQgcnBzX3NldF9wb3dlcihzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCBuZXdfcG93ZXIpCj4gICAJLyogV2hl
biBieXQgY2FuIHN1cnZpdmUgd2l0aG91dCBzeXN0ZW0gaGFuZyB3aXRoIGR5bmFtaWMKPiAgIAkg
KiBzdyBmcmVxIGFkanVzdG1lbnRzLCB0aGlzIHJlc3RyaWN0aW9uIGNhbiBiZSBsaWZ0ZWQuCj4g
ICAJICovCj4gLQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikpCj4gKwlpZiAoSVNfVkFMTEVZ
VklFVyhpOTE1KSkKPiAgIAkJZ290byBza2lwX2h3X3dyaXRlOwo+ICAgCj4gICAJSTkxNV9XUklU
RShHRU42X1JQX1VQX0VJLAo+IC0JCSAgIEdUX0lOVEVSVkFMX0ZST01fVVMoZGV2X3ByaXYsIGVp
X3VwKSk7Cj4gKwkJICAgR1RfSU5URVJWQUxfRlJPTV9VUyhpOTE1LCBlaV91cCkpOwo+ICAgCUk5
MTVfV1JJVEUoR0VONl9SUF9VUF9USFJFU0hPTEQsCj4gLQkJICAgR1RfSU5URVJWQUxfRlJPTV9V
UyhkZXZfcHJpdiwKPiArCQkgICBHVF9JTlRFUlZBTF9GUk9NX1VTKGk5MTUsCj4gICAJCQkJICAg
ICAgIGVpX3VwICogdGhyZXNob2xkX3VwIC8gMTAwKSk7Cj4gICAKPiAgIAlJOTE1X1dSSVRFKEdF
TjZfUlBfRE9XTl9FSSwKPiAtCQkgICBHVF9JTlRFUlZBTF9GUk9NX1VTKGRldl9wcml2LCBlaV9k
b3duKSk7Cj4gKwkJICAgR1RfSU5URVJWQUxfRlJPTV9VUyhpOTE1LCBlaV9kb3duKSk7Cj4gICAJ
STkxNV9XUklURShHRU42X1JQX0RPV05fVEhSRVNIT0xELAo+IC0JCSAgIEdUX0lOVEVSVkFMX0ZS
T01fVVMoZGV2X3ByaXYsCj4gKwkJICAgR1RfSU5URVJWQUxfRlJPTV9VUyhpOTE1LAo+ICAgCQkJ
CSAgICAgICBlaV9kb3duICogdGhyZXNob2xkX2Rvd24gLyAxMDApKTsKPiAgIAo+ICAgCUk5MTVf
V1JJVEUoR0VONl9SUF9DT05UUk9MLAo+IC0JCSAgIChJTlRFTF9HRU4oZGV2X3ByaXYpID4gOSA/
IDAgOiBHRU42X1JQX01FRElBX1RVUkJPKSB8Cj4gKwkJICAgKElOVEVMX0dFTihpOTE1KSA+IDkg
PyAwIDogR0VONl9SUF9NRURJQV9UVVJCTykgfAo+ICAgCQkgICBHRU42X1JQX01FRElBX0hXX05P
Uk1BTF9NT0RFIHwKPiAgIAkJICAgR0VONl9SUF9NRURJQV9JU19HRlggfAo+ICAgCQkgICBHRU42
X1JQX0VOQUJMRSB8Cj4gQEAgLTY2NDMsOSArNjY0Myw5IEBAIHN0YXRpYyB2b2lkIHJwc19zZXRf
cG93ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgbmV3X3Bvd2VyKQo+
ICAgCXJwcy0+cG93ZXIuZG93bl90aHJlc2hvbGQgPSB0aHJlc2hvbGRfZG93bjsKPiAgIH0KPiAg
IAo+IC1zdGF0aWMgdm9pZCBnZW42X3NldF9ycHNfdGhyZXNob2xkcyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsIHU4IHZhbCkKPiArc3RhdGljIHZvaWQgZ2VuNl9zZXRfcnBzX3Ro
cmVzaG9sZHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHU4IHZhbCkKPiAgIHsKPiAt
CXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwo+ICsJc3RydWN0
IGludGVsX3JwcyAqcnBzID0gJmk5MTUtPmd0X3BtLnJwczsKPiAgIAlpbnQgbmV3X3Bvd2VyOwo+
ICAgCj4gICAJbmV3X3Bvd2VyID0gcnBzLT5wb3dlci5tb2RlOwo+IEBAIC02NjgwLDcgKzY2ODAs
NyBAQCBzdGF0aWMgdm9pZCBnZW42X3NldF9ycHNfdGhyZXNob2xkcyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsIHU4IHZhbCkKPiAgIAltdXRleF9sb2NrKCZycHMtPnBvd2VyLm11
dGV4KTsKPiAgIAlpZiAocnBzLT5wb3dlci5pbnRlcmFjdGl2ZSkKPiAgIAkJbmV3X3Bvd2VyID0g
SElHSF9QT1dFUjsKPiAtCXJwc19zZXRfcG93ZXIoZGV2X3ByaXYsIG5ld19wb3dlcik7Cj4gKwly
cHNfc2V0X3Bvd2VyKGk5MTUsIG5ld19wb3dlcik7Cj4gICAJbXV0ZXhfdW5sb2NrKCZycHMtPnBv
d2VyLm11dGV4KTsKPiAgIH0KPiAgIAo+IEBAIC02NzAyLDkgKzY3MDIsOSBAQCB2b2lkIGludGVs
X3Jwc19tYXJrX2ludGVyYWN0aXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBib29s
IGludGVyYWN0aXZlKQo+ICAgCW11dGV4X3VubG9jaygmcnBzLT5wb3dlci5tdXRleCk7Cj4gICB9
Cj4gICAKPiAtc3RhdGljIHUzMiBnZW42X3Jwc19wbV9tYXNrKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwgdTggdmFsKQo+ICtzdGF0aWMgdTMyIGdlbjZfcnBzX3BtX21hc2soc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHU4IHZhbCkKPiAgIHsKPiAtCXN0cnVjdCBpbnRl
bF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwo+ICsJc3RydWN0IGludGVsX3JwcyAq
cnBzID0gJmk5MTUtPmd0X3BtLnJwczsKPiAgIAl1MzIgbWFzayA9IDA7Cj4gICAKPiAgIAkvKiBX
ZSB1c2UgVVBfRUlfRVhQSVJFRCBpbnRlcnVwdHMgZm9yIGJvdGggdXAvZG93biBpbiBtYW51YWwg
bW9kZSAqLwo+IEBAIC02NzEzLDI4ICs2NzEzLDI4IEBAIHN0YXRpYyB1MzIgZ2VuNl9ycHNfcG1f
bWFzayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4IHZhbCkKPiAgIAlpZiAo
dmFsIDwgcnBzLT5tYXhfZnJlcV9zb2Z0bGltaXQpCj4gICAJCW1hc2sgfD0gR0VONl9QTV9SUF9V
UF9FSV9FWFBJUkVEIHwgR0VONl9QTV9SUF9VUF9USFJFU0hPTEQ7Cj4gICAKPiAtCW1hc2sgJj0g
ZGV2X3ByaXYtPnBtX3Jwc19ldmVudHM7Cj4gKwltYXNrICY9IGk5MTUtPnBtX3Jwc19ldmVudHM7
Cj4gICAKPiAtCXJldHVybiBnZW42X3Nhbml0aXplX3Jwc19wbV9tYXNrKGRldl9wcml2LCB+bWFz
ayk7Cj4gKwlyZXR1cm4gZ2VuNl9zYW5pdGl6ZV9ycHNfcG1fbWFzayhpOTE1LCB+bWFzayk7Cj4g
ICB9Cj4gICAKPiAgIC8qIGdlbjZfc2V0X3JwcyBpcyBjYWxsZWQgdG8gdXBkYXRlIHRoZSBmcmVx
dWVuY3kgcmVxdWVzdCwgYnV0IHNob3VsZCBhbHNvIGJlCj4gICAgKiBjYWxsZWQgd2hlbiB0aGUg
cmFuZ2UgKG1pbl9kZWxheSBhbmQgbWF4X2RlbGF5KSBpcyBtb2RpZmllZCBzbyB0aGF0IHdlIGNh
bgo+ICAgICogdXBkYXRlIHRoZSBHRU42X1JQX0lOVEVSUlVQVF9MSU1JVFMgcmVnaXN0ZXIgYWNj
b3JkaW5nbHkuICovCj4gLXN0YXRpYyBpbnQgZ2VuNl9zZXRfcnBzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwgdTggdmFsKQo+ICtzdGF0aWMgaW50IGdlbjZfc2V0X3JwcyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTggdmFsKQo+ICAgewo+IC0Jc3RydWN0IGludGVs
X3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Cj4gKwlzdHJ1Y3QgaW50ZWxfcnBzICpy
cHMgPSAmaTkxNS0+Z3RfcG0ucnBzOwo+ICAgCj4gICAJLyogbWluL21heCBkZWxheSBtYXkgc3Rp
bGwgaGF2ZSBiZWVuIG1vZGlmaWVkIHNvIGJlIHN1cmUgdG8KPiAgIAkgKiB3cml0ZSB0aGUgbGlt
aXRzIHZhbHVlLgo+ICAgCSAqLwo+ICAgCWlmICh2YWwgIT0gcnBzLT5jdXJfZnJlcSkgewo+IC0J
CWdlbjZfc2V0X3Jwc190aHJlc2hvbGRzKGRldl9wcml2LCB2YWwpOwo+ICsJCWdlbjZfc2V0X3Jw
c190aHJlc2hvbGRzKGk5MTUsIHZhbCk7Cj4gICAKPiAtCQlpZiAoSU5URUxfR0VOKGRldl9wcml2
KSA+PSA5KQo+ICsJCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkKPiAgIAkJCUk5MTVfV1JJVEUo
R0VONl9SUE5TV1JFUSwKPiAgIAkJCQkgICBHRU45X0ZSRVFVRU5DWSh2YWwpKTsKPiAtCQllbHNl
IGlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8fCBJU19CUk9BRFdFTEwoZGV2X3ByaXYpKQo+ICsJ
CWVsc2UgaWYgKElTX0hBU1dFTEwoaTkxNSkgfHwgSVNfQlJPQURXRUxMKGk5MTUpKQo+ICAgCQkJ
STkxNV9XUklURShHRU42X1JQTlNXUkVRLAo+ICAgCQkJCSAgIEhTV19GUkVRVUVOQ1kodmFsKSk7
Cj4gICAJCWVsc2UKPiBAQCAtNjc0NywzNyArNjc0NywzNyBAQCBzdGF0aWMgaW50IGdlbjZfc2V0
X3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4IHZhbCkKPiAgIAkvKiBN
YWtlIHN1cmUgd2UgY29udGludWUgdG8gZ2V0IGludGVycnVwdHMKPiAgIAkgKiB1bnRpbCB3ZSBo
aXQgdGhlIG1pbmltdW0gb3IgbWF4aW11bSBmcmVxdWVuY2llcy4KPiAgIAkgKi8KPiAtCUk5MTVf
V1JJVEUoR0VONl9SUF9JTlRFUlJVUFRfTElNSVRTLCBpbnRlbF9ycHNfbGltaXRzKGRldl9wcml2
LCB2YWwpKTsKPiAtCUk5MTVfV1JJVEUoR0VONl9QTUlOVFJNU0ssIGdlbjZfcnBzX3BtX21hc2so
ZGV2X3ByaXYsIHZhbCkpOwo+ICsJSTkxNV9XUklURShHRU42X1JQX0lOVEVSUlVQVF9MSU1JVFMs
IGludGVsX3Jwc19saW1pdHMoaTkxNSwgdmFsKSk7Cj4gKwlJOTE1X1dSSVRFKEdFTjZfUE1JTlRS
TVNLLCBnZW42X3Jwc19wbV9tYXNrKGk5MTUsIHZhbCkpOwo+ICAgCj4gICAJcnBzLT5jdXJfZnJl
cSA9IHZhbDsKPiAtCXRyYWNlX2ludGVsX2dwdV9mcmVxX2NoYW5nZShpbnRlbF9ncHVfZnJlcShk
ZXZfcHJpdiwgdmFsKSk7Cj4gKwl0cmFjZV9pbnRlbF9ncHVfZnJlcV9jaGFuZ2UoaW50ZWxfZ3B1
X2ZyZXEoaTkxNSwgdmFsKSk7Cj4gICAKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+IC1zdGF0
aWMgaW50IHZhbGxleXZpZXdfc2V0X3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsIHU4IHZhbCkKPiArc3RhdGljIGludCB2YWxsZXl2aWV3X3NldF9ycHMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsIHU4IHZhbCkKPiAgIHsKPiAgIAlpbnQgZXJyOwo+ICAgCj4gLQlp
ZiAoV0FSTl9PTkNFKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpICYmICh2YWwgJiAxKSwKPiArCWlm
IChXQVJOX09OQ0UoSVNfQ0hFUlJZVklFVyhpOTE1KSAmJiAodmFsICYgMSksCj4gICAJCSAgICAg
ICJPZGQgR1BVIGZyZXEgdmFsdWVcbiIpKQo+ICAgCQl2YWwgJj0gfjE7Cj4gICAKPiAtCUk5MTVf
V1JJVEUoR0VONl9QTUlOVFJNU0ssIGdlbjZfcnBzX3BtX21hc2soZGV2X3ByaXYsIHZhbCkpOwo+
ICsJSTkxNV9XUklURShHRU42X1BNSU5UUk1TSywgZ2VuNl9ycHNfcG1fbWFzayhpOTE1LCB2YWwp
KTsKPiAgIAo+IC0JaWYgKHZhbCAhPSBkZXZfcHJpdi0+Z3RfcG0ucnBzLmN1cl9mcmVxKSB7Cj4g
LQkJdmx2X3B1bml0X2dldChkZXZfcHJpdik7Cj4gLQkJZXJyID0gdmx2X3B1bml0X3dyaXRlKGRl
dl9wcml2LCBQVU5JVF9SRUdfR1BVX0ZSRVFfUkVRLCB2YWwpOwo+IC0JCXZsdl9wdW5pdF9wdXQo
ZGV2X3ByaXYpOwo+ICsJaWYgKHZhbCAhPSBpOTE1LT5ndF9wbS5ycHMuY3VyX2ZyZXEpIHsKPiAr
CQl2bHZfcHVuaXRfZ2V0KGk5MTUpOwo+ICsJCWVyciA9IHZsdl9wdW5pdF93cml0ZShpOTE1LCBQ
VU5JVF9SRUdfR1BVX0ZSRVFfUkVRLCB2YWwpOwo+ICsJCXZsdl9wdW5pdF9wdXQoaTkxNSk7Cj4g
ICAJCWlmIChlcnIpCj4gICAJCQlyZXR1cm4gZXJyOwo+ICAgCj4gLQkJZ2VuNl9zZXRfcnBzX3Ro
cmVzaG9sZHMoZGV2X3ByaXYsIHZhbCk7Cj4gKwkJZ2VuNl9zZXRfcnBzX3RocmVzaG9sZHMoaTkx
NSwgdmFsKTsKPiAgIAl9Cj4gICAKPiAtCWRldl9wcml2LT5ndF9wbS5ycHMuY3VyX2ZyZXEgPSB2
YWw7Cj4gLQl0cmFjZV9pbnRlbF9ncHVfZnJlcV9jaGFuZ2UoaW50ZWxfZ3B1X2ZyZXEoZGV2X3By
aXYsIHZhbCkpOwo+ICsJaTkxNS0+Z3RfcG0ucnBzLmN1cl9mcmVxID0gdmFsOwo+ICsJdHJhY2Vf
aW50ZWxfZ3B1X2ZyZXFfY2hhbmdlKGludGVsX2dwdV9mcmVxKGk5MTUsIHZhbCkpOwo+ICAgCj4g
ICAJcmV0dXJuIDA7Cj4gICB9Cj4gQEAgLTY3ODksOSArNjc4OSw5IEBAIHN0YXRpYyBpbnQgdmFs
bGV5dmlld19zZXRfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTggdmFs
KQo+ICAgICogMi4gUmVxdWVzdCBpZGxlIGZyZXEuCj4gICAgKiAzLiBSZWxlYXNlIEZvcmNld2Fr
ZSBvZiBNZWRpYSB3ZWxsLgo+ICAgKi8KPiAtc3RhdGljIHZvaWQgdmx2X3NldF9ycHNfaWRsZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIHZsdl9zZXRf
cnBzX2lkbGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3Qg
aW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKPiArCXN0cnVjdCBpbnRlbF9y
cHMgKnJwcyA9ICZpOTE1LT5ndF9wbS5ycHM7Cj4gICAJdTMyIHZhbCA9IHJwcy0+aWRsZV9mcmVx
Owo+ICAgCWludCBlcnI7Cj4gICAKPiBAQCAtNjgxMCwyOCArNjgxMCwyOCBAQCBzdGF0aWMgdm9p
ZCB2bHZfc2V0X3Jwc19pZGxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAg
IAkgKiBwdW5pdCBpbnRvIGNvbW1pdHRpbmcgdGhlIHZvbHRhZ2UgY2hhbmdlKSBhcyB0aGF0IHRh
a2VzIGEgbG90IGxlc3MKPiAgIAkgKiBwb3dlciB0aGFuIHRoZSByZW5kZXIgcG93ZXJ3ZWxsLgo+
ICAgCSAqLwo+IC0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUs
IEZPUkNFV0FLRV9NRURJQSk7Cj4gLQllcnIgPSB2YWxsZXl2aWV3X3NldF9ycHMoZGV2X3ByaXYs
IHZhbCk7Cj4gLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwg
Rk9SQ0VXQUtFX01FRElBKTsKPiArCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZpOTE1LT51
bmNvcmUsIEZPUkNFV0FLRV9NRURJQSk7Cj4gKwllcnIgPSB2YWxsZXl2aWV3X3NldF9ycHMoaTkx
NSwgdmFsKTsKPiArCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZpOTE1LT51bmNvcmUsIEZP
UkNFV0FLRV9NRURJQSk7Cj4gICAKPiAgIAlpZiAoZXJyKQo+ICAgCQlEUk1fRVJST1IoIkZhaWxl
ZCB0byBzZXQgUlBTIGZvciBpZGxlXG4iKTsKPiAgIH0KPiAgIAo+IC12b2lkIGdlbjZfcnBzX2J1
c3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGdlbjZfcnBzX2J1
c3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxf
cnBzICpycHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKPiArCXN0cnVjdCBpbnRlbF9ycHMgKnJw
cyA9ICZpOTE1LT5ndF9wbS5ycHM7Cj4gICAKPiAgIAltdXRleF9sb2NrKCZycHMtPmxvY2spOwo+
ICAgCWlmIChycHMtPmVuYWJsZWQpIHsKPiAgIAkJdTggZnJlcTsKPiAgIAo+IC0JCWlmIChkZXZf
cHJpdi0+cG1fcnBzX2V2ZW50cyAmIEdFTjZfUE1fUlBfVVBfRUlfRVhQSVJFRCkKPiAtCQkJZ2Vu
Nl9ycHNfcmVzZXRfZWkoZGV2X3ByaXYpOwo+ICsJCWlmIChpOTE1LT5wbV9ycHNfZXZlbnRzICYg
R0VONl9QTV9SUF9VUF9FSV9FWFBJUkVEKQo+ICsJCQlnZW42X3Jwc19yZXNldF9laShpOTE1KTsK
PiAgIAkJSTkxNV9XUklURShHRU42X1BNSU5UUk1TSywKPiAtCQkJICAgZ2VuNl9ycHNfcG1fbWFz
ayhkZXZfcHJpdiwgcnBzLT5jdXJfZnJlcSkpOwo+ICsJCQkgICBnZW42X3Jwc19wbV9tYXNrKGk5
MTUsIHJwcy0+Y3VyX2ZyZXEpKTsKPiAgIAo+IC0JCWdlbjZfZW5hYmxlX3Jwc19pbnRlcnJ1cHRz
KGRldl9wcml2KTsKPiArCQlnZW42X2VuYWJsZV9ycHNfaW50ZXJydXB0cyhpOTE1KTsKPiAgIAo+
ICAgCQkvKiBVc2UgdGhlIHVzZXIncyBkZXNpcmVkIGZyZXF1ZW5jeSBhcyBhIGd1aWRlLCBidXQg
Zm9yIGJldHRlcgo+ICAgCQkgKiBwZXJmb3JtYW5jZSwganVtcCBkaXJlY3RseSB0byBSUGUgYXMg
b3VyIHN0YXJ0aW5nIGZyZXF1ZW5jeS4KPiBAQCAtNjgzOSw3ICs2ODM5LDcgQEAgdm9pZCBnZW42
X3Jwc19idXN5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkJZnJlcSA9
IG1heChycHMtPmN1cl9mcmVxLAo+ICAgCQkJICAgcnBzLT5lZmZpY2llbnRfZnJlcSk7Cj4gICAK
PiAtCQlpZiAoaW50ZWxfc2V0X3JwcyhkZXZfcHJpdiwKPiArCQlpZiAoaW50ZWxfc2V0X3Jwcyhp
OTE1LAo+ICAgCQkJCSAgY2xhbXAoZnJlcSwKPiAgIAkJCQkJcnBzLT5taW5fZnJlcV9zb2Z0bGlt
aXQsCj4gICAJCQkJCXJwcy0+bWF4X2ZyZXFfc29mdGxpbWl0KSkpCj4gQEAgLTY4NDgsMjYgKzY4
NDgsMjYgQEAgdm9pZCBnZW42X3Jwc19idXN5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiAgIAltdXRleF91bmxvY2soJnJwcy0+bG9jayk7Cj4gICB9Cj4gICAKPiAtdm9pZCBn
ZW42X3Jwc19pZGxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBn
ZW42X3Jwc19pZGxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0Jc3Ry
dWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Cj4gKwlzdHJ1Y3QgaW50
ZWxfcnBzICpycHMgPSAmaTkxNS0+Z3RfcG0ucnBzOwo+ICAgCj4gICAJLyogRmx1c2ggb3VyIGJv
dHRvbS1oYWxmIHNvIHRoYXQgaXQgZG9lcyBub3QgcmFjZSB3aXRoIHVzCj4gICAJICogc2V0dGlu
ZyB0aGUgaWRsZSBmcmVxdWVuY3kgYW5kIHNvIHRoYXQgaXQgaXMgYm91bmRlZCBieQo+ICAgCSAq
IG91ciBycG0gd2FrZXJlZi4gQW5kIHRoZW4gZGlzYWJsZSB0aGUgaW50ZXJydXB0cyB0byBzdG9w
IGFueQo+ICAgCSAqIGZ1dGhlciBSUFMgcmVjbG9ja2luZyB3aGlsc3Qgd2UgYXJlIGFzbGVlcC4K
PiAgIAkgKi8KPiAtCWdlbjZfZGlzYWJsZV9ycHNfaW50ZXJydXB0cyhkZXZfcHJpdik7Cj4gKwln
ZW42X2Rpc2FibGVfcnBzX2ludGVycnVwdHMoaTkxNSk7Cj4gICAKPiAgIAltdXRleF9sb2NrKCZy
cHMtPmxvY2spOwo+ICAgCWlmIChycHMtPmVuYWJsZWQpIHsKPiAtCQlpZiAoSVNfVkFMTEVZVklF
VyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gLQkJCXZsdl9zZXRfcnBz
X2lkbGUoZGV2X3ByaXYpOwo+ICsJCWlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJS
WVZJRVcoaTkxNSkpCj4gKwkJCXZsdl9zZXRfcnBzX2lkbGUoaTkxNSk7Cj4gICAJCWVsc2UKPiAt
CQkJZ2VuNl9zZXRfcnBzKGRldl9wcml2LCBycHMtPmlkbGVfZnJlcSk7Cj4gKwkJCWdlbjZfc2V0
X3JwcyhpOTE1LCBycHMtPmlkbGVfZnJlcSk7Cj4gICAJCXJwcy0+bGFzdF9hZGogPSAwOwo+ICAg
CQlJOTE1X1dSSVRFKEdFTjZfUE1JTlRSTVNLLAo+IC0JCQkgICBnZW42X3Nhbml0aXplX3Jwc19w
bV9tYXNrKGRldl9wcml2LCB+MCkpOwo+ICsJCQkgICBnZW42X3Nhbml0aXplX3Jwc19wbV9tYXNr
KGk5MTUsIH4wKSk7Cj4gICAJfQo+ICAgCW11dGV4X3VubG9jaygmcnBzLT5sb2NrKTsKPiAgIH0K
PiBAQCAtNjkwNCw5ICs2OTA0LDkgQEAgdm9pZCBnZW42X3Jwc19ib29zdChzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICpycSkKPiAgIAlhdG9taWNfaW5jKCZycHMtPmJvb3N0cyk7Cj4gICB9Cj4gICAKPiAt
aW50IGludGVsX3NldF9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1OCB2
YWwpCj4gK2ludCBpbnRlbF9zZXRfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1
OCB2YWwpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0X3Bt
LnJwczsKPiArCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1LT5ndF9wbS5ycHM7Cj4gICAJ
aW50IGVycjsKPiAgIAo+ICAgCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJnJwcy0+bG9jayk7Cj4gQEAg
LTY5MTgsNjMgKzY5MTgsNjMgQEAgaW50IGludGVsX3NldF9ycHMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LCB1OCB2YWwpCj4gICAJCXJldHVybiAwOwo+ICAgCX0KPiAgIAo+IC0J
aWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+
IC0JCWVyciA9IHZhbGxleXZpZXdfc2V0X3JwcyhkZXZfcHJpdiwgdmFsKTsKPiArCWlmIChJU19W
QUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gKwkJZXJyID0gdmFsbGV5
dmlld19zZXRfcnBzKGk5MTUsIHZhbCk7Cj4gICAJZWxzZQo+IC0JCWVyciA9IGdlbjZfc2V0X3Jw
cyhkZXZfcHJpdiwgdmFsKTsKPiArCQllcnIgPSBnZW42X3NldF9ycHMoaTkxNSwgdmFsKTsKPiAg
IAo+ICAgCXJldHVybiBlcnI7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgZ2VuOV9kaXNhYmxl
X3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGdl
bjlfZGlzYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJ
STkxNV9XUklURShHRU42X1JDX0NPTlRST0wsIDApOwo+ICAgCUk5MTVfV1JJVEUoR0VOOV9QR19F
TkFCTEUsIDApOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGdlbjlfZGlzYWJsZV9ycHMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBnZW45X2Rpc2Fi
bGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCUk5MTVfV1JJ
VEUoR0VONl9SUF9DT05UUk9MLCAwKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBnZW42X2Rp
c2FibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZv
aWQgZ2VuNl9kaXNhYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsK
PiAgIAlJOTE1X1dSSVRFKEdFTjZfUkNfQ09OVFJPTCwgMCk7Cj4gICB9Cj4gICAKPiAtc3RhdGlj
IHZvaWQgZ2VuNl9kaXNhYmxlX3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gK3N0YXRpYyB2b2lkIGdlbjZfZGlzYWJsZV9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCj4gICB7Cj4gICAJSTkxNV9XUklURShHRU42X1JQTlNXUkVRLCAxIDw8IDMxKTsKPiAg
IAlJOTE1X1dSSVRFKEdFTjZfUlBfQ09OVFJPTCwgMCk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZv
aWQgY2hlcnJ5dmlld19kaXNhYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gK3N0YXRpYyB2b2lkIGNoZXJyeXZpZXdfZGlzYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJSTkxNV9XUklURShHRU42X1JDX0NPTlRST0wsIDAp
Owo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGNoZXJyeXZpZXdfZGlzYWJsZV9ycHMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBjaGVycnl2aWV3X2Rp
c2FibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCUk5MTVf
V1JJVEUoR0VONl9SUF9DT05UUk9MLCAwKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCB2YWxs
ZXl2aWV3X2Rpc2FibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAr
c3RhdGljIHZvaWQgdmFsbGV5dmlld19kaXNhYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKPiAgIHsKPiAgIAkvKiBXZSdyZSBkb2luZyBmb3JjZXdha2UgYmVmb3JlIERpc2Fi
bGluZyBSQzYsCj4gICAJICogVGhpcyB3aGF0IHRoZSBCSU9TIGV4cGVjdHMgd2hlbiBnb2luZyBp
bnRvIHN1c3BlbmQgKi8KPiAtCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+
dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiArCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZp
OTE1LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ICAgCj4gICAJSTkxNV9XUklURShHRU42X1JD
X0NPTlRST0wsIDApOwo+ICAgCj4gLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmZGV2X3By
aXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gKwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1
dCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9p
ZCB2YWxsZXl2aWV3X2Rpc2FibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiArc3RhdGljIHZvaWQgdmFsbGV5dmlld19kaXNhYmxlX3JwcyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAlJOTE1X1dSSVRFKEdFTjZfUlBfQ09OVFJPTCwgMCk7
Cj4gICB9Cj4gICAKPiAtc3RhdGljIGJvb2wgYnh0X2NoZWNrX2Jpb3NfcmM2X3NldHVwKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIGJvb2wgYnh0X2NoZWNrX2Jp
b3NfcmM2X3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCWJv
b2wgZW5hYmxlX3JjNiA9IHRydWU7Cj4gICAJdW5zaWduZWQgbG9uZyByYzZfY3R4X2Jhc2U7Cj4g
QEAgLTcwMDAsOCArNzAwMCw4IEBAIHN0YXRpYyBib29sIGJ4dF9jaGVja19iaW9zX3JjNl9zZXR1
cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICogZm9yIHRoaXMgY2hl
Y2suCj4gICAJICovCj4gICAJcmM2X2N0eF9iYXNlID0gSTkxNV9SRUFEKFJDNl9DVFhfQkFTRSkg
JiBSQzZfQ1RYX0JBU0VfTUFTSzsKPiAtCWlmICghKChyYzZfY3R4X2Jhc2UgPj0gZGV2X3ByaXYt
PmRzbV9yZXNlcnZlZC5zdGFydCkgJiYKPiAtCSAgICAgIChyYzZfY3R4X2Jhc2UgKyBQQUdFX1NJ
WkUgPCBkZXZfcHJpdi0+ZHNtX3Jlc2VydmVkLmVuZCkpKSB7Cj4gKwlpZiAoISgocmM2X2N0eF9i
YXNlID49IGk5MTUtPmRzbV9yZXNlcnZlZC5zdGFydCkgJiYKPiArCSAgICAgIChyYzZfY3R4X2Jh
c2UgKyBQQUdFX1NJWkUgPCBpOTE1LT5kc21fcmVzZXJ2ZWQuZW5kKSkpIHsKPiAgIAkJRFJNX0RF
QlVHX0RSSVZFUigiUkM2IEJhc2UgYWRkcmVzcyBub3QgYXMgZXhwZWN0ZWQuXG4iKTsKPiAgIAkJ
ZW5hYmxlX3JjNiA9IGZhbHNlOwo+ICAgCX0KPiBAQCAtNzA2MiwxNCArNzA2MiwxNCBAQCBzdGF0
aWMgYm9vbCBzYW5pdGl6ZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICAJ
cmV0dXJuIGluZm8tPmhhc19yYzY7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgZ2VuNl9pbml0
X3Jwc19mcmVxdWVuY2llcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0
YXRpYyB2b2lkIGdlbjZfaW5pdF9ycHNfZnJlcXVlbmNpZXMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0
X3BtLnJwczsKPiArCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1LT5ndF9wbS5ycHM7Cj4g
ICAKPiAgIAkvKiBBbGwgb2YgdGhlc2UgdmFsdWVzIGFyZSBpbiB1bml0cyBvZiA1ME1IeiAqLwo+
ICAgCj4gICAJLyogc3RhdGljIHZhbHVlcyBmcm9tIEhXOiBSUDAgPiBSUDEgPiBSUG4gKG1pbl9m
cmVxKSAqLwo+IC0JaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfR0VOOV9M
UChpOTE1KSkgewo+ICAgCQl1MzIgcnBfc3RhdGVfY2FwID0gSTkxNV9SRUFEKEJYVF9SUF9TVEFU
RV9DQVApOwo+ICAgCQlycHMtPnJwMF9mcmVxID0gKHJwX3N0YXRlX2NhcCA+PiAxNikgJiAweGZm
Owo+ICAgCQlycHMtPnJwMV9mcmVxID0gKHJwX3N0YXRlX2NhcCA+PiAgOCkgJiAweGZmOwo+IEBA
IC03MDg0LDExICs3MDg0LDExIEBAIHN0YXRpYyB2b2lkIGdlbjZfaW5pdF9ycHNfZnJlcXVlbmNp
ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCXJwcy0+bWF4X2ZyZXEg
PSBycHMtPnJwMF9mcmVxOwo+ICAgCj4gICAJcnBzLT5lZmZpY2llbnRfZnJlcSA9IHJwcy0+cnAx
X2ZyZXE7Cj4gLQlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgfHwgSVNfQlJPQURXRUxMKGRldl9w
cml2KSB8fAo+IC0JICAgIElTX0dFTjlfQkMoZGV2X3ByaXYpIHx8IElOVEVMX0dFTihkZXZfcHJp
dikgPj0gMTApIHsKPiArCWlmIChJU19IQVNXRUxMKGk5MTUpIHx8IElTX0JST0FEV0VMTChpOTE1
KSB8fAo+ICsJICAgIElTX0dFTjlfQkMoaTkxNSkgfHwgSU5URUxfR0VOKGk5MTUpID49IDEwKSB7
Cj4gICAJCXUzMiBkZGNjX3N0YXR1cyA9IDA7Cj4gICAKPiAtCQlpZiAoc2FuZHlicmlkZ2VfcGNv
ZGVfcmVhZChkZXZfcHJpdiwKPiArCQlpZiAoc2FuZHlicmlkZ2VfcGNvZGVfcmVhZChpOTE1LAo+
ICAgCQkJCQkgICBIU1dfUENPREVfRFlOQU1JQ19EVVRZX0NZQ0xFX0NPTlRST0wsCj4gICAJCQkJ
CSAgICZkZGNjX3N0YXR1cywgTlVMTCkgPT0gMCkKPiAgIAkJCXJwcy0+ZWZmaWNpZW50X2ZyZXEg
PQo+IEBAIC03MDk4LDcgKzcwOTgsNyBAQCBzdGF0aWMgdm9pZCBnZW42X2luaXRfcnBzX2ZyZXF1
ZW5jaWVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkJCQkJcnBzLT5t
YXhfZnJlcSk7Cj4gICAJfQo+ICAgCj4gLQlpZiAoSVNfR0VOOV9CQyhkZXZfcHJpdikgfHwgSU5U
RUxfR0VOKGRldl9wcml2KSA+PSAxMCkgewo+ICsJaWYgKElTX0dFTjlfQkMoaTkxNSkgfHwgSU5U
RUxfR0VOKGk5MTUpID49IDEwKSB7Cj4gICAJCS8qIFN0b3JlIHRoZSBmcmVxdWVuY3kgdmFsdWVz
IGluIDE2LjY2IE1IWiB1bml0cywgd2hpY2ggaXMKPiAgIAkJICogdGhlIG5hdHVyYWwgaGFyZHdh
cmUgdW5pdCBmb3IgU0tMCj4gICAJCSAqLwo+IEBAIC03MTEwLDQ1ICs3MTEwLDQ1IEBAIHN0YXRp
YyB2b2lkIGdlbjZfaW5pdF9ycHNfZnJlcXVlbmNpZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICAgCX0KPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCByZXNldF9ycHMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgdm9pZCByZXNldF9ycHMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCSAgICAgIGludCAoKnNldCkoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKiwgdTgpKQo+ICAgewo+IC0Jc3RydWN0IGludGVsX3JwcyAq
cnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Cj4gKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAm
aTkxNS0+Z3RfcG0ucnBzOwo+ICAgCXU4IGZyZXEgPSBycHMtPmN1cl9mcmVxOwo+ICAgCj4gICAJ
LyogZm9yY2UgYSByZXNldCAqLwo+ICAgCXJwcy0+cG93ZXIubW9kZSA9IC0xOwo+ICAgCXJwcy0+
Y3VyX2ZyZXEgPSAtMTsKPiAgIAo+IC0JaWYgKHNldChkZXZfcHJpdiwgZnJlcSkpCj4gKwlpZiAo
c2V0KGk5MTUsIGZyZXEpKQo+ICAgCQlEUk1fRVJST1IoIkZhaWxlZCB0byByZXNldCBSUFMgdG8g
aW5pdGlhbCB2YWx1ZXNcbiIpOwo+ICAgfQo+ICAgCj4gICAvKiBTZWUgdGhlIEdlbjlfR1RfUE1f
UHJvZ3JhbW1pbmdfR3VpZGUgZG9jIGZvciB0aGUgYmVsb3cgKi8KPiAtc3RhdGljIHZvaWQgZ2Vu
OV9lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGlj
IHZvaWQgZ2VuOV9lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAg
ewo+IC0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNF
V0FLRV9BTEwpOwo+ICsJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmk5MTUtPnVuY29yZSwg
Rk9SQ0VXQUtFX0FMTCk7Cj4gICAKPiAgIAkvKiBQcm9ncmFtIGRlZmF1bHRzIGFuZCB0aHJlc2hv
bGRzIGZvciBSUFMgKi8KPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDkpKQo+ICsJaWYgKElTX0dF
TihpOTE1LCA5KSkKPiAgIAkJSTkxNV9XUklURShHRU42X1JDX1ZJREVPX0ZSRVEsCj4gLQkJCUdF
TjlfRlJFUVVFTkNZKGRldl9wcml2LT5ndF9wbS5ycHMucnAxX2ZyZXEpKTsKPiArCQkJR0VOOV9G
UkVRVUVOQ1koaTkxNS0+Z3RfcG0ucnBzLnJwMV9mcmVxKSk7Cj4gICAKPiAgIAkvKiAxIHNlY29u
ZCB0aW1lb3V0Ki8KPiAgIAlJOTE1X1dSSVRFKEdFTjZfUlBfRE9XTl9USU1FT1VULAo+IC0JCUdU
X0lOVEVSVkFMX0ZST01fVVMoZGV2X3ByaXYsIDEwMDAwMDApKTsKPiArCQlHVF9JTlRFUlZBTF9G
Uk9NX1VTKGk5MTUsIDEwMDAwMDApKTsKPiAgIAo+ICAgCUk5MTVfV1JJVEUoR0VONl9SUF9JRExF
X0hZU1RFUlNJUywgMHhhKTsKPiAgIAo+ICAgCS8qIExlYW5pbmcgb24gdGhlIGJlbG93IGNhbGwg
dG8gZ2VuNl9zZXRfcnBzIHRvIHByb2dyYW0vc2V0dXAgdGhlCj4gICAJICogVXAvRG93biBFSSAm
IHRocmVzaG9sZCByZWdpc3RlcnMsIGFzIHdlbGwgYXMgdGhlIFJQX0NPTlRST0wsCj4gICAJICog
UlBfSU5URVJSVVBUX0xJTUlUUyAmIFJQTlNXUkVRIHJlZ2lzdGVycyAqLwo+IC0JcmVzZXRfcnBz
KGRldl9wcml2LCBnZW42X3NldF9ycHMpOwo+ICsJcmVzZXRfcnBzKGk5MTUsIGdlbjZfc2V0X3Jw
cyk7Cj4gICAKPiAtCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZkZXZfcHJpdi0+dW5jb3Jl
LCBGT1JDRVdBS0VfQUxMKTsKPiArCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZpOTE1LT51
bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGdlbjExX2Vu
YWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9p
ZCBnZW4xMV9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+
ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKPiAgIAllbnVtIGludGVsX2VuZ2lu
ZV9pZCBpZDsKPiBAQCAtNzE2MCw3ICs3MTYwLDcgQEAgc3RhdGljIHZvaWQgZ2VuMTFfZW5hYmxl
X3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICogMWI6IEdldCBm
b3JjZXdha2UgZHVyaW5nIHByb2dyYW0gc2VxdWVuY2UuIEFsdGhvdWdoIHRoZSBkcml2ZXIKPiAg
IAkgKiBoYXNuJ3QgZW5hYmxlZCBhIHN0YXRlIHlldCB3aGVyZSB3ZSBuZWVkIGZvcmNld2FrZSwg
QklPUyBtYXkgaGF2ZS4KPiAgIAkgKi8KPiAtCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZk
ZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiArCWludGVsX3VuY29yZV9mb3JjZXdh
a2VfZ2V0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ICAgCj4gICAJLyogMmE6IERp
c2FibGUgUkMgc3RhdGVzLiAqLwo+ICAgCUk5MTVfV1JJVEUoR0VONl9SQ19DT05UUk9MLCAwKTsK
PiBAQCAtNzE3MSwxMCArNzE3MSwxMCBAQCBzdGF0aWMgdm9pZCBnZW4xMV9lbmFibGVfcmM2KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAo+ICAgCUk5MTVfV1JJVEUoR0VO
Nl9SQ19FVkFMVUFUSU9OX0lOVEVSVkFMLCAxMjUwMDApOyAvKiAxMjUwMCAqIDEyODBucyAqLwo+
ICAgCUk5MTVfV1JJVEUoR0VONl9SQ19JRExFX0hZU1RFUlNJUywgMjUpOyAvKiAyNSAqIDEyODBu
cyAqLwo+IC0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYsIGlkKQo+ICsJZm9yX2Vh
Y2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpCj4gICAJCUk5MTVfV1JJVEUoUklOR19NQVhfSURM
RShlbmdpbmUtPm1taW9fYmFzZSksIDEwKTsKPiAgIAo+IC0JaWYgKEhBU19HVUMoZGV2X3ByaXYp
KQo+ICsJaWYgKEhBU19HVUMoaTkxNSkpCj4gICAJCUk5MTVfV1JJVEUoR1VDX01BWF9JRExFX0NP
VU5ULCAweEEpOwo+ICAgCj4gICAJSTkxNV9XUklURShHRU42X1JDX1NMRUVQLCAwKTsKPiBAQCAt
NzIxNywxMCArNzIxNywxMCBAQCBzdGF0aWMgdm9pZCBnZW4xMV9lbmFibGVfcmM2KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkJICAgR0VOOV9NRURJQV9QR19FTkFCTEUg
fAo+ICAgCQkgICBHRU4xMV9NRURJQV9TQU1QTEVSX1BHX0VOQUJMRSk7Cj4gICAKPiAtCWludGVs
X3VuY29yZV9mb3JjZXdha2VfcHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsK
PiArCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9B
TEwpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGdlbjlfZW5hYmxlX3JjNihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGdlbjlfZW5hYmxlX3JjNihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmU7Cj4gICAJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Cj4gQEAgLTcyMzEs
MTYgKzcyMzEsMTYgQEAgc3RhdGljIHZvaWQgZ2VuOV9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAo+ICAgCS8qIDFiOiBHZXQgZm9yY2V3YWtlIGR1cmlu
ZyBwcm9ncmFtIHNlcXVlbmNlLiBBbHRob3VnaCB0aGUgZHJpdmVyCj4gICAJICogaGFzbid0IGVu
YWJsZWQgYSBzdGF0ZSB5ZXQgd2hlcmUgd2UgbmVlZCBmb3JjZXdha2UsIEJJT1MgbWF5IGhhdmUu
Ki8KPiAtCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JD
RVdBS0VfQUxMKTsKPiArCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZpOTE1LT51bmNvcmUs
IEZPUkNFV0FLRV9BTEwpOwo+ICAgCj4gICAJLyogMmE6IERpc2FibGUgUkMgc3RhdGVzLiAqLwo+
ICAgCUk5MTVfV1JJVEUoR0VONl9SQ19DT05UUk9MLCAwKTsKPiAgIAo+ICAgCS8qIDJiOiBQcm9n
cmFtIFJDNiB0aHJlc2hvbGRzLiovCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCkg
ewo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMCkgewo+ICAgCQlJOTE1X1dSSVRFKEdFTjZf
UkM2X1dBS0VfUkFURV9MSU1JVCwgNTQgPDwgMTYgfCA4NSk7Cj4gICAJCUk5MTVfV1JJVEUoR0VO
MTBfTUVESUFfV0FLRV9SQVRFX0xJTUlULCAxNTApOwo+IC0JfSBlbHNlIGlmIChJU19TS1lMQUtF
KGRldl9wcml2KSkgewo+ICsJfSBlbHNlIGlmIChJU19TS1lMQUtFKGk5MTUpKSB7Cj4gICAJCS8q
Cj4gICAJCSAqIFdhUnNEb3VibGVSYzZXcmxXaXRoQ29hcnNlUG93ZXJHYXRpbmc6c2tsIERvdWJs
aW5nIFdSTCBvbmx5Cj4gICAJCSAqIHdoZW4gQ1BHIGlzIGVuYWJsZWQKPiBAQCAtNzI1MiwxMCAr
NzI1MiwxMCBAQCBzdGF0aWMgdm9pZCBnZW45X2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ICAgCj4gICAJSTkxNV9XUklURShHRU42X1JDX0VWQUxVQVRJT05f
SU5URVJWQUwsIDEyNTAwMCk7IC8qIDEyNTAwICogMTI4MG5zICovCj4gICAJSTkxNV9XUklURShH
RU42X1JDX0lETEVfSFlTVEVSU0lTLCAyNSk7IC8qIDI1ICogMTI4MG5zICovCj4gLQlmb3JfZWFj
aF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpCj4gKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5l
LCBpOTE1LCBpZCkKPiAgIAkJSTkxNV9XUklURShSSU5HX01BWF9JRExFKGVuZ2luZS0+bW1pb19i
YXNlKSwgMTApOwo+ICAgCj4gLQlpZiAoSEFTX0dVQyhkZXZfcHJpdikpCj4gKwlpZiAoSEFTX0dV
QyhpOTE1KSkKPiAgIAkJSTkxNV9XUklURShHVUNfTUFYX0lETEVfQ09VTlQsIDB4QSk7Cj4gICAK
PiAgIAlJOTE1X1dSSVRFKEdFTjZfUkNfU0xFRVAsIDApOwo+IEBAIC03Mjg4LDcgKzcyODgsNyBA
QCBzdGF0aWMgdm9pZCBnZW45X2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ICAgCUk5MTVfV1JJVEUoR0VONl9SQzZfVEhSRVNIT0xELCAzNzUwMCk7IC8qIDM3
LjUvMTI1bXMgcGVyIEVJICovCj4gICAKPiAgIAkvKiBXYVJzVXNlVGltZW91dE1vZGU6Y25sIChw
cmUtcHJvZCkgKi8KPiAtCWlmIChJU19DTkxfUkVWSUQoZGV2X3ByaXYsIENOTF9SRVZJRF9BMCwg
Q05MX1JFVklEX0MwKSkKPiArCWlmIChJU19DTkxfUkVWSUQoaTkxNSwgQ05MX1JFVklEX0EwLCBD
TkxfUkVWSURfQzApKQo+ICAgCQlyYzZfbW9kZSA9IEdFTjdfUkNfQ1RMX1RPX01PREU7Cj4gICAJ
ZWxzZQo+ICAgCQlyYzZfbW9kZSA9IEdFTjZfUkNfQ1RMX0VJX01PREUoMSk7Cj4gQEAgLTczMDIs
MTYgKzczMDIsMTYgQEAgc3RhdGljIHZvaWQgZ2VuOV9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkgKiAzYjogRW5hYmxlIENvYXJzZSBQb3dlciBHYXRp
bmcgb25seSB3aGVuIFJDNiBpcyBlbmFibGVkLgo+ICAgCSAqIFdhUnNEaXNhYmxlQ29hcnNlUG93
ZXJHYXRpbmc6c2tsLGNubCAtIFJlbmRlci9NZWRpYSBQRyBuZWVkIHRvIGJlIGRpc2FibGVkIHdp
dGggUkM2Lgo+ICAgCSAqLwo+IC0JaWYgKE5FRURTX1dhUnNEaXNhYmxlQ29hcnNlUG93ZXJHYXRp
bmcoZGV2X3ByaXYpKQo+ICsJaWYgKE5FRURTX1dhUnNEaXNhYmxlQ29hcnNlUG93ZXJHYXRpbmco
aTkxNSkpCj4gICAJCUk5MTVfV1JJVEUoR0VOOV9QR19FTkFCTEUsIDApOwo+ICAgCWVsc2UKPiAg
IAkJSTkxNV9XUklURShHRU45X1BHX0VOQUJMRSwKPiAgIAkJCSAgIEdFTjlfUkVOREVSX1BHX0VO
QUJMRSB8IEdFTjlfTUVESUFfUEdfRU5BQkxFKTsKPiAgIAo+IC0JaW50ZWxfdW5jb3JlX2ZvcmNl
d2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ICsJaW50ZWxfdW5j
b3JlX2ZvcmNld2FrZV9wdXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gICB9Cj4g
ICAKPiAtc3RhdGljIHZvaWQgZ2VuOF9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgZ2VuOF9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZTsKPiAgIAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKPiBAQCAtNzMyMSw3ICs3MzIxLDcgQEAg
c3RhdGljIHZvaWQgZ2VuOF9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiAgIAo+ICAgCS8qIDFiOiBHZXQgZm9yY2V3YWtlIGR1cmluZyBwcm9ncmFtIHNlcXVl
bmNlLiBBbHRob3VnaCB0aGUgZHJpdmVyCj4gICAJICogaGFzbid0IGVuYWJsZWQgYSBzdGF0ZSB5
ZXQgd2hlcmUgd2UgbmVlZCBmb3JjZXdha2UsIEJJT1MgbWF5IGhhdmUuKi8KPiAtCWludGVsX3Vu
Y29yZV9mb3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiAr
CWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwp
Owo+ICAgCj4gICAJLyogMmE6IERpc2FibGUgUkMgc3RhdGVzLiAqLwo+ICAgCUk5MTVfV1JJVEUo
R0VONl9SQ19DT05UUk9MLCAwKTsKPiBAQCAtNzMzMCw3ICs3MzMwLDcgQEAgc3RhdGljIHZvaWQg
Z2VuOF9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAlJ
OTE1X1dSSVRFKEdFTjZfUkM2X1dBS0VfUkFURV9MSU1JVCwgNDAgPDwgMTYpOwo+ICAgCUk5MTVf
V1JJVEUoR0VONl9SQ19FVkFMVUFUSU9OX0lOVEVSVkFMLCAxMjUwMDApOyAvKiAxMjUwMCAqIDEy
ODBucyAqLwo+ICAgCUk5MTVfV1JJVEUoR0VONl9SQ19JRExFX0hZU1RFUlNJUywgMjUpOyAvKiAy
NSAqIDEyODBucyAqLwo+IC0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYsIGlkKQo+
ICsJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpCj4gICAJCUk5MTVfV1JJVEUoUklO
R19NQVhfSURMRShlbmdpbmUtPm1taW9fYmFzZSksIDEwKTsKPiAgIAlJOTE1X1dSSVRFKEdFTjZf
UkNfU0xFRVAsIDApOwo+ICAgCUk5MTVfV1JJVEUoR0VONl9SQzZfVEhSRVNIT0xELCA2MjUpOyAv
KiA4MDB1cy8xLjI4IGZvciBUTyAqLwo+IEBAIC03MzQyLDE0ICs3MzQyLDE0IEBAIHN0YXRpYyB2
b2lkIGdlbjhfZW5hYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
ICAJCSAgIEdFTjdfUkNfQ1RMX1RPX01PREUgfAo+ICAgCQkgICBHRU42X1JDX0NUTF9SQzZfRU5B
QkxFKTsKPiAgIAo+IC0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNv
cmUsIEZPUkNFV0FLRV9BTEwpOwo+ICsJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmk5MTUt
PnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgZ2VuOF9l
bmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZv
aWQgZ2VuOF9lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+
IC0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Cj4gKwlzdHJ1
Y3QgaW50ZWxfcnBzICpycHMgPSAmaTkxNS0+Z3RfcG0ucnBzOwo+ICAgCj4gLQlpbnRlbF91bmNv
cmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gKwlp
bnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsK
PiAgIAo+ICAgCS8qIDEgUHJvZ3JhbSBkZWZhdWx0cyBhbmQgdGhyZXNob2xkcyBmb3IgUlBTKi8K
PiAgIAlJOTE1X1dSSVRFKEdFTjZfUlBOU1dSRVEsCj4gQEAgLTczODAsMTIgKzczODAsMTIgQEAg
c3RhdGljIHZvaWQgZ2VuOF9lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiAgIAkJICAgR0VONl9SUF9VUF9CVVNZX0FWRyB8Cj4gICAJCSAgIEdFTjZfUlBfRE9X
Tl9JRExFX0FWRyk7Cj4gICAKPiAtCXJlc2V0X3JwcyhkZXZfcHJpdiwgZ2VuNl9zZXRfcnBzKTsK
PiArCXJlc2V0X3JwcyhpOTE1LCBnZW42X3NldF9ycHMpOwo+ICAgCj4gLQlpbnRlbF91bmNvcmVf
Zm9yY2V3YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gKwlpbnRl
bF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiAg
IH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBnZW42X2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBnZW42X2VuYWJsZV9yYzYoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lOwo+ICAgCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwo+IEBAIC03NDAyLDcgKzc0MDIs
NyBAQCBzdGF0aWMgdm9pZCBnZW42X2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICAgCQlJOTE1X1dSSVRFKEdURklGT0RCRywgZ3RmaWZvZGJnKTsKPiAgIAl9
Cj4gICAKPiAtCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBG
T1JDRVdBS0VfQUxMKTsKPiArCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZpOTE1LT51bmNv
cmUsIEZPUkNFV0FLRV9BTEwpOwo+ICAgCj4gICAJLyogZGlzYWJsZSB0aGUgY291bnRlcnMgYW5k
IHNldCBkZXRlcm1pbmlzdGljIHRocmVzaG9sZHMgKi8KPiAgIAlJOTE1X1dSSVRFKEdFTjZfUkNf
Q09OVFJPTCwgMCk7Cj4gQEAgLTc0MTMsMTIgKzc0MTMsMTIgQEAgc3RhdGljIHZvaWQgZ2VuNl9l
bmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAlJOTE1X1dS
SVRFKEdFTjZfUkNfRVZBTFVBVElPTl9JTlRFUlZBTCwgMTI1MDAwKTsKPiAgIAlJOTE1X1dSSVRF
KEdFTjZfUkNfSURMRV9IWVNURVJTSVMsIDI1KTsKPiAgIAo+IC0JZm9yX2VhY2hfZW5naW5lKGVu
Z2luZSwgZGV2X3ByaXYsIGlkKQo+ICsJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQp
Cj4gICAJCUk5MTVfV1JJVEUoUklOR19NQVhfSURMRShlbmdpbmUtPm1taW9fYmFzZSksIDEwKTsK
PiAgIAo+ICAgCUk5MTVfV1JJVEUoR0VONl9SQ19TTEVFUCwgMCk7Cj4gICAJSTkxNV9XUklURShH
RU42X1JDMWVfVEhSRVNIT0xELCAxMDAwKTsKPiAtCWlmIChJU19JVllCUklER0UoZGV2X3ByaXYp
KQo+ICsJaWYgKElTX0lWWUJSSURHRShpOTE1KSkKPiAgIAkJSTkxNV9XUklURShHRU42X1JDNl9U
SFJFU0hPTEQsIDEyNTAwMCk7Cj4gICAJZWxzZQo+ICAgCQlJOTE1X1dSSVRFKEdFTjZfUkM2X1RI
UkVTSE9MRCwgNTAwMDApOwo+IEBAIC03NDI3LDkgKzc0MjcsOSBAQCBzdGF0aWMgdm9pZCBnZW42
X2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCj4gICAJ
LyogV2UgZG9uJ3QgdXNlIHRob3NlIG9uIEhhc3dlbGwgKi8KPiAgIAlyYzZfbWFzayA9IEdFTjZf
UkNfQ1RMX1JDNl9FTkFCTEU7Cj4gLQlpZiAoSEFTX1JDNnAoZGV2X3ByaXYpKQo+ICsJaWYgKEhB
U19SQzZwKGk5MTUpKQo+ICAgCQlyYzZfbWFzayB8PSBHRU42X1JDX0NUTF9SQzZwX0VOQUJMRTsK
PiAtCWlmIChIQVNfUkM2cHAoZGV2X3ByaXYpKQo+ICsJaWYgKEhBU19SQzZwcChpOTE1KSkKPiAg
IAkJcmM2X21hc2sgfD0gR0VONl9SQ19DVExfUkM2cHBfRU5BQkxFOwo+ICAgCUk5MTVfV1JJVEUo
R0VONl9SQ19DT05UUk9MLAo+ICAgCQkgICByYzZfbWFzayB8Cj4gQEAgLTc0MzcsMjQgKzc0Mzcs
MjQgQEAgc3RhdGljIHZvaWQgZ2VuNl9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiAgIAkJICAgR0VONl9SQ19DVExfSFdfRU5BQkxFKTsKPiAgIAo+ICAgCXJj
NnZpZHMgPSAwOwo+IC0JcmV0ID0gc2FuZHlicmlkZ2VfcGNvZGVfcmVhZChkZXZfcHJpdiwgR0VO
Nl9QQ09ERV9SRUFEX1JDNlZJRFMsCj4gKwlyZXQgPSBzYW5keWJyaWRnZV9wY29kZV9yZWFkKGk5
MTUsIEdFTjZfUENPREVfUkVBRF9SQzZWSURTLAo+ICAgCQkJCSAgICAgJnJjNnZpZHMsIE5VTEwp
Owo+IC0JaWYgKElTX0dFTihkZXZfcHJpdiwgNikgJiYgcmV0KSB7Cj4gKwlpZiAoSVNfR0VOKGk5
MTUsIDYpICYmIHJldCkgewo+ICAgCQlEUk1fREVCVUdfRFJJVkVSKCJDb3VsZG4ndCBjaGVjayBm
b3IgQklPUyB3b3JrYXJvdW5kXG4iKTsKPiAtCX0gZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCA2
KSAmJiAoR0VONl9ERUNPREVfUkM2X1ZJRChyYzZ2aWRzICYgMHhmZikgPCA0NTApKSB7Cj4gKwl9
IGVsc2UgaWYgKElTX0dFTihpOTE1LCA2KSAmJiAoR0VONl9ERUNPREVfUkM2X1ZJRChyYzZ2aWRz
ICYgMHhmZikgPCA0NTApKSB7Cj4gICAJCURSTV9ERUJVR19EUklWRVIoIllvdSBzaG91bGQgdXBk
YXRlIHlvdXIgQklPUy4gQ29ycmVjdGluZyBtaW5pbXVtIHJjNiB2b2x0YWdlICglZG1WLT4lZG1W
KVxuIiwKPiAgIAkJCSAgR0VONl9ERUNPREVfUkM2X1ZJRChyYzZ2aWRzICYgMHhmZiksIDQ1MCk7
Cj4gICAJCXJjNnZpZHMgJj0gMHhmZmZmMDA7Cj4gICAJCXJjNnZpZHMgfD0gR0VONl9FTkNPREVf
UkM2X1ZJRCg0NTApOwo+IC0JCXJldCA9IHNhbmR5YnJpZGdlX3Bjb2RlX3dyaXRlKGRldl9wcml2
LCBHRU42X1BDT0RFX1dSSVRFX1JDNlZJRFMsIHJjNnZpZHMpOwo+ICsJCXJldCA9IHNhbmR5YnJp
ZGdlX3Bjb2RlX3dyaXRlKGk5MTUsIEdFTjZfUENPREVfV1JJVEVfUkM2VklEUywgcmM2dmlkcyk7
Cj4gICAJCWlmIChyZXQpCj4gICAJCQlEUk1fRVJST1IoIkNvdWxkbid0IGZpeCBpbmNvcnJlY3Qg
cmM2IHZvbHRhZ2VcbiIpOwo+ICAgCX0KPiAgIAo+IC0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9w
dXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ICsJaW50ZWxfdW5jb3JlX2Zv
cmNld2FrZV9wdXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gICB9Cj4gICAKPiAt
c3RhdGljIHZvaWQgZ2VuNl9lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiArc3RhdGljIHZvaWQgZ2VuNl9lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ICAgewo+ICAgCS8qIEhlcmUgYmVnaW5zIGEgbWFnaWMgc2VxdWVuY2Ugb2Yg
cmVnaXN0ZXIgd3JpdGVzIHRvIGVuYWJsZQo+ICAgCSAqIGF1dG8tZG93bmNsb2NraW5nLgo+IEBA
IC03NDYyLDIwICs3NDYyLDIwIEBAIHN0YXRpYyB2b2lkIGdlbjZfZW5hYmxlX3JwcyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICogUGVyaGFwcyB0aGVyZSBtaWdodCBi
ZSBzb21lIHZhbHVlIGluIGV4cG9zaW5nIHRoZXNlIHRvCj4gICAJICogdXNlcnNwYWNlLi4uCj4g
ICAJICovCj4gLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwg
Rk9SQ0VXQUtFX0FMTCk7Cj4gKwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmaTkxNS0+dW5j
b3JlLCBGT1JDRVdBS0VfQUxMKTsKPiAgIAo+ICAgCS8qIFBvd2VyIGRvd24gaWYgY29tcGxldGVs
eSBpZGxlIGZvciBvdmVyIDUwbXMgKi8KPiAgIAlJOTE1X1dSSVRFKEdFTjZfUlBfRE9XTl9USU1F
T1VULCA1MDAwMCk7Cj4gICAJSTkxNV9XUklURShHRU42X1JQX0lETEVfSFlTVEVSU0lTLCAxMCk7
Cj4gICAKPiAtCXJlc2V0X3JwcyhkZXZfcHJpdiwgZ2VuNl9zZXRfcnBzKTsKPiArCXJlc2V0X3Jw
cyhpOTE1LCBnZW42X3NldF9ycHMpOwo+ICAgCj4gLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1
dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gKwlpbnRlbF91bmNvcmVfZm9y
Y2V3YWtlX3B1dCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiAgIH0KPiAgIAo+IC1z
dGF0aWMgdm9pZCBnZW42X3VwZGF0ZV9yaW5nX2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBnZW42X3VwZGF0ZV9yaW5nX2ZyZXEoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAm
ZGV2X3ByaXYtPmd0X3BtLnJwczsKPiArCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1LT5n
dF9wbS5ycHM7Cj4gICAJY29uc3QgaW50IG1pbl9mcmVxID0gMTU7Cj4gICAJY29uc3QgaW50IHNj
YWxpbmdfZmFjdG9yID0gMTgwOwo+ICAgCXVuc2lnbmVkIGludCBncHVfZnJlcTsKPiBAQCAtNzUw
OSw3ICs3NTA5LDcgQEAgc3RhdGljIHZvaWQgZ2VuNl91cGRhdGVfcmluZ19mcmVxKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAo+ICAgCW1pbl9ncHVfZnJlcSA9IHJwcy0+
bWluX2ZyZXE7Cj4gICAJbWF4X2dwdV9mcmVxID0gcnBzLT5tYXhfZnJlcTsKPiAtCWlmIChJU19H
RU45X0JDKGRldl9wcml2KSB8fCBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwKSB7Cj4gKwlpZiAo
SVNfR0VOOV9CQyhpOTE1KSB8fCBJTlRFTF9HRU4oaTkxNSkgPj0gMTApIHsKPiAgIAkJLyogQ29u
dmVydCBHVCBmcmVxdWVuY3kgdG8gNTAgSFogdW5pdHMgKi8KPiAgIAkJbWluX2dwdV9mcmVxIC89
IEdFTjlfRlJFUV9TQ0FMRVI7Cj4gICAJCW1heF9ncHVfZnJlcSAvPSBHRU45X0ZSRVFfU0NBTEVS
Owo+IEBAIC03NTI0LDE2ICs3NTI0LDE2IEBAIHN0YXRpYyB2b2lkIGdlbjZfdXBkYXRlX3Jpbmdf
ZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCWNvbnN0IGludCBk
aWZmID0gbWF4X2dwdV9mcmVxIC0gZ3B1X2ZyZXE7Cj4gICAJCXVuc2lnbmVkIGludCBpYV9mcmVx
ID0gMCwgcmluZ19mcmVxID0gMDsKPiAgIAo+IC0JCWlmIChJU19HRU45X0JDKGRldl9wcml2KSB8
fCBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwKSB7Cj4gKwkJaWYgKElTX0dFTjlfQkMoaTkxNSkg
fHwgSU5URUxfR0VOKGk5MTUpID49IDEwKSB7Cj4gICAJCQkvKgo+ICAgCQkJICogcmluZ19mcmVx
ID0gMiAqIEdULiByaW5nX2ZyZXEgaXMgaW4gMTAwTUh6IHVuaXRzCj4gICAJCQkgKiBObyBmbG9v
ciByZXF1aXJlZCBmb3IgcmluZyBmcmVxdWVuY3kgb24gU0tMLgo+ICAgCQkJICovCj4gICAJCQly
aW5nX2ZyZXEgPSBncHVfZnJlcTsKPiAtCQl9IGVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gOCkgewo+ICsJCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDgpIHsKPiAgIAkJCS8q
IG1heCgyICogR1QsIEREUikuIE5COiBHVCBpcyA1ME1IeiB1bml0cyAqLwo+ICAgCQkJcmluZ19m
cmVxID0gbWF4KG1pbl9yaW5nX2ZyZXEsIGdwdV9mcmVxKTsKPiAtCQl9IGVsc2UgaWYgKElTX0hB
U1dFTEwoZGV2X3ByaXYpKSB7Cj4gKwkJfSBlbHNlIGlmIChJU19IQVNXRUxMKGk5MTUpKSB7Cj4g
ICAJCQlyaW5nX2ZyZXEgPSBtdWx0X2ZyYWMoZ3B1X2ZyZXEsIDUsIDQpOwo+ICAgCQkJcmluZ19m
cmVxID0gbWF4KG1pbl9yaW5nX2ZyZXEsIHJpbmdfZnJlcSk7Cj4gICAJCQkvKiBsZWF2ZSBpYV9m
cmVxIGFzIHRoZSBkZWZhdWx0LCBjaG9zZW4gYnkgY3B1ZnJlcSAqLwo+IEBAIC03NTUyLDcgKzc1
NTIsNyBAQCBzdGF0aWMgdm9pZCBnZW42X3VwZGF0ZV9yaW5nX2ZyZXEoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQkJaWFfZnJlcSA9IERJVl9ST1VORF9DTE9TRVNUKGlh
X2ZyZXEsIDEwMCk7Cj4gICAJCX0KPiAgIAo+IC0JCXNhbmR5YnJpZGdlX3Bjb2RlX3dyaXRlKGRl
dl9wcml2LAo+ICsJCXNhbmR5YnJpZGdlX3Bjb2RlX3dyaXRlKGk5MTUsCj4gICAJCQkJCUdFTjZf
UENPREVfV1JJVEVfTUlOX0ZSRVFfVEFCTEUsCj4gICAJCQkJCWlhX2ZyZXEgPDwgR0VONl9QQ09E
RV9GUkVRX0lBX1JBVElPX1NISUZUIHwKPiAgIAkJCQkJcmluZ19mcmVxIDw8IEdFTjZfUENPREVf
RlJFUV9SSU5HX1JBVElPX1NISUZUIHwKPiBAQCAtNzU2MCwxMyArNzU2MCwxMyBAQCBzdGF0aWMg
dm9pZCBnZW42X3VwZGF0ZV9yaW5nX2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICAgCX0KPiAgIH0KPiAgIAo+IC1zdGF0aWMgaW50IGNoZXJyeXZpZXdfcnBzX21heF9m
cmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIGludCBjaGVy
cnl2aWV3X3Jwc19tYXhfZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsK
PiAgIAl1MzIgdmFsLCBycDA7Cj4gICAKPiAtCXZhbCA9IHZsdl9wdW5pdF9yZWFkKGRldl9wcml2
LCBGQl9HRlhfRk1BWF9BVF9WTUFYX0ZVU0UpOwo+ICsJdmFsID0gdmx2X3B1bml0X3JlYWQoaTkx
NSwgRkJfR0ZYX0ZNQVhfQVRfVk1BWF9GVVNFKTsKPiAgIAo+IC0Jc3dpdGNoIChSVU5USU1FX0lO
Rk8oZGV2X3ByaXYpLT5zc2V1LmV1X3RvdGFsKSB7Cj4gKwlzd2l0Y2ggKFJVTlRJTUVfSU5GTyhp
OTE1KS0+c3NldS5ldV90b3RhbCkgewo+ICAgCWNhc2UgODoKPiAgIAkJLyogKDIgKiA0KSBjb25m
aWcgKi8KPiAgIAkJcnAwID0gKHZhbCA+PiBGQl9HRlhfRk1BWF9BVF9WTUFYXzJTUzRFVV9GVVNF
X1NISUZUKTsKPiBAQCAtNzU4OCw1MyArNzU4OCw1MyBAQCBzdGF0aWMgaW50IGNoZXJyeXZpZXdf
cnBzX21heF9mcmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAlyZXR1
cm4gcnAwOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBpbnQgY2hlcnJ5dmlld19ycHNfcnBlX2ZyZXEo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgaW50IGNoZXJyeXZp
ZXdfcnBzX3JwZV9mcmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAg
CXUzMiB2YWwsIHJwZTsKPiAgIAo+IC0JdmFsID0gdmx2X3B1bml0X3JlYWQoZGV2X3ByaXYsIFBV
TklUX0dQVV9EVVRZQ1lDTEVfUkVHKTsKPiArCXZhbCA9IHZsdl9wdW5pdF9yZWFkKGk5MTUsIFBV
TklUX0dQVV9EVVRZQ1lDTEVfUkVHKTsKPiAgIAlycGUgPSAodmFsID4+IFBVTklUX0dQVV9EVVRZ
Q1lDTEVfUlBFX0ZSRVFfU0hJRlQpICYgUFVOSVRfR1BVX0RVVFlDWUNMRV9SUEVfRlJFUV9NQVNL
Owo+ICAgCj4gICAJcmV0dXJuIHJwZTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgaW50IGNoZXJyeXZp
ZXdfcnBzX2d1YXJfZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0
YXRpYyBpbnQgY2hlcnJ5dmlld19ycHNfZ3Vhcl9mcmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQo+ICAgewo+ICAgCXUzMiB2YWwsIHJwMTsKPiAgIAo+IC0JdmFsID0gdmx2X3B1bml0
X3JlYWQoZGV2X3ByaXYsIEZCX0dGWF9GTUFYX0FUX1ZNQVhfRlVTRSk7Cj4gKwl2YWwgPSB2bHZf
cHVuaXRfcmVhZChpOTE1LCBGQl9HRlhfRk1BWF9BVF9WTUFYX0ZVU0UpOwo+ICAgCXJwMSA9ICh2
YWwgJiBGQl9HRlhfRlJFUV9GVVNFX01BU0spOwo+ICAgCj4gICAJcmV0dXJuIHJwMTsKPiAgIH0K
PiAgIAo+IC1zdGF0aWMgdTMyIGNoZXJyeXZpZXdfcnBzX21pbl9mcmVxKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHUzMiBjaGVycnl2aWV3X3Jwc19taW5fZnJl
cShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAl1MzIgdmFsLCBycG47
Cj4gICAKPiAtCXZhbCA9IHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBGQl9HRlhfRk1JTl9BVF9W
TUlOX0ZVU0UpOwo+ICsJdmFsID0gdmx2X3B1bml0X3JlYWQoaTkxNSwgRkJfR0ZYX0ZNSU5fQVRf
Vk1JTl9GVVNFKTsKPiAgIAlycG4gPSAoKHZhbCA+PiBGQl9HRlhfRk1JTl9BVF9WTUlOX0ZVU0Vf
U0hJRlQpICYKPiAgIAkJICAgICAgIEZCX0dGWF9GUkVRX0ZVU0VfTUFTSyk7Cj4gICAKPiAgIAly
ZXR1cm4gcnBuOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBpbnQgdmFsbGV5dmlld19ycHNfZ3Vhcl9m
cmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIGludCB2YWxs
ZXl2aWV3X3Jwc19ndWFyX2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7
Cj4gICAJdTMyIHZhbCwgcnAxOwo+ICAgCj4gLQl2YWwgPSB2bHZfbmNfcmVhZChkZXZfcHJpdiwg
SU9TRl9OQ19GQl9HRlhfRlJFUV9GVVNFKTsKPiArCXZhbCA9IHZsdl9uY19yZWFkKGk5MTUsIElP
U0ZfTkNfRkJfR0ZYX0ZSRVFfRlVTRSk7Cj4gICAKPiAgIAlycDEgPSAodmFsICYgRkJfR0ZYX0ZH
VUFSQU5URUVEX0ZSRVFfRlVTRV9NQVNLKSA+PiBGQl9HRlhfRkdVQVJBTlRFRURfRlJFUV9GVVNF
X1NISUZUOwo+ICAgCj4gICAJcmV0dXJuIHJwMTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgaW50IHZh
bGxleXZpZXdfcnBzX21heF9mcmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiArc3RhdGljIGludCB2YWxsZXl2aWV3X3Jwc19tYXhfZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAl1MzIgdmFsLCBycDA7Cj4gICAKPiAtCXZhbCA9IHZsdl9u
Y19yZWFkKGRldl9wcml2LCBJT1NGX05DX0ZCX0dGWF9GUkVRX0ZVU0UpOwo+ICsJdmFsID0gdmx2
X25jX3JlYWQoaTkxNSwgSU9TRl9OQ19GQl9HRlhfRlJFUV9GVVNFKTsKPiAgIAo+ICAgCXJwMCA9
ICh2YWwgJiBGQl9HRlhfTUFYX0ZSRVFfRlVTRV9NQVNLKSA+PiBGQl9HRlhfTUFYX0ZSRVFfRlVT
RV9TSElGVDsKPiAgIAkvKiBDbGFtcCB0byBtYXggKi8KPiBAQCAtNzY0MywyMyArNzY0MywyMyBA
QCBzdGF0aWMgaW50IHZhbGxleXZpZXdfcnBzX21heF9mcmVxKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiAgIAlyZXR1cm4gcnAwOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBpbnQg
dmFsbGV5dmlld19ycHNfcnBlX2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ICtzdGF0aWMgaW50IHZhbGxleXZpZXdfcnBzX3JwZV9mcmVxKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUzMiB2YWwsIHJwZTsKPiAgIAo+IC0JdmFsID0gdmx2
X25jX3JlYWQoZGV2X3ByaXYsIElPU0ZfTkNfRkJfR0ZYX0ZNQVhfRlVTRV9MTyk7Cj4gKwl2YWwg
PSB2bHZfbmNfcmVhZChpOTE1LCBJT1NGX05DX0ZCX0dGWF9GTUFYX0ZVU0VfTE8pOwo+ICAgCXJw
ZSA9ICh2YWwgJiBGQl9GTUFYX1ZNSU5fRlJFUV9MT19NQVNLKSA+PiBGQl9GTUFYX1ZNSU5fRlJF
UV9MT19TSElGVDsKPiAtCXZhbCA9IHZsdl9uY19yZWFkKGRldl9wcml2LCBJT1NGX05DX0ZCX0dG
WF9GTUFYX0ZVU0VfSEkpOwo+ICsJdmFsID0gdmx2X25jX3JlYWQoaTkxNSwgSU9TRl9OQ19GQl9H
RlhfRk1BWF9GVVNFX0hJKTsKPiAgIAlycGUgfD0gKHZhbCAmIEZCX0ZNQVhfVk1JTl9GUkVRX0hJ
X01BU0spIDw8IDU7Cj4gICAKPiAgIAlyZXR1cm4gcnBlOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBp
bnQgdmFsbGV5dmlld19ycHNfbWluX2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICtzdGF0aWMgaW50IHZhbGxleXZpZXdfcnBzX21pbl9mcmVxKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUzMiB2YWw7Cj4gICAKPiAtCXZhbCA9IHZsdl9w
dW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfR1BVX0xGTSkgJiAweGZmOwo+ICsJdmFsID0g
dmx2X3B1bml0X3JlYWQoaTkxNSwgUFVOSVRfUkVHX0dQVV9MRk0pICYgMHhmZjsKPiAgIAkvKgo+
ICAgCSAqIEFjY29yZGluZyB0byB0aGUgQllUIFB1bml0IEdQVSB0dXJibyBIQVMgMS4xLjYuMyB0
aGUgbWluaW11bSB2YWx1ZQo+ICAgCSAqIGZvciB0aGUgbWluaW11bSBmcmVxdWVuY3kgaW4gR1BM
TCBtb2RlIGlzIDB4YzEuIENvbnRyYXJ5IHRvIHRoaXMgb24KPiBAQCAtNzY3MSwyNCArNzY3MSwy
NCBAQCBzdGF0aWMgaW50IHZhbGxleXZpZXdfcnBzX21pbl9mcmVxKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiAgIH0KPiAgIAo+ICAgLyogQ2hlY2sgdGhhdCB0aGUgcGN0eCBi
dWZmZXIgd2Fzbid0IG1vdmUgdW5kZXIgdXMuICovCj4gLXN0YXRpYyB2b2lkIHZhbGxleXZpZXdf
Y2hlY2tfcGN0eChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2
b2lkIHZhbGxleXZpZXdfY2hlY2tfcGN0eChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiAgIHsKPiAgIAl1bnNpZ25lZCBsb25nIHBjdHhfYWRkciA9IEk5MTVfUkVBRChWTFZfUENCUikg
JiB+NDA5NTsKPiAgIAo+IC0JV0FSTl9PTihwY3R4X2FkZHIgIT0gZGV2X3ByaXYtPmRzbS5zdGFy
dCArCj4gLQkJCSAgICAgZGV2X3ByaXYtPnZsdl9wY3R4LT5zdG9sZW4tPnN0YXJ0KTsKPiArCVdB
Uk5fT04ocGN0eF9hZGRyICE9IGk5MTUtPmRzbS5zdGFydCArCj4gKwkJCSAgICAgaTkxNS0+dmx2
X3BjdHgtPnN0b2xlbi0+c3RhcnQpOwo+ICAgfQo+ICAgCj4gICAKPiAgIC8qIENoZWNrIHRoYXQg
dGhlIHBjYnIgYWRkcmVzcyBpcyBub3QgZW1wdHkuICovCj4gLXN0YXRpYyB2b2lkIGNoZXJyeXZp
ZXdfY2hlY2tfcGN0eChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRp
YyB2b2lkIGNoZXJyeXZpZXdfY2hlY2tfcGN0eChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiAgIHsKPiAgIAl1bnNpZ25lZCBsb25nIHBjdHhfYWRkciA9IEk5MTVfUkVBRChWTFZfUENC
UikgJiB+NDA5NTsKPiAgIAo+ICAgCVdBUk5fT04oKHBjdHhfYWRkciA+PiBWTFZfUENCUl9BRERS
X1NISUZUKSA9PSAwKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBjaGVycnl2aWV3X3NldHVw
X3BjdHgoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBj
aGVycnl2aWV3X3NldHVwX3BjdHgoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7
Cj4gICAJcmVzb3VyY2Vfc2l6ZV90IHBjdHhfcGFkZHIsIHBhZGRyOwo+ICAgCXJlc291cmNlX3Np
emVfdCBwY3R4X3NpemUgPSAzMioxMDI0Owo+IEBAIC03Njk3LDcgKzc2OTcsNyBAQCBzdGF0aWMg
dm9pZCBjaGVycnl2aWV3X3NldHVwX3BjdHgoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICAgCXBjYnIgPSBJOTE1X1JFQUQoVkxWX1BDQlIpOwo+ICAgCWlmICgocGNiciA+PiBW
TFZfUENCUl9BRERSX1NISUZUKSA9PSAwKSB7Cj4gICAJCURSTV9ERUJVR19EUklWRVIoIkJJT1Mg
ZGlkbid0IHNldCB1cCBQQ0JSLCBmaXhpbmcgdXBcbiIpOwo+IC0JCXBhZGRyID0gZGV2X3ByaXYt
PmRzbS5lbmQgKyAxIC0gcGN0eF9zaXplOwo+ICsJCXBhZGRyID0gaTkxNS0+ZHNtLmVuZCArIDEg
LSBwY3R4X3NpemU7Cj4gICAJCUdFTV9CVUdfT04ocGFkZHIgPiBVMzJfTUFYKTsKPiAgIAo+ICAg
CQlwY3R4X3BhZGRyID0gKHBhZGRyICYgKH40MDk1KSk7Cj4gQEAgLTc3MDcsNyArNzcwNyw3IEBA
IHN0YXRpYyB2b2lkIGNoZXJyeXZpZXdfc2V0dXBfcGN0eChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gICAJRFJNX0RFQlVHX0RSSVZFUigiUENCUjogMHglMDh4XG4iLCBJOTE1
X1JFQUQoVkxWX1BDQlIpKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCB2YWxsZXl2aWV3X3Nl
dHVwX3BjdHgoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9p
ZCB2YWxsZXl2aWV3X3NldHVwX3BjdHgoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
ICB7Cj4gICAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKnBjdHg7Cj4gICAJcmVzb3VyY2Vf
c2l6ZV90IHBjdHhfcGFkZHI7Cj4gQEAgLTc3MTksOCArNzcxOSw4IEBAIHN0YXRpYyB2b2lkIHZh
bGxleXZpZXdfc2V0dXBfcGN0eChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
ICAJCS8qIEJJT1Mgc2V0IGl0IHVwIGFscmVhZHksIGdyYWIgdGhlIHByZS1hbGxvYydkIHNwYWNl
ICovCj4gICAJCXJlc291cmNlX3NpemVfdCBwY2JyX29mZnNldDsKPiAgIAo+IC0JCXBjYnJfb2Zm
c2V0ID0gKHBjYnIgJiAofjQwOTUpKSAtIGRldl9wcml2LT5kc20uc3RhcnQ7Cj4gLQkJcGN0eCA9
IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfc3RvbGVuX2Zvcl9wcmVhbGxvY2F0ZWQoZGV2X3ByaXYs
Cj4gKwkJcGNicl9vZmZzZXQgPSAocGNiciAmICh+NDA5NSkpIC0gaTkxNS0+ZHNtLnN0YXJ0Owo+
ICsJCXBjdHggPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3N0b2xlbl9mb3JfcHJlYWxsb2NhdGVk
KGk5MTUsCj4gICAJCQkJCQkJCSAgICAgIHBjYnJfb2Zmc2V0LAo+ICAgCQkJCQkJCQkgICAgICBJ
OTE1X0dUVF9PRkZTRVRfTk9ORSwKPiAgIAkJCQkJCQkJICAgICAgcGN0eF9zaXplKTsKPiBAQCAt
NzczNywxNDggKzc3MzcsMTQ4IEBAIHN0YXRpYyB2b2lkIHZhbGxleXZpZXdfc2V0dXBfcGN0eChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICogb3ZlcmxhcCB3aXRoIG90
aGVyIHJhbmdlcywgc3VjaCBhcyB0aGUgZnJhbWUgYnVmZmVyLCBwcm90ZWN0ZWQKPiAgIAkgKiBt
ZW1vcnksIG9yIGFueSBvdGhlciByZWxldmFudCByYW5nZXMuCj4gICAJICovCj4gLQlwY3R4ID0g
aTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zdG9sZW4oZGV2X3ByaXYsIHBjdHhfc2l6ZSk7Cj4gKwlw
Y3R4ID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zdG9sZW4oaTkxNSwgcGN0eF9zaXplKTsKPiAg
IAlpZiAoIXBjdHgpIHsKPiAgIAkJRFJNX0RFQlVHKCJub3QgZW5vdWdoIHN0b2xlbiBzcGFjZSBm
b3IgUENUWCwgZGlzYWJsaW5nXG4iKTsKPiAgIAkJZ290byBvdXQ7Cj4gICAJfQo+ICAgCj4gICAJ
R0VNX0JVR19PTihyYW5nZV9vdmVyZmxvd3NfdCh1NjQsCj4gLQkJCQkgICAgIGRldl9wcml2LT5k
c20uc3RhcnQsCj4gKwkJCQkgICAgIGk5MTUtPmRzbS5zdGFydCwKPiAgIAkJCQkgICAgIHBjdHgt
PnN0b2xlbi0+c3RhcnQsCj4gICAJCQkJICAgICBVMzJfTUFYKSk7Cj4gLQlwY3R4X3BhZGRyID0g
ZGV2X3ByaXYtPmRzbS5zdGFydCArIHBjdHgtPnN0b2xlbi0+c3RhcnQ7Cj4gKwlwY3R4X3BhZGRy
ID0gaTkxNS0+ZHNtLnN0YXJ0ICsgcGN0eC0+c3RvbGVuLT5zdGFydDsKPiAgIAlJOTE1X1dSSVRF
KFZMVl9QQ0JSLCBwY3R4X3BhZGRyKTsKPiAgIAo+ICAgb3V0Ogo+ICAgCURSTV9ERUJVR19EUklW
RVIoIlBDQlI6IDB4JTA4eFxuIiwgSTkxNV9SRUFEKFZMVl9QQ0JSKSk7Cj4gLQlkZXZfcHJpdi0+
dmx2X3BjdHggPSBwY3R4Owo+ICsJaTkxNS0+dmx2X3BjdHggPSBwY3R4Owo+ICAgfQo+ICAgCj4g
LXN0YXRpYyB2b2lkIHZhbGxleXZpZXdfY2xlYW51cF9wY3R4KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgdmFsbGV5dmlld19jbGVhbnVwX3BjdHgoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKnBjdHg7Cj4gICAKPiAtCXBjdHggPSBmZXRjaF9hbmRfemVybygmZGV2X3ByaXYt
PnZsdl9wY3R4KTsKPiArCXBjdHggPSBmZXRjaF9hbmRfemVybygmaTkxNS0+dmx2X3BjdHgpOwo+
ICAgCWlmIChwY3R4KQo+ICAgCQlpOTE1X2dlbV9vYmplY3RfcHV0KHBjdHgpOwo+ICAgfQo+ICAg
Cj4gLXN0YXRpYyB2b2lkIHZsdl9pbml0X2dwbGxfcmVmX2ZyZXEoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCB2bHZfaW5pdF9ncGxsX3JlZl9mcmVxKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JZGV2X3ByaXYtPmd0X3BtLnJw
cy5ncGxsX3JlZl9mcmVxID0KPiAtCQl2bHZfZ2V0X2Nja19jbG9jayhkZXZfcHJpdiwgIkdQTEwg
cmVmIiwKPiArCWk5MTUtPmd0X3BtLnJwcy5ncGxsX3JlZl9mcmVxID0KPiArCQl2bHZfZ2V0X2Nj
a19jbG9jayhpOTE1LCAiR1BMTCByZWYiLAo+ICAgCQkJCSAgQ0NLX0dQTExfQ0xPQ0tfQ09OVFJP
TCwKPiAtCQkJCSAgZGV2X3ByaXYtPmN6Y2xrX2ZyZXEpOwo+ICsJCQkJICBpOTE1LT5jemNsa19m
cmVxKTsKPiAgIAo+ICAgCURSTV9ERUJVR19EUklWRVIoIkdQTEwgcmVmZXJlbmNlIGZyZXE6ICVk
IGtIelxuIiwKPiAtCQkJIGRldl9wcml2LT5ndF9wbS5ycHMuZ3BsbF9yZWZfZnJlcSk7Cj4gKwkJ
CSBpOTE1LT5ndF9wbS5ycHMuZ3BsbF9yZWZfZnJlcSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZv
aWQgdmFsbGV5dmlld19pbml0X2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIHZhbGxleXZpZXdfaW5pdF9ndF9wb3dlcnNhdmUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfcnBzICpy
cHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKPiArCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZp
OTE1LT5ndF9wbS5ycHM7Cj4gICAJdTMyIHZhbDsKPiAgIAo+IC0JdmFsbGV5dmlld19zZXR1cF9w
Y3R4KGRldl9wcml2KTsKPiArCXZhbGxleXZpZXdfc2V0dXBfcGN0eChpOTE1KTsKPiAgIAo+IC0J
dmx2X2lvc2Zfc2JfZ2V0KGRldl9wcml2LAo+ICsJdmx2X2lvc2Zfc2JfZ2V0KGk5MTUsCj4gICAJ
CQlCSVQoVkxWX0lPU0ZfU0JfUFVOSVQpIHwKPiAgIAkJCUJJVChWTFZfSU9TRl9TQl9OQykgfAo+
ICAgCQkJQklUKFZMVl9JT1NGX1NCX0NDSykpOwo+ICAgCj4gLQl2bHZfaW5pdF9ncGxsX3JlZl9m
cmVxKGRldl9wcml2KTsKPiArCXZsdl9pbml0X2dwbGxfcmVmX2ZyZXEoaTkxNSk7Cj4gICAKPiAt
CXZhbCA9IHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfR1BVX0ZSRVFfU1RTKTsK
PiArCXZhbCA9IHZsdl9wdW5pdF9yZWFkKGk5MTUsIFBVTklUX1JFR19HUFVfRlJFUV9TVFMpOwo+
ICAgCXN3aXRjaCAoKHZhbCA+PiA2KSAmIDMpIHsKPiAgIAljYXNlIDA6Cj4gICAJY2FzZSAxOgo+
IC0JCWRldl9wcml2LT5tZW1fZnJlcSA9IDgwMDsKPiArCQlpOTE1LT5tZW1fZnJlcSA9IDgwMDsK
PiAgIAkJYnJlYWs7Cj4gICAJY2FzZSAyOgo+IC0JCWRldl9wcml2LT5tZW1fZnJlcSA9IDEwNjY7
Cj4gKwkJaTkxNS0+bWVtX2ZyZXEgPSAxMDY2Owo+ICAgCQlicmVhazsKPiAgIAljYXNlIDM6Cj4g
LQkJZGV2X3ByaXYtPm1lbV9mcmVxID0gMTMzMzsKPiArCQlpOTE1LT5tZW1fZnJlcSA9IDEzMzM7
Cj4gICAJCWJyZWFrOwo+ICAgCX0KPiAtCURSTV9ERUJVR19EUklWRVIoIkREUiBzcGVlZDogJWQg
TUh6XG4iLCBkZXZfcHJpdi0+bWVtX2ZyZXEpOwo+ICsJRFJNX0RFQlVHX0RSSVZFUigiRERSIHNw
ZWVkOiAlZCBNSHpcbiIsIGk5MTUtPm1lbV9mcmVxKTsKPiAgIAo+IC0JcnBzLT5tYXhfZnJlcSA9
IHZhbGxleXZpZXdfcnBzX21heF9mcmVxKGRldl9wcml2KTsKPiArCXJwcy0+bWF4X2ZyZXEgPSB2
YWxsZXl2aWV3X3Jwc19tYXhfZnJlcShpOTE1KTsKPiAgIAlycHMtPnJwMF9mcmVxID0gcnBzLT5t
YXhfZnJlcTsKPiAgIAlEUk1fREVCVUdfRFJJVkVSKCJtYXggR1BVIGZyZXE6ICVkIE1IeiAoJXUp
XG4iLAo+IC0JCQkgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+bWF4X2ZyZXEpLAo+ICsJ
CQkgaW50ZWxfZ3B1X2ZyZXEoaTkxNSwgcnBzLT5tYXhfZnJlcSksCj4gICAJCQkgcnBzLT5tYXhf
ZnJlcSk7Cj4gICAKPiAtCXJwcy0+ZWZmaWNpZW50X2ZyZXEgPSB2YWxsZXl2aWV3X3Jwc19ycGVf
ZnJlcShkZXZfcHJpdik7Cj4gKwlycHMtPmVmZmljaWVudF9mcmVxID0gdmFsbGV5dmlld19ycHNf
cnBlX2ZyZXEoaTkxNSk7Cj4gICAJRFJNX0RFQlVHX0RSSVZFUigiUlBlIEdQVSBmcmVxOiAlZCBN
SHogKCV1KVxuIiwKPiAtCQkJIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMtPmVmZmljaWVu
dF9mcmVxKSwKPiArCQkJIGludGVsX2dwdV9mcmVxKGk5MTUsIHJwcy0+ZWZmaWNpZW50X2ZyZXEp
LAo+ICAgCQkJIHJwcy0+ZWZmaWNpZW50X2ZyZXEpOwo+ICAgCj4gLQlycHMtPnJwMV9mcmVxID0g
dmFsbGV5dmlld19ycHNfZ3Vhcl9mcmVxKGRldl9wcml2KTsKPiArCXJwcy0+cnAxX2ZyZXEgPSB2
YWxsZXl2aWV3X3Jwc19ndWFyX2ZyZXEoaTkxNSk7Cj4gICAJRFJNX0RFQlVHX0RSSVZFUigiUlAx
KEd1YXIgRnJlcSkgR1BVIGZyZXE6ICVkIE1IeiAoJXUpXG4iLAo+IC0JCQkgaW50ZWxfZ3B1X2Zy
ZXEoZGV2X3ByaXYsIHJwcy0+cnAxX2ZyZXEpLAo+ICsJCQkgaW50ZWxfZ3B1X2ZyZXEoaTkxNSwg
cnBzLT5ycDFfZnJlcSksCj4gICAJCQkgcnBzLT5ycDFfZnJlcSk7Cj4gICAKPiAtCXJwcy0+bWlu
X2ZyZXEgPSB2YWxsZXl2aWV3X3Jwc19taW5fZnJlcShkZXZfcHJpdik7Cj4gKwlycHMtPm1pbl9m
cmVxID0gdmFsbGV5dmlld19ycHNfbWluX2ZyZXEoaTkxNSk7Cj4gICAJRFJNX0RFQlVHX0RSSVZF
UigibWluIEdQVSBmcmVxOiAlZCBNSHogKCV1KVxuIiwKPiAtCQkJIGludGVsX2dwdV9mcmVxKGRl
dl9wcml2LCBycHMtPm1pbl9mcmVxKSwKPiArCQkJIGludGVsX2dwdV9mcmVxKGk5MTUsIHJwcy0+
bWluX2ZyZXEpLAo+ICAgCQkJIHJwcy0+bWluX2ZyZXEpOwo+ICAgCj4gLQl2bHZfaW9zZl9zYl9w
dXQoZGV2X3ByaXYsCj4gKwl2bHZfaW9zZl9zYl9wdXQoaTkxNSwKPiAgIAkJCUJJVChWTFZfSU9T
Rl9TQl9QVU5JVCkgfAo+ICAgCQkJQklUKFZMVl9JT1NGX1NCX05DKSB8Cj4gICAJCQlCSVQoVkxW
X0lPU0ZfU0JfQ0NLKSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgY2hlcnJ5dmlld19pbml0
X2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRp
YyB2b2lkIGNoZXJyeXZpZXdfaW5pdF9ndF9wb3dlcnNhdmUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0
X3BtLnJwczsKPiArCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1LT5ndF9wbS5ycHM7Cj4g
ICAJdTMyIHZhbDsKPiAgIAo+IC0JY2hlcnJ5dmlld19zZXR1cF9wY3R4KGRldl9wcml2KTsKPiAr
CWNoZXJyeXZpZXdfc2V0dXBfcGN0eChpOTE1KTsKPiAgIAo+IC0Jdmx2X2lvc2Zfc2JfZ2V0KGRl
dl9wcml2LAo+ICsJdmx2X2lvc2Zfc2JfZ2V0KGk5MTUsCj4gICAJCQlCSVQoVkxWX0lPU0ZfU0Jf
UFVOSVQpIHwKPiAgIAkJCUJJVChWTFZfSU9TRl9TQl9OQykgfAo+ICAgCQkJQklUKFZMVl9JT1NG
X1NCX0NDSykpOwo+ICAgCj4gLQl2bHZfaW5pdF9ncGxsX3JlZl9mcmVxKGRldl9wcml2KTsKPiAr
CXZsdl9pbml0X2dwbGxfcmVmX2ZyZXEoaTkxNSk7Cj4gICAKPiAtCXZhbCA9IHZsdl9jY2tfcmVh
ZChkZXZfcHJpdiwgQ0NLX0ZVU0VfUkVHKTsKPiArCXZhbCA9IHZsdl9jY2tfcmVhZChpOTE1LCBD
Q0tfRlVTRV9SRUcpOwo+ICAgCj4gICAJc3dpdGNoICgodmFsID4+IDIpICYgMHg3KSB7Cj4gICAJ
Y2FzZSAzOgo+IC0JCWRldl9wcml2LT5tZW1fZnJlcSA9IDIwMDA7Cj4gKwkJaTkxNS0+bWVtX2Zy
ZXEgPSAyMDAwOwo+ICAgCQlicmVhazsKPiAgIAlkZWZhdWx0Ogo+IC0JCWRldl9wcml2LT5tZW1f
ZnJlcSA9IDE2MDA7Cj4gKwkJaTkxNS0+bWVtX2ZyZXEgPSAxNjAwOwo+ICAgCQlicmVhazsKPiAg
IAl9Cj4gLQlEUk1fREVCVUdfRFJJVkVSKCJERFIgc3BlZWQ6ICVkIE1IelxuIiwgZGV2X3ByaXYt
Pm1lbV9mcmVxKTsKPiArCURSTV9ERUJVR19EUklWRVIoIkREUiBzcGVlZDogJWQgTUh6XG4iLCBp
OTE1LT5tZW1fZnJlcSk7Cj4gICAKPiAtCXJwcy0+bWF4X2ZyZXEgPSBjaGVycnl2aWV3X3Jwc19t
YXhfZnJlcShkZXZfcHJpdik7Cj4gKwlycHMtPm1heF9mcmVxID0gY2hlcnJ5dmlld19ycHNfbWF4
X2ZyZXEoaTkxNSk7Cj4gICAJcnBzLT5ycDBfZnJlcSA9IHJwcy0+bWF4X2ZyZXE7Cj4gICAJRFJN
X0RFQlVHX0RSSVZFUigibWF4IEdQVSBmcmVxOiAlZCBNSHogKCV1KVxuIiwKPiAtCQkJIGludGVs
X2dwdV9mcmVxKGRldl9wcml2LCBycHMtPm1heF9mcmVxKSwKPiArCQkJIGludGVsX2dwdV9mcmVx
KGk5MTUsIHJwcy0+bWF4X2ZyZXEpLAo+ICAgCQkJIHJwcy0+bWF4X2ZyZXEpOwo+ICAgCj4gLQly
cHMtPmVmZmljaWVudF9mcmVxID0gY2hlcnJ5dmlld19ycHNfcnBlX2ZyZXEoZGV2X3ByaXYpOwo+
ICsJcnBzLT5lZmZpY2llbnRfZnJlcSA9IGNoZXJyeXZpZXdfcnBzX3JwZV9mcmVxKGk5MTUpOwo+
ICAgCURSTV9ERUJVR19EUklWRVIoIlJQZSBHUFUgZnJlcTogJWQgTUh6ICgldSlcbiIsCj4gLQkJ
CSBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5lZmZpY2llbnRfZnJlcSksCj4gKwkJCSBp
bnRlbF9ncHVfZnJlcShpOTE1LCBycHMtPmVmZmljaWVudF9mcmVxKSwKPiAgIAkJCSBycHMtPmVm
ZmljaWVudF9mcmVxKTsKPiAgIAo+IC0JcnBzLT5ycDFfZnJlcSA9IGNoZXJyeXZpZXdfcnBzX2d1
YXJfZnJlcShkZXZfcHJpdik7Cj4gKwlycHMtPnJwMV9mcmVxID0gY2hlcnJ5dmlld19ycHNfZ3Vh
cl9mcmVxKGk5MTUpOwo+ICAgCURSTV9ERUJVR19EUklWRVIoIlJQMShHdWFyKSBHUFUgZnJlcTog
JWQgTUh6ICgldSlcbiIsCj4gLQkJCSBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5ycDFf
ZnJlcSksCj4gKwkJCSBpbnRlbF9ncHVfZnJlcShpOTE1LCBycHMtPnJwMV9mcmVxKSwKPiAgIAkJ
CSBycHMtPnJwMV9mcmVxKTsKPiAgIAo+IC0JcnBzLT5taW5fZnJlcSA9IGNoZXJyeXZpZXdfcnBz
X21pbl9mcmVxKGRldl9wcml2KTsKPiArCXJwcy0+bWluX2ZyZXEgPSBjaGVycnl2aWV3X3Jwc19t
aW5fZnJlcShpOTE1KTsKPiAgIAlEUk1fREVCVUdfRFJJVkVSKCJtaW4gR1BVIGZyZXE6ICVkIE1I
eiAoJXUpXG4iLAo+IC0JCQkgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+bWluX2ZyZXEp
LAo+ICsJCQkgaW50ZWxfZ3B1X2ZyZXEoaTkxNSwgcnBzLT5taW5fZnJlcSksCj4gICAJCQkgcnBz
LT5taW5fZnJlcSk7Cj4gICAKPiAtCXZsdl9pb3NmX3NiX3B1dChkZXZfcHJpdiwKPiArCXZsdl9p
b3NmX3NiX3B1dChpOTE1LAo+ICAgCQkJQklUKFZMVl9JT1NGX1NCX1BVTklUKSB8Cj4gICAJCQlC
SVQoVkxWX0lPU0ZfU0JfTkMpIHwKPiAgIAkJCUJJVChWTFZfSU9TRl9TQl9DQ0spKTsKPiBAQCAt
Nzg4OCwxMiArNzg4OCwxMiBAQCBzdGF0aWMgdm9pZCBjaGVycnl2aWV3X2luaXRfZ3RfcG93ZXJz
YXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkJICAiT2RkIEdQVSBm
cmVxIHZhbHVlc1xuIik7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgdmFsbGV5dmlld19jbGVh
bnVwX2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0
YXRpYyB2b2lkIHZhbGxleXZpZXdfY2xlYW51cF9ndF9wb3dlcnNhdmUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQl2YWxsZXl2aWV3X2NsZWFudXBfcGN0eChkZXZfcHJp
dik7Cj4gKwl2YWxsZXl2aWV3X2NsZWFudXBfcGN0eChpOTE1KTsKPiAgIH0KPiAgIAo+IC1zdGF0
aWMgdm9pZCBjaGVycnl2aWV3X2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ICtzdGF0aWMgdm9pZCBjaGVycnl2aWV3X2VuYWJsZV9yYzYoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lOwo+ICAgCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwo+IEBAIC03OTA3LDExICs3OTA3LDEx
IEBAIHN0YXRpYyB2b2lkIGNoZXJyeXZpZXdfZW5hYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gICAJCUk5MTVfV1JJVEUoR1RGSUZPREJHLCBndGZpZm9kYmcpOwo+
ICAgCX0KPiAgIAo+IC0JY2hlcnJ5dmlld19jaGVja19wY3R4KGRldl9wcml2KTsKPiArCWNoZXJy
eXZpZXdfY2hlY2tfcGN0eChpOTE1KTsKPiAgIAo+ICAgCS8qIDFhICYgMWI6IEdldCBmb3JjZXdh
a2UgZHVyaW5nIHByb2dyYW0gc2VxdWVuY2UuIEFsdGhvdWdoIHRoZSBkcml2ZXIKPiAgIAkgKiBo
YXNuJ3QgZW5hYmxlZCBhIHN0YXRlIHlldCB3aGVyZSB3ZSBuZWVkIGZvcmNld2FrZSwgQklPUyBt
YXkgaGF2ZS4qLwo+IC0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmRldl9wcml2LT51bmNv
cmUsIEZPUkNFV0FLRV9BTEwpOwo+ICsJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmk5MTUt
PnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gICAKPiAgIAkvKiAgRGlzYWJsZSBSQyBzdGF0ZXMu
ICovCj4gICAJSTkxNV9XUklURShHRU42X1JDX0NPTlRST0wsIDApOwo+IEBAIC03OTIxLDcgKzc5
MjEsNyBAQCBzdGF0aWMgdm9pZCBjaGVycnl2aWV3X2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCUk5MTVfV1JJVEUoR0VONl9SQ19FVkFMVUFUSU9OX0lO
VEVSVkFMLCAxMjUwMDApOyAvKiAxMjUwMCAqIDEyODBucyAqLwo+ICAgCUk5MTVfV1JJVEUoR0VO
Nl9SQ19JRExFX0hZU1RFUlNJUywgMjUpOyAvKiAyNSAqIDEyODBucyAqLwo+ICAgCj4gLQlmb3Jf
ZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpCj4gKwlmb3JfZWFjaF9lbmdpbmUoZW5n
aW5lLCBpOTE1LCBpZCkKPiAgIAkJSTkxNV9XUklURShSSU5HX01BWF9JRExFKGVuZ2luZS0+bW1p
b19iYXNlKSwgMTApOwo+ICAgCUk5MTVfV1JJVEUoR0VONl9SQ19TTEVFUCwgMCk7Cj4gICAKPiBA
QCAtNzk0MywxNCArNzk0MywxNCBAQCBzdGF0aWMgdm9pZCBjaGVycnl2aWV3X2VuYWJsZV9yYzYo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQlyYzZfbW9kZSA9IEdFTjdf
UkNfQ1RMX1RPX01PREU7Cj4gICAJSTkxNV9XUklURShHRU42X1JDX0NPTlRST0wsIHJjNl9tb2Rl
KTsKPiAgIAo+IC0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUs
IEZPUkNFV0FLRV9BTEwpOwo+ICsJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmk5MTUtPnVu
Y29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgY2hlcnJ5dmll
d19lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGlj
IHZvaWQgY2hlcnJ5dmlld19lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ICAgewo+ICAgCXUzMiB2YWw7Cj4gICAKPiAtCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0
KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiArCWludGVsX3VuY29yZV9mb3Jj
ZXdha2VfZ2V0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ICAgCj4gICAJLyogMTog
UHJvZ3JhbSBkZWZhdWx0cyBhbmQgdGhyZXNob2xkcyBmb3IgUlBTKi8KPiAgIAlJOTE1X1dSSVRF
KEdFTjZfUlBfRE9XTl9USU1FT1VULCAxMDAwMDAwKTsKPiBAQCAtNzk3MCwxNCArNzk3MCwxNCBA
QCBzdGF0aWMgdm9pZCBjaGVycnl2aWV3X2VuYWJsZV9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ICAgCQkgICBHRU42X1JQX0RPV05fSURMRV9BVkcpOwo+ICAgCj4gICAJ
LyogU2V0dGluZyBGaXhlZCBCaWFzICovCj4gLQl2bHZfcHVuaXRfZ2V0KGRldl9wcml2KTsKPiAr
CXZsdl9wdW5pdF9nZXQoaTkxNSk7Cj4gICAKPiAgIAl2YWwgPSBWTFZfT1ZFUlJJREVfRU4gfCBW
TFZfU09DX1REUF9FTiB8IENIVl9CSUFTX0NQVV81MF9TT0NfNTA7Cj4gLQl2bHZfcHVuaXRfd3Jp
dGUoZGV2X3ByaXYsIFZMVl9UVVJCT19TT0NfT1ZFUlJJREUsIHZhbCk7Cj4gKwl2bHZfcHVuaXRf
d3JpdGUoaTkxNSwgVkxWX1RVUkJPX1NPQ19PVkVSUklERSwgdmFsKTsKPiAgIAo+IC0JdmFsID0g
dmx2X3B1bml0X3JlYWQoZGV2X3ByaXYsIFBVTklUX1JFR19HUFVfRlJFUV9TVFMpOwo+ICsJdmFs
ID0gdmx2X3B1bml0X3JlYWQoaTkxNSwgUFVOSVRfUkVHX0dQVV9GUkVRX1NUUyk7Cj4gICAKPiAt
CXZsdl9wdW5pdF9wdXQoZGV2X3ByaXYpOwo+ICsJdmx2X3B1bml0X3B1dChpOTE1KTsKPiAgIAo+
ICAgCS8qIFJQUyBjb2RlIGFzc3VtZXMgR1BMTCBpcyB1c2VkICovCj4gICAJV0FSTl9PTkNFKCh2
YWwgJiBHUExMRU5BQkxFKSA9PSAwLCAiR1BMTCBub3QgZW5hYmxlZFxuIik7Cj4gQEAgLTc5ODUs
MTggKzc5ODUsMTggQEAgc3RhdGljIHZvaWQgY2hlcnJ5dmlld19lbmFibGVfcnBzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAlEUk1fREVCVUdfRFJJVkVSKCJHUExMIGVu
YWJsZWQ/ICVzXG4iLCB5ZXNubyh2YWwgJiBHUExMRU5BQkxFKSk7Cj4gICAJRFJNX0RFQlVHX0RS
SVZFUigiR1BVIHN0YXR1czogMHglMDh4XG4iLCB2YWwpOwo+ICAgCj4gLQlyZXNldF9ycHMoZGV2
X3ByaXYsIHZhbGxleXZpZXdfc2V0X3Jwcyk7Cj4gKwlyZXNldF9ycHMoaTkxNSwgdmFsbGV5dmll
d19zZXRfcnBzKTsKPiAgIAo+IC0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2
LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ICsJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQo
Jmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQg
dmFsbGV5dmlld19lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiArc3RhdGljIHZvaWQgdmFsbGV5dmlld19lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKPiAg
IAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKPiAgIAl1MzIgZ3RmaWZvZGJnOwo+ICAgCj4gLQl2
YWxsZXl2aWV3X2NoZWNrX3BjdHgoZGV2X3ByaXYpOwo+ICsJdmFsbGV5dmlld19jaGVja19wY3R4
KGk5MTUpOwo+ICAgCj4gICAJZ3RmaWZvZGJnID0gSTkxNV9SRUFEKEdURklGT0RCRyk7Cj4gICAJ
aWYgKGd0Zmlmb2RiZykgewo+IEBAIC04MDA1LDcgKzgwMDUsNyBAQCBzdGF0aWMgdm9pZCB2YWxs
ZXl2aWV3X2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAg
CQlJOTE1X1dSSVRFKEdURklGT0RCRywgZ3RmaWZvZGJnKTsKPiAgIAl9Cj4gICAKPiAtCWludGVs
X3VuY29yZV9mb3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsK
PiArCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9B
TEwpOwo+ICAgCj4gICAJLyogIERpc2FibGUgUkMgc3RhdGVzLiAqLwo+ICAgCUk5MTVfV1JJVEUo
R0VONl9SQ19DT05UUk9MLCAwKTsKPiBAQCAtODAxNCw3ICs4MDE0LDcgQEAgc3RhdGljIHZvaWQg
dmFsbGV5dmlld19lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiAgIAlJOTE1X1dSSVRFKEdFTjZfUkNfRVZBTFVBVElPTl9JTlRFUlZBTCwgMTI1MDAwKTsKPiAg
IAlJOTE1X1dSSVRFKEdFTjZfUkNfSURMRV9IWVNURVJTSVMsIDI1KTsKPiAgIAo+IC0JZm9yX2Vh
Y2hfZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYsIGlkKQo+ICsJZm9yX2VhY2hfZW5naW5lKGVuZ2lu
ZSwgaTkxNSwgaWQpCj4gICAJCUk5MTVfV1JJVEUoUklOR19NQVhfSURMRShlbmdpbmUtPm1taW9f
YmFzZSksIDEwKTsKPiAgIAo+ICAgCUk5MTVfV1JJVEUoR0VONl9SQzZfVEhSRVNIT0xELCAweDU1
Nyk7Cj4gQEAgLTgwMzAsMTQgKzgwMzAsMTQgQEAgc3RhdGljIHZvaWQgdmFsbGV5dmlld19lbmFi
bGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAlJOTE1X1dSSVRF
KEdFTjZfUkNfQ09OVFJPTCwKPiAgIAkJICAgR0VON19SQ19DVExfVE9fTU9ERSB8IFZMVl9SQ19D
VExfQ1RYX1JTVF9QQVJBTExFTCk7Cj4gICAKPiAtCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0
KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiArCWludGVsX3VuY29yZV9mb3Jj
ZXdha2VfcHV0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ICAgfQo+ICAgCj4gLXN0
YXRpYyB2b2lkIHZhbGxleXZpZXdfZW5hYmxlX3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIHZhbGxleXZpZXdfZW5hYmxlX3JwcyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAl1MzIgdmFsOwo+ICAgCj4gLQlpbnRlbF91
bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4g
KwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxM
KTsKPiAgIAo+ICAgCUk5MTVfV1JJVEUoR0VONl9SUF9ET1dOX1RJTUVPVVQsIDEwMDAwMDApOwo+
ICAgCUk5MTVfV1JJVEUoR0VONl9SUF9VUF9USFJFU0hPTEQsIDU5NDAwKTsKPiBAQCAtODA1NSwx
NSArODA1NSwxNSBAQCBzdGF0aWMgdm9pZCB2YWxsZXl2aWV3X2VuYWJsZV9ycHMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQkgICBHRU42X1JQX1VQX0JVU1lfQVZHIHwK
PiAgIAkJICAgR0VONl9SUF9ET1dOX0lETEVfQ09OVCk7Cj4gICAKPiAtCXZsdl9wdW5pdF9nZXQo
ZGV2X3ByaXYpOwo+ICsJdmx2X3B1bml0X2dldChpOTE1KTsKPiAgIAo+ICAgCS8qIFNldHRpbmcg
Rml4ZWQgQmlhcyAqLwo+ICAgCXZhbCA9IFZMVl9PVkVSUklERV9FTiB8IFZMVl9TT0NfVERQX0VO
IHwgVkxWX0JJQVNfQ1BVXzEyNV9TT0NfODc1Owo+IC0Jdmx2X3B1bml0X3dyaXRlKGRldl9wcml2
LCBWTFZfVFVSQk9fU09DX09WRVJSSURFLCB2YWwpOwo+ICsJdmx2X3B1bml0X3dyaXRlKGk5MTUs
IFZMVl9UVVJCT19TT0NfT1ZFUlJJREUsIHZhbCk7Cj4gICAKPiAtCXZhbCA9IHZsdl9wdW5pdF9y
ZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfR1BVX0ZSRVFfU1RTKTsKPiArCXZhbCA9IHZsdl9wdW5p
dF9yZWFkKGk5MTUsIFBVTklUX1JFR19HUFVfRlJFUV9TVFMpOwo+ICAgCj4gLQl2bHZfcHVuaXRf
cHV0KGRldl9wcml2KTsKPiArCXZsdl9wdW5pdF9wdXQoaTkxNSk7Cj4gICAKPiAgIAkvKiBSUFMg
Y29kZSBhc3N1bWVzIEdQTEwgaXMgdXNlZCAqLwo+ICAgCVdBUk5fT05DRSgodmFsICYgR1BMTEVO
QUJMRSkgPT0gMCwgIkdQTEwgbm90IGVuYWJsZWRcbiIpOwo+IEBAIC04MDcxLDkgKzgwNzEsOSBA
QCBzdGF0aWMgdm9pZCB2YWxsZXl2aWV3X2VuYWJsZV9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ICAgCURSTV9ERUJVR19EUklWRVIoIkdQTEwgZW5hYmxlZD8gJXNcbiIs
IHllc25vKHZhbCAmIEdQTExFTkFCTEUpKTsKPiAgIAlEUk1fREVCVUdfRFJJVkVSKCJHUFUgc3Rh
dHVzOiAweCUwOHhcbiIsIHZhbCk7Cj4gICAKPiAtCXJlc2V0X3JwcyhkZXZfcHJpdiwgdmFsbGV5
dmlld19zZXRfcnBzKTsKPiArCXJlc2V0X3JwcyhpOTE1LCB2YWxsZXl2aWV3X3NldF9ycHMpOwo+
ICAgCj4gLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9S
Q0VXQUtFX0FMTCk7Cj4gKwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmaTkxNS0+dW5jb3Jl
LCBGT1JDRVdBS0VfQUxMKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHVuc2lnbmVkIGxvbmcgaW50
ZWxfcHhmcmVxKHUzMiB2aWRmcmVxKQo+IEBAIC04MTA1LDcgKzgxMDUsNyBAQCBzdGF0aWMgY29u
c3Qgc3RydWN0IGNwYXJhbXMgewo+ICAgCXsgMCwgODAwLCAyMzEsIDIzNzg0IH0sCj4gICB9Owo+
ICAgCj4gLXN0YXRpYyB1bnNpZ25lZCBsb25nIF9faTkxNV9jaGlwc2V0X3ZhbChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB1bnNpZ25lZCBsb25nIF9faTkxNV9j
aGlwc2V0X3ZhbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAl1NjQg
dG90YWxfY291bnQsIGRpZmYsIHJldDsKPiAgIAl1MzIgY291bnQxLCBjb3VudDIsIGNvdW50Mywg
bSA9IDAsIGMgPSAwOwo+IEBAIC04MTE0LDcgKzgxMTQsNyBAQCBzdGF0aWMgdW5zaWduZWQgbG9u
ZyBfX2k5MTVfY2hpcHNldF92YWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ICAgCj4gICAJbG9ja2RlcF9hc3NlcnRfaGVsZCgmbWNoZGV2X2xvY2spOwo+ICAgCj4gLQlkaWZm
MSA9IG5vdyAtIGRldl9wcml2LT5pcHMubGFzdF90aW1lMTsKPiArCWRpZmYxID0gbm93IC0gaTkx
NS0+aXBzLmxhc3RfdGltZTE7Cj4gICAKPiAgIAkvKiBQcmV2ZW50IGRpdmlzaW9uLWJ5LXplcm8g
aWYgd2UgYXJlIGFza2luZyB0b28gZmFzdC4KPiAgIAkgKiBBbHNvLCB3ZSBkb24ndCBnZXQgaW50
ZXJlc3RpbmcgcmVzdWx0cyBpZiB3ZSBhcmUgcG9sbGluZwo+IEBAIC04MTIyLDcgKzgxMjIsNyBA
QCBzdGF0aWMgdW5zaWduZWQgbG9uZyBfX2k5MTVfY2hpcHNldF92YWwoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCSAqIGluIHN1Y2ggY2FzZXMuCj4gICAJICovCj4gICAJ
aWYgKGRpZmYxIDw9IDEwKQo+IC0JCXJldHVybiBkZXZfcHJpdi0+aXBzLmNoaXBzZXRfcG93ZXI7
Cj4gKwkJcmV0dXJuIGk5MTUtPmlwcy5jaGlwc2V0X3Bvd2VyOwo+ICAgCj4gICAJY291bnQxID0g
STkxNV9SRUFEKERNSUVDKTsKPiAgIAljb3VudDIgPSBJOTE1X1JFQUQoRERSRUMpOwo+IEBAIC04
MTMxLDE2ICs4MTMxLDE2IEBAIHN0YXRpYyB1bnNpZ25lZCBsb25nIF9faTkxNV9jaGlwc2V0X3Zh
bChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJdG90YWxfY291bnQgPSBj
b3VudDEgKyBjb3VudDIgKyBjb3VudDM7Cj4gICAKPiAgIAkvKiBGSVhNRTogaGFuZGxlIHBlci1j
b3VudGVyIG92ZXJmbG93ICovCj4gLQlpZiAodG90YWxfY291bnQgPCBkZXZfcHJpdi0+aXBzLmxh
c3RfY291bnQxKSB7Cj4gLQkJZGlmZiA9IH4wVUwgLSBkZXZfcHJpdi0+aXBzLmxhc3RfY291bnQx
Owo+ICsJaWYgKHRvdGFsX2NvdW50IDwgaTkxNS0+aXBzLmxhc3RfY291bnQxKSB7Cj4gKwkJZGlm
ZiA9IH4wVUwgLSBpOTE1LT5pcHMubGFzdF9jb3VudDE7Cj4gICAJCWRpZmYgKz0gdG90YWxfY291
bnQ7Cj4gICAJfSBlbHNlIHsKPiAtCQlkaWZmID0gdG90YWxfY291bnQgLSBkZXZfcHJpdi0+aXBz
Lmxhc3RfY291bnQxOwo+ICsJCWRpZmYgPSB0b3RhbF9jb3VudCAtIGk5MTUtPmlwcy5sYXN0X2Nv
dW50MTsKPiAgIAl9Cj4gICAKPiAgIAlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShjcGFyYW1z
KTsgaSsrKSB7Cj4gLQkJaWYgKGNwYXJhbXNbaV0uaSA9PSBkZXZfcHJpdi0+aXBzLmNfbSAmJgo+
IC0JCSAgICBjcGFyYW1zW2ldLnQgPT0gZGV2X3ByaXYtPmlwcy5yX3QpIHsKPiArCQlpZiAoY3Bh
cmFtc1tpXS5pID09IGk5MTUtPmlwcy5jX20gJiYKPiArCQkgICAgY3BhcmFtc1tpXS50ID09IGk5
MTUtPmlwcy5yX3QpIHsKPiAgIAkJCW0gPSBjcGFyYW1zW2ldLm07Cj4gICAJCQljID0gY3BhcmFt
c1tpXS5jOwo+ICAgCQkJYnJlYWs7Cj4gQEAgLTgxNTEsMjUgKzgxNTEsMjUgQEAgc3RhdGljIHVu
c2lnbmVkIGxvbmcgX19pOTE1X2NoaXBzZXRfdmFsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiAgIAlyZXQgPSAoKG0gKiBkaWZmKSArIGMpOwo+ICAgCXJldCA9IGRpdl91NjQo
cmV0LCAxMCk7Cj4gICAKPiAtCWRldl9wcml2LT5pcHMubGFzdF9jb3VudDEgPSB0b3RhbF9jb3Vu
dDsKPiAtCWRldl9wcml2LT5pcHMubGFzdF90aW1lMSA9IG5vdzsKPiArCWk5MTUtPmlwcy5sYXN0
X2NvdW50MSA9IHRvdGFsX2NvdW50Owo+ICsJaTkxNS0+aXBzLmxhc3RfdGltZTEgPSBub3c7Cj4g
ICAKPiAtCWRldl9wcml2LT5pcHMuY2hpcHNldF9wb3dlciA9IHJldDsKPiArCWk5MTUtPmlwcy5j
aGlwc2V0X3Bvd2VyID0gcmV0Owo+ICAgCj4gICAJcmV0dXJuIHJldDsKPiAgIH0KPiAgIAo+IC11
bnNpZ25lZCBsb25nIGk5MTVfY2hpcHNldF92YWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ICt1bnNpZ25lZCBsb25nIGk5MTVfY2hpcHNldF92YWwoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gICAJ
dW5zaWduZWQgbG9uZyB2YWwgPSAwOwo+ICAgCj4gLQlpZiAoIUlTX0dFTihkZXZfcHJpdiwgNSkp
Cj4gKwlpZiAoIUlTX0dFTihpOTE1LCA1KSkKPiAgIAkJcmV0dXJuIDA7Cj4gICAKPiAtCXdpdGhf
aW50ZWxfcnVudGltZV9wbShkZXZfcHJpdiwgd2FrZXJlZikgewo+ICsJd2l0aF9pbnRlbF9ydW50
aW1lX3BtKGk5MTUsIHdha2VyZWYpIHsKPiAgIAkJc3Bpbl9sb2NrX2lycSgmbWNoZGV2X2xvY2sp
Owo+IC0JCXZhbCA9IF9faTkxNV9jaGlwc2V0X3ZhbChkZXZfcHJpdik7Cj4gKwkJdmFsID0gX19p
OTE1X2NoaXBzZXRfdmFsKGk5MTUpOwo+ICAgCQlzcGluX3VubG9ja19pcnEoJm1jaGRldl9sb2Nr
KTsKPiAgIAl9Cj4gICAKPiBAQCAtODIwMiwxOCArODIwMiwxOCBAQCBzdGF0aWMgaW50IF9weHZp
ZF90b192ZCh1OCBweHZpZCkKPiAgIAlyZXR1cm4gKHB4dmlkICsgMikgKiAxMjU7Cj4gICB9Cj4g
ICAKPiAtc3RhdGljIHUzMiBwdmlkX3RvX2V4dHZpZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsIHU4IHB4dmlkKQo+ICtzdGF0aWMgdTMyIHB2aWRfdG9fZXh0dmlkKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LCB1OCBweHZpZCkKPiAgIHsKPiAgIAljb25zdCBpbnQgdmQg
PSBfcHh2aWRfdG9fdmQocHh2aWQpOwo+ICAgCWNvbnN0IGludCB2bSA9IHZkIC0gMTEyNTsKPiAg
IAo+IC0JaWYgKElOVEVMX0lORk8oZGV2X3ByaXYpLT5pc19tb2JpbGUpCj4gKwlpZiAoSU5URUxf
SU5GTyhpOTE1KS0+aXNfbW9iaWxlKQo+ICAgCQlyZXR1cm4gdm0gPiAwID8gdm0gOiAwOwo+ICAg
Cj4gICAJcmV0dXJuIHZkOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIF9faTkxNV91cGRhdGVf
Z2Z4X3ZhbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lk
IF9faTkxNV91cGRhdGVfZ2Z4X3ZhbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAg
IHsKPiAgIAl1NjQgbm93LCBkaWZmLCBkaWZmbXM7Cj4gICAJdTMyIGNvdW50Owo+IEBAIC04MjIx
LDcgKzgyMjEsNyBAQCBzdGF0aWMgdm9pZCBfX2k5MTVfdXBkYXRlX2dmeF92YWwoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJm1jaGRl
dl9sb2NrKTsKPiAgIAo+ICAgCW5vdyA9IGt0aW1lX2dldF9yYXdfbnMoKTsKPiAtCWRpZmZtcyA9
IG5vdyAtIGRldl9wcml2LT5pcHMubGFzdF90aW1lMjsKPiArCWRpZmZtcyA9IG5vdyAtIGk5MTUt
Pmlwcy5sYXN0X3RpbWUyOwo+ICAgCWRvX2RpdihkaWZmbXMsIE5TRUNfUEVSX01TRUMpOwo+ICAg
Cj4gICAJLyogRG9uJ3QgZGl2aWRlIGJ5IDAgKi8KPiBAQCAtODIzMCw1MCArODIzMCw1MCBAQCBz
dGF0aWMgdm9pZCBfX2k5MTVfdXBkYXRlX2dmeF92YWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICAgCj4gICAJY291bnQgPSBJOTE1X1JFQUQoR0ZYRUMpOwo+ICAgCj4gLQlp
ZiAoY291bnQgPCBkZXZfcHJpdi0+aXBzLmxhc3RfY291bnQyKSB7Cj4gLQkJZGlmZiA9IH4wVUwg
LSBkZXZfcHJpdi0+aXBzLmxhc3RfY291bnQyOwo+ICsJaWYgKGNvdW50IDwgaTkxNS0+aXBzLmxh
c3RfY291bnQyKSB7Cj4gKwkJZGlmZiA9IH4wVUwgLSBpOTE1LT5pcHMubGFzdF9jb3VudDI7Cj4g
ICAJCWRpZmYgKz0gY291bnQ7Cj4gICAJfSBlbHNlIHsKPiAtCQlkaWZmID0gY291bnQgLSBkZXZf
cHJpdi0+aXBzLmxhc3RfY291bnQyOwo+ICsJCWRpZmYgPSBjb3VudCAtIGk5MTUtPmlwcy5sYXN0
X2NvdW50MjsKPiAgIAl9Cj4gICAKPiAtCWRldl9wcml2LT5pcHMubGFzdF9jb3VudDIgPSBjb3Vu
dDsKPiAtCWRldl9wcml2LT5pcHMubGFzdF90aW1lMiA9IG5vdzsKPiArCWk5MTUtPmlwcy5sYXN0
X2NvdW50MiA9IGNvdW50Owo+ICsJaTkxNS0+aXBzLmxhc3RfdGltZTIgPSBub3c7Cj4gICAKPiAg
IAkvKiBNb3JlIG1hZ2ljIGNvbnN0YW50cy4uLiAqLwo+ICAgCWRpZmYgPSBkaWZmICogMTE4MTsK
PiAgIAlkaWZmID0gZGl2X3U2NChkaWZmLCBkaWZmbXMgKiAxMCk7Cj4gLQlkZXZfcHJpdi0+aXBz
LmdmeF9wb3dlciA9IGRpZmY7Cj4gKwlpOTE1LT5pcHMuZ2Z4X3Bvd2VyID0gZGlmZjsKPiAgIH0K
PiAgIAo+IC12b2lkIGk5MTVfdXBkYXRlX2dmeF92YWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICt2b2lkIGk5MTVfdXBkYXRlX2dmeF92YWwoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gICAKPiAt
CWlmICghSVNfR0VOKGRldl9wcml2LCA1KSkKPiArCWlmICghSVNfR0VOKGk5MTUsIDUpKQo+ICAg
CQlyZXR1cm47Cj4gICAKPiAtCXdpdGhfaW50ZWxfcnVudGltZV9wbShkZXZfcHJpdiwgd2FrZXJl
Zikgewo+ICsJd2l0aF9pbnRlbF9ydW50aW1lX3BtKGk5MTUsIHdha2VyZWYpIHsKPiAgIAkJc3Bp
bl9sb2NrX2lycSgmbWNoZGV2X2xvY2spOwo+IC0JCV9faTkxNV91cGRhdGVfZ2Z4X3ZhbChkZXZf
cHJpdik7Cj4gKwkJX19pOTE1X3VwZGF0ZV9nZnhfdmFsKGk5MTUpOwo+ICAgCQlzcGluX3VubG9j
a19pcnEoJm1jaGRldl9sb2NrKTsKPiAgIAl9Cj4gICB9Cj4gICAKPiAtc3RhdGljIHVuc2lnbmVk
IGxvbmcgX19pOTE1X2dmeF92YWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ICtzdGF0aWMgdW5zaWduZWQgbG9uZyBfX2k5MTVfZ2Z4X3ZhbChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAl1bnNpZ25lZCBsb25nIHQsIGNvcnIsIHN0YXRlMSwgY29y
cjIsIHN0YXRlMjsKPiAgIAl1MzIgcHh2aWQsIGV4dF92Owo+ICAgCj4gICAJbG9ja2RlcF9hc3Nl
cnRfaGVsZCgmbWNoZGV2X2xvY2spOwo+ICAgCj4gLQlweHZpZCA9IEk5MTVfUkVBRChQWFZGUkVR
KGRldl9wcml2LT5ndF9wbS5ycHMuY3VyX2ZyZXEpKTsKPiArCXB4dmlkID0gSTkxNV9SRUFEKFBY
VkZSRVEoaTkxNS0+Z3RfcG0ucnBzLmN1cl9mcmVxKSk7Cj4gICAJcHh2aWQgPSAocHh2aWQgPj4g
MjQpICYgMHg3ZjsKPiAtCWV4dF92ID0gcHZpZF90b19leHR2aWQoZGV2X3ByaXYsIHB4dmlkKTsK
PiArCWV4dF92ID0gcHZpZF90b19leHR2aWQoaTkxNSwgcHh2aWQpOwo+ICAgCj4gICAJc3RhdGUx
ID0gZXh0X3Y7Cj4gICAKPiAtCXQgPSBpOTE1X21jaF92YWwoZGV2X3ByaXYpOwo+ICsJdCA9IGk5
MTVfbWNoX3ZhbChpOTE1KTsKPiAgIAo+ICAgCS8qIFJldmVsIGluIHRoZSBlbXBpcmljYWxseSBk
ZXJpdmVkIGNvbnN0YW50cyAqLwo+ICAgCj4gQEAgLTgyODcsMjcgKzgyODcsMjcgQEAgc3RhdGlj
IHVuc2lnbmVkIGxvbmcgX19pOTE1X2dmeF92YWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ICAgCj4gICAJY29yciA9IGNvcnIgKiAoKDE1MDE0MiAqIHN0YXRlMSkgLyAxMDAw
MCAtIDc4NjQyKTsKPiAgIAljb3JyIC89IDEwMDAwMDsKPiAtCWNvcnIyID0gKGNvcnIgKiBkZXZf
cHJpdi0+aXBzLmNvcnIpOwo+ICsJY29ycjIgPSAoY29yciAqIGk5MTUtPmlwcy5jb3JyKTsKPiAg
IAo+ICAgCXN0YXRlMiA9IChjb3JyMiAqIHN0YXRlMSkgLyAxMDAwMDsKPiAgIAlzdGF0ZTIgLz0g
MTAwOyAvKiBjb252ZXJ0IHRvIG1XICovCj4gICAKPiAtCV9faTkxNV91cGRhdGVfZ2Z4X3ZhbChk
ZXZfcHJpdik7Cj4gKwlfX2k5MTVfdXBkYXRlX2dmeF92YWwoaTkxNSk7Cj4gICAKPiAtCXJldHVy
biBkZXZfcHJpdi0+aXBzLmdmeF9wb3dlciArIHN0YXRlMjsKPiArCXJldHVybiBpOTE1LT5pcHMu
Z2Z4X3Bvd2VyICsgc3RhdGUyOwo+ICAgfQo+ICAgCj4gLXVuc2lnbmVkIGxvbmcgaTkxNV9nZnhf
dmFsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdW5zaWduZWQgbG9uZyBp
OTE1X2dmeF92YWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJaW50
ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gICAJdW5zaWduZWQgbG9uZyB2YWwgPSAwOwo+ICAgCj4g
LQlpZiAoIUlTX0dFTihkZXZfcHJpdiwgNSkpCj4gKwlpZiAoIUlTX0dFTihpOTE1LCA1KSkKPiAg
IAkJcmV0dXJuIDA7Cj4gICAKPiAtCXdpdGhfaW50ZWxfcnVudGltZV9wbShkZXZfcHJpdiwgd2Fr
ZXJlZikgewo+ICsJd2l0aF9pbnRlbF9ydW50aW1lX3BtKGk5MTUsIHdha2VyZWYpIHsKPiAgIAkJ
c3Bpbl9sb2NrX2lycSgmbWNoZGV2X2xvY2spOwo+IC0JCXZhbCA9IF9faTkxNV9nZnhfdmFsKGRl
dl9wcml2KTsKPiArCQl2YWwgPSBfX2k5MTVfZ2Z4X3ZhbChpOTE1KTsKPiAgIAkJc3Bpbl91bmxv
Y2tfaXJxKCZtY2hkZXZfbG9jayk7Cj4gICAJfQo+ICAgCj4gQEAgLTg0NzEsMTEgKzg0NzEsMTEg
QEAgaXBzX3BpbmdfZm9yX2k5MTVfbG9hZCh2b2lkKQo+ICAgCX0KPiAgIH0KPiAgIAo+IC12b2lk
IGludGVsX2dwdV9pcHNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
K3ZvaWQgaW50ZWxfZ3B1X2lwc19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ICAgewo+ICAgCS8qIFdlIG9ubHkgcmVnaXN0ZXIgdGhlIGk5MTUgaXBzIHBhcnQgd2l0aCBpbnRl
bC1pcHMgb25jZSBldmVyeXRoaW5nIGlzCj4gICAJICogc2V0IHVwLCB0byBhdm9pZCBpbnRlbC1p
cHMgc25lYWtpbmcgaW4gYW5kIHJlYWRpbmcgYm9ndXMgdmFsdWVzLiAqLwo+IC0JcmN1X2Fzc2ln
bl9wb2ludGVyKGk5MTVfbWNoX2RldiwgZGV2X3ByaXYpOwo+ICsJcmN1X2Fzc2lnbl9wb2ludGVy
KGk5MTVfbWNoX2RldiwgaTkxNSk7Cj4gICAKPiAgIAlpcHNfcGluZ19mb3JfaTkxNV9sb2FkKCk7
Cj4gICB9Cj4gQEAgLTg0ODUsNyArODQ4NSw3IEBAIHZvaWQgaW50ZWxfZ3B1X2lwc190ZWFyZG93
bih2b2lkKQo+ICAgCXJjdV9hc3NpZ25fcG9pbnRlcihpOTE1X21jaF9kZXYsIE5VTEwpOwo+ICAg
fQo+ICAgCj4gLXN0YXRpYyB2b2lkIGludGVsX2luaXRfZW1vbihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGludGVsX2luaXRfZW1vbihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAl1MzIgbGNmdXNlOwo+ICAgCXU4IHB4d1sx
Nl07Cj4gQEAgLTg1NTIsNDAgKzg1NTIsNDAgQEAgc3RhdGljIHZvaWQgaW50ZWxfaW5pdF9lbW9u
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAo+ICAgCWxjZnVzZSA9IEk5
MTVfUkVBRChMQ0ZVU0UwMik7Cj4gICAKPiAtCWRldl9wcml2LT5pcHMuY29yciA9IChsY2Z1c2Ug
JiBMQ0ZVU0VfSElWX01BU0spOwo+ICsJaTkxNS0+aXBzLmNvcnIgPSAobGNmdXNlICYgTENGVVNF
X0hJVl9NQVNLKTsKPiAgIH0KPiAgIAo+IC12b2lkIGludGVsX2luaXRfZ3RfcG93ZXJzYXZlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBpbnRlbF9pbml0X2d0X3Bv
d2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVjdCBp
bnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwo+ICsJc3RydWN0IGludGVsX3Jw
cyAqcnBzID0gJmk5MTUtPmd0X3BtLnJwczsKPiAgIAo+ICAgCS8qCj4gICAJICogUlBNIGRlcGVu
ZHMgb24gUkM2IHRvIHNhdmUgcmVzdG9yZSB0aGUgR1QgSFcgY29udGV4dCwgc28gbWFrZSBSQzYg
YQo+ICAgCSAqIHJlcXVpcmVtZW50Lgo+ICAgCSAqLwo+IC0JaWYgKCFzYW5pdGl6ZV9yYzYoZGV2
X3ByaXYpKSB7Cj4gKwlpZiAoIXNhbml0aXplX3JjNihpOTE1KSkgewo+ICAgCQlEUk1fSU5GTygi
UkM2IGRpc2FibGVkLCBkaXNhYmxpbmcgcnVudGltZSBQTSBzdXBwb3J0XG4iKTsKPiAtCQlwbV9y
dW50aW1lX2dldCgmZGV2X3ByaXYtPmRybS5wZGV2LT5kZXYpOwo+ICsJCXBtX3J1bnRpbWVfZ2V0
KCZpOTE1LT5kcm0ucGRldi0+ZGV2KTsKPiAgIAl9Cj4gICAKPiAgIAkvKiBJbml0aWFsaXplIFJQ
UyBsaW1pdHMgKGZvciB1c2Vyc3BhY2UpICovCj4gLQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJp
dikpCj4gLQkJY2hlcnJ5dmlld19pbml0X2d0X3Bvd2Vyc2F2ZShkZXZfcHJpdik7Cj4gLQllbHNl
IGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkKPiAtCQl2YWxsZXl2aWV3X2luaXRfZ3RfcG93
ZXJzYXZlKGRldl9wcml2KTsKPiAtCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNikK
PiAtCQlnZW42X2luaXRfcnBzX2ZyZXF1ZW5jaWVzKGRldl9wcml2KTsKPiArCWlmIChJU19DSEVS
UllWSUVXKGk5MTUpKQo+ICsJCWNoZXJyeXZpZXdfaW5pdF9ndF9wb3dlcnNhdmUoaTkxNSk7Cj4g
KwllbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpKQo+ICsJCXZhbGxleXZpZXdfaW5pdF9ndF9w
b3dlcnNhdmUoaTkxNSk7Cj4gKwllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNikKPiArCQln
ZW42X2luaXRfcnBzX2ZyZXF1ZW5jaWVzKGk5MTUpOwo+ICAgCj4gICAJLyogRGVyaXZlIGluaXRp
YWwgdXNlciBwcmVmZXJlbmNlcy9saW1pdHMgZnJvbSB0aGUgaGFyZHdhcmUgbGltaXRzICovCj4g
ICAJcnBzLT5tYXhfZnJlcV9zb2Z0bGltaXQgPSBycHMtPm1heF9mcmVxOwo+ICAgCXJwcy0+bWlu
X2ZyZXFfc29mdGxpbWl0ID0gcnBzLT5taW5fZnJlcTsKPiAgIAo+ICAgCS8qIEFmdGVyIHNldHRp
bmcgbWF4LXNvZnRsaW1pdCwgZmluZCB0aGUgb3ZlcmNsb2NrIG1heCBmcmVxICovCj4gLQlpZiAo
SVNfR0VOKGRldl9wcml2LCA2KSB8fAo+IC0JICAgIElTX0lWWUJSSURHRShkZXZfcHJpdikgfHwg
SVNfSEFTV0VMTChkZXZfcHJpdikpIHsKPiArCWlmIChJU19HRU4oaTkxNSwgNikgfHwKPiArCSAg
ICBJU19JVllCUklER0UoaTkxNSkgfHwgSVNfSEFTV0VMTChpOTE1KSkgewo+ICAgCQl1MzIgcGFy
YW1zID0gMDsKPiAgIAo+IC0JCXNhbmR5YnJpZGdlX3Bjb2RlX3JlYWQoZGV2X3ByaXYsIEdFTjZf
UkVBRF9PQ19QQVJBTVMsCj4gKwkJc2FuZHlicmlkZ2VfcGNvZGVfcmVhZChpOTE1LCBHRU42X1JF
QURfT0NfUEFSQU1TLAo+ICAgCQkJCSAgICAgICAmcGFyYW1zLCBOVUxMKTsKPiAgIAkJaWYgKHBh
cmFtcyAmIEJJVCgzMSkpIHsgLyogT0Mgc3VwcG9ydGVkICovCj4gICAJCQlEUk1fREVCVUdfRFJJ
VkVSKCJPdmVyY2xvY2tpbmcgc3VwcG9ydGVkLCBtYXg6ICVkTUh6LCBvdmVyY2xvY2s6ICVkTUh6
XG4iLAo+IEBAIC04NjAxLDI1ICs4NjAxLDI1IEBAIHZvaWQgaW50ZWxfaW5pdF9ndF9wb3dlcnNh
dmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCXJwcy0+Y3VyX2ZyZXEg
PSBycHMtPmlkbGVfZnJlcTsKPiAgIH0KPiAgIAo+IC12b2lkIGludGVsX2NsZWFudXBfZ3RfcG93
ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArdm9pZCBpbnRlbF9j
bGVhbnVwX2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsK
PiAtCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkKPiAtCQl2YWxsZXl2aWV3X2NsZWFudXBf
Z3RfcG93ZXJzYXZlKGRldl9wcml2KTsKPiArCWlmIChJU19WQUxMRVlWSUVXKGk5MTUpKQo+ICsJ
CXZhbGxleXZpZXdfY2xlYW51cF9ndF9wb3dlcnNhdmUoaTkxNSk7Cj4gICAKPiAtCWlmICghSEFT
X1JDNihkZXZfcHJpdikpCj4gLQkJcG1fcnVudGltZV9wdXQoJmRldl9wcml2LT5kcm0ucGRldi0+
ZGV2KTsKPiArCWlmICghSEFTX1JDNihpOTE1KSkKPiArCQlwbV9ydW50aW1lX3B1dCgmaTkxNS0+
ZHJtLnBkZXYtPmRldik7Cj4gICB9Cj4gICAKPiAtdm9pZCBpbnRlbF9zYW5pdGl6ZV9ndF9wb3dl
cnNhdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGludGVsX3Nh
bml0aXplX2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsK
PiAtCWRldl9wcml2LT5ndF9wbS5ycHMuZW5hYmxlZCA9IHRydWU7IC8qIGZvcmNlIFJQUyBkaXNh
YmxpbmcgKi8KPiAtCWRldl9wcml2LT5ndF9wbS5yYzYuZW5hYmxlZCA9IHRydWU7IC8qIGZvcmNl
IFJDNiBkaXNhYmxpbmcgKi8KPiAtCWludGVsX2Rpc2FibGVfZ3RfcG93ZXJzYXZlKGRldl9wcml2
KTsKPiArCWk5MTUtPmd0X3BtLnJwcy5lbmFibGVkID0gdHJ1ZTsgLyogZm9yY2UgUlBTIGRpc2Fi
bGluZyAqLwo+ICsJaTkxNS0+Z3RfcG0ucmM2LmVuYWJsZWQgPSB0cnVlOyAvKiBmb3JjZSBSQzYg
ZGlzYWJsaW5nICovCj4gKwlpbnRlbF9kaXNhYmxlX2d0X3Bvd2Vyc2F2ZShpOTE1KTsKPiAgIAo+
IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCj4gLQkJZ2VuMTFfcmVzZXRfcnBzX2lu
dGVycnVwdHMoZGV2X3ByaXYpOwo+IC0JZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA2
KQo+IC0JCWdlbjZfcmVzZXRfcnBzX2ludGVycnVwdHMoZGV2X3ByaXYpOwo+ICsJaWYgKElOVEVM
X0dFTihpOTE1KSA+PSAxMSkKPiArCQlnZW4xMV9yZXNldF9ycHNfaW50ZXJydXB0cyhpOTE1KTsK
PiArCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA2KQo+ICsJCWdlbjZfcmVzZXRfcnBzX2lu
dGVycnVwdHMoaTkxNSk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9k
aXNhYmxlX2xsY19wc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gQEAgLTg2
MzQsNTYgKzg2MzQsNTYgQEAgc3RhdGljIGlubGluZSB2b2lkIGludGVsX2Rpc2FibGVfbGxjX3Bz
dGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIAlpOTE1LT5ndF9wbS5sbGNf
cHN0YXRlLmVuYWJsZWQgPSBmYWxzZTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpbnRlbF9k
aXNhYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2
b2lkIGludGVsX2Rpc2FibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAg
ewo+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPmd0X3BtLnJwcy5sb2NrKTsKPiAr
CWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmd0X3BtLnJwcy5sb2NrKTsKPiAgIAo+IC0JaWYg
KCFkZXZfcHJpdi0+Z3RfcG0ucmM2LmVuYWJsZWQpCj4gKwlpZiAoIWk5MTUtPmd0X3BtLnJjNi5l
bmFibGVkKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDkpCj4gLQkJZ2VuOV9kaXNhYmxlX3JjNihkZXZfcHJpdik7Cj4gLQllbHNlIGlmIChJU19DSEVS
UllWSUVXKGRldl9wcml2KSkKPiAtCQljaGVycnl2aWV3X2Rpc2FibGVfcmM2KGRldl9wcml2KTsK
PiAtCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpKQo+IC0JCXZhbGxleXZpZXdfZGlz
YWJsZV9yYzYoZGV2X3ByaXYpOwo+IC0JZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA2
KQo+IC0JCWdlbjZfZGlzYWJsZV9yYzYoZGV2X3ByaXYpOwo+ICsJaWYgKElOVEVMX0dFTihpOTE1
KSA+PSA5KQo+ICsJCWdlbjlfZGlzYWJsZV9yYzYoaTkxNSk7Cj4gKwllbHNlIGlmIChJU19DSEVS
UllWSUVXKGk5MTUpKQo+ICsJCWNoZXJyeXZpZXdfZGlzYWJsZV9yYzYoaTkxNSk7Cj4gKwllbHNl
IGlmIChJU19WQUxMRVlWSUVXKGk5MTUpKQo+ICsJCXZhbGxleXZpZXdfZGlzYWJsZV9yYzYoaTkx
NSk7Cj4gKwllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNikKPiArCQlnZW42X2Rpc2FibGVf
cmM2KGk5MTUpOwo+ICAgCj4gLQlkZXZfcHJpdi0+Z3RfcG0ucmM2LmVuYWJsZWQgPSBmYWxzZTsK
PiArCWk5MTUtPmd0X3BtLnJjNi5lbmFibGVkID0gZmFsc2U7Cj4gICB9Cj4gICAKPiAtc3RhdGlj
IHZvaWQgaW50ZWxfZGlzYWJsZV9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ICtzdGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxlX3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKPiAgIHsKPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5ndF9wbS5y
cHMubG9jayk7Cj4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5ndF9wbS5ycHMubG9jayk7
Cj4gICAKPiAtCWlmICghZGV2X3ByaXYtPmd0X3BtLnJwcy5lbmFibGVkKQo+ICsJaWYgKCFpOTE1
LT5ndF9wbS5ycHMuZW5hYmxlZCkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSA5KQo+IC0JCWdlbjlfZGlzYWJsZV9ycHMoZGV2X3ByaXYpOwo+IC0JZWxz
ZSBpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gLQkJY2hlcnJ5dmlld19kaXNhYmxlX3Jw
cyhkZXZfcHJpdik7Cj4gLQllbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkKPiAtCQl2
YWxsZXl2aWV3X2Rpc2FibGVfcnBzKGRldl9wcml2KTsKPiAtCWVsc2UgaWYgKElOVEVMX0dFTihk
ZXZfcHJpdikgPj0gNikKPiAtCQlnZW42X2Rpc2FibGVfcnBzKGRldl9wcml2KTsKPiAtCWVsc2Ug
aWYgKElTX0lST05MQUtFX00oZGV2X3ByaXYpKQo+IC0JCWlyb25sYWtlX2Rpc2FibGVfZHJwcyhk
ZXZfcHJpdik7Cj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkpCj4gKwkJZ2VuOV9kaXNhYmxl
X3JwcyhpOTE1KTsKPiArCWVsc2UgaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gKwkJY2hlcnJ5
dmlld19kaXNhYmxlX3JwcyhpOTE1KTsKPiArCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkp
Cj4gKwkJdmFsbGV5dmlld19kaXNhYmxlX3JwcyhpOTE1KTsKPiArCWVsc2UgaWYgKElOVEVMX0dF
TihpOTE1KSA+PSA2KQo+ICsJCWdlbjZfZGlzYWJsZV9ycHMoaTkxNSk7Cj4gKwllbHNlIGlmIChJ
U19JUk9OTEFLRV9NKGk5MTUpKQo+ICsJCWlyb25sYWtlX2Rpc2FibGVfZHJwcyhpOTE1KTsKPiAg
IAo+IC0JZGV2X3ByaXYtPmd0X3BtLnJwcy5lbmFibGVkID0gZmFsc2U7Cj4gKwlpOTE1LT5ndF9w
bS5ycHMuZW5hYmxlZCA9IGZhbHNlOwo+ICAgfQo+ICAgCj4gLXZvaWQgaW50ZWxfZGlzYWJsZV9n
dF9wb3dlcnNhdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGlu
dGVsX2Rpc2FibGVfZ3RfcG93ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ICAgewo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmd0X3BtLnJwcy5sb2NrKTsKPiArCW11dGV4
X2xvY2soJmk5MTUtPmd0X3BtLnJwcy5sb2NrKTsKPiAgIAo+IC0JaW50ZWxfZGlzYWJsZV9yYzYo
ZGV2X3ByaXYpOwo+IC0JaW50ZWxfZGlzYWJsZV9ycHMoZGV2X3ByaXYpOwo+IC0JaWYgKEhBU19M
TEMoZGV2X3ByaXYpKQo+IC0JCWludGVsX2Rpc2FibGVfbGxjX3BzdGF0ZShkZXZfcHJpdik7Cj4g
KwlpbnRlbF9kaXNhYmxlX3JjNihpOTE1KTsKPiArCWludGVsX2Rpc2FibGVfcnBzKGk5MTUpOwo+
ICsJaWYgKEhBU19MTEMoaTkxNSkpCj4gKwkJaW50ZWxfZGlzYWJsZV9sbGNfcHN0YXRlKGk5MTUp
Owo+ICAgCj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5ndF9wbS5ycHMubG9jayk7Cj4gKwlt
dXRleF91bmxvY2soJmk5MTUtPmd0X3BtLnJwcy5sb2NrKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGlj
IGlubGluZSB2b2lkIGludGVsX2VuYWJsZV9sbGNfcHN0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+IEBAIC04Njk4LDUxICs4Njk4LDUxIEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBp
bnRlbF9lbmFibGVfbGxjX3BzdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAg
IAlpOTE1LT5ndF9wbS5sbGNfcHN0YXRlLmVuYWJsZWQgPSB0cnVlOwo+ICAgfQo+ICAgCj4gLXN0
YXRpYyB2b2lkIGludGVsX2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICtzdGF0aWMgdm9pZCBpbnRlbF9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ICAgewo+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPmd0X3Bt
LnJwcy5sb2NrKTsKPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmd0X3BtLnJwcy5sb2Nr
KTsKPiAgIAo+IC0JaWYgKGRldl9wcml2LT5ndF9wbS5yYzYuZW5hYmxlZCkKPiArCWlmIChpOTE1
LT5ndF9wbS5yYzYuZW5hYmxlZCkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQlpZiAoSVNfQ0hFUlJZ
VklFVyhkZXZfcHJpdikpCj4gLQkJY2hlcnJ5dmlld19lbmFibGVfcmM2KGRldl9wcml2KTsKPiAt
CWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpKQo+IC0JCXZhbGxleXZpZXdfZW5hYmxl
X3JjNihkZXZfcHJpdik7Cj4gLQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQo+
IC0JCWdlbjExX2VuYWJsZV9yYzYoZGV2X3ByaXYpOwo+IC0JZWxzZSBpZiAoSU5URUxfR0VOKGRl
dl9wcml2KSA+PSA5KQo+IC0JCWdlbjlfZW5hYmxlX3JjNihkZXZfcHJpdik7Cj4gLQllbHNlIGlm
IChJU19CUk9BRFdFTEwoZGV2X3ByaXYpKQo+IC0JCWdlbjhfZW5hYmxlX3JjNihkZXZfcHJpdik7
Cj4gLQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDYpCj4gLQkJZ2VuNl9lbmFibGVf
cmM2KGRldl9wcml2KTsKPiArCWlmIChJU19DSEVSUllWSUVXKGk5MTUpKQo+ICsJCWNoZXJyeXZp
ZXdfZW5hYmxlX3JjNihpOTE1KTsKPiArCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkpCj4g
KwkJdmFsbGV5dmlld19lbmFibGVfcmM2KGk5MTUpOwo+ICsJZWxzZSBpZiAoSU5URUxfR0VOKGk5
MTUpID49IDExKQo+ICsJCWdlbjExX2VuYWJsZV9yYzYoaTkxNSk7Cj4gKwllbHNlIGlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gOSkKPiArCQlnZW45X2VuYWJsZV9yYzYoaTkxNSk7Cj4gKwllbHNlIGlm
IChJU19CUk9BRFdFTEwoaTkxNSkpCj4gKwkJZ2VuOF9lbmFibGVfcmM2KGk5MTUpOwo+ICsJZWxz
ZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDYpCj4gKwkJZ2VuNl9lbmFibGVfcmM2KGk5MTUpOwo+
ICAgCj4gLQlkZXZfcHJpdi0+Z3RfcG0ucmM2LmVuYWJsZWQgPSB0cnVlOwo+ICsJaTkxNS0+Z3Rf
cG0ucmM2LmVuYWJsZWQgPSB0cnVlOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGludGVsX2Vu
YWJsZV9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9p
ZCBpbnRlbF9lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+
IC0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Cj4gKwlzdHJ1
Y3QgaW50ZWxfcnBzICpycHMgPSAmaTkxNS0+Z3RfcG0ucnBzOwo+ICAgCj4gICAJbG9ja2RlcF9h
c3NlcnRfaGVsZCgmcnBzLT5sb2NrKTsKPiAgIAo+ICAgCWlmIChycHMtPmVuYWJsZWQpCj4gICAJ
CXJldHVybjsKPiAgIAo+IC0JaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gLQkJY2hl
cnJ5dmlld19lbmFibGVfcnBzKGRldl9wcml2KTsKPiAtCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklF
VyhkZXZfcHJpdikpIHsKPiAtCQl2YWxsZXl2aWV3X2VuYWJsZV9ycHMoZGV2X3ByaXYpOwo+IC0J
fSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpIHsKPiAtCQlnZW45X2VuYWJsZV9y
cHMoZGV2X3ByaXYpOwo+IC0JfSBlbHNlIGlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYpKSB7Cj4g
LQkJZ2VuOF9lbmFibGVfcnBzKGRldl9wcml2KTsKPiAtCX0gZWxzZSBpZiAoSU5URUxfR0VOKGRl
dl9wcml2KSA+PSA2KSB7Cj4gLQkJZ2VuNl9lbmFibGVfcnBzKGRldl9wcml2KTsKPiAtCX0gZWxz
ZSBpZiAoSVNfSVJPTkxBS0VfTShkZXZfcHJpdikpIHsKPiAtCQlpcm9ubGFrZV9lbmFibGVfZHJw
cyhkZXZfcHJpdik7Cj4gLQkJaW50ZWxfaW5pdF9lbW9uKGRldl9wcml2KTsKPiArCWlmIChJU19D
SEVSUllWSUVXKGk5MTUpKSB7Cj4gKwkJY2hlcnJ5dmlld19lbmFibGVfcnBzKGk5MTUpOwo+ICsJ
fSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpKSB7Cj4gKwkJdmFsbGV5dmlld19lbmFibGVf
cnBzKGk5MTUpOwo+ICsJfSBlbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkgewo+ICsJCWdl
bjlfZW5hYmxlX3JwcyhpOTE1KTsKPiArCX0gZWxzZSBpZiAoSVNfQlJPQURXRUxMKGk5MTUpKSB7
Cj4gKwkJZ2VuOF9lbmFibGVfcnBzKGk5MTUpOwo+ICsJfSBlbHNlIGlmIChJTlRFTF9HRU4oaTkx
NSkgPj0gNikgewo+ICsJCWdlbjZfZW5hYmxlX3JwcyhpOTE1KTsKPiArCX0gZWxzZSBpZiAoSVNf
SVJPTkxBS0VfTShpOTE1KSkgewo+ICsJCWlyb25sYWtlX2VuYWJsZV9kcnBzKGk5MTUpOwo+ICsJ
CWludGVsX2luaXRfZW1vbihpOTE1KTsKPiAgIAl9Cj4gICAKPiAgIAlXQVJOX09OKHJwcy0+bWF4
X2ZyZXEgPCBycHMtPm1pbl9mcmVxKTsKPiBAQCAtODc1NCwyNSArODc1NCwyNSBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiAgIAlycHMtPmVuYWJsZWQgPSB0cnVlOwo+ICAgfQo+ICAgCj4gLXZvaWQgaW50ZWxfZW5hYmxl
X2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3ZvaWQg
aW50ZWxfZW5hYmxlX2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiAgIHsKPiAgIAkvKiBQb3dlcnNhdmluZyBpcyBjb250cm9sbGVkIGJ5IHRoZSBob3N0IHdoZW4g
aW5zaWRlIGEgVk0gKi8KPiAtCWlmIChpbnRlbF92Z3B1X2FjdGl2ZShkZXZfcHJpdikpCj4gKwlp
ZiAoaW50ZWxfdmdwdV9hY3RpdmUoaTkxNSkpCj4gICAJCXJldHVybjsKPiAgIAo+IC0JbXV0ZXhf
bG9jaygmZGV2X3ByaXYtPmd0X3BtLnJwcy5sb2NrKTsKPiArCW11dGV4X2xvY2soJmk5MTUtPmd0
X3BtLnJwcy5sb2NrKTsKPiAgIAo+IC0JaWYgKEhBU19SQzYoZGV2X3ByaXYpKQo+IC0JCWludGVs
X2VuYWJsZV9yYzYoZGV2X3ByaXYpOwo+IC0JaWYgKEhBU19SUFMoZGV2X3ByaXYpKQo+IC0JCWlu
dGVsX2VuYWJsZV9ycHMoZGV2X3ByaXYpOwo+IC0JaWYgKEhBU19MTEMoZGV2X3ByaXYpKQo+IC0J
CWludGVsX2VuYWJsZV9sbGNfcHN0YXRlKGRldl9wcml2KTsKPiArCWlmIChIQVNfUkM2KGk5MTUp
KQo+ICsJCWludGVsX2VuYWJsZV9yYzYoaTkxNSk7Cj4gKwlpZiAoSEFTX1JQUyhpOTE1KSkKPiAr
CQlpbnRlbF9lbmFibGVfcnBzKGk5MTUpOwo+ICsJaWYgKEhBU19MTEMoaTkxNSkpCj4gKwkJaW50
ZWxfZW5hYmxlX2xsY19wc3RhdGUoaTkxNSk7Cj4gICAKPiAtCW11dGV4X3VubG9jaygmZGV2X3By
aXYtPmd0X3BtLnJwcy5sb2NrKTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+Z3RfcG0ucnBzLmxv
Y2spOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGlieF9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGlieF9pbml0X2Ns
b2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAkvKgo+
ICAgCSAqIE9uIEliZXggUGVhayBhbmQgQ291Z2FyIFBvaW50LCB3ZSBuZWVkIHRvIGRpc2FibGUg
Y2xvY2sKPiBAQCAtODc4MiwxMSArODc4MiwxMSBAQCBzdGF0aWMgdm9pZCBpYnhfaW5pdF9jbG9j
a19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCUk5MTVfV1JJ
VEUoU09VVEhfRFNQQ0xLX0dBVEVfRCwgUENIX0RQTFNVTklUX0NMT0NLX0dBVEVfRElTQUJMRSk7
Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgZzR4X2Rpc2FibGVfdHJpY2tsZV9mZWVkKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgZzR4X2Rpc2FibGVf
dHJpY2tsZV9mZWVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCWVu
dW0gcGlwZSBwaXBlOwo+ICAgCj4gLQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKSB7Cj4g
Kwlmb3JfZWFjaF9waXBlKGk5MTUsIHBpcGUpIHsKPiAgIAkJSTkxNV9XUklURShEU1BDTlRSKHBp
cGUpLAo+ICAgCQkJICAgSTkxNV9SRUFEKERTUENOVFIocGlwZSkpIHwKPiAgIAkJCSAgIERJU1BQ
TEFORV9UUklDS0xFX0ZFRURfRElTQUJMRSk7Cj4gQEAgLTg3OTYsNyArODc5Niw3IEBAIHN0YXRp
YyB2b2lkIGc0eF9kaXNhYmxlX3RyaWNrbGVfZmVlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gICAJfQo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGlsa19pbml0X2Nsb2Nr
X2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lk
IGlsa19pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAg
IHsKPiAgIAl1MzIgZHNwY2xrX2dhdGUgPSBJTEtfVlJIVU5JVF9DTE9DS19HQVRFX0RJU0FCTEU7
Cj4gICAKPiBAQCAtODgzNiw3ICs4ODM2LDcgQEAgc3RhdGljIHZvaWQgaWxrX2luaXRfY2xvY2tf
Z2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkgKiBUaGUgYml0
IDIyIG9mIDB4NDIwMDQKPiAgIAkgKiBUaGUgYml0IDcsOCw5IG9mIDB4NDIwMjAuCj4gICAJICov
Cj4gLQlpZiAoSVNfSVJPTkxBS0VfTShkZXZfcHJpdikpIHsKPiArCWlmIChJU19JUk9OTEFLRV9N
KGk5MTUpKSB7Cj4gICAJCS8qIFdhRmJjQXN5bmNoRmxpcERpc2FibGVGYmNRdWV1ZTppbGsgKi8K
PiAgIAkJSTkxNV9XUklURShJTEtfRElTUExBWV9DSElDS0VOMSwKPiAgIAkJCSAgIEk5MTVfUkVB
RChJTEtfRElTUExBWV9DSElDS0VOMSkgfAo+IEBAIC04ODYyLDEyICs4ODYyLDEyIEBAIHN0YXRp
YyB2b2lkIGlsa19pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gICAJLyogV2FEaXNhYmxlX1JlbmRlckNhY2hlX09wZXJhdGlvbmFsRmx1c2g6aWxr
ICovCj4gICAJSTkxNV9XUklURShDQUNIRV9NT0RFXzAsIF9NQVNLRURfQklUX0RJU0FCTEUoUkNf
T1BfRkxVU0hfRU5BQkxFKSk7Cj4gICAKPiAtCWc0eF9kaXNhYmxlX3RyaWNrbGVfZmVlZChkZXZf
cHJpdik7Cj4gKwlnNHhfZGlzYWJsZV90cmlja2xlX2ZlZWQoaTkxNSk7Cj4gICAKPiAtCWlieF9p
bml0X2Nsb2NrX2dhdGluZyhkZXZfcHJpdik7Cj4gKwlpYnhfaW5pdF9jbG9ja19nYXRpbmcoaTkx
NSk7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgY3B0X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgY3B0X2luaXRfY2xv
Y2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCWludCBw
aXBlOwo+ICAgCXUzMiB2YWw7Cj4gQEAgLTg4ODUsMTEgKzg4ODUsMTEgQEAgc3RhdGljIHZvaWQg
Y3B0X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiAgIAkvKiBUaGUgYmVsb3cgZml4ZXMgdGhlIHdlaXJkIGRpc3BsYXkgY29ycnVwdGlvbiwgYSBm
ZXcgcGl4ZWxzIHNoaWZ0ZWQKPiAgIAkgKiBkb3dud2FyZCwgb24gKG9ubHkpIExWRFMgb2Ygc29t
ZSBIUCBsYXB0b3BzIHdpdGggSVZZLgo+ICAgCSAqLwo+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJp
diwgcGlwZSkgewo+ICsJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKSB7Cj4gICAJCXZhbCA9IEk5
MTVfUkVBRChUUkFOU19DSElDS0VOMihwaXBlKSk7Cj4gICAJCXZhbCB8PSBUUkFOU19DSElDS0VO
Ml9USU1JTkdfT1ZFUlJJREU7Cj4gICAJCXZhbCAmPSB+VFJBTlNfQ0hJQ0tFTjJfRkRJX1BPTEFS
SVRZX1JFVkVSU0VEOwo+IC0JCWlmIChkZXZfcHJpdi0+dmJ0LmZkaV9yeF9wb2xhcml0eV9pbnZl
cnRlZCkKPiArCQlpZiAoaTkxNS0+dmJ0LmZkaV9yeF9wb2xhcml0eV9pbnZlcnRlZCkKPiAgIAkJ
CXZhbCB8PSBUUkFOU19DSElDS0VOMl9GRElfUE9MQVJJVFlfUkVWRVJTRUQ7Cj4gICAJCXZhbCAm
PSB+VFJBTlNfQ0hJQ0tFTjJfRlJBTUVfU1RBUlRfREVMQVlfTUFTSzsKPiAgIAkJdmFsICY9IH5U
UkFOU19DSElDS0VOMl9ESVNBQkxFX0RFRVBfQ09MT1JfQ09VTlRFUjsKPiBAQCAtODg5NywxMyAr
ODg5NywxMyBAQCBzdGF0aWMgdm9pZCBjcHRfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQlJOTE1X1dSSVRFKFRSQU5TX0NISUNLRU4yKHBp
cGUpLCB2YWwpOwo+ICAgCX0KPiAgIAkvKiBXQURQMENsb2NrR2F0aW5nRGlzYWJsZSAqLwo+IC0J
Zm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkgewo+ICsJZm9yX2VhY2hfcGlwZShpOTE1LCBw
aXBlKSB7Cj4gICAJCUk5MTVfV1JJVEUoVFJBTlNfQ0hJQ0tFTjEocGlwZSksCj4gICAJCQkgICBU
UkFOU19DSElDS0VOMV9EUDBVTklUX0dDX0RJU0FCTEUpOwo+ICAgCX0KPiAgIH0KPiAgIAo+IC1z
dGF0aWMgdm9pZCBnZW42X2NoZWNrX21jaF9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGdlbjZfY2hlY2tfbWNoX3NldHVwKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUzMiB0bXA7Cj4gICAKPiBAQCAtODkxMyw3
ICs4OTEzLDcgQEAgc3RhdGljIHZvaWQgZ2VuNl9jaGVja19tY2hfc2V0dXAoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQkJICAgICAgdG1wKTsKPiAgIH0KPiAgIAo+IC1z
dGF0aWMgdm9pZCBnZW42X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgZ2VuNl9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAl1MzIgZHNwY2xrX2dhdGUgPSBJTEtf
VlJIVU5JVF9DTE9DS19HQVRFX0RJU0FCTEU7Cj4gICAKPiBAQCAtOTAwMCwxNCArOTAwMCwxNCBA
QCBzdGF0aWMgdm9pZCBnZW42X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiAgIAkJICAgSUxLX0RQQVJCVU5JVF9DTE9DS19HQVRFX0VOQUJMRSAg
fAo+ICAgCQkgICBJTEtfRFBGRFVOSVRfQ0xPQ0tfR0FURV9FTkFCTEUpOwo+ICAgCj4gLQlnNHhf
ZGlzYWJsZV90cmlja2xlX2ZlZWQoZGV2X3ByaXYpOwo+ICsJZzR4X2Rpc2FibGVfdHJpY2tsZV9m
ZWVkKGk5MTUpOwo+ICAgCj4gLQljcHRfaW5pdF9jbG9ja19nYXRpbmcoZGV2X3ByaXYpOwo+ICsJ
Y3B0X2luaXRfY2xvY2tfZ2F0aW5nKGk5MTUpOwo+ICAgCj4gLQlnZW42X2NoZWNrX21jaF9zZXR1
cChkZXZfcHJpdik7Cj4gKwlnZW42X2NoZWNrX21jaF9zZXR1cChpOTE1KTsKPiAgIH0KPiAgIAo+
IC1zdGF0aWMgdm9pZCBnZW43X3NldHVwX2ZpeGVkX2Z1bmNfc2NoZWR1bGVyKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgZ2VuN19zZXR1cF9maXhlZF9m
dW5jX3NjaGVkdWxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAl1
MzIgcmVnID0gSTkxNV9SRUFEKEdFTjdfRkZfVEhSRUFEX01PREUpOwo+ICAgCj4gQEAgLTkwMjUs
MTMgKzkwMjUsMTMgQEAgc3RhdGljIHZvaWQgZ2VuN19zZXR1cF9maXhlZF9mdW5jX3NjaGVkdWxl
cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJSTkxNV9XUklURShHRU43
X0ZGX1RIUkVBRF9NT0RFLCByZWcpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGxwdF9pbml0
X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRp
YyB2b2lkIGxwdF9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiAgIHsKPiAgIAkvKgo+ICAgCSAqIFRPRE86IHRoaXMgYml0IHNob3VsZCBvbmx5IGJlIGVu
YWJsZWQgd2hlbiByZWFsbHkgbmVlZGVkLCB0aGVuCj4gICAJICogZGlzYWJsZWQgd2hlbiBub3Qg
bmVlZGVkIGFueW1vcmUgaW4gb3JkZXIgdG8gc2F2ZSBwb3dlci4KPiAgIAkgKi8KPiAtCWlmIChI
QVNfUENIX0xQVF9MUChkZXZfcHJpdikpCj4gKwlpZiAoSEFTX1BDSF9MUFRfTFAoaTkxNSkpCj4g
ICAJCUk5MTVfV1JJVEUoU09VVEhfRFNQQ0xLX0dBVEVfRCwKPiAgIAkJCSAgIEk5MTVfUkVBRChT
T1VUSF9EU1BDTEtfR0FURV9EKSB8Cj4gICAJCQkgICBQQ0hfTFBfUEFSVElUSU9OX0xFVkVMX0RJ
U0FCTEUpOwo+IEBAIC05MDQyLDkgKzkwNDIsOSBAQCBzdGF0aWMgdm9pZCBscHRfaW5pdF9jbG9j
a19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQkgICBUUkFO
U19DSElDS0VOMV9EUDBVTklUX0dDX0RJU0FCTEUpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lk
IGxwdF9zdXNwZW5kX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3Rh
dGljIHZvaWQgbHB0X3N1c3BlbmRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
ICB7Cj4gLQlpZiAoSEFTX1BDSF9MUFRfTFAoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSEFTX1BDSF9M
UFRfTFAoaTkxNSkpIHsKPiAgIAkJdTMyIHZhbCA9IEk5MTVfUkVBRChTT1VUSF9EU1BDTEtfR0FU
RV9EKTsKPiAgIAo+ICAgCQl2YWwgJj0gflBDSF9MUF9QQVJUSVRJT05fTEVWRUxfRElTQUJMRTsK
PiBAQCAtOTA1Miw3ICs5MDUyLDcgQEAgc3RhdGljIHZvaWQgbHB0X3N1c3BlbmRfaHcoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCX0KPiAgIH0KPiAgIAo+IC1zdGF0aWMg
dm9pZCBnZW44X3NldF9sM3NxY19jcmVkaXRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiArc3RhdGljIHZvaWQgZ2VuOF9zZXRfbDNzcWNfY3JlZGl0cyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICBpbnQgZ2VuZXJhbF9wcmlvX2NyZWRpdHMsCj4g
ICAJCQkJICAgaW50IGhpZ2hfcHJpb19jcmVkaXRzKQo+ICAgewo+IEBAIC05MDc4LDcgKzkwNzgs
NyBAQCBzdGF0aWMgdm9pZCBnZW44X3NldF9sM3NxY19jcmVkaXRzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiAgIAlJOTE1X1dSSVRFKEdFTjdfTUlTQ0NQQ1RMLCBtaXNjY3Bj
dGwpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGljbF9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGljbF9pbml0X2Ns
b2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAkvKiBU
aGlzIGlzIG5vdCBhbiBXYS4gRW5hYmxlIHRvIHJlZHVjZSBTYW1wbGVyIHBvd2VyICovCj4gICAJ
STkxNV9XUklURShHRU4xMF9ERlJfUkFUSU9fRU5fQU5EX0NISUNLRU4sCj4gQEAgLTkwODksOSAr
OTA4OSw5IEBAIHN0YXRpYyB2b2lkIGljbF9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCSAgIF9NQVNLRURfQklUX0VOQUJMRShHRU4xMV9F
TkFCTEVfMzJfUExBTkVfTU9ERSkpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGNucF9pbml0
X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRp
YyB2b2lkIGNucF9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiAgIHsKPiAtCWlmICghSEFTX1BDSF9DTlAoZGV2X3ByaXYpKQo+ICsJaWYgKCFIQVNfUENI
X0NOUChpOTE1KSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJLyogRGlzcGxheSBXQSAjMTE4MSBX
YVNvdXRoRGlzcGxheURpc2FibGVQV01DR0VHYXRpbmc6IGNucCAqLwo+IEBAIC05MDk5LDEwICs5
MDk5LDEwIEBAIHN0YXRpYyB2b2lkIGNucF9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCSAgIENOUF9QV01fQ0dFX0dBVElOR19ESVNBQkxF
KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBjbmxfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBjbmxfaW5pdF9jbG9j
a19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJdTMyIHZh
bDsKPiAtCWNucF9pbml0X2Nsb2NrX2dhdGluZyhkZXZfcHJpdik7Cj4gKwljbnBfaW5pdF9jbG9j
a19nYXRpbmcoaTkxNSk7Cj4gICAKPiAgIAkvKiBUaGlzIGlzIG5vdCBhbiBXYS4gRW5hYmxlIGZv
ciBiZXR0ZXIgaW1hZ2UgcXVhbGl0eSAqLwo+ICAgCUk5MTVfV1JJVEUoXzNEX0NISUNLRU4zLAo+
IEBAIC05MTIwLDcgKzkxMjAsNyBAQCBzdGF0aWMgdm9pZCBjbmxfaW5pdF9jbG9ja19nYXRpbmco
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCS8qIFJlYWRIaXRXcml0ZU9u
bHlEaXNhYmxlOmNubCAqLwo+ICAgCXZhbCB8PSBSQ0NVTklUX0NMS0dBVEVfRElTOwo+ICAgCS8q
IFdhU2FyYlVuaXRDbG9ja0dhdGluZ0Rpc2FibGU6Y25sIChwcmUtcHJvZCkgKi8KPiAtCWlmIChJ
U19DTkxfUkVWSUQoZGV2X3ByaXYsIENOTF9SRVZJRF9BMCwgQ05MX1JFVklEX0IwKSkKPiArCWlm
IChJU19DTkxfUkVWSUQoaTkxNSwgQ05MX1JFVklEX0EwLCBDTkxfUkVWSURfQjApKQo+ICAgCQl2
YWwgfD0gU0FSQlVOSVRfQ0xLR0FURV9ESVM7Cj4gICAJSTkxNV9XUklURShTTElDRV9VTklUX0xF
VkVMX0NMS0dBVEUsIHZhbCk7Cj4gICAKPiBAQCAtOTEzNiwyNyArOTEzNiwyNyBAQCBzdGF0aWMg
dm9pZCBjbmxfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICAgCUk5MTVfV1JJVEUoVU5TTElDRV9VTklUX0xFVkVMX0NMS0dBVEUsIHZhbCk7Cj4g
ICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgY2ZsX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgY2ZsX2luaXRfY2xvY2tfZ2F0
aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JY25wX2luaXRfY2xv
Y2tfZ2F0aW5nKGRldl9wcml2KTsKPiAtCWdlbjlfaW5pdF9jbG9ja19nYXRpbmcoZGV2X3ByaXYp
Owo+ICsJY25wX2luaXRfY2xvY2tfZ2F0aW5nKGk5MTUpOwo+ICsJZ2VuOV9pbml0X2Nsb2NrX2dh
dGluZyhpOTE1KTsKPiAgIAo+ICAgCS8qIFdhRmJjTnVrZU9uSG9zdE1vZGlmeTpjZmwgKi8KPiAg
IAlJOTE1X1dSSVRFKElMS19EUEZDX0NISUNLRU4sIEk5MTVfUkVBRChJTEtfRFBGQ19DSElDS0VO
KSB8Cj4gICAJCSAgIElMS19EUEZDX05VS0VfT05fQU5ZX01PRElGSUNBVElPTik7Cj4gICB9Cj4g
ICAKPiAtc3RhdGljIHZvaWQga2JsX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQga2JsX2luaXRfY2xvY2tfZ2F0aW5nKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+IC0JZ2VuOV9pbml0X2Nsb2NrX2dh
dGluZyhkZXZfcHJpdik7Cj4gKwlnZW45X2luaXRfY2xvY2tfZ2F0aW5nKGk5MTUpOwo+ICAgCj4g
ICAJLyogV2FEaXNhYmxlU0RFVW5pdENsb2NrR2F0aW5nOmtibCAqLwo+IC0JaWYgKElTX0tCTF9S
RVZJRChkZXZfcHJpdiwgMCwgS0JMX1JFVklEX0IwKSkKPiArCWlmIChJU19LQkxfUkVWSUQoaTkx
NSwgMCwgS0JMX1JFVklEX0IwKSkKPiAgIAkJSTkxNV9XUklURShHRU44X1VDR0NUTDYsIEk5MTVf
UkVBRChHRU44X1VDR0NUTDYpIHwKPiAgIAkJCSAgIEdFTjhfU0RFVU5JVF9DTE9DS19HQVRFX0RJ
U0FCTEUpOwo+ICAgCj4gICAJLyogV2FEaXNhYmxlR2FtQ2xvY2tHYXRpbmc6a2JsICovCj4gLQlp
ZiAoSVNfS0JMX1JFVklEKGRldl9wcml2LCAwLCBLQkxfUkVWSURfQjApKQo+ICsJaWYgKElTX0tC
TF9SRVZJRChpOTE1LCAwLCBLQkxfUkVWSURfQjApKQo+ICAgCQlJOTE1X1dSSVRFKEdFTjZfVUNH
Q1RMMSwgSTkxNV9SRUFEKEdFTjZfVUNHQ1RMMSkgfAo+ICAgCQkJICAgR0VONl9HQU1VTklUX0NM
T0NLX0dBVEVfRElTQUJMRSk7Cj4gICAKPiBAQCAtOTE2NSw5ICs5MTY1LDkgQEAgc3RhdGljIHZv
aWQga2JsX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiAgIAkJICAgSUxLX0RQRkNfTlVLRV9PTl9BTllfTU9ESUZJQ0FUSU9OKTsKPiAgIH0KPiAg
IAo+IC1zdGF0aWMgdm9pZCBza2xfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBza2xfaW5pdF9jbG9ja19nYXRpbmcoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlnZW45X2luaXRfY2xvY2tfZ2F0
aW5nKGRldl9wcml2KTsKPiArCWdlbjlfaW5pdF9jbG9ja19nYXRpbmcoaTkxNSk7Cj4gICAKPiAg
IAkvKiBXQUM2ZW50cnlsYXRlbmN5OnNrbCAqLwo+ICAgCUk5MTVfV1JJVEUoRkJDX0xMQ19SRUFE
X0NUUkwsIEk5MTVfUkVBRChGQkNfTExDX1JFQURfQ1RSTCkgfAo+IEBAIC05MTc4LDEwICs5MTc4
LDEwIEBAIHN0YXRpYyB2b2lkIHNrbF9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCSAgIElMS19EUEZDX05VS0VfT05fQU5ZX01PRElGSUNB
VElPTik7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgYmR3X2luaXRfY2xvY2tfZ2F0aW5nKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgYmR3X2luaXRf
Y2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCS8q
IFRoZSBHVFQgY2FjaGUgbXVzdCBiZSBkaXNhYmxlZCBpZiB0aGUgc3lzdGVtIGlzIHVzaW5nIDJN
IHBhZ2VzLiAqLwo+IC0JYm9vbCBjYW5fdXNlX2d0dF9jYWNoZSA9ICFIQVNfUEFHRV9TSVpFUyhk
ZXZfcHJpdiwKPiArCWJvb2wgY2FuX3VzZV9ndHRfY2FjaGUgPSAhSEFTX1BBR0VfU0laRVMoaTkx
NSwKPiAgIAkJCQkJCSBJOTE1X0dUVF9QQUdFX1NJWkVfMk0pOwo+ICAgCWVudW0gcGlwZSBwaXBl
Owo+ICAgCj4gQEAgLTkxOTMsNyArOTE5Myw3IEBAIHN0YXRpYyB2b2lkIGJkd19pbml0X2Nsb2Nr
X2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCSAgIEk5MTVf
UkVBRChDSElDS0VOX1BBUjFfMSkgfCBEUEFfTUFTS19WQkxBTktfU1JEKTsKPiAgIAo+ICAgCS8q
IFdhUHNyRFBSU1VubWFza1ZCbGFua0luU1JEOmJkdyAqLwo+IC0JZm9yX2VhY2hfcGlwZShkZXZf
cHJpdiwgcGlwZSkgewo+ICsJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKSB7Cj4gICAJCUk5MTVf
V1JJVEUoQ0hJQ0tFTl9QSVBFU0xfMShwaXBlKSwKPiAgIAkJCSAgIEk5MTVfUkVBRChDSElDS0VO
X1BJUEVTTF8xKHBpcGUpKSB8Cj4gICAJCQkgICBCRFdfRFBSU19NQVNLX1ZCTEFOS19TUkQpOwo+
IEBAIC05MjEzLDcgKzkyMTMsNyBAQCBzdGF0aWMgdm9pZCBiZHdfaW5pdF9jbG9ja19nYXRpbmco
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQkgICBHRU44X1NERVVOSVRf
Q0xPQ0tfR0FURV9ESVNBQkxFKTsKPiAgIAo+ICAgCS8qIFdhUHJvZ3JhbUwzU3FjUmVnMURlZmF1
bHQ6YmR3ICovCj4gLQlnZW44X3NldF9sM3NxY19jcmVkaXRzKGRldl9wcml2LCAzMCwgMik7Cj4g
KwlnZW44X3NldF9sM3NxY19jcmVkaXRzKGk5MTUsIDMwLCAyKTsKPiAgIAo+ICAgCS8qIFdhR3R0
Q2FjaGluZ09mZkJ5RGVmYXVsdDpiZHcgKi8KPiAgIAlJOTE1X1dSSVRFKEhTV19HVFRfQ0FDSEVf
RU4sIGNhbl91c2VfZ3R0X2NhY2hlID8gR1RUX0NBQ0hFX0VOX0FMTCA6IDApOwo+IEBAIC05MjIy
LDcgKzkyMjIsNyBAQCBzdGF0aWMgdm9pZCBiZHdfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCUk5MTVfV1JJVEUoQ0hJQ0tFTl9QQVIyXzEs
IEk5MTVfUkVBRChDSElDS0VOX1BBUjJfMSkKPiAgIAkJICAgfCBLVk1fQ09ORklHX0NIQU5HRV9O
T1RJRklDQVRJT05fU0VMRUNUKTsKPiAgIAo+IC0JbHB0X2luaXRfY2xvY2tfZ2F0aW5nKGRldl9w
cml2KTsKPiArCWxwdF9pbml0X2Nsb2NrX2dhdGluZyhpOTE1KTsKPiAgIAo+ICAgCS8qIFdhRGlz
YWJsZURvcENsb2NrR2F0aW5nOmJkdwo+ICAgCSAqCj4gQEAgLTkyMzMsNyArOTIzMyw3IEBAIHN0
YXRpYyB2b2lkIGJkd19pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gICAJCSAgIEk5MTVfUkVBRChHRU42X1VDR0NUTDEpIHwgR0VONl9FVV9UQ1VO
SVRfQ0xPQ0tfR0FURV9ESVNBQkxFKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBoc3dfaW5p
dF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0
aWMgdm9pZCBoc3dfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCj4gICB7Cj4gICAJLyogTDMgY2FjaGluZyBvZiBkYXRhIGF0b21pY3MgZG9lc24ndCB3b3Jr
IC0tIGRpc2FibGUgaXQuICovCj4gICAJSTkxNV9XUklURShIU1dfU0NSQVRDSDEsIEhTV19TQ1JB
VENIMV9MM19EQVRBX0FUT01JQ1NfRElTQUJMRSk7Cj4gQEAgLTkyNzgsMTAgKzkyNzgsMTAgQEAg
c3RhdGljIHZvaWQgaHN3X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiAgIAkvKiBXYVN3aXRjaFNvbFZmRkFyYml0cmF0aW9uUHJpb3JpdHk6aHN3
ICovCj4gICAJSTkxNV9XUklURShHQU1fRUNPQ0hLLCBJOTE1X1JFQUQoR0FNX0VDT0NISykgfCBI
U1dfRUNPQ0hLX0FSQl9QUklPX1NPTCk7Cj4gICAKPiAtCWxwdF9pbml0X2Nsb2NrX2dhdGluZyhk
ZXZfcHJpdik7Cj4gKwlscHRfaW5pdF9jbG9ja19nYXRpbmcoaTkxNSk7Cj4gICB9Cj4gICAKPiAt
c3RhdGljIHZvaWQgaXZiX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaXZiX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUzMiBzbnBjcjsKPiAgIAo+IEBAIC05
Mjk3LDcgKzkyOTcsNyBAQCBzdGF0aWMgdm9pZCBpdmJfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQkgICBDSElDS0VOM19ER01HX0RPTkVf
RklYX0RJU0FCTEUpOwo+ICAgCj4gICAJLyogV2FEaXNhYmxlUFNERHVhbERpc3BhdGNoRW5hYmxl
Oml2YiAqLwo+IC0JaWYgKElTX0lWQl9HVDEoZGV2X3ByaXYpKQo+ICsJaWYgKElTX0lWQl9HVDEo
aTkxNSkpCj4gICAJCUk5MTVfV1JJVEUoR0VON19IQUxGX1NMSUNFX0NISUNLRU4xLAo+ICAgCQkJ
ICAgX01BU0tFRF9CSVRfRU5BQkxFKEdFTjdfUFNEX1NJTkdMRV9QT1JUX0RJU1BBVENIX0VOQUJM
RSkpOwo+ICAgCj4gQEAgLTkzMTMsNyArOTMxMyw3IEBAIHN0YXRpYyB2b2lkIGl2Yl9pbml0X2Ns
b2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCQlHRU43
X1dBX0ZPUl9HRU43X0wzX0NPTlRST0wpOwo+ICAgCUk5MTVfV1JJVEUoR0VON19MM19DSElDS0VO
X01PREVfUkVHSVNURVIsCj4gICAJCSAgIEdFTjdfV0FfTDNfQ0hJQ0tFTl9NT0RFKTsKPiAtCWlm
IChJU19JVkJfR1QxKGRldl9wcml2KSkKPiArCWlmIChJU19JVkJfR1QxKGk5MTUpKQo+ICAgCQlJ
OTE1X1dSSVRFKEdFTjdfUk9XX0NISUNLRU4yLAo+ICAgCQkJICAgX01BU0tFRF9CSVRfRU5BQkxF
KERPUF9DTE9DS19HQVRJTkdfRElTQUJMRSkpOwo+ICAgCWVsc2Ugewo+IEBAIC05MzQwLDkgKzkz
NDAsOSBAQCBzdGF0aWMgdm9pZCBpdmJfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQkJSTkxNV9SRUFEKEdFTjdfU1FfQ0hJQ0tFTl9NQkNV
TklUX0NPTkZJRykgfAo+ICAgCQkJR0VON19TUV9DSElDS0VOX01CQ1VOSVRfU1FJTlRNT0IpOwo+
ICAgCj4gLQlnNHhfZGlzYWJsZV90cmlja2xlX2ZlZWQoZGV2X3ByaXYpOwo+ICsJZzR4X2Rpc2Fi
bGVfdHJpY2tsZV9mZWVkKGk5MTUpOwo+ICAgCj4gLQlnZW43X3NldHVwX2ZpeGVkX2Z1bmNfc2No
ZWR1bGVyKGRldl9wcml2KTsKPiArCWdlbjdfc2V0dXBfZml4ZWRfZnVuY19zY2hlZHVsZXIoaTkx
NSk7Cj4gICAKPiAgIAlpZiAoMCkgeyAvKiBjYXVzZXMgSGlaIGNvcnJ1cHRpb24gb24gaXZiOmd0
MSAqLwo+ICAgCQkvKiBlbmFibGUgSGlaIFJhdyBTdGFsbCBPcHRpbWl6YXRpb24gKi8KPiBAQCAt
OTM3MCwxMyArOTM3MCwxMyBAQCBzdGF0aWMgdm9pZCBpdmJfaW5pdF9jbG9ja19nYXRpbmcoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCXNucGNyIHw9IEdFTjZfTUJDX1NO
UENSX01FRDsKPiAgIAlJOTE1X1dSSVRFKEdFTjZfTUJDVU5JVF9TTlBDUiwgc25wY3IpOwo+ICAg
Cj4gLQlpZiAoIUhBU19QQ0hfTk9QKGRldl9wcml2KSkKPiAtCQljcHRfaW5pdF9jbG9ja19nYXRp
bmcoZGV2X3ByaXYpOwo+ICsJaWYgKCFIQVNfUENIX05PUChpOTE1KSkKPiArCQljcHRfaW5pdF9j
bG9ja19nYXRpbmcoaTkxNSk7Cj4gICAKPiAtCWdlbjZfY2hlY2tfbWNoX3NldHVwKGRldl9wcml2
KTsKPiArCWdlbjZfY2hlY2tfbWNoX3NldHVwKGk5MTUpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2
b2lkIHZsdl9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gK3N0YXRpYyB2b2lkIHZsdl9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAkvKiBXYURpc2FibGVFYXJseUN1bGw6dmx2ICovCj4g
ICAJSTkxNV9XUklURShfM0RfQ0hJQ0tFTjMsCj4gQEAgLTk0MDksNyArOTQwOSw3IEBAIHN0YXRp
YyB2b2lkIHZsdl9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gICAJCSAgIEk5MTVfUkVBRChHRU43X1NRX0NISUNLRU5fTUJDVU5JVF9DT05GSUcp
IHwKPiAgIAkJICAgR0VON19TUV9DSElDS0VOX01CQ1VOSVRfU1FJTlRNT0IpOwo+ICAgCj4gLQln
ZW43X3NldHVwX2ZpeGVkX2Z1bmNfc2NoZWR1bGVyKGRldl9wcml2KTsKPiArCWdlbjdfc2V0dXBf
Zml4ZWRfZnVuY19zY2hlZHVsZXIoaTkxNSk7Cj4gICAKPiAgIAkvKgo+ICAgCSAqIEFjY29yZGlu
ZyB0byB0aGUgc3BlYywgYml0IDEzIChSQ1pVTklUKSBtdXN0IGJlIHNldCBvbiBJVkIuCj4gQEAg
LTk0NTYsNyArOTQ1Niw3IEBAIHN0YXRpYyB2b2lkIHZsdl9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJSTkxNV9XUklURShWTFZfR1VOSVRf
Q0xPQ0tfR0FURSwgR0NGR19ESVMpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGNodl9pbml0
X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRp
YyB2b2lkIGNodl9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiAgIHsKPiAgIAkvKiBXYVZTUmVmQ291bnRGdWxsZm9yY2VNaXNzRGlzYWJsZTpjaHYgKi8K
PiAgIAkvKiBXYURTUmVmQ291bnRGdWxsZm9yY2VNaXNzRGlzYWJsZTpjaHYgKi8KPiBAQCAtOTQ4
MSw3ICs5NDgxLDcgQEAgc3RhdGljIHZvaWQgY2h2X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkgKiBTZWUgZ2Z4c3BlY3MvUmVsYXRlZCBE
b2N1bWVudHMvUGVyZm9ybWFuY2UgR3VpZGUvCj4gICAJICogTFNRQyBTZXR0aW5nIFJlY29tbWVu
ZGF0aW9ucy4KPiAgIAkgKi8KPiAtCWdlbjhfc2V0X2wzc3FjX2NyZWRpdHMoZGV2X3ByaXYsIDM4
LCAyKTsKPiArCWdlbjhfc2V0X2wzc3FjX2NyZWRpdHMoaTkxNSwgMzgsIDIpOwo+ICAgCj4gICAJ
LyoKPiAgIAkgKiBHVFQgY2FjaGUgbWF5IG5vdCB3b3JrIHdpdGggYmlnIHBhZ2VzLCBzbyBpZiB0
aG9zZQo+IEBAIC05NDkwLDcgKzk0OTAsNyBAQCBzdGF0aWMgdm9pZCBjaHZfaW5pdF9jbG9ja19n
YXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCUk5MTVfV1JJVEUo
SFNXX0dUVF9DQUNIRV9FTiwgR1RUX0NBQ0hFX0VOX0FMTCk7Cj4gICB9Cj4gICAKPiAtc3RhdGlj
IHZvaWQgZzR4X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiArc3RhdGljIHZvaWQgZzR4X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUzMiBkc3BjbGtfZ2F0ZTsKPiAgIAo+IEBAIC05
NTAyLDcgKzk1MDIsNyBAQCBzdGF0aWMgdm9pZCBnNHhfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCWRzcGNsa19nYXRlID0gVlJIVU5JVF9D
TE9DS19HQVRFX0RJU0FCTEUgfAo+ICAgCQlPVlJVTklUX0NMT0NLX0dBVEVfRElTQUJMRSB8Cj4g
ICAJCU9WQ1VOSVRfQ0xPQ0tfR0FURV9ESVNBQkxFOwo+IC0JaWYgKElTX0dNNDUoZGV2X3ByaXYp
KQo+ICsJaWYgKElTX0dNNDUoaTkxNSkpCj4gICAJCWRzcGNsa19nYXRlIHw9IERTU1VOSVRfQ0xP
Q0tfR0FURV9ESVNBQkxFOwo+ICAgCUk5MTVfV1JJVEUoRFNQQ0xLX0dBVEVfRCwgZHNwY2xrX2dh
dGUpOwo+ICAgCj4gQEAgLTk1MTMsMTIgKzk1MTMsMTIgQEAgc3RhdGljIHZvaWQgZzR4X2luaXRf
Y2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgIAkvKiBX
YURpc2FibGVfUmVuZGVyQ2FjaGVfT3BlcmF0aW9uYWxGbHVzaDpnNHggKi8KPiAgIAlJOTE1X1dS
SVRFKENBQ0hFX01PREVfMCwgX01BU0tFRF9CSVRfRElTQUJMRShSQ19PUF9GTFVTSF9FTkFCTEUp
KTsKPiAgIAo+IC0JZzR4X2Rpc2FibGVfdHJpY2tsZV9mZWVkKGRldl9wcml2KTsKPiArCWc0eF9k
aXNhYmxlX3RyaWNrbGVfZmVlZChpOTE1KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpOTY1
Z21faW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ICtzdGF0aWMgdm9pZCBpOTY1Z21faW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2
X3ByaXYtPnVuY29yZTsKPiArCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZpOTE1LT51
bmNvcmU7Cj4gICAKPiAgIAlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBSRU5DTEtfR0FURV9E
MSwgSTk2NV9SQ0NfQ0xPQ0tfR0FURV9ESVNBQkxFKTsKPiAgIAlpbnRlbF91bmNvcmVfd3JpdGUo
dW5jb3JlLCBSRU5DTEtfR0FURV9EMiwgMCk7Cj4gQEAgLTk1MzUsNyArOTUzNSw3IEBAIHN0YXRp
YyB2b2lkIGk5NjVnbV9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gICAJCQkgICBfTUFTS0VEX0JJVF9ESVNBQkxFKFJDX09QX0ZMVVNIX0VOQUJM
RSkpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGk5NjVnX2luaXRfY2xvY2tfZ2F0aW5nKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaTk2NWdfaW5p
dF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJ
STkxNV9XUklURShSRU5DTEtfR0FURV9EMSwgSTk2NV9SQ1pfQ0xPQ0tfR0FURV9ESVNBQkxFIHwK
PiAgIAkJICAgSTk2NV9SQ0NfQ0xPQ0tfR0FURV9ESVNBQkxFIHwKPiBAQCAtOTU1MCw3ICs5NTUw
LDcgQEAgc3RhdGljIHZvaWQgaTk2NWdfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCUk5MTVfV1JJVEUoQ0FDSEVfTU9ERV8wLCBfTUFTS0VE
X0JJVF9ESVNBQkxFKFJDX09QX0ZMVVNIX0VOQUJMRSkpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2
b2lkIGdlbjNfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICtzdGF0aWMgdm9pZCBnZW4zX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXUzMiBkc3RhdGUgPSBJOTE1X1JFQUQoRF9TVEFU
RSk7Cj4gICAKPiBAQCAtOTU1OCw3ICs5NTU4LDcgQEAgc3RhdGljIHZvaWQgZ2VuM19pbml0X2Ns
b2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJCURTVEFU
RV9ET1RfQ0xPQ0tfR0FUSU5HOwo+ICAgCUk5MTVfV1JJVEUoRF9TVEFURSwgZHN0YXRlKTsKPiAg
IAo+IC0JaWYgKElTX1BJTkVWSUVXKGRldl9wcml2KSkKPiArCWlmIChJU19QSU5FVklFVyhpOTE1
KSkKPiAgIAkJSTkxNV9XUklURShFQ09TS1BELCBfTUFTS0VEX0JJVF9FTkFCTEUoRUNPX0dBVElO
R19DWF9PTkxZKSk7Cj4gICAKPiAgIAkvKiBJSVIgImZsaXAgcGVuZGluZyIgbWVhbnMgZG9uZSBp
ZiB0aGlzIGJpdCBpcyBzZXQgKi8KPiBAQCAtOTU3NCw3ICs5NTc0LDcgQEAgc3RhdGljIHZvaWQg
Z2VuM19pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gICAJCSAgIF9NQVNLRURfQklUX0VOQUJMRShNSV9BUkJfRElTUExBWV9UUklDS0xFX0ZFRURf
RElTQUJMRSkpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGk4NXhfaW5pdF9jbG9ja19nYXRp
bmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBpODV4
X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+
ICAgCUk5MTVfV1JJVEUoUkVOQ0xLX0dBVEVfRDEsIFNWX0NMT0NLX0dBVEVfRElTQUJMRSk7Cj4g
ICAKPiBAQCAtOTU4NiwxNjggKzk1ODYsMTY4IEBAIHN0YXRpYyB2b2lkIGk4NXhfaW5pdF9jbG9j
a19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQkgICBfTUFT
S0VEX0JJVF9FTkFCTEUoTUVNX0RJU1BMQVlfVFJJQ0tMRV9GRUVEX0RJU0FCTEUpKTsKPiAgIH0K
PiAgIAo+IC1zdGF0aWMgdm9pZCBpODMwX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaTgzMF9pbml0X2Nsb2NrX2dhdGlu
ZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAlJOTE1X1dSSVRFKE1F
TV9NT0RFLAo+ICAgCQkgICBfTUFTS0VEX0JJVF9FTkFCTEUoTUVNX0RJU1BMQVlfQV9UUklDS0xF
X0ZFRURfRElTQUJMRSkgfAo+ICAgCQkgICBfTUFTS0VEX0JJVF9FTkFCTEUoTUVNX0RJU1BMQVlf
Ql9UUklDS0xFX0ZFRURfRElTQUJMRSkpOwo+ICAgfQo+ICAgCj4gLXZvaWQgaW50ZWxfaW5pdF9j
bG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGlu
dGVsX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAg
ewo+IC0JZGV2X3ByaXYtPmRpc3BsYXkuaW5pdF9jbG9ja19nYXRpbmcoZGV2X3ByaXYpOwo+ICsJ
aTkxNS0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyhpOTE1KTsKPiAgIH0KPiAgIAo+IC12b2lk
IGludGVsX3N1c3BlbmRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2
b2lkIGludGVsX3N1c3BlbmRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7
Cj4gLQlpZiAoSEFTX1BDSF9MUFQoZGV2X3ByaXYpKQo+IC0JCWxwdF9zdXNwZW5kX2h3KGRldl9w
cml2KTsKPiArCWlmIChIQVNfUENIX0xQVChpOTE1KSkKPiArCQlscHRfc3VzcGVuZF9odyhpOTE1
KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBub3BfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMgdm9pZCBub3BfaW5pdF9jbG9j
a19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJRFJNX0RF
QlVHX0tNUygiTm8gY2xvY2sgZ2F0aW5nIHNldHRpbmdzIG9yIHdvcmthcm91bmRzIGFwcGxpZWQu
XG4iKTsKPiAgIH0KPiAgIAo+ICAgLyoqCj4gICAgKiBpbnRlbF9pbml0X2Nsb2NrX2dhdGluZ19o
b29rcyAtIHNldHVwIHRoZSBjbG9jayBnYXRpbmcgaG9va3MKPiAtICogQGRldl9wcml2OiBkZXZp
Y2UgcHJpdmF0ZQo+ICsgKiBAaTkxNTogZGV2aWNlIHByaXZhdGUKPiAgICAqCj4gICAgKiBTZXR1
cCB0aGUgaG9va3MgdGhhdCBjb25maWd1cmUgd2hpY2ggY2xvY2tzIG9mIGEgZ2l2ZW4gcGxhdGZv
cm0gY2FuIGJlCj4gICAgKiBnYXRlZCBhbmQgYWxzbyBhcHBseSB2YXJpb3VzIEdUIGFuZCBkaXNw
bGF5IHNwZWNpZmljIHdvcmthcm91bmRzIGZvciB0aGVzZQo+ICAgICogcGxhdGZvcm1zLiBOb3Rl
IHRoYXQgc29tZSBHVCBzcGVjaWZpYyB3b3JrYXJvdW5kcyBhcmUgYXBwbGllZCBzZXBhcmF0ZWx5
Cj4gICAgKiB3aGVuIEdQVSBjb250ZXh0cyBvciBiYXRjaGJ1ZmZlcnMgc3RhcnQgdGhlaXIgZXhl
Y3V0aW9uLgo+ICAgICovCj4gLXZvaWQgaW50ZWxfaW5pdF9jbG9ja19nYXRpbmdfaG9va3Moc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+IC17Cj4gLQlpZiAoSVNfR0VOKGRldl9w
cml2LCAxMSkpCj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuaW5pdF9jbG9ja19nYXRpbmcgPSBpY2xf
aW5pdF9jbG9ja19nYXRpbmc7Cj4gLQllbHNlIGlmIChJU19DQU5OT05MQUtFKGRldl9wcml2KSkK
PiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGNubF9pbml0X2Nsb2Nr
X2dhdGluZzsKPiAtCWVsc2UgaWYgKElTX0NPRkZFRUxBS0UoZGV2X3ByaXYpKQo+IC0JCWRldl9w
cml2LT5kaXNwbGF5LmluaXRfY2xvY2tfZ2F0aW5nID0gY2ZsX2luaXRfY2xvY2tfZ2F0aW5nOwo+
IC0JZWxzZSBpZiAoSVNfU0tZTEFLRShkZXZfcHJpdikpCj4gLQkJZGV2X3ByaXYtPmRpc3BsYXku
aW5pdF9jbG9ja19nYXRpbmcgPSBza2xfaW5pdF9jbG9ja19nYXRpbmc7Cj4gLQllbHNlIGlmIChJ
U19LQUJZTEFLRShkZXZfcHJpdikpCj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuaW5pdF9jbG9ja19n
YXRpbmcgPSBrYmxfaW5pdF9jbG9ja19nYXRpbmc7Cj4gLQllbHNlIGlmIChJU19CUk9YVE9OKGRl
dl9wcml2KSkKPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGJ4dF9p
bml0X2Nsb2NrX2dhdGluZzsKPiAtCWVsc2UgaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKQo+
IC0JCWRldl9wcml2LT5kaXNwbGF5LmluaXRfY2xvY2tfZ2F0aW5nID0gZ2xrX2luaXRfY2xvY2tf
Z2F0aW5nOwo+IC0JZWxzZSBpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSkKPiAtCQlkZXZfcHJp
di0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGJkd19pbml0X2Nsb2NrX2dhdGluZzsKPiAt
CWVsc2UgaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+IC0JCWRldl9wcml2LT5kaXNwbGF5
LmluaXRfY2xvY2tfZ2F0aW5nID0gY2h2X2luaXRfY2xvY2tfZ2F0aW5nOwo+IC0JZWxzZSBpZiAo
SVNfSEFTV0VMTChkZXZfcHJpdikpCj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuaW5pdF9jbG9ja19n
YXRpbmcgPSBoc3dfaW5pdF9jbG9ja19nYXRpbmc7Cj4gLQllbHNlIGlmIChJU19JVllCUklER0Uo
ZGV2X3ByaXYpKQo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmluaXRfY2xvY2tfZ2F0aW5nID0gaXZi
X2luaXRfY2xvY2tfZ2F0aW5nOwo+IC0JZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikp
Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuaW5pdF9jbG9ja19nYXRpbmcgPSB2bHZfaW5pdF9jbG9j
a19nYXRpbmc7Cj4gLQllbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDYpKQo+IC0JCWRldl9wcml2
LT5kaXNwbGF5LmluaXRfY2xvY2tfZ2F0aW5nID0gZ2VuNl9pbml0X2Nsb2NrX2dhdGluZzsKPiAt
CWVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgNSkpCj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuaW5p
dF9jbG9ja19nYXRpbmcgPSBpbGtfaW5pdF9jbG9ja19nYXRpbmc7Cj4gLQllbHNlIGlmIChJU19H
NFgoZGV2X3ByaXYpKQo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmluaXRfY2xvY2tfZ2F0aW5nID0g
ZzR4X2luaXRfY2xvY2tfZ2F0aW5nOwo+IC0JZWxzZSBpZiAoSVNfSTk2NUdNKGRldl9wcml2KSkK
PiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGk5NjVnbV9pbml0X2Ns
b2NrX2dhdGluZzsKPiAtCWVsc2UgaWYgKElTX0k5NjVHKGRldl9wcml2KSkKPiAtCQlkZXZfcHJp
di0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGk5NjVnX2luaXRfY2xvY2tfZ2F0aW5nOwo+
IC0JZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCAzKSkKPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5p
bml0X2Nsb2NrX2dhdGluZyA9IGdlbjNfaW5pdF9jbG9ja19nYXRpbmc7Cj4gLQllbHNlIGlmIChJ
U19JODVYKGRldl9wcml2KSB8fCBJU19JODY1RyhkZXZfcHJpdikpCj4gLQkJZGV2X3ByaXYtPmRp
c3BsYXkuaW5pdF9jbG9ja19nYXRpbmcgPSBpODV4X2luaXRfY2xvY2tfZ2F0aW5nOwo+IC0JZWxz
ZSBpZiAoSVNfR0VOKGRldl9wcml2LCAyKSkKPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5pbml0X2Ns
b2NrX2dhdGluZyA9IGk4MzBfaW5pdF9jbG9ja19nYXRpbmc7Cj4gK3ZvaWQgaW50ZWxfaW5pdF9j
bG9ja19nYXRpbmdfaG9va3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gK3sKPiAr
CWlmIChJU19HRU4oaTkxNSwgMTEpKQo+ICsJCWk5MTUtPmRpc3BsYXkuaW5pdF9jbG9ja19nYXRp
bmcgPSBpY2xfaW5pdF9jbG9ja19nYXRpbmc7Cj4gKwllbHNlIGlmIChJU19DQU5OT05MQUtFKGk5
MTUpKQo+ICsJCWk5MTUtPmRpc3BsYXkuaW5pdF9jbG9ja19nYXRpbmcgPSBjbmxfaW5pdF9jbG9j
a19nYXRpbmc7Cj4gKwllbHNlIGlmIChJU19DT0ZGRUVMQUtFKGk5MTUpKQo+ICsJCWk5MTUtPmRp
c3BsYXkuaW5pdF9jbG9ja19nYXRpbmcgPSBjZmxfaW5pdF9jbG9ja19nYXRpbmc7Cj4gKwllbHNl
IGlmIChJU19TS1lMQUtFKGk5MTUpKQo+ICsJCWk5MTUtPmRpc3BsYXkuaW5pdF9jbG9ja19nYXRp
bmcgPSBza2xfaW5pdF9jbG9ja19nYXRpbmc7Cj4gKwllbHNlIGlmIChJU19LQUJZTEFLRShpOTE1
KSkKPiArCQlpOTE1LT5kaXNwbGF5LmluaXRfY2xvY2tfZ2F0aW5nID0ga2JsX2luaXRfY2xvY2tf
Z2F0aW5nOwo+ICsJZWxzZSBpZiAoSVNfQlJPWFRPTihpOTE1KSkKPiArCQlpOTE1LT5kaXNwbGF5
LmluaXRfY2xvY2tfZ2F0aW5nID0gYnh0X2luaXRfY2xvY2tfZ2F0aW5nOwo+ICsJZWxzZSBpZiAo
SVNfR0VNSU5JTEFLRShpOTE1KSkKPiArCQlpOTE1LT5kaXNwbGF5LmluaXRfY2xvY2tfZ2F0aW5n
ID0gZ2xrX2luaXRfY2xvY2tfZ2F0aW5nOwo+ICsJZWxzZSBpZiAoSVNfQlJPQURXRUxMKGk5MTUp
KQo+ICsJCWk5MTUtPmRpc3BsYXkuaW5pdF9jbG9ja19nYXRpbmcgPSBiZHdfaW5pdF9jbG9ja19n
YXRpbmc7Cj4gKwllbHNlIGlmIChJU19DSEVSUllWSUVXKGk5MTUpKQo+ICsJCWk5MTUtPmRpc3Bs
YXkuaW5pdF9jbG9ja19nYXRpbmcgPSBjaHZfaW5pdF9jbG9ja19nYXRpbmc7Cj4gKwllbHNlIGlm
IChJU19IQVNXRUxMKGk5MTUpKQo+ICsJCWk5MTUtPmRpc3BsYXkuaW5pdF9jbG9ja19nYXRpbmcg
PSBoc3dfaW5pdF9jbG9ja19nYXRpbmc7Cj4gKwllbHNlIGlmIChJU19JVllCUklER0UoaTkxNSkp
Cj4gKwkJaTkxNS0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGl2Yl9pbml0X2Nsb2NrX2dh
dGluZzsKPiArCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkpCj4gKwkJaTkxNS0+ZGlzcGxh
eS5pbml0X2Nsb2NrX2dhdGluZyA9IHZsdl9pbml0X2Nsb2NrX2dhdGluZzsKPiArCWVsc2UgaWYg
KElTX0dFTihpOTE1LCA2KSkKPiArCQlpOTE1LT5kaXNwbGF5LmluaXRfY2xvY2tfZ2F0aW5nID0g
Z2VuNl9pbml0X2Nsb2NrX2dhdGluZzsKPiArCWVsc2UgaWYgKElTX0dFTihpOTE1LCA1KSkKPiAr
CQlpOTE1LT5kaXNwbGF5LmluaXRfY2xvY2tfZ2F0aW5nID0gaWxrX2luaXRfY2xvY2tfZ2F0aW5n
Owo+ICsJZWxzZSBpZiAoSVNfRzRYKGk5MTUpKQo+ICsJCWk5MTUtPmRpc3BsYXkuaW5pdF9jbG9j
a19nYXRpbmcgPSBnNHhfaW5pdF9jbG9ja19nYXRpbmc7Cj4gKwllbHNlIGlmIChJU19JOTY1R00o
aTkxNSkpCj4gKwkJaTkxNS0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGk5NjVnbV9pbml0
X2Nsb2NrX2dhdGluZzsKPiArCWVsc2UgaWYgKElTX0k5NjVHKGk5MTUpKQo+ICsJCWk5MTUtPmRp
c3BsYXkuaW5pdF9jbG9ja19nYXRpbmcgPSBpOTY1Z19pbml0X2Nsb2NrX2dhdGluZzsKPiArCWVs
c2UgaWYgKElTX0dFTihpOTE1LCAzKSkKPiArCQlpOTE1LT5kaXNwbGF5LmluaXRfY2xvY2tfZ2F0
aW5nID0gZ2VuM19pbml0X2Nsb2NrX2dhdGluZzsKPiArCWVsc2UgaWYgKElTX0k4NVgoaTkxNSkg
fHwgSVNfSTg2NUcoaTkxNSkpCj4gKwkJaTkxNS0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9
IGk4NXhfaW5pdF9jbG9ja19nYXRpbmc7Cj4gKwllbHNlIGlmIChJU19HRU4oaTkxNSwgMikpCj4g
KwkJaTkxNS0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGk4MzBfaW5pdF9jbG9ja19nYXRp
bmc7Cj4gICAJZWxzZSB7Cj4gLQkJTUlTU0lOR19DQVNFKElOVEVMX0RFVklEKGRldl9wcml2KSk7
Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuaW5pdF9jbG9ja19nYXRpbmcgPSBub3BfaW5pdF9jbG9j
a19nYXRpbmc7Cj4gKwkJTUlTU0lOR19DQVNFKElOVEVMX0RFVklEKGk5MTUpKTsKPiArCQlpOTE1
LT5kaXNwbGF5LmluaXRfY2xvY2tfZ2F0aW5nID0gbm9wX2luaXRfY2xvY2tfZ2F0aW5nOwo+ICAg
CX0KPiAgIH0KPiAgIAo+ICAgLyogU2V0IHVwIGNoaXAgc3BlY2lmaWMgcG93ZXIgbWFuYWdlbWVu
dC1yZWxhdGVkIGZ1bmN0aW9ucyAqLwo+IC12b2lkIGludGVsX2luaXRfcG0oc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2b2lkIGludGVsX2luaXRfcG0oc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJLyogRm9yIGN4c3IgKi8KPiAtCWlmIChJU19Q
SU5FVklFVyhkZXZfcHJpdikpCj4gLQkJaTkxNV9waW5ldmlld19nZXRfbWVtX2ZyZXEoZGV2X3By
aXYpOwo+IC0JZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCA1KSkKPiAtCQlpOTE1X2lyb25sYWtl
X2dldF9tZW1fZnJlcShkZXZfcHJpdik7Cj4gKwlpZiAoSVNfUElORVZJRVcoaTkxNSkpCj4gKwkJ
aTkxNV9waW5ldmlld19nZXRfbWVtX2ZyZXEoaTkxNSk7Cj4gKwllbHNlIGlmIChJU19HRU4oaTkx
NSwgNSkpCj4gKwkJaTkxNV9pcm9ubGFrZV9nZXRfbWVtX2ZyZXEoaTkxNSk7Cj4gICAKPiAgIAkv
KiBGb3IgRklGTyB3YXRlcm1hcmsgdXBkYXRlcyAqLwo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJp
dikgPj0gOSkgewo+IC0JCXNrbF9zZXR1cF93bV9sYXRlbmN5KGRldl9wcml2KTsKPiAtCQlkZXZf
cHJpdi0+ZGlzcGxheS5pbml0aWFsX3dhdGVybWFya3MgPSBza2xfaW5pdGlhbF93bTsKPiAtCQlk
ZXZfcHJpdi0+ZGlzcGxheS5hdG9taWNfdXBkYXRlX3dhdGVybWFya3MgPSBza2xfYXRvbWljX3Vw
ZGF0ZV9jcnRjX3dtOwo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmNvbXB1dGVfZ2xvYmFsX3dhdGVy
bWFya3MgPSBza2xfY29tcHV0ZV93bTsKPiAtCX0gZWxzZSBpZiAoSEFTX1BDSF9TUExJVChkZXZf
cHJpdikpIHsKPiAtCQlpbGtfc2V0dXBfd21fbGF0ZW5jeShkZXZfcHJpdik7Cj4gLQo+IC0JCWlm
ICgoSVNfR0VOKGRldl9wcml2LCA1KSAmJiBkZXZfcHJpdi0+d20ucHJpX2xhdGVuY3lbMV0gJiYK
PiAtCQkgICAgIGRldl9wcml2LT53bS5zcHJfbGF0ZW5jeVsxXSAmJiBkZXZfcHJpdi0+d20uY3Vy
X2xhdGVuY3lbMV0pIHx8Cj4gLQkJICAgICghSVNfR0VOKGRldl9wcml2LCA1KSAmJiBkZXZfcHJp
di0+d20ucHJpX2xhdGVuY3lbMF0gJiYKPiAtCQkgICAgIGRldl9wcml2LT53bS5zcHJfbGF0ZW5j
eVswXSAmJiBkZXZfcHJpdi0+d20uY3VyX2xhdGVuY3lbMF0pKSB7Cj4gLQkJCWRldl9wcml2LT5k
aXNwbGF5LmNvbXB1dGVfcGlwZV93bSA9IGlsa19jb21wdXRlX3BpcGVfd207Cj4gLQkJCWRldl9w
cml2LT5kaXNwbGF5LmNvbXB1dGVfaW50ZXJtZWRpYXRlX3dtID0KPiArCWlmIChJTlRFTF9HRU4o
aTkxNSkgPj0gOSkgewo+ICsJCXNrbF9zZXR1cF93bV9sYXRlbmN5KGk5MTUpOwo+ICsJCWk5MTUt
PmRpc3BsYXkuaW5pdGlhbF93YXRlcm1hcmtzID0gc2tsX2luaXRpYWxfd207Cj4gKwkJaTkxNS0+
ZGlzcGxheS5hdG9taWNfdXBkYXRlX3dhdGVybWFya3MgPSBza2xfYXRvbWljX3VwZGF0ZV9jcnRj
X3dtOwo+ICsJCWk5MTUtPmRpc3BsYXkuY29tcHV0ZV9nbG9iYWxfd2F0ZXJtYXJrcyA9IHNrbF9j
b21wdXRlX3dtOwo+ICsJfSBlbHNlIGlmIChIQVNfUENIX1NQTElUKGk5MTUpKSB7Cj4gKwkJaWxr
X3NldHVwX3dtX2xhdGVuY3koaTkxNSk7Cj4gKwo+ICsJCWlmICgoSVNfR0VOKGk5MTUsIDUpICYm
IGk5MTUtPndtLnByaV9sYXRlbmN5WzFdICYmCj4gKwkJICAgICBpOTE1LT53bS5zcHJfbGF0ZW5j
eVsxXSAmJiBpOTE1LT53bS5jdXJfbGF0ZW5jeVsxXSkgfHwKPiArCQkgICAgKCFJU19HRU4oaTkx
NSwgNSkgJiYgaTkxNS0+d20ucHJpX2xhdGVuY3lbMF0gJiYKPiArCQkgICAgIGk5MTUtPndtLnNw
cl9sYXRlbmN5WzBdICYmIGk5MTUtPndtLmN1cl9sYXRlbmN5WzBdKSkgewo+ICsJCQlpOTE1LT5k
aXNwbGF5LmNvbXB1dGVfcGlwZV93bSA9IGlsa19jb21wdXRlX3BpcGVfd207Cj4gKwkJCWk5MTUt
PmRpc3BsYXkuY29tcHV0ZV9pbnRlcm1lZGlhdGVfd20gPQo+ICAgCQkJCWlsa19jb21wdXRlX2lu
dGVybWVkaWF0ZV93bTsKPiAtCQkJZGV2X3ByaXYtPmRpc3BsYXkuaW5pdGlhbF93YXRlcm1hcmtz
ID0KPiArCQkJaTkxNS0+ZGlzcGxheS5pbml0aWFsX3dhdGVybWFya3MgPQo+ICAgCQkJCWlsa19p
bml0aWFsX3dhdGVybWFya3M7Cj4gLQkJCWRldl9wcml2LT5kaXNwbGF5Lm9wdGltaXplX3dhdGVy
bWFya3MgPQo+ICsJCQlpOTE1LT5kaXNwbGF5Lm9wdGltaXplX3dhdGVybWFya3MgPQo+ICAgCQkJ
CWlsa19vcHRpbWl6ZV93YXRlcm1hcmtzOwo+ICAgCQl9IGVsc2Ugewo+ICAgCQkJRFJNX0RFQlVH
X0tNUygiRmFpbGVkIHRvIHJlYWQgZGlzcGxheSBwbGFuZSBsYXRlbmN5LiAiCj4gICAJCQkJICAg
ICAgIkRpc2FibGUgQ3hTUlxuIik7Cj4gICAJCX0KPiAtCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklF
VyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiAtCQl2bHZfc2V0dXBf
d21fbGF0ZW5jeShkZXZfcHJpdik7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuY29tcHV0ZV9waXBl
X3dtID0gdmx2X2NvbXB1dGVfcGlwZV93bTsKPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5jb21wdXRl
X2ludGVybWVkaWF0ZV93bSA9IHZsdl9jb21wdXRlX2ludGVybWVkaWF0ZV93bTsKPiAtCQlkZXZf
cHJpdi0+ZGlzcGxheS5pbml0aWFsX3dhdGVybWFya3MgPSB2bHZfaW5pdGlhbF93YXRlcm1hcmtz
Owo+IC0JCWRldl9wcml2LT5kaXNwbGF5Lm9wdGltaXplX3dhdGVybWFya3MgPSB2bHZfb3B0aW1p
emVfd2F0ZXJtYXJrczsKPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5hdG9taWNfdXBkYXRlX3dhdGVy
bWFya3MgPSB2bHZfYXRvbWljX3VwZGF0ZV9maWZvOwo+IC0JfSBlbHNlIGlmIChJU19HNFgoZGV2
X3ByaXYpKSB7Cj4gLQkJZzR4X3NldHVwX3dtX2xhdGVuY3koZGV2X3ByaXYpOwo+IC0JCWRldl9w
cml2LT5kaXNwbGF5LmNvbXB1dGVfcGlwZV93bSA9IGc0eF9jb21wdXRlX3BpcGVfd207Cj4gLQkJ
ZGV2X3ByaXYtPmRpc3BsYXkuY29tcHV0ZV9pbnRlcm1lZGlhdGVfd20gPSBnNHhfY29tcHV0ZV9p
bnRlcm1lZGlhdGVfd207Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuaW5pdGlhbF93YXRlcm1hcmtz
ID0gZzR4X2luaXRpYWxfd2F0ZXJtYXJrczsKPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5vcHRpbWl6
ZV93YXRlcm1hcmtzID0gZzR4X29wdGltaXplX3dhdGVybWFya3M7Cj4gLQl9IGVsc2UgaWYgKElT
X1BJTkVWSUVXKGRldl9wcml2KSkgewo+IC0JCWlmICghaW50ZWxfZ2V0X2N4c3JfbGF0ZW5jeSgh
SVNfTU9CSUxFKGRldl9wcml2KSwKPiAtCQkJCQkgICAgZGV2X3ByaXYtPmlzX2RkcjMsCj4gLQkJ
CQkJICAgIGRldl9wcml2LT5mc2JfZnJlcSwKPiAtCQkJCQkgICAgZGV2X3ByaXYtPm1lbV9mcmVx
KSkgewo+ICsJfSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVco
aTkxNSkpIHsKPiArCQl2bHZfc2V0dXBfd21fbGF0ZW5jeShpOTE1KTsKPiArCQlpOTE1LT5kaXNw
bGF5LmNvbXB1dGVfcGlwZV93bSA9IHZsdl9jb21wdXRlX3BpcGVfd207Cj4gKwkJaTkxNS0+ZGlz
cGxheS5jb21wdXRlX2ludGVybWVkaWF0ZV93bSA9IHZsdl9jb21wdXRlX2ludGVybWVkaWF0ZV93
bTsKPiArCQlpOTE1LT5kaXNwbGF5LmluaXRpYWxfd2F0ZXJtYXJrcyA9IHZsdl9pbml0aWFsX3dh
dGVybWFya3M7Cj4gKwkJaTkxNS0+ZGlzcGxheS5vcHRpbWl6ZV93YXRlcm1hcmtzID0gdmx2X29w
dGltaXplX3dhdGVybWFya3M7Cj4gKwkJaTkxNS0+ZGlzcGxheS5hdG9taWNfdXBkYXRlX3dhdGVy
bWFya3MgPSB2bHZfYXRvbWljX3VwZGF0ZV9maWZvOwo+ICsJfSBlbHNlIGlmIChJU19HNFgoaTkx
NSkpIHsKPiArCQlnNHhfc2V0dXBfd21fbGF0ZW5jeShpOTE1KTsKPiArCQlpOTE1LT5kaXNwbGF5
LmNvbXB1dGVfcGlwZV93bSA9IGc0eF9jb21wdXRlX3BpcGVfd207Cj4gKwkJaTkxNS0+ZGlzcGxh
eS5jb21wdXRlX2ludGVybWVkaWF0ZV93bSA9IGc0eF9jb21wdXRlX2ludGVybWVkaWF0ZV93bTsK
PiArCQlpOTE1LT5kaXNwbGF5LmluaXRpYWxfd2F0ZXJtYXJrcyA9IGc0eF9pbml0aWFsX3dhdGVy
bWFya3M7Cj4gKwkJaTkxNS0+ZGlzcGxheS5vcHRpbWl6ZV93YXRlcm1hcmtzID0gZzR4X29wdGlt
aXplX3dhdGVybWFya3M7Cj4gKwl9IGVsc2UgaWYgKElTX1BJTkVWSUVXKGk5MTUpKSB7Cj4gKwkJ
aWYgKCFpbnRlbF9nZXRfY3hzcl9sYXRlbmN5KCFJU19NT0JJTEUoaTkxNSksCj4gKwkJCQkJICAg
IGk5MTUtPmlzX2RkcjMsCj4gKwkJCQkJICAgIGk5MTUtPmZzYl9mcmVxLAo+ICsJCQkJCSAgICBp
OTE1LT5tZW1fZnJlcSkpIHsKPiAgIAkJCURSTV9JTkZPKCJmYWlsZWQgdG8gZmluZCBrbm93biBD
eFNSIGxhdGVuY3kgIgo+ICAgCQkJCSAiKGZvdW5kIGRkciVzIGZzYiBmcmVxICVkLCBtZW0gZnJl
cSAlZCksICIKPiAgIAkJCQkgImRpc2FibGluZyBDeFNSXG4iLAo+IC0JCQkJIChkZXZfcHJpdi0+
aXNfZGRyMyA9PSAxKSA/ICIzIiA6ICIyIiwKPiAtCQkJCSBkZXZfcHJpdi0+ZnNiX2ZyZXEsIGRl
dl9wcml2LT5tZW1fZnJlcSk7Cj4gKwkJCQkgKGk5MTUtPmlzX2RkcjMgPT0gMSkgPyAiMyIgOiAi
MiIsCj4gKwkJCQkgaTkxNS0+ZnNiX2ZyZXEsIGk5MTUtPm1lbV9mcmVxKTsKPiAgIAkJCS8qIERp
c2FibGUgQ3hTUiBhbmQgbmV2ZXIgdXBkYXRlIGl0cyB3YXRlcm1hcmsgYWdhaW4gKi8KPiAtCQkJ
aW50ZWxfc2V0X21lbW9yeV9jeHNyKGRldl9wcml2LCBmYWxzZSk7Cj4gLQkJCWRldl9wcml2LT5k
aXNwbGF5LnVwZGF0ZV93bSA9IE5VTEw7Cj4gKwkJCWludGVsX3NldF9tZW1vcnlfY3hzcihpOTE1
LCBmYWxzZSk7Cj4gKwkJCWk5MTUtPmRpc3BsYXkudXBkYXRlX3dtID0gTlVMTDsKPiAgIAkJfSBl
bHNlCj4gLQkJCWRldl9wcml2LT5kaXNwbGF5LnVwZGF0ZV93bSA9IHBpbmV2aWV3X3VwZGF0ZV93
bTsKPiAtCX0gZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCA0KSkgewo+IC0JCWRldl9wcml2LT5k
aXNwbGF5LnVwZGF0ZV93bSA9IGk5NjVfdXBkYXRlX3dtOwo+IC0JfSBlbHNlIGlmIChJU19HRU4o
ZGV2X3ByaXYsIDMpKSB7Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkudXBkYXRlX3dtID0gaTl4eF91
cGRhdGVfd207Cj4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X2ZpZm9fc2l6ZSA9IGk5eHhfZ2V0
X2ZpZm9fc2l6ZTsKPiAtCX0gZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCAyKSkgewo+IC0JCWlm
IChJTlRFTF9JTkZPKGRldl9wcml2KS0+bnVtX3BpcGVzID09IDEpIHsKPiAtCQkJZGV2X3ByaXYt
PmRpc3BsYXkudXBkYXRlX3dtID0gaTg0NV91cGRhdGVfd207Cj4gLQkJCWRldl9wcml2LT5kaXNw
bGF5LmdldF9maWZvX3NpemUgPSBpODQ1X2dldF9maWZvX3NpemU7Cj4gKwkJCWk5MTUtPmRpc3Bs
YXkudXBkYXRlX3dtID0gcGluZXZpZXdfdXBkYXRlX3dtOwo+ICsJfSBlbHNlIGlmIChJU19HRU4o
aTkxNSwgNCkpIHsKPiArCQlpOTE1LT5kaXNwbGF5LnVwZGF0ZV93bSA9IGk5NjVfdXBkYXRlX3dt
Owo+ICsJfSBlbHNlIGlmIChJU19HRU4oaTkxNSwgMykpIHsKPiArCQlpOTE1LT5kaXNwbGF5LnVw
ZGF0ZV93bSA9IGk5eHhfdXBkYXRlX3dtOwo+ICsJCWk5MTUtPmRpc3BsYXkuZ2V0X2ZpZm9fc2l6
ZSA9IGk5eHhfZ2V0X2ZpZm9fc2l6ZTsKPiArCX0gZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDIpKSB7
Cj4gKwkJaWYgKElOVEVMX0lORk8oaTkxNSktPm51bV9waXBlcyA9PSAxKSB7Cj4gKwkJCWk5MTUt
PmRpc3BsYXkudXBkYXRlX3dtID0gaTg0NV91cGRhdGVfd207Cj4gKwkJCWk5MTUtPmRpc3BsYXku
Z2V0X2ZpZm9fc2l6ZSA9IGk4NDVfZ2V0X2ZpZm9fc2l6ZTsKPiAgIAkJfSBlbHNlIHsKPiAtCQkJ
ZGV2X3ByaXYtPmRpc3BsYXkudXBkYXRlX3dtID0gaTl4eF91cGRhdGVfd207Cj4gLQkJCWRldl9w
cml2LT5kaXNwbGF5LmdldF9maWZvX3NpemUgPSBpODMwX2dldF9maWZvX3NpemU7Cj4gKwkJCWk5
MTUtPmRpc3BsYXkudXBkYXRlX3dtID0gaTl4eF91cGRhdGVfd207Cj4gKwkJCWk5MTUtPmRpc3Bs
YXkuZ2V0X2ZpZm9fc2l6ZSA9IGk4MzBfZ2V0X2ZpZm9fc2l6ZTsKPiAgIAkJfQo+ICAgCX0gZWxz
ZSB7Cj4gICAJCURSTV9FUlJPUigidW5leHBlY3RlZCBmYWxsLXRocm91Z2ggaW4gaW50ZWxfaW5p
dF9wbVxuIik7Cj4gICAJfQo+ICAgfQo+ICAgCj4gLXN0YXRpYyBpbnQgYnl0X2dwdV9mcmVxKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50IHZhbCkKPiArc3RhdGljIGludCBi
eXRfZ3B1X2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGludCB2YWwpCj4gICB7
Cj4gLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKPiArCXN0
cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1LT5ndF9wbS5ycHM7Cj4gICAKPiAgIAkvKgo+ICAg
CSAqIE4gPSB2YWwgLSAweGI3Cj4gQEAgLTk3NTYsMTYgKzk3NTYsMTYgQEAgc3RhdGljIGludCBi
eXRfZ3B1X2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgdmFsKQo+
ICAgCXJldHVybiBESVZfUk9VTkRfQ0xPU0VTVChycHMtPmdwbGxfcmVmX2ZyZXEgKiAodmFsIC0g
MHhiNyksIDEwMDApOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBpbnQgYnl0X2ZyZXFfb3Bjb2RlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50IHZhbCkKPiArc3RhdGljIGludCBi
eXRfZnJlcV9vcGNvZGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGludCB2YWwpCj4g
ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKPiAr
CXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1LT5ndF9wbS5ycHM7Cj4gICAKPiAgIAlyZXR1
cm4gRElWX1JPVU5EX0NMT1NFU1QoMTAwMCAqIHZhbCwgcnBzLT5ncGxsX3JlZl9mcmVxKSArIDB4
Yjc7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGludCBjaHZfZ3B1X2ZyZXEoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgdmFsKQo+ICtzdGF0aWMgaW50IGNodl9ncHVfZnJlcShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50IHZhbCkKPiAgIHsKPiAtCXN0cnVjdCBp
bnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwo+ICsJc3RydWN0IGludGVsX3Jw
cyAqcnBzID0gJmk5MTUtPmd0X3BtLnJwczsKPiAgIAo+ICAgCS8qCj4gICAJICogTiA9IHZhbCAv
IDIKPiBAQCAtOTc3NCw1MiArOTc3NCw1MiBAQCBzdGF0aWMgaW50IGNodl9ncHVfZnJlcShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCB2YWwpCj4gICAJcmV0dXJuIERJVl9S
T1VORF9DTE9TRVNUKHJwcy0+Z3BsbF9yZWZfZnJlcSAqIHZhbCwgMiAqIDIgKiAxMDAwKTsKPiAg
IH0KPiAgIAo+IC1zdGF0aWMgaW50IGNodl9mcmVxX29wY29kZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsIGludCB2YWwpCj4gK3N0YXRpYyBpbnQgY2h2X2ZyZXFfb3Bjb2RlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBpbnQgdmFsKQo+ICAgewo+IC0Jc3RydWN0IGlu
dGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Cj4gKwlzdHJ1Y3QgaW50ZWxfcnBz
ICpycHMgPSAmaTkxNS0+Z3RfcG0ucnBzOwo+ICAgCj4gICAJLyogQ0hWIG5lZWRzIGV2ZW4gdmFs
dWVzICovCj4gICAJcmV0dXJuIERJVl9ST1VORF9DTE9TRVNUKDIgKiAxMDAwICogdmFsLCBycHMt
PmdwbGxfcmVmX2ZyZXEpICogMjsKPiAgIH0KPiAgIAo+IC1pbnQgaW50ZWxfZ3B1X2ZyZXEoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgdmFsKQo+ICtpbnQgaW50ZWxfZ3B1
X2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGludCB2YWwpCj4gICB7Cj4gLQlp
ZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5
KQo+ICAgCQlyZXR1cm4gRElWX1JPVU5EX0NMT1NFU1QodmFsICogR1RfRlJFUVVFTkNZX01VTFRJ
UExJRVIsCj4gICAJCQkJCSBHRU45X0ZSRVFfU0NBTEVSKTsKPiAtCWVsc2UgaWYgKElTX0NIRVJS
WVZJRVcoZGV2X3ByaXYpKQo+IC0JCXJldHVybiBjaHZfZ3B1X2ZyZXEoZGV2X3ByaXYsIHZhbCk7
Cj4gLQllbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkKPiAtCQlyZXR1cm4gYnl0X2dw
dV9mcmVxKGRldl9wcml2LCB2YWwpOwo+ICsJZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkK
PiArCQlyZXR1cm4gY2h2X2dwdV9mcmVxKGk5MTUsIHZhbCk7Cj4gKwllbHNlIGlmIChJU19WQUxM
RVlWSUVXKGk5MTUpKQo+ICsJCXJldHVybiBieXRfZ3B1X2ZyZXEoaTkxNSwgdmFsKTsKPiAgIAll
bHNlCj4gICAJCXJldHVybiB2YWwgKiBHVF9GUkVRVUVOQ1lfTVVMVElQTElFUjsKPiAgIH0KPiAg
IAo+IC1pbnQgaW50ZWxfZnJlcV9vcGNvZGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LCBpbnQgdmFsKQo+ICtpbnQgaW50ZWxfZnJlcV9vcGNvZGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsIGludCB2YWwpCj4gICB7Cj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+
PSA5KQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ICAgCQlyZXR1cm4gRElWX1JPVU5E
X0NMT1NFU1QodmFsICogR0VOOV9GUkVRX1NDQUxFUiwKPiAgIAkJCQkJIEdUX0ZSRVFVRU5DWV9N
VUxUSVBMSUVSKTsKPiAtCWVsc2UgaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+IC0JCXJl
dHVybiBjaHZfZnJlcV9vcGNvZGUoZGV2X3ByaXYsIHZhbCk7Cj4gLQllbHNlIGlmIChJU19WQUxM
RVlWSUVXKGRldl9wcml2KSkKPiAtCQlyZXR1cm4gYnl0X2ZyZXFfb3Bjb2RlKGRldl9wcml2LCB2
YWwpOwo+ICsJZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiArCQlyZXR1cm4gY2h2X2Zy
ZXFfb3Bjb2RlKGk5MTUsIHZhbCk7Cj4gKwllbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpKQo+
ICsJCXJldHVybiBieXRfZnJlcV9vcGNvZGUoaTkxNSwgdmFsKTsKPiAgIAllbHNlCj4gICAJCXJl
dHVybiBESVZfUk9VTkRfQ0xPU0VTVCh2YWwsIEdUX0ZSRVFVRU5DWV9NVUxUSVBMSUVSKTsKPiAg
IH0KPiAgIAo+IC12b2lkIGludGVsX3BtX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiArdm9pZCBpbnRlbF9wbV9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiAgIHsKPiAtCW11dGV4X2luaXQoJmRldl9wcml2LT5ndF9wbS5ycHMubG9jayk7Cj4g
LQltdXRleF9pbml0KCZkZXZfcHJpdi0+Z3RfcG0ucnBzLnBvd2VyLm11dGV4KTsKPiArCW11dGV4
X2luaXQoJmk5MTUtPmd0X3BtLnJwcy5sb2NrKTsKPiArCW11dGV4X2luaXQoJmk5MTUtPmd0X3Bt
LnJwcy5wb3dlci5tdXRleCk7Cj4gICAKPiAtCWF0b21pY19zZXQoJmRldl9wcml2LT5ndF9wbS5y
cHMubnVtX3dhaXRlcnMsIDApOwo+ICsJYXRvbWljX3NldCgmaTkxNS0+Z3RfcG0ucnBzLm51bV93
YWl0ZXJzLCAwKTsKPiAgIAo+IC0JZGV2X3ByaXYtPnJ1bnRpbWVfcG0uc3VzcGVuZGVkID0gZmFs
c2U7Cj4gLQlhdG9taWNfc2V0KCZkZXZfcHJpdi0+cnVudGltZV9wbS53YWtlcmVmX2NvdW50LCAw
KTsKPiArCWk5MTUtPnJ1bnRpbWVfcG0uc3VzcGVuZGVkID0gZmFsc2U7Cj4gKwlhdG9taWNfc2V0
KCZpOTE1LT5ydW50aW1lX3BtLndha2VyZWZfY291bnQsIDApOwo+ICAgfQo+ICAgCj4gLXN0YXRp
YyB1NjQgdmx2X3Jlc2lkZW5jeV9yYXcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ICtzdGF0aWMgdTY0IHZsdl9yZXNpZGVuY3lfcmF3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAo+ICAgCQkJICAgICBjb25zdCBpOTE1X3JlZ190IHJlZykKPiAgIHsKPiAgIAl1MzIg
bG93ZXIsIHVwcGVyLCB0bXA7Cj4gQEAgLTk4MjksNyArOTgyOSw3IEBAIHN0YXRpYyB1NjQgdmx2
X3Jlc2lkZW5jeV9yYXcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCSAq
IFRoZSByZWdpc3RlciBhY2Nlc3NlZCBkbyBub3QgbmVlZCBmb3JjZXdha2UuIFdlIGJvcnJvdwo+
ICAgCSAqIHVuY29yZSBsb2NrIHRvIHByZXZlbnQgY29uY3VycmVudCBhY2Nlc3MgdG8gcmFuZ2Ug
cmVnLgo+ICAgCSAqLwo+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPnVuY29yZS5s
b2NrKTsKPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPnVuY29yZS5sb2NrKTsKPiAgIAo+
ICAgCS8qCj4gICAJICogdmx2IGFuZCBjaHYgcmVzaWRlbmN5IGNvdW50ZXJzIGFyZSA0MCBiaXRz
IGluIHdpZHRoLgo+IEBAIC05ODY1LDE3ICs5ODY1LDE3IEBAIHN0YXRpYyB1NjQgdmx2X3Jlc2lk
ZW5jeV9yYXcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCXJldHVybiBs
b3dlciB8ICh1NjQpdXBwZXIgPDwgODsKPiAgIH0KPiAgIAo+IC11NjQgaW50ZWxfcmM2X3Jlc2lk
ZW5jeV9ucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3U2NCBpbnRlbF9y
YzZfcmVzaWRlbmN5X25zKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAg
Y29uc3QgaTkxNV9yZWdfdCByZWcpCj4gICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNv
cmUgPSAmZGV2X3ByaXYtPnVuY29yZTsKPiArCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9
ICZpOTE1LT51bmNvcmU7Cj4gICAJdTY0IHRpbWVfaHcsIHByZXZfaHcsIG92ZXJmbG93X2h3Owo+
ICAgCXVuc2lnbmVkIGludCBmd19kb21haW5zOwo+ICAgCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4g
ICAJdW5zaWduZWQgaW50IGk7Cj4gICAJdTMyIG11bCwgZGl2Owo+ICAgCj4gLQlpZiAoIUhBU19S
QzYoZGV2X3ByaXYpKQo+ICsJaWYgKCFIQVNfUkM2KGk5MTUpKQo+ICAgCQlyZXR1cm4gMDsKPiAg
IAo+ICAgCS8qCj4gQEAgLTk4ODcsNyArOTg4Nyw3IEBAIHU2NCBpbnRlbF9yYzZfcmVzaWRlbmN5
X25zKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkgKi8KPiAgIAlpID0g
KGk5MTVfbW1pb19yZWdfb2Zmc2V0KHJlZykgLQo+ICAgCSAgICAgaTkxNV9tbWlvX3JlZ19vZmZz
ZXQoR0VONl9HVF9HRlhfUkM2X0xPQ0tFRCkpIC8gc2l6ZW9mKHUzMik7Cj4gLQlpZiAoV0FSTl9P
Tl9PTkNFKGkgPj0gQVJSQVlfU0laRShkZXZfcHJpdi0+Z3RfcG0ucmM2LmN1cl9yZXNpZGVuY3kp
KSkKPiArCWlmIChXQVJOX09OX09OQ0UoaSA+PSBBUlJBWV9TSVpFKGk5MTUtPmd0X3BtLnJjNi5j
dXJfcmVzaWRlbmN5KSkpCj4gICAJCXJldHVybiAwOwo+ICAgCj4gICAJZndfZG9tYWlucyA9IGlu
dGVsX3VuY29yZV9mb3JjZXdha2VfZm9yX3JlZyh1bmNvcmUsIHJlZywgRldfUkVHX1JFQUQpOwo+
IEBAIC05ODk2LDE0ICs5ODk2LDE0IEBAIHU2NCBpbnRlbF9yYzZfcmVzaWRlbmN5X25zKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlpbnRlbF91bmNvcmVfZm9yY2V3YWtl
X2dldF9fbG9ja2VkKHVuY29yZSwgZndfZG9tYWlucyk7Cj4gICAKPiAgIAkvKiBPbiBWTFYgYW5k
IENIViwgcmVzaWRlbmN5IHRpbWUgaXMgaW4gQ1ogdW5pdHMgcmF0aGVyIHRoYW4gMS4yOHVzICov
Cj4gLQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJp
dikpIHsKPiArCWlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkp
IHsKPiAgIAkJbXVsID0gMTAwMDAwMDsKPiAtCQlkaXYgPSBkZXZfcHJpdi0+Y3pjbGtfZnJlcTsK
PiArCQlkaXYgPSBpOTE1LT5jemNsa19mcmVxOwo+ICAgCQlvdmVyZmxvd19odyA9IEJJVF9VTEwo
NDApOwo+IC0JCXRpbWVfaHcgPSB2bHZfcmVzaWRlbmN5X3JhdyhkZXZfcHJpdiwgcmVnKTsKPiAr
CQl0aW1lX2h3ID0gdmx2X3Jlc2lkZW5jeV9yYXcoaTkxNSwgcmVnKTsKPiAgIAl9IGVsc2Ugewo+
ICAgCQkvKiA4MzMuMzNucyB1bml0cyBvbiBHZW45TFAsIDEuMjh1cyBlbHNld2hlcmUuICovCj4g
LQkJaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKSB7Cj4gKwkJaWYgKElTX0dFTjlfTFAoaTkxNSkp
IHsKPiAgIAkJCW11bCA9IDEwMDAwOwo+ICAgCQkJZGl2ID0gMTI7Cj4gICAJCX0gZWxzZSB7Cj4g
QEAgLTk5MjEsOCArOTkyMSw4IEBAIHU2NCBpbnRlbF9yYzZfcmVzaWRlbmN5X25zKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkgKiBCdXQgcmVseWluZyBvbiBhIHN1ZmZp
Y2llbnQgZnJlcXVlbmN5IG9mIHF1ZXJpZXMgb3RoZXJ3aXNlIGNvdW50ZXJzCj4gICAJICogY2Fu
IHN0aWxsIHdyYXAuCj4gICAJICovCj4gLQlwcmV2X2h3ID0gZGV2X3ByaXYtPmd0X3BtLnJjNi5w
cmV2X2h3X3Jlc2lkZW5jeVtpXTsKPiAtCWRldl9wcml2LT5ndF9wbS5yYzYucHJldl9od19yZXNp
ZGVuY3lbaV0gPSB0aW1lX2h3Owo+ICsJcHJldl9odyA9IGk5MTUtPmd0X3BtLnJjNi5wcmV2X2h3
X3Jlc2lkZW5jeVtpXTsKPiArCWk5MTUtPmd0X3BtLnJjNi5wcmV2X2h3X3Jlc2lkZW5jeVtpXSA9
IHRpbWVfaHc7Cj4gICAKPiAgIAkvKiBSQzYgZGVsdGEgZnJvbSBsYXN0IHNhbXBsZS4gKi8KPiAg
IAlpZiAodGltZV9odyA+PSBwcmV2X2h3KQo+IEBAIC05OTMxLDggKzk5MzEsOCBAQCB1NjQgaW50
ZWxfcmM2X3Jlc2lkZW5jeV9ucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
ICAJCXRpbWVfaHcgKz0gb3ZlcmZsb3dfaHcgLSBwcmV2X2h3Owo+ICAgCj4gICAJLyogQWRkIGRl
bHRhIHRvIFJDNiBleHRlbmRlZCByYXcgZHJpdmVyIGNvcHkuICovCj4gLQl0aW1lX2h3ICs9IGRl
dl9wcml2LT5ndF9wbS5yYzYuY3VyX3Jlc2lkZW5jeVtpXTsKPiAtCWRldl9wcml2LT5ndF9wbS5y
YzYuY3VyX3Jlc2lkZW5jeVtpXSA9IHRpbWVfaHc7Cj4gKwl0aW1lX2h3ICs9IGk5MTUtPmd0X3Bt
LnJjNi5jdXJfcmVzaWRlbmN5W2ldOwo+ICsJaTkxNS0+Z3RfcG0ucmM2LmN1cl9yZXNpZGVuY3lb
aV0gPSB0aW1lX2h3Owo+ICAgCj4gICAJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXRfX2xvY2tl
ZCh1bmNvcmUsIGZ3X2RvbWFpbnMpOwo+ICAgCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnVuY29y
ZS0+bG9jaywgZmxhZ3MpOwo+IEBAIC05OTQwLDE5ICs5OTQwLDE5IEBAIHU2NCBpbnRlbF9yYzZf
cmVzaWRlbmN5X25zKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlyZXR1
cm4gbXVsX3U2NF91MzJfZGl2KHRpbWVfaHcsIG11bCwgZGl2KTsKPiAgIH0KPiAgIAo+IC11NjQg
aW50ZWxfcmM2X3Jlc2lkZW5jeV91cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gK3U2NCBpbnRlbF9yYzZfcmVzaWRlbmN5X3VzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ICAgCQkJICAgaTkxNV9yZWdfdCByZWcpCj4gICB7Cj4gLQlyZXR1cm4gRElWX1JPVU5E
X1VQX1VMTChpbnRlbF9yYzZfcmVzaWRlbmN5X25zKGRldl9wcml2LCByZWcpLCAxMDAwKTsKPiAr
CXJldHVybiBESVZfUk9VTkRfVVBfVUxMKGludGVsX3JjNl9yZXNpZGVuY3lfbnMoaTkxNSwgcmVn
KSwgMTAwMCk7Cj4gICB9Cj4gICAKPiAtdTMyIGludGVsX2dldF9jYWdmKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIHJwc3RhdCkKPiArdTMyIGludGVsX2dldF9jYWdmKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgcnBzdGF0KQo+ICAgewo+ICAgCXUzMiBj
YWdmOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KQo+ICsJaWYgKElOVEVM
X0dFTihpOTE1KSA+PSA5KQo+ICAgCQljYWdmID0gKHJwc3RhdCAmIEdFTjlfQ0FHRl9NQVNLKSA+
PiBHRU45X0NBR0ZfU0hJRlQ7Cj4gLQllbHNlIGlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8fCBJ
U19CUk9BRFdFTEwoZGV2X3ByaXYpKQo+ICsJZWxzZSBpZiAoSVNfSEFTV0VMTChpOTE1KSB8fCBJ
U19CUk9BRFdFTEwoaTkxNSkpCj4gICAJCWNhZ2YgPSAocnBzdGF0ICYgSFNXX0NBR0ZfTUFTSykg
Pj4gSFNXX0NBR0ZfU0hJRlQ7Cj4gICAJZWxzZQo+ICAgCQljYWdmID0gKHJwc3RhdCAmIEdFTjZf
Q0FHRl9NQVNLKSA+PiBHRU42X0NBR0ZfU0hJRlQ7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX3BtLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5oCj4g
aW5kZXggMWI0ODlmYTM5OWUxLi5lMmM0ZWRmMjYzZjcgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfcG0uaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X3BtLmgKPiBAQCAtMjIsMzkgKzIyLDM5IEBAIHN0cnVjdCBza2xfZGRiX2VudHJ5Owo+ICAgc3Ry
dWN0IHNrbF9waXBlX3dtOwo+ICAgc3RydWN0IHNrbF93bV9sZXZlbDsKPiAgIAo+IC12b2lkIGlu
dGVsX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7
Cj4gLXZvaWQgaW50ZWxfc3VzcGVuZF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpOwo+IC1pbnQgaWxrX3dtX21heF9sZXZlbChjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpOwo+ICt2b2lkIGludGVsX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KTsKPiArdm9pZCBpbnRlbF9zdXNwZW5kX2h3KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KTsKPiAraW50IGlsa193bV9tYXhfbGV2ZWwoY29uc3Qgc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgdm9pZCBpbnRlbF91cGRhdGVfd2F0ZXJtYXJr
cyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0Yyk7Cj4gLXZvaWQgaW50ZWxfaW5pdF9wbShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGludGVsX2luaXRfY2xvY2tfZ2F0
aW5nX2hvb2tzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gLXZvaWQgaW50
ZWxfcG1fc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtdm9pZCBp
bnRlbF9ncHVfaXBzX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAr
dm9pZCBpbnRlbF9pbml0X3BtKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiArdm9p
ZCBpbnRlbF9pbml0X2Nsb2NrX2dhdGluZ19ob29rcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSk7Cj4gK3ZvaWQgaW50ZWxfcG1fc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpOwo+ICt2b2lkIGludGVsX2dwdV9pcHNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSk7Cj4gICB2b2lkIGludGVsX2dwdV9pcHNfdGVhcmRvd24odm9pZCk7Cj4gLXZvaWQgaW50
ZWxfaW5pdF9ndF9wb3dlcnNhdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsK
PiAtdm9pZCBpbnRlbF9jbGVhbnVwX2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGludGVsX3Nhbml0aXplX2d0X3Bvd2Vyc2F2ZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGludGVsX2VuYWJsZV9ndF9wb3dl
cnNhdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtdm9pZCBpbnRlbF9k
aXNhYmxlX2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+
IC12b2lkIGdlbjZfcnBzX2J1c3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsK
PiAtdm9pZCBnZW42X3Jwc19pZGxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7
Cj4gK3ZvaWQgaW50ZWxfaW5pdF9ndF9wb3dlcnNhdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpOwo+ICt2b2lkIGludGVsX2NsZWFudXBfZ3RfcG93ZXJzYXZlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KTsKPiArdm9pZCBpbnRlbF9zYW5pdGl6ZV9ndF9wb3dlcnNhdmUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lkIGludGVsX2VuYWJsZV9ndF9wb3dl
cnNhdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lkIGludGVsX2Rpc2Fi
bGVfZ3RfcG93ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiArdm9pZCBn
ZW42X3Jwc19idXN5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiArdm9pZCBnZW42
X3Jwc19pZGxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAgIHZvaWQgZ2VuNl9y
cHNfYm9vc3Qoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpOwo+IC12b2lkIGc0eF93bV9nZXRfaHdf
c3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtdm9pZCB2bHZfd21f
Z2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gLXZvaWQg
aWxrX3dtX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+
IC12b2lkIHNrbF93bV9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KTsKPiArdm9pZCBnNHhfd21fZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KTsKPiArdm9pZCB2bHZfd21fZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KTsKPiArdm9pZCBpbGtfd21fZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KTsKPiArdm9pZCBza2xfd21fZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KTsKPiAgIHZvaWQgc2tsX3BpcGVfZGRiX2dldF9od19zdGF0ZShzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgIAkJCSAgICAgICBzdHJ1Y3Qgc2tsX2RkYl9lbnRyeSAq
ZGRiX3ksCj4gICAJCQkgICAgICAgc3RydWN0IHNrbF9kZGJfZW50cnkgKmRkYl91dik7Cj4gLXZv
aWQgc2tsX2RkYl9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ICt2b2lkIHNrbF9kZGJfZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ICAgCQkJICBzdHJ1Y3Qgc2tsX2RkYl9hbGxvY2F0aW9uICpkZGIgLyogb3V0ICovKTsK
PiAgIHZvaWQgc2tsX3BpcGVfd21fZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
LAo+ICAgCQkJICAgICAgc3RydWN0IHNrbF9waXBlX3dtICpvdXQpOwo+IC12b2lkIGc0eF93bV9z
YW5pdGl6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIHZsdl93
bV9zYW5pdGl6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ICt2b2lkIGc0
eF93bV9zYW5pdGl6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgdmx2
X3dtX3Nhbml0aXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAgIGJvb2wgaW50
ZWxfY2FuX2VuYWJsZV9zYWd2KHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSk7Cj4gLWlu
dCBpbnRlbF9lbmFibGVfc2FndihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+
IC1pbnQgaW50ZWxfZGlzYWJsZV9zYWd2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dik7Cj4gK2ludCBpbnRlbF9lbmFibGVfc2FndihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSk7Cj4gK2ludCBpbnRlbF9kaXNhYmxlX3NhZ3Yoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpOwo+ICAgYm9vbCBza2xfd21fbGV2ZWxfZXF1YWxzKGNvbnN0IHN0cnVjdCBza2xfd21fbGV2
ZWwgKmwxLAo+ICAgCQkJIGNvbnN0IHN0cnVjdCBza2xfd21fbGV2ZWwgKmwyKTsKPiAgIGJvb2wg
c2tsX2RkYl9hbGxvY2F0aW9uX292ZXJsYXBzKGNvbnN0IHN0cnVjdCBza2xfZGRiX2VudHJ5ICpk
ZGIsCj4gQEAgLTY3LDI0ICs2NywyNCBAQCB2b2lkIHNrbF93cml0ZV9jdXJzb3Jfd20oc3RydWN0
IGludGVsX3BsYW5lICpwbGFuZSwKPiAgIGJvb2wgaWxrX2Rpc2FibGVfbHBfd20oc3RydWN0IGRy
bV9kZXZpY2UgKmRldik7Cj4gICBpbnQgc2tsX2NoZWNrX3BpcGVfbWF4X3BpeGVsX3JhdGUoc3Ry
dWN0IGludGVsX2NydGMgKmludGVsX2NydGMsCj4gICAJCQkJICBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3N0YXRlKTsKPiAtdm9pZCBpbnRlbF9pbml0X2lwYyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGludGVsX2VuYWJsZV9pcGMoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KTsKPiArdm9pZCBpbnRlbF9pbml0X2lwYyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgaW50ZWxfZW5hYmxlX2lwYyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gICAKPiAtaW50IGludGVsX2dwdV9mcmVxKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50IHZhbCk7Cj4gLWludCBpbnRlbF9mcmVxX29wY29k
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCB2YWwpOwo+IC11NjQgaW50
ZWxfcmM2X3Jlc2lkZW5jeV9ucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGk5
MTVfcmVnX3QgcmVnKTsKPiAtdTY0IGludGVsX3JjNl9yZXNpZGVuY3lfdXMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LCBpOTE1X3JlZ190IHJlZyk7Cj4gK2ludCBpbnRlbF9ncHVf
ZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50IHZhbCk7Cj4gK2ludCBpbnRl
bF9mcmVxX29wY29kZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50IHZhbCk7Cj4g
K3U2NCBpbnRlbF9yYzZfcmVzaWRlbmN5X25zKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LCBpOTE1X3JlZ190IHJlZyk7Cj4gK3U2NCBpbnRlbF9yYzZfcmVzaWRlbmN5X3VzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LCBpOTE1X3JlZ190IHJlZyk7Cj4gICAKPiAtdTMyIGludGVs
X2dldF9jYWdmKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIHJwc3RhdDEp
Owo+ICt1MzIgaW50ZWxfZ2V0X2NhZ2Yoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUz
MiBycHN0YXQxKTsKPiAgIAo+IC11bnNpZ25lZCBsb25nIGk5MTVfY2hpcHNldF92YWwoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtdW5zaWduZWQgbG9uZyBpOTE1X21jaF92
YWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtdW5zaWduZWQgbG9uZyBp
OTE1X2dmeF92YWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtdm9pZCBp
OTE1X3VwZGF0ZV9nZnhfdmFsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4g
K3Vuc2lnbmVkIGxvbmcgaTkxNV9jaGlwc2V0X3ZhbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSk7Cj4gK3Vuc2lnbmVkIGxvbmcgaTkxNV9tY2hfdmFsKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KTsKPiArdW5zaWduZWQgbG9uZyBpOTE1X2dmeF92YWwoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpOwo+ICt2b2lkIGk5MTVfdXBkYXRlX2dmeF92YWwoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgCj4gLWJvb2wgaXJvbmxha2Vfc2V0X2RycHMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1OCB2YWwpOwo+IC1pbnQgaW50ZWxfc2V0X3Jw
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4IHZhbCk7Cj4gK2Jvb2wgaXJv
bmxha2Vfc2V0X2RycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHU4IHZhbCk7Cj4g
K2ludCBpbnRlbF9zZXRfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1OCB2YWwp
Owo+ICAgdm9pZCBpbnRlbF9ycHNfbWFya19pbnRlcmFjdGl2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwgYm9vbCBpbnRlcmFjdGl2ZSk7Cj4gLWJvb2wgaW50ZWxfc2V0X21lbW9yeV9j
eHNyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgYm9vbCBlbmFibGUpOwo+ICti
b29sIGludGVsX3NldF9tZW1vcnlfY3hzcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwg
Ym9vbCBlbmFibGUpOwo+ICAgCj4gICAjZW5kaWYgLyogX19JTlRFTF9QTV9IX18gKi8KPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcHNyLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9wc3IuYwo+IGluZGV4IDAxY2E1MDIwOTlkZi4uMDcyZWVhMDBiMTdhIDEw
MDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3Bzci5jCj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcHNyLmMKPiBAQCAtNzEsMTQgKzcxLDE0IEBAIHN0YXRp
YyBib29sIHBzcl9nbG9iYWxfZW5hYmxlZCh1MzIgZGVidWcpCj4gICAJfQo+ICAgfQo+ICAgCj4g
LXN0YXRpYyBib29sIGludGVsX3BzcjJfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gK3N0YXRpYyBib29sIGludGVsX3BzcjJfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAgIAkvKiBDYW5ub3QgZW5hYmxlIERTQyBhbmQgUFNS
MiBzaW11bHRhbmVvdXNseSAqLwo+ICAgCVdBUk5fT04oY3J0Y19zdGF0ZS0+ZHNjX3BhcmFtcy5j
b21wcmVzc2lvbl9lbmFibGUgJiYKPiAgIAkJY3J0Y19zdGF0ZS0+aGFzX3BzcjIpOwo+ICAgCj4g
LQlzd2l0Y2ggKGRldl9wcml2LT5wc3IuZGVidWcgJiBJOTE1X1BTUl9ERUJVR19NT0RFX01BU0sp
IHsKPiArCXN3aXRjaCAoaTkxNS0+cHNyLmRlYnVnICYgSTkxNV9QU1JfREVCVUdfTU9ERV9NQVNL
KSB7Cj4gICAJY2FzZSBJOTE1X1BTUl9ERUJVR19ESVNBQkxFOgo+ICAgCWNhc2UgSTkxNV9QU1Jf
REVCVUdfRk9SQ0VfUFNSMToKPiAgIAkJcmV0dXJuIGZhbHNlOwo+IEBAIC0xMDQsMjAgKzEwNCwy
MCBAQCBzdGF0aWMgaW50IGVkcF9wc3Jfc2hpZnQoZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2Nv
ZGVyKQo+ICAgCX0KPiAgIH0KPiAgIAo+IC12b2lkIGludGVsX3Bzcl9pcnFfY29udHJvbChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBkZWJ1ZykKPiArdm9pZCBpbnRlbF9w
c3JfaXJxX2NvbnRyb2woc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBkZWJ1ZykK
PiAgIHsKPiAgIAl1MzIgZGVidWdfbWFzaywgbWFzazsKPiAgIAllbnVtIHRyYW5zY29kZXIgY3B1
X3RyYW5zY29kZXI7Cj4gICAJdTMyIHRyYW5zY29kZXJzID0gQklUKFRSQU5TQ09ERVJfRURQKTsK
PiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOCkKPiArCWlmIChJTlRFTF9HRU4o
aTkxNSkgPj0gOCkKPiAgIAkJdHJhbnNjb2RlcnMgfD0gQklUKFRSQU5TQ09ERVJfQSkgfAo+ICAg
CQkJICAgICAgIEJJVChUUkFOU0NPREVSX0IpIHwKPiAgIAkJCSAgICAgICBCSVQoVFJBTlNDT0RF
Ul9DKTsKPiAgIAo+ICAgCWRlYnVnX21hc2sgPSAwOwo+ICAgCW1hc2sgPSAwOwo+IC0JZm9yX2Vh
Y2hfY3B1X3RyYW5zY29kZXJfbWFza2VkKGRldl9wcml2LCBjcHVfdHJhbnNjb2RlciwgdHJhbnNj
b2RlcnMpIHsKPiArCWZvcl9lYWNoX2NwdV90cmFuc2NvZGVyX21hc2tlZChpOTE1LCBjcHVfdHJh
bnNjb2RlciwgdHJhbnNjb2RlcnMpIHsKPiAgIAkJaW50IHNoaWZ0ID0gZWRwX3Bzcl9zaGlmdChj
cHVfdHJhbnNjb2Rlcik7Cj4gICAKPiAgIAkJbWFzayB8PSBFRFBfUFNSX0VSUk9SKHNoaWZ0KTsK
PiBAQCAtMTY4LDI2ICsxNjgsMjYgQEAgc3RhdGljIHZvaWQgcHNyX2V2ZW50X3ByaW50KHUzMiB2
YWwsIGJvb2wgcHNyMl9lbmFibGVkKQo+ICAgCQlEUk1fREVCVUdfS01TKCJcdFBTUiBkaXNhYmxl
ZFxuIik7Cj4gICB9Cj4gICAKPiAtdm9pZCBpbnRlbF9wc3JfaXJxX2hhbmRsZXIoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgcHNyX2lpcikKPiArdm9pZCBpbnRlbF9wc3Jf
aXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBwc3JfaWlyKQo+
ICAgewo+ICAgCXUzMiB0cmFuc2NvZGVycyA9IEJJVChUUkFOU0NPREVSX0VEUCk7Cj4gICAJZW51
bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyOwo+ICAgCWt0aW1lX3QgdGltZV9ucyA9ICBrdGlt
ZV9nZXQoKTsKPiAgIAl1MzIgbWFzayA9IDA7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDgpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDgpCj4gICAJCXRyYW5zY29kZXJz
IHw9IEJJVChUUkFOU0NPREVSX0EpIHwKPiAgIAkJCSAgICAgICBCSVQoVFJBTlNDT0RFUl9CKSB8
Cj4gICAJCQkgICAgICAgQklUKFRSQU5TQ09ERVJfQyk7Cj4gICAKPiAtCWZvcl9lYWNoX2NwdV90
cmFuc2NvZGVyX21hc2tlZChkZXZfcHJpdiwgY3B1X3RyYW5zY29kZXIsIHRyYW5zY29kZXJzKSB7
Cj4gKwlmb3JfZWFjaF9jcHVfdHJhbnNjb2Rlcl9tYXNrZWQoaTkxNSwgY3B1X3RyYW5zY29kZXIs
IHRyYW5zY29kZXJzKSB7Cj4gICAJCWludCBzaGlmdCA9IGVkcF9wc3Jfc2hpZnQoY3B1X3RyYW5z
Y29kZXIpOwo+ICAgCj4gICAJCWlmIChwc3JfaWlyICYgRURQX1BTUl9FUlJPUihzaGlmdCkpIHsK
PiAgIAkJCURSTV9XQVJOKCJbdHJhbnNjb2RlciAlc10gUFNSIGF1eCBlcnJvclxuIiwKPiAgIAkJ
CQkgdHJhbnNjb2Rlcl9uYW1lKGNwdV90cmFuc2NvZGVyKSk7Cj4gICAKPiAtCQkJZGV2X3ByaXYt
PnBzci5pcnFfYXV4X2Vycm9yID0gdHJ1ZTsKPiArCQkJaTkxNS0+cHNyLmlycV9hdXhfZXJyb3Ig
PSB0cnVlOwo+ICAgCj4gICAJCQkvKgo+ICAgCQkJICogSWYgdGhpcyBpbnRlcnJ1cHRpb24gaXMg
bm90IG1hc2tlZCBpdCB3aWxsIGtlZXAKPiBAQCAtMjAxLDE5ICsyMDEsMTkgQEAgdm9pZCBpbnRl
bF9wc3JfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIg
cHNyX2lpcikKPiAgIAkJfQo+ICAgCj4gICAJCWlmIChwc3JfaWlyICYgRURQX1BTUl9QUkVfRU5U
Ulkoc2hpZnQpKSB7Cj4gLQkJCWRldl9wcml2LT5wc3IubGFzdF9lbnRyeV9hdHRlbXB0ID0gdGlt
ZV9uczsKPiArCQkJaTkxNS0+cHNyLmxhc3RfZW50cnlfYXR0ZW1wdCA9IHRpbWVfbnM7Cj4gICAJ
CQlEUk1fREVCVUdfS01TKCJbdHJhbnNjb2RlciAlc10gUFNSIGVudHJ5IGF0dGVtcHQgaW4gMiB2
YmxhbmtzXG4iLAo+ICAgCQkJCSAgICAgIHRyYW5zY29kZXJfbmFtZShjcHVfdHJhbnNjb2Rlcikp
Owo+ICAgCQl9Cj4gICAKPiAgIAkJaWYgKHBzcl9paXIgJiBFRFBfUFNSX1BPU1RfRVhJVChzaGlm
dCkpIHsKPiAtCQkJZGV2X3ByaXYtPnBzci5sYXN0X2V4aXQgPSB0aW1lX25zOwo+ICsJCQlpOTE1
LT5wc3IubGFzdF9leGl0ID0gdGltZV9uczsKPiAgIAkJCURSTV9ERUJVR19LTVMoIlt0cmFuc2Nv
ZGVyICVzXSBQU1IgZXhpdCBjb21wbGV0ZWRcbiIsCj4gICAJCQkJICAgICAgdHJhbnNjb2Rlcl9u
YW1lKGNwdV90cmFuc2NvZGVyKSk7Cj4gICAKPiAtCQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gOSkgewo+ICsJCQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkpIHsKPiAgIAkJCQl1MzIgdmFs
ID0gSTkxNV9SRUFEKFBTUl9FVkVOVChjcHVfdHJhbnNjb2RlcikpOwo+IC0JCQkJYm9vbCBwc3Iy
X2VuYWJsZWQgPSBkZXZfcHJpdi0+cHNyLnBzcjJfZW5hYmxlZDsKPiArCQkJCWJvb2wgcHNyMl9l
bmFibGVkID0gaTkxNS0+cHNyLnBzcjJfZW5hYmxlZDsKPiAgIAo+ICAgCQkJCUk5MTVfV1JJVEUo
UFNSX0VWRU5UKGNwdV90cmFuc2NvZGVyKSwgdmFsKTsKPiAgIAkJCQlwc3JfZXZlbnRfcHJpbnQo
dmFsLCBwc3IyX2VuYWJsZWQpOwo+IEBAIC0yMjUsNyArMjI1LDcgQEAgdm9pZCBpbnRlbF9wc3Jf
aXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgcHNyX2lp
cikKPiAgIAkJbWFzayB8PSBJOTE1X1JFQUQoRURQX1BTUl9JTVIpOwo+ICAgCQlJOTE1X1dSSVRF
KEVEUF9QU1JfSU1SLCBtYXNrKTsKPiAgIAo+IC0JCXNjaGVkdWxlX3dvcmsoJmRldl9wcml2LT5w
c3Iud29yayk7Cj4gKwkJc2NoZWR1bGVfd29yaygmaTkxNS0+cHNyLndvcmspOwo+ICAgCX0KPiAg
IH0KPiAgIAo+IEBAIC0yNzksNyArMjc5LDcgQEAgc3RhdGljIHUxNiBpbnRlbF9kcF9nZXRfc3Vf
eF9ncmFudWxhcnRpeShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAgCj4gICB2b2lkIGlu
dGVsX3Bzcl9pbml0X2RwY2Qoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiAgIHsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9Cj4gICAJCXRvX2k5MTUoZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApLT5iYXNl
LmJhc2UuZGV2KTsKPiAgIAo+ICAgCWRybV9kcF9kcGNkX3JlYWQoJmludGVsX2RwLT5hdXgsIERQ
X1BTUl9TVVBQT1JULCBpbnRlbF9kcC0+cHNyX2RwY2QsCj4gQEAgLTMwMCwxNCArMzAwLDE0IEBA
IHZvaWQgaW50ZWxfcHNyX2luaXRfZHBjZChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAg
CQlyZXR1cm47Cj4gICAJfQo+ICAgCj4gLQlkZXZfcHJpdi0+cHNyLnNpbmtfc3VwcG9ydCA9IHRy
dWU7Cj4gLQlkZXZfcHJpdi0+cHNyLnNpbmtfc3luY19sYXRlbmN5ID0KPiArCWk5MTUtPnBzci5z
aW5rX3N1cHBvcnQgPSB0cnVlOwo+ICsJaTkxNS0+cHNyLnNpbmtfc3luY19sYXRlbmN5ID0KPiAg
IAkJaW50ZWxfZHBfZ2V0X3Npbmtfc3luY19sYXRlbmN5KGludGVsX2RwKTsKPiAgIAo+IC0JV0FS
Tl9PTihkZXZfcHJpdi0+cHNyLmRwKTsKPiAtCWRldl9wcml2LT5wc3IuZHAgPSBpbnRlbF9kcDsK
PiArCVdBUk5fT04oaTkxNS0+cHNyLmRwKTsKPiArCWk5MTUtPnBzci5kcCA9IGludGVsX2RwOwo+
ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5ICYmCj4gKwlpZiAoSU5URUxfR0VO
KGk5MTUpID49IDkgJiYKPiAgIAkgICAgKGludGVsX2RwLT5wc3JfZHBjZFswXSA9PSBEUF9QU1Iy
X1dJVEhfWV9DT09SRF9JU19TVVBQT1JURUQpKSB7Cj4gICAJCWJvb2wgeV9yZXEgPSBpbnRlbF9k
cC0+cHNyX2RwY2RbMV0gJgo+ICAgCQkJICAgICBEUF9QU1IyX1NVX1lfQ09PUkRJTkFURV9SRVFV
SVJFRDsKPiBAQCAtMzI0LDE0ICszMjQsMTQgQEAgdm9pZCBpbnRlbF9wc3JfaW5pdF9kcGNkKHN0
cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICAJCSAqIFktY29vcmRpbmF0ZSByZXF1aXJlbWVu
dCBwYW5lbHMgd2Ugd291bGQgbmVlZCB0byBlbmFibGUKPiAgIAkJICogR1RDIGZpcnN0Lgo+ICAg
CQkgKi8KPiAtCQlkZXZfcHJpdi0+cHNyLnNpbmtfcHNyMl9zdXBwb3J0ID0geV9yZXEgJiYgYWxw
bTsKPiArCQlpOTE1LT5wc3Iuc2lua19wc3IyX3N1cHBvcnQgPSB5X3JlcSAmJiBhbHBtOwo+ICAg
CQlEUk1fREVCVUdfS01TKCJQU1IyICVzc3VwcG9ydGVkXG4iLAo+IC0JCQkgICAgICBkZXZfcHJp
di0+cHNyLnNpbmtfcHNyMl9zdXBwb3J0ID8gIiIgOiAibm90ICIpOwo+ICsJCQkgICAgICBpOTE1
LT5wc3Iuc2lua19wc3IyX3N1cHBvcnQgPyAiIiA6ICJub3QgIik7Cj4gICAKPiAtCQlpZiAoZGV2
X3ByaXYtPnBzci5zaW5rX3BzcjJfc3VwcG9ydCkgewo+IC0JCQlkZXZfcHJpdi0+cHNyLmNvbG9y
aW1ldHJ5X3N1cHBvcnQgPQo+ICsJCWlmIChpOTE1LT5wc3Iuc2lua19wc3IyX3N1cHBvcnQpIHsK
PiArCQkJaTkxNS0+cHNyLmNvbG9yaW1ldHJ5X3N1cHBvcnQgPQo+ICAgCQkJCWludGVsX2RwX2dl
dF9jb2xvcmltZXRyeV9zdGF0dXMoaW50ZWxfZHApOwo+IC0JCQlkZXZfcHJpdi0+cHNyLnN1X3hf
Z3JhbnVsYXJpdHkgPQo+ICsJCQlpOTE1LT5wc3Iuc3VfeF9ncmFudWxhcml0eSA9Cj4gICAJCQkJ
aW50ZWxfZHBfZ2V0X3N1X3hfZ3JhbnVsYXJ0aXkoaW50ZWxfZHApOwo+ICAgCQl9Cj4gICAJfQo+
IEBAIC0zNDEsMTUgKzM0MSwxNSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wc3Jfc2V0dXBfdnNjKHN0
cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gICAJCQkJY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAq
aW50ZWxfZGlnX3BvcnQgPSBkcF90b19kaWdfcG9ydChpbnRlbF9kcCk7Cj4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gICAJc3Ry
dWN0IGRwX3NkcCBwc3JfdnNjOwo+ICAgCj4gLQlpZiAoZGV2X3ByaXYtPnBzci5wc3IyX2VuYWJs
ZWQpIHsKPiArCWlmIChpOTE1LT5wc3IucHNyMl9lbmFibGVkKSB7Cj4gICAJCS8qIFByZXBhcmUg
VlNDIEhlYWRlciBmb3IgU1UgYXMgcGVyIEVEUCAxLjQgc3BlYywgVGFibGUgNi4xMSAqLwo+ICAg
CQltZW1zZXQoJnBzcl92c2MsIDAsIHNpemVvZihwc3JfdnNjKSk7Cj4gICAJCXBzcl92c2Muc2Rw
X2hlYWRlci5IQjAgPSAwOwo+ICAgCQlwc3JfdnNjLnNkcF9oZWFkZXIuSEIxID0gMHg3Owo+IC0J
CWlmIChkZXZfcHJpdi0+cHNyLmNvbG9yaW1ldHJ5X3N1cHBvcnQpIHsKPiArCQlpZiAoaTkxNS0+
cHNyLmNvbG9yaW1ldHJ5X3N1cHBvcnQpIHsKPiAgIAkJCXBzcl92c2Muc2RwX2hlYWRlci5IQjIg
PSAweDU7Cj4gICAJCQlwc3JfdnNjLnNkcF9oZWFkZXIuSEIzID0gMHgxMzsKPiAgIAkJfSBlbHNl
IHsKPiBAQCAtMzcyLDcgKzM3Miw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3Bzcl9zZXR1cF92c2Mo
c3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiAgIAo+ICAgc3RhdGljIHZvaWQgaHN3X3Bzcl9z
ZXR1cF9hdXgoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiAgIAl1MzIg
YXV4X2Nsb2NrX2RpdmlkZXIsIGF1eF9jdGw7Cj4gICAJaW50IGk7Cj4gICAJc3RhdGljIGNvbnN0
IHU4IGF1eF9tc2dbXSA9IHsKPiBAQCAtNDA1LDE5ICs0MDUsMTkgQEAgc3RhdGljIHZvaWQgaHN3
X3Bzcl9zZXR1cF9hdXgoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiAgIAo+ICAgc3RhdGlj
IHZvaWQgaW50ZWxfcHNyX2VuYWJsZV9zaW5rKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGlu
dGVsX2RwKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShp
bnRlbF9kcCk7Cj4gICAJdTggZHBjZF92YWwgPSBEUF9QU1JfRU5BQkxFOwo+ICAgCj4gICAJLyog
RW5hYmxlIEFMUE0gYXQgc2luayBmb3IgcHNyMiAqLwo+IC0JaWYgKGRldl9wcml2LT5wc3IucHNy
Ml9lbmFibGVkKSB7Cj4gKwlpZiAoaTkxNS0+cHNyLnBzcjJfZW5hYmxlZCkgewo+ICAgCQlkcm1f
ZHBfZHBjZF93cml0ZWIoJmludGVsX2RwLT5hdXgsIERQX1JFQ0VJVkVSX0FMUE1fQ09ORklHLAo+
ICAgCQkJCSAgIERQX0FMUE1fRU5BQkxFKTsKPiAgIAkJZHBjZF92YWwgfD0gRFBfUFNSX0VOQUJM
RV9QU1IyIHwgRFBfUFNSX0lSUV9IUERfV0lUSF9DUkNfRVJST1JTOwo+ICAgCX0gZWxzZSB7Cj4g
LQkJaWYgKGRldl9wcml2LT5wc3IubGlua19zdGFuZGJ5KQo+ICsJCWlmIChpOTE1LT5wc3IubGlu
a19zdGFuZGJ5KQo+ICAgCQkJZHBjZF92YWwgfD0gRFBfUFNSX01BSU5fTElOS19BQ1RJVkU7Cj4g
ICAKPiAtCQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA4KQo+ICsJCWlmIChJTlRFTF9HRU4o
aTkxNSkgPj0gOCkKPiAgIAkJCWRwY2RfdmFsIHw9IERQX1BTUl9DUkNfVkVSSUZJQ0FUSU9OOwo+
ICAgCX0KPiAgIAo+IEBAIC00MjgsMjYgKzQyOCwyNiBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wc3Jf
ZW5hYmxlX3Npbmsoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiAgIAo+ICAgc3RhdGljIHUz
MiBpbnRlbF9wc3IxX2dldF90cF90aW1lKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVs
X2RwKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRl
bF9kcCk7Cj4gICAJdTMyIHZhbCA9IDA7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
ID49IDExKQo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiAgIAkJdmFsIHw9IEVEUF9Q
U1JfVFA0X1RJTUVfMFVTOwo+ICAgCj4gLQlpZiAoZGV2X3ByaXYtPnZidC5wc3IudHAxX3dha2V1
cF90aW1lX3VzID09IDApCj4gKwlpZiAoaTkxNS0+dmJ0LnBzci50cDFfd2FrZXVwX3RpbWVfdXMg
PT0gMCkKPiAgIAkJdmFsIHw9IEVEUF9QU1JfVFAxX1RJTUVfMHVzOwo+IC0JZWxzZSBpZiAoZGV2
X3ByaXYtPnZidC5wc3IudHAxX3dha2V1cF90aW1lX3VzIDw9IDEwMCkKPiArCWVsc2UgaWYgKGk5
MTUtPnZidC5wc3IudHAxX3dha2V1cF90aW1lX3VzIDw9IDEwMCkKPiAgIAkJdmFsIHw9IEVEUF9Q
U1JfVFAxX1RJTUVfMTAwdXM7Cj4gLQllbHNlIGlmIChkZXZfcHJpdi0+dmJ0LnBzci50cDFfd2Fr
ZXVwX3RpbWVfdXMgPD0gNTAwKQo+ICsJZWxzZSBpZiAoaTkxNS0+dmJ0LnBzci50cDFfd2FrZXVw
X3RpbWVfdXMgPD0gNTAwKQo+ICAgCQl2YWwgfD0gRURQX1BTUl9UUDFfVElNRV81MDB1czsKPiAg
IAllbHNlCj4gICAJCXZhbCB8PSBFRFBfUFNSX1RQMV9USU1FXzI1MDB1czsKPiAgIAo+IC0JaWYg
KGRldl9wcml2LT52YnQucHNyLnRwMl90cDNfd2FrZXVwX3RpbWVfdXMgPT0gMCkKPiArCWlmIChp
OTE1LT52YnQucHNyLnRwMl90cDNfd2FrZXVwX3RpbWVfdXMgPT0gMCkKPiAgIAkJdmFsIHw9IEVE
UF9QU1JfVFAyX1RQM19USU1FXzB1czsKPiAtCWVsc2UgaWYgKGRldl9wcml2LT52YnQucHNyLnRw
Ml90cDNfd2FrZXVwX3RpbWVfdXMgPD0gMTAwKQo+ICsJZWxzZSBpZiAoaTkxNS0+dmJ0LnBzci50
cDJfdHAzX3dha2V1cF90aW1lX3VzIDw9IDEwMCkKPiAgIAkJdmFsIHw9IEVEUF9QU1JfVFAyX1RQ
M19USU1FXzEwMHVzOwo+IC0JZWxzZSBpZiAoZGV2X3ByaXYtPnZidC5wc3IudHAyX3RwM193YWtl
dXBfdGltZV91cyA8PSA1MDApCj4gKwllbHNlIGlmIChpOTE1LT52YnQucHNyLnRwMl90cDNfd2Fr
ZXVwX3RpbWVfdXMgPD0gNTAwKQo+ICAgCQl2YWwgfD0gRURQX1BTUl9UUDJfVFAzX1RJTUVfNTAw
dXM7Cj4gICAJZWxzZQo+ICAgCQl2YWwgfD0gRURQX1BTUl9UUDJfVFAzX1RJTUVfMjUwMHVzOwo+
IEBAIC00NjMsMzEgKzQ2MywzMSBAQCBzdGF0aWMgdTMyIGludGVsX3BzcjFfZ2V0X3RwX3RpbWUo
c3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiAgIAo+ICAgc3RhdGljIHZvaWQgaHN3X2FjdGl2
YXRlX3BzcjEoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiAgIAl1MzIg
bWF4X3NsZWVwX3RpbWUgPSAweDFmOwo+ICAgCXUzMiB2YWwgPSBFRFBfUFNSX0VOQUJMRTsKPiAg
IAo+ICAgCS8qIExldCdzIHVzZSA2IGFzIHRoZSBtaW5pbXVtIHRvIGNvdmVyIGFsbCBrbm93biBj
YXNlcyBpbmNsdWRpbmcgdGhlCj4gICAJICogb2ZmLWJ5LW9uZSBpc3N1ZSB0aGF0IEhXIGhhcyBp
biBzb21lIGNhc2VzLgo+ICAgCSAqLwo+IC0JaW50IGlkbGVfZnJhbWVzID0gbWF4KDYsIGRldl9w
cml2LT52YnQucHNyLmlkbGVfZnJhbWVzKTsKPiArCWludCBpZGxlX2ZyYW1lcyA9IG1heCg2LCBp
OTE1LT52YnQucHNyLmlkbGVfZnJhbWVzKTsKPiAgIAo+ICAgCS8qIHNpbmtfc3luY19sYXRlbmN5
IG9mIDggbWVhbnMgc291cmNlIGhhcyB0byB3YWl0IGZvciBtb3JlIHRoYW4gOAo+ICAgCSAqIGZy
YW1lcywgd2UnbGwgZ28gd2l0aCA5IGZyYW1lcyBmb3Igbm93Cj4gICAJICovCj4gLQlpZGxlX2Zy
YW1lcyA9IG1heChpZGxlX2ZyYW1lcywgZGV2X3ByaXYtPnBzci5zaW5rX3N5bmNfbGF0ZW5jeSAr
IDEpOwo+ICsJaWRsZV9mcmFtZXMgPSBtYXgoaWRsZV9mcmFtZXMsIGk5MTUtPnBzci5zaW5rX3N5
bmNfbGF0ZW5jeSArIDEpOwo+ICAgCXZhbCB8PSBpZGxlX2ZyYW1lcyA8PCBFRFBfUFNSX0lETEVf
RlJBTUVfU0hJRlQ7Cj4gICAKPiAgIAl2YWwgfD0gbWF4X3NsZWVwX3RpbWUgPDwgRURQX1BTUl9N
QVhfU0xFRVBfVElNRV9TSElGVDsKPiAtCWlmIChJU19IQVNXRUxMKGRldl9wcml2KSkKPiArCWlm
IChJU19IQVNXRUxMKGk5MTUpKQo+ICAgCQl2YWwgfD0gRURQX1BTUl9NSU5fTElOS19FTlRSWV9U
SU1FXzhfTElORVM7Cj4gICAKPiAtCWlmIChkZXZfcHJpdi0+cHNyLmxpbmtfc3RhbmRieSkKPiAr
CWlmIChpOTE1LT5wc3IubGlua19zdGFuZGJ5KQo+ICAgCQl2YWwgfD0gRURQX1BTUl9MSU5LX1NU
QU5EQlk7Cj4gICAKPiAgIAl2YWwgfD0gaW50ZWxfcHNyMV9nZXRfdHBfdGltZShpbnRlbF9kcCk7
Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDgpCj4gKwlpZiAoSU5URUxfR0VO
KGk5MTUpID49IDgpCj4gICAJCXZhbCB8PSBFRFBfUFNSX0NSQ19FTkFCTEU7Cj4gICAKPiAgIAl2
YWwgfD0gSTkxNV9SRUFEKEVEUF9QU1JfQ1RMKSAmIEVEUF9QU1JfUkVTVE9SRV9QU1JfQUNUSVZF
X0NUWF9NQVNLOwo+IEBAIC00OTYsMjkgKzQ5NiwyOSBAQCBzdGF0aWMgdm9pZCBoc3dfYWN0aXZh
dGVfcHNyMShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAgCj4gICBzdGF0aWMgdm9pZCBo
c3dfYWN0aXZhdGVfcHNyMihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAgewo+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+
ICAgCXUzMiB2YWw7Cj4gICAKPiAgIAkvKiBMZXQncyB1c2UgNiBhcyB0aGUgbWluaW11bSB0byBj
b3ZlciBhbGwga25vd24gY2FzZXMgaW5jbHVkaW5nIHRoZQo+ICAgCSAqIG9mZi1ieS1vbmUgaXNz
dWUgdGhhdCBIVyBoYXMgaW4gc29tZSBjYXNlcy4KPiAgIAkgKi8KPiAtCWludCBpZGxlX2ZyYW1l
cyA9IG1heCg2LCBkZXZfcHJpdi0+dmJ0LnBzci5pZGxlX2ZyYW1lcyk7Cj4gKwlpbnQgaWRsZV9m
cmFtZXMgPSBtYXgoNiwgaTkxNS0+dmJ0LnBzci5pZGxlX2ZyYW1lcyk7Cj4gICAKPiAtCWlkbGVf
ZnJhbWVzID0gbWF4KGlkbGVfZnJhbWVzLCBkZXZfcHJpdi0+cHNyLnNpbmtfc3luY19sYXRlbmN5
ICsgMSk7Cj4gKwlpZGxlX2ZyYW1lcyA9IG1heChpZGxlX2ZyYW1lcywgaTkxNS0+cHNyLnNpbmtf
c3luY19sYXRlbmN5ICsgMSk7Cj4gICAJdmFsID0gaWRsZV9mcmFtZXMgPDwgRURQX1BTUjJfSURM
RV9GUkFNRV9TSElGVDsKPiAgIAo+ICAgCXZhbCB8PSBFRFBfUFNSMl9FTkFCTEUgfCBFRFBfU1Vf
VFJBQ0tfRU5BQkxFOwo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgfHwgSVNfR0VN
SU5JTEFLRShkZXZfcHJpdikpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDEwIHx8IElTX0dF
TUlOSUxBS0UoaTkxNSkpCj4gICAJCXZhbCB8PSBFRFBfWV9DT09SRElOQVRFX0VOQUJMRTsKPiAg
IAo+IC0JdmFsIHw9IEVEUF9QU1IyX0ZSQU1FX0JFRk9SRV9TVShkZXZfcHJpdi0+cHNyLnNpbmtf
c3luY19sYXRlbmN5ICsgMSk7Cj4gKwl2YWwgfD0gRURQX1BTUjJfRlJBTUVfQkVGT1JFX1NVKGk5
MTUtPnBzci5zaW5rX3N5bmNfbGF0ZW5jeSArIDEpOwo+ICAgCj4gLQlpZiAoZGV2X3ByaXYtPnZi
dC5wc3IucHNyMl90cDJfdHAzX3dha2V1cF90aW1lX3VzID49IDAgJiYKPiAtCSAgICBkZXZfcHJp
di0+dmJ0LnBzci5wc3IyX3RwMl90cDNfd2FrZXVwX3RpbWVfdXMgPD0gNTApCj4gKwlpZiAoaTkx
NS0+dmJ0LnBzci5wc3IyX3RwMl90cDNfd2FrZXVwX3RpbWVfdXMgPj0gMCAmJgo+ICsJICAgIGk5
MTUtPnZidC5wc3IucHNyMl90cDJfdHAzX3dha2V1cF90aW1lX3VzIDw9IDUwKQo+ICAgCQl2YWwg
fD0gRURQX1BTUjJfVFAyX1RJTUVfNTB1czsKPiAtCWVsc2UgaWYgKGRldl9wcml2LT52YnQucHNy
LnBzcjJfdHAyX3RwM193YWtldXBfdGltZV91cyA8PSAxMDApCj4gKwllbHNlIGlmIChpOTE1LT52
YnQucHNyLnBzcjJfdHAyX3RwM193YWtldXBfdGltZV91cyA8PSAxMDApCj4gICAJCXZhbCB8PSBF
RFBfUFNSMl9UUDJfVElNRV8xMDB1czsKPiAtCWVsc2UgaWYgKGRldl9wcml2LT52YnQucHNyLnBz
cjJfdHAyX3RwM193YWtldXBfdGltZV91cyA8PSA1MDApCj4gKwllbHNlIGlmIChpOTE1LT52YnQu
cHNyLnBzcjJfdHAyX3RwM193YWtldXBfdGltZV91cyA8PSA1MDApCj4gICAJCXZhbCB8PSBFRFBf
UFNSMl9UUDJfVElNRV81MDB1czsKPiAgIAllbHNlCj4gICAJCXZhbCB8PSBFRFBfUFNSMl9UUDJf
VElNRV8yNTAwdXM7Cj4gQEAgLTUzNSwxMiArNTM1LDEyIEBAIHN0YXRpYyB2b2lkIGhzd19hY3Rp
dmF0ZV9wc3IyKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICBzdGF0aWMgYm9vbCBpbnRl
bF9wc3IyX2NvbmZpZ192YWxpZChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ICAgCQkJCSAg
ICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiAgIAlp
bnQgY3J0Y19oZGlzcGxheSA9IGNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2hk
aXNwbGF5Owo+ICAgCWludCBjcnRjX3ZkaXNwbGF5ID0gY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3Rl
ZF9tb2RlLmNydGNfdmRpc3BsYXk7Cj4gICAJaW50IHBzcl9tYXhfaCA9IDAsIHBzcl9tYXhfdiA9
IDA7Cj4gICAKPiAtCWlmICghZGV2X3ByaXYtPnBzci5zaW5rX3BzcjJfc3VwcG9ydCkKPiArCWlm
ICghaTkxNS0+cHNyLnNpbmtfcHNyMl9zdXBwb3J0KQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gICAK
PiAgIAkvKgo+IEBAIC01NTMsMTAgKzU1MywxMCBAQCBzdGF0aWMgYm9vbCBpbnRlbF9wc3IyX2Nv
bmZpZ192YWxpZChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ICAgCQlyZXR1cm4gZmFsc2U7
Cj4gICAJfQo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCB8fCBJU19HRU1J
TklMQUtFKGRldl9wcml2KSkgewo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMCB8fCBJU19H
RU1JTklMQUtFKGk5MTUpKSB7Cj4gICAJCXBzcl9tYXhfaCA9IDQwOTY7Cj4gICAJCXBzcl9tYXhf
diA9IDIzMDQ7Cj4gLQl9IGVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgOSkpIHsKPiArCX0gZWxz
ZSBpZiAoSVNfR0VOKGk5MTUsIDkpKSB7Cj4gICAJCXBzcl9tYXhfaCA9IDM2NDA7Cj4gICAJCXBz
cl9tYXhfdiA9IDIzMDQ7Cj4gICAJfQo+IEBAIC01NzQsOSArNTc0LDkgQEAgc3RhdGljIGJvb2wg
aW50ZWxfcHNyMl9jb25maWdfdmFsaWQoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiAgIAkg
KiBvbmx5IG5lZWQgdG8gdmFsaWRhdGUgdGhlIFNVIGJsb2NrIHdpZHRoIGlzIGEgbXVsdGlwbGUg
b2YKPiAgIAkgKiB4IGdyYW51bGFyaXR5Lgo+ICAgCSAqLwo+IC0JaWYgKGNydGNfaGRpc3BsYXkg
JSBkZXZfcHJpdi0+cHNyLnN1X3hfZ3JhbnVsYXJpdHkpIHsKPiArCWlmIChjcnRjX2hkaXNwbGF5
ICUgaTkxNS0+cHNyLnN1X3hfZ3JhbnVsYXJpdHkpIHsKPiAgIAkJRFJNX0RFQlVHX0tNUygiUFNS
MiBub3QgZW5hYmxlZCwgaGRpc3BsYXkoJWQpIG5vdCBtdWx0aXBsZSBvZiAlZFxuIiwKPiAtCQkJ
ICAgICAgY3J0Y19oZGlzcGxheSwgZGV2X3ByaXYtPnBzci5zdV94X2dyYW51bGFyaXR5KTsKPiAr
CQkJICAgICAgY3J0Y19oZGlzcGxheSwgaTkxNS0+cHNyLnN1X3hfZ3JhbnVsYXJpdHkpOwo+ICAg
CQlyZXR1cm4gZmFsc2U7Cj4gICAJfQo+ICAgCj4gQEAgLTU5MiwxNSArNTkyLDE1IEBAIHZvaWQg
aW50ZWxfcHNyX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gICAJ
CQkgICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAgIAlz
dHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCA9IGRwX3RvX2RpZ19wb3J0KGludGVs
X2RwKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUo
aW50ZWxfZHApOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19pOTE1
KGludGVsX2RwKTsKPiAgIAljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRf
bW9kZSA9Cj4gICAJCSZjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gICAJaW50IHBz
cl9zZXR1cF90aW1lOwo+ICAgCj4gLQlpZiAoIUNBTl9QU1IoZGV2X3ByaXYpKQo+ICsJaWYgKCFD
QU5fUFNSKGk5MTUpKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCWlmIChpbnRlbF9kcCAhPSBkZXZf
cHJpdi0+cHNyLmRwKQo+ICsJaWYgKGludGVsX2RwICE9IGk5MTUtPnBzci5kcCkKPiAgIAkJcmV0
dXJuOwo+ICAgCj4gICAJLyoKPiBAQCAtNjE1LDcgKzYxNSw3IEBAIHZvaWQgaW50ZWxfcHNyX2Nv
bXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gICAJCXJldHVybjsKPiAg
IAl9Cj4gICAKPiAtCWlmIChkZXZfcHJpdi0+cHNyLnNpbmtfbm90X3JlbGlhYmxlKSB7Cj4gKwlp
ZiAoaTkxNS0+cHNyLnNpbmtfbm90X3JlbGlhYmxlKSB7Cj4gICAJCURSTV9ERUJVR19LTVMoIlBT
UiBzaW5rIGltcGxlbWVudGF0aW9uIGlzIG5vdCByZWxpYWJsZVxuIik7Cj4gICAJCXJldHVybjsK
PiAgIAl9Cj4gQEAgLTY0NSwyNCArNjQ1LDI0IEBAIHZvaWQgaW50ZWxfcHNyX2NvbXB1dGVfY29u
ZmlnKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gICAKPiAgIHN0YXRpYyB2b2lkIGludGVs
X3Bzcl9hY3RpdmF0ZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAgewo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ICAg
Cj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KQo+ICsJaWYgKElOVEVMX0dFTihpOTE1
KSA+PSA5KQo+ICAgCQlXQVJOX09OKEk5MTVfUkVBRChFRFBfUFNSMl9DVEwpICYgRURQX1BTUjJf
RU5BQkxFKTsKPiAgIAlXQVJOX09OKEk5MTVfUkVBRChFRFBfUFNSX0NUTCkgJiBFRFBfUFNSX0VO
QUJMRSk7Cj4gLQlXQVJOX09OKGRldl9wcml2LT5wc3IuYWN0aXZlKTsKPiAtCWxvY2tkZXBfYXNz
ZXJ0X2hlbGQoJmRldl9wcml2LT5wc3IubG9jayk7Cj4gKwlXQVJOX09OKGk5MTUtPnBzci5hY3Rp
dmUpOwo+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+cHNyLmxvY2spOwo+ICAgCj4gICAJ
LyogcHNyMSBhbmQgcHNyMiBhcmUgbXV0dWFsbHkgZXhjbHVzaXZlLiovCj4gLQlpZiAoZGV2X3By
aXYtPnBzci5wc3IyX2VuYWJsZWQpCj4gKwlpZiAoaTkxNS0+cHNyLnBzcjJfZW5hYmxlZCkKPiAg
IAkJaHN3X2FjdGl2YXRlX3BzcjIoaW50ZWxfZHApOwo+ICAgCWVsc2UKPiAgIAkJaHN3X2FjdGl2
YXRlX3BzcjEoaW50ZWxfZHApOwo+ICAgCj4gLQlkZXZfcHJpdi0+cHNyLmFjdGl2ZSA9IHRydWU7
Cj4gKwlpOTE1LT5wc3IuYWN0aXZlID0gdHJ1ZTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgaTkxNV9y
ZWdfdCBnZW45X2NoaWNrZW5fdHJhbnNfcmVnKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiArc3RhdGljIGk5MTVfcmVnX3QgZ2VuOV9jaGlja2VuX3RyYW5zX3JlZyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkJIGVudW0gdHJhbnNjb2RlciBjcHVfdHJh
bnNjb2RlcikKPiAgIHsKPiAgIAlzdGF0aWMgY29uc3QgaTkxNV9yZWdfdCByZWdzW10gPSB7Cj4g
QEAgLTY3Miw3ICs2NzIsNyBAQCBzdGF0aWMgaTkxNV9yZWdfdCBnZW45X2NoaWNrZW5fdHJhbnNf
cmVnKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkJW1RSQU5TQ09ERVJf
RURQXSA9IENISUNLRU5fVFJBTlNfRURQLAo+ICAgCX07Cj4gICAKPiAtCVdBUk5fT04oSU5URUxf
R0VOKGRldl9wcml2KSA8IDkpOwo+ICsJV0FSTl9PTihJTlRFTF9HRU4oaTkxNSkgPCA5KTsKPiAg
IAo+ICAgCWlmIChXQVJOX09OKGNwdV90cmFuc2NvZGVyID49IEFSUkFZX1NJWkUocmVncykgfHwK
PiAgIAkJICAgICFyZWdzW2NwdV90cmFuc2NvZGVyXS5yZWcpKQo+IEBAIC02ODQsMTkgKzY4NCwx
OSBAQCBzdGF0aWMgaTkxNV9yZWdfdCBnZW45X2NoaWNrZW5fdHJhbnNfcmVnKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIHN0YXRpYyB2b2lkIGludGVsX3Bzcl9lbmFibGVf
c291cmNlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gICAJCQkJICAgIGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ICAgCWVudW0gdHJh
bnNjb2RlciBjcHVfdHJhbnNjb2RlciA9IGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyOwo+ICAg
CXUzMiBtYXNrOwo+ICAgCj4gICAJLyogT25seSBIU1cgYW5kIEJEVyBoYXZlIFBTUiBBVVggcmVn
aXN0ZXJzIHRoYXQgbmVlZCB0byBiZSBzZXR1cC4gU0tMKwo+ICAgCSAqIHVzZSBoYXJkY29kZWQg
dmFsdWVzIFBTUiBBVVggdHJhbnNhY3Rpb25zCj4gICAJICovCj4gLQlpZiAoSVNfSEFTV0VMTChk
ZXZfcHJpdikgfHwgSVNfQlJPQURXRUxMKGRldl9wcml2KSkKPiArCWlmIChJU19IQVNXRUxMKGk5
MTUpIHx8IElTX0JST0FEV0VMTChpOTE1KSkKPiAgIAkJaHN3X3Bzcl9zZXR1cF9hdXgoaW50ZWxf
ZHApOwo+ICAgCj4gLQlpZiAoZGV2X3ByaXYtPnBzci5wc3IyX2VuYWJsZWQgJiYgKElTX0dFTihk
ZXZfcHJpdiwgOSkgJiYKPiAtCQkJCQkgICAhSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpKSB7Cj4g
LQkJaTkxNV9yZWdfdCByZWcgPSBnZW45X2NoaWNrZW5fdHJhbnNfcmVnKGRldl9wcml2LAo+ICsJ
aWYgKGk5MTUtPnBzci5wc3IyX2VuYWJsZWQgJiYgKElTX0dFTihpOTE1LCA5KSAmJgo+ICsJCQkJ
CSAgICFJU19HRU1JTklMQUtFKGk5MTUpKSkgewo+ICsJCWk5MTVfcmVnX3QgcmVnID0gZ2VuOV9j
aGlja2VuX3RyYW5zX3JlZyhpOTE1LAo+ICAgCQkJCQkJCWNwdV90cmFuc2NvZGVyKTsKPiAgIAkJ
dTMyIGNoaWNrZW4gPSBJOTE1X1JFQUQocmVnKTsKPiAgIAo+IEBAIC03MTYsMjkgKzcxNiwyOSBA
QCBzdGF0aWMgdm9pZCBpbnRlbF9wc3JfZW5hYmxlX3NvdXJjZShzdHJ1Y3QgaW50ZWxfZHAgKmlu
dGVsX2RwLAo+ICAgCSAgICAgICBFRFBfUFNSX0RFQlVHX01BU0tfTFBTUCB8Cj4gICAJICAgICAg
IEVEUF9QU1JfREVCVUdfTUFTS19NQVhfU0xFRVA7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2
X3ByaXYpIDwgMTEpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgMTEpCj4gICAJCW1hc2sgfD0g
RURQX1BTUl9ERUJVR19NQVNLX0RJU1BfUkVHX1dSSVRFOwo+ICAgCj4gICAJSTkxNV9XUklURShF
RFBfUFNSX0RFQlVHLCBtYXNrKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpbnRlbF9wc3Jf
ZW5hYmxlX2xvY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRp
YyB2b2lkIGludGVsX3Bzcl9lbmFibGVfbG9ja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ICAgCQkJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSkKPiAgIHsKPiAtCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSBkZXZfcHJpdi0+cHNyLmRw
Owo+ICsJc3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9IGk5MTUtPnBzci5kcDsKPiAgIAo+IC0J
V0FSTl9PTihkZXZfcHJpdi0+cHNyLmVuYWJsZWQpOwo+ICsJV0FSTl9PTihpOTE1LT5wc3IuZW5h
YmxlZCk7Cj4gICAKPiAtCWRldl9wcml2LT5wc3IucHNyMl9lbmFibGVkID0gaW50ZWxfcHNyMl9l
bmFibGVkKGRldl9wcml2LCBjcnRjX3N0YXRlKTsKPiAtCWRldl9wcml2LT5wc3IuYnVzeV9mcm9u
dGJ1ZmZlcl9iaXRzID0gMDsKPiAtCWRldl9wcml2LT5wc3IucGlwZSA9IHRvX2ludGVsX2NydGMo
Y3J0Y19zdGF0ZS0+YmFzZS5jcnRjKS0+cGlwZTsKPiArCWk5MTUtPnBzci5wc3IyX2VuYWJsZWQg
PSBpbnRlbF9wc3IyX2VuYWJsZWQoaTkxNSwgY3J0Y19zdGF0ZSk7Cj4gKwlpOTE1LT5wc3IuYnVz
eV9mcm9udGJ1ZmZlcl9iaXRzID0gMDsKPiArCWk5MTUtPnBzci5waXBlID0gdG9faW50ZWxfY3J0
YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpLT5waXBlOwo+ICAgCj4gICAJRFJNX0RFQlVHX0tNUygi
RW5hYmxpbmcgUFNSJXNcbiIsCj4gLQkJICAgICAgZGV2X3ByaXYtPnBzci5wc3IyX2VuYWJsZWQg
PyAiMiIgOiAiMSIpOwo+ICsJCSAgICAgIGk5MTUtPnBzci5wc3IyX2VuYWJsZWQgPyAiMiIgOiAi
MSIpOwo+ICAgCWludGVsX3Bzcl9zZXR1cF92c2MoaW50ZWxfZHAsIGNydGNfc3RhdGUpOwo+ICAg
CWludGVsX3Bzcl9lbmFibGVfc2luayhpbnRlbF9kcCk7Cj4gICAJaW50ZWxfcHNyX2VuYWJsZV9z
b3VyY2UoaW50ZWxfZHAsIGNydGNfc3RhdGUpOwo+IC0JZGV2X3ByaXYtPnBzci5lbmFibGVkID0g
dHJ1ZTsKPiArCWk5MTUtPnBzci5lbmFibGVkID0gdHJ1ZTsKPiAgIAo+ICAgCWludGVsX3Bzcl9h
Y3RpdmF0ZShpbnRlbF9kcCk7Cj4gICB9Cj4gQEAgLTc1Myw0MSArNzUzLDQxIEBAIHN0YXRpYyB2
b2lkIGludGVsX3Bzcl9lbmFibGVfbG9ja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiAgIHZvaWQgaW50ZWxfcHNyX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2Rw
LAo+ICAgCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkK
PiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUo
aW50ZWxfZHApOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19pOTE1
KGludGVsX2RwKTsKPiAgIAo+ICAgCWlmICghY3J0Y19zdGF0ZS0+aGFzX3BzcikKPiAgIAkJcmV0
dXJuOwo+ICAgCj4gLQlpZiAoV0FSTl9PTighQ0FOX1BTUihkZXZfcHJpdikpKQo+ICsJaWYgKFdB
Uk5fT04oIUNBTl9QU1IoaTkxNSkpKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCVdBUk5fT04oZGV2
X3ByaXYtPmRycnMuZHApOwo+ICsJV0FSTl9PTihpOTE1LT5kcnJzLmRwKTsKPiAgIAo+IC0JbXV0
ZXhfbG9jaygmZGV2X3ByaXYtPnBzci5sb2NrKTsKPiArCW11dGV4X2xvY2soJmk5MTUtPnBzci5s
b2NrKTsKPiAgIAo+IC0JaWYgKCFwc3JfZ2xvYmFsX2VuYWJsZWQoZGV2X3ByaXYtPnBzci5kZWJ1
ZykpIHsKPiArCWlmICghcHNyX2dsb2JhbF9lbmFibGVkKGk5MTUtPnBzci5kZWJ1ZykpIHsKPiAg
IAkJRFJNX0RFQlVHX0tNUygiUFNSIGRpc2FibGVkIGJ5IGZsYWdcbiIpOwo+ICAgCQlnb3RvIHVu
bG9jazsKPiAgIAl9Cj4gICAKPiAtCWludGVsX3Bzcl9lbmFibGVfbG9ja2VkKGRldl9wcml2LCBj
cnRjX3N0YXRlKTsKPiArCWludGVsX3Bzcl9lbmFibGVfbG9ja2VkKGk5MTUsIGNydGNfc3RhdGUp
Owo+ICAgCj4gICB1bmxvY2s6Cj4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5wc3IubG9jayk7
Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPnBzci5sb2NrKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMg
dm9pZCBpbnRlbF9wc3JfZXhpdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
K3N0YXRpYyB2b2lkIGludGVsX3Bzcl9leGl0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ICAgewo+ICAgCXUzMiB2YWw7Cj4gICAKPiAtCWlmICghZGV2X3ByaXYtPnBzci5hY3RpdmUp
IHsKPiAtCQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KQo+ICsJaWYgKCFpOTE1LT5wc3Iu
YWN0aXZlKSB7Cj4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ICAgCQkJV0FSTl9PTihJ
OTE1X1JFQUQoRURQX1BTUjJfQ1RMKSAmIEVEUF9QU1IyX0VOQUJMRSk7Cj4gICAJCVdBUk5fT04o
STkxNV9SRUFEKEVEUF9QU1JfQ1RMKSAmIEVEUF9QU1JfRU5BQkxFKTsKPiAgIAkJcmV0dXJuOwo+
ICAgCX0KPiAgIAo+IC0JaWYgKGRldl9wcml2LT5wc3IucHNyMl9lbmFibGVkKSB7Cj4gKwlpZiAo
aTkxNS0+cHNyLnBzcjJfZW5hYmxlZCkgewo+ICAgCQl2YWwgPSBJOTE1X1JFQUQoRURQX1BTUjJf
Q1RMKTsKPiAgIAkJV0FSTl9PTighKHZhbCAmIEVEUF9QU1IyX0VOQUJMRSkpOwo+ICAgCQlJOTE1
X1dSSVRFKEVEUF9QU1IyX0NUTCwgdmFsICYgfkVEUF9QU1IyX0VOQUJMRSk7Cj4gQEAgLTc5Niwy
NiArNzk2LDI2IEBAIHN0YXRpYyB2b2lkIGludGVsX3Bzcl9leGl0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiAgIAkJV0FSTl9PTighKHZhbCAmIEVEUF9QU1JfRU5BQkxFKSk7
Cj4gICAJCUk5MTVfV1JJVEUoRURQX1BTUl9DVEwsIHZhbCAmIH5FRFBfUFNSX0VOQUJMRSk7Cj4g
ICAJfQo+IC0JZGV2X3ByaXYtPnBzci5hY3RpdmUgPSBmYWxzZTsKPiArCWk5MTUtPnBzci5hY3Rp
dmUgPSBmYWxzZTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgaW50ZWxfcHNyX2Rpc2FibGVf
bG9ja2VkKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gICAJaTkxNV9y
ZWdfdCBwc3Jfc3RhdHVzOwo+ICAgCXUzMiBwc3Jfc3RhdHVzX21hc2s7Cj4gICAKPiAtCWxvY2tk
ZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5wc3IubG9jayk7Cj4gKwlsb2NrZGVwX2Fzc2VydF9o
ZWxkKCZpOTE1LT5wc3IubG9jayk7Cj4gICAKPiAtCWlmICghZGV2X3ByaXYtPnBzci5lbmFibGVk
KQo+ICsJaWYgKCFpOTE1LT5wc3IuZW5hYmxlZCkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJRFJN
X0RFQlVHX0tNUygiRGlzYWJsaW5nIFBTUiVzXG4iLAo+IC0JCSAgICAgIGRldl9wcml2LT5wc3Iu
cHNyMl9lbmFibGVkID8gIjIiIDogIjEiKTsKPiArCQkgICAgICBpOTE1LT5wc3IucHNyMl9lbmFi
bGVkID8gIjIiIDogIjEiKTsKPiAgIAo+IC0JaW50ZWxfcHNyX2V4aXQoZGV2X3ByaXYpOwo+ICsJ
aW50ZWxfcHNyX2V4aXQoaTkxNSk7Cj4gICAKPiAtCWlmIChkZXZfcHJpdi0+cHNyLnBzcjJfZW5h
YmxlZCkgewo+ICsJaWYgKGk5MTUtPnBzci5wc3IyX2VuYWJsZWQpIHsKPiAgIAkJcHNyX3N0YXR1
cyA9IEVEUF9QU1IyX1NUQVRVUzsKPiAgIAkJcHNyX3N0YXR1c19tYXNrID0gRURQX1BTUjJfU1RB
VFVTX1NUQVRFX01BU0s7Cj4gICAJfSBlbHNlIHsKPiBAQCAtODI0LDE0ICs4MjQsMTQgQEAgc3Rh
dGljIHZvaWQgaW50ZWxfcHNyX2Rpc2FibGVfbG9ja2VkKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxf
ZHApCj4gICAJfQo+ICAgCj4gICAJLyogV2FpdCB0aWxsIFBTUiBpcyBpZGxlICovCj4gLQlpZiAo
aW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gKwlpZiAoaW50ZWxf
d2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiAgIAkJCQkgICAgcHNyX3N0YXR1cywg
cHNyX3N0YXR1c19tYXNrLCAwLCAyMDAwKSkKPiAgIAkJRFJNX0VSUk9SKCJUaW1lZCBvdXQgd2Fp
dGluZyBQU1IgaWRsZSBzdGF0ZVxuIik7Cj4gICAKPiAgIAkvKiBEaXNhYmxlIFBTUiBvbiBTaW5r
ICovCj4gICAJZHJtX2RwX2RwY2Rfd3JpdGViKCZpbnRlbF9kcC0+YXV4LCBEUF9QU1JfRU5fQ0ZH
LCAwKTsKPiAgIAo+IC0JZGV2X3ByaXYtPnBzci5lbmFibGVkID0gZmFsc2U7Cj4gKwlpOTE1LT5w
c3IuZW5hYmxlZCA9IGZhbHNlOwo+ICAgfQo+ICAgCj4gICAvKioKPiBAQCAtODQ0LDIzICs4NDQs
MjMgQEAgc3RhdGljIHZvaWQgaW50ZWxfcHNyX2Rpc2FibGVfbG9ja2VkKHN0cnVjdCBpbnRlbF9k
cCAqaW50ZWxfZHApCj4gICB2b2lkIGludGVsX3Bzcl9kaXNhYmxlKHN0cnVjdCBpbnRlbF9kcCAq
aW50ZWxfZHAsCj4gICAJCSAgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xk
X2NydGNfc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSBkcF90b19pOTE1KGludGVsX2RwKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gICAKPiAgIAlpZiAoIW9sZF9jcnRjX3N0YXRlLT5o
YXNfcHNyKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCWlmIChXQVJOX09OKCFDQU5fUFNSKGRldl9w
cml2KSkpCj4gKwlpZiAoV0FSTl9PTighQ0FOX1BTUihpOTE1KSkpCj4gICAJCXJldHVybjsKPiAg
IAo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPnBzci5sb2NrKTsKPiArCW11dGV4X2xvY2soJmk5
MTUtPnBzci5sb2NrKTsKPiAgIAo+ICAgCWludGVsX3Bzcl9kaXNhYmxlX2xvY2tlZChpbnRlbF9k
cCk7Cj4gICAKPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPnBzci5sb2NrKTsKPiAtCWNhbmNl
bF93b3JrX3N5bmMoJmRldl9wcml2LT5wc3Iud29yayk7Cj4gKwltdXRleF91bmxvY2soJmk5MTUt
PnBzci5sb2NrKTsKPiArCWNhbmNlbF93b3JrX3N5bmMoJmk5MTUtPnBzci53b3JrKTsKPiAgIH0K
PiAgIAo+IC1zdGF0aWMgdm9pZCBwc3JfZm9yY2VfaHdfdHJhY2tpbmdfZXhpdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyB2b2lkIHBzcl9mb3JjZV9od190cmFj
a2luZ19leGl0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCS8qCj4g
ICAJICogRGlzcGxheSBXQSAjMDg4NDogYWxsCj4gQEAgLTg3MSw3ICs4NzEsNyBAQCBzdGF0aWMg
dm9pZCBwc3JfZm9yY2VfaHdfdHJhY2tpbmdfZXhpdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gICAJICogYnV0IGl0IG1ha2VzIG1vcmUgc2Vuc2Ugd3JpdGUgdG8gdGhlIGN1
cnJlbnQgYWN0aXZlCj4gICAJICogcGlwZS4KPiAgIAkgKi8KPiAtCUk5MTVfV1JJVEUoQ1VSU1VS
RkxJVkUoZGV2X3ByaXYtPnBzci5waXBlKSwgMCk7Cj4gKwlJOTE1X1dSSVRFKENVUlNVUkZMSVZF
KGk5MTUtPnBzci5waXBlKSwgMCk7Cj4gICB9Cj4gICAKPiAgIC8qKgo+IEBAIC04ODYsMjIgKzg4
NiwyMiBAQCBzdGF0aWMgdm9pZCBwc3JfZm9yY2VfaHdfdHJhY2tpbmdfZXhpdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICB2b2lkIGludGVsX3Bzcl91cGRhdGUoc3RydWN0
IGludGVsX2RwICppbnRlbF9kcCwKPiAgIAkJICAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiAtCXN0cnVjdCBpOTE1X3BzciAqcHNyID0g
JmRldl9wcml2LT5wc3I7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3Rv
X2k5MTUoaW50ZWxfZHApOwo+ICsJc3RydWN0IGk5MTVfcHNyICpwc3IgPSAmaTkxNS0+cHNyOwo+
ICAgCWJvb2wgZW5hYmxlLCBwc3IyX2VuYWJsZTsKPiAgIAo+IC0JaWYgKCFDQU5fUFNSKGRldl9w
cml2KSB8fCBSRUFEX09OQ0UocHNyLT5kcCkgIT0gaW50ZWxfZHApCj4gKwlpZiAoIUNBTl9QU1Io
aTkxNSkgfHwgUkVBRF9PTkNFKHBzci0+ZHApICE9IGludGVsX2RwKQo+ICAgCQlyZXR1cm47Cj4g
ICAKPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5wc3IubG9jayk7Cj4gKwltdXRleF9sb2NrKCZp
OTE1LT5wc3IubG9jayk7Cj4gICAKPiAgIAllbmFibGUgPSBjcnRjX3N0YXRlLT5oYXNfcHNyICYm
IHBzcl9nbG9iYWxfZW5hYmxlZChwc3ItPmRlYnVnKTsKPiAtCXBzcjJfZW5hYmxlID0gaW50ZWxf
cHNyMl9lbmFibGVkKGRldl9wcml2LCBjcnRjX3N0YXRlKTsKPiArCXBzcjJfZW5hYmxlID0gaW50
ZWxfcHNyMl9lbmFibGVkKGk5MTUsIGNydGNfc3RhdGUpOwo+ICAgCj4gICAJaWYgKGVuYWJsZSA9
PSBwc3ItPmVuYWJsZWQgJiYgcHNyMl9lbmFibGUgPT0gcHNyLT5wc3IyX2VuYWJsZWQpIHsKPiAg
IAkJLyogRm9yY2UgYSBQU1IgZXhpdCB3aGVuIGVuYWJsaW5nIENSQyB0byBhdm9pZCBDUkMgdGlt
ZW91dHMgKi8KPiAgIAkJaWYgKGNydGNfc3RhdGUtPmNyY19lbmFibGVkICYmIHBzci0+ZW5hYmxl
ZCkKPiAtCQkJcHNyX2ZvcmNlX2h3X3RyYWNraW5nX2V4aXQoZGV2X3ByaXYpOwo+ICsJCQlwc3Jf
Zm9yY2VfaHdfdHJhY2tpbmdfZXhpdChpOTE1KTsKPiAgIAo+ICAgCQlnb3RvIHVubG9jazsKPiAg
IAl9Cj4gQEAgLTkxMCwxMCArOTEwLDEwIEBAIHZvaWQgaW50ZWxfcHNyX3VwZGF0ZShzdHJ1Y3Qg
aW50ZWxfZHAgKmludGVsX2RwLAo+ICAgCQlpbnRlbF9wc3JfZGlzYWJsZV9sb2NrZWQoaW50ZWxf
ZHApOwo+ICAgCj4gICAJaWYgKGVuYWJsZSkKPiAtCQlpbnRlbF9wc3JfZW5hYmxlX2xvY2tlZChk
ZXZfcHJpdiwgY3J0Y19zdGF0ZSk7Cj4gKwkJaW50ZWxfcHNyX2VuYWJsZV9sb2NrZWQoaTkxNSwg
Y3J0Y19zdGF0ZSk7Cj4gICAKPiAgIHVubG9jazoKPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYt
PnBzci5sb2NrKTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+cHNyLmxvY2spOwo+ICAgfQo+ICAg
Cj4gICAvKioKPiBAQCAtOTMwLDEzICs5MzAsMTMgQEAgaW50IGludGVsX3Bzcl93YWl0X2Zvcl9p
ZGxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0ZSwKPiAgIAkJ
CSAgICB1MzIgKm91dF92YWx1ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9
IHRvX2ludGVsX2NydGMobmV3X2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4g
ICAKPiAtCWlmICghZGV2X3ByaXYtPnBzci5lbmFibGVkIHx8ICFuZXdfY3J0Y19zdGF0ZS0+aGFz
X3BzcikKPiArCWlmICghaTkxNS0+cHNyLmVuYWJsZWQgfHwgIW5ld19jcnRjX3N0YXRlLT5oYXNf
cHNyKQo+ICAgCQlyZXR1cm4gMDsKPiAgIAo+ICAgCS8qIEZJWE1FOiBVcGRhdGUgdGhpcyBmb3Ig
UFNSMiBpZiB3ZSBuZWVkIHRvIHdhaXQgZm9yIGlkbGUgKi8KPiAtCWlmIChSRUFEX09OQ0UoZGV2
X3ByaXYtPnBzci5wc3IyX2VuYWJsZWQpKQo+ICsJaWYgKFJFQURfT05DRShpOTE1LT5wc3IucHNy
Ml9lbmFibGVkKSkKPiAgIAkJcmV0dXJuIDA7Cj4gICAKPiAgIAkvKgo+IEBAIC05NDYsMjIgKzk0
NiwyMiBAQCBpbnQgaW50ZWxfcHNyX3dhaXRfZm9yX2lkbGUoY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlLAo+ICAgCSAqIGRlZmVuc2l2ZSBlbm91Z2ggdG8gY292
ZXIgZXZlcnl0aGluZy4KPiAgIAkgKi8KPiAgIAo+IC0JcmV0dXJuIF9faW50ZWxfd2FpdF9mb3Jf
cmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsIEVEUF9QU1JfU1RBVFVTLAo+ICsJcmV0dXJuIF9f
aW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwgRURQX1BTUl9TVEFUVVMsCj4g
ICAJCQkJCSBFRFBfUFNSX1NUQVRVU19TVEFURV9NQVNLLAo+ICAgCQkJCQkgRURQX1BTUl9TVEFU
VVNfU1RBVEVfSURMRSwgMiwgNTAsCj4gICAJCQkJCSBvdXRfdmFsdWUpOwo+ICAgfQo+ICAgCj4g
LXN0YXRpYyBib29sIF9fcHNyX3dhaXRfZm9yX2lkbGVfbG9ja2VkKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiArc3RhdGljIGJvb2wgX19wc3Jfd2FpdF9mb3JfaWRsZV9sb2Nr
ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJaTkxNV9yZWdfdCBy
ZWc7Cj4gICAJdTMyIG1hc2s7Cj4gICAJaW50IGVycjsKPiAgIAo+IC0JaWYgKCFkZXZfcHJpdi0+
cHNyLmVuYWJsZWQpCj4gKwlpZiAoIWk5MTUtPnBzci5lbmFibGVkKQo+ICAgCQlyZXR1cm4gZmFs
c2U7Cj4gICAKPiAtCWlmIChkZXZfcHJpdi0+cHNyLnBzcjJfZW5hYmxlZCkgewo+ICsJaWYgKGk5
MTUtPnBzci5wc3IyX2VuYWJsZWQpIHsKPiAgIAkJcmVnID0gRURQX1BTUjJfU1RBVFVTOwo+ICAg
CQltYXNrID0gRURQX1BTUjJfU1RBVFVTX1NUQVRFX01BU0s7Cj4gICAJfSBlbHNlIHsKPiBAQCAt
OTY5LDIwICs5NjksMjAgQEAgc3RhdGljIGJvb2wgX19wc3Jfd2FpdF9mb3JfaWRsZV9sb2NrZWQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCQltYXNrID0gRURQX1BTUl9T
VEFUVVNfU1RBVEVfTUFTSzsKPiAgIAl9Cj4gICAKPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYt
PnBzci5sb2NrKTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+cHNyLmxvY2spOwo+ICAgCj4gLQll
cnIgPSBpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwgcmVnLCBtYXNr
LCAwLCA1MCk7Cj4gKwllcnIgPSBpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3Jl
LCByZWcsIG1hc2ssIDAsIDUwKTsKPiAgIAlpZiAoZXJyKQo+ICAgCQlEUk1fRVJST1IoIlRpbWVk
IG91dCB3YWl0aW5nIGZvciBQU1IgSWRsZSBmb3IgcmUtZW5hYmxlXG4iKTsKPiAgIAo+ICAgCS8q
IEFmdGVyIHRoZSB1bmxvY2tlZCB3YWl0LCB2ZXJpZnkgdGhhdCBQU1IgaXMgc3RpbGwgd2FudGVk
ISAqLwo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPnBzci5sb2NrKTsKPiAtCXJldHVybiBlcnIg
PT0gMCAmJiBkZXZfcHJpdi0+cHNyLmVuYWJsZWQ7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT5wc3Iu
bG9jayk7Cj4gKwlyZXR1cm4gZXJyID09IDAgJiYgaTkxNS0+cHNyLmVuYWJsZWQ7Cj4gICB9Cj4g
ICAKPiAtc3RhdGljIGludCBpbnRlbF9wc3JfZmFzdHNldF9mb3JjZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gK3N0YXRpYyBpbnQgaW50ZWxfcHNyX2Zhc3RzZXRfZm9yY2Uo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2ID0gJmRldl9wcml2LT5kcm07Cj4gKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmk5
MTUtPmRybTsKPiAgIAlzdHJ1Y3QgZHJtX21vZGVzZXRfYWNxdWlyZV9jdHggY3R4Owo+ICAgCXN0
cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZTsKPiAgIAlzdHJ1Y3QgZHJtX2NydGMgKmNydGM7
Cj4gQEAgLTEwMzIsNyArMTAzMiw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfcHNyX2Zhc3RzZXRfZm9y
Y2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCXJldHVybiBlcnI7Cj4g
ICB9Cj4gICAKPiAtaW50IGludGVsX3Bzcl9kZWJ1Z19zZXQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LCB1NjQgdmFsKQo+ICtpbnQgaW50ZWxfcHNyX2RlYnVnX3NldChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTY0IHZhbCkKPiAgIHsKPiAgIAljb25zdCB1MzIgbW9k
ZSA9IHZhbCAmIEk5MTVfUFNSX0RFQlVHX01PREVfTUFTSzsKPiAgIAl1MzIgb2xkX21vZGU7Cj4g
QEAgLTEwNDQsMjUgKzEwNDQsMjUgQEAgaW50IGludGVsX3Bzcl9kZWJ1Z19zZXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1NjQgdmFsKQo+ICAgCQlyZXR1cm4gLUVJTlZBTDsK
PiAgIAl9Cj4gICAKPiAtCXJldCA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmZGV2X3ByaXYt
PnBzci5sb2NrKTsKPiArCXJldCA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmaTkxNS0+cHNy
LmxvY2spOwo+ICAgCWlmIChyZXQpCj4gICAJCXJldHVybiByZXQ7Cj4gICAKPiAtCW9sZF9tb2Rl
ID0gZGV2X3ByaXYtPnBzci5kZWJ1ZyAmIEk5MTVfUFNSX0RFQlVHX01PREVfTUFTSzsKPiAtCWRl
dl9wcml2LT5wc3IuZGVidWcgPSB2YWw7Cj4gLQlpbnRlbF9wc3JfaXJxX2NvbnRyb2woZGV2X3By
aXYsIGRldl9wcml2LT5wc3IuZGVidWcpOwo+ICsJb2xkX21vZGUgPSBpOTE1LT5wc3IuZGVidWcg
JiBJOTE1X1BTUl9ERUJVR19NT0RFX01BU0s7Cj4gKwlpOTE1LT5wc3IuZGVidWcgPSB2YWw7Cj4g
KwlpbnRlbF9wc3JfaXJxX2NvbnRyb2woaTkxNSwgaTkxNS0+cHNyLmRlYnVnKTsKPiAgIAo+IC0J
bXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2spOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1
LT5wc3IubG9jayk7Cj4gICAKPiAgIAlpZiAob2xkX21vZGUgIT0gbW9kZSkKPiAtCQlyZXQgPSBp
bnRlbF9wc3JfZmFzdHNldF9mb3JjZShkZXZfcHJpdik7Cj4gKwkJcmV0ID0gaW50ZWxfcHNyX2Zh
c3RzZXRfZm9yY2UoaTkxNSk7Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+ICAgCj4gLXN0
YXRpYyB2b2lkIGludGVsX3Bzcl9oYW5kbGVfaXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiArc3RhdGljIHZvaWQgaW50ZWxfcHNyX2hhbmRsZV9pcnEoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlzdHJ1Y3QgaTkxNV9wc3IgKnBzciA9ICZkZXZf
cHJpdi0+cHNyOwo+ICsJc3RydWN0IGk5MTVfcHNyICpwc3IgPSAmaTkxNS0+cHNyOwo+ICAgCj4g
ICAJaW50ZWxfcHNyX2Rpc2FibGVfbG9ja2VkKHBzci0+ZHApOwo+ICAgCXBzci0+c2lua19ub3Rf
cmVsaWFibGUgPSB0cnVlOwo+IEBAIC0xMDcyLDE2ICsxMDcyLDE2IEBAIHN0YXRpYyB2b2lkIGlu
dGVsX3Bzcl9oYW5kbGVfaXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAg
IAo+ICAgc3RhdGljIHZvaWQgaW50ZWxfcHNyX3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3Jr
KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0KPiAtCQljb250
YWluZXJfb2Yod29yaywgdHlwZW9mKCpkZXZfcHJpdiksIHBzci53b3JrKTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0KPiArCQljb250YWluZXJfb2Yod29yaywgdHlwZW9mKCpp
OTE1KSwgcHNyLndvcmspOwo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2sp
Owo+ICsJbXV0ZXhfbG9jaygmaTkxNS0+cHNyLmxvY2spOwo+ICAgCj4gLQlpZiAoIWRldl9wcml2
LT5wc3IuZW5hYmxlZCkKPiArCWlmICghaTkxNS0+cHNyLmVuYWJsZWQpCj4gICAJCWdvdG8gdW5s
b2NrOwo+ICAgCj4gLQlpZiAoUkVBRF9PTkNFKGRldl9wcml2LT5wc3IuaXJxX2F1eF9lcnJvcikp
Cj4gLQkJaW50ZWxfcHNyX2hhbmRsZV9pcnEoZGV2X3ByaXYpOwo+ICsJaWYgKFJFQURfT05DRShp
OTE1LT5wc3IuaXJxX2F1eF9lcnJvcikpCj4gKwkJaW50ZWxfcHNyX2hhbmRsZV9pcnEoaTkxNSk7
Cj4gICAKPiAgIAkvKgo+ICAgCSAqIFdlIGhhdmUgdG8gbWFrZSBzdXJlIFBTUiBpcyByZWFkeSBm
b3IgcmUtZW5hYmxlCj4gQEAgLTEwODksNyArMTA4OSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3Bz
cl93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiAgIAkgKiBQU1IgbWlnaHQgdGFrZSBz
b21lIHRpbWUgdG8gZ2V0IGZ1bGx5IGRpc2FibGVkCj4gICAJICogYW5kIGJlIHJlYWR5IGZvciBy
ZS1lbmFibGUuCj4gICAJICovCj4gLQlpZiAoIV9fcHNyX3dhaXRfZm9yX2lkbGVfbG9ja2VkKGRl
dl9wcml2KSkKPiArCWlmICghX19wc3Jfd2FpdF9mb3JfaWRsZV9sb2NrZWQoaTkxNSkpCj4gICAJ
CWdvdG8gdW5sb2NrOwo+ICAgCj4gICAJLyoKPiBAQCAtMTA5NywxNyArMTA5NywxNyBAQCBzdGF0
aWMgdm9pZCBpbnRlbF9wc3Jfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gICAJICog
cmVjaGVjay4gU2luY2UgcHNyX2ZsdXNoIGZpcnN0IGNsZWFycyB0aGlzIGFuZCB0aGVuIHJlc2No
ZWR1bGVzIHdlCj4gICAJICogd29uJ3QgZXZlciBtaXNzIGEgZmx1c2ggd2hlbiBiYWlsaW5nIG91
dCBoZXJlLgo+ICAgCSAqLwo+IC0JaWYgKGRldl9wcml2LT5wc3IuYnVzeV9mcm9udGJ1ZmZlcl9i
aXRzIHx8IGRldl9wcml2LT5wc3IuYWN0aXZlKQo+ICsJaWYgKGk5MTUtPnBzci5idXN5X2Zyb250
YnVmZmVyX2JpdHMgfHwgaTkxNS0+cHNyLmFjdGl2ZSkKPiAgIAkJZ290byB1bmxvY2s7Cj4gICAK
PiAtCWludGVsX3Bzcl9hY3RpdmF0ZShkZXZfcHJpdi0+cHNyLmRwKTsKPiArCWludGVsX3Bzcl9h
Y3RpdmF0ZShpOTE1LT5wc3IuZHApOwo+ICAgdW5sb2NrOgo+IC0JbXV0ZXhfdW5sb2NrKCZkZXZf
cHJpdi0+cHNyLmxvY2spOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5wc3IubG9jayk7Cj4gICB9
Cj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxfcHNyX2ludmFsaWRhdGUgLSBJbnZhbGlkYWRlIFBT
Ugo+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlCj4gKyAqIEBpOTE1OiBpOTE1IGRldmljZQo+
ICAgICogQGZyb250YnVmZmVyX2JpdHM6IGZyb250YnVmZmVyIHBsYW5lIHRyYWNraW5nIGJpdHMK
PiAgICAqIEBvcmlnaW46IHdoaWNoIG9wZXJhdGlvbiBjYXVzZWQgdGhlIGludmFsaWRhdGUKPiAg
ICAqCj4gQEAgLTExMTgsMzMgKzExMTgsMzMgQEAgc3RhdGljIHZvaWQgaW50ZWxfcHNyX3dvcmso
c3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAgICoKPiAgICAqIERpcnR5IGZyb250YnVmZmVy
cyByZWxldmFudCB0byBQU1IgYXJlIHRyYWNrZWQgaW4gYnVzeV9mcm9udGJ1ZmZlcl9iaXRzLiIK
PiAgICAqLwo+IC12b2lkIGludGVsX3Bzcl9pbnZhbGlkYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiArdm9pZCBpbnRlbF9wc3JfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgdW5zaWduZWQgZnJvbnRidWZmZXJfYml0cywgZW51
bSBmYl9vcF9vcmlnaW4gb3JpZ2luKQo+ICAgewo+IC0JaWYgKCFDQU5fUFNSKGRldl9wcml2KSkK
PiArCWlmICghQ0FOX1BTUihpOTE1KSkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJaWYgKG9yaWdp
biA9PSBPUklHSU5fRkxJUCkKPiAgIAkJcmV0dXJuOwo+ICAgCj4gLQltdXRleF9sb2NrKCZkZXZf
cHJpdi0+cHNyLmxvY2spOwo+IC0JaWYgKCFkZXZfcHJpdi0+cHNyLmVuYWJsZWQpIHsKPiAtCQlt
dXRleF91bmxvY2soJmRldl9wcml2LT5wc3IubG9jayk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT5w
c3IubG9jayk7Cj4gKwlpZiAoIWk5MTUtPnBzci5lbmFibGVkKSB7Cj4gKwkJbXV0ZXhfdW5sb2Nr
KCZpOTE1LT5wc3IubG9jayk7Cj4gICAJCXJldHVybjsKPiAgIAl9Cj4gICAKPiAtCWZyb250YnVm
ZmVyX2JpdHMgJj0gSU5URUxfRlJPTlRCVUZGRVJfQUxMX01BU0soZGV2X3ByaXYtPnBzci5waXBl
KTsKPiAtCWRldl9wcml2LT5wc3IuYnVzeV9mcm9udGJ1ZmZlcl9iaXRzIHw9IGZyb250YnVmZmVy
X2JpdHM7Cj4gKwlmcm9udGJ1ZmZlcl9iaXRzICY9IElOVEVMX0ZST05UQlVGRkVSX0FMTF9NQVNL
KGk5MTUtPnBzci5waXBlKTsKPiArCWk5MTUtPnBzci5idXN5X2Zyb250YnVmZmVyX2JpdHMgfD0g
ZnJvbnRidWZmZXJfYml0czsKPiAgIAo+ICAgCWlmIChmcm9udGJ1ZmZlcl9iaXRzKQo+IC0JCWlu
dGVsX3Bzcl9leGl0KGRldl9wcml2KTsKPiArCQlpbnRlbF9wc3JfZXhpdChpOTE1KTsKPiAgIAo+
IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2spOwo+ICsJbXV0ZXhfdW5sb2NrKCZp
OTE1LT5wc3IubG9jayk7Cj4gICB9Cj4gICAKPiAgIC8qKgo+ICAgICogaW50ZWxfcHNyX2ZsdXNo
IC0gRmx1c2ggUFNSCj4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UKPiArICogQGk5MTU6IGk5
MTUgZGV2aWNlCj4gICAgKiBAZnJvbnRidWZmZXJfYml0czogZnJvbnRidWZmZXIgcGxhbmUgdHJh
Y2tpbmcgYml0cwo+ICAgICogQG9yaWdpbjogd2hpY2ggb3BlcmF0aW9uIGNhdXNlZCB0aGUgZmx1
c2gKPiAgICAqCj4gQEAgLTExNTUsNTUgKzExNTUsNTUgQEAgdm9pZCBpbnRlbF9wc3JfaW52YWxp
ZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAgKgo+ICAgICogRGly
dHkgZnJvbnRidWZmZXJzIHJlbGV2YW50IHRvIFBTUiBhcmUgdHJhY2tlZCBpbiBidXN5X2Zyb250
YnVmZmVyX2JpdHMuCj4gICAgKi8KPiAtdm9pZCBpbnRlbF9wc3JfZmx1c2goc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICt2b2lkIGludGVsX3Bzcl9mbHVzaChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJICAgICB1bnNpZ25lZCBmcm9udGJ1ZmZlcl9iaXRz
LCBlbnVtIGZiX29wX29yaWdpbiBvcmlnaW4pCj4gICB7Cj4gLQlpZiAoIUNBTl9QU1IoZGV2X3By
aXYpKQo+ICsJaWYgKCFDQU5fUFNSKGk5MTUpKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAlpZiAo
b3JpZ2luID09IE9SSUdJTl9GTElQKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCW11dGV4X2xvY2so
JmRldl9wcml2LT5wc3IubG9jayk7Cj4gLQlpZiAoIWRldl9wcml2LT5wc3IuZW5hYmxlZCkgewo+
IC0JCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPnBzci5sb2NrKTsKPiArCW11dGV4X2xvY2soJmk5
MTUtPnBzci5sb2NrKTsKPiArCWlmICghaTkxNS0+cHNyLmVuYWJsZWQpIHsKPiArCQltdXRleF91
bmxvY2soJmk5MTUtPnBzci5sb2NrKTsKPiAgIAkJcmV0dXJuOwo+ICAgCX0KPiAgIAo+IC0JZnJv
bnRidWZmZXJfYml0cyAmPSBJTlRFTF9GUk9OVEJVRkZFUl9BTExfTUFTSyhkZXZfcHJpdi0+cHNy
LnBpcGUpOwo+IC0JZGV2X3ByaXYtPnBzci5idXN5X2Zyb250YnVmZmVyX2JpdHMgJj0gfmZyb250
YnVmZmVyX2JpdHM7Cj4gKwlmcm9udGJ1ZmZlcl9iaXRzICY9IElOVEVMX0ZST05UQlVGRkVSX0FM
TF9NQVNLKGk5MTUtPnBzci5waXBlKTsKPiArCWk5MTUtPnBzci5idXN5X2Zyb250YnVmZmVyX2Jp
dHMgJj0gfmZyb250YnVmZmVyX2JpdHM7Cj4gICAKPiAgIAkvKiBCeSBkZWZpbml0aW9uIGZsdXNo
ID0gaW52YWxpZGF0ZSArIGZsdXNoICovCj4gICAJaWYgKGZyb250YnVmZmVyX2JpdHMpCj4gLQkJ
cHNyX2ZvcmNlX2h3X3RyYWNraW5nX2V4aXQoZGV2X3ByaXYpOwo+ICsJCXBzcl9mb3JjZV9od190
cmFja2luZ19leGl0KGk5MTUpOwo+ICAgCj4gLQlpZiAoIWRldl9wcml2LT5wc3IuYWN0aXZlICYm
ICFkZXZfcHJpdi0+cHNyLmJ1c3lfZnJvbnRidWZmZXJfYml0cykKPiAtCQlzY2hlZHVsZV93b3Jr
KCZkZXZfcHJpdi0+cHNyLndvcmspOwo+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+cHNyLmxv
Y2spOwo+ICsJaWYgKCFpOTE1LT5wc3IuYWN0aXZlICYmICFpOTE1LT5wc3IuYnVzeV9mcm9udGJ1
ZmZlcl9iaXRzKQo+ICsJCXNjaGVkdWxlX3dvcmsoJmk5MTUtPnBzci53b3JrKTsKPiArCW11dGV4
X3VubG9jaygmaTkxNS0+cHNyLmxvY2spOwo+ICAgfQo+ICAgCj4gICAvKioKPiAgICAqIGludGVs
X3Bzcl9pbml0IC0gSW5pdCBiYXNpYyBQU1Igd29yayBhbmQgbXV0ZXguCj4gLSAqIEBkZXZfcHJp
djogaTkxNSBkZXZpY2UgcHJpdmF0ZQo+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UgcHJpdmF0ZQo+
ICAgICoKPiAgICAqIFRoaXMgZnVuY3Rpb24gaXMgIGNhbGxlZCBvbmx5IG9uY2UgYXQgZHJpdmVy
IGxvYWQgdG8gaW5pdGlhbGl6ZSBiYXNpYwo+ICAgICogUFNSIHN0dWZmLgo+ICAgICovCj4gLXZv
aWQgaW50ZWxfcHNyX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICt2
b2lkIGludGVsX3Bzcl9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+
ICAgCXUzMiB2YWw7Cj4gICAKPiAtCWlmICghSEFTX1BTUihkZXZfcHJpdikpCj4gKwlpZiAoIUhB
U19QU1IoaTkxNSkpCj4gICAJCXJldHVybjsKPiAgIAo+IC0JZGV2X3ByaXYtPnBzcl9tbWlvX2Jh
c2UgPSBJU19IQVNXRUxMKGRldl9wcml2KSA/Cj4gKwlpOTE1LT5wc3JfbW1pb19iYXNlID0gSVNf
SEFTV0VMTChpOTE1KSA/Cj4gICAJCUhTV19FRFBfUFNSX0JBU0UgOiBCRFdfRURQX1BTUl9CQVNF
Owo+ICAgCj4gLQlpZiAoIWRldl9wcml2LT5wc3Iuc2lua19zdXBwb3J0KQo+ICsJaWYgKCFpOTE1
LT5wc3Iuc2lua19zdXBwb3J0KQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAlpZiAoaTkxNV9tb2Rw
YXJhbXMuZW5hYmxlX3BzciA9PSAtMSkKPiAtCQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDkg
fHwgIWRldl9wcml2LT52YnQucHNyLmVuYWJsZSkKPiArCQlpZiAoSU5URUxfR0VOKGk5MTUpIDwg
OSB8fCAhaTkxNS0+dmJ0LnBzci5lbmFibGUpCj4gICAJCQlpOTE1X21vZHBhcmFtcy5lbmFibGVf
cHNyID0gMDsKPiAgIAo+ICAgCS8qCj4gQEAgLTEyMTgsMzEgKzEyMTgsMzEgQEAgdm9pZCBpbnRl
bF9wc3JfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJdmFsICY9
IEVEUF9QU1JfRVJST1IoZWRwX3Bzcl9zaGlmdChUUkFOU0NPREVSX0VEUCkpOwo+ICAgCWlmICh2
YWwpIHsKPiAgIAkJRFJNX0RFQlVHX0tNUygiUFNSIGludGVycnVwdGlvbiBlcnJvciBzZXRcbiIp
Owo+IC0JCWRldl9wcml2LT5wc3Iuc2lua19ub3RfcmVsaWFibGUgPSB0cnVlOwo+ICsJCWk5MTUt
PnBzci5zaW5rX25vdF9yZWxpYWJsZSA9IHRydWU7Cj4gICAJfQo+ICAgCj4gICAJLyogU2V0IGxp
bmtfc3RhbmRieSB4IGxpbmtfb2ZmIGRlZmF1bHRzICovCj4gLQlpZiAoSVNfSEFTV0VMTChkZXZf
cHJpdikgfHwgSVNfQlJPQURXRUxMKGRldl9wcml2KSkKPiArCWlmIChJU19IQVNXRUxMKGk5MTUp
IHx8IElTX0JST0FEV0VMTChpOTE1KSkKPiAgIAkJLyogSFNXIGFuZCBCRFcgcmVxdWlyZSB3b3Jr
YXJvdW5kcyB0aGF0IHdlIGRvbid0IGltcGxlbWVudC4gKi8KPiAtCQlkZXZfcHJpdi0+cHNyLmxp
bmtfc3RhbmRieSA9IGZhbHNlOwo+ICsJCWk5MTUtPnBzci5saW5rX3N0YW5kYnkgPSBmYWxzZTsK
PiAgIAllbHNlCj4gICAJCS8qIEZvciBuZXcgcGxhdGZvcm1zIGxldCdzIHJlc3BlY3QgVkJUIGJh
Y2sgYWdhaW4gKi8KPiAtCQlkZXZfcHJpdi0+cHNyLmxpbmtfc3RhbmRieSA9IGRldl9wcml2LT52
YnQucHNyLmZ1bGxfbGluazsKPiArCQlpOTE1LT5wc3IubGlua19zdGFuZGJ5ID0gaTkxNS0+dmJ0
LnBzci5mdWxsX2xpbms7Cj4gICAKPiAtCUlOSVRfV09SSygmZGV2X3ByaXYtPnBzci53b3JrLCBp
bnRlbF9wc3Jfd29yayk7Cj4gLQltdXRleF9pbml0KCZkZXZfcHJpdi0+cHNyLmxvY2spOwo+ICsJ
SU5JVF9XT1JLKCZpOTE1LT5wc3Iud29yaywgaW50ZWxfcHNyX3dvcmspOwo+ICsJbXV0ZXhfaW5p
dCgmaTkxNS0+cHNyLmxvY2spOwo+ICAgfQo+ICAgCj4gICB2b2lkIGludGVsX3Bzcl9zaG9ydF9w
dWxzZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gLQlzdHJ1Y3QgaTkx
NV9wc3IgKnBzciA9ICZkZXZfcHJpdi0+cHNyOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiArCXN0cnVjdCBpOTE1X3BzciAqcHNyID0g
Jmk5MTUtPnBzcjsKPiAgIAl1OCB2YWw7Cj4gICAJY29uc3QgdTggZXJyb3JzID0gRFBfUFNSX1JG
Ql9TVE9SQUdFX0VSUk9SIHwKPiAgIAkJCSAgRFBfUFNSX1ZTQ19TRFBfVU5DT1JSRUNUQUJMRV9F
UlJPUiB8Cj4gICAJCQkgIERQX1BTUl9MSU5LX0NSQ19FUlJPUjsKPiAgIAo+IC0JaWYgKCFDQU5f
UFNSKGRldl9wcml2KSB8fCAhaW50ZWxfZHBfaXNfZWRwKGludGVsX2RwKSkKPiArCWlmICghQ0FO
X1BTUihpOTE1KSB8fCAhaW50ZWxfZHBfaXNfZWRwKGludGVsX2RwKSkKPiAgIAkJcmV0dXJuOwo+
ICAgCj4gICAJbXV0ZXhfbG9jaygmcHNyLT5sb2NrKTsKPiBAQCAtMTI4OCwxNSArMTI4OCwxNSBA
QCB2b2lkIGludGVsX3Bzcl9zaG9ydF9wdWxzZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+
ICAgCj4gICBib29sIGludGVsX3Bzcl9lbmFibGVkKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAp
Cj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1
KGludGVsX2RwKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkx
NShpbnRlbF9kcCk7Cj4gICAJYm9vbCByZXQ7Cj4gICAKPiAtCWlmICghQ0FOX1BTUihkZXZfcHJp
dikgfHwgIWludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkpCj4gKwlpZiAoIUNBTl9QU1IoaTkxNSkg
fHwgIWludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkpCj4gICAJCXJldHVybiBmYWxzZTsKPiAgIAo+
IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPnBzci5sb2NrKTsKPiAtCXJldCA9IChkZXZfcHJpdi0+
cHNyLmRwID09IGludGVsX2RwICYmIGRldl9wcml2LT5wc3IuZW5hYmxlZCk7Cj4gLQltdXRleF91
bmxvY2soJmRldl9wcml2LT5wc3IubG9jayk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT5wc3IubG9j
ayk7Cj4gKwlyZXQgPSAoaTkxNS0+cHNyLmRwID09IGludGVsX2RwICYmIGk5MTUtPnBzci5lbmFi
bGVkKTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+cHNyLmxvY2spOwo+ICAgCj4gICAJcmV0dXJu
IHJldDsKPiAgIH0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcHNy
LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wc3IuaAo+IGluZGV4IGRjODE4ODI2ZjM2
ZC4uOGEzZGRjNGFlNDRkIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X3Bzci5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcHNyLmgKPiBAQCAtMTIs
NyArMTIsNyBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKPiAgIHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlOwo+ICAgc3RydWN0IGludGVsX2RwOwo+ICAgCj4gLSNkZWZpbmUgQ0FOX1BTUihkZXZf
cHJpdikgKEhBU19QU1IoZGV2X3ByaXYpICYmIGRldl9wcml2LT5wc3Iuc2lua19zdXBwb3J0KQo+
ICsjZGVmaW5lIENBTl9QU1IoaTkxNSkgKEhBU19QU1IoaTkxNSkgJiYgaTkxNS0+cHNyLnNpbmtf
c3VwcG9ydCkKPiAgIHZvaWQgaW50ZWxfcHNyX2luaXRfZHBjZChzdHJ1Y3QgaW50ZWxfZHAgKmlu
dGVsX2RwKTsKPiAgIHZvaWQgaW50ZWxfcHNyX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVs
X2RwLAo+ICAgCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSk7Cj4gQEAgLTIwLDE4ICsyMCwxOCBAQCB2b2lkIGludGVsX3Bzcl9kaXNhYmxlKHN0cnVjdCBp
bnRlbF9kcCAqaW50ZWxfZHAsCj4gICAJCSAgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqb2xkX2NydGNfc3RhdGUpOwo+ICAgdm9pZCBpbnRlbF9wc3JfdXBkYXRlKHN0cnVjdCBp
bnRlbF9kcCAqaW50ZWxfZHAsCj4gICAJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlKTsKPiAtaW50IGludGVsX3Bzcl9kZWJ1Z19zZXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LCB1NjQgdmFsdWUpOwo+IC12b2lkIGludGVsX3Bzcl9pbnZh
bGlkYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAraW50IGludGVsX3Bz
cl9kZWJ1Z19zZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHU2NCB2YWx1ZSk7Cj4g
K3ZvaWQgaW50ZWxfcHNyX2ludmFsaWRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gICAJCQkgIHVuc2lnbmVkIGZyb250YnVmZmVyX2JpdHMsCj4gICAJCQkgIGVudW0gZmJfb3Bf
b3JpZ2luIG9yaWdpbik7Cj4gLXZvaWQgaW50ZWxfcHNyX2ZsdXNoKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiArdm9pZCBpbnRlbF9wc3JfZmx1c2goc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gICAJCSAgICAgdW5zaWduZWQgZnJvbnRidWZmZXJfYml0cywKPiAg
IAkJICAgICBlbnVtIGZiX29wX29yaWdpbiBvcmlnaW4pOwo+IC12b2lkIGludGVsX3Bzcl9pbml0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gK3ZvaWQgaW50ZWxfcHNyX2lu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgdm9pZCBpbnRlbF9wc3JfY29t
cHV0ZV9jb25maWcoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiAgIAkJCSAgICAgIHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKTsKPiAtdm9pZCBpbnRlbF9wc3JfaXJxX2Nv
bnRyb2woc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgZGVidWcpOwo+IC12
b2lkIGludGVsX3Bzcl9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsIHUzMiBwc3JfaWlyKTsKPiArdm9pZCBpbnRlbF9wc3JfaXJxX2NvbnRyb2woc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBkZWJ1Zyk7Cj4gK3ZvaWQgaW50ZWxfcHNyX2lycV9o
YW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgcHNyX2lpcik7Cj4gICB2
b2lkIGludGVsX3Bzcl9zaG9ydF9wdWxzZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKTsKPiAg
IGludCBpbnRlbF9wc3Jfd2FpdF9mb3JfaWRsZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqbmV3X2NydGNfc3RhdGUsCj4gICAJCQkgICAgdTMyICpvdXRfdmFsdWUpOwo+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9xdWlya3MuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX3F1aXJrcy5oCj4gaW5kZXggYjBmY2ZmMTQyYTU2Li5iNjE3Y2EwNDc2OTUg
MTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcXVpcmtzLmgKPiArKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9xdWlya3MuaAo+IEBAIC04LDYgKzgsNiBAQAo+
ICAgCj4gICBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKPiAgIAo+IC12b2lkIGludGVsX2luaXRf
cXVpcmtzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gK3ZvaWQgaW50ZWxf
aW5pdF9xdWlya3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgCj4gICAjZW5k
aWYgLyogX19JTlRFTF9RVUlSS1NfSF9fICovCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX3J1bnRpbWVfcG0uaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3J1
bnRpbWVfcG0uaAo+IGluZGV4IGE3YWNjZWIxMzQ3My4uMTA0MmYxYzBiMTI1IDEwMDY0NAo+IC0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3J1bnRpbWVfcG0uaAo+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX3J1bnRpbWVfcG0uaAo+IEBAIC0yMCwxMCArMjAsMTAgQEAg
ZW51bSBpOTE1X2RybV9zdXNwZW5kX21vZGUgewo+ICAgCUk5MTVfRFJNX1NVU1BFTkRfSElCRVJO
QVRFLAo+ICAgfTsKPiAgIAo+IC12b2lkIGludGVsX3J1bnRpbWVfcG1faW5pdF9lYXJseShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGludGVsX3J1bnRpbWVfcG1f
ZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gLXZvaWQgaW50ZWxf
cnVudGltZV9wbV9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4g
LXZvaWQgaW50ZWxfcnVudGltZV9wbV9jbGVhbnVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdik7Cj4gK3ZvaWQgaW50ZWxfcnVudGltZV9wbV9pbml0X2Vhcmx5KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KTsKPiArdm9pZCBpbnRlbF9ydW50aW1lX3BtX2VuYWJsZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgaW50ZWxfcnVudGltZV9wbV9kaXNh
YmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiArdm9pZCBpbnRlbF9ydW50aW1l
X3BtX2NsZWFudXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgCj4gICBpbnRl
bF93YWtlcmVmX3QgaW50ZWxfcnVudGltZV9wbV9nZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpOwo+ICAgaW50ZWxfd2FrZXJlZl90IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3Vz
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX3Nkdm8uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3Nk
dm8uYwo+IGluZGV4IDA4NjBhZTM2YmI4Ny4uYjkxNmM3OWQ2YjMxIDEwMDY0NAo+IC0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3Nkdm8uYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX3Nkdm8uYwo+IEBAIC0yMTIsMTggKzIxMiwxOCBAQCBpbnRlbF9zZHZvX2NyZWF0
ZV9lbmhhbmNlX3Byb3BlcnR5KHN0cnVjdCBpbnRlbF9zZHZvICppbnRlbF9zZHZvLAo+ICAgc3Rh
dGljIHZvaWQgaW50ZWxfc2R2b193cml0ZV9zZHZveChzdHJ1Y3QgaW50ZWxfc2R2byAqaW50ZWxf
c2R2bywgdTMyIHZhbCkKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gaW50ZWxf
c2R2by0+YmFzZS5iYXNlLmRldjsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShkZXYpOwo+ICAgCXUzMiBidmFsID0gdmFsLCBjdmFsID0gdmFsOwo+ICAgCWludCBpOwo+
ICAgCj4gLQlpZiAoSEFTX1BDSF9TUExJVChkZXZfcHJpdikpIHsKPiArCWlmIChIQVNfUENIX1NQ
TElUKGk5MTUpKSB7Cj4gICAJCUk5MTVfV1JJVEUoaW50ZWxfc2R2by0+c2R2b19yZWcsIHZhbCk7
Cj4gICAJCVBPU1RJTkdfUkVBRChpbnRlbF9zZHZvLT5zZHZvX3JlZyk7Cj4gICAJCS8qCj4gICAJ
CSAqIEhXIHdvcmthcm91bmQsIG5lZWQgdG8gd3JpdGUgdGhpcyB0d2ljZSBmb3IgaXNzdWUKPiAg
IAkJICogdGhhdCBtYXkgcmVzdWx0IGluIGZpcnN0IHdyaXRlIGdldHRpbmcgbWFza2VkLgo+ICAg
CQkgKi8KPiAtCQlpZiAoSEFTX1BDSF9JQlgoZGV2X3ByaXYpKSB7Cj4gKwkJaWYgKEhBU19QQ0hf
SUJYKGk5MTUpKSB7Cj4gICAJCQlJOTE1X1dSSVRFKGludGVsX3Nkdm8tPnNkdm9fcmVnLCB2YWwp
Owo+ICAgCQkJUE9TVElOR19SRUFEKGludGVsX3Nkdm8tPnNkdm9fcmVnKTsKPiAgIAkJfQo+IEBA
IC0xNDAwLDcgKzE0MDAsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9zZHZvX3ByZV9lbmFibGUoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIsCj4gICAJCQkJICBjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJCQkgIGNvbnN0IHN0cnVjdCBkcm1f
Y29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShpbnRlbF9lbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoaW50ZWxfZW5jb2Rlci0+YmFz
ZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRj
X3N0YXRlLT5iYXNlLmNydGMpOwo+ICAgCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICph
ZGp1c3RlZF9tb2RlID0gJmNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPiAgIAljb25z
dCBzdHJ1Y3QgaW50ZWxfc2R2b19jb25uZWN0b3Jfc3RhdGUgKnNkdm9fc3RhdGUgPQo+IEBAIC0x
NDgxLDEzICsxNDgxLDEzIEBAIHN0YXRpYyB2b2lkIGludGVsX3Nkdm9fcHJlX2VuYWJsZShzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqaW50ZWxfZW5jb2RlciwKPiAgIAkJcmV0dXJuOwo+ICAgCj4gICAJ
LyogU2V0IHRoZSBTRFZPIGNvbnRyb2wgcmVncy4gKi8KPiAtCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDQpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNCkgewo+ICAgCQkvKiBUaGUg
cmVhbCBtb2RlIHBvbGFyaXR5IGlzIHNldCBieSB0aGUgU0RWTyBjb21tYW5kcywgdXNpbmcKPiAg
IAkJICogc3RydWN0IGludGVsX3Nkdm9fZHRkLiAqLwo+ICAgCQlzZHZveCA9IFNEVk9fVlNZTkNf
QUNUSVZFX0hJR0ggfCBTRFZPX0hTWU5DX0FDVElWRV9ISUdIOwo+IC0JCWlmICghSEFTX1BDSF9T
UExJVChkZXZfcHJpdikgJiYgY3J0Y19zdGF0ZS0+bGltaXRlZF9jb2xvcl9yYW5nZSkKPiArCQlp
ZiAoIUhBU19QQ0hfU1BMSVQoaTkxNSkgJiYgY3J0Y19zdGF0ZS0+bGltaXRlZF9jb2xvcl9yYW5n
ZSkKPiAgIAkJCXNkdm94IHw9IEhETUlfQ09MT1JfUkFOR0VfMTZfMjM1Owo+IC0JCWlmIChJTlRF
TF9HRU4oZGV2X3ByaXYpIDwgNSkKPiArCQlpZiAoSU5URUxfR0VOKGk5MTUpIDwgNSkKPiAgIAkJ
CXNkdm94IHw9IFNEVk9fQk9SREVSX0VOQUJMRTsKPiAgIAl9IGVsc2Ugewo+ICAgCQlzZHZveCA9
IEk5MTVfUkVBRChpbnRlbF9zZHZvLT5zZHZvX3JlZyk7Cj4gQEAgLTE0OTgsMTUgKzE0OTgsMTUg
QEAgc3RhdGljIHZvaWQgaW50ZWxfc2R2b19wcmVfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICppbnRlbF9lbmNvZGVyLAo+ICAgCQlzZHZveCB8PSAoOSA8PCAxOSkgfCBTRFZPX0JPUkRFUl9F
TkFCTEU7Cj4gICAJfQo+ICAgCj4gLQlpZiAoSEFTX1BDSF9DUFQoZGV2X3ByaXYpKQo+ICsJaWYg
KEhBU19QQ0hfQ1BUKGk5MTUpKQo+ICAgCQlzZHZveCB8PSBTRFZPX1BJUEVfU0VMX0NQVChjcnRj
LT5waXBlKTsKPiAgIAllbHNlCj4gICAJCXNkdm94IHw9IFNEVk9fUElQRV9TRUwoY3J0Yy0+cGlw
ZSk7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDQpIHsKPiArCWlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gNCkgewo+ICAgCQkvKiBkb25lIGluIGNydGNfbW9kZV9zZXQgYXMgdGhl
IGRwbGxfbWQgcmVnIG11c3QgYmUgd3JpdHRlbiBlYXJseSAqLwo+IC0JfSBlbHNlIGlmIChJU19J
OTQ1RyhkZXZfcHJpdikgfHwgSVNfSTk0NUdNKGRldl9wcml2KSB8fAo+IC0JCSAgIElTX0czMyhk
ZXZfcHJpdikgfHwgSVNfUElORVZJRVcoZGV2X3ByaXYpKSB7Cj4gKwl9IGVsc2UgaWYgKElTX0k5
NDVHKGk5MTUpIHx8IElTX0k5NDVHTShpOTE1KSB8fAo+ICsJCSAgIElTX0czMyhpOTE1KSB8fCBJ
U19QSU5FVklFVyhpOTE1KSkgewo+ICAgCQkvKiBkb25lIGluIGNydGNfbW9kZV9zZXQgYXMgaXQg
bGl2ZXMgaW5zaWRlIHRoZSBkcGxsIHJlZ2lzdGVyICovCj4gICAJfSBlbHNlIHsKPiAgIAkJc2R2
b3ggfD0gKGNydGNfc3RhdGUtPnBpeGVsX211bHRpcGxpZXIgLSAxKQo+IEBAIC0xNTE0LDcgKzE1
MTQsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9zZHZvX3ByZV9lbmFibGUoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmludGVsX2VuY29kZXIsCj4gICAJfQo+ICAgCj4gICAJaWYgKGlucHV0X2R0ZC5wYXJ0
Mi5zZHZvX2ZsYWdzICYgU0RWT19ORUVEX1RPX1NUQUxMICYmCj4gLQkgICAgSU5URUxfR0VOKGRl
dl9wcml2KSA8IDUpCj4gKwkgICAgSU5URUxfR0VOKGk5MTUpIDwgNSkKPiAgIAkJc2R2b3ggfD0g
U0RWT19TVEFMTF9TRUxFQ1Q7Cj4gICAJaW50ZWxfc2R2b193cml0ZV9zZHZveChpbnRlbF9zZHZv
LCBzZHZveCk7Cj4gICB9Cj4gQEAgLTE1MzEsNyArMTUzMSw3IEBAIHN0YXRpYyBib29sIGludGVs
X3Nkdm9fY29ubmVjdG9yX2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25u
ZWN0b3IpCj4gICAJcmV0dXJuIGFjdGl2ZV9vdXRwdXRzICYgaW50ZWxfc2R2b19jb25uZWN0b3It
Pm91dHB1dF9mbGFnOwo+ICAgfQo+ICAgCj4gLWJvb2wgaW50ZWxfc2R2b19wb3J0X2VuYWJsZWQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtib29sIGludGVsX3Nkdm9fcG9y
dF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICAgICBpOTE1
X3JlZ190IHNkdm9fcmVnLCBlbnVtIHBpcGUgKnBpcGUpCj4gICB7Cj4gICAJdTMyIHZhbDsKPiBA
QCAtMTUzOSw5ICsxNTM5LDkgQEAgYm9vbCBpbnRlbF9zZHZvX3BvcnRfZW5hYmxlZChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJdmFsID0gSTkxNV9SRUFEKHNkdm9fcmVn
KTsKPiAgIAo+ICAgCS8qIGFzc2VydHMgd2FudCB0byBrbm93IHRoZSBwaXBlIGV2ZW4gaWYgdGhl
IHBvcnQgaXMgZGlzYWJsZWQgKi8KPiAtCWlmIChIQVNfUENIX0NQVChkZXZfcHJpdikpCj4gKwlp
ZiAoSEFTX1BDSF9DUFQoaTkxNSkpCj4gICAJCSpwaXBlID0gKHZhbCAmIFNEVk9fUElQRV9TRUxf
TUFTS19DUFQpID4+IFNEVk9fUElQRV9TRUxfU0hJRlRfQ1BUOwo+IC0JZWxzZSBpZiAoSVNfQ0hF
UlJZVklFVyhkZXZfcHJpdikpCj4gKwllbHNlIGlmIChJU19DSEVSUllWSUVXKGk5MTUpKQo+ICAg
CQkqcGlwZSA9ICh2YWwgJiBTRFZPX1BJUEVfU0VMX01BU0tfQ0hWKSA+PiBTRFZPX1BJUEVfU0VM
X1NISUZUX0NIVjsKPiAgIAllbHNlCj4gICAJCSpwaXBlID0gKHZhbCAmIFNEVk9fUElQRV9TRUxf
TUFTSykgPj4gU0RWT19QSVBFX1NFTF9TSElGVDsKPiBAQCAtMTU1MiwxNCArMTU1MiwxNCBAQCBi
b29sIGludGVsX3Nkdm9fcG9ydF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiAgIHN0YXRpYyBib29sIGludGVsX3Nkdm9fZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCSAgICBlbnVtIHBpcGUgKnBpcGUpCj4gICB7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNv
ZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX3Nkdm8gKmludGVsX3Nkdm8gPSB0b19z
ZHZvKGVuY29kZXIpOwo+ICAgCXUxNiBhY3RpdmVfb3V0cHV0cyA9IDA7Cj4gICAJYm9vbCByZXQ7
Cj4gICAKPiAgIAlpbnRlbF9zZHZvX2dldF9hY3RpdmVfb3V0cHV0cyhpbnRlbF9zZHZvLCAmYWN0
aXZlX291dHB1dHMpOwo+ICAgCj4gLQlyZXQgPSBpbnRlbF9zZHZvX3BvcnRfZW5hYmxlZChkZXZf
cHJpdiwgaW50ZWxfc2R2by0+c2R2b19yZWcsIHBpcGUpOwo+ICsJcmV0ID0gaW50ZWxfc2R2b19w
b3J0X2VuYWJsZWQoaTkxNSwgaW50ZWxfc2R2by0+c2R2b19yZWcsIHBpcGUpOwo+ICAgCj4gICAJ
cmV0dXJuIHJldCB8fCBhY3RpdmVfb3V0cHV0czsKPiAgIH0KPiBAQCAtMTU2OCw3ICsxNTY4LDcg
QEAgc3RhdGljIHZvaWQgaW50ZWxfc2R2b19nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLAo+ICAgCQkJCSAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmln
KQo+ICAgewo+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBlbmNvZGVyLT5iYXNlLmRldjsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXN0cnVj
dCBpbnRlbF9zZHZvICppbnRlbF9zZHZvID0gdG9fc2R2byhlbmNvZGVyKTsKPiAgIAlzdHJ1Y3Qg
aW50ZWxfc2R2b19kdGQgZHRkOwo+ICAgCWludCBlbmNvZGVyX3BpeGVsX211bHRpcGxpZXIgPSAw
Owo+IEBAIC0xNjEwLDcgKzE2MTAsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9zZHZvX2dldF9jb25m
aWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJICogZW5jb2Rlci0+Z2V0X2Nv
bmZpZyB3ZSBzbyBhbHJlYWR5IGhhdmUgYSB2YWxpZCBwaXhlbCBtdWx0cGxpZXIgb24gYWxsCj4g
ICAJICogb3RoZXIgcGxhdGZyb21zLgo+ICAgCSAqLwo+IC0JaWYgKElTX0k5MTVHKGRldl9wcml2
KSB8fCBJU19JOTE1R00oZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfSTkxNUcoaTkxNSkgfHwgSVNf
STkxNUdNKGk5MTUpKSB7Cj4gICAJCXBpcGVfY29uZmlnLT5waXhlbF9tdWx0aXBsaWVyID0KPiAg
IAkJCSgoc2R2b3ggJiBTRFZPX1BPUlRfTVVMVElQTFlfTUFTSykKPiAgIAkJCSA+PiBTRFZPX1BP
UlRfTVVMVElQTFlfU0hJRlQpICsgMTsKPiBAQCAtMTY5Myw3ICsxNjkzLDcgQEAgc3RhdGljIHZv
aWQgaW50ZWxfZGlzYWJsZV9zZHZvKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAg
CQkJICAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwK
PiAgIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0
ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfc2R2byAqaW50ZWxf
c2R2byA9IHRvX3Nkdm8oZW5jb2Rlcik7Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0
b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICAgCXUzMiB0ZW1wOwo+
IEBAIC0xNzE2LDEzICsxNzE2LDEzIEBAIHN0YXRpYyB2b2lkIGludGVsX2Rpc2FibGVfc2R2byhz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkgKiB0byB0cmFuc2NvZGVyIEEgYWZ0
ZXIgZGlzYWJsaW5nIGl0IHRvIGFsbG93IHRoZQo+ICAgCSAqIG1hdGNoaW5nIERQIHBvcnQgdG8g
YmUgZW5hYmxlZCBvbiB0cmFuc2NvZGVyIEEuCj4gICAJICovCj4gLQlpZiAoSEFTX1BDSF9JQlgo
ZGV2X3ByaXYpICYmIGNydGMtPnBpcGUgPT0gUElQRV9CKSB7Cj4gKwlpZiAoSEFTX1BDSF9JQlgo
aTkxNSkgJiYgY3J0Yy0+cGlwZSA9PSBQSVBFX0IpIHsKPiAgIAkJLyoKPiAgIAkJICogV2UgZ2V0
IENQVS9QQ0ggRklGTyB1bmRlcnJ1bnMgb24gdGhlIG90aGVyIHBpcGUgd2hlbgo+ICAgCQkgKiBk
b2luZyB0aGUgd29ya2Fyb3VuZC4gU3dlZXAgdGhlbSB1bmRlciB0aGUgcnVnLgo+ICAgCQkgKi8K
PiAtCQlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRldl9wcml2LCBQSVBF
X0EsIGZhbHNlKTsKPiAtCQlpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRl
dl9wcml2LCBQSVBFX0EsIGZhbHNlKTsKPiArCQlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5f
cmVwb3J0aW5nKGk5MTUsIFBJUEVfQSwgZmFsc2UpOwo+ICsJCWludGVsX3NldF9wY2hfZmlmb191
bmRlcnJ1bl9yZXBvcnRpbmcoaTkxNSwgUElQRV9BLCBmYWxzZSk7Cj4gICAKPiAgIAkJdGVtcCAm
PSB+U0RWT19QSVBFX1NFTF9NQVNLOwo+ICAgCQl0ZW1wIHw9IFNEVk9fRU5BQkxFIHwgU0RWT19Q
SVBFX1NFTChQSVBFX0EpOwo+IEBAIC0xNzMxLDkgKzE3MzEsOSBAQCBzdGF0aWMgdm9pZCBpbnRl
bF9kaXNhYmxlX3Nkdm8oc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCXRlbXAg
Jj0gflNEVk9fRU5BQkxFOwo+ICAgCQlpbnRlbF9zZHZvX3dyaXRlX3Nkdm94KGludGVsX3Nkdm8s
IHRlbXApOwo+ICAgCj4gLQkJaW50ZWxfd2FpdF9mb3JfdmJsYW5rX2lmX2FjdGl2ZShkZXZfcHJp
diwgUElQRV9BKTsKPiAtCQlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRl
dl9wcml2LCBQSVBFX0EsIHRydWUpOwo+IC0JCWludGVsX3NldF9wY2hfZmlmb191bmRlcnJ1bl9y
ZXBvcnRpbmcoZGV2X3ByaXYsIFBJUEVfQSwgdHJ1ZSk7Cj4gKwkJaW50ZWxfd2FpdF9mb3JfdmJs
YW5rX2lmX2FjdGl2ZShpOTE1LCBQSVBFX0EpOwo+ICsJCWludGVsX3NldF9jcHVfZmlmb191bmRl
cnJ1bl9yZXBvcnRpbmcoaTkxNSwgUElQRV9BLCB0cnVlKTsKPiArCQlpbnRlbF9zZXRfcGNoX2Zp
Zm9fdW5kZXJydW5fcmVwb3J0aW5nKGk5MTUsIFBJUEVfQSwgdHJ1ZSk7Cj4gICAJfQo+ICAgfQo+
ICAgCj4gQEAgLTE3NTUsNyArMTc1NSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2VuYWJsZV9zZHZv
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJICAgICAgY29uc3Qgc3RydWN0
IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0IGRybV9k
ZXZpY2UgKmRldiA9IGVuY29kZXItPmJhc2UuZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJc3RydWN0IGludGVsX3Nkdm8gKmludGVsX3Nkdm8g
PSB0b19zZHZvKGVuY29kZXIpOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0g
dG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+YmFzZS5jcnRjKTsKPiAgIAl1MzIgdGVtcDsKPiBA
QCAtMTc2OCw3ICsxNzY4LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX3Nkdm8oc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJaW50ZWxfc2R2b193cml0ZV9zZHZveChpbnRl
bF9zZHZvLCB0ZW1wKTsKPiAgIAo+ICAgCWZvciAoaSA9IDA7IGkgPCAyOyBpKyspCj4gLQkJaW50
ZWxfd2FpdF9mb3JfdmJsYW5rKGRldl9wcml2LCBpbnRlbF9jcnRjLT5waXBlKTsKPiArCQlpbnRl
bF93YWl0X2Zvcl92YmxhbmsoaTkxNSwgaW50ZWxfY3J0Yy0+cGlwZSk7Cj4gICAKPiAgIAlzdWNj
ZXNzID0gaW50ZWxfc2R2b19nZXRfdHJhaW5lZF9pbnB1dHMoaW50ZWxfc2R2bywgJmlucHV0MSwg
JmlucHV0Mik7Cj4gICAJLyoKPiBAQCAtMTg2NSwxNyArMTg2NSwxNyBAQCBzdGF0aWMgYm9vbCBp
bnRlbF9zZHZvX2dldF9jYXBhYmlsaXRpZXMoc3RydWN0IGludGVsX3Nkdm8gKmludGVsX3Nkdm8s
IHN0cnVjdCBpbgo+ICAgCj4gICBzdGF0aWMgdTE2IGludGVsX3Nkdm9fZ2V0X2hvdHBsdWdfc3Vw
cG9ydChzdHJ1Y3QgaW50ZWxfc2R2byAqaW50ZWxfc2R2bykKPiAgIHsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoaW50ZWxfc2R2by0+YmFzZS5iYXNlLmRl
dik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoaW50ZWxfc2R2
by0+YmFzZS5iYXNlLmRldik7Cj4gICAJdTE2IGhvdHBsdWc7Cj4gICAKPiAtCWlmICghSTkxNV9I
QVNfSE9UUExVRyhkZXZfcHJpdikpCj4gKwlpZiAoIUk5MTVfSEFTX0hPVFBMVUcoaTkxNSkpCj4g
ICAJCXJldHVybiAwOwo+ICAgCj4gICAJLyoKPiAgIAkgKiBIVyBFcnJhdHVtOiBTRFZPIEhvdHBs
dWcgaXMgYnJva2VuIG9uIGFsbCBpOTQ1RyBjaGlwcywgdGhlcmUncyBub2lzZQo+ICAgCSAqIG9u
IHRoZSBsaW5lLgo+ICAgCSAqLwo+IC0JaWYgKElTX0k5NDVHKGRldl9wcml2KSB8fCBJU19JOTQ1
R00oZGV2X3ByaXYpKQo+ICsJaWYgKElTX0k5NDVHKGk5MTUpIHx8IElTX0k5NDVHTShpOTE1KSkK
PiAgIAkJcmV0dXJuIDA7Cj4gICAKPiAgIAlpZiAoIWludGVsX3Nkdm9fZ2V0X3ZhbHVlKGludGVs
X3Nkdm8sIFNEVk9fQ01EX0dFVF9IT1RfUExVR19TVVBQT1JULAo+IEBAIC0xOTE5LDExICsxOTE5
LDExIEBAIGludGVsX3Nkdm9fZ2V0X2VkaWQoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3Rv
cikKPiAgIHN0YXRpYyBzdHJ1Y3QgZWRpZCAqCj4gICBpbnRlbF9zZHZvX2dldF9hbmFsb2dfZWRp
ZChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ICAgewo+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmRldik7Cj4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOwo+ICAg
Cj4gICAJcmV0dXJuIGRybV9nZXRfZWRpZChjb25uZWN0b3IsCj4gLQkJCSAgICBpbnRlbF9nbWJ1
c19nZXRfYWRhcHRlcihkZXZfcHJpdiwKPiAtCQkJCQkJICAgIGRldl9wcml2LT52YnQuY3J0X2Rk
Y19waW4pKTsKPiArCQkJICAgIGludGVsX2dtYnVzX2dldF9hZGFwdGVyKGk5MTUsCj4gKwkJCQkJ
CSAgICBpOTE1LT52YnQuY3J0X2RkY19waW4pKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGVudW0g
ZHJtX2Nvbm5lY3Rvcl9zdGF0dXMKPiBAQCAtMjE4Niw3ICsyMTg2LDcgQEAgc3RhdGljIHZvaWQg
aW50ZWxfc2R2b19nZXRfdHZfbW9kZXMoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikK
PiAgIHN0YXRpYyB2b2lkIGludGVsX3Nkdm9fZ2V0X2x2ZHNfbW9kZXMoc3RydWN0IGRybV9jb25u
ZWN0b3IgKmNvbm5lY3RvcikKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfc2R2byAqaW50ZWxfc2R2
byA9IGludGVsX2F0dGFjaGVkX3Nkdm8oY29ubmVjdG9yKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsKPiAgIAlzdHJ1
Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbmV3bW9kZTsKPiAgIAo+ICAgCURSTV9ERUJVR19LTVMoIltD
T05ORUNUT1I6JWQ6JXNdXG4iLAo+IEBAIC0yMTk2LDkgKzIxOTYsOSBAQCBzdGF0aWMgdm9pZCBp
bnRlbF9zZHZvX2dldF9sdmRzX21vZGVzKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3Ip
Cj4gICAJICogRmV0Y2ggbW9kZXMgZnJvbSBWQlQuIEZvciBTRFZPIHByZWZlciB0aGUgVkJUIG1v
ZGUgc2luY2Ugc29tZQo+ICAgCSAqIFNEVk8tPkxWRFMgdHJhbnNjb2RlcnMgY2FuJ3QgY29wZSB3
aXRoIHRoZSBFRElEIG1vZGUuCj4gICAJICovCj4gLQlpZiAoZGV2X3ByaXYtPnZidC5zZHZvX2x2
ZHNfdmJ0X21vZGUgIT0gTlVMTCkgewo+ICsJaWYgKGk5MTUtPnZidC5zZHZvX2x2ZHNfdmJ0X21v
ZGUgIT0gTlVMTCkgewo+ICAgCQluZXdtb2RlID0gZHJtX21vZGVfZHVwbGljYXRlKGNvbm5lY3Rv
ci0+ZGV2LAo+IC0JCQkJCSAgICAgZGV2X3ByaXYtPnZidC5zZHZvX2x2ZHNfdmJ0X21vZGUpOwo+
ICsJCQkJCSAgICAgaTkxNS0+dmJ0LnNkdm9fbHZkc192YnRfbW9kZSk7Cj4gICAJCWlmIChuZXdt
b2RlICE9IE5VTEwpIHsKPiAgIAkJCS8qIEd1YXJhbnRlZSB0aGUgbW9kZSBpcyBwcmVmZXJyZWQg
Ki8KPiAgIAkJCW5ld21vZGUtPnR5cGUgPSAoRFJNX01PREVfVFlQRV9QUkVGRVJSRUQgfAo+IEBA
IC0yNDg4LDE1ICsyNDg4LDE1IEBAIGludGVsX3Nkdm9fZ3Vlc3NfZGRjX2J1cyhzdHJ1Y3QgaW50
ZWxfc2R2byAqc2R2bykKPiAgICAqIG91dHB1dHMsIHRoZW4gTFZEUyBvdXRwdXRzLgo+ICAgICov
Cj4gICBzdGF0aWMgdm9pZAo+IC1pbnRlbF9zZHZvX3NlbGVjdF9kZGNfYnVzKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAraW50ZWxfc2R2b19zZWxlY3RfZGRjX2J1cyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgc3RydWN0IGludGVsX3Nkdm8gKnNk
dm8pCj4gICB7Cj4gICAJc3RydWN0IHNkdm9fZGV2aWNlX21hcHBpbmcgKm1hcHBpbmc7Cj4gICAK
PiAgIAlpZiAoc2R2by0+cG9ydCA9PSBQT1JUX0IpCj4gLQkJbWFwcGluZyA9ICZkZXZfcHJpdi0+
dmJ0LnNkdm9fbWFwcGluZ3NbMF07Cj4gKwkJbWFwcGluZyA9ICZpOTE1LT52YnQuc2R2b19tYXBw
aW5nc1swXTsKPiAgIAllbHNlCj4gLQkJbWFwcGluZyA9ICZkZXZfcHJpdi0+dmJ0LnNkdm9fbWFw
cGluZ3NbMV07Cj4gKwkJbWFwcGluZyA9ICZpOTE1LT52YnQuc2R2b19tYXBwaW5nc1sxXTsKPiAg
IAo+ICAgCWlmIChtYXBwaW5nLT5pbml0aWFsaXplZCkKPiAgIAkJc2R2by0+ZGRjX2J1cyA9IDEg
PDwgKChtYXBwaW5nLT5kZGNfcGluICYgMHhmMCkgPj4gNCk7Cj4gQEAgLTI1MDUsMjQgKzI1MDUs
MjQgQEAgaW50ZWxfc2R2b19zZWxlY3RfZGRjX2J1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkCj4gLWludGVsX3Nkdm9fc2VsZWN0
X2kyY19idXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtpbnRlbF9zZHZv
X3NlbGVjdF9pMmNfYnVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICBz
dHJ1Y3QgaW50ZWxfc2R2byAqc2R2bykKPiAgIHsKPiAgIAlzdHJ1Y3Qgc2R2b19kZXZpY2VfbWFw
cGluZyAqbWFwcGluZzsKPiAgIAl1OCBwaW47Cj4gICAKPiAgIAlpZiAoc2R2by0+cG9ydCA9PSBQ
T1JUX0IpCj4gLQkJbWFwcGluZyA9ICZkZXZfcHJpdi0+dmJ0LnNkdm9fbWFwcGluZ3NbMF07Cj4g
KwkJbWFwcGluZyA9ICZpOTE1LT52YnQuc2R2b19tYXBwaW5nc1swXTsKPiAgIAllbHNlCj4gLQkJ
bWFwcGluZyA9ICZkZXZfcHJpdi0+dmJ0LnNkdm9fbWFwcGluZ3NbMV07Cj4gKwkJbWFwcGluZyA9
ICZpOTE1LT52YnQuc2R2b19tYXBwaW5nc1sxXTsKPiAgIAo+ICAgCWlmIChtYXBwaW5nLT5pbml0
aWFsaXplZCAmJgo+IC0JICAgIGludGVsX2dtYnVzX2lzX3ZhbGlkX3BpbihkZXZfcHJpdiwgbWFw
cGluZy0+aTJjX3BpbikpCj4gKwkgICAgaW50ZWxfZ21idXNfaXNfdmFsaWRfcGluKGk5MTUsIG1h
cHBpbmctPmkyY19waW4pKQo+ICAgCQlwaW4gPSBtYXBwaW5nLT5pMmNfcGluOwo+ICAgCWVsc2UK
PiAgIAkJcGluID0gR01CVVNfUElOX0RQQjsKPiAgIAo+IC0Jc2R2by0+aTJjID0gaW50ZWxfZ21i
dXNfZ2V0X2FkYXB0ZXIoZGV2X3ByaXYsIHBpbik7Cj4gKwlzZHZvLT5pMmMgPSBpbnRlbF9nbWJ1
c19nZXRfYWRhcHRlcihpOTE1LCBwaW4pOwo+ICAgCj4gICAJLyoKPiAgIAkgKiBXaXRoIGdtYnVz
IHdlIHNob3VsZCBiZSBhYmxlIHRvIGRyaXZlIHNkdm8gaTJjIGF0IDJNSHosIGJ1dCBzb21laG93
Cj4gQEAgLTI1NDYsMTcgKzI1NDYsMTcgQEAgaW50ZWxfc2R2b19pc19oZG1pX2Nvbm5lY3Rvcihz
dHJ1Y3QgaW50ZWxfc2R2byAqaW50ZWxfc2R2bywgaW50IGRldmljZSkKPiAgIH0KPiAgIAo+ICAg
c3RhdGljIHU4Cj4gLWludGVsX3Nkdm9fZ2V0X3NsYXZlX2FkZHIoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ICtpbnRlbF9zZHZvX2dldF9zbGF2ZV9hZGRyKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICBzdHJ1Y3QgaW50ZWxfc2R2byAqc2R2bykKPiAg
IHsKPiAgIAlzdHJ1Y3Qgc2R2b19kZXZpY2VfbWFwcGluZyAqbXlfbWFwcGluZywgKm90aGVyX21h
cHBpbmc7Cj4gICAKPiAgIAlpZiAoc2R2by0+cG9ydCA9PSBQT1JUX0IpIHsKPiAtCQlteV9tYXBw
aW5nID0gJmRldl9wcml2LT52YnQuc2R2b19tYXBwaW5nc1swXTsKPiAtCQlvdGhlcl9tYXBwaW5n
ID0gJmRldl9wcml2LT52YnQuc2R2b19tYXBwaW5nc1sxXTsKPiArCQlteV9tYXBwaW5nID0gJmk5
MTUtPnZidC5zZHZvX21hcHBpbmdzWzBdOwo+ICsJCW90aGVyX21hcHBpbmcgPSAmaTkxNS0+dmJ0
LnNkdm9fbWFwcGluZ3NbMV07Cj4gICAJfSBlbHNlIHsKPiAtCQlteV9tYXBwaW5nID0gJmRldl9w
cml2LT52YnQuc2R2b19tYXBwaW5nc1sxXTsKPiAtCQlvdGhlcl9tYXBwaW5nID0gJmRldl9wcml2
LT52YnQuc2R2b19tYXBwaW5nc1swXTsKPiArCQlteV9tYXBwaW5nID0gJmk5MTUtPnZidC5zZHZv
X21hcHBpbmdzWzFdOwo+ICsJCW90aGVyX21hcHBpbmcgPSAmaTkxNS0+dmJ0LnNkdm9fbWFwcGlu
Z3NbMF07Cj4gICAJfQo+ICAgCj4gICAJLyogSWYgdGhlIEJJT1MgZGVzY3JpYmVkIG91ciBTRFZP
IGRldmljZSwgdGFrZSBhZHZhbnRhZ2Ugb2YgaXQuICovCj4gQEAgLTI2MTYsMTAgKzI2MTYsMTAg
QEAgc3RhdGljIHZvaWQKPiAgIGludGVsX3Nkdm9fYWRkX2hkbWlfcHJvcGVydGllcyhzdHJ1Y3Qg
aW50ZWxfc2R2byAqaW50ZWxfc2R2bywKPiAgIAkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfc2R2b19j
b25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmJhc2UuZGV2KTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuYmFzZS5kZXYp
Owo+ICAgCj4gICAJaW50ZWxfYXR0YWNoX2ZvcmNlX2F1ZGlvX3Byb3BlcnR5KCZjb25uZWN0b3It
PmJhc2UuYmFzZSk7Cj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA0ICYmIElTX01PQklM
RShkZXZfcHJpdikpIHsKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNCAmJiBJU19NT0JJTEUo
aTkxNSkpIHsKPiAgIAkJaW50ZWxfYXR0YWNoX2Jyb2FkY2FzdF9yZ2JfcHJvcGVydHkoJmNvbm5l
Y3Rvci0+YmFzZS5iYXNlKTsKPiAgIAl9Cj4gICAJaW50ZWxfYXR0YWNoX2FzcGVjdF9yYXRpb19w
cm9wZXJ0eSgmY29ubmVjdG9yLT5iYXNlLmJhc2UpOwo+IEBAIC0zMTgwLDkgKzMxODAsOSBAQCBz
dGF0aWMgY29uc3Qgc3RydWN0IGkyY19sb2NrX29wZXJhdGlvbnMgcHJveHlfbG9ja19vcHMgPSB7
Cj4gICAKPiAgIHN0YXRpYyBib29sCj4gICBpbnRlbF9zZHZvX2luaXRfZGRjX3Byb3h5KHN0cnVj
dCBpbnRlbF9zZHZvICpzZHZvLAo+IC0JCQkgIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiArCQkJICBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0
cnVjdCBwY2lfZGV2ICpwZGV2ID0gZGV2X3ByaXYtPmRybS5wZGV2Owo+ICsJc3RydWN0IHBjaV9k
ZXYgKnBkZXYgPSBpOTE1LT5kcm0ucGRldjsKPiAgIAo+ICAgCXNkdm8tPmRkYy5vd25lciA9IFRI
SVNfTU9EVUxFOwo+ICAgCXNkdm8tPmRkYy5jbGFzcyA9IEkyQ19DTEFTU19EREM7Cj4gQEAgLTMx
OTUsMjMgKzMxOTUsMjMgQEAgaW50ZWxfc2R2b19pbml0X2RkY19wcm94eShzdHJ1Y3QgaW50ZWxf
c2R2byAqc2R2bywKPiAgIAlyZXR1cm4gaTJjX2FkZF9hZGFwdGVyKCZzZHZvLT5kZGMpID09IDA7
Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgYXNzZXJ0X3Nkdm9fcG9ydF92YWxpZChjb25zdCBz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lkIGFzc2VydF9z
ZHZvX3BvcnRfdmFsaWQoY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJ
CQkJICAgZW51bSBwb3J0IHBvcnQpCj4gICB7Cj4gLQlpZiAoSEFTX1BDSF9TUExJVChkZXZfcHJp
dikpCj4gKwlpZiAoSEFTX1BDSF9TUExJVChpOTE1KSkKPiAgIAkJV0FSTl9PTihwb3J0ICE9IFBP
UlRfQik7Cj4gICAJZWxzZQo+ICAgCQlXQVJOX09OKHBvcnQgIT0gUE9SVF9CICYmIHBvcnQgIT0g
UE9SVF9DKTsKPiAgIH0KPiAgIAo+IC1ib29sIGludGVsX3Nkdm9faW5pdChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2Jvb2wgaW50ZWxfc2R2b19pbml0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkgICAgIGk5MTVfcmVnX3Qgc2R2b19yZWcsIGVudW0g
cG9ydCBwb3J0KQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICppbnRlbF9lbmNvZGVy
Owo+ICAgCXN0cnVjdCBpbnRlbF9zZHZvICppbnRlbF9zZHZvOwo+ICAgCWludCBpOwo+ICAgCj4g
LQlhc3NlcnRfc2R2b19wb3J0X3ZhbGlkKGRldl9wcml2LCBwb3J0KTsKPiArCWFzc2VydF9zZHZv
X3BvcnRfdmFsaWQoaTkxNSwgcG9ydCk7Cj4gICAKPiAgIAlpbnRlbF9zZHZvID0ga3phbGxvYyhz
aXplb2YoKmludGVsX3Nkdm8pLCBHRlBfS0VSTkVMKTsKPiAgIAlpZiAoIWludGVsX3Nkdm8pCj4g
QEAgLTMyMjAsOSArMzIyMCw5IEBAIGJvb2wgaW50ZWxfc2R2b19pbml0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAlpbnRlbF9zZHZvLT5zZHZvX3JlZyA9IHNkdm9fcmVn
Owo+ICAgCWludGVsX3Nkdm8tPnBvcnQgPSBwb3J0Owo+ICAgCWludGVsX3Nkdm8tPnNsYXZlX2Fk
ZHIgPQo+IC0JCWludGVsX3Nkdm9fZ2V0X3NsYXZlX2FkZHIoZGV2X3ByaXYsIGludGVsX3Nkdm8p
ID4+IDE7Cj4gLQlpbnRlbF9zZHZvX3NlbGVjdF9pMmNfYnVzKGRldl9wcml2LCBpbnRlbF9zZHZv
KTsKPiAtCWlmICghaW50ZWxfc2R2b19pbml0X2RkY19wcm94eShpbnRlbF9zZHZvLCBkZXZfcHJp
dikpCj4gKwkJaW50ZWxfc2R2b19nZXRfc2xhdmVfYWRkcihpOTE1LCBpbnRlbF9zZHZvKSA+PiAx
Owo+ICsJaW50ZWxfc2R2b19zZWxlY3RfaTJjX2J1cyhpOTE1LCBpbnRlbF9zZHZvKTsKPiArCWlm
ICghaW50ZWxfc2R2b19pbml0X2RkY19wcm94eShpbnRlbF9zZHZvLCBpOTE1KSkKPiAgIAkJZ290
byBlcnJfaTJjX2J1czsKPiAgIAo+ICAgCS8qIGVuY29kZXIgdHlwZSB3aWxsIGJlIGRlY2lkZWQg
bGF0ZXIgKi8KPiBAQCAtMzIzMCw3ICszMjMwLDcgQEAgYm9vbCBpbnRlbF9zZHZvX2luaXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCWludGVsX2VuY29kZXItPnR5cGUg
PSBJTlRFTF9PVVRQVVRfU0RWTzsKPiAgIAlpbnRlbF9lbmNvZGVyLT5wb3dlcl9kb21haW4gPSBQ
T1dFUl9ET01BSU5fUE9SVF9PVEhFUjsKPiAgIAlpbnRlbF9lbmNvZGVyLT5wb3J0ID0gcG9ydDsK
PiAtCWRybV9lbmNvZGVyX2luaXQoJmRldl9wcml2LT5kcm0sICZpbnRlbF9lbmNvZGVyLT5iYXNl
LAo+ICsJZHJtX2VuY29kZXJfaW5pdCgmaTkxNS0+ZHJtLCAmaW50ZWxfZW5jb2Rlci0+YmFzZSwK
PiAgIAkJCSAmaW50ZWxfc2R2b19lbmNfZnVuY3MsIDAsCj4gICAJCQkgIlNEVk8gJWMiLCBwb3J0
X25hbWUocG9ydCkpOwo+ICAgCj4gQEAgLTMyNDYsNyArMzI0Niw3IEBAIGJvb2wgaW50ZWxfc2R2
b19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAl9Cj4gICAKPiAg
IAlpbnRlbF9lbmNvZGVyLT5jb21wdXRlX2NvbmZpZyA9IGludGVsX3Nkdm9fY29tcHV0ZV9jb25m
aWc7Cj4gLQlpZiAoSEFTX1BDSF9TUExJVChkZXZfcHJpdikpIHsKPiArCWlmIChIQVNfUENIX1NQ
TElUKGk5MTUpKSB7Cj4gICAJCWludGVsX2VuY29kZXItPmRpc2FibGUgPSBwY2hfZGlzYWJsZV9z
ZHZvOwo+ICAgCQlpbnRlbF9lbmNvZGVyLT5wb3N0X2Rpc2FibGUgPSBwY2hfcG9zdF9kaXNhYmxl
X3Nkdm87Cj4gICAJfSBlbHNlIHsKPiBAQCAtMzI5MCw3ICszMjkwLDcgQEAgYm9vbCBpbnRlbF9z
ZHZvX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCSAqLwo+ICAg
CWludGVsX3Nkdm8tPmJhc2UuY2xvbmVhYmxlID0gMDsKPiAgIAo+IC0JaW50ZWxfc2R2b19zZWxl
Y3RfZGRjX2J1cyhkZXZfcHJpdiwgaW50ZWxfc2R2byk7Cj4gKwlpbnRlbF9zZHZvX3NlbGVjdF9k
ZGNfYnVzKGk5MTUsIGludGVsX3Nkdm8pOwo+ICAgCj4gICAJLyogU2V0IHRoZSBpbnB1dCB0aW1p
bmcgdG8gdGhlIHNjcmVlbi4gQXNzdW1lIGFsd2F5cyBpbnB1dCAwLiAqLwo+ICAgCWlmICghaW50
ZWxfc2R2b19zZXRfdGFyZ2V0X2lucHV0KGludGVsX3Nkdm8pKQo+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9zZHZvLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9zZHZvLmgKPiBpbmRleCBjOWUwNWJjZGQxNDEuLjFlYzY3NjZjNWFlMSAxMDA2NDQKPiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9zZHZvLmgKPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9zZHZvLmgKPiBAQCAtMTUsOSArMTUsOSBAQAo+ICAgc3RydWN0IGRybV9p
OTE1X3ByaXZhdGU7Cj4gICBlbnVtIHBpcGU7Cj4gICAKPiAtYm9vbCBpbnRlbF9zZHZvX3BvcnRf
ZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK2Jvb2wgaW50ZWxf
c2R2b19wb3J0X2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkg
ICAgIGk5MTVfcmVnX3Qgc2R2b19yZWcsIGVudW0gcGlwZSAqcGlwZSk7Cj4gLWJvb2wgaW50ZWxf
c2R2b19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArYm9vbCBpbnRl
bF9zZHZvX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCSAgICAgaTkx
NV9yZWdfdCByZWcsIGVudW0gcG9ydCBwb3J0KTsKPiAgIAo+ICAgI2VuZGlmIC8qIF9fSU5URUxf
U0RWT19IX18gKi8KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfc3By
aXRlLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9zcHJpdGUuYwo+IGluZGV4IGMxODA4
MTVmYWFiZC4uNzM4NzFlNWU4ZTE5IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX3Nwcml0ZS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfc3ByaXRl
LmMKPiBAQCAtOTQsMTIgKzk0LDEyIEBAIGludCBpbnRlbF91c2Vjc190b19zY2FubGluZXMoY29u
c3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUsCj4gICB2b2lkIGludGVs
X3BpcGVfdXBkYXRlX3N0YXJ0KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpuZXdfY3J0
Y19zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2Ny
dGMobmV3X2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gICAJY29uc3Qgc3Ry
dWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmbmV3X2NydGNfc3RhdGUtPmJh
c2UuYWRqdXN0ZWRfbW9kZTsKPiAgIAlsb25nIHRpbWVvdXQgPSBtc2Vjc190b19qaWZmaWVzX3Rp
bWVvdXQoMSk7Cj4gICAJaW50IHNjYW5saW5lLCBtaW4sIG1heCwgdmJsYW5rX3N0YXJ0Owo+ICAg
CXdhaXRfcXVldWVfaGVhZF90ICp3cSA9IGRybV9jcnRjX3ZibGFua193YWl0cXVldWUoJmNydGMt
PmJhc2UpOwo+IC0JYm9vbCBuZWVkX3Zsdl9kc2lfd2EgPSAoSVNfVkFMTEVZVklFVyhkZXZfcHJp
dikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpICYmCj4gKwlib29sIG5lZWRfdmx2X2RzaV93
YSA9IChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpICYmCj4gICAJ
CWludGVsX2NydGNfaGFzX3R5cGUobmV3X2NydGNfc3RhdGUsIElOVEVMX09VVFBVVF9EU0kpOwo+
ICAgCURFRklORV9XQUlUKHdhaXQpOwo+ICAgCXUzMiBwc3Jfc3RhdHVzOwo+IEBAIC0yMDcsNyAr
MjA3LDcgQEAgdm9pZCBpbnRlbF9waXBlX3VwZGF0ZV9lbmQoc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKm5ld19jcnRjX3N0YXRlKQo+ICAgCWludCBzY2FubGluZV9lbmQgPSBpbnRlbF9nZXRfY3J0
Y19zY2FubGluZShjcnRjKTsKPiAgIAl1MzIgZW5kX3ZibF9jb3VudCA9IGludGVsX2NydGNfZ2V0
X3ZibGFua19jb3VudGVyKGNydGMpOwo+ICAgCWt0aW1lX3QgZW5kX3ZibF90aW1lID0ga3RpbWVf
Z2V0KCk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNy
dGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShjcnRjLT5iYXNlLmRldik7Cj4gICAKPiAgIAl0cmFjZV9pOTE1X3BpcGVfdXBkYXRlX2VuZChj
cnRjLCBlbmRfdmJsX2NvdW50LCBzY2FubGluZV9lbmQpOwo+ICAgCj4gQEAgLTIyNyw3ICsyMjcs
NyBAQCB2b2lkIGludGVsX3BpcGVfdXBkYXRlX2VuZChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
bmV3X2NydGNfc3RhdGUpCj4gICAKPiAgIAlsb2NhbF9pcnFfZW5hYmxlKCk7Cj4gICAKPiAtCWlm
IChpbnRlbF92Z3B1X2FjdGl2ZShkZXZfcHJpdikpCj4gKwlpZiAoaW50ZWxfdmdwdV9hY3RpdmUo
aTkxNSkpCj4gICAJCXJldHVybjsKPiAgIAo+ICAgCWlmIChjcnRjLT5kZWJ1Zy5zdGFydF92Ymxf
Y291bnQgJiYKPiBAQCAtMzUzLDcgKzM1Myw3IEBAIHNrbF9wcm9ncmFtX3NjYWxlcihzdHJ1Y3Qg
aW50ZWxfcGxhbmUgKnBsYW5lLAo+ICAgCQkgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJICAgY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpw
bGFuZV9zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ICAgCWVudW0gcGlwZSBwaXBlID0gcGxh
bmUtPnBpcGU7Cj4gICAJaW50IHNjYWxlcl9pZCA9IHBsYW5lX3N0YXRlLT5zY2FsZXJfaWQ7Cj4g
ICAJY29uc3Qgc3RydWN0IGludGVsX3NjYWxlciAqc2NhbGVyID0KPiBAQCAtMzc1LDcgKzM3NSw3
IEBAIHNrbF9wcm9ncmFtX3NjYWxlcihzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ICAgCj4g
ICAJLyogVE9ETzogaGFuZGxlIHN1Yi1waXhlbCBjb29yZGluYXRlcyAqLwo+ICAgCWlmIChpc19w
bGFuYXJfeXV2X2Zvcm1hdChwbGFuZV9zdGF0ZS0+YmFzZS5mYi0+Zm9ybWF0LT5mb3JtYXQpICYm
Cj4gLQkgICAgIWljbF9pc19oZHJfcGxhbmUoZGV2X3ByaXYsIHBsYW5lLT5pZCkpIHsKPiArCSAg
ICAhaWNsX2lzX2hkcl9wbGFuZShpOTE1LCBwbGFuZS0+aWQpKSB7Cj4gICAJCXlfaHBoYXNlID0g
c2tsX3NjYWxlcl9jYWxjX3BoYXNlKDEsIGhzY2FsZSwgZmFsc2UpOwo+ICAgCQl5X3ZwaGFzZSA9
IHNrbF9zY2FsZXJfY2FsY19waGFzZSgxLCB2c2NhbGUsIGZhbHNlKTsKPiAgIAo+IEBAIC00MTUs
NyArNDE1LDcgQEAgaWNsX3Byb2dyYW1faW5wdXRfY3NjKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxh
bmUsCj4gICAJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
LAo+ICAgCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRl
KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShw
bGFuZS0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gICAJZW51bSBwaXBlIHBpcGUgPSBwbGFuZS0+cGlwZTsK
PiAgIAllbnVtIHBsYW5lX2lkIHBsYW5lX2lkID0gcGxhbmUtPmlkOwo+ICAgCj4gQEAgLTUwNyw3
ICs1MDcsNyBAQCBza2xfcHJvZ3JhbV9wbGFuZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+
ICAgCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUsCj4gICAJ
CSAgaW50IGNvbG9yX3BsYW5lLCBib29sIHNsYXZlLCB1MzIgcGxhbmVfY3RsKQo+ICAgewo+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShwbGFuZS0+YmFzZS5k
ZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KHBsYW5lLT5i
YXNlLmRldik7Cj4gICAJZW51bSBwbGFuZV9pZCBwbGFuZV9pZCA9IHBsYW5lLT5pZDsKPiAgIAll
bnVtIHBpcGUgcGlwZSA9IHBsYW5lLT5waXBlOwo+ICAgCWNvbnN0IHN0cnVjdCBkcm1faW50ZWxf
c3ByaXRlX2NvbG9ya2V5ICprZXkgPSAmcGxhbmVfc3RhdGUtPmNrZXk7Cj4gQEAgLTUyOSw3ICs1
MjksNyBAQCBza2xfcHJvZ3JhbV9wbGFuZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ICAg
Cj4gICAJcGxhbmVfY3RsIHw9IHNrbF9wbGFuZV9jdGxfY3J0YyhjcnRjX3N0YXRlKTsKPiAgIAo+
IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgfHwgSVNfR0VNSU5JTEFLRShkZXZfcHJp
dikpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDEwIHx8IElTX0dFTUlOSUxBS0UoaTkxNSkp
Cj4gICAJCXBsYW5lX2NvbG9yX2N0bCA9IHBsYW5lX3N0YXRlLT5jb2xvcl9jdGwgfAo+ICAgCQkJ
Z2xrX3BsYW5lX2NvbG9yX2N0bF9jcnRjKGNydGNfc3RhdGUpOwo+ICAgCj4gQEAgLTU0OSw3ICs1
NDksNyBAQCBza2xfcHJvZ3JhbV9wbGFuZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ICAg
CQljcnRjX3kgPSAwOwo+ICAgCX0KPiAgIAo+IC0Jc3Bpbl9sb2NrX2lycXNhdmUoJmRldl9wcml2
LT51bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ICsJc3Bpbl9sb2NrX2lycXNhdmUoJmk5MTUtPnVu
Y29yZS5sb2NrLCBpcnFmbGFncyk7Cj4gICAKPiAgIAlJOTE1X1dSSVRFX0ZXKFBMQU5FX1NUUklE
RShwaXBlLCBwbGFuZV9pZCksIHN0cmlkZSk7Cj4gICAJSTkxNV9XUklURV9GVyhQTEFORV9QT1Mo
cGlwZSwgcGxhbmVfaWQpLCAoY3J0Y195IDw8IDE2KSB8IGNydGNfeCk7Cj4gQEAgLTU1Nyw3ICs1
NTcsNyBAQCBza2xfcHJvZ3JhbV9wbGFuZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ICAg
CUk5MTVfV1JJVEVfRlcoUExBTkVfQVVYX0RJU1QocGlwZSwgcGxhbmVfaWQpLAo+ICAgCQkgICAg
ICAocGxhbmVfc3RhdGUtPmNvbG9yX3BsYW5lWzFdLm9mZnNldCAtIHN1cmZfYWRkcikgfCBhdXhf
c3RyaWRlKTsKPiAgIAo+IC0JaWYgKGljbF9pc19oZHJfcGxhbmUoZGV2X3ByaXYsIHBsYW5lX2lk
KSkgewo+ICsJaWYgKGljbF9pc19oZHJfcGxhbmUoaTkxNSwgcGxhbmVfaWQpKSB7Cj4gICAJCXUz
MiBjdXNfY3RsID0gMDsKPiAgIAo+ICAgCQlpZiAobGlua2VkKSB7Cj4gQEAgLTU3OCwxMCArNTc4
LDEwIEBAIHNrbF9wcm9ncmFtX3BsYW5lKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gICAJ
CUk5MTVfV1JJVEVfRlcoUExBTkVfQ1VTX0NUTChwaXBlLCBwbGFuZV9pZCksIGN1c19jdGwpOwo+
ICAgCX0KPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgfHwgSVNfR0VNSU5J
TEFLRShkZXZfcHJpdikpCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDEwIHx8IElTX0dFTUlO
SUxBS0UoaTkxNSkpCj4gICAJCUk5MTVfV1JJVEVfRlcoUExBTkVfQ09MT1JfQ1RMKHBpcGUsIHBs
YW5lX2lkKSwgcGxhbmVfY29sb3JfY3RsKTsKPiAgIAo+IC0JaWYgKGZiLT5mb3JtYXQtPmlzX3l1
diAmJiBpY2xfaXNfaGRyX3BsYW5lKGRldl9wcml2LCBwbGFuZV9pZCkpCj4gKwlpZiAoZmItPmZv
cm1hdC0+aXNfeXV2ICYmIGljbF9pc19oZHJfcGxhbmUoaTkxNSwgcGxhbmVfaWQpKQo+ICAgCQlp
Y2xfcHJvZ3JhbV9pbnB1dF9jc2MocGxhbmUsIGNydGNfc3RhdGUsIHBsYW5lX3N0YXRlKTsKPiAg
IAo+ICAgCXNrbF93cml0ZV9wbGFuZV93bShwbGFuZSwgY3J0Y19zdGF0ZSk7Cj4gQEAgLTU5Miw3
ICs1OTIsNyBAQCBza2xfcHJvZ3JhbV9wbGFuZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+
ICAgCj4gICAJSTkxNV9XUklURV9GVyhQTEFORV9PRkZTRVQocGlwZSwgcGxhbmVfaWQpLCAoeSA8
PCAxNikgfCB4KTsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCAxMSkKPiArCWlm
IChJTlRFTF9HRU4oaTkxNSkgPCAxMSkKPiAgIAkJSTkxNV9XUklURV9GVyhQTEFORV9BVVhfT0ZG
U0VUKHBpcGUsIHBsYW5lX2lkKSwKPiAgIAkJCSAgICAgIChwbGFuZV9zdGF0ZS0+Y29sb3JfcGxh
bmVbMV0ueSA8PCAxNikgfAo+ICAgCQkJICAgICAgcGxhbmVfc3RhdGUtPmNvbG9yX3BsYW5lWzFd
LngpOwo+IEBAIC02MDksNyArNjA5LDcgQEAgc2tsX3Byb2dyYW1fcGxhbmUoc3RydWN0IGludGVs
X3BsYW5lICpwbGFuZSwKPiAgIAlpZiAoIXNsYXZlICYmIHBsYW5lX3N0YXRlLT5zY2FsZXJfaWQg
Pj0gMCkKPiAgIAkJc2tsX3Byb2dyYW1fc2NhbGVyKHBsYW5lLCBjcnRjX3N0YXRlLCBwbGFuZV9z
dGF0ZSk7Cj4gICAKPiAtCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRldl9wcml2LT51bmNvcmUu
bG9jaywgaXJxZmxhZ3MpOwo+ICsJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+dW5jb3Jl
LmxvY2ssIGlycWZsYWdzKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQKPiBAQCAtNjQxLDE0
ICs2NDEsMTQgQEAgc3RhdGljIHZvaWQKPiAgIHNrbF9kaXNhYmxlX3BsYW5lKHN0cnVjdCBpbnRl
bF9wbGFuZSAqcGxhbmUsCj4gICAJCSAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiAgIAllbnVtIHBsYW5lX2lkIHBsYW5lX2lk
ID0gcGxhbmUtPmlkOwo+ICAgCWVudW0gcGlwZSBwaXBlID0gcGxhbmUtPnBpcGU7Cj4gICAJdW5z
aWduZWQgbG9uZyBpcnFmbGFnczsKPiAgIAo+IC0Jc3Bpbl9sb2NrX2lycXNhdmUoJmRldl9wcml2
LT51bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ICsJc3Bpbl9sb2NrX2lycXNhdmUoJmk5MTUtPnVu
Y29yZS5sb2NrLCBpcnFmbGFncyk7Cj4gICAKPiAtCWlmIChpY2xfaXNfaGRyX3BsYW5lKGRldl9w
cml2LCBwbGFuZV9pZCkpCj4gKwlpZiAoaWNsX2lzX2hkcl9wbGFuZShpOTE1LCBwbGFuZV9pZCkp
Cj4gICAJCUk5MTVfV1JJVEVfRlcoUExBTkVfQ1VTX0NUTChwaXBlLCBwbGFuZV9pZCksIDApOwo+
ICAgCj4gICAJc2tsX3dyaXRlX3BsYW5lX3dtKHBsYW5lLCBjcnRjX3N0YXRlKTsKPiBAQCAtNjU2
LDIxICs2NTYsMjEgQEAgc2tsX2Rpc2FibGVfcGxhbmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFu
ZSwKPiAgIAlJOTE1X1dSSVRFX0ZXKFBMQU5FX0NUTChwaXBlLCBwbGFuZV9pZCksIDApOwo+ICAg
CUk5MTVfV1JJVEVfRlcoUExBTkVfU1VSRihwaXBlLCBwbGFuZV9pZCksIDApOwo+ICAgCj4gLQlz
cGluX3VubG9ja19pcnFyZXN0b3JlKCZkZXZfcHJpdi0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsK
PiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPnVuY29yZS5sb2NrLCBpcnFmbGFncyk7
Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBib29sCj4gICBza2xfcGxhbmVfZ2V0X2h3X3N0YXRlKHN0
cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gICAJCSAgICAgICBlbnVtIHBpcGUgKnBpcGUpCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5l
LT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
cGxhbmUtPmJhc2UuZGV2KTsKPiAgIAllbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIHBv
d2VyX2RvbWFpbjsKPiAgIAllbnVtIHBsYW5lX2lkIHBsYW5lX2lkID0gcGxhbmUtPmlkOwo+ICAg
CWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICAgCWJvb2wgcmV0Owo+ICAgCj4gICAJcG93ZXJf
ZG9tYWluID0gUE9XRVJfRE9NQUlOX1BJUEUocGxhbmUtPnBpcGUpOwo+IC0Jd2FrZXJlZiA9IGlu
dGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2X3ByaXYsIHBvd2VyX2RvbWFpbik7
Cj4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChpOTE1LCBw
b3dlcl9kb21haW4pOwo+ICAgCWlmICghd2FrZXJlZikKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAg
Cj4gQEAgLTY3OCw3ICs2NzgsNyBAQCBza2xfcGxhbmVfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRl
bF9wbGFuZSAqcGxhbmUsCj4gICAKPiAgIAkqcGlwZSA9IHBsYW5lLT5waXBlOwo+ICAgCj4gLQlp
bnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwgcG93ZXJfZG9tYWluLCB3YWtlcmVmKTsK
PiArCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5MTUsIHBvd2VyX2RvbWFpbiwgd2FrZXJlZik7
Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+IEBAIC02ODcsNyArNjg3LDcgQEAgc3RhdGlj
IHZvaWQKPiAgIGNodl91cGRhdGVfY3NjKGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAq
cGxhbmVfc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSA9IHRvX2lu
dGVsX3BsYW5lKHBsYW5lX3N0YXRlLT5iYXNlLnBsYW5lKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ICAgCWNv
bnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxhbmVfc3RhdGUtPmJhc2UuZmI7Cj4g
ICAJZW51bSBwbGFuZV9pZCBwbGFuZV9pZCA9IHBsYW5lLT5pZDsKPiAgIAkvKgo+IEBAIC03NDYs
NyArNzQ2LDcgQEAgc3RhdGljIHZvaWQKPiAgIHZsdl91cGRhdGVfY2xyYyhjb25zdCBzdHJ1Y3Qg
aW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9w
bGFuZSAqcGxhbmUgPSB0b19pbnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZSk7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5lLT5iYXNl
LmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUocGxhbmUt
PmJhc2UuZGV2KTsKPiAgIAljb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IHBsYW5l
X3N0YXRlLT5iYXNlLmZiOwo+ICAgCWVudW0gcGlwZSBwaXBlID0gcGxhbmUtPnBpcGU7Cj4gICAJ
ZW51bSBwbGFuZV9pZCBwbGFuZV9pZCA9IHBsYW5lLT5pZDsKPiBAQCAtODYzLDcgKzg2Myw3IEBA
IHZsdl91cGRhdGVfcGxhbmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiAgIAkJIGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAgCQkgY29uc3Qgc3RydWN0
IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ICAg
CWVudW0gcGlwZSBwaXBlID0gcGxhbmUtPnBpcGU7Cj4gICAJZW51bSBwbGFuZV9pZCBwbGFuZV9p
ZCA9IHBsYW5lLT5pZDsKPiAgIAl1MzIgc3Byc3VyZl9vZmZzZXQgPSBwbGFuZV9zdGF0ZS0+Y29s
b3JfcGxhbmVbMF0ub2Zmc2V0Owo+IEBAIC04ODYsNyArODg2LDcgQEAgdmx2X3VwZGF0ZV9wbGFu
ZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ICAgCj4gICAJbGluZWFyX29mZnNldCA9IGlu
dGVsX2ZiX3h5X3RvX2xpbmVhcih4LCB5LCBwbGFuZV9zdGF0ZSwgMCk7Cj4gICAKPiAtCXNwaW5f
bG9ja19pcnFzYXZlKCZkZXZfcHJpdi0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiArCXNwaW5f
bG9ja19pcnFzYXZlKCZpOTE1LT51bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ICAgCj4gICAJSTkx
NV9XUklURV9GVyhTUFNUUklERShwaXBlLCBwbGFuZV9pZCksCj4gICAJCSAgICAgIHBsYW5lX3N0
YXRlLT5jb2xvcl9wbGFuZVswXS5zdHJpZGUpOwo+IEBAIC04OTQsNyArODk0LDcgQEAgdmx2X3Vw
ZGF0ZV9wbGFuZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ICAgCUk5MTVfV1JJVEVfRlco
U1BTSVpFKHBpcGUsIHBsYW5lX2lkKSwgKGNydGNfaCA8PCAxNikgfCBjcnRjX3cpOwo+ICAgCUk5
MTVfV1JJVEVfRlcoU1BDT05TVEFMUEhBKHBpcGUsIHBsYW5lX2lkKSwgMCk7Cj4gICAKPiAtCWlm
IChJU19DSEVSUllWSUVXKGRldl9wcml2KSAmJiBwaXBlID09IFBJUEVfQikKPiArCWlmIChJU19D
SEVSUllWSUVXKGk5MTUpICYmIHBpcGUgPT0gUElQRV9CKQo+ICAgCQljaHZfdXBkYXRlX2NzYyhw
bGFuZV9zdGF0ZSk7Cj4gICAKPiAgIAlpZiAoa2V5LT5mbGFncykgewo+IEBAIC05MTcsMzggKzkx
NywzOCBAQCB2bHZfdXBkYXRlX3BsYW5lKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gICAK
PiAgIAl2bHZfdXBkYXRlX2NscmMocGxhbmVfc3RhdGUpOwo+ICAgCj4gLQlzcGluX3VubG9ja19p
cnFyZXN0b3JlKCZkZXZfcHJpdi0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiArCXNwaW5fdW5s
b2NrX2lycXJlc3RvcmUoJmk5MTUtPnVuY29yZS5sb2NrLCBpcnFmbGFncyk7Cj4gICB9Cj4gICAK
PiAgIHN0YXRpYyB2b2lkCj4gICB2bHZfZGlzYWJsZV9wbGFuZShzdHJ1Y3QgaW50ZWxfcGxhbmUg
KnBsYW5lLAo+ICAgCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShw
bGFuZS0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gICAJZW51bSBwaXBlIHBpcGUgPSBwbGFuZS0+cGlwZTsK
PiAgIAllbnVtIHBsYW5lX2lkIHBsYW5lX2lkID0gcGxhbmUtPmlkOwo+ICAgCXVuc2lnbmVkIGxv
bmcgaXJxZmxhZ3M7Cj4gICAKPiAtCXNwaW5fbG9ja19pcnFzYXZlKCZkZXZfcHJpdi0+dW5jb3Jl
LmxvY2ssIGlycWZsYWdzKTsKPiArCXNwaW5fbG9ja19pcnFzYXZlKCZpOTE1LT51bmNvcmUubG9j
aywgaXJxZmxhZ3MpOwo+ICAgCj4gICAJSTkxNV9XUklURV9GVyhTUENOVFIocGlwZSwgcGxhbmVf
aWQpLCAwKTsKPiAgIAlJOTE1X1dSSVRFX0ZXKFNQU1VSRihwaXBlLCBwbGFuZV9pZCksIDApOwo+
ICAgCj4gLQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZkZXZfcHJpdi0+dW5jb3JlLmxvY2ssIGly
cWZsYWdzKTsKPiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPnVuY29yZS5sb2NrLCBp
cnFmbGFncyk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBib29sCj4gICB2bHZfcGxhbmVfZ2V0X2h3
X3N0YXRlKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gICAJCSAgICAgICBlbnVtIHBpcGUg
KnBpcGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiAgIAllbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJf
ZG9tYWluIHBvd2VyX2RvbWFpbjsKPiAgIAllbnVtIHBsYW5lX2lkIHBsYW5lX2lkID0gcGxhbmUt
PmlkOwo+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICAgCWJvb2wgcmV0Owo+ICAgCj4g
ICAJcG93ZXJfZG9tYWluID0gUE9XRVJfRE9NQUlOX1BJUEUocGxhbmUtPnBpcGUpOwo+IC0Jd2Fr
ZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2X3ByaXYsIHBvd2Vy
X2RvbWFpbik7Cj4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxl
ZChpOTE1LCBwb3dlcl9kb21haW4pOwo+ICAgCWlmICghd2FrZXJlZikKPiAgIAkJcmV0dXJuIGZh
bHNlOwo+ICAgCj4gQEAgLTk1Niw3ICs5NTYsNyBAQCB2bHZfcGxhbmVfZ2V0X2h3X3N0YXRlKHN0
cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gICAKPiAgIAkqcGlwZSA9IHBsYW5lLT5waXBlOwo+
ICAgCj4gLQlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwgcG93ZXJfZG9tYWluLCB3
YWtlcmVmKTsKPiArCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5MTUsIHBvd2VyX2RvbWFpbiwg
d2FrZXJlZik7Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+IEBAIC05NzcsNyArOTc3LDcg
QEAgc3RhdGljIHUzMiBpdmJfc3ByaXRlX2N0bF9jcnRjKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlKQo+ICAgc3RhdGljIHUzMiBpdmJfc3ByaXRlX2N0bChjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJCSAgY29uc3Qgc3RydWN0
IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
Cj4gICAJCXRvX2k5MTUocGxhbmVfc3RhdGUtPmJhc2UucGxhbmUtPmRldik7Cj4gICAJY29uc3Qg
c3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBwbGFuZV9zdGF0ZS0+YmFzZS5mYjsKPiAgIAl1
bnNpZ25lZCBpbnQgcm90YXRpb24gPSBwbGFuZV9zdGF0ZS0+YmFzZS5yb3RhdGlvbjsKPiBAQCAt
OTg2LDcgKzk4Niw3IEBAIHN0YXRpYyB1MzIgaXZiX3Nwcml0ZV9jdGwoY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICAKPiAgIAlzcHJjdGwgPSBTUFJJVEVfRU5B
QkxFOwo+ICAgCj4gLQlpZiAoSVNfSVZZQlJJREdFKGRldl9wcml2KSkKPiArCWlmIChJU19JVllC
UklER0UoaTkxNSkpCj4gICAJCXNwcmN0bCB8PSBTUFJJVEVfVFJJQ0tMRV9GRUVEX0RJU0FCTEU7
Cj4gICAKPiAgIAlzd2l0Y2ggKGZiLT5mb3JtYXQtPmZvcm1hdCkgewo+IEBAIC0xMDM4LDcgKzEw
MzgsNyBAQCBpdmJfdXBkYXRlX3BsYW5lKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gICAJ
CSBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJIGNvbnN0
IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2
KTsKPiAgIAllbnVtIHBpcGUgcGlwZSA9IHBsYW5lLT5waXBlOwo+ICAgCXUzMiBzcHJzdXJmX29m
ZnNldCA9IHBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVswXS5vZmZzZXQ7Cj4gICAJdTMyIGxpbmVh
cl9vZmZzZXQ7Cj4gQEAgLTEwNjcsMTIgKzEwNjcsMTIgQEAgaXZiX3VwZGF0ZV9wbGFuZShzdHJ1
Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ICAgCj4gICAJbGluZWFyX29mZnNldCA9IGludGVsX2Zi
X3h5X3RvX2xpbmVhcih4LCB5LCBwbGFuZV9zdGF0ZSwgMCk7Cj4gICAKPiAtCXNwaW5fbG9ja19p
cnFzYXZlKCZkZXZfcHJpdi0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiArCXNwaW5fbG9ja19p
cnFzYXZlKCZpOTE1LT51bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ICAgCj4gICAJSTkxNV9XUklU
RV9GVyhTUFJTVFJJREUocGlwZSksIHBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVswXS5zdHJpZGUp
Owo+ICAgCUk5MTVfV1JJVEVfRlcoU1BSUE9TKHBpcGUpLCAoY3J0Y195IDw8IDE2KSB8IGNydGNf
eCk7Cj4gICAJSTkxNV9XUklURV9GVyhTUFJTSVpFKHBpcGUpLCAoY3J0Y19oIDw8IDE2KSB8IGNy
dGNfdyk7Cj4gLQlpZiAoSVNfSVZZQlJJREdFKGRldl9wcml2KSkKPiArCWlmIChJU19JVllCUklE
R0UoaTkxNSkpCj4gICAJCUk5MTVfV1JJVEVfRlcoU1BSU0NBTEUocGlwZSksIHNwcnNjYWxlKTsK
PiAgIAo+ICAgCWlmIChrZXktPmZsYWdzKSB7Cj4gQEAgLTEwODMsNyArMTA4Myw3IEBAIGl2Yl91
cGRhdGVfcGxhbmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiAgIAo+ICAgCS8qIEhTVyBj
b25zb2xpZGF0ZXMgU1BSVElMRU9GRiBhbmQgU1BSTElOT0ZGIGludG8gYSBzaW5nbGUgU1BST0ZG
U0VUCj4gICAJICogcmVnaXN0ZXIgKi8KPiAtCWlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8fCBJ
U19CUk9BRFdFTEwoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfSEFTV0VMTChpOTE1KSB8fCBJU19C
Uk9BRFdFTEwoaTkxNSkpIHsKPiAgIAkJSTkxNV9XUklURV9GVyhTUFJPRkZTRVQocGlwZSksICh5
IDw8IDE2KSB8IHgpOwo+ICAgCX0gZWxzZSB7Cj4gICAJCUk5MTVfV1JJVEVfRlcoU1BSTElOT0ZG
KHBpcGUpLCBsaW5lYXJfb2Zmc2V0KTsKPiBAQCAtMTA5OSwzOSArMTA5OSwzOSBAQCBpdmJfdXBk
YXRlX3BsYW5lKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gICAJSTkxNV9XUklURV9GVyhT
UFJTVVJGKHBpcGUpLAo+ICAgCQkgICAgICBpbnRlbF9wbGFuZV9nZ3R0X29mZnNldChwbGFuZV9z
dGF0ZSkgKyBzcHJzdXJmX29mZnNldCk7Cj4gICAKPiAtCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUo
JmRldl9wcml2LT51bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ICsJc3Bpbl91bmxvY2tfaXJxcmVz
dG9yZSgmaTkxNS0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGlj
IHZvaWQKPiAgIGl2Yl9kaXNhYmxlX3BsYW5lKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4g
ICAJCSAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5lLT5iYXNl
LmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUocGxhbmUt
PmJhc2UuZGV2KTsKPiAgIAllbnVtIHBpcGUgcGlwZSA9IHBsYW5lLT5waXBlOwo+ICAgCXVuc2ln
bmVkIGxvbmcgaXJxZmxhZ3M7Cj4gICAKPiAtCXNwaW5fbG9ja19pcnFzYXZlKCZkZXZfcHJpdi0+
dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiArCXNwaW5fbG9ja19pcnFzYXZlKCZpOTE1LT51bmNv
cmUubG9jaywgaXJxZmxhZ3MpOwo+ICAgCj4gICAJSTkxNV9XUklURV9GVyhTUFJDVEwocGlwZSks
IDApOwo+ICAgCS8qIERpc2FibGUgdGhlIHNjYWxlciAqLwo+IC0JaWYgKElTX0lWWUJSSURHRShk
ZXZfcHJpdikpCj4gKwlpZiAoSVNfSVZZQlJJREdFKGk5MTUpKQo+ICAgCQlJOTE1X1dSSVRFX0ZX
KFNQUlNDQUxFKHBpcGUpLCAwKTsKPiAgIAlJOTE1X1dSSVRFX0ZXKFNQUlNVUkYocGlwZSksIDAp
Owo+ICAgCj4gLQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZkZXZfcHJpdi0+dW5jb3JlLmxvY2ss
IGlycWZsYWdzKTsKPiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPnVuY29yZS5sb2Nr
LCBpcnFmbGFncyk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBib29sCj4gICBpdmJfcGxhbmVfZ2V0
X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gICAJCSAgICAgICBlbnVtIHBp
cGUgKnBpcGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiAgIAllbnVtIGludGVsX2Rpc3BsYXlfcG93
ZXJfZG9tYWluIHBvd2VyX2RvbWFpbjsKPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiAg
IAlib29sIHJldDsKPiAgIAo+ICAgCXBvd2VyX2RvbWFpbiA9IFBPV0VSX0RPTUFJTl9QSVBFKHBs
YW5lLT5waXBlKTsKPiAtCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFi
bGVkKGRldl9wcml2LCBwb3dlcl9kb21haW4pOwo+ICsJd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlf
cG93ZXJfZ2V0X2lmX2VuYWJsZWQoaTkxNSwgcG93ZXJfZG9tYWluKTsKPiAgIAlpZiAoIXdha2Vy
ZWYpCj4gICAJCXJldHVybiBmYWxzZTsKPiAgIAo+IEBAIC0xMTM5LDcgKzExMzksNyBAQCBpdmJf
cGxhbmVfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gICAKPiAgIAkq
cGlwZSA9IHBsYW5lLT5waXBlOwo+ICAgCj4gLQlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZf
cHJpdiwgcG93ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiArCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0
KGk5MTUsIHBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gICAKPiAgIAlyZXR1cm4gcmV0Owo+ICAg
fQo+IEBAIC0xMTY4LDcgKzExNjgsNyBAQCBzdGF0aWMgdTMyIGc0eF9zcHJpdGVfY3RsX2NydGMo
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICBzdGF0aWMgdTMy
IGc0eF9zcHJpdGVfY3RsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
LAo+ICAgCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+
ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0KPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0KPiAgIAkJdG9faTkxNShwbGFuZV9zdGF0ZS0+YmFzZS5w
bGFuZS0+ZGV2KTsKPiAgIAljb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IHBsYW5l
X3N0YXRlLT5iYXNlLmZiOwo+ICAgCXVuc2lnbmVkIGludCByb3RhdGlvbiA9IHBsYW5lX3N0YXRl
LT5iYXNlLnJvdGF0aW9uOwo+IEBAIC0xMTc3LDcgKzExNzcsNyBAQCBzdGF0aWMgdTMyIGc0eF9z
cHJpdGVfY3RsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAg
Cj4gICAJZHZzY250ciA9IERWU19FTkFCTEU7Cj4gICAKPiAtCWlmIChJU19HRU4oZGV2X3ByaXYs
IDYpKQo+ICsJaWYgKElTX0dFTihpOTE1LCA2KSkKPiAgIAkJZHZzY250ciB8PSBEVlNfVFJJQ0tM
RV9GRUVEX0RJU0FCTEU7Cj4gICAKPiAgIAlzd2l0Y2ggKGZiLT5mb3JtYXQtPmZvcm1hdCkgewo+
IEBAIC0xMjI5LDcgKzEyMjksNyBAQCBnNHhfdXBkYXRlX3BsYW5lKHN0cnVjdCBpbnRlbF9wbGFu
ZSAqcGxhbmUsCj4gICAJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSwKPiAgIAkJIGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5l
LT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
cGxhbmUtPmJhc2UuZGV2KTsKPiAgIAllbnVtIHBpcGUgcGlwZSA9IHBsYW5lLT5waXBlOwo+ICAg
CXUzMiBkdnNzdXJmX29mZnNldCA9IHBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVswXS5vZmZzZXQ7
Cj4gICAJdTMyIGxpbmVhcl9vZmZzZXQ7Cj4gQEAgLTEyNTgsNyArMTI1OCw3IEBAIGc0eF91cGRh
dGVfcGxhbmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiAgIAo+ICAgCWxpbmVhcl9vZmZz
ZXQgPSBpbnRlbF9mYl94eV90b19saW5lYXIoeCwgeSwgcGxhbmVfc3RhdGUsIDApOwo+ICAgCj4g
LQlzcGluX2xvY2tfaXJxc2F2ZSgmZGV2X3ByaXYtPnVuY29yZS5sb2NrLCBpcnFmbGFncyk7Cj4g
KwlzcGluX2xvY2tfaXJxc2F2ZSgmaTkxNS0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiAgIAo+
ICAgCUk5MTVfV1JJVEVfRlcoRFZTU1RSSURFKHBpcGUpLCBwbGFuZV9zdGF0ZS0+Y29sb3JfcGxh
bmVbMF0uc3RyaWRlKTsKPiAgIAlJOTE1X1dSSVRFX0ZXKERWU1BPUyhwaXBlKSwgKGNydGNfeSA8
PCAxNikgfCBjcnRjX3gpOwo+IEBAIC0xMjgzLDM4ICsxMjgzLDM4IEBAIGc0eF91cGRhdGVfcGxh
bmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiAgIAlJOTE1X1dSSVRFX0ZXKERWU1NVUkYo
cGlwZSksCj4gICAJCSAgICAgIGludGVsX3BsYW5lX2dndHRfb2Zmc2V0KHBsYW5lX3N0YXRlKSAr
IGR2c3N1cmZfb2Zmc2V0KTsKPiAgIAo+IC0Jc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZGV2X3By
aXYtPnVuY29yZS5sb2NrLCBpcnFmbGFncyk7Cj4gKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZp
OTE1LT51bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZAo+
ICAgZzR4X2Rpc2FibGVfcGxhbmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiAgIAkJICBj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgIHsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsK
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShwbGFuZS0+YmFzZS5k
ZXYpOwo+ICAgCWVudW0gcGlwZSBwaXBlID0gcGxhbmUtPnBpcGU7Cj4gICAJdW5zaWduZWQgbG9u
ZyBpcnFmbGFnczsKPiAgIAo+IC0Jc3Bpbl9sb2NrX2lycXNhdmUoJmRldl9wcml2LT51bmNvcmUu
bG9jaywgaXJxZmxhZ3MpOwo+ICsJc3Bpbl9sb2NrX2lycXNhdmUoJmk5MTUtPnVuY29yZS5sb2Nr
LCBpcnFmbGFncyk7Cj4gICAKPiAgIAlJOTE1X1dSSVRFX0ZXKERWU0NOVFIocGlwZSksIDApOwo+
ICAgCS8qIERpc2FibGUgdGhlIHNjYWxlciAqLwo+ICAgCUk5MTVfV1JJVEVfRlcoRFZTU0NBTEUo
cGlwZSksIDApOwo+ICAgCUk5MTVfV1JJVEVfRlcoRFZTU1VSRihwaXBlKSwgMCk7Cj4gICAKPiAt
CXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRldl9wcml2LT51bmNvcmUubG9jaywgaXJxZmxhZ3Mp
Owo+ICsJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+dW5jb3JlLmxvY2ssIGlycWZsYWdz
KTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGJvb2wKPiAgIGc0eF9wbGFuZV9nZXRfaHdfc3RhdGUo
c3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiAgIAkJICAgICAgIGVudW0gcGlwZSAqcGlwZSkK
PiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUocGxh
bmUtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShwbGFuZS0+YmFzZS5kZXYpOwo+ICAgCWVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4g
cG93ZXJfZG9tYWluOwo+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICAgCWJvb2wgcmV0
Owo+ICAgCj4gICAJcG93ZXJfZG9tYWluID0gUE9XRVJfRE9NQUlOX1BJUEUocGxhbmUtPnBpcGUp
Owo+IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2X3By
aXYsIHBvd2VyX2RvbWFpbik7Cj4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRf
aWZfZW5hYmxlZChpOTE1LCBwb3dlcl9kb21haW4pOwo+ICAgCWlmICghd2FrZXJlZikKPiAgIAkJ
cmV0dXJuIGZhbHNlOwo+ICAgCj4gQEAgLTEzMjIsNyArMTMyMiw3IEBAIGc0eF9wbGFuZV9nZXRf
aHdfc3RhdGUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiAgIAo+ICAgCSpwaXBlID0gcGxh
bmUtPnBpcGU7Cj4gICAKPiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBwb3dl
cl9kb21haW4sIHdha2VyZWYpOwo+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgcG93
ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiAgIAo+ICAgCXJldHVybiByZXQ7Cj4gICB9Cj4gQEAgLTE0
MDYsMTYgKzE0MDYsMTYgQEAgZzR4X3Nwcml0ZV9jaGVjayhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJIHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3Rh
dGUpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSA9IHRvX2ludGVsX3BsYW5l
KHBsYW5lX3N0YXRlLT5iYXNlLnBsYW5lKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ICAgCWludCBtaW5fc2Nh
bGUgPSBEUk1fUExBTkVfSEVMUEVSX05PX1NDQUxJTkc7Cj4gICAJaW50IG1heF9zY2FsZSA9IERS
TV9QTEFORV9IRUxQRVJfTk9fU0NBTElORzsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gICAJaWYgKGlu
dGVsX2ZiX3NjYWxhYmxlKHBsYW5lX3N0YXRlLT5iYXNlLmZiKSkgewo+IC0JCWlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpIDwgNykgewo+ICsJCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA3KSB7Cj4gICAJ
CQltaW5fc2NhbGUgPSAxOwo+ICAgCQkJbWF4X3NjYWxlID0gMTYgPDwgMTY7Cj4gLQkJfSBlbHNl
IGlmIChJU19JVllCUklER0UoZGV2X3ByaXYpKSB7Cj4gKwkJfSBlbHNlIGlmIChJU19JVllCUklE
R0UoaTkxNSkpIHsKPiAgIAkJCW1pbl9zY2FsZSA9IDE7Cj4gICAJCQltYXhfc2NhbGUgPSAyIDw8
IDE2Owo+ICAgCQl9Cj4gQEAgLTE0NDMsNyArMTQ0Myw3IEBAIGc0eF9zcHJpdGVfY2hlY2soc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICAJaWYgKHJldCkKPiAgIAkJcmV0
dXJuIHJldDsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNykKPiArCWlmIChJ
TlRFTF9HRU4oaTkxNSkgPj0gNykKPiAgIAkJcGxhbmVfc3RhdGUtPmN0bCA9IGl2Yl9zcHJpdGVf
Y3RsKGNydGNfc3RhdGUsIHBsYW5lX3N0YXRlKTsKPiAgIAllbHNlCj4gICAJCXBsYW5lX3N0YXRl
LT5jdGwgPSBnNHhfc3ByaXRlX2N0bChjcnRjX3N0YXRlLCBwbGFuZV9zdGF0ZSk7Cj4gQEAgLTE0
NTQsMTEgKzE0NTQsMTEgQEAgZzR4X3Nwcml0ZV9jaGVjayhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSwKPiAgIGludCBjaHZfcGxhbmVfY2hlY2tfcm90YXRpb24oY29uc3Qgc3Ry
dWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50
ZWxfcGxhbmUgKnBsYW5lID0gdG9faW50ZWxfcGxhbmUocGxhbmVfc3RhdGUtPmJhc2UucGxhbmUp
Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShwbGFuZS0+
YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KHBs
YW5lLT5iYXNlLmRldik7Cj4gICAJdW5zaWduZWQgaW50IHJvdGF0aW9uID0gcGxhbmVfc3RhdGUt
PmJhc2Uucm90YXRpb247Cj4gICAKPiAgIAkvKiBDSFYgaWdub3JlcyB0aGUgbWlycm9yIGJpdCB3
aGVuIHRoZSByb3RhdGUgYml0IGlzIHNldCA6KCAqLwo+IC0JaWYgKElTX0NIRVJSWVZJRVcoZGV2
X3ByaXYpICYmCj4gKwlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSAmJgo+ICAgCSAgICByb3RhdGlv
biAmIERSTV9NT0RFX1JPVEFURV8xODAgJiYKPiAgIAkgICAgcm90YXRpb24gJiBEUk1fTU9ERV9S
RUZMRUNUX1gpIHsKPiAgIAkJRFJNX0RFQlVHX0tNUygiQ2Fubm90IHJvdGF0ZSBhbmQgcmVmbGVj
dCBhdCB0aGUgc2FtZSB0aW1lXG4iKTsKPiBAQCAtMTUwNiw3ICsxNTA2LDcgQEAgc3RhdGljIGlu
dCBza2xfcGxhbmVfY2hlY2tfZmIoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUsCj4gICAJCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5l
X3N0YXRlKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUgPSB0b19pbnRlbF9w
bGFuZShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZSk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiAgIAljb25zdCBz
dHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IHBsYW5lX3N0YXRlLT5iYXNlLmZiOwo+ICAgCXVu
c2lnbmVkIGludCByb3RhdGlvbiA9IHBsYW5lX3N0YXRlLT5iYXNlLnJvdGF0aW9uOwo+ICAgCXN0
cnVjdCBkcm1fZm9ybWF0X25hbWVfYnVmIGZvcm1hdF9uYW1lOwo+IEBAIC0xNTQwLDcgKzE1NDAs
NyBAQCBzdGF0aWMgaW50IHNrbF9wbGFuZV9jaGVja19mYihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgIAkJICovCj4gICAJCXN3aXRjaCAoZmItPmZvcm1hdC0+
Zm9ybWF0KSB7Cj4gICAJCWNhc2UgRFJNX0ZPUk1BVF9SR0I1NjU6Cj4gLQkJCWlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDExKQo+ICsJCQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKQo+ICAg
CQkJCWJyZWFrOwo+ICAgCQkJLyogZmFsbCB0aHJvdWdoICovCj4gICAJCWNhc2UgRFJNX0ZPUk1B
VF9DODoKPiBAQCAtMTU3OSw3ICsxNTc5LDcgQEAgc3RhdGljIGludCBza2xfcGxhbmVfY2hlY2tf
ZmIoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICBzdGF0aWMg
aW50IHNrbF9wbGFuZV9jaGVja19kc3RfY29vcmRpbmF0ZXMoY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gICAJCQkJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFu
ZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPQo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPQo+ICAgCQl0b19p
OTE1KHBsYW5lX3N0YXRlLT5iYXNlLnBsYW5lLT5kZXYpOwo+ICAgCWludCBjcnRjX3ggPSBwbGFu
ZV9zdGF0ZS0+YmFzZS5kc3QueDE7Cj4gICAJaW50IGNydGNfdyA9IGRybV9yZWN0X3dpZHRoKCZw
bGFuZV9zdGF0ZS0+YmFzZS5kc3QpOwo+IEBAIC0xNTk0LDcgKzE1OTQsNyBAQCBzdGF0aWMgaW50
IHNrbF9wbGFuZV9jaGVja19kc3RfY29vcmRpbmF0ZXMoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfcwo+ICAgCSAqIHRoYW4gdGhlIGN1cnNvciBlbmRpbmcgbGVzcyB0aGFuIDQg
cGl4ZWxzIGZyb20gdGhlIGxlZnQgZWRnZSBvZiB0aGUKPiAgIAkgKiBzY3JlZW4gbWF5IGNhdXNl
IEZJRk8gdW5kZXJmbG93IGFuZCBkaXNwbGF5IGNvcnJ1cHRpb24uCj4gICAJICovCj4gLQlpZiAo
KElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpIHx8IElTX0NBTk5PTkxBS0UoZGV2X3ByaXYpKSAmJgo+
ICsJaWYgKChJU19HRU1JTklMQUtFKGk5MTUpIHx8IElTX0NBTk5PTkxBS0UoaTkxNSkpICYmCj4g
ICAJICAgIChjcnRjX3ggKyBjcnRjX3cgPCA0IHx8IGNydGNfeCA+IHBpcGVfc3JjX3cgLSA0KSkg
ewo+ICAgCQlEUk1fREVCVUdfS01TKCJyZXF1ZXN0ZWQgcGxhbmUgWCAlcyBwb3NpdGlvbiAlZCBp
bnZhbGlkICh2YWxpZCByYW5nZSAlZC0lZClcbiIsCj4gICAJCQkgICAgICBjcnRjX3ggKyBjcnRj
X3cgPCA0ID8gImVuZCIgOiAic3RhcnQiLAo+IEBAIC0xNjI3LDcgKzE2MjcsNyBAQCBzdGF0aWMg
aW50IHNrbF9wbGFuZV9jaGVjayhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwK
PiAgIAkJCSAgIHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gICB7Cj4g
ICAJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSA9IHRvX2ludGVsX3BsYW5lKHBsYW5lX3N0YXRl
LT5iYXNlLnBsYW5lKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ICAgCWNvbnN0IHN0cnVjdCBkcm1fZnJhbWVi
dWZmZXIgKmZiID0gcGxhbmVfc3RhdGUtPmJhc2UuZmI7Cj4gICAJaW50IG1pbl9zY2FsZSA9IERS
TV9QTEFORV9IRUxQRVJfTk9fU0NBTElORzsKPiAgIAlpbnQgbWF4X3NjYWxlID0gRFJNX1BMQU5F
X0hFTFBFUl9OT19TQ0FMSU5HOwo+IEBAIC0xNjc1LDIzICsxNjc1LDIzIEBAIHN0YXRpYyBpbnQg
c2tsX3BsYW5lX2NoZWNrKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAg
Cj4gICAJcGxhbmVfc3RhdGUtPmN0bCA9IHNrbF9wbGFuZV9jdGwoY3J0Y19zdGF0ZSwgcGxhbmVf
c3RhdGUpOwo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCB8fCBJU19HRU1J
TklMQUtFKGRldl9wcml2KSkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTAgfHwgSVNfR0VN
SU5JTEFLRShpOTE1KSkKPiAgIAkJcGxhbmVfc3RhdGUtPmNvbG9yX2N0bCA9IGdsa19wbGFuZV9j
b2xvcl9jdGwoY3J0Y19zdGF0ZSwKPiAgIAkJCQkJCQkgICAgIHBsYW5lX3N0YXRlKTsKPiAgIAo+
ICAgCXJldHVybiAwOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBib29sIGhhc19kc3Rfa2V5X2luX3By
aW1hcnlfcGxhbmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICtzdGF0aWMg
Ym9vbCBoYXNfZHN0X2tleV9pbl9wcmltYXJ5X3BsYW5lKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQo+ICAgewo+IC0JcmV0dXJuIElOVEVMX0dFTihkZXZfcHJpdikgPj0gOTsKPiArCXJl
dHVybiBJTlRFTF9HRU4oaTkxNSkgPj0gOTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgaW50
ZWxfcGxhbmVfc2V0X2NrZXkoc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSwK
PiAgIAkJCQkgY29uc3Qgc3RydWN0IGRybV9pbnRlbF9zcHJpdGVfY29sb3JrZXkgKnNldCkKPiAg
IHsKPiAgIAlzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lID0gdG9faW50ZWxfcGxhbmUocGxhbmVf
c3RhdGUtPmJhc2UucGxhbmUpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGRybV9pbnRlbF9z
cHJpdGVfY29sb3JrZXkgKmtleSA9ICZwbGFuZV9zdGF0ZS0+Y2tleTsKPiAgIAo+ICAgCSprZXkg
PSAqc2V0Owo+IEBAIC0xNzA4LDcgKzE3MDgsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wbGFuZV9z
ZXRfY2tleShzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlLAo+ICAgCSAqIE9u
IFNLTCsgd2Ugd2FudCBkc3Qga2V5IGVuYWJsZWQgb24KPiAgIAkgKiB0aGUgcHJpbWFyeSBhbmQg
bm90IG9uIHRoZSBzcHJpdGUuCj4gICAJICovCj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+
PSA5ICYmIHBsYW5lLT5pZCAhPSBQTEFORV9QUklNQVJZICYmCj4gKwlpZiAoSU5URUxfR0VOKGk5
MTUpID49IDkgJiYgcGxhbmUtPmlkICE9IFBMQU5FX1BSSU1BUlkgJiYKPiAgIAkgICAgc2V0LT5m
bGFncyAmIEk5MTVfU0VUX0NPTE9SS0VZX0RFU1RJTkFUSU9OKQo+ICAgCQlrZXktPmZsYWdzID0g
MDsKPiAgIH0KPiBAQCAtMTcxNiw3ICsxNzE2LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfcGxhbmVf
c2V0X2NrZXkoc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSwKPiAgIGludCBp
bnRlbF9zcHJpdGVfc2V0X2NvbG9ya2V5X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZv
aWQgKmRhdGEsCj4gICAJCQkJICAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wcml2KQo+ICAgewo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJc3RydWN0
IGRybV9pbnRlbF9zcHJpdGVfY29sb3JrZXkgKnNldCA9IGRhdGE7Cj4gICAJc3RydWN0IGRybV9w
bGFuZSAqcGxhbmU7Cj4gICAJc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGU7Cj4g
QEAgLTE3MzQsNyArMTczNCw3IEBAIGludCBpbnRlbF9zcHJpdGVfc2V0X2NvbG9ya2V5X2lvY3Rs
KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gICAJaWYgKChzZXQtPmZsYWdz
ICYgKEk5MTVfU0VUX0NPTE9SS0VZX0RFU1RJTkFUSU9OIHwgSTkxNV9TRVRfQ09MT1JLRVlfU09V
UkNFKSkgPT0gKEk5MTVfU0VUX0NPTE9SS0VZX0RFU1RJTkFUSU9OIHwgSTkxNV9TRVRfQ09MT1JL
RVlfU09VUkNFKSkKPiAgIAkJcmV0dXJuIC1FSU5WQUw7Cj4gICAKPiAtCWlmICgoSVNfVkFMTEVZ
VklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpICYmCj4gKwlpZiAoKElT
X1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkgJiYKPiAgIAkgICAgc2V0
LT5mbGFncyAmIEk5MTVfU0VUX0NPTE9SS0VZX0RFU1RJTkFUSU9OKQo+ICAgCQlyZXR1cm4gLUVJ
TlZBTDsKPiAgIAo+IEBAIC0xNzQ3LDcgKzE3NDcsNyBAQCBpbnQgaW50ZWxfc3ByaXRlX3NldF9j
b2xvcmtleV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ICAgCSAq
IEFsc28gbXVsdGlwbGUgcGxhbmVzIGNhbid0IGRvIGRlc3RpbmF0aW9uIGtleWluZyBvbiB0aGUg
c2FtZQo+ICAgCSAqIHBpcGUgc2ltdWx0YW5lb3VzbHkuCj4gICAJICovCj4gLQlpZiAoSU5URUxf
R0VOKGRldl9wcml2KSA+PSA5ICYmCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkgJiYKPiAg
IAkgICAgdG9faW50ZWxfcGxhbmUocGxhbmUpLT5pZCA+PSBQTEFORV9TUFJJVEUxICYmCj4gICAJ
ICAgIHNldC0+ZmxhZ3MgJiBJOTE1X1NFVF9DT0xPUktFWV9ERVNUSU5BVElPTikKPiAgIAkJcmV0
dXJuIC1FSU5WQUw7Cj4gQEAgLTE3NzEsOSArMTc3MSw5IEBAIGludCBpbnRlbF9zcHJpdGVfc2V0
X2NvbG9ya2V5X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gICAJ
CSAqIE9uIHNvbWUgcGxhdGZvcm1zIHdlIGhhdmUgdG8gY29uZmlndXJlCj4gICAJCSAqIHRoZSBk
c3QgY29sb3JrZXkgb24gdGhlIHByaW1hcnkgcGxhbmUuCj4gICAJCSAqLwo+IC0JCWlmICghcmV0
ICYmIGhhc19kc3Rfa2V5X2luX3ByaW1hcnlfcGxhbmUoZGV2X3ByaXYpKSB7Cj4gKwkJaWYgKCFy
ZXQgJiYgaGFzX2RzdF9rZXlfaW5fcHJpbWFyeV9wbGFuZShpOTE1KSkgewo+ICAgCQkJc3RydWN0
IGludGVsX2NydGMgKmNydGMgPQo+IC0JCQkJaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3By
aXYsCj4gKwkJCQlpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShpOTE1LAo+ICAgCQkJCQkJCXRvX2lu
dGVsX3BsYW5lKHBsYW5lKS0+cGlwZSk7Cj4gICAKPiAgIAkJCXBsYW5lX3N0YXRlID0gZHJtX2F0
b21pY19nZXRfcGxhbmVfc3RhdGUoc3RhdGUsCj4gQEAgLTIxOTcsMjYgKzIxOTcsMjYgQEAgc3Rh
dGljIGNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfZnVuY3Mgc2tsX3BsYW5lX2Z1bmNzID0gewo+ICAg
CS5mb3JtYXRfbW9kX3N1cHBvcnRlZCA9IHNrbF9wbGFuZV9mb3JtYXRfbW9kX3N1cHBvcnRlZCwK
PiAgIH07Cj4gICAKPiAtc3RhdGljIGJvb2wgc2tsX3BsYW5lX2hhc19mYmMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgYm9vbCBza2xfcGxhbmVfaGFzX2ZiYyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAgICAgIGVudW0gcGlwZSBwaXBl
LCBlbnVtIHBsYW5lX2lkIHBsYW5lX2lkKQo+ICAgewo+IC0JaWYgKCFIQVNfRkJDKGRldl9wcml2
KSkKPiArCWlmICghSEFTX0ZCQyhpOTE1KSkKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAgCj4gICAJ
cmV0dXJuIHBpcGUgPT0gUElQRV9BICYmIHBsYW5lX2lkID09IFBMQU5FX1BSSU1BUlk7Cj4gICB9
Cj4gICAKPiAtc3RhdGljIGJvb2wgc2tsX3BsYW5lX2hhc19wbGFuYXIoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgYm9vbCBza2xfcGxhbmVfaGFzX3BsYW5hcihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgZW51bSBwaXBlIHBpcGUsIGVu
dW0gcGxhbmVfaWQgcGxhbmVfaWQpCj4gICB7Cj4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+
PSAxMSkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpCj4gICAJCXJldHVybiBwbGFuZV9p
ZCA8PSBQTEFORV9TUFJJVEUzOwo+ICAgCj4gICAJLyogRGlzcGxheSBXQSAjMDg3MDogc2tsLCBi
eHQgKi8KPiAtCWlmIChJU19TS1lMQUtFKGRldl9wcml2KSB8fCBJU19CUk9YVE9OKGRldl9wcml2
KSkKPiArCWlmIChJU19TS1lMQUtFKGk5MTUpIHx8IElTX0JST1hUT04oaTkxNSkpCj4gICAJCXJl
dHVybiBmYWxzZTsKPiAgIAo+IC0JaWYgKElTX0dFTihkZXZfcHJpdiwgOSkgJiYgIUlTX0dFTUlO
SUxBS0UoZGV2X3ByaXYpICYmIHBpcGUgPT0gUElQRV9DKQo+ICsJaWYgKElTX0dFTihpOTE1LCA5
KSAmJiAhSVNfR0VNSU5JTEFLRShpOTE1KSAmJiBwaXBlID09IFBJUEVfQykKPiAgIAkJcmV0dXJu
IGZhbHNlOwo+ICAgCj4gICAJaWYgKHBsYW5lX2lkICE9IFBMQU5FX1BSSU1BUlkgJiYgcGxhbmVf
aWQgIT0gUExBTkVfU1BSSVRFMCkKPiBAQCAtMjIyNSwxNiArMjIyNSwxNiBAQCBzdGF0aWMgYm9v
bCBza2xfcGxhbmVfaGFzX3BsYW5hcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gICAJcmV0dXJuIHRydWU7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGJvb2wgc2tsX3BsYW5lX2hh
c19jY3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgYm9vbCBz
a2xfcGxhbmVfaGFzX2NjcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCSAg
ICAgIGVudW0gcGlwZSBwaXBlLCBlbnVtIHBsYW5lX2lkIHBsYW5lX2lkKQo+ICAgewo+ICAgCWlm
IChwbGFuZV9pZCA9PSBQTEFORV9DVVJTT1IpCj4gICAJCXJldHVybiBmYWxzZTsKPiAgIAo+IC0J
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTApCj4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49
IDEwKQo+ICAgCQlyZXR1cm4gdHJ1ZTsKPiAgIAo+IC0JaWYgKElTX0dFTUlOSUxBS0UoZGV2X3By
aXYpKQo+ICsJaWYgKElTX0dFTUlOSUxBS0UoaTkxNSkpCj4gICAJCXJldHVybiBwaXBlICE9IFBJ
UEVfQzsKPiAgIAo+ICAgCXJldHVybiBwaXBlICE9IFBJUEVfQyAmJgo+IEBAIC0yMjQzLDcgKzIy
NDMsNyBAQCBzdGF0aWMgYm9vbCBza2xfcGxhbmVfaGFzX2NjcyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gICB9Cj4gICAKPiAgIHN0cnVjdCBpbnRlbF9wbGFuZSAqCj4gLXNr
bF91bml2ZXJzYWxfcGxhbmVfY3JlYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiArc2tsX3VuaXZlcnNhbF9wbGFuZV9jcmVhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCj4gICAJCQkgICBlbnVtIHBpcGUgcGlwZSwgZW51bSBwbGFuZV9pZCBwbGFuZV9pZCkK
PiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lOwo+IEBAIC0yMjYzLDkgKzIyNjMs
OSBAQCBza2xfdW5pdmVyc2FsX3BsYW5lX2NyZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gICAJcGxhbmUtPmlkID0gcGxhbmVfaWQ7Cj4gICAJcGxhbmUtPmZyb250YnVm
ZmVyX2JpdCA9IElOVEVMX0ZST05UQlVGRkVSKHBpcGUsIHBsYW5lX2lkKTsKPiAgIAo+IC0JcGxh
bmUtPmhhc19mYmMgPSBza2xfcGxhbmVfaGFzX2ZiYyhkZXZfcHJpdiwgcGlwZSwgcGxhbmVfaWQp
Owo+ICsJcGxhbmUtPmhhc19mYmMgPSBza2xfcGxhbmVfaGFzX2ZiYyhpOTE1LCBwaXBlLCBwbGFu
ZV9pZCk7Cj4gICAJaWYgKHBsYW5lLT5oYXNfZmJjKSB7Cj4gLQkJc3RydWN0IGludGVsX2ZiYyAq
ZmJjID0gJmRldl9wcml2LT5mYmM7Cj4gKwkJc3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmk5MTUt
PmZiYzsKPiAgIAo+ICAgCQlmYmMtPnBvc3NpYmxlX2ZyYW1lYnVmZmVyX2JpdHMgfD0gcGxhbmUt
PmZyb250YnVmZmVyX2JpdDsKPiAgIAl9Cj4gQEAgLTIyNzgsMjQgKzIyNzgsMjQgQEAgc2tsX3Vu
aXZlcnNhbF9wbGFuZV9jcmVhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ICAgCWlmIChpY2xfaXNfbnYxMl95X3BsYW5lKHBsYW5lX2lkKSkKPiAgIAkJcGxhbmUtPnVwZGF0
ZV9zbGF2ZSA9IGljbF91cGRhdGVfc2xhdmU7Cj4gICAKPiAtCWlmIChza2xfcGxhbmVfaGFzX3Bs
YW5hcihkZXZfcHJpdiwgcGlwZSwgcGxhbmVfaWQpKSB7Cj4gLQkJaWYgKGljbF9pc19oZHJfcGxh
bmUoZGV2X3ByaXYsIHBsYW5lX2lkKSkgewo+ICsJaWYgKHNrbF9wbGFuZV9oYXNfcGxhbmFyKGk5
MTUsIHBpcGUsIHBsYW5lX2lkKSkgewo+ICsJCWlmIChpY2xfaXNfaGRyX3BsYW5lKGk5MTUsIHBs
YW5lX2lkKSkgewo+ICAgCQkJZm9ybWF0cyA9IGljbF9oZHJfcGxhbmFyX2Zvcm1hdHM7Cj4gICAJ
CQludW1fZm9ybWF0cyA9IEFSUkFZX1NJWkUoaWNsX2hkcl9wbGFuYXJfZm9ybWF0cyk7Cj4gLQkJ
fSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKSB7Cj4gKwkJfSBlbHNlIGlmIChJ
TlRFTF9HRU4oaTkxNSkgPj0gMTEpIHsKPiAgIAkJCWZvcm1hdHMgPSBpY2xfcGxhbmFyX2Zvcm1h
dHM7Cj4gICAJCQludW1fZm9ybWF0cyA9IEFSUkFZX1NJWkUoaWNsX3BsYW5hcl9mb3JtYXRzKTsK
PiAtCQl9IGVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPT0gMTAgfHwgSVNfR0VNSU5JTEFL
RShkZXZfcHJpdikpIHsKPiArCQl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA9PSAxMCB8fCBJ
U19HRU1JTklMQUtFKGk5MTUpKSB7Cj4gICAJCQlmb3JtYXRzID0gZ2xrX3BsYW5hcl9mb3JtYXRz
Owo+ICAgCQkJbnVtX2Zvcm1hdHMgPSBBUlJBWV9TSVpFKGdsa19wbGFuYXJfZm9ybWF0cyk7Cj4g
ICAJCX0gZWxzZSB7Cj4gICAJCQlmb3JtYXRzID0gc2tsX3BsYW5hcl9mb3JtYXRzOwo+ICAgCQkJ
bnVtX2Zvcm1hdHMgPSBBUlJBWV9TSVpFKHNrbF9wbGFuYXJfZm9ybWF0cyk7Cj4gICAJCX0KPiAt
CX0gZWxzZSBpZiAoaWNsX2lzX2hkcl9wbGFuZShkZXZfcHJpdiwgcGxhbmVfaWQpKSB7Cj4gKwl9
IGVsc2UgaWYgKGljbF9pc19oZHJfcGxhbmUoaTkxNSwgcGxhbmVfaWQpKSB7Cj4gICAJCWZvcm1h
dHMgPSBpY2xfaGRyX3BsYW5lX2Zvcm1hdHM7Cj4gICAJCW51bV9mb3JtYXRzID0gQVJSQVlfU0la
RShpY2xfaGRyX3BsYW5lX2Zvcm1hdHMpOwo+IC0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDExKSB7Cj4gKwl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkgewo+ICAg
CQlmb3JtYXRzID0gaWNsX3BsYW5lX2Zvcm1hdHM7Cj4gICAJCW51bV9mb3JtYXRzID0gQVJSQVlf
U0laRShpY2xfcGxhbmVfZm9ybWF0cyk7Cj4gICAJfSBlbHNlIHsKPiBAQCAtMjMwMyw3ICsyMzAz
LDcgQEAgc2tsX3VuaXZlcnNhbF9wbGFuZV9jcmVhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICAgCQludW1fZm9ybWF0cyA9IEFSUkFZX1NJWkUoc2tsX3BsYW5lX2Zvcm1h
dHMpOwo+ICAgCX0KPiAgIAo+IC0JcGxhbmUtPmhhc19jY3MgPSBza2xfcGxhbmVfaGFzX2Njcyhk
ZXZfcHJpdiwgcGlwZSwgcGxhbmVfaWQpOwo+ICsJcGxhbmUtPmhhc19jY3MgPSBza2xfcGxhbmVf
aGFzX2NjcyhpOTE1LCBwaXBlLCBwbGFuZV9pZCk7Cj4gICAJaWYgKHBsYW5lLT5oYXNfY2NzKQo+
ICAgCQltb2RpZmllcnMgPSBza2xfcGxhbmVfZm9ybWF0X21vZGlmaWVyc19jY3M7Cj4gICAJZWxz
ZQo+IEBAIC0yMzE2LDcgKzIzMTYsNyBAQCBza2xfdW5pdmVyc2FsX3BsYW5lX2NyZWF0ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAKPiAgIAlwb3NzaWJsZV9jcnRjcyA9
IEJJVChwaXBlKTsKPiAgIAo+IC0JcmV0ID0gZHJtX3VuaXZlcnNhbF9wbGFuZV9pbml0KCZkZXZf
cHJpdi0+ZHJtLCAmcGxhbmUtPmJhc2UsCj4gKwlyZXQgPSBkcm1fdW5pdmVyc2FsX3BsYW5lX2lu
aXQoJmk5MTUtPmRybSwgJnBsYW5lLT5iYXNlLAo+ICAgCQkJCSAgICAgICBwb3NzaWJsZV9jcnRj
cywgJnNrbF9wbGFuZV9mdW5jcywKPiAgIAkJCQkgICAgICAgZm9ybWF0cywgbnVtX2Zvcm1hdHMs
IG1vZGlmaWVycywKPiAgIAkJCQkgICAgICAgcGxhbmVfdHlwZSwKPiBAQCAtMjMyOSw3ICsyMzI5
LDcgQEAgc2tsX3VuaXZlcnNhbF9wbGFuZV9jcmVhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICAgCQlEUk1fTU9ERV9ST1RBVEVfMCB8IERSTV9NT0RFX1JPVEFURV85MCB8
Cj4gICAJCURSTV9NT0RFX1JPVEFURV8xODAgfCBEUk1fTU9ERV9ST1RBVEVfMjcwOwo+ICAgCj4g
LQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCkKPiArCWlmIChJTlRFTF9HRU4oaTkxNSkg
Pj0gMTApCj4gICAJCXN1cHBvcnRlZF9yb3RhdGlvbnMgfD0gRFJNX01PREVfUkVGTEVDVF9YOwo+
ICAgCj4gICAJZHJtX3BsYW5lX2NyZWF0ZV9yb3RhdGlvbl9wcm9wZXJ0eSgmcGxhbmUtPmJhc2Us
Cj4gQEAgLTIzNjEsNyArMjM2MSw3IEBAIHNrbF91bml2ZXJzYWxfcGxhbmVfY3JlYXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIH0KPiAgIAo+ICAgc3RydWN0IGludGVs
X3BsYW5lICoKPiAtaW50ZWxfc3ByaXRlX3BsYW5lX2NyZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gK2ludGVsX3Nwcml0ZV9wbGFuZV9jcmVhdGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkgIGVudW0gcGlwZSBwaXBlLCBpbnQgc3ByaXRlKQo+
ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmU7Cj4gQEAgLTIzNzMsMTUgKzIzNzMs
MTUgQEAgaW50ZWxfc3ByaXRlX3BsYW5lX2NyZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gICAJaW50IG51bV9mb3JtYXRzOwo+ICAgCWludCByZXQ7Cj4gICAKPiAtCWlm
IChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gLQkJcmV0dXJuIHNrbF91bml2ZXJzYWxfcGxh
bmVfY3JlYXRlKGRldl9wcml2LCBwaXBlLAo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQo+
ICsJCXJldHVybiBza2xfdW5pdmVyc2FsX3BsYW5lX2NyZWF0ZShpOTE1LCBwaXBlLAo+ICAgCQkJ
CQkJICBQTEFORV9TUFJJVEUwICsgc3ByaXRlKTsKPiAgIAo+ICAgCXBsYW5lID0gaW50ZWxfcGxh
bmVfYWxsb2MoKTsKPiAgIAlpZiAoSVNfRVJSKHBsYW5lKSkKPiAgIAkJcmV0dXJuIHBsYW5lOwo+
ICAgCj4gLQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZf
cHJpdikpIHsKPiArCWlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkx
NSkpIHsKPiAgIAkJcGxhbmUtPm1heF9zdHJpZGUgPSBpOXh4X3BsYW5lX21heF9zdHJpZGU7Cj4g
ICAJCXBsYW5lLT51cGRhdGVfcGxhbmUgPSB2bHZfdXBkYXRlX3BsYW5lOwo+ICAgCQlwbGFuZS0+
ZGlzYWJsZV9wbGFuZSA9IHZsdl9kaXNhYmxlX3BsYW5lOwo+IEBAIC0yMzkzLDcgKzIzOTMsNyBA
QCBpbnRlbF9zcHJpdGVfcGxhbmVfY3JlYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiAgIAkJbW9kaWZpZXJzID0gaTl4eF9wbGFuZV9mb3JtYXRfbW9kaWZpZXJzOwo+ICAg
Cj4gICAJCXBsYW5lX2Z1bmNzID0gJnZsdl9zcHJpdGVfZnVuY3M7Cj4gLQl9IGVsc2UgaWYgKElO
VEVMX0dFTihkZXZfcHJpdikgPj0gNykgewo+ICsJfSBlbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkg
Pj0gNykgewo+ICAgCQlwbGFuZS0+bWF4X3N0cmlkZSA9IGc0eF9zcHJpdGVfbWF4X3N0cmlkZTsK
PiAgIAkJcGxhbmUtPnVwZGF0ZV9wbGFuZSA9IGl2Yl91cGRhdGVfcGxhbmU7Cj4gICAJCXBsYW5l
LT5kaXNhYmxlX3BsYW5lID0gaXZiX2Rpc2FibGVfcGxhbmU7Cj4gQEAgLTI0MTMsNyArMjQxMyw3
IEBAIGludGVsX3Nwcml0ZV9wbGFuZV9jcmVhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ICAgCQlwbGFuZS0+Y2hlY2tfcGxhbmUgPSBnNHhfc3ByaXRlX2NoZWNrOwo+ICAg
Cj4gICAJCW1vZGlmaWVycyA9IGk5eHhfcGxhbmVfZm9ybWF0X21vZGlmaWVyczsKPiAtCQlpZiAo
SVNfR0VOKGRldl9wcml2LCA2KSkgewo+ICsJCWlmIChJU19HRU4oaTkxNSwgNikpIHsKPiAgIAkJ
CWZvcm1hdHMgPSBzbmJfcGxhbmVfZm9ybWF0czsKPiAgIAkJCW51bV9mb3JtYXRzID0gQVJSQVlf
U0laRShzbmJfcGxhbmVfZm9ybWF0cyk7Cj4gICAKPiBAQCAtMjQyNiw3ICsyNDI2LDcgQEAgaW50
ZWxfc3ByaXRlX3BsYW5lX2NyZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gICAJCX0KPiAgIAl9Cj4gICAKPiAtCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSAmJiBw
aXBlID09IFBJUEVfQikgewo+ICsJaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkgJiYgcGlwZSA9PSBQ
SVBFX0IpIHsKPiAgIAkJc3VwcG9ydGVkX3JvdGF0aW9ucyA9Cj4gICAJCQlEUk1fTU9ERV9ST1RB
VEVfMCB8IERSTV9NT0RFX1JPVEFURV8xODAgfAo+ICAgCQkJRFJNX01PREVfUkVGTEVDVF9YOwo+
IEBAIC0yNDQxLDcgKzI0NDEsNyBAQCBpbnRlbF9zcHJpdGVfcGxhbmVfY3JlYXRlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAo+ICAgCXBvc3NpYmxlX2NydGNzID0gQklU
KHBpcGUpOwo+ICAgCj4gLQlyZXQgPSBkcm1fdW5pdmVyc2FsX3BsYW5lX2luaXQoJmRldl9wcml2
LT5kcm0sICZwbGFuZS0+YmFzZSwKPiArCXJldCA9IGRybV91bml2ZXJzYWxfcGxhbmVfaW5pdCgm
aTkxNS0+ZHJtLCAmcGxhbmUtPmJhc2UsCj4gICAJCQkJICAgICAgIHBvc3NpYmxlX2NydGNzLCBw
bGFuZV9mdW5jcywKPiAgIAkJCQkgICAgICAgZm9ybWF0cywgbnVtX2Zvcm1hdHMsIG1vZGlmaWVy
cywKPiAgIAkJCQkgICAgICAgRFJNX1BMQU5FX1RZUEVfT1ZFUkxBWSwKPiBkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfc3ByaXRlLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9zcHJpdGUuaAo+IGluZGV4IDUwMGY2YmZmYjEzOS4uNDAxMjk1ZTA1MTE2IDEwMDY0
NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3Nwcml0ZS5oCj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfc3ByaXRlLmgKPiBAQCAtMjEsNyArMjEsNyBAQCBzdHJ1
Y3QgaW50ZWxfcGxhbmVfc3RhdGU7Cj4gICBib29sIGlzX3BsYW5hcl95dXZfZm9ybWF0KHUzMiBw
aXhlbGZvcm1hdCk7Cj4gICBpbnQgaW50ZWxfdXNlY3NfdG9fc2NhbmxpbmVzKGNvbnN0IHN0cnVj
dCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlLAo+ICAgCQkJICAgICBpbnQgdXNlY3Mp
Owo+IC1zdHJ1Y3QgaW50ZWxfcGxhbmUgKmludGVsX3Nwcml0ZV9wbGFuZV9jcmVhdGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdHJ1Y3QgaW50ZWxfcGxhbmUgKmludGVs
X3Nwcml0ZV9wbGFuZV9jcmVhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJ
CQkJCSAgICAgIGVudW0gcGlwZSBwaXBlLCBpbnQgcGxhbmUpOwo+ICAgaW50IGludGVsX3Nwcml0
ZV9zZXRfY29sb3JrZXlfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwK
PiAgIAkJCQkgICAgc3RydWN0IGRybV9maWxlICpmaWxlX3ByaXYpOwo+IEBAIC0zMSw3ICszMSw3
IEBAIGludCBpbnRlbF9wbGFuZV9jaGVja19zdHJpZGUoY29uc3Qgc3RydWN0IGludGVsX3BsYW5l
X3N0YXRlICpwbGFuZV9zdGF0ZSk7Cj4gICBpbnQgaW50ZWxfcGxhbmVfY2hlY2tfc3JjX2Nvb3Jk
aW5hdGVzKHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpOwo+ICAgaW50IGNo
dl9wbGFuZV9jaGVja19yb3RhdGlvbihjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBs
YW5lX3N0YXRlKTsKPiAgIHN0cnVjdCBpbnRlbF9wbGFuZSAqCj4gLXNrbF91bml2ZXJzYWxfcGxh
bmVfY3JlYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc2tsX3VuaXZl
cnNhbF9wbGFuZV9jcmVhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkg
ICBlbnVtIHBpcGUgcGlwZSwgZW51bSBwbGFuZV9pZCBwbGFuZV9pZCk7Cj4gICAKPiAgIHN0YXRp
YyBpbmxpbmUgYm9vbCBpY2xfaXNfbnYxMl95X3BsYW5lKGVudW0gcGxhbmVfaWQgaWQpCj4gQEAg
LTQ5LDEwICs0OSwxMCBAQCBzdGF0aWMgaW5saW5lIHU4IGljbF9oZHJfcGxhbmVfbWFzayh2b2lk
KQo+ICAgCQlCSVQoUExBTkVfU1BSSVRFMCkgfCBCSVQoUExBTkVfU1BSSVRFMSk7Cj4gICB9Cj4g
ICAKPiAtc3RhdGljIGlubGluZSBib29sIGljbF9pc19oZHJfcGxhbmUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgaW5saW5lIGJvb2wgaWNsX2lzX2hkcl9wbGFu
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAgZW51bSBwbGFuZV9p
ZCBwbGFuZV9pZCkKPiAgIHsKPiAtCXJldHVybiBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExICYm
Cj4gKwlyZXR1cm4gSU5URUxfR0VOKGk5MTUpID49IDExICYmCj4gICAJCWljbF9oZHJfcGxhbmVf
bWFzaygpICYgQklUKHBsYW5lX2lkKTsKPiAgIH0KPiAgIAo+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF90di5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdHYu
Ywo+IGluZGV4IDVkYzU5NGVhZmFmMi4uNGU2NjI2MWJmNWFmIDEwMDY0NAo+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX3R2LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF90di5jCj4gQEAgLTkwNiw3ICs5MDYsNyBAQCBzdGF0aWMgc3RydWN0IGludGVsX3R2ICpp
bnRlbF9hdHRhY2hlZF90dihzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ICAgc3Rh
dGljIGJvb2wKPiAgIGludGVsX3R2X2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlciwgZW51bSBwaXBlICpwaXBlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXUz
MiB0bXAgPSBJOTE1X1JFQUQoVFZfQ1RMKTsKPiAgIAo+ICAgCSpwaXBlID0gKHRtcCAmIFRWX0VO
Q19QSVBFX1NFTF9NQVNLKSA+PiBUVl9FTkNfUElQRV9TRUxfU0hJRlQ7Cj4gQEAgLTkyMCwxMCAr
OTIwLDEwIEBAIGludGVsX2VuYWJsZV90dihzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwK
PiAgIAkJY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4gICB7
Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGVuY29kZXItPmJhc2UuZGV2Owo+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAKPiAgIAkvKiBQcmV2
ZW50cyB2Ymxhbmsgd2FpdHMgZnJvbSB0aW1pbmcgb3V0IGluIGludGVsX3R2X2RldGVjdF90eXBl
KCkgKi8KPiAtCWludGVsX3dhaXRfZm9yX3ZibGFuayhkZXZfcHJpdiwKPiArCWludGVsX3dhaXRf
Zm9yX3ZibGFuayhpOTE1LAo+ICAgCQkJICAgICAgdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+
YmFzZS5jcnRjKS0+cGlwZSk7Cj4gICAKPiAgIAlJOTE1X1dSSVRFKFRWX0NUTCwgSTkxNV9SRUFE
KFRWX0NUTCkgfCBUVl9FTkNfRU5BQkxFKTsKPiBAQCAtOTM1LDcgKzkzNSw3IEBAIGludGVsX2Rp
c2FibGVfdHYoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCSBjb25zdCBzdHJ1
Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCj4gICB7Cj4gICAJc3RydWN0
IGRybV9kZXZpY2UgKmRldiA9IGVuY29kZXItPmJhc2UuZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAKPiAgIAlJOTE1X1dSSVRFKFRWX0NUTCwg
STkxNV9SRUFEKFRWX0NUTCkgJiB+VFZfRU5DX0VOQUJMRSk7Cj4gICB9Cj4gQEAgLTEwODQsNyAr
MTA4NCw3IEBAIHN0YXRpYyB2b2lkCj4gICBpbnRlbF90dl9nZXRfY29uZmlnKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBp
cGVfY29uZmlnKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBkcm1fZGlzcGxh
eV9tb2RlICphZGp1c3RlZF9tb2RlID0KPiAgIAkJJnBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVk
X21vZGU7Cj4gICAJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgbW9kZSA9IHt9Owo+IEBAIC0xMTU4
LDE1ICsxMTU4LDE1IEBAIGludGVsX3R2X2dldF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4gICAJCWFkanVzdGVkX21vZGUtPmNydGNfY2xvY2sgLz0gMjsKPiAgIAo+ICAg
CS8qIHBpeGVsIGNvdW50ZXIgZG9lc24ndCB3b3JrIG9uIGk5NjVnbSBUViBvdXRwdXQgKi8KPiAt
CWlmIChJU19JOTY1R00oZGV2X3ByaXYpKQo+ICsJaWYgKElTX0k5NjVHTShpOTE1KSkKPiAgIAkJ
YWRqdXN0ZWRfbW9kZS0+cHJpdmF0ZV9mbGFncyB8PQo+ICAgCQkJSTkxNV9NT0RFX0ZMQUdfVVNF
X1NDQU5MSU5FX0NPVU5URVI7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGJvb2wgaW50ZWxfdHZfc291
cmNlX3Rvb193aWRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiArc3RhdGlj
IGJvb2wgaW50ZWxfdHZfc291cmNlX3Rvb193aWRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ICAgCQkJCSAgICAgaW50IGhkaXNwbGF5KQo+ICAgewo+IC0JcmV0dXJuIElTX0dFTihk
ZXZfcHJpdiwgMykgJiYgaGRpc3BsYXkgPiAxMDI0Owo+ICsJcmV0dXJuIElTX0dFTihpOTE1LCAz
KSAmJiBoZGlzcGxheSA+IDEwMjQ7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBib29sIGludGVsX3R2
X3ZlcnRfc2NhbGluZyhjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqdHZfbW9kZSwKPiBA
QCAtMTE4NCw3ICsxMTg0LDcgQEAgaW50ZWxfdHZfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9j
b25maWcsCj4gICAJCQlzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiAg
IHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rl
ci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfdHZfY29ubmVjdG9yX3N0YXRl
ICp0dl9jb25uX3N0YXRlID0KPiAgIAkJdG9faW50ZWxfdHZfY29ubmVjdG9yX3N0YXRlKGNvbm5f
c3RhdGUpOwo+ICAgCWNvbnN0IHN0cnVjdCB0dl9tb2RlICp0dl9tb2RlID0gaW50ZWxfdHZfbW9k
ZV9maW5kKGNvbm5fc3RhdGUpOwo+IEBAIC0xMjA5LDcgKzEyMDksNyBAQCBpbnRlbF90dl9jb21w
dXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAlpbnRlbF90dl9t
b2RlX3RvX21vZGUoYWRqdXN0ZWRfbW9kZSwgdHZfbW9kZSk7Cj4gICAJZHJtX21vZGVfc2V0X2Ny
dGNpbmZvKGFkanVzdGVkX21vZGUsIDApOwo+ICAgCj4gLQlpZiAoaW50ZWxfdHZfc291cmNlX3Rv
b193aWRlKGRldl9wcml2LCBoZGlzcGxheSkgfHwKPiArCWlmIChpbnRlbF90dl9zb3VyY2VfdG9v
X3dpZGUoaTkxNSwgaGRpc3BsYXkpIHx8Cj4gICAJICAgICFpbnRlbF90dl92ZXJ0X3NjYWxpbmco
YWRqdXN0ZWRfbW9kZSwgY29ubl9zdGF0ZSwgdmRpc3BsYXkpKSB7Cj4gICAJCWludCBleHRyYSwg
dG9wLCBib3R0b207Cj4gICAKPiBAQCAtMTMwNiw3ICsxMzA2LDcgQEAgaW50ZWxfdHZfY29tcHV0
ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJICogdGhlIGFjdGl2
ZSBwb3J0aW9uLiBIZW5jZSBmb2xsb3dpbmcgdGhpcyBmb3JtdWxhIHNlZW1zCj4gICAJICogbW9y
ZSB0cm91YmxlIHRoYXQgaXQncyB3b3J0aC4KPiAgIAkgKgo+IC0JICogaWYgKElTX0dFTihkZXZf
cHJpdiwgNCkpIHsKPiArCSAqIGlmIChJU19HRU4oaTkxNSwgNCkpIHsKPiAgIAkgKgludW0gPSBj
ZGNsayAqICh0dl9tb2RlLT5vdmVyc2FtcGxlID4+ICF0dl9tb2RlLT5wcm9ncmVzc2l2ZSk7Cj4g
ICAJICoJZGVuID0gdHZfbW9kZS0+Y2xvY2s7Cj4gICAJICogfSBlbHNlIHsKPiBAQCAtMTMyNyw3
ICsxMzI3LDcgQEAgaW50ZWxfdHZfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4gICAJYWRqdXN0ZWRfbW9kZS0+bmFtZVswXSA9ICdcMCc7Cj4gICAKPiAgIAkv
KiBwaXhlbCBjb3VudGVyIGRvZXNuJ3Qgd29yayBvbiBpOTY1Z20gVFYgb3V0cHV0ICovCj4gLQlp
ZiAoSVNfSTk2NUdNKGRldl9wcml2KSkKPiArCWlmIChJU19JOTY1R00oaTkxNSkpCj4gICAJCWFk
anVzdGVkX21vZGUtPnByaXZhdGVfZmxhZ3MgfD0KPiAgIAkJCUk5MTVfTU9ERV9GTEFHX1VTRV9T
Q0FOTElORV9DT1VOVEVSOwo+ICAgCj4gQEAgLTEzMzUsNyArMTMzNSw3IEBAIGludGVsX3R2X2Nv
bXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgfQo+ICAgCj4g
ICBzdGF0aWMgdm9pZAo+IC1zZXRfdHZfbW9kZV90aW1pbmdzKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiArc2V0X3R2X21vZGVfdGltaW5ncyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiAgIAkJICAgIGNvbnN0IHN0cnVjdCB0dl9tb2RlICp0dl9tb2RlLAo+ICAg
CQkgICAgYm9vbCBidXJzdF9lbmEpCj4gICB7Cj4gQEAgLTEzOTMsNyArMTM5Myw3IEBAIHNldF90
dl9tb2RlX3RpbWluZ3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgCUk5
MTVfV1JJVEUoVFZfVl9DVExfNywgdmN0bDcpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIHNl
dF9jb2xvcl9jb252ZXJzaW9uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAr
c3RhdGljIHZvaWQgc2V0X2NvbG9yX2NvbnZlcnNpb24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCj4gICAJCQkJIGNvbnN0IHN0cnVjdCBjb2xvcl9jb252ZXJzaW9uICpjb2xvcl9jb252
ZXJzaW9uKQo+ICAgewo+ICAgCWlmICghY29sb3JfY29udmVyc2lvbikKPiBAQCAtMTQxNyw3ICsx
NDE3LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfdHZfcHJlX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKPiAgIAkJCQljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlw
ZV9jb25maWcsCj4gICAJCQkJY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5f
c3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmlu
dGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT5iYXNlLmNydGMpOwo+ICAgCXN0
cnVjdCBpbnRlbF90diAqaW50ZWxfdHYgPSBlbmNfdG9fdHYoZW5jb2Rlcik7Cj4gICAJY29uc3Qg
c3RydWN0IGludGVsX3R2X2Nvbm5lY3Rvcl9zdGF0ZSAqdHZfY29ubl9zdGF0ZSA9Cj4gQEAgLTE1
MDcsMTggKzE1MDcsMTggQEAgc3RhdGljIHZvaWQgaW50ZWxfdHZfcHJlX2VuYWJsZShzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJdHZfbW9kZS0+ZGRhM19pbmMgPDwgVFZfU0NE
REEzX0lOQ19TSElGVDsKPiAgIAo+ICAgCS8qIEVuYWJsZSB0d28gZml4ZXMgZm9yIHRoZSBjaGlw
cyB0aGF0IG5lZWQgdGhlbS4gKi8KPiAtCWlmIChJU19JOTE1R00oZGV2X3ByaXYpKQo+ICsJaWYg
KElTX0k5MTVHTShpOTE1KSkKPiAgIAkJdHZfY3RsIHw9IFRWX0VOQ19DMF9GSVggfCBUVl9FTkNf
U0RQX0ZJWDsKPiAgIAo+IC0Jc2V0X3R2X21vZGVfdGltaW5ncyhkZXZfcHJpdiwgdHZfbW9kZSwg
YnVyc3RfZW5hKTsKPiArCXNldF90dl9tb2RlX3RpbWluZ3MoaTkxNSwgdHZfbW9kZSwgYnVyc3Rf
ZW5hKTsKPiAgIAo+ICAgCUk5MTVfV1JJVEUoVFZfU0NfQ1RMXzEsIHNjY3RsMSk7Cj4gICAJSTkx
NV9XUklURShUVl9TQ19DVExfMiwgc2NjdGwyKTsKPiAgIAlJOTE1X1dSSVRFKFRWX1NDX0NUTF8z
LCBzY2N0bDMpOwo+ICAgCj4gLQlzZXRfY29sb3JfY29udmVyc2lvbihkZXZfcHJpdiwgY29sb3Jf
Y29udmVyc2lvbik7Cj4gKwlzZXRfY29sb3JfY29udmVyc2lvbihpOTE1LCBjb2xvcl9jb252ZXJz
aW9uKTsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCkKPiArCWlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gNCkKPiAgIAkJSTkxNV9XUklURShUVl9DTFJfS05PQlMsIDB4MDA0MDQw
MDApOwo+ICAgCWVsc2UKPiAgIAkJSTkxNV9XUklURShUVl9DTFJfS05PQlMsIDB4MDA2MDYwMDAp
Owo+IEBAIC0xNTI4LDcgKzE1MjgsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF90dl9wcmVfZW5hYmxl
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJICAgKCh2aWRlb19sZXZlbHMt
PmJsYWNrIDw8IFRWX0JMQUNLX0xFVkVMX1NISUZUKSB8Cj4gICAJCQkgICAgKHZpZGVvX2xldmVs
cy0+YmxhbmsgPDwgVFZfQkxBTktfTEVWRUxfU0hJRlQpKSk7Cj4gICAKPiAtCWFzc2VydF9waXBl
X2Rpc2FibGVkKGRldl9wcml2LCBpbnRlbF9jcnRjLT5waXBlKTsKPiArCWFzc2VydF9waXBlX2Rp
c2FibGVkKGk5MTUsIGludGVsX2NydGMtPnBpcGUpOwo+ICAgCj4gICAJLyogRmlsdGVyIGN0bCBt
dXN0IGJlIHNldCBiZWZvcmUgVFZfV0lOX1NJWkUgKi8KPiAgIAl0dl9maWx0ZXJfY3RsID0gVFZf
QVVUT19TQ0FMRTsKPiBAQCAtMTU2OCwxOCArMTU2OCwxOCBAQCBpbnRlbF90dl9kZXRlY3RfdHlw
ZShzdHJ1Y3QgaW50ZWxfdHYgKmludGVsX3R2LAo+ICAgCXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9
IGNvbm5lY3Rvci0+c3RhdGUtPmNydGM7Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmludGVsX2Ny
dGMgPSB0b19pbnRlbF9jcnRjKGNydGMpOwo+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBj
b25uZWN0b3ItPmRldjsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShk
ZXYpOwo+ICAgCXUzMiB0dl9jdGwsIHNhdmVfdHZfY3RsOwo+ICAgCXUzMiB0dl9kYWMsIHNhdmVf
dHZfZGFjOwo+ICAgCWludCB0eXBlOwo+ICAgCj4gICAJLyogRGlzYWJsZSBUViBpbnRlcnJ1cHRz
IGFyb3VuZCBsb2FkIGRldGVjdCBvciB3ZSdsbCByZWN1cnNlICovCj4gICAJaWYgKGNvbm5lY3Rv
ci0+cG9sbGVkICYgRFJNX0NPTk5FQ1RPUl9QT0xMX0hQRCkgewo+IC0JCXNwaW5fbG9ja19pcnEo
JmRldl9wcml2LT5pcnFfbG9jayk7Cj4gLQkJaTkxNV9kaXNhYmxlX3BpcGVzdGF0KGRldl9wcml2
LCAwLAo+ICsJCXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiArCQlpOTE1X2Rpc2Fi
bGVfcGlwZXN0YXQoaTkxNSwgMCwKPiAgIAkJCQkgICAgICBQSVBFX0hPVFBMVUdfSU5URVJSVVBU
X1NUQVRVUyB8Cj4gICAJCQkJICAgICAgUElQRV9IT1RQTFVHX1RWX0lOVEVSUlVQVF9TVEFUVVMp
Owo+IC0JCXNwaW5fdW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiArCQlzcGluX3Vu
bG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiAgIAl9Cj4gICAKPiAgIAlzYXZlX3R2X2RhYyA9
IHR2X2RhYyA9IEk5MTVfUkVBRChUVl9EQUMpOwo+IEBAIC0xNjA1LDcgKzE2MDUsNyBAQCBpbnRl
bF90dl9kZXRlY3RfdHlwZShzdHJ1Y3QgaW50ZWxfdHYgKmludGVsX3R2LAo+ICAgCSAqIFRoZSBU
ViBzZW5zZSBzdGF0ZSBzaG91bGQgYmUgY2xlYXJlZCB0byB6ZXJvIG9uIGNhbnRpZ2EgcGxhdGZv
cm0uIE90aGVyd2lzZQo+ICAgCSAqIHRoZSBUViBpcyBtaXNkZXRlY3RlZC4gVGhpcyBpcyBoYXJk
d2FyZSByZXF1aXJlbWVudC4KPiAgIAkgKi8KPiAtCWlmIChJU19HTTQ1KGRldl9wcml2KSkKPiAr
CWlmIChJU19HTTQ1KGk5MTUpKQo+ICAgCQl0dl9kYWMgJj0gfihUVkRBQ19TVEFURV9DSEdfRU4g
fCBUVkRBQ19BX1NFTlNFX0NUTCB8Cj4gICAJCQkgICAgVFZEQUNfQl9TRU5TRV9DVEwgfCBUVkRB
Q19DX1NFTlNFX0NUTCk7Cj4gICAKPiBAQCAtMTYxMyw3ICsxNjEzLDcgQEAgaW50ZWxfdHZfZGV0
ZWN0X3R5cGUoc3RydWN0IGludGVsX3R2ICppbnRlbF90diwKPiAgIAlJOTE1X1dSSVRFKFRWX0RB
QywgdHZfZGFjKTsKPiAgIAlQT1NUSU5HX1JFQUQoVFZfREFDKTsKPiAgIAo+IC0JaW50ZWxfd2Fp
dF9mb3JfdmJsYW5rKGRldl9wcml2LCBpbnRlbF9jcnRjLT5waXBlKTsKPiArCWludGVsX3dhaXRf
Zm9yX3ZibGFuayhpOTE1LCBpbnRlbF9jcnRjLT5waXBlKTsKPiAgIAo+ICAgCXR5cGUgPSAtMTsK
PiAgIAl0dl9kYWMgPSBJOTE1X1JFQUQoVFZfREFDKTsKPiBAQCAtMTY0MywxNSArMTY0MywxNSBA
QCBpbnRlbF90dl9kZXRlY3RfdHlwZShzdHJ1Y3QgaW50ZWxfdHYgKmludGVsX3R2LAo+ICAgCVBP
U1RJTkdfUkVBRChUVl9DVEwpOwo+ICAgCj4gICAJLyogRm9yIHVua25vd24gcmVhc29ucyB0aGUg
aHcgYmFyZnMgaWYgd2UgZG9uJ3QgZG8gdGhpcyB2Ymxhbmsgd2FpdC4gKi8KPiAtCWludGVsX3dh
aXRfZm9yX3ZibGFuayhkZXZfcHJpdiwgaW50ZWxfY3J0Yy0+cGlwZSk7Cj4gKwlpbnRlbF93YWl0
X2Zvcl92YmxhbmsoaTkxNSwgaW50ZWxfY3J0Yy0+cGlwZSk7Cj4gICAKPiAgIAkvKiBSZXN0b3Jl
IGludGVycnVwdCBjb25maWcgKi8KPiAgIAlpZiAoY29ubmVjdG9yLT5wb2xsZWQgJiBEUk1fQ09O
TkVDVE9SX1BPTExfSFBEKSB7Cj4gLQkJc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2Nr
KTsKPiAtCQlpOTE1X2VuYWJsZV9waXBlc3RhdChkZXZfcHJpdiwgMCwKPiArCQlzcGluX2xvY2tf
aXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gKwkJaTkxNV9lbmFibGVfcGlwZXN0YXQoaTkxNSwgMCwK
PiAgIAkJCQkgICAgIFBJUEVfSE9UUExVR19JTlRFUlJVUFRfU1RBVFVTIHwKPiAgIAkJCQkgICAg
IFBJUEVfSE9UUExVR19UVl9JTlRFUlJVUFRfU1RBVFVTKTsKPiAtCQlzcGluX3VubG9ja19pcnEo
JmRldl9wcml2LT5pcnFfbG9jayk7Cj4gKwkJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9j
ayk7Cj4gICAJfQo+ICAgCj4gICAJcmV0dXJuIHR5cGU7Cj4gQEAgLTE3NjQsNyArMTc2NCw3IEBA
IGludGVsX3R2X3NldF9tb2RlX3R5cGUoc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUsCj4g
ICBzdGF0aWMgaW50Cj4gICBpbnRlbF90dl9nZXRfbW9kZXMoc3RydWN0IGRybV9jb25uZWN0b3Ig
KmNvbm5lY3RvcikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsKPiAgIAljb25zdCBzdHJ1Y3QgdHZfbW9kZSAq
dHZfbW9kZSA9IGludGVsX3R2X21vZGVfZmluZChjb25uZWN0b3ItPnN0YXRlKTsKPiAgIAlpbnQg
aSwgY291bnQgPSAwOwo+ICAgCj4gQEAgLTE3NzgsNyArMTc3OCw3IEBAIGludGVsX3R2X2dldF9t
b2RlcyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ICAgCQkJY29udGludWU7Cj4g
ICAKPiAgIAkJLyogbm8gdmVydGljYWwgc2NhbGluZyB3aXRoIHdpZGUgc291cmNlcyBvbiBnZW4z
ICovCj4gLQkJaWYgKElTX0dFTihkZXZfcHJpdiwgMykgJiYgaW5wdXQtPncgPiAxMDI0ICYmCj4g
KwkJaWYgKElTX0dFTihpOTE1LCAzKSAmJiBpbnB1dC0+dyA+IDEwMjQgJiYKPiAgIAkJICAgIGlu
cHV0LT5oID4gaW50ZWxfdHZfbW9kZV92ZGlzcGxheSh0dl9tb2RlKSkKPiAgIAkJCWNvbnRpbnVl
Owo+ICAgCj4gQEAgLTE4NTcsOSArMTg1Nyw5IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2Vu
Y29kZXJfZnVuY3MgaW50ZWxfdHZfZW5jX2Z1bmNzID0gewo+ICAgfTsKPiAgIAo+ICAgdm9pZAo+
IC1pbnRlbF90dl9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAraW50
ZWxfdHZfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAtCXN0cnVj
dCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKPiArCXN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYgPSAmaTkxNS0+ZHJtOwo+ICAgCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3I7
Cj4gICAJc3RydWN0IGludGVsX3R2ICppbnRlbF90djsKPiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqaW50ZWxfZW5jb2RlcjsKPiBAQCAtMTg3Miw3ICsxODcyLDcgQEAgaW50ZWxfdHZfaW5pdChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJaWYgKChJOTE1X1JFQUQoVFZf
Q1RMKSAmIFRWX0ZVU0VfU1RBVEVfTUFTSykgPT0gVFZfRlVTRV9TVEFURV9ESVNBQkxFRCkKPiAg
IAkJcmV0dXJuOwo+ICAgCj4gLQlpZiAoIWludGVsX2Jpb3NfaXNfdHZfcHJlc2VudChkZXZfcHJp
dikpIHsKPiArCWlmICghaW50ZWxfYmlvc19pc190dl9wcmVzZW50KGk5MTUpKSB7Cj4gICAJCURS
TV9ERUJVR19LTVMoIkludGVncmF0ZWQgVFYgaXMgbm90IHByZXNlbnQuXG4iKTsKPiAgIAkJcmV0
dXJuOwo+ICAgCX0KPiBAQCAtMTk2Niw3ICsxOTY2LDcgQEAgaW50ZWxfdHZfaW5pdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJLyogQ3JlYXRlIFRWIHByb3BlcnRpZXMg
dGhlbiBhdHRhY2ggY3VycmVudCB2YWx1ZXMgKi8KPiAgIAlmb3IgKGkgPSAwOyBpIDwgQVJSQVlf
U0laRSh0dl9tb2Rlcyk7IGkrKykgewo+ICAgCQkvKiAxMDgwcDUwLzEwODBwNjAgbm90IHN1cHBv
cnRlZCBvbiBnZW4zICovCj4gLQkJaWYgKElTX0dFTihkZXZfcHJpdiwgMykgJiYKPiArCQlpZiAo
SVNfR0VOKGk5MTUsIDMpICYmCj4gICAJCSAgICB0dl9tb2Rlc1tpXS5vdmVyc2FtcGxlID09IDEp
Cj4gICAJCQlicmVhazsKPiAgIAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF90di5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdHYuaAo+IGluZGV4IDQ0NTE4
NTc1ZWM1Yy4uZmMwYjg5NTYzYjRmIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX3R2LmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF90di5oCj4gQEAg
LTgsNiArOCw2IEBACj4gICAKPiAgIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlOwo+ICAgCj4gLXZv
aWQgaW50ZWxfdHZfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ICt2
b2lkIGludGVsX3R2X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgCj4g
ICAjZW5kaWYgLyogX19JTlRFTF9UVl9IX18gKi8KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfdWMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3VjLmMKPiBp
bmRleCBhOGU3ZjBiYTdjM2IuLjExZTJkY2Y2YjkxNyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF91Yy5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
dWMuYwo+IEBAIC0zMywxMiArMzMsMTIgQEAgc3RhdGljIHZvaWQgZ3VjX2ZyZWVfbG9hZF9lcnJf
bG9nKHN0cnVjdCBpbnRlbF9ndWMgKmd1Yyk7Cj4gICAKPiAgIC8qIFJlc2V0IEd1QyBwcm92aWRp
bmcgdXMgd2l0aCBmcmVzaCBzdGF0ZSBmb3IgYm90aCBHdUMgYW5kIEh1Qy4KPiAgICAqLwo+IC1z
dGF0aWMgaW50IF9faW50ZWxfdWNfcmVzZXRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ICtzdGF0aWMgaW50IF9faW50ZWxfdWNfcmVzZXRfaHcoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJaW50IHJldDsKPiAgIAl1MzIgZ3VjX3N0YXR1czsK
PiAgIAo+IC0JcmV0ID0gaW50ZWxfcmVzZXRfZ3VjKGRldl9wcml2KTsKPiArCXJldCA9IGludGVs
X3Jlc2V0X2d1YyhpOTE1KTsKPiAgIAlpZiAocmV0KSB7Cj4gICAJCURSTV9FUlJPUigiRmFpbGVk
IHRvIHJlc2V0IEd1QywgcmV0ID0gJWRcbiIsIHJldCk7Cj4gICAJCXJldHVybiByZXQ7Cj4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3VjLmggYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF91Yy5oCj4gaW5kZXggM2VhMDZjODdkZmNkLi40ZGRkNTBkOTkwYjMgMTAw
NjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdWMuaAo+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX3VjLmgKPiBAQCAtMjgsMjAgKzI4LDIwIEBACj4gICAjaW5j
bHVkZSAiaW50ZWxfaHVjLmgiCj4gICAjaW5jbHVkZSAiaTkxNV9wYXJhbXMuaCIKPiAgIAo+IC12
b2lkIGludGVsX3VjX2luaXRfZWFybHkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KTsKPiAtdm9pZCBpbnRlbF91Y19jbGVhbnVwX2Vhcmx5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdik7Cj4gLXZvaWQgaW50ZWxfdWNfaW5pdF9tbWlvKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdik7Cj4gLWludCBpbnRlbF91Y19pbml0X21pc2Moc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtdm9pZCBpbnRlbF91Y19maW5pX21pc2Moc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtdm9pZCBpbnRlbF91Y19zYW5pdGl6ZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC1pbnQgaW50ZWxfdWNfaW5pdF9o
dyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGludGVsX3VjX2Zp
bmlfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtaW50IGludGVsX3Vj
X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAtdm9pZCBpbnRlbF91
Y19maW5pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gK3ZvaWQgaW50ZWxf
dWNfaW5pdF9lYXJseShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3ZvaWQgaW50
ZWxfdWNfY2xlYW51cF9lYXJseShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gK3Zv
aWQgaW50ZWxfdWNfaW5pdF9tbWlvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAr
aW50IGludGVsX3VjX2luaXRfbWlzYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4g
K3ZvaWQgaW50ZWxfdWNfZmluaV9taXNjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsK
PiArdm9pZCBpbnRlbF91Y19zYW5pdGl6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7
Cj4gK2ludCBpbnRlbF91Y19pbml0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsK
PiArdm9pZCBpbnRlbF91Y19maW5pX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsK
PiAraW50IGludGVsX3VjX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICt2
b2lkIGludGVsX3VjX2Zpbmkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgdm9p
ZCBpbnRlbF91Y19yZXNldF9wcmVwYXJlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsK
PiAgIHZvaWQgaW50ZWxfdWNfc3VzcGVuZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7
Cj4gICB2b2lkIGludGVsX3VjX3J1bnRpbWVfc3VzcGVuZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSk7Cj4gLWludCBpbnRlbF91Y19yZXN1bWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KTsKPiAraW50IGludGVsX3VjX3Jlc3VtZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSk7Cj4gICAKPiAgIHN0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF91Y19pc191c2luZ19n
dWMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3VjX2Z3LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF91Y19mdy5jCj4gaW5kZXggZjM0MmRkZDQ3ZGY4Li5kMTU2OTExZDE1NjAgMTAwNjQ0Cj4g
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdWNfZncuYwo+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX3VjX2Z3LmMKPiBAQCAtMzIsMTUgKzMyLDE1IEBACj4gICAvKioK
PiAgICAqIGludGVsX3VjX2Z3X2ZldGNoIC0gZmV0Y2ggdUMgZmlybXdhcmUKPiAgICAqCj4gLSAq
IEBkZXZfcHJpdjogZGV2aWNlIHByaXZhdGUKPiArICogQGk5MTU6IGRldmljZSBwcml2YXRlCj4g
ICAgKiBAdWNfZnc6IHVDIGZpcm13YXJlCj4gICAgKgo+ICAgICogRmV0Y2ggdUMgZmlybXdhcmUg
aW50byBHRU0gb2JqLgo+ICAgICovCj4gLXZvaWQgaW50ZWxfdWNfZndfZmV0Y2goc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICt2b2lkIGludGVsX3VjX2Z3X2ZldGNoKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkgICAgICAgc3RydWN0IGludGVsX3VjX2Z3
ICp1Y19mdykKPiAgIHsKPiAtCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gZGV2X3ByaXYtPmRybS5w
ZGV2Owo+ICsJc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBpOTE1LT5kcm0ucGRldjsKPiAgIAlzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwo+ICAgCWNvbnN0IHN0cnVjdCBmaXJtd2FyZSAq
ZncgPSBOVUxMOwo+ICAgCXN0cnVjdCB1Y19jc3NfaGVhZGVyICpjc3M7Cj4gQEAgLTQ4LDEwICs0
OCwxMCBAQCB2b2lkIGludGVsX3VjX2Z3X2ZldGNoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiAgIAlpbnQgZXJyOwo+ICAgCj4gICAJaWYgKCF1Y19mdy0+cGF0aCkgewo+IC0J
CWRldl9pbmZvKGRldl9wcml2LT5kcm0uZGV2LAo+ICsJCWRldl9pbmZvKGk5MTUtPmRybS5kZXYs
Cj4gICAJCQkgIiVzOiBObyBmaXJtd2FyZSB3YXMgZGVmaW5lZCBmb3IgJXMhXG4iLAo+ICAgCQkJ
IGludGVsX3VjX2Z3X3R5cGVfcmVwcih1Y19mdy0+dHlwZSksCj4gLQkJCSBpbnRlbF9wbGF0Zm9y
bV9uYW1lKElOVEVMX0lORk8oZGV2X3ByaXYpLT5wbGF0Zm9ybSkpOwo+ICsJCQkgaW50ZWxfcGxh
dGZvcm1fbmFtZShJTlRFTF9JTkZPKGk5MTUpLT5wbGF0Zm9ybSkpOwo+ICAgCQlyZXR1cm47Cj4g
ICAJfQo+ICAgCj4gQEAgLTE1OSw3ICsxNTksNyBAQCB2b2lkIGludGVsX3VjX2Z3X2ZldGNoKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgIAkJZ290byBmYWlsOwo+ICAgCX0K
PiAgIAo+IC0Jb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zaG1lbV9mcm9tX2RhdGEoZGV2
X3ByaXYsCj4gKwlvYmogPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3NobWVtX2Zyb21fZGF0YShp
OTE1LAo+ICAgCQkJCQkJICAgICBmdy0+ZGF0YSwgZnctPnNpemUpOwo+ICAgCWlmIChJU19FUlIo
b2JqKSkgewo+ICAgCQllcnIgPSBQVFJfRVJSKG9iaik7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX3VjX2Z3LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91
Y19mdy5oCj4gaW5kZXggZmY5OGY4NjYxZDcyLi44ODFjM2FlZjA3NGMgMTAwNjQ0Cj4gLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdWNfZncuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX3VjX2Z3LmgKPiBAQCAtMTQyLDcgKzE0Miw3IEBAIHN0YXRpYyBpbmxpbmUg
dTMyIGludGVsX3VjX2Z3X2dldF91cGxvYWRfc2l6ZShzdHJ1Y3QgaW50ZWxfdWNfZncgKnVjX2Z3
KQo+ICAgCXJldHVybiB1Y19mdy0+aGVhZGVyX3NpemUgKyB1Y19mdy0+dWNvZGVfc2l6ZTsKPiAg
IH0KPiAgIAo+IC12b2lkIGludGVsX3VjX2Z3X2ZldGNoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiArdm9pZCBpbnRlbF91Y19md19mZXRjaChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiAgIAkJICAgICAgIHN0cnVjdCBpbnRlbF91Y19mdyAqdWNfZncpOwo+ICAg
dm9pZCBpbnRlbF91Y19md19jbGVhbnVwX2ZldGNoKHN0cnVjdCBpbnRlbF91Y19mdyAqdWNfZncp
Owo+ICAgaW50IGludGVsX3VjX2Z3X3VwbG9hZChzdHJ1Y3QgaW50ZWxfdWNfZncgKnVjX2Z3LAo+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91bmNvcmUuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX3VuY29yZS5jCj4gaW5kZXggODUxNzFhOGI4NjZhLi44N2Rl
YzAwNTE2NWQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdW5jb3Jl
LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91bmNvcmUuYwo+IEBAIC01Mzcs
MTAgKzUzNywxMCBAQCB2b2lkIGludGVsX3VuY29yZV9ydW50aW1lX3Jlc3VtZShzdHJ1Y3QgaW50
ZWxfdW5jb3JlICp1bmNvcmUpCj4gICAJaW9zZl9tYmlfcmVnaXN0ZXJfcG1pY19idXNfYWNjZXNz
X25vdGlmaWVyKCZ1bmNvcmUtPnBtaWNfYnVzX2FjY2Vzc19uYik7Cj4gICB9Cj4gICAKPiAtdm9p
ZCBpbnRlbF91bmNvcmVfc2FuaXRpemUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ICt2b2lkIGludGVsX3VuY29yZV9zYW5pdGl6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiAgIHsKPiAgIAkvKiBCSU9TIG9mdGVuIGxlYXZlcyBSQzYgZW5hYmxlZCwgYnV0IGRp
c2FibGUgaXQgZm9yIGh3IGluaXQgKi8KPiAtCWludGVsX3Nhbml0aXplX2d0X3Bvd2Vyc2F2ZShk
ZXZfcHJpdik7Cj4gKwlpbnRlbF9zYW5pdGl6ZV9ndF9wb3dlcnNhdmUoaTkxNSk7Cj4gICB9Cj4g
ICAKPiAgIHN0YXRpYyB2b2lkIF9faW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoc3RydWN0IGlu
dGVsX3VuY29yZSAqdW5jb3JlLAo+IEBAIC02NDcsNyArNjQ3LDcgQEAgdm9pZCBpbnRlbF91bmNv
cmVfZm9yY2V3YWtlX3VzZXJfcHV0KHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSkKPiAgICAq
IEBmd19kb21haW5zOiBmb3JjZXdha2UgZG9tYWlucyB0byBnZXQgcmVmZXJlbmNlIG9uCj4gICAg
Kgo+ICAgICogU2VlIGludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCkuIFRoaXMgdmFyaWFudCBw
bGFjZXMgdGhlIG9udXMKPiAtICogb24gdGhlIGNhbGxlciB0byBleHBsaWNpdGx5IGhhbmRsZSB0
aGUgZGV2X3ByaXYtPnVuY29yZS5sb2NrIHNwaW5sb2NrLgo+ICsgKiBvbiB0aGUgY2FsbGVyIHRv
IGV4cGxpY2l0bHkgaGFuZGxlIHRoZSBpOTE1LT51bmNvcmUubG9jayBzcGlubG9jay4KPiAgICAq
Lwo+ICAgdm9pZCBpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldF9fbG9ja2VkKHN0cnVjdCBpbnRl
bF91bmNvcmUgKnVuY29yZSwKPiAgIAkJCQkJZW51bSBmb3JjZXdha2VfZG9tYWlucyBmd19kb21h
aW5zKQo+IEBAIC03MDgsNyArNzA4LDcgQEAgdm9pZCBpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1
dChzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUsCj4gICAgKiBAZndfZG9tYWluczogZm9yY2V3
YWtlIGRvbWFpbnMgdG8gZ2V0IHJlZmVyZW5jZSBvbgo+ICAgICoKPiAgICAqIFNlZSBpbnRlbF91
bmNvcmVfZm9yY2V3YWtlX3B1dCgpLiBUaGlzIHZhcmlhbnQgcGxhY2VzIHRoZSBvbnVzCj4gLSAq
IG9uIHRoZSBjYWxsZXIgdG8gZXhwbGljaXRseSBoYW5kbGUgdGhlIGRldl9wcml2LT51bmNvcmUu
bG9jayBzcGlubG9jay4KPiArICogb24gdGhlIGNhbGxlciB0byBleHBsaWNpdGx5IGhhbmRsZSB0
aGUgaTkxNS0+dW5jb3JlLmxvY2sgc3BpbmxvY2suCj4gICAgKi8KPiAgIHZvaWQgaW50ZWxfdW5j
b3JlX2ZvcmNld2FrZV9wdXRfX2xvY2tlZChzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUsCj4g
ICAJCQkJCWVudW0gZm9yY2V3YWtlX2RvbWFpbnMgZndfZG9tYWlucykKPiBAQCAtODIxLDEwICs4
MjEsMTAgQEAgZmluZF9md19kb21haW4oc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlLCB1MzIg
b2Zmc2V0KQo+ICAgI2RlZmluZSBHRU5fRldfUkFOR0UocywgZSwgZCkgXAo+ICAgCXsgLnN0YXJ0
ID0gKHMpLCAuZW5kID0gKGUpLCAuZG9tYWlucyA9IChkKSB9Cj4gICAKPiAtI2RlZmluZSBIQVNf
RldUQUJMRShkZXZfcHJpdikgXAo+IC0JKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSB8fCBcCj4g
LQkgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikgfHwgXAo+IC0JIElTX1ZBTExFWVZJRVcoZGV2X3By
aXYpKQo+ICsjZGVmaW5lIEhBU19GV1RBQkxFKGk5MTUpIFwKPiArCShJTlRFTF9HRU4oaTkxNSkg
Pj0gOSB8fCBcCj4gKwkgSVNfQ0hFUlJZVklFVyhpOTE1KSB8fCBcCj4gKwkgSVNfVkFMTEVZVklF
VyhpOTE1KSkKPiAgIAo+ICAgLyogKk11c3QqIGJlIHNvcnRlZCBieSBvZmZzZXQgcmFuZ2VzISBT
ZWUgaW50ZWxfZndfdGFibGVfY2hlY2soKS4gKi8KPiAgIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaW50
ZWxfZm9yY2V3YWtlX3JhbmdlIF9fdmx2X2Z3X3Jhbmdlc1tdID0gewo+IEBAIC0xNDYxLDcgKzE0
NjEsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF91bmNvcmVfZndfZG9tYWluc19pbml0KHN0cnVjdCBp
bnRlbF91bmNvcmUgKnVuY29yZSkKPiAgIHN0YXRpYyBpbnQgaTkxNV9wbWljX2J1c19hY2Nlc3Nf
bm90aWZpZXIoc3RydWN0IG5vdGlmaWVyX2Jsb2NrICpuYiwKPiAgIAkJCQkJIHVuc2lnbmVkIGxv
bmcgYWN0aW9uLCB2b2lkICpkYXRhKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gY29udGFpbmVyX29mKG5iLAo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBjb250YWluZXJfb2YobmIsCj4gICAJCQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSwg
dW5jb3JlLnBtaWNfYnVzX2FjY2Vzc19uYik7Cj4gICAKPiAgIAlzd2l0Y2ggKGFjdGlvbikgewo+
IEBAIC0xNDc5LDEyICsxNDc5LDEyIEBAIHN0YXRpYyBpbnQgaTkxNV9wbWljX2J1c19hY2Nlc3Nf
bm90aWZpZXIoc3RydWN0IG5vdGlmaWVyX2Jsb2NrICpuYiwKPiAgIAkJICogd2FrZSByZWZlcmVu
Y2UgLT4gZGlzYWJsZSB3YWtlcmVmIGFzc2VydHMgZm9yIHRoZSB0aW1lIG9mCj4gICAJCSAqIHRo
ZSBhY2Nlc3MuCj4gICAJCSAqLwo+IC0JCWRpc2FibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZf
cHJpdik7Cj4gLQkJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUs
IEZPUkNFV0FLRV9BTEwpOwo+IC0JCWVuYWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGRldl9wcml2
KTsKPiArCQlkaXNhYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoaTkxNSk7Cj4gKwkJaW50ZWxfdW5j
b3JlX2ZvcmNld2FrZV9nZXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gKwkJZW5h
YmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoaTkxNSk7Cj4gICAJCWJyZWFrOwo+ICAgCWNhc2UgTUJJ
X1BNSUNfQlVTX0FDQ0VTU19FTkQ6Cj4gLQkJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRl
dl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ICsJCWludGVsX3VuY29yZV9mb3JjZXdh
a2VfcHV0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ICAgCQlicmVhazsKPiAgIAl9
Cj4gICAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdW5jb3JlLmgg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91bmNvcmUuaAo+IGluZGV4IGQ2YWYzZGU3MDEy
MS4uZDMwYmRhMmMzNDQ0IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X3VuY29yZS5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdW5jb3JlLmgKPiBA
QCAtMTc3LDcgKzE3Nyw3IEBAIGludGVsX3VuY29yZV9oYXNfZmlmbyhjb25zdCBzdHJ1Y3QgaW50
ZWxfdW5jb3JlICp1bmNvcmUpCj4gICAJcmV0dXJuIHVuY29yZS0+ZmxhZ3MgJiBVTkNPUkVfSEFT
X0ZJRk87Cj4gICB9Cj4gICAKPiAtdm9pZCBpbnRlbF91bmNvcmVfc2FuaXRpemUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiArdm9pZCBpbnRlbF91bmNvcmVfc2FuaXRpemUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ICAgdm9pZCBpbnRlbF91bmNvcmVfaW5p
dF9lYXJseShzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUpOwo+ICAgaW50IGludGVsX3VuY29y
ZV9pbml0X21taW8oc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlKTsKPiAgIHZvaWQgaW50ZWxf
dW5jb3JlX3BydW5lX21taW9fZG9tYWlucyhzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUpOwo+
IEBAIC0zNjEsNyArMzYxLDcgQEAgaW50ZWxfdW5jb3JlX3JlYWQ2NF8yeDMyKHN0cnVjdCBpbnRl
bF91bmNvcmUgKnVuY29yZSwKPiAgICAqCj4gICAgKiBDZXJ0YWluIGFyY2hpdGVjdHVyZXMgd2ls
bCBkaWUgaWYgdGhlIHNhbWUgY2FjaGVsaW5lIGlzIGNvbmN1cnJlbnRseSBhY2Nlc3NlZAo+ICAg
ICogYnkgZGlmZmVyZW50IGNsaWVudHMgKGUuZy4gb24gSXZ5YnJpZGdlKS4gQWNjZXNzIHRvIHJl
Z2lzdGVycyBzaG91bGQKPiAtICogdGhlcmVmb3JlIGdlbmVyYWxseSBiZSBzZXJpYWxpc2VkLCBi
eSBlaXRoZXIgdGhlIGRldl9wcml2LT51bmNvcmUubG9jayBvcgo+ICsgKiB0aGVyZWZvcmUgZ2Vu
ZXJhbGx5IGJlIHNlcmlhbGlzZWQsIGJ5IGVpdGhlciB0aGUgaTkxNS0+dW5jb3JlLmxvY2sgb3IK
PiAgICAqIGEgbW9yZSBsb2NhbGlzZWQgbG9jayBndWFyZGluZyBhbGwgYWNjZXNzIHRvIHRoYXQg
YmFuayBvZiByZWdpc3RlcnMuCj4gICAgKi8KPiAgICNkZWZpbmUgaW50ZWxfdW5jb3JlX3JlYWRf
ZncoLi4uKSBfX3Jhd191bmNvcmVfcmVhZDMyKF9fVkFfQVJHU19fKQo+IGRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF92YnRfZGVmcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfdmJ0X2RlZnMuaAo+IGluZGV4IDg5ZWYxNGNhZmI2Yi4uZTJlOTg4M2Q2YjI4IDEw
MDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3ZidF9kZWZzLmgKPiArKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF92YnRfZGVmcy5oCj4gQEAgLTMzNyw3ICszMzcs
NyBAQCBlbnVtIHZidF9nbWJ1c19kZGkgewo+ICAgICogYmFzaWNhbGx5IGFueSBvZiB0aGUgZmll
bGRzIHRvIGVuc3VyZSB0aGUgY29ycmVjdCBpbnRlcnByZXRhdGlvbiBmb3IgdGhlIEJEQgo+ICAg
ICogdmVyc2lvbiBpbiBxdWVzdGlvbi4KPiAgICAqCj4gLSAqIFdoZW4gd2UgY29weSB0aGUgY2hp
bGQgZGV2aWNlIGNvbmZpZ3MgdG8gZGV2X3ByaXYtPnZidC5jaGlsZF9kZXYsIHdlIHJlc2VydmUK
PiArICogV2hlbiB3ZSBjb3B5IHRoZSBjaGlsZCBkZXZpY2UgY29uZmlncyB0byBpOTE1LT52YnQu
Y2hpbGRfZGV2LCB3ZSByZXNlcnZlCj4gICAgKiBzcGFjZSBmb3IgdGhlIGZ1bGwgc3RydWN0dXJl
IGJlbG93LCBhbmQgaW5pdGlhbGl6ZSB0aGUgdGFpbCBub3QgYWN0dWFsbHkKPiAgICAqIHByZXNl
bnQgaW4gVkJUIHRvIHplcm9zLiBBY2Nlc3NpbmcgdGhvc2UgZmllbGRzIGlzIGZpbmUsIGFzIGxv
bmcgYXMgdGhlCj4gICAgKiBkZWZhdWx0IHplcm8gaXMgdGFrZW4gaW50byBhY2NvdW50LCBhZ2Fp
biBhY2NvcmRpbmcgdG8gdGhlIEJEQiB2ZXJzaW9uLgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF92ZHNjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF92ZHNj
LmMKPiBpbmRleCBmZmVjODA3Yjg5NjAuLjE2NGZkNGI1NjExMiAxMDA2NDQKPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF92ZHNjLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF92ZHNjLmMKPiBAQCAtNDc4LDcgKzQ3OCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2Nv
bmZpZ3VyZV9wcHNfZm9yX2RzY19lbmNvZGVyKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ICAgCQkJCQkJY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4g
ICB7Cj4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3Rh
dGUtPmJhc2UuY3J0Yyk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJY29uc3Qgc3RydWN0IGRybV9k
c2NfY29uZmlnICp2ZHNjX2NmZyA9ICZjcnRjX3N0YXRlLT5kcF9kc2NfY2ZnOwo+ICAgCWVudW0g
cGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgIAllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29k
ZXIgPSBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcjsKPiBAQCAtODk3LDcgKzg5Nyw3IEBAIHZv
aWQgaW50ZWxfZHNjX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJ
ICAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4g
ICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJh
c2UuY3J0Yyk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5w
aXBlOwo+ICAgCWk5MTVfcmVnX3QgZHNzX2N0bDFfcmVnLCBkc3NfY3RsMl9yZWc7Cj4gICAJdTMy
IGRzc19jdGwxX3ZhbCA9IDA7Cj4gQEAgLTkwNyw3ICs5MDcsNyBAQCB2b2lkIGludGVsX2RzY19l
bmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCXJldHVybjsKPiAgIAo+
ICAgCS8qIEVuYWJsZSBQb3dlciB3ZWxscyBmb3IgVkRTQy9qb2luaW5nICovCj4gLQlpbnRlbF9k
aXNwbGF5X3Bvd2VyX2dldChkZXZfcHJpdiwKPiArCWludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGk5
MTUsCj4gICAJCQkJaW50ZWxfZHNjX3Bvd2VyX2RvbWFpbihjcnRjX3N0YXRlKSk7Cj4gICAKPiAg
IAlpbnRlbF9jb25maWd1cmVfcHBzX2Zvcl9kc2NfZW5jb2RlcihlbmNvZGVyLCBjcnRjX3N0YXRl
KTsKPiBAQCAtOTMzLDcgKzkzMyw3IEBAIHZvaWQgaW50ZWxfZHNjX2VuYWJsZShzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIHZvaWQgaW50ZWxfZHNjX2Rpc2FibGUoY29uc3Qgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlKQo+ICAgewo+ICAgCXN0cnVjdCBp
bnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhvbGRfY3J0Y19zdGF0ZS0+YmFzZS5jcnRj
KTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+
YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNy
dGMtPmJhc2UuZGV2KTsKPiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gICAJaTkx
NV9yZWdfdCBkc3NfY3RsMV9yZWcsIGRzc19jdGwyX3JlZzsKPiAgIAl1MzIgZHNzX2N0bDFfdmFs
ID0gMCwgZHNzX2N0bDJfdmFsID0gMDsKPiBAQCAtOTYxLDYgKzk2MSw2IEBAIHZvaWQgaW50ZWxf
ZHNjX2Rpc2FibGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRl
KQo+ICAgCUk5MTVfV1JJVEUoZHNzX2N0bDJfcmVnLCBkc3NfY3RsMl92YWwpOwo+ICAgCj4gICAJ
LyogRGlzYWJsZSBQb3dlciB3ZWxscyBmb3IgVkRTQy9qb2luaW5nICovCj4gLQlpbnRlbF9kaXNw
bGF5X3Bvd2VyX3B1dF91bmNoZWNrZWQoZGV2X3ByaXYsCj4gKwlpbnRlbF9kaXNwbGF5X3Bvd2Vy
X3B1dF91bmNoZWNrZWQoaTkxNSwKPiAgIAkJCQkJICBpbnRlbF9kc2NfcG93ZXJfZG9tYWluKG9s
ZF9jcnRjX3N0YXRlKSk7Cj4gICB9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX3dvcGNtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF93b3BjbS5jCj4gaW5k
ZXggN2I0YmE4NGI5ZmI4Li42NDY1NDBiOTcyNjcgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfd29wY20uYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X3dvcGNtLmMKPiBAQCAtMjI1LDcgKzIyNSw3IEBAIGludCBpbnRlbF93b3BjbV9pbml0KHN0cnVj
dCBpbnRlbF93b3BjbSAqd29wY20pCj4gICAJcmV0dXJuIDA7Cj4gICB9Cj4gICAKPiAtc3RhdGlj
IGlubGluZSBpbnQgd3JpdGVfYW5kX3ZlcmlmeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gK3N0YXRpYyBpbmxpbmUgaW50IHdyaXRlX2FuZF92ZXJpZnkoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJICAgaTkxNV9yZWdfdCByZWcsIHUzMiB2YWwsIHUz
MiBtYXNrLAo+ICAgCQkJCSAgIHUzMiBsb2NrZWRfYml0KQo+ICAgewo+IEBAIC0yNTIsMjcgKzI1
MiwyNyBAQCBzdGF0aWMgaW5saW5lIGludCB3cml0ZV9hbmRfdmVyaWZ5KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiAgICAqLwo+ICAgaW50IGludGVsX3dvcGNtX2luaXRfaHco
c3RydWN0IGludGVsX3dvcGNtICp3b3BjbSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHdvcGNtX3RvX2k5MTUod29wY20pOwo+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB3b3BjbV90b19pOTE1KHdvcGNtKTsKPiAgIAl1MzIgaHVjX2FnZW50
Owo+ICAgCXUzMiBtYXNrOwo+ICAgCWludCBlcnI7Cj4gICAKPiAtCWlmICghVVNFU19HVUMoZGV2
X3ByaXYpKQo+ICsJaWYgKCFVU0VTX0dVQyhpOTE1KSkKPiAgIAkJcmV0dXJuIDA7Cj4gICAKPiAt
CUdFTV9CVUdfT04oIUhBU19HVUMoZGV2X3ByaXYpKTsKPiArCUdFTV9CVUdfT04oIUhBU19HVUMo
aTkxNSkpOwo+ICAgCUdFTV9CVUdfT04oIXdvcGNtLT5ndWMuc2l6ZSk7Cj4gICAJR0VNX0JVR19P
Tighd29wY20tPmd1Yy5iYXNlKTsKPiAgIAo+IC0JZXJyID0gd3JpdGVfYW5kX3ZlcmlmeShkZXZf
cHJpdiwgR1VDX1dPUENNX1NJWkUsIHdvcGNtLT5ndWMuc2l6ZSwKPiArCWVyciA9IHdyaXRlX2Fu
ZF92ZXJpZnkoaTkxNSwgR1VDX1dPUENNX1NJWkUsIHdvcGNtLT5ndWMuc2l6ZSwKPiAgIAkJCSAg
ICAgICBHVUNfV09QQ01fU0laRV9NQVNLIHwgR1VDX1dPUENNX1NJWkVfTE9DS0VELAo+ICAgCQkJ
ICAgICAgIEdVQ19XT1BDTV9TSVpFX0xPQ0tFRCk7Cj4gICAJaWYgKGVycikKPiAgIAkJZ290byBl
cnJfb3V0Owo+ICAgCj4gLQlodWNfYWdlbnQgPSBVU0VTX0hVQyhkZXZfcHJpdikgPyBIVUNfTE9B
RElOR19BR0VOVF9HVUMgOiAwOwo+ICsJaHVjX2FnZW50ID0gVVNFU19IVUMoaTkxNSkgPyBIVUNf
TE9BRElOR19BR0VOVF9HVUMgOiAwOwo+ICAgCW1hc2sgPSBHVUNfV09QQ01fT0ZGU0VUX01BU0sg
fCBHVUNfV09QQ01fT0ZGU0VUX1ZBTElEIHwgaHVjX2FnZW50Owo+IC0JZXJyID0gd3JpdGVfYW5k
X3ZlcmlmeShkZXZfcHJpdiwgRE1BX0dVQ19XT1BDTV9PRkZTRVQsCj4gKwllcnIgPSB3cml0ZV9h
bmRfdmVyaWZ5KGk5MTUsIERNQV9HVUNfV09QQ01fT0ZGU0VULAo+ICAgCQkJICAgICAgIHdvcGNt
LT5ndWMuYmFzZSB8IGh1Y19hZ2VudCwgbWFzaywKPiAgIAkJCSAgICAgICBHVUNfV09QQ01fT0ZG
U0VUX1ZBTElEKTsKPiAgIAlpZiAoZXJyKQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZ3R0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxm
dGVzdHMvaTkxNV9nZW1fZ3R0LmMKPiBpbmRleCAyMDkzZDA4YTc1NjkuLjI1MTQ4NDIyMzZmNiAx
MDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZ3R0
LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZ3R0LmMK
PiBAQCAtMTQ3LDE3ICsxNDcsMTcgQEAgZmFrZV9kbWFfb2JqZWN0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LCB1NjQgc2l6ZSkKPiAgIAo+ICAgc3RhdGljIGludCBpZ3RfcHBndHRfYWxs
b2Modm9pZCAqYXJnKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gYXJnOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBhcmc7Cj4gICAJc3Ry
dWN0IGk5MTVfcHBndHQgKnBwZ3R0Owo+ICAgCXU2NCBzaXplLCBsYXN0LCBsaW1pdDsKPiAgIAlp
bnQgZXJyID0gMDsKPiAgIAo+ICAgCS8qIEFsbG9jYXRlIGEgcHBnZ3QgYW5kIHRyeSB0byBmaWxs
IHRoZSBlbnRpcmUgcmFuZ2UgKi8KPiAgIAo+IC0JaWYgKCFIQVNfUFBHVFQoZGV2X3ByaXYpKQo+
ICsJaWYgKCFIQVNfUFBHVFQoaTkxNSkpCj4gICAJCXJldHVybiAwOwo+ICAgCj4gLQlwcGd0dCA9
IF9fcHBndHRfY3JlYXRlKGRldl9wcml2KTsKPiArCXBwZ3R0ID0gX19wcGd0dF9jcmVhdGUoaTkx
NSk7Cj4gICAJaWYgKElTX0VSUihwcGd0dCkpCj4gICAJCXJldHVybiBQVFJfRVJSKHBwZ3R0KTsK
PiAgIAo+IEBAIC0yMDgsOSArMjA4LDkgQEAgc3RhdGljIGludCBpZ3RfcHBndHRfYWxsb2Modm9p
ZCAqYXJnKQo+ICAgCX0KPiAgIAo+ICAgZXJyX3BwZ3R0X2NsZWFudXA6Cj4gLQltdXRleF9sb2Nr
KCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gKwltdXRleF9sb2NrKCZpOTE1LT5kcm0u
c3RydWN0X211dGV4KTsKPiAgIAlpOTE1X3ZtX3B1dCgmcHBndHQtPnZtKTsKPiAtCW11dGV4X3Vu
bG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1
LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAlyZXR1cm4gZXJyOwo+ICAgfQo+ICAgCj4gQEAgLTk5
Miw3ICs5OTIsNyBAQCBzdGF0aWMgaW50IHNocmlua19ib29tKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAo+ICAgCXJldHVybiBlcnI7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGludCBleGVy
Y2lzZV9wcGd0dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyBp
bnQgZXhlcmNpc2VfcHBndHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkg
IGludCAoKmZ1bmMpKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJCSAgICAg
IHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtLAo+ICAgCQkJCSAgICAgIHU2NCBob2xlX3N0
YXJ0LCB1NjQgaG9sZV9lbmQsCj4gQEAgLTEwMDMsMTUgKzEwMDMsMTUgQEAgc3RhdGljIGludCBl
eGVyY2lzZV9wcGd0dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJSUdU
X1RJTUVPVVQoZW5kX3RpbWUpOwo+ICAgCWludCBlcnI7Cj4gICAKPiAtCWlmICghSEFTX0ZVTExf
UFBHVFQoZGV2X3ByaXYpKQo+ICsJaWYgKCFIQVNfRlVMTF9QUEdUVChpOTE1KSkKPiAgIAkJcmV0
dXJuIDA7Cj4gICAKPiAtCWZpbGUgPSBtb2NrX2ZpbGUoZGV2X3ByaXYpOwo+ICsJZmlsZSA9IG1v
Y2tfZmlsZShpOTE1KTsKPiAgIAlpZiAoSVNfRVJSKGZpbGUpKQo+ICAgCQlyZXR1cm4gUFRSX0VS
UihmaWxlKTsKPiAgIAo+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgp
Owo+IC0JcHBndHQgPSBpOTE1X3BwZ3R0X2NyZWF0ZShkZXZfcHJpdik7Cj4gKwltdXRleF9sb2Nr
KCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiArCXBwZ3R0ID0gaTkxNV9wcGd0dF9jcmVhdGUo
aTkxNSk7Cj4gICAJaWYgKElTX0VSUihwcGd0dCkpIHsKPiAgIAkJZXJyID0gUFRSX0VSUihwcGd0
dCk7Cj4gICAJCWdvdG8gb3V0X3VubG9jazsKPiBAQCAtMTAxOSwxMyArMTAxOSwxMyBAQCBzdGF0
aWMgaW50IGV4ZXJjaXNlX3BwZ3R0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiAgIAlHRU1fQlVHX09OKG9mZnNldF9pbl9wYWdlKHBwZ3R0LT52bS50b3RhbCkpOwo+ICAgCUdF
TV9CVUdfT04ocHBndHQtPnZtLmNsb3NlZCk7Cj4gICAKPiAtCWVyciA9IGZ1bmMoZGV2X3ByaXYs
ICZwcGd0dC0+dm0sIDAsIHBwZ3R0LT52bS50b3RhbCwgZW5kX3RpbWUpOwo+ICsJZXJyID0gZnVu
YyhpOTE1LCAmcHBndHQtPnZtLCAwLCBwcGd0dC0+dm0udG90YWwsIGVuZF90aW1lKTsKPiAgIAo+
ICAgCWk5MTVfdm1fcHV0KCZwcGd0dC0+dm0pOwo+ICAgb3V0X3VubG9jazoKPiAtCW11dGV4X3Vu
bG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1
LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAo+IC0JbW9ja19maWxlX2ZyZWUoZGV2X3ByaXYsIGZp
bGUpOwo+ICsJbW9ja19maWxlX2ZyZWUoaTkxNSwgZmlsZSk7Cj4gICAJcmV0dXJuIGVycjsKPiAg
IH0KPiAgIAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaW50
ZWxfZ3VjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaW50ZWxfZ3VjLmMKPiBp
bmRleCA3ZmQwMzIxZTA5NDcuLmFiM2U3MWM5NTdkZiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9zZWxmdGVzdHMvaW50ZWxfZ3VjLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9zZWxmdGVzdHMvaW50ZWxfZ3VjLmMKPiBAQCAtMTA3LDEyICsxMDcsMTIgQEAgc3RhdGlj
IGludCB2YWxpZGF0ZV9jbGllbnQoc3RydWN0IGludGVsX2d1Y19jbGllbnQgKmNsaWVudCwKPiAg
IAkJCSAgIGludCBjbGllbnRfcHJpb3JpdHksCj4gICAJCQkgICBib29sIGlzX3ByZWVtcHRfY2xp
ZW50KQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZ3VjX3Rv
X2k5MTUoY2xpZW50LT5ndWMpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBn
dWNfdG9faTkxNShjbGllbnQtPmd1Yyk7Cj4gICAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0
eF9vd25lciA9IGlzX3ByZWVtcHRfY2xpZW50ID8KPiAtCQkJZGV2X3ByaXYtPnByZWVtcHRfY29u
dGV4dCA6IGRldl9wcml2LT5rZXJuZWxfY29udGV4dDsKPiArCQkJaTkxNS0+cHJlZW1wdF9jb250
ZXh0IDogaTkxNS0+a2VybmVsX2NvbnRleHQ7Cj4gICAKPiAgIAlpZiAoY2xpZW50LT5vd25lciAh
PSBjdHhfb3duZXIgfHwKPiAtCSAgICBjbGllbnQtPmVuZ2luZXMgIT0gSU5URUxfSU5GTyhkZXZf
cHJpdiktPmVuZ2luZV9tYXNrIHx8Cj4gKwkgICAgY2xpZW50LT5lbmdpbmVzICE9IElOVEVMX0lO
Rk8oaTkxNSktPmVuZ2luZV9tYXNrIHx8Cj4gICAJICAgIGNsaWVudC0+cHJpb3JpdHkgIT0gY2xp
ZW50X3ByaW9yaXR5IHx8Cj4gICAJICAgIGNsaWVudC0+ZG9vcmJlbGxfaWQgPT0gR1VDX0RPT1JC
RUxMX0lOVkFMSUQpCj4gICAJCXJldHVybiAtRUlOVkFMOwo+IEBAIC0xMzcsMTYgKzEzNywxNiBA
QCBzdGF0aWMgYm9vbCBjbGllbnRfZG9vcmJlbGxfaW5fc3luYyhzdHJ1Y3QgaW50ZWxfZ3VjX2Ns
aWVudCAqY2xpZW50KQo+ICAgICovCj4gICBzdGF0aWMgaW50IGlndF9ndWNfY2xpZW50cyh2b2lk
ICphcmdzKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gYXJn
czsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYXJnczsKPiAgIAlpbnRlbF93
YWtlcmVmX3Qgd2FrZXJlZjsKPiAgIAlzdHJ1Y3QgaW50ZWxfZ3VjICpndWM7Cj4gICAJaW50IGVy
ciA9IDA7Cj4gICAKPiAtCUdFTV9CVUdfT04oIUhBU19HVUMoZGV2X3ByaXYpKTsKPiAtCW11dGV4
X2xvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiAtCXdha2VyZWYgPSBpbnRlbF9y
dW50aW1lX3BtX2dldChkZXZfcHJpdik7Cj4gKwlHRU1fQlVHX09OKCFIQVNfR1VDKGk5MTUpKTsK
PiArCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJd2FrZXJlZiA9IGlu
dGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOwo+ICAgCj4gLQlndWMgPSAmZGV2X3ByaXYtPmd1YzsK
PiArCWd1YyA9ICZpOTE1LT5ndWM7Cj4gICAJaWYgKCFndWMpIHsKPiAgIAkJcHJfZXJyKCJObyBn
dWMgb2JqZWN0IVxuIik7Cj4gICAJCWVyciA9IC1FSU5WQUw7Cj4gQEAgLTIyNyw4ICsyMjcsOCBA
QCBzdGF0aWMgaW50IGlndF9ndWNfY2xpZW50cyh2b2lkICphcmdzKQo+ICAgCWd1Y19jbGllbnRz
X2NyZWF0ZShndWMpOwo+ICAgCWd1Y19jbGllbnRzX2VuYWJsZShndWMpOwo+ICAgdW5sb2NrOgo+
IC0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOwo+IC0JbXV0ZXhfdW5s
b2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gKwlpbnRlbF9ydW50aW1lX3BtX3B1
dChpOTE1LCB3YWtlcmVmKTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRl
eCk7Cj4gICAJcmV0dXJuIGVycjsKPiAgIH0KPiAgIAo+IEBAIC0yMzksMTcgKzIzOSwxNyBAQCBz
dGF0aWMgaW50IGlndF9ndWNfY2xpZW50cyh2b2lkICphcmdzKQo+ICAgICovCj4gICBzdGF0aWMg
aW50IGlndF9ndWNfZG9vcmJlbGxzKHZvaWQgKmFyZykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IGFyZzsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gYXJnOwo+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICAgCXN0cnVjdCBpbnRl
bF9ndWMgKmd1YzsKPiAgIAlpbnQgaSwgZXJyID0gMDsKPiAgIAl1MTYgZGJfaWQ7Cj4gICAKPiAt
CUdFTV9CVUdfT04oIUhBU19HVUMoZGV2X3ByaXYpKTsKPiAtCW11dGV4X2xvY2soJmRldl9wcml2
LT5kcm0uc3RydWN0X211dGV4KTsKPiAtCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChk
ZXZfcHJpdik7Cj4gKwlHRU1fQlVHX09OKCFIQVNfR1VDKGk5MTUpKTsKPiArCW11dGV4X2xvY2so
Jmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1f
Z2V0KGk5MTUpOwo+ICAgCj4gLQlndWMgPSAmZGV2X3ByaXYtPmd1YzsKPiArCWd1YyA9ICZpOTE1
LT5ndWM7Cj4gICAJaWYgKCFndWMpIHsKPiAgIAkJcHJfZXJyKCJObyBndWMgb2JqZWN0IVxuIik7
Cj4gICAJCWVyciA9IC1FSU5WQUw7Cj4gQEAgLTI2MSwxMCArMjYxLDEwIEBAIHN0YXRpYyBpbnQg
aWd0X2d1Y19kb29yYmVsbHModm9pZCAqYXJnKQo+ICAgCQlnb3RvIHVubG9jazsKPiAgIAo+ICAg
CWZvciAoaSA9IDA7IGkgPCBBVFRFTVBUUzsgaSsrKSB7Cj4gLQkJY2xpZW50c1tpXSA9IGd1Y19j
bGllbnRfYWxsb2MoZGV2X3ByaXYsCj4gLQkJCQkJICAgICAgSU5URUxfSU5GTyhkZXZfcHJpdikt
PmVuZ2luZV9tYXNrLAo+ICsJCWNsaWVudHNbaV0gPSBndWNfY2xpZW50X2FsbG9jKGk5MTUsCj4g
KwkJCQkJICAgICAgSU5URUxfSU5GTyhpOTE1KS0+ZW5naW5lX21hc2ssCj4gICAJCQkJCSAgICAg
IGkgJSBHVUNfQ0xJRU5UX1BSSU9SSVRZX05VTSwKPiAtCQkJCQkgICAgICBkZXZfcHJpdi0+a2Vy
bmVsX2NvbnRleHQpOwo+ICsJCQkJCSAgICAgIGk5MTUtPmtlcm5lbF9jb250ZXh0KTsKPiAgIAo+
ICAgCQlpZiAoIWNsaWVudHNbaV0pIHsKPiAgIAkJCXByX2VycigiWyVkXSBObyBndWMgY2xpZW50
XG4iLCBpKTsKPiBAQCAtMzQwLDIwICszNDAsMjAgQEAgc3RhdGljIGludCBpZ3RfZ3VjX2Rvb3Ji
ZWxscyh2b2lkICphcmcpCj4gICAJCQlndWNfY2xpZW50X2ZyZWUoY2xpZW50c1tpXSk7Cj4gICAJ
CX0KPiAgIHVubG9jazoKPiAtCWludGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVm
KTsKPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJaW50
ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7Cj4gKwltdXRleF91bmxvY2soJmk5MTUt
PmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCXJldHVybiBlcnI7Cj4gICB9Cj4gICAKPiAtaW50IGlu
dGVsX2d1Y19saXZlX3NlbGZ0ZXN0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiAraW50IGludGVsX2d1Y19saXZlX3NlbGZ0ZXN0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ICAgewo+ICAgCXN0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9zdWJ0ZXN0IHRlc3RzW10g
PSB7Cj4gICAJCVNVQlRFU1QoaWd0X2d1Y19jbGllbnRzKSwKPiAgIAkJU1VCVEVTVChpZ3RfZ3Vj
X2Rvb3JiZWxscyksCj4gICAJfTsKPiAgIAo+IC0JaWYgKCFVU0VTX0dVQ19TVUJNSVNTSU9OKGRl
dl9wcml2KSkKPiArCWlmICghVVNFU19HVUNfU1VCTUlTU0lPTihpOTE1KSkKPiAgIAkJcmV0dXJu
IDA7Cj4gICAKPiAtCXJldHVybiBpOTE1X3N1YnRlc3RzKHRlc3RzLCBkZXZfcHJpdik7Cj4gKwly
ZXR1cm4gaTkxNV9zdWJ0ZXN0cyh0ZXN0cywgaTkxNSk7Cj4gICB9Cj4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pbnRlbF91bmNvcmUuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L3NlbGZ0ZXN0cy9pbnRlbF91bmNvcmUuYwo+IGluZGV4IGUwZDdlYmVjYjIxNS4u
YjUzMDRjZmVkYTIxIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0
cy9pbnRlbF91bmNvcmUuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9p
bnRlbF91bmNvcmUuYwo+IEBAIC0yNTQsMTUgKzI1NCwxNSBAQCBzdGF0aWMgaW50IGxpdmVfZm9y
Y2V3YWtlX29wcyh2b2lkICphcmcpCj4gICBzdGF0aWMgaW50IGxpdmVfZm9yY2V3YWtlX2RvbWFp
bnModm9pZCAqYXJnKQo+ICAgewo+ICAgI2RlZmluZSBGV19SQU5HRSAweDQwMDAwCj4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBhcmc7Cj4gLQlzdHJ1Y3QgaW50ZWxfdW5j
b3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gYXJnOwo+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUt
PnVuY29yZTsKPiAgIAl1bnNpZ25lZCBsb25nICp2YWxpZDsKPiAgIAl1MzIgb2Zmc2V0Owo+ICAg
CWludCBlcnI7Cj4gICAKPiAtCWlmICghSEFTX0ZQR0FfREJHX1VOQ0xBSU1FRChkZXZfcHJpdikg
JiYKPiAtCSAgICAhSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgJiYKPiAtCSAgICAhSVNfQ0hFUlJZ
VklFVyhkZXZfcHJpdikpCj4gKwlpZiAoIUhBU19GUEdBX0RCR19VTkNMQUlNRUQoaTkxNSkgJiYK
PiArCSAgICAhSVNfVkFMTEVZVklFVyhpOTE1KSAmJgo+ICsJICAgICFJU19DSEVSUllWSUVXKGk5
MTUpKQo+ICAgCQlyZXR1cm4gMDsKPiAgIAo+ICAgCS8qCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L3Zsdl9kc2kuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3Zsdl9kc2kuYwo+
IGluZGV4IGUyNzJkODI2MjEwYS4uMDE3OGJkZjBjNWE5IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L3Zsdl9kc2kuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3Zsdl9k
c2kuYwo+IEBAIC03OCwxOSArNzgsMTkgQEAgdm9pZCB2bHZfZHNpX3dhaXRfZm9yX2ZpZm9fZW1w
dHkoc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpLCBlbnVtIHBvcnQgcG9ydCkKPiAgIHsKPiAg
IAlzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIgPSAmaW50ZWxfZHNpLT5iYXNlLmJhc2U7Cj4g
ICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGVuY29kZXItPmRldjsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ICAgCXUzMiBtYXNrOwo+ICAgCj4gICAJ
bWFzayA9IExQX0NUUkxfRklGT19FTVBUWSB8IEhTX0NUUkxfRklGT19FTVBUWSB8Cj4gICAJCUxQ
X0RBVEFfRklGT19FTVBUWSB8IEhTX0RBVEFfRklGT19FTVBUWTsKPiAgIAo+IC0JaWYgKGludGVs
X3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLAo+ICsJaWYgKGludGVsX3dhaXRf
Zm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsCj4gICAJCQkJICAgIE1JUElfR0VOX0ZJRk9fU1RB
VChwb3J0KSwgbWFzaywgbWFzaywKPiAgIAkJCQkgICAgMTAwKSkKPiAgIAkJRFJNX0VSUk9SKCJE
UEkgRklGT3MgYXJlIG5vdCBlbXB0eVxuIik7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgd3Jp
dGVfZGF0YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2b2lk
IHdyaXRlX2RhdGEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCSAgICAgICBp
OTE1X3JlZ190IHJlZywKPiAgIAkJICAgICAgIGNvbnN0IHU4ICpkYXRhLCB1MzIgbGVuKQo+ICAg
ewo+IEBAIC0xMDYsNyArMTA2LDcgQEAgc3RhdGljIHZvaWQgd3JpdGVfZGF0YShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gICAJfQo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lk
IHJlYWRfZGF0YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gK3N0YXRpYyB2
b2lkIHJlYWRfZGF0YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJICAgICAg
aTkxNV9yZWdfdCByZWcsCj4gICAJCSAgICAgIHU4ICpkYXRhLCB1MzIgbGVuKQo+ICAgewo+IEBA
IC0xMjUsNyArMTI1LDcgQEAgc3RhdGljIHNzaXplX3QgaW50ZWxfZHNpX2hvc3RfdHJhbnNmZXIo
c3RydWN0IG1pcGlfZHNpX2hvc3QgKmhvc3QsCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2RzaV9o
b3N0ICppbnRlbF9kc2lfaG9zdCA9IHRvX2ludGVsX2RzaV9ob3N0KGhvc3QpOwo+ICAgCXN0cnVj
dCBkcm1fZGV2aWNlICpkZXYgPSBpbnRlbF9kc2lfaG9zdC0+aW50ZWxfZHNpLT5iYXNlLmJhc2Uu
ZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJ
ZW51bSBwb3J0IHBvcnQgPSBpbnRlbF9kc2lfaG9zdC0+cG9ydDsKPiAgIAlzdHJ1Y3QgbWlwaV9k
c2lfcGFja2V0IHBhY2tldDsKPiAgIAlzc2l6ZV90IHJldDsKPiBAQCAtMTU0LDEzICsxNTQsMTMg
QEAgc3RhdGljIHNzaXplX3QgaW50ZWxfZHNpX2hvc3RfdHJhbnNmZXIoc3RydWN0IG1pcGlfZHNp
X2hvc3QgKmhvc3QsCj4gICAKPiAgIAkvKiBub3RlOiB0aGlzIGlzIG5ldmVyIHRydWUgZm9yIHJl
YWRzICovCj4gICAJaWYgKHBhY2tldC5wYXlsb2FkX2xlbmd0aCkgewo+IC0JCWlmIChpbnRlbF93
YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwKPiArCQlpZiAoaW50ZWxfd2FpdF9m
b3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiAgIAkJCQkJICAgIE1JUElfR0VOX0ZJRk9fU1RB
VChwb3J0KSwKPiAgIAkJCQkJICAgIGRhdGFfbWFzaywgMCwKPiAgIAkJCQkJICAgIDUwKSkKPiAg
IAkJCURSTV9FUlJPUigiVGltZW91dCB3YWl0aW5nIGZvciBIUy9MUCBEQVRBIEZJRk8gIWZ1bGxc
biIpOwo+ICAgCj4gLQkJd3JpdGVfZGF0YShkZXZfcHJpdiwgZGF0YV9yZWcsIHBhY2tldC5wYXls
b2FkLAo+ICsJCXdyaXRlX2RhdGEoaTkxNSwgZGF0YV9yZWcsIHBhY2tldC5wYXlsb2FkLAo+ICAg
CQkJICAgcGFja2V0LnBheWxvYWRfbGVuZ3RoKTsKPiAgIAl9Cj4gICAKPiBAQCAtMTY4LDcgKzE2
OCw3IEBAIHN0YXRpYyBzc2l6ZV90IGludGVsX2RzaV9ob3N0X3RyYW5zZmVyKHN0cnVjdCBtaXBp
X2RzaV9ob3N0ICpob3N0LAo+ICAgCQlJOTE1X1dSSVRFKE1JUElfSU5UUl9TVEFUKHBvcnQpLCBH
RU5fUkVBRF9EQVRBX0FWQUlMKTsKPiAgIAl9Cj4gICAKPiAtCWlmIChpbnRlbF93YWl0X2Zvcl9y
ZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwKPiArCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3Rl
cigmaTkxNS0+dW5jb3JlLAo+ICAgCQkJCSAgICBNSVBJX0dFTl9GSUZPX1NUQVQocG9ydCksCj4g
ICAJCQkJICAgIGN0cmxfbWFzaywgMCwKPiAgIAkJCQkgICAgNTApKSB7Cj4gQEAgLTE4MCwxMyAr
MTgwLDEzIEBAIHN0YXRpYyBzc2l6ZV90IGludGVsX2RzaV9ob3N0X3RyYW5zZmVyKHN0cnVjdCBt
aXBpX2RzaV9ob3N0ICpob3N0LAo+ICAgCS8qIC0+cnhfbGVuIGlzIHNldCBvbmx5IGZvciByZWFk
cyAqLwo+ICAgCWlmIChtc2ctPnJ4X2xlbikgewo+ICAgCQlkYXRhX21hc2sgPSBHRU5fUkVBRF9E
QVRBX0FWQUlMOwo+IC0JCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVu
Y29yZSwKPiArCQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiAg
IAkJCQkJICAgIE1JUElfSU5UUl9TVEFUKHBvcnQpLAo+ICAgCQkJCQkgICAgZGF0YV9tYXNrLCBk
YXRhX21hc2ssCj4gICAJCQkJCSAgICA1MCkpCj4gICAJCQlEUk1fRVJST1IoIlRpbWVvdXQgd2Fp
dGluZyBmb3IgcmVhZCBkYXRhLlxuIik7Cj4gICAKPiAtCQlyZWFkX2RhdGEoZGV2X3ByaXYsIGRh
dGFfcmVnLCBtc2ctPnJ4X2J1ZiwgbXNnLT5yeF9sZW4pOwo+ICsJCXJlYWRfZGF0YShpOTE1LCBk
YXRhX3JlZywgbXNnLT5yeF9idWYsIG1zZy0+cnhfbGVuKTsKPiAgIAl9Cj4gICAKPiAgIAkvKiBY
WFg6IGZpeCBmb3IgcmVhZHMgYW5kIHdyaXRlcyAqLwo+IEBAIC0yMjEsNyArMjIxLDcgQEAgc3Rh
dGljIGludCBkcGlfc2VuZF9jbWQoc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpLCB1MzIgY21k
LCBib29sIGhzLAo+ICAgewo+ICAgCXN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlciA9ICZpbnRl
bF9kc2ktPmJhc2UuYmFzZTsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gZW5jb2Rlci0+
ZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJ
dTMyIG1hc2s7Cj4gICAKPiAgIAkvKiBYWFg6IHBpcGUsIGhzICovCj4gQEAgLTI0MCw3ICsyNDAs
NyBAQCBzdGF0aWMgaW50IGRwaV9zZW5kX2NtZChzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2ks
IHUzMiBjbWQsIGJvb2wgaHMsCj4gICAJSTkxNV9XUklURShNSVBJX0RQSV9DT05UUk9MKHBvcnQp
LCBjbWQpOwo+ICAgCj4gICAJbWFzayA9IFNQTF9QS1RfU0VOVF9JTlRFUlJVUFQ7Cj4gLQlpZiAo
aW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gKwlpZiAoaW50ZWxf
d2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiAgIAkJCQkgICAgTUlQSV9JTlRSX1NU
QVQocG9ydCksIG1hc2ssIG1hc2ssCj4gICAJCQkJICAgIDEwMCkpCj4gICAJCURSTV9FUlJPUigi
VmlkZW8gbW9kZSBjb21tYW5kIDB4JTA4eCBzZW5kIGZhaWxlZC5cbiIsIGNtZCk7Cj4gQEAgLTI0
OCwyNSArMjQ4LDI1IEBAIHN0YXRpYyBpbnQgZHBpX3NlbmRfY21kKHN0cnVjdCBpbnRlbF9kc2kg
KmludGVsX2RzaSwgdTMyIGNtZCwgYm9vbCBocywKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+
IC1zdGF0aWMgdm9pZCBiYW5kX2dhcF9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gK3N0YXRpYyB2b2lkIGJhbmRfZ2FwX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ICAgewo+IC0Jdmx2X2ZsaXNkc2lfZ2V0KGRldl9wcml2KTsKPiArCXZsdl9m
bGlzZHNpX2dldChpOTE1KTsKPiAgIAo+IC0Jdmx2X2ZsaXNkc2lfd3JpdGUoZGV2X3ByaXYsIDB4
MDgsIDB4MDAwMSk7Cj4gLQl2bHZfZmxpc2RzaV93cml0ZShkZXZfcHJpdiwgMHgwRiwgMHgwMDA1
KTsKPiAtCXZsdl9mbGlzZHNpX3dyaXRlKGRldl9wcml2LCAweDBGLCAweDAwMjUpOwo+ICsJdmx2
X2ZsaXNkc2lfd3JpdGUoaTkxNSwgMHgwOCwgMHgwMDAxKTsKPiArCXZsdl9mbGlzZHNpX3dyaXRl
KGk5MTUsIDB4MEYsIDB4MDAwNSk7Cj4gKwl2bHZfZmxpc2RzaV93cml0ZShpOTE1LCAweDBGLCAw
eDAwMjUpOwo+ICAgCXVkZWxheSgxNTApOwo+IC0Jdmx2X2ZsaXNkc2lfd3JpdGUoZGV2X3ByaXYs
IDB4MEYsIDB4MDAwMCk7Cj4gLQl2bHZfZmxpc2RzaV93cml0ZShkZXZfcHJpdiwgMHgwOCwgMHgw
MDAwKTsKPiArCXZsdl9mbGlzZHNpX3dyaXRlKGk5MTUsIDB4MEYsIDB4MDAwMCk7Cj4gKwl2bHZf
Zmxpc2RzaV93cml0ZShpOTE1LCAweDA4LCAweDAwMDApOwo+ICAgCj4gLQl2bHZfZmxpc2RzaV9w
dXQoZGV2X3ByaXYpOwo+ICsJdmx2X2ZsaXNkc2lfcHV0KGk5MTUpOwo+ICAgfQo+ICAgCj4gICBz
dGF0aWMgaW50IGludGVsX2RzaV9jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlciwKPiAgIAkJCQkgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmln
LAo+ICAgCQkJCSAgICBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiAg
IHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rl
ci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBj
b250YWluZXJfb2YoZW5jb2Rlciwgc3RydWN0IGludGVsX2RzaSwKPiAgIAkJCQkJCSAgIGJhc2Up
Owo+ICAgCXN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmludGVsX2Nvbm5lY3RvciA9IGludGVsX2Rz
aS0+YXR0YWNoZWRfY29ubmVjdG9yOwo+IEBAIC0yODEsNyArMjgxLDcgQEAgc3RhdGljIGludCBp
bnRlbF9kc2lfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4g
ICAJaWYgKGZpeGVkX21vZGUpIHsKPiAgIAkJaW50ZWxfZml4ZWRfcGFuZWxfbW9kZShmaXhlZF9t
b2RlLCBhZGp1c3RlZF9tb2RlKTsKPiAgIAo+IC0JCWlmIChIQVNfR01DSChkZXZfcHJpdikpCj4g
KwkJaWYgKEhBU19HTUNIKGk5MTUpKQo+ICAgCQkJaW50ZWxfZ21jaF9wYW5lbF9maXR0aW5nKGNy
dGMsIHBpcGVfY29uZmlnLAo+ICAgCQkJCQkJIGNvbm5fc3RhdGUtPnNjYWxpbmdfbW9kZSk7Cj4g
ICAJCWVsc2UKPiBAQCAtMzAwLDcgKzMwMCw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfZHNpX2NvbXB1
dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCWVsc2UKPiAgIAkJ
cGlwZV9jb25maWctPnBpcGVfYnBwID0gMTg7Cj4gICAKPiAtCWlmIChJU19HRU45X0xQKGRldl9w
cml2KSkgewo+ICsJaWYgKElTX0dFTjlfTFAoaTkxNSkpIHsKPiAgIAkJLyogRW5hYmxlIEZyYW1l
IHRpbWUgc3RhbXAgYmFzZWQgc2NhbmxpbmUgcmVwb3J0aW5nICovCj4gICAJCWFkanVzdGVkX21v
ZGUtPnByaXZhdGVfZmxhZ3MgfD0KPiAgIAkJCUk5MTVfTU9ERV9GTEFHX0dFVF9TQ0FOTElORV9G
Uk9NX1RJTUVTVEFNUDsKPiBAQCAtMzI3LDcgKzMyNyw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfZHNp
X2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCj4gICBz
dGF0aWMgYm9vbCBnbGtfZHNpX2VuYWJsZV9pbyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
cikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9k
c2kgPSBlbmNfdG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiAgIAllbnVtIHBvcnQgcG9y
dDsKPiAgIAl1MzIgdG1wOwo+IEBAIC0zNTksNyArMzU5LDcgQEAgc3RhdGljIGJvb2wgZ2xrX2Rz
aV9lbmFibGVfaW8oc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICAKPiAgIAkvKiBX
YWl0IGZvciBQd3IgQUNLICovCj4gICAJZm9yX2VhY2hfZHNpX3BvcnQocG9ydCwgaW50ZWxfZHNp
LT5wb3J0cykgewo+IC0JCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVu
Y29yZSwKPiArCQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiAg
IAkJCQkJICAgIE1JUElfQ1RSTChwb3J0KSwKPiAgIAkJCQkJICAgIEdMS19NSVBJSU9fUE9SVF9Q
T1dFUkVELAo+ICAgCQkJCQkgICAgR0xLX01JUElJT19QT1JUX1BPV0VSRUQsCj4gQEAgLTM3OCwx
NCArMzc4LDE0IEBAIHN0YXRpYyBib29sIGdsa19kc2lfZW5hYmxlX2lvKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyKQo+ICAgCj4gICBzdGF0aWMgdm9pZCBnbGtfZHNpX2RldmljZV9yZWFk
eShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsK
PiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBlbmNfdG9faW50ZWxfZHNpKCZlbmNv
ZGVyLT5iYXNlKTsKPiAgIAllbnVtIHBvcnQgcG9ydDsKPiAgIAl1MzIgdmFsOwo+ICAgCj4gICAJ
LyogV2FpdCBmb3IgTUlQSSBQSFkgc3RhdHVzIGJpdCB0byBzZXQgKi8KPiAgIAlmb3JfZWFjaF9k
c2lfcG9ydChwb3J0LCBpbnRlbF9kc2ktPnBvcnRzKSB7Cj4gLQkJaWYgKGludGVsX3dhaXRfZm9y
X3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLAo+ICsJCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdp
c3RlcigmaTkxNS0+dW5jb3JlLAo+ICAgCQkJCQkgICAgTUlQSV9DVFJMKHBvcnQpLAo+ICAgCQkJ
CQkgICAgR0xLX1BIWV9TVEFUVVNfUE9SVF9SRUFEWSwKPiAgIAkJCQkJICAgIEdMS19QSFlfU1RB
VFVTX1BPUlRfUkVBRFksCj4gQEAgLTQxMyw3ICs0MTMsNyBAQCBzdGF0aWMgdm9pZCBnbGtfZHNp
X2RldmljZV9yZWFkeShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIAkJCUk5MTVf
V1JJVEUoTUlQSV9ERVZJQ0VfUkVBRFkocG9ydCksIHZhbCk7Cj4gICAKPiAgIAkJCS8qIFdhaXQg
Zm9yIFVMUFMgYWN0aXZlICovCj4gLQkJCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2
X3ByaXYtPnVuY29yZSwKPiArCQkJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51
bmNvcmUsCj4gICAJCQkJCQkgICAgTUlQSV9DVFJMKHBvcnQpLAo+ICAgCQkJCQkJICAgIEdMS19V
TFBTX05PVF9BQ1RJVkUsCj4gICAJCQkJCQkgICAgMCwKPiBAQCAtNDQwLDcgKzQ0MCw3IEBAIHN0
YXRpYyB2b2lkIGdsa19kc2lfZGV2aWNlX3JlYWR5KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyKQo+ICAgCj4gICAJLyogV2FpdCBmb3IgU3RvcCBzdGF0ZSAqLwo+ICAgCWZvcl9lYWNoX2Rz
aV9wb3J0KHBvcnQsIGludGVsX2RzaS0+cG9ydHMpIHsKPiAtCQlpZiAoaW50ZWxfd2FpdF9mb3Jf
cmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gKwkJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lz
dGVyKCZpOTE1LT51bmNvcmUsCj4gICAJCQkJCSAgICBNSVBJX0NUUkwocG9ydCksCj4gICAJCQkJ
CSAgICBHTEtfREFUQV9MQU5FX1NUT1BfU1RBVEUsCj4gICAJCQkJCSAgICBHTEtfREFUQV9MQU5F
X1NUT1BfU1RBVEUsCj4gQEAgLTQ1MCw3ICs0NTAsNyBAQCBzdGF0aWMgdm9pZCBnbGtfZHNpX2Rl
dmljZV9yZWFkeShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIAo+ICAgCS8qIFdh
aXQgZm9yIEFGRSBMQVRDSCAqLwo+ICAgCWZvcl9lYWNoX2RzaV9wb3J0KHBvcnQsIGludGVsX2Rz
aS0+cG9ydHMpIHsKPiAtCQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51
bmNvcmUsCj4gKwkJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsCj4g
ICAJCQkJCSAgICBCWFRfTUlQSV9QT1JUX0NUUkwocG9ydCksCj4gICAJCQkJCSAgICBBRkVfTEFU
Q0hPVVQsCj4gICAJCQkJCSAgICBBRkVfTEFUQ0hPVVQsCj4gQEAgLTQ2MSw3ICs0NjEsNyBAQCBz
dGF0aWMgdm9pZCBnbGtfZHNpX2RldmljZV9yZWFkeShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlcikKPiAgIAo+ICAgc3RhdGljIHZvaWQgYnh0X2RzaV9kZXZpY2VfcmVhZHkoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0
IGludGVsX2RzaSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7
Cj4gICAJZW51bSBwb3J0IHBvcnQ7Cj4gICAJdTMyIHZhbDsKPiBAQCAtNDg4LDIxICs0ODgsMjEg
QEAgc3RhdGljIHZvaWQgYnh0X2RzaV9kZXZpY2VfcmVhZHkoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIpCj4gICAKPiAgIHN0YXRpYyB2b2lkIHZsdl9kc2lfZGV2aWNlX3JlYWR5KHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXN0
cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGVuY190b19pbnRlbF9kc2koJmVuY29kZXItPmJh
c2UpOwo+ICAgCWVudW0gcG9ydCBwb3J0Owo+ICAgCXUzMiB2YWw7Cj4gICAKPiAgIAlEUk1fREVC
VUdfS01TKCJcbiIpOwo+ICAgCj4gLQl2bHZfZmxpc2RzaV9nZXQoZGV2X3ByaXYpOwo+ICsJdmx2
X2ZsaXNkc2lfZ2V0KGk5MTUpOwo+ICAgCS8qIHByb2dyYW0gcmNvbXAgZm9yIGNvbXBsaWFuY2Us
IHJlZHVjZSBmcm9tIDUwIG9obXMgdG8gNDUgb2htcwo+ICAgCSAqIG5lZWRlZCBldmVyeXRpbWUg
YWZ0ZXIgcG93ZXIgZ2F0ZSAqLwo+IC0Jdmx2X2ZsaXNkc2lfd3JpdGUoZGV2X3ByaXYsIDB4MDQs
IDB4MDAwNCk7Cj4gLQl2bHZfZmxpc2RzaV9wdXQoZGV2X3ByaXYpOwo+ICsJdmx2X2ZsaXNkc2lf
d3JpdGUoaTkxNSwgMHgwNCwgMHgwMDA0KTsKPiArCXZsdl9mbGlzZHNpX3B1dChpOTE1KTsKPiAg
IAo+ICAgCS8qIGJhbmRnYXAgcmVzZXQgaXMgbmVlZGVkIGFmdGVyIGV2ZXJ5dGltZSB3ZSBkbyBw
b3dlciBnYXRlICovCj4gLQliYW5kX2dhcF9yZXNldChkZXZfcHJpdik7Cj4gKwliYW5kX2dhcF9y
ZXNldChpOTE1KTsKPiAgIAo+ICAgCWZvcl9lYWNoX2RzaV9wb3J0KHBvcnQsIGludGVsX2RzaS0+
cG9ydHMpIHsKPiAgIAo+IEBAIC01MjcsMTEgKzUyNywxMSBAQCBzdGF0aWMgdm9pZCB2bHZfZHNp
X2RldmljZV9yZWFkeShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIAo+ICAgc3Rh
dGljIHZvaWQgaW50ZWxfZHNpX2RldmljZV9yZWFkeShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlcikKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAo+IC0JaWYgKElTX0dFTUlOSUxBS0Uo
ZGV2X3ByaXYpKQo+ICsJaWYgKElTX0dFTUlOSUxBS0UoaTkxNSkpCj4gICAJCWdsa19kc2lfZGV2
aWNlX3JlYWR5KGVuY29kZXIpOwo+IC0JZWxzZSBpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCj4g
KwllbHNlIGlmIChJU19HRU45X0xQKGk5MTUpKQo+ICAgCQlieHRfZHNpX2RldmljZV9yZWFkeShl
bmNvZGVyKTsKPiAgIAllbHNlCj4gICAJCXZsdl9kc2lfZGV2aWNlX3JlYWR5KGVuY29kZXIpOwo+
IEBAIC01MzksNyArNTM5LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHNpX2RldmljZV9yZWFkeShz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIAo+ICAgc3RhdGljIHZvaWQgZ2xrX2Rz
aV9lbnRlcl9sb3dfcG93ZXJfbW9kZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAg
IHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rl
ci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBl
bmNfdG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiAgIAllbnVtIHBvcnQgcG9ydDsKPiAg
IAl1MzIgdmFsOwo+IEBAIC01NTQsNyArNTU0LDcgQEAgc3RhdGljIHZvaWQgZ2xrX2RzaV9lbnRl
cl9sb3dfcG93ZXJfbW9kZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIAo+ICAg
CS8qIFdhaXQgZm9yIE1JUEkgUEhZIHN0YXR1cyBiaXQgdG8gdW5zZXQgKi8KPiAgIAlmb3JfZWFj
aF9kc2lfcG9ydChwb3J0LCBpbnRlbF9kc2ktPnBvcnRzKSB7Cj4gLQkJaWYgKGludGVsX3dhaXRf
Zm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLAo+ICsJCWlmIChpbnRlbF93YWl0X2Zvcl9y
ZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+ICAgCQkJCQkgICAgTUlQSV9DVFJMKHBvcnQpLAo+ICAg
CQkJCQkgICAgR0xLX1BIWV9TVEFUVVNfUE9SVF9SRUFEWSwgMCwgMjApKQo+ICAgCQkJRFJNX0VS
Uk9SKCJQSFkgaXMgbm90IHR1cm5pbmcgT0ZGXG4iKTsKPiBAQCAtNTYyLDcgKzU2Miw3IEBAIHN0
YXRpYyB2b2lkIGdsa19kc2lfZW50ZXJfbG93X3Bvd2VyX21vZGUoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIpCj4gICAKPiAgIAkvKiBXYWl0IGZvciBQd3IgQUNLIGJpdCB0byB1bnNldCAq
Lwo+ICAgCWZvcl9lYWNoX2RzaV9wb3J0KHBvcnQsIGludGVsX2RzaS0+cG9ydHMpIHsKPiAtCQlp
ZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gKwkJaWYgKGlu
dGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsCj4gICAJCQkJCSAgICBNSVBJX0NU
UkwocG9ydCksCj4gICAJCQkJCSAgICBHTEtfTUlQSUlPX1BPUlRfUE9XRVJFRCwgMCwgMjApKQo+
ICAgCQkJRFJNX0VSUk9SKCJNSVBJIElPIFBvcnQgaXMgbm90IHBvd2VyZ2F0ZWRcbiIpOwo+IEBA
IC01NzEsNyArNTcxLDcgQEAgc3RhdGljIHZvaWQgZ2xrX2RzaV9lbnRlcl9sb3dfcG93ZXJfbW9k
ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiAgIAo+ICAgc3RhdGljIHZvaWQgZ2xr
X2RzaV9kaXNhYmxlX21pcGlfaW8oc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICB7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShl
bmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0gZW5j
X3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gICAJZW51bSBwb3J0IHBvcnQ7Cj4gICAJ
dTMyIHRtcDsKPiBAQCAtNTgzLDcgKzU4Myw3IEBAIHN0YXRpYyB2b2lkIGdsa19kc2lfZGlzYWJs
ZV9taXBpX2lvKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ICAgCj4gICAJLyogV2Fp
dCBmb3IgTUlQSSBQSFkgc3RhdHVzIGJpdCB0byB1bnNldCAqLwo+ICAgCWZvcl9lYWNoX2RzaV9w
b3J0KHBvcnQsIGludGVsX2RzaS0+cG9ydHMpIHsKPiAtCQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVn
aXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gKwkJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVy
KCZpOTE1LT51bmNvcmUsCj4gICAJCQkJCSAgICBNSVBJX0NUUkwocG9ydCksCj4gICAJCQkJCSAg
ICBHTEtfUEhZX1NUQVRVU19QT1JUX1JFQURZLCAwLCAyMCkpCj4gICAJCQlEUk1fRVJST1IoIlBI
WSBpcyBub3QgdHVybmluZyBPRkZcbiIpOwo+IEBAIC02MDUsMTQgKzYwNSwxNCBAQCBzdGF0aWMg
dm9pZCBnbGtfZHNpX2NsZWFyX2RldmljZV9yZWFkeShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlcikKPiAgIAo+ICAgc3RhdGljIHZvaWQgdmx2X2RzaV9jbGVhcl9kZXZpY2VfcmVhZHkoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJ
c3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+
YmFzZSk7Cj4gICAJZW51bSBwb3J0IHBvcnQ7Cj4gICAKPiAgIAlEUk1fREVCVUdfS01TKCJcbiIp
Owo+ICAgCWZvcl9lYWNoX2RzaV9wb3J0KHBvcnQsIGludGVsX2RzaS0+cG9ydHMpIHsKPiAgIAkJ
LyogQ29tbW9uIGJpdCBmb3IgYm90aCBNSVBJIFBvcnQgQSAmIE1JUEkgUG9ydCBDIG9uIFZMVi9D
SFYgKi8KPiAtCQlpOTE1X3JlZ190IHBvcnRfY3RybCA9IElTX0dFTjlfTFAoZGV2X3ByaXYpID8K
PiArCQlpOTE1X3JlZ190IHBvcnRfY3RybCA9IElTX0dFTjlfTFAoaTkxNSkgPwo+ICAgCQkJQlhU
X01JUElfUE9SVF9DVFJMKHBvcnQpIDogTUlQSV9QT1JUX0NUUkwoUE9SVF9BKTsKPiAgIAkJdTMy
IHZhbDsKPiAgIAo+IEBAIC02MzIsOCArNjMyLDggQEAgc3RhdGljIHZvaWQgdmx2X2RzaV9jbGVh
cl9kZXZpY2VfcmVhZHkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICAJCSAqIE9u
IFZMVi9DSFYsIHdhaXQgdGlsbCBDbG9jayBsYW5lcyBhcmUgaW4gTFAtMDAgc3RhdGUgZm9yIE1J
UEkKPiAgIAkJICogUG9ydCBBIG9ubHkuIE1JUEkgUG9ydCBDIGhhcyBubyBzaW1pbGFyIGJpdCBm
b3IgY2hlY2tpbmcuCj4gICAJCSAqLwo+IC0JCWlmICgoSVNfR0VOOV9MUChkZXZfcHJpdikgfHwg
cG9ydCA9PSBQT1JUX0EpICYmCj4gLQkJICAgIGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZf
cHJpdi0+dW5jb3JlLAo+ICsJCWlmICgoSVNfR0VOOV9MUChpOTE1KSB8fCBwb3J0ID09IFBPUlRf
QSkgJiYKPiArCQkgICAgaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiAg
IAkJCQkJICAgIHBvcnRfY3RybCwgQUZFX0xBVENIT1VULCAwLAo+ICAgCQkJCQkgICAgMzApKQo+
ICAgCQkJRFJNX0VSUk9SKCJEU0kgTFAgbm90IGdvaW5nIExvd1xuIik7Cj4gQEAgLTY1MSwxNCAr
NjUxLDE0IEBAIHN0YXRpYyB2b2lkIHZsdl9kc2lfY2xlYXJfZGV2aWNlX3JlYWR5KHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ICAgc3RhdGljIHZvaWQgaW50ZWxfZHNpX3BvcnRfZW5h
YmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJCSAgY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4g
ICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJh
c2UuY3J0Yyk7Cj4gICAJc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVs
X2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gICAJZW51bSBwb3J0IHBvcnQ7Cj4gICAKPiAgIAlpZiAo
aW50ZWxfZHNpLT5kdWFsX2xpbmsgPT0gRFNJX0RVQUxfTElOS19GUk9OVF9CQUNLKSB7Cj4gICAJ
CXUzMiB0ZW1wOwo+IC0JCWlmIChJU19HRU45X0xQKGRldl9wcml2KSkgewo+ICsJCWlmIChJU19H
RU45X0xQKGk5MTUpKSB7Cj4gICAJCQlmb3JfZWFjaF9kc2lfcG9ydChwb3J0LCBpbnRlbF9kc2kt
PnBvcnRzKSB7Cj4gICAJCQkJdGVtcCA9IEk5MTVfUkVBRChNSVBJX0NUUkwocG9ydCkpOwo+ICAg
CQkJCXRlbXAgJj0gfkJYVF9QSVhFTF9PVkVSTEFQX0NOVF9NQVNLIHwKPiBAQCAtNjc2LDcgKzY3
Niw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RzaV9wb3J0X2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKPiAgIAl9Cj4gICAKPiAgIAlmb3JfZWFjaF9kc2lfcG9ydChwb3J0LCBp
bnRlbF9kc2ktPnBvcnRzKSB7Cj4gLQkJaTkxNV9yZWdfdCBwb3J0X2N0cmwgPSBJU19HRU45X0xQ
KGRldl9wcml2KSA/Cj4gKwkJaTkxNV9yZWdfdCBwb3J0X2N0cmwgPSBJU19HRU45X0xQKGk5MTUp
ID8KPiAgIAkJCUJYVF9NSVBJX1BPUlRfQ1RSTChwb3J0KSA6IE1JUElfUE9SVF9DVFJMKHBvcnQp
Owo+ICAgCQl1MzIgdGVtcDsKPiAgIAo+IEBAIC02ODgsNyArNjg4LDcgQEAgc3RhdGljIHZvaWQg
aW50ZWxfZHNpX3BvcnRfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAg
CQlpZiAoaW50ZWxfZHNpLT5wb3J0cyA9PSAoQklUKFBPUlRfQSkgfCBCSVQoUE9SVF9DKSkpIHsK
PiAgIAkJCXRlbXAgfD0gKGludGVsX2RzaS0+ZHVhbF9saW5rIC0gMSkKPiAgIAkJCQkJCTw8IERV
QUxfTElOS19NT0RFX1NISUZUOwo+IC0JCQlpZiAoSVNfQlJPWFRPTihkZXZfcHJpdikpCj4gKwkJ
CWlmIChJU19CUk9YVE9OKGk5MTUpKQo+ICAgCQkJCXRlbXAgfD0gTEFORV9DT05GSUdVUkFUSU9O
X0RVQUxfTElOS19BOwo+ICAgCQkJZWxzZQo+ICAgCQkJCXRlbXAgfD0gY3J0Yy0+cGlwZSA/Cj4g
QEAgLTcwOCwxMiArNzA4LDEyIEBAIHN0YXRpYyB2b2lkIGludGVsX2RzaV9wb3J0X2VuYWJsZShz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIHN0YXRpYyB2b2lkIGludGVsX2RzaV9w
b3J0X2Rpc2FibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICB7Cj4gICAJc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiA9IGVuY29kZXItPmJhc2UuZGV2Owo+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJc3RydWN0IGludGVsX2RzaSAqaW50
ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gICAJZW51bSBwb3J0
IHBvcnQ7Cj4gICAKPiAgIAlmb3JfZWFjaF9kc2lfcG9ydChwb3J0LCBpbnRlbF9kc2ktPnBvcnRz
KSB7Cj4gLQkJaTkxNV9yZWdfdCBwb3J0X2N0cmwgPSBJU19HRU45X0xQKGRldl9wcml2KSA/Cj4g
KwkJaTkxNV9yZWdfdCBwb3J0X2N0cmwgPSBJU19HRU45X0xQKGk5MTUpID8KPiAgIAkJCUJYVF9N
SVBJX1BPUlRfQ1RSTChwb3J0KSA6IE1JUElfUE9SVF9DVFJMKHBvcnQpOwo+ICAgCQl1MzIgdGVt
cDsKPiAgIAo+IEBAIC03NzUsNyArNzc1LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHNpX3ByZV9l
bmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICB7Cj4gICAJc3RydWN0IGlu
dGVsX2RzaSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4g
ICAJc3RydWN0IGRybV9jcnRjICpjcnRjID0gcGlwZV9jb25maWctPmJhc2UuY3J0YzsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+ZGV2KTsKPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5kZXYpOwo+ICAg
CXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjKTsKPiAg
IAlpbnQgcGlwZSA9IGludGVsX2NydGMtPnBpcGU7Cj4gICAJZW51bSBwb3J0IHBvcnQ7Cj4gQEAg
LTc4NCwxMyArNzg0LDEzIEBAIHN0YXRpYyB2b2lkIGludGVsX2RzaV9wcmVfZW5hYmxlKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCj4gICAJRFJNX0RFQlVHX0tNUygiXG4iKTsK
PiAgIAo+IC0JaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZfcHJpdiwg
cGlwZSwgdHJ1ZSk7Cj4gKwlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGk5
MTUsIHBpcGUsIHRydWUpOwo+ICAgCj4gICAJLyoKPiAgIAkgKiBUaGUgQklPUyBtYXkgbGVhdmUg
dGhlIFBMTCBpbiBhIHdvbmt5IHN0YXRlIHdoZXJlIGl0IGRvZXNuJ3QKPiAgIAkgKiBsb2NrLiBJ
dCBuZWVkcyB0byBiZSBmdWxseSBwb3dlcmVkIGRvd24gdG8gZml4IGl0Lgo+ICAgCSAqLwo+IC0J
aWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfR0VOOV9MUChpOTE1KSkgewo+
ICAgCQlieHRfZHNpX3BsbF9kaXNhYmxlKGVuY29kZXIpOwo+ICAgCQlieHRfZHNpX3BsbF9lbmFi
bGUoZW5jb2RlciwgcGlwZV9jb25maWcpOwo+ICAgCX0gZWxzZSB7Cj4gQEAgLTc5OCw3ICs3OTgs
NyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kc2lfcHJlX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiAgIAkJdmx2X2RzaV9wbGxfZW5hYmxlKGVuY29kZXIsIHBpcGVfY29uZmln
KTsKPiAgIAl9Cj4gICAKPiAtCWlmIChJU19CUk9YVE9OKGRldl9wcml2KSkgewo+ICsJaWYgKElT
X0JST1hUT04oaTkxNSkpIHsKPiAgIAkJLyogQWRkIE1JUEkgSU8gcmVzZXQgcHJvZ3JhbW1pbmcg
Zm9yIG1vZGVzZXQgKi8KPiAgIAkJdmFsID0gSTkxNV9SRUFEKEJYVF9QX0NSX0dUX0RJU1BfUFdS
T04pOwo+ICAgCQlJOTE1X1dSSVRFKEJYVF9QX0NSX0dUX0RJU1BfUFdST04sCj4gQEAgLTgwOSw3
ICs4MDksNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kc2lfcHJlX2VuYWJsZShzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJSTkxNV9XUklURShCWFRfUF9EU0lfUkVHVUxBVE9SX1RY
X0NUUkwsIDApOwo+ICAgCX0KPiAgIAo+IC0JaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8
IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gKwlpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8
fCBJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gICAJCXUzMiB2YWw7Cj4gICAKPiAgIAkJLyogRGlz
YWJsZSBEUE91bml0IGNsb2NrIGdhdGluZywgY2FuIHN0YWxsIHBpcGUgKi8KPiBAQCAtODE4LDcg
KzgxOCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RzaV9wcmVfZW5hYmxlKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+ICAgCQlJOTE1X1dSSVRFKERTUENMS19HQVRFX0QsIHZhbCk7Cj4g
ICAJfQo+ICAgCj4gLQlpZiAoIUlTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKQo+ICsJaWYgKCFJU19H
RU1JTklMQUtFKGk5MTUpKQo+ICAgCQlpbnRlbF9kc2lfcHJlcGFyZShlbmNvZGVyLCBwaXBlX2Nv
bmZpZyk7Cj4gICAKPiAgIAkvKiBQb3dlciBvbiwgdHJ5IGJvdGggQ1JDIHBtaWMgZ3BpbyBhbmQg
VkJUICovCj4gQEAgLTgzMCw3ICs4MzAsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kc2lfcHJlX2Vu
YWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkvKiBEZWFzc2VydCByZXNl
dCAqLwo+ICAgCWludGVsX2RzaV92YnRfZXhlY19zZXF1ZW5jZShpbnRlbF9kc2ksIE1JUElfU0VR
X0RFQVNTRVJUX1JFU0VUKTsKPiAgIAo+IC0JaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKSB7
Cj4gKwlpZiAoSVNfR0VNSU5JTEFLRShpOTE1KSkgewo+ICAgCQlnbGtfY29sZF9ib290ID0gZ2xr
X2RzaV9lbmFibGVfaW8oZW5jb2Rlcik7Cj4gICAKPiAgIAkJLyogUHJlcGFyZSBwb3J0IGluIGNv
bGQgYm9vdChzMy9zNCkgc2NlbmFyaW8gKi8KPiBAQCAtODQyLDcgKzg0Miw3IEBAIHN0YXRpYyB2
b2lkIGludGVsX2RzaV9wcmVfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+
ICAgCWludGVsX2RzaV9kZXZpY2VfcmVhZHkoZW5jb2Rlcik7Cj4gICAKPiAgIAkvKiBQcmVwYXJl
IHBvcnQgaW4gbm9ybWFsIGJvb3Qgc2NlbmFyaW8gKi8KPiAtCWlmIChJU19HRU1JTklMQUtFKGRl
dl9wcml2KSAmJiAhZ2xrX2NvbGRfYm9vdCkKPiArCWlmIChJU19HRU1JTklMQUtFKGk5MTUpICYm
ICFnbGtfY29sZF9ib290KQo+ICAgCQlpbnRlbF9kc2lfcHJlcGFyZShlbmNvZGVyLCBwaXBlX2Nv
bmZpZyk7Cj4gICAKPiAgIAkvKiBTZW5kIGluaXRpYWxpemF0aW9uIGNvbW1hbmRzIGluIExQIG1v
ZGUgKi8KPiBAQCAtOTAxLDkgKzkwMSw5IEBAIHN0YXRpYyB2b2lkIGludGVsX2RzaV9kaXNhYmxl
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCj4gICBzdGF0aWMgdm9pZCBpbnRl
bF9kc2lfY2xlYXJfZGV2aWNlX3JlYWR5KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+
ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNv
ZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCj4gLQlpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJp
dikpCj4gKwlpZiAoSVNfR0VNSU5JTEFLRShpOTE1KSkKPiAgIAkJZ2xrX2RzaV9jbGVhcl9kZXZp
Y2VfcmVhZHkoZW5jb2Rlcik7Cj4gICAJZWxzZQo+ICAgCQl2bHZfZHNpX2NsZWFyX2RldmljZV9y
ZWFkeShlbmNvZGVyKTsKPiBAQCAtOTEzLDcgKzkxMyw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2Rz
aV9wb3N0X2Rpc2FibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkJICAg
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ICAgCQkJCSAgIGNv
bnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ICAgewo+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRl
dik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+
YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGVuY190b19pbnRl
bF9kc2koJmVuY29kZXItPmJhc2UpOwo+ICAgCWVudW0gcG9ydCBwb3J0Owo+ICAgCXUzMiB2YWw7
Cj4gQEAgLTk0MSw3ICs5NDEsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kc2lfcG9zdF9kaXNhYmxl
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCS8qIFRyYW5zaXRpb24gdG8gTFAt
MDAgKi8KPiAgIAlpbnRlbF9kc2lfY2xlYXJfZGV2aWNlX3JlYWR5KGVuY29kZXIpOwo+ICAgCj4g
LQlpZiAoSVNfQlJPWFRPTihkZXZfcHJpdikpIHsKPiArCWlmIChJU19CUk9YVE9OKGk5MTUpKSB7
Cj4gICAJCS8qIFBvd2VyIGRvd24gRFNJIHJlZ3VsYXRvciB0byBzYXZlIHBvd2VyICovCj4gICAJ
CUk5MTVfV1JJVEUoQlhUX1BfRFNJX1JFR1VMQVRPUl9DRkcsIFNUQVBfU0VMRUNUKTsKPiAgIAkJ
STkxNV9XUklURShCWFRfUF9EU0lfUkVHVUxBVE9SX1RYX0NUUkwsIEhTX0lPX0NUUkxfU0VMRUNU
KTsKPiBAQCAtOTUyLDcgKzk1Miw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RzaV9wb3N0X2Rpc2Fi
bGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkJdmFsICYgfk1JUElPX1JT
VF9DVFJMKTsKPiAgIAl9Cj4gICAKPiAtCWlmIChJU19HRU45X0xQKGRldl9wcml2KSkgewo+ICsJ
aWYgKElTX0dFTjlfTFAoaTkxNSkpIHsKPiAgIAkJYnh0X2RzaV9wbGxfZGlzYWJsZShlbmNvZGVy
KTsKPiAgIAl9IGVsc2Ugewo+ICAgCQl1MzIgdmFsOwo+IEBAIC05ODMsNyArOTgzLDcgQEAgc3Rh
dGljIHZvaWQgaW50ZWxfZHNpX3Bvc3RfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKPiAgIHN0YXRpYyBib29sIGludGVsX2RzaV9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkJICAgZW51bSBwaXBlICpwaXBlKQo+ICAgewo+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNl
LmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rl
ci0+YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGVuY190b19p
bnRlbF9kc2koJmVuY29kZXItPmJhc2UpOwo+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+
ICAgCWVudW0gcG9ydCBwb3J0Owo+IEBAIC05OTEsNyArOTkxLDcgQEAgc3RhdGljIGJvb2wgaW50
ZWxfZHNpX2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAo+
ICAgCURSTV9ERUJVR19LTVMoIlxuIik7Cj4gICAKPiAtCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5
X3Bvd2VyX2dldF9pZl9lbmFibGVkKGRldl9wcml2LAo+ICsJd2FrZXJlZiA9IGludGVsX2Rpc3Bs
YXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoaTkxNSwKPiAgIAkJCQkJCSAgICAgZW5jb2Rlci0+cG93
ZXJfZG9tYWluKTsKPiAgIAlpZiAoIXdha2VyZWYpCj4gICAJCXJldHVybiBmYWxzZTsKPiBAQCAt
MTAwMSwxMiArMTAwMSwxMiBAQCBzdGF0aWMgYm9vbCBpbnRlbF9kc2lfZ2V0X2h3X3N0YXRlKHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCSAqIGNvbmZpZ3VyYXRpb24sIG90aGVy
d2lzZSBhY2Nlc3NpbmcgRFNJIHJlZ2lzdGVycyB3aWxsIGhhbmcgdGhlCj4gICAJICogbWFjaGlu
ZS4gU2VlIEJTcGVjIE5vcnRoIERpc3BsYXkgRW5naW5lIHJlZ2lzdGVycy9NSVBJW0JYVF0uCj4g
ICAJICovCj4gLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikgJiYgIWJ4dF9kc2lfcGxsX2lzX2Vu
YWJsZWQoZGV2X3ByaXYpKQo+ICsJaWYgKElTX0dFTjlfTFAoaTkxNSkgJiYgIWJ4dF9kc2lfcGxs
X2lzX2VuYWJsZWQoaTkxNSkpCj4gICAJCWdvdG8gb3V0X3B1dF9wb3dlcjsKPiAgIAo+ICAgCS8q
IFhYWDogdGhpcyBvbmx5IHdvcmtzIGZvciBvbmUgRFNJIG91dHB1dCAqLwo+ICAgCWZvcl9lYWNo
X2RzaV9wb3J0KHBvcnQsIGludGVsX2RzaS0+cG9ydHMpIHsKPiAtCQlpOTE1X3JlZ190IGN0cmxf
cmVnID0gSVNfR0VOOV9MUChkZXZfcHJpdikgPwo+ICsJCWk5MTVfcmVnX3QgY3RybF9yZWcgPSBJ
U19HRU45X0xQKGk5MTUpID8KPiAgIAkJCUJYVF9NSVBJX1BPUlRfQ1RSTChwb3J0KSA6IE1JUElf
UE9SVF9DVFJMKHBvcnQpOwo+ICAgCQlib29sIGVuYWJsZWQgPSBJOTE1X1JFQUQoY3RybF9yZWcp
ICYgRFBJX0VOQUJMRTsKPiAgIAo+IEBAIC0xMDE1LDcgKzEwMTUsNyBAQCBzdGF0aWMgYm9vbCBp
bnRlbF9kc2lfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAg
CQkgKiBiaXQgaW4gcG9ydCBDIGNvbnRyb2wgcmVnaXN0ZXIgZG9lcyBub3QgZ2V0IHNldC4gQXMg
YQo+ICAgCQkgKiB3b3JrYXJvdW5kLCBjaGVjayBwaXBlIEIgY29uZiBpbnN0ZWFkLgo+ICAgCQkg
Ki8KPiAtCQlpZiAoKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2
X3ByaXYpKSAmJgo+ICsJCWlmICgoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVX
KGk5MTUpKSAmJgo+ICAgCQkgICAgcG9ydCA9PSBQT1JUX0MpCj4gICAJCQllbmFibGVkID0gSTkx
NV9SRUFEKFBJUEVDT05GKFBJUEVfQikpICYgUElQRUNPTkZfRU5BQkxFOwo+ICAgCj4gQEAgLTEw
MzEsNyArMTAzMSw3IEBAIHN0YXRpYyBib29sIGludGVsX2RzaV9nZXRfaHdfc3RhdGUoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCWlmICghKEk5MTVfUkVBRChNSVBJX0RFVklD
RV9SRUFEWShwb3J0KSkgJiBERVZJQ0VfUkVBRFkpKQo+ICAgCQkJY29udGludWU7Cj4gICAKPiAt
CQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpIHsKPiArCQlpZiAoSVNfR0VOOV9MUChpOTE1KSkg
ewo+ICAgCQkJdTMyIHRtcCA9IEk5MTVfUkVBRChNSVBJX0NUUkwocG9ydCkpOwo+ICAgCQkJdG1w
ICY9IEJYVF9QSVBFX1NFTEVDVF9NQVNLOwo+ICAgCQkJdG1wID4+PSBCWFRfUElQRV9TRUxFQ1Rf
U0hJRlQ7Cj4gQEAgLTEwNDksNyArMTA0OSw3IEBAIHN0YXRpYyBib29sIGludGVsX2RzaV9nZXRf
aHdfc3RhdGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJfQo+ICAgCj4gICBv
dXRfcHV0X3Bvd2VyOgo+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIGVuY29k
ZXItPnBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChp
OTE1LCBlbmNvZGVyLT5wb3dlcl9kb21haW4sIHdha2VyZWYpOwo+ICAgCj4gICAJcmV0dXJuIGFj
dGl2ZTsKPiAgIH0KPiBAQCAtMTA1OCw3ICsxMDU4LDcgQEAgc3RhdGljIHZvaWQgYnh0X2RzaV9n
ZXRfcGlwZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkJICAg
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiAgIHsKPiAgIAlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2ID0gZW5jb2Rlci0+YmFzZS5kZXY7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAgIAlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAq
YWRqdXN0ZWRfbW9kZSA9Cj4gICAJCQkJCSZwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2Rl
Owo+ICAgCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlX3N3Owo+IEBAIC0x
MjE4LDEzICsxMjE4LDEzIEBAIHN0YXRpYyB2b2lkIGJ4dF9kc2lfZ2V0X3BpcGVfY29uZmlnKHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgc3RhdGljIHZvaWQgaW50ZWxfZHNpX2dl
dF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJCQkJIHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAg
IAl1MzIgcGNsazsKPiAgIAlEUk1fREVCVUdfS01TKCJcbiIpOwo+ICAgCj4gICAJcGlwZV9jb25m
aWctPm91dHB1dF90eXBlcyB8PSBCSVQoSU5URUxfT1VUUFVUX0RTSSk7Cj4gICAKPiAtCWlmIChJ
U19HRU45X0xQKGRldl9wcml2KSkgewo+ICsJaWYgKElTX0dFTjlfTFAoaTkxNSkpIHsKPiAgIAkJ
Ynh0X2RzaV9nZXRfcGlwZV9jb25maWcoZW5jb2RlciwgcGlwZV9jb25maWcpOwo+ICAgCQlwY2xr
ID0gYnh0X2RzaV9nZXRfcGNsayhlbmNvZGVyLCBwaXBlX2NvbmZpZyk7Cj4gICAJfSBlbHNlIHsK
PiBAQCAtMTI1NSw3ICsxMjU1LDcgQEAgc3RhdGljIHZvaWQgc2V0X2RzaV90aW1pbmdzKHN0cnVj
dCBkcm1fZW5jb2RlciAqZW5jb2RlciwKPiAgIAkJCSAgICBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3Bs
YXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
ID0gZW5jb2Rlci0+ZGV2Owo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGRldik7Cj4gICAJc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2Rz
aShlbmNvZGVyKTsKPiAgIAllbnVtIHBvcnQgcG9ydDsKPiAgIAl1bnNpZ25lZCBpbnQgYnBwID0g
bWlwaV9kc2lfcGl4ZWxfZm9ybWF0X3RvX2JwcChpbnRlbF9kc2ktPnBpeGVsX2Zvcm1hdCk7Cj4g
QEAgLTEyOTAsNyArMTI5MCw3IEBAIHN0YXRpYyB2b2lkIHNldF9kc2lfdGltaW5ncyhzdHJ1Y3Qg
ZHJtX2VuY29kZXIgKmVuY29kZXIsCj4gICAJaGJwID0gdHhieXRlY2xraHMoaGJwLCBicHAsIGxh
bmVfY291bnQsIGludGVsX2RzaS0+YnVyc3RfbW9kZV9yYXRpbyk7Cj4gICAKPiAgIAlmb3JfZWFj
aF9kc2lfcG9ydChwb3J0LCBpbnRlbF9kc2ktPnBvcnRzKSB7Cj4gLQkJaWYgKElTX0dFTjlfTFAo
ZGV2X3ByaXYpKSB7Cj4gKwkJaWYgKElTX0dFTjlfTFAoaTkxNSkpIHsKPiAgIAkJCS8qCj4gICAJ
CQkgKiBQcm9ncmFtIGhkaXNwbGF5IGFuZCB2ZGlzcGxheSBvbiBNSVBJIHRyYW5zY29kZXIuCj4g
ICAJCQkgKiBUaGlzIGlzIGRpZmZlcmVudCBmcm9tIGNhbGN1bGF0ZWQgaGFjdGl2ZSBhbmQKPiBA
QCAtMTM0Miw3ICsxMzQyLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHNpX3ByZXBhcmUoc3RydWN0
IGludGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIsCj4gICB7Cj4gICAJc3RydWN0IGRybV9lbmNv
ZGVyICplbmNvZGVyID0gJmludGVsX2VuY29kZXItPmJhc2U7Cj4gICAJc3RydWN0IGRybV9kZXZp
Y2UgKmRldiA9IGVuY29kZXItPmRldjsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShkZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50
ZWxfY3J0YyhwaXBlX2NvbmZpZy0+YmFzZS5jcnRjKTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICpp
bnRlbF9kc2kgPSBlbmNfdG9faW50ZWxfZHNpKGVuY29kZXIpOwo+ICAgCWNvbnN0IHN0cnVjdCBk
cm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmlnLT5iYXNlLmFkanVz
dGVkX21vZGU7Cj4gQEAgLTEzNjIsNyArMTM2Miw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RzaV9w
cmVwYXJlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICppbnRlbF9lbmNvZGVyLAo+ICAgCX0KPiAgIAo+
ICAgCWZvcl9lYWNoX2RzaV9wb3J0KHBvcnQsIGludGVsX2RzaS0+cG9ydHMpIHsKPiAtCQlpZiAo
SVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiAr
CQlpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gICAJ
CQkvKgo+ICAgCQkJICogZXNjYXBlIGNsb2NrIGRpdmlkZXIsIDIwTUh6LCBzaGFyZWQgZm9yIEEg
YW5kIEMuCj4gICAJCQkgKiBkZXZpY2UgcmVhZHkgbXVzdCBiZSBvZmYgd2hlbiBkb2luZyB0aGlz
ISB0eGNsa2VzYz8KPiBAQCAtMTM3Nyw3ICsxMzc3LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHNp
X3ByZXBhcmUoc3RydWN0IGludGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIsCj4gICAJCQl0bXAg
Jj0gflJFQURfUkVRVUVTVF9QUklPUklUWV9NQVNLOwo+ICAgCQkJSTkxNV9XUklURShNSVBJX0NU
UkwocG9ydCksIHRtcCB8Cj4gICAJCQkJCVJFQURfUkVRVUVTVF9QUklPUklUWV9ISUdIKTsKPiAt
CQl9IGVsc2UgaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKSB7Cj4gKwkJfSBlbHNlIGlmIChJU19H
RU45X0xQKGk5MTUpKSB7Cj4gICAJCQllbnVtIHBpcGUgcGlwZSA9IGludGVsX2NydGMtPnBpcGU7
Cj4gICAKPiAgIAkJCXRtcCA9IEk5MTVfUkVBRChNSVBJX0NUUkwocG9ydCkpOwo+IEBAIC0xNDE1
LDcgKzE0MTUsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kc2lfcHJlcGFyZShzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqaW50ZWxfZW5jb2RlciwKPiAgIAlpZiAoaW50ZWxfZHNpLT5jbG9ja19zdG9wKQo+
ICAgCQl0bXAgfD0gQ0xPQ0tTVE9QOwo+ICAgCj4gLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikp
IHsKPiArCWlmIChJU19HRU45X0xQKGk5MTUpKSB7Cj4gICAJCXRtcCB8PSBCWFRfRFBIWV9ERUZF
QVRVUkVfRU47Cj4gICAJCWlmICghaXNfY21kX21vZGUoaW50ZWxfZHNpKSkKPiAgIAkJCXRtcCB8
PSBCWFRfREVGRUFUVVJFX0RQSV9GSUZPX0NUUjsKPiBAQCAtMTQ2Niw3ICsxNDY2LDcgQEAgc3Rh
dGljIHZvaWQgaW50ZWxfZHNpX3ByZXBhcmUoc3RydWN0IGludGVsX2VuY29kZXIgKmludGVsX2Vu
Y29kZXIsCj4gICAJCUk5MTVfV1JJVEUoTUlQSV9JTklUX0NPVU5UKHBvcnQpLAo+ICAgCQkJCXR4
Y2xrZXNjKGludGVsX2RzaS0+ZXNjYXBlX2Nsa19kaXYsIDEwMCkpOwo+ICAgCj4gLQkJaWYgKElT
X0dFTjlfTFAoZGV2X3ByaXYpICYmICghaW50ZWxfZHNpLT5kdWFsX2xpbmspKSB7Cj4gKwkJaWYg
KElTX0dFTjlfTFAoaTkxNSkgJiYgKCFpbnRlbF9kc2ktPmR1YWxfbGluaykpIHsKPiAgIAkJCS8q
Cj4gICAJCQkgKiBCWFQgc3BlYyBzYXlzIHdyaXRlIE1JUElfSU5JVF9DT1VOVCBmb3IKPiAgIAkJ
CSAqIGJvdGggdGhlIHBvcnRzLCBldmVuIGlmIG9ubHkgb25lIGlzCj4gQEAgLTE1MDAsNyArMTUw
MCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RzaV9wcmVwYXJlKHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICppbnRlbF9lbmNvZGVyLAo+ICAgCQkgKi8KPiAgIAkJSTkxNV9XUklURShNSVBJX0xQX0JZVEVD
TEsocG9ydCksIGludGVsX2RzaS0+bHBfYnl0ZV9jbGspOwo+ICAgCj4gLQkJaWYgKElTX0dFTUlO
SUxBS0UoZGV2X3ByaXYpKSB7Cj4gKwkJaWYgKElTX0dFTUlOSUxBS0UoaTkxNSkpIHsKPiAgIAkJ
CUk5MTVfV1JJVEUoTUlQSV9UTFBYX1RJTUVfQ09VTlQocG9ydCksCj4gICAJCQkJCWludGVsX2Rz
aS0+bHBfYnl0ZV9jbGspOwo+ICAgCQkJLyogU2hhZG93IG9mIERQSFkgcmVnICovCj4gQEAgLTE1
MzMsMTkgKzE1MzMsMTkgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHNpX3ByZXBhcmUoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIsCj4gICAKPiAgIHN0YXRpYyB2b2lkIGludGVsX2Rz
aV91bnByZXBhcmUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICB7Cj4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2
KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5i
YXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVs
X2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gICAJZW51bSBwb3J0IHBvcnQ7Cj4gICAJdTMyIHZhbDsK
PiAgIAo+IC0JaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKQo+ICsJaWYgKElTX0dFTUlOSUxB
S0UoaTkxNSkpCj4gICAJCXJldHVybjsKPiAgIAo+ICAgCWZvcl9lYWNoX2RzaV9wb3J0KHBvcnQs
IGludGVsX2RzaS0+cG9ydHMpIHsKPiAgIAkJLyogUGFuZWwgY29tbWFuZHMgY2FuIGJlIHNlbnQg
d2hlbiBjbG9jayBpcyBpbiBMUDExICovCj4gICAJCUk5MTVfV1JJVEUoTUlQSV9ERVZJQ0VfUkVB
RFkocG9ydCksIDB4MCk7Cj4gICAKPiAtCQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCj4gKwkJ
aWYgKElTX0dFTjlfTFAoaTkxNSkpCj4gICAJCQlieHRfZHNpX3Jlc2V0X2Nsb2NrcyhlbmNvZGVy
LCBwb3J0KTsKPiAgIAkJZWxzZQo+ICAgCQkJdmx2X2RzaV9yZXNldF9jbG9ja3MoZW5jb2Rlciwg
cG9ydCk7Cj4gQEAgLTE1OTQsNyArMTU5NCw3IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2Nv
bm5lY3Rvcl9mdW5jcyBpbnRlbF9kc2lfY29ubmVjdG9yX2Z1bmNzID0gewo+ICAgc3RhdGljIGVu
dW0gZHJtX3BhbmVsX29yaWVudGF0aW9uCj4gICB2bHZfZHNpX2dldF9od19wYW5lbF9vcmllbnRh
dGlvbihzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gICB7Cj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+
YmFzZS5kZXYpOwo+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyID0gY29ubmVjdG9y
LT5lbmNvZGVyOwo+ICAgCWVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gcG93ZXJfZG9t
YWluOwo+ICAgCWVudW0gZHJtX3BhbmVsX29yaWVudGF0aW9uIG9yaWVudGF0aW9uOwo+IEBAIC0x
NjA3LDExICsxNjA3LDExIEBAIHZsdl9kc2lfZ2V0X2h3X3BhbmVsX29yaWVudGF0aW9uKHN0cnVj
dCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIAlpZiAoIWVuY29kZXItPmdldF9od19z
dGF0ZShlbmNvZGVyLCAmcGlwZSkpCj4gICAJCXJldHVybiBEUk1fTU9ERV9QQU5FTF9PUklFTlRB
VElPTl9VTktOT1dOOwo+ICAgCj4gLQljcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2
X3ByaXYsIHBpcGUpOwo+ICsJY3J0YyA9IGludGVsX2dldF9jcnRjX2Zvcl9waXBlKGk5MTUsIHBp
cGUpOwo+ICAgCXBsYW5lID0gdG9faW50ZWxfcGxhbmUoY3J0Yy0+YmFzZS5wcmltYXJ5KTsKPiAg
IAo+ICAgCXBvd2VyX2RvbWFpbiA9IFBPV0VSX0RPTUFJTl9QSVBFKHBpcGUpOwo+IC0Jd2FrZXJl
ZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2X3ByaXYsIHBvd2VyX2Rv
bWFpbik7Cj4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChp
OTE1LCBwb3dlcl9kb21haW4pOwo+ICAgCWlmICghd2FrZXJlZikKPiAgIAkJcmV0dXJuIERSTV9N
T0RFX1BBTkVMX09SSUVOVEFUSU9OX1VOS05PV047Cj4gICAKPiBAQCAtMTYyNCw3ICsxNjI0LDcg
QEAgdmx2X2RzaV9nZXRfaHdfcGFuZWxfb3JpZW50YXRpb24oc3RydWN0IGludGVsX2Nvbm5lY3Rv
ciAqY29ubmVjdG9yKQo+ICAgCWVsc2UKPiAgIAkJb3JpZW50YXRpb24gPSBEUk1fTU9ERV9QQU5F
TF9PUklFTlRBVElPTl9OT1JNQUw7Cj4gICAKPiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRl
dl9wcml2LCBwb3dlcl9kb21haW4sIHdha2VyZWYpOwo+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9w
dXQoaTkxNSwgcG93ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiAgIAo+ICAgCXJldHVybiBvcmllbnRh
dGlvbjsKPiAgIH0KPiBAQCAtMTYzMiwxMCArMTYzMiwxMCBAQCB2bHZfZHNpX2dldF9od19wYW5l
bF9vcmllbnRhdGlvbihzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gICBzdGF0
aWMgZW51bSBkcm1fcGFuZWxfb3JpZW50YXRpb24KPiAgIHZsdl9kc2lfZ2V0X3BhbmVsX29yaWVu
dGF0aW9uKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIHsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRl
dik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9y
LT5iYXNlLmRldik7Cj4gICAJZW51bSBkcm1fcGFuZWxfb3JpZW50YXRpb24gb3JpZW50YXRpb247
Cj4gICAKPiAtCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRl
dl9wcml2KSkgewo+ICsJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhp
OTE1KSkgewo+ICAgCQlvcmllbnRhdGlvbiA9IHZsdl9kc2lfZ2V0X2h3X3BhbmVsX29yaWVudGF0
aW9uKGNvbm5lY3Rvcik7Cj4gICAJCWlmIChvcmllbnRhdGlvbiAhPSBEUk1fTU9ERV9QQU5FTF9P
UklFTlRBVElPTl9VTktOT1dOKQo+ICAgCQkJcmV0dXJuIG9yaWVudGF0aW9uOwo+IEBAIC0xNjQ2
LDEzICsxNjQ2LDEzIEBAIHZsdl9kc2lfZ2V0X3BhbmVsX29yaWVudGF0aW9uKHN0cnVjdCBpbnRl
bF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIAo+ICAgc3RhdGljIHZvaWQgaW50ZWxfZHNpX2Fk
ZF9wcm9wZXJ0aWVzKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiAgIHsKPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5i
YXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29u
bmVjdG9yLT5iYXNlLmRldik7Cj4gICAKPiAgIAlpZiAoY29ubmVjdG9yLT5wYW5lbC5maXhlZF9t
b2RlKSB7Cj4gICAJCXUzMiBhbGxvd2VkX3NjYWxlcnM7Cj4gICAKPiAgIAkJYWxsb3dlZF9zY2Fs
ZXJzID0gQklUKERSTV9NT0RFX1NDQUxFX0FTUEVDVCkgfCBCSVQoRFJNX01PREVfU0NBTEVfRlVM
TFNDUkVFTik7Cj4gLQkJaWYgKCFIQVNfR01DSChkZXZfcHJpdikpCj4gKwkJaWYgKCFIQVNfR01D
SChpOTE1KSkKPiAgIAkJCWFsbG93ZWRfc2NhbGVycyB8PSBCSVQoRFJNX01PREVfU0NBTEVfQ0VO
VEVSKTsKPiAgIAo+ICAgCQlkcm1fY29ubmVjdG9yX2F0dGFjaF9zY2FsaW5nX21vZGVfcHJvcGVy
dHkoJmNvbm5lY3Rvci0+YmFzZSwKPiBAQCAtMTY3OSw4ICsxNjc5LDggQEAgc3RhdGljIHZvaWQg
aW50ZWxfZHNpX2FkZF9wcm9wZXJ0aWVzKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3Rv
cikKPiAgIHN0YXRpYyB2b2lkIHZsdl9kcGh5X3BhcmFtX2luaXQoc3RydWN0IGludGVsX2RzaSAq
aW50ZWxfZHNpKQo+ICAgewo+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBpbnRlbF9kc2kt
PmJhc2UuYmFzZS5kZXY7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGRldik7Cj4gLQlzdHJ1Y3QgbWlwaV9jb25maWcgKm1pcGlfY29uZmlnID0gZGV2X3By
aXYtPnZidC5kc2kuY29uZmlnOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgbWlwaV9jb25maWcgKm1pcGlfY29uZmlnID0gaTkxNS0+
dmJ0LmRzaS5jb25maWc7Cj4gICAJdTMyIHRscHhfbnMsIGV4dHJhX2J5dGVfY291bnQsIHRscHhf
dWk7Cj4gICAJdTMyIHVpX251bSwgdWlfZGVuOwo+ICAgCXUzMiBwcmVwYXJlX2NudCwgZXhpdF96
ZXJvX2NudCwgY2xrX3plcm9fY250LCB0cmFpbF9jbnQ7Cj4gQEAgLTE3MjcsNyArMTcyNyw3IEBA
IHN0YXRpYyB2b2lkIHZsdl9kcGh5X3BhcmFtX2luaXQoc3RydWN0IGludGVsX2RzaSAqaW50ZWxf
ZHNpKQo+ICAgCSAqIEZvciBHRU1JTklMQUtFIGRwaHlfcGFyYW1fcmVnIHdpbGwgYmUgcHJvZ3Jh
bW1lZCBpbiB0ZXJtcyBvZgo+ICAgCSAqIEhTIGJ5dGUgY2xvY2sgY291bnQgZm9yIG90aGVyIHBs
YXRmb3JtIGluIEhTIGRkciBjbG9jayBjb3VudAo+ICAgCSAqLwo+IC0JbXVsID0gSVNfR0VNSU5J
TEFLRShkZXZfcHJpdikgPyA4IDogMjsKPiArCW11bCA9IElTX0dFTUlOSUxBS0UoaTkxNSkgPyA4
IDogMjsKPiAgIAl0aHNfcHJlcGFyZV9ucyA9IG1heChtaXBpX2NvbmZpZy0+dGhzX3ByZXBhcmUs
Cj4gICAJCQkgICAgIG1pcGlfY29uZmlnLT50Y2xrX3ByZXBhcmUpOwo+ICAgCj4gQEAgLTE4Mzcs
OSArMTgzNyw5IEBAIHN0YXRpYyB2b2lkIHZsdl9kcGh5X3BhcmFtX2luaXQoc3RydWN0IGludGVs
X2RzaSAqaW50ZWxfZHNpKQo+ICAgCWludGVsX2RzaV9sb2dfcGFyYW1zKGludGVsX2RzaSk7Cj4g
ICB9Cj4gICAKPiAtdm9pZCB2bHZfZHNpX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ICt2b2lkIHZsdl9kc2lfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiAgIHsKPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKPiAr
CXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+ICAgCXN0cnVjdCBpbnRlbF9k
c2kgKmludGVsX2RzaTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqaW50ZWxfZW5jb2RlcjsK
PiAgIAlzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXI7Cj4gQEAgLTE4NTEsMTMgKzE4NTEsMTMg
QEAgdm9pZCB2bHZfZHNpX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ICAgCURSTV9ERUJVR19LTVMoIlxuIik7Cj4gICAKPiAgIAkvKiBUaGVyZSBpcyBubyBkZXRlY3Rp
b24gbWV0aG9kIGZvciBNSVBJIHNvIHJlbHkgb24gVkJUICovCj4gLQlpZiAoIWludGVsX2Jpb3Nf
aXNfZHNpX3ByZXNlbnQoZGV2X3ByaXYsICZwb3J0KSkKPiArCWlmICghaW50ZWxfYmlvc19pc19k
c2lfcHJlc2VudChpOTE1LCAmcG9ydCkpCj4gICAJCXJldHVybjsKPiAgIAo+IC0JaWYgKElTX0dF
TjlfTFAoZGV2X3ByaXYpKQo+IC0JCWRldl9wcml2LT5taXBpX21taW9fYmFzZSA9IEJYVF9NSVBJ
X0JBU0U7Cj4gKwlpZiAoSVNfR0VOOV9MUChpOTE1KSkKPiArCQlpOTE1LT5taXBpX21taW9fYmFz
ZSA9IEJYVF9NSVBJX0JBU0U7Cj4gICAJZWxzZQo+IC0JCWRldl9wcml2LT5taXBpX21taW9fYmFz
ZSA9IFZMVl9NSVBJX0JBU0U7Cj4gKwkJaTkxNS0+bWlwaV9tbWlvX2Jhc2UgPSBWTFZfTUlQSV9C
QVNFOwo+ICAgCj4gICAJaW50ZWxfZHNpID0ga3phbGxvYyhzaXplb2YoKmludGVsX2RzaSksIEdG
UF9LRVJORUwpOwo+ICAgCWlmICghaW50ZWxfZHNpKQo+IEBAIC0xODk3LDIwICsxODk3LDIwIEBA
IHZvaWQgdmx2X2RzaV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAg
IAkgKiBPbiBCWVQvQ0hWLCBwaXBlIEEgbWFwcyB0byBNSVBJIERTSSBwb3J0IEEsIHBpcGUgQiBt
YXBzIHRvIE1JUEkgRFNJCj4gICAJICogcG9ydCBDLiBCWFQgaXNuJ3QgbGltaXRlZCBsaWtlIHRo
aXMuCj4gICAJICovCj4gLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCj4gKwlpZiAoSVNfR0VO
OV9MUChpOTE1KSkKPiAgIAkJaW50ZWxfZW5jb2Rlci0+Y3J0Y19tYXNrID0gQklUKFBJUEVfQSkg
fCBCSVQoUElQRV9CKSB8IEJJVChQSVBFX0MpOwo+ICAgCWVsc2UgaWYgKHBvcnQgPT0gUE9SVF9B
KQo+ICAgCQlpbnRlbF9lbmNvZGVyLT5jcnRjX21hc2sgPSBCSVQoUElQRV9BKTsKPiAgIAllbHNl
Cj4gICAJCWludGVsX2VuY29kZXItPmNydGNfbWFzayA9IEJJVChQSVBFX0IpOwo+ICAgCj4gLQlp
ZiAoZGV2X3ByaXYtPnZidC5kc2kuY29uZmlnLT5kdWFsX2xpbmspCj4gKwlpZiAoaTkxNS0+dmJ0
LmRzaS5jb25maWctPmR1YWxfbGluaykKPiAgIAkJaW50ZWxfZHNpLT5wb3J0cyA9IEJJVChQT1JU
X0EpIHwgQklUKFBPUlRfQyk7Cj4gICAJZWxzZQo+ICAgCQlpbnRlbF9kc2ktPnBvcnRzID0gQklU
KHBvcnQpOwo+ICAgCj4gLQlpbnRlbF9kc2ktPmRjc19iYWNrbGlnaHRfcG9ydHMgPSBkZXZfcHJp
di0+dmJ0LmRzaS5ibF9wb3J0czsKPiAtCWludGVsX2RzaS0+ZGNzX2NhYmNfcG9ydHMgPSBkZXZf
cHJpdi0+dmJ0LmRzaS5jYWJjX3BvcnRzOwo+ICsJaW50ZWxfZHNpLT5kY3NfYmFja2xpZ2h0X3Bv
cnRzID0gaTkxNS0+dmJ0LmRzaS5ibF9wb3J0czsKPiArCWludGVsX2RzaS0+ZGNzX2NhYmNfcG9y
dHMgPSBpOTE1LT52YnQuZHNpLmNhYmNfcG9ydHM7Cj4gICAKPiAgIAkvKiBDcmVhdGUgYSBEU0kg
aG9zdCAoYW5kIGEgZGV2aWNlKSBmb3IgZWFjaCBwb3J0LiAqLwo+ICAgCWZvcl9lYWNoX2RzaV9w
b3J0KHBvcnQsIGludGVsX2RzaS0+cG9ydHMpIHsKPiBAQCAtMTk0OSw4ICsxOTQ5LDggQEAgdm9p
ZCB2bHZfZHNpX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCSAq
IEluIGNhc2Ugb2YgQllUIHdpdGggQ1JDIFBNSUMsIHdlIG5lZWQgdG8gdXNlIEdQSU8gZm9yCj4g
ICAJICogUGFuZWwgY29udHJvbC4KPiAgIAkgKi8KPiAtCWlmICgoSVNfVkFMTEVZVklFVyhkZXZf
cHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpICYmCj4gLQkgICAgKGRldl9wcml2LT52
YnQuZHNpLmNvbmZpZy0+cHdtX2JsYyA9PSBQUFNfQkxDX1BNSUMpKSB7Cj4gKwlpZiAoKElTX1ZB
TExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkgJiYKPiArCSAgICAoaTkxNS0+
dmJ0LmRzaS5jb25maWctPnB3bV9ibGMgPT0gUFBTX0JMQ19QTUlDKSkgewo+ICAgCQlpbnRlbF9k
c2ktPmdwaW9fcGFuZWwgPQo+ICAgCQkJZ3Bpb2RfZ2V0KGRldi0+ZGV2LCAicGFuZWwiLCBHUElP
RF9PVVRfSElHSCk7Cj4gICAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvdmx2
X2RzaV9wbGwuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3Zsdl9kc2lfcGxsLmMKPiBpbmRleCA5
OWNjM2UyZTljMmMuLjI2NjU1ZDU0NzJiNCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS92bHZfZHNpX3BsbC5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvdmx2X2RzaV9w
bGwuYwo+IEBAIC01Myw3ICs1Myw3IEBAIHN0YXRpYyB1MzIgZHNpX2Nsa19mcm9tX3BjbGsodTMy
IHBjbGssIGVudW0gbWlwaV9kc2lfcGl4ZWxfZm9ybWF0IGZtdCwKPiAgIAlyZXR1cm4gZHNpX2Ns
a19raHo7Cj4gICB9Cj4gICAKPiAtc3RhdGljIGludCBkc2lfY2FsY19tbnAoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICtzdGF0aWMgaW50IGRzaV9jYWxjX21ucChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
b25maWcsCj4gICAJCQlpbnQgdGFyZ2V0X2RzaV9jbGspCj4gICB7Cj4gQEAgLTY4LDcgKzY4LDcg
QEAgc3RhdGljIGludCBkc2lfY2FsY19tbnAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ICAgCQlyZXR1cm4gLUVDSFJORzsKPiAgIAl9Cj4gICAKPiAtCWlmIChJU19DSEVSUllW
SUVXKGRldl9wcml2KSkgewo+ICsJaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiAgIAkJcmVm
X2NsayA9IDEwMDAwMDsKPiAgIAkJbiA9IDQ7Cj4gICAJCW1fbWluID0gNzA7Cj4gQEAgLTExNiw3
ICsxMTYsNyBAQCBzdGF0aWMgaW50IGRzaV9jYWxjX21ucChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gICBpbnQgdmx2X2RzaV9wbGxfY29tcHV0ZShzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKPiAgIAkJCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjb25maWcpCj4g
ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29k
ZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0g
ZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gICAJaW50IHJldDsKPiAgIAl1MzIg
ZHNpX2NsazsKPiBAQCAtMTI0LDcgKzEyNCw3IEBAIGludCB2bHZfZHNpX3BsbF9jb21wdXRlKHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCWRzaV9jbGsgPSBkc2lfY2xrX2Zyb21f
cGNsayhpbnRlbF9kc2ktPnBjbGssIGludGVsX2RzaS0+cGl4ZWxfZm9ybWF0LAo+ICAgCQkJCSAg
ICBpbnRlbF9kc2ktPmxhbmVfY291bnQpOwo+ICAgCj4gLQlyZXQgPSBkc2lfY2FsY19tbnAoZGV2
X3ByaXYsIGNvbmZpZywgZHNpX2Nsayk7Cj4gKwlyZXQgPSBkc2lfY2FsY19tbnAoaTkxNSwgY29u
ZmlnLCBkc2lfY2xrKTsKPiAgIAlpZiAocmV0KSB7Cj4gICAJCURSTV9ERUJVR19LTVMoImRzaV9j
YWxjX21ucCBmYWlsZWRcbiIpOwo+ICAgCQlyZXR1cm4gcmV0Owo+IEBAIC0xNDcsMTUgKzE0Nywx
NSBAQCBpbnQgdmx2X2RzaV9wbGxfY29tcHV0ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKPiAgIHZvaWQgdmx2X2RzaV9wbGxfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyLAo+ICAgCQkJY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNvbmZpZykKPiAgIHsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+
YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVu
Y29kZXItPmJhc2UuZGV2KTsKPiAgIAo+ICAgCURSTV9ERUJVR19LTVMoIlxuIik7Cj4gICAKPiAt
CXZsdl9jY2tfZ2V0KGRldl9wcml2KTsKPiArCXZsdl9jY2tfZ2V0KGk5MTUpOwo+ICAgCj4gLQl2
bHZfY2NrX3dyaXRlKGRldl9wcml2LCBDQ0tfUkVHX0RTSV9QTExfQ09OVFJPTCwgMCk7Cj4gLQl2
bHZfY2NrX3dyaXRlKGRldl9wcml2LCBDQ0tfUkVHX0RTSV9QTExfRElWSURFUiwgY29uZmlnLT5k
c2lfcGxsLmRpdik7Cj4gLQl2bHZfY2NrX3dyaXRlKGRldl9wcml2LCBDQ0tfUkVHX0RTSV9QTExf
Q09OVFJPTCwKPiArCXZsdl9jY2tfd3JpdGUoaTkxNSwgQ0NLX1JFR19EU0lfUExMX0NPTlRST0ws
IDApOwo+ICsJdmx2X2Nja193cml0ZShpOTE1LCBDQ0tfUkVHX0RTSV9QTExfRElWSURFUiwgY29u
ZmlnLT5kc2lfcGxsLmRpdik7Cj4gKwl2bHZfY2NrX3dyaXRlKGk5MTUsIENDS19SRUdfRFNJX1BM
TF9DT05UUk9MLAo+ICAgCQkgICAgICBjb25maWctPmRzaV9wbGwuY3RybCAmIH5EU0lfUExMX1ZD
T19FTik7Cj4gICAKPiAgIAkvKiB3YWl0IGF0IGxlYXN0IDAuNSB1cyBhZnRlciB1bmdhdGluZyBi
ZWZvcmUgZW5hYmxpbmcgVkNPLAo+IEBAIC0xNjMsMzggKzE2MywzOCBAQCB2b2lkIHZsdl9kc2lf
cGxsX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIAkgKi8KPiAgIAl1
c2xlZXBfcmFuZ2UoMTAsIDUwKTsKPiAgIAo+IC0Jdmx2X2Nja193cml0ZShkZXZfcHJpdiwgQ0NL
X1JFR19EU0lfUExMX0NPTlRST0wsIGNvbmZpZy0+ZHNpX3BsbC5jdHJsKTsKPiArCXZsdl9jY2tf
d3JpdGUoaTkxNSwgQ0NLX1JFR19EU0lfUExMX0NPTlRST0wsIGNvbmZpZy0+ZHNpX3BsbC5jdHJs
KTsKPiAgIAo+IC0JaWYgKHdhaXRfZm9yKHZsdl9jY2tfcmVhZChkZXZfcHJpdiwgQ0NLX1JFR19E
U0lfUExMX0NPTlRST0wpICYKPiArCWlmICh3YWl0X2Zvcih2bHZfY2NrX3JlYWQoaTkxNSwgQ0NL
X1JFR19EU0lfUExMX0NPTlRST0wpICYKPiAgIAkJCQkJCURTSV9QTExfTE9DSywgMjApKSB7Cj4g
ICAKPiAtCQl2bHZfY2NrX3B1dChkZXZfcHJpdik7Cj4gKwkJdmx2X2Nja19wdXQoaTkxNSk7Cj4g
ICAJCURSTV9FUlJPUigiRFNJIFBMTCBsb2NrIGZhaWxlZFxuIik7Cj4gICAJCXJldHVybjsKPiAg
IAl9Cj4gLQl2bHZfY2NrX3B1dChkZXZfcHJpdik7Cj4gKwl2bHZfY2NrX3B1dChpOTE1KTsKPiAg
IAo+ICAgCURSTV9ERUJVR19LTVMoIkRTSSBQTEwgbG9ja2VkXG4iKTsKPiAgIH0KPiAgIAo+ICAg
dm9pZCB2bHZfZHNpX3BsbF9kaXNhYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+
ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNv
ZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAgCXUzMiB0bXA7Cj4gICAKPiAgIAlEUk1fREVCVUdf
S01TKCJcbiIpOwo+ICAgCj4gLQl2bHZfY2NrX2dldChkZXZfcHJpdik7Cj4gKwl2bHZfY2NrX2dl
dChpOTE1KTsKPiAgIAo+IC0JdG1wID0gdmx2X2Nja19yZWFkKGRldl9wcml2LCBDQ0tfUkVHX0RT
SV9QTExfQ09OVFJPTCk7Cj4gKwl0bXAgPSB2bHZfY2NrX3JlYWQoaTkxNSwgQ0NLX1JFR19EU0lf
UExMX0NPTlRST0wpOwo+ICAgCXRtcCAmPSB+RFNJX1BMTF9WQ09fRU47Cj4gICAJdG1wIHw9IERT
SV9QTExfTERPX0dBVEU7Cj4gLQl2bHZfY2NrX3dyaXRlKGRldl9wcml2LCBDQ0tfUkVHX0RTSV9Q
TExfQ09OVFJPTCwgdG1wKTsKPiArCXZsdl9jY2tfd3JpdGUoaTkxNSwgQ0NLX1JFR19EU0lfUExM
X0NPTlRST0wsIHRtcCk7Cj4gICAKPiAtCXZsdl9jY2tfcHV0KGRldl9wcml2KTsKPiArCXZsdl9j
Y2tfcHV0KGk5MTUpOwo+ICAgfQo+ICAgCj4gLWJvb2wgYnh0X2RzaV9wbGxfaXNfZW5hYmxlZChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gK2Jvb2wgYnh0X2RzaV9wbGxfaXNf
ZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAlib29sIGVu
YWJsZWQ7Cj4gICAJdTMyIHZhbDsKPiBAQCAtMjE2LDcgKzIxNiw3IEBAIGJvb2wgYnh0X2RzaV9w
bGxfaXNfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJICog
Y2F1c2VzIGEgc3lzdGVtIGhhbmcuCj4gICAJICovCj4gICAJdmFsID0gSTkxNV9SRUFEKEJYVF9E
U0lfUExMX0NUTCk7Cj4gLQlpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpIHsKPiArCWlmIChJ
U19HRU1JTklMQUtFKGk5MTUpKSB7Cj4gICAJCWlmICghKHZhbCAmIEJYVF9EU0lBXzE2WF9NQVNL
KSkgewo+ICAgCQkJRFJNX0RFQlVHX0RSSVZFUigiSW52YWxpZCBQTEwgZGl2aWRlciAoJTA4eClc
biIsIHZhbCk7Cj4gICAJCQllbmFibGVkID0gZmFsc2U7Cj4gQEAgLTIzMyw3ICsyMzMsNyBAQCBi
b29sIGJ4dF9kc2lfcGxsX2lzX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICAgCj4gICB2b2lkIGJ4dF9kc2lfcGxsX2Rpc2FibGUoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gICAJdTMyIHZhbDsKPiAgIAo+
ICAgCURSTV9ERUJVR19LTVMoIlxuIik7Cj4gQEAgLTI0Niw3ICsyNDYsNyBAQCB2b2lkIGJ4dF9k
c2lfcGxsX2Rpc2FibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gICAJICogUExM
IGxvY2sgc2hvdWxkIGRlYXNzZXJ0IHdpdGhpbiAyMDB1cy4KPiAgIAkgKiBXYWl0IHVwIHRvIDFt
cyBiZWZvcmUgdGltaW5nIG91dC4KPiAgIAkgKi8KPiAtCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdp
c3RlcigmZGV2X3ByaXYtPnVuY29yZSwKPiArCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3Rlcigm
aTkxNS0+dW5jb3JlLAo+ICAgCQkJCSAgICBCWFRfRFNJX1BMTF9FTkFCTEUsCj4gICAJCQkJICAg
IEJYVF9EU0lfUExMX0xPQ0tFRCwKPiAgIAkJCQkgICAgMCwKPiBAQCAtMjU3LDIxICsyNTcsMjEg
QEAgdm9pZCBieHRfZHNpX3BsbF9kaXNhYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
KQo+ICAgdTMyIHZsdl9kc2lfZ2V0X3BjbGsoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
Cj4gICAJCSAgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNvbmZpZykKPiAgIHsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5k
ZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBlbmNfdG9faW50
ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiAgIAlpbnQgYnBwID0gbWlwaV9kc2lfcGl4ZWxfZm9y
bWF0X3RvX2JwcChpbnRlbF9kc2ktPnBpeGVsX2Zvcm1hdCk7Cj4gICAJdTMyIGRzaV9jbG9jaywg
cGNsazsKPiAgIAl1MzIgcGxsX2N0bCwgcGxsX2RpdjsKPiAgIAl1MzIgbSA9IDAsIHAgPSAwLCBu
Owo+IC0JaW50IHJlZmNsayA9IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpID8gMTAwMDAwIDogMjUw
MDA7Cj4gKwlpbnQgcmVmY2xrID0gSVNfQ0hFUlJZVklFVyhpOTE1KSA/IDEwMDAwMCA6IDI1MDAw
Owo+ICAgCWludCBpOwo+ICAgCj4gICAJRFJNX0RFQlVHX0tNUygiXG4iKTsKPiAgIAo+IC0Jdmx2
X2Nja19nZXQoZGV2X3ByaXYpOwo+IC0JcGxsX2N0bCA9IHZsdl9jY2tfcmVhZChkZXZfcHJpdiwg
Q0NLX1JFR19EU0lfUExMX0NPTlRST0wpOwo+IC0JcGxsX2RpdiA9IHZsdl9jY2tfcmVhZChkZXZf
cHJpdiwgQ0NLX1JFR19EU0lfUExMX0RJVklERVIpOwo+IC0Jdmx2X2Nja19wdXQoZGV2X3ByaXYp
Owo+ICsJdmx2X2Nja19nZXQoaTkxNSk7Cj4gKwlwbGxfY3RsID0gdmx2X2Nja19yZWFkKGk5MTUs
IENDS19SRUdfRFNJX1BMTF9DT05UUk9MKTsKPiArCXBsbF9kaXYgPSB2bHZfY2NrX3JlYWQoaTkx
NSwgQ0NLX1JFR19EU0lfUExMX0RJVklERVIpOwo+ICsJdmx2X2Nja19wdXQoaTkxNSk7Cj4gICAK
PiAgIAljb25maWctPmRzaV9wbGwuY3RybCA9IHBsbF9jdGwgJiB+RFNJX1BMTF9MT0NLOwo+ICAg
CWNvbmZpZy0+ZHNpX3BsbC5kaXYgPSBwbGxfZGl2Owo+IEBAIC0zMjUsNyArMzI1LDcgQEAgdTMy
IGJ4dF9kc2lfZ2V0X3BjbGsoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJdTMy
IGRzaV9jbGs7Cj4gICAJdTMyIGRzaV9yYXRpbzsKPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRl
bF9kc2kgPSBlbmNfdG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2
KTsKPiAgIAlpbnQgYnBwID0gbWlwaV9kc2lfcGl4ZWxfZm9ybWF0X3RvX2JwcChpbnRlbF9kc2kt
PnBpeGVsX2Zvcm1hdCk7Cj4gICAKPiAgIAljb25maWctPmRzaV9wbGwuY3RybCA9IEk5MTVfUkVB
RChCWFRfRFNJX1BMTF9DVEwpOwo+IEBAIC0zNDMsNyArMzQzLDcgQEAgdTMyIGJ4dF9kc2lfZ2V0
X3BjbGsoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICB2b2lkIHZsdl9kc2lfcmVz
ZXRfY2xvY2tzKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLCBlbnVtIHBvcnQgcG9ydCkK
PiAgIHsKPiAgIAl1MzIgdGVtcDsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1Y3QgaW50ZWxf
ZHNpICppbnRlbF9kc2kgPSBlbmNfdG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiAgIAo+
ICAgCXRlbXAgPSBJOTE1X1JFQUQoTUlQSV9DVFJMKHBvcnQpKTsKPiBAQCAtMzU2LDcgKzM1Niw3
IEBAIHZvaWQgdmx2X2RzaV9yZXNldF9jbG9ja3Moc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsIGVudW0gcG9ydCBwb3J0KQo+ICAgc3RhdGljIHZvaWQgZ2xrX2RzaV9wcm9ncmFtX2VzY19j
bG9jayhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ICAgCQkJCSAgIGNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjb25maWcpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoZGV2KTsKPiAgIAl1MzIgZHNpX3JhdGUgPSAwOwo+ICAgCXUzMiBwbGxfcmF0
aW8gPSAwOwo+ICAgCXUzMiBkZHJfY2xrID0gMDsKPiBAQCAtNDA0LDcgKzQwNCw3IEBAIHN0YXRp
YyB2b2lkIGdsa19kc2lfcHJvZ3JhbV9lc2NfY2xvY2soc3RydWN0IGRybV9kZXZpY2UgKmRldiwK
PiAgIHN0YXRpYyB2b2lkIGJ4dF9kc2lfcHJvZ3JhbV9jbG9ja3Moc3RydWN0IGRybV9kZXZpY2Ug
KmRldiwgZW51bSBwb3J0IHBvcnQsCj4gICAJCQkJICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNvbmZpZykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShkZXYpOwo+ICAgCXUzMiB0bXA7Cj4gICAJdTMyIGRzaV9yYXRlID0gMDsKPiAgIAl1MzIg
cGxsX3JhdGlvID0gMDsKPiBAQCAtNDU3LDcgKzQ1Nyw3IEBAIHN0YXRpYyB2b2lkIGJ4dF9kc2lf
cHJvZ3JhbV9jbG9ja3Moc3RydWN0IGRybV9kZXZpY2UgKmRldiwgZW51bSBwb3J0IHBvcnQsCj4g
ICBpbnQgYnh0X2RzaV9wbGxfY29tcHV0ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwK
PiAgIAkJCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjb25maWcpCj4gICB7Cj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsK
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNl
LmRldik7Cj4gICAJc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2Rz
aSgmZW5jb2Rlci0+YmFzZSk7Cj4gICAJdTggZHNpX3JhdGlvLCBkc2lfcmF0aW9fbWluLCBkc2lf
cmF0aW9fbWF4Owo+ICAgCXUzMiBkc2lfY2xrOwo+IEBAIC00NzIsNyArNDcyLDcgQEAgaW50IGJ4
dF9kc2lfcGxsX2NvbXB1dGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJICov
Cj4gICAJZHNpX3JhdGlvID0gRElWX1JPVU5EX1VQKGRzaV9jbGsgKiAyLCBCWFRfUkVGX0NMT0NL
X0tIWik7Cj4gICAKPiAtCWlmIChJU19CUk9YVE9OKGRldl9wcml2KSkgewo+ICsJaWYgKElTX0JS
T1hUT04oaTkxNSkpIHsKPiAgIAkJZHNpX3JhdGlvX21pbiA9IEJYVF9EU0lfUExMX1JBVElPX01J
TjsKPiAgIAkJZHNpX3JhdGlvX21heCA9IEJYVF9EU0lfUExMX1JBVElPX01BWDsKPiAgIAl9IGVs
c2Ugewo+IEBAIC00OTYsNyArNDk2LDcgQEAgaW50IGJ4dF9kc2lfcGxsX2NvbXB1dGUoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gICAJLyogQXMgcGVyIHJlY29tbWVuZGF0aW9uIGZy
b20gaGFyZHdhcmUgdGVhbSwKPiAgIAkgKiBQcm9nIFBWRCByYXRpbyA9MSBpZiBkc2kgcmF0aW8g
PD0gNTAKPiAgIAkgKi8KPiAtCWlmIChJU19CUk9YVE9OKGRldl9wcml2KSAmJiBkc2lfcmF0aW8g
PD0gNTApCj4gKwlpZiAoSVNfQlJPWFRPTihpOTE1KSAmJiBkc2lfcmF0aW8gPD0gNTApCj4gICAJ
CWNvbmZpZy0+ZHNpX3BsbC5jdHJsIHw9IEJYVF9EU0lfUExMX1BWRF9SQVRJT18xOwo+ICAgCj4g
ICAJcmV0dXJuIDA7Cj4gQEAgLTUwNSw3ICs1MDUsNyBAQCBpbnQgYnh0X2RzaV9wbGxfY29tcHV0
ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgIHZvaWQgYnh0X2RzaV9wbGxfZW5h
YmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAgCQkJY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNvbmZpZykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgIAlzdHJ1
Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBlbmNfdG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNl
KTsKPiAgIAllbnVtIHBvcnQgcG9ydDsKPiAgIAl1MzIgdmFsOwo+IEBAIC01MTcsNyArNTE3LDcg
QEAgdm9pZCBieHRfZHNpX3BsbF9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
Cj4gICAJUE9TVElOR19SRUFEKEJYVF9EU0lfUExMX0NUTCk7Cj4gICAKPiAgIAkvKiBQcm9ncmFt
IFRYLCBSWCwgRHBoeSBjbG9ja3MgKi8KPiAtCWlmIChJU19CUk9YVE9OKGRldl9wcml2KSkgewo+
ICsJaWYgKElTX0JST1hUT04oaTkxNSkpIHsKPiAgIAkJZm9yX2VhY2hfZHNpX3BvcnQocG9ydCwg
aW50ZWxfZHNpLT5wb3J0cykKPiAgIAkJCWJ4dF9kc2lfcHJvZ3JhbV9jbG9ja3MoZW5jb2Rlci0+
YmFzZS5kZXYsIHBvcnQsIGNvbmZpZyk7Cj4gICAJfSBlbHNlIHsKPiBAQCAtNTMwLDcgKzUzMCw3
IEBAIHZvaWQgYnh0X2RzaV9wbGxfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ICAgCUk5MTVfV1JJVEUoQlhUX0RTSV9QTExfRU5BQkxFLCB2YWwpOwo+ICAgCj4gICAJLyog
VGltZW91dCBhbmQgZmFpbCBpZiBQTEwgbm90IGxvY2tlZCAqLwo+IC0JaWYgKGludGVsX3dhaXRf
Zm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLAo+ICsJaWYgKGludGVsX3dhaXRfZm9yX3Jl
Z2lzdGVyKCZpOTE1LT51bmNvcmUsCj4gICAJCQkJICAgIEJYVF9EU0lfUExMX0VOQUJMRSwKPiAg
IAkJCQkgICAgQlhUX0RTSV9QTExfTE9DS0VELAo+ICAgCQkJCSAgICBCWFRfRFNJX1BMTF9MT0NL
RUQsCj4gQEAgLTU0NiwxMCArNTQ2LDEwIEBAIHZvaWQgYnh0X2RzaV9yZXNldF9jbG9ja3Moc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsIGVudW0gcG9ydCBwb3J0KQo+ICAgewo+ICAgCXUz
MiB0bXA7Cj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGVuY29kZXItPmJhc2UuZGV2Owo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAKPiAgIAkv
KiBDbGVhciBvbGQgY29uZmlndXJhdGlvbnMgKi8KPiAtCWlmIChJU19CUk9YVE9OKGRldl9wcml2
KSkgewo+ICsJaWYgKElTX0JST1hUT04oaTkxNSkpIHsKPiAgIAkJdG1wID0gSTkxNV9SRUFEKEJY
VF9NSVBJX0NMT0NLX0NUTCk7Cj4gICAJCXRtcCAmPSB+KEJYVF9NSVBJX1RYX0VTQ0xLX0ZJWERJ
Vl9NQVNLKHBvcnQpKTsKPiAgIAkJdG1wICY9IH4oQlhUX01JUElfUlhfRVNDTEtfVVBQRVJfRklY
RElWX01BU0socG9ydCkpOwo+IApfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVz
a3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9p
bnRlbC1nZng=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id E5F4D1036AB
	for <lists+intel-gfx@lfdr.de>; Wed, 20 Nov 2019 10:33:28 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 12D236E13A;
	Wed, 20 Nov 2019 09:33:27 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1A1BB6E127
 for <intel-gfx@lists.freedesktop.org>; Wed, 20 Nov 2019 09:33:13 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19267947-1500050 
 for multiple; Wed, 20 Nov 2019 09:33:05 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 20 Nov 2019 09:32:57 +0000
Message-Id: <20191120093302.3723715-4-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191120093302.3723715-1-chris@chris-wilson.co.uk>
References: <20191120093302.3723715-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 4/9] drm/i915: Mark up the calling context for
 intel_wakeref_put()
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UHJldmlvdXNseSwgd2UgYXNzdW1lZCB3ZSBjb3VsZCB1c2UgbXV0ZXhfdHJ5bG9jaygpIHdpdGhp
biBhbiBhdG9taWMKY29udGV4dCwgZmFsbGluZyBiYWNrIHRvIGEgd29ya2VyIGlmIGNvbnRlbmRl
ZC4gSG93ZXZlciwgc3VjaCB0cmlja2VyeQppcyBpbGxlZ2FsIGluc2lkZSBpbnRlcnJ1cHQgY29u
dGV4dCwgYW5kIHNvIHdlIG5lZWQgdG8gYWx3YXlzIHVzZSBhCndvcmtlciB1bmRlciBzdWNoIGNp
cmN1bXN0YW5jZXMuIEFzIHdlIG5vcm1hbGx5IGFyZSBpbiBwcm9jZXNzIGNvbnRleHQsCndlIGNh
biB0eXBpY2FsbHkgdXNlIGEgcGxhaW4gbXV0ZXgsIGFuZCBvbmx5IGRlZmVyIHRvIGEgd29yayB3
aGVuIHdlCmtub3cgd2UgYXJlIGNhbGxlciBmcm9tIGFuIGludGVycnVwdCBwYXRoLgoKRml4ZXM6
IDUxZmJkOGRlODdkYyAoImRybS9pOTE1L3BtdTogQXRvbWljYWxseSBhY3F1aXJlIHRoZSBndF9w
bSB3YWtlcmVmIikKUmVmZXJlbmNlczogYTA4NTVkMjRmYzIyZCAoImxvY2tpbmcvbXV0ZXg6IENv
bXBsYWluIHVwb24gbXV0ZXggQVBJIG1pc3VzZSBpbiBJUlEgY29udGV4dHMiKQpSZWZlcmVuY2Vz
OiBodHRwczovL2J1Z3MuZnJlZWRlc2t0b3Aub3JnL3Nob3dfYnVnLmNnaT9pZD0xMTE2MjYKU2ln
bmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+CkNjOiBU
dnJ0a28gVXJzdWxpbiA8dHZydGtvLnVyc3VsaW5AaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5jICAgIHwgIDMgKy0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5oICAgIHwgMTAgKysrKysrKwogZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYyAgICAgICAgfCAgMSAtCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9ndF9wbS5oICAgICAgICB8ICA1ICsrKysKIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2xyYy5jICAgICAgICAgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX3Jlc2V0LmMgICAgICAgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L3NlbGZ0ZXN0X2VuZ2luZV9wbS5jIHwgIDcgKysrLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfYWN0aXZlLmMgICAgICAgICAgIHwgIDUgKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9wbXUuYyAgICAgICAgICAgICAgfCAgNiArKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF93YWtlcmVmLmMgICAgICAgICB8ICA4ICsrKy0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50
ZWxfd2FrZXJlZi5oICAgICAgICAgfCAzMCArKysrKysrKysrKysrKy0tLS0tLQogMTEgZmlsZXMg
Y2hhbmdlZCwgNTQgaW5zZXJ0aW9ucygrKSwgMjUgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uYwppbmRleCAxZjUxNzM1N2EyNjguLmYzMDM1YjNh
YjlmYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bt
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMKQEAgLTIx
MCw3ICsyMTAsOCBAQCBzdGF0aWMgaW50IF9fZW5naW5lX3Bhcmsoc3RydWN0IGludGVsX3dha2Vy
ZWYgKndmKQogCiAJZW5naW5lLT5leGVjbGlzdHMubm9fcHJpb2xpc3QgPSBmYWxzZTsKIAotCWlu
dGVsX2d0X3BtX3B1dChlbmdpbmUtPmd0KTsKKwkvKiBXaGlsZSB3ZSBjYWxsIGk5MTVfdm1hX3Bh
cmtlZCwgd2UgaGF2ZSB0byBicmVhayB0aGUgbG9jayBjeWNsZSAqLworCWludGVsX2d0X3BtX3B1
dF9hc3luYyhlbmdpbmUtPmd0KTsKIAlyZXR1cm4gMDsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9lbmdpbmVfcG0uaAppbmRleCA3MzljNTBmZWZjZWYuLjI0ZTIwMzQ0ZGMyMiAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmgKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmgKQEAgLTMxLDYgKzMx
LDE2IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9lbmdpbmVfcG1fcHV0KHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSkKIAlpbnRlbF93YWtlcmVmX3B1dCgmZW5naW5lLT53YWtlcmVm
KTsKIH0KIAorc3RhdGljIGlubGluZSB2b2lkIGludGVsX2VuZ2luZV9wbV9wdXRfYXN5bmMoc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCWludGVsX3dha2VyZWZfcHV0X2FzeW5j
KCZlbmdpbmUtPndha2VyZWYpOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQgaW50ZWxfZW5naW5l
X3BtX2ZsdXNoKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlpbnRlbF93YWtl
cmVmX3VubG9ja193YWl0KCZlbmdpbmUtPndha2VyZWYpOworfQorCiB2b2lkIGludGVsX2VuZ2lu
ZV9pbml0X19wbShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpOwogCiAjZW5kaWYgLyog
SU5URUxfRU5HSU5FX1BNX0ggKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2d0X3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9wbS5jCmlu
ZGV4IDQ3MGZiZGMzMGU1YS4uZjZiNTE2OWQ2MjNmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9ndF9wbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2d0X3BtLmMKQEAgLTEwNSw3ICsxMDUsNiBAQCBzdGF0aWMgaW50IF9fZ3RfcGFyayhzdHJ1
Y3QgaW50ZWxfd2FrZXJlZiAqd2YpCiBzdGF0aWMgY29uc3Qgc3RydWN0IGludGVsX3dha2VyZWZf
b3BzIHdmX29wcyA9IHsKIAkuZ2V0ID0gX19ndF91bnBhcmssCiAJLnB1dCA9IF9fZ3RfcGFyaywK
LQkuZmxhZ3MgPSBJTlRFTF9XQUtFUkVGX1BVVF9BU1lOQywKIH07CiAKIHZvaWQgaW50ZWxfZ3Rf
cG1faW5pdF9lYXJseShzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2d0X3BtLmgKaW5kZXggYjNlMTczOTliZTliLi45OTBlZmMyN2E0ZTQgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3BtLmgKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uaApAQCAtMzIsNiArMzIsMTEgQEAgc3RhdGljIGlubGlu
ZSB2b2lkIGludGVsX2d0X3BtX3B1dChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogCWludGVsX3dha2Vy
ZWZfcHV0KCZndC0+d2FrZXJlZik7CiB9CiAKK3N0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9ndF9w
bV9wdXRfYXN5bmMoc3RydWN0IGludGVsX2d0ICpndCkKK3sKKwlpbnRlbF93YWtlcmVmX3B1dF9h
c3luYygmZ3QtPndha2VyZWYpOworfQorCiBzdGF0aWMgaW5saW5lIGludCBpbnRlbF9ndF9wbV93
YWl0X2Zvcl9pZGxlKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7CiAJcmV0dXJuIGludGVsX3dha2Vy
ZWZfd2FpdF9mb3JfaWRsZSgmZ3QtPndha2VyZWYpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9s
cmMuYwppbmRleCAzM2NlMjU4ZDQ4NGYuLmI2NWJjMDY4NTViMCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfbHJjLmMKQEAgLTExNzIsNyArMTE3Miw3IEBAIF9fZXhlY2xpc3RzX3NjaGVkdWxl
X291dChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKIAogCWludGVsX2VuZ2luZV9jb250ZXh0X291
dChlbmdpbmUpOwogCWV4ZWNsaXN0c19jb250ZXh0X3N0YXR1c19jaGFuZ2UocnEsIElOVEVMX0NP
TlRFWFRfU0NIRURVTEVfT1VUKTsKLQlpbnRlbF9ndF9wbV9wdXQoZW5naW5lLT5ndCk7CisJaW50
ZWxfZ3RfcG1fcHV0X2FzeW5jKGVuZ2luZS0+Z3QpOwogCiAJLyoKIAkgKiBJZiB0aGlzIGlzIHBh
cnQgb2YgYSB2aXJ0dWFsIGVuZ2luZSwgaXRzIG5leHQgcmVxdWVzdCBtYXkKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9yZXNldC5jCmluZGV4IGI3MDA3Y2Q3OGM2Zi4uMDM4OGY5Mzc1MzY2IDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMKQEAgLTExMjUsNyArMTEyNSw3IEBA
IGludCBpbnRlbF9lbmdpbmVfcmVzZXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBj
b25zdCBjaGFyICptc2cpCiBvdXQ6CiAJaW50ZWxfZW5naW5lX2NhbmNlbF9zdG9wX2NzKGVuZ2lu
ZSk7CiAJcmVzZXRfZmluaXNoX2VuZ2luZShlbmdpbmUpOwotCWludGVsX2VuZ2luZV9wbV9wdXQo
ZW5naW5lKTsKKwlpbnRlbF9lbmdpbmVfcG1fcHV0X2FzeW5jKGVuZ2luZSk7CiAJcmV0dXJuIHJl
dDsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfZW5n
aW5lX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9lbmdpbmVfcG0uYwpp
bmRleCAyMGI5YzgzZjQzYWQuLmNiZjZiMDczNTI3MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfZW5naW5lX3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Qvc2VsZnRlc3RfZW5naW5lX3BtLmMKQEAgLTUxLDExICs1MSwxMiBAQCBzdGF0aWMgaW50
IGxpdmVfZW5naW5lX3BtKHZvaWQgKmFyZykKIAkJCQlwcl9lcnIoImludGVsX2VuZ2luZV9wbV9n
ZXRfaWZfYXdha2UoJXMpIGZhaWxlZCB1bmRlciAlc1xuIiwKIAkJCQkgICAgICAgZW5naW5lLT5u
YW1lLCBwLT5uYW1lKTsKIAkJCWVsc2UKLQkJCQlpbnRlbF9lbmdpbmVfcG1fcHV0KGVuZ2luZSk7
Ci0JCQlpbnRlbF9lbmdpbmVfcG1fcHV0KGVuZ2luZSk7CisJCQkJaW50ZWxfZW5naW5lX3BtX3B1
dF9hc3luYyhlbmdpbmUpOworCQkJaW50ZWxfZW5naW5lX3BtX3B1dF9hc3luYyhlbmdpbmUpOwog
CQkJcC0+Y3JpdGljYWxfc2VjdGlvbl9lbmQoKTsKIAotCQkJLyogZW5naW5lIHdha2VyZWYgaXMg
c3luYyAoaW5zdGFudCkgKi8KKwkJCWludGVsX2VuZ2luZV9wbV9mbHVzaChlbmdpbmUpOworCiAJ
CQlpZiAoaW50ZWxfZW5naW5lX3BtX2lzX2F3YWtlKGVuZ2luZSkpIHsKIAkJCQlwcl9lcnIoIiVz
IGlzIHN0aWxsIGF3YWtlIGFmdGVyIGZsdXNoaW5nIHBtXG4iLAogCQkJCSAgICAgICBlbmdpbmUt
Pm5hbWUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMKaW5kZXggNTQ0OGYzN2M4MTAyLi5k
Y2ExNWFjZTg4ZjYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZl
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuYwpAQCAtNjcyLDEyICs2
NzIsMTMgQEAgdm9pZCBpOTE1X2FjdGl2ZV9hY3F1aXJlX2JhcnJpZXIoc3RydWN0IGk5MTVfYWN0
aXZlICpyZWYpCiAJICogcG9wdWxhdGVkIGJ5IGk5MTVfcmVxdWVzdF9hZGRfYWN0aXZlX2JhcnJp
ZXJzKCkgdG8gcG9pbnQgdG8gdGhlCiAJICogcmVxdWVzdCB0aGF0IHdpbGwgZXZlbnR1YWxseSBy
ZWxlYXNlIHRoZW0uCiAJICovCi0Jc3Bpbl9sb2NrX2lycXNhdmVfbmVzdGVkKCZyZWYtPnRyZWVf
bG9jaywgZmxhZ3MsIFNJTkdMRV9ERVBUSF9ORVNUSU5HKTsKIAlsbGlzdF9mb3JfZWFjaF9zYWZl
KHBvcywgbmV4dCwgdGFrZV9wcmVhbGxvY2F0ZWRfYmFycmllcnMocmVmKSkgewogCQlzdHJ1Y3Qg
YWN0aXZlX25vZGUgKm5vZGUgPSBiYXJyaWVyX2Zyb21fbGwocG9zKTsKIAkJc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lID0gYmFycmllcl90b19lbmdpbmUobm9kZSk7CiAJCXN0cnVjdCBy
Yl9ub2RlICoqcCwgKnBhcmVudDsKIAorCQlzcGluX2xvY2tfaXJxc2F2ZV9uZXN0ZWQoJnJlZi0+
dHJlZV9sb2NrLCBmbGFncywKKwkJCQkJIFNJTkdMRV9ERVBUSF9ORVNUSU5HKTsKIAkJcGFyZW50
ID0gTlVMTDsKIAkJcCA9ICZyZWYtPnRyZWUucmJfbm9kZTsKIAkJd2hpbGUgKCpwKSB7CkBAIC02
OTMsMTIgKzY5NCwxMiBAQCB2b2lkIGk5MTVfYWN0aXZlX2FjcXVpcmVfYmFycmllcihzdHJ1Y3Qg
aTkxNV9hY3RpdmUgKnJlZikKIAkJfQogCQlyYl9saW5rX25vZGUoJm5vZGUtPm5vZGUsIHBhcmVu
dCwgcCk7CiAJCXJiX2luc2VydF9jb2xvcigmbm9kZS0+bm9kZSwgJnJlZi0+dHJlZSk7CisJCXNw
aW5fdW5sb2NrX2lycXJlc3RvcmUoJnJlZi0+dHJlZV9sb2NrLCBmbGFncyk7CiAKIAkJR0VNX0JV
R19PTighaW50ZWxfZW5naW5lX3BtX2lzX2F3YWtlKGVuZ2luZSkpOwogCQlsbGlzdF9hZGQoYmFy
cmllcl90b19sbChub2RlKSwgJmVuZ2luZS0+YmFycmllcl90YXNrcyk7CiAJCWludGVsX2VuZ2lu
ZV9wbV9wdXQoZW5naW5lKTsKIAl9Ci0Jc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmcmVmLT50cmVl
X2xvY2ssIGZsYWdzKTsKIH0KIAogdm9pZCBpOTE1X3JlcXVlc3RfYWRkX2FjdGl2ZV9iYXJyaWVy
cyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfcG11LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5jCmluZGV4IDli
MDJiZTBhZDRlNi4uOTVlODI0YTc4ZDRkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3BtdS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11LmMKQEAgLTE5
MCw3ICsxOTAsNyBAQCBzdGF0aWMgdTY0IGdldF9yYzYoc3RydWN0IGludGVsX2d0ICpndCkKIAl2
YWwgPSAwOwogCWlmIChpbnRlbF9ndF9wbV9nZXRfaWZfYXdha2UoZ3QpKSB7CiAJCXZhbCA9IF9f
Z2V0X3JjNihndCk7Ci0JCWludGVsX2d0X3BtX3B1dChndCk7CisJCWludGVsX2d0X3BtX3B1dF9h
c3luYyhndCk7CiAJfQogCiAJc3Bpbl9sb2NrX2lycXNhdmUoJnBtdS0+bG9jaywgZmxhZ3MpOwpA
QCAtMzYwLDcgKzM2MCw3IEBAIGVuZ2luZXNfc2FtcGxlKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIHVu
c2lnbmVkIGludCBwZXJpb2RfbnMpCiBza2lwOgogCQlpZiAodW5saWtlbHkobW1pb19sb2NrKSkK
IAkJCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUobW1pb19sb2NrLCBmbGFncyk7Ci0JCWludGVsX2Vu
Z2luZV9wbV9wdXQoZW5naW5lKTsKKwkJaW50ZWxfZW5naW5lX3BtX3B1dF9hc3luYyhlbmdpbmUp
OwogCX0KIH0KIApAQCAtMzk4LDcgKzM5OCw3IEBAIGZyZXF1ZW5jeV9zYW1wbGUoc3RydWN0IGlu
dGVsX2d0ICpndCwgdW5zaWduZWQgaW50IHBlcmlvZF9ucykKIAkJCWlmIChzdGF0KQogCQkJCXZh
bCA9IGludGVsX2dldF9jYWdmKHJwcywgc3RhdCk7CiAKLQkJCWludGVsX2d0X3BtX3B1dChndCk7
CisJCQlpbnRlbF9ndF9wbV9wdXRfYXN5bmMoZ3QpOwogCQl9CiAKIAkJYWRkX3NhbXBsZV9tdWx0
KCZwbXUtPnNhbXBsZVtfX0k5MTVfU0FNUExFX0ZSRVFfQUNUXSwKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX3dha2VyZWYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX3dha2VyZWYuYwppbmRleCBhZDI2ZDdmNGNhM2QuLjU5YWExYjZmMTgyNyAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfd2FrZXJlZi5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX3dha2VyZWYuYwpAQCAtNTQsNyArNTQsOCBAQCBpbnQgX19pbnRlbF93
YWtlcmVmX2dldF9maXJzdChzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2YpCiAKIHN0YXRpYyB2b2lk
IF9fX19pbnRlbF93YWtlcmVmX3B1dF9sYXN0KHN0cnVjdCBpbnRlbF93YWtlcmVmICp3ZikKIHsK
LQlpZiAoIWF0b21pY19kZWNfYW5kX3Rlc3QoJndmLT5jb3VudCkpCisJSU5URUxfV0FLRVJFRl9C
VUdfT04oYXRvbWljX3JlYWQoJndmLT5jb3VudCkgPD0gMCk7CisJaWYgKHVubGlrZWx5KCFhdG9t
aWNfZGVjX2FuZF90ZXN0KCZ3Zi0+Y291bnQpKSkKIAkJZ290byB1bmxvY2s7CiAKIAkvKiBvcHMt
PnB1dCgpIG11c3QgcmVzY2hlZHVsZSBpdHMgb3duIHJlbGVhc2Ugb24gZXJyb3IvZGVmZXJyYWwg
Ki8KQEAgLTY3LDEzICs2OCwxMiBAQCBzdGF0aWMgdm9pZCBfX19faW50ZWxfd2FrZXJlZl9wdXRf
bGFzdChzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2YpCiAJbXV0ZXhfdW5sb2NrKCZ3Zi0+bXV0ZXgp
OwogfQogCi12b2lkIF9faW50ZWxfd2FrZXJlZl9wdXRfbGFzdChzdHJ1Y3QgaW50ZWxfd2FrZXJl
ZiAqd2YpCit2b2lkIF9faW50ZWxfd2FrZXJlZl9wdXRfbGFzdChzdHJ1Y3QgaW50ZWxfd2FrZXJl
ZiAqd2YsIHVuc2lnbmVkIGxvbmcgZmxhZ3MpCiB7CiAJSU5URUxfV0FLRVJFRl9CVUdfT04od29y
a19wZW5kaW5nKCZ3Zi0+d29yaykpOwogCiAJLyogQXNzdW1lIHdlIGFyZSBub3QgaW4gcHJvY2Vz
cyBjb250ZXh0IGFuZCBzbyBjYW5ub3Qgc2xlZXAuICovCi0JaWYgKHdmLT5vcHMtPmZsYWdzICYg
SU5URUxfV0FLRVJFRl9QVVRfQVNZTkMgfHwKLQkgICAgIW11dGV4X3RyeWxvY2soJndmLT5tdXRl
eCkpIHsKKwlpZiAoZmxhZ3MgJiBJTlRFTF9XQUtFUkVGX1BVVF9BU1lOQyB8fCAhbXV0ZXhfdHJ5
bG9jaygmd2YtPm11dGV4KSkgewogCQlzY2hlZHVsZV93b3JrKCZ3Zi0+d29yayk7CiAJCXJldHVy
bjsKIAl9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF93YWtlcmVmLmgg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF93YWtlcmVmLmgKaW5kZXggYWZmZTRkZTM3NDZi
Li5kYTZlOGZkNTA2ZTYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3dh
a2VyZWYuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF93YWtlcmVmLmgKQEAgLTks
NiArOSw3IEBACiAKICNpbmNsdWRlIDxsaW51eC9hdG9taWMuaD4KICNpbmNsdWRlIDxsaW51eC9i
aXRzLmg+CisjaW5jbHVkZSA8bGludXgvbG9ja2RlcC5oPgogI2luY2x1ZGUgPGxpbnV4L211dGV4
Lmg+CiAjaW5jbHVkZSA8bGludXgvcmVmY291bnQuaD4KICNpbmNsdWRlIDxsaW51eC9zdGFja2Rl
cG90Lmg+CkBAIC0yOSw5ICszMCw2IEBAIHR5cGVkZWYgZGVwb3Rfc3RhY2tfaGFuZGxlX3QgaW50
ZWxfd2FrZXJlZl90Owogc3RydWN0IGludGVsX3dha2VyZWZfb3BzIHsKIAlpbnQgKCpnZXQpKHN0
cnVjdCBpbnRlbF93YWtlcmVmICp3Zik7CiAJaW50ICgqcHV0KShzdHJ1Y3QgaW50ZWxfd2FrZXJl
ZiAqd2YpOwotCi0JdW5zaWduZWQgbG9uZyBmbGFnczsKLSNkZWZpbmUgSU5URUxfV0FLRVJFRl9Q
VVRfQVNZTkMgQklUKDApCiB9OwogCiBzdHJ1Y3QgaW50ZWxfd2FrZXJlZiB7CkBAIC01Nyw3ICs1
NSw3IEBAIHZvaWQgX19pbnRlbF93YWtlcmVmX2luaXQoc3RydWN0IGludGVsX3dha2VyZWYgKndm
LAogfSB3aGlsZSAoMCkKIAogaW50IF9faW50ZWxfd2FrZXJlZl9nZXRfZmlyc3Qoc3RydWN0IGlu
dGVsX3dha2VyZWYgKndmKTsKLXZvaWQgX19pbnRlbF93YWtlcmVmX3B1dF9sYXN0KHN0cnVjdCBp
bnRlbF93YWtlcmVmICp3Zik7Cit2b2lkIF9faW50ZWxfd2FrZXJlZl9wdXRfbGFzdChzdHJ1Y3Qg
aW50ZWxfd2FrZXJlZiAqd2YsIHVuc2lnbmVkIGxvbmcgZmxhZ3MpOwogCiAvKioKICAqIGludGVs
X3dha2VyZWZfZ2V0OiBBY3F1aXJlIHRoZSB3YWtlcmVmCkBAIC0xMDAsMTAgKzk4LDkgQEAgaW50
ZWxfd2FrZXJlZl9nZXRfaWZfYWN0aXZlKHN0cnVjdCBpbnRlbF93YWtlcmVmICp3ZikKIH0KIAog
LyoqCi0gKiBpbnRlbF93YWtlcmVmX3B1dDogUmVsZWFzZSB0aGUgd2FrZXJlZgotICogQGk5MTU6
IHRoZSBkcm1faTkxNV9wcml2YXRlIGRldmljZQorICogaW50ZWxfd2FrZXJlZl9wdXRfZmxhZ3M6
IFJlbGVhc2UgdGhlIHdha2VyZWYKICAqIEB3ZjogdGhlIHdha2VyZWYKLSAqIEBmbjogY2FsbGJh
Y2sgZm9yIHJlbGVhc2luZyB0aGUgd2FrZXJlZiwgY2FsbGVkIG9ubHkgb24gZmluYWwgcmVsZWFz
ZS4KKyAqIEBmbGFnczogY29udHJvbCBmbGFncwogICoKICAqIFJlbGVhc2Ugb3VyIGhvbGQgb24g
dGhlIHdha2VyZWYuIFdoZW4gdGhlcmUgYXJlIG5vIG1vcmUgdXNlcnMsCiAgKiB0aGUgcnVudGlt
ZSBwbSB3YWtlcmVmIHdpbGwgYmUgcmVsZWFzZWQgYWZ0ZXIgdGhlIEBmbiBjYWxsYmFjayBpcyBj
YWxsZWQKQEAgLTExNiwxMSArMTEzLDI1IEBAIGludGVsX3dha2VyZWZfZ2V0X2lmX2FjdGl2ZShz
dHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2YpCiAgKiBjb2RlIG90aGVyd2lzZS4KICAqLwogc3RhdGlj
IGlubGluZSB2b2lkCi1pbnRlbF93YWtlcmVmX3B1dChzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2Yp
CitfX2ludGVsX3dha2VyZWZfcHV0KHN0cnVjdCBpbnRlbF93YWtlcmVmICp3ZiwgdW5zaWduZWQg
bG9uZyBmbGFncykKKyNkZWZpbmUgSU5URUxfV0FLRVJFRl9QVVRfQVNZTkMgQklUKDApCiB7CiAJ
SU5URUxfV0FLRVJFRl9CVUdfT04oYXRvbWljX3JlYWQoJndmLT5jb3VudCkgPD0gMCk7CiAJaWYg
KHVubGlrZWx5KCFhdG9taWNfYWRkX3VubGVzcygmd2YtPmNvdW50LCAtMSwgMSkpKQotCQlfX2lu
dGVsX3dha2VyZWZfcHV0X2xhc3Qod2YpOworCQlfX2ludGVsX3dha2VyZWZfcHV0X2xhc3Qod2Ys
IGZsYWdzKTsKK30KKworc3RhdGljIGlubGluZSB2b2lkCitpbnRlbF93YWtlcmVmX3B1dChzdHJ1
Y3QgaW50ZWxfd2FrZXJlZiAqd2YpCit7CisJbWlnaHRfc2xlZXAoKTsKKwlfX2ludGVsX3dha2Vy
ZWZfcHV0KHdmLCAwKTsKK30KKworc3RhdGljIGlubGluZSB2b2lkCitpbnRlbF93YWtlcmVmX3B1
dF9hc3luYyhzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2YpCit7CisJX19pbnRlbF93YWtlcmVmX3B1
dCh3ZiwgSU5URUxfV0FLRVJFRl9QVVRfQVNZTkMpOwogfQogCiAvKioKQEAgLTE4NSw2ICsxOTYs
NyBAQCBpbnRlbF93YWtlcmVmX2lzX2FjdGl2ZShjb25zdCBzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAq
d2YpCiBzdGF0aWMgaW5saW5lIHZvaWQKIF9faW50ZWxfd2FrZXJlZl9kZWZlcl9wYXJrKHN0cnVj
dCBpbnRlbF93YWtlcmVmICp3ZikKIHsKKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZ3Zi0+bXV0ZXgp
OwogCUlOVEVMX1dBS0VSRUZfQlVHX09OKGF0b21pY19yZWFkKCZ3Zi0+Y291bnQpKTsKIAlhdG9t
aWNfc2V0X3JlbGVhc2UoJndmLT5jb3VudCwgMSk7CiB9Ci0tIAoyLjI0LjAKCl9fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxp
c3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNr
dG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

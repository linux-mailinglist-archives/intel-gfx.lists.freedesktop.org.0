Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 57B4126788
	for <lists+intel-gfx@lfdr.de>; Wed, 22 May 2019 17:57:54 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 740D189C63;
	Wed, 22 May 2019 15:57:50 +0000 (UTC)
X-Original-To: Intel-gfx@lists.freedesktop.org
Delivered-To: Intel-gfx@lists.freedesktop.org
Received: from mga18.intel.com (mga18.intel.com [134.134.136.126])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A7A7289C49;
 Wed, 22 May 2019 15:57:40 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga005.fm.intel.com ([10.253.24.32])
 by orsmga106.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 22 May 2019 08:57:40 -0700
X-ExtLoop1: 1
Received: from dmironox-mobl5.ccr.corp.intel.com (HELO localhost.localdomain)
 ([10.252.20.122])
 by fmsmga005.fm.intel.com with ESMTP; 22 May 2019 08:57:39 -0700
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
To: igt-dev@lists.freedesktop.org
Date: Wed, 22 May 2019 16:57:14 +0100
Message-Id: <20190522155720.28723-10-tvrtko.ursulin@linux.intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190522155720.28723-1-tvrtko.ursulin@linux.intel.com>
References: <20190522155720.28723-1-tvrtko.ursulin@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t 09/15] gem_wsim: Per context SSEU control
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Intel-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KCkEgbmV3IHdv
cmtsb2FkIGNvbW1hbmQgKCdTJykgaXMgYWRkZWQgd2hpY2ggYWxsb3dzIHBlciBjb250ZXh0IHNs
aWNlCihyZS0pY29uZmlndXJhdGlvbi4KCnYyOgogKiBPbmx5IHF1ZXJ5IGRldmljZSBTU0VVIG9u
IGZpcnN0IHVzZS4gKENocmlzKQoKU2lnbmVkLW9mZi1ieTogVHZydGtvIFVyc3VsaW4gPHR2cnRr
by51cnN1bGluQGludGVsLmNvbT4KUmV2aWV3ZWQtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hy
aXMtd2lsc29uLmNvLnVrPgotLS0KIGJlbmNobWFya3MvZ2VtX3dzaW0uYyAgfCA4MyArKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0KIGJlbmNobWFya3Mvd3NpbS9SRUFE
TUUgfCAyMyArKysrKysrKysrKy0KIDIgZmlsZXMgY2hhbmdlZCwgOTQgaW5zZXJ0aW9ucygrKSwg
MTIgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvYmVuY2htYXJrcy9nZW1fd3NpbS5jIGIvYmVu
Y2htYXJrcy9nZW1fd3NpbS5jCmluZGV4IDhkZDg4N2E1YWZkOC4uZWRlNTA1ZTUzN2ZkIDEwMDY0
NAotLS0gYS9iZW5jaG1hcmtzL2dlbV93c2ltLmMKKysrIGIvYmVuY2htYXJrcy9nZW1fd3NpbS5j
CkBAIC04Nyw2ICs4Nyw3IEBAIGVudW0gd190eXBlCiAJTE9BRF9CQUxBTkNFLAogCUJPTkQsCiAJ
VEVSTUlOQVRFLAorCVNTRVUKIH07CiAKIHN0cnVjdCBkZXBzCkBAIC0xMzYsNiArMTM3LDcgQEAg
c3RydWN0IHdfc3RlcAogCQkJdWludDY0X3QgYm9uZF9tYXNrOwogCQkJZW51bSBpbnRlbF9lbmdp
bmVfaWQgYm9uZF9tYXN0ZXI7CiAJCX07CisJCWludCBzc2V1OwogCX07CiAKIAkvKiBJbXBsZW1l
bnRhdGlvbiBkZXRhaWxzICovCkBAIC0xNzEsNiArMTczLDcgQEAgc3RydWN0IGN0eCB7CiAJYm9v
bCB0YXJnZXRzX2luc3RhbmNlOwogCWJvb2wgd2FudHNfYmFsYW5jZTsKIAl1bnNpZ25lZCBpbnQg
c3RhdGljX3ZjczsKKwl1aW50NjRfdCBzc2V1OwogfTsKIAogc3RydWN0IHdvcmtsb2FkCkBAIC0y
NDEsNiArMjQ0LDkgQEAgc3RhdGljIHVuc2lnbmVkIGludCBjb250ZXh0X3Zjc19ycjsKIAogc3Rh
dGljIGludCB2ZXJib3NlID0gMTsKIHN0YXRpYyBpbnQgZmQ7CitzdGF0aWMgc3RydWN0IGRybV9p
OTE1X2dlbV9jb250ZXh0X3BhcmFtX3NzZXUgZGV2aWNlX3NzZXUgPSB7CisJLnNsaWNlX21hc2sg
PSAtMSAvKiBGb3JjZSByZWFkIG9uIGZpcnN0IHVzZS4gKi8KK307CiAKICNkZWZpbmUgU1dBUFZD
UwkJKDE8PDApCiAjZGVmaW5lIFNFUU5PCQkoMTw8MSkKQEAgLTQ4Miw2ICs0ODgsMjcgQEAgcGFy
c2Vfd29ya2xvYWQoc3RydWN0IHdfYXJnICphcmcsIHVuc2lnbmVkIGludCBmbGFncywgc3RydWN0
IHdvcmtsb2FkICphcHBfdykKIAkJCQlpbnRfZmllbGQoU1lOQywgdGFyZ2V0LAogCQkJCQkgIHRt
cCA+PSAwIHx8ICgoaW50KW5yX3N0ZXBzICsgdG1wKSA8IDAsCiAJCQkJCSAgIkludmFsaWQgc3lu
YyB0YXJnZXQgYXQgc3RlcCAldSFcbiIpOworCQkJfSBlbHNlIGlmICghc3RyY21wKGZpZWxkLCAi
UyIpKSB7CisJCQkJdW5zaWduZWQgaW50IG5yID0gMDsKKwkJCQl3aGlsZSAoKGZpZWxkID0gc3Ry
dG9rX3IoZnN0YXJ0LCAiLiIsICZmY3R4KSkpIHsKKwkJCQkJdG1wID0gYXRvaShmaWVsZCk7CisJ
CQkJCWNoZWNrX2FyZyh0bXAgPD0gMCAmJiBuciA9PSAwLAorCQkJCQkJICAiSW52YWxpZCBjb250
ZXh0IGF0IHN0ZXAgJXUhXG4iLAorCQkJCQkJICBucl9zdGVwcyk7CisJCQkJCWNoZWNrX2FyZyhu
ciA+IDEsCisJCQkJCQkgICJJbnZhbGlkIFNTRVUgZm9ybWF0IGF0IHN0ZXAgJXUhXG4iLAorCQkJ
CQkJICBucl9zdGVwcyk7CisKKwkJCQkJaWYgKG5yID09IDApCisJCQkJCQlzdGVwLmNvbnRleHQg
PSB0bXA7CisJCQkJCWVsc2UgaWYgKG5yID09IDEpCisJCQkJCQlzdGVwLnNzZXUgPSB0bXA7CisK
KwkJCQkJbnIrKzsKKwkJCQl9CisKKwkJCQlzdGVwLnR5cGUgPSBTU0VVOworCQkJCWdvdG8gYWRk
X3N0ZXA7CiAJCQl9IGVsc2UgaWYgKCFzdHJjbXAoZmllbGQsICJ0IikpIHsKIAkJCQlpbnRfZmll
bGQoVEhST1RUTEUsIHRocm90dGxlLAogCQkJCQkgIHRtcCA8IDAsCkBAIC0xMTQxLDI0ICsxMTY4
LDM4IEBAIGZpbmRfZW5naW5lKHN0cnVjdCBpOTE1X2VuZ2luZV9jbGFzc19pbnN0YW5jZSAqY2ks
IHVuc2lnbmVkIGludCBjb3VudCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIHZvaWQKLXNldF9j
dHhfc3NldSh1aW50MzJfdCBjdHgpCitzdGF0aWMgc3RydWN0IGRybV9pOTE1X2dlbV9jb250ZXh0
X3BhcmFtX3NzZXUgZ2V0X2RldmljZV9zc2V1KHZvaWQpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X2dl
bV9jb250ZXh0X3BhcmFtX3NzZXUgc3NldSA9IHsgfTsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2Nv
bnRleHRfcGFyYW0gcGFyYW0gPSB7IH07CiAKLQlzc2V1LmNsYXNzID0gSTkxNV9FTkdJTkVfQ0xB
U1NfUkVOREVSOwotCXNzZXUuaW5zdGFuY2UgPSAwOworCWlmIChkZXZpY2Vfc3NldS5zbGljZV9t
YXNrID09IC0xKSB7CisJCXBhcmFtLnBhcmFtID0gSTkxNV9DT05URVhUX1BBUkFNX1NTRVU7CisJ
CXBhcmFtLnZhbHVlID0gKHVpbnRwdHJfdCkmZGV2aWNlX3NzZXU7CisKKwkJZ2VtX2NvbnRleHRf
Z2V0X3BhcmFtKGZkLCAmcGFyYW0pOworCX0KKworCXJldHVybiBkZXZpY2Vfc3NldTsKK30KKwor
c3RhdGljIHVpbnQ2NF90CitzZXRfY3R4X3NzZXUodWludDMyX3QgY3R4LCB1aW50NjRfdCBzbGlj
ZV9tYXNrKQoreworCXN0cnVjdCBkcm1faTkxNV9nZW1fY29udGV4dF9wYXJhbV9zc2V1IHNzZXUg
PSBnZXRfZGV2aWNlX3NzZXUoKTsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2NvbnRleHRfcGFyYW0g
cGFyYW0gPSB7IH07CisKKwlpZiAoc2xpY2VfbWFzayA9PSAtMSkKKwkJc2xpY2VfbWFzayA9IGRl
dmljZV9zc2V1LnNsaWNlX21hc2s7CisKKwlzc2V1LnNsaWNlX21hc2sgPSBzbGljZV9tYXNrOwog
CiAJcGFyYW0uY3R4X2lkID0gY3R4OwogCXBhcmFtLnBhcmFtID0gSTkxNV9DT05URVhUX1BBUkFN
X1NTRVU7CiAJcGFyYW0udmFsdWUgPSAodWludHB0cl90KSZzc2V1OwogCi0JZ2VtX2NvbnRleHRf
Z2V0X3BhcmFtKGZkLCAmcGFyYW0pOwotCi0Jc3NldS5zbGljZV9tYXNrID0gMTsKLQogCWdlbV9j
b250ZXh0X3NldF9wYXJhbShmZCwgJnBhcmFtKTsKKworCXJldHVybiBzbGljZV9tYXNrOwogfQog
CiBzdGF0aWMgaW50CkBAIC0xMzUyLDYgKzEzOTMsNyBAQCBwcmVwYXJlX3dvcmtsb2FkKHVuc2ln
bmVkIGludCBpZCwgc3RydWN0IHdvcmtsb2FkICp3cmssIHVuc2lnbmVkIGludCBmbGFncykKIAog
CQlpZ3RfYXNzZXJ0KGN0eF9pZCk7CiAJCWN0eC0+aWQgPSBjdHhfaWQ7CisJCWN0eC0+c3NldSA9
IGRldmljZV9zc2V1LnNsaWNlX21hc2s7CiAKIAkJaWYgKGZsYWdzICYgR0xPQkFMX0JBTEFOQ0Up
IHsKIAkJCWN0eC0+c3RhdGljX3ZjcyA9IGNvbnRleHRfdmNzX3JyOwpAQCAtMTUxMiw4ICsxNTU0
LDEwIEBAIHByZXBhcmVfd29ya2xvYWQodW5zaWduZWQgaW50IGlkLCBzdHJ1Y3Qgd29ya2xvYWQg
KndyaywgdW5zaWduZWQgaW50IGZsYWdzKQogCQkJZ2VtX2NvbnRleHRfc2V0X3BhcmFtKGZkLCAm
cGFyYW0pOwogCQl9CiAKLQkJaWYgKHdyay0+c3NldSkKLQkJCXNldF9jdHhfc3NldShhcmcuY3R4
X2lkKTsKKwkJaWYgKHdyay0+c3NldSkgeworCQkJLyogU2V0IHRvIHNsaWNlIDAgb25seSwgb25l
IHNsaWNlLiAqLworCQkJY3R4LT5zc2V1ID0gc2V0X2N0eF9zc2V1KGN0eF9pZCwgMSk7CisJCX0K
IAogCQlpZiAoc2hhcmVfdm0pCiAJCQl2bV9kZXN0cm95KGZkLCBzaGFyZV92bSk7CkBAIC0xNTUw
LDYgKzE1OTQsMTYgQEAgcHJlcGFyZV93b3JrbG9hZCh1bnNpZ25lZCBpbnQgaWQsIHN0cnVjdCB3
b3JrbG9hZCAqd3JrLCB1bnNpZ25lZCBpbnQgZmxhZ3MpCiAJCX0KIAl9CiAKKwkvKgorCSAqIFNj
YW4gZm9yIFNTRVUgY29udHJvbCBzdGVwcy4KKwkgKi8KKwlmb3IgKGkgPSAwLCB3ID0gd3JrLT5z
dGVwczsgaSA8IHdyay0+bnJfc3RlcHM7IGkrKywgdysrKSB7CisJCWlmICh3LT50eXBlID09IFNT
RVUpIHsKKwkJCWdldF9kZXZpY2Vfc3NldSgpOworCQkJYnJlYWs7CisJCX0KKwl9CisKIAkvKgog
CSAqIEFsbG9jYXRlIGJhdGNoIGJ1ZmZlcnMuCiAJICovCkBAIC0yNDg1LDYgKzI1MzksMTMgQEAg
c3RhdGljIHZvaWQgKnJ1bl93b3JrbG9hZCh2b2lkICpkYXRhKQogCQkJCSAgIHctPnR5cGUgPT0g
TE9BRF9CQUxBTkNFIHx8CiAJCQkJICAgdy0+dHlwZSA9PSBCT05EKSB7CiAJCQkJY29udGludWU7
CisJCQl9IGVsc2UgaWYgKHctPnR5cGUgPT0gU1NFVSkgeworCQkJCWlmICh3LT5zc2V1ICE9IHdy
ay0+Y3R4X2xpc3Rbdy0+Y29udGV4dF0uc3NldSkgeworCQkJCQl3cmstPmN0eF9saXN0W3ctPmNv
bnRleHRdLnNzZXUgPQorCQkJCQkJc2V0X2N0eF9zc2V1KHdyay0+Y3R4X2xpc3Rbdy0+Y29udGV4
dF0uaWQsCisJCQkJCQkJICAgICB3LT5zc2V1KTsKKwkJCQl9CisJCQkJY29udGludWU7CiAJCQl9
CiAKIAkJCWlmIChkb19zbGVlcCB8fCB3LT50eXBlID09IFBFUklPRCkgewpkaWZmIC0tZ2l0IGEv
YmVuY2htYXJrcy93c2ltL1JFQURNRSBiL2JlbmNobWFya3Mvd3NpbS9SRUFETUUKaW5kZXggNDk3
ZDVjYWQyMTQyLi45Zjc3MDIxN2YwNzUgMTAwNjQ0Ci0tLSBhL2JlbmNobWFya3Mvd3NpbS9SRUFE
TUUKKysrIGIvYmVuY2htYXJrcy93c2ltL1JFQURNRQpAQCAtNSw3ICs1LDcgQEAgY3R4LmVuZ2lu
ZS5kdXJhdGlvbl91cy5kZXBlbmRlbmN5LndhaXQsLi4uCiA8dWludD4uPHN0cj4uPHVpbnQ+Wy08
dWludD5dfCouPGludCA8PSAwPlsvPGludCA8PSAwPl1bLi4uXS48MHwxPiwuLi4KIEIuPHVpbnQ+
CiBNLjx1aW50Pi48c3RyPlt8PHN0cj5dLi4uCi1QfFguPHVpbnQ+LjxpbnQ+CitQfFN8WC48dWlu
dD4uPGludD4KIGR8cHxzfHR8cXxhfFQuPGludD4sLi4uCiBiLjx1aW50Pi48c3RyPlt8PHN0cj5d
LjxzdHI+CiBmCkBAIC0zMCw2ICszMCw3IEBAIEFkZGl0aW9uYWwgd29ya2xvYWQgc3RlcHMgYXJl
IGFsc28gc3VwcG9ydGVkOgogICdiJyAtIFNldCB1cCBlbmdpbmUgYm9uZHMuCiAgJ00nIC0gU2V0
IHVwIGVuZ2luZSBtYXAuCiAgJ1AnIC0gQ29udGV4dCBwcmlvcml0eS4KKyAnUycgLSBDb250ZXh0
IFNTRVUgY29uZmlndXJhdGlvbi4KICAnVCcgLSBUZXJtaW5hdGUgYW4gaW5maW5pdGUgYmF0Y2gu
CiAgJ1gnIC0gQ29udGV4dCBwcmVlbXB0aW9uIGNvbnRyb2wuCiAKQEAgLTI1NCwzICsyNTUsMjMg
QEAgdGhlbiBsb29rIGxpa2U6CiAgIDEuREVGQVVMVC4xMDAwLmYtMS4wCiAgIDIuREVGQVVMVC4x
MDAwLnMtMS4wCiAgIGEuLTMKKworQ29udGV4dCBTU0VVIGNvbmZpZ3VyYXRpb24KKy0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tCisKKyAgUy4xLjEKKyAgMS5SQ1MuMTAwMC4wLjAKKyAgUy4yLi0x
CisgIDIuUkNTLjEwMDAuMC4wCisKK0NvbnRleHQgMSBpcyBjb25maWd1cmVkIHRvIHJ1biB3aXRo
IG9uZSBlbmFibGVkIHNsaWNlIChzbGljZSBtYXNrIDEpIGFuZCBhIGJhdGNoCitpcyBzdW1pdHRl
ZCBhZ2FpbnN0IGl0LiBDb250ZXh0IDIgaXMgY29uZmlndXJlZCB0byBydW4gd2l0aCBhbGwgc2xp
Y2VzICh0aGlzIGlzCit0aGUgZGVmYXVsdCBzbyB0aGUgY29tbWFuZCBjb3VsZCBhbHNvIGJlIG9t
aXR0ZWQpIGFuZCBhIGJhdGNoIHN1Ym1pdHRlZCBhZ2FpbnN0CitpdC4KKworVGhpcyBzaG93cyB0
aGUgZHluYW1pYyBTU0VVIHJlY29uZmlndXJhdGlvbiBjb3N0IGJld2VlbiB0d28gY29udGV4dHMg
Y29tcGV0aW5nCitmb3IgdGhlIHJlbmRlciBlbmdpbmUuCisKK1NsaWNlIG1hc2sgb2YgLTEgaGFz
IGEgc3BlY2lhbCBtZWFuaW5nIG9mICJhbGwgc2xpY2VzIi4gT3RoZXJ3aXNlIGFueSBpbnRlZ2Vy
CitjYW4gYmUgc3BlY2lmeWluZyBhcyB0aGUgc2xpY2UgbWFzaywgYnV0IGJld2FyZSBhbnkgYXBh
cnQgZnJvbSAxIGFuZCAtMSBjYW4gbWFrZQordGhlIHdvcmtsb2FkIG5vdCBwb3J0YWJsZSBiZXR3
ZWVuIGRpZmZlcmVudCBHUFVzLgotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBs
aXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1h
bi9saXN0aW5mby9pbnRlbC1nZng=

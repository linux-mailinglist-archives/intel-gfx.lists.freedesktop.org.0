Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 098AE21068
	for <lists+intel-gfx@lfdr.de>; Thu, 16 May 2019 23:57:30 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 157A0897FD;
	Thu, 16 May 2019 21:57:28 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga17.intel.com (mga17.intel.com [192.55.52.151])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B1103897FB
 for <intel-gfx@lists.freedesktop.org>; Thu, 16 May 2019 21:57:23 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga001.jf.intel.com ([10.7.209.18])
 by fmsmga107.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 16 May 2019 14:57:23 -0700
X-ExtLoop1: 1
Received: from dceraolo-linux.fm.intel.com ([10.1.27.145])
 by orsmga001.jf.intel.com with ESMTP; 16 May 2019 14:57:23 -0700
From: Daniele Ceraolo Spurio <daniele.ceraolospurio@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 16 May 2019 14:56:33 -0700
Message-Id: <20190516215634.16675-7-daniele.ceraolospurio@intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190516215634.16675-1-daniele.ceraolospurio@intel.com>
References: <20190516215634.16675-1-daniele.ceraolospurio@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [RFC 6/7] drm/i915: update rpm_get/put to use the rpm
 structure
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VGhlIGZ1bmN0aW9ucyBhcmUgaW50ZXJuYWxseSBhbHJlYWR5IG9ubHkgdXNpbmcgdGhlIHN0cnVj
dHVyZSwgc28gd2UKbmVlZCB0byBqdXN0IGZsaXAgdGhlIGludGVyZmFjZS4KClNpZ25lZC1vZmYt
Ynk6IERhbmllbGUgQ2VyYW9sbyBTcHVyaW8gPGRhbmllbGUuY2VyYW9sb3NwdXJpb0BpbnRlbC5j
b20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMgICAgIHwg
IDggKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5nY2hlY2suYyAgICAgfCAg
NCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYyAgICAgICAgIHwgIDQg
Ky0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jICB8IDIwICsr
KystLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYyAgICAgICAgfCAz
NiArKysrKysrLS0tLS0tLQogLi4uL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF93b3JrYXJvdW5k
cy5jICAgIHwgMTIgKystLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9hcGVydHVyZV9nbS5j
ICAgICAgICB8IDE1ICsrKy0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2d2dC5oICAgICAg
ICAgICAgICAgIHwgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZF9wb2xpY3ku
YyAgICAgICB8ICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMgICAg
ICAgICAgfCAgNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMgICAgICAg
ICAgIHwgNDkgKysrKysrKysrKy0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9n
ZW0uYyAgICAgICAgICAgICAgIHwgMjYgKysrKystLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9nZW1fZmVuY2VfcmVnLmMgICAgIHwgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfZ2VtX3Nocmlua2VyLmMgICAgICB8ICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3BlcmYuYyAgICAgICAgICAgICAgfCAgNiArLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
cG11LmMgICAgICAgICAgICAgICB8ICA4ICstLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9z
eXNmcy5jICAgICAgICAgICAgIHwgMTIgKystLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X2Rpc3BsYXkuYyAgICAgICAgICB8ICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9m
YmRldi5jICAgICAgICAgICAgfCAgNiArLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2hv
dHBsdWcuYyAgICAgICAgICB8ICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ydW50
aW1lX3BtLmMgICAgICAgfCA0OCArKysrKysrKystLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX3J1bnRpbWVfcG0uaCAgICAgICB8IDIyICsrKystLS0tLQogZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfd2FrZXJlZi5jICAgICAgICAgIHwgIDQgKy0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L3NlbGZ0ZXN0cy9odWdlX3BhZ2VzLmMgICB8ICA0ICstCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9zZWxmdGVzdHMvaTkxNV9hY3RpdmUuYyAgfCAgOCArLS0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbS5jICAgICB8ICA0ICstCiAuLi4vZHJtL2k5MTUvc2VsZnRl
c3RzL2k5MTVfZ2VtX2NvaGVyZW5jeS5jICAgfCAgNCArLQogLi4uL2dwdS9kcm0vaTkxNS9zZWxm
dGVzdHMvaTkxNV9nZW1fY29udGV4dC5jIHwgMTIgKystLS0KIC4uLi9ncHUvZHJtL2k5MTUvc2Vs
ZnRlc3RzL2k5MTVfZ2VtX2V2aWN0LmMgICB8ICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9z
ZWxmdGVzdHMvaTkxNV9nZW1fZ3R0LmMgfCAgOCArLS0KIC4uLi9ncHUvZHJtL2k5MTUvc2VsZnRl
c3RzL2k5MTVfZ2VtX29iamVjdC5jICB8ICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxm
dGVzdHMvaTkxNV9yZXF1ZXN0LmMgfCAyMCArKysrLS0tLQogLi4uL2dwdS9kcm0vaTkxNS9zZWxm
dGVzdHMvaTkxNV90aW1lbGluZS5jICAgIHwgMTYgKysrLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9zZWxmdGVzdHMvaW50ZWxfZ3VjLmMgICAgfCAgOCArLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L3NlbGZ0ZXN0cy9pbnRlbF91bmNvcmUuYyB8ICA0ICstCiAzNSBmaWxlcyBjaGFuZ2VkLCAyMDEg
aW5zZXJ0aW9ucygrKSwgMjAzIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfZW5naW5lX2NzLmMKaW5kZXggNGMzNzUzYzFiNTczLi4yNmYzYjY4YWI3ZDYgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jCkBAIC0xMDU5LDcgKzEwNTks
NyBAQCBzdGF0aWMgYm9vbCByaW5nX2lzX2lkbGUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lKQogCQlyZXR1cm4gdHJ1ZTsKIAogCS8qIElmIHRoZSB3aG9sZSBkZXZpY2UgaXMgYXNsZWVw
LCB0aGUgZW5naW5lIG11c3QgYmUgaWRsZSAqLwotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3Bt
X2dldF9pZl9pbl91c2UoZGV2X3ByaXYpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dl
dF9pZl9pbl91c2UoJmRldl9wcml2LT5ydW50aW1lX3BtKTsKIAlpZiAoIXdha2VyZWYpCiAJCXJl
dHVybiB0cnVlOwogCkBAIC0xMDczLDcgKzEwNzMsNyBAQCBzdGF0aWMgYm9vbCByaW5nX2lzX2lk
bGUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCSAgICAhKEVOR0lORV9SRUFEKGVu
Z2luZSwgUklOR19NSV9NT0RFKSAmIE1PREVfSURMRSkpCiAJCWlkbGUgPSBmYWxzZTsKIAotCWlu
dGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3Bt
X3B1dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCiAJcmV0dXJuIGlkbGU7CiB9
CkBAIC0xNDg3LDEwICsxNDg3LDEwIEBAIHZvaWQgaW50ZWxfZW5naW5lX2R1bXAoc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lLAogCiAJcmN1X3JlYWRfdW5sb2NrKCk7CiAKLQl3YWtlcmVm
ID0gaW50ZWxfcnVudGltZV9wbV9nZXRfaWZfaW5fdXNlKGVuZ2luZS0+aTkxNSk7CisJd2FrZXJl
ZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3VzZSgmZW5naW5lLT5pOTE1LT5ydW50aW1l
X3BtKTsKIAlpZiAod2FrZXJlZikgewogCQlpbnRlbF9lbmdpbmVfcHJpbnRfcmVnaXN0ZXJzKGVu
Z2luZSwgbSk7Ci0JCWludGVsX3J1bnRpbWVfcG1fcHV0KGVuZ2luZS0+aTkxNSwgd2FrZXJlZik7
CisJCWludGVsX3J1bnRpbWVfcG1fcHV0KCZlbmdpbmUtPmk5MTUtPnJ1bnRpbWVfcG0sIHdha2Vy
ZWYpOwogCX0gZWxzZSB7CiAJCWRybV9wcmludGYobSwgIlx0RGV2aWNlIGlzIGFzbGVlcDsgc2tp
cHBpbmcgcmVnaXN0ZXIgZHVtcFxuIik7CiAJfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfaGFuZ2NoZWNrLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9oYW5nY2hlY2suYwppbmRleCAzYTRkMDliODBmYTAuLmQ1YTc2YjY2YjkxYiAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfaGFuZ2NoZWNrLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfaGFuZ2NoZWNrLmMKQEAgLTI3Myw3ICsyNzMsNyBAQCBz
dGF0aWMgdm9pZCBpOTE1X2hhbmdjaGVja19lbGFwc2VkKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29y
aykKIAlpZiAoaTkxNV90ZXJtaW5hbGx5X3dlZGdlZChkZXZfcHJpdikpCiAJCXJldHVybjsKIAot
CXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UoZGV2X3ByaXYpOworCXdh
a2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UoJmRldl9wcml2LT5ydW50aW1l
X3BtKTsKIAlpZiAoIXdha2VyZWYpCiAJCXJldHVybjsKIApAQCAtMzI0LDcgKzMyNCw3IEBAIHN0
YXRpYyB2b2lkIGk5MTVfaGFuZ2NoZWNrX2VsYXBzZWQoc3RydWN0IHdvcmtfc3RydWN0ICp3b3Jr
KQogCWlmIChodW5nKQogCQloYW5nY2hlY2tfZGVjbGFyZV9oYW5nKGRldl9wcml2LCBodW5nLCBz
dHVjayk7CiAKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7CisJaW50
ZWxfcnVudGltZV9wbV9wdXQoJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAogCS8q
IFJlc2V0IHRpbWVyIGluIGNhc2UgR1BVIGhhbmdzIHdpdGhvdXQgYW5vdGhlciByZXF1ZXN0IGJl
aW5nIGFkZGVkICovCiAJaTkxNV9xdWV1ZV9oYW5nY2hlY2soZGV2X3ByaXYpOwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMKaW5kZXggNDY0MzY5YmM1NWFkLi5hZDk0MzgxMGVkZWQg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwpAQCAtMTI0Miw3ICsxMjQyLDcg
QEAgdm9pZCBpOTE1X2hhbmRsZV9lcnJvcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
IAkgKiBpc24ndCB0aGUgY2FzZSBhdCBsZWFzdCB3aGVuIHdlIGdldCBoZXJlIGJ5IGRvaW5nIGEK
IAkgKiBzaW11bGF0ZWQgcmVzZXQgdmlhIGRlYnVnZnMsIHNvIGdldCBhbiBSUE0gcmVmZXJlbmNl
LgogCSAqLwotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtlcmVm
ID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCiAJZW5naW5lX21h
c2sgJj0gSU5URUxfSU5GTyhpOTE1KS0+ZW5naW5lX21hc2s7CiAKQEAgLTEzMDUsNyArMTMwNSw3
IEBAIHZvaWQgaTkxNV9oYW5kbGVfZXJyb3Ioc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
CiAJd2FrZV91cF9hbGwoJmVycm9yLT5yZXNldF9xdWV1ZSk7CiAKIG91dDoKLQlpbnRlbF9ydW50
aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+
cnVudGltZV9wbSwgd2FrZXJlZik7CiB9CiAKIGludCBpOTE1X3Jlc2V0X3RyeWxvY2soc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9zZWxmdGVzdF9oYW5nY2hlY2suYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0
ZXN0X2hhbmdjaGVjay5jCmluZGV4IGRhYjNkMzBjOWM3My4uMzliY2NlMzIxNzViIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hlY2suYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hlY2suYwpAQCAtNDAwLDE0ICs0
MDAsMTQgQEAgc3RhdGljIGludCBpZ3Rfd2VkZ2VkX3Jlc2V0KHZvaWQgKmFyZykKIAkvKiBDaGVj
ayB0aGF0IHdlIGNhbiByZWNvdmVyIGEgd2VkZ2VkIGRldmljZSB3aXRoIGEgR1BVIHJlc2V0ICov
CiAKIAlpZ3RfZ2xvYmFsX3Jlc2V0X2xvY2soaTkxNSk7Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRp
bWVfcG1fZ2V0KGk5MTUpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+
cnVudGltZV9wbSk7CiAKIAlpOTE1X2dlbV9zZXRfd2VkZ2VkKGk5MTUpOwogCiAJR0VNX0JVR19P
TighaTkxNV9yZXNldF9mYWlsZWQoaTkxNSkpOwogCWk5MTVfcmVzZXQoaTkxNSwgQUxMX0VOR0lO
RVMsIE5VTEwpOwogCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7CisJaW50
ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCWlndF9nbG9i
YWxfcmVzZXRfdW5sb2NrKGk5MTUpOwogCiAJcmV0dXJuIGk5MTVfcmVzZXRfZmFpbGVkKGk5MTUp
ID8gLUVJTyA6IDA7CkBAIC00NDUsNyArNDQ1LDcgQEAgc3RhdGljIGludCBpZ3RfcmVzZXRfbm9w
KHZvaWQgKmFyZykKIAl9CiAKIAlpOTE1X2dlbV9jb250ZXh0X2NsZWFyX2Jhbm5hYmxlKGN0eCk7
Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCXdha2VyZWYgPSBpbnRl
bF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAJcmVzZXRfY291bnQgPSBpOTE1
X3Jlc2V0X2NvdW50KCZpOTE1LT5ncHVfZXJyb3IpOwogCWNvdW50ID0gMDsKIAlkbyB7CkBAIC00
OTIsNyArNDkyLDcgQEAgc3RhdGljIGludCBpZ3RfcmVzZXRfbm9wKHZvaWQgKmFyZykKIAllcnIg
PSBpZ3RfZmx1c2hfdGVzdChpOTE1LCBJOTE1X1dBSVRfTE9DS0VEKTsKIAltdXRleF91bmxvY2so
Jmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwg
d2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2Vy
ZWYpOwogCiBvdXQ6CiAJbW9ja19maWxlX2ZyZWUoaTkxNSwgZmlsZSk7CkBAIC01MjksNyArNTI5
LDcgQEAgc3RhdGljIGludCBpZ3RfcmVzZXRfbm9wX2VuZ2luZSh2b2lkICphcmcpCiAJfQogCiAJ
aTkxNV9nZW1fY29udGV4dF9jbGVhcl9iYW5uYWJsZShjdHgpOwotCXdha2VyZWYgPSBpbnRlbF9y
dW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5
MTUtPnJ1bnRpbWVfcG0pOwogCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKSB7CiAJ
CXVuc2lnbmVkIGludCByZXNldF9jb3VudCwgcmVzZXRfZW5naW5lX2NvdW50OwogCQl1bnNpZ25l
ZCBpbnQgY291bnQ7CkBAIC02MDAsNyArNjAwLDcgQEAgc3RhdGljIGludCBpZ3RfcmVzZXRfbm9w
X2VuZ2luZSh2b2lkICphcmcpCiAJZXJyID0gaWd0X2ZsdXNoX3Rlc3QoaTkxNSwgSTkxNV9XQUlU
X0xPQ0tFRCk7CiAJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAotCWlu
dGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0
KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIG91dDoKIAltb2NrX2ZpbGVfZnJlZShpOTE1
LCBmaWxlKTsKIAlpZiAoaTkxNV9yZXNldF9mYWlsZWQoaTkxNSkpCkBAIC0xNzg2LDcgKzE3ODYs
NyBAQCBzdGF0aWMgaW50IGlndF9hdG9taWNfcmVzZXQodm9pZCAqYXJnKQogCiAJaWd0X2dsb2Jh
bF9yZXNldF9sb2NrKGk5MTUpOwogCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgp
OwotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtlcmVmID0gaW50
ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCiAJLyogRmx1c2ggYW55IHJl
cXVlc3RzIGJlZm9yZSB3ZSBnZXQgc3RhcnRlZCBhbmQgY2hlY2sgYmFzaWNzICovCiAJZm9yY2Vf
cmVzZXQoaTkxNSk7CkBAIC0xODM2LDcgKzE4MzYsNyBAQCBzdGF0aWMgaW50IGlndF9hdG9taWNf
cmVzZXQodm9pZCAqYXJnKQogCWZvcmNlX3Jlc2V0KGk5MTUpOwogCiB1bmxvY2s6Ci0JaW50ZWxf
cnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5
MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVj
dF9tdXRleCk7CiAJaWd0X2dsb2JhbF9yZXNldF91bmxvY2soaTkxNSk7CiAKQEAgLTE4NzIsNyAr
MTg3Miw3IEBAIGludCBpbnRlbF9oYW5nY2hlY2tfbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCiAJaWYgKGk5MTVfdGVybWluYWxseV93ZWRnZWQoaTkxNSkpCiAJ
CXJldHVybiAtRUlPOyAvKiB3ZSdyZSBsb25nIHBhc3QgaG9wZSBvZiBhIHN1Y2Nlc3NmdWwgcmVz
ZXQgKi8KIAotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtlcmVm
ID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCXNhdmVkX2hhbmdj
aGVjayA9IGZldGNoX2FuZF96ZXJvKCZpOTE1X21vZHBhcmFtcy5lbmFibGVfaGFuZ2NoZWNrKTsK
IAlkcmFpbl9kZWxheWVkX3dvcmsoJmk5MTUtPmdwdV9lcnJvci5oYW5nY2hlY2tfd29yayk7IC8q
IGZsdXNoIHBhcmFtICovCiAKQEAgLTE4ODMsNyArMTg4Myw3IEBAIGludCBpbnRlbF9oYW5nY2hl
Y2tfbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJbXV0ZXhf
dW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAogCWk5MTVfbW9kcGFyYW1zLmVuYWJs
ZV9oYW5nY2hlY2sgPSBzYXZlZF9oYW5nY2hlY2s7Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkx
NSwgd2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdh
a2VyZWYpOwogCiAJcmV0dXJuIGVycjsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L3NlbGZ0ZXN0X2xyYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rf
bHJjLmMKaW5kZXggNGIwNDI4OTNkYzBlLi5lNTM2Y2M2YjU2MjIgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCkBAIC0yOSw3ICsyOSw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9z
YW5pdHljaGVjayh2b2lkICphcmcpCiAJCXJldHVybiAwOwogCiAJbXV0ZXhfbG9jaygmaTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUp
OworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAK
IAlpZiAoaWd0X3NwaW5uZXJfaW5pdCgmc3BpbiwgaTkxNSkpCiAJCWdvdG8gZXJyX3VubG9jazsK
QEAgLTcwLDcgKzcwLDcgQEAgc3RhdGljIGludCBsaXZlX3Nhbml0eWNoZWNrKHZvaWQgKmFyZykK
IAlpZ3Rfc3Bpbm5lcl9maW5pKCZzcGluKTsKIGVycl91bmxvY2s6CiAJaWd0X2ZsdXNoX3Rlc3Qo
aTkxNSwgSTkxNV9XQUlUX0xPQ0tFRCk7Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2Fr
ZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYp
OwogCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJcmV0dXJuIGVycjsK
IH0KQEAgLTkzLDcgKzkzLDcgQEAgc3RhdGljIGludCBsaXZlX2J1c3l3YWl0X3ByZWVtcHQodm9p
ZCAqYXJnKQogCSAqLwogCiAJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0J
d2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCXdha2VyZWYgPSBpbnRlbF9y
dW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAKIAljdHhfaGkgPSBrZXJuZWxfY29u
dGV4dChpOTE1KTsKIAlpZiAoIWN0eF9oaSkKQEAgLTI0OSw3ICsyNDksNyBAQCBzdGF0aWMgaW50
IGxpdmVfYnVzeXdhaXRfcHJlZW1wdCh2b2lkICphcmcpCiBlcnJfdW5sb2NrOgogCWlmIChpZ3Rf
Zmx1c2hfdGVzdChpOTE1LCBJOTE1X1dBSVRfTE9DS0VEKSkKIAkJZXJyID0gLUVJTzsKLQlpbnRl
bF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgm
aTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3Ry
dWN0X211dGV4KTsKIAlyZXR1cm4gZXJyOwogfQpAQCAtMjcxLDcgKzI3MSw3IEBAIHN0YXRpYyBp
bnQgbGl2ZV9wcmVlbXB0KHZvaWQgKmFyZykKIAkJcHJfZXJyKCJMb2dpY2FsIHByZWVtcHRpb24g
c3VwcG9ydGVkLCBidXQgbm90IGV4cG9zZWRcbiIpOwogCiAJbXV0ZXhfbG9jaygmaTkxNS0+ZHJt
LnN0cnVjdF9tdXRleCk7Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOwor
CXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAKIAlp
ZiAoaWd0X3NwaW5uZXJfaW5pdCgmc3Bpbl9oaSwgaTkxNSkpCiAJCWdvdG8gZXJyX3VubG9jazsK
QEAgLTM1Niw3ICszNTYsNyBAQCBzdGF0aWMgaW50IGxpdmVfcHJlZW1wdCh2b2lkICphcmcpCiAJ
aWd0X3NwaW5uZXJfZmluaSgmc3Bpbl9oaSk7CiBlcnJfdW5sb2NrOgogCWlndF9mbHVzaF90ZXN0
KGk5MTUsIEk5MTVfV0FJVF9MT0NLRUQpOwotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdh
a2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVm
KTsKIAltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCXJldHVybiBlcnI7
CiB9CkBAIC0zNzYsNyArMzc2LDcgQEAgc3RhdGljIGludCBsaXZlX2xhdGVfcHJlZW1wdCh2b2lk
ICphcmcpCiAJCXJldHVybiAwOwogCiAJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRl
eCk7Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCXdha2VyZWYgPSBp
bnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAKIAlpZiAoaWd0X3NwaW5u
ZXJfaW5pdCgmc3Bpbl9oaSwgaTkxNSkpCiAJCWdvdG8gZXJyX3VubG9jazsKQEAgLTQ2MCw3ICs0
NjAsNyBAQCBzdGF0aWMgaW50IGxpdmVfbGF0ZV9wcmVlbXB0KHZvaWQgKmFyZykKIAlpZ3Rfc3Bp
bm5lcl9maW5pKCZzcGluX2hpKTsKIGVycl91bmxvY2s6CiAJaWd0X2ZsdXNoX3Rlc3QoaTkxNSwg
STkxNV9XQUlUX0xPQ0tFRCk7Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7
CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCW11
dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJcmV0dXJuIGVycjsKIApAQCAt
NTI2LDcgKzUyNiw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9zdXBwcmVzc19zZWxmX3ByZWVtcHQodm9p
ZCAqYXJnKQogCQlyZXR1cm4gMDsgLyogcHJlc3VtZSBibGFjayBibG94ICovCiAKIAltdXRleF9s
b2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9w
bV9nZXQoaTkxNSk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50
aW1lX3BtKTsKIAogCWlmIChwcmVlbXB0X2NsaWVudF9pbml0KGk5MTUsICZhKSkKIAkJZ290byBl
cnJfdW5sb2NrOwpAQCAtNjAwLDcgKzYwMCw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9zdXBwcmVzc19z
ZWxmX3ByZWVtcHQodm9pZCAqYXJnKQogZXJyX3VubG9jazoKIAlpZiAoaWd0X2ZsdXNoX3Rlc3Qo
aTkxNSwgSTkxNV9XQUlUX0xPQ0tFRCkpCiAJCWVyciA9IC1FSU87Ci0JaW50ZWxfcnVudGltZV9w
bV9wdXQoaTkxNSwgd2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRp
bWVfcG0sIHdha2VyZWYpOwogCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7
CiAJcmV0dXJuIGVycjsKIApAQCAtNjc3LDcgKzY3Nyw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9zdXBw
cmVzc193YWl0X3ByZWVtcHQodm9pZCAqYXJnKQogCQlyZXR1cm4gMDsKIAogCW11dGV4X2xvY2so
Jmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dl
dChpOTE1KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVf
cG0pOwogCiAJaWYgKHByZWVtcHRfY2xpZW50X2luaXQoaTkxNSwgJmNsaWVudFswXSkpIC8qIEVM
U1BbMF0gKi8KIAkJZ290byBlcnJfdW5sb2NrOwpAQCAtNzcwLDcgKzc3MCw3IEBAIHN0YXRpYyBp
bnQgbGl2ZV9zdXBwcmVzc193YWl0X3ByZWVtcHQodm9pZCAqYXJnKQogZXJyX3VubG9jazoKIAlp
ZiAoaWd0X2ZsdXNoX3Rlc3QoaTkxNSwgSTkxNV9XQUlUX0xPQ0tFRCkpCiAJCWVyciA9IC1FSU87
Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9w
bV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCW11dGV4X3VubG9jaygmaTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7CiAJcmV0dXJuIGVycjsKIApAQCAtODAxLDcgKzgwMSw3IEBAIHN0
YXRpYyBpbnQgbGl2ZV9jaGFpbl9wcmVlbXB0KHZvaWQgKmFyZykKIAkJcmV0dXJuIDA7CiAKIAlt
dXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQl3YWtlcmVmID0gaW50ZWxfcnVu
dGltZV9wbV9nZXQoaTkxNSk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1
LT5ydW50aW1lX3BtKTsKIAogCWlmIChwcmVlbXB0X2NsaWVudF9pbml0KGk5MTUsICZoaSkpCiAJ
CWdvdG8gZXJyX3VubG9jazsKQEAgLTkxOCw3ICs5MTgsNyBAQCBzdGF0aWMgaW50IGxpdmVfY2hh
aW5fcHJlZW1wdCh2b2lkICphcmcpCiBlcnJfdW5sb2NrOgogCWlmIChpZ3RfZmx1c2hfdGVzdChp
OTE1LCBJOTE1X1dBSVRfTE9DS0VEKSkKIAkJZXJyID0gLUVJTzsKLQlpbnRlbF9ydW50aW1lX3Bt
X3B1dChpOTE1LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGlt
ZV9wbSwgd2FrZXJlZik7CiAJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsK
IAlyZXR1cm4gZXJyOwogCkBAIC05NDcsNyArOTQ3LDcgQEAgc3RhdGljIGludCBsaXZlX3ByZWVt
cHRfaGFuZyh2b2lkICphcmcpCiAJCXJldHVybiAwOwogCiAJbXV0ZXhfbG9jaygmaTkxNS0+ZHJt
LnN0cnVjdF9tdXRleCk7Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOwor
CXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAKIAlp
ZiAoaWd0X3NwaW5uZXJfaW5pdCgmc3Bpbl9oaSwgaTkxNSkpCiAJCWdvdG8gZXJyX3VubG9jazsK
QEAgLTEwNDIsNyArMTA0Miw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9wcmVlbXB0X2hhbmcodm9pZCAq
YXJnKQogCWlndF9zcGlubmVyX2ZpbmkoJnNwaW5faGkpOwogZXJyX3VubG9jazoKIAlpZ3RfZmx1
c2hfdGVzdChpOTE1LCBJOTE1X1dBSVRfTE9DS0VEKTsKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChp
OTE1LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwg
d2FrZXJlZik7CiAJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlyZXR1
cm4gZXJyOwogfQpAQCAtMTI0Niw3ICsxMjQ2LDcgQEAgc3RhdGljIGludCBsaXZlX3ByZWVtcHRf
c21va2Uodm9pZCAqYXJnKQogCQlyZXR1cm4gLUVOT01FTTsKIAogCW11dGV4X2xvY2soJnNtb2tl
Lmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dl
dChzbW9rZS5pOTE1KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJnNtb2tlLmk5
MTUtPnJ1bnRpbWVfcG0pOwogCiAJc21va2UuYmF0Y2ggPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRl
X2ludGVybmFsKHNtb2tlLmk5MTUsIFBBR0VfU0laRSk7CiAJaWYgKElTX0VSUihzbW9rZS5iYXRj
aCkpIHsKQEAgLTEyOTksNyArMTI5OSw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9wcmVlbXB0X3Ntb2tl
KHZvaWQgKmFyZykKIGVycl9iYXRjaDoKIAlpOTE1X2dlbV9vYmplY3RfcHV0KHNtb2tlLmJhdGNo
KTsKIGVycl91bmxvY2s6Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoc21va2UuaTkxNSwgd2FrZXJl
Zik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJnNtb2tlLmk5MTUtPnJ1bnRpbWVfcG0sIHdha2Vy
ZWYpOwogCW11dGV4X3VubG9jaygmc21va2UuaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJa2Zy
ZWUoc21va2UuY29udGV4dHMpOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9zZWxmdGVzdF93b3JrYXJvdW5kcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRl
c3Rfd29ya2Fyb3VuZHMuYwppbmRleCA5Zjc2ODBiOTk4NGIuLjZjMWRiMmU0MDNiYSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rfd29ya2Fyb3VuZHMuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF93b3JrYXJvdW5kcy5jCkBAIC02MzAs
NyArNjMwLDcgQEAgc3RhdGljIGludCBsaXZlX2RpcnR5X3doaXRlbGlzdCh2b2lkICphcmcpCiAJ
aWYgKElOVEVMX0dFTihpOTE1KSA8IDcpIC8qIG1pbmltdW0gcmVxdWlyZW1lbnQgZm9yIExSSSwg
U1JNLCBMUk0gKi8KIAkJcmV0dXJuIDA7CiAKLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9n
ZXQoaTkxNSk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1l
X3BtKTsKIAogCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJZmlsZSA9
IG1vY2tfZmlsZShpOTE1KTsKQEAgLTY2MCw3ICs2NjAsNyBAQCBzdGF0aWMgaW50IGxpdmVfZGly
dHlfd2hpdGVsaXN0KHZvaWQgKmFyZykKIAltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKIAlt
dXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIG91dF9ycG06Ci0JaW50ZWxfcnVu
dGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUt
PnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCXJldHVybiBlcnI7CiB9CiAKQEAgLTEwMzUsNyArMTAz
NSw3IEBAIGxpdmVfZ3B1X3Jlc2V0X2d0X2VuZ2luZV93b3JrYXJvdW5kcyh2b2lkICphcmcpCiAJ
cHJfaW5mbygiVmVyaWZ5aW5nIGFmdGVyIEdQVSByZXNldC4uLlxuIik7CiAKIAlpZ3RfZ2xvYmFs
X3Jlc2V0X2xvY2soaTkxNSk7Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUp
OworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAK
IAlyZWZlcmVuY2VfbGlzdHNfaW5pdChpOTE1LCAmbGlzdHMpOwogCkBAIC0xMDQ5LDcgKzEwNDks
NyBAQCBsaXZlX2dwdV9yZXNldF9ndF9lbmdpbmVfd29ya2Fyb3VuZHModm9pZCAqYXJnKQogCiBv
dXQ6CiAJcmVmZXJlbmNlX2xpc3RzX2ZpbmkoaTkxNSwgJmxpc3RzKTsKLQlpbnRlbF9ydW50aW1l
X3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVu
dGltZV9wbSwgd2FrZXJlZik7CiAJaWd0X2dsb2JhbF9yZXNldF91bmxvY2soaTkxNSk7CiAKIAly
ZXR1cm4gb2sgPyAwIDogLUVTUkNIOwpAQCAtMTA3Niw3ICsxMDc2LDcgQEAgbGl2ZV9lbmdpbmVf
cmVzZXRfZ3RfZW5naW5lX3dvcmthcm91bmRzKHZvaWQgKmFyZykKIAkJcmV0dXJuIFBUUl9FUlIo
Y3R4KTsKIAogCWlndF9nbG9iYWxfcmVzZXRfbG9jayhpOTE1KTsKLQl3YWtlcmVmID0gaW50ZWxf
cnVudGltZV9wbV9nZXQoaTkxNSk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZp
OTE1LT5ydW50aW1lX3BtKTsKIAogCXJlZmVyZW5jZV9saXN0c19pbml0KGk5MTUsICZsaXN0cyk7
CiAKQEAgLTExMzMsNyArMTEzMyw3IEBAIGxpdmVfZW5naW5lX3Jlc2V0X2d0X2VuZ2luZV93b3Jr
YXJvdW5kcyh2b2lkICphcmcpCiAKIGVycjoKIAlyZWZlcmVuY2VfbGlzdHNfZmluaShpOTE1LCAm
bGlzdHMpOwotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWludGVsX3J1
bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAlpZ3RfZ2xvYmFsX3Jl
c2V0X3VubG9jayhpOTE1KTsKIAlrZXJuZWxfY29udGV4dF9jbG9zZShjdHgpOwogCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvYXBlcnR1cmVfZ20uYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d2dC9hcGVydHVyZV9nbS5jCmluZGV4IDdmNGUzNDU2Y2UxMS4uYjIwODBhOTlj
NWMyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvYXBlcnR1cmVfZ20uYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvYXBlcnR1cmVfZ20uYwpAQCAtMTY5LDcgKzE2
OSw3IEBAIHN0YXRpYyB2b2lkIGZyZWVfdmdwdV9mZW5jZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdw
dSkKIAlpZiAoV0FSTl9PTighdmdwdV9mZW5jZV9zeih2Z3B1KSkpCiAJCXJldHVybjsKIAotCWlu
dGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKKwlpbnRlbF9ydW50aW1lX3BtX2dldCgmZGV2
X3ByaXYtPnJ1bnRpbWVfcG0pOwogCiAJbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3Rf
bXV0ZXgpOwogCV9jbGVhcl92Z3B1X2ZlbmNlKHZncHUpOwpAQCAtMTgwLDE3ICsxODAsMTggQEAg
c3RhdGljIHZvaWQgZnJlZV92Z3B1X2ZlbmNlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQogCX0K
IAltdXRleF91bmxvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKIAotCWludGVsX3J1
bnRpbWVfcG1fcHV0X3VuY2hlY2tlZChkZXZfcHJpdik7CisJaW50ZWxfcnVudGltZV9wbV9wdXRf
dW5jaGVja2VkKCZkZXZfcHJpdi0+cnVudGltZV9wbSk7CiB9CiAKIHN0YXRpYyBpbnQgYWxsb2Nf
dmdwdV9mZW5jZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKIHsKIAlzdHJ1Y3QgaW50ZWxfZ3Z0
ICpndnQgPSB2Z3B1LT5ndnQ7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
Z3Z0LT5kZXZfcHJpdjsKKwlzdHJ1Y3QgaW50ZWxfcnVudGltZV9wbSAqcnBtID0gJmRldl9wcml2
LT5ydW50aW1lX3BtOwogCXN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgKnJlZzsKIAlpbnQgaTsK
IAotCWludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKKwlpbnRlbF9ydW50aW1lX3BtX2dl
dChycG0pOwogCiAJLyogUmVxdWVzdCBmZW5jZXMgZnJvbSBob3N0ICovCiAJbXV0ZXhfbG9jaygm
ZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwpAQCAtMjA2LDcgKzIwNyw3IEBAIHN0YXRpYyBp
bnQgYWxsb2NfdmdwdV9mZW5jZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKIAlfY2xlYXJfdmdw
dV9mZW5jZSh2Z3B1KTsKIAogCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwotCWludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tlZChkZXZfcHJpdik7CisJaW50ZWxf
cnVudGltZV9wbV9wdXRfdW5jaGVja2VkKHJwbSk7CiAJcmV0dXJuIDA7CiBvdXRfZnJlZV9mZW5j
ZToKIAlndnRfdmdwdV9lcnIoIkZhaWxlZCB0byBhbGxvYyBmZW5jZXNcbiIpOwpAQCAtMjE5LDcg
KzIyMCw3IEBAIHN0YXRpYyBpbnQgYWxsb2NfdmdwdV9mZW5jZShzdHJ1Y3QgaW50ZWxfdmdwdSAq
dmdwdSkKIAkJdmdwdS0+ZmVuY2UucmVnc1tpXSA9IE5VTEw7CiAJfQogCW11dGV4X3VubG9jaygm
ZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCWludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hl
Y2tlZChkZXZfcHJpdik7CisJaW50ZWxfcnVudGltZV9wbV9wdXRfdW5jaGVja2VkKHJwbSk7CiAJ
cmV0dXJuIC1FTk9TUEM7CiB9CiAKQEAgLTMxNSw5ICszMTYsOSBAQCB2b2lkIGludGVsX3ZncHVf
cmVzZXRfcmVzb3VyY2Uoc3RydWN0IGludGVsX3ZncHUgKnZncHUpCiB7CiAJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKIAotCWludGVsX3J1
bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKKwlpbnRlbF9ydW50aW1lX3BtX2dldCgmZGV2X3ByaXYt
PnJ1bnRpbWVfcG0pOwogCV9jbGVhcl92Z3B1X2ZlbmNlKHZncHUpOwotCWludGVsX3J1bnRpbWVf
cG1fcHV0X3VuY2hlY2tlZChkZXZfcHJpdik7CisJaW50ZWxfcnVudGltZV9wbV9wdXRfdW5jaGVj
a2VkKCZkZXZfcHJpdi0+cnVudGltZV9wbSk7CiB9CiAKIC8qKgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3Z0L2d2dC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2d2dC5o
CmluZGV4IGI1NGYyYmRjMTNhNC4uNWZlZTJlMTEyYzU1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndnQvZ3Z0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2d2dC5o
CkBAIC01ODQsMTIgKzU4NCwxMiBAQCBlbnVtIHsKIAogc3RhdGljIGlubGluZSB2b2lkIG1taW9f
aHdfYWNjZXNzX3ByZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7Ci0JaW50
ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOworCWludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZf
cHJpdi0+cnVudGltZV9wbSk7CiB9CiAKIHN0YXRpYyBpbmxpbmUgdm9pZCBtbWlvX2h3X2FjY2Vz
c19wb3N0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKLQlpbnRlbF9ydW50
aW1lX3BtX3B1dF91bmNoZWNrZWQoZGV2X3ByaXYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0X3Vu
Y2hlY2tlZCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOwogfQogCiAvKioKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZF9wb2xpY3kuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d2dC9zY2hlZF9wb2xpY3kuYwppbmRleCAxYzc2M2EyN2E0MTIuLjIzNjlkNGE5YWY5NCAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkX3BvbGljeS5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZF9wb2xpY3kuYwpAQCAtNDY1LDcgKzQ2NSw3
IEBAIHZvaWQgaW50ZWxfdmdwdV9zdG9wX3NjaGVkdWxlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1
KQogCQlzY2hlZHVsZXItPmN1cnJlbnRfdmdwdSA9IE5VTEw7CiAJfQogCi0JaW50ZWxfcnVudGlt
ZV9wbV9nZXQoZGV2X3ByaXYpOworCWludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0+cnVu
dGltZV9wbSk7CiAJc3Bpbl9sb2NrX2JoKCZzY2hlZHVsZXItPm1taW9fY29udGV4dF9sb2NrKTsK
IAlmb3IgKHJpbmdfaWQgPSAwOyByaW5nX2lkIDwgSTkxNV9OVU1fRU5HSU5FUzsgcmluZ19pZCsr
KSB7CiAJCWlmIChzY2hlZHVsZXItPmVuZ2luZV9vd25lcltyaW5nX2lkXSA9PSB2Z3B1KSB7CkBA
IC00NzQsNiArNDc0LDYgQEAgdm9pZCBpbnRlbF92Z3B1X3N0b3Bfc2NoZWR1bGUoc3RydWN0IGlu
dGVsX3ZncHUgKnZncHUpCiAJCX0KIAl9CiAJc3Bpbl91bmxvY2tfYmgoJnNjaGVkdWxlci0+bW1p
b19jb250ZXh0X2xvY2spOwotCWludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tlZChkZXZfcHJp
dik7CisJaW50ZWxfcnVudGltZV9wbV9wdXRfdW5jaGVja2VkKCZkZXZfcHJpdi0+cnVudGltZV9w
bSk7CiAJbXV0ZXhfdW5sb2NrKCZ2Z3B1LT5ndnQtPnNjaGVkX2xvY2spOwogfQpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Z0L3NjaGVkdWxlci5jCmluZGV4IGQ5N2Q5MzU1YmYxNS4uNzg4MTJkMGNlMzFkIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCkBAIC0xNDgxLDExICsxNDgxLDExIEBA
IGludGVsX3ZncHVfY3JlYXRlX3dvcmtsb2FkKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCBpbnQg
cmluZ19pZCwKIAkgKiBhcyB0aGVyZSBpcyBvbmx5IG9uZSBwcmUtYWxsb2NhdGVkIGJ1Zi1vYmog
Zm9yIHNoYWRvdy4KIAkgKi8KIAlpZiAobGlzdF9lbXB0eSh3b3JrbG9hZF9xX2hlYWQodmdwdSwg
cmluZ19pZCkpKSB7Ci0JCWludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKKwkJaW50ZWxf
cnVudGltZV9wbV9nZXQoJmRldl9wcml2LT5ydW50aW1lX3BtKTsKIAkJbXV0ZXhfbG9jaygmZGV2
X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCQlyZXQgPSBpbnRlbF9ndnRfc2Nhbl9hbmRfc2hh
ZG93X3dvcmtsb2FkKHdvcmtsb2FkKTsKIAkJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0
cnVjdF9tdXRleCk7Ci0JCWludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tlZChkZXZfcHJpdik7
CisJCWludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tlZCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0p
OwogCX0KIAogCWlmIChyZXQpIHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfZGVidWdmcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKaW5kZXgg
MDExNTM3NjMyYzRmLi5lNThhMDE1MmIyNWYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZGVidWdmcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdm
cy5jCkBAIC02OTQsNyArNjk0LDcgQEAgc3RhdGljIGludCBpOTE1X2ludGVycnVwdF9pbmZvKHN0
cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsK
IAlpbnQgaSwgcGlwZTsKIAotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJp
dik7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0+cnVudGltZV9w
bSk7CiAKIAlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKIAkJaW50ZWxfd2FrZXJlZl90
IHByZWY7CkBAIC05MDAsNyArOTAwLDcgQEAgc3RhdGljIGludCBpOTE1X2ludGVycnVwdF9pbmZv
KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKIAkJfQogCX0KIAotCWludGVsX3J1bnRp
bWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmZGV2
X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCiAJcmV0dXJuIDA7CiB9CkBAIC0xMDM5LDcg
KzEwMzksNyBAQCBzdGF0aWMgaW50IGk5MTVfZnJlcXVlbmN5X2luZm8oc3RydWN0IHNlcV9maWxl
ICptLCB2b2lkICp1bnVzZWQpCiAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7CiAJaW50IHJldCA9
IDA7CiAKLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOworCXdha2Vy
ZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOwogCiAJaWYg
KElTX0dFTihkZXZfcHJpdiwgNSkpIHsKIAkJdTE2IHJndnN3Y3RsID0gSTkxNV9SRUFEMTYoTUVN
U1dDVEwpOwpAQCAtMTI1MSw3ICsxMjUxLDcgQEAgc3RhdGljIGludCBpOTE1X2ZyZXF1ZW5jeV9p
bmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogCXNlcV9wcmludGYobSwgIk1h
eCBDRCBjbG9jayBmcmVxdWVuY3k6ICVkIGtIelxuIiwgZGV2X3ByaXYtPm1heF9jZGNsa19mcmVx
KTsKIAlzZXFfcHJpbnRmKG0sICJNYXggcGl4ZWwgY2xvY2sgZnJlcXVlbmN5OiAlZCBrSHpcbiIs
IGRldl9wcml2LT5tYXhfZG90Y2xrX2ZyZXEpOwogCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2
X3ByaXYsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGlt
ZV9wbSwgd2FrZXJlZik7CiAJcmV0dXJuIHJldDsKIH0KIApAQCAtMTU5Niw3ICsxNTk2LDcgQEAg
c3RhdGljIGludCBpOTE1X2ZiY19zdGF0dXMoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVz
ZWQpCiAJaWYgKCFIQVNfRkJDKGRldl9wcml2KSkKIAkJcmV0dXJuIC1FTk9ERVY7CiAKLQl3YWtl
cmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOworCXdha2VyZWYgPSBpbnRlbF9y
dW50aW1lX3BtX2dldCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOwogCW11dGV4X2xvY2soJmZiYy0+
bG9jayk7CiAKIAlpZiAoaW50ZWxfZmJjX2lzX2FjdGl2ZShkZXZfcHJpdikpCkBAIC0xNjIzLDcg
KzE2MjMsNyBAQCBzdGF0aWMgaW50IGk5MTVfZmJjX3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0s
IHZvaWQgKnVudXNlZCkKIAl9CiAKIAltdXRleF91bmxvY2soJmZiYy0+bG9jayk7Ci0JaW50ZWxf
cnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0
KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAKIAlyZXR1cm4gMDsKIH0KQEAgLTE2
NzMsNyArMTY3Myw3IEBAIHN0YXRpYyBpbnQgaTkxNV9pcHNfc3RhdHVzKHN0cnVjdCBzZXFfZmls
ZSAqbSwgdm9pZCAqdW51c2VkKQogCWlmICghSEFTX0lQUyhkZXZfcHJpdikpCiAJCXJldHVybiAt
RU5PREVWOwogCi0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKKwl3
YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmRldl9wcml2LT5ydW50aW1lX3BtKTsKIAog
CXNlcV9wcmludGYobSwgIkVuYWJsZWQgYnkga2VybmVsIHBhcmFtZXRlcjogJXNcbiIsCiAJCSAg
IHllc25vKGk5MTVfbW9kcGFyYW1zLmVuYWJsZV9pcHMpKTsKQEAgLTE2ODcsNyArMTY4Nyw3IEBA
IHN0YXRpYyBpbnQgaTkxNV9pcHNfc3RhdHVzKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51
c2VkKQogCQkJc2VxX3B1dHMobSwgIkN1cnJlbnRseTogZGlzYWJsZWRcbiIpOwogCX0KIAotCWlu
dGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3Bt
X3B1dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCiAJcmV0dXJuIDA7CiB9CkBA
IC0xNzY2LDcgKzE3NjYsNyBAQCBzdGF0aWMgaW50IGk5MTVfcmluZ19mcmVxX3RhYmxlKHN0cnVj
dCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogCiAJc2VxX3B1dHMobSwgIkdQVSBmcmVxIChN
SHopXHRFZmZlY3RpdmUgQ1BVIGZyZXEgKE1IeilcdEVmZmVjdGl2ZSBSaW5nIGZyZXEgKE1Ieilc
biIpOwogCi0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKKwl3YWtl
cmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmRldl9wcml2LT5ydW50aW1lX3BtKTsKIAlmb3Ig
KGdwdV9mcmVxID0gbWluX2dwdV9mcmVxOyBncHVfZnJlcSA8PSBtYXhfZ3B1X2ZyZXE7IGdwdV9m
cmVxKyspIHsKIAkJaWFfZnJlcSA9IGdwdV9mcmVxOwogCQlzYW5keWJyaWRnZV9wY29kZV9yZWFk
KGRldl9wcml2LApAQCAtMTc4MCw3ICsxNzgwLDcgQEAgc3RhdGljIGludCBpOTE1X3JpbmdfZnJl
cV90YWJsZShzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKIAkJCSAgICgoaWFfZnJl
cSA+PiAwKSAmIDB4ZmYpICogMTAwLAogCQkJICAgKChpYV9mcmVxID4+IDgpICYgMHhmZikgKiAx
MDApOwogCX0KLQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7CisJaW50
ZWxfcnVudGltZV9wbV9wdXQoJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAogCXJl
dHVybiAwOwogfQpAQCAtMTk1Niw3ICsxOTU2LDcgQEAgc3RhdGljIGludCBpOTE1X3N3aXp6bGVf
aW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCiAJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwogCWludGVsX3dha2Vy
ZWZfdCB3YWtlcmVmOwogCi0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2
KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmRldl9wcml2LT5ydW50aW1lX3Bt
KTsKIAogCXNlcV9wcmludGYobSwgImJpdDYgc3dpenpsZSBmb3IgWC10aWxpbmcgPSAlc1xuIiwK
IAkJICAgc3dpenpsZV9zdHJpbmcoZGV2X3ByaXYtPm1tLmJpdF82X3N3aXp6bGVfeCkpOwpAQCAt
MTk5NCw3ICsxOTk0LDcgQEAgc3RhdGljIGludCBpOTE1X3N3aXp6bGVfaW5mbyhzdHJ1Y3Qgc2Vx
X2ZpbGUgKm0sIHZvaWQgKmRhdGEpCiAJaWYgKGRldl9wcml2LT5xdWlya3MgJiBRVUlSS19QSU5f
U1dJWlpMRURfUEFHRVMpCiAJCXNlcV9wdXRzKG0sICJMLXNoYXBlZCBtZW1vcnkgZGV0ZWN0ZWRc
biIpOwogCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOworCWludGVs
X3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAKIAlyZXR1
cm4gMDsKIH0KQEAgLTI1MDcsNyArMjUwNyw3IEBAIHN0YXRpYyBpbnQgaTkxNV9lZHBfcHNyX3N0
YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCiAJaWYgKCFwc3ItPnNpbmtfc3Vw
cG9ydCkKIAkJcmV0dXJuIDA7CiAKLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2
X3ByaXYpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmZGV2X3ByaXYtPnJ1bnRp
bWVfcG0pOwogCW11dGV4X2xvY2soJnBzci0+bG9jayk7CiAKIAlpZiAocHNyLT5lbmFibGVkKQpA
QCAtMjU3MSw3ICsyNTcxLDcgQEAgc3RhdGljIGludCBpOTE1X2VkcF9wc3Jfc3RhdHVzKHN0cnVj
dCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKIAogdW5sb2NrOgogCW11dGV4X3VubG9jaygmcHNy
LT5sb2NrKTsKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7CisJaW50
ZWxfcnVudGltZV9wbV9wdXQoJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAogCXJl
dHVybiAwOwogfQpAQCAtMjU4OCwxMSArMjU4OCwxMSBAQCBpOTE1X2VkcF9wc3JfZGVidWdfc2V0
KHZvaWQgKmRhdGEsIHU2NCB2YWwpCiAKIAlEUk1fREVCVUdfS01TKCJTZXR0aW5nIFBTUiBkZWJ1
ZyB0byAlbGx4XG4iLCB2YWwpOwogCi0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRl
dl9wcml2KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmRldl9wcml2LT5ydW50
aW1lX3BtKTsKIAogCXJldCA9IGludGVsX3Bzcl9kZWJ1Z19zZXQoZGV2X3ByaXYsIHZhbCk7CiAK
LQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7CisJaW50ZWxfcnVudGlt
ZV9wbV9wdXQoJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAogCXJldHVybiByZXQ7
CiB9CkBAIC0yNzA4LDcgKzI3MDgsNyBAQCBzdGF0aWMgaW50IGk5MTVfZG1jX2luZm8oc3RydWN0
IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCiAKIAljc3IgPSAmZGV2X3ByaXYtPmNzcjsKIAot
CXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7CisJd2FrZXJlZiA9IGlu
dGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0+cnVudGltZV9wbSk7CiAKIAlzZXFfcHJpbnRm
KG0sICJmdyBsb2FkZWQ6ICVzXG4iLCB5ZXNubyhjc3ItPmRtY19wYXlsb2FkICE9IE5VTEwpKTsK
IAlzZXFfcHJpbnRmKG0sICJwYXRoOiAlc1xuIiwgY3NyLT5md19wYXRoKTsKQEAgLTI3MzQsNyAr
MjczNCw3IEBAIHN0YXRpYyBpbnQgaTkxNV9kbWNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZv
aWQgKnVudXNlZCkKIAlzZXFfcHJpbnRmKG0sICJzc3AgYmFzZTogMHglMDh4XG4iLCBJOTE1X1JF
QUQoQ1NSX1NTUF9CQVNFKSk7CiAJc2VxX3ByaW50ZihtLCAiaHRwOiAweCUwOHhcbiIsIEk5MTVf
UkVBRChDU1JfSFRQX1NLTCkpOwogCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdh
a2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2Fr
ZXJlZik7CiAKIAlyZXR1cm4gMDsKIH0KQEAgLTMwMTgsNyArMzAxOCw3IEBAIHN0YXRpYyBpbnQg
aTkxNV9kaXNwbGF5X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCiAJc3Ry
dWN0IGRybV9jb25uZWN0b3JfbGlzdF9pdGVyIGNvbm5faXRlcjsKIAlpbnRlbF93YWtlcmVmX3Qg
d2FrZXJlZjsKIAotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7CisJ
d2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0+cnVudGltZV9wbSk7CiAK
IAlzZXFfcHJpbnRmKG0sICJDUlRDIGluZm9cbiIpOwogCXNlcV9wcmludGYobSwgIi0tLS0tLS0t
LVxuIik7CkBAIC0zMDY3LDcgKzMwNjcsNyBAQCBzdGF0aWMgaW50IGk5MTVfZGlzcGxheV9pbmZv
KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogCWRybV9jb25uZWN0b3JfbGlzdF9p
dGVyX2VuZCgmY29ubl9pdGVyKTsKIAltdXRleF91bmxvY2soJmRldi0+bW9kZV9jb25maWcubXV0
ZXgpOwogCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOworCWludGVs
X3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAKIAlyZXR1
cm4gMDsKIH0KQEAgLTMwODAsNyArMzA4MCw3IEBAIHN0YXRpYyBpbnQgaTkxNV9lbmdpbmVfaW5m
byhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKIAllbnVtIGludGVsX2VuZ2luZV9p
ZCBpZDsKIAlzdHJ1Y3QgZHJtX3ByaW50ZXIgcDsKIAotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1l
X3BtX2dldChkZXZfcHJpdik7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZf
cHJpdi0+cnVudGltZV9wbSk7CiAKIAlzZXFfcHJpbnRmKG0sICJHVCBhd2FrZT8gJXMgWyVkXVxu
IiwKIAkJICAgeWVzbm8oZGV2X3ByaXYtPmd0LmF3YWtlKSwKQEAgLTMwOTIsNyArMzA5Miw3IEBA
IHN0YXRpYyBpbnQgaTkxNV9lbmdpbmVfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVu
dXNlZCkKIAlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpCiAJCWludGVsX2Vu
Z2luZV9kdW1wKGVuZ2luZSwgJnAsICIlc1xuIiwgZW5naW5lLT5uYW1lKTsKIAotCWludGVsX3J1
bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgm
ZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCiAJcmV0dXJuIDA7CiB9CkBAIC00MjU1
LDcgKzQyNTUsOCBAQCBzdGF0aWMgaW50IGk5MTVfZm9yY2V3YWtlX29wZW4oc3RydWN0IGlub2Rl
ICppbm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpCiAJaWYgKElOVEVMX0dFTihpOTE1KSA8IDYpCiAJ
CXJldHVybiAwOwogCi0JZmlsZS0+cHJpdmF0ZV9kYXRhID0gKHZvaWQgKikodWludHB0cl90KWlu
dGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCWZpbGUtPnByaXZhdGVfZGF0YSA9CisJCSh2b2lk
ICopKHVpbnRwdHJfdClpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAJ
aW50ZWxfdW5jb3JlX2ZvcmNld2FrZV91c2VyX2dldCgmaTkxNS0+dW5jb3JlKTsKIAogCXJldHVy
biAwOwpAQCAtNDI2OSw3ICs0MjcwLDcgQEAgc3RhdGljIGludCBpOTE1X2ZvcmNld2FrZV9yZWxl
YXNlKHN0cnVjdCBpbm9kZSAqaW5vZGUsIHN0cnVjdCBmaWxlICpmaWxlKQogCQlyZXR1cm4gMDsK
IAogCWludGVsX3VuY29yZV9mb3JjZXdha2VfdXNlcl9wdXQoJmk5MTUtPnVuY29yZSk7Ci0JaW50
ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVu
dGltZV9wbSwKIAkJCSAgICAgKGludGVsX3dha2VyZWZfdCkodWludHB0cl90KWZpbGUtPnByaXZh
dGVfZGF0YSk7CiAKIAlyZXR1cm4gMDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCmluZGV4IDViY2Nm
Nzk1NTI4NS4uNjMxZmVmNmU0YjdhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2dlbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKQEAgLTg5Niw3
ICs4OTYsNyBAQCBpOTE1X2dlbV9ndHRfcHJlYWQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iaiwKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCi0Jd2FrZXJlZiA9IGludGVsX3J1bnRp
bWVfcG1fZ2V0KGk5MTUpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+
cnVudGltZV9wbSk7CiAJdm1hID0gaTkxNV9nZW1fb2JqZWN0X2dndHRfcGluKG9iaiwgTlVMTCwg
MCwgMCwKIAkJCQkgICAgICAgUElOX01BUFBBQkxFIHwKIAkJCQkgICAgICAgUElOX05PTkZBVUxU
IHwKQEAgLTk2OSw3ICs5NjksNyBAQCBpOTE1X2dlbV9ndHRfcHJlYWQoc3RydWN0IGRybV9pOTE1
X2dlbV9vYmplY3QgKm9iaiwKIAkJaTkxNV92bWFfdW5waW4odm1hKTsKIAl9CiBvdXRfdW5sb2Nr
OgotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVf
cG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAltdXRleF91bmxvY2soJmk5MTUt
PmRybS5zdHJ1Y3RfbXV0ZXgpOwogCiAJcmV0dXJuIHJldDsKQEAgLTEwODgsMTQgKzEwODgsMTQg
QEAgaTkxNV9nZW1fZ3R0X3B3cml0ZV9mYXN0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpv
YmosCiAJCSAqIFRoaXMgZWFzaWx5IGR3YXJmcyBhbnkgcGVyZm9ybWFuY2UgYWR2YW50YWdlIGZy
b20KIAkJICogdXNpbmcgdGhlIGNhY2hlIGJ5cGFzcyBvZiBpbmRpcmVjdCBHR1RUIGFjY2Vzcy4K
IAkJICovCi0JCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UoaTkxNSk7
CisJCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UoJmk5MTUtPnJ1bnRp
bWVfcG0pOwogCQlpZiAoIXdha2VyZWYpIHsKIAkJCXJldCA9IC1FRkFVTFQ7CiAJCQlnb3RvIG91
dF91bmxvY2s7CiAJCX0KIAl9IGVsc2UgewogCQkvKiBObyBiYWNraW5nIHBhZ2VzLCBubyBmYWxs
YmFjaywgd2UgbXVzdCBmb3JjZSBHR1RUIGFjY2VzcyAqLwotCQl3YWtlcmVmID0gaW50ZWxfcnVu
dGltZV9wbV9nZXQoaTkxNSk7CisJCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkx
NS0+cnVudGltZV9wbSk7CiAJfQogCiAJdm1hID0gaTkxNV9nZW1fb2JqZWN0X2dndHRfcGluKG9i
aiwgTlVMTCwgMCwgMCwKQEAgLTExNzcsNyArMTE3Nyw3IEBAIGk5MTVfZ2VtX2d0dF9wd3JpdGVf
ZmFzdChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCQlpOTE1X3ZtYV91bnBpbih2
bWEpOwogCX0KIG91dF9ycG06Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7
CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogb3V0
X3VubG9jazoKIAltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCXJldHVy
biByZXQ7CkBAIC0xNzQyLDcgKzE3NDIsNyBAQCB2bV9mYXVsdF90IGk5MTVfZ2VtX2ZhdWx0KHN0
cnVjdCB2bV9mYXVsdCAqdm1mKQogCWlmIChyZXQpCiAJCWdvdG8gZXJyOwogCi0Jd2FrZXJlZiA9
IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVudGlt
ZV9wbV9nZXQoJmRldl9wcml2LT5ydW50aW1lX3BtKTsKIAogCXNyY3UgPSBpOTE1X3Jlc2V0X3Ry
eWxvY2soZGV2X3ByaXYpOwogCWlmIChzcmN1IDwgMCkgewpAQCAtMTgyMyw3ICsxODIzLDcgQEAg
dm1fZmF1bHRfdCBpOTE1X2dlbV9mYXVsdChzdHJ1Y3Qgdm1fZmF1bHQgKnZtZikKIGVycl9yZXNl
dDoKIAlpOTE1X3Jlc2V0X3VubG9jayhkZXZfcHJpdiwgc3JjdSk7CiBlcnJfcnBtOgotCWludGVs
X3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1
dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCWk5MTVfZ2VtX29iamVjdF91bnBp
bl9wYWdlcyhvYmopOwogZXJyOgogCXN3aXRjaCAocmV0KSB7CkBAIC0xOTA3LDcgKzE5MDcsNyBA
QCBpOTE1X2dlbV9yZWxlYXNlX21tYXAoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikK
IAkgKiB3YWtlcmVmLgogCSAqLwogCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmRybS5zdHJ1
Y3RfbXV0ZXgpOwotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtl
cmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCiAJaWYgKCFv
YmotPnVzZXJmYXVsdF9jb3VudCkKIAkJZ290byBvdXQ7CkBAIC0xOTI0LDcgKzE5MjQsNyBAQCBp
OTE1X2dlbV9yZWxlYXNlX21tYXAoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIAl3
bWIoKTsKIAogb3V0OgotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWlu
dGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIH0KIAogdm9p
ZCBpOTE1X2dlbV9ydW50aW1lX3N1c3BlbmQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQpAQCAtMzk2MSw3ICszOTYxLDcgQEAgc3RhdGljIHZvaWQgX19pOTE1X2dlbV9mcmVlX29i
amVjdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKm9iaiwgKm9uOwogCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwogCi0Jd2FrZXJl
ZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1l
X3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAJbGxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShv
YmosIG9uLCBmcmVlZCwgZnJlZWQpIHsKIAkJc3RydWN0IGk5MTVfdm1hICp2bWEsICp2bjsKIApA
QCAtNDAyMSw3ICs0MDIxLDcgQEAgc3RhdGljIHZvaWQgX19pOTE1X2dlbV9mcmVlX29iamVjdHMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCWlmIChvbikKIAkJCWNvbmRfcmVzY2hl
ZCgpOwogCX0KLQlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKKwlpbnRlbF9y
dW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CiB9CiAKIHN0YXRpYyB2
b2lkIGk5MTVfZ2VtX2ZsdXNoX2ZyZWVfb2JqZWN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKQEAgLTQxMzQsNyArNDEzNCw3IEBAIHZvaWQgaTkxNV9nZW1fc2FuaXRpemUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAKIAlHRU1fVFJBQ0UoIlxuIik7CiAKLQl3YWtlcmVm
ID0gaW50ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVf
cG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKIAlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgm
aTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKIAogCS8qCkBAIC00MTU3LDcgKzQxNTcsNyBA
QCB2b2lkIGk5MTVfZ2VtX3Nhbml0aXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQog
CWludGVsX2d0X3Nhbml0aXplKGk5MTUsIGZhbHNlKTsKIAogCWludGVsX3VuY29yZV9mb3JjZXdh
a2VfcHV0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotCWludGVsX3J1bnRpbWVfcG1f
cHV0KGk5MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1l
X3BtLCB3YWtlcmVmKTsKIAogCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwog
CWk5MTVfZ2VtX2NvbnRleHRzX2xvc3QoaTkxNSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2dlbV9mZW5jZV9yZWcuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
Z2VtX2ZlbmNlX3JlZy5jCmluZGV4IDUwZjUyMjY0YjE2My4uZmE1ZjkyZWJhZTRmIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9mZW5jZV9yZWcuYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9mZW5jZV9yZWcuYwpAQCAtMjY0LDcgKzI2NCw3IEBA
IHN0YXRpYyBpbnQgZmVuY2VfdXBkYXRlKHN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgKmZlbmNl
LAogCSAqIGJlIGNsZWFyZWQgYmVmb3JlIHdlIGNhbiB1c2UgYW55IG90aGVyIGZlbmNlcyB0byBl
bnN1cmUgdGhhdAogCSAqIHRoZSBuZXcgZmVuY2VzIGRvIG5vdCBvdmVybGFwIHRoZSBlbGlkZWQg
Y2xlYXJzLCBjb25mdXNpbmcgSFcuCiAJICovCi0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1f
Z2V0X2lmX2luX3VzZShmZW5jZS0+aTkxNSk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1f
Z2V0X2lmX2luX3VzZSgmZmVuY2UtPmk5MTUtPnJ1bnRpbWVfcG0pOwogCWlmICghd2FrZXJlZikg
ewogCQlHRU1fQlVHX09OKHZtYSk7CiAJCXJldHVybiAwOwpAQCAtMjc4LDcgKzI3OCw3IEBAIHN0
YXRpYyBpbnQgZmVuY2VfdXBkYXRlKHN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgKmZlbmNlLAog
CQlsaXN0X21vdmVfdGFpbCgmZmVuY2UtPmxpbmssICZmZW5jZS0+aTkxNS0+bW0uZmVuY2VfbGlz
dCk7CiAJfQogCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoZmVuY2UtPmk5MTUsIHdha2VyZWYpOwor
CWludGVsX3J1bnRpbWVfcG1fcHV0KCZmZW5jZS0+aTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7
CiAJcmV0dXJuIDA7CiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
Z2VtX3Nocmlua2VyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9zaHJpbmtlci5j
CmluZGV4IDU4OGUzODk4YjEyMC4uMDViNzVhNDJkZDFjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2dlbV9zaHJpbmtlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZ2VtX3Nocmlua2VyLmMKQEAgLTI0NSw3ICsyNDUsNyBAQCBpOTE1X2dlbV9zaHJpbmso
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJICogd2Ugd2lsbCBmb3JjZSB0aGUgd2Fr
ZSBkdXJpbmcgb29tLW5vdGlmaWVyLgogCSAqLwogCWlmIChmbGFncyAmIEk5MTVfU0hSSU5LX0JP
VU5EKSB7Ci0JCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UoaTkxNSk7
CisJCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UoJmk5MTUtPnJ1bnRp
bWVfcG0pOwogCQlpZiAoIXdha2VyZWYpCiAJCQlmbGFncyAmPSB+STkxNV9TSFJJTktfQk9VTkQ7
CiAJfQpAQCAtMzI5LDcgKzMyOSw3IEBAIGk5MTVfZ2VtX3NocmluayhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKIAl9CiAKIAlpZiAoZmxhZ3MgJiBJOTE1X1NIUklOS19CT1VORCkKLQkJ
aW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7CisJCWludGVsX3J1bnRpbWVfcG1f
cHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAogCWk5MTVfcmV0aXJlX3JlcXVlc3Rz
KGk5MTUpOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5jCmluZGV4IGM0OTk1ZDVhMTZkMi4uN2Qx
YTIzYzZhZjJlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYwpAQCAtMTM3Myw3ICsxMzczLDcg
QEAgc3RhdGljIHZvaWQgaTkxNV9vYV9zdHJlYW1fZGVzdHJveShzdHJ1Y3QgaTkxNV9wZXJmX3N0
cmVhbSAqc3RyZWFtKQogCWZyZWVfb2FfYnVmZmVyKGRldl9wcml2KTsKIAogCWludGVsX3VuY29y
ZV9mb3JjZXdha2VfcHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKLQlpbnRl
bF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgc3RyZWFtLT53YWtlcmVmKTsKKwlpbnRlbF9ydW50
aW1lX3BtX3B1dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHN0cmVhbS0+d2FrZXJlZik7CiAKIAlp
ZiAoc3RyZWFtLT5jdHgpCiAJCW9hX3B1dF9yZW5kZXJfY3R4X2lkKHN0cmVhbSk7CkBAIC0yMTEw
LDcgKzIxMTAsNyBAQCBzdGF0aWMgaW50IGk5MTVfb2Ffc3RyZWFtX2luaXQoc3RydWN0IGk5MTVf
cGVyZl9zdHJlYW0gKnN0cmVhbSwKIAkgKiAgIEluIG91ciBjYXNlIHdlIGFyZSBleHBlY3Rpbmcg
dGhhdCB0YWtpbmcgcG0gKyBGT1JDRVdBS0UKIAkgKiAgIHJlZmVyZW5jZXMgd2lsbCBlZmZlY3Rp
dmVseSBkaXNhYmxlIFJDNi4KIAkgKi8KLQlzdHJlYW0tPndha2VyZWYgPSBpbnRlbF9ydW50aW1l
X3BtX2dldChkZXZfcHJpdik7CisJc3RyZWFtLT53YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9n
ZXQoJmRldl9wcml2LT5ydW50aW1lX3BtKTsKIAlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgm
ZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7CiAKIAlyZXQgPSBhbGxvY19vYV9idWZm
ZXIoZGV2X3ByaXYpOwpAQCAtMjE0Niw3ICsyMTQ2LDcgQEAgc3RhdGljIGludCBpOTE1X29hX3N0
cmVhbV9pbml0KHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0sCiAJcHV0X29hX2NvbmZp
ZyhkZXZfcHJpdiwgc3RyZWFtLT5vYV9jb25maWcpOwogCiAJaW50ZWxfdW5jb3JlX2ZvcmNld2Fr
ZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotCWludGVsX3J1bnRpbWVf
cG1fcHV0KGRldl9wcml2LCBzdHJlYW0tPndha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0
KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgc3RyZWFtLT53YWtlcmVmKTsKIAogZXJyX2NvbmZpZzoK
IAlpZiAoc3RyZWFtLT5jdHgpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3BtdS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wbXUuYwppbmRleCAxY2NkYTBlZTRm
ZjUuLjRjNmVkNjUyZTg0MCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9w
bXUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5jCkBAIC0xNzEsNyArMTcx
LDcgQEAgZW5naW5lc19zYW1wbGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1
bnNpZ25lZCBpbnQgcGVyaW9kX25zKQogCiAJd2FrZXJlZiA9IDA7CiAJaWYgKFJFQURfT05DRShk
ZXZfcHJpdi0+Z3QuYXdha2UpKQotCQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXRfaWZf
aW5fdXNlKGRldl9wcml2KTsKKwkJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2lu
X3VzZSgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOwogCWlmICghd2FrZXJlZikKIAkJcmV0dXJuOwog
CkBAIC0yMDcsNyArMjA3LDcgQEAgZW5naW5lc19zYW1wbGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LCB1bnNpZ25lZCBpbnQgcGVyaW9kX25zKQogCX0KIAlzcGluX3VubG9ja19p
cnFyZXN0b3JlKCZkZXZfcHJpdi0+dW5jb3JlLmxvY2ssIGZsYWdzKTsKIAotCWludGVsX3J1bnRp
bWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmZGV2
X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogfQogCiBzdGF0aWMgdm9pZApAQCAtNDQ1LDEw
ICs0NDUsMTAgQEAgc3RhdGljIHU2NCBnZXRfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQogCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CiAJdTY0IHZhbDsKIAotCXdha2VyZWYgPSBpbnRl
bF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UoaTkxNSk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRp
bWVfcG1fZ2V0X2lmX2luX3VzZSgmaTkxNS0+cnVudGltZV9wbSk7CiAJaWYgKHdha2VyZWYpIHsK
IAkJdmFsID0gX19nZXRfcmM2KGk5MTUpOwotCQlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3
YWtlcmVmKTsKKwkJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2Vy
ZWYpOwogCiAJCS8qCiAJCSAqIElmIHdlIGFyZSBjb21pbmcgYmFjayBmcm9tIGJlaW5nIHJ1bnRp
bWUgc3VzcGVuZGVkIHdlIG11c3QKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfc3lzZnMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc3lzZnMuYwppbmRleCAzZWYw
N2I5ODdkNDAuLjc1YWNiZjY4NmVjOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9zeXNmcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc3lzZnMuYwpAQCAt
MjY0LDcgKzI2NCw3IEBAIHN0YXRpYyBzc2l6ZV90IGd0X2FjdF9mcmVxX21oel9zaG93KHN0cnVj
dCBkZXZpY2UgKmtkZXYsCiAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7CiAJdTMyIGZyZXE7CiAK
LQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOworCXdha2VyZWYgPSBp
bnRlbF9ydW50aW1lX3BtX2dldCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOwogCiAJaWYgKElTX1ZB
TExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7CiAJCXZsdl9w
dW5pdF9nZXQoZGV2X3ByaXYpOwpAQCAtMjc2LDcgKzI3Niw3IEBAIHN0YXRpYyBzc2l6ZV90IGd0
X2FjdF9mcmVxX21oel9zaG93KHN0cnVjdCBkZXZpY2UgKmtkZXYsCiAJCWZyZXEgPSBpbnRlbF9n
ZXRfY2FnZihkZXZfcHJpdiwgSTkxNV9SRUFEKEdFTjZfUlBTVEFUMSkpOwogCX0KIAotCWludGVs
X3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1
dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCiAJcmV0dXJuIHNucHJpbnRmKGJ1
ZiwgUEFHRV9TSVpFLCAiJWRcbiIsIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBmcmVxKSk7CiB9
CkBAIC0zNjQsNyArMzY0LDcgQEAgc3RhdGljIHNzaXplX3QgZ3RfbWF4X2ZyZXFfbWh6X3N0b3Jl
KHN0cnVjdCBkZXZpY2UgKmtkZXYsCiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIAotCXdha2Vy
ZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7CisJd2FrZXJlZiA9IGludGVsX3J1
bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0+cnVudGltZV9wbSk7CiAJbXV0ZXhfbG9jaygmcnBzLT5s
b2NrKTsKIAogCXZhbCA9IGludGVsX2ZyZXFfb3Bjb2RlKGRldl9wcml2LCB2YWwpOwpAQCAtMzky
LDcgKzM5Miw3IEBAIHN0YXRpYyBzc2l6ZV90IGd0X21heF9mcmVxX21oel9zdG9yZShzdHJ1Y3Qg
ZGV2aWNlICprZGV2LAogCiB1bmxvY2s6CiAJbXV0ZXhfdW5sb2NrKCZycHMtPmxvY2spOwotCWlu
dGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3Bt
X3B1dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCiAJcmV0dXJuIHJldCA/OiBj
b3VudDsKIH0KQEAgLTQyMCw3ICs0MjAsNyBAQCBzdGF0aWMgc3NpemVfdCBndF9taW5fZnJlcV9t
aHpfc3RvcmUoc3RydWN0IGRldmljZSAqa2RldiwKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0Owog
Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKKwl3YWtlcmVmID0g
aW50ZWxfcnVudGltZV9wbV9nZXQoJmRldl9wcml2LT5ydW50aW1lX3BtKTsKIAltdXRleF9sb2Nr
KCZycHMtPmxvY2spOwogCiAJdmFsID0gaW50ZWxfZnJlcV9vcGNvZGUoZGV2X3ByaXYsIHZhbCk7
CkBAIC00NDQsNyArNDQ0LDcgQEAgc3RhdGljIHNzaXplX3QgZ3RfbWluX2ZyZXFfbWh6X3N0b3Jl
KHN0cnVjdCBkZXZpY2UgKmtkZXYsCiAKIHVubG9jazoKIAltdXRleF91bmxvY2soJnJwcy0+bG9j
ayk7Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOworCWludGVsX3J1
bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAKIAlyZXR1cm4g
cmV0ID86IGNvdW50OwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
ZGlzcGxheS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGlzcGxheS5jCmluZGV4IDkw
Y2QxZjUxZWRhNi4uODgyOWZlZTZhZjhmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9kaXNwbGF5LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGlzcGxh
eS5jCkBAIC0yMTAyLDcgKzIxMDIsNyBAQCBpbnRlbF9waW5fYW5kX2ZlbmNlX2ZiX29iaihzdHJ1
Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiwKIAkgKiBpbnRlbF9ydW50aW1lX3BtX3B1dCgpLCBzbyBp
dCBpcyBjb3JyZWN0IHRvIHdyYXAgb25seSB0aGUKIAkgKiBwaW4vdW5waW4vZmVuY2UgYW5kIG5v
dCBtb3JlLgogCSAqLwotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7
CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0+cnVudGltZV9wbSk7
CiAKIAlhdG9taWNfaW5jKCZkZXZfcHJpdi0+Z3B1X2Vycm9yLnBlbmRpbmdfZmJfcGluKTsKIApA
QCAtMjE1Nyw3ICsyMTU3LDcgQEAgaW50ZWxfcGluX2FuZF9mZW5jZV9mYl9vYmooc3RydWN0IGRy
bV9mcmFtZWJ1ZmZlciAqZmIsCiBlcnI6CiAJYXRvbWljX2RlYygmZGV2X3ByaXYtPmdwdV9lcnJv
ci5wZW5kaW5nX2ZiX3Bpbik7CiAKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2Fr
ZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtl
cmVmKTsKIAlyZXR1cm4gdm1hOwogfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9mYmRldi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZmJkZXYuYwppbmRl
eCA4OWRiNzE5OTYxNDguLjUyZDAxYjNmOTRmMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfZmJkZXYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9mYmRl
di5jCkBAIC0yMTMsNyArMjEzLDcgQEAgc3RhdGljIGludCBpbnRlbGZiX2NyZWF0ZShzdHJ1Y3Qg
ZHJtX2ZiX2hlbHBlciAqaGVscGVyLAogCX0KIAogCW11dGV4X2xvY2soJmRldi0+c3RydWN0X211
dGV4KTsKLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOworCXdha2Vy
ZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOwogCiAJLyog
UGluIHRoZSBHR1RUIHZtYSBmb3Igb3VyIGFjY2VzcyB2aWEgaW5mby0+c2NyZWVuX2Jhc2UuCiAJ
ICogVGhpcyBhbHNvIHZhbGlkYXRlcyB0aGF0IGFueSBleGlzdGluZyBmYiBpbmhlcml0ZWQgZnJv
bSB0aGUKQEAgLTI3Miw3ICsyNzIsNyBAQCBzdGF0aWMgaW50IGludGVsZmJfY3JlYXRlKHN0cnVj
dCBkcm1fZmJfaGVscGVyICpoZWxwZXIsCiAJaWZiZGV2LT52bWEgPSB2bWE7CiAJaWZiZGV2LT52
bWFfZmxhZ3MgPSBmbGFnczsKIAotCWludGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtl
cmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2Vy
ZWYpOwogCW11dGV4X3VubG9jaygmZGV2LT5zdHJ1Y3RfbXV0ZXgpOwogCXZnYV9zd2l0Y2hlcm9v
X2NsaWVudF9mYl9zZXQocGRldiwgaW5mbyk7CiAJcmV0dXJuIDA7CkBAIC0yODAsNyArMjgwLDcg
QEAgc3RhdGljIGludCBpbnRlbGZiX2NyZWF0ZShzdHJ1Y3QgZHJtX2ZiX2hlbHBlciAqaGVscGVy
LAogb3V0X3VucGluOgogCWludGVsX3VucGluX2ZiX3ZtYSh2bWEsIGZsYWdzKTsKIG91dF91bmxv
Y2s6Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOworCWludGVsX3J1
bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAJbXV0ZXhfdW5s
b2NrKCZkZXYtPnN0cnVjdF9tdXRleCk7CiAJcmV0dXJuIHJldDsKIH0KZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2hvdHBsdWcuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2hvdHBsdWcuYwppbmRleCBmZjllYjNjODU1ZDMuLmVhM2RlNGFjYzg1MCAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfaG90cGx1Zy5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX2hvdHBsdWcuYwpAQCAtMjMwLDcgKzIzMCw3IEBAIHN0YXRpYyB2
b2lkIGludGVsX2hwZF9pcnFfc3Rvcm1fcmVlbmFibGVfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3Qg
KndvcmspCiAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7CiAJZW51bSBocGRfcGluIHBpbjsKIAot
CXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7CisJd2FrZXJlZiA9IGlu
dGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0+cnVudGltZV9wbSk7CiAKIAlzcGluX2xvY2tf
aXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwogCWZvcl9lYWNoX2hwZF9waW4ocGluKSB7CkBAIC0y
NjMsNyArMjYzLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfaHBkX2lycV9zdG9ybV9yZWVuYWJsZV93
b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKIAkJZGV2X3ByaXYtPmRpc3BsYXkuaHBkX2ly
cV9zZXR1cChkZXZfcHJpdik7CiAJc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2sp
OwogCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOworCWludGVsX3J1
bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7CiB9CiAKIGJvb2wg
aW50ZWxfZW5jb2Rlcl9ob3RwbHVnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLApkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcnVudGltZV9wbS5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfcnVudGltZV9wbS5jCmluZGV4IDMxNTBkYmU0ZDFjMy4uNjlm
NzkzOTA0OTMyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ydW50aW1l
X3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcnVudGltZV9wbS5jCkBAIC0y
MDU5LDcgKzIwNTksNyBAQCBpbnRlbF93YWtlcmVmX3QgaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogCQkJCQllbnVtIGludGVsX2Rpc3Bs
YXlfcG93ZXJfZG9tYWluIGRvbWFpbikKIHsKIAlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpw
b3dlcl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOwotCWludGVsX3dha2VyZWZf
dCB3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOworCWludGVsX3dha2Vy
ZWZfdCB3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmRldl9wcml2LT5ydW50aW1lX3Bt
KTsKIAogCW11dGV4X2xvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwogCV9faW50ZWxfZGlzcGxh
eV9wb3dlcl9nZXRfZG9tYWluKGRldl9wcml2LCBkb21haW4pOwpAQCAtMjA4OCw3ICsyMDg4LDcg
QEAgaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCiAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7CiAJYm9vbCBpc19lbmFi
bGVkOwogCi0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3VzZShkZXZfcHJp
dik7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3VzZSgmZGV2X3ByaXYt
PnJ1bnRpbWVfcG0pOwogCWlmICghd2FrZXJlZikKIAkJcmV0dXJuIGZhbHNlOwogCkBAIC0yMTA0
LDcgKzIxMDQsNyBAQCBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAltdXRleF91bmxvY2soJnBvd2VyX2RvbWFpbnMt
PmxvY2spOwogCiAJaWYgKCFpc19lbmFibGVkKSB7Ci0JCWludGVsX3J1bnRpbWVfcG1fcHV0KGRl
dl9wcml2LCB3YWtlcmVmKTsKKwkJaW50ZWxfcnVudGltZV9wbV9wdXQoJmRldl9wcml2LT5ydW50
aW1lX3BtLCB3YWtlcmVmKTsKIAkJd2FrZXJlZiA9IDA7CiAJfQogCkBAIC0yMTYxLDcgKzIxNjEs
NyBAQCB2b2lkIGludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X3VuY2hlY2tlZChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJCQkJICAgICAgIGVudW0gaW50ZWxfZGlzcGxheV9wb3dl
cl9kb21haW4gZG9tYWluKQogewogCV9faW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYs
IGRvbWFpbik7Ci0JaW50ZWxfcnVudGltZV9wbV9wdXRfdW5jaGVja2VkKGRldl9wcml2KTsKKwlp
bnRlbF9ydW50aW1lX3BtX3B1dF91bmNoZWNrZWQoJmRldl9wcml2LT5ydW50aW1lX3BtKTsKIH0K
IAogc3RhdGljIHZvaWQKQEAgLTIxOTAsNyArMjE5MCw3IEBAIHJlbGVhc2VfYXN5bmNfcHV0X2Rv
bWFpbnMoc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucywgdTY0IG1hc2sp
CiAJICogcG93ZXIgd2VsbCBkaXNhYmxpbmcuCiAJICovCiAJYXNzZXJ0X3JwbV9yYXdfd2FrZXJl
Zl9oZWxkKCZkZXZfcHJpdi0+cnVudGltZV9wbSk7Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVf
cG1fZ2V0KGRldl9wcml2KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmRldl9w
cml2LT5ydW50aW1lX3BtKTsKIAogCWZvcl9lYWNoX3Bvd2VyX2RvbWFpbihkb21haW4sIG1hc2sp
IHsKIAkJLyogQ2xlYXIgYmVmb3JlIHB1dCwgc28gcHV0J3Mgc2FuaXR5IGNoZWNrIGlzIGhhcHB5
LiAqLwpAQCAtMjE5OCw3ICsyMTk4LDcgQEAgcmVsZWFzZV9hc3luY19wdXRfZG9tYWlucyhzdHJ1
Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zLCB1NjQgbWFzaykKIAkJX19pbnRl
bF9kaXNwbGF5X3Bvd2VyX3B1dF9kb21haW4oZGV2X3ByaXYsIGRvbWFpbik7CiAJfQogCi0JaW50
ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1f
cHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7CiB9CiAKIHN0YXRpYyB2b2lkCkBA
IC0yMjg5LDcgKzIyODksNyBAQCB2b2lkIF9faW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfYXN5bmMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJaWYgKHdvcmtfd2FrZXJlZikKIAkJaW50
ZWxfcnVudGltZV9wbV9wdXRfcmF3KHJwbSwgd29ya193YWtlcmVmKTsKIAotCWludGVsX3J1bnRp
bWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KHJwbSwgd2Fr
ZXJlZik7CiB9CiAKIC8qKgpAQCAtMjM2NCw3ICsyMzY0LDcgQEAgdm9pZCBpbnRlbF9kaXNwbGF5
X3Bvd2VyX3B1dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJCQkgICAgIGlu
dGVsX3dha2VyZWZfdCB3YWtlcmVmKQogewogCV9faW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2
X3ByaXYsIGRvbWFpbik7Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYp
OworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7
CiB9CiAjZW5kaWYKIApAQCAtNDc3Niw3ICs0Nzc2LDcgQEAgdm9pZCBpbnRlbF9wb3dlcl9kb21h
aW5zX2ZpbmlfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJaW50ZWxfcG93ZXJf
ZG9tYWluc192ZXJpZnlfc3RhdGUoaTkxNSk7CiAKIAkvKiBLZWVwIHRoZSBwb3dlciB3ZWxsIGVu
YWJsZWQsIGJ1dCBjYW5jZWwgaXRzIHJwbSB3YWtlcmVmLiAqLwotCWludGVsX3J1bnRpbWVfcG1f
cHV0KGk5MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1l
X3BtLCB3YWtlcmVmKTsKIH0KIAogLyoqCkBAIC01MDA3LDcgKzUwMDcsNyBAQCBzdGF0aWMgaW50
ZWxfd2FrZXJlZl90IGludGVsX3J1bnRpbWVfcG1fZ2V0X3JhdyhzdHJ1Y3QgaW50ZWxfcnVudGlt
ZV9wbSAqcnBtKQogCiAvKioKICAqIGludGVsX3J1bnRpbWVfcG1fZ2V0IC0gZ3JhYiBhIHJ1bnRp
bWUgcG0gcmVmZXJlbmNlCi0gKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFuY2UKKyAqIEBycG06
IHRoZSBpbnRlbF9ydW50aW1lX3BtIHN0cnVjdHVyZQogICoKICAqIFRoaXMgZnVuY3Rpb24gZ3Jh
YnMgYSBkZXZpY2UtbGV2ZWwgcnVudGltZSBwbSByZWZlcmVuY2UgKG1vc3RseSB1c2VkIGZvciBH
RU0KICAqIGNvZGUgdG8gZW5zdXJlIHRoZSBHVFQgb3IgR1QgaXMgb24pIGFuZCBlbnN1cmVzIHRo
YXQgaXQgaXMgcG93ZXJlZCB1cC4KQEAgLTUwMTcsMTQgKzUwMTcsMTQgQEAgc3RhdGljIGludGVs
X3dha2VyZWZfdCBpbnRlbF9ydW50aW1lX3BtX2dldF9yYXcoc3RydWN0IGludGVsX3J1bnRpbWVf
cG0gKnJwbSkKICAqCiAgKiBSZXR1cm5zOiB0aGUgd2FrZXJlZiBjb29raWUgdG8gcGFzcyB0byBp
bnRlbF9ydW50aW1lX3BtX3B1dCgpCiAgKi8KLWludGVsX3dha2VyZWZfdCBpbnRlbF9ydW50aW1l
X3BtX2dldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKK2ludGVsX3dha2VyZWZfdCBp
bnRlbF9ydW50aW1lX3BtX2dldChzdHJ1Y3QgaW50ZWxfcnVudGltZV9wbSAqcnBtKQogewotCXJl
dHVybiBfX2ludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtLCB0cnVlKTsKKwly
ZXR1cm4gX19pbnRlbF9ydW50aW1lX3BtX2dldChycG0sIHRydWUpOwogfQogCiAvKioKICAqIGlu
dGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3VzZSAtIGdyYWIgYSBydW50aW1lIHBtIHJlZmVyZW5j
ZSBpZiBkZXZpY2UgaW4gdXNlCi0gKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFuY2UKKyAqIEBy
cG06IHRoZSBpbnRlbF9ydW50aW1lX3BtIHN0cnVjdHVyZQogICoKICAqIFRoaXMgZnVuY3Rpb24g
Z3JhYnMgYSBkZXZpY2UtbGV2ZWwgcnVudGltZSBwbSByZWZlcmVuY2UgaWYgdGhlIGRldmljZSBp
cwogICogYWxyZWFkeSBpbiB1c2UgYW5kIGVuc3VyZXMgdGhhdCBpdCBpcyBwb3dlcmVkIHVwLiBJ
dCBpcyBpbGxlZ2FsIHRvIHRyeQpAQCAtNTAzNiwxMCArNTAzNiw4IEBAIGludGVsX3dha2VyZWZf
dCBpbnRlbF9ydW50aW1lX3BtX2dldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKICAq
IFJldHVybnM6IHRoZSB3YWtlcmVmIGNvb2tpZSB0byBwYXNzIHRvIGludGVsX3J1bnRpbWVfcG1f
cHV0KCksIGV2YWx1YXRlcwogICogYXMgVHJ1ZSBpZiB0aGUgd2FrZXJlZiB3YXMgYWNxdWlyZWQs
IG9yIEZhbHNlIG90aGVyd2lzZS4KICAqLwotaW50ZWxfd2FrZXJlZl90IGludGVsX3J1bnRpbWVf
cG1fZ2V0X2lmX2luX3VzZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKK2ludGVsX3dh
a2VyZWZfdCBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2Uoc3RydWN0IGludGVsX3J1bnRp
bWVfcG0gKnJwbSkKIHsKLQlzdHJ1Y3QgaW50ZWxfcnVudGltZV9wbSAqcnBtID0gJmk5MTUtPnJ1
bnRpbWVfcG07Ci0KIAlpZiAoSVNfRU5BQkxFRChDT05GSUdfUE0pKSB7CiAJCS8qCiAJCSAqIElu
IGNhc2VzIHJ1bnRpbWUgUE0gaXMgZGlzYWJsZWQgYnkgdGhlIFJQTSBjb3JlIGFuZCB3ZSBnZXQK
QEAgLTUwNTgsNyArNTA1Niw3IEBAIGludGVsX3dha2VyZWZfdCBpbnRlbF9ydW50aW1lX3BtX2dl
dF9pZl9pbl91c2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAKIC8qKgogICogaW50
ZWxfcnVudGltZV9wbV9nZXRfbm9yZXN1bWUgLSBncmFiIGEgcnVudGltZSBwbSByZWZlcmVuY2UK
LSAqIEBpOTE1OiBpOTE1IGRldmljZSBpbnN0YW5jZQorICogQHJwbTogdGhlIGludGVsX3J1bnRp
bWVfcG0gc3RydWN0dXJlCiAgKgogICogVGhpcyBmdW5jdGlvbiBncmFicyBhIGRldmljZS1sZXZl
bCBydW50aW1lIHBtIHJlZmVyZW5jZSAobW9zdGx5IHVzZWQgZm9yIEdFTQogICogY29kZSB0byBl
bnN1cmUgdGhlIEdUVCBvciBHVCBpcyBvbikuCkBAIC01MDc1LDEwICs1MDczLDggQEAgaW50ZWxf
d2FrZXJlZl90IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3VzZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKICAqCiAgKiBSZXR1cm5zOiB0aGUgd2FrZXJlZiBjb29raWUgdG8gcGFz
cyB0byBpbnRlbF9ydW50aW1lX3BtX3B1dCgpCiAgKi8KLWludGVsX3dha2VyZWZfdCBpbnRlbF9y
dW50aW1lX3BtX2dldF9ub3Jlc3VtZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKK2lu
dGVsX3dha2VyZWZfdCBpbnRlbF9ydW50aW1lX3BtX2dldF9ub3Jlc3VtZShzdHJ1Y3QgaW50ZWxf
cnVudGltZV9wbSAqcnBtKQogewotCXN0cnVjdCBpbnRlbF9ydW50aW1lX3BtICpycG0gPSAmaTkx
NS0+cnVudGltZV9wbTsKLQogCWFzc2VydF9ycG1fd2FrZWxvY2tfaGVsZChycG0pOwogCXBtX3J1
bnRpbWVfZ2V0X25vcmVzdW1lKHJwbS0+a2Rldik7CiAKQEAgLTUxMTEsNyArNTEwNyw3IEBAIGlu
dGVsX3J1bnRpbWVfcG1fcHV0X3JhdyhzdHJ1Y3QgaW50ZWxfcnVudGltZV9wbSAqcnBtLCBpbnRl
bF93YWtlcmVmX3Qgd3JlZikKIAogLyoqCiAgKiBpbnRlbF9ydW50aW1lX3BtX3B1dF91bmNoZWNr
ZWQgLSByZWxlYXNlIGFuIHVuY2hlY2tlZCBydW50aW1lIHBtIHJlZmVyZW5jZQotICogQGk5MTU6
IGk5MTUgZGV2aWNlIGluc3RhbmNlCisgKiBAcnBtOiB0aGUgaW50ZWxfcnVudGltZV9wbSBzdHJ1
Y3R1cmUKICAqCiAgKiBUaGlzIGZ1bmN0aW9uIGRyb3BzIHRoZSBkZXZpY2UtbGV2ZWwgcnVudGlt
ZSBwbSByZWZlcmVuY2Ugb2J0YWluZWQgYnkKICAqIGludGVsX3J1bnRpbWVfcG1fZ2V0KCkgYW5k
IG1pZ2h0IHBvd2VyIGRvd24gdGhlIGNvcnJlc3BvbmRpbmcKQEAgLTUxMjEsMjQgKzUxMTcsMjQg
QEAgaW50ZWxfcnVudGltZV9wbV9wdXRfcmF3KHN0cnVjdCBpbnRlbF9ydW50aW1lX3BtICpycG0s
IGludGVsX3dha2VyZWZfdCB3cmVmKQogICogbmV3IGNvZGUsIGFzIHRoZSBjb3JyZWN0bmVzcyBv
ZiBpdHMgdXNlIGNhbm5vdCBiZSBjaGVja2VkLiBBbHdheXMgdXNlCiAgKiBpbnRlbF9ydW50aW1l
X3BtX3B1dCgpIGluc3RlYWQuCiAgKi8KLXZvaWQgaW50ZWxfcnVudGltZV9wbV9wdXRfdW5jaGVj
a2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQordm9pZCBpbnRlbF9ydW50aW1lX3Bt
X3B1dF91bmNoZWNrZWQoc3RydWN0IGludGVsX3J1bnRpbWVfcG0gKnJwbSkKIHsKLQlfX2ludGVs
X3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCAtMSwgdHJ1ZSk7CisJX19pbnRlbF9y
dW50aW1lX3BtX3B1dChycG0sIC0xLCB0cnVlKTsKIH0KIAogI2lmIElTX0VOQUJMRUQoQ09ORklH
X0RSTV9JOTE1X0RFQlVHX1JVTlRJTUVfUE0pCiAvKioKICAqIGludGVsX3J1bnRpbWVfcG1fcHV0
IC0gcmVsZWFzZSBhIHJ1bnRpbWUgcG0gcmVmZXJlbmNlCi0gKiBAaTkxNTogaTkxNSBkZXZpY2Ug
aW5zdGFuY2UKKyAqIEBycG06IHRoZSBpbnRlbF9ydW50aW1lX3BtIHN0cnVjdHVyZQogICogQHdy
ZWY6IHdha2VyZWYgYWNxdWlyZWQgZm9yIHRoZSByZWZlcmVuY2UgdGhhdCBpcyBiZWluZyByZWxl
YXNlZAogICoKICAqIFRoaXMgZnVuY3Rpb24gZHJvcHMgdGhlIGRldmljZS1sZXZlbCBydW50aW1l
IHBtIHJlZmVyZW5jZSBvYnRhaW5lZCBieQogICogaW50ZWxfcnVudGltZV9wbV9nZXQoKSBhbmQg
bWlnaHQgcG93ZXIgZG93biB0aGUgY29ycmVzcG9uZGluZwogICogaGFyZHdhcmUgYmxvY2sgcmln
aHQgYXdheSBpZiB0aGlzIGlzIHRoZSBsYXN0IHJlZmVyZW5jZS4KICAqLwotdm9pZCBpbnRlbF9y
dW50aW1lX3BtX3B1dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50ZWxfd2FrZXJl
Zl90IHdyZWYpCit2b2lkIGludGVsX3J1bnRpbWVfcG1fcHV0KHN0cnVjdCBpbnRlbF9ydW50aW1l
X3BtICpycG0sIGludGVsX3dha2VyZWZfdCB3cmVmKQogewotCV9faW50ZWxfcnVudGltZV9wbV9w
dXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdyZWYsIHRydWUpOworCV9faW50ZWxfcnVudGltZV9wbV9w
dXQocnBtLCB3cmVmLCB0cnVlKTsKIH0KICNlbmRpZgogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF9ydW50aW1lX3BtLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9ydW50aW1lX3BtLmgKaW5kZXggM2NlYzNiOTAyNzRhLi5jMzg5ZTVmOGYyYzEgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3J1bnRpbWVfcG0uaAorKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9ydW50aW1lX3BtLmgKQEAgLTI0NiwyNiArMjQ2LDI2IEBAIGlu
dGVsX2Rpc3BsYXlfcG93ZXJfcHV0X2FzeW5jKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAogdm9pZCBpY2xfZGJ1Zl9zbGljZXNfdXBkYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKIAkJCSAgICB1OCByZXFfc2xpY2VzKTsKIAotaW50ZWxfd2FrZXJlZl90IGludGVs
X3J1bnRpbWVfcG1fZ2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKLWludGVsX3dh
a2VyZWZfdCBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2Uoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpOwotaW50ZWxfd2FrZXJlZl90IGludGVsX3J1bnRpbWVfcG1fZ2V0X25vcmVz
dW1lKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKK2ludGVsX3dha2VyZWZfdCBpbnRl
bF9ydW50aW1lX3BtX2dldChzdHJ1Y3QgaW50ZWxfcnVudGltZV9wbSAqcnBtKTsKK2ludGVsX3dh
a2VyZWZfdCBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2Uoc3RydWN0IGludGVsX3J1bnRp
bWVfcG0gKnJwbSk7CitpbnRlbF93YWtlcmVmX3QgaW50ZWxfcnVudGltZV9wbV9nZXRfbm9yZXN1
bWUoc3RydWN0IGludGVsX3J1bnRpbWVfcG0gKnJwbSk7CiAKICNkZWZpbmUgd2l0aF9pbnRlbF9y
dW50aW1lX3BtKGk5MTUsIHdmKSBcCi0JZm9yICgod2YpID0gaW50ZWxfcnVudGltZV9wbV9nZXQo
aTkxNSk7ICh3Zik7IFwKLQkgICAgIGludGVsX3J1bnRpbWVfcG1fcHV0KChpOTE1KSwgKHdmKSks
ICh3ZikgPSAwKQorCWZvciAoKHdmKSA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCYoaTkxNSktPnJ1
bnRpbWVfcG0pOyAod2YpOyBcCisJICAgICBpbnRlbF9ydW50aW1lX3BtX3B1dCgmKGk5MTUpLT5y
dW50aW1lX3BtLCAod2YpKSwgKHdmKSA9IDApCiAKICNkZWZpbmUgd2l0aF9pbnRlbF9ydW50aW1l
X3BtX2lmX2luX3VzZShpOTE1LCB3ZikgXAotCWZvciAoKHdmKSA9IGludGVsX3J1bnRpbWVfcG1f
Z2V0X2lmX2luX3VzZShpOTE1KTsgKHdmKTsgXAotCSAgICAgaW50ZWxfcnVudGltZV9wbV9wdXQo
KGk5MTUpLCAod2YpKSwgKHdmKSA9IDApCisJZm9yICgod2YpID0gaW50ZWxfcnVudGltZV9wbV9n
ZXRfaWZfaW5fdXNlKCYoaTkxNSktPnJ1bnRpbWVfcG0pOyAod2YpOyBcCisJICAgICBpbnRlbF9y
dW50aW1lX3BtX3B1dCgmKGk5MTUpLT5ydW50aW1lX3BtLCAod2YpKSwgKHdmKSA9IDApCiAKLXZv
aWQgaW50ZWxfcnVudGltZV9wbV9wdXRfdW5jaGVja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KTsKK3ZvaWQgaW50ZWxfcnVudGltZV9wbV9wdXRfdW5jaGVja2VkKHN0cnVjdCBpbnRl
bF9ydW50aW1lX3BtICpycG0pOwogI2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X0RFQlVH
X1JVTlRJTUVfUE0pCi12b2lkIGludGVsX3J1bnRpbWVfcG1fcHV0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LCBpbnRlbF93YWtlcmVmX3Qgd3JlZik7Cit2b2lkIGludGVsX3J1bnRpbWVf
cG1fcHV0KHN0cnVjdCBpbnRlbF9ydW50aW1lX3BtICpycG0sIGludGVsX3dha2VyZWZfdCB3cmVm
KTsKICNlbHNlCiBzdGF0aWMgaW5saW5lIHZvaWQKLWludGVsX3J1bnRpbWVfcG1fcHV0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBpbnRlbF93YWtlcmVmX3Qgd3JlZikKK2ludGVsX3J1
bnRpbWVfcG1fcHV0KHN0cnVjdCBpbnRlbF9ydW50aW1lX3BtICpycG0sIGludGVsX3dha2VyZWZf
dCB3cmVmKQogewotCWludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tlZChpOTE1KTsKKwlpbnRl
bF9ydW50aW1lX3BtX3B1dF91bmNoZWNrZWQocnBtKTsKIH0KICNlbmRpZgogCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF93YWtlcmVmLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF93YWtlcmVmLmMKaW5kZXggOTExOTZkOTYxMmJiLi5lYmM4NGZjY2Q4MGYgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3dha2VyZWYuYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF93YWtlcmVmLmMKQEAgLTksMTQgKzksMTQgQEAKIAogc3Rh
dGljIHZvaWQgcnBtX2dldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgc3RydWN0IGlu
dGVsX3dha2VyZWYgKndmKQogewotCXdmLT53YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQo
aTkxNSk7CisJd2YtPndha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGlt
ZV9wbSk7CiB9CiAKIHN0YXRpYyB2b2lkIHJwbV9wdXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsIHN0cnVjdCBpbnRlbF93YWtlcmVmICp3ZikKIHsKIAlpbnRlbF93YWtlcmVmX3Qgd2Fr
ZXJlZiA9IGZldGNoX2FuZF96ZXJvKCZ3Zi0+d2FrZXJlZik7CiAKLQlpbnRlbF9ydW50aW1lX3Bt
X3B1dChpOTE1LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGlt
ZV9wbSwgd2FrZXJlZik7CiAJR0VNX0JVR19PTighd2FrZXJlZik7CiB9CiAKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9odWdlX3BhZ2VzLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9zZWxmdGVzdHMvaHVnZV9wYWdlcy5jCmluZGV4IDFlMWY4MzMyNmE5Ni4uYWZi
OTBiNzlkMzI2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaHVn
ZV9wYWdlcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9odWdlX3BhZ2Vz
LmMKQEAgLTE3NzAsNyArMTc3MCw3IEBAIGludCBpOTE1X2dlbV9odWdlX3BhZ2VfbGl2ZV9zZWxm
dGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCQlyZXR1cm4gUFRSX0VS
UihmaWxlKTsKIAogCW11dGV4X2xvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKLQl3
YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOworCXdha2VyZWYgPSBpbnRl
bF9ydW50aW1lX3BtX2dldCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOwogCiAJY3R4ID0gbGl2ZV9j
b250ZXh0KGRldl9wcml2LCBmaWxlKTsKIAlpZiAoSVNfRVJSKGN0eCkpIHsKQEAgLTE3ODQsNyAr
MTc4NCw3IEBAIGludCBpOTE1X2dlbV9odWdlX3BhZ2VfbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCWVyciA9IGk5MTVfc3VidGVzdHModGVzdHMsIGN0
eCk7CiAKIG91dF91bmxvY2s6Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2Vy
ZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJl
Zik7CiAJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7CiAKIAltb2Nr
X2ZpbGVfZnJlZShkZXZfcHJpdiwgZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9zZWxmdGVzdHMvaTkxNV9hY3RpdmUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0
ZXN0cy9pOTE1X2FjdGl2ZS5jCmluZGV4IGVlZTgzOGRjMDYzNC4uZjYzMzFmMWFhMDk3IDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9hY3RpdmUuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9hY3RpdmUuYwpAQCAtOTUsNyAr
OTUsNyBAQCBzdGF0aWMgaW50IGxpdmVfYWN0aXZlX3dhaXQodm9pZCAqYXJnKQogCS8qIENoZWNr
IHRoYXQgd2UgZ2V0IGEgY2FsbGJhY2sgd2hlbiByZXF1ZXN0cyByZXRpcmUgdXBvbiB3YWl0aW5n
ICovCiAKIAltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQl3YWtlcmVmID0g
aW50ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1f
Z2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKIAogCWVyciA9IF9fbGl2ZV9hY3RpdmVfc2V0dXAoaTkx
NSwgJmFjdGl2ZSk7CiAKQEAgLTEwOSw3ICsxMDksNyBAQCBzdGF0aWMgaW50IGxpdmVfYWN0aXZl
X3dhaXQodm9pZCAqYXJnKQogCWlmIChpZ3RfZmx1c2hfdGVzdChpOTE1LCBJOTE1X1dBSVRfTE9D
S0VEKSkKIAkJZXJyID0gLUVJTzsKIAotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2Vy
ZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsK
IAltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCXJldHVybiBlcnI7CiB9
CkBAIC0xMjQsNyArMTI0LDcgQEAgc3RhdGljIGludCBsaXZlX2FjdGl2ZV9yZXRpcmUodm9pZCAq
YXJnKQogCS8qIENoZWNrIHRoYXQgd2UgZ2V0IGEgY2FsbGJhY2sgd2hlbiByZXF1ZXN0cyBhcmUg
aW5kaXJlY3RseSByZXRpcmVkICovCiAKIAltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211
dGV4KTsKLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7CisJd2FrZXJlZiA9
IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKIAogCWVyciA9IF9fbGl2
ZV9hY3RpdmVfc2V0dXAoaTkxNSwgJmFjdGl2ZSk7CiAKQEAgLTEzOCw3ICsxMzgsNyBAQCBzdGF0
aWMgaW50IGxpdmVfYWN0aXZlX3JldGlyZSh2b2lkICphcmcpCiAJfQogCiAJaTkxNV9hY3RpdmVf
ZmluaSgmYWN0aXZlLmJhc2UpOwotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYp
OworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAlt
dXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCXJldHVybiBlcnI7CiB9CmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW0uYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbS5jCmluZGV4IGM2YTliZmY4NTMx
MS4uYzY5ODVkYTI5NzQyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVz
dHMvaTkxNV9nZW0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9n
ZW0uYwpAQCAtNjEsNyArNjEsNyBAQCBzdGF0aWMgdm9pZCBzaW11bGF0ZV9oaWJlcm5hdGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7CiAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7
CiAKLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7CisJd2FrZXJlZiA9IGlu
dGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKIAogCS8qCiAJICogQXMgYSBm
aW5hbCBzdGluZyBpbiB0aGUgdGFpbCwgaW52YWxpZGF0ZSBzdG9sZW4uIFVuZGVyIGEgcmVhbCBT
NCwKQEAgLTcyLDcgKzcyLDcgQEAgc3RhdGljIHZvaWQgc2ltdWxhdGVfaGliZXJuYXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCSAqLwogCXRyYXNoX3N0b2xlbihpOTE1KTsKIAot
CWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1f
cHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIH0KIAogc3RhdGljIGludCBwbV9wcmVw
YXJlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2NvaGVyZW5jeS5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2NvaGVyZW5jeS5jCmluZGV4IDA0NmEzODc0MzE1
Mi4uNWNhNGViMzFkNzMyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVz
dHMvaTkxNV9nZW1fY29oZXJlbmN5LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRl
c3RzL2k5MTVfZ2VtX2NvaGVyZW5jeS5jCkBAIC0yOTksNyArMjk5LDcgQEAgc3RhdGljIGludCBp
Z3RfZ2VtX2NvaGVyZW5jeSh2b2lkICphcmcpCiAJdmFsdWVzID0gb2Zmc2V0cyArIG5jYWNoZWxp
bmVzOwogCiAJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0Jd2FrZXJlZiA9
IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3Bt
X2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAJZm9yIChvdmVyID0gaWd0X2NvaGVyZW5jeV9tb2Rl
OyBvdmVyLT5uYW1lOyBvdmVyKyspIHsKIAkJaWYgKCFvdmVyLT5zZXQpCiAJCQljb250aW51ZTsK
QEAgLTM3Nyw3ICszNzcsNyBAQCBzdGF0aWMgaW50IGlndF9nZW1fY29oZXJlbmN5KHZvaWQgKmFy
ZykKIAkJfQogCX0KIHVubG9jazoKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVm
KTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAJ
bXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlrZnJlZShvZmZzZXRzKTsK
IAlyZXR1cm4gZXJyOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3Rz
L2k5MTVfZ2VtX2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1
X2dlbV9jb250ZXh0LmMKaW5kZXggMzRhYzVjYzZkNTlmLi4xYTY3ZTBjNzQyYmMgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQuYwpAQCAt
NjksNyArNjksNyBAQCBzdGF0aWMgaW50IGxpdmVfbm9wX3N3aXRjaCh2b2lkICphcmcpCiAJCXJl
dHVybiBQVFJfRVJSKGZpbGUpOwogCiAJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRl
eCk7Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCXdha2VyZWYgPSBp
bnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAKIAljdHggPSBrY2FsbG9j
KG5jdHgsIHNpemVvZigqY3R4KSwgR0ZQX0tFUk5FTCk7CiAJaWYgKCFjdHgpIHsKQEAgLTE3Miw3
ICsxNzIsNyBAQCBzdGF0aWMgaW50IGxpdmVfbm9wX3N3aXRjaCh2b2lkICphcmcpCiAJfQogCiBv
dXRfdW5sb2NrOgotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWludGVs
X3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAltdXRleF91bmxv
Y2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUp
OwogCXJldHVybiBlcnI7CkBAIC0xMDkzLDcgKzEwOTMsNyBAQCBfX2lndF9jdHhfc3NldShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJZ290byBvdXRfdW5sb2NrOwogCX0KIAotCXdh
a2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVu
dGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCiAJY2UgPSBpOTE1X2dlbV9jb250ZXh0
X2dldF9lbmdpbmUoY3R4LCBSQ1MwKTsKIAlpZiAoSVNfRVJSKGNlKSkgewpAQCAtMTEzMyw3ICsx
MTMzLDcgQEAgX19pZ3RfY3R4X3NzZXUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiBv
dXRfY29udGV4dDoKIAlpbnRlbF9jb250ZXh0X3B1dChjZSk7CiBvdXRfcnBtOgotCWludGVsX3J1
bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1
LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CiAKIG91
dF91bmxvY2s6CkBAIC0xNTQ0LDcgKzE1NDQsNyBAQCBzdGF0aWMgaW50IGlndF92bV9pc29sYXRp
b24odm9pZCAqYXJnKQogCUdFTV9CVUdfT04oY3R4X2ItPnBwZ3R0LT52bS50b3RhbCAhPSB2bV90
b3RhbCk7CiAJdm1fdG90YWwgLT0gSTkxNV9HVFRfUEFHRV9TSVpFOwogCi0Jd2FrZXJlZiA9IGlu
dGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dl
dCgmaTkxNS0+cnVudGltZV9wbSk7CiAKIAljb3VudCA9IDA7CiAJZm9yX2VhY2hfZW5naW5lKGVu
Z2luZSwgaTkxNSwgaWQpIHsKQEAgLTE1ODksNyArMTU4OSw3IEBAIHN0YXRpYyBpbnQgaWd0X3Zt
X2lzb2xhdGlvbih2b2lkICphcmcpCiAJCWNvdW50LCBSVU5USU1FX0lORk8oaTkxNSktPm51bV9l
bmdpbmVzKTsKIAogb3V0X3JwbToKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVm
KTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CiBv
dXRfdW5sb2NrOgogCWlmIChpZ3RfbGl2ZV90ZXN0X2VuZCgmdCkpCiAJCWVyciA9IC1FSU87CmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZXZpY3Qu
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ldmljdC5jCmluZGV4
IDRmYzZlNTQ0NWRkMS4uZjdmYjJkYTY4OWJhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZXZpY3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9zZWxmdGVzdHMvaTkxNV9nZW1fZXZpY3QuYwpAQCAtMzk4LDcgKzM5OCw3IEBAIHN0YXRpYyBp
bnQgaWd0X2V2aWN0X2NvbnRleHRzKHZvaWQgKmFyZykKIAkJcmV0dXJuIDA7CiAKIAltdXRleF9s
b2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9w
bV9nZXQoaTkxNSk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50
aW1lX3BtKTsKIAogCS8qIFJlc2VydmUgYSBibG9jayBzbyB0aGF0IHdlIGtub3cgd2UgaGF2ZSBl
bm91Z2ggdG8gZml0IGEgZmV3IHJxICovCiAJbWVtc2V0KCZob2xlLCAwLCBzaXplb2YoaG9sZSkp
OwpAQCAtNTA5LDcgKzUwOSw3IEBAIHN0YXRpYyBpbnQgaWd0X2V2aWN0X2NvbnRleHRzKHZvaWQg
KmFyZykKIAl9CiAJaWYgKGRybV9tbV9ub2RlX2FsbG9jYXRlZCgmaG9sZSkpCiAJCWRybV9tbV9y
ZW1vdmVfbm9kZSgmaG9sZSk7Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7
CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCW11
dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAKIAlyZXR1cm4gZXJyOwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jCmluZGV4IDljY2E2
NmU0NDIwYS4uMDE1MWUzNWQ5OGUwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9z
ZWxmdGVzdHMvaTkxNV9nZW1fZ3R0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRl
c3RzL2k5MTVfZ2VtX2d0dC5jCkBAIC0yOTQsOSArMjk0LDkgQEAgc3RhdGljIGludCBsb3dsZXZl
bF9ob2xlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCQkJbW9ja192bWEubm9kZS5z
aXplID0gQklUX1VMTChzaXplKTsKIAkJCW1vY2tfdm1hLm5vZGUuc3RhcnQgPSBhZGRyOwogCi0J
CQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7CisJCQl3YWtlcmVmID0gaW50
ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCQkJdm0tPmluc2VydF9lbnRy
aWVzKHZtLCAmbW9ja192bWEsIEk5MTVfQ0FDSEVfTk9ORSwgMCk7Ci0JCQlpbnRlbF9ydW50aW1l
X3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKKwkJCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5y
dW50aW1lX3BtLCB3YWtlcmVmKTsKIAkJfQogCQljb3VudCA9IG47CiAKQEAgLTExNzAsNyArMTE3
MCw3IEBAIHN0YXRpYyBpbnQgaWd0X2dndHRfcGFnZSh2b2lkICphcmcpCiAJaWYgKGVycikKIAkJ
Z290byBvdXRfdW5waW47CiAKLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7
CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKIAog
CWZvciAobiA9IDA7IG4gPCBjb3VudDsgbisrKSB7CiAJCXU2NCBvZmZzZXQgPSB0bXAuc3RhcnQg
KyBuICogUEFHRV9TSVpFOwpAQCAtMTIxNyw3ICsxMjE3LDcgQEAgc3RhdGljIGludCBpZ3RfZ2d0
dF9wYWdlKHZvaWQgKmFyZykKIAlrZnJlZShvcmRlcik7CiBvdXRfcmVtb3ZlOgogCWdndHQtPnZt
LmNsZWFyX3JhbmdlKCZnZ3R0LT52bSwgdG1wLnN0YXJ0LCB0bXAuc2l6ZSk7Ci0JaW50ZWxfcnVu
dGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUt
PnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCWRybV9tbV9yZW1vdmVfbm9kZSgmdG1wKTsKIG91dF91
bnBpbjoKIAlpOTE1X2dlbV9vYmplY3RfdW5waW5fcGFnZXMob2JqKTsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9vYmplY3QuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9vYmplY3QuYwppbmRleCBiOTI2ZDFjZDE2
NWQuLmVkOWQ2YzQzMTEzYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRl
c3RzL2k5MTVfZ2VtX29iamVjdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0
cy9pOTE1X2dlbV9vYmplY3QuYwpAQCAtMzM1LDcgKzMzNSw3IEBAIHN0YXRpYyBpbnQgaWd0X3Bh
cnRpYWxfdGlsaW5nKHZvaWQgKmFyZykKIAl9CiAKIAltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3Ry
dWN0X211dGV4KTsKLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7CisJd2Fr
ZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKIAogCWlmICgx
KSB7CiAJCUlHVF9USU1FT1VUKGVuZCk7CkBAIC00NDYsNyArNDQ2LDcgQEAgbmV4dF90aWxpbmc6
IDsKIAl9CiAKIG91dF91bmxvY2s6Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJl
Zik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwog
CW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJaTkxNV9nZW1fb2JqZWN0
X3VucGluX3BhZ2VzKG9iaik7CiBvdXQ6CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9zZWxmdGVzdHMvaTkxNV9yZXF1ZXN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVz
dHMvaTkxNV9yZXF1ZXN0LmMKaW5kZXggYjYwNTkxNTMxZTRhLi45YTM3NjA2MjI3YmQgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3JlcXVlc3QuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9yZXF1ZXN0LmMKQEAgLTUzNSw3
ICs1MzUsNyBAQCBzdGF0aWMgaW50IGxpdmVfbm9wX3JlcXVlc3Qodm9pZCAqYXJnKQogCSAqLwog
CiAJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0Jd2FrZXJlZiA9IGludGVs
X3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgm
aTkxNS0+cnVudGltZV9wbSk7CiAKIAlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkg
ewogCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0ID0gTlVMTDsKQEAgLTU5NSw3ICs1OTUs
NyBAQCBzdGF0aWMgaW50IGxpdmVfbm9wX3JlcXVlc3Qodm9pZCAqYXJnKQogCX0KIAogb3V0X3Vu
bG9jazoKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50
aW1lX3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAJbXV0ZXhfdW5sb2NrKCZp
OTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlyZXR1cm4gZXJyOwogfQpAQCAtNjgwLDcgKzY4MCw3
IEBAIHN0YXRpYyBpbnQgbGl2ZV9lbXB0eV9yZXF1ZXN0KHZvaWQgKmFyZykKIAkgKi8KIAogCW11
dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCXdha2VyZWYgPSBpbnRlbF9ydW50
aW1lX3BtX2dldChpOTE1KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUt
PnJ1bnRpbWVfcG0pOwogCiAJYmF0Y2ggPSBlbXB0eV9iYXRjaChpOTE1KTsKIAlpZiAoSVNfRVJS
KGJhdGNoKSkgewpAQCAtNzQ0LDcgKzc0NCw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9lbXB0eV9yZXF1
ZXN0KHZvaWQgKmFyZykKIAlpOTE1X3ZtYV91bnBpbihiYXRjaCk7CiAJaTkxNV92bWFfcHV0KGJh
dGNoKTsKIG91dF91bmxvY2s6Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7
CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCW11
dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJcmV0dXJuIGVycjsKIH0KQEAg
LTgzOCw3ICs4MzgsNyBAQCBzdGF0aWMgaW50IGxpdmVfYWxsX2VuZ2luZXModm9pZCAqYXJnKQog
CSAqLwogCiAJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0Jd2FrZXJlZiA9
IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3Bt
X2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAKIAllcnIgPSBpZ3RfbGl2ZV90ZXN0X2JlZ2luKCZ0
LCBpOTE1LCBfX2Z1bmNfXywgIiIpOwogCWlmIChlcnIpCkBAIC05MjEsNyArOTIxLDcgQEAgc3Rh
dGljIGludCBsaXZlX2FsbF9lbmdpbmVzKHZvaWQgKmFyZykKIAlpOTE1X3ZtYV91bnBpbihiYXRj
aCk7CiAJaTkxNV92bWFfcHV0KGJhdGNoKTsKIG91dF91bmxvY2s6Ci0JaW50ZWxfcnVudGltZV9w
bV9wdXQoaTkxNSwgd2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRp
bWVfcG0sIHdha2VyZWYpOwogCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7
CiAJcmV0dXJuIGVycjsKIH0KQEAgLTk0NCw3ICs5NDQsNyBAQCBzdGF0aWMgaW50IGxpdmVfc2Vx
dWVudGlhbF9lbmdpbmVzKHZvaWQgKmFyZykKIAkgKi8KIAogCW11dGV4X2xvY2soJmk5MTUtPmRy
bS5zdHJ1Y3RfbXV0ZXgpOwotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsK
Kwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCiAJ
ZXJyID0gaWd0X2xpdmVfdGVzdF9iZWdpbigmdCwgaTkxNSwgX19mdW5jX18sICIiKTsKIAlpZiAo
ZXJyKQpAQCAtMTA1MSw3ICsxMDUxLDcgQEAgc3RhdGljIGludCBsaXZlX3NlcXVlbnRpYWxfZW5n
aW5lcyh2b2lkICphcmcpCiAJCWk5MTVfcmVxdWVzdF9wdXQocmVxdWVzdFtpZF0pOwogCX0KIG91
dF91bmxvY2s6Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7CisJaW50ZWxf
cnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCW11dGV4X3VubG9j
aygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJcmV0dXJuIGVycjsKIH0KQEAgLTExMTYsNyAr
MTExNiw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9icmVhZGNydW1ic19zbW9rZXRlc3Qodm9pZCAqYXJn
KQogCSAqIE9uIHJlYWwgaGFyZHdhcmUgdGhpcyB0aW1lLgogCSAqLwogCi0Jd2FrZXJlZiA9IGlu
dGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dl
dCgmaTkxNS0+cnVudGltZV9wbSk7CiAKIAlmaWxlID0gbW9ja19maWxlKGk5MTUpOwogCWlmIChJ
U19FUlIoZmlsZSkpIHsKQEAgLTEyMjMsNyArMTIyMyw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9icmVh
ZGNydW1ic19zbW9rZXRlc3Qodm9pZCAqYXJnKQogb3V0X2ZpbGU6CiAJbW9ja19maWxlX2ZyZWUo
aTkxNSwgZmlsZSk7CiBvdXRfcnBtOgotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2Vy
ZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsK
IAogCXJldHVybiByZXQ7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxm
dGVzdHMvaTkxNV90aW1lbGluZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5
MTVfdGltZWxpbmUuYwppbmRleCBmZjllYmU1MGZhZTguLjRhMDk3ZjdkZDhkOCAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfdGltZWxpbmUuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV90aW1lbGluZS5jCkBAIC01MTMsNyAr
NTEzLDcgQEAgc3RhdGljIGludCBsaXZlX2h3c3BfZW5naW5lKHZvaWQgKmFyZykKIAkJcmV0dXJu
IC1FTk9NRU07CiAKIAltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQl3YWtl
cmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRp
bWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKIAogCWNvdW50ID0gMDsKIAlmb3JfZWFjaF9l
bmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgewpAQCAtNTU2LDcgKzU1Niw3IEBAIHN0YXRpYyBpbnQg
bGl2ZV9od3NwX2VuZ2luZSh2b2lkICphcmcpCiAJCWk5MTVfdGltZWxpbmVfcHV0KHRsKTsKIAl9
CiAKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1l
X3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAJbXV0ZXhfdW5sb2NrKCZpOTE1
LT5kcm0uc3RydWN0X211dGV4KTsKIAogCWt2ZnJlZSh0aW1lbGluZXMpOwpAQCAtNTg5LDcgKzU4
OSw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9od3NwX2FsdGVybmF0ZSh2b2lkICphcmcpCiAJCXJldHVy
biAtRU5PTUVNOwogCiAJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0Jd2Fr
ZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCXdha2VyZWYgPSBpbnRlbF9ydW50
aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAKIAljb3VudCA9IDA7CiAJZm9yIChuID0g
MDsgbiA8IE5VTV9USU1FTElORVM7IG4rKykgewpAQCAtNjMyLDcgKzYzMiw3IEBAIHN0YXRpYyBp
bnQgbGl2ZV9od3NwX2FsdGVybmF0ZSh2b2lkICphcmcpCiAJCWk5MTVfdGltZWxpbmVfcHV0KHRs
KTsKIAl9CiAKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKKwlpbnRlbF9y
dW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAJbXV0ZXhfdW5sb2Nr
KCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAogCWt2ZnJlZSh0aW1lbGluZXMpOwpAQCAtNjU2
LDcgKzY1Niw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9od3NwX3dyYXAodm9pZCAqYXJnKQogCSAqLwog
CiAJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0Jd2FrZXJlZiA9IGludGVs
X3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgm
aTkxNS0+cnVudGltZV9wbSk7CiAKIAl0bCA9IGk5MTVfdGltZWxpbmVfY3JlYXRlKGk5MTUsIE5V
TEwpOwogCWlmIChJU19FUlIodGwpKSB7CkBAIC03NDcsNyArNzQ3LDcgQEAgc3RhdGljIGludCBs
aXZlX2h3c3Bfd3JhcCh2b2lkICphcmcpCiBvdXRfZnJlZToKIAlpOTE1X3RpbWVsaW5lX3B1dCh0
bCk7CiBvdXRfcnBtOgotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWlu
dGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAltdXRleF91
bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCiAJcmV0dXJuIGVycjsKQEAgLTc2OSw3
ICs3NjksNyBAQCBzdGF0aWMgaW50IGxpdmVfaHdzcF9yZWN5Y2xlKHZvaWQgKmFyZykKIAkgKi8K
IAogCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCXdha2VyZWYgPSBpbnRl
bF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQo
Jmk5MTUtPnJ1bnRpbWVfcG0pOwogCiAJY291bnQgPSAwOwogCWZvcl9lYWNoX2VuZ2luZShlbmdp
bmUsIGk5MTUsIGlkKSB7CkBAIC04MjMsNyArODIzLDcgQEAgc3RhdGljIGludCBsaXZlX2h3c3Bf
cmVjeWNsZSh2b2lkICphcmcpCiBvdXQ6CiAJaWYgKGlndF9mbHVzaF90ZXN0KGk5MTUsIEk5MTVf
V0FJVF9MT0NLRUQpKQogCQllcnIgPSAtRUlPOwotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUs
IHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtl
cmVmKTsKIAltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCiAJcmV0dXJu
IGVycjsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pbnRlbF9n
dWMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pbnRlbF9ndWMuYwppbmRleCBi
MDVhMjFlYWE4ZjQuLjM0MjIyYWJiZWIyMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvc2VsZnRlc3RzL2ludGVsX2d1Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0
ZXN0cy9pbnRlbF9ndWMuYwpAQCAtMTQzLDcgKzE0Myw3IEBAIHN0YXRpYyBpbnQgaWd0X2d1Y19j
bGllbnRzKHZvaWQgKmFyZ3MpCiAKIAlHRU1fQlVHX09OKCFIQVNfR1VDKGRldl9wcml2KSk7CiAJ
bXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCXdha2VyZWYgPSBpbnRl
bF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1f
Z2V0KCZkZXZfcHJpdi0+cnVudGltZV9wbSk7CiAKIAlndWMgPSAmZGV2X3ByaXYtPmd1YzsKIAlp
ZiAoIWd1YykgewpAQCAtMjI2LDcgKzIyNiw3IEBAIHN0YXRpYyBpbnQgaWd0X2d1Y19jbGllbnRz
KHZvaWQgKmFyZ3MpCiAJZ3VjX2NsaWVudHNfY3JlYXRlKGd1Yyk7CiAJZ3VjX2NsaWVudHNfZW5h
YmxlKGd1Yyk7CiB1bmxvY2s6Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2Vy
ZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJl
Zik7CiAJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJcmV0dXJu
IGVycjsKIH0KQEAgLTI0Niw3ICsyNDYsNyBAQCBzdGF0aWMgaW50IGlndF9ndWNfZG9vcmJlbGxz
KHZvaWQgKmFyZykKIAogCUdFTV9CVUdfT04oIUhBU19HVUMoZGV2X3ByaXYpKTsKIAltdXRleF9s
b2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRp
bWVfcG1fZ2V0KGRldl9wcml2KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmRl
dl9wcml2LT5ydW50aW1lX3BtKTsKIAogCWd1YyA9ICZkZXZfcHJpdi0+Z3VjOwogCWlmICghZ3Vj
KSB7CkBAIC0zMzksNyArMzM5LDcgQEAgc3RhdGljIGludCBpZ3RfZ3VjX2Rvb3JiZWxscyh2b2lk
ICphcmcpCiAJCQlndWNfY2xpZW50X2ZyZWUoY2xpZW50c1tpXSk7CiAJCX0KIHVubG9jazoKLQlp
bnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9w
bV9wdXQoJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAltdXRleF91bmxvY2soJmRl
dl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKIAlyZXR1cm4gZXJyOwogfQpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2ludGVsX3VuY29yZS5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvc2VsZnRlc3RzL2ludGVsX3VuY29yZS5jCmluZGV4IGUwZDdlYmVjYjIxNS4u
ODY4MTVjNjA3MmExIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMv
aW50ZWxfdW5jb3JlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2ludGVs
X3VuY29yZS5jCkBAIC0xNzYsNyArMTc2LDcgQEAgc3RhdGljIGludCBsaXZlX2ZvcmNld2FrZV9v
cHModm9pZCAqYXJnKQogCQlyZXR1cm4gMDsKIAl9CiAKLQl3YWtlcmVmID0gaW50ZWxfcnVudGlt
ZV9wbV9nZXQoaTkxNSk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5y
dW50aW1lX3BtKTsKIAogCWZvcl9lYWNoX2Z3X2RvbWFpbihkb21haW4sIHVuY29yZSwgdG1wKSB7
CiAJCXNtcF9zdG9yZV9tYihkb21haW4tPmFjdGl2ZSwgZmFsc2UpOwpAQCAtMjQ3LDcgKzI0Nyw3
IEBAIHN0YXRpYyBpbnQgbGl2ZV9mb3JjZXdha2Vfb3BzKHZvaWQgKmFyZykKIAl9CiAKIG91dF9y
cG06Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7CisJaW50ZWxfcnVudGlt
ZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCXJldHVybiBlcnI7CiB9CiAK
LS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
Cmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8451521E60
	for <lists+intel-gfx@lfdr.de>; Fri, 17 May 2019 21:36:06 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id AD1A6899BC;
	Fri, 17 May 2019 19:36:04 +0000 (UTC)
X-Original-To: Intel-gfx@lists.freedesktop.org
Delivered-To: Intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id AE4CF899BB;
 Fri, 17 May 2019 19:36:03 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 16593652-1500050 for multiple; Fri, 17 May 2019 20:35:51 +0100
MIME-Version: 1.0
To: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>,
 igt-dev@lists.freedesktop.org
From: Chris Wilson <chris@chris-wilson.co.uk>
In-Reply-To: <20190517112526.6738-13-tvrtko.ursulin@linux.intel.com>
References: <20190517112526.6738-1-tvrtko.ursulin@linux.intel.com>
 <20190517112526.6738-13-tvrtko.ursulin@linux.intel.com>
Message-ID: <155812174911.1890.4438273089258312619@skylake-alporthouse-com>
User-Agent: alot/0.6
Date: Fri, 17 May 2019 20:35:49 +0100
Subject: Re: [Intel-gfx] [igt-dev] [PATCH i-g-t 12/25] gem_wsim: Engine map
 support
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Intel-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVvdGluZyBUdnJ0a28gVXJzdWxpbiAoMjAxOS0wNS0xNyAxMjoyNToxMykKPiBGcm9tOiBUdnJ0
a28gVXJzdWxpbiA8dHZydGtvLnVyc3VsaW5AaW50ZWwuY29tPgo+IAo+IFN1cHBvcnQgbmV3IGk5
MTUgdUFQSSBmb3IgY29uZmlndXJpbmcgY29udGV4dHMgd2l0aCBlbmdpbmUgbWFwcy4KPiAKPiBQ
bGVhc2UgcmVmZXIgdG8gdGhlIFJFQURNRSBmaWxlIGZvciBtb3JlIGRldGFpbGVkIGV4cGxhbmF0
aW9uLgo+IAo+IHYyOgo+ICAqIEFsbG93IGRlZmluaW5nIGVuZ2luZSBtYXBzIGJ5IGNsYXNzLgo+
IAo+IFNpZ25lZC1vZmYtYnk6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBpbnRlbC5j
b20+Cj4gLS0tCj4gIGJlbmNobWFya3MvZ2VtX3dzaW0uYyAgfCAyMTEgKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKystLS0tLS0KPiAgYmVuY2htYXJrcy93c2ltL1JFQURNRSB8ICAy
NSArKysrLQo+ICAyIGZpbGVzIGNoYW5nZWQsIDIwNCBpbnNlcnRpb25zKCspLCAzMiBkZWxldGlv
bnMoLSkKPiAKPiBkaWZmIC0tZ2l0IGEvYmVuY2htYXJrcy9nZW1fd3NpbS5jIGIvYmVuY2htYXJr
cy9nZW1fd3NpbS5jCj4gaW5kZXggNjBiN2QzMmUyMmQ0Li5lNWIxMmUzNzQ5MGUgMTAwNjQ0Cj4g
LS0tIGEvYmVuY2htYXJrcy9nZW1fd3NpbS5jCj4gKysrIGIvYmVuY2htYXJrcy9nZW1fd3NpbS5j
Cj4gQEAgLTU3LDYgKzU3LDcgQEAKPiAgI2luY2x1ZGUgImV3bWEuaCIKPiAgCj4gIGVudW0gaW50
ZWxfZW5naW5lX2lkIHsKPiArICAgICAgIERFRkFVTFQsCj4gICAgICAgICBSQ1MsCj4gICAgICAg
ICBCQ1MsCj4gICAgICAgICBWQ1MsCj4gQEAgLTgxLDcgKzgyLDggQEAgZW51bSB3X3R5cGUKPiAg
ICAgICAgIFNXX0ZFTkNFLAo+ICAgICAgICAgU1dfRkVOQ0VfU0lHTkFMLAo+ICAgICAgICAgQ1RY
X1BSSU9SSVRZLAo+IC0gICAgICAgUFJFRU1QVElPTgo+ICsgICAgICAgUFJFRU1QVElPTiwKPiAr
ICAgICAgIEVOR0lORV9NQVAKPiAgfTsKPiAgCj4gIHN0cnVjdCBkZXBzCj4gQEAgLTExNSw2ICsx
MTcsMTAgQEAgc3RydWN0IHdfc3RlcAo+ICAgICAgICAgICAgICAgICBpbnQgdGhyb3R0bGU7Cj4g
ICAgICAgICAgICAgICAgIGludCBmZW5jZV9zaWduYWw7Cj4gICAgICAgICAgICAgICAgIGludCBw
cmlvcml0eTsKPiArICAgICAgICAgICAgICAgc3RydWN0IHsKPiArICAgICAgICAgICAgICAgICAg
ICAgICB1bnNpZ25lZCBpbnQgZW5naW5lX21hcF9jb3VudDsKPiArICAgICAgICAgICAgICAgICAg
ICAgICBlbnVtIGludGVsX2VuZ2luZV9pZCAqZW5naW5lX21hcDsKPiArICAgICAgICAgICAgICAg
fTsKPiAgICAgICAgIH07Cj4gIAo+ICAgICAgICAgLyogSW1wbGVtZW50YXRpb24gZGV0YWlscyAq
Lwo+IEBAIC0xNDIsNiArMTQ4LDggQEAgREVDTEFSRV9FV01BKHVpbnQ2NF90LCBydCwgNCwgMikK
PiAgc3RydWN0IGN0eCB7Cj4gICAgICAgICB1aW50MzJfdCBpZDsKPiAgICAgICAgIGludCBwcmlv
cml0eTsKPiArICAgICAgIHVuc2lnbmVkIGludCBlbmdpbmVfbWFwX2NvdW50Owo+ICsgICAgICAg
ZW51bSBpbnRlbF9lbmdpbmVfaWQgKmVuZ2luZV9tYXA7Cj4gICAgICAgICBib29sIHRhcmdldHNf
aW5zdGFuY2U7Cj4gICAgICAgICBib29sIHdhbnRzX2JhbGFuY2U7Cj4gICAgICAgICB1bnNpZ25l
ZCBpbnQgc3RhdGljX3ZjczsKPiBAQCAtMjAwLDEwICsyMDgsMTAgQEAgc3RydWN0IHdvcmtsb2Fk
Cj4gICAgICAgICAgICAgICAgIGludCBmZDsKPiAgICAgICAgICAgICAgICAgYm9vbCBmaXJzdDsK
PiAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG51bV9lbmdpbmVzOwo+IC0gICAgICAgICAg
ICAgICB1bnNpZ25lZCBpbnQgZW5naW5lX21hcFs1XTsKPiArICAgICAgICAgICAgICAgdW5zaWdu
ZWQgaW50IGVuZ2luZV9tYXBbTlVNX0VOR0lORVNdOwo+ICAgICAgICAgICAgICAgICB1aW50NjRf
dCB0X3ByZXY7Cj4gLSAgICAgICAgICAgICAgIHVpbnQ2NF90IHByZXZbNV07Cj4gLSAgICAgICAg
ICAgICAgIGRvdWJsZSBidXN5WzVdOwo+ICsgICAgICAgICAgICAgICB1aW50NjRfdCBwcmV2W05V
TV9FTkdJTkVTXTsKPiArICAgICAgICAgICAgICAgZG91YmxlIGJ1c3lbTlVNX0VOR0lORVNdOwo+
ICAgICAgICAgfSBidXN5X2JhbGFuY2VyOwo+ICB9Owo+ICAKPiBAQCAtMjM0LDYgKzI0Miw3IEBA
IHN0YXRpYyBpbnQgZmQ7Cj4gICNkZWZpbmUgUkVHKHgpICh2b2xhdGlsZSB1aW50MzJfdCAqKSgo
dm9sYXRpbGUgY2hhciAqKWlndF9nbG9iYWxfbW1pbyArIHgpCj4gIAo+ICBzdGF0aWMgY29uc3Qg
Y2hhciAqcmluZ19zdHJfbWFwW05VTV9FTkdJTkVTXSA9IHsKPiArICAgICAgIFtERUZBVUxUXSA9
ICJERUZBVUxUIiwKPiAgICAgICAgIFtSQ1NdID0gIlJDUyIsCj4gICAgICAgICBbQkNTXSA9ICJC
Q1MiLAo+ICAgICAgICAgW1ZDU10gPSAiVkNTIiwKPiBAQCAtMzMwLDYgKzMzOSw0MyBAQCBzdGF0
aWMgaW50IHN0cl90b19lbmdpbmUoY29uc3QgY2hhciAqc3RyKQo+ICAgICAgICAgcmV0dXJuIC0x
Owo+ICB9Cj4gIAo+ICtzdGF0aWMgaW50IHBhcnNlX2VuZ2luZV9tYXAoc3RydWN0IHdfc3RlcCAq
c3RlcCwgY29uc3QgY2hhciAqX3N0cikKPiArewo+ICsgICAgICAgY2hhciAqdG9rZW4sICp0Y3R4
ID0gTlVMTCwgKnRzdGFydCA9IChjaGFyICopX3N0cjsKPiArCj4gKyAgICAgICB3aGlsZSAoKHRv
a2VuID0gc3RydG9rX3IodHN0YXJ0LCAifCIsICZ0Y3R4KSkpIHsKPiArICAgICAgICAgICAgICAg
ZW51bSBpbnRlbF9lbmdpbmVfaWQgZW5naW5lOwo+ICsgICAgICAgICAgICAgICB1bnNpZ25lZCBp
bnQgYWRkOwo+ICsKPiArICAgICAgICAgICAgICAgdHN0YXJ0ID0gTlVMTDsKPiArCj4gKyAgICAg
ICAgICAgICAgIGlmICghc3RyY21wKHRva2VuLCAiREVGQVVMVCIpKQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgIHJldHVybiAtMTsKPiArCj4gKyAgICAgICAgICAgICAgIGVuZ2luZSA9IHN0cl90
b19lbmdpbmUodG9rZW4pOwo+ICsgICAgICAgICAgICAgICBpZiAoKGludCllbmdpbmUgPCAwKQo+
ICsgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTsKPiArCj4gKyAgICAgICAgICAgICAg
IGlmIChlbmdpbmUgIT0gVkNTICYmIGVuZ2luZSAhPSBWQ1MxICYmIGVuZ2luZSAhPSBWQ1MyKQo+
ICsgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTsgLyogVE9ETyAqLwoKU3RpbGwgYSBs
aXR0bGUgY29uY2VybmVkIHRoYXQgdGhlIG1hcCBpcyBWQ1Mgb25seS4gSXQganVzdCBkb2Vzbid0
IGZpdApteSBleHBlY3RhdGlvbnMgb2Ygd2hhdCB0aGUgbWFwIHdpbGwgYmUuCgo+ICsKPiArICAg
ICAgICAgICAgICAgYWRkID0gZW5naW5lID09IFZDUyA/IDIgOiAxOwoKV2lsbCB3ZSBub3QgZXZl
cnkgYXNrIHdoYXQgaGFwcGVucyBpZiB3ZSBoYWQgbWlsbGlvbnMgb2YgZW5naW5lcyBhdCBvdXIK
ZGlzcG9zYWwuIEJ1dCB0aGF0J3MgYSB0b21tb3Jyb3cgcHJvYmxlbSwgb2suCgo+ICsgICAgICAg
ICAgICAgICBzdGVwLT5lbmdpbmVfbWFwX2NvdW50ICs9IGFkZDsKPiArICAgICAgICAgICAgICAg
c3RlcC0+ZW5naW5lX21hcCA9IHJlYWxsb2Moc3RlcC0+ZW5naW5lX21hcCwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcC0+ZW5naW5lX21hcF9jb3VudCAq
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVvZihzdGVw
LT5lbmdpbmVfbWFwWzBdKSk7Cj4gKwo+ICsgICAgICAgICAgICAgICBpZiAoZW5naW5lICE9IFZD
Uykgewo+ICsgICAgICAgICAgICAgICAgICAgICAgIHN0ZXAtPmVuZ2luZV9tYXBbc3RlcC0+ZW5n
aW5lX21hcF9jb3VudCAtIDFdID0gZW5naW5lOwo+ICsgICAgICAgICAgICAgICB9IGVsc2Ugewo+
ICsgICAgICAgICAgICAgICAgICAgICAgIHN0ZXAtPmVuZ2luZV9tYXBbc3RlcC0+ZW5naW5lX21h
cF9jb3VudCAtIDJdID0gVkNTMTsKPiArICAgICAgICAgICAgICAgICAgICAgICBzdGVwLT5lbmdp
bmVfbWFwW3N0ZXAtPmVuZ2luZV9tYXBfY291bnQgLSAxXSA9IFZDUzI7Cj4gKyAgICAgICAgICAg
ICAgIH0KPiArICAgICAgIH0KPiArCj4gKyAgICAgICByZXR1cm4gMDsKPiArfQo+ICsKPiAgc3Rh
dGljIHN0cnVjdCB3b3JrbG9hZCAqCj4gIHBhcnNlX3dvcmtsb2FkKHN0cnVjdCB3X2FyZyAqYXJn
LCB1bnNpZ25lZCBpbnQgZmxhZ3MsIHN0cnVjdCB3b3JrbG9hZCAqYXBwX3cpCj4gIHsKPiBAQCAt
NDQ4LDYgKzQ5NCwzMyBAQCBwYXJzZV93b3JrbG9hZChzdHJ1Y3Qgd19hcmcgKmFyZywgdW5zaWdu
ZWQgaW50IGZsYWdzLCBzdHJ1Y3Qgd29ya2xvYWQgKmFwcF93KQo+ICAgICAgICAgICAgICAgICAg
ICAgICAgIH0gZWxzZSBpZiAoIXN0cmNtcChmaWVsZCwgImYiKSkgewo+ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RlcC50eXBlID0gU1dfRkVOQ0U7Cj4gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBnb3RvIGFkZF9zdGVwOwo+ICsgICAgICAgICAgICAgICAgICAgICAg
IH0gZWxzZSBpZiAoIXN0cmNtcChmaWVsZCwgIk0iKSkgewo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgdW5zaWduZWQgaW50IG5yID0gMDsKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHdoaWxlICgoZmllbGQgPSBzdHJ0b2tfcihmc3RhcnQsICIuIiwgJmZjdHgpKSAh
PQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5VTEwpIHsKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wID0gYXRvaShmaWVsZCk7Cj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrX2FyZyhuciA9PSAwICYm
IHRtcCA8PSAwLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIkludmFsaWQgY29udGV4dCBhdCBzdGVwICV1IVxuIiwKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5yX3N0ZXBzKTsKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tfYXJnKG5yID4gMSwKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJJbnZhbGlkIGVuZ2lu
ZSBtYXAgZm9ybWF0IGF0IHN0ZXAgJXUhXG4iLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgbnJfc3RlcHMpOwo+ICsKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5yID09IDApIHsKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwLmNvbnRleHQgPSB0bXA7Cj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7Cj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wID0gcGFyc2VfZW5naW5l
X21hcCgmc3RlcCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkKTsKPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja19hcmcodG1wIDwgMCwKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkludmFs
aWQgZW5naW5lIG1hcCBsaXN0IGF0IHN0ZXAgJXUhXG4iLAo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBucl9zdGVwcyk7Cj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KPiArCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIG5yKys7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB9Cj4gKwo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcC50eXBl
ID0gRU5HSU5FX01BUDsKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gYWRk
X3N0ZXA7Cj4gICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICghc3RyY21wKGZpZWxk
LCAiWCIpKSB7Cj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQg
bnIgPSAwOwo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKChmaWVsZCA9
IHN0cnRva19yKGZzdGFydCwgIi4iLCAmZmN0eCkpICE9Cj4gQEAgLTc3NCw2ICs4NDcsNyBAQCB0
ZXJtaW5hdGVfYmIoc3RydWN0IHdfc3RlcCAqdywgdW5zaWduZWQgaW50IGZsYWdzKQo+ICB9Cj4g
IAo+ICBzdGF0aWMgY29uc3QgdW5zaWduZWQgaW50IGViX2VuZ2luZV9tYXBbTlVNX0VOR0lORVNd
ID0gewo+ICsgICAgICAgW0RFRkFVTFRdID0gSTkxNV9FWEVDX0RFRkFVTFQsCj4gICAgICAgICBb
UkNTXSA9IEk5MTVfRVhFQ19SRU5ERVIsCj4gICAgICAgICBbQkNTXSA9IEk5MTVfRVhFQ19CTFQs
Cj4gICAgICAgICBbVkNTXSA9IEk5MTVfRVhFQ19CU0QsCj4gQEAgLTc5NiwxMSArODcwLDM2IEBA
IGViX3NldF9lbmdpbmUoc3RydWN0IGRybV9pOTE1X2dlbV9leGVjYnVmZmVyMiAqZWIsCj4gICAg
ICAgICAgICAgICAgIGViLT5mbGFncyA9IGViX2VuZ2luZV9tYXBbZW5naW5lXTsKPiAgfQo+ICAK
PiArc3RhdGljIHVuc2lnbmVkIGludAo+ICtmaW5kX2VuZ2luZV9pbl9tYXAoc3RydWN0IGN0eCAq
Y3R4LCBlbnVtIGludGVsX2VuZ2luZV9pZCBlbmdpbmUpCj4gK3sKPiArICAgICAgIHVuc2lnbmVk
IGludCBpOwo+ICsKPiArICAgICAgIGZvciAoaSA9IDA7IGkgPCBjdHgtPmVuZ2luZV9tYXBfY291
bnQ7IGkrKykgewo+ICsgICAgICAgICAgICAgICBpZiAoY3R4LT5lbmdpbmVfbWFwW2ldID09IGVu
Z2luZSkKPiArICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaSArIDE7Cj4gKyAgICAgICB9
Cj4gKwo+ICsgICAgICAgaWd0X2Fzc2VydCgwKTsKPiArICAgICAgIHJldHVybiAwOwoKTm8gYmFs
YW5jZXIgaW4gdGhlIG1hcCBhdCB0aGlzIHBvaW50PwoKPiArfQo+ICsKPiArc3RhdGljIHN0cnVj
dCBjdHggKgo+ICtfX2dldF9jdHgoc3RydWN0IHdvcmtsb2FkICp3cmssIHN0cnVjdCB3X3N0ZXAg
KncpCj4gK3sKPiArICAgICAgIHJldHVybiAmd3JrLT5jdHhfbGlzdFt3LT5jb250ZXh0ICogMl07
Cj4gK30KPiArCj4gIHN0YXRpYyB2b2lkCj4gLWViX3VwZGF0ZV9mbGFncyhzdHJ1Y3Qgd19zdGVw
ICp3LCBlbnVtIGludGVsX2VuZ2luZV9pZCBlbmdpbmUsCj4gLSAgICAgICAgICAgICAgIHVuc2ln
bmVkIGludCBmbGFncykKPiArZWJfdXBkYXRlX2ZsYWdzKHN0cnVjdCB3b3JrbG9hZCAqd3JrLCBz
dHJ1Y3Qgd19zdGVwICp3LAo+ICsgICAgICAgICAgICAgICBlbnVtIGludGVsX2VuZ2luZV9pZCBl
bmdpbmUsIHVuc2lnbmVkIGludCBmbGFncykKPiAgewo+IC0gICAgICAgZWJfc2V0X2VuZ2luZSgm
dy0+ZWIsIGVuZ2luZSwgZmxhZ3MpOwo+ICsgICAgICAgc3RydWN0IGN0eCAqY3R4ID0gX19nZXRf
Y3R4KHdyaywgdyk7Cj4gKwo+ICsgICAgICAgaWYgKGN0eC0+ZW5naW5lX21hcCkKPiArICAgICAg
ICAgICAgICAgdy0+ZWIuZmxhZ3MgPSBmaW5kX2VuZ2luZV9pbl9tYXAoY3R4LCBlbmdpbmUpOwo+
ICsgICAgICAgZWxzZQo+ICsgICAgICAgICAgICAgICBlYl9zZXRfZW5naW5lKCZ3LT5lYiwgZW5n
aW5lLCBmbGFncyk7Cj4gIAo+ICAgICAgICAgdy0+ZWIuZmxhZ3MgfD0gSTkxNV9FWEVDX0hBTkRM
RV9MVVQ7Cj4gICAgICAgICB3LT5lYi5mbGFncyB8PSBJOTE1X0VYRUNfTk9fUkVMT0M7Cj4gQEAg
LTgxOSwxMiArOTE4LDYgQEAgZ2V0X3N0YXR1c19vYmplY3RzKHN0cnVjdCB3b3JrbG9hZCAqd3Jr
KQo+ICAgICAgICAgICAgICAgICByZXR1cm4gd3JrLT5zdGF0dXNfb2JqZWN0Owo+ICB9Cj4gIAo+
IC1zdGF0aWMgc3RydWN0IGN0eCAqCj4gLV9fZ2V0X2N0eChzdHJ1Y3Qgd29ya2xvYWQgKndyaywg
c3RydWN0IHdfc3RlcCAqdykKPiAtewo+IC0gICAgICAgcmV0dXJuICZ3cmstPmN0eF9saXN0W3ct
PmNvbnRleHQgKiAyXTsKPiAtfQo+IC0KPiAgc3RhdGljIHVpbnQzMl90Cj4gIGdldF9jdHhpZChz
dHJ1Y3Qgd29ya2xvYWQgKndyaywgc3RydWN0IHdfc3RlcCAqdykKPiAgewo+IEBAIC04OTQsNyAr
OTg3LDcgQEAgYWxsb2Nfc3RlcF9iYXRjaChzdHJ1Y3Qgd29ya2xvYWQgKndyaywgc3RydWN0IHdf
c3RlcCAqdywgdW5zaWduZWQgaW50IGZsYWdzKQo+ICAgICAgICAgICAgICAgICBlbmdpbmUgPSBW
Q1MyOwo+ICAgICAgICAgZWxzZSBpZiAoZmxhZ3MgJiBTV0FQVkNTICYmIGVuZ2luZSA9PSBWQ1My
KQo+ICAgICAgICAgICAgICAgICBlbmdpbmUgPSBWQ1MxOwo+IC0gICAgICAgZWJfdXBkYXRlX2Zs
YWdzKHcsIGVuZ2luZSwgZmxhZ3MpOwo+ICsgICAgICAgZWJfdXBkYXRlX2ZsYWdzKHdyaywgdywg
ZW5naW5lLCBmbGFncyk7Cj4gICNpZmRlZiBERUJVRwo+ICAgICAgICAgcHJpbnRmKCIldTogJXU6
fCIsIHctPmlkeCwgdy0+ZWIuYnVmZmVyX2NvdW50KTsKPiAgICAgICAgIGZvciAoaSA9IDA7IGkg
PD0gajsgaSsrKQo+IEBAIC05MzYsNyArMTAyOSw3IEBAIHN0YXRpYyB2b2lkIHZtX2Rlc3Ryb3ko
aW50IGk5MTUsIHVpbnQzMl90IHZtX2lkKQo+ICAgICAgICAgaWd0X2Fzc2VydF9lcShfX3ZtX2Rl
c3Ryb3koaTkxNSwgdm1faWQpLCAwKTsKPiAgfQo+ICAKPiAtc3RhdGljIHZvaWQKPiArc3RhdGlj
IGludAo+ICBwcmVwYXJlX3dvcmtsb2FkKHVuc2lnbmVkIGludCBpZCwgc3RydWN0IHdvcmtsb2Fk
ICp3cmssIHVuc2lnbmVkIGludCBmbGFncykKPiAgewo+ICAgICAgICAgdW5zaWduZWQgaW50IGN0
eF92Y3M7Cj4gQEAgLTk5OSwzMCArMTA5Miw1MyBAQCBwcmVwYXJlX3dvcmtsb2FkKHVuc2lnbmVk
IGludCBpZCwgc3RydWN0IHdvcmtsb2FkICp3cmssIHVuc2lnbmVkIGludCBmbGFncykKPiAgICAg
ICAgIC8qCj4gICAgICAgICAgKiBJZGVudGlmeSBpZiBjb250ZXh0cyB0YXJnZXQgc3BlY2lmaWMg
ZW5naW5lIGluc3RhbmNlcyBhbmQgaWYgdGhleQo+ICAgICAgICAgICogd2FudCB0byBiZSBiYWxh
bmNlZC4KPiArICAgICAgICAqCj4gKyAgICAgICAgKiBUcmFuc2ZlciBvdmVyIGVuZ2luZSBtYXAg
Y29uZmlndXJhdGlvbiBmcm9tIHRoZSB3b3JrbG9hZCBzdGVwLgo+ICAgICAgICAgICovCj4gICAg
ICAgICBmb3IgKGogPSAwOyBqIDwgd3JrLT5ucl9jdHhzOyBqICs9IDIpIHsKPiAgICAgICAgICAg
ICAgICAgYm9vbCB0YXJnZXRzID0gZmFsc2U7Cj4gICAgICAgICAgICAgICAgIGJvb2wgYmFsYW5j
ZSA9IGZhbHNlOwo+ICAKPiAgICAgICAgICAgICAgICAgZm9yIChpID0gMCwgdyA9IHdyay0+c3Rl
cHM7IGkgPCB3cmstPm5yX3N0ZXBzOyBpKyssIHcrKykgewo+IC0gICAgICAgICAgICAgICAgICAg
ICAgIGlmICh3LT50eXBlICE9IEJBVENIKQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgY29udGludWU7Cj4gLQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3LT5jb250ZXh0
ICE9IChqIC8gMikpCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsK
PiAgCj4gLSAgICAgICAgICAgICAgICAgICAgICAgaWYgKHctPmVuZ2luZSA9PSBWQ1MpCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWxhbmNlID0gdHJ1ZTsKPiAtICAgICAgICAg
ICAgICAgICAgICAgICBlbHNlCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJn
ZXRzID0gdHJ1ZTsKPiArICAgICAgICAgICAgICAgICAgICAgICBpZiAody0+dHlwZSA9PSBCQVRD
SCkgewo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHctPmVuZ2luZSA9PSBW
Q1MpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhbGFuY2UgPSB0
cnVlOwo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRzID0gdHJ1ZTsKPiArICAgICAgICAg
ICAgICAgICAgICAgICB9IGVsc2UgaWYgKHctPnR5cGUgPT0gRU5HSU5FX01BUCkgewo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgd3JrLT5jdHhfbGlzdFtqXS5lbmdpbmVfbWFwID0g
dy0+ZW5naW5lX21hcDsKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdyay0+Y3R4
X2xpc3Rbal0uZW5naW5lX21hcF9jb3VudCA9Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHctPmVuZ2luZV9tYXBfY291bnQ7Cj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgfQo+ICAgICAgICAgICAgICAgICB9Cj4gIAo+IC0gICAgICAgICAgICAgICBpZiAoZmxhZ3Mg
JiBJOTE1KSB7Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgd3JrLT5jdHhfbGlzdFtqXS50YXJn
ZXRzX2luc3RhbmNlID0gdGFyZ2V0czsKPiArICAgICAgICAgICAgICAgd3JrLT5jdHhfbGlzdFtq
XS50YXJnZXRzX2luc3RhbmNlID0gdGFyZ2V0czsKPiArICAgICAgICAgICAgICAgaWYgKGZsYWdz
ICYgSTkxNSkKPiAgICAgICAgICAgICAgICAgICAgICAgICB3cmstPmN0eF9saXN0W2pdLndhbnRz
X2JhbGFuY2UgPSBiYWxhbmNlOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIC8qCj4gKyAgICAg
ICAgKiBFbnN1cmUgVkNTIGlzIG5vdCBhbGxvd2VkIHdpdGggZW5naW5lIG1hcCBjb250ZXh0cy4K
PiArICAgICAgICAqLwo+ICsgICAgICAgZm9yIChqID0gMDsgaiA8IHdyay0+bnJfY3R4czsgaiAr
PSAyKSB7Cj4gKyAgICAgICAgICAgICAgIGZvciAoaSA9IDAsIHcgPSB3cmstPnN0ZXBzOyBpIDwg
d3JrLT5ucl9zdGVwczsgaSsrLCB3KyspIHsKPiArICAgICAgICAgICAgICAgICAgICAgICBpZiAo
dy0+Y29udGV4dCAhPSAoaiAvIDIpKQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Y29udGludWU7Cj4gKwo+ICsgICAgICAgICAgICAgICAgICAgICAgIGlmICh3LT50eXBlICE9IEJB
VENIKQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7Cj4gKwo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIGlmICh3cmstPmN0eF9saXN0W2pdLmVuZ2luZV9tYXAgJiYg
dy0+ZW5naW5lID09IFZDUykgewoKQnV0IHdvdWxkbid0IFZDUyBzdGlsbCBiZSBtZWFuaW5nIHVz
ZSB0aGUgYmFsYW5jZXIgYW5kIG5vdCBhIHNwZWNpZmljCmVuZ2luZT8/PwoKSSdtIG5vdCB1bmRl
cnN0YW5kaW5nIGhvdyB5b3UgYXJlIHVzaW5nIG1hcHMgaW4gdGhlIC53c2ltIDooCi1DaHJpcwpf
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZngg
bWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0
cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

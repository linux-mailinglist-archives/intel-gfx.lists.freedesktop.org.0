Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 2443D2630F
	for <lists+intel-gfx@lfdr.de>; Wed, 22 May 2019 13:37:37 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2A510899D5;
	Wed, 22 May 2019 11:37:31 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id F284189998;
 Wed, 22 May 2019 11:37:28 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16639711-1500050 
 for multiple; Wed, 22 May 2019 12:37:15 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 22 May 2019 12:37:08 +0100
Message-Id: <20190522113712.23512-8-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190522113712.23512-1-chris@chris-wilson.co.uk>
References: <20190522113712.23512-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t 08/12] i915: Add gem_ctx_engines
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: igt-dev@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VG8gZXhlcmNpc2UgdGhlIG5ldyBJOTE1X0NPTlRFWFRfUEFSQU1fRU5HSU5FUyBhbmQgaW50ZXJh
Y3Rpb25zIHdpdGgKZ2VtX2V4ZWNidWYoKS4KClNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8
Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgpDYzogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1
bGluQGxpbnV4LmludGVsLmNvbT4KQ2M6IEFuZGkgU2h5dGkgPGFuZGlAZXRlemlhbi5vcmc+ClJl
dmlld2VkLWJ5OiBBbmRpIFNoeXRpIDxhbmRpQGV0ZXppYW4ub3JnPgotLS0KIHRlc3RzL01ha2Vm
aWxlLnNvdXJjZXMgICAgICAgfCAgIDEgKwogdGVzdHMvaTkxNS9nZW1fY3R4X2VuZ2luZXMuYyB8
IDUxNyArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKwogdGVzdHMvbWVzb24uYnVp
bGQgICAgICAgICAgICB8ICAgMSArCiAzIGZpbGVzIGNoYW5nZWQsIDUxOSBpbnNlcnRpb25zKCsp
CiBjcmVhdGUgbW9kZSAxMDA2NDQgdGVzdHMvaTkxNS9nZW1fY3R4X2VuZ2luZXMuYwoKZGlmZiAt
LWdpdCBhL3Rlc3RzL01ha2VmaWxlLnNvdXJjZXMgYi90ZXN0cy9NYWtlZmlsZS5zb3VyY2VzCmlu
ZGV4IDVhNTY1MzA3OS4uMmVmNjg5MDIzIDEwMDY0NAotLS0gYS90ZXN0cy9NYWtlZmlsZS5zb3Vy
Y2VzCisrKyBiL3Rlc3RzL01ha2VmaWxlLnNvdXJjZXMKQEAgLTIyLDYgKzIyLDcgQEAgVEVTVFNf
cHJvZ3MgPSBcCiAJZHJtX21tIFwKIAlkcm1fcmVhZCBcCiAJaTkxNS9nZW1fY3R4X2Nsb25lIFwK
KwlpOTE1L2dlbV9jdHhfZW5naW5lcyBcCiAJaTkxNS9nZW1fY3R4X3NoYXJlZCBcCiAJaTkxNS9n
ZW1fdm1fY3JlYXRlIFwKIAlrbXNfM2QgXApkaWZmIC0tZ2l0IGEvdGVzdHMvaTkxNS9nZW1fY3R4
X2VuZ2luZXMuYyBiL3Rlc3RzL2k5MTUvZ2VtX2N0eF9lbmdpbmVzLmMKbmV3IGZpbGUgbW9kZSAx
MDA2NDQKaW5kZXggMDAwMDAwMDAwLi5mODNhYTQ3NzIKLS0tIC9kZXYvbnVsbAorKysgYi90ZXN0
cy9pOTE1L2dlbV9jdHhfZW5naW5lcy5jCkBAIC0wLDAgKzEsNTE3IEBACisvKgorICogQ29weXJp
Z2h0IMKpIDIwMTggSW50ZWwgQ29ycG9yYXRpb24KKyAqCisgKiBQZXJtaXNzaW9uIGlzIGhlcmVi
eSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQorICog
Y29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMg
KHRoZSAiU29mdHdhcmUiKSwKKyAqIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVz
dHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24KKyAqIHRoZSByaWdodHMgdG8g
dXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNl
LAorICogYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBw
ZXJzb25zIHRvIHdob20gdGhlCisgKiBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1
YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgorICoKKyAqIFRoZSBhYm92ZSBjb3B5
cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIChpbmNsdWRpbmcgdGhlIG5l
eHQKKyAqIHBhcmFncmFwaCkgc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsIGNvcGllcyBvciBzdWJz
dGFudGlhbCBwb3J0aW9ucyBvZiB0aGUKKyAqIFNvZnR3YXJlLgorICoKKyAqIFRIRSBTT0ZUV0FS
RSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBS
RVNTIE9SCisgKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJS
QU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKKyAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQ
VVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTAorICogVEhFIEFV
VEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFH
RVMgT1IgT1RIRVIKKyAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJB
Q1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HCisgKiBGUk9NLCBPVVQgT0YgT1IgSU4gQ09O
TkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTCisg
KiBJTiBUSEUgU09GVFdBUkUuCisgKgorICovCisKKyNpbmNsdWRlICJpZ3QuaCIKKworI2luY2x1
ZGUgPHVuaXN0ZC5oPgorI2luY2x1ZGUgPHN0ZGxpYi5oPgorI2luY2x1ZGUgPHN0ZGludC5oPgor
I2luY2x1ZGUgPHN0ZGlvLmg+CisjaW5jbHVkZSA8c3RyaW5nLmg+CisjaW5jbHVkZSA8ZmNudGwu
aD4KKyNpbmNsdWRlIDxpbnR0eXBlcy5oPgorI2luY2x1ZGUgPGVycm5vLmg+CisjaW5jbHVkZSA8
c3lzL3N0YXQuaD4KKyNpbmNsdWRlIDxzeXMvaW9jdGwuaD4KKyNpbmNsdWRlIDxzeXMvdGltZS5o
PgorCisjaW5jbHVkZSA8ZHJtLmg+CisKKyNpbmNsdWRlICJpOTE1L2dlbV9jb250ZXh0LmgiCisj
aW5jbHVkZSAic3dfc3luYy5oIgorCisjZGVmaW5lIGVuZ2luZV9jbGFzcyhlLCBuKSAoKGUpLT5l
bmdpbmVzWyhuKV0uZW5naW5lX2NsYXNzKQorI2RlZmluZSBlbmdpbmVfaW5zdGFuY2UoZSwgbikg
KChlKS0+ZW5naW5lc1sobildLmVuZ2luZV9pbnN0YW5jZSkKKworc3RhdGljIGJvb2wgaGFzX2Nv
bnRleHRfZW5naW5lcyhpbnQgaTkxNSkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2NvbnRleHRf
cGFyYW0gcGFyYW0gPSB7CisJCS5jdHhfaWQgPSAwLAorCQkucGFyYW0gPSBJOTE1X0NPTlRFWFRf
UEFSQU1fRU5HSU5FUywKKwl9OworCXJldHVybiBfX2dlbV9jb250ZXh0X3NldF9wYXJhbShpOTE1
LCAmcGFyYW0pID09IDA7Cit9CisKK3N0YXRpYyB2b2lkIGludmFsaWRfZW5naW5lcyhpbnQgaTkx
NSkKK3sKKwlzdHJ1Y3QgaTkxNV9jb250ZXh0X3BhcmFtX2VuZ2luZXMgc3RhY2sgPSB7fSwgKmVu
Z2luZXM7CisJc3RydWN0IGRybV9pOTE1X2dlbV9jb250ZXh0X3BhcmFtIHBhcmFtID0geworCQku
Y3R4X2lkID0gZ2VtX2NvbnRleHRfY3JlYXRlKGk5MTUpLAorCQkucGFyYW0gPSBJOTE1X0NPTlRF
WFRfUEFSQU1fRU5HSU5FUywKKwkJLnZhbHVlID0gdG9fdXNlcl9wb2ludGVyKCZzdGFjayksCisJ
fTsKKwl1aW50MzJfdCBoYW5kbGU7CisJdm9pZCAqcHRyOworCisJcGFyYW0uc2l6ZSA9IDA7CisJ
aWd0X2Fzc2VydF9lcShfX2dlbV9jb250ZXh0X3NldF9wYXJhbShpOTE1LCAmcGFyYW0pLCAwKTsK
KworCXBhcmFtLnNpemUgPSAxOworCWlndF9hc3NlcnRfZXEoX19nZW1fY29udGV4dF9zZXRfcGFy
YW0oaTkxNSwgJnBhcmFtKSwgLUVJTlZBTCk7CisKKwlwYXJhbS5zaXplID0gc2l6ZW9mKHN0YWNr
KSAtIDE7CisJaWd0X2Fzc2VydF9lcShfX2dlbV9jb250ZXh0X3NldF9wYXJhbShpOTE1LCAmcGFy
YW0pLCAtRUlOVkFMKTsKKworCXBhcmFtLnNpemUgPSBzaXplb2Yoc3RhY2spICsgMTsKKwlpZ3Rf
YXNzZXJ0X2VxKF9fZ2VtX2NvbnRleHRfc2V0X3BhcmFtKGk5MTUsICZwYXJhbSksIC1FSU5WQUwp
OworCisJcGFyYW0uc2l6ZSA9IDA7CisJaWd0X2Fzc2VydF9lcShfX2dlbV9jb250ZXh0X3NldF9w
YXJhbShpOTE1LCAmcGFyYW0pLCAwKTsKKworCS8qIENyZWF0ZSBhIHNpbmdsZSBwYWdlIHN1cnJv
dW5kZWQgYnkgaW5hY2Nlc3NpYmxlIG5vdGhpbmduZXNzICovCisJcHRyID0gbW1hcChOVUxMLCAz
ICogNDA5NiwgUFJPVF9XUklURSwgTUFQX0FOT04gfCBNQVBfUFJJVkFURSwgLTEsIDApOworCWln
dF9hc3NlcnQocHRyICE9IE1BUF9GQUlMRUQpOworCisJbXVubWFwKHB0ciwgNDA5Nik7CisJZW5n
aW5lcyA9IHB0ciArIDQwOTY7CisJbXVubWFwKHB0ciArIDIgKjQwOTYsIDQwOTYpOworCisJcGFy
YW0uc2l6ZSA9IHNpemVvZigqZW5naW5lcykgKyBzaXplb2YoKmVuZ2luZXMtPmVuZ2luZXMpOwor
CXBhcmFtLnZhbHVlID0gdG9fdXNlcl9wb2ludGVyKGVuZ2luZXMpOworCisJZW5naW5lcy0+ZW5n
aW5lc1swXS5lbmdpbmVfY2xhc3MgPSAtMTsKKwlpZ3RfYXNzZXJ0X2VxKF9fZ2VtX2NvbnRleHRf
c2V0X3BhcmFtKGk5MTUsICZwYXJhbSksIC1FTk9FTlQpOworCisJbXByb3RlY3QoZW5naW5lcywg
NDA5NiwgUFJPVF9SRUFEKTsKKwlpZ3RfYXNzZXJ0X2VxKF9fZ2VtX2NvbnRleHRfc2V0X3BhcmFt
KGk5MTUsICZwYXJhbSksIC1FTk9FTlQpOworCisJbXByb3RlY3QoZW5naW5lcywgNDA5NiwgUFJP
VF9XUklURSk7CisJZW5naW5lcy0+ZW5naW5lc1swXS5lbmdpbmVfY2xhc3MgPSAwOworCWlmIChf
X2dlbV9jb250ZXh0X3NldF9wYXJhbShpOTE1LCAmcGFyYW0pKSAvKiBYWFggbmVlZHMgUkNTICov
CisJCWdvdG8gb3V0OworCisJZW5naW5lcy0+ZXh0ZW5zaW9ucyA9IHRvX3VzZXJfcG9pbnRlcihw
dHIpOworCWlndF9hc3NlcnRfZXEoX19nZW1fY29udGV4dF9zZXRfcGFyYW0oaTkxNSwgJnBhcmFt
KSwgLUVGQVVMVCk7CisKKwllbmdpbmVzLT5leHRlbnNpb25zID0gMDsKKwlpZ3RfYXNzZXJ0X2Vx
KF9fZ2VtX2NvbnRleHRfc2V0X3BhcmFtKGk5MTUsICZwYXJhbSksIDApOworCisJcGFyYW0udmFs
dWUgPSB0b191c2VyX3BvaW50ZXIoZW5naW5lcyAtIDEpOworCWlndF9hc3NlcnRfZXEoX19nZW1f
Y29udGV4dF9zZXRfcGFyYW0oaTkxNSwgJnBhcmFtKSwgLUVGQVVMVCk7CisKKwlwYXJhbS52YWx1
ZSA9IHRvX3VzZXJfcG9pbnRlcihlbmdpbmVzKSAtIDE7CisJaWd0X2Fzc2VydF9lcShfX2dlbV9j
b250ZXh0X3NldF9wYXJhbShpOTE1LCAmcGFyYW0pLCAtRUZBVUxUKTsKKworCXBhcmFtLnZhbHVl
ID0gdG9fdXNlcl9wb2ludGVyKGVuZ2luZXMpIC0gcGFyYW0uc2l6ZSArICAxOworCWlndF9hc3Nl
cnRfZXEoX19nZW1fY29udGV4dF9zZXRfcGFyYW0oaTkxNSwgJnBhcmFtKSwgLUVGQVVMVCk7CisK
KwlwYXJhbS52YWx1ZSA9IHRvX3VzZXJfcG9pbnRlcihlbmdpbmVzKSArIDQwOTY7CisJaWd0X2Fz
c2VydF9lcShfX2dlbV9jb250ZXh0X3NldF9wYXJhbShpOTE1LCAmcGFyYW0pLCAtRUZBVUxUKTsK
KworCXBhcmFtLnZhbHVlID0gdG9fdXNlcl9wb2ludGVyKGVuZ2luZXMpIC0gcGFyYW0uc2l6ZSAr
IDQwOTY7CisJaWd0X2Fzc2VydF9lcShfX2dlbV9jb250ZXh0X3NldF9wYXJhbShpOTE1LCAmcGFy
YW0pLCAwKTsKKworCXBhcmFtLnZhbHVlID0gdG9fdXNlcl9wb2ludGVyKGVuZ2luZXMpIC0gcGFy
YW0uc2l6ZSArIDQwOTYgKyAxOworCWlndF9hc3NlcnRfZXEoX19nZW1fY29udGV4dF9zZXRfcGFy
YW0oaTkxNSwgJnBhcmFtKSwgLUVGQVVMVCk7CisKKwlwYXJhbS52YWx1ZSA9IHRvX3VzZXJfcG9p
bnRlcihlbmdpbmVzKSArIDQwOTY7CisJaWd0X2Fzc2VydF9lcShfX2dlbV9jb250ZXh0X3NldF9w
YXJhbShpOTE1LCAmcGFyYW0pLCAtRUZBVUxUKTsKKworCXBhcmFtLnZhbHVlID0gdG9fdXNlcl9w
b2ludGVyKGVuZ2luZXMpICsgNDA5NiAtIDE7CisJaWd0X2Fzc2VydF9lcShfX2dlbV9jb250ZXh0
X3NldF9wYXJhbShpOTE1LCAmcGFyYW0pLCAtRUZBVUxUKTsKKworCXBhcmFtLnZhbHVlID0gdG9f
dXNlcl9wb2ludGVyKGVuZ2luZXMpIC0gMTsKKwlpZ3RfYXNzZXJ0X2VxKF9fZ2VtX2NvbnRleHRf
c2V0X3BhcmFtKGk5MTUsICZwYXJhbSksIC1FRkFVTFQpOworCisJcGFyYW0udmFsdWUgPSB0b191
c2VyX3BvaW50ZXIoZW5naW5lcyAtIDEpOworCWlndF9hc3NlcnRfZXEoX19nZW1fY29udGV4dF9z
ZXRfcGFyYW0oaTkxNSwgJnBhcmFtKSwgLUVGQVVMVCk7CisKKwlwYXJhbS52YWx1ZSA9IHRvX3Vz
ZXJfcG9pbnRlcihlbmdpbmVzIC0gMSkgKyA0MDk2OworCWlndF9hc3NlcnRfZXEoX19nZW1fY29u
dGV4dF9zZXRfcGFyYW0oaTkxNSwgJnBhcmFtKSwgLUVGQVVMVCk7CisKKwlwYXJhbS52YWx1ZSA9
IHRvX3VzZXJfcG9pbnRlcihlbmdpbmVzIC0gMSkgKyA0MDk2IC0gc2l6ZW9mKCplbmdpbmVzLT5l
bmdpbmVzKSAvIDI7CisJaWd0X2Fzc2VydF9lcShfX2dlbV9jb250ZXh0X3NldF9wYXJhbShpOTE1
LCAmcGFyYW0pLCAtRUZBVUxUKTsKKworCWhhbmRsZSA9IGdlbV9jcmVhdGUoaTkxNSwgNDA5NiAq
IDMpOworCXB0ciA9IGdlbV9tbWFwX19ndHQoaTkxNSwgaGFuZGxlLCA0MDk2ICogMywgUFJPVF9S
RUFEKTsKKwlnZW1fY2xvc2UoaTkxNSwgaGFuZGxlKTsKKworCW11bm1hcChwdHIsIDQwOTYpOwor
CW11bm1hcChwdHIgKyA4MTkyLCA0MDk2KTsKKworCXBhcmFtLnZhbHVlID0gdG9fdXNlcl9wb2lu
dGVyKHB0ciArIDQwOTYpOworCWlndF9hc3NlcnRfZXEoX19nZW1fY29udGV4dF9zZXRfcGFyYW0o
aTkxNSwgJnBhcmFtKSwgMCk7CisKKwlwYXJhbS52YWx1ZSA9IHRvX3VzZXJfcG9pbnRlcihwdHIp
OworCWlndF9hc3NlcnRfZXEoX19nZW1fY29udGV4dF9zZXRfcGFyYW0oaTkxNSwgJnBhcmFtKSwg
LUVGQVVMVCk7CisKKwlwYXJhbS52YWx1ZSA9IHRvX3VzZXJfcG9pbnRlcihwdHIpICsgNDA5NTsK
KwlpZ3RfYXNzZXJ0X2VxKF9fZ2VtX2NvbnRleHRfc2V0X3BhcmFtKGk5MTUsICZwYXJhbSksIC1F
RkFVTFQpOworCisJcGFyYW0udmFsdWUgPSB0b191c2VyX3BvaW50ZXIocHRyKSArIDgxOTI7CisJ
aWd0X2Fzc2VydF9lcShfX2dlbV9jb250ZXh0X3NldF9wYXJhbShpOTE1LCAmcGFyYW0pLCAtRUZB
VUxUKTsKKworCXBhcmFtLnZhbHVlID0gdG9fdXNlcl9wb2ludGVyKHB0cikgKyAxMjI4NzsKKwlp
Z3RfYXNzZXJ0X2VxKF9fZ2VtX2NvbnRleHRfc2V0X3BhcmFtKGk5MTUsICZwYXJhbSksIC1FRkFV
TFQpOworCisJbXVubWFwKHB0ciArIDQwOTYsIDQwOTYpOworCitvdXQ6CisJbXVubWFwKGVuZ2lu
ZXMsIDQwOTYpOworCWdlbV9jb250ZXh0X2Rlc3Ryb3koaTkxNSwgcGFyYW0uY3R4X2lkKTsKK30K
Kworc3RhdGljIHZvaWQgaWRlbXBvdGVudChpbnQgaTkxNSkKK3sKKwlJOTE1X0RFRklORV9DT05U
RVhUX1BBUkFNX0VOR0lORVMoZW5naW5lcyAsIEk5MTVfRVhFQ19SSU5HX01BU0sgKyAxKTsKKwlJ
OTE1X0RFRklORV9DT05URVhUX1BBUkFNX0VOR0lORVMoZXhwZWN0ZWQgLCBJOTE1X0VYRUNfUklO
R19NQVNLICsgMSk7CisJc3RydWN0IGRybV9pOTE1X2dlbV9jb250ZXh0X3BhcmFtIHAgPSB7CisJ
CS5jdHhfaWQgPSBnZW1fY29udGV4dF9jcmVhdGUoaTkxNSksCisJCS5wYXJhbSA9IEk5MTVfQ09O
VEVYVF9QQVJBTV9FTkdJTkVTLAorCQkudmFsdWUgPSB0b191c2VyX3BvaW50ZXIoJmVuZ2luZXMp
LAorCQkuc2l6ZSA9IHNpemVvZihlbmdpbmVzKSwKKwl9OworCWNvbnN0IHNpemVfdCBiYXNlID0g
c2l6ZW9mKHN0cnVjdCBpOTE1X2NvbnRleHRfcGFyYW1fZW5naW5lcyk7CisJY29uc3Qgc3RydWN0
IGludGVsX2V4ZWN1dGlvbl9lbmdpbmUyICplOworCWludCBpZHg7CisKKwkvKiBXaGF0IGdvZXMg
aW4sIG11c3QgY29tZSBvdXQuIEFuZCB3aGF0IGNvbWVzIG91dCwgbXVzdCBnbyBpbiAqLworCisJ
Z2VtX2NvbnRleHRfZ2V0X3BhcmFtKGk5MTUsICZwKTsKKwlpZ3RfYXNzZXJ0X2VxKHAuc2l6ZSwg
MCk7IC8qIGF0bSBkZWZhdWx0IGlzIHRvIHVzZSBsZWdhY3kgcmluZyBtYXNrICovCisKKwlpZHgg
PSAwOworCW1lbXNldCgmZW5naW5lcywgMCwgc2l6ZW9mKGVuZ2luZXMpKTsKKwlmb3JfZWFjaF9l
bmdpbmVfY2xhc3NfaW5zdGFuY2UoaTkxNSwgZSkgeworCQllbmdpbmVzLmVuZ2luZXNbaWR4XS5l
bmdpbmVfY2xhc3MgPSBlLT5jbGFzczsKKwkJZW5naW5lcy5lbmdpbmVzW2lkeF0uZW5naW5lX2lu
c3RhbmNlID0gZS0+aW5zdGFuY2U7CisJCWlkeCsrOworCX0KKwlpZHggKj0gc2l6ZW9mKCplbmdp
bmVzLmVuZ2luZXMpOworCXAuc2l6ZSA9IGJhc2UgKyBpZHg7CisJZ2VtX2NvbnRleHRfc2V0X3Bh
cmFtKGk5MTUsICZwKTsKKworCW1lbWNweSgmZXhwZWN0ZWQsICZlbmdpbmVzLCBzaXplb2YoZXhw
ZWN0ZWQpKTsKKworCWdlbV9jb250ZXh0X2dldF9wYXJhbShpOTE1LCAmcCk7CisJaWd0X2Fzc2Vy
dF9lcShwLnNpemUsIGJhc2UgKyBpZHgpOworCWlndF9hc3NlcnQoIW1lbWNtcCgmZXhwZWN0ZWQs
ICZlbmdpbmVzLCBpZHgpKTsKKworCXAuc2l6ZSA9IGJhc2U7CisJZ2VtX2NvbnRleHRfc2V0X3Bh
cmFtKGk5MTUsICZwKTsKKwlnZW1fY29udGV4dF9nZXRfcGFyYW0oaTkxNSwgJnApOworCWlndF9h
c3NlcnRfZXEocC5zaXplLCBiYXNlKTsKKworCS8qIGFuZCBpdCBzaG91bGQgbm90IGhhdmUgb3Zl
cndyaXR0ZW4gdGhlIHByZXZpb3VzIGNvbnRlbnRzICovCisJaWd0X2Fzc2VydCghbWVtY21wKCZl
eHBlY3RlZCwgJmVuZ2luZXMsIGlkeCkpOworCisJbWVtc2V0KCZlbmdpbmVzLCAwLCBzaXplb2Yo
ZW5naW5lcykpOworCWVuZ2luZXMuZW5naW5lc1swXS5lbmdpbmVfY2xhc3MgPSBJOTE1X0VOR0lO
RV9DTEFTU19JTlZBTElEOworCWVuZ2luZXMuZW5naW5lc1swXS5lbmdpbmVfaW5zdGFuY2UgPSBJ
OTE1X0VOR0lORV9DTEFTU19JTlZBTElEX05PTkU7CisJaWR4ID0gc2l6ZW9mKCplbmdpbmVzLmVu
Z2luZXMpOworCXAuc2l6ZSA9IGJhc2UgKyBpZHg7CisJZ2VtX2NvbnRleHRfc2V0X3BhcmFtKGk5
MTUsICZwKTsKKworCW1lbWNweSgmZXhwZWN0ZWQsICZlbmdpbmVzLCBzaXplb2YoZXhwZWN0ZWQp
KTsKKworCWdlbV9jb250ZXh0X2dldF9wYXJhbShpOTE1LCAmcCk7CisJaWd0X2Fzc2VydF9lcShw
LnNpemUsIGJhc2UgKyBpZHgpOworCWlndF9hc3NlcnQoIW1lbWNtcCgmZXhwZWN0ZWQsICZlbmdp
bmVzLCBpZHgpKTsKKworCW1lbXNldCgmZW5naW5lcywgMCwgc2l6ZW9mKGVuZ2luZXMpKTsKKwlw
LnNpemUgPSBzaXplb2YoZW5naW5lcyk7CisJZ2VtX2NvbnRleHRfc2V0X3BhcmFtKGk5MTUsICZw
KTsKKworCW1lbWNweSgmZXhwZWN0ZWQsICZlbmdpbmVzLCBzaXplb2YoZXhwZWN0ZWQpKTsKKwor
CWdlbV9jb250ZXh0X2dldF9wYXJhbShpOTE1LCAmcCk7CisJaWd0X2Fzc2VydF9lcShwLnNpemUs
IHNpemVvZihlbmdpbmVzKSk7CisJaWd0X2Fzc2VydCghbWVtY21wKCZleHBlY3RlZCwgJmVuZ2lu
ZXMsIGlkeCkpOworCisJZ2VtX2NvbnRleHRfZGVzdHJveShpOTE1LCBwLmN0eF9pZCk7Cit9CisK
K3N0YXRpYyB2b2lkIGV4ZWN1dGVfb25lKGludCBpOTE1KQoreworCUk5MTVfREVGSU5FX0NPTlRF
WFRfUEFSQU1fRU5HSU5FUyhlbmdpbmVzICwgSTkxNV9FWEVDX1JJTkdfTUFTSyArIDEpOworCXN0
cnVjdCBkcm1faTkxNV9nZW1fY29udGV4dF9wYXJhbSBwYXJhbSA9IHsKKwkJLmN0eF9pZCA9IGdl
bV9jb250ZXh0X2NyZWF0ZShpOTE1KSwKKwkJLnBhcmFtID0gSTkxNV9DT05URVhUX1BBUkFNX0VO
R0lORVMsCisJCS52YWx1ZSA9IHRvX3VzZXJfcG9pbnRlcigmZW5naW5lcyksCisJCS8qIC5zaXpl
IHRvIGJlIGZpbGxlZCBpbiBsYXRlciAqLworCX07CisJc3RydWN0IGRybV9pOTE1X2dlbV9leGVj
X29iamVjdDIgb2JqID0geworCQkuaGFuZGxlID0gZ2VtX2NyZWF0ZShpOTE1LCA0MDk2KSwKKwl9
OworCXN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY2J1ZmZlcjIgZXhlY2J1ZiA9IHsKKwkJLmJ1ZmZl
cnNfcHRyID0gdG9fdXNlcl9wb2ludGVyKCZvYmopLAorCQkuYnVmZmVyX2NvdW50ID0gMSwKKwkJ
LnJzdmQxID0gcGFyYW0uY3R4X2lkLAorCX07CisJY29uc3QgdWludDMyX3QgYmJlID0gTUlfQkFU
Q0hfQlVGRkVSX0VORDsKKwljb25zdCBzdHJ1Y3QgaW50ZWxfZXhlY3V0aW9uX2VuZ2luZTIgKmU7
CisKKwlnZW1fd3JpdGUoaTkxNSwgb2JqLmhhbmRsZSwgMCwgJmJiZSwgc2l6ZW9mKGJiZSkpOwor
CisJLyogVW5hZHVsdGVyYXRlZCBJOTE1X0VYRUNfREVGQVVMVCBzaG91bGQgd29yayAqLworCWV4
ZWNidWYuZmxhZ3MgPSAwOworCWdlbV9leGVjYnVmKGk5MTUsICZleGVjYnVmKTsKKwlnZW1fc3lu
YyhpOTE1LCBvYmouaGFuZGxlKTsKKworCWZvcl9lYWNoX2VuZ2luZV9jbGFzc19pbnN0YW5jZShp
OTE1LCBlKSB7CisJCXN0cnVjdCBkcm1faTkxNV9nZW1fYnVzeSBidXN5ID0geyAuaGFuZGxlID0g
b2JqLmhhbmRsZSB9OworCisJCWZvciAoaW50IGkgPSAtMTsgaSA8PSBJOTE1X0VYRUNfUklOR19N
QVNLOyBpKyspIHsKKwkJCWlndF9zcGluX3QgKnNwaW47CisKKwkJCW1lbXNldCgmZW5naW5lcywg
MCwgc2l6ZW9mKGVuZ2luZXMpKTsKKwkJCWVuZ2luZV9jbGFzcygmZW5naW5lcywgMCkgPSBlLT5j
bGFzczsKKwkJCWVuZ2luZV9pbnN0YW5jZSgmZW5naW5lcywgMCkgPSBlLT5pbnN0YW5jZTsKKwkJ
CXBhcmFtLnNpemUgPSBvZmZzZXRvZih0eXBlb2YoZW5naW5lcyksIGVuZ2luZXNbMV0pOworCQkJ
Z2VtX2NvbnRleHRfc2V0X3BhcmFtKGk5MTUsICZwYXJhbSk7CisKKwkJCXNwaW4gPSBpZ3Rfc3Bp
bl9uZXcoaTkxNSwKKwkJCQkJICAgIC5jdHggPSBwYXJhbS5jdHhfaWQsCisJCQkJCSAgICAuZW5n
aW5lID0gMCk7CisKKwkJCWlndF9kZWJ1ZygiVGVzdGluZyB3aXRoIG1hcCBvZiAlZCBlbmdpbmVz
XG4iLCBpICsgMSk7CisJCQltZW1zZXQoJmVuZ2luZXMuZW5naW5lcywgLTEsIHNpemVvZihlbmdp
bmVzLmVuZ2luZXMpKTsKKwkJCWlmIChpICE9IC0xKSB7CisJCQkJZW5naW5lX2NsYXNzKCZlbmdp
bmVzLCBpKSA9IGUtPmNsYXNzOworCQkJCWVuZ2luZV9pbnN0YW5jZSgmZW5naW5lcywgaSkgPSBl
LT5pbnN0YW5jZTsKKwkJCX0KKwkJCXBhcmFtLnNpemUgPSBzaXplb2YodWludDY0X3QpICsgKGkg
KyAxKSAqIHNpemVvZih1aW50MzJfdCk7CisJCQlnZW1fY29udGV4dF9zZXRfcGFyYW0oaTkxNSwg
JnBhcmFtKTsKKworCQkJZm9yIChpbnQgaiA9IDA7IGogPD0gSTkxNV9FWEVDX1JJTkdfTUFTSzsg
aisrKSB7CisJCQkJaW50IGV4cGVjdGVkID0gaiA9PSBpID8gMCA6IC1FSU5WQUw7CisKKwkJCQll
eGVjYnVmLmZsYWdzID0gajsKKwkJCQlpZ3RfYXNzZXJ0X2YoX19nZW1fZXhlY2J1ZihpOTE1LCAm
ZXhlY2J1ZikgPT0gZXhwZWN0ZWQsCisJCQkJCSAgICAgIkZhaWxlZCB0byByZXBvcnQgdGhlICVz
IGVuZ2luZSBmb3Igc2xvdCAlZCAodmFsaWQgYXQgJWQpXG4iLAorCQkJCQkgICAgIGogPT0gaSA/
ICJ2YWxpZCIgOiAiaW52YWxpZCIsIGosIGkpOworCQkJfQorCisJCQlkb19pb2N0bChpOTE1LCBE
Uk1fSU9DVExfSTkxNV9HRU1fQlVTWSwgJmJ1c3kpOworCQkJaWd0X2Fzc2VydF9lcShidXN5LmJ1
c3ksIGkgIT0gLTEgPyAxIDw8IChlLT5jbGFzcyArIDE2KSA6IDApOworCisJCQlpZ3Rfc3Bpbl9m
cmVlKGk5MTUsIHNwaW4pOworCisJCQlnZW1fc3luYyhpOTE1LCBvYmouaGFuZGxlKTsKKwkJCWRv
X2lvY3RsKGk5MTUsIERSTV9JT0NUTF9JOTE1X0dFTV9CVVNZLCAmYnVzeSk7CisJCQlpZ3RfYXNz
ZXJ0X2VxKGJ1c3kuYnVzeSwgMCk7CisJCX0KKwl9CisKKwkvKiBSZXN0b3JlIHRoZSBkZWZhdWx0
cyBhbmQgY2hlY2sgSTkxNV9FWEVDX0RFRkFVTFQgd29ya3MgYWdhaW4uICovCisJcGFyYW0uc2l6
ZSA9IDA7CisJZ2VtX2NvbnRleHRfc2V0X3BhcmFtKGk5MTUsICZwYXJhbSk7CisJZXhlY2J1Zi5m
bGFncyA9IDA7CisJZ2VtX2V4ZWNidWYoaTkxNSwgJmV4ZWNidWYpOworCisJZ2VtX2Nsb3NlKGk5
MTUsIG9iai5oYW5kbGUpOworCWdlbV9jb250ZXh0X2Rlc3Ryb3koaTkxNSwgcGFyYW0uY3R4X2lk
KTsKK30KKworc3RhdGljIHZvaWQgZXhlY3V0ZV9vbmVmb3JhbGwoaW50IGk5MTUpCit7CisJSTkx
NV9ERUZJTkVfQ09OVEVYVF9QQVJBTV9FTkdJTkVTKGVuZ2luZXMgLCBJOTE1X0VYRUNfUklOR19N
QVNLICsgMSk7CisJc3RydWN0IGRybV9pOTE1X2dlbV9jb250ZXh0X3BhcmFtIHBhcmFtID0gewor
CQkuY3R4X2lkID0gZ2VtX2NvbnRleHRfY3JlYXRlKGk5MTUpLAorCQkucGFyYW0gPSBJOTE1X0NP
TlRFWFRfUEFSQU1fRU5HSU5FUywKKwkJLnZhbHVlID0gdG9fdXNlcl9wb2ludGVyKCZlbmdpbmVz
KSwKKwkJLnNpemUgPSBzaXplb2YoZW5naW5lcyksCisJfTsKKwljb25zdCBzdHJ1Y3QgaW50ZWxf
ZXhlY3V0aW9uX2VuZ2luZTIgKmU7CisKKwlmb3JfZWFjaF9lbmdpbmVfY2xhc3NfaW5zdGFuY2Uo
aTkxNSwgZSkgeworCQltZW1zZXQoJmVuZ2luZXMsIDAsIHNpemVvZihlbmdpbmVzKSk7CisJCWZv
ciAoaW50IGkgPSAwOyBpIDw9IEk5MTVfRVhFQ19SSU5HX01BU0s7IGkrKykgeworCQkJZW5naW5l
X2NsYXNzKCZlbmdpbmVzLCBpKSA9IGUtPmNsYXNzOworCQkJZW5naW5lX2luc3RhbmNlKCZlbmdp
bmVzLCBpKSA9IGUtPmluc3RhbmNlOworCQl9CisJCWdlbV9jb250ZXh0X3NldF9wYXJhbShpOTE1
LCAmcGFyYW0pOworCisJCWZvciAoaW50IGkgPSAwOyBpIDw9IEk5MTVfRVhFQ19SSU5HX01BU0s7
IGkrKykgeworCQkJc3RydWN0IGRybV9pOTE1X2dlbV9idXN5IGJ1c3kgPSB7fTsKKwkJCWlndF9z
cGluX3QgKnNwaW47CisKKwkJCXNwaW4gPSBfX2lndF9zcGluX25ldyhpOTE1LAorCQkJCQkgICAg
ICAuY3R4ID0gcGFyYW0uY3R4X2lkLAorCQkJCQkgICAgICAuZW5naW5lID0gaSk7CisKKwkJCWJ1
c3kuaGFuZGxlID0gc3Bpbi0+aGFuZGxlOworCQkJZG9faW9jdGwoaTkxNSwgRFJNX0lPQ1RMX0k5
MTVfR0VNX0JVU1ksICZidXN5KTsKKwkJCWlndF9hc3NlcnRfZXEoYnVzeS5idXN5LCAxIDw8IChl
LT5jbGFzcyArIDE2KSk7CisKKwkJCWlndF9zcGluX2ZyZWUoaTkxNSwgc3Bpbik7CisJCX0KKwl9
CisKKwlnZW1fY29udGV4dF9kZXN0cm95KGk5MTUsIHBhcmFtLmN0eF9pZCk7Cit9CisKK3N0YXRp
YyB2b2lkIGV4ZWN1dGVfYWxsZm9yb25lKGludCBpOTE1KQoreworCUk5MTVfREVGSU5FX0NPTlRF
WFRfUEFSQU1fRU5HSU5FUyhlbmdpbmVzICwgSTkxNV9FWEVDX1JJTkdfTUFTSyArIDEpOworCXN0
cnVjdCBkcm1faTkxNV9nZW1fY29udGV4dF9wYXJhbSBwYXJhbSA9IHsKKwkJLmN0eF9pZCA9IGdl
bV9jb250ZXh0X2NyZWF0ZShpOTE1KSwKKwkJLnBhcmFtID0gSTkxNV9DT05URVhUX1BBUkFNX0VO
R0lORVMsCisJCS52YWx1ZSA9IHRvX3VzZXJfcG9pbnRlcigmZW5naW5lcyksCisJfTsKKwljb25z
dCBzdHJ1Y3QgaW50ZWxfZXhlY3V0aW9uX2VuZ2luZTIgKmU7CisJaW50IGk7CisKKwlpID0gMDsK
KwltZW1zZXQoJmVuZ2luZXMsIDAsIHNpemVvZihlbmdpbmVzKSk7CisJZm9yX2VhY2hfZW5naW5l
X2NsYXNzX2luc3RhbmNlKGk5MTUsIGUpIHsKKwkJZW5naW5lX2NsYXNzKCZlbmdpbmVzLCBpKSA9
IGUtPmNsYXNzOworCQllbmdpbmVfaW5zdGFuY2UoJmVuZ2luZXMsIGkpID0gZS0+aW5zdGFuY2U7
CisJCWkrKzsKKwl9CisJcGFyYW0uc2l6ZSA9IHNpemVvZih1aW50NjRfdCkgKyBpICogc2l6ZW9m
KHVpbnQzMl90KTsKKwlnZW1fY29udGV4dF9zZXRfcGFyYW0oaTkxNSwgJnBhcmFtKTsKKworCWkg
PSAwOworCWZvcl9lYWNoX2VuZ2luZV9jbGFzc19pbnN0YW5jZShpOTE1LCBlKSB7CisJCXN0cnVj
dCBkcm1faTkxNV9nZW1fYnVzeSBidXN5ID0ge307CisJCWlndF9zcGluX3QgKnNwaW47CisKKwkJ
c3BpbiA9IF9faWd0X3NwaW5fbmV3KGk5MTUsCisJCQkJICAgICAgLmN0eCA9IHBhcmFtLmN0eF9p
ZCwKKwkJCQkgICAgICAuZW5naW5lID0gaSsrKTsKKworCQlidXN5LmhhbmRsZSA9IHNwaW4tPmhh
bmRsZTsKKwkJZG9faW9jdGwoaTkxNSwgRFJNX0lPQ1RMX0k5MTVfR0VNX0JVU1ksICZidXN5KTsK
KwkJaWd0X2Fzc2VydF9lcShidXN5LmJ1c3ksIDEgPDwgKGUtPmNsYXNzICsgMTYpKTsKKworCQlp
Z3Rfc3Bpbl9mcmVlKGk5MTUsIHNwaW4pOworCX0KKworCWdlbV9jb250ZXh0X2Rlc3Ryb3koaTkx
NSwgcGFyYW0uY3R4X2lkKTsKK30KKworc3RhdGljIHZvaWQgaW5kZXBlbmRlbnQoaW50IGk5MTUp
Cit7CisjZGVmaW5lIFJDU19USU1FU1RBTVAgKDB4MjAwMCArIDB4MzU4KQorCWNvbnN0IGludCBn
ZW4gPSBpbnRlbF9nZW4oaW50ZWxfZ2V0X2RybV9kZXZpZChpOTE1KSk7CisJY29uc3QgaW50IGhh
c182NGJpdF9yZWxvYyA9IGdlbiA+PSA4OworCUk5MTVfREVGSU5FX0NPTlRFWFRfUEFSQU1fRU5H
SU5FUyhlbmdpbmVzICwgSTkxNV9FWEVDX1JJTkdfTUFTSyArIDEpOworCXN0cnVjdCBkcm1faTkx
NV9nZW1fY29udGV4dF9wYXJhbSBwYXJhbSA9IHsKKwkJLmN0eF9pZCA9IGdlbV9jb250ZXh0X2Ny
ZWF0ZShpOTE1KSwKKwkJLnBhcmFtID0gSTkxNV9DT05URVhUX1BBUkFNX0VOR0lORVMsCisJCS52
YWx1ZSA9IHRvX3VzZXJfcG9pbnRlcigmZW5naW5lcyksCisJCS5zaXplID0gc2l6ZW9mKGVuZ2lu
ZXMpLAorCX07CisJc3RydWN0IGRybV9pOTE1X2dlbV9leGVjX29iamVjdDIgcmVzdWx0cyA9IHsg
LmhhbmRsZSA9IGdlbV9jcmVhdGUoaTkxNSwgNDA5NikgfTsKKwljb25zdCB1aW50MzJfdCBiYmUg
PSBNSV9CQVRDSF9CVUZGRVJfRU5EOworCWludCB0aW1lbGluZSA9IHN3X3N5bmNfdGltZWxpbmVf
Y3JlYXRlKCk7CisJdWludDMyX3QgbGFzdCwgKm1hcDsKKworCXsKKwkJc3RydWN0IGRybV9pOTE1
X2dlbV9leGVjYnVmZmVyMiBleGVjYnVmID0geworCQkJLmJ1ZmZlcnNfcHRyID0gdG9fdXNlcl9w
b2ludGVyKCZyZXN1bHRzKSwKKwkJCS5idWZmZXJfY291bnQgPSAxLAorCQkJLnJzdmQxID0gcGFy
YW0uY3R4X2lkLAorCQl9OworCQlnZW1fd3JpdGUoaTkxNSwgcmVzdWx0cy5oYW5kbGUsIDAsICZi
YmUsIHNpemVvZihiYmUpKTsKKwkJZ2VtX2V4ZWNidWYoaTkxNSwgJmV4ZWNidWYpOworCQlyZXN1
bHRzLmZsYWdzID0gRVhFQ19PQkpFQ1RfUElOTkVEOworCX0KKworCW1lbXNldCgmZW5naW5lcywg
MCwgc2l6ZW9mKGVuZ2luZXMpKTsgLyogQWxsIHJjczAgKi8KKwlnZW1fY29udGV4dF9zZXRfcGFy
YW0oaTkxNSwgJnBhcmFtKTsKKworCWZvciAoaW50IGkgPSAwOyBpIDwgSTkxNV9FWEVDX1JJTkdf
TUFTSyArIDE7IGkrKykgeworCQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNfb2JqZWN0MiBvYmpb
Ml0gPSB7CisJCQlyZXN1bHRzLCAvKiB3cml0ZSBoYXphcmQgbGllcyEgKi8KKwkJCXsgLmhhbmRs
ZSA9IGdlbV9jcmVhdGUoaTkxNSwgNDA5NikgfSwKKwkJfTsKKwkJc3RydWN0IGRybV9pOTE1X2dl
bV9leGVjYnVmZmVyMiBleGVjYnVmID0geworCQkJLmJ1ZmZlcnNfcHRyID0gdG9fdXNlcl9wb2lu
dGVyKG9iaiksCisJCQkuYnVmZmVyX2NvdW50ID0gMiwKKwkJCS5yc3ZkMSA9IHBhcmFtLmN0eF9p
ZCwKKwkJCS5yc3ZkMiA9IHN3X3N5bmNfdGltZWxpbmVfY3JlYXRlX2ZlbmNlKHRpbWVsaW5lLCBp
ICsgMSksCisJCQkuZmxhZ3MgPSAoSTkxNV9FWEVDX1JJTkdfTUFTSyAtIGkpIHwgSTkxNV9FWEVD
X0ZFTkNFX0lOLAorCQl9OworCQl1aW50NjRfdCBvZmZzZXQgPSByZXN1bHRzLm9mZnNldCArIDQg
KiBpOworCQl1aW50MzJfdCAqY3M7CisJCWludCBqID0gMDsKKworCQljcyA9IGdlbV9tbWFwX19j
cHUoaTkxNSwgb2JqWzFdLmhhbmRsZSwgMCwgNDA5NiwgUFJPVF9XUklURSk7CisKKwkJY3Nbal0g
PSAweDI0IDw8IDIzIHwgMTsgLyogU1JNICovCisJCWlmIChoYXNfNjRiaXRfcmVsb2MpCisJCQlj
c1tqXSsrOworCQlqKys7CisJCWNzW2orK10gPSBSQ1NfVElNRVNUQU1QOworCQljc1tqKytdID0g
b2Zmc2V0OworCQlpZiAoaGFzXzY0Yml0X3JlbG9jKQorCQkJY3NbaisrXSA9IG9mZnNldCA+PiAz
MjsKKwkJY3NbaisrXSA9IE1JX0JBVENIX0JVRkZFUl9FTkQ7CisKKwkJbXVubWFwKGNzLCA0MDk2
KTsKKworCQlnZW1fZXhlY2J1ZihpOTE1LCAmZXhlY2J1Zik7CisJCWdlbV9jbG9zZShpOTE1LCBv
YmpbMV0uaGFuZGxlKTsKKwkJY2xvc2UoZXhlY2J1Zi5yc3ZkMik7CisJfQorCWNsb3NlKHRpbWVs
aW5lKTsKKwlnZW1fc3luYyhpOTE1LCByZXN1bHRzLmhhbmRsZSk7CisKKwltYXAgPSBnZW1fbW1h
cF9fY3B1KGk5MTUsIHJlc3VsdHMuaGFuZGxlLCAwLCA0MDk2LCBQUk9UX1JFQUQpOworCWdlbV9z
ZXRfZG9tYWluKGk5MTUsIHJlc3VsdHMuaGFuZGxlLCBJOTE1X0dFTV9ET01BSU5fQ1BVLCAwKTsK
KwlnZW1fY2xvc2UoaTkxNSwgcmVzdWx0cy5oYW5kbGUpOworCisJbGFzdCA9IG1hcFswXTsKKwlm
b3IgKGludCBpID0gMTsgaSA8IEk5MTVfRVhFQ19SSU5HX01BU0sgKyAxOyBpKyspIHsKKwkJaWd0
X2Fzc2VydF9mKChtYXBbaV0gLSBsYXN0KSA+IDAsCisJCQkgICAgICJFbmdpbmUgaW5zdGFuY2Ug
WyVkXSBleGVjdXRlZCB0b28gbGF0ZVxuIiwgaSk7CisJCWxhc3QgPSBtYXBbaV07CisJfQorCW11
bm1hcChtYXAsIDQwOTYpOworCisJZ2VtX2NvbnRleHRfZGVzdHJveShpOTE1LCBwYXJhbS5jdHhf
aWQpOworfQorCitpZ3RfbWFpbgoreworCWludCBpOTE1ID0gLTE7CisKKwlpZ3RfZml4dHVyZSB7
CisJCWk5MTUgPSBkcm1fb3Blbl9kcml2ZXJfcmVuZGVyKERSSVZFUl9JTlRFTCk7CisJCWlndF9y
ZXF1aXJlX2dlbShpOTE1KTsKKworCQlnZW1fcmVxdWlyZV9jb250ZXh0cyhpOTE1KTsKKwkJaWd0
X3JlcXVpcmUoaGFzX2NvbnRleHRfZW5naW5lcyhpOTE1KSk7CisJfQorCisJaWd0X3N1YnRlc3Qo
ImludmFsaWQtZW5naW5lcyIpCisJCWludmFsaWRfZW5naW5lcyhpOTE1KTsKKworCWlndF9zdWJ0
ZXN0KCJpZGVtcG90ZW50IikKKwkJaWRlbXBvdGVudChpOTE1KTsKKworCWlndF9zdWJ0ZXN0KCJl
eGVjdXRlLW9uZSIpCisJCWV4ZWN1dGVfb25lKGk5MTUpOworCisJaWd0X3N1YnRlc3QoImV4ZWN1
dGUtb25lZm9yYWxsIikKKwkJZXhlY3V0ZV9vbmVmb3JhbGwoaTkxNSk7CisKKwlpZ3Rfc3VidGVz
dCgiZXhlY3V0ZS1hbGxmb3JvbmUiKQorCQlleGVjdXRlX2FsbGZvcm9uZShpOTE1KTsKKworCWln
dF9zdWJ0ZXN0KCJpbmRlcGVuZGVudCIpCisJCWluZGVwZW5kZW50KGk5MTUpOworfQpkaWZmIC0t
Z2l0IGEvdGVzdHMvbWVzb24uYnVpbGQgYi90ZXN0cy9tZXNvbi5idWlsZAppbmRleCBmYWIyYTgy
OGIuLmI3ZTU2MTAzZCAxMDA2NDQKLS0tIGEvdGVzdHMvbWVzb24uYnVpbGQKKysrIGIvdGVzdHMv
bWVzb24uYnVpbGQKQEAgLTExNiw2ICsxMTYsNyBAQCBpOTE1X3Byb2dzID0gWwogCSdnZW1fY3R4
X2JhZF9kZXN0cm95JywKIAknZ2VtX2N0eF9jbG9uZScsCiAJJ2dlbV9jdHhfY3JlYXRlJywKKwkn
Z2VtX2N0eF9lbmdpbmVzJywKIAknZ2VtX2N0eF9leGVjJywKIAknZ2VtX2N0eF9pc29sYXRpb24n
LAogCSdnZW1fY3R4X3BhcmFtJywKLS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhA
bGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxt
YW4vbGlzdGluZm8vaW50ZWwtZ2Z4

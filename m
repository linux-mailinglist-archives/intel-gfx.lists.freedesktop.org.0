Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id B8D63CBC1E
	for <lists+intel-gfx@lfdr.de>; Fri,  4 Oct 2019 15:46:50 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 709056E30C;
	Fri,  4 Oct 2019 13:46:48 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga03.intel.com (mga03.intel.com [134.134.136.65])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4EC626E30C
 for <intel-gfx@lists.freedesktop.org>; Fri,  4 Oct 2019 13:46:47 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga007.jf.intel.com ([10.7.209.58])
 by orsmga103.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 04 Oct 2019 06:46:46 -0700
X-IronPort-AV: E=Sophos;i="5.67,256,1566889200"; d="scan'208";a="182710950"
Received: from paaron-mobl.ger.corp.intel.com (HELO [10.251.93.134])
 ([10.251.93.134])
 by orsmga007-auth.jf.intel.com with ESMTP/TLS/AES256-SHA;
 04 Oct 2019 06:46:44 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20191004134015.13204-1-chris@chris-wilson.co.uk>
 <20191004134015.13204-15-chris@chris-wilson.co.uk>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <db495745-d5e0-4f14-62b0-0e2a79157ba2@linux.intel.com>
Date: Fri, 4 Oct 2019 14:46:43 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <20191004134015.13204-15-chris@chris-wilson.co.uk>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH 14/20] drm/i915: Move context management
 under GEM
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDA0LzEwLzIwMTkgMTQ6NDAsIENocmlzIFdpbHNvbiB3cm90ZToKPiBLZWVwIHRyYWNrIG9m
IHRoZSBHRU0gY29udGV4dHMgdW5kZXJuZWF0aCBpOTE1LT5nZW0uY29udGV4dHMgYW5kIGFzc2ln
bgo+IHRoZW0gdGhlaXIgb3duIGxvY2sgZm9yIHRoZSBwdXJwb3NlcyBvZiBsaXN0IG1hbmFnZW1l
bnQuCj4gCj4gdjI6IEZvY3VzIG9uIGxvY2sgdHJhY2tpbmc7IGN0eC0+dm0gaXMgcHJvdGVjdGVk
IGJ5IGN0eC0+bXV0ZXgKPiB2MzogQ29ycmVjdCBzcGxpdCB3aXRoIHJlbW92YWwgb2YgbG9naWNh
bCBIVyBJRAoKUmV2aWV3ZWQtYnk6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBpbnRl
bC5jb20+CgpSZWdhcmRzLAoKVHZydGtvCgo+IFNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8
Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgo+IENjOiBUdnJ0a28gVXJzdWxpbiA8dHZydGtvLnVy
c3VsaW5AaW50ZWwuY29tPgo+IC0tLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX2NvbnRleHQuYyAgIHwgMTc3ICsrKysrKysrKy0tLS0tLS0tLQo+ICAgZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaCAgIHwgIDI3ICsrLQo+ICAgLi4uL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dF90eXBlcy5oIHwgICAyICstCj4gICAuLi4vZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMgICAgfCAgIDIgKy0KPiAgIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV91c2VycHRyLmMgICB8ICAgMyArLQo+ICAgLi4u
L2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2h1Z2VfcGFnZXMuYyAgIHwgIDM2ICsrLS0KPiAg
IC4uLi9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQuYyB8IDE2OCArKysr
KysrKy0tLS0tLS0tLQo+ICAgLi4uL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL21vY2tfY29u
dGV4dC5jIHwgICA3ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0
LmMgICAgICAgfCAgMTAgKy0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2Nv
bnRleHQuYyAgICB8ICAyNCArLS0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0
X2hhbmdjaGVjay5jICB8ICAzOSArKy0tCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxm
dGVzdF9scmMuYyAgICAgICAgfCAgIDYgKy0KPiAgIC4uLi9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRl
c3Rfd29ya2Fyb3VuZHMuYyAgICB8ICAyMiArKy0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2
dC9zY2hlZHVsZXIuYyAgICAgICAgICB8ICAyNCArLS0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZGVidWdmcy5jICAgICAgICAgICB8ICA1MCArKystLQo+ICAgZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9kcnYuYyAgICAgICAgICAgICAgIHwgICAyIC0KPiAgIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZHJ2LmggICAgICAgICAgICAgICB8ICAxNSArLQo+ICAgZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9nZW0uYyAgICAgICAgICAgICAgIHwgIDEwICstCj4gICBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuYyAgICAgICAgICAgfCAgIDQgKy0KPiAgIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfcGVyZi5jICAgICAgICAgICAgICB8ICAyNCArKy0KPiAgIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfc3lzZnMuYyAgICAgICAgICAgICB8ICA0MyArKy0tLQo+ICAg
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90cmFjZS5oICAgICAgICAgICAgIHwgICAyICstCj4g
ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW0uYyAgICAgfCAgIDggLQo+
ICAgLi4uL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZXZpY3QuYyAgIHwgICAzIC0K
PiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ndHQuYyB8ICAxNSAr
LQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfcmVxdWVzdC5jIHwgIDEy
ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV92bWEuYyAgICAgfCAg
IDcgKy0KPiAgIC4uLi9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfZ2VtX2RldmljZS5jICB8
ICAgNiArLQo+ICAgMjggZmlsZXMgY2hhbmdlZCwgMzk0IGluc2VydGlvbnMoKyksIDM1NCBkZWxl
dGlvbnMoLSkKPiAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0
LmMKPiBpbmRleCBjZDRmMzI3YjIzYmQuLjVkODIyMWM3YmE4MyAxMDA2NDQKPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCj4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYwo+IEBAIC0yMTgsOSArMjE4LDEyIEBA
IHN0YXRpYyBzdHJ1Y3QgaTkxNV9nZW1fZW5naW5lcyAqZGVmYXVsdF9lbmdpbmVzKHN0cnVjdCBp
OTE1X2dlbV9jb250ZXh0ICpjdHgpCj4gICAKPiAgIHN0YXRpYyB2b2lkIGk5MTVfZ2VtX2NvbnRl
eHRfZnJlZShzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQo+ICAgewo+IC0JbG9ja2RlcF9h
c3NlcnRfaGVsZCgmY3R4LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAlHRU1fQlVHX09O
KCFpOTE1X2dlbV9jb250ZXh0X2lzX2Nsb3NlZChjdHgpKTsKPiAgIAo+ICsJc3Bpbl9sb2NrKCZj
dHgtPmk5MTUtPmdlbS5jb250ZXh0cy5sb2NrKTsKPiArCWxpc3RfZGVsKCZjdHgtPmxpbmspOwo+
ICsJc3Bpbl91bmxvY2soJmN0eC0+aTkxNS0+Z2VtLmNvbnRleHRzLmxvY2spOwo+ICsKPiAgIAlm
cmVlX2VuZ2luZXMocmN1X2FjY2Vzc19wb2ludGVyKGN0eC0+ZW5naW5lcykpOwo+ICAgCW11dGV4
X2Rlc3Ryb3koJmN0eC0+ZW5naW5lc19tdXRleCk7Cj4gICAKPiBAQCAtMjMwLDY3ICsyMzMsNTQg
QEAgc3RhdGljIHZvaWQgaTkxNV9nZW1fY29udGV4dF9mcmVlKHN0cnVjdCBpOTE1X2dlbV9jb250
ZXh0ICpjdHgpCj4gICAJa2ZyZWUoY3R4LT5uYW1lKTsKPiAgIAlwdXRfcGlkKGN0eC0+cGlkKTsK
PiAgIAo+IC0JbGlzdF9kZWwoJmN0eC0+bGluayk7Cj4gICAJbXV0ZXhfZGVzdHJveSgmY3R4LT5t
dXRleCk7Cj4gICAKPiAgIAlrZnJlZV9yY3UoY3R4LCByY3UpOwo+ICAgfQo+ICAgCj4gLXN0YXRp
YyB2b2lkIGNvbnRleHRzX2ZyZWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gK3N0
YXRpYyB2b2lkIGNvbnRleHRzX2ZyZWVfYWxsKHN0cnVjdCBsbGlzdF9ub2RlICpsaXN0KQo+ICAg
ewo+IC0Jc3RydWN0IGxsaXN0X25vZGUgKmZyZWVkID0gbGxpc3RfZGVsX2FsbCgmaTkxNS0+Y29u
dGV4dHMuZnJlZV9saXN0KTsKPiAgIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LCAqY247
Cj4gICAKPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+
IC0KPiAtCWxsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUoY3R4LCBjbiwgZnJlZWQsIGZyZWVfbGlu
aykKPiArCWxsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUoY3R4LCBjbiwgbGlzdCwgZnJlZV9saW5r
KQo+ICAgCQlpOTE1X2dlbV9jb250ZXh0X2ZyZWUoY3R4KTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMg
dm9pZCBjb250ZXh0c19mcmVlX2ZpcnN0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ICtzdGF0aWMgdm9pZCBjb250ZXh0c19mbHVzaF9mcmVlKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0
cyAqZ2MpCj4gICB7Cj4gLQlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4Owo+IC0Jc3RydWN0
IGxsaXN0X25vZGUgKmZyZWVkOwo+IC0KPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmRy
bS5zdHJ1Y3RfbXV0ZXgpOwo+IC0KPiAtCWZyZWVkID0gbGxpc3RfZGVsX2ZpcnN0KCZpOTE1LT5j
b250ZXh0cy5mcmVlX2xpc3QpOwo+IC0JaWYgKCFmcmVlZCkKPiAtCQlyZXR1cm47Cj4gLQo+IC0J
Y3R4ID0gY29udGFpbmVyX29mKGZyZWVkLCB0eXBlb2YoKmN0eCksIGZyZWVfbGluayk7Cj4gLQlp
OTE1X2dlbV9jb250ZXh0X2ZyZWUoY3R4KTsKPiArCWNvbnRleHRzX2ZyZWVfYWxsKGxsaXN0X2Rl
bF9hbGwoJmdjLT5mcmVlX2xpc3QpKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgY29udGV4
dHNfZnJlZV93b3JrZXIoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAgewo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPQo+IC0JCWNvbnRhaW5lcl9vZih3b3JrLCB0eXBlb2Yo
Kmk5MTUpLCBjb250ZXh0cy5mcmVlX3dvcmspOwo+ICsJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHRz
ICpnYyA9Cj4gKwkJY29udGFpbmVyX29mKHdvcmssIHR5cGVvZigqZ2MpLCBmcmVlX3dvcmspOwo+
ICAgCj4gLQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAtCWNvbnRleHRz
X2ZyZWUoaTkxNSk7Cj4gLQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+
ICsJY29udGV4dHNfZmx1c2hfZnJlZShnYyk7Cj4gICB9Cj4gICAKPiAgIHZvaWQgaTkxNV9nZW1f
Y29udGV4dF9yZWxlYXNlKHN0cnVjdCBrcmVmICpyZWYpCj4gICB7Cj4gICAJc3RydWN0IGk5MTVf
Z2VtX2NvbnRleHQgKmN0eCA9IGNvbnRhaW5lcl9vZihyZWYsIHR5cGVvZigqY3R4KSwgcmVmKTsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gY3R4LT5pOTE1Owo+ICsJc3RydWN0
IGk5MTVfZ2VtX2NvbnRleHRzICpnYyA9ICZjdHgtPmk5MTUtPmdlbS5jb250ZXh0czsKPiAgIAo+
ICAgCXRyYWNlX2k5MTVfY29udGV4dF9mcmVlKGN0eCk7Cj4gLQlpZiAobGxpc3RfYWRkKCZjdHgt
PmZyZWVfbGluaywgJmk5MTUtPmNvbnRleHRzLmZyZWVfbGlzdCkpCj4gLQkJcXVldWVfd29yayhp
OTE1LT53cSwgJmk5MTUtPmNvbnRleHRzLmZyZWVfd29yayk7Cj4gKwlpZiAobGxpc3RfYWRkKCZj
dHgtPmZyZWVfbGluaywgJmdjLT5mcmVlX2xpc3QpKQo+ICsJCXNjaGVkdWxlX3dvcmsoJmdjLT5m
cmVlX3dvcmspOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZCBjb250ZXh0X2Nsb3NlKHN0cnVj
dCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCj4gICB7Cj4gLQlpOTE1X2dlbV9jb250ZXh0X3NldF9j
bG9zZWQoY3R4KTsKPiArCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtOwo+ICAgCj4gLQlp
ZiAoY3R4LT52bSkKPiAtCQlpOTE1X3ZtX2Nsb3NlKGN0eC0+dm0pOwo+ICsJaTkxNV9nZW1fY29u
dGV4dF9zZXRfY2xvc2VkKGN0eCk7Cj4gICAKPiAgIAltdXRleF9sb2NrKCZjdHgtPm11dGV4KTsK
PiAgIAo+ICsJdm0gPSBpOTE1X2dlbV9jb250ZXh0X3ZtKGN0eCk7Cj4gKwlpZiAodm0pCj4gKwkJ
aTkxNV92bV9jbG9zZSh2bSk7Cj4gKwo+ICAgCWN0eC0+ZmlsZV9wcml2ID0gRVJSX1BUUigtRUJB
REYpOwo+ICAgCj4gICAJLyoKPiBAQCAtMzE3LDcgKzMwNyw2IEBAIF9fY3JlYXRlX2NvbnRleHQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICAJCXJldHVybiBFUlJfUFRSKC1FTk9N
RU0pOwo+ICAgCj4gICAJa3JlZl9pbml0KCZjdHgtPnJlZik7Cj4gLQlsaXN0X2FkZF90YWlsKCZj
dHgtPmxpbmssICZpOTE1LT5jb250ZXh0cy5saXN0KTsKPiAgIAljdHgtPmk5MTUgPSBpOTE1Owo+
ICAgCWN0eC0+c2NoZWQucHJpb3JpdHkgPSBJOTE1X1VTRVJfUFJJT1JJVFkoSTkxNV9QUklPUklU
WV9OT1JNQUwpOwo+ICAgCW11dGV4X2luaXQoJmN0eC0+bXV0ZXgpOwo+IEBAIC0zNDMsNiArMzMy
LDEwIEBAIF9fY3JlYXRlX2NvbnRleHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
ICAJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoY3R4LT5oYW5nX3RpbWVzdGFtcCk7IGkrKykK
PiAgIAkJY3R4LT5oYW5nX3RpbWVzdGFtcFtpXSA9IGppZmZpZXMgLSBDT05URVhUX0ZBU1RfSEFO
R19KSUZGSUVTOwo+ICAgCj4gKwlzcGluX2xvY2soJmk5MTUtPmdlbS5jb250ZXh0cy5sb2NrKTsK
PiArCWxpc3RfYWRkX3RhaWwoJmN0eC0+bGluaywgJmk5MTUtPmdlbS5jb250ZXh0cy5saXN0KTsK
PiArCXNwaW5fdW5sb2NrKCZpOTE1LT5nZW0uY29udGV4dHMubG9jayk7Cj4gKwo+ICAgCXJldHVy
biBjdHg7Cj4gICAKPiAgIGVycl9mcmVlOgo+IEBAIC0zNzIsMTEgKzM2NSwxMSBAQCBzdGF0aWMg
dm9pZCBfX2FwcGx5X3BwZ3R0KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgdm9pZCAqdm0pCj4g
ICBzdGF0aWMgc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqCj4gICBfX3NldF9wcGd0dChzdHJ1
Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LCBzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSkK
PiAgIHsKPiAtCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKm9sZCA9IGN0eC0+dm07Cj4gKwlz
dHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICpvbGQgPSBpOTE1X2dlbV9jb250ZXh0X3ZtKGN0eCk7
Cj4gICAKPiAgIAlHRU1fQlVHX09OKG9sZCAmJiBpOTE1X3ZtX2lzXzRsdmwodm0pICE9IGk5MTVf
dm1faXNfNGx2bChvbGQpKTsKPiAgIAo+IC0JY3R4LT52bSA9IGk5MTVfdm1fb3Blbih2bSk7Cj4g
KwlyY3VfYXNzaWduX3BvaW50ZXIoY3R4LT52bSwgaTkxNV92bV9vcGVuKHZtKSk7Cj4gICAJY29u
dGV4dF9hcHBseV9hbGwoY3R4LCBfX2FwcGx5X3BwZ3R0LCB2bSk7Cj4gICAKPiAgIAlyZXR1cm4g
b2xkOwo+IEBAIC0zODUsNyArMzc4LDcgQEAgX19zZXRfcHBndHQoc3RydWN0IGk5MTVfZ2VtX2Nv
bnRleHQgKmN0eCwgc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0pCj4gICBzdGF0aWMgdm9p
ZCBfX2Fzc2lnbl9wcGd0dChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAo+ICAgCQkJICAg
c3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0pCj4gICB7Cj4gLQlpZiAodm0gPT0gY3R4LT52
bSkKPiArCWlmICh2bSA9PSByY3VfYWNjZXNzX3BvaW50ZXIoY3R4LT52bSkpCj4gICAJCXJldHVy
bjsKPiAgIAo+ICAgCXZtID0gX19zZXRfcHBndHQoY3R4LCB2bSk7Cj4gQEAgLTQxNywyNyArNDEw
LDI1IEBAIHN0YXRpYyB2b2lkIF9fYXNzaWduX3RpbWVsaW5lKHN0cnVjdCBpOTE1X2dlbV9jb250
ZXh0ICpjdHgsCj4gICB9Cj4gICAKPiAgIHN0YXRpYyBzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAq
Cj4gLWk5MTVfZ2VtX2NyZWF0ZV9jb250ZXh0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwgdW5zaWduZWQgaW50IGZsYWdzKQo+ICtpOTE1X2dlbV9jcmVhdGVfY29udGV4dChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdW5zaWduZWQgaW50IGZsYWdzKQo+ICAgewo+ICAg
CXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7Cj4gICAKPiAtCWxvY2tkZXBfYXNzZXJ0X2hl
bGQoJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiAtCj4gICAJaWYgKGZsYWdzICYgSTkx
NV9DT05URVhUX0NSRUFURV9GTEFHU19TSU5HTEVfVElNRUxJTkUgJiYKPiAtCSAgICAhSEFTX0VY
RUNMSVNUUyhkZXZfcHJpdikpCj4gKwkgICAgIUhBU19FWEVDTElTVFMoaTkxNSkpCj4gICAJCXJl
dHVybiBFUlJfUFRSKC1FSU5WQUwpOwo+ICAgCj4gLQkvKiBSZWFwIHRoZSBtb3N0IHN0YWxlIGNv
bnRleHQgKi8KPiAtCWNvbnRleHRzX2ZyZWVfZmlyc3QoZGV2X3ByaXYpOwo+ICsJLyogUmVhcCB0
aGUgc3RhbGUgY29udGV4dHMgKi8KPiArCWNvbnRleHRzX2ZsdXNoX2ZyZWUoJmk5MTUtPmdlbS5j
b250ZXh0cyk7Cj4gICAKPiAtCWN0eCA9IF9fY3JlYXRlX2NvbnRleHQoZGV2X3ByaXYpOwo+ICsJ
Y3R4ID0gX19jcmVhdGVfY29udGV4dChpOTE1KTsKPiAgIAlpZiAoSVNfRVJSKGN0eCkpCj4gICAJ
CXJldHVybiBjdHg7Cj4gICAKPiAtCWlmIChIQVNfRlVMTF9QUEdUVChkZXZfcHJpdikpIHsKPiAr
CWlmIChIQVNfRlVMTF9QUEdUVChpOTE1KSkgewo+ICAgCQlzdHJ1Y3QgaTkxNV9wcGd0dCAqcHBn
dHQ7Cj4gICAKPiAtCQlwcGd0dCA9IGk5MTVfcHBndHRfY3JlYXRlKGRldl9wcml2KTsKPiArCQlw
cGd0dCA9IGk5MTVfcHBndHRfY3JlYXRlKGk5MTUpOwo+ICAgCQlpZiAoSVNfRVJSKHBwZ3R0KSkg
ewo+ICAgCQkJRFJNX0RFQlVHX0RSSVZFUigiUFBHVFQgc2V0dXAgZmFpbGVkICglbGQpXG4iLAo+
ICAgCQkJCQkgUFRSX0VSUihwcGd0dCkpOwo+IEBAIC00NDUsMTQgKzQzNiwxNyBAQCBpOTE1X2dl
bV9jcmVhdGVfY29udGV4dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHVuc2ln
bmVkIGludCBmbGFncykKPiAgIAkJCXJldHVybiBFUlJfQ0FTVChwcGd0dCk7Cj4gICAJCX0KPiAg
IAo+ICsJCW11dGV4X2xvY2soJmN0eC0+bXV0ZXgpOwo+ICAgCQlfX2Fzc2lnbl9wcGd0dChjdHgs
ICZwcGd0dC0+dm0pOwo+ICsJCW11dGV4X3VubG9jaygmY3R4LT5tdXRleCk7Cj4gKwo+ICAgCQlp
OTE1X3ZtX3B1dCgmcHBndHQtPnZtKTsKPiAgIAl9Cj4gICAKPiAgIAlpZiAoZmxhZ3MgJiBJOTE1
X0NPTlRFWFRfQ1JFQVRFX0ZMQUdTX1NJTkdMRV9USU1FTElORSkgewo+ICAgCQlzdHJ1Y3QgaW50
ZWxfdGltZWxpbmUgKnRpbWVsaW5lOwo+ICAgCj4gLQkJdGltZWxpbmUgPSBpbnRlbF90aW1lbGlu
ZV9jcmVhdGUoJmRldl9wcml2LT5ndCwgTlVMTCk7Cj4gKwkJdGltZWxpbmUgPSBpbnRlbF90aW1l
bGluZV9jcmVhdGUoJmk5MTUtPmd0LCBOVUxMKTsKPiAgIAkJaWYgKElTX0VSUih0aW1lbGluZSkp
IHsKPiAgIAkJCWNvbnRleHRfY2xvc2UoY3R4KTsKPiAgIAkJCXJldHVybiBFUlJfQ0FTVCh0aW1l
bGluZSk7Cj4gQEAgLTQ5Nyw0MiArNDkxLDQwIEBAIGk5MTVfZ2VtX2NvbnRleHRfY3JlYXRlX2tl
cm5lbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50IHByaW8pCj4gICAJcmV0dXJu
IGN0eDsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBpbml0X2NvbnRleHRzKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ICtzdGF0aWMgdm9pZCBpbml0X2NvbnRleHRzKHN0cnVjdCBp
OTE1X2dlbV9jb250ZXh0cyAqZ2MpCj4gICB7Cj4gLQltdXRleF9pbml0KCZpOTE1LT5jb250ZXh0
cy5tdXRleCk7Cj4gLQlJTklUX0xJU1RfSEVBRCgmaTkxNS0+Y29udGV4dHMubGlzdCk7Cj4gKwlz
cGluX2xvY2tfaW5pdCgmZ2MtPmxvY2spOwo+ICsJSU5JVF9MSVNUX0hFQUQoJmdjLT5saXN0KTsK
PiAgIAo+IC0JSU5JVF9XT1JLKCZpOTE1LT5jb250ZXh0cy5mcmVlX3dvcmssIGNvbnRleHRzX2Zy
ZWVfd29ya2VyKTsKPiAtCWluaXRfbGxpc3RfaGVhZCgmaTkxNS0+Y29udGV4dHMuZnJlZV9saXN0
KTsKPiArCUlOSVRfV09SSygmZ2MtPmZyZWVfd29yaywgY29udGV4dHNfZnJlZV93b3JrZXIpOwo+
ICsJaW5pdF9sbGlzdF9oZWFkKCZnYy0+ZnJlZV9saXN0KTsKPiAgIH0KPiAgIAo+IC1pbnQgaTkx
NV9nZW1fY29udGV4dHNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
K2ludCBpOTE1X2dlbV9pbml0X2NvbnRleHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ICAgewo+ICAgCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7Cj4gICAKPiAgIAkvKiBS
ZWFzc3VyZSBvdXJzZWx2ZXMgd2UgYXJlIG9ubHkgY2FsbGVkIG9uY2UgKi8KPiAtCUdFTV9CVUdf
T04oZGV2X3ByaXYtPmtlcm5lbF9jb250ZXh0KTsKPiArCUdFTV9CVUdfT04oaTkxNS0+a2VybmVs
X2NvbnRleHQpOwo+ICAgCj4gLQlpbml0X2NvbnRleHRzKGRldl9wcml2KTsKPiArCWluaXRfY29u
dGV4dHMoJmk5MTUtPmdlbS5jb250ZXh0cyk7Cj4gICAKPiAgIAkvKiBsb3dlc3QgcHJpb3JpdHk7
IGlkbGUgdGFzayAqLwo+IC0JY3R4ID0gaTkxNV9nZW1fY29udGV4dF9jcmVhdGVfa2VybmVsKGRl
dl9wcml2LCBJOTE1X1BSSU9SSVRZX01JTik7Cj4gKwljdHggPSBpOTE1X2dlbV9jb250ZXh0X2Ny
ZWF0ZV9rZXJuZWwoaTkxNSwgSTkxNV9QUklPUklUWV9NSU4pOwo+ICAgCWlmIChJU19FUlIoY3R4
KSkgewo+ICAgCQlEUk1fRVJST1IoIkZhaWxlZCB0byBjcmVhdGUgZGVmYXVsdCBnbG9iYWwgY29u
dGV4dFxuIik7Cj4gICAJCXJldHVybiBQVFJfRVJSKGN0eCk7Cj4gICAJfQo+IC0JZGV2X3ByaXYt
Pmtlcm5lbF9jb250ZXh0ID0gY3R4Owo+ICsJaTkxNS0+a2VybmVsX2NvbnRleHQgPSBjdHg7Cj4g
ICAKPiAgIAlEUk1fREVCVUdfRFJJVkVSKCIlcyBjb250ZXh0IHN1cHBvcnQgaW5pdGlhbGl6ZWRc
biIsCj4gLQkJCSBEUklWRVJfQ0FQUyhkZXZfcHJpdiktPmhhc19sb2dpY2FsX2NvbnRleHRzID8K
PiArCQkJIERSSVZFUl9DQVBTKGk5MTUpLT5oYXNfbG9naWNhbF9jb250ZXh0cyA/Cj4gICAJCQkg
ImxvZ2ljYWwiIDogImZha2UiKTsKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+IC12b2lkIGk5
MTVfZ2VtX2NvbnRleHRzX2Zpbmkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gK3Zv
aWQgaTkxNV9nZW1fZHJpdmVyX3JlbGVhc2VfX2NvbnRleHRzKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ICAgewo+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+ZHJtLnN0cnVj
dF9tdXRleCk7Cj4gLQo+ICAgCWRlc3Ryb3lfa2VybmVsX2NvbnRleHQoJmk5MTUtPmtlcm5lbF9j
b250ZXh0KTsKPiAgIH0KPiAgIAo+IEBAIC01NTEsMTEgKzU0MywxNiBAQCBzdGF0aWMgaW50IHZt
X2lkcl9jbGVhbnVwKGludCBpZCwgdm9pZCAqcCwgdm9pZCAqZGF0YSkKPiAgIHN0YXRpYyBpbnQg
Z2VtX2NvbnRleHRfcmVnaXN0ZXIoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKPiAgIAkJ
CQlzdHJ1Y3QgZHJtX2k5MTVfZmlsZV9wcml2YXRlICpmcHJpdikKPiAgIHsKPiArCXN0cnVjdCBp
OTE1X2FkZHJlc3Nfc3BhY2UgKnZtOwo+ICAgCWludCByZXQ7Cj4gICAKPiAgIAljdHgtPmZpbGVf
cHJpdiA9IGZwcml2Owo+IC0JaWYgKGN0eC0+dm0pCj4gLQkJY3R4LT52bS0+ZmlsZSA9IGZwcml2
Owo+ICsKPiArCW11dGV4X2xvY2soJmN0eC0+bXV0ZXgpOwo+ICsJdm0gPSBpOTE1X2dlbV9jb250
ZXh0X3ZtKGN0eCk7Cj4gKwlpZiAodm0pCj4gKwkJV1JJVEVfT05DRSh2bS0+ZmlsZSwgZnByaXYp
OyAvKiBYWFggKi8KPiArCW11dGV4X3VubG9jaygmY3R4LT5tdXRleCk7Cj4gICAKPiAgIAljdHgt
PnBpZCA9IGdldF90YXNrX3BpZChjdXJyZW50LCBQSURUWVBFX1BJRCk7Cj4gICAJY3R4LT5uYW1l
ID0ga2FzcHJpbnRmKEdGUF9LRVJORUwsICIlc1slZF0iLAo+IEBAIC01OTIsOSArNTg5LDcgQEAg
aW50IGk5MTVfZ2VtX2NvbnRleHRfb3BlbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
PiAgIAlpZHJfaW5pdCgmZmlsZV9wcml2LT5jb250ZXh0X2lkcik7Cj4gICAJaWRyX2luaXRfYmFz
ZSgmZmlsZV9wcml2LT52bV9pZHIsIDEpOwo+ICAgCj4gLQltdXRleF9sb2NrKCZpOTE1LT5kcm0u
c3RydWN0X211dGV4KTsKPiAgIAljdHggPSBpOTE1X2dlbV9jcmVhdGVfY29udGV4dChpOTE1LCAw
KTsKPiAtCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAJaWYgKElT
X0VSUihjdHgpKSB7Cj4gICAJCWVyciA9IFBUUl9FUlIoY3R4KTsKPiAgIAkJZ290byBlcnI7Cj4g
QEAgLTYyMiw2ICs2MTcsNyBAQCBpbnQgaTkxNV9nZW1fY29udGV4dF9vcGVuKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ICAgdm9pZCBpOTE1X2dlbV9jb250ZXh0X2Nsb3NlKHN0cnVj
dCBkcm1fZmlsZSAqZmlsZSkKPiAgIHsKPiAgIAlzdHJ1Y3QgZHJtX2k5MTVfZmlsZV9wcml2YXRl
ICpmaWxlX3ByaXYgPSBmaWxlLT5kcml2ZXJfcHJpdjsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gZmlsZV9wcml2LT5kZXZfcHJpdjsKPiAgIAo+ICAgCWlkcl9mb3JfZWFjaCgm
ZmlsZV9wcml2LT5jb250ZXh0X2lkciwgY29udGV4dF9pZHJfY2xlYW51cCwgTlVMTCk7Cj4gICAJ
aWRyX2Rlc3Ryb3koJmZpbGVfcHJpdi0+Y29udGV4dF9pZHIpOwo+IEBAIC02MzAsNiArNjI2LDgg
QEAgdm9pZCBpOTE1X2dlbV9jb250ZXh0X2Nsb3NlKHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkKPiAg
IAlpZHJfZm9yX2VhY2goJmZpbGVfcHJpdi0+dm1faWRyLCB2bV9pZHJfY2xlYW51cCwgTlVMTCk7
Cj4gICAJaWRyX2Rlc3Ryb3koJmZpbGVfcHJpdi0+dm1faWRyKTsKPiAgIAltdXRleF9kZXN0cm95
KCZmaWxlX3ByaXYtPnZtX2lkcl9sb2NrKTsKPiArCj4gKwljb250ZXh0c19mbHVzaF9mcmVlKCZp
OTE1LT5nZW0uY29udGV4dHMpOwo+ICAgfQo+ICAgCj4gICBpbnQgaTkxNV9nZW1fdm1fY3JlYXRl
X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gQEAgLTgwOCwxNiAr
ODA2LDEyIEBAIHN0YXRpYyBpbnQgZ2V0X3BwZ3R0KHN0cnVjdCBkcm1faTkxNV9maWxlX3ByaXZh
dGUgKmZpbGVfcHJpdiwKPiAgIAlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsKPiAgIAlp
bnQgcmV0Owo+ICAgCj4gLQlpZiAoIWN0eC0+dm0pCj4gKwlpZiAoIXJjdV9hY2Nlc3NfcG9pbnRl
cihjdHgtPnZtKSkKPiAgIAkJcmV0dXJuIC1FTk9ERVY7Cj4gICAKPiAtCS8qIFhYWCByY3UgYWNx
dWlyZT8gKi8KPiAtCXJldCA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmY3R4LT5pOTE1LT5k
cm0uc3RydWN0X211dGV4KTsKPiAtCWlmIChyZXQpCj4gLQkJcmV0dXJuIHJldDsKPiAtCj4gKwly
Y3VfcmVhZF9sb2NrKCk7Cj4gICAJdm0gPSBpOTE1X3ZtX2dldChjdHgtPnZtKTsKPiAtCW11dGV4
X3VubG9jaygmY3R4LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiArCXJjdV9yZWFkX3VubG9j
aygpOwo+ICAgCj4gICAJcmV0ID0gbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKCZmaWxlX3ByaXYt
PnZtX2lkcl9sb2NrKTsKPiAgIAlpZiAocmV0KQo+IEBAIC05MjYsNyArOTIwLDcgQEAgc3RhdGlj
IGludCBzZXRfcHBndHQoc3RydWN0IGRybV9pOTE1X2ZpbGVfcHJpdmF0ZSAqZmlsZV9wcml2LAo+
ICAgCWlmIChhcmdzLT5zaXplKQo+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiAgIAo+IC0JaWYgKCFj
dHgtPnZtKQo+ICsJaWYgKCFyY3VfYWNjZXNzX3BvaW50ZXIoY3R4LT52bSkpCj4gICAJCXJldHVy
biAtRU5PREVWOwo+ICAgCj4gICAJaWYgKHVwcGVyXzMyX2JpdHMoYXJncy0+dmFsdWUpKQo+IEBA
IC05NDAsMTcgKzkzNCwyMCBAQCBzdGF0aWMgaW50IHNldF9wcGd0dChzdHJ1Y3QgZHJtX2k5MTVf
ZmlsZV9wcml2YXRlICpmaWxlX3ByaXYsCj4gICAJaWYgKCF2bSkKPiAgIAkJcmV0dXJuIC1FTk9F
TlQ7Cj4gICAKPiAtCWVyciA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmY3R4LT5pOTE1LT5k
cm0uc3RydWN0X211dGV4KTsKPiArCWVyciA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmY3R4
LT5tdXRleCk7Cj4gICAJaWYgKGVycikKPiAgIAkJZ290byBvdXQ7Cj4gICAKPiAtCWlmICh2bSA9
PSBjdHgtPnZtKQo+ICsJaWYgKGk5MTVfZ2VtX2NvbnRleHRfaXNfY2xvc2VkKGN0eCkpIHsKPiAr
CQllcnIgPSAtRU5PRU5UOwo+ICsJCWdvdG8gb3V0Owo+ICsJfQo+ICsKPiArCWlmICh2bSA9PSBy
Y3VfYWNjZXNzX3BvaW50ZXIoY3R4LT52bSkpCj4gICAJCWdvdG8gdW5sb2NrOwo+ICAgCj4gICAJ
LyogVGVhcmRvd24gdGhlIGV4aXN0aW5nIG9iajp2bWEgY2FjaGUsIGl0IHdpbGwgaGF2ZSB0byBi
ZSByZWJ1aWx0LiAqLwo+IC0JbXV0ZXhfbG9jaygmY3R4LT5tdXRleCk7Cj4gICAJbHV0X2Nsb3Nl
KGN0eCk7Cj4gLQltdXRleF91bmxvY2soJmN0eC0+bXV0ZXgpOwo+ICAgCj4gICAJb2xkID0gX19z
ZXRfcHBndHQoY3R4LCB2bSk7Cj4gICAKPiBAQCAtOTcwLDggKzk2Nyw3IEBAIHN0YXRpYyBpbnQg
c2V0X3BwZ3R0KHN0cnVjdCBkcm1faTkxNV9maWxlX3ByaXZhdGUgKmZpbGVfcHJpdiwKPiAgIAl9
Cj4gICAKPiAgIHVubG9jazoKPiAtCW11dGV4X3VubG9jaygmY3R4LT5pOTE1LT5kcm0uc3RydWN0
X211dGV4KTsKPiAtCj4gKwltdXRleF91bmxvY2soJmN0eC0+bXV0ZXgpOwo+ICAgb3V0Ogo+ICAg
CWk5MTVfdm1fcHV0KHZtKTsKPiAgIAlyZXR1cm4gZXJyOwo+IEBAIC0xODI3LDEwICsxODIzLDEx
IEBAIHN0YXRpYyBpbnQgY2xvbmVfdm0oc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmRzdCwKPiAg
IAkJICAgIHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpzcmMpCj4gICB7Cj4gICAJc3RydWN0IGk5
MTVfYWRkcmVzc19zcGFjZSAqdm07Cj4gKwlpbnQgZXJyID0gMDsKPiAgIAo+ICAgCXJjdV9yZWFk
X2xvY2soKTsKPiAgIAlkbyB7Cj4gLQkJdm0gPSBSRUFEX09OQ0Uoc3JjLT52bSk7Cj4gKwkJdm0g
PSByY3VfZGVyZWZlcmVuY2Uoc3JjLT52bSk7Cj4gICAJCWlmICghdm0pCj4gICAJCQlicmVhazsK
PiAgIAo+IEBAIC0xODUyLDcgKzE4NDksNyBAQCBzdGF0aWMgaW50IGNsb25lX3ZtKHN0cnVjdCBp
OTE1X2dlbV9jb250ZXh0ICpkc3QsCj4gICAJCSAqIGl0IGNhbm5vdCBiZSByZWFsbG9jYXRlZCBl
bHNld2hlcmUuCj4gICAJCSAqLwo+ICAgCj4gLQkJaWYgKHZtID09IFJFQURfT05DRShzcmMtPnZt
KSkKPiArCQlpZiAodm0gPT0gcmN1X2FjY2Vzc19wb2ludGVyKHNyYy0+dm0pKQo+ICAgCQkJYnJl
YWs7Cj4gICAKPiAgIAkJaTkxNV92bV9wdXQodm0pOwo+IEBAIC0xODYwLDExICsxODU3LDE2IEBA
IHN0YXRpYyBpbnQgY2xvbmVfdm0oc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmRzdCwKPiAgIAly
Y3VfcmVhZF91bmxvY2soKTsKPiAgIAo+ICAgCWlmICh2bSkgewo+IC0JCV9fYXNzaWduX3BwZ3R0
KGRzdCwgdm0pOwo+ICsJCWlmICghbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKCZkc3QtPm11dGV4
KSkgewo+ICsJCQlfX2Fzc2lnbl9wcGd0dChkc3QsIHZtKTsKPiArCQkJbXV0ZXhfdW5sb2NrKCZk
c3QtPm11dGV4KTsKPiArCQl9IGVsc2Ugewo+ICsJCQllcnIgPSAtRUlOVFI7Cj4gKwkJfQo+ICAg
CQlpOTE1X3ZtX3B1dCh2bSk7Cj4gICAJfQo+ICAgCj4gLQlyZXR1cm4gMDsKPiArCXJldHVybiBl
cnI7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQgY3JlYXRlX2Nsb25lKHN0cnVjdCBpOTE1X3Vz
ZXJfZXh0ZW5zaW9uIF9fdXNlciAqZXh0LCB2b2lkICpkYXRhKQo+IEBAIC0xOTU0LDEyICsxOTU2
LDcgQEAgaW50IGk5MTVfZ2VtX2NvbnRleHRfY3JlYXRlX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYsIHZvaWQgKmRhdGEsCj4gICAJCXJldHVybiAtRUlPOwo+ICAgCX0KPiAgIAo+IC0JcmV0
ID0gaTkxNV9tdXRleF9sb2NrX2ludGVycnVwdGlibGUoZGV2KTsKPiAtCWlmIChyZXQpCj4gLQkJ
cmV0dXJuIHJldDsKPiAtCj4gICAJZXh0X2RhdGEuY3R4ID0gaTkxNV9nZW1fY3JlYXRlX2NvbnRl
eHQoaTkxNSwgYXJncy0+ZmxhZ3MpOwo+IC0JbXV0ZXhfdW5sb2NrKCZkZXYtPnN0cnVjdF9tdXRl
eCk7Cj4gICAJaWYgKElTX0VSUihleHRfZGF0YS5jdHgpKQo+ICAgCQlyZXR1cm4gUFRSX0VSUihl
eHRfZGF0YS5jdHgpOwo+ICAgCj4gQEAgLTIwODYsMTAgKzIwODMsMTIgQEAgaW50IGk5MTVfZ2Vt
X2NvbnRleHRfZ2V0cGFyYW1faW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0
YSwKPiAgIAo+ICAgCWNhc2UgSTkxNV9DT05URVhUX1BBUkFNX0dUVF9TSVpFOgo+ICAgCQlhcmdz
LT5zaXplID0gMDsKPiAtCQlpZiAoY3R4LT52bSkKPiAtCQkJYXJncy0+dmFsdWUgPSBjdHgtPnZt
LT50b3RhbDsKPiArCQlyY3VfcmVhZF9sb2NrKCk7Cj4gKwkJaWYgKHJjdV9hY2Nlc3NfcG9pbnRl
cihjdHgtPnZtKSkKPiArCQkJYXJncy0+dmFsdWUgPSByY3VfZGVyZWZlcmVuY2UoY3R4LT52bSkt
PnRvdGFsOwo+ICAgCQllbHNlCj4gICAJCQlhcmdzLT52YWx1ZSA9IHRvX2k5MTUoZGV2KS0+Z2d0
dC52bS50b3RhbDsKPiArCQlyY3VfcmVhZF91bmxvY2soKTsKPiAgIAkJYnJlYWs7Cj4gICAKPiAg
IAljYXNlIEk5MTVfQ09OVEVYVF9QQVJBTV9OT19FUlJPUl9DQVBUVVJFOgo+IEBAIC0yMTU1LDcg
KzIxNTQsNyBAQCBpbnQgaTkxNV9nZW1fY29udGV4dF9zZXRwYXJhbV9pb2N0bChzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ICAgaW50IGk5MTVfZ2VtX2NvbnRleHRfcmVzZXRf
c3RhdHNfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiAgIAkJCQkgICAgICAgdm9pZCAq
ZGF0YSwgc3RydWN0IGRybV9maWxlICpmaWxlKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gICAJc3RydWN0IGRybV9pOTE1X3Jlc2V0X3N0YXRz
ICphcmdzID0gZGF0YTsKPiAgIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4Owo+ICAgCWlu
dCByZXQ7Cj4gQEAgLTIxNzcsNyArMjE3Niw3IEBAIGludCBpOTE1X2dlbV9jb250ZXh0X3Jlc2V0
X3N0YXRzX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gICAJICovCj4gICAKPiAgIAlp
ZiAoY2FwYWJsZShDQVBfU1lTX0FETUlOKSkKPiAtCQlhcmdzLT5yZXNldF9jb3VudCA9IGk5MTVf
cmVzZXRfY291bnQoJmRldl9wcml2LT5ncHVfZXJyb3IpOwo+ICsJCWFyZ3MtPnJlc2V0X2NvdW50
ID0gaTkxNV9yZXNldF9jb3VudCgmaTkxNS0+Z3B1X2Vycm9yKTsKPiAgIAllbHNlCj4gICAJCWFy
Z3MtPnJlc2V0X2NvdW50ID0gMDsKPiAgIAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5
MTVfZ2VtX2NvbnRleHQuaAo+IGluZGV4IDUwYmMyN2QzMGMwMy4uOTIzNDU4NjgzMGQxIDEwMDY0
NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmgKPiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5oCj4gQEAgLTEx
LDcgKzExLDkgQEAKPiAgIAo+ICAgI2luY2x1ZGUgImd0L2ludGVsX2NvbnRleHQuaCIKPiAgIAo+
ICsjaW5jbHVkZSAiaTkxNV9kcnYuaCIKPiAgICNpbmNsdWRlICJpOTE1X2dlbS5oIgo+ICsjaW5j
bHVkZSAiaTkxNV9nZW1fZ3R0LmgiCj4gICAjaW5jbHVkZSAiaTkxNV9zY2hlZHVsZXIuaCIKPiAg
ICNpbmNsdWRlICJpbnRlbF9kZXZpY2VfaW5mby5oIgo+ICAgCj4gQEAgLTExOCw4ICsxMjAsOCBA
QCBzdGF0aWMgaW5saW5lIGJvb2wgaTkxNV9nZW1fY29udGV4dF9pc19rZXJuZWwoc3RydWN0IGk5
MTVfZ2VtX2NvbnRleHQgKmN0eCkKPiAgIH0KPiAgIAo+ICAgLyogaTkxNV9nZW1fY29udGV4dC5j
ICovCj4gLWludCBfX211c3RfY2hlY2sgaTkxNV9nZW1fY29udGV4dHNfaW5pdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+IC12b2lkIGk5MTVfZ2VtX2NvbnRleHRzX2Zpbmko
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiAraW50IF9fbXVzdF9jaGVjayBp
OTE1X2dlbV9pbml0X2NvbnRleHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiAr
dm9pZCBpOTE1X2dlbV9kcml2ZXJfcmVsZWFzZV9fY29udGV4dHMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpOwo+ICAgCj4gICBpbnQgaTkxNV9nZW1fY29udGV4dF9vcGVuKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQkJICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpOwo+
IEBAIC0xNTgsNiArMTYwLDI3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBpOTE1X2dlbV9jb250ZXh0
X3B1dChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQo+ICAgCWtyZWZfcHV0KCZjdHgtPnJl
ZiwgaTkxNV9nZW1fY29udGV4dF9yZWxlYXNlKTsKPiAgIH0KPiAgIAo+ICtzdGF0aWMgaW5saW5l
IHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKgo+ICtpOTE1X2dlbV9jb250ZXh0X3ZtKHN0cnVj
dCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCj4gK3sKPiArCXJldHVybiByY3VfZGVyZWZlcmVuY2Vf
cHJvdGVjdGVkKGN0eC0+dm0sIGxvY2tkZXBfaXNfaGVsZCgmY3R4LT5tdXRleCkpOwo+ICt9Cj4g
Kwo+ICtzdGF0aWMgaW5saW5lIHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKgo+ICtpOTE1X2dl
bV9jb250ZXh0X2dldF92bV9yY3Uoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKPiArewo+
ICsJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm07Cj4gKwo+ICsJcmN1X3JlYWRfbG9jaygp
Owo+ICsJdm0gPSByY3VfZGVyZWZlcmVuY2UoY3R4LT52bSk7Cj4gKwlpZiAoIXZtKQo+ICsJCXZt
ID0gJmN0eC0+aTkxNS0+Z2d0dC52bTsKPiArCXZtID0gaTkxNV92bV9nZXQodm0pOwo+ICsJcmN1
X3JlYWRfdW5sb2NrKCk7Cj4gKwo+ICsJcmV0dXJuIHZtOwo+ICt9Cj4gKwo+ICAgc3RhdGljIGlu
bGluZSBzdHJ1Y3QgaTkxNV9nZW1fZW5naW5lcyAqCj4gICBpOTE1X2dlbV9jb250ZXh0X2VuZ2lu
ZXMoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKPiAgIHsKPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaCBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0X3R5cGVzLmgKPiBpbmRleCA4N2JlMjc4
NzdlMjIuLmFiOGUxMzY3ZGZjOCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fY29udGV4dF90eXBlcy5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaAo+IEBAIC04OCw3ICs4OCw3IEBAIHN0cnVjdCBp
OTE1X2dlbV9jb250ZXh0IHsKPiAgIAkgKiBJbiBvdGhlciBtb2RlcywgdGhpcyBpcyBhIE5VTEwg
cG9pbnRlciB3aXRoIHRoZSBleHBlY3RhdGlvbiB0aGF0Cj4gICAJICogdGhlIGNhbGxlciB1c2Vz
IHRoZSBzaGFyZWQgZ2xvYmFsIEdUVC4KPiAgIAkgKi8KPiAtCXN0cnVjdCBpOTE1X2FkZHJlc3Nf
c3BhY2UgKnZtOwo+ICsJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSBfX3JjdSAqdm07Cj4gICAK
PiAgIAkvKioKPiAgIAkgKiBAcGlkOiBwcm9jZXNzIGlkIG9mIGNyZWF0b3IKPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKPiBpbmRleCA4OGE4ODFi
ZTEyZWMuLjk4ODE2YzM1ZmZjMyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX2V4ZWNidWZmZXIuYwo+IEBAIC03MjgsNyArNzI4LDcgQEAgc3RhdGljIGludCBl
Yl9zZWxlY3RfY29udGV4dChzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYikKPiAgIAkJcmV0dXJu
IC1FTk9FTlQ7Cj4gICAKPiAgIAllYi0+Z2VtX2NvbnRleHQgPSBjdHg7Cj4gLQlpZiAoY3R4LT52
bSkKPiArCWlmIChyY3VfYWNjZXNzX3BvaW50ZXIoY3R4LT52bSkpCj4gICAJCWViLT5pbnZhbGlk
X2ZsYWdzIHw9IEVYRUNfT0JKRUNUX05FRURTX0dUVDsKPiAgIAo+ICAgCWViLT5jb250ZXh0X2Zs
YWdzID0gMDsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X3VzZXJwdHIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV91c2VycHRyLmMK
PiBpbmRleCAxNzM4YTE1ZWI5MTEuLjRmOTcwNDc0MDEzZiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdXNlcnB0ci5jCj4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3VzZXJwdHIuYwo+IEBAIC03NTgsNyArNzU4LDggQEAgaTkx
NV9nZW1fdXNlcnB0cl9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ICAgCQkgKiBPbiBh
bG1vc3QgYWxsIG9mIHRoZSBvbGRlciBodywgd2UgY2Fubm90IHRlbGwgdGhlIEdQVSB0aGF0Cj4g
ICAJCSAqIGEgcGFnZSBpcyByZWFkb25seS4KPiAgIAkJICovCj4gLQkJdm0gPSBkZXZfcHJpdi0+
a2VybmVsX2NvbnRleHQtPnZtOwo+ICsJCXZtID0gcmN1X2RlcmVmZXJlbmNlX3Byb3RlY3RlZChk
ZXZfcHJpdi0+a2VybmVsX2NvbnRleHQtPnZtLAo+ICsJCQkJCSAgICAgICB0cnVlKTsgLyogc3Rh
dGljIHZtICovCj4gICAJCWlmICghdm0gfHwgIXZtLT5oYXNfcmVhZF9vbmx5KQo+ICAgCQkJcmV0
dXJuIC1FTk9ERVY7Cj4gICAJfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vc2VsZnRlc3RzL2h1Z2VfcGFnZXMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxm
dGVzdHMvaHVnZV9wYWdlcy5jCj4gaW5kZXggOThiMmE2Y2NmY2MxLi4zMzE0ODU4ZjMwNDYgMTAw
NjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2Vz
LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2h1Z2VfcGFnZXMu
Ywo+IEBAIC0xMzIyLDE1ICsxMzIyLDE1IEBAIHN0YXRpYyBpbnQgaWd0X3BwZ3R0X3Bpbl91cGRh
dGUodm9pZCAqYXJnKQo+ICAgCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHggPSBhcmc7Cj4g
ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gY3R4LT5pOTE1Owo+ICAgCXVu
c2lnbmVkIGxvbmcgc3VwcG9ydGVkID0gSU5URUxfSU5GTyhkZXZfcHJpdiktPnBhZ2Vfc2l6ZXM7
Cj4gLQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9IGN0eC0+dm07Cj4gICAJc3RydWN0
IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKPiAgIAlzdHJ1Y3QgaTkxNV9nZW1fZW5naW5lc19p
dGVyIGl0Owo+ICsJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm07Cj4gICAJc3RydWN0IGlu
dGVsX2NvbnRleHQgKmNlOwo+ICAgCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwo+ICAgCXVuc2lnbmVk
IGludCBmbGFncyA9IFBJTl9VU0VSIHwgUElOX09GRlNFVF9GSVhFRDsKPiAgIAl1bnNpZ25lZCBp
bnQgbjsKPiAgIAlpbnQgZmlyc3QsIGxhc3Q7Cj4gLQlpbnQgZXJyOwo+ICsJaW50IGVyciA9IDA7
Cj4gICAKPiAgIAkvKgo+ICAgCSAqIE1ha2Ugc3VyZSB0aGVyZSdzIG5vIGZ1bm55IGJ1c2luZXNz
IHdoZW4gZG9pbmcgYSBQSU5fVVBEQVRFIC0tIGluIHRoZQo+IEBAIC0xMzQwLDkgKzEzNDAsMTAg
QEAgc3RhdGljIGludCBpZ3RfcHBndHRfcGluX3VwZGF0ZSh2b2lkICphcmcpCj4gICAJICogaHVn
ZS1ndHQtcGFnZXMuCj4gICAJICovCj4gICAKPiAtCWlmICghdm0gfHwgIWk5MTVfdm1faXNfNGx2
bCh2bSkpIHsKPiArCXZtID0gaTkxNV9nZW1fY29udGV4dF9nZXRfdm1fcmN1KGN0eCk7Cj4gKwlp
ZiAoIWk5MTVfdm1faXNfNGx2bCh2bSkpIHsKPiAgIAkJcHJfaW5mbygiNDhiIFBQR1RUIG5vdCBz
dXBwb3J0ZWQsIHNraXBwaW5nXG4iKTsKPiAtCQlyZXR1cm4gMDsKPiArCQlnb3RvIG91dF92bTsK
PiAgIAl9Cj4gICAKPiAgIAlmaXJzdCA9IGlsb2cyKEk5MTVfR1RUX1BBR0VfU0laRV82NEspOwo+
IEBAIC0xNDUxLDYgKzE0NTIsOCBAQCBzdGF0aWMgaW50IGlndF9wcGd0dF9waW5fdXBkYXRlKHZv
aWQgKmFyZykKPiAgIAlpOTE1X3ZtYV9jbG9zZSh2bWEpOwo+ICAgb3V0X3B1dDoKPiAgIAlpOTE1
X2dlbV9vYmplY3RfcHV0KG9iaik7Cj4gK291dF92bToKPiArCWk5MTVfdm1fcHV0KHZtKTsKPiAg
IAo+ICAgCXJldHVybiBlcnI7Cj4gICB9Cj4gQEAgLTE0NjAsNyArMTQ2Myw3IEBAIHN0YXRpYyBp
bnQgaWd0X3RtcGZzX2ZhbGxiYWNrKHZvaWQgKmFyZykKPiAgIAlzdHJ1Y3QgaTkxNV9nZW1fY29u
dGV4dCAqY3R4ID0gYXJnOwo+ICAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gY3R4
LT5pOTE1Owo+ICAgCXN0cnVjdCB2ZnNtb3VudCAqZ2VtZnMgPSBpOTE1LT5tbS5nZW1mczsKPiAt
CXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0gY3R4LT52bSA/OiAmaTkxNS0+Z2d0dC52
bTsKPiArCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0gaTkxNV9nZW1fY29udGV4dF9n
ZXRfdm1fcmN1KGN0eCk7Cj4gICAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKPiAg
IAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKPiAgIAl1MzIgKnZhZGRyOwo+IEBAIC0xNTEwLDYgKzE1
MTMsNyBAQCBzdGF0aWMgaW50IGlndF90bXBmc19mYWxsYmFjayh2b2lkICphcmcpCj4gICBvdXRf
cmVzdG9yZToKPiAgIAlpOTE1LT5tbS5nZW1mcyA9IGdlbWZzOwo+ICAgCj4gKwlpOTE1X3ZtX3B1
dCh2bSk7Cj4gICAJcmV0dXJuIGVycjsKPiAgIH0KPiAgIAo+IEBAIC0xNTE3LDE0ICsxNTIxLDE0
IEBAIHN0YXRpYyBpbnQgaWd0X3Nocmlua190aHAodm9pZCAqYXJnKQo+ICAgewo+ICAgCXN0cnVj
dCBpOTE1X2dlbV9jb250ZXh0ICpjdHggPSBhcmc7Cj4gICAJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSBjdHgtPmk5MTU7Cj4gLQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9
IGN0eC0+dm0gPzogJmk5MTUtPmdndHQudm07Cj4gKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNl
ICp2bSA9IGk5MTVfZ2VtX2NvbnRleHRfZ2V0X3ZtX3JjdShjdHgpOwo+ICAgCXN0cnVjdCBkcm1f
aTkxNV9nZW1fb2JqZWN0ICpvYmo7Cj4gICAJc3RydWN0IGk5MTVfZ2VtX2VuZ2luZXNfaXRlciBp
dDsKPiAgIAlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7Cj4gICAJc3RydWN0IGk5MTVfdm1hICp2
bWE7Cj4gICAJdW5zaWduZWQgaW50IGZsYWdzID0gUElOX1VTRVI7Cj4gICAJdW5zaWduZWQgaW50
IG47Cj4gLQlpbnQgZXJyOwo+ICsJaW50IGVyciA9IDA7Cj4gICAKPiAgIAkvKgo+ICAgCSAqIFNh
bml0eSBjaGVjayBzaHJpbmtpbmcgaHVnZS1wYWdlZCBvYmplY3QgLS0gbWFrZSBzdXJlIG5vdGhp
bmcgYmxvd3MKPiBAQCAtMTUzMywxMiArMTUzNywxNCBAQCBzdGF0aWMgaW50IGlndF9zaHJpbmtf
dGhwKHZvaWQgKmFyZykKPiAgIAo+ICAgCWlmICghaWd0X2Nhbl9hbGxvY2F0ZV90aHAoaTkxNSkp
IHsKPiAgIAkJcHJfaW5mbygibWlzc2luZyBUSFAgc3VwcG9ydCwgc2tpcHBpbmdcbiIpOwo+IC0J
CXJldHVybiAwOwo+ICsJCWdvdG8gb3V0X3ZtOwo+ICAgCX0KPiAgIAo+ICAgCW9iaiA9IGk5MTVf
Z2VtX29iamVjdF9jcmVhdGVfc2htZW0oaTkxNSwgU1pfMk0pOwo+IC0JaWYgKElTX0VSUihvYmop
KQo+IC0JCXJldHVybiBQVFJfRVJSKG9iaik7Cj4gKwlpZiAoSVNfRVJSKG9iaikpIHsKPiArCQll
cnIgPSBQVFJfRVJSKG9iaik7Cj4gKwkJZ290byBvdXRfdm07Cj4gKwl9Cj4gICAKPiAgIAl2bWEg
PSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosIHZtLCBOVUxMKTsKPiAgIAlpZiAoSVNfRVJSKHZtYSkp
IHsKPiBAQCAtMTYwNyw2ICsxNjEzLDggQEAgc3RhdGljIGludCBpZ3Rfc2hyaW5rX3RocCh2b2lk
ICphcmcpCj4gICAJaTkxNV92bWFfY2xvc2Uodm1hKTsKPiAgIG91dF9wdXQ6Cj4gICAJaTkxNV9n
ZW1fb2JqZWN0X3B1dChvYmopOwo+ICtvdXRfdm06Cj4gKwlpOTE1X3ZtX3B1dCh2bSk7Cj4gICAK
PiAgIAlyZXR1cm4gZXJyOwo+ICAgfQo+IEBAIC0xNjc1LDYgKzE2ODMsNyBAQCBpbnQgaTkxNV9n
ZW1faHVnZV9wYWdlX2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ICAgCX07Cj4gICAJc3RydWN0IGRybV9maWxlICpmaWxlOwo+ICAgCXN0cnVjdCBpOTE1X2dl
bV9jb250ZXh0ICpjdHg7Cj4gKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsKPiAgIAlp
bnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiAgIAlpbnQgZXJyOwo+ICAgCj4gQEAgLTE2OTksOCAr
MTcwOCwxMSBAQCBpbnQgaTkxNV9nZW1faHVnZV9wYWdlX2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgCQlnb3RvIG91dF91bmxvY2s7Cj4gICAJfQo+ICAg
Cj4gLQlpZiAoY3R4LT52bSkKPiAtCQljdHgtPnZtLT5zY3J1Yl82NEsgPSB0cnVlOwo+ICsJbXV0
ZXhfbG9jaygmY3R4LT5tdXRleCk7Cj4gKwl2bSA9IGk5MTVfZ2VtX2NvbnRleHRfdm0oY3R4KTsK
PiArCWlmICh2bSkKPiArCQlXUklURV9PTkNFKHZtLT5zY3J1Yl82NEssIHRydWUpOwo+ICsJbXV0
ZXhfdW5sb2NrKCZjdHgtPm11dGV4KTsKPiAgIAo+ICAgCWVyciA9IGk5MTVfc3VidGVzdHModGVz
dHMsIGN0eCk7Cj4gICAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3Nl
bGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2Vs
ZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQuYwo+IGluZGV4IDJmYjMxYWRhMmZhNy4uZDQ0ZmE5ZDM1
NmYxIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkx
NV9nZW1fY29udGV4dC5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0
cy9pOTE1X2dlbV9jb250ZXh0LmMKPiBAQCAtNTMsMTkgKzUzLDE3IEBAIHN0YXRpYyBpbnQgbGl2
ZV9ub3Bfc3dpdGNoKHZvaWQgKmFyZykKPiAgIAlpZiAoSVNfRVJSKGZpbGUpKQo+ICAgCQlyZXR1
cm4gUFRSX0VSUihmaWxlKTsKPiAgIAo+IC0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9t
dXRleCk7Cj4gLQo+ICAgCWN0eCA9IGtjYWxsb2MobmN0eCwgc2l6ZW9mKCpjdHgpLCBHRlBfS0VS
TkVMKTsKPiAgIAlpZiAoIWN0eCkgewo+ICAgCQllcnIgPSAtRU5PTUVNOwo+IC0JCWdvdG8gb3V0
X3VubG9jazsKPiArCQlnb3RvIG91dF9maWxlOwo+ICAgCX0KPiAgIAo+ICAgCWZvciAobiA9IDA7
IG4gPCBuY3R4OyBuKyspIHsKPiAgIAkJY3R4W25dID0gbGl2ZV9jb250ZXh0KGk5MTUsIGZpbGUp
Owo+ICAgCQlpZiAoSVNfRVJSKGN0eFtuXSkpIHsKPiAgIAkJCWVyciA9IFBUUl9FUlIoY3R4W25d
KTsKPiAtCQkJZ290byBvdXRfdW5sb2NrOwo+ICsJCQlnb3RvIG91dF9maWxlOwo+ICAgCQl9Cj4g
ICAJfQo+ICAgCj4gQEAgLTc5LDcgKzc3LDcgQEAgc3RhdGljIGludCBsaXZlX25vcF9zd2l0Y2go
dm9pZCAqYXJnKQo+ICAgCQkJcnEgPSBpZ3RfcmVxdWVzdF9hbGxvYyhjdHhbbl0sIGVuZ2luZSk7
Cj4gICAJCQlpZiAoSVNfRVJSKHJxKSkgewo+ICAgCQkJCWVyciA9IFBUUl9FUlIocnEpOwo+IC0J
CQkJZ290byBvdXRfdW5sb2NrOwo+ICsJCQkJZ290byBvdXRfZmlsZTsKPiAgIAkJCX0KPiAgIAkJ
CWk5MTVfcmVxdWVzdF9hZGQocnEpOwo+ICAgCQl9Cj4gQEAgLTg3LDcgKzg1LDcgQEAgc3RhdGlj
IGludCBsaXZlX25vcF9zd2l0Y2godm9pZCAqYXJnKQo+ICAgCQkJcHJfZXJyKCJGYWlsZWQgdG8g
cG9wdWxhdGVkICVkIGNvbnRleHRzXG4iLCBuY3R4KTsKPiAgIAkJCWludGVsX2d0X3NldF93ZWRn
ZWQoJmk5MTUtPmd0KTsKPiAgIAkJCWVyciA9IC1FSU87Cj4gLQkJCWdvdG8gb3V0X3VubG9jazsK
PiArCQkJZ290byBvdXRfZmlsZTsKPiAgIAkJfQo+ICAgCj4gICAJCXRpbWVzWzFdID0ga3RpbWVf
Z2V0X3JhdygpOwo+IEBAIC05Nyw3ICs5NSw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9ub3Bfc3dpdGNo
KHZvaWQgKmFyZykKPiAgIAo+ICAgCQllcnIgPSBpZ3RfbGl2ZV90ZXN0X2JlZ2luKCZ0LCBpOTE1
LCBfX2Z1bmNfXywgZW5naW5lLT5uYW1lKTsKPiAgIAkJaWYgKGVycikKPiAtCQkJZ290byBvdXRf
dW5sb2NrOwo+ICsJCQlnb3RvIG91dF9maWxlOwo+ICAgCj4gICAJCWVuZF90aW1lID0gamlmZmll
cyArIGk5MTVfc2VsZnRlc3QudGltZW91dF9qaWZmaWVzOwo+ICAgCQlmb3JfZWFjaF9wcmltZV9u
dW1iZXJfZnJvbShwcmltZSwgMiwgODE5Mikgewo+IEBAIC0xMDcsNyArMTA1LDcgQEAgc3RhdGlj
IGludCBsaXZlX25vcF9zd2l0Y2godm9pZCAqYXJnKQo+ICAgCQkJCXJxID0gaWd0X3JlcXVlc3Rf
YWxsb2MoY3R4W24gJSBuY3R4XSwgZW5naW5lKTsKPiAgIAkJCQlpZiAoSVNfRVJSKHJxKSkgewo+
ICAgCQkJCQllcnIgPSBQVFJfRVJSKHJxKTsKPiAtCQkJCQlnb3RvIG91dF91bmxvY2s7Cj4gKwkJ
CQkJZ290byBvdXRfZmlsZTsKPiAgIAkJCQl9Cj4gICAKPiAgIAkJCQkvKgo+IEBAIC0xNDMsNyAr
MTQxLDcgQEAgc3RhdGljIGludCBsaXZlX25vcF9zd2l0Y2godm9pZCAqYXJnKQo+ICAgCj4gICAJ
CWVyciA9IGlndF9saXZlX3Rlc3RfZW5kKCZ0KTsKPiAgIAkJaWYgKGVycikKPiAtCQkJZ290byBv
dXRfdW5sb2NrOwo+ICsJCQlnb3RvIG91dF9maWxlOwo+ICAgCj4gICAJCXByX2luZm8oIlN3aXRj
aCBsYXRlbmNpZXMgb24gJXM6IDEgPSAlbGx1bnMsICVsdSA9ICVsbHVuc1xuIiwKPiAgIAkJCWVu
Z2luZS0+bmFtZSwKPiBAQCAtMTUxLDggKzE0OSw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9ub3Bfc3dp
dGNoKHZvaWQgKmFyZykKPiAgIAkJCXByaW1lIC0gMSwgZGl2NjRfdTY0KGt0aW1lX3RvX25zKHRp
bWVzWzFdKSwgcHJpbWUgLSAxKSk7Cj4gICAJfQo+ICAgCj4gLW91dF91bmxvY2s6Cj4gLQltdXRl
eF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICtvdXRfZmlsZToKPiAgIAltb2Nr
X2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKPiAgIAlyZXR1cm4gZXJyOwo+ICAgfQo+IEBAIC0yNTMs
MTIgKzI1MCwxMCBAQCBzdGF0aWMgaW50IGxpdmVfcGFyYWxsZWxfc3dpdGNoKHZvaWQgKmFyZykK
PiAgIAlpZiAoSVNfRVJSKGZpbGUpKQo+ICAgCQlyZXR1cm4gUFRSX0VSUihmaWxlKTsKPiAgIAo+
IC0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gLQo+ICAgCWN0eCA9IGxp
dmVfY29udGV4dChpOTE1LCBmaWxlKTsKPiAgIAlpZiAoSVNfRVJSKGN0eCkpIHsKPiAgIAkJZXJy
ID0gUFRSX0VSUihjdHgpOwo+IC0JCWdvdG8gb3V0X2xvY2tlZDsKPiArCQlnb3RvIG91dF9maWxl
Owo+ICAgCX0KPiAgIAo+ICAgCWVuZ2luZXMgPSBpOTE1X2dlbV9jb250ZXh0X2xvY2tfZW5naW5l
cyhjdHgpOwo+IEBAIC0yNjgsNyArMjYzLDcgQEAgc3RhdGljIGludCBsaXZlX3BhcmFsbGVsX3N3
aXRjaCh2b2lkICphcmcpCj4gICAJaWYgKCFkYXRhKSB7Cj4gICAJCWk5MTVfZ2VtX2NvbnRleHRf
dW5sb2NrX2VuZ2luZXMoY3R4KTsKPiAgIAkJZXJyID0gLUVOT01FTTsKPiAtCQlnb3RvIG91dF9s
b2NrZWQ7Cj4gKwkJZ290byBvdXQ7Cj4gICAJfQo+ICAgCj4gICAJbSA9IDA7IC8qIFVzZSB0aGUg
Zmlyc3QgY29udGV4dCBhcyBvdXIgdGVtcGxhdGUgZm9yIHRoZSBlbmdpbmVzICovCj4gQEAgLTI3
Niw3ICsyNzEsNyBAQCBzdGF0aWMgaW50IGxpdmVfcGFyYWxsZWxfc3dpdGNoKHZvaWQgKmFyZykK
PiAgIAkJZXJyID0gaW50ZWxfY29udGV4dF9waW4oY2UpOwo+ICAgCQlpZiAoZXJyKSB7Cj4gICAJ
CQlpOTE1X2dlbV9jb250ZXh0X3VubG9ja19lbmdpbmVzKGN0eCk7Cj4gLQkJCWdvdG8gb3V0X2xv
Y2tlZDsKPiArCQkJZ290byBvdXQ7Cj4gICAJCX0KPiAgIAkJZGF0YVttKytdLmNlWzBdID0gaW50
ZWxfY29udGV4dF9nZXQoY2UpOwo+ICAgCX0KPiBAQCAtMjg3LDcgKzI4Miw3IEBAIHN0YXRpYyBp
bnQgbGl2ZV9wYXJhbGxlbF9zd2l0Y2godm9pZCAqYXJnKQo+ICAgCQljdHggPSBsaXZlX2NvbnRl
eHQoaTkxNSwgZmlsZSk7Cj4gICAJCWlmIChJU19FUlIoY3R4KSkgewo+ICAgCQkJZXJyID0gUFRS
X0VSUihjdHgpOwo+IC0JCQlnb3RvIG91dF9sb2NrZWQ7Cj4gKwkJCWdvdG8gb3V0Owo+ICAgCQl9
Cj4gICAKPiAgIAkJZm9yIChtID0gMDsgbSA8IGNvdW50OyBtKyspIHsKPiBAQCAtMjk2LDIwICsy
OTEsMTggQEAgc3RhdGljIGludCBsaXZlX3BhcmFsbGVsX3N3aXRjaCh2b2lkICphcmcpCj4gICAK
PiAgIAkJCWNlID0gaW50ZWxfY29udGV4dF9jcmVhdGUoY3R4LCBkYXRhW21dLmNlWzBdLT5lbmdp
bmUpOwo+ICAgCQkJaWYgKElTX0VSUihjZSkpCj4gLQkJCQlnb3RvIG91dF9sb2NrZWQ7Cj4gKwkJ
CQlnb3RvIG91dDsKPiAgIAo+ICAgCQkJZXJyID0gaW50ZWxfY29udGV4dF9waW4oY2UpOwo+ICAg
CQkJaWYgKGVycikgewo+ICAgCQkJCWludGVsX2NvbnRleHRfcHV0KGNlKTsKPiAtCQkJCWdvdG8g
b3V0X2xvY2tlZDsKPiArCQkJCWdvdG8gb3V0Owo+ICAgCQkJfQo+ICAgCj4gICAJCQlkYXRhW21d
LmNlW25dID0gY2U7Cj4gICAJCX0KPiAgIAl9Cj4gICAKPiAtCW11dGV4X3VubG9jaygmaTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7Cj4gLQo+ICAgCWZvciAoZm4gPSBmdW5jOyAhZXJyICYmICpmbjsg
Zm4rKykgewo+ICAgCQlzdHJ1Y3QgaWd0X2xpdmVfdGVzdCB0Owo+ICAgCQlpbnQgbjsKPiBAQCAt
MzU0LDggKzM0Nyw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9wYXJhbGxlbF9zd2l0Y2godm9pZCAqYXJn
KQo+ICAgCQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCX0KPiAg
IAo+IC0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gLW91dF9sb2NrZWQ6
Cj4gK291dDoKPiAgIAlmb3IgKG4gPSAwOyBuIDwgY291bnQ7IG4rKykgewo+ICAgCQlmb3IgKG0g
PSAwOyBtIDwgQVJSQVlfU0laRShkYXRhLT5jZSk7IG0rKykgewo+ICAgCQkJaWYgKCFkYXRhW25d
LmNlW21dKQo+IEBAIC0zNjUsOCArMzU3LDggQEAgc3RhdGljIGludCBsaXZlX3BhcmFsbGVsX3N3
aXRjaCh2b2lkICphcmcpCj4gICAJCQlpbnRlbF9jb250ZXh0X3B1dChkYXRhW25dLmNlW21dKTsK
PiAgIAkJfQo+ICAgCX0KPiAtCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7
Cj4gICAJa2ZyZWUoZGF0YSk7Cj4gK291dF9maWxlOgo+ICAgCW1vY2tfZmlsZV9mcmVlKGk5MTUs
IGZpbGUpOwo+ICAgCXJldHVybiBlcnI7Cj4gICB9Cj4gQEAgLTYyNiwxMSArNjE4LDkgQEAgc3Rh
dGljIGludCBpZ3RfY3R4X2V4ZWModm9pZCAqYXJnKQo+ICAgCQlpZiAoSVNfRVJSKGZpbGUpKQo+
ICAgCQkJcmV0dXJuIFBUUl9FUlIoZmlsZSk7Cj4gICAKPiAtCQltdXRleF9sb2NrKCZpOTE1LT5k
cm0uc3RydWN0X211dGV4KTsKPiAtCj4gICAJCWVyciA9IGlndF9saXZlX3Rlc3RfYmVnaW4oJnQs
IGk5MTUsIF9fZnVuY19fLCBlbmdpbmUtPm5hbWUpOwo+ICAgCQlpZiAoZXJyKQo+IC0JCQlnb3Rv
IG91dF91bmxvY2s7Cj4gKwkJCWdvdG8gb3V0X2ZpbGU7Cj4gICAKPiAgIAkJbmNvbnRleHRzID0g
MDsKPiAgIAkJbmR3b3JkcyA9IDA7Cj4gQEAgLTY0Miw3ICs2MzIsNyBAQCBzdGF0aWMgaW50IGln
dF9jdHhfZXhlYyh2b2lkICphcmcpCj4gICAJCQljdHggPSBrZXJuZWxfY29udGV4dChpOTE1KTsK
PiAgIAkJCWlmIChJU19FUlIoY3R4KSkgewo+ICAgCQkJCWVyciA9IFBUUl9FUlIoY3R4KTsKPiAt
CQkJCWdvdG8gb3V0X3VubG9jazsKPiArCQkJCWdvdG8gb3V0X2ZpbGU7Cj4gICAJCQl9Cj4gICAK
PiAgIAkJCWNlID0gaTkxNV9nZW1fY29udGV4dF9nZXRfZW5naW5lKGN0eCwgZW5naW5lLT5sZWdh
Y3lfaWR4KTsKPiBAQCAtNjU0LDcgKzY0NCw3IEBAIHN0YXRpYyBpbnQgaWd0X2N0eF9leGVjKHZv
aWQgKmFyZykKPiAgIAkJCQkJZXJyID0gUFRSX0VSUihvYmopOwo+ICAgCQkJCQlpbnRlbF9jb250
ZXh0X3B1dChjZSk7Cj4gICAJCQkJCWtlcm5lbF9jb250ZXh0X2Nsb3NlKGN0eCk7Cj4gLQkJCQkJ
Z290byBvdXRfdW5sb2NrOwo+ICsJCQkJCWdvdG8gb3V0X2ZpbGU7Cj4gICAJCQkJfQo+ICAgCQkJ
fQo+ICAgCj4gQEAgLTY2MywxNyArNjUzLDE4IEBAIHN0YXRpYyBpbnQgaWd0X2N0eF9leGVjKHZv
aWQgKmFyZykKPiAgIAkJCQlwcl9lcnIoIkZhaWxlZCB0byBmaWxsIGR3b3JkICVsdSBbJWx1LyVs
dV0gd2l0aCBncHUgKCVzKSBbZnVsbC1wcGd0dD8gJXNdLCBlcnI9JWRcbiIsCj4gICAJCQkJICAg
ICAgIG5kd29yZHMsIGR3LCBtYXhfZHdvcmRzKG9iaiksCj4gICAJCQkJICAgICAgIGVuZ2luZS0+
bmFtZSwKPiAtCQkJCSAgICAgICB5ZXNubyghIWN0eC0+dm0pLCBlcnIpOwo+ICsJCQkJICAgICAg
IHllc25vKCEhcmN1X2FjY2Vzc19wb2ludGVyKGN0eC0+dm0pKSwKPiArCQkJCSAgICAgICBlcnIp
Owo+ICAgCQkJCWludGVsX2NvbnRleHRfcHV0KGNlKTsKPiAgIAkJCQlrZXJuZWxfY29udGV4dF9j
bG9zZShjdHgpOwo+IC0JCQkJZ290byBvdXRfdW5sb2NrOwo+ICsJCQkJZ290byBvdXRfZmlsZTsK
PiAgIAkJCX0KPiAgIAo+ICAgCQkJZXJyID0gdGhyb3R0bGUoY2UsIHRxLCBBUlJBWV9TSVpFKHRx
KSk7Cj4gICAJCQlpZiAoZXJyKSB7Cj4gICAJCQkJaW50ZWxfY29udGV4dF9wdXQoY2UpOwo+ICAg
CQkJCWtlcm5lbF9jb250ZXh0X2Nsb3NlKGN0eCk7Cj4gLQkJCQlnb3RvIG91dF91bmxvY2s7Cj4g
KwkJCQlnb3RvIG91dF9maWxlOwo+ICAgCQkJfQo+ICAgCj4gICAJCQlpZiAoKytkdyA9PSBtYXhf
ZHdvcmRzKG9iaikpIHsKPiBAQCAtNzAzLDExICs2OTQsMTAgQEAgc3RhdGljIGludCBpZ3RfY3R4
X2V4ZWModm9pZCAqYXJnKQo+ICAgCQkJZHcgKz0gcmVtOwo+ICAgCQl9Cj4gICAKPiAtb3V0X3Vu
bG9jazoKPiArb3V0X2ZpbGU6Cj4gICAJCXRocm90dGxlX3JlbGVhc2UodHEsIEFSUkFZX1NJWkUo
dHEpKTsKPiAgIAkJaWYgKGlndF9saXZlX3Rlc3RfZW5kKCZ0KSkKPiAgIAkJCWVyciA9IC1FSU87
Cj4gLQkJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAo+ICAgCQlt
b2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKPiAgIAkJaWYgKGVycikKPiBAQCAtNzQyLDIyICs3
MzIsMjAgQEAgc3RhdGljIGludCBpZ3Rfc2hhcmVkX2N0eF9leGVjKHZvaWQgKmFyZykKPiAgIAlp
ZiAoSVNfRVJSKGZpbGUpKQo+ICAgCQlyZXR1cm4gUFRSX0VSUihmaWxlKTsKPiAgIAo+IC0JbXV0
ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gLQo+ICAgCXBhcmVudCA9IGxpdmVf
Y29udGV4dChpOTE1LCBmaWxlKTsKPiAgIAlpZiAoSVNfRVJSKHBhcmVudCkpIHsKPiAgIAkJZXJy
ID0gUFRSX0VSUihwYXJlbnQpOwo+IC0JCWdvdG8gb3V0X3VubG9jazsKPiArCQlnb3RvIG91dF9m
aWxlOwo+ICAgCX0KPiAgIAo+ICAgCWlmICghcGFyZW50LT52bSkgeyAvKiBub3QgZnVsbC1wcGd0
dDsgbm90aGluZyB0byBzaGFyZSAqLwo+ICAgCQllcnIgPSAwOwo+IC0JCWdvdG8gb3V0X3VubG9j
azsKPiArCQlnb3RvIG91dF9maWxlOwo+ICAgCX0KPiAgIAo+ICAgCWVyciA9IGlndF9saXZlX3Rl
c3RfYmVnaW4oJnQsIGk5MTUsIF9fZnVuY19fLCAiIik7Cj4gICAJaWYgKGVycikKPiAtCQlnb3Rv
IG91dF91bmxvY2s7Cj4gKwkJZ290byBvdXRfZmlsZTsKPiAgIAo+ICAgCWZvcl9lYWNoX2VuZ2lu
ZShlbmdpbmUsIGk5MTUsIGlkKSB7Cj4gICAJCXVuc2lnbmVkIGxvbmcgbmNvbnRleHRzLCBuZHdv
cmRzLCBkdzsKPiBAQCAtNzgxLDcgKzc2OSw5IEBAIHN0YXRpYyBpbnQgaWd0X3NoYXJlZF9jdHhf
ZXhlYyh2b2lkICphcmcpCj4gICAJCQkJZ290byBvdXRfdGVzdDsKPiAgIAkJCX0KPiAgIAo+ICsJ
CQltdXRleF9sb2NrKCZjdHgtPm11dGV4KTsKPiAgIAkJCV9fYXNzaWduX3BwZ3R0KGN0eCwgcGFy
ZW50LT52bSk7Cj4gKwkJCW11dGV4X3VubG9jaygmY3R4LT5tdXRleCk7Cj4gICAKPiAgIAkJCWNl
ID0gaTkxNV9nZW1fY29udGV4dF9nZXRfZW5naW5lKGN0eCwgZW5naW5lLT5sZWdhY3lfaWR4KTsK
PiAgIAkJCUdFTV9CVUdfT04oSVNfRVJSKGNlKSk7Cj4gQEAgLTgwMSw3ICs3OTEsOCBAQCBzdGF0
aWMgaW50IGlndF9zaGFyZWRfY3R4X2V4ZWModm9pZCAqYXJnKQo+ICAgCQkJCXByX2VycigiRmFp
bGVkIHRvIGZpbGwgZHdvcmQgJWx1IFslbHUvJWx1XSB3aXRoIGdwdSAoJXMpIFtmdWxsLXBwZ3R0
PyAlc10sIGVycj0lZFxuIiwKPiAgIAkJCQkgICAgICAgbmR3b3JkcywgZHcsIG1heF9kd29yZHMo
b2JqKSwKPiAgIAkJCQkgICAgICAgZW5naW5lLT5uYW1lLAo+IC0JCQkJICAgICAgIHllc25vKCEh
Y3R4LT52bSksIGVycik7Cj4gKwkJCQkgICAgICAgeWVzbm8oISFyY3VfYWNjZXNzX3BvaW50ZXIo
Y3R4LT52bSkpLAo+ICsJCQkJICAgICAgIGVycik7Cj4gICAJCQkJaW50ZWxfY29udGV4dF9wdXQo
Y2UpOwo+ICAgCQkJCWtlcm5lbF9jb250ZXh0X2Nsb3NlKGN0eCk7Cj4gICAJCQkJZ290byBvdXRf
dGVzdDsKPiBAQCAtODQwLDE3ICs4MzEsMTMgQEAgc3RhdGljIGludCBpZ3Rfc2hhcmVkX2N0eF9l
eGVjKHZvaWQgKmFyZykKPiAgIAkJCWR3ICs9IHJlbTsKPiAgIAkJfQo+ICAgCj4gLQkJbXV0ZXhf
dW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAkJaTkxNV9nZW1fZHJhaW5fZnJl
ZWRfb2JqZWN0cyhpOTE1KTsKPiAtCQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4
KTsKPiAgIAl9Cj4gICBvdXRfdGVzdDoKPiAgIAl0aHJvdHRsZV9yZWxlYXNlKHRxLCBBUlJBWV9T
SVpFKHRxKSk7Cj4gICAJaWYgKGlndF9saXZlX3Rlc3RfZW5kKCZ0KSkKPiAgIAkJZXJyID0gLUVJ
TzsKPiAtb3V0X3VubG9jazoKPiAtCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRl
eCk7Cj4gLQo+ICtvdXRfZmlsZToKPiAgIAltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKPiAg
IAlyZXR1cm4gZXJyOwo+ICAgfQo+IEBAIC0xMjIyLDggKzEyMDksNiBAQCBfX2lndF9jdHhfc3Nl
dShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAlpZiAoZmxhZ3MgJiBURVNUX1JF
U0VUKQo+ICAgCQlpZ3RfZ2xvYmFsX3Jlc2V0X2xvY2soJmk5MTUtPmd0KTsKPiAgIAo+IC0JbXV0
ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gLQo+ICAgCWN0eCA9IGxpdmVfY29u
dGV4dChpOTE1LCBmaWxlKTsKPiAgIAlpZiAoSVNfRVJSKGN0eCkpIHsKPiAgIAkJcmV0ID0gUFRS
X0VSUihjdHgpOwo+IEBAIC0xMjc4LDggKzEyNjMsNiBAQCBfX2lndF9jdHhfc3NldShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7Cj4g
ICAKPiAgIG91dF91bmxvY2s6Cj4gLQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwo+IC0KPiAgIAlpZiAoZmxhZ3MgJiBURVNUX1JFU0VUKQo+ICAgCQlpZ3RfZ2xvYmFsX3Jl
c2V0X3VubG9jaygmaTkxNS0+Z3QpOwo+ICAgCj4gQEAgLTEzMzksMjMgKzEzMjIsMjQgQEAgc3Rh
dGljIGludCBpZ3RfY3R4X3JlYWRvbmx5KHZvaWQgKmFyZykKPiAgIAlpZiAoSVNfRVJSKGZpbGUp
KQo+ICAgCQlyZXR1cm4gUFRSX0VSUihmaWxlKTsKPiAgIAo+IC0JbXV0ZXhfbG9jaygmaTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7Cj4gLQo+ICAgCWVyciA9IGlndF9saXZlX3Rlc3RfYmVnaW4oJnQs
IGk5MTUsIF9fZnVuY19fLCAiIik7Cj4gICAJaWYgKGVycikKPiAtCQlnb3RvIG91dF91bmxvY2s7
Cj4gKwkJZ290byBvdXRfZmlsZTsKPiAgIAo+ICAgCWN0eCA9IGxpdmVfY29udGV4dChpOTE1LCBm
aWxlKTsKPiAgIAlpZiAoSVNfRVJSKGN0eCkpIHsKPiAgIAkJZXJyID0gUFRSX0VSUihjdHgpOwo+
IC0JCWdvdG8gb3V0X3VubG9jazsKPiArCQlnb3RvIG91dF9maWxlOwo+ICAgCX0KPiAgIAo+IC0J
dm0gPSBjdHgtPnZtID86ICZpOTE1LT5nZ3R0LmFsaWFzLT52bTsKPiArCXJjdV9yZWFkX2xvY2so
KTsKPiArCXZtID0gcmN1X2RlcmVmZXJlbmNlKGN0eC0+dm0pID86ICZpOTE1LT5nZ3R0LmFsaWFz
LT52bTsKPiAgIAlpZiAoIXZtIHx8ICF2bS0+aGFzX3JlYWRfb25seSkgewo+ICsJCXJjdV9yZWFk
X3VubG9jaygpOwo+ICAgCQllcnIgPSAwOwo+IC0JCWdvdG8gb3V0X3VubG9jazsKPiArCQlnb3Rv
IG91dF9maWxlOwo+ICAgCX0KPiArCXJjdV9yZWFkX3VubG9jaygpOwo+ICAgCj4gICAJbmR3b3Jk
cyA9IDA7Cj4gICAJZHcgPSAwOwo+IEBAIC0xMzczLDcgKzEzNTcsNyBAQCBzdGF0aWMgaW50IGln
dF9jdHhfcmVhZG9ubHkodm9pZCAqYXJnKQo+ICAgCQkJCWlmIChJU19FUlIob2JqKSkgewo+ICAg
CQkJCQllcnIgPSBQVFJfRVJSKG9iaik7Cj4gICAJCQkJCWk5MTVfZ2VtX2NvbnRleHRfdW5sb2Nr
X2VuZ2luZXMoY3R4KTsKPiAtCQkJCQlnb3RvIG91dF91bmxvY2s7Cj4gKwkJCQkJZ290byBvdXRf
ZmlsZTsKPiAgIAkJCQl9Cj4gICAKPiAgIAkJCQlpZiAocHJhbmRvbV91MzJfc3RhdGUoJnBybmcp
ICYgMSkKPiBAQCAtMTM4NCwxNSArMTM2OCwxNyBAQCBzdGF0aWMgaW50IGlndF9jdHhfcmVhZG9u
bHkodm9pZCAqYXJnKQo+ICAgCQkJaWYgKGVycikgewo+ICAgCQkJCXByX2VycigiRmFpbGVkIHRv
IGZpbGwgZHdvcmQgJWx1IFslbHUvJWx1XSB3aXRoIGdwdSAoJXMpIFtmdWxsLXBwZ3R0PyAlc10s
IGVycj0lZFxuIiwKPiAgIAkJCQkgICAgICAgbmR3b3JkcywgZHcsIG1heF9kd29yZHMob2JqKSwK
PiAtCQkJCSAgICAgICBjZS0+ZW5naW5lLT5uYW1lLCB5ZXNubyghIWN0eC0+dm0pLCBlcnIpOwo+
ICsJCQkJICAgICAgIGNlLT5lbmdpbmUtPm5hbWUsCj4gKwkJCQkgICAgICAgeWVzbm8oISFyY3Vf
YWNjZXNzX3BvaW50ZXIoY3R4LT52bSkpLAo+ICsJCQkJICAgICAgIGVycik7Cj4gICAJCQkJaTkx
NV9nZW1fY29udGV4dF91bmxvY2tfZW5naW5lcyhjdHgpOwo+IC0JCQkJZ290byBvdXRfdW5sb2Nr
Owo+ICsJCQkJZ290byBvdXRfZmlsZTsKPiAgIAkJCX0KPiAgIAo+ICAgCQkJZXJyID0gdGhyb3R0
bGUoY2UsIHRxLCBBUlJBWV9TSVpFKHRxKSk7Cj4gICAJCQlpZiAoZXJyKSB7Cj4gICAJCQkJaTkx
NV9nZW1fY29udGV4dF91bmxvY2tfZW5naW5lcyhjdHgpOwo+IC0JCQkJZ290byBvdXRfdW5sb2Nr
Owo+ICsJCQkJZ290byBvdXRfZmlsZTsKPiAgIAkJCX0KPiAgIAo+ICAgCQkJaWYgKCsrZHcgPT0g
bWF4X2R3b3JkcyhvYmopKSB7Cj4gQEAgLTE0MjQsMjAgKzE0MTAsMTkgQEAgc3RhdGljIGludCBp
Z3RfY3R4X3JlYWRvbmx5KHZvaWQgKmFyZykKPiAgIAkJZHcgKz0gcmVtOwo+ICAgCX0KPiAgIAo+
IC1vdXRfdW5sb2NrOgo+ICtvdXRfZmlsZToKPiAgIAl0aHJvdHRsZV9yZWxlYXNlKHRxLCBBUlJB
WV9TSVpFKHRxKSk7Cj4gICAJaWYgKGlndF9saXZlX3Rlc3RfZW5kKCZ0KSkKPiAgIAkJZXJyID0g
LUVJTzsKPiAtCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAKPiAg
IAltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKPiAgIAlyZXR1cm4gZXJyOwo+ICAgfQo+ICAg
Cj4gLXN0YXRpYyBpbnQgY2hlY2tfc2NyYXRjaChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4
LCB1NjQgb2Zmc2V0KQo+ICtzdGF0aWMgaW50IGNoZWNrX3NjcmF0Y2goc3RydWN0IGk5MTVfYWRk
cmVzc19zcGFjZSAqdm0sIHU2NCBvZmZzZXQpCj4gICB7Cj4gICAJc3RydWN0IGRybV9tbV9ub2Rl
ICpub2RlID0KPiAtCQlfX2RybV9tbV9pbnRlcnZhbF9maXJzdCgmY3R4LT52bS0+bW0sCj4gKwkJ
X19kcm1fbW1faW50ZXJ2YWxfZmlyc3QoJnZtLT5tbSwKPiAgIAkJCQkJb2Zmc2V0LCBvZmZzZXQg
KyBzaXplb2YodTMyKSAtIDEpOwo+ICAgCWlmICghbm9kZSB8fCBub2RlLT5zdGFydCA+IG9mZnNl
dCkKPiAgIAkJcmV0dXJuIDA7Cj4gQEAgLTE0NTUsNiArMTQ0MCw3IEBAIHN0YXRpYyBpbnQgd3Jp
dGVfdG9fc2NyYXRjaChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAo+ICAgewo+ICAgCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gY3R4LT5pOTE1Owo+ICAgCXN0cnVjdCBkcm1f
aTkxNV9nZW1fb2JqZWN0ICpvYmo7Cj4gKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsK
PiAgIAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKPiAgIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsK
PiAgIAl1MzIgKmNtZDsKPiBAQCAtMTQ4NywxNyArMTQ3MywxOCBAQCBzdGF0aWMgaW50IHdyaXRl
X3RvX3NjcmF0Y2goc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKPiAgIAo+ICAgCWludGVs
X2d0X2NoaXBzZXRfZmx1c2goZW5naW5lLT5ndCk7Cj4gICAKPiAtCXZtYSA9IGk5MTVfdm1hX2lu
c3RhbmNlKG9iaiwgY3R4LT52bSwgTlVMTCk7Cj4gKwl2bSA9IGk5MTVfZ2VtX2NvbnRleHRfZ2V0
X3ZtX3JjdShjdHgpOwo+ICsJdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uob2JqLCB2bSwgTlVMTCk7
Cj4gICAJaWYgKElTX0VSUih2bWEpKSB7Cj4gICAJCWVyciA9IFBUUl9FUlIodm1hKTsKPiAtCQln
b3RvIGVycjsKPiArCQlnb3RvIGVycl92bTsKPiAgIAl9Cj4gICAKPiAgIAllcnIgPSBpOTE1X3Zt
YV9waW4odm1hLCAwLCAwLCBQSU5fVVNFUiB8IFBJTl9PRkZTRVRfRklYRUQpOwo+ICAgCWlmIChl
cnIpCj4gLQkJZ290byBlcnI7Cj4gKwkJZ290byBlcnJfdm07Cj4gICAKPiAtCWVyciA9IGNoZWNr
X3NjcmF0Y2goY3R4LCBvZmZzZXQpOwo+ICsJZXJyID0gY2hlY2tfc2NyYXRjaCh2bSwgb2Zmc2V0
KTsKPiAgIAlpZiAoZXJyKQo+ICAgCQlnb3RvIGVycl91bnBpbjsKPiAgIAo+IEBAIC0xNTIzLDYg
KzE1MTAsNyBAQCBzdGF0aWMgaW50IHdyaXRlX3RvX3NjcmF0Y2goc3RydWN0IGk5MTVfZ2VtX2Nv
bnRleHQgKmN0eCwKPiAgIAo+ICAgCWk5MTVfcmVxdWVzdF9hZGQocnEpOwo+ICAgCj4gKwlpOTE1
X3ZtX3B1dCh2bSk7Cj4gICAJcmV0dXJuIDA7Cj4gICAKPiAgIHNraXBfcmVxdWVzdDoKPiBAQCAt
MTUzMSw2ICsxNTE5LDggQEAgc3RhdGljIGludCB3cml0ZV90b19zY3JhdGNoKHN0cnVjdCBpOTE1
X2dlbV9jb250ZXh0ICpjdHgsCj4gICAJaTkxNV9yZXF1ZXN0X2FkZChycSk7Cj4gICBlcnJfdW5w
aW46Cj4gICAJaTkxNV92bWFfdW5waW4odm1hKTsKPiArZXJyX3ZtOgo+ICsJaTkxNV92bV9wdXQo
dm0pOwo+ICAgZXJyOgo+ICAgCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKPiAgIAlyZXR1cm4g
ZXJyOwo+IEBAIC0xNTQyLDYgKzE1MzIsNyBAQCBzdGF0aWMgaW50IHJlYWRfZnJvbV9zY3JhdGNo
KHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsCj4gICB7Cj4gICAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSBjdHgtPmk5MTU7Cj4gICAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iajsKPiArCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtOwo+ICAgCWNvbnN0IHUz
MiBSQ1NfR1BSMCA9IDB4MjYwMDsgLyogbm90IGFsbCBlbmdpbmVzIGhhdmUgdGhlaXIgb3duIEdQ
UiEgKi8KPiAgIAljb25zdCB1MzIgcmVzdWx0ID0gMHgxMDA7Cj4gICAJc3RydWN0IGk5MTVfcmVx
dWVzdCAqcnE7Cj4gQEAgLTE1ODYsMTcgKzE1NzcsMTggQEAgc3RhdGljIGludCByZWFkX2Zyb21f
c2NyYXRjaChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAo+ICAgCj4gICAJaW50ZWxfZ3Rf
Y2hpcHNldF9mbHVzaChlbmdpbmUtPmd0KTsKPiAgIAo+IC0Jdm1hID0gaTkxNV92bWFfaW5zdGFu
Y2Uob2JqLCBjdHgtPnZtLCBOVUxMKTsKPiArCXZtID0gaTkxNV9nZW1fY29udGV4dF9nZXRfdm1f
cmN1KGN0eCk7Cj4gKwl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosIHZtLCBOVUxMKTsKPiAg
IAlpZiAoSVNfRVJSKHZtYSkpIHsKPiAgIAkJZXJyID0gUFRSX0VSUih2bWEpOwo+IC0JCWdvdG8g
ZXJyOwo+ICsJCWdvdG8gZXJyX3ZtOwo+ICAgCX0KPiAgIAo+ICAgCWVyciA9IGk5MTVfdm1hX3Bp
bih2bWEsIDAsIDAsIFBJTl9VU0VSIHwgUElOX09GRlNFVF9GSVhFRCk7Cj4gICAJaWYgKGVycikK
PiAtCQlnb3RvIGVycjsKPiArCQlnb3RvIGVycl92bTsKPiAgIAo+IC0JZXJyID0gY2hlY2tfc2Ny
YXRjaChjdHgsIG9mZnNldCk7Cj4gKwllcnIgPSBjaGVja19zY3JhdGNoKHZtLCBvZmZzZXQpOwo+
ICAgCWlmIChlcnIpCj4gICAJCWdvdG8gZXJyX3VucGluOwo+ICAgCj4gQEAgLTE2MjcsMTIgKzE2
MTksMTIgQEAgc3RhdGljIGludCByZWFkX2Zyb21fc2NyYXRjaChzdHJ1Y3QgaTkxNV9nZW1fY29u
dGV4dCAqY3R4LAo+ICAgCWVyciA9IGk5MTVfZ2VtX29iamVjdF9zZXRfdG9fY3B1X2RvbWFpbihv
YmosIGZhbHNlKTsKPiAgIAlpOTE1X2dlbV9vYmplY3RfdW5sb2NrKG9iaik7Cj4gICAJaWYgKGVy
cikKPiAtCQlnb3RvIGVycjsKPiArCQlnb3RvIGVycl92bTsKPiAgIAo+ICAgCWNtZCA9IGk5MTVf
Z2VtX29iamVjdF9waW5fbWFwKG9iaiwgSTkxNV9NQVBfV0IpOwo+ICAgCWlmIChJU19FUlIoY21k
KSkgewo+ICAgCQllcnIgPSBQVFJfRVJSKGNtZCk7Cj4gLQkJZ290byBlcnI7Cj4gKwkJZ290byBl
cnJfdm07Cj4gICAJfQo+ICAgCj4gICAJKnZhbHVlID0gY21kW3Jlc3VsdCAvIHNpemVvZigqY21k
KV07Cj4gQEAgLTE2NDcsNiArMTYzOSw4IEBAIHN0YXRpYyBpbnQgcmVhZF9mcm9tX3NjcmF0Y2go
c3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKPiAgIAlpOTE1X3JlcXVlc3RfYWRkKHJxKTsK
PiAgIGVycl91bnBpbjoKPiAgIAlpOTE1X3ZtYV91bnBpbih2bWEpOwo+ICtlcnJfdm06Cj4gKwlp
OTE1X3ZtX3B1dCh2bSk7Cj4gICBlcnI6Cj4gICAJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOwo+
ICAgCXJldHVybiBlcnI7Cj4gQEAgLTE2NzcsMjcgKzE2NzEsMjUgQEAgc3RhdGljIGludCBpZ3Rf
dm1faXNvbGF0aW9uKHZvaWQgKmFyZykKPiAgIAlpZiAoSVNfRVJSKGZpbGUpKQo+ICAgCQlyZXR1
cm4gUFRSX0VSUihmaWxlKTsKPiAgIAo+IC0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9t
dXRleCk7Cj4gLQo+ICAgCWVyciA9IGlndF9saXZlX3Rlc3RfYmVnaW4oJnQsIGk5MTUsIF9fZnVu
Y19fLCAiIik7Cj4gICAJaWYgKGVycikKPiAtCQlnb3RvIG91dF91bmxvY2s7Cj4gKwkJZ290byBv
dXRfZmlsZTsKPiAgIAo+ICAgCWN0eF9hID0gbGl2ZV9jb250ZXh0KGk5MTUsIGZpbGUpOwo+ICAg
CWlmIChJU19FUlIoY3R4X2EpKSB7Cj4gICAJCWVyciA9IFBUUl9FUlIoY3R4X2EpOwo+IC0JCWdv
dG8gb3V0X3VubG9jazsKPiArCQlnb3RvIG91dF9maWxlOwo+ICAgCX0KPiAgIAo+ICAgCWN0eF9i
ID0gbGl2ZV9jb250ZXh0KGk5MTUsIGZpbGUpOwo+ICAgCWlmIChJU19FUlIoY3R4X2IpKSB7Cj4g
ICAJCWVyciA9IFBUUl9FUlIoY3R4X2IpOwo+IC0JCWdvdG8gb3V0X3VubG9jazsKPiArCQlnb3Rv
IG91dF9maWxlOwo+ICAgCX0KPiAgIAo+ICAgCS8qIFdlIGNhbiBvbmx5IHRlc3Qgdm0gaXNvbGF0
aW9uLCBpZiB0aGUgdm0gYXJlIGRpc3RpbmN0ICovCj4gICAJaWYgKGN0eF9hLT52bSA9PSBjdHhf
Yi0+dm0pCj4gLQkJZ290byBvdXRfdW5sb2NrOwo+ICsJCWdvdG8gb3V0X2ZpbGU7Cj4gICAKPiAg
IAl2bV90b3RhbCA9IGN0eF9hLT52bS0+dG90YWw7Cj4gICAJR0VNX0JVR19PTihjdHhfYi0+dm0t
PnRvdGFsICE9IHZtX3RvdGFsKTsKPiBAQCAtMTcyNiw3ICsxNzE4LDcgQEAgc3RhdGljIGludCBp
Z3Rfdm1faXNvbGF0aW9uKHZvaWQgKmFyZykKPiAgIAkJCQllcnIgPSByZWFkX2Zyb21fc2NyYXRj
aChjdHhfYiwgZW5naW5lLAo+ICAgCQkJCQkJCW9mZnNldCwgJnZhbHVlKTsKPiAgIAkJCWlmIChl
cnIpCj4gLQkJCQlnb3RvIG91dF91bmxvY2s7Cj4gKwkJCQlnb3RvIG91dF9maWxlOwo+ICAgCj4g
ICAJCQlpZiAodmFsdWUpIHsKPiAgIAkJCQlwcl9lcnIoIiVzOiBSZWFkICUwOHggZnJvbSBzY3Jh
dGNoIChvZmZzZXQgMHglMDh4XyUwOHgpLCBhZnRlciAlbHUgcmVhZHMhXG4iLAo+IEBAIC0xNzM1
LDcgKzE3MjcsNyBAQCBzdGF0aWMgaW50IGlndF92bV9pc29sYXRpb24odm9pZCAqYXJnKQo+ICAg
CQkJCSAgICAgICBsb3dlcl8zMl9iaXRzKG9mZnNldCksCj4gICAJCQkJICAgICAgIHRoaXMpOwo+
ICAgCQkJCWVyciA9IC1FSU5WQUw7Cj4gLQkJCQlnb3RvIG91dF91bmxvY2s7Cj4gKwkJCQlnb3Rv
IG91dF9maWxlOwo+ICAgCQkJfQo+ICAgCj4gICAJCQl0aGlzKys7Cj4gQEAgLTE3NDUsMTEgKzE3
MzcsOSBAQCBzdGF0aWMgaW50IGlndF92bV9pc29sYXRpb24odm9pZCAqYXJnKQo+ICAgCXByX2lu
Zm8oIkNoZWNrZWQgJWx1IHNjcmF0Y2ggb2Zmc2V0cyBhY3Jvc3MgJWQgZW5naW5lc1xuIiwKPiAg
IAkJY291bnQsIFJVTlRJTUVfSU5GTyhpOTE1KS0+bnVtX2VuZ2luZXMpOwo+ICAgCj4gLW91dF91
bmxvY2s6Cj4gK291dF9maWxlOgo+ICAgCWlmIChpZ3RfbGl2ZV90ZXN0X2VuZCgmdCkpCj4gICAJ
CWVyciA9IC1FSU87Cj4gLQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+
IC0KPiAgIAltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKPiAgIAlyZXR1cm4gZXJyOwo+ICAg
fQo+IEBAIC0xNzgxLDEzICsxNzcxLDkgQEAgc3RhdGljIGludCBtb2NrX2NvbnRleHRfYmFycmll
cih2b2lkICphcmcpCj4gICAJICogYSByZXF1ZXN0OyB1c2VmdWwgZm9yIHJldGlyaW5nIG9sZCBz
dGF0ZSBhZnRlciBsb2FkaW5nIG5ldy4KPiAgIAkgKi8KPiAgIAo+IC0JbXV0ZXhfbG9jaygmaTkx
NS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gLQo+ICAgCWN0eCA9IG1vY2tfY29udGV4dChpOTE1LCAi
bW9jayIpOwo+IC0JaWYgKCFjdHgpIHsKPiAtCQllcnIgPSAtRU5PTUVNOwo+IC0JCWdvdG8gdW5s
b2NrOwo+IC0JfQo+ICsJaWYgKCFjdHgpCj4gKwkJcmV0dXJuIC1FTk9NRU07Cj4gICAKPiAgIAlj
b3VudGVyID0gMDsKPiAgIAllcnIgPSBjb250ZXh0X2JhcnJpZXJfdGFzayhjdHgsIDAsCj4gQEAg
LTE4NjAsOCArMTg0Niw2IEBAIHN0YXRpYyBpbnQgbW9ja19jb250ZXh0X2JhcnJpZXIodm9pZCAq
YXJnKQo+ICAgCj4gICBvdXQ6Cj4gICAJbW9ja19jb250ZXh0X2Nsb3NlKGN0eCk7Cj4gLXVubG9j
azoKPiAtCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAJcmV0dXJu
IGVycjsKPiAgICN1bmRlZiBwcl9mbXQKPiAgICNkZWZpbmUgcHJfZm10KHgpIHgKPiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9tb2NrX2NvbnRleHQuYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvbW9ja19jb250ZXh0LmMKPiBpbmRl
eCAwMTA0ZjE2YjEzMjcuLjc0ZGRkNjgyYzljZCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vc2VsZnRlc3RzL21vY2tfY29udGV4dC5jCj4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9tb2NrX2NvbnRleHQuYwo+IEBAIC00Miw3ICs0MiwxMCBA
QCBtb2NrX2NvbnRleHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCWlmICgh
cHBndHQpCj4gICAJCQlnb3RvIGVycl9wdXQ7Cj4gICAKPiArCQltdXRleF9sb2NrKCZjdHgtPm11
dGV4KTsKPiAgIAkJX19zZXRfcHBndHQoY3R4LCAmcHBndHQtPnZtKTsKPiArCQltdXRleF91bmxv
Y2soJmN0eC0+bXV0ZXgpOwo+ICsKPiAgIAkJaTkxNV92bV9wdXQoJnBwZ3R0LT52bSk7Cj4gICAJ
fQo+ICAgCj4gQEAgLTY1LDcgKzY4LDcgQEAgdm9pZCBtb2NrX2NvbnRleHRfY2xvc2Uoc3RydWN0
IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKPiAgIAo+ICAgdm9pZCBtb2NrX2luaXRfY29udGV4dHMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gLQlpbml0X2NvbnRleHRzKGk5
MTUpOwo+ICsJaW5pdF9jb250ZXh0cygmaTkxNS0+Z2VtLmNvbnRleHRzKTsKPiAgIH0KPiAgIAo+
ICAgc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKgo+IEBAIC03NCw4ICs3Nyw2IEBAIGxpdmVfY29u
dGV4dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgc3RydWN0IGRybV9maWxlICpmaWxl
KQo+ICAgCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7Cj4gICAJaW50IGVycjsKPiAgIAo+
IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gLQo+ICAg
CWN0eCA9IGk5MTVfZ2VtX2NyZWF0ZV9jb250ZXh0KGk5MTUsIDApOwo+ICAgCWlmIChJU19FUlIo
Y3R4KSkKPiAgIAkJcmV0dXJuIGN0eDsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfY29udGV4dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29u
dGV4dC5jCj4gaW5kZXggMzVhNDBjMjgyMGEyLi5iZTM0ZDk3YWMxOGYgMTAwNjQ0Cj4gLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5jCj4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5jCj4gQEAgLTIyMSwxMiArMjIxLDIwIEBAIGlu
dGVsX2NvbnRleHRfaW5pdChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCj4gICAJCSAgIHN0cnVj
dCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsCj4gICAJCSAgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSkKPiAgIHsKPiArCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtOwo+ICsKPiAg
IAlHRU1fQlVHX09OKCFlbmdpbmUtPmNvcHMpOwo+ICAgCj4gICAJa3JlZl9pbml0KCZjZS0+cmVm
KTsKPiAgIAo+ICAgCWNlLT5nZW1fY29udGV4dCA9IGN0eDsKPiAtCWNlLT52bSA9IGk5MTVfdm1f
Z2V0KGN0eC0+dm0gPzogJmVuZ2luZS0+Z3QtPmdndHQtPnZtKTsKPiArCXJjdV9yZWFkX2xvY2so
KTsKPiArCXZtID0gcmN1X2RlcmVmZXJlbmNlKGN0eC0+dm0pOwo+ICsJaWYgKHZtKQo+ICsJCWNl
LT52bSA9IGk5MTVfdm1fZ2V0KHZtKTsKPiArCWVsc2UKPiArCQljZS0+dm0gPSBpOTE1X3ZtX2dl
dCgmZW5naW5lLT5ndC0+Z2d0dC0+dm0pOwo+ICsJcmN1X3JlYWRfdW5sb2NrKCk7Cj4gICAJaWYg
KGN0eC0+dGltZWxpbmUpCj4gICAJCWNlLT50aW1lbGluZSA9IGludGVsX3RpbWVsaW5lX2dldChj
dHgtPnRpbWVsaW5lKTsKPiAgIAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9zZWxmdGVzdF9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9j
b250ZXh0LmMKPiBpbmRleCA4NmNmZmJiMGE5Y2IuLjdjODM4YTU3ZTE3NCAxMDA2NDQKPiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9jb250ZXh0LmMKPiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9jb250ZXh0LmMKPiBAQCAtMTU1LDEzICsxNTUs
OSBAQCBzdGF0aWMgaW50IGxpdmVfY29udGV4dF9zaXplKHZvaWQgKmFyZykKPiAgIAkgKiBIVyB0
cmllcyB0byB3cml0ZSBwYXN0IHRoZSBlbmQgb2Ygb25lLgo+ICAgCSAqLwo+ICAgCj4gLQltdXRl
eF9sb2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gLQo+ICAgCWZpeG1lID0ga2Vy
bmVsX2NvbnRleHQoZ3QtPmk5MTUpOwo+IC0JaWYgKElTX0VSUihmaXhtZSkpIHsKPiAtCQllcnIg
PSBQVFJfRVJSKGZpeG1lKTsKPiAtCQlnb3RvIHVubG9jazsKPiAtCX0KPiArCWlmIChJU19FUlIo
Zml4bWUpKQo+ICsJCXJldHVybiBQVFJfRVJSKGZpeG1lKTsKPiAgIAo+ICAgCWZvcl9lYWNoX2Vu
Z2luZShlbmdpbmUsIGd0LT5pOTE1LCBpZCkgewo+ICAgCQlzdHJ1Y3Qgewo+IEBAIC0yMDEsOCAr
MTk3LDYgQEAgc3RhdGljIGludCBsaXZlX2NvbnRleHRfc2l6ZSh2b2lkICphcmcpCj4gICAJfQo+
ICAgCj4gICAJa2VybmVsX2NvbnRleHRfY2xvc2UoZml4bWUpOwo+IC11bmxvY2s6Cj4gLQltdXRl
eF91bmxvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAlyZXR1cm4gZXJyOwo+
ICAgfQo+ICAgCj4gQEAgLTMwNSwxMiArMjk5LDEwIEBAIHN0YXRpYyBpbnQgbGl2ZV9hY3RpdmVf
Y29udGV4dCh2b2lkICphcmcpCj4gICAJaWYgKElTX0VSUihmaWxlKSkKPiAgIAkJcmV0dXJuIFBU
Ul9FUlIoZmlsZSk7Cj4gICAKPiAtCW11dGV4X2xvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211
dGV4KTsKPiAtCj4gICAJZml4bWUgPSBsaXZlX2NvbnRleHQoZ3QtPmk5MTUsIGZpbGUpOwo+ICAg
CWlmIChJU19FUlIoZml4bWUpKSB7Cj4gICAJCWVyciA9IFBUUl9FUlIoZml4bWUpOwo+IC0JCWdv
dG8gdW5sb2NrOwo+ICsJCWdvdG8gb3V0X2ZpbGU7Cj4gICAJfQo+ICAgCj4gICAJZm9yX2VhY2hf
ZW5naW5lKGVuZ2luZSwgZ3QtPmk5MTUsIGlkKSB7Cj4gQEAgLTMyMyw4ICszMTUsNyBAQCBzdGF0
aWMgaW50IGxpdmVfYWN0aXZlX2NvbnRleHQodm9pZCAqYXJnKQo+ICAgCQkJYnJlYWs7Cj4gICAJ
fQo+ICAgCj4gLXVubG9jazoKPiAtCW11dGV4X3VubG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3Rf
bXV0ZXgpOwo+ICtvdXRfZmlsZToKPiAgIAltb2NrX2ZpbGVfZnJlZShndC0+aTkxNSwgZmlsZSk7
Cj4gICAJcmV0dXJuIGVycjsKPiAgIH0KPiBAQCAtNDE4LDEyICs0MDksMTAgQEAgc3RhdGljIGlu
dCBsaXZlX3JlbW90ZV9jb250ZXh0KHZvaWQgKmFyZykKPiAgIAlpZiAoSVNfRVJSKGZpbGUpKQo+
ICAgCQlyZXR1cm4gUFRSX0VSUihmaWxlKTsKPiAgIAo+IC0JbXV0ZXhfbG9jaygmZ3QtPmk5MTUt
PmRybS5zdHJ1Y3RfbXV0ZXgpOwo+IC0KPiAgIAlmaXhtZSA9IGxpdmVfY29udGV4dChndC0+aTkx
NSwgZmlsZSk7Cj4gICAJaWYgKElTX0VSUihmaXhtZSkpIHsKPiAgIAkJZXJyID0gUFRSX0VSUihm
aXhtZSk7Cj4gLQkJZ290byB1bmxvY2s7Cj4gKwkJZ290byBvdXRfZmlsZTsKPiAgIAl9Cj4gICAK
PiAgIAlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndC0+aTkxNSwgaWQpIHsKPiBAQCAtNDM2LDgg
KzQyNSw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9yZW1vdGVfY29udGV4dCh2b2lkICphcmcpCj4gICAJ
CQlicmVhazsKPiAgIAl9Cj4gICAKPiAtdW5sb2NrOgo+IC0JbXV0ZXhfdW5sb2NrKCZndC0+aTkx
NS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gK291dF9maWxlOgo+ICAgCW1vY2tfZmlsZV9mcmVlKGd0
LT5pOTE1LCBmaWxlKTsKPiAgIAlyZXR1cm4gZXJyOwo+ICAgfQo+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hlY2suYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jCj4gaW5kZXggZmZiYjNkMjNiODg3Li5lOGE0
MGRmNzliZDAgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rf
aGFuZ2NoZWNrLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5n
Y2hlY2suYwo+IEBAIC01OCw5ICs1OCw3IEBAIHN0YXRpYyBpbnQgaGFuZ19pbml0KHN0cnVjdCBo
YW5nICpoLCBzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQo+ICAgCW1lbXNldChoLCAwLCBzaXplb2YoKmgp
KTsKPiAgIAloLT5ndCA9IGd0Owo+ICAgCj4gLQltdXRleF9sb2NrKCZndC0+aTkxNS0+ZHJtLnN0
cnVjdF9tdXRleCk7Cj4gICAJaC0+Y3R4ID0ga2VybmVsX2NvbnRleHQoZ3QtPmk5MTUpOwo+IC0J
bXV0ZXhfdW5sb2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAJaWYgKElTX0VS
UihoLT5jdHgpKQo+ICAgCQlyZXR1cm4gUFRSX0VSUihoLT5jdHgpOwo+ICAgCj4gQEAgLTEzMyw3
ICsxMzEsNyBAQCBzdGF0aWMgc3RydWN0IGk5MTVfcmVxdWVzdCAqCj4gICBoYW5nX2NyZWF0ZV9y
ZXF1ZXN0KHN0cnVjdCBoYW5nICpoLCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4g
ICB7Cj4gICAJc3RydWN0IGludGVsX2d0ICpndCA9IGgtPmd0Owo+IC0Jc3RydWN0IGk5MTVfYWRk
cmVzc19zcGFjZSAqdm0gPSBoLT5jdHgtPnZtID86ICZlbmdpbmUtPmd0LT5nZ3R0LT52bTsKPiAr
CXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0gaTkxNV9nZW1fY29udGV4dF9nZXRfdm1f
cmN1KGgtPmN0eCk7Cj4gICAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKPiAgIAlz
dHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSA9IE5VTEw7Cj4gICAJc3RydWN0IGk5MTVfdm1hICpod3Ms
ICp2bWE7Cj4gQEAgLTE0MywxMiArMTQxLDE1IEBAIGhhbmdfY3JlYXRlX3JlcXVlc3Qoc3RydWN0
IGhhbmcgKmgsIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiAgIAlpbnQgZXJyOwo+
ICAgCj4gICAJb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5hbChndC0+aTkxNSwg
UEFHRV9TSVpFKTsKPiAtCWlmIChJU19FUlIob2JqKSkKPiArCWlmIChJU19FUlIob2JqKSkgewo+
ICsJCWk5MTVfdm1fcHV0KHZtKTsKPiAgIAkJcmV0dXJuIEVSUl9DQVNUKG9iaik7Cj4gKwl9Cj4g
ICAKPiAgIAl2YWRkciA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKG9iaiwgaTkxNV9jb2hlcmVu
dF9tYXBfdHlwZShndC0+aTkxNSkpOwo+ICAgCWlmIChJU19FUlIodmFkZHIpKSB7Cj4gICAJCWk5
MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKPiArCQlpOTE1X3ZtX3B1dCh2bSk7Cj4gICAJCXJldHVy
biBFUlJfQ0FTVCh2YWRkcik7Cj4gICAJfQo+ICAgCj4gQEAgLTE1OSwxNiArMTYwLDIyIEBAIGhh
bmdfY3JlYXRlX3JlcXVlc3Qoc3RydWN0IGhhbmcgKmgsIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSkKPiAgIAloLT5iYXRjaCA9IHZhZGRyOwo+ICAgCj4gICAJdm1hID0gaTkxNV92bWFf
aW5zdGFuY2UoaC0+b2JqLCB2bSwgTlVMTCk7Cj4gLQlpZiAoSVNfRVJSKHZtYSkpCj4gKwlpZiAo
SVNfRVJSKHZtYSkpIHsKPiArCQlpOTE1X3ZtX3B1dCh2bSk7Cj4gICAJCXJldHVybiBFUlJfQ0FT
VCh2bWEpOwo+ICsJfQo+ICAgCj4gICAJaHdzID0gaTkxNV92bWFfaW5zdGFuY2UoaC0+aHdzLCB2
bSwgTlVMTCk7Cj4gLQlpZiAoSVNfRVJSKGh3cykpCj4gKwlpZiAoSVNfRVJSKGh3cykpIHsKPiAr
CQlpOTE1X3ZtX3B1dCh2bSk7Cj4gICAJCXJldHVybiBFUlJfQ0FTVChod3MpOwo+ICsJfQo+ICAg
Cj4gICAJZXJyID0gaTkxNV92bWFfcGluKHZtYSwgMCwgMCwgUElOX1VTRVIpOwo+IC0JaWYgKGVy
cikKPiArCWlmIChlcnIpIHsKPiArCQlpOTE1X3ZtX3B1dCh2bSk7Cj4gICAJCXJldHVybiBFUlJf
UFRSKGVycik7Cj4gKwl9Cj4gICAKPiAgIAllcnIgPSBpOTE1X3ZtYV9waW4oaHdzLCAwLCAwLCBQ
SU5fVVNFUik7Cj4gICAJaWYgKGVycikKPiBAQCAtMjY2LDYgKzI3Myw3IEBAIGhhbmdfY3JlYXRl
X3JlcXVlc3Qoc3RydWN0IGhhbmcgKmgsIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkK
PiAgIAlpOTE1X3ZtYV91bnBpbihod3MpOwo+ICAgdW5waW5fdm1hOgo+ICAgCWk5MTVfdm1hX3Vu
cGluKHZtYSk7Cj4gKwlpOTE1X3ZtX3B1dCh2bSk7Cj4gICAJcmV0dXJuIGVyciA/IEVSUl9QVFIo
ZXJyKSA6IHJxOwo+ICAgfQo+ICAgCj4gQEAgLTM4Miw5ICszOTAsNyBAQCBzdGF0aWMgaW50IGln
dF9yZXNldF9ub3Aodm9pZCAqYXJnKQo+ICAgCWlmIChJU19FUlIoZmlsZSkpCj4gICAJCXJldHVy
biBQVFJfRVJSKGZpbGUpOwo+ICAgCj4gLQltdXRleF9sb2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVj
dF9tdXRleCk7Cj4gICAJY3R4ID0gbGl2ZV9jb250ZXh0KGd0LT5pOTE1LCBmaWxlKTsKPiAtCW11
dGV4X3VubG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCWlmIChJU19FUlIo
Y3R4KSkgewo+ICAgCQllcnIgPSBQVFJfRVJSKGN0eCk7Cj4gICAJCWdvdG8gb3V0Owo+IEBAIC00
NTgsOSArNDY0LDcgQEAgc3RhdGljIGludCBpZ3RfcmVzZXRfbm9wX2VuZ2luZSh2b2lkICphcmcp
Cj4gICAJaWYgKElTX0VSUihmaWxlKSkKPiAgIAkJcmV0dXJuIFBUUl9FUlIoZmlsZSk7Cj4gICAK
PiAtCW11dGV4X2xvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAljdHggPSBs
aXZlX2NvbnRleHQoZ3QtPmk5MTUsIGZpbGUpOwo+IC0JbXV0ZXhfdW5sb2NrKCZndC0+aTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAJaWYgKElTX0VSUihjdHgpKSB7Cj4gICAJCWVyciA9IFBU
Ul9FUlIoY3R4KTsKPiAgIAkJZ290byBvdXQ7Cj4gQEAgLTcwNSw5ICs3MDksNyBAQCBzdGF0aWMg
aW50IGFjdGl2ZV9lbmdpbmUodm9pZCAqZGF0YSkKPiAgIAkJcmV0dXJuIFBUUl9FUlIoZmlsZSk7
Cj4gICAKPiAgIAlmb3IgKGNvdW50ID0gMDsgY291bnQgPCBBUlJBWV9TSVpFKGN0eCk7IGNvdW50
KyspIHsKPiAtCQltdXRleF9sb2NrKCZlbmdpbmUtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+
ICAgCQljdHhbY291bnRdID0gbGl2ZV9jb250ZXh0KGVuZ2luZS0+aTkxNSwgZmlsZSk7Cj4gLQkJ
bXV0ZXhfdW5sb2NrKCZlbmdpbmUtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCQlpZiAo
SVNfRVJSKGN0eFtjb3VudF0pKSB7Cj4gICAJCQllcnIgPSBQVFJfRVJSKGN0eFtjb3VudF0pOwo+
ICAgCQkJd2hpbGUgKC0tY291bnQpCj4gQEAgLTEyOTEsNiArMTI5Myw3IEBAIHN0YXRpYyBpbnQg
aWd0X3Jlc2V0X2V2aWN0X3BwZ3R0KHZvaWQgKmFyZykKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxf
Z3QgKmd0ID0gYXJnOwo+ICAgCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7Cj4gKwlzdHJ1
Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsKPiAgIAlzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGU7Cj4g
ICAJaW50IGVycjsKPiAgIAo+IEBAIC0xMjk4LDE4ICsxMzAxLDIwIEBAIHN0YXRpYyBpbnQgaWd0
X3Jlc2V0X2V2aWN0X3BwZ3R0KHZvaWQgKmFyZykKPiAgIAlpZiAoSVNfRVJSKGZpbGUpKQo+ICAg
CQlyZXR1cm4gUFRSX0VSUihmaWxlKTsKPiAgIAo+IC0JbXV0ZXhfbG9jaygmZ3QtPmk5MTUtPmRy
bS5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCWN0eCA9IGxpdmVfY29udGV4dChndC0+aTkxNSwgZmlsZSk7
Cj4gLQltdXRleF91bmxvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAlpZiAo
SVNfRVJSKGN0eCkpIHsKPiAgIAkJZXJyID0gUFRSX0VSUihjdHgpOwo+ICAgCQlnb3RvIG91dDsK
PiAgIAl9Cj4gICAKPiAgIAllcnIgPSAwOwo+IC0JaWYgKGN0eC0+dm0pIC8qIGFsaWFzaW5nID09
IGdsb2JhbCBndHQgbG9ja2luZywgY292ZXJlZCBhYm92ZSAqLwo+IC0JCWVyciA9IF9faWd0X3Jl
c2V0X2V2aWN0X3ZtYShndCwgY3R4LT52bSwKPiArCXZtID0gaTkxNV9nZW1fY29udGV4dF9nZXRf
dm1fcmN1KGN0eCk7Cj4gKwlpZiAoIWk5MTVfaXNfZ2d0dCh2bSkpIHsKPiArCQkvKiBhbGlhc2lu
ZyA9PSBnbG9iYWwgZ3R0IGxvY2tpbmcsIGNvdmVyZWQgYWJvdmUgKi8KPiArCQllcnIgPSBfX2ln
dF9yZXNldF9ldmljdF92bWEoZ3QsIHZtLAo+ICAgCQkJCQkgICAgZXZpY3Rfdm1hLCBFWEVDX09C
SkVDVF9XUklURSk7Cj4gKwl9Cj4gKwlpOTE1X3ZtX3B1dCh2bSk7Cj4gICAKPiAgIG91dDoKPiAg
IAltb2NrX2ZpbGVfZnJlZShndC0+aTkxNSwgZmlsZSk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
c2VsZnRlc3RfbHJjLmMKPiBpbmRleCAwNGMxY2Y1NzM2NDIuLjhkYzQyYzVjNzU2OSAxMDA2NDQK
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwo+ICsrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCj4gQEAgLTE2MzEsNyArMTYzMSwx
MSBAQCBzdGF0aWMgaW50IHNtb2tlX3N1Ym1pdChzdHJ1Y3QgcHJlZW1wdF9zbW9rZSAqc21va2Us
Cj4gICAJaW50IGVyciA9IDA7Cj4gICAKPiAgIAlpZiAoYmF0Y2gpIHsKPiAtCQl2bWEgPSBpOTE1
X3ZtYV9pbnN0YW5jZShiYXRjaCwgY3R4LT52bSwgTlVMTCk7Cj4gKwkJc3RydWN0IGk5MTVfYWRk
cmVzc19zcGFjZSAqdm07Cj4gKwo+ICsJCXZtID0gaTkxNV9nZW1fY29udGV4dF9nZXRfdm1fcmN1
KGN0eCk7Cj4gKwkJdm1hID0gaTkxNV92bWFfaW5zdGFuY2UoYmF0Y2gsIHZtLCBOVUxMKTsKPiAr
CQlpOTE1X3ZtX3B1dCh2bSk7Cj4gICAJCWlmIChJU19FUlIodm1hKSkKPiAgIAkJCXJldHVybiBQ
VFJfRVJSKHZtYSk7Cj4gICAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
c2VsZnRlc3Rfd29ya2Fyb3VuZHMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0
X3dvcmthcm91bmRzLmMKPiBpbmRleCA0ZWUyZTJiYWJkMGQuLjdjN2FjZWI4NWE3NCAxMDA2NDQK
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF93b3JrYXJvdW5kcy5jCj4g
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rfd29ya2Fyb3VuZHMuYwo+IEBA
IC0yNjAsNyArMjYwLDYgQEAgc3dpdGNoX3RvX3NjcmF0Y2hfY29udGV4dChzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUsCj4gICAJCXJxID0gaWd0X3NwaW5uZXJfY3JlYXRlX3JlcXVlc3Qo
c3BpbiwgY2UsIE1JX05PT1ApOwo+ICAgCj4gICAJaW50ZWxfY29udGV4dF9wdXQoY2UpOwo+IC0J
a2VybmVsX2NvbnRleHRfY2xvc2UoY3R4KTsKPiAgIAo+ICAgCWlmIChJU19FUlIocnEpKSB7Cj4g
ICAJCXNwaW4gPSBOVUxMOwo+IEBAIC0yNzksNiArMjc4LDcgQEAgc3dpdGNoX3RvX3NjcmF0Y2hf
Y29udGV4dChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCj4gICAJaWYgKGVyciAmJiBz
cGluKQo+ICAgCQlpZ3Rfc3Bpbm5lcl9lbmQoc3Bpbik7Cj4gICAKPiArCWtlcm5lbF9jb250ZXh0
X2Nsb3NlKGN0eCk7Cj4gICAJcmV0dXJuIGVycjsKPiAgIH0KPiAgIAo+IEBAIC0zNTUsNiArMzU1
LDcgQEAgc3RhdGljIGludCBjaGVja193aGl0ZWxpc3RfYWNyb3NzX3Jlc2V0KHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSwKPiAgIHN0YXRpYyBzdHJ1Y3QgaTkxNV92bWEgKmNyZWF0ZV9i
YXRjaChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQo+ICAgewo+ICAgCXN0cnVjdCBkcm1f
aTkxNV9nZW1fb2JqZWN0ICpvYmo7Cj4gKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsK
PiAgIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKPiAgIAlpbnQgZXJyOwo+ICAgCj4gQEAgLTM2Miw3
ICszNjMsOSBAQCBzdGF0aWMgc3RydWN0IGk5MTVfdm1hICpjcmVhdGVfYmF0Y2goc3RydWN0IGk5
MTVfZ2VtX2NvbnRleHQgKmN0eCkKPiAgIAlpZiAoSVNfRVJSKG9iaikpCj4gICAJCXJldHVybiBF
UlJfQ0FTVChvYmopOwo+ICAgCj4gLQl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosIGN0eC0+
dm0sIE5VTEwpOwo+ICsJdm0gPSBpOTE1X2dlbV9jb250ZXh0X2dldF92bV9yY3UoY3R4KTsKPiAr
CXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9iaiwgdm0sIE5VTEwpOwo+ICsJaTkxNV92bV9wdXQo
dm0pOwo+ICAgCWlmIChJU19FUlIodm1hKSkgewo+ICAgCQllcnIgPSBQVFJfRVJSKHZtYSk7Cj4g
ICAJCWdvdG8gZXJyX29iajsKPiBAQCAtNDYzLDEyICs0NjYsMTUgQEAgc3RhdGljIGludCBjaGVj
a19kaXJ0eV93aGl0ZWxpc3Qoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKPiAgIAkJMHhm
ZmZmMDBmZiwKPiAgIAkJMHhmZmZmZmZmZiwKPiAgIAl9Owo+ICsJc3RydWN0IGk5MTVfYWRkcmVz
c19zcGFjZSAqdm07Cj4gICAJc3RydWN0IGk5MTVfdm1hICpzY3JhdGNoOwo+ICAgCXN0cnVjdCBp
OTE1X3ZtYSAqYmF0Y2g7Cj4gICAJaW50IGVyciA9IDAsIGksIHY7Cj4gICAJdTMyICpjcywgKnJl
c3VsdHM7Cj4gICAKPiAtCXNjcmF0Y2ggPSBjcmVhdGVfc2NyYXRjaChjdHgtPnZtLCAyICogQVJS
QVlfU0laRSh2YWx1ZXMpICsgMSk7Cj4gKwl2bSA9IGk5MTVfZ2VtX2NvbnRleHRfZ2V0X3ZtX3Jj
dShjdHgpOwo+ICsJc2NyYXRjaCA9IGNyZWF0ZV9zY3JhdGNoKHZtLCAyICogQVJSQVlfU0laRSh2
YWx1ZXMpICsgMSk7Cj4gKwlpOTE1X3ZtX3B1dCh2bSk7Cj4gICAJaWYgKElTX0VSUihzY3JhdGNo
KSkKPiAgIAkJcmV0dXJuIFBUUl9FUlIoc2NyYXRjaCk7Cj4gICAKPiBAQCAtMTAxMCw2ICsxMDE2
LDcgQEAgc3RhdGljIGludCBsaXZlX2lzb2xhdGVkX3doaXRlbGlzdCh2b2lkICphcmcpCj4gICAJ
CXJldHVybiAwOwo+ICAgCj4gICAJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoY2xpZW50KTsg
aSsrKSB7Cj4gKwkJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm07Cj4gICAJCXN0cnVjdCBp
OTE1X2dlbV9jb250ZXh0ICpjOwo+ICAgCj4gICAJCWMgPSBrZXJuZWxfY29udGV4dChpOTE1KTsK
PiBAQCAtMTAxOCwyMiArMTAyNSwyNyBAQCBzdGF0aWMgaW50IGxpdmVfaXNvbGF0ZWRfd2hpdGVs
aXN0KHZvaWQgKmFyZykKPiAgIAkJCWdvdG8gZXJyOwo+ICAgCQl9Cj4gICAKPiAtCQljbGllbnRb
aV0uc2NyYXRjaFswXSA9IGNyZWF0ZV9zY3JhdGNoKGMtPnZtLCAxMDI0KTsKPiArCQl2bSA9IGk5
MTVfZ2VtX2NvbnRleHRfZ2V0X3ZtX3JjdShjKTsKPiArCj4gKwkJY2xpZW50W2ldLnNjcmF0Y2hb
MF0gPSBjcmVhdGVfc2NyYXRjaCh2bSwgMTAyNCk7Cj4gICAJCWlmIChJU19FUlIoY2xpZW50W2ld
LnNjcmF0Y2hbMF0pKSB7Cj4gICAJCQllcnIgPSBQVFJfRVJSKGNsaWVudFtpXS5zY3JhdGNoWzBd
KTsKPiArCQkJaTkxNV92bV9wdXQodm0pOwo+ICAgCQkJa2VybmVsX2NvbnRleHRfY2xvc2UoYyk7
Cj4gICAJCQlnb3RvIGVycjsKPiAgIAkJfQo+ICAgCj4gLQkJY2xpZW50W2ldLnNjcmF0Y2hbMV0g
PSBjcmVhdGVfc2NyYXRjaChjLT52bSwgMTAyNCk7Cj4gKwkJY2xpZW50W2ldLnNjcmF0Y2hbMV0g
PSBjcmVhdGVfc2NyYXRjaCh2bSwgMTAyNCk7Cj4gICAJCWlmIChJU19FUlIoY2xpZW50W2ldLnNj
cmF0Y2hbMV0pKSB7Cj4gICAJCQllcnIgPSBQVFJfRVJSKGNsaWVudFtpXS5zY3JhdGNoWzFdKTsK
PiAgIAkJCWk5MTVfdm1hX3VucGluX2FuZF9yZWxlYXNlKCZjbGllbnRbaV0uc2NyYXRjaFswXSwg
MCk7Cj4gKwkJCWk5MTVfdm1fcHV0KHZtKTsKPiAgIAkJCWtlcm5lbF9jb250ZXh0X2Nsb3NlKGMp
Owo+ICAgCQkJZ290byBlcnI7Cj4gICAJCX0KPiAgIAo+ICAgCQljbGllbnRbaV0uY3R4ID0gYzsK
PiArCQlpOTE1X3ZtX3B1dCh2bSk7Cj4gICAJfQo+ICAgCj4gICAJZm9yX2VhY2hfZW5naW5lKGVu
Z2luZSwgaTkxNSwgaWQpIHsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0
L3NjaGVkdWxlci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCj4gaW5k
ZXggMDNmNTY3MDg0NTQ4Li42ODUwZjFmNDAyNDEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0
L3NjaGVkdWxlci5jCj4gQEAgLTM2NSw3ICszNjUsOCBAQCBzdGF0aWMgdm9pZCBzZXRfY29udGV4
dF9wcGd0dF9mcm9tX3NoYWRvdyhzdHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xvYWQs
Cj4gICAJCQkJCSAgc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKPiAgIHsKPiAgIAlzdHJ1
Y3QgaW50ZWxfdmdwdV9tbSAqbW0gPSB3b3JrbG9hZC0+c2hhZG93X21tOwo+IC0Jc3RydWN0IGk5
MTVfcHBndHQgKnBwZ3R0ID0gaTkxNV92bV90b19wcGd0dChjdHgtPnZtKTsKPiArCXN0cnVjdCBp
OTE1X3BwZ3R0ICpwcGd0dCA9Cj4gKwkJaTkxNV92bV90b19wcGd0dChpOTE1X2dlbV9jb250ZXh0
X2dldF92bV9yY3UoY3R4KSk7Cj4gICAJaW50IGkgPSAwOwo+ICAgCj4gICAJaWYgKG1tLT5wcGd0
dF9tbS5yb290X2VudHJ5X3R5cGUgPT0gR1RUX1RZUEVfUFBHVFRfUk9PVF9MNF9FTlRSWSkgewo+
IEBAIC0zNzgsNiArMzc5LDggQEAgc3RhdGljIHZvaWQgc2V0X2NvbnRleHRfcHBndHRfZnJvbV9z
aGFkb3coc3RydWN0IGludGVsX3ZncHVfd29ya2xvYWQgKndvcmtsb2FkLAo+ICAgCQkJcHhfZG1h
KHBkKSA9IG1tLT5wcGd0dF9tbS5zaGFkb3dfcGRwc1tpXTsKPiAgIAkJfQo+ICAgCX0KPiArCj4g
KwlpOTE1X3ZtX3B1dCgmcHBndHQtPnZtKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGludAo+IEBA
IC0xMjMwLDIwICsxMjMzLDE4IEBAIGludCBpbnRlbF92Z3B1X3NldHVwX3N1Ym1pc3Npb24oc3Ry
dWN0IGludGVsX3ZncHUgKnZncHUpCj4gICAJc3RydWN0IGludGVsX3ZncHVfc3VibWlzc2lvbiAq
cyA9ICZ2Z3B1LT5zdWJtaXNzaW9uOwo+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZTsKPiAgIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4Owo+ICsJc3RydWN0IGk5MTVfcHBn
dHQgKnBwZ3R0Owo+ICAgCWVudW0gaW50ZWxfZW5naW5lX2lkIGk7Cj4gICAJaW50IHJldDsKPiAg
IAo+IC0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gLQo+ICAgCWN0eCA9
IGk5MTVfZ2VtX2NvbnRleHRfY3JlYXRlX2tlcm5lbChpOTE1LCBJOTE1X1BSSU9SSVRZX01BWCk7
Cj4gLQlpZiAoSVNfRVJSKGN0eCkpIHsKPiAtCQlyZXQgPSBQVFJfRVJSKGN0eCk7Cj4gLQkJZ290
byBvdXRfdW5sb2NrOwo+IC0JfQo+ICsJaWYgKElTX0VSUihjdHgpKQo+ICsJCXJldHVybiBQVFJf
RVJSKGN0eCk7Cj4gICAKPiAgIAlpOTE1X2dlbV9jb250ZXh0X3NldF9mb3JjZV9zaW5nbGVfc3Vi
bWlzc2lvbihjdHgpOwo+ICAgCj4gLQlpOTE1X2NvbnRleHRfcHBndHRfcm9vdF9zYXZlKHMsIGk5
MTVfdm1fdG9fcHBndHQoY3R4LT52bSkpOwo+ICsJcHBndHQgPSBpOTE1X3ZtX3RvX3BwZ3R0KGk5
MTVfZ2VtX2NvbnRleHRfZ2V0X3ZtX3JjdShjdHgpKTsKPiArCWk5MTVfY29udGV4dF9wcGd0dF9y
b290X3NhdmUocywgcHBndHQpOwo+ICAgCj4gICAJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkx
NSwgaSkgewo+ICAgCQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7Cj4gQEAgLTEyODgsMTIgKzEy
ODksMTIgQEAgaW50IGludGVsX3ZncHVfc2V0dXBfc3VibWlzc2lvbihzdHJ1Y3QgaW50ZWxfdmdw
dSAqdmdwdSkKPiAgIAlhdG9taWNfc2V0KCZzLT5ydW5uaW5nX3dvcmtsb2FkX251bSwgMCk7Cj4g
ICAJYml0bWFwX3plcm8ocy0+dGxiX2hhbmRsZV9wZW5kaW5nLCBJOTE1X05VTV9FTkdJTkVTKTsK
PiAgIAo+ICsJaTkxNV92bV9wdXQoJnBwZ3R0LT52bSk7Cj4gICAJaTkxNV9nZW1fY29udGV4dF9w
dXQoY3R4KTsKPiAtCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAJ
cmV0dXJuIDA7Cj4gICAKPiAgIG91dF9zaGFkb3dfY3R4Ogo+IC0JaTkxNV9jb250ZXh0X3BwZ3R0
X3Jvb3RfcmVzdG9yZShzLCBpOTE1X3ZtX3RvX3BwZ3R0KGN0eC0+dm0pKTsKPiArCWk5MTVfY29u
dGV4dF9wcGd0dF9yb290X3Jlc3RvcmUocywgcHBndHQpOwo+ICAgCWZvcl9lYWNoX2VuZ2luZShl
bmdpbmUsIGk5MTUsIGkpIHsKPiAgIAkJaWYgKElTX0VSUihzLT5zaGFkb3dbaV0pKQo+ICAgCQkJ
YnJlYWs7Cj4gQEAgLTEzMDEsOSArMTMwMiw4IEBAIGludCBpbnRlbF92Z3B1X3NldHVwX3N1Ym1p
c3Npb24oc3RydWN0IGludGVsX3ZncHUgKnZncHUpCj4gICAJCWludGVsX2NvbnRleHRfdW5waW4o
cy0+c2hhZG93W2ldKTsKPiAgIAkJaW50ZWxfY29udGV4dF9wdXQocy0+c2hhZG93W2ldKTsKPiAg
IAl9Cj4gKwlpOTE1X3ZtX3B1dCgmcHBndHQtPnZtKTsKPiAgIAlpOTE1X2dlbV9jb250ZXh0X3B1
dChjdHgpOwo+IC1vdXRfdW5sb2NrOgo+IC0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0
X211dGV4KTsKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+ICAgCj4gZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kZWJ1Z2ZzLmMKPiBpbmRleCAwZTkwYWM2MDhlMDcuLmIwNGNlYmMyNmVjYSAxMDA2NDQKPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwo+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCj4gQEAgLTMxNiwxMiArMzE2LDE4IEBAIHN0YXRp
YyB2b2lkIHByaW50X2NvbnRleHRfc3RhdHMoc3RydWN0IHNlcV9maWxlICptLAo+ICAgCQkJCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXN0cnVjdCBmaWxlX3N0YXRz
IGtzdGF0cyA9IHt9Owo+IC0Jc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eDsKPiArCXN0cnVj
dCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsICpjbjsKPiAgIAo+IC0JbGlzdF9mb3JfZWFjaF9lbnRy
eShjdHgsICZpOTE1LT5jb250ZXh0cy5saXN0LCBsaW5rKSB7Cj4gKwlzcGluX2xvY2soJmk5MTUt
PmdlbS5jb250ZXh0cy5sb2NrKTsKPiArCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShjdHgsIGNu
LCAmaTkxNS0+Z2VtLmNvbnRleHRzLmxpc3QsIGxpbmspIHsKPiAgIAkJc3RydWN0IGk5MTVfZ2Vt
X2VuZ2luZXNfaXRlciBpdDsKPiAgIAkJc3RydWN0IGludGVsX2NvbnRleHQgKmNlOwo+ICAgCj4g
KwkJaWYgKCFrcmVmX2dldF91bmxlc3NfemVybygmY3R4LT5yZWYpKQo+ICsJCQljb250aW51ZTsK
PiArCj4gKwkJc3Bpbl91bmxvY2soJmk5MTUtPmdlbS5jb250ZXh0cy5sb2NrKTsKPiArCj4gICAJ
CWZvcl9lYWNoX2dlbV9lbmdpbmUoY2UsCj4gICAJCQkJICAgIGk5MTVfZ2VtX2NvbnRleHRfbG9j
a19lbmdpbmVzKGN0eCksIGl0KSB7Cj4gICAJCQlpbnRlbF9jb250ZXh0X2xvY2tfcGlubmVkKGNl
KTsKPiBAQCAtMzM4LDcgKzM0NCw5IEBAIHN0YXRpYyB2b2lkIHByaW50X2NvbnRleHRfc3RhdHMo
c3RydWN0IHNlcV9maWxlICptLAo+ICAgCQlpOTE1X2dlbV9jb250ZXh0X3VubG9ja19lbmdpbmVz
KGN0eCk7Cj4gICAKPiAgIAkJaWYgKCFJU19FUlJfT1JfTlVMTChjdHgtPmZpbGVfcHJpdikpIHsK
PiAtCQkJc3RydWN0IGZpbGVfc3RhdHMgc3RhdHMgPSB7IC52bSA9IGN0eC0+dm0sIH07Cj4gKwkJ
CXN0cnVjdCBmaWxlX3N0YXRzIHN0YXRzID0gewo+ICsJCQkJLnZtID0gcmN1X2FjY2Vzc19wb2lu
dGVyKGN0eC0+dm0pLAo+ICsJCQl9Owo+ICAgCQkJc3RydWN0IGRybV9maWxlICpmaWxlID0gY3R4
LT5maWxlX3ByaXYtPmZpbGU7Cj4gICAJCQlzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2s7Cj4gICAJ
CQljaGFyIG5hbWVbODBdOwo+IEBAIC0zNTUsNyArMzYzLDEyIEBAIHN0YXRpYyB2b2lkIHByaW50
X2NvbnRleHRfc3RhdHMoc3RydWN0IHNlcV9maWxlICptLAo+ICAgCj4gICAJCQlwcmludF9maWxl
X3N0YXRzKG0sIG5hbWUsIHN0YXRzKTsKPiAgIAkJfQo+ICsKPiArCQlzcGluX2xvY2soJmk5MTUt
PmdlbS5jb250ZXh0cy5sb2NrKTsKPiArCQlsaXN0X3NhZmVfcmVzZXRfbmV4dChjdHgsIGNuLCBs
aW5rKTsKPiArCQlpOTE1X2dlbV9jb250ZXh0X3B1dChjdHgpOwo+ICAgCX0KPiArCXNwaW5fdW5s
b2NrKCZpOTE1LT5nZW0uY29udGV4dHMubG9jayk7Cj4gICAKPiAgIAlwcmludF9maWxlX3N0YXRz
KG0sICJba11jb250ZXh0cyIsIGtzdGF0cyk7Cj4gICB9Cj4gQEAgLTM2Myw3ICszNzYsNiBAQCBz
dGF0aWMgdm9pZCBwcmludF9jb250ZXh0X3N0YXRzKHN0cnVjdCBzZXFfZmlsZSAqbSwKPiAgIHN0
YXRpYyBpbnQgaTkxNV9nZW1fb2JqZWN0X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpk
YXRhKQo+ICAgewo+ICAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19p
OTE1KG0tPnByaXZhdGUpOwo+IC0JaW50IHJldDsKPiAgIAo+ICAgCXNlcV9wcmludGYobSwgIiV1
IHNocmlua2FibGUgWyV1IGZyZWVdIG9iamVjdHMsICVsbHUgYnl0ZXNcbiIsCj4gICAJCSAgIGk5
MTUtPm1tLnNocmlua19jb3VudCwKPiBAQCAtMzcyLDEyICszODQsNyBAQCBzdGF0aWMgaW50IGk5
MTVfZ2VtX29iamVjdF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiAgIAo+
ICAgCXNlcV9wdXRjKG0sICdcbicpOwo+ICAgCj4gLQlyZXQgPSBtdXRleF9sb2NrX2ludGVycnVw
dGlibGUoJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+IC0JaWYgKHJldCkKPiAtCQlyZXR1cm4g
cmV0Owo+IC0KPiAgIAlwcmludF9jb250ZXh0X3N0YXRzKG0sIGk5MTUpOwo+IC0JbXV0ZXhfdW5s
b2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAo+ICAgCXJldHVybiAwOwo+ICAgfQo+
IEBAIC0xNTc5LDE5ICsxNTg2LDE5IEBAIHN0YXRpYyB2b2lkIGRlc2NyaWJlX2N0eF9yaW5nKHN0
cnVjdCBzZXFfZmlsZSAqbSwgc3RydWN0IGludGVsX3JpbmcgKnJpbmcpCj4gICAKPiAgIHN0YXRp
YyBpbnQgaTkxNV9jb250ZXh0X3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNl
ZCkKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9f
aTkxNShtLT5wcml2YXRlKTsKPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYt
PmRybTsKPiAtCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7Cj4gLQlpbnQgcmV0Owo+IC0K
PiAtCXJldCA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmZGV2LT5zdHJ1Y3RfbXV0ZXgpOwo+
IC0JaWYgKHJldCkKPiAtCQlyZXR1cm4gcmV0Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gKwlzdHJ1Y3QgaTkxNV9nZW1fY29u
dGV4dCAqY3R4LCAqY247Cj4gICAKPiAtCWxpc3RfZm9yX2VhY2hfZW50cnkoY3R4LCAmZGV2X3By
aXYtPmNvbnRleHRzLmxpc3QsIGxpbmspIHsKPiArCXNwaW5fbG9jaygmaTkxNS0+Z2VtLmNvbnRl
eHRzLmxvY2spOwo+ICsJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKGN0eCwgY24sICZpOTE1LT5n
ZW0uY29udGV4dHMubGlzdCwgbGluaykgewo+ICAgCQlzdHJ1Y3QgaTkxNV9nZW1fZW5naW5lc19p
dGVyIGl0Owo+ICAgCQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7Cj4gICAKPiArCQlpZiAoIWty
ZWZfZ2V0X3VubGVzc196ZXJvKCZjdHgtPnJlZikpCj4gKwkJCWNvbnRpbnVlOwo+ICsKPiArCQlz
cGluX3VubG9jaygmaTkxNS0+Z2VtLmNvbnRleHRzLmxvY2spOwo+ICsKPiAgIAkJc2VxX3B1dHMo
bSwgIkhXIGNvbnRleHQgIik7Cj4gICAJCWlmIChjdHgtPnBpZCkgewo+ICAgCQkJc3RydWN0IHRh
c2tfc3RydWN0ICp0YXNrOwo+IEBAIC0xNjI2LDkgKzE2MzMsMTIgQEAgc3RhdGljIGludCBpOTE1
X2NvbnRleHRfc3RhdHVzKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQo+ICAgCQlp
OTE1X2dlbV9jb250ZXh0X3VubG9ja19lbmdpbmVzKGN0eCk7Cj4gICAKPiAgIAkJc2VxX3B1dGMo
bSwgJ1xuJyk7Cj4gLQl9Cj4gICAKPiAtCW11dGV4X3VubG9jaygmZGV2LT5zdHJ1Y3RfbXV0ZXgp
Owo+ICsJCXNwaW5fbG9jaygmaTkxNS0+Z2VtLmNvbnRleHRzLmxvY2spOwo+ICsJCWxpc3Rfc2Fm
ZV9yZXNldF9uZXh0KGN0eCwgY24sIGxpbmspOwo+ICsJCWk5MTVfZ2VtX2NvbnRleHRfcHV0KGN0
eCk7Cj4gKwl9Cj4gKwlzcGluX3VubG9jaygmaTkxNS0+Z2VtLmNvbnRleHRzLmxvY2spOwo+ICAg
Cj4gICAJcmV0dXJuIDA7Cj4gICB9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCj4gaW5kZXggNTMy
M2U0ZmE1NWQ5Li4wMjRkYTU4MmJhMGYgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9kcnYuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKPiBA
QCAtMTY2NSwxMCArMTY2NSw4IEBAIHN0YXRpYyB2b2lkIGk5MTVfZHJpdmVyX3Bvc3RjbG9zZShz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpCj4gICB7Cj4gICAJ
c3RydWN0IGRybV9pOTE1X2ZpbGVfcHJpdmF0ZSAqZmlsZV9wcml2ID0gZmlsZS0+ZHJpdmVyX3By
aXY7Cj4gICAKPiAtCW11dGV4X2xvY2soJmRldi0+c3RydWN0X211dGV4KTsKPiAgIAlpOTE1X2dl
bV9jb250ZXh0X2Nsb3NlKGZpbGUpOwo+ICAgCWk5MTVfZ2VtX3JlbGVhc2UoZGV2LCBmaWxlKTsK
PiAtCW11dGV4X3VubG9jaygmZGV2LT5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCj4gICAJa2ZyZWVfcmN1
KGZpbGVfcHJpdiwgcmN1KTsKPiAgIAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2Rydi5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAo+IGluZGV4IDZi
ZGNmZmJmMWI5Yi4uMzViNjEwZDUyMzc5IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZHJ2LmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCj4g
QEAgLTE1MzYsMTMgKzE1MzYsNiBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSB7Cj4gICAJaW50
IGF1ZGlvX3Bvd2VyX3JlZmNvdW50Owo+ICAgCXUzMiBhdWRpb19mcmVxX2NudHJsOwo+ICAgCj4g
LQlzdHJ1Y3Qgewo+IC0JCXN0cnVjdCBtdXRleCBtdXRleDsKPiAtCQlzdHJ1Y3QgbGlzdF9oZWFk
IGxpc3Q7Cj4gLQkJc3RydWN0IGxsaXN0X2hlYWQgZnJlZV9saXN0Owo+IC0JCXN0cnVjdCB3b3Jr
X3N0cnVjdCBmcmVlX3dvcms7Cj4gLQl9IGNvbnRleHRzOwo+IC0KPiAgIAl1MzIgZmRpX3J4X2Nv
bmZpZzsKPiAgIAo+ICAgCS8qIFNoYWRvdyBmb3IgRElTUExBWV9QSFlfQ09OVFJPTCB3aGljaCBj
YW4ndCBiZSBzYWZlbHkgcmVhZCAqLwo+IEBAIC0xNjk4LDYgKzE2OTEsMTQgQEAgc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgewo+ICAgCj4gICAJc3RydWN0IHsKPiAgIAkJc3RydWN0IG5vdGlmaWVy
X2Jsb2NrIHBtX25vdGlmaWVyOwo+ICsKPiArCQlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dHMgewo+
ICsJCQlzcGlubG9ja190IGxvY2s7IC8qIGxvY2tzIGxpc3QgKi8KPiArCQkJc3RydWN0IGxpc3Rf
aGVhZCBsaXN0Owo+ICsKPiArCQkJc3RydWN0IGxsaXN0X2hlYWQgZnJlZV9saXN0Owo+ICsJCQlz
dHJ1Y3Qgd29ya19zdHJ1Y3QgZnJlZV93b3JrOwo+ICsJCX0gY29udGV4dHM7Cj4gICAJfSBnZW07
Cj4gICAKPiAgIAkvKiBGb3IgaTk0NWdtIHZibGFuayBpcnEgdnMuIEMzIHdvcmthcm91bmQgKi8K
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKPiBpbmRleCA1YTY2NGJkZWFkOGMuLmY2ZGI0MTU5ODVk
NSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCj4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwo+IEBAIC0xMjY2LDcgKzEyNjYsNyBAQCBp
bnQgaTkxNV9nZW1faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAJ
CWdvdG8gZXJyX3VubG9jazsKPiAgIAl9Cj4gICAKPiAtCXJldCA9IGk5MTVfZ2VtX2NvbnRleHRz
X2luaXQoZGV2X3ByaXYpOwo+ICsJcmV0ID0gaTkxNV9nZW1faW5pdF9jb250ZXh0cyhkZXZfcHJp
dik7Cj4gICAJaWYgKHJldCkgewo+ICAgCQlHRU1fQlVHX09OKHJldCA9PSAtRUlPKTsKPiAgIAkJ
Z290byBlcnJfc2NyYXRjaDsKPiBAQCAtMTM0OCw3ICsxMzQ4LDcgQEAgaW50IGk5MTVfZ2VtX2lu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgCX0KPiAgIGVycl9jb250
ZXh0Ogo+ICAgCWlmIChyZXQgIT0gLUVJTykKPiAtCQlpOTE1X2dlbV9jb250ZXh0c19maW5pKGRl
dl9wcml2KTsKPiArCQlpOTE1X2dlbV9kcml2ZXJfcmVsZWFzZV9fY29udGV4dHMoZGV2X3ByaXYp
Owo+ICAgZXJyX3NjcmF0Y2g6Cj4gICAJaW50ZWxfZ3RfZHJpdmVyX3JlbGVhc2UoJmRldl9wcml2
LT5ndCk7Cj4gICBlcnJfdW5sb2NrOgo+IEBAIC0xNDE2LDExICsxNDE2LDkgQEAgdm9pZCBpOTE1
X2dlbV9kcml2ZXJfcmVtb3ZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAg
IAo+ICAgdm9pZCBpOTE1X2dlbV9kcml2ZXJfcmVsZWFzZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gICB7Cj4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9t
dXRleCk7Cj4gICAJaW50ZWxfZW5naW5lc19jbGVhbnVwKGRldl9wcml2KTsKPiAtCWk5MTVfZ2Vt
X2NvbnRleHRzX2ZpbmkoZGV2X3ByaXYpOwo+ICsJaTkxNV9nZW1fZHJpdmVyX3JlbGVhc2VfX2Nv
bnRleHRzKGRldl9wcml2KTsKPiAgIAlpbnRlbF9ndF9kcml2ZXJfcmVsZWFzZSgmZGV2X3ByaXYt
Pmd0KTsKPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAg
Cj4gICAJaW50ZWxfd2FfbGlzdF9mcmVlKCZkZXZfcHJpdi0+Z3Rfd2FfbGlzdCk7Cj4gICAKPiBA
QCAtMTQzMCw3ICsxNDI4LDcgQEAgdm9pZCBpOTE1X2dlbV9kcml2ZXJfcmVsZWFzZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gICAKPiAgIAlpOTE1X2dlbV9kcmFpbl9mcmVl
ZF9vYmplY3RzKGRldl9wcml2KTsKPiAgIAo+IC0JV0FSTl9PTighbGlzdF9lbXB0eSgmZGV2X3By
aXYtPmNvbnRleHRzLmxpc3QpKTsKPiArCVdBUk5fT04oIWxpc3RfZW1wdHkoJmRldl9wcml2LT5n
ZW0uY29udGV4dHMubGlzdCkpOwo+ICAgfQo+ICAgCj4gICB2b2lkIGk5MTVfZ2VtX2luaXRfbW1p
byhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dl
bV9ndHQuYwo+IGluZGV4IDFkMjY2MzRjYTU5Ny4uN2IxNWJiODkxOTcwIDEwMDY0NAo+IC0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jCj4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMKPiBAQCAtMTM2Niw3ICsxMzY2LDkgQEAgc3RhdGljIGlu
dCBnZW44X2luaXRfc2NyYXRjaChzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSkKPiAgIAlp
ZiAodm0tPmhhc19yZWFkX29ubHkgJiYKPiAgIAkgICAgdm0tPmk5MTUtPmtlcm5lbF9jb250ZXh0
ICYmCj4gICAJICAgIHZtLT5pOTE1LT5rZXJuZWxfY29udGV4dC0+dm0pIHsKPiAtCQlzdHJ1Y3Qg
aTkxNV9hZGRyZXNzX3NwYWNlICpjbG9uZSA9IHZtLT5pOTE1LT5rZXJuZWxfY29udGV4dC0+dm07
Cj4gKwkJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqY2xvbmUgPQo+ICsJCQlyY3VfZGVyZWZl
cmVuY2VfcHJvdGVjdGVkKHZtLT5pOTE1LT5rZXJuZWxfY29udGV4dC0+dm0sCj4gKwkJCQkJCSAg
dHJ1ZSk7IC8qIHN0YXRpYyAqLwo+ICAgCj4gICAJCUdFTV9CVUdfT04oIWNsb25lLT5oYXNfcmVh
ZF9vbmx5KTsKPiAgIAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3Bl
cmYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5jCj4gaW5kZXggZWNmYmMzN2I3
MzhiLi4yMzEzODhkMDZjODIgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9wZXJmLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYwo+IEBAIC0x
ODUzLDggKzE4NTMsOCBAQCBzdGF0aWMgaW50IGdlbjhfY29uZmlndXJlX2FsbF9jb250ZXh0cyhz
dHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtLAo+ICAgCX07Cj4gICAjdW5kZWYgY3R4X2Zs
ZXhldU4KPiAgIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4gLQlzdHJ1Y3QgaTkx
NV9nZW1fY29udGV4dCAqY3R4Owo+IC0JaW50IGk7Cj4gKwlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4
dCAqY3R4LCAqY247Cj4gKwlpbnQgaSwgZXJyOwo+ICAgCj4gICAJZm9yIChpID0gMjsgaSA8IEFS
UkFZX1NJWkUocmVncyk7IGkrKykKPiAgIAkJcmVnc1tpXS52YWx1ZSA9IG9hX2NvbmZpZ19mbGV4
X3JlZyhvYV9jb25maWcsIHJlZ3NbaV0ucmVnKTsKPiBAQCAtMTg3NywxNiArMTg3NywyNyBAQCBz
dGF0aWMgaW50IGdlbjhfY29uZmlndXJlX2FsbF9jb250ZXh0cyhzdHJ1Y3QgaTkxNV9wZXJmX3N0
cmVhbSAqc3RyZWFtLAo+ICAgCSAqIGNvbnRleHQuIENvbnRleHRzIGlkbGUgYXQgdGhlIHRpbWUg
b2YgcmVjb25maWd1cmF0aW9uIGFyZSBub3QKPiAgIAkgKiB0cmFwcGVkIGJlaGluZCB0aGUgYmFy
cmllci4KPiAgIAkgKi8KPiAtCWxpc3RfZm9yX2VhY2hfZW50cnkoY3R4LCAmaTkxNS0+Y29udGV4
dHMubGlzdCwgbGluaykgewo+IC0JCWludCBlcnI7Cj4gLQo+ICsJc3Bpbl9sb2NrKCZpOTE1LT5n
ZW0uY29udGV4dHMubG9jayk7Cj4gKwlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUoY3R4LCBjbiwg
Jmk5MTUtPmdlbS5jb250ZXh0cy5saXN0LCBsaW5rKSB7Cj4gICAJCWlmIChjdHggPT0gaTkxNS0+
a2VybmVsX2NvbnRleHQpCj4gICAJCQljb250aW51ZTsKPiAgIAo+ICsJCWlmICgha3JlZl9nZXRf
dW5sZXNzX3plcm8oJmN0eC0+cmVmKSkKPiArCQkJY29udGludWU7Cj4gKwo+ICsJCXNwaW5fdW5s
b2NrKCZpOTE1LT5nZW0uY29udGV4dHMubG9jayk7Cj4gKwo+ICAgCQllcnIgPSBnZW44X2NvbmZp
Z3VyZV9jb250ZXh0KGN0eCwgcmVncywgQVJSQVlfU0laRShyZWdzKSk7Cj4gLQkJaWYgKGVycikK
PiArCQlpZiAoZXJyKSB7Cj4gKwkJCWk5MTVfZ2VtX2NvbnRleHRfcHV0KGN0eCk7Cj4gICAJCQly
ZXR1cm4gZXJyOwo+ICsJCX0KPiArCj4gKwkJc3Bpbl9sb2NrKCZpOTE1LT5nZW0uY29udGV4dHMu
bG9jayk7Cj4gKwkJbGlzdF9zYWZlX3Jlc2V0X25leHQoY3R4LCBjbiwgbGluayk7Cj4gKwkJaTkx
NV9nZW1fY29udGV4dF9wdXQoY3R4KTsKPiAgIAl9Cj4gKwlzcGluX3VubG9jaygmaTkxNS0+Z2Vt
LmNvbnRleHRzLmxvY2spOwo+ICAgCj4gICAJLyoKPiAgIAkgKiBBZnRlciB1cGRhdGluZyBhbGwg
b3RoZXIgY29udGV4dHMsIHdlIG5lZWQgdG8gbW9kaWZ5IG91cnNlbHZlcy4KPiBAQCAtMTg5NSw3
ICsxOTA2LDYgQEAgc3RhdGljIGludCBnZW44X2NvbmZpZ3VyZV9hbGxfY29udGV4dHMoc3RydWN0
IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSwKPiAgIAkgKi8KPiAgIAlmb3JfZWFjaF91YWJpX2Vu
Z2luZShlbmdpbmUsIGk5MTUpIHsKPiAgIAkJc3RydWN0IGludGVsX2NvbnRleHQgKmNlID0gZW5n
aW5lLT5rZXJuZWxfY29udGV4dDsKPiAtCQlpbnQgZXJyOwo+ICAgCj4gICAJCWlmIChlbmdpbmUt
PmNsYXNzICE9IFJFTkRFUl9DTEFTUykKPiAgIAkJCWNvbnRpbnVlOwo+IGRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3N5c2ZzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3N5c2ZzLmMKPiBpbmRleCAxZTA4YzU5NjE1MzUuLmJmMDM5YjhiYTU5MyAxMDA2NDQKPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3N5c2ZzLmMKPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3N5c2ZzLmMKPiBAQCAtMTc2LDE2ICsxNzYsMTIgQEAgaTkxNV9sM19y
ZWFkKHN0cnVjdCBmaWxlICpmaWxwLCBzdHJ1Y3Qga29iamVjdCAqa29iaiwKPiAgIAljb3VudCA9
IG1pbl90KHNpemVfdCwgR0VON19MM0xPR19TSVpFIC0gb2Zmc2V0LCBjb3VudCk7Cj4gICAJbWVt
c2V0KGJ1ZiwgMCwgY291bnQpOwo+ICAgCj4gLQlyZXQgPSBpOTE1X211dGV4X2xvY2tfaW50ZXJy
dXB0aWJsZSgmaTkxNS0+ZHJtKTsKPiAtCWlmIChyZXQpCj4gLQkJcmV0dXJuIHJldDsKPiAtCj4g
KwlzcGluX2xvY2soJmk5MTUtPmdlbS5jb250ZXh0cy5sb2NrKTsKPiAgIAlpZiAoaTkxNS0+bDNf
cGFyaXR5LnJlbWFwX2luZm9bc2xpY2VdKQo+ICAgCQltZW1jcHkoYnVmLAo+ICAgCQkgICAgICAg
aTkxNS0+bDNfcGFyaXR5LnJlbWFwX2luZm9bc2xpY2VdICsgb2Zmc2V0IC8gc2l6ZW9mKHUzMiks
Cj4gICAJCSAgICAgICBjb3VudCk7Cj4gLQo+IC0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3Ry
dWN0X211dGV4KTsKPiArCXNwaW5fdW5sb2NrKCZpOTE1LT5nZW0uY29udGV4dHMubG9jayk7Cj4g
ICAKPiAgIAlyZXR1cm4gY291bnQ7Cj4gICB9Cj4gQEAgLTE5OCw4ICsxOTQsOCBAQCBpOTE1X2wz
X3dyaXRlKHN0cnVjdCBmaWxlICpmaWxwLCBzdHJ1Y3Qga29iamVjdCAqa29iaiwKPiAgIAlzdHJ1
Y3QgZGV2aWNlICprZGV2ID0ga29ial90b19kZXYoa29iaik7Cj4gICAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7Cj4gICAJaW50IHNsaWNl
ID0gKGludCkodWludHB0cl90KWF0dHItPnByaXZhdGU7Cj4gKwl1MzIgKnJlbWFwX2luZm8sICpm
cmVlbWUgPSBOVUxMOwo+ICAgCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7Cj4gLQl1MzIg
KipyZW1hcF9pbmZvOwo+ICAgCWludCByZXQ7Cj4gICAKPiAgIAlyZXQgPSBsM19hY2Nlc3NfdmFs
aWQoaTkxNSwgb2Zmc2V0KTsKPiBAQCAtMjA5LDM3ICsyMDUsMzYgQEAgaTkxNV9sM193cml0ZShz
dHJ1Y3QgZmlsZSAqZmlscCwgc3RydWN0IGtvYmplY3QgKmtvYmosCj4gICAJaWYgKGNvdW50IDwg
c2l6ZW9mKHUzMikpCj4gICAJCXJldHVybiAtRUlOVkFMOwo+ICAgCj4gLQlyZXQgPSBpOTE1X211
dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmaTkxNS0+ZHJtKTsKPiAtCWlmIChyZXQpCj4gLQkJcmV0
dXJuIHJldDsKPiArCXJlbWFwX2luZm8gPSBremFsbG9jKEdFTjdfTDNMT0dfU0laRSwgR0ZQX0tF
Uk5FTCk7Cj4gKwlpZiAoIXJlbWFwX2luZm8pCj4gKwkJcmV0dXJuIC1FTk9NRU07Cj4gICAKPiAt
CXJlbWFwX2luZm8gPSAmaTkxNS0+bDNfcGFyaXR5LnJlbWFwX2luZm9bc2xpY2VdOwo+IC0JaWYg
KCEqcmVtYXBfaW5mbykgewo+IC0JCSpyZW1hcF9pbmZvID0ga3phbGxvYyhHRU43X0wzTE9HX1NJ
WkUsIEdGUF9LRVJORUwpOwo+IC0JCWlmICghKnJlbWFwX2luZm8pIHsKPiAtCQkJcmV0ID0gLUVO
T01FTTsKPiAtCQkJZ290byBvdXQ7Cj4gLQkJfQo+ICsJc3Bpbl9sb2NrKCZpOTE1LT5nZW0uY29u
dGV4dHMubG9jayk7Cj4gKwo+ICsJaWYgKGk5MTUtPmwzX3Bhcml0eS5yZW1hcF9pbmZvW3NsaWNl
XSkgewo+ICsJCWZyZWVtZSA9IHJlbWFwX2luZm87Cj4gKwkJcmVtYXBfaW5mbyA9IGk5MTUtPmwz
X3Bhcml0eS5yZW1hcF9pbmZvW3NsaWNlXTsKPiArCX0gZWxzZSB7Cj4gKwkJaTkxNS0+bDNfcGFy
aXR5LnJlbWFwX2luZm9bc2xpY2VdID0gcmVtYXBfaW5mbzsKPiAgIAl9Cj4gICAKPiAgIAljb3Vu
dCA9IHJvdW5kX2Rvd24oY291bnQsIHNpemVvZih1MzIpKTsKPiAtCW1lbWNweSgqcmVtYXBfaW5m
byArIG9mZnNldCAvIHNpemVvZih1MzIpLCBidWYsIGNvdW50KTsKPiArCW1lbWNweShyZW1hcF9p
bmZvICsgb2Zmc2V0IC8gc2l6ZW9mKHUzMiksIGJ1ZiwgY291bnQpOwo+ICAgCj4gICAJLyogTkI6
IFdlIGRlZmVyIHRoZSByZW1hcHBpbmcgdW50aWwgd2Ugc3dpdGNoIHRvIHRoZSBjb250ZXh0ICov
Cj4gLQlsaXN0X2Zvcl9lYWNoX2VudHJ5KGN0eCwgJmk5MTUtPmNvbnRleHRzLmxpc3QsIGxpbmsp
Cj4gKwlsaXN0X2Zvcl9lYWNoX2VudHJ5KGN0eCwgJmk5MTUtPmdlbS5jb250ZXh0cy5saXN0LCBs
aW5rKQo+ICAgCQljdHgtPnJlbWFwX3NsaWNlIHw9IEJJVChzbGljZSk7Cj4gICAKPiArCXNwaW5f
dW5sb2NrKCZpOTE1LT5nZW0uY29udGV4dHMubG9jayk7Cj4gKwlrZnJlZShmcmVlbWUpOwo+ICsK
PiAgIAkvKgo+ICAgCSAqIFRPRE86IElkZWFsbHkgd2UgcmVhbGx5IHdhbnQgYSBHUFUgcmVzZXQg
aGVyZSB0byBtYWtlIHN1cmUgZXJyb3JzCj4gICAJICogYXJlbid0IHByb3BhZ2F0ZWQuIFNpbmNl
IEkgY2Fubm90IGZpbmQgYSBzdGFibGUgd2F5IHRvIHJlc2V0IHRoZSBHUFUKPiAgIAkgKiBhdCB0
aGlzIHBvaW50IGl0IGlzIGxlZnQgYXMgYSBUT0RPLgo+ICAgCSovCj4gICAKPiAtCXJldCA9IGNv
dW50Owo+IC1vdXQ6Cj4gLQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+
IC0KPiAtCXJldHVybiByZXQ7Cj4gKwlyZXR1cm4gY291bnQ7Cj4gICB9Cj4gICAKPiAgIHN0YXRp
YyBjb25zdCBzdHJ1Y3QgYmluX2F0dHJpYnV0ZSBkcGZfYXR0cnMgPSB7Cj4gZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdHJhY2UuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfdHJhY2UuaAo+IGluZGV4IDFmMmNmNmNmYWZiNS4uN2VmN2ExZTE2NjRjIDEwMDY0NAo+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdHJhY2UuaAo+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfdHJhY2UuaAo+IEBAIC05NTIsNyArOTUyLDcgQEAgREVDTEFSRV9F
VkVOVF9DTEFTUyhpOTE1X2NvbnRleHQsCj4gICAJVFBfZmFzdF9hc3NpZ24oCj4gICAJCQlfX2Vu
dHJ5LT5kZXYgPSBjdHgtPmk5MTUtPmRybS5wcmltYXJ5LT5pbmRleDsKPiAgIAkJCV9fZW50cnkt
PmN0eCA9IGN0eDsKPiAtCQkJX19lbnRyeS0+dm0gPSBjdHgtPnZtOwo+ICsJCQlfX2VudHJ5LT52
bSA9IHJjdV9hY2Nlc3NfcG9pbnRlcihjdHgtPnZtKTsKPiAgIAkpLAo+ICAgCj4gICAJVFBfcHJp
bnRrKCJkZXY9JXUsIGN0eD0lcCwgY3R4X3ZtPSVwIiwKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9z
ZWxmdGVzdHMvaTkxNV9nZW0uYwo+IGluZGV4IDAzNDZjM2U1YjZiNi4uYmZhNDBhNWI2ZDk4IDEw
MDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbS5jCj4g
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtLmMKPiBAQCAtMTM4
LDExICsxMzgsOSBAQCBzdGF0aWMgaW50IGlndF9nZW1fc3VzcGVuZCh2b2lkICphcmcpCj4gICAJ
CXJldHVybiBQVFJfRVJSKGZpbGUpOwo+ICAgCj4gICAJZXJyID0gLUVOT01FTTsKPiAtCW11dGV4
X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCWN0eCA9IGxpdmVfY29udGV4dChp
OTE1LCBmaWxlKTsKPiAgIAlpZiAoIUlTX0VSUihjdHgpKQo+ICAgCQllcnIgPSBzd2l0Y2hfdG9f
Y29udGV4dChpOTE1LCBjdHgpOwo+IC0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211
dGV4KTsKPiAgIAlpZiAoZXJyKQo+ICAgCQlnb3RvIG91dDsKPiAgIAo+IEBAIC0xNTcsOSArMTU1
LDcgQEAgc3RhdGljIGludCBpZ3RfZ2VtX3N1c3BlbmQodm9pZCAqYXJnKQo+ICAgCj4gICAJcG1f
cmVzdW1lKGk5MTUpOwo+ICAgCj4gLQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4
KTsKPiAgIAllcnIgPSBzd2l0Y2hfdG9fY29udGV4dChpOTE1LCBjdHgpOwo+IC0JbXV0ZXhfdW5s
b2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIG91dDoKPiAgIAltb2NrX2ZpbGVfZnJl
ZShpOTE1LCBmaWxlKTsKPiAgIAlyZXR1cm4gZXJyOwo+IEBAIC0xNzcsMTEgKzE3Myw5IEBAIHN0
YXRpYyBpbnQgaWd0X2dlbV9oaWJlcm5hdGUodm9pZCAqYXJnKQo+ICAgCQlyZXR1cm4gUFRSX0VS
UihmaWxlKTsKPiAgIAo+ICAgCWVyciA9IC1FTk9NRU07Cj4gLQltdXRleF9sb2NrKCZpOTE1LT5k
cm0uc3RydWN0X211dGV4KTsKPiAgIAljdHggPSBsaXZlX2NvbnRleHQoaTkxNSwgZmlsZSk7Cj4g
ICAJaWYgKCFJU19FUlIoY3R4KSkKPiAgIAkJZXJyID0gc3dpdGNoX3RvX2NvbnRleHQoaTkxNSwg
Y3R4KTsKPiAtCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAJaWYg
KGVycikKPiAgIAkJZ290byBvdXQ7Cj4gICAKPiBAQCAtMTk2LDkgKzE5MCw3IEBAIHN0YXRpYyBp
bnQgaWd0X2dlbV9oaWJlcm5hdGUodm9pZCAqYXJnKQo+ICAgCj4gICAJcG1fcmVzdW1lKGk5MTUp
Owo+ICAgCj4gLQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAllcnIg
PSBzd2l0Y2hfdG9fY29udGV4dChpOTE1LCBjdHgpOwo+IC0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5k
cm0uc3RydWN0X211dGV4KTsKPiAgIG91dDoKPiAgIAltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxl
KTsKPiAgIAlyZXR1cm4gZXJyOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9z
ZWxmdGVzdHMvaTkxNV9nZW1fZXZpY3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0
cy9pOTE1X2dlbV9ldmljdC5jCj4gaW5kZXggZjM5ZjAyODJlNzhjLi4wYWY5YTU4ZDAxMWQgMTAw
NjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2V2aWN0
LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZXZpY3Qu
Ywo+IEBAIC00NzMsNyArNDczLDYgQEAgc3RhdGljIGludCBpZ3RfZXZpY3RfY29udGV4dHModm9p
ZCAqYXJnKQo+ICAgCQl9Cj4gICAKPiAgIAkJY291bnQgPSAwOwo+IC0JCW11dGV4X2xvY2soJmk5
MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCQlvbnN0YWNrX2ZlbmNlX2luaXQoJmZlbmNlKTsK
PiAgIAkJZG8gewo+ICAgCQkJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7Cj4gQEAgLTUxMCw4ICs1
MDksNiBAQCBzdGF0aWMgaW50IGlndF9ldmljdF9jb250ZXh0cyh2b2lkICphcmcpCj4gICAJCQlj
b3VudCsrOwo+ICAgCQkJZXJyID0gMDsKPiAgIAkJfSB3aGlsZSgxKTsKPiAtCQltdXRleF91bmxv
Y2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+IC0KPiAgIAkJb25zdGFja19mZW5jZV9maW5p
KCZmZW5jZSk7Cj4gICAJCXByX2luZm8oIlN1Ym1pdHRlZCAlbHUgY29udGV4dHMvcmVxdWVzdHMg
b24gJXNcbiIsCj4gICAJCQljb3VudCwgZW5naW5lLT5uYW1lKTsKPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jCj4gaW5kZXggZTQwZTZjZmE1MWYxLi44
ZDgxMjFjMDIxNjEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3Rz
L2k5MTVfZ2VtX2d0dC5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5
MTVfZ2VtX2d0dC5jCj4gQEAgLTEyNDYsNiArMTI0Niw3IEBAIHN0YXRpYyBpbnQgZXhlcmNpc2Vf
bW9jayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgICAgIHVuc2lnbmVk
IGxvbmcgZW5kX3RpbWUpKQo+ICAgewo+ICAgCWNvbnN0IHU2NCBsaW1pdCA9IHRvdGFscmFtX3Bh
Z2VzKCkgPDwgUEFHRV9TSElGVDsKPiArCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtOwo+
ICAgCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7Cj4gICAJSUdUX1RJTUVPVVQoZW5kX3Rp
bWUpOwo+ICAgCWludCBlcnI7Cj4gQEAgLTEyNTQsNyArMTI1NSw5IEBAIHN0YXRpYyBpbnQgZXhl
cmNpc2VfbW9jayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAlpZiAoIWN0eCkK
PiAgIAkJcmV0dXJuIC1FTk9NRU07Cj4gICAKPiAtCWVyciA9IGZ1bmMoaTkxNSwgY3R4LT52bSwg
MCwgbWluKGN0eC0+dm0tPnRvdGFsLCBsaW1pdCksIGVuZF90aW1lKTsKPiArCXZtID0gaTkxNV9n
ZW1fY29udGV4dF9nZXRfdm1fcmN1KGN0eCk7Cj4gKwllcnIgPSBmdW5jKGk5MTUsIHZtLCAwLCBt
aW4odm0tPnRvdGFsLCBsaW1pdCksIGVuZF90aW1lKTsKPiArCWk5MTVfdm1fcHV0KHZtKTsKPiAg
IAo+ICAgCW1vY2tfY29udGV4dF9jbG9zZShjdHgpOwo+ICAgCXJldHVybiBlcnI7Cj4gQEAgLTE4
MDEsMTUgKzE4MDQsMTUgQEAgc3RhdGljIGludCBpZ3RfY3NfdGxiKHZvaWQgKmFyZykKPiAgIAkJ
Z290byBvdXRfdW5sb2NrOwo+ICAgCX0KPiAgIAo+IC0Jdm0gPSBjdHgtPnZtOwo+IC0JaWYgKCF2
bSkKPiAtCQlnb3RvIG91dF91bmxvY2s7Cj4gKwl2bSA9IGk5MTVfZ2VtX2NvbnRleHRfZ2V0X3Zt
X3JjdShjdHgpOwo+ICsJaWYgKGk5MTVfaXNfZ2d0dCh2bSkpCj4gKwkJZ290byBvdXRfdm07Cj4g
ICAKPiAgIAkvKiBDcmVhdGUgdHdvIHBhZ2VzOyBkdW1teSB3ZSBwcmVmaWxsIHRoZSBUTEIsIGFu
ZCBpbnRlbmRlZCAqLwo+ICAgCWJiZSA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfaW50ZXJuYWwo
aTkxNSwgUEFHRV9TSVpFKTsKPiAgIAlpZiAoSVNfRVJSKGJiZSkpIHsKPiAgIAkJZXJyID0gUFRS
X0VSUihiYmUpOwo+IC0JCWdvdG8gb3V0X3VubG9jazsKPiArCQlnb3RvIG91dF92bTsKPiAgIAl9
Cj4gICAKPiAgIAliYXRjaCA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKGJiZSwgSTkxNV9NQVBf
V0MpOwo+IEBAIC0yMDE0LDYgKzIwMTcsOCBAQCBzdGF0aWMgaW50IGlndF9jc190bGIodm9pZCAq
YXJnKQo+ICAgCWk5MTVfZ2VtX29iamVjdF9wdXQoYWN0KTsKPiAgIG91dF9wdXRfYmJlOgo+ICAg
CWk5MTVfZ2VtX29iamVjdF9wdXQoYmJlKTsKPiArb3V0X3ZtOgo+ICsJaTkxNV92bV9wdXQodm0p
Owo+ICAgb3V0X3VubG9jazoKPiAgIAltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwo+ICAgCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUpOwo+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9yZXF1ZXN0LmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9yZXF1ZXN0LmMKPiBpbmRleCBkN2Q2OGM2YTZiZDUuLjA4
OTdhN2IwNDk0NCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMv
aTkxNV9yZXF1ZXN0LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkx
NV9yZXF1ZXN0LmMKPiBAQCAtMTgxLDkgKzE4MSw3IEBAIHN0YXRpYyBpbnQgaWd0X3JlcXVlc3Rf
cmV3aW5kKHZvaWQgKmFyZykKPiAgIAlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7Cj4gICAJaW50
IGVyciA9IC1FSU5WQUw7Cj4gICAKPiAtCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwo+ICAgCWN0eFswXSA9IG1vY2tfY29udGV4dChpOTE1LCAiQSIpOwo+IC0JbXV0ZXhfdW5s
b2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAo+ICAgCWNlID0gaTkxNV9nZW1fY29u
dGV4dF9nZXRfZW5naW5lKGN0eFswXSwgUkNTMCk7Cj4gICAJR0VNX0JVR19PTihJU19FUlIoY2Up
KTsKPiBAQCAtMTk3LDkgKzE5NSw3IEBAIHN0YXRpYyBpbnQgaWd0X3JlcXVlc3RfcmV3aW5kKHZv
aWQgKmFyZykKPiAgIAlpOTE1X3JlcXVlc3RfZ2V0KHJlcXVlc3QpOwo+ICAgCWk5MTVfcmVxdWVz
dF9hZGQocmVxdWVzdCk7Cj4gICAKPiAtCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwo+ICAgCWN0eFsxXSA9IG1vY2tfY29udGV4dChpOTE1LCAiQiIpOwo+IC0JbXV0ZXhfdW5s
b2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAo+ICAgCWNlID0gaTkxNV9nZW1fY29u
dGV4dF9nZXRfZW5naW5lKGN0eFsxXSwgUkNTMCk7Cj4gICAJR0VNX0JVR19PTihJU19FUlIoY2Up
KTsKPiBAQCAtNDM4LDkgKzQzNCw3IEBAIHN0YXRpYyBpbnQgbW9ja19icmVhZGNydW1ic19zbW9r
ZXRlc3Qodm9pZCAqYXJnKQo+ICAgCX0KPiAgIAo+ICAgCWZvciAobiA9IDA7IG4gPCB0Lm5jb250
ZXh0czsgbisrKSB7Cj4gLQkJbXV0ZXhfbG9jaygmdC5lbmdpbmUtPmk5MTUtPmRybS5zdHJ1Y3Rf
bXV0ZXgpOwo+ICAgCQl0LmNvbnRleHRzW25dID0gbW9ja19jb250ZXh0KHQuZW5naW5lLT5pOTE1
LCAibW9jayIpOwo+IC0JCW11dGV4X3VubG9jaygmdC5lbmdpbmUtPmk5MTUtPmRybS5zdHJ1Y3Rf
bXV0ZXgpOwo+ICAgCQlpZiAoIXQuY29udGV4dHNbbl0pIHsKPiAgIAkJCXJldCA9IC1FTk9NRU07
Cj4gICAJCQlnb3RvIG91dF9jb250ZXh0czsKPiBAQCAtNzM0LDkgKzcyOCw5IEBAIHN0YXRpYyBp
bnQgbGl2ZV9lbXB0eV9yZXF1ZXN0KHZvaWQgKmFyZykKPiAgIHN0YXRpYyBzdHJ1Y3QgaTkxNV92
bWEgKnJlY3Vyc2l2ZV9iYXRjaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsK
PiAgIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4ID0gaTkxNS0+a2VybmVsX2NvbnRleHQ7
Cj4gLQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9IGN0eC0+dm0gPzogJmk5MTUtPmdn
dHQudm07Cj4gICAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKPiAgIAljb25zdCBp
bnQgZ2VuID0gSU5URUxfR0VOKGk5MTUpOwo+ICsJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAq
dm07Cj4gICAJc3RydWN0IGk5MTVfdm1hICp2bWE7Cj4gICAJdTMyICpjbWQ7Cj4gICAJaW50IGVy
cjsKPiBAQCAtNzQ1LDcgKzczOSw5IEBAIHN0YXRpYyBzdHJ1Y3QgaTkxNV92bWEgKnJlY3Vyc2l2
ZV9iYXRjaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIAlpZiAoSVNfRVJSKG9i
aikpCj4gICAJCXJldHVybiBFUlJfQ0FTVChvYmopOwo+ICAgCj4gKwl2bSA9IGk5MTVfZ2VtX2Nv
bnRleHRfZ2V0X3ZtX3JjdShjdHgpOwo+ICAgCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9iaiwg
dm0sIE5VTEwpOwo+ICsJaTkxNV92bV9wdXQodm0pOwo+ICAgCWlmIChJU19FUlIodm1hKSkgewo+
ICAgCQllcnIgPSBQVFJfRVJSKHZtYSk7Cj4gICAJCWdvdG8gZXJyOwo+IEBAIC0xMjIwLDkgKzEy
MTYsNyBAQCBzdGF0aWMgaW50IGxpdmVfYnJlYWRjcnVtYnNfc21va2V0ZXN0KHZvaWQgKmFyZykK
PiAgIAl9Cj4gICAKPiAgIAlmb3IgKG4gPSAwOyBuIDwgdFswXS5uY29udGV4dHM7IG4rKykgewo+
IC0JCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCQl0WzBdLmNvbnRl
eHRzW25dID0gbGl2ZV9jb250ZXh0KGk5MTUsIGZpbGUpOwo+IC0JCW11dGV4X3VubG9jaygmaTkx
NS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAJCWlmICghdFswXS5jb250ZXh0c1tuXSkgewo+ICAg
CQkJcmV0ID0gLUVOT01FTTsKPiAgIAkJCWdvdG8gb3V0X2NvbnRleHRzOwo+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV92bWEuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3ZtYS5jCj4gaW5kZXggYWMxZmY1NThlYjkwLi41OGI1
ZjQwYTA3ZGQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5
MTVfdm1hLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV92bWEu
Ywo+IEBAIC0yNCw2ICsyNCw3IEBACj4gICAKPiAgICNpbmNsdWRlIDxsaW51eC9wcmltZV9udW1i
ZXJzLmg+Cj4gICAKPiArI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9jb250ZXh0LmgiCj4gICAjaW5j
bHVkZSAiZ2VtL3NlbGZ0ZXN0cy9tb2NrX2NvbnRleHQuaCIKPiAgIAo+ICAgI2luY2x1ZGUgImk5
MTVfc2NhdHRlcmxpc3QuaCIKPiBAQCAtMzgsNyArMzksNyBAQCBzdGF0aWMgYm9vbCBhc3NlcnRf
dm1hKHN0cnVjdCBpOTE1X3ZtYSAqdm1hLAo+ICAgewo+ICAgCWJvb2wgb2sgPSB0cnVlOwo+ICAg
Cj4gLQlpZiAodm1hLT52bSAhPSBjdHgtPnZtKSB7Cj4gKwlpZiAodm1hLT52bSAhPSByY3VfYWNj
ZXNzX3BvaW50ZXIoY3R4LT52bSkpIHsKPiAgIAkJcHJfZXJyKCJWTUEgY3JlYXRlZCB3aXRoIHdy
b25nIFZNXG4iKTsKPiAgIAkJb2sgPSBmYWxzZTsKPiAgIAl9Cj4gQEAgLTExMywxMSArMTE0LDEz
IEBAIHN0YXRpYyBpbnQgY3JlYXRlX3ZtYXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gICAJbGlzdF9mb3JfZWFjaF9lbnRyeShvYmosIG9iamVjdHMsIHN0X2xpbmspIHsKPiAgIAkJ
Zm9yIChwaW5uZWQgPSAwOyBwaW5uZWQgPD0gMTsgcGlubmVkKyspIHsKPiAgIAkJCWxpc3RfZm9y
X2VhY2hfZW50cnkoY3R4LCBjb250ZXh0cywgbGluaykgewo+IC0JCQkJc3RydWN0IGk5MTVfYWRk
cmVzc19zcGFjZSAqdm0gPSBjdHgtPnZtOwo+ICsJCQkJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFj
ZSAqdm07Cj4gICAJCQkJc3RydWN0IGk5MTVfdm1hICp2bWE7Cj4gICAJCQkJaW50IGVycjsKPiAg
IAo+ICsJCQkJdm0gPSBpOTE1X2dlbV9jb250ZXh0X2dldF92bV9yY3UoY3R4KTsKPiAgIAkJCQl2
bWEgPSBjaGVja2VkX3ZtYV9pbnN0YW5jZShvYmosIHZtLCBOVUxMKTsKPiArCQkJCWk5MTVfdm1f
cHV0KHZtKTsKPiAgIAkJCQlpZiAoSVNfRVJSKHZtYSkpCj4gICAJCQkJCXJldHVybiBQVFJfRVJS
KHZtYSk7Cj4gICAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3Rz
L21vY2tfZ2VtX2RldmljZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tf
Z2VtX2RldmljZS5jCj4gaW5kZXggNGU2Y2RlMGQ0ODU5Li4zMzVmMzdiYTk4ZGUgMTAwNjQ0Cj4g
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfZ2VtX2RldmljZS5jCj4g
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfZ2VtX2RldmljZS5jCj4g
QEAgLTU5LDExICs1OSw5IEBAIHN0YXRpYyB2b2lkIG1vY2tfZGV2aWNlX3JlbGVhc2Uoc3RydWN0
IGRybV9kZXZpY2UgKmRldikKPiAgIAo+ICAgCWk5MTVfZ2VtX2RyYWluX3dvcmtxdWV1ZShpOTE1
KTsKPiAgIAo+IC0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAJZm9y
X2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpCj4gICAJCW1vY2tfZW5naW5lX2ZyZWUoZW5n
aW5lKTsKPiAtCWk5MTVfZ2VtX2NvbnRleHRzX2ZpbmkoaTkxNSk7Cj4gLQltdXRleF91bmxvY2so
Jmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJaTkxNV9nZW1fZHJpdmVyX3JlbGVhc2VfX2Nv
bnRleHRzKGk5MTUpOwo+ICAgCj4gICAJaW50ZWxfdGltZWxpbmVzX2ZpbmkoaTkxNSk7Cj4gICAK
PiBAQCAtMjA2LDcgKzIwNCw3IEBAIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICptb2NrX2dlbV9k
ZXZpY2Uodm9pZCkKPiAgIAlyZXR1cm4gaTkxNTsKPiAgIAo+ICAgZXJyX2NvbnRleHQ6Cj4gLQlp
OTE1X2dlbV9jb250ZXh0c19maW5pKGk5MTUpOwo+ICsJaTkxNV9nZW1fZHJpdmVyX3JlbGVhc2Vf
X2NvbnRleHRzKGk5MTUpOwo+ICAgZXJyX2VuZ2luZToKPiAgIAltb2NrX2VuZ2luZV9mcmVlKGk5
MTUtPmVuZ2luZVtSQ1MwXSk7Cj4gICBlcnJfdW5sb2NrOgo+IApfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVs
LWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcv
bWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

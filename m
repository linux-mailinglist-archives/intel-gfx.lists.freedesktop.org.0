Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 6860467561
	for <lists+intel-gfx@lfdr.de>; Fri, 12 Jul 2019 21:30:02 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 94B236E370;
	Fri, 12 Jul 2019 19:30:00 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id CBB2B6E370
 for <intel-gfx@lists.freedesktop.org>; Fri, 12 Jul 2019 19:29:57 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17255126-1500050 
 for <intel-gfx@lists.freedesktop.org>; Fri, 12 Jul 2019 20:29:53 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 12 Jul 2019 20:29:53 +0100
Message-Id: <20190712192953.9187-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.22.0
MIME-Version: 1.0
Subject: [Intel-gfx] [CI] drm/i915/gt: Use intel_gt as the primary object
 for handling resets
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

SGF2aW5nIHRha2VuIHRoZSBmaXJzdCBzdGVwIGluIGVuY2Fwc3VsYXRpbmcgdGhlIGZ1bmN0aW9u
YWxpdHkgYnkgbW92aW5nCnRoZSByZWxhdGVkIGZpbGVzIHVuZGVyIGd0LywgdGhlIG5leHQgc3Rl
cCBpcyB0byBzdGFydCBlbmNhcHN1bGF0aW5nIGJ5CnBhc3NpbmcgYXJvdW5kIHRoZSByZWxldmFu
dCBzdHJ1Y3RzIHJhdGhlciB0aGFuIHRoZSBnbG9iYWwKZHJtX2k5MTVfcHJpdmF0ZS4gSW4gdGhp
cyBzdGVwLCB3ZSBwYXNzIGludGVsX2d0IHRvIGludGVsX3Jlc2V0LmMKClNpZ25lZC1vZmYtYnk6
IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgpDYzogVHZydGtvIFVyc3Vs
aW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KQ2M6IERhbmllbGUgQ2VyYW9sbyBTcHVyaW8g
PGRhbmllbGUuY2VyYW9sb3NwdXJpb0BpbnRlbC5jb20+ClJldmlld2VkLWJ5OiBEYW5pZWxlIENl
cmFvbG8gU3B1cmlvIDxkYW5pZWxlLmNlcmFvbG9zcHVyaW9AaW50ZWwuY29tPgotLS0KIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jICB8ICAyMiArLQogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYyAgIHwgICAyICstCiAuLi4vZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMgICAgfCAgIDIgKy0KIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9tbWFuLmMgICAgICB8ICAgOCArLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMgICAgICAgIHwgIDI1ICstCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdGhyb3R0bGUuYyAgfCAgIDIgKy0KIC4uLi9ncHUvZHJt
L2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2VzLmMgICB8ICAyMCArLQogLi4uL2k5MTUvZ2Vt
L3NlbGZ0ZXN0cy9pOTE1X2dlbV9jbGllbnRfYmx0LmMgIHwgICA0ICstCiAuLi4vaTkxNS9nZW0v
c2VsZnRlc3RzL2k5MTVfZ2VtX2NvaGVyZW5jeS5jICAgfCAgIDYgKy0KIC4uLi9kcm0vaTkxNS9n
ZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQuYyB8ICAxNyArLQogLi4uL2RybS9pOTE1L2dl
bS9zZWxmdGVzdHMvaTkxNV9nZW1fbW1hbi5jICAgIHwgICAyICstCiAuLi4vaTkxNS9nZW0vc2Vs
ZnRlc3RzL2k5MTVfZ2VtX29iamVjdF9ibHQuYyAgfCAgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2VuZ2luZS5oICAgICAgICB8ICAgOCArLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMgICAgIHwgIDE2ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9lbmdpbmVfcG0uYyAgICAgfCAgIDMgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2d0LmMgICAgICAgICAgICB8ICAgNyArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9ndC5oICAgICAgICAgICAgfCAgMTIgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfZ3RfcG0uYyAgICAgICAgIHwgIDIyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9ndF90eXBlcy5oICAgICAgfCAgMTIgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfaGFuZ2NoZWNrLmMgICAgIHwgIDY3ICsrLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfbHJjLmMgICAgICAgICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9yZXNldC5jICAgICAgICAgfCA0NDAgKysrKysrKystLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX3Jlc2V0LmggICAgICAgICB8ICA3MyArLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX3Jlc2V0X3R5cGVzLmggICB8ICA1MCArKwogZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hlY2suYyAgfCA0NjEgKysrKysrKysrLS0tLS0tLS0tCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYyAgICAgICAgfCAgMzggKy0KIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3Jlc2V0LmMgICAgICB8ICA5NyArKy0tCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF90aW1lbGluZS5jICAgfCAgIDMgKy0KIC4u
Li9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rfd29ya2Fyb3VuZHMuYyAgICB8ICAzMyArLQogZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMgICAgICAgICAgIHwgIDYzICstLQogZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYyAgICAgICAgICAgICAgIHwgICA1ICstCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oICAgICAgICAgICAgICAgfCAgMzUgKy0KIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMgICAgICAgICAgICAgICB8ICAzMSArLQogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuaCAgICAgICAgIHwgIDUyICstCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYyAgICAgICAgICAgfCAgIDUgKy0KIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfc2VsZnRlc3QuaCAgICAgICAgICB8ICAgOSArCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF9ndWNfc3VibWlzc2lvbi5jICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX3VjLmMgICAgICAgICAgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUv
ZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfYWN0aXZlLmMgIHwgICAzICstCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW0uYyAgICAgfCAgIDMgKy0KIC4uLi9ncHUvZHJtL2k5
MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2V2aWN0LmMgICB8ICAgMyArLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvc2VsZnRlc3RzL2k5MTVfcmVxdWVzdC5jIHwgICA0ICstCiAuLi4vZ3B1L2RybS9pOTE1
L3NlbGZ0ZXN0cy9pOTE1X3NlbGZ0ZXN0LmMgICAgfCAgMjMgKy0KIC4uLi9ncHUvZHJtL2k5MTUv
c2VsZnRlc3RzL2lndF9mbHVzaF90ZXN0LmMgICB8ICAgNSArLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvc2VsZnRlc3RzL2lndF9yZXNldC5jICAgIHwgIDM4ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9zZWxmdGVzdHMvaWd0X3Jlc2V0LmggICAgfCAgMTAgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L3NlbGZ0ZXN0cy9pZ3Rfd2VkZ2VfbWUuaCB8ICA1OCAtLS0KIC4uLi9ncHUvZHJtL2k5MTUvc2Vs
ZnRlc3RzL21vY2tfZ2VtX2RldmljZS5jICB8ICAgNSAtCiA0OSBmaWxlcyBjaGFuZ2VkLCA5MDIg
aW5zZXJ0aW9ucygrKSwgOTE0IGRlbGV0aW9ucygtKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0X3R5cGVzLmgKIGRlbGV0ZSBtb2RlIDEwMDY0
NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaWd0X3dlZGdlX21lLmgKCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCmluZGV4IDk3NTg1MjNmMDgz
Ny4uZTI1YjgyZDA3ZDRmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2Rpc3BsYXkuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2Rpc3BsYXkuYwpAQCAtNDI3MSwxMiArNDI3MSwxMyBAQCB2b2lkIGludGVsX3ByZXBhcmVfcmVz
ZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCQlyZXR1cm47CiAKIAkvKiBX
ZSBoYXZlIGEgbW9kZXNldCB2cyByZXNldCBkZWFkbG9jaywgZGVmZW5zaXZlbHkgdW5icmVhayBp
dC4gKi8KLQlzZXRfYml0KEk5MTVfUkVTRVRfTU9ERVNFVCwgJmRldl9wcml2LT5ncHVfZXJyb3Iu
ZmxhZ3MpOwotCXdha2VfdXBfYWxsKCZkZXZfcHJpdi0+Z3B1X2Vycm9yLndhaXRfcXVldWUpOwor
CXNldF9iaXQoSTkxNV9SRVNFVF9NT0RFU0VULCAmZGV2X3ByaXYtPmd0LnJlc2V0LmZsYWdzKTsK
KwlzbXBfbWJfX2FmdGVyX2F0b21pYygpOworCXdha2VfdXBfYml0KCZkZXZfcHJpdi0+Z3QucmVz
ZXQuZmxhZ3MsIEk5MTVfUkVTRVRfTU9ERVNFVCk7CiAKIAlpZiAoYXRvbWljX3JlYWQoJmRldl9w
cml2LT5ncHVfZXJyb3IucGVuZGluZ19mYl9waW4pKSB7CiAJCURSTV9ERUJVR19LTVMoIk1vZGVz
ZXQgcG90ZW50aWFsbHkgc3R1Y2ssIHVuYnJlYWtpbmcgdGhyb3VnaCB3ZWRnaW5nXG4iKTsKLQkJ
aTkxNV9nZW1fc2V0X3dlZGdlZChkZXZfcHJpdik7CisJCWludGVsX2d0X3NldF93ZWRnZWQoJmRl
dl9wcml2LT5ndCk7CiAJfQogCiAJLyoKQEAgLTQzMjIsNyArNDMyMyw3IEBAIHZvaWQgaW50ZWxf
ZmluaXNoX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlpbnQgcmV0
OwogCiAJLyogcmVzZXQgZG9lc24ndCB0b3VjaCB0aGUgZGlzcGxheSAqLwotCWlmICghdGVzdF9i
aXQoSTkxNV9SRVNFVF9NT0RFU0VULCAmZGV2X3ByaXYtPmdwdV9lcnJvci5mbGFncykpCisJaWYg
KCF0ZXN0X2JpdChJOTE1X1JFU0VUX01PREVTRVQsICZkZXZfcHJpdi0+Z3QucmVzZXQuZmxhZ3Mp
KQogCQlyZXR1cm47CiAKIAlzdGF0ZSA9IGZldGNoX2FuZF96ZXJvKCZkZXZfcHJpdi0+bW9kZXNl
dF9yZXN0b3JlX3N0YXRlKTsKQEAgLTQzNjIsNyArNDM2Myw3IEBAIHZvaWQgaW50ZWxfZmluaXNo
X3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlkcm1fbW9kZXNldF9h
Y3F1aXJlX2ZpbmkoY3R4KTsKIAltdXRleF91bmxvY2soJmRldi0+bW9kZV9jb25maWcubXV0ZXgp
OwogCi0JY2xlYXJfYml0KEk5MTVfUkVTRVRfTU9ERVNFVCwgJmRldl9wcml2LT5ncHVfZXJyb3Iu
ZmxhZ3MpOworCWNsZWFyX2JpdF91bmxvY2soSTkxNV9SRVNFVF9NT0RFU0VULCAmZGV2X3ByaXYt
Pmd0LnJlc2V0LmZsYWdzKTsKIH0KIAogc3RhdGljIHZvaWQgaWNsX3NldF9waXBlX2NoaWNrZW4o
c3RydWN0IGludGVsX2NydGMgKmNydGMpCkBAIC0xMzg3MywxOCArMTM4NzQsMjEgQEAgc3RhdGlj
IHZvaWQgaW50ZWxfYXRvbWljX2NvbW1pdF9mZW5jZV93YWl0KHN0cnVjdCBpbnRlbF9hdG9taWNf
c3RhdGUgKmludGVsX3N0YXQKIAlmb3IgKDs7KSB7CiAJCXByZXBhcmVfdG9fd2FpdCgmaW50ZWxf
c3RhdGUtPmNvbW1pdF9yZWFkeS53YWl0LAogCQkJCSZ3YWl0X2ZlbmNlLCBUQVNLX1VOSU5URVJS
VVBUSUJMRSk7Ci0JCXByZXBhcmVfdG9fd2FpdCgmZGV2X3ByaXYtPmdwdV9lcnJvci53YWl0X3F1
ZXVlLAorCQlwcmVwYXJlX3RvX3dhaXQoYml0X3dhaXRxdWV1ZSgmZGV2X3ByaXYtPmd0LnJlc2V0
LmZsYWdzLAorCQkJCQkgICAgICBJOTE1X1JFU0VUX01PREVTRVQpLAogCQkJCSZ3YWl0X3Jlc2V0
LCBUQVNLX1VOSU5URVJSVVBUSUJMRSk7CiAKIAotCQlpZiAoaTkxNV9zd19mZW5jZV9kb25lKCZp
bnRlbF9zdGF0ZS0+Y29tbWl0X3JlYWR5KQotCQkgICAgfHwgdGVzdF9iaXQoSTkxNV9SRVNFVF9N
T0RFU0VULCAmZGV2X3ByaXYtPmdwdV9lcnJvci5mbGFncykpCisJCWlmIChpOTE1X3N3X2ZlbmNl
X2RvbmUoJmludGVsX3N0YXRlLT5jb21taXRfcmVhZHkpIHx8CisJCSAgICB0ZXN0X2JpdChJOTE1
X1JFU0VUX01PREVTRVQsICZkZXZfcHJpdi0+Z3QucmVzZXQuZmxhZ3MpKQogCQkJYnJlYWs7CiAK
IAkJc2NoZWR1bGUoKTsKIAl9CiAJZmluaXNoX3dhaXQoJmludGVsX3N0YXRlLT5jb21taXRfcmVh
ZHkud2FpdCwgJndhaXRfZmVuY2UpOwotCWZpbmlzaF93YWl0KCZkZXZfcHJpdi0+Z3B1X2Vycm9y
LndhaXRfcXVldWUsICZ3YWl0X3Jlc2V0KTsKKwlmaW5pc2hfd2FpdChiaXRfd2FpdHF1ZXVlKCZk
ZXZfcHJpdi0+Z3QucmVzZXQuZmxhZ3MsCisJCQkJICBJOTE1X1JFU0VUX01PREVTRVQpLAorCQkg
ICAgJndhaXRfcmVzZXQpOwogfQogCiBzdGF0aWMgdm9pZCBpbnRlbF9hdG9taWNfY2xlYW51cF93
b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fY29udGV4dC5jCmluZGV4IDA3ODU5MjkxMmQ5Ny4uYzVmOGJmYTNmN2IwIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKQEAgLTIxMjcsNyAr
MjEyNyw3IEBAIGludCBpOTE1X2dlbV9jb250ZXh0X2NyZWF0ZV9pb2N0bChzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LCB2b2lkICpkYXRhLAogCWlmIChhcmdzLT5mbGFncyAmIEk5MTVfQ09OVEVYVF9D
UkVBVEVfRkxBR1NfVU5LTk9XTikKIAkJcmV0dXJuIC1FSU5WQUw7CiAKLQlyZXQgPSBpOTE1X3Rl
cm1pbmFsbHlfd2VkZ2VkKGk5MTUpOworCXJldCA9IGludGVsX2d0X3Rlcm1pbmFsbHlfd2VkZ2Vk
KCZpOTE1LT5ndCk7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKaW5kZXggMWM1ZGZiZmFkNzFiLi44
YTIwNDdjNGU3YzMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9leGVjYnVmZmVyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4
ZWNidWZmZXIuYwpAQCAtMjEzMCw3ICsyMTMwLDcgQEAgc3RhdGljIGludCBlYl9waW5fY29udGV4
dChzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYiwgc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQog
CSAqIEFCSTogQmVmb3JlIHVzZXJzcGFjZSBhY2Nlc3NlcyB0aGUgR1BVIChlLmcuIGV4ZWNidWZm
ZXIpLCByZXBvcnQKIAkgKiBFSU8gaWYgdGhlIEdQVSBpcyBhbHJlYWR5IHdlZGdlZC4KIAkgKi8K
LQllcnIgPSBpOTE1X3Rlcm1pbmFsbHlfd2VkZ2VkKGViLT5pOTE1KTsKKwllcnIgPSBpbnRlbF9n
dF90ZXJtaW5hbGx5X3dlZGdlZChjZS0+ZW5naW5lLT5ndCk7CiAJaWYgKGVycikKIAkJcmV0dXJu
IGVycjsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21t
YW4uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9tbWFuLmMKaW5kZXggMzkx
NjIxZWUzY2JiLi5hNTY0YzFlNDIzMWIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9tbWFuLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX21tYW4uYwpAQCAtNyw2ICs3LDggQEAKICNpbmNsdWRlIDxsaW51eC9tbWFuLmg+CiAjaW5j
bHVkZSA8bGludXgvc2l6ZXMuaD4KIAorI2luY2x1ZGUgImd0L2ludGVsX2d0LmgiCisKICNpbmNs
dWRlICJpOTE1X2Rydi5oIgogI2luY2x1ZGUgImk5MTVfZ2VtX2d0dC5oIgogI2luY2x1ZGUgImk5
MTVfZ2VtX2lvY3Rscy5oIgpAQCAtMjQ2LDcgKzI0OCw3IEBAIHZtX2ZhdWx0X3QgaTkxNV9nZW1f
ZmF1bHQoc3RydWN0IHZtX2ZhdWx0ICp2bWYpCiAKIAl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9w
bV9nZXQocnBtKTsKIAotCXNyY3UgPSBpOTE1X3Jlc2V0X3RyeWxvY2soaTkxNSk7CisJc3JjdSA9
IGludGVsX2d0X3Jlc2V0X3RyeWxvY2soZ2d0dC0+dm0uZ3QpOwogCWlmIChzcmN1IDwgMCkgewog
CQlyZXQgPSBzcmN1OwogCQlnb3RvIGVycl9ycG07CkBAIC0zMjYsNyArMzI4LDcgQEAgdm1fZmF1
bHRfdCBpOTE1X2dlbV9mYXVsdChzdHJ1Y3Qgdm1fZmF1bHQgKnZtZikKIGVycl91bmxvY2s6CiAJ
bXV0ZXhfdW5sb2NrKCZkZXYtPnN0cnVjdF9tdXRleCk7CiBlcnJfcmVzZXQ6Ci0JaTkxNV9yZXNl
dF91bmxvY2soaTkxNSwgc3JjdSk7CisJaW50ZWxfZ3RfcmVzZXRfdW5sb2NrKGdndHQtPnZtLmd0
LCBzcmN1KTsKIGVycl9ycG06CiAJaW50ZWxfcnVudGltZV9wbV9wdXQocnBtLCB3YWtlcmVmKTsK
IAlpOTE1X2dlbV9vYmplY3RfdW5waW5fcGFnZXMob2JqKTsKQEAgLTMzOSw3ICszNDEsNyBAQCB2
bV9mYXVsdF90IGk5MTVfZ2VtX2ZhdWx0KHN0cnVjdCB2bV9mYXVsdCAqdm1mKQogCQkgKiBmYWls
KS4gQnV0IGFueSBvdGhlciAtRUlPIGlzbid0IG91cnMgKGUuZy4gc3dhcCBpbiBmYWlsdXJlKQog
CQkgKiBhbmQgc28gbmVlZHMgdG8gYmUgcmVwb3J0ZWQuCiAJCSAqLwotCQlpZiAoIWk5MTVfdGVy
bWluYWxseV93ZWRnZWQoaTkxNSkpCisJCWlmICghaW50ZWxfZ3RfaXNfd2VkZ2VkKGdndHQtPnZt
Lmd0KSkKIAkJCXJldHVybiBWTV9GQVVMVF9TSUdCVVM7CiAJCS8qIGVsc2U6IGZhbGwgdGhyb3Vn
aCAqLwogCWNhc2UgLUVBR0FJTjoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMK
aW5kZXggNGQ3NzQzNzZmNWI4Li45ZWU2ZWRiYWQ0YzUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9wbS5jCkBAIC01LDYgKzUsNyBAQAogICovCiAKICNpbmNsdWRlICJnZW0vaTkx
NV9nZW1fcG0uaCIKKyNpbmNsdWRlICJndC9pbnRlbF9ndC5oIgogI2luY2x1ZGUgImd0L2ludGVs
X2d0X3BtLmgiCiAKICNpbmNsdWRlICJpOTE1X2Rydi5oIgpAQCAtMTA2LDE4ICsxMDcsMTggQEAg
c3RhdGljIGludCBwbV9ub3RpZmllcihzdHJ1Y3Qgbm90aWZpZXJfYmxvY2sgKm5iLAogCXJldHVy
biBOT1RJRllfT0s7CiB9CiAKLXN0YXRpYyBib29sIHN3aXRjaF90b19rZXJuZWxfY29udGV4dF9z
eW5jKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQorc3RhdGljIGJvb2wgc3dpdGNoX3Rv
X2tlcm5lbF9jb250ZXh0X3N5bmMoc3RydWN0IGludGVsX2d0ICpndCkKIHsKLQlib29sIHJlc3Vs
dCA9ICFpOTE1X3Rlcm1pbmFsbHlfd2VkZ2VkKGk5MTUpOworCWJvb2wgcmVzdWx0ID0gIWludGVs
X2d0X2lzX3dlZGdlZChndCk7CiAKIAlkbyB7Ci0JCWlmIChpOTE1X2dlbV93YWl0X2Zvcl9pZGxl
KGk5MTUsCisJCWlmIChpOTE1X2dlbV93YWl0X2Zvcl9pZGxlKGd0LT5pOTE1LAogCQkJCQkgICBJ
OTE1X1dBSVRfTE9DS0VEIHwKIAkJCQkJICAgSTkxNV9XQUlUX0ZPUl9JRExFX0JPT1NULAogCQkJ
CQkgICBJOTE1X0dFTV9JRExFX1RJTUVPVVQpID09IC1FVElNRSkgewogCQkJLyogWFhYIGhpZGUg
d2FybmluZyBmcm9tIGdlbV9laW8gKi8KIAkJCWlmIChpOTE1X21vZHBhcmFtcy5yZXNldCkgewot
CQkJCWRldl9lcnIoaTkxNS0+ZHJtLmRldiwKKwkJCQlkZXZfZXJyKGd0LT5pOTE1LT5kcm0uZGV2
LAogCQkJCQkiRmFpbGVkIHRvIGlkbGUgZW5naW5lcywgZGVjbGFyaW5nIHdlZGdlZCFcbiIpOwog
CQkJCUdFTV9UUkFDRV9EVU1QKCk7CiAJCQl9CkBAIC0xMjYsMTggKzEyNywxOCBAQCBzdGF0aWMg
Ym9vbCBzd2l0Y2hfdG9fa2VybmVsX2NvbnRleHRfc3luYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKIAkJCSAqIEZvcmNpYmx5IGNhbmNlbCBvdXRzdGFuZGluZyB3b3JrIGFuZCBsZWF2
ZQogCQkJICogdGhlIGdwdSBxdWlldC4KIAkJCSAqLwotCQkJaTkxNV9nZW1fc2V0X3dlZGdlZChp
OTE1KTsKKwkJCWludGVsX2d0X3NldF93ZWRnZWQoZ3QpOwogCQkJcmVzdWx0ID0gZmFsc2U7CiAJ
CX0KLQl9IHdoaWxlIChpOTE1X3JldGlyZV9yZXF1ZXN0cyhpOTE1KSAmJiByZXN1bHQpOworCX0g
d2hpbGUgKGk5MTVfcmV0aXJlX3JlcXVlc3RzKGd0LT5pOTE1KSAmJiByZXN1bHQpOwogCi0JR0VN
X0JVR19PTihpOTE1LT5ndC5hd2FrZSk7CisJR0VNX0JVR19PTihndC0+YXdha2UpOwogCXJldHVy
biByZXN1bHQ7CiB9CiAKIGJvb2wgaTkxNV9nZW1fbG9hZF9wb3dlcl9jb250ZXh0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQogewotCXJldHVybiBzd2l0Y2hfdG9fa2VybmVsX2NvbnRl
eHRfc3luYyhpOTE1KTsKKwlyZXR1cm4gc3dpdGNoX3RvX2tlcm5lbF9jb250ZXh0X3N5bmMoJmk5
MTUtPmd0KTsKIH0KIAogdm9pZCBpOTE1X2dlbV9zdXNwZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQpAQCAtMTU4LDcgKzE1OSw3IEBAIHZvaWQgaTkxNV9nZW1fc3VzcGVuZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkgKiBzdGF0ZS4gRm9ydHVuYXRlbHksIHRoZSBr
ZXJuZWxfY29udGV4dCBpcyBkaXNwb3NhYmxlIGFuZCB3ZSBkbwogCSAqIG5vdCByZWx5IG9uIGl0
cyBzdGF0ZS4KIAkgKi8KLQlzd2l0Y2hfdG9fa2VybmVsX2NvbnRleHRfc3luYyhpOTE1KTsKKwlz
d2l0Y2hfdG9fa2VybmVsX2NvbnRleHRfc3luYygmaTkxNS0+Z3QpOwogCiAJbXV0ZXhfdW5sb2Nr
KCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIApAQCAtMTY5LDcgKzE3MCw3IEBAIHZvaWQgaTkx
NV9nZW1fc3VzcGVuZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAlHRU1fQlVHX09O
KGk5MTUtPmd0LmF3YWtlKTsKIAlmbHVzaF93b3JrKCZpOTE1LT5nZW0uaWRsZV93b3JrKTsKIAot
CWNhbmNlbF9kZWxheWVkX3dvcmtfc3luYygmaTkxNS0+Z3B1X2Vycm9yLmhhbmdjaGVja193b3Jr
KTsKKwljYW5jZWxfZGVsYXllZF93b3JrX3N5bmMoJmk5MTUtPmd0LmhhbmdjaGVjay53b3JrKTsK
IAogCWk5MTVfZ2VtX2RyYWluX2ZyZWVkX29iamVjdHMoaTkxNSk7CiAKQEAgLTI3NywxMCArMjc4
LDEwIEBAIHZvaWQgaTkxNV9nZW1fcmVzdW1lKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQogCXJldHVybjsKIAogZXJyX3dlZGdlZDoKLQlpZiAoIWk5MTVfcmVzZXRfZmFpbGVkKGk5MTUp
KSB7CisJaWYgKCFpbnRlbF9ndF9pc193ZWRnZWQoJmk5MTUtPmd0KSkgewogCQlkZXZfZXJyKGk5
MTUtPmRybS5kZXYsCiAJCQkiRmFpbGVkIHRvIHJlLWluaXRpYWxpemUgR1BVLCBkZWNsYXJpbmcg
aXQgd2VkZ2VkIVxuIik7Ci0JCWk5MTVfZ2VtX3NldF93ZWRnZWQoaTkxNSk7CisJCWludGVsX2d0
X3NldF93ZWRnZWQoJmk5MTUtPmd0KTsKIAl9CiAJZ290byBvdXRfdW5sb2NrOwogfQpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3Rocm90dGxlLmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdGhyb3R0bGUuYwppbmRleCBhZGIzMDc0ZDlj
ZTIuLjFlMzcyNDIwNzcxYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5
MTVfZ2VtX3Rocm90dGxlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X3Rocm90dGxlLmMKQEAgLTQxLDcgKzQxLDcgQEAgaTkxNV9nZW1fdGhyb3R0bGVfaW9jdGwoc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIAlsb25nIHJldDsKIAogCS8qIEFCSTog
cmV0dXJuIC1FSU8gaWYgYWxyZWFkeSB3ZWRnZWQgKi8KLQlyZXQgPSBpOTE1X3Rlcm1pbmFsbHlf
d2VkZ2VkKHRvX2k5MTUoZGV2KSk7CisJcmV0ID0gaW50ZWxfZ3RfdGVybWluYWxseV93ZWRnZWQo
JnRvX2k5MTUoZGV2KS0+Z3QpOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaHVnZV9wYWdlcy5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2VzLmMKaW5kZXggODZlZWQ0
YzNhZTJiLi42Y2JkNGE2NjhjOWEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9zZWxmdGVzdHMvaHVnZV9wYWdlcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9z
ZWxmdGVzdHMvaHVnZV9wYWdlcy5jCkBAIC0xNzUzLDcgKzE3NTMsNyBAQCBpbnQgaTkxNV9nZW1f
aHVnZV9wYWdlX21vY2tfc2VsZnRlc3RzKHZvaWQpCiAJcmV0dXJuIGVycjsKIH0KIAotaW50IGk5
MTVfZ2VtX2h1Z2VfcGFnZV9saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCitpbnQgaTkxNV9nZW1faHVnZV9wYWdlX2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQogewogCXN0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9zdWJ0
ZXN0IHRlc3RzW10gPSB7CiAJCVNVQlRFU1QoaWd0X3Nocmlua190aHApLApAQCAtMTc2OCwyMiAr
MTc2OCwyMiBAQCBpbnQgaTkxNV9nZW1faHVnZV9wYWdlX2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKIAlp
bnQgZXJyOwogCi0JaWYgKCFIQVNfUFBHVFQoZGV2X3ByaXYpKSB7CisJaWYgKCFIQVNfUFBHVFQo
aTkxNSkpIHsKIAkJcHJfaW5mbygiUFBHVFQgbm90IHN1cHBvcnRlZCwgc2tpcHBpbmcgbGl2ZS1z
ZWxmdGVzdHNcbiIpOwogCQlyZXR1cm4gMDsKIAl9CiAKLQlpZiAoaTkxNV90ZXJtaW5hbGx5X3dl
ZGdlZChkZXZfcHJpdikpCisJaWYgKGludGVsX2d0X2lzX3dlZGdlZCgmaTkxNS0+Z3QpKQogCQly
ZXR1cm4gMDsKIAotCWZpbGUgPSBtb2NrX2ZpbGUoZGV2X3ByaXYpOworCWZpbGUgPSBtb2NrX2Zp
bGUoaTkxNSk7CiAJaWYgKElTX0VSUihmaWxlKSkKIAkJcmV0dXJuIFBUUl9FUlIoZmlsZSk7CiAK
LQltdXRleF9sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0Jd2FrZXJlZiA9IGlu
dGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0+cnVudGltZV9wbSk7CisJbXV0ZXhfbG9jaygm
aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0
KCZpOTE1LT5ydW50aW1lX3BtKTsKIAotCWN0eCA9IGxpdmVfY29udGV4dChkZXZfcHJpdiwgZmls
ZSk7CisJY3R4ID0gbGl2ZV9jb250ZXh0KGk5MTUsIGZpbGUpOwogCWlmIChJU19FUlIoY3R4KSkg
ewogCQllcnIgPSBQVFJfRVJSKGN0eCk7CiAJCWdvdG8gb3V0X3VubG9jazsKQEAgLTE3OTUsMTAg
KzE3OTUsMTAgQEAgaW50IGk5MTVfZ2VtX2h1Z2VfcGFnZV9saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJZXJyID0gaTkxNV9zdWJ0ZXN0cyh0ZXN0cywg
Y3R4KTsKIAogb3V0X3VubG9jazoKLQlpbnRlbF9ydW50aW1lX3BtX3B1dCgmZGV2X3ByaXYtPnJ1
bnRpbWVfcG0sIHdha2VyZWYpOwotCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3Rf
bXV0ZXgpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVm
KTsKKwltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCi0JbW9ja19maWxl
X2ZyZWUoZGV2X3ByaXYsIGZpbGUpOworCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUpOwogCiAJ
cmV0dXJuIGVycjsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxm
dGVzdHMvaTkxNV9nZW1fY2xpZW50X2JsdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3Nl
bGZ0ZXN0cy9pOTE1X2dlbV9jbGllbnRfYmx0LmMKaW5kZXggZmE3OTIzMzA5M2ViLi4yNzVjMjg5
MjYwNjcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkx
NV9nZW1fY2xpZW50X2JsdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVz
dHMvaTkxNV9nZW1fY2xpZW50X2JsdC5jCkBAIC01LDYgKzUsOCBAQAogCiAjaW5jbHVkZSAiaTkx
NV9zZWxmdGVzdC5oIgogCisjaW5jbHVkZSAiZ3QvaW50ZWxfZ3QuaCIKKwogI2luY2x1ZGUgInNl
bGZ0ZXN0cy9pZ3RfZmx1c2hfdGVzdC5oIgogI2luY2x1ZGUgInNlbGZ0ZXN0cy9tb2NrX2RybS5o
IgogI2luY2x1ZGUgIm1vY2tfY29udGV4dC5oIgpAQCAtMTAxLDcgKzEwMyw3IEBAIGludCBpOTE1
X2dlbV9jbGllbnRfYmx0X2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQogCQlTVUJURVNUKGlndF9jbGllbnRfZmlsbCksCiAJfTsKIAotCWlmIChpOTE1X3Rlcm1p
bmFsbHlfd2VkZ2VkKGk5MTUpKQorCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoJmk5MTUtPmd0KSkK
IAkJcmV0dXJuIDA7CiAKIAlpZiAoIUhBU19FTkdJTkUoaTkxNSwgQkNTMCkpCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvaGVyZW5jeS5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb2hlcmVuY3ku
YwppbmRleCA4NjFmMzJiZTdkNDYuLmExYTRiNTNjZGM0YSAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb2hlcmVuY3kuYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvaGVyZW5jeS5jCkBAIC02
LDYgKzYsOCBAQAogCiAjaW5jbHVkZSA8bGludXgvcHJpbWVfbnVtYmVycy5oPgogCisjaW5jbHVk
ZSAiZ3QvaW50ZWxfZ3QuaCIKKwogI2luY2x1ZGUgImk5MTVfc2VsZnRlc3QuaCIKICNpbmNsdWRl
ICJzZWxmdGVzdHMvaTkxNV9yYW5kb20uaCIKIApAQCAtMjQyLDEyICsyNDQsMTIgQEAgc3RhdGlj
IGJvb2wgYWx3YXlzX3ZhbGlkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCiBzdGF0
aWMgYm9vbCBuZWVkc19mZW5jZV9yZWdpc3RlcnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCiB7Ci0JcmV0dXJuICFpOTE1X3Rlcm1pbmFsbHlfd2VkZ2VkKGk5MTUpOworCXJldHVybiAh
aW50ZWxfZ3RfaXNfd2VkZ2VkKCZpOTE1LT5ndCk7CiB9CiAKIHN0YXRpYyBib29sIG5lZWRzX21p
X3N0b3JlX2R3b3JkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogewotCWlmIChpOTE1
X3Rlcm1pbmFsbHlfd2VkZ2VkKGk5MTUpKQorCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoJmk5MTUt
Pmd0KSkKIAkJcmV0dXJuIGZhbHNlOwogCiAJaWYgKCFIQVNfRU5HSU5FKGk5MTUsIFJDUzApKQpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9j
b250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2Nv
bnRleHQuYwppbmRleCA2OTViZmIxOGIwZDQuLmRiNzg1NmYwZjMxZSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMKQEAg
LTcsNiArNyw3IEBACiAjaW5jbHVkZSA8bGludXgvcHJpbWVfbnVtYmVycy5oPgogCiAjaW5jbHVk
ZSAiZ2VtL2k5MTVfZ2VtX3BtLmgiCisjaW5jbHVkZSAiZ3QvaW50ZWxfZ3QuaCIKICNpbmNsdWRl
ICJndC9pbnRlbF9yZXNldC5oIgogI2luY2x1ZGUgImk5MTVfc2VsZnRlc3QuaCIKIApAQCAtODMs
NyArODQsNyBAQCBzdGF0aWMgaW50IGxpdmVfbm9wX3N3aXRjaCh2b2lkICphcmcpCiAJCX0KIAkJ
aWYgKGk5MTVfcmVxdWVzdF93YWl0KHJxLCAwLCBIWiAvIDUpIDwgMCkgewogCQkJcHJfZXJyKCJG
YWlsZWQgdG8gcG9wdWxhdGVkICVkIGNvbnRleHRzXG4iLCBuY3R4KTsKLQkJCWk5MTVfZ2VtX3Nl
dF93ZWRnZWQoaTkxNSk7CisJCQlpbnRlbF9ndF9zZXRfd2VkZ2VkKCZpOTE1LT5ndCk7CiAJCQll
cnIgPSAtRUlPOwogCQkJZ290byBvdXRfdW5sb2NrOwogCQl9CkBAIC0xMjcsNyArMTI4LDcgQEAg
c3RhdGljIGludCBsaXZlX25vcF9zd2l0Y2godm9pZCAqYXJnKQogCQkJaWYgKGk5MTVfcmVxdWVz
dF93YWl0KHJxLCAwLCBIWiAvIDUpIDwgMCkgewogCQkJCXByX2VycigiU3dpdGNoaW5nIGJldHdl
ZW4gJWxkIGNvbnRleHRzIHRpbWVkIG91dFxuIiwKIAkJCQkgICAgICAgcHJpbWUpOwotCQkJCWk5
MTVfZ2VtX3NldF93ZWRnZWQoaTkxNSk7CisJCQkJaW50ZWxfZ3Rfc2V0X3dlZGdlZCgmaTkxNS0+
Z3QpOwogCQkJCWJyZWFrOwogCQkJfQogCkBAIC05NTYsNyArOTU3LDcgQEAgX19zc2V1X2Zpbmlz
aChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAlpbnQgcmV0ID0gMDsKIAogCWlmIChm
bGFncyAmIFRFU1RfUkVTRVQpIHsKLQkJcmV0ID0gaTkxNV9yZXNldF9lbmdpbmUoY2UtPmVuZ2lu
ZSwgInNzZXUiKTsKKwkJcmV0ID0gaW50ZWxfZW5naW5lX3Jlc2V0KGNlLT5lbmdpbmUsICJzc2V1
Iik7CiAJCWlmIChyZXQpCiAJCQlnb3RvIG91dDsKIAl9CkBAIC0xMDU5LDcgKzEwNjAsNyBAQCBf
X2lndF9jdHhfc3NldShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJcmV0dXJuIFBU
Ul9FUlIoZmlsZSk7CiAKIAlpZiAoZmxhZ3MgJiBURVNUX1JFU0VUKQotCQlpZ3RfZ2xvYmFsX3Jl
c2V0X2xvY2soaTkxNSk7CisJCWlndF9nbG9iYWxfcmVzZXRfbG9jaygmaTkxNS0+Z3QpOwogCiAJ
bXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAKQEAgLTExMjAsNyArMTEyMSw3
IEBAIF9faWd0X2N0eF9zc2V1KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCW11dGV4
X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAKIAlpZiAoZmxhZ3MgJiBURVNUX1JF
U0VUKQotCQlpZ3RfZ2xvYmFsX3Jlc2V0X3VubG9jayhpOTE1KTsKKwkJaWd0X2dsb2JhbF9yZXNl
dF91bmxvY2soJmk5MTUtPmd0KTsKIAogCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUpOwogCkBA
IC0xNzIyLDcgKzE3MjMsNyBAQCBpbnQgaTkxNV9nZW1fY29udGV4dF9tb2NrX3NlbGZ0ZXN0cyh2
b2lkKQogCXJldHVybiBlcnI7CiB9CiAKLWludCBpOTE1X2dlbV9jb250ZXh0X2xpdmVfc2VsZnRl
c3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKK2ludCBpOTE1X2dlbV9jb250
ZXh0X2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogewogCXN0
YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9zdWJ0ZXN0IHRlc3RzW10gPSB7CiAJCVNVQlRFU1QobGl2
ZV9ub3Bfc3dpdGNoKSwKQEAgLTE3MzMsOCArMTczNCw4IEBAIGludCBpOTE1X2dlbV9jb250ZXh0
X2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAkJU1VC
VEVTVChpZ3Rfdm1faXNvbGF0aW9uKSwKIAl9OwogCi0JaWYgKGk5MTVfdGVybWluYWxseV93ZWRn
ZWQoZGV2X3ByaXYpKQorCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoJmk5MTUtPmd0KSkKIAkJcmV0
dXJuIDA7CiAKLQlyZXR1cm4gaTkxNV9saXZlX3N1YnRlc3RzKHRlc3RzLCBkZXZfcHJpdik7CisJ
cmV0dXJuIGk5MTVfbGl2ZV9zdWJ0ZXN0cyh0ZXN0cywgaTkxNSk7CiB9CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX21tYW4uYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fbW1hbi5jCmluZGV4IDU2MzVj
YmI0YWYyMi4uMDE4NTdjMTJmMTJmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX21tYW4uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX21tYW4uYwpAQCAtNDc4LDcgKzQ3OCw3IEBAIHN0YXRpYyBp
bnQgaWd0X21tYXBfb2Zmc2V0X2V4aGF1c3Rpb24odm9pZCAqYXJnKQogCiAJLyogTm93IGZpbGwg
d2l0aCBidXN5IGRlYWQgb2JqZWN0cyB0aGF0IHdlIGV4cGVjdCB0byByZWFwICovCiAJZm9yIChs
b29wID0gMDsgbG9vcCA8IDM7IGxvb3ArKykgewotCQlpZiAoaTkxNV90ZXJtaW5hbGx5X3dlZGdl
ZChpOTE1KSkKKwkJaWYgKGludGVsX2d0X2lzX3dlZGdlZCgmaTkxNS0+Z3QpKQogCQkJYnJlYWs7
CiAKIAkJb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5hbChpOTE1LCBQQUdFX1NJ
WkUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1
X2dlbV9vYmplY3RfYmx0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5
MTVfZ2VtX29iamVjdF9ibHQuYwppbmRleCAxMWQzNzIzOGM2MmMuLjE5ODQzYWNjODRkMyAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9vYmpl
Y3RfYmx0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dl
bV9vYmplY3RfYmx0LmMKQEAgLTMsNiArMyw4IEBACiAgKiBDb3B5cmlnaHQgwqkgMjAxOSBJbnRl
bCBDb3Jwb3JhdGlvbgogICovCiAKKyNpbmNsdWRlICJndC9pbnRlbF9ndC5oIgorCiAjaW5jbHVk
ZSAiaTkxNV9zZWxmdGVzdC5oIgogCiAjaW5jbHVkZSAic2VsZnRlc3RzL2lndF9mbHVzaF90ZXN0
LmgiCkBAIC05NSw3ICs5Nyw3IEBAIGludCBpOTE1X2dlbV9vYmplY3RfYmx0X2xpdmVfc2VsZnRl
c3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCQlTVUJURVNUKGlndF9maWxsX2Js
dCksCiAJfTsKIAotCWlmIChpOTE1X3Rlcm1pbmFsbHlfd2VkZ2VkKGk5MTUpKQorCWlmIChpbnRl
bF9ndF9pc193ZWRnZWQoJmk5MTUtPmd0KSkKIAkJcmV0dXJuIDA7CiAKIAlpZiAoIUhBU19FTkdJ
TkUoaTkxNSwgQkNTMCkpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9lbmdpbmUuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oCmluZGV4
IDAzMzFlOWFjMjQ4NS4uZGI1YzczY2U4NmVlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9lbmdpbmUuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9lbmdpbmUuaApAQCAtNDExLDggKzQxMSw4IEBAIGdlbjhfZW1pdF9nZ3R0X3dyaXRlKHUzMiAq
Y3MsIHUzMiB2YWx1ZSwgdTMyIGd0dF9vZmZzZXQsIHUzMiBmbGFncykKIAlyZXR1cm4gY3M7CiB9
CiAKLXN0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9lbmdpbmVfcmVzZXQoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lLAotCQkJCSAgICAgIGJvb2wgc3RhbGxlZCkKK3N0YXRpYyBpbmxpbmUg
dm9pZCBfX2ludGVsX2VuZ2luZV9yZXNldChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUs
CisJCQkJCWJvb2wgc3RhbGxlZCkKIHsKIAlpZiAoZW5naW5lLT5yZXNldC5yZXNldCkKIAkJZW5n
aW5lLT5yZXNldC5yZXNldChlbmdpbmUsIHN0YWxsZWQpOwpAQCAtNDIwLDkgKzQyMCw5IEBAIHN0
YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9lbmdpbmVfcmVzZXQoc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lLAogfQogCiBib29sIGludGVsX2VuZ2luZV9pc19pZGxlKHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSk7Ci1ib29sIGludGVsX2VuZ2luZXNfYXJlX2lkbGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKK2Jvb2wgaW50ZWxfZW5naW5lc19hcmVfaWRsZShz
dHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIAotdm9pZCBpbnRlbF9lbmdpbmVzX3Jlc2V0X2RlZmF1bHRf
c3VibWlzc2lvbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cit2b2lkIGludGVsX2Vu
Z2luZXNfcmVzZXRfZGVmYXVsdF9zdWJtaXNzaW9uKHN0cnVjdCBpbnRlbF9ndCAqZ3QpOwogdW5z
aWduZWQgaW50IGludGVsX2VuZ2luZXNfaGFzX2NvbnRleHRfaXNvbGF0aW9uKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KTsKIAogYm9vbCBpbnRlbF9lbmdpbmVfY2FuX3N0b3JlX2R3b3Jk
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2VuZ2luZV9jcy5jCmluZGV4IDJkYzE5MTdiOWQzMC4uMDIyZTAwZWI3OWFkIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYwpAQCAtMTEzOCw3ICsxMTM4
LDcgQEAgc3RhdGljIGJvb2wgcmluZ19pc19pZGxlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSkKIGJvb2wgaW50ZWxfZW5naW5lX2lzX2lkbGUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lKQogewogCS8qIE1vcmUgd2hpdGUgbGllcywgaWYgd2VkZ2VkLCBodyBzdGF0ZSBpcyBp
bmNvbnNpc3RlbnQgKi8KLQlpZiAoaTkxNV9yZXNldF9mYWlsZWQoZW5naW5lLT5pOTE1KSkKKwlp
ZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKGVuZ2luZS0+Z3QpKQogCQlyZXR1cm4gdHJ1ZTsKIAogCWlm
ICghaW50ZWxfZW5naW5lX3BtX2lzX2F3YWtlKGVuZ2luZSkpCkBAIC0xMTc0LDcgKzExNzQsNyBA
QCBib29sIGludGVsX2VuZ2luZV9pc19pZGxlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSkKIAlyZXR1cm4gcmluZ19pc19pZGxlKGVuZ2luZSk7CiB9CiAKLWJvb2wgaW50ZWxfZW5naW5l
c19hcmVfaWRsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKK2Jvb2wgaW50ZWxfZW5n
aW5lc19hcmVfaWRsZShzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewogCXN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZTsKIAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKQEAgLTExODMsMTQgKzEx
ODMsMTQgQEAgYm9vbCBpbnRlbF9lbmdpbmVzX2FyZV9pZGxlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQogCSAqIElmIHRoZSBkcml2ZXIgaXMgd2VkZ2VkLCBIVyBzdGF0ZSBtYXkgYmUg
dmVyeSBpbmNvbnNpc3RlbnQgYW5kCiAJICogcmVwb3J0IHRoYXQgaXQgaXMgc3RpbGwgYnVzeSwg
ZXZlbiB0aG91Z2ggd2UgaGF2ZSBzdG9wcGVkIHVzaW5nIGl0LgogCSAqLwotCWlmIChpOTE1X3Jl
c2V0X2ZhaWxlZChpOTE1KSkKKwlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKGd0KSkKIAkJcmV0dXJu
IHRydWU7CiAKIAkvKiBBbHJlYWR5IHBhcmtlZCAoYW5kIHBhc3NlZCBhbiBpZGxlbmVzcyB0ZXN0
KTsgbXVzdCBzdGlsbCBiZSBpZGxlICovCi0JaWYgKCFSRUFEX09OQ0UoaTkxNS0+Z3QuYXdha2Up
KQorCWlmICghUkVBRF9PTkNFKGd0LT5hd2FrZSkpCiAJCXJldHVybiB0cnVlOwogCi0JZm9yX2Vh
Y2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBn
dC0+aTkxNSwgaWQpIHsKIAkJaWYgKCFpbnRlbF9lbmdpbmVfaXNfaWRsZShlbmdpbmUpKQogCQkJ
cmV0dXJuIGZhbHNlOwogCX0KQEAgLTExOTgsMTIgKzExOTgsMTIgQEAgYm9vbCBpbnRlbF9lbmdp
bmVzX2FyZV9pZGxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCXJldHVybiB0cnVl
OwogfQogCi12b2lkIGludGVsX2VuZ2luZXNfcmVzZXRfZGVmYXVsdF9zdWJtaXNzaW9uKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQordm9pZCBpbnRlbF9lbmdpbmVzX3Jlc2V0X2RlZmF1
bHRfc3VibWlzc2lvbihzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewogCXN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZTsKIAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKIAotCWZvcl9lYWNoX2Vu
Z2luZShlbmdpbmUsIGk5MTUsIGlkKQorCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LT5pOTE1
LCBpZCkKIAkJZW5naW5lLT5zZXRfZGVmYXVsdF9zdWJtaXNzaW9uKGVuZ2luZSk7CiB9CiAKQEAg
LTE0ODAsNyArMTQ4MCw3IEBAIHZvaWQgaW50ZWxfZW5naW5lX2R1bXAoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lLAogCQl2YV9lbmQoYXApOwogCX0KIAotCWlmIChpOTE1X3Jlc2V0X2Zh
aWxlZChlbmdpbmUtPmk5MTUpKQorCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoZW5naW5lLT5ndCkp
CiAJCWRybV9wcmludGYobSwgIioqKiBXRURHRUQgKioqXG4iKTsKIAogCWRybV9wcmludGYobSwg
Ilx0QXdha2U/ICVkXG4iLCBhdG9taWNfcmVhZCgmZW5naW5lLT53YWtlcmVmLmNvdW50KSk7CmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5jCmluZGV4IDg0ZTQzMmFiZThl
MC4uZTc0ZmJmMDRhNjhkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9lbmdpbmVfcG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVf
cG0uYwpAQCAtOCw2ICs4LDcgQEAKIAogI2luY2x1ZGUgImludGVsX2VuZ2luZS5oIgogI2luY2x1
ZGUgImludGVsX2VuZ2luZV9wbS5oIgorI2luY2x1ZGUgImludGVsX2d0LmgiCiAjaW5jbHVkZSAi
aW50ZWxfZ3RfcG0uaCIKIAogc3RhdGljIGludCBfX2VuZ2luZV91bnBhcmsoc3RydWN0IGludGVs
X3dha2VyZWYgKndmKQpAQCAtNjYsNyArNjcsNyBAQCBzdGF0aWMgYm9vbCBzd2l0Y2hfdG9fa2Vy
bmVsX2NvbnRleHQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCQlyZXR1cm4gdHJ1
ZTsKIAogCS8qIEdQVSBpcyBwb2ludGluZyB0byB0aGUgdm9pZCwgYXMgZ29vZCBhcyBpbiB0aGUg
a2VybmVsIGNvbnRleHQuICovCi0JaWYgKGk5MTVfcmVzZXRfZmFpbGVkKGVuZ2luZS0+aTkxNSkp
CisJaWYgKGludGVsX2d0X2lzX3dlZGdlZChlbmdpbmUtPmd0KSkKIAkJcmV0dXJuIHRydWU7CiAK
IAkvKgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmMKaW5kZXggOGNjYTZiMjJiMzg2Li5mN2U2
OWRiNDAxOWQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuYwpAQCAtMTksNiArMTksOCBA
QCB2b2lkIGludGVsX2d0X2luaXRfZWFybHkoc3RydWN0IGludGVsX2d0ICpndCwgc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAKIAlzcGluX2xvY2tfaW5pdCgmZ3QtPmNsb3NlZF9sb2Nr
KTsKIAorCWludGVsX2d0X2luaXRfaGFuZ2NoZWNrKGd0KTsKKwlpbnRlbF9ndF9pbml0X3Jlc2V0
KGd0KTsKIAlpbnRlbF9ndF9wbV9pbml0X2Vhcmx5KGd0KTsKIH0KIApAQCAtMjQxLDMgKzI0Myw4
IEBAIHZvaWQgaW50ZWxfZ3RfZmluaV9zY3JhdGNoKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7CiAJ
aTkxNV92bWFfdW5waW5fYW5kX3JlbGVhc2UoJmd0LT5zY3JhdGNoLCAwKTsKIH0KKwordm9pZCBp
bnRlbF9ndF9jbGVhbnVwX2Vhcmx5KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCit7CisJaW50ZWxfZ3Rf
ZmluaV9yZXNldChndCk7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9ndC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuaAppbmRleCAxMDkz
ZGNmMzZmNjMuLjQ5YzAwODUzODVhMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZ3QuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5oCkBA
IC04LDEyICs4LDE1IEBACiAKICNpbmNsdWRlICJpbnRlbF9lbmdpbmVfdHlwZXMuaCIKICNpbmNs
dWRlICJpbnRlbF9ndF90eXBlcy5oIgorI2luY2x1ZGUgImludGVsX3Jlc2V0LmgiCiAKIHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlOwogCiB2b2lkIGludGVsX2d0X2luaXRfZWFybHkoc3RydWN0IGlu
dGVsX2d0ICpndCwgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwogdm9pZCBpbnRlbF9n
dF9pbml0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKIAordm9pZCBpbnRlbF9n
dF9jbGVhbnVwX2Vhcmx5KHN0cnVjdCBpbnRlbF9ndCAqZ3QpOworCiB2b2lkIGludGVsX2d0X2No
ZWNrX2FuZF9jbGVhcl9mYXVsdHMoc3RydWN0IGludGVsX2d0ICpndCk7CiB2b2lkIGludGVsX2d0
X2NsZWFyX2Vycm9yX3JlZ2lzdGVycyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAogCQkJCSAgICBpbnRl
bF9lbmdpbmVfbWFza190IGVuZ2luZV9tYXNrKTsKQEAgLTIxLDYgKzI0LDggQEAgdm9pZCBpbnRl
bF9ndF9jbGVhcl9lcnJvcl9yZWdpc3RlcnMoc3RydWN0IGludGVsX2d0ICpndCwKIHZvaWQgaW50
ZWxfZ3RfZmx1c2hfZ2d0dF93cml0ZXMoc3RydWN0IGludGVsX2d0ICpndCk7CiB2b2lkIGludGVs
X2d0X2NoaXBzZXRfZmx1c2goc3RydWN0IGludGVsX2d0ICpndCk7CiAKK3ZvaWQgaW50ZWxfZ3Rf
aW5pdF9oYW5nY2hlY2soc3RydWN0IGludGVsX2d0ICpndCk7CisKIGludCBpbnRlbF9ndF9pbml0
X3NjcmF0Y2goc3RydWN0IGludGVsX2d0ICpndCwgdW5zaWduZWQgaW50IHNpemUpOwogdm9pZCBp
bnRlbF9ndF9maW5pX3NjcmF0Y2goc3RydWN0IGludGVsX2d0ICpndCk7CiAKQEAgLTMwLDQgKzM1
LDExIEBAIHN0YXRpYyBpbmxpbmUgdTMyIGludGVsX2d0X3NjcmF0Y2hfb2Zmc2V0KGNvbnN0IHN0
cnVjdCBpbnRlbF9ndCAqZ3QsCiAJcmV0dXJuIGk5MTVfZ2d0dF9vZmZzZXQoZ3QtPnNjcmF0Y2gp
ICsgZmllbGQ7CiB9CiAKK3N0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF9ndF9pc193ZWRnZWQoc3Ry
dWN0IGludGVsX2d0ICpndCkKK3sKKwlyZXR1cm4gX19pbnRlbF9yZXNldF9mYWlsZWQoJmd0LT5y
ZXNldCk7Cit9CisKK3ZvaWQgaW50ZWxfZ3RfcXVldWVfaGFuZ2NoZWNrKHN0cnVjdCBpbnRlbF9n
dCAqZ3QpOworCiAjZW5kaWYgLyogX19JTlRFTF9HVF9IX18gKi8KZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9ndF9wbS5jCmluZGV4IGRhODFiM2E5MmQxNi4uNjFlZDkxMjM0MWYxIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9wbS5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3BtLmMKQEAgLTUsNyArNSw5IEBACiAgKi8KIAogI2lu
Y2x1ZGUgImk5MTVfZHJ2LmgiCisjaW5jbHVkZSAiaTkxNV9wYXJhbXMuaCIKICNpbmNsdWRlICJp
bnRlbF9lbmdpbmVfcG0uaCIKKyNpbmNsdWRlICJpbnRlbF9ndC5oIgogI2luY2x1ZGUgImludGVs
X2d0X3BtLmgiCiAjaW5jbHVkZSAiaW50ZWxfcG0uaCIKICNpbmNsdWRlICJpbnRlbF93YWtlcmVm
LmgiCkBAIC0xNyw4ICsxOSw4IEBAIHN0YXRpYyB2b2lkIHBtX25vdGlmeShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwgaW50IHN0YXRlKQogCiBzdGF0aWMgaW50IGludGVsX2d0X3VucGFy
ayhzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2YpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPQotCQljb250YWluZXJfb2Yod2YsIHR5cGVvZigqaTkxNSksIGd0Lndha2VyZWYpOwor
CXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBjb250YWluZXJfb2Yod2YsIHR5cGVvZigqZ3QpLCB3YWtl
cmVmKTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd0LT5pOTE1OwogCiAJR0VN
X1RSQUNFKCJcbiIpOwogCkBAIC0zMyw4ICszNSw4IEBAIHN0YXRpYyBpbnQgaW50ZWxfZ3RfdW5w
YXJrKHN0cnVjdCBpbnRlbF93YWtlcmVmICp3ZikKIAkgKiBXb3JrIGFyb3VuZCBpdCBieSBncmFi
YmluZyBhIEdUIElSUSBwb3dlciBkb21haW4gd2hpbHN0IHRoZXJlIGlzIGFueQogCSAqIEdUIGFj
dGl2aXR5LCBwcmV2ZW50aW5nIGFueSBEQyBzdGF0ZSB0cmFuc2l0aW9ucy4KIAkgKi8KLQlpOTE1
LT5ndC5hd2FrZSA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGk5MTUsIFBPV0VSX0RPTUFJTl9H
VF9JUlEpOwotCUdFTV9CVUdfT04oIWk5MTUtPmd0LmF3YWtlKTsKKwlndC0+YXdha2UgPSBpbnRl
bF9kaXNwbGF5X3Bvd2VyX2dldChpOTE1LCBQT1dFUl9ET01BSU5fR1RfSVJRKTsKKwlHRU1fQlVH
X09OKCFndC0+YXdha2UpOwogCiAJaW50ZWxfZW5hYmxlX2d0X3Bvd2Vyc2F2ZShpOTE1KTsKIApA
QCAtNDQsNyArNDYsNyBAQCBzdGF0aWMgaW50IGludGVsX2d0X3VucGFyayhzdHJ1Y3QgaW50ZWxf
d2FrZXJlZiAqd2YpCiAKIAlpOTE1X3BtdV9ndF91bnBhcmtlZChpOTE1KTsKIAotCWk5MTVfcXVl
dWVfaGFuZ2NoZWNrKGk5MTUpOworCWludGVsX2d0X3F1ZXVlX2hhbmdjaGVjayhndCk7CiAKIAlw
bV9ub3RpZnkoaTkxNSwgSU5URUxfR1RfVU5QQVJLKTsKIApAQCAtOTEsMTIgKzkzLDEyIEBAIHZv
aWQgaW50ZWxfZ3RfcG1faW5pdF9lYXJseShzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogCUJMT0NLSU5H
X0lOSVRfTk9USUZJRVJfSEVBRCgmZ3QtPnBtX25vdGlmaWNhdGlvbnMpOwogfQogCi1zdGF0aWMg
Ym9vbCByZXNldF9lbmdpbmVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQorc3RhdGlj
IGJvb2wgcmVzZXRfZW5naW5lcyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewotCWlmIChJTlRFTF9J
TkZPKGk5MTUpLT5ncHVfcmVzZXRfY2xvYmJlcnNfZGlzcGxheSkKKwlpZiAoSU5URUxfSU5GTyhn
dC0+aTkxNSktPmdwdV9yZXNldF9jbG9iYmVyc19kaXNwbGF5KQogCQlyZXR1cm4gZmFsc2U7CiAK
LQlyZXR1cm4gaW50ZWxfZ3B1X3Jlc2V0KGk5MTUsIEFMTF9FTkdJTkVTKSA9PSAwOworCXJldHVy
biBfX2ludGVsX2d0X3Jlc2V0KGd0LCBBTExfRU5HSU5FUykgPT0gMDsKIH0KIAogLyoqCkBAIC0x
MTYsMTEgKzExOCwxMSBAQCB2b2lkIGludGVsX2d0X3Nhbml0aXplKHN0cnVjdCBpbnRlbF9ndCAq
Z3QsIGJvb2wgZm9yY2UpCiAKIAlHRU1fVFJBQ0UoIlxuIik7CiAKLQlpZiAoIXJlc2V0X2VuZ2lu
ZXMoZ3QtPmk5MTUpICYmICFmb3JjZSkKKwlpZiAoIXJlc2V0X2VuZ2luZXMoZ3QpICYmICFmb3Jj
ZSkKIAkJcmV0dXJuOwogCiAJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QtPmk5MTUsIGlkKQot
CQlpbnRlbF9lbmdpbmVfcmVzZXQoZW5naW5lLCBmYWxzZSk7CisJCV9faW50ZWxfZW5naW5lX3Jl
c2V0KGVuZ2luZSwgZmFsc2UpOwogfQogCiBpbnQgaW50ZWxfZ3RfcmVzdW1lKHN0cnVjdCBpbnRl
bF9ndCAqZ3QpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF90
eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfdHlwZXMuaAppbmRleCAz
NTYzY2U5NzAxMDIuLjFmZmJjM2VjNmVmMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZ3RfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9ndF90eXBlcy5oCkBAIC0xNCwxMiArMTQsMjEgQEAKICNpbmNsdWRlIDxsaW51eC90eXBlcy5o
PgogCiAjaW5jbHVkZSAiaTkxNV92bWEuaCIKKyNpbmNsdWRlICJpbnRlbF9yZXNldF90eXBlcy5o
IgogI2luY2x1ZGUgImludGVsX3dha2VyZWYuaCIKIAogc3RydWN0IGRybV9pOTE1X3ByaXZhdGU7
CiBzdHJ1Y3QgaTkxNV9nZ3R0Owogc3RydWN0IGludGVsX3VuY29yZTsKIAorc3RydWN0IGludGVs
X2hhbmdjaGVjayB7CisJLyogRm9yIGhhbmdjaGVjayB0aW1lciAqLworI2RlZmluZSBEUk1fSTkx
NV9IQU5HQ0hFQ0tfUEVSSU9EIDE1MDAgLyogaW4gbXMgKi8KKyNkZWZpbmUgRFJNX0k5MTVfSEFO
R0NIRUNLX0pJRkZJRVMgbXNlY3NfdG9famlmZmllcyhEUk1fSTkxNV9IQU5HQ0hFQ0tfUEVSSU9E
KQorCisJc3RydWN0IGRlbGF5ZWRfd29yayB3b3JrOworfTsKKwogc3RydWN0IGludGVsX2d0IHsK
IAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNTsKIAlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1
bmNvcmU7CkBAIC00MSw2ICs1MCw5IEBAIHN0cnVjdCBpbnRlbF9ndCB7CiAJc3RydWN0IGxpc3Rf
aGVhZCBjbG9zZWRfdm1hOwogCXNwaW5sb2NrX3QgY2xvc2VkX2xvY2s7IC8qIGd1YXJkcyB0aGUg
bGlzdCBvZiBjbG9zZWRfdm1hICovCiAKKwlzdHJ1Y3QgaW50ZWxfaGFuZ2NoZWNrIGhhbmdjaGVj
azsKKwlzdHJ1Y3QgaW50ZWxfcmVzZXQgcmVzZXQ7CisKIAkvKioKIAkgKiBJcyB0aGUgR1BVIGN1
cnJlbnRseSBjb25zaWRlcmVkIGlkbGUsIG9yIGJ1c3kgZXhlY3V0aW5nCiAJICogdXNlcnNwYWNl
IHJlcXVlc3RzPyBXaGlsc3QgaWRsZSwgd2UgYWxsb3cgcnVudGltZSBwb3dlcgpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfaGFuZ2NoZWNrLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5nY2hlY2suYwppbmRleCA3OTdkOGVmMDk2OWMuLjg4MTc3
ZjQ3YjRkOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfaGFuZ2No
ZWNrLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfaGFuZ2NoZWNrLmMKQEAg
LTIyLDggKzIyLDEwIEBACiAgKgogICovCiAKLSNpbmNsdWRlICJpbnRlbF9yZXNldC5oIgogI2lu
Y2x1ZGUgImk5MTVfZHJ2LmgiCisjaW5jbHVkZSAiaW50ZWxfZW5naW5lLmgiCisjaW5jbHVkZSAi
aW50ZWxfZ3QuaCIKKyNpbmNsdWRlICJpbnRlbF9yZXNldC5oIgogCiBzdHJ1Y3QgaGFuZ2NoZWNr
IHsKIAl1NjQgYWN0aGQ7CkBAIC0xMDAsNyArMTAyLDYgQEAgaGVhZF9zdHVjayhzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUsIHU2NCBhY3RoZCkKIHN0YXRpYyBlbnVtIGludGVsX2VuZ2lu
ZV9oYW5nY2hlY2tfYWN0aW9uCiBlbmdpbmVfc3R1Y2soc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lLCB1NjQgYWN0aGQpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gZW5naW5lLT5pOTE1OwogCWVudW0gaW50ZWxfZW5naW5lX2hhbmdjaGVja19hY3Rpb24gaGE7
CiAJdTMyIHRtcDsKIApAQCAtMTA4LDcgKzEwOSw3IEBAIGVuZ2luZV9zdHVjayhzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUsIHU2NCBhY3RoZCkKIAlpZiAoaGEgIT0gRU5HSU5FX0RFQUQp
CiAJCXJldHVybiBoYTsKIAotCWlmIChJU19HRU4oZGV2X3ByaXYsIDIpKQorCWlmIChJU19HRU4o
ZW5naW5lLT5pOTE1LCAyKSkKIAkJcmV0dXJuIEVOR0lORV9ERUFEOwogCiAJLyogSXMgdGhlIGNo
aXAgaGFuZ2luZyBvbiBhIFdBSVRfRk9SX0VWRU5UPwpAQCAtMTE4LDggKzExOSw4IEBAIGVuZ2lu
ZV9zdHVjayhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHU2NCBhY3RoZCkKIAkgKi8K
IAl0bXAgPSBFTkdJTkVfUkVBRChlbmdpbmUsIFJJTkdfQ1RMKTsKIAlpZiAodG1wICYgUklOR19X
QUlUKSB7Ci0JCWk5MTVfaGFuZGxlX2Vycm9yKGRldl9wcml2LCBlbmdpbmUtPm1hc2ssIDAsCi0J
CQkJICAic3R1Y2sgd2FpdCBvbiAlcyIsIGVuZ2luZS0+bmFtZSk7CisJCWludGVsX2d0X2hhbmRs
ZV9lcnJvcihlbmdpbmUtPmd0LCBlbmdpbmUtPm1hc2ssIDAsCisJCQkJICAgICAgInN0dWNrIHdh
aXQgb24gJXMiLCBlbmdpbmUtPm5hbWUpOwogCQlFTkdJTkVfV1JJVEUoZW5naW5lLCBSSU5HX0NU
TCwgdG1wKTsKIAkJcmV0dXJuIEVOR0lORV9XQUlUX0tJQ0s7CiAJfQpAQCAtMjE5LDcgKzIyMCw3
IEBAIHN0YXRpYyB2b2lkIGhhbmdjaGVja19hY2N1bXVsYXRlX3NhbXBsZShzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUsCiAJCQkJIEk5MTVfRU5HSU5FX1dFREdFRF9USU1FT1VUKTsKIH0K
IAotc3RhdGljIHZvaWQgaGFuZ2NoZWNrX2RlY2xhcmVfaGFuZyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKK3N0YXRpYyB2b2lkIGhhbmdjaGVja19kZWNsYXJlX2hhbmcoc3RydWN0IGlu
dGVsX2d0ICpndCwKIAkJCQkgICBpbnRlbF9lbmdpbmVfbWFza190IGh1bmcsCiAJCQkJICAgaW50
ZWxfZW5naW5lX21hc2tfdCBzdHVjaykKIHsKQEAgLTIzNSwxMiArMjM2LDEyIEBAIHN0YXRpYyB2
b2lkIGhhbmdjaGVja19kZWNsYXJlX2hhbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
CiAJCWh1bmcgJj0gfnN0dWNrOwogCWxlbiA9IHNjbnByaW50Zihtc2csIHNpemVvZihtc2cpLAog
CQkJIiVzIG9uICIsIHN0dWNrID09IGh1bmcgPyAibm8gcHJvZ3Jlc3MiIDogImhhbmciKTsKLQlm
b3JfZWFjaF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgaTkxNSwgaHVuZywgdG1wKQorCWZvcl9lYWNo
X2VuZ2luZV9tYXNrZWQoZW5naW5lLCBndC0+aTkxNSwgaHVuZywgdG1wKQogCQlsZW4gKz0gc2Nu
cHJpbnRmKG1zZyArIGxlbiwgc2l6ZW9mKG1zZykgLSBsZW4sCiAJCQkJICIlcywgIiwgZW5naW5l
LT5uYW1lKTsKIAltc2dbbGVuLTJdID0gJ1wwJzsKIAotCXJldHVybiBpOTE1X2hhbmRsZV9lcnJv
cihpOTE1LCBodW5nLCBJOTE1X0VSUk9SX0NBUFRVUkUsICIlcyIsIG1zZyk7CisJcmV0dXJuIGlu
dGVsX2d0X2hhbmRsZV9lcnJvcihndCwgaHVuZywgSTkxNV9FUlJPUl9DQVBUVVJFLCAiJXMiLCBt
c2cpOwogfQogCiAvKgpAQCAtMjUxLDExICsyNTIsMTAgQEAgc3RhdGljIHZvaWQgaGFuZ2NoZWNr
X2RlY2xhcmVfaGFuZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKICAqIHdlIGtpY2sg
dGhlIHJpbmcuIElmIHdlIHNlZSBubyBwcm9ncmVzcyBvbiB0aHJlZSBzdWJzZXF1ZW50IGNhbGxz
CiAgKiB3ZSBhc3N1bWUgY2hpcCBpcyB3ZWRnZWQgYW5kIHRyeSB0byBmaXggaXQgYnkgcmVzZXR0
aW5nIHRoZSBjaGlwLgogICovCi1zdGF0aWMgdm9pZCBpOTE1X2hhbmdjaGVja19lbGFwc2VkKHN0
cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKK3N0YXRpYyB2b2lkIGhhbmdjaGVja19lbGFwc2VkKHN0
cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPQotCQljb250YWluZXJfb2Yod29yaywgdHlwZW9mKCpkZXZfcHJpdiksCi0JCQkgICAg
IGdwdV9lcnJvci5oYW5nY2hlY2tfd29yay53b3JrKTsKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0K
KwkJY29udGFpbmVyX29mKHdvcmssIHR5cGVvZigqZ3QpLCBoYW5nY2hlY2sud29yay53b3JrKTsK
IAlpbnRlbF9lbmdpbmVfbWFza190IGh1bmcgPSAwLCBzdHVjayA9IDAsIHdlZGdlZCA9IDA7CiAJ
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwogCWVudW0gaW50ZWxfZW5naW5lX2lkIGlk
OwpAQCAtMjY0LDEzICsyNjQsMTMgQEAgc3RhdGljIHZvaWQgaTkxNV9oYW5nY2hlY2tfZWxhcHNl
ZChzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCiAJaWYgKCFpOTE1X21vZHBhcmFtcy5lbmFibGVf
aGFuZ2NoZWNrKQogCQlyZXR1cm47CiAKLQlpZiAoIVJFQURfT05DRShkZXZfcHJpdi0+Z3QuYXdh
a2UpKQorCWlmICghUkVBRF9PTkNFKGd0LT5hd2FrZSkpCiAJCXJldHVybjsKIAotCWlmIChpOTE1
X3Rlcm1pbmFsbHlfd2VkZ2VkKGRldl9wcml2KSkKKwlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKGd0
KSkKIAkJcmV0dXJuOwogCi0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3Vz
ZSgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dl
dF9pZl9pbl91c2UoJmd0LT5pOTE1LT5ydW50aW1lX3BtKTsKIAlpZiAoIXdha2VyZWYpCiAJCXJl
dHVybjsKIApAQCAtMjc4LDkgKzI3OCw5IEBAIHN0YXRpYyB2b2lkIGk5MTVfaGFuZ2NoZWNrX2Vs
YXBzZWQoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQogCSAqIHBlcmlvZGljYWxseSBhcm0gdGhl
IG1taW8gY2hlY2tlciB0byBzZWUgaWYgd2UgYXJlIHRyaWdnZXJpbmcKIAkgKiBhbnkgaW52YWxp
ZCBhY2Nlc3MuCiAJICovCi0JaW50ZWxfdW5jb3JlX2FybV91bmNsYWltZWRfbW1pb19kZXRlY3Rp
b24oJmRldl9wcml2LT51bmNvcmUpOworCWludGVsX3VuY29yZV9hcm1fdW5jbGFpbWVkX21taW9f
ZGV0ZWN0aW9uKGd0LT51bmNvcmUpOwogCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZGV2X3By
aXYsIGlkKSB7CisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QtPmk5MTUsIGlkKSB7CiAJCXN0
cnVjdCBoYW5nY2hlY2sgaGM7CiAKIAkJaW50ZWxfZW5naW5lX3NpZ25hbF9icmVhZGNydW1icyhl
bmdpbmUpOwpAQCAtMzAyLDcgKzMwMiw3IEBAIHN0YXRpYyB2b2lkIGk5MTVfaGFuZ2NoZWNrX2Vs
YXBzZWQoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQogCWlmIChHRU1fU0hPV19ERUJVRygpICYm
IChodW5nIHwgc3R1Y2spKSB7CiAJCXN0cnVjdCBkcm1fcHJpbnRlciBwID0gZHJtX2RlYnVnX3By
aW50ZXIoImhhbmdjaGVjayIpOwogCi0JCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGRldl9wcml2
LCBpZCkgeworCQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndC0+aTkxNSwgaWQpIHsKIAkJCWlm
IChpbnRlbF9lbmdpbmVfaXNfaWRsZShlbmdpbmUpKQogCQkJCWNvbnRpbnVlOwogCkBAIC0zMTEs
MjAgKzMxMSwzNiBAQCBzdGF0aWMgdm9pZCBpOTE1X2hhbmdjaGVja19lbGFwc2VkKHN0cnVjdCB3
b3JrX3N0cnVjdCAqd29yaykKIAl9CiAKIAlpZiAod2VkZ2VkKSB7Ci0JCWRldl9lcnIoZGV2X3By
aXYtPmRybS5kZXYsCisJCWRldl9lcnIoZ3QtPmk5MTUtPmRybS5kZXYsCiAJCQkiR1BVIHJlY292
ZXJ5IHRpbWVkIG91dCwiCiAJCQkiIGNhbmNlbGxpbmcgYWxsIGluLWZsaWdodCByZW5kZXJpbmcu
XG4iKTsKIAkJR0VNX1RSQUNFX0RVTVAoKTsKLQkJaTkxNV9nZW1fc2V0X3dlZGdlZChkZXZfcHJp
dik7CisJCWludGVsX2d0X3NldF93ZWRnZWQoZ3QpOwogCX0KIAogCWlmIChodW5nKQotCQloYW5n
Y2hlY2tfZGVjbGFyZV9oYW5nKGRldl9wcml2LCBodW5nLCBzdHVjayk7CisJCWhhbmdjaGVja19k
ZWNsYXJlX2hhbmcoZ3QsIGh1bmcsIHN0dWNrKTsKIAotCWludGVsX3J1bnRpbWVfcG1fcHV0KCZk
ZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmd0
LT5pOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAogCS8qIFJlc2V0IHRpbWVyIGluIGNhc2Ug
R1BVIGhhbmdzIHdpdGhvdXQgYW5vdGhlciByZXF1ZXN0IGJlaW5nIGFkZGVkICovCi0JaTkxNV9x
dWV1ZV9oYW5nY2hlY2soZGV2X3ByaXYpOworCWludGVsX2d0X3F1ZXVlX2hhbmdjaGVjayhndCk7
Cit9CisKK3ZvaWQgaW50ZWxfZ3RfcXVldWVfaGFuZ2NoZWNrKHN0cnVjdCBpbnRlbF9ndCAqZ3Qp
Cit7CisJdW5zaWduZWQgbG9uZyBkZWxheTsKKworCWlmICh1bmxpa2VseSghaTkxNV9tb2RwYXJh
bXMuZW5hYmxlX2hhbmdjaGVjaykpCisJCXJldHVybjsKKworCS8qIERvbid0IGNvbnRpbnVhbGx5
IGRlZmVyIHRoZSBoYW5nY2hlY2sgc28gdGhhdCBpdCBpcyBhbHdheXMgcnVuIGF0CisJICogbGVh
c3Qgb25jZSBhZnRlciB3b3JrIGhhcyBiZWVuIHNjaGVkdWxlZCBvbiBhbnkgcmluZy4gT3RoZXJ3
aXNlLAorCSAqIHdlIHdpbGwgaWdub3JlIGEgaHVuZyByaW5nIGlmIGEgc2Vjb25kIHJpbmcgaXMg
a2VwdCBidXN5LgorCSAqLworCisJZGVsYXkgPSByb3VuZF9qaWZmaWVzX3VwX3JlbGF0aXZlKERS
TV9JOTE1X0hBTkdDSEVDS19KSUZGSUVTKTsKKwlxdWV1ZV9kZWxheWVkX3dvcmsoc3lzdGVtX2xv
bmdfd3EsICZndC0+aGFuZ2NoZWNrLndvcmssIGRlbGF5KTsKIH0KIAogdm9pZCBpbnRlbF9lbmdp
bmVfaW5pdF9oYW5nY2hlY2soc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQpAQCAtMzMz
LDEwICszNDksOSBAQCB2b2lkIGludGVsX2VuZ2luZV9pbml0X2hhbmdjaGVjayhzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJZW5naW5lLT5oYW5nY2hlY2suYWN0aW9uX3RpbWVzdGFt
cCA9IGppZmZpZXM7CiB9CiAKLXZvaWQgaW50ZWxfaGFuZ2NoZWNrX2luaXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCit2b2lkIGludGVsX2d0X2luaXRfaGFuZ2NoZWNrKHN0cnVjdCBp
bnRlbF9ndCAqZ3QpCiB7Ci0JSU5JVF9ERUxBWUVEX1dPUksoJmk5MTUtPmdwdV9lcnJvci5oYW5n
Y2hlY2tfd29yaywKLQkJCSAgaTkxNV9oYW5nY2hlY2tfZWxhcHNlZCk7CisJSU5JVF9ERUxBWUVE
X1dPUksoJmd0LT5oYW5nY2hlY2sud29yaywgaGFuZ2NoZWNrX2VsYXBzZWQpOwogfQogCiAjaWYg
SVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfU0VMRlRFU1QpCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2xyYy5jCmluZGV4IDI3MGVmNDE3ZGQxYS4uOWUwOTkyNDk4MDg3IDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9scmMuYwpAQCAtMjI5Myw3ICsyMjkzLDcgQEAgc3RhdGljIHZvaWQgX19l
eGVjbGlzdHNfcmVzZXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBib29sIHN0YWxs
ZWQpCiAJICogYW5kIGhhdmUgdG8gYXQgbGVhc3QgcmVzdG9yZSB0aGUgUklORyByZWdpc3RlciBp
biB0aGUgY29udGV4dAogCSAqIGltYWdlIGJhY2sgdG8gdGhlIGV4cGVjdGVkIHZhbHVlcyB0byBz
a2lwIG92ZXIgdGhlIGd1aWx0eSByZXF1ZXN0LgogCSAqLwotCWk5MTVfcmVzZXRfcmVxdWVzdChy
cSwgc3RhbGxlZCk7CisJX19pOTE1X3JlcXVlc3RfcmVzZXQocnEsIHN0YWxsZWQpOwogCWlmICgh
c3RhbGxlZCkKIAkJZ290byBvdXRfcmVwbGF5OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
cmVzZXQuYwppbmRleCBhZGZkYjkwODU4N2YuLjdiMTUwZWMzZDEwYSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9yZXNldC5jCkBAIC0xMTQsNyArMTE0LDcgQEAgc3RhdGljIHZvaWQgY29u
dGV4dF9tYXJrX2lubm9jZW50KHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCiAJYXRvbWlj
X2luYygmY3R4LT5hY3RpdmVfY291bnQpOwogfQogCi12b2lkIGk5MTVfcmVzZXRfcmVxdWVzdChz
dHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgYm9vbCBndWlsdHkpCit2b2lkIF9faTkxNV9yZXF1ZXN0
X3Jlc2V0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCBib29sIGd1aWx0eSkKIHsKIAlHRU1fVFJB
Q0UoIiVzIHJxPSVsbHg6JWxsZCwgZ3VpbHR5PyAlc1xuIiwKIAkJICBycS0+ZW5naW5lLT5uYW1l
LApAQCAtMTY0LDE2ICsxNjQsMTUgQEAgc3RhdGljIHZvaWQgZ2VuM19zdG9wX2VuZ2luZShzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJCQkgIGludGVsX3VuY29yZV9yZWFkX2Z3KHVu
Y29yZSwgUklOR19IRUFEKGJhc2UpKSk7CiB9CiAKLXN0YXRpYyB2b2lkIGk5MTVfc3RvcF9lbmdp
bmVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAotCQkJICAgICAgaW50ZWxfZW5naW5l
X21hc2tfdCBlbmdpbmVfbWFzaykKK3N0YXRpYyB2b2lkIHN0b3BfZW5naW5lcyhzdHJ1Y3QgaW50
ZWxfZ3QgKmd0LCBpbnRlbF9lbmdpbmVfbWFza190IGVuZ2luZV9tYXNrKQogewogCXN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKIAlpbnRlbF9lbmdpbmVfbWFza190IHRtcDsKIAotCWlm
IChJTlRFTF9HRU4oaTkxNSkgPCAzKQorCWlmIChJTlRFTF9HRU4oZ3QtPmk5MTUpIDwgMykKIAkJ
cmV0dXJuOwogCi0JZm9yX2VhY2hfZW5naW5lX21hc2tlZChlbmdpbmUsIGk5MTUsIGVuZ2luZV9t
YXNrLCB0bXApCisJZm9yX2VhY2hfZW5naW5lX21hc2tlZChlbmdpbmUsIGd0LT5pOTE1LCBlbmdp
bmVfbWFzaywgdG1wKQogCQlnZW4zX3N0b3BfZW5naW5lKGVuZ2luZSk7CiB9CiAKQEAgLTE4NSwx
MSArMTg0LDExIEBAIHN0YXRpYyBib29sIGk5MTVfaW5fcmVzZXQoc3RydWN0IHBjaV9kZXYgKnBk
ZXYpCiAJcmV0dXJuIGdkcnN0ICYgR1JET01fUkVTRVRfU1RBVFVTOwogfQogCi1zdGF0aWMgaW50
IGk5MTVfZG9fcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCitzdGF0aWMgaW50
IGk5MTVfZG9fcmVzZXQoc3RydWN0IGludGVsX2d0ICpndCwKIAkJCSBpbnRlbF9lbmdpbmVfbWFz
a190IGVuZ2luZV9tYXNrLAogCQkJIHVuc2lnbmVkIGludCByZXRyeSkKIHsKLQlzdHJ1Y3QgcGNp
X2RldiAqcGRldiA9IGk5MTUtPmRybS5wZGV2OworCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gZ3Qt
Pmk5MTUtPmRybS5wZGV2OwogCWludCBlcnI7CiAKIAkvKiBBc3NlcnQgcmVzZXQgZm9yIGF0IGxl
YXN0IDIwIHVzZWMsIGFuZCB3YWl0IGZvciBhY2tub3dsZWRnZW1lbnQuICovCkBAIC0yMTQsMjIg
KzIxMywyMiBAQCBzdGF0aWMgYm9vbCBnNHhfcmVzZXRfY29tcGxldGUoc3RydWN0IHBjaV9kZXYg
KnBkZXYpCiAJcmV0dXJuIChnZHJzdCAmIEdSRE9NX1JFU0VUX0VOQUJMRSkgPT0gMDsKIH0KIAot
c3RhdGljIGludCBnMzNfZG9fcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCitz
dGF0aWMgaW50IGczM19kb19yZXNldChzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAogCQkJaW50ZWxfZW5n
aW5lX21hc2tfdCBlbmdpbmVfbWFzaywKIAkJCXVuc2lnbmVkIGludCByZXRyeSkKIHsKLQlzdHJ1
Y3QgcGNpX2RldiAqcGRldiA9IGk5MTUtPmRybS5wZGV2OworCXN0cnVjdCBwY2lfZGV2ICpwZGV2
ID0gZ3QtPmk5MTUtPmRybS5wZGV2OwogCiAJcGNpX3dyaXRlX2NvbmZpZ19ieXRlKHBkZXYsIEk5
MTVfR0RSU1QsIEdSRE9NX1JFU0VUX0VOQUJMRSk7CiAJcmV0dXJuIHdhaXRfZm9yX2F0b21pYyhn
NHhfcmVzZXRfY29tcGxldGUocGRldiksIDUwKTsKIH0KIAotc3RhdGljIGludCBnNHhfZG9fcmVz
ZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCitzdGF0aWMgaW50IGc0eF9kb19yZXNl
dChzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAogCQkJaW50ZWxfZW5naW5lX21hc2tfdCBlbmdpbmVfbWFz
aywKIAkJCXVuc2lnbmVkIGludCByZXRyeSkKIHsKLQlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGk5
MTUtPmRybS5wZGV2OwotCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZpOTE1LT51bmNv
cmU7CisJc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBndC0+aTkxNS0+ZHJtLnBkZXY7CisJc3RydWN0
IGludGVsX3VuY29yZSAqdW5jb3JlID0gZ3QtPnVuY29yZTsKIAlpbnQgcmV0OwogCiAJLyogV2FW
Y3BDbGtHYXRlRGlzYWJsZUZvck1lZGlhUmVzZXQ6Y3RnLGVsayAqLwpAQCAtMjYxLDExICsyNjAs
MTEgQEAgc3RhdGljIGludCBnNHhfZG9fcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIGludCBpcm9ubGFrZV9kb19yZXNldChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKK3N0YXRpYyBpbnQgaXJvbmxha2VfZG9fcmVzZXQo
c3RydWN0IGludGVsX2d0ICpndCwKIAkJCSAgICAgaW50ZWxfZW5naW5lX21hc2tfdCBlbmdpbmVf
bWFzaywKIAkJCSAgICAgdW5zaWduZWQgaW50IHJldHJ5KQogewotCXN0cnVjdCBpbnRlbF91bmNv
cmUgKnVuY29yZSA9ICZpOTE1LT51bmNvcmU7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3Jl
ID0gZ3QtPnVuY29yZTsKIAlpbnQgcmV0OwogCiAJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29y
ZSwgSUxLX0dEU1IsCkBAIC0yOTcsMTAgKzI5Niw5IEBAIHN0YXRpYyBpbnQgaXJvbmxha2VfZG9f
cmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiB9CiAKIC8qIFJlc2V0IHRoZSBo
YXJkd2FyZSBkb21haW5zIChHRU5YX0dSRE9NXyopIHNwZWNpZmllZCBieSBtYXNrICovCi1zdGF0
aWMgaW50IGdlbjZfaHdfZG9tYWluX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAotCQkJCXUzMiBod19kb21haW5fbWFzaykKK3N0YXRpYyBpbnQgZ2VuNl9od19kb21haW5fcmVz
ZXQoc3RydWN0IGludGVsX2d0ICpndCwgdTMyIGh3X2RvbWFpbl9tYXNrKQogewotCXN0cnVjdCBp
bnRlbF91bmNvcmUgKnVuY29yZSA9ICZpOTE1LT51bmNvcmU7CisJc3RydWN0IGludGVsX3VuY29y
ZSAqdW5jb3JlID0gZ3QtPnVuY29yZTsKIAlpbnQgZXJyOwogCiAJLyoKQEAgLTMyMiw3ICszMjAs
NyBAQCBzdGF0aWMgaW50IGdlbjZfaHdfZG9tYWluX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAogCXJldHVybiBlcnI7CiB9CiAKLXN0YXRpYyBpbnQgZ2VuNl9yZXNldF9lbmdp
bmVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAorc3RhdGljIGludCBnZW42X3Jlc2V0
X2VuZ2luZXMoc3RydWN0IGludGVsX2d0ICpndCwKIAkJCSAgICAgIGludGVsX2VuZ2luZV9tYXNr
X3QgZW5naW5lX21hc2ssCiAJCQkgICAgICB1bnNpZ25lZCBpbnQgcmV0cnkpCiB7CkBAIC0zNDIs
MTMgKzM0MCwxMyBAQCBzdGF0aWMgaW50IGdlbjZfcmVzZXRfZW5naW5lcyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKIAkJaW50ZWxfZW5naW5lX21hc2tfdCB0bXA7CiAKIAkJaHdfbWFz
ayA9IDA7Ci0JCWZvcl9lYWNoX2VuZ2luZV9tYXNrZWQoZW5naW5lLCBpOTE1LCBlbmdpbmVfbWFz
aywgdG1wKSB7CisJCWZvcl9lYWNoX2VuZ2luZV9tYXNrZWQoZW5naW5lLCBndC0+aTkxNSwgZW5n
aW5lX21hc2ssIHRtcCkgewogCQkJR0VNX0JVR19PTihlbmdpbmUtPmlkID49IEFSUkFZX1NJWkUo
aHdfZW5naW5lX21hc2spKTsKIAkJCWh3X21hc2sgfD0gaHdfZW5naW5lX21hc2tbZW5naW5lLT5p
ZF07CiAJCX0KIAl9CiAKLQlyZXR1cm4gZ2VuNl9od19kb21haW5fcmVzZXQoaTkxNSwgaHdfbWFz
ayk7CisJcmV0dXJuIGdlbjZfaHdfZG9tYWluX3Jlc2V0KGd0LCBod19tYXNrKTsKIH0KIAogc3Rh
dGljIHUzMiBnZW4xMV9sb2NrX3NmYyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCkBA
IC00NDYsNyArNDQ0LDcgQEAgc3RhdGljIHZvaWQgZ2VuMTFfdW5sb2NrX3NmYyhzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJcm13X2NsZWFyX2Z3KHVuY29yZSwgc2ZjX2ZvcmNlZF9s
b2NrLCBzZmNfZm9yY2VkX2xvY2tfYml0KTsKIH0KIAotc3RhdGljIGludCBnZW4xMV9yZXNldF9l
bmdpbmVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAorc3RhdGljIGludCBnZW4xMV9y
ZXNldF9lbmdpbmVzKHN0cnVjdCBpbnRlbF9ndCAqZ3QsCiAJCQkgICAgICAgaW50ZWxfZW5naW5l
X21hc2tfdCBlbmdpbmVfbWFzaywKIAkJCSAgICAgICB1bnNpZ25lZCBpbnQgcmV0cnkpCiB7CkBA
IC00NjksMTcgKzQ2NywxNyBAQCBzdGF0aWMgaW50IGdlbjExX3Jlc2V0X2VuZ2luZXMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCWh3X21hc2sgPSBHRU4xMV9HUkRPTV9GVUxMOwog
CX0gZWxzZSB7CiAJCWh3X21hc2sgPSAwOwotCQlmb3JfZWFjaF9lbmdpbmVfbWFza2VkKGVuZ2lu
ZSwgaTkxNSwgZW5naW5lX21hc2ssIHRtcCkgeworCQlmb3JfZWFjaF9lbmdpbmVfbWFza2VkKGVu
Z2luZSwgZ3QtPmk5MTUsIGVuZ2luZV9tYXNrLCB0bXApIHsKIAkJCUdFTV9CVUdfT04oZW5naW5l
LT5pZCA+PSBBUlJBWV9TSVpFKGh3X2VuZ2luZV9tYXNrKSk7CiAJCQlod19tYXNrIHw9IGh3X2Vu
Z2luZV9tYXNrW2VuZ2luZS0+aWRdOwogCQkJaHdfbWFzayB8PSBnZW4xMV9sb2NrX3NmYyhlbmdp
bmUpOwogCQl9CiAJfQogCi0JcmV0ID0gZ2VuNl9od19kb21haW5fcmVzZXQoaTkxNSwgaHdfbWFz
ayk7CisJcmV0ID0gZ2VuNl9od19kb21haW5fcmVzZXQoZ3QsIGh3X21hc2spOwogCiAJaWYgKGVu
Z2luZV9tYXNrICE9IEFMTF9FTkdJTkVTKQotCQlmb3JfZWFjaF9lbmdpbmVfbWFza2VkKGVuZ2lu
ZSwgaTkxNSwgZW5naW5lX21hc2ssIHRtcCkKKwkJZm9yX2VhY2hfZW5naW5lX21hc2tlZChlbmdp
bmUsIGd0LT5pOTE1LCBlbmdpbmVfbWFzaywgdG1wKQogCQkJZ2VuMTFfdW5sb2NrX3NmYyhlbmdp
bmUpOwogCiAJcmV0dXJuIHJldDsKQEAgLTUyOSw3ICs1MjcsNyBAQCBzdGF0aWMgdm9pZCBnZW44
X2VuZ2luZV9yZXNldF9jYW5jZWwoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCQkJ
ICAgICAgX01BU0tFRF9CSVRfRElTQUJMRShSRVNFVF9DVExfUkVRVUVTVF9SRVNFVCkpOwogfQog
Ci1zdGF0aWMgaW50IGdlbjhfcmVzZXRfZW5naW5lcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKK3N0YXRpYyBpbnQgZ2VuOF9yZXNldF9lbmdpbmVzKHN0cnVjdCBpbnRlbF9ndCAqZ3Qs
CiAJCQkgICAgICBpbnRlbF9lbmdpbmVfbWFza190IGVuZ2luZV9tYXNrLAogCQkJICAgICAgdW5z
aWduZWQgaW50IHJldHJ5KQogewpAQCAtNTM4LDcgKzUzNiw3IEBAIHN0YXRpYyBpbnQgZ2VuOF9y
ZXNldF9lbmdpbmVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCWludGVsX2VuZ2lu
ZV9tYXNrX3QgdG1wOwogCWludCByZXQ7CiAKLQlmb3JfZWFjaF9lbmdpbmVfbWFza2VkKGVuZ2lu
ZSwgaTkxNSwgZW5naW5lX21hc2ssIHRtcCkgeworCWZvcl9lYWNoX2VuZ2luZV9tYXNrZWQoZW5n
aW5lLCBndC0+aTkxNSwgZW5naW5lX21hc2ssIHRtcCkgewogCQlyZXQgPSBnZW44X2VuZ2luZV9y
ZXNldF9wcmVwYXJlKGVuZ2luZSk7CiAJCWlmIChyZXQgJiYgIXJlc2V0X25vbl9yZWFkeSkKIAkJ
CWdvdG8gc2tpcF9yZXNldDsKQEAgLTU1NCwyMyArNTUyLDIzIEBAIHN0YXRpYyBpbnQgZ2VuOF9y
ZXNldF9lbmdpbmVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCQkgKiBXZSByYXRo
ZXIgdGFrZSBjb250ZXh0IGNvcnJ1cHRpb24gaW5zdGVhZCBvZgogCQkgKiBmYWlsZWQgcmVzZXQg
d2l0aCBhIHdlZGdlZCBkcml2ZXIvZ3B1LiBBbmQKIAkJICogYWN0aXZlIGJiIGV4ZWN1dGlvbiBj
YXNlIHNob3VsZCBiZSBjb3ZlcmVkIGJ5Ci0JCSAqIGk5MTVfc3RvcF9lbmdpbmVzIHdlIGhhdmUg
YmVmb3JlIHRoZSByZXNldC4KKwkJICogc3RvcF9lbmdpbmVzKCkgd2UgaGF2ZSBiZWZvcmUgdGhl
IHJlc2V0LgogCQkgKi8KIAl9CiAKLQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKQotCQlyZXQg
PSBnZW4xMV9yZXNldF9lbmdpbmVzKGk5MTUsIGVuZ2luZV9tYXNrLCByZXRyeSk7CisJaWYgKElO
VEVMX0dFTihndC0+aTkxNSkgPj0gMTEpCisJCXJldCA9IGdlbjExX3Jlc2V0X2VuZ2luZXMoZ3Qs
IGVuZ2luZV9tYXNrLCByZXRyeSk7CiAJZWxzZQotCQlyZXQgPSBnZW42X3Jlc2V0X2VuZ2luZXMo
aTkxNSwgZW5naW5lX21hc2ssIHJldHJ5KTsKKwkJcmV0ID0gZ2VuNl9yZXNldF9lbmdpbmVzKGd0
LCBlbmdpbmVfbWFzaywgcmV0cnkpOwogCiBza2lwX3Jlc2V0OgotCWZvcl9lYWNoX2VuZ2luZV9t
YXNrZWQoZW5naW5lLCBpOTE1LCBlbmdpbmVfbWFzaywgdG1wKQorCWZvcl9lYWNoX2VuZ2luZV9t
YXNrZWQoZW5naW5lLCBndC0+aTkxNSwgZW5naW5lX21hc2ssIHRtcCkKIAkJZ2VuOF9lbmdpbmVf
cmVzZXRfY2FuY2VsKGVuZ2luZSk7CiAKIAlyZXR1cm4gcmV0OwogfQogCi10eXBlZGVmIGludCAo
KnJlc2V0X2Z1bmMpKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICosCit0eXBlZGVmIGludCAoKnJl
c2V0X2Z1bmMpKHN0cnVjdCBpbnRlbF9ndCAqLAogCQkJICBpbnRlbF9lbmdpbmVfbWFza190IGVu
Z2luZV9tYXNrLAogCQkJICB1bnNpZ25lZCBpbnQgcmV0cnkpOwogCkBAIC01OTIsMTUgKzU5MCwx
NCBAQCBzdGF0aWMgcmVzZXRfZnVuYyBpbnRlbF9nZXRfZ3B1X3Jlc2V0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQogCQlyZXR1cm4gTlVMTDsKIH0KIAotaW50IGludGVsX2dwdV9yZXNl
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKLQkJICAgIGludGVsX2VuZ2luZV9tYXNr
X3QgZW5naW5lX21hc2spCitpbnQgX19pbnRlbF9ndF9yZXNldChzdHJ1Y3QgaW50ZWxfZ3QgKmd0
LCBpbnRlbF9lbmdpbmVfbWFza190IGVuZ2luZV9tYXNrKQogewogCWNvbnN0IGludCByZXRyaWVz
ID0gZW5naW5lX21hc2sgPT0gQUxMX0VOR0lORVMgPyBSRVNFVF9NQVhfUkVUUklFUyA6IDE7CiAJ
cmVzZXRfZnVuYyByZXNldDsKIAlpbnQgcmV0ID0gLUVUSU1FRE9VVDsKIAlpbnQgcmV0cnk7CiAK
LQlyZXNldCA9IGludGVsX2dldF9ncHVfcmVzZXQoaTkxNSk7CisJcmVzZXQgPSBpbnRlbF9nZXRf
Z3B1X3Jlc2V0KGd0LT5pOTE1KTsKIAlpZiAoIXJlc2V0KQogCQlyZXR1cm4gLUVOT0RFVjsKIApA
QCAtNjA4LDcgKzYwNSw3IEBAIGludCBpbnRlbF9ncHVfcmVzZXQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCiAJICogSWYgdGhlIHBvd2VyIHdlbGwgc2xlZXBzIGR1cmluZyB0aGUgcmVz
ZXQsIHRoZSByZXNldAogCSAqIHJlcXVlc3QgbWF5IGJlIGRyb3BwZWQgYW5kIG5ldmVyIGNvbXBs
ZXRlcyAoY2F1c2luZyAtRUlPKS4KIAkgKi8KLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgm
aTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKKwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dl
dChndC0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKIAlmb3IgKHJldHJ5ID0gMDsgcmV0ID09IC1F
VElNRURPVVQgJiYgcmV0cnkgPCByZXRyaWVzOyByZXRyeSsrKSB7CiAJCS8qCiAJCSAqIFdlIHN0
b3AgZW5naW5lcywgb3RoZXJ3aXNlIHdlIG1pZ2h0IGdldCBmYWlsZWQgcmVzZXQgYW5kIGEKQEAg
LTYyNSwxNCArNjIyLDE0IEBAIGludCBpbnRlbF9ncHVfcmVzZXQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCiAJCSAqIEZJWE1FOiBXYSBmb3IgbW9yZSBtb2Rlcm4gZ2VucyBuZWVkcyB0
byBiZSB2YWxpZGF0ZWQKIAkJICovCiAJCWlmIChyZXRyeSkKLQkJCWk5MTVfc3RvcF9lbmdpbmVz
KGk5MTUsIGVuZ2luZV9tYXNrKTsKKwkJCXN0b3BfZW5naW5lcyhndCwgZW5naW5lX21hc2spOwog
CiAJCUdFTV9UUkFDRSgiZW5naW5lX21hc2s9JXhcbiIsIGVuZ2luZV9tYXNrKTsKIAkJcHJlZW1w
dF9kaXNhYmxlKCk7Ci0JCXJldCA9IHJlc2V0KGk5MTUsIGVuZ2luZV9tYXNrLCByZXRyeSk7CisJ
CXJldCA9IHJlc2V0KGd0LCBlbmdpbmVfbWFzaywgcmV0cnkpOwogCQlwcmVlbXB0X2VuYWJsZSgp
OwogCX0KLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdB
S0VfQUxMKTsKKwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dChndC0+dW5jb3JlLCBGT1JDRVdB
S0VfQUxMKTsKIAogCXJldHVybiByZXQ7CiB9CkBAIC02NTAsMTcgKzY0NywxNyBAQCBib29sIGlu
dGVsX2hhc19yZXNldF9lbmdpbmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJcmV0
dXJuIElOVEVMX0lORk8oaTkxNSktPmhhc19yZXNldF9lbmdpbmUgJiYgaTkxNV9tb2RwYXJhbXMu
cmVzZXQgPj0gMjsKIH0KIAotaW50IGludGVsX3Jlc2V0X2d1YyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKK2ludCBpbnRlbF9yZXNldF9ndWMoc3RydWN0IGludGVsX2d0ICpndCkKIHsK
IAl1MzIgZ3VjX2RvbWFpbiA9Ci0JCUlOVEVMX0dFTihpOTE1KSA+PSAxMSA/IEdFTjExX0dSRE9N
X0dVQyA6IEdFTjlfR1JET01fR1VDOworCQlJTlRFTF9HRU4oZ3QtPmk5MTUpID49IDExID8gR0VO
MTFfR1JET01fR1VDIDogR0VOOV9HUkRPTV9HVUM7CiAJaW50IHJldDsKIAotCUdFTV9CVUdfT04o
IUhBU19HVUMoaTkxNSkpOworCUdFTV9CVUdfT04oIUhBU19HVUMoZ3QtPmk5MTUpKTsKIAotCWlu
dGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwot
CXJldCA9IGdlbjZfaHdfZG9tYWluX3Jlc2V0KGk5MTUsIGd1Y19kb21haW4pOwotCWludGVsX3Vu
Y29yZV9mb3JjZXdha2VfcHV0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOworCWludGVs
X3VuY29yZV9mb3JjZXdha2VfZ2V0KGd0LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOworCXJldCA9
IGdlbjZfaHdfZG9tYWluX3Jlc2V0KGd0LCBndWNfZG9tYWluKTsKKwlpbnRlbF91bmNvcmVfZm9y
Y2V3YWtlX3B1dChndC0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKIAogCXJldHVybiByZXQ7CiB9
CkBAIC02ODIsNTYgKzY3OSw1NSBAQCBzdGF0aWMgdm9pZCByZXNldF9wcmVwYXJlX2VuZ2luZShz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJZW5naW5lLT5yZXNldC5wcmVwYXJlKGVu
Z2luZSk7CiB9CiAKLXN0YXRpYyB2b2lkIHJldm9rZV9tbWFwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKK3N0YXRpYyB2b2lkIHJldm9rZV9tbWFwcyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0
KQogewogCWludCBpOwogCi0JZm9yIChpID0gMDsgaSA8IGk5MTUtPmdndHQubnVtX2ZlbmNlczsg
aSsrKSB7CisJZm9yIChpID0gMDsgaSA8IGd0LT5nZ3R0LT5udW1fZmVuY2VzOyBpKyspIHsKIAkJ
c3RydWN0IGRybV92bWFfb2Zmc2V0X25vZGUgKm5vZGU7CiAJCXN0cnVjdCBpOTE1X3ZtYSAqdm1h
OwogCQl1NjQgdm1hX29mZnNldDsKIAotCQl2bWEgPSBSRUFEX09OQ0UoaTkxNS0+Z2d0dC5mZW5j
ZV9yZWdzW2ldLnZtYSk7CisJCXZtYSA9IFJFQURfT05DRShndC0+Z2d0dC0+ZmVuY2VfcmVnc1tp
XS52bWEpOwogCQlpZiAoIXZtYSkKIAkJCWNvbnRpbnVlOwogCiAJCWlmICghaTkxNV92bWFfaGFz
X3VzZXJmYXVsdCh2bWEpKQogCQkJY29udGludWU7CiAKLQkJR0VNX0JVR19PTih2bWEtPmZlbmNl
ICE9ICZpOTE1LT5nZ3R0LmZlbmNlX3JlZ3NbaV0pOworCQlHRU1fQlVHX09OKHZtYS0+ZmVuY2Ug
IT0gJmd0LT5nZ3R0LT5mZW5jZV9yZWdzW2ldKTsKIAkJbm9kZSA9ICZ2bWEtPm9iai0+YmFzZS52
bWFfbm9kZTsKIAkJdm1hX29mZnNldCA9IHZtYS0+Z2d0dF92aWV3LnBhcnRpYWwub2Zmc2V0IDw8
IFBBR0VfU0hJRlQ7Ci0JCXVubWFwX21hcHBpbmdfcmFuZ2UoaTkxNS0+ZHJtLmFub25faW5vZGUt
PmlfbWFwcGluZywKKwkJdW5tYXBfbWFwcGluZ19yYW5nZShndC0+aTkxNS0+ZHJtLmFub25faW5v
ZGUtPmlfbWFwcGluZywKIAkJCQkgICAgZHJtX3ZtYV9ub2RlX29mZnNldF9hZGRyKG5vZGUpICsg
dm1hX29mZnNldCwKIAkJCQkgICAgdm1hLT5zaXplLAogCQkJCSAgICAxKTsKIAl9CiB9CiAKLXN0
YXRpYyBpbnRlbF9lbmdpbmVfbWFza190IHJlc2V0X3ByZXBhcmUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCitzdGF0aWMgaW50ZWxfZW5naW5lX21hc2tfdCByZXNldF9wcmVwYXJlKHN0
cnVjdCBpbnRlbF9ndCAqZ3QpCiB7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwog
CWludGVsX2VuZ2luZV9tYXNrX3QgYXdha2UgPSAwOwogCWVudW0gaW50ZWxfZW5naW5lX2lkIGlk
OwogCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKKwlmb3JfZWFjaF9lbmdp
bmUoZW5naW5lLCBndC0+aTkxNSwgaWQpIHsKIAkJaWYgKGludGVsX2VuZ2luZV9wbV9nZXRfaWZf
YXdha2UoZW5naW5lKSkKIAkJCWF3YWtlIHw9IGVuZ2luZS0+bWFzazsKIAkJcmVzZXRfcHJlcGFy
ZV9lbmdpbmUoZW5naW5lKTsKIAl9CiAKLQlpbnRlbF91Y19yZXNldF9wcmVwYXJlKGk5MTUpOwor
CWludGVsX3VjX3Jlc2V0X3ByZXBhcmUoZ3QtPmk5MTUpOwogCiAJcmV0dXJuIGF3YWtlOwogfQog
Ci1zdGF0aWMgdm9pZCBndF9yZXZva2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCitz
dGF0aWMgdm9pZCBndF9yZXZva2Uoc3RydWN0IGludGVsX2d0ICpndCkKIHsKLQlyZXZva2VfbW1h
cHMoaTkxNSk7CisJcmV2b2tlX21tYXBzKGd0KTsKIH0KIAotc3RhdGljIGludCBndF9yZXNldChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKLQkJICAgIGludGVsX2VuZ2luZV9tYXNrX3Qg
c3RhbGxlZF9tYXNrKQorc3RhdGljIGludCBndF9yZXNldChzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBp
bnRlbF9lbmdpbmVfbWFza190IHN0YWxsZWRfbWFzaykKIHsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmU7CiAJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CkBAIC03NDEsMTQgKzczNywx
NCBAQCBzdGF0aWMgaW50IGd0X3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAog
CSAqIEV2ZXJ5dGhpbmcgZGVwZW5kcyBvbiBoYXZpbmcgdGhlIEdUVCBydW5uaW5nLCBzbyB3ZSBu
ZWVkIHRvIHN0YXJ0CiAJICogdGhlcmUuCiAJICovCi0JZXJyID0gaTkxNV9nZ3R0X2VuYWJsZV9o
dyhpOTE1KTsKKwllcnIgPSBpOTE1X2dndHRfZW5hYmxlX2h3KGd0LT5pOTE1KTsKIAlpZiAoZXJy
KQogCQlyZXR1cm4gZXJyOwogCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpCi0J
CWludGVsX2VuZ2luZV9yZXNldChlbmdpbmUsIHN0YWxsZWRfbWFzayAmIGVuZ2luZS0+bWFzayk7
CisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QtPmk5MTUsIGlkKQorCQlfX2ludGVsX2VuZ2lu
ZV9yZXNldChlbmdpbmUsIHN0YWxsZWRfbWFzayAmIGVuZ2luZS0+bWFzayk7CiAKLQlpOTE1X2dl
bV9yZXN0b3JlX2ZlbmNlcyhpOTE1KTsKKwlpOTE1X2dlbV9yZXN0b3JlX2ZlbmNlcyhndC0+aTkx
NSk7CiAKIAlyZXR1cm4gZXJyOwogfQpAQCAtNzYxLDEzICs3NTcsMTIgQEAgc3RhdGljIHZvaWQg
cmVzZXRfZmluaXNoX2VuZ2luZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJaW50
ZWxfZW5naW5lX3NpZ25hbF9icmVhZGNydW1icyhlbmdpbmUpOwogfQogCi1zdGF0aWMgdm9pZCBy
ZXNldF9maW5pc2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCi0JCQkgaW50ZWxfZW5n
aW5lX21hc2tfdCBhd2FrZSkKK3N0YXRpYyB2b2lkIHJlc2V0X2ZpbmlzaChzdHJ1Y3QgaW50ZWxf
Z3QgKmd0LCBpbnRlbF9lbmdpbmVfbWFza190IGF3YWtlKQogewogCXN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZTsKIAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKIAotCWZvcl9lYWNoX2Vu
Z2luZShlbmdpbmUsIGk5MTUsIGlkKSB7CisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QtPmk5
MTUsIGlkKSB7CiAJCXJlc2V0X2ZpbmlzaF9lbmdpbmUoZW5naW5lKTsKIAkJaWYgKGF3YWtlICYg
ZW5naW5lLT5tYXNrKQogCQkJaW50ZWxfZW5naW5lX3BtX3B1dChlbmdpbmUpOwpAQCAtNzkxLDIw
ICs3ODYsMTkgQEAgc3RhdGljIHZvaWQgbm9wX3N1Ym1pdF9yZXF1ZXN0KHN0cnVjdCBpOTE1X3Jl
cXVlc3QgKnJlcXVlc3QpCiAJaW50ZWxfZW5naW5lX3F1ZXVlX2JyZWFkY3J1bWJzKGVuZ2luZSk7
CiB9CiAKLXN0YXRpYyB2b2lkIF9faTkxNV9nZW1fc2V0X3dlZGdlZChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKK3N0YXRpYyB2b2lkIF9faW50ZWxfZ3Rfc2V0X3dlZGdlZChzdHJ1Y3Qg
aW50ZWxfZ3QgKmd0KQogewotCXN0cnVjdCBpOTE1X2dwdV9lcnJvciAqZXJyb3IgPSAmaTkxNS0+
Z3B1X2Vycm9yOwogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKIAlpbnRlbF9lbmdp
bmVfbWFza190IGF3YWtlOwogCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwogCi0JaWYgKHRlc3Rf
Yml0KEk5MTVfV0VER0VELCAmZXJyb3ItPmZsYWdzKSkKKwlpZiAodGVzdF9iaXQoSTkxNV9XRURH
RUQsICZndC0+cmVzZXQuZmxhZ3MpKQogCQlyZXR1cm47CiAKLQlpZiAoR0VNX1NIT1dfREVCVUco
KSAmJiAhaW50ZWxfZW5naW5lc19hcmVfaWRsZShpOTE1KSkgeworCWlmIChHRU1fU0hPV19ERUJV
RygpICYmICFpbnRlbF9lbmdpbmVzX2FyZV9pZGxlKGd0KSkgewogCQlzdHJ1Y3QgZHJtX3ByaW50
ZXIgcCA9IGRybV9kZWJ1Z19wcmludGVyKF9fZnVuY19fKTsKIAotCQlmb3JfZWFjaF9lbmdpbmUo
ZW5naW5lLCBpOTE1LCBpZCkKKwkJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QtPmk5MTUsIGlk
KQogCQkJaW50ZWxfZW5naW5lX2R1bXAoZW5naW5lLCAmcCwgIiVzXG4iLCBlbmdpbmUtPm5hbWUp
OwogCX0KIApAQCAtODE1LDE3ICs4MDksMTcgQEAgc3RhdGljIHZvaWQgX19pOTE1X2dlbV9zZXRf
d2VkZ2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCSAqIHJvbGxpbmcgdGhlIGds
b2JhbCBzZXFubyBmb3J3YXJkIChzaW5jZSB0aGlzIHdvdWxkIGNvbXBsZXRlIHJlcXVlc3RzCiAJ
ICogZm9yIHdoaWNoIHdlIGhhdmVuJ3Qgc2V0IHRoZSBmZW5jZSBlcnJvciB0byBFSU8geWV0KS4K
IAkgKi8KLQlhd2FrZSA9IHJlc2V0X3ByZXBhcmUoaTkxNSk7CisJYXdha2UgPSByZXNldF9wcmVw
YXJlKGd0KTsKIAogCS8qIEV2ZW4gaWYgdGhlIEdQVSByZXNldCBmYWlscywgaXQgc2hvdWxkIHN0
aWxsIHN0b3AgdGhlIGVuZ2luZXMgKi8KLQlpZiAoIUlOVEVMX0lORk8oaTkxNSktPmdwdV9yZXNl
dF9jbG9iYmVyc19kaXNwbGF5KQotCQlpbnRlbF9ncHVfcmVzZXQoaTkxNSwgQUxMX0VOR0lORVMp
OworCWlmICghSU5URUxfSU5GTyhndC0+aTkxNSktPmdwdV9yZXNldF9jbG9iYmVyc19kaXNwbGF5
KQorCQlfX2ludGVsX2d0X3Jlc2V0KGd0LCBBTExfRU5HSU5FUyk7CiAKLQlmb3JfZWFjaF9lbmdp
bmUoZW5naW5lLCBpOTE1LCBpZCkgeworCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LT5pOTE1
LCBpZCkgewogCQllbmdpbmUtPnN1Ym1pdF9yZXF1ZXN0ID0gbm9wX3N1Ym1pdF9yZXF1ZXN0Owog
CQllbmdpbmUtPnNjaGVkdWxlID0gTlVMTDsKIAl9Ci0JaTkxNS0+Y2Fwcy5zY2hlZHVsZXIgPSAw
OworCWd0LT5pOTE1LT5jYXBzLnNjaGVkdWxlciA9IDA7CiAKIAkvKgogCSAqIE1ha2Ugc3VyZSBu
byByZXF1ZXN0IGNhbiBzbGlwIHRocm91Z2ggd2l0aG91dCBnZXR0aW5nIGNvbXBsZXRlZCBieQpA
QCAtODMzLDM3ICs4MjcsMzYgQEAgc3RhdGljIHZvaWQgX19pOTE1X2dlbV9zZXRfd2VkZ2VkKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCSAqIGluIG5vcF9zdWJtaXRfcmVxdWVzdC4K
IAkgKi8KIAlzeW5jaHJvbml6ZV9yY3VfZXhwZWRpdGVkKCk7Ci0Jc2V0X2JpdChJOTE1X1dFREdF
RCwgJmVycm9yLT5mbGFncyk7CisJc2V0X2JpdChJOTE1X1dFREdFRCwgJmd0LT5yZXNldC5mbGFn
cyk7CiAKIAkvKiBNYXJrIGFsbCBleGVjdXRpbmcgcmVxdWVzdHMgYXMgc2tpcHBlZCAqLwotCWZv
cl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKQorCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUs
IGd0LT5pOTE1LCBpZCkKIAkJZW5naW5lLT5jYW5jZWxfcmVxdWVzdHMoZW5naW5lKTsKIAotCXJl
c2V0X2ZpbmlzaChpOTE1LCBhd2FrZSk7CisJcmVzZXRfZmluaXNoKGd0LCBhd2FrZSk7CiAKIAlH
RU1fVFJBQ0UoImVuZFxuIik7CiB9CiAKLXZvaWQgaTkxNV9nZW1fc2V0X3dlZGdlZChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKK3ZvaWQgaW50ZWxfZ3Rfc2V0X3dlZGdlZChzdHJ1Y3Qg
aW50ZWxfZ3QgKmd0KQogewotCXN0cnVjdCBpOTE1X2dwdV9lcnJvciAqZXJyb3IgPSAmaTkxNS0+
Z3B1X2Vycm9yOwogCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwogCi0JbXV0ZXhfbG9jaygmZXJy
b3ItPndlZGdlX211dGV4KTsKLQl3aXRoX2ludGVsX3J1bnRpbWVfcG0oJmk5MTUtPnJ1bnRpbWVf
cG0sIHdha2VyZWYpCi0JCV9faTkxNV9nZW1fc2V0X3dlZGdlZChpOTE1KTsKLQltdXRleF91bmxv
Y2soJmVycm9yLT53ZWRnZV9tdXRleCk7CisJbXV0ZXhfbG9jaygmZ3QtPnJlc2V0Lm11dGV4KTsK
Kwl3aXRoX2ludGVsX3J1bnRpbWVfcG0oJmd0LT5pOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKQor
CQlfX2ludGVsX2d0X3NldF93ZWRnZWQoZ3QpOworCW11dGV4X3VubG9jaygmZ3QtPnJlc2V0Lm11
dGV4KTsKIH0KIAotc3RhdGljIGJvb2wgX19pOTE1X2dlbV91bnNldF93ZWRnZWQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCitzdGF0aWMgYm9vbCBfX2ludGVsX2d0X3Vuc2V0X3dlZGdl
ZChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewotCXN0cnVjdCBpOTE1X2dwdV9lcnJvciAqZXJyb3Ig
PSAmaTkxNS0+Z3B1X2Vycm9yOworCXN0cnVjdCBpbnRlbF9ndF90aW1lbGluZXMgKnRpbWVsaW5l
cyA9ICZndC0+dGltZWxpbmVzOwogCXN0cnVjdCBpbnRlbF90aW1lbGluZSAqdGw7CiAKLQlpZiAo
IXRlc3RfYml0KEk5MTVfV0VER0VELCAmZXJyb3ItPmZsYWdzKSkKKwlpZiAoIXRlc3RfYml0KEk5
MTVfV0VER0VELCAmZ3QtPnJlc2V0LmZsYWdzKSkKIAkJcmV0dXJuIHRydWU7CiAKLQlpZiAoIWk5
MTUtPmd0LnNjcmF0Y2gpIC8qIE5ldmVyIGZ1bGwgaW5pdGlhbGlzZWQsIHJlY292ZXJ5IGltcG9z
c2libGUgKi8KKwlpZiAoIWd0LT5zY3JhdGNoKSAvKiBOZXZlciBmdWxsIGluaXRpYWxpc2VkLCBy
ZWNvdmVyeSBpbXBvc3NpYmxlICovCiAJCXJldHVybiBmYWxzZTsKIAogCUdFTV9UUkFDRSgic3Rh
cnRcbiIpOwpAQCAtODc4LDggKzg3MSw4IEBAIHN0YXRpYyBib29sIF9faTkxNV9nZW1fdW5zZXRf
d2VkZ2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCSAqCiAJICogTm8gbW9yZSBj
YW4gYmUgc3VibWl0dGVkIHVudGlsIHdlIHJlc2V0IHRoZSB3ZWRnZWQgYml0LgogCSAqLwotCW11
dGV4X2xvY2soJmk5MTUtPmd0LnRpbWVsaW5lcy5tdXRleCk7Ci0JbGlzdF9mb3JfZWFjaF9lbnRy
eSh0bCwgJmk5MTUtPmd0LnRpbWVsaW5lcy5hY3RpdmVfbGlzdCwgbGluaykgeworCW11dGV4X2xv
Y2soJnRpbWVsaW5lcy0+bXV0ZXgpOworCWxpc3RfZm9yX2VhY2hfZW50cnkodGwsICZ0aW1lbGlu
ZXMtPmFjdGl2ZV9saXN0LCBsaW5rKSB7CiAJCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOwogCiAJ
CXJxID0gaTkxNV9hY3RpdmVfcmVxdWVzdF9nZXRfdW5sb2NrZWQoJnRsLT5sYXN0X3JlcXVlc3Qp
OwpAQCAtODk2LDkgKzg4OSw5IEBAIHN0YXRpYyBib29sIF9faTkxNV9nZW1fdW5zZXRfd2VkZ2Vk
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCQlkbWFfZmVuY2VfZGVmYXVsdF93YWl0
KCZycS0+ZmVuY2UsIGZhbHNlLCBNQVhfU0NIRURVTEVfVElNRU9VVCk7CiAJCWk5MTVfcmVxdWVz
dF9wdXQocnEpOwogCX0KLQltdXRleF91bmxvY2soJmk5MTUtPmd0LnRpbWVsaW5lcy5tdXRleCk7
CisJbXV0ZXhfdW5sb2NrKCZ0aW1lbGluZXMtPm11dGV4KTsKIAotCWludGVsX2d0X3Nhbml0aXpl
KCZpOTE1LT5ndCwgZmFsc2UpOworCWludGVsX2d0X3Nhbml0aXplKGd0LCBmYWxzZSk7CiAKIAkv
KgogCSAqIFVuZG8gbm9wX3N1Ym1pdF9yZXF1ZXN0LiBXZSBwcmV2ZW50IGFsbCBuZXcgaTkxNSBy
ZXF1ZXN0cyBmcm9tCkBAIC05MDksNTMgKzkwMiw1MSBAQCBzdGF0aWMgYm9vbCBfX2k5MTVfZ2Vt
X3Vuc2V0X3dlZGdlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkgKiB0aGUgbm9w
X3N1Ym1pdF9yZXF1ZXN0IG9uIHJlc2V0LCB3ZSBjYW4gZG8gdGhpcyBmcm9tIG5vcm1hbAogCSAq
IGNvbnRleHQgYW5kIGRvIG5vdCByZXF1aXJlIHN0b3BfbWFjaGluZSgpLgogCSAqLwotCWludGVs
X2VuZ2luZXNfcmVzZXRfZGVmYXVsdF9zdWJtaXNzaW9uKGk5MTUpOworCWludGVsX2VuZ2luZXNf
cmVzZXRfZGVmYXVsdF9zdWJtaXNzaW9uKGd0KTsKIAogCUdFTV9UUkFDRSgiZW5kXG4iKTsKIAog
CXNtcF9tYl9fYmVmb3JlX2F0b21pYygpOyAvKiBjb21wbGV0ZSB0YWtlb3ZlciBiZWZvcmUgZW5h
YmxpbmcgZXhlY2J1ZiAqLwotCWNsZWFyX2JpdChJOTE1X1dFREdFRCwgJmk5MTUtPmdwdV9lcnJv
ci5mbGFncyk7CisJY2xlYXJfYml0KEk5MTVfV0VER0VELCAmZ3QtPnJlc2V0LmZsYWdzKTsKIAog
CXJldHVybiB0cnVlOwogfQogCi1ib29sIGk5MTVfZ2VtX3Vuc2V0X3dlZGdlZChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKK2Jvb2wgaW50ZWxfZ3RfdW5zZXRfd2VkZ2VkKHN0cnVjdCBp
bnRlbF9ndCAqZ3QpCiB7Ci0Jc3RydWN0IGk5MTVfZ3B1X2Vycm9yICplcnJvciA9ICZpOTE1LT5n
cHVfZXJyb3I7CiAJYm9vbCByZXN1bHQ7CiAKLQltdXRleF9sb2NrKCZlcnJvci0+d2VkZ2VfbXV0
ZXgpOwotCXJlc3VsdCA9IF9faTkxNV9nZW1fdW5zZXRfd2VkZ2VkKGk5MTUpOwotCW11dGV4X3Vu
bG9jaygmZXJyb3ItPndlZGdlX211dGV4KTsKKwltdXRleF9sb2NrKCZndC0+cmVzZXQubXV0ZXgp
OworCXJlc3VsdCA9IF9faW50ZWxfZ3RfdW5zZXRfd2VkZ2VkKGd0KTsKKwltdXRleF91bmxvY2so
Jmd0LT5yZXNldC5tdXRleCk7CiAKIAlyZXR1cm4gcmVzdWx0OwogfQogCi1zdGF0aWMgaW50IGRv
X3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAotCQkgICAgaW50ZWxfZW5naW5l
X21hc2tfdCBzdGFsbGVkX21hc2spCitzdGF0aWMgaW50IGRvX3Jlc2V0KHN0cnVjdCBpbnRlbF9n
dCAqZ3QsIGludGVsX2VuZ2luZV9tYXNrX3Qgc3RhbGxlZF9tYXNrKQogewogCWludCBlcnIsIGk7
CiAKLQlndF9yZXZva2UoaTkxNSk7CisJZ3RfcmV2b2tlKGd0KTsKIAotCWVyciA9IGludGVsX2dw
dV9yZXNldChpOTE1LCBBTExfRU5HSU5FUyk7CisJZXJyID0gX19pbnRlbF9ndF9yZXNldChndCwg
QUxMX0VOR0lORVMpOwogCWZvciAoaSA9IDA7IGVyciAmJiBpIDwgUkVTRVRfTUFYX1JFVFJJRVM7
IGkrKykgewogCQltc2xlZXAoMTAgKiAoaSArIDEpKTsKLQkJZXJyID0gaW50ZWxfZ3B1X3Jlc2V0
KGk5MTUsIEFMTF9FTkdJTkVTKTsKKwkJZXJyID0gX19pbnRlbF9ndF9yZXNldChndCwgQUxMX0VO
R0lORVMpOwogCX0KIAlpZiAoZXJyKQogCQlyZXR1cm4gZXJyOwogCi0JcmV0dXJuIGd0X3Jlc2V0
KGk5MTUsIHN0YWxsZWRfbWFzayk7CisJcmV0dXJuIGd0X3Jlc2V0KGd0LCBzdGFsbGVkX21hc2sp
OwogfQogCi1zdGF0aWMgaW50IHJlc3VtZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
K3N0YXRpYyBpbnQgcmVzdW1lKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7CiAJc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lOwogCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwogCWludCByZXQ7
CiAKLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgeworCWZvcl9lYWNoX2VuZ2lu
ZShlbmdpbmUsIGd0LT5pOTE1LCBpZCkgewogCQlyZXQgPSBlbmdpbmUtPnJlc3VtZShlbmdpbmUp
OwogCQlpZiAocmV0KQogCQkJcmV0dXJuIHJldDsKQEAgLTk2NSw4ICs5NTYsOCBAQCBzdGF0aWMg
aW50IHJlc3VtZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIH0KIAogLyoqCi0gKiBp
OTE1X3Jlc2V0IC0gcmVzZXQgY2hpcCBhZnRlciBhIGhhbmcKLSAqIEBpOTE1OiAjZHJtX2k5MTVf
cHJpdmF0ZSB0byByZXNldAorICogaW50ZWxfZ3RfcmVzZXQgLSByZXNldCBjaGlwIGFmdGVyIGEg
aGFuZworICogQGd0OiAjaW50ZWxfZ3QgdG8gcmVzZXQKICAqIEBzdGFsbGVkX21hc2s6IG1hc2sg
b2YgdGhlIHN0YWxsZWQgZW5naW5lcyB3aXRoIHRoZSBndWlsdHkgcmVxdWVzdHMKICAqIEByZWFz
b246IHVzZXIgZXJyb3IgbWVzc2FnZSBmb3Igd2h5IHdlIGFyZSByZXNldHRpbmcKICAqCkBAIC05
ODEsNTAgKzk3Miw1MCBAQCBzdGF0aWMgaW50IHJlc3VtZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKICAqICAgLSByZS1pbml0IGludGVycnVwdCBzdGF0ZQogICogICAtIHJlLWluaXQg
ZGlzcGxheQogICovCi12b2lkIGk5MTVfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCi0JCWludGVsX2VuZ2luZV9tYXNrX3Qgc3RhbGxlZF9tYXNrLAotCQljb25zdCBjaGFyICpy
ZWFzb24pCit2b2lkIGludGVsX2d0X3Jlc2V0KHN0cnVjdCBpbnRlbF9ndCAqZ3QsCisJCSAgICBp
bnRlbF9lbmdpbmVfbWFza190IHN0YWxsZWRfbWFzaywKKwkJICAgIGNvbnN0IGNoYXIgKnJlYXNv
bikKIHsKLQlzdHJ1Y3QgaTkxNV9ncHVfZXJyb3IgKmVycm9yID0gJmk5MTUtPmdwdV9lcnJvcjsK
IAlpbnRlbF9lbmdpbmVfbWFza190IGF3YWtlOwogCWludCByZXQ7CiAKLQlHRU1fVFJBQ0UoImZs
YWdzPSVseFxuIiwgZXJyb3ItPmZsYWdzKTsKKwlHRU1fVFJBQ0UoImZsYWdzPSVseFxuIiwgZ3Qt
PnJlc2V0LmZsYWdzKTsKIAogCW1pZ2h0X3NsZWVwKCk7Ci0JR0VNX0JVR19PTighdGVzdF9iaXQo
STkxNV9SRVNFVF9CQUNLT0ZGLCAmZXJyb3ItPmZsYWdzKSk7Ci0JbXV0ZXhfbG9jaygmZXJyb3It
PndlZGdlX211dGV4KTsKKwlHRU1fQlVHX09OKCF0ZXN0X2JpdChJOTE1X1JFU0VUX0JBQ0tPRkYs
ICZndC0+cmVzZXQuZmxhZ3MpKTsKKwltdXRleF9sb2NrKCZndC0+cmVzZXQubXV0ZXgpOwogCiAJ
LyogQ2xlYXIgYW55IHByZXZpb3VzIGZhaWxlZCBhdHRlbXB0cyBhdCByZWNvdmVyeS4gVGltZSB0
byB0cnkgYWdhaW4uICovCi0JaWYgKCFfX2k5MTVfZ2VtX3Vuc2V0X3dlZGdlZChpOTE1KSkKKwlp
ZiAoIV9faW50ZWxfZ3RfdW5zZXRfd2VkZ2VkKGd0KSkKIAkJZ290byB1bmxvY2s7CiAKIAlpZiAo
cmVhc29uKQotCQlkZXZfbm90aWNlKGk5MTUtPmRybS5kZXYsICJSZXNldHRpbmcgY2hpcCBmb3Ig
JXNcbiIsIHJlYXNvbik7Ci0JZXJyb3ItPnJlc2V0X2NvdW50Kys7CisJCWRldl9ub3RpY2UoZ3Qt
Pmk5MTUtPmRybS5kZXYsCisJCQkgICAiUmVzZXR0aW5nIGNoaXAgZm9yICVzXG4iLCByZWFzb24p
OworCWF0b21pY19pbmMoJmd0LT5pOTE1LT5ncHVfZXJyb3IucmVzZXRfY291bnQpOwogCi0JYXdh
a2UgPSByZXNldF9wcmVwYXJlKGk5MTUpOworCWF3YWtlID0gcmVzZXRfcHJlcGFyZShndCk7CiAK
LQlpZiAoIWludGVsX2hhc19ncHVfcmVzZXQoaTkxNSkpIHsKKwlpZiAoIWludGVsX2hhc19ncHVf
cmVzZXQoZ3QtPmk5MTUpKSB7CiAJCWlmIChpOTE1X21vZHBhcmFtcy5yZXNldCkKLQkJCWRldl9l
cnIoaTkxNS0+ZHJtLmRldiwgIkdQVSByZXNldCBub3Qgc3VwcG9ydGVkXG4iKTsKKwkJCWRldl9l
cnIoZ3QtPmk5MTUtPmRybS5kZXYsICJHUFUgcmVzZXQgbm90IHN1cHBvcnRlZFxuIik7CiAJCWVs
c2UKIAkJCURSTV9ERUJVR19EUklWRVIoIkdQVSByZXNldCBkaXNhYmxlZFxuIik7CiAJCWdvdG8g
ZXJyb3I7CiAJfQogCi0JaWYgKElOVEVMX0lORk8oaTkxNSktPmdwdV9yZXNldF9jbG9iYmVyc19k
aXNwbGF5KQotCQlpbnRlbF9ydW50aW1lX3BtX2Rpc2FibGVfaW50ZXJydXB0cyhpOTE1KTsKKwlp
ZiAoSU5URUxfSU5GTyhndC0+aTkxNSktPmdwdV9yZXNldF9jbG9iYmVyc19kaXNwbGF5KQorCQlp
bnRlbF9ydW50aW1lX3BtX2Rpc2FibGVfaW50ZXJydXB0cyhndC0+aTkxNSk7CiAKLQlpZiAoZG9f
cmVzZXQoaTkxNSwgc3RhbGxlZF9tYXNrKSkgewotCQlkZXZfZXJyKGk5MTUtPmRybS5kZXYsICJG
YWlsZWQgdG8gcmVzZXQgY2hpcFxuIik7CisJaWYgKGRvX3Jlc2V0KGd0LCBzdGFsbGVkX21hc2sp
KSB7CisJCWRldl9lcnIoZ3QtPmk5MTUtPmRybS5kZXYsICJGYWlsZWQgdG8gcmVzZXQgY2hpcFxu
Iik7CiAJCWdvdG8gdGFpbnQ7CiAJfQogCi0JaWYgKElOVEVMX0lORk8oaTkxNSktPmdwdV9yZXNl
dF9jbG9iYmVyc19kaXNwbGF5KQotCQlpbnRlbF9ydW50aW1lX3BtX2VuYWJsZV9pbnRlcnJ1cHRz
KGk5MTUpOworCWlmIChJTlRFTF9JTkZPKGd0LT5pOTE1KS0+Z3B1X3Jlc2V0X2Nsb2JiZXJzX2Rp
c3BsYXkpCisJCWludGVsX3J1bnRpbWVfcG1fZW5hYmxlX2ludGVycnVwdHMoZ3QtPmk5MTUpOwog
Ci0JaW50ZWxfb3ZlcmxheV9yZXNldChpOTE1KTsKKwlpbnRlbF9vdmVybGF5X3Jlc2V0KGd0LT5p
OTE1KTsKIAogCS8qCiAJICogTmV4dCB3ZSBuZWVkIHRvIHJlc3RvcmUgdGhlIGNvbnRleHQsIGJ1
dCB3ZSBkb24ndCB1c2UgdGhvc2UKQEAgLTEwMzQsMjMgKzEwMjUsMjMgQEAgdm9pZCBpOTE1X3Jl
c2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCSAqIHdhcyBydW5uaW5nIGF0IHRo
ZSB0aW1lIG9mIHRoZSByZXNldCAoaS5lLiB3ZSB3ZXJlbid0IFZUCiAJICogc3dpdGNoZWQgYXdh
eSkuCiAJICovCi0JcmV0ID0gaTkxNV9nZW1faW5pdF9odyhpOTE1KTsKKwlyZXQgPSBpOTE1X2dl
bV9pbml0X2h3KGd0LT5pOTE1KTsKIAlpZiAocmV0KSB7CiAJCURSTV9FUlJPUigiRmFpbGVkIHRv
IGluaXRpYWxpc2UgSFcgZm9sbG93aW5nIHJlc2V0ICglZClcbiIsCiAJCQkgIHJldCk7CiAJCWdv
dG8gdGFpbnQ7CiAJfQogCi0JcmV0ID0gcmVzdW1lKGk5MTUpOworCXJldCA9IHJlc3VtZShndCk7
CiAJaWYgKHJldCkKIAkJZ290byB0YWludDsKIAotCWk5MTVfcXVldWVfaGFuZ2NoZWNrKGk5MTUp
OworCWludGVsX2d0X3F1ZXVlX2hhbmdjaGVjayhndCk7CiAKIGZpbmlzaDoKLQlyZXNldF9maW5p
c2goaTkxNSwgYXdha2UpOworCXJlc2V0X2ZpbmlzaChndCwgYXdha2UpOwogdW5sb2NrOgotCW11
dGV4X3VubG9jaygmZXJyb3ItPndlZGdlX211dGV4KTsKKwltdXRleF91bmxvY2soJmd0LT5yZXNl
dC5tdXRleCk7CiAJcmV0dXJuOwogCiB0YWludDoKQEAgLTEwNjgsMTggKzEwNTksMTcgQEAgdm9p
ZCBpOTE1X3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCSAqLwogCWFkZF90
YWludF9mb3JfQ0koVEFJTlRfV0FSTik7CiBlcnJvcjoKLQlfX2k5MTVfZ2VtX3NldF93ZWRnZWQo
aTkxNSk7CisJX19pbnRlbF9ndF9zZXRfd2VkZ2VkKGd0KTsKIAlnb3RvIGZpbmlzaDsKIH0KIAot
c3RhdGljIGlubGluZSBpbnQgaW50ZWxfZ3RfcmVzZXRfZW5naW5lKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAotCQkJCQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCitzdGF0
aWMgaW5saW5lIGludCBpbnRlbF9ndF9yZXNldF9lbmdpbmUoc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lKQogewotCXJldHVybiBpbnRlbF9ncHVfcmVzZXQoaTkxNSwgZW5naW5lLT5tYXNr
KTsKKwlyZXR1cm4gX19pbnRlbF9ndF9yZXNldChlbmdpbmUtPmd0LCBlbmdpbmUtPm1hc2spOwog
fQogCiAvKioKLSAqIGk5MTVfcmVzZXRfZW5naW5lIC0gcmVzZXQgR1BVIGVuZ2luZSB0byByZWNv
dmVyIGZyb20gYSBoYW5nCisgKiBpbnRlbF9lbmdpbmVfcmVzZXQgLSByZXNldCBHUFUgZW5naW5l
IHRvIHJlY292ZXIgZnJvbSBhIGhhbmcKICAqIEBlbmdpbmU6IGVuZ2luZSB0byByZXNldAogICog
QG1zZzogcmVhc29uIGZvciBHUFUgcmVzZXQ7IG9yIE5VTEwgZm9yIG5vIGRldl9ub3RpY2UoKQog
ICoKQEAgLTEwOTEsMTMgKzEwODEsMTMgQEAgc3RhdGljIGlubGluZSBpbnQgaW50ZWxfZ3RfcmVz
ZXRfZW5naW5lKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogICogIC0gcmVzZXQgZW5n
aW5lICh3aGljaCB3aWxsIGZvcmNlIHRoZSBlbmdpbmUgdG8gaWRsZSkKICAqICAtIHJlLWluaXQv
Y29uZmlndXJlIGVuZ2luZQogICovCi1pbnQgaTkxNV9yZXNldF9lbmdpbmUoc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lLCBjb25zdCBjaGFyICptc2cpCitpbnQgaW50ZWxfZW5naW5lX3Jl
c2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgY29uc3QgY2hhciAqbXNnKQogewot
CXN0cnVjdCBpOTE1X2dwdV9lcnJvciAqZXJyb3IgPSAmZW5naW5lLT5pOTE1LT5ncHVfZXJyb3I7
CisJc3RydWN0IGludGVsX2d0ICpndCA9IGVuZ2luZS0+Z3Q7CiAJaW50IHJldDsKIAotCUdFTV9U
UkFDRSgiJXMgZmxhZ3M9JWx4XG4iLCBlbmdpbmUtPm5hbWUsIGVycm9yLT5mbGFncyk7Ci0JR0VN
X0JVR19PTighdGVzdF9iaXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBlbmdpbmUtPmlkLCAmZXJyb3It
PmZsYWdzKSk7CisJR0VNX1RSQUNFKCIlcyBmbGFncz0lbHhcbiIsIGVuZ2luZS0+bmFtZSwgZ3Qt
PnJlc2V0LmZsYWdzKTsKKwlHRU1fQlVHX09OKCF0ZXN0X2JpdChJOTE1X1JFU0VUX0VOR0lORSAr
IGVuZ2luZS0+aWQsICZndC0+cmVzZXQuZmxhZ3MpKTsKIAogCWlmICghaW50ZWxfZW5naW5lX3Bt
X2dldF9pZl9hd2FrZShlbmdpbmUpKQogCQlyZXR1cm4gMDsKQEAgLTExMDcsMTAgKzEwOTcsMTAg
QEAgaW50IGk5MTVfcmVzZXRfZW5naW5lKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwg
Y29uc3QgY2hhciAqbXNnKQogCWlmIChtc2cpCiAJCWRldl9ub3RpY2UoZW5naW5lLT5pOTE1LT5k
cm0uZGV2LAogCQkJICAgIlJlc2V0dGluZyAlcyBmb3IgJXNcbiIsIGVuZ2luZS0+bmFtZSwgbXNn
KTsKLQllcnJvci0+cmVzZXRfZW5naW5lX2NvdW50W2VuZ2luZS0+aWRdKys7CisJYXRvbWljX2lu
YygmZW5naW5lLT5pOTE1LT5ncHVfZXJyb3IucmVzZXRfZW5naW5lX2NvdW50W2VuZ2luZS0+dWFi
aV9jbGFzc10pOwogCiAJaWYgKCFlbmdpbmUtPmk5MTUtPmd1Yy5leGVjYnVmX2NsaWVudCkKLQkJ
cmV0ID0gaW50ZWxfZ3RfcmVzZXRfZW5naW5lKGVuZ2luZS0+aTkxNSwgZW5naW5lKTsKKwkJcmV0
ID0gaW50ZWxfZ3RfcmVzZXRfZW5naW5lKGVuZ2luZSk7CiAJZWxzZQogCQlyZXQgPSBpbnRlbF9n
dWNfcmVzZXRfZW5naW5lKCZlbmdpbmUtPmk5MTUtPmd1YywgZW5naW5lKTsKIAlpZiAocmV0KSB7
CkBAIC0xMTI2LDcgKzExMTYsNyBAQCBpbnQgaTkxNV9yZXNldF9lbmdpbmUoc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lLCBjb25zdCBjaGFyICptc2cpCiAJICogYWN0aXZlIHJlcXVlc3Qg
YW5kIGNhbiBkcm9wIGl0LCBhZGp1c3QgaGVhZCB0byBza2lwIHRoZSBvZmZlbmRpbmcKIAkgKiBy
ZXF1ZXN0IHRvIHJlc3VtZSBleGVjdXRpbmcgcmVtYWluaW5nIHJlcXVlc3RzIGluIHRoZSBxdWV1
ZS4KIAkgKi8KLQlpbnRlbF9lbmdpbmVfcmVzZXQoZW5naW5lLCB0cnVlKTsKKwlfX2ludGVsX2Vu
Z2luZV9yZXNldChlbmdpbmUsIHRydWUpOwogCiAJLyoKIAkgKiBUaGUgZW5naW5lIGFuZCBpdHMg
cmVnaXN0ZXJzIChhbmQgd29ya2Fyb3VuZHMgaW4gY2FzZSBvZiByZW5kZXIpCkBAIC0xMTQyLDE2
ICsxMTMyLDE1IEBAIGludCBpOTE1X3Jlc2V0X2VuZ2luZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmUsIGNvbnN0IGNoYXIgKm1zZykKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgdm9p
ZCBpOTE1X3Jlc2V0X2RldmljZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKLQkJCSAg
ICAgIHUzMiBlbmdpbmVfbWFzaywKLQkJCSAgICAgIGNvbnN0IGNoYXIgKnJlYXNvbikKK3N0YXRp
YyB2b2lkIGludGVsX2d0X3Jlc2V0X2dsb2JhbChzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAorCQkJCSAg
dTMyIGVuZ2luZV9tYXNrLAorCQkJCSAgY29uc3QgY2hhciAqcmVhc29uKQogewotCXN0cnVjdCBp
OTE1X2dwdV9lcnJvciAqZXJyb3IgPSAmaTkxNS0+Z3B1X2Vycm9yOwotCXN0cnVjdCBrb2JqZWN0
ICprb2JqID0gJmk5MTUtPmRybS5wcmltYXJ5LT5rZGV2LT5rb2JqOworCXN0cnVjdCBrb2JqZWN0
ICprb2JqID0gJmd0LT5pOTE1LT5kcm0ucHJpbWFyeS0+a2Rldi0+a29iajsKIAljaGFyICplcnJv
cl9ldmVudFtdID0geyBJOTE1X0VSUk9SX1VFVkVOVCAiPTEiLCBOVUxMIH07CiAJY2hhciAqcmVz
ZXRfZXZlbnRbXSA9IHsgSTkxNV9SRVNFVF9VRVZFTlQgIj0xIiwgTlVMTCB9OwogCWNoYXIgKnJl
c2V0X2RvbmVfZXZlbnRbXSA9IHsgSTkxNV9FUlJPUl9VRVZFTlQgIj0wIiwgTlVMTCB9OwotCXN0
cnVjdCBpOTE1X3dlZGdlX21lIHc7CisJc3RydWN0IGludGVsX3dlZGdlX21lIHc7CiAKIAlrb2Jq
ZWN0X3VldmVudF9lbnYoa29iaiwgS09CSl9DSEFOR0UsIGVycm9yX2V2ZW50KTsKIApAQCAtMTE1
OSwyNCArMTE0OCwyNCBAQCBzdGF0aWMgdm9pZCBpOTE1X3Jlc2V0X2RldmljZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAlrb2JqZWN0X3VldmVudF9lbnYoa29iaiwgS09CSl9DSEFO
R0UsIHJlc2V0X2V2ZW50KTsKIAogCS8qIFVzZSBhIHdhdGNoZG9nIHRvIGVuc3VyZSB0aGF0IG91
ciByZXNldCBjb21wbGV0ZXMgKi8KLQlpOTE1X3dlZGdlX29uX3RpbWVvdXQoJncsIGk5MTUsIDUg
KiBIWikgewotCQlpbnRlbF9wcmVwYXJlX3Jlc2V0KGk5MTUpOworCWludGVsX3dlZGdlX29uX3Rp
bWVvdXQoJncsIGd0LCA1ICogSFopIHsKKwkJaW50ZWxfcHJlcGFyZV9yZXNldChndC0+aTkxNSk7
CiAKIAkJLyogRmx1c2ggZXZlcnlvbmUgdXNpbmcgYSByZXNvdXJjZSBhYm91dCB0byBiZSBjbG9i
YmVyZWQgKi8KLQkJc3luY2hyb25pemVfc3JjdV9leHBlZGl0ZWQoJmVycm9yLT5yZXNldF9iYWNr
b2ZmX3NyY3UpOworCQlzeW5jaHJvbml6ZV9zcmN1X2V4cGVkaXRlZCgmZ3QtPnJlc2V0LmJhY2tv
ZmZfc3JjdSk7CiAKLQkJaTkxNV9yZXNldChpOTE1LCBlbmdpbmVfbWFzaywgcmVhc29uKTsKKwkJ
aW50ZWxfZ3RfcmVzZXQoZ3QsIGVuZ2luZV9tYXNrLCByZWFzb24pOwogCi0JCWludGVsX2Zpbmlz
aF9yZXNldChpOTE1KTsKKwkJaW50ZWxfZmluaXNoX3Jlc2V0KGd0LT5pOTE1KTsKIAl9CiAKLQlp
ZiAoIXRlc3RfYml0KEk5MTVfV0VER0VELCAmZXJyb3ItPmZsYWdzKSkKKwlpZiAoIXRlc3RfYml0
KEk5MTVfV0VER0VELCAmZ3QtPnJlc2V0LmZsYWdzKSkKIAkJa29iamVjdF91ZXZlbnRfZW52KGtv
YmosIEtPQkpfQ0hBTkdFLCByZXNldF9kb25lX2V2ZW50KTsKIH0KIAogLyoqCi0gKiBpOTE1X2hh
bmRsZV9lcnJvciAtIGhhbmRsZSBhIGdwdSBlcnJvcgotICogQGk5MTU6IGk5MTUgZGV2aWNlIHBy
aXZhdGUKKyAqIGludGVsX2d0X2hhbmRsZV9lcnJvciAtIGhhbmRsZSBhIGdwdSBlcnJvcgorICog
QGd0OiB0aGUgaW50ZWxfZ3QKICAqIEBlbmdpbmVfbWFzazogbWFzayByZXByZXNlbnRpbmcgZW5n
aW5lcyB0aGF0IGFyZSBodW5nCiAgKiBAZmxhZ3M6IGNvbnRyb2wgZmxhZ3MKICAqIEBmbXQ6IEVy
cm9yIG1lc3NhZ2UgZm9ybWF0IHN0cmluZwpAQCAtMTE4NywxMiArMTE3NiwxMSBAQCBzdGF0aWMg
dm9pZCBpOTE1X3Jlc2V0X2RldmljZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKICAq
IHNvIHVzZXJzcGFjZSBrbm93cyBzb21ldGhpbmcgYmFkIGhhcHBlbmVkIChzaG91bGQgdHJpZ2dl
ciBjb2xsZWN0aW9uCiAgKiBvZiBhIHJpbmcgZHVtcCBldGMuKS4KICAqLwotdm9pZCBpOTE1X2hh
bmRsZV9lcnJvcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKLQkJICAgICAgIGludGVs
X2VuZ2luZV9tYXNrX3QgZW5naW5lX21hc2ssCi0JCSAgICAgICB1bnNpZ25lZCBsb25nIGZsYWdz
LAotCQkgICAgICAgY29uc3QgY2hhciAqZm10LCAuLi4pCit2b2lkIGludGVsX2d0X2hhbmRsZV9l
cnJvcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAorCQkJICAgaW50ZWxfZW5naW5lX21hc2tfdCBlbmdp
bmVfbWFzaywKKwkJCSAgIHVuc2lnbmVkIGxvbmcgZmxhZ3MsCisJCQkgICBjb25zdCBjaGFyICpm
bXQsIC4uLikKIHsKLQlzdHJ1Y3QgaTkxNV9ncHVfZXJyb3IgKmVycm9yID0gJmk5MTUtPmdwdV9l
cnJvcjsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CiAJaW50ZWxfd2FrZXJlZl90
IHdha2VyZWY7CiAJaW50ZWxfZW5naW5lX21hc2tfdCB0bXA7CkBAIC0xMjE2LDMzICsxMjA0LDMx
IEBAIHZvaWQgaTkxNV9oYW5kbGVfZXJyb3Ioc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
CiAJICogaXNuJ3QgdGhlIGNhc2UgYXQgbGVhc3Qgd2hlbiB3ZSBnZXQgaGVyZSBieSBkb2luZyBh
CiAJICogc2ltdWxhdGVkIHJlc2V0IHZpYSBkZWJ1Z2ZzLCBzbyBnZXQgYW4gUlBNIHJlZmVyZW5j
ZS4KIAkgKi8KLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVf
cG0pOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmZ3QtPmk5MTUtPnJ1bnRpbWVf
cG0pOwogCi0JZW5naW5lX21hc2sgJj0gSU5URUxfSU5GTyhpOTE1KS0+ZW5naW5lX21hc2s7CisJ
ZW5naW5lX21hc2sgJj0gSU5URUxfSU5GTyhndC0+aTkxNSktPmVuZ2luZV9tYXNrOwogCiAJaWYg
KGZsYWdzICYgSTkxNV9FUlJPUl9DQVBUVVJFKSB7Ci0JCWk5MTVfY2FwdHVyZV9lcnJvcl9zdGF0
ZShpOTE1LCBlbmdpbmVfbWFzaywgbXNnKTsKLQkJaW50ZWxfZ3RfY2xlYXJfZXJyb3JfcmVnaXN0
ZXJzKCZpOTE1LT5ndCwgZW5naW5lX21hc2spOworCQlpOTE1X2NhcHR1cmVfZXJyb3Jfc3RhdGUo
Z3QtPmk5MTUsIGVuZ2luZV9tYXNrLCBtc2cpOworCQlpbnRlbF9ndF9jbGVhcl9lcnJvcl9yZWdp
c3RlcnMoZ3QsIGVuZ2luZV9tYXNrKTsKIAl9CiAKIAkvKgogCSAqIFRyeSBlbmdpbmUgcmVzZXQg
d2hlbiBhdmFpbGFibGUuIFdlIGZhbGwgYmFjayB0byBmdWxsIHJlc2V0IGlmCiAJICogc2luZ2xl
IHJlc2V0IGZhaWxzLgogCSAqLwotCWlmIChpbnRlbF9oYXNfcmVzZXRfZW5naW5lKGk5MTUpICYm
ICFfX2k5MTVfd2VkZ2VkKGVycm9yKSkgewotCQlmb3JfZWFjaF9lbmdpbmVfbWFza2VkKGVuZ2lu
ZSwgaTkxNSwgZW5naW5lX21hc2ssIHRtcCkgeworCWlmIChpbnRlbF9oYXNfcmVzZXRfZW5naW5l
KGd0LT5pOTE1KSAmJiAhaW50ZWxfZ3RfaXNfd2VkZ2VkKGd0KSkgeworCQlmb3JfZWFjaF9lbmdp
bmVfbWFza2VkKGVuZ2luZSwgZ3QtPmk5MTUsIGVuZ2luZV9tYXNrLCB0bXApIHsKIAkJCUJVSUxE
X0JVR19PTihJOTE1X1JFU0VUX01PREVTRVQgPj0gSTkxNV9SRVNFVF9FTkdJTkUpOwogCQkJaWYg
KHRlc3RfYW5kX3NldF9iaXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBlbmdpbmUtPmlkLAotCQkJCQkg
ICAgICZlcnJvci0+ZmxhZ3MpKQorCQkJCQkgICAgICZndC0+cmVzZXQuZmxhZ3MpKQogCQkJCWNv
bnRpbnVlOwogCi0JCQlpZiAoaTkxNV9yZXNldF9lbmdpbmUoZW5naW5lLCBtc2cpID09IDApCisJ
CQlpZiAoaW50ZWxfZW5naW5lX3Jlc2V0KGVuZ2luZSwgbXNnKSA9PSAwKQogCQkJCWVuZ2luZV9t
YXNrICY9IH5lbmdpbmUtPm1hc2s7CiAKLQkJCWNsZWFyX2JpdChJOTE1X1JFU0VUX0VOR0lORSAr
IGVuZ2luZS0+aWQsCi0JCQkJICAmZXJyb3ItPmZsYWdzKTsKLQkJCXdha2VfdXBfYml0KCZlcnJv
ci0+ZmxhZ3MsCi0JCQkJICAgIEk5MTVfUkVTRVRfRU5HSU5FICsgZW5naW5lLT5pZCk7CisJCQlj
bGVhcl9hbmRfd2FrZV91cF9iaXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBlbmdpbmUtPmlkLAorCQkJ
CQkgICAgICAmZ3QtPnJlc2V0LmZsYWdzKTsKIAkJfQogCX0KIApAQCAtMTI1MCw5ICsxMjM2LDkg
QEAgdm9pZCBpOTE1X2hhbmRsZV9lcnJvcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
IAkJZ290byBvdXQ7CiAKIAkvKiBGdWxsIHJlc2V0IG5lZWRzIHRoZSBtdXRleCwgc3RvcCBhbnkg
b3RoZXIgdXNlciB0cnlpbmcgdG8gZG8gc28uICovCi0JaWYgKHRlc3RfYW5kX3NldF9iaXQoSTkx
NV9SRVNFVF9CQUNLT0ZGLCAmZXJyb3ItPmZsYWdzKSkgewotCQl3YWl0X2V2ZW50KGVycm9yLT5y
ZXNldF9xdWV1ZSwKLQkJCSAgICF0ZXN0X2JpdChJOTE1X1JFU0VUX0JBQ0tPRkYsICZlcnJvci0+
ZmxhZ3MpKTsKKwlpZiAodGVzdF9hbmRfc2V0X2JpdChJOTE1X1JFU0VUX0JBQ0tPRkYsICZndC0+
cmVzZXQuZmxhZ3MpKSB7CisJCXdhaXRfZXZlbnQoZ3QtPnJlc2V0LnF1ZXVlLAorCQkJICAgIXRl
c3RfYml0KEk5MTVfUkVTRVRfQkFDS09GRiwgJmd0LT5yZXNldC5mbGFncykpOwogCQlnb3RvIG91
dDsgLyogcGlnZ3ktYmFjayBvbiB0aGUgb3RoZXIgcmVzZXQgKi8KIAl9CiAKQEAgLTEyNjAsMTEz
ICsxMjQ2LDExOSBAQCB2b2lkIGk5MTVfaGFuZGxlX2Vycm9yKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAogCXN5bmNocm9uaXplX3JjdV9leHBlZGl0ZWQoKTsKIAogCS8qIFByZXZlbnQg
YW55IG90aGVyIHJlc2V0LWVuZ2luZSBhdHRlbXB0LiAqLwotCWZvcl9lYWNoX2VuZ2luZShlbmdp
bmUsIGk5MTUsIHRtcCkgeworCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LT5pOTE1LCB0bXAp
IHsKIAkJd2hpbGUgKHRlc3RfYW5kX3NldF9iaXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBlbmdpbmUt
PmlkLAotCQkJCQkmZXJyb3ItPmZsYWdzKSkKLQkJCXdhaXRfb25fYml0KCZlcnJvci0+ZmxhZ3Ms
CisJCQkJCSZndC0+cmVzZXQuZmxhZ3MpKQorCQkJd2FpdF9vbl9iaXQoJmd0LT5yZXNldC5mbGFn
cywKIAkJCQkgICAgSTkxNV9SRVNFVF9FTkdJTkUgKyBlbmdpbmUtPmlkLAogCQkJCSAgICBUQVNL
X1VOSU5URVJSVVBUSUJMRSk7CiAJfQogCi0JaTkxNV9yZXNldF9kZXZpY2UoaTkxNSwgZW5naW5l
X21hc2ssIG1zZyk7CisJaW50ZWxfZ3RfcmVzZXRfZ2xvYmFsKGd0LCBlbmdpbmVfbWFzaywgbXNn
KTsKIAotCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIHRtcCkgewotCQljbGVhcl9iaXQo
STkxNV9SRVNFVF9FTkdJTkUgKyBlbmdpbmUtPmlkLAotCQkJICAmZXJyb3ItPmZsYWdzKTsKLQl9
Ci0KLQljbGVhcl9iaXQoSTkxNV9SRVNFVF9CQUNLT0ZGLCAmZXJyb3ItPmZsYWdzKTsKLQl3YWtl
X3VwX2FsbCgmZXJyb3ItPnJlc2V0X3F1ZXVlKTsKKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBn
dC0+aTkxNSwgdG1wKQorCQljbGVhcl9iaXRfdW5sb2NrKEk5MTVfUkVTRVRfRU5HSU5FICsgZW5n
aW5lLT5pZCwKKwkJCQkgJmd0LT5yZXNldC5mbGFncyk7CisJY2xlYXJfYml0X3VubG9jayhJOTE1
X1JFU0VUX0JBQ0tPRkYsICZndC0+cmVzZXQuZmxhZ3MpOworCXNtcF9tYl9fYWZ0ZXJfYXRvbWlj
KCk7CisJd2FrZV91cF9hbGwoJmd0LT5yZXNldC5xdWV1ZSk7CiAKIG91dDoKLQlpbnRlbF9ydW50
aW1lX3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9w
bV9wdXQoJmd0LT5pOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIH0KIAotaW50IGk5MTVfcmVz
ZXRfdHJ5bG9jayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKK2ludCBpbnRlbF9ndF9y
ZXNldF90cnlsb2NrKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7Ci0Jc3RydWN0IGk5MTVfZ3B1X2Vy
cm9yICplcnJvciA9ICZpOTE1LT5ncHVfZXJyb3I7CiAJaW50IHNyY3U7CiAKLQltaWdodF9sb2Nr
KCZlcnJvci0+cmVzZXRfYmFja29mZl9zcmN1KTsKKwltaWdodF9sb2NrKCZndC0+cmVzZXQuYmFj
a29mZl9zcmN1KTsKIAltaWdodF9zbGVlcCgpOwogCiAJcmN1X3JlYWRfbG9jaygpOwotCXdoaWxl
ICh0ZXN0X2JpdChJOTE1X1JFU0VUX0JBQ0tPRkYsICZlcnJvci0+ZmxhZ3MpKSB7CisJd2hpbGUg
KHRlc3RfYml0KEk5MTVfUkVTRVRfQkFDS09GRiwgJmd0LT5yZXNldC5mbGFncykpIHsKIAkJcmN1
X3JlYWRfdW5sb2NrKCk7CiAKLQkJaWYgKHdhaXRfZXZlbnRfaW50ZXJydXB0aWJsZShlcnJvci0+
cmVzZXRfcXVldWUsCisJCWlmICh3YWl0X2V2ZW50X2ludGVycnVwdGlibGUoZ3QtPnJlc2V0LnF1
ZXVlLAogCQkJCQkgICAgICF0ZXN0X2JpdChJOTE1X1JFU0VUX0JBQ0tPRkYsCi0JCQkJCQkgICAg
ICAgJmVycm9yLT5mbGFncykpKQorCQkJCQkJICAgICAgICZndC0+cmVzZXQuZmxhZ3MpKSkKIAkJ
CXJldHVybiAtRUlOVFI7CiAKIAkJcmN1X3JlYWRfbG9jaygpOwogCX0KLQlzcmN1ID0gc3JjdV9y
ZWFkX2xvY2soJmVycm9yLT5yZXNldF9iYWNrb2ZmX3NyY3UpOworCXNyY3UgPSBzcmN1X3JlYWRf
bG9jaygmZ3QtPnJlc2V0LmJhY2tvZmZfc3JjdSk7CiAJcmN1X3JlYWRfdW5sb2NrKCk7CiAKIAly
ZXR1cm4gc3JjdTsKIH0KIAotdm9pZCBpOTE1X3Jlc2V0X3VubG9jayhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwgaW50IHRhZykKLV9fcmVsZWFzZXMoJmk5MTUtPmdwdV9lcnJvci5yZXNl
dF9iYWNrb2ZmX3NyY3UpCit2b2lkIGludGVsX2d0X3Jlc2V0X3VubG9jayhzdHJ1Y3QgaW50ZWxf
Z3QgKmd0LCBpbnQgdGFnKQorX19yZWxlYXNlcygmZ3QtPnJlc2V0LmJhY2tvZmZfc3JjdSkKIHsK
LQlzdHJ1Y3QgaTkxNV9ncHVfZXJyb3IgKmVycm9yID0gJmk5MTUtPmdwdV9lcnJvcjsKLQotCXNy
Y3VfcmVhZF91bmxvY2soJmVycm9yLT5yZXNldF9iYWNrb2ZmX3NyY3UsIHRhZyk7CisJc3JjdV9y
ZWFkX3VubG9jaygmZ3QtPnJlc2V0LmJhY2tvZmZfc3JjdSwgdGFnKTsKIH0KIAotaW50IGk5MTVf
dGVybWluYWxseV93ZWRnZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCitpbnQgaW50
ZWxfZ3RfdGVybWluYWxseV93ZWRnZWQoc3RydWN0IGludGVsX2d0ICpndCkKIHsKLQlzdHJ1Y3Qg
aTkxNV9ncHVfZXJyb3IgKmVycm9yID0gJmk5MTUtPmdwdV9lcnJvcjsKLQogCW1pZ2h0X3NsZWVw
KCk7CiAKLQlpZiAoIV9faTkxNV93ZWRnZWQoZXJyb3IpKQorCWlmICghaW50ZWxfZ3RfaXNfd2Vk
Z2VkKGd0KSkKIAkJcmV0dXJuIDA7CiAKIAkvKiBSZXNldCBzdGlsbCBpbiBwcm9ncmVzcz8gTWF5
YmUgd2Ugd2lsbCByZWNvdmVyPyAqLwotCWlmICghdGVzdF9iaXQoSTkxNV9SRVNFVF9CQUNLT0ZG
LCAmZXJyb3ItPmZsYWdzKSkKKwlpZiAoIXRlc3RfYml0KEk5MTVfUkVTRVRfQkFDS09GRiwgJmd0
LT5yZXNldC5mbGFncykpCiAJCXJldHVybiAtRUlPOwogCiAJLyogWFhYIGludGVsX3Jlc2V0X2Zp
bmlzaCgpIHN0aWxsIHRha2VzIHN0cnVjdF9tdXRleCEhISAqLwotCWlmIChtdXRleF9pc19sb2Nr
ZWQoJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpKQorCWlmIChtdXRleF9pc19sb2NrZWQoJmd0LT5p
OTE1LT5kcm0uc3RydWN0X211dGV4KSkKIAkJcmV0dXJuIC1FQUdBSU47CiAKLQlpZiAod2FpdF9l
dmVudF9pbnRlcnJ1cHRpYmxlKGVycm9yLT5yZXNldF9xdWV1ZSwKKwlpZiAod2FpdF9ldmVudF9p
bnRlcnJ1cHRpYmxlKGd0LT5yZXNldC5xdWV1ZSwKIAkJCQkgICAgICF0ZXN0X2JpdChJOTE1X1JF
U0VUX0JBQ0tPRkYsCi0JCQkJCSAgICAgICAmZXJyb3ItPmZsYWdzKSkpCisJCQkJCSAgICAgICAm
Z3QtPnJlc2V0LmZsYWdzKSkpCiAJCXJldHVybiAtRUlOVFI7CiAKLQlyZXR1cm4gX19pOTE1X3dl
ZGdlZChlcnJvcikgPyAtRUlPIDogMDsKKwlyZXR1cm4gaW50ZWxfZ3RfaXNfd2VkZ2VkKGd0KSA/
IC1FSU8gOiAwOworfQorCit2b2lkIGludGVsX2d0X2luaXRfcmVzZXQoc3RydWN0IGludGVsX2d0
ICpndCkKK3sKKwlpbml0X3dhaXRxdWV1ZV9oZWFkKCZndC0+cmVzZXQucXVldWUpOworCW11dGV4
X2luaXQoJmd0LT5yZXNldC5tdXRleCk7CisJaW5pdF9zcmN1X3N0cnVjdCgmZ3QtPnJlc2V0LmJh
Y2tvZmZfc3JjdSk7Cit9CisKK3ZvaWQgaW50ZWxfZ3RfZmluaV9yZXNldChzdHJ1Y3QgaW50ZWxf
Z3QgKmd0KQoreworCWNsZWFudXBfc3JjdV9zdHJ1Y3QoJmd0LT5yZXNldC5iYWNrb2ZmX3NyY3Up
OwogfQogCi1zdGF0aWMgdm9pZCBpOTE1X3dlZGdlX21lKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29y
aykKK3N0YXRpYyB2b2lkIGludGVsX3dlZGdlX21lKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykK
IHsKLQlzdHJ1Y3QgaTkxNV93ZWRnZV9tZSAqdyA9IGNvbnRhaW5lcl9vZih3b3JrLCB0eXBlb2Yo
KncpLCB3b3JrLndvcmspOworCXN0cnVjdCBpbnRlbF93ZWRnZV9tZSAqdyA9IGNvbnRhaW5lcl9v
Zih3b3JrLCB0eXBlb2YoKncpLCB3b3JrLndvcmspOwogCi0JZGV2X2Vycih3LT5pOTE1LT5kcm0u
ZGV2LAorCWRldl9lcnIody0+Z3QtPmk5MTUtPmRybS5kZXYsCiAJCSIlcyB0aW1lZCBvdXQsIGNh
bmNlbGxpbmcgYWxsIGluLWZsaWdodCByZW5kZXJpbmcuXG4iLAogCQl3LT5uYW1lKTsKLQlpOTE1
X2dlbV9zZXRfd2VkZ2VkKHctPmk5MTUpOworCWludGVsX2d0X3NldF93ZWRnZWQody0+Z3QpOwog
fQogCi12b2lkIF9faTkxNV9pbml0X3dlZGdlKHN0cnVjdCBpOTE1X3dlZGdlX21lICp3LAotCQkg
ICAgICAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCi0JCSAgICAgICBsb25nIHRpbWVv
dXQsCi0JCSAgICAgICBjb25zdCBjaGFyICpuYW1lKQordm9pZCBfX2ludGVsX2luaXRfd2VkZ2Uo
c3RydWN0IGludGVsX3dlZGdlX21lICp3LAorCQkJc3RydWN0IGludGVsX2d0ICpndCwKKwkJCWxv
bmcgdGltZW91dCwKKwkJCWNvbnN0IGNoYXIgKm5hbWUpCiB7Ci0Jdy0+aTkxNSA9IGk5MTU7CisJ
dy0+Z3QgPSBndDsKIAl3LT5uYW1lID0gbmFtZTsKIAotCUlOSVRfREVMQVlFRF9XT1JLX09OU1RB
Q0soJnctPndvcmssIGk5MTVfd2VkZ2VfbWUpOworCUlOSVRfREVMQVlFRF9XT1JLX09OU1RBQ0so
JnctPndvcmssIGludGVsX3dlZGdlX21lKTsKIAlzY2hlZHVsZV9kZWxheWVkX3dvcmsoJnctPndv
cmssIHRpbWVvdXQpOwogfQogCi12b2lkIF9faTkxNV9maW5pX3dlZGdlKHN0cnVjdCBpOTE1X3dl
ZGdlX21lICp3KQordm9pZCBfX2ludGVsX2Zpbmlfd2VkZ2Uoc3RydWN0IGludGVsX3dlZGdlX21l
ICp3KQogewogCWNhbmNlbF9kZWxheWVkX3dvcmtfc3luYygmdy0+d29yayk7CiAJZGVzdHJveV9k
ZWxheWVkX3dvcmtfb25fc3RhY2soJnctPndvcmspOwotCXctPmk5MTUgPSBOVUxMOworCXctPmd0
ID0gTlVMTDsKIH0KIAogI2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X1NFTEZURVNUKQpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuaCBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmgKaW5kZXggMDNmYmEwYWIzODY4Li4zN2E5
ODdiMTcxMDggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0
LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuaApAQCAtMTEsNTYg
KzExLDY3IEBACiAjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KICNpbmNsdWRlIDxsaW51eC9zcmN1
Lmg+CiAKLSNpbmNsdWRlICJndC9pbnRlbF9lbmdpbmVfdHlwZXMuaCIKKyNpbmNsdWRlICJpbnRl
bF9lbmdpbmVfdHlwZXMuaCIKKyNpbmNsdWRlICJpbnRlbF9yZXNldF90eXBlcy5oIgogCiBzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKIHN0cnVjdCBpOTE1X3JlcXVlc3Q7CiBzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzOworc3RydWN0IGludGVsX2d0Owogc3RydWN0IGludGVsX2d1YzsKIAordm9pZCBp
bnRlbF9ndF9pbml0X3Jlc2V0KHN0cnVjdCBpbnRlbF9ndCAqZ3QpOwordm9pZCBpbnRlbF9ndF9m
aW5pX3Jlc2V0KHN0cnVjdCBpbnRlbF9ndCAqZ3QpOworCiBfX3ByaW50Zig0LCA1KQotdm9pZCBp
OTE1X2hhbmRsZV9lcnJvcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKLQkJICAgICAg
IGludGVsX2VuZ2luZV9tYXNrX3QgZW5naW5lX21hc2ssCi0JCSAgICAgICB1bnNpZ25lZCBsb25n
IGZsYWdzLAotCQkgICAgICAgY29uc3QgY2hhciAqZm10LCAuLi4pOwordm9pZCBpbnRlbF9ndF9o
YW5kbGVfZXJyb3Ioc3RydWN0IGludGVsX2d0ICpndCwKKwkJCSAgIGludGVsX2VuZ2luZV9tYXNr
X3QgZW5naW5lX21hc2ssCisJCQkgICB1bnNpZ25lZCBsb25nIGZsYWdzLAorCQkJICAgY29uc3Qg
Y2hhciAqZm10LCAuLi4pOwogI2RlZmluZSBJOTE1X0VSUk9SX0NBUFRVUkUgQklUKDApCiAKLXZv
aWQgaTkxNV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKLQkJaW50ZWxfZW5n
aW5lX21hc2tfdCBzdGFsbGVkX21hc2ssCi0JCWNvbnN0IGNoYXIgKnJlYXNvbik7Ci1pbnQgaTkx
NV9yZXNldF9lbmdpbmUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAotCQkgICAgICBj
b25zdCBjaGFyICpyZWFzb24pOwotCi12b2lkIGk5MTVfcmVzZXRfcmVxdWVzdChzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpycSwgYm9vbCBndWlsdHkpOwordm9pZCBpbnRlbF9ndF9yZXNldChzdHJ1Y3Qg
aW50ZWxfZ3QgKmd0LAorCQkgICAgaW50ZWxfZW5naW5lX21hc2tfdCBzdGFsbGVkX21hc2ssCisJ
CSAgICBjb25zdCBjaGFyICpyZWFzb24pOworaW50IGludGVsX2VuZ2luZV9yZXNldChzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUsCisJCSAgICAgICBjb25zdCBjaGFyICpyZWFzb24pOwog
Ci1pbnQgX19tdXN0X2NoZWNrIGk5MTVfcmVzZXRfdHJ5bG9jayhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSk7Ci12b2lkIGk5MTVfcmVzZXRfdW5sb2NrKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LCBpbnQgdGFnKTsKK3ZvaWQgX19pOTE1X3JlcXVlc3RfcmVzZXQoc3RydWN0IGk5
MTVfcmVxdWVzdCAqcnEsIGJvb2wgZ3VpbHR5KTsKIAotaW50IGk5MTVfdGVybWluYWxseV93ZWRn
ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOworaW50IF9fbXVzdF9jaGVjayBpbnRl
bF9ndF9yZXNldF90cnlsb2NrKHN0cnVjdCBpbnRlbF9ndCAqZ3QpOwordm9pZCBpbnRlbF9ndF9y
ZXNldF91bmxvY2soc3RydWN0IGludGVsX2d0ICpndCwgaW50IHRhZyk7CiAKLWJvb2wgaW50ZWxf
aGFzX2dwdV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Ci1ib29sIGludGVs
X2hhc19yZXNldF9lbmdpbmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwordm9pZCBp
bnRlbF9ndF9zZXRfd2VkZ2VkKHN0cnVjdCBpbnRlbF9ndCAqZ3QpOworYm9vbCBpbnRlbF9ndF91
bnNldF93ZWRnZWQoc3RydWN0IGludGVsX2d0ICpndCk7CitpbnQgaW50ZWxfZ3RfdGVybWluYWxs
eV93ZWRnZWQoc3RydWN0IGludGVsX2d0ICpndCk7CiAKLWludCBpbnRlbF9ncHVfcmVzZXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCi0JCSAgICBpbnRlbF9lbmdpbmVfbWFza190IGVu
Z2luZV9tYXNrKTsKK2ludCBfX2ludGVsX2d0X3Jlc2V0KHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGlu
dGVsX2VuZ2luZV9tYXNrX3QgZW5naW5lX21hc2spOwogCi1pbnQgaW50ZWxfcmVzZXRfZ3VjKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKK2ludCBpbnRlbF9yZXNldF9ndWMoc3RydWN0
IGludGVsX2d0ICpndCk7CiAKLXN0cnVjdCBpOTE1X3dlZGdlX21lIHsKK3N0cnVjdCBpbnRlbF93
ZWRnZV9tZSB7CiAJc3RydWN0IGRlbGF5ZWRfd29yayB3b3JrOwotCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1OworCXN0cnVjdCBpbnRlbF9ndCAqZ3Q7CiAJY29uc3QgY2hhciAqbmFtZTsK
IH07CiAKLXZvaWQgX19pOTE1X2luaXRfd2VkZ2Uoc3RydWN0IGk5MTVfd2VkZ2VfbWUgKncsCi0J
CSAgICAgICBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKLQkJICAgICAgIGxvbmcgdGlt
ZW91dCwKLQkJICAgICAgIGNvbnN0IGNoYXIgKm5hbWUpOwotdm9pZCBfX2k5MTVfZmluaV93ZWRn
ZShzdHJ1Y3QgaTkxNV93ZWRnZV9tZSAqdyk7Cit2b2lkIF9faW50ZWxfaW5pdF93ZWRnZShzdHJ1
Y3QgaW50ZWxfd2VkZ2VfbWUgKncsCisJCQlzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAorCQkJbG9uZyB0
aW1lb3V0LAorCQkJY29uc3QgY2hhciAqbmFtZSk7Cit2b2lkIF9faW50ZWxfZmluaV93ZWRnZShz
dHJ1Y3QgaW50ZWxfd2VkZ2VfbWUgKncpOwogCi0jZGVmaW5lIGk5MTVfd2VkZ2Vfb25fdGltZW91
dChXLCBERVYsIFRJTUVPVVQpCQkJCVwKLQlmb3IgKF9faTkxNV9pbml0X3dlZGdlKChXKSwgKERF
ViksIChUSU1FT1VUKSwgX19mdW5jX18pOwlcCi0JICAgICAoVyktPmk5MTU7CQkJCQkJCVwKLQkg
ICAgIF9faTkxNV9maW5pX3dlZGdlKChXKSkpCisjZGVmaW5lIGludGVsX3dlZGdlX29uX3RpbWVv
dXQoVywgR1QsIFRJTUVPVVQpCQkJCVwKKwlmb3IgKF9faW50ZWxfaW5pdF93ZWRnZSgoVyksIChH
VCksIChUSU1FT1VUKSwgX19mdW5jX18pOwlcCisJICAgICAoVyktPmd0OwkJCQkJCQlcCisJICAg
ICBfX2ludGVsX2Zpbmlfd2VkZ2UoKFcpKSkKKworc3RhdGljIGlubGluZSBib29sIF9faW50ZWxf
cmVzZXRfZmFpbGVkKGNvbnN0IHN0cnVjdCBpbnRlbF9yZXNldCAqcmVzZXQpCit7CisJcmV0dXJu
IHVubGlrZWx5KHRlc3RfYml0KEk5MTVfV0VER0VELCAmcmVzZXQtPmZsYWdzKSk7Cit9CisKK2Jv
b2wgaW50ZWxfaGFzX2dwdV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Citi
b29sIGludGVsX2hhc19yZXNldF9lbmdpbmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
OwogCiAjZW5kaWYgLyogSTkxNV9SRVNFVF9IICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9yZXNldF90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfcmVzZXRfdHlwZXMuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAw
MDAuLjMxOTY4MzU2ZTBjMAotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX3Jlc2V0X3R5cGVzLmgKQEAgLTAsMCArMSw1MCBAQAorLyogU1BEWC1MaWNlbnNl
LUlkZW50aWZpZXI6IE1JVCAqLworLyoKKyAqIENvcHlyaWdodCDCqSAyMDE5IEludGVsIENvcnBv
cmF0aW9uCisgKi8KKworI2lmbmRlZiBfX0lOVEVMX1JFU0VUX1RZUEVTX0hfCisjZGVmaW5lIF9f
SU5URUxfUkVTRVRfVFlQRVNfSF8KKworI2luY2x1ZGUgPGxpbnV4L211dGV4Lmg+CisjaW5jbHVk
ZSA8bGludXgvd2FpdC5oPgorI2luY2x1ZGUgPGxpbnV4L3NyY3UuaD4KKworc3RydWN0IGludGVs
X3Jlc2V0IHsKKwkvKioKKwkgKiBmbGFnczogQ29udHJvbCB2YXJpb3VzIHN0YWdlcyBvZiB0aGUg
R1BVIHJlc2V0CisJICoKKwkgKiAjSTkxNV9SRVNFVF9CQUNLT0ZGIC0gV2hlbiB3ZSBzdGFydCBh
IGdsb2JhbCByZXNldCwgd2UgbmVlZCB0bworCSAqIHNlcmlhbGlzZSB3aXRoIGFueSBvdGhlciB1
c2VycyBhdHRlbXB0aW5nIHRvIGRvIHRoZSBzYW1lLCBhbmQKKwkgKiBhbnkgZ2xvYmFsIHJlc291
cmNlcyB0aGF0IG1heSBiZSBjbG9iYmVyIGJ5IHRoZSByZXNldCAoc3VjaCBhcworCSAqIEZFTkNF
IHJlZ2lzdGVycykuCisJICoKKwkgKiAjSTkxNV9SRVNFVF9FTkdJTkVbbnVtX2VuZ2luZXNdIC0g
U2luY2UgdGhlIGRyaXZlciBkb2Vzbid0IG5lZWQgdG8KKwkgKiBhY3F1aXJlIHRoZSBzdHJ1Y3Rf
bXV0ZXggdG8gcmVzZXQgYW4gZW5naW5lLCB3ZSBuZWVkIGFuIGV4cGxpY2l0CisJICogZmxhZyB0
byBwcmV2ZW50IHR3byBjb25jdXJyZW50IHJlc2V0IGF0dGVtcHRzIGluIHRoZSBzYW1lIGVuZ2lu
ZS4KKwkgKiBBcyB0aGUgbnVtYmVyIG9mIGVuZ2luZXMgY29udGludWVzIHRvIGdyb3csIGFsbG9j
YXRlIHRoZSBmbGFncyBmcm9tCisJICogdGhlIG1vc3Qgc2lnbmlmaWNhbnQgYml0cy4KKwkgKgor
CSAqICNJOTE1X1dFREdFRCAtIElmIHJlc2V0IGZhaWxzIGFuZCB3ZSBjYW4gbm8gbG9uZ2VyIHVz
ZSB0aGUgR1BVLAorCSAqIHdlIHNldCB0aGUgI0k5MTVfV0VER0VEIGJpdC4gUHJpb3IgdG8gY29t
bWFuZCBzdWJtaXNzaW9uLCBlLmcuCisJICogaTkxNV9yZXF1ZXN0X2FsbG9jKCksIHRoaXMgYml0
IGlzIGNoZWNrZWQgYW5kIHRoZSBzZXF1ZW5jZQorCSAqIGFib3J0ZWQgKHdpdGggLUVJTyByZXBv
cnRlZCB0byB1c2Vyc3BhY2UpIGlmIHNldC4KKwkgKi8KKwl1bnNpZ25lZCBsb25nIGZsYWdzOwor
I2RlZmluZSBJOTE1X1JFU0VUX0JBQ0tPRkYJMAorI2RlZmluZSBJOTE1X1JFU0VUX01PREVTRVQJ
MQorI2RlZmluZSBJOTE1X1JFU0VUX0VOR0lORQkyCisjZGVmaW5lIEk5MTVfV0VER0VECQkoQklU
U19QRVJfTE9ORyAtIDEpCisKKwlzdHJ1Y3QgbXV0ZXggbXV0ZXg7IC8qIHNlcmlhbGlzZXMgd2Vk
Z2luZy91bndlZGdpbmcgKi8KKworCS8qKgorCSAqIFdhaXRxdWV1ZSB0byBzaWduYWwgd2hlbiB0
aGUgcmVzZXQgaGFzIGNvbXBsZXRlZC4gVXNlZCBieSBjbGllbnRzCisJICogdGhhdCB3YWl0IGZv
ciBkZXZfcHJpdi0+bW0ud2VkZ2VkIHRvIHNldHRsZS4KKwkgKi8KKwl3YWl0X3F1ZXVlX2hlYWRf
dCBxdWV1ZTsKKworCXN0cnVjdCBzcmN1X3N0cnVjdCBiYWNrb2ZmX3NyY3U7Cit9OworCisjZW5k
aWYgLyogX0lOVEVMX1JFU0VUX1RZUEVTX0hfICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9yaW5nYnVmZmVyLmMKaW5kZXggMjg3MzI3Njg3OWNiLi5mMWU1NzFmYTJlNmQgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JpbmdidWZmZXIuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMKQEAgLTc5NSw3ICs3OTUs
NyBAQCBzdGF0aWMgdm9pZCByZXNldF9yaW5nKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSwgYm9vbCBzdGFsbGVkKQogCQkgKiBJZiB0aGUgcmVxdWVzdCB3YXMgaW5ub2NlbnQsIHdlIHRy
eSB0byByZXBsYXkgdGhlIHJlcXVlc3QKIAkJICogd2l0aCB0aGUgcmVzdG9yZWQgY29udGV4dC4K
IAkJICovCi0JCWk5MTVfcmVzZXRfcmVxdWVzdChycSwgc3RhbGxlZCk7CisJCV9faTkxNV9yZXF1
ZXN0X3Jlc2V0KHJxLCBzdGFsbGVkKTsKIAogCQlHRU1fQlVHX09OKHJxLT5yaW5nICE9IGVuZ2lu
ZS0+YnVmZmVyKTsKIAkJaGVhZCA9IHJxLT5oZWFkOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfaGFuZ2NoZWNrLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9zZWxmdGVzdF9oYW5nY2hlY2suYwppbmRleCAyZDljYzNjZDFmMjcuLmUyZmEzOGExZmYwZiAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfaGFuZ2NoZWNrLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfaGFuZ2NoZWNrLmMKQEAgLTMy
LDcgKzMyLDYgQEAKICNpbmNsdWRlICJzZWxmdGVzdHMvaTkxNV9yYW5kb20uaCIKICNpbmNsdWRl
ICJzZWxmdGVzdHMvaWd0X2ZsdXNoX3Rlc3QuaCIKICNpbmNsdWRlICJzZWxmdGVzdHMvaWd0X3Jl
c2V0LmgiCi0jaW5jbHVkZSAic2VsZnRlc3RzL2lndF93ZWRnZV9tZS5oIgogI2luY2x1ZGUgInNl
bGZ0ZXN0cy9pZ3RfYXRvbWljLmgiCiAKICNpbmNsdWRlICJzZWxmdGVzdHMvbW9ja19kcm0uaCIK
QEAgLTQzLDcgKzQyLDYgQEAKICNkZWZpbmUgSUdUX0lETEVfVElNRU9VVCA1MCAvKiBtczsgdGlt
ZSB0byB3YWl0IGFmdGVyIGZsdXNoaW5nIGJldHdlZW4gdGVzdHMgKi8KIAogc3RydWN0IGhhbmcg
ewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1OwogCXN0cnVjdCBpbnRlbF9ndCAqZ3Q7
CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKmh3czsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdCAqb2JqOwpAQCAtNTIsMjcgKzUwLDI3IEBAIHN0cnVjdCBoYW5nIHsKIAl1MzIgKmJh
dGNoOwogfTsKIAotc3RhdGljIGludCBoYW5nX2luaXQoc3RydWN0IGhhbmcgKmgsIHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQorc3RhdGljIGludCBoYW5nX2luaXQoc3RydWN0IGhhbmcg
KmgsIHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7CiAJdm9pZCAqdmFkZHI7CiAJaW50IGVycjsKIAog
CW1lbXNldChoLCAwLCBzaXplb2YoKmgpKTsKLQloLT5pOTE1ID0gaTkxNTsKKwloLT5ndCA9IGd0
OwogCi0JaC0+Y3R4ID0ga2VybmVsX2NvbnRleHQoaTkxNSk7CisJaC0+Y3R4ID0ga2VybmVsX2Nv
bnRleHQoZ3QtPmk5MTUpOwogCWlmIChJU19FUlIoaC0+Y3R4KSkKIAkJcmV0dXJuIFBUUl9FUlIo
aC0+Y3R4KTsKIAogCUdFTV9CVUdfT04oaTkxNV9nZW1fY29udGV4dF9pc19iYW5uYWJsZShoLT5j
dHgpKTsKIAotCWgtPmh3cyA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfaW50ZXJuYWwoaTkxNSwg
UEFHRV9TSVpFKTsKKwloLT5od3MgPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX2ludGVybmFsKGd0
LT5pOTE1LCBQQUdFX1NJWkUpOwogCWlmIChJU19FUlIoaC0+aHdzKSkgewogCQllcnIgPSBQVFJf
RVJSKGgtPmh3cyk7CiAJCWdvdG8gZXJyX2N0eDsKIAl9CiAKLQloLT5vYmogPSBpOTE1X2dlbV9v
YmplY3RfY3JlYXRlX2ludGVybmFsKGk5MTUsIFBBR0VfU0laRSk7CisJaC0+b2JqID0gaTkxNV9n
ZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5hbChndC0+aTkxNSwgUEFHRV9TSVpFKTsKIAlpZiAoSVNf
RVJSKGgtPm9iaikpIHsKIAkJZXJyID0gUFRSX0VSUihoLT5vYmopOwogCQlnb3RvIGVycl9od3M7
CkBAIC04Nyw3ICs4NSw3IEBAIHN0YXRpYyBpbnQgaGFuZ19pbml0KHN0cnVjdCBoYW5nICpoLCBz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAloLT5zZXFubyA9IG1lbXNldCh2YWRkciwg
MHhmZiwgUEFHRV9TSVpFKTsKIAogCXZhZGRyID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAoaC0+
b2JqLAotCQkJCQlpOTE1X2NvaGVyZW50X21hcF90eXBlKGk5MTUpKTsKKwkJCQkJaTkxNV9jb2hl
cmVudF9tYXBfdHlwZShndC0+aTkxNSkpOwogCWlmIChJU19FUlIodmFkZHIpKSB7CiAJCWVyciA9
IFBUUl9FUlIodmFkZHIpOwogCQlnb3RvIGVycl91bnBpbl9od3M7CkBAIC0xMjksNyArMTI3LDcg
QEAgc3RhdGljIGludCBtb3ZlX3RvX2FjdGl2ZShzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKIHN0YXRp
YyBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICoKIGhhbmdfY3JlYXRlX3JlcXVlc3Qoc3RydWN0IGhhbmcg
KmgsIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IGgtPmk5MTU7CisJc3RydWN0IGludGVsX2d0ICpndCA9IGgtPmd0Owog
CXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0gaC0+Y3R4LT52bSA/OiAmZW5naW5lLT5n
dC0+Z2d0dC0+dm07CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKIAlzdHJ1Y3Qg
aTkxNV9yZXF1ZXN0ICpycSA9IE5VTEw7CkBAIC0xMzksMTEgKzEzNywxMSBAQCBoYW5nX2NyZWF0
ZV9yZXF1ZXN0KHN0cnVjdCBoYW5nICpoLCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUp
CiAJdTMyICpiYXRjaDsKIAlpbnQgZXJyOwogCi0Jb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0
ZV9pbnRlcm5hbChpOTE1LCBQQUdFX1NJWkUpOworCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVh
dGVfaW50ZXJuYWwoZ3QtPmk5MTUsIFBBR0VfU0laRSk7CiAJaWYgKElTX0VSUihvYmopKQogCQly
ZXR1cm4gRVJSX0NBU1Qob2JqKTsKIAotCXZhZGRyID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAo
b2JqLCBpOTE1X2NvaGVyZW50X21hcF90eXBlKGk5MTUpKTsKKwl2YWRkciA9IGk5MTVfZ2VtX29i
amVjdF9waW5fbWFwKG9iaiwgaTkxNV9jb2hlcmVudF9tYXBfdHlwZShndC0+aTkxNSkpOwogCWlm
IChJU19FUlIodmFkZHIpKSB7CiAJCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKIAkJcmV0dXJu
IEVSUl9DQVNUKHZhZGRyKTsKQEAgLTE4Niw3ICsxODQsNyBAQCBoYW5nX2NyZWF0ZV9yZXF1ZXN0
KHN0cnVjdCBoYW5nICpoLCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJCWdvdG8g
Y2FuY2VsX3JxOwogCiAJYmF0Y2ggPSBoLT5iYXRjaDsKLQlpZiAoSU5URUxfR0VOKGk5MTUpID49
IDgpIHsKKwlpZiAoSU5URUxfR0VOKGd0LT5pOTE1KSA+PSA4KSB7CiAJCSpiYXRjaCsrID0gTUlf
U1RPUkVfRFdPUkRfSU1NX0dFTjQ7CiAJCSpiYXRjaCsrID0gbG93ZXJfMzJfYml0cyhod3NfYWRk
cmVzcyhod3MsIHJxKSk7CiAJCSpiYXRjaCsrID0gdXBwZXJfMzJfYml0cyhod3NfYWRkcmVzcyho
d3MsIHJxKSk7CkBAIC0yMDAsNyArMTk4LDcgQEAgaGFuZ19jcmVhdGVfcmVxdWVzdChzdHJ1Y3Qg
aGFuZyAqaCwgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCQkqYmF0Y2grKyA9IE1J
X0JBVENIX0JVRkZFUl9TVEFSVCB8IDEgPDwgOCB8IDE7CiAJCSpiYXRjaCsrID0gbG93ZXJfMzJf
Yml0cyh2bWEtPm5vZGUuc3RhcnQpOwogCQkqYmF0Y2grKyA9IHVwcGVyXzMyX2JpdHModm1hLT5u
b2RlLnN0YXJ0KTsKLQl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA2KSB7CisJfSBlbHNl
IGlmIChJTlRFTF9HRU4oZ3QtPmk5MTUpID49IDYpIHsKIAkJKmJhdGNoKysgPSBNSV9TVE9SRV9E
V09SRF9JTU1fR0VONDsKIAkJKmJhdGNoKysgPSAwOwogCQkqYmF0Y2grKyA9IGxvd2VyXzMyX2Jp
dHMoaHdzX2FkZHJlc3MoaHdzLCBycSkpOwpAQCAtMjEzLDcgKzIxMSw3IEBAIGhhbmdfY3JlYXRl
X3JlcXVlc3Qoc3RydWN0IGhhbmcgKmgsIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkK
IAkJKmJhdGNoKysgPSBNSV9BUkJfQ0hFQ0s7CiAJCSpiYXRjaCsrID0gTUlfQkFUQ0hfQlVGRkVS
X1NUQVJUIHwgMSA8PCA4OwogCQkqYmF0Y2grKyA9IGxvd2VyXzMyX2JpdHModm1hLT5ub2RlLnN0
YXJ0KTsKLQl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA0KSB7CisJfSBlbHNlIGlmIChJ
TlRFTF9HRU4oZ3QtPmk5MTUpID49IDQpIHsKIAkJKmJhdGNoKysgPSBNSV9TVE9SRV9EV09SRF9J
TU1fR0VONCB8IE1JX1VTRV9HR1RUOwogCQkqYmF0Y2grKyA9IDA7CiAJCSpiYXRjaCsrID0gbG93
ZXJfMzJfYml0cyhod3NfYWRkcmVzcyhod3MsIHJxKSk7CkBAIC0yNDksNyArMjQ3LDcgQEAgaGFu
Z19jcmVhdGVfcmVxdWVzdChzdHJ1Y3QgaGFuZyAqaCwgc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lKQogCX0KIAogCWZsYWdzID0gMDsKLQlpZiAoSU5URUxfR0VOKGk5MTUpIDw9IDUpCisJ
aWYgKElOVEVMX0dFTihndC0+aTkxNSkgPD0gNSkKIAkJZmxhZ3MgfD0gSTkxNV9ESVNQQVRDSF9T
RUNVUkU7CiAKIAllcnIgPSBycS0+ZW5naW5lLT5lbWl0X2JiX3N0YXJ0KHJxLCB2bWEtPm5vZGUu
c3RhcnQsIFBBR0VfU0laRSwgZmxhZ3MpOwpAQCAtMjg2LDcgKzI4NCw3IEBAIHN0YXRpYyB2b2lk
IGhhbmdfZmluaShzdHJ1Y3QgaGFuZyAqaCkKIAogCWtlcm5lbF9jb250ZXh0X2Nsb3NlKGgtPmN0
eCk7CiAKLQlpZ3RfZmx1c2hfdGVzdChoLT5pOTE1LCBJOTE1X1dBSVRfTE9DS0VEKTsKKwlpZ3Rf
Zmx1c2hfdGVzdChoLT5ndC0+aTkxNSwgSTkxNV9XQUlUX0xPQ0tFRCk7CiB9CiAKIHN0YXRpYyBi
b29sIHdhaXRfdW50aWxfcnVubmluZyhzdHJ1Y3QgaGFuZyAqaCwgc3RydWN0IGk5MTVfcmVxdWVz
dCAqcnEpCkBAIC0zMDEsNyArMjk5LDcgQEAgc3RhdGljIGJvb2wgd2FpdF91bnRpbF9ydW5uaW5n
KHN0cnVjdCBoYW5nICpoLCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIAogc3RhdGljIGludCBp
Z3RfaGFuZ19zYW5pdHljaGVjayh2b2lkICphcmcpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSBhcmc7CisJc3RydWN0IGludGVsX2d0ICpndCA9IGFyZzsKIAlzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpycTsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CiAJZW51bSBp
bnRlbF9lbmdpbmVfaWQgaWQ7CkBAIC0zMTAsMTMgKzMwOCwxMyBAQCBzdGF0aWMgaW50IGlndF9o
YW5nX3Nhbml0eWNoZWNrKHZvaWQgKmFyZykKIAogCS8qIEJhc2ljIGNoZWNrIHRoYXQgd2UgY2Fu
IGV4ZWN1dGUgb3VyIGhhbmdpbmcgYmF0Y2ggKi8KIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5z
dHJ1Y3RfbXV0ZXgpOwotCWVyciA9IGhhbmdfaW5pdCgmaCwgaTkxNSk7CisJbXV0ZXhfbG9jaygm
Z3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCWVyciA9IGhhbmdfaW5pdCgmaCwgZ3QpOwog
CWlmIChlcnIpCiAJCWdvdG8gdW5sb2NrOwogCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkx
NSwgaWQpIHsKLQkJc3RydWN0IGlndF93ZWRnZV9tZSB3OworCWZvcl9lYWNoX2VuZ2luZShlbmdp
bmUsIGd0LT5pOTE1LCBpZCkgeworCQlzdHJ1Y3QgaW50ZWxfd2VkZ2VfbWUgdzsKIAkJbG9uZyB0
aW1lb3V0OwogCiAJCWlmICghaW50ZWxfZW5naW5lX2Nhbl9zdG9yZV9kd29yZChlbmdpbmUpKQpA
QCAtMzM4LDEwICszMzYsMTAgQEAgc3RhdGljIGludCBpZ3RfaGFuZ19zYW5pdHljaGVjayh2b2lk
ICphcmcpCiAJCWk5MTVfcmVxdWVzdF9hZGQocnEpOwogCiAJCXRpbWVvdXQgPSAwOwotCQlpZ3Rf
d2VkZ2Vfb25fdGltZW91dCgmdywgaTkxNSwgSFogLyAxMCAvKiAxMDBtcyB0aW1lb3V0Ki8pCisJ
CWludGVsX3dlZGdlX29uX3RpbWVvdXQoJncsIGd0LCBIWiAvIDEwIC8qIDEwMG1zICovKQogCQkJ
dGltZW91dCA9IGk5MTVfcmVxdWVzdF93YWl0KHJxLCAwLAogCQkJCQkJICAgIE1BWF9TQ0hFRFVM
RV9USU1FT1VUKTsKLQkJaWYgKGk5MTVfcmVzZXRfZmFpbGVkKGk5MTUpKQorCQlpZiAoaW50ZWxf
Z3RfaXNfd2VkZ2VkKGd0KSkKIAkJCXRpbWVvdXQgPSAtRUlPOwogCiAJCWk5MTVfcmVxdWVzdF9w
dXQocnEpOwpAQCAtMzU3LDcgKzM1NSw3IEBAIHN0YXRpYyBpbnQgaWd0X2hhbmdfc2FuaXR5Y2hl
Y2sodm9pZCAqYXJnKQogZmluaToKIAloYW5nX2ZpbmkoJmgpOwogdW5sb2NrOgotCW11dGV4X3Vu
bG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CisJbXV0ZXhfdW5sb2NrKCZndC0+aTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7CiAJcmV0dXJuIGVycjsKIH0KIApAQCAtMzY4LDcgKzM2Niw4IEBA
IHN0YXRpYyBib29sIHdhaXRfZm9yX2lkbGUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KQogCiBzdGF0aWMgaW50IGlndF9yZXNldF9ub3Aodm9pZCAqYXJnKQogewotCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gYXJnOworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7CisJ
c3RydWN0IGk5MTVfZ3B1X2Vycm9yICpnbG9iYWwgPSAmZ3QtPmk5MTUtPmdwdV9lcnJvcjsKIAlz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CiAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQg
KmN0eDsKIAl1bnNpZ25lZCBpbnQgcmVzZXRfY291bnQsIGNvdW50OwpAQCAtMzc5LDI1ICszNzgs
MjUgQEAgc3RhdGljIGludCBpZ3RfcmVzZXRfbm9wKHZvaWQgKmFyZykKIAogCS8qIENoZWNrIHRo
YXQgd2UgY2FuIHJlc2V0IGR1cmluZyBub24tdXNlciBwb3J0aW9ucyBvZiByZXF1ZXN0cyAqLwog
Ci0JZmlsZSA9IG1vY2tfZmlsZShpOTE1KTsKKwlmaWxlID0gbW9ja19maWxlKGd0LT5pOTE1KTsK
IAlpZiAoSVNfRVJSKGZpbGUpKQogCQlyZXR1cm4gUFRSX0VSUihmaWxlKTsKIAotCW11dGV4X2xv
Y2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCWN0eCA9IGxpdmVfY29udGV4dChpOTE1LCBm
aWxlKTsKLQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCW11dGV4X2xv
Y2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKKwljdHggPSBsaXZlX2NvbnRleHQoZ3Qt
Pmk5MTUsIGZpbGUpOworCW11dGV4X3VubG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgp
OwogCWlmIChJU19FUlIoY3R4KSkgewogCQllcnIgPSBQVFJfRVJSKGN0eCk7CiAJCWdvdG8gb3V0
OwogCX0KIAogCWk5MTVfZ2VtX2NvbnRleHRfY2xlYXJfYmFubmFibGUoY3R4KTsKLQlyZXNldF9j
b3VudCA9IGk5MTVfcmVzZXRfY291bnQoJmk5MTUtPmdwdV9lcnJvcik7CisJcmVzZXRfY291bnQg
PSBpOTE1X3Jlc2V0X2NvdW50KGdsb2JhbCk7CiAJY291bnQgPSAwOwogCWRvIHsKLQkJbXV0ZXhf
bG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CisJCW11dGV4X2xvY2soJmd0LT5pOTE1LT5k
cm0uc3RydWN0X211dGV4KTsKIAotCQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkg
eworCQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndC0+aTkxNSwgaWQpIHsKIAkJCWludCBpOwog
CiAJCQlmb3IgKGkgPSAwOyBpIDwgMTY7IGkrKykgewpAQCAtNDEzLDQzICs0MTIsNDMgQEAgc3Rh
dGljIGludCBpZ3RfcmVzZXRfbm9wKHZvaWQgKmFyZykKIAkJCX0KIAkJfQogCi0JCWlndF9nbG9i
YWxfcmVzZXRfbG9jayhpOTE1KTsKLQkJaTkxNV9yZXNldChpOTE1LCBBTExfRU5HSU5FUywgTlVM
TCk7Ci0JCWlndF9nbG9iYWxfcmVzZXRfdW5sb2NrKGk5MTUpOworCQlpZ3RfZ2xvYmFsX3Jlc2V0
X2xvY2soZ3QpOworCQlpbnRlbF9ndF9yZXNldChndCwgQUxMX0VOR0lORVMsIE5VTEwpOworCQlp
Z3RfZ2xvYmFsX3Jlc2V0X3VubG9jayhndCk7CiAKLQkJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0u
c3RydWN0X211dGV4KTsKLQkJaWYgKGk5MTVfcmVzZXRfZmFpbGVkKGk5MTUpKSB7CisJCW11dGV4
X3VubG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCQlpZiAoaW50ZWxfZ3RfaXNf
d2VkZ2VkKGd0KSkgewogCQkJZXJyID0gLUVJTzsKIAkJCWJyZWFrOwogCQl9CiAKLQkJaWYgKGk5
MTVfcmVzZXRfY291bnQoJmk5MTUtPmdwdV9lcnJvcikgIT0KLQkJICAgIHJlc2V0X2NvdW50ICsg
Kytjb3VudCkgeworCQlpZiAoaTkxNV9yZXNldF9jb3VudChnbG9iYWwpICE9IHJlc2V0X2NvdW50
ICsgKytjb3VudCkgewogCQkJcHJfZXJyKCJGdWxsIEdQVSByZXNldCBub3QgcmVjb3JkZWQhXG4i
KTsKIAkJCWVyciA9IC1FSU5WQUw7CiAJCQlicmVhazsKIAkJfQogCi0JCWVyciA9IGlndF9mbHVz
aF90ZXN0KGk5MTUsIDApOworCQllcnIgPSBpZ3RfZmx1c2hfdGVzdChndC0+aTkxNSwgMCk7CiAJ
CWlmIChlcnIpCiAJCQlicmVhazsKIAl9IHdoaWxlICh0aW1lX2JlZm9yZShqaWZmaWVzLCBlbmRf
dGltZSkpOwogCXByX2luZm8oIiVzOiAlZCByZXNldHNcbiIsIF9fZnVuY19fLCBjb3VudCk7CiAK
LQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQllcnIgPSBpZ3RfZmx1c2hf
dGVzdChpOTE1LCBJOTE1X1dBSVRfTE9DS0VEKTsKLQltdXRleF91bmxvY2soJmk5MTUtPmRybS5z
dHJ1Y3RfbXV0ZXgpOworCW11dGV4X2xvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsK
KwllcnIgPSBpZ3RfZmx1c2hfdGVzdChndC0+aTkxNSwgSTkxNV9XQUlUX0xPQ0tFRCk7CisJbXV0
ZXhfdW5sb2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAKIG91dDoKLQltb2NrX2Zp
bGVfZnJlZShpOTE1LCBmaWxlKTsKLQlpZiAoaTkxNV9yZXNldF9mYWlsZWQoaTkxNSkpCisJbW9j
a19maWxlX2ZyZWUoZ3QtPmk5MTUsIGZpbGUpOworCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoZ3Qp
KQogCQllcnIgPSAtRUlPOwogCXJldHVybiBlcnI7CiB9CiAKIHN0YXRpYyBpbnQgaWd0X3Jlc2V0
X25vcF9lbmdpbmUodm9pZCAqYXJnKQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gYXJnOworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7CisJc3RydWN0IGk5MTVfZ3B1X2Vy
cm9yICpnbG9iYWwgPSAmZ3QtPmk5MTUtPmdwdV9lcnJvcjsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmU7CiAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eDsKIAllbnVtIGludGVs
X2VuZ2luZV9pZCBpZDsKQEAgLTQ1OCwzMyArNDU3LDMyIEBAIHN0YXRpYyBpbnQgaWd0X3Jlc2V0
X25vcF9lbmdpbmUodm9pZCAqYXJnKQogCiAJLyogQ2hlY2sgdGhhdCB3ZSBjYW4gZW5naW5lLXJl
c2V0IGR1cmluZyBub24tdXNlciBwb3J0aW9ucyAqLwogCi0JaWYgKCFpbnRlbF9oYXNfcmVzZXRf
ZW5naW5lKGk5MTUpKQorCWlmICghaW50ZWxfaGFzX3Jlc2V0X2VuZ2luZShndC0+aTkxNSkpCiAJ
CXJldHVybiAwOwogCi0JZmlsZSA9IG1vY2tfZmlsZShpOTE1KTsKKwlmaWxlID0gbW9ja19maWxl
KGd0LT5pOTE1KTsKIAlpZiAoSVNfRVJSKGZpbGUpKQogCQlyZXR1cm4gUFRSX0VSUihmaWxlKTsK
IAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCWN0eCA9IGxpdmVfY29u
dGV4dChpOTE1LCBmaWxlKTsKLQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgp
OworCW11dGV4X2xvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKKwljdHggPSBsaXZl
X2NvbnRleHQoZ3QtPmk5MTUsIGZpbGUpOworCW11dGV4X3VubG9jaygmZ3QtPmk5MTUtPmRybS5z
dHJ1Y3RfbXV0ZXgpOwogCWlmIChJU19FUlIoY3R4KSkgewogCQllcnIgPSBQVFJfRVJSKGN0eCk7
CiAJCWdvdG8gb3V0OwogCX0KIAogCWk5MTVfZ2VtX2NvbnRleHRfY2xlYXJfYmFubmFibGUoY3R4
KTsKLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgeworCWZvcl9lYWNoX2VuZ2lu
ZShlbmdpbmUsIGd0LT5pOTE1LCBpZCkgewogCQl1bnNpZ25lZCBpbnQgcmVzZXRfY291bnQsIHJl
c2V0X2VuZ2luZV9jb3VudDsKIAkJdW5zaWduZWQgaW50IGNvdW50OwogCQlJR1RfVElNRU9VVChl
bmRfdGltZSk7CiAKLQkJcmVzZXRfY291bnQgPSBpOTE1X3Jlc2V0X2NvdW50KCZpOTE1LT5ncHVf
ZXJyb3IpOwotCQlyZXNldF9lbmdpbmVfY291bnQgPSBpOTE1X3Jlc2V0X2VuZ2luZV9jb3VudCgm
aTkxNS0+Z3B1X2Vycm9yLAotCQkJCQkJCSAgICAgZW5naW5lKTsKKwkJcmVzZXRfY291bnQgPSBp
OTE1X3Jlc2V0X2NvdW50KGdsb2JhbCk7CisJCXJlc2V0X2VuZ2luZV9jb3VudCA9IGk5MTVfcmVz
ZXRfZW5naW5lX2NvdW50KGdsb2JhbCwgZW5naW5lKTsKIAkJY291bnQgPSAwOwogCi0JCXNldF9i
aXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBpZCwgJmk5MTUtPmdwdV9lcnJvci5mbGFncyk7CisJCXNl
dF9iaXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBpZCwgJmd0LT5yZXNldC5mbGFncyk7CiAJCWRvIHsK
IAkJCWludCBpOwogCkBAIC00OTUsNyArNDkzLDcgQEAgc3RhdGljIGludCBpZ3RfcmVzZXRfbm9w
X2VuZ2luZSh2b2lkICphcmcpCiAJCQkJYnJlYWs7CiAJCQl9CiAKLQkJCW11dGV4X2xvY2soJmk5
MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCQkJbXV0ZXhfbG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1
Y3RfbXV0ZXgpOwogCQkJZm9yIChpID0gMDsgaSA8IDE2OyBpKyspIHsKIAkJCQlzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpycTsKIApAQCAtNTA3LDIwICs1MDUsMjAgQEAgc3RhdGljIGludCBpZ3RfcmVz
ZXRfbm9wX2VuZ2luZSh2b2lkICphcmcpCiAKIAkJCQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKIAkJ
CX0KLQkJCWVyciA9IGk5MTVfcmVzZXRfZW5naW5lKGVuZ2luZSwgTlVMTCk7Ci0JCQltdXRleF91
bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCQkJZXJyID0gaW50ZWxfZW5naW5lX3Jl
c2V0KGVuZ2luZSwgTlVMTCk7CisJCQltdXRleF91bmxvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0
X211dGV4KTsKIAkJCWlmIChlcnIpIHsKIAkJCQlwcl9lcnIoImk5MTVfcmVzZXRfZW5naW5lIGZh
aWxlZFxuIik7CiAJCQkJYnJlYWs7CiAJCQl9CiAKLQkJCWlmIChpOTE1X3Jlc2V0X2NvdW50KCZp
OTE1LT5ncHVfZXJyb3IpICE9IHJlc2V0X2NvdW50KSB7CisJCQlpZiAoaTkxNV9yZXNldF9jb3Vu
dChnbG9iYWwpICE9IHJlc2V0X2NvdW50KSB7CiAJCQkJcHJfZXJyKCJGdWxsIEdQVSByZXNldCBy
ZWNvcmRlZCEgKGVuZ2luZSByZXNldCBleHBlY3RlZClcbiIpOwogCQkJCWVyciA9IC1FSU5WQUw7
CiAJCQkJYnJlYWs7CiAJCQl9CiAKLQkJCWlmIChpOTE1X3Jlc2V0X2VuZ2luZV9jb3VudCgmaTkx
NS0+Z3B1X2Vycm9yLCBlbmdpbmUpICE9CisJCQlpZiAoaTkxNV9yZXNldF9lbmdpbmVfY291bnQo
Z2xvYmFsLCBlbmdpbmUpICE9CiAJCQkgICAgcmVzZXRfZW5naW5lX2NvdW50ICsgKytjb3VudCkg
ewogCQkJCXByX2VycigiJXMgZW5naW5lIHJlc2V0IG5vdCByZWNvcmRlZCFcbiIsCiAJCQkJICAg
ICAgIGVuZ2luZS0+bmFtZSk7CkBAIC01MjgsMzAgKzUyNiwzMSBAQCBzdGF0aWMgaW50IGlndF9y
ZXNldF9ub3BfZW5naW5lKHZvaWQgKmFyZykKIAkJCQlicmVhazsKIAkJCX0KIAkJfSB3aGlsZSAo
dGltZV9iZWZvcmUoamlmZmllcywgZW5kX3RpbWUpKTsKLQkJY2xlYXJfYml0KEk5MTVfUkVTRVRf
RU5HSU5FICsgaWQsICZpOTE1LT5ncHVfZXJyb3IuZmxhZ3MpOworCQljbGVhcl9iaXQoSTkxNV9S
RVNFVF9FTkdJTkUgKyBpZCwgJmd0LT5yZXNldC5mbGFncyk7CiAJCXByX2luZm8oIiVzKCVzKTog
JWQgcmVzZXRzXG4iLCBfX2Z1bmNfXywgZW5naW5lLT5uYW1lLCBjb3VudCk7CiAKIAkJaWYgKGVy
cikKIAkJCWJyZWFrOwogCi0JCWVyciA9IGlndF9mbHVzaF90ZXN0KGk5MTUsIDApOworCQllcnIg
PSBpZ3RfZmx1c2hfdGVzdChndC0+aTkxNSwgMCk7CiAJCWlmIChlcnIpCiAJCQlicmVhazsKIAl9
CiAKLQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQllcnIgPSBpZ3RfZmx1
c2hfdGVzdChpOTE1LCBJOTE1X1dBSVRfTE9DS0VEKTsKLQltdXRleF91bmxvY2soJmk5MTUtPmRy
bS5zdHJ1Y3RfbXV0ZXgpOworCW11dGV4X2xvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4
KTsKKwllcnIgPSBpZ3RfZmx1c2hfdGVzdChndC0+aTkxNSwgSTkxNV9XQUlUX0xPQ0tFRCk7CisJ
bXV0ZXhfdW5sb2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAKIG91dDoKLQltb2Nr
X2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKLQlpZiAoaTkxNV9yZXNldF9mYWlsZWQoaTkxNSkpCisJ
bW9ja19maWxlX2ZyZWUoZ3QtPmk5MTUsIGZpbGUpOworCWlmIChpbnRlbF9ndF9pc193ZWRnZWQo
Z3QpKQogCQllcnIgPSAtRUlPOwogCXJldHVybiBlcnI7CiB9CiAKLXN0YXRpYyBpbnQgX19pZ3Rf
cmVzZXRfZW5naW5lKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBib29sIGFjdGl2ZSkK
K3N0YXRpYyBpbnQgX19pZ3RfcmVzZXRfZW5naW5lKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGJvb2wg
YWN0aXZlKQogeworCXN0cnVjdCBpOTE1X2dwdV9lcnJvciAqZ2xvYmFsID0gJmd0LT5pOTE1LT5n
cHVfZXJyb3I7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwogCWVudW0gaW50ZWxf
ZW5naW5lX2lkIGlkOwogCXN0cnVjdCBoYW5nIGg7CkBAIC01NTksMTggKzU1OCwxOCBAQCBzdGF0
aWMgaW50IF9faWd0X3Jlc2V0X2VuZ2luZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwg
Ym9vbCBhY3RpdmUpCiAKIAkvKiBDaGVjayB0aGF0IHdlIGNhbiBpc3N1ZSBhbiBlbmdpbmUgcmVz
ZXQgb24gYW4gaWRsZSBlbmdpbmUgKG5vLW9wKSAqLwogCi0JaWYgKCFpbnRlbF9oYXNfcmVzZXRf
ZW5naW5lKGk5MTUpKQorCWlmICghaW50ZWxfaGFzX3Jlc2V0X2VuZ2luZShndC0+aTkxNSkpCiAJ
CXJldHVybiAwOwogCiAJaWYgKGFjdGl2ZSkgewotCQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3Ry
dWN0X211dGV4KTsKLQkJZXJyID0gaGFuZ19pbml0KCZoLCBpOTE1KTsKLQkJbXV0ZXhfdW5sb2Nr
KCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKKwkJbXV0ZXhfbG9jaygmZ3QtPmk5MTUtPmRybS5z
dHJ1Y3RfbXV0ZXgpOworCQllcnIgPSBoYW5nX2luaXQoJmgsIGd0KTsKKwkJbXV0ZXhfdW5sb2Nr
KCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJCWlmIChlcnIpCiAJCQlyZXR1cm4gZXJy
OwogCX0KIAotCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKSB7CisJZm9yX2VhY2hf
ZW5naW5lKGVuZ2luZSwgZ3QtPmk5MTUsIGlkKSB7CiAJCXVuc2lnbmVkIGludCByZXNldF9jb3Vu
dCwgcmVzZXRfZW5naW5lX2NvdW50OwogCQlJR1RfVElNRU9VVChlbmRfdGltZSk7CiAKQEAgLTU4
NCwzMCArNTgzLDI5IEBAIHN0YXRpYyBpbnQgX19pZ3RfcmVzZXRfZW5naW5lKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LCBib29sIGFjdGl2ZSkKIAkJCWJyZWFrOwogCQl9CiAKLQkJcmVz
ZXRfY291bnQgPSBpOTE1X3Jlc2V0X2NvdW50KCZpOTE1LT5ncHVfZXJyb3IpOwotCQlyZXNldF9l
bmdpbmVfY291bnQgPSBpOTE1X3Jlc2V0X2VuZ2luZV9jb3VudCgmaTkxNS0+Z3B1X2Vycm9yLAot
CQkJCQkJCSAgICAgZW5naW5lKTsKKwkJcmVzZXRfY291bnQgPSBpOTE1X3Jlc2V0X2NvdW50KGds
b2JhbCk7CisJCXJlc2V0X2VuZ2luZV9jb3VudCA9IGk5MTVfcmVzZXRfZW5naW5lX2NvdW50KGds
b2JhbCwgZW5naW5lKTsKIAogCQlpbnRlbF9lbmdpbmVfcG1fZ2V0KGVuZ2luZSk7Ci0JCXNldF9i
aXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBpZCwgJmk5MTUtPmdwdV9lcnJvci5mbGFncyk7CisJCXNl
dF9iaXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBpZCwgJmd0LT5yZXNldC5mbGFncyk7CiAJCWRvIHsK
IAkJCWlmIChhY3RpdmUpIHsKIAkJCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKIAotCQkJCW11
dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCQkJCW11dGV4X2xvY2soJmd0LT5p
OTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAkJCQlycSA9IGhhbmdfY3JlYXRlX3JlcXVlc3QoJmgs
IGVuZ2luZSk7CiAJCQkJaWYgKElTX0VSUihycSkpIHsKIAkJCQkJZXJyID0gUFRSX0VSUihycSk7
Ci0JCQkJCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CisJCQkJCW11dGV4
X3VubG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCQkJCQlicmVhazsKIAkJCQl9
CiAKIAkJCQlpOTE1X3JlcXVlc3RfZ2V0KHJxKTsKIAkJCQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsK
LQkJCQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCQkJCW11dGV4X3Vu
bG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCiAJCQkJaWYgKCF3YWl0X3VudGls
X3J1bm5pbmcoJmgsIHJxKSkgewotCQkJCQlzdHJ1Y3QgZHJtX3ByaW50ZXIgcCA9IGRybV9pbmZv
X3ByaW50ZXIoaTkxNS0+ZHJtLmRldik7CisJCQkJCXN0cnVjdCBkcm1fcHJpbnRlciBwID0gZHJt
X2luZm9fcHJpbnRlcihndC0+aTkxNS0+ZHJtLmRldik7CiAKIAkJCQkJcHJfZXJyKCIlczogRmFp
bGVkIHRvIHN0YXJ0IHJlcXVlc3QgJWxseCwgYXQgJXhcbiIsCiAJCQkJCSAgICAgICBfX2Z1bmNf
XywgcnEtPmZlbmNlLnNlcW5vLCBod3Nfc2Vxbm8oJmgsIHJxKSk7CkBAIC02MjIsMTkgKzYyMCwx
OSBAQCBzdGF0aWMgaW50IF9faWd0X3Jlc2V0X2VuZ2luZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwgYm9vbCBhY3RpdmUpCiAJCQkJaTkxNV9yZXF1ZXN0X3B1dChycSk7CiAJCQl9CiAK
LQkJCWVyciA9IGk5MTVfcmVzZXRfZW5naW5lKGVuZ2luZSwgTlVMTCk7CisJCQllcnIgPSBpbnRl
bF9lbmdpbmVfcmVzZXQoZW5naW5lLCBOVUxMKTsKIAkJCWlmIChlcnIpIHsKIAkJCQlwcl9lcnIo
Imk5MTVfcmVzZXRfZW5naW5lIGZhaWxlZFxuIik7CiAJCQkJYnJlYWs7CiAJCQl9CiAKLQkJCWlm
IChpOTE1X3Jlc2V0X2NvdW50KCZpOTE1LT5ncHVfZXJyb3IpICE9IHJlc2V0X2NvdW50KSB7CisJ
CQlpZiAoaTkxNV9yZXNldF9jb3VudChnbG9iYWwpICE9IHJlc2V0X2NvdW50KSB7CiAJCQkJcHJf
ZXJyKCJGdWxsIEdQVSByZXNldCByZWNvcmRlZCEgKGVuZ2luZSByZXNldCBleHBlY3RlZClcbiIp
OwogCQkJCWVyciA9IC1FSU5WQUw7CiAJCQkJYnJlYWs7CiAJCQl9CiAKLQkJCWlmIChpOTE1X3Jl
c2V0X2VuZ2luZV9jb3VudCgmaTkxNS0+Z3B1X2Vycm9yLCBlbmdpbmUpICE9CisJCQlpZiAoaTkx
NV9yZXNldF9lbmdpbmVfY291bnQoZ2xvYmFsLCBlbmdpbmUpICE9CiAJCQkgICAgKytyZXNldF9l
bmdpbmVfY291bnQpIHsKIAkJCQlwcl9lcnIoIiVzIGVuZ2luZSByZXNldCBub3QgcmVjb3JkZWQh
XG4iLAogCQkJCSAgICAgICBlbmdpbmUtPm5hbWUpOwpAQCAtNjQyLDI0ICs2NDAsMjQgQEAgc3Rh
dGljIGludCBfX2lndF9yZXNldF9lbmdpbmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
IGJvb2wgYWN0aXZlKQogCQkJCWJyZWFrOwogCQkJfQogCQl9IHdoaWxlICh0aW1lX2JlZm9yZShq
aWZmaWVzLCBlbmRfdGltZSkpOwotCQljbGVhcl9iaXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBpZCwg
Jmk5MTUtPmdwdV9lcnJvci5mbGFncyk7CisJCWNsZWFyX2JpdChJOTE1X1JFU0VUX0VOR0lORSAr
IGlkLCAmZ3QtPnJlc2V0LmZsYWdzKTsKIAkJaW50ZWxfZW5naW5lX3BtX3B1dChlbmdpbmUpOwog
CiAJCWlmIChlcnIpCiAJCQlicmVhazsKIAotCQllcnIgPSBpZ3RfZmx1c2hfdGVzdChpOTE1LCAw
KTsKKwkJZXJyID0gaWd0X2ZsdXNoX3Rlc3QoZ3QtPmk5MTUsIDApOwogCQlpZiAoZXJyKQogCQkJ
YnJlYWs7CiAJfQogCi0JaWYgKGk5MTVfcmVzZXRfZmFpbGVkKGk5MTUpKQorCWlmIChpbnRlbF9n
dF9pc193ZWRnZWQoZ3QpKQogCQllcnIgPSAtRUlPOwogCiAJaWYgKGFjdGl2ZSkgewotCQltdXRl
eF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKKwkJbXV0ZXhfbG9jaygmZ3QtPmk5MTUt
PmRybS5zdHJ1Y3RfbXV0ZXgpOwogCQloYW5nX2ZpbmkoJmgpOwotCQltdXRleF91bmxvY2soJmk5
MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCQltdXRleF91bmxvY2soJmd0LT5pOTE1LT5kcm0uc3Ry
dWN0X211dGV4KTsKIAl9CiAKIAlyZXR1cm4gZXJyOwpAQCAtNzAxLDcgKzY5OSw3IEBAIHN0YXRp
YyBpbnQgYWN0aXZlX3JlcXVlc3RfcHV0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogCQkJICBy
cS0+ZmVuY2Uuc2Vxbm8pOwogCQlHRU1fVFJBQ0VfRFVNUCgpOwogCi0JCWk5MTVfZ2VtX3NldF93
ZWRnZWQocnEtPmk5MTUpOworCQlpbnRlbF9ndF9zZXRfd2VkZ2VkKHJxLT5lbmdpbmUtPmd0KTsK
IAkJZXJyID0gLUVJTzsKIAl9CiAKQEAgLTc3OCwxMCArNzc2LDExIEBAIHN0YXRpYyBpbnQgYWN0
aXZlX2VuZ2luZSh2b2lkICpkYXRhKQogCXJldHVybiBlcnI7CiB9CiAKLXN0YXRpYyBpbnQgX19p
Z3RfcmVzZXRfZW5naW5lcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKK3N0YXRpYyBp
bnQgX19pZ3RfcmVzZXRfZW5naW5lcyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAogCQkJICAgICAgIGNv
bnN0IGNoYXIgKnRlc3RfbmFtZSwKIAkJCSAgICAgICB1bnNpZ25lZCBpbnQgZmxhZ3MpCiB7CisJ
c3RydWN0IGk5MTVfZ3B1X2Vycm9yICpnbG9iYWwgPSAmZ3QtPmk5MTUtPmdwdV9lcnJvcjsKIAlz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsICpvdGhlcjsKIAllbnVtIGludGVsX2VuZ2lu
ZV9pZCBpZCwgdG1wOwogCXN0cnVjdCBoYW5nIGg7CkBAIC03OTEsMTMgKzc5MCwxMyBAQCBzdGF0
aWMgaW50IF9faWd0X3Jlc2V0X2VuZ2luZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
CiAJICogd2l0aCBhbnkgb3RoZXIgZW5naW5lLgogCSAqLwogCi0JaWYgKCFpbnRlbF9oYXNfcmVz
ZXRfZW5naW5lKGk5MTUpKQorCWlmICghaW50ZWxfaGFzX3Jlc2V0X2VuZ2luZShndC0+aTkxNSkp
CiAJCXJldHVybiAwOwogCiAJaWYgKGZsYWdzICYgVEVTVF9BQ1RJVkUpIHsKLQkJbXV0ZXhfbG9j
aygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0JCWVyciA9IGhhbmdfaW5pdCgmaCwgaTkxNSk7
Ci0JCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CisJCW11dGV4X2xvY2so
Jmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKKwkJZXJyID0gaGFuZ19pbml0KCZoLCBndCk7
CisJCW11dGV4X3VubG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCQlpZiAoZXJy
KQogCQkJcmV0dXJuIGVycjsKIApAQCAtODA1LDkgKzgwNCw5IEBAIHN0YXRpYyBpbnQgX19pZ3Rf
cmVzZXRfZW5naW5lcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJCWguY3R4LT5z
Y2hlZC5wcmlvcml0eSA9IDEwMjQ7CiAJfQogCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkx
NSwgaWQpIHsKKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndC0+aTkxNSwgaWQpIHsKIAkJc3Ry
dWN0IGFjdGl2ZV9lbmdpbmUgdGhyZWFkc1tJOTE1X05VTV9FTkdJTkVTXSA9IHt9OwotCQl1bnNp
Z25lZCBsb25nIGdsb2JhbCA9IGk5MTVfcmVzZXRfY291bnQoJmk5MTUtPmdwdV9lcnJvcik7CisJ
CXVuc2lnbmVkIGxvbmcgZGV2aWNlID0gaTkxNV9yZXNldF9jb3VudChnbG9iYWwpOwogCQl1bnNp
Z25lZCBsb25nIGNvdW50ID0gMCwgcmVwb3J0ZWQ7CiAJCUlHVF9USU1FT1VUKGVuZF90aW1lKTsK
IApAQCAtODIzLDEyICs4MjIsMTEgQEAgc3RhdGljIGludCBfX2lndF9yZXNldF9lbmdpbmVzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCQl9CiAKIAkJbWVtc2V0KHRocmVhZHMsIDAs
IHNpemVvZih0aHJlYWRzKSk7Ci0JCWZvcl9lYWNoX2VuZ2luZShvdGhlciwgaTkxNSwgdG1wKSB7
CisJCWZvcl9lYWNoX2VuZ2luZShvdGhlciwgZ3QtPmk5MTUsIHRtcCkgewogCQkJc3RydWN0IHRh
c2tfc3RydWN0ICp0c2s7CiAKIAkJCXRocmVhZHNbdG1wXS5yZXNldHMgPQotCQkJCWk5MTVfcmVz
ZXRfZW5naW5lX2NvdW50KCZpOTE1LT5ncHVfZXJyb3IsCi0JCQkJCQkJb3RoZXIpOworCQkJCWk5
MTVfcmVzZXRfZW5naW5lX2NvdW50KGdsb2JhbCwgb3RoZXIpOwogCiAJCQlpZiAoIShmbGFncyAm
IFRFU1RfT1RIRVJTKSkKIAkJCQljb250aW51ZTsKQEAgLTg1MSwyNSArODQ5LDI1IEBAIHN0YXRp
YyBpbnQgX19pZ3RfcmVzZXRfZW5naW5lcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
IAkJfQogCiAJCWludGVsX2VuZ2luZV9wbV9nZXQoZW5naW5lKTsKLQkJc2V0X2JpdChJOTE1X1JF
U0VUX0VOR0lORSArIGlkLCAmaTkxNS0+Z3B1X2Vycm9yLmZsYWdzKTsKKwkJc2V0X2JpdChJOTE1
X1JFU0VUX0VOR0lORSArIGlkLCAmZ3QtPnJlc2V0LmZsYWdzKTsKIAkJZG8gewogCQkJc3RydWN0
IGk5MTVfcmVxdWVzdCAqcnEgPSBOVUxMOwogCiAJCQlpZiAoZmxhZ3MgJiBURVNUX0FDVElWRSkg
ewotCQkJCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCQkJCW11dGV4X2xv
Y2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAkJCQlycSA9IGhhbmdfY3JlYXRlX3Jl
cXVlc3QoJmgsIGVuZ2luZSk7CiAJCQkJaWYgKElTX0VSUihycSkpIHsKIAkJCQkJZXJyID0gUFRS
X0VSUihycSk7Ci0JCQkJCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CisJ
CQkJCW11dGV4X3VubG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCQkJCQlicmVh
azsKIAkJCQl9CiAKIAkJCQlpOTE1X3JlcXVlc3RfZ2V0KHJxKTsKIAkJCQlpOTE1X3JlcXVlc3Rf
YWRkKHJxKTsKLQkJCQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCQkJ
CW11dGV4X3VubG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCiAJCQkJaWYgKCF3
YWl0X3VudGlsX3J1bm5pbmcoJmgsIHJxKSkgewotCQkJCQlzdHJ1Y3QgZHJtX3ByaW50ZXIgcCA9
IGRybV9pbmZvX3ByaW50ZXIoaTkxNS0+ZHJtLmRldik7CisJCQkJCXN0cnVjdCBkcm1fcHJpbnRl
ciBwID0gZHJtX2luZm9fcHJpbnRlcihndC0+aTkxNS0+ZHJtLmRldik7CiAKIAkJCQkJcHJfZXJy
KCIlczogRmFpbGVkIHRvIHN0YXJ0IHJlcXVlc3QgJWxseCwgYXQgJXhcbiIsCiAJCQkJCSAgICAg
ICBfX2Z1bmNfXywgcnEtPmZlbmNlLnNlcW5vLCBod3Nfc2Vxbm8oJmgsIHJxKSk7CkBAIC04ODIs
NyArODgwLDcgQEAgc3RhdGljIGludCBfX2lndF9yZXNldF9lbmdpbmVzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAogCQkJCX0KIAkJCX0KIAotCQkJZXJyID0gaTkxNV9yZXNldF9lbmdp
bmUoZW5naW5lLCBOVUxMKTsKKwkJCWVyciA9IGludGVsX2VuZ2luZV9yZXNldChlbmdpbmUsIE5V
TEwpOwogCQkJaWYgKGVycikgewogCQkJCXByX2VycigiaTkxNV9yZXNldF9lbmdpbmUoJXM6JXMp
OiBmYWlsZWQsIGVycj0lZFxuIiwKIAkJCQkgICAgICAgZW5naW5lLT5uYW1lLCB0ZXN0X25hbWUs
IGVycik7CkBAIC04OTQsNyArODkyLDcgQEAgc3RhdGljIGludCBfX2lndF9yZXNldF9lbmdpbmVz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCQkJaWYgKHJxKSB7CiAJCQkJaWYgKGk5
MTVfcmVxdWVzdF93YWl0KHJxLCAwLCBIWiAvIDUpIDwgMCkgewogCQkJCQlzdHJ1Y3QgZHJtX3By
aW50ZXIgcCA9Ci0JCQkJCQlkcm1faW5mb19wcmludGVyKGk5MTUtPmRybS5kZXYpOworCQkJCQkJ
ZHJtX2luZm9fcHJpbnRlcihndC0+aTkxNS0+ZHJtLmRldik7CiAKIAkJCQkJcHJfZXJyKCJpOTE1
X3Jlc2V0X2VuZ2luZSglczolcyk6IgogCQkJCQkgICAgICAgIiBmYWlsZWQgdG8gY29tcGxldGUg
cmVxdWVzdCBhZnRlciByZXNldFxuIiwKQEAgLTkwNCw3ICs5MDIsNyBAQCBzdGF0aWMgaW50IF9f
aWd0X3Jlc2V0X2VuZ2luZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCQkJCWk5
MTVfcmVxdWVzdF9wdXQocnEpOwogCiAJCQkJCUdFTV9UUkFDRV9EVU1QKCk7Ci0JCQkJCWk5MTVf
Z2VtX3NldF93ZWRnZWQoaTkxNSk7CisJCQkJCWludGVsX2d0X3NldF93ZWRnZWQoZ3QpOwogCQkJ
CQllcnIgPSAtRUlPOwogCQkJCQlicmVhazsKIAkJCQl9CkBAIC05MTQsNyArOTEyLDcgQEAgc3Rh
dGljIGludCBfX2lndF9yZXNldF9lbmdpbmVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAogCiAJCQlpZiAoIShmbGFncyAmIFRFU1RfU0VMRikgJiYgIXdhaXRfZm9yX2lkbGUoZW5naW5l
KSkgewogCQkJCXN0cnVjdCBkcm1fcHJpbnRlciBwID0KLQkJCQkJZHJtX2luZm9fcHJpbnRlcihp
OTE1LT5kcm0uZGV2KTsKKwkJCQkJZHJtX2luZm9fcHJpbnRlcihndC0+aTkxNS0+ZHJtLmRldik7
CiAKIAkJCQlwcl9lcnIoImk5MTVfcmVzZXRfZW5naW5lKCVzOiVzKToiCiAJCQkJICAgICAgICIg
ZmFpbGVkIHRvIGlkbGUgYWZ0ZXIgcmVzZXRcbiIsCkBAIC05MjYsMTIgKzkyNCwxMiBAQCBzdGF0
aWMgaW50IF9faWd0X3Jlc2V0X2VuZ2luZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
CiAJCQkJYnJlYWs7CiAJCQl9CiAJCX0gd2hpbGUgKHRpbWVfYmVmb3JlKGppZmZpZXMsIGVuZF90
aW1lKSk7Ci0JCWNsZWFyX2JpdChJOTE1X1JFU0VUX0VOR0lORSArIGlkLCAmaTkxNS0+Z3B1X2Vy
cm9yLmZsYWdzKTsKKwkJY2xlYXJfYml0KEk5MTVfUkVTRVRfRU5HSU5FICsgaWQsICZndC0+cmVz
ZXQuZmxhZ3MpOwogCQlpbnRlbF9lbmdpbmVfcG1fcHV0KGVuZ2luZSk7CiAJCXByX2luZm8oImk5
MTVfcmVzZXRfZW5naW5lKCVzOiVzKTogJWx1IHJlc2V0c1xuIiwKIAkJCWVuZ2luZS0+bmFtZSwg
dGVzdF9uYW1lLCBjb3VudCk7CiAKLQkJcmVwb3J0ZWQgPSBpOTE1X3Jlc2V0X2VuZ2luZV9jb3Vu
dCgmaTkxNS0+Z3B1X2Vycm9yLCBlbmdpbmUpOworCQlyZXBvcnRlZCA9IGk5MTVfcmVzZXRfZW5n
aW5lX2NvdW50KGdsb2JhbCwgZW5naW5lKTsKIAkJcmVwb3J0ZWQgLT0gdGhyZWFkc1tlbmdpbmUt
PmlkXS5yZXNldHM7CiAJCWlmIChyZXBvcnRlZCAhPSBjb3VudCkgewogCQkJcHJfZXJyKCJpOTE1
X3Jlc2V0X2VuZ2luZSglczolcyk6IHJlc2V0ICVsdSB0aW1lcywgYnV0IHJlcG9ydGVkICVsdVxu
IiwKQEAgLTk0MSw3ICs5MzksNyBAQCBzdGF0aWMgaW50IF9faWd0X3Jlc2V0X2VuZ2luZXMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCX0KIAogdW53aW5kOgotCQlmb3JfZWFjaF9l
bmdpbmUob3RoZXIsIGk5MTUsIHRtcCkgeworCQlmb3JfZWFjaF9lbmdpbmUob3RoZXIsIGd0LT5p
OTE1LCB0bXApIHsKIAkJCWludCByZXQ7CiAKIAkJCWlmICghdGhyZWFkc1t0bXBdLnRhc2spCkBA
IC05NTYsMjIgKzk1NCwyMSBAQCBzdGF0aWMgaW50IF9faWd0X3Jlc2V0X2VuZ2luZXMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCQl9CiAJCQlwdXRfdGFza19zdHJ1Y3QodGhyZWFk
c1t0bXBdLnRhc2spOwogCi0JCQlpZiAob3RoZXIgIT0gZW5naW5lICYmCisJCQlpZiAob3RoZXIt
PnVhYmlfY2xhc3MgIT0gZW5naW5lLT51YWJpX2NsYXNzICYmCiAJCQkgICAgdGhyZWFkc1t0bXBd
LnJlc2V0cyAhPQotCQkJICAgIGk5MTVfcmVzZXRfZW5naW5lX2NvdW50KCZpOTE1LT5ncHVfZXJy
b3IsIG90aGVyKSkgeworCQkJICAgIGk5MTVfcmVzZXRfZW5naW5lX2NvdW50KGdsb2JhbCwgb3Ro
ZXIpKSB7CiAJCQkJcHJfZXJyKCJJbm5vY2VudCBlbmdpbmUgJXMgd2FzIHJlc2V0IChjb3VudD0l
bGQpXG4iLAogCQkJCSAgICAgICBvdGhlci0+bmFtZSwKLQkJCQkgICAgICAgaTkxNV9yZXNldF9l
bmdpbmVfY291bnQoJmk5MTUtPmdwdV9lcnJvciwKLQkJCQkJCQkgICAgICAgb3RoZXIpIC0KKwkJ
CQkgICAgICAgaTkxNV9yZXNldF9lbmdpbmVfY291bnQoZ2xvYmFsLCBvdGhlcikgLQogCQkJCSAg
ICAgICB0aHJlYWRzW3RtcF0ucmVzZXRzKTsKIAkJCQlpZiAoIWVycikKIAkJCQkJZXJyID0gLUVJ
TlZBTDsKIAkJCX0KIAkJfQogCi0JCWlmIChnbG9iYWwgIT0gaTkxNV9yZXNldF9jb3VudCgmaTkx
NS0+Z3B1X2Vycm9yKSkgeworCQlpZiAoZGV2aWNlICE9IGk5MTVfcmVzZXRfY291bnQoZ2xvYmFs
KSkgewogCQkJcHJfZXJyKCJHbG9iYWwgcmVzZXQgKGNvdW50PSVsZCkhXG4iLAotCQkJICAgICAg
IGk5MTVfcmVzZXRfY291bnQoJmk5MTUtPmdwdV9lcnJvcikgLSBnbG9iYWwpOworCQkJICAgICAg
IGk5MTVfcmVzZXRfY291bnQoZ2xvYmFsKSAtIGRldmljZSk7CiAJCQlpZiAoIWVycikKIAkJCQll
cnIgPSAtRUlOVkFMOwogCQl9CkBAIC05NzksMjAgKzk3NiwyMCBAQCBzdGF0aWMgaW50IF9faWd0
X3Jlc2V0X2VuZ2luZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCWlmIChlcnIp
CiAJCQlicmVhazsKIAotCQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQkJ
ZXJyID0gaWd0X2ZsdXNoX3Rlc3QoaTkxNSwgSTkxNV9XQUlUX0xPQ0tFRCk7Ci0JCW11dGV4X3Vu
bG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CisJCW11dGV4X2xvY2soJmd0LT5pOTE1LT5k
cm0uc3RydWN0X211dGV4KTsKKwkJZXJyID0gaWd0X2ZsdXNoX3Rlc3QoZ3QtPmk5MTUsIEk5MTVf
V0FJVF9MT0NLRUQpOworCQltdXRleF91bmxvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4
KTsKIAkJaWYgKGVycikKIAkJCWJyZWFrOwogCX0KIAotCWlmIChpOTE1X3Jlc2V0X2ZhaWxlZChp
OTE1KSkKKwlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKGd0KSkKIAkJZXJyID0gLUVJTzsKIAogCWlm
IChmbGFncyAmIFRFU1RfQUNUSVZFKSB7Ci0JCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3Rf
bXV0ZXgpOworCQltdXRleF9sb2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJCWhh
bmdfZmluaSgmaCk7Ci0JCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CisJ
CW11dGV4X3VubG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCX0KIAogCXJldHVy
biBlcnI7CkBAIC0xMDE4LDEzICsxMDE1LDEzIEBAIHN0YXRpYyBpbnQgaWd0X3Jlc2V0X2VuZ2lu
ZXModm9pZCAqYXJnKQogCQl9LAogCQl7IH0KIAl9OwotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gYXJnOworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7CiAJdHlwZW9mKCpwaGFz
ZXMpICpwOwogCWludCBlcnI7CiAKIAlmb3IgKHAgPSBwaGFzZXM7IHAtPm5hbWU7IHArKykgewog
CQlpZiAocC0+ZmxhZ3MgJiBURVNUX1BSSU9SSVRZKSB7Ci0JCQlpZiAoIShpOTE1LT5jYXBzLnNj
aGVkdWxlciAmIEk5MTVfU0NIRURVTEVSX0NBUF9QUklPUklUWSkpCisJCQlpZiAoIShndC0+aTkx
NS0+Y2Fwcy5zY2hlZHVsZXIgJiBJOTE1X1NDSEVEVUxFUl9DQVBfUFJJT1JJVFkpKQogCQkJCWNv
bnRpbnVlOwogCQl9CiAKQEAgLTEwMzYsMzggKzEwMzMsMzkgQEAgc3RhdGljIGludCBpZ3RfcmVz
ZXRfZW5naW5lcyh2b2lkICphcmcpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyB1MzIgZmFrZV9o
YW5nY2hlY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCi0JCQkgIGludGVsX2VuZ2lu
ZV9tYXNrX3QgbWFzaykKK3N0YXRpYyB1MzIgZmFrZV9oYW5nY2hlY2soc3RydWN0IGludGVsX2d0
ICpndCwgaW50ZWxfZW5naW5lX21hc2tfdCBtYXNrKQogewotCXUzMiBjb3VudCA9IGk5MTVfcmVz
ZXRfY291bnQoJmk5MTUtPmdwdV9lcnJvcik7CisJdTMyIGNvdW50ID0gaTkxNV9yZXNldF9jb3Vu
dCgmZ3QtPmk5MTUtPmdwdV9lcnJvcik7CiAKLQlpOTE1X3Jlc2V0KGk5MTUsIG1hc2ssIE5VTEwp
OworCWludGVsX2d0X3Jlc2V0KGd0LCBtYXNrLCBOVUxMKTsKIAogCXJldHVybiBjb3VudDsKIH0K
IAogc3RhdGljIGludCBpZ3RfcmVzZXRfd2FpdCh2b2lkICphcmcpCiB7Ci0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSBhcmc7CisJc3RydWN0IGludGVsX2d0ICpndCA9IGFyZzsKKwlz
dHJ1Y3QgaTkxNV9ncHVfZXJyb3IgKmdsb2JhbCA9ICZndC0+aTkxNS0+Z3B1X2Vycm9yOworCXN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSA9IGd0LT5pOTE1LT5lbmdpbmVbUkNTMF07CiAJ
c3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7CiAJdW5zaWduZWQgaW50IHJlc2V0X2NvdW50OwogCXN0
cnVjdCBoYW5nIGg7CiAJbG9uZyB0aW1lb3V0OwogCWludCBlcnI7CiAKLQlpZiAoIWludGVsX2Vu
Z2luZV9jYW5fc3RvcmVfZHdvcmQoaTkxNS0+ZW5naW5lW1JDUzBdKSkKKwlpZiAoIWVuZ2luZSB8
fCAhaW50ZWxfZW5naW5lX2Nhbl9zdG9yZV9kd29yZChlbmdpbmUpKQogCQlyZXR1cm4gMDsKIAog
CS8qIENoZWNrIHRoYXQgd2UgZGV0ZWN0IGEgc3R1Y2sgd2FpdGVyIGFuZCBpc3N1ZSBhIHJlc2V0
ICovCiAKLQlpZ3RfZ2xvYmFsX3Jlc2V0X2xvY2soaTkxNSk7CisJaWd0X2dsb2JhbF9yZXNldF9s
b2NrKGd0KTsKIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCWVyciA9
IGhhbmdfaW5pdCgmaCwgaTkxNSk7CisJbXV0ZXhfbG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3Rf
bXV0ZXgpOworCWVyciA9IGhhbmdfaW5pdCgmaCwgZ3QpOwogCWlmIChlcnIpCiAJCWdvdG8gdW5s
b2NrOwogCi0JcnEgPSBoYW5nX2NyZWF0ZV9yZXF1ZXN0KCZoLCBpOTE1LT5lbmdpbmVbUkNTMF0p
OworCXJxID0gaGFuZ19jcmVhdGVfcmVxdWVzdCgmaCwgZW5naW5lKTsKIAlpZiAoSVNfRVJSKHJx
KSkgewogCQllcnIgPSBQVFJfRVJSKHJxKTsKIAkJZ290byBmaW5pOwpAQCAtMTA3NywxOSArMTA3
NSwxOSBAQCBzdGF0aWMgaW50IGlndF9yZXNldF93YWl0KHZvaWQgKmFyZykKIAlpOTE1X3JlcXVl
c3RfYWRkKHJxKTsKIAogCWlmICghd2FpdF91bnRpbF9ydW5uaW5nKCZoLCBycSkpIHsKLQkJc3Ry
dWN0IGRybV9wcmludGVyIHAgPSBkcm1faW5mb19wcmludGVyKGk5MTUtPmRybS5kZXYpOworCQlz
dHJ1Y3QgZHJtX3ByaW50ZXIgcCA9IGRybV9pbmZvX3ByaW50ZXIoZ3QtPmk5MTUtPmRybS5kZXYp
OwogCiAJCXByX2VycigiJXM6IEZhaWxlZCB0byBzdGFydCByZXF1ZXN0ICVsbHgsIGF0ICV4XG4i
LAogCQkgICAgICAgX19mdW5jX18sIHJxLT5mZW5jZS5zZXFubywgaHdzX3NlcW5vKCZoLCBycSkp
OwogCQlpbnRlbF9lbmdpbmVfZHVtcChycS0+ZW5naW5lLCAmcCwgIiVzXG4iLCBycS0+ZW5naW5l
LT5uYW1lKTsKIAotCQlpOTE1X2dlbV9zZXRfd2VkZ2VkKGk5MTUpOworCQlpbnRlbF9ndF9zZXRf
d2VkZ2VkKGd0KTsKIAogCQllcnIgPSAtRUlPOwogCQlnb3RvIG91dF9ycTsKIAl9CiAKLQlyZXNl
dF9jb3VudCA9IGZha2VfaGFuZ2NoZWNrKGk5MTUsIEFMTF9FTkdJTkVTKTsKKwlyZXNldF9jb3Vu
dCA9IGZha2VfaGFuZ2NoZWNrKGd0LCBBTExfRU5HSU5FUyk7CiAKIAl0aW1lb3V0ID0gaTkxNV9y
ZXF1ZXN0X3dhaXQocnEsIDAsIDEwKTsKIAlpZiAodGltZW91dCA8IDApIHsKQEAgLTEwOTksNyAr
MTA5Nyw3IEBAIHN0YXRpYyBpbnQgaWd0X3Jlc2V0X3dhaXQodm9pZCAqYXJnKQogCQlnb3RvIG91
dF9ycTsKIAl9CiAKLQlpZiAoaTkxNV9yZXNldF9jb3VudCgmaTkxNS0+Z3B1X2Vycm9yKSA9PSBy
ZXNldF9jb3VudCkgeworCWlmIChpOTE1X3Jlc2V0X2NvdW50KGdsb2JhbCkgPT0gcmVzZXRfY291
bnQpIHsKIAkJcHJfZXJyKCJObyBHUFUgcmVzZXQgcmVjb3JkZWQhXG4iKTsKIAkJZXJyID0gLUVJ
TlZBTDsKIAkJZ290byBvdXRfcnE7CkBAIC0xMTEwLDEwICsxMTA4LDEwIEBAIHN0YXRpYyBpbnQg
aWd0X3Jlc2V0X3dhaXQodm9pZCAqYXJnKQogZmluaToKIAloYW5nX2ZpbmkoJmgpOwogdW5sb2Nr
OgotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0JaWd0X2dsb2JhbF9y
ZXNldF91bmxvY2soaTkxNSk7CisJbXV0ZXhfdW5sb2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9t
dXRleCk7CisJaWd0X2dsb2JhbF9yZXNldF91bmxvY2soZ3QpOwogCi0JaWYgKGk5MTVfcmVzZXRf
ZmFpbGVkKGk5MTUpKQorCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoZ3QpKQogCQlyZXR1cm4gLUVJ
TzsKIAogCXJldHVybiBlcnI7CkBAIC0xMTcyLDExICsxMTcwLDEyIEBAIHN0YXRpYyBpbnQgZXZp
Y3RfZmVuY2Uodm9pZCAqZGF0YSkKIAlyZXR1cm4gZXJyOwogfQogCi1zdGF0aWMgaW50IF9faWd0
X3Jlc2V0X2V2aWN0X3ZtYShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKK3N0YXRpYyBp
bnQgX19pZ3RfcmVzZXRfZXZpY3Rfdm1hKHN0cnVjdCBpbnRlbF9ndCAqZ3QsCiAJCQkJIHN0cnVj
dCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtLAogCQkJCSBpbnQgKCpmbikodm9pZCAqKSwKIAkJCQkg
dW5zaWduZWQgaW50IGZsYWdzKQogeworCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSA9
IGd0LT5pOTE1LT5lbmdpbmVbUkNTMF07CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
ajsKIAlzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzayA9IE5VTEw7CiAJc3RydWN0IGk5MTVfcmVxdWVz
dCAqcnE7CkBAIC0xMTg0LDE3ICsxMTgzLDE3IEBAIHN0YXRpYyBpbnQgX19pZ3RfcmVzZXRfZXZp
Y3Rfdm1hKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCXN0cnVjdCBoYW5nIGg7CiAJ
aW50IGVycjsKIAotCWlmICghaW50ZWxfZW5naW5lX2Nhbl9zdG9yZV9kd29yZChpOTE1LT5lbmdp
bmVbUkNTMF0pKQorCWlmICghZW5naW5lIHx8ICFpbnRlbF9lbmdpbmVfY2FuX3N0b3JlX2R3b3Jk
KGVuZ2luZSkpCiAJCXJldHVybiAwOwogCiAJLyogQ2hlY2sgdGhhdCB3ZSBjYW4gcmVjb3ZlciBh
biB1bmJpbmQgc3R1Y2sgb24gYSBoYW5naW5nIHJlcXVlc3QgKi8KIAotCW11dGV4X2xvY2soJmk5
MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCWVyciA9IGhhbmdfaW5pdCgmaCwgaTkxNSk7CisJbXV0
ZXhfbG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCWVyciA9IGhhbmdfaW5pdCgm
aCwgZ3QpOwogCWlmIChlcnIpCiAJCWdvdG8gdW5sb2NrOwogCi0Jb2JqID0gaTkxNV9nZW1fb2Jq
ZWN0X2NyZWF0ZV9pbnRlcm5hbChpOTE1LCBTWl8xTSk7CisJb2JqID0gaTkxNV9nZW1fb2JqZWN0
X2NyZWF0ZV9pbnRlcm5hbChndC0+aTkxNSwgU1pfMU0pOwogCWlmIChJU19FUlIob2JqKSkgewog
CQllcnIgPSBQVFJfRVJSKG9iaik7CiAJCWdvdG8gZmluaTsKQEAgLTEyMTQsNyArMTIxMyw3IEBA
IHN0YXRpYyBpbnQgX19pZ3RfcmVzZXRfZXZpY3Rfdm1hKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAogCQlnb3RvIG91dF9vYmo7CiAJfQogCi0JcnEgPSBoYW5nX2NyZWF0ZV9yZXF1ZXN0
KCZoLCBpOTE1LT5lbmdpbmVbUkNTMF0pOworCXJxID0gaGFuZ19jcmVhdGVfcmVxdWVzdCgmaCwg
ZW5naW5lKTsKIAlpZiAoSVNfRVJSKHJxKSkgewogCQllcnIgPSBQVFJfRVJSKHJxKTsKIAkJZ290
byBvdXRfb2JqOwpAQCAtMTI1MiwxNiArMTI1MSwxNiBAQCBzdGF0aWMgaW50IF9faWd0X3Jlc2V0
X2V2aWN0X3ZtYShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAlpZiAoZXJyKQogCQln
b3RvIG91dF9ycTsKIAotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CisJ
bXV0ZXhfdW5sb2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAKIAlpZiAoIXdhaXRf
dW50aWxfcnVubmluZygmaCwgcnEpKSB7Ci0JCXN0cnVjdCBkcm1fcHJpbnRlciBwID0gZHJtX2lu
Zm9fcHJpbnRlcihpOTE1LT5kcm0uZGV2KTsKKwkJc3RydWN0IGRybV9wcmludGVyIHAgPSBkcm1f
aW5mb19wcmludGVyKGd0LT5pOTE1LT5kcm0uZGV2KTsKIAogCQlwcl9lcnIoIiVzOiBGYWlsZWQg
dG8gc3RhcnQgcmVxdWVzdCAlbGx4LCBhdCAleFxuIiwKIAkJICAgICAgIF9fZnVuY19fLCBycS0+
ZmVuY2Uuc2Vxbm8sIGh3c19zZXFubygmaCwgcnEpKTsKIAkJaW50ZWxfZW5naW5lX2R1bXAocnEt
PmVuZ2luZSwgJnAsICIlc1xuIiwgcnEtPmVuZ2luZS0+bmFtZSk7CiAKLQkJaTkxNV9nZW1fc2V0
X3dlZGdlZChpOTE1KTsKKwkJaW50ZWxfZ3Rfc2V0X3dlZGdlZChndCk7CiAJCWdvdG8gb3V0X3Jl
c2V0OwogCX0KIApAQCAtMTI3OCwzMSArMTI3NywzMSBAQCBzdGF0aWMgaW50IF9faWd0X3Jlc2V0
X2V2aWN0X3ZtYShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAl3YWl0X2Zvcl9jb21w
bGV0aW9uKCZhcmcuY29tcGxldGlvbik7CiAKIAlpZiAod2FpdF9mb3IoIWxpc3RfZW1wdHkoJnJx
LT5mZW5jZS5jYl9saXN0KSwgMTApKSB7Ci0JCXN0cnVjdCBkcm1fcHJpbnRlciBwID0gZHJtX2lu
Zm9fcHJpbnRlcihpOTE1LT5kcm0uZGV2KTsKKwkJc3RydWN0IGRybV9wcmludGVyIHAgPSBkcm1f
aW5mb19wcmludGVyKGd0LT5pOTE1LT5kcm0uZGV2KTsKIAogCQlwcl9lcnIoImlndC9ldmljdF92
bWEga3RocmVhZCBkaWQgbm90IHdhaXRcbiIpOwogCQlpbnRlbF9lbmdpbmVfZHVtcChycS0+ZW5n
aW5lLCAmcCwgIiVzXG4iLCBycS0+ZW5naW5lLT5uYW1lKTsKIAotCQlpOTE1X2dlbV9zZXRfd2Vk
Z2VkKGk5MTUpOworCQlpbnRlbF9ndF9zZXRfd2VkZ2VkKGd0KTsKIAkJZ290byBvdXRfcmVzZXQ7
CiAJfQogCiBvdXRfcmVzZXQ6Ci0JaWd0X2dsb2JhbF9yZXNldF9sb2NrKGk5MTUpOwotCWZha2Vf
aGFuZ2NoZWNrKHJxLT5pOTE1LCBycS0+ZW5naW5lLT5tYXNrKTsKLQlpZ3RfZ2xvYmFsX3Jlc2V0
X3VubG9jayhpOTE1KTsKKwlpZ3RfZ2xvYmFsX3Jlc2V0X2xvY2soZ3QpOworCWZha2VfaGFuZ2No
ZWNrKGd0LCBycS0+ZW5naW5lLT5tYXNrKTsKKwlpZ3RfZ2xvYmFsX3Jlc2V0X3VubG9jayhndCk7
CiAKIAlpZiAodHNrKSB7Ci0JCXN0cnVjdCBpZ3Rfd2VkZ2VfbWUgdzsKKwkJc3RydWN0IGludGVs
X3dlZGdlX21lIHc7CiAKIAkJLyogVGhlIHJlc2V0LCBldmVuIGluZGlyZWN0bHksIHNob3VsZCB0
YWtlIGxlc3MgdGhhbiAxMG1zLiAqLwotCQlpZ3Rfd2VkZ2Vfb25fdGltZW91dCgmdywgaTkxNSwg
SFogLyAxMCAvKiAxMDBtcyB0aW1lb3V0Ki8pCisJCWludGVsX3dlZGdlX29uX3RpbWVvdXQoJncs
IGd0LCBIWiAvIDEwIC8qIDEwMG1zICovKQogCQkJZXJyID0ga3RocmVhZF9zdG9wKHRzayk7CiAK
IAkJcHV0X3Rhc2tfc3RydWN0KHRzayk7CiAJfQogCi0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0
cnVjdF9tdXRleCk7CisJbXV0ZXhfbG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwog
b3V0X3JxOgogCWk5MTVfcmVxdWVzdF9wdXQocnEpOwogb3V0X29iajoKQEAgLTEzMTAsOSArMTMw
OSw5IEBAIHN0YXRpYyBpbnQgX19pZ3RfcmVzZXRfZXZpY3Rfdm1hKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAogZmluaToKIAloYW5nX2ZpbmkoJmgpOwogdW5sb2NrOgotCW11dGV4X3Vu
bG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CisJbXV0ZXhfdW5sb2NrKCZndC0+aTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7CiAKLQlpZiAoaTkxNV9yZXNldF9mYWlsZWQoaTkxNSkpCisJaWYg
KGludGVsX2d0X2lzX3dlZGdlZChndCkpCiAJCXJldHVybiAtRUlPOwogCiAJcmV0dXJuIGVycjsK
QEAgLTEzMjAsMjYgKzEzMTksMjYgQEAgc3RhdGljIGludCBfX2lndF9yZXNldF9ldmljdF92bWEo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAKIHN0YXRpYyBpbnQgaWd0X3Jlc2V0X2V2
aWN0X2dndHQodm9pZCAqYXJnKQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
YXJnOworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7CiAKLQlyZXR1cm4gX19pZ3RfcmVzZXRf
ZXZpY3Rfdm1hKGk5MTUsICZpOTE1LT5nZ3R0LnZtLAorCXJldHVybiBfX2lndF9yZXNldF9ldmlj
dF92bWEoZ3QsICZndC0+Z2d0dC0+dm0sCiAJCQkJICAgICBldmljdF92bWEsIEVYRUNfT0JKRUNU
X1dSSVRFKTsKIH0KIAogc3RhdGljIGludCBpZ3RfcmVzZXRfZXZpY3RfcHBndHQodm9pZCAqYXJn
KQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYXJnOworCXN0cnVjdCBpbnRl
bF9ndCAqZ3QgPSBhcmc7CiAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eDsKIAlzdHJ1Y3Qg
ZHJtX2ZpbGUgKmZpbGU7CiAJaW50IGVycjsKIAotCWZpbGUgPSBtb2NrX2ZpbGUoaTkxNSk7CisJ
ZmlsZSA9IG1vY2tfZmlsZShndC0+aTkxNSk7CiAJaWYgKElTX0VSUihmaWxlKSkKIAkJcmV0dXJu
IFBUUl9FUlIoZmlsZSk7CiAKLQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsK
LQljdHggPSBsaXZlX2NvbnRleHQoaTkxNSwgZmlsZSk7Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5k
cm0uc3RydWN0X211dGV4KTsKKwltdXRleF9sb2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRl
eCk7CisJY3R4ID0gbGl2ZV9jb250ZXh0KGd0LT5pOTE1LCBmaWxlKTsKKwltdXRleF91bmxvY2so
Jmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlpZiAoSVNfRVJSKGN0eCkpIHsKIAkJZXJy
ID0gUFRSX0VSUihjdHgpOwogCQlnb3RvIG91dDsKQEAgLTEzNDcsMjkgKzEzNDYsMjkgQEAgc3Rh
dGljIGludCBpZ3RfcmVzZXRfZXZpY3RfcHBndHQodm9pZCAqYXJnKQogCiAJZXJyID0gMDsKIAlp
ZiAoY3R4LT52bSkgLyogYWxpYXNpbmcgPT0gZ2xvYmFsIGd0dCBsb2NraW5nLCBjb3ZlcmVkIGFi
b3ZlICovCi0JCWVyciA9IF9faWd0X3Jlc2V0X2V2aWN0X3ZtYShpOTE1LCBjdHgtPnZtLAorCQll
cnIgPSBfX2lndF9yZXNldF9ldmljdF92bWEoZ3QsIGN0eC0+dm0sCiAJCQkJCSAgICBldmljdF92
bWEsIEVYRUNfT0JKRUNUX1dSSVRFKTsKIAogb3V0OgotCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZp
bGUpOworCW1vY2tfZmlsZV9mcmVlKGd0LT5pOTE1LCBmaWxlKTsKIAlyZXR1cm4gZXJyOwogfQog
CiBzdGF0aWMgaW50IGlndF9yZXNldF9ldmljdF9mZW5jZSh2b2lkICphcmcpCiB7Ci0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBhcmc7CisJc3RydWN0IGludGVsX2d0ICpndCA9IGFy
ZzsKIAotCXJldHVybiBfX2lndF9yZXNldF9ldmljdF92bWEoaTkxNSwgJmk5MTUtPmdndHQudm0s
CisJcmV0dXJuIF9faWd0X3Jlc2V0X2V2aWN0X3ZtYShndCwgJmd0LT5nZ3R0LT52bSwKIAkJCQkg
ICAgIGV2aWN0X2ZlbmNlLCBFWEVDX09CSkVDVF9ORUVEU19GRU5DRSk7CiB9CiAKLXN0YXRpYyBp
bnQgd2FpdF9mb3Jfb3RoZXJzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAorc3RhdGlj
IGludCB3YWl0X2Zvcl9vdGhlcnMoc3RydWN0IGludGVsX2d0ICpndCwKIAkJCSAgIHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmV4Y2x1ZGUpCiB7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lOwogCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwogCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2lu
ZSwgaTkxNSwgaWQpIHsKKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndC0+aTkxNSwgaWQpIHsK
IAkJaWYgKGVuZ2luZSA9PSBleGNsdWRlKQogCQkJY29udGludWU7CiAKQEAgLTEzODIsNyArMTM4
MSw4IEBAIHN0YXRpYyBpbnQgd2FpdF9mb3Jfb3RoZXJzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAogCiBzdGF0aWMgaW50IGlndF9yZXNldF9xdWV1ZSh2b2lkICphcmcpCiB7Ci0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBhcmc7CisJc3RydWN0IGludGVsX2d0ICpndCA9
IGFyZzsKKwlzdHJ1Y3QgaTkxNV9ncHVfZXJyb3IgKmdsb2JhbCA9ICZndC0+aTkxNS0+Z3B1X2Vy
cm9yOwogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKIAllbnVtIGludGVsX2VuZ2lu
ZV9pZCBpZDsKIAlzdHJ1Y3QgaGFuZyBoOwpAQCAtMTM5MCwxNCArMTM5MCwxNCBAQCBzdGF0aWMg
aW50IGlndF9yZXNldF9xdWV1ZSh2b2lkICphcmcpCiAKIAkvKiBDaGVjayB0aGF0IHdlIHJlcGxh
eSBwZW5kaW5nIHJlcXVlc3RzIGZvbGxvd2luZyBhIGhhbmcgKi8KIAotCWlndF9nbG9iYWxfcmVz
ZXRfbG9jayhpOTE1KTsKKwlpZ3RfZ2xvYmFsX3Jlc2V0X2xvY2soZ3QpOwogCi0JbXV0ZXhfbG9j
aygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0JZXJyID0gaGFuZ19pbml0KCZoLCBpOTE1KTsK
KwltdXRleF9sb2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CisJZXJyID0gaGFuZ19p
bml0KCZoLCBndCk7CiAJaWYgKGVycikKIAkJZ290byB1bmxvY2s7CiAKLQlmb3JfZWFjaF9lbmdp
bmUoZW5naW5lLCBpOTE1LCBpZCkgeworCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LT5pOTE1
LCBpZCkgewogCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpwcmV2OwogCQlJR1RfVElNRU9VVChlbmRf
dGltZSk7CiAJCXVuc2lnbmVkIGludCBjb3VudDsKQEAgLTE0MzgsNyArMTQzOCw3IEBAIHN0YXRp
YyBpbnQgaWd0X3Jlc2V0X3F1ZXVlKHZvaWQgKmFyZykKIAkJCSAqIChoYW5nY2hlY2spLCBvciB3
ZSBmb2N1cyBvbiByZXNldHRpbmcganVzdCBvbmUKIAkJCSAqIGVuZ2luZSBhbmQgc28gYXZvaWQg
cmVwZWF0ZWRseSByZXNldHRpbmcgaW5ub2NlbnRzLgogCQkJICovCi0JCQllcnIgPSB3YWl0X2Zv
cl9vdGhlcnMoaTkxNSwgZW5naW5lKTsKKwkJCWVyciA9IHdhaXRfZm9yX290aGVycyhndCwgZW5n
aW5lKTsKIAkJCWlmIChlcnIpIHsKIAkJCQlwcl9lcnIoIiVzKCVzKTogRmFpbGVkIHRvIGlkbGUg
b3RoZXIgaW5hY3RpdmUgZW5naW5lcyBhZnRlciBkZXZpY2UgcmVzZXRcbiIsCiAJCQkJICAgICAg
IF9fZnVuY19fLCBlbmdpbmUtPm5hbWUpOwpAQCAtMTQ0NiwxMiArMTQ0NiwxMiBAQCBzdGF0aWMg
aW50IGlndF9yZXNldF9xdWV1ZSh2b2lkICphcmcpCiAJCQkJaTkxNV9yZXF1ZXN0X3B1dChwcmV2
KTsKIAogCQkJCUdFTV9UUkFDRV9EVU1QKCk7Ci0JCQkJaTkxNV9nZW1fc2V0X3dlZGdlZChpOTE1
KTsKKwkJCQlpbnRlbF9ndF9zZXRfd2VkZ2VkKGd0KTsKIAkJCQlnb3RvIGZpbmk7CiAJCQl9CiAK
IAkJCWlmICghd2FpdF91bnRpbF9ydW5uaW5nKCZoLCBwcmV2KSkgewotCQkJCXN0cnVjdCBkcm1f
cHJpbnRlciBwID0gZHJtX2luZm9fcHJpbnRlcihpOTE1LT5kcm0uZGV2KTsKKwkJCQlzdHJ1Y3Qg
ZHJtX3ByaW50ZXIgcCA9IGRybV9pbmZvX3ByaW50ZXIoZ3QtPmk5MTUtPmRybS5kZXYpOwogCiAJ
CQkJcHJfZXJyKCIlcyglcyk6IEZhaWxlZCB0byBzdGFydCByZXF1ZXN0ICVsbHgsIGF0ICV4XG4i
LAogCQkJCSAgICAgICBfX2Z1bmNfXywgZW5naW5lLT5uYW1lLApAQCAtMTQ2MiwxMyArMTQ2Miwx
MyBAQCBzdGF0aWMgaW50IGlndF9yZXNldF9xdWV1ZSh2b2lkICphcmcpCiAJCQkJaTkxNV9yZXF1
ZXN0X3B1dChycSk7CiAJCQkJaTkxNV9yZXF1ZXN0X3B1dChwcmV2KTsKIAotCQkJCWk5MTVfZ2Vt
X3NldF93ZWRnZWQoaTkxNSk7CisJCQkJaW50ZWxfZ3Rfc2V0X3dlZGdlZChndCk7CiAKIAkJCQll
cnIgPSAtRUlPOwogCQkJCWdvdG8gZmluaTsKIAkJCX0KIAotCQkJcmVzZXRfY291bnQgPSBmYWtl
X2hhbmdjaGVjayhpOTE1LCBCSVQoaWQpKTsKKwkJCXJlc2V0X2NvdW50ID0gZmFrZV9oYW5nY2hl
Y2soZ3QsIEJJVChpZCkpOwogCiAJCQlpZiAocHJldi0+ZmVuY2UuZXJyb3IgIT0gLUVJTykgewog
CQkJCXByX2VycigiR1BVIHJlc2V0IG5vdCByZWNvcmRlZCBvbiBoYW5naW5nIHJlcXVlc3QgW2Zl
bmNlLmVycm9yPSVkXSFcbiIsCkBAIC0xNDg4LDcgKzE0ODgsNyBAQCBzdGF0aWMgaW50IGlndF9y
ZXNldF9xdWV1ZSh2b2lkICphcmcpCiAJCQkJZ290byBmaW5pOwogCQkJfQogCi0JCQlpZiAoaTkx
NV9yZXNldF9jb3VudCgmaTkxNS0+Z3B1X2Vycm9yKSA9PSByZXNldF9jb3VudCkgeworCQkJaWYg
KGk5MTVfcmVzZXRfY291bnQoZ2xvYmFsKSA9PSByZXNldF9jb3VudCkgewogCQkJCXByX2Vycigi
Tm8gR1BVIHJlc2V0IHJlY29yZGVkIVxuIik7CiAJCQkJaTkxNV9yZXF1ZXN0X3B1dChycSk7CiAJ
CQkJaTkxNV9yZXF1ZXN0X3B1dChwcmV2KTsKQEAgLTE1MDcsNyArMTUwNyw3IEBAIHN0YXRpYyBp
bnQgaWd0X3Jlc2V0X3F1ZXVlKHZvaWQgKmFyZykKIAogCQlpOTE1X3JlcXVlc3RfcHV0KHByZXYp
OwogCi0JCWVyciA9IGlndF9mbHVzaF90ZXN0KGk5MTUsIEk5MTVfV0FJVF9MT0NLRUQpOworCQll
cnIgPSBpZ3RfZmx1c2hfdGVzdChndC0+aTkxNSwgSTkxNV9XQUlUX0xPQ0tFRCk7CiAJCWlmIChl
cnIpCiAJCQlicmVhazsKIAl9CkBAIC0xNTE1LDEwICsxNTE1LDEwIEBAIHN0YXRpYyBpbnQgaWd0
X3Jlc2V0X3F1ZXVlKHZvaWQgKmFyZykKIGZpbmk6CiAJaGFuZ19maW5pKCZoKTsKIHVubG9jazoK
LQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCWlndF9nbG9iYWxfcmVz
ZXRfdW5sb2NrKGk5MTUpOworCW11dGV4X3VubG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0
ZXgpOworCWlndF9nbG9iYWxfcmVzZXRfdW5sb2NrKGd0KTsKIAotCWlmIChpOTE1X3Jlc2V0X2Zh
aWxlZChpOTE1KSkKKwlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKGd0KSkKIAkJcmV0dXJuIC1FSU87
CiAKIAlyZXR1cm4gZXJyOwpAQCAtMTUyNiw4ICsxNTI2LDkgQEAgc3RhdGljIGludCBpZ3RfcmVz
ZXRfcXVldWUodm9pZCAqYXJnKQogCiBzdGF0aWMgaW50IGlndF9oYW5kbGVfZXJyb3Iodm9pZCAq
YXJnKQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYXJnOwotCXN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSA9IGk5MTUtPmVuZ2luZVtSQ1MwXTsKKwlzdHJ1Y3QgaW50
ZWxfZ3QgKmd0ID0gYXJnOworCXN0cnVjdCBpOTE1X2dwdV9lcnJvciAqZ2xvYmFsID0gJmd0LT5p
OTE1LT5ncHVfZXJyb3I7CisJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lID0gZ3QtPmk5
MTUtPmVuZ2luZVtSQ1MwXTsKIAlzdHJ1Y3QgaGFuZyBoOwogCXN0cnVjdCBpOTE1X3JlcXVlc3Qg
KnJxOwogCXN0cnVjdCBpOTE1X2dwdV9zdGF0ZSAqZXJyb3I7CkBAIC0xNTM1LDE1ICsxNTM2LDE1
IEBAIHN0YXRpYyBpbnQgaWd0X2hhbmRsZV9lcnJvcih2b2lkICphcmcpCiAKIAkvKiBDaGVjayB0
aGF0IHdlIGNhbiBpc3N1ZSBhIGdsb2JhbCBHUFUgYW5kIGVuZ2luZSByZXNldCAqLwogCi0JaWYg
KCFpbnRlbF9oYXNfcmVzZXRfZW5naW5lKGk5MTUpKQorCWlmICghaW50ZWxfaGFzX3Jlc2V0X2Vu
Z2luZShndC0+aTkxNSkpCiAJCXJldHVybiAwOwogCiAJaWYgKCFlbmdpbmUgfHwgIWludGVsX2Vu
Z2luZV9jYW5fc3RvcmVfZHdvcmQoZW5naW5lKSkKIAkJcmV0dXJuIDA7CiAKLQltdXRleF9sb2Nr
KCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKKwltdXRleF9sb2NrKCZndC0+aTkxNS0+ZHJtLnN0
cnVjdF9tdXRleCk7CiAKLQllcnIgPSBoYW5nX2luaXQoJmgsIGk5MTUpOworCWVyciA9IGhhbmdf
aW5pdCgmaCwgZ3QpOwogCWlmIChlcnIpCiAJCWdvdG8gZXJyX3VubG9jazsKIApAQCAtMTU1Nywy
OCArMTU1OCwyOCBAQCBzdGF0aWMgaW50IGlndF9oYW5kbGVfZXJyb3Iodm9pZCAqYXJnKQogCWk5
MTVfcmVxdWVzdF9hZGQocnEpOwogCiAJaWYgKCF3YWl0X3VudGlsX3J1bm5pbmcoJmgsIHJxKSkg
ewotCQlzdHJ1Y3QgZHJtX3ByaW50ZXIgcCA9IGRybV9pbmZvX3ByaW50ZXIoaTkxNS0+ZHJtLmRl
dik7CisJCXN0cnVjdCBkcm1fcHJpbnRlciBwID0gZHJtX2luZm9fcHJpbnRlcihndC0+aTkxNS0+
ZHJtLmRldik7CiAKIAkJcHJfZXJyKCIlczogRmFpbGVkIHRvIHN0YXJ0IHJlcXVlc3QgJWxseCwg
YXQgJXhcbiIsCiAJCSAgICAgICBfX2Z1bmNfXywgcnEtPmZlbmNlLnNlcW5vLCBod3Nfc2Vxbm8o
JmgsIHJxKSk7CiAJCWludGVsX2VuZ2luZV9kdW1wKHJxLT5lbmdpbmUsICZwLCAiJXNcbiIsIHJx
LT5lbmdpbmUtPm5hbWUpOwogCi0JCWk5MTVfZ2VtX3NldF93ZWRnZWQoaTkxNSk7CisJCWludGVs
X2d0X3NldF93ZWRnZWQoZ3QpOwogCiAJCWVyciA9IC1FSU87CiAJCWdvdG8gZXJyX3JlcXVlc3Q7
CiAJfQogCi0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKKwltdXRleF91
bmxvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAogCS8qIFRlbXBvcmFyaWx5IGRp
c2FibGUgZXJyb3IgY2FwdHVyZSAqLwotCWVycm9yID0geGNoZygmaTkxNS0+Z3B1X2Vycm9yLmZp
cnN0X2Vycm9yLCAodm9pZCAqKS0xKTsKKwllcnJvciA9IHhjaGcoJmdsb2JhbC0+Zmlyc3RfZXJy
b3IsICh2b2lkICopLTEpOwogCi0JaTkxNV9oYW5kbGVfZXJyb3IoaTkxNSwgZW5naW5lLT5tYXNr
LCAwLCBOVUxMKTsKKwlpbnRlbF9ndF9oYW5kbGVfZXJyb3IoZ3QsIGVuZ2luZS0+bWFzaywgMCwg
TlVMTCk7CiAKLQl4Y2hnKCZpOTE1LT5ncHVfZXJyb3IuZmlyc3RfZXJyb3IsIGVycm9yKTsKKwl4
Y2hnKCZnbG9iYWwtPmZpcnN0X2Vycm9yLCBlcnJvcik7CiAKLQltdXRleF9sb2NrKCZpOTE1LT5k
cm0uc3RydWN0X211dGV4KTsKKwltdXRleF9sb2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRl
eCk7CiAKIAlpZiAocnEtPmZlbmNlLmVycm9yICE9IC1FSU8pIHsKIAkJcHJfZXJyKCJHdWlsdHkg
cmVxdWVzdCBub3QgaWRlbnRpZmllZCFcbiIpOwpAQCAtMTU5MSw3ICsxNTkyLDcgQEAgc3RhdGlj
IGludCBpZ3RfaGFuZGxlX2Vycm9yKHZvaWQgKmFyZykKIGVycl9maW5pOgogCWhhbmdfZmluaSgm
aCk7CiBlcnJfdW5sb2NrOgotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7
CisJbXV0ZXhfdW5sb2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJcmV0dXJuIGVy
cjsKIH0KIApAQCAtMTYwOCw3ICsxNjA5LDcgQEAgc3RhdGljIGludCBfX2lndF9hdG9taWNfcmVz
ZXRfZW5naW5lKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAl0YXNrbGV0X2Rpc2Fi
bGVfbm9zeW5jKHQpOwogCXAtPmNyaXRpY2FsX3NlY3Rpb25fYmVnaW4oKTsKIAotCWVyciA9IGk5
MTVfcmVzZXRfZW5naW5lKGVuZ2luZSwgTlVMTCk7CisJZXJyID0gaW50ZWxfZW5naW5lX3Jlc2V0
KGVuZ2luZSwgTlVMTCk7CiAKIAlwLT5jcml0aWNhbF9zZWN0aW9uX2VuZCgpOwogCXRhc2tsZXRf
ZW5hYmxlKHQpOwpAQCAtMTYyMyw3ICsxNjI0LDYgQEAgc3RhdGljIGludCBfX2lndF9hdG9taWNf
cmVzZXRfZW5naW5lKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIHN0YXRpYyBpbnQg
aWd0X2F0b21pY19yZXNldF9lbmdpbmUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAog
CQkJCSAgIGNvbnN0IHN0cnVjdCBpZ3RfYXRvbWljX3NlY3Rpb24gKnApCiB7Ci0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBlbmdpbmUtPmk5MTU7CiAJc3RydWN0IGk5MTVfcmVxdWVz
dCAqcnE7CiAJc3RydWN0IGhhbmcgaDsKIAlpbnQgZXJyOwpAQCAtMTYzMiw3ICsxNjMyLDcgQEAg
c3RhdGljIGludCBpZ3RfYXRvbWljX3Jlc2V0X2VuZ2luZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmUsCiAJaWYgKGVycikKIAkJcmV0dXJuIGVycjsKIAotCWVyciA9IGhhbmdfaW5pdCgm
aCwgaTkxNSk7CisJZXJyID0gaGFuZ19pbml0KCZoLCBlbmdpbmUtPmd0KTsKIAlpZiAoZXJyKQog
CQlyZXR1cm4gZXJyOwogCkBAIC0xNjUxLDE2ICsxNjUxLDE2IEBAIHN0YXRpYyBpbnQgaWd0X2F0
b21pY19yZXNldF9lbmdpbmUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAogCQlwcl9l
cnIoIiVzKCVzKTogRmFpbGVkIHRvIHN0YXJ0IHJlcXVlc3QgJWxseCwgYXQgJXhcbiIsCiAJCSAg
ICAgICBfX2Z1bmNfXywgZW5naW5lLT5uYW1lLAogCQkgICAgICAgcnEtPmZlbmNlLnNlcW5vLCBo
d3Nfc2Vxbm8oJmgsIHJxKSk7Ci0JCWk5MTVfZ2VtX3NldF93ZWRnZWQoaTkxNSk7CisJCWludGVs
X2d0X3NldF93ZWRnZWQoZW5naW5lLT5ndCk7CiAJCWVyciA9IC1FSU87CiAJfQogCiAJaWYgKGVy
ciA9PSAwKSB7Ci0JCXN0cnVjdCBpZ3Rfd2VkZ2VfbWUgdzsKKwkJc3RydWN0IGludGVsX3dlZGdl
X21lIHc7CiAKLQkJaWd0X3dlZGdlX29uX3RpbWVvdXQoJncsIGk5MTUsIEhaIC8gMjAgLyogNTBt
cyB0aW1lb3V0Ki8pCisJCWludGVsX3dlZGdlX29uX3RpbWVvdXQoJncsIGVuZ2luZS0+Z3QsIEha
IC8gMjAgLyogNTBtcyAqLykKIAkJCWk5MTVfcmVxdWVzdF93YWl0KHJxLCAwLCBNQVhfU0NIRURV
TEVfVElNRU9VVCk7Ci0JCWlmIChpOTE1X3Jlc2V0X2ZhaWxlZChpOTE1KSkKKwkJaWYgKGludGVs
X2d0X2lzX3dlZGdlZChlbmdpbmUtPmd0KSkKIAkJCWVyciA9IC1FSU87CiAJfQogCkBAIC0xNjcy
LDMwICsxNjcyLDMwIEBAIHN0YXRpYyBpbnQgaWd0X2F0b21pY19yZXNldF9lbmdpbmUoc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAogCiBzdGF0aWMgaW50IGlndF9yZXNldF9lbmdpbmVz
X2F0b21pYyh2b2lkICphcmcpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBh
cmc7CisJc3RydWN0IGludGVsX2d0ICpndCA9IGFyZzsKIAljb25zdCB0eXBlb2YoKmlndF9hdG9t
aWNfcGhhc2VzKSAqcDsKIAlpbnQgZXJyID0gMDsKIAogCS8qIENoZWNrIHRoYXQgdGhlIGVuZ2lu
ZXMgcmVzZXRzIGFyZSB1c2FibGUgZnJvbSBhdG9taWMgY29udGV4dCAqLwogCi0JaWYgKCFpbnRl
bF9oYXNfcmVzZXRfZW5naW5lKGk5MTUpKQorCWlmICghaW50ZWxfaGFzX3Jlc2V0X2VuZ2luZShn
dC0+aTkxNSkpCiAJCXJldHVybiAwOwogCi0JaWYgKFVTRVNfR1VDX1NVQk1JU1NJT04oaTkxNSkp
CisJaWYgKFVTRVNfR1VDX1NVQk1JU1NJT04oZ3QtPmk5MTUpKQogCQlyZXR1cm4gMDsKIAotCWln
dF9nbG9iYWxfcmVzZXRfbG9jayhpOTE1KTsKLQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0
X211dGV4KTsKKwlpZ3RfZ2xvYmFsX3Jlc2V0X2xvY2soZ3QpOworCW11dGV4X2xvY2soJmd0LT5p
OTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAogCS8qIEZsdXNoIGFueSByZXF1ZXN0cyBiZWZvcmUg
d2UgZ2V0IHN0YXJ0ZWQgYW5kIGNoZWNrIGJhc2ljcyAqLwotCWlmICghaWd0X2ZvcmNlX3Jlc2V0
KGk5MTUpKQorCWlmICghaWd0X2ZvcmNlX3Jlc2V0KGd0KSkKIAkJZ290byB1bmxvY2s7CiAKIAlm
b3IgKHAgPSBpZ3RfYXRvbWljX3BoYXNlczsgcC0+bmFtZTsgcCsrKSB7CiAJCXN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZTsKIAkJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CiAKLQkJZm9y
X2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKKwkJZm9yX2VhY2hfZW5naW5lKGVuZ2lu
ZSwgZ3QtPmk5MTUsIGlkKSB7CiAJCQllcnIgPSBpZ3RfYXRvbWljX3Jlc2V0X2VuZ2luZShlbmdp
bmUsIHApOwogCQkJaWYgKGVycikKIAkJCQlnb3RvIG91dDsKQEAgLTE3MDQsMTEgKzE3MDQsMTEg
QEAgc3RhdGljIGludCBpZ3RfcmVzZXRfZW5naW5lc19hdG9taWModm9pZCAqYXJnKQogCiBvdXQ6
CiAJLyogQXMgd2UgcG9rZSBhcm91bmQgdGhlIGd1dHMsIGRvIGEgZnVsbCByZXNldCBiZWZvcmUg
Y29udGludWluZy4gKi8KLQlpZ3RfZm9yY2VfcmVzZXQoaTkxNSk7CisJaWd0X2ZvcmNlX3Jlc2V0
KGd0KTsKIAogdW5sb2NrOgotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7
Ci0JaWd0X2dsb2JhbF9yZXNldF91bmxvY2soaTkxNSk7CisJbXV0ZXhfdW5sb2NrKCZndC0+aTkx
NS0+ZHJtLnN0cnVjdF9tdXRleCk7CisJaWd0X2dsb2JhbF9yZXNldF91bmxvY2soZ3QpOwogCiAJ
cmV0dXJuIGVycjsKIH0KQEAgLTE3MzAsMjggKzE3MzAsMjkgQEAgaW50IGludGVsX2hhbmdjaGVj
a19saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkJU1VCVEVT
VChpZ3RfcmVzZXRfZXZpY3RfZmVuY2UpLAogCQlTVUJURVNUKGlndF9oYW5kbGVfZXJyb3IpLAog
CX07CisJc3RydWN0IGludGVsX2d0ICpndCA9ICZpOTE1LT5ndDsKIAlpbnRlbF93YWtlcmVmX3Qg
d2FrZXJlZjsKIAlib29sIHNhdmVkX2hhbmdjaGVjazsKIAlpbnQgZXJyOwogCi0JaWYgKCFpbnRl
bF9oYXNfZ3B1X3Jlc2V0KGk5MTUpKQorCWlmICghaW50ZWxfaGFzX2dwdV9yZXNldChndC0+aTkx
NSkpCiAJCXJldHVybiAwOwogCi0JaWYgKGk5MTVfdGVybWluYWxseV93ZWRnZWQoaTkxNSkpCisJ
aWYgKGludGVsX2d0X2lzX3dlZGdlZChndCkpCiAJCXJldHVybiAtRUlPOyAvKiB3ZSdyZSBsb25n
IHBhc3QgaG9wZSBvZiBhIHN1Y2Nlc3NmdWwgcmVzZXQgKi8KIAotCXdha2VyZWYgPSBpbnRlbF9y
dW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRp
bWVfcG1fZ2V0KCZndC0+aTkxNS0+cnVudGltZV9wbSk7CiAJc2F2ZWRfaGFuZ2NoZWNrID0gZmV0
Y2hfYW5kX3plcm8oJmk5MTVfbW9kcGFyYW1zLmVuYWJsZV9oYW5nY2hlY2spOwotCWRyYWluX2Rl
bGF5ZWRfd29yaygmaTkxNS0+Z3B1X2Vycm9yLmhhbmdjaGVja193b3JrKTsgLyogZmx1c2ggcGFy
YW0gKi8KKwlkcmFpbl9kZWxheWVkX3dvcmsoJmd0LT5oYW5nY2hlY2sud29yayk7IC8qIGZsdXNo
IHBhcmFtICovCiAKLQllcnIgPSBpOTE1X2xpdmVfc3VidGVzdHModGVzdHMsIGk5MTUpOworCWVy
ciA9IGludGVsX2d0X2xpdmVfc3VidGVzdHModGVzdHMsIGd0KTsKIAotCW11dGV4X2xvY2soJmk5
MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCWlndF9mbHVzaF90ZXN0KGk5MTUsIEk5MTVfV0FJVF9M
T0NLRUQpOwotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CisJbXV0ZXhf
bG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCWlndF9mbHVzaF90ZXN0KGd0LT5p
OTE1LCBJOTE1X1dBSVRfTE9DS0VEKTsKKwltdXRleF91bmxvY2soJmd0LT5pOTE1LT5kcm0uc3Ry
dWN0X211dGV4KTsKIAogCWk5MTVfbW9kcGFyYW1zLmVuYWJsZV9oYW5nY2hlY2sgPSBzYXZlZF9o
YW5nY2hlY2s7Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2Vy
ZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZndC0+aTkxNS0+cnVudGltZV9wbSwgd2FrZXJl
Zik7CiAKIAlyZXR1cm4gZXJyOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3Qvc2VsZnRlc3RfbHJjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMu
YwppbmRleCBiOWI4ODFhYjhlN2MuLjY3OGU5YjJlZGY4ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3Qvc2VsZnRlc3RfbHJjLmMKQEAgLTU1LDcgKzU1LDcgQEAgc3RhdGljIGludCBsaXZlX3Nhbml0
eWNoZWNrKHZvaWQgKmFyZykKIAkJaWYgKCFpZ3Rfd2FpdF9mb3Jfc3Bpbm5lcigmc3BpbiwgcnEp
KSB7CiAJCQlHRU1fVFJBQ0UoInNwaW5uZXIgZmFpbGVkIHRvIHN0YXJ0XG4iKTsKIAkJCUdFTV9U
UkFDRV9EVU1QKCk7Ci0JCQlpOTE1X2dlbV9zZXRfd2VkZ2VkKGk5MTUpOworCQkJaW50ZWxfZ3Rf
c2V0X3dlZGdlZCgmaTkxNS0+Z3QpOwogCQkJZXJyID0gLUVJTzsKIAkJCWdvdG8gZXJyX2N0eDsK
IAkJfQpAQCAtMjExLDcgKzIxMSw3IEBAIHNsaWNlX3NlbWFwaG9yZV9xdWV1ZShzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICpvdXRlciwKIAkJcHJfZXJyKCJGYWlsZWQgdG8gc2xpY2UgYWxvbmcgc2Vt
YXBob3JlIGNoYWluIG9mIGxlbmd0aCAoJWQsICVkKSFcbiIsCiAJCSAgICAgICBjb3VudCwgbik7
CiAJCUdFTV9UUkFDRV9EVU1QKCk7Ci0JCWk5MTVfZ2VtX3NldF93ZWRnZWQob3V0ZXItPmk5MTUp
OworCQlpbnRlbF9ndF9zZXRfd2VkZ2VkKG91dGVyLT5ndCk7CiAJCWVyciA9IC1FSU87CiAJfQog
CkBAIC00NDUsNyArNDQ1LDcgQEAgc3RhdGljIGludCBsaXZlX2J1c3l3YWl0X3ByZWVtcHQodm9p
ZCAqYXJnKQogCQkJaW50ZWxfZW5naW5lX2R1bXAoZW5naW5lLCAmcCwgIiVzXG4iLCBlbmdpbmUt
Pm5hbWUpOwogCQkJR0VNX1RSQUNFX0RVTVAoKTsKIAotCQkJaTkxNV9nZW1fc2V0X3dlZGdlZChp
OTE1KTsKKwkJCWludGVsX2d0X3NldF93ZWRnZWQoJmk5MTUtPmd0KTsKIAkJCWVyciA9IC1FSU87
CiAJCQlnb3RvIGVycl92bWE7CiAJCX0KQEAgLTUzNCw3ICs1MzQsNyBAQCBzdGF0aWMgaW50IGxp
dmVfcHJlZW1wdCh2b2lkICphcmcpCiAJCWlmICghaWd0X3dhaXRfZm9yX3NwaW5uZXIoJnNwaW5f
bG8sIHJxKSkgewogCQkJR0VNX1RSQUNFKCJsbyBzcGlubmVyIGZhaWxlZCB0byBzdGFydFxuIik7
CiAJCQlHRU1fVFJBQ0VfRFVNUCgpOwotCQkJaTkxNV9nZW1fc2V0X3dlZGdlZChpOTE1KTsKKwkJ
CWludGVsX2d0X3NldF93ZWRnZWQoJmk5MTUtPmd0KTsKIAkJCWVyciA9IC1FSU87CiAJCQlnb3Rv
IGVycl9jdHhfbG87CiAJCX0KQEAgLTU1MSw3ICs1NTEsNyBAQCBzdGF0aWMgaW50IGxpdmVfcHJl
ZW1wdCh2b2lkICphcmcpCiAJCWlmICghaWd0X3dhaXRfZm9yX3NwaW5uZXIoJnNwaW5faGksIHJx
KSkgewogCQkJR0VNX1RSQUNFKCJoaSBzcGlubmVyIGZhaWxlZCB0byBzdGFydFxuIik7CiAJCQlH
RU1fVFJBQ0VfRFVNUCgpOwotCQkJaTkxNV9nZW1fc2V0X3dlZGdlZChpOTE1KTsKKwkJCWludGVs
X2d0X3NldF93ZWRnZWQoJmk5MTUtPmd0KTsKIAkJCWVyciA9IC1FSU87CiAJCQlnb3RvIGVycl9j
dHhfbG87CiAJCX0KQEAgLTY4OCw3ICs2ODgsNyBAQCBzdGF0aWMgaW50IGxpdmVfbGF0ZV9wcmVl
bXB0KHZvaWQgKmFyZykKIGVycl93ZWRnZWQ6CiAJaWd0X3NwaW5uZXJfZW5kKCZzcGluX2hpKTsK
IAlpZ3Rfc3Bpbm5lcl9lbmQoJnNwaW5fbG8pOwotCWk5MTVfZ2VtX3NldF93ZWRnZWQoaTkxNSk7
CisJaW50ZWxfZ3Rfc2V0X3dlZGdlZCgmaTkxNS0+Z3QpOwogCWVyciA9IC1FSU87CiAJZ290byBl
cnJfY3R4X2xvOwogfQpAQCAtODI0LDcgKzgyNCw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9ub3ByZWVt
cHQodm9pZCAqYXJnKQogZXJyX3dlZGdlZDoKIAlpZ3Rfc3Bpbm5lcl9lbmQoJmIuc3Bpbik7CiAJ
aWd0X3NwaW5uZXJfZW5kKCZhLnNwaW4pOwotCWk5MTVfZ2VtX3NldF93ZWRnZWQoaTkxNSk7CisJ
aW50ZWxfZ3Rfc2V0X3dlZGdlZCgmaTkxNS0+Z3QpOwogCWVyciA9IC1FSU87CiAJZ290byBlcnJf
Y2xpZW50X2I7CiB9CkBAIC05MzQsNyArOTM0LDcgQEAgc3RhdGljIGludCBsaXZlX3N1cHByZXNz
X3NlbGZfcHJlZW1wdCh2b2lkICphcmcpCiBlcnJfd2VkZ2VkOgogCWlndF9zcGlubmVyX2VuZCgm
Yi5zcGluKTsKIAlpZ3Rfc3Bpbm5lcl9lbmQoJmEuc3Bpbik7Ci0JaTkxNV9nZW1fc2V0X3dlZGdl
ZChpOTE1KTsKKwlpbnRlbF9ndF9zZXRfd2VkZ2VkKCZpOTE1LT5ndCk7CiAJZXJyID0gLUVJTzsK
IAlnb3RvIGVycl9jbGllbnRfYjsKIH0KQEAgLTExMDUsNyArMTEwNSw3IEBAIHN0YXRpYyBpbnQg
bGl2ZV9zdXBwcmVzc193YWl0X3ByZWVtcHQodm9pZCAqYXJnKQogZXJyX3dlZGdlZDoKIAlmb3Ig
KGkgPSAwOyBpIDwgQVJSQVlfU0laRShjbGllbnQpOyBpKyspCiAJCWlndF9zcGlubmVyX2VuZCgm
Y2xpZW50W2ldLnNwaW4pOwotCWk5MTVfZ2VtX3NldF93ZWRnZWQoaTkxNSk7CisJaW50ZWxfZ3Rf
c2V0X3dlZGdlZCgmaTkxNS0+Z3QpOwogCWVyciA9IC1FSU87CiAJZ290byBlcnJfY2xpZW50XzM7
CiB9CkBAIC0xMjUxLDcgKzEyNTEsNyBAQCBzdGF0aWMgaW50IGxpdmVfY2hhaW5fcHJlZW1wdCh2
b2lkICphcmcpCiBlcnJfd2VkZ2VkOgogCWlndF9zcGlubmVyX2VuZCgmaGkuc3Bpbik7CiAJaWd0
X3NwaW5uZXJfZW5kKCZsby5zcGluKTsKLQlpOTE1X2dlbV9zZXRfd2VkZ2VkKGk5MTUpOworCWlu
dGVsX2d0X3NldF93ZWRnZWQoJmk5MTUtPmd0KTsKIAllcnIgPSAtRUlPOwogCWdvdG8gZXJyX2Ns
aWVudF9sbzsKIH0KQEAgLTEzMTAsNyArMTMxMCw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9wcmVlbXB0
X2hhbmcodm9pZCAqYXJnKQogCQlpZiAoIWlndF93YWl0X2Zvcl9zcGlubmVyKCZzcGluX2xvLCBy
cSkpIHsKIAkJCUdFTV9UUkFDRSgibG8gc3Bpbm5lciBmYWlsZWQgdG8gc3RhcnRcbiIpOwogCQkJ
R0VNX1RSQUNFX0RVTVAoKTsKLQkJCWk5MTVfZ2VtX3NldF93ZWRnZWQoaTkxNSk7CisJCQlpbnRl
bF9ndF9zZXRfd2VkZ2VkKCZpOTE1LT5ndCk7CiAJCQllcnIgPSAtRUlPOwogCQkJZ290byBlcnJf
Y3R4X2xvOwogCQl9CkBAIC0xMzMyLDIxICsxMzMyLDIxIEBAIHN0YXRpYyBpbnQgbGl2ZV9wcmVl
bXB0X2hhbmcodm9pZCAqYXJnKQogCQkJCQkJIEhaIC8gMTApKSB7CiAJCQlwcl9lcnIoIlByZWVt
cHRpb24gZGlkIG5vdCBvY2N1ciB3aXRoaW4gdGltZW91dCEiKTsKIAkJCUdFTV9UUkFDRV9EVU1Q
KCk7Ci0JCQlpOTE1X2dlbV9zZXRfd2VkZ2VkKGk5MTUpOworCQkJaW50ZWxfZ3Rfc2V0X3dlZGdl
ZCgmaTkxNS0+Z3QpOwogCQkJZXJyID0gLUVJTzsKIAkJCWdvdG8gZXJyX2N0eF9sbzsKIAkJfQog
Ci0JCXNldF9iaXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBpZCwgJmk5MTUtPmdwdV9lcnJvci5mbGFn
cyk7Ci0JCWk5MTVfcmVzZXRfZW5naW5lKGVuZ2luZSwgTlVMTCk7Ci0JCWNsZWFyX2JpdChJOTE1
X1JFU0VUX0VOR0lORSArIGlkLCAmaTkxNS0+Z3B1X2Vycm9yLmZsYWdzKTsKKwkJc2V0X2JpdChJ
OTE1X1JFU0VUX0VOR0lORSArIGlkLCAmaTkxNS0+Z3QucmVzZXQuZmxhZ3MpOworCQlpbnRlbF9l
bmdpbmVfcmVzZXQoZW5naW5lLCBOVUxMKTsKKwkJY2xlYXJfYml0KEk5MTVfUkVTRVRfRU5HSU5F
ICsgaWQsICZpOTE1LT5ndC5yZXNldC5mbGFncyk7CiAKIAkJZW5naW5lLT5leGVjbGlzdHMucHJl
ZW1wdF9oYW5nLmluamVjdF9oYW5nID0gZmFsc2U7CiAKIAkJaWYgKCFpZ3Rfd2FpdF9mb3Jfc3Bp
bm5lcigmc3Bpbl9oaSwgcnEpKSB7CiAJCQlHRU1fVFJBQ0UoImhpIHNwaW5uZXIgZmFpbGVkIHRv
IHN0YXJ0XG4iKTsKIAkJCUdFTV9UUkFDRV9EVU1QKCk7Ci0JCQlpOTE1X2dlbV9zZXRfd2VkZ2Vk
KGk5MTUpOworCQkJaW50ZWxfZ3Rfc2V0X3dlZGdlZCgmaTkxNS0+Z3QpOwogCQkJZXJyID0gLUVJ
TzsKIAkJCWdvdG8gZXJyX2N0eF9sbzsKIAkJfQpAQCAtMTcyNiw3ICsxNzI2LDcgQEAgc3RhdGlj
IGludCBub3BfdmlydHVhbF9lbmdpbmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJ
CQkJCSAgcmVxdWVzdFtuY10tPmZlbmNlLmNvbnRleHQsCiAJCQkJCSAgcmVxdWVzdFtuY10tPmZl
bmNlLnNlcW5vKTsKIAkJCQlHRU1fVFJBQ0VfRFVNUCgpOwotCQkJCWk5MTVfZ2VtX3NldF93ZWRn
ZWQoaTkxNSk7CisJCQkJaW50ZWxfZ3Rfc2V0X3dlZGdlZCgmaTkxNS0+Z3QpOwogCQkJCWJyZWFr
OwogCQkJfQogCQl9CkBAIC0xODczLDcgKzE4NzMsNyBAQCBzdGF0aWMgaW50IG1hc2tfdmlydHVh
bF9lbmdpbmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCQkJICByZXF1ZXN0W25d
LT5mZW5jZS5jb250ZXh0LAogCQkJCSAgcmVxdWVzdFtuXS0+ZmVuY2Uuc2Vxbm8pOwogCQkJR0VN
X1RSQUNFX0RVTVAoKTsKLQkJCWk5MTVfZ2VtX3NldF93ZWRnZWQoaTkxNSk7CisJCQlpbnRlbF9n
dF9zZXRfd2VkZ2VkKCZpOTE1LT5ndCk7CiAJCQllcnIgPSAtRUlPOwogCQkJZ290byBvdXQ7CiAJ
CX0KQEAgLTIxNTAsNyArMjE1MCw3IEBAIGludCBpbnRlbF9leGVjbGlzdHNfbGl2ZV9zZWxmdGVz
dHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJaWYgKCFIQVNfRVhFQ0xJU1RTKGk5
MTUpKQogCQlyZXR1cm4gMDsKIAotCWlmIChpOTE1X3Rlcm1pbmFsbHlfd2VkZ2VkKGk5MTUpKQor
CWlmIChpbnRlbF9ndF9pc193ZWRnZWQoJmk5MTUtPmd0KSkKIAkJcmV0dXJuIDA7CiAKIAlyZXR1
cm4gaTkxNV9saXZlX3N1YnRlc3RzKHRlc3RzLCBpOTE1KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3Jlc2V0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9zZWxmdGVzdF9yZXNldC5jCmluZGV4IDY3MmUzMmUxZWY5NS4uMDBhNGY2MGNkZmQ1IDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9yZXNldC5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3Jlc2V0LmMKQEAgLTksMjYgKzksMjkgQEAK
IAogc3RhdGljIGludCBpZ3RfZ2xvYmFsX3Jlc2V0KHZvaWQgKmFyZykKIHsKLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGFyZzsKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOwog
CXVuc2lnbmVkIGludCByZXNldF9jb3VudDsKKwlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKIAlp
bnQgZXJyID0gMDsKIAogCS8qIENoZWNrIHRoYXQgd2UgY2FuIGlzc3VlIGEgZ2xvYmFsIEdQVSBy
ZXNldCAqLwogCi0JaWd0X2dsb2JhbF9yZXNldF9sb2NrKGk5MTUpOworCWlndF9nbG9iYWxfcmVz
ZXRfbG9jayhndCk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZndC0+aTkxNS0+
cnVudGltZV9wbSk7CiAKLQlyZXNldF9jb3VudCA9IGk5MTVfcmVzZXRfY291bnQoJmk5MTUtPmdw
dV9lcnJvcik7CisJcmVzZXRfY291bnQgPSBpOTE1X3Jlc2V0X2NvdW50KCZndC0+aTkxNS0+Z3B1
X2Vycm9yKTsKIAotCWk5MTVfcmVzZXQoaTkxNSwgQUxMX0VOR0lORVMsIE5VTEwpOworCWludGVs
X2d0X3Jlc2V0KGd0LCBBTExfRU5HSU5FUywgTlVMTCk7CiAKLQlpZiAoaTkxNV9yZXNldF9jb3Vu
dCgmaTkxNS0+Z3B1X2Vycm9yKSA9PSByZXNldF9jb3VudCkgeworCWlmIChpOTE1X3Jlc2V0X2Nv
dW50KCZndC0+aTkxNS0+Z3B1X2Vycm9yKSA9PSByZXNldF9jb3VudCkgewogCQlwcl9lcnIoIk5v
IEdQVSByZXNldCByZWNvcmRlZCFcbiIpOwogCQllcnIgPSAtRUlOVkFMOwogCX0KIAotCWlndF9n
bG9iYWxfcmVzZXRfdW5sb2NrKGk5MTUpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZndC0+aTkx
NS0+cnVudGltZV9wbSwgd2FrZXJlZik7CisJaWd0X2dsb2JhbF9yZXNldF91bmxvY2soZ3QpOwog
Ci0JaWYgKGk5MTVfcmVzZXRfZmFpbGVkKGk5MTUpKQorCWlmIChpbnRlbF9ndF9pc193ZWRnZWQo
Z3QpKQogCQllcnIgPSAtRUlPOwogCiAJcmV0dXJuIGVycjsKQEAgLTM2LDcyICszOSw3MiBAQCBz
dGF0aWMgaW50IGlndF9nbG9iYWxfcmVzZXQodm9pZCAqYXJnKQogCiBzdGF0aWMgaW50IGlndF93
ZWRnZWRfcmVzZXQodm9pZCAqYXJnKQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gYXJnOworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7CiAJaW50ZWxfd2FrZXJlZl90IHdh
a2VyZWY7CiAKIAkvKiBDaGVjayB0aGF0IHdlIGNhbiByZWNvdmVyIGEgd2VkZ2VkIGRldmljZSB3
aXRoIGEgR1BVIHJlc2V0ICovCiAKLQlpZ3RfZ2xvYmFsX3Jlc2V0X2xvY2soaTkxNSk7Ci0Jd2Fr
ZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKKwlpZ3RfZ2xv
YmFsX3Jlc2V0X2xvY2soZ3QpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmZ3Qt
Pmk5MTUtPnJ1bnRpbWVfcG0pOwogCi0JaTkxNV9nZW1fc2V0X3dlZGdlZChpOTE1KTsKKwlpbnRl
bF9ndF9zZXRfd2VkZ2VkKGd0KTsKIAotCUdFTV9CVUdfT04oIWk5MTVfcmVzZXRfZmFpbGVkKGk5
MTUpKTsKLQlpOTE1X3Jlc2V0KGk5MTUsIEFMTF9FTkdJTkVTLCBOVUxMKTsKKwlHRU1fQlVHX09O
KCFpbnRlbF9ndF9pc193ZWRnZWQoZ3QpKTsKKwlpbnRlbF9ndF9yZXNldChndCwgQUxMX0VOR0lO
RVMsIE5VTEwpOwogCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdh
a2VyZWYpOwotCWlndF9nbG9iYWxfcmVzZXRfdW5sb2NrKGk5MTUpOworCWludGVsX3J1bnRpbWVf
cG1fcHV0KCZndC0+aTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CisJaWd0X2dsb2JhbF9yZXNl
dF91bmxvY2soZ3QpOwogCi0JcmV0dXJuIGk5MTVfcmVzZXRfZmFpbGVkKGk5MTUpID8gLUVJTyA6
IDA7CisJcmV0dXJuIGludGVsX2d0X2lzX3dlZGdlZChndCkgPyAtRUlPIDogMDsKIH0KIAogc3Rh
dGljIGludCBpZ3RfYXRvbWljX3Jlc2V0KHZvaWQgKmFyZykKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IGFyZzsKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOwogCWNvbnN0
IHR5cGVvZigqaWd0X2F0b21pY19waGFzZXMpICpwOwogCWludCBlcnIgPSAwOwogCiAJLyogQ2hl
Y2sgdGhhdCB0aGUgcmVzZXRzIGFyZSB1c2FibGUgZnJvbSBhdG9taWMgY29udGV4dCAqLwogCi0J
aW50ZWxfZ3RfcG1fZ2V0KCZpOTE1LT5ndCk7Ci0JaWd0X2dsb2JhbF9yZXNldF9sb2NrKGk5MTUp
OworCWludGVsX2d0X3BtX2dldChndCk7CisJaWd0X2dsb2JhbF9yZXNldF9sb2NrKGd0KTsKIAog
CS8qIEZsdXNoIGFueSByZXF1ZXN0cyBiZWZvcmUgd2UgZ2V0IHN0YXJ0ZWQgYW5kIGNoZWNrIGJh
c2ljcyAqLwotCWlmICghaWd0X2ZvcmNlX3Jlc2V0KGk5MTUpKQorCWlmICghaWd0X2ZvcmNlX3Jl
c2V0KGd0KSkKIAkJZ290byB1bmxvY2s7CiAKIAlmb3IgKHAgPSBpZ3RfYXRvbWljX3BoYXNlczsg
cC0+bmFtZTsgcCsrKSB7CiAJCWludGVsX2VuZ2luZV9tYXNrX3QgYXdha2U7CiAKLQkJR0VNX1RS
QUNFKCJpbnRlbF9ncHVfcmVzZXQgdW5kZXIgJXNcbiIsIHAtPm5hbWUpOworCQlHRU1fVFJBQ0Uo
Il9faW50ZWxfZ3RfcmVzZXQgdW5kZXIgJXNcbiIsIHAtPm5hbWUpOwogCi0JCWF3YWtlID0gcmVz
ZXRfcHJlcGFyZShpOTE1KTsKKwkJYXdha2UgPSByZXNldF9wcmVwYXJlKGd0KTsKIAkJcC0+Y3Jp
dGljYWxfc2VjdGlvbl9iZWdpbigpOwogCi0JCWVyciA9IGludGVsX2dwdV9yZXNldChpOTE1LCBB
TExfRU5HSU5FUyk7CisJCWVyciA9IF9faW50ZWxfZ3RfcmVzZXQoZ3QsIEFMTF9FTkdJTkVTKTsK
IAogCQlwLT5jcml0aWNhbF9zZWN0aW9uX2VuZCgpOwotCQlyZXNldF9maW5pc2goaTkxNSwgYXdh
a2UpOworCQlyZXNldF9maW5pc2goZ3QsIGF3YWtlKTsKIAogCQlpZiAoZXJyKSB7Ci0JCQlwcl9l
cnIoImludGVsX2dwdV9yZXNldCBmYWlsZWQgdW5kZXIgJXNcbiIsIHAtPm5hbWUpOworCQkJcHJf
ZXJyKCJfX2ludGVsX2d0X3Jlc2V0IGZhaWxlZCB1bmRlciAlc1xuIiwgcC0+bmFtZSk7CiAJCQli
cmVhazsKIAkJfQogCX0KIAogCS8qIEFzIHdlIHBva2UgYXJvdW5kIHRoZSBndXRzLCBkbyBhIGZ1
bGwgcmVzZXQgYmVmb3JlIGNvbnRpbnVpbmcuICovCi0JaWd0X2ZvcmNlX3Jlc2V0KGk5MTUpOwor
CWlndF9mb3JjZV9yZXNldChndCk7CiAKIHVubG9jazoKLQlpZ3RfZ2xvYmFsX3Jlc2V0X3VubG9j
ayhpOTE1KTsKLQlpbnRlbF9ndF9wbV9wdXQoJmk5MTUtPmd0KTsKKwlpZ3RfZ2xvYmFsX3Jlc2V0
X3VubG9jayhndCk7CisJaW50ZWxfZ3RfcG1fcHV0KGd0KTsKIAogCXJldHVybiBlcnI7CiB9CiAK
IHN0YXRpYyBpbnQgaWd0X2F0b21pY19lbmdpbmVfcmVzZXQodm9pZCAqYXJnKQogewotCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYXJnOworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBh
cmc7CiAJY29uc3QgdHlwZW9mKCppZ3RfYXRvbWljX3BoYXNlcykgKnA7CiAJc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lOwogCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwpAQCAtMTA5LDMz
ICsxMTIsMzMgQEAgc3RhdGljIGludCBpZ3RfYXRvbWljX2VuZ2luZV9yZXNldCh2b2lkICphcmcp
CiAKIAkvKiBDaGVjayB0aGF0IHRoZSByZXNldHMgYXJlIHVzYWJsZSBmcm9tIGF0b21pYyBjb250
ZXh0ICovCiAKLQlpZiAoIWludGVsX2hhc19yZXNldF9lbmdpbmUoaTkxNSkpCisJaWYgKCFpbnRl
bF9oYXNfcmVzZXRfZW5naW5lKGd0LT5pOTE1KSkKIAkJcmV0dXJuIDA7CiAKLQlpZiAoVVNFU19H
VUNfU1VCTUlTU0lPTihpOTE1KSkKKwlpZiAoVVNFU19HVUNfU1VCTUlTU0lPTihndC0+aTkxNSkp
CiAJCXJldHVybiAwOwogCi0JaW50ZWxfZ3RfcG1fZ2V0KCZpOTE1LT5ndCk7Ci0JaWd0X2dsb2Jh
bF9yZXNldF9sb2NrKGk5MTUpOworCWludGVsX2d0X3BtX2dldChndCk7CisJaWd0X2dsb2JhbF9y
ZXNldF9sb2NrKGd0KTsKIAogCS8qIEZsdXNoIGFueSByZXF1ZXN0cyBiZWZvcmUgd2UgZ2V0IHN0
YXJ0ZWQgYW5kIGNoZWNrIGJhc2ljcyAqLwotCWlmICghaWd0X2ZvcmNlX3Jlc2V0KGk5MTUpKQor
CWlmICghaWd0X2ZvcmNlX3Jlc2V0KGd0KSkKIAkJZ290byBvdXRfdW5sb2NrOwogCi0JZm9yX2Vh
Y2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBn
dC0+aTkxNSwgaWQpIHsKIAkJdGFza2xldF9kaXNhYmxlX25vc3luYygmZW5naW5lLT5leGVjbGlz
dHMudGFza2xldCk7CiAJCWludGVsX2VuZ2luZV9wbV9nZXQoZW5naW5lKTsKIAogCQlmb3IgKHAg
PSBpZ3RfYXRvbWljX3BoYXNlczsgcC0+bmFtZTsgcCsrKSB7Ci0JCQlHRU1fVFJBQ0UoImk5MTVf
cmVzZXRfZW5naW5lKCVzKSB1bmRlciAlc1xuIiwKKwkJCUdFTV9UUkFDRSgiaW50ZWxfZW5naW5l
X3Jlc2V0KCVzKSB1bmRlciAlc1xuIiwKIAkJCQkgIGVuZ2luZS0+bmFtZSwgcC0+bmFtZSk7CiAK
IAkJCXAtPmNyaXRpY2FsX3NlY3Rpb25fYmVnaW4oKTsKLQkJCWVyciA9IGk5MTVfcmVzZXRfZW5n
aW5lKGVuZ2luZSwgTlVMTCk7CisJCQllcnIgPSBpbnRlbF9lbmdpbmVfcmVzZXQoZW5naW5lLCBO
VUxMKTsKIAkJCXAtPmNyaXRpY2FsX3NlY3Rpb25fZW5kKCk7CiAKIAkJCWlmIChlcnIpIHsKLQkJ
CQlwcl9lcnIoImk5MTVfcmVzZXRfZW5naW5lKCVzKSBmYWlsZWQgdW5kZXIgJXNcbiIsCisJCQkJ
cHJfZXJyKCJpbnRlbF9lbmdpbmVfcmVzZXQoJXMpIGZhaWxlZCB1bmRlciAlc1xuIiwKIAkJCQkg
ICAgICAgZW5naW5lLT5uYW1lLCBwLT5uYW1lKTsKIAkJCQlicmVhazsKIAkJCX0KQEAgLTE0OCwx
MSArMTUxLDExIEBAIHN0YXRpYyBpbnQgaWd0X2F0b21pY19lbmdpbmVfcmVzZXQodm9pZCAqYXJn
KQogCX0KIAogCS8qIEFzIHdlIHBva2UgYXJvdW5kIHRoZSBndXRzLCBkbyBhIGZ1bGwgcmVzZXQg
YmVmb3JlIGNvbnRpbnVpbmcuICovCi0JaWd0X2ZvcmNlX3Jlc2V0KGk5MTUpOworCWlndF9mb3Jj
ZV9yZXNldChndCk7CiAKIG91dF91bmxvY2s6Ci0JaWd0X2dsb2JhbF9yZXNldF91bmxvY2soaTkx
NSk7Ci0JaW50ZWxfZ3RfcG1fcHV0KCZpOTE1LT5ndCk7CisJaWd0X2dsb2JhbF9yZXNldF91bmxv
Y2soZ3QpOworCWludGVsX2d0X3BtX3B1dChndCk7CiAKIAlyZXR1cm4gZXJyOwogfQpAQCAtMTY1
LDE3ICsxNjgsMTMgQEAgaW50IGludGVsX3Jlc2V0X2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQogCQlTVUJURVNUKGlndF9hdG9taWNfcmVzZXQpLAogCQlTVUJU
RVNUKGlndF9hdG9taWNfZW5naW5lX3Jlc2V0KSwKIAl9OwotCWludGVsX3dha2VyZWZfdCB3YWtl
cmVmOwotCWludCBlcnIgPSAwOworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSAmaTkxNS0+Z3Q7CiAK
LQlpZiAoIWludGVsX2hhc19ncHVfcmVzZXQoaTkxNSkpCisJaWYgKCFpbnRlbF9oYXNfZ3B1X3Jl
c2V0KGd0LT5pOTE1KSkKIAkJcmV0dXJuIDA7CiAKLQlpZiAoaTkxNV90ZXJtaW5hbGx5X3dlZGdl
ZChpOTE1KSkKKwlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKGd0KSkKIAkJcmV0dXJuIC1FSU87IC8q
IHdlJ3JlIGxvbmcgcGFzdCBob3BlIG9mIGEgc3VjY2Vzc2Z1bCByZXNldCAqLwogCi0Jd2l0aF9p
bnRlbF9ydW50aW1lX3BtKCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKQotCQllcnIgPSBpOTE1
X3N1YnRlc3RzKHRlc3RzLCBpOTE1KTsKLQotCXJldHVybiBlcnI7CisJcmV0dXJuIGludGVsX2d0
X2xpdmVfc3VidGVzdHModGVzdHMsIGd0KTsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3NlbGZ0ZXN0X3RpbWVsaW5lLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9z
ZWxmdGVzdF90aW1lbGluZS5jCmluZGV4IGVhZTNiMTk2M2JmNy4uZjBhODQwMDMwMzgyIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF90aW1lbGluZS5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3RpbWVsaW5lLmMKQEAgLTcsNiArNyw3
IEBACiAjaW5jbHVkZSA8bGludXgvcHJpbWVfbnVtYmVycy5oPgogCiAjaW5jbHVkZSAiZ2VtL2k5
MTVfZ2VtX3BtLmgiCisjaW5jbHVkZSAiaW50ZWxfZ3QuaCIKIAogI2luY2x1ZGUgIi4uL3NlbGZ0
ZXN0cy9pOTE1X3JhbmRvbS5oIgogI2luY2x1ZGUgIi4uL2k5MTVfc2VsZnRlc3QuaCIKQEAgLTgz
Niw3ICs4MzcsNyBAQCBpbnQgaW50ZWxfdGltZWxpbmVfbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJCVNVQlRFU1QobGl2ZV9od3NwX3dyYXApLAogCX07CiAK
LQlpZiAoaTkxNV90ZXJtaW5hbGx5X3dlZGdlZChpOTE1KSkKKwlpZiAoaW50ZWxfZ3RfaXNfd2Vk
Z2VkKCZpOTE1LT5ndCkpCiAJCXJldHVybiAwOwogCiAJcmV0dXJuIGk5MTVfbGl2ZV9zdWJ0ZXN0
cyh0ZXN0cywgaTkxNSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxm
dGVzdF93b3JrYXJvdW5kcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rfd29y
a2Fyb3VuZHMuYwppbmRleCBhMGQ4ZjFiZmUwYWQuLmFiMTQ3OTg1ZmE3NCAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rfd29ya2Fyb3VuZHMuYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF93b3JrYXJvdW5kcy5jCkBAIC0xMiw3ICsxMiw2
IEBACiAjaW5jbHVkZSAic2VsZnRlc3RzL2lndF9mbHVzaF90ZXN0LmgiCiAjaW5jbHVkZSAic2Vs
ZnRlc3RzL2lndF9yZXNldC5oIgogI2luY2x1ZGUgInNlbGZ0ZXN0cy9pZ3Rfc3Bpbm5lci5oIgot
I2luY2x1ZGUgInNlbGZ0ZXN0cy9pZ3Rfd2VkZ2VfbWUuaCIKICNpbmNsdWRlICJzZWxmdGVzdHMv
bW9ja19kcm0uaCIKIAogI2luY2x1ZGUgImdlbS9zZWxmdGVzdHMvaWd0X2dlbV91dGlscy5oIgpA
QCAtMTc4LDcgKzE3Nyw3IEBAIHN0YXRpYyBpbnQgY2hlY2tfd2hpdGVsaXN0KHN0cnVjdCBpOTE1
X2dlbV9jb250ZXh0ICpjdHgsCiAJCQkgICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUp
CiB7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKnJlc3VsdHM7Ci0Jc3RydWN0IGlndF93
ZWRnZV9tZSB3ZWRnZTsKKwlzdHJ1Y3QgaW50ZWxfd2VkZ2VfbWUgd2VkZ2U7CiAJdTMyICp2YWRk
cjsKIAlpbnQgZXJyOwogCWludCBpOwpAQCAtMTg5LDEwICsxODgsMTAgQEAgc3RhdGljIGludCBj
aGVja193aGl0ZWxpc3Qoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKIAogCWVyciA9IDA7
CiAJaTkxNV9nZW1fb2JqZWN0X2xvY2socmVzdWx0cyk7Ci0JaWd0X3dlZGdlX29uX3RpbWVvdXQo
JndlZGdlLCBjdHgtPmk5MTUsIEhaIC8gNSkgLyogYSBzYWZldHkgbmV0ISAqLworCWludGVsX3dl
ZGdlX29uX3RpbWVvdXQoJndlZGdlLCAmY3R4LT5pOTE1LT5ndCwgSFogLyA1KSAvKiBzYWZldHkg
bmV0ISAqLwogCQllcnIgPSBpOTE1X2dlbV9vYmplY3Rfc2V0X3RvX2NwdV9kb21haW4ocmVzdWx0
cywgZmFsc2UpOwogCWk5MTVfZ2VtX29iamVjdF91bmxvY2socmVzdWx0cyk7Ci0JaWYgKGk5MTVf
dGVybWluYWxseV93ZWRnZWQoY3R4LT5pOTE1KSkKKwlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKCZj
dHgtPmk5MTUtPmd0KSkKIAkJZXJyID0gLUVJTzsKIAlpZiAoZXJyKQogCQlnb3RvIG91dF9wdXQ7
CkBAIC0yMjUsMTMgKzIyNCwxMyBAQCBzdGF0aWMgaW50IGNoZWNrX3doaXRlbGlzdChzdHJ1Y3Qg
aTkxNV9nZW1fY29udGV4dCAqY3R4LAogCiBzdGF0aWMgaW50IGRvX2RldmljZV9yZXNldChzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7Ci0JaTkxNV9yZXNldChlbmdpbmUtPmk5MTUs
IGVuZ2luZS0+bWFzaywgImxpdmVfd29ya2Fyb3VuZHMiKTsKKwlpbnRlbF9ndF9yZXNldChlbmdp
bmUtPmd0LCBlbmdpbmUtPm1hc2ssICJsaXZlX3dvcmthcm91bmRzIik7CiAJcmV0dXJuIDA7CiB9
CiAKIHN0YXRpYyBpbnQgZG9fZW5naW5lX3Jlc2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSkKIHsKLQlyZXR1cm4gaTkxNV9yZXNldF9lbmdpbmUoZW5naW5lLCAibGl2ZV93b3JrYXJv
dW5kcyIpOworCXJldHVybiBpbnRlbF9lbmdpbmVfcmVzZXQoZW5naW5lLCAibGl2ZV93b3JrYXJv
dW5kcyIpOwogfQogCiBzdGF0aWMgaW50CkBAIC01NzIsNyArNTcxLDcgQEAgc3RhdGljIGludCBj
aGVja19kaXJ0eV93aGl0ZWxpc3Qoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKIAkJaWYg
KGk5MTVfcmVxdWVzdF93YWl0KHJxLCAwLCBIWiAvIDUpIDwgMCkgewogCQkJcHJfZXJyKCIlczog
RnV0emluZyAleCB0aW1lZG91dDsgY2FuY2VsbGluZyB0ZXN0XG4iLAogCQkJICAgICAgIGVuZ2lu
ZS0+bmFtZSwgcmVnKTsKLQkJCWk5MTVfZ2VtX3NldF93ZWRnZWQoY3R4LT5pOTE1KTsKKwkJCWlu
dGVsX2d0X3NldF93ZWRnZWQoJmN0eC0+aTkxNS0+Z3QpOwogCQkJZXJyID0gLUVJTzsKIAkJCWdv
dG8gb3V0X2JhdGNoOwogCQl9CkBAIC03MzAsNyArNzI5LDcgQEAgc3RhdGljIGludCBsaXZlX3Jl
c2V0X3doaXRlbGlzdCh2b2lkICphcmcpCiAJaWYgKCFlbmdpbmUgfHwgZW5naW5lLT53aGl0ZWxp
c3QuY291bnQgPT0gMCkKIAkJcmV0dXJuIDA7CiAKLQlpZ3RfZ2xvYmFsX3Jlc2V0X2xvY2soaTkx
NSk7CisJaWd0X2dsb2JhbF9yZXNldF9sb2NrKCZpOTE1LT5ndCk7CiAKIAlpZiAoaW50ZWxfaGFz
X3Jlc2V0X2VuZ2luZShpOTE1KSkgewogCQllcnIgPSBjaGVja193aGl0ZWxpc3RfYWNyb3NzX3Jl
c2V0KGVuZ2luZSwKQEAgLTc0OSw3ICs3NDgsNyBAQCBzdGF0aWMgaW50IGxpdmVfcmVzZXRfd2hp
dGVsaXN0KHZvaWQgKmFyZykKIAl9CiAKIG91dDoKLQlpZ3RfZ2xvYmFsX3Jlc2V0X3VubG9jayhp
OTE1KTsKKwlpZ3RfZ2xvYmFsX3Jlc2V0X3VubG9jaygmaTkxNS0+Z3QpOwogCXJldHVybiBlcnI7
CiB9CiAKQEAgLTExMTgsNyArMTExNyw3IEBAIGxpdmVfZ3B1X3Jlc2V0X3dvcmthcm91bmRzKHZv
aWQgKmFyZykKIAogCXByX2luZm8oIlZlcmlmeWluZyBhZnRlciBHUFUgcmVzZXQuLi5cbiIpOwog
Ci0JaWd0X2dsb2JhbF9yZXNldF9sb2NrKGk5MTUpOworCWlndF9nbG9iYWxfcmVzZXRfbG9jaygm
aTkxNS0+Z3QpOwogCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGlt
ZV9wbSk7CiAKIAlyZWZlcmVuY2VfbGlzdHNfaW5pdChpOTE1LCAmbGlzdHMpOwpAQCAtMTEyNyw3
ICsxMTI2LDcgQEAgbGl2ZV9ncHVfcmVzZXRfd29ya2Fyb3VuZHModm9pZCAqYXJnKQogCWlmICgh
b2spCiAJCWdvdG8gb3V0OwogCi0JaTkxNV9yZXNldChpOTE1LCBBTExfRU5HSU5FUywgImxpdmVf
d29ya2Fyb3VuZHMiKTsKKwlpbnRlbF9ndF9yZXNldCgmaTkxNS0+Z3QsIEFMTF9FTkdJTkVTLCAi
bGl2ZV93b3JrYXJvdW5kcyIpOwogCiAJb2sgPSB2ZXJpZnlfd2FfbGlzdHMoY3R4LCAmbGlzdHMs
ICJhZnRlciByZXNldCIpOwogCkBAIC0xMTM1LDcgKzExMzQsNyBAQCBsaXZlX2dwdV9yZXNldF93
b3JrYXJvdW5kcyh2b2lkICphcmcpCiAJa2VybmVsX2NvbnRleHRfY2xvc2UoY3R4KTsKIAlyZWZl
cmVuY2VfbGlzdHNfZmluaShpOTE1LCAmbGlzdHMpOwogCWludGVsX3J1bnRpbWVfcG1fcHV0KCZp
OTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKLQlpZ3RfZ2xvYmFsX3Jlc2V0X3VubG9jayhpOTE1
KTsKKwlpZ3RfZ2xvYmFsX3Jlc2V0X3VubG9jaygmaTkxNS0+Z3QpOwogCiAJcmV0dXJuIG9rID8g
MCA6IC1FU1JDSDsKIH0KQEAgLTExNjAsNyArMTE1OSw3IEBAIGxpdmVfZW5naW5lX3Jlc2V0X3dv
cmthcm91bmRzKHZvaWQgKmFyZykKIAlpZiAoSVNfRVJSKGN0eCkpCiAJCXJldHVybiBQVFJfRVJS
KGN0eCk7CiAKLQlpZ3RfZ2xvYmFsX3Jlc2V0X2xvY2soaTkxNSk7CisJaWd0X2dsb2JhbF9yZXNl
dF9sb2NrKCZpOTE1LT5ndCk7CiAJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1
LT5ydW50aW1lX3BtKTsKIAogCXJlZmVyZW5jZV9saXN0c19pbml0KGk5MTUsICZsaXN0cyk7CkBA
IC0xMTc2LDcgKzExNzUsNyBAQCBsaXZlX2VuZ2luZV9yZXNldF93b3JrYXJvdW5kcyh2b2lkICph
cmcpCiAJCQlnb3RvIGVycjsKIAkJfQogCi0JCWk5MTVfcmVzZXRfZW5naW5lKGVuZ2luZSwgImxp
dmVfd29ya2Fyb3VuZHMiKTsKKwkJaW50ZWxfZW5naW5lX3Jlc2V0KGVuZ2luZSwgImxpdmVfd29y
a2Fyb3VuZHMiKTsKIAogCQlvayA9IHZlcmlmeV93YV9saXN0cyhjdHgsICZsaXN0cywgImFmdGVy
IGlkbGUgcmVzZXQiKTsKIAkJaWYgKCFvaykgewpAQCAtMTIwNCw3ICsxMjAzLDcgQEAgbGl2ZV9l
bmdpbmVfcmVzZXRfd29ya2Fyb3VuZHModm9pZCAqYXJnKQogCQkJZ290byBlcnI7CiAJCX0KIAot
CQlpOTE1X3Jlc2V0X2VuZ2luZShlbmdpbmUsICJsaXZlX3dvcmthcm91bmRzIik7CisJCWludGVs
X2VuZ2luZV9yZXNldChlbmdpbmUsICJsaXZlX3dvcmthcm91bmRzIik7CiAKIAkJaWd0X3NwaW5u
ZXJfZW5kKCZzcGluKTsKIAkJaWd0X3NwaW5uZXJfZmluaSgmc3Bpbik7CkBAIC0xMjE5LDcgKzEy
MTgsNyBAQCBsaXZlX2VuZ2luZV9yZXNldF93b3JrYXJvdW5kcyh2b2lkICphcmcpCiBlcnI6CiAJ
cmVmZXJlbmNlX2xpc3RzX2ZpbmkoaTkxNSwgJmxpc3RzKTsKIAlpbnRlbF9ydW50aW1lX3BtX3B1
dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7Ci0JaWd0X2dsb2JhbF9yZXNldF91bmxvY2so
aTkxNSk7CisJaWd0X2dsb2JhbF9yZXNldF91bmxvY2soJmk5MTUtPmd0KTsKIAlrZXJuZWxfY29u
dGV4dF9jbG9zZShjdHgpOwogCiAJaWd0X2ZsdXNoX3Rlc3QoaTkxNSwgSTkxNV9XQUlUX0xPQ0tF
RCk7CkBAIC0xMjM4LDcgKzEyMzcsNyBAQCBpbnQgaW50ZWxfd29ya2Fyb3VuZHNfbGl2ZV9zZWxm
dGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJfTsKIAlpbnQgZXJyOwogCi0J
aWYgKGk5MTVfdGVybWluYWxseV93ZWRnZWQoaTkxNSkpCisJaWYgKGludGVsX2d0X2lzX3dlZGdl
ZCgmaTkxNS0+Z3QpKQogCQlyZXR1cm4gMDsKIAogCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1
Y3RfbXV0ZXgpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2Zz
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwppbmRleCA0MTI0NWFjYjBh
MGYuLmExODQzZTNkZTZkNyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9k
ZWJ1Z2ZzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKQEAgLTEw
NzQsMTUgKzEwNzQsMTYgQEAgc3RhdGljIHZvaWQgaTkxNV9pbnN0ZG9uZV9pbmZvKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAogc3RhdGljIGludCBpOTE1X2hhbmdjaGVja19p
bmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogewotCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKKwlzdHJ1
Y3QgaW50ZWxfZ3QgKmd0ID0gJmk5MTUtPmd0OwogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZTsKIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKIAllbnVtIGludGVsX2VuZ2luZV9pZCBp
ZDsKIAotCXNlcV9wcmludGYobSwgIlJlc2V0IGZsYWdzOiAlbHhcbiIsIGRldl9wcml2LT5ncHVf
ZXJyb3IuZmxhZ3MpOwotCWlmICh0ZXN0X2JpdChJOTE1X1dFREdFRCwgJmRldl9wcml2LT5ncHVf
ZXJyb3IuZmxhZ3MpKQorCXNlcV9wcmludGYobSwgIlJlc2V0IGZsYWdzOiAlbHhcbiIsIGd0LT5y
ZXNldC5mbGFncyk7CisJaWYgKHRlc3RfYml0KEk5MTVfV0VER0VELCAmZ3QtPnJlc2V0LmZsYWdz
KSkKIAkJc2VxX3B1dHMobSwgIlx0V2VkZ2VkXG4iKTsKLQlpZiAodGVzdF9iaXQoSTkxNV9SRVNF
VF9CQUNLT0ZGLCAmZGV2X3ByaXYtPmdwdV9lcnJvci5mbGFncykpCisJaWYgKHRlc3RfYml0KEk5
MTVfUkVTRVRfQkFDS09GRiwgJmd0LT5yZXNldC5mbGFncykpCiAJCXNlcV9wdXRzKG0sICJcdERl
dmljZSAoZ2xvYmFsKSByZXNldCBpbiBwcm9ncmVzc1xuIik7CiAKIAlpZiAoIWk5MTVfbW9kcGFy
YW1zLmVuYWJsZV9oYW5nY2hlY2spIHsKQEAgLTEwOTAsMTkgKzEwOTEsMTkgQEAgc3RhdGljIGlu
dCBpOTE1X2hhbmdjaGVja19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQog
CQlyZXR1cm4gMDsKIAl9CiAKLQlpZiAodGltZXJfcGVuZGluZygmZGV2X3ByaXYtPmdwdV9lcnJv
ci5oYW5nY2hlY2tfd29yay50aW1lcikpCisJaWYgKHRpbWVyX3BlbmRpbmcoJmd0LT5oYW5nY2hl
Y2sud29yay50aW1lcikpCiAJCXNlcV9wcmludGYobSwgIkhhbmdjaGVjayBhY3RpdmUsIHRpbWVy
IGZpcmVzIGluICVkbXNcbiIsCi0JCQkgICBqaWZmaWVzX3RvX21zZWNzKGRldl9wcml2LT5ncHVf
ZXJyb3IuaGFuZ2NoZWNrX3dvcmsudGltZXIuZXhwaXJlcyAtCisJCQkgICBqaWZmaWVzX3RvX21z
ZWNzKGd0LT5oYW5nY2hlY2sud29yay50aW1lci5leHBpcmVzIC0KIAkJCQkJICAgIGppZmZpZXMp
KTsKLQllbHNlIGlmIChkZWxheWVkX3dvcmtfcGVuZGluZygmZGV2X3ByaXYtPmdwdV9lcnJvci5o
YW5nY2hlY2tfd29yaykpCisJZWxzZSBpZiAoZGVsYXllZF93b3JrX3BlbmRpbmcoJmd0LT5oYW5n
Y2hlY2sud29yaykpCiAJCXNlcV9wdXRzKG0sICJIYW5nY2hlY2sgYWN0aXZlLCB3b3JrIHBlbmRp
bmdcbiIpOwogCWVsc2UKIAkJc2VxX3B1dHMobSwgIkhhbmdjaGVjayBpbmFjdGl2ZVxuIik7CiAK
LQlzZXFfcHJpbnRmKG0sICJHVCBhY3RpdmU/ICVzXG4iLCB5ZXNubyhkZXZfcHJpdi0+Z3QuYXdh
a2UpKTsKKwlzZXFfcHJpbnRmKG0sICJHVCBhY3RpdmU/ICVzXG4iLCB5ZXNubyhndC0+YXdha2Up
KTsKIAotCXdpdGhfaW50ZWxfcnVudGltZV9wbSgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2Vy
ZWYpIHsKLQkJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYsIGlkKSB7CisJd2l0aF9p
bnRlbF9ydW50aW1lX3BtKCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKSB7CisJCWZvcl9lYWNo
X2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKSB7CiAJCQlzdHJ1Y3QgaW50ZWxfaW5zdGRvbmUgaW5z
dGRvbmU7CiAKIAkJCXNlcV9wcmludGYobSwgIiVzOiAlZCBtcyBhZ29cbiIsCkBAIC0xMTE3LDEw
ICsxMTE4LDEwIEBAIHN0YXRpYyBpbnQgaTkxNV9oYW5nY2hlY2tfaW5mbyhzdHJ1Y3Qgc2VxX2Zp
bGUgKm0sIHZvaWQgKnVudXNlZCkKIAkJCWludGVsX2VuZ2luZV9nZXRfaW5zdGRvbmUoZW5naW5l
LCAmaW5zdGRvbmUpOwogCiAJCQlzZXFfcHV0cyhtLCAiXHRpbnN0ZG9uZSByZWFkID1cbiIpOwot
CQkJaTkxNV9pbnN0ZG9uZV9pbmZvKGRldl9wcml2LCBtLCAmaW5zdGRvbmUpOworCQkJaTkxNV9p
bnN0ZG9uZV9pbmZvKGk5MTUsIG0sICZpbnN0ZG9uZSk7CiAKIAkJCXNlcV9wdXRzKG0sICJcdGlu
c3Rkb25lIGFjY3UgPVxuIik7Ci0JCQlpOTE1X2luc3Rkb25lX2luZm8oZGV2X3ByaXYsIG0sCisJ
CQlpOTE1X2luc3Rkb25lX2luZm8oaTkxNSwgbSwKIAkJCQkJICAgJmVuZ2luZS0+aGFuZ2NoZWNr
Lmluc3Rkb25lKTsKIAkJfQogCX0KQEAgLTExMjgsMjMgKzExMjksNiBAQCBzdGF0aWMgaW50IGk5
MTVfaGFuZ2NoZWNrX2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCiAJcmV0
dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaTkxNV9yZXNldF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAq
bSwgdm9pZCAqdW51c2VkKQotewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKLQlzdHJ1Y3QgaTkxNV9ncHVfZXJyb3IgKmVycm9y
ID0gJmRldl9wcml2LT5ncHVfZXJyb3I7Ci0Jc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
OwotCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwotCi0Jc2VxX3ByaW50ZihtLCAiZnVsbCBncHUg
cmVzZXQgPSAldVxuIiwgaTkxNV9yZXNldF9jb3VudChlcnJvcikpOwotCi0JZm9yX2VhY2hfZW5n
aW5lKGVuZ2luZSwgZGV2X3ByaXYsIGlkKSB7Ci0JCXNlcV9wcmludGYobSwgIiVzID0gJXVcbiIs
IGVuZ2luZS0+bmFtZSwKLQkJCSAgIGk5MTVfcmVzZXRfZW5naW5lX2NvdW50KGVycm9yLCBlbmdp
bmUpKTsKLQl9Ci0KLQlyZXR1cm4gMDsKLX0KLQogc3RhdGljIGludCBpcm9ubGFrZV9kcnBjX2lu
Zm8oc3RydWN0IHNlcV9maWxlICptKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwpAQCAtMzYxNiw3ICszNjAwLDggQEAgc3RhdGlj
IGNvbnN0IHN0cnVjdCBmaWxlX29wZXJhdGlvbnMgaTkxNV9jdXJfd21fbGF0ZW5jeV9mb3BzID0g
ewogc3RhdGljIGludAogaTkxNV93ZWRnZWRfZ2V0KHZvaWQgKmRhdGEsIHU2NCAqdmFsKQogewot
CWludCByZXQgPSBpOTE1X3Rlcm1pbmFsbHlfd2VkZ2VkKGRhdGEpOworCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gZGF0YTsKKwlpbnQgcmV0ID0gaW50ZWxfZ3RfdGVybWluYWxseV93
ZWRnZWQoJmk5MTUtPmd0KTsKIAogCXN3aXRjaCAocmV0KSB7CiAJY2FzZSAtRUlPOgpAQCAtMzYz
NiwxMSArMzYyMSwxMSBAQCBpOTE1X3dlZGdlZF9zZXQodm9pZCAqZGF0YSwgdTY0IHZhbCkKIAlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRhdGE7CiAKIAkvKiBGbHVzaCBhbnkgcHJl
dmlvdXMgcmVzZXQgYmVmb3JlIGFwcGx5aW5nIGZvciBhIG5ldyBvbmUgKi8KLQl3YWl0X2V2ZW50
KGk5MTUtPmdwdV9lcnJvci5yZXNldF9xdWV1ZSwKLQkJICAgIXRlc3RfYml0KEk5MTVfUkVTRVRf
QkFDS09GRiwgJmk5MTUtPmdwdV9lcnJvci5mbGFncykpOworCXdhaXRfZXZlbnQoaTkxNS0+Z3Qu
cmVzZXQucXVldWUsCisJCSAgICF0ZXN0X2JpdChJOTE1X1JFU0VUX0JBQ0tPRkYsICZpOTE1LT5n
dC5yZXNldC5mbGFncykpOwogCi0JaTkxNV9oYW5kbGVfZXJyb3IoaTkxNSwgdmFsLCBJOTE1X0VS
Uk9SX0NBUFRVUkUsCi0JCQkgICJNYW51YWxseSBzZXQgd2VkZ2VkIGVuZ2luZSBtYXNrID0gJWxs
eCIsIHZhbCk7CisJaW50ZWxfZ3RfaGFuZGxlX2Vycm9yKCZpOTE1LT5ndCwgdmFsLCBJOTE1X0VS
Uk9SX0NBUFRVUkUsCisJCQkgICAgICAiTWFudWFsbHkgc2V0IHdlZGdlZCBlbmdpbmUgbWFzayA9
ICVsbHgiLCB2YWwpOwogCXJldHVybiAwOwogfQogCkBAIC0zNjgzLDggKzM2NjgsOSBAQCBpOTE1
X2Ryb3BfY2FjaGVzX3NldCh2b2lkICpkYXRhLCB1NjQgdmFsKQogCQkgIHZhbCwgdmFsICYgRFJP
UF9BTEwpOwogCiAJaWYgKHZhbCAmIERST1BfUkVTRVRfQUNUSVZFICYmCi0JICAgIHdhaXRfZm9y
KGludGVsX2VuZ2luZXNfYXJlX2lkbGUoaTkxNSksIEk5MTVfSURMRV9FTkdJTkVTX1RJTUVPVVQp
KQotCQlpOTE1X2dlbV9zZXRfd2VkZ2VkKGk5MTUpOworCSAgICB3YWl0X2ZvcihpbnRlbF9lbmdp
bmVzX2FyZV9pZGxlKCZpOTE1LT5ndCksCisJCSAgICAgSTkxNV9JRExFX0VOR0lORVNfVElNRU9V
VCkpCisJCWludGVsX2d0X3NldF93ZWRnZWQoJmk5MTUtPmd0KTsKIAogCS8qIE5vIG5lZWQgdG8g
Y2hlY2sgYW5kIHdhaXQgZm9yIGdwdSByZXNldHMsIG9ubHkgbGliZHJtIGF1dG8tcmVzdGFydHMK
IAkgKiBvbiBpb2N0bHMgb24gLUVBR0FJTi4gKi8KQEAgLTM3MTksOCArMzcwNSw4IEBAIGk5MTVf
ZHJvcF9jYWNoZXNfc2V0KHZvaWQgKmRhdGEsIHU2NCB2YWwpCiAJCW11dGV4X3VubG9jaygmaTkx
NS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJfQogCi0JaWYgKHZhbCAmIERST1BfUkVTRVRfQUNUSVZF
ICYmIGk5MTVfdGVybWluYWxseV93ZWRnZWQoaTkxNSkpCi0JCWk5MTVfaGFuZGxlX2Vycm9yKGk5
MTUsIEFMTF9FTkdJTkVTLCAwLCBOVUxMKTsKKwlpZiAodmFsICYgRFJPUF9SRVNFVF9BQ1RJVkUg
JiYgaW50ZWxfZ3RfdGVybWluYWxseV93ZWRnZWQoJmk5MTUtPmd0KSkKKwkJaW50ZWxfZ3RfaGFu
ZGxlX2Vycm9yKCZpOTE1LT5ndCwgQUxMX0VOR0lORVMsIDAsIE5VTEwpOwogCiAJZnNfcmVjbGFp
bV9hY3F1aXJlKEdGUF9LRVJORUwpOwogCWlmICh2YWwgJiBEUk9QX0JPVU5EKQpAQCAtNDM3NSw3
ICs0MzYxLDYgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1faW5mb19saXN0IGk5MTVfZGVidWdm
c19saXN0W10gPSB7CiAJeyJpOTE1X2h1Y19sb2FkX3N0YXR1cyIsIGk5MTVfaHVjX2xvYWRfc3Rh
dHVzX2luZm8sIDB9LAogCXsiaTkxNV9mcmVxdWVuY3lfaW5mbyIsIGk5MTVfZnJlcXVlbmN5X2lu
Zm8sIDB9LAogCXsiaTkxNV9oYW5nY2hlY2tfaW5mbyIsIGk5MTVfaGFuZ2NoZWNrX2luZm8sIDB9
LAotCXsiaTkxNV9yZXNldF9pbmZvIiwgaTkxNV9yZXNldF9pbmZvLCAwfSwKIAl7Imk5MTVfZHJw
Y19pbmZvIiwgaTkxNV9kcnBjX2luZm8sIDB9LAogCXsiaTkxNV9lbW9uX3N0YXR1cyIsIGk5MTVf
ZW1vbl9zdGF0dXMsIDB9LAogCXsiaTkxNV9yaW5nX2ZyZXFfdGFibGUiLCBpOTE1X3JpbmdfZnJl
cV90YWJsZSwgMH0sCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYwppbmRleCBiMTNmNzZhYmQ0OGQuLmY0
M2Y2NDcyMWIyYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCkBAIC05NDcsNyArOTQ3LDYgQEAg
c3RhdGljIGludCBpOTE1X2RyaXZlcl9lYXJseV9wcm9iZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCiAJaWYgKHJldCA8IDApCiAJCWdvdG8gZXJyX3VjOwogCWludGVsX2lycV9p
bml0KGRldl9wcml2KTsKLQlpbnRlbF9oYW5nY2hlY2tfaW5pdChkZXZfcHJpdik7CiAJaW50ZWxf
aW5pdF9kaXNwbGF5X2hvb2tzKGRldl9wcml2KTsKIAlpbnRlbF9pbml0X2Nsb2NrX2dhdGluZ19o
b29rcyhkZXZfcHJpdik7CiAJaW50ZWxfaW5pdF9hdWRpb19ob29rcyhkZXZfcHJpdik7CkBAIC0x
OTY3LDcgKzE5NjYsNyBAQCB2b2lkIGk5MTVfZHJpdmVyX3JlbW92ZShzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2KQogCSAqIGFsbCBpbi1mbGlnaHQgcmVxdWVzdHMgc28gdGhhdCB3ZSBjYW4gcXVpY2ts
eSB1bmJpbmQgdGhlIGFjdGl2ZQogCSAqIHJlc291cmNlcy4KIAkgKi8KLQlpOTE1X2dlbV9zZXRf
d2VkZ2VkKGRldl9wcml2KTsKKwlpbnRlbF9ndF9zZXRfd2VkZ2VkKCZkZXZfcHJpdi0+Z3QpOwog
CiAJLyogRmx1c2ggYW55IGV4dGVybmFsIGNvZGUgdGhhdCBzdGlsbCBtYXkgYmUgdW5kZXIgdGhl
IFJDVSBsb2NrICovCiAJc3luY2hyb25pemVfcmN1KCk7CkBAIC0xOTg4LDcgKzE5ODcsNyBAQCB2
b2lkIGk5MTVfZHJpdmVyX3JlbW92ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQogCWludGVsX2Nz
cl91Y29kZV9maW5pKGRldl9wcml2KTsKIAogCS8qIEZyZWUgZXJyb3Igc3RhdGUgYWZ0ZXIgaW50
ZXJydXB0cyBhcmUgZnVsbHkgZGlzYWJsZWQuICovCi0JY2FuY2VsX2RlbGF5ZWRfd29ya19zeW5j
KCZkZXZfcHJpdi0+Z3B1X2Vycm9yLmhhbmdjaGVja193b3JrKTsKKwljYW5jZWxfZGVsYXllZF93
b3JrX3N5bmMoJmRldl9wcml2LT5ndC5oYW5nY2hlY2sud29yayk7CiAJaTkxNV9yZXNldF9lcnJv
cl9zdGF0ZShkZXZfcHJpdik7CiAKIAlpOTE1X2dlbV9kcml2ZXJfcmVtb3ZlKGRldl9wcml2KTsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2Rydi5oCmluZGV4IDdkMmU2YzQ3MGE3ZC4uY2Y3ZTkyY2E3MmU5IDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKQEAgLTI0MDAsMjggKzI0MDAsMTAgQEAgaW50IGk5MTVf
ZHJpdmVyX3Byb2JlKHN0cnVjdCBwY2lfZGV2ICpwZGV2LCBjb25zdCBzdHJ1Y3QgcGNpX2Rldmlj
ZV9pZCAqZW50KTsKIHZvaWQgaTkxNV9kcml2ZXJfcmVtb3ZlKHN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYpOwogCiB2b2lkIGludGVsX2VuZ2luZV9pbml0X2hhbmdjaGVjayhzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmUpOwotdm9pZCBpbnRlbF9oYW5nY2hlY2tfaW5pdChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwogaW50IHZsdl9mb3JjZV9nZnhfY2xvY2soc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBib29sIG9uKTsKIAogdTMyIGludGVsX2NhbGN1bGF0
ZV9tY3Jfc19zc19zZWxlY3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKIAot
c3RhdGljIGlubGluZSB2b2lkIGk5MTVfcXVldWVfaGFuZ2NoZWNrKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKLXsKLQl1bnNpZ25lZCBsb25nIGRlbGF5OwotCi0JaWYgKHVubGlr
ZWx5KCFpOTE1X21vZHBhcmFtcy5lbmFibGVfaGFuZ2NoZWNrKSkKLQkJcmV0dXJuOwotCi0JLyog
RG9uJ3QgY29udGludWFsbHkgZGVmZXIgdGhlIGhhbmdjaGVjayBzbyB0aGF0IGl0IGlzIGFsd2F5
cyBydW4gYXQKLQkgKiBsZWFzdCBvbmNlIGFmdGVyIHdvcmsgaGFzIGJlZW4gc2NoZWR1bGVkIG9u
IGFueSByaW5nLiBPdGhlcndpc2UsCi0JICogd2Ugd2lsbCBpZ25vcmUgYSBodW5nIHJpbmcgaWYg
YSBzZWNvbmQgcmluZyBpcyBrZXB0IGJ1c3kuCi0JICovCi0KLQlkZWxheSA9IHJvdW5kX2ppZmZp
ZXNfdXBfcmVsYXRpdmUoRFJNX0k5MTVfSEFOR0NIRUNLX0pJRkZJRVMpOwotCXF1ZXVlX2RlbGF5
ZWRfd29yayhzeXN0ZW1fbG9uZ193cSwKLQkJCSAgICZkZXZfcHJpdi0+Z3B1X2Vycm9yLmhhbmdj
aGVja193b3JrLCBkZWxheSk7Ci19Ci0KIHN0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF9ndnRfYWN0
aXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKIAlyZXR1cm4gZGV2X3By
aXYtPmd2dDsKQEAgLTI1MTAsMzAgKzI0OTIsMTcgQEAgdm9pZCBpOTE1X2dlbV90cmFja19mYihz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2xkLAogCiBpbnQgX19tdXN0X2NoZWNrIGk5MTVf
Z2VtX3NldF9nbG9iYWxfc2Vxbm8oc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdTMyIHNlcW5vKTsK
IAotc3RhdGljIGlubGluZSBib29sIF9faTkxNV93ZWRnZWQoc3RydWN0IGk5MTVfZ3B1X2Vycm9y
ICplcnJvcikKLXsKLQlyZXR1cm4gdW5saWtlbHkodGVzdF9iaXQoSTkxNV9XRURHRUQsICZlcnJv
ci0+ZmxhZ3MpKTsKLX0KLQotc3RhdGljIGlubGluZSBib29sIGk5MTVfcmVzZXRfZmFpbGVkKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQotewotCXJldHVybiBfX2k5MTVfd2VkZ2VkKCZp
OTE1LT5ncHVfZXJyb3IpOwotfQotCiBzdGF0aWMgaW5saW5lIHUzMiBpOTE1X3Jlc2V0X2NvdW50
KHN0cnVjdCBpOTE1X2dwdV9lcnJvciAqZXJyb3IpCiB7Ci0JcmV0dXJuIFJFQURfT05DRShlcnJv
ci0+cmVzZXRfY291bnQpOworCXJldHVybiBhdG9taWNfcmVhZCgmZXJyb3ItPnJlc2V0X2NvdW50
KTsKIH0KIAogc3RhdGljIGlubGluZSB1MzIgaTkxNV9yZXNldF9lbmdpbmVfY291bnQoc3RydWN0
IGk5MTVfZ3B1X2Vycm9yICplcnJvciwKIAkJCQkJICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUpCiB7Ci0JcmV0dXJuIFJFQURfT05DRShlcnJvci0+cmVzZXRfZW5naW5lX2NvdW50W2Vu
Z2luZS0+aWRdKTsKKwlyZXR1cm4gYXRvbWljX3JlYWQoJmVycm9yLT5yZXNldF9lbmdpbmVfY291
bnRbZW5naW5lLT51YWJpX2NsYXNzXSk7CiB9CiAKLXZvaWQgaTkxNV9nZW1fc2V0X3dlZGdlZChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwotYm9vbCBpOTE1X2dlbV91bnNldF93
ZWRnZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKLQogdm9pZCBpOTE1X2dl
bV9pbml0X21taW8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwogaW50IF9fbXVzdF9j
aGVjayBpOTE1X2dlbV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiBp
bnQgX19tdXN0X2NoZWNrIGk5MTVfZ2VtX2luaXRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCmluZGV4IDM3ZmUyZWQyZjU4Mi4uZTI0
OTU1YjVlYmMyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKQEAgLTg5NCwxMyArODk0LDEzIEBA
IHZvaWQgaTkxNV9nZW1fcnVudGltZV9zdXNwZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQogCX0KIH0KIAotc3RhdGljIGludCB3YWl0X2Zvcl9lbmdpbmVzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQorc3RhdGljIGludCB3YWl0X2Zvcl9lbmdpbmVzKHN0cnVjdCBpbnRl
bF9ndCAqZ3QpCiB7Ci0JaWYgKHdhaXRfZm9yKGludGVsX2VuZ2luZXNfYXJlX2lkbGUoaTkxNSks
IEk5MTVfSURMRV9FTkdJTkVTX1RJTUVPVVQpKSB7Ci0JCWRldl9lcnIoaTkxNS0+ZHJtLmRldiwK
KwlpZiAod2FpdF9mb3IoaW50ZWxfZW5naW5lc19hcmVfaWRsZShndCksIEk5MTVfSURMRV9FTkdJ
TkVTX1RJTUVPVVQpKSB7CisJCWRldl9lcnIoZ3QtPmk5MTUtPmRybS5kZXYsCiAJCQkiRmFpbGVk
IHRvIGlkbGUgZW5naW5lcywgZGVjbGFyaW5nIHdlZGdlZCFcbiIpOwogCQlHRU1fVFJBQ0VfRFVN
UCgpOwotCQlpOTE1X2dlbV9zZXRfd2VkZ2VkKGk5MTUpOworCQlpbnRlbF9ndF9zZXRfd2VkZ2Vk
KGd0KTsKIAkJcmV0dXJuIC1FSU87CiAJfQogCkBAIC05NzEsNyArOTcxLDcgQEAgaW50IGk5MTVf
Z2VtX3dhaXRfZm9yX2lkbGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAKIAkJbG9j
a2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAKLQkJZXJyID0gd2Fp
dF9mb3JfZW5naW5lcyhpOTE1KTsKKwkJZXJyID0gd2FpdF9mb3JfZW5naW5lcygmaTkxNS0+Z3Qp
OwogCQlpZiAoZXJyKQogCQkJcmV0dXJuIGVycjsKIApAQCAtMTE0OSw4ICsxMTQ5LDggQEAgdm9p
ZCBpOTE1X2dlbV9zYW5pdGl6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkgKiBi
YWNrIHRvIGRlZmF1bHRzLCByZWNvdmVyaW5nIGZyb20gd2hhdGV2ZXIgd2VkZ2VkIHN0YXRlIHdl
IGxlZnQgaXQKIAkgKiBpbiBhbmQgc28gd29ydGggdHJ5aW5nIHRvIHVzZSB0aGUgZGV2aWNlIG9u
Y2UgbW9yZS4KIAkgKi8KLQlpZiAoaTkxNV90ZXJtaW5hbGx5X3dlZGdlZChpOTE1KSkKLQkJaTkx
NV9nZW1fdW5zZXRfd2VkZ2VkKGk5MTUpOworCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoJmk5MTUt
Pmd0KSkKKwkJaW50ZWxfZ3RfdW5zZXRfd2VkZ2VkKCZpOTE1LT5ndCk7CiAKIAkvKgogCSAqIElm
IHdlIGluaGVyaXQgY29udGV4dCBzdGF0ZSBmcm9tIHRoZSBCSU9TIG9yIGVhcmxpZXIgb2NjdXBh
bnRzCkBAIC0xMjAyLDcgKzEyMDIsNyBAQCBpbnQgaTkxNV9nZW1faW5pdF9odyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAlpbnQgcmV0OwogCiAJQlVHX09OKCFpOTE1LT5rZXJuZWxf
Y29udGV4dCk7Ci0JcmV0ID0gaTkxNV90ZXJtaW5hbGx5X3dlZGdlZChpOTE1KTsKKwlyZXQgPSBp
bnRlbF9ndF90ZXJtaW5hbGx5X3dlZGdlZChndCk7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsK
IApAQCAtMTM4NCw3ICsxMzg0LDcgQEAgc3RhdGljIGludCBfX2ludGVsX2VuZ2luZXNfcmVjb3Jk
X2RlZmF1bHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCSAqIGFuZCByZWFkeSB0
byBiZSB0b3JuLWRvd24uIFRoZSBxdWlja2VzdCB3YXkgd2UgY2FuIGFjY29tcGxpc2gKIAkgKiB0
aGlzIGlzIGJ5IGRlY2xhcmluZyBvdXJzZWx2ZXMgd2VkZ2VkLgogCSAqLwotCWk5MTVfZ2VtX3Nl
dF93ZWRnZWQoaTkxNSk7CisJaW50ZWxfZ3Rfc2V0X3dlZGdlZCgmaTkxNS0+Z3QpOwogCWdvdG8g
b3V0X2N0eDsKIH0KIApAQCAtMTUzOSw3ICsxNTM5LDcgQEAgaW50IGk5MTVfZ2VtX2luaXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogZXJyX2d0OgogCW11dGV4X3VubG9jaygm
ZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCi0JaTkxNV9nZW1fc2V0X3dlZGdlZChkZXZf
cHJpdik7CisJaW50ZWxfZ3Rfc2V0X3dlZGdlZCgmZGV2X3ByaXYtPmd0KTsKIAlpOTE1X2dlbV9z
dXNwZW5kKGRldl9wcml2KTsKIAlpOTE1X2dlbV9zdXNwZW5kX2xhdGUoZGV2X3ByaXYpOwogCkBA
IC0xNTgxLDEwICsxNTgxLDEwIEBAIGludCBpOTE1X2dlbV9pbml0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKIAkJICogd2VkZ2VkLiBCdXQgd2Ugb25seSB3YW50IHRvIGRvIHRo
aXMgd2hlcmUgdGhlIEdQVSBpcyBhbmdyeSwKIAkJICogZm9yIGFsbCBvdGhlciBmYWlsdXJlLCBz
dWNoIGFzIGFuIGFsbG9jYXRpb24gZmFpbHVyZSwgYmFpbC4KIAkJICovCi0JCWlmICghaTkxNV9y
ZXNldF9mYWlsZWQoZGV2X3ByaXYpKSB7CisJCWlmICghaW50ZWxfZ3RfaXNfd2VkZ2VkKCZkZXZf
cHJpdi0+Z3QpKSB7CiAJCQlpOTE1X3Byb2JlX2Vycm9yKGRldl9wcml2LAogCQkJCQkgIkZhaWxl
ZCB0byBpbml0aWFsaXplIEdQVSwgZGVjbGFyaW5nIGl0IHdlZGdlZCFcbiIpOwotCQkJaTkxNV9n
ZW1fc2V0X3dlZGdlZChkZXZfcHJpdik7CisJCQlpbnRlbF9ndF9zZXRfd2VkZ2VkKCZkZXZfcHJp
di0+Z3QpOwogCQl9CiAKIAkJLyogTWluaW1hbCBiYXNpYyByZWNvdmVyeSBmb3IgS01TICovCkBA
IC0xNjY2LDExICsxNjY2LDYgQEAgaW50IGk5MTVfZ2VtX2luaXRfZWFybHkoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQogCWk5MTVfZ2VtX2luaXRfX21tKGRldl9wcml2KTsKIAlp
OTE1X2dlbV9pbml0X19wbShkZXZfcHJpdik7CiAKLQlpbml0X3dhaXRxdWV1ZV9oZWFkKCZkZXZf
cHJpdi0+Z3B1X2Vycm9yLndhaXRfcXVldWUpOwotCWluaXRfd2FpdHF1ZXVlX2hlYWQoJmRldl9w
cml2LT5ncHVfZXJyb3IucmVzZXRfcXVldWUpOwotCW11dGV4X2luaXQoJmRldl9wcml2LT5ncHVf
ZXJyb3Iud2VkZ2VfbXV0ZXgpOwotCWluaXRfc3JjdV9zdHJ1Y3QoJmRldl9wcml2LT5ncHVfZXJy
b3IucmVzZXRfYmFja29mZl9zcmN1KTsKLQogCWF0b21pY19zZXQoJmRldl9wcml2LT5tbS5ic2Rf
ZW5naW5lX2Rpc3BhdGNoX2luZGV4LCAwKTsKIAogCXNwaW5fbG9ja19pbml0KCZkZXZfcHJpdi0+
ZmJfdHJhY2tpbmcubG9jayk7CkBAIC0xNjg5LDcgKzE2ODQsNyBAQCB2b2lkIGk5MTVfZ2VtX2Ns
ZWFudXBfZWFybHkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCUdFTV9CVUdf
T04oYXRvbWljX3JlYWQoJmRldl9wcml2LT5tbS5mcmVlX2NvdW50KSk7CiAJV0FSTl9PTihkZXZf
cHJpdi0+bW0uc2hyaW5rX2NvdW50KTsKIAotCWNsZWFudXBfc3JjdV9zdHJ1Y3QoJmRldl9wcml2
LT5ncHVfZXJyb3IucmVzZXRfYmFja29mZl9zcmN1KTsKKwlpbnRlbF9ndF9jbGVhbnVwX2Vhcmx5
KCZkZXZfcHJpdi0+Z3QpOwogCiAJaTkxNV9nZW1mc19maW5pKGRldl9wcml2KTsKIH0KZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmggYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5oCmluZGV4IDJlY2QwYzZhMWM5NC4uN2RmYmZkYTQ4
NzMzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5oCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmgKQEAgLTcsNiArNyw3IEBA
CiAjaWZuZGVmIF9JOTE1X0dQVV9FUlJPUl9IXwogI2RlZmluZSBfSTkxNV9HUFVfRVJST1JfSF8K
IAorI2luY2x1ZGUgPGxpbnV4L2F0b21pYy5oPgogI2luY2x1ZGUgPGxpbnV4L2tyZWYuaD4KICNp
bmNsdWRlIDxsaW51eC9rdGltZS5oPgogI2luY2x1ZGUgPGxpbnV4L3NjaGVkLmg+CkBAIC0xODAs
MTIgKzE4MSw2IEBAIHN0cnVjdCBpOTE1X2dwdV9zdGF0ZSB7CiB9OwogCiBzdHJ1Y3QgaTkxNV9n
cHVfZXJyb3IgewotCS8qIEZvciBoYW5nY2hlY2sgdGltZXIgKi8KLSNkZWZpbmUgRFJNX0k5MTVf
SEFOR0NIRUNLX1BFUklPRCAxNTAwIC8qIGluIG1zICovCi0jZGVmaW5lIERSTV9JOTE1X0hBTkdD
SEVDS19KSUZGSUVTIG1zZWNzX3RvX2ppZmZpZXMoRFJNX0k5MTVfSEFOR0NIRUNLX1BFUklPRCkK
LQotCXN0cnVjdCBkZWxheWVkX3dvcmsgaGFuZ2NoZWNrX3dvcms7Ci0KIAkvKiBGb3IgcmVzZXQg
YW5kIGVycm9yX3N0YXRlIGhhbmRsaW5nLiAqLwogCXNwaW5sb2NrX3QgbG9jazsKIAkvKiBQcm90
ZWN0ZWQgYnkgdGhlIGFib3ZlIGRldi0+Z3B1X2Vycm9yLmxvY2suICovCkBAIC0xOTMsNTIgKzE4
OCwxMSBAQCBzdHJ1Y3QgaTkxNV9ncHVfZXJyb3IgewogCiAJYXRvbWljX3QgcGVuZGluZ19mYl9w
aW47CiAKLQkvKioKLQkgKiBmbGFnczogQ29udHJvbCB2YXJpb3VzIHN0YWdlcyBvZiB0aGUgR1BV
IHJlc2V0Ci0JICoKLQkgKiAjSTkxNV9SRVNFVF9CQUNLT0ZGIC0gV2hlbiB3ZSBzdGFydCBhIGds
b2JhbCByZXNldCwgd2UgbmVlZCB0bwotCSAqIHNlcmlhbGlzZSB3aXRoIGFueSBvdGhlciB1c2Vy
cyBhdHRlbXB0aW5nIHRvIGRvIHRoZSBzYW1lLCBhbmQKLQkgKiBhbnkgZ2xvYmFsIHJlc291cmNl
cyB0aGF0IG1heSBiZSBjbG9iYmVyIGJ5IHRoZSByZXNldCAoc3VjaCBhcwotCSAqIEZFTkNFIHJl
Z2lzdGVycykuCi0JICoKLQkgKiAjSTkxNV9SRVNFVF9FTkdJTkVbbnVtX2VuZ2luZXNdIC0gU2lu
Y2UgdGhlIGRyaXZlciBkb2Vzbid0IG5lZWQgdG8KLQkgKiBhY3F1aXJlIHRoZSBzdHJ1Y3RfbXV0
ZXggdG8gcmVzZXQgYW4gZW5naW5lLCB3ZSBuZWVkIGFuIGV4cGxpY2l0Ci0JICogZmxhZyB0byBw
cmV2ZW50IHR3byBjb25jdXJyZW50IHJlc2V0IGF0dGVtcHRzIGluIHRoZSBzYW1lIGVuZ2luZS4K
LQkgKiBBcyB0aGUgbnVtYmVyIG9mIGVuZ2luZXMgY29udGludWVzIHRvIGdyb3csIGFsbG9jYXRl
IHRoZSBmbGFncyBmcm9tCi0JICogdGhlIG1vc3Qgc2lnbmlmaWNhbnQgYml0cy4KLQkgKgotCSAq
ICNJOTE1X1dFREdFRCAtIElmIHJlc2V0IGZhaWxzIGFuZCB3ZSBjYW4gbm8gbG9uZ2VyIHVzZSB0
aGUgR1BVLAotCSAqIHdlIHNldCB0aGUgI0k5MTVfV0VER0VEIGJpdC4gUHJpb3IgdG8gY29tbWFu
ZCBzdWJtaXNzaW9uLCBlLmcuCi0JICogaTkxNV9yZXF1ZXN0X2FsbG9jKCksIHRoaXMgYml0IGlz
IGNoZWNrZWQgYW5kIHRoZSBzZXF1ZW5jZQotCSAqIGFib3J0ZWQgKHdpdGggLUVJTyByZXBvcnRl
ZCB0byB1c2Vyc3BhY2UpIGlmIHNldC4KLQkgKi8KLQl1bnNpZ25lZCBsb25nIGZsYWdzOwotI2Rl
ZmluZSBJOTE1X1JFU0VUX0JBQ0tPRkYJMAotI2RlZmluZSBJOTE1X1JFU0VUX01PREVTRVQJMQot
I2RlZmluZSBJOTE1X1JFU0VUX0VOR0lORQkyCi0jZGVmaW5lIEk5MTVfV0VER0VECQkoQklUU19Q
RVJfTE9ORyAtIDEpCi0KIAkvKiogTnVtYmVyIG9mIHRpbWVzIHRoZSBkZXZpY2UgaGFzIGJlZW4g
cmVzZXQgKGdsb2JhbCkgKi8KLQl1MzIgcmVzZXRfY291bnQ7CisJYXRvbWljX3QgcmVzZXRfY291
bnQ7CiAKIAkvKiogTnVtYmVyIG9mIHRpbWVzIGFuIGVuZ2luZSBoYXMgYmVlbiByZXNldCAqLwot
CXUzMiByZXNldF9lbmdpbmVfY291bnRbSTkxNV9OVU1fRU5HSU5FU107Ci0KLQlzdHJ1Y3QgbXV0
ZXggd2VkZ2VfbXV0ZXg7IC8qIHNlcmlhbGlzZXMgd2VkZ2luZy91bndlZGdpbmcgKi8KLQotCS8q
KgotCSAqIFdhaXRxdWV1ZSB0byBzaWduYWwgd2hlbiBhIGhhbmcgaXMgZGV0ZWN0ZWQuIFVzZWQg
dG8gZm9yIHdhaXRlcnMKLQkgKiB0byByZWxlYXNlIHRoZSBzdHJ1Y3RfbXV0ZXggZm9yIHRoZSBy
ZXNldCB0byBwcm9jZWRlLgotCSAqLwotCXdhaXRfcXVldWVfaGVhZF90IHdhaXRfcXVldWU7Ci0K
LQkvKioKLQkgKiBXYWl0cXVldWUgdG8gc2lnbmFsIHdoZW4gdGhlIHJlc2V0IGhhcyBjb21wbGV0
ZWQuIFVzZWQgYnkgY2xpZW50cwotCSAqIHRoYXQgd2FpdCBmb3IgZGV2X3ByaXYtPm1tLndlZGdl
ZCB0byBzZXR0bGUuCi0JICovCi0Jd2FpdF9xdWV1ZV9oZWFkX3QgcmVzZXRfcXVldWU7Ci0KLQlz
dHJ1Y3Qgc3JjdV9zdHJ1Y3QgcmVzZXRfYmFja29mZl9zcmN1OworCWF0b21pY190IHJlc2V0X2Vu
Z2luZV9jb3VudFtJOTE1X05VTV9FTkdJTkVTXTsKIH07CiAKIHN0cnVjdCBkcm1faTkxNV9lcnJv
cl9zdGF0ZV9idWYgewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1
ZXN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYwppbmRleCAyMjJjOWM1
NmU5ZGUuLjhhYzdkMTRlYzhjOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9yZXF1ZXN0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMKQEAg
LTE0MDEsOCArMTQwMSw3IEBAIGxvbmcgaTkxNV9yZXF1ZXN0X3dhaXQoc3RydWN0IGk5MTVfcmVx
dWVzdCAqcnEsCiAJICogc2VyaWFsaXNlIHdhaXQvcmVzZXQgd2l0aCBhbiBleHBsaWNpdCBsb2Nr
LCB3ZSBkbyB3YW50CiAJICogbG9ja2RlcCB0byBkZXRlY3QgcG90ZW50aWFsIGRlcGVuZGVuY3kg
Y3ljbGVzLgogCSAqLwotCW11dGV4X2FjcXVpcmUoJnJxLT5pOTE1LT5ncHVfZXJyb3Iud2VkZ2Vf
bXV0ZXguZGVwX21hcCwKLQkJICAgICAgMCwgMCwgX1RISVNfSVBfKTsKKwltdXRleF9hY3F1aXJl
KCZycS0+ZW5naW5lLT5ndC0+cmVzZXQubXV0ZXguZGVwX21hcCwgMCwgMCwgX1RISVNfSVBfKTsK
IAogCS8qCiAJICogT3B0aW1pc3RpYyBzcGluIGJlZm9yZSB0b3VjaGluZyBJUlFzLgpAQCAtMTQ4
MCw3ICsxNDc5LDcgQEAgbG9uZyBpOTE1X3JlcXVlc3Rfd2FpdChzdHJ1Y3QgaTkxNV9yZXF1ZXN0
ICpycSwKIAlkbWFfZmVuY2VfcmVtb3ZlX2NhbGxiYWNrKCZycS0+ZmVuY2UsICZ3YWl0LmNiKTsK
IAogb3V0OgotCW11dGV4X3JlbGVhc2UoJnJxLT5pOTE1LT5ncHVfZXJyb3Iud2VkZ2VfbXV0ZXgu
ZGVwX21hcCwgMCwgX1RISVNfSVBfKTsKKwltdXRleF9yZWxlYXNlKCZycS0+ZW5naW5lLT5ndC0+
cmVzZXQubXV0ZXguZGVwX21hcCwgMCwgX1RISVNfSVBfKTsKIAl0cmFjZV9pOTE1X3JlcXVlc3Rf
d2FpdF9lbmQocnEpOwogCXJldHVybiB0aW1lb3V0OwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9zZWxmdGVzdC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9z
ZWxmdGVzdC5oCmluZGV4IGQ5YjE3YjllNjk5My4uYWNkZjZlYjllMjYyIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3NlbGZ0ZXN0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9zZWxmdGVzdC5oCkBAIC03Miw2ICs3Miw5IEBAIGludCBfX2k5MTVfbm9wX3Rl
YXJkb3duKGludCBlcnIsIHZvaWQgKmRhdGEpOwogaW50IF9faTkxNV9saXZlX3NldHVwKHZvaWQg
KmRhdGEpOwogaW50IF9faTkxNV9saXZlX3RlYXJkb3duKGludCBlcnIsIHZvaWQgKmRhdGEpOwog
CitpbnQgX19pbnRlbF9ndF9saXZlX3NldHVwKHZvaWQgKmRhdGEpOworaW50IF9faW50ZWxfZ3Rf
bGl2ZV90ZWFyZG93bihpbnQgZXJyLCB2b2lkICpkYXRhKTsKKwogaW50IF9faTkxNV9zdWJ0ZXN0
cyhjb25zdCBjaGFyICpjYWxsZXIsCiAJCSAgICBpbnQgKCpzZXR1cCkodm9pZCAqZGF0YSksCiAJ
CSAgICBpbnQgKCp0ZWFyZG93bikoaW50IGVyciwgdm9pZCAqZGF0YSksCkBAIC04OCw2ICs5MSwx
MiBAQCBpbnQgX19pOTE1X3N1YnRlc3RzKGNvbnN0IGNoYXIgKmNhbGxlciwKIAkJCV9faTkxNV9s
aXZlX3NldHVwLCBfX2k5MTVfbGl2ZV90ZWFyZG93biwgXAogCQkJVCwgQVJSQVlfU0laRShUKSwg
ZGF0YSk7IFwKIH0pCisjZGVmaW5lIGludGVsX2d0X2xpdmVfc3VidGVzdHMoVCwgZGF0YSkgKHsg
XAorCXR5cGVjaGVjayhzdHJ1Y3QgaW50ZWxfZ3QgKiwgZGF0YSk7IFwKKwlfX2k5MTVfc3VidGVz
dHMoX19mdW5jX18sIFwKKwkJCV9faW50ZWxfZ3RfbGl2ZV9zZXR1cCwgX19pbnRlbF9ndF9saXZl
X3RlYXJkb3duLCBcCisJCQlULCBBUlJBWV9TSVpFKFQpLCBkYXRhKTsgXAorfSkKIAogI2RlZmlu
ZSBTVUJURVNUKHgpIHsgeCwgI3ggfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9ndWNfc3VibWlzc2lvbi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3Vj
X3N1Ym1pc3Npb24uYwppbmRleCBiNjYzYjVmZTUxYTguLmQ4NjMzNmFhNDE3OCAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfc3VibWlzc2lvbi5jCkBAIC02NjcsNyArNjY3LDcg
QEAgc3RhdGljIHZvaWQgZ3VjX3Jlc2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwg
Ym9vbCBzdGFsbGVkKQogCWlmICghaTkxNV9yZXF1ZXN0X3N0YXJ0ZWQocnEpKQogCQlzdGFsbGVk
ID0gZmFsc2U7CiAKLQlpOTE1X3Jlc2V0X3JlcXVlc3QocnEsIHN0YWxsZWQpOworCV9faTkxNV9y
ZXF1ZXN0X3Jlc2V0KHJxLCBzdGFsbGVkKTsKIAlpbnRlbF9scl9jb250ZXh0X3Jlc2V0KGVuZ2lu
ZSwgcnEtPmh3X2NvbnRleHQsIHJxLT5oZWFkLCBzdGFsbGVkKTsKIAogb3V0X3VubG9jazoKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3VjLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF91Yy5jCmluZGV4IDcyYmJjYjI1OTdmZC4uYmM1ODllZmQzYTZkIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91Yy5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX3VjLmMKQEAgLTM4LDcgKzM4LDcgQEAgc3RhdGljIGludCBfX2ludGVs
X3VjX3Jlc2V0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlpbnQgcmV0
OwogCXUzMiBndWNfc3RhdHVzOwogCi0JcmV0ID0gaW50ZWxfcmVzZXRfZ3VjKGRldl9wcml2KTsK
KwlyZXQgPSBpbnRlbF9yZXNldF9ndWMoJmRldl9wcml2LT5ndCk7CiAJaWYgKHJldCkgewogCQlE
Uk1fRVJST1IoIkZhaWxlZCB0byByZXNldCBHdUMsIHJldCA9ICVkXG4iLCByZXQpOwogCQlyZXR1
cm4gcmV0OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVf
YWN0aXZlLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9hY3RpdmUuYwpp
bmRleCA4NGZjZTM3OWMwZGUuLmU1Y2Q1ZDQ3ZTM4MCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfYWN0aXZlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvc2VsZnRlc3RzL2k5MTVfYWN0aXZlLmMKQEAgLTcsNiArNyw3IEBACiAjaW5jbHVkZSA8bGlu
dXgva3JlZi5oPgogCiAjaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX3BtLmgiCisjaW5jbHVkZSAiZ3Qv
aW50ZWxfZ3QuaCIKIAogI2luY2x1ZGUgImk5MTVfc2VsZnRlc3QuaCIKIApAQCAtMjIxLDcgKzIy
Miw3IEBAIGludCBpOTE1X2FjdGl2ZV9saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKIAkJU1VCVEVTVChsaXZlX2FjdGl2ZV9yZXRpcmUpLAogCX07CiAKLQlpZiAo
aTkxNV90ZXJtaW5hbGx5X3dlZGdlZChpOTE1KSkKKwlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKCZp
OTE1LT5ndCkpCiAJCXJldHVybiAwOwogCiAJcmV0dXJuIGk5MTVfc3VidGVzdHModGVzdHMsIGk5
MTUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2Vt
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW0uYwppbmRleCBiOGZm
YWU0ODE3MzAuLmJiNmRkNTRhNmZmMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
c2VsZnRlc3RzL2k5MTVfZ2VtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3Rz
L2k5MTVfZ2VtLmMKQEAgLTgsNiArOCw3IEBACiAKICNpbmNsdWRlICJnZW0vc2VsZnRlc3RzL2ln
dF9nZW1fdXRpbHMuaCIKICNpbmNsdWRlICJnZW0vc2VsZnRlc3RzL21vY2tfY29udGV4dC5oIgor
I2luY2x1ZGUgImd0L2ludGVsX2d0LmgiCiAKICNpbmNsdWRlICJpOTE1X3NlbGZ0ZXN0LmgiCiAK
QEAgLTIwNiw3ICsyMDcsNyBAQCBpbnQgaTkxNV9nZW1fbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJCVNVQlRFU1QoaWd0X2dlbV9oaWJlcm5hdGUpLAogCX07
CiAKLQlpZiAoaTkxNV90ZXJtaW5hbGx5X3dlZGdlZChpOTE1KSkKKwlpZiAoaW50ZWxfZ3RfaXNf
d2VkZ2VkKCZpOTE1LT5ndCkpCiAJCXJldHVybiAwOwogCiAJcmV0dXJuIGk5MTVfbGl2ZV9zdWJ0
ZXN0cyh0ZXN0cywgaTkxNSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxm
dGVzdHMvaTkxNV9nZW1fZXZpY3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9p
OTE1X2dlbV9ldmljdC5jCmluZGV4IGEzY2IwYWFkZTZmMS4uYjY0NDlkMGE4YzE3IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZXZpY3QuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZXZpY3QuYwpAQCAtMjUs
NiArMjUsNyBAQAogI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9wbS5oIgogI2luY2x1ZGUgImdlbS9z
ZWxmdGVzdHMvaWd0X2dlbV91dGlscy5oIgogI2luY2x1ZGUgImdlbS9zZWxmdGVzdHMvbW9ja19j
b250ZXh0LmgiCisjaW5jbHVkZSAiZ3QvaW50ZWxfZ3QuaCIKIAogI2luY2x1ZGUgImk5MTVfc2Vs
ZnRlc3QuaCIKIApAQCAtNTU3LDcgKzU1OCw3IEBAIGludCBpOTE1X2dlbV9ldmljdF9saXZlX3Nl
bGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkJU1VCVEVTVChpZ3RfZXZp
Y3RfY29udGV4dHMpLAogCX07CiAKLQlpZiAoaTkxNV90ZXJtaW5hbGx5X3dlZGdlZChpOTE1KSkK
KwlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKCZpOTE1LT5ndCkpCiAJCXJldHVybiAwOwogCiAJcmV0
dXJuIGk5MTVfc3VidGVzdHModGVzdHMsIGk5MTUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfcmVxdWVzdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
c2VsZnRlc3RzL2k5MTVfcmVxdWVzdC5jCmluZGV4IDFiYmZjNDNkNGE5ZS4uODZjMjk5NjYzOTM0
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9yZXF1ZXN0
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfcmVxdWVzdC5jCkBA
IC0zODAsNyArMzgwLDcgQEAgc3RhdGljIGludCBfX2lndF9icmVhZGNydW1ic19zbW9rZXRlc3Qo
dm9pZCAqYXJnKQogCQkJICAgICAgIHQtPmVuZ2luZS0+bmFtZSk7CiAJCQlHRU1fVFJBQ0VfRFVN
UCgpOwogCi0JCQlpOTE1X2dlbV9zZXRfd2VkZ2VkKHQtPmVuZ2luZS0+aTkxNSk7CisJCQlpbnRl
bF9ndF9zZXRfd2VkZ2VkKHQtPmVuZ2luZS0+Z3QpOwogCQkJR0VNX0JVR19PTighaTkxNV9yZXF1
ZXN0X2NvbXBsZXRlZChycSkpOwogCQkJaTkxNV9zd19mZW5jZV93YWl0KHdhaXQpOwogCQkJZXJy
ID0gLUVJTzsKQEAgLTEyMzQsNyArMTIzNCw3IEBAIGludCBpOTE1X3JlcXVlc3RfbGl2ZV9zZWxm
dGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJCVNVQlRFU1QobGl2ZV9icmVh
ZGNydW1ic19zbW9rZXRlc3QpLAogCX07CiAKLQlpZiAoaTkxNV90ZXJtaW5hbGx5X3dlZGdlZChp
OTE1KSkKKwlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKCZpOTE1LT5ndCkpCiAJCXJldHVybiAwOwog
CiAJcmV0dXJuIGk5MTVfc3VidGVzdHModGVzdHMsIGk5MTUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfc2VsZnRlc3QuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3NlbGZ0ZXN0LmMKaW5kZXggZjQ2Y2NmODE3YWQ1Li5kYjlj
NjQ1YmJkZmUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1
X3NlbGZ0ZXN0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfc2Vs
ZnRlc3QuYwpAQCAtMjU2LDcgKzI1Niw3IEBAIGludCBfX2k5MTVfbGl2ZV9zZXR1cCh2b2lkICpk
YXRhKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZGF0YTsKIAotCXJldHVy
biBpOTE1X3Rlcm1pbmFsbHlfd2VkZ2VkKGk5MTUpOworCXJldHVybiBpbnRlbF9ndF90ZXJtaW5h
bGx5X3dlZGdlZCgmaTkxNS0+Z3QpOwogfQogCiBpbnQgX19pOTE1X2xpdmVfdGVhcmRvd24oaW50
IGVyciwgdm9pZCAqZGF0YSkKQEAgLTI3Myw2ICsyNzMsMjcgQEAgaW50IF9faTkxNV9saXZlX3Rl
YXJkb3duKGludCBlcnIsIHZvaWQgKmRhdGEpCiAJcmV0dXJuIGVycjsKIH0KIAoraW50IF9faW50
ZWxfZ3RfbGl2ZV9zZXR1cCh2b2lkICpkYXRhKQoreworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBk
YXRhOworCisJcmV0dXJuIGludGVsX2d0X3Rlcm1pbmFsbHlfd2VkZ2VkKGd0KTsKK30KKworaW50
IF9faW50ZWxfZ3RfbGl2ZV90ZWFyZG93bihpbnQgZXJyLCB2b2lkICpkYXRhKQoreworCXN0cnVj
dCBpbnRlbF9ndCAqZ3QgPSBkYXRhOworCisJbXV0ZXhfbG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1
Y3RfbXV0ZXgpOworCWlmIChpZ3RfZmx1c2hfdGVzdChndC0+aTkxNSwgSTkxNV9XQUlUX0xPQ0tF
RCkpCisJCWVyciA9IC1FSU87CisJbXV0ZXhfdW5sb2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9t
dXRleCk7CisKKwlpOTE1X2dlbV9kcmFpbl9mcmVlZF9vYmplY3RzKGd0LT5pOTE1KTsKKworCXJl
dHVybiBlcnI7Cit9CisKIGludCBfX2k5MTVfc3VidGVzdHMoY29uc3QgY2hhciAqY2FsbGVyLAog
CQkgICAgaW50ICgqc2V0dXApKHZvaWQgKmRhdGEpLAogCQkgICAgaW50ICgqdGVhcmRvd24pKGlu
dCBlcnIsIHZvaWQgKmRhdGEpLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2Vs
ZnRlc3RzL2lndF9mbHVzaF90ZXN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMv
aWd0X2ZsdXNoX3Rlc3QuYwppbmRleCA1YmZkMWIyNjI2YTIuLmQzYjVlYjQwMmQzMyAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2lndF9mbHVzaF90ZXN0LmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2lndF9mbHVzaF90ZXN0LmMKQEAgLTUs
NiArNSw3IEBACiAgKi8KIAogI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9jb250ZXh0LmgiCisjaW5j
bHVkZSAiZ3QvaW50ZWxfZ3QuaCIKIAogI2luY2x1ZGUgImk5MTVfZHJ2LmgiCiAjaW5jbHVkZSAi
aTkxNV9zZWxmdGVzdC5oIgpAQCAtMTMsNyArMTQsNyBAQAogCiBpbnQgaWd0X2ZsdXNoX3Rlc3Qo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHVuc2lnbmVkIGludCBmbGFncykKIHsKLQlp
bnQgcmV0ID0gaTkxNV90ZXJtaW5hbGx5X3dlZGdlZChpOTE1KSA/IC1FSU8gOiAwOworCWludCBy
ZXQgPSBpbnRlbF9ndF9pc193ZWRnZWQoJmk5MTUtPmd0KSA/IC1FSU8gOiAwOwogCWludCByZXBl
YXQgPSAhIShmbGFncyAmIEk5MTVfV0FJVF9MT0NLRUQpOwogCiAJY29uZF9yZXNjaGVkKCk7CkBA
IC0yNyw3ICsyOCw3IEBAIGludCBpZ3RfZmx1c2hfdGVzdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwgdW5zaWduZWQgaW50IGZsYWdzKQogCQkJCSAgX19idWlsdGluX3JldHVybl9hZGRy
ZXNzKDApKTsKIAkJCUdFTV9UUkFDRV9EVU1QKCk7CiAKLQkJCWk5MTVfZ2VtX3NldF93ZWRnZWQo
aTkxNSk7CisJCQlpbnRlbF9ndF9zZXRfd2VkZ2VkKCZpOTE1LT5ndCk7CiAJCQlyZXBlYXQgPSAw
OwogCQkJcmV0ID0gLUVJTzsKIAkJfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
c2VsZnRlc3RzL2lndF9yZXNldC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2ln
dF9yZXNldC5jCmluZGV4IDU4N2RmNmZkNGZmZS4uN2VjOGY4YjA0OWM2IDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaWd0X3Jlc2V0LmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvc2VsZnRlc3RzL2lndF9yZXNldC5jCkBAIC03LDQ3ICs3LDQ1IEBACiAjaW5j
bHVkZSAiaWd0X3Jlc2V0LmgiCiAKICNpbmNsdWRlICJndC9pbnRlbF9lbmdpbmUuaCIKKyNpbmNs
dWRlICJndC9pbnRlbF9ndC5oIgogCiAjaW5jbHVkZSAiLi4vaTkxNV9kcnYuaCIKIAotdm9pZCBp
Z3RfZ2xvYmFsX3Jlc2V0X2xvY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCit2b2lk
IGlndF9nbG9iYWxfcmVzZXRfbG9jayhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewogCXN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKIAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKIAotCXBy
X2RlYnVnKCIlczogY3VycmVudCBncHVfZXJyb3I9JTA4bHhcbiIsCi0JCSBfX2Z1bmNfXywgaTkx
NS0+Z3B1X2Vycm9yLmZsYWdzKTsKKwlwcl9kZWJ1ZygiJXM6IGN1cnJlbnQgZ3B1X2Vycm9yPSUw
OGx4XG4iLCBfX2Z1bmNfXywgZ3QtPnJlc2V0LmZsYWdzKTsKIAotCXdoaWxlICh0ZXN0X2FuZF9z
ZXRfYml0KEk5MTVfUkVTRVRfQkFDS09GRiwgJmk5MTUtPmdwdV9lcnJvci5mbGFncykpCi0JCXdh
aXRfZXZlbnQoaTkxNS0+Z3B1X2Vycm9yLnJlc2V0X3F1ZXVlLAotCQkJICAgIXRlc3RfYml0KEk5
MTVfUkVTRVRfQkFDS09GRiwKLQkJCQkgICAgICZpOTE1LT5ncHVfZXJyb3IuZmxhZ3MpKTsKKwl3
aGlsZSAodGVzdF9hbmRfc2V0X2JpdChJOTE1X1JFU0VUX0JBQ0tPRkYsICZndC0+cmVzZXQuZmxh
Z3MpKQorCQl3YWl0X2V2ZW50KGd0LT5yZXNldC5xdWV1ZSwKKwkJCSAgICF0ZXN0X2JpdChJOTE1
X1JFU0VUX0JBQ0tPRkYsICZndC0+cmVzZXQuZmxhZ3MpKTsKIAotCWZvcl9lYWNoX2VuZ2luZShl
bmdpbmUsIGk5MTUsIGlkKSB7CisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QtPmk5MTUsIGlk
KSB7CiAJCXdoaWxlICh0ZXN0X2FuZF9zZXRfYml0KEk5MTVfUkVTRVRfRU5HSU5FICsgaWQsCi0J
CQkJCSZpOTE1LT5ncHVfZXJyb3IuZmxhZ3MpKQotCQkJd2FpdF9vbl9iaXQoJmk5MTUtPmdwdV9l
cnJvci5mbGFncywKLQkJCQkgICAgSTkxNV9SRVNFVF9FTkdJTkUgKyBpZCwKKwkJCQkJJmd0LT5y
ZXNldC5mbGFncykpCisJCQl3YWl0X29uX2JpdCgmZ3QtPnJlc2V0LmZsYWdzLCBJOTE1X1JFU0VU
X0VOR0lORSArIGlkLAogCQkJCSAgICBUQVNLX1VOSU5URVJSVVBUSUJMRSk7CiAJfQogfQogCi12
b2lkIGlndF9nbG9iYWxfcmVzZXRfdW5sb2NrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQordm9pZCBpZ3RfZ2xvYmFsX3Jlc2V0X3VubG9jayhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewog
CXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKIAllbnVtIGludGVsX2VuZ2luZV9pZCBp
ZDsKIAotCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKQotCQljbGVhcl9iaXQoSTkx
NV9SRVNFVF9FTkdJTkUgKyBpZCwgJmk5MTUtPmdwdV9lcnJvci5mbGFncyk7CisJZm9yX2VhY2hf
ZW5naW5lKGVuZ2luZSwgZ3QtPmk5MTUsIGlkKQorCQljbGVhcl9iaXQoSTkxNV9SRVNFVF9FTkdJ
TkUgKyBpZCwgJmd0LT5yZXNldC5mbGFncyk7CiAKLQljbGVhcl9iaXQoSTkxNV9SRVNFVF9CQUNL
T0ZGLCAmaTkxNS0+Z3B1X2Vycm9yLmZsYWdzKTsKLQl3YWtlX3VwX2FsbCgmaTkxNS0+Z3B1X2Vy
cm9yLnJlc2V0X3F1ZXVlKTsKKwljbGVhcl9iaXQoSTkxNV9SRVNFVF9CQUNLT0ZGLCAmZ3QtPnJl
c2V0LmZsYWdzKTsKKwl3YWtlX3VwX2FsbCgmZ3QtPnJlc2V0LnF1ZXVlKTsKIH0KIAotYm9vbCBp
Z3RfZm9yY2VfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCitib29sIGlndF9m
b3JjZV9yZXNldChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewotCWk5MTVfZ2VtX3NldF93ZWRnZWQo
aTkxNSk7Ci0JaTkxNV9yZXNldChpOTE1LCAwLCBOVUxMKTsKKwlpbnRlbF9ndF9zZXRfd2VkZ2Vk
KGd0KTsKKwlpbnRlbF9ndF9yZXNldChndCwgMCwgTlVMTCk7CiAKLQlyZXR1cm4gIWk5MTVfcmVz
ZXRfZmFpbGVkKGk5MTUpOworCXJldHVybiAhaW50ZWxfZ3RfaXNfd2VkZ2VkKGd0KTsKIH0KZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pZ3RfcmVzZXQuaCBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pZ3RfcmVzZXQuaAppbmRleCAzNjNiZDg1M2U1
MGYuLjg1MTg3M2I2N2FiMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRl
c3RzL2lndF9yZXNldC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pZ3Rf
cmVzZXQuaApAQCAtNywxMCArNywxMiBAQAogI2lmbmRlZiBfX0k5MTVfU0VMRlRFU1RTX0lHVF9S
RVNFVF9IX18KICNkZWZpbmUgX19JOTE1X1NFTEZURVNUU19JR1RfUkVTRVRfSF9fCiAKLSNpbmNs
dWRlICIuLi9pOTE1X2Rydi5oIgorI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CiAKLXZvaWQgaWd0
X2dsb2JhbF9yZXNldF9sb2NrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKLXZvaWQg
aWd0X2dsb2JhbF9yZXNldF91bmxvY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwot
Ym9vbCBpZ3RfZm9yY2VfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOworc3Ry
dWN0IGludGVsX2d0OworCit2b2lkIGlndF9nbG9iYWxfcmVzZXRfbG9jayhzdHJ1Y3QgaW50ZWxf
Z3QgKmd0KTsKK3ZvaWQgaWd0X2dsb2JhbF9yZXNldF91bmxvY2soc3RydWN0IGludGVsX2d0ICpn
dCk7Citib29sIGlndF9mb3JjZV9yZXNldChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIAogI2VuZGlm
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaWd0X3dlZGdlX21l
LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaWd0X3dlZGdlX21lLmgKZGVsZXRl
ZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDA4ZTVmZjExYmJkOS4uMDAwMDAwMDAwMDAwCi0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pZ3Rfd2VkZ2VfbWUuaAorKysgL2Rldi9u
dWxsCkBAIC0xLDU4ICswLDAgQEAKLS8qCi0gKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlU
Ci0gKgotICogQ29weXJpZ2h0IMKpIDIwMTggSW50ZWwgQ29ycG9yYXRpb24KLSAqLwotCi0jaWZu
ZGVmIElHVF9XRURHRV9NRV9ICi0jZGVmaW5lIElHVF9XRURHRV9NRV9ICi0KLSNpbmNsdWRlIDxs
aW51eC93b3JrcXVldWUuaD4KLQotI2luY2x1ZGUgIi4uL2k5MTVfZ2VtLmgiCi0KLXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlOwotCi1zdHJ1Y3QgaWd0X3dlZGdlX21lIHsKLQlzdHJ1Y3QgZGVsYXll
ZF93b3JrIHdvcms7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTU7Ci0JY29uc3QgY2hh
ciAqbmFtZTsKLX07Ci0KLXN0YXRpYyB2b2lkIF9faWd0X3dlZGdlX21lKHN0cnVjdCB3b3JrX3N0
cnVjdCAqd29yaykKLXsKLQlzdHJ1Y3QgaWd0X3dlZGdlX21lICp3ID0gY29udGFpbmVyX29mKHdv
cmssIHR5cGVvZigqdyksIHdvcmsud29yayk7Ci0KLQlwcl9lcnIoIiVzIHRpbWVkIG91dCwgY2Fu
Y2VsbGluZyB0ZXN0LlxuIiwgdy0+bmFtZSk7Ci0KLQlHRU1fVFJBQ0UoIiVzIHRpbWVkIG91dC5c
biIsIHctPm5hbWUpOwotCUdFTV9UUkFDRV9EVU1QKCk7Ci0KLQlpOTE1X2dlbV9zZXRfd2VkZ2Vk
KHctPmk5MTUpOwotfQotCi1zdGF0aWMgdm9pZCBfX2lndF9pbml0X3dlZGdlKHN0cnVjdCBpZ3Rf
d2VkZ2VfbWUgKncsCi0JCQkgICAgIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAotCQkJ
ICAgICBsb25nIHRpbWVvdXQsCi0JCQkgICAgIGNvbnN0IGNoYXIgKm5hbWUpCi17Ci0Jdy0+aTkx
NSA9IGk5MTU7Ci0Jdy0+bmFtZSA9IG5hbWU7Ci0KLQlJTklUX0RFTEFZRURfV09SS19PTlNUQUNL
KCZ3LT53b3JrLCBfX2lndF93ZWRnZV9tZSk7Ci0Jc2NoZWR1bGVfZGVsYXllZF93b3JrKCZ3LT53
b3JrLCB0aW1lb3V0KTsKLX0KLQotc3RhdGljIHZvaWQgX19pZ3RfZmluaV93ZWRnZShzdHJ1Y3Qg
aWd0X3dlZGdlX21lICp3KQotewotCWNhbmNlbF9kZWxheWVkX3dvcmtfc3luYygmdy0+d29yayk7
Ci0JZGVzdHJveV9kZWxheWVkX3dvcmtfb25fc3RhY2soJnctPndvcmspOwotCXctPmk5MTUgPSBO
VUxMOwotfQotCi0jZGVmaW5lIGlndF93ZWRnZV9vbl90aW1lb3V0KFcsIERFViwgVElNRU9VVCkJ
CQkJXAotCWZvciAoX19pZ3RfaW5pdF93ZWRnZSgoVyksIChERVYpLCAoVElNRU9VVCksIF9fZnVu
Y19fKTsJCVwKLQkgICAgIChXKS0+aTkxNTsJCQkJCQkJXAotCSAgICAgX19pZ3RfZmluaV93ZWRn
ZSgoVykpKQotCi0jZW5kaWYgLyogSUdUX1dFREdFX01FX0ggKi8KZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2dlbV9kZXZpY2UuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2dlbV9kZXZpY2UuYwppbmRleCAyNzQxODA1YjU2YzIu
LmZkNGNjNDgwOWViOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3Rz
L21vY2tfZ2VtX2RldmljZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9t
b2NrX2dlbV9kZXZpY2UuYwpAQCAtMTgzLDExICsxODMsNiBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqbW9ja19nZW1fZGV2aWNlKHZvaWQpCiAJaW50ZWxfZ3RfaW5pdF9lYXJseSgmaTkxNS0+
Z3QsIGk5MTUpOwogCWF0b21pY19pbmMoJmk5MTUtPmd0Lndha2VyZWYuY291bnQpOyAvKiBkaXNh
YmxlOyBubyBodyBzdXBwb3J0ICovCiAKLQlpbml0X3dhaXRxdWV1ZV9oZWFkKCZpOTE1LT5ncHVf
ZXJyb3Iud2FpdF9xdWV1ZSk7Ci0JaW5pdF93YWl0cXVldWVfaGVhZCgmaTkxNS0+Z3B1X2Vycm9y
LnJlc2V0X3F1ZXVlKTsKLQlpbml0X3NyY3Vfc3RydWN0KCZpOTE1LT5ncHVfZXJyb3IucmVzZXRf
YmFja29mZl9zcmN1KTsKLQltdXRleF9pbml0KCZpOTE1LT5ncHVfZXJyb3Iud2VkZ2VfbXV0ZXgp
OwotCiAJaTkxNS0+d3EgPSBhbGxvY19vcmRlcmVkX3dvcmtxdWV1ZSgibW9jayIsIDApOwogCWlm
ICghaTkxNS0+d3EpCiAJCWdvdG8gZXJyX2RydjsKLS0gCjIuMjIuMAoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJ
bnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Au
b3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 9AC6712512A
	for <lists+intel-gfx@lfdr.de>; Wed, 18 Dec 2019 19:59:33 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F21AF6EA52;
	Wed, 18 Dec 2019 18:59:31 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga05.intel.com (mga05.intel.com [192.55.52.43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id D543D6EA52
 for <intel-gfx@lists.freedesktop.org>; Wed, 18 Dec 2019 18:59:25 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga001.jf.intel.com ([10.7.209.18])
 by fmsmga105.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 18 Dec 2019 10:59:25 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.69,330,1571727600"; d="scan'208";a="298470980"
Received: from jsundar1-mobl1.amr.corp.intel.com (HELO
 josouza-MOBL.amr.corp.intel.com) ([10.254.71.190])
 by orsmga001.jf.intel.com with ESMTP; 18 Dec 2019 10:59:23 -0800
From: =?UTF-8?q?Jos=C3=A9=20Roberto=20de=20Souza?= <jose.souza@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 18 Dec 2019 10:59:09 -0800
Message-Id: <20191218185910.303540-5-jose.souza@intel.com>
X-Mailer: git-send-email 2.24.1
In-Reply-To: <20191218185910.303540-1-jose.souza@intel.com>
References: <20191218185910.303540-1-jose.souza@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v4 5/6] drm/i915/display: Check if pipe fastset
 is allowed by external dependencies
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Lucas De Marchi <lucas.demarchi@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Q2hlY2sgaWYgZmFzdHNldCBpcyBhbGxvd2VkIGJ5IGV4dGVybmFsIGRlcGVuZGVuY2llcyBsaWtl
IG90aGVyIHBpcGVzCmFuZCB0cmFuc2NvZGVycy4KClJpZ2h0IG5vdyB0aGlzIHBhdGNoIG9ubHkg
Zm9yY2VzIGEgZnVsbG1vZGVzZXQgaW4gTVNUIHNsYXZlcyBvZiBNU1QKbWFzdGVycyB0aGF0IG5l
ZWRzIGEgZnVsbG1vZGVzZXQgYnV0IGl0IHdpbGwgYmUgbmVlZGVkIGZvciBwb3J0IHN5bmMKYXMg
d2VsbC4KCnYzOgotIG1vdmVkIGhhbmRsaW5nIHRvIGludGVsX2F0b21pY19jaGVjaygpIHRoaXMg
d2F5IGlzIGd1YXJhbnRlZSB0aGF0CmFsbCBwaXBlcyB3aWxsIGhhdmUgaXRzIHN0YXRlIGNvbXB1
dGVkCgp2NDoKLSBhZGRlZCBhIGZ1bmN0aW9uIHRvIHJldHVybiBpZiBNU1QgbWFzdGVyIG5lZWVk
cyBtb2Rlc2V0IHRvIHNpbXBseQpjb2RlIGluIGludGVsX2F0b21pY19jaGVjaygpCgpDYzogVmls
bGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KQ2M6IEx1Y2FzIERl
IE1hcmNoaSA8bHVjYXMuZGVtYXJjaGlAaW50ZWwuY29tPgpDYzogTWFhcnRlbiBMYW5raG9yc3Qg
PG1hYXJ0ZW4ubGFua2hvcnN0QGxpbnV4LmludGVsLmNvbT4KQ2M6IE1hbmFzaSBOYXZhcmUgPG1h
bmFzaS5kLm5hdmFyZUBpbnRlbC5jb20+ClNpZ25lZC1vZmYtYnk6IEpvc8OpIFJvYmVydG8gZGUg
U291emEgPGpvc2Uuc291emFAaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfZGlzcGxheS5jIHwgNTMgKysrKysrKysrKysrKysrLS0tLS0KIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHBfbXN0LmMgIHwgMTQgKysrKysrCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwX21zdC5oICB8ICAzICsrCiAzIGZpbGVzIGNo
YW5nZWQsIDU3IGluc2VydGlvbnMoKyksIDEzIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKaW5kZXggYTRmMjUyZDA1YjM3Li4yYTQw
Njg5MTU2N2IgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZGlzcGxheS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxh
eS5jCkBAIC0xMzkwMywxOSArMTM5MDMsNiBAQCBzdGF0aWMgdm9pZCBpbnRlbF9jcnRjX2NoZWNr
X2Zhc3RzZXQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YQogCiAJ
bmV3X2NydGNfc3RhdGUtPnVhcGkubW9kZV9jaGFuZ2VkID0gZmFsc2U7CiAJbmV3X2NydGNfc3Rh
dGUtPnVwZGF0ZV9waXBlID0gdHJ1ZTsKLQotCS8qCi0JICogSWYgd2UncmUgbm90IGRvaW5nIHRo
ZSBmdWxsIG1vZGVzZXQgd2Ugd2FudCB0bwotCSAqIGtlZXAgdGhlIGN1cnJlbnQgTS9OIHZhbHVl
cyBhcyB0aGV5IG1heSBiZQotCSAqIHN1ZmZpY2llbnRseSBkaWZmZXJlbnQgdG8gdGhlIGNvbXB1
dGVkIHZhbHVlcwotCSAqIHRvIGNhdXNlIHByb2JsZW1zLgotCSAqCi0JICogRklYTUU6IHNob3Vs
ZCByZWFsbHkgY29weSBtb3JlIGZ1enp5IHN0YXRlIGhlcmUKLQkgKi8KLQluZXdfY3J0Y19zdGF0
ZS0+ZmRpX21fbiA9IG9sZF9jcnRjX3N0YXRlLT5mZGlfbV9uOwotCW5ld19jcnRjX3N0YXRlLT5k
cF9tX24gPSBvbGRfY3J0Y19zdGF0ZS0+ZHBfbV9uOwotCW5ld19jcnRjX3N0YXRlLT5kcF9tMl9u
MiA9IG9sZF9jcnRjX3N0YXRlLT5kcF9tMl9uMjsKLQluZXdfY3J0Y19zdGF0ZS0+aGFzX2RycnMg
PSBvbGRfY3J0Y19zdGF0ZS0+aGFzX2RycnM7CiB9CiAKIHN0YXRpYyBpbnQgaW50ZWxfY3J0Y19h
ZGRfcGxhbmVzX3RvX3N0YXRlKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLApAQCAt
MTQwODMsNiArMTQwNzAsNDYgQEAgc3RhdGljIGludCBpbnRlbF9hdG9taWNfY2hlY2soc3RydWN0
IGRybV9kZXZpY2UgKmRldiwKIAkJCWFueV9tcyA9IHRydWU7CiAJfQogCisJLyoqCisJICogQ2hl
Y2sgaWYgZmFzdHNldCBpcyBhbGxvd2VkIGJ5IGV4dGVybmFsIGRlcGVuZGVuY2llcyBsaWtlIG90
aGVyCisJICogcGlwZXMgYW5kIHRyYW5zY29kZXJzLgorCSAqCisJICogUmlnaHQgbm93IGl0IG9u
bHkgZm9yY2VzIGEgZnVsbG1vZGVzZXQgd2hlbiB0aGUgTVNUIG1hc3RlcgorCSAqIHRyYW5zY29k
ZXIgZGlkIG5vdCBjaGFuZ2VkIGJ1dCB0aGUgcGlwZSBvZiB0aGUgbWFzdGVyIHRyYW5zY29kZXIK
KwkgKiBuZWVkcyBhIGZ1bGxtb2Rlc2V0IHNvIGFsbCBzbGF2ZXMgYWxzbyBuZWVkcyB0byBkbyBh
IGZ1bGxtb2Rlc2V0LgorCSAqLworCWZvcl9lYWNoX25ld19pbnRlbF9jcnRjX2luX3N0YXRlKHN0
YXRlLCBjcnRjLCBuZXdfY3J0Y19zdGF0ZSwgaSkgeworCQllbnVtIHRyYW5zY29kZXIgbWFzdGVy
ID0gbmV3X2NydGNfc3RhdGUtPm1zdF9tYXN0ZXJfdHJhbnNjb2RlcjsKKworCQlpZiAoIWludGVs
X2RwX21zdF9pc19zbGF2ZV90cmFucyhuZXdfY3J0Y19zdGF0ZSkgfHwKKwkJICAgIG5lZWRzX21v
ZGVzZXQobmV3X2NydGNfc3RhdGUpKQorCQkJY29udGludWU7CisKKwkJaWYgKGludGVsX2RwX21z
dF9tYXN0ZXJfdHJhbnNfbmVlZHNfbW9kZXNldChzdGF0ZSwgbWFzdGVyKSkgeworCQkJbmV3X2Ny
dGNfc3RhdGUtPnVhcGkubW9kZV9jaGFuZ2VkID0gdHJ1ZTsKKwkJCW5ld19jcnRjX3N0YXRlLT51
cGRhdGVfcGlwZSA9IGZhbHNlOworCQl9CisJfQorCisJZm9yX2VhY2hfb2xkbmV3X2ludGVsX2Ny
dGNfaW5fc3RhdGUoc3RhdGUsIGNydGMsIG9sZF9jcnRjX3N0YXRlLAorCQkJCQkgICAgbmV3X2Ny
dGNfc3RhdGUsIGkpIHsKKwkJaWYgKG5lZWRzX21vZGVzZXQobmV3X2NydGNfc3RhdGUpKQorCQkJ
Y29udGludWU7CisKKwkJLyoKKwkJICogSWYgd2UncmUgbm90IGRvaW5nIHRoZSBmdWxsIG1vZGVz
ZXQgd2Ugd2FudCB0bworCQkgKiBrZWVwIHRoZSBjdXJyZW50IE0vTiB2YWx1ZXMgYXMgdGhleSBt
YXkgYmUKKwkJICogc3VmZmljaWVudGx5IGRpZmZlcmVudCB0byB0aGUgY29tcHV0ZWQgdmFsdWVz
CisJCSAqIHRvIGNhdXNlIHByb2JsZW1zLgorCQkgKgorCQkgKiBGSVhNRTogc2hvdWxkIHJlYWxs
eSBjb3B5IG1vcmUgZnV6enkgc3RhdGUgaGVyZQorCQkgKi8KKwkJbmV3X2NydGNfc3RhdGUtPmZk
aV9tX24gPSBvbGRfY3J0Y19zdGF0ZS0+ZmRpX21fbjsKKwkJbmV3X2NydGNfc3RhdGUtPmRwX21f
biA9IG9sZF9jcnRjX3N0YXRlLT5kcF9tX247CisJCW5ld19jcnRjX3N0YXRlLT5kcF9tMl9uMiA9
IG9sZF9jcnRjX3N0YXRlLT5kcF9tMl9uMjsKKwkJbmV3X2NydGNfc3RhdGUtPmhhc19kcnJzID0g
b2xkX2NydGNfc3RhdGUtPmhhc19kcnJzOworCX0KKwogCWlmIChhbnlfbXMgJiYgIWNoZWNrX2Rp
Z2l0YWxfcG9ydF9jb25mbGljdHMoc3RhdGUpKSB7CiAJCURSTV9ERUJVR19LTVMoInJlamVjdGlu
ZyBjb25mbGljdGluZyBkaWdpdGFsIHBvcnQgY29uZmlndXJhdGlvblxuIik7CiAJCXJldCA9IEVJ
TlZBTDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHBf
bXN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwX21zdC5jCmluZGV4
IGVmZDE0YjBiNTA3Yi4uNGFiYTFkNzAyYTgzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2RwX21zdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfZHBfbXN0LmMKQEAgLTg1NCwzICs4NTQsMTcgQEAgYm9vbCBpbnRlbF9kcF9t
c3RfaXNfc2xhdmVfdHJhbnMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUpCiAJcmV0dXJuIGNydGNfc3RhdGUtPm1zdF9tYXN0ZXJfdHJhbnNjb2RlciAhPSBJTlZBTElE
X1RSQU5TQ09ERVIgJiYKIAkgICAgICAgY3J0Y19zdGF0ZS0+bXN0X21hc3Rlcl90cmFuc2NvZGVy
ICE9IGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyOwogfQorCitib29sIGludGVsX2RwX21zdF9t
YXN0ZXJfdHJhbnNfbmVlZHNfbW9kZXNldChzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0
ZSwKKwkJCQkJICAgICBlbnVtIHRyYW5zY29kZXIgbWFzdGVyKQoreworCXN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0ZTsKKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsKKwlp
bnQgaTsKKworCWZvcl9lYWNoX25ld19pbnRlbF9jcnRjX2luX3N0YXRlKHN0YXRlLCBjcnRjLCBu
ZXdfY3J0Y19zdGF0ZSwgaSkKKwkJaWYgKG5ld19jcnRjX3N0YXRlLT5tc3RfbWFzdGVyX3RyYW5z
Y29kZXIgPT0gbWFzdGVyKQorCQkJcmV0dXJuIGRybV9hdG9taWNfY3J0Y19uZWVkc19tb2Rlc2V0
KCZuZXdfY3J0Y19zdGF0ZS0+dWFwaSk7CisKKwlyZXR1cm4gZmFsc2U7Cit9CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwX21zdC5oIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcF9tc3QuaAppbmRleCA4NTQ3MjRmNjhmMDkuLjcy
Y2I0ODZmMzJhYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9kcF9tc3QuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwX21z
dC5oCkBAIC04LDYgKzgsNyBAQAogCiAjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KIAorc3RydWN0
IGludGVsX2F0b21pY19zdGF0ZTsKIHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQ7CiBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZTsKIApAQCAtMTYsNSArMTcsNyBAQCB2b2lkIGludGVsX2RwX21zdF9l
bmNvZGVyX2NsZWFudXAoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQp
OwogaW50IGludGVsX2RwX21zdF9lbmNvZGVyX2FjdGl2ZV9saW5rcyhzdHJ1Y3QgaW50ZWxfZGln
aXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCk7CiBib29sIGludGVsX2RwX21zdF9pc19tYXN0ZXJf
dHJhbnMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpOwogYm9vbCBp
bnRlbF9kcF9tc3RfaXNfc2xhdmVfdHJhbnMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUpOworYm9vbCBpbnRlbF9kcF9tc3RfbWFzdGVyX3RyYW5zX25lZWRzX21vZGVz
ZXQoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkJCSAgICAgZW51bSB0cmFu
c2NvZGVyIG1hc3Rlcik7CiAKICNlbmRpZiAvKiBfX0lOVEVMX0RQX01TVF9IX18gKi8KLS0gCjIu
MjQuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50
ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBz
Oi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4Cg==

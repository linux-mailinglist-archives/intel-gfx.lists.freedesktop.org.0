Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 842116798E
	for <lists+intel-gfx@lfdr.de>; Sat, 13 Jul 2019 12:00:42 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9C7546E3CB;
	Sat, 13 Jul 2019 10:00:40 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 3543A6E3D2
 for <intel-gfx@lists.freedesktop.org>; Sat, 13 Jul 2019 10:00:35 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17265479-1500050 
 for multiple; Sat, 13 Jul 2019 11:00:19 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Sat, 13 Jul 2019 11:00:14 +0100
Message-Id: <20190713100016.8026-9-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20190713100016.8026-1-chris@chris-wilson.co.uk>
References: <20190713100016.8026-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 09/11] drm/i915/uc: prefer intel_gt over i915 in
 GuC/HuC paths
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogRGFuaWVsZSBDZXJhb2xvIFNwdXJpbyA8ZGFuaWVsZS5jZXJhb2xvc3B1cmlvQGludGVs
LmNvbT4KCldpdGggb3VyIEhXIGludGVyZmFjZSBsb2dpYyBtb3ZpbmcgZnJvbSBpOTE1IHRvIGd0
IGFuZCB3aXRoIEd1QyBhbmQgSHVDCmJlaW5nIHBhcnQgb2YgdGhlIGd0IEhXLCBpdCBtYWtlcyBz
ZW5zZSB0byB1c2UgdGhlIGludGVsX2d0IHN0cnVjdHVyZQppbnN0ZWFkIG9mIGk5MTUgYXMgb3Vy
IHJlZmVyZW5jZSBvYmplY3QgaW4gR3VDL0h1QyBwYXRocy4KClNpZ25lZC1vZmYtYnk6IERhbmll
bGUgQ2VyYW9sbyBTcHVyaW8gPGRhbmllbGUuY2VyYW9sb3NwdXJpb0BpbnRlbC5jb20+CkNjOiBN
aWNoYWwgV2FqZGVjemtvIDxtaWNoYWwud2FqZGVjemtvQGludGVsLmNvbT4KLS0tCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5oICAgICAgICAgICAgfCAxMCArKysKIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Yy5jICAgICAgICB8IDUyICsrKysrKy0tLS0tLQog
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX2Z3LmMgICAgIHwgODEgKysrKysr
KysrKy0tLS0tLS0tLQogLi4uL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfc3VibWlzc2lv
bi5jIHwgNDMgKysrKystLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfaHVj
LmMgICAgICAgIHwgMjIgKystLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2h1
Y19mdy5jICAgICB8ICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF91Yy5j
ICAgICAgICAgfCAgNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMgICAg
ICAgICAgIHwgIDggKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5oICAgICAg
ICAgICB8ICA0ICstCiA5IGZpbGVzIGNoYW5nZWQsIDEyMCBpbnNlcnRpb25zKCspLCAxMDggZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3Qu
aCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmgKaW5kZXggMjZjOTQ1MjFhZDFi
Li42NDBiYjA1MzFmNWIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2d0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuaApAQCAtMTcsNiAr
MTcsMTYgQEAgc3RhdGljIGlubGluZSBzdHJ1Y3QgaW50ZWxfZ3QgKnVjX3RvX2d0KHN0cnVjdCBp
bnRlbF91YyAqdWMpCiAJcmV0dXJuIGNvbnRhaW5lcl9vZih1Yywgc3RydWN0IGludGVsX2d0LCB1
Yyk7CiB9CiAKK3N0YXRpYyBpbmxpbmUgc3RydWN0IGludGVsX2d0ICpndWNfdG9fZ3Qoc3RydWN0
IGludGVsX2d1YyAqZ3VjKQoreworCXJldHVybiBjb250YWluZXJfb2YoZ3VjLCBzdHJ1Y3QgaW50
ZWxfZ3QsIHVjLmd1Yyk7Cit9CisKK3N0YXRpYyBpbmxpbmUgc3RydWN0IGludGVsX2d0ICpodWNf
dG9fZ3Qoc3RydWN0IGludGVsX2h1YyAqaHVjKQoreworCXJldHVybiBjb250YWluZXJfb2YoaHVj
LCBzdHJ1Y3QgaW50ZWxfZ3QsIHVjLmh1Yyk7Cit9CisKIHZvaWQgaW50ZWxfZ3RfaW5pdF9lYXJs
eShzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7CiB2
b2lkIGludGVsX2d0X2luaXRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwogCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWMuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Yy5jCmluZGV4IDQxNzNiMzViZjEwNC4uNmI1
NmYzOTA3MmIxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9n
dWMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWMuYwpAQCAtMjIs
NiArMjIsNyBAQAogICoKICAqLwogCisjaW5jbHVkZSAiZ3QvaW50ZWxfZ3QuaCIKICNpbmNsdWRl
ICJpbnRlbF9ndWMuaCIKICNpbmNsdWRlICJpbnRlbF9ndWNfYWRzLmgiCiAjaW5jbHVkZSAiaW50
ZWxfZ3VjX3N1Ym1pc3Npb24uaCIKQEAgLTI5LDE2ICszMCwxNiBAQAogCiBzdGF0aWMgdm9pZCBn
ZW44X2d1Y19yYWlzZV9pcnEoc3RydWN0IGludGVsX2d1YyAqZ3VjKQogewotCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGd1Y190b19pOTE1KGd1Yyk7CisJc3RydWN0IGludGVs
X2d0ICpndCA9IGd1Y190b19ndChndWMpOwogCi0JSTkxNV9XUklURShHVUNfU0VORF9JTlRFUlJV
UFQsIEdVQ19TRU5EX1RSSUdHRVIpOworCWludGVsX3VuY29yZV93cml0ZShndC0+dW5jb3JlLCBH
VUNfU0VORF9JTlRFUlJVUFQsIEdVQ19TRU5EX1RSSUdHRVIpOwogfQogCiBzdGF0aWMgdm9pZCBn
ZW4xMV9ndWNfcmFpc2VfaXJxKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKIHsKLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndWNfdG9faTkxNShndWMpOworCXN0cnVjdCBpbnRl
bF9ndCAqZ3QgPSBndWNfdG9fZ3QoZ3VjKTsKIAotCUk5MTVfV1JJVEUoR0VOMTFfR1VDX0hPU1Rf
SU5URVJSVVBULCAwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGUoZ3QtPnVuY29yZSwgR0VOMTFfR1VD
X0hPU1RfSU5URVJSVVBULCAwKTsKIH0KIAogc3RhdGljIGlubGluZSBpOTE1X3JlZ190IGd1Y19z
ZW5kX3JlZyhzdHJ1Y3QgaW50ZWxfZ3VjICpndWMsIHUzMiBpKQpAQCAtNTIsMTEgKzUzLDExIEBA
IHN0YXRpYyBpbmxpbmUgaTkxNV9yZWdfdCBndWNfc2VuZF9yZWcoc3RydWN0IGludGVsX2d1YyAq
Z3VjLCB1MzIgaSkKIAogdm9pZCBpbnRlbF9ndWNfaW5pdF9zZW5kX3JlZ3Moc3RydWN0IGludGVs
X2d1YyAqZ3VjKQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGd1Y190
b19pOTE1KGd1Yyk7CisJc3RydWN0IGludGVsX2d0ICpndCA9IGd1Y190b19ndChndWMpOwogCWVu
dW0gZm9yY2V3YWtlX2RvbWFpbnMgZndfZG9tYWlucyA9IDA7CiAJdW5zaWduZWQgaW50IGk7CiAK
LQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkgeworCWlmIChJTlRFTF9HRU4oZ3QtPmk5
MTUpID49IDExKSB7CiAJCWd1Yy0+c2VuZF9yZWdzLmJhc2UgPQogCQkJCWk5MTVfbW1pb19yZWdf
b2Zmc2V0KEdFTjExX1NPRlRfU0NSQVRDSCgwKSk7CiAJCWd1Yy0+c2VuZF9yZWdzLmNvdW50ID0g
R0VOMTFfU09GVF9TQ1JBVENIX0NPVU5UOwpAQCAtNjcsNyArNjgsNyBAQCB2b2lkIGludGVsX2d1
Y19pbml0X3NlbmRfcmVncyhzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCiAJfQogCiAJZm9yIChpID0g
MDsgaSA8IGd1Yy0+c2VuZF9yZWdzLmNvdW50OyBpKyspIHsKLQkJZndfZG9tYWlucyB8PSBpbnRl
bF91bmNvcmVfZm9yY2V3YWtlX2Zvcl9yZWcoJmRldl9wcml2LT51bmNvcmUsCisJCWZ3X2RvbWFp
bnMgfD0gaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9mb3JfcmVnKGd0LT51bmNvcmUsCiAJCQkJCWd1
Y19zZW5kX3JlZyhndWMsIGkpLAogCQkJCQlGV19SRUdfUkVBRCB8IEZXX1JFR19XUklURSk7CiAJ
fQpAQCAtMTI3LDcgKzEyOCw3IEBAIHN0YXRpYyB2b2lkIGd1Y19zaGFyZWRfZGF0YV9kZXN0cm95
KHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKIAogaW50IGludGVsX2d1Y19pbml0KHN0cnVjdCBpbnRl
bF9ndWMgKmd1YykKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndWNf
dG9faTkxNShndWMpOworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBndWNfdG9fZ3QoZ3VjKTsKIAlp
bnQgcmV0OwogCiAJcmV0ID0gaW50ZWxfdWNfZndfaW5pdCgmZ3VjLT5mdyk7CkBAIC0xNTMsNyAr
MTU0LDcgQEAgaW50IGludGVsX2d1Y19pbml0KHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKIAkJZ290
byBlcnJfYWRzOwogCiAJLyogV2UgbmVlZCB0byBub3RpZnkgdGhlIGd1YyB3aGVuZXZlciB3ZSBj
aGFuZ2UgdGhlIEdHVFQgKi8KLQlpOTE1X2dndHRfZW5hYmxlX2d1YyhkZXZfcHJpdik7CisJaTkx
NV9nZ3R0X2VuYWJsZV9ndWMoZ3QtPmdndHQpOwogCiAJcmV0dXJuIDA7CiAKQEAgLTE3Miw5ICsx
NzMsOSBAQCBpbnQgaW50ZWxfZ3VjX2luaXQoc3RydWN0IGludGVsX2d1YyAqZ3VjKQogCiB2b2lk
IGludGVsX2d1Y19maW5pKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKIHsKLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndWNfdG9faTkxNShndWMpOworCXN0cnVjdCBpbnRlbF9n
dCAqZ3QgPSBndWNfdG9fZ3QoZ3VjKTsKIAotCWk5MTVfZ2d0dF9kaXNhYmxlX2d1YyhkZXZfcHJp
dik7CisJaTkxNV9nZ3R0X2Rpc2FibGVfZ3VjKGd0LT5nZ3R0KTsKIAogCWludGVsX2d1Y19jdF9m
aW5pKCZndWMtPmN0KTsKIApAQCAtMjgyLDcgKzI4Myw3IEBAIHN0YXRpYyB1MzIgZ3VjX2N0bF9h
ZHNfZmxhZ3Moc3RydWN0IGludGVsX2d1YyAqZ3VjKQogICovCiB2b2lkIGludGVsX2d1Y19pbml0
X3BhcmFtcyhzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1
bmNvcmUgPSBndWNfdG9fZ3QoZ3VjKS0+dW5jb3JlOwogCXUzMiBwYXJhbXNbR1VDX0NUTF9NQVhf
RFdPUkRTXTsKIAlpbnQgaTsKIApAQCAtMzAyLDE0ICszMDMsMTQgQEAgdm9pZCBpbnRlbF9ndWNf
aW5pdF9wYXJhbXMoc3RydWN0IGludGVsX2d1YyAqZ3VjKQogCSAqIHRoZXkgYXJlIHBvd2VyIGNv
bnRleHQgc2F2ZWQgc28gaXQncyBvayB0byByZWxlYXNlIGZvcmNld2FrZQogCSAqIHdoZW4gd2Ug
YXJlIGRvbmUgaGVyZSBhbmQgdGFrZSBpdCBhZ2FpbiBhdCB4ZmVyIHRpbWUuCiAJICovCi0JaW50
ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9CTElU
VEVSKTsKKwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCh1bmNvcmUsIEZPUkNFV0FLRV9CTElU
VEVSKTsKIAotCUk5MTVfV1JJVEUoU09GVF9TQ1JBVENIKDApLCAwKTsKKwlpbnRlbF91bmNvcmVf
d3JpdGUodW5jb3JlLCBTT0ZUX1NDUkFUQ0goMCksIDApOwogCiAJZm9yIChpID0gMDsgaSA8IEdV
Q19DVExfTUFYX0RXT1JEUzsgaSsrKQotCQlJOTE1X1dSSVRFKFNPRlRfU0NSQVRDSCgxICsgaSks
IHBhcmFtc1tpXSk7CisJCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIFNPRlRfU0NSQVRDSCgx
ICsgaSksIHBhcmFtc1tpXSk7CiAKLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmZGV2X3By
aXYtPnVuY29yZSwgRk9SQ0VXQUtFX0JMSVRURVIpOworCWludGVsX3VuY29yZV9mb3JjZXdha2Vf
cHV0KHVuY29yZSwgRk9SQ0VXQUtFX0JMSVRURVIpOwogfQogCiBpbnQgaW50ZWxfZ3VjX3NlbmRf
bm9wKHN0cnVjdCBpbnRlbF9ndWMgKmd1YywgY29uc3QgdTMyICphY3Rpb24sIHUzMiBsZW4sCkBA
IC0zMzAsOCArMzMxLDcgQEAgdm9pZCBpbnRlbF9ndWNfdG9faG9zdF9ldmVudF9oYW5kbGVyX25v
cChzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCiBpbnQgaW50ZWxfZ3VjX3NlbmRfbW1pbyhzdHJ1Y3Qg
aW50ZWxfZ3VjICpndWMsIGNvbnN0IHUzMiAqYWN0aW9uLCB1MzIgbGVuLAogCQkJdTMyICpyZXNw
b25zZV9idWYsIHUzMiByZXNwb25zZV9idWZfc2l6ZSkKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSBndWNfdG9faTkxNShndWMpOwotCXN0cnVjdCBpbnRlbF91bmNvcmUg
KnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29y
ZSA9IGd1Y190b19ndChndWMpLT51bmNvcmU7CiAJdTMyIHN0YXR1czsKIAlpbnQgaTsKIAlpbnQg
cmV0OwpAQCAtMzgwLDcgKzM4MCw4IEBAIGludCBpbnRlbF9ndWNfc2VuZF9tbWlvKHN0cnVjdCBp
bnRlbF9ndWMgKmd1YywgY29uc3QgdTMyICphY3Rpb24sIHUzMiBsZW4sCiAJCWludCBjb3VudCA9
IG1pbihyZXNwb25zZV9idWZfc2l6ZSwgZ3VjLT5zZW5kX3JlZ3MuY291bnQgLSAxKTsKIAogCQlm
b3IgKGkgPSAwOyBpIDwgY291bnQ7IGkrKykKLQkJCXJlc3BvbnNlX2J1ZltpXSA9IEk5MTVfUkVB
RChndWNfc2VuZF9yZWcoZ3VjLCBpICsgMSkpOworCQkJcmVzcG9uc2VfYnVmW2ldID0gaW50ZWxf
dW5jb3JlX3JlYWQodW5jb3JlLAorCQkJCQkJCSAgICBndWNfc2VuZF9yZWcoZ3VjLCBpICsgMSkp
OwogCX0KIAogCS8qIFVzZSBkYXRhIGZyb20gdGhlIEd1QyByZXNwb25zZSBhcyBvdXIgcmV0dXJu
IHZhbHVlICovCkBAIC00NTQsNyArNDU1LDcgQEAgaW50IGludGVsX2d1Y19hdXRoX2h1YyhzdHJ1
Y3QgaW50ZWxfZ3VjICpndWMsIHUzMiByc2Ffb2Zmc2V0KQogICovCiBpbnQgaW50ZWxfZ3VjX3N1
c3BlbmQoc3RydWN0IGludGVsX2d1YyAqZ3VjKQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IGd1Y190b19pOTE1KGd1Yyk7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5j
b3JlID0gZ3VjX3RvX2d0KGd1YyktPnVuY29yZTsKIAlpbnQgcmV0OwogCXUzMiBzdGF0dXM7CiAJ
dTMyIGFjdGlvbltdID0gewpAQCAtNDcyLDEzICs0NzMsMTQgQEAgaW50IGludGVsX2d1Y19zdXNw
ZW5kKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKIAkgKiBpbiBwcm9ncmVzcyBzbyB3ZSBuZWVkIHRv
IHRha2UgY2FyZSBvZiB0aGF0IG91cnNlbHZlcyBhcyB3ZWxsLgogCSAqLwogCi0JSTkxNV9XUklU
RShTT0ZUX1NDUkFUQ0goMTQpLCBJTlRFTF9HVUNfU0xFRVBfU1RBVEVfSU5WQUxJRF9NQVNLKTsK
KwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBTT0ZUX1NDUkFUQ0goMTQpLAorCQkJICAgSU5U
RUxfR1VDX1NMRUVQX1NUQVRFX0lOVkFMSURfTUFTSyk7CiAKIAlyZXQgPSBpbnRlbF9ndWNfc2Vu
ZChndWMsIGFjdGlvbiwgQVJSQVlfU0laRShhY3Rpb24pKTsKIAlpZiAocmV0KQogCQlyZXR1cm4g
cmV0OwogCi0JcmV0ID0gX19pbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29y
ZSwgU09GVF9TQ1JBVENIKDE0KSwKKwlyZXQgPSBfX2ludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKHVu
Y29yZSwgU09GVF9TQ1JBVENIKDE0KSwKIAkJCQkJSU5URUxfR1VDX1NMRUVQX1NUQVRFX0lOVkFM
SURfTUFTSywKIAkJCQkJMCwgMCwgMTAsICZzdGF0dXMpOwogCWlmIChyZXQpCkBAIC01NzQsMTcg
KzU3NiwxNyBAQCBpbnQgaW50ZWxfZ3VjX3Jlc3VtZShzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCiAg
Ki8KIHN0cnVjdCBpOTE1X3ZtYSAqaW50ZWxfZ3VjX2FsbG9jYXRlX3ZtYShzdHJ1Y3QgaW50ZWxf
Z3VjICpndWMsIHUzMiBzaXplKQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IGd1Y190b19pOTE1KGd1Yyk7CisJc3RydWN0IGludGVsX2d0ICpndCA9IGd1Y190b19ndChn
dWMpOwogCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CiAJc3RydWN0IGk5MTVfdm1h
ICp2bWE7CiAJdTY0IGZsYWdzOwogCWludCByZXQ7CiAKLQlvYmogPSBpOTE1X2dlbV9vYmplY3Rf
Y3JlYXRlX3NobWVtKGRldl9wcml2LCBzaXplKTsKKwlvYmogPSBpOTE1X2dlbV9vYmplY3RfY3Jl
YXRlX3NobWVtKGd0LT5pOTE1LCBzaXplKTsKIAlpZiAoSVNfRVJSKG9iaikpCiAJCXJldHVybiBF
UlJfQ0FTVChvYmopOwogCi0Jdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uob2JqLCAmZGV2X3ByaXYt
PmdndHQudm0sIE5VTEwpOworCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9iaiwgJmd0LT5nZ3R0
LT52bSwgTlVMTCk7CiAJaWYgKElTX0VSUih2bWEpKQogCQlnb3RvIGVycjsKIApkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX2Z3LmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfZncuYwppbmRleCBlZTk1ZDQ5NjBjNWMuLjk4MzA1
ZTNmZDQyYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3Vj
X2Z3LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX2Z3LmMKQEAg
LTI3LDYgKzI3LDcgQEAKICAqICAgIEFsZXggRGFpIDx5dS5kYWlAaW50ZWwuY29tPgogICovCiAK
KyNpbmNsdWRlICJndC9pbnRlbF9ndC5oIgogI2luY2x1ZGUgImludGVsX2d1Y19mdy5oIgogI2lu
Y2x1ZGUgImk5MTVfZHJ2LmgiCiAKQEAgLTEyOSwzNSArMTMwLDM3IEBAIHZvaWQgaW50ZWxfZ3Vj
X2Z3X2luaXRfZWFybHkoc3RydWN0IGludGVsX2d1YyAqZ3VjKQogCiBzdGF0aWMgdm9pZCBndWNf
cHJlcGFyZV94ZmVyKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSBndWNfdG9faTkxNShndWMpOworCXN0cnVjdCBpbnRlbF9ndCAq
Z3QgPSBndWNfdG9fZ3QoZ3VjKTsKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBndC0+
dW5jb3JlOworCXUzMiBzaGltX2ZsYWdzID0gR1VDX0RJU0FCTEVfU1JBTV9JTklUX1RPX1pFUk9F
UyB8CisJCQkgR1VDX0VOQUJMRV9SRUFEX0NBQ0hFX0xPR0lDIHwKKwkJCSBHVUNfRU5BQkxFX01J
QV9DQUNISU5HIHwKKwkJCSBHVUNfRU5BQkxFX1JFQURfQ0FDSEVfRk9SX1NSQU1fREFUQSB8CisJ
CQkgR1VDX0VOQUJMRV9SRUFEX0NBQ0hFX0ZPUl9XT1BDTV9EQVRBIHwKKwkJCSBHVUNfRU5BQkxF
X01JQV9DTE9DS19HQVRJTkc7CiAKIAkvKiBNdXN0IHByb2dyYW0gdGhpcyByZWdpc3RlciBiZWZv
cmUgbG9hZGluZyB0aGUgdWNvZGUgd2l0aCBETUEgKi8KLQlJOTE1X1dSSVRFKEdVQ19TSElNX0NP
TlRST0wsIEdVQ19ESVNBQkxFX1NSQU1fSU5JVF9UT19aRVJPRVMgfAotCQkJCSAgICAgR1VDX0VO
QUJMRV9SRUFEX0NBQ0hFX0xPR0lDIHwKLQkJCQkgICAgIEdVQ19FTkFCTEVfTUlBX0NBQ0hJTkcg
fAotCQkJCSAgICAgR1VDX0VOQUJMRV9SRUFEX0NBQ0hFX0ZPUl9TUkFNX0RBVEEgfAotCQkJCSAg
ICAgR1VDX0VOQUJMRV9SRUFEX0NBQ0hFX0ZPUl9XT1BDTV9EQVRBIHwKLQkJCQkgICAgIEdVQ19F
TkFCTEVfTUlBX0NMT0NLX0dBVElORyk7Ci0KLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCi0J
CUk5MTVfV1JJVEUoR0VOOUxQX0dUX1BNX0NPTkZJRywgR1RfRE9PUkJFTExfRU5BQkxFKTsKKwlp
bnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBHVUNfU0hJTV9DT05UUk9MLCBzaGltX2ZsYWdzKTsK
KworCWlmIChJU19HRU45X0xQKGd0LT5pOTE1KSkKKwkJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29y
ZSwgR0VOOUxQX0dUX1BNX0NPTkZJRywgR1RfRE9PUkJFTExfRU5BQkxFKTsKIAllbHNlCi0JCUk5
MTVfV1JJVEUoR0VOOV9HVF9QTV9DT05GSUcsIEdUX0RPT1JCRUxMX0VOQUJMRSk7CisJCWludGVs
X3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjlfR1RfUE1fQ09ORklHLCBHVF9ET09SQkVMTF9FTkFC
TEUpOwogCi0JaWYgKElTX0dFTihkZXZfcHJpdiwgOSkpIHsKKwlpZiAoSVNfR0VOKGd0LT5pOTE1
LCA5KSkgewogCQkvKiBET1AgQ2xvY2sgR2F0aW5nIEVuYWJsZSBmb3IgR3VDIGNsb2NrcyAqLwot
CQlJOTE1X1dSSVRFKEdFTjdfTUlTQ0NQQ1RMLCAoR0VOOF9ET1BfQ0xPQ0tfR0FURV9HVUNfRU5B
QkxFIHwKLQkJCQkJICAgIEk5MTVfUkVBRChHRU43X01JU0NDUENUTCkpKTsKKwkJaW50ZWxfdW5j
b3JlX3Jtdyh1bmNvcmUsIEdFTjdfTUlTQ0NQQ1RMLAorCQkJCSAwLCBHRU44X0RPUF9DTE9DS19H
QVRFX0dVQ19FTkFCTEUpOwogCiAJCS8qIGFsbG93cyBmb3IgNXVzIChpbiAxMG5zIHVuaXRzKSBi
ZWZvcmUgR1QgY2FuIGdvIHRvIFJDNiAqLwotCQlJOTE1X1dSSVRFKEdVQ19BUkFUX0M2RElTLCAw
eDFGRik7CisJCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdVQ19BUkFUX0M2RElTLCAweDFG
Rik7CiAJfQogfQogCiAvKiBDb3B5IFJTQSBzaWduYXR1cmUgZnJvbSB0aGUgZncgaW1hZ2UgdG8g
SFcgZm9yIHZlcmlmaWNhdGlvbiAqLwogc3RhdGljIHZvaWQgZ3VjX3hmZXJfcnNhKHN0cnVjdCBp
bnRlbF9ndWMgKmd1YykKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBn
dWNfdG9faTkxNShndWMpOworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IGd1Y190b19n
dChndWMpLT51bmNvcmU7CiAJc3RydWN0IGludGVsX3VjX2Z3ICpmdyA9ICZndWMtPmZ3OwogCXN0
cnVjdCBzZ190YWJsZSAqcGFnZXMgPSBmdy0+b2JqLT5tbS5wYWdlczsKIAl1MzIgcnNhW1VPU19S
U0FfU0NSQVRDSF9DT1VOVF07CkBAIC0xNjcsMTUgKzE3MCwxMyBAQCBzdGF0aWMgdm9pZCBndWNf
eGZlcl9yc2Eoc3RydWN0IGludGVsX2d1YyAqZ3VjKQogCQkJICAgcnNhLCBzaXplb2YocnNhKSwg
ZnctPnJzYV9vZmZzZXQpOwogCiAJZm9yIChpID0gMDsgaSA8IFVPU19SU0FfU0NSQVRDSF9DT1VO
VDsgaSsrKQotCQlJOTE1X1dSSVRFKFVPU19SU0FfU0NSQVRDSChpKSwgcnNhW2ldKTsKKwkJaW50
ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgVU9TX1JTQV9TQ1JBVENIKGkpLCByc2FbaV0pOwogfQog
Ci1zdGF0aWMgYm9vbCBndWNfeGZlcl9jb21wbGV0ZWQoc3RydWN0IGludGVsX2d1YyAqZ3VjLCB1
MzIgKnN0YXR1cykKK3N0YXRpYyBib29sIGd1Y194ZmVyX2NvbXBsZXRlZChzdHJ1Y3QgaW50ZWxf
dW5jb3JlICp1bmNvcmUsIHUzMiAqc3RhdHVzKQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IGd1Y190b19pOTE1KGd1Yyk7Ci0KIAkvKiBEaWQgd2UgY29tcGxldGUgdGhl
IHhmZXI/ICovCi0JKnN0YXR1cyA9IEk5MTVfUkVBRChETUFfQ1RSTCk7CisJKnN0YXR1cyA9IGlu
dGVsX3VuY29yZV9yZWFkKHVuY29yZSwgRE1BX0NUUkwpOwogCXJldHVybiAhKCpzdGF0dXMgJiBT
VEFSVF9ETUEpOwogfQogCkBAIC0xODgsMTAgKzE4OSw5IEBAIHN0YXRpYyBib29sIGd1Y194ZmVy
X2NvbXBsZXRlZChzdHJ1Y3QgaW50ZWxfZ3VjICpndWMsIHUzMiAqc3RhdHVzKQogICogVGhpcyBp
cyB1c2VkIGZvciBwb2xsaW5nIHRoZSBHdUMgc3RhdHVzIGluIGEgd2FpdF9mb3IoKQogICogbG9v
cCBiZWxvdy4KICAqLwotc3RhdGljIGlubGluZSBib29sIGd1Y19yZWFkeShzdHJ1Y3QgaW50ZWxf
Z3VjICpndWMsIHUzMiAqc3RhdHVzKQorc3RhdGljIGlubGluZSBib29sIGd1Y19yZWFkeShzdHJ1
Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUsIHUzMiAqc3RhdHVzKQogewotCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IGd1Y190b19pOTE1KGd1Yyk7Ci0JdTMyIHZhbCA9IEk5MTVf
UkVBRChHVUNfU1RBVFVTKTsKKwl1MzIgdmFsID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBH
VUNfU1RBVFVTKTsKIAl1MzIgdWtfdmFsID0gdmFsICYgR1NfVUtFUk5FTF9NQVNLOwogCiAJKnN0
YXR1cyA9IHZhbDsKQEAgLTE5OSw5ICsxOTksOCBAQCBzdGF0aWMgaW5saW5lIGJvb2wgZ3VjX3Jl
YWR5KHN0cnVjdCBpbnRlbF9ndWMgKmd1YywgdTMyICpzdGF0dXMpCiAJCSgodmFsICYgR1NfTUlB
X0NPUkVfU1RBVEUpICYmICh1a192YWwgPT0gR1NfVUtFUk5FTF9MQVBJQ19ET05FKSk7CiB9CiAK
LXN0YXRpYyBpbnQgZ3VjX3dhaXRfdWNvZGUoc3RydWN0IGludGVsX2d1YyAqZ3VjKQorc3RhdGlj
IGludCBndWNfd2FpdF91Y29kZShzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUpCiB7Ci0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndWNfdG9faTkxNShndWMpOwogCXUzMiBzdGF0
dXM7CiAJaW50IHJldDsKIApAQCAtMjEzLDcgKzIxMiw3IEBAIHN0YXRpYyBpbnQgZ3VjX3dhaXRf
dWNvZGUoc3RydWN0IGludGVsX2d1YyAqZ3VjKQogCSAqIChIaWdoZXIgbGV2ZWxzIG9mIHRoZSBk
cml2ZXIgbWF5IGRlY2lkZSB0byByZXNldCB0aGUgR3VDIGFuZAogCSAqIGF0dGVtcHQgdGhlIHVj
b2RlIGxvYWQgYWdhaW4gaWYgdGhpcyBoYXBwZW5zLikKIAkgKi8KLQlyZXQgPSB3YWl0X2Zvcihn
dWNfcmVhZHkoZ3VjLCAmc3RhdHVzKSwgMTAwKTsKKwlyZXQgPSB3YWl0X2ZvcihndWNfcmVhZHko
dW5jb3JlLCAmc3RhdHVzKSwgMTAwKTsKIAlEUk1fREVCVUdfRFJJVkVSKCJHdUMgc3RhdHVzICUj
eFxuIiwgc3RhdHVzKTsKIAogCWlmICgoc3RhdHVzICYgR1NfQk9PVFJPTV9NQVNLKSA9PSBHU19C
T09UUk9NX1JTQV9GQUlMRUQpIHsKQEAgLTIyMywxMSArMjIyLDExIEBAIHN0YXRpYyBpbnQgZ3Vj
X3dhaXRfdWNvZGUoc3RydWN0IGludGVsX2d1YyAqZ3VjKQogCiAJaWYgKChzdGF0dXMgJiBHU19V
S0VSTkVMX01BU0spID09IEdTX1VLRVJORUxfRVhDRVBUSU9OKSB7CiAJCURSTV9FUlJPUigiR3VD
IGZpcm13YXJlIGV4Y2VwdGlvbi4gRUlQOiAlI3hcbiIsCi0JCQkgIGludGVsX3VuY29yZV9yZWFk
KCZpOTE1LT51bmNvcmUsIFNPRlRfU0NSQVRDSCgxMykpKTsKKwkJCSAgaW50ZWxfdW5jb3JlX3Jl
YWQodW5jb3JlLCBTT0ZUX1NDUkFUQ0goMTMpKSk7CiAJCXJldCA9IC1FTlhJTzsKIAl9CiAKLQlp
ZiAocmV0ID09IDAgJiYgIWd1Y194ZmVyX2NvbXBsZXRlZChndWMsICZzdGF0dXMpKSB7CisJaWYg
KHJldCA9PSAwICYmICFndWNfeGZlcl9jb21wbGV0ZWQodW5jb3JlLCAmc3RhdHVzKSkgewogCQlE
Uk1fRVJST1IoIkd1QyBpcyByZWFkeSwgYnV0IHRoZSB4ZmVyICUwOHggaXMgaW5jb21wbGV0ZVxu
IiwKIAkJCSAgc3RhdHVzKTsKIAkJcmV0ID0gLUVOWElPOwpAQCAtMjQ1LDcgKzI0NCw3IEBAIHN0
YXRpYyBpbnQgZ3VjX3dhaXRfdWNvZGUoc3RydWN0IGludGVsX2d1YyAqZ3VjKQogICovCiBzdGF0
aWMgaW50IGd1Y194ZmVyX3Vjb2RlKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKIHsKLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndWNfdG9faTkxNShndWMpOworCXN0cnVjdCBp
bnRlbF91bmNvcmUgKnVuY29yZSA9IGd1Y190b19ndChndWMpLT51bmNvcmU7CiAJc3RydWN0IGlu
dGVsX3VjX2Z3ICpndWNfZncgPSAmZ3VjLT5mdzsKIAl1bnNpZ25lZCBsb25nIG9mZnNldDsKIApA
QCAtMjUzLDI0ICsyNTIsMjYgQEAgc3RhdGljIGludCBndWNfeGZlcl91Y29kZShzdHJ1Y3QgaW50
ZWxfZ3VjICpndWMpCiAJICogVGhlIGhlYWRlciBwbHVzIHVDb2RlIHdpbGwgYmUgY29waWVkIHRv
IFdPUENNIHZpYSBETUEsIGV4Y2x1ZGluZyBhbnkKIAkgKiBvdGhlciBjb21wb25lbnRzCiAJICov
Ci0JSTkxNV9XUklURShETUFfQ09QWV9TSVpFLCBndWNfZnctPmhlYWRlcl9zaXplICsgZ3VjX2Z3
LT51Y29kZV9zaXplKTsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBETUFfQ09QWV9TSVpF
LAorCQkJICAgZ3VjX2Z3LT5oZWFkZXJfc2l6ZSArIGd1Y19mdy0+dWNvZGVfc2l6ZSk7CiAKIAkv
KiBTZXQgdGhlIHNvdXJjZSBhZGRyZXNzIGZvciB0aGUgbmV3IGJsb2IgKi8KIAlvZmZzZXQgPSBp
bnRlbF91Y19md19nZ3R0X29mZnNldChndWNfZncpICsgZ3VjX2Z3LT5oZWFkZXJfb2Zmc2V0Owot
CUk5MTVfV1JJVEUoRE1BX0FERFJfMF9MT1csIGxvd2VyXzMyX2JpdHMob2Zmc2V0KSk7Ci0JSTkx
NV9XUklURShETUFfQUREUl8wX0hJR0gsIHVwcGVyXzMyX2JpdHMob2Zmc2V0KSAmIDB4RkZGRik7
CisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgRE1BX0FERFJfMF9MT1csIGxvd2VyXzMyX2Jp
dHMob2Zmc2V0KSk7CisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgRE1BX0FERFJfMF9ISUdI
LCB1cHBlcl8zMl9iaXRzKG9mZnNldCkgJiAweEZGRkYpOwogCiAJLyoKIAkgKiBTZXQgdGhlIERN
QSBkZXN0aW5hdGlvbi4gQ3VycmVudCB1Q29kZSBleHBlY3RzIHRoZSBjb2RlIHRvIGJlCiAJICog
bG9hZGVkIGF0IDhrOyBsb2NhdGlvbnMgYmVsb3cgdGhpcyBhcmUgdXNlZCBmb3IgdGhlIHN0YWNr
LgogCSAqLwotCUk5MTVfV1JJVEUoRE1BX0FERFJfMV9MT1csIDB4MjAwMCk7Ci0JSTkxNV9XUklU
RShETUFfQUREUl8xX0hJR0gsIERNQV9BRERSRVNTX1NQQUNFX1dPUENNKTsKKwlpbnRlbF91bmNv
cmVfd3JpdGUodW5jb3JlLCBETUFfQUREUl8xX0xPVywgMHgyMDAwKTsKKwlpbnRlbF91bmNvcmVf
d3JpdGUodW5jb3JlLCBETUFfQUREUl8xX0hJR0gsIERNQV9BRERSRVNTX1NQQUNFX1dPUENNKTsK
IAogCS8qIEZpbmFsbHkgc3RhcnQgdGhlIERNQSAqLwotCUk5MTVfV1JJVEUoRE1BX0NUUkwsIF9N
QVNLRURfQklUX0VOQUJMRShVT1NfTU9WRSB8IFNUQVJUX0RNQSkpOworCWludGVsX3VuY29yZV93
cml0ZSh1bmNvcmUsIERNQV9DVFJMLAorCQkJICAgX01BU0tFRF9CSVRfRU5BQkxFKFVPU19NT1ZF
IHwgU1RBUlRfRE1BKSk7CiAKLQlyZXR1cm4gZ3VjX3dhaXRfdWNvZGUoZ3VjKTsKKwlyZXR1cm4g
Z3VjX3dhaXRfdWNvZGUodW5jb3JlKTsKIH0KIC8qCiAgKiBMb2FkIHRoZSBHdUMgZmlybXdhcmUg
YmxvYiBpbnRvIHRoZSBNaW51dGVJQS4KQEAgLTI3OCwxMiArMjc5LDEyIEBAIHN0YXRpYyBpbnQg
Z3VjX3hmZXJfdWNvZGUoc3RydWN0IGludGVsX2d1YyAqZ3VjKQogc3RhdGljIGludCBndWNfZndf
eGZlcihzdHJ1Y3QgaW50ZWxfdWNfZncgKmd1Y19mdykKIHsKIAlzdHJ1Y3QgaW50ZWxfZ3VjICpn
dWMgPSBjb250YWluZXJfb2YoZ3VjX2Z3LCBzdHJ1Y3QgaW50ZWxfZ3VjLCBmdyk7Ci0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKKwlzdHJ1Y3Qg
aW50ZWxfdW5jb3JlICp1bmNvcmUgPSBndWNfdG9fZ3QoZ3VjKS0+dW5jb3JlOwogCWludCByZXQ7
CiAKIAlHRU1fQlVHX09OKGd1Y19mdy0+dHlwZSAhPSBJTlRFTF9VQ19GV19UWVBFX0dVQyk7CiAK
LQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtF
X0FMTCk7CisJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQodW5jb3JlLCBGT1JDRVdBS0VfQUxM
KTsKIAogCWd1Y19wcmVwYXJlX3hmZXIoZ3VjKTsKIApAQCAtMjk2LDcgKzI5Nyw3IEBAIHN0YXRp
YyBpbnQgZ3VjX2Z3X3hmZXIoc3RydWN0IGludGVsX3VjX2Z3ICpndWNfZncpCiAKIAlyZXQgPSBn
dWNfeGZlcl91Y29kZShndWMpOwogCi0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9w
cml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOworCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0
KHVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7CiAKIAlyZXR1cm4gcmV0OwogfQpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9uLmMKaW5kZXggZmEyMmQz
NzdhZTQ4Li5hMGYyYTAxMzY1YmMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9uLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
dWMvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYwpAQCAtMjgsNiArMjgsNyBAQAogCiAjaW5jbHVkZSAi
Z3QvaW50ZWxfY29udGV4dC5oIgogI2luY2x1ZGUgImd0L2ludGVsX2VuZ2luZV9wbS5oIgorI2lu
Y2x1ZGUgImd0L2ludGVsX2d0LmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfbHJjX3JlZy5oIgogI2lu
Y2x1ZGUgImludGVsX2d1Y19zdWJtaXNzaW9uLmgiCiAKQEAgLTIwMSwxMCArMjAyLDEwIEBAIHN0
YXRpYyBzdHJ1Y3QgZ3VjX2Rvb3JiZWxsX2luZm8gKl9fZ2V0X2Rvb3JiZWxsKHN0cnVjdCBpbnRl
bF9ndWNfY2xpZW50ICpjbGllbnQpCiAKIHN0YXRpYyBib29sIF9fZG9vcmJlbGxfdmFsaWQoc3Ry
dWN0IGludGVsX2d1YyAqZ3VjLCB1MTYgZGJfaWQpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1
bmNvcmUgPSBndWNfdG9fZ3QoZ3VjKS0+dW5jb3JlOwogCiAJR0VNX0JVR19PTihkYl9pZCA+PSBH
VUNfTlVNX0RPT1JCRUxMUyk7Ci0JcmV0dXJuIEk5MTVfUkVBRChHRU44X0RSQlJFR0woZGJfaWQp
KSAmIEdFTjhfRFJCX1ZBTElEOworCXJldHVybiBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdF
TjhfRFJCUkVHTChkYl9pZCkpICYgR0VOOF9EUkJfVkFMSUQ7CiB9CiAKIHN0YXRpYyB2b2lkIF9f
aW5pdF9kb29yYmVsbChzdHJ1Y3QgaW50ZWxfZ3VjX2NsaWVudCAqY2xpZW50KQpAQCAtMTAwMSw5
ICsxMDAyLDEwIEBAIHZvaWQgaW50ZWxfZ3VjX3N1Ym1pc3Npb25fZmluaShzdHJ1Y3QgaW50ZWxf
Z3VjICpndWMpCiAJCWd1Y19zdGFnZV9kZXNjX3Bvb2xfZGVzdHJveShndWMpOwogfQogCi1zdGF0
aWMgdm9pZCBndWNfaW50ZXJydXB0c19jYXB0dXJlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKK3N0YXRpYyB2b2lkIGd1Y19pbnRlcnJ1cHRzX2NhcHR1cmUoc3RydWN0IGludGVs
X2d0ICpndCkKIHsKLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJw
czsKKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZ3QtPmk5MTUtPmd0X3BtLnJwczsKKwlzdHJ1
Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBndC0+dW5jb3JlOwogCXN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZTsKIAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKIAlpbnQgaXJxczsKQEAg
LTEwMTIsMTYgKzEwMTQsMTYgQEAgc3RhdGljIHZvaWQgZ3VjX2ludGVycnVwdHNfY2FwdHVyZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJICogdG8gR3VDCiAJICovCiAJaXJx
cyA9IF9NQVNLRURfQklUX0VOQUJMRShHRlhfSU5URVJSVVBUX1NURUVSSU5HKTsKLQlmb3JfZWFj
aF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpCisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwg
Z3QtPmk5MTUsIGlkKQogCQlFTkdJTkVfV1JJVEUoZW5naW5lLCBSSU5HX01PREVfR0VONywgaXJx
cyk7CiAKIAkvKiByb3V0ZSBVU0VSX0lOVEVSUlVQVCB0byBIb3N0LCBhbGwgb3RoZXJzIGFyZSBz
ZW50IHRvIEd1Qy4gKi8KIAlpcnFzID0gR1RfUkVOREVSX1VTRVJfSU5URVJSVVBUIDw8IEdFTjhf
UkNTX0lSUV9TSElGVCB8CiAJICAgICAgIEdUX1JFTkRFUl9VU0VSX0lOVEVSUlVQVCA8PCBHRU44
X0JDU19JUlFfU0hJRlQ7CiAJLyogVGhlc2UgdGhyZWUgcmVnaXN0ZXJzIGhhdmUgdGhlIHNhbWUg
Yml0IGRlZmluaXRpb25zICovCi0JSTkxNV9XUklURShHVUNfQkNTX1JDU19JRVIsIH5pcnFzKTsK
LQlJOTE1X1dSSVRFKEdVQ19WQ1MyX1ZDUzFfSUVSLCB+aXJxcyk7Ci0JSTkxNV9XUklURShHVUNf
V0RfVkVDU19JRVIsIH5pcnFzKTsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBHVUNfQkNT
X1JDU19JRVIsIH5pcnFzKTsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBHVUNfVkNTMl9W
Q1MxX0lFUiwgfmlycXMpOworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdVQ19XRF9WRUNT
X0lFUiwgfmlycXMpOwogCiAJLyoKIAkgKiBUaGUgUkVESVJFQ1RfVE9fR1VDIGJpdCBvZiB0aGUg
UE1JTlRSTVNLIHJlZ2lzdGVyIGRpcmVjdHMgYWxsCkBAIC0xMDQ2LDkgKzEwNDgsMTAgQEAgc3Rh
dGljIHZvaWQgZ3VjX2ludGVycnVwdHNfY2FwdHVyZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCiAJcnBzLT5wbV9pbnRybXNrX21ieiAmPSB+R0VOOF9QTUlOVFJfRElTQUJMRV9S
RURJUkVDVF9UT19HVUM7CiB9CiAKLXN0YXRpYyB2b2lkIGd1Y19pbnRlcnJ1cHRzX3JlbGVhc2Uo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQorc3RhdGljIHZvaWQgZ3VjX2ludGVy
cnVwdHNfcmVsZWFzZShzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewotCXN0cnVjdCBpbnRlbF9ycHMg
KnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOworCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZn
dC0+aTkxNS0+Z3RfcG0ucnBzOworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IGd0LT51
bmNvcmU7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwogCWVudW0gaW50ZWxfZW5n
aW5lX2lkIGlkOwogCWludCBpcnFzOwpAQCAtMTA1OSwxMyArMTA2MiwxMyBAQCBzdGF0aWMgdm9p
ZCBndWNfaW50ZXJydXB0c19yZWxlYXNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKIAkgKi8KIAlpcnFzID0gX01BU0tFRF9GSUVMRChHRlhfRk9SV0FSRF9WQkxBTktfTUFTSywg
R0ZYX0ZPUldBUkRfVkJMQU5LX05FVkVSKTsKIAlpcnFzIHw9IF9NQVNLRURfQklUX0RJU0FCTEUo
R0ZYX0lOVEVSUlVQVF9TVEVFUklORyk7Ci0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZGV2X3By
aXYsIGlkKQorCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LT5pOTE1LCBpZCkKIAkJRU5HSU5F
X1dSSVRFKGVuZ2luZSwgUklOR19NT0RFX0dFTjcsIGlycXMpOwogCiAJLyogcm91dGUgYWxsIEdU
IGludGVycnVwdHMgdG8gdGhlIGhvc3QgKi8KLQlJOTE1X1dSSVRFKEdVQ19CQ1NfUkNTX0lFUiwg
MCk7Ci0JSTkxNV9XUklURShHVUNfVkNTMl9WQ1MxX0lFUiwgMCk7Ci0JSTkxNV9XUklURShHVUNf
V0RfVkVDU19JRVIsIDApOworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdVQ19CQ1NfUkNT
X0lFUiwgMCk7CisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR1VDX1ZDUzJfVkNTMV9JRVIs
IDApOworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdVQ19XRF9WRUNTX0lFUiwgMCk7CiAK
IAlycHMtPnBtX2ludHJtc2tfbWJ6IHw9IEdFTjhfUE1JTlRSX0RJU0FCTEVfUkVESVJFQ1RfVE9f
R1VDOwogCXJwcy0+cG1faW50cm1za19tYnogJj0gfkFSQVRfRVhQSVJFRF9JTlRSTVNLOwpAQCAt
MTExNSw3ICsxMTE4LDcgQEAgc3RhdGljIHZvaWQgZ3VjX3NldF9kZWZhdWx0X3N1Ym1pc3Npb24o
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCiBpbnQgaW50ZWxfZ3VjX3N1Ym1pc3Np
b25fZW5hYmxlKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSBndWNfdG9faTkxNShndWMpOworCXN0cnVjdCBpbnRlbF9ndCAqZ3Qg
PSBndWNfdG9fZ3QoZ3VjKTsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CiAJZW51
bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CiAJaW50IGVycjsKQEAgLTExNDAsOSArMTE0Myw5IEBAIGlu
dCBpbnRlbF9ndWNfc3VibWlzc2lvbl9lbmFibGUoc3RydWN0IGludGVsX2d1YyAqZ3VjKQogCQly
ZXR1cm4gZXJyOwogCiAJLyogVGFrZSBvdmVyIGZyb20gbWFudWFsIGNvbnRyb2wgb2YgRUxTUCAo
ZXhlY2xpc3RzKSAqLwotCWd1Y19pbnRlcnJ1cHRzX2NhcHR1cmUoZGV2X3ByaXYpOworCWd1Y19p
bnRlcnJ1cHRzX2NhcHR1cmUoZ3QpOwogCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZGV2X3By
aXYsIGlkKSB7CisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QtPmk5MTUsIGlkKSB7CiAJCWVu
Z2luZS0+c2V0X2RlZmF1bHRfc3VibWlzc2lvbiA9IGd1Y19zZXRfZGVmYXVsdF9zdWJtaXNzaW9u
OwogCQllbmdpbmUtPnNldF9kZWZhdWx0X3N1Ym1pc3Npb24oZW5naW5lKTsKIAl9CkBAIC0xMTUy
LDExICsxMTU1LDExIEBAIGludCBpbnRlbF9ndWNfc3VibWlzc2lvbl9lbmFibGUoc3RydWN0IGlu
dGVsX2d1YyAqZ3VjKQogCiB2b2lkIGludGVsX2d1Y19zdWJtaXNzaW9uX2Rpc2FibGUoc3RydWN0
IGludGVsX2d1YyAqZ3VjKQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IGd1Y190b19pOTE1KGd1Yyk7CisJc3RydWN0IGludGVsX2d0ICpndCA9IGd1Y190b19ndChndWMp
OwogCi0JR0VNX0JVR19PTihkZXZfcHJpdi0+Z3QuYXdha2UpOyAvKiBHVCBzaG91bGQgYmUgcGFy
a2VkIGZpcnN0ICovCisJR0VNX0JVR19PTihndC0+YXdha2UpOyAvKiBHVCBzaG91bGQgYmUgcGFy
a2VkIGZpcnN0ICovCiAKLQlndWNfaW50ZXJydXB0c19yZWxlYXNlKGRldl9wcml2KTsKKwlndWNf
aW50ZXJydXB0c19yZWxlYXNlKGd0KTsKIAlndWNfY2xpZW50c19kaXNhYmxlKGd1Yyk7CiB9CiAK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2h1Yy5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfaHVjLmMKaW5kZXggNTgxYzljM2Q0ZmMwLi45
OWYwZmEyZThmZjUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVs
X2h1Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2h1Yy5jCkBAIC0y
NCw2ICsyNCw3IEBACiAKICNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgogCisjaW5jbHVkZSAiZ3Qv
aW50ZWxfZ3QuaCIKICNpbmNsdWRlICJpbnRlbF9odWMuaCIKICNpbmNsdWRlICJpOTE1X2Rydi5o
IgogCkBAIC00Niw4ICs0Nyw4IEBAIHZvaWQgaW50ZWxfaHVjX2luaXRfZWFybHkoc3RydWN0IGlu
dGVsX2h1YyAqaHVjKQogCiBzdGF0aWMgaW50IGludGVsX2h1Y19yc2FfZGF0YV9jcmVhdGUoc3Ry
dWN0IGludGVsX2h1YyAqaHVjKQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
aHVjX3RvX2k5MTUoaHVjKTsKLQlzdHJ1Y3QgaW50ZWxfZ3VjICpndWMgPSAmaTkxNS0+Z3QudWMu
Z3VjOworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBodWNfdG9fZ3QoaHVjKTsKKwlzdHJ1Y3QgaW50
ZWxfZ3VjICpndWMgPSAmZ3QtPnVjLmd1YzsKIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKIAl2b2lk
ICp2YWRkcjsKIApAQCAtMTEyLDggKzExMyw4IEBAIHZvaWQgaW50ZWxfaHVjX2Zpbmkoc3RydWN0
IGludGVsX2h1YyAqaHVjKQogICovCiBpbnQgaW50ZWxfaHVjX2F1dGgoc3RydWN0IGludGVsX2h1
YyAqaHVjKQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gaHVjX3RvX2k5MTUo
aHVjKTsKLQlzdHJ1Y3QgaW50ZWxfZ3VjICpndWMgPSAmaTkxNS0+Z3QudWMuZ3VjOworCXN0cnVj
dCBpbnRlbF9ndCAqZ3QgPSBodWNfdG9fZ3QoaHVjKTsKKwlzdHJ1Y3QgaW50ZWxfZ3VjICpndWMg
PSAmZ3QtPnVjLmd1YzsKIAlpbnQgcmV0OwogCiAJaWYgKGh1Yy0+ZncubG9hZF9zdGF0dXMgIT0g
SU5URUxfVUNfRklSTVdBUkVfU1VDQ0VTUykKQEAgLTEyNyw3ICsxMjgsNyBAQCBpbnQgaW50ZWxf
aHVjX2F1dGgoc3RydWN0IGludGVsX2h1YyAqaHVjKQogCX0KIAogCS8qIENoZWNrIGF1dGhlbnRp
Y2F0aW9uIHN0YXR1cywgaXQgc2hvdWxkIGJlIGRvbmUgYnkgbm93ICovCi0JcmV0ID0gX19pbnRl
bF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLAorCXJldCA9IF9faW50ZWxfd2FpdF9m
b3JfcmVnaXN0ZXIoZ3QtPnVuY29yZSwKIAkJCQkJaHVjLT5zdGF0dXMucmVnLAogCQkJCQlodWMt
PnN0YXR1cy5tYXNrLAogCQkJCQlodWMtPnN0YXR1cy52YWx1ZSwKQEAgLTE1OSwxNiArMTYwLDE1
IEBAIGludCBpbnRlbF9odWNfYXV0aChzdHJ1Y3QgaW50ZWxfaHVjICpodWMpCiAgKi8KIGludCBp
bnRlbF9odWNfY2hlY2tfc3RhdHVzKHN0cnVjdCBpbnRlbF9odWMgKmh1YykKIHsKLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBodWNfdG9faTkxNShodWMpOworCXN0cnVjdCBp
bnRlbF9ndCAqZ3QgPSBodWNfdG9fZ3QoaHVjKTsKIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsK
IAlib29sIHN0YXR1cyA9IGZhbHNlOwogCi0JaWYgKCFIQVNfSFVDKGRldl9wcml2KSkKKwlpZiAo
IWludGVsX3VjX2lzX3VzaW5nX2h1YygmZ3QtPnVjKSkKIAkJcmV0dXJuIC1FTk9ERVY7CiAKLQl3
aXRoX2ludGVsX3J1bnRpbWVfcG0oJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtlcmVmKQotCQlz
dGF0dXMgPSAoSTkxNV9SRUFEKGh1Yy0+c3RhdHVzLnJlZykgJiBodWMtPnN0YXR1cy5tYXNrKSA9
PQotCQkJICBodWMtPnN0YXR1cy52YWx1ZTsKKwl3aXRoX2ludGVsX3J1bnRpbWVfcG0oJmd0LT5p
OTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKQorCQlzdGF0dXMgPSBpbnRlbF91bmNvcmVfcmVhZChn
dC0+dW5jb3JlLCBodWMtPnN0YXR1cy5yZWcpOwogCi0JcmV0dXJuIHN0YXR1czsKKwlyZXR1cm4g
KHN0YXR1cyAmIGh1Yy0+c3RhdHVzLm1hc2spID09IGh1Yy0+c3RhdHVzLnZhbHVlOwogfQpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfaHVjX2Z3LmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9odWNfZncuYwppbmRleCAwNmU3MjZiYTk4NjMu
LmJlY2ZkMzRhMjZjMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50
ZWxfaHVjX2Z3LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfaHVjX2Z3
LmMKQEAgLTQsNiArNCw3IEBACiAgKiBDb3B5cmlnaHQgwqkgMjAxNC0yMDE4IEludGVsIENvcnBv
cmF0aW9uCiAgKi8KIAorI2luY2x1ZGUgImd0L2ludGVsX2d0LmgiCiAjaW5jbHVkZSAiaW50ZWxf
aHVjX2Z3LmgiCiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKIApAQCAtMTM5LDggKzE0MCw3IEBAIHN0
YXRpYyB2b2lkIGh1Y194ZmVyX3JzYShzdHJ1Y3QgaW50ZWxfaHVjICpodWMpCiBzdGF0aWMgaW50
IGh1Y194ZmVyX3Vjb2RlKHN0cnVjdCBpbnRlbF9odWMgKmh1YykKIHsKIAlzdHJ1Y3QgaW50ZWxf
dWNfZncgKmh1Y19mdyA9ICZodWMtPmZ3OwotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IGh1Y190b19pOTE1KGh1Yyk7Ci0Jc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0g
JmRldl9wcml2LT51bmNvcmU7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gaHVjX3Rv
X2d0KGh1YyktPnVuY29yZTsKIAl1bnNpZ25lZCBsb25nIG9mZnNldCA9IDA7CiAJdTMyIHNpemU7
CiAJaW50IHJldDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVs
X3VjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF91Yy5jCmluZGV4IDBjNDNk
NTQ3YmM5NC4uNDFhNzcwODY1NDc3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC91Yy9pbnRlbF91Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX3Vj
LmMKQEAgLTIyOCw3ICsyMjgsNyBAQCBzdGF0aWMgdm9pZCBndWNfZnJlZV9sb2FkX2Vycl9sb2co
c3RydWN0IGludGVsX2d1YyAqZ3VjKQogICovCiBzdGF0aWMgdm9pZCBndWNfY2xlYXJfbW1pb19t
c2coc3RydWN0IGludGVsX2d1YyAqZ3VjKQogewotCWludGVsX3VuY29yZV93cml0ZSgmZ3VjX3Rv
X2k5MTUoZ3VjKS0+dW5jb3JlLCBTT0ZUX1NDUkFUQ0goMTUpLCAwKTsKKwlpbnRlbF91bmNvcmVf
d3JpdGUoZ3VjX3RvX2d0KGd1YyktPnVuY29yZSwgU09GVF9TQ1JBVENIKDE1KSwgMCk7CiB9CiAK
IHN0YXRpYyB2b2lkIGd1Y19nZXRfbW1pb19tc2coc3RydWN0IGludGVsX2d1YyAqZ3VjKQpAQCAt
MjM3LDcgKzIzNyw3IEBAIHN0YXRpYyB2b2lkIGd1Y19nZXRfbW1pb19tc2coc3RydWN0IGludGVs
X2d1YyAqZ3VjKQogCiAJc3Bpbl9sb2NrX2lycSgmZ3VjLT5pcnFfbG9jayk7CiAKLQl2YWwgPSBp
bnRlbF91bmNvcmVfcmVhZCgmZ3VjX3RvX2k5MTUoZ3VjKS0+dW5jb3JlLCBTT0ZUX1NDUkFUQ0go
MTUpKTsKKwl2YWwgPSBpbnRlbF91bmNvcmVfcmVhZChndWNfdG9fZ3QoZ3VjKS0+dW5jb3JlLCBT
T0ZUX1NDUkFUQ0goMTUpKTsKIAlndWMtPm1taW9fbXNnIHw9IHZhbCAmIGd1Yy0+bXNnX2VuYWJs
ZWRfbWFzazsKIAogCS8qCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dl
bV9ndHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jCmluZGV4IDZkYTU2
NGUyN2E2NC4uMWUzY2NkZjdmZTFiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2dlbV9ndHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuYwpA
QCAtMzMzMywxMCArMzMzMyw4IEBAIGludCBpOTE1X2dndHRfZW5hYmxlX2h3KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlyZXR1cm4gMDsKIH0KIAotdm9pZCBpOTE1X2dndHRf
ZW5hYmxlX2d1YyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKK3ZvaWQgaTkxNV9nZ3R0
X2VuYWJsZV9ndWMoc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCkKIHsKLQlzdHJ1Y3QgaTkxNV9nZ3R0
ICpnZ3R0ID0gJmk5MTUtPmdndHQ7Ci0KIAlHRU1fQlVHX09OKGdndHQtPmludmFsaWRhdGUgIT0g
Z2VuNl9nZ3R0X2ludmFsaWRhdGUpOwogCiAJZ2d0dC0+aW52YWxpZGF0ZSA9IGd1Y19nZ3R0X2lu
dmFsaWRhdGU7CkBAIC0zMzQ0LDEwICszMzQyLDggQEAgdm9pZCBpOTE1X2dndHRfZW5hYmxlX2d1
YyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAlnZ3R0LT5pbnZhbGlkYXRlKGdndHQp
OwogfQogCi12b2lkIGk5MTVfZ2d0dF9kaXNhYmxlX2d1YyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKK3ZvaWQgaTkxNV9nZ3R0X2Rpc2FibGVfZ3VjKHN0cnVjdCBpOTE1X2dndHQgKmdn
dHQpCiB7Ci0Jc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCA9ICZpOTE1LT5nZ3R0OwotCiAJLyogWFhY
IFRlbXBvcmFyeSBwYXJkb24gZm9yIGVycm9yIHVubG9hZCAqLwogCWlmIChnZ3R0LT5pbnZhbGlk
YXRlID09IGdlbjZfZ2d0dF9pbnZhbGlkYXRlKQogCQlyZXR1cm47CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfZ2VtX2d0dC5oCmluZGV4IGE0NTAzNDliM2E1MC4uZGUxNTY2MzRhODg5IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuaAorKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2dlbV9ndHQuaApAQCAtNjMxLDggKzYzMSw4IEBAIGk5MTVfdm1fdG9fcHBn
dHQoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0pCiBpbnQgaTkxNV9nZ3R0X3Byb2JlX2h3
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiBpbnQgaTkxNV9nZ3R0X2luaXRf
aHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKIGludCBpOTE1X2dndHRfZW5h
YmxlX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Ci12b2lkIGk5MTVfZ2d0
dF9lbmFibGVfZ3VjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKLXZvaWQgaTkxNV9n
Z3R0X2Rpc2FibGVfZ3VjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKK3ZvaWQgaTkx
NV9nZ3R0X2VuYWJsZV9ndWMoc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCk7Cit2b2lkIGk5MTVfZ2d0
dF9kaXNhYmxlX2d1YyhzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0KTsKIGludCBpOTE1X2luaXRfZ2d0
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwogdm9pZCBpOTE1X2dndHRfZHJp
dmVyX3JlbGVhc2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKIAotLSAKMi4y
Mi4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRl
bC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6
Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

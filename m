Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 2BE62B0B31
	for <lists+intel-gfx@lfdr.de>; Thu, 12 Sep 2019 11:20:43 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9BEB56EC28;
	Thu, 12 Sep 2019 09:20:41 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga17.intel.com (mga17.intel.com [192.55.52.151])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 371416EC28
 for <intel-gfx@lists.freedesktop.org>; Thu, 12 Sep 2019 09:20:41 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga007.fm.intel.com ([10.253.24.52])
 by fmsmga107.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 12 Sep 2019 02:20:40 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,495,1559545200"; d="scan'208";a="186077925"
Received: from avrahamr-mobl1.ger.corp.intel.com (HELO [10.252.3.203])
 ([10.252.3.203])
 by fmsmga007.fm.intel.com with ESMTP; 12 Sep 2019 02:20:39 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20190911163815.11430-1-chris@chris-wilson.co.uk>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <bc9c4ab1-f161-cfd1-e60a-01747d361bfd@linux.intel.com>
Date: Thu, 12 Sep 2019 10:20:39 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <20190911163815.11430-1-chris@chris-wilson.co.uk>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH] drm/i915/pmu: Use GT parked for estimating
 RC6 while asleep
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDExLzA5LzIwMTkgMTc6MzgsIENocmlzIFdpbHNvbiB3cm90ZToKPiBBcyB3ZSB0cmFjayB3
aGVuIHdlIHB1dCB0aGUgR1QgZGV2aWNlIHRvIHNsZWVwIHVwb24gaWRsaW5nLCB3ZSBjYW4gdXNl
Cj4gdGhhdCBjYWxsYmFjayB0byBzYW1wbGUgdGhlIGN1cnJlbnQgcmM2IGNvdW50ZXJzIGFuZCBy
ZWNvcmQgdGhlCj4gdGltZXN0YW1wIGZvciBlc3RpbWF0aW5nIHNhbXBsZXMgYWZ0ZXIgdGhhdCBw
b2ludCB3aGlsZSBhc2xlZXAuCj4gCj4gdjI6IFN0aWNrIHRvIHVzaW5nIGt0aW1lX3QKPiB2Mzog
VHJhY2sgdXNlcl93YWtlcmVmcyB0aGF0IGludGVyZmVyZSB3aXRoIHRoZSBuZXcKPiBpbnRlbF9n
dF9wbV93YWl0X2Zvcl9pZGxlCj4gCj4gQnVnemlsbGE6IGh0dHBzOi8vYnVncy5mcmVlZGVza3Rv
cC5vcmcvc2hvd19idWcuY2dpP2lkPTEwNTAxMAo+IFNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNv
biA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgo+IENjOiBUdnJ0a28gVXJzdWxpbiA8dHZydGtv
LnVyc3VsaW5AaW50ZWwuY29tPgo+IC0tLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5
MTVfZ2VtX3BtLmMgICB8ICAxOSArKysrCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9ndF90eXBlcy5oIHwgICAxICsKPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdm
cy5jICAgICAgfCAgMjIgKystLS0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11LmMg
ICAgICAgICAgfCAxMjAgKysrKysrKysrKystLS0tLS0tLS0tLS0KPiAgIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfcG11LmggICAgICAgICAgfCAgIDQgKy0KPiAgIDUgZmlsZXMgY2hhbmdlZCwg
OTAgaW5zZXJ0aW9ucygrKSwgNzYgZGVsZXRpb25zKC0pCj4gCj4gZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX3BtLmMKPiBpbmRleCAzYmQ3NjQxMDRkNDEuLjQ1YTcyY2I2OThkYiAxMDA2
NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYwo+ICsrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5jCj4gQEAgLTE0MSw2ICsxNDEs
MjEgQEAgYm9vbCBpOTE1X2dlbV9sb2FkX3Bvd2VyX2NvbnRleHQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCj4gICAJcmV0dXJuIHN3aXRjaF90b19rZXJuZWxfY29udGV4dF9zeW5jKCZp
OTE1LT5ndCk7Cj4gICB9Cj4gICAKPiArc3RhdGljIHZvaWQgdXNlcl9mb3JjZXdha2Uoc3RydWN0
IGludGVsX2d0ICpndCwgYm9vbCBzdXNwZW5kKQo+ICt7Cj4gKwlpbnQgY291bnQgPSBhdG9taWNf
cmVhZCgmZ3QtPnVzZXJfd2FrZXJlZik7Cj4gKwo+ICsJaWYgKGxpa2VseSghY291bnQpKQo+ICsJ
CXJldHVybjsKPiArCj4gKwlpbnRlbF9ndF9wbV9nZXQoZ3QpOwo+ICsJaWYgKHN1c3BlbmQpCj4g
KwkJYXRvbWljX3N1Yihjb3VudCwgJmd0LT53YWtlcmVmLmNvdW50KTsKPiArCWVsc2UKPiArCQlh
dG9taWNfYWRkKGNvdW50LCAmZ3QtPndha2VyZWYuY291bnQpOwo+ICsJaW50ZWxfZ3RfcG1fcHV0
KGd0KTsKPiArfQo+ICsKPiAgIHZvaWQgaTkxNV9nZW1fc3VzcGVuZChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAgIAlHRU1fVFJBQ0UoIlxuIik7Cj4gQEAgLTE0OCw2ICsx
NjMsOCBAQCB2b2lkIGk5MTVfZ2VtX3N1c3BlbmQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCj4gICAJaW50ZWxfd2FrZXJlZl9hdXRvKCZpOTE1LT5nZ3R0LnVzZXJmYXVsdF93YWtlcmVm
LCAwKTsKPiAgIAlmbHVzaF93b3JrcXVldWUoaTkxNS0+d3EpOwo+ICAgCj4gKwl1c2VyX2ZvcmNl
d2FrZSgmaTkxNS0+Z3QsIHRydWUpOwoKVGhpcyBjb21wbGljYXRpb24gaXMgbmVlZGVkIG9ubHkg
YmVjYXVzZSB5b3UgY2hhbmdlZCB1c2VyIGZvcmNld2FrZSAKaGFuZGxpbmcgdG8gdXNlIGludGVs
X2d0X3BtX2dldC9wdXQgaW5zdGVhZCBvZiBpbnRlbF9ydW50aW1lX3BtX2dldD8gCldoaWNoIGlu
IHR1cm4gaXMgYmVjYXVzZSBvZiB0aGUgQ09ORklHX1BNIGlmZGVmIHJlbW92YWwgYmVsb3c/IFdv
dWxkbid0IAppdCBiZSBzaW1wbGVyIHRvIGtlZXAgYm90aCBhcyB3ZXJlPyBNYXliZSBJIGFtIG1p
c3Npbmcgc29tZXRoaW5nLi4uCgo+ICsKPiAgIAltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0
X211dGV4KTsKPiAgIAo+ICAgCS8qCj4gQEAgLTI1OSw2ICsyNzYsOCBAQCB2b2lkIGk5MTVfZ2Vt
X3Jlc3VtZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIAlpZiAoIWk5MTVfZ2Vt
X2xvYWRfcG93ZXJfY29udGV4dChpOTE1KSkKPiAgIAkJZ290byBlcnJfd2VkZ2VkOwo+ICAgCj4g
Kwl1c2VyX2ZvcmNld2FrZSgmaTkxNS0+Z3QsIGZhbHNlKTsKPiArCj4gICBvdXRfdW5sb2NrOgo+
ICAgCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9B
TEwpOwo+ICAgCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3R5cGVzLmggYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF90eXBlcy5oCj4gaW5kZXggZGMyOTVjMTk2ZDExLi4z
MDM5Y2VmNjRiMTEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
Z3RfdHlwZXMuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3R5cGVz
LmgKPiBAQCAtNTAsNiArNTAsNyBAQCBzdHJ1Y3QgaW50ZWxfZ3Qgewo+ICAgCX0gdGltZWxpbmVz
Owo+ICAgCj4gICAJc3RydWN0IGludGVsX3dha2VyZWYgd2FrZXJlZjsKPiArCWF0b21pY190IHVz
ZXJfd2FrZXJlZjsKPiAgIAo+ICAgCXN0cnVjdCBsaXN0X2hlYWQgY2xvc2VkX3ZtYTsKPiAgIAlz
cGlubG9ja190IGNsb3NlZF9sb2NrOyAvKiBndWFyZHMgdGhlIGxpc3Qgb2YgY2xvc2VkX3ZtYSAq
Lwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCj4gaW5kZXggNzA4ODU1ZTA1MWI1Li5m
MDBjMGRjNGY1N2UgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1
Z2ZzLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwo+IEBAIC0z
OTg4LDEzICszOTg4LDEyIEBAIHN0YXRpYyBpbnQgaTkxNV9zc2V1X3N0YXR1cyhzdHJ1Y3Qgc2Vx
X2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKPiAgIHN0YXRpYyBpbnQgaTkxNV9mb3JjZXdha2Vfb3Bl
bihzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZmlsZSkKPiAgIHsKPiAgIAlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGlub2RlLT5pX3ByaXZhdGU7Cj4gKwlzdHJ1Y3Qg
aW50ZWxfZ3QgKmd0ID0gJmk5MTUtPmd0Owo+ICAgCj4gLQlpZiAoSU5URUxfR0VOKGk5MTUpIDwg
NikKPiAtCQlyZXR1cm4gMDsKPiAtCj4gLQlmaWxlLT5wcml2YXRlX2RhdGEgPQo+IC0JCSh2b2lk
ICopKHVpbnRwdHJfdClpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7Cj4g
LQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3VzZXJfZ2V0KCZpOTE1LT51bmNvcmUpOwo+ICsJYXRv
bWljX2luYygmZ3QtPnVzZXJfd2FrZXJlZik7Cj4gKwlpbnRlbF9ndF9wbV9nZXQoZ3QpOwo+ICsJ
aWYgKElOVEVMX0dFTihpOTE1KSA+PSA2KQo+ICsJCWludGVsX3VuY29yZV9mb3JjZXdha2VfdXNl
cl9nZXQoZ3QtPnVuY29yZSk7Cj4gICAKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiBAQCAtNDAwMiwx
MyArNDAwMSwxMiBAQCBzdGF0aWMgaW50IGk5MTVfZm9yY2V3YWtlX29wZW4oc3RydWN0IGlub2Rl
ICppbm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpCj4gICBzdGF0aWMgaW50IGk5MTVfZm9yY2V3YWtl
X3JlbGVhc2Uoc3RydWN0IGlub2RlICppbm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpCj4gICB7Cj4g
ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBpbm9kZS0+aV9wcml2YXRlOwo+ICsJ
c3RydWN0IGludGVsX2d0ICpndCA9ICZpOTE1LT5ndDsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihp
OTE1KSA8IDYpCj4gLQkJcmV0dXJuIDA7Cj4gLQo+IC0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV91
c2VyX3B1dCgmaTkxNS0+dW5jb3JlKTsKPiAtCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5y
dW50aW1lX3BtLAo+IC0JCQkgICAgIChpbnRlbF93YWtlcmVmX3QpKHVpbnRwdHJfdClmaWxlLT5w
cml2YXRlX2RhdGEpOwo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA2KQo+ICsJCWludGVsX3Vu
Y29yZV9mb3JjZXdha2VfdXNlcl9wdXQoJmk5MTUtPnVuY29yZSk7Cj4gKwlpbnRlbF9ndF9wbV9w
dXQoZ3QpOwo+ICsJYXRvbWljX2RlYygmZ3QtPnVzZXJfd2FrZXJlZik7Cj4gICAKPiAgIAlyZXR1
cm4gMDsKPiAgIH0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wbXUu
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11LmMKPiBpbmRleCA4ZTI1MWU3MTkzOTAu
LmEzZDNkM2UzOWMxNSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3Bt
dS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wbXUuYwo+IEBAIC0xMTYsMTkg
KzExNiw1MSBAQCBzdGF0aWMgYm9vbCBwbXVfbmVlZHNfdGltZXIoc3RydWN0IGk5MTVfcG11ICpw
bXUsIGJvb2wgZ3B1X2FjdGl2ZSkKPiAgIAlyZXR1cm4gZW5hYmxlOwo+ICAgfQo+ICAgCj4gK3N0
YXRpYyB1NjQgX19nZXRfcmM2KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCj4gK3sKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3QtPmk5MTU7Cj4gKwl1NjQgdmFsOwo+ICsKPiArCXZh
bCA9IGludGVsX3JjNl9yZXNpZGVuY3lfbnMoaTkxNSwKPiArCQkJCSAgICAgSVNfVkFMTEVZVklF
VyhpOTE1KSA/Cj4gKwkJCQkgICAgIFZMVl9HVF9SRU5ERVJfUkM2IDoKPiArCQkJCSAgICAgR0VO
Nl9HVF9HRlhfUkM2KTsKPiArCj4gKwlpZiAoSEFTX1JDNnAoaTkxNSkpCj4gKwkJdmFsICs9IGlu
dGVsX3JjNl9yZXNpZGVuY3lfbnMoaTkxNSwgR0VONl9HVF9HRlhfUkM2cCk7Cj4gKwo+ICsJaWYg
KEhBU19SQzZwcChpOTE1KSkKPiArCQl2YWwgKz0gaW50ZWxfcmM2X3Jlc2lkZW5jeV9ucyhpOTE1
LCBHRU42X0dUX0dGWF9SQzZwcCk7Cj4gKwo+ICsJcmV0dXJuIHZhbDsKPiArfQo+ICsKPiAgIHZv
aWQgaTkxNV9wbXVfZ3RfcGFya2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAg
ewo+ICAgCXN0cnVjdCBpOTE1X3BtdSAqcG11ID0gJmk5MTUtPnBtdTsKPiArCXU2NCB2YWw7Cj4g
ICAKPiAgIAlpZiAoIXBtdS0+YmFzZS5ldmVudF9pbml0KQo+ICAgCQlyZXR1cm47Cj4gICAKPiAg
IAlzcGluX2xvY2tfaXJxKCZwbXUtPmxvY2spOwo+ICsKPiArCXZhbCA9IDA7Cj4gKwlpZiAocG11
LT5zYW1wbGVbX19JOTE1X1NBTVBMRV9SQzZdLmN1cikKPiArCQl2YWwgPSBfX2dldF9yYzYoJmk5
MTUtPmd0KTsKPiArCj4gKwlpZiAodmFsID49IHBtdS0+c2FtcGxlW19fSTkxNV9TQU1QTEVfUkM2
X0VTVElNQVRFRF0uY3VyKSB7Cj4gKwkJcG11LT5zYW1wbGVbX19JOTE1X1NBTVBMRV9SQzZfRVNU
SU1BVEVEXS5jdXIgPSAwOwo+ICsJCXBtdS0+c2FtcGxlW19fSTkxNV9TQU1QTEVfUkM2XS5jdXIg
PSB2YWw7Cj4gKwl9Cj4gKwlwbXUtPnNsZWVwX2xhc3QgPSBrdGltZV9nZXQoKTsKPiArCj4gICAJ
LyoKPiAgIAkgKiBTaWduYWwgc2FtcGxpbmcgdGltZXIgdG8gc3RvcCBpZiBvbmx5IGVuZ2luZSBl
dmVudHMgYXJlIGVuYWJsZWQgYW5kCj4gICAJICogR1BVIHdlbnQgaWRsZS4KPiAgIAkgKi8KPiAg
IAlwbXUtPnRpbWVyX2VuYWJsZWQgPSBwbXVfbmVlZHNfdGltZXIocG11LCBmYWxzZSk7Cj4gKwo+
ICAgCXNwaW5fdW5sb2NrX2lycSgmcG11LT5sb2NrKTsKPiAgIH0KPiAgIAo+IEBAIC0xNDMsNiAr
MTc1LDExIEBAIHN0YXRpYyB2b2lkIF9faTkxNV9wbXVfbWF5YmVfc3RhcnRfdGltZXIoc3RydWN0
IGk5MTVfcG11ICpwbXUpCj4gICAJfQo+ICAgfQo+ICAgCj4gK3N0YXRpYyBpbmxpbmUgczY0IGt0
aW1lX3NpbmNlKGNvbnN0IGt0aW1lX3Qga3QpCj4gK3sKPiArCXJldHVybiBrdGltZV90b19ucyhr
dGltZV9zdWIoa3RpbWVfZ2V0KCksIGt0KSk7Cj4gK30KPiArCj4gICB2b2lkIGk5MTVfcG11X2d0
X3VucGFya2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgewo+ICAgCXN0cnVj
dCBpOTE1X3BtdSAqcG11ID0gJmk5MTUtPnBtdTsKPiBAQCAtMTUxLDEwICsxODgsMjIgQEAgdm9p
ZCBpOTE1X3BtdV9ndF91bnBhcmtlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAg
IAkJcmV0dXJuOwo+ICAgCj4gICAJc3Bpbl9sb2NrX2lycSgmcG11LT5sb2NrKTsKPiArCj4gICAJ
LyoKPiAgIAkgKiBSZS1lbmFibGUgc2FtcGxpbmcgdGltZXIgd2hlbiBHUFUgZ29lcyBhY3RpdmUu
Cj4gICAJICovCj4gICAJX19pOTE1X3BtdV9tYXliZV9zdGFydF90aW1lcihwbXUpOwo+ICsKPiAr
CS8qIEVzdGltYXRlIGhvdyBsb25nIHdlIHNsZXB0IGFuZCBhY2N1bXVsYXRlIHRoYXQgaW50byBy
YzYgY291bnRlcnMgKi8KPiArCWlmIChwbXUtPnNhbXBsZVtfX0k5MTVfU0FNUExFX1JDNl0uY3Vy
KSB7Cj4gKwkJdTY0IHZhbDsKPiArCj4gKwkJdmFsID0ga3RpbWVfc2luY2UocG11LT5zbGVlcF9s
YXN0KTsKPiArCQl2YWwgKz0gcG11LT5zYW1wbGVbX19JOTE1X1NBTVBMRV9SQzZdLmN1cjsKPiAr
Cj4gKwkJcG11LT5zYW1wbGVbX19JOTE1X1NBTVBMRV9SQzZfRVNUSU1BVEVEXS5jdXIgPSB2YWw7
Cj4gKwl9Cj4gKwo+ICAgCXNwaW5fdW5sb2NrX2lycSgmcG11LT5sb2NrKTsKPiAgIH0KPiAgIAo+
IEBAIC00MjYsMzkgKzQ3NSwxOCBAQCBzdGF0aWMgaW50IGk5MTVfcG11X2V2ZW50X2luaXQoc3Ry
dWN0IHBlcmZfZXZlbnQgKmV2ZW50KQo+ICAgCXJldHVybiAwOwo+ICAgfQo+ICAgCj4gLXN0YXRp
YyB1NjQgX19nZXRfcmM2KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCj4gLXsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gZ3QtPmk5MTU7Cj4gLQl1NjQgdmFsOwo+IC0KPiAtCXZhbCA9
IGludGVsX3JjNl9yZXNpZGVuY3lfbnMoaTkxNSwKPiAtCQkJCSAgICAgSVNfVkFMTEVZVklFVyhp
OTE1KSA/Cj4gLQkJCQkgICAgIFZMVl9HVF9SRU5ERVJfUkM2IDoKPiAtCQkJCSAgICAgR0VONl9H
VF9HRlhfUkM2KTsKPiAtCj4gLQlpZiAoSEFTX1JDNnAoaTkxNSkpCj4gLQkJdmFsICs9IGludGVs
X3JjNl9yZXNpZGVuY3lfbnMoaTkxNSwgR0VONl9HVF9HRlhfUkM2cCk7Cj4gLQo+IC0JaWYgKEhB
U19SQzZwcChpOTE1KSkKPiAtCQl2YWwgKz0gaW50ZWxfcmM2X3Jlc2lkZW5jeV9ucyhpOTE1LCBH
RU42X0dUX0dGWF9SQzZwcCk7Cj4gLQo+IC0JcmV0dXJuIHZhbDsKPiAtfQo+IC0KPiAgIHN0YXRp
YyB1NjQgZ2V0X3JjNihzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQo+ICAgewo+IC0jaWYgSVNfRU5BQkxF
RChDT05GSUdfUE0pCj4gICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndC0+aTkx
NTsKPiAtCXN0cnVjdCBpbnRlbF9ydW50aW1lX3BtICpycG0gPSAmaTkxNS0+cnVudGltZV9wbTsK
PiAgIAlzdHJ1Y3QgaTkxNV9wbXUgKnBtdSA9ICZpOTE1LT5wbXU7Cj4gLQlpbnRlbF93YWtlcmVm
X3Qgd2FrZXJlZjsKPiAgIAl1bnNpZ25lZCBsb25nIGZsYWdzOwo+ICAgCXU2NCB2YWw7Cj4gICAK
PiAtCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UocnBtKTsKPiAtCWlm
ICh3YWtlcmVmKSB7Cj4gKwlzcGluX2xvY2tfaXJxc2F2ZSgmcG11LT5sb2NrLCBmbGFncyk7Cj4g
Kwo+ICsJaWYgKGludGVsX2d0X3BtX2dldF9pZl9hd2FrZShndCkpIHsKPiAgIAkJdmFsID0gX19n
ZXRfcmM2KGd0KTsKPiAtCQlpbnRlbF9ydW50aW1lX3BtX3B1dChycG0sIHdha2VyZWYpOwo+ICsJ
CWludGVsX2d0X3BtX3B1dChndCk7Cj4gICAKPiAgIAkJLyoKPiAgIAkJICogSWYgd2UgYXJlIGNv
bWluZyBiYWNrIGZyb20gYmVpbmcgcnVudGltZSBzdXNwZW5kZWQgd2UgbXVzdAo+IEBAIC00NjYs
MTkgKzQ5NCwxMyBAQCBzdGF0aWMgdTY0IGdldF9yYzYoc3RydWN0IGludGVsX2d0ICpndCkKPiAg
IAkJICogcHJldmlvdXNseS4KPiAgIAkJICovCj4gICAKPiAtCQlzcGluX2xvY2tfaXJxc2F2ZSgm
cG11LT5sb2NrLCBmbGFncyk7Cj4gLQo+ICAgCQlpZiAodmFsID49IHBtdS0+c2FtcGxlW19fSTkx
NV9TQU1QTEVfUkM2X0VTVElNQVRFRF0uY3VyKSB7Cj4gICAJCQlwbXUtPnNhbXBsZVtfX0k5MTVf
U0FNUExFX1JDNl9FU1RJTUFURURdLmN1ciA9IDA7Cj4gICAJCQlwbXUtPnNhbXBsZVtfX0k5MTVf
U0FNUExFX1JDNl0uY3VyID0gdmFsOwo+ICAgCQl9IGVsc2Ugewo+ICAgCQkJdmFsID0gcG11LT5z
YW1wbGVbX19JOTE1X1NBTVBMRV9SQzZfRVNUSU1BVEVEXS5jdXI7Cj4gICAJCX0KPiAtCj4gLQkJ
c3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmcG11LT5sb2NrLCBmbGFncyk7CgpGb3IgdGhpcyBicmFu
Y2ggcG11LT5sb2NrIGlzIG9ubHkgbmVlZGVkIG92ZXIgdGhlIGVzdGltYXRpb24gYmxvY2ssIG5v
dCAKb3ZlciBfX2dldF9yYzYoKSBhbmQgaW50ZWxfZ3RfcG1fZ2V0X2lmX2F3YWtlKCkuIEJ1dCBJ
IGFncmVlIGl0J3MgbW9yZSAKZWZmaWNpZW50IHRvIGRvIGl0IGxpa2UgdGhpcyB0byBhdm9pZCBt
dWx0aXBsZSBpcnEtb2ZmLW9uIHRyYW5zaXRpb25zIAp2aWEgaW50ZWxfcmM2X3Jlc2lkZW5jeV9u
cy4gSSB3YW50ZWQgdG8gc3VnZ2VzdCBsb2NhbF9pcnFfZGlzYWJsZSBhbmQgCnNlcGFyYXRlIHNw
aW5fKHVuKWxvY2sncyBvbiBib3RoIGlmIGJyYW5jaGVzIGZvciBtb3JlIHNlbGYtZG9jdW1lbnRp
bmcgLCAKbGVzcyBjb25mdXNpb24sIGJ1dCB0aGVuIHNpbmdsZSBjYWxsIGFsc28gaGFzIGl0J3Mg
YmVuZWZpdHMuCgo+ICAgCX0gZWxzZSB7Cj4gLQkJc3RydWN0IGRldmljZSAqa2RldiA9IHJwbS0+
a2RldjsKPiAtCj4gICAJCS8qCj4gICAJCSAqIFdlIGFyZSBydW50aW1lIHN1c3BlbmRlZC4KPiAg
IAkJICoKPiBAQCAtNDg2LDQyICs1MDgsMTYgQEAgc3RhdGljIHU2NCBnZXRfcmM2KHN0cnVjdCBp
bnRlbF9ndCAqZ3QpCj4gICAJCSAqIG9uIHRvcCBvZiB0aGUgbGFzdCBrbm93biByZWFsIHZhbHVl
LCBhcyB0aGUgYXBwcm94aW1hdGVkIFJDNgo+ICAgCQkgKiBjb3VudGVyIHZhbHVlLgo+ICAgCQkg
Ki8KPiAtCQlzcGluX2xvY2tfaXJxc2F2ZSgmcG11LT5sb2NrLCBmbGFncyk7Cj4gICAKPiAtCQkv
Kgo+IC0JCSAqIEFmdGVyIHRoZSBhYm92ZSBicmFuY2ggaW50ZWxfcnVudGltZV9wbV9nZXRfaWZf
aW5fdXNlIGZhaWxlZAo+IC0JCSAqIHRvIGdldCB0aGUgcnVudGltZSBQTSByZWZlcmVuY2Ugd2Ug
Y2Fubm90IGFzc3VtZSB3ZSBhcmUgaW4KPiAtCQkgKiBydW50aW1lIHN1c3BlbmQgc2luY2Ugd2Ug
Y2FuIGVpdGhlcjogYSkgcmFjZSB3aXRoIGNvbWluZyBvdXQKPiAtCQkgKiBvZiBpdCBiZWZvcmUg
d2UgdG9vayB0aGUgcG93ZXIubG9jaywgb3IgYikgdGhlcmUgYXJlIG90aGVyCj4gLQkJICogc3Rh
dGVzIHRoYW4gc3VzcGVuZGVkIHdoaWNoIGNhbiBicmluZyB1cyBoZXJlLgo+IC0JCSAqCj4gLQkJ
ICogV2UgbmVlZCB0byBkb3VibGUtY2hlY2sgdGhhdCB3ZSBhcmUgaW5kZWVkIGN1cnJlbnRseSBy
dW50aW1lCj4gLQkJICogc3VzcGVuZGVkIGFuZCBpZiBub3Qgd2UgY2Fubm90IGRvIGJldHRlciB0
aGFuIHJlcG9ydCB0aGUgbGFzdAo+IC0JCSAqIGtub3duIFJDNiB2YWx1ZS4KPiAtCQkgKi8KPiAt
CQlpZiAocG1fcnVudGltZV9zdGF0dXNfc3VzcGVuZGVkKGtkZXYpKSB7Cj4gLQkJCXZhbCA9IHBt
X3J1bnRpbWVfc3VzcGVuZGVkX3RpbWUoa2Rldik7Cj4gKwkJdmFsID0ga3RpbWVfc2luY2UocG11
LT5zbGVlcF9sYXN0KTsKPiArCQl2YWwgKz0gcG11LT5zYW1wbGVbX19JOTE1X1NBTVBMRV9SQzZd
LmN1cjsKPiAgIAo+IC0JCQlpZiAoIXBtdS0+c2FtcGxlW19fSTkxNV9TQU1QTEVfUkM2X0VTVElN
QVRFRF0uY3VyKQo+IC0JCQkJcG11LT5zdXNwZW5kZWRfdGltZV9sYXN0ID0gdmFsOwo+IC0KPiAt
CQkJdmFsIC09IHBtdS0+c3VzcGVuZGVkX3RpbWVfbGFzdDsKPiAtCQkJdmFsICs9IHBtdS0+c2Ft
cGxlW19fSTkxNV9TQU1QTEVfUkM2XS5jdXI7Cj4gLQo+IC0JCQlwbXUtPnNhbXBsZVtfX0k5MTVf
U0FNUExFX1JDNl9FU1RJTUFURURdLmN1ciA9IHZhbDsKPiAtCQl9IGVsc2UgaWYgKHBtdS0+c2Ft
cGxlW19fSTkxNV9TQU1QTEVfUkM2X0VTVElNQVRFRF0uY3VyKSB7Cj4gLQkJCXZhbCA9IHBtdS0+
c2FtcGxlW19fSTkxNV9TQU1QTEVfUkM2X0VTVElNQVRFRF0uY3VyOwo+IC0JCX0gZWxzZSB7Cj4g
LQkJCXZhbCA9IHBtdS0+c2FtcGxlW19fSTkxNV9TQU1QTEVfUkM2XS5jdXI7Cj4gLQkJfQo+IC0K
PiAtCQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZwbXUtPmxvY2ssIGZsYWdzKTsKPiArCQlwbXUt
PnNhbXBsZVtfX0k5MTVfU0FNUExFX1JDNl9FU1RJTUFURURdLmN1ciA9IHZhbDsKPiAgIAl9Cj4g
ICAKPiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnBtdS0+bG9jaywgZmxhZ3MpOwo+ICsKPiAg
IAlyZXR1cm4gdmFsOwo+IC0jZWxzZQo+IC0JcmV0dXJuIF9fZ2V0X3JjNihndCk7Cj4gLSNlbmRp
ZgoKRG9uJ3Qgd2UgZW5kIHVwIGRvaW5nIHRoZSBpcnFzYXZlIHNwaW5sb2NrIG5lZWRsZXNzbHkg
d2hlbiAhQ09ORklHX1BNPwoKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHU2NCBfX2k5MTVfcG11X2V2
ZW50X3JlYWQoc3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50KQo+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wbXUu
aAo+IGluZGV4IDRmYzRmMjQ3ODMwMS4uMDY3ZGJiZjNiZGZmIDEwMDY0NAo+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11LmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3BtdS5oCj4gQEAgLTk3LDkgKzk3LDkgQEAgc3RydWN0IGk5MTVfcG11IHsKPiAgIAkgKi8K
PiAgIAlzdHJ1Y3QgaTkxNV9wbXVfc2FtcGxlIHNhbXBsZVtfX0k5MTVfTlVNX1BNVV9TQU1QTEVS
U107Cj4gICAJLyoqCj4gLQkgKiBAc3VzcGVuZGVkX3RpbWVfbGFzdDogQ2FjaGVkIHN1c3BlbmQg
dGltZSBmcm9tIFBNIGNvcmUuCj4gKwkgKiBAc2xlZXBfbGFzdDogTGFzdCB0aW1lIEdUIHBhcmtl
ZCBmb3IgUkM2IGVzdGltYXRpb24uCj4gICAJICovCj4gLQl1NjQgc3VzcGVuZGVkX3RpbWVfbGFz
dDsKPiArCWt0aW1lX3Qgc2xlZXBfbGFzdDsKPiAgIAkvKioKPiAgIAkgKiBAaTkxNV9hdHRyOiBN
ZW1vcnkgYmxvY2sgaG9sZGluZyBkZXZpY2UgYXR0cmlidXRlcy4KPiAgIAkgKi8KPiAKClJlZ2Fy
ZHMsCgpUdnJ0a28KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
Cmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

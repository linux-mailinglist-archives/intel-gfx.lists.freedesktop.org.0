Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id D5F4F11EC65
	for <lists+intel-gfx@lfdr.de>; Fri, 13 Dec 2019 22:01:11 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 452BF6EDC5;
	Fri, 13 Dec 2019 21:01:10 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from 8.mo69.mail-out.ovh.net (8.mo69.mail-out.ovh.net
 [46.105.56.233])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 075F56EDC5
 for <intel-gfx@lists.freedesktop.org>; Fri, 13 Dec 2019 21:01:09 +0000 (UTC)
Received: from player796.ha.ovh.net (unknown [10.109.143.24])
 by mo69.mail-out.ovh.net (Postfix) with ESMTP id 8494078DC8
 for <intel-gfx@lists.freedesktop.org>; Fri, 13 Dec 2019 22:01:06 +0100 (CET)
Received: from etezian.org (net-37-116-49-191.cust.vodafonedsl.it
 [37.116.49.191]) (Authenticated sender: andi@etezian.org)
 by player796.ha.ovh.net (Postfix) with ESMTPSA id 00508D2503B5;
 Fri, 13 Dec 2019 21:01:00 +0000 (UTC)
From: Andi Shyti <andi@etezian.org>
To: Intel GFX <intel-gfx@lists.freedesktop.org>
Date: Fri, 13 Dec 2019 23:00:50 +0200
Message-Id: <20191213210050.33611-3-andi@etezian.org>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191213210050.33611-1-andi@etezian.org>
References: <20191213210050.33611-1-andi@etezian.org>
MIME-Version: 1.0
X-Ovh-Tracer-Id: 18163580250504479325
X-VR-SPAMSTATE: OK
X-VR-SPAMSCORE: -100
X-VR-SPAMCAUSE: gggruggvucftvghtrhhoucdtuddrgedufedrudelledgudeggecutefuodetggdotefrodftvfcurfhrohhfihhlvgemucfqggfjpdevjffgvefmvefgnecuuegrihhlohhuthemucehtddtnecusecvtfgvtghiphhivghnthhsucdlqddutddtmdenucfjughrpefhvffufffkofgjfhggtgfgsehtkeertdertdejnecuhfhrohhmpeetnhguihcuufhhhihtihcuoegrnhguihesvghtvgiiihgrnhdrohhrgheqnecukfhppedtrddtrddtrddtpdefjedrudduiedrgeelrdduledunecurfgrrhgrmhepmhhouggvpehsmhhtphdqohhuthdphhgvlhhopehplhgrhigvrhejleeirdhhrgdrohhvhhdrnhgvthdpihhnvghtpedtrddtrddtrddtpdhmrghilhhfrhhomheprghnughisegvthgviihirghnrdhorhhgpdhrtghpthhtohepihhnthgvlhdqghhfgieslhhishhtshdrfhhrvggvuggvshhkthhophdrohhrghenucevlhhushhtvghrufhiiigvpedt
Subject: [Intel-gfx] [PATCH v5 2/2] drm/i915/gt: Move power management debug
 files into a gt aware debugfs
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogQW5kaSBTaHl0aSA8YW5kaS5zaHl0aUBpbnRlbC5jb20+CgpUaGUgR1Qgc3lzdGVtIGlz
IGJlY29taW5nIG1vcmUgYW5kIG1vcmUgYSBzdGFuZC1hbG9uZSBzeXN0ZW0gaW4KaTkxNSBhbmQg
aXQncyBmYWlyIHRvIGFzc2lnbiBpdCBpdHMgb3duIGRlYnVnZnMgZGlyZWN0b3J5LgoKcmM2LCBy
cHMgYW5kIGxsYyBkZWJ1Z2ZzIGZpbGVzIGFyZSBndCByZWxhdGVkLCBtb3ZlIHRoZW0gaW50byB0
aGUKZ3QgZGVidWdmcyBkaXJlY3RvcnkuCgpTaWduZWQtb2ZmLWJ5OiBBbmRpIFNoeXRpIDxhbmRp
LnNoeXRpQGludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZSAgICAg
ICAgICAgICAgfCAgIDIgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZGVidWdmc19n
dC5jIHwgIDIzICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2RlYnVnZnNfZ3QuaCB8
ICAyNyArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9kZWJ1Z2ZzX3BtLmMgfCA2MjMg
KysrKysrKysrKysrKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9kZWJ1
Z2ZzX3BtLmggfCAgMTYgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMgICAg
ICAgIHwgNTc5ICstLS0tLS0tLS0tLS0tLS0tLS0KIDYgZmlsZXMgY2hhbmdlZCwgNzAwIGluc2Vy
dGlvbnMoKyksIDU3MCBkZWxldGlvbnMoLSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9kZWJ1Z2ZzX2d0LmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9kZWJ1Z2ZzX2d0LmgKIGNyZWF0ZSBtb2RlIDEwMDY0
NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9kZWJ1Z2ZzX3BtLmMKIGNyZWF0ZSBtb2Rl
IDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9kZWJ1Z2ZzX3BtLmgKCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L01ha2VmaWxlCmluZGV4IGUwZmQxMGMwY2ZiOC4uNjFlNDEwMmVhNjI2IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9NYWtlZmlsZQpAQCAtNzcsNiArNzcsOCBAQCBvYmoteSArPSBndC8KIGd0LXkgKz0gXAogCWd0
L2ludGVsX2JyZWFkY3J1bWJzLm8gXAogCWd0L2ludGVsX2NvbnRleHQubyBcCisJZ3QvaW50ZWxf
ZGVidWdmc19ndC5vIFwKKwlndC9pbnRlbF9kZWJ1Z2ZzX3BtLm8gXAogCWd0L2ludGVsX2VuZ2lu
ZV9jcy5vIFwKIAlndC9pbnRlbF9lbmdpbmVfaGVhcnRiZWF0Lm8gXAogCWd0L2ludGVsX2VuZ2lu
ZV9wbS5vIFwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2RlYnVn
ZnNfZ3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2RlYnVnZnNfZ3QuYwpuZXcg
ZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmY4NjZhM2JjNGFhOQotLS0gL2Rl
di9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2RlYnVnZnNfZ3QuYwpA
QCAtMCwwICsxLDIzIEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCisKKy8qCisg
KiBDb3B5cmlnaHQgwqkgMjAxOSBJbnRlbCBDb3Jwb3JhdGlvbgorICovCisKKyNpbmNsdWRlICJp
OTE1X3RyYWNlLmgiCisjaW5jbHVkZSAiaW50ZWxfZGVidWdmc19wbS5oIgorCitpbnQgZGVidWdm
c19ndF9pbml0KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCit7CisJc3RydWN0IGRlbnRyeSAqZGVidWdm
c19yb290ID0gZ3QtPmk5MTUtPmRybS5wcmltYXJ5LT5kZWJ1Z2ZzX3Jvb3Q7CisJc3RydWN0IGRl
bnRyeSAqZ3Rfcm9vdDsKKworCWlmICghZGVidWdmc19yb290KQorCQlyZXR1cm4gLUVOT0RFVjsK
KworCWd0X3Jvb3QgPSBkZWJ1Z2ZzX2NyZWF0ZV9kaXIoImd0IiwgZGVidWdmc19yb290KTsKKwlp
ZiAoSVNfRVJSKGd0X3Jvb3QpKQorCQlyZXR1cm4gUFRSX0VSUihndF9yb290KTsKKworCXJldHVy
biBpbnRlbF9ndF9wbV9kZWJ1Z2ZzX3JlZ2lzdGVyKGd0LCBndF9yb290KTsKK30KZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2RlYnVnZnNfZ3QuaCBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2RlYnVnZnNfZ3QuaApuZXcgZmlsZSBtb2RlIDEwMDY0NApp
bmRleCAwMDAwMDAwMDAwMDAuLjMxZTZiNGI1ODYxZQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2RlYnVnZnNfZ3QuaApAQCAtMCwwICsxLDI3IEBACisv
LyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCisKKy8qCisgKiBDb3B5cmlnaHQgwqkgMjAx
OSBJbnRlbCBDb3Jwb3JhdGlvbgorICovCisKKyNpZm5kZWYgREVCVUdGU19HVAorI2RlZmluZSBE
RUJVR0ZTX0dUCisKKyNpbmNsdWRlICJpbnRlbF9ndF90eXBlcy5oIgorCisjZGVmaW5lIERFRklO
RV9HVF9ERUJVR0ZTX0FUVFJJQlVURShfX25hbWUpCQkJCVwKK3N0YXRpYyBpbnQgX19uYW1lICMj
IF9vcGVuKHN0cnVjdCBpbm9kZSAqaW5vZGUsIHN0cnVjdCBmaWxlICpmaWxlKQlcCit7CQkJCQkJ
CQkJXAorCXJldHVybiBzaW5nbGVfb3BlbihmaWxlLCBfX25hbWUgIyMgX3Nob3csIGlub2RlLT5p
X3ByaXZhdGUpOwlcCit9CQkJCQkJCQkJXAorc3RhdGljIGNvbnN0IHN0cnVjdCBmaWxlX29wZXJh
dGlvbnMgX19uYW1lICMjIF9mb3BzID0gewkJCVwKKwkub3duZXIgPSBUSElTX01PRFVMRSwJCQkJ
CQlcCisJLm9wZW4gPSBfX25hbWUgIyMgX29wZW4sCQkJCQlcCisJLnJlYWQgPSBzZXFfcmVhZCwJ
CQkJCQlcCisJLmxsc2VlayA9IHNlcV9sc2VlaywJCQkJCQlcCisJLnJlbGVhc2UgPSBzaW5nbGVf
cmVsZWFzZSwJCQkJCVwKK30KKworaW50IGRlYnVnZnNfZ3RfaW5pdChzdHJ1Y3QgaW50ZWxfZ3Qg
Kmd0KTsKKworI2VuZGlmIC8qIERFQlVHRlNfR1QgKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2RlYnVnZnNfcG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2RlYnVnZnNfcG0uYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAw
MDAuLjMyNDhiMDQxYmI1MwotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2RlYnVnZnNfcG0uYwpAQCAtMCwwICsxLDYyMyBAQAorLy8gU1BEWC1MaWNlbnNl
LUlkZW50aWZpZXI6IE1JVAorCisvKgorICogQ29weXJpZ2h0IMKpIDIwMTkgSW50ZWwgQ29ycG9y
YXRpb24KKyAqLworCisjaW5jbHVkZSAiaTkxNV9kZWJ1Z2ZzLmgiCisjaW5jbHVkZSAiaTkxNV90
cmFjZS5oIgorI2luY2x1ZGUgImludGVsX2RlYnVnZnNfcG0uaCIKKyNpbmNsdWRlICJpbnRlbF9k
ZWJ1Z2ZzX2d0LmgiCisjaW5jbHVkZSAiaW50ZWxfcmM2LmgiCisjaW5jbHVkZSAiaW50ZWxfcnBz
LmgiCisjaW5jbHVkZSAiaW50ZWxfc2lkZWJhbmQuaCIKKworc3RhdGljIGludCBmb3JjZXdha2Vf
ZG9tYWluc19zaG93KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKK3sKKwlzdHJ1Y3Qg
aW50ZWxfZ3QgKmd0ID0gbS0+cHJpdmF0ZTsKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUg
PSBndC0+dW5jb3JlOworCXN0cnVjdCBpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2RvbWFpbiAqZndf
ZG9tYWluOworCXVuc2lnbmVkIGludCB0bXA7CisKKwlzZXFfcHJpbnRmKG0sICJ1c2VyLmJ5cGFz
c19jb3VudCA9ICV1XG4iLAorCQkgICB1bmNvcmUtPnVzZXJfZm9yY2V3YWtlX2NvdW50KTsKKwor
CWZvcl9lYWNoX2Z3X2RvbWFpbihmd19kb21haW4sIHVuY29yZSwgdG1wKQorCQlzZXFfcHJpbnRm
KG0sICIlcy53YWtlX2NvdW50ID0gJXVcbiIsCisJCQkgICBpbnRlbF91bmNvcmVfZm9yY2V3YWtl
X2RvbWFpbl90b19zdHIoZndfZG9tYWluLT5pZCksCisJCQkgICBSRUFEX09OQ0UoZndfZG9tYWlu
LT53YWtlX2NvdW50KSk7CisKKwlyZXR1cm4gMDsKK30KK0RFRklORV9HVF9ERUJVR0ZTX0FUVFJJ
QlVURShmb3JjZXdha2VfZG9tYWlucyk7CisKK3N0YXRpYyB2b2lkIHByaW50X3JjNl9yZXMoc3Ry
dWN0IHNlcV9maWxlICptLAorCQkJICBjb25zdCBjaGFyICp0aXRsZSwKKwkJCSAgY29uc3QgaTkx
NV9yZWdfdCByZWcpCit7CisJc3RydWN0IGludGVsX2d0ICpndCA9IG0tPnByaXZhdGU7CisJaW50
ZWxfd2FrZXJlZl90IHdha2VyZWY7CisKKwl3aXRoX2ludGVsX3J1bnRpbWVfcG0oZ3QtPnVuY29y
ZS0+cnBtLCB3YWtlcmVmKQorCQlzZXFfcHJpbnRmKG0sICIlcyAldSAoJWxsdSB1cylcbiIsIHRp
dGxlLAorCQkJICAgaW50ZWxfdW5jb3JlX3JlYWQoZ3QtPnVuY29yZSwgcmVnKSwKKwkJCSAgIGlu
dGVsX3JjNl9yZXNpZGVuY3lfdXMoJmd0LT5yYzYsIHJlZykpOworfQorCitzdGF0aWMgaW50IHZs
dl9kcnBjX2luZm8oc3RydWN0IHNlcV9maWxlICptKQoreworCXN0cnVjdCBpbnRlbF9ndCAqZ3Qg
PSBtLT5wcml2YXRlOworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IGd0LT51bmNvcmU7
CisJdTMyIHJjY3RsMSwgcHdfc3RhdHVzOworCisJcHdfc3RhdHVzID0gaW50ZWxfdW5jb3JlX3Jl
YWQodW5jb3JlLCBWTFZfR1RMQ19QV19TVEFUVVMpOworCXJjY3RsMSA9IGludGVsX3VuY29yZV9y
ZWFkKHVuY29yZSwgR0VONl9SQ19DT05UUk9MKTsKKworCXNlcV9wcmludGYobSwgIlJDNiBFbmFi
bGVkOiAlc1xuIiwKKwkJICAgeWVzbm8ocmNjdGwxICYgKEdFTjdfUkNfQ1RMX1RPX01PREUgfAor
CQkJCQlHRU42X1JDX0NUTF9FSV9NT0RFKDEpKSkpOworCXNlcV9wcmludGYobSwgIlJlbmRlciBQ
b3dlciBXZWxsOiAlc1xuIiwKKwkJICAgKHB3X3N0YXR1cyAmIFZMVl9HVExDX1BXX1JFTkRFUl9T
VEFUVVNfTUFTSykgPyAiVXAiIDogIkRvd24iKTsKKwlzZXFfcHJpbnRmKG0sICJNZWRpYSBQb3dl
ciBXZWxsOiAlc1xuIiwKKwkJICAgKHB3X3N0YXR1cyAmIFZMVl9HVExDX1BXX01FRElBX1NUQVRV
U19NQVNLKSA/ICJVcCIgOiAiRG93biIpOworCisJcHJpbnRfcmM2X3JlcyhtLCAiUmVuZGVyIFJD
NiByZXNpZGVuY3kgc2luY2UgYm9vdDoiLCBWTFZfR1RfUkVOREVSX1JDNik7CisJcHJpbnRfcmM2
X3JlcyhtLCAiTWVkaWEgUkM2IHJlc2lkZW5jeSBzaW5jZSBib290OiIsIFZMVl9HVF9NRURJQV9S
QzYpOworCisJcmV0dXJuIGZvcmNld2FrZV9kb21haW5zX3Nob3cobSwgTlVMTCk7Cit9CisKK3N0
YXRpYyBpbnQgZ2VuNl9kcnBjX2luZm8oc3RydWN0IHNlcV9maWxlICptKQoreworCXN0cnVjdCBp
bnRlbF9ndCAqZ3QgPSBtLT5wcml2YXRlOworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gZ3QtPmk5MTU7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gZ3QtPnVuY29yZTsK
Kwl1MzIgZ3RfY29yZV9zdGF0dXMsIHJjY3RsMSwgcmM2dmlkcyA9IDA7CisJdTMyIGdlbjlfcG93
ZXJnYXRlX2VuYWJsZSA9IDAsIGdlbjlfcG93ZXJnYXRlX3N0YXR1cyA9IDA7CisKKwlndF9jb3Jl
X3N0YXR1cyA9IGludGVsX3VuY29yZV9yZWFkX2Z3KHVuY29yZSwgR0VONl9HVF9DT1JFX1NUQVRV
Uyk7CisJdHJhY2VfaTkxNV9yZWdfcncoZmFsc2UsIEdFTjZfR1RfQ09SRV9TVEFUVVMsIGd0X2Nv
cmVfc3RhdHVzLCA0LCB0cnVlKTsKKworCXJjY3RsMSA9IGludGVsX3VuY29yZV9yZWFkKHVuY29y
ZSwgR0VONl9SQ19DT05UUk9MKTsKKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkpIHsKKwkJZ2Vu
OV9wb3dlcmdhdGVfZW5hYmxlID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLAorCQkJCQkJR0VO
OV9QR19FTkFCTEUpOworCQlnZW45X3Bvd2VyZ2F0ZV9zdGF0dXMgPSBpbnRlbF91bmNvcmVfcmVh
ZCh1bmNvcmUsCisJCQkJCQlHRU45X1BXUkdUX0RPTUFJTl9TVEFUVVMpOworCX0KKworCWlmIChJ
TlRFTF9HRU4oaTkxNSkgPD0gNykKKwkJc2FuZHlicmlkZ2VfcGNvZGVfcmVhZChpOTE1LCBHRU42
X1BDT0RFX1JFQURfUkM2VklEUywKKwkJCQkgICAgICAgJnJjNnZpZHMsIE5VTEwpOworCisJc2Vx
X3ByaW50ZihtLCAiUkMxZSBFbmFibGVkOiAlc1xuIiwKKwkJICAgeWVzbm8ocmNjdGwxICYgR0VO
Nl9SQ19DVExfUkMxZV9FTkFCTEUpKTsKKwlzZXFfcHJpbnRmKG0sICJSQzYgRW5hYmxlZDogJXNc
biIsCisJCSAgIHllc25vKHJjY3RsMSAmIEdFTjZfUkNfQ1RMX1JDNl9FTkFCTEUpKTsKKwlpZiAo
SU5URUxfR0VOKGk5MTUpID49IDkpIHsKKwkJc2VxX3ByaW50ZihtLCAiUmVuZGVyIFdlbGwgR2F0
aW5nIEVuYWJsZWQ6ICVzXG4iLAorCQkJeWVzbm8oZ2VuOV9wb3dlcmdhdGVfZW5hYmxlICYgR0VO
OV9SRU5ERVJfUEdfRU5BQkxFKSk7CisJCXNlcV9wcmludGYobSwgIk1lZGlhIFdlbGwgR2F0aW5n
IEVuYWJsZWQ6ICVzXG4iLAorCQkJeWVzbm8oZ2VuOV9wb3dlcmdhdGVfZW5hYmxlICYgR0VOOV9N
RURJQV9QR19FTkFCTEUpKTsKKwl9CisJc2VxX3ByaW50ZihtLCAiRGVlcCBSQzYgRW5hYmxlZDog
JXNcbiIsCisJCSAgIHllc25vKHJjY3RsMSAmIEdFTjZfUkNfQ1RMX1JDNnBfRU5BQkxFKSk7CisJ
c2VxX3ByaW50ZihtLCAiRGVlcGVzdCBSQzYgRW5hYmxlZDogJXNcbiIsCisJCSAgIHllc25vKHJj
Y3RsMSAmIEdFTjZfUkNfQ1RMX1JDNnBwX0VOQUJMRSkpOworCXNlcV9wdXRzKG0sICJDdXJyZW50
IFJDIHN0YXRlOiAiKTsKKwlzd2l0Y2ggKGd0X2NvcmVfc3RhdHVzICYgR0VONl9SQ25fTUFTSykg
eworCWNhc2UgR0VONl9SQzA6CisJCWlmIChndF9jb3JlX3N0YXR1cyAmIEdFTjZfQ09SRV9DUERf
U1RBVEVfTUFTSykKKwkJCXNlcV9wdXRzKG0sICJDb3JlIFBvd2VyIERvd25cbiIpOworCQllbHNl
CisJCQlzZXFfcHV0cyhtLCAib25cbiIpOworCQlicmVhazsKKwljYXNlIEdFTjZfUkMzOgorCQlz
ZXFfcHV0cyhtLCAiUkMzXG4iKTsKKwkJYnJlYWs7CisJY2FzZSBHRU42X1JDNjoKKwkJc2VxX3B1
dHMobSwgIlJDNlxuIik7CisJCWJyZWFrOworCWNhc2UgR0VONl9SQzc6CisJCXNlcV9wdXRzKG0s
ICJSQzdcbiIpOworCQlicmVhazsKKwlkZWZhdWx0OgorCQlzZXFfcHV0cyhtLCAiVW5rbm93blxu
Iik7CisJCWJyZWFrOworCX0KKworCXNlcV9wcmludGYobSwgIkNvcmUgUG93ZXIgRG93bjogJXNc
biIsCisJCSAgIHllc25vKGd0X2NvcmVfc3RhdHVzICYgR0VONl9DT1JFX0NQRF9TVEFURV9NQVNL
KSk7CisJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KSB7CisJCXNlcV9wcmludGYobSwgIlJlbmRl
ciBQb3dlciBXZWxsOiAlc1xuIiwKKwkJCShnZW45X3Bvd2VyZ2F0ZV9zdGF0dXMgJgorCQkJIEdF
TjlfUFdSR1RfUkVOREVSX1NUQVRVU19NQVNLKSA/ICJVcCIgOiAiRG93biIpOworCQlzZXFfcHJp
bnRmKG0sICJNZWRpYSBQb3dlciBXZWxsOiAlc1xuIiwKKwkJCShnZW45X3Bvd2VyZ2F0ZV9zdGF0
dXMgJgorCQkJIEdFTjlfUFdSR1RfTUVESUFfU1RBVFVTX01BU0spID8gIlVwIiA6ICJEb3duIik7
CisJfQorCisJLyogTm90IGV4YWN0bHkgc3VyZSB3aGF0IHRoaXMgaXMgKi8KKwlwcmludF9yYzZf
cmVzKG0sICJSQzYgXCJMb2NrZWQgdG8gUlBuXCIgcmVzaWRlbmN5IHNpbmNlIGJvb3Q6IiwKKwkJ
ICAgICAgR0VONl9HVF9HRlhfUkM2X0xPQ0tFRCk7CisJcHJpbnRfcmM2X3JlcyhtLCAiUkM2IHJl
c2lkZW5jeSBzaW5jZSBib290OiIsIEdFTjZfR1RfR0ZYX1JDNik7CisJcHJpbnRfcmM2X3Jlcyht
LCAiUkM2KyByZXNpZGVuY3kgc2luY2UgYm9vdDoiLCBHRU42X0dUX0dGWF9SQzZwKTsKKwlwcmlu
dF9yYzZfcmVzKG0sICJSQzYrKyByZXNpZGVuY3kgc2luY2UgYm9vdDoiLCBHRU42X0dUX0dGWF9S
QzZwcCk7CisKKwlpZiAoSU5URUxfR0VOKGk5MTUpIDw9IDcpIHsKKwkJc2VxX3ByaW50ZihtLCAi
UkM2ICAgdm9sdGFnZTogJWRtVlxuIiwKKwkJCSAgIEdFTjZfREVDT0RFX1JDNl9WSUQoKChyYzZ2
aWRzID4+IDApICYgMHhmZikpKTsKKwkJc2VxX3ByaW50ZihtLCAiUkM2KyAgdm9sdGFnZTogJWRt
VlxuIiwKKwkJCSAgIEdFTjZfREVDT0RFX1JDNl9WSUQoKChyYzZ2aWRzID4+IDgpICYgMHhmZikp
KTsKKwkJc2VxX3ByaW50ZihtLCAiUkM2Kysgdm9sdGFnZTogJWRtVlxuIiwKKwkJCSAgIEdFTjZf
REVDT0RFX1JDNl9WSUQoKChyYzZ2aWRzID4+IDE2KSAmIDB4ZmYpKSk7CisJfQorCisJcmV0dXJu
IGZvcmNld2FrZV9kb21haW5zX3Nob3cobSwgTlVMTCk7Cit9CisKK3N0YXRpYyBpbnQgaXJvbmxh
a2VfZHJwY19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSkKK3sKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0
ID0gbS0+cHJpdmF0ZTsKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBndC0+dW5jb3Jl
OworCXUzMiByZ3Ztb2RlY3RsLCByc3RkYnljdGw7CisJdTE2IGNyc3RhbmR2aWQ7CisKKwlyZ3Zt
b2RlY3RsID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBNRU1NT0RFQ1RMKTsKKwlyc3RkYnlj
dGwgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIFJTVERCWUNUTCk7CisJY3JzdGFuZHZpZCA9
IGludGVsX3VuY29yZV9yZWFkMTYodW5jb3JlLCBDUlNUQU5EVklEKTsKKworCXNlcV9wcmludGYo
bSwgIkhEIGJvb3N0OiAlc1xuIiwgeWVzbm8ocmd2bW9kZWN0bCAmIE1FTU1PREVfQk9PU1RfRU4p
KTsKKwlzZXFfcHJpbnRmKG0sICJCb29zdCBmcmVxOiAlZFxuIiwKKwkJICAgKHJndm1vZGVjdGwg
JiBNRU1NT0RFX0JPT1NUX0ZSRVFfTUFTSykgPj4KKwkJICAgTUVNTU9ERV9CT09TVF9GUkVRX1NI
SUZUKTsKKwlzZXFfcHJpbnRmKG0sICJIVyBjb250cm9sIGVuYWJsZWQ6ICVzXG4iLAorCQkgICB5
ZXNubyhyZ3Ztb2RlY3RsICYgTUVNTU9ERV9IV0lETEVfRU4pKTsKKwlzZXFfcHJpbnRmKG0sICJT
VyBjb250cm9sIGVuYWJsZWQ6ICVzXG4iLAorCQkgICB5ZXNubyhyZ3Ztb2RlY3RsICYgTUVNTU9E
RV9TV01PREVfRU4pKTsKKwlzZXFfcHJpbnRmKG0sICJHYXRlZCB2b2x0YWdlIGNoYW5nZTogJXNc
biIsCisJCSAgIHllc25vKHJndm1vZGVjdGwgJiBNRU1NT0RFX1JDTEtfR0FURSkpOworCXNlcV9w
cmludGYobSwgIlN0YXJ0aW5nIGZyZXF1ZW5jeTogUCVkXG4iLAorCQkgICAocmd2bW9kZWN0bCAm
IE1FTU1PREVfRlNUQVJUX01BU0spID4+IE1FTU1PREVfRlNUQVJUX1NISUZUKTsKKwlzZXFfcHJp
bnRmKG0sICJNYXggUC1zdGF0ZTogUCVkXG4iLAorCQkgICAocmd2bW9kZWN0bCAmIE1FTU1PREVf
Rk1BWF9NQVNLKSA+PiBNRU1NT0RFX0ZNQVhfU0hJRlQpOworCXNlcV9wcmludGYobSwgIk1pbiBQ
LXN0YXRlOiBQJWRcbiIsIChyZ3Ztb2RlY3RsICYgTUVNTU9ERV9GTUlOX01BU0spKTsKKwlzZXFf
cHJpbnRmKG0sICJSUzEgVklEOiAlZFxuIiwgKGNyc3RhbmR2aWQgJiAweDNmKSk7CisJc2VxX3By
aW50ZihtLCAiUlMyIFZJRDogJWRcbiIsICgoY3JzdGFuZHZpZCA+PiA4KSAmIDB4M2YpKTsKKwlz
ZXFfcHJpbnRmKG0sICJSZW5kZXIgc3RhbmRieSBlbmFibGVkOiAlc1xuIiwKKwkJICAgeWVzbm8o
IShyc3RkYnljdGwgJiBSQ1hfU1dfRVhJVCkpKTsKKwlzZXFfcHV0cyhtLCAiQ3VycmVudCBSUyBz
dGF0ZTogIik7CisJc3dpdGNoIChyc3RkYnljdGwgJiBSU1hfU1RBVFVTX01BU0spIHsKKwljYXNl
IFJTWF9TVEFUVVNfT046CisJCXNlcV9wdXRzKG0sICJvblxuIik7CisJCWJyZWFrOworCWNhc2Ug
UlNYX1NUQVRVU19SQzE6CisJCXNlcV9wdXRzKG0sICJSQzFcbiIpOworCQlicmVhazsKKwljYXNl
IFJTWF9TVEFUVVNfUkMxRToKKwkJc2VxX3B1dHMobSwgIlJDMUVcbiIpOworCQlicmVhazsKKwlj
YXNlIFJTWF9TVEFUVVNfUlMxOgorCQlzZXFfcHV0cyhtLCAiUlMxXG4iKTsKKwkJYnJlYWs7CisJ
Y2FzZSBSU1hfU1RBVFVTX1JTMjoKKwkJc2VxX3B1dHMobSwgIlJTMiAoUkM2KVxuIik7CisJCWJy
ZWFrOworCWNhc2UgUlNYX1NUQVRVU19SUzM6CisJCXNlcV9wdXRzKG0sICJSQzMgKFJDNispXG4i
KTsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJc2VxX3B1dHMobSwgInVua25vd25cbiIpOworCQli
cmVhazsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBkcnBjX2luZm9fc2hvdyhz
dHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKK3sKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0
ID0gbS0+cHJpdmF0ZTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd0LT5pOTE1
OworCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOworCWludCBlcnIgPSAtRU5PREVWOworCisJd2l0
aF9pbnRlbF9ydW50aW1lX3BtKGd0LT51bmNvcmUtPnJwbSwgd2FrZXJlZikgeworCQlpZiAoSVNf
VkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKQorCQkJZXJyID0gdmx2X2Ry
cGNfaW5mbyhtKTsKKwkJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDYpCisJCQllcnIgPSBn
ZW42X2RycGNfaW5mbyhtKTsKKwkJZWxzZQorCQkJZXJyID0gaXJvbmxha2VfZHJwY19pbmZvKG0p
OworCX0KKworCXJldHVybiBlcnI7Cit9CitERUZJTkVfR1RfREVCVUdGU19BVFRSSUJVVEUoZHJw
Y19pbmZvKTsKKworc3RhdGljIGludCBmcmVxdWVuY3lfaW5mb19zaG93KHN0cnVjdCBzZXFfZmls
ZSAqbSwgdm9pZCAqdW51c2VkKQoreworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBtLT5wcml2YXRl
OworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3QtPmk5MTU7CisJc3RydWN0IGlu
dGVsX3VuY29yZSAqdW5jb3JlID0gZ3QtPnVuY29yZTsKKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMg
PSAmZ3QtPnJwczsKKwlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKKworCXdha2VyZWYgPSBpbnRl
bF9ydW50aW1lX3BtX2dldCh1bmNvcmUtPnJwbSk7CisKKwlpZiAoSVNfR0VOKGk5MTUsIDUpKSB7
CisJCXUxNiByZ3Zzd2N0bCA9IGludGVsX3VuY29yZV9yZWFkMTYodW5jb3JlLCBNRU1TV0NUTCk7
CisJCXUxNiByZ3ZzdGF0ID0gaW50ZWxfdW5jb3JlX3JlYWQxNih1bmNvcmUsIE1FTVNUQVRfSUxL
KTsKKworCQlzZXFfcHJpbnRmKG0sICJSZXF1ZXN0ZWQgUC1zdGF0ZTogJWRcbiIsIChyZ3Zzd2N0
bCA+PiA4KSAmIDB4Zik7CisJCXNlcV9wcmludGYobSwgIlJlcXVlc3RlZCBWSUQ6ICVkXG4iLCBy
Z3Zzd2N0bCAmIDB4M2YpOworCQlzZXFfcHJpbnRmKG0sICJDdXJyZW50IFZJRDogJWRcbiIsIChy
Z3ZzdGF0ICYgTUVNU1RBVF9WSURfTUFTSykgPj4KKwkJCSAgIE1FTVNUQVRfVklEX1NISUZUKTsK
KwkJc2VxX3ByaW50ZihtLCAiQ3VycmVudCBQLXN0YXRlOiAlZFxuIiwKKwkJCSAgIChyZ3ZzdGF0
ICYgTUVNU1RBVF9QU1RBVEVfTUFTSykgPj4gTUVNU1RBVF9QU1RBVEVfU0hJRlQpOworCX0gZWxz
ZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKSB7CisJCXUz
MiBycG1vZGVjdGwsIGZyZXFfc3RzOworCisJCXJwbW9kZWN0bCA9IGludGVsX3VuY29yZV9yZWFk
KHVuY29yZSwgR0VONl9SUF9DT05UUk9MKTsKKwkJc2VxX3ByaW50ZihtLCAiVmlkZW8gVHVyYm8g
TW9kZTogJXNcbiIsCisJCQkgICB5ZXNubyhycG1vZGVjdGwgJiBHRU42X1JQX01FRElBX1RVUkJP
KSk7CisJCXNlcV9wcmludGYobSwgIkhXIGNvbnRyb2wgZW5hYmxlZDogJXNcbiIsCisJCQkgICB5
ZXNubyhycG1vZGVjdGwgJiBHRU42X1JQX0VOQUJMRSkpOworCQlzZXFfcHJpbnRmKG0sICJTVyBj
b250cm9sIGVuYWJsZWQ6ICVzXG4iLAorCQkJICAgeWVzbm8oKHJwbW9kZWN0bCAmIEdFTjZfUlBf
TUVESUFfTU9ERV9NQVNLKSA9PQorCQkJCSAgR0VONl9SUF9NRURJQV9TV19NT0RFKSk7CisKKwkJ
dmx2X3B1bml0X2dldChpOTE1KTsKKwkJZnJlcV9zdHMgPSB2bHZfcHVuaXRfcmVhZChpOTE1LCBQ
VU5JVF9SRUdfR1BVX0ZSRVFfU1RTKTsKKwkJdmx2X3B1bml0X3B1dChpOTE1KTsKKworCQlzZXFf
cHJpbnRmKG0sICJQVU5JVF9SRUdfR1BVX0ZSRVFfU1RTOiAweCUwOHhcbiIsIGZyZXFfc3RzKTsK
KwkJc2VxX3ByaW50ZihtLCAiRERSIGZyZXE6ICVkIE1IelxuIiwgaTkxNS0+bWVtX2ZyZXEpOwor
CisJCXNlcV9wcmludGYobSwgImFjdHVhbCBHUFUgZnJlcTogJWQgTUh6XG4iLAorCQkJICAgaW50
ZWxfZ3B1X2ZyZXEocnBzLCAoZnJlcV9zdHMgPj4gOCkgJiAweGZmKSk7CisKKwkJc2VxX3ByaW50
ZihtLCAiY3VycmVudCBHUFUgZnJlcTogJWQgTUh6XG4iLAorCQkJICAgaW50ZWxfZ3B1X2ZyZXEo
cnBzLCBycHMtPmN1cl9mcmVxKSk7CisKKwkJc2VxX3ByaW50ZihtLCAibWF4IEdQVSBmcmVxOiAl
ZCBNSHpcbiIsCisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWF4X2ZyZXEpKTsKKwor
CQlzZXFfcHJpbnRmKG0sICJtaW4gR1BVIGZyZXE6ICVkIE1IelxuIiwKKwkJCSAgIGludGVsX2dw
dV9mcmVxKHJwcywgcnBzLT5taW5fZnJlcSkpOworCisJCXNlcV9wcmludGYobSwgImlkbGUgR1BV
IGZyZXE6ICVkIE1IelxuIiwKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5pZGxlX2Zy
ZXEpKTsKKworCQlzZXFfcHJpbnRmKG0sICJlZmZpY2llbnQgKFJQZSkgZnJlcXVlbmN5OiAlZCBN
SHpcbiIsCisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+ZWZmaWNpZW50X2ZyZXEpKTsK
Kwl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA2KSB7CisJCXUzMiBycF9zdGF0ZV9saW1p
dHM7CisJCXUzMiBndF9wZXJmX3N0YXR1czsKKwkJdTMyIHJwX3N0YXRlX2NhcDsKKwkJdTMyIHJw
bW9kZWN0bCwgcnBpbmNsaW1pdCwgcnBkZWNsaW1pdDsKKwkJdTMyIHJwc3RhdCwgY2FnZiwgcmVx
ZjsKKwkJdTMyIHJwdXBlaSwgcnBjdXJ1cCwgcnBwcmV2dXA7CisJCXUzMiBycGRvd25laSwgcnBj
dXJkb3duLCBycHByZXZkb3duOworCQl1MzIgcG1faWVyLCBwbV9pbXIsIHBtX2lzciwgcG1faWly
LCBwbV9tYXNrOworCQlpbnQgbWF4X2ZyZXE7CisKKwkJcnBfc3RhdGVfbGltaXRzID0gaW50ZWxf
dW5jb3JlX3JlYWQodW5jb3JlLCBHRU42X1JQX1NUQVRFX0xJTUlUUyk7CisJCWlmIChJU19HRU45
X0xQKGk5MTUpKSB7CisJCQlycF9zdGF0ZV9jYXAgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUs
IEJYVF9SUF9TVEFURV9DQVApOworCQkJZ3RfcGVyZl9zdGF0dXMgPSBpbnRlbF91bmNvcmVfcmVh
ZCh1bmNvcmUsIEJYVF9HVF9QRVJGX1NUQVRVUyk7CisJCX0gZWxzZSB7CisJCQlycF9zdGF0ZV9j
YXAgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUlBfU1RBVEVfQ0FQKTsKKwkJCWd0
X3BlcmZfc3RhdHVzID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU42X0dUX1BFUkZfU1RB
VFVTKTsKKwkJfQorCisJCS8qIFJQU1RBVDEgaXMgaW4gdGhlIEdUIHBvd2VyIHdlbGwgKi8KKwkJ
aW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQodW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKKworCQly
ZXFmID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU42X1JQTlNXUkVRKTsKKwkJaWYgKElO
VEVMX0dFTihpOTE1KSA+PSA5KQorCQkJcmVxZiA+Pj0gMjM7CisJCWVsc2UgeworCQkJcmVxZiAm
PSB+R0VONl9UVVJCT19ESVNBQkxFOworCQkJaWYgKElTX0hBU1dFTEwoaTkxNSkgfHwgSVNfQlJP
QURXRUxMKGk5MTUpKQorCQkJCXJlcWYgPj49IDI0OworCQkJZWxzZQorCQkJCXJlcWYgPj49IDI1
OworCQl9CisJCXJlcWYgPSBpbnRlbF9ncHVfZnJlcShycHMsIHJlcWYpOworCisJCXJwbW9kZWN0
bCA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VONl9SUF9DT05UUk9MKTsKKwkJcnBpbmNs
aW1pdCA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VONl9SUF9VUF9USFJFU0hPTEQpOwor
CQlycGRlY2xpbWl0ID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU42X1JQX0RPV05fVEhS
RVNIT0xEKTsKKworCQlycHN0YXQgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUlBT
VEFUMSk7CisJCXJwdXBlaSA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VONl9SUF9DVVJf
VVBfRUkpICYgR0VONl9DVVJJQ09OVF9NQVNLOworCQlycGN1cnVwID0gaW50ZWxfdW5jb3JlX3Jl
YWQodW5jb3JlLCBHRU42X1JQX0NVUl9VUCkgJiBHRU42X0NVUkJTWVRBVkdfTUFTSzsKKwkJcnBw
cmV2dXAgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUlBfUFJFVl9VUCkgJiBHRU42
X0NVUkJTWVRBVkdfTUFTSzsKKwkJcnBkb3duZWkgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUs
IEdFTjZfUlBfQ1VSX0RPV05fRUkpICYgR0VONl9DVVJJQVZHX01BU0s7CisJCXJwY3VyZG93biA9
IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VONl9SUF9DVVJfRE9XTikgJiBHRU42X0NVUkJT
WVRBVkdfTUFTSzsKKwkJcnBwcmV2ZG93biA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VO
Nl9SUF9QUkVWX0RPV04pICYgR0VONl9DVVJCU1lUQVZHX01BU0s7CisJCWNhZ2YgPSBpbnRlbF9y
cHNfcmVhZF9hY3R1YWxfZnJlcXVlbmN5KHJwcyk7CisKKwkJaW50ZWxfdW5jb3JlX2ZvcmNld2Fr
ZV9wdXQodW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKKworCQlpZiAoSU5URUxfR0VOKGk5MTUpID49
IDExKSB7CisJCQlwbV9pZXIgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjExX0dQTV9X
R0JPWFBFUkZfSU5UUl9FTkFCTEUpOworCQkJcG1faW1yID0gaW50ZWxfdW5jb3JlX3JlYWQodW5j
b3JlLCBHRU4xMV9HUE1fV0dCT1hQRVJGX0lOVFJfTUFTSyk7CisJCQkvKgorCQkJICogVGhlIGVx
dWl2YWxlbnQgdG8gdGhlIFBNIElTUiAmIElJUiBjYW5ub3QgYmUgcmVhZAorCQkJICogd2l0aG91
dCBhZmZlY3RpbmcgdGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIHN5c3RlbQorCQkJICovCisJCQlw
bV9pc3IgPSAwOworCQkJcG1faWlyID0gMDsKKwkJfSBlbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkg
Pj0gOCkgeworCQkJcG1faWVyID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU44X0dUX0lF
UigyKSk7CisJCQlwbV9pbXIgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjhfR1RfSU1S
KDIpKTsKKwkJCXBtX2lzciA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VOOF9HVF9JU1Io
MikpOworCQkJcG1faWlyID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU44X0dUX0lJUigy
KSk7CisJCX0gZWxzZSB7CisJCQlwbV9pZXIgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdF
TjZfUE1JRVIpOworCQkJcG1faW1yID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU42X1BN
SU1SKTsKKwkJCXBtX2lzciA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VONl9QTUlTUik7
CisJCQlwbV9paXIgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUE1JSVIpOworCQl9
CisJCXBtX21hc2sgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUE1JTlRSTVNLKTsK
KworCQlzZXFfcHJpbnRmKG0sICJWaWRlbyBUdXJibyBNb2RlOiAlc1xuIiwKKwkJCSAgIHllc25v
KHJwbW9kZWN0bCAmIEdFTjZfUlBfTUVESUFfVFVSQk8pKTsKKwkJc2VxX3ByaW50ZihtLCAiSFcg
Y29udHJvbCBlbmFibGVkOiAlc1xuIiwKKwkJCSAgIHllc25vKHJwbW9kZWN0bCAmIEdFTjZfUlBf
RU5BQkxFKSk7CisJCXNlcV9wcmludGYobSwgIlNXIGNvbnRyb2wgZW5hYmxlZDogJXNcbiIsCisJ
CQkgICB5ZXNubygocnBtb2RlY3RsICYgR0VONl9SUF9NRURJQV9NT0RFX01BU0spID09CisJCQkJ
ICBHRU42X1JQX01FRElBX1NXX01PREUpKTsKKworCQlzZXFfcHJpbnRmKG0sICJQTSBJRVI9MHgl
MDh4IElNUj0weCUwOHgsIE1BU0s9MHglMDh4XG4iLAorCQkJICAgcG1faWVyLCBwbV9pbXIsIHBt
X21hc2spOworCQlpZiAoSU5URUxfR0VOKGk5MTUpIDw9IDEwKQorCQkJc2VxX3ByaW50ZihtLCAi
UE0gSVNSPTB4JTA4eCBJSVI9MHglMDh4XG4iLAorCQkJCSAgIHBtX2lzciwgcG1faWlyKTsKKwkJ
c2VxX3ByaW50ZihtLCAicG1faW50cm1za19tYno6IDB4JTA4eFxuIiwKKwkJCSAgIHJwcy0+cG1f
aW50cm1za19tYnopOworCQlzZXFfcHJpbnRmKG0sICJHVF9QRVJGX1NUQVRVUzogMHglMDh4XG4i
LCBndF9wZXJmX3N0YXR1cyk7CisJCXNlcV9wcmludGYobSwgIlJlbmRlciBwLXN0YXRlIHJhdGlv
OiAlZFxuIiwKKwkJCSAgIChndF9wZXJmX3N0YXR1cyAmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSA/
IDB4MWZmMDAgOiAweGZmMDApKSA+PiA4KTsKKwkJc2VxX3ByaW50ZihtLCAiUmVuZGVyIHAtc3Rh
dGUgVklEOiAlZFxuIiwKKwkJCSAgIGd0X3BlcmZfc3RhdHVzICYgMHhmZik7CisJCXNlcV9wcmlu
dGYobSwgIlJlbmRlciBwLXN0YXRlIGxpbWl0OiAlZFxuIiwKKwkJCSAgIHJwX3N0YXRlX2xpbWl0
cyAmIDB4ZmYpOworCQlzZXFfcHJpbnRmKG0sICJSUFNUQVQxOiAweCUwOHhcbiIsIHJwc3RhdCk7
CisJCXNlcV9wcmludGYobSwgIlJQTU9ERUNUTDogMHglMDh4XG4iLCBycG1vZGVjdGwpOworCQlz
ZXFfcHJpbnRmKG0sICJSUElOQ0xJTUlUOiAweCUwOHhcbiIsIHJwaW5jbGltaXQpOworCQlzZXFf
cHJpbnRmKG0sICJSUERFQ0xJTUlUOiAweCUwOHhcbiIsIHJwZGVjbGltaXQpOworCQlzZXFfcHJp
bnRmKG0sICJSUE5TV1JFUTogJWRNSHpcbiIsIHJlcWYpOworCQlzZXFfcHJpbnRmKG0sICJDQUdG
OiAlZE1IelxuIiwgY2FnZik7CisJCXNlcV9wcmludGYobSwgIlJQIENVUiBVUCBFSTogJWQgKCVk
dXMpXG4iLAorCQkJICAgcnB1cGVpLCBHVF9QTV9JTlRFUlZBTF9UT19VUyhpOTE1LCBycHVwZWkp
KTsKKwkJc2VxX3ByaW50ZihtLCAiUlAgQ1VSIFVQOiAlZCAoJWR1cylcbiIsCisJCQkgICBycGN1
cnVwLCBHVF9QTV9JTlRFUlZBTF9UT19VUyhpOTE1LCBycGN1cnVwKSk7CisJCXNlcV9wcmludGYo
bSwgIlJQIFBSRVYgVVA6ICVkICglZHVzKVxuIiwKKwkJCSAgIHJwcHJldnVwLCBHVF9QTV9JTlRF
UlZBTF9UT19VUyhpOTE1LCBycHByZXZ1cCkpOworCQlzZXFfcHJpbnRmKG0sICJVcCB0aHJlc2hv
bGQ6ICVkJSVcbiIsCisJCQkgICBycHMtPnBvd2VyLnVwX3RocmVzaG9sZCk7CisKKwkJc2VxX3By
aW50ZihtLCAiUlAgQ1VSIERPV04gRUk6ICVkICglZHVzKVxuIiwKKwkJCSAgIHJwZG93bmVpLCBH
VF9QTV9JTlRFUlZBTF9UT19VUyhpOTE1LCBycGRvd25laSkpOworCQlzZXFfcHJpbnRmKG0sICJS
UCBDVVIgRE9XTjogJWQgKCVkdXMpXG4iLAorCQkJICAgcnBjdXJkb3duLCBHVF9QTV9JTlRFUlZB
TF9UT19VUyhpOTE1LCBycGN1cmRvd24pKTsKKwkJc2VxX3ByaW50ZihtLCAiUlAgUFJFViBET1dO
OiAlZCAoJWR1cylcbiIsCisJCQkgICBycHByZXZkb3duLCBHVF9QTV9JTlRFUlZBTF9UT19VUyhp
OTE1LCBycHByZXZkb3duKSk7CisJCXNlcV9wcmludGYobSwgIkRvd24gdGhyZXNob2xkOiAlZCUl
XG4iLAorCQkJICAgcnBzLT5wb3dlci5kb3duX3RocmVzaG9sZCk7CisKKwkJbWF4X2ZyZXEgPSAo
SVNfR0VOOV9MUChpOTE1KSA/IHJwX3N0YXRlX2NhcCA+PiAwIDoKKwkJCSAgICBycF9zdGF0ZV9j
YXAgPj4gMTYpICYgMHhmZjsKKwkJbWF4X2ZyZXEgKj0gKElTX0dFTjlfQkMoaTkxNSkgfHwKKwkJ
CSAgICAgSU5URUxfR0VOKGk5MTUpID49IDEwID8gR0VOOV9GUkVRX1NDQUxFUiA6IDEpOworCQlz
ZXFfcHJpbnRmKG0sICJMb3dlc3QgKFJQTikgZnJlcXVlbmN5OiAlZE1IelxuIiwKKwkJCSAgIGlu
dGVsX2dwdV9mcmVxKHJwcywgbWF4X2ZyZXEpKTsKKworCQltYXhfZnJlcSA9IChycF9zdGF0ZV9j
YXAgJiAweGZmMDApID4+IDg7CisJCW1heF9mcmVxICo9IChJU19HRU45X0JDKGk5MTUpIHx8CisJ
CQkgICAgIElOVEVMX0dFTihpOTE1KSA+PSAxMCA/IEdFTjlfRlJFUV9TQ0FMRVIgOiAxKTsKKwkJ
c2VxX3ByaW50ZihtLCAiTm9taW5hbCAoUlAxKSBmcmVxdWVuY3k6ICVkTUh6XG4iLAorCQkJICAg
aW50ZWxfZ3B1X2ZyZXEocnBzLCBtYXhfZnJlcSkpOworCisJCW1heF9mcmVxID0gKElTX0dFTjlf
TFAoaTkxNSkgPyBycF9zdGF0ZV9jYXAgPj4gMTYgOgorCQkJICAgIHJwX3N0YXRlX2NhcCA+PiAw
KSAmIDB4ZmY7CisJCW1heF9mcmVxICo9IChJU19HRU45X0JDKGk5MTUpIHx8CisJCQkgICAgIElO
VEVMX0dFTihpOTE1KSA+PSAxMCA/IEdFTjlfRlJFUV9TQ0FMRVIgOiAxKTsKKwkJc2VxX3ByaW50
ZihtLCAiTWF4IG5vbi1vdmVyY2xvY2tlZCAoUlAwKSBmcmVxdWVuY3k6ICVkTUh6XG4iLAorCQkJ
ICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBtYXhfZnJlcSkpOworCQlzZXFfcHJpbnRmKG0sICJNYXgg
b3ZlcmNsb2NrZWQgZnJlcXVlbmN5OiAlZE1IelxuIiwKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJw
cywgcnBzLT5tYXhfZnJlcSkpOworCisJCXNlcV9wcmludGYobSwgIkN1cnJlbnQgZnJlcTogJWQg
TUh6XG4iLAorCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmN1cl9mcmVxKSk7CisJCXNl
cV9wcmludGYobSwgIkFjdHVhbCBmcmVxOiAlZCBNSHpcbiIsIGNhZ2YpOworCQlzZXFfcHJpbnRm
KG0sICJJZGxlIGZyZXE6ICVkIE1IelxuIiwKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBz
LT5pZGxlX2ZyZXEpKTsKKwkJc2VxX3ByaW50ZihtLCAiTWluIGZyZXE6ICVkIE1IelxuIiwKKwkJ
CSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5taW5fZnJlcSkpOworCQlzZXFfcHJpbnRmKG0s
ICJCb29zdCBmcmVxOiAlZCBNSHpcbiIsCisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+
Ym9vc3RfZnJlcSkpOworCQlzZXFfcHJpbnRmKG0sICJNYXggZnJlcTogJWQgTUh6XG4iLAorCQkJ
ICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPm1heF9mcmVxKSk7CisJCXNlcV9wcmludGYobSwK
KwkJCSAgICJlZmZpY2llbnQgKFJQZSkgZnJlcXVlbmN5OiAlZCBNSHpcbiIsCisJCQkgICBpbnRl
bF9ncHVfZnJlcShycHMsIHJwcy0+ZWZmaWNpZW50X2ZyZXEpKTsKKwl9IGVsc2UgeworCQlzZXFf
cHV0cyhtLCAibm8gUC1zdGF0ZSBpbmZvIGF2YWlsYWJsZVxuIik7CisJfQorCisJc2VxX3ByaW50
ZihtLCAiQ3VycmVudCBDRCBjbG9jayBmcmVxdWVuY3k6ICVkIGtIelxuIiwgaTkxNS0+Y2RjbGsu
aHcuY2RjbGspOworCXNlcV9wcmludGYobSwgIk1heCBDRCBjbG9jayBmcmVxdWVuY3k6ICVkIGtI
elxuIiwgaTkxNS0+bWF4X2NkY2xrX2ZyZXEpOworCXNlcV9wcmludGYobSwgIk1heCBwaXhlbCBj
bG9jayBmcmVxdWVuY3k6ICVkIGtIelxuIiwgaTkxNS0+bWF4X2RvdGNsa19mcmVxKTsKKworCWlu
dGVsX3J1bnRpbWVfcG1fcHV0KHVuY29yZS0+cnBtLCB3YWtlcmVmKTsKKworCXJldHVybiAwOwor
fQorREVGSU5FX0dUX0RFQlVHRlNfQVRUUklCVVRFKGZyZXF1ZW5jeV9pbmZvKTsKKworc3RhdGlj
IGludCBsbGNfaW5mb19zaG93KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKK3sKKwlz
dHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gbS0+cHJpdmF0ZTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IGd0LT5pOTE1OworCWNvbnN0IGJvb2wgZWRyYW0gPSBJTlRFTF9HRU4oaTkxNSkg
PiA4OworCisJc2VxX3ByaW50ZihtLCAiTExDOiAlc1xuIiwgeWVzbm8oSEFTX0xMQyhpOTE1KSkp
OworCXNlcV9wcmludGYobSwgIiVzOiAldU1CXG4iLCBlZHJhbSA/ICJlRFJBTSIgOiAiZUxMQyIs
CisJCSAgIGk5MTUtPmVkcmFtX3NpemVfbWIpOworCisJcmV0dXJuIDA7Cit9CitERUZJTkVfR1Rf
REVCVUdGU19BVFRSSUJVVEUobGxjX2luZm8pOworCitzdGF0aWMgaW50IHJpbmdfZnJlcV90YWJs
ZV9zaG93KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQoreworCXN0cnVjdCBpbnRl
bF9ndCAqZ3QgPSBtLT5wcml2YXRlOworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
Z3QtPmk5MTU7CisJc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmd0LT5ycHM7CisJdW5zaWduZWQg
aW50IG1heF9ncHVfZnJlcSwgbWluX2dwdV9mcmVxOworCWludGVsX3dha2VyZWZfdCB3YWtlcmVm
OworCWludCBncHVfZnJlcSwgaWFfZnJlcTsKKworCW1pbl9ncHVfZnJlcSA9IHJwcy0+bWluX2Zy
ZXE7CisJbWF4X2dwdV9mcmVxID0gcnBzLT5tYXhfZnJlcTsKKwlpZiAoSVNfR0VOOV9CQyhpOTE1
KSB8fCBJTlRFTF9HRU4oaTkxNSkgPj0gMTApIHsKKwkJLyogQ29udmVydCBHVCBmcmVxdWVuY3kg
dG8gNTAgSFogdW5pdHMgKi8KKwkJbWluX2dwdV9mcmVxIC89IEdFTjlfRlJFUV9TQ0FMRVI7CisJ
CW1heF9ncHVfZnJlcSAvPSBHRU45X0ZSRVFfU0NBTEVSOworCX0KKworCXNlcV9wdXRzKG0sICJH
UFUgZnJlcSAoTUh6KVx0RWZmZWN0aXZlIENQVSBmcmVxIChNSHopXHRFZmZlY3RpdmUgUmluZyBm
cmVxIChNSHopXG4iKTsKKworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChndC0+dW5j
b3JlLT5ycG0pOworCWZvciAoZ3B1X2ZyZXEgPSBtaW5fZ3B1X2ZyZXE7IGdwdV9mcmVxIDw9IG1h
eF9ncHVfZnJlcTsgZ3B1X2ZyZXErKykgeworCQlpYV9mcmVxID0gZ3B1X2ZyZXE7CisJCXNhbmR5
YnJpZGdlX3Bjb2RlX3JlYWQoaTkxNSwKKwkJCQkgICAgICAgR0VONl9QQ09ERV9SRUFEX01JTl9G
UkVRX1RBQkxFLAorCQkJCSAgICAgICAmaWFfZnJlcSwgTlVMTCk7CisJCXNlcV9wcmludGYobSwg
IiVkXHRcdCVkXHRcdFx0XHQlZFxuIiwKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywKKwkJCQkJ
ICAoZ3B1X2ZyZXEgKgorCQkJCQkgICAoSVNfR0VOOV9CQyhpOTE1KSB8fAorCQkJCQkgICAgSU5U
RUxfR0VOKGk5MTUpID49IDEwID8KKwkJCQkJICAgIEdFTjlfRlJFUV9TQ0FMRVIgOiAxKSkpLAor
CQkJICAgKChpYV9mcmVxID4+IDApICYgMHhmZikgKiAxMDAsCisJCQkgICAoKGlhX2ZyZXEgPj4g
OCkgJiAweGZmKSAqIDEwMCk7CisJfQorCWludGVsX3J1bnRpbWVfcG1fcHV0KGd0LT51bmNvcmUt
PnJwbSwgd2FrZXJlZik7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGJvb2wgcmluZ19mcmVx
X3RhYmxlX2V2YWwoc3RydWN0IGludGVsX2d0ICpndCkKK3sKKwlyZXR1cm4gSEFTX0xMQyhndC0+
aTkxNSkgPyB0cnVlIDogZmFsc2U7Cit9CisKK0RFRklORV9HVF9ERUJVR0ZTX0FUVFJJQlVURShy
aW5nX2ZyZXFfdGFibGUpOworCitzdGF0aWMgY29uc3QgY2hhciAqcnBzX3Bvd2VyX3RvX3N0cih1
bnNpZ25lZCBpbnQgcG93ZXIpCit7CisJc3RhdGljIGNvbnN0IGNoYXIgKiBjb25zdCBzdHJpbmdz
W10gPSB7CisJCVtMT1dfUE9XRVJdID0gImxvdyBwb3dlciIsCisJCVtCRVRXRUVOXSA9ICJtaXhl
ZCIsCisJCVtISUdIX1BPV0VSXSA9ICJoaWdoIHBvd2VyIiwKKwl9OworCisJaWYgKHBvd2VyID49
IEFSUkFZX1NJWkUoc3RyaW5ncykgfHwgIXN0cmluZ3NbcG93ZXJdKQorCQlyZXR1cm4gInVua25v
d24iOworCisJcmV0dXJuIHN0cmluZ3NbcG93ZXJdOworfQorCitzdGF0aWMgaW50IHJwc19ib29z
dF9pbmZvX3Nob3coc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQoreworCXN0cnVjdCBp
bnRlbF9ndCAqZ3QgPSBtLT5wcml2YXRlOworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gZ3QtPmk5MTU7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gZ3QtPnVuY29yZTsK
KwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZ3QtPnJwczsKKwl1MzIgYWN0X2ZyZXE7CisJaW50
ZWxfd2FrZXJlZl90IHdha2VyZWY7CisKKwl3aXRoX2ludGVsX3J1bnRpbWVfcG1faWZfaW5fdXNl
KHVuY29yZS0+cnBtLCB3YWtlcmVmKQorCQlhY3RfZnJlcSA9IGludGVsX3Jwc19yZWFkX2FjdHVh
bF9mcmVxdWVuY3kocnBzKTsKKworCXNlcV9wcmludGYobSwgIlJQUyBlbmFibGVkPyAlZFxuIiwg
cnBzLT5lbmFibGVkKTsKKwlzZXFfcHJpbnRmKG0sICJHUFUgYnVzeT8gJXNcbiIsIHllc25vKGd0
LT5hd2FrZSkpOworCXNlcV9wcmludGYobSwgIkJvb3N0cyBvdXRzdGFuZGluZz8gJWRcbiIsCisJ
CSAgIGF0b21pY19yZWFkKCZycHMtPm51bV93YWl0ZXJzKSk7CisJc2VxX3ByaW50ZihtLCAiSW50
ZXJhY3RpdmU/ICVkXG4iLCBSRUFEX09OQ0UocnBzLT5wb3dlci5pbnRlcmFjdGl2ZSkpOworCXNl
cV9wcmludGYobSwgIkZyZXF1ZW5jeSByZXF1ZXN0ZWQgJWQsIGFjdHVhbCAlZFxuIiwKKwkJICAg
aW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmN1cl9mcmVxKSwgYWN0X2ZyZXEpOworCXNlcV9wcmlu
dGYobSwgIiAgbWluIGhhcmQ6JWQsIHNvZnQ6JWQ7IG1heCBzb2Z0OiVkLCBoYXJkOiVkXG4iLAor
CQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWluX2ZyZXEpLAorCQkgICBpbnRlbF9ncHVf
ZnJlcShycHMsIHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0KSwKKwkJICAgaW50ZWxfZ3B1X2ZyZXEo
cnBzLCBycHMtPm1heF9mcmVxX3NvZnRsaW1pdCksCisJCSAgIGludGVsX2dwdV9mcmVxKHJwcywg
cnBzLT5tYXhfZnJlcSkpOworCXNlcV9wcmludGYobSwgIiAgaWRsZTolZCwgZWZmaWNpZW50OiVk
LCBib29zdDolZFxuIiwKKwkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmlkbGVfZnJlcSks
CisJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5lZmZpY2llbnRfZnJlcSksCisJCSAgIGlu
dGVsX2dwdV9mcmVxKHJwcywgcnBzLT5ib29zdF9mcmVxKSk7CisKKwlzZXFfcHJpbnRmKG0sICJX
YWl0IGJvb3N0czogJWRcbiIsIGF0b21pY19yZWFkKCZycHMtPmJvb3N0cykpOworCisJaWYgKElO
VEVMX0dFTihpOTE1KSA+PSA2ICYmIHJwcy0+ZW5hYmxlZCAmJiBndC0+YXdha2UpIHsKKwkJdTMy
IHJwdXAsIHJwdXBlaTsKKwkJdTMyIHJwZG93biwgcnBkb3duZWk7CisKKwkJaW50ZWxfdW5jb3Jl
X2ZvcmNld2FrZV9nZXQodW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKKwkJcnB1cCA9IGludGVsX3Vu
Y29yZV9yZWFkX2Z3KHVuY29yZSwgR0VONl9SUF9DVVJfVVApICYgR0VONl9SUF9FSV9NQVNLOwor
CQlycHVwZWkgPSBpbnRlbF91bmNvcmVfcmVhZF9mdyh1bmNvcmUsIEdFTjZfUlBfQ1VSX1VQX0VJ
KSAmIEdFTjZfUlBfRUlfTUFTSzsKKwkJcnBkb3duID0gaW50ZWxfdW5jb3JlX3JlYWRfZncodW5j
b3JlLCBHRU42X1JQX0NVUl9ET1dOKSAmIEdFTjZfUlBfRUlfTUFTSzsKKwkJcnBkb3duZWkgPSBp
bnRlbF91bmNvcmVfcmVhZF9mdyh1bmNvcmUsIEdFTjZfUlBfQ1VSX0RPV05fRUkpICYgR0VONl9S
UF9FSV9NQVNLOworCQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCh1bmNvcmUsIEZPUkNFV0FL
RV9BTEwpOworCisJCXNlcV9wcmludGYobSwgIlxuUlBTIEF1dG90dW5pbmcgKGN1cnJlbnQgXCIl
c1wiIHdpbmRvdyk6XG4iLAorCQkJICAgcnBzX3Bvd2VyX3RvX3N0cihycHMtPnBvd2VyLm1vZGUp
KTsKKwkJc2VxX3ByaW50ZihtLCAiICBBdmcuIHVwOiAlZCUlIFthYm92ZSB0aHJlc2hvbGQ/ICVk
JSVdXG4iLAorCQkJICAgcnB1cCAmJiBycHVwZWkgPyAxMDAgKiBycHVwIC8gcnB1cGVpIDogMCwK
KwkJCSAgIHJwcy0+cG93ZXIudXBfdGhyZXNob2xkKTsKKwkJc2VxX3ByaW50ZihtLCAiICBBdmcu
IGRvd246ICVkJSUgW2JlbG93IHRocmVzaG9sZD8gJWQlJV1cbiIsCisJCQkgICBycGRvd24gJiYg
cnBkb3duZWkgPyAxMDAgKiBycGRvd24gLyBycGRvd25laSA6IDAsCisJCQkgICBycHMtPnBvd2Vy
LmRvd25fdGhyZXNob2xkKTsKKwl9IGVsc2UgeworCQlzZXFfcHV0cyhtLCAiXG5SUFMgQXV0b3R1
bmluZyBpbmFjdGl2ZVxuIik7CisJfQorCisJcmV0dXJuIDA7Cit9CitERUZJTkVfR1RfREVCVUdG
U19BVFRSSUJVVEUocnBzX2Jvb3N0X2luZm8pOworCitzdGF0aWMgY29uc3Qgc3RydWN0IGd0X3Bt
X2RlYnVnZnNfZmlsZXMgeworCWNvbnN0IGNoYXIgKm5hbWU7CisJY29uc3Qgc3RydWN0IGZpbGVf
b3BlcmF0aW9ucyAqZm9wczsKKwlib29sICgqZXZhbCkoc3RydWN0IGludGVsX2d0ICpndCk7Cit9
IGd0X3BtX2RlYnVnZnNfZmlsZXNbXSA9IHsKKwl7ICJkcnBjX2luZm8iLCAmZHJwY19pbmZvX2Zv
cHMsIE5VTEwgfSwKKwl7ICJmcmVxdWVuY3lfaW5mbyIsICZmcmVxdWVuY3lfaW5mb19mb3BzLCBO
VUxMIH0sCisJeyAiZm9yY2V3YWtlX2RvbWFpbnMiLCAmZm9yY2V3YWtlX2RvbWFpbnNfZm9wcywg
TlVMTCB9LAorCXsgImxsY19pbmZvIiwgJmxsY19pbmZvX2ZvcHMsIE5VTEwgfSwKKwl7ICJyaW5n
X2ZyZXFfdGFibGUiLCAmcmluZ19mcmVxX3RhYmxlX2ZvcHMsIHJpbmdfZnJlcV90YWJsZV9ldmFs
IH0sCisJeyAicnBzX2Jvb3N0X2luZm8iLCAmcnBzX2Jvb3N0X2luZm9fZm9wcywgTlVMTCB9LAor
fTsKKworaW50IGludGVsX2d0X3BtX2RlYnVnZnNfcmVnaXN0ZXIoc3RydWN0IGludGVsX2d0ICpn
dCwgc3RydWN0IGRlbnRyeSAqcm9vdCkKK3sKKwlpbnQgaTsKKworCWlmICh1bmxpa2VseSghcm9v
dCkpCisJCXJldHVybiAtRU5PREVWOworCisJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoZ3Rf
cG1fZGVidWdmc19maWxlcyk7IGkrKykgeworCQljb25zdCBzdHJ1Y3QgZ3RfcG1fZGVidWdmc19m
aWxlcyAqZiA9ICZndF9wbV9kZWJ1Z2ZzX2ZpbGVzW2ldOworCisJCWlmIChmLT5ldmFsICYmICFm
LT5ldmFsKGd0KSkKKwkJCWNvbnRpbnVlOworCisJCWRlYnVnZnNfY3JlYXRlX2ZpbGUoZi0+bmFt
ZSwgMDQ0NCwgcm9vdCwgZ3QsIGYtPmZvcHMpOworCX0KKworCXJldHVybiAwOworfQpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZGVidWdmc19wbS5oIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZGVidWdmc19wbS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0
CmluZGV4IDAwMDAwMDAwMDAwMC4uZjU1MzNiNzIwY2E0Ci0tLSAvZGV2L251bGwKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZGVidWdmc19wbS5oCkBAIC0wLDAgKzEsMTYgQEAK
Ky8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBNSVQKKworLyoKKyAqIENvcHlyaWdodCDCqSAy
MDE5IEludGVsIENvcnBvcmF0aW9uCisgKi8KKworI2lmbmRlZiBERUJVR0ZTX1BNCisjZGVmaW5l
IERFQlVHRlNfUE0KKworI2luY2x1ZGUgPGxpbnV4L3NlcV9maWxlLmg+CisKKyNpbmNsdWRlICJp
bnRlbF9ndF90eXBlcy5oIgorCitpbnQgaW50ZWxfZ3RfcG1fZGVidWdmc19yZWdpc3RlcihzdHJ1
Y3QgaW50ZWxfZ3QgKmd0LCBzdHJ1Y3QgZGVudHJ5ICpyb290KTsKKworI2VuZGlmIC8qIERFQlVH
RlNfUE0gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKaW5kZXggM2VjMjZiNmE0OGMx
Li5mYzRiYmRkYzQyMzIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVi
dWdmcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCkBAIC00MCwx
MSArNDAsMTAgQEAKICNpbmNsdWRlICJkaXNwbGF5L2ludGVsX3Bzci5oIgogCiAjaW5jbHVkZSAi
Z2VtL2k5MTVfZ2VtX2NvbnRleHQuaCIKKyNpbmNsdWRlICJndC9pbnRlbF9kZWJ1Z2ZzX2d0Lmgi
CiAjaW5jbHVkZSAiZ3QvaW50ZWxfZ3RfcG0uaCIKICNpbmNsdWRlICJndC9pbnRlbF9ndF9yZXF1
ZXN0cy5oIgogI2luY2x1ZGUgImd0L2ludGVsX3Jlc2V0LmgiCi0jaW5jbHVkZSAiZ3QvaW50ZWxf
cmM2LmgiCi0jaW5jbHVkZSAiZ3QvaW50ZWxfcnBzLmgiCiAjaW5jbHVkZSAiZ3QvdWMvaW50ZWxf
Z3VjX3N1Ym1pc3Npb24uaCIKIAogI2luY2x1ZGUgImk5MTVfZGVidWdmcy5oIgpAQCAtNzc4LDQ0
MyArNzc3LDYgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBmaWxlX29wZXJhdGlvbnMgaTkxNV9lcnJv
cl9zdGF0ZV9mb3BzID0gewogfTsKICNlbmRpZgogCi1zdGF0aWMgaW50IGk5MTVfZnJlcXVlbmN5
X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCi17Ci0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwotCXN0cnVj
dCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwotCXN0cnVjdCBpbnRl
bF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3QucnBzOwotCWludGVsX3dha2VyZWZfdCB3YWtlcmVm
OwotCWludCByZXQgPSAwOwotCi0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZf
cHJpdi0+cnVudGltZV9wbSk7Ci0KLQlpZiAoSVNfR0VOKGRldl9wcml2LCA1KSkgewotCQl1MTYg
cmd2c3djdGwgPSBpbnRlbF91bmNvcmVfcmVhZDE2KHVuY29yZSwgTUVNU1dDVEwpOwotCQl1MTYg
cmd2c3RhdCA9IGludGVsX3VuY29yZV9yZWFkMTYodW5jb3JlLCBNRU1TVEFUX0lMSyk7Ci0KLQkJ
c2VxX3ByaW50ZihtLCAiUmVxdWVzdGVkIFAtc3RhdGU6ICVkXG4iLCAocmd2c3djdGwgPj4gOCkg
JiAweGYpOwotCQlzZXFfcHJpbnRmKG0sICJSZXF1ZXN0ZWQgVklEOiAlZFxuIiwgcmd2c3djdGwg
JiAweDNmKTsKLQkJc2VxX3ByaW50ZihtLCAiQ3VycmVudCBWSUQ6ICVkXG4iLCAocmd2c3RhdCAm
IE1FTVNUQVRfVklEX01BU0spID4+Ci0JCQkgICBNRU1TVEFUX1ZJRF9TSElGVCk7Ci0JCXNlcV9w
cmludGYobSwgIkN1cnJlbnQgUC1zdGF0ZTogJWRcbiIsCi0JCQkgICAocmd2c3RhdCAmIE1FTVNU
QVRfUFNUQVRFX01BU0spID4+IE1FTVNUQVRfUFNUQVRFX1NISUZUKTsKLQl9IGVsc2UgaWYgKElT
X1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Ci0JCXUz
MiBycG1vZGVjdGwsIGZyZXFfc3RzOwotCi0JCXJwbW9kZWN0bCA9IEk5MTVfUkVBRChHRU42X1JQ
X0NPTlRST0wpOwotCQlzZXFfcHJpbnRmKG0sICJWaWRlbyBUdXJibyBNb2RlOiAlc1xuIiwKLQkJ
CSAgIHllc25vKHJwbW9kZWN0bCAmIEdFTjZfUlBfTUVESUFfVFVSQk8pKTsKLQkJc2VxX3ByaW50
ZihtLCAiSFcgY29udHJvbCBlbmFibGVkOiAlc1xuIiwKLQkJCSAgIHllc25vKHJwbW9kZWN0bCAm
IEdFTjZfUlBfRU5BQkxFKSk7Ci0JCXNlcV9wcmludGYobSwgIlNXIGNvbnRyb2wgZW5hYmxlZDog
JXNcbiIsCi0JCQkgICB5ZXNubygocnBtb2RlY3RsICYgR0VONl9SUF9NRURJQV9NT0RFX01BU0sp
ID09Ci0JCQkJICBHRU42X1JQX01FRElBX1NXX01PREUpKTsKLQotCQl2bHZfcHVuaXRfZ2V0KGRl
dl9wcml2KTsKLQkJZnJlcV9zdHMgPSB2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgUFVOSVRfUkVH
X0dQVV9GUkVRX1NUUyk7Ci0JCXZsdl9wdW5pdF9wdXQoZGV2X3ByaXYpOwotCi0JCXNlcV9wcmlu
dGYobSwgIlBVTklUX1JFR19HUFVfRlJFUV9TVFM6IDB4JTA4eFxuIiwgZnJlcV9zdHMpOwotCQlz
ZXFfcHJpbnRmKG0sICJERFIgZnJlcTogJWQgTUh6XG4iLCBkZXZfcHJpdi0+bWVtX2ZyZXEpOwot
Ci0JCXNlcV9wcmludGYobSwgImFjdHVhbCBHUFUgZnJlcTogJWQgTUh6XG4iLAotCQkJICAgaW50
ZWxfZ3B1X2ZyZXEocnBzLCAoZnJlcV9zdHMgPj4gOCkgJiAweGZmKSk7Ci0KLQkJc2VxX3ByaW50
ZihtLCAiY3VycmVudCBHUFUgZnJlcTogJWQgTUh6XG4iLAotCQkJICAgaW50ZWxfZ3B1X2ZyZXEo
cnBzLCBycHMtPmN1cl9mcmVxKSk7Ci0KLQkJc2VxX3ByaW50ZihtLCAibWF4IEdQVSBmcmVxOiAl
ZCBNSHpcbiIsCi0JCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWF4X2ZyZXEpKTsKLQot
CQlzZXFfcHJpbnRmKG0sICJtaW4gR1BVIGZyZXE6ICVkIE1IelxuIiwKLQkJCSAgIGludGVsX2dw
dV9mcmVxKHJwcywgcnBzLT5taW5fZnJlcSkpOwotCi0JCXNlcV9wcmludGYobSwgImlkbGUgR1BV
IGZyZXE6ICVkIE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5pZGxlX2Zy
ZXEpKTsKLQotCQlzZXFfcHJpbnRmKG0sCi0JCQkgICAiZWZmaWNpZW50IChSUGUpIGZyZXF1ZW5j
eTogJWQgTUh6XG4iLAotCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmVmZmljaWVudF9m
cmVxKSk7Ci0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDYpIHsKLQkJdTMyIHJw
X3N0YXRlX2xpbWl0czsKLQkJdTMyIGd0X3BlcmZfc3RhdHVzOwotCQl1MzIgcnBfc3RhdGVfY2Fw
OwotCQl1MzIgcnBtb2RlY3RsLCBycGluY2xpbWl0LCBycGRlY2xpbWl0OwotCQl1MzIgcnBzdGF0
LCBjYWdmLCByZXFmOwotCQl1MzIgcnB1cGVpLCBycGN1cnVwLCBycHByZXZ1cDsKLQkJdTMyIHJw
ZG93bmVpLCBycGN1cmRvd24sIHJwcHJldmRvd247Ci0JCXUzMiBwbV9pZXIsIHBtX2ltciwgcG1f
aXNyLCBwbV9paXIsIHBtX21hc2s7Ci0JCWludCBtYXhfZnJlcTsKLQotCQlycF9zdGF0ZV9saW1p
dHMgPSBJOTE1X1JFQUQoR0VONl9SUF9TVEFURV9MSU1JVFMpOwotCQlpZiAoSVNfR0VOOV9MUChk
ZXZfcHJpdikpIHsKLQkJCXJwX3N0YXRlX2NhcCA9IEk5MTVfUkVBRChCWFRfUlBfU1RBVEVfQ0FQ
KTsKLQkJCWd0X3BlcmZfc3RhdHVzID0gSTkxNV9SRUFEKEJYVF9HVF9QRVJGX1NUQVRVUyk7Ci0J
CX0gZWxzZSB7Ci0JCQlycF9zdGF0ZV9jYXAgPSBJOTE1X1JFQUQoR0VONl9SUF9TVEFURV9DQVAp
OwotCQkJZ3RfcGVyZl9zdGF0dXMgPSBJOTE1X1JFQUQoR0VONl9HVF9QRVJGX1NUQVRVUyk7Ci0J
CX0KLQotCQkvKiBSUFNUQVQxIGlzIGluIHRoZSBHVCBwb3dlciB3ZWxsICovCi0JCWludGVsX3Vu
Y29yZV9mb3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKLQot
CQlyZXFmID0gSTkxNV9SRUFEKEdFTjZfUlBOU1dSRVEpOwotCQlpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA+PSA5KQotCQkJcmVxZiA+Pj0gMjM7Ci0JCWVsc2UgewotCQkJcmVxZiAmPSB+R0VONl9U
VVJCT19ESVNBQkxFOwotCQkJaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElTX0JST0FEV0VM
TChkZXZfcHJpdikpCi0JCQkJcmVxZiA+Pj0gMjQ7Ci0JCQllbHNlCi0JCQkJcmVxZiA+Pj0gMjU7
Ci0JCX0KLQkJcmVxZiA9IGludGVsX2dwdV9mcmVxKHJwcywgcmVxZik7Ci0KLQkJcnBtb2RlY3Rs
ID0gSTkxNV9SRUFEKEdFTjZfUlBfQ09OVFJPTCk7Ci0JCXJwaW5jbGltaXQgPSBJOTE1X1JFQUQo
R0VONl9SUF9VUF9USFJFU0hPTEQpOwotCQlycGRlY2xpbWl0ID0gSTkxNV9SRUFEKEdFTjZfUlBf
RE9XTl9USFJFU0hPTEQpOwotCi0JCXJwc3RhdCA9IEk5MTVfUkVBRChHRU42X1JQU1RBVDEpOwot
CQlycHVwZWkgPSBJOTE1X1JFQUQoR0VONl9SUF9DVVJfVVBfRUkpICYgR0VONl9DVVJJQ09OVF9N
QVNLOwotCQlycGN1cnVwID0gSTkxNV9SRUFEKEdFTjZfUlBfQ1VSX1VQKSAmIEdFTjZfQ1VSQlNZ
VEFWR19NQVNLOwotCQlycHByZXZ1cCA9IEk5MTVfUkVBRChHRU42X1JQX1BSRVZfVVApICYgR0VO
Nl9DVVJCU1lUQVZHX01BU0s7Ci0JCXJwZG93bmVpID0gSTkxNV9SRUFEKEdFTjZfUlBfQ1VSX0RP
V05fRUkpICYgR0VONl9DVVJJQVZHX01BU0s7Ci0JCXJwY3VyZG93biA9IEk5MTVfUkVBRChHRU42
X1JQX0NVUl9ET1dOKSAmIEdFTjZfQ1VSQlNZVEFWR19NQVNLOwotCQlycHByZXZkb3duID0gSTkx
NV9SRUFEKEdFTjZfUlBfUFJFVl9ET1dOKSAmIEdFTjZfQ1VSQlNZVEFWR19NQVNLOwotCQljYWdm
ID0gaW50ZWxfcnBzX3JlYWRfYWN0dWFsX2ZyZXF1ZW5jeShycHMpOwotCi0JCWludGVsX3VuY29y
ZV9mb3JjZXdha2VfcHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKLQotCQlp
ZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkgewotCQkJcG1faWVyID0gSTkxNV9SRUFEKEdF
TjExX0dQTV9XR0JPWFBFUkZfSU5UUl9FTkFCTEUpOwotCQkJcG1faW1yID0gSTkxNV9SRUFEKEdF
TjExX0dQTV9XR0JPWFBFUkZfSU5UUl9NQVNLKTsKLQkJCS8qCi0JCQkgKiBUaGUgZXF1aXZhbGVu
dCB0byB0aGUgUE0gSVNSICYgSUlSIGNhbm5vdCBiZSByZWFkCi0JCQkgKiB3aXRob3V0IGFmZmVj
dGluZyB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgc3lzdGVtCi0JCQkgKi8KLQkJCXBtX2lzciA9
IDA7Ci0JCQlwbV9paXIgPSAwOwotCQl9IGVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0g
OCkgewotCQkJcG1faWVyID0gSTkxNV9SRUFEKEdFTjhfR1RfSUVSKDIpKTsKLQkJCXBtX2ltciA9
IEk5MTVfUkVBRChHRU44X0dUX0lNUigyKSk7Ci0JCQlwbV9pc3IgPSBJOTE1X1JFQUQoR0VOOF9H
VF9JU1IoMikpOwotCQkJcG1faWlyID0gSTkxNV9SRUFEKEdFTjhfR1RfSUlSKDIpKTsKLQkJfSBl
bHNlIHsKLQkJCXBtX2llciA9IEk5MTVfUkVBRChHRU42X1BNSUVSKTsKLQkJCXBtX2ltciA9IEk5
MTVfUkVBRChHRU42X1BNSU1SKTsKLQkJCXBtX2lzciA9IEk5MTVfUkVBRChHRU42X1BNSVNSKTsK
LQkJCXBtX2lpciA9IEk5MTVfUkVBRChHRU42X1BNSUlSKTsKLQkJfQotCQlwbV9tYXNrID0gSTkx
NV9SRUFEKEdFTjZfUE1JTlRSTVNLKTsKLQotCQlzZXFfcHJpbnRmKG0sICJWaWRlbyBUdXJibyBN
b2RlOiAlc1xuIiwKLQkJCSAgIHllc25vKHJwbW9kZWN0bCAmIEdFTjZfUlBfTUVESUFfVFVSQk8p
KTsKLQkJc2VxX3ByaW50ZihtLCAiSFcgY29udHJvbCBlbmFibGVkOiAlc1xuIiwKLQkJCSAgIHll
c25vKHJwbW9kZWN0bCAmIEdFTjZfUlBfRU5BQkxFKSk7Ci0JCXNlcV9wcmludGYobSwgIlNXIGNv
bnRyb2wgZW5hYmxlZDogJXNcbiIsCi0JCQkgICB5ZXNubygocnBtb2RlY3RsICYgR0VONl9SUF9N
RURJQV9NT0RFX01BU0spID09Ci0JCQkJICBHRU42X1JQX01FRElBX1NXX01PREUpKTsKLQotCQlz
ZXFfcHJpbnRmKG0sICJQTSBJRVI9MHglMDh4IElNUj0weCUwOHgsIE1BU0s9MHglMDh4XG4iLAot
CQkJICAgcG1faWVyLCBwbV9pbXIsIHBtX21hc2spOwotCQlpZiAoSU5URUxfR0VOKGRldl9wcml2
KSA8PSAxMCkKLQkJCXNlcV9wcmludGYobSwgIlBNIElTUj0weCUwOHggSUlSPTB4JTA4eFxuIiwK
LQkJCQkgICBwbV9pc3IsIHBtX2lpcik7Ci0JCXNlcV9wcmludGYobSwgInBtX2ludHJtc2tfbWJ6
OiAweCUwOHhcbiIsCi0JCQkgICBycHMtPnBtX2ludHJtc2tfbWJ6KTsKLQkJc2VxX3ByaW50Ziht
LCAiR1RfUEVSRl9TVEFUVVM6IDB4JTA4eFxuIiwgZ3RfcGVyZl9zdGF0dXMpOwotCQlzZXFfcHJp
bnRmKG0sICJSZW5kZXIgcC1zdGF0ZSByYXRpbzogJWRcbiIsCi0JCQkgICAoZ3RfcGVyZl9zdGF0
dXMgJiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5ID8gMHgxZmYwMCA6IDB4ZmYwMCkpID4+IDgp
OwotCQlzZXFfcHJpbnRmKG0sICJSZW5kZXIgcC1zdGF0ZSBWSUQ6ICVkXG4iLAotCQkJICAgZ3Rf
cGVyZl9zdGF0dXMgJiAweGZmKTsKLQkJc2VxX3ByaW50ZihtLCAiUmVuZGVyIHAtc3RhdGUgbGlt
aXQ6ICVkXG4iLAotCQkJICAgcnBfc3RhdGVfbGltaXRzICYgMHhmZik7Ci0JCXNlcV9wcmludGYo
bSwgIlJQU1RBVDE6IDB4JTA4eFxuIiwgcnBzdGF0KTsKLQkJc2VxX3ByaW50ZihtLCAiUlBNT0RF
Q1RMOiAweCUwOHhcbiIsIHJwbW9kZWN0bCk7Ci0JCXNlcV9wcmludGYobSwgIlJQSU5DTElNSVQ6
IDB4JTA4eFxuIiwgcnBpbmNsaW1pdCk7Ci0JCXNlcV9wcmludGYobSwgIlJQREVDTElNSVQ6IDB4
JTA4eFxuIiwgcnBkZWNsaW1pdCk7Ci0JCXNlcV9wcmludGYobSwgIlJQTlNXUkVROiAlZE1Ielxu
IiwgcmVxZik7Ci0JCXNlcV9wcmludGYobSwgIkNBR0Y6ICVkTUh6XG4iLCBjYWdmKTsKLQkJc2Vx
X3ByaW50ZihtLCAiUlAgQ1VSIFVQIEVJOiAlZCAoJWR1cylcbiIsCi0JCQkgICBycHVwZWksIEdU
X1BNX0lOVEVSVkFMX1RPX1VTKGRldl9wcml2LCBycHVwZWkpKTsKLQkJc2VxX3ByaW50ZihtLCAi
UlAgQ1VSIFVQOiAlZCAoJWR1cylcbiIsCi0JCQkgICBycGN1cnVwLCBHVF9QTV9JTlRFUlZBTF9U
T19VUyhkZXZfcHJpdiwgcnBjdXJ1cCkpOwotCQlzZXFfcHJpbnRmKG0sICJSUCBQUkVWIFVQOiAl
ZCAoJWR1cylcbiIsCi0JCQkgICBycHByZXZ1cCwgR1RfUE1fSU5URVJWQUxfVE9fVVMoZGV2X3By
aXYsIHJwcHJldnVwKSk7Ci0JCXNlcV9wcmludGYobSwgIlVwIHRocmVzaG9sZDogJWQlJVxuIiwK
LQkJCSAgIHJwcy0+cG93ZXIudXBfdGhyZXNob2xkKTsKLQotCQlzZXFfcHJpbnRmKG0sICJSUCBD
VVIgRE9XTiBFSTogJWQgKCVkdXMpXG4iLAotCQkJICAgcnBkb3duZWksIEdUX1BNX0lOVEVSVkFM
X1RPX1VTKGRldl9wcml2LCBycGRvd25laSkpOwotCQlzZXFfcHJpbnRmKG0sICJSUCBDVVIgRE9X
TjogJWQgKCVkdXMpXG4iLAotCQkJICAgcnBjdXJkb3duLCBHVF9QTV9JTlRFUlZBTF9UT19VUyhk
ZXZfcHJpdiwgcnBjdXJkb3duKSk7Ci0JCXNlcV9wcmludGYobSwgIlJQIFBSRVYgRE9XTjogJWQg
KCVkdXMpXG4iLAotCQkJICAgcnBwcmV2ZG93biwgR1RfUE1fSU5URVJWQUxfVE9fVVMoZGV2X3By
aXYsIHJwcHJldmRvd24pKTsKLQkJc2VxX3ByaW50ZihtLCAiRG93biB0aHJlc2hvbGQ6ICVkJSVc
biIsCi0JCQkgICBycHMtPnBvd2VyLmRvd25fdGhyZXNob2xkKTsKLQotCQltYXhfZnJlcSA9IChJ
U19HRU45X0xQKGRldl9wcml2KSA/IHJwX3N0YXRlX2NhcCA+PiAwIDoKLQkJCSAgICBycF9zdGF0
ZV9jYXAgPj4gMTYpICYgMHhmZjsKLQkJbWF4X2ZyZXEgKj0gKElTX0dFTjlfQkMoZGV2X3ByaXYp
IHx8Ci0JCQkgICAgIElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgPyBHRU45X0ZSRVFfU0NBTEVS
IDogMSk7Ci0JCXNlcV9wcmludGYobSwgIkxvd2VzdCAoUlBOKSBmcmVxdWVuY3k6ICVkTUh6XG4i
LAotCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBtYXhfZnJlcSkpOwotCi0JCW1heF9mcmVxID0g
KHJwX3N0YXRlX2NhcCAmIDB4ZmYwMCkgPj4gODsKLQkJbWF4X2ZyZXEgKj0gKElTX0dFTjlfQkMo
ZGV2X3ByaXYpIHx8Ci0JCQkgICAgIElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgPyBHRU45X0ZS
RVFfU0NBTEVSIDogMSk7Ci0JCXNlcV9wcmludGYobSwgIk5vbWluYWwgKFJQMSkgZnJlcXVlbmN5
OiAlZE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgbWF4X2ZyZXEpKTsKLQotCQlt
YXhfZnJlcSA9IChJU19HRU45X0xQKGRldl9wcml2KSA/IHJwX3N0YXRlX2NhcCA+PiAxNiA6Ci0J
CQkgICAgcnBfc3RhdGVfY2FwID4+IDApICYgMHhmZjsKLQkJbWF4X2ZyZXEgKj0gKElTX0dFTjlf
QkMoZGV2X3ByaXYpIHx8Ci0JCQkgICAgIElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgPyBHRU45
X0ZSRVFfU0NBTEVSIDogMSk7Ci0JCXNlcV9wcmludGYobSwgIk1heCBub24tb3ZlcmNsb2NrZWQg
KFJQMCkgZnJlcXVlbmN5OiAlZE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgbWF4
X2ZyZXEpKTsKLQkJc2VxX3ByaW50ZihtLCAiTWF4IG92ZXJjbG9ja2VkIGZyZXF1ZW5jeTogJWRN
SHpcbiIsCi0JCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWF4X2ZyZXEpKTsKLQotCQlz
ZXFfcHJpbnRmKG0sICJDdXJyZW50IGZyZXE6ICVkIE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9m
cmVxKHJwcywgcnBzLT5jdXJfZnJlcSkpOwotCQlzZXFfcHJpbnRmKG0sICJBY3R1YWwgZnJlcTog
JWQgTUh6XG4iLCBjYWdmKTsKLQkJc2VxX3ByaW50ZihtLCAiSWRsZSBmcmVxOiAlZCBNSHpcbiIs
Ci0JCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+aWRsZV9mcmVxKSk7Ci0JCXNlcV9wcmlu
dGYobSwgIk1pbiBmcmVxOiAlZCBNSHpcbiIsCi0JCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJw
cy0+bWluX2ZyZXEpKTsKLQkJc2VxX3ByaW50ZihtLCAiQm9vc3QgZnJlcTogJWQgTUh6XG4iLAot
CQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmJvb3N0X2ZyZXEpKTsKLQkJc2VxX3ByaW50
ZihtLCAiTWF4IGZyZXE6ICVkIE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBz
LT5tYXhfZnJlcSkpOwotCQlzZXFfcHJpbnRmKG0sCi0JCQkgICAiZWZmaWNpZW50IChSUGUpIGZy
ZXF1ZW5jeTogJWQgTUh6XG4iLAotCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmVmZmlj
aWVudF9mcmVxKSk7Ci0JfSBlbHNlIHsKLQkJc2VxX3B1dHMobSwgIm5vIFAtc3RhdGUgaW5mbyBh
dmFpbGFibGVcbiIpOwotCX0KLQotCXNlcV9wcmludGYobSwgIkN1cnJlbnQgQ0QgY2xvY2sgZnJl
cXVlbmN5OiAlZCBrSHpcbiIsIGRldl9wcml2LT5jZGNsay5ody5jZGNsayk7Ci0Jc2VxX3ByaW50
ZihtLCAiTWF4IENEIGNsb2NrIGZyZXF1ZW5jeTogJWQga0h6XG4iLCBkZXZfcHJpdi0+bWF4X2Nk
Y2xrX2ZyZXEpOwotCXNlcV9wcmludGYobSwgIk1heCBwaXhlbCBjbG9jayBmcmVxdWVuY3k6ICVk
IGtIelxuIiwgZGV2X3ByaXYtPm1heF9kb3RjbGtfZnJlcSk7Ci0KLQlpbnRlbF9ydW50aW1lX3Bt
X3B1dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwotCXJldHVybiByZXQ7Ci19Ci0K
LXN0YXRpYyBpbnQgaXJvbmxha2VfZHJwY19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSkKLXsKLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsK
LQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwotCXUzMiByZ3Zt
b2RlY3RsLCByc3RkYnljdGw7Ci0JdTE2IGNyc3RhbmR2aWQ7Ci0KLQlyZ3Ztb2RlY3RsID0gaW50
ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBNRU1NT0RFQ1RMKTsKLQlyc3RkYnljdGwgPSBpbnRlbF91
bmNvcmVfcmVhZCh1bmNvcmUsIFJTVERCWUNUTCk7Ci0JY3JzdGFuZHZpZCA9IGludGVsX3VuY29y
ZV9yZWFkMTYodW5jb3JlLCBDUlNUQU5EVklEKTsKLQotCXNlcV9wcmludGYobSwgIkhEIGJvb3N0
OiAlc1xuIiwgeWVzbm8ocmd2bW9kZWN0bCAmIE1FTU1PREVfQk9PU1RfRU4pKTsKLQlzZXFfcHJp
bnRmKG0sICJCb29zdCBmcmVxOiAlZFxuIiwKLQkJICAgKHJndm1vZGVjdGwgJiBNRU1NT0RFX0JP
T1NUX0ZSRVFfTUFTSykgPj4KLQkJICAgTUVNTU9ERV9CT09TVF9GUkVRX1NISUZUKTsKLQlzZXFf
cHJpbnRmKG0sICJIVyBjb250cm9sIGVuYWJsZWQ6ICVzXG4iLAotCQkgICB5ZXNubyhyZ3Ztb2Rl
Y3RsICYgTUVNTU9ERV9IV0lETEVfRU4pKTsKLQlzZXFfcHJpbnRmKG0sICJTVyBjb250cm9sIGVu
YWJsZWQ6ICVzXG4iLAotCQkgICB5ZXNubyhyZ3Ztb2RlY3RsICYgTUVNTU9ERV9TV01PREVfRU4p
KTsKLQlzZXFfcHJpbnRmKG0sICJHYXRlZCB2b2x0YWdlIGNoYW5nZTogJXNcbiIsCi0JCSAgIHll
c25vKHJndm1vZGVjdGwgJiBNRU1NT0RFX1JDTEtfR0FURSkpOwotCXNlcV9wcmludGYobSwgIlN0
YXJ0aW5nIGZyZXF1ZW5jeTogUCVkXG4iLAotCQkgICAocmd2bW9kZWN0bCAmIE1FTU1PREVfRlNU
QVJUX01BU0spID4+IE1FTU1PREVfRlNUQVJUX1NISUZUKTsKLQlzZXFfcHJpbnRmKG0sICJNYXgg
UC1zdGF0ZTogUCVkXG4iLAotCQkgICAocmd2bW9kZWN0bCAmIE1FTU1PREVfRk1BWF9NQVNLKSA+
PiBNRU1NT0RFX0ZNQVhfU0hJRlQpOwotCXNlcV9wcmludGYobSwgIk1pbiBQLXN0YXRlOiBQJWRc
biIsIChyZ3Ztb2RlY3RsICYgTUVNTU9ERV9GTUlOX01BU0spKTsKLQlzZXFfcHJpbnRmKG0sICJS
UzEgVklEOiAlZFxuIiwgKGNyc3RhbmR2aWQgJiAweDNmKSk7Ci0Jc2VxX3ByaW50ZihtLCAiUlMy
IFZJRDogJWRcbiIsICgoY3JzdGFuZHZpZCA+PiA4KSAmIDB4M2YpKTsKLQlzZXFfcHJpbnRmKG0s
ICJSZW5kZXIgc3RhbmRieSBlbmFibGVkOiAlc1xuIiwKLQkJICAgeWVzbm8oIShyc3RkYnljdGwg
JiBSQ1hfU1dfRVhJVCkpKTsKLQlzZXFfcHV0cyhtLCAiQ3VycmVudCBSUyBzdGF0ZTogIik7Ci0J
c3dpdGNoIChyc3RkYnljdGwgJiBSU1hfU1RBVFVTX01BU0spIHsKLQljYXNlIFJTWF9TVEFUVVNf
T046Ci0JCXNlcV9wdXRzKG0sICJvblxuIik7Ci0JCWJyZWFrOwotCWNhc2UgUlNYX1NUQVRVU19S
QzE6Ci0JCXNlcV9wdXRzKG0sICJSQzFcbiIpOwotCQlicmVhazsKLQljYXNlIFJTWF9TVEFUVVNf
UkMxRToKLQkJc2VxX3B1dHMobSwgIlJDMUVcbiIpOwotCQlicmVhazsKLQljYXNlIFJTWF9TVEFU
VVNfUlMxOgotCQlzZXFfcHV0cyhtLCAiUlMxXG4iKTsKLQkJYnJlYWs7Ci0JY2FzZSBSU1hfU1RB
VFVTX1JTMjoKLQkJc2VxX3B1dHMobSwgIlJTMiAoUkM2KVxuIik7Ci0JCWJyZWFrOwotCWNhc2Ug
UlNYX1NUQVRVU19SUzM6Ci0JCXNlcV9wdXRzKG0sICJSQzMgKFJDNispXG4iKTsKLQkJYnJlYWs7
Ci0JZGVmYXVsdDoKLQkJc2VxX3B1dHMobSwgInVua25vd25cbiIpOwotCQlicmVhazsKLQl9Ci0K
LQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCBpOTE1X2ZvcmNld2FrZV9kb21haW5zKHN0cnVj
dCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1
bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwotCXN0cnVjdCBpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2Rv
bWFpbiAqZndfZG9tYWluOwotCXVuc2lnbmVkIGludCB0bXA7Ci0KLQlzZXFfcHJpbnRmKG0sICJ1
c2VyLmJ5cGFzc19jb3VudCA9ICV1XG4iLAotCQkgICB1bmNvcmUtPnVzZXJfZm9yY2V3YWtlX2Nv
dW50KTsKLQotCWZvcl9lYWNoX2Z3X2RvbWFpbihmd19kb21haW4sIHVuY29yZSwgdG1wKQotCQlz
ZXFfcHJpbnRmKG0sICIlcy53YWtlX2NvdW50ID0gJXVcbiIsCi0JCQkgICBpbnRlbF91bmNvcmVf
Zm9yY2V3YWtlX2RvbWFpbl90b19zdHIoZndfZG9tYWluLT5pZCksCi0JCQkgICBSRUFEX09OQ0Uo
ZndfZG9tYWluLT53YWtlX2NvdW50KSk7Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIHZvaWQg
cHJpbnRfcmM2X3JlcyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sCi0JCQkgIGNvbnN0IGNoYXIgKnRpdGxl
LAotCQkJICBjb25zdCBpOTE1X3JlZ190IHJlZykKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKLQlpbnRlbF93YWtlcmVmX3Qgd2Fr
ZXJlZjsKLQotCXdpdGhfaW50ZWxfcnVudGltZV9wbSgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJl
ZikKLQkJc2VxX3ByaW50ZihtLCAiJXMgJXUgKCVsbHUgdXMpXG4iLCB0aXRsZSwKLQkJCSAgIGlu
dGVsX3VuY29yZV9yZWFkKCZpOTE1LT51bmNvcmUsIHJlZyksCi0JCQkgICBpbnRlbF9yYzZfcmVz
aWRlbmN5X3VzKCZpOTE1LT5ndC5yYzYsIHJlZykpOwotfQotCi1zdGF0aWMgaW50IHZsdl9kcnBj
X2luZm8oc3RydWN0IHNlcV9maWxlICptKQotewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKLQl1MzIgcmNjdGwxLCBwd19zdGF0
dXM7Ci0KLQlwd19zdGF0dXMgPSBJOTE1X1JFQUQoVkxWX0dUTENfUFdfU1RBVFVTKTsKLQlyY2N0
bDEgPSBJOTE1X1JFQUQoR0VONl9SQ19DT05UUk9MKTsKLQotCXNlcV9wcmludGYobSwgIlJDNiBF
bmFibGVkOiAlc1xuIiwKLQkJICAgeWVzbm8ocmNjdGwxICYgKEdFTjdfUkNfQ1RMX1RPX01PREUg
fAotCQkJCQlHRU42X1JDX0NUTF9FSV9NT0RFKDEpKSkpOwotCXNlcV9wcmludGYobSwgIlJlbmRl
ciBQb3dlciBXZWxsOiAlc1xuIiwKLQkJICAgKHB3X3N0YXR1cyAmIFZMVl9HVExDX1BXX1JFTkRF
Ul9TVEFUVVNfTUFTSykgPyAiVXAiIDogIkRvd24iKTsKLQlzZXFfcHJpbnRmKG0sICJNZWRpYSBQ
b3dlciBXZWxsOiAlc1xuIiwKLQkJICAgKHB3X3N0YXR1cyAmIFZMVl9HVExDX1BXX01FRElBX1NU
QVRVU19NQVNLKSA/ICJVcCIgOiAiRG93biIpOwotCi0JcHJpbnRfcmM2X3JlcyhtLCAiUmVuZGVy
IFJDNiByZXNpZGVuY3kgc2luY2UgYm9vdDoiLCBWTFZfR1RfUkVOREVSX1JDNik7Ci0JcHJpbnRf
cmM2X3JlcyhtLCAiTWVkaWEgUkM2IHJlc2lkZW5jeSBzaW5jZSBib290OiIsIFZMVl9HVF9NRURJ
QV9SQzYpOwotCi0JcmV0dXJuIGk5MTVfZm9yY2V3YWtlX2RvbWFpbnMobSwgTlVMTCk7Ci19Ci0K
LXN0YXRpYyBpbnQgZ2VuNl9kcnBjX2luZm8oc3RydWN0IHNlcV9maWxlICptKQotewotCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsK
LQl1MzIgZ3RfY29yZV9zdGF0dXMsIHJjY3RsMSwgcmM2dmlkcyA9IDA7Ci0JdTMyIGdlbjlfcG93
ZXJnYXRlX2VuYWJsZSA9IDAsIGdlbjlfcG93ZXJnYXRlX3N0YXR1cyA9IDA7Ci0KLQlndF9jb3Jl
X3N0YXR1cyA9IEk5MTVfUkVBRF9GVyhHRU42X0dUX0NPUkVfU1RBVFVTKTsKLQl0cmFjZV9pOTE1
X3JlZ19ydyhmYWxzZSwgR0VONl9HVF9DT1JFX1NUQVRVUywgZ3RfY29yZV9zdGF0dXMsIDQsIHRy
dWUpOwotCi0JcmNjdGwxID0gSTkxNV9SRUFEKEdFTjZfUkNfQ09OVFJPTCk7Ci0JaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPj0gOSkgewotCQlnZW45X3Bvd2VyZ2F0ZV9lbmFibGUgPSBJOTE1X1JF
QUQoR0VOOV9QR19FTkFCTEUpOwotCQlnZW45X3Bvd2VyZ2F0ZV9zdGF0dXMgPSBJOTE1X1JFQUQo
R0VOOV9QV1JHVF9ET01BSU5fU1RBVFVTKTsKLQl9Ci0KLQlpZiAoSU5URUxfR0VOKGRldl9wcml2
KSA8PSA3KQotCQlzYW5keWJyaWRnZV9wY29kZV9yZWFkKGRldl9wcml2LCBHRU42X1BDT0RFX1JF
QURfUkM2VklEUywKLQkJCQkgICAgICAgJnJjNnZpZHMsIE5VTEwpOwotCi0Jc2VxX3ByaW50Ziht
LCAiUkMxZSBFbmFibGVkOiAlc1xuIiwKLQkJICAgeWVzbm8ocmNjdGwxICYgR0VONl9SQ19DVExf
UkMxZV9FTkFCTEUpKTsKLQlzZXFfcHJpbnRmKG0sICJSQzYgRW5hYmxlZDogJXNcbiIsCi0JCSAg
IHllc25vKHJjY3RsMSAmIEdFTjZfUkNfQ1RMX1JDNl9FTkFCTEUpKTsKLQlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSA5KSB7Ci0JCXNlcV9wcmludGYobSwgIlJlbmRlciBXZWxsIEdhdGluZyBF
bmFibGVkOiAlc1xuIiwKLQkJCXllc25vKGdlbjlfcG93ZXJnYXRlX2VuYWJsZSAmIEdFTjlfUkVO
REVSX1BHX0VOQUJMRSkpOwotCQlzZXFfcHJpbnRmKG0sICJNZWRpYSBXZWxsIEdhdGluZyBFbmFi
bGVkOiAlc1xuIiwKLQkJCXllc25vKGdlbjlfcG93ZXJnYXRlX2VuYWJsZSAmIEdFTjlfTUVESUFf
UEdfRU5BQkxFKSk7Ci0JfQotCXNlcV9wcmludGYobSwgIkRlZXAgUkM2IEVuYWJsZWQ6ICVzXG4i
LAotCQkgICB5ZXNubyhyY2N0bDEgJiBHRU42X1JDX0NUTF9SQzZwX0VOQUJMRSkpOwotCXNlcV9w
cmludGYobSwgIkRlZXBlc3QgUkM2IEVuYWJsZWQ6ICVzXG4iLAotCQkgICB5ZXNubyhyY2N0bDEg
JiBHRU42X1JDX0NUTF9SQzZwcF9FTkFCTEUpKTsKLQlzZXFfcHV0cyhtLCAiQ3VycmVudCBSQyBz
dGF0ZTogIik7Ci0Jc3dpdGNoIChndF9jb3JlX3N0YXR1cyAmIEdFTjZfUkNuX01BU0spIHsKLQlj
YXNlIEdFTjZfUkMwOgotCQlpZiAoZ3RfY29yZV9zdGF0dXMgJiBHRU42X0NPUkVfQ1BEX1NUQVRF
X01BU0spCi0JCQlzZXFfcHV0cyhtLCAiQ29yZSBQb3dlciBEb3duXG4iKTsKLQkJZWxzZQotCQkJ
c2VxX3B1dHMobSwgIm9uXG4iKTsKLQkJYnJlYWs7Ci0JY2FzZSBHRU42X1JDMzoKLQkJc2VxX3B1
dHMobSwgIlJDM1xuIik7Ci0JCWJyZWFrOwotCWNhc2UgR0VONl9SQzY6Ci0JCXNlcV9wdXRzKG0s
ICJSQzZcbiIpOwotCQlicmVhazsKLQljYXNlIEdFTjZfUkM3OgotCQlzZXFfcHV0cyhtLCAiUkM3
XG4iKTsKLQkJYnJlYWs7Ci0JZGVmYXVsdDoKLQkJc2VxX3B1dHMobSwgIlVua25vd25cbiIpOwot
CQlicmVhazsKLQl9Ci0KLQlzZXFfcHJpbnRmKG0sICJDb3JlIFBvd2VyIERvd246ICVzXG4iLAot
CQkgICB5ZXNubyhndF9jb3JlX3N0YXR1cyAmIEdFTjZfQ09SRV9DUERfU1RBVEVfTUFTSykpOwot
CWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpIHsKLQkJc2VxX3ByaW50ZihtLCAiUmVuZGVy
IFBvd2VyIFdlbGw6ICVzXG4iLAotCQkJKGdlbjlfcG93ZXJnYXRlX3N0YXR1cyAmCi0JCQkgR0VO
OV9QV1JHVF9SRU5ERVJfU1RBVFVTX01BU0spID8gIlVwIiA6ICJEb3duIik7Ci0JCXNlcV9wcmlu
dGYobSwgIk1lZGlhIFBvd2VyIFdlbGw6ICVzXG4iLAotCQkJKGdlbjlfcG93ZXJnYXRlX3N0YXR1
cyAmCi0JCQkgR0VOOV9QV1JHVF9NRURJQV9TVEFUVVNfTUFTSykgPyAiVXAiIDogIkRvd24iKTsK
LQl9Ci0KLQkvKiBOb3QgZXhhY3RseSBzdXJlIHdoYXQgdGhpcyBpcyAqLwotCXByaW50X3JjNl9y
ZXMobSwgIlJDNiBcIkxvY2tlZCB0byBSUG5cIiByZXNpZGVuY3kgc2luY2UgYm9vdDoiLAotCQkg
ICAgICBHRU42X0dUX0dGWF9SQzZfTE9DS0VEKTsKLQlwcmludF9yYzZfcmVzKG0sICJSQzYgcmVz
aWRlbmN5IHNpbmNlIGJvb3Q6IiwgR0VONl9HVF9HRlhfUkM2KTsKLQlwcmludF9yYzZfcmVzKG0s
ICJSQzYrIHJlc2lkZW5jeSBzaW5jZSBib290OiIsIEdFTjZfR1RfR0ZYX1JDNnApOwotCXByaW50
X3JjNl9yZXMobSwgIlJDNisrIHJlc2lkZW5jeSBzaW5jZSBib290OiIsIEdFTjZfR1RfR0ZYX1JD
NnBwKTsKLQotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDcpIHsKLQkJc2VxX3ByaW50Ziht
LCAiUkM2ICAgdm9sdGFnZTogJWRtVlxuIiwKLQkJCSAgIEdFTjZfREVDT0RFX1JDNl9WSUQoKChy
YzZ2aWRzID4+IDApICYgMHhmZikpKTsKLQkJc2VxX3ByaW50ZihtLCAiUkM2KyAgdm9sdGFnZTog
JWRtVlxuIiwKLQkJCSAgIEdFTjZfREVDT0RFX1JDNl9WSUQoKChyYzZ2aWRzID4+IDgpICYgMHhm
ZikpKTsKLQkJc2VxX3ByaW50ZihtLCAiUkM2Kysgdm9sdGFnZTogJWRtVlxuIiwKLQkJCSAgIEdF
TjZfREVDT0RFX1JDNl9WSUQoKChyYzZ2aWRzID4+IDE2KSAmIDB4ZmYpKSk7Ci0JfQotCi0JcmV0
dXJuIGk5MTVfZm9yY2V3YWtlX2RvbWFpbnMobSwgTlVMTCk7Ci19Ci0KLXN0YXRpYyBpbnQgaTkx
NV9kcnBjX2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCi17Ci0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwot
CWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwotCWludCBlcnIgPSAtRU5PREVWOwotCi0Jd2l0aF9p
bnRlbF9ydW50aW1lX3BtKCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZikgewotCQlpZiAo
SVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCi0JCQll
cnIgPSB2bHZfZHJwY19pbmZvKG0pOwotCQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDYpCi0JCQllcnIgPSBnZW42X2RycGNfaW5mbyhtKTsKLQkJZWxzZQotCQkJZXJyID0gaXJvbmxh
a2VfZHJwY19pbmZvKG0pOwotCX0KLQotCXJldHVybiBlcnI7Ci19Ci0KIHN0YXRpYyBpbnQgaTkx
NV9mcm9udGJ1ZmZlcl90cmFja2luZyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkK
IHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+
cHJpdmF0ZSk7CkBAIC0xMzYyLDQ3ICs5MjQsNiBAQCBzdGF0aWMgaW50IGk5MTVfc3Jfc3RhdHVz
KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogCXJldHVybiAwOwogfQogCi1zdGF0
aWMgaW50IGk5MTVfcmluZ19mcmVxX3RhYmxlKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51
c2VkKQotewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkx
NShtLT5wcml2YXRlKTsKLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0LnJw
czsKLQl1bnNpZ25lZCBpbnQgbWF4X2dwdV9mcmVxLCBtaW5fZ3B1X2ZyZXE7Ci0JaW50ZWxfd2Fr
ZXJlZl90IHdha2VyZWY7Ci0JaW50IGdwdV9mcmVxLCBpYV9mcmVxOwotCi0JaWYgKCFIQVNfTExD
KGRldl9wcml2KSkKLQkJcmV0dXJuIC1FTk9ERVY7Ci0KLQltaW5fZ3B1X2ZyZXEgPSBycHMtPm1p
bl9mcmVxOwotCW1heF9ncHVfZnJlcSA9IHJwcy0+bWF4X2ZyZXE7Ci0JaWYgKElTX0dFTjlfQkMo
ZGV2X3ByaXYpIHx8IElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTApIHsKLQkJLyogQ29udmVydCBH
VCBmcmVxdWVuY3kgdG8gNTAgSFogdW5pdHMgKi8KLQkJbWluX2dwdV9mcmVxIC89IEdFTjlfRlJF
UV9TQ0FMRVI7Ci0JCW1heF9ncHVfZnJlcSAvPSBHRU45X0ZSRVFfU0NBTEVSOwotCX0KLQotCXNl
cV9wdXRzKG0sICJHUFUgZnJlcSAoTUh6KVx0RWZmZWN0aXZlIENQVSBmcmVxIChNSHopXHRFZmZl
Y3RpdmUgUmluZyBmcmVxIChNSHopXG4iKTsKLQotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3Bt
X2dldCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOwotCWZvciAoZ3B1X2ZyZXEgPSBtaW5fZ3B1X2Zy
ZXE7IGdwdV9mcmVxIDw9IG1heF9ncHVfZnJlcTsgZ3B1X2ZyZXErKykgewotCQlpYV9mcmVxID0g
Z3B1X2ZyZXE7Ci0JCXNhbmR5YnJpZGdlX3Bjb2RlX3JlYWQoZGV2X3ByaXYsCi0JCQkJICAgICAg
IEdFTjZfUENPREVfUkVBRF9NSU5fRlJFUV9UQUJMRSwKLQkJCQkgICAgICAgJmlhX2ZyZXEsIE5V
TEwpOwotCQlzZXFfcHJpbnRmKG0sICIlZFx0XHQlZFx0XHRcdFx0JWRcbiIsCi0JCQkgICBpbnRl
bF9ncHVfZnJlcShycHMsCi0JCQkJCSAgKGdwdV9mcmVxICoKLQkJCQkJICAgKElTX0dFTjlfQkMo
ZGV2X3ByaXYpIHx8Ci0JCQkJCSAgICBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwID8KLQkJCQkJ
ICAgIEdFTjlfRlJFUV9TQ0FMRVIgOiAxKSkpLAotCQkJICAgKChpYV9mcmVxID4+IDApICYgMHhm
ZikgKiAxMDAsCi0JCQkgICAoKGlhX2ZyZXEgPj4gOCkgJiAweGZmKSAqIDEwMCk7Ci0JfQotCWlu
dGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7Ci0KLQly
ZXR1cm4gMDsKLX0KLQogc3RhdGljIGludCBpOTE1X29wcmVnaW9uKHN0cnVjdCBzZXFfZmlsZSAq
bSwgdm9pZCAqdW51c2VkKQogewogCXN0cnVjdCBpbnRlbF9vcHJlZ2lvbiAqb3ByZWdpb24gPSAm
bm9kZV90b19pOTE1KG0tPnByaXZhdGUpLT5vcHJlZ2lvbjsKQEAgLTE2MDUsODcgKzExMjYsNiBA
QCBzdGF0aWMgaW50IGk5MTVfc3dpenpsZV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAq
ZGF0YSkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGNvbnN0IGNoYXIgKnJwc19wb3dlcl90b19z
dHIodW5zaWduZWQgaW50IHBvd2VyKQotewotCXN0YXRpYyBjb25zdCBjaGFyICogY29uc3Qgc3Ry
aW5nc1tdID0gewotCQlbTE9XX1BPV0VSXSA9ICJsb3cgcG93ZXIiLAotCQlbQkVUV0VFTl0gPSAi
bWl4ZWQiLAotCQlbSElHSF9QT1dFUl0gPSAiaGlnaCBwb3dlciIsCi0JfTsKLQotCWlmIChwb3dl
ciA+PSBBUlJBWV9TSVpFKHN0cmluZ3MpIHx8ICFzdHJpbmdzW3Bvd2VyXSkKLQkJcmV0dXJuICJ1
bmtub3duIjsKLQotCXJldHVybiBzdHJpbmdzW3Bvd2VyXTsKLX0KLQotc3RhdGljIGludCBpOTE1
X3Jwc19ib29zdF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKLXsKLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7
Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndC5ycHM7Ci0JdTMyIGFjdF9m
cmVxOwotCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwotCi0Jd2l0aF9pbnRlbF9ydW50aW1lX3Bt
X2lmX2luX3VzZSgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpCi0JCWFjdF9mcmVxID0g
aW50ZWxfcnBzX3JlYWRfYWN0dWFsX2ZyZXF1ZW5jeShycHMpOwotCi0Jc2VxX3ByaW50ZihtLCAi
UlBTIGVuYWJsZWQ/ICVkXG4iLCBycHMtPmVuYWJsZWQpOwotCXNlcV9wcmludGYobSwgIkdQVSBi
dXN5PyAlc1xuIiwgeWVzbm8oZGV2X3ByaXYtPmd0LmF3YWtlKSk7Ci0Jc2VxX3ByaW50ZihtLCAi
Qm9vc3RzIG91dHN0YW5kaW5nPyAlZFxuIiwKLQkJICAgYXRvbWljX3JlYWQoJnJwcy0+bnVtX3dh
aXRlcnMpKTsKLQlzZXFfcHJpbnRmKG0sICJJbnRlcmFjdGl2ZT8gJWRcbiIsIFJFQURfT05DRShy
cHMtPnBvd2VyLmludGVyYWN0aXZlKSk7Ci0Jc2VxX3ByaW50ZihtLCAiRnJlcXVlbmN5IHJlcXVl
c3RlZCAlZCwgYWN0dWFsICVkXG4iLAotCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+Y3Vy
X2ZyZXEpLCBhY3RfZnJlcSk7Ci0Jc2VxX3ByaW50ZihtLCAiICBtaW4gaGFyZDolZCwgc29mdDol
ZDsgbWF4IHNvZnQ6JWQsIGhhcmQ6JWRcbiIsCi0JCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBz
LT5taW5fZnJlcSksCi0JCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5taW5fZnJlcV9zb2Z0
bGltaXQpLAotCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWF4X2ZyZXFfc29mdGxpbWl0
KSwKLQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPm1heF9mcmVxKSk7Ci0Jc2VxX3ByaW50
ZihtLCAiICBpZGxlOiVkLCBlZmZpY2llbnQ6JWQsIGJvb3N0OiVkXG4iLAotCQkgICBpbnRlbF9n
cHVfZnJlcShycHMsIHJwcy0+aWRsZV9mcmVxKSwKLQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBy
cHMtPmVmZmljaWVudF9mcmVxKSwKLQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmJvb3N0
X2ZyZXEpKTsKLQotCXNlcV9wcmludGYobSwgIldhaXQgYm9vc3RzOiAlZFxuIiwgYXRvbWljX3Jl
YWQoJnJwcy0+Ym9vc3RzKSk7Ci0KLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA2ICYmIHJw
cy0+ZW5hYmxlZCAmJiBkZXZfcHJpdi0+Z3QuYXdha2UpIHsKLQkJdTMyIHJwdXAsIHJwdXBlaTsK
LQkJdTMyIHJwZG93biwgcnBkb3duZWk7Ci0KLQkJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQo
JmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotCQlycHVwID0gSTkxNV9SRUFEX0ZX
KEdFTjZfUlBfQ1VSX1VQKSAmIEdFTjZfUlBfRUlfTUFTSzsKLQkJcnB1cGVpID0gSTkxNV9SRUFE
X0ZXKEdFTjZfUlBfQ1VSX1VQX0VJKSAmIEdFTjZfUlBfRUlfTUFTSzsKLQkJcnBkb3duID0gSTkx
NV9SRUFEX0ZXKEdFTjZfUlBfQ1VSX0RPV04pICYgR0VONl9SUF9FSV9NQVNLOwotCQlycGRvd25l
aSA9IEk5MTVfUkVBRF9GVyhHRU42X1JQX0NVUl9ET1dOX0VJKSAmIEdFTjZfUlBfRUlfTUFTSzsK
LQkJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FL
RV9BTEwpOwotCi0JCXNlcV9wcmludGYobSwgIlxuUlBTIEF1dG90dW5pbmcgKGN1cnJlbnQgXCIl
c1wiIHdpbmRvdyk6XG4iLAotCQkJICAgcnBzX3Bvd2VyX3RvX3N0cihycHMtPnBvd2VyLm1vZGUp
KTsKLQkJc2VxX3ByaW50ZihtLCAiICBBdmcuIHVwOiAlZCUlIFthYm92ZSB0aHJlc2hvbGQ/ICVk
JSVdXG4iLAotCQkJICAgcnB1cCAmJiBycHVwZWkgPyAxMDAgKiBycHVwIC8gcnB1cGVpIDogMCwK
LQkJCSAgIHJwcy0+cG93ZXIudXBfdGhyZXNob2xkKTsKLQkJc2VxX3ByaW50ZihtLCAiICBBdmcu
IGRvd246ICVkJSUgW2JlbG93IHRocmVzaG9sZD8gJWQlJV1cbiIsCi0JCQkgICBycGRvd24gJiYg
cnBkb3duZWkgPyAxMDAgKiBycGRvd24gLyBycGRvd25laSA6IDAsCi0JCQkgICBycHMtPnBvd2Vy
LmRvd25fdGhyZXNob2xkKTsKLQl9IGVsc2UgewotCQlzZXFfcHV0cyhtLCAiXG5SUFMgQXV0b3R1
bmluZyBpbmFjdGl2ZVxuIik7Ci0JfQotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQgaTkx
NV9sbGMoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQotewotCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKLQljb25zdCBi
b29sIGVkcmFtID0gSU5URUxfR0VOKGRldl9wcml2KSA+IDg7Ci0KLQlzZXFfcHJpbnRmKG0sICJM
TEM6ICVzXG4iLCB5ZXNubyhIQVNfTExDKGRldl9wcml2KSkpOwotCXNlcV9wcmludGYobSwgIiVz
OiAldU1CXG4iLCBlZHJhbSA/ICJlRFJBTSIgOiAiZUxMQyIsCi0JCSAgIGRldl9wcml2LT5lZHJh
bV9zaXplX21iKTsKLQotCXJldHVybiAwOwotfQotCiBzdGF0aWMgaW50IGk5MTVfaHVjX2xvYWRf
c3RhdHVzX2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQogewogCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKQEAg
LTQyNDYsOSArMzY4Niw2IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2luZm9fbGlzdCBpOTE1
X2RlYnVnZnNfbGlzdFtdID0gewogCXsiaTkxNV9ndWNfbG9hZF9lcnJfbG9nX2R1bXAiLCBpOTE1
X2d1Y19sb2dfZHVtcCwgMCwgKHZvaWQgKikxfSwKIAl7Imk5MTVfZ3VjX3N0YWdlX3Bvb2wiLCBp
OTE1X2d1Y19zdGFnZV9wb29sLCAwfSwKIAl7Imk5MTVfaHVjX2xvYWRfc3RhdHVzIiwgaTkxNV9o
dWNfbG9hZF9zdGF0dXNfaW5mbywgMH0sCi0JeyJpOTE1X2ZyZXF1ZW5jeV9pbmZvIiwgaTkxNV9m
cmVxdWVuY3lfaW5mbywgMH0sCi0JeyJpOTE1X2RycGNfaW5mbyIsIGk5MTVfZHJwY19pbmZvLCAw
fSwKLQl7Imk5MTVfcmluZ19mcmVxX3RhYmxlIiwgaTkxNV9yaW5nX2ZyZXFfdGFibGUsIDB9LAog
CXsiaTkxNV9mcm9udGJ1ZmZlcl90cmFja2luZyIsIGk5MTVfZnJvbnRidWZmZXJfdHJhY2tpbmcs
IDB9LAogCXsiaTkxNV9mYmNfc3RhdHVzIiwgaTkxNV9mYmNfc3RhdHVzLCAwfSwKIAl7Imk5MTVf
aXBzX3N0YXR1cyIsIGk5MTVfaXBzX3N0YXR1cywgMH0sCkBAIC00MjU3LDkgKzM2OTQsNyBAQCBz
dGF0aWMgY29uc3Qgc3RydWN0IGRybV9pbmZvX2xpc3QgaTkxNV9kZWJ1Z2ZzX2xpc3RbXSA9IHsK
IAl7Imk5MTVfdmJ0IiwgaTkxNV92YnQsIDB9LAogCXsiaTkxNV9nZW1fZnJhbWVidWZmZXIiLCBp
OTE1X2dlbV9mcmFtZWJ1ZmZlcl9pbmZvLCAwfSwKIAl7Imk5MTVfY29udGV4dF9zdGF0dXMiLCBp
OTE1X2NvbnRleHRfc3RhdHVzLCAwfSwKLQl7Imk5MTVfZm9yY2V3YWtlX2RvbWFpbnMiLCBpOTE1
X2ZvcmNld2FrZV9kb21haW5zLCAwfSwKIAl7Imk5MTVfc3dpenpsZV9pbmZvIiwgaTkxNV9zd2l6
emxlX2luZm8sIDB9LAotCXsiaTkxNV9sbGMiLCBpOTE1X2xsYywgMH0sCiAJeyJpOTE1X2VkcF9w
c3Jfc3RhdHVzIiwgaTkxNV9lZHBfcHNyX3N0YXR1cywgMH0sCiAJeyJpOTE1X2VuZXJneV91SiIs
IGk5MTVfZW5lcmd5X3VKLCAwfSwKIAl7Imk5MTVfcnVudGltZV9wbV9zdGF0dXMiLCBpOTE1X3J1
bnRpbWVfcG1fc3RhdHVzLCAwfSwKQEAgLTQyNzUsNyArMzcxMCw2IEBAIHN0YXRpYyBjb25zdCBz
dHJ1Y3QgZHJtX2luZm9fbGlzdCBpOTE1X2RlYnVnZnNfbGlzdFtdID0gewogCXsiaTkxNV9kZGJf
aW5mbyIsIGk5MTVfZGRiX2luZm8sIDB9LAogCXsiaTkxNV9zc2V1X3N0YXR1cyIsIGk5MTVfc3Nl
dV9zdGF0dXMsIDB9LAogCXsiaTkxNV9kcnJzX3N0YXR1cyIsIGk5MTVfZHJyc19zdGF0dXMsIDB9
LAotCXsiaTkxNV9ycHNfYm9vc3RfaW5mbyIsIGk5MTVfcnBzX2Jvb3N0X2luZm8sIDB9LAogfTsK
ICNkZWZpbmUgSTkxNV9ERUJVR0ZTX0VOVFJJRVMgQVJSQVlfU0laRShpOTE1X2RlYnVnZnNfbGlz
dCkKIApAQCAtNDMxMSw2ICszNzQ1LDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X2RlYnVn
ZnNfZmlsZXMgewogaW50IGk5MTVfZGVidWdmc19yZWdpc3RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCiB7CiAJc3RydWN0IGRybV9taW5vciAqbWlub3IgPSBkZXZfcHJpdi0+
ZHJtLnByaW1hcnk7CisJaW50IGVycjsKIAlpbnQgaTsKIAogCWRlYnVnZnNfY3JlYXRlX2ZpbGUo
Imk5MTVfZm9yY2V3YWtlX3VzZXIiLCBTX0lSVVNSLCBtaW5vci0+ZGVidWdmc19yb290LApAQCAt
NDMyNCw5ICszNzU5LDEzIEBAIGludCBpOTE1X2RlYnVnZnNfcmVnaXN0ZXIoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQogCQkJCSAgICBpOTE1X2RlYnVnZnNfZmlsZXNbaV0uZm9w
cyk7CiAJfQogCi0JcmV0dXJuIGRybV9kZWJ1Z2ZzX2NyZWF0ZV9maWxlcyhpOTE1X2RlYnVnZnNf
bGlzdCwKLQkJCQkJSTkxNV9ERUJVR0ZTX0VOVFJJRVMsCi0JCQkJCW1pbm9yLT5kZWJ1Z2ZzX3Jv
b3QsIG1pbm9yKTsKKwllcnIgPSBkcm1fZGVidWdmc19jcmVhdGVfZmlsZXMoaTkxNV9kZWJ1Z2Zz
X2xpc3QsCisJCQkJICAgICAgIEk5MTVfREVCVUdGU19FTlRSSUVTLAorCQkJCSAgICAgICBtaW5v
ci0+ZGVidWdmc19yb290LCBtaW5vcik7CisJaWYgKGVycikKKwkJcmV0dXJuIGVycjsKKworCXJl
dHVybiBkZWJ1Z2ZzX2d0X2luaXQoJmRldl9wcml2LT5ndCk7CiB9CiAKIHN0cnVjdCBkcGNkX2Js
b2NrIHsKLS0gCjIuMjQuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0
b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50
ZWwtZ2Z4Cg==

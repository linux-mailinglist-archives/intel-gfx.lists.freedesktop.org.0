Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id F024119E06
	for <lists+intel-gfx@lfdr.de>; Fri, 10 May 2019 15:22:52 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 882E989362;
	Fri, 10 May 2019 13:22:50 +0000 (UTC)
X-Original-To: Intel-gfx@lists.freedesktop.org
Delivered-To: Intel-gfx@lists.freedesktop.org
Received: from mga02.intel.com (mga02.intel.com [134.134.136.20])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 80E168938C
 for <Intel-gfx@lists.freedesktop.org>; Fri, 10 May 2019 13:22:49 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga006.fm.intel.com ([10.253.24.20])
 by orsmga101.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 10 May 2019 06:22:49 -0700
X-ExtLoop1: 1
Received: from ddillonx-mobl.ger.corp.intel.com (HELO localhost.localdomain)
 ([10.252.28.3])
 by fmsmga006.fm.intel.com with ESMTP; 10 May 2019 06:22:48 -0700
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
To: Intel-gfx@lists.freedesktop.org
Date: Fri, 10 May 2019 14:22:35 +0100
Message-Id: <20190510132240.11029-2-tvrtko.ursulin@linux.intel.com>
X-Mailer: git-send-email 2.19.1
In-Reply-To: <20190510132240.11029-1-tvrtko.ursulin@linux.intel.com>
References: <20190510132240.11029-1-tvrtko.ursulin@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [RFC 1/6] drm/i915: Move intel_engine_context_in/out
 into intel_lrc.c
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KCkludGVsX2xy
Yy5jIGlzIHRoZSBvbmx5IGNhbGxlciBhbmQgc28gdG8gYXZvaWQgc29tZSBoZWFkZXIgZmlsZSBv
cmRlcmluZwppc3N1ZXMgaW4gZnV0dXJlIHBhdGNoZXMgbW92ZSB0aGVzZSB0d28gb3ZlciB0aGVy
ZS4KClNpZ25lZC1vZmYtYnk6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBpbnRlbC5j
b20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lLmggfCA1NSAtLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMu
YyAgICB8IDU3ICsrKysrKysrKysrKysrKysrKysrKysrKysrCiAyIGZpbGVzIGNoYW5nZWQsIDU3
IGluc2VydGlvbnMoKyksIDU1IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZW5naW5lLmgKaW5kZXggOTM1OWIzYTdhZDljLi4zMjM2MTUzYjUwNTggMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oCkBAIC00NjMsNjEgKzQ2Myw2IEBAIHZvaWQgaW50
ZWxfZW5naW5lX2R1bXAoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAogc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqCiBpbnRlbF9lbmdpbmVfbG9va3VwX3VzZXIoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsIHU4IGNsYXNzLCB1OCBpbnN0YW5jZSk7CiAKLXN0YXRpYyBpbmxpbmUg
dm9pZCBpbnRlbF9lbmdpbmVfY29udGV4dF9pbihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpCi17Ci0JdW5zaWduZWQgbG9uZyBmbGFnczsKLQotCWlmIChSRUFEX09OQ0UoZW5naW5lLT5z
dGF0cy5lbmFibGVkKSA9PSAwKQotCQlyZXR1cm47Ci0KLQl3cml0ZV9zZXFsb2NrX2lycXNhdmUo
JmVuZ2luZS0+c3RhdHMubG9jaywgZmxhZ3MpOwotCi0JaWYgKGVuZ2luZS0+c3RhdHMuZW5hYmxl
ZCA+IDApIHsKLQkJaWYgKGVuZ2luZS0+c3RhdHMuYWN0aXZlKysgPT0gMCkKLQkJCWVuZ2luZS0+
c3RhdHMuc3RhcnQgPSBrdGltZV9nZXQoKTsKLQkJR0VNX0JVR19PTihlbmdpbmUtPnN0YXRzLmFj
dGl2ZSA9PSAwKTsKLQl9Ci0KLQl3cml0ZV9zZXF1bmxvY2tfaXJxcmVzdG9yZSgmZW5naW5lLT5z
dGF0cy5sb2NrLCBmbGFncyk7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9lbmdpbmVf
Y29udGV4dF9vdXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQotewotCXVuc2lnbmVk
IGxvbmcgZmxhZ3M7Ci0KLQlpZiAoUkVBRF9PTkNFKGVuZ2luZS0+c3RhdHMuZW5hYmxlZCkgPT0g
MCkKLQkJcmV0dXJuOwotCi0Jd3JpdGVfc2VxbG9ja19pcnFzYXZlKCZlbmdpbmUtPnN0YXRzLmxv
Y2ssIGZsYWdzKTsKLQotCWlmIChlbmdpbmUtPnN0YXRzLmVuYWJsZWQgPiAwKSB7Ci0JCWt0aW1l
X3QgbGFzdDsKLQotCQlpZiAoZW5naW5lLT5zdGF0cy5hY3RpdmUgJiYgLS1lbmdpbmUtPnN0YXRz
LmFjdGl2ZSA9PSAwKSB7Ci0JCQkvKgotCQkJICogRGVjcmVtZW50IHRoZSBhY3RpdmUgY29udGV4
dCBjb3VudCBhbmQgaW4gY2FzZSBHUFUKLQkJCSAqIGlzIG5vdyBpZGxlIGFkZCB1cCB0byB0aGUg
cnVubmluZyB0b3RhbC4KLQkJCSAqLwotCQkJbGFzdCA9IGt0aW1lX3N1YihrdGltZV9nZXQoKSwg
ZW5naW5lLT5zdGF0cy5zdGFydCk7Ci0KLQkJCWVuZ2luZS0+c3RhdHMudG90YWwgPSBrdGltZV9h
ZGQoZW5naW5lLT5zdGF0cy50b3RhbCwKLQkJCQkJCQlsYXN0KTsKLQkJfSBlbHNlIGlmIChlbmdp
bmUtPnN0YXRzLmFjdGl2ZSA9PSAwKSB7Ci0JCQkvKgotCQkJICogQWZ0ZXIgdHVybmluZyBvbiBl
bmdpbmUgc3RhdHMsIGNvbnRleHQgb3V0IG1pZ2h0IGJlCi0JCQkgKiB0aGUgZmlyc3QgZXZlbnQg
aW4gd2hpY2ggY2FzZSB3ZSBhY2NvdW50IGZyb20gdGhlCi0JCQkgKiB0aW1lIHN0YXRzIGdhdGhl
cmluZyB3YXMgdHVybmVkIG9uLgotCQkJICovCi0JCQlsYXN0ID0ga3RpbWVfc3ViKGt0aW1lX2dl
dCgpLCBlbmdpbmUtPnN0YXRzLmVuYWJsZWRfYXQpOwotCi0JCQllbmdpbmUtPnN0YXRzLnRvdGFs
ID0ga3RpbWVfYWRkKGVuZ2luZS0+c3RhdHMudG90YWwsCi0JCQkJCQkJbGFzdCk7Ci0JCX0KLQl9
Ci0KLQl3cml0ZV9zZXF1bmxvY2tfaXJxcmVzdG9yZSgmZW5naW5lLT5zdGF0cy5sb2NrLCBmbGFn
cyk7Ci19Ci0KIGludCBpbnRlbF9lbmFibGVfZW5naW5lX3N0YXRzKHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSk7CiB2b2lkIGludGVsX2Rpc2FibGVfZW5naW5lX3N0YXRzKHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2xyYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMK
aW5kZXggZTE4NjIzZGVmMjgyLi4xNzBlMzk0MjA2Y2EgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2xyYy5jCkBAIC00NTMsNiArNDUzLDYzIEBAIGV4ZWNsaXN0c19jb250ZXh0X3N0YXR1c19j
aGFuZ2Uoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsIHVuc2lnbmVkIGxvbmcgc3RhdHVzKQogCQkJ
CSAgIHN0YXR1cywgcnEpOwogfQogCitzdGF0aWMgaW5saW5lIHZvaWQKK2ludGVsX2VuZ2luZV9j
b250ZXh0X2luKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwl1bnNpZ25lZCBs
b25nIGZsYWdzOworCisJaWYgKFJFQURfT05DRShlbmdpbmUtPnN0YXRzLmVuYWJsZWQpID09IDAp
CisJCXJldHVybjsKKworCXdyaXRlX3NlcWxvY2tfaXJxc2F2ZSgmZW5naW5lLT5zdGF0cy5sb2Nr
LCBmbGFncyk7CisKKwlpZiAoZW5naW5lLT5zdGF0cy5lbmFibGVkID4gMCkgeworCQlpZiAoZW5n
aW5lLT5zdGF0cy5hY3RpdmUrKyA9PSAwKQorCQkJZW5naW5lLT5zdGF0cy5zdGFydCA9IGt0aW1l
X2dldCgpOworCQlHRU1fQlVHX09OKGVuZ2luZS0+c3RhdHMuYWN0aXZlID09IDApOworCX0KKwor
CXdyaXRlX3NlcXVubG9ja19pcnFyZXN0b3JlKCZlbmdpbmUtPnN0YXRzLmxvY2ssIGZsYWdzKTsK
K30KKworc3RhdGljIGlubGluZSB2b2lkCitpbnRlbF9lbmdpbmVfY29udGV4dF9vdXQoc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisKKwlp
ZiAoUkVBRF9PTkNFKGVuZ2luZS0+c3RhdHMuZW5hYmxlZCkgPT0gMCkKKwkJcmV0dXJuOworCisJ
d3JpdGVfc2VxbG9ja19pcnFzYXZlKCZlbmdpbmUtPnN0YXRzLmxvY2ssIGZsYWdzKTsKKworCWlm
IChlbmdpbmUtPnN0YXRzLmVuYWJsZWQgPiAwKSB7CisJCWt0aW1lX3QgbGFzdDsKKworCQlpZiAo
ZW5naW5lLT5zdGF0cy5hY3RpdmUgJiYgLS1lbmdpbmUtPnN0YXRzLmFjdGl2ZSA9PSAwKSB7CisJ
CQkvKgorCQkJICogRGVjcmVtZW50IHRoZSBhY3RpdmUgY29udGV4dCBjb3VudCBhbmQgaW4gY2Fz
ZSBHUFUKKwkJCSAqIGlzIG5vdyBpZGxlIGFkZCB1cCB0byB0aGUgcnVubmluZyB0b3RhbC4KKwkJ
CSAqLworCQkJbGFzdCA9IGt0aW1lX3N1YihrdGltZV9nZXQoKSwgZW5naW5lLT5zdGF0cy5zdGFy
dCk7CisKKwkJCWVuZ2luZS0+c3RhdHMudG90YWwgPSBrdGltZV9hZGQoZW5naW5lLT5zdGF0cy50
b3RhbCwKKwkJCQkJCQlsYXN0KTsKKwkJfSBlbHNlIGlmIChlbmdpbmUtPnN0YXRzLmFjdGl2ZSA9
PSAwKSB7CisJCQkvKgorCQkJICogQWZ0ZXIgdHVybmluZyBvbiBlbmdpbmUgc3RhdHMsIGNvbnRl
eHQgb3V0IG1pZ2h0IGJlCisJCQkgKiB0aGUgZmlyc3QgZXZlbnQgaW4gd2hpY2ggY2FzZSB3ZSBh
Y2NvdW50IGZyb20gdGhlCisJCQkgKiB0aW1lIHN0YXRzIGdhdGhlcmluZyB3YXMgdHVybmVkIG9u
LgorCQkJICovCisJCQlsYXN0ID0ga3RpbWVfc3ViKGt0aW1lX2dldCgpLCBlbmdpbmUtPnN0YXRz
LmVuYWJsZWRfYXQpOworCisJCQllbmdpbmUtPnN0YXRzLnRvdGFsID0ga3RpbWVfYWRkKGVuZ2lu
ZS0+c3RhdHMudG90YWwsCisJCQkJCQkJbGFzdCk7CisJCX0KKwl9CisKKwl3cml0ZV9zZXF1bmxv
Y2tfaXJxcmVzdG9yZSgmZW5naW5lLT5zdGF0cy5sb2NrLCBmbGFncyk7Cit9CisKIGlubGluZSB2
b2lkCiBleGVjbGlzdHNfdXNlcl9iZWdpbihzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAq
ZXhlY2xpc3RzLAogCQkgICAgIGNvbnN0IHN0cnVjdCBleGVjbGlzdF9wb3J0ICpwb3J0KQotLSAK
Mi4xOS4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJ
bnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0
cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

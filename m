Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id A191B48E71
	for <lists+intel-gfx@lfdr.de>; Mon, 17 Jun 2019 21:25:37 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D577188FFB;
	Mon, 17 Jun 2019 19:25:35 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga12.intel.com (mga12.intel.com [192.55.52.136])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E1CD388E66
 for <intel-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 19:25:33 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga002.jf.intel.com ([10.7.209.21])
 by fmsmga106.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 17 Jun 2019 12:25:33 -0700
X-ExtLoop1: 1
Received: from unknown (HELO [10.252.2.103]) ([10.252.2.103])
 by orsmga002.jf.intel.com with ESMTP; 17 Jun 2019 12:25:31 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20190617071912.20256-1-chris@chris-wilson.co.uk>
 <20190617071912.20256-16-chris@chris-wilson.co.uk>
From: Matthew Auld <matthew.auld@intel.com>
Message-ID: <78c745c9-80ac-27c7-f21c-cbfe2995e24b@intel.com>
Date: Mon, 17 Jun 2019 20:25:31 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.4.0
MIME-Version: 1.0
In-Reply-To: <20190617071912.20256-16-chris@chris-wilson.co.uk>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH 16/22] drm/i915: Push the i915_active.retire
 into a worker
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: mika.kuoppala@intel.com
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T24gMTcvMDYvMjAxOSAwODoxOSwgQ2hyaXMgV2lsc29uIHdyb3RlOgo+IEFzIHdlIG5lZWQgdG8g
dXNlIGEgbXV0ZXggdG8gc2VyaWFsaXNhdGlvbiBpOTE1X2FjdGl2ZSBhY3RpdmF0aW9uCgp0byBz
ZXJpYWxpc2UKCj4gKGJlY2F1c2Ugd2Ugd2FudCB0byBhbGxvdyB0aGUgY2FsbGJhY2sgdG8gc2xl
ZXApLCB3ZSBuZWVkIHRvIHB1c2ggdGhlCj4gaTkxNV9hY3RpdmUucmV0aXJlIGludG8gYSB3b3Jr
ZXIgY2FsbGJhY2sgaW4gY2FzZSB3ZSBnZXQgbmVlZCB0byByZXRpcmUKPiBmcm9tIGFuIGF0b21p
YyBjb250ZXh0Lgo+IAo+IFNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMt
d2lsc29uLmNvLnVrPgo+IC0tLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X2NvbnRleHQuYyB8ICAxICsKPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRl
eHQuYyAgICAgfCAgMSArCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5jICAg
ICAgICAgIHwgNzIgKysrKysrKysrKysrKysrKy0tLS0tCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2FjdGl2ZV90eXBlcy5oICAgIHwgMTIgKysrKwo+ICAgZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV90aW1lbGluZS5jICAgICAgICB8ICAxICsKPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfdm1hLmMgICAgICAgICAgICAgfCAgMyArLQo+ICAgNiBmaWxlcyBjaGFuZ2VkLCA3NCBp
bnNlcnRpb25zKCspLCAxNiBkZWxldGlvbnMoLSkKPiAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKPiBpbmRleCA5MjYyYTFkNGY3NjMuLmM4NTQ2OGQ1MTdl
ZiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4
dC5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYwo+
IEBAIC04OTEsNiArODkxLDcgQEAgc3RydWN0IGNvbnRleHRfYmFycmllcl90YXNrIHsKPiAgIAl2
b2lkICpkYXRhOwo+ICAgfTsKPiAgIAo+ICtfX2k5MTVfYWN0aXZlX2NhbGwKPiAgIHN0YXRpYyB2
b2lkIGNiX3JldGlyZShzdHJ1Y3QgaTkxNV9hY3RpdmUgKmJhc2UpCj4gICB7Cj4gICAJc3RydWN0
IGNvbnRleHRfYmFycmllcl90YXNrICpjYiA9IGNvbnRhaW5lcl9vZihiYXNlLCB0eXBlb2YoKmNi
KSwgYmFzZSk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2Nv
bnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYwo+IGluZGV4
IGIxOWFhODIzYTUxYS4uYWJlYjZiZjAxNTVhIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2NvbnRleHQuYwo+IEBAIC0xMjIsNiArMTIyLDcgQEAgc3RhdGljIHZvaWQgX19jb250
ZXh0X3VucGluX3N0YXRlKHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQo+ICAgCV9faTkxNV92bWFfdW5w
aW4odm1hKTsKPiAgIH0KPiAgIAo+ICtfX2k5MTVfYWN0aXZlX2NhbGwKPiAgIHN0YXRpYyB2b2lk
IF9faW50ZWxfY29udGV4dF9yZXRpcmUoc3RydWN0IGk5MTVfYWN0aXZlICphY3RpdmUpCj4gICB7
Cj4gICAJc3RydWN0IGludGVsX2NvbnRleHQgKmNlID0gY29udGFpbmVyX29mKGFjdGl2ZSwgdHlw
ZW9mKCpjZSksIGFjdGl2ZSk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfYWN0aXZlLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5jCj4gaW5kZXgg
NmE5ZjhkMzdmNDE1Li4yMGIwZTE5YWFmZmYgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9hY3RpdmUuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0
aXZlLmMKPiBAQCAtMzAsMTggKzMwLDE0IEBAIHN0cnVjdCBhY3RpdmVfbm9kZSB7Cj4gICB9Owo+
ICAgCj4gICBzdGF0aWMgdm9pZAo+IC1hY3RpdmVfcmV0aXJlKHN0cnVjdCBpOTE1X2FjdGl2ZSAq
cmVmKQo+ICtfX2FjdGl2ZV9yZXRpcmUoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCj4gICB7Cj4g
ICAJc3RydWN0IGFjdGl2ZV9ub2RlICppdCwgKm47Cj4gICAJc3RydWN0IHJiX3Jvb3Qgcm9vdDsK
PiAgIAlib29sIHJldGlyZSA9IGZhbHNlOwo+ICAgCj4gLQlHRU1fQlVHX09OKCFhdG9taWNfcmVh
ZCgmcmVmLT5jb3VudCkpOwo+IC0JaWYgKGF0b21pY19hZGRfdW5sZXNzKCZyZWYtPmNvdW50LCAt
MSwgMSkpCj4gLQkJcmV0dXJuOwo+IC0KPiAtCS8qIE9uZSBhY3RpdmUgbWF5IGJlIGZsdXNoZWQg
ZnJvbSBpbnNpZGUgdGhlIGFjcXVpcmUgb2YgYW5vdGhlciAqLwo+IC0JbXV0ZXhfbG9ja19uZXN0
ZWQoJnJlZi0+bXV0ZXgsIFNJTkdMRV9ERVBUSF9ORVNUSU5HKTsKPiArCWxvY2tkZXBfYXNzZXJ0
X2hlbGQoJnJlZi0+bXV0ZXgpOwo+ICsJR0VNX0JVR19PTihpOTE1X2FjdGl2ZV9pc19pZGxlKHJl
ZikpOwo+ICAgCj4gICAJLyogcmV0dXJuIHRoZSB1bnVzZWQgbm9kZXMgdG8gb3VyIHNsYWJjYWNo
ZSAtLSBmbHVzaGluZyB0aGUgYWxsb2NhdG9yICovCj4gICAJaWYgKGF0b21pY19kZWNfYW5kX3Rl
c3QoJnJlZi0+Y291bnQpKSB7Cj4gQEAgLTYzLDYgKzU5LDM2IEBAIGFjdGl2ZV9yZXRpcmUoc3Ry
dWN0IGk5MTVfYWN0aXZlICpyZWYpCj4gICAJfQo+ICAgfQo+ICAgCj4gK3N0YXRpYyB2b2lkCj4g
K2FjdGl2ZV93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd3JrKQo+ICt7Cj4gKwlzdHJ1Y3QgaTkx
NV9hY3RpdmUgKnJlZiA9IGNvbnRhaW5lcl9vZih3cmssIHR5cGVvZigqcmVmKSwgd29yayk7Cj4g
Kwo+ICsJR0VNX0JVR19PTighYXRvbWljX3JlYWQoJnJlZi0+Y291bnQpKTsKPiArCWlmIChhdG9t
aWNfYWRkX3VubGVzcygmcmVmLT5jb3VudCwgLTEsIDEpKQo+ICsJCXJldHVybjsKPiArCj4gKwlt
dXRleF9sb2NrKCZyZWYtPm11dGV4KTsKPiArCV9fYWN0aXZlX3JldGlyZShyZWYpOwo+ICt9Cj4g
Kwo+ICtzdGF0aWMgdm9pZAo+ICthY3RpdmVfcmV0aXJlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVm
KQo+ICt7Cj4gKwlHRU1fQlVHX09OKCFhdG9taWNfcmVhZCgmcmVmLT5jb3VudCkpOwo+ICsJaWYg
KGF0b21pY19hZGRfdW5sZXNzKCZyZWYtPmNvdW50LCAtMSwgMSkpCj4gKwkJcmV0dXJuOwo+ICsK
PiArCS8qIElmIHdlIGFyZSBpbnNpZGUgaW50ZXJydXB0IGNvbnRleHQgKGZlbmNlIHNpZ25hbGlu
ZyksIGRlZmVyICovCj4gKwlpZiAocmVmLT5mbGFncyAmIEk5MTVfQUNUSVZFX1JFVElSRV9TTEVF
UFMgfHwKPiArCSAgICAhbXV0ZXhfdHJ5bG9jaygmcmVmLT5tdXRleCkpIHsKPiArCQlxdWV1ZV93
b3JrKHN5c3RlbV91bmJvdW5kX3dxLCAmcmVmLT53b3JrKTsKPiArCQlyZXR1cm47Cj4gKwl9Cj4g
Kwo+ICsJX19hY3RpdmVfcmV0aXJlKHJlZik7Cj4gK30KPiArCj4gICBzdGF0aWMgdm9pZAo+ICAg
bm9kZV9yZXRpcmUoc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmJhc2UsIHN0cnVjdCBpOTE1
X3JlcXVlc3QgKnJxKQo+ICAgewo+IEBAIC0xMzIsMTQgKzE1OCwyMiBAQCB2b2lkIF9faTkxNV9h
Y3RpdmVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCXZvaWQgKCpy
ZXRpcmUpKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKSwKPiAgIAkJCXN0cnVjdCBsb2NrX2NsYXNz
X2tleSAqa2V5KQo+ICAgewo+ICsJdW5zaWduZWQgbG9uZyBiaXRzOwo+ICsKPiAgIAlyZWYtPmk5
MTUgPSBpOTE1Owo+ICsKPiArCXJlZi0+ZmxhZ3MgPSAwOwo+ICAgCXJlZi0+YWN0aXZlID0gYWN0
aXZlOwo+IC0JcmVmLT5yZXRpcmUgPSByZXRpcmU7Cj4gKwlyZWYtPnJldGlyZSA9IHB0cl91bnBh
Y2tfYml0cyhyZXRpcmUsICZiaXRzLCAyKTsKPiArCWlmIChiaXRzICYgSTkxNV9BQ1RJVkVfTUFZ
X1NMRUVQKQo+ICsJCXJlZi0+ZmxhZ3MgfD0gSTkxNV9BQ1RJVkVfUkVUSVJFX1NMRUVQUzsKPiAr
Cj4gICAJcmVmLT50cmVlID0gUkJfUk9PVDsKPiAgIAlyZWYtPmNhY2hlID0gTlVMTDsKPiAgIAlp
bml0X2xsaXN0X2hlYWQoJnJlZi0+YmFycmllcnMpOwo+ICAgCWF0b21pY19zZXQoJnJlZi0+Y291
bnQsIDApOwo+ICAgCV9fbXV0ZXhfaW5pdCgmcmVmLT5tdXRleCwgImk5MTVfYWN0aXZlIiwga2V5
KTsKPiArCUlOSVRfV09SSygmcmVmLT53b3JrLCBhY3RpdmVfd29yayk7Cj4gICB9Cj4gICAKPiAg
IGludCBpOTE1X2FjdGl2ZV9yZWYoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsCj4gQEAgLTIwOCw4
ICsyNDIsMTAgQEAgaW50IGk5MTVfYWN0aXZlX3dhaXQoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYp
Cj4gICAJaWYgKGVycikKPiAgIAkJcmV0dXJuIGVycjsKPiAgIAo+IC0JaWYgKCFhdG9taWNfYWRk
X3VubGVzcygmcmVmLT5jb3VudCwgMSwgMCkpCj4gLQkJZ290byB1bmxvY2s7Cj4gKwlpZiAoIWF0
b21pY19hZGRfdW5sZXNzKCZyZWYtPmNvdW50LCAxLCAwKSkgewo+ICsJCW11dGV4X3VubG9jaygm
cmVmLT5tdXRleCk7Cj4gKwkJcmV0dXJuIDA7Cj4gKwl9Cj4gICAKPiAgIAlyYnRyZWVfcG9zdG9y
ZGVyX2Zvcl9lYWNoX2VudHJ5X3NhZmUoaXQsIG4sICZyZWYtPnRyZWUsIG5vZGUpIHsKPiAgIAkJ
ZXJyID0gaTkxNV9hY3RpdmVfcmVxdWVzdF9yZXRpcmUoJml0LT5iYXNlLCBCS0wocmVmKSk7Cj4g
QEAgLTIxNywxMCArMjUzLDE1IEBAIGludCBpOTE1X2FjdGl2ZV93YWl0KHN0cnVjdCBpOTE1X2Fj
dGl2ZSAqcmVmKQo+ICAgCQkJYnJlYWs7Cj4gICAJfQo+ICAgCj4gLQlhY3RpdmVfcmV0aXJlKHJl
Zik7Cj4gLXVubG9jazoKPiAtCW11dGV4X3VubG9jaygmcmVmLT5tdXRleCk7Cj4gLQlyZXR1cm4g
ZXJyOwo+ICsJX19hY3RpdmVfcmV0aXJlKHJlZik7Cj4gKwlpZiAoZXJyKQo+ICsJCXJldHVybiBl
cnI7Cj4gKwo+ICsJZmx1c2hfd29yaygmcmVmLT53b3JrKTsKPiArCWlmICghaTkxNV9hY3RpdmVf
aXNfaWRsZShyZWYpKQo+ICsJCXJldHVybiAtRUJVU1k7Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gICB9
Cj4gICAKPiAgIGludCBpOTE1X3JlcXVlc3RfYXdhaXRfYWN0aXZlX3JlcXVlc3Qoc3RydWN0IGk5
MTVfcmVxdWVzdCAqcnEsCj4gQEAgLTI2MCw4ICszMDEsOSBAQCBpbnQgaTkxNV9yZXF1ZXN0X2F3
YWl0X2FjdGl2ZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgc3RydWN0IGk5MTVfYWN0aXZlICpy
ZWYpCj4gICAjaWYgSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfREVCVUdfR0VNKQo+ICAgdm9p
ZCBpOTE1X2FjdGl2ZV9maW5pKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQo+ICAgewo+IC0JR0VN
X0JVR19PTighUkJfRU1QVFlfUk9PVCgmcmVmLT50cmVlKSk7Cj4gICAJR0VNX0JVR19PTihhdG9t
aWNfcmVhZCgmcmVmLT5jb3VudCkpOwo+ICsJR0VNX0JVR19PTih3b3JrX3BlbmRpbmcoJnJlZi0+
d29yaykpOwo+ICsJR0VNX0JVR19PTighUkJfRU1QVFlfUk9PVCgmcmVmLT50cmVlKSk7Cj4gICAJ
bXV0ZXhfZGVzdHJveSgmcmVmLT5tdXRleCk7Cj4gICB9Cj4gICAjZW5kaWYKPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmVfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfYWN0aXZlX3R5cGVzLmgKPiBpbmRleCA1YjBhMzAyNGNlMjQuLmEzYTVl
YzNlNDE2MyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZV90
eXBlcy5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmVfdHlwZXMuaAo+
IEBAIC0xMiw2ICsxMiw5IEBACj4gICAjaW5jbHVkZSA8bGludXgvbXV0ZXguaD4KPiAgICNpbmNs
dWRlIDxsaW51eC9yYnRyZWUuaD4KPiAgICNpbmNsdWRlIDxsaW51eC9yY3VwZGF0ZS5oPgo+ICsj
aW5jbHVkZSA8bGludXgvd29ya3F1ZXVlLmg+Cj4gKwo+ICsjaW5jbHVkZSAiaTkxNV91dGlscy5o
Igo+ICAgCj4gICBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKPiAgIHN0cnVjdCBpOTE1X2FjdGl2
ZV9yZXF1ZXN0Owo+IEBAIC0yOCw2ICszMSwxMSBAQCBzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVz
dCB7Cj4gICAKPiAgIHN0cnVjdCBhY3RpdmVfbm9kZTsKPiAgIAo+ICsjZGVmaW5lIEk5MTVfQUNU
SVZFX01BWV9TTEVFUCBCSVQoMCkKPiArCj4gKyNkZWZpbmUgX19pOTE1X2FjdGl2ZV9jYWxsIF9f
YWxpZ25lZCg0KQo+ICsjZGVmaW5lIGk5MTVfYWN0aXZlX21heV9zbGVlcChmbikgcHRyX3BhY2tf
Yml0cygmKGZuKSwgSTkxNV9BQ1RJVkVfTUFZX1NMRUVQLCAyKQoKTmVhdCwKUmV2aWV3ZWQtYnk6
IE1hdHRoZXcgQXVsZCA8bWF0dGhldy5hdWxkQGludGVsLmNvbT4KX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRl
bC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
L21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 02BD12D4EAC
	for <lists+intel-gfx@lfdr.de>; Thu, 10 Dec 2020 00:21:35 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 83A836E0A5;
	Wed,  9 Dec 2020 23:21:30 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (unknown [77.68.26.236])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 341546E027
 for <intel-gfx@lists.freedesktop.org>; Wed,  9 Dec 2020 23:21:29 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from build.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 23273312-1500050 
 for <intel-gfx@lists.freedesktop.org>; Wed, 09 Dec 2020 23:21:24 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed,  9 Dec 2020 23:21:24 +0000
Message-Id: <20201209232124.15196-3-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20201209232124.15196-1-chris@chris-wilson.co.uk>
References: <20201209232124.15196-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [CI 3/3] drm/i915: split gen8+ flush and bb_start
 emission functions to their own file
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogRGFuaWVsZSBDZXJhb2xvIFNwdXJpbyA8ZGFuaWVsZS5jZXJhb2xvc3B1cmlvQGludGVs
LmNvbT4KClRoZXNlIGZ1bmN0aW9ucyBhcmUgaW5kZXBlbmRlbnQgZnJvbSB0aGUgYmFja2VuZCB1
c2VkIGFuZCBjYW4gdGhlcmVmb3JlCmJlIHNwbGl0IG91dCBvZiB0aGUgZXhlbGlzdHMgc3VibWlz
c2lvbiBmaWxlLCBzbyB0aGV5IGNhbiBiZSByZS11c2VkIGJ5CnRoZSB1cGNvbWluZyBHdUMgc3Vi
bWlzc2lvbiBiYWNrZW5kLgoKQmFzZWQgb24gYSBwYXRjaCBieSBDaHJpcyBXaWxzb24uCgpTaWdu
ZWQtb2ZmLWJ5OiBEYW5pZWxlIENlcmFvbG8gU3B1cmlvIDxkYW5pZWxlLmNlcmFvbG9zcHVyaW9A
aW50ZWwuY29tPgpDYzogQ2hyaXMgUCBXaWxzb24gPGNocmlzLnAud2lsc29uQGludGVsLmNvbT4K
Q2M6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBsaW51eC5pbnRlbC5jb20+ClJldmll
d2VkLWJ5OiBKb2huIEhhcnJpc29uIDxKb2huLkMuSGFycmlzb25ASW50ZWwuY29tPgotLS0KIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlICAgICAgICAgICAgICAgICB8ICAgMSArCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9nZW44X2VuZ2luZV9jcy5jICAgICAgfCAzOTAgKysrKysrKysr
KysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2dlbjhfZW5naW5lX2NzLmggICAgICB8
ICAyNyArKwogLi4uL2RybS9pOTE1L2d0L2ludGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uLmMgIHwg
Mzk1ICstLS0tLS0tLS0tLS0tLS0tLQogNCBmaWxlcyBjaGFuZ2VkLCA0MjQgaW5zZXJ0aW9ucygr
KSwgMzg5IGRlbGV0aW9ucygtKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2dlbjhfZW5naW5lX2NzLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9nZW44X2VuZ2luZV9jcy5oCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQppbmRleCBhZWRi
ZDhmNTJiZTguLmY5ZWY1MTk5YjEyNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
TWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUKQEAgLTgyLDYgKzgy
LDcgQEAgZ3QteSArPSBcCiAJZ3QvZ2VuNl9lbmdpbmVfY3MubyBcCiAJZ3QvZ2VuNl9wcGd0dC5v
IFwKIAlndC9nZW43X3JlbmRlcmNsZWFyLm8gXAorCWd0L2dlbjhfZW5naW5lX2NzLm8gXAogCWd0
L2dlbjhfcHBndHQubyBcCiAJZ3QvaW50ZWxfYnJlYWRjcnVtYnMubyBcCiAJZ3QvaW50ZWxfY29u
dGV4dC5vIFwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2dlbjhfZW5naW5l
X2NzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9nZW44X2VuZ2luZV9jcy5jCm5ldyBmaWxl
IG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uNmE5MmRhYTM5ZjQwCi0tLSAvZGV2L251
bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZ2VuOF9lbmdpbmVfY3MuYwpAQCAtMCww
ICsxLDM5MCBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAorLyoKKyAqIENvcHly
aWdodCDCqSAyMDE0IEludGVsIENvcnBvcmF0aW9uCisgKi8KKworI2luY2x1ZGUgImdlbjhfZW5n
aW5lX2NzLmgiIC8qIFhYWCAqLworI2luY2x1ZGUgImk5MTVfZHJ2LmgiCisjaW5jbHVkZSAiaW50
ZWxfZXhlY2xpc3RzX3N1Ym1pc3Npb24uaCIgLyogWFhYICovCisjaW5jbHVkZSAiaW50ZWxfZ3B1
X2NvbW1hbmRzLmgiCisjaW5jbHVkZSAiaW50ZWxfcmluZy5oIgorCitpbnQgZ2VuOF9lbWl0X2Zs
dXNoX3JjcyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgdTMyIG1vZGUpCit7CisJYm9vbCB2Zl9m
bHVzaF93YSA9IGZhbHNlLCBkY19mbHVzaF93YSA9IGZhbHNlOworCXUzMiAqY3MsIGZsYWdzID0g
MDsKKwlpbnQgbGVuOworCisJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0NTX1NUQUxMOworCisJaWYg
KG1vZGUgJiBFTUlUX0ZMVVNIKSB7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9SRU5ERVJfVEFS
R0VUX0NBQ0hFX0ZMVVNIOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfREVQVEhfQ0FDSEVfRkxV
U0g7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9EQ19GTFVTSF9FTkFCTEU7CisJCWZsYWdzIHw9
IFBJUEVfQ09OVFJPTF9GTFVTSF9FTkFCTEU7CisJfQorCisJaWYgKG1vZGUgJiBFTUlUX0lOVkFM
SURBVEUpIHsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1RMQl9JTlZBTElEQVRFOworCQlmbGFn
cyB8PSBQSVBFX0NPTlRST0xfSU5TVFJVQ1RJT05fQ0FDSEVfSU5WQUxJREFURTsKKwkJZmxhZ3Mg
fD0gUElQRV9DT05UUk9MX1RFWFRVUkVfQ0FDSEVfSU5WQUxJREFURTsKKwkJZmxhZ3MgfD0gUElQ
RV9DT05UUk9MX1ZGX0NBQ0hFX0lOVkFMSURBVEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9D
T05TVF9DQUNIRV9JTlZBTElEQVRFOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfU1RBVEVfQ0FD
SEVfSU5WQUxJREFURTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1FXX1dSSVRFOworCQlmbGFn
cyB8PSBQSVBFX0NPTlRST0xfU1RPUkVfREFUQV9JTkRFWDsKKworCQkvKgorCQkgKiBPbiBHRU45
OiBiZWZvcmUgVkZfQ0FDSEVfSU5WQUxJREFURSB3ZSBuZWVkIHRvIGVtaXQgYSBOVUxMCisJCSAq
IHBpcGUgY29udHJvbC4KKwkJICovCisJCWlmIChJU19HRU4ocnEtPmVuZ2luZS0+aTkxNSwgOSkp
CisJCQl2Zl9mbHVzaF93YSA9IHRydWU7CisKKwkJLyogV2FGb3JHQU1IYW5nOmtibCAqLworCQlp
ZiAoSVNfS0JMX0dUX1JFVklEKHJxLT5lbmdpbmUtPmk5MTUsIDAsIEtCTF9SRVZJRF9CMCkpCisJ
CQlkY19mbHVzaF93YSA9IHRydWU7CisJfQorCisJbGVuID0gNjsKKworCWlmICh2Zl9mbHVzaF93
YSkKKwkJbGVuICs9IDY7CisKKwlpZiAoZGNfZmx1c2hfd2EpCisJCWxlbiArPSAxMjsKKworCWNz
ID0gaW50ZWxfcmluZ19iZWdpbihycSwgbGVuKTsKKwlpZiAoSVNfRVJSKGNzKSkKKwkJcmV0dXJu
IFBUUl9FUlIoY3MpOworCisJaWYgKHZmX2ZsdXNoX3dhKQorCQljcyA9IGdlbjhfZW1pdF9waXBl
X2NvbnRyb2woY3MsIDAsIDApOworCisJaWYgKGRjX2ZsdXNoX3dhKQorCQljcyA9IGdlbjhfZW1p
dF9waXBlX2NvbnRyb2woY3MsIFBJUEVfQ09OVFJPTF9EQ19GTFVTSF9FTkFCTEUsCisJCQkJCSAg
ICAwKTsKKworCWNzID0gZ2VuOF9lbWl0X3BpcGVfY29udHJvbChjcywgZmxhZ3MsIExSQ19QUEhX
U1BfU0NSQVRDSF9BRERSKTsKKworCWlmIChkY19mbHVzaF93YSkKKwkJY3MgPSBnZW44X2VtaXRf
cGlwZV9jb250cm9sKGNzLCBQSVBFX0NPTlRST0xfQ1NfU1RBTEwsIDApOworCisJaW50ZWxfcmlu
Z19hZHZhbmNlKHJxLCBjcyk7CisKKwlyZXR1cm4gMDsKK30KKworaW50IGdlbjhfZW1pdF9mbHVz
aF94Y3Moc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsIHUzMiBtb2RlKQoreworCXUzMiBjbWQsICpj
czsKKworCWNzID0gaW50ZWxfcmluZ19iZWdpbihycSwgNCk7CisJaWYgKElTX0VSUihjcykpCisJ
CXJldHVybiBQVFJfRVJSKGNzKTsKKworCWNtZCA9IE1JX0ZMVVNIX0RXICsgMTsKKworCS8qIFdl
IGFsd2F5cyByZXF1aXJlIGEgY29tbWFuZCBiYXJyaWVyIHNvIHRoYXQgc3Vic2VxdWVudAorCSAq
IGNvbW1hbmRzLCBzdWNoIGFzIGJyZWFkY3J1bWIgaW50ZXJydXB0cywgYXJlIHN0cmljdGx5IG9y
ZGVyZWQKKwkgKiB3cnQgdGhlIGNvbnRlbnRzIG9mIHRoZSB3cml0ZSBjYWNoZSBiZWluZyBmbHVz
aGVkIHRvIG1lbW9yeQorCSAqIChhbmQgdGh1cyBiZWluZyBjb2hlcmVudCBmcm9tIHRoZSBDUFUp
LgorCSAqLworCWNtZCB8PSBNSV9GTFVTSF9EV19TVE9SRV9JTkRFWCB8IE1JX0ZMVVNIX0RXX09Q
X1NUT1JFRFc7CisKKwlpZiAobW9kZSAmIEVNSVRfSU5WQUxJREFURSkgeworCQljbWQgfD0gTUlf
SU5WQUxJREFURV9UTEI7CisJCWlmIChycS0+ZW5naW5lLT5jbGFzcyA9PSBWSURFT19ERUNPREVf
Q0xBU1MpCisJCQljbWQgfD0gTUlfSU5WQUxJREFURV9CU0Q7CisJfQorCisJKmNzKysgPSBjbWQ7
CisJKmNzKysgPSBMUkNfUFBIV1NQX1NDUkFUQ0hfQUREUjsKKwkqY3MrKyA9IDA7IC8qIHVwcGVy
IGFkZHIgKi8KKwkqY3MrKyA9IDA7IC8qIHZhbHVlICovCisJaW50ZWxfcmluZ19hZHZhbmNlKHJx
LCBjcyk7CisKKwlyZXR1cm4gMDsKK30KKworaW50IGdlbjExX2VtaXRfZmx1c2hfcmNzKHN0cnVj
dCBpOTE1X3JlcXVlc3QgKnJxLCB1MzIgbW9kZSkKK3sKKwlpZiAobW9kZSAmIEVNSVRfRkxVU0gp
IHsKKwkJdTMyICpjczsKKwkJdTMyIGZsYWdzID0gMDsKKworCQlmbGFncyB8PSBQSVBFX0NPTlRS
T0xfQ1NfU1RBTEw7CisKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1RJTEVfQ0FDSEVfRkxVU0g7
CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9SRU5ERVJfVEFSR0VUX0NBQ0hFX0ZMVVNIOworCQlm
bGFncyB8PSBQSVBFX0NPTlRST0xfREVQVEhfQ0FDSEVfRkxVU0g7CisJCWZsYWdzIHw9IFBJUEVf
Q09OVFJPTF9EQ19GTFVTSF9FTkFCTEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9GTFVTSF9F
TkFCTEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9RV19XUklURTsKKwkJZmxhZ3MgfD0gUElQ
RV9DT05UUk9MX1NUT1JFX0RBVEFfSU5ERVg7CisKKwkJY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJx
LCA2KTsKKwkJaWYgKElTX0VSUihjcykpCisJCQlyZXR1cm4gUFRSX0VSUihjcyk7CisKKwkJY3Mg
PSBnZW44X2VtaXRfcGlwZV9jb250cm9sKGNzLCBmbGFncywgTFJDX1BQSFdTUF9TQ1JBVENIX0FE
RFIpOworCQlpbnRlbF9yaW5nX2FkdmFuY2UocnEsIGNzKTsKKwl9CisKKwlpZiAobW9kZSAmIEVN
SVRfSU5WQUxJREFURSkgeworCQl1MzIgKmNzOworCQl1MzIgZmxhZ3MgPSAwOworCisJCWZsYWdz
IHw9IFBJUEVfQ09OVFJPTF9DU19TVEFMTDsKKworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfQ09N
TUFORF9DQUNIRV9JTlZBTElEQVRFOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfVExCX0lOVkFM
SURBVEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9JTlNUUlVDVElPTl9DQUNIRV9JTlZBTElE
QVRFOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfVEVYVFVSRV9DQUNIRV9JTlZBTElEQVRFOwor
CQlmbGFncyB8PSBQSVBFX0NPTlRST0xfVkZfQ0FDSEVfSU5WQUxJREFURTsKKwkJZmxhZ3MgfD0g
UElQRV9DT05UUk9MX0NPTlNUX0NBQ0hFX0lOVkFMSURBVEU7CisJCWZsYWdzIHw9IFBJUEVfQ09O
VFJPTF9TVEFURV9DQUNIRV9JTlZBTElEQVRFOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfUVdf
V1JJVEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9TVE9SRV9EQVRBX0lOREVYOworCisJCWNz
ID0gaW50ZWxfcmluZ19iZWdpbihycSwgNik7CisJCWlmIChJU19FUlIoY3MpKQorCQkJcmV0dXJu
IFBUUl9FUlIoY3MpOworCisJCWNzID0gZ2VuOF9lbWl0X3BpcGVfY29udHJvbChjcywgZmxhZ3Ms
IExSQ19QUEhXU1BfU0NSQVRDSF9BRERSKTsKKwkJaW50ZWxfcmluZ19hZHZhbmNlKHJxLCBjcyk7
CisJfQorCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB1MzIgcHJlcGFyc2VyX2Rpc2FibGUoYm9v
bCBzdGF0ZSkKK3sKKwlyZXR1cm4gTUlfQVJCX0NIRUNLIHwgMSA8PCA4IHwgc3RhdGU7Cit9CisK
K3N0YXRpYyBpOTE1X3JlZ190IGF1eF9pbnZfcmVnKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSkKK3sKKwlzdGF0aWMgY29uc3QgaTkxNV9yZWdfdCB2ZFtdID0geworCQlHRU4x
Ml9WRDBfQVVYX05WLAorCQlHRU4xMl9WRDFfQVVYX05WLAorCQlHRU4xMl9WRDJfQVVYX05WLAor
CQlHRU4xMl9WRDNfQVVYX05WLAorCX07CisKKwlzdGF0aWMgY29uc3QgaTkxNV9yZWdfdCB2ZVtd
ID0geworCQlHRU4xMl9WRTBfQVVYX05WLAorCQlHRU4xMl9WRTFfQVVYX05WLAorCX07CisKKwlp
ZiAoZW5naW5lLT5jbGFzcyA9PSBWSURFT19ERUNPREVfQ0xBU1MpCisJCXJldHVybiB2ZFtlbmdp
bmUtPmluc3RhbmNlXTsKKworCWlmIChlbmdpbmUtPmNsYXNzID09IFZJREVPX0VOSEFOQ0VNRU5U
X0NMQVNTKQorCQlyZXR1cm4gdmVbZW5naW5lLT5pbnN0YW5jZV07CisKKwlHRU1fQlVHX09OKCJ1
bmtub3duIGF1eF9pbnYgcmVnXG4iKTsKKwlyZXR1cm4gSU5WQUxJRF9NTUlPX1JFRzsKK30KKwor
c3RhdGljIHUzMiAqZ2VuMTJfZW1pdF9hdXhfdGFibGVfaW52KGNvbnN0IGk5MTVfcmVnX3QgaW52
X3JlZywgdTMyICpjcykKK3sKKwkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKDEpOworCSpj
cysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoaW52X3JlZyk7CisJKmNzKysgPSBBVVhfSU5WOwor
CSpjcysrID0gTUlfTk9PUDsKKworCXJldHVybiBjczsKK30KKworaW50IGdlbjEyX2VtaXRfZmx1
c2hfcmNzKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCB1MzIgbW9kZSkKK3sKKwlpZiAobW9kZSAm
IEVNSVRfRkxVU0gpIHsKKwkJdTMyIGZsYWdzID0gMDsKKwkJdTMyICpjczsKKworCQlmbGFncyB8
PSBQSVBFX0NPTlRST0xfVElMRV9DQUNIRV9GTFVTSDsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9M
X0ZMVVNIX0wzOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfUkVOREVSX1RBUkdFVF9DQUNIRV9G
TFVTSDsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0RFUFRIX0NBQ0hFX0ZMVVNIOworCQkvKiBX
YV8xNDA5NjAwOTA3OnRnbCAqLworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfREVQVEhfU1RBTEw7
CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9EQ19GTFVTSF9FTkFCTEU7CisJCWZsYWdzIHw9IFBJ
UEVfQ09OVFJPTF9GTFVTSF9FTkFCTEU7CisKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1NUT1JF
X0RBVEFfSU5ERVg7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9RV19XUklURTsKKworCQlmbGFn
cyB8PSBQSVBFX0NPTlRST0xfQ1NfU1RBTEw7CisKKwkJY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJx
LCA2KTsKKwkJaWYgKElTX0VSUihjcykpCisJCQlyZXR1cm4gUFRSX0VSUihjcyk7CisKKwkJY3Mg
PSBnZW4xMl9lbWl0X3BpcGVfY29udHJvbChjcywKKwkJCQkJICAgICBQSVBFX0NPTlRST0wwX0hE
Q19QSVBFTElORV9GTFVTSCwKKwkJCQkJICAgICBmbGFncywgTFJDX1BQSFdTUF9TQ1JBVENIX0FE
RFIpOworCQlpbnRlbF9yaW5nX2FkdmFuY2UocnEsIGNzKTsKKwl9CisKKwlpZiAobW9kZSAmIEVN
SVRfSU5WQUxJREFURSkgeworCQl1MzIgZmxhZ3MgPSAwOworCQl1MzIgKmNzOworCisJCWZsYWdz
IHw9IFBJUEVfQ09OVFJPTF9DT01NQU5EX0NBQ0hFX0lOVkFMSURBVEU7CisJCWZsYWdzIHw9IFBJ
UEVfQ09OVFJPTF9UTEJfSU5WQUxJREFURTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0lOU1RS
VUNUSU9OX0NBQ0hFX0lOVkFMSURBVEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9URVhUVVJF
X0NBQ0hFX0lOVkFMSURBVEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9WRl9DQUNIRV9JTlZB
TElEQVRFOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfQ09OU1RfQ0FDSEVfSU5WQUxJREFURTsK
KwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1NUQVRFX0NBQ0hFX0lOVkFMSURBVEU7CisKKwkJZmxh
Z3MgfD0gUElQRV9DT05UUk9MX1NUT1JFX0RBVEFfSU5ERVg7CisJCWZsYWdzIHw9IFBJUEVfQ09O
VFJPTF9RV19XUklURTsKKworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfQ1NfU1RBTEw7CisKKwkJ
Y3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJxLCA4ICsgNCk7CisJCWlmIChJU19FUlIoY3MpKQorCQkJ
cmV0dXJuIFBUUl9FUlIoY3MpOworCisJCS8qCisJCSAqIFByZXZlbnQgdGhlIHByZS1wYXJzZXIg
ZnJvbSBza2lwcGluZyBwYXN0IHRoZSBUTEIKKwkJICogaW52YWxpZGF0ZSBhbmQgbG9hZGluZyBh
IHN0YWxlIHBhZ2UgZm9yIHRoZSBiYXRjaAorCQkgKiBidWZmZXIgLyByZXF1ZXN0IHBheWxvYWQu
CisJCSAqLworCQkqY3MrKyA9IHByZXBhcnNlcl9kaXNhYmxlKHRydWUpOworCisJCWNzID0gZ2Vu
OF9lbWl0X3BpcGVfY29udHJvbChjcywgZmxhZ3MsIExSQ19QUEhXU1BfU0NSQVRDSF9BRERSKTsK
KworCQkvKiBoc2RlczogMTgwOTE3NTc5MCAqLworCQljcyA9IGdlbjEyX2VtaXRfYXV4X3RhYmxl
X2ludihHRU4xMl9HRlhfQ0NTX0FVWF9OViwgY3MpOworCisJCSpjcysrID0gcHJlcGFyc2VyX2Rp
c2FibGUoZmFsc2UpOworCQlpbnRlbF9yaW5nX2FkdmFuY2UocnEsIGNzKTsKKwl9CisKKwlyZXR1
cm4gMDsKK30KKworaW50IGdlbjEyX2VtaXRfZmx1c2hfeGNzKHN0cnVjdCBpOTE1X3JlcXVlc3Qg
KnJxLCB1MzIgbW9kZSkKK3sKKwlpbnRlbF9lbmdpbmVfbWFza190IGF1eF9pbnYgPSAwOworCXUz
MiBjbWQsICpjczsKKworCWNtZCA9IDQ7CisJaWYgKG1vZGUgJiBFTUlUX0lOVkFMSURBVEUpCisJ
CWNtZCArPSAyOworCWlmIChtb2RlICYgRU1JVF9JTlZBTElEQVRFKQorCQlhdXhfaW52ID0gcnEt
PmVuZ2luZS0+bWFzayAmIH5CSVQoQkNTMCk7CisJaWYgKGF1eF9pbnYpCisJCWNtZCArPSAyICog
aHdlaWdodDgoYXV4X2ludikgKyAyOworCisJY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJxLCBjbWQp
OworCWlmIChJU19FUlIoY3MpKQorCQlyZXR1cm4gUFRSX0VSUihjcyk7CisKKwlpZiAobW9kZSAm
IEVNSVRfSU5WQUxJREFURSkKKwkJKmNzKysgPSBwcmVwYXJzZXJfZGlzYWJsZSh0cnVlKTsKKwor
CWNtZCA9IE1JX0ZMVVNIX0RXICsgMTsKKworCS8qIFdlIGFsd2F5cyByZXF1aXJlIGEgY29tbWFu
ZCBiYXJyaWVyIHNvIHRoYXQgc3Vic2VxdWVudAorCSAqIGNvbW1hbmRzLCBzdWNoIGFzIGJyZWFk
Y3J1bWIgaW50ZXJydXB0cywgYXJlIHN0cmljdGx5IG9yZGVyZWQKKwkgKiB3cnQgdGhlIGNvbnRl
bnRzIG9mIHRoZSB3cml0ZSBjYWNoZSBiZWluZyBmbHVzaGVkIHRvIG1lbW9yeQorCSAqIChhbmQg
dGh1cyBiZWluZyBjb2hlcmVudCBmcm9tIHRoZSBDUFUpLgorCSAqLworCWNtZCB8PSBNSV9GTFVT
SF9EV19TVE9SRV9JTkRFWCB8IE1JX0ZMVVNIX0RXX09QX1NUT1JFRFc7CisKKwlpZiAobW9kZSAm
IEVNSVRfSU5WQUxJREFURSkgeworCQljbWQgfD0gTUlfSU5WQUxJREFURV9UTEI7CisJCWlmIChy
cS0+ZW5naW5lLT5jbGFzcyA9PSBWSURFT19ERUNPREVfQ0xBU1MpCisJCQljbWQgfD0gTUlfSU5W
QUxJREFURV9CU0Q7CisJfQorCisJKmNzKysgPSBjbWQ7CisJKmNzKysgPSBMUkNfUFBIV1NQX1ND
UkFUQ0hfQUREUjsKKwkqY3MrKyA9IDA7IC8qIHVwcGVyIGFkZHIgKi8KKwkqY3MrKyA9IDA7IC8q
IHZhbHVlICovCisKKwlpZiAoYXV4X2ludikgeyAvKiBoc2RlczogMTgwOTE3NTc5MCAqLworCQlz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CisJCXVuc2lnbmVkIGludCB0bXA7CisKKwkJ
KmNzKysgPSBNSV9MT0FEX1JFR0lTVEVSX0lNTShod2VpZ2h0OChhdXhfaW52KSk7CisJCWZvcl9l
YWNoX2VuZ2luZV9tYXNrZWQoZW5naW5lLCBycS0+ZW5naW5lLT5ndCwKKwkJCQkgICAgICAgYXV4
X2ludiwgdG1wKSB7CisJCQkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KGF1eF9pbnZfcmVn
KGVuZ2luZSkpOworCQkJKmNzKysgPSBBVVhfSU5WOworCQl9CisJCSpjcysrID0gTUlfTk9PUDsK
Kwl9CisKKwlpZiAobW9kZSAmIEVNSVRfSU5WQUxJREFURSkKKwkJKmNzKysgPSBwcmVwYXJzZXJf
ZGlzYWJsZShmYWxzZSk7CisKKwlpbnRlbF9yaW5nX2FkdmFuY2UocnEsIGNzKTsKKworCXJldHVy
biAwOworfQorCitpbnQgZ2VuOF9lbWl0X2JiX3N0YXJ0X25vYXJiKHN0cnVjdCBpOTE1X3JlcXVl
c3QgKnJxLAorCQkJICAgICB1NjQgb2Zmc2V0LCB1MzIgbGVuLAorCQkJICAgICBjb25zdCB1bnNp
Z25lZCBpbnQgZmxhZ3MpCit7CisJdTMyICpjczsKKworCWNzID0gaW50ZWxfcmluZ19iZWdpbihy
cSwgNCk7CisJaWYgKElTX0VSUihjcykpCisJCXJldHVybiBQVFJfRVJSKGNzKTsKKworCS8qCisJ
ICogV2FEaXNhYmxlQ3R4UmVzdG9yZUFyYml0cmF0aW9uOmJkdyxjaHYKKwkgKgorCSAqIFdlIGRv
bid0IG5lZWQgdG8gcGVyZm9ybSBNSV9BUkJfRU5BQkxFIGFzIG9mdGVuIGFzIHdlIGRvIChpbgor
CSAqIHBhcnRpY3VsYXIgYWxsIHRoZSBnZW4gdGhhdCBkbyBub3QgbmVlZCB0aGUgdy9hIGF0IGFs
bCEpLCBpZiB3ZQorCSAqIHRvb2sgY2FyZSB0byBtYWtlIHN1cmUgdGhhdCBvbiBldmVyeSBzd2l0
Y2ggaW50byB0aGlzIGNvbnRleHQKKwkgKiAoYm90aCBvcmRpbmFyeSBhbmQgZm9yIHByZWVtcHRp
b24pIHRoYXQgYXJiaXRyYXJ0aW9uIHdhcyBlbmFibGVkCisJICogd2Ugd291bGQgYmUgZmluZS4g
IEhvd2V2ZXIsIGZvciBnZW44IHRoZXJlIGlzIGFub3RoZXIgdy9hIHRoYXQKKwkgKiByZXF1aXJl
cyB1cyB0byBub3QgcHJlZW1wdCBpbnNpZGUgR1BHUFUgZXhlY3V0aW9uLCBzbyB3ZSBrZWVwCisJ
ICogYXJiaXRyYXRpb24gZGlzYWJsZWQgZm9yIGdlbjggYmF0Y2hlcy4gQXJiaXRyYXRpb24gd2ls
bCBiZQorCSAqIHJlLWVuYWJsZWQgYmVmb3JlIHdlIGNsb3NlIHRoZSByZXF1ZXN0CisJICogKGVu
Z2luZS0+ZW1pdF9maW5pX2JyZWFkY3J1bWIpLgorCSAqLworCSpjcysrID0gTUlfQVJCX09OX09G
RiB8IE1JX0FSQl9ESVNBQkxFOworCisJLyogRklYTUUoQkRXKyk6IEFkZHJlc3Mgc3BhY2UgYW5k
IHNlY3VyaXR5IHNlbGVjdG9ycy4gKi8KKwkqY3MrKyA9IE1JX0JBVENIX0JVRkZFUl9TVEFSVF9H
RU44IHwKKwkJKGZsYWdzICYgSTkxNV9ESVNQQVRDSF9TRUNVUkUgPyAwIDogQklUKDgpKTsKKwkq
Y3MrKyA9IGxvd2VyXzMyX2JpdHMob2Zmc2V0KTsKKwkqY3MrKyA9IHVwcGVyXzMyX2JpdHMob2Zm
c2V0KTsKKworCWludGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOworCisJcmV0dXJuIDA7Cit9CisK
K2ludCBnZW44X2VtaXRfYmJfc3RhcnQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCisJCSAgICAg
ICB1NjQgb2Zmc2V0LCB1MzIgbGVuLAorCQkgICAgICAgY29uc3QgdW5zaWduZWQgaW50IGZsYWdz
KQoreworCXUzMiAqY3M7CisKKwljcyA9IGludGVsX3JpbmdfYmVnaW4ocnEsIDYpOworCWlmIChJ
U19FUlIoY3MpKQorCQlyZXR1cm4gUFRSX0VSUihjcyk7CisKKwkqY3MrKyA9IE1JX0FSQl9PTl9P
RkYgfCBNSV9BUkJfRU5BQkxFOworCisJKmNzKysgPSBNSV9CQVRDSF9CVUZGRVJfU1RBUlRfR0VO
OCB8CisJCShmbGFncyAmIEk5MTVfRElTUEFUQ0hfU0VDVVJFID8gMCA6IEJJVCg4KSk7CisJKmNz
KysgPSBsb3dlcl8zMl9iaXRzKG9mZnNldCk7CisJKmNzKysgPSB1cHBlcl8zMl9iaXRzKG9mZnNl
dCk7CisKKwkqY3MrKyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJfRElTQUJMRTsKKwkqY3MrKyA9
IE1JX05PT1A7CisKKwlpbnRlbF9yaW5nX2FkdmFuY2UocnEsIGNzKTsKKworCXJldHVybiAwOwor
fQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZ2VuOF9lbmdpbmVfY3MuaCBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2dlbjhfZW5naW5lX2NzLmgKbmV3IGZpbGUgbW9kZSAx
MDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi45MjU5NjFjM2U2NDYKLS0tIC9kZXYvbnVsbAorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9nZW44X2VuZ2luZV9jcy5oCkBAIC0wLDAgKzEsMjcg
QEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBNSVQgKi8KKy8qCisgKiBDb3B5cmlnaHQg
wqkgMjAxNCBJbnRlbCBDb3Jwb3JhdGlvbgorICovCisKKyNpZm5kZWYgX19HRU44X0VOR0lORV9D
U19IX18KKyNkZWZpbmUgX19HRU44X0VOR0lORV9DU19IX18KKworI2luY2x1ZGUgPGxpbnV4L3R5
cGVzLmg+CisKK3N0cnVjdCBpOTE1X3JlcXVlc3Q7CisKK2ludCBnZW44X2VtaXRfZmx1c2hfcmNz
KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QsIHUzMiBtb2RlKTsKK2ludCBnZW4xMV9lbWl0
X2ZsdXNoX3JjcyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0LCB1MzIgbW9kZSk7CitpbnQg
Z2VuMTJfZW1pdF9mbHVzaF9yY3Moc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCwgdTMyIG1v
ZGUpOworCitpbnQgZ2VuOF9lbWl0X2ZsdXNoX3hjcyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1
ZXN0LCB1MzIgbW9kZSk7CitpbnQgZ2VuMTJfZW1pdF9mbHVzaF94Y3Moc3RydWN0IGk5MTVfcmVx
dWVzdCAqcmVxdWVzdCwgdTMyIG1vZGUpOworCitpbnQgZ2VuOF9lbWl0X2JiX3N0YXJ0X25vYXJi
KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAorCQkJICAgICB1NjQgb2Zmc2V0LCB1MzIgbGVuLAor
CQkJICAgICBjb25zdCB1bnNpZ25lZCBpbnQgZmxhZ3MpOworaW50IGdlbjhfZW1pdF9iYl9zdGFy
dChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKKwkJICAgICAgIHU2NCBvZmZzZXQsIHUzMiBsZW4s
CisJCSAgICAgICBjb25zdCB1bnNpZ25lZCBpbnQgZmxhZ3MpOworCisjZW5kaWYgLyogX19HRU44
X0VOR0lORV9DU19IX18gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9leGVjbGlzdHNfc3VibWlzc2lvbi5jCmluZGV4IGUxZDM1YWIxN2U2Zi4uOWQ3M2U5MDUyYzA1
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9leGVjbGlzdHNfc3Vi
bWlzc2lvbi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2V4ZWNsaXN0c19z
dWJtaXNzaW9uLmMKQEAgLTExMiw2ICsxMTIsNyBAQAogI2luY2x1ZGUgImk5MTVfcGVyZi5oIgog
I2luY2x1ZGUgImk5MTVfdHJhY2UuaCIKICNpbmNsdWRlICJpOTE1X3ZncHUuaCIKKyNpbmNsdWRl
ICJnZW44X2VuZ2luZV9jcy5oIgogI2luY2x1ZGUgImludGVsX2JyZWFkY3J1bWJzLmgiCiAjaW5j
bHVkZSAiaW50ZWxfY29udGV4dC5oIgogI2luY2x1ZGUgImludGVsX2VuZ2luZV9wbS5oIgpAQCAt
NDQ3NSw2NyArNDQ3Niw2IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19yZXNldF9maW5pc2goc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCQkgICAgIGF0b21pY19yZWFkKCZleGVjbGlz
dHMtPnRhc2tsZXQuY291bnQpKTsKIH0KIAotc3RhdGljIGludCBnZW44X2VtaXRfYmJfc3RhcnRf
bm9hcmIoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCi0JCQkJICAgIHU2NCBvZmZzZXQsIHUzMiBs
ZW4sCi0JCQkJICAgIGNvbnN0IHVuc2lnbmVkIGludCBmbGFncykKLXsKLQl1MzIgKmNzOwotCi0J
Y3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJxLCA0KTsKLQlpZiAoSVNfRVJSKGNzKSkKLQkJcmV0dXJu
IFBUUl9FUlIoY3MpOwotCi0JLyoKLQkgKiBXYURpc2FibGVDdHhSZXN0b3JlQXJiaXRyYXRpb246
YmR3LGNodgotCSAqCi0JICogV2UgZG9uJ3QgbmVlZCB0byBwZXJmb3JtIE1JX0FSQl9FTkFCTEUg
YXMgb2Z0ZW4gYXMgd2UgZG8gKGluCi0JICogcGFydGljdWxhciBhbGwgdGhlIGdlbiB0aGF0IGRv
IG5vdCBuZWVkIHRoZSB3L2EgYXQgYWxsISksIGlmIHdlCi0JICogdG9vayBjYXJlIHRvIG1ha2Ug
c3VyZSB0aGF0IG9uIGV2ZXJ5IHN3aXRjaCBpbnRvIHRoaXMgY29udGV4dAotCSAqIChib3RoIG9y
ZGluYXJ5IGFuZCBmb3IgcHJlZW1wdGlvbikgdGhhdCBhcmJpdHJhcnRpb24gd2FzIGVuYWJsZWQK
LQkgKiB3ZSB3b3VsZCBiZSBmaW5lLiAgSG93ZXZlciwgZm9yIGdlbjggdGhlcmUgaXMgYW5vdGhl
ciB3L2EgdGhhdAotCSAqIHJlcXVpcmVzIHVzIHRvIG5vdCBwcmVlbXB0IGluc2lkZSBHUEdQVSBl
eGVjdXRpb24sIHNvIHdlIGtlZXAKLQkgKiBhcmJpdHJhdGlvbiBkaXNhYmxlZCBmb3IgZ2VuOCBi
YXRjaGVzLiBBcmJpdHJhdGlvbiB3aWxsIGJlCi0JICogcmUtZW5hYmxlZCBiZWZvcmUgd2UgY2xv
c2UgdGhlIHJlcXVlc3QKLQkgKiAoZW5naW5lLT5lbWl0X2ZpbmlfYnJlYWRjcnVtYikuCi0JICov
Ci0JKmNzKysgPSBNSV9BUkJfT05fT0ZGIHwgTUlfQVJCX0RJU0FCTEU7Ci0KLQkvKiBGSVhNRShC
RFcrKTogQWRkcmVzcyBzcGFjZSBhbmQgc2VjdXJpdHkgc2VsZWN0b3JzLiAqLwotCSpjcysrID0g
TUlfQkFUQ0hfQlVGRkVSX1NUQVJUX0dFTjggfAotCQkoZmxhZ3MgJiBJOTE1X0RJU1BBVENIX1NF
Q1VSRSA/IDAgOiBCSVQoOCkpOwotCSpjcysrID0gbG93ZXJfMzJfYml0cyhvZmZzZXQpOwotCSpj
cysrID0gdXBwZXJfMzJfYml0cyhvZmZzZXQpOwotCi0JaW50ZWxfcmluZ19hZHZhbmNlKHJxLCBj
cyk7Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCBnZW44X2VtaXRfYmJfc3RhcnQoc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnEsCi0JCQkgICAgICB1NjQgb2Zmc2V0LCB1MzIgbGVuLAotCQkJ
ICAgICAgY29uc3QgdW5zaWduZWQgaW50IGZsYWdzKQotewotCXUzMiAqY3M7Ci0KLQljcyA9IGlu
dGVsX3JpbmdfYmVnaW4ocnEsIDYpOwotCWlmIChJU19FUlIoY3MpKQotCQlyZXR1cm4gUFRSX0VS
Uihjcyk7Ci0KLQkqY3MrKyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJfRU5BQkxFOwotCi0JKmNz
KysgPSBNSV9CQVRDSF9CVUZGRVJfU1RBUlRfR0VOOCB8Ci0JCShmbGFncyAmIEk5MTVfRElTUEFU
Q0hfU0VDVVJFID8gMCA6IEJJVCg4KSk7Ci0JKmNzKysgPSBsb3dlcl8zMl9iaXRzKG9mZnNldCk7
Ci0JKmNzKysgPSB1cHBlcl8zMl9iaXRzKG9mZnNldCk7Ci0KLQkqY3MrKyA9IE1JX0FSQl9PTl9P
RkYgfCBNSV9BUkJfRElTQUJMRTsKLQkqY3MrKyA9IE1JX05PT1A7Ci0KLQlpbnRlbF9yaW5nX2Fk
dmFuY2UocnEsIGNzKTsKLQotCXJldHVybiAwOwotfQotCiBzdGF0aWMgdm9pZCBnZW44X2xvZ2lj
YWxfcmluZ19lbmFibGVfaXJxKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsKIAlF
TkdJTkVfV1JJVEUoZW5naW5lLCBSSU5HX0lNUiwKQEAgLTQ1NDgsMzI5ICs0NDg4LDYgQEAgc3Rh
dGljIHZvaWQgZ2VuOF9sb2dpY2FsX3JpbmdfZGlzYWJsZV9pcnEoc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lKQogCUVOR0lORV9XUklURShlbmdpbmUsIFJJTkdfSU1SLCB+ZW5naW5lLT5p
cnFfa2VlcF9tYXNrKTsKIH0KIAotc3RhdGljIGludCBnZW44X2VtaXRfZmx1c2goc3RydWN0IGk5
MTVfcmVxdWVzdCAqcmVxdWVzdCwgdTMyIG1vZGUpCi17Ci0JdTMyIGNtZCwgKmNzOwotCi0JY3Mg
PSBpbnRlbF9yaW5nX2JlZ2luKHJlcXVlc3QsIDQpOwotCWlmIChJU19FUlIoY3MpKQotCQlyZXR1
cm4gUFRSX0VSUihjcyk7Ci0KLQljbWQgPSBNSV9GTFVTSF9EVyArIDE7Ci0KLQkvKiBXZSBhbHdh
eXMgcmVxdWlyZSBhIGNvbW1hbmQgYmFycmllciBzbyB0aGF0IHN1YnNlcXVlbnQKLQkgKiBjb21t
YW5kcywgc3VjaCBhcyBicmVhZGNydW1iIGludGVycnVwdHMsIGFyZSBzdHJpY3RseSBvcmRlcmVk
Ci0JICogd3J0IHRoZSBjb250ZW50cyBvZiB0aGUgd3JpdGUgY2FjaGUgYmVpbmcgZmx1c2hlZCB0
byBtZW1vcnkKLQkgKiAoYW5kIHRodXMgYmVpbmcgY29oZXJlbnQgZnJvbSB0aGUgQ1BVKS4KLQkg
Ki8KLQljbWQgfD0gTUlfRkxVU0hfRFdfU1RPUkVfSU5ERVggfCBNSV9GTFVTSF9EV19PUF9TVE9S
RURXOwotCi0JaWYgKG1vZGUgJiBFTUlUX0lOVkFMSURBVEUpIHsKLQkJY21kIHw9IE1JX0lOVkFM
SURBVEVfVExCOwotCQlpZiAocmVxdWVzdC0+ZW5naW5lLT5jbGFzcyA9PSBWSURFT19ERUNPREVf
Q0xBU1MpCi0JCQljbWQgfD0gTUlfSU5WQUxJREFURV9CU0Q7Ci0JfQotCi0JKmNzKysgPSBjbWQ7
Ci0JKmNzKysgPSBMUkNfUFBIV1NQX1NDUkFUQ0hfQUREUjsKLQkqY3MrKyA9IDA7IC8qIHVwcGVy
IGFkZHIgKi8KLQkqY3MrKyA9IDA7IC8qIHZhbHVlICovCi0JaW50ZWxfcmluZ19hZHZhbmNlKHJl
cXVlc3QsIGNzKTsKLQotCXJldHVybiAwOwotfQotCi1zdGF0aWMgaW50IGdlbjhfZW1pdF9mbHVz
aF9yZW5kZXIoc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCwKLQkJCQkgIHUzMiBtb2RlKQot
ewotCWJvb2wgdmZfZmx1c2hfd2EgPSBmYWxzZSwgZGNfZmx1c2hfd2EgPSBmYWxzZTsKLQl1MzIg
KmNzLCBmbGFncyA9IDA7Ci0JaW50IGxlbjsKLQotCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9DU19T
VEFMTDsKLQotCWlmIChtb2RlICYgRU1JVF9GTFVTSCkgewotCQlmbGFncyB8PSBQSVBFX0NPTlRS
T0xfUkVOREVSX1RBUkdFVF9DQUNIRV9GTFVTSDsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0RF
UFRIX0NBQ0hFX0ZMVVNIOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfRENfRkxVU0hfRU5BQkxF
OwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfRkxVU0hfRU5BQkxFOwotCX0KLQotCWlmIChtb2Rl
ICYgRU1JVF9JTlZBTElEQVRFKSB7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9UTEJfSU5WQUxJ
REFURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0lOU1RSVUNUSU9OX0NBQ0hFX0lOVkFMSURB
VEU7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9URVhUVVJFX0NBQ0hFX0lOVkFMSURBVEU7Ci0J
CWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9WRl9DQUNIRV9JTlZBTElEQVRFOwotCQlmbGFncyB8PSBQ
SVBFX0NPTlRST0xfQ09OU1RfQ0FDSEVfSU5WQUxJREFURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05U
Uk9MX1NUQVRFX0NBQ0hFX0lOVkFMSURBVEU7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9RV19X
UklURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1NUT1JFX0RBVEFfSU5ERVg7Ci0KLQkJLyoK
LQkJICogT24gR0VOOTogYmVmb3JlIFZGX0NBQ0hFX0lOVkFMSURBVEUgd2UgbmVlZCB0byBlbWl0
IGEgTlVMTAotCQkgKiBwaXBlIGNvbnRyb2wuCi0JCSAqLwotCQlpZiAoSVNfR0VOKHJlcXVlc3Qt
PmVuZ2luZS0+aTkxNSwgOSkpCi0JCQl2Zl9mbHVzaF93YSA9IHRydWU7Ci0KLQkJLyogV2FGb3JH
QU1IYW5nOmtibCAqLwotCQlpZiAoSVNfS0JMX0dUX1JFVklEKHJlcXVlc3QtPmVuZ2luZS0+aTkx
NSwgMCwgS0JMX1JFVklEX0IwKSkKLQkJCWRjX2ZsdXNoX3dhID0gdHJ1ZTsKLQl9Ci0KLQlsZW4g
PSA2OwotCi0JaWYgKHZmX2ZsdXNoX3dhKQotCQlsZW4gKz0gNjsKLQotCWlmIChkY19mbHVzaF93
YSkKLQkJbGVuICs9IDEyOwotCi0JY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJlcXVlc3QsIGxlbik7
Ci0JaWYgKElTX0VSUihjcykpCi0JCXJldHVybiBQVFJfRVJSKGNzKTsKLQotCWlmICh2Zl9mbHVz
aF93YSkKLQkJY3MgPSBnZW44X2VtaXRfcGlwZV9jb250cm9sKGNzLCAwLCAwKTsKLQotCWlmIChk
Y19mbHVzaF93YSkKLQkJY3MgPSBnZW44X2VtaXRfcGlwZV9jb250cm9sKGNzLCBQSVBFX0NPTlRS
T0xfRENfRkxVU0hfRU5BQkxFLAotCQkJCQkgICAgMCk7Ci0KLQljcyA9IGdlbjhfZW1pdF9waXBl
X2NvbnRyb2woY3MsIGZsYWdzLCBMUkNfUFBIV1NQX1NDUkFUQ0hfQUREUik7Ci0KLQlpZiAoZGNf
Zmx1c2hfd2EpCi0JCWNzID0gZ2VuOF9lbWl0X3BpcGVfY29udHJvbChjcywgUElQRV9DT05UUk9M
X0NTX1NUQUxMLCAwKTsKLQotCWludGVsX3JpbmdfYWR2YW5jZShyZXF1ZXN0LCBjcyk7Ci0KLQly
ZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCBnZW4xMV9lbWl0X2ZsdXNoX3JlbmRlcihzdHJ1Y3Qg
aTkxNV9yZXF1ZXN0ICpyZXF1ZXN0LAotCQkJCSAgIHUzMiBtb2RlKQotewotCWlmIChtb2RlICYg
RU1JVF9GTFVTSCkgewotCQl1MzIgKmNzOwotCQl1MzIgZmxhZ3MgPSAwOwotCi0JCWZsYWdzIHw9
IFBJUEVfQ09OVFJPTF9DU19TVEFMTDsKLQotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfVElMRV9D
QUNIRV9GTFVTSDsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1JFTkRFUl9UQVJHRVRfQ0FDSEVf
RkxVU0g7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9ERVBUSF9DQUNIRV9GTFVTSDsKLQkJZmxh
Z3MgfD0gUElQRV9DT05UUk9MX0RDX0ZMVVNIX0VOQUJMRTsKLQkJZmxhZ3MgfD0gUElQRV9DT05U
Uk9MX0ZMVVNIX0VOQUJMRTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1FXX1dSSVRFOwotCQlm
bGFncyB8PSBQSVBFX0NPTlRST0xfU1RPUkVfREFUQV9JTkRFWDsKLQotCQljcyA9IGludGVsX3Jp
bmdfYmVnaW4ocmVxdWVzdCwgNik7Ci0JCWlmIChJU19FUlIoY3MpKQotCQkJcmV0dXJuIFBUUl9F
UlIoY3MpOwotCi0JCWNzID0gZ2VuOF9lbWl0X3BpcGVfY29udHJvbChjcywgZmxhZ3MsIExSQ19Q
UEhXU1BfU0NSQVRDSF9BRERSKTsKLQkJaW50ZWxfcmluZ19hZHZhbmNlKHJlcXVlc3QsIGNzKTsK
LQl9Ci0KLQlpZiAobW9kZSAmIEVNSVRfSU5WQUxJREFURSkgewotCQl1MzIgKmNzOwotCQl1MzIg
ZmxhZ3MgPSAwOwotCi0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9DU19TVEFMTDsKLQotCQlmbGFn
cyB8PSBQSVBFX0NPTlRST0xfQ09NTUFORF9DQUNIRV9JTlZBTElEQVRFOwotCQlmbGFncyB8PSBQ
SVBFX0NPTlRST0xfVExCX0lOVkFMSURBVEU7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9JTlNU
UlVDVElPTl9DQUNIRV9JTlZBTElEQVRFOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfVEVYVFVS
RV9DQUNIRV9JTlZBTElEQVRFOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfVkZfQ0FDSEVfSU5W
QUxJREFURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0NPTlNUX0NBQ0hFX0lOVkFMSURBVEU7
Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9TVEFURV9DQUNIRV9JTlZBTElEQVRFOwotCQlmbGFn
cyB8PSBQSVBFX0NPTlRST0xfUVdfV1JJVEU7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9TVE9S
RV9EQVRBX0lOREVYOwotCi0JCWNzID0gaW50ZWxfcmluZ19iZWdpbihyZXF1ZXN0LCA2KTsKLQkJ
aWYgKElTX0VSUihjcykpCi0JCQlyZXR1cm4gUFRSX0VSUihjcyk7Ci0KLQkJY3MgPSBnZW44X2Vt
aXRfcGlwZV9jb250cm9sKGNzLCBmbGFncywgTFJDX1BQSFdTUF9TQ1JBVENIX0FERFIpOwotCQlp
bnRlbF9yaW5nX2FkdmFuY2UocmVxdWVzdCwgY3MpOwotCX0KLQotCXJldHVybiAwOwotfQotCi1z
dGF0aWMgdTMyIHByZXBhcnNlcl9kaXNhYmxlKGJvb2wgc3RhdGUpCi17Ci0JcmV0dXJuIE1JX0FS
Ql9DSEVDSyB8IDEgPDwgOCB8IHN0YXRlOwotfQotCi1zdGF0aWMgaTkxNV9yZWdfdCBhdXhfaW52
X3JlZyhjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCi17Ci0Jc3RhdGljIGNv
bnN0IGk5MTVfcmVnX3QgdmRbXSA9IHsKLQkJR0VOMTJfVkQwX0FVWF9OViwKLQkJR0VOMTJfVkQx
X0FVWF9OViwKLQkJR0VOMTJfVkQyX0FVWF9OViwKLQkJR0VOMTJfVkQzX0FVWF9OViwKLQl9Owot
Ci0Jc3RhdGljIGNvbnN0IGk5MTVfcmVnX3QgdmVbXSA9IHsKLQkJR0VOMTJfVkUwX0FVWF9OViwK
LQkJR0VOMTJfVkUxX0FVWF9OViwKLQl9OwotCi0JaWYgKGVuZ2luZS0+Y2xhc3MgPT0gVklERU9f
REVDT0RFX0NMQVNTKQotCQlyZXR1cm4gdmRbZW5naW5lLT5pbnN0YW5jZV07Ci0KLQlpZiAoZW5n
aW5lLT5jbGFzcyA9PSBWSURFT19FTkhBTkNFTUVOVF9DTEFTUykKLQkJcmV0dXJuIHZlW2VuZ2lu
ZS0+aW5zdGFuY2VdOwotCi0JR0VNX0JVR19PTigidW5rbm93biBhdXhfaW52X3JlZ1xuIik7Ci0K
LQlyZXR1cm4gSU5WQUxJRF9NTUlPX1JFRzsKLX0KLQotc3RhdGljIHUzMiAqCi1nZW4xMl9lbWl0
X2F1eF90YWJsZV9pbnYoY29uc3QgaTkxNV9yZWdfdCBpbnZfcmVnLCB1MzIgKmNzKQotewotCSpj
cysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oMSk7Ci0JKmNzKysgPSBpOTE1X21taW9fcmVnX29m
ZnNldChpbnZfcmVnKTsKLQkqY3MrKyA9IEFVWF9JTlY7Ci0JKmNzKysgPSBNSV9OT09QOwotCi0J
cmV0dXJuIGNzOwotfQotCi1zdGF0aWMgaW50IGdlbjEyX2VtaXRfZmx1c2hfcmVuZGVyKHN0cnVj
dCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QsCi0JCQkJICAgdTMyIG1vZGUpCi17Ci0JaWYgKG1vZGUg
JiBFTUlUX0ZMVVNIKSB7Ci0JCXUzMiBmbGFncyA9IDA7Ci0JCXUzMiAqY3M7Ci0KLQkJZmxhZ3Mg
fD0gUElQRV9DT05UUk9MX1RJTEVfQ0FDSEVfRkxVU0g7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJP
TF9GTFVTSF9MMzsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1JFTkRFUl9UQVJHRVRfQ0FDSEVf
RkxVU0g7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9ERVBUSF9DQUNIRV9GTFVTSDsKLQkJLyog
V2FfMTQwOTYwMDkwNzp0Z2wgKi8KLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0RFUFRIX1NUQUxM
OwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfRENfRkxVU0hfRU5BQkxFOwotCQlmbGFncyB8PSBQ
SVBFX0NPTlRST0xfRkxVU0hfRU5BQkxFOwotCi0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9TVE9S
RV9EQVRBX0lOREVYOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfUVdfV1JJVEU7Ci0KLQkJZmxh
Z3MgfD0gUElQRV9DT05UUk9MX0NTX1NUQUxMOwotCi0JCWNzID0gaW50ZWxfcmluZ19iZWdpbihy
ZXF1ZXN0LCA2KTsKLQkJaWYgKElTX0VSUihjcykpCi0JCQlyZXR1cm4gUFRSX0VSUihjcyk7Ci0K
LQkJY3MgPSBnZW4xMl9lbWl0X3BpcGVfY29udHJvbChjcywKLQkJCQkJICAgICBQSVBFX0NPTlRS
T0wwX0hEQ19QSVBFTElORV9GTFVTSCwKLQkJCQkJICAgICBmbGFncywgTFJDX1BQSFdTUF9TQ1JB
VENIX0FERFIpOwotCQlpbnRlbF9yaW5nX2FkdmFuY2UocmVxdWVzdCwgY3MpOwotCX0KLQotCWlm
IChtb2RlICYgRU1JVF9JTlZBTElEQVRFKSB7Ci0JCXUzMiBmbGFncyA9IDA7Ci0JCXUzMiAqY3M7
Ci0KLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0NPTU1BTkRfQ0FDSEVfSU5WQUxJREFURTsKLQkJ
ZmxhZ3MgfD0gUElQRV9DT05UUk9MX1RMQl9JTlZBTElEQVRFOwotCQlmbGFncyB8PSBQSVBFX0NP
TlRST0xfSU5TVFJVQ1RJT05fQ0FDSEVfSU5WQUxJREFURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05U
Uk9MX1RFWFRVUkVfQ0FDSEVfSU5WQUxJREFURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1ZG
X0NBQ0hFX0lOVkFMSURBVEU7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9DT05TVF9DQUNIRV9J
TlZBTElEQVRFOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfU1RBVEVfQ0FDSEVfSU5WQUxJREFU
RTsKLQotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfU1RPUkVfREFUQV9JTkRFWDsKLQkJZmxhZ3Mg
fD0gUElQRV9DT05UUk9MX1FXX1dSSVRFOwotCi0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9DU19T
VEFMTDsKLQotCQljcyA9IGludGVsX3JpbmdfYmVnaW4ocmVxdWVzdCwgOCArIDQpOwotCQlpZiAo
SVNfRVJSKGNzKSkKLQkJCXJldHVybiBQVFJfRVJSKGNzKTsKLQotCQkvKgotCQkgKiBQcmV2ZW50
IHRoZSBwcmUtcGFyc2VyIGZyb20gc2tpcHBpbmcgcGFzdCB0aGUgVExCCi0JCSAqIGludmFsaWRh
dGUgYW5kIGxvYWRpbmcgYSBzdGFsZSBwYWdlIGZvciB0aGUgYmF0Y2gKLQkJICogYnVmZmVyIC8g
cmVxdWVzdCBwYXlsb2FkLgotCQkgKi8KLQkJKmNzKysgPSBwcmVwYXJzZXJfZGlzYWJsZSh0cnVl
KTsKLQotCQljcyA9IGdlbjhfZW1pdF9waXBlX2NvbnRyb2woY3MsIGZsYWdzLCBMUkNfUFBIV1NQ
X1NDUkFUQ0hfQUREUik7Ci0KLQkJLyogaHNkZXM6IDE4MDkxNzU3OTAgKi8KLQkJY3MgPSBnZW4x
Ml9lbWl0X2F1eF90YWJsZV9pbnYoR0VOMTJfR0ZYX0NDU19BVVhfTlYsIGNzKTsKLQotCQkqY3Mr
KyA9IHByZXBhcnNlcl9kaXNhYmxlKGZhbHNlKTsKLQkJaW50ZWxfcmluZ19hZHZhbmNlKHJlcXVl
c3QsIGNzKTsKLQl9Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCBnZW4xMl9lbWl0X2Zs
dXNoKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QsIHUzMiBtb2RlKQotewotCWludGVsX2Vu
Z2luZV9tYXNrX3QgYXV4X2ludiA9IDA7Ci0JdTMyIGNtZCwgKmNzOwotCi0JY21kID0gNDsKLQlp
ZiAobW9kZSAmIEVNSVRfSU5WQUxJREFURSkKLQkJY21kICs9IDI7Ci0JaWYgKG1vZGUgJiBFTUlU
X0lOVkFMSURBVEUpCi0JCWF1eF9pbnYgPSByZXF1ZXN0LT5lbmdpbmUtPm1hc2sgJiB+QklUKEJD
UzApOwotCWlmIChhdXhfaW52KQotCQljbWQgKz0gMiAqIGh3ZWlnaHQ4KGF1eF9pbnYpICsgMjsK
LQotCWNzID0gaW50ZWxfcmluZ19iZWdpbihyZXF1ZXN0LCBjbWQpOwotCWlmIChJU19FUlIoY3Mp
KQotCQlyZXR1cm4gUFRSX0VSUihjcyk7Ci0KLQlpZiAobW9kZSAmIEVNSVRfSU5WQUxJREFURSkK
LQkJKmNzKysgPSBwcmVwYXJzZXJfZGlzYWJsZSh0cnVlKTsKLQotCWNtZCA9IE1JX0ZMVVNIX0RX
ICsgMTsKLQotCS8qIFdlIGFsd2F5cyByZXF1aXJlIGEgY29tbWFuZCBiYXJyaWVyIHNvIHRoYXQg
c3Vic2VxdWVudAotCSAqIGNvbW1hbmRzLCBzdWNoIGFzIGJyZWFkY3J1bWIgaW50ZXJydXB0cywg
YXJlIHN0cmljdGx5IG9yZGVyZWQKLQkgKiB3cnQgdGhlIGNvbnRlbnRzIG9mIHRoZSB3cml0ZSBj
YWNoZSBiZWluZyBmbHVzaGVkIHRvIG1lbW9yeQotCSAqIChhbmQgdGh1cyBiZWluZyBjb2hlcmVu
dCBmcm9tIHRoZSBDUFUpLgotCSAqLwotCWNtZCB8PSBNSV9GTFVTSF9EV19TVE9SRV9JTkRFWCB8
IE1JX0ZMVVNIX0RXX09QX1NUT1JFRFc7Ci0KLQlpZiAobW9kZSAmIEVNSVRfSU5WQUxJREFURSkg
ewotCQljbWQgfD0gTUlfSU5WQUxJREFURV9UTEI7Ci0JCWlmIChyZXF1ZXN0LT5lbmdpbmUtPmNs
YXNzID09IFZJREVPX0RFQ09ERV9DTEFTUykKLQkJCWNtZCB8PSBNSV9JTlZBTElEQVRFX0JTRDsK
LQl9Ci0KLQkqY3MrKyA9IGNtZDsKLQkqY3MrKyA9IExSQ19QUEhXU1BfU0NSQVRDSF9BRERSOwot
CSpjcysrID0gMDsgLyogdXBwZXIgYWRkciAqLwotCSpjcysrID0gMDsgLyogdmFsdWUgKi8KLQot
CWlmIChhdXhfaW52KSB7IC8qIGhzZGVzOiAxODA5MTc1NzkwICovCi0JCXN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZTsKLQkJdW5zaWduZWQgaW50IHRtcDsKLQotCQkqY3MrKyA9IE1JX0xP
QURfUkVHSVNURVJfSU1NKGh3ZWlnaHQ4KGF1eF9pbnYpKTsKLQkJZm9yX2VhY2hfZW5naW5lX21h
c2tlZChlbmdpbmUsIHJlcXVlc3QtPmVuZ2luZS0+Z3QsCi0JCQkJICAgICAgIGF1eF9pbnYsIHRt
cCkgewotCQkJKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChhdXhfaW52X3JlZyhlbmdpbmUp
KTsKLQkJCSpjcysrID0gQVVYX0lOVjsKLQkJfQotCQkqY3MrKyA9IE1JX05PT1A7Ci0JfQotCi0J
aWYgKG1vZGUgJiBFTUlUX0lOVkFMSURBVEUpCi0JCSpjcysrID0gcHJlcGFyc2VyX2Rpc2FibGUo
ZmFsc2UpOwotCi0JaW50ZWxfcmluZ19hZHZhbmNlKHJlcXVlc3QsIGNzKTsKLQotCXJldHVybiAw
OwotfQogCiBzdGF0aWMgdm9pZCBhc3NlcnRfcmVxdWVzdF92YWxpZChzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpycSkKIHsKQEAgLTUxMTMsMTIgKzQ3MzAsMTIgQEAgbG9naWNhbF9yaW5nX2RlZmF1bHRf
dmZ1bmNzKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAllbmdpbmUtPmNvcHMgPSAm
ZXhlY2xpc3RzX2NvbnRleHRfb3BzOwogCWVuZ2luZS0+cmVxdWVzdF9hbGxvYyA9IGV4ZWNsaXN0
c19yZXF1ZXN0X2FsbG9jOwogCi0JZW5naW5lLT5lbWl0X2ZsdXNoID0gZ2VuOF9lbWl0X2ZsdXNo
OworCWVuZ2luZS0+ZW1pdF9mbHVzaCA9IGdlbjhfZW1pdF9mbHVzaF94Y3M7CiAJZW5naW5lLT5l
bWl0X2luaXRfYnJlYWRjcnVtYiA9IGdlbjhfZW1pdF9pbml0X2JyZWFkY3J1bWI7CiAJZW5naW5l
LT5lbWl0X2ZpbmlfYnJlYWRjcnVtYiA9IGdlbjhfZW1pdF9maW5pX2JyZWFkY3J1bWI7CiAJaWYg
KElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDEyKSB7CiAJCWVuZ2luZS0+ZW1pdF9maW5pX2Jy
ZWFkY3J1bWIgPSBnZW4xMl9lbWl0X2ZpbmlfYnJlYWRjcnVtYjsKLQkJZW5naW5lLT5lbWl0X2Zs
dXNoID0gZ2VuMTJfZW1pdF9mbHVzaDsKKwkJZW5naW5lLT5lbWl0X2ZsdXNoID0gZ2VuMTJfZW1p
dF9mbHVzaF94Y3M7CiAJfQogCWVuZ2luZS0+c2V0X2RlZmF1bHRfc3VibWlzc2lvbiA9IGludGVs
X2V4ZWNsaXN0c19zZXRfZGVmYXVsdF9zdWJtaXNzaW9uOwogCkBAIC01MTYyLDE1ICs0Nzc5LDE1
IEBAIHN0YXRpYyB2b2lkIHJjc19zdWJtaXNzaW9uX292ZXJyaWRlKHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSkKIHsKIAlzd2l0Y2ggKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpKSB7CiAJ
Y2FzZSAxMjoKLQkJZW5naW5lLT5lbWl0X2ZsdXNoID0gZ2VuMTJfZW1pdF9mbHVzaF9yZW5kZXI7
CisJCWVuZ2luZS0+ZW1pdF9mbHVzaCA9IGdlbjEyX2VtaXRfZmx1c2hfcmNzOwogCQllbmdpbmUt
PmVtaXRfZmluaV9icmVhZGNydW1iID0gZ2VuMTJfZW1pdF9maW5pX2JyZWFkY3J1bWJfcmNzOwog
CQlicmVhazsKIAljYXNlIDExOgotCQllbmdpbmUtPmVtaXRfZmx1c2ggPSBnZW4xMV9lbWl0X2Zs
dXNoX3JlbmRlcjsKKwkJZW5naW5lLT5lbWl0X2ZsdXNoID0gZ2VuMTFfZW1pdF9mbHVzaF9yY3M7
CiAJCWVuZ2luZS0+ZW1pdF9maW5pX2JyZWFkY3J1bWIgPSBnZW4xMV9lbWl0X2ZpbmlfYnJlYWRj
cnVtYl9yY3M7CiAJCWJyZWFrOwogCWRlZmF1bHQ6Ci0JCWVuZ2luZS0+ZW1pdF9mbHVzaCA9IGdl
bjhfZW1pdF9mbHVzaF9yZW5kZXI7CisJCWVuZ2luZS0+ZW1pdF9mbHVzaCA9IGdlbjhfZW1pdF9m
bHVzaF9yY3M7CiAJCWVuZ2luZS0+ZW1pdF9maW5pX2JyZWFkY3J1bWIgPSBnZW44X2VtaXRfZmlu
aV9icmVhZGNydW1iX3JjczsKIAkJYnJlYWs7CiAJfQotLSAKMi4yMC4xCgpfX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0
CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3Rv
cC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZngK

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id EFC2C63347
	for <lists+intel-gfx@lfdr.de>; Tue,  9 Jul 2019 11:08:21 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2728989F6F;
	Tue,  9 Jul 2019 09:08:20 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga07.intel.com (mga07.intel.com [134.134.136.100])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A2F8989F6F
 for <intel-gfx@lists.freedesktop.org>; Tue,  9 Jul 2019 09:08:18 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga007.fm.intel.com ([10.253.24.52])
 by orsmga105.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 09 Jul 2019 02:08:17 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,470,1557212400"; 
 d="scan'208,223";a="167362651"
Received: from ramaling-i9x.iind.intel.com ([10.99.66.154])
 by fmsmga007.fm.intel.com with ESMTP; 09 Jul 2019 02:08:15 -0700
From: Ramalingam C <ramalingam.c@intel.com>
To: Sharma Shashank <shashank.sharma@intel.com>,
 intel-gfx <intel-gfx@lists.freedesktop.org>,
 Daniel Vetter <daniel@ffwll.ch>
Date: Tue,  9 Jul 2019 07:39:27 +0530
Message-Id: <20190709020927.15121-1-ramalingam.c@intel.com>
X-Mailer: git-send-email 2.19.1
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v5] drm/i915: Enable HDCP 1.4 and 2.2 on Gen12+
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbSBHZW4xMiBvbndhcmRzLCBIRENQIEhXIGJsb2NrIGlzIGltcGxlbWVudGVkIHdpdGhpbiB0
cmFuc2NvZGVycy4KVGlsbCBHZW4xMSBIRENQIEhXIGJsb2NrIHdhcyBwYXJ0IG9mIERESS4KCkhl
bmNlIHJlcXVpcmVkIGNoYW5nZXMgaW4gSFcgcHJvZ3JhbW1pbmcgaXMgaGFuZGxlZCBoZXJlLgoK
djI6CiAgX01NSU9fVFJBTlMgaXMgdXNlZCBbTHVjYXMgYW5kIERhbmllbF0KICBwbGF0Zm9ybSBj
aGVjayBpcyBtb3ZlZCBpbnRvIHRoZSBjYWxsZXIgW0x1Y2FzXQp2MzoKICBwbGF0Zm9ybSBjaGVj
ayBpcyBtb3ZlZCBpbnRvIGEgbWFjcm8gW1NoYXNoYW5rXQp2NDoKICBGZXcgb3B0aW1pemF0aW9u
cyBpbiB0aGUgY29kaW5nIFtTaGFzaGFua10KdjU6CiAgRml4ZWQgYWxpZ25tZW50IGluIG1hY3Jv
IGRlZmluaXRpb24gaW4gaTkxNV9yZWcuaCBbU2hhc2hhbmtdCiAgdW51c2VkIHZhcmlhYmxlcyAi
cmVnIiBpcyByZW1vdmVkLgoKU2lnbmVkLW9mZi1ieTogUmFtYWxpbmdhbSBDIDxyYW1hbGluZ2Ft
LmNAaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfaGRj
cC5jIHwgMTMzICsrKysrKysrKysrKystLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfaGRtaS5jIHwgICA5ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3Jl
Zy5oICAgICAgICAgICB8IDEyMCArKysrKysrKysrKysrKysrKy0tCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9kcnYuaCAgICAgICAgICB8ICAgOCArKwogNCBmaWxlcyBjaGFuZ2VkLCAyMDcg
aW5zZXJ0aW9ucygrKSwgNjMgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9oZGNwLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2hkY3AuYwppbmRleCBiYzNhOTRkNDkxYzQuLjIzZGMzYWQ0YmE0YyAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9oZGNwLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9oZGNwLmMKQEAgLTE3LDYgKzE3LDcgQEAK
ICNpbmNsdWRlICJpbnRlbF9kcnYuaCIKICNpbmNsdWRlICJpbnRlbF9oZGNwLmgiCiAjaW5jbHVk
ZSAiaW50ZWxfc2lkZWJhbmQuaCIKKyNpbmNsdWRlICJpbnRlbF9jb25uZWN0b3IuaCIKIAogI2Rl
ZmluZSBLRVlfTE9BRF9UUklFUwk1CiAjZGVmaW5lIEVOQ1JZUFRfU1RBVFVTX0NIQU5HRV9USU1F
T1VUX01TCTUwCkBAIC0xMDQsMjQgKzEwNSwxNyBAQCBib29sIGludGVsX2hkY3AyX2NhcGFibGUo
c3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQogCXJldHVybiBjYXBhYmxlOwogfQog
Ci1zdGF0aWMgaW5saW5lIGJvb2wgaW50ZWxfaGRjcF9pbl91c2Uoc3RydWN0IGludGVsX2Nvbm5l
Y3RvciAqY29ubmVjdG9yKQorc3RhdGljIGlubGluZSBib29sIGludGVsX2hkY3BfaW5fdXNlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKKwkJCQkgICAgIGVudW0gcGlwZSBwaXBl
LCBlbnVtIHBvcnQgcG9ydCkKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwotCWVudW0gcG9ydCBwb3J0ID0gY29ubmVj
dG9yLT5lbmNvZGVyLT5wb3J0OwotCXUzMiByZWc7Ci0KLQlyZWcgPSBJOTE1X1JFQUQoUE9SVF9I
RENQX1NUQVRVUyhwb3J0KSk7Ci0JcmV0dXJuIHJlZyAmIEhEQ1BfU1RBVFVTX0VOQzsKKwlyZXR1
cm4gSTkxNV9SRUFEKEhEQ1BfU1RBVFVTKGRldl9wcml2LCBwaXBlLCBwb3J0KSkgJiBIRENQX1NU
QVRVU19FTkM7CiB9CiAKLXN0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF9oZGNwMl9pbl91c2Uoc3Ry
dWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQorc3RhdGljIGlubGluZSBib29sIGludGVs
X2hkY3AyX2luX3VzZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkJICAg
ICAgZW51bSBwaXBlIHBpcGUsIGVudW0gcG9ydCBwb3J0KQogewotCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Ci0JZW51bSBw
b3J0IHBvcnQgPSBjb25uZWN0b3ItPmVuY29kZXItPnBvcnQ7Ci0JdTMyIHJlZzsKLQotCXJlZyA9
IEk5MTVfUkVBRChIRENQMl9TVEFUVVNfRERJKHBvcnQpKTsKLQlyZXR1cm4gcmVnICYgTElOS19F
TkNSWVBUSU9OX1NUQVRVUzsKKwlyZXR1cm4gSTkxNV9SRUFEKEhEQ1AyX1NUQVRVUyhkZXZfcHJp
diwgcGlwZSwgcG9ydCkpICYKKwkgICAgICAgTElOS19FTkNSWVBUSU9OX1NUQVRVUzsKIH0KIAog
c3RhdGljIGludCBpbnRlbF9oZGNwX3BvbGxfa3N2X2ZpZm8oc3RydWN0IGludGVsX2RpZ2l0YWxf
cG9ydCAqaW50ZWxfZGlnX3BvcnQsCkBAIC0yNTMsOSArMjQ3LDI4IEBAIHN0YXRpYyBpbnQgaW50
ZWxfd3JpdGVfc2hhX3RleHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIg
c2hhX3RleHQpCiB9CiAKIHN0YXRpYwotdTMyIGludGVsX2hkY3BfZ2V0X3JlcGVhdGVyX2N0bChz
dHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCkKK3UzMiBpbnRlbF9oZGNw
X2dldF9yZXBlYXRlcl9jdGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJ
CWVudW0gcGlwZSBwaXBlLCBlbnVtIHBvcnQgcG9ydCkKIHsKLQllbnVtIHBvcnQgcG9ydCA9IGlu
dGVsX2RpZ19wb3J0LT5iYXNlLnBvcnQ7CisJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTIp
IHsKKwkJc3dpdGNoIChwaXBlKSB7CisJCWNhc2UgUElQRV9BOgorCQkJcmV0dXJuIEhEQ1BfVFJB
TlNBX1JFUF9QUkVTRU5UIHwKKwkJCSAgICAgICBIRENQX1RSQU5TQV9TSEExX00wOworCQljYXNl
IFBJUEVfQjoKKwkJCXJldHVybiBIRENQX1RSQU5TQl9SRVBfUFJFU0VOVCB8CisJCQkgICAgICAg
SERDUF9UUkFOU0JfU0hBMV9NMDsKKwkJY2FzZSBQSVBFX0M6CisJCQlyZXR1cm4gSERDUF9UUkFO
U0NfUkVQX1BSRVNFTlQgfAorCQkJICAgICAgIEhEQ1BfVFJBTlNDX1NIQTFfTTA7CisJCS8qIEZJ
WE1FOiBBZGQgYSBjYXNlIGZvciBQSVBFX0QgKi8KKwkJZGVmYXVsdDoKKwkJCURSTV9FUlJPUigi
VW5rbm93biBwaXBlICVkXG4iLCBwaXBlKTsKKwkJCWJyZWFrOworCQl9CisJCXJldHVybiAtRUlO
VkFMOworCX0KKwogCXN3aXRjaCAocG9ydCkgewogCWNhc2UgUE9SVF9BOgogCQlyZXR1cm4gSERD
UF9ERElBX1JFUF9QUkVTRU5UIHwgSERDUF9ERElBX1NIQTFfTTA7CkBAIC0yNjgsMTggKzI4MSwy
MSBAQCB1MzIgaW50ZWxfaGRjcF9nZXRfcmVwZWF0ZXJfY3RsKHN0cnVjdCBpbnRlbF9kaWdpdGFs
X3BvcnQgKmludGVsX2RpZ19wb3J0KQogCWNhc2UgUE9SVF9FOgogCQlyZXR1cm4gSERDUF9ERElF
X1JFUF9QUkVTRU5UIHwgSERDUF9ERElFX1NIQTFfTTA7CiAJZGVmYXVsdDoKKwkJRFJNX0VSUk9S
KCJVbmtub3duIHBvcnQgJWRcbiIsIHBvcnQpOwogCQlicmVhazsKIAl9Ci0JRFJNX0VSUk9SKCJV
bmtub3duIHBvcnQgJWRcbiIsIHBvcnQpOwogCXJldHVybiAtRUlOVkFMOwogfQogCiBzdGF0aWMK
LWludCBpbnRlbF9oZGNwX3ZhbGlkYXRlX3ZfcHJpbWUoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9y
dCAqaW50ZWxfZGlnX3BvcnQsCitpbnQgaW50ZWxfaGRjcF92YWxpZGF0ZV92X3ByaW1lKHN0cnVj
dCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwKIAkJCQljb25zdCBzdHJ1Y3QgaW50ZWxfaGRj
cF9zaGltICpzaGltLAogCQkJCXU4ICprc3ZfZmlmbywgdTggbnVtX2Rvd25zdHJlYW0sIHU4ICpi
c3RhdHVzKQogeworCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0ID0g
Y29ubl90b19kaWdfcG9ydChjb25uZWN0b3IpOwogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdjsKKwllbnVtIHBpcGUgcGlwZSA9IGNvbm5lY3Rvci0+aGRjcC5waXBlOworCWVudW0g
cG9ydCBwb3J0ID0gaW50ZWxfZGlnX3BvcnQtPmJhc2UucG9ydDsKIAl1MzIgdnByaW1lLCBzaGFf
dGV4dCwgc2hhX2xlZnRvdmVycywgcmVwX2N0bDsKIAlpbnQgcmV0LCBpLCBqLCBzaGFfaWR4Owog
CkBAIC0zMDYsNyArMzIyLDcgQEAgaW50IGludGVsX2hkY3BfdmFsaWRhdGVfdl9wcmltZShzdHJ1
Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCwKIAlzaGFfaWR4ID0gMDsKIAlz
aGFfdGV4dCA9IDA7CiAJc2hhX2xlZnRvdmVycyA9IDA7Ci0JcmVwX2N0bCA9IGludGVsX2hkY3Bf
Z2V0X3JlcGVhdGVyX2N0bChpbnRlbF9kaWdfcG9ydCk7CisJcmVwX2N0bCA9IGludGVsX2hkY3Bf
Z2V0X3JlcGVhdGVyX2N0bChkZXZfcHJpdiwgcGlwZSwgcG9ydCk7CiAJSTkxNV9XUklURShIRENQ
X1JFUF9DVEwsIHJlcF9jdGwgfCBIRENQX1NIQTFfVEVYVF8zMik7CiAJZm9yIChpID0gMDsgaSA8
IG51bV9kb3duc3RyZWFtOyBpKyspIHsKIAkJdW5zaWduZWQgaW50IHNoYV9lbXB0eTsKQEAgLTU0
NCw3ICs1NjAsNyBAQCBpbnQgaW50ZWxfaGRjcF9hdXRoX2Rvd25zdHJlYW0oc3RydWN0IGludGVs
X2Nvbm5lY3RvciAqY29ubmVjdG9yKQogCSAqIFYgcHJpbWUgYXRsZWFzdCB0d2ljZS4KIAkgKi8K
IAlmb3IgKGkgPSAwOyBpIDwgdHJpZXM7IGkrKykgewotCQlyZXQgPSBpbnRlbF9oZGNwX3ZhbGlk
YXRlX3ZfcHJpbWUoaW50ZWxfZGlnX3BvcnQsIHNoaW0sCisJCXJldCA9IGludGVsX2hkY3BfdmFs
aWRhdGVfdl9wcmltZShjb25uZWN0b3IsIHNoaW0sCiAJCQkJCQkgIGtzdl9maWZvLCBudW1fZG93
bnN0cmVhbSwKIAkJCQkJCSAgYnN0YXR1cyk7CiAJCWlmICghcmV0KQpAQCAtNTcyLDYgKzU4OCw3
IEBAIHN0YXRpYyBpbnQgaW50ZWxfaGRjcF9hdXRoKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNv
bm5lY3RvcikKIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY29ubmVjdG9yLT5iYXNlLmRldjsK
IAljb25zdCBzdHJ1Y3QgaW50ZWxfaGRjcF9zaGltICpzaGltID0gaGRjcC0+c2hpbTsKIAlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXY7CisJZW51bSBwaXBlIHBpcGUgPSBjb25uZWN0
b3ItPmhkY3AucGlwZTsKIAllbnVtIHBvcnQgcG9ydDsKIAl1bnNpZ25lZCBsb25nIHIwX3ByaW1l
X2dlbl9zdGFydDsKIAlpbnQgcmV0LCBpLCB0cmllcyA9IDI7CkBAIC02MTEsMTkgKzYyOCwyMCBA
QCBzdGF0aWMgaW50IGludGVsX2hkY3BfYXV0aChzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25u
ZWN0b3IpCiAKIAkvKiBJbml0aWFsaXplIEFuIHdpdGggMiByYW5kb20gdmFsdWVzIGFuZCBhY3F1
aXJlIGl0ICovCiAJZm9yIChpID0gMDsgaSA8IDI7IGkrKykKLQkJSTkxNV9XUklURShQT1JUX0hE
Q1BfQU5JTklUKHBvcnQpLCBnZXRfcmFuZG9tX3UzMigpKTsKLQlJOTE1X1dSSVRFKFBPUlRfSERD
UF9DT05GKHBvcnQpLCBIRENQX0NPTkZfQ0FQVFVSRV9BTik7CisJCUk5MTVfV1JJVEUoSERDUF9B
TklOSVQoZGV2X3ByaXYsIHBpcGUsIHBvcnQpLCBnZXRfcmFuZG9tX3UzMigpKTsKKwlJOTE1X1dS
SVRFKEhEQ1BfQ09ORihkZXZfcHJpdiwgcGlwZSwgcG9ydCksIEhEQ1BfQ09ORl9DQVBUVVJFX0FO
KTsKIAogCS8qIFdhaXQgZm9yIEFuIHRvIGJlIGFjcXVpcmVkICovCi0JaWYgKGludGVsX3dhaXRf
Zm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLCBQT1JUX0hEQ1BfU1RBVFVTKHBvcnQpLAor
CWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwKKwkJCQkgICAg
SERDUF9TVEFUVVMoZGV2X3ByaXYsIHBpcGUsIHBvcnQpLAogCQkJCSAgICBIRENQX1NUQVRVU19B
Tl9SRUFEWSwKIAkJCQkgICAgSERDUF9TVEFUVVNfQU5fUkVBRFksIDEpKSB7CiAJCURSTV9FUlJP
UigiVGltZWQgb3V0IHdhaXRpbmcgZm9yIEFuXG4iKTsKIAkJcmV0dXJuIC1FVElNRURPVVQ7CiAJ
fQogCi0JYW4ucmVnWzBdID0gSTkxNV9SRUFEKFBPUlRfSERDUF9BTkxPKHBvcnQpKTsKLQlhbi5y
ZWdbMV0gPSBJOTE1X1JFQUQoUE9SVF9IRENQX0FOSEkocG9ydCkpOworCWFuLnJlZ1swXSA9IEk5
MTVfUkVBRChIRENQX0FOTE8oZGV2X3ByaXYsIHBpcGUsIHBvcnQpKTsKKwlhbi5yZWdbMV0gPSBJ
OTE1X1JFQUQoSERDUF9BTkhJKGRldl9wcml2LCBwaXBlLCBwb3J0KSk7CiAJcmV0ID0gc2hpbS0+
d3JpdGVfYW5fYWtzdihpbnRlbF9kaWdfcG9ydCwgYW4uc2hpbSk7CiAJaWYgKHJldCkKIAkJcmV0
dXJuIHJldDsKQEAgLTY0MSwyNCArNjU5LDI0IEBAIHN0YXRpYyBpbnQgaW50ZWxfaGRjcF9hdXRo
KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKIAkJcmV0dXJuIC1FUEVSTTsKIAl9
CiAKLQlJOTE1X1dSSVRFKFBPUlRfSERDUF9CS1NWTE8ocG9ydCksIGJrc3YucmVnWzBdKTsKLQlJ
OTE1X1dSSVRFKFBPUlRfSERDUF9CS1NWSEkocG9ydCksIGJrc3YucmVnWzFdKTsKKwlJOTE1X1dS
SVRFKEhEQ1BfQktTVkxPKGRldl9wcml2LCBwaXBlLCBwb3J0KSwgYmtzdi5yZWdbMF0pOworCUk5
MTVfV1JJVEUoSERDUF9CS1NWSEkoZGV2X3ByaXYsIHBpcGUsIHBvcnQpLCBia3N2LnJlZ1sxXSk7
CiAKIAlyZXQgPSBzaGltLT5yZXBlYXRlcl9wcmVzZW50KGludGVsX2RpZ19wb3J0LCAmcmVwZWF0
ZXJfcHJlc2VudCk7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIAlpZiAocmVwZWF0ZXJfcHJl
c2VudCkKIAkJSTkxNV9XUklURShIRENQX1JFUF9DVEwsCi0JCQkgICBpbnRlbF9oZGNwX2dldF9y
ZXBlYXRlcl9jdGwoaW50ZWxfZGlnX3BvcnQpKTsKKwkJCSAgIGludGVsX2hkY3BfZ2V0X3JlcGVh
dGVyX2N0bChkZXZfcHJpdiwgcGlwZSwgcG9ydCkpOwogCiAJcmV0ID0gc2hpbS0+dG9nZ2xlX3Np
Z25hbGxpbmcoaW50ZWxfZGlnX3BvcnQsIHRydWUpOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7
CiAKLQlJOTE1X1dSSVRFKFBPUlRfSERDUF9DT05GKHBvcnQpLCBIRENQX0NPTkZfQVVUSF9BTkRf
RU5DKTsKKwlJOTE1X1dSSVRFKEhEQ1BfQ09ORihkZXZfcHJpdiwgcGlwZSwgcG9ydCksIEhEQ1Bf
Q09ORl9BVVRIX0FORF9FTkMpOwogCiAJLyogV2FpdCBmb3IgUjAgcmVhZHkgKi8KLQlpZiAod2Fp
dF9mb3IoSTkxNV9SRUFEKFBPUlRfSERDUF9TVEFUVVMocG9ydCkpICYKKwlpZiAod2FpdF9mb3Io
STkxNV9SRUFEKEhEQ1BfU1RBVFVTKGRldl9wcml2LCBwaXBlLCBwb3J0KSkgJgogCQkgICAgIChI
RENQX1NUQVRVU19SMF9SRUFEWSB8IEhEQ1BfU1RBVFVTX0VOQyksIDEpKSB7CiAJCURSTV9FUlJP
UigiVGltZWQgb3V0IHdhaXRpbmcgZm9yIFIwIHJlYWR5XG4iKTsKIAkJcmV0dXJuIC1FVElNRURP
VVQ7CkBAIC02ODYsMjIgKzcwNCwyMyBAQCBzdGF0aWMgaW50IGludGVsX2hkY3BfYXV0aChzdHJ1
Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCiAJCXJldCA9IHNoaW0tPnJlYWRfcmlfcHJp
bWUoaW50ZWxfZGlnX3BvcnQsIHJpLnNoaW0pOwogCQlpZiAocmV0KQogCQkJcmV0dXJuIHJldDsK
LQkJSTkxNV9XUklURShQT1JUX0hEQ1BfUlBSSU1FKHBvcnQpLCByaS5yZWcpOworCQlJOTE1X1dS
SVRFKEhEQ1BfUlBSSU1FKGRldl9wcml2LCBwaXBlLCBwb3J0KSwgcmkucmVnKTsKIAogCQkvKiBX
YWl0IGZvciBSaSBwcmltZSBtYXRjaCAqLwotCQlpZiAoIXdhaXRfZm9yKEk5MTVfUkVBRChQT1JU
X0hEQ1BfU1RBVFVTKHBvcnQpKSAmCisJCWlmICghd2FpdF9mb3IoSTkxNV9SRUFEKEhEQ1BfU1RB
VFVTKGRldl9wcml2LCBwaXBlLCBwb3J0KSkgJgogCQkgICAgKEhEQ1BfU1RBVFVTX1JJX01BVENI
IHwgSERDUF9TVEFUVVNfRU5DKSwgMSkpCiAJCQlicmVhazsKIAl9CiAKIAlpZiAoaSA9PSB0cmll
cykgewogCQlEUk1fREVCVUdfS01TKCJUaW1lZCBvdXQgd2FpdGluZyBmb3IgUmkgcHJpbWUgbWF0
Y2ggKCV4KVxuIiwKLQkJCSAgICAgIEk5MTVfUkVBRChQT1JUX0hEQ1BfU1RBVFVTKHBvcnQpKSk7
CisJCQkgICAgICBJOTE1X1JFQUQoSERDUF9TVEFUVVMoZGV2X3ByaXYsIHBpcGUsIHBvcnQpKSk7
CiAJCXJldHVybiAtRVRJTUVET1VUOwogCX0KIAogCS8qIFdhaXQgZm9yIGVuY3J5cHRpb24gY29u
ZmlybWF0aW9uICovCi0JaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5j
b3JlLCBQT1JUX0hEQ1BfU1RBVFVTKHBvcnQpLAorCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3Rl
cigmZGV2X3ByaXYtPnVuY29yZSwKKwkJCQkgICAgSERDUF9TVEFUVVMoZGV2X3ByaXYsIHBpcGUs
IHBvcnQpLAogCQkJCSAgICBIRENQX1NUQVRVU19FTkMsIEhEQ1BfU1RBVFVTX0VOQywKIAkJCQkg
ICAgRU5DUllQVF9TVEFUVVNfQ0hBTkdFX1RJTUVPVVRfTVMpKSB7CiAJCURSTV9FUlJPUigiVGlt
ZWQgb3V0IHdhaXRpbmcgZm9yIGVuY3J5cHRpb25cbiIpOwpAQCAtNzI2LDE1ICs3NDUsMTYgQEAg
c3RhdGljIGludCBfaW50ZWxfaGRjcF9kaXNhYmxlKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNv
bm5lY3RvcikKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBjb25uZWN0b3It
PmJhc2UuZGV2LT5kZXZfcHJpdmF0ZTsKIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRl
bF9kaWdfcG9ydCA9IGNvbm5fdG9fZGlnX3BvcnQoY29ubmVjdG9yKTsKIAllbnVtIHBvcnQgcG9y
dCA9IGludGVsX2RpZ19wb3J0LT5iYXNlLnBvcnQ7CisJZW51bSBwaXBlIHBpcGUgPSBoZGNwLT5w
aXBlOwogCWludCByZXQ7CiAKIAlEUk1fREVCVUdfS01TKCJbJXM6JWRdIEhEQ1AgaXMgYmVpbmcg
ZGlzYWJsZWQuLi5cbiIsCiAJCSAgICAgIGNvbm5lY3Rvci0+YmFzZS5uYW1lLCBjb25uZWN0b3It
PmJhc2UuYmFzZS5pZCk7CiAKIAloZGNwLT5oZGNwX2VuY3J5cHRlZCA9IGZhbHNlOwotCUk5MTVf
V1JJVEUoUE9SVF9IRENQX0NPTkYocG9ydCksIDApOworCUk5MTVfV1JJVEUoSERDUF9DT05GKGRl
dl9wcml2LCBwaXBlLCBwb3J0KSwgMCk7CiAJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZk
ZXZfcHJpdi0+dW5jb3JlLAotCQkJCSAgICBQT1JUX0hEQ1BfU1RBVFVTKHBvcnQpLCB+MCwgMCwK
KwkJCQkgICAgSERDUF9TVEFUVVMoZGV2X3ByaXYsIHBpcGUsIHBvcnQpLCB+MCwgMCwKIAkJCQkg
ICAgRU5DUllQVF9TVEFUVVNfQ0hBTkdFX1RJTUVPVVRfTVMpKSB7CiAJCURSTV9FUlJPUigiRmFp
bGVkIHRvIGRpc2FibGUgSERDUCwgdGltZW91dCBjbGVhcmluZyBzdGF0dXNcbiIpOwogCQlyZXR1
cm4gLUVUSU1FRE9VVDsKQEAgLTgwNiw5ICs4MjYsMTEgQEAgc3RhdGljIGludCBpbnRlbF9oZGNw
X2NoZWNrX2xpbmsoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQogCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGNvbm5lY3Rvci0+YmFzZS5kZXYtPmRldl9wcml2
YXRlOwogCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0ID0gY29ubl90
b19kaWdfcG9ydChjb25uZWN0b3IpOwogCWVudW0gcG9ydCBwb3J0ID0gaW50ZWxfZGlnX3BvcnQt
PmJhc2UucG9ydDsKKwllbnVtIHBpcGUgcGlwZTsKIAlpbnQgcmV0ID0gMDsKIAogCW11dGV4X2xv
Y2soJmhkY3AtPm11dGV4KTsKKwlwaXBlID0gaGRjcC0+cGlwZTsKIAogCS8qIENoZWNrX2xpbmsg
dmFsaWQgb25seSB3aGVuIEhEQ1AxLjQgaXMgZW5hYmxlZCAqLwogCWlmIChoZGNwLT52YWx1ZSAh
PSBEUk1fTU9ERV9DT05URU5UX1BST1RFQ1RJT05fRU5BQkxFRCB8fApAQCAtODE3LDEwICs4Mzks
MTAgQEAgc3RhdGljIGludCBpbnRlbF9oZGNwX2NoZWNrX2xpbmsoc3RydWN0IGludGVsX2Nvbm5l
Y3RvciAqY29ubmVjdG9yKQogCQlnb3RvIG91dDsKIAl9CiAKLQlpZiAoV0FSTl9PTighaW50ZWxf
aGRjcF9pbl91c2UoY29ubmVjdG9yKSkpIHsKKwlpZiAoV0FSTl9PTighaW50ZWxfaGRjcF9pbl91
c2UoZGV2X3ByaXYsIHBpcGUsIHBvcnQpKSkgewogCQlEUk1fRVJST1IoIiVzOiVkIEhEQ1AgbGlu
ayBzdG9wcGVkIGVuY3J5cHRpb24sJXhcbiIsCiAJCQkgIGNvbm5lY3Rvci0+YmFzZS5uYW1lLCBj
b25uZWN0b3ItPmJhc2UuYmFzZS5pZCwKLQkJCSAgSTkxNV9SRUFEKFBPUlRfSERDUF9TVEFUVVMo
cG9ydCkpKTsKKwkJCSAgSTkxNV9SRUFEKEhEQ1BfU1RBVFVTKGRldl9wcml2LCBwaXBlLCBwb3J0
KSkpOwogCQlyZXQgPSAtRU5YSU87CiAJCWhkY3AtPnZhbHVlID0gRFJNX01PREVfQ09OVEVOVF9Q
Uk9URUNUSU9OX0RFU0lSRUQ7CiAJCXNjaGVkdWxlX3dvcmsoJmhkY3AtPnByb3Bfd29yayk7CkBA
IC0xNDkxLDEwICsxNTEzLDExIEBAIHN0YXRpYyBpbnQgaGRjcDJfZW5hYmxlX2VuY3J5cHRpb24o
c3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQogCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7CiAJc3RydWN0IGlu
dGVsX2hkY3AgKmhkY3AgPSAmY29ubmVjdG9yLT5oZGNwOwogCWVudW0gcG9ydCBwb3J0ID0gY29u
bmVjdG9yLT5lbmNvZGVyLT5wb3J0OworCWVudW0gcGlwZSBwaXBlID0gaGRjcC0+cGlwZTsKIAlp
bnQgcmV0OwogCi0JV0FSTl9PTihJOTE1X1JFQUQoSERDUDJfU1RBVFVTX0RESShwb3J0KSkgJiBM
SU5LX0VOQ1JZUFRJT05fU1RBVFVTKTsKLQorCVdBUk5fT04oSTkxNV9SRUFEKEhEQ1AyX1NUQVRV
UyhkZXZfcHJpdiwgcGlwZSwgcG9ydCkpICYKKwkJTElOS19FTkNSWVBUSU9OX1NUQVRVUyk7CiAJ
aWYgKGhkY3AtPnNoaW0tPnRvZ2dsZV9zaWduYWxsaW5nKSB7CiAJCXJldCA9IGhkY3AtPnNoaW0t
PnRvZ2dsZV9zaWduYWxsaW5nKGludGVsX2RpZ19wb3J0LCB0cnVlKTsKIAkJaWYgKHJldCkgewpA
QCAtMTUwNCwxNCArMTUyNywxNSBAQCBzdGF0aWMgaW50IGhkY3AyX2VuYWJsZV9lbmNyeXB0aW9u
KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKIAkJfQogCX0KIAotCWlmIChJOTE1
X1JFQUQoSERDUDJfU1RBVFVTX0RESShwb3J0KSkgJiBMSU5LX0FVVEhfU1RBVFVTKSB7CisJaWYg
KEk5MTVfUkVBRChIRENQMl9TVEFUVVMoZGV2X3ByaXYsIHBpcGUsIHBvcnQpKSAmIExJTktfQVVU
SF9TVEFUVVMpIHsKIAkJLyogTGluayBpcyBBdXRoZW50aWNhdGVkLiBOb3cgc2V0IGZvciBFbmNy
eXB0aW9uICovCi0JCUk5MTVfV1JJVEUoSERDUDJfQ1RMX0RESShwb3J0KSwKLQkJCSAgIEk5MTVf
UkVBRChIRENQMl9DVExfRERJKHBvcnQpKSB8CisJCUk5MTVfV1JJVEUoSERDUDJfQ1RMKGRldl9w
cml2LCBwaXBlLCBwb3J0KSwKKwkJCSAgIEk5MTVfUkVBRChIRENQMl9DVEwoZGV2X3ByaXYsIHBp
cGUsIHBvcnQpKSB8CiAJCQkgICBDVExfTElOS19FTkNSWVBUSU9OX1JFUSk7CiAJfQogCi0JcmV0
ID0gaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsIEhEQ1AyX1NUQVRV
U19EREkocG9ydCksCisJcmV0ID0gaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51
bmNvcmUsCisJCQkJICAgICAgSERDUDJfU1RBVFVTKGRldl9wcml2LCBwaXBlLCBwb3J0KSwKIAkJ
CQkgICAgICBMSU5LX0VOQ1JZUFRJT05fU1RBVFVTLAogCQkJCSAgICAgIExJTktfRU5DUllQVElP
Tl9TVEFUVVMsCiAJCQkJICAgICAgRU5DUllQVF9TVEFUVVNfQ0hBTkdFX1RJTUVPVVRfTVMpOwpA
QCAtMTUyNSwxNCArMTU0OSwxNyBAQCBzdGF0aWMgaW50IGhkY3AyX2Rpc2FibGVfZW5jcnlwdGlv
bihzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCiAJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKIAlzdHJ1Y3Qg
aW50ZWxfaGRjcCAqaGRjcCA9ICZjb25uZWN0b3ItPmhkY3A7CiAJZW51bSBwb3J0IHBvcnQgPSBj
b25uZWN0b3ItPmVuY29kZXItPnBvcnQ7CisJZW51bSBwaXBlIHBpcGUgPSBoZGNwLT5waXBlOwog
CWludCByZXQ7CiAKLQlXQVJOX09OKCEoSTkxNV9SRUFEKEhEQ1AyX1NUQVRVU19EREkocG9ydCkp
ICYgTElOS19FTkNSWVBUSU9OX1NUQVRVUykpOworCVdBUk5fT04oIShJOTE1X1JFQUQoSERDUDJf
U1RBVFVTKGRldl9wcml2LCBwaXBlLCBwb3J0KSkgJgorCQlMSU5LX0VOQ1JZUFRJT05fU1RBVFVT
KSk7CisJSTkxNV9XUklURShIRENQMl9DVEwoZGV2X3ByaXYsIHBpcGUsIHBvcnQpLAorCQkgICBJ
OTE1X1JFQUQoSERDUDJfQ1RMKGRldl9wcml2LCBwaXBlLCBwb3J0KSkgJgorCQkgICB+Q1RMX0xJ
TktfRU5DUllQVElPTl9SRVEpOwogCi0JSTkxNV9XUklURShIRENQMl9DVExfRERJKHBvcnQpLAot
CQkgICBJOTE1X1JFQUQoSERDUDJfQ1RMX0RESShwb3J0KSkgJiB+Q1RMX0xJTktfRU5DUllQVElP
Tl9SRVEpOwotCi0JcmV0ID0gaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNv
cmUsIEhEQ1AyX1NUQVRVU19EREkocG9ydCksCisJcmV0ID0gaW50ZWxfd2FpdF9mb3JfcmVnaXN0
ZXIoJmRldl9wcml2LT51bmNvcmUsCisJCQkJICAgICAgSERDUDJfU1RBVFVTKGRldl9wcml2LCBw
aXBlLCBwb3J0KSwKIAkJCQkgICAgICBMSU5LX0VOQ1JZUFRJT05fU1RBVFVTLCAweDAsCiAJCQkJ
ICAgICAgRU5DUllQVF9TVEFUVVNfQ0hBTkdFX1RJTUVPVVRfTVMpOwogCWlmIChyZXQgPT0gLUVU
SU1FRE9VVCkKQEAgLTE2MzEsOSArMTY1OCwxMSBAQCBzdGF0aWMgaW50IGludGVsX2hkY3AyX2No
ZWNrX2xpbmsoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQogCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7CiAJ
c3RydWN0IGludGVsX2hkY3AgKmhkY3AgPSAmY29ubmVjdG9yLT5oZGNwOwogCWVudW0gcG9ydCBw
b3J0ID0gY29ubmVjdG9yLT5lbmNvZGVyLT5wb3J0OworCWVudW0gcGlwZSBwaXBlOwogCWludCBy
ZXQgPSAwOwogCiAJbXV0ZXhfbG9jaygmaGRjcC0+bXV0ZXgpOworCXBpcGUgPSBoZGNwLT5waXBl
OwogCiAJLyogaGRjcDJfY2hlY2tfbGluayBpcyBleHBlY3RlZCBvbmx5IHdoZW4gSERDUDIuMiBp
cyBFbmFibGVkICovCiAJaWYgKGhkY3AtPnZhbHVlICE9IERSTV9NT0RFX0NPTlRFTlRfUFJPVEVD
VElPTl9FTkFCTEVEIHx8CkBAIC0xNjQyLDkgKzE2NzEsOSBAQCBzdGF0aWMgaW50IGludGVsX2hk
Y3AyX2NoZWNrX2xpbmsoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQogCQlnb3Rv
IG91dDsKIAl9CiAKLQlpZiAoV0FSTl9PTighaW50ZWxfaGRjcDJfaW5fdXNlKGNvbm5lY3Rvcikp
KSB7CisJaWYgKFdBUk5fT04oIWludGVsX2hkY3AyX2luX3VzZShkZXZfcHJpdiwgcGlwZSwgcG9y
dCkpKSB7CiAJCURSTV9FUlJPUigiSERDUDIuMiBsaW5rIHN0b3BwZWQgdGhlIGVuY3J5cHRpb24s
ICV4XG4iLAotCQkJICBJOTE1X1JFQUQoSERDUDJfU1RBVFVTX0RESShwb3J0KSkpOworCQkJICBJ
OTE1X1JFQUQoSERDUDJfU1RBVFVTKGRldl9wcml2LCBwaXBlLCBwb3J0KSkpOwogCQlyZXQgPSAt
RU5YSU87CiAJCWhkY3AtPnZhbHVlID0gRFJNX01PREVfQ09OVEVOVF9QUk9URUNUSU9OX0RFU0lS
RUQ7CiAJCXNjaGVkdWxlX3dvcmsoJmhkY3AtPnByb3Bfd29yayk7CkBAIC0xODU3LDYgKzE4ODYs
OCBAQCBpbnQgaW50ZWxfaGRjcF9lbmFibGUoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVj
dG9yKQogCW11dGV4X2xvY2soJmhkY3AtPm11dGV4KTsKIAlXQVJOX09OKGhkY3AtPnZhbHVlID09
IERSTV9NT0RFX0NPTlRFTlRfUFJPVEVDVElPTl9FTkFCTEVEKTsKIAorCWhkY3AtPnBpcGUgPSBp
bnRlbF9jb25uZWN0b3JfZ2V0X3BpcGUoY29ubmVjdG9yKTsKKwogCS8qCiAJICogQ29uc2lkZXJp
bmcgdGhhdCBIRENQMi4yIGlzIG1vcmUgc2VjdXJlIHRoYW4gSERDUDEuNCwgSWYgdGhlIHNldHVw
CiAJICogaXMgY2FwYWJsZSBvZiBIRENQMi4yLCBpdCBpcyBwcmVmZXJyZWQgdG8gdXNlIEhEQ1Ay
LjIuCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2hkbWku
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfaGRtaS5jCmluZGV4IDBlYmVj
NjliYmJmYy4uMjA5NmFlZTE3NGIyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2hkbWkuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX2hkbWkuYwpAQCAtMTQ5MSw3ICsxNDkxLDEwIEBAIGJvb2wgaW50ZWxfaGRtaV9oZGNwX2No
ZWNrX2xpbmsoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQpCiB7CiAJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0KIAkJaW50ZWxfZGlnX3BvcnQtPmJh
c2UuYmFzZS5kZXYtPmRldl9wcml2YXRlOworCXN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5l
Y3RvciA9CisJCQkJaW50ZWxfZGlnX3BvcnQtPmhkbWkuYXR0YWNoZWRfY29ubmVjdG9yOwogCWVu
dW0gcG9ydCBwb3J0ID0gaW50ZWxfZGlnX3BvcnQtPmJhc2UucG9ydDsKKwllbnVtIHBpcGUgcGlw
ZSA9IGNvbm5lY3Rvci0+aGRjcC5waXBlOwogCWludCByZXQ7CiAJdW5pb24gewogCQl1MzIgcmVn
OwpAQCAtMTUwMiwxMyArMTUwNSwxMyBAQCBib29sIGludGVsX2hkbWlfaGRjcF9jaGVja19saW5r
KHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0KQogCWlmIChyZXQpCiAJ
CXJldHVybiBmYWxzZTsKIAotCUk5MTVfV1JJVEUoUE9SVF9IRENQX1JQUklNRShwb3J0KSwgcmku
cmVnKTsKKwlJOTE1X1dSSVRFKEhEQ1BfUlBSSU1FKGRldl9wcml2LCBwaXBlLCBwb3J0KSwgcmku
cmVnKTsKIAogCS8qIFdhaXQgZm9yIFJpIHByaW1lIG1hdGNoICovCi0JaWYgKHdhaXRfZm9yKEk5
MTVfUkVBRChQT1JUX0hEQ1BfU1RBVFVTKHBvcnQpKSAmCisJaWYgKHdhaXRfZm9yKEk5MTVfUkVB
RChIRENQX1NUQVRVUyhkZXZfcHJpdiwgcGlwZSwgcG9ydCkpICYKIAkJICAgICAoSERDUF9TVEFU
VVNfUklfTUFUQ0ggfCBIRENQX1NUQVRVU19FTkMpLCAxKSkgewogCQlEUk1fRVJST1IoIlJpJyBt
aXNtYXRjaCBkZXRlY3RlZCwgbGluayBjaGVjayBmYWlsZWQgKCV4KVxuIiwKLQkJCSAgSTkxNV9S
RUFEKFBPUlRfSERDUF9TVEFUVVMocG9ydCkpKTsKKwkJCSAgSTkxNV9SRUFEKEhEQ1BfU1RBVFVT
KGRldl9wcml2LCBwaXBlLCBwb3J0KSkpOwogCQlyZXR1cm4gZmFsc2U7CiAJfQogCXJldHVybiB0
cnVlOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZWcuaCBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVnLmgKaW5kZXggNTg5OGY1OWUzZGQ3Li4zZWEwMzQzM2Y0
ZjQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVnLmgKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZWcuaApAQCAtOTI0NCwxMiArOTI0NCwyMCBAQCBlbnVt
IHNrbF9wb3dlcl9nYXRlIHsKIAogLyogSERDUCBSZXBlYXRlciBSZWdpc3RlcnMgKi8KICNkZWZp
bmUgSERDUF9SRVBfQ1RMCQkJX01NSU8oMHg2NmQwMCkKKyNkZWZpbmUgIEhEQ1BfVFJBTlNBX1JF
UF9QUkVTRU5UCUJJVCgzMSkKKyNkZWZpbmUgIEhEQ1BfVFJBTlNCX1JFUF9QUkVTRU5UCUJJVCgz
MCkKKyNkZWZpbmUgIEhEQ1BfVFJBTlNDX1JFUF9QUkVTRU5UCUJJVCgyOSkKKyNkZWZpbmUgIEhE
Q1BfVFJBTlNEX1JFUF9QUkVTRU5UCUJJVCgyOCkKICNkZWZpbmUgIEhEQ1BfRERJQl9SRVBfUFJF
U0VOVAkJQklUKDMwKQogI2RlZmluZSAgSERDUF9ERElBX1JFUF9QUkVTRU5UCQlCSVQoMjkpCiAj
ZGVmaW5lICBIRENQX0RESUNfUkVQX1BSRVNFTlQJCUJJVCgyOCkKICNkZWZpbmUgIEhEQ1BfRERJ
RF9SRVBfUFJFU0VOVAkJQklUKDI3KQogI2RlZmluZSAgSERDUF9ERElGX1JFUF9QUkVTRU5UCQlC
SVQoMjYpCiAjZGVmaW5lICBIRENQX0RESUVfUkVQX1BSRVNFTlQJCUJJVCgyNSkKKyNkZWZpbmUg
IEhEQ1BfVFJBTlNBX1NIQTFfTTAJCSgxIDw8IDIwKQorI2RlZmluZSAgSERDUF9UUkFOU0JfU0hB
MV9NMAkJKDIgPDwgMjApCisjZGVmaW5lICBIRENQX1RSQU5TQ19TSEExX00wCQkoMyA8PCAyMCkK
KyNkZWZpbmUgIEhEQ1BfVFJBTlNEX1NIQTFfTTAJCSg0IDw8IDIwKQogI2RlZmluZSAgSERDUF9E
RElCX1NIQTFfTTAJCSgxIDw8IDIwKQogI2RlZmluZSAgSERDUF9ERElBX1NIQTFfTTAJCSgyIDw8
IDIwKQogI2RlZmluZSAgSERDUF9ERElDX1NIQTFfTTAJCSgzIDw8IDIwKQpAQCAtOTI4OSwxNSAr
OTI5Nyw4OSBAQCBlbnVtIHNrbF9wb3dlcl9nYXRlIHsKIAkJCQkJICBfUE9SVEVfSERDUF9BVVRI
RU5DLCBcCiAJCQkJCSAgX1BPUlRGX0hEQ1BfQVVUSEVOQykgKyAoeCkpCiAjZGVmaW5lIFBPUlRf
SERDUF9DT05GKHBvcnQpCQlfUE9SVF9IRENQX0FVVEhFTkMocG9ydCwgMHgwKQorI2RlZmluZSBf
VFJBTlNBX0hEQ1BfQ09ORgkJMHg2NjQwMAorI2RlZmluZSBfVFJBTlNCX0hEQ1BfQ09ORgkJMHg2
NjUwMAorI2RlZmluZSBUUkFOU19IRENQX0NPTkYodHJhbnMpCQlfTU1JT19UUkFOUyh0cmFucywg
X1RSQU5TQV9IRENQX0NPTkYsIFwKKwkJCQkJCSAgICBfVFJBTlNCX0hEQ1BfQ09ORikKKyNkZWZp
bmUgSERDUF9DT05GKGRldl9wcml2LCBwaXBlLCBwb3J0KQkoSU5URUxfR0VOKGRldl9wcml2KSA+
PSAxMiA/IFwKKwkJCQkJIFRSQU5TX0hEQ1BfQ09ORihwaXBlKSA6IFwKKwkJCQkJIFBPUlRfSERD
UF9DT05GKHBvcnQpKQorCiAjZGVmaW5lICBIRENQX0NPTkZfQ0FQVFVSRV9BTgkJQklUKDApCiAj
ZGVmaW5lICBIRENQX0NPTkZfQVVUSF9BTkRfRU5DCQkoQklUKDEpIHwgQklUKDApKQogI2RlZmlu
ZSBQT1JUX0hEQ1BfQU5JTklUKHBvcnQpCQlfUE9SVF9IRENQX0FVVEhFTkMocG9ydCwgMHg0KQor
I2RlZmluZSBfVFJBTlNBX0hEQ1BfQU5JTklUCQkweDY2NDA0CisjZGVmaW5lIF9UUkFOU0JfSERD
UF9BTklOSVQJCTB4NjY1MDQKKyNkZWZpbmUgVFJBTlNfSERDUF9BTklOSVQodHJhbnMpCV9NTUlP
X1RSQU5TKHRyYW5zLCBcCisJCQkJCQkgICAgX1RSQU5TQV9IRENQX0FOSU5JVCwgXAorCQkJCQkJ
ICAgIF9UUkFOU0JfSERDUF9BTklOSVQpCisjZGVmaW5lIEhEQ1BfQU5JTklUKGRldl9wcml2LCBw
aXBlLCBwb3J0KSBcCisJCQkJCShJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEyID8gXAorCQkJCQkg
VFJBTlNfSERDUF9BTklOSVQocGlwZSkgOiBcCisJCQkJCSBQT1JUX0hEQ1BfQU5JTklUKHBvcnQp
KQorCiAjZGVmaW5lIFBPUlRfSERDUF9BTkxPKHBvcnQpCQlfUE9SVF9IRENQX0FVVEhFTkMocG9y
dCwgMHg4KQorI2RlZmluZSBfVFJBTlNBX0hEQ1BfQU5MTwkJMHg2NjQwOAorI2RlZmluZSBfVFJB
TlNCX0hEQ1BfQU5MTwkJMHg2NjUwOAorI2RlZmluZSBUUkFOU19IRENQX0FOTE8odHJhbnMpCQlf
TU1JT19UUkFOUyh0cmFucywgX1RSQU5TQV9IRENQX0FOTE8sIFwKKwkJCQkJCSAgICBfVFJBTlNC
X0hEQ1BfQU5MTykKKyNkZWZpbmUgSERDUF9BTkxPKGRldl9wcml2LCBwaXBlLCBwb3J0KQkoSU5U
RUxfR0VOKGRldl9wcml2KSA+PSAxMiA/IFwKKwkJCQkJIFRSQU5TX0hEQ1BfQU5MTyhwaXBlKSA6
IFwKKwkJCQkJIFBPUlRfSERDUF9BTkxPKHBvcnQpKQorCiAjZGVmaW5lIFBPUlRfSERDUF9BTkhJ
KHBvcnQpCQlfUE9SVF9IRENQX0FVVEhFTkMocG9ydCwgMHhDKQorI2RlZmluZSBfVFJBTlNBX0hE
Q1BfQU5ISQkJMHg2NjQwQworI2RlZmluZSBfVFJBTlNCX0hEQ1BfQU5ISQkJMHg2NjUwQworI2Rl
ZmluZSBUUkFOU19IRENQX0FOSEkodHJhbnMpCQlfTU1JT19UUkFOUyh0cmFucywgX1RSQU5TQV9I
RENQX0FOSEksIFwKKwkJCQkJCSAgICBfVFJBTlNCX0hEQ1BfQU5ISSkKKyNkZWZpbmUgSERDUF9B
TkhJKGRldl9wcml2LCBwaXBlLCBwb3J0KQkoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMiA/IFwK
KwkJCQkJIFRSQU5TX0hEQ1BfQU5ISShwaXBlKSA6IFwKKwkJCQkJIFBPUlRfSERDUF9BTkhJKHBv
cnQpKQorCiAjZGVmaW5lIFBPUlRfSERDUF9CS1NWTE8ocG9ydCkJCV9QT1JUX0hEQ1BfQVVUSEVO
Qyhwb3J0LCAweDEwKQorI2RlZmluZSBfVFJBTlNBX0hEQ1BfQktTVkxPCQkweDY2NDEwCisjZGVm
aW5lIF9UUkFOU0JfSERDUF9CS1NWTE8JCTB4NjY1MTAKKyNkZWZpbmUgVFJBTlNfSERDUF9CS1NW
TE8odHJhbnMpCV9NTUlPX1RSQU5TKHRyYW5zLCBcCisJCQkJCQkgICAgX1RSQU5TQV9IRENQX0JL
U1ZMTywgXAorCQkJCQkJICAgIF9UUkFOU0JfSERDUF9CS1NWTE8pCisjZGVmaW5lIEhEQ1BfQktT
VkxPKGRldl9wcml2LCBwaXBlLCBwb3J0KSBcCisJCQkJCShJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDEyID8gXAorCQkJCQkgVFJBTlNfSERDUF9CS1NWTE8ocGlwZSkgOiBcCisJCQkJCSBQT1JUX0hE
Q1BfQktTVkxPKHBvcnQpKQorCiAjZGVmaW5lIFBPUlRfSERDUF9CS1NWSEkocG9ydCkJCV9QT1JU
X0hEQ1BfQVVUSEVOQyhwb3J0LCAweDE0KQorI2RlZmluZSBfVFJBTlNBX0hEQ1BfQktTVkhJCQkw
eDY2NDE0CisjZGVmaW5lIF9UUkFOU0JfSERDUF9CS1NWSEkJCTB4NjY1MTQKKyNkZWZpbmUgVFJB
TlNfSERDUF9CS1NWSEkodHJhbnMpCV9NTUlPX1RSQU5TKHRyYW5zLCBcCisJCQkJCQkgICAgX1RS
QU5TQV9IRENQX0JLU1ZISSwgXAorCQkJCQkJICAgIF9UUkFOU0JfSERDUF9CS1NWSEkpCisjZGVm
aW5lIEhEQ1BfQktTVkhJKGRldl9wcml2LCBwaXBlLCBwb3J0KSBcCisJCQkJCShJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDEyID8gXAorCQkJCQkgVFJBTlNfSERDUF9CS1NWSEkocGlwZSkgOiBcCisJ
CQkJCSBQT1JUX0hEQ1BfQktTVkhJKHBvcnQpKQorCiAjZGVmaW5lIFBPUlRfSERDUF9SUFJJTUUo
cG9ydCkJCV9QT1JUX0hEQ1BfQVVUSEVOQyhwb3J0LCAweDE4KQorI2RlZmluZSBfVFJBTlNBX0hE
Q1BfUlBSSU1FCQkweDY2NDE4CisjZGVmaW5lIF9UUkFOU0JfSERDUF9SUFJJTUUJCTB4NjY1MTgK
KyNkZWZpbmUgVFJBTlNfSERDUF9SUFJJTUUodHJhbnMpCV9NTUlPX1RSQU5TKHRyYW5zLCBcCisJ
CQkJCQkgICAgX1RSQU5TQV9IRENQX1JQUklNRSwgXAorCQkJCQkJICAgIF9UUkFOU0JfSERDUF9S
UFJJTUUpCisjZGVmaW5lIEhEQ1BfUlBSSU1FKGRldl9wcml2LCBwaXBlLCBwb3J0KSBcCisJCQkJ
CShJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEyID8gXAorCQkJCQkgVFJBTlNfSERDUF9SUFJJTUUo
cGlwZSkgOiBcCisJCQkJCSBQT1JUX0hEQ1BfUlBSSU1FKHBvcnQpKQorCiAjZGVmaW5lIFBPUlRf
SERDUF9TVEFUVVMocG9ydCkJCV9QT1JUX0hEQ1BfQVVUSEVOQyhwb3J0LCAweDFDKQorI2RlZmlu
ZSBfVFJBTlNBX0hEQ1BfU1RBVFVTCQkweDY2NDFDCisjZGVmaW5lIF9UUkFOU0JfSERDUF9TVEFU
VVMJCTB4NjY1MUMKKyNkZWZpbmUgVFJBTlNfSERDUF9TVEFUVVModHJhbnMpCV9NTUlPX1RSQU5T
KHRyYW5zLCBcCisJCQkJCQkgICAgX1RSQU5TQV9IRENQX1NUQVRVUywgXAorCQkJCQkJICAgIF9U
UkFOU0JfSERDUF9TVEFUVVMpCisjZGVmaW5lIEhEQ1BfU1RBVFVTKGRldl9wcml2LCBwaXBlLCBw
b3J0KSBcCisJCQkJCShJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEyID8gXAorCQkJCQkgVFJBTlNf
SERDUF9TVEFUVVMocGlwZSkgOiBcCisJCQkJCSBQT1JUX0hEQ1BfU1RBVFVTKHBvcnQpKQorCiAj
ZGVmaW5lICBIRENQX1NUQVRVU19TVFJFQU1fQV9FTkMJQklUKDMxKQogI2RlZmluZSAgSERDUF9T
VEFUVVNfU1RSRUFNX0JfRU5DCUJJVCgzMCkKICNkZWZpbmUgIEhEQ1BfU1RBVFVTX1NUUkVBTV9D
X0VOQwlCSVQoMjkpCkBAIC05MzI0LDIzICs5NDA2LDQzIEBAIGVudW0gc2tsX3Bvd2VyX2dhdGUg
ewogCQkJCQkgIF9QT1JURF9IRENQMl9CQVNFLCBcCiAJCQkJCSAgX1BPUlRFX0hEQ1AyX0JBU0Us
IFwKIAkJCQkJICBfUE9SVEZfSERDUDJfQkFTRSkgKyAoeCkpCi0KLSNkZWZpbmUgSERDUDJfQVVU
SF9EREkocG9ydCkJCV9QT1JUX0hEQ1AyX0JBU0UocG9ydCwgMHg5OCkKKyNkZWZpbmUgUE9SVF9I
RENQMl9BVVRIKHBvcnQpCQlfUE9SVF9IRENQMl9CQVNFKHBvcnQsIDB4OTgpCisjZGVmaW5lIF9U
UkFOU0FfSERDUDJfQVVUSAkJMHg2NjQ5OAorI2RlZmluZSBfVFJBTlNCX0hEQ1AyX0FVVEgJCTB4
NjY1OTgKKyNkZWZpbmUgVFJBTlNfSERDUDJfQVVUSCh0cmFucykJCV9NTUlPX1RSQU5TKHRyYW5z
LCBfVFJBTlNBX0hEQ1AyX0FVVEgsIFwKKwkJCQkJCSAgICBfVFJBTlNCX0hEQ1AyX0FVVEgpCiAj
ZGVmaW5lICAgQVVUSF9MSU5LX0FVVEhFTlRJQ0FURUQJQklUKDMxKQogI2RlZmluZSAgIEFVVEhf
TElOS19UWVBFCQlCSVQoMzApCiAjZGVmaW5lICAgQVVUSF9GT1JDRV9DTFJfSU5QVVRDVFIJQklU
KDE5KQogI2RlZmluZSAgIEFVVEhfQ0xSX0tFWVMJCQlCSVQoMTgpCi0KLSNkZWZpbmUgSERDUDJf
Q1RMX0RESShwb3J0KQkJX1BPUlRfSERDUDJfQkFTRShwb3J0LCAweEIwKQorI2RlZmluZSBIRENQ
Ml9BVVRIKGRldl9wcml2LCBwaXBlLCBwb3J0KSBcCisJCQkJCShJTlRFTF9HRU4oZGV2X3ByaXYp
ID49IDEyID8gXAorCQkJCQkgVFJBTlNfSERDUDJfQVVUSChwaXBlKSA6IFwKKwkJCQkJIFBPUlRf
SERDUDJfQVVUSChwb3J0KSkKKworI2RlZmluZSBQT1JUX0hEQ1AyX0NUTChwb3J0KQkJX1BPUlRf
SERDUDJfQkFTRShwb3J0LCAweEIwKQorI2RlZmluZSBfVFJBTlNBX0hEQ1AyX0NUTAkJMHg2NjRC
MAorI2RlZmluZSBfVFJBTlNCX0hEQ1AyX0NUTAkJMHg2NjVCMAorI2RlZmluZSBUUkFOU19IRENQ
Ml9DVEwodHJhbnMpCQlfTU1JT19UUkFOUyh0cmFucywgX1RSQU5TQV9IRENQMl9DVEwsIFwKKwkJ
CQkJCSAgICBfVFJBTlNCX0hEQ1AyX0NUTCkKICNkZWZpbmUgICBDVExfTElOS19FTkNSWVBUSU9O
X1JFUQlCSVQoMzEpCi0KLSNkZWZpbmUgSERDUDJfU1RBVFVTX0RESShwb3J0KQkJX1BPUlRfSERD
UDJfQkFTRShwb3J0LCAweEI0KQotI2RlZmluZSAgIFNUUkVBTV9FTkNSWVBUSU9OX1NUQVRVU19B
CUJJVCgzMSkKLSNkZWZpbmUgICBTVFJFQU1fRU5DUllQVElPTl9TVEFUVVNfQglCSVQoMzApCi0j
ZGVmaW5lICAgU1RSRUFNX0VOQ1JZUFRJT05fU1RBVFVTX0MJQklUKDI5KQorI2RlZmluZSBIRENQ
Ml9DVEwoZGV2X3ByaXYsIHBpcGUsIHBvcnQpCShJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEyID8g
XAorCQkJCQkgVFJBTlNfSERDUDJfQ1RMKHBpcGUpIDogXAorCQkJCQkgUE9SVF9IRENQMl9DVEwo
cG9ydCkpCisKKyNkZWZpbmUgUE9SVF9IRENQMl9TVEFUVVMocG9ydCkJCV9QT1JUX0hEQ1AyX0JB
U0UocG9ydCwgMHhCNCkKKyNkZWZpbmUgX1RSQU5TQV9IRENQMl9TVEFUVVMJCTB4NjY0QjQKKyNk
ZWZpbmUgX1RSQU5TQl9IRENQMl9TVEFUVVMJCTB4NjY1QjQKKyNkZWZpbmUgVFJBTlNfSERDUDJf
U1RBVFVTKHRyYW5zKQlfTU1JT19UUkFOUyh0cmFucywgXAorCQkJCQkJICAgIF9UUkFOU0FfSERD
UDJfU1RBVFVTLCBcCisJCQkJCQkgICAgX1RSQU5TQl9IRENQMl9TVEFUVVMpCiAjZGVmaW5lICAg
TElOS19UWVBFX1NUQVRVUwkJQklUKDIyKQogI2RlZmluZSAgIExJTktfQVVUSF9TVEFUVVMJCUJJ
VCgyMSkKICNkZWZpbmUgICBMSU5LX0VOQ1JZUFRJT05fU1RBVFVTCUJJVCgyMCkKKyNkZWZpbmUg
SERDUDJfU1RBVFVTKGRldl9wcml2LCBwaXBlLCBwb3J0KSBcCisJCQkJCShJTlRFTF9HRU4oZGV2
X3ByaXYpID49IDEyID8gXAorCQkJCQkgVFJBTlNfSERDUDJfU1RBVFVTKHBpcGUpIDogXAorCQkJ
CQkgUE9SVF9IRENQMl9TVEFUVVMocG9ydCkpCiAKIC8qIFBlci1waXBlIERESSBGdW5jdGlvbiBD
b250cm9sICovCiAjZGVmaW5lIF9UUkFOU19ERElfRlVOQ19DVExfQQkJMHg2MDQwMApkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHJ2LmggYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9kcnYuaAppbmRleCAyNGM2M2VkNDVjNmYuLjc0MWZhMjFjM2U1NyAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfZHJ2LmgKQEAgLTM2NSw2ICszNjUsMTQgQEAgc3RydWN0IGludGVsX2hk
Y3AgewogCXdhaXRfcXVldWVfaGVhZF90IGNwX2lycV9xdWV1ZTsKIAlhdG9taWNfdCBjcF9pcnFf
Y291bnQ7CiAJaW50IGNwX2lycV9jb3VudF9jYWNoZWQ7CisKKwkvKgorCSAqIEdlbiAxMiBvbndh
cmRzLCBIRENQIGlzIHBhcnQgb2YgdHJhbnNjb2RlcihwcmV2aW91c2x5IERESSkuCisJICogU28g
Y2hhY2hlaW5nIHRoZSBwaXBlIGFzc29jaWF0ZWQgdG8gY29ubmVjdG9yIGF0IGhkY3BfZW5hYmxl
CisJICogd291bGQgaGVscCBpbiBzdWJzZXF1ZW50IGZ1bmN0aW9ucyB0byBkZXJpdmUgdGhlIHJp
Z2h0IG9mZnNldHMKKwkgKiBmb3IgSERDUCByZWdpc3RlcnMuCisJICovCisJZW51bSBwaXBlIHBp
cGU7CiB9OwogCiBzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yIHsKLS0gCjIuMTkuMQoKX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcg
bGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRl
c2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

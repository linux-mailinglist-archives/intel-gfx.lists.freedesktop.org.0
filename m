Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id DE77A2C31B5
	for <lists+intel-gfx@lfdr.de>; Tue, 24 Nov 2020 21:12:01 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 458C56E060;
	Tue, 24 Nov 2020 20:12:00 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga14.intel.com (mga14.intel.com [192.55.52.115])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 599206E0D5
 for <intel-gfx@lists.freedesktop.org>; Tue, 24 Nov 2020 20:11:59 +0000 (UTC)
IronPort-SDR: KRGS0PqhXU7/XImwNc7nrKzRc1qMxXgjxqXcNZAKgw11EppLI2x0yC3mxVnDFQFG2RE/dZE+Ei
 E7eJ/kSORzbw==
X-IronPort-AV: E=McAfee;i="6000,8403,9815"; a="171230509"
X-IronPort-AV: E=Sophos;i="5.78,366,1599548400"; d="scan'208";a="171230509"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga007.jf.intel.com ([10.7.209.58])
 by fmsmga103.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 24 Nov 2020 12:11:58 -0800
IronPort-SDR: XTf+zHIitVsQaypG4UgGl4E6GCGriS8V6i1CP6rwRquYbqbREjo6hf9lRdN+ekGtzakUR8gEgZ
 cbKnRFtCaljg==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.78,366,1599548400"; d="scan'208";a="370478740"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.174])
 by orsmga007.jf.intel.com with SMTP; 24 Nov 2020 12:11:56 -0800
Received: by stinkbox (sSMTP sendmail emulation);
 Tue, 24 Nov 2020 22:11:56 +0200
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 24 Nov 2020 22:11:53 +0200
Message-Id: <20201124201156.17095-1-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.26.2
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 1/4] drm/i915: Track logically enabled planes
 for hw state
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KCkN1
cnJlbnRseSBjcnRjX3N0YXRlLT51YXBpLnBsYW5lX21hc2sgb25seSB0cmFja3MgbG9naWNhbGx5
CmVuYWJsZWQgcGxhbmVzIG9uIHRoZSB1YXBpIGxldmVsLiBGb3IgYmlnam9pbmVyIHB1cnBvc2Vz
CndlIHdhbnQgdG8gZG8gdGhlIHNhbWUgZm9yIHRoZSBodyBzdGF0ZS4gTGV0J3MgZm9sbG93IHRo
ZQpwYXR0ZXJuIGVzdGFibGlzaGVkIGJ5IGFjdGl2ZV9wbGFuZXMgJiBjby4gaGVyZS4KClNpZ25l
ZC1vZmYtYnk6IFZpbGxlIFN5cmrDpGzDpCA8dmlsbGUuc3lyamFsYUBsaW51eC5pbnRlbC5jb20+
Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9taWNfcGxhbmUuYyAg
fCAgMyArKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jICAg
ICAgIHwgMTMgKysrKysrKysrLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9kaXNwbGF5X3R5cGVzLmggfCAgNSArKysrLQogMyBmaWxlcyBjaGFuZ2VkLCAxNiBpbnNlcnRp
b25zKCspLCA1IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfYXRvbWljX3BsYW5lLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2F0b21pY19wbGFuZS5jCmluZGV4IDdlOWY4NGIwMDg1OS4uYjVlMWVlOTk1MzVj
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0b21pY19w
bGFuZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWljX3Bs
YW5lLmMKQEAgLTMxMiwxMCArMzEyLDEzIEBAIGludCBpbnRlbF9wbGFuZV9hdG9taWNfY2hlY2tf
d2l0aF9zdGF0ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfCiAJaW50
IHJldDsKIAogCWludGVsX3BsYW5lX3NldF9pbnZpc2libGUobmV3X2NydGNfc3RhdGUsIG5ld19w
bGFuZV9zdGF0ZSk7CisJbmV3X2NydGNfc3RhdGUtPmVuYWJsZWRfcGxhbmVzICY9IH5CSVQocGxh
bmUtPmlkKTsKIAogCWlmICghbmV3X3BsYW5lX3N0YXRlLT5ody5jcnRjICYmICFvbGRfcGxhbmVf
c3RhdGUtPmh3LmNydGMpCiAJCXJldHVybiAwOwogCisJbmV3X2NydGNfc3RhdGUtPmVuYWJsZWRf
cGxhbmVzIHw9IEJJVChwbGFuZS0+aWQpOworCiAJcmV0ID0gcGxhbmUtPmNoZWNrX3BsYW5lKG5l
d19jcnRjX3N0YXRlLCBuZXdfcGxhbmVfc3RhdGUpOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXku
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCmluZGV4IDU5
NTE4M2Y3YjYwZi4uMDY4ODkyZTRkMmYwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2Rpc3BsYXkuYwpAQCAtMzU1MSw3ICszNTUxLDcgQEAgaW50ZWxfc2V0X3BsYW5l
X3Zpc2libGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCWNydGNfc3Rh
dGUtPnVhcGkucGxhbmVfbWFzayAmPSB+ZHJtX3BsYW5lX21hc2soJnBsYW5lLT5iYXNlKTsKIH0K
IAotc3RhdGljIHZvaWQgZml4dXBfYWN0aXZlX3BsYW5lcyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSkKK3N0YXRpYyB2b2lkIGZpeHVwX3BsYW5lX2JpdG1hc2tzKHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjLT5kZXYpOwogCXN0cnVj
dCBkcm1fcGxhbmUgKnBsYW5lOwpAQCAtMzU2MSwxMSArMzU2MSwxNCBAQCBzdGF0aWMgdm9pZCBm
aXh1cF9hY3RpdmVfcGxhbmVzKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQog
CSAqIGhhdmUgYmVlbiB1c2VkIG9uIHRoZSBzYW1lIChvciB3cm9uZykgcGlwZS4gcGxhbmVfbWFz
ayB1c2VzCiAJICogdW5pcXVlIGlkcywgaGVuY2Ugd2UgY2FuIHVzZSB0aGF0IHRvIHJlY29uc3Ry
dWN0IGFjdGl2ZV9wbGFuZXMuCiAJICovCisJY3J0Y19zdGF0ZS0+ZW5hYmxlZF9wbGFuZXMgPSAw
OwogCWNydGNfc3RhdGUtPmFjdGl2ZV9wbGFuZXMgPSAwOwogCiAJZHJtX2Zvcl9lYWNoX3BsYW5l
X21hc2socGxhbmUsICZkZXZfcHJpdi0+ZHJtLAotCQkJCWNydGNfc3RhdGUtPnVhcGkucGxhbmVf
bWFzaykKKwkJCQljcnRjX3N0YXRlLT51YXBpLnBsYW5lX21hc2spIHsKKwkJY3J0Y19zdGF0ZS0+
ZW5hYmxlZF9wbGFuZXMgfD0gQklUKHRvX2ludGVsX3BsYW5lKHBsYW5lKS0+aWQpOwogCQljcnRj
X3N0YXRlLT5hY3RpdmVfcGxhbmVzIHw9IEJJVCh0b19pbnRlbF9wbGFuZShwbGFuZSktPmlkKTsK
Kwl9CiB9CiAKIHN0YXRpYyB2b2lkIGludGVsX3BsYW5lX2Rpc2FibGVfbm9hdG9taWMoc3RydWN0
IGludGVsX2NydGMgKmNydGMsCkBAIC0zNTgzLDcgKzM1ODYsNyBAQCBzdGF0aWMgdm9pZCBpbnRl
bF9wbGFuZV9kaXNhYmxlX25vYXRvbWljKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAogCQkgICAg
Y3J0Yy0+YmFzZS5iYXNlLmlkLCBjcnRjLT5iYXNlLm5hbWUpOwogCiAJaW50ZWxfc2V0X3BsYW5l
X3Zpc2libGUoY3J0Y19zdGF0ZSwgcGxhbmVfc3RhdGUsIGZhbHNlKTsKLQlmaXh1cF9hY3RpdmVf
cGxhbmVzKGNydGNfc3RhdGUpOworCWZpeHVwX3BsYW5lX2JpdG1hc2tzKGNydGNfc3RhdGUpOwog
CWNydGNfc3RhdGUtPmRhdGFfcmF0ZVtwbGFuZS0+aWRdID0gMDsKIAljcnRjX3N0YXRlLT5taW5f
Y2RjbGtbcGxhbmUtPmlkXSA9IDA7CiAKQEAgLTEyODQyLDYgKzEyODQ1LDcgQEAgc3RhdGljIGlu
dCBpY2xfY2hlY2tfbnYxMl9wbGFuZXMoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUpCiAKIAkJcGxhbmVfc3RhdGUtPnBsYW5hcl9saW5rZWRfcGxhbmUgPSBOVUxMOwogCQlpZiAo
cGxhbmVfc3RhdGUtPnBsYW5hcl9zbGF2ZSAmJiAhcGxhbmVfc3RhdGUtPnVhcGkudmlzaWJsZSkg
eworCQkJY3J0Y19zdGF0ZS0+ZW5hYmxlZF9wbGFuZXMgJj0gfkJJVChwbGFuZS0+aWQpOwogCQkJ
Y3J0Y19zdGF0ZS0+YWN0aXZlX3BsYW5lcyAmPSB+QklUKHBsYW5lLT5pZCk7CiAJCQljcnRjX3N0
YXRlLT51cGRhdGVfcGxhbmVzIHw9IEJJVChwbGFuZS0+aWQpOwogCQl9CkBAIC0xMjg4NSw2ICsx
Mjg4OSw3IEBAIHN0YXRpYyBpbnQgaWNsX2NoZWNrX252MTJfcGxhbmVzKHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlKQogCiAJCWxpbmtlZF9zdGF0ZS0+cGxhbmFyX3NsYXZlID0g
dHJ1ZTsKIAkJbGlua2VkX3N0YXRlLT5wbGFuYXJfbGlua2VkX3BsYW5lID0gcGxhbmU7CisJCWNy
dGNfc3RhdGUtPmVuYWJsZWRfcGxhbmVzIHw9IEJJVChsaW5rZWQtPmlkKTsKIAkJY3J0Y19zdGF0
ZS0+YWN0aXZlX3BsYW5lcyB8PSBCSVQobGlua2VkLT5pZCk7CiAJCWNydGNfc3RhdGUtPnVwZGF0
ZV9wbGFuZXMgfD0gQklUKGxpbmtlZC0+aWQpOwogCQlkcm1fZGJnX2ttcygmZGV2X3ByaXYtPmRy
bSwgIlVzaW5nICVzIGFzIFkgcGxhbmUgZm9yICVzXG4iLApAQCAtMTkxNjUsNyArMTkxNzAsNyBA
QCBzdGF0aWMgdm9pZCByZWFkb3V0X3BsYW5lX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKIAkJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUgPQogCQkJ
dG9faW50ZWxfY3J0Y19zdGF0ZShjcnRjLT5iYXNlLnN0YXRlKTsKIAotCQlmaXh1cF9hY3RpdmVf
cGxhbmVzKGNydGNfc3RhdGUpOworCQlmaXh1cF9wbGFuZV9iaXRtYXNrcyhjcnRjX3N0YXRlKTsK
IAl9CiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZGlzcGxheV90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNw
bGF5X3R5cGVzLmgKaW5kZXggY2U4MmQ2NTRkMGYyLi5jOTNjZjNkZGViYjYgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oCkBAIC0x
MDQ3LDcgKzEwNDcsMTAgQEAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgewogCQl1MzIgY2dtX21v
ZGU7CiAJfTsKIAotCS8qIGJpdG1hc2sgb2YgdmlzaWJsZSBwbGFuZXMgKGVudW0gcGxhbmVfaWQp
ICovCisJLyogYml0bWFzayBvZiBsb2dpY2FsbHkgZW5hYmxlZCBwbGFuZXMgKGVudW0gcGxhbmVf
aWQpICovCisJdTggZW5hYmxlZF9wbGFuZXM7CisKKwkvKiBiaXRtYXNrIG9mIGFjdHVhbGx5IHZp
c2libGUgcGxhbmVzIChlbnVtIHBsYW5lX2lkKSAqLwogCXU4IGFjdGl2ZV9wbGFuZXM7CiAJdTgg
bnYxMl9wbGFuZXM7CiAJdTggYzhfcGxhbmVzOwotLSAKMi4yNi4yCgpfX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0Cklu
dGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5v
cmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZngK

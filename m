Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 4A9BF17338
	for <lists+intel-gfx@lfdr.de>; Wed,  8 May 2019 10:09:21 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 4DE8789598;
	Wed,  8 May 2019 08:09:15 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9EC32894FF
 for <intel-gfx@lists.freedesktop.org>; Wed,  8 May 2019 08:09:12 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16485939-1500050 
 for multiple; Wed, 08 May 2019 09:07:13 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed,  8 May 2019 09:07:03 +0100
Message-Id: <20190508080704.24223-39-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190508080704.24223-1-chris@chris-wilson.co.uk>
References: <20190508080704.24223-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 39/40] drm/i915/execlists: Preempt-to-busy
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

V2hlbiB1c2luZyBhIGdsb2JhbCBzZXFubywgd2UgcmVxdWlyZWQgYSBwcmVjaXNlIHN0b3AtdGhl
LXdvcmtkIGV2ZW50IHRvCmhhbmRsZSBwcmVlbXB0aW9uIGFuZCB1bndpbmQgdGhlIGdsb2JhbCBz
ZXFubyBjb3VudGVyLiBUbyBhY2NvbXBsaXNoCnRoaXMsIHdlIHdvdWxkIHByZWVtcHQgdG8gYSBz
cGVjaWFsIG91dC1vZi1iYW5kIGNvbnRleHQgYW5kIHdhaXQgZm9yIHRoZQptYWNoaW5lIHRvIHJl
cG9ydCB0aGF0IGl0IHdhcyBpZGxlLiBHaXZlbiBhbiBpZGxlIG1hY2hpbmUsIHdlIGNvdWxkIHZl
cnkKcHJlY2lzZWx5IHNlZSB3aGljaCByZXF1ZXN0cyBoYWQgY29tcGxldGVkIGFuZCB3aGljaCB3
ZSBuZWVkZWQgdG8gZmVlZApiYWNrIGludG8gdGhlIHJ1biBxdWV1ZS4KCkhvd2V2ZXIsIG5vdyB0
aGF0IHdlIGhhdmUgc2NyYXBwZWQgdGhlIGdsb2JhbCBzZXFubywgd2Ugbm8gbG9uZ2VyIG5lZWQK
dG8gcHJlY2lzZWx5IHVud2luZCB0aGUgZ2xvYmFsIGNvdW50ZXIgYW5kIG9ubHkgdHJhY2sgcmVx
dWVzdHMgYnkgdGhlaXIKcGVyLWNvbnRleHQgc2Vxbm8uIFRoaXMgYWxsb3dzIHVzIHRvIGxvb3Nl
bHkgdW53aW5kIGluZmxpZ2h0IHJlcXVlc3RzCndoaWxlIHNjaGVkdWxpbmcgYSBwcmVlbXB0aW9u
LCB3aXRoIHRoZSBlbm9ybW91cyBjYXZlYXQgdGhhdCB0aGUKcmVxdWVzdHMgd2UgcHV0IGJhY2sg
b24gdGhlIHJ1biBxdWV1ZSBhcmUgc3RpbGwgX2luZmxpZ2h0XyAodW50aWwgdGhlCnByZWVtcHRp
b24gcmVxdWVzdCBpcyBjb21wbGV0ZSkuIFRoaXMgbWFrZXMgcmVxdWVzdCB0cmFja2luZyBtdWNo
IG1vcmUKbWVzc3ksIGFzIGF0IGFueSBwb2ludCB0aGVuIHdlIGNhbiBzZWUgYSBjb21wbGV0ZWQg
cmVxdWVzdCB0aGF0IHdlCmJlbGlldmUgaXMgbm90IGN1cnJlbnRseSBzY2hlZHVsZWQgZm9yIGV4
ZWN1dGlvbi4gV2UgYWxzbyBoYXZlIHRvIGJlCmNhcmVmdWwgbm90IHRvIHJld2luZCBSSU5HX1RB
SUwgcGFzdCBSSU5HX0hFQUQgb24gcHJlZW1wdGluZyB0byB0aGUKcnVubmluZyBjb250ZXh0LCBh
bmQgZm9yIHRoaXMgd2UgdXNlIGEgc2VtYXBob3JlIHRvIHByZXZlbnQgY29tcGxldGlvbgpvZiB0
aGUgcmVxdWVzdCBiZWZvcmUgY29udGludWluZy4KClRvIGFjY29tcGxpc2ggdGhpcyBmZWF0LCB3
ZSBjaGFuZ2UgaG93IHdlIHRyYWNrIHJlcXVlc3RzIHNjaGVkdWxlZCB0bwp0aGUgSFcuIEluc3Rl
YWQgb2YgYXBwZW5kaW5nIG91ciByZXF1ZXN0cyBvbnRvIGEgc2luZ2xlIGxpc3QgYXMgd2UKc3Vi
bWl0LCB3ZSB0cmFjayBlYWNoIHN1Ym1pc3Npb24gdG8gRUxTUCBhcyBpdHMgb3duIGJsb2NrLiBU
aGVuIHVwb24KcmVjZWl2aW5nIHRoZSBDUyBwcmVlbXB0aW9uIGV2ZW50LCB3ZSBwcm9tb3RlIHRo
ZSBwZW5kaW5nIGJsb2NrIHRvIHRoZQppbmZsaWdodCBibG9jayAoZGlzY2FyZGluZyB3aGF0IHdh
cyBwcmV2aW91c2x5IGJlaW5nIHRyYWNrZWQpLiBBcyBub3JtYWwKQ1MgY29tcGxldGlvbiBldmVu
dHMgYXJyaXZlLCB3ZSB0aGVuIHJlbW92ZSBzdGFsZSBlbnRyaWVzIGZyb20gdGhlCmluZmxpZ2h0
IHRyYWNrZXIuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNv
bi5jby51az4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5j
ICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHRfdHlwZXMu
aCB8ICAgNSArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaCAgICAgICAg
fCAgNjEgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jICAgICB8
ICA2MSArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmggIHwg
IDUyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyAgICAgICAgICAgfCA2
ODQgKysrKysrKystLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJv
ci5jICAgICAgICAgfCAgMTkgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5j
ICAgICAgICAgICB8ICAgNiArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuaCAg
ICAgICAgICAgfCAgIDEgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zY2hlZHVsZXIuYyAg
ICAgICAgIHwgICAzICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3V0aWxzLmggICAgICAg
ICAgICAgfCAgMTIgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX3N1Ym1pc3Npb24u
YyAgIHwgMTc1ICsrLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9yZXF1
ZXN0LmMgfCAgIDggKy0KIDEzIGZpbGVzIGNoYW5nZWQsIDQ3NSBpbnNlcnRpb25zKCspLCA2MTQg
ZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0
LmMKaW5kZXggYWEyYmQxZDZjZWI2Li4wZjExYzU3MWJiMDQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYwpAQCAtNjQyLDcgKzY0Miw3IEBAIHN0YXRpYyB2
b2lkIGluaXRfY29udGV4dHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAKIHN0YXRp
YyBib29sIG5lZWRzX3ByZWVtcHRfY29udGV4dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKIHsKLQlyZXR1cm4gSEFTX0VYRUNMSVNUUyhpOTE1KTsKKwlyZXR1cm4gVVNFU19HVUNfU1VC
TUlTU0lPTihpOTE1KTsKIH0KIAogaW50IGk5MTVfZ2VtX2NvbnRleHRzX2luaXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfY29udGV4dF90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfY29udGV4dF90eXBlcy5oCmluZGV4IGU5NWJlNGJlOTYxMi4uYjU2NWMzZmY0Mzc4IDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0X3R5cGVzLmgKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dF90eXBlcy5oCkBAIC0xMyw2
ICsxMyw3IEBACiAjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KIAogI2luY2x1ZGUgImk5MTVfYWN0
aXZlX3R5cGVzLmgiCisjaW5jbHVkZSAiaTkxNV91dGlscy5oIgogI2luY2x1ZGUgImludGVsX2Vu
Z2luZV90eXBlcy5oIgogI2luY2x1ZGUgImludGVsX3NzZXUuaCIKIApAQCAtMzgsNiArMzksMTAg
QEAgc3RydWN0IGludGVsX2NvbnRleHQgewogCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpnZW1f
Y29udGV4dDsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CiAJc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqaW5mbGlnaHQ7CisjZGVmaW5lIGludGVsX2NvbnRleHRfaW5mbGlnaHQoY2Up
IHB0cl9tYXNrX2JpdHMoKGNlKS0+aW5mbGlnaHQsIDIpCisjZGVmaW5lIGludGVsX2NvbnRleHRf
aW5mbGlnaHRfY291bnQoY2UpICBwdHJfdW5tYXNrX2JpdHMoKGNlKS0+aW5mbGlnaHQsIDIpCisj
ZGVmaW5lIGludGVsX2NvbnRleHRfaW5mbGlnaHRfaW5jKGNlKSBwdHJfY291bnRfaW5jKCYoY2Up
LT5pbmZsaWdodCkKKyNkZWZpbmUgaW50ZWxfY29udGV4dF9pbmZsaWdodF9kZWMoY2UpIHB0cl9j
b3VudF9kZWMoJihjZSktPmluZmxpZ2h0KQogCiAJc3RydWN0IGxpc3RfaGVhZCBzaWduYWxfbGlu
azsKIAlzdHJ1Y3QgbGlzdF9oZWFkIHNpZ25hbHM7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2VuZ2luZS5oCmluZGV4IGI4ZjVjNGUxZDM5ZS4uMTJiMTliMTdlOWIwIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaAorKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaApAQCAtMTA2LDcxICsxMDYsMjYgQEAgaGFuZ2NoZWNr
X2FjdGlvbl90b19zdHIoY29uc3QgZW51bSBpbnRlbF9lbmdpbmVfaGFuZ2NoZWNrX2FjdGlvbiBh
KQogCiB2b2lkIGludGVsX2VuZ2luZXNfc2V0X3NjaGVkdWxlcl9jYXBzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KTsKIAotc3RhdGljIGlubGluZSB2b2lkCi1leGVjbGlzdHNfc2V0X2Fj
dGl2ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAqZXhlY2xpc3RzLAotCQkgICAgIHVu
c2lnbmVkIGludCBiaXQpCi17Ci0JX19zZXRfYml0KGJpdCwgKHVuc2lnbmVkIGxvbmcgKikmZXhl
Y2xpc3RzLT5hY3RpdmUpOwotfQotCi1zdGF0aWMgaW5saW5lIGJvb2wKLWV4ZWNsaXN0c19zZXRf
YWN0aXZlX29uY2Uoc3RydWN0IGludGVsX2VuZ2luZV9leGVjbGlzdHMgKmV4ZWNsaXN0cywKLQkJ
CSAgdW5zaWduZWQgaW50IGJpdCkKLXsKLQlyZXR1cm4gIV9fdGVzdF9hbmRfc2V0X2JpdChiaXQs
ICh1bnNpZ25lZCBsb25nICopJmV4ZWNsaXN0cy0+YWN0aXZlKTsKLX0KLQotc3RhdGljIGlubGlu
ZSB2b2lkCi1leGVjbGlzdHNfY2xlYXJfYWN0aXZlKHN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xp
c3RzICpleGVjbGlzdHMsCi0JCSAgICAgICB1bnNpZ25lZCBpbnQgYml0KQotewotCV9fY2xlYXJf
Yml0KGJpdCwgKHVuc2lnbmVkIGxvbmcgKikmZXhlY2xpc3RzLT5hY3RpdmUpOwotfQotCi1zdGF0
aWMgaW5saW5lIHZvaWQKLWV4ZWNsaXN0c19jbGVhcl9hbGxfYWN0aXZlKHN0cnVjdCBpbnRlbF9l
bmdpbmVfZXhlY2xpc3RzICpleGVjbGlzdHMpCitzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGludAor
ZXhlY2xpc3RzX251bV9wb3J0cyhjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAq
IGNvbnN0IGV4ZWNsaXN0cykKIHsKLQlleGVjbGlzdHMtPmFjdGl2ZSA9IDA7CisJcmV0dXJuIGV4
ZWNsaXN0cy0+cG9ydF9tYXNrICsgMTsKIH0KIAotc3RhdGljIGlubGluZSBib29sCi1leGVjbGlz
dHNfaXNfYWN0aXZlKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3RzICpleGVjbGlz
dHMsCi0JCSAgICB1bnNpZ25lZCBpbnQgYml0KQorc3RhdGljIGlubGluZSBzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICoKK2V4ZWNsaXN0c19hY3RpdmUoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9leGVj
bGlzdHMgKmV4ZWNsaXN0cykKIHsKLQlyZXR1cm4gdGVzdF9iaXQoYml0LCAodW5zaWduZWQgbG9u
ZyAqKSZleGVjbGlzdHMtPmFjdGl2ZSk7CisJR0VNX0JVR19PTihleGVjbGlzdHMtPmFjdGl2ZSAt
IGV4ZWNsaXN0cy0+aW5mbGlnaHQgPgorCQkgICBleGVjbGlzdHNfbnVtX3BvcnRzKGV4ZWNsaXN0
cykpOworCXJldHVybiBSRUFEX09OQ0UoKmV4ZWNsaXN0cy0+YWN0aXZlKTsKIH0KIAotdm9pZCBl
eGVjbGlzdHNfdXNlcl9iZWdpbihzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAqZXhlY2xp
c3RzLAotCQkJICBjb25zdCBzdHJ1Y3QgZXhlY2xpc3RfcG9ydCAqcG9ydCk7Ci12b2lkIGV4ZWNs
aXN0c191c2VyX2VuZChzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAqZXhlY2xpc3RzKTsK
LQogdm9pZAogZXhlY2xpc3RzX2NhbmNlbF9wb3J0X3JlcXVlc3RzKHN0cnVjdCBpbnRlbF9lbmdp
bmVfZXhlY2xpc3RzICogY29uc3QgZXhlY2xpc3RzKTsKIAogc3RydWN0IGk5MTVfcmVxdWVzdCAq
CiBleGVjbGlzdHNfdW53aW5kX2luY29tcGxldGVfcmVxdWVzdHMoc3RydWN0IGludGVsX2VuZ2lu
ZV9leGVjbGlzdHMgKmV4ZWNsaXN0cyk7CiAKLXN0YXRpYyBpbmxpbmUgdW5zaWduZWQgaW50Ci1l
eGVjbGlzdHNfbnVtX3BvcnRzKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3RzICog
Y29uc3QgZXhlY2xpc3RzKQotewotCXJldHVybiBleGVjbGlzdHMtPnBvcnRfbWFzayArIDE7Ci19
Ci0KLXN0YXRpYyBpbmxpbmUgc3RydWN0IGV4ZWNsaXN0X3BvcnQgKgotZXhlY2xpc3RzX3BvcnRf
Y29tcGxldGUoc3RydWN0IGludGVsX2VuZ2luZV9leGVjbGlzdHMgKiBjb25zdCBleGVjbGlzdHMs
Ci0JCQlzdHJ1Y3QgZXhlY2xpc3RfcG9ydCAqIGNvbnN0IHBvcnQpCi17Ci0JY29uc3QgdW5zaWdu
ZWQgaW50IG0gPSBleGVjbGlzdHMtPnBvcnRfbWFzazsKLQotCUdFTV9CVUdfT04ocG9ydF9pbmRl
eChwb3J0LCBleGVjbGlzdHMpICE9IDApOwotCUdFTV9CVUdfT04oIWV4ZWNsaXN0c19pc19hY3Rp
dmUoZXhlY2xpc3RzLCBFWEVDTElTVFNfQUNUSVZFX1VTRVIpKTsKLQotCW1lbW1vdmUocG9ydCwg
cG9ydCArIDEsIG0gKiBzaXplb2Yoc3RydWN0IGV4ZWNsaXN0X3BvcnQpKTsKLQltZW1zZXQocG9y
dCArIG0sIDAsIHNpemVvZihzdHJ1Y3QgZXhlY2xpc3RfcG9ydCkpOwotCi0JcmV0dXJuIHBvcnQ7
Ci19Ci0KIHN0YXRpYyBpbmxpbmUgdTMyCiBpbnRlbF9yZWFkX3N0YXR1c19wYWdlKGNvbnN0IHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgaW50IHJlZykKIHsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKaW5kZXggZjJlMjg1MTA0MzNiLi4yNjFjZWVmNWY0
ZmQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jCkBAIC00NTgs
NiArNDU4LDEwIEBAIHZvaWQgaW50ZWxfZW5naW5lX2luaXRfZXhlY2xpc3RzKHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSkKIAlHRU1fQlVHX09OKCFpc19wb3dlcl9vZl8yKGV4ZWNsaXN0
c19udW1fcG9ydHMoZXhlY2xpc3RzKSkpOwogCUdFTV9CVUdfT04oZXhlY2xpc3RzX251bV9wb3J0
cyhleGVjbGlzdHMpID4gRVhFQ0xJU1RfTUFYX1BPUlRTKTsKIAorCW1lbXNldChleGVjbGlzdHMt
PnBlbmRpbmcsIDAsIHNpemVvZihleGVjbGlzdHMtPnBlbmRpbmcpKTsKKwlleGVjbGlzdHMtPmFj
dGl2ZSA9CisJCW1lbXNldChleGVjbGlzdHMtPmluZmxpZ2h0LCAwLCBzaXplb2YoZXhlY2xpc3Rz
LT5pbmZsaWdodCkpOworCiAJZXhlY2xpc3RzLT5xdWV1ZV9wcmlvcml0eV9oaW50ID0gSU5UX01J
TjsKIAlleGVjbGlzdHMtPnF1ZXVlID0gUkJfUk9PVF9DQUNIRUQ7CiB9CkBAIC0xMTAxLDcgKzEx
MDUsNyBAQCBib29sIGludGVsX2VuZ2luZV9pc19pZGxlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSkKIAkJcmV0dXJuIHRydWU7CiAKIAkvKiBXYWl0aW5nIHRvIGRyYWluIEVMU1A/ICov
Ci0JaWYgKFJFQURfT05DRShlbmdpbmUtPmV4ZWNsaXN0cy5hY3RpdmUpKSB7CisJaWYgKGV4ZWNs
aXN0c19hY3RpdmUoJmVuZ2luZS0+ZXhlY2xpc3RzKSkgewogCQlzdHJ1Y3QgdGFza2xldF9zdHJ1
Y3QgKnQgPSAmZW5naW5lLT5leGVjbGlzdHMudGFza2xldDsKIAogCQlzeW5jaHJvbml6ZV9oYXJk
aXJxKGVuZ2luZS0+aTkxNS0+ZHJtLmlycSk7CkBAIC0xMTE4LDcgKzExMjIsNyBAQCBib29sIGlu
dGVsX2VuZ2luZV9pc19pZGxlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAkJLyog
T3RoZXJ3aXNlIGZsdXNoIHRoZSB0YXNrbGV0IGlmIGl0IHdhcyBvbiBhbm90aGVyIGNwdSAqLwog
CQl0YXNrbGV0X3VubG9ja193YWl0KHQpOwogCi0JCWlmIChSRUFEX09OQ0UoZW5naW5lLT5leGVj
bGlzdHMuYWN0aXZlKSkKKwkJaWYgKGV4ZWNsaXN0c19hY3RpdmUoJmVuZ2luZS0+ZXhlY2xpc3Rz
KSkKIAkJCXJldHVybiBmYWxzZTsKIAl9CiAKQEAgLTEzMTUsNiArMTMxOSw3IEBAIHN0YXRpYyB2
b2lkIGludGVsX2VuZ2luZV9wcmludF9yZWdpc3RlcnMoY29uc3Qgc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lLAogCX0KIAogCWlmIChIQVNfRVhFQ0xJU1RTKGRldl9wcml2KSkgeworCQlz
dHJ1Y3QgaTkxNV9yZXF1ZXN0ICogY29uc3QgKnBvcnQsICpycTsKIAkJY29uc3QgdTMyICpod3Mg
PQogCQkJJmVuZ2luZS0+c3RhdHVzX3BhZ2UuYWRkcltJOTE1X0hXU19DU0JfQlVGMF9JTkRFWF07
CiAJCWNvbnN0IHU4IG51bV9lbnRyaWVzID0gZXhlY2xpc3RzLT5jc2Jfc2l6ZTsKQEAgLTEzNDcs
MjYgKzEzNTIsMjggQEAgc3RhdGljIHZvaWQgaW50ZWxfZW5naW5lX3ByaW50X3JlZ2lzdGVycyhj
b25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCiAJCX0KIAogCQlyY3VfcmVhZF9s
b2NrKCk7Ci0JCWZvciAoaWR4ID0gMDsgaWR4IDwgZXhlY2xpc3RzX251bV9wb3J0cyhleGVjbGlz
dHMpOyBpZHgrKykgewotCQkJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7Ci0JCQl1bnNpZ25lZCBp
bnQgY291bnQ7Ci0KLQkJCXJxID0gcG9ydF91bnBhY2soJmV4ZWNsaXN0cy0+cG9ydFtpZHhdLCAm
Y291bnQpOwotCQkJaWYgKHJxKSB7Ci0JCQkJY2hhciBoZHJbODBdOwotCi0JCQkJc25wcmludGYo
aGRyLCBzaXplb2YoaGRyKSwKLQkJCQkJICJcdFx0RUxTUFslZF0gY291bnQ9JWQsIHJpbmc6e3N0
YXJ0OiUwOHgsIGh3c3A6JTA4eCwgc2Vxbm86JTA4eH0sIHJxOiAiLAotCQkJCQkgaWR4LCBjb3Vu
dCwKLQkJCQkJIGk5MTVfZ2d0dF9vZmZzZXQocnEtPnJpbmctPnZtYSksCi0JCQkJCSBycS0+dGlt
ZWxpbmUtPmh3c3Bfb2Zmc2V0LAotCQkJCQkgaHdzcF9zZXFubyhycSkpOwotCQkJCXByaW50X3Jl
cXVlc3QobSwgcnEsIGhkcik7Ci0JCQl9IGVsc2UgewotCQkJCWRybV9wcmludGYobSwgIlx0XHRF
TFNQWyVkXSBpZGxlXG4iLCBpZHgpOwotCQkJfQorCQlmb3IgKHBvcnQgPSBleGVjbGlzdHMtPmFj
dGl2ZTsgKHJxID0gKnBvcnQpOyBwb3J0KyspIHsKKwkJCWNoYXIgaGRyWzgwXTsKKworCQkJc25w
cmludGYoaGRyLCBzaXplb2YoaGRyKSwKKwkJCQkgIlx0XHRBY3RpdmVbJWRdIHJpbmc6e3N0YXJ0
OiUwOHgsIGh3c3A6JTA4eCwgc2Vxbm86JTA4eH0sIHJxOiAiLAorCQkJCSAoaW50KShwb3J0IC0g
ZXhlY2xpc3RzLT5hY3RpdmUpLAorCQkJCSBpOTE1X2dndHRfb2Zmc2V0KHJxLT5yaW5nLT52bWEp
LAorCQkJCSBycS0+dGltZWxpbmUtPmh3c3Bfb2Zmc2V0LAorCQkJCSBod3NwX3NlcW5vKHJxKSk7
CisJCQlwcmludF9yZXF1ZXN0KG0sIHJxLCBoZHIpOworCQl9CisJCWZvciAocG9ydCA9IGV4ZWNs
aXN0cy0+cGVuZGluZzsgKHJxID0gKnBvcnQpOyBwb3J0KyspIHsKKwkJCWNoYXIgaGRyWzgwXTsK
KworCQkJc25wcmludGYoaGRyLCBzaXplb2YoaGRyKSwKKwkJCQkgIlx0XHRQZW5kaW5nWyVkXSBy
aW5nOntzdGFydDolMDh4LCBod3NwOiUwOHgsIHNlcW5vOiUwOHh9LCBycTogIiwKKwkJCQkgKGlu
dCkocG9ydCAtIGV4ZWNsaXN0cy0+cGVuZGluZyksCisJCQkJIGk5MTVfZ2d0dF9vZmZzZXQocnEt
PnJpbmctPnZtYSksCisJCQkJIHJxLT50aW1lbGluZS0+aHdzcF9vZmZzZXQsCisJCQkJIGh3c3Bf
c2Vxbm8ocnEpKTsKKwkJCXByaW50X3JlcXVlc3QobSwgcnEsIGhkcik7CiAJCX0KLQkJZHJtX3By
aW50ZihtLCAiXHRcdEhXIGFjdGl2ZT8gMHgleFxuIiwgZXhlY2xpc3RzLT5hY3RpdmUpOwogCQly
Y3VfcmVhZF91bmxvY2soKTsKIAl9IGVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPiA2KSB7
CiAJCWRybV9wcmludGYobSwgIlx0UFBfRElSX0JBU0U6IDB4JTA4eFxuIiwKQEAgLTE1MzAsMTUg
KzE1MzcsMTkgQEAgaW50IGludGVsX2VuYWJsZV9lbmdpbmVfc3RhdHMoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQogCX0KIAogCWlmIChlbmdpbmUtPnN0YXRzLmVuYWJsZWQrKyA9PSAw
KSB7Ci0JCWNvbnN0IHN0cnVjdCBleGVjbGlzdF9wb3J0ICpwb3J0ID0gZXhlY2xpc3RzLT5wb3J0
OwotCQl1bnNpZ25lZCBpbnQgbnVtX3BvcnRzID0gZXhlY2xpc3RzX251bV9wb3J0cyhleGVjbGlz
dHMpOworCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICogY29uc3QgKnBvcnQ7CisJCXN0cnVjdCBpOTE1
X3JlcXVlc3QgKnJxOwogCiAJCWVuZ2luZS0+c3RhdHMuZW5hYmxlZF9hdCA9IGt0aW1lX2dldCgp
OwogCiAJCS8qIFhYWCBzdWJtaXNzaW9uIG1ldGhvZCBvYmxpdmlvdXM/ICovCi0JCXdoaWxlIChu
dW1fcG9ydHMtLSAmJiBwb3J0X2lzc2V0KHBvcnQpKSB7CisJCWZvciAocG9ydCA9IGV4ZWNsaXN0
cy0+YWN0aXZlOyAocnEgPSAqcG9ydCk7IHBvcnQrKykKIAkJCWVuZ2luZS0+c3RhdHMuYWN0aXZl
Kys7Ci0JCQlwb3J0Kys7CisKKwkJZm9yIChwb3J0ID0gZXhlY2xpc3RzLT5wZW5kaW5nOyAocnEg
PSAqcG9ydCk7IHBvcnQrKykgeworCQkJLyogRXhjbHVkZSBhbnkgY29udGV4dHMgYWxyZWFkeSBj
b3VudGVkIGluIGFjdGl2ZSAqLworCQkJaWYgKGludGVsX2NvbnRleHRfaW5mbGlnaHRfY291bnQo
cnEtPmh3X2NvbnRleHQpID09IDEpCisJCQkJZW5naW5lLT5zdGF0cy5hY3RpdmUrKzsKIAkJfQog
CiAJCWlmIChlbmdpbmUtPnN0YXRzLmFjdGl2ZSkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfZW5naW5lX3R5cGVzLmgKaW5kZXggZTAwNDQzZjUzYjU5Li5kZTQzYmI2MmMyNGEgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oCkBAIC0xNjAs
NTEgKzE2MCwxMCBAQCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyB7CiAJICovCiAJdTMy
IF9faW9tZW0gKmN0cmxfcmVnOwogCi0JLyoqCi0JICogQHBvcnQ6IGV4ZWNsaXN0IHBvcnQgc3Rh
dGVzCi0JICoKLQkgKiBGb3IgZWFjaCBoYXJkd2FyZSBFTFNQIChFeGVjTGlzdCBTdWJtaXNzaW9u
IFBvcnQpIHdlIGtlZXAKLQkgKiB0cmFjayBvZiB0aGUgbGFzdCByZXF1ZXN0IGFuZCB0aGUgbnVt
YmVyIG9mIHRpbWVzIHdlIHN1Ym1pdHRlZAotCSAqIHRoYXQgcG9ydCB0byBody4gV2UgdGhlbiBj
b3VudCB0aGUgbnVtYmVyIG9mIHRpbWVzIHRoZSBodyByZXBvcnRzCi0JICogYSBjb250ZXh0IGNv
bXBsZXRpb24gb3IgcHJlZW1wdGlvbi4gQXMgb25seSBvbmUgY29udGV4dCBjYW4KLQkgKiBiZSBh
Y3RpdmUgb24gaHcsIHdlIGxpbWl0IHJlc3VibWlzc2lvbiBvZiBjb250ZXh0IHRvIHBvcnRbMF0u
IFRoaXMKLQkgKiBpcyBjYWxsZWQgTGl0ZSBSZXN0b3JlLCBvZiB0aGUgY29udGV4dC4KLQkgKi8K
LQlzdHJ1Y3QgZXhlY2xpc3RfcG9ydCB7Ci0JCS8qKgotCQkgKiBAcmVxdWVzdF9jb3VudDogY29t
YmluZWQgcmVxdWVzdCBhbmQgc3VibWlzc2lvbiBjb3VudAotCQkgKi8KLQkJc3RydWN0IGk5MTVf
cmVxdWVzdCAqcmVxdWVzdF9jb3VudDsKLSNkZWZpbmUgRVhFQ0xJU1RfQ09VTlRfQklUUyAyCi0j
ZGVmaW5lIHBvcnRfcmVxdWVzdChwKSBwdHJfbWFza19iaXRzKChwKS0+cmVxdWVzdF9jb3VudCwg
RVhFQ0xJU1RfQ09VTlRfQklUUykKLSNkZWZpbmUgcG9ydF9jb3VudChwKSBwdHJfdW5tYXNrX2Jp
dHMoKHApLT5yZXF1ZXN0X2NvdW50LCBFWEVDTElTVF9DT1VOVF9CSVRTKQotI2RlZmluZSBwb3J0
X3BhY2socnEsIGNvdW50KSBwdHJfcGFja19iaXRzKHJxLCBjb3VudCwgRVhFQ0xJU1RfQ09VTlRf
QklUUykKLSNkZWZpbmUgcG9ydF91bnBhY2socCwgY291bnQpIHB0cl91bnBhY2tfYml0cygocCkt
PnJlcXVlc3RfY291bnQsIGNvdW50LCBFWEVDTElTVF9DT1VOVF9CSVRTKQotI2RlZmluZSBwb3J0
X3NldChwLCBwYWNrZWQpICgocCktPnJlcXVlc3RfY291bnQgPSAocGFja2VkKSkKLSNkZWZpbmUg
cG9ydF9pc3NldChwKSAoKHApLT5yZXF1ZXN0X2NvdW50KQotI2RlZmluZSBwb3J0X2luZGV4KHAs
IGV4ZWNsaXN0cykgKChwKSAtIChleGVjbGlzdHMpLT5wb3J0KQotCi0JCS8qKgotCQkgKiBAY29u
dGV4dF9pZDogY29udGV4dCBJRCBmb3IgcG9ydAotCQkgKi8KLQkJR0VNX0RFQlVHX0RFQ0wodTMy
IGNvbnRleHRfaWQpOwotCiAjZGVmaW5lIEVYRUNMSVNUX01BWF9QT1JUUyAyCi0JfSBwb3J0W0VY
RUNMSVNUX01BWF9QT1JUU107Ci0KLQkvKioKLQkgKiBAYWN0aXZlOiBpcyB0aGUgSFcgYWN0aXZl
PyBXZSBjb25zaWRlciB0aGUgSFcgYXMgYWN0aXZlIGFmdGVyCi0JICogc3VibWl0dGluZyBhbnkg
Y29udGV4dCBmb3IgZXhlY3V0aW9uIGFuZCB1bnRpbCB3ZSBoYXZlIHNlZW4gdGhlCi0JICogbGFz
dCBjb250ZXh0IGNvbXBsZXRpb24gZXZlbnQuIEFmdGVyIHRoYXQsIHdlIGRvIG5vdCBleHBlY3Qg
YW55Ci0JICogbW9yZSBldmVudHMgdW50aWwgd2Ugc3VibWl0LCBhbmQgc28gY2FuIHBhcmsgdGhl
IEhXLgotCSAqCi0JICogQXMgd2UgaGF2ZSBhIHNtYWxsIG51bWJlciBvZiBkaWZmZXJlbnQgc291
cmNlcyBmcm9tIHdoaWNoIHdlIGZlZWQKLQkgKiB0aGUgSFcsIHdlIHRyYWNrIHRoZSBzdGF0ZSBv
ZiBlYWNoIGluc2lkZSBhIHNpbmdsZSBiaXRmaWVsZC4KLQkgKi8KLQl1bnNpZ25lZCBpbnQgYWN0
aXZlOwotI2RlZmluZSBFWEVDTElTVFNfQUNUSVZFX1VTRVIgMAotI2RlZmluZSBFWEVDTElTVFNf
QUNUSVZFX1BSRUVNUFQgMQotI2RlZmluZSBFWEVDTElTVFNfQUNUSVZFX0hXQUNLIDIKKwlzdHJ1
Y3QgaTkxNV9yZXF1ZXN0ICogY29uc3QgKmFjdGl2ZTsKKwlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpp
bmZsaWdodFtFWEVDTElTVF9NQVhfUE9SVFMgKyAxIC8qIHNlbnRpbmVsICovXTsKKwlzdHJ1Y3Qg
aTkxNV9yZXF1ZXN0ICpwZW5kaW5nW0VYRUNMSVNUX01BWF9QT1JUUyArIDFdOwogCiAJLyoqCiAJ
ICogQHBvcnRfbWFzazogbnVtYmVyIG9mIGV4ZWNsaXN0IHBvcnRzIC0gMQpAQCAtMjQ1LDExICsy
MDQsNiBAQCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyB7CiAJICovCiAJdTMyICpjc2Jf
c3RhdHVzOwogCi0JLyoqCi0JICogQHByZWVtcHRfY29tcGxldGVfc3RhdHVzOiBleHBlY3RlZCBD
U0IgdXBvbiBjb21wbGV0aW5nIHByZWVtcHRpb24KLQkgKi8KLQl1MzIgcHJlZW1wdF9jb21wbGV0
ZV9zdGF0dXM7Ci0KIAkvKioKIAkgKiBAY3NiX3NpemU6IGNvbnRleHQgc3RhdHVzIGJ1ZmZlciBG
SUZPIHNpemUKIAkgKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2xyYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKaW5kZXggZDM1MGNl
YWRmZmM1Li5mMDhjMmUyMjM4NzkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2xyYy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCkBA
IC0xNjEsNiArMTYxLDggQEAKICNkZWZpbmUgR0VOOF9DVFhfU1RBVFVTX0NPTVBMRVRFRF9NQVNL
IFwKIAkgKEdFTjhfQ1RYX1NUQVRVU19DT01QTEVURSB8IEdFTjhfQ1RYX1NUQVRVU19QUkVFTVBU
RUQpCiAKKyNkZWZpbmUgQ1RYX0RFU0NfRk9SQ0VfUkVTVE9SRSBCSVRfVUxMKDIpCisKIC8qIFR5
cGljYWwgc2l6ZSBvZiB0aGUgYXZlcmFnZSByZXF1ZXN0ICgyIHBpcGVjb250cm9scyBhbmQgYSBN
SV9CQikgKi8KICNkZWZpbmUgRVhFQ0xJU1RTX1JFUVVFU1RfU0laRSA2NCAvKiBieXRlcyAqLwog
I2RlZmluZSBXQV9UQUlMX0RXT1JEUyAyCkBAIC0yMjMsNiArMjI1LDE0IEBAIHN0YXRpYyB2b2lk
IGV4ZWNsaXN0c19pbml0X3JlZ19zdGF0ZSh1MzIgKnJlZ19zdGF0ZSwKIAkJCQkgICAgIHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAkJCQkgICAgIHN0cnVjdCBpbnRlbF9yaW5nICpy
aW5nKTsKIAorc3RhdGljIGlubGluZSB1MzIgaW50ZWxfaHdzX3ByZWVtcHRfYWRkcmVzcyhzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJcmV0dXJuIChpOTE1X2dndHRfb2Zmc2V0
KGVuZ2luZS0+c3RhdHVzX3BhZ2Uudm1hKSArCisJCUk5MTVfR0VNX0hXU19QUkVFTVBUX0FERFIp
OworfQorCisjZGVmaW5lIHJpbmdfc3VzcGVuZChFKSAoKEUpLT5zdGF0dXNfcGFnZS5hZGRyW0k5
MTVfR0VNX0hXU19QUkVFTVBUXSkKKwogc3RhdGljIGlubGluZSBzdHJ1Y3QgaTkxNV9wcmlvbGlz
dCAqdG9fcHJpb2xpc3Qoc3RydWN0IHJiX25vZGUgKnJiKQogewogCXJldHVybiByYl9lbnRyeShy
Yiwgc3RydWN0IGk5MTVfcHJpb2xpc3QsIG5vZGUpOwpAQCAtMjg0LDEyICsyOTQsNiBAQCBzdGF0
aWMgaW5saW5lIGJvb2wgbmVlZF9wcmVlbXB0KGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSwKIHsKIAlpbnQgbGFzdF9wcmlvOwogCi0JaWYgKCFlbmdpbmUtPnByZWVtcHRfY29u
dGV4dCkKLQkJcmV0dXJuIGZhbHNlOwotCi0JaWYgKGk5MTVfcmVxdWVzdF9jb21wbGV0ZWQocnEp
KQotCQlyZXR1cm4gZmFsc2U7Ci0KIAkvKgogCSAqIENoZWNrIGlmIHRoZSBjdXJyZW50IHByaW9y
aXR5IGhpbnQgbWVyaXRzIGEgcHJlZW1wdGlvbiBhdHRlbXB0LgogCSAqCkBAIC0zNTEsOSArMzU1
LDYgQEAgX19tYXliZV91bnVzZWQgc3RhdGljIGlubGluZSBib29sCiBhc3NlcnRfcHJpb3JpdHlf
cXVldWUoY29uc3Qgc3RydWN0IGk5MTVfcmVxdWVzdCAqcHJldiwKIAkJICAgICAgY29uc3Qgc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqbmV4dCkKIHsKLQljb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4
ZWNsaXN0cyAqZXhlY2xpc3RzID0KLQkJJnByZXYtPmVuZ2luZS0+ZXhlY2xpc3RzOwotCiAJLyoK
IAkgKiBXaXRob3V0IHByZWVtcHRpb24sIHRoZSBwcmV2IG1heSByZWZlciB0byB0aGUgc3RpbGwg
YWN0aXZlIGVsZW1lbnQKIAkgKiB3aGljaCB3ZSByZWZ1c2UgdG8gbGV0IGdvLgpAQCAtMzYxLDcg
KzM2Miw3IEBAIGFzc2VydF9wcmlvcml0eV9xdWV1ZShjb25zdCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0
ICpwcmV2LAogCSAqIEV2ZW4gd2l0aCBwcmVlbXB0aW9uLCB0aGVyZSBhcmUgdGltZXMgd2hlbiB3
ZSB0aGluayBpdCBpcyBiZXR0ZXIgbm90CiAJICogdG8gcHJlZW1wdCBhbmQgbGVhdmUgYW4gb3N0
ZW5zaWJseSBsb3dlciBwcmlvcml0eSByZXF1ZXN0IGluIGZsaWdodC4KIAkgKi8KLQlpZiAocG9y
dF9yZXF1ZXN0KGV4ZWNsaXN0cy0+cG9ydCkgPT0gcHJldikKKwlpZiAoaTkxNV9yZXF1ZXN0X2lz
X2FjdGl2ZShwcmV2KSkKIAkJcmV0dXJuIHRydWU7CiAKIAlyZXR1cm4gcnFfcHJpbyhwcmV2KSA+
PSBycV9wcmlvKG5leHQpOwpAQCAtNDU1LDEzICs0NTYsMTEgQEAgX191bndpbmRfaW5jb21wbGV0
ZV9yZXF1ZXN0cyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIGludCBib29zdCkKIAkJ
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqb3duZXI7CiAKIAkJaWYgKGk5MTVfcmVxdWVzdF9jb21w
bGV0ZWQocnEpKQotCQkJYnJlYWs7CisJCQljb250aW51ZTsgLyogWFhYICovCiAKIAkJX19pOTE1
X3JlcXVlc3RfdW5zdWJtaXQocnEpOwogCQl1bndpbmRfd2FfdGFpbChycSk7CiAKLQkJR0VNX0JV
R19PTihycS0+aHdfY29udGV4dC0+aW5mbGlnaHQpOwotCiAJCS8qCiAJCSAqIFB1c2ggdGhlIHJl
cXVlc3QgYmFjayBpbnRvIHRoZSBxdWV1ZSBmb3IgbGF0ZXIgcmVzdWJtaXNzaW9uLgogCQkgKiBJ
ZiB0aGlzIHJlcXVlc3QgaXMgbm90IG5hdGl2ZSB0byB0aGlzIHBoeXNpY2FsIGVuZ2luZSAoaS5l
LgpAQCAtNTQxLDMyICs1NDAsMzIgQEAgZXhlY2xpc3RzX2NvbnRleHRfc3RhdHVzX2NoYW5nZShz
dHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgdW5zaWduZWQgbG9uZyBzdGF0dXMpCiAJCQkJICAgc3Rh
dHVzLCBycSk7CiB9CiAKLWlubGluZSB2b2lkCi1leGVjbGlzdHNfdXNlcl9iZWdpbihzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAqZXhlY2xpc3RzLAotCQkgICAgIGNvbnN0IHN0cnVjdCBl
eGVjbGlzdF9wb3J0ICpwb3J0KQorc3RhdGljIGlubGluZSBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICoK
K2V4ZWNsaXN0c19zY2hlZHVsZV9pbihzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgaW50IGlkeCkK
IHsKLQlleGVjbGlzdHNfc2V0X2FjdGl2ZV9vbmNlKGV4ZWNsaXN0cywgRVhFQ0xJU1RTX0FDVElW
RV9VU0VSKTsKLX0KKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UgPSBycS0+aHdfY29udGV4dDsK
KwlpbnQgY291bnQ7CiAKLWlubGluZSB2b2lkCi1leGVjbGlzdHNfdXNlcl9lbmQoc3RydWN0IGlu
dGVsX2VuZ2luZV9leGVjbGlzdHMgKmV4ZWNsaXN0cykKLXsKLQlleGVjbGlzdHNfY2xlYXJfYWN0
aXZlKGV4ZWNsaXN0cywgRVhFQ0xJU1RTX0FDVElWRV9VU0VSKTsKLX0KKwl0cmFjZV9pOTE1X3Jl
cXVlc3RfaW4ocnEsIGlkeCk7CiAKLXN0YXRpYyBpbmxpbmUgdm9pZAotZXhlY2xpc3RzX2NvbnRl
eHRfc2NoZWR1bGVfaW4oc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCi17Ci0JR0VNX0JVR19PTihy
cS0+aHdfY29udGV4dC0+aW5mbGlnaHQpOworCWNvdW50ID0gaW50ZWxfY29udGV4dF9pbmZsaWdo
dF9jb3VudChjZSk7CisJaWYgKCFjb3VudCkgeworCQlpbnRlbF9jb250ZXh0X2dldChjZSk7CisJ
CWNlLT5pbmZsaWdodCA9IHJxLT5lbmdpbmU7CisKKwkJZXhlY2xpc3RzX2NvbnRleHRfc3RhdHVz
X2NoYW5nZShycSwgSU5URUxfQ09OVEVYVF9TQ0hFRFVMRV9JTik7CisJCWludGVsX2VuZ2luZV9j
b250ZXh0X2luKGNlLT5pbmZsaWdodCk7CisJfQogCi0JZXhlY2xpc3RzX2NvbnRleHRfc3RhdHVz
X2NoYW5nZShycSwgSU5URUxfQ09OVEVYVF9TQ0hFRFVMRV9JTik7Ci0JaW50ZWxfZW5naW5lX2Nv
bnRleHRfaW4ocnEtPmVuZ2luZSk7Ci0JcnEtPmh3X2NvbnRleHQtPmluZmxpZ2h0ID0gcnEtPmVu
Z2luZTsKKwlpbnRlbF9jb250ZXh0X2luZmxpZ2h0X2luYyhjZSk7CisJR0VNX0JVR19PTihpbnRl
bF9jb250ZXh0X2luZmxpZ2h0KGNlKSAhPSBycS0+ZW5naW5lKTsKKworCXJldHVybiBpOTE1X3Jl
cXVlc3RfZ2V0KHJxKTsKIH0KIAotc3RhdGljIHZvaWQga2lja19zaWJsaW5ncyhzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpycSkKK3N0YXRpYyB2b2lkIGtpY2tfc2libGluZ3Moc3RydWN0IGk5MTVfcmVx
dWVzdCAqcnEsIHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKIHsKLQlzdHJ1Y3QgdmlydHVhbF9l
bmdpbmUgKnZlID0gdG9fdmlydHVhbF9lbmdpbmUocnEtPmh3X2NvbnRleHQtPmVuZ2luZSk7CisJ
c3RydWN0IHZpcnR1YWxfZW5naW5lICp2ZSA9IGNvbnRhaW5lcl9vZihjZSwgdHlwZW9mKCp2ZSks
IGNvbnRleHQpOwogCXN0cnVjdCBpOTE1X3JlcXVlc3QgKm5leHQgPSBSRUFEX09OQ0UodmUtPnJl
cXVlc3QpOwogCiAJaWYgKG5leHQgJiYgbmV4dC0+ZXhlY3V0aW9uX21hc2sgJiB+cnEtPmV4ZWN1
dGlvbl9tYXNrKQpAQCAtNTc0LDI5ICs1NzMsNDIgQEAgc3RhdGljIHZvaWQga2lja19zaWJsaW5n
cyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIH0KIAogc3RhdGljIGlubGluZSB2b2lkCi1leGVj
bGlzdHNfY29udGV4dF9zY2hlZHVsZV9vdXQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsIHVuc2ln
bmVkIGxvbmcgc3RhdHVzKQorZXhlY2xpc3RzX3NjaGVkdWxlX291dChzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpycSkKIHsKLQlycS0+aHdfY29udGV4dC0+aW5mbGlnaHQgPSBOVUxMOwotCWludGVsX2Vu
Z2luZV9jb250ZXh0X291dChycS0+ZW5naW5lKTsKLQlleGVjbGlzdHNfY29udGV4dF9zdGF0dXNf
Y2hhbmdlKHJxLCBzdGF0dXMpOworCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSA9IHJxLT5od19j
b250ZXh0OworCisJR0VNX0JVR19PTighaW50ZWxfY29udGV4dF9pbmZsaWdodF9jb3VudChjZSkp
OworCiAJdHJhY2VfaTkxNV9yZXF1ZXN0X291dChycSk7CiAKLQkvKgotCSAqIElmIHRoaXMgaXMg
cGFydCBvZiBhIHZpcnR1YWwgZW5naW5lLCBpdHMgbmV4dCByZXF1ZXN0IG1heSBoYXZlCi0JICog
YmVlbiBibG9ja2VkIHdhaXRpbmcgZm9yIGFjY2VzcyB0byB0aGUgYWN0aXZlIGNvbnRleHQuIFdl
IGhhdmUKLQkgKiB0byBraWNrIGFsbCB0aGUgc2libGluZ3MgYWdhaW4gaW4gY2FzZSB3ZSBuZWVk
IHRvIHN3aXRjaCAoZS5nLgotCSAqIHRoZSBuZXh0IHJlcXVlc3QgaXMgbm90IHJ1bm5hYmxlIG9u
IHRoaXMgZW5naW5lKS4gSG9wZWZ1bGx5LAotCSAqIHdlIHdpbGwgYWxyZWFkeSBoYXZlIHN1Ym1p
dHRlZCB0aGUgbmV4dCByZXF1ZXN0IGJlZm9yZSB0aGUKLQkgKiB0YXNrbGV0IHJ1bnMgYW5kIGRv
IG5vdCBuZWVkIHRvIHJlYnVpbGQgZWFjaCB2aXJ0dWFsIHRyZWUKLQkgKiBhbmQga2ljayBldmVy
eW9uZSBhZ2Fpbi4KLQkgKi8KLQlpZiAocnEtPmVuZ2luZSAhPSBycS0+aHdfY29udGV4dC0+ZW5n
aW5lKQotCQlraWNrX3NpYmxpbmdzKHJxKTsKKwlpbnRlbF9jb250ZXh0X2luZmxpZ2h0X2RlYyhj
ZSk7CisJaWYgKCFpbnRlbF9jb250ZXh0X2luZmxpZ2h0X2NvdW50KGNlKSkgeworCQlpbnRlbF9l
bmdpbmVfY29udGV4dF9vdXQoY2UtPmluZmxpZ2h0KTsKKwkJZXhlY2xpc3RzX2NvbnRleHRfc3Rh
dHVzX2NoYW5nZShycSwgSU5URUxfQ09OVEVYVF9TQ0hFRFVMRV9PVVQpOworCisJCWNlLT5pbmZs
aWdodCA9IE5VTEw7CisJCWludGVsX2NvbnRleHRfcHV0KGNlKTsKKworCQkvKgorCQkgKiBJZiB0
aGlzIGlzIHBhcnQgb2YgYSB2aXJ0dWFsIGVuZ2luZSwgaXRzIG5leHQgcmVxdWVzdCBtYXkKKwkJ
ICogaGF2ZSBiZWVuIGJsb2NrZWQgd2FpdGluZyBmb3IgYWNjZXNzIHRvIHRoZSBhY3RpdmUgY29u
dGV4dC4KKwkJICogV2UgaGF2ZSB0byBraWNrIGFsbCB0aGUgc2libGluZ3MgYWdhaW4gaW4gY2Fz
ZSB3ZSBuZWVkIHRvCisJCSAqIHN3aXRjaCAoZS5nLiB0aGUgbmV4dCByZXF1ZXN0IGlzIG5vdCBy
dW5uYWJsZSBvbiB0aGlzCisJCSAqIGVuZ2luZSkuIEhvcGVmdWxseSwgd2Ugd2lsbCBhbHJlYWR5
IGhhdmUgc3VibWl0dGVkIHRoZSBuZXh0CisJCSAqIHJlcXVlc3QgYmVmb3JlIHRoZSB0YXNrbGV0
IHJ1bnMgYW5kIGRvIG5vdCBuZWVkIHRvIHJlYnVpbGQKKwkJICogZWFjaCB2aXJ0dWFsIHRyZWUg
YW5kIGtpY2sgZXZlcnlvbmUgYWdhaW4uCisJCSAqLworCQlpZiAocnEtPmVuZ2luZSAhPSBjZS0+
ZW5naW5lKQorCQkJa2lja19zaWJsaW5ncyhycSwgY2UpOworCX0KKworCWk5MTVfcmVxdWVzdF9w
dXQocnEpOwogfQogCi1zdGF0aWMgdTY0IGV4ZWNsaXN0c191cGRhdGVfY29udGV4dChzdHJ1Y3Qg
aTkxNV9yZXF1ZXN0ICpycSkKK3N0YXRpYyB1NjQgZXhlY2xpc3RzX3VwZGF0ZV9jb250ZXh0KGNv
bnN0IHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogewogCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpj
ZSA9IHJxLT5od19jb250ZXh0OworCXU2NCBkZXNjOwogCiAJY2UtPmxyY19yZWdfc3RhdGVbQ1RY
X1JJTkdfVEFJTCArIDFdID0KIAkJaW50ZWxfcmluZ19zZXRfdGFpbChycS0+cmluZywgcnEtPnRh
aWwpOwpAQCAtNjE3LDcgKzYyOSwxMSBAQCBzdGF0aWMgdTY0IGV4ZWNsaXN0c191cGRhdGVfY29u
dGV4dChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIAkgKiB3bWIpLgogCSAqLwogCW1iKCk7Ci0J
cmV0dXJuIGNlLT5scmNfZGVzYzsKKworCWRlc2MgPSBjZS0+bHJjX2Rlc2M7CisJY2UtPmxyY19k
ZXNjICY9IH5DVFhfREVTQ19GT1JDRV9SRVNUT1JFOworCisJcmV0dXJuIGRlc2M7CiB9CiAKIHN0
YXRpYyBpbmxpbmUgdm9pZCB3cml0ZV9kZXNjKHN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3Rz
ICpleGVjbGlzdHMsIHU2NCBkZXNjLCB1MzIgcG9ydCkKQEAgLTYzMSwxMiArNjQ3LDU0IEBAIHN0
YXRpYyBpbmxpbmUgdm9pZCB3cml0ZV9kZXNjKHN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3Rz
ICpleGVjbGlzdHMsIHU2NCBkZXNjCiAJfQogfQogCitzdGF0aWMgX19tYXliZV91bnVzZWQgdm9p
ZAordHJhY2VfcG9ydHMoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9leGVjbGlzdHMgKmV4ZWNs
aXN0cywKKwkgICAgY29uc3QgY2hhciAqbXNnLAorCSAgICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICog
Y29uc3QgKnBvcnRzKQoreworCWNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSA9
CisJCWNvbnRhaW5lcl9vZihleGVjbGlzdHMsIHR5cGVvZigqZW5naW5lKSwgZXhlY2xpc3RzKTsK
KworCUdFTV9UUkFDRSgiJXM6ICVzIHsgJWxseDolbGxkJXMsICVsbHg6JWxsZCB9XG4iLAorCQkg
IGVuZ2luZS0+bmFtZSwgbXNnLAorCQkgIHBvcnRzWzBdLT5mZW5jZS5jb250ZXh0LAorCQkgIHBv
cnRzWzBdLT5mZW5jZS5zZXFubywKKwkJICBpOTE1X3JlcXVlc3RfY29tcGxldGVkKHBvcnRzWzBd
KSA/ICIhIiA6CisJCSAgaTkxNV9yZXF1ZXN0X3N0YXJ0ZWQocG9ydHNbMF0pID8gIioiIDoKKwkJ
ICAiIiwKKwkJICBwb3J0c1sxXSA/IHBvcnRzWzFdLT5mZW5jZS5jb250ZXh0IDogMCwKKwkJICBw
b3J0c1sxXSA/IHBvcnRzWzFdLT5mZW5jZS5zZXFubyA6IDApOworfQorCitzdGF0aWMgX19tYXli
ZV91bnVzZWQgYm9vbAorYXNzZXJ0X3BlbmRpbmdfdmFsaWQoY29uc3Qgc3RydWN0IGludGVsX2Vu
Z2luZV9leGVjbGlzdHMgKmV4ZWNsaXN0cywKKwkJICAgICBjb25zdCBjaGFyICptc2cpCit7CisJ
c3RydWN0IGk5MTVfcmVxdWVzdCAqIGNvbnN0ICpwb3J0LCAqcnE7CisJc3RydWN0IGludGVsX2Nv
bnRleHQgKmNlID0gTlVMTDsKKworCXRyYWNlX3BvcnRzKGV4ZWNsaXN0cywgbXNnLCBleGVjbGlz
dHMtPnBlbmRpbmcpOworCisJaWYgKGV4ZWNsaXN0cy0+cGVuZGluZ1tleGVjbGlzdHNfbnVtX3Bv
cnRzKGV4ZWNsaXN0cyldKQorCQlyZXR1cm4gZmFsc2U7CisKKwlmb3IgKHBvcnQgPSBleGVjbGlz
dHMtPnBlbmRpbmc7IChycSA9ICpwb3J0KTsgcG9ydCsrKSB7CisJCWlmIChjZSA9PSBycS0+aHdf
Y29udGV4dCkKKwkJCXJldHVybiBmYWxzZTsKKworCQljZSA9IHJxLT5od19jb250ZXh0OworCX0K
KworCXJldHVybiBjZTsKK30KKwogc3RhdGljIHZvaWQgZXhlY2xpc3RzX3N1Ym1pdF9wb3J0cyhz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7CiAJc3RydWN0IGludGVsX2VuZ2luZV9l
eGVjbGlzdHMgKmV4ZWNsaXN0cyA9ICZlbmdpbmUtPmV4ZWNsaXN0czsKLQlzdHJ1Y3QgZXhlY2xp
c3RfcG9ydCAqcG9ydCA9IGV4ZWNsaXN0cy0+cG9ydDsKIAl1bnNpZ25lZCBpbnQgbjsKIAorCUdF
TV9CVUdfT04oIWFzc2VydF9wZW5kaW5nX3ZhbGlkKGV4ZWNsaXN0cywgInN1Ym1pdCIpKTsKKwog
CS8qCiAJICogV2UgY2FuIHNraXAgYWNxdWlyaW5nIGludGVsX3J1bnRpbWVfcG1fZ2V0KCkgaGVy
ZSBhcyBpdCB3YXMgdGFrZW4KIAkgKiBvbiBvdXIgYmVoYWxmIGJ5IHRoZSByZXF1ZXN0IChzZWUg
aTkxNV9nZW1fbWFya19idXN5KCkpIGFuZCBpdCB3aWxsCkBAIC02NTQsMzggKzcxMiwxNiBAQCBz
dGF0aWMgdm9pZCBleGVjbGlzdHNfc3VibWl0X3BvcnRzKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSkKIAkgKiBvZiBlbHNxIGVudHJpZXMsIGtlZXAgdGhpcyBpbiBtaW5kIGJlZm9yZSBj
aGFuZ2luZyB0aGUgbG9vcCBiZWxvdy4KIAkgKi8KIAlmb3IgKG4gPSBleGVjbGlzdHNfbnVtX3Bv
cnRzKGV4ZWNsaXN0cyk7IG4tLTsgKSB7Ci0JCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOwotCQl1
bnNpZ25lZCBpbnQgY291bnQ7Ci0JCXU2NCBkZXNjOwotCi0JCXJxID0gcG9ydF91bnBhY2soJnBv
cnRbbl0sICZjb3VudCk7Ci0JCWlmIChycSkgewotCQkJR0VNX0JVR19PTihjb3VudCA+ICFuKTsK
LQkJCWlmICghY291bnQrKykKLQkJCQlleGVjbGlzdHNfY29udGV4dF9zY2hlZHVsZV9pbihycSk7
Ci0JCQlwb3J0X3NldCgmcG9ydFtuXSwgcG9ydF9wYWNrKHJxLCBjb3VudCkpOwotCQkJZGVzYyA9
IGV4ZWNsaXN0c191cGRhdGVfY29udGV4dChycSk7Ci0JCQlHRU1fREVCVUdfRVhFQyhwb3J0W25d
LmNvbnRleHRfaWQgPSB1cHBlcl8zMl9iaXRzKGRlc2MpKTsKLQotCQkJR0VNX1RSQUNFKCIlcyBp
blslZF06ICBjdHg9JWQuJWQsIGZlbmNlICVsbHg6JWxsZCAoY3VycmVudCAlZCksIHByaW89JWRc
biIsCi0JCQkJICBlbmdpbmUtPm5hbWUsIG4sCi0JCQkJICBwb3J0W25dLmNvbnRleHRfaWQsIGNv
dW50LAotCQkJCSAgcnEtPmZlbmNlLmNvbnRleHQsIHJxLT5mZW5jZS5zZXFubywKLQkJCQkgIGh3
c3Bfc2Vxbm8ocnEpLAotCQkJCSAgcnFfcHJpbyhycSkpOwotCQl9IGVsc2UgewotCQkJR0VNX0JV
R19PTighbik7Ci0JCQlkZXNjID0gMDsKLQkJfQorCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSA9
IGV4ZWNsaXN0cy0+cGVuZGluZ1tuXTsKIAotCQl3cml0ZV9kZXNjKGV4ZWNsaXN0cywgZGVzYywg
bik7CisJCXdyaXRlX2Rlc2MoZXhlY2xpc3RzLAorCQkJICAgcnEgPyBleGVjbGlzdHNfdXBkYXRl
X2NvbnRleHQocnEpIDogMCwKKwkJCSAgIG4pOwogCX0KIAogCS8qIHdlIG5lZWQgdG8gbWFudWFs
bHkgbG9hZCB0aGUgc3VibWl0IHF1ZXVlICovCiAJaWYgKGV4ZWNsaXN0cy0+Y3RybF9yZWcpCiAJ
CXdyaXRlbChFTF9DVFJMX0xPQUQsIGV4ZWNsaXN0cy0+Y3RybF9yZWcpOwotCi0JZXhlY2xpc3Rz
X2NsZWFyX2FjdGl2ZShleGVjbGlzdHMsIEVYRUNMSVNUU19BQ1RJVkVfSFdBQ0spOwogfQogCiBz
dGF0aWMgYm9vbCBjdHhfc2luZ2xlX3BvcnRfc3VibWlzc2lvbihjb25zdCBzdHJ1Y3QgaW50ZWxf
Y29udGV4dCAqY2UpCkBAIC03MDksNiArNzQ1LDcgQEAgc3RhdGljIGJvb2wgY2FuX21lcmdlX2N0
eChjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqcHJldiwKIHN0YXRpYyBib29sIGNhbl9tZXJn
ZV9ycShjb25zdCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpwcmV2LAogCQkJIGNvbnN0IHN0cnVjdCBp
OTE1X3JlcXVlc3QgKm5leHQpCiB7CisJR0VNX0JVR19PTihwcmV2ID09IG5leHQpOwogCUdFTV9C
VUdfT04oIWFzc2VydF9wcmlvcml0eV9xdWV1ZShwcmV2LCBuZXh0KSk7CiAKIAlpZiAoIWNhbl9t
ZXJnZV9jdHgocHJldi0+aHdfY29udGV4dCwgbmV4dC0+aHdfY29udGV4dCkpCkBAIC03MTcsNTkg
Kzc1NCw2IEBAIHN0YXRpYyBib29sIGNhbl9tZXJnZV9ycShjb25zdCBzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpwcmV2LAogCXJldHVybiB0cnVlOwogfQogCi1zdGF0aWMgdm9pZCBwb3J0X2Fzc2lnbihz
dHJ1Y3QgZXhlY2xpc3RfcG9ydCAqcG9ydCwgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCi17Ci0J
R0VNX0JVR19PTihycSA9PSBwb3J0X3JlcXVlc3QocG9ydCkpOwotCi0JaWYgKHBvcnRfaXNzZXQo
cG9ydCkpCi0JCWk5MTVfcmVxdWVzdF9wdXQocG9ydF9yZXF1ZXN0KHBvcnQpKTsKLQotCXBvcnRf
c2V0KHBvcnQsIHBvcnRfcGFjayhpOTE1X3JlcXVlc3RfZ2V0KHJxKSwgcG9ydF9jb3VudChwb3J0
KSkpOwotfQotCi1zdGF0aWMgdm9pZCBpbmplY3RfcHJlZW1wdF9jb250ZXh0KHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSkKLXsKLQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAq
ZXhlY2xpc3RzID0gJmVuZ2luZS0+ZXhlY2xpc3RzOwotCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpj
ZSA9IGVuZ2luZS0+cHJlZW1wdF9jb250ZXh0OwotCXVuc2lnbmVkIGludCBuOwotCi0JR0VNX0JV
R19PTihleGVjbGlzdHMtPnByZWVtcHRfY29tcGxldGVfc3RhdHVzICE9Ci0JCSAgIHVwcGVyXzMy
X2JpdHMoY2UtPmxyY19kZXNjKSk7Ci0KLQkvKgotCSAqIFN3aXRjaCB0byBvdXIgZW1wdHkgcHJl
ZW1wdCBjb250ZXh0IHNvCi0JICogdGhlIHN0YXRlIG9mIHRoZSBHUFUgaXMga25vd24gKGlkbGUp
LgotCSAqLwotCUdFTV9UUkFDRSgiJXNcbiIsIGVuZ2luZS0+bmFtZSk7Ci0JZm9yIChuID0gZXhl
Y2xpc3RzX251bV9wb3J0cyhleGVjbGlzdHMpOyAtLW47ICkKLQkJd3JpdGVfZGVzYyhleGVjbGlz
dHMsIDAsIG4pOwotCi0Jd3JpdGVfZGVzYyhleGVjbGlzdHMsIGNlLT5scmNfZGVzYywgbik7Ci0K
LQkvKiB3ZSBuZWVkIHRvIG1hbnVhbGx5IGxvYWQgdGhlIHN1Ym1pdCBxdWV1ZSAqLwotCWlmIChl
eGVjbGlzdHMtPmN0cmxfcmVnKQotCQl3cml0ZWwoRUxfQ1RSTF9MT0FELCBleGVjbGlzdHMtPmN0
cmxfcmVnKTsKLQotCWV4ZWNsaXN0c19jbGVhcl9hY3RpdmUoZXhlY2xpc3RzLCBFWEVDTElTVFNf
QUNUSVZFX0hXQUNLKTsKLQlleGVjbGlzdHNfc2V0X2FjdGl2ZShleGVjbGlzdHMsIEVYRUNMSVNU
U19BQ1RJVkVfUFJFRU1QVCk7Ci0KLQkodm9pZClJOTE1X1NFTEZURVNUX09OTFkoZXhlY2xpc3Rz
LT5wcmVlbXB0X2hhbmcuY291bnQrKyk7Ci19Ci0KLXN0YXRpYyB2b2lkIGNvbXBsZXRlX3ByZWVt
cHRfY29udGV4dChzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAqZXhlY2xpc3RzKQotewot
CUdFTV9CVUdfT04oIWV4ZWNsaXN0c19pc19hY3RpdmUoZXhlY2xpc3RzLCBFWEVDTElTVFNfQUNU
SVZFX1BSRUVNUFQpKTsKLQotCWlmIChpbmplY3RfcHJlZW1wdF9oYW5nKGV4ZWNsaXN0cykpCi0J
CXJldHVybjsKLQotCWV4ZWNsaXN0c19jYW5jZWxfcG9ydF9yZXF1ZXN0cyhleGVjbGlzdHMpOwot
CV9fdW53aW5kX2luY29tcGxldGVfcmVxdWVzdHMoY29udGFpbmVyX29mKGV4ZWNsaXN0cywKLQkJ
CQkJCSAgc3RydWN0IGludGVsX2VuZ2luZV9jcywKLQkJCQkJCSAgZXhlY2xpc3RzKSwKLQkJCQkg
ICAgIEFDVElWRV9QUklPUklUWSk7Ci19Ci0KIHN0YXRpYyB2b2lkIHZpcnR1YWxfdXBkYXRlX3Jl
Z2lzdGVyX29mZnNldHModTMyICpyZWdzLAogCQkJCQkgICAgc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lKQogewpAQCAtODM0LDcgKzgxOCw3IEBAIHN0YXRpYyBib29sIHZpcnR1YWxfbWF0
Y2hlcyhjb25zdCBzdHJ1Y3QgdmlydHVhbF9lbmdpbmUgKnZlLAogCSAqIHdlIHJldXNlIHRoZSBy
ZWdpc3RlciBvZmZzZXRzKS4gVGhpcyBpcyBhIHZlcnkgc21hbGwKIAkgKiBoeXN0ZXJzaXMgb24g
dGhlIGdyZWVkeSBzZWVsY3Rpb24gYWxnb3JpdGhtLgogCSAqLwotCWluZmxpZ2h0ID0gUkVBRF9P
TkNFKHZlLT5jb250ZXh0LmluZmxpZ2h0KTsKKwlpbmZsaWdodCA9IGludGVsX2NvbnRleHRfaW5m
bGlnaHQoJnZlLT5jb250ZXh0KTsKIAlpZiAoaW5mbGlnaHQgJiYgaW5mbGlnaHQgIT0gZW5naW5l
KQogCQlyZXR1cm4gZmFsc2U7CiAKQEAgLTg1NywxMyArODQxLDIzIEBAIHN0YXRpYyB2b2lkIHZp
cnR1YWxfeGZlcl9icmVhZGNydW1icyhzdHJ1Y3QgdmlydHVhbF9lbmdpbmUgKnZlLAogCXNwaW5f
dW5sb2NrKCZvbGQtPmJyZWFkY3J1bWJzLmlycV9sb2NrKTsKIH0KIAotc3RhdGljIHZvaWQgZXhl
Y2xpc3RzX2RlcXVldWUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQorc3RhdGljIHN0
cnVjdCBpOTE1X3JlcXVlc3QgKgorbGFzdF9hY3RpdmUoY29uc3Qgc3RydWN0IGludGVsX2VuZ2lu
ZV9leGVjbGlzdHMgKmV4ZWNsaXN0cykKK3sKKwlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICogY29uc3Qg
Kmxhc3QgPSBleGVjbGlzdHMtPmFjdGl2ZTsKKworCXdoaWxlICgqbGFzdCAmJiBpOTE1X3JlcXVl
c3RfY29tcGxldGVkKCpsYXN0KSkKKwkJbGFzdCsrOworCisJcmV0dXJuICpsYXN0OworfQorCitz
dGF0aWMgYm9vbCBleGVjbGlzdHNfZGVxdWV1ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpCiB7CiAJc3RydWN0IGludGVsX2VuZ2luZV9leGVjbGlzdHMgKiBjb25zdCBleGVjbGlzdHMg
PSAmZW5naW5lLT5leGVjbGlzdHM7Ci0Jc3RydWN0IGV4ZWNsaXN0X3BvcnQgKnBvcnQgPSBleGVj
bGlzdHMtPnBvcnQ7Ci0JY29uc3Qgc3RydWN0IGV4ZWNsaXN0X3BvcnQgKiBjb25zdCBsYXN0X3Bv
cnQgPQotCQkmZXhlY2xpc3RzLT5wb3J0W2V4ZWNsaXN0cy0+cG9ydF9tYXNrXTsKLQlzdHJ1Y3Qg
aTkxNV9yZXF1ZXN0ICpsYXN0ID0gcG9ydF9yZXF1ZXN0KHBvcnQpOworCXN0cnVjdCBpOTE1X3Jl
cXVlc3QgKipwb3J0ID0gZXhlY2xpc3RzLT5wZW5kaW5nOworCXN0cnVjdCBpOTE1X3JlcXVlc3Qg
KiogY29uc3QgbGFzdF9wb3J0ID0gcG9ydCArIGV4ZWNsaXN0cy0+cG9ydF9tYXNrOworCXN0cnVj
dCBpOTE1X3JlcXVlc3QgKmxhc3Q7CiAJc3RydWN0IHJiX25vZGUgKnJiOwogCWJvb2wgc3VibWl0
ID0gZmFsc2U7CiAKQEAgLTkwOSw2NSArOTAzLDcyIEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19k
ZXF1ZXVlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAkJYnJlYWs7CiAJfQogCisJ
LyoKKwkgKiBJZiB0aGUgcXVldWUgaXMgaGlnaGVyIHByaW9yaXR5IHRoYW4gdGhlIGxhc3QKKwkg
KiByZXF1ZXN0IGluIHRoZSBjdXJyZW50bHkgYWN0aXZlIGNvbnRleHQsIHN1Ym1pdCBhZnJlc2gu
CisJICogV2Ugd2lsbCByZXN1Ym1pdCBhZ2FpbiBhZnRlcndhcmRzIGluIGNhc2Ugd2UgbmVlZCB0
byBzcGxpdAorCSAqIHRoZSBhY3RpdmUgY29udGV4dCB0byBpbnRlcmplY3QgdGhlIHByZWVtcHRp
b24gcmVxdWVzdCwKKwkgKiBpLmUuIHdlIHdpbGwgcmV0cmlnZ2VyIHByZWVtcHRpb24gZm9sbG93
aW5nIHRoZSBhY2sgaW4gY2FzZQorCSAqIG9mIHRyb3VibGUuCisJICovCisJbGFzdCA9IGxhc3Rf
YWN0aXZlKGV4ZWNsaXN0cyk7CiAJaWYgKGxhc3QpIHsKLQkJLyoKLQkJICogRG9uJ3QgcmVzdWJt
aXQgb3Igc3dpdGNoIHVudGlsIGFsbCBvdXRzdGFuZGluZwotCQkgKiBwcmVlbXB0aW9ucyAobGl0
ZS1yZXN0b3JlKSBhcmUgc2Vlbi4gVGhlbiB3ZQotCQkgKiBrbm93IHRoZSBuZXh0IHByZWVtcHRp
b24gc3RhdHVzIHdlIHNlZSBjb3JyZXNwb25kcwotCQkgKiB0byB0aGlzIEVMU1AgdXBkYXRlLgot
CQkgKi8KLQkJR0VNX0JVR19PTighZXhlY2xpc3RzX2lzX2FjdGl2ZShleGVjbGlzdHMsCi0JCQkJ
CQlFWEVDTElTVFNfQUNUSVZFX1VTRVIpKTsKLQkJR0VNX0JVR19PTighcG9ydF9jb3VudCgmcG9y
dFswXSkpOwotCi0JCS8qCi0JCSAqIElmIHdlIHdyaXRlIHRvIEVMU1AgYSBzZWNvbmQgdGltZSBi
ZWZvcmUgdGhlIEhXIGhhcyBoYWQKLQkJICogYSBjaGFuY2UgdG8gcmVzcG9uZCB0byB0aGUgcHJl
dmlvdXMgd3JpdGUsIHdlIGNhbiBjb25mdXNlCi0JCSAqIHRoZSBIVyBhbmQgaGl0ICJ1bmRlZmlu
ZWQgYmVoYXZpb3VyIi4gQWZ0ZXIgd3JpdGluZyB0byBFTFNQLAotCQkgKiB3ZSBtdXN0IHRoZW4g
d2FpdCB1bnRpbCB3ZSBzZWUgYSBjb250ZXh0LXN3aXRjaCBldmVudCBmcm9tCi0JCSAqIHRoZSBI
VyB0byBpbmRpY2F0ZSB0aGF0IGl0IGhhcyBoYWQgYSBjaGFuY2UgdG8gcmVzcG9uZC4KLQkJICov
Ci0JCWlmICghZXhlY2xpc3RzX2lzX2FjdGl2ZShleGVjbGlzdHMsIEVYRUNMSVNUU19BQ1RJVkVf
SFdBQ0spKQotCQkJcmV0dXJuOwotCiAJCWlmIChuZWVkX3ByZWVtcHQoZW5naW5lLCBsYXN0LCBy
YikpIHsKLQkJCWluamVjdF9wcmVlbXB0X2NvbnRleHQoZW5naW5lKTsKLQkJCXJldHVybjsKLQkJ
fQorCQkJR0VNX1RSQUNFKCIlczogcHJlZW1wdGluZyBsYXN0PSVsbHg6JWxsZCwgcHJpbz0lZCwg
aGludD0lZFxuIiwKKwkJCQkgIGVuZ2luZS0+bmFtZSwKKwkJCQkgIGxhc3QtPmZlbmNlLmNvbnRl
eHQsCisJCQkJICBsYXN0LT5mZW5jZS5zZXFubywKKwkJCQkgIGxhc3QtPnNjaGVkLmF0dHIucHJp
b3JpdHksCisJCQkJICBleGVjbGlzdHMtPnF1ZXVlX3ByaW9yaXR5X2hpbnQpOworCQkJLyoKKwkJ
CSAqIERvbid0IGxldCB0aGUgUklOR19IRUFEIGFkdmFuY2UgcGFzdCB0aGUgYnJlYWRjcnVtYgor
CQkJICogYXMgd2UgdW53aW5kIChhbmQgdW50aWwgd2UgcmVzdWJtaXQpIHNvIHRoYXQgd2UgZG8K
KwkJCSAqIG5vdCBhY2NpZGVudGFsbHkgdGVsbCBpdCB0byBnbyBiYWNrd2FyZHMuCisJCQkgKi8K
KwkJCXJpbmdfc3VzcGVuZChlbmdpbmUpID0gMTsKIAotCQkvKgotCQkgKiBJbiB0aGVvcnksIHdl
IGNvdWxkIGNvYWxlc2NlIG1vcmUgcmVxdWVzdHMgb250bwotCQkgKiB0aGUgc2Vjb25kIHBvcnQg
KHRoZSBmaXJzdCBwb3J0IGlzIGFjdGl2ZSwgd2l0aAotCQkgKiBubyBwcmVlbXB0aW9ucyBwZW5k
aW5nKS4gSG93ZXZlciwgdGhhdCBtZWFucyB3ZQotCQkgKiB0aGVuIGhhdmUgdG8gZGVhbCB3aXRo
IHRoZSBwb3NzaWJsZSBsaXRlLXJlc3RvcmUKLQkJICogb2YgdGhlIHNlY29uZCBwb3J0IChhcyB3
ZSBzdWJtaXQgdGhlIEVMU1AsIHRoZXJlCi0JCSAqIG1heSBiZSBhIGNvbnRleHQtc3dpdGNoKSBi
dXQgYWxzbyB3ZSBtYXkgY29tcGxldGUKLQkJICogdGhlIHJlc3VibWlzc2lvbiBiZWZvcmUgdGhl
IGNvbnRleHQtc3dpdGNoLiBFcmdvLAotCQkgKiBjb2FsZXNjaW5nIG9udG8gdGhlIHNlY29uZCBw
b3J0IHdpbGwgY2F1c2UgYQotCQkgKiBwcmVlbXB0aW9uIGV2ZW50LCBidXQgd2UgY2Fubm90IHBy
ZWRpY3Qgd2hldGhlcgotCQkgKiB0aGF0IHdpbGwgYWZmZWN0IHBvcnRbMF0gb3IgcG9ydFsxXS4K
LQkJICoKLQkJICogSWYgdGhlIHNlY29uZCBwb3J0IGlzIGFscmVhZHkgYWN0aXZlLCB3ZSBjYW4g
d2FpdAotCQkgKiB1bnRpbCB0aGUgbmV4dCBjb250ZXh0LXN3aXRjaCBiZWZvcmUgY29udGVtcGxh
dGluZwotCQkgKiBuZXcgcmVxdWVzdHMuIFRoZSBHUFUgd2lsbCBiZSBidXN5IGFuZCB3ZSBzaG91
bGQgYmUKLQkJICogYWJsZSB0byByZXN1Ym1pdCB0aGUgbmV3IEVMU1AgYmVmb3JlIGl0IGlkbGVz
LAotCQkgKiBhdm9pZGluZyBwaXBlbGluZSBidWJibGVzIChtb21lbnRhcnkgcGF1c2VzIHdoZXJl
Ci0JCSAqIHRoZSBkcml2ZXIgaXMgdW5hYmxlIHRvIGtlZXAgdXAgdGhlIHN1cHBseSBvZiBuZXcK
LQkJICogd29yaykuIEhvd2V2ZXIsIHdlIGhhdmUgdG8gZG91YmxlIGNoZWNrIHRoYXQgdGhlCi0J
CSAqIHByaW9yaXRpZXMgb2YgdGhlIHBvcnRzIGhhdmVuJ3QgYmVlbiBzd2l0Y2guCi0JCSAqLwot
CQlpZiAocG9ydF9jb3VudCgmcG9ydFsxXSkpCi0JCQlyZXR1cm47CisJCQkvKgorCQkJICogTm90
ZSB0aGF0IHdlIGhhdmUgbm90IHN0b3BwZWQgdGhlIEdQVSBhdCB0aGlzIHBvaW50LAorCQkJICog
c28gd2UgYXJlIHVud2luZGluZyB0aGUgaW5jb21wbGV0ZSByZXF1ZXN0cyBhcyB0aGV5CisJCQkg
KiByZW1haW4gaW5mbGlnaHQgYW5kIHNvIGJ5IHRoZSB0aW1lIHdlIGRvIGNvbXBsZXRlCisJCQkg
KiB0aGUgcHJlZW1wdGlvbiwgc29tZSBvZiB0aGUgdW53b3VuZCByZXF1ZXN0cyBtYXkKKwkJCSAq
IGNvbXBsZXRlIQorCQkJICovCisJCQlfX3Vud2luZF9pbmNvbXBsZXRlX3JlcXVlc3RzKGVuZ2lu
ZSwgQUNUSVZFX1BSSU9SSVRZKTsKIAotCQkvKgotCQkgKiBXYUlkbGVMaXRlUmVzdG9yZTpiZHcs
c2tsCi0JCSAqIEFwcGx5IHRoZSB3YSBOT09QcyB0byBwcmV2ZW50Ci0JCSAqIHJpbmc6SEVBRCA9
PSBycTpUQUlMIGFzIHdlIHJlc3VibWl0IHRoZQotCQkgKiByZXF1ZXN0LiBTZWUgZ2VuOF9lbWl0
X2ZpbmlfYnJlYWRjcnVtYigpIGZvcgotCQkgKiB3aGVyZSB3ZSBwcmVwYXJlIHRoZSBwYWRkaW5n
IGFmdGVyIHRoZQotCQkgKiBlbmQgb2YgdGhlIHJlcXVlc3QuCi0JCSAqLwotCQlsYXN0LT50YWls
ID0gbGFzdC0+d2FfdGFpbDsKKwkJCS8qCisJCQkgKiBJZiB3ZSBuZWVkIHRvIHJldHVybiB0byB0
aGUgcHJlZW1wdGVkIGNvbnRleHQsIHdlCisJCQkgKiBuZWVkIHRvIHNraXAgdGhlIGxpdGUtcmVz
dG9yZSBhbmQgZm9yY2UgaXQgdG8KKwkJCSAqIHJlbG9hZCB0aGUgUklOR19UQUlMLiBPdGhlcndp
c2UsIHRoZSBIVyBoYXMgYQorCQkJICogdGVuZGVuY3kgdG8gaWdub3JlIHVzIHJld2luZGluZyB0
aGUgVEFJTCB0byB0aGUKKwkJCSAqIGVuZCBvZiBhbiBlYXJsaWVyIHJlcXVlc3QuCisJCQkgKi8K
KwkJCWxhc3QtPmh3X2NvbnRleHQtPmxyY19kZXNjIHw9IENUWF9ERVNDX0ZPUkNFX1JFU1RPUkU7
CisJCQlsYXN0ID0gTlVMTDsKKwkJfSBlbHNlIHsKKwkJCS8qCisJCQkgKiBPdGhlcndpc2UgaWYg
d2UgYWxyZWFkeSBoYXZlIGEgcmVxdWVzdCBwZW5kaW5nCisJCQkgKiBmb3IgZXhlY3V0aW9uIGFm
dGVyIHRoZSBjdXJyZW50IG9uZSwgd2UgY2FuCisJCQkgKiBqdXN0IHdhaXQgdW50aWwgdGhlIG5l
eHQgQ1MgZXZlbnQgYmVmb3JlCisJCQkgKiBxdWV1aW5nIG1vcmUuIEluIGVpdGhlciBjYXNlIHdl
IHdpbGwgZm9yY2UgYQorCQkJICogbGl0ZS1yZXN0b3JlIHByZWVtcHRpb24gZXZlbnQsIGJ1dCBp
ZiB3ZSB3YWl0CisJCQkgKiB3ZSBob3BlZnVsbHkgY29hbGVzY2Ugc2V2ZXJhbCB1cGRhdGVzIGlu
dG8gYSBzaW5nbGUKKwkJCSAqIHN1Ym1pc3Npb24uCisJCQkgKi8KKwkJCWlmICghbGlzdF9pc19s
YXN0KCZsYXN0LT5zY2hlZC5saW5rLAorCQkJCQkgICZlbmdpbmUtPmFjdGl2ZS5yZXF1ZXN0cykp
CisJCQkJcmV0dXJuIGZhbHNlOworCisJCQkvKgorCQkJICogV2FJZGxlTGl0ZVJlc3RvcmU6YmR3
LHNrbAorCQkJICogQXBwbHkgdGhlIHdhIE5PT1BzIHRvIHByZXZlbnQKKwkJCSAqIHJpbmc6SEVB
RCA9PSBycTpUQUlMIGFzIHdlIHJlc3VibWl0IHRoZQorCQkJICogcmVxdWVzdC4gU2VlIGdlbjhf
ZW1pdF9maW5pX2JyZWFkY3J1bWIoKSBmb3IKKwkJCSAqIHdoZXJlIHdlIHByZXBhcmUgdGhlIHBh
ZGRpbmcgYWZ0ZXIgdGhlCisJCQkgKiBlbmQgb2YgdGhlIHJlcXVlc3QuCisJCQkgKi8KKwkJCWxh
c3QtPnRhaWwgPSBsYXN0LT53YV90YWlsOworCQl9CiAJfQogCiAJd2hpbGUgKHJiKSB7IC8qIFhY
WCB2aXJ0dWFsIGlzIGFsd2F5cyB0YWtpbmcgcHJlY2VkZW5jZSAqLwpAQCAtOTk3LDkgKzk5OCwy
NCBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfZGVxdWV1ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmUpCiAJCQkJY29udGludWU7CiAJCQl9CiAKKwkJCWlmIChpOTE1X3JlcXVlc3RfY29t
cGxldGVkKHJxKSkgeworCQkJCXZlLT5yZXF1ZXN0ID0gTlVMTDsKKwkJCQl2ZS0+YmFzZS5leGVj
bGlzdHMucXVldWVfcHJpb3JpdHlfaGludCA9IElOVF9NSU47CisJCQkJcmJfZXJhc2VfY2FjaGVk
KHJiLCAmZXhlY2xpc3RzLT52aXJ0dWFsKTsKKwkJCQlSQl9DTEVBUl9OT0RFKHJiKTsKKworCQkJ
CXJxLT5lbmdpbmUgPSBlbmdpbmU7CisJCQkJX19pOTE1X3JlcXVlc3Rfc3VibWl0KHJxKTsKKwor
CQkJCXNwaW5fdW5sb2NrKCZ2ZS0+YmFzZS5hY3RpdmUubG9jayk7CisKKwkJCQlyYiA9IHJiX2Zp
cnN0X2NhY2hlZCgmZXhlY2xpc3RzLT52aXJ0dWFsKTsKKwkJCQljb250aW51ZTsKKwkJCX0KKwog
CQkJaWYgKGxhc3QgJiYgIWNhbl9tZXJnZV9ycShsYXN0LCBycSkpIHsKIAkJCQlzcGluX3VubG9j
aygmdmUtPmJhc2UuYWN0aXZlLmxvY2spOwotCQkJCXJldHVybjsgLyogbGVhdmUgdGhpcyBycSBm
b3IgYW5vdGhlciBlbmdpbmUgKi8KKwkJCQlyZXR1cm4gZmFsc2U7IC8qIGxlYXZlIHRoaXMgZm9y
IGFub3RoZXIgKi8KIAkJCX0KIAogCQkJR0VNX1RSQUNFKCIlczogdmlydHVhbCBycT0lbGx4OiVs
bGQlcywgbmV3IGVuZ2luZT8gJXNcbiIsCkBAIC0xMDQ4LDkgKzEwNjQsMTAgQEAgc3RhdGljIHZv
aWQgZXhlY2xpc3RzX2RlcXVldWUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCQkJ
fQogCiAJCQlfX2k5MTVfcmVxdWVzdF9zdWJtaXQocnEpOwotCQkJdHJhY2VfaTkxNV9yZXF1ZXN0
X2luKHJxLCBwb3J0X2luZGV4KHBvcnQsIGV4ZWNsaXN0cykpOwotCQkJc3VibWl0ID0gdHJ1ZTsK
LQkJCWxhc3QgPSBycTsKKwkJCWlmICghaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChycSkpIHsKKwkJ
CQlzdWJtaXQgPSB0cnVlOworCQkJCWxhc3QgPSBycTsKKwkJCX0KIAkJfQogCiAJCXNwaW5fdW5s
b2NrKCZ2ZS0+YmFzZS5hY3RpdmUubG9jayk7CkBAIC0xMDYzLDYgKzEwODAsOSBAQCBzdGF0aWMg
dm9pZCBleGVjbGlzdHNfZGVxdWV1ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJ
CWludCBpOwogCiAJCXByaW9saXN0X2Zvcl9lYWNoX3JlcXVlc3RfY29uc3VtZShycSwgcm4sIHAs
IGkpIHsKKwkJCWlmIChpOTE1X3JlcXVlc3RfY29tcGxldGVkKHJxKSkKKwkJCQlnb3RvIHNraXA7
CisKIAkJCS8qCiAJCQkgKiBDYW4gd2UgY29tYmluZSB0aGlzIHJlcXVlc3Qgd2l0aCB0aGUgY3Vy
cmVudCBwb3J0PwogCQkJICogSXQgaGFzIHRvIGJlIHRoZSBzYW1lIGNvbnRleHQvcmluZ2J1ZmZl
ciBhbmQgbm90CkBAIC0xMTAyLDE5ICsxMTIyLDE0IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19k
ZXF1ZXVlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAkJCQkgICAgY3R4X3Npbmds
ZV9wb3J0X3N1Ym1pc3Npb24ocnEtPmh3X2NvbnRleHQpKQogCQkJCQlnb3RvIGRvbmU7CiAKLQot
CQkJCWlmIChzdWJtaXQpCi0JCQkJCXBvcnRfYXNzaWduKHBvcnQsIGxhc3QpOworCQkJCSpwb3J0
ID0gZXhlY2xpc3RzX3NjaGVkdWxlX2luKGxhc3QsIHBvcnQgLSBleGVjbGlzdHMtPnBlbmRpbmcp
OwogCQkJCXBvcnQrKzsKLQotCQkJCUdFTV9CVUdfT04ocG9ydF9pc3NldChwb3J0KSk7CiAJCQl9
CiAKLQkJCV9faTkxNV9yZXF1ZXN0X3N1Ym1pdChycSk7Ci0JCQl0cmFjZV9pOTE1X3JlcXVlc3Rf
aW4ocnEsIHBvcnRfaW5kZXgocG9ydCwgZXhlY2xpc3RzKSk7Ci0KIAkJCWxhc3QgPSBycTsKIAkJ
CXN1Ym1pdCA9IHRydWU7Citza2lwOgorCQkJX19pOTE1X3JlcXVlc3Rfc3VibWl0KHJxKTsKIAkJ
fQogCiAJCXJiX2VyYXNlX2NhY2hlZCgmcC0+bm9kZSwgJmV4ZWNsaXN0cy0+cXVldWUpOwpAQCAt
MTEzOSw1NCArMTE1NCwzMiBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfZGVxdWV1ZShzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJICogaW50ZXJydXB0IGZvciBzZWNvbmRhcnkgcG9y
dHMpLgogCSAqLwogCWV4ZWNsaXN0cy0+cXVldWVfcHJpb3JpdHlfaGludCA9IHF1ZXVlX3ByaW8o
ZXhlY2xpc3RzKTsKKwlHRU1fVFJBQ0UoIiVzOiBxdWV1ZV9wcmlvcml0eV9oaW50OiVkLCBzdWJt
aXQ6JXNcbiIsCisJCSAgZW5naW5lLT5uYW1lLCBleGVjbGlzdHMtPnF1ZXVlX3ByaW9yaXR5X2hp
bnQsCisJCSAgeWVzbm8oc3VibWl0KSk7CiAKIAlpZiAoc3VibWl0KSB7Ci0JCXBvcnRfYXNzaWdu
KHBvcnQsIGxhc3QpOworCQkqcG9ydCA9IGV4ZWNsaXN0c19zY2hlZHVsZV9pbihsYXN0LCBwb3J0
IC0gZXhlY2xpc3RzLT5wZW5kaW5nKTsKKwkJbWVtc2V0KHBvcnQgKyAxLCAwLCAobGFzdF9wb3J0
IC0gcG9ydCkgKiBzaXplb2YoKnBvcnQpKTsKIAkJZXhlY2xpc3RzX3N1Ym1pdF9wb3J0cyhlbmdp
bmUpOwogCX0KIAotCS8qIFdlIG11c3QgYWx3YXlzIGtlZXAgdGhlIGJlYXN0IGZlZCBpZiB3ZSBo
YXZlIHdvcmsgcGlsZWQgdXAgKi8KLQlHRU1fQlVHX09OKHJiX2ZpcnN0X2NhY2hlZCgmZXhlY2xp
c3RzLT5xdWV1ZSkgJiYKLQkJICAgIXBvcnRfaXNzZXQoZXhlY2xpc3RzLT5wb3J0KSk7Ci0KLQkv
KiBSZS1ldmFsdWF0ZSB0aGUgZXhlY3V0aW5nIGNvbnRleHQgc2V0dXAgYWZ0ZXIgZWFjaCBwcmVl
bXB0aXZlIGtpY2sgKi8KLQlpZiAobGFzdCkKLQkJZXhlY2xpc3RzX3VzZXJfYmVnaW4oZXhlY2xp
c3RzLCBleGVjbGlzdHMtPnBvcnQpOwotCi0JLyogSWYgdGhlIGVuZ2luZSBpcyBub3cgaWRsZSwg
c28gc2hvdWxkIGJlIHRoZSBmbGFnOyBhbmQgdmljZSB2ZXJzYS4gKi8KLQlHRU1fQlVHX09OKGV4
ZWNsaXN0c19pc19hY3RpdmUoJmVuZ2luZS0+ZXhlY2xpc3RzLAotCQkJCSAgICAgICBFWEVDTElT
VFNfQUNUSVZFX1VTRVIpID09Ci0JCSAgICFwb3J0X2lzc2V0KGVuZ2luZS0+ZXhlY2xpc3RzLnBv
cnQpKTsKKwlyZXR1cm4gc3VibWl0OwogfQogCiB2b2lkCiBleGVjbGlzdHNfY2FuY2VsX3BvcnRf
cmVxdWVzdHMoc3RydWN0IGludGVsX2VuZ2luZV9leGVjbGlzdHMgKiBjb25zdCBleGVjbGlzdHMp
CiB7Ci0Jc3RydWN0IGV4ZWNsaXN0X3BvcnQgKnBvcnQgPSBleGVjbGlzdHMtPnBvcnQ7Ci0JdW5z
aWduZWQgaW50IG51bV9wb3J0cyA9IGV4ZWNsaXN0c19udW1fcG9ydHMoZXhlY2xpc3RzKTsKLQot
CXdoaWxlIChudW1fcG9ydHMtLSAmJiBwb3J0X2lzc2V0KHBvcnQpKSB7Ci0JCXN0cnVjdCBpOTE1
X3JlcXVlc3QgKnJxID0gcG9ydF9yZXF1ZXN0KHBvcnQpOwotCi0JCUdFTV9UUkFDRSgiJXM6cG9y
dCV1IGZlbmNlICVsbHg6JWxsZCwgKGN1cnJlbnQgJWQpXG4iLAotCQkJICBycS0+ZW5naW5lLT5u
YW1lLAotCQkJICAodW5zaWduZWQgaW50KShwb3J0IC0gZXhlY2xpc3RzLT5wb3J0KSwKLQkJCSAg
cnEtPmZlbmNlLmNvbnRleHQsIHJxLT5mZW5jZS5zZXFubywKLQkJCSAgaHdzcF9zZXFubyhycSkp
OworCXN0cnVjdCBpOTE1X3JlcXVlc3QgKiBjb25zdCAqcG9ydCwgKnJxOwogCi0JCUdFTV9CVUdf
T04oIWV4ZWNsaXN0cy0+YWN0aXZlKTsKLQkJZXhlY2xpc3RzX2NvbnRleHRfc2NoZWR1bGVfb3V0
KHJxLAotCQkJCQkgICAgICAgaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChycSkgPwotCQkJCQkgICAg
ICAgSU5URUxfQ09OVEVYVF9TQ0hFRFVMRV9PVVQgOgotCQkJCQkgICAgICAgSU5URUxfQ09OVEVY
VF9TQ0hFRFVMRV9QUkVFTVBURUQpOwotCi0JCWk5MTVfcmVxdWVzdF9wdXQocnEpOwotCi0JCW1l
bXNldChwb3J0LCAwLCBzaXplb2YoKnBvcnQpKTsKLQkJcG9ydCsrOwotCX0KKwlmb3IgKHBvcnQg
PSBleGVjbGlzdHMtPnBlbmRpbmc7IChycSA9ICpwb3J0KTsgcG9ydCsrKQorCQlleGVjbGlzdHNf
c2NoZWR1bGVfb3V0KHJxKTsKKwltZW1zZXQoZXhlY2xpc3RzLT5wZW5kaW5nLCAwLCBzaXplb2Yo
ZXhlY2xpc3RzLT5wZW5kaW5nKSk7CiAKLQlleGVjbGlzdHNfY2xlYXJfYWxsX2FjdGl2ZShleGVj
bGlzdHMpOworCWZvciAocG9ydCA9IGV4ZWNsaXN0cy0+YWN0aXZlOyAocnEgPSAqcG9ydCk7IHBv
cnQrKykKKwkJZXhlY2xpc3RzX3NjaGVkdWxlX291dChycSk7CisJZXhlY2xpc3RzLT5hY3RpdmUg
PQorCQltZW1zZXQoZXhlY2xpc3RzLT5pbmZsaWdodCwgMCwgc2l6ZW9mKGV4ZWNsaXN0cy0+aW5m
bGlnaHQpKTsKIH0KIAogc3RhdGljIGlubGluZSB2b2lkCkBAIC0xMjA1LDcgKzExOTgsNiBAQCBy
ZXNldF9pbl9wcm9ncmVzcyhjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAqZXhl
Y2xpc3RzKQogc3RhdGljIHZvaWQgcHJvY2Vzc19jc2Ioc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lKQogewogCXN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3RzICogY29uc3QgZXhlY2xp
c3RzID0gJmVuZ2luZS0+ZXhlY2xpc3RzOwotCXN0cnVjdCBleGVjbGlzdF9wb3J0ICpwb3J0ID0g
ZXhlY2xpc3RzLT5wb3J0OwogCWNvbnN0IHUzMiAqIGNvbnN0IGJ1ZiA9IGV4ZWNsaXN0cy0+Y3Ni
X3N0YXR1czsKIAljb25zdCB1OCBudW1fZW50cmllcyA9IGV4ZWNsaXN0cy0+Y3NiX3NpemU7CiAJ
dTggaGVhZCwgdGFpbDsKQEAgLTEyMzksOSArMTIzMSw3IEBAIHN0YXRpYyB2b2lkIHByb2Nlc3Nf
Y3NiKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAlybWIoKTsKIAogCWRvIHsKLQkJ
c3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7CiAJCXVuc2lnbmVkIGludCBzdGF0dXM7Ci0JCXVuc2ln
bmVkIGludCBjb3VudDsKIAogCQlpZiAoKytoZWFkID09IG51bV9lbnRyaWVzKQogCQkJaGVhZCA9
IDA7CkBAIC0xMjY0LDY4ICsxMjU0LDM3IEBAIHN0YXRpYyB2b2lkIHByb2Nlc3NfY3NiKHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAkJICogc3RhdHVzIG5vdGlmaWVyLgogCQkgKi8K
IAotCQlHRU1fVFJBQ0UoIiVzIGNzYlslZF06IHN0YXR1cz0weCUwOHg6MHglMDh4LCBhY3RpdmU9
MHgleFxuIiwKKwkJR0VNX1RSQUNFKCIlcyBjc2JbJWRdOiBzdGF0dXM9MHglMDh4OjB4JTA4eFxu
IiwKIAkJCSAgZW5naW5lLT5uYW1lLCBoZWFkLAotCQkJICBidWZbMiAqIGhlYWQgKyAwXSwgYnVm
WzIgKiBoZWFkICsgMV0sCi0JCQkgIGV4ZWNsaXN0cy0+YWN0aXZlKTsKKwkJCSAgYnVmWzIgKiBo
ZWFkICsgMF0sIGJ1ZlsyICogaGVhZCArIDFdKTsKIAogCQlzdGF0dXMgPSBidWZbMiAqIGhlYWRd
OwotCQlpZiAoc3RhdHVzICYgKEdFTjhfQ1RYX1NUQVRVU19JRExFX0FDVElWRSB8Ci0JCQkgICAg
ICBHRU44X0NUWF9TVEFUVVNfUFJFRU1QVEVEKSkKLQkJCWV4ZWNsaXN0c19zZXRfYWN0aXZlKGV4
ZWNsaXN0cywKLQkJCQkJICAgICBFWEVDTElTVFNfQUNUSVZFX0hXQUNLKTsKLQkJaWYgKHN0YXR1
cyAmIEdFTjhfQ1RYX1NUQVRVU19BQ1RJVkVfSURMRSkKLQkJCWV4ZWNsaXN0c19jbGVhcl9hY3Rp
dmUoZXhlY2xpc3RzLAotCQkJCQkgICAgICAgRVhFQ0xJU1RTX0FDVElWRV9IV0FDSyk7Ci0KLQkJ
aWYgKCEoc3RhdHVzICYgR0VOOF9DVFhfU1RBVFVTX0NPTVBMRVRFRF9NQVNLKSkKLQkJCWNvbnRp
bnVlOwotCi0JCS8qIFdlIHNob3VsZCBuZXZlciBnZXQgYSBDT01QTEVURUQgfCBJRExFX0FDVElW
RSEgKi8KLQkJR0VNX0JVR19PTihzdGF0dXMgJiBHRU44X0NUWF9TVEFUVVNfSURMRV9BQ1RJVkUp
OworCQlpZiAoc3RhdHVzICYgR0VOOF9DVFhfU1RBVFVTX0lETEVfQUNUSVZFKSB7Citwcm9tb3Rl
OgorCQkJR0VNX0JVR19PTighYXNzZXJ0X3BlbmRpbmdfdmFsaWQoZXhlY2xpc3RzLCAicHJvbW90
ZSIpKTsKKwkJCWV4ZWNsaXN0cy0+YWN0aXZlID0KKwkJCQltZW1jcHkoZXhlY2xpc3RzLT5pbmZs
aWdodCwKKwkJCQkgICAgICAgZXhlY2xpc3RzLT5wZW5kaW5nLAorCQkJCSAgICAgICBleGVjbGlz
dHNfbnVtX3BvcnRzKGV4ZWNsaXN0cykgKgorCQkJCSAgICAgICBzaXplb2YoKmV4ZWNsaXN0cy0+
cGVuZGluZykpOworCQkJZXhlY2xpc3RzLT5wZW5kaW5nWzBdID0gTlVMTDsKIAotCQlpZiAoc3Rh
dHVzICYgR0VOOF9DVFhfU1RBVFVTX0NPTVBMRVRFICYmCi0JCSAgICBidWZbMipoZWFkICsgMV0g
PT0gZXhlY2xpc3RzLT5wcmVlbXB0X2NvbXBsZXRlX3N0YXR1cykgewotCQkJR0VNX1RSQUNFKCIl
cyBwcmVlbXB0LWlkbGVcbiIsIGVuZ2luZS0+bmFtZSk7Ci0JCQljb21wbGV0ZV9wcmVlbXB0X2Nv
bnRleHQoZXhlY2xpc3RzKTsKLQkJCWNvbnRpbnVlOwotCQl9CisJCQlpZiAoIWluamVjdF9wcmVl
bXB0X2hhbmcoZXhlY2xpc3RzKSkKKwkJCQlyaW5nX3N1c3BlbmQoZW5naW5lKSA9IDA7CisJCX0g
ZWxzZSBpZiAoc3RhdHVzICYgR0VOOF9DVFhfU1RBVFVTX1BSRUVNUFRFRCkgeworCQkJc3RydWN0
IGk5MTVfcmVxdWVzdCAqIGNvbnN0ICpwb3J0ID0gZXhlY2xpc3RzLT5hY3RpdmU7CiAKLQkJaWYg
KHN0YXR1cyAmIEdFTjhfQ1RYX1NUQVRVU19QUkVFTVBURUQgJiYKLQkJICAgIGV4ZWNsaXN0c19p
c19hY3RpdmUoZXhlY2xpc3RzLAotCQkJCQlFWEVDTElTVFNfQUNUSVZFX1BSRUVNUFQpKQotCQkJ
Y29udGludWU7CisJCQl0cmFjZV9wb3J0cyhleGVjbGlzdHMsICJwcmVlbXB0ZWQiLCBleGVjbGlz
dHMtPmFjdGl2ZSk7CiAKLQkJR0VNX0JVR19PTighZXhlY2xpc3RzX2lzX2FjdGl2ZShleGVjbGlz
dHMsCi0JCQkJCQlFWEVDTElTVFNfQUNUSVZFX1VTRVIpKTsKKwkJCXdoaWxlICgqcG9ydCkKKwkJ
CQlleGVjbGlzdHNfc2NoZWR1bGVfb3V0KCpwb3J0KyspOwogCi0JCXJxID0gcG9ydF91bnBhY2so
cG9ydCwgJmNvdW50KTsKLQkJR0VNX1RSQUNFKCIlcyBvdXRbMF06IGN0eD0lZC4lZCwgZmVuY2Ug
JWxseDolbGxkIChjdXJyZW50ICVkKSwgcHJpbz0lZFxuIiwKLQkJCSAgZW5naW5lLT5uYW1lLAot
CQkJICBwb3J0LT5jb250ZXh0X2lkLCBjb3VudCwKLQkJCSAgcnEgPyBycS0+ZmVuY2UuY29udGV4
dCA6IDAsCi0JCQkgIHJxID8gcnEtPmZlbmNlLnNlcW5vIDogMCwKLQkJCSAgcnEgPyBod3NwX3Nl
cW5vKHJxKSA6IDAsCi0JCQkgIHJxID8gcnFfcHJpbyhycSkgOiAwKTsKKwkJCWdvdG8gcHJvbW90
ZTsKKwkJfSBlbHNlIGlmICgqZXhlY2xpc3RzLT5hY3RpdmUpIHsKKwkJCXN0cnVjdCBpOTE1X3Jl
cXVlc3QgKnJxID0gKmV4ZWNsaXN0cy0+YWN0aXZlKys7CiAKLQkJLyogQ2hlY2sgdGhlIGNvbnRl
eHQvZGVzYyBpZCBmb3IgdGhpcyBldmVudCBtYXRjaGVzICovCi0JCUdFTV9ERUJVR19CVUdfT04o
YnVmWzIgKiBoZWFkICsgMV0gIT0gcG9ydC0+Y29udGV4dF9pZCk7Ci0KLQkJR0VNX0JVR19PTihj
b3VudCA9PSAwKTsKLQkJaWYgKC0tY291bnQgPT0gMCkgewotCQkJLyoKLQkJCSAqIE9uIHRoZSBm
aW5hbCBldmVudCBjb3JyZXNwb25kaW5nIHRvIHRoZQotCQkJICogc3VibWlzc2lvbiBvZiB0aGlz
IGNvbnRleHQsIHdlIGV4cGVjdCBlaXRoZXIKLQkJCSAqIGFuIGVsZW1lbnQtc3dpdGNoIGV2ZW50
IG9yIGEgY29tcGxldGlvbgotCQkJICogZXZlbnQgKGFuZCBvbiBjb21wbGV0aW9uLCB0aGUgYWN0
aXZlLWlkbGUKLQkJCSAqIG1hcmtlcikuIE5vIG1vcmUgcHJlZW1wdGlvbnMsIGxpdGUtcmVzdG9y
ZQotCQkJICogb3Igb3RoZXJ3aXNlLgotCQkJICovCi0JCQlHRU1fQlVHX09OKHN0YXR1cyAmIEdF
TjhfQ1RYX1NUQVRVU19QUkVFTVBURUQpOwotCQkJR0VNX0JVR19PTihwb3J0X2lzc2V0KCZwb3J0
WzFdKSAmJgotCQkJCSAgICEoc3RhdHVzICYgR0VOOF9DVFhfU1RBVFVTX0VMRU1FTlRfU1dJVENI
KSk7Ci0JCQlHRU1fQlVHX09OKCFwb3J0X2lzc2V0KCZwb3J0WzFdKSAmJgotCQkJCSAgICEoc3Rh
dHVzICYgR0VOOF9DVFhfU1RBVFVTX0FDVElWRV9JRExFKSk7CisJCQl0cmFjZV9wb3J0cyhleGVj
bGlzdHMsICJjb21wbGV0ZWQiLAorCQkJCSAgICBleGVjbGlzdHMtPmFjdGl2ZSAtIDEpOwogCiAJ
CQkvKgogCQkJICogV2UgcmVseSBvbiB0aGUgaGFyZHdhcmUgYmVpbmcgc3Ryb25nbHkKQEAgLTEz
MzQsMjEgKzEyOTMsMTAgQEAgc3RhdGljIHZvaWQgcHJvY2Vzc19jc2Ioc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQogCQkJICogdXNlciBpbnRlcnJ1cHQgYW5kIENTQiBpcyBwcm9jZXNz
ZWQuCiAJCQkgKi8KIAkJCUdFTV9CVUdfT04oIWk5MTVfcmVxdWVzdF9jb21wbGV0ZWQocnEpKTsK
KwkJCWV4ZWNsaXN0c19zY2hlZHVsZV9vdXQocnEpOwogCi0JCQlleGVjbGlzdHNfY29udGV4dF9z
Y2hlZHVsZV9vdXQocnEsCi0JCQkJCQkgICAgICAgSU5URUxfQ09OVEVYVF9TQ0hFRFVMRV9PVVQp
OwotCQkJaTkxNV9yZXF1ZXN0X3B1dChycSk7Ci0KLQkJCUdFTV9UUkFDRSgiJXMgY29tcGxldGVk
IGN0eD0lZFxuIiwKLQkJCQkgIGVuZ2luZS0+bmFtZSwgcG9ydC0+Y29udGV4dF9pZCk7Ci0KLQkJ
CXBvcnQgPSBleGVjbGlzdHNfcG9ydF9jb21wbGV0ZShleGVjbGlzdHMsIHBvcnQpOwotCQkJaWYg
KHBvcnRfaXNzZXQocG9ydCkpCi0JCQkJZXhlY2xpc3RzX3VzZXJfYmVnaW4oZXhlY2xpc3RzLCBw
b3J0KTsKLQkJCWVsc2UKLQkJCQlleGVjbGlzdHNfdXNlcl9lbmQoZXhlY2xpc3RzKTsKLQkJfSBl
bHNlIHsKLQkJCXBvcnRfc2V0KHBvcnQsIHBvcnRfcGFjayhycSwgY291bnQpKTsKKwkJCUdFTV9C
VUdfT04oZXhlY2xpc3RzLT5hY3RpdmUgLSBleGVjbGlzdHMtPmluZmxpZ2h0ID4KKwkJCQkgICBl
eGVjbGlzdHNfbnVtX3BvcnRzKGV4ZWNsaXN0cykpOwogCQl9CiAJfSB3aGlsZSAoaGVhZCAhPSB0
YWlsKTsKIApAQCAtMTM3MCwxMSArMTMxOCwxNyBAQCBzdGF0aWMgdm9pZCBwcm9jZXNzX2NzYihz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAKIHN0YXRpYyB2b2lkIF9fZXhlY2xpc3Rz
X3N1Ym1pc3Npb25fdGFza2xldChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpjb25zdCBlbmdpbmUp
CiB7CisJYm9vbCBzdWJtaXQ7CisKIAlsb2NrZGVwX2Fzc2VydF9oZWxkKCZlbmdpbmUtPmFjdGl2
ZS5sb2NrKTsKIAotCXByb2Nlc3NfY3NiKGVuZ2luZSk7Ci0JaWYgKCFleGVjbGlzdHNfaXNfYWN0
aXZlKCZlbmdpbmUtPmV4ZWNsaXN0cywgRVhFQ0xJU1RTX0FDVElWRV9QUkVFTVBUKSkKLQkJZXhl
Y2xpc3RzX2RlcXVldWUoZW5naW5lKTsKKwlkbyB7CisJCXByb2Nlc3NfY3NiKGVuZ2luZSk7CisK
KwkJc3VibWl0ID0gZmFsc2U7CisJCWlmICghZW5naW5lLT5leGVjbGlzdHMucGVuZGluZ1swXSkK
KwkJCXN1Ym1pdCA9IGV4ZWNsaXN0c19kZXF1ZXVlKGVuZ2luZSk7CisJfSB3aGlsZSAoc3VibWl0
KTsKIH0KIAogLyoKQEAgLTEzODYsMTEgKzEzNDAsNiBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNf
c3VibWlzc2lvbl90YXNrbGV0KHVuc2lnbmVkIGxvbmcgZGF0YSkKIAlzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICogY29uc3QgZW5naW5lID0gKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKilkYXRhOwog
CXVuc2lnbmVkIGxvbmcgZmxhZ3M7CiAKLQlHRU1fVFJBQ0UoIiVzIGF3YWtlPz0lZCwgYWN0aXZl
PSV4XG4iLAotCQkgIGVuZ2luZS0+bmFtZSwKLQkJICAhIWludGVsX3dha2VyZWZfYWN0aXZlKCZl
bmdpbmUtPndha2VyZWYpLAotCQkgIGVuZ2luZS0+ZXhlY2xpc3RzLmFjdGl2ZSk7Ci0KIAlzcGlu
X2xvY2tfaXJxc2F2ZSgmZW5naW5lLT5hY3RpdmUubG9jaywgZmxhZ3MpOwogCV9fZXhlY2xpc3Rz
X3N1Ym1pc3Npb25fdGFza2xldChlbmdpbmUpOwogCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmVu
Z2luZS0+YWN0aXZlLmxvY2ssIGZsYWdzKTsKQEAgLTE0MTcsMTIgKzEzNjYsMTYgQEAgc3RhdGlj
IHZvaWQgX19zdWJtaXRfcXVldWVfaW1tKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkK
IAkJdGFza2xldF9oaV9zY2hlZHVsZSgmZXhlY2xpc3RzLT50YXNrbGV0KTsKIH0KIAotc3RhdGlj
IHZvaWQgc3VibWl0X3F1ZXVlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgaW50IHBy
aW8pCitzdGF0aWMgdm9pZCBzdWJtaXRfcXVldWUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lLAorCQkJIGNvbnN0IHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogewotCWlmIChwcmlvID4g
ZW5naW5lLT5leGVjbGlzdHMucXVldWVfcHJpb3JpdHlfaGludCkgewotCQllbmdpbmUtPmV4ZWNs
aXN0cy5xdWV1ZV9wcmlvcml0eV9oaW50ID0gcHJpbzsKLQkJX19zdWJtaXRfcXVldWVfaW1tKGVu
Z2luZSk7Ci0JfQorCXN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3RzICpleGVjbGlzdHMgPSAm
ZW5naW5lLT5leGVjbGlzdHM7CisKKwlpZiAocnFfcHJpbyhycSkgPD0gZXhlY2xpc3RzLT5xdWV1
ZV9wcmlvcml0eV9oaW50KQorCQlyZXR1cm47CisKKwlleGVjbGlzdHMtPnF1ZXVlX3ByaW9yaXR5
X2hpbnQgPSBycV9wcmlvKHJxKTsKKwlfX3N1Ym1pdF9xdWV1ZV9pbW0oZW5naW5lKTsKIH0KIAog
c3RhdGljIHZvaWQgZXhlY2xpc3RzX3N1Ym1pdF9yZXF1ZXN0KHN0cnVjdCBpOTE1X3JlcXVlc3Qg
KnJlcXVlc3QpCkBAIC0xNDM4LDcgKzEzOTEsNyBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfc3Vi
bWl0X3JlcXVlc3Qoc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCkKIAlHRU1fQlVHX09OKFJC
X0VNUFRZX1JPT1QoJmVuZ2luZS0+ZXhlY2xpc3RzLnF1ZXVlLnJiX3Jvb3QpKTsKIAlHRU1fQlVH
X09OKGxpc3RfZW1wdHkoJnJlcXVlc3QtPnNjaGVkLmxpbmspKTsKIAotCXN1Ym1pdF9xdWV1ZShl
bmdpbmUsIHJxX3ByaW8ocmVxdWVzdCkpOworCXN1Ym1pdF9xdWV1ZShlbmdpbmUsIHJlcXVlc3Qp
OwogCiAJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZW5naW5lLT5hY3RpdmUubG9jaywgZmxhZ3Mp
OwogfQpAQCAtMjA5NSwyNyArMjA0OCwxMyBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfcmVzZXRf
cHJlcGFyZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJc3Bpbl91bmxvY2tfaXJx
cmVzdG9yZSgmZW5naW5lLT5hY3RpdmUubG9jaywgZmxhZ3MpOwogfQogCi1zdGF0aWMgYm9vbCBs
cmNfcmVnc19vayhjb25zdCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKLXsKLQljb25zdCBzdHJ1
Y3QgaW50ZWxfcmluZyAqcmluZyA9IHJxLT5yaW5nOwotCWNvbnN0IHUzMiAqcmVncyA9IHJxLT5o
d19jb250ZXh0LT5scmNfcmVnX3N0YXRlOwotCi0JLyogUXVpY2sgc3BvdCBjaGVjayBmb3IgdGhl
IGNvbW1vbiBzaWducyBvZiBjb250ZXh0IGNvcnJ1cHRpb24gKi8KLQotCWlmIChyZWdzW0NUWF9S
SU5HX0JVRkZFUl9DT05UUk9MICsgMV0gIT0KLQkgICAgKFJJTkdfQ1RMX1NJWkUocmluZy0+c2l6
ZSkgfCBSSU5HX1ZBTElEKSkKLQkJcmV0dXJuIGZhbHNlOwotCi0JaWYgKHJlZ3NbQ1RYX1JJTkdf
QlVGRkVSX1NUQVJUICsgMV0gIT0gaTkxNV9nZ3R0X29mZnNldChyaW5nLT52bWEpKQotCQlyZXR1
cm4gZmFsc2U7Ci0KLQlyZXR1cm4gdHJ1ZTsKLX0KLQotc3RhdGljIHZvaWQgcmVzZXRfY3NiX3Bv
aW50ZXJzKHN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3RzICpleGVjbGlzdHMpCitzdGF0aWMg
dm9pZCByZXNldF9jc2JfcG9pbnRlcnMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQog
eworCXN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3RzICogY29uc3QgZXhlY2xpc3RzID0gJmVu
Z2luZS0+ZXhlY2xpc3RzOwogCWNvbnN0IHVuc2lnbmVkIGludCByZXNldF92YWx1ZSA9IGV4ZWNs
aXN0cy0+Y3NiX3NpemUgLSAxOwogCisJcmluZ19zdXNwZW5kKGVuZ2luZSkgPSAwOworCiAJLyoK
IAkgKiBBZnRlciBhIHJlc2V0LCB0aGUgSFcgc3RhcnRzIHdyaXRpbmcgaW50byBDU0IgZW50cnkg
WzBdLiBXZQogCSAqIHRoZXJlZm9yZSBoYXZlIHRvIHNldCBvdXIgSEVBRCBwb2ludGVyIGJhY2sg
b25lIGVudHJ5IHNvIHRoYXQKQEAgLTIxNjIsMTggKzIxMDEsMTkgQEAgc3RhdGljIHZvaWQgX19l
eGVjbGlzdHNfcmVzZXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBib29sIHN0YWxs
ZWQpCiAJcHJvY2Vzc19jc2IoZW5naW5lKTsgLyogZHJhaW4gcHJlZW1wdGlvbiBldmVudHMgKi8K
IAogCS8qIEZvbGxvd2luZyB0aGUgcmVzZXQsIHdlIG5lZWQgdG8gcmVsb2FkIHRoZSBDU0IgcmVh
ZC93cml0ZSBwb2ludGVycyAqLwotCXJlc2V0X2NzYl9wb2ludGVycygmZW5naW5lLT5leGVjbGlz
dHMpOworCXJlc2V0X2NzYl9wb2ludGVycyhlbmdpbmUpOwogCiAJLyoKIAkgKiBTYXZlIHRoZSBj
dXJyZW50bHkgZXhlY3V0aW5nIGNvbnRleHQsIGV2ZW4gaWYgd2UgY29tcGxldGVkCiAJICogaXRz
IHJlcXVlc3QsIGl0IHdhcyBzdGlsbCBydW5uaW5nIGF0IHRoZSB0aW1lIG9mIHRoZQogCSAqIHJl
c2V0IGFuZCB3aWxsIGhhdmUgYmVlbiBjbG9iYmVyZWQuCiAJICovCi0JaWYgKCFwb3J0X2lzc2V0
KGV4ZWNsaXN0cy0+cG9ydCkpCi0JCWdvdG8gb3V0X2NsZWFyOworCXJxID0gZXhlY2xpc3RzX2Fj
dGl2ZShleGVjbGlzdHMpOworCWlmICghcnEpCisJCXJldHVybjsKIAotCXJxID0gcG9ydF9yZXF1
ZXN0KGV4ZWNsaXN0cy0+cG9ydCk7CiAJY2UgPSBycS0+aHdfY29udGV4dDsKKwlycSA9IGFjdGl2
ZV9yZXF1ZXN0KHJxKTsKIAogCS8qCiAJICogQ2F0Y2ggdXAgd2l0aCBhbnkgbWlzc2VkIGNvbnRl
eHQtc3dpdGNoIGludGVycnVwdHMuCkBAIC0yMTg2LDkgKzIxMjYsMTIgQEAgc3RhdGljIHZvaWQg
X19leGVjbGlzdHNfcmVzZXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBib29sIHN0
YWxsZWQpCiAJICovCiAJZXhlY2xpc3RzX2NhbmNlbF9wb3J0X3JlcXVlc3RzKGV4ZWNsaXN0cyk7
CiAKLQlycSA9IGFjdGl2ZV9yZXF1ZXN0KHJxKTsKLQlpZiAoIXJxKQorCWlmICghcnEpIHsKKwkJ
Y2UtPnJpbmctPmhlYWQgPSBjZS0+cmluZy0+dGFpbDsKIAkJZ290byBvdXRfcmVwbGF5OworCX0K
KworCWNlLT5yaW5nLT5oZWFkID0gaW50ZWxfcmluZ193cmFwKGNlLT5yaW5nLCBycS0+aGVhZCk7
CiAKIAkvKgogCSAqIElmIHRoaXMgcmVxdWVzdCBoYXNuJ3Qgc3RhcnRlZCB5ZXQsIGUuZy4gaXQg
aXMgd2FpdGluZyBvbiBhCkBAIC0yMjAyLDcgKzIxNDUsNyBAQCBzdGF0aWMgdm9pZCBfX2V4ZWNs
aXN0c19yZXNldChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIGJvb2wgc3RhbGxlZCkK
IAkgKiBPdGhlcndpc2UsIGlmIHdlIGhhdmUgbm90IHN0YXJ0ZWQgeWV0LCB0aGUgcmVxdWVzdCBz
aG91bGQgcmVwbGF5CiAJICogcGVyZmVjdGx5IGFuZCB3ZSBkbyBub3QgbmVlZCB0byBmbGFnIHRo
ZSByZXN1bHQgYXMgYmVpbmcgZXJyb25lb3VzLgogCSAqLwotCWlmICghaTkxNV9yZXF1ZXN0X3N0
YXJ0ZWQocnEpICYmIGxyY19yZWdzX29rKHJxKSkKKwlpZiAoIWk5MTVfcmVxdWVzdF9zdGFydGVk
KHJxKSkKIAkJZ290byBvdXRfcmVwbGF5OwogCiAJLyoKQEAgLTIyMTcsNyArMjE2MCw3IEBAIHN0
YXRpYyB2b2lkIF9fZXhlY2xpc3RzX3Jlc2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSwgYm9vbCBzdGFsbGVkKQogCSAqIGltYWdlIGJhY2sgdG8gdGhlIGV4cGVjdGVkIHZhbHVlcyB0
byBza2lwIG92ZXIgdGhlIGd1aWx0eSByZXF1ZXN0LgogCSAqLwogCWk5MTVfcmVzZXRfcmVxdWVz
dChycSwgc3RhbGxlZCk7Ci0JaWYgKCFzdGFsbGVkICYmIGxyY19yZWdzX29rKHJxKSkKKwlpZiAo
IXN0YWxsZWQpCiAJCWdvdG8gb3V0X3JlcGxheTsKIAogCS8qCkBAIC0yMjM3LDE3ICsyMTgwLDEz
IEBAIHN0YXRpYyB2b2lkIF9fZXhlY2xpc3RzX3Jlc2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSwgYm9vbCBzdGFsbGVkKQogCWV4ZWNsaXN0c19pbml0X3JlZ19zdGF0ZShyZWdzLCBj
ZSwgZW5naW5lLCBjZS0+cmluZyk7CiAKIG91dF9yZXBsYXk6Ci0JLyogUmVydW4gdGhlIHJlcXVl
c3Q7IGl0cyBwYXlsb2FkIGhhcyBiZWVuIG5ldXRlcmVkIChpZiBndWlsdHkpLiAqLwotCWNlLT5y
aW5nLT5oZWFkID0KLQkJcnEgPyBpbnRlbF9yaW5nX3dyYXAoY2UtPnJpbmcsIHJxLT5oZWFkKSA6
IGNlLT5yaW5nLT50YWlsOworCUdFTV9UUkFDRSgiJXMgcmVwbGF5IHtoZWFkOiUwNHgsIHRhaWw6
JTA0eFxuIiwKKwkJICBlbmdpbmUtPm5hbWUsIGNlLT5yaW5nLT5oZWFkLCBjZS0+cmluZy0+dGFp
bCk7CiAJaW50ZWxfcmluZ191cGRhdGVfc3BhY2UoY2UtPnJpbmcpOwogCV9fZXhlY2xpc3RzX3Vw
ZGF0ZV9yZWdfc3RhdGUoY2UsIGVuZ2luZSk7CiAKIAkvKiBQdXNoIGJhY2sgYW55IGluY29tcGxl
dGUgcmVxdWVzdHMgZm9yIHJlcGxheSBhZnRlciB0aGUgcmVzZXQuICovCiAJX191bndpbmRfaW5j
b21wbGV0ZV9yZXF1ZXN0cyhlbmdpbmUsIDApOwotCi1vdXRfY2xlYXI6Ci0JZXhlY2xpc3RzX2Ns
ZWFyX2FsbF9hY3RpdmUoZXhlY2xpc3RzKTsKIH0KIAogc3RhdGljIHZvaWQgZXhlY2xpc3RzX3Jl
c2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgYm9vbCBzdGFsbGVkKQpAQCAtMjM0
Myw3ICsyMjgyLDYgQEAgc3RhdGljIHZvaWQgZXhlY2xpc3RzX2NhbmNlbF9yZXF1ZXN0cyhzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAKIAlleGVjbGlzdHMtPnF1ZXVlX3ByaW9yaXR5
X2hpbnQgPSBJTlRfTUlOOwogCWV4ZWNsaXN0cy0+cXVldWUgPSBSQl9ST09UX0NBQ0hFRDsKLQlH
RU1fQlVHX09OKHBvcnRfaXNzZXQoZXhlY2xpc3RzLT5wb3J0KSk7CiAKIAlHRU1fQlVHX09OKF9f
dGFza2xldF9pc19lbmFibGVkKCZleGVjbGlzdHMtPnRhc2tsZXQpKTsKIAlleGVjbGlzdHMtPnRh
c2tsZXQuZnVuYyA9IG5vcF9zdWJtaXNzaW9uX3Rhc2tsZXQ7CkBAIC0yNTYxLDE1ICsyNDk5LDI5
IEBAIHN0YXRpYyB1MzIgKmdlbjhfZW1pdF93YV90YWlsKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJl
cXVlc3QsIHUzMiAqY3MpCiAJcmV0dXJuIGNzOwogfQogCitzdGF0aWMgdTMyICplbWl0X3ByZWVt
cHRfYnVzeXdhaXQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCwgdTMyICpjcykKK3sKKwkq
Y3MrKyA9IE1JX1NFTUFQSE9SRV9XQUlUIHwKKwkJTUlfU0VNQVBIT1JFX0dMT0JBTF9HVFQgfAor
CQlNSV9TRU1BUEhPUkVfUE9MTCB8CisJCU1JX1NFTUFQSE9SRV9TQURfRVFfU0REOworCSpjcysr
ID0gMDsKKwkqY3MrKyA9IGludGVsX2h3c19wcmVlbXB0X2FkZHJlc3MocmVxdWVzdC0+ZW5naW5l
KTsKKwkqY3MrKyA9IDA7CisKKwlyZXR1cm4gY3M7Cit9CisKIHN0YXRpYyB1MzIgKmdlbjhfZW1p
dF9maW5pX2JyZWFkY3J1bWIoc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCwgdTMyICpjcykK
IHsKIAljcyA9IGdlbjhfZW1pdF9nZ3R0X3dyaXRlKGNzLAogCQkJCSAgcmVxdWVzdC0+ZmVuY2Uu
c2Vxbm8sCiAJCQkJICByZXF1ZXN0LT50aW1lbGluZS0+aHdzcF9vZmZzZXQsCiAJCQkJICAwKTsK
LQogCSpjcysrID0gTUlfVVNFUl9JTlRFUlJVUFQ7CisKIAkqY3MrKyA9IE1JX0FSQl9PTl9PRkYg
fCBNSV9BUkJfRU5BQkxFOworCWNzID0gZW1pdF9wcmVlbXB0X2J1c3l3YWl0KHJlcXVlc3QsIGNz
KTsKIAogCXJlcXVlc3QtPnRhaWwgPSBpbnRlbF9yaW5nX29mZnNldChyZXF1ZXN0LCBjcyk7CiAJ
YXNzZXJ0X3JpbmdfdGFpbF92YWxpZChyZXF1ZXN0LT5yaW5nLCByZXF1ZXN0LT50YWlsKTsKQEAg
LTI1ODksOSArMjU0MSwxMCBAQCBzdGF0aWMgdTMyICpnZW44X2VtaXRfZmluaV9icmVhZGNydW1i
X3JjcyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0LCB1MzIgKmNzKQogCQkJCSAgICBQSVBF
X0NPTlRST0xfRkxVU0hfRU5BQkxFIHwKIAkJCQkgICAgUElQRV9DT05UUk9MX0NTX1NUQUxMLAog
CQkJCSAgICAwKTsKLQogCSpjcysrID0gTUlfVVNFUl9JTlRFUlJVUFQ7CisKIAkqY3MrKyA9IE1J
X0FSQl9PTl9PRkYgfCBNSV9BUkJfRU5BQkxFOworCWNzID0gZW1pdF9wcmVlbXB0X2J1c3l3YWl0
KHJlcXVlc3QsIGNzKTsKIAogCXJlcXVlc3QtPnRhaWwgPSBpbnRlbF9yaW5nX29mZnNldChyZXF1
ZXN0LCBjcyk7CiAJYXNzZXJ0X3JpbmdfdGFpbF92YWxpZChyZXF1ZXN0LT5yaW5nLCByZXF1ZXN0
LT50YWlsKTsKQEAgLTI2NDAsOCArMjU5Myw3IEBAIHZvaWQgaW50ZWxfZXhlY2xpc3RzX3NldF9k
ZWZhdWx0X3N1Ym1pc3Npb24oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCWVuZ2lu
ZS0+ZmxhZ3MgfD0gSTkxNV9FTkdJTkVfU1VQUE9SVFNfU1RBVFM7CiAJaWYgKCFpbnRlbF92Z3B1
X2FjdGl2ZShlbmdpbmUtPmk5MTUpKQogCQllbmdpbmUtPmZsYWdzIHw9IEk5MTVfRU5HSU5FX0hB
U19TRU1BUEhPUkVTOwotCWlmIChlbmdpbmUtPnByZWVtcHRfY29udGV4dCAmJgotCSAgICBIQVNf
TE9HSUNBTF9SSU5HX1BSRUVNUFRJT04oZW5naW5lLT5pOTE1KSkKKwlpZiAoSEFTX0xPR0lDQUxf
UklOR19QUkVFTVBUSU9OKGVuZ2luZS0+aTkxNSkpCiAJCWVuZ2luZS0+ZmxhZ3MgfD0gSTkxNV9F
TkdJTkVfSEFTX1BSRUVNUFRJT047CiB9CiAKQEAgLTI3NjMsMTEgKzI3MTUsNiBAQCBpbnQgaW50
ZWxfZXhlY2xpc3RzX3N1Ym1pc3Npb25faW5pdChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpCiAJCQlpOTE1X21taW9fcmVnX29mZnNldChSSU5HX0VMU1AoYmFzZSkpOwogCX0KIAotCWV4
ZWNsaXN0cy0+cHJlZW1wdF9jb21wbGV0ZV9zdGF0dXMgPSB+MHU7Ci0JaWYgKGVuZ2luZS0+cHJl
ZW1wdF9jb250ZXh0KQotCQlleGVjbGlzdHMtPnByZWVtcHRfY29tcGxldGVfc3RhdHVzID0KLQkJ
CXVwcGVyXzMyX2JpdHMoZW5naW5lLT5wcmVlbXB0X2NvbnRleHQtPmxyY19kZXNjKTsKLQogCWV4
ZWNsaXN0cy0+Y3NiX3N0YXR1cyA9CiAJCSZlbmdpbmUtPnN0YXR1c19wYWdlLmFkZHJbSTkxNV9I
V1NfQ1NCX0JVRjBfSU5ERVhdOwogCkBAIC0yNzc5LDcgKzI3MjYsNyBAQCBpbnQgaW50ZWxfZXhl
Y2xpc3RzX3N1Ym1pc3Npb25faW5pdChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJ
ZWxzZQogCQlleGVjbGlzdHMtPmNzYl9zaXplID0gR0VOMTFfQ1NCX0VOVFJJRVM7CiAKLQlyZXNl
dF9jc2JfcG9pbnRlcnMoZXhlY2xpc3RzKTsKKwlyZXNldF9jc2JfcG9pbnRlcnMoZW5naW5lKTsK
IAogCXJldHVybiAwOwogfQpAQCAtMjk2MiwxMSArMjkwOSw2IEBAIHBvcHVsYXRlX2xyX2NvbnRl
eHQoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAogCWlmICghZW5naW5lLT5kZWZhdWx0X3N0YXRl
KQogCQlyZWdzW0NUWF9DT05URVhUX0NPTlRST0wgKyAxXSB8PQogCQkJX01BU0tFRF9CSVRfRU5B
QkxFKENUWF9DVFJMX0VOR0lORV9DVFhfUkVTVE9SRV9JTkhJQklUKTsKLQlpZiAoY2UtPmdlbV9j
b250ZXh0ID09IGVuZ2luZS0+aTkxNS0+cHJlZW1wdF9jb250ZXh0ICYmCi0JICAgIElOVEVMX0dF
TihlbmdpbmUtPmk5MTUpIDwgMTEpCi0JCXJlZ3NbQ1RYX0NPTlRFWFRfQ09OVFJPTCArIDFdIHw9
Ci0JCQlfTUFTS0VEX0JJVF9FTkFCTEUoQ1RYX0NUUkxfRU5HSU5FX0NUWF9SRVNUT1JFX0lOSElC
SVQgfAotCQkJCQkgICBDVFhfQ1RSTF9FTkdJTkVfQ1RYX1NBVkVfSU5ISUJJVCk7CiAKIAlyZXQg
PSAwOwogZXJyX3VucGluX2N0eDoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfZ3B1X2Vycm9yLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jCmlu
ZGV4IDRjYzkwMGU0MzJlMi4uNjdmNTZiNGE0ZTNhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
Z3B1X2Vycm9yLmMKQEAgLTEyNDEsMTAgKzEyNDEsMTAgQEAgc3RhdGljIHZvaWQgZXJyb3JfcmVj
b3JkX2VuZ2luZV9yZWdpc3RlcnMoc3RydWN0IGk5MTVfZ3B1X3N0YXRlICplcnJvciwKIAl9CiB9
CiAKLXN0YXRpYyB2b2lkIHJlY29yZF9yZXF1ZXN0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVl
c3QsCitzdGF0aWMgdm9pZCByZWNvcmRfcmVxdWVzdChjb25zdCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0
ICpyZXF1ZXN0LAogCQkJICAgc3RydWN0IGRybV9pOTE1X2Vycm9yX3JlcXVlc3QgKmVycSkKIHsK
LQlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4ID0gcmVxdWVzdC0+Z2VtX2NvbnRleHQ7CisJ
Y29uc3Qgc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCA9IHJlcXVlc3QtPmdlbV9jb250ZXh0
OwogCiAJZXJxLT5mbGFncyA9IHJlcXVlc3QtPmZlbmNlLmZsYWdzOwogCWVycS0+Y29udGV4dCA9
IHJlcXVlc3QtPmZlbmNlLmNvbnRleHQ7CkBAIC0xMzA4LDIwICsxMzA4LDE1IEBAIHN0YXRpYyB2
b2lkIGVuZ2luZV9yZWNvcmRfcmVxdWVzdHMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
LAogCWVlLT5udW1fcmVxdWVzdHMgPSBjb3VudDsKIH0KIAotc3RhdGljIHZvaWQgZXJyb3JfcmVj
b3JkX2VuZ2luZV9leGVjbGlzdHMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAorc3Rh
dGljIHZvaWQgZXJyb3JfcmVjb3JkX2VuZ2luZV9leGVjbGlzdHMoY29uc3Qgc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lLAogCQkJCQkgIHN0cnVjdCBkcm1faTkxNV9lcnJvcl9lbmdpbmUg
KmVlKQogewogCWNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3RzICogY29uc3QgZXhl
Y2xpc3RzID0gJmVuZ2luZS0+ZXhlY2xpc3RzOwotCXVuc2lnbmVkIGludCBuOworCXN0cnVjdCBp
OTE1X3JlcXVlc3QgKiBjb25zdCAqcG9ydCA9IGV4ZWNsaXN0cy0+YWN0aXZlOworCXVuc2lnbmVk
IGludCBuID0gMDsKIAotCWZvciAobiA9IDA7IG4gPCBleGVjbGlzdHNfbnVtX3BvcnRzKGV4ZWNs
aXN0cyk7IG4rKykgewotCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSA9IHBvcnRfcmVxdWVzdCgm
ZXhlY2xpc3RzLT5wb3J0W25dKTsKLQotCQlpZiAoIXJxKQotCQkJYnJlYWs7Ci0KLQkJcmVjb3Jk
X3JlcXVlc3QocnEsICZlZS0+ZXhlY2xpc3Rbbl0pOwotCX0KKwl3aGlsZSAoKnBvcnQpCisJCXJl
Y29yZF9yZXF1ZXN0KCpwb3J0KyssICZlZS0+ZXhlY2xpc3RbbisrXSk7CiAKIAllZS0+bnVtX3Bv
cnRzID0gbjsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVz
dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMKaW5kZXggYjE0OTFjZTAx
YTc3Li5kNjlhMWE3NWM4YzcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
cmVxdWVzdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jCkBAIC0y
NzYsNiArMjc2LDEyIEBAIHN0YXRpYyBib29sIGk5MTVfcmVxdWVzdF9yZXRpcmUoc3RydWN0IGk5
MTVfcmVxdWVzdCAqcnEpCiAKIAlsb2NhbF9pcnFfZGlzYWJsZSgpOwogCisJLyoKKwkgKiBXZSBv
bmx5IGxvb3NlbHkgdHJhY2sgaW5mbGlnaHQgcmVxdWVzdHMgYWNyb3NzIHByZWVtcHRpb24sCisJ
ICogYW5kIHNvIHdlIG1heSBmaW5kIG91cnNlbHZlcyBhdHRlbXB0aW5nIHRvIHJldGlyZSBhIF9j
b21wbGV0ZWRfCisJICogcmVxdWVzdCB0aGF0IHdlIGhhdmUgcmVtb3ZlZCBmcm9tIHRoZSBIVyBh
bmQgcHV0IGJhY2sgb24gYSBydW4KKwkgKiBxdWV1ZS4KKwkgKi8KIAlzcGluX2xvY2soJnJxLT5l
bmdpbmUtPmFjdGl2ZS5sb2NrKTsKIAlsaXN0X2RlbCgmcnEtPnNjaGVkLmxpbmspOwogCXNwaW5f
dW5sb2NrKCZycS0+ZW5naW5lLT5hY3RpdmUubG9jayk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVx
dWVzdC5oCmluZGV4IGVkYmJkZmVjMjRhYi4uYmViYzFlOWI0YTVlIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3JlcXVlc3QuaApAQCAtMjgsNiArMjgsNyBAQAogI2luY2x1ZGUgPGxpbnV4L2RtYS1m
ZW5jZS5oPgogI2luY2x1ZGUgPGxpbnV4L2xvY2tkZXAuaD4KIAorI2luY2x1ZGUgImd0L2ludGVs
X2NvbnRleHRfdHlwZXMuaCIKICNpbmNsdWRlICJndC9pbnRlbF9lbmdpbmVfdHlwZXMuaCIKIAog
I2luY2x1ZGUgImk5MTVfZ2VtLmgiCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3NjaGVkdWxlci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zY2hlZHVsZXIuYwpp
bmRleCAyY2JhNWI5YjM0YmIuLjdhYTg5MmZmNjU1MCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9zY2hlZHVsZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3NjaGVkdWxlci5jCkBAIC0xNzksOCArMTc5LDcgQEAgc3RhdGljIGlubGluZSBpbnQgcnFfcHJp
byhjb25zdCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIAogc3RhdGljIHZvaWQga2lja19zdWJt
aXNzaW9uKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgaW50IHByaW8pCiB7Ci0JY29u
c3Qgc3RydWN0IGk5MTVfcmVxdWVzdCAqaW5mbGlnaHQgPQotCQlwb3J0X3JlcXVlc3QoZW5naW5l
LT5leGVjbGlzdHMucG9ydCk7CisJY29uc3Qgc3RydWN0IGk5MTVfcmVxdWVzdCAqaW5mbGlnaHQg
PSAqZW5naW5lLT5leGVjbGlzdHMuYWN0aXZlOwogCiAJLyoKIAkgKiBJZiB3ZSBhcmUgYWxyZWFk
eSB0aGUgY3VycmVudGx5IGV4ZWN1dGluZyBjb250ZXh0LCBkb24ndApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV91dGlscy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV91dGlscy5oCmluZGV4IDk5MTFmNTMzODJhNS4uNmUwMTc5ZTc2ZGQ5IDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3V0aWxzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV91dGlscy5oCkBAIC0xMzEsNiArMTMxLDE4IEBAIF9fY2hlY2tfc3RydWN0X3NpemUo
c2l6ZV90IGJhc2UsIHNpemVfdCBhcnIsIHNpemVfdCBjb3VudCwgc2l6ZV90ICpzaXplKQogCSgo
dHlwZW9mKHB0cikpKCh1bnNpZ25lZCBsb25nKShwdHIpIHwgX19iaXRzKSk7CQkJXAogfSkKIAor
I2RlZmluZSBwdHJfY291bnRfZGVjKHBfcHRyKSBkbyB7CQkJCQlcCisJdHlwZW9mKHBfcHRyKSBf
X3AgPSAocF9wdHIpOwkJCQkJXAorCXVuc2lnbmVkIGxvbmcgX192ID0gKHVuc2lnbmVkIGxvbmcp
KCpfX3ApOwkJCVwKKwkqX19wID0gKHR5cGVvZigqcF9wdHIpKSgtLV9fdik7CQkJCQlcCit9IHdo
aWxlICgwKQorCisjZGVmaW5lIHB0cl9jb3VudF9pbmMocF9wdHIpIGRvIHsJCQkJCVwKKwl0eXBl
b2YocF9wdHIpIF9fcCA9IChwX3B0cik7CQkJCQlcCisJdW5zaWduZWQgbG9uZyBfX3YgPSAodW5z
aWduZWQgbG9uZykoKl9fcCk7CQkJXAorCSpfX3AgPSAodHlwZW9mKCpwX3B0cikpKCsrX192KTsJ
CQkJCVwKK30gd2hpbGUgKDApCisKICNkZWZpbmUgcGFnZV9tYXNrX2JpdHMocHRyKSBwdHJfbWFz
a19iaXRzKHB0ciwgUEFHRV9TSElGVCkKICNkZWZpbmUgcGFnZV91bm1hc2tfYml0cyhwdHIpIHB0
cl91bm1hc2tfYml0cyhwdHIsIFBBR0VfU0hJRlQpCiAjZGVmaW5lIHBhZ2VfcGFja19iaXRzKHB0
ciwgYml0cykgcHRyX3BhY2tfYml0cyhwdHIsIGJpdHMsIFBBR0VfU0hJRlQpCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfc3VibWlzc2lvbi5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYwppbmRleCAyNDBjOGEyYWFiYzIuLjMy
YjMzNmQ1ZDg5NyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX3N1
Ym1pc3Npb24uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfc3VibWlzc2lv
bi5jCkBAIC0zMiw3ICszMiwxMSBAQAogI2luY2x1ZGUgImludGVsX2d1Y19zdWJtaXNzaW9uLmgi
CiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKIAotI2RlZmluZSBHVUNfUFJFRU1QVF9GSU5JU0hFRAkJ
MHgxCitlbnVtIHsKKwlHVUNfUFJFRU1QVF9OT05FID0gMCwKKwlHVUNfUFJFRU1QVF9JTlBST0dS
RVNTLAorCUdVQ19QUkVFTVBUX0ZJTklTSEVELAorfTsKICNkZWZpbmUgR1VDX1BSRUVNUFRfQlJF
QURDUlVNQl9EV09SRFMJMHg4CiAjZGVmaW5lIEdVQ19QUkVFTVBUX0JSRUFEQ1JVTUJfQllURVMJ
XAogCShzaXplb2YodTMyKSAqIEdVQ19QUkVFTVBUX0JSRUFEQ1JVTUJfRFdPUkRTKQpAQCAtNTM3
LDE1ICs1NDEsMTEgQEAgc3RhdGljIHZvaWQgZ3VjX2FkZF9yZXF1ZXN0KHN0cnVjdCBpbnRlbF9n
dWMgKmd1Yywgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJdTMyIGN0eF9kZXNjID0gbG93ZXJf
MzJfYml0cyhycS0+aHdfY29udGV4dC0+bHJjX2Rlc2MpOwogCXUzMiByaW5nX3RhaWwgPSBpbnRl
bF9yaW5nX3NldF90YWlsKHJxLT5yaW5nLCBycS0+dGFpbCkgLyBzaXplb2YodTY0KTsKIAotCXNw
aW5fbG9jaygmY2xpZW50LT53cV9sb2NrKTsKLQogCWd1Y193cV9pdGVtX2FwcGVuZChjbGllbnQs
IGVuZ2luZS0+Z3VjX2lkLCBjdHhfZGVzYywKIAkJCSAgIHJpbmdfdGFpbCwgcnEtPmZlbmNlLnNl
cW5vKTsKIAlndWNfcmluZ19kb29yYmVsbChjbGllbnQpOwogCiAJY2xpZW50LT5zdWJtaXNzaW9u
c1tlbmdpbmUtPmlkXSArPSAxOwotCi0Jc3Bpbl91bmxvY2soJmNsaWVudC0+d3FfbG9jayk7CiB9
CiAKIC8qCkBAIC02MzEsOCArNjMxLDkgQEAgc3RhdGljIHZvaWQgaW5qZWN0X3ByZWVtcHRfY29u
dGV4dChzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCiAJZGF0YVs2XSA9IGludGVsX2d1Y19nZ3R0
X29mZnNldChndWMsIGd1Yy0+c2hhcmVkX2RhdGEpOwogCiAJaWYgKFdBUk5fT04oaW50ZWxfZ3Vj
X3NlbmQoZ3VjLCBkYXRhLCBBUlJBWV9TSVpFKGRhdGEpKSkpIHsKLQkJZXhlY2xpc3RzX2NsZWFy
X2FjdGl2ZSgmZW5naW5lLT5leGVjbGlzdHMsCi0JCQkJICAgICAgIEVYRUNMSVNUU19BQ1RJVkVf
UFJFRU1QVCk7CisJCWludGVsX3dyaXRlX3N0YXR1c19wYWdlKGVuZ2luZSwKKwkJCQkJSTkxNV9H
RU1fSFdTX1BSRUVNUFQsCisJCQkJCUdVQ19QUkVFTVBUX05PTkUpOwogCQl0YXNrbGV0X3NjaGVk
dWxlKCZlbmdpbmUtPmV4ZWNsaXN0cy50YXNrbGV0KTsKIAl9CiAKQEAgLTY3Miw4ICs2NzMsNiBA
QCBzdGF0aWMgdm9pZCBjb21wbGV0ZV9wcmVlbXB0X2NvbnRleHQoc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lKQogewogCXN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3RzICpleGVjbGlz
dHMgPSAmZW5naW5lLT5leGVjbGlzdHM7CiAKLQlHRU1fQlVHX09OKCFleGVjbGlzdHNfaXNfYWN0
aXZlKGV4ZWNsaXN0cywgRVhFQ0xJU1RTX0FDVElWRV9QUkVFTVBUKSk7Ci0KIAlpZiAoaW5qZWN0
X3ByZWVtcHRfaGFuZyhleGVjbGlzdHMpKQogCQlyZXR1cm47CiAKQEAgLTY4MSw4OSArNjgwLDkw
IEBAIHN0YXRpYyB2b2lkIGNvbXBsZXRlX3ByZWVtcHRfY29udGV4dChzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmUpCiAJZXhlY2xpc3RzX3Vud2luZF9pbmNvbXBsZXRlX3JlcXVlc3RzKGV4
ZWNsaXN0cyk7CiAKIAl3YWl0X2Zvcl9ndWNfcHJlZW1wdF9yZXBvcnQoZW5naW5lKTsKLQlpbnRl
bF93cml0ZV9zdGF0dXNfcGFnZShlbmdpbmUsIEk5MTVfR0VNX0hXU19QUkVFTVBULCAwKTsKKwlp
bnRlbF93cml0ZV9zdGF0dXNfcGFnZShlbmdpbmUsIEk5MTVfR0VNX0hXU19QUkVFTVBULCBHVUNf
UFJFRU1QVF9OT05FKTsKIH0KIAotLyoqCi0gKiBndWNfc3VibWl0KCkgLSBTdWJtaXQgY29tbWFu
ZHMgdGhyb3VnaCBHdUMKLSAqIEBlbmdpbmU6IGVuZ2luZSBhc3NvY2lhdGVkIHdpdGggdGhlIGNv
bW1hbmRzCi0gKgotICogVGhlIG9ubHkgZXJyb3IgaGVyZSBhcmlzZXMgaWYgdGhlIGRvb3JiZWxs
IGhhcmR3YXJlIGlzbid0IGZ1bmN0aW9uaW5nCi0gKiBhcyBleHBlY3RlZCwgd2hpY2ggcmVhbGx5
IHNob3Vsbid0IGhhcHBlbi4KLSAqLwotc3RhdGljIHZvaWQgZ3VjX3N1Ym1pdChzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUpCitzdGF0aWMgdm9pZCBndWNfc3VibWl0KHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSwKKwkJICAgICAgIHN0cnVjdCBpOTE1X3JlcXVlc3QgKipvdXQs
CisJCSAgICAgICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICoqZW5kKQogewogCXN0cnVjdCBpbnRlbF9n
dWMgKmd1YyA9ICZlbmdpbmUtPmk5MTUtPmd1YzsKLQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNs
aXN0cyAqIGNvbnN0IGV4ZWNsaXN0cyA9ICZlbmdpbmUtPmV4ZWNsaXN0czsKLQlzdHJ1Y3QgZXhl
Y2xpc3RfcG9ydCAqcG9ydCA9IGV4ZWNsaXN0cy0+cG9ydDsKLQl1bnNpZ25lZCBpbnQgbjsKKwlz
dHJ1Y3QgaW50ZWxfZ3VjX2NsaWVudCAqY2xpZW50ID0gZ3VjLT5leGVjYnVmX2NsaWVudDsKIAot
CWZvciAobiA9IDA7IG4gPCBleGVjbGlzdHNfbnVtX3BvcnRzKGV4ZWNsaXN0cyk7IG4rKykgewot
CQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKLQkJdW5zaWduZWQgaW50IGNvdW50OworCXNwaW5f
bG9jaygmY2xpZW50LT53cV9sb2NrKTsKIAotCQlycSA9IHBvcnRfdW5wYWNrKCZwb3J0W25dLCAm
Y291bnQpOwotCQlpZiAocnEgJiYgY291bnQgPT0gMCkgewotCQkJcG9ydF9zZXQoJnBvcnRbbl0s
IHBvcnRfcGFjayhycSwgKytjb3VudCkpOworCWRvIHsKKwkJc3RydWN0IGk5MTVfcmVxdWVzdCAq
cnEgPSAqb3V0Kys7CiAKLQkJCWZsdXNoX2dndHRfd3JpdGVzKHJxLT5yaW5nLT52bWEpOworCQlm
bHVzaF9nZ3R0X3dyaXRlcyhycS0+cmluZy0+dm1hKTsKKwkJZ3VjX2FkZF9yZXF1ZXN0KGd1Yywg
cnEpOworCX0gd2hpbGUgKG91dCAhPSBlbmQpOwogCi0JCQlndWNfYWRkX3JlcXVlc3QoZ3VjLCBy
cSk7Ci0JCX0KLQl9CisJc3Bpbl91bmxvY2soJmNsaWVudC0+d3FfbG9jayk7CiB9CiAKLXN0YXRp
YyB2b2lkIHBvcnRfYXNzaWduKHN0cnVjdCBleGVjbGlzdF9wb3J0ICpwb3J0LCBzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpycSkKK3N0YXRpYyBpbmxpbmUgaW50IHJxX3ByaW8oY29uc3Qgc3RydWN0IGk5
MTVfcmVxdWVzdCAqcnEpCiB7Ci0JR0VNX0JVR19PTihwb3J0X2lzc2V0KHBvcnQpKTsKLQotCXBv
cnRfc2V0KHBvcnQsIGk5MTVfcmVxdWVzdF9nZXQocnEpKTsKKwlyZXR1cm4gcnEtPnNjaGVkLmF0
dHIucHJpb3JpdHkgfCBfX05PX1BSRUVNUFRJT047CiB9CiAKLXN0YXRpYyBpbmxpbmUgaW50IHJx
X3ByaW8oY29uc3Qgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCitzdGF0aWMgc3RydWN0IGk5MTVf
cmVxdWVzdCAqc2NoZWR1bGVfaW4oc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsIGludCBpZHgpCiB7
Ci0JcmV0dXJuIHJxLT5zY2hlZC5hdHRyLnByaW9yaXR5OworCXRyYWNlX2k5MTVfcmVxdWVzdF9p
bihycSwgaWR4KTsKKworCWlmICghcnEtPmh3X2NvbnRleHQtPmluZmxpZ2h0KQorCQlycS0+aHdf
Y29udGV4dC0+aW5mbGlnaHQgPSBycS0+ZW5naW5lOworCWludGVsX2NvbnRleHRfaW5mbGlnaHRf
aW5jKHJxLT5od19jb250ZXh0KTsKKworCXJldHVybiBpOTE1X3JlcXVlc3RfZ2V0KHJxKTsKIH0K
IAotc3RhdGljIGlubGluZSBpbnQgcG9ydF9wcmlvKGNvbnN0IHN0cnVjdCBleGVjbGlzdF9wb3J0
ICpwb3J0KQorc3RhdGljIHZvaWQgc2NoZWR1bGVfb3V0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJx
KQogewotCXJldHVybiBycV9wcmlvKHBvcnRfcmVxdWVzdChwb3J0KSkgfCBfX05PX1BSRUVNUFRJ
T047CisJdHJhY2VfaTkxNV9yZXF1ZXN0X291dChycSk7CisKKwlpbnRlbF9jb250ZXh0X2luZmxp
Z2h0X2RlYyhycS0+aHdfY29udGV4dCk7CisJaWYgKCFpbnRlbF9jb250ZXh0X2luZmxpZ2h0X2Nv
dW50KHJxLT5od19jb250ZXh0KSkKKwkJcnEtPmh3X2NvbnRleHQtPmluZmxpZ2h0ID0gTlVMTDsK
KworCWk5MTVfcmVxdWVzdF9wdXQocnEpOwogfQogCi1zdGF0aWMgYm9vbCBfX2d1Y19kZXF1ZXVl
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3N0YXRpYyB2b2lkIF9fZ3VjX2RlcXVl
dWUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewogCXN0cnVjdCBpbnRlbF9lbmdp
bmVfZXhlY2xpc3RzICogY29uc3QgZXhlY2xpc3RzID0gJmVuZ2luZS0+ZXhlY2xpc3RzOwotCXN0
cnVjdCBleGVjbGlzdF9wb3J0ICpwb3J0ID0gZXhlY2xpc3RzLT5wb3J0OwotCXN0cnVjdCBpOTE1
X3JlcXVlc3QgKmxhc3QgPSBOVUxMOwotCWNvbnN0IHN0cnVjdCBleGVjbGlzdF9wb3J0ICogY29u
c3QgbGFzdF9wb3J0ID0KLQkJJmV4ZWNsaXN0cy0+cG9ydFtleGVjbGlzdHMtPnBvcnRfbWFza107
CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqKmZpcnN0ID0gZXhlY2xpc3RzLT5pbmZsaWdodDsKKwlz
dHJ1Y3QgaTkxNV9yZXF1ZXN0ICoqIGNvbnN0IGxhc3RfcG9ydCA9IGZpcnN0ICsgZXhlY2xpc3Rz
LT5wb3J0X21hc2s7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqbGFzdCA9IGZpcnN0WzBdOworCXN0
cnVjdCBpOTE1X3JlcXVlc3QgKipwb3J0OwogCWJvb2wgc3VibWl0ID0gZmFsc2U7CiAJc3RydWN0
IHJiX25vZGUgKnJiOwogCiAJbG9ja2RlcF9hc3NlcnRfaGVsZCgmZW5naW5lLT5hY3RpdmUubG9j
ayk7CiAKLQlpZiAocG9ydF9pc3NldChwb3J0KSkgeworCWlmIChsYXN0KSB7CiAJCWlmIChpbnRl
bF9lbmdpbmVfaGFzX3ByZWVtcHRpb24oZW5naW5lKSkgewogCQkJc3RydWN0IGd1Y19wcmVlbXB0
X3dvcmsgKnByZWVtcHRfd29yayA9CiAJCQkJJmVuZ2luZS0+aTkxNS0+Z3VjLnByZWVtcHRfd29y
a1tlbmdpbmUtPmlkXTsKIAkJCWludCBwcmlvID0gZXhlY2xpc3RzLT5xdWV1ZV9wcmlvcml0eV9o
aW50OwogCi0JCQlpZiAoaTkxNV9zY2hlZHVsZXJfbmVlZF9wcmVlbXB0KHByaW8sCi0JCQkJCQkJ
cG9ydF9wcmlvKHBvcnQpKSkgewotCQkJCWV4ZWNsaXN0c19zZXRfYWN0aXZlKGV4ZWNsaXN0cywK
LQkJCQkJCSAgICAgRVhFQ0xJU1RTX0FDVElWRV9QUkVFTVBUKTsKKwkJCWlmIChpOTE1X3NjaGVk
dWxlcl9uZWVkX3ByZWVtcHQocHJpbywgcnFfcHJpbyhsYXN0KSkpIHsKKwkJCQlpbnRlbF93cml0
ZV9zdGF0dXNfcGFnZShlbmdpbmUsCisJCQkJCQkJSTkxNV9HRU1fSFdTX1BSRUVNUFQsCisJCQkJ
CQkJR1VDX1BSRUVNUFRfSU5QUk9HUkVTUyk7CiAJCQkJcXVldWVfd29yayhlbmdpbmUtPmk5MTUt
Pmd1Yy5wcmVlbXB0X3dxLAogCQkJCQkgICAmcHJlZW1wdF93b3JrLT53b3JrKTsKLQkJCQlyZXR1
cm4gZmFsc2U7CisJCQkJcmV0dXJuOwogCQkJfQogCQl9CiAKLQkJcG9ydCsrOwotCQlpZiAocG9y
dF9pc3NldChwb3J0KSkKLQkJCXJldHVybiBmYWxzZTsKKwkJaWYgKCorK2ZpcnN0KQorCQkJcmV0
dXJuOworCisJCWxhc3QgPSBOVUxMOwogCX0KLQlHRU1fQlVHX09OKHBvcnRfaXNzZXQocG9ydCkp
OwogCisJcG9ydCA9IGZpcnN0OwogCXdoaWxlICgocmIgPSByYl9maXJzdF9jYWNoZWQoJmV4ZWNs
aXN0cy0+cXVldWUpKSkgewogCQlzdHJ1Y3QgaTkxNV9wcmlvbGlzdCAqcCA9IHRvX3ByaW9saXN0
KHJiKTsKIAkJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsICpybjsKQEAgLTc3NCwxOCArNzc0LDE1
IEBAIHN0YXRpYyBib29sIF9fZ3VjX2RlcXVldWUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lKQogCQkJCWlmIChwb3J0ID09IGxhc3RfcG9ydCkKIAkJCQkJZ290byBkb25lOwogCi0JCQkJ
aWYgKHN1Ym1pdCkKLQkJCQkJcG9ydF9hc3NpZ24ocG9ydCwgbGFzdCk7CisJCQkJKnBvcnQgPSBz
Y2hlZHVsZV9pbihsYXN0LAorCQkJCQkJICAgIHBvcnQgLSBleGVjbGlzdHMtPmluZmxpZ2h0KTsK
IAkJCQlwb3J0Kys7CiAJCQl9CiAKIAkJCWxpc3RfZGVsX2luaXQoJnJxLT5zY2hlZC5saW5rKTsK
LQogCQkJX19pOTE1X3JlcXVlc3Rfc3VibWl0KHJxKTsKLQkJCXRyYWNlX2k5MTVfcmVxdWVzdF9p
bihycSwgcG9ydF9pbmRleChwb3J0LCBleGVjbGlzdHMpKTsKLQotCQkJbGFzdCA9IHJxOwogCQkJ
c3VibWl0ID0gdHJ1ZTsKKwkJCWxhc3QgPSBycTsKIAkJfQogCiAJCXJiX2VyYXNlX2NhY2hlZCgm
cC0+bm9kZSwgJmV4ZWNsaXN0cy0+cXVldWUpOwpAQCAtNzk0LDU4ICs3OTEsNDEgQEAgc3RhdGlj
IGJvb2wgX19ndWNfZGVxdWV1ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiBkb25l
OgogCWV4ZWNsaXN0cy0+cXVldWVfcHJpb3JpdHlfaGludCA9CiAJCXJiID8gdG9fcHJpb2xpc3Qo
cmIpLT5wcmlvcml0eSA6IElOVF9NSU47Ci0JaWYgKHN1Ym1pdCkKLQkJcG9ydF9hc3NpZ24ocG9y
dCwgbGFzdCk7Ci0JaWYgKGxhc3QpCi0JCWV4ZWNsaXN0c191c2VyX2JlZ2luKGV4ZWNsaXN0cywg
ZXhlY2xpc3RzLT5wb3J0KTsKLQotCS8qIFdlIG11c3QgYWx3YXlzIGtlZXAgdGhlIGJlYXN0IGZl
ZCBpZiB3ZSBoYXZlIHdvcmsgcGlsZWQgdXAgKi8KLQlHRU1fQlVHX09OKHBvcnRfaXNzZXQoZXhl
Y2xpc3RzLT5wb3J0KSAmJgotCQkgICAhZXhlY2xpc3RzX2lzX2FjdGl2ZShleGVjbGlzdHMsIEVY
RUNMSVNUU19BQ1RJVkVfVVNFUikpOwotCUdFTV9CVUdfT04ocmJfZmlyc3RfY2FjaGVkKCZleGVj
bGlzdHMtPnF1ZXVlKSAmJgotCQkgICAhcG9ydF9pc3NldChleGVjbGlzdHMtPnBvcnQpKTsKLQot
CXJldHVybiBzdWJtaXQ7Ci19Ci0KLXN0YXRpYyB2b2lkIGd1Y19kZXF1ZXVlKHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSkKLXsKLQlpZiAoX19ndWNfZGVxdWV1ZShlbmdpbmUpKQotCQln
dWNfc3VibWl0KGVuZ2luZSk7CisJaWYgKHN1Ym1pdCkgeworCQkqcG9ydCA9IHNjaGVkdWxlX2lu
KGxhc3QsIHBvcnQgLSBleGVjbGlzdHMtPmluZmxpZ2h0KTsKKwkJKisrcG9ydCA9IE5VTEw7CisJ
CWd1Y19zdWJtaXQoZW5naW5lLCBmaXJzdCwgcG9ydCk7CisJfQorCWV4ZWNsaXN0cy0+YWN0aXZl
ID0gZXhlY2xpc3RzLT5pbmZsaWdodDsKIH0KIAogc3RhdGljIHZvaWQgZ3VjX3N1Ym1pc3Npb25f
dGFza2xldCh1bnNpZ25lZCBsb25nIGRhdGEpCiB7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
IGNvbnN0IGVuZ2luZSA9IChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICopZGF0YTsKIAlzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAqIGNvbnN0IGV4ZWNsaXN0cyA9ICZlbmdpbmUtPmV4ZWNs
aXN0czsKLQlzdHJ1Y3QgZXhlY2xpc3RfcG9ydCAqcG9ydCA9IGV4ZWNsaXN0cy0+cG9ydDsKLQlz
dHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKKwlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICoqcG9ydCwgKnJx
OwogCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CiAKIAlzcGluX2xvY2tfaXJxc2F2ZSgmZW5naW5lLT5h
Y3RpdmUubG9jaywgZmxhZ3MpOwogCi0JcnEgPSBwb3J0X3JlcXVlc3QocG9ydCk7Ci0Jd2hpbGUg
KHJxICYmIGk5MTVfcmVxdWVzdF9jb21wbGV0ZWQocnEpKSB7Ci0JCXRyYWNlX2k5MTVfcmVxdWVz
dF9vdXQocnEpOwotCQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKKwlmb3IgKHBvcnQgPSBleGVjbGlz
dHMtPmluZmxpZ2h0OyAocnEgPSAqcG9ydCk7IHBvcnQrKykgeworCQlpZiAoIWk5MTVfcmVxdWVz
dF9jb21wbGV0ZWQocnEpKQorCQkJYnJlYWs7CiAKLQkJcG9ydCA9IGV4ZWNsaXN0c19wb3J0X2Nv
bXBsZXRlKGV4ZWNsaXN0cywgcG9ydCk7Ci0JCWlmIChwb3J0X2lzc2V0KHBvcnQpKSB7Ci0JCQll
eGVjbGlzdHNfdXNlcl9iZWdpbihleGVjbGlzdHMsIHBvcnQpOwotCQkJcnEgPSBwb3J0X3JlcXVl
c3QocG9ydCk7Ci0JCX0gZWxzZSB7Ci0JCQlleGVjbGlzdHNfdXNlcl9lbmQoZXhlY2xpc3RzKTsK
LQkJCXJxID0gTlVMTDsKLQkJfQorCQlzY2hlZHVsZV9vdXQocnEpOworCX0KKwlpZiAocG9ydCAh
PSBleGVjbGlzdHMtPmluZmxpZ2h0KSB7CisJCWludCBpZHggPSBwb3J0IC0gZXhlY2xpc3RzLT5p
bmZsaWdodDsKKwkJaW50IHJlbSA9IEFSUkFZX1NJWkUoZXhlY2xpc3RzLT5pbmZsaWdodCkgLSBp
ZHg7CisJCW1lbW1vdmUoZXhlY2xpc3RzLT5pbmZsaWdodCwgcG9ydCwgcmVtICogc2l6ZW9mKCpw
b3J0KSk7CiAJfQogCi0JaWYgKGV4ZWNsaXN0c19pc19hY3RpdmUoZXhlY2xpc3RzLCBFWEVDTElT
VFNfQUNUSVZFX1BSRUVNUFQpICYmCi0JICAgIGludGVsX3JlYWRfc3RhdHVzX3BhZ2UoZW5naW5l
LCBJOTE1X0dFTV9IV1NfUFJFRU1QVCkgPT0KKwlpZiAoaW50ZWxfcmVhZF9zdGF0dXNfcGFnZShl
bmdpbmUsIEk5MTVfR0VNX0hXU19QUkVFTVBUKSA9PQogCSAgICBHVUNfUFJFRU1QVF9GSU5JU0hF
RCkKIAkJY29tcGxldGVfcHJlZW1wdF9jb250ZXh0KGVuZ2luZSk7CiAKLQlpZiAoIWV4ZWNsaXN0
c19pc19hY3RpdmUoZXhlY2xpc3RzLCBFWEVDTElTVFNfQUNUSVZFX1BSRUVNUFQpKQotCQlndWNf
ZGVxdWV1ZShlbmdpbmUpOworCWlmICghaW50ZWxfcmVhZF9zdGF0dXNfcGFnZShlbmdpbmUsIEk5
MTVfR0VNX0hXU19QUkVFTVBUKSkKKwkJX19ndWNfZGVxdWV1ZShlbmdpbmUpOwogCiAJc3Bpbl91
bmxvY2tfaXJxcmVzdG9yZSgmZW5naW5lLT5hY3RpdmUubG9jaywgZmxhZ3MpOwogfQpAQCAtOTU5
LDcgKzkzOSw2IEBAIHN0YXRpYyB2b2lkIGd1Y19jYW5jZWxfcmVxdWVzdHMoc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lKQogCiAJZXhlY2xpc3RzLT5xdWV1ZV9wcmlvcml0eV9oaW50ID0g
SU5UX01JTjsKIAlleGVjbGlzdHMtPnF1ZXVlID0gUkJfUk9PVF9DQUNIRUQ7Ci0JR0VNX0JVR19P
Tihwb3J0X2lzc2V0KGV4ZWNsaXN0cy0+cG9ydCkpOwogCiAJc3Bpbl91bmxvY2tfaXJxcmVzdG9y
ZSgmZW5naW5lLT5hY3RpdmUubG9jaywgZmxhZ3MpOwogfQpAQCAtMTQyMiw3ICsxNDAxLDcgQEAg
aW50IGludGVsX2d1Y19zdWJtaXNzaW9uX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCiAJ
ICogYW5kIGl0IGlzIGd1YXJhbnRlZWQgdGhhdCBpdCB3aWxsIHJlbW92ZSB0aGUgd29yayBpdGVt
IGZyb20gdGhlCiAJICogcXVldWUgYmVmb3JlIG91ciByZXF1ZXN0IGlzIGNvbXBsZXRlZC4KIAkg
Ki8KLQlCVUlMRF9CVUdfT04oQVJSQVlfU0laRShlbmdpbmUtPmV4ZWNsaXN0cy5wb3J0KSAqCisJ
QlVJTERfQlVHX09OKEFSUkFZX1NJWkUoZW5naW5lLT5leGVjbGlzdHMuaW5mbGlnaHQpICoKIAkJ
ICAgICBzaXplb2Yoc3RydWN0IGd1Y193cV9pdGVtKSAqCiAJCSAgICAgSTkxNV9OVU1fRU5HSU5F
UyA+IEdVQ19XUV9TSVpFKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2Vs
ZnRlc3RzL2k5MTVfcmVxdWVzdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5
MTVfcmVxdWVzdC5jCmluZGV4IDY5M2VhMDk3YzA1Zi4uMjE4NjcxYjI1MGQyIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9yZXF1ZXN0LmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfcmVxdWVzdC5jCkBAIC0zNjcsMTMgKzM2
NywxNSBAQCBzdGF0aWMgaW50IF9faWd0X2JyZWFkY3J1bWJzX3Ntb2tldGVzdCh2b2lkICphcmcp
CiAKIAkJaWYgKCF3YWl0X2V2ZW50X3RpbWVvdXQod2FpdC0+d2FpdCwKIAkJCQkJaTkxNV9zd19m
ZW5jZV9kb25lKHdhaXQpLAotCQkJCQlIWiAvIDIpKSB7CisJCQkJCTUgKiBIWikpIHsKIAkJCXN0
cnVjdCBpOTE1X3JlcXVlc3QgKnJxID0gcmVxdWVzdHNbY291bnQgLSAxXTsKIAotCQkJcHJfZXJy
KCJ3YWl0aW5nIGZvciAlZCBmZW5jZXMgKGxhc3QgJWxseDolbGxkKSBvbiAlcyB0aW1lZCBvdXQh
XG4iLAotCQkJICAgICAgIGNvdW50LAorCQkJcHJfZXJyKCJ3YWl0aW5nIGZvciAlZC8lZCBmZW5j
ZXMgKGxhc3QgJWxseDolbGxkKSBvbiAlcyB0aW1lZCBvdXQhXG4iLAorCQkJICAgICAgIGF0b21p
Y19yZWFkKCZ3YWl0LT5wZW5kaW5nKSwgY291bnQsCiAJCQkgICAgICAgcnEtPmZlbmNlLmNvbnRl
eHQsIHJxLT5mZW5jZS5zZXFubywKIAkJCSAgICAgICB0LT5lbmdpbmUtPm5hbWUpOworCQkJR0VN
X1RSQUNFX0RVTVAoKTsKKwogCQkJaTkxNV9nZW1fc2V0X3dlZGdlZCh0LT5lbmdpbmUtPmk5MTUp
OwogCQkJR0VNX0JVR19PTighaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChycSkpOwogCQkJaTkxNV9z
d19mZW5jZV93YWl0KHdhaXQpOwotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBs
aXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1h
bi9saXN0aW5mby9pbnRlbC1nZng=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id EA8BF49AEF
	for <lists+intel-gfx@lfdr.de>; Tue, 18 Jun 2019 09:43:25 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 670B86E10E;
	Tue, 18 Jun 2019 07:43:24 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B369E6E10D
 for <intel-gfx@lists.freedesktop.org>; Tue, 18 Jun 2019 07:43:04 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16935663-1500050 
 for multiple; Tue, 18 Jun 2019 08:42:39 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 18 Jun 2019 08:41:49 +0100
Message-Id: <20190618074153.16055-22-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190618074153.16055-1-chris@chris-wilson.co.uk>
References: <20190618074153.16055-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 22/26] drm/i915: Coordinate i915_active with its
 own mutex
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Rm9yZ28gdGhlIHN0cnVjdF9tdXRleCBzZXJpYWxpc2F0aW9uIGZvciBpOTE1X2FjdGl2ZSwgYW5k
IGludGVycG9zZSBpdHMKb3duIG11dGV4IGhhbmRsaW5nIGZvciBhY3RpdmUvcmV0aXJlLgoKVGhp
cyBpcyBhIG11bHRpLWxheWVyZWQgc2xlaWdodC1vZi1oYW5kLiBGaXJzdCwgd2UgaGFkIHRvIGVu
c3VyZSB0aGF0IG5vCmFjdGl2ZS9yZXRpcmUgY2FsbGJhY2tzIGFjY2lkZW50YWxseSBpbnZlcnRl
ZCB0aGUgbXV0ZXggb3JkZXJpbmcgcnVsZXMsCm5vciBhc3N1bWVkIHRoYXQgdGhleSB3ZXJlIHRo
ZW1zZWx2ZXMgc2VyaWFsaXNlZCBieSBzdHJ1Y3RfbXV0ZXguIE1vcmUKY2hhbGxlbmdpbmcgdGhv
dWdoLCBpcyB0aGUgcnVsZSBvdmVyIHVwZGF0aW5nIGVsZW1lbnRzIG9mIHRoZSBhY3RpdmUKcmJ0
cmVlLiBJbnN0ZWFkIG9mIHRoZSB3aG9sZSBpOTE1X2FjdGl2ZSBub3cgYmVpbmcgc2VyaWFsaXNl
ZCBieQpzdHJ1Y3RfbXV0ZXgsIGFsbG9jYXRpb25zL3JvdGF0aW9ucyBvZiB0aGUgdHJlZSBhcmUg
c2VyaWFsaXNlZCBieSB0aGUKaTkxNV9hY3RpdmUubXV0ZXggYW5kIGluZGl2aWR1YWwgbm9kZXMg
YXJlIHNlcmlhbGlzZWQgYnkgdGhlIGNhbGxlcgp1c2luZyB0aGUgaTkxNV90aW1lbGluZS5tdXRl
eCAod2UgbmVlZCB0byB1c2UgbmVzdGVkIHNwaW5sb2NrcyB0bwppbnRlcmFjdCB3aXRoIHRoZSBk
bWFfZmVuY2UgY2FsbGJhY2sgbGlzdHMpLgoKVGhlIHBhaW4gcG9pbnQgaGVyZSBpcyB0aGF0IGlu
c3RlYWQgb2YgYSBzaW5nbGUgbXV0ZXggYXJvdW5kIGV4ZWNidWYsIHdlCm5vdyBoYXZlIHRvIHRh
a2UgYSBtdXRleCBmb3IgYWN0aXZlIHRyYWNrZXIgKG9uZSBmb3IgZWFjaCB2bWEsIGNvbnRleHQs
CmV0YykgYW5kIGEgY291cGxlIG9mIHNwaW5sb2NrcyBmb3IgZWFjaCBmZW5jZSB1cGRhdGUuIFRo
ZSBpbXByb3ZlbWVudCBpbgpmaW5lIGdyYWluZWQgbG9ja2luZyBhbGxvd2luZyBmb3IgbXVsdGlw
bGUgY29uY3VycmVudCBjbGllbnRzCihldmVudHVhbGx5ISkgc2hvdWxkIGJlIHdvcnRoIGl0IGlu
IHR5cGljYWwgbG9hZHMuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlz
LXdpbHNvbi5jby51az4KLS0tCiAuLi4vZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZnJvbnRi
dWZmZXIuYyAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfb3Zl
cmxheS5jICB8ICAgNiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRl
eHQuYyAgIHwgIDEyICstCiAuLi4vZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVy
LmMgICAgfCAgIDIgKy0KIC4uLi9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBl
cy5oICB8ICAgMiArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYyAgICAg
ICAgfCAgIDkgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYyAgICAg
ICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYyAgICAgICAg
IHwgIDEwICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYyAgICAgICAg
fCAgMTAgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIuYyAgICAgICAgICB8
ICAgMyAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5jICAgICAgICAgICAgfCAx
NTMgKysrKystLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5oICAgICAgICAg
ICAgfCAzMDUgKysrKy0tLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Fj
dGl2ZV90eXBlcy5oICAgICAgfCAgMTcgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2Vt
LmMgICAgICAgICAgICAgICB8ICA0MiArKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2Vt
X2d0dC5jICAgICAgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1
ZXN0LmMgICAgICAgICAgIHwgIDU4ICstLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVx
dWVzdC5oICAgICAgICAgICB8ICAgMSAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3RpbWVs
aW5lLmMgICAgICAgICAgfCAgIDkgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdGltZWxp
bmVfdHlwZXMuaCAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYyAg
ICAgICAgICAgICAgIHwgIDM2ICstLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5
MTVfYWN0aXZlLmMgIHwgIDM1ICstCiAuLi4vZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX3Rp
bWVsaW5lLmMgICAgfCAgIDIgKy0KIDIyIGZpbGVzIGNoYW5nZWQsIDIzNCBpbnNlcnRpb25zKCsp
LCA0ODYgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9mcm9udGJ1ZmZlci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9mcm9udGJ1ZmZlci5jCmluZGV4IDcxMjgxNDgxNTVkYy4uZTAxNTA5YzY4NzdiIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Zyb250YnVmZmVyLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mcm9udGJ1ZmZlci5jCkBA
IC0yNDgsNyArMjQ4LDcgQEAgaW50ZWxfZnJvbnRidWZmZXJfZ2V0KHN0cnVjdCBkcm1faTkxNV9n
ZW1fb2JqZWN0ICpvYmopCiAJZnJvbnQtPm9iaiA9IG9iajsKIAlrcmVmX2luaXQoJmZyb250LT5y
ZWYpOwogCWF0b21pY19zZXQoJmZyb250LT5iaXRzLCAwKTsKLQlpOTE1X2FjdGl2ZV9pbml0KGk5
MTUsICZmcm9udC0+d3JpdGUsCisJaTkxNV9hY3RpdmVfaW5pdCgmZnJvbnQtPndyaXRlLAogCQkJ
IGZyb250YnVmZmVyX2FjdGl2ZSwKIAkJCSBpOTE1X2FjdGl2ZV9tYXlfc2xlZXAoZnJvbnRidWZm
ZXJfcmV0aXJlKSk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfb3ZlcmxheS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9vdmVy
bGF5LmMKaW5kZXggZjA3NDNhZjc5ZmNiLi5kNTBhMDE5NmIxNjYgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfb3ZlcmxheS5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfb3ZlcmxheS5jCkBAIC0yMzAsNyArMjMwLDggQEAgYWxs
b2NfcmVxdWVzdChzdHJ1Y3QgaW50ZWxfb3ZlcmxheSAqb3ZlcmxheSwgdm9pZCAoKmZuKShzdHJ1
Y3QgaW50ZWxfb3ZlcmxheSAqKSkKIAlpZiAoSVNfRVJSKHJxKSkKIAkJcmV0dXJuIHJxOwogCi0J
ZXJyID0gaTkxNV9hY3RpdmVfcmVmKCZvdmVybGF5LT5sYXN0X2ZsaXAsIHJxLT5mZW5jZS5jb250
ZXh0LCBycSk7CisJZXJyID0gaTkxNV9hY3RpdmVfcmVmKCZvdmVybGF5LT5sYXN0X2ZsaXAsCisJ
CQkgICAgICBycS0+ZmVuY2UuY29udGV4dCwgJnJxLT5mZW5jZSk7CiAJaWYgKGVycikgewogCQlp
OTE1X3JlcXVlc3RfYWRkKHJxKTsKIAkJcmV0dXJuIEVSUl9QVFIoZXJyKTsKQEAgLTEzNjYsOCAr
MTM2Nyw3IEBAIHZvaWQgaW50ZWxfb3ZlcmxheV9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCiAJb3ZlcmxheS0+Y29udHJhc3QgPSA3NTsKIAlvdmVybGF5LT5zYXR1cmF0
aW9uID0gMTQ2OwogCi0JaTkxNV9hY3RpdmVfaW5pdChkZXZfcHJpdiwKLQkJCSAmb3ZlcmxheS0+
bGFzdF9mbGlwLAorCWk5MTVfYWN0aXZlX2luaXQoJm92ZXJsYXktPmxhc3RfZmxpcCwKIAkJCSBO
VUxMLCBpbnRlbF9vdmVybGF5X2xhc3RfZmxpcF9yZXRpcmUpOwogCiAJcmV0ID0gZ2V0X3JlZ2lz
dGVycyhvdmVybGF5LCBPVkVSTEFZX05FRURTX1BIWVNJQ0FMKGRldl9wcml2KSk7CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYwppbmRleCA1NWI4ZjBlMDQ4NDYu
LjFjODg2OWI4ZWMyMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX2NvbnRleHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29u
dGV4dC5jCkBAIC05MTEsMjAgKzkxMSwxOCBAQCBzdGF0aWMgaW50IGNvbnRleHRfYmFycmllcl90
YXNrKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsCiAJCQkJdm9pZCAoKnRhc2spKHZvaWQg
KmRhdGEpLAogCQkJCXZvaWQgKmRhdGEpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSBjdHgtPmk5MTU7CiAJc3RydWN0IGNvbnRleHRfYmFycmllcl90YXNrICpjYjsKIAlzdHJ1
Y3QgaTkxNV9nZW1fZW5naW5lc19pdGVyIGl0OwogCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsK
IAlpbnQgZXJyID0gMDsKIAotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmRybS5zdHJ1Y3Rf
bXV0ZXgpOwogCUdFTV9CVUdfT04oIXRhc2spOwogCiAJY2IgPSBrbWFsbG9jKHNpemVvZigqY2Ip
LCBHRlBfS0VSTkVMKTsKIAlpZiAoIWNiKQogCQlyZXR1cm4gLUVOT01FTTsKIAotCWk5MTVfYWN0
aXZlX2luaXQoaTkxNSwgJmNiLT5iYXNlLCBOVUxMLCBjYl9yZXRpcmUpOworCWk5MTVfYWN0aXZl
X2luaXQoJmNiLT5iYXNlLCBOVUxMLCBjYl9yZXRpcmUpOwogCWVyciA9IGk5MTVfYWN0aXZlX2Fj
cXVpcmUoJmNiLT5iYXNlKTsKIAlpZiAoZXJyKSB7CiAJCWtmcmVlKGNiKTsKQEAgLTk1Niw3ICs5
NTQsOSBAQCBzdGF0aWMgaW50IGNvbnRleHRfYmFycmllcl90YXNrKHN0cnVjdCBpOTE1X2dlbV9j
b250ZXh0ICpjdHgsCiAJCWlmIChlbWl0KQogCQkJZXJyID0gZW1pdChycSwgZGF0YSk7CiAJCWlm
IChlcnIgPT0gMCkKLQkJCWVyciA9IGk5MTVfYWN0aXZlX3JlZigmY2ItPmJhc2UsIHJxLT5mZW5j
ZS5jb250ZXh0LCBycSk7CisJCQllcnIgPSBpOTE1X2FjdGl2ZV9yZWYoJmNiLT5iYXNlLAorCQkJ
CQkgICAgICBycS0+ZmVuY2UuY29udGV4dCwKKwkJCQkJICAgICAgJnJxLT5mZW5jZSk7CiAKIAkJ
aTkxNV9yZXF1ZXN0X2FkZChycSk7CiAJCWlmIChlcnIpCkBAIC0xMTkzLDcgKzExOTMsNyBAQCBn
ZW44X21vZGlmeV9ycGNzKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgc3RydWN0IGludGVsX3Nz
ZXUgc3NldSkKIAkJcmV0dXJuIFBUUl9FUlIocnEpOwogCiAJLyogUXVldWUgdGhpcyBzd2l0Y2gg
YWZ0ZXIgYWxsIG90aGVyIGFjdGl2aXR5IGJ5IHRoaXMgY29udGV4dC4gKi8KLQlyZXQgPSBpOTE1
X2FjdGl2ZV9yZXF1ZXN0X3NldCgmY2UtPnJpbmctPnRpbWVsaW5lLT5sYXN0X3JlcXVlc3QsIHJx
KTsKKwlyZXQgPSBpOTE1X2FjdGl2ZV9mZW5jZV9zZXQoJmNlLT5yaW5nLT50aW1lbGluZS0+bGFz
dF9yZXF1ZXN0LCBycSk7CiAJaWYgKHJldCkKIAkJZ290byBvdXRfYWRkOwogCkBAIC0xMjA1LDcg
KzEyMDUsNyBAQCBnZW44X21vZGlmeV9ycGNzKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgc3Ry
dWN0IGludGVsX3NzZXUgc3NldSkKIAkgKiB3b3JkcyB0cmFuc2ZlciB0aGUgcGlubmVkIGNlIG9i
amVjdCB0byB0cmFja2VkIGFjdGl2ZSByZXF1ZXN0LgogCSAqLwogCUdFTV9CVUdfT04oaTkxNV9h
Y3RpdmVfaXNfaWRsZSgmY2UtPmFjdGl2ZSkpOwotCXJldCA9IGk5MTVfYWN0aXZlX3JlZigmY2Ut
PmFjdGl2ZSwgcnEtPmZlbmNlLmNvbnRleHQsIHJxKTsKKwlyZXQgPSBpOTE1X2FjdGl2ZV9yZWYo
JmNlLT5hY3RpdmUsIHJxLT5mZW5jZS5jb250ZXh0LCAmcnEtPmZlbmNlKTsKIAlpZiAocmV0KQog
CQlnb3RvIG91dF9hZGQ7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9leGVjYnVmZmVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
ZXhlY2J1ZmZlci5jCmluZGV4IDVmYWUwZTUwYWFkMC4uZTg0N2E4MDc5NzA1IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKQEAgLTEzMTcsNyAr
MTMxNyw3IEBAIHJlbG9jYXRlX2VudHJ5KHN0cnVjdCBpOTE1X3ZtYSAqdm1hLAogCiAJaWYgKCFl
Yi0+cmVsb2NfY2FjaGUudmFkZHIgJiYKIAkgICAgKERCR19GT1JDRV9SRUxPQyA9PSBGT1JDRV9H
UFVfUkVMT0MgfHwKLQkgICAgICFyZXNlcnZhdGlvbl9vYmplY3RfdGVzdF9zaWduYWxlZF9yY3Uo
dm1hLT5yZXN2LCB0cnVlKSkpIHsKKwkgICAgIGk5MTVfdm1hX2lzX2FjdGl2ZSh2bWEpKSkgewog
CQljb25zdCB1bnNpZ25lZCBpbnQgZ2VuID0gZWItPnJlbG9jX2NhY2hlLmdlbjsKIAkJdW5zaWdu
ZWQgaW50IGxlbjsKIAkJdTMyICpiYXRjaDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaAppbmRleCAyMWJmYjdiZDBmNTcuLmU4N2ZjYTRkODE5
NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90
eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlw
ZXMuaApAQCAtMTEsNiArMTEsOCBAQAogCiAjaW5jbHVkZSA8ZHJtL2RybV9nZW0uaD4KIAorI2lu
Y2x1ZGUgPHVhcGkvZHJtL2k5MTVfZHJtLmg+CisKICNpbmNsdWRlICJpOTE1X2FjdGl2ZS5oIgog
I2luY2x1ZGUgImk5MTVfc2VsZnRlc3QuaCIKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fcG0uYwppbmRleCAwNTAxMWQ0YTNiODguLjM1YjczYzM0Nzg4NyAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKQEAgLTE1LDE0ICsxNSwxMSBAQCBzdGF0aWMgdm9pZCBj
YWxsX2lkbGVfYmFycmllcnMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCXN0cnVj
dCBsbGlzdF9ub2RlICpub2RlLCAqbmV4dDsKIAogCWxsaXN0X2Zvcl9lYWNoX3NhZmUobm9kZSwg
bmV4dCwgbGxpc3RfZGVsX2FsbCgmZW5naW5lLT5iYXJyaWVyX3Rhc2tzKSkgewotCQlzdHJ1Y3Qg
aTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlID0KKwkJc3RydWN0IGRtYV9mZW5jZV9jYiAqY2Ig
PQogCQkJY29udGFpbmVyX29mKChzdHJ1Y3QgbGlzdF9oZWFkICopbm9kZSwKLQkJCQkgICAgIHR5
cGVvZigqYWN0aXZlKSwgbGluayk7CisJCQkJICAgICB0eXBlb2YoKmNiKSwgbm9kZSk7CiAKLQkJ
SU5JVF9MSVNUX0hFQUQoJmFjdGl2ZS0+bGluayk7Ci0JCVJDVV9JTklUX1BPSU5URVIoYWN0aXZl
LT5yZXF1ZXN0LCBOVUxMKTsKLQotCQlhY3RpdmUtPnJldGlyZShhY3RpdmUsIE5VTEwpOworCQlj
Yi0+ZnVuYyhOVUxMLCBjYik7CiAJfQogfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9j
b250ZXh0LmMKaW5kZXggNzBkM2IyNTY4MjI3Li5kMTA4Y2E4ZjI4MzIgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMKQEAgLTE4NCw3ICsxODQsNyBAQCBpbnRlbF9jb250
ZXh0X2luaXQoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAogCiAJbXV0ZXhfaW5pdCgmY2UtPnBp
bl9tdXRleCk7CiAKLQlpOTE1X2FjdGl2ZV9pbml0KGN0eC0+aTkxNSwgJmNlLT5hY3RpdmUsCisJ
aTkxNV9hY3RpdmVfaW5pdCgmY2UtPmFjdGl2ZSwKIAkJCSBfX2ludGVsX2NvbnRleHRfYWN0aXZl
LCBfX2ludGVsX2NvbnRleHRfcmV0aXJlKTsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X3Jlc2V0LmMKaW5kZXggNGM0NzhiMzhlNDIwLi5kMjA0YWFkZjVkNmYgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwpAQCAtODgyLDEwICs4ODIsMTAgQEAgc3RhdGljIGJvb2wg
X19pOTE1X2dlbV91bnNldF93ZWRnZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJ
ICovCiAJbXV0ZXhfbG9jaygmaTkxNS0+Z3QudGltZWxpbmVzLm11dGV4KTsKIAlsaXN0X2Zvcl9l
YWNoX2VudHJ5KHRsLCAmaTkxNS0+Z3QudGltZWxpbmVzLmFjdGl2ZV9saXN0LCBsaW5rKSB7Ci0J
CXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOworCQlzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZTsKIAot
CQlycSA9IGk5MTVfYWN0aXZlX3JlcXVlc3RfZ2V0X3VubG9ja2VkKCZ0bC0+bGFzdF9yZXF1ZXN0
KTsKLQkJaWYgKCFycSkKKwkJZmVuY2UgPSBpOTE1X2FjdGl2ZV9mZW5jZV9nZXQoJnRsLT5sYXN0
X3JlcXVlc3QpOworCQlpZiAoIWZlbmNlKQogCQkJY29udGludWU7CiAKIAkJLyoKQEAgLTg5NSw4
ICs4OTUsOCBAQCBzdGF0aWMgYm9vbCBfX2k5MTVfZ2VtX3Vuc2V0X3dlZGdlZChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkJICogKEk5MTVfRkVOQ0VfVElNRU9VVCkgc28gdGhpcyB3
YWl0IHNob3VsZCBub3QgYmUgdW5ib3VuZGVkCiAJCSAqIGluIHRoZSB3b3JzdCBjYXNlLgogCQkg
Ki8KLQkJZG1hX2ZlbmNlX2RlZmF1bHRfd2FpdCgmcnEtPmZlbmNlLCBmYWxzZSwgTUFYX1NDSEVE
VUxFX1RJTUVPVVQpOwotCQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKKwkJZG1hX2ZlbmNlX2RlZmF1
bHRfd2FpdChmZW5jZSwgZmFsc2UsIE1BWF9TQ0hFRFVMRV9USU1FT1VUKTsKKwkJZG1hX2ZlbmNl
X3B1dChmZW5jZSk7CiAJfQogCW11dGV4X3VubG9jaygmaTkxNS0+Z3QudGltZWxpbmVzLm11dGV4
KTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwppbmRleCAwYzk3Zjk1M2U5
MDguLmEzOTFmZDUyYWRiYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2Vs
ZnRlc3RfbHJjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMK
QEAgLTg1NCw5ICs4NTQsMTMgQEAgc3RhdGljIHN0cnVjdCBpOTE1X3JlcXVlc3QgKmR1bW15X3Jl
cXVlc3Qoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCWlmICghcnEpCiAJCXJldHVy
biBOVUxMOwogCi0JSU5JVF9MSVNUX0hFQUQoJnJxLT5hY3RpdmVfbGlzdCk7CiAJcnEtPmVuZ2lu
ZSA9IGVuZ2luZTsKIAorCXNwaW5fbG9ja19pbml0KCZycS0+bG9jayk7CisJSU5JVF9MSVNUX0hF
QUQoJnJxLT5mZW5jZS5jYl9saXN0KTsKKwlycS0+ZmVuY2UubG9jayA9ICZycS0+bG9jazsKKwly
cS0+ZmVuY2Uub3BzID0gJmk5MTVfZmVuY2Vfb3BzOworCiAJaTkxNV9zY2hlZF9ub2RlX2luaXQo
JnJxLT5zY2hlZCk7CiAKIAkvKiBtYXJrIHRoaXMgcmVxdWVzdCBhcyBwZXJtYW5lbnRseSBpbmNv
bXBsZXRlICovCkBAIC05NDUsOCArOTQ5LDggQEAgc3RhdGljIGludCBsaXZlX3N1cHByZXNzX3dh
aXRfcHJlZW1wdCh2b2lkICphcmcpCiAJCQkJfQogCiAJCQkJLyogRGlzYWJsZSBORVdDTElFTlQg
cHJvbW90aW9uICovCi0JCQkJX19pOTE1X2FjdGl2ZV9yZXF1ZXN0X3NldCgmcnFbaV0tPnRpbWVs
aW5lLT5sYXN0X3JlcXVlc3QsCi0JCQkJCQkJICBkdW1teSk7CisJCQkJX19pOTE1X2FjdGl2ZV9m
ZW5jZV9zZXQoJnJxW2ldLT50aW1lbGluZS0+bGFzdF9yZXF1ZXN0LAorCQkJCQkJCSZkdW1teS0+
ZmVuY2UpOwogCQkJCWk5MTVfcmVxdWVzdF9hZGQocnFbaV0pOwogCQkJfQogCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndnQvc2NoZWR1bGVyLmMKaW5kZXggMjE0NGZiNDZkMGUxLi5mM2NlYzA3YWI1YWIgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIuYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMKQEAgLTM5MywxMSArMzkzLDggQEAgaW50
ZWxfZ3Z0X3dvcmtsb2FkX3JlcV9hbGxvYyhzdHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29y
a2xvYWQpCiB7CiAJc3RydWN0IGludGVsX3ZncHUgKnZncHUgPSB3b3JrbG9hZC0+dmdwdTsKIAlz
dHJ1Y3QgaW50ZWxfdmdwdV9zdWJtaXNzaW9uICpzID0gJnZncHUtPnN1Ym1pc3Npb247Ci0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKIAlz
dHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKIAotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2
LT5kcm0uc3RydWN0X211dGV4KTsKLQogCWlmICh3b3JrbG9hZC0+cmVxKQogCQlyZXR1cm4gMDsK
IApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMKaW5kZXggNzEwODA1NjA1YmIzLi5jZjMxZWY2
MzcxM2QgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuYwpAQCAtMTIsOCArMTIsNiBAQAog
I2luY2x1ZGUgImk5MTVfYWN0aXZlLmgiCiAjaW5jbHVkZSAiaTkxNV9nbG9iYWxzLmgiCiAKLSNk
ZWZpbmUgQktMKHJlZikgKCYocmVmKS0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCkKLQogLyoKICAq
IEFjdGl2ZSByZWZzIG1lbW9yeSBtYW5hZ2VtZW50CiAgKgpAQCAtMjcsNyArMjUsNyBAQCBzdGF0
aWMgc3RydWN0IGk5MTVfZ2xvYmFsX2FjdGl2ZSB7CiB9IGdsb2JhbDsKIAogc3RydWN0IGFjdGl2
ZV9ub2RlIHsKLQlzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCBiYXNlOworCXN0cnVjdCBpOTE1
X2FjdGl2ZV9mZW5jZSBiYXNlOwogCXN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmOwogCXN0cnVjdCBy
Yl9ub2RlIG5vZGU7CiAJdTY0IHRpbWVsaW5lOwpAQCAtMTIyLDcgKzEyMCw3IEBAIF9fYWN0aXZl
X3JldGlyZShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZikKIAlyZWYtPnJldGlyZShyZWYpOwogCiAJ
cmJ0cmVlX3Bvc3RvcmRlcl9mb3JfZWFjaF9lbnRyeV9zYWZlKGl0LCBuLCAmcm9vdCwgbm9kZSkg
ewotCQlHRU1fQlVHX09OKGk5MTVfYWN0aXZlX3JlcXVlc3RfaXNzZXQoJml0LT5iYXNlKSk7CisJ
CUdFTV9CVUdfT04oaTkxNV9hY3RpdmVfZmVuY2VfaXNzZXQoJml0LT5iYXNlKSk7CiAJCWttZW1f
Y2FjaGVfZnJlZShnbG9iYWwuc2xhYl9jYWNoZSwgaXQpOwogCX0KIH0KQEAgLTE1OCwxMiArMTU2
LDEzIEBAIGFjdGl2ZV9yZXRpcmUoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCiB9CiAKIHN0YXRp
YyB2b2lkCi1ub2RlX3JldGlyZShzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYmFzZSwgc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnEpCitub2RlX3JldGlyZShzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5j
ZSwgc3RydWN0IGRtYV9mZW5jZV9jYiAqY2IpCiB7Ci0JYWN0aXZlX3JldGlyZShjb250YWluZXJf
b2YoYmFzZSwgc3RydWN0IGFjdGl2ZV9ub2RlLCBiYXNlKS0+cmVmKTsKKwlpOTE1X2FjdGl2ZV9m
ZW5jZV9jYihmZW5jZSwgY2IpOworCWFjdGl2ZV9yZXRpcmUoY29udGFpbmVyX29mKGNiLCBzdHJ1
Y3QgYWN0aXZlX25vZGUsIGJhc2UuY2IpLT5yZWYpOwogfQogCi1zdGF0aWMgc3RydWN0IGk5MTVf
YWN0aXZlX3JlcXVlc3QgKgorc3RhdGljIHN0cnVjdCBpOTE1X2FjdGl2ZV9mZW5jZSAqCiBhY3Rp
dmVfaW5zdGFuY2Uoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsIHU2NCBpZHgpCiB7CiAJc3RydWN0
IGFjdGl2ZV9ub2RlICpub2RlLCAqcHJlYWxsb2M7CkBAIC0yMDYsNyArMjA1LDcgQEAgYWN0aXZl
X2luc3RhbmNlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLCB1NjQgaWR4KQogCX0KIAogCW5vZGUg
PSBwcmVhbGxvYzsKLQlpOTE1X2FjdGl2ZV9yZXF1ZXN0X2luaXQoJm5vZGUtPmJhc2UsIE5VTEws
IG5vZGVfcmV0aXJlKTsKKwlfX2k5MTVfYWN0aXZlX2ZlbmNlX2luaXQoJm5vZGUtPmJhc2UsIE5V
TEwsIG5vZGVfcmV0aXJlKTsKIAlub2RlLT5yZWYgPSByZWY7CiAJbm9kZS0+dGltZWxpbmUgPSBp
ZHg7CiAKQEAgLTIyMCw4ICsyMTksNyBAQCBhY3RpdmVfaW5zdGFuY2Uoc3RydWN0IGk5MTVfYWN0
aXZlICpyZWYsIHU2NCBpZHgpCiAJcmV0dXJuICZub2RlLT5iYXNlOwogfQogCi12b2lkIF9faTkx
NV9hY3RpdmVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKLQkJCXN0cnVjdCBp
OTE1X2FjdGl2ZSAqcmVmLAordm9pZCBfX2k5MTVfYWN0aXZlX2luaXQoc3RydWN0IGk5MTVfYWN0
aXZlICpyZWYsCiAJCQlpbnQgKCphY3RpdmUpKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKSwKIAkJ
CXZvaWQgKCpyZXRpcmUpKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKSwKIAkJCXN0cnVjdCBsb2Nr
X2NsYXNzX2tleSAqa2V5KQpAQCAtMjMwLDggKzIyOCw2IEBAIHZvaWQgX19pOTE1X2FjdGl2ZV9p
bml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCiAJZGVidWdfYWN0aXZlX2luaXQo
cmVmKTsKIAotCXJlZi0+aTkxNSA9IGk5MTU7Ci0KIAlyZWYtPmZsYWdzID0gMDsKIAlyZWYtPmFj
dGl2ZSA9IGFjdGl2ZTsKIAlyZWYtPnJldGlyZSA9IHB0cl91bnBhY2tfYml0cyhyZXRpcmUsICZi
aXRzLCAyKTsKQEAgLTI0OCw5ICsyNDQsOSBAQCB2b2lkIF9faTkxNV9hY3RpdmVfaW5pdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAogaW50IGk5MTVfYWN0aXZlX3JlZihzdHJ1Y3Qg
aTkxNV9hY3RpdmUgKnJlZiwKIAkJICAgIHU2NCB0aW1lbGluZSwKLQkJICAgIHN0cnVjdCBpOTE1
X3JlcXVlc3QgKnJxKQorCQkgICAgc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UpCiB7Ci0Jc3RydWN0
IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2ZTsKKwlzdHJ1Y3QgaTkxNV9hY3RpdmVfZmVuY2Ug
KmFjdGl2ZTsKIAlpbnQgZXJyOwogCiAJLyogUHJldmVudCByZWFwaW5nIGluIGNhc2Ugd2UgbWFs
bG9jL3dhaXQgd2hpbGUgYnVpbGRpbmcgdGhlIHRyZWUgKi8KQEAgLTI2NCw5ICsyNjAsOSBAQCBp
bnQgaTkxNV9hY3RpdmVfcmVmKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLAogCQlnb3RvIG91dDsK
IAl9CiAKLQlpZiAoIWk5MTVfYWN0aXZlX3JlcXVlc3RfaXNzZXQoYWN0aXZlKSkKKwlHRU1fQlVH
X09OKCFhdG9taWNfcmVhZCgmcmVmLT5jb3VudCkpOworCWlmICghX19pOTE1X2FjdGl2ZV9mZW5j
ZV9zZXQoYWN0aXZlLCBmZW5jZSkpCiAJCWF0b21pY19pbmMoJnJlZi0+Y291bnQpOwotCV9faTkx
NV9hY3RpdmVfcmVxdWVzdF9zZXQoYWN0aXZlLCBycSk7CiAKIG91dDoKIAlpOTE1X2FjdGl2ZV9y
ZWxlYXNlKHJlZik7CkBAIC0zMjIsNyArMzE4LDE0IEBAIGludCBpOTE1X2FjdGl2ZV93YWl0KHN0
cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQogCX0KIAogCXJidHJlZV9wb3N0b3JkZXJfZm9yX2VhY2hf
ZW50cnlfc2FmZShpdCwgbiwgJnJlZi0+dHJlZSwgbm9kZSkgewotCQllcnIgPSBpOTE1X2FjdGl2
ZV9yZXF1ZXN0X3JldGlyZSgmaXQtPmJhc2UsIEJLTChyZWYpKTsKKwkJc3RydWN0IGRtYV9mZW5j
ZSAqZmVuY2U7CisKKwkJZmVuY2UgPSBpOTE1X2FjdGl2ZV9mZW5jZV9nZXQoJml0LT5iYXNlKTsK
KwkJaWYgKCFmZW5jZSkKKwkJCWNvbnRpbnVlOworCisJCWVyciA9IGRtYV9mZW5jZV93YWl0KGZl
bmNlLCB0cnVlKTsKKwkJZG1hX2ZlbmNlX3B1dChmZW5jZSk7CiAJCWlmIChlcnIpCiAJCQlicmVh
azsKIAl9CkBAIC0zMzgsNDAgKzM0MSw2IEBAIGludCBpOTE1X2FjdGl2ZV93YWl0KHN0cnVjdCBp
OTE1X2FjdGl2ZSAqcmVmKQogCXJldHVybiAwOwogfQogCi1pbnQgaTkxNV9yZXF1ZXN0X2F3YWl0
X2FjdGl2ZV9yZXF1ZXN0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAotCQkJCSAgICAgIHN0cnVj
dCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUpCi17Ci0Jc3RydWN0IGk5MTVfcmVxdWVzdCAq
YmFycmllciA9Ci0JCWk5MTVfYWN0aXZlX3JlcXVlc3RfcmF3KGFjdGl2ZSwgJnJxLT5pOTE1LT5k
cm0uc3RydWN0X211dGV4KTsKLQotCXJldHVybiBiYXJyaWVyID8gaTkxNV9yZXF1ZXN0X2F3YWl0
X2RtYV9mZW5jZShycSwgJmJhcnJpZXItPmZlbmNlKSA6IDA7Ci19Ci0KLWludCBpOTE1X3JlcXVl
c3RfYXdhaXRfYWN0aXZlKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCBzdHJ1Y3QgaTkxNV9hY3Rp
dmUgKnJlZikKLXsKLQlzdHJ1Y3QgYWN0aXZlX25vZGUgKml0LCAqbjsKLQlpbnQgZXJyOwotCi0J
aWYgKFJCX0VNUFRZX1JPT1QoJnJlZi0+dHJlZSkpCi0JCXJldHVybiAwOwotCi0JLyogYXdhaXQg
YWxsb2NhdGVzIGFuZCBzbyB3ZSBuZWVkIHRvIGF2b2lkIGhpdHRpbmcgdGhlIHNocmlua2VyICov
Ci0JZXJyID0gaTkxNV9hY3RpdmVfYWNxdWlyZShyZWYpOwotCWlmIChlcnIpCi0JCXJldHVybiBl
cnI7Ci0KLQltdXRleF9sb2NrKCZyZWYtPm11dGV4KTsKLQlyYnRyZWVfcG9zdG9yZGVyX2Zvcl9l
YWNoX2VudHJ5X3NhZmUoaXQsIG4sICZyZWYtPnRyZWUsIG5vZGUpIHsKLQkJZXJyID0gaTkxNV9y
ZXF1ZXN0X2F3YWl0X2FjdGl2ZV9yZXF1ZXN0KHJxLCAmaXQtPmJhc2UpOwotCQlpZiAoZXJyKQot
CQkJYnJlYWs7Ci0JfQotCW11dGV4X3VubG9jaygmcmVmLT5tdXRleCk7Ci0KLQlpOTE1X2FjdGl2
ZV9yZWxlYXNlKHJlZik7Ci0JcmV0dXJuIGVycjsKLX0KLQogI2lmIElTX0VOQUJMRUQoQ09ORklH
X0RSTV9JOTE1X0RFQlVHX0dFTSkKIHZvaWQgaTkxNV9hY3RpdmVfZmluaShzdHJ1Y3QgaTkxNV9h
Y3RpdmUgKnJlZikKIHsKQEAgLTQwMiwxNCArMzcxLDEzIEBAIGludCBpOTE1X2FjdGl2ZV9hY3F1
aXJlX3ByZWFsbG9jYXRlX2JhcnJpZXIoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsCiAJCQlnb3Rv
IHVud2luZDsKIAkJfQogCi0JCWk5MTVfYWN0aXZlX3JlcXVlc3RfaW5pdCgmbm9kZS0+YmFzZSwK
LQkJCQkJICh2b2lkICopZW5naW5lLCBub2RlX3JldGlyZSk7CisJCV9faTkxNV9hY3RpdmVfZmVu
Y2VfaW5pdCgmbm9kZS0+YmFzZSwgZW5naW5lLCBub2RlX3JldGlyZSk7CiAJCW5vZGUtPnRpbWVs
aW5lID0ga2N0eC0+cmluZy0+dGltZWxpbmUtPmZlbmNlX2NvbnRleHQ7CiAJCW5vZGUtPnJlZiA9
IHJlZjsKIAkJYXRvbWljX2luYygmcmVmLT5jb3VudCk7CiAKIAkJaW50ZWxfZW5naW5lX3BtX2dl
dChlbmdpbmUpOwotCQlsbGlzdF9hZGQoKHN0cnVjdCBsbGlzdF9ub2RlICopJm5vZGUtPmJhc2Uu
bGluaywKKwkJbGxpc3RfYWRkKChzdHJ1Y3QgbGxpc3Rfbm9kZSAqKSZub2RlLT5iYXNlLmNiLm5v
ZGUsCiAJCQkgICZyZWYtPmJhcnJpZXJzKTsKIAl9CiAKQEAgLTQyMCw4ICszODgsOCBAQCBpbnQg
aTkxNV9hY3RpdmVfYWNxdWlyZV9wcmVhbGxvY2F0ZV9iYXJyaWVyKHN0cnVjdCBpOTE1X2FjdGl2
ZSAqcmVmLAogCQlzdHJ1Y3QgYWN0aXZlX25vZGUgKm5vZGU7CiAKIAkJbm9kZSA9IGNvbnRhaW5l
cl9vZigoc3RydWN0IGxpc3RfaGVhZCAqKXBvcywKLQkJCQkgICAgdHlwZW9mKCpub2RlKSwgYmFz
ZS5saW5rKTsKLQkJZW5naW5lID0gKHZvaWQgKilyY3VfYWNjZXNzX3BvaW50ZXIobm9kZS0+YmFz
ZS5yZXF1ZXN0KTsKKwkJCQkgICAgdHlwZW9mKCpub2RlKSwgYmFzZS5jYi5ub2RlKTsKKwkJZW5n
aW5lID0gKHZvaWQgKilyY3VfYWNjZXNzX3BvaW50ZXIobm9kZS0+YmFzZS5mZW5jZSk7CiAKIAkJ
aW50ZWxfZW5naW5lX3BtX3B1dChlbmdpbmUpOwogCQlrZnJlZShub2RlKTsKQEAgLTQ0MiwxMCAr
NDEwLDEwIEBAIHZvaWQgaTkxNV9hY3RpdmVfYWNxdWlyZV9iYXJyaWVyKHN0cnVjdCBpOTE1X2Fj
dGl2ZSAqcmVmKQogCQlzdHJ1Y3QgcmJfbm9kZSAqKnAsICpwYXJlbnQ7CiAKIAkJbm9kZSA9IGNv
bnRhaW5lcl9vZigoc3RydWN0IGxpc3RfaGVhZCAqKXBvcywKLQkJCQkgICAgdHlwZW9mKCpub2Rl
KSwgYmFzZS5saW5rKTsKKwkJCQkgICAgdHlwZW9mKCpub2RlKSwgYmFzZS5jYi5ub2RlKTsKIAot
CQllbmdpbmUgPSAodm9pZCAqKXJjdV9hY2Nlc3NfcG9pbnRlcihub2RlLT5iYXNlLnJlcXVlc3Qp
OwotCQlSQ1VfSU5JVF9QT0lOVEVSKG5vZGUtPmJhc2UucmVxdWVzdCwgRVJSX1BUUigtRUFHQUlO
KSk7CisJCWVuZ2luZSA9ICh2b2lkICopcmN1X2FjY2Vzc19wb2ludGVyKG5vZGUtPmJhc2UuZmVu
Y2UpOworCQlSQ1VfSU5JVF9QT0lOVEVSKG5vZGUtPmJhc2UuZmVuY2UsIEVSUl9QVFIoLUVBR0FJ
TikpOwogCiAJCXBhcmVudCA9IE5VTEw7CiAJCXAgPSAmcmVmLT50cmVlLnJiX25vZGU7CkBAIC00
NjEsNyArNDI5LDcgQEAgdm9pZCBpOTE1X2FjdGl2ZV9hY3F1aXJlX2JhcnJpZXIoc3RydWN0IGk5
MTVfYWN0aXZlICpyZWYpCiAJCXJiX2xpbmtfbm9kZSgmbm9kZS0+bm9kZSwgcGFyZW50LCBwKTsK
IAkJcmJfaW5zZXJ0X2NvbG9yKCZub2RlLT5ub2RlLCAmcmVmLT50cmVlKTsKIAotCQlsbGlzdF9h
ZGQoKHN0cnVjdCBsbGlzdF9ub2RlICopJm5vZGUtPmJhc2UubGluaywKKwkJbGxpc3RfYWRkKChz
dHJ1Y3QgbGxpc3Rfbm9kZSAqKSZub2RlLT5iYXNlLmNiLm5vZGUsCiAJCQkgICZlbmdpbmUtPmJh
cnJpZXJfdGFza3MpOwogCQlpbnRlbF9lbmdpbmVfcG1fcHV0KGVuZ2luZSk7CiAJfQpAQCAtNDcy
LDI5ICs0NDAsNzIgQEAgdm9pZCBpOTE1X3JlcXVlc3RfYWRkX2JhcnJpZXJzKHN0cnVjdCBpOTE1
X3JlcXVlc3QgKnJxKQogewogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSA9IHJxLT5l
bmdpbmU7CiAJc3RydWN0IGxsaXN0X25vZGUgKm5vZGUsICpuZXh0OworCXVuc2lnbmVkIGxvbmcg
ZmxhZ3M7CisKKwlHRU1fQlVHX09OKGludGVsX2VuZ2luZV9pc192aXJ0dWFsKGVuZ2luZSkpOwor
CW5vZGUgPSBsbGlzdF9kZWxfYWxsKCZlbmdpbmUtPmJhcnJpZXJfdGFza3MpOworCWlmICghbm9k
ZSkKKwkJcmV0dXJuOwogCi0JbGxpc3RfZm9yX2VhY2hfc2FmZShub2RlLCBuZXh0LCBsbGlzdF9k
ZWxfYWxsKCZlbmdpbmUtPmJhcnJpZXJfdGFza3MpKQotCQlsaXN0X2FkZF90YWlsKChzdHJ1Y3Qg
bGlzdF9oZWFkICopbm9kZSwgJnJxLT5hY3RpdmVfbGlzdCk7CisJc3Bpbl9sb2NrX2lycXNhdmUo
JnJxLT5sb2NrLCBmbGFncyk7CisJbGxpc3RfZm9yX2VhY2hfc2FmZShub2RlLCBuZXh0LCBub2Rl
KQorCQlsaXN0X2FkZF90YWlsKChzdHJ1Y3QgbGlzdF9oZWFkICopbm9kZSwgJnJxLT5mZW5jZS5j
Yl9saXN0KTsKKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZycS0+bG9jaywgZmxhZ3MpOwogfQog
Ci1pbnQgaTkxNV9hY3RpdmVfcmVxdWVzdF9zZXQoc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3Qg
KmFjdGl2ZSwKLQkJCSAgICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKK3N0cnVjdCBkbWFfZmVu
Y2UgKgorX19pOTE1X2FjdGl2ZV9mZW5jZV9zZXQoc3RydWN0IGk5MTVfYWN0aXZlX2ZlbmNlICph
Y3RpdmUsCisJCQlzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSkKIHsKKwlzdHJ1Y3QgZG1hX2ZlbmNl
ICpwcmV2OworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisKKwkvKiBOQjogdXBkYXRlcyBtdXN0IGJl
IHNlcmlhbGlzZWQgYnkgYW4gb3V0ZXIgdGltZWxpbmUgbXV0ZXggKi8KKwlzcGluX2xvY2tfaXJx
c2F2ZShmZW5jZS0+bG9jaywgZmxhZ3MpOworCUdFTV9CVUdfT04odGVzdF9iaXQoRE1BX0ZFTkNF
X0ZMQUdfU0lHTkFMRURfQklULCAmZmVuY2UtPmZsYWdzKSk7CisKKwlwcmV2ID0gcmN1X2RlcmVm
ZXJlbmNlX3Byb3RlY3RlZChhY3RpdmUtPmZlbmNlLCAxIC8qIHRpbWVsaW5lIG11dGV4ICovKTsK
KwlpZiAocHJldikgeworCQlzcGluX2xvY2tfbmVzdGVkKHByZXYtPmxvY2ssIFNJTkdMRV9ERVBU
SF9ORVNUSU5HKTsKKwkJX19saXN0X2RlbF9lbnRyeSgmYWN0aXZlLT5jYi5ub2RlKTsKKwkJc3Bp
bl91bmxvY2socHJldi0+bG9jayk7CisJCXByZXYgPSByY3VfYWNjZXNzX3BvaW50ZXIoYWN0aXZl
LT5mZW5jZSk7CisJfQorCisJcmN1X2Fzc2lnbl9wb2ludGVyKGFjdGl2ZS0+ZmVuY2UsIGZlbmNl
KTsKKwlsaXN0X2FkZF90YWlsKCZhY3RpdmUtPmNiLm5vZGUsICZmZW5jZS0+Y2JfbGlzdCk7CisK
KwlzcGluX3VubG9ja19pcnFyZXN0b3JlKGZlbmNlLT5sb2NrLCBmbGFncyk7CisKKwlyZXR1cm4g
cHJldjsKK30KKworaW50IGk5MTVfYWN0aXZlX2ZlbmNlX3NldChzdHJ1Y3QgaTkxNV9hY3RpdmVf
ZmVuY2UgKmFjdGl2ZSwKKwkJCSAgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCit7CisJc3RydWN0
IGRtYV9mZW5jZSAqZmVuY2U7CiAJaW50IGVycjsKIAogCS8qIE11c3QgbWFpbnRhaW4gb3JkZXJp
bmcgd3J0IHByZXZpb3VzIGFjdGl2ZSByZXF1ZXN0cyAqLwotCWVyciA9IGk5MTVfcmVxdWVzdF9h
d2FpdF9hY3RpdmVfcmVxdWVzdChycSwgYWN0aXZlKTsKLQlpZiAoZXJyKQotCQlyZXR1cm4gZXJy
OworCXJjdV9yZWFkX2xvY2soKTsKKwlmZW5jZSA9IF9faTkxNV9hY3RpdmVfZmVuY2Vfc2V0KGFj
dGl2ZSwgJnJxLT5mZW5jZSk7CisJaWYgKGZlbmNlKQorCQlmZW5jZSA9IGRtYV9mZW5jZV9nZXRf
cmN1KGZlbmNlKTsKKwlyY3VfcmVhZF91bmxvY2soKTsKKworCWlmIChmZW5jZSkgeworCQllcnIg
PSBpOTE1X3JlcXVlc3RfYXdhaXRfZG1hX2ZlbmNlKHJxLCBmZW5jZSk7CisJCWRtYV9mZW5jZV9w
dXQoZmVuY2UpOworCQlpZiAoZXJyKQorCQkJcmV0dXJuIGVycjsKKwl9CiAKLQlfX2k5MTVfYWN0
aXZlX3JlcXVlc3Rfc2V0KGFjdGl2ZSwgcnEpOwogCXJldHVybiAwOwogfQogCi12b2lkIGk5MTVf
YWN0aXZlX3JldGlyZV9ub29wKHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUsCi0J
CQkgICAgIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QpCit2b2lkIGk5MTVfYWN0aXZlX25v
b3Aoc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UsIHN0cnVjdCBkbWFfZmVuY2VfY2IgKmNiKQogewot
CS8qIFNwYWNlIGxlZnQgaW50ZW50aW9uYWxseSBibGFuayAqLworCWk5MTVfYWN0aXZlX2ZlbmNl
X2NiKGZlbmNlLCBjYik7CiB9CiAKICNpZiBJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9TRUxG
VEVTVCkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmggYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5oCmluZGV4IDkxMWE4MzM4MDA3YS4uZmRm
ODdiYWQ3NmQ1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5o
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmgKQEAgLTEwLDcgKzEwLDkg
QEAKICNpbmNsdWRlIDxsaW51eC9sb2NrZGVwLmg+CiAKICNpbmNsdWRlICJpOTE1X2FjdGl2ZV90
eXBlcy5oIgotI2luY2x1ZGUgImk5MTVfcmVxdWVzdC5oIgorCitzdHJ1Y3QgaTkxNV9yZXF1ZXN0
Oworc3RydWN0IGludGVsX2VuZ2luZV9jczsKIAogLyoKICAqIFdlIHRyZWF0IHJlcXVlc3RzIGFz
IGZlbmNlcy4gVGhpcyBpcyBub3QgYmUgdG8gY29uZnVzZWQgd2l0aCBvdXIKQEAgLTI4LDMwMCAr
MzAsMTAzIEBACiAgKiB3cml0ZSBhY2Nlc3Mgc28gdGhhdCB3ZSBjYW4gcGVyZm9ybSBjb25jdXJy
ZW50IHJlYWQgb3BlcmF0aW9ucyBiZXR3ZWVuCiAgKiB0aGUgQ1BVIGFuZCBHUFUgZW5naW5lcywg
YXMgd2VsbCBhcyB3YWl0aW5nIGZvciBhbGwgcmVuZGVyaW5nIHRvCiAgKiBjb21wbGV0ZSwgb3Ig
d2FpdGluZyBmb3IgdGhlIGxhc3QgR1BVIHVzZXIgb2YgYSAiZmVuY2UgcmVnaXN0ZXIiLiBUaGUK
LSAqIG9iamVjdCB0aGVuIGVtYmVkcyBhICNpOTE1X2FjdGl2ZV9yZXF1ZXN0IHRvIHRyYWNrIHRo
ZSBtb3N0IHJlY2VudCAoaW4KKyAqIG9iamVjdCB0aGVuIGVtYmVkcyBhICNpOTE1X2FjdGl2ZV9m
ZW5jZSB0byB0cmFjayB0aGUgbW9zdCByZWNlbnQgKGluCiAgKiByZXRpcmVtZW50IG9yZGVyKSBy
ZXF1ZXN0IHJlbGV2YW50IGZvciB0aGUgZGVzaXJlZCBtb2RlIG9mIGFjY2Vzcy4KLSAqIFRoZSAj
aTkxNV9hY3RpdmVfcmVxdWVzdCBpcyB1cGRhdGVkIHdpdGggaTkxNV9hY3RpdmVfcmVxdWVzdF9z
ZXQoKSB0bworICogVGhlICNpOTE1X2FjdGl2ZV9mZW5jZSBpcyB1cGRhdGVkIHdpdGggaTkxNV9h
Y3RpdmVfZmVuY2Vfc2V0KCkgdG8KICAqIHRyYWNrIHRoZSBtb3N0IHJlY2VudCBmZW5jZSByZXF1
ZXN0LCB0eXBpY2FsbHkgdGhpcyBpcyBkb25lIGFzIHBhcnQgb2YKICAqIGk5MTVfdm1hX21vdmVf
dG9fYWN0aXZlKCkuCiAgKgotICogV2hlbiB0aGUgI2k5MTVfYWN0aXZlX3JlcXVlc3QgY29tcGxl
dGVzIChpcyByZXRpcmVkKSwgaXQgd2lsbAorICogV2hlbiB0aGUgI2k5MTVfYWN0aXZlX2ZlbmNl
IGNvbXBsZXRlcyAoaXMgcmV0aXJlZCksIGl0IHdpbGwKICAqIHNpZ25hbCBpdHMgY29tcGxldGlv
biB0byB0aGUgb3duZXIgdGhyb3VnaCBhIGNhbGxiYWNrIGFzIHdlbGwgYXMgbWFyawotICogaXRz
ZWxmIGFzIGlkbGUgKGk5MTVfYWN0aXZlX3JlcXVlc3QucmVxdWVzdCA9PSBOVUxMKS4gVGhlIG93
bmVyCisgKiBpdHNlbGYgYXMgaWRsZSAoaTkxNV9hY3RpdmVfZmVuY2UucmVxdWVzdCA9PSBOVUxM
KS4gVGhlIG93bmVyCiAgKiBjYW4gdGhlbiBwZXJmb3JtIGFueSBhY3Rpb24sIHN1Y2ggYXMgZGVs
YXllZCBmcmVlaW5nIG9mIGFuIGFjdGl2ZQogICogcmVzb3VyY2UgaW5jbHVkaW5nIGl0c2VsZi4K
ICAqLwogCi12b2lkIGk5MTVfYWN0aXZlX3JldGlyZV9ub29wKHN0cnVjdCBpOTE1X2FjdGl2ZV9y
ZXF1ZXN0ICphY3RpdmUsCi0JCQkgICAgIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QpOwor
dm9pZCBpOTE1X2FjdGl2ZV9ub29wKHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlLCBzdHJ1Y3QgZG1h
X2ZlbmNlX2NiICpjYik7CiAKIC8qKgotICogaTkxNV9hY3RpdmVfcmVxdWVzdF9pbml0IC0gcHJl
cGFyZXMgdGhlIGFjdGl2aXR5IHRyYWNrZXIgZm9yIHVzZQorICogX19pOTE1X2FjdGl2ZV9mZW5j
ZV9pbml0IC0gcHJlcGFyZXMgdGhlIGFjdGl2aXR5IHRyYWNrZXIgZm9yIHVzZQogICogQGFjdGl2
ZSAtIHRoZSBhY3RpdmUgdHJhY2tlcgotICogQHJxIC0gaW5pdGlhbCByZXF1ZXN0IHRvIHRyYWNr
LCBjYW4gYmUgTlVMTAorICogQGZlbmNlIC0gaW5pdGlhbCBmZW5jZSB0byB0cmFjaywgY2FuIGJl
IE5VTEwKICAqIEBmdW5jIC0gYSBjYWxsYmFjayB3aGVuIHRoZW4gdGhlIHRyYWNrZXIgaXMgcmV0
aXJlZCAoYmVjb21lcyBpZGxlKSwKICAqICAgICAgICAgY2FuIGJlIE5VTEwKICAqCi0gKiBpOTE1
X2FjdGl2ZV9yZXF1ZXN0X2luaXQoKSBwcmVwYXJlcyB0aGUgZW1iZWRkZWQgQGFjdGl2ZSBzdHJ1
Y3QgZm9yIHVzZSBhcwotICogYW4gYWN0aXZpdHkgdHJhY2tlciwgdGhhdCBpcyBmb3IgdHJhY2tp
bmcgdGhlIGxhc3Qga25vd24gYWN0aXZlIHJlcXVlc3QKLSAqIGFzc29jaWF0ZWQgd2l0aCBpdC4g
V2hlbiB0aGUgbGFzdCByZXF1ZXN0IGJlY29tZXMgaWRsZSwgd2hlbiBpdCBpcyByZXRpcmVkCisg
KiBpOTE1X2FjdGl2ZV9mZW5jZV9pbml0KCkgcHJlcGFyZXMgdGhlIGVtYmVkZGVkIEBhY3RpdmUg
c3RydWN0IGZvciB1c2UgYXMKKyAqIGFuIGFjdGl2aXR5IHRyYWNrZXIsIHRoYXQgaXMgZm9yIHRy
YWNraW5nIHRoZSBsYXN0IGtub3duIGFjdGl2ZSBmZW5jZQorICogYXNzb2NpYXRlZCB3aXRoIGl0
LiBXaGVuIHRoZSBsYXN0IGZlbmNlIGJlY29tZXMgaWRsZSwgd2hlbiBpdCBpcyByZXRpcmVkCiAg
KiBhZnRlciBjb21wbGV0aW9uLCB0aGUgb3B0aW9uYWwgY2FsbGJhY2sgQGZ1bmMgaXMgaW52b2tl
ZC4KICAqLwogc3RhdGljIGlubGluZSB2b2lkCi1pOTE1X2FjdGl2ZV9yZXF1ZXN0X2luaXQoc3Ry
dWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2ZSwKLQkJCSBzdHJ1Y3QgaTkxNV9yZXF1ZXN0
ICpycSwKLQkJCSBpOTE1X2FjdGl2ZV9yZXRpcmVfZm4gcmV0aXJlKQorX19pOTE1X2FjdGl2ZV9m
ZW5jZV9pbml0KHN0cnVjdCBpOTE1X2FjdGl2ZV9mZW5jZSAqYWN0aXZlLAorCQkJIHZvaWQgKmZl
bmNlLAorCQkJIGRtYV9mZW5jZV9mdW5jX3QgZm4pCiB7Ci0JUkNVX0lOSVRfUE9JTlRFUihhY3Rp
dmUtPnJlcXVlc3QsIHJxKTsKLQlJTklUX0xJU1RfSEVBRCgmYWN0aXZlLT5saW5rKTsKLQlhY3Rp
dmUtPnJldGlyZSA9IHJldGlyZSA/OiBpOTE1X2FjdGl2ZV9yZXRpcmVfbm9vcDsKKwlSQ1VfSU5J
VF9QT0lOVEVSKGFjdGl2ZS0+ZmVuY2UsIGZlbmNlKTsKKwlhY3RpdmUtPmNiLmZ1bmMgPSBmbiA/
OiBpOTE1X2FjdGl2ZV9ub29wOwogfQogCi0jZGVmaW5lIElOSVRfQUNUSVZFX1JFUVVFU1QobmFt
ZSkgaTkxNV9hY3RpdmVfcmVxdWVzdF9pbml0KChuYW1lKSwgTlVMTCwgTlVMTCkKLQotLyoqCi0g
KiBpOTE1X2FjdGl2ZV9yZXF1ZXN0X3NldCAtIHVwZGF0ZXMgdGhlIHRyYWNrZXIgdG8gd2F0Y2gg
dGhlIGN1cnJlbnQgcmVxdWVzdAotICogQGFjdGl2ZSAtIHRoZSBhY3RpdmUgdHJhY2tlcgotICog
QHJlcXVlc3QgLSB0aGUgcmVxdWVzdCB0byB3YXRjaAotICoKLSAqIF9faTkxNV9hY3RpdmVfcmVx
dWVzdF9zZXQoKSB3YXRjaGVzIHRoZSBnaXZlbiBAcmVxdWVzdCBmb3IgY29tcGxldGlvbi4gV2hp
bHN0Ci0gKiB0aGF0IEByZXF1ZXN0IGlzIGJ1c3ksIHRoZSBAYWN0aXZlIHJlcG9ydHMgYnVzeS4g
V2hlbiB0aGF0IEByZXF1ZXN0IGlzCi0gKiByZXRpcmVkLCB0aGUgQGFjdGl2ZSB0cmFja2VyIGlz
IHVwZGF0ZWQgdG8gcmVwb3J0IGlkbGUuCi0gKi8KLXN0YXRpYyBpbmxpbmUgdm9pZAotX19pOTE1
X2FjdGl2ZV9yZXF1ZXN0X3NldChzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlLAot
CQkJICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0KQotewotCWxpc3RfbW92ZSgmYWN0aXZl
LT5saW5rLCAmcmVxdWVzdC0+YWN0aXZlX2xpc3QpOwotCXJjdV9hc3NpZ25fcG9pbnRlcihhY3Rp
dmUtPnJlcXVlc3QsIHJlcXVlc3QpOwotfQotCi1pbnQgX19tdXN0X2NoZWNrCi1pOTE1X2FjdGl2
ZV9yZXF1ZXN0X3NldChzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlLAotCQkJc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnEpOwotCi0vKioKLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3RfcmF3
IC0gcmV0dXJuIHRoZSBhY3RpdmUgcmVxdWVzdAotICogQGFjdGl2ZSAtIHRoZSBhY3RpdmUgdHJh
Y2tlcgotICoKLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3RfcmF3KCkgcmV0dXJucyB0aGUgY3VycmVu
dCByZXF1ZXN0IGJlaW5nIHRyYWNrZWQsIG9yIE5VTEwuCi0gKiBJdCBkb2VzIG5vdCBvYnRhaW4g
YSByZWZlcmVuY2Ugb24gdGhlIHJlcXVlc3QgZm9yIHRoZSBjYWxsZXIsIHNvIHRoZSBjYWxsZXIK
LSAqIG11c3QgaG9sZCBzdHJ1Y3RfbXV0ZXguCi0gKi8KLXN0YXRpYyBpbmxpbmUgc3RydWN0IGk5
MTVfcmVxdWVzdCAqCi1pOTE1X2FjdGl2ZV9yZXF1ZXN0X3Jhdyhjb25zdCBzdHJ1Y3QgaTkxNV9h
Y3RpdmVfcmVxdWVzdCAqYWN0aXZlLAotCQkJc3RydWN0IG11dGV4ICptdXRleCkKLXsKLQlyZXR1
cm4gcmN1X2RlcmVmZXJlbmNlX3Byb3RlY3RlZChhY3RpdmUtPnJlcXVlc3QsCi0JCQkJCSBsb2Nr
ZGVwX2lzX2hlbGQobXV0ZXgpKTsKLX0KLQotLyoqCi0gKiBpOTE1X2FjdGl2ZV9yZXF1ZXN0X3Bl
ZWsgLSByZXBvcnQgdGhlIGFjdGl2ZSByZXF1ZXN0IGJlaW5nIG1vbml0b3JlZAotICogQGFjdGl2
ZSAtIHRoZSBhY3RpdmUgdHJhY2tlcgotICoKLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3RfcGVlaygp
IHJldHVybnMgdGhlIGN1cnJlbnQgcmVxdWVzdCBiZWluZyB0cmFja2VkIGlmCi0gKiBzdGlsbCBh
Y3RpdmUsIG9yIE5VTEwuIEl0IGRvZXMgbm90IG9idGFpbiBhIHJlZmVyZW5jZSBvbiB0aGUgcmVx
dWVzdAotICogZm9yIHRoZSBjYWxsZXIsIHNvIHRoZSBjYWxsZXIgbXVzdCBob2xkIHN0cnVjdF9t
dXRleC4KLSAqLwotc3RhdGljIGlubGluZSBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICoKLWk5MTVfYWN0
aXZlX3JlcXVlc3RfcGVlayhjb25zdCBzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZl
LAotCQkJIHN0cnVjdCBtdXRleCAqbXV0ZXgpCi17Ci0Jc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVx
dWVzdDsKLQotCXJlcXVlc3QgPSBpOTE1X2FjdGl2ZV9yZXF1ZXN0X3JhdyhhY3RpdmUsIG11dGV4
KTsKLQlpZiAoIXJlcXVlc3QgfHwgaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChyZXF1ZXN0KSkKLQkJ
cmV0dXJuIE5VTEw7CisjZGVmaW5lIElOSVRfQUNUSVZFX0ZFTkNFKEEpIF9faTkxNV9hY3RpdmVf
ZmVuY2VfaW5pdChBLCBOVUxMLCBOVUxMKQogCi0JcmV0dXJuIHJlcXVlc3Q7Ci19CitzdHJ1Y3Qg
ZG1hX2ZlbmNlICoKK19faTkxNV9hY3RpdmVfZmVuY2Vfc2V0KHN0cnVjdCBpOTE1X2FjdGl2ZV9m
ZW5jZSAqYWN0aXZlLAorCQkJc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UpOwogCiAvKioKLSAqIGk5
MTVfYWN0aXZlX3JlcXVlc3RfZ2V0IC0gcmV0dXJuIGEgcmVmZXJlbmNlIHRvIHRoZSBhY3RpdmUg
cmVxdWVzdAorICogaTkxNV9hY3RpdmVfZmVuY2Vfc2V0IC0gdXBkYXRlcyB0aGUgdHJhY2tlciB0
byB3YXRjaCB0aGUgY3VycmVudCBmZW5jZQogICogQGFjdGl2ZSAtIHRoZSBhY3RpdmUgdHJhY2tl
cgorICogQHJxIC0gdGhlIHJlcXVlc3QgdG8gd2F0Y2gKICAqCi0gKiBpOTE1X2FjdGl2ZV9yZXF1
ZXN0X2dldCgpIHJldHVybnMgYSByZWZlcmVuY2UgdG8gdGhlIGFjdGl2ZSByZXF1ZXN0LCBvciBO
VUxMCi0gKiBpZiB0aGUgYWN0aXZlIHRyYWNrZXIgaXMgaWRsZS4gVGhlIGNhbGxlciBtdXN0IGhv
bGQgc3RydWN0X211dGV4LgorICogaTkxNV9hY3RpdmVfZmVuY2Vfc2V0KCkgd2F0Y2hlcyB0aGUg
Z2l2ZW4gQHJxIGZvciBjb21wbGV0aW9uLiBXaGlsZQorICogdGhhdCBAcnEgaXMgYnVzeSwgdGhl
IEBhY3RpdmUgcmVwb3J0cyBidXN5LiBXaGVuIHRoYXQgQHJxIGlzIHNpZ25hbGVkCisgKiAob3Ig
ZWxzZSByZXRpcmVkKSB0aGUgQGFjdGl2ZSB0cmFja2VyIGlzIHVwZGF0ZWQgdG8gcmVwb3J0IGlk
bGUuCiAgKi8KLXN0YXRpYyBpbmxpbmUgc3RydWN0IGk5MTVfcmVxdWVzdCAqCi1pOTE1X2FjdGl2
ZV9yZXF1ZXN0X2dldChjb25zdCBzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlLAot
CQkJc3RydWN0IG11dGV4ICptdXRleCkKLXsKLQlyZXR1cm4gaTkxNV9yZXF1ZXN0X2dldChpOTE1
X2FjdGl2ZV9yZXF1ZXN0X3BlZWsoYWN0aXZlLCBtdXRleCkpOwotfQotCi0vKioKLSAqIF9faTkx
NV9hY3RpdmVfcmVxdWVzdF9nZXRfcmN1IC0gcmV0dXJuIGEgcmVmZXJlbmNlIHRvIHRoZSBhY3Rp
dmUgcmVxdWVzdAotICogQGFjdGl2ZSAtIHRoZSBhY3RpdmUgdHJhY2tlcgotICoKLSAqIF9faTkx
NV9hY3RpdmVfcmVxdWVzdF9nZXQoKSByZXR1cm5zIGEgcmVmZXJlbmNlIHRvIHRoZSBhY3RpdmUg
cmVxdWVzdCwKLSAqIG9yIE5VTEwgaWYgdGhlIGFjdGl2ZSB0cmFja2VyIGlzIGlkbGUuIFRoZSBj
YWxsZXIgbXVzdCBob2xkIHRoZSBSQ1UgcmVhZAotICogbG9jaywgYnV0IHRoZSByZXR1cm5lZCBw
b2ludGVyIGlzIHNhZmUgdG8gdXNlIG91dHNpZGUgb2YgUkNVLgotICovCi1zdGF0aWMgaW5saW5l
IHN0cnVjdCBpOTE1X3JlcXVlc3QgKgotX19pOTE1X2FjdGl2ZV9yZXF1ZXN0X2dldF9yY3UoY29u
c3Qgc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2ZSkKLXsKLQkvKgotCSAqIFBlcmZv
cm1pbmcgYSBsb2NrbGVzcyByZXRyaWV2YWwgb2YgdGhlIGFjdGl2ZSByZXF1ZXN0IGlzIHN1cGVy
Ci0JICogdHJpY2t5LiBTTEFCX1RZUEVTQUZFX0JZX1JDVSBtZXJlbHkgZ3VhcmFudGVlcyB0aGF0
IHRoZSBiYWNraW5nCi0JICogc2xhYiBvZiByZXF1ZXN0IG9iamVjdHMgd2lsbCBub3QgYmUgZnJl
ZWQgd2hpbHN0IHdlIGhvbGQgdGhlCi0JICogUkNVIHJlYWQgbG9jay4gSXQgZG9lcyBub3QgZ3Vh
cmFudGVlIHRoYXQgdGhlIHJlcXVlc3QgaXRzZWxmCi0JICogd2lsbCBub3QgYmUgZnJlZWQgYW5k
IHRoZW4gKnJldXNlZCouIFZpeiwKLQkgKgotCSAqIFRocmVhZCBBCQkJVGhyZWFkIEIKLQkgKgot
CSAqIHJxID0gYWN0aXZlLnJlcXVlc3QKLQkgKgkJCQlyZXRpcmUocnEpIC0+IGZyZWUocnEpOwot
CSAqCQkJCShycSBpcyBub3cgZmlyc3Qgb24gdGhlIHNsYWIgZnJlZWxpc3QpCi0JICoJCQkJYWN0
aXZlLnJlcXVlc3QgPSBOVUxMCi0JICoKLQkgKgkJCQlycSA9IG5ldyBzdWJtaXNzaW9uIG9uIGEg
bmV3IG9iamVjdAotCSAqIHJlZihycSkKLQkgKgotCSAqIFRvIHByZXZlbnQgdGhlIHJlcXVlc3Qg
ZnJvbSBiZWluZyByZXVzZWQgd2hpbHN0IHRoZSBjYWxsZXIKLQkgKiB1c2VzIGl0LCB3ZSB0YWtl
IGEgcmVmZXJlbmNlIGxpa2Ugbm9ybWFsLiBXaGlsc3QgYWNxdWlyaW5nCi0JICogdGhlIHJlZmVy
ZW5jZSB3ZSBjaGVjayB0aGF0IGl0IGlzIG5vdCBpbiBhIGRlc3Ryb3llZCBzdGF0ZQotCSAqIChy
ZWZjbnQgPT0gMCkuIFRoYXQgcHJldmVudHMgdGhlIHJlcXVlc3QgYmVpbmcgcmVhbGxvY2F0ZWQK
LQkgKiB3aGlsc3QgdGhlIGNhbGxlciBob2xkcyBvbiB0byBpdC4gVG8gY2hlY2sgdGhhdCB0aGUg
cmVxdWVzdAotCSAqIHdhcyBub3QgcmVhbGxvY2F0ZWQgYXMgd2UgYWNxdWlyZWQgdGhlIHJlZmVy
ZW5jZSB3ZSBoYXZlIHRvCi0JICogY2hlY2sgdGhhdCBvdXIgcmVxdWVzdCByZW1haW5zIHRoZSBh
Y3RpdmUgcmVxdWVzdCBhY3Jvc3MKLQkgKiB0aGUgbG9va3VwLCBpbiB0aGUgc2FtZSBtYW5uZXIg
YXMgYSBzZXFsb2NrLiBUaGUgdmlzaWJpbGl0eQotCSAqIG9mIHRoZSBwb2ludGVyIHZlcnN1cyB0
aGUgcmVmZXJlbmNlIGNvdW50aW5nIGlzIGNvbnRyb2xsZWQKLQkgKiBieSB1c2luZyBSQ1UgYmFy
cmllcnMgKHJjdV9kZXJlZmVyZW5jZSBhbmQgcmN1X2Fzc2lnbl9wb2ludGVyKS4KLQkgKgotCSAq
IEluIHRoZSBtaWRkbGUgb2YgYWxsIHRoYXQsIHdlIGluc3BlY3Qgd2hldGhlciB0aGUgcmVxdWVz
dCBpcwotCSAqIGNvbXBsZXRlLiBSZXRpcmluZyBpcyBsYXp5IHNvIHRoZSByZXF1ZXN0IG1heSBi
ZSBjb21wbGV0ZWQgbG9uZwotCSAqIGJlZm9yZSB0aGUgYWN0aXZlIHRyYWNrZXIgaXMgdXBkYXRl
ZC4gUXVlcnlpbmcgd2hldGhlciB0aGUKLQkgKiByZXF1ZXN0IGlzIGNvbXBsZXRlIGlzIGZhciBj
aGVhcGVyIChhcyBpdCBpbnZvbHZlcyBubyBsb2NrZWQKLQkgKiBpbnN0cnVjdGlvbnMgc2V0dGlu
ZyBjYWNoZWxpbmVzIHRvIGV4Y2x1c2l2ZSkgdGhhbiBhY3F1aXJpbmcKLQkgKiB0aGUgcmVmZXJl
bmNlLCBzbyB3ZSBkbyBpdCBmaXJzdC4gVGhlIFJDVSByZWFkIGxvY2sgZW5zdXJlcyB0aGUKLQkg
KiBwb2ludGVyIGRlcmVmZXJlbmNlIGlzIHZhbGlkLCBidXQgZG9lcyBub3QgZW5zdXJlIHRoYXQg
dGhlCi0JICogc2Vxbm8gbm9yIEhXUyBpcyB0aGUgcmlnaHQgb25lISBIb3dldmVyLCBpZiB0aGUg
cmVxdWVzdCB3YXMKLQkgKiByZWFsbG9jYXRlZCwgdGhhdCBtZWFucyB0aGUgYWN0aXZlIHRyYWNr
ZXIncyByZXF1ZXN0IHdhcyBjb21wbGV0ZS4KLQkgKiBJZiB0aGUgbmV3IHJlcXVlc3QgaXMgYWxz
byBjb21wbGV0ZSwgdGhlbiBib3RoIGFyZSBhbmQgd2UgY2FuCi0JICoganVzdCByZXBvcnQgdGhl
IGFjdGl2ZSB0cmFja2VyIGlzIGlkbGUuIElmIHRoZSBuZXcgcmVxdWVzdCBpcwotCSAqIGluY29t
cGxldGUsIHRoZW4gd2UgYWNxdWlyZSBhIHJlZmVyZW5jZSBvbiBpdCBhbmQgY2hlY2sgdGhhdAot
CSAqIGl0IHJlbWFpbmVkIHRoZSBhY3RpdmUgcmVxdWVzdC4KLQkgKgotCSAqIEl0IGlzIHRoZW4g
aW1wZXJhdGl2ZSB0aGF0IHdlIGRvIG5vdCB6ZXJvIHRoZSByZXF1ZXN0IG9uCi0JICogcmVhbGxv
Y2F0aW9uLCBzbyB0aGF0IHdlIGNhbiBjaGFzZSB0aGUgZGFuZ2xpbmcgcG9pbnRlcnMhCi0JICog
U2VlIGk5MTVfcmVxdWVzdF9hbGxvYygpLgotCSAqLwotCWRvIHsKLQkJc3RydWN0IGk5MTVfcmVx
dWVzdCAqcmVxdWVzdDsKLQotCQlyZXF1ZXN0ID0gcmN1X2RlcmVmZXJlbmNlKGFjdGl2ZS0+cmVx
dWVzdCk7Ci0JCWlmICghcmVxdWVzdCB8fCBpOTE1X3JlcXVlc3RfY29tcGxldGVkKHJlcXVlc3Qp
KQotCQkJcmV0dXJuIE5VTEw7Ci0KLQkJLyoKLQkJICogQW4gZXNwZWNpYWxseSBzaWxseSBjb21w
aWxlciBjb3VsZCBkZWNpZGUgdG8gcmVjb21wdXRlIHRoZQotCQkgKiByZXN1bHQgb2YgaTkxNV9y
ZXF1ZXN0X2NvbXBsZXRlZCwgbW9yZSBzcGVjaWZpY2FsbHkKLQkJICogcmUtZW1pdCB0aGUgbG9h
ZCBmb3IgcmVxdWVzdC0+ZmVuY2Uuc2Vxbm8uIEEgcmFjZSB3b3VsZCBjYXRjaAotCQkgKiBhIGxh
dGVyIHNlcW5vIHZhbHVlLCB3aGljaCBjb3VsZCBmbGlwIHRoZSByZXN1bHQgZnJvbSB0cnVlIHRv
Ci0JCSAqIGZhbHNlLiBXaGljaCBtZWFucyBwYXJ0IG9mIHRoZSBpbnN0cnVjdGlvbnMgYmVsb3cg
bWlnaHQgbm90Ci0JCSAqIGJlIGV4ZWN1dGVkLCB3aGlsZSBsYXRlciBvbiBpbnN0cnVjdGlvbnMg
YXJlIGV4ZWN1dGVkLiBEdWUgdG8KLQkJICogYmFycmllcnMgd2l0aGluIHRoZSByZWZjb3VudGlu
ZyB0aGUgaW5jb25zaXN0ZW5jeSBjYW4ndCByZWFjaAotCQkgKiBwYXN0IHRoZSBjYWxsIHRvIGk5
MTVfcmVxdWVzdF9nZXRfcmN1LCBidXQgbm90IGV4ZWN1dGluZwotCQkgKiB0aGF0IHdoaWxlIHN0
aWxsIGV4ZWN1dGluZyBpOTE1X3JlcXVlc3RfcHV0KCkgY3JlYXRlcwotCQkgKiBoYXZvYyBlbm91
Z2guICBQcmV2ZW50IHRoaXMgd2l0aCBhIGNvbXBpbGVyIGJhcnJpZXIuCi0JCSAqLwotCQliYXJy
aWVyKCk7Ci0KLQkJcmVxdWVzdCA9IGk5MTVfcmVxdWVzdF9nZXRfcmN1KHJlcXVlc3QpOwotCi0J
CS8qCi0JCSAqIFdoYXQgc3RvcHMgdGhlIGZvbGxvd2luZyByY3VfYWNjZXNzX3BvaW50ZXIoKSBm
cm9tIG9jY3VycmluZwotCQkgKiBiZWZvcmUgdGhlIGFib3ZlIGk5MTVfcmVxdWVzdF9nZXRfcmN1
KCk/IElmIHdlIHdlcmUKLQkJICogdG8gcmVhZCB0aGUgdmFsdWUgYmVmb3JlIHBhdXNpbmcgdG8g
Z2V0IHRoZSByZWZlcmVuY2UgdG8KLQkJICogdGhlIHJlcXVlc3QsIHdlIG1heSBub3Qgbm90aWNl
IGEgY2hhbmdlIGluIHRoZSBhY3RpdmUKLQkJICogdHJhY2tlci4KLQkJICoKLQkJICogVGhlIHJj
dV9hY2Nlc3NfcG9pbnRlcigpIGlzIGEgbWVyZSBjb21waWxlciBiYXJyaWVyLCB3aGljaAotCQkg
KiBtZWFucyBib3RoIHRoZSBDUFUgYW5kIGNvbXBpbGVyIGFyZSBmcmVlIHRvIHBlcmZvcm0gdGhl
Ci0JCSAqIG1lbW9yeSByZWFkIHdpdGhvdXQgY29uc3RyYWludC4gVGhlIGNvbXBpbGVyIG9ubHkg
aGFzIHRvCi0JCSAqIGVuc3VyZSB0aGF0IGFueSBvcGVyYXRpb25zIGFmdGVyIHRoZSByY3VfYWNj
ZXNzX3BvaW50ZXIoKQotCQkgKiBvY2N1ciBhZnRlcndhcmRzIGluIHByb2dyYW0gb3JkZXIuIFRo
aXMgbWVhbnMgdGhlIHJlYWQgbWF5Ci0JCSAqIGJlIHBlcmZvcm1lZCBlYXJsaWVyIGJ5IGFuIG91
dC1vZi1vcmRlciBDUFUsIG9yIGFkdmVudHVyb3VzCi0JCSAqIGNvbXBpbGVyLgotCQkgKgotCQkg
KiBUaGUgYXRvbWljIG9wZXJhdGlvbiBhdCB0aGUgaGVhcnQgb2YKLQkJICogaTkxNV9yZXF1ZXN0
X2dldF9yY3UoKSwgc2VlIGRtYV9mZW5jZV9nZXRfcmN1KCksIGlzCi0JCSAqIGF0b21pY19pbmNf
bm90X3plcm8oKSB3aGljaCBpcyBvbmx5IGEgZnVsbCBtZW1vcnkgYmFycmllcgotCQkgKiB3aGVu
IHN1Y2Nlc3NmdWwuIFRoYXQgaXMsIGlmIGk5MTVfcmVxdWVzdF9nZXRfcmN1KCkKLQkJICogcmV0
dXJucyB0aGUgcmVxdWVzdCAoYW5kIHNvIHdpdGggdGhlIHJlZmVyZW5jZSBjb3VudGVkCi0JCSAq
IGluY3JlbWVudGVkKSB0aGVuIHRoZSBmb2xsb3dpbmcgcmVhZCBmb3IgcmN1X2FjY2Vzc19wb2lu
dGVyKCkKLQkJICogbXVzdCBvY2N1ciBhZnRlciB0aGUgYXRvbWljIG9wZXJhdGlvbiBhbmQgc28g
Y29uZmlybQotCQkgKiB0aGF0IHRoaXMgcmVxdWVzdCBpcyB0aGUgb25lIGN1cnJlbnRseSBiZWlu
ZyB0cmFja2VkLgotCQkgKgotCQkgKiBUaGUgY29ycmVzcG9uZGluZyB3cml0ZSBiYXJyaWVyIGlz
IHBhcnQgb2YKLQkJICogcmN1X2Fzc2lnbl9wb2ludGVyKCkuCi0JCSAqLwotCQlpZiAoIXJlcXVl
c3QgfHwgcmVxdWVzdCA9PSByY3VfYWNjZXNzX3BvaW50ZXIoYWN0aXZlLT5yZXF1ZXN0KSkKLQkJ
CXJldHVybiByY3VfcG9pbnRlcl9oYW5kb2ZmKHJlcXVlc3QpOwotCi0JCWk5MTVfcmVxdWVzdF9w
dXQocmVxdWVzdCk7Ci0JfSB3aGlsZSAoMSk7Ci19Ci0KK2ludCBfX211c3RfY2hlY2sKK2k5MTVf
YWN0aXZlX2ZlbmNlX3NldChzdHJ1Y3QgaTkxNV9hY3RpdmVfZmVuY2UgKmFjdGl2ZSwKKwkJICAg
ICAgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpOwogLyoqCi0gKiBpOTE1X2FjdGl2ZV9yZXF1ZXN0
X2dldF91bmxvY2tlZCAtIHJldHVybiBhIHJlZmVyZW5jZSB0byB0aGUgYWN0aXZlIHJlcXVlc3QK
KyAqIGk5MTVfYWN0aXZlX2ZlbmNlX2dldCAtIHJldHVybiBhIHJlZmVyZW5jZSB0byB0aGUgYWN0
aXZlIGZlbmNlCiAgKiBAYWN0aXZlIC0gdGhlIGFjdGl2ZSB0cmFja2VyCiAgKgotICogaTkxNV9h
Y3RpdmVfcmVxdWVzdF9nZXRfdW5sb2NrZWQoKSByZXR1cm5zIGEgcmVmZXJlbmNlIHRvIHRoZSBh
Y3RpdmUgcmVxdWVzdCwKKyAqIGk5MTVfYWN0aXZlX2ZlbmNlX2dldCgpIHJldHVybnMgYSByZWZl
cmVuY2UgdG8gdGhlIGFjdGl2ZSBmZW5jZSwKICAqIG9yIE5VTEwgaWYgdGhlIGFjdGl2ZSB0cmFj
a2VyIGlzIGlkbGUuIFRoZSByZWZlcmVuY2UgaXMgb2J0YWluZWQgdW5kZXIgUkNVLAogICogc28g
bm8gbG9ja2luZyBpcyByZXF1aXJlZCBieSB0aGUgY2FsbGVyLgogICoKLSAqIFRoZSByZWZlcmVu
Y2Ugc2hvdWxkIGJlIGZyZWVkIHdpdGggaTkxNV9yZXF1ZXN0X3B1dCgpLgorICogVGhlIHJlZmVy
ZW5jZSBzaG91bGQgYmUgZnJlZWQgd2l0aCBkbWFfZmVuY2VfcHV0KCkuCiAgKi8KLXN0YXRpYyBp
bmxpbmUgc3RydWN0IGk5MTVfcmVxdWVzdCAqCi1pOTE1X2FjdGl2ZV9yZXF1ZXN0X2dldF91bmxv
Y2tlZChjb25zdCBzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlKQorc3RhdGljIGlu
bGluZSBzdHJ1Y3QgZG1hX2ZlbmNlICoKK2k5MTVfYWN0aXZlX2ZlbmNlX2dldChzdHJ1Y3QgaTkx
NV9hY3RpdmVfZmVuY2UgKmFjdGl2ZSkKIHsKLQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0
OworCXN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlOwogCiAJcmN1X3JlYWRfbG9jaygpOwotCXJlcXVl
c3QgPSBfX2k5MTVfYWN0aXZlX3JlcXVlc3RfZ2V0X3JjdShhY3RpdmUpOworCWZlbmNlID0gZG1h
X2ZlbmNlX2dldF9yY3Vfc2FmZSgmYWN0aXZlLT5mZW5jZSk7CiAJcmN1X3JlYWRfdW5sb2NrKCk7
CiAKLQlyZXR1cm4gcmVxdWVzdDsKKwlyZXR1cm4gZmVuY2U7CiB9CiAKIC8qKgotICogaTkxNV9h
Y3RpdmVfcmVxdWVzdF9pc3NldCAtIHJlcG9ydCB3aGV0aGVyIHRoZSBhY3RpdmUgdHJhY2tlciBp
cyBhc3NpZ25lZAorICogaTkxNV9hY3RpdmVfZmVuY2VfaXNzZXQgLSByZXBvcnQgd2hldGhlciB0
aGUgYWN0aXZlIHRyYWNrZXIgaXMgYXNzaWduZWQKICAqIEBhY3RpdmUgLSB0aGUgYWN0aXZlIHRy
YWNrZXIKICAqCi0gKiBpOTE1X2FjdGl2ZV9yZXF1ZXN0X2lzc2V0KCkgcmV0dXJucyB0cnVlIGlm
IHRoZSBhY3RpdmUgdHJhY2tlciBpcyBjdXJyZW50bHkKLSAqIGFzc2lnbmVkIHRvIGEgcmVxdWVz
dC4gRHVlIHRvIHRoZSBsYXp5IHJldGlyaW5nLCB0aGF0IHJlcXVlc3QgbWF5IGJlIGlkbGUKKyAq
IGk5MTVfYWN0aXZlX2ZlbmNlX2lzc2V0KCkgcmV0dXJucyB0cnVlIGlmIHRoZSBhY3RpdmUgdHJh
Y2tlciBpcyBjdXJyZW50bHkKKyAqIGFzc2lnbmVkIHRvIGEgZmVuY2UuIER1ZSB0byB0aGUgbGF6
eSByZXRpcmluZywgdGhhdCBmZW5jZSBtYXkgYmUgaWRsZQogICogYW5kIHRoaXMgbWF5IHJlcG9y
dCBzdGFsZSBpbmZvcm1hdGlvbi4KICAqLwogc3RhdGljIGlubGluZSBib29sCi1pOTE1X2FjdGl2
ZV9yZXF1ZXN0X2lzc2V0KGNvbnN0IHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUp
CitpOTE1X2FjdGl2ZV9mZW5jZV9pc3NldChjb25zdCBzdHJ1Y3QgaTkxNV9hY3RpdmVfZmVuY2Ug
KmFjdGl2ZSkKIHsKLQlyZXR1cm4gcmN1X2FjY2Vzc19wb2ludGVyKGFjdGl2ZS0+cmVxdWVzdCk7
CisJcmV0dXJuIHJjdV9hY2Nlc3NfcG9pbnRlcihhY3RpdmUtPmZlbmNlKTsKIH0KIAotLyoqCi0g
KiBpOTE1X2FjdGl2ZV9yZXF1ZXN0X3JldGlyZSAtIHdhaXRzIHVudGlsIHRoZSByZXF1ZXN0IGlz
IHJldGlyZWQKLSAqIEBhY3RpdmUgLSB0aGUgYWN0aXZlIHJlcXVlc3Qgb24gd2hpY2ggdG8gd2Fp
dAotICoKLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3RfcmV0aXJlKCkgd2FpdHMgdW50aWwgdGhlIHJl
cXVlc3QgaXMgY29tcGxldGVkLAotICogYW5kIHRoZW4gZW5zdXJlcyB0aGF0IGF0IGxlYXN0IHRo
ZSByZXRpcmVtZW50IGhhbmRsZXIgZm9yIHRoaXMKLSAqIEBhY3RpdmUgdHJhY2tlciBpcyBjYWxs
ZWQgYmVmb3JlIHJldHVybmluZy4gSWYgdGhlIEBhY3RpdmUKLSAqIHRyYWNrZXIgaXMgaWRsZSwg
dGhlIGZ1bmN0aW9uIHJldHVybnMgaW1tZWRpYXRlbHkuCi0gKi8KLXN0YXRpYyBpbmxpbmUgaW50
IF9fbXVzdF9jaGVjawotaTkxNV9hY3RpdmVfcmVxdWVzdF9yZXRpcmUoc3RydWN0IGk5MTVfYWN0
aXZlX3JlcXVlc3QgKmFjdGl2ZSwKLQkJCSAgIHN0cnVjdCBtdXRleCAqbXV0ZXgpCitzdGF0aWMg
aW5saW5lIHZvaWQKK2k5MTVfYWN0aXZlX2ZlbmNlX2NiKHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNl
LCBzdHJ1Y3QgZG1hX2ZlbmNlX2NiICpjYikKIHsKLQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1
ZXN0OwotCWxvbmcgcmV0OwotCi0JcmVxdWVzdCA9IGk5MTVfYWN0aXZlX3JlcXVlc3RfcmF3KGFj
dGl2ZSwgbXV0ZXgpOwotCWlmICghcmVxdWVzdCkKLQkJcmV0dXJuIDA7Ci0KLQlyZXQgPSBpOTE1
X3JlcXVlc3Rfd2FpdChyZXF1ZXN0LAotCQkJCUk5MTVfV0FJVF9JTlRFUlJVUFRJQkxFLAotCQkJ
CU1BWF9TQ0hFRFVMRV9USU1FT1VUKTsKLQlpZiAocmV0IDwgMCkKLQkJcmV0dXJuIHJldDsKLQot
CWxpc3RfZGVsX2luaXQoJmFjdGl2ZS0+bGluayk7Ci0JUkNVX0lOSVRfUE9JTlRFUihhY3RpdmUt
PnJlcXVlc3QsIE5VTEwpOwotCi0JYWN0aXZlLT5yZXRpcmUoYWN0aXZlLCByZXF1ZXN0KTsKKwlz
dHJ1Y3QgaTkxNV9hY3RpdmVfZmVuY2UgKmFjdGl2ZSA9CisJCWNvbnRhaW5lcl9vZihjYiwgdHlw
ZW9mKCphY3RpdmUpLCBjYik7CiAKLQlyZXR1cm4gMDsKKwlSQ1VfSU5JVF9QT0lOVEVSKGFjdGl2
ZS0+ZmVuY2UsIE5VTEwpOwogfQogCiAvKgpAQCAtMzUwLDMxICsxNTUsMjkgQEAgaTkxNV9hY3Rp
dmVfcmVxdWVzdF9yZXRpcmUoc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2ZSwKICAq
IHN5bmNocm9uaXNhdGlvbi4KICAqLwogCi12b2lkIF9faTkxNV9hY3RpdmVfaW5pdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKLQkJCXN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLAordm9p
ZCBfX2k5MTVfYWN0aXZlX2luaXQoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsCiAJCQlpbnQgKCph
Y3RpdmUpKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKSwKIAkJCXZvaWQgKCpyZXRpcmUpKHN0cnVj
dCBpOTE1X2FjdGl2ZSAqcmVmKSwKIAkJCXN0cnVjdCBsb2NrX2NsYXNzX2tleSAqa2V5KTsKLSNk
ZWZpbmUgaTkxNV9hY3RpdmVfaW5pdChpOTE1LCByZWYsIGFjdGl2ZSwgcmV0aXJlKSBkbyB7CQlc
CisjZGVmaW5lIGk5MTVfYWN0aXZlX2luaXQocmVmLCBhY3RpdmUsIHJldGlyZSkgZG8gewkJXAog
CXN0YXRpYyBzdHJ1Y3QgbG9ja19jbGFzc19rZXkgX19rZXk7CQkJCVwKIAkJCQkJCQkJCVwKLQlf
X2k5MTVfYWN0aXZlX2luaXQoaTkxNSwgcmVmLCBhY3RpdmUsIHJldGlyZSwgJl9fa2V5KTsJCVwK
KwlfX2k5MTVfYWN0aXZlX2luaXQocmVmLCBhY3RpdmUsIHJldGlyZSwgJl9fa2V5KTsJCVwKIH0g
d2hpbGUgKDApCiAKIGludCBpOTE1X2FjdGl2ZV9yZWYoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYs
CiAJCSAgICB1NjQgdGltZWxpbmUsCi0JCSAgICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSk7CisJ
CSAgICBzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSk7CiAKIGludCBpOTE1X2FjdGl2ZV93YWl0KHN0
cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKTsKIAogaW50IGk5MTVfcmVxdWVzdF9hd2FpdF9hY3RpdmUo
c3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCiAJCQkgICAgICBzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJl
Zik7Ci1pbnQgaTkxNV9yZXF1ZXN0X2F3YWl0X2FjdGl2ZV9yZXF1ZXN0KHN0cnVjdCBpOTE1X3Jl
cXVlc3QgKnJxLAotCQkJCSAgICAgIHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUp
OworaW50IGk5MTVfcmVxdWVzdF9hd2FpdF9hY3RpdmVfZmVuY2Uoc3RydWN0IGk5MTVfcmVxdWVz
dCAqcnEsCisJCQkJICAgIHN0cnVjdCBpOTE1X2FjdGl2ZV9mZW5jZSAqYWN0aXZlKTsKIAogaW50
IGk5MTVfYWN0aXZlX2FjcXVpcmUoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpOwogdm9pZCBpOTE1
X2FjdGl2ZV9yZWxlYXNlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKTsKLXZvaWQgX19pOTE1X2Fj
dGl2ZV9yZWxlYXNlX25lc3RlZChzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwgaW50IHN1YmNsYXNz
KTsKIAogc3RhdGljIGlubGluZSBib29sCiBpOTE1X2FjdGl2ZV9pc19pZGxlKGNvbnN0IHN0cnVj
dCBpOTE1X2FjdGl2ZSAqcmVmKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9hY3RpdmVfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlX3R5cGVz
LmgKaW5kZXggYTNhNWVjM2U0MTYzLi40MmFhYTI5MjEwYTggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlX3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9hY3RpdmVfdHlwZXMuaApAQCAtOCw2ICs4LDcgQEAKICNkZWZpbmUgX0k5MTVfQUNU
SVZFX1RZUEVTX0hfCiAKICNpbmNsdWRlIDxsaW51eC9hdG9taWMuaD4KKyNpbmNsdWRlIDxsaW51
eC9kbWEtZmVuY2UuaD4KICNpbmNsdWRlIDxsaW51eC9sbGlzdC5oPgogI2luY2x1ZGUgPGxpbnV4
L211dGV4Lmg+CiAjaW5jbHVkZSA8bGludXgvcmJ0cmVlLmg+CkBAIC0xNiwxNyArMTcsOSBAQAog
CiAjaW5jbHVkZSAiaTkxNV91dGlscy5oIgogCi1zdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKLXN0
cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0Owotc3RydWN0IGk5MTVfcmVxdWVzdDsKLQotdHlwZWRl
ZiB2b2lkICgqaTkxNV9hY3RpdmVfcmV0aXJlX2ZuKShzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVz
dCAqLAotCQkJCSAgICAgIHN0cnVjdCBpOTE1X3JlcXVlc3QgKik7Ci0KLXN0cnVjdCBpOTE1X2Fj
dGl2ZV9yZXF1ZXN0IHsKLQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0IF9fcmN1ICpyZXF1ZXN0OwotCXN0
cnVjdCBsaXN0X2hlYWQgbGluazsKLQlpOTE1X2FjdGl2ZV9yZXRpcmVfZm4gcmV0aXJlOworc3Ry
dWN0IGk5MTVfYWN0aXZlX2ZlbmNlIHsKKwlzdHJ1Y3QgZG1hX2ZlbmNlIF9fcmN1ICpmZW5jZTsK
KwlzdHJ1Y3QgZG1hX2ZlbmNlX2NiIGNiOwogfTsKIAogc3RydWN0IGFjdGl2ZV9ub2RlOwpAQCAt
MzcsOCArMzAsNiBAQCBzdHJ1Y3QgYWN0aXZlX25vZGU7CiAjZGVmaW5lIGk5MTVfYWN0aXZlX21h
eV9zbGVlcChmbikgcHRyX3BhY2tfYml0cygmKGZuKSwgSTkxNV9BQ1RJVkVfTUFZX1NMRUVQLCAy
KQogCiBzdHJ1Y3QgaTkxNV9hY3RpdmUgewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
OwotCiAJc3RydWN0IGFjdGl2ZV9ub2RlICpjYWNoZTsKIAlzdHJ1Y3QgcmJfcm9vdCB0cmVlOwog
CXN0cnVjdCBtdXRleCBtdXRleDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCmluZGV4IGIxZTRkYjI1
Zjk0ZS4uYmFjN2RmNzI0ZjA3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2dlbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKQEAgLTk1NCwyOCAr
OTU0LDM4IEBAIHdhaXRfZm9yX3RpbWVsaW5lcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKIAogCW11dGV4X2xvY2soJmd0LT5tdXRleCk7CiAJbGlzdF9mb3JfZWFjaF9lbnRyeSh0bCwg
Jmd0LT5hY3RpdmVfbGlzdCwgbGluaykgewotCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKKwkJ
c3RydWN0IGRtYV9mZW5jZSAqZmVuY2U7CiAKLQkJcnEgPSBpOTE1X2FjdGl2ZV9yZXF1ZXN0X2dl
dF91bmxvY2tlZCgmdGwtPmxhc3RfcmVxdWVzdCk7Ci0JCWlmICghcnEpCisJCWZlbmNlID0gaTkx
NV9hY3RpdmVfZmVuY2VfZ2V0KCZ0bC0+bGFzdF9yZXF1ZXN0KTsKKwkJaWYgKCFmZW5jZSkKIAkJ
CWNvbnRpbnVlOwogCiAJCW11dGV4X3VubG9jaygmZ3QtPm11dGV4KTsKIAotCQkvKgotCQkgKiAi
UmFjZS10by1pZGxlIi4KLQkJICoKLQkJICogU3dpdGNoaW5nIHRvIHRoZSBrZXJuZWwgY29udGV4
dCBpcyBvZnRlbiB1c2VkIGEgc3luY2hyb25vdXMKLQkJICogc3RlcCBwcmlvciB0byBpZGxpbmcs
IGUuZy4gaW4gc3VzcGVuZCBmb3IgZmx1c2hpbmcgYWxsCi0JCSAqIGN1cnJlbnQgb3BlcmF0aW9u
cyB0byBtZW1vcnkgYmVmb3JlIHNsZWVwaW5nLiBUaGVzZSB3ZQotCQkgKiB3YW50IHRvIGNvbXBs
ZXRlIGFzIHF1aWNrbHkgYXMgcG9zc2libGUgdG8gYXZvaWQgcHJvbG9uZ2VkCi0JCSAqIHN0YWxs
cywgc28gYWxsb3cgdGhlIGdwdSB0byBib29zdCB0byBtYXhpbXVtIGNsb2Nrcy4KLQkJICovCi0J
CWlmIChmbGFncyAmIEk5MTVfV0FJVF9GT1JfSURMRV9CT09TVCkKLQkJCWdlbjZfcnBzX2Jvb3N0
KHJxKTsKKwkJaWYgKCFkbWFfZmVuY2VfaXNfaTkxNShmZW5jZSkpIHsKKwkJCXRpbWVvdXQgPSBk
bWFfZmVuY2Vfd2FpdF90aW1lb3V0KGZlbmNlLAorCQkJCQkJCSBmbGFncyAmIEk5MTVfV0FJVF9J
TlRFUlJVUFRJQkxFLAorCQkJCQkJCSB0aW1lb3V0KTsKKwkJfSBlbHNlIHsKKwkJCXN0cnVjdCBp
OTE1X3JlcXVlc3QgKnJxID0gdG9fcmVxdWVzdChmZW5jZSk7CisKKwkJCS8qCisJCQkgKiAiUmFj
ZS10by1pZGxlIi4KKwkJCSAqCisJCQkgKiBTd2l0Y2hpbmcgdG8gdGhlIGtlcm5lbCBjb250ZXh0
IGlzIG9mdGVuIHVzZWQgYXMKKwkJCSAqIGEgc3luY2hyb25vdXMgc3RlcCBwcmlvciB0byBpZGxp
bmcsIGUuZy4gaW4gc3VzcGVuZAorCQkJICogZm9yIGZsdXNoaW5nIGFsbCBjdXJyZW50IG9wZXJh
dGlvbnMgdG8gbWVtb3J5IGJlZm9yZQorCQkJICogc2xlZXBpbmcuIFRoZXNlIHdlIHdhbnQgdG8g
Y29tcGxldGUgYXMgcXVpY2tseSBhcworCQkJICogcG9zc2libGUgdG8gYXZvaWQgcHJvbG9uZ2Vk
IHN0YWxscywgc28gYWxsb3cgdGhlIGdwdQorCQkJICogdG8gYm9vc3QgdG8gbWF4aW11bSBjbG9j
a3MuCisJCQkgKi8KKwkJCWlmIChmbGFncyAmIEk5MTVfV0FJVF9GT1JfSURMRV9CT09TVCkKKwkJ
CQlnZW42X3Jwc19ib29zdChycSk7CisKKwkJCXRpbWVvdXQgPSBpOTE1X3JlcXVlc3Rfd2FpdChy
cSwgZmxhZ3MsIHRpbWVvdXQpOworCQl9CiAKLQkJdGltZW91dCA9IGk5MTVfcmVxdWVzdF93YWl0
KHJxLCBmbGFncywgdGltZW91dCk7Ci0JCWk5MTVfcmVxdWVzdF9wdXQocnEpOworCQlkbWFfZmVu
Y2VfcHV0KGZlbmNlKTsKIAkJaWYgKHRpbWVvdXQgPCAwKQogCQkJcmV0dXJuIHRpbWVvdXQ7CiAK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMKaW5kZXggOGM1OGU2ZjBhMmI0Li5lYWVmZjVm
OGNkMTYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jCkBAIC0yMDQ5LDcgKzIwNDks
NyBAQCBzdGF0aWMgc3RydWN0IGk5MTVfdm1hICpwZF92bWFfY3JlYXRlKHN0cnVjdCBnZW42X3Bw
Z3R0ICpwcGd0dCwgaW50IHNpemUpCiAJaWYgKCF2bWEpCiAJCXJldHVybiBFUlJfUFRSKC1FTk9N
RU0pOwogCi0JaTkxNV9hY3RpdmVfaW5pdChpOTE1LCAmdm1hLT5hY3RpdmUsIE5VTEwsIE5VTEwp
OworCWk5MTVfYWN0aXZlX2luaXQoJnZtYS0+YWN0aXZlLCBOVUxMLCBOVUxMKTsKIAogCXZtYS0+
dm0gPSAmZ2d0dC0+dm07CiAJdm1hLT5vcHMgPSAmcGRfdm1hX29wczsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9yZXF1ZXN0LmMKaW5kZXggMjAxYmQ4ZDE1MDZmLi5lZjY3YzU4Njk4ZDggMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jCkBAIC0yMjksOSArMjI5LDggQEAgc3RhdGljIHZvaWQg
ZnJlZV9jYXB0dXJlX2xpc3Qoc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCkKIAogc3RhdGlj
IGJvb2wgaTkxNV9yZXF1ZXN0X3JldGlyZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIHsKLQlz
dHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlLCAqbmV4dDsKKwlsb2NrZGVwX2Fzc2Vy
dF9oZWxkKCZycS0+dGltZWxpbmUtPm11dGV4KTsKIAotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJnJx
LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlpZiAoIWk5MTVfcmVxdWVzdF9jb21wbGV0ZWQo
cnEpKQogCQlyZXR1cm4gZmFsc2U7CiAKQEAgLTI0NSwzNSArMjQ0LDYgQEAgc3RhdGljIGJvb2wg
aTkxNV9yZXF1ZXN0X3JldGlyZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIAogCWFkdmFuY2Vf
cmluZyhycSk7CiAKLQkvKgotCSAqIFdhbGsgdGhyb3VnaCB0aGUgYWN0aXZlIGxpc3QsIGNhbGxp
bmcgcmV0aXJlIG9uIGVhY2guIFRoaXMgYWxsb3dzCi0JICogb2JqZWN0cyB0byB0cmFjayB0aGVp
ciBHUFUgYWN0aXZpdHkgYW5kIG1hcmsgdGhlbXNlbHZlcyBhcyBpZGxlCi0JICogd2hlbiB0aGVp
ciAqbGFzdCogYWN0aXZlIHJlcXVlc3QgaXMgY29tcGxldGVkICh1cGRhdGluZyBzdGF0ZQotCSAq
IHRyYWNraW5nIGxpc3RzIGZvciBldmljdGlvbiwgYWN0aXZlIHJlZmVyZW5jZXMgZm9yIEdFTSwg
ZXRjKS4KLQkgKgotCSAqIEFzIHRoZSAtPnJldGlyZSgpIG1heSBmcmVlIHRoZSBub2RlLCB3ZSBk
ZWNvdXBsZSBpdCBmaXJzdCBhbmQKLQkgKiBwYXNzIGFsb25nIHRoZSBhdXhpbGlhcnkgaW5mb3Jt
YXRpb24gKHRvIGF2b2lkIGRlcmVmZXJlbmNpbmcKLQkgKiB0aGUgbm9kZSBhZnRlciB0aGUgY2Fs
bGJhY2spLgotCSAqLwotCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShhY3RpdmUsIG5leHQsICZy
cS0+YWN0aXZlX2xpc3QsIGxpbmspIHsKLQkJLyoKLQkJICogSW4gbWljcm9iZW5jaG1hcmtzIG9y
IGZvY3VzaW5nIHVwb24gdGltZSBpbnNpZGUgdGhlIGtlcm5lbCwKLQkJICogd2UgbWF5IHNwZW5k
IGFuIGlub3JkaW5hdGUgYW1vdW50IG9mIHRpbWUgc2ltcGx5IGhhbmRsaW5nCi0JCSAqIHRoZSBy
ZXRpcmVtZW50IG9mIHJlcXVlc3RzIGFuZCBwcm9jZXNzaW5nIHRoZWlyIGNhbGxiYWNrcy4KLQkJ
ICogT2Ygd2hpY2gsIHRoaXMgbG9vcCBpdHNlbGYgaXMgcGFydGljdWxhcmx5IGhvdCBkdWUgdG8g
dGhlCi0JCSAqIGNhY2hlIG1pc3NlcyB3aGVuIGp1bXBpbmcgYXJvdW5kIHRoZSBsaXN0IG9mCi0J
CSAqIGk5MTVfYWN0aXZlX3JlcXVlc3QuICBTbyB3ZSB0cnkgdG8ga2VlcCB0aGlzIGxvb3AgYXMK
LQkJICogc3RyZWFtbGluZWQgYXMgcG9zc2libGUgYW5kIGFsc28gcHJlZmV0Y2ggdGhlIG5leHQK
LQkJICogaTkxNV9hY3RpdmVfcmVxdWVzdCB0byB0cnkgYW5kIGhpZGUgdGhlIGxpa2VseSBjYWNo
ZSBtaXNzLgotCQkgKi8KLQkJcHJlZmV0Y2h3KG5leHQpOwotCi0JCUlOSVRfTElTVF9IRUFEKCZh
Y3RpdmUtPmxpbmspOwotCQlSQ1VfSU5JVF9QT0lOVEVSKGFjdGl2ZS0+cmVxdWVzdCwgTlVMTCk7
Ci0KLQkJYWN0aXZlLT5yZXRpcmUoYWN0aXZlLCBycSk7Ci0JfQotCiAJbG9jYWxfaXJxX2Rpc2Fi
bGUoKTsKIAogCS8qCkBAIC0zMjgsMTEgKzI5OCw5IEBAIHZvaWQgaTkxNV9yZXF1ZXN0X3JldGly
ZV91cHRvKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogCQkgIHJxLT5mZW5jZS5jb250ZXh0LCBy
cS0+ZmVuY2Uuc2Vxbm8sCiAJCSAgaHdzcF9zZXFubyhycSkpOwogCi0JbG9ja2RlcF9hc3NlcnRf
aGVsZCgmcnEtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCWxvY2tkZXBfYXNzZXJ0X2hlbGQo
JnJxLT50aW1lbGluZS0+bXV0ZXgpOwogCUdFTV9CVUdfT04oIWk5MTVfcmVxdWVzdF9jb21wbGV0
ZWQocnEpKTsKLQotCWlmIChsaXN0X2VtcHR5KCZycS0+cmluZ19saW5rKSkKLQkJcmV0dXJuOwor
CUdFTV9CVUdfT04obGlzdF9lbXB0eSgmcnEtPnJpbmdfbGluaykpOwogCiAJZG8gewogCQl0bXAg
PSBsaXN0X2ZpcnN0X2VudHJ5KCZyaW5nLT5yZXF1ZXN0X2xpc3QsCkBAIC01NjcsNiArNTM1LDcg
QEAgc3RhdGljIHZvaWQgcmluZ19yZXRpcmVfcmVxdWVzdHMoc3RydWN0IGludGVsX3JpbmcgKnJp
bmcpCiB7CiAJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsICpybjsKIAorCWxvY2tkZXBfYXNzZXJ0
X2hlbGQoJnJpbmctPnRpbWVsaW5lLT5tdXRleCk7CiAJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZl
KHJxLCBybiwgJnJpbmctPnJlcXVlc3RfbGlzdCwgcmluZ19saW5rKQogCQlpZiAoIWk5MTVfcmVx
dWVzdF9yZXRpcmUocnEpKQogCQkJYnJlYWs7CkBAIC02ODcsNyArNjU2LDYgQEAgX19pOTE1X3Jl
cXVlc3RfY3JlYXRlKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgZ2ZwX3QgZ2ZwKQogCXJxLT53
YWl0Ym9vc3QgPSBmYWxzZTsKIAlycS0+ZXhlY3V0aW9uX21hc2sgPSBBTExfRU5HSU5FUzsKIAot
CUlOSVRfTElTVF9IRUFEKCZycS0+YWN0aXZlX2xpc3QpOwogCUlOSVRfTElTVF9IRUFEKCZycS0+
ZXhlY3V0ZV9jYik7CiAKIAkvKgpAQCAtNzI2LDcgKzY5NCw2IEBAIF9faTkxNV9yZXF1ZXN0X2Ny
ZWF0ZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIGdmcF90IGdmcCkKIAljZS0+cmluZy0+ZW1p
dCA9IHJxLT5oZWFkOwogCiAJLyogTWFrZSBzdXJlIHdlIGRpZG4ndCBhZGQgb3Vyc2VsdmVzIHRv
IGV4dGVybmFsIHN0YXRlIGJlZm9yZSBmcmVlaW5nICovCi0JR0VNX0JVR19PTighbGlzdF9lbXB0
eSgmcnEtPmFjdGl2ZV9saXN0KSk7CiAJR0VNX0JVR19PTighbGlzdF9lbXB0eSgmcnEtPnNjaGVk
LnNpZ25hbGVyc19saXN0KSk7CiAJR0VNX0JVR19PTighbGlzdF9lbXB0eSgmcnEtPnNjaGVkLndh
aXRlcnNfbGlzdCkpOwogCkBAIC0xMTE1LDcgKzEwODIsOCBAQCBfX2k5MTVfcmVxdWVzdF9hZGRf
dG9fdGltZWxpbmUoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJICogcHJlY2x1ZGVzIG9wdGlt
aXNpbmcgdG8gdXNlIHNlbWFwaG9yZXMgc2VyaWFsaXNhdGlvbiBvZiBhIHNpbmdsZQogCSAqIHRp
bWVsaW5lIGFjcm9zcyBlbmdpbmVzLgogCSAqLwotCXByZXYgPSByY3VfZGVyZWZlcmVuY2VfcHJv
dGVjdGVkKHRpbWVsaW5lLT5sYXN0X3JlcXVlc3QucmVxdWVzdCwgMSk7CisJcHJldiA9IHRvX3Jl
cXVlc3QoX19pOTE1X2FjdGl2ZV9mZW5jZV9zZXQoJnRpbWVsaW5lLT5sYXN0X3JlcXVlc3QsCisJ
CQkJCQkgICZycS0+ZmVuY2UpKTsKIAlpZiAocHJldiAmJiAhaTkxNV9yZXF1ZXN0X2NvbXBsZXRl
ZChwcmV2KSkgewogCQlpZiAoaXNfcG93ZXJfb2ZfMihwcmV2LT5lbmdpbmUtPm1hc2sgfCBycS0+
ZW5naW5lLT5tYXNrKSkKIAkJCWk5MTVfc3dfZmVuY2VfYXdhaXRfc3dfZmVuY2UoJnJxLT5zdWJt
aXQsCkBAIC0xMTQwLDcgKzExMDgsNiBAQCBfX2k5MTVfcmVxdWVzdF9hZGRfdG9fdGltZWxpbmUo
c3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJICogdXMsIHRoZSB0aW1lbGluZSB3aWxsIGhvbGQg
aXRzIHNlcW5vIHdoaWNoIGlzIGxhdGVyIHRoYW4gb3Vycy4KIAkgKi8KIAlHRU1fQlVHX09OKHRp
bWVsaW5lLT5zZXFubyAhPSBycS0+ZmVuY2Uuc2Vxbm8pOwotCV9faTkxNV9hY3RpdmVfcmVxdWVz
dF9zZXQoJnRpbWVsaW5lLT5sYXN0X3JlcXVlc3QsIHJxKTsKIAogCXJldHVybiBwcmV2OwogfQpA
QCAtMTIzNywxMCArMTIwNCwxMSBAQCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpfX2k5MTVfcmVxdWVz
dF9jb21taXQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAKIHZvaWQgaTkxNV9yZXF1ZXN0X2Fk
ZChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIHsKKwlzdHJ1Y3QgaTkxNV90aW1lbGluZSAqIGNv
bnN0IHRsID0gcnEtPnRpbWVsaW5lOwogCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnByZXY7CiAKLQls
b2NrZGVwX2Fzc2VydF9oZWxkKCZycS0+dGltZWxpbmUtPm11dGV4KTsKLQlsb2NrZGVwX3VucGlu
X2xvY2soJnJxLT50aW1lbGluZS0+bXV0ZXgsIHJxLT5jb29raWUpOworCWxvY2tkZXBfYXNzZXJ0
X2hlbGQoJnRsLT5tdXRleCk7CisJbG9ja2RlcF91bnBpbl9sb2NrKCZ0bC0+bXV0ZXgsIHJxLT5j
b29raWUpOwogCiAJdHJhY2VfaTkxNV9yZXF1ZXN0X2FkZChycSk7CiAKQEAgLTEyNjMsMTAgKzEy
MzEsMTAgQEAgdm9pZCBpOTE1X3JlcXVlc3RfYWRkKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQog
CSAqIHdvcmsgb24gYmVoYWxmIG9mIG90aGVycyAtLSBidXQgaW5zdGVhZCB3ZSBzaG91bGQgYmVu
ZWZpdCBmcm9tCiAJICogaW1wcm92ZWQgcmVzb3VyY2UgbWFuYWdlbWVudC4gKFdlbGwsIHRoYXQn
cyB0aGUgdGhlb3J5IGF0IGxlYXN0LikKIAkgKi8KLQlpZiAocHJldiAmJiBpOTE1X3JlcXVlc3Rf
Y29tcGxldGVkKHByZXYpKQorCWlmIChwcmV2ICYmIGk5MTVfcmVxdWVzdF9jb21wbGV0ZWQocHJl
dikgJiYgcHJldi0+dGltZWxpbmUgPT0gdGwpCiAJCWk5MTVfcmVxdWVzdF9yZXRpcmVfdXB0byhw
cmV2KTsKIAotCW11dGV4X3VubG9jaygmcnEtPnRpbWVsaW5lLT5tdXRleCk7CisJbXV0ZXhfdW5s
b2NrKCZ0bC0+bXV0ZXgpOwogfQogCiBzdGF0aWMgdW5zaWduZWQgbG9uZyBsb2NhbF9jbG9ja191
cyh1bnNpZ25lZCBpbnQgKmNwdSkKQEAgLTE0OTQsNyArMTQ2MiwxMSBAQCBib29sIGk5MTVfcmV0
aXJlX3JlcXVlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCWxpc3RfZm9yX2Vh
Y2hfZW50cnlfc2FmZShyaW5nLCB0bXAsCiAJCQkJICZpOTE1LT5ndC5hY3RpdmVfcmluZ3MsIGFj
dGl2ZV9saW5rKSB7CiAJCWludGVsX3JpbmdfZ2V0KHJpbmcpOyAvKiBsYXN0IHJxIGhvbGRzIHJl
ZmVyZW5jZSEgKi8KKwkJbXV0ZXhfbG9jaygmcmluZy0+dGltZWxpbmUtPm11dGV4KTsKKwogCQly
aW5nX3JldGlyZV9yZXF1ZXN0cyhyaW5nKTsKKworCQltdXRleF91bmxvY2soJnJpbmctPnRpbWVs
aW5lLT5tdXRleCk7CiAJCWludGVsX3JpbmdfcHV0KHJpbmcpOwogCX0KIApkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3JlcXVlc3QuaAppbmRleCBiZWJjMWU5YjRhNWUuLjgyNzdjZmYwZGY3MCAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmgKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmgKQEAgLTIxMSw3ICsyMTEsNiBAQCBzdHJ1Y3QgaTkx
NV9yZXF1ZXN0IHsKIAkgKiBvbiB0aGUgYWN0aXZlX2xpc3QgKG9mIHRoZWlyIGZpbmFsIHJlcXVl
c3QpLgogCSAqLwogCXN0cnVjdCBpOTE1X2NhcHR1cmVfbGlzdCAqY2FwdHVyZV9saXN0OwotCXN0
cnVjdCBsaXN0X2hlYWQgYWN0aXZlX2xpc3Q7CiAKIAkvKiogVGltZSBhdCB3aGljaCB0aGlzIHJl
cXVlc3Qgd2FzIGVtaXR0ZWQsIGluIGppZmZpZXMuICovCiAJdW5zaWduZWQgbG9uZyBlbWl0dGVk
X2ppZmZpZXM7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3RpbWVsaW5l
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3RpbWVsaW5lLmMKaW5kZXggMGY0Y2E5NDc4
YWU1Li5mY2FiNzg1YzlhMjkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
dGltZWxpbmUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3RpbWVsaW5lLmMKQEAg
LTE4MCw4ICsxODAsNyBAQCBjYWNoZWxpbmVfYWxsb2Moc3RydWN0IGk5MTVfdGltZWxpbmVfaHdz
cCAqaHdzcCwgdW5zaWduZWQgaW50IGNhY2hlbGluZSkKIAljbC0+aHdzcCA9IGh3c3A7CiAJY2wt
PnZhZGRyID0gcGFnZV9wYWNrX2JpdHModmFkZHIsIGNhY2hlbGluZSk7CiAKLQlpOTE1X2FjdGl2
ZV9pbml0KGh3c3BfdG9faTkxNShod3NwKSwgJmNsLT5hY3RpdmUsCi0JCQkgX19jYWNoZWxpbmVf
YWN0aXZlLCBfX2NhY2hlbGluZV9yZXRpcmUpOworCWk5MTVfYWN0aXZlX2luaXQoJmNsLT5hY3Rp
dmUsIF9fY2FjaGVsaW5lX2FjdGl2ZSwgX19jYWNoZWxpbmVfcmV0aXJlKTsKIAogCXJldHVybiBj
bDsKIH0KQEAgLTI2NCw3ICsyNjMsNyBAQCBpbnQgaTkxNV90aW1lbGluZV9pbml0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAogCiAJbXV0ZXhfaW5pdCgmdGltZWxpbmUtPm11dGV4KTsK
IAotCUlOSVRfQUNUSVZFX1JFUVVFU1QoJnRpbWVsaW5lLT5sYXN0X3JlcXVlc3QpOworCUlOSVRf
QUNUSVZFX0ZFTkNFKCZ0aW1lbGluZS0+bGFzdF9yZXF1ZXN0KTsKIAlJTklUX0xJU1RfSEVBRCgm
dGltZWxpbmUtPnJlcXVlc3RzKTsKIAogCWk5MTVfc3luY21hcF9pbml0KCZ0aW1lbGluZS0+c3lu
Yyk7CkBAIC00NjEsNyArNDYwLDcgQEAgX19pOTE1X3RpbWVsaW5lX2dldF9zZXFubyhzdHJ1Y3Qg
aTkxNV90aW1lbGluZSAqdGwsCiAJICogYWxsIHdyaXRlcyBpbnRvIHRoZSBjYWNoZWxpbmUgZnJv
bSBwcmV2aW91cyByZXF1ZXN0cyBhcmUgY29tcGxldGUuCiAJICovCiAJZXJyID0gaTkxNV9hY3Rp
dmVfcmVmKCZ0bC0+aHdzcF9jYWNoZWxpbmUtPmFjdGl2ZSwKLQkJCSAgICAgIHRsLT5mZW5jZV9j
b250ZXh0LCBycSk7CisJCQkgICAgICB0bC0+ZmVuY2VfY29udGV4dCwgJnJxLT5mZW5jZSk7CiAJ
aWYgKGVycikKIAkJZ290byBlcnJfY2FjaGVsaW5lOwogCkBAIC01MTIsNyArNTExLDcgQEAgaW50
IGk5MTVfdGltZWxpbmVfZ2V0X3NlcW5vKHN0cnVjdCBpOTE1X3RpbWVsaW5lICp0bCwKIHN0YXRp
YyBpbnQgY2FjaGVsaW5lX3JlZihzdHJ1Y3QgaTkxNV90aW1lbGluZV9jYWNoZWxpbmUgKmNsLAog
CQkJIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogewotCXJldHVybiBpOTE1X2FjdGl2ZV9yZWYo
JmNsLT5hY3RpdmUsIHJxLT5mZW5jZS5jb250ZXh0LCBycSk7CisJcmV0dXJuIGk5MTVfYWN0aXZl
X3JlZigmY2wtPmFjdGl2ZSwgcnEtPmZlbmNlLmNvbnRleHQsICZycS0+ZmVuY2UpOwogfQogCiBp
bnQgaTkxNV90aW1lbGluZV9yZWFkX2h3c3Aoc3RydWN0IGk5MTVfcmVxdWVzdCAqZnJvbSwKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdGltZWxpbmVfdHlwZXMuaCBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdGltZWxpbmVfdHlwZXMuaAppbmRleCBmY2U1Y2I0ZjEw
OTAuLjVhZjZkMTg1ZDcwYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90
aW1lbGluZV90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdGltZWxpbmVf
dHlwZXMuaApAQCAtNDUsNyArNDUsNyBAQCBzdHJ1Y3QgaTkxNV90aW1lbGluZSB7CiAJICogdGhl
IHJlcXVlc3QgdXNpbmcgaTkxNV9hY3RpdmVfcmVxdWVzdF9nZXRfcmVxdWVzdF9yY3UoKSwgb3Ig
aG9sZCB0aGUKIAkgKiBzdHJ1Y3RfbXV0ZXguCiAJICovCi0Jc3RydWN0IGk5MTVfYWN0aXZlX3Jl
cXVlc3QgbGFzdF9yZXF1ZXN0OworCXN0cnVjdCBpOTE1X2FjdGl2ZV9mZW5jZSBsYXN0X3JlcXVl
c3Q7CiAKIAkvKioKIAkgKiBXZSB0cmFjayB0aGUgbW9zdCByZWNlbnQgc2Vxbm8gdGhhdCB3ZSB3
YWl0IG9uIGluIGV2ZXJ5IGNvbnRleHQgc28KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfdm1hLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCmluZGV4IDk3
MjIyNjk0MTBiNy4uNTk0Y2FiODZlNTBjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3ZtYS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMKQEAgLTEx
Niw4ICsxMTYsNyBAQCB2bWFfY3JlYXRlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmos
CiAJdm1hLT5zaXplID0gb2JqLT5iYXNlLnNpemU7CiAJdm1hLT5kaXNwbGF5X2FsaWdubWVudCA9
IEk5MTVfR1RUX01JTl9BTElHTk1FTlQ7CiAKLQlpOTE1X2FjdGl2ZV9pbml0KHZtLT5pOTE1LCAm
dm1hLT5hY3RpdmUsCi0JCQkgX19pOTE1X3ZtYV9hY3RpdmUsIF9faTkxNV92bWFfcmV0aXJlKTsK
KwlpOTE1X2FjdGl2ZV9pbml0KCZ2bWEtPmFjdGl2ZSwgX19pOTE1X3ZtYV9hY3RpdmUsIF9faTkx
NV92bWFfcmV0aXJlKTsKIAogCUlOSVRfTElTVF9IRUFEKCZ2bWEtPmNsb3NlZF9saW5rKTsKIApA
QCAtOTExLDcgKzkxMCw3IEBAIGludCBpOTE1X3ZtYV9tb3ZlX3RvX2FjdGl2ZShzdHJ1Y3QgaTkx
NV92bWEgKnZtYSwKIAkgKiBhZGQgdGhlIGFjdGl2ZSByZWZlcmVuY2UgZmlyc3QgYW5kIHF1ZXVl
IGZvciBpdCB0byBiZSBkcm9wcGVkCiAJICogKmxhc3QqLgogCSAqLwotCWVyciA9IGk5MTVfYWN0
aXZlX3JlZigmdm1hLT5hY3RpdmUsIHJxLT5mZW5jZS5jb250ZXh0LCBycSk7CisJZXJyID0gaTkx
NV9hY3RpdmVfcmVmKCZ2bWEtPmFjdGl2ZSwgcnEtPmZlbmNlLmNvbnRleHQsICZycS0+ZmVuY2Up
OwogCWlmICh1bmxpa2VseShlcnIpKQogCQlyZXR1cm4gZXJyOwogCkBAIC05MjIsNyArOTIxLDcg
QEAgaW50IGk5MTVfdm1hX21vdmVfdG9fYWN0aXZlKHN0cnVjdCBpOTE1X3ZtYSAqdm1hLAogCQlp
ZiAoaW50ZWxfZnJvbnRidWZmZXJfaW52YWxpZGF0ZShvYmotPmZyb250YnVmZmVyLCBPUklHSU5f
Q1MpKQogCQkJaTkxNV9hY3RpdmVfcmVmKCZvYmotPmZyb250YnVmZmVyLT53cml0ZSwKIAkJCQkJ
cnEtPmZlbmNlLmNvbnRleHQsCi0JCQkJCXJxKTsKKwkJCQkJJnJxLT5mZW5jZSk7CiAKIAkJb2Jq
LT5yZWFkX2RvbWFpbnMgPSAwOwogCX0KQEAgLTk0MSwzMiArOTQwLDExIEBAIGludCBpOTE1X3Zt
YV91bmJpbmQoc3RydWN0IGk5MTVfdm1hICp2bWEpCiAKIAlsb2NrZGVwX2Fzc2VydF9oZWxkKCZ2
bWEtPnZtLT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAotCS8qCi0JICogRmlyc3Qgd2FpdCB1
cG9uIGFueSBhY3Rpdml0eSBhcyByZXRpcmluZyB0aGUgcmVxdWVzdCBtYXkKLQkgKiBoYXZlIHNp
ZGUtZWZmZWN0cyBzdWNoIGFzIHVucGlubmluZyBvciBldmVuIHVuYmluZGluZyB0aGlzIHZtYS4K
LQkgKi8KLQltaWdodF9zbGVlcCgpOwotCWlmIChpOTE1X3ZtYV9pc19hY3RpdmUodm1hKSkgewot
CQkvKgotCQkgKiBXaGVuIGEgY2xvc2VkIFZNQSBpcyByZXRpcmVkLCBpdCBpcyB1bmJvdW5kIC0g
ZWVrLgotCQkgKiBJbiBvcmRlciB0byBwcmV2ZW50IGl0IGZyb20gYmVpbmcgcmVjdXJzaXZlbHkg
Y2xvc2VkLAotCQkgKiB0YWtlIGEgcGluIG9uIHRoZSB2bWEgc28gdGhhdCB0aGUgc2Vjb25kIHVu
YmluZCBpcwotCQkgKiBhYm9ydGVkLgotCQkgKgotCQkgKiBFdmVuIG1vcmUgc2NhcnkgaXMgdGhh
dCB0aGUgcmV0aXJlIGNhbGxiYWNrIG1heSBmcmVlCi0JCSAqIHRoZSBvYmplY3QgKGxhc3QgYWN0
aXZlIHZtYSkuIFRvIHByZXZlbnQgdGhlIGV4cGxvc2lvbgotCQkgKiB3ZSBkZWZlciB0aGUgYWN0
dWFsIG9iamVjdCBmcmVlIHRvIGEgd29ya2VyIHRoYXQgY2FuCi0JCSAqIG9ubHkgcHJvY2VlZCBv
bmNlIGl0IGFjcXVpcmVzIHRoZSBzdHJ1Y3RfbXV0ZXggKHdoaWNoCi0JCSAqIHdlIGN1cnJlbnRs
eSBob2xkLCB0aGVyZWZvcmUgaXQgY2Fubm90IGZyZWUgdGhpcyBvYmplY3QKLQkJICogYmVmb3Jl
IHdlIGFyZSBmaW5pc2hlZCkuCi0JCSAqLwotCQlfX2k5MTVfdm1hX3Bpbih2bWEpOwotCQlyZXQg
PSBpOTE1X2FjdGl2ZV93YWl0KCZ2bWEtPmFjdGl2ZSk7Ci0JCV9faTkxNV92bWFfdW5waW4odm1h
KTsKLQkJaWYgKHJldCkKLQkJCXJldHVybiByZXQ7Ci0JfQorCXJldCA9IGk5MTVfYWN0aXZlX3dh
aXQoJnZtYS0+YWN0aXZlKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OwogCisJR0VNX0JVR19P
TihpOTE1X3ZtYV9pc19hY3RpdmUodm1hKSk7CiAJaWYgKGk5MTVfdm1hX2lzX3Bpbm5lZCh2bWEp
KSB7CiAJCXZtYV9wcmludF9hbGxvY2F0b3Iodm1hLCAiaXMgcGlubmVkIik7CiAJCXJldHVybiAt
RUJVU1k7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9h
Y3RpdmUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2FjdGl2ZS5jCmlu
ZGV4IDg0ZmNlMzc5YzBkZS4uNDM4NGFkNTFkNmU0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9hY3RpdmUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9zZWxmdGVzdHMvaTkxNV9hY3RpdmUuYwpAQCAtNjcsNyArNjcsNyBAQCBzdGF0aWMgc3RydWN0
IGxpdmVfYWN0aXZlICpfX2xpdmVfYWxsb2Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
CiAJCXJldHVybiBOVUxMOwogCiAJa3JlZl9pbml0KCZhY3RpdmUtPnJlZik7Ci0JaTkxNV9hY3Rp
dmVfaW5pdChpOTE1LCAmYWN0aXZlLT5iYXNlLCBfX2xpdmVfYWN0aXZlLCBfX2xpdmVfcmV0aXJl
KTsKKwlpOTE1X2FjdGl2ZV9pbml0KCZhY3RpdmUtPmJhc2UsIF9fbGl2ZV9hY3RpdmUsIF9fbGl2
ZV9yZXRpcmUpOwogCiAJcmV0dXJuIGFjdGl2ZTsKIH0KQEAgLTExMCw3ICsxMTAsOCBAQCBfX2xp
dmVfYWN0aXZlX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCQkJCQkJICAg
ICAgIEdGUF9LRVJORUwpOwogCQlpZiAoZXJyID49IDApCiAJCQllcnIgPSBpOTE1X2FjdGl2ZV9y
ZWYoJmFjdGl2ZS0+YmFzZSwKLQkJCQkJICAgICAgcnEtPmZlbmNlLmNvbnRleHQsIHJxKTsKKwkJ
CQkJICAgICAgcnEtPmZlbmNlLmNvbnRleHQsCisJCQkJCSAgICAgICZycS0+ZmVuY2UpOwogCQlp
OTE1X3JlcXVlc3RfYWRkKHJxKTsKIAkJaWYgKGVycikgewogCQkJcHJfZXJyKCJGYWlsZWQgdG8g
dHJhY2sgYWN0aXZlIHJlZiFcbiIpOwpAQCAtMTQ2LDE5ICsxNDcsMTMgQEAgc3RhdGljIGludCBs
aXZlX2FjdGl2ZV93YWl0KHZvaWQgKmFyZykKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IGFyZzsKIAlzdHJ1Y3QgbGl2ZV9hY3RpdmUgKmFjdGl2ZTsKLQlpbnRlbF93YWtlcmVm
X3Qgd2FrZXJlZjsKIAlpbnQgZXJyID0gMDsKIAogCS8qIENoZWNrIHRoYXQgd2UgZ2V0IGEgY2Fs
bGJhY2sgd2hlbiByZXF1ZXN0cyByZXRpcmUgdXBvbiB3YWl0aW5nICovCiAKLQltdXRleF9sb2Nr
KCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9n
ZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwotCiAJYWN0aXZlID0gX19saXZlX2FjdGl2ZV9zZXR1cChp
OTE1KTsKLQlpZiAoSVNfRVJSKGFjdGl2ZSkpIHsKLQkJZXJyID0gUFRSX0VSUihhY3RpdmUpOwot
CQlnb3RvIGVycjsKLQl9CisJaWYgKElTX0VSUihhY3RpdmUpKQorCQlyZXR1cm4gUFRSX0VSUihh
Y3RpdmUpOwogCiAJaTkxNV9hY3RpdmVfd2FpdCgmYWN0aXZlLT5iYXNlKTsKIAlpZiAoIWFjdGl2
ZS0+cmV0aXJlZCkgewpAQCAtMTY4LDExICsxNjMsOSBAQCBzdGF0aWMgaW50IGxpdmVfYWN0aXZl
X3dhaXQodm9pZCAqYXJnKQogCiAJX19saXZlX3B1dChhY3RpdmUpOwogCisJbXV0ZXhfbG9jaygm
aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJaWYgKGlndF9mbHVzaF90ZXN0KGk5MTUsIEk5MTVf
V0FJVF9MT0NLRUQpKQogCQllcnIgPSAtRUlPOwotCi1lcnI6Ci0JaW50ZWxfcnVudGltZV9wbV9w
dXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCW11dGV4X3VubG9jaygmaTkxNS0+ZHJt
LnN0cnVjdF9tdXRleCk7CiAKIAlyZXR1cm4gZXJyOwpAQCAtMTgyLDIzICsxNzUsMTkgQEAgc3Rh
dGljIGludCBsaXZlX2FjdGl2ZV9yZXRpcmUodm9pZCAqYXJnKQogewogCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gYXJnOwogCXN0cnVjdCBsaXZlX2FjdGl2ZSAqYWN0aXZlOwotCWlu
dGVsX3dha2VyZWZfdCB3YWtlcmVmOwogCWludCBlcnIgPSAwOwogCiAJLyogQ2hlY2sgdGhhdCB3
ZSBnZXQgYSBjYWxsYmFjayB3aGVuIHJlcXVlc3RzIGFyZSBpbmRpcmVjdGx5IHJldGlyZWQgKi8K
IAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCXdha2VyZWYgPSBpbnRl
bF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7Ci0KIAlhY3RpdmUgPSBfX2xpdmVf
YWN0aXZlX3NldHVwKGk5MTUpOwotCWlmIChJU19FUlIoYWN0aXZlKSkgewotCQllcnIgPSBQVFJf
RVJSKGFjdGl2ZSk7Ci0JCWdvdG8gZXJyOwotCX0KKwlpZiAoSVNfRVJSKGFjdGl2ZSkpCisJCXJl
dHVybiBQVFJfRVJSKGFjdGl2ZSk7CiAKIAkvKiB3YWl0cyBmb3IgJiByZXRpcmVzIGFsbCByZXF1
ZXN0cyAqLworCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWlmIChpZ3Rf
Zmx1c2hfdGVzdChpOTE1LCBJOTE1X1dBSVRfTE9DS0VEKSkKIAkJZXJyID0gLUVJTzsKKwltdXRl
eF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCiAJaWYgKCFhY3RpdmUtPnJldGly
ZWQpIHsKIAkJcHJfZXJyKCJpOTE1X2FjdGl2ZSBub3QgcmV0aXJlZCBhZnRlciBmbHVzaGluZyFc
biIpOwpAQCAtMjA3LDEwICsxOTYsNiBAQCBzdGF0aWMgaW50IGxpdmVfYWN0aXZlX3JldGlyZSh2
b2lkICphcmcpCiAKIAlfX2xpdmVfcHV0KGFjdGl2ZSk7CiAKLWVycjoKLQlpbnRlbF9ydW50aW1l
X3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1
LT5kcm0uc3RydWN0X211dGV4KTsKLQogCXJldHVybiBlcnI7CiB9CiAKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX3RpbWVsaW5lLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9zZWxmdGVzdHMvbW9ja190aW1lbGluZS5jCmluZGV4IDY1YjUyYmUyM2Q0Mi4u
MDI0ZGU3MThmNjZmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMv
bW9ja190aW1lbGluZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2Nr
X3RpbWVsaW5lLmMKQEAgLTE1LDcgKzE1LDcgQEAgdm9pZCBtb2NrX3RpbWVsaW5lX2luaXQoc3Ry
dWN0IGk5MTVfdGltZWxpbmUgKnRpbWVsaW5lLCB1NjQgY29udGV4dCkKIAogCW11dGV4X2luaXQo
JnRpbWVsaW5lLT5tdXRleCk7CiAKLQlJTklUX0FDVElWRV9SRVFVRVNUKCZ0aW1lbGluZS0+bGFz
dF9yZXF1ZXN0KTsKKwlJTklUX0FDVElWRV9GRU5DRSgmdGltZWxpbmUtPmxhc3RfcmVxdWVzdCk7
CiAJSU5JVF9MSVNUX0hFQUQoJnRpbWVsaW5lLT5yZXF1ZXN0cyk7CiAKIAlpOTE1X3N5bmNtYXBf
aW5pdCgmdGltZWxpbmUtPnN5bmMpOwotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdm
eEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFp
bG1hbi9saXN0aW5mby9pbnRlbC1nZng=

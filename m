Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 2586417861
	for <lists+intel-gfx@lfdr.de>; Wed,  8 May 2019 13:35:26 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id ABCEA8932A;
	Wed,  8 May 2019 11:35:23 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga05.intel.com (mga05.intel.com [192.55.52.43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id BE82B8932A
 for <intel-gfx@lists.freedesktop.org>; Wed,  8 May 2019 11:35:22 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga005.fm.intel.com ([10.253.24.32])
 by fmsmga105.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 08 May 2019 04:35:22 -0700
X-ExtLoop1: 1
Received: from jzapadkx-mobl1.ger.corp.intel.com (HELO [10.252.0.159])
 ([10.252.0.159])
 by fmsmga005.fm.intel.com with ESMTP; 08 May 2019 04:35:20 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20190508080704.24223-14-chris@chris-wilson.co.uk>
 <20190508112322.15413-1-chris@chris-wilson.co.uk>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <5c201555-f1da-2f16-16ec-a15815d74e78@linux.intel.com>
Date: Wed, 8 May 2019 12:35:20 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.6.1
MIME-Version: 1.0
In-Reply-To: <20190508112322.15413-1-chris@chris-wilson.co.uk>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH] drm/i915: Load balancing across a virtual
 engine
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDA4LzA1LzIwMTkgMTI6MjMsIENocmlzIFdpbHNvbiB3cm90ZToKPiBIYXZpbmcgYWxsb3dl
ZCB0aGUgdXNlciB0byBkZWZpbmUgYSBzZXQgb2YgZW5naW5lcyB0aGF0IHRoZXkgd2lsbCB3YW50
Cj4gdG8gb25seSB1c2UsIHdlIGdvIG9uZSBzdGVwIGZ1cnRoZXIgYW5kIGFsbG93IHRoZW0gdG8g
YmluZCB0aG9zZSBlbmdpbmVzCj4gaW50byBhIHNpbmdsZSB2aXJ0dWFsIGluc3RhbmNlLiBTdWJt
aXR0aW5nIGEgYmF0Y2ggdG8gdGhlIHZpcnR1YWwgZW5naW5lCj4gd2lsbCB0aGVuIGZvcndhcmQg
aXQgdG8gYW55IG9uZSBvZiB0aGUgc2V0IGluIGEgbWFubmVyIGFzIGJlc3QgdG8KPiBkaXN0cmli
dXRlIGxvYWQuICBUaGUgdmlydHVhbCBlbmdpbmUgaGFzIGEgc2luZ2xlIHRpbWVsaW5lIGFjcm9z
cyBhbGwKPiBlbmdpbmVzIChpdCBvcGVyYXRlcyBhcyBhIHNpbmdsZSBxdWV1ZSksIHNvIGl0IGlz
IG5vdCBhYmxlIHRvIGNvbmN1cnJlbnRseQo+IHJ1biBiYXRjaGVzIGFjcm9zcyBtdWx0aXBsZSBl
bmdpbmVzIGJ5IGl0c2VsZjsgdGhhdCBpcyBsZWZ0IHVwIHRvIHRoZSB1c2VyCj4gdG8gc3VibWl0
IG11bHRpcGxlIGNvbmN1cnJlbnQgYmF0Y2hlcyB0byBtdWx0aXBsZSBxdWV1ZXMuIE11bHRpcGxl
IHVzZXJzCj4gd2lsbCBiZSBsb2FkIGJhbGFuY2VkIGFjcm9zcyB0aGUgc3lzdGVtLgo+IAo+IFRo
ZSBtZWNoYW5pc20gdXNlZCBmb3IgbG9hZCBiYWxhbmNpbmcgaW4gdGhpcyBwYXRjaCBpcyBhIGxh
dGUgZ3JlZWR5Cj4gYmFsYW5jZXIuIFdoZW4gYSByZXF1ZXN0IGlzIHJlYWR5IGZvciBleGVjdXRp
b24sIGl0IGlzIGFkZGVkIHRvIGVhY2gKPiBlbmdpbmUncyBxdWV1ZSwgYW5kIHdoZW4gYW4gZW5n
aW5lIGlzIHJlYWR5IGZvciBpdHMgbmV4dCByZXF1ZXN0IGl0Cj4gY2xhaW1zIGl0IGZyb20gdGhl
IHZpcnR1YWwgZW5naW5lLiBUaGUgZmlyc3QgZW5naW5lIHRvIGRvIHNvLCB3aW5zLCBpLmUuCj4g
dGhlIHJlcXVlc3QgaXMgZXhlY3V0ZWQgYXQgdGhlIGVhcmxpZXN0IG9wcG9ydHVuaXR5IChpZGxl
IG1vbWVudCkgaW4gdGhlCj4gc3lzdGVtLgo+IAo+IEFzIG5vdCBhbGwgSFcgaXMgY3JlYXRlZCBl
cXVhbCwgdGhlIHVzZXIgaXMgc3RpbGwgYWJsZSB0byBza2lwIHRoZQo+IHZpcnR1YWwgZW5naW5l
IGFuZCBleGVjdXRlIHRoZSBiYXRjaCBvbiBhIHNwZWNpZmljIGVuZ2luZSwgYWxsIHdpdGhpbiB0
aGUKPiBzYW1lIHF1ZXVlLiBJdCB3aWxsIHRoZW4gYmUgZXhlY3V0ZWQgaW4gb3JkZXIgb24gdGhl
IGNvcnJlY3QgZW5naW5lLAo+IHdpdGggZXhlY3V0aW9uIG9uIG90aGVyIHZpcnR1YWwgZW5naW5l
cyBiZWluZyBtb3ZlZCBhd2F5IGR1ZSB0byB0aGUgbG9hZAo+IGRldGVjdGlvbi4KPiAKPiBBIGNv
dXBsZSBvZiBhcmVhcyBmb3IgcG90ZW50aWFsIGltcHJvdmVtZW50IGxlZnQhCj4gCj4gLSBUaGUg
dmlydHVhbCBlbmdpbmUgYWx3YXlzIHRha2UgcHJpb3JpdHkgb3ZlciBlcXVhbC1wcmlvcml0eSB0
YXNrcy4KPiBNb3N0bHkgYnJva2VuIHVwIGJ5IGFwcGx5aW5nIEZRX0NPREVMIHJ1bGVzIGZvciBw
cmlvcml0aXNpbmcgbmV3IGNsaWVudHMsCj4gYW5kIGhvcGVmdWxseSB0aGUgdmlydHVhbCBhbmQg
cmVhbCBlbmdpbmVzIGFyZSBub3QgdGhlbiBjb25nZXN0ZWQgKGkuZS4KPiBhbGwgd29yayBpcyB2
aWEgdmlydHVhbCBlbmdpbmVzLCBvciBhbGwgd29yayBpcyB0byB0aGUgcmVhbCBlbmdpbmUpLgo+
IAo+IC0gV2UgcmVxdWlyZSB0aGUgYnJlYWRjcnVtYiBpcnEgYXJvdW5kIGV2ZXJ5IHZpcnR1YWwg
ZW5naW5lIHJlcXVlc3QuIEZvcgo+IG5vcm1hbCBlbmdpbmVzLCB3ZSBlbGltaW5hdGUgdGhlIG5l
ZWQgZm9yIHRoZSBzbG93IHJvdW5kIHRyaXAgdmlhCj4gaW50ZXJydXB0IGJ5IHVzaW5nIHRoZSBz
dWJtaXQgZmVuY2UgYW5kIHF1ZXVlaW5nIGluIG9yZGVyLiBGb3IgdmlydHVhbAo+IGVuZ2luZXMs
IHdlIGhhdmUgdG8gYWxsb3cgYW55IGpvYiB0byB0cmFuc2ZlciB0byBhIG5ldyByaW5nLCBhbmQg
Y2Fubm90Cj4gY29hbGVzY2UgdGhlIHN1Ym1pc3Npb25zLCBzbyByZXF1aXJlIHRoZSBjb21wbGV0
aW9uIGZlbmNlIGluc3RlYWQsCj4gZm9yY2luZyB0aGUgcGVyc2lzdGVudCB1c2Ugb2YgaW50ZXJy
dXB0cy4KPiAKPiAtIFdlIG9ubHkgZHJpcCBmZWVkIHNpbmdsZSByZXF1ZXN0cyB0aHJvdWdoIGVh
Y2ggdmlydHVhbCBlbmdpbmUgYW5kIG9udG8KPiB0aGUgcGh5c2ljYWwgZW5naW5lcywgZXZlbiBp
ZiB0aGVyZSB3YXMgZW5vdWdoIHdvcmsgdG8gZmlsbCBhbGwgRUxTUCwKPiBsZWF2aW5nIHNtYWxs
IHN0YWxscyB3aXRoIGFuIGlkbGUgQ1MgZXZlbnQgYXQgdGhlIGVuZCBvZiBldmVyeSByZXF1ZXN0
Lgo+IENvdWxkIHdlIGJlIGdyZWVkeSBhbmQgZmlsbCBib3RoIHNsb3RzPyBCZWluZyBsYXp5IGlz
IHZpcnR1b3VzIGZvciBsb2FkCj4gZGlzdHJpYnV0aW9uIG9uIGxlc3MtdGhhbi1mdWxsIHdvcmts
b2FkcyB0aG91Z2guCj4gCj4gT3RoZXIgYXJlYXMgb2YgaW1wcm92ZW1lbnQgYXJlIG1vcmUgZ2Vu
ZXJhbCwgc3VjaCBhcyByZWR1Y2luZyBsb2NrCj4gY29udGVudGlvbiwgcmVkdWNpbmcgZGlzcGF0
Y2ggb3ZlcmhlYWQsIGxvb2tpbmcgYXQgZGlyZWN0IHN1Ym1pc3Npb24KPiByYXRoZXIgdGhhbiBi
b3VuY2luZyBhcm91bmQgdGFza2xldHMgZXRjLgo+IAo+IHNzZXU6IExpZnQgdGhlIHJlc3RyaWN0
aW9uIHRvIGFsbG93IHNzZXUgdG8gYmUgcmVjb25maWd1cmVkIG9uIHZpcnR1YWwKPiBlbmdpbmVz
IGNvbXBvc2VkIG9mIFJFTkRFUl9DTEFTUyAocmNzKS4KPiAKPiB2MjogbWFjcm9pemUgY2hlY2tf
dXNlcl9tYnooKQo+IHYzOiBDYW5jZWwgdmlydHVhbCBlbmdpbmVzIG9uIHdlZGdpbmcKPiB2NDog
Q29tbWVuY2UgY29tbWVudGluZwo+IHY1OiBSZXBsYWNlIDY0YiBzaWJsaW5nX21hc2sgd2l0aCBh
IGxpc3Qgb2YgY2xhc3M6aW5zdGFuY2UKPiB2NjogRHJvcCB0aGUgb25lLWVsZW1lbnQgYXJyYXkg
aW4gdGhlIHVhYmkKPiB2NzogQXNzZXJ0IGl0IGlzIGFuIHZpcnR1YWwgZW5naW5lIGluIHRvX3Zp
cnR1YWxfZW5naW5lKCkKPiB2ODogU2tpcCBvdmVyIGhvbGVzIGluIFtjbGFzc11baW5zdF0gc28g
d2UgY2FuIHNlbGZ0ZXN0IHdpdGggKHZjczAsIHZjczIpCj4gCj4gU2lnbmVkLW9mZi1ieTogQ2hy
aXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Cj4gQ2M6IFR2cnRrbyBVcnN1bGlu
IDx0dnJ0a28udXJzdWxpbkBpbnRlbC5jb20+Cj4gLS0tCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaCB8ICAgOCArCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9scmMuYyAgICAgICAgICB8IDY4MyArKysrKysrKysrKysrKysrKystCj4gICBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuaCAgICAgICAgICB8ICAgOSArCj4gICBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYyAgICAgICB8IDE4MCArKysrKwo+
ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uaCAgICAgICAgICAgICAgfCAgIDUgKwo+
ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fY29udGV4dC5jICAgICAgfCAxMTYgKysr
LQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zY2hlZHVsZXIuYyAgICAgICAgfCAgMTkg
Ky0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdGltZWxpbmVfdHlwZXMuaCAgIHwgICAx
ICsKPiAgIGluY2x1ZGUvdWFwaS9kcm0vaTkxNV9kcm0uaCAgICAgICAgICAgICAgICAgIHwgIDM5
ICsrCj4gICA5IGZpbGVzIGNoYW5nZWQsIDEwMzIgaW5zZXJ0aW9ucygrKSwgMjggZGVsZXRpb25z
KC0pCj4gCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2lu
ZV90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmgK
PiBpbmRleCBlMzgxYzFjNzM5MDIuLjdiNDdlMDBmYTA4MiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oCj4gQEAgLTIyNyw2ICsyMjcsNyBAQCBz
dHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyB7Cj4gICAJICogQHF1ZXVlOiBxdWV1ZSBvZiBy
ZXF1ZXN0cywgaW4gcHJpb3JpdHkgbGlzdHMKPiAgIAkgKi8KPiAgIAlzdHJ1Y3QgcmJfcm9vdF9j
YWNoZWQgcXVldWU7Cj4gKwlzdHJ1Y3QgcmJfcm9vdF9jYWNoZWQgdmlydHVhbDsKPiAgIAo+ICAg
CS8qKgo+ICAgCSAqIEBjc2Jfd3JpdGU6IGNvbnRyb2wgcmVnaXN0ZXIgZm9yIENvbnRleHQgU3dp
dGNoIGJ1ZmZlcgo+IEBAIC00NDUsNiArNDQ2LDcgQEAgc3RydWN0IGludGVsX2VuZ2luZV9jcyB7
Cj4gICAjZGVmaW5lIEk5MTVfRU5HSU5FX0hBU19QUkVFTVBUSU9OICAgQklUKDIpCj4gICAjZGVm
aW5lIEk5MTVfRU5HSU5FX0hBU19TRU1BUEhPUkVTICAgQklUKDMpCj4gICAjZGVmaW5lIEk5MTVf
RU5HSU5FX05FRURTX0JSRUFEQ1JVTUJfVEFTS0xFVCBCSVQoNCkKPiArI2RlZmluZSBJOTE1X0VO
R0lORV9JU19WSVJUVUFMICAgICAgIEJJVCg1KQo+ICAgCXVuc2lnbmVkIGludCBmbGFnczsKPiAg
IAo+ICAgCS8qCj4gQEAgLTUzNCw2ICs1MzYsMTIgQEAgaW50ZWxfZW5naW5lX25lZWRzX2JyZWFk
Y3J1bWJfdGFza2xldChjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gICAJ
cmV0dXJuIGVuZ2luZS0+ZmxhZ3MgJiBJOTE1X0VOR0lORV9ORUVEU19CUkVBRENSVU1CX1RBU0tM
RVQ7Cj4gICB9Cj4gICAKPiArc3RhdGljIGlubGluZSBib29sCj4gK2ludGVsX2VuZ2luZV9pc192
aXJ0dWFsKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiArewo+ICsJcmV0
dXJuIGVuZ2luZS0+ZmxhZ3MgJiBJOTE1X0VOR0lORV9JU19WSVJUVUFMOwo+ICt9Cj4gKwo+ICAg
I2RlZmluZSBpbnN0ZG9uZV9zbGljZV9tYXNrKGRldl9wcml2X18pIFwKPiAgIAkoSVNfR0VOKGRl
dl9wcml2X18sIDcpID8gXAo+ICAgCSAxIDogUlVOVElNRV9JTkZPKGRldl9wcml2X18pLT5zc2V1
LnNsaWNlX21hc2spCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2xyYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKPiBpbmRleCBmMWQ2
Mjc0NmUwNjYuLmJjMzg4ZGYzOTgwMiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9scmMuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xy
Yy5jCj4gQEAgLTE2Niw2ICsxNjYsNDIgQEAKPiAgIAo+ICAgI2RlZmluZSBBQ1RJVkVfUFJJT1JJ
VFkgKEk5MTVfUFJJT1JJVFlfTkVXQ0xJRU5UIHwgSTkxNV9QUklPUklUWV9OT1NFTUFQSE9SRSkK
PiAgIAo+ICtzdHJ1Y3QgdmlydHVhbF9lbmdpbmUgewo+ICsJc3RydWN0IGludGVsX2VuZ2luZV9j
cyBiYXNlOwo+ICsJc3RydWN0IGludGVsX2NvbnRleHQgY29udGV4dDsKPiArCj4gKwkvKgo+ICsJ
ICogV2UgYWxsb3cgb25seSBhIHNpbmdsZSByZXF1ZXN0IHRocm91Z2ggdGhlIHZpcnR1YWwgZW5n
aW5lIGF0IGEgdGltZQo+ICsJICogKGVhY2ggcmVxdWVzdCBpbiB0aGUgdGltZWxpbmUgd2FpdHMg
Zm9yIHRoZSBjb21wbGV0aW9uIGZlbmNlIG9mCj4gKwkgKiB0aGUgcHJldmlvdXMgYmVmb3JlIGJl
aW5nIHN1Ym1pdHRlZCkuIEJ5IHJlc3RyaWN0aW5nIG91cnNlbHZlcyB0bwo+ICsJICogb25seSBz
dWJtaXR0aW5nIGEgc2luZ2xlIHJlcXVlc3QsIGVhY2ggcmVxdWVzdCBpcyBwbGFjZWQgb24gdG8g
YQo+ICsJICogcGh5c2ljYWwgdG8gbWF4aW1pc2UgbG9hZCBzcHJlYWRpbmcgKGJ5IHZpcnR1ZSBv
ZiB0aGUgbGF0ZSBncmVlZHkKPiArCSAqIHNjaGVkdWxpbmcgLS0gZWFjaCByZWFsIGVuZ2luZSB0
YWtlcyB0aGUgbmV4dCBhdmFpbGFibGUgcmVxdWVzdAo+ICsJICogdXBvbiBpZGxpbmcpLgo+ICsJ
ICovCj4gKwlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0Owo+ICsKPiArCS8qCj4gKwkgKiBX
ZSBrZWVwIGEgcmJ0cmVlIG9mIGF2YWlsYWJsZSB2aXJ0dWFsIGVuZ2luZXMgaW5zaWRlIGVhY2gg
cGh5c2ljYWwKPiArCSAqIGVuZ2luZSwgc29ydGVkIGJ5IHByaW9yaXR5LiBIZXJlIHdlIHByZWFs
bG9jYXRlIHRoZSBub2RlcyB3ZSBuZWVkCj4gKwkgKiBmb3IgdGhlIHZpcnR1YWwgZW5naW5lLCBp
bmRleGVkIGJ5IHBoeXNpY2FsX2VuZ2luZS0+aWQuCj4gKwkgKi8KPiArCXN0cnVjdCB2ZV9ub2Rl
IHsKPiArCQlzdHJ1Y3QgcmJfbm9kZSByYjsKPiArCQlpbnQgcHJpbzsKPiArCX0gbm9kZXNbSTkx
NV9OVU1fRU5HSU5FU107Cj4gKwo+ICsJLyogQW5kIGZpbmFsbHksIHdoaWNoIHBoeXNpY2FsIGVu
Z2luZXMgdGhpcyB2aXJ0dWFsIGVuZ2luZSBtYXBzIG9udG8uICovCj4gKwl1bnNpZ25lZCBpbnQg
bnVtX3NpYmxpbmdzOwo+ICsJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqc2libGluZ3NbMF07Cj4g
K307Cj4gKwo+ICtzdGF0aWMgc3RydWN0IHZpcnR1YWxfZW5naW5lICp0b192aXJ0dWFsX2VuZ2lu
ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gK3sKPiArCUdFTV9CVUdfT04oIWlu
dGVsX2VuZ2luZV9pc192aXJ0dWFsKGVuZ2luZSkpOwo+ICsJcmV0dXJuIGNvbnRhaW5lcl9vZihl
bmdpbmUsIHN0cnVjdCB2aXJ0dWFsX2VuZ2luZSwgYmFzZSk7Cj4gK30KPiArCj4gICBzdGF0aWMg
aW50IGV4ZWNsaXN0c19jb250ZXh0X2RlZmVycmVkX2FsbG9jKHN0cnVjdCBpbnRlbF9jb250ZXh0
ICpjZSwKPiAgIAkJCQkJICAgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7Cj4gICBz
dGF0aWMgdm9pZCBleGVjbGlzdHNfaW5pdF9yZWdfc3RhdGUodTMyICpyZWdfc3RhdGUsCj4gQEAg
LTIyOSw3ICsyNjUsOCBAQCBzdGF0aWMgaW50IHF1ZXVlX3ByaW8oY29uc3Qgc3RydWN0IGludGVs
X2VuZ2luZV9leGVjbGlzdHMgKmV4ZWNsaXN0cykKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGlubGlu
ZSBib29sIG5lZWRfcHJlZW1wdChjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUs
Cj4gLQkJCQljb25zdCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKPiArCQkJCWNvbnN0IHN0cnVj
dCBpOTE1X3JlcXVlc3QgKnJxLAo+ICsJCQkJc3RydWN0IHJiX25vZGUgKnJiKQo+ICAgewo+ICAg
CWludCBsYXN0X3ByaW87Cj4gICAKPiBAQCAtMjY0LDYgKzMwMSwyNSBAQCBzdGF0aWMgaW5saW5l
IGJvb2wgbmVlZF9wcmVlbXB0KGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwK
PiAgIAkgICAgcnFfcHJpbyhsaXN0X25leHRfZW50cnkocnEsIGxpbmspKSA+IGxhc3RfcHJpbykK
PiAgIAkJcmV0dXJuIHRydWU7Cj4gICAKPiArCWlmIChyYikgewo+ICsJCXN0cnVjdCB2aXJ0dWFs
X2VuZ2luZSAqdmUgPQo+ICsJCQlyYl9lbnRyeShyYiwgdHlwZW9mKCp2ZSksIG5vZGVzW2VuZ2lu
ZS0+aWRdLnJiKTsKPiArCQlib29sIHByZWVtcHQgPSBmYWxzZTsKPiArCj4gKwkJaWYgKGVuZ2lu
ZSA9PSB2ZS0+c2libGluZ3NbMF0pIHsgLyogb25seSBwcmVlbXB0IG9uZSBzaWJsaW5nICovCj4g
KwkJCXN0cnVjdCBpOTE1X3JlcXVlc3QgKm5leHQ7Cj4gKwo+ICsJCQlyY3VfcmVhZF9sb2NrKCk7
Cj4gKwkJCW5leHQgPSBSRUFEX09OQ0UodmUtPnJlcXVlc3QpOwo+ICsJCQlpZiAobmV4dCkKPiAr
CQkJCXByZWVtcHQgPSBycV9wcmlvKG5leHQpID4gbGFzdF9wcmlvOwo+ICsJCQlyY3VfcmVhZF91
bmxvY2soKTsKPiArCQl9Cj4gKwo+ICsJCWlmIChwcmVlbXB0KQo+ICsJCQlyZXR1cm4gcHJlZW1w
dDsKPiArCX0KPiArCj4gICAJLyoKPiAgIAkgKiBJZiB0aGUgaW5mbGlnaHQgY29udGV4dCBkaWQg
bm90IHRyaWdnZXIgdGhlIHByZWVtcHRpb24sIHRoZW4gbWF5YmUKPiAgIAkgKiBpdCB3YXMgdGhl
IHNldCBvZiBxdWV1ZWQgcmVxdWVzdHM/IFBpY2sgdGhlIGhpZ2hlc3QgcHJpb3JpdHkgaW4KPiBA
QCAtMzgyLDYgKzQzOCw4IEBAIF9fdW53aW5kX2luY29tcGxldGVfcmVxdWVzdHMoc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lLCBpbnQgYm9vc3QpCj4gICAJbGlzdF9mb3JfZWFjaF9lbnRy
eV9zYWZlX3JldmVyc2UocnEsIHJuLAo+ICAgCQkJCQkgJmVuZ2luZS0+dGltZWxpbmUucmVxdWVz
dHMsCj4gICAJCQkJCSBsaW5rKSB7Cj4gKwkJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqb3duZXI7
Cj4gKwo+ICAgCQlpZiAoaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChycSkpCj4gICAJCQlicmVhazsK
PiAgIAo+IEBAIC0zOTAsMTYgKzQ0OCwzMiBAQCBfX3Vud2luZF9pbmNvbXBsZXRlX3JlcXVlc3Rz
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgaW50IGJvb3N0KQo+ICAgCj4gICAJCUdF
TV9CVUdfT04ocnEtPmh3X2NvbnRleHQtPmFjdGl2ZSk7Cj4gICAKPiAtCQlHRU1fQlVHX09OKHJx
X3ByaW8ocnEpID09IEk5MTVfUFJJT1JJVFlfSU5WQUxJRCk7Cj4gLQkJaWYgKHJxX3ByaW8ocnEp
ICE9IHByaW8pIHsKPiAtCQkJcHJpbyA9IHJxX3ByaW8ocnEpOwo+IC0JCQlwbCA9IGk5MTVfc2No
ZWRfbG9va3VwX3ByaW9saXN0KGVuZ2luZSwgcHJpbyk7Cj4gLQkJfQo+IC0JCUdFTV9CVUdfT04o
UkJfRU1QVFlfUk9PVCgmZW5naW5lLT5leGVjbGlzdHMucXVldWUucmJfcm9vdCkpOwo+ICsJCS8q
Cj4gKwkJICogUHVzaCB0aGUgcmVxdWVzdCBiYWNrIGludG8gdGhlIHF1ZXVlIGZvciBsYXRlciBy
ZXN1Ym1pc3Npb24uCj4gKwkJICogSWYgdGhpcyByZXF1ZXN0IGlzIG5vdCBuYXRpdmUgdG8gdGhp
cyBwaHlzaWNhbCBlbmdpbmUgKGkuZS4KPiArCQkgKiBpdCBjYW1lIGZyb20gYSB2aXJ0dWFsIHNv
dXJjZSksIHB1c2ggaXQgYmFjayBvbnRvIHRoZSB2aXJ0dWFsCj4gKwkJICogZW5naW5lIHNvIHRo
YXQgaXQgY2FuIGJlIG1vdmVkIGFjcm9zcyBvbnRvIGFub3RoZXIgcGh5c2ljYWwKPiArCQkgKiBl
bmdpbmUgYXMgbG9hZCBkaWN0YXRlcy4KPiArCQkgKi8KPiArCQlvd25lciA9IHJxLT5od19jb250
ZXh0LT5lbmdpbmU7Cj4gKwkJaWYgKGxpa2VseShvd25lciA9PSBlbmdpbmUpKSB7Cj4gKwkJCUdF
TV9CVUdfT04ocnFfcHJpbyhycSkgPT0gSTkxNV9QUklPUklUWV9JTlZBTElEKTsKPiArCQkJaWYg
KHJxX3ByaW8ocnEpICE9IHByaW8pIHsKPiArCQkJCXByaW8gPSBycV9wcmlvKHJxKTsKPiArCQkJ
CXBsID0gaTkxNV9zY2hlZF9sb29rdXBfcHJpb2xpc3QoZW5naW5lLCBwcmlvKTsKPiArCQkJfQo+
ICsJCQlHRU1fQlVHX09OKFJCX0VNUFRZX1JPT1QoJmVuZ2luZS0+ZXhlY2xpc3RzLnF1ZXVlLnJi
X3Jvb3QpKTsKPiAgIAo+IC0JCWxpc3RfYWRkKCZycS0+c2NoZWQubGluaywgcGwpOwo+ICsJCQls
aXN0X2FkZCgmcnEtPnNjaGVkLmxpbmssIHBsKTsKPiArCQkJYWN0aXZlID0gcnE7Cj4gKwkJfSBl
bHNlIHsKPiArCQkJaWYgKF9faTkxNV9yZXF1ZXN0X2hhc19zdGFydGVkKHJxKSkKPiArCQkJCXJx
LT5zY2hlZC5hdHRyLnByaW9yaXR5IHw9IGJvb3N0Owo+ICAgCj4gLQkJYWN0aXZlID0gcnE7Cj4g
KwkJCXJxLT5lbmdpbmUgPSBvd25lcjsKPiArCQkJb3duZXItPnN1Ym1pdF9yZXF1ZXN0KHJxKTsK
PiArCQkJYWN0aXZlID0gTlVMTDsKPiArCQl9Cj4gICAJfQo+ICAgCj4gICAJLyoKPiBAQCAtNDE5
LDcgKzQ5Myw3IEBAIF9fdW53aW5kX2luY29tcGxldGVfcmVxdWVzdHMoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lLCBpbnQgYm9vc3QpCj4gICAJICogaW4gdGhlIHByaW9yaXR5IHF1ZXVl
LCBidXQgdGhleSB3aWxsIG5vdCBnYWluIGltbWVkaWF0ZSBhY2Nlc3MgdG8KPiAgIAkgKiB0aGUg
R1BVLgo+ICAgCSAqLwo+IC0JaWYgKH5wcmlvICYgYm9vc3QgJiYgX19pOTE1X3JlcXVlc3RfaGFz
X3N0YXJ0ZWQoYWN0aXZlKSkgewo+ICsJaWYgKH5wcmlvICYgYm9vc3QgJiYgYWN0aXZlICYmIF9f
aTkxNV9yZXF1ZXN0X2hhc19zdGFydGVkKGFjdGl2ZSkpIHsKPiAgIAkJcHJpbyB8PSBib29zdDsK
PiAgIAkJR0VNX0JVR19PTihhY3RpdmUtPnNjaGVkLmF0dHIucHJpb3JpdHkgPj0gcHJpbyk7Cj4g
ICAJCWFjdGl2ZS0+c2NoZWQuYXR0ci5wcmlvcml0eSA9IHByaW87Cj4gQEAgLTY2MSw2ICs3MzUs
OTAgQEAgc3RhdGljIHZvaWQgY29tcGxldGVfcHJlZW1wdF9jb250ZXh0KHN0cnVjdCBpbnRlbF9l
bmdpbmVfZXhlY2xpc3RzICpleGVjbGlzdHMpCj4gICAJCQkJICAgICBBQ1RJVkVfUFJJT1JJVFkp
Owo+ICAgfQo+ICAgCj4gK3N0YXRpYyB2b2lkIHZpcnR1YWxfdXBkYXRlX3JlZ2lzdGVyX29mZnNl
dHModTMyICpyZWdzLAo+ICsJCQkJCSAgICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUp
Cj4gK3sKPiArCXUzMiBiYXNlID0gZW5naW5lLT5tbWlvX2Jhc2U7Cj4gKwo+ICsJLyogTXVzdCBt
YXRjaCBleGVjbGlzdHNfaW5pdF9yZWdfc3RhdGUoKSEgKi8KPiArCj4gKwlyZWdzW0NUWF9DT05U
RVhUX0NPTlRST0xdID0KPiArCQlpOTE1X21taW9fcmVnX29mZnNldChSSU5HX0NPTlRFWFRfQ09O
VFJPTChiYXNlKSk7Cj4gKwlyZWdzW0NUWF9SSU5HX0hFQURdID0gaTkxNV9tbWlvX3JlZ19vZmZz
ZXQoUklOR19IRUFEKGJhc2UpKTsKPiArCXJlZ3NbQ1RYX1JJTkdfVEFJTF0gPSBpOTE1X21taW9f
cmVnX29mZnNldChSSU5HX1RBSUwoYmFzZSkpOwo+ICsJcmVnc1tDVFhfUklOR19CVUZGRVJfU1RB
UlRdID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19TVEFSVChiYXNlKSk7Cj4gKwlyZWdzW0NU
WF9SSU5HX0JVRkZFUl9DT05UUk9MXSA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfQ1RMKGJh
c2UpKTsKPiArCj4gKwlyZWdzW0NUWF9CQl9IRUFEX1VdID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQo
UklOR19CQkFERFJfVURXKGJhc2UpKTsKPiArCXJlZ3NbQ1RYX0JCX0hFQURfTF0gPSBpOTE1X21t
aW9fcmVnX29mZnNldChSSU5HX0JCQUREUihiYXNlKSk7Cj4gKwlyZWdzW0NUWF9CQl9TVEFURV0g
PSBpOTE1X21taW9fcmVnX29mZnNldChSSU5HX0JCU1RBVEUoYmFzZSkpOwo+ICsJcmVnc1tDVFhf
U0VDT05EX0JCX0hFQURfVV0gPQo+ICsJCWk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfU0JCQURE
Ul9VRFcoYmFzZSkpOwo+ICsJcmVnc1tDVFhfU0VDT05EX0JCX0hFQURfTF0gPSBpOTE1X21taW9f
cmVnX29mZnNldChSSU5HX1NCQkFERFIoYmFzZSkpOwo+ICsJcmVnc1tDVFhfU0VDT05EX0JCX1NU
QVRFXSA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfU0JCU1RBVEUoYmFzZSkpOwo+ICsKPiAr
CXJlZ3NbQ1RYX0NUWF9USU1FU1RBTVBdID0KPiArCQlpOTE1X21taW9fcmVnX29mZnNldChSSU5H
X0NUWF9USU1FU1RBTVAoYmFzZSkpOwo+ICsJcmVnc1tDVFhfUERQM19VRFddID0gaTkxNV9tbWlv
X3JlZ19vZmZzZXQoR0VOOF9SSU5HX1BEUF9VRFcoYmFzZSwgMykpOwo+ICsJcmVnc1tDVFhfUERQ
M19MRFddID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9SSU5HX1BEUF9MRFcoYmFzZSwgMykp
Owo+ICsJcmVnc1tDVFhfUERQMl9VRFddID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9SSU5H
X1BEUF9VRFcoYmFzZSwgMikpOwo+ICsJcmVnc1tDVFhfUERQMl9MRFddID0gaTkxNV9tbWlvX3Jl
Z19vZmZzZXQoR0VOOF9SSU5HX1BEUF9MRFcoYmFzZSwgMikpOwo+ICsJcmVnc1tDVFhfUERQMV9V
RFddID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9SSU5HX1BEUF9VRFcoYmFzZSwgMSkpOwo+
ICsJcmVnc1tDVFhfUERQMV9MRFddID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9SSU5HX1BE
UF9MRFcoYmFzZSwgMSkpOwo+ICsJcmVnc1tDVFhfUERQMF9VRFddID0gaTkxNV9tbWlvX3JlZ19v
ZmZzZXQoR0VOOF9SSU5HX1BEUF9VRFcoYmFzZSwgMCkpOwo+ICsJcmVnc1tDVFhfUERQMF9MRFdd
ID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9SSU5HX1BEUF9MRFcoYmFzZSwgMCkpOwo+ICsK
PiArCWlmIChlbmdpbmUtPmNsYXNzID09IFJFTkRFUl9DTEFTUykgewo+ICsJCXJlZ3NbQ1RYX1JD
U19JTkRJUkVDVF9DVFhdID0KPiArCQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19JTkRJUkVD
VF9DVFgoYmFzZSkpOwo+ICsJCXJlZ3NbQ1RYX1JDU19JTkRJUkVDVF9DVFhfT0ZGU0VUXSA9Cj4g
KwkJCWk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfSU5ESVJFQ1RfQ1RYX09GRlNFVChiYXNlKSk7
Cj4gKwkJcmVnc1tDVFhfQkJfUEVSX0NUWF9QVFJdID0KPiArCQkJaTkxNV9tbWlvX3JlZ19vZmZz
ZXQoUklOR19CQl9QRVJfQ1RYX1BUUihiYXNlKSk7Cj4gKwo+ICsJCXJlZ3NbQ1RYX1JfUFdSX0NM
S19TVEFURV0gPQo+ICsJCQlpOTE1X21taW9fcmVnX29mZnNldChHRU44X1JfUFdSX0NMS19TVEFU
RSk7Cj4gKwl9Cj4gK30KPiArCj4gK3N0YXRpYyBib29sIHZpcnR1YWxfbWF0Y2hlcyhjb25zdCBz
dHJ1Y3QgdmlydHVhbF9lbmdpbmUgKnZlLAo+ICsJCQkgICAgY29uc3Qgc3RydWN0IGk5MTVfcmVx
dWVzdCAqcnEsCj4gKwkJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUp
Cj4gK3sKPiArCWNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmFjdGl2ZTsKPiArCj4gKwkv
Kgo+ICsJICogV2UgdHJhY2sgd2hlbiB0aGUgSFcgaGFzIGNvbXBsZXRlZCBzYXZpbmcgdGhlIGNv
bnRleHQgaW1hZ2UKPiArCSAqIChpLmUuIHdoZW4gd2UgaGF2ZSBzZWVuIHRoZSBmaW5hbCBDUyBl
dmVudCBzd2l0Y2hpbmcgb3V0IG9mCj4gKwkgKiB0aGUgY29udGV4dCkgYW5kIG11c3Qgbm90IG92
ZXJ3cml0ZSB0aGUgY29udGV4dCBpbWFnZSBiZWZvcmUKPiArCSAqIHRoZW4uIFRoaXMgcmVzdHJp
Y3RzIHVzIHRvIG9ubHkgdXNpbmcgdGhlIGFjdGl2ZSBlbmdpbmUKPiArCSAqIHdoaWxlIHRoZSBw
cmV2aW91cyB2aXJ0dWFsaXplZCByZXF1ZXN0IGlzIGluZmxpZ2h0IChzbwo+ICsJICogd2UgcmV1
c2UgdGhlIHJlZ2lzdGVyIG9mZnNldHMpLiBUaGlzIGlzIGEgdmVyeSBzbWFsbAo+ICsJICogaHlz
dGVyc2lzIG9uIHRoZSBncmVlZHkgc2VlbGN0aW9uIGFsZ29yaXRobS4KPiArCSAqLwo+ICsJYWN0
aXZlID0gUkVBRF9PTkNFKHZlLT5jb250ZXh0LmFjdGl2ZSk7Cj4gKwlpZiAoYWN0aXZlICYmIGFj
dGl2ZSAhPSBlbmdpbmUpCj4gKwkJcmV0dXJuIGZhbHNlOwo+ICsKPiArCXJldHVybiB0cnVlOwo+
ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCB2aXJ0dWFsX3hmZXJfYnJlYWRjcnVtYnMoc3RydWN0IHZp
cnR1YWxfZW5naW5lICp2ZSwKPiArCQkJCSAgICAgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lKQo+ICt7Cj4gKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpvbGQgPSB2ZS0+c2libGluZ3Nb
MF07Cj4gKwo+ICsJLyogQWxsIHVuYXR0YWNoZWQgKHJxLT5lbmdpbmUgPT0gb2xkKSBtdXN0IGFs
cmVhZHkgYmUgY29tcGxldGVkICovCj4gKwo+ICsJc3Bpbl9sb2NrKCZvbGQtPmJyZWFkY3J1bWJz
LmlycV9sb2NrKTsKPiArCWlmICghbGlzdF9lbXB0eSgmdmUtPmNvbnRleHQuc2lnbmFsX2xpbmsp
KSB7Cj4gKwkJbGlzdF9tb3ZlX3RhaWwoJnZlLT5jb250ZXh0LnNpZ25hbF9saW5rLAo+ICsJCQkg
ICAgICAgJmVuZ2luZS0+YnJlYWRjcnVtYnMuc2lnbmFsZXJzKTsKPiArCQlpbnRlbF9lbmdpbmVf
cXVldWVfYnJlYWRjcnVtYnMoZW5naW5lKTsKPiArCX0KPiArCXNwaW5fdW5sb2NrKCZvbGQtPmJy
ZWFkY3J1bWJzLmlycV9sb2NrKTsKPiArfQo+ICsKPiAgIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19k
ZXF1ZXVlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiAgIHsKPiAgIAlzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAqIGNvbnN0IGV4ZWNsaXN0cyA9ICZlbmdpbmUtPmV4ZWNs
aXN0czsKPiBAQCAtNjkzLDYgKzg1MSwyNiBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfZGVxdWV1
ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gICAJICogYW5kIGNvbnRleHQgc3dp
dGNoZXMpIHN1Ym1pc3Npb24uCj4gICAJICovCj4gICAKPiArCWZvciAocmIgPSByYl9maXJzdF9j
YWNoZWQoJmV4ZWNsaXN0cy0+dmlydHVhbCk7IHJiOyApIHsKPiArCQlzdHJ1Y3QgdmlydHVhbF9l
bmdpbmUgKnZlID0KPiArCQkJcmJfZW50cnkocmIsIHR5cGVvZigqdmUpLCBub2Rlc1tlbmdpbmUt
PmlkXS5yYik7Cj4gKwkJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEgPSBSRUFEX09OQ0UodmUtPnJl
cXVlc3QpOwo+ICsKPiArCQlpZiAoIXJxKSB7IC8qIGxhemlseSBjbGVhbnVwIGFmdGVyIGFub3Ro
ZXIgZW5naW5lIGhhbmRsZWQgcnEgKi8KPiArCQkJcmJfZXJhc2VfY2FjaGVkKHJiLCAmZXhlY2xp
c3RzLT52aXJ0dWFsKTsKPiArCQkJUkJfQ0xFQVJfTk9ERShyYik7Cj4gKwkJCXJiID0gcmJfZmly
c3RfY2FjaGVkKCZleGVjbGlzdHMtPnZpcnR1YWwpOwo+ICsJCQljb250aW51ZTsKPiArCQl9Cj4g
Kwo+ICsJCWlmICghdmlydHVhbF9tYXRjaGVzKHZlLCBycSwgZW5naW5lKSkgewo+ICsJCQlyYiA9
IHJiX25leHQocmIpOwo+ICsJCQljb250aW51ZTsKPiArCQl9Cj4gKwo+ICsJCWJyZWFrOwo+ICsJ
fQo+ICsKPiAgIAlpZiAobGFzdCkgewo+ICAgCQkvKgo+ICAgCQkgKiBEb24ndCByZXN1Ym1pdCBv
ciBzd2l0Y2ggdW50aWwgYWxsIG91dHN0YW5kaW5nCj4gQEAgLTcxNCw3ICs4OTIsNyBAQCBzdGF0
aWMgdm9pZCBleGVjbGlzdHNfZGVxdWV1ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUp
Cj4gICAJCWlmICghZXhlY2xpc3RzX2lzX2FjdGl2ZShleGVjbGlzdHMsIEVYRUNMSVNUU19BQ1RJ
VkVfSFdBQ0spKQo+ICAgCQkJcmV0dXJuOwo+ICAgCj4gLQkJaWYgKG5lZWRfcHJlZW1wdChlbmdp
bmUsIGxhc3QpKSB7Cj4gKwkJaWYgKG5lZWRfcHJlZW1wdChlbmdpbmUsIGxhc3QsIHJiKSkgewo+
ICAgCQkJaW5qZWN0X3ByZWVtcHRfY29udGV4dChlbmdpbmUpOwo+ICAgCQkJcmV0dXJuOwo+ICAg
CQl9Cj4gQEAgLTc1NCw2ICs5MzIsOTIgQEAgc3RhdGljIHZvaWQgZXhlY2xpc3RzX2RlcXVldWUo
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+ICAgCQlsYXN0LT50YWlsID0gbGFzdC0+
d2FfdGFpbDsKPiAgIAl9Cj4gICAKPiArCXdoaWxlIChyYikgeyAvKiBYWFggdmlydHVhbCBpcyBh
bHdheXMgdGFraW5nIHByZWNlZGVuY2UgKi8KPiArCQlzdHJ1Y3QgdmlydHVhbF9lbmdpbmUgKnZl
ID0KPiArCQkJcmJfZW50cnkocmIsIHR5cGVvZigqdmUpLCBub2Rlc1tlbmdpbmUtPmlkXS5yYik7
Cj4gKwkJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7Cj4gKwo+ICsJCXNwaW5fbG9jaygmdmUtPmJh
c2UudGltZWxpbmUubG9jayk7Cj4gKwo+ICsJCXJxID0gdmUtPnJlcXVlc3Q7Cj4gKwkJaWYgKHVu
bGlrZWx5KCFycSkpIHsgLyogbG9zdCB0aGUgcmFjZSB0byBhIHNpYmxpbmcgKi8KPiArCQkJc3Bp
bl91bmxvY2soJnZlLT5iYXNlLnRpbWVsaW5lLmxvY2spOwo+ICsJCQlyYl9lcmFzZV9jYWNoZWQo
cmIsICZleGVjbGlzdHMtPnZpcnR1YWwpOwo+ICsJCQlSQl9DTEVBUl9OT0RFKHJiKTsKPiArCQkJ
cmIgPSByYl9maXJzdF9jYWNoZWQoJmV4ZWNsaXN0cy0+dmlydHVhbCk7Cj4gKwkJCWNvbnRpbnVl
Owo+ICsJCX0KPiArCj4gKwkJR0VNX0JVR19PTihycSAhPSB2ZS0+cmVxdWVzdCk7Cj4gKwkJR0VN
X0JVR19PTihycS0+ZW5naW5lICE9ICZ2ZS0+YmFzZSk7Cj4gKwkJR0VNX0JVR19PTihycS0+aHdf
Y29udGV4dCAhPSAmdmUtPmNvbnRleHQpOwo+ICsKPiArCQlpZiAocnFfcHJpbyhycSkgPj0gcXVl
dWVfcHJpbyhleGVjbGlzdHMpKSB7Cj4gKwkJCWlmICghdmlydHVhbF9tYXRjaGVzKHZlLCBycSwg
ZW5naW5lKSkgewo+ICsJCQkJc3Bpbl91bmxvY2soJnZlLT5iYXNlLnRpbWVsaW5lLmxvY2spOwo+
ICsJCQkJcmIgPSByYl9uZXh0KHJiKTsKPiArCQkJCWNvbnRpbnVlOwo+ICsJCQl9Cj4gKwo+ICsJ
CQlpZiAobGFzdCAmJiAhY2FuX21lcmdlX3JxKGxhc3QsIHJxKSkgewo+ICsJCQkJc3Bpbl91bmxv
Y2soJnZlLT5iYXNlLnRpbWVsaW5lLmxvY2spOwo+ICsJCQkJcmV0dXJuOyAvKiBsZWF2ZSB0aGlz
IHJxIGZvciBhbm90aGVyIGVuZ2luZSAqLwo+ICsJCQl9Cj4gKwo+ICsJCQlHRU1fVFJBQ0UoIiVz
OiB2aXJ0dWFsIHJxPSVsbHg6JWxsZCVzLCBuZXcgZW5naW5lPyAlc1xuIiwKPiArCQkJCSAgZW5n
aW5lLT5uYW1lLAo+ICsJCQkJICBycS0+ZmVuY2UuY29udGV4dCwKPiArCQkJCSAgcnEtPmZlbmNl
LnNlcW5vLAo+ICsJCQkJICBpOTE1X3JlcXVlc3RfY29tcGxldGVkKHJxKSA/ICIhIiA6Cj4gKwkJ
CQkgIGk5MTVfcmVxdWVzdF9zdGFydGVkKHJxKSA/ICIqIiA6Cj4gKwkJCQkgICIiLAo+ICsJCQkJ
ICB5ZXNubyhlbmdpbmUgIT0gdmUtPnNpYmxpbmdzWzBdKSk7Cj4gKwo+ICsJCQl2ZS0+cmVxdWVz
dCA9IE5VTEw7Cj4gKwkJCXZlLT5iYXNlLmV4ZWNsaXN0cy5xdWV1ZV9wcmlvcml0eV9oaW50ID0g
SU5UX01JTjsKPiArCQkJcmJfZXJhc2VfY2FjaGVkKHJiLCAmZXhlY2xpc3RzLT52aXJ0dWFsKTsK
PiArCQkJUkJfQ0xFQVJfTk9ERShyYik7Cj4gKwo+ICsJCQlycS0+ZW5naW5lID0gZW5naW5lOwo+
ICsKPiArCQkJaWYgKGVuZ2luZSAhPSB2ZS0+c2libGluZ3NbMF0pIHsKPiArCQkJCXUzMiAqcmVn
cyA9IHZlLT5jb250ZXh0LmxyY19yZWdfc3RhdGU7Cj4gKwkJCQl1bnNpZ25lZCBpbnQgbjsKPiAr
Cj4gKwkJCQlHRU1fQlVHX09OKFJFQURfT05DRSh2ZS0+Y29udGV4dC5hY3RpdmUpKTsKPiArCQkJ
CXZpcnR1YWxfdXBkYXRlX3JlZ2lzdGVyX29mZnNldHMocmVncywgZW5naW5lKTsKPiArCj4gKwkJ
CQlpZiAoIWxpc3RfZW1wdHkoJnZlLT5jb250ZXh0LnNpZ25hbHMpKQo+ICsJCQkJCXZpcnR1YWxf
eGZlcl9icmVhZGNydW1icyh2ZSwgZW5naW5lKTsKPiArCj4gKwkJCQkvKgo+ICsJCQkJICogTW92
ZSB0aGUgYm91bmQgZW5naW5lIHRvIHRoZSB0b3Agb2YgdGhlIGxpc3QKPiArCQkJCSAqIGZvciBm
dXR1cmUgZXhlY3V0aW9uLiBXZSB0aGVuIGtpY2sgdGhpcwo+ICsJCQkJICogdGFza2xldCBmaXJz
dCBiZWZvcmUgY2hlY2tpbmcgb3RoZXJzLCBzbyB0aGF0Cj4gKwkJCQkgKiB3ZSBwcmVmZXJlbnRp
YWxseSByZXVzZSB0aGlzIHNldCBvZiBib3VuZAo+ICsJCQkJICogcmVnaXN0ZXJzLgo+ICsJCQkJ
ICovCj4gKwkJCQlmb3IgKG4gPSAxOyBuIDwgdmUtPm51bV9zaWJsaW5nczsgbisrKSB7Cj4gKwkJ
CQkJaWYgKHZlLT5zaWJsaW5nc1tuXSA9PSBlbmdpbmUpIHsKPiArCQkJCQkJc3dhcCh2ZS0+c2li
bGluZ3Nbbl0sCj4gKwkJCQkJCSAgICAgdmUtPnNpYmxpbmdzWzBdKTsKPiArCQkJCQkJYnJlYWs7
Cj4gKwkJCQkJfQo+ICsJCQkJfQo+ICsKPiArCQkJCUdFTV9CVUdfT04odmUtPnNpYmxpbmdzWzBd
ICE9IGVuZ2luZSk7Cj4gKwkJCX0KPiArCj4gKwkJCV9faTkxNV9yZXF1ZXN0X3N1Ym1pdChycSk7
Cj4gKwkJCXRyYWNlX2k5MTVfcmVxdWVzdF9pbihycSwgcG9ydF9pbmRleChwb3J0LCBleGVjbGlz
dHMpKTsKPiArCQkJc3VibWl0ID0gdHJ1ZTsKPiArCQkJbGFzdCA9IHJxOwo+ICsJCX0KPiArCj4g
KwkJc3Bpbl91bmxvY2soJnZlLT5iYXNlLnRpbWVsaW5lLmxvY2spOwo+ICsJCWJyZWFrOwo+ICsJ
fQo+ICsKPiAgIAl3aGlsZSAoKHJiID0gcmJfZmlyc3RfY2FjaGVkKCZleGVjbGlzdHMtPnF1ZXVl
KSkpIHsKPiAgIAkJc3RydWN0IGk5MTVfcHJpb2xpc3QgKnAgPSB0b19wcmlvbGlzdChyYik7Cj4g
ICAJCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCAqcm47Cj4gQEAgLTE4NzcsNiArMjE0MSwyNSBA
QCBzdGF0aWMgdm9pZCByZXNldF9jc2JfcG9pbnRlcnMoc3RydWN0IGludGVsX2VuZ2luZV9leGVj
bGlzdHMgKmV4ZWNsaXN0cykKPiAgIAkJCSAgICAgICAmZXhlY2xpc3RzLT5jc2Jfc3RhdHVzW3Jl
c2V0X3ZhbHVlXSk7Cj4gICB9Cj4gICAKPiArc3RhdGljIHN0cnVjdCBpOTE1X3JlcXVlc3QgKmFj
dGl2ZV9yZXF1ZXN0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQo+ICt7Cj4gKwljb25zdCBzdHJ1
Y3QgbGlzdF9oZWFkICogY29uc3QgbGlzdCA9ICZycS0+ZW5naW5lLT50aW1lbGluZS5yZXF1ZXN0
czsKPiArCWNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICogY29uc3QgY29udGV4dCA9IHJxLT5o
d19jb250ZXh0Owo+ICsJc3RydWN0IGk5MTVfcmVxdWVzdCAqYWN0aXZlID0gTlVMTDsKPiArCj4g
KwlsaXN0X2Zvcl9lYWNoX2VudHJ5X2Zyb21fcmV2ZXJzZShycSwgbGlzdCwgbGluaykgewo+ICsJ
CWlmIChpOTE1X3JlcXVlc3RfY29tcGxldGVkKHJxKSkKPiArCQkJYnJlYWs7Cj4gKwo+ICsJCWlm
IChycS0+aHdfY29udGV4dCAhPSBjb250ZXh0KQo+ICsJCQlicmVhazsKPiArCj4gKwkJYWN0aXZl
ID0gcnE7Cj4gKwl9Cj4gKwo+ICsJcmV0dXJuIGFjdGl2ZTsKPiArfQo+ICsKPiAgIHN0YXRpYyB2
b2lkIF9fZXhlY2xpc3RzX3Jlc2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgYm9v
bCBzdGFsbGVkKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3RzICogY29u
c3QgZXhlY2xpc3RzID0gJmVuZ2luZS0+ZXhlY2xpc3RzOwo+IEBAIC0xODk3LDcgKzIxODAsOCBA
QCBzdGF0aWMgdm9pZCBfX2V4ZWNsaXN0c19yZXNldChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUsIGJvb2wgc3RhbGxlZCkKPiAgIAlpZiAoIXBvcnRfaXNzZXQoZXhlY2xpc3RzLT5wb3J0
KSkKPiAgIAkJZ290byBvdXRfY2xlYXI7Cj4gICAKPiAtCWNlID0gcG9ydF9yZXF1ZXN0KGV4ZWNs
aXN0cy0+cG9ydCktPmh3X2NvbnRleHQ7Cj4gKwlycSA9IHBvcnRfcmVxdWVzdChleGVjbGlzdHMt
PnBvcnQpOwo+ICsJY2UgPSBycS0+aHdfY29udGV4dDsKPiAgIAo+ICAgCS8qCj4gICAJICogQ2F0
Y2ggdXAgd2l0aCBhbnkgbWlzc2VkIGNvbnRleHQtc3dpdGNoIGludGVycnVwdHMuCj4gQEAgLTE5
MTAsMTYgKzIxOTQsMTAgQEAgc3RhdGljIHZvaWQgX19leGVjbGlzdHNfcmVzZXQoc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lLCBib29sIHN0YWxsZWQpCj4gICAJICovCj4gICAJZXhlY2xp
c3RzX2NhbmNlbF9wb3J0X3JlcXVlc3RzKGV4ZWNsaXN0cyk7Cj4gICAKPiAtCS8qIFB1c2ggYmFj
ayBhbnkgaW5jb21wbGV0ZSByZXF1ZXN0cyBmb3IgcmVwbGF5IGFmdGVyIHRoZSByZXNldC4gKi8K
PiAtCXJxID0gX191bndpbmRfaW5jb21wbGV0ZV9yZXF1ZXN0cyhlbmdpbmUsIDApOwo+ICsJcnEg
PSBhY3RpdmVfcmVxdWVzdChycSk7Cj4gICAJaWYgKCFycSkKPiAgIAkJZ290byBvdXRfcmVwbGF5
Owo+ICAgCj4gLQlpZiAocnEtPmh3X2NvbnRleHQgIT0gY2UpIHsgLyogY2F1Z2h0IGp1c3QgYmVm
b3JlIGEgQ1MgZXZlbnQgKi8KPiAtCQlycSA9IE5VTEw7Cj4gLQkJZ290byBvdXRfcmVwbGF5Owo+
IC0JfQo+IC0KPiAgIAkvKgo+ICAgCSAqIElmIHRoaXMgcmVxdWVzdCBoYXNuJ3Qgc3RhcnRlZCB5
ZXQsIGUuZy4gaXQgaXMgd2FpdGluZyBvbiBhCj4gICAJICogc2VtYXBob3JlLCB3ZSBuZWVkIHRv
IGF2b2lkIHNraXBwaW5nIHRoZSByZXF1ZXN0IG9yIGVsc2Ugd2UKPiBAQCAtMTk2NiwxMyArMjI0
NCwxNiBAQCBzdGF0aWMgdm9pZCBfX2V4ZWNsaXN0c19yZXNldChzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUsIGJvb2wgc3RhbGxlZCkKPiAgIAl9Cj4gICAJZXhlY2xpc3RzX2luaXRfcmVn
X3N0YXRlKHJlZ3MsIGNlLCBlbmdpbmUsIGNlLT5yaW5nKTsKPiAgIAo+IC0JLyogUmVydW4gdGhl
IHJlcXVlc3Q7IGl0cyBwYXlsb2FkIGhhcyBiZWVuIG5ldXRlcmVkIChpZiBndWlsdHkpLiAqLwo+
ICAgb3V0X3JlcGxheToKPiArCS8qIFJlcnVuIHRoZSByZXF1ZXN0OyBpdHMgcGF5bG9hZCBoYXMg
YmVlbiBuZXV0ZXJlZCAoaWYgZ3VpbHR5KS4gKi8KPiAgIAljZS0+cmluZy0+aGVhZCA9Cj4gICAJ
CXJxID8gaW50ZWxfcmluZ193cmFwKGNlLT5yaW5nLCBycS0+aGVhZCkgOiBjZS0+cmluZy0+dGFp
bDsKPiAgIAlpbnRlbF9yaW5nX3VwZGF0ZV9zcGFjZShjZS0+cmluZyk7Cj4gICAJX19leGVjbGlz
dHNfdXBkYXRlX3JlZ19zdGF0ZShjZSwgZW5naW5lKTsKPiAgIAo+ICsJLyogUHVzaCBiYWNrIGFu
eSBpbmNvbXBsZXRlIHJlcXVlc3RzIGZvciByZXBsYXkgYWZ0ZXIgdGhlIHJlc2V0LiAqLwo+ICsJ
X191bndpbmRfaW5jb21wbGV0ZV9yZXF1ZXN0cyhlbmdpbmUsIDApOwo+ICsKPiAgIG91dF9jbGVh
cjoKPiAgIAlleGVjbGlzdHNfY2xlYXJfYWxsX2FjdGl2ZShleGVjbGlzdHMpOwo+ICAgfQo+IEBA
IC0yMDQ2LDYgKzIzMjcsMjYgQEAgc3RhdGljIHZvaWQgZXhlY2xpc3RzX2NhbmNlbF9yZXF1ZXN0
cyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gICAJCWk5MTVfcHJpb2xpc3RfZnJl
ZShwKTsKPiAgIAl9Cj4gICAKPiArCS8qIENhbmNlbCBhbGwgYXR0YWNoZWQgdmlydHVhbCBlbmdp
bmVzICovCj4gKwl3aGlsZSAoKHJiID0gcmJfZmlyc3RfY2FjaGVkKCZleGVjbGlzdHMtPnZpcnR1
YWwpKSkgewo+ICsJCXN0cnVjdCB2aXJ0dWFsX2VuZ2luZSAqdmUgPQo+ICsJCQlyYl9lbnRyeShy
YiwgdHlwZW9mKCp2ZSksIG5vZGVzW2VuZ2luZS0+aWRdLnJiKTsKPiArCj4gKwkJcmJfZXJhc2Vf
Y2FjaGVkKHJiLCAmZXhlY2xpc3RzLT52aXJ0dWFsKTsKPiArCQlSQl9DTEVBUl9OT0RFKHJiKTsK
PiArCj4gKwkJc3Bpbl9sb2NrKCZ2ZS0+YmFzZS50aW1lbGluZS5sb2NrKTsKPiArCQlpZiAodmUt
PnJlcXVlc3QpIHsKPiArCQkJdmUtPnJlcXVlc3QtPmVuZ2luZSA9IGVuZ2luZTsKPiArCQkJX19p
OTE1X3JlcXVlc3Rfc3VibWl0KHZlLT5yZXF1ZXN0KTsKPiArCQkJZG1hX2ZlbmNlX3NldF9lcnJv
cigmdmUtPnJlcXVlc3QtPmZlbmNlLCAtRUlPKTsKPiArCQkJaTkxNV9yZXF1ZXN0X21hcmtfY29t
cGxldGUodmUtPnJlcXVlc3QpOwo+ICsJCQl2ZS0+YmFzZS5leGVjbGlzdHMucXVldWVfcHJpb3Jp
dHlfaGludCA9IElOVF9NSU47Cj4gKwkJCXZlLT5yZXF1ZXN0ID0gTlVMTDsKPiArCQl9Cj4gKwkJ
c3Bpbl91bmxvY2soJnZlLT5iYXNlLnRpbWVsaW5lLmxvY2spOwo+ICsJfQo+ICsKPiAgIAkvKiBS
ZW1haW5pbmcgX3VucmVhZHlfIHJlcXVlc3RzIHdpbGwgYmUgbm9wJ2VkIHdoZW4gc3VibWl0dGVk
ICovCj4gICAKPiAgIAlleGVjbGlzdHMtPnF1ZXVlX3ByaW9yaXR5X2hpbnQgPSBJTlRfTUlOOwo+
IEBAIC0yNTI5LDEyICsyODMwLDE1IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19pbml0X3JlZ19z
dGF0ZSh1MzIgKnJlZ3MsCj4gICAJYm9vbCByY3MgPSBlbmdpbmUtPmNsYXNzID09IFJFTkRFUl9D
TEFTUzsKPiAgIAl1MzIgYmFzZSA9IGVuZ2luZS0+bW1pb19iYXNlOwo+ICAgCj4gLQkvKiBBIGNv
bnRleHQgaXMgYWN0dWFsbHkgYSBiaWcgYmF0Y2ggYnVmZmVyIHdpdGggc2V2ZXJhbAo+ICsJLyoK
PiArCSAqIEEgY29udGV4dCBpcyBhY3R1YWxseSBhIGJpZyBiYXRjaCBidWZmZXIgd2l0aCBzZXZl
cmFsCj4gICAJICogTUlfTE9BRF9SRUdJU1RFUl9JTU0gY29tbWFuZHMgZm9sbG93ZWQgYnkgKHJl
ZywgdmFsdWUpIHBhaXJzLiBUaGUKPiAgIAkgKiB2YWx1ZXMgd2UgYXJlIHNldHRpbmcgaGVyZSBh
cmUgb25seSBmb3IgdGhlIGZpcnN0IGNvbnRleHQgcmVzdG9yZToKPiAgIAkgKiBvbiBhIHN1YnNl
cXVlbnQgc2F2ZSwgdGhlIEdQVSB3aWxsIHJlY3JlYXRlIHRoaXMgYmF0Y2hidWZmZXIgd2l0aCBu
ZXcKPiAgIAkgKiB2YWx1ZXMgKGluY2x1ZGluZyBhbGwgdGhlIG1pc3NpbmcgTUlfTE9BRF9SRUdJ
U1RFUl9JTU0gY29tbWFuZHMgdGhhdAo+ICAgCSAqIHdlIGFyZSBub3QgaW5pdGlhbGl6aW5nIGhl
cmUpLgo+ICsJICoKPiArCSAqIE11c3Qga2VlcCBjb25zaXN0ZW50IHdpdGggdmlydHVhbF91cGRh
dGVfcmVnaXN0ZXJfb2Zmc2V0cygpLgo+ICAgCSAqLwo+ICAgCXJlZ3NbQ1RYX0xSSV9IRUFERVJf
MF0gPSBNSV9MT0FEX1JFR0lTVEVSX0lNTShyY3MgPyAxNCA6IDExKSB8Cj4gICAJCQkJIE1JX0xS
SV9GT1JDRV9QT1NURUQ7Cj4gQEAgLTI3NTMsNiArMzA1NywzMjAgQEAgc3RhdGljIGludCBleGVj
bGlzdHNfY29udGV4dF9kZWZlcnJlZF9hbGxvYyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCj4g
ICAJcmV0dXJuIHJldDsKPiAgIH0KPiAgIAo+ICtzdGF0aWMgdm9pZCB2aXJ0dWFsX2NvbnRleHRf
ZGVzdHJveShzdHJ1Y3Qga3JlZiAqa3JlZikKPiArewo+ICsJc3RydWN0IHZpcnR1YWxfZW5naW5l
ICp2ZSA9Cj4gKwkJY29udGFpbmVyX29mKGtyZWYsIHR5cGVvZigqdmUpLCBjb250ZXh0LnJlZik7
Cj4gKwl1bnNpZ25lZCBpbnQgbjsKPiArCj4gKwlHRU1fQlVHX09OKHZlLT5yZXF1ZXN0KTsKPiAr
CUdFTV9CVUdfT04odmUtPmNvbnRleHQuYWN0aXZlKTsKPiArCj4gKwlmb3IgKG4gPSAwOyBuIDwg
dmUtPm51bV9zaWJsaW5nczsgbisrKSB7Cj4gKwkJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqc2li
bGluZyA9IHZlLT5zaWJsaW5nc1tuXTsKPiArCQlzdHJ1Y3QgcmJfbm9kZSAqbm9kZSA9ICZ2ZS0+
bm9kZXNbc2libGluZy0+aWRdLnJiOwo+ICsKPiArCQlpZiAoUkJfRU1QVFlfTk9ERShub2RlKSkK
PiArCQkJY29udGludWU7Cj4gKwo+ICsJCXNwaW5fbG9ja19pcnEoJnNpYmxpbmctPnRpbWVsaW5l
LmxvY2spOwo+ICsKPiArCQkvKiBEZXRhY2htZW50IGlzIGxhemlseSBwZXJmb3JtZWQgaW4gdGhl
IGV4ZWNsaXN0cyB0YXNrbGV0ICovCj4gKwkJaWYgKCFSQl9FTVBUWV9OT0RFKG5vZGUpKQo+ICsJ
CQlyYl9lcmFzZV9jYWNoZWQobm9kZSwgJnNpYmxpbmctPmV4ZWNsaXN0cy52aXJ0dWFsKTsKPiAr
Cj4gKwkJc3Bpbl91bmxvY2tfaXJxKCZzaWJsaW5nLT50aW1lbGluZS5sb2NrKTsKPiArCX0KPiAr
CUdFTV9CVUdfT04oX190YXNrbGV0X2lzX3NjaGVkdWxlZCgmdmUtPmJhc2UuZXhlY2xpc3RzLnRh
c2tsZXQpKTsKPiArCj4gKwlpZiAodmUtPmNvbnRleHQuc3RhdGUpCj4gKwkJX19leGVjbGlzdHNf
Y29udGV4dF9maW5pKCZ2ZS0+Y29udGV4dCk7Cj4gKwo+ICsJaTkxNV90aW1lbGluZV9maW5pKCZ2
ZS0+YmFzZS50aW1lbGluZSk7Cj4gKwlrZnJlZSh2ZSk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lk
IHZpcnR1YWxfZW5naW5lX2luaXRpYWxfaGludChzdHJ1Y3QgdmlydHVhbF9lbmdpbmUgKnZlKQo+
ICt7Cj4gKwlpbnQgc3dwOwo+ICsKPiArCS8qCj4gKwkgKiBQaWNrIGEgcmFuZG9tIHNpYmxpbmcg
b24gc3RhcnRpbmcgdG8gaGVscCBzcHJlYWQgdGhlIGxvYWQgYXJvdW5kLgo+ICsJICoKPiArCSAq
IE5ldyBjb250ZXh0cyBhcmUgdHlwaWNhbGx5IGNyZWF0ZWQgd2l0aCBleGFjdGx5IHRoZSBzYW1l
IG9yZGVyCj4gKwkgKiBvZiBzaWJsaW5ncywgYW5kIG9mdGVuIHN0YXJ0ZWQgaW4gYmF0Y2hlcy4g
RHVlIHRvIHRoZSB3YXkgd2UgaXRlcmF0ZQo+ICsJICogdGhlIGFycmF5IG9mIHNpYmxpbmcgd2hl
biBzdWJtaXR0aW5nIHJlcXVlc3RzLCBzaWJsaW5nWzBdIGlzCj4gKwkgKiBwcmlvcml0aXNlZCBm
b3IgZGVxdWV1aW5nLiBJZiB3ZSBtYWtlIHN1cmUgdGhhdCBzaWJsaW5nWzBdIGlzIGZhaXJseQo+
ICsJICogcmFuZG9taXNlZCBhY3Jvc3MgdGhlIHN5c3RlbSwgd2UgYWxzbyBoZWxwIHNwcmVhZCB0
aGUgbG9hZCBieSB0aGUKPiArCSAqIGZpcnN0IGVuZ2luZSB3ZSBpbnNwZWN0IGJlaW5nIGRpZmZl
cmVudCBlYWNoIHRpbWUuCj4gKwkgKgo+ICsJICogTkIgVGhpcyBkb2VzIG5vdCBmb3JjZSB1cyB0
byBleGVjdXRlIG9uIHRoaXMgZW5naW5lLCBpdCB3aWxsIGp1c3QKPiArCSAqIHR5cGljYWxseSBi
ZSB0aGUgZmlyc3Qgd2UgaW5zcGVjdCBmb3Igc3VibWlzc2lvbi4KPiArCSAqLwo+ICsJc3dwID0g
cHJhbmRvbV91MzJfbWF4KHZlLT5udW1fc2libGluZ3MpOwo+ICsJaWYgKCFzd3ApCj4gKwkJcmV0
dXJuOwo+ICsKPiArCXN3YXAodmUtPnNpYmxpbmdzW3N3cF0sIHZlLT5zaWJsaW5nc1swXSk7Cj4g
Kwl2aXJ0dWFsX3VwZGF0ZV9yZWdpc3Rlcl9vZmZzZXRzKHZlLT5jb250ZXh0LmxyY19yZWdfc3Rh
dGUsCj4gKwkJCQkJdmUtPnNpYmxpbmdzWzBdKTsKPiArfQo+ICsKPiArc3RhdGljIGludCB2aXJ0
dWFsX2NvbnRleHRfcGluKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKPiArewo+ICsJc3RydWN0
IHZpcnR1YWxfZW5naW5lICp2ZSA9IGNvbnRhaW5lcl9vZihjZSwgdHlwZW9mKCp2ZSksIGNvbnRl
eHQpOwo+ICsJaW50IGVycjsKPiArCj4gKwkvKiBOb3RlOiB3ZSBtdXN0IHVzZSBhIHJlYWwgZW5n
aW5lIGNsYXNzIGZvciBzZXR0aW5nIHVwIHJlZyBzdGF0ZSAqLwo+ICsJZXJyID0gX19leGVjbGlz
dHNfY29udGV4dF9waW4oY2UsIHZlLT5zaWJsaW5nc1swXSk7Cj4gKwlpZiAoZXJyKQo+ICsJCXJl
dHVybiBlcnI7Cj4gKwo+ICsJdmlydHVhbF9lbmdpbmVfaW5pdGlhbF9oaW50KHZlKTsKPiArCXJl
dHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCB2aXJ0dWFsX2NvbnRleHRfZW50ZXIoc3Ry
dWN0IGludGVsX2NvbnRleHQgKmNlKQo+ICt7Cj4gKwlzdHJ1Y3QgdmlydHVhbF9lbmdpbmUgKnZl
ID0gY29udGFpbmVyX29mKGNlLCB0eXBlb2YoKnZlKSwgY29udGV4dCk7Cj4gKwl1bnNpZ25lZCBp
bnQgbjsKPiArCj4gKwlmb3IgKG4gPSAwOyBuIDwgdmUtPm51bV9zaWJsaW5nczsgbisrKQo+ICsJ
CWludGVsX2VuZ2luZV9wbV9nZXQodmUtPnNpYmxpbmdzW25dKTsKPiArfQo+ICsKPiArc3RhdGlj
IHZvaWQgdmlydHVhbF9jb250ZXh0X2V4aXQoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQo+ICt7
Cj4gKwlzdHJ1Y3QgdmlydHVhbF9lbmdpbmUgKnZlID0gY29udGFpbmVyX29mKGNlLCB0eXBlb2Yo
KnZlKSwgY29udGV4dCk7Cj4gKwl1bnNpZ25lZCBpbnQgbjsKPiArCj4gKwljZS0+c2F0dXJhdGVk
ID0gMDsKPiArCWZvciAobiA9IDA7IG4gPCB2ZS0+bnVtX3NpYmxpbmdzOyBuKyspCj4gKwkJaW50
ZWxfZW5naW5lX3BtX3B1dCh2ZS0+c2libGluZ3Nbbl0pOwo+ICt9Cj4gKwo+ICtzdGF0aWMgY29u
c3Qgc3RydWN0IGludGVsX2NvbnRleHRfb3BzIHZpcnR1YWxfY29udGV4dF9vcHMgPSB7Cj4gKwku
cGluID0gdmlydHVhbF9jb250ZXh0X3BpbiwKPiArCS51bnBpbiA9IGV4ZWNsaXN0c19jb250ZXh0
X3VucGluLAo+ICsKPiArCS5lbnRlciA9IHZpcnR1YWxfY29udGV4dF9lbnRlciwKPiArCS5leGl0
ID0gdmlydHVhbF9jb250ZXh0X2V4aXQsCj4gKwo+ICsJLmRlc3Ryb3kgPSB2aXJ0dWFsX2NvbnRl
eHRfZGVzdHJveSwKPiArfTsKPiArCj4gK3N0YXRpYyB2b2lkIHZpcnR1YWxfc3VibWlzc2lvbl90
YXNrbGV0KHVuc2lnbmVkIGxvbmcgZGF0YSkKPiArewo+ICsJc3RydWN0IHZpcnR1YWxfZW5naW5l
ICogY29uc3QgdmUgPSAoc3RydWN0IHZpcnR1YWxfZW5naW5lICopZGF0YTsKPiArCWNvbnN0IGlu
dCBwcmlvID0gdmUtPmJhc2UuZXhlY2xpc3RzLnF1ZXVlX3ByaW9yaXR5X2hpbnQ7Cj4gKwl1bnNp
Z25lZCBpbnQgbjsKPiArCj4gKwlsb2NhbF9pcnFfZGlzYWJsZSgpOwo+ICsJZm9yIChuID0gMDsg
UkVBRF9PTkNFKHZlLT5yZXF1ZXN0KSAmJiBuIDwgdmUtPm51bV9zaWJsaW5nczsgbisrKSB7Cj4g
KwkJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqc2libGluZyA9IHZlLT5zaWJsaW5nc1tuXTsKPiAr
CQlzdHJ1Y3QgdmVfbm9kZSAqIGNvbnN0IG5vZGUgPSAmdmUtPm5vZGVzW3NpYmxpbmctPmlkXTsK
PiArCQlzdHJ1Y3QgcmJfbm9kZSAqKnBhcmVudCwgKnJiOwo+ICsJCWJvb2wgZmlyc3Q7Cj4gKwo+
ICsJCXNwaW5fbG9jaygmc2libGluZy0+dGltZWxpbmUubG9jayk7Cj4gKwo+ICsJCWlmICghUkJf
RU1QVFlfTk9ERSgmbm9kZS0+cmIpKSB7Cj4gKwkJCS8qCj4gKwkJCSAqIENoZWF0IGFuZCBhdm9p
ZCByZWJhbGFuY2luZyB0aGUgdHJlZSBpZiB3ZSBjYW4KPiArCQkJICogcmV1c2UgdGhpcyBub2Rl
IGluIHNpdHUuCj4gKwkJCSAqLwo+ICsJCQlmaXJzdCA9IHJiX2ZpcnN0X2NhY2hlZCgmc2libGlu
Zy0+ZXhlY2xpc3RzLnZpcnR1YWwpID09Cj4gKwkJCQkmbm9kZS0+cmI7Cj4gKwkJCWlmIChwcmlv
ID09IG5vZGUtPnByaW8gfHwgKHByaW8gPiBub2RlLT5wcmlvICYmIGZpcnN0KSkKPiArCQkJCWdv
dG8gc3VibWl0X2VuZ2luZTsKPiArCj4gKwkJCXJiX2VyYXNlX2NhY2hlZCgmbm9kZS0+cmIsICZz
aWJsaW5nLT5leGVjbGlzdHMudmlydHVhbCk7Cj4gKwkJfQo+ICsKPiArCQlyYiA9IE5VTEw7Cj4g
KwkJZmlyc3QgPSB0cnVlOwo+ICsJCXBhcmVudCA9ICZzaWJsaW5nLT5leGVjbGlzdHMudmlydHVh
bC5yYl9yb290LnJiX25vZGU7Cj4gKwkJd2hpbGUgKCpwYXJlbnQpIHsKPiArCQkJc3RydWN0IHZl
X25vZGUgKm90aGVyOwo+ICsKPiArCQkJcmIgPSAqcGFyZW50Owo+ICsJCQlvdGhlciA9IHJiX2Vu
dHJ5KHJiLCB0eXBlb2YoKm90aGVyKSwgcmIpOwo+ICsJCQlpZiAocHJpbyA+IG90aGVyLT5wcmlv
KSB7Cj4gKwkJCQlwYXJlbnQgPSAmcmItPnJiX2xlZnQ7Cj4gKwkJCX0gZWxzZSB7Cj4gKwkJCQlw
YXJlbnQgPSAmcmItPnJiX3JpZ2h0Owo+ICsJCQkJZmlyc3QgPSBmYWxzZTsKPiArCQkJfQo+ICsJ
CX0KPiArCj4gKwkJcmJfbGlua19ub2RlKCZub2RlLT5yYiwgcmIsIHBhcmVudCk7Cj4gKwkJcmJf
aW5zZXJ0X2NvbG9yX2NhY2hlZCgmbm9kZS0+cmIsCj4gKwkJCQkgICAgICAgJnNpYmxpbmctPmV4
ZWNsaXN0cy52aXJ0dWFsLAo+ICsJCQkJICAgICAgIGZpcnN0KTsKPiArCj4gK3N1Ym1pdF9lbmdp
bmU6Cj4gKwkJR0VNX0JVR19PTihSQl9FTVBUWV9OT0RFKCZub2RlLT5yYikpOwo+ICsJCW5vZGUt
PnByaW8gPSBwcmlvOwo+ICsJCWlmIChmaXJzdCAmJiBwcmlvID4gc2libGluZy0+ZXhlY2xpc3Rz
LnF1ZXVlX3ByaW9yaXR5X2hpbnQpIHsKPiArCQkJc2libGluZy0+ZXhlY2xpc3RzLnF1ZXVlX3By
aW9yaXR5X2hpbnQgPSBwcmlvOwo+ICsJCQl0YXNrbGV0X2hpX3NjaGVkdWxlKCZzaWJsaW5nLT5l
eGVjbGlzdHMudGFza2xldCk7Cj4gKwkJfQo+ICsKPiArCQlzcGluX3VubG9jaygmc2libGluZy0+
dGltZWxpbmUubG9jayk7Cj4gKwl9Cj4gKwlsb2NhbF9pcnFfZW5hYmxlKCk7Cj4gK30KPiArCj4g
K3N0YXRpYyB2b2lkIHZpcnR1YWxfc3VibWl0X3JlcXVlc3Qoc3RydWN0IGk5MTVfcmVxdWVzdCAq
cnEpCj4gK3sKPiArCXN0cnVjdCB2aXJ0dWFsX2VuZ2luZSAqdmUgPSB0b192aXJ0dWFsX2VuZ2lu
ZShycS0+ZW5naW5lKTsKPiArCj4gKwlHRU1fVFJBQ0UoIiVzOiBycT0lbGx4OiVsbGRcbiIsCj4g
KwkJICB2ZS0+YmFzZS5uYW1lLAo+ICsJCSAgcnEtPmZlbmNlLmNvbnRleHQsCj4gKwkJICBycS0+
ZmVuY2Uuc2Vxbm8pOwo+ICsKPiArCUdFTV9CVUdfT04odmUtPmJhc2Uuc3VibWl0X3JlcXVlc3Qg
IT0gdmlydHVhbF9zdWJtaXRfcmVxdWVzdCk7Cj4gKwo+ICsJR0VNX0JVR19PTih2ZS0+cmVxdWVz
dCk7Cj4gKwl2ZS0+YmFzZS5leGVjbGlzdHMucXVldWVfcHJpb3JpdHlfaGludCA9IHJxX3ByaW8o
cnEpOwo+ICsJV1JJVEVfT05DRSh2ZS0+cmVxdWVzdCwgcnEpOwo+ICsKPiArCXRhc2tsZXRfc2No
ZWR1bGUoJnZlLT5iYXNlLmV4ZWNsaXN0cy50YXNrbGV0KTsKPiArfQo+ICsKPiArc3RydWN0IGlu
dGVsX2NvbnRleHQgKgo+ICtpbnRlbF9leGVjbGlzdHNfY3JlYXRlX3ZpcnR1YWwoc3RydWN0IGk5
MTVfZ2VtX2NvbnRleHQgKmN0eCwKPiArCQkJICAgICAgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KipzaWJsaW5ncywKPiArCQkJICAgICAgIHVuc2lnbmVkIGludCBjb3VudCkKPiArewo+ICsJc3Ry
dWN0IHZpcnR1YWxfZW5naW5lICp2ZTsKPiArCXVuc2lnbmVkIGludCBuOwo+ICsJaW50IGVycjsK
PiArCj4gKwlpZiAoY291bnQgPT0gMCkKPiArCQlyZXR1cm4gRVJSX1BUUigtRUlOVkFMKTsKPiAr
Cj4gKwlpZiAoY291bnQgPT0gMSkKPiArCQlyZXR1cm4gaW50ZWxfY29udGV4dF9jcmVhdGUoY3R4
LCBzaWJsaW5nc1swXSk7Cj4gKwo+ICsJdmUgPSBremFsbG9jKHN0cnVjdF9zaXplKHZlLCBzaWJs
aW5ncywgY291bnQpLCBHRlBfS0VSTkVMKTsKPiArCWlmICghdmUpCj4gKwkJcmV0dXJuIEVSUl9Q
VFIoLUVOT01FTSk7Cj4gKwo+ICsJdmUtPmJhc2UuaTkxNSA9IGN0eC0+aTkxNTsKPiArCXZlLT5i
YXNlLmlkID0gLTE7Cj4gKwl2ZS0+YmFzZS5jbGFzcyA9IE9USEVSX0NMQVNTOwo+ICsJdmUtPmJh
c2UudWFiaV9jbGFzcyA9IEk5MTVfRU5HSU5FX0NMQVNTX0lOVkFMSUQ7Cj4gKwl2ZS0+YmFzZS5p
bnN0YW5jZSA9IEk5MTVfRU5HSU5FX0NMQVNTX0lOVkFMSURfVklSVFVBTDsKPiArCXZlLT5iYXNl
LmZsYWdzID0gSTkxNV9FTkdJTkVfSVNfVklSVFVBTDsKPiArCj4gKwlzbnByaW50Zih2ZS0+YmFz
ZS5uYW1lLCBzaXplb2YodmUtPmJhc2UubmFtZSksICJ2aXJ0dWFsIik7Cj4gKwo+ICsJZXJyID0g
aTkxNV90aW1lbGluZV9pbml0KGN0eC0+aTkxNSwgJnZlLT5iYXNlLnRpbWVsaW5lLCBOVUxMKTsK
PiArCWlmIChlcnIpCj4gKwkJZ290byBlcnJfcHV0Owo+ICsJaTkxNV90aW1lbGluZV9zZXRfc3Vi
Y2xhc3MoJnZlLT5iYXNlLnRpbWVsaW5lLCBUSU1FTElORV9WSVJUVUFMKTsKPiArCj4gKwlpbnRl
bF9lbmdpbmVfaW5pdF9leGVjbGlzdHMoJnZlLT5iYXNlKTsKPiArCj4gKwl2ZS0+YmFzZS5jb3Bz
ID0gJnZpcnR1YWxfY29udGV4dF9vcHM7Cj4gKwl2ZS0+YmFzZS5yZXF1ZXN0X2FsbG9jID0gZXhl
Y2xpc3RzX3JlcXVlc3RfYWxsb2M7Cj4gKwo+ICsJdmUtPmJhc2Uuc2NoZWR1bGUgPSBpOTE1X3Nj
aGVkdWxlOwo+ICsJdmUtPmJhc2Uuc3VibWl0X3JlcXVlc3QgPSB2aXJ0dWFsX3N1Ym1pdF9yZXF1
ZXN0Owo+ICsKPiArCXZlLT5iYXNlLmV4ZWNsaXN0cy5xdWV1ZV9wcmlvcml0eV9oaW50ID0gSU5U
X01JTjsKPiArCXRhc2tsZXRfaW5pdCgmdmUtPmJhc2UuZXhlY2xpc3RzLnRhc2tsZXQsCj4gKwkJ
ICAgICB2aXJ0dWFsX3N1Ym1pc3Npb25fdGFza2xldCwKPiArCQkgICAgICh1bnNpZ25lZCBsb25n
KXZlKTsKPiArCj4gKwlpbnRlbF9jb250ZXh0X2luaXQoJnZlLT5jb250ZXh0LCBjdHgsICZ2ZS0+
YmFzZSk7Cj4gKwo+ICsJZm9yIChuID0gMDsgbiA8IGNvdW50OyBuKyspIHsKPiArCQlzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICpzaWJsaW5nID0gc2libGluZ3Nbbl07Cj4gKwo+ICsJCUdFTV9CVUdf
T04oIWlzX3Bvd2VyX29mXzIoc2libGluZy0+bWFzaykpOwo+ICsJCWlmIChzaWJsaW5nLT5tYXNr
ICYgdmUtPmJhc2UubWFzaykgewo+ICsJCQlEUk1fREVCVUcoImR1cGxpY2F0ZSAlcyBlbnRyeSBp
biBsb2FkIGJhbGFuY2VyXG4iLAo+ICsJCQkJICBzaWJsaW5nLT5uYW1lKTsKPiArCQkJZXJyID0g
LUVJTlZBTDsKPiArCQkJZ290byBlcnJfcHV0Owo+ICsJCX0KPiArCj4gKwkJLyoKPiArCQkgKiBU
aGUgdmlydHVhbCBlbmdpbmUgaW1wbGVtZW50YXRpb24gaXMgdGlnaHRseSBjb3VwbGVkIHRvCj4g
KwkJICogdGhlIGV4ZWNsaXN0cyBiYWNrZW5kIC0tIHdlIHB1c2ggb3V0IHJlcXVlc3QgZGlyZWN0
bHkKPiArCQkgKiBpbnRvIGEgdHJlZSBpbnNpZGUgZWFjaCBwaHlzaWNhbCBlbmdpbmUuIFdlIGNv
dWxkIHN1cHBvcnQKPiArCQkgKiBsYXllcmluZyBpZiB3ZSBoYW5kbGUgY2xvbmluZyBvZiB0aGUg
cmVxdWVzdHMgYW5kCj4gKwkJICogc3VibWl0dGluZyBhIGNvcHkgaW50byBlYWNoIGJhY2tlbmQu
Cj4gKwkJICovCj4gKwkJaWYgKHNpYmxpbmctPmV4ZWNsaXN0cy50YXNrbGV0LmZ1bmMgIT0KPiAr
CQkgICAgZXhlY2xpc3RzX3N1Ym1pc3Npb25fdGFza2xldCkgewo+ICsJCQllcnIgPSAtRU5PREVW
Owo+ICsJCQlnb3RvIGVycl9wdXQ7Cj4gKwkJfQo+ICsKPiArCQlHRU1fQlVHX09OKFJCX0VNUFRZ
X05PREUoJnZlLT5ub2Rlc1tzaWJsaW5nLT5pZF0ucmIpKTsKPiArCQlSQl9DTEVBUl9OT0RFKCZ2
ZS0+bm9kZXNbc2libGluZy0+aWRdLnJiKTsKPiArCj4gKwkJdmUtPnNpYmxpbmdzW3ZlLT5udW1f
c2libGluZ3MrK10gPSBzaWJsaW5nOwo+ICsJCXZlLT5iYXNlLm1hc2sgfD0gc2libGluZy0+bWFz
azsKPiArCj4gKwkJLyoKPiArCQkgKiBBbGwgcGh5c2ljYWwgZW5naW5lcyBtdXN0IGJlIGNvbXBh
dGlibGUgZm9yIHRoZWlyIGVtaXNzaW9uCj4gKwkJICogZnVuY3Rpb25zIChhcyB3ZSBidWlsZCB0
aGUgaW5zdHJ1Y3Rpb25zIGR1cmluZyByZXF1ZXN0Cj4gKwkJICogY29uc3RydWN0aW9uIGFuZCBk
byBub3QgYWx0ZXIgdGhlbSBiZWZvcmUgc3VibWlzc2lvbgo+ICsJCSAqIG9uIHRoZSBwaHlzaWNh
bCBlbmdpbmUpLiBXZSB1c2UgdGhlIGVuZ2luZSBjbGFzcyBhcyBhIGd1aWRlCj4gKwkJICogaGVy
ZSwgYWx0aG91Z2ggdGhhdCBjb3VsZCBiZSByZWZpbmVkLgo+ICsJCSAqLwo+ICsJCWlmICh2ZS0+
YmFzZS5jbGFzcyAhPSBPVEhFUl9DTEFTUykgewo+ICsJCQlpZiAodmUtPmJhc2UuY2xhc3MgIT0g
c2libGluZy0+Y2xhc3MpIHsKPiArCQkJCURSTV9ERUJVRygiaW52YWxpZCBtaXhpbmcgb2YgZW5n
aW5lIGNsYXNzLCBzaWJsaW5nICVkLCBhbHJlYWR5ICVkXG4iLAo+ICsJCQkJCSAgc2libGluZy0+
Y2xhc3MsIHZlLT5iYXNlLmNsYXNzKTsKPiArCQkJCWVyciA9IC1FSU5WQUw7Cj4gKwkJCQlnb3Rv
IGVycl9wdXQ7Cj4gKwkJCX0KPiArCQkJY29udGludWU7Cj4gKwkJfQo+ICsKPiArCQl2ZS0+YmFz
ZS5jbGFzcyA9IHNpYmxpbmctPmNsYXNzOwo+ICsJCXZlLT5iYXNlLnVhYmlfY2xhc3MgPSBzaWJs
aW5nLT51YWJpX2NsYXNzOwo+ICsJCXNucHJpbnRmKHZlLT5iYXNlLm5hbWUsIHNpemVvZih2ZS0+
YmFzZS5uYW1lKSwKPiArCQkJICJ2JWR4JWQiLCB2ZS0+YmFzZS5jbGFzcywgY291bnQpOwo+ICsJ
CXZlLT5iYXNlLmNvbnRleHRfc2l6ZSA9IHNpYmxpbmctPmNvbnRleHRfc2l6ZTsKPiArCj4gKwkJ
dmUtPmJhc2UuZW1pdF9iYl9zdGFydCA9IHNpYmxpbmctPmVtaXRfYmJfc3RhcnQ7Cj4gKwkJdmUt
PmJhc2UuZW1pdF9mbHVzaCA9IHNpYmxpbmctPmVtaXRfZmx1c2g7Cj4gKwkJdmUtPmJhc2UuZW1p
dF9pbml0X2JyZWFkY3J1bWIgPSBzaWJsaW5nLT5lbWl0X2luaXRfYnJlYWRjcnVtYjsKPiArCQl2
ZS0+YmFzZS5lbWl0X2ZpbmlfYnJlYWRjcnVtYiA9IHNpYmxpbmctPmVtaXRfZmluaV9icmVhZGNy
dW1iOwo+ICsJCXZlLT5iYXNlLmVtaXRfZmluaV9icmVhZGNydW1iX2R3ID0KPiArCQkJc2libGlu
Zy0+ZW1pdF9maW5pX2JyZWFkY3J1bWJfZHc7Cj4gKwl9Cj4gKwo+ICsJcmV0dXJuICZ2ZS0+Y29u
dGV4dDsKPiArCj4gK2Vycl9wdXQ6Cj4gKwlpbnRlbF9jb250ZXh0X3B1dCgmdmUtPmNvbnRleHQp
Owo+ICsJcmV0dXJuIEVSUl9QVFIoZXJyKTsKPiArfQo+ICsKPiArc3RydWN0IGludGVsX2NvbnRl
eHQgKgo+ICtpbnRlbF9leGVjbGlzdHNfY2xvbmVfdmlydHVhbChzdHJ1Y3QgaTkxNV9nZW1fY29u
dGV4dCAqY3R4LAo+ICsJCQkgICAgICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpzcmMpCj4gK3sK
PiArCXN0cnVjdCB2aXJ0dWFsX2VuZ2luZSAqc2UgPSB0b192aXJ0dWFsX2VuZ2luZShzcmMpOwo+
ICsJc3RydWN0IGludGVsX2NvbnRleHQgKmRzdDsKPiArCj4gKwlkc3QgPSBpbnRlbF9leGVjbGlz
dHNfY3JlYXRlX3ZpcnR1YWwoY3R4LAo+ICsJCQkJCSAgICAgc2UtPnNpYmxpbmdzLAo+ICsJCQkJ
CSAgICAgc2UtPm51bV9zaWJsaW5ncyk7Cj4gKwlpZiAoSVNfRVJSKGRzdCkpCj4gKwkJcmV0dXJu
IGRzdDsKPiArCj4gKwlyZXR1cm4gZHN0Owo+ICt9Cj4gKwo+ICAgdm9pZCBpbnRlbF9leGVjbGlz
dHNfc2hvd19yZXF1ZXN0cyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCj4gICAJCQkJ
ICAgc3RydWN0IGRybV9wcmludGVyICptLAo+ICAgCQkJCSAgIHZvaWQgKCpzaG93X3JlcXVlc3Qp
KHN0cnVjdCBkcm1fcHJpbnRlciAqbSwKPiBAQCAtMjgxMCw2ICszNDI4LDI5IEBAIHZvaWQgaW50
ZWxfZXhlY2xpc3RzX3Nob3dfcmVxdWVzdHMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
LAo+ICAgCQlzaG93X3JlcXVlc3QobSwgbGFzdCwgIlx0XHRRICIpOwo+ICAgCX0KPiAgIAo+ICsJ
bGFzdCA9IE5VTEw7Cj4gKwljb3VudCA9IDA7Cj4gKwlmb3IgKHJiID0gcmJfZmlyc3RfY2FjaGVk
KCZleGVjbGlzdHMtPnZpcnR1YWwpOyByYjsgcmIgPSByYl9uZXh0KHJiKSkgewo+ICsJCXN0cnVj
dCB2aXJ0dWFsX2VuZ2luZSAqdmUgPQo+ICsJCQlyYl9lbnRyeShyYiwgdHlwZW9mKCp2ZSksIG5v
ZGVzW2VuZ2luZS0+aWRdLnJiKTsKPiArCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSA9IFJFQURf
T05DRSh2ZS0+cmVxdWVzdCk7Cj4gKwo+ICsJCWlmIChycSkgewo+ICsJCQlpZiAoY291bnQrKyA8
IG1heCAtIDEpCj4gKwkJCQlzaG93X3JlcXVlc3QobSwgcnEsICJcdFx0ViAiKTsKPiArCQkJZWxz
ZQo+ICsJCQkJbGFzdCA9IHJxOwo+ICsJCX0KPiArCX0KPiArCWlmIChsYXN0KSB7Cj4gKwkJaWYg
KGNvdW50ID4gbWF4KSB7Cj4gKwkJCWRybV9wcmludGYobSwKPiArCQkJCSAgICJcdFx0Li4uc2tp
cHBpbmcgJWQgdmlydHVhbCByZXF1ZXN0cy4uLlxuIiwKPiArCQkJCSAgIGNvdW50IC0gbWF4KTsK
PiArCQl9Cj4gKwkJc2hvd19yZXF1ZXN0KG0sIGxhc3QsICJcdFx0ViAiKTsKPiArCX0KPiArCj4g
ICAJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZW5naW5lLT50aW1lbGluZS5sb2NrLCBmbGFncyk7
Cj4gICB9Cj4gICAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
bHJjLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuaAo+IGluZGV4IGEwZGM5
MDdhNzI0OS4uNTUzMDYwNjA1MmU1IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2xyYy5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJj
LmgKPiBAQCAtMTE0LDQgKzExNCwxMyBAQCB2b2lkIGludGVsX2V4ZWNsaXN0c19zaG93X3JlcXVl
c3RzKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKPiAgIAkJCQkJCQljb25zdCBjaGFy
ICpwcmVmaXgpLAo+ICAgCQkJCSAgIHVuc2lnbmVkIGludCBtYXgpOwo+ICAgCj4gK3N0cnVjdCBp
bnRlbF9jb250ZXh0ICoKPiAraW50ZWxfZXhlY2xpc3RzX2NyZWF0ZV92aXJ0dWFsKHN0cnVjdCBp
OTE1X2dlbV9jb250ZXh0ICpjdHgsCj4gKwkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICoqc2libGluZ3MsCj4gKwkJCSAgICAgICB1bnNpZ25lZCBpbnQgY291bnQpOwo+ICsKPiArc3Ry
dWN0IGludGVsX2NvbnRleHQgKgo+ICtpbnRlbF9leGVjbGlzdHNfY2xvbmVfdmlydHVhbChzdHJ1
Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAo+ICsJCQkgICAgICBzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICpzcmMpOwo+ICsKPiAgICNlbmRpZiAvKiBfSU5URUxfTFJDX0hfICovCj4gZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKPiBpbmRleCA1YjNkOGUzM2YxY2YuLmY4ODAyNzFm
YjliYSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMu
Ywo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCj4gQEAgLTEz
MTAsNiArMTMxMCwxODUgQEAgc3RhdGljIGludCBsaXZlX3ByZWVtcHRfc21va2Uodm9pZCAqYXJn
KQo+ICAgCXJldHVybiBlcnI7Cj4gICB9Cj4gICAKPiArc3RhdGljIGludCBub3BfdmlydHVhbF9l
bmdpbmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gKwkJCSAgICAgIHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKipzaWJsaW5ncywKPiArCQkJICAgICAgdW5zaWduZWQgaW50IG5zaWJs
aW5nLAo+ICsJCQkgICAgICB1bnNpZ25lZCBpbnQgbmN0eCwKPiArCQkJICAgICAgdW5zaWduZWQg
aW50IGZsYWdzKQo+ICsjZGVmaW5lIENIQUlOIEJJVCgwKQo+ICt7Cj4gKwlJR1RfVElNRU9VVChl
bmRfdGltZSk7Cj4gKwlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0WzE2XTsKPiArCXN0cnVj
dCBpOTE1X2dlbV9jb250ZXh0ICpjdHhbMTZdOwo+ICsJc3RydWN0IGludGVsX2NvbnRleHQgKnZl
WzE2XTsKPiArCXVuc2lnbmVkIGxvbmcgbiwgcHJpbWUsIG5jOwo+ICsJc3RydWN0IGlndF9saXZl
X3Rlc3QgdDsKPiArCWt0aW1lX3QgdGltZXNbMl0gPSB7fTsKPiArCWludCBlcnI7Cj4gKwo+ICsJ
R0VNX0JVR19PTighbmN0eCB8fCBuY3R4ID4gQVJSQVlfU0laRShjdHgpKTsKPiArCj4gKwlmb3Ig
KG4gPSAwOyBuIDwgbmN0eDsgbisrKSB7Cj4gKwkJY3R4W25dID0ga2VybmVsX2NvbnRleHQoaTkx
NSk7Cj4gKwkJaWYgKCFjdHhbbl0pIHsKPiArCQkJZXJyID0gLUVOT01FTTsKPiArCQkJbmN0eCA9
IG47Cj4gKwkJCWdvdG8gb3V0Owo+ICsJCX0KPiArCj4gKwkJdmVbbl0gPSBpbnRlbF9leGVjbGlz
dHNfY3JlYXRlX3ZpcnR1YWwoY3R4W25dLAo+ICsJCQkJCQkgICAgICAgc2libGluZ3MsIG5zaWJs
aW5nKTsKPiArCQlpZiAoSVNfRVJSKHZlW25dKSkgewo+ICsJCQlrZXJuZWxfY29udGV4dF9jbG9z
ZShjdHhbbl0pOwo+ICsJCQllcnIgPSBQVFJfRVJSKHZlW25dKTsKPiArCQkJbmN0eCA9IG47Cj4g
KwkJCWdvdG8gb3V0Owo+ICsJCX0KPiArCj4gKwkJZXJyID0gaW50ZWxfY29udGV4dF9waW4odmVb
bl0pOwo+ICsJCWlmIChlcnIpIHsKPiArCQkJaW50ZWxfY29udGV4dF9wdXQodmVbbl0pOwo+ICsJ
CQlrZXJuZWxfY29udGV4dF9jbG9zZShjdHhbbl0pOwo+ICsJCQluY3R4ID0gbjsKPiArCQkJZ290
byBvdXQ7Cj4gKwkJfQo+ICsJfQo+ICsKPiArCWVyciA9IGlndF9saXZlX3Rlc3RfYmVnaW4oJnQs
IGk5MTUsIF9fZnVuY19fLCB2ZVswXS0+ZW5naW5lLT5uYW1lKTsKPiArCWlmIChlcnIpCj4gKwkJ
Z290byBvdXQ7Cj4gKwo+ICsJZm9yX2VhY2hfcHJpbWVfbnVtYmVyX2Zyb20ocHJpbWUsIDEsIDgx
OTIpIHsKPiArCQl0aW1lc1sxXSA9IGt0aW1lX2dldF9yYXcoKTsKPiArCj4gKwkJaWYgKGZsYWdz
ICYgQ0hBSU4pIHsKPiArCQkJZm9yIChuYyA9IDA7IG5jIDwgbmN0eDsgbmMrKykgewo+ICsJCQkJ
Zm9yIChuID0gMDsgbiA8IHByaW1lOyBuKyspIHsKPiArCQkJCQlyZXF1ZXN0W25jXSA9Cj4gKwkJ
CQkJCWk5MTVfcmVxdWVzdF9jcmVhdGUodmVbbmNdKTsKPiArCQkJCQlpZiAoSVNfRVJSKHJlcXVl
c3RbbmNdKSkgewo+ICsJCQkJCQllcnIgPSBQVFJfRVJSKHJlcXVlc3RbbmNdKTsKPiArCQkJCQkJ
Z290byBvdXQ7Cj4gKwkJCQkJfQo+ICsKPiArCQkJCQlpOTE1X3JlcXVlc3RfYWRkKHJlcXVlc3Rb
bmNdKTsKPiArCQkJCX0KPiArCQkJfQo+ICsJCX0gZWxzZSB7Cj4gKwkJCWZvciAobiA9IDA7IG4g
PCBwcmltZTsgbisrKSB7Cj4gKwkJCQlmb3IgKG5jID0gMDsgbmMgPCBuY3R4OyBuYysrKSB7Cj4g
KwkJCQkJcmVxdWVzdFtuY10gPQo+ICsJCQkJCQlpOTE1X3JlcXVlc3RfY3JlYXRlKHZlW25jXSk7
Cj4gKwkJCQkJaWYgKElTX0VSUihyZXF1ZXN0W25jXSkpIHsKPiArCQkJCQkJZXJyID0gUFRSX0VS
UihyZXF1ZXN0W25jXSk7Cj4gKwkJCQkJCWdvdG8gb3V0Owo+ICsJCQkJCX0KPiArCj4gKwkJCQkJ
aTkxNV9yZXF1ZXN0X2FkZChyZXF1ZXN0W25jXSk7Cj4gKwkJCQl9Cj4gKwkJCX0KPiArCQl9Cj4g
Kwo+ICsJCWZvciAobmMgPSAwOyBuYyA8IG5jdHg7IG5jKyspIHsKPiArCQkJaWYgKGk5MTVfcmVx
dWVzdF93YWl0KHJlcXVlc3RbbmNdLAo+ICsJCQkJCSAgICAgIEk5MTVfV0FJVF9MT0NLRUQsCj4g
KwkJCQkJICAgICAgSFogLyAxMCkgPCAwKSB7Cj4gKwkJCQlwcl9lcnIoIiVzKCVzKTogd2FpdCBm
b3IgJWxseDolbGxkIHRpbWVkIG91dFxuIiwKPiArCQkJCSAgICAgICBfX2Z1bmNfXywgdmVbMF0t
PmVuZ2luZS0+bmFtZSwKPiArCQkJCSAgICAgICByZXF1ZXN0W25jXS0+ZmVuY2UuY29udGV4dCwK
PiArCQkJCSAgICAgICByZXF1ZXN0W25jXS0+ZmVuY2Uuc2Vxbm8pOwo+ICsKPiArCQkJCUdFTV9U
UkFDRSgiJXMoJXMpIGZhaWxlZCBhdCByZXF1ZXN0ICVsbHg6JWxsZFxuIiwKPiArCQkJCQkgIF9f
ZnVuY19fLCB2ZVswXS0+ZW5naW5lLT5uYW1lLAo+ICsJCQkJCSAgcmVxdWVzdFtuY10tPmZlbmNl
LmNvbnRleHQsCj4gKwkJCQkJICByZXF1ZXN0W25jXS0+ZmVuY2Uuc2Vxbm8pOwo+ICsJCQkJR0VN
X1RSQUNFX0RVTVAoKTsKPiArCQkJCWk5MTVfZ2VtX3NldF93ZWRnZWQoaTkxNSk7Cj4gKwkJCQli
cmVhazsKPiArCQkJfQo+ICsJCX0KPiArCj4gKwkJdGltZXNbMV0gPSBrdGltZV9zdWIoa3RpbWVf
Z2V0X3JhdygpLCB0aW1lc1sxXSk7Cj4gKwkJaWYgKHByaW1lID09IDEpCj4gKwkJCXRpbWVzWzBd
ID0gdGltZXNbMV07Cj4gKwo+ICsJCWlmIChfX2lndF90aW1lb3V0KGVuZF90aW1lLCBOVUxMKSkK
PiArCQkJYnJlYWs7Cj4gKwl9Cj4gKwo+ICsJZXJyID0gaWd0X2xpdmVfdGVzdF9lbmQoJnQpOwo+
ICsJaWYgKGVycikKPiArCQlnb3RvIG91dDsKPiArCj4gKwlwcl9pbmZvKCJSZXF1ZXN0eCVkIGxh
dGVuY2llcyBvbiAlczogMSA9ICVsbHVucywgJWx1ID0gJWxsdW5zXG4iLAo+ICsJCW5jdHgsIHZl
WzBdLT5lbmdpbmUtPm5hbWUsIGt0aW1lX3RvX25zKHRpbWVzWzBdKSwKPiArCQlwcmltZSwgZGl2
NjRfdTY0KGt0aW1lX3RvX25zKHRpbWVzWzFdKSwgcHJpbWUpKTsKPiArCj4gK291dDoKPiArCWlm
IChpZ3RfZmx1c2hfdGVzdChpOTE1LCBJOTE1X1dBSVRfTE9DS0VEKSkKPiArCQllcnIgPSAtRUlP
Owo+ICsKPiArCWZvciAobmMgPSAwOyBuYyA8IG5jdHg7IG5jKyspIHsKPiArCQlpbnRlbF9jb250
ZXh0X3VucGluKHZlW25jXSk7Cj4gKwkJaW50ZWxfY29udGV4dF9wdXQodmVbbmNdKTsKPiArCQlr
ZXJuZWxfY29udGV4dF9jbG9zZShjdHhbbmNdKTsKPiArCX0KPiArCXJldHVybiBlcnI7Cj4gK30K
PiArCj4gK3N0YXRpYyBpbnQgbGl2ZV92aXJ0dWFsX2VuZ2luZSh2b2lkICphcmcpCj4gK3sKPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYXJnOwo+ICsJc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqc2libGluZ3NbTUFYX0VOR0lORV9JTlNUQU5DRSArIDFdOwo+ICsJc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lOwo+ICsJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Cj4gKwl1
bnNpZ25lZCBpbnQgY2xhc3MsIGluc3Q7Cj4gKwlpbnQgZXJyID0gLUVOT0RFVjsKPiArCj4gKwlp
ZiAoVVNFU19HVUNfU1VCTUlTU0lPTihpOTE1KSkKPiArCQlyZXR1cm4gMDsKPiArCj4gKwltdXRl
eF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiArCj4gKwlmb3JfZWFjaF9lbmdpbmUo
ZW5naW5lLCBpOTE1LCBpZCkgewo+ICsJCWVyciA9IG5vcF92aXJ0dWFsX2VuZ2luZShpOTE1LCAm
ZW5naW5lLCAxLCAxLCAwKTsKPiArCQlpZiAoZXJyKSB7Cj4gKwkJCXByX2VycigiRmFpbGVkIHRv
IHdyYXAgZW5naW5lICVzOiBlcnI9JWRcbiIsCj4gKwkJCSAgICAgICBlbmdpbmUtPm5hbWUsIGVy
cik7Cj4gKwkJCWdvdG8gb3V0X3VubG9jazsKPiArCQl9Cj4gKwl9Cj4gKwo+ICsJZm9yIChjbGFz
cyA9IDA7IGNsYXNzIDw9IE1BWF9FTkdJTkVfQ0xBU1M7IGNsYXNzKyspIHsKPiArCQlpbnQgbnNp
YmxpbmcsIG47Cj4gKwo+ICsJCW5zaWJsaW5nID0gMDsKPiArCQlmb3IgKGluc3QgPSAwOyBpbnN0
IDw9IE1BWF9FTkdJTkVfSU5TVEFOQ0U7IGluc3QrKykgewo+ICsJCQlpZiAoIWk5MTUtPmVuZ2lu
ZV9jbGFzc1tjbGFzc11baW5zdF0pCj4gKwkJCQljb250aW51ZTsKPiArCj4gKwkJCXNpYmxpbmdz
W25zaWJsaW5nKytdID0gaTkxNS0+ZW5naW5lX2NsYXNzW2NsYXNzXVtpbnN0XTsKPiArCQl9Cj4g
KwkJaWYgKG5zaWJsaW5nIDwgMikKPiArCQkJY29udGludWU7Cj4gKwo+ICsJCWZvciAobiA9IDE7
IG4gPD0gbnNpYmxpbmcgKyAxOyBuKyspIHsKPiArCQkJZXJyID0gbm9wX3ZpcnR1YWxfZW5naW5l
KGk5MTUsIHNpYmxpbmdzLCBuc2libGluZywKPiArCQkJCQkJIG4sIDApOwo+ICsJCQlpZiAoZXJy
KQo+ICsJCQkJZ290byBvdXRfdW5sb2NrOwo+ICsJCX0KPiArCj4gKwkJZXJyID0gbm9wX3ZpcnR1
YWxfZW5naW5lKGk5MTUsIHNpYmxpbmdzLCBuc2libGluZywgbiwgQ0hBSU4pOwo+ICsJCWlmIChl
cnIpCj4gKwkJCWdvdG8gb3V0X3VubG9jazsKPiArCX0KPiArCj4gK291dF91bmxvY2s6Cj4gKwlt
dXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJcmV0dXJuIGVycjsKPiAr
fQo+ICsKPiAgIGludCBpbnRlbF9leGVjbGlzdHNfbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gICB7Cj4gICAJc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3N1
YnRlc3QgdGVzdHNbXSA9IHsKPiBAQCAtMTMyMiw2ICsxNTAxLDcgQEAgaW50IGludGVsX2V4ZWNs
aXN0c19saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIAkJ
U1VCVEVTVChsaXZlX2NoYWluX3ByZWVtcHQpLAo+ICAgCQlTVUJURVNUKGxpdmVfcHJlZW1wdF9o
YW5nKSwKPiAgIAkJU1VCVEVTVChsaXZlX3ByZWVtcHRfc21va2UpLAo+ICsJCVNVQlRFU1QobGl2
ZV92aXJ0dWFsX2VuZ2luZSksCj4gICAJfTsKPiAgIAo+ICAgCWlmICghSEFTX0VYRUNMSVNUUyhp
OTE1KSkKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uaCBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmgKPiBpbmRleCA2N2Y4YTRhODA3YTAuLmZlODJk
MzU3MTA3MiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5oCj4g
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uaAo+IEBAIC05MSw0ICs5MSw5IEBA
IHN0YXRpYyBpbmxpbmUgYm9vbCBfX3Rhc2tsZXRfZW5hYmxlKHN0cnVjdCB0YXNrbGV0X3N0cnVj
dCAqdCkKPiAgIAlyZXR1cm4gYXRvbWljX2RlY19hbmRfdGVzdCgmdC0+Y291bnQpOwo+ICAgfQo+
ICAgCj4gK3N0YXRpYyBpbmxpbmUgYm9vbCBfX3Rhc2tsZXRfaXNfc2NoZWR1bGVkKHN0cnVjdCB0
YXNrbGV0X3N0cnVjdCAqdCkKPiArewo+ICsJcmV0dXJuIHRlc3RfYml0KFRBU0tMRVRfU1RBVEVf
U0NIRUQsICZ0LT5zdGF0ZSk7Cj4gK30KPiArCj4gICAjZW5kaWYgLyogX19JOTE1X0dFTV9IX18g
Ki8KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fY29udGV4dC5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fY29udGV4dC5jCj4gaW5kZXggMDQwYzBi
NzcwYzIxLi4zYWUxZDI3MTMwYTggMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9nZW1fY29udGV4dC5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1f
Y29udGV4dC5jCj4gQEAgLTg2LDYgKzg2LDcgQEAKPiAgICAqLwo+ICAgCj4gICAjaW5jbHVkZSA8
bGludXgvbG9nMi5oPgo+ICsjaW5jbHVkZSA8bGludXgvbm9zcGVjLmg+Cj4gICAKPiAgICNpbmNs
dWRlIDxkcm0vaTkxNV9kcm0uaD4KPiAgIAo+IEBAIC0xMjE4LDcgKzEyMTksNiBAQCBfX2ludGVs
X2NvbnRleHRfcmVjb25maWd1cmVfc3NldShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCj4gICAJ
aW50IHJldDsKPiAgIAo+ICAgCUdFTV9CVUdfT04oSU5URUxfR0VOKGNlLT5nZW1fY29udGV4dC0+
aTkxNSkgPCA4KTsKPiAtCUdFTV9CVUdfT04oY2UtPmVuZ2luZS0+aWQgIT0gUkNTMCk7Cj4gICAK
PiAgIAlyZXQgPSBpbnRlbF9jb250ZXh0X2xvY2tfcGlubmVkKGNlKTsKPiAgIAlpZiAocmV0KQo+
IEBAIC0xNDEyLDcgKzE0MTIsMTAwIEBAIHN0cnVjdCBzZXRfZW5naW5lcyB7Cj4gICAJc3RydWN0
IGk5MTVfZ2VtX2VuZ2luZXMgKmVuZ2luZXM7Cj4gICB9Owo+ICAgCj4gK3N0YXRpYyBpbnQKPiAr
c2V0X2VuZ2luZXNfX2xvYWRfYmFsYW5jZShzdHJ1Y3QgaTkxNV91c2VyX2V4dGVuc2lvbiBfX3Vz
ZXIgKmJhc2UsIHZvaWQgKmRhdGEpCj4gK3sKPiArCXN0cnVjdCBpOTE1X2NvbnRleHRfZW5naW5l
c19sb2FkX2JhbGFuY2UgX191c2VyICpleHQgPQo+ICsJCWNvbnRhaW5lcl9vZl91c2VyKGJhc2Us
IHR5cGVvZigqZXh0KSwgYmFzZSk7Cj4gKwljb25zdCBzdHJ1Y3Qgc2V0X2VuZ2luZXMgKnNldCA9
IGRhdGE7Cj4gKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpzdGFja1sxNl07Cj4gKwlzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICoqc2libGluZ3M7Cj4gKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7
Cj4gKwl1MTYgbnVtX3NpYmxpbmdzLCBpZHg7Cj4gKwl1bnNpZ25lZCBpbnQgbjsKPiArCWludCBl
cnI7Cj4gKwo+ICsJaWYgKCFIQVNfRVhFQ0xJU1RTKHNldC0+Y3R4LT5pOTE1KSkKPiArCQlyZXR1
cm4gLUVOT0RFVjsKPiArCj4gKwlpZiAoVVNFU19HVUNfU1VCTUlTU0lPTihzZXQtPmN0eC0+aTkx
NSkpCj4gKwkJcmV0dXJuIC1FTk9ERVY7IC8qIG5vdCBpbXBsZW1lbnQgeWV0ICovCj4gKwo+ICsJ
aWYgKGdldF91c2VyKGlkeCwgJmV4dC0+ZW5naW5lX2luZGV4KSkKPiArCQlyZXR1cm4gLUVGQVVM
VDsKPiArCj4gKwlpZiAoaWR4ID49IHNldC0+ZW5naW5lcy0+bnVtX2VuZ2luZXMpIHsKPiArCQlE
Uk1fREVCVUcoIkludmFsaWQgcGxhY2VtZW50IHZhbHVlLCAlZCA+PSAlZFxuIiwKPiArCQkJICBp
ZHgsIHNldC0+ZW5naW5lcy0+bnVtX2VuZ2luZXMpOwo+ICsJCXJldHVybiAtRUlOVkFMOwo+ICsJ
fQo+ICsKPiArCWlkeCA9IGFycmF5X2luZGV4X25vc3BlYyhpZHgsIHNldC0+ZW5naW5lcy0+bnVt
X2VuZ2luZXMpOwo+ICsJaWYgKHNldC0+ZW5naW5lcy0+ZW5naW5lc1tpZHhdKSB7Cj4gKwkJRFJN
X0RFQlVHKCJJbnZhbGlkIHBsYWNlbWVudFslZF0sIGFscmVhZHkgb2NjdXBpZWRcbiIsIGlkeCk7
Cj4gKwkJcmV0dXJuIC1FRVhJU1Q7Cj4gKwl9Cj4gKwo+ICsJaWYgKGdldF91c2VyKG51bV9zaWJs
aW5ncywgJmV4dC0+bnVtX3NpYmxpbmdzKSkKPiArCQlyZXR1cm4gLUVGQVVMVDsKPiArCj4gKwll
cnIgPSBjaGVja191c2VyX21ieigmZXh0LT5mbGFncyk7Cj4gKwlpZiAoZXJyKQo+ICsJCXJldHVy
biBlcnI7Cj4gKwo+ICsJZXJyID0gY2hlY2tfdXNlcl9tYnooJmV4dC0+bWJ6NjQpOwo+ICsJaWYg
KGVycikKPiArCQlyZXR1cm4gZXJyOwo+ICsKPiArCXNpYmxpbmdzID0gc3RhY2s7Cj4gKwlpZiAo
bnVtX3NpYmxpbmdzID4gQVJSQVlfU0laRShzdGFjaykpIHsKPiArCQlzaWJsaW5ncyA9IGttYWxs
b2NfYXJyYXkobnVtX3NpYmxpbmdzLAo+ICsJCQkJCSBzaXplb2YoKnNpYmxpbmdzKSwKPiArCQkJ
CQkgR0ZQX0tFUk5FTCk7Cj4gKwkJaWYgKCFzaWJsaW5ncykKPiArCQkJcmV0dXJuIC1FTk9NRU07
Cj4gKwl9Cj4gKwo+ICsJZm9yIChuID0gMDsgbiA8IG51bV9zaWJsaW5nczsgbisrKSB7Cj4gKwkJ
c3RydWN0IGk5MTVfZW5naW5lX2NsYXNzX2luc3RhbmNlIGNpOwo+ICsKPiArCQlpZiAoY29weV9m
cm9tX3VzZXIoJmNpLCAmZXh0LT5lbmdpbmVzW25dLCBzaXplb2YoY2kpKSkgewo+ICsJCQllcnIg
PSAtRUZBVUxUOwo+ICsJCQlnb3RvIG91dF9zaWJsaW5nczsKPiArCQl9Cj4gKwo+ICsJCXNpYmxp
bmdzW25dID0gaW50ZWxfZW5naW5lX2xvb2t1cF91c2VyKHNldC0+Y3R4LT5pOTE1LAo+ICsJCQkJ
CQkgICAgICAgY2kuZW5naW5lX2NsYXNzLAo+ICsJCQkJCQkgICAgICAgY2kuZW5naW5lX2luc3Rh
bmNlKTsKPiArCQlpZiAoIXNpYmxpbmdzW25dKSB7Cj4gKwkJCURSTV9ERUJVRygiSW52YWxpZCBz
aWJsaW5nWyVkXTogeyBjbGFzczolZCwgaW5zdDolZCB9XG4iLAo+ICsJCQkJICBuLCBjaS5lbmdp
bmVfY2xhc3MsIGNpLmVuZ2luZV9pbnN0YW5jZSk7Cj4gKwkJCWVyciA9IC1FSU5WQUw7Cj4gKwkJ
CWdvdG8gb3V0X3NpYmxpbmdzOwo+ICsJCX0KPiArCX0KPiArCj4gKwljZSA9IGludGVsX2V4ZWNs
aXN0c19jcmVhdGVfdmlydHVhbChzZXQtPmN0eCwgc2libGluZ3MsIG4pOwo+ICsJaWYgKElTX0VS
UihjZSkpIHsKPiArCQllcnIgPSBQVFJfRVJSKGNlKTsKPiArCQlnb3RvIG91dF9zaWJsaW5nczsK
PiArCX0KPiArCj4gKwlpZiAoY21weGNoZygmc2V0LT5lbmdpbmVzLT5lbmdpbmVzW2lkeF0sIE5V
TEwsIGNlKSkgewo+ICsJCWludGVsX2NvbnRleHRfcHV0KGNlKTsKPiArCQllcnIgPSAtRUVYSVNU
Owo+ICsJCWdvdG8gb3V0X3NpYmxpbmdzOwo+ICsJfQo+ICsKPiArb3V0X3NpYmxpbmdzOgo+ICsJ
aWYgKHNpYmxpbmdzICE9IHN0YWNrKQo+ICsJCWtmcmVlKHNpYmxpbmdzKTsKPiArCj4gKwlyZXR1
cm4gZXJyOwo+ICt9Cj4gKwo+ICAgc3RhdGljIGNvbnN0IGk5MTVfdXNlcl9leHRlbnNpb25fZm4g
c2V0X2VuZ2luZXNfX2V4dGVuc2lvbnNbXSA9IHsKPiArCVtJOTE1X0NPTlRFWFRfRU5HSU5FU19F
WFRfTE9BRF9CQUxBTkNFXSA9IHNldF9lbmdpbmVzX19sb2FkX2JhbGFuY2UsCj4gICB9Owo+ICAg
Cj4gICBzdGF0aWMgaW50Cj4gQEAgLTE3MTEsMTQgKzE4MDQsMjkgQEAgc3RhdGljIGludCBjbG9u
ZV9lbmdpbmVzKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpkc3QsCj4gICAKPiAgIAljbG9uZS0+
aTkxNSA9IGRzdC0+aTkxNTsKPiAgIAlmb3IgKG4gPSAwOyBuIDwgZS0+bnVtX2VuZ2luZXM7IG4r
Kykgewo+ICsJCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKPiArCj4gICAJCWlmICgh
ZS0+ZW5naW5lc1tuXSkgewo+ICAgCQkJY2xvbmUtPmVuZ2luZXNbbl0gPSBOVUxMOwo+ICAgCQkJ
Y29udGludWU7Cj4gICAJCX0KPiArCQllbmdpbmUgPSBlLT5lbmdpbmVzW25dLT5lbmdpbmU7Cj4g
ICAKPiAtCQljbG9uZS0+ZW5naW5lc1tuXSA9Cj4gLQkJCWludGVsX2NvbnRleHRfY3JlYXRlKGRz
dCwgZS0+ZW5naW5lc1tuXS0+ZW5naW5lKTsKPiAtCQlpZiAoIWNsb25lLT5lbmdpbmVzW25dKSB7
Cj4gKwkJLyoKPiArCQkgKiBWaXJ0dWFsIGVuZ2luZXMgYXJlIHNpbmdsZXRvbnM7IHRoZXkgY2Fu
IG9ubHkgZXhpc3QKPiArCQkgKiBpbnNpZGUgYSBzaW5nbGUgY29udGV4dCwgYmVjYXVzZSB0aGV5
IGVtYmVkIHRoZWlyCj4gKwkJICogSFcgY29udGV4dC4uLiBBcyBlYWNoIHZpcnR1YWwgY29udGV4
dCBpbXBsaWVzIGEgc2luZ2xlCj4gKwkJICogdGltZWxpbmUgKGVhY2ggZW5naW5lIGNhbiBvbmx5
IGRlcXVldWUgYSBzaW5nbGUgcmVxdWVzdAo+ICsJCSAqIGF0IGFueSB0aW1lKSwgaXQgd291bGQg
YmUgc3VycHJpc2luZyBmb3IgdHdvIGNvbnRleHRzCj4gKwkJICogdG8gdXNlIHRoZSBzYW1lIGVu
Z2luZS4gU28gbGV0J3MgY3JlYXRlIGEgY29weSBvZgo+ICsJCSAqIHRoZSB2aXJ0dWFsIGVuZ2lu
ZSBpbnN0ZWFkLgo+ICsJCSAqLwo+ICsJCWlmIChpbnRlbF9lbmdpbmVfaXNfdmlydHVhbChlbmdp
bmUpKQo+ICsJCQljbG9uZS0+ZW5naW5lc1tuXSA9Cj4gKwkJCQlpbnRlbF9leGVjbGlzdHNfY2xv
bmVfdmlydHVhbChkc3QsIGVuZ2luZSk7Cj4gKwkJZWxzZQo+ICsJCQljbG9uZS0+ZW5naW5lc1tu
XSA9IGludGVsX2NvbnRleHRfY3JlYXRlKGRzdCwgZW5naW5lKTsKPiArCQlpZiAoSVNfRVJSX09S
X05VTEwoY2xvbmUtPmVuZ2luZXNbbl0pKSB7Cj4gICAJCQlfX2ZyZWVfZW5naW5lcyhjbG9uZSwg
bik7Cj4gICAJCQlnb3RvIGVycl91bmxvY2s7Cj4gICAJCX0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9zY2hlZHVsZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfc2NoZWR1bGVyLmMKPiBpbmRleCBkMjE1ZGNkZjBiMWUuLjc4Y2ViNTZkNzgwMSAxMDA2NDQK
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3NjaGVkdWxlci5jCj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zY2hlZHVsZXIuYwo+IEBAIC0xNTAsMTcgKzE1MCwyNiBA
QCBzY2hlZF9sb2NrX2VuZ2luZShjb25zdCBzdHJ1Y3QgaTkxNV9zY2hlZF9ub2RlICpub2RlLAo+
ICAgCQkgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmxvY2tlZCwKPiAgIAkJICBzdHJ1Y3Qgc2No
ZWRfY2FjaGUgKmNhY2hlKQo+ICAgewo+IC0Jc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
ID0gbm9kZV90b19yZXF1ZXN0KG5vZGUpLT5lbmdpbmU7Cj4gKwljb25zdCBzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICpycSA9IG5vZGVfdG9fcmVxdWVzdChub2RlKTsKPiArCXN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZTsKPiAgIAo+ICAgCUdFTV9CVUdfT04oIWxvY2tlZCk7Cj4gICAKPiAtCWlm
IChlbmdpbmUgIT0gbG9ja2VkKSB7Cj4gKwkvKgo+ICsJICogVmlydHVhbCBlbmdpbmVzIGNvbXBs
aWNhdGUgYWNxdWlyaW5nIHRoZSBlbmdpbmUgdGltZWxpbmUgbG9jaywKPiArCSAqIGFzIHRoZWly
IHJxLT5lbmdpbmUgcG9pbnRlciBpcyBub3Qgc3RhYmxlIHVudGlsIHVuZGVyIHRoYXQKPiArCSAq
IGVuZ2luZSBsb2NrLiBUaGUgc2ltcGxlIHBsb3kgd2UgdXNlIGlzIHRvIHRha2UgdGhlIGxvY2sg
dGhlbgo+ICsJICogY2hlY2sgdGhhdCB0aGUgcnEgc3RpbGwgYmVsb25ncyB0byB0aGUgbmV3bHkg
bG9ja2VkIGVuZ2luZS4KPiArCSAqLwo+ICsJd2hpbGUgKGxvY2tlZCAhPSAoZW5naW5lID0gUkVB
RF9PTkNFKHJxLT5lbmdpbmUpKSkgewo+ICAgCQlzcGluX3VubG9jaygmbG9ja2VkLT50aW1lbGlu
ZS5sb2NrKTsKPiAgIAkJbWVtc2V0KGNhY2hlLCAwLCBzaXplb2YoKmNhY2hlKSk7Cj4gICAJCXNw
aW5fbG9jaygmZW5naW5lLT50aW1lbGluZS5sb2NrKTsKPiArCQlsb2NrZWQgPSBlbmdpbmU7Cj4g
ICAJfQo+ICAgCj4gLQlyZXR1cm4gZW5naW5lOwo+ICsJR0VNX0JVR19PTihsb2NrZWQgIT0gZW5n
aW5lKTsKPiArCXJldHVybiBsb2NrZWQ7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbmxpbmUgaW50
IHJxX3ByaW8oY29uc3Qgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCj4gQEAgLTI3Miw2ICsyODEs
NyBAQCBzdGF0aWMgdm9pZCBfX2k5MTVfc2NoZWR1bGUoc3RydWN0IGk5MTVfc2NoZWRfbm9kZSAq
bm9kZSwKPiAgIAlzcGluX2xvY2soJmVuZ2luZS0+dGltZWxpbmUubG9jayk7Cj4gICAKPiAgIAkv
KiBGaWZvIGFuZCBkZXB0aC1maXJzdCByZXBsYWNlbWVudCBlbnN1cmUgb3VyIGRlcHMgZXhlY3V0
ZSBiZWZvcmUgdXMgKi8KPiArCWVuZ2luZSA9IHNjaGVkX2xvY2tfZW5naW5lKG5vZGUsIGVuZ2lu
ZSwgJmNhY2hlKTsKPiAgIAlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmVfcmV2ZXJzZShkZXAsIHAs
ICZkZnMsIGRmc19saW5rKSB7Cj4gICAJCUlOSVRfTElTVF9IRUFEKCZkZXAtPmRmc19saW5rKTsK
PiAgIAo+IEBAIC0yODMsOCArMjkzLDExIEBAIHN0YXRpYyB2b2lkIF9faTkxNV9zY2hlZHVsZShz
dHJ1Y3QgaTkxNV9zY2hlZF9ub2RlICpub2RlLAo+ICAgCQlpZiAocHJpbyA8PSBub2RlLT5hdHRy
LnByaW9yaXR5IHx8IG5vZGVfc2lnbmFsZWQobm9kZSkpCj4gICAJCQljb250aW51ZTsKPiAgIAo+
ICsJCUdFTV9CVUdfT04obm9kZV90b19yZXF1ZXN0KG5vZGUpLT5lbmdpbmUgIT0gZW5naW5lKTsK
PiArCj4gICAJCW5vZGUtPmF0dHIucHJpb3JpdHkgPSBwcmlvOwo+ICAgCQlpZiAoIWxpc3RfZW1w
dHkoJm5vZGUtPmxpbmspKSB7Cj4gKwkJCUdFTV9CVUdfT04oaW50ZWxfZW5naW5lX2lzX3ZpcnR1
YWwoZW5naW5lKSk7Cj4gICAJCQlpZiAoIWNhY2hlLnByaW9saXN0KQo+ICAgCQkJCWNhY2hlLnBy
aW9saXN0ID0KPiAgIAkJCQkJaTkxNV9zY2hlZF9sb29rdXBfcHJpb2xpc3QoZW5naW5lLAo+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3RpbWVsaW5lX3R5cGVzLmggYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3RpbWVsaW5lX3R5cGVzLmgKPiBpbmRleCA1MjU2YTBi
NWM1ZjcuLjE2ODg3MDVmNGEyYiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3RpbWVsaW5lX3R5cGVzLmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3Rp
bWVsaW5lX3R5cGVzLmgKPiBAQCAtMjYsNiArMjYsNyBAQCBzdHJ1Y3QgaTkxNV90aW1lbGluZSB7
Cj4gICAJc3BpbmxvY2tfdCBsb2NrOwo+ICAgI2RlZmluZSBUSU1FTElORV9DTElFTlQgMCAvKiBk
ZWZhdWx0IHN1YmNsYXNzICovCj4gICAjZGVmaW5lIFRJTUVMSU5FX0VOR0lORSAxCj4gKyNkZWZp
bmUgVElNRUxJTkVfVklSVFVBTCAyCj4gICAJc3RydWN0IG11dGV4IG11dGV4OyAvKiBwcm90ZWN0
cyB0aGUgZmxvdyBvZiByZXF1ZXN0cyAqLwo+ICAgCj4gICAJdW5zaWduZWQgaW50IHBpbl9jb3Vu
dDsKPiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2RybS9pOTE1X2RybS5oIGIvaW5jbHVkZS91
YXBpL2RybS9pOTE1X2RybS5oCj4gaW5kZXggNjIzOTZkNTc1ZTI4Li5mOTc3MDk0ODE2MWMgMTAw
NjQ0Cj4gLS0tIGEvaW5jbHVkZS91YXBpL2RybS9pOTE1X2RybS5oCj4gKysrIGIvaW5jbHVkZS91
YXBpL2RybS9pOTE1X2RybS5oCj4gQEAgLTEzNyw2ICsxMzcsNyBAQCBzdHJ1Y3QgaTkxNV9lbmdp
bmVfY2xhc3NfaW5zdGFuY2Ugewo+ICAgCV9fdTE2IGVuZ2luZV9jbGFzczsgLyogc2VlIGVudW0g
ZHJtX2k5MTVfZ2VtX2VuZ2luZV9jbGFzcyAqLwo+ICAgCV9fdTE2IGVuZ2luZV9pbnN0YW5jZTsK
PiAgICNkZWZpbmUgSTkxNV9FTkdJTkVfQ0xBU1NfSU5WQUxJRF9OT05FIC0xCj4gKyNkZWZpbmUg
STkxNV9FTkdJTkVfQ0xBU1NfSU5WQUxJRF9WSVJUVUFMIC0yCj4gICB9Owo+ICAgCj4gICAvKioK
PiBAQCAtMTYwOCw4ICsxNjA5LDQ2IEBAIHN0cnVjdCBkcm1faTkxNV9nZW1fY29udGV4dF9wYXJh
bV9zc2V1IHsKPiAgIAlfX3UzMiByc3ZkOwo+ICAgfTsKPiAgIAo+ICsvKgo+ICsgKiBpOTE1X2Nv
bnRleHRfZW5naW5lc19sb2FkX2JhbGFuY2U6Cj4gKyAqCj4gKyAqIEVuYWJsZSBsb2FkIGJhbGFu
Y2luZyBhY3Jvc3MgdGhpcyBzZXQgb2YgZW5naW5lcy4KPiArICoKPiArICogSW50byB0aGUgSTkx
NV9FWEVDX0RFRkFVTFQgc2xvdCBbMF0sIGEgdmlydHVhbCBlbmdpbmUgaXMgY3JlYXRlZCB0aGF0
IHdoZW4KPiArICogdXNlZCB3aWxsIHByb3h5IHRoZSBleGVjYnVmZmVyIHJlcXVlc3Qgb250byBv
bmUgb2YgdGhlIHNldCBvZiBlbmdpbmVzCj4gKyAqIGluIHN1Y2ggYSB3YXkgYXMgdG8gZGlzdHJp
YnV0ZSB0aGUgbG9hZCBldmVubHkgYWNyb3NzIHRoZSBzZXQuCj4gKyAqCj4gKyAqIFRoZSBzZXQg
b2YgZW5naW5lcyBtdXN0IGJlIGNvbXBhdGlibGUgKGUuZy4gdGhlIHNhbWUgSFcgY2xhc3MpIGFz
IHRoZXkKPiArICogd2lsbCBzaGFyZSB0aGUgc2FtZSBsb2dpY2FsIEdQVSBjb250ZXh0IGFuZCBy
aW5nLgo+ICsgKgo+ICsgKiBUbyBpbnRlcm1peCByZW5kZXJpbmcgd2l0aCB0aGUgdmlydHVhbCBl
bmdpbmUgYW5kIGRpcmVjdCByZW5kZXJpbmcgb250bwo+ICsgKiB0aGUgYmFja2luZyBlbmdpbmVz
IChieXBhc3NpbmcgdGhlIGxvYWQgYmFsYW5jaW5nIHByb3h5KSwgdGhlIGNvbnRleHQgbXVzdAo+
ICsgKiBiZSBkZWZpbmVkIHRvIHVzZSBhIHNpbmdsZSB0aW1lbGluZSBmb3IgYWxsIGVuZ2luZXMu
Cj4gKyAqLwo+ICtzdHJ1Y3QgaTkxNV9jb250ZXh0X2VuZ2luZXNfbG9hZF9iYWxhbmNlIHsKPiAr
CXN0cnVjdCBpOTE1X3VzZXJfZXh0ZW5zaW9uIGJhc2U7Cj4gKwo+ICsJX191MTYgZW5naW5lX2lu
ZGV4Owo+ICsJX191MTYgbnVtX3NpYmxpbmdzOwo+ICsJX191MzIgZmxhZ3M7IC8qIGFsbCB1bmRl
ZmluZWQgZmxhZ3MgbXVzdCBiZSB6ZXJvICovCj4gKwo+ICsJX191NjQgbWJ6NjQ7IC8qIHJlc2Vy
dmVkIGZvciBmdXR1cmUgdXNlOyBtdXN0IGJlIHplcm8gKi8KPiArCj4gKwlzdHJ1Y3QgaTkxNV9l
bmdpbmVfY2xhc3NfaW5zdGFuY2UgZW5naW5lc1swXTsKPiArfSBfX2F0dHJpYnV0ZV9fKChwYWNr
ZWQpKTsKPiArCj4gKyNkZWZpbmUgSTkxNV9ERUZJTkVfQ09OVEVYVF9FTkdJTkVTX0xPQURfQkFM
QU5DRShuYW1lX18sIE5fXykgc3RydWN0IHsgXAo+ICsJc3RydWN0IGk5MTVfdXNlcl9leHRlbnNp
b24gYmFzZTsgXAo+ICsJX191MTYgZW5naW5lX2luZGV4OyBcCj4gKwlfX3UxNiBudW1fc2libGlu
Z3M7IFwKPiArCV9fdTMyIGZsYWdzOyBcCj4gKwlfX3U2NCBtYno2NDsgXAo+ICsJc3RydWN0IGk5
MTVfZW5naW5lX2NsYXNzX2luc3RhbmNlIGVuZ2luZXNbTl9fXTsgXAo+ICt9IF9fYXR0cmlidXRl
X18oKHBhY2tlZCkpIG5hbWVfXwo+ICsKPiAgIHN0cnVjdCBpOTE1X2NvbnRleHRfcGFyYW1fZW5n
aW5lcyB7Cj4gICAJX191NjQgZXh0ZW5zaW9uczsgLyogbGlua2VkIGNoYWluIG9mIGV4dGVuc2lv
biBibG9ja3MsIDAgdGVybWluYXRlcyAqLwo+ICsjZGVmaW5lIEk5MTVfQ09OVEVYVF9FTkdJTkVT
X0VYVF9MT0FEX0JBTEFOQ0UgMCAvKiBzZWUgaTkxNV9jb250ZXh0X2VuZ2luZXNfbG9hZF9iYWxh
bmNlICovCj4gICAJc3RydWN0IGk5MTVfZW5naW5lX2NsYXNzX2luc3RhbmNlIGVuZ2luZXNbMF07
Cj4gICB9IF9fYXR0cmlidXRlX18oKHBhY2tlZCkpOwo+ICAgCj4gCgpSZXZpZXdlZC1ieTogVHZy
dGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KClJlZ2FyZHMsCgpUdnJ0a28K
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4
IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlz
dHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

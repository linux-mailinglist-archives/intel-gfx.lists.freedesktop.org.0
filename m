Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id D4C0F29CA66
	for <lists+intel-gfx@lfdr.de>; Tue, 27 Oct 2020 21:40:18 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 465116EC46;
	Tue, 27 Oct 2020 20:40:17 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga18.intel.com (mga18.intel.com [134.134.136.126])
 by gabe.freedesktop.org (Postfix) with ESMTPS id BBDF36EC46
 for <intel-gfx@lists.freedesktop.org>; Tue, 27 Oct 2020 20:40:13 +0000 (UTC)
IronPort-SDR: n/LzyEbqsfthvTUuFDaGS66RJRouRVkU114WnMDdaKvOkkXSzlX6j/amYZirr3Q50iBpKgn6l9
 /DrNXfDJ5OMQ==
X-IronPort-AV: E=McAfee;i="6000,8403,9787"; a="155938039"
X-IronPort-AV: E=Sophos;i="5.77,424,1596524400"; d="scan'208";a="155938039"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga007.jf.intel.com ([10.7.209.58])
 by orsmga106.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 27 Oct 2020 13:40:13 -0700
IronPort-SDR: tc2MMfe8mnNuu6RcHOHk/bdhlUdmC8Ia4231eAOXL18q++3i+QANokrn+ruT93g8BWBGXti/Nr
 4bFINEn/QaYA==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.77,424,1596524400"; d="scan'208";a="361527772"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.174])
 by orsmga007.jf.intel.com with SMTP; 27 Oct 2020 13:40:11 -0700
Received: by stinkbox (sSMTP sendmail emulation);
 Tue, 27 Oct 2020 22:40:10 +0200
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 27 Oct 2020 22:39:52 +0200
Message-Id: <20201027203955.28032-6-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.26.2
In-Reply-To: <20201027203955.28032-1-ville.syrjala@linux.intel.com>
References: <20201027203955.28032-1-ville.syrjala@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 5/8] drm/i915: Move pipe ddb entries into the
 dbuf state
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KClRo
ZSBkYnVmIHN0YXRlIHdpbGwgYmUgd2hlcmUgd2UgY29sbGVjdCBhbGwgdGhlIGludGVyLXBpcGUg
ZGJ1ZgphbGxvY2F0aW9uIHN0dWZmLiBTdGFydCBieSBtb3ZpbmcgdGhlIGFjdHVhbCBwZXItcGlw
ZSBkZGIgZW50cmllcwp0aGVyZS4KCnYyOiBSZWJhc2UKCkNjOiBTdGFuaXNsYXYgTGlzb3Zza2l5
IDxzdGFuaXNsYXYubGlzb3Zza2l5QGludGVsLmNvbT4KU2lnbmVkLW9mZi1ieTogVmlsbGUgU3ly
asOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyAgfCAyMSArKysrKysrKysrKystLS0tLS0t
CiAuLi4vZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmggICAgfCAgMSAtCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5jICAgICAgICAgICAgICAgfCAxNiArKysrKyst
LS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uaCAgICAgICAgICAgICAgIHwg
IDQgKysrKwogNCBmaWxlcyBjaGFuZ2VkLCAyMyBpbnNlcnRpb25zKCspLCAxOSBkZWxldGlvbnMo
LSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3Bs
YXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCmluZGV4
IGY0MWI2ZjhiNTYxOC4uY2IyZjA2ZmMxMTIzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2Rpc3BsYXkuYwpAQCAtMTU2NzMsNiArMTU2NzMsMTAgQEAgc3RhdGljIHZv
aWQgaW50ZWxfY29tbWl0X21vZGVzZXRfZW5hYmxlcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRl
ICpzdGF0ZSkKIHN0YXRpYyB2b2lkIHNrbF9jb21taXRfbW9kZXNldF9lbmFibGVzKHN0cnVjdCBp
bnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoc3RhdGUtPmJhc2UuZGV2KTsKKwljb25zdCBzdHJ1Y3QgaW50ZWxf
ZGJ1Zl9zdGF0ZSAqb2xkX2RidWZfc3RhdGUgPQorCQlpbnRlbF9hdG9taWNfZ2V0X29sZF9kYnVm
X3N0YXRlKHN0YXRlKTsKKwljb25zdCBzdHJ1Y3QgaW50ZWxfZGJ1Zl9zdGF0ZSAqbmV3X2RidWZf
c3RhdGUgPQorCQlpbnRlbF9hdG9taWNfZ2V0X25ld19kYnVmX3N0YXRlKHN0YXRlKTsKIAlzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YzsKIAlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNf
c3RhdGUsICpuZXdfY3J0Y19zdGF0ZTsKIAlzdHJ1Y3Qgc2tsX2RkYl9lbnRyeSBlbnRyaWVzW0k5
MTVfTUFYX1BJUEVTXSA9IHt9OwpAQCAtMTU2ODcsNyArMTU2OTEsNyBAQCBzdGF0aWMgdm9pZCBz
a2xfY29tbWl0X21vZGVzZXRfZW5hYmxlcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0
ZSkKIAogCQkvKiBpZ25vcmUgYWxsb2NhdGlvbnMgZm9yIGNydGMncyB0aGF0IGhhdmUgYmVlbiB0
dXJuZWQgb2ZmLiAqLwogCQlpZiAoIW5lZWRzX21vZGVzZXQobmV3X2NydGNfc3RhdGUpKSB7Ci0J
CQllbnRyaWVzW3BpcGVdID0gb2xkX2NydGNfc3RhdGUtPndtLnNrbC5kZGI7CisJCQllbnRyaWVz
W3BpcGVdID0gb2xkX2RidWZfc3RhdGUtPmRkYltwaXBlXTsKIAkJCXVwZGF0ZV9waXBlcyB8PSBC
SVQocGlwZSk7CiAJCX0gZWxzZSB7CiAJCQltb2Rlc2V0X3BpcGVzIHw9IEJJVChwaXBlKTsKQEAg
LTE1NzExLDExICsxNTcxNSwxMSBAQCBzdGF0aWMgdm9pZCBza2xfY29tbWl0X21vZGVzZXRfZW5h
YmxlcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKIAkJCWlmICgodXBkYXRlX3Bp
cGVzICYgQklUKHBpcGUpKSA9PSAwKQogCQkJCWNvbnRpbnVlOwogCi0JCQlpZiAoc2tsX2RkYl9h
bGxvY2F0aW9uX292ZXJsYXBzKCZuZXdfY3J0Y19zdGF0ZS0+d20uc2tsLmRkYiwKKwkJCWlmIChz
a2xfZGRiX2FsbG9jYXRpb25fb3ZlcmxhcHMoJm5ld19kYnVmX3N0YXRlLT5kZGJbcGlwZV0sCiAJ
CQkJCQkJZW50cmllcywgSTkxNV9NQVhfUElQRVMsIHBpcGUpKQogCQkJCWNvbnRpbnVlOwogCi0J
CQllbnRyaWVzW3BpcGVdID0gbmV3X2NydGNfc3RhdGUtPndtLnNrbC5kZGI7CisJCQllbnRyaWVz
W3BpcGVdID0gbmV3X2RidWZfc3RhdGUtPmRkYltwaXBlXTsKIAkJCXVwZGF0ZV9waXBlcyAmPSB+
QklUKHBpcGUpOwogCiAJCQlpbnRlbF91cGRhdGVfY3J0YyhzdGF0ZSwgY3J0Yyk7CkBAIC0xNTcy
Niw4ICsxNTczMCw4IEBAIHN0YXRpYyB2b2lkIHNrbF9jb21taXRfbW9kZXNldF9lbmFibGVzKHN0
cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQogCQkJICogdGhlbiB3ZSBuZWVkIHRvIHdh
aXQgZm9yIGEgdmJsYW5rIHRvIHBhc3MgZm9yIHRoZQogCQkJICogbmV3IGRkYiBhbGxvY2F0aW9u
IHRvIHRha2UgZWZmZWN0LgogCQkJICovCi0JCQlpZiAoIXNrbF9kZGJfZW50cnlfZXF1YWwoJm5l
d19jcnRjX3N0YXRlLT53bS5za2wuZGRiLAotCQkJCQkJICZvbGRfY3J0Y19zdGF0ZS0+d20uc2ts
LmRkYikgJiYKKwkJCWlmICghc2tsX2RkYl9lbnRyeV9lcXVhbCgmbmV3X2RidWZfc3RhdGUtPmRk
YltwaXBlXSwKKwkJCQkJCSAmb2xkX2RidWZfc3RhdGUtPmRkYltwaXBlXSkgJiYKIAkJCSAgICAo
dXBkYXRlX3BpcGVzIHwgbW9kZXNldF9waXBlcykpCiAJCQkJaW50ZWxfd2FpdF9mb3JfdmJsYW5r
KGRldl9wcml2LCBwaXBlKTsKIAkJfQpAQCAtMTU3NzgsMTAgKzE1NzgyLDExIEBAIHN0YXRpYyB2
b2lkIHNrbF9jb21taXRfbW9kZXNldF9lbmFibGVzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUg
KnN0YXRlKQogCQlpZiAoKHVwZGF0ZV9waXBlcyAmIEJJVChwaXBlKSkgPT0gMCkKIAkJCWNvbnRp
bnVlOwogCi0JCWRybV9XQVJOX09OKCZkZXZfcHJpdi0+ZHJtLCBza2xfZGRiX2FsbG9jYXRpb25f
b3ZlcmxhcHMoJm5ld19jcnRjX3N0YXRlLT53bS5za2wuZGRiLAotCQkJCQkJCQkJZW50cmllcywg
STkxNV9NQVhfUElQRVMsIHBpcGUpKTsKKwkJZHJtX1dBUk5fT04oJmRldl9wcml2LT5kcm0sCisJ
CQkgICAgc2tsX2RkYl9hbGxvY2F0aW9uX292ZXJsYXBzKCZuZXdfZGJ1Zl9zdGF0ZS0+ZGRiW3Bp
cGVdLAorCQkJCQkJCWVudHJpZXMsIEk5MTVfTUFYX1BJUEVTLCBwaXBlKSk7CiAKLQkJZW50cmll
c1twaXBlXSA9IG5ld19jcnRjX3N0YXRlLT53bS5za2wuZGRiOworCQllbnRyaWVzW3BpcGVdID0g
bmV3X2RidWZfc3RhdGUtPmRkYltwaXBlXTsKIAkJdXBkYXRlX3BpcGVzICY9IH5CSVQocGlwZSk7
CiAKIAkJaW50ZWxfdXBkYXRlX2NydGMoc3RhdGUsIGNydGMpOwpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmggYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaAppbmRleCBmNmYwNjI2NjQ5
ZTAuLmE0YjVjMDZhMTE4MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgKQEAgLTc1Nyw3ICs3NTcsNiBAQCBzdHJ1Y3QgaW50ZWxf
Y3J0Y193bV9zdGF0ZSB7CiAJCXN0cnVjdCB7CiAJCQkvKiBnZW45KyBvbmx5IG5lZWRzIDEtc3Rl
cCB3bSBwcm9ncmFtbWluZyAqLwogCQkJc3RydWN0IHNrbF9waXBlX3dtIG9wdGltYWw7Ci0JCQlz
dHJ1Y3Qgc2tsX2RkYl9lbnRyeSBkZGI7CiAJCQlzdHJ1Y3Qgc2tsX2RkYl9lbnRyeSBwbGFuZV9k
ZGJfeVtJOTE1X01BWF9QTEFORVNdOwogCQkJc3RydWN0IHNrbF9kZGJfZW50cnkgcGxhbmVfZGRi
X3V2W0k5MTVfTUFYX1BMQU5FU107CiAJCX0gc2tsOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfcG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMKaW5k
ZXggZTQ5MTc0NTRlYzA3Li4yZWM0OGQ5NTIyZTggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYwpA
QCAtNDE1NCwxNiArNDE1NCw4IEBAIHNrbF9kZGJfZ2V0X3BpcGVfYWxsb2NhdGlvbl9saW1pdHMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogCSAqIGdyYWIgX2FsbF8gY3J0YyBs
b2NrcywgaW5jbHVkaW5nIHRoZSBvbmUgd2UgY3VycmVudGx5IGhvbGQuCiAJICovCiAJaWYgKG9s
ZF9kYnVmX3N0YXRlLT5hY3RpdmVfcGlwZXMgPT0gbmV3X2RidWZfc3RhdGUtPmFjdGl2ZV9waXBl
cyAmJgotCSAgICAhZGV2X3ByaXYtPndtLmRpc3RydXN0X2Jpb3Nfd20pIHsKLQkJLyoKLQkJICog
YWxsb2MgbWF5IGJlIGNsZWFyZWQgYnkgY2xlYXJfaW50ZWxfY3J0Y19zdGF0ZSwKLQkJICogY29w
eSBmcm9tIG9sZCBzdGF0ZSB0byBiZSBzdXJlCi0JCSAqCi0JCSAqIEZJWE1FIGdldCByaWQgb2Yg
dGhpcyBtZXNzCi0JCSAqLwotCQkqYWxsb2MgPSB0b19pbnRlbF9jcnRjX3N0YXRlKGZvcl9jcnRj
LT5iYXNlLnN0YXRlKS0+d20uc2tsLmRkYjsKKwkgICAgIWRldl9wcml2LT53bS5kaXN0cnVzdF9i
aW9zX3dtKQogCQlyZXR1cm4gMDsKLQl9CiAKIAkvKgogCSAqIEdldCBhbGxvd2VkIERCdWYgc2xp
Y2VzIGZvciBjb3JyZXNwb25kZW50IHBpcGUgYW5kIHBsYXRmb3JtLgpAQCAtNDc5MCw3ICs0Nzgy
LDExIEBAIHNrbF9hbGxvY2F0ZV9waXBlX2RkYihzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSkKIHsKIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0
Y19zdGF0ZS0+dWFwaS5jcnRjKTsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKLQlzdHJ1Y3Qgc2tsX2RkYl9lbnRyeSAqYWxsb2Mg
PSAmY3J0Y19zdGF0ZS0+d20uc2tsLmRkYjsKKwlzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpz
dGF0ZSA9CisJCXRvX2ludGVsX2F0b21pY19zdGF0ZShjcnRjX3N0YXRlLT51YXBpLnN0YXRlKTsK
KwlzdHJ1Y3QgaW50ZWxfZGJ1Zl9zdGF0ZSAqZGJ1Zl9zdGF0ZSA9CisJCWludGVsX2F0b21pY19n
ZXRfbmV3X2RidWZfc3RhdGUoc3RhdGUpOworCXN0cnVjdCBza2xfZGRiX2VudHJ5ICphbGxvYyA9
ICZkYnVmX3N0YXRlLT5kZGJbY3J0Yy0+cGlwZV07CiAJdTE2IGFsbG9jX3NpemUsIHN0YXJ0ID0g
MDsKIAl1MTYgdG90YWxbSTkxNV9NQVhfUExBTkVTXSA9IHt9OwogCXUxNiB1dl90b3RhbFtJOTE1
X01BWF9QTEFORVNdID0ge307CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9wbS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uaAppbmRleCAwMDkxMGJjMDE0
MDcuLjcyNDIwNGJiODQ0MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
cG0uaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5oCkBAIC05LDggKzksMTAg
QEAKICNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgogCiAjaW5jbHVkZSAiZGlzcGxheS9pbnRlbF9i
dy5oIgorI2luY2x1ZGUgImRpc3BsYXkvaW50ZWxfZGlzcGxheS5oIgogI2luY2x1ZGUgImRpc3Bs
YXkvaW50ZWxfZ2xvYmFsX3N0YXRlLmgiCiAKKyNpbmNsdWRlICJpOTE1X2Rydi5oIgogI2luY2x1
ZGUgImk5MTVfcmVnLmgiCiAKIHN0cnVjdCBkcm1fZGV2aWNlOwpAQCAtNjgsNiArNzAsOCBAQCBi
b29sIGludGVsX3NldF9tZW1vcnlfY3hzcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsIGJvb2wgZW5hYmxlKTsKIHN0cnVjdCBpbnRlbF9kYnVmX3N0YXRlIHsKIAlzdHJ1Y3QgaW50
ZWxfZ2xvYmFsX3N0YXRlIGJhc2U7CiAKKwlzdHJ1Y3Qgc2tsX2RkYl9lbnRyeSBkZGJbSTkxNV9N
QVhfUElQRVNdOworCiAJdTggZW5hYmxlZF9zbGljZXM7CiAJdTggYWN0aXZlX3BpcGVzOwogfTsK
LS0gCjIuMjYuMgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
Cmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4
Cg==

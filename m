Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1E2D9704E3
	for <lists+intel-gfx@lfdr.de>; Mon, 22 Jul 2019 18:03:41 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 277A389B05;
	Mon, 22 Jul 2019 16:03:39 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga02.intel.com (mga02.intel.com [134.134.136.20])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8534A89B05
 for <intel-gfx@lists.freedesktop.org>; Mon, 22 Jul 2019 16:03:37 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga006.fm.intel.com ([10.253.24.20])
 by orsmga101.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 22 Jul 2019 09:03:35 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,295,1559545200"; d="scan'208";a="368559529"
Received: from kraman-mobl.amr.corp.intel.com (HELO [10.251.80.208])
 ([10.251.80.208])
 by fmsmga006.fm.intel.com with ESMTP; 22 Jul 2019 09:03:32 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20190718070024.21781-1-chris@chris-wilson.co.uk>
 <20190718070024.21781-13-chris@chris-wilson.co.uk>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <2fbe7c82-7324-e959-38ac-7841aa35a670@linux.intel.com>
Date: Mon, 22 Jul 2019 17:03:31 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.7.2
MIME-Version: 1.0
In-Reply-To: <20190718070024.21781-13-chris@chris-wilson.co.uk>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH 13/20] drm/i915: Teach execbuffer to take
 the engine wakeref not GT
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDE4LzA3LzIwMTkgMDg6MDAsIENocmlzIFdpbHNvbiB3cm90ZToKPiBJbiB0aGUgbmV4dCBw
YXRjaCwgd2Ugd291bGQgbGlrZSB0byBjb3VwbGUgaW50byB0aGUgZW5naW5lIHdha2VyZWYgdG8K
PiBmcmVlIHRoZSBiYXRjaCBwb29sIG9uIGlkbGluZy4gVGhlIGNhdmVhdCBoZXJlIGlzIHRoYXQg
d2UgdGhlcmVmb3JlIHdhbnQKPiB0byB0cmFjayB0aGUgZW5naW5lIHdha2VyZWYgbW9yZSBwcmVj
aXNlbHkgYW5kIHRvIGhvbGQgaXQgaW5zdGVhZCBvZiB0aGUKPiBicm9hZGVyIEdUIHdha2VyZWYg
YXMgd2UgcHJvY2VzcyB0aGUgaW9jdGwuCj4gCj4gU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29u
IDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Cj4gLS0tCj4gICAuLi4vZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9leGVjYnVmZmVyLmMgICAgfCAzNiArKysrKysrKysrKystLS0tLS0tCj4gICBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmggICAgICAgfCAgNyArKysrCj4g
ICAyIGZpbGVzIGNoYW5nZWQsIDMxIGluc2VydGlvbnMoKyksIDEyIGRlbGV0aW9ucygtKQo+IAo+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZl
ci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYwo+IGlu
ZGV4IGNiZDdjNmUzYTFmOC4uODc2OGQ0MzZlNTRiIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jCj4gQEAgLTIxMzgsMTMgKzIxMzgsMzUg
QEAgc3RhdGljIGludCBlYl9waW5fY29udGV4dChzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYiwg
c3RydWN0IGludGVsX2NvbnRleHQgKmNlKQo+ICAgCWlmIChlcnIpCj4gICAJCXJldHVybiBlcnI7
Cj4gICAKPiArCS8qCj4gKwkgKiBUYWtlIGEgbG9jYWwgd2FrZXJlZiBmb3IgcHJlcGFyaW5nIHRv
IGRpc3BhdGNoIHRoZSBleGVjYnVmIGFzCj4gKwkgKiB3ZSBleHBlY3QgdG8gYWNjZXNzIHRoZSBo
YXJkd2FyZSBmYWlybHkgZnJlcXVlbnRseSBpbiB0aGUKPiArCSAqIHByb2Nlc3MuIFVwb24gZmly
c3QgZGlzcGF0Y2gsIHdlIGFjcXVpcmUgYW5vdGhlciBwcm9sb25nZWQKPiArCSAqIHdha2VyZWYg
dGhhdCB3ZSBob2xkIHVudGlsIHRoZSBHUFUgaGFzIGJlZW4gaWRsZSBmb3IgYXQgbGVhc3QKPiAr
CSAqIDEwMG1zLgoKT2xkIGNvbW1lbnQgYnV0IHNsaWdodGx5IG5vdCBidXNpbmVzcyBvZiB0aGlz
IGxheWVyIHRvIHRhbGsgYWJvdXQgMTAwbXMuCgo+ICsJICovCj4gKwllcnIgPSBpbnRlbF9jb250
ZXh0X3RpbWVsaW5lX2xvY2soY2UpOwo+ICsJaWYgKGVycikKPiArCQlnb3RvIGVycl91bnBpbjsK
PiArCj4gKwlpbnRlbF9jb250ZXh0X2VudGVyKGNlKTsKPiArCWludGVsX2NvbnRleHRfdGltZWxp
bmVfdW5sb2NrKGNlKTsKPiArCj4gICAJZWItPmVuZ2luZSA9IGNlLT5lbmdpbmU7Cj4gICAJZWIt
PmNvbnRleHQgPSBjZTsKPiAgIAlyZXR1cm4gMDsKPiArCj4gK2Vycl91bnBpbjoKPiArCWludGVs
X2NvbnRleHRfdW5waW4oY2UpOwo+ICsJcmV0dXJuIGVycjsKPiAgIH0KPiAgIAo+ICAgc3RhdGlj
IHZvaWQgZWJfdW5waW5fY29udGV4dChzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYikKPiAgIHsK
PiArCV9faW50ZWxfY29udGV4dF90aW1lbGluZV9sb2NrKGViLT5jb250ZXh0KTsKClNsaWdodCBt
aXN1c2Ugb2YgZXN0YWJsaXNoZWQgc2VtYW50aWNzIGZvciB1bmRlcnNjb3Jlcy4gKEknZCBleHBl
Y3Qgbm8gCmxvY2tpbmcsIG9yIHNvbWV0aGluZyBhbG9uZyB0aG9zZSBsaW5lcywgbm90IGEgZGlm
ZmVyZW5jZSBiZXR3ZWVuIAppbnRlcnJ1cHRpYmxlIGFuZCBub24taW50ZXJydXB0aWJsZS4pCgo+
ICsJaW50ZWxfY29udGV4dF9leGl0KGViLT5jb250ZXh0KTsKPiArCWludGVsX2NvbnRleHRfdGlt
ZWxpbmVfdW5sb2NrKGViLT5jb250ZXh0KTsKPiArCj4gICAJaW50ZWxfY29udGV4dF91bnBpbihl
Yi0+Y29udGV4dCk7Cj4gICB9Cj4gICAKPiBAQCAtMjQyNSwxOCArMjQ0Nyw5IEBAIGk5MTVfZ2Vt
X2RvX2V4ZWNidWZmZXIoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiAgIAlpZiAodW5saWtlbHko
ZXJyKSkKPiAgIAkJZ290byBlcnJfZGVzdHJveTsKPiAgIAo+IC0JLyoKPiAtCSAqIFRha2UgYSBs
b2NhbCB3YWtlcmVmIGZvciBwcmVwYXJpbmcgdG8gZGlzcGF0Y2ggdGhlIGV4ZWNidWYgYXMKPiAt
CSAqIHdlIGV4cGVjdCB0byBhY2Nlc3MgdGhlIGhhcmR3YXJlIGZhaXJseSBmcmVxdWVudGx5IGlu
IHRoZQo+IC0JICogcHJvY2Vzcy4gVXBvbiBmaXJzdCBkaXNwYXRjaCwgd2UgYWNxdWlyZSBhbm90
aGVyIHByb2xvbmdlZAo+IC0JICogd2FrZXJlZiB0aGF0IHdlIGhvbGQgdW50aWwgdGhlIEdQVSBo
YXMgYmVlbiBpZGxlIGZvciBhdCBsZWFzdAo+IC0JICogMTAwbXMuCj4gLQkgKi8KPiAtCWludGVs
X2d0X3BtX2dldCgmZWIuaTkxNS0+Z3QpOwo+IC0KPiAgIAllcnIgPSBpOTE1X211dGV4X2xvY2tf
aW50ZXJydXB0aWJsZShkZXYpOwo+ICAgCWlmIChlcnIpCj4gLQkJZ290byBlcnJfcnBtOwo+ICsJ
CWdvdG8gZXJyX2NvbnRleHQ7Cj4gICAKPiAgIAllcnIgPSBlYl9zZWxlY3RfZW5naW5lKCZlYiwg
ZmlsZSwgYXJncyk7Cj4gICAJaWYgKHVubGlrZWx5KGVycikpCj4gQEAgLTI2MDEsOCArMjYxNCw3
IEBAIGk5MTVfZ2VtX2RvX2V4ZWNidWZmZXIoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiAgIAll
Yl91bnBpbl9jb250ZXh0KCZlYik7Cj4gICBlcnJfdW5sb2NrOgo+ICAgCW11dGV4X3VubG9jaygm
ZGV2LT5zdHJ1Y3RfbXV0ZXgpOwo+IC1lcnJfcnBtOgo+IC0JaW50ZWxfZ3RfcG1fcHV0KCZlYi5p
OTE1LT5ndCk7Cj4gK2Vycl9jb250ZXh0Ogo+ICAgCWk5MTVfZ2VtX2NvbnRleHRfcHV0KGViLmdl
bV9jb250ZXh0KTsKPiAgIGVycl9kZXN0cm95Ogo+ICAgCWViX2Rlc3Ryb3koJmViKTsKPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5oIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5oCj4gaW5kZXggMjNjN2U0YzBjZTdjLi40
ODU4ODZkODRhNTYgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
Y29udGV4dC5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5o
Cj4gQEAgLTEyNyw2ICsxMjcsMTMgQEAgc3RhdGljIGlubGluZSB2b2lkIGludGVsX2NvbnRleHRf
cHV0KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKPiAgIAlrcmVmX3B1dCgmY2UtPnJlZiwgY2Ut
Pm9wcy0+ZGVzdHJveSk7Cj4gICB9Cj4gICAKPiArc3RhdGljIGlubGluZSB2b2lkCj4gK19faW50
ZWxfY29udGV4dF90aW1lbGluZV9sb2NrKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKPiArCV9f
YWNxdWlyZXMoJmNlLT5yaW5nLT50aW1lbGluZS0+bXV0ZXgpCj4gK3sKPiArCW11dGV4X2xvY2so
JmNlLT5yaW5nLT50aW1lbGluZS0+bXV0ZXgpOwo+ICt9Cj4gKwo+ICAgc3RhdGljIGlubGluZSBp
bnQgX19tdXN0X2NoZWNrCj4gICBpbnRlbF9jb250ZXh0X3RpbWVsaW5lX2xvY2soc3RydWN0IGlu
dGVsX2NvbnRleHQgKmNlKQo+ICAgCV9fYWNxdWlyZXMoJmNlLT5yaW5nLT50aW1lbGluZS0+bXV0
ZXgpCj4gCgpCdXQgcGFzc2FibGUuCgpSZXZpZXdlZC1ieTogVHZydGtvIFVyc3VsaW4gPHR2cnRr
by51cnN1bGluQGludGVsLmNvbT4KClJlZ2FyZHMsCgpUdnJ0a28KX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRl
bC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
L21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 297C5DCC03
	for <lists+intel-gfx@lfdr.de>; Fri, 18 Oct 2019 18:56:16 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3EF5F6EB76;
	Fri, 18 Oct 2019 16:56:14 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga05.intel.com (mga05.intel.com [192.55.52.43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 795C66EB73
 for <intel-gfx@lists.freedesktop.org>; Fri, 18 Oct 2019 16:56:09 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga001.jf.intel.com ([10.7.209.18])
 by fmsmga105.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 18 Oct 2019 09:56:09 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.67,312,1566889200"; d="scan'208";a="280283262"
Received: from lgrafter-mobl2.ger.corp.intel.com (HELO
 mwahaha-bdw.ger.corp.intel.com) ([10.252.29.114])
 by orsmga001.jf.intel.com with ESMTP; 18 Oct 2019 09:56:07 -0700
From: Matthew Auld <matthew.auld@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 18 Oct 2019 17:55:56 +0100
Message-Id: <20191018165558.18518-4-matthew.auld@intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20191018165558.18518-1-matthew.auld@intel.com>
References: <20191018165558.18518-1-matthew.auld@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 4/6] drm/i915/selftests: add write-dword test
 for LMEM
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

U2ltcGxlIHRlc3Qgd3JpdGluZyB0byBkd29yZHMgYWNyb3NzIGFuIG9iamVjdCwgdXNpbmcgdmFy
aW91cyBlbmdpbmVzIGluCmEgcmFuZG9taXplZCBvcmRlciwgY2hlY2tpbmcgdGhhdCBvdXIgd3Jp
dGVzIGxhbmQgZnJvbSB0aGUgY3B1LgoKU2lnbmVkLW9mZi1ieTogTWF0dGhldyBBdWxkIDxtYXR0
aGV3LmF1bGRAaW50ZWwuY29tPgotLS0KIC4uLi9kcm0vaTkxNS9zZWxmdGVzdHMvaW50ZWxfbWVt
b3J5X3JlZ2lvbi5jICB8IDE2NyArKysrKysrKysrKysrKysrKysKIDEgZmlsZSBjaGFuZ2VkLCAx
NjcgaW5zZXJ0aW9ucygrKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0
ZXN0cy9pbnRlbF9tZW1vcnlfcmVnaW9uLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVz
dHMvaW50ZWxfbWVtb3J5X3JlZ2lvbi5jCmluZGV4IDI5MjQ4OTM3MTg0Mi4uOGEyZDFiZGVkNDdi
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaW50ZWxfbWVtb3J5
X3JlZ2lvbi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pbnRlbF9tZW1v
cnlfcmVnaW9uLmMKQEAgLTcsMTMgKzcsMTYgQEAKIAogI2luY2x1ZGUgIi4uL2k5MTVfc2VsZnRl
c3QuaCIKIAorCiAjaW5jbHVkZSAibW9ja19kcm0uaCIKICNpbmNsdWRlICJtb2NrX2dlbV9kZXZp
Y2UuaCIKICNpbmNsdWRlICJtb2NrX3JlZ2lvbi5oIgogCisjaW5jbHVkZSAiZ2VtL2k5MTVfZ2Vt
X2NvbnRleHQuaCIKICNpbmNsdWRlICJnZW0vaTkxNV9nZW1fbG1lbS5oIgogI2luY2x1ZGUgImdl
bS9pOTE1X2dlbV9yZWdpb24uaCIKICNpbmNsdWRlICJnZW0vaTkxNV9nZW1fb2JqZWN0X2JsdC5o
IgorI2luY2x1ZGUgImdlbS9zZWxmdGVzdHMvaWd0X2dlbV91dGlscy5oIgogI2luY2x1ZGUgImdl
bS9zZWxmdGVzdHMvbW9ja19jb250ZXh0LmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfZ3QuaCIKICNp
bmNsdWRlICJzZWxmdGVzdHMvaWd0X2ZsdXNoX3Rlc3QuaCIKQEAgLTI1Niw2ICsyNTksMTI1IEBA
IHN0YXRpYyBpbnQgaWd0X21vY2tfY29udGlndW91cyh2b2lkICphcmcpCiAJcmV0dXJuIGVycjsK
IH0KIAorc3RhdGljIGludCBpZ3RfZ3B1X3dyaXRlX2R3KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpj
ZSwKKwkJCSAgICBzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKKwkJCSAgICB1MzIgZHdvcmQsCisJCQkg
ICAgdTMyIHZhbHVlKQoreworCXJldHVybiBpZ3RfZ3B1X2ZpbGxfZHcoY2UsIHZtYSwgZHdvcmQg
KiBzaXplb2YodTMyKSwKKwkJCSAgICAgICB2bWEtPnNpemUgPj4gUEFHRV9TSElGVCwgdmFsdWUp
OworfQorCitzdGF0aWMgaW50IGlndF9jcHVfY2hlY2soc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iaiwgdTMyIGR3b3JkLCB1MzIgdmFsKQoreworCXVuc2lnbmVkIGxvbmcgbjsKKwlpbnQg
ZXJyOworCisJaTkxNV9nZW1fb2JqZWN0X2xvY2sob2JqKTsKKwllcnIgPSBpOTE1X2dlbV9vYmpl
Y3Rfc2V0X3RvX3djX2RvbWFpbihvYmosIGZhbHNlKTsKKwlpOTE1X2dlbV9vYmplY3RfdW5sb2Nr
KG9iaik7CisJaWYgKGVycikKKwkJcmV0dXJuIGVycjsKKworCWVyciA9IGk5MTVfZ2VtX29iamVj
dF9waW5fcGFnZXMob2JqKTsKKwlpZiAoZXJyKQorCQlyZXR1cm4gZXJyOworCisJZm9yIChuID0g
MDsgbiA8IG9iai0+YmFzZS5zaXplID4+IFBBR0VfU0hJRlQ7ICsrbikgeworCQl1MzIgX19pb21l
bSAqYmFzZTsKKwkJdTMyIHJlYWRfdmFsOworCisJCWJhc2UgPSBpOTE1X2dlbV9vYmplY3RfbG1l
bV9pb19tYXBfcGFnZV9hdG9taWMob2JqLCBuKTsKKworCQlyZWFkX3ZhbCA9IGlvcmVhZDMyKGJh
c2UgKyBkd29yZCk7CisJCWlvX21hcHBpbmdfdW5tYXBfYXRvbWljKGJhc2UpOworCQlpZiAocmVh
ZF92YWwgIT0gdmFsKSB7CisJCQlwcl9lcnIoIm49JWx1IGJhc2VbJXVdPSV1LCB2YWw9JXVcbiIs
CisJCQkgICAgICAgbiwgZHdvcmQsIHJlYWRfdmFsLCB2YWwpOworCQkJZXJyID0gLUVJTlZBTDsK
KwkJCWJyZWFrOworCQl9CisJfQorCisJaTkxNV9nZW1fb2JqZWN0X3VucGluX3BhZ2VzKG9iaik7
CisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIGludCBpZ3RfZ3B1X3dyaXRlKHN0cnVjdCBpOTE1
X2dlbV9jb250ZXh0ICpjdHgsCisJCQkgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikK
K3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGN0eC0+aTkxNTsKKwlzdHJ1Y3Qg
aTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9IGN0eC0+dm0gPzogJmk5MTUtPmdndHQudm07CisJc3Ry
dWN0IGk5MTVfZ2VtX2VuZ2luZXMgKmVuZ2luZXM7CisJc3RydWN0IGk5MTVfZ2VtX2VuZ2luZXNf
aXRlciBpdDsKKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7CisJSTkxNV9STkRfU1RBVEUocHJu
Zyk7CisJSUdUX1RJTUVPVVQoZW5kX3RpbWUpOworCXVuc2lnbmVkIGludCBjb3VudDsKKwlzdHJ1
Y3QgaTkxNV92bWEgKnZtYTsKKwlpbnQgKm9yZGVyOworCWludCBpLCBuOworCWludCBlcnIgPSAw
OworCisJR0VNX0JVR19PTighaTkxNV9nZW1fb2JqZWN0X2hhc19waW5uZWRfcGFnZXMob2JqKSk7
CisKKwluID0gMDsKKwljb3VudCA9IDA7CisJZm9yX2VhY2hfZ2VtX2VuZ2luZShjZSwgaTkxNV9n
ZW1fY29udGV4dF9sb2NrX2VuZ2luZXMoY3R4KSwgaXQpIHsKKwkJY291bnQrKzsKKwkJaWYgKCFp
bnRlbF9lbmdpbmVfY2FuX3N0b3JlX2R3b3JkKGNlLT5lbmdpbmUpKQorCQkJY29udGludWU7CisK
KwkJbisrOworCX0KKwlpOTE1X2dlbV9jb250ZXh0X3VubG9ja19lbmdpbmVzKGN0eCk7CisJaWYg
KCFuKQorCQlyZXR1cm4gMDsKKworCW9yZGVyID0gaTkxNV9yYW5kb21fb3JkZXIoY291bnQgKiBj
b3VudCwgJnBybmcpOworCWlmICghb3JkZXIpCisJCXJldHVybiAtRU5PTUVNOworCisJdm1hID0g
aTkxNV92bWFfaW5zdGFuY2Uob2JqLCB2bSwgTlVMTCk7CisJaWYgKElTX0VSUih2bWEpKSB7CisJ
CWVyciA9IFBUUl9FUlIodm1hKTsKKwkJZ290byBvdXRfZnJlZTsKKwl9CisKKwllcnIgPSBpOTE1
X3ZtYV9waW4odm1hLCAwLCAwLCBQSU5fVVNFUik7CisJaWYgKGVycikKKwkJZ290byBvdXRfZnJl
ZTsKKworCWkgPSAwOworCWVuZ2luZXMgPSBpOTE1X2dlbV9jb250ZXh0X2xvY2tfZW5naW5lcyhj
dHgpOworCWRvIHsKKwkJdTMyIHJuZyA9IHByYW5kb21fdTMyX3N0YXRlKCZwcm5nKTsKKwkJdTMy
IGR3b3JkID0gb2Zmc2V0X2luX3BhZ2Uocm5nKSAvIDQ7CisKKwkJY2UgPSBlbmdpbmVzLT5lbmdp
bmVzW29yZGVyW2ldICUgZW5naW5lcy0+bnVtX2VuZ2luZXNdOworCQlpID0gKGkgKyAxKSAlIChj
b3VudCAqIGNvdW50KTsKKwkJaWYgKCFjZSB8fCAhaW50ZWxfZW5naW5lX2Nhbl9zdG9yZV9kd29y
ZChjZS0+ZW5naW5lKSkKKwkJCWNvbnRpbnVlOworCisJCWVyciA9IGlndF9ncHVfd3JpdGVfZHco
Y2UsIHZtYSwgZHdvcmQsIHJuZyk7CisJCWlmIChlcnIpCisJCQlicmVhazsKKworCQllcnIgPSBp
Z3RfY3B1X2NoZWNrKG9iaiwgZHdvcmQsIHJuZyk7CisJCWlmIChlcnIpCisJCQlicmVhazsKKwl9
IHdoaWxlICghX19pZ3RfdGltZW91dChlbmRfdGltZSwgTlVMTCkpOworCWk5MTVfZ2VtX2NvbnRl
eHRfdW5sb2NrX2VuZ2luZXMoY3R4KTsKKworb3V0X2ZyZWU6CisJa2ZyZWUob3JkZXIpOworCisJ
aWYgKGVyciA9PSAtRU5PTUVNKQorCQllcnIgPSAwOworCisJcmV0dXJuIGVycjsKK30KKwogc3Rh
dGljIGludCBpZ3RfbG1lbV9jcmVhdGUodm9pZCAqYXJnKQogewogCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gYXJnOwpAQCAtMjc3LDYgKzM5OSw1MCBAQCBzdGF0aWMgaW50IGlndF9s
bWVtX2NyZWF0ZSh2b2lkICphcmcpCiAJcmV0dXJuIGVycjsKIH0KIAorc3RhdGljIGludCBpZ3Rf
bG1lbV93cml0ZV9ncHUodm9pZCAqYXJnKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gYXJnOworCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CisJc3RydWN0IGk5
MTVfZ2VtX2NvbnRleHQgKmN0eDsKKwlzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGU7CisJSTkxNV9STkRf
U1RBVEUocHJuZyk7CisJdTMyIHN6OworCWludCBlcnI7CisKKwlmaWxlID0gbW9ja19maWxlKGk5
MTUpOworCWlmIChJU19FUlIoZmlsZSkpCisJCXJldHVybiBQVFJfRVJSKGZpbGUpOworCisJY3R4
ID0gbGl2ZV9jb250ZXh0KGk5MTUsIGZpbGUpOworCWlmIChJU19FUlIoY3R4KSkgeworCQllcnIg
PSBQVFJfRVJSKGN0eCk7CisJCWdvdG8gb3V0X2ZpbGU7CisJfQorCisJc3ogPSByb3VuZF91cChw
cmFuZG9tX3UzMl9zdGF0ZSgmcHJuZykgJSBTWl8zMk0sIFBBR0VfU0laRSk7CisKKwlvYmogPSBp
OTE1X2dlbV9vYmplY3RfY3JlYXRlX2xtZW0oaTkxNSwgc3osIDApOworCWlmIChJU19FUlIob2Jq
KSkgeworCQllcnIgPSBQVFJfRVJSKG9iaik7CisJCWdvdG8gb3V0X2ZpbGU7CisJfQorCisJZXJy
ID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9wYWdlcyhvYmopOworCWlmIChlcnIpCisJCWdvdG8gb3V0
X3B1dDsKKworCWVyciA9IGlndF9ncHVfd3JpdGUoY3R4LCBvYmopOworCWlmIChlcnIpCisJCXBy
X2VycigiaWd0X2dwdV93cml0ZSBmYWlsZWQoJWQpXG4iLCBlcnIpOworCisJaTkxNV9nZW1fb2Jq
ZWN0X3VucGluX3BhZ2VzKG9iaik7CitvdXRfcHV0OgorCWk5MTVfZ2VtX29iamVjdF9wdXQob2Jq
KTsKK291dF9maWxlOgorCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUpOworCXJldHVybiBlcnI7
Cit9CisKIHN0YXRpYyBpbnQgaWd0X2xtZW1fd3JpdGVfY3B1KHZvaWQgKmFyZykKIHsKIAlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGFyZzsKQEAgLTQyMSw2ICs1ODcsNyBAQCBpbnQg
aW50ZWxfbWVtb3J5X3JlZ2lvbl9saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKIAlzdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVfc3VidGVzdCB0ZXN0c1tdID0gewog
CQlTVUJURVNUKGlndF9sbWVtX2NyZWF0ZSksCiAJCVNVQlRFU1QoaWd0X2xtZW1fd3JpdGVfY3B1
KSwKKwkJU1VCVEVTVChpZ3RfbG1lbV93cml0ZV9ncHUpLAogCX07CiAKIAlpZiAoIUhBU19MTUVN
KGk5MTUpKSB7Ci0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVk
ZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZv
L2ludGVsLWdmeA==

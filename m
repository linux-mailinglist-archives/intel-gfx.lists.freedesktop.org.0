Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id BB3D4C8723
	for <lists+intel-gfx@lfdr.de>; Wed,  2 Oct 2019 13:22:03 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id DF3636E942;
	Wed,  2 Oct 2019 11:22:00 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 565ED6E93D
 for <intel-gfx@lists.freedesktop.org>; Wed,  2 Oct 2019 11:21:59 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18692016-1500050 
 for multiple; Wed, 02 Oct 2019 12:20:04 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed,  2 Oct 2019 12:19:31 +0100
Message-Id: <20191002112000.12280-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 01/30] drm/i915/selftests: Exercise potential
 false lite-restore
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

SWYgZXhlY2xpc3RzJ3MgbGl0ZS1yZXN0b3JlIGlzIGJhc2VkIG9uIHRoZSBjb21tb24gR0VNIGNv
bnRleHQgdGFnCnJhdGhlciB0aGFuIHRoZSBwZXItaW50ZWxfY29udGV4dCBMUkNBLCB0aGVuIGEg
Y29udGV4dCBzd2l0Y2ggYmV0d2Vlbgp0d28gaW50ZWxfY29udGV4dHMgb24gdGhlIHNhbWUgZW5n
aW5lIGRlcml2ZWQgZnJvbSB0aGUgc2FtZSBHRU0gY29udGV4dAp3aWxsIHBlcmZvcm0gYSBsaXRl
LXJlc3RvcmUgaW5zdGVhZCBvZiBhIGZ1bGwgY29udGV4dCBzd2l0Y2guIFdlIGNhbgpleHBsb2l0
IHRoaXMgYnkgcG9pc29uaW5nIHRoZSByaW5nYnVmZmVyIG9mIHRoZSBmaXJzdCBjb250ZXh0IGFu
ZCB0cnlpbmcKdG8gdHJpY2sgYSBzaW1wbGUgUklOR19UQUlMIHVwZGF0ZSAoaS5lLiBsaXRlLXJl
c3RvcmUpCgp2MjogQWxzbyBjaGVjayB3aGF0IGhhcHBlbnMgaWYgcHJlZW1wdCBjZVswXSB3aXRo
IGNlWzFdIChib3RoIGluc3RhbmNlcwpvbiB0aGUgc2FtZSBlbmdpbmUgZnJvbSB0aGUgc2FtZSBw
YXJlbnQgY29udGV4dCkgW1R2cnRrb10KClNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hy
aXNAY2hyaXMtd2lsc29uLmNvLnVrPgpDYzogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGlu
QGludGVsLmNvbT4KUmV2aWV3ZWQtYnk6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBp
bnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMgICAgfCAg
MTggKystCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYyB8IDE4NCArKysr
KysrKysrKysrKysrKysrKysrKysrCiAyIGZpbGVzIGNoYW5nZWQsIDE5OCBpbnNlcnRpb25zKCsp
LCA0IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2xyYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKaW5kZXggOTg3
N2I2YmExM2RmLi40MzFkM2I4YzMzNzEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2xyYy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5j
CkBAIC0yMzUsNiArMjM1LDE2IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19pbml0X3JlZ19zdGF0
ZSh1MzIgKnJlZ19zdGF0ZSwKIAkJCQkgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9yaW5nICpyaW5n
LAogCQkJCSAgICAgYm9vbCBjbG9zZSk7CiAKK3N0YXRpYyB2b2lkIF9fY29udGV4dF9waW5fYWNx
dWlyZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCit7CisJbXV0ZXhfYWNxdWlyZSgmY2UtPnBp
bl9tdXRleC5kZXBfbWFwLCAyLCAwLCBfUkVUX0lQXyk7Cit9CisKK3N0YXRpYyB2b2lkIF9fY29u
dGV4dF9waW5fcmVsZWFzZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCit7CisJbXV0ZXhfcmVs
ZWFzZSgmY2UtPnBpbl9tdXRleC5kZXBfbWFwLCAwLCBfUkVUX0lQXyk7Cit9CisKIHN0YXRpYyB2
b2lkIG1hcmtfZWlvKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogewogCWlmICghaTkxNV9yZXF1
ZXN0X3NpZ25hbGVkKHJxKSkKQEAgLTI3NjEsNyArMjc3MSw3IEBAIHN0YXRpYyB2b2lkIF9fZXhl
Y2xpc3RzX3Jlc2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgYm9vbCBzdGFsbGVk
KQogCUdFTV9CVUdfT04oIWk5MTVfdm1hX2lzX3Bpbm5lZChjZS0+c3RhdGUpKTsKIAogCS8qIFBy
b2NsYWltIHdlIGhhdmUgZXhjbHVzaXZlIGFjY2VzcyB0byB0aGUgY29udGV4dCBpbWFnZSEgKi8K
LQltdXRleF9hY3F1aXJlKCZjZS0+cGluX211dGV4LmRlcF9tYXAsIDIsIDAsIF9USElTX0lQXyk7
CisJX19jb250ZXh0X3Bpbl9hY3F1aXJlKGNlKTsKIAogCXJxID0gYWN0aXZlX3JlcXVlc3QocnEp
OwogCWlmICghcnEpIHsKQEAgLTI4MjUsNyArMjgzNSw3IEBAIHN0YXRpYyB2b2lkIF9fZXhlY2xp
c3RzX3Jlc2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgYm9vbCBzdGFsbGVkKQog
CV9fZXhlY2xpc3RzX3Jlc2V0X3JlZ19zdGF0ZShjZSwgZW5naW5lKTsKIAlfX2V4ZWNsaXN0c191
cGRhdGVfcmVnX3N0YXRlKGNlLCBlbmdpbmUpOwogCWNlLT5scmNfZGVzYyB8PSBDVFhfREVTQ19G
T1JDRV9SRVNUT1JFOyAvKiBwYXJhbm9pZDogR1BVIHdhcyByZXNldCEgKi8KLQltdXRleF9yZWxl
YXNlKCZjZS0+cGluX211dGV4LmRlcF9tYXAsIDAsIF9USElTX0lQXyk7CisJX19jb250ZXh0X3Bp
bl9yZWxlYXNlKGNlKTsKIAogdW53aW5kOgogCS8qIFB1c2ggYmFjayBhbnkgaW5jb21wbGV0ZSBy
ZXF1ZXN0cyBmb3IgcmVwbGF5IGFmdGVyIHRoZSByZXNldC4gKi8KQEAgLTQ0MzksNyArNDQ0OSw3
IEBAIHZvaWQgaW50ZWxfbHJfY29udGV4dF9yZXNldChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUsCiAJCQkgICAgYm9vbCBzY3J1YikKIHsKIAlHRU1fQlVHX09OKCFpbnRlbF9jb250ZXh0
X2lzX3Bpbm5lZChjZSkpOwotCW11dGV4X2FjcXVpcmUoJmNlLT5waW5fbXV0ZXguZGVwX21hcCwg
MiwgMCwgX1RISVNfSVBfKTsKKwlfX2NvbnRleHRfcGluX2FjcXVpcmUoY2UpOwogCiAJLyoKIAkg
KiBXZSB3YW50IGEgc2ltcGxlIGNvbnRleHQgKyByaW5nIHRvIGV4ZWN1dGUgdGhlIGJyZWFkY3J1
bWIgdXBkYXRlLgpAQCAtNDQ2NSw3ICs0NDc1LDcgQEAgdm9pZCBpbnRlbF9scl9jb250ZXh0X3Jl
c2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAlpbnRlbF9yaW5nX3VwZGF0ZV9z
cGFjZShjZS0+cmluZyk7CiAKIAlfX2V4ZWNsaXN0c191cGRhdGVfcmVnX3N0YXRlKGNlLCBlbmdp
bmUpOwotCW11dGV4X3JlbGVhc2UoJmNlLT5waW5fbXV0ZXguZGVwX21hcCwgMCwgX1RISVNfSVBf
KTsKKwlfX2NvbnRleHRfcGluX3JlbGVhc2UoY2UpOwogfQogCiAjaWYgSVNfRU5BQkxFRChDT05G
SUdfRFJNX0k5MTVfU0VMRlRFU1QpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9zZWxmdGVzdF9scmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5j
CmluZGV4IDkzZjJmY2RjNDliZi4uMmRhNGZhNTE0OWNiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9zZWxmdGVzdF9scmMuYwpAQCAtNzksNiArNzksMTg4IEBAIHN0YXRpYyBpbnQgbGl2ZV9zYW5p
dHljaGVjayh2b2lkICphcmcpCiAJcmV0dXJuIGVycjsKIH0KIAorc3RhdGljIGludCBsaXZlX3Vu
bGl0ZV9yZXN0b3JlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBpbnQgcHJpbykKK3sK
KwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CisJc3RydWN0IGk5MTVfZ2VtX2NvbnRl
eHQgKmN0eDsKKwllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKKwlpbnRlbF93YWtlcmVmX3Qgd2Fr
ZXJlZjsKKwlzdHJ1Y3QgaWd0X3NwaW5uZXIgc3BpbjsKKwlpbnQgZXJyID0gLUVOT01FTTsKKwor
CS8qCisJICogQ2hlY2sgdGhhdCB3ZSBjYW4gY29ycmVjdGx5IGNvbnRleHQgc3dpdGNoIGJldHdl
ZW4gMiBpbnN0YW5jZXMKKwkgKiBvbiB0aGUgc2FtZSBlbmdpbmUgZnJvbSB0aGUgc2FtZSBwYXJl
bnQgY29udGV4dC4KKwkgKi8KKworCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgp
OworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7CisK
KwlpZiAoaWd0X3NwaW5uZXJfaW5pdCgmc3BpbiwgJmk5MTUtPmd0KSkKKwkJZ290byBlcnJfdW5s
b2NrOworCisJY3R4ID0ga2VybmVsX2NvbnRleHQoaTkxNSk7CisJaWYgKCFjdHgpCisJCWdvdG8g
ZXJyX3NwaW47CisKKwllcnIgPSAwOworCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlk
KSB7CisJCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZVsyXSA9IHt9OworCQlzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICpycVsyXTsKKwkJc3RydWN0IGlndF9saXZlX3Rlc3QgdDsKKwkJaW50IG47CisKKwkJ
aWYgKHByaW8gJiYgIWludGVsX2VuZ2luZV9oYXNfcHJlZW1wdGlvbihlbmdpbmUpKQorCQkJY29u
dGludWU7CisKKwkJaWYgKCFpbnRlbF9lbmdpbmVfY2FuX3N0b3JlX2R3b3JkKGVuZ2luZSkpCisJ
CQljb250aW51ZTsKKworCQlpZiAoaWd0X2xpdmVfdGVzdF9iZWdpbigmdCwgaTkxNSwgX19mdW5j
X18sIGVuZ2luZS0+bmFtZSkpIHsKKwkJCWVyciA9IC1FSU87CisJCQlicmVhazsKKwkJfQorCisJ
CWZvciAobiA9IDA7IG4gPCBBUlJBWV9TSVpFKGNlKTsgbisrKSB7CisJCQlzdHJ1Y3QgaW50ZWxf
Y29udGV4dCAqdG1wOworCisJCQl0bXAgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZShjdHgsIGVuZ2lu
ZSk7CisJCQlpZiAoSVNfRVJSKHRtcCkpIHsKKwkJCQllcnIgPSBQVFJfRVJSKHRtcCk7CisJCQkJ
Z290byBlcnJfY2U7CisJCQl9CisKKwkJCWVyciA9IGludGVsX2NvbnRleHRfcGluKHRtcCk7CisJ
CQlpZiAoZXJyKSB7CisJCQkJaW50ZWxfY29udGV4dF9wdXQodG1wKTsKKwkJCQlnb3RvIGVycl9j
ZTsKKwkJCX0KKworCQkJLyoKKwkJCSAqIFNldHVwIHRoZSBwYWlyIG9mIGNvbnRleHRzIHN1Y2gg
dGhhdCBpZiB3ZQorCQkJICogbGl0ZS1yZXN0b3JlIHVzaW5nIHRoZSBSSU5HX1RBSUwgZnJvbSBj
ZVsxXSBpdAorCQkJICogd2lsbCBleGVjdXRlIGdhcmJhZ2UgZnJvbSBjZVswXS0+cmluZy4KKwkJ
CSAqLworCQkJbWVtc2V0KHRtcC0+cmluZy0+dmFkZHIsCisJCQkgICAgICAgUE9JU09OX0lOVVNF
LCAvKiBJUEVIUjogMHg1YTVhNWE1YSBbaHVuZyFdICovCisJCQkgICAgICAgdG1wLT5yaW5nLT52
bWEtPnNpemUpOworCisJCQljZVtuXSA9IHRtcDsKKwkJfQorCQlHRU1fQlVHX09OKCFjZVsxXS0+
cmluZy0+c2l6ZSk7CisJCWludGVsX3JpbmdfcmVzZXQoY2VbMV0tPnJpbmcsIGNlWzFdLT5yaW5n
LT5zaXplIC8gMik7CisKKwkJbG9jYWxfYmhfZGlzYWJsZSgpOyAvKiBhcHBlYXNlIGxvY2tkZXAg
Ki8KKwkJX19jb250ZXh0X3Bpbl9hY3F1aXJlKGNlWzFdKTsKKwkJX19leGVjbGlzdHNfdXBkYXRl
X3JlZ19zdGF0ZShjZVsxXSwgZW5naW5lKTsKKwkJX19jb250ZXh0X3Bpbl9yZWxlYXNlKGNlWzFd
KTsKKwkJbG9jYWxfYmhfZW5hYmxlKCk7CisKKwkJcnFbMF0gPSBpZ3Rfc3Bpbm5lcl9jcmVhdGVf
cmVxdWVzdCgmc3BpbiwgY2VbMF0sIE1JX0FSQl9DSEVDSyk7CisJCWlmIChJU19FUlIocnFbMF0p
KSB7CisJCQllcnIgPSBQVFJfRVJSKHJxWzBdKTsKKwkJCWdvdG8gZXJyX2NlOworCQl9CisKKwkJ
aTkxNV9yZXF1ZXN0X2dldChycVswXSk7CisJCWk5MTVfcmVxdWVzdF9hZGQocnFbMF0pOworCQlH
RU1fQlVHX09OKHJxWzBdLT50YWlsID4gY2VbMV0tPnJpbmctPmVtaXQpOworCisJCWlmICghaWd0
X3dhaXRfZm9yX3NwaW5uZXIoJnNwaW4sIHJxWzBdKSkgeworCQkJaTkxNV9yZXF1ZXN0X3B1dChy
cVswXSk7CisJCQlnb3RvIGVycl9jZTsKKwkJfQorCisJCXJxWzFdID0gaTkxNV9yZXF1ZXN0X2Ny
ZWF0ZShjZVsxXSk7CisJCWlmIChJU19FUlIocnFbMV0pKSB7CisJCQllcnIgPSBQVFJfRVJSKHJx
WzFdKTsKKwkJCWk5MTVfcmVxdWVzdF9wdXQocnFbMF0pOworCQkJZ290byBlcnJfY2U7CisJCX0K
KworCQlpZiAoIXByaW8pIHsKKwkJCS8qCisJCQkgKiBFbnN1cmUgd2UgZG8gdGhlIHN3aXRjaCB0
byBjZVsxXSBvbiBjb21wbGV0aW9uLgorCQkJICoKKwkJCSAqIHJxWzBdIGlzIGFscmVhZHkgc3Vi
bWl0dGVkLCBzbyB0aGlzIHNob3VsZCByZWR1Y2UKKwkJCSAqIHRvIGEgbm8tb3AgKGEgd2FpdCBv
biBhIHJlcXVlc3Qgb24gdGhlIHNhbWUgZW5naW5lCisJCQkgKiB1c2VzIHRoZSBzdWJtaXQgZmVu
Y2UsIG5vdCB0aGUgY29tcGxldGlvbiBmZW5jZSksCisJCQkgKiBidXQgaXQgd2lsbCBpbnN0YWxs
IGEgZGVwZW5kZW5jeSBvbiBycVsxXSBmb3IgcnFbMF0KKwkJCSAqIHRoYXQgd2lsbCBwcmV2ZW50
IHRoZSBwYWlyIGJlaW5nIHJlb3JkZXJlZCBieQorCQkJICogdGltZXNsaWNpbmcuCisJCQkgKi8K
KwkJCWk5MTVfcmVxdWVzdF9hd2FpdF9kbWFfZmVuY2UocnFbMV0sICZycVswXS0+ZmVuY2UpOwor
CQl9CisKKwkJaTkxNV9yZXF1ZXN0X2dldChycVsxXSk7CisJCWk5MTVfcmVxdWVzdF9hZGQocnFb
MV0pOworCQlHRU1fVFJBQ0UoInJxWzBdOnsgaGVhZDoleCwgdGFpbDoleCB9LCBycVsxXTp7IGhl
YWQ6JXgsIHRhaWw6JXggfVxuIiwKKwkJCSAgcnFbMF0tPmhlYWQsIHJxWzBdLT50YWlsLAorCQkJ
ICBycVsxXS0+aGVhZCwgcnFbMV0tPnRhaWwpOworCQlHRU1fQlVHX09OKHJxWzFdLT50YWlsIDw9
IHJxWzBdLT50YWlsKTsKKwkJaTkxNV9yZXF1ZXN0X3B1dChycVswXSk7CisKKwkJaWYgKHByaW8p
IHsKKwkJCXN0cnVjdCBpOTE1X3NjaGVkX2F0dHIgYXR0ciA9IHsKKwkJCQkucHJpb3JpdHkgPSBw
cmlvLAorCQkJfTsKKworCQkJLyogQWx0ZXJuYXRpdmVseSBwcmVlbXB0IHRoZSBzcGlubmVyIHdp
dGggY2VbMV0gKi8KKwkJCWVuZ2luZS0+c2NoZWR1bGUocnFbMV0sICZhdHRyKTsKKwkJfQorCisJ
CS8qIEFuZCBzd2l0Y2ggYmFjayB0byBjZVswXSBmb3IgZ29vZCBtZWFzdXJlICovCisJCXJxWzBd
ID0gaTkxNV9yZXF1ZXN0X2NyZWF0ZShjZVswXSk7CisJCWlmIChJU19FUlIocnFbMF0pKSB7CisJ
CQllcnIgPSBQVFJfRVJSKHJxWzBdKTsKKwkJCWk5MTVfcmVxdWVzdF9wdXQocnFbMV0pOworCQkJ
Z290byBlcnJfY2U7CisJCX0KKworCQlpOTE1X3JlcXVlc3RfYXdhaXRfZG1hX2ZlbmNlKHJxWzBd
LCAmcnFbMV0tPmZlbmNlKTsKKwkJaTkxNV9yZXF1ZXN0X2FkZChycVswXSk7CisJCUdFTV9UUkFD
RSgicnFbMV06eyBoZWFkOiV4LCB0YWlsOiV4IH0sIHJxWzBdOnsgaGVhZDoleCwgdGFpbDoleCB9
XG4iLAorCQkJICBycVsxXS0+aGVhZCwgcnFbMV0tPnRhaWwsCisJCQkgIHJxWzBdLT5oZWFkLCBy
cVswXS0+dGFpbCk7CisJCUdFTV9CVUdfT04ocnFbMF0tPnRhaWwgPiBycVsxXS0+dGFpbCk7CisJ
CWk5MTVfcmVxdWVzdF9wdXQocnFbMV0pOworCitlcnJfY2U6CisJCXRhc2tsZXRfa2lsbCgmZW5n
aW5lLT5leGVjbGlzdHMudGFza2xldCk7IC8qIGZsdXNoIHN1Ym1pc3Npb24gKi8KKwkJaWd0X3Nw
aW5uZXJfZW5kKCZzcGluKTsKKwkJZm9yIChuID0gMDsgbiA8IEFSUkFZX1NJWkUoY2UpOyBuKysp
IHsKKwkJCWlmIChJU19FUlJfT1JfTlVMTChjZVtuXSkpCisJCQkJYnJlYWs7CisKKwkJCWludGVs
X2NvbnRleHRfdW5waW4oY2Vbbl0pOworCQkJaW50ZWxfY29udGV4dF9wdXQoY2Vbbl0pOworCQl9
CisKKwkJaWYgKGlndF9saXZlX3Rlc3RfZW5kKCZ0KSkKKwkJCWVyciA9IC1FSU87CisJCWlmIChl
cnIpCisJCQlicmVhazsKKwl9CisKKwlrZXJuZWxfY29udGV4dF9jbG9zZShjdHgpOworZXJyX3Nw
aW46CisJaWd0X3NwaW5uZXJfZmluaSgmc3Bpbik7CitlcnJfdW5sb2NrOgorCWludGVsX3J1bnRp
bWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKKwltdXRleF91bmxvY2soJmk5
MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBpbnQgbGl2
ZV91bmxpdGVfc3dpdGNoKHZvaWQgKmFyZykKK3sKKwlyZXR1cm4gbGl2ZV91bmxpdGVfcmVzdG9y
ZShhcmcsIDApOworfQorCitzdGF0aWMgaW50IGxpdmVfdW5saXRlX3ByZWVtcHQodm9pZCAqYXJn
KQoreworCXJldHVybiBsaXZlX3VubGl0ZV9yZXN0b3JlKGFyZywgSTkxNV9VU0VSX1BSSU9SSVRZ
KEk5MTVfUFJJT1JJVFlfTUFYKSk7Cit9CisKIHN0YXRpYyBpbnQKIGVtaXRfc2VtYXBob3JlX2No
YWluKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCBzdHJ1Y3QgaTkxNV92bWEgKnZtYSwgaW50IGlk
eCkKIHsKQEAgLTIxNzgsNiArMjM2MCw4IEBAIGludCBpbnRlbF9leGVjbGlzdHNfbGl2ZV9zZWxm
dGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7CiAJc3RhdGljIGNvbnN0IHN0
cnVjdCBpOTE1X3N1YnRlc3QgdGVzdHNbXSA9IHsKIAkJU1VCVEVTVChsaXZlX3Nhbml0eWNoZWNr
KSwKKwkJU1VCVEVTVChsaXZlX3VubGl0ZV9zd2l0Y2gpLAorCQlTVUJURVNUKGxpdmVfdW5saXRl
X3ByZWVtcHQpLAogCQlTVUJURVNUKGxpdmVfdGltZXNsaWNlX3ByZWVtcHQpLAogCQlTVUJURVNU
KGxpdmVfYnVzeXdhaXRfcHJlZW1wdCksCiAJCVNVQlRFU1QobGl2ZV9wcmVlbXB0KSwKLS0gCjIu
MjMuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50
ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBz
Oi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

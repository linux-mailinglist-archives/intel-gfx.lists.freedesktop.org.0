Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 0D189F8BB7
	for <lists+intel-gfx@lfdr.de>; Tue, 12 Nov 2019 10:29:31 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3950E6EAAD;
	Tue, 12 Nov 2019 09:29:19 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0470989EB4
 for <intel-gfx@lists.freedesktop.org>; Tue, 12 Nov 2019 09:29:16 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19170012-1500050 
 for multiple; Tue, 12 Nov 2019 09:28:57 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 12 Nov 2019 09:28:34 +0000
Message-Id: <20191112092854.869-7-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191112092854.869-1-chris@chris-wilson.co.uk>
References: <20191112092854.869-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 07/27] drm/i915: Drop GEM context as a direct
 link from i915_request
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

S2VlcCB0aGUgaW50ZWxfY29udGV4dCBhcyBiZWluZyB0aGUgcHJpbWFyeSBzdGF0ZSBmb3IgaTkx
NV9yZXF1ZXN0LCB3aXRoCnRoZSBHRU0gY29udGV4dCBhIGJhY2twb2ludGVyIGZyb20gdGhlIGxv
dyBsZXZlbCBzdGF0ZSBmb3IgdGhlIHJhcmVyCmNhc2VzIHdlIG5lZWQgY2xpZW50IGluZm9ybWF0
aW9uLiBPdXIgZ29hbCBpcyB0byByZW1vdmUgc3VjaCByZWZlcmVuY2VzCnRvIGNsaWVudHMgZnJv
bSB0aGUgYmFja2VuZCwgYW5kIGxlYXZlIHRoZSBIVyBzdWJtaXNzaW9uIGFnbm9zdGljIHRvCmNs
aWVudCBpbnRlcmZhY2VzIGFuZCBzZWxmLWNvbnRhaW5lZC4KClNpZ25lZC1vZmYtYnk6IENocmlz
IFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMgICB8IDE1ICsrLS0tLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaCAgIHwgMzggLS0tLS0tLS0tLS0tLS0tCiAuLi4v
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0X3R5cGVzLmggfCAgNyArLS0KIC4uLi9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYyAgICB8ICA4ICsrLS0KIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2JyZWFkY3J1bWJzLmMgICB8ICA0ICstCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMgICAgICAgfCAgMiArLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5oICAgICAgIHwgNDIgKysrKysrKysrKysrKysr
KysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHRfdHlwZXMuaCB8ICA1ICst
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYyAgICAgfCAgNiArLS0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jICAgICAgICAgICB8IDQ3ICsrKysr
KysrKy0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMgICAg
ICAgICB8IDQwICsrKysrKysrKy0tLS0tLS0KIC4uLi9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmlu
Z19zdWJtaXNzaW9uLmMgICB8IDEwICsrLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0
ZXN0X2xyYy5jICAgICAgICB8IDIwICsrKystLS0tCiAuLi4vZ3B1L2RybS9pOTE1L2d0L3VjL2lu
dGVsX2d1Y19zdWJtaXNzaW9uLmMgfCAgNiArLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9z
Y2hlZHVsZXIuYyAgICAgICAgICB8IDI3ICsrKysrLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2dlbS5jICAgICAgICAgICAgICAgfCAgNiArLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZ3B1X2Vycm9yLmMgICAgICAgICB8IDExICsrKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3BlcmYuYyAgICAgICAgICAgICAgfCAgNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9yZXF1ZXN0LmMgICAgICAgICAgIHwgMTggKysrLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9yZXF1ZXN0LmggICAgICAgICAgIHwgIDMgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfc2NoZWR1bGVyLmMgICAgICAgICB8ICAyICstCiAyMSBmaWxlcyBjaGFuZ2VkLCAxNjIg
aW5zZXJ0aW9ucygrKSwgMTU5IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fY29udGV4dC5jCmluZGV4IGU5NGFmYzVkYjIyZS4uYjlkYzgwZGIwODQ3IDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKQEAgLTY5LDYg
KzY5LDcgQEAKIAogI2luY2x1ZGUgPGRybS9pOTE1X2RybS5oPgogCisjaW5jbHVkZSAiZ3QvaW50
ZWxfY29udGV4dC5oIgogI2luY2x1ZGUgImd0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQuaCIKICNp
bmNsdWRlICJndC9pbnRlbF9lbmdpbmVfdXNlci5oIgogI2luY2x1ZGUgImd0L2ludGVsX2xyY19y
ZWcuaCIKQEAgLTQyMiwxNSArNDIzLDYgQEAgc3RhdGljIHZvaWQga2lsbF9jb250ZXh0KHN0cnVj
dCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCiAJc3RydWN0IGk5MTVfZ2VtX2VuZ2luZXNfaXRlciBp
dDsKIAlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7CiAKLQkvKgotCSAqIElmIHdlIGFyZSBhbHJl
YWR5IGJhbm5lZCwgaXQgd2FzIGR1ZSB0byBhIGd1aWx0eSByZXF1ZXN0IGNhdXNpbmcKLQkgKiBh
IHJlc2V0IGFuZCB0aGUgZW50aXJlIGNvbnRleHQgYmVpbmcgZXZpY3RlZCBmcm9tIHRoZSBHUFUu
Ci0JICovCi0JaWYgKGk5MTVfZ2VtX2NvbnRleHRfaXNfYmFubmVkKGN0eCkpCi0JCXJldHVybjsK
LQotCWk5MTVfZ2VtX2NvbnRleHRfc2V0X2Jhbm5lZChjdHgpOwotCiAJLyoKIAkgKiBNYXAgdGhl
IHVzZXIncyBlbmdpbmUgYmFjayB0byB0aGUgYWN0dWFsIGVuZ2luZXM7IG9uZSB2aXJ0dWFsCiAJ
ICogZW5naW5lIHdpbGwgYmUgbWFwcGVkIHRvIG11bHRpcGxlIGVuZ2luZXMsIGFuZCB1c2luZyBj
dHgtPmVuZ2luZVtdCkBAIC00NDEsNiArNDMzLDkgQEAgc3RhdGljIHZvaWQga2lsbF9jb250ZXh0
KHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCiAJZm9yX2VhY2hfZ2VtX2VuZ2luZShjZSwg
X19jb250ZXh0X2VuZ2luZXNfc3RhdGljKGN0eCksIGl0KSB7CiAJCXN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZTsKIAorCQlpZiAoaW50ZWxfY29udGV4dF9zZXRfYmFubmVkKGNlKSkKKwkJ
CWNvbnRpbnVlOworCiAJCS8qCiAJCSAqIENoZWNrIHRoZSBjdXJyZW50IGFjdGl2ZSBzdGF0ZSBv
ZiB0aGlzIGNvbnRleHQ7IGlmIHdlCiAJCSAqIGFyZSBjdXJyZW50bHkgZXhlY3V0aW5nIG9uIHRo
ZSBHUFUgd2UgbmVlZCB0byBldmljdApAQCAtMTA5Miw3ICsxMDg3LDcgQEAgc3RhdGljIHZvaWQg
c2V0X3BwZ3R0X2JhcnJpZXIodm9pZCAqZGF0YSkKIAogc3RhdGljIGludCBlbWl0X3BwZ3R0X3Vw
ZGF0ZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgdm9pZCAqZGF0YSkKIHsKLQlzdHJ1Y3QgaTkx
NV9hZGRyZXNzX3NwYWNlICp2bSA9IHJxLT5od19jb250ZXh0LT52bTsKKwlzdHJ1Y3QgaTkxNV9h
ZGRyZXNzX3NwYWNlICp2bSA9IHJxLT5jb250ZXh0LT52bTsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUgPSBycS0+ZW5naW5lOwogCXUzMiBiYXNlID0gZW5naW5lLT5tbWlvX2Jhc2U7
CiAJdTMyICpjczsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9jb250ZXh0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5o
CmluZGV4IDE4ZTUwYTc2OWE2ZS4uNjk5MzI4OTk4MDNlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmgKQEAgLTkxLDI2ICs5MSw2IEBAIHN0YXRpYyBpbmxp
bmUgdm9pZCBpOTE1X2dlbV9jb250ZXh0X2NsZWFyX3BlcnNpc3RlbmNlKHN0cnVjdCBpOTE1X2dl
bV9jb250ZXh0ICpjCiAJY2xlYXJfYml0KFVDT05URVhUX1BFUlNJU1RFTkNFLCAmY3R4LT51c2Vy
X2ZsYWdzKTsKIH0KIAotc3RhdGljIGlubGluZSBib29sIGk5MTVfZ2VtX2NvbnRleHRfaXNfYmFu
bmVkKGNvbnN0IHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCi17Ci0JcmV0dXJuIHRlc3Rf
Yml0KENPTlRFWFRfQkFOTkVELCAmY3R4LT5mbGFncyk7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgdm9p
ZCBpOTE1X2dlbV9jb250ZXh0X3NldF9iYW5uZWQoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0
eCkKLXsKLQlzZXRfYml0KENPTlRFWFRfQkFOTkVELCAmY3R4LT5mbGFncyk7Ci19Ci0KLXN0YXRp
YyBpbmxpbmUgYm9vbCBpOTE1X2dlbV9jb250ZXh0X2ZvcmNlX3NpbmdsZV9zdWJtaXNzaW9uKGNv
bnN0IHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCi17Ci0JcmV0dXJuIHRlc3RfYml0KENP
TlRFWFRfRk9SQ0VfU0lOR0xFX1NVQk1JU1NJT04sICZjdHgtPmZsYWdzKTsKLX0KLQotc3RhdGlj
IGlubGluZSB2b2lkIGk5MTVfZ2VtX2NvbnRleHRfc2V0X2ZvcmNlX3NpbmdsZV9zdWJtaXNzaW9u
KHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCi17Ci0JX19zZXRfYml0KENPTlRFWFRfRk9S
Q0VfU0lOR0xFX1NVQk1JU1NJT04sICZjdHgtPmZsYWdzKTsKLX0KLQogc3RhdGljIGlubGluZSBi
b29sCiBpOTE1X2dlbV9jb250ZXh0X3VzZXJfZW5naW5lcyhjb25zdCBzdHJ1Y3QgaTkxNV9nZW1f
Y29udGV4dCAqY3R4KQogewpAQCAtMTI5LDI0ICsxMDksNiBAQCBpOTE1X2dlbV9jb250ZXh0X2Ns
ZWFyX3VzZXJfZW5naW5lcyhzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQogCWNsZWFyX2Jp
dChDT05URVhUX1VTRVJfRU5HSU5FUywgJmN0eC0+ZmxhZ3MpOwogfQogCi1zdGF0aWMgaW5saW5l
IGJvb2wKLWk5MTVfZ2VtX2NvbnRleHRfbm9wcmVlbXB0KGNvbnN0IHN0cnVjdCBpOTE1X2dlbV9j
b250ZXh0ICpjdHgpCi17Ci0JcmV0dXJuIHRlc3RfYml0KENPTlRFWFRfTk9QUkVFTVBULCAmY3R4
LT5mbGFncyk7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgdm9pZAotaTkxNV9nZW1fY29udGV4dF9zZXRf
bm9wcmVlbXB0KHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCi17Ci0Jc2V0X2JpdChDT05U
RVhUX05PUFJFRU1QVCwgJmN0eC0+ZmxhZ3MpOwotfQotCi1zdGF0aWMgaW5saW5lIHZvaWQKLWk5
MTVfZ2VtX2NvbnRleHRfY2xlYXJfbm9wcmVlbXB0KHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpj
dHgpCi17Ci0JY2xlYXJfYml0KENPTlRFWFRfTk9QUkVFTVBULCAmY3R4LT5mbGFncyk7Ci19Ci0K
IHN0YXRpYyBpbmxpbmUgYm9vbCBpOTE1X2dlbV9jb250ZXh0X2lzX2tlcm5lbChzdHJ1Y3QgaTkx
NV9nZW1fY29udGV4dCAqY3R4KQogewogCXJldHVybiAhY3R4LT5maWxlX3ByaXY7CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dF90eXBlcy5oIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaAppbmRleCA2
OWRmNTQ1OWMzNTAuLjAxN2NhODAzYWI0NyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fY29udGV4dF90eXBlcy5oCkBAIC0xMzQsMTEgKzEzNCw4IEBAIHN0cnVj
dCBpOTE1X2dlbV9jb250ZXh0IHsKIAkgKiBAZmxhZ3M6IHNtYWxsIHNldCBvZiBib29sZWFucwog
CSAqLwogCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Ci0jZGVmaW5lIENPTlRFWFRfQkFOTkVECQkJMAot
I2RlZmluZSBDT05URVhUX0NMT1NFRAkJCTEKLSNkZWZpbmUgQ09OVEVYVF9GT1JDRV9TSU5HTEVf
U1VCTUlTU0lPTgkyCi0jZGVmaW5lIENPTlRFWFRfVVNFUl9FTkdJTkVTCQkzCi0jZGVmaW5lIENP
TlRFWFRfTk9QUkVFTVBUCQk0CisjZGVmaW5lIENPTlRFWFRfQ0xPU0VECQkJMAorI2RlZmluZSBD
T05URVhUX1VTRVJfRU5HSU5FUwkJMQogCiAJc3RydWN0IG11dGV4IG11dGV4OwogCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYwppbmRleCA1ZGJmZWRl
YjBhNmYuLmRmZjVjMDE4MGJmMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX2V4ZWNidWZmZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fZXhlY2J1ZmZlci5jCkBAIC03NDUsOSArNzQ1LDYgQEAgc3RhdGljIGludCBlYl9sb29r
dXBfdm1hcyhzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYikKIAl1bnNpZ25lZCBpbnQgaSwgYmF0
Y2g7CiAJaW50IGVycjsKIAotCWlmICh1bmxpa2VseShpOTE1X2dlbV9jb250ZXh0X2lzX2Jhbm5l
ZChlYi0+Z2VtX2NvbnRleHQpKSkKLQkJcmV0dXJuIC1FSU87Ci0KIAlJTklUX0xJU1RfSEVBRCgm
ZWItPnJlbG9jcyk7CiAJSU5JVF9MSVNUX0hFQUQoJmViLT51bmJvdW5kKTsKIApAQCAtMjA1MCw3
ICsyMDQ3LDcgQEAgc3RhdGljIGludCBlYl9zdWJtaXQoc3RydWN0IGk5MTVfZXhlY2J1ZmZlciAq
ZWIpCiAJaWYgKGVycikKIAkJcmV0dXJuIGVycjsKIAotCWlmIChpOTE1X2dlbV9jb250ZXh0X25v
cHJlZW1wdChlYi0+Z2VtX2NvbnRleHQpKQorCWlmIChpbnRlbF9jb250ZXh0X25vcHJlZW1wdChl
Yi0+Y29udGV4dCkpCiAJCWViLT5yZXF1ZXN0LT5mbGFncyB8PSBJOTE1X1JFUVVFU1RfTk9QUkVF
TVBUOwogCiAJcmV0dXJuIDA7CkBAIC0yMTM2LDYgKzIxMzMsOSBAQCBzdGF0aWMgaW50IF9fZWJf
cGluX2VuZ2luZShzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYiwgc3RydWN0IGludGVsX2NvbnRl
eHQgKmNlKQogCWlmIChlcnIpCiAJCXJldHVybiBlcnI7CiAKKwlpZiAodW5saWtlbHkoaW50ZWxf
Y29udGV4dF9pc19iYW5uZWQoY2UpKSkKKwkJcmV0dXJuIC1FSU87CisKIAkvKgogCSAqIFBpbm5p
bmcgdGhlIGNvbnRleHRzIG1heSBnZW5lcmF0ZSByZXF1ZXN0cyBpbiBvcmRlciB0byBhY3F1aXJl
CiAJICogR0dUVCBzcGFjZSwgc28gZG8gdGhpcyBmaXJzdCBiZWZvcmUgd2UgcmVzZXJ2ZSBhIHNl
cW5vIGZvcgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfYnJlYWRj
cnVtYnMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2JyZWFkY3J1bWJzLmMKaW5k
ZXggNTUzMTcwODFkNDhiLi4yZjExYmVlNjM4ZDAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2JyZWFkY3J1bWJzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfYnJlYWRjcnVtYnMuYwpAQCAtMjcxLDcgKzI3MSw3IEBAIGJvb2wgaTkxNV9yZXF1
ZXN0X2VuYWJsZV9icmVhZGNydW1iKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogCiAJaWYgKHRl
c3RfYml0KEk5MTVfRkVOQ0VfRkxBR19BQ1RJVkUsICZycS0+ZmVuY2UuZmxhZ3MpKSB7CiAJCXN0
cnVjdCBpbnRlbF9icmVhZGNydW1icyAqYiA9ICZycS0+ZW5naW5lLT5icmVhZGNydW1iczsKLQkJ
c3RydWN0IGludGVsX2NvbnRleHQgKmNlID0gcnEtPmh3X2NvbnRleHQ7CisJCXN0cnVjdCBpbnRl
bF9jb250ZXh0ICpjZSA9IHJxLT5jb250ZXh0OwogCQlzdHJ1Y3QgbGlzdF9oZWFkICpwb3M7CiAK
IAkJc3Bpbl9sb2NrKCZiLT5pcnFfbG9jayk7CkBAIC0zMjYsNyArMzI2LDcgQEAgdm9pZCBpOTE1
X3JlcXVlc3RfY2FuY2VsX2JyZWFkY3J1bWIoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJICov
CiAJc3Bpbl9sb2NrKCZiLT5pcnFfbG9jayk7CiAJaWYgKHRlc3RfYml0KEk5MTVfRkVOQ0VfRkxB
R19TSUdOQUwsICZycS0+ZmVuY2UuZmxhZ3MpKSB7Ci0JCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpj
ZSA9IHJxLT5od19jb250ZXh0OworCQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UgPSBycS0+Y29u
dGV4dDsKIAogCQlsaXN0X2RlbCgmcnEtPnNpZ25hbF9saW5rKTsKIAkJaWYgKGxpc3RfZW1wdHko
JmNlLT5zaWduYWxzKSkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYwppbmRl
eCBlZTlkMmJjZDJjMTMuLjYyNWY3NWY3ODI1ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfY29udGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2NvbnRleHQuYwpAQCAtMzA3LDcgKzMwNyw3IEBAIGludCBpbnRlbF9jb250ZXh0X3ByZXBh
cmVfcmVtb3RlX3JlcXVlc3Qoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAogCWludCBlcnI7CiAK
IAkvKiBPbmx5IHN1aXRhYmxlIGZvciB1c2UgaW4gcmVtb3RlbHkgbW9kaWZ5aW5nIHRoaXMgY29u
dGV4dCAqLwotCUdFTV9CVUdfT04ocnEtPmh3X2NvbnRleHQgPT0gY2UpOworCUdFTV9CVUdfT04o
cnEtPmNvbnRleHQgPT0gY2UpOwogCiAJaWYgKHJjdV9hY2Nlc3NfcG9pbnRlcihycS0+dGltZWxp
bmUpICE9IHRsKSB7IC8qIHRpbWVsaW5lIHNoYXJpbmchICovCiAJCWVyciA9IG11dGV4X2xvY2tf
aW50ZXJydXB0aWJsZV9uZXN0ZWQoJnRsLT5tdXRleCwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2NvbnRleHQuaAppbmRleCA2OGIzZDMxN2Q5NTkuLjFlNjA3MzQzZDI1NiAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5oCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuaApAQCAtNyw3ICs3LDkgQEAKICNpZm5kZWYg
X19JTlRFTF9DT05URVhUX0hfXwogI2RlZmluZSBfX0lOVEVMX0NPTlRFWFRfSF9fCiAKKyNpbmNs
dWRlIDxsaW51eC9iaXRvcHMuaD4KICNpbmNsdWRlIDxsaW51eC9sb2NrZGVwLmg+CisjaW5jbHVk
ZSA8bGludXgvdHlwZXMuaD4KIAogI2luY2x1ZGUgImk5MTVfYWN0aXZlLmgiCiAjaW5jbHVkZSAi
aW50ZWxfY29udGV4dF90eXBlcy5oIgpAQCAtMTUzLDQgKzE1NSw0NCBAQCBzdGF0aWMgaW5saW5l
IHN0cnVjdCBpbnRlbF9yaW5nICpfX2ludGVsX2NvbnRleHRfcmluZ19zaXplKHU2NCBzeikKIAly
ZXR1cm4gdTY0X3RvX3B0cihzdHJ1Y3QgaW50ZWxfcmluZywgc3opOwogfQogCitzdGF0aWMgaW5s
aW5lIGJvb2wgaW50ZWxfY29udGV4dF9pc19iYW5uZWQoY29uc3Qgc3RydWN0IGludGVsX2NvbnRl
eHQgKmNlKQoreworCXJldHVybiB0ZXN0X2JpdChDT05URVhUX0JBTk5FRCwgJmNlLT5mbGFncyk7
Cit9CisKK3N0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF9jb250ZXh0X3NldF9iYW5uZWQoc3RydWN0
IGludGVsX2NvbnRleHQgKmNlKQoreworCXJldHVybiB0ZXN0X2FuZF9zZXRfYml0KENPTlRFWFRf
QkFOTkVELCAmY2UtPmZsYWdzKTsKK30KKworc3RhdGljIGlubGluZSBib29sCitpbnRlbF9jb250
ZXh0X2ZvcmNlX3NpbmdsZV9zdWJtaXNzaW9uKGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpj
ZSkKK3sKKwlyZXR1cm4gdGVzdF9iaXQoQ09OVEVYVF9GT1JDRV9TSU5HTEVfU1VCTUlTU0lPTiwg
JmNlLT5mbGFncyk7Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZAoraW50ZWxfY29udGV4dF9zZXRf
c2luZ2xlX3N1Ym1pc3Npb24oc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQoreworCV9fc2V0X2Jp
dChDT05URVhUX0ZPUkNFX1NJTkdMRV9TVUJNSVNTSU9OLCAmY2UtPmZsYWdzKTsKK30KKworc3Rh
dGljIGlubGluZSBib29sCitpbnRlbF9jb250ZXh0X25vcHJlZW1wdChjb25zdCBzdHJ1Y3QgaW50
ZWxfY29udGV4dCAqY2UpCit7CisJcmV0dXJuIHRlc3RfYml0KENPTlRFWFRfTk9QUkVFTVBULCAm
Y2UtPmZsYWdzKTsKK30KKworc3RhdGljIGlubGluZSB2b2lkCitpbnRlbF9jb250ZXh0X3NldF9u
b3ByZWVtcHQoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQoreworCXNldF9iaXQoQ09OVEVYVF9O
T1BSRUVNUFQsICZjZS0+ZmxhZ3MpOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQKK2ludGVsX2Nv
bnRleHRfY2xlYXJfbm9wcmVlbXB0KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKK3sKKwljbGVh
cl9iaXQoQ09OVEVYVF9OT1BSRUVNUFQsICZjZS0+ZmxhZ3MpOworfQorCiAjZW5kaWYgLyogX19J
TlRFTF9DT05URVhUX0hfXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfY29udGV4dF90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29u
dGV4dF90eXBlcy5oCmluZGV4IDY5NTliMDVhZTVmOC4uMDI1MWVkYzhmNTY4IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0X3R5cGVzLmgKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dF90eXBlcy5oCkBAIC01NCw3ICs1NCwx
MCBAQCBzdHJ1Y3QgaW50ZWxfY29udGV4dCB7CiAJc3RydWN0IGludGVsX3RpbWVsaW5lICp0aW1l
bGluZTsKIAogCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Ci0jZGVmaW5lIENPTlRFWFRfQUxMT0NfQklU
IDAKKyNkZWZpbmUgQ09OVEVYVF9BTExPQ19CSVQJCTAKKyNkZWZpbmUgQ09OVEVYVF9CQU5ORUQJ
CQkxCisjZGVmaW5lIENPTlRFWFRfRk9SQ0VfU0lOR0xFX1NVQk1JU1NJT04JMgorI2RlZmluZSBD
T05URVhUX05PUFJFRU1QVAkJMwogCiAJdTMyICpscmNfcmVnX3N0YXRlOwogCXU2NCBscmNfZGVz
YzsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKaW5kZXggMWY2ODcw
MGEyMzExLi5jN2RiOGJmZTE4ZjQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2VuZ2luZV9jcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2Vu
Z2luZV9jcy5jCkBAIC0xNTE3LDkgKzE1MTcsOSBAQCB2b2lkIGludGVsX2VuZ2luZV9kdW1wKHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAogCQlwcmludF9yZXF1ZXN0X3JpbmcobSwg
cnEpOwogCi0JCWlmIChycS0+aHdfY29udGV4dC0+bHJjX3JlZ19zdGF0ZSkgeworCQlpZiAocnEt
PmNvbnRleHQtPmxyY19yZWdfc3RhdGUpIHsKIAkJCWRybV9wcmludGYobSwgIkxvZ2ljYWwgUmlu
ZyBDb250ZXh0OlxuIik7Ci0JCQloZXhkdW1wKG0sIHJxLT5od19jb250ZXh0LT5scmNfcmVnX3N0
YXRlLCBQQUdFX1NJWkUpOworCQkJaGV4ZHVtcChtLCBycS0+Y29udGV4dC0+bHJjX3JlZ19zdGF0
ZSwgUEFHRV9TSVpFKTsKIAkJfQogCX0KIAlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZlbmdpbmUt
PmFjdGl2ZS5sb2NrLCBmbGFncyk7CkBAIC0xNTgwLDcgKzE1ODAsNyBAQCBpbnQgaW50ZWxfZW5h
YmxlX2VuZ2luZV9zdGF0cyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAKIAkJZm9y
IChwb3J0ID0gZXhlY2xpc3RzLT5wZW5kaW5nOyAocnEgPSAqcG9ydCk7IHBvcnQrKykgewogCQkJ
LyogRXhjbHVkZSBhbnkgY29udGV4dHMgYWxyZWFkeSBjb3VudGVkIGluIGFjdGl2ZSAqLwotCQkJ
aWYgKCFpbnRlbF9jb250ZXh0X2luZmxpZ2h0X2NvdW50KHJxLT5od19jb250ZXh0KSkKKwkJCWlm
ICghaW50ZWxfY29udGV4dF9pbmZsaWdodF9jb3VudChycS0+Y29udGV4dCkpCiAJCQkJZW5naW5l
LT5zdGF0cy5hY3RpdmUrKzsKIAkJfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9scmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCmlu
ZGV4IDMzY2UyNThkNDg0Zi4uNjc2OGZjNDE3NmYwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9scmMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9scmMuYwpAQCAtODg3LDcgKzg4Nyw3IEBAIF9fdW53aW5kX2luY29tcGxldGVfcmVxdWVzdHMo
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCQkJbGlzdF9tb3ZlKCZycS0+c2NoZWQu
bGluaywgcGwpOwogCQkJYWN0aXZlID0gcnE7CiAJCX0gZWxzZSB7Ci0JCQlzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICpvd25lciA9IHJxLT5od19jb250ZXh0LT5lbmdpbmU7CisJCQlzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICpvd25lciA9IHJxLT5jb250ZXh0LT5lbmdpbmU7CiAKIAkJCS8qCiAJCQkg
KiBEZWNvdXBsZSB0aGUgdmlydHVhbCBicmVhZGNydW1iIGJlZm9yZSBtb3ZpbmcgaXQKQEAgLTEw
NTgsNyArMTA1OCw3IEBAIHN0YXRpYyB2b2lkIHJlc3RvcmVfZGVmYXVsdF9zdGF0ZShzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqY2UsCiBzdGF0aWMgdm9pZCByZXNldF9hY3RpdmUoc3RydWN0IGk5MTVf
cmVxdWVzdCAqcnEsCiAJCQkgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewotCXN0
cnVjdCBpbnRlbF9jb250ZXh0ICogY29uc3QgY2UgPSBycS0+aHdfY29udGV4dDsKKwlzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqIGNvbnN0IGNlID0gcnEtPmNvbnRleHQ7CiAJdTMyIGhlYWQ7CiAKIAkv
KgpAQCAtMTA5OSwxMSArMTA5OSwxMSBAQCBzdGF0aWMgaW5saW5lIHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKgogX19leGVjbGlzdHNfc2NoZWR1bGVfaW4oc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEp
CiB7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqIGNvbnN0IGVuZ2luZSA9IHJxLT5lbmdpbmU7
Ci0Jc3RydWN0IGludGVsX2NvbnRleHQgKiBjb25zdCBjZSA9IHJxLT5od19jb250ZXh0OworCXN0
cnVjdCBpbnRlbF9jb250ZXh0ICogY29uc3QgY2UgPSBycS0+Y29udGV4dDsKIAogCWludGVsX2Nv
bnRleHRfZ2V0KGNlKTsKIAotCWlmICh1bmxpa2VseShpOTE1X2dlbV9jb250ZXh0X2lzX2Jhbm5l
ZChjZS0+Z2VtX2NvbnRleHQpKSkKKwlpZiAodW5saWtlbHkoaW50ZWxfY29udGV4dF9pc19iYW5u
ZWQoY2UpKSkKIAkJcmVzZXRfYWN0aXZlKHJxLCBlbmdpbmUpOwogCiAJaWYgKElTX0VOQUJMRUQo
Q09ORklHX0RSTV9JOTE1X0RFQlVHX0dFTSkpCkBAIC0xMTMxLDcgKzExMzEsNyBAQCBfX2V4ZWNs
aXN0c19zY2hlZHVsZV9pbihzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIHN0YXRpYyBpbmxpbmUg
c3RydWN0IGk5MTVfcmVxdWVzdCAqCiBleGVjbGlzdHNfc2NoZWR1bGVfaW4oc3RydWN0IGk5MTVf
cmVxdWVzdCAqcnEsIGludCBpZHgpCiB7Ci0Jc3RydWN0IGludGVsX2NvbnRleHQgKiBjb25zdCBj
ZSA9IHJxLT5od19jb250ZXh0OworCXN0cnVjdCBpbnRlbF9jb250ZXh0ICogY29uc3QgY2UgPSBy
cS0+Y29udGV4dDsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpvbGQ7CiAKIAlHRU1fQlVHX09O
KCFpbnRlbF9lbmdpbmVfcG1faXNfYXdha2UocnEtPmVuZ2luZSkpOwpAQCAtMTE2Miw3ICsxMTYy
LDcgQEAgc3RhdGljIGlubGluZSB2b2lkCiBfX2V4ZWNsaXN0c19zY2hlZHVsZV9vdXQoc3RydWN0
IGk5MTVfcmVxdWVzdCAqcnEsCiAJCQkgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqIGNvbnN0IGVu
Z2luZSkKIHsKLQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqIGNvbnN0IGNlID0gcnEtPmh3X2NvbnRl
eHQ7CisJc3RydWN0IGludGVsX2NvbnRleHQgKiBjb25zdCBjZSA9IHJxLT5jb250ZXh0OwogCiAJ
LyoKIAkgKiBOQiBwcm9jZXNzX2NzYigpIGlzIG5vdCB1bmRlciB0aGUgZW5naW5lLT5hY3RpdmUu
bG9jayBhbmQgaGVuY2UKQEAgLTExOTIsNyArMTE5Miw3IEBAIF9fZXhlY2xpc3RzX3NjaGVkdWxl
X291dChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKIHN0YXRpYyBpbmxpbmUgdm9pZAogZXhlY2xp
c3RzX3NjaGVkdWxlX291dChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIHsKLQlzdHJ1Y3QgaW50
ZWxfY29udGV4dCAqIGNvbnN0IGNlID0gcnEtPmh3X2NvbnRleHQ7CisJc3RydWN0IGludGVsX2Nv
bnRleHQgKiBjb25zdCBjZSA9IHJxLT5jb250ZXh0OwogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmN1ciwgKm9sZDsKIAogCXRyYWNlX2k5MTVfcmVxdWVzdF9vdXQocnEpOwpAQCAtMTIwOSw3ICsx
MjA5LDcgQEAgZXhlY2xpc3RzX3NjaGVkdWxlX291dChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkK
IAogc3RhdGljIHU2NCBleGVjbGlzdHNfdXBkYXRlX2NvbnRleHQoY29uc3Qgc3RydWN0IGk5MTVf
cmVxdWVzdCAqcnEpCiB7Ci0Jc3RydWN0IGludGVsX2NvbnRleHQgKmNlID0gcnEtPmh3X2NvbnRl
eHQ7CisJc3RydWN0IGludGVsX2NvbnRleHQgKmNlID0gcnEtPmNvbnRleHQ7CiAJdTY0IGRlc2M7
CiAKIAljZS0+bHJjX3JlZ19zdGF0ZVtDVFhfUklOR19UQUlMXSA9CkBAIC0xMjkxLDE5ICsxMjkx
LDE4IEBAIGFzc2VydF9wZW5kaW5nX3ZhbGlkKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfZXhl
Y2xpc3RzICpleGVjbGlzdHMsCiAJfQogCiAJZm9yIChwb3J0ID0gZXhlY2xpc3RzLT5wZW5kaW5n
OyAocnEgPSAqcG9ydCk7IHBvcnQrKykgewotCQlpZiAoY2UgPT0gcnEtPmh3X2NvbnRleHQpIHsK
KwkJaWYgKGNlID09IHJxLT5jb250ZXh0KSB7CiAJCQlHRU1fVFJBQ0VfRVJSKCJEdXAgY29udGV4
dDolbGx4IGluIHBlbmRpbmdbJXpkXVxuIiwKIAkJCQkgICAgICBjZS0+dGltZWxpbmUtPmZlbmNl
X2NvbnRleHQsCiAJCQkJICAgICAgcG9ydCAtIGV4ZWNsaXN0cy0+cGVuZGluZyk7CiAJCQlyZXR1
cm4gZmFsc2U7CiAJCX0KIAotCQljZSA9IHJxLT5od19jb250ZXh0OworCQljZSA9IHJxLT5jb250
ZXh0OwogCQlpZiAoaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChycSkpCiAJCQljb250aW51ZTsKIAot
CQlpZiAoaTkxNV9hY3RpdmVfaXNfaWRsZSgmY2UtPmFjdGl2ZSkgJiYKLQkJICAgICFpOTE1X2dl
bV9jb250ZXh0X2lzX2tlcm5lbChjZS0+Z2VtX2NvbnRleHQpKSB7CisJCWlmIChpOTE1X2FjdGl2
ZV9pc19pZGxlKCZjZS0+YWN0aXZlKSAmJiBjZS0+Z2VtX2NvbnRleHQpIHsKIAkJCUdFTV9UUkFD
RV9FUlIoIkluYWN0aXZlIGNvbnRleHQ6JWxseCBpbiBwZW5kaW5nWyV6ZF1cbiIsCiAJCQkJICAg
ICAgY2UtPnRpbWVsaW5lLT5mZW5jZV9jb250ZXh0LAogCQkJCSAgICAgIHBvcnQgLSBleGVjbGlz
dHMtPnBlbmRpbmcpOwpAQCAtMTM2Nyw3ICsxMzY2LDcgQEAgc3RhdGljIHZvaWQgZXhlY2xpc3Rz
X3N1Ym1pdF9wb3J0cyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiBzdGF0aWMgYm9v
bCBjdHhfc2luZ2xlX3BvcnRfc3VibWlzc2lvbihjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAq
Y2UpCiB7CiAJcmV0dXJuIChJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9HVlQpICYmCi0JCWk5
MTVfZ2VtX2NvbnRleHRfZm9yY2Vfc2luZ2xlX3N1Ym1pc3Npb24oY2UtPmdlbV9jb250ZXh0KSk7
CisJCWludGVsX2NvbnRleHRfZm9yY2Vfc2luZ2xlX3N1Ym1pc3Npb24oY2UpKTsKIH0KIAogc3Rh
dGljIGJvb2wgY2FuX21lcmdlX2N0eChjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqcHJldiwK
QEAgLTE0MDMsNyArMTQwMiw3IEBAIHN0YXRpYyBib29sIGNhbl9tZXJnZV9ycShjb25zdCBzdHJ1
Y3QgaTkxNV9yZXF1ZXN0ICpwcmV2LAogCQkgICAgIChJOTE1X1JFUVVFU1RfTk9QUkVFTVBUIHwg
STkxNV9SRVFVRVNUX1NFTlRJTkVMKSkpCiAJCXJldHVybiBmYWxzZTsKIAotCWlmICghY2FuX21l
cmdlX2N0eChwcmV2LT5od19jb250ZXh0LCBuZXh0LT5od19jb250ZXh0KSkKKwlpZiAoIWNhbl9t
ZXJnZV9jdHgocHJldi0+Y29udGV4dCwgbmV4dC0+Y29udGV4dCkpCiAJCXJldHVybiBmYWxzZTsK
IAogCXJldHVybiB0cnVlOwpAQCAtMTU5MCw3ICsxNTg5LDcgQEAgc3RhdGljIHVuc2lnbmVkIGxv
bmcgYWN0aXZlX3ByZWVtcHRfdGltZW91dChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUp
CiAJCXJldHVybiAwOwogCiAJLyogRm9yY2UgYSBmYXN0IHJlc2V0IGZvciB0ZXJtaW5hdGVkIGNv
bnRleHRzIChpZ25vcmluZyBzeXNmcyEpICovCi0JaWYgKHVubGlrZWx5KGk5MTVfZ2VtX2NvbnRl
eHRfaXNfYmFubmVkKHJxLT5nZW1fY29udGV4dCkpKQorCWlmICh1bmxpa2VseShpbnRlbF9jb250
ZXh0X2lzX2Jhbm5lZChycS0+Y29udGV4dCkpKQogCQlyZXR1cm4gMTsKIAogCXJldHVybiBSRUFE
X09OQ0UoZW5naW5lLT5wcm9wcy5wcmVlbXB0X3RpbWVvdXRfbXMpOwpAQCAtMTY5OCw3ICsxNjk3
LDcgQEAgc3RhdGljIHZvaWQgZXhlY2xpc3RzX2RlcXVldWUoc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lKQogCQkJICogdGVuZGVuY3kgdG8gaWdub3JlIHVzIHJld2luZGluZyB0aGUgVEFJ
TCB0byB0aGUKIAkJCSAqIGVuZCBvZiBhbiBlYXJsaWVyIHJlcXVlc3QuCiAJCQkgKi8KLQkJCWxh
c3QtPmh3X2NvbnRleHQtPmxyY19kZXNjIHw9IENUWF9ERVNDX0ZPUkNFX1JFU1RPUkU7CisJCQls
YXN0LT5jb250ZXh0LT5scmNfZGVzYyB8PSBDVFhfREVTQ19GT1JDRV9SRVNUT1JFOwogCQkJbGFz
dCA9IE5VTEw7CiAJCX0gZWxzZSBpZiAobmVlZF90aW1lc2xpY2UoZW5naW5lLCBsYXN0KSAmJgog
CQkJICAgdGltZXJfZXhwaXJlZCgmZW5naW5lLT5leGVjbGlzdHMudGltZXIpKSB7CkBAIC0xNzgw
LDcgKzE3NzksNyBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfZGVxdWV1ZShzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUpCiAKIAkJR0VNX0JVR19PTihycSAhPSB2ZS0+cmVxdWVzdCk7CiAJ
CUdFTV9CVUdfT04ocnEtPmVuZ2luZSAhPSAmdmUtPmJhc2UpOwotCQlHRU1fQlVHX09OKHJxLT5o
d19jb250ZXh0ICE9ICZ2ZS0+Y29udGV4dCk7CisJCUdFTV9CVUdfT04ocnEtPmNvbnRleHQgIT0g
JnZlLT5jb250ZXh0KTsKIAogCQlpZiAocnFfcHJpbyhycSkgPj0gcXVldWVfcHJpbyhleGVjbGlz
dHMpKSB7CiAJCQlpZiAoIXZpcnR1YWxfbWF0Y2hlcyh2ZSwgcnEsIGVuZ2luZSkpIHsKQEAgLTE4
OTksNyArMTg5OCw3IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19kZXF1ZXVlKHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSkKIAkJCQkgKiBzYW1lIExSQ0EsIGkuZS4gd2UgbXVzdCBzdWJt
aXQgMiBkaWZmZXJlbnQKIAkJCQkgKiBjb250ZXh0cyBpZiB3ZSBzdWJtaXQgMiBFTFNQLgogCQkJ
CSAqLwotCQkJCWlmIChsYXN0LT5od19jb250ZXh0ID09IHJxLT5od19jb250ZXh0KQorCQkJCWlm
IChsYXN0LT5jb250ZXh0ID09IHJxLT5jb250ZXh0KQogCQkJCQlnb3RvIGRvbmU7CiAKIAkJCQlp
ZiAoaTkxNV9yZXF1ZXN0X2hhc19zZW50aW5lbChsYXN0KSkKQEAgLTE5MTIsOCArMTkxMSw4IEBA
IHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19kZXF1ZXVlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSkKIAkJCQkgKiB0aGUgc2FtZSBjb250ZXh0IChldmVuIHRob3VnaCBhIGRpZmZlcmVudAog
CQkJCSAqIHJlcXVlc3QpIHRvIHRoZSBzZWNvbmQgcG9ydC4KIAkJCQkgKi8KLQkJCQlpZiAoY3R4
X3NpbmdsZV9wb3J0X3N1Ym1pc3Npb24obGFzdC0+aHdfY29udGV4dCkgfHwKLQkJCQkgICAgY3R4
X3NpbmdsZV9wb3J0X3N1Ym1pc3Npb24ocnEtPmh3X2NvbnRleHQpKQorCQkJCWlmIChjdHhfc2lu
Z2xlX3BvcnRfc3VibWlzc2lvbihsYXN0LT5jb250ZXh0KSB8fAorCQkJCSAgICBjdHhfc2luZ2xl
X3BvcnRfc3VibWlzc2lvbihycS0+Y29udGV4dCkpCiAJCQkJCWdvdG8gZG9uZTsKIAogCQkJCW1l
cmdlID0gZmFsc2U7CkBAIC0xOTI3LDggKzE5MjYsOCBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNf
ZGVxdWV1ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJCQkJfQogCiAJCQkJR0VN
X0JVR19PTihsYXN0ICYmCi0JCQkJCSAgICFjYW5fbWVyZ2VfY3R4KGxhc3QtPmh3X2NvbnRleHQs
Ci0JCQkJCQkJICBycS0+aHdfY29udGV4dCkpOworCQkJCQkgICAhY2FuX21lcmdlX2N0eChsYXN0
LT5jb250ZXh0LAorCQkJCQkJCSAgcnEtPmNvbnRleHQpKTsKIAogCQkJCXN1Ym1pdCA9IHRydWU7
CiAJCQkJbGFzdCA9IHJxOwpAQCAtMjU0Miw3ICsyNTQxLDcgQEAgc3RhdGljIGludCBleGVjbGlz
dHNfcmVxdWVzdF9hbGxvYyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0KQogewogCWludCBy
ZXQ7CiAKLQlHRU1fQlVHX09OKCFpbnRlbF9jb250ZXh0X2lzX3Bpbm5lZChyZXF1ZXN0LT5od19j
b250ZXh0KSk7CisJR0VNX0JVR19PTighaW50ZWxfY29udGV4dF9pc19waW5uZWQocmVxdWVzdC0+
Y29udGV4dCkpOwogCiAJLyoKIAkgKiBGbHVzaCBlbm91Z2ggc3BhY2UgdG8gcmVkdWNlIHRoZSBs
aWtlbGlob29kIG9mIHdhaXRpbmcgYWZ0ZXIKQEAgLTMwNDksNyArMzA0OCw3IEBAIHN0YXRpYyB2
b2lkIF9fZXhlY2xpc3RzX3Jlc2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgYm9v
bCBzdGFsbGVkKQogCS8qIFdlIHN0aWxsIGhhdmUgcmVxdWVzdHMgaW4tZmxpZ2h0OyB0aGUgZW5n
aW5lIHNob3VsZCBiZSBhY3RpdmUgKi8KIAlHRU1fQlVHX09OKCFpbnRlbF9lbmdpbmVfcG1faXNf
YXdha2UoZW5naW5lKSk7CiAKLQljZSA9IHJxLT5od19jb250ZXh0OworCWNlID0gcnEtPmNvbnRl
eHQ7CiAJR0VNX0JVR19PTighaTkxNV92bWFfaXNfcGlubmVkKGNlLT5zdGF0ZSkpOwogCiAJaWYg
KGk5MTVfcmVxdWVzdF9jb21wbGV0ZWQocnEpKSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
cmVzZXQuYwppbmRleCBiNzAwN2NkNzhjNmYuLjBkNGM2MTBhOTBiNyAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9yZXNldC5jCkBAIC00MCwyNyArNDAsMzEgQEAgc3RhdGljIHZvaWQgcm13
X2NsZWFyX2Z3KHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSwgaTkxNV9yZWdfdCByZWcsIHUz
MiBjbHIpCiBzdGF0aWMgdm9pZCBlbmdpbmVfc2tpcF9jb250ZXh0KHN0cnVjdCBpOTE1X3JlcXVl
c3QgKnJxKQogewogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSA9IHJxLT5lbmdpbmU7
Ci0Jc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmh1bmdfY3R4ID0gcnEtPmdlbV9jb250ZXh0Owor
CXN0cnVjdCBpbnRlbF9jb250ZXh0ICpodW5nX2N0eCA9IHJxLT5jb250ZXh0OwogCiAJaWYgKCFp
OTE1X3JlcXVlc3RfaXNfYWN0aXZlKHJxKSkKLQkJcmV0dXJuOworCQlycSA9IGxpc3RfZmlyc3Rf
ZW50cnkoJmVuZ2luZS0+YWN0aXZlLnJlcXVlc3RzLAorCQkJCSAgICAgIHR5cGVvZigqcnEpLCBz
Y2hlZC5saW5rKTsKIAogCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmVuZ2luZS0+YWN0aXZlLmxvY2sp
OwogCWxpc3RfZm9yX2VhY2hfZW50cnlfY29udGludWUocnEsICZlbmdpbmUtPmFjdGl2ZS5yZXF1
ZXN0cywgc2NoZWQubGluaykKLQkJaWYgKHJxLT5nZW1fY29udGV4dCA9PSBodW5nX2N0eCkKKwkJ
aWYgKHJxLT5jb250ZXh0ID09IGh1bmdfY3R4KQogCQkJaTkxNV9yZXF1ZXN0X3NraXAocnEsIC1F
SU8pOwogfQogCi1zdGF0aWMgdm9pZCBjbGllbnRfbWFya19ndWlsdHkoc3RydWN0IGRybV9pOTE1
X2ZpbGVfcHJpdmF0ZSAqZmlsZV9wcml2LAotCQkJICAgICAgIGNvbnN0IHN0cnVjdCBpOTE1X2dl
bV9jb250ZXh0ICpjdHgpCitzdGF0aWMgdm9pZCBjbGllbnRfbWFya19ndWlsdHkoc3RydWN0IGk5
MTVfcmVxdWVzdCAqcnEsIGJvb2wgYmFubmVkKQogewotCXVuc2lnbmVkIGludCBzY29yZTsKKwlz
dHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4ID0gcnEtPmNvbnRleHQtPmdlbV9jb250ZXh0Owor
CXN0cnVjdCBkcm1faTkxNV9maWxlX3ByaXZhdGUgKmZpbGVfcHJpdiA9IGN0eC0+ZmlsZV9wcml2
OwogCXVuc2lnbmVkIGxvbmcgcHJldl9oYW5nOworCXVuc2lnbmVkIGludCBzY29yZTsKIAotCWlm
IChpOTE1X2dlbV9jb250ZXh0X2lzX2Jhbm5lZChjdHgpKQorCWlmIChJU19FUlJfT1JfTlVMTChm
aWxlX3ByaXYpKQorCQlyZXR1cm47CisKKwlzY29yZSA9IDA7CisJaWYgKGJhbm5lZCkKIAkJc2Nv
cmUgPSBJOTE1X0NMSUVOVF9TQ09SRV9DT05URVhUX0JBTjsKLQllbHNlCi0JCXNjb3JlID0gMDsK
IAogCXByZXZfaGFuZyA9IHhjaGcoJmZpbGVfcHJpdi0+aGFuZ190aW1lc3RhbXAsIGppZmZpZXMp
OwogCWlmICh0aW1lX2JlZm9yZShqaWZmaWVzLCBwcmV2X2hhbmcgKyBJOTE1X0NMSUVOVF9GQVNU
X0hBTkdfSklGRklFUykpCkBAIC03NSwxNCArNzksMTUgQEAgc3RhdGljIHZvaWQgY2xpZW50X21h
cmtfZ3VpbHR5KHN0cnVjdCBkcm1faTkxNV9maWxlX3ByaXZhdGUgKmZpbGVfcHJpdiwKIAl9CiB9
CiAKLXN0YXRpYyBib29sIGNvbnRleHRfbWFya19ndWlsdHkoc3RydWN0IGk5MTVfZ2VtX2NvbnRl
eHQgKmN0eCkKK3N0YXRpYyBib29sIG1hcmtfZ3VpbHR5KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJx
KQogeworCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHggPSBycS0+Y29udGV4dC0+Z2VtX2Nv
bnRleHQ7CiAJdW5zaWduZWQgbG9uZyBwcmV2X2hhbmc7CiAJYm9vbCBiYW5uZWQ7CiAJaW50IGk7
CiAKIAlpZiAoaTkxNV9nZW1fY29udGV4dF9pc19jbG9zZWQoY3R4KSkgewotCQlpOTE1X2dlbV9j
b250ZXh0X3NldF9iYW5uZWQoY3R4KTsKKwkJaW50ZWxfY29udGV4dF9zZXRfYmFubmVkKHJxLT5j
b250ZXh0KTsKIAkJcmV0dXJuIHRydWU7CiAJfQogCkBAIC0xMDksMTggKzExNCwxNyBAQCBzdGF0
aWMgYm9vbCBjb250ZXh0X21hcmtfZ3VpbHR5KHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgp
CiAJaWYgKGJhbm5lZCkgewogCQlEUk1fREVCVUdfRFJJVkVSKCJjb250ZXh0ICVzOiBndWlsdHkg
JWQsIGJhbm5lZFxuIiwKIAkJCQkgY3R4LT5uYW1lLCBhdG9taWNfcmVhZCgmY3R4LT5ndWlsdHlf
Y291bnQpKTsKLQkJaTkxNV9nZW1fY29udGV4dF9zZXRfYmFubmVkKGN0eCk7CisJCWludGVsX2Nv
bnRleHRfc2V0X2Jhbm5lZChycS0+Y29udGV4dCk7CiAJfQogCi0JaWYgKCFJU19FUlJfT1JfTlVM
TChjdHgtPmZpbGVfcHJpdikpCi0JCWNsaWVudF9tYXJrX2d1aWx0eShjdHgtPmZpbGVfcHJpdiwg
Y3R4KTsKKwljbGllbnRfbWFya19ndWlsdHkocnEsIGJhbm5lZCk7CiAKIAlyZXR1cm4gYmFubmVk
OwogfQogCi1zdGF0aWMgdm9pZCBjb250ZXh0X21hcmtfaW5ub2NlbnQoc3RydWN0IGk5MTVfZ2Vt
X2NvbnRleHQgKmN0eCkKK3N0YXRpYyB2b2lkIG1hcmtfaW5ub2NlbnQoc3RydWN0IGk5MTVfcmVx
dWVzdCAqcnEpCiB7Ci0JYXRvbWljX2luYygmY3R4LT5hY3RpdmVfY291bnQpOworCWF0b21pY19p
bmMoJnJxLT5jb250ZXh0LT5nZW1fY29udGV4dC0+YWN0aXZlX2NvdW50KTsKIH0KIAogdm9pZCBf
X2k5MTVfcmVxdWVzdF9yZXNldChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgYm9vbCBndWlsdHkp
CkBAIC0xMzYsMTEgKzE0MCwxMSBAQCB2b2lkIF9faTkxNV9yZXF1ZXN0X3Jlc2V0KHN0cnVjdCBp
OTE1X3JlcXVlc3QgKnJxLCBib29sIGd1aWx0eSkKIAlyY3VfcmVhZF9sb2NrKCk7IC8qIHByb3Rl
Y3QgdGhlIEdFTSBjb250ZXh0ICovCiAJaWYgKGd1aWx0eSkgewogCQlpOTE1X3JlcXVlc3Rfc2tp
cChycSwgLUVJTyk7Ci0JCWlmIChjb250ZXh0X21hcmtfZ3VpbHR5KHJxLT5nZW1fY29udGV4dCkp
CisJCWlmIChtYXJrX2d1aWx0eShycSkpCiAJCQllbmdpbmVfc2tpcF9jb250ZXh0KHJxKTsKIAl9
IGVsc2UgewogCQlkbWFfZmVuY2Vfc2V0X2Vycm9yKCZycS0+ZmVuY2UsIC1FQUdBSU4pOwotCQlj
b250ZXh0X21hcmtfaW5ub2NlbnQocnEtPmdlbV9jb250ZXh0KTsKKwkJbWFya19pbm5vY2VudChy
cSk7CiAJfQogCXJjdV9yZWFkX3VubG9jaygpOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ19zdWJtaXNzaW9uLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9yaW5nX3N1Ym1pc3Npb24uYwppbmRleCBmYzI5ZGY3MTI4MTAuLjg3ZDI4OTNk
NDhkYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ19zdWJt
aXNzaW9uLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ19zdWJtaXNz
aW9uLmMKQEAgLTE0ODgsNyArMTQ4OCw3IEBAIHN0YXRpYyBpbmxpbmUgaW50IG1pX3NldF9jb250
ZXh0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCB1MzIgZmxhZ3MpCiAKIAkqY3MrKyA9IE1JX05P
T1A7CiAJKmNzKysgPSBNSV9TRVRfQ09OVEVYVDsKLQkqY3MrKyA9IGk5MTVfZ2d0dF9vZmZzZXQo
cnEtPmh3X2NvbnRleHQtPnN0YXRlKSB8IGZsYWdzOworCSpjcysrID0gaTkxNV9nZ3R0X29mZnNl
dChycS0+Y29udGV4dC0+c3RhdGUpIHwgZmxhZ3M7CiAJLyoKIAkgKiB3L2E6IE1JX1NFVF9DT05U
RVhUIG11c3QgYWx3YXlzIGJlIGZvbGxvd2VkIGJ5IE1JX05PT1AKIAkgKiBXYU1pU2V0Q29udGV4
dF9IYW5nOnNuYixpdmIsdmx2CkBAIC0xNTU4LDcgKzE1NTgsNyBAQCBzdGF0aWMgaW50IHJlbWFw
X2wzX3NsaWNlKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCBpbnQgc2xpY2UpCiAKIHN0YXRpYyBp
bnQgcmVtYXBfbDMoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiB7Ci0Jc3RydWN0IGk5MTVfZ2Vt
X2NvbnRleHQgKmN0eCA9IHJxLT5nZW1fY29udGV4dDsKKwlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4
dCAqY3R4ID0gcnEtPmNvbnRleHQtPmdlbV9jb250ZXh0OwogCWludCBpLCBlcnI7CiAKIAlpZiAo
IWN0eC0+cmVtYXBfc2xpY2UpCkBAIC0xNTc5LDcgKzE1NzksNyBAQCBzdGF0aWMgaW50IHJlbWFw
X2wzKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogCiBzdGF0aWMgaW50IHN3aXRjaF9jb250ZXh0
KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogewotCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSA9
IHJxLT5od19jb250ZXh0OworCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSA9IHJxLT5jb250ZXh0
OwogCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0gdm1fYWxpYXMoY2UpOwogCWludCBy
ZXQ7CiAKQEAgLTE2MDQsNyArMTYwNCw3IEBAIHN0YXRpYyBpbnQgc3dpdGNoX2NvbnRleHQoc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJCSAqIGlzIHB1cmVseSB1c2VkIGZvciBmbHVzaGluZyB1
c2VyIGNvbnRleHRzLgogCQkgKi8KIAkJaHdfZmxhZ3MgPSAwOwotCQlpZiAoaTkxNV9nZW1fY29u
dGV4dF9pc19rZXJuZWwocnEtPmdlbV9jb250ZXh0KSkKKwkJaWYgKGk5MTVfZ2VtX2NvbnRleHRf
aXNfa2VybmVsKHJxLT5jb250ZXh0LT5nZW1fY29udGV4dCkpCiAJCQlod19mbGFncyA9IE1JX1JF
U1RPUkVfSU5ISUJJVDsKIAogCQlyZXQgPSBtaV9zZXRfY29udGV4dChycSwgaHdfZmxhZ3MpOwpA
QCAtMTY1MSw3ICsxNjUxLDcgQEAgc3RhdGljIGludCByaW5nX3JlcXVlc3RfYWxsb2Moc3RydWN0
IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCkKIHsKIAlpbnQgcmV0OwogCi0JR0VNX0JVR19PTighaW50
ZWxfY29udGV4dF9pc19waW5uZWQocmVxdWVzdC0+aHdfY29udGV4dCkpOworCUdFTV9CVUdfT04o
IWludGVsX2NvbnRleHRfaXNfcGlubmVkKHJlcXVlc3QtPmNvbnRleHQpKTsKIAlHRU1fQlVHX09O
KGk5MTVfcmVxdWVzdF90aW1lbGluZShyZXF1ZXN0KS0+aGFzX2luaXRpYWxfYnJlYWRjcnVtYik7
CiAKIAkvKgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJj
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwppbmRleCBkMWVkM2Mw
Zjg1MWMuLjdkNTcxM2VhNmJkZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
c2VsZnRlc3RfbHJjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJj
LmMKQEAgLTExODcsMTMgKzExODcsMTMgQEAgc3RhdGljIGludCBfX2NhbmNlbF9hY3RpdmUwKHN0
cnVjdCBsaXZlX3ByZWVtcHRfY2FuY2VsICphcmcpCiAJCQkJX19mdW5jX18sIGFyZy0+ZW5naW5l
LT5uYW1lKSkKIAkJcmV0dXJuIC1FSU87CiAKLQljbGVhcl9iaXQoQ09OVEVYVF9CQU5ORUQsICZh
cmctPmEuY3R4LT5mbGFncyk7CiAJcnEgPSBzcGlubmVyX2NyZWF0ZV9yZXF1ZXN0KCZhcmctPmEu
c3BpbiwKIAkJCQkgICAgYXJnLT5hLmN0eCwgYXJnLT5lbmdpbmUsCiAJCQkJICAgIE1JX0FSQl9D
SEVDSyk7CiAJaWYgKElTX0VSUihycSkpCiAJCXJldHVybiBQVFJfRVJSKHJxKTsKIAorCWNsZWFy
X2JpdChDT05URVhUX0JBTk5FRCwgJnJxLT5jb250ZXh0LT5mbGFncyk7CiAJaTkxNV9yZXF1ZXN0
X2dldChycSk7CiAJaTkxNV9yZXF1ZXN0X2FkZChycSk7CiAJaWYgKCFpZ3Rfd2FpdF9mb3Jfc3Bp
bm5lcigmYXJnLT5hLnNwaW4sIHJxKSkgewpAQCAtMTIwMSw3ICsxMjAxLDcgQEAgc3RhdGljIGlu
dCBfX2NhbmNlbF9hY3RpdmUwKHN0cnVjdCBsaXZlX3ByZWVtcHRfY2FuY2VsICphcmcpCiAJCWdv
dG8gb3V0OwogCX0KIAotCWk5MTVfZ2VtX2NvbnRleHRfc2V0X2Jhbm5lZChhcmctPmEuY3R4KTsK
KwlpbnRlbF9jb250ZXh0X3NldF9iYW5uZWQocnEtPmNvbnRleHQpOwogCWVyciA9IGludGVsX2Vu
Z2luZV9wdWxzZShhcmctPmVuZ2luZSk7CiAJaWYgKGVycikKIAkJZ290byBvdXQ7CkBAIC0xMjM2
LDEzICsxMjM2LDEzIEBAIHN0YXRpYyBpbnQgX19jYW5jZWxfYWN0aXZlMShzdHJ1Y3QgbGl2ZV9w
cmVlbXB0X2NhbmNlbCAqYXJnKQogCQkJCV9fZnVuY19fLCBhcmctPmVuZ2luZS0+bmFtZSkpCiAJ
CXJldHVybiAtRUlPOwogCi0JY2xlYXJfYml0KENPTlRFWFRfQkFOTkVELCAmYXJnLT5hLmN0eC0+
ZmxhZ3MpOwogCXJxWzBdID0gc3Bpbm5lcl9jcmVhdGVfcmVxdWVzdCgmYXJnLT5hLnNwaW4sCiAJ
CQkJICAgICAgIGFyZy0+YS5jdHgsIGFyZy0+ZW5naW5lLAogCQkJCSAgICAgICBNSV9OT09QKTsg
Lyogbm8gcHJlZW1wdGlvbiAqLwogCWlmIChJU19FUlIocnFbMF0pKQogCQlyZXR1cm4gUFRSX0VS
UihycVswXSk7CiAKKwljbGVhcl9iaXQoQ09OVEVYVF9CQU5ORUQsICZycVswXS0+Y29udGV4dC0+
ZmxhZ3MpOwogCWk5MTVfcmVxdWVzdF9nZXQocnFbMF0pOwogCWk5MTVfcmVxdWVzdF9hZGQocnFb
MF0pOwogCWlmICghaWd0X3dhaXRfZm9yX3NwaW5uZXIoJmFyZy0+YS5zcGluLCBycVswXSkpIHsK
QEAgLTEyNTAsNyArMTI1MCw2IEBAIHN0YXRpYyBpbnQgX19jYW5jZWxfYWN0aXZlMShzdHJ1Y3Qg
bGl2ZV9wcmVlbXB0X2NhbmNlbCAqYXJnKQogCQlnb3RvIG91dDsKIAl9CiAKLQljbGVhcl9iaXQo
Q09OVEVYVF9CQU5ORUQsICZhcmctPmIuY3R4LT5mbGFncyk7CiAJcnFbMV0gPSBzcGlubmVyX2Ny
ZWF0ZV9yZXF1ZXN0KCZhcmctPmIuc3BpbiwKIAkJCQkgICAgICAgYXJnLT5iLmN0eCwgYXJnLT5l
bmdpbmUsCiAJCQkJICAgICAgIE1JX0FSQl9DSEVDSyk7CkBAIC0xMjU5LDEzICsxMjU4LDE0IEBA
IHN0YXRpYyBpbnQgX19jYW5jZWxfYWN0aXZlMShzdHJ1Y3QgbGl2ZV9wcmVlbXB0X2NhbmNlbCAq
YXJnKQogCQlnb3RvIG91dDsKIAl9CiAKKwljbGVhcl9iaXQoQ09OVEVYVF9CQU5ORUQsICZycVsx
XS0+Y29udGV4dC0+ZmxhZ3MpOwogCWk5MTVfcmVxdWVzdF9nZXQocnFbMV0pOwogCWVyciA9IGk5
MTVfcmVxdWVzdF9hd2FpdF9kbWFfZmVuY2UocnFbMV0sICZycVswXS0+ZmVuY2UpOwogCWk5MTVf
cmVxdWVzdF9hZGQocnFbMV0pOwogCWlmIChlcnIpCiAJCWdvdG8gb3V0OwogCi0JaTkxNV9nZW1f
Y29udGV4dF9zZXRfYmFubmVkKGFyZy0+Yi5jdHgpOworCWludGVsX2NvbnRleHRfc2V0X2Jhbm5l
ZChycVsxXS0+Y29udGV4dCk7CiAJZXJyID0gaW50ZWxfZW5naW5lX3B1bHNlKGFyZy0+ZW5naW5l
KTsKIAlpZiAoZXJyKQogCQlnb3RvIG91dDsKQEAgLTEzMDgsMTMgKzEzMDgsMTMgQEAgc3RhdGlj
IGludCBfX2NhbmNlbF9xdWV1ZWQoc3RydWN0IGxpdmVfcHJlZW1wdF9jYW5jZWwgKmFyZykKIAkJ
CQlfX2Z1bmNfXywgYXJnLT5lbmdpbmUtPm5hbWUpKQogCQlyZXR1cm4gLUVJTzsKIAotCWNsZWFy
X2JpdChDT05URVhUX0JBTk5FRCwgJmFyZy0+YS5jdHgtPmZsYWdzKTsKIAlycVswXSA9IHNwaW5u
ZXJfY3JlYXRlX3JlcXVlc3QoJmFyZy0+YS5zcGluLAogCQkJCSAgICAgICBhcmctPmEuY3R4LCBh
cmctPmVuZ2luZSwKIAkJCQkgICAgICAgTUlfQVJCX0NIRUNLKTsKIAlpZiAoSVNfRVJSKHJxWzBd
KSkKIAkJcmV0dXJuIFBUUl9FUlIocnFbMF0pOwogCisJY2xlYXJfYml0KENPTlRFWFRfQkFOTkVE
LCAmcnFbMF0tPmNvbnRleHQtPmZsYWdzKTsKIAlpOTE1X3JlcXVlc3RfZ2V0KHJxWzBdKTsKIAlp
OTE1X3JlcXVlc3RfYWRkKHJxWzBdKTsKIAlpZiAoIWlndF93YWl0X2Zvcl9zcGlubmVyKCZhcmct
PmEuc3BpbiwgcnFbMF0pKSB7CkBAIC0xMzIyLDEzICsxMzIyLDEzIEBAIHN0YXRpYyBpbnQgX19j
YW5jZWxfcXVldWVkKHN0cnVjdCBsaXZlX3ByZWVtcHRfY2FuY2VsICphcmcpCiAJCWdvdG8gb3V0
OwogCX0KIAotCWNsZWFyX2JpdChDT05URVhUX0JBTk5FRCwgJmFyZy0+Yi5jdHgtPmZsYWdzKTsK
IAlycVsxXSA9IGlndF9yZXF1ZXN0X2FsbG9jKGFyZy0+Yi5jdHgsIGFyZy0+ZW5naW5lKTsKIAlp
ZiAoSVNfRVJSKHJxWzFdKSkgewogCQllcnIgPSBQVFJfRVJSKHJxWzFdKTsKIAkJZ290byBvdXQ7
CiAJfQogCisJY2xlYXJfYml0KENPTlRFWFRfQkFOTkVELCAmcnFbMV0tPmNvbnRleHQtPmZsYWdz
KTsKIAlpOTE1X3JlcXVlc3RfZ2V0KHJxWzFdKTsKIAllcnIgPSBpOTE1X3JlcXVlc3RfYXdhaXRf
ZG1hX2ZlbmNlKHJxWzFdLCAmcnFbMF0tPmZlbmNlKTsKIAlpOTE1X3JlcXVlc3RfYWRkKHJxWzFd
KTsKQEAgLTEzNDksNyArMTM0OSw3IEBAIHN0YXRpYyBpbnQgX19jYW5jZWxfcXVldWVkKHN0cnVj
dCBsaXZlX3ByZWVtcHRfY2FuY2VsICphcmcpCiAJaWYgKGVycikKIAkJZ290byBvdXQ7CiAKLQlp
OTE1X2dlbV9jb250ZXh0X3NldF9iYW5uZWQoYXJnLT5hLmN0eCk7CisJaW50ZWxfY29udGV4dF9z
ZXRfYmFubmVkKHJxWzJdLT5jb250ZXh0KTsKIAllcnIgPSBpbnRlbF9lbmdpbmVfcHVsc2UoYXJn
LT5lbmdpbmUpOwogCWlmIChlcnIpCiAJCWdvdG8gb3V0OwpAQCAtMTM5NiwxMyArMTM5NiwxMyBA
QCBzdGF0aWMgaW50IF9fY2FuY2VsX2hvc3RpbGUoc3RydWN0IGxpdmVfcHJlZW1wdF9jYW5jZWwg
KmFyZykKIAkJcmV0dXJuIDA7CiAKIAlHRU1fVFJBQ0UoIiVzKCVzKVxuIiwgX19mdW5jX18sIGFy
Zy0+ZW5naW5lLT5uYW1lKTsKLQljbGVhcl9iaXQoQ09OVEVYVF9CQU5ORUQsICZhcmctPmEuY3R4
LT5mbGFncyk7CiAJcnEgPSBzcGlubmVyX2NyZWF0ZV9yZXF1ZXN0KCZhcmctPmEuc3BpbiwKIAkJ
CQkgICAgYXJnLT5hLmN0eCwgYXJnLT5lbmdpbmUsCiAJCQkJICAgIE1JX05PT1ApOyAvKiBwcmVl
bXB0aW9uIGRpc2FibGVkICovCiAJaWYgKElTX0VSUihycSkpCiAJCXJldHVybiBQVFJfRVJSKHJx
KTsKIAorCWNsZWFyX2JpdChDT05URVhUX0JBTk5FRCwgJnJxLT5jb250ZXh0LT5mbGFncyk7CiAJ
aTkxNV9yZXF1ZXN0X2dldChycSk7CiAJaTkxNV9yZXF1ZXN0X2FkZChycSk7CiAJaWYgKCFpZ3Rf
d2FpdF9mb3Jfc3Bpbm5lcigmYXJnLT5hLnNwaW4sIHJxKSkgewpAQCAtMTQxMCw3ICsxNDEwLDcg
QEAgc3RhdGljIGludCBfX2NhbmNlbF9ob3N0aWxlKHN0cnVjdCBsaXZlX3ByZWVtcHRfY2FuY2Vs
ICphcmcpCiAJCWdvdG8gb3V0OwogCX0KIAotCWk5MTVfZ2VtX2NvbnRleHRfc2V0X2Jhbm5lZChh
cmctPmEuY3R4KTsKKwlpbnRlbF9jb250ZXh0X3NldF9iYW5uZWQocnEtPmNvbnRleHQpOwogCWVy
ciA9IGludGVsX2VuZ2luZV9wdWxzZShhcmctPmVuZ2luZSk7IC8qIGZvcmNlIHJlc2V0ICovCiAJ
aWYgKGVycikKIAkJZ290byBvdXQ7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC91Yy9pbnRlbF9ndWNfc3VibWlzc2lvbi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMv
aW50ZWxfZ3VjX3N1Ym1pc3Npb24uYwppbmRleCAyNDk4YzU1ZTBlYTUuLjA4MjY3ZDJjM2NmYyAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX3N1Ym1pc3Np
b24uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfc3VibWlzc2lv
bi5jCkBAIC00NzEsNyArNDcxLDcgQEAgc3RhdGljIHZvaWQgZ3VjX2FkZF9yZXF1ZXN0KHN0cnVj
dCBpbnRlbF9ndWMgKmd1Yywgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiB7CiAJc3RydWN0IGlu
dGVsX2d1Y19jbGllbnQgKmNsaWVudCA9IGd1Yy0+ZXhlY2J1Zl9jbGllbnQ7CiAJc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lID0gcnEtPmVuZ2luZTsKLQl1MzIgY3R4X2Rlc2MgPSBsb3dl
cl8zMl9iaXRzKHJxLT5od19jb250ZXh0LT5scmNfZGVzYyk7CisJdTMyIGN0eF9kZXNjID0gbG93
ZXJfMzJfYml0cyhycS0+Y29udGV4dC0+bHJjX2Rlc2MpOwogCXUzMiByaW5nX3RhaWwgPSBpbnRl
bF9yaW5nX3NldF90YWlsKHJxLT5yaW5nLCBycS0+dGFpbCkgLyBzaXplb2YodTY0KTsKIAogCWd1
Y193cV9pdGVtX2FwcGVuZChjbGllbnQsIGVuZ2luZS0+Z3VjX2lkLCBjdHhfZGVzYywKQEAgLTU3
Miw3ICs1NzIsNyBAQCBzdGF0aWMgdm9pZCBfX2d1Y19kZXF1ZXVlKHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSkKIAkJaW50IGk7CiAKIAkJcHJpb2xpc3RfZm9yX2VhY2hfcmVxdWVzdF9j
b25zdW1lKHJxLCBybiwgcCwgaSkgewotCQkJaWYgKGxhc3QgJiYgcnEtPmh3X2NvbnRleHQgIT0g
bGFzdC0+aHdfY29udGV4dCkgeworCQkJaWYgKGxhc3QgJiYgcnEtPmNvbnRleHQgIT0gbGFzdC0+
Y29udGV4dCkgewogCQkJCWlmIChwb3J0ID09IGxhc3RfcG9ydCkKIAkJCQkJZ290byBkb25lOwog
CkBAIC02NzcsNyArNjc3LDcgQEAgc3RhdGljIHZvaWQgZ3VjX3Jlc2V0KHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSwgYm9vbCBzdGFsbGVkKQogCQlzdGFsbGVkID0gZmFsc2U7CiAKIAlf
X2k5MTVfcmVxdWVzdF9yZXNldChycSwgc3RhbGxlZCk7Ci0JaW50ZWxfbHJfY29udGV4dF9yZXNl
dChlbmdpbmUsIHJxLT5od19jb250ZXh0LCBycS0+aGVhZCwgc3RhbGxlZCk7CisJaW50ZWxfbHJf
Y29udGV4dF9yZXNldChlbmdpbmUsIHJxLT5jb250ZXh0LCBycS0+aGVhZCwgc3RhbGxlZCk7CiAK
IG91dF91bmxvY2s6CiAJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZW5naW5lLT5hY3RpdmUubG9j
aywgZmxhZ3MpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxl
ci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCmluZGV4IDViMmE3ZDA3
MmVjOS4uMjI4YzY2NTM0ZTIxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQv
c2NoZWR1bGVyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCkBA
IC01OSw3ICs1OSw3IEBAIHN0YXRpYyB2b2lkIHNldF9jb250ZXh0X3BkcF9yb290X3BvaW50ZXIo
CiBzdGF0aWMgdm9pZCB1cGRhdGVfc2hhZG93X3BkcHMoc3RydWN0IGludGVsX3ZncHVfd29ya2xv
YWQgKndvcmtsb2FkKQogewogCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpjdHhfb2JqID0K
LQkJd29ya2xvYWQtPnJlcS0+aHdfY29udGV4dC0+c3RhdGUtPm9iajsKKwkJd29ya2xvYWQtPnJl
cS0+Y29udGV4dC0+c3RhdGUtPm9iajsKIAlzdHJ1Y3QgZXhlY2xpc3RfcmluZ19jb250ZXh0ICpz
aGFkb3dfcmluZ19jb250ZXh0OwogCXN0cnVjdCBwYWdlICpwYWdlOwogCkBAIC0xMzAsNyArMTMw
LDcgQEAgc3RhdGljIGludCBwb3B1bGF0ZV9zaGFkb3dfY29udGV4dChzdHJ1Y3QgaW50ZWxfdmdw
dV93b3JrbG9hZCAqd29ya2xvYWQpCiAJc3RydWN0IGludGVsX2d2dCAqZ3Z0ID0gdmdwdS0+Z3Z0
OwogCWludCByaW5nX2lkID0gd29ya2xvYWQtPnJpbmdfaWQ7CiAJc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKmN0eF9vYmogPQotCQl3b3JrbG9hZC0+cmVxLT5od19jb250ZXh0LT5zdGF0ZS0+
b2JqOworCQl3b3JrbG9hZC0+cmVxLT5jb250ZXh0LT5zdGF0ZS0+b2JqOwogCXN0cnVjdCBleGVj
bGlzdF9yaW5nX2NvbnRleHQgKnNoYWRvd19yaW5nX2NvbnRleHQ7CiAJc3RydWN0IHBhZ2UgKnBh
Z2U7CiAJdm9pZCAqZHN0OwpAQCAtMjA1LDkgKzIwNSw5IEBAIHN0YXRpYyBpbnQgcG9wdWxhdGVf
c2hhZG93X2NvbnRleHQoc3RydWN0IGludGVsX3ZncHVfd29ya2xvYWQgKndvcmtsb2FkKQogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW5saW5lIGJvb2wgaXNfZ3Z0X3JlcXVlc3Qoc3RydWN0IGk5
MTVfcmVxdWVzdCAqcmVxKQorc3RhdGljIGlubGluZSBib29sIGlzX2d2dF9yZXF1ZXN0KHN0cnVj
dCBpOTE1X3JlcXVlc3QgKnJxKQogewotCXJldHVybiBpOTE1X2dlbV9jb250ZXh0X2ZvcmNlX3Np
bmdsZV9zdWJtaXNzaW9uKHJlcS0+Z2VtX2NvbnRleHQpOworCXJldHVybiBpbnRlbF9jb250ZXh0
X2ZvcmNlX3NpbmdsZV9zdWJtaXNzaW9uKHJxLT5jb250ZXh0KTsKIH0KIAogc3RhdGljIHZvaWQg
c2F2ZV9yaW5nX2h3X3N0YXRlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCBpbnQgcmluZ19pZCkK
QEAgLTMwNyw3ICszMDcsNyBAQCBzdGF0aWMgaW50IGNvcHlfd29ya2xvYWRfdG9fcmluZ19idWZm
ZXIoc3RydWN0IGludGVsX3ZncHVfd29ya2xvYWQgKndvcmtsb2FkKQogCXUzMiAqY3M7CiAJaW50
IGVycjsKIAotCWlmIChJU19HRU4ocmVxLT5pOTE1LCA5KSAmJiBpc19pbmhpYml0X2NvbnRleHQo
cmVxLT5od19jb250ZXh0KSkKKwlpZiAoSVNfR0VOKHJlcS0+aTkxNSwgOSkgJiYgaXNfaW5oaWJp
dF9jb250ZXh0KHJlcS0+Y29udGV4dCkpCiAJCWludGVsX3ZncHVfcmVzdG9yZV9pbmhpYml0X2Nv
bnRleHQodmdwdSwgcmVxKTsKIAogCS8qCkBAIC0zNjMsMTEgKzM2MywxMCBAQCBzdGF0aWMgdm9p
ZCByZWxlYXNlX3NoYWRvd193YV9jdHgoc3RydWN0IGludGVsX3NoYWRvd193YV9jdHggKndhX2N0
eCkKIH0KIAogc3RhdGljIHZvaWQgc2V0X2NvbnRleHRfcHBndHRfZnJvbV9zaGFkb3coc3RydWN0
IGludGVsX3ZncHVfd29ya2xvYWQgKndvcmtsb2FkLAotCQkJCQkgIHN0cnVjdCBpOTE1X2dlbV9j
b250ZXh0ICpjdHgpCisJCQkJCSAgc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQogewogCXN0cnVj
dCBpbnRlbF92Z3B1X21tICptbSA9IHdvcmtsb2FkLT5zaGFkb3dfbW07Ci0Jc3RydWN0IGk5MTVf
cHBndHQgKnBwZ3R0ID0KLQkJaTkxNV92bV90b19wcGd0dChpOTE1X2dlbV9jb250ZXh0X2dldF92
bV9yY3UoY3R4KSk7CisJc3RydWN0IGk5MTVfcHBndHQgKnBwZ3R0ID0gaTkxNV92bV90b19wcGd0
dChjZS0+dm0pOwogCWludCBpID0gMDsKIAogCWlmIChtbS0+cHBndHRfbW0ucm9vdF9lbnRyeV90
eXBlID09IEdUVF9UWVBFX1BQR1RUX1JPT1RfTDRfRU5UUlkpIHsKQEAgLTM4MCw4ICszNzksNiBA
QCBzdGF0aWMgdm9pZCBzZXRfY29udGV4dF9wcGd0dF9mcm9tX3NoYWRvdyhzdHJ1Y3QgaW50ZWxf
dmdwdV93b3JrbG9hZCAqd29ya2xvYWQsCiAJCQlweF9kbWEocGQpID0gbW0tPnBwZ3R0X21tLnNo
YWRvd19wZHBzW2ldOwogCQl9CiAJfQotCi0JaTkxNV92bV9wdXQoJnBwZ3R0LT52bSk7CiB9CiAK
IHN0YXRpYyBpbnQKQEAgLTUyOSw3ICs1MjYsNyBAQCBzdGF0aWMgdm9pZCB1cGRhdGVfd2FfY3R4
XzJfc2hhZG93X2N0eChzdHJ1Y3QgaW50ZWxfc2hhZG93X3dhX2N0eCAqd2FfY3R4KQogCQljb250
YWluZXJfb2Yod2FfY3R4LCBzdHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCwgd2FfY3R4KTsKIAlz
dHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSA9IHdvcmtsb2FkLT5yZXE7CiAJc3RydWN0IGV4ZWNsaXN0
X3JpbmdfY29udGV4dCAqc2hhZG93X3JpbmdfY29udGV4dCA9Ci0JCShzdHJ1Y3QgZXhlY2xpc3Rf
cmluZ19jb250ZXh0ICopcnEtPmh3X2NvbnRleHQtPmxyY19yZWdfc3RhdGU7CisJCShzdHJ1Y3Qg
ZXhlY2xpc3RfcmluZ19jb250ZXh0ICopcnEtPmNvbnRleHQtPmxyY19yZWdfc3RhdGU7CiAKIAlz
aGFkb3dfcmluZ19jb250ZXh0LT5iYl9wZXJfY3R4X3B0ci52YWwgPQogCQkoc2hhZG93X3Jpbmdf
Y29udGV4dC0+YmJfcGVyX2N0eF9wdHIudmFsICYKQEAgLTYyOCw3ICs2MjUsNyBAQCBzdGF0aWMg
aW50IHByZXBhcmVfd29ya2xvYWQoc3RydWN0IGludGVsX3ZncHVfd29ya2xvYWQgKndvcmtsb2Fk
KQogCiAJdXBkYXRlX3NoYWRvd19wZHBzKHdvcmtsb2FkKTsKIAotCXNldF9jb250ZXh0X3BwZ3R0
X2Zyb21fc2hhZG93KHdvcmtsb2FkLCBzLT5zaGFkb3dbcmluZ10tPmdlbV9jb250ZXh0KTsKKwlz
ZXRfY29udGV4dF9wcGd0dF9mcm9tX3NoYWRvdyh3b3JrbG9hZCwgcy0+c2hhZG93W3JpbmddKTsK
IAogCXJldCA9IGludGVsX3ZncHVfc3luY19vb3NfcGFnZXMod29ya2xvYWQtPnZncHUpOwogCWlm
IChyZXQpIHsKQEAgLTc4Nyw3ICs3ODQsNyBAQCBzdGF0aWMgdm9pZCB1cGRhdGVfZ3Vlc3RfY29u
dGV4dChzdHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xvYWQpCiAJc3RydWN0IGk5MTVf
cmVxdWVzdCAqcnEgPSB3b3JrbG9hZC0+cmVxOwogCXN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1ID0g
d29ya2xvYWQtPnZncHU7CiAJc3RydWN0IGludGVsX2d2dCAqZ3Z0ID0gdmdwdS0+Z3Z0OwotCXN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpjdHhfb2JqID0gcnEtPmh3X2NvbnRleHQtPnN0YXRl
LT5vYmo7CisJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKmN0eF9vYmogPSBycS0+Y29udGV4
dC0+c3RhdGUtPm9iajsKIAlzdHJ1Y3QgZXhlY2xpc3RfcmluZ19jb250ZXh0ICpzaGFkb3dfcmlu
Z19jb250ZXh0OwogCXN0cnVjdCBwYWdlICpwYWdlOwogCXZvaWQgKnNyYzsKQEAgLTEyMzIsOCAr
MTIyOSw2IEBAIGludCBpbnRlbF92Z3B1X3NldHVwX3N1Ym1pc3Npb24oc3RydWN0IGludGVsX3Zn
cHUgKnZncHUpCiAJaWYgKElTX0VSUihjdHgpKQogCQlyZXR1cm4gUFRSX0VSUihjdHgpOwogCi0J
aTkxNV9nZW1fY29udGV4dF9zZXRfZm9yY2Vfc2luZ2xlX3N1Ym1pc3Npb24oY3R4KTsKLQogCXBw
Z3R0ID0gaTkxNV92bV90b19wcGd0dChpOTE1X2dlbV9jb250ZXh0X2dldF92bV9yY3UoY3R4KSk7
CiAJaTkxNV9jb250ZXh0X3BwZ3R0X3Jvb3Rfc2F2ZShzLCBwcGd0dCk7CiAKQEAgLTEyNDksNiAr
MTI0NCw4IEBAIGludCBpbnRlbF92Z3B1X3NldHVwX3N1Ym1pc3Npb24oc3RydWN0IGludGVsX3Zn
cHUgKnZncHUpCiAJCQlnb3RvIG91dF9zaGFkb3dfY3R4OwogCQl9CiAKKwkJaW50ZWxfY29udGV4
dF9zZXRfc2luZ2xlX3N1Ym1pc3Npb24oY2UpOworCiAJCWlmICghVVNFU19HVUNfU1VCTUlTU0lP
TihpOTE1KSkgeyAvKiBNYXggcmluZyBidWZmZXIgc2l6ZSAqLwogCQkJY29uc3QgdW5zaWduZWQg
aW50IHJpbmdfc2l6ZSA9IDUxMiAqIFNaXzRLOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwppbmRl
eCAxNDNhODk1MmI3MzYuLmY0Y2JkMzc5ZGI5NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9nZW0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCkBA
IC0xMTA4LDkgKzExMDgsOSBAQCBzdGF0aWMgaW50IF9faW50ZWxfZW5naW5lc19yZWNvcmRfZGVm
YXVsdHMoc3RydWN0IGludGVsX2d0ICpndCkKIAkJCWNvbnRpbnVlOwogCiAJCS8qIFdlIHdhbnQg
dG8gYmUgYWJsZSB0byB1bmJpbmQgdGhlIHN0YXRlIGZyb20gdGhlIEdHVFQgKi8KLQkJR0VNX0JV
R19PTihpbnRlbF9jb250ZXh0X2lzX3Bpbm5lZChycS0+aHdfY29udGV4dCkpOworCQlHRU1fQlVH
X09OKGludGVsX2NvbnRleHRfaXNfcGlubmVkKHJxLT5jb250ZXh0KSk7CiAKLQkJc3RhdGUgPSBy
cS0+aHdfY29udGV4dC0+c3RhdGU7CisJCXN0YXRlID0gcnEtPmNvbnRleHQtPnN0YXRlOwogCQlp
ZiAoIXN0YXRlKQogCQkJY29udGludWU7CiAKQEAgLTExNjIsNyArMTE2Miw3IEBAIHN0YXRpYyBp
bnQgX19pbnRlbF9lbmdpbmVzX3JlY29yZF9kZWZhdWx0cyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQog
CQlpZiAoIXJxKQogCQkJY29udGludWU7CiAKLQkJY2UgPSBycS0+aHdfY29udGV4dDsKKwkJY2Ug
PSBycS0+Y29udGV4dDsKIAkJaTkxNV9yZXF1ZXN0X3B1dChycSk7CiAJCWludGVsX2NvbnRleHRf
cHV0KGNlKTsKIAl9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9l
cnJvci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuYwppbmRleCAxZjJm
MjY2ZjI2YWYuLjVjNzM2OWM1NWY5MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9ncHVfZXJyb3IuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJv
ci5jCkBAIC0xMjIwLDcgKzEyMjAsNyBAQCBzdGF0aWMgdm9pZCBlcnJvcl9yZWNvcmRfZW5naW5l
X3JlZ2lzdGVycyhzdHJ1Y3QgaTkxNV9ncHVfc3RhdGUgKmVycm9yLAogc3RhdGljIHZvaWQgcmVj
b3JkX3JlcXVlc3QoY29uc3Qgc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCwKIAkJCSAgIHN0
cnVjdCBkcm1faTkxNV9lcnJvcl9yZXF1ZXN0ICplcnEpCiB7Ci0JY29uc3Qgc3RydWN0IGk5MTVf
Z2VtX2NvbnRleHQgKmN0eCA9IHJlcXVlc3QtPmdlbV9jb250ZXh0OworCWNvbnN0IHN0cnVjdCBp
OTE1X2dlbV9jb250ZXh0ICpjdHggPSByZXF1ZXN0LT5jb250ZXh0LT5nZW1fY29udGV4dDsKIAog
CWVycS0+ZmxhZ3MgPSByZXF1ZXN0LT5mZW5jZS5mbGFnczsKIAllcnEtPmNvbnRleHQgPSByZXF1
ZXN0LT5mZW5jZS5jb250ZXh0OwpAQCAtMTIzMCw3ICsxMjMwLDcgQEAgc3RhdGljIHZvaWQgcmVj
b3JkX3JlcXVlc3QoY29uc3Qgc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCwKIAllcnEtPnN0
YXJ0ID0gaTkxNV9nZ3R0X29mZnNldChyZXF1ZXN0LT5yaW5nLT52bWEpOwogCWVycS0+aGVhZCA9
IHJlcXVlc3QtPmhlYWQ7CiAJZXJxLT50YWlsID0gcmVxdWVzdC0+dGFpbDsKLQllcnEtPnBpZCA9
IGN0eC0+cGlkID8gcGlkX25yKGN0eC0+cGlkKSA6IDA7CisJZXJxLT5waWQgPSBjdHggJiYgY3R4
LT5waWQgPyBwaWRfbnIoY3R4LT5waWQpIDogMDsKIH0KIAogc3RhdGljIHZvaWQgZW5naW5lX3Jl
Y29yZF9yZXF1ZXN0cyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCkBAIC0xMjk3LDcg
KzEyOTcsMTAgQEAgc3RhdGljIHZvaWQgZXJyb3JfcmVjb3JkX2VuZ2luZV9leGVjbGlzdHMoY29u
c3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAogc3RhdGljIGJvb2wgcmVjb3JkX2Nv
bnRleHQoc3RydWN0IGRybV9pOTE1X2Vycm9yX2NvbnRleHQgKmUsCiAJCQkgICBjb25zdCBzdHJ1
Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIHsKLQljb25zdCBzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAq
Y3R4ID0gcnEtPmdlbV9jb250ZXh0OworCWNvbnN0IHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpj
dHggPSBycS0+Y29udGV4dC0+Z2VtX2NvbnRleHQ7CisKKwlpZiAoIWN0eCkKKwkJcmV0dXJuIGZh
bHNlOwogCiAJaWYgKGN0eC0+cGlkKSB7CiAJCXN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzazsKQEAg
LTE0NTEsNyArMTQ1NCw3IEBAIGdlbV9yZWNvcmRfcmluZ3Moc3RydWN0IGk5MTVfZ3B1X3N0YXRl
ICplcnJvciwgc3RydWN0IGNvbXByZXNzICpjb21wcmVzcykKIAkJY2FwdHVyZSA9IHJlcXVlc3Rf
cmVjb3JkX3VzZXJfYm8ocmVxdWVzdCwgZWUsIGNhcHR1cmUpOwogCiAJCWNhcHR1cmUgPSBjYXB0
dXJlX3ZtYShjYXB0dXJlLAotCQkJCSAgICAgIHJlcXVlc3QtPmh3X2NvbnRleHQtPnN0YXRlLAor
CQkJCSAgICAgIHJlcXVlc3QtPmNvbnRleHQtPnN0YXRlLAogCQkJCSAgICAgICZlZS0+Y3R4KTsK
IAogCQljYXB0dXJlID0gY2FwdHVyZV92bWEoY2FwdHVyZSwKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfcGVyZi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJm
LmMKaW5kZXggNTA3MjM2YmQ0MWFlLi45ZmYyNmI5OTEyNzYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfcGVyZi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
cGVyZi5jCkBAIC0zMDc1LDcgKzMwNzUsNyBAQCBzdGF0aWMgdm9pZCBpOTE1X3BlcmZfZW5hYmxl
X2xvY2tlZChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtKQogCQlzdHJlYW0tPm9wcy0+
ZW5hYmxlKHN0cmVhbSk7CiAKIAlpZiAoc3RyZWFtLT5ob2xkX3ByZWVtcHRpb24pCi0JCWk5MTVf
Z2VtX2NvbnRleHRfc2V0X25vcHJlZW1wdChzdHJlYW0tPmN0eCk7CisJCWludGVsX2NvbnRleHRf
c2V0X25vcHJlZW1wdChzdHJlYW0tPnBpbm5lZF9jdHgpOwogfQogCiAvKioKQEAgLTMxMDEsNyAr
MzEwMSw3IEBAIHN0YXRpYyB2b2lkIGk5MTVfcGVyZl9kaXNhYmxlX2xvY2tlZChzdHJ1Y3QgaTkx
NV9wZXJmX3N0cmVhbSAqc3RyZWFtKQogCXN0cmVhbS0+ZW5hYmxlZCA9IGZhbHNlOwogCiAJaWYg
KHN0cmVhbS0+aG9sZF9wcmVlbXB0aW9uKQotCQlpOTE1X2dlbV9jb250ZXh0X2NsZWFyX25vcHJl
ZW1wdChzdHJlYW0tPmN0eCk7CisJCWludGVsX2NvbnRleHRfY2xlYXJfbm9wcmVlbXB0KHN0cmVh
bS0+cGlubmVkX2N0eCk7CiAKIAlpZiAoc3RyZWFtLT5vcHMtPmRpc2FibGUpCiAJCXN0cmVhbS0+
b3BzLT5kaXNhYmxlKHN0cmVhbSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3JlcXVlc3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jCmluZGV4
IGY3Y2MxM2Q5ZDBhZS4uOGExZjEwMjZmMDM0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3JlcXVlc3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVl
c3QuYwpAQCAtNjIsNiArNjIsOCBAQCBzdGF0aWMgY29uc3QgY2hhciAqaTkxNV9mZW5jZV9nZXRf
ZHJpdmVyX25hbWUoc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UpCiAKIHN0YXRpYyBjb25zdCBjaGFy
ICppOTE1X2ZlbmNlX2dldF90aW1lbGluZV9uYW1lKHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlKQog
eworCWNvbnN0IHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7CisKIAkvKgogCSAqIFRoZSB0
aW1lbGluZSBzdHJ1Y3QgKGFzIHBhcnQgb2YgdGhlIHBwZ3R0IHVuZGVybmVhdGggYSBjb250ZXh0
KQogCSAqIG1heSBiZSBmcmVlZCB3aGVuIHRoZSByZXF1ZXN0IGlzIG5vIGxvbmdlciBpbiB1c2Ug
YnkgdGhlIEdQVS4KQEAgLTc0LDcgKzc2LDggQEAgc3RhdGljIGNvbnN0IGNoYXIgKmk5MTVfZmVu
Y2VfZ2V0X3RpbWVsaW5lX25hbWUoc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UpCiAJaWYgKHRlc3Rf
Yml0KERNQV9GRU5DRV9GTEFHX1NJR05BTEVEX0JJVCwgJmZlbmNlLT5mbGFncykpCiAJCXJldHVy
biAic2lnbmFsZWQiOwogCi0JcmV0dXJuIHRvX3JlcXVlc3QoZmVuY2UpLT5nZW1fY29udGV4dC0+
bmFtZSA/OiAiW2k5MTVdIjsKKwljdHggPSB0b19yZXF1ZXN0KGZlbmNlKS0+Y29udGV4dC0+Z2Vt
X2NvbnRleHQ7CisJcmV0dXJuIGN0eCAmJiBjdHgtPm5hbWUgPyBjdHgtPm5hbWUgOiAiW2k5MTVd
IjsKIH0KIAogc3RhdGljIGJvb2wgaTkxNV9mZW5jZV9zaWduYWxlZChzdHJ1Y3QgZG1hX2ZlbmNl
ICpmZW5jZSkKQEAgLTI3Miw4ICsyNzUsOCBAQCBib29sIGk5MTVfcmVxdWVzdF9yZXRpcmUoc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJcmVtb3ZlX2Zyb21fY2xpZW50KHJxKTsKIAlsaXN0X2Rl
bCgmcnEtPmxpbmspOwogCi0JaW50ZWxfY29udGV4dF9leGl0KHJxLT5od19jb250ZXh0KTsKLQlp
bnRlbF9jb250ZXh0X3VucGluKHJxLT5od19jb250ZXh0KTsKKwlpbnRlbF9jb250ZXh0X2V4aXQo
cnEtPmNvbnRleHQpOworCWludGVsX2NvbnRleHRfdW5waW4ocnEtPmNvbnRleHQpOwogCiAJZnJl
ZV9jYXB0dXJlX2xpc3QocnEpOwogCWk5MTVfc2NoZWRfbm9kZV9maW5pKCZycS0+c2NoZWQpOwpA
QCAtMzc2LDcgKzM3OSw3IEBAIGJvb2wgX19pOTE1X3JlcXVlc3Rfc3VibWl0KHN0cnVjdCBpOTE1
X3JlcXVlc3QgKnJlcXVlc3QpCiAJaWYgKGk5MTVfcmVxdWVzdF9jb21wbGV0ZWQocmVxdWVzdCkp
CiAJCWdvdG8geGZlcjsKIAotCWlmIChpOTE1X2dlbV9jb250ZXh0X2lzX2Jhbm5lZChyZXF1ZXN0
LT5nZW1fY29udGV4dCkpCisJaWYgKGludGVsX2NvbnRleHRfaXNfYmFubmVkKHJlcXVlc3QtPmNv
bnRleHQpKQogCQlpOTE1X3JlcXVlc3Rfc2tpcChyZXF1ZXN0LCAtRUlPKTsKIAogCS8qCkBAIC02
NTUsOCArNjU4LDcgQEAgX19pOTE1X3JlcXVlc3RfY3JlYXRlKHN0cnVjdCBpbnRlbF9jb250ZXh0
ICpjZSwgZ2ZwX3QgZ2ZwKQogCQlnb3RvIGVycl9mcmVlOwogCiAJcnEtPmk5MTUgPSBjZS0+ZW5n
aW5lLT5pOTE1OwotCXJxLT5od19jb250ZXh0ID0gY2U7Ci0JcnEtPmdlbV9jb250ZXh0ID0gY2Ut
PmdlbV9jb250ZXh0OworCXJxLT5jb250ZXh0ID0gY2U7CiAJcnEtPmVuZ2luZSA9IGNlLT5lbmdp
bmU7CiAJcnEtPnJpbmcgPSBjZS0+cmluZzsKIAlycS0+ZXhlY3V0aW9uX21hc2sgPSBjZS0+ZW5n
aW5lLT5tYXNrOwpAQCAtOTA4LDcgKzkxMCw3IEBAIGk5MTVfcmVxdWVzdF9hd2FpdF9yZXF1ZXN0
KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnRvLCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpmcm9tKQogCQkJ
CQkJICAgICAgICZmcm9tLT5zdWJtaXQsCiAJCQkJCQkgICAgICAgSTkxNV9GRU5DRV9HRlApOwog
CX0gZWxzZSBpZiAoaW50ZWxfZW5naW5lX2hhc19zZW1hcGhvcmVzKHRvLT5lbmdpbmUpICYmCi0J
CSAgIHRvLT5nZW1fY29udGV4dC0+c2NoZWQucHJpb3JpdHkgPj0gSTkxNV9QUklPUklUWV9OT1JN
QUwpIHsKKwkJICAgdG8tPmNvbnRleHQtPmdlbV9jb250ZXh0LT5zY2hlZC5wcmlvcml0eSA+PSBJ
OTE1X1BSSU9SSVRZX05PUk1BTCkgewogCQlyZXQgPSBlbWl0X3NlbWFwaG9yZV93YWl0KHRvLCBm
cm9tLCBJOTE1X0ZFTkNFX0dGUCk7CiAJfSBlbHNlIHsKIAkJcmV0ID0gaTkxNV9zd19mZW5jZV9h
d2FpdF9kbWFfZmVuY2UoJnRvLT5zdWJtaXQsCkBAIC0xMjM2LDcgKzEyMzgsNyBAQCB2b2lkIF9f
aTkxNV9yZXF1ZXN0X3F1ZXVlKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAogCiB2b2lkIGk5MTVf
cmVxdWVzdF9hZGQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiB7Ci0Jc3RydWN0IGk5MTVfc2No
ZWRfYXR0ciBhdHRyID0gcnEtPmdlbV9jb250ZXh0LT5zY2hlZDsKKwlzdHJ1Y3QgaTkxNV9zY2hl
ZF9hdHRyIGF0dHIgPSBycS0+Y29udGV4dC0+Z2VtX2NvbnRleHQtPnNjaGVkOwogCXN0cnVjdCBp
bnRlbF90aW1lbGluZSAqIGNvbnN0IHRsID0gaTkxNV9yZXF1ZXN0X3RpbWVsaW5lKHJxKTsKIAlz
dHJ1Y3QgaTkxNV9yZXF1ZXN0ICpwcmV2OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3JlcXVlc3QuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5o
CmluZGV4IDk2OTkxZDY0NzU5Yy4uYjNiNjUzNGFlNzk4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3JlcXVlc3QuaApAQCAtMTA5LDkgKzEwOSw4IEBAIHN0cnVjdCBpOTE1X3JlcXVlc3QgewogCSAq
IGk5MTVfcmVxdWVzdF9mcmVlKCkgd2lsbCB0aGVuIGRlY3JlbWVudCB0aGUgcmVmY291bnQgb24g
dGhlCiAJICogY29udGV4dC4KIAkgKi8KLQlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqZ2VtX2Nv
bnRleHQ7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCXN0cnVjdCBpbnRlbF9j
b250ZXh0ICpod19jb250ZXh0OworCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjb250ZXh0OwogCXN0
cnVjdCBpbnRlbF9yaW5nICpyaW5nOwogCXN0cnVjdCBpbnRlbF90aW1lbGluZSBfX3JjdSAqdGlt
ZWxpbmU7CiAJc3RydWN0IGxpc3RfaGVhZCBzaWduYWxfbGluazsKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfc2NoZWR1bGVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3NjaGVkdWxlci5jCmluZGV4IDcyNGU5NmZlOTZlOS4uNTRmNjk0OTRlY2Y3IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3NjaGVkdWxlci5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfc2NoZWR1bGVyLmMKQEAgLTIxMyw3ICsyMTMsNyBAQCBzdGF0aWMg
dm9pZCBraWNrX3N1Ym1pc3Npb24oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAogCSAq
IElmIHdlIGFyZSBhbHJlYWR5IHRoZSBjdXJyZW50bHkgZXhlY3V0aW5nIGNvbnRleHQsIGRvbid0
CiAJICogYm90aGVyIGV2YWx1YXRpbmcgaWYgd2Ugc2hvdWxkIHByZWVtcHQgb3Vyc2VsdmVzLgog
CSAqLwotCWlmIChpbmZsaWdodC0+aHdfY29udGV4dCA9PSBycS0+aHdfY29udGV4dCkKKwlpZiAo
aW5mbGlnaHQtPmNvbnRleHQgPT0gcnEtPmNvbnRleHQpCiAJCWdvdG8gdW5sb2NrOwogCiAJZW5n
aW5lLT5leGVjbGlzdHMucXVldWVfcHJpb3JpdHlfaGludCA9IHByaW87Ci0tIAoyLjI0LjAKCl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBt
YWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3Rz
LmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

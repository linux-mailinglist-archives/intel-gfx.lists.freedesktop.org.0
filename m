Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 0740025F57
	for <lists+intel-gfx@lfdr.de>; Wed, 22 May 2019 10:21:21 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id BF992897D0;
	Wed, 22 May 2019 08:21:17 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4158E897E8
 for <intel-gfx@lists.freedesktop.org>; Wed, 22 May 2019 08:21:11 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16636790-1500050 
 for <intel-gfx@lists.freedesktop.org>; Wed, 22 May 2019 09:21:06 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 22 May 2019 09:21:01 +0100
Message-Id: <20190522082104.5117-10-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190522082104.5117-1-chris@chris-wilson.co.uk>
References: <20190522082104.5117-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [CI 10/13] drm/i915: Move GEM object domain management
 from struct_mutex to local
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VXNlIHRoZSBwZXItb2JqZWN0IGxvY2FsIGxvY2sgdG8gY29udHJvbCB0aGUgY2FjaGUgZG9tYWlu
IG9mIHRoZQppbmRpdmlkdWFsIEdFTSBvYmplY3RzLCBub3Qgc3RydWN0X211dGV4LiBUaGlzIGlz
IGEgaHVnZSBsZWFwIGZvcndhcmQKZm9yIHVzIGluIHRlcm1zIG9mIG9iamVjdC1sZXZlbCBzeW5j
aHJvbmlzYXRpb247IGV4ZWNidWZmZXJzIGFyZQpjb29yZGluYXRlZCB1c2luZyB0aGUgd3dfbXV0
ZXggYW5kIHByZWFkL3B3cml0ZSBpcyBmaW5hbGx5IGZ1bGx5CnNlcmlhbGlzZWQgYWdhaW4uCgpT
aWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KUmV2
aWV3ZWQtYnk6IE1hdHRoZXcgQXVsZCA8bWF0dGhldy5hdWxkQGludGVsLmNvbT4KLS0tCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZSAgICAgICAgICAgICAgICAgfCAgIDEgKwogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NsZmx1c2guYyAgIHwgICA0ICstCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZG1hYnVmLmMgICAgfCAgMTAgKy0KIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9kb21haW4uYyAgICB8ICA3MCArKysrKy0tLS0tCiAu
Li4vZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMgICAgfCAxMjMgKysrKysr
KysrKysrLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZmVuY2UuYyAg
ICAgfCAgOTYgKysrKysrKysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9vYmplY3QuYyAgICB8ICAgMiArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
b2JqZWN0LmggICAgfCAgMTQgKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9w
bS5jICAgICAgICB8ICAgNyArLQogLi4uL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2h1Z2Vf
cGFnZXMuYyAgIHwgIDEyICstCiAuLi4vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvaGVy
ZW5jeS5jICAgfCAgMTIgKysKIC4uLi9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2Nv
bnRleHQuYyB8ICAyMCArKysKIC4uLi9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX21t
YW4uYyAgICB8ICAgNiArCiAuLi4vZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9waHlz
LmMgICAgfCAgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVj
ay5jICB8ICAgNCArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYyAgICAg
ICAgfCAgIDIgKwogLi4uL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF93b3JrYXJvdW5kcy5jICAg
IHwgICA2ICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9jbWRfcGFyc2VyLmMgICAgICAgICB8
ICAgMiArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMgICAgICAgICAgfCAg
IDggKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfY21kX3BhcnNlci5jICAgICAgICB8ICAy
MyArKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jICAgICAgICAgICAgICAgfCAx
MjIgKysrKysrKysrLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5j
ICAgICAgICAgICB8ICAgNSArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fcmVuZGVy
X3N0YXRlLmMgIHwgICAyICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMgICAgICAg
ICAgICAgICB8ICAgOCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuaCAgICAgICAg
ICAgICAgIHwgIDEyICsrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kaXNwbGF5LmMgICAg
ICAgICAgfCAgIDUgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2xvZy5jICAgICAg
ICAgIHwgICA2ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9vdmVybGF5LmMgICAgICAg
ICAgfCAgMjUgKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdWNfZncuYyAgICAgICAg
ICAgIHwgICA2ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9yZXF1ZXN0
LmMgfCAgIDQgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2lndF9zcGlubmVyLmMg
IHwgICAyICsKIDMxIGZpbGVzIGNoYW5nZWQsIDQ0MyBpbnNlcnRpb25zKCspLCAxODAgZGVsZXRp
b25zKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX2ZlbmNlLmMKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZSBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCmluZGV4IDlmNWY0YWNhY2FlNS4uZTUzNDhj
MzU1OTg3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQorKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQpAQCAtOTMsNiArOTMsNyBAQCBnZW0teSArPSBc
CiAJZ2VtL2k5MTVfZ2VtX2RtYWJ1Zi5vIFwKIAlnZW0vaTkxNV9nZW1fZG9tYWluLm8gXAogCWdl
bS9pOTE1X2dlbV9leGVjYnVmZmVyLm8gXAorCWdlbS9pOTE1X2dlbV9mZW5jZS5vIFwKIAlnZW0v
aTkxNV9nZW1faW50ZXJuYWwubyBcCiAJZ2VtL2k5MTVfZ2VtX29iamVjdC5vIFwKIAlnZW0vaTkx
NV9nZW1fbW1hbi5vIFwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV9jbGZsdXNoLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY2xmbHVz
aC5jCmluZGV4IDQ1ZDIzOGQ3ODRmYy4uNTM3YWEyMzM3Y2M4IDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY2xmbHVzaC5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9jbGZsdXNoLmMKQEAgLTk1LDYgKzk1LDggQEAgYm9vbCBpOTE1
X2dlbV9jbGZsdXNoX29iamVjdChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogewog
CXN0cnVjdCBjbGZsdXNoICpjbGZsdXNoOwogCisJYXNzZXJ0X29iamVjdF9oZWxkKG9iaik7CisK
IAkvKgogCSAqIFN0b2xlbiBtZW1vcnkgaXMgYWx3YXlzIGNvaGVyZW50IHdpdGggdGhlIEdQVSBh
cyBpdCBpcyBleHBsaWNpdGx5CiAJICogbWFya2VkIGFzIHdjIGJ5IHRoZSBzeXN0ZW0sIG9yIHRo
ZSBzeXN0ZW0gaXMgY2FjaGUtY29oZXJlbnQuCkBAIC0xNDQsOSArMTQ2LDcgQEAgYm9vbCBpOTE1
X2dlbV9jbGZsdXNoX29iamVjdChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCQkJ
CQkJdHJ1ZSwgSTkxNV9GRU5DRV9USU1FT1VULAogCQkJCQkJSTkxNV9GRU5DRV9HRlApOwogCi0J
CXJlc2VydmF0aW9uX29iamVjdF9sb2NrKG9iai0+cmVzdiwgTlVMTCk7CiAJCXJlc2VydmF0aW9u
X29iamVjdF9hZGRfZXhjbF9mZW5jZShvYmotPnJlc3YsICZjbGZsdXNoLT5kbWEpOwotCQlyZXNl
cnZhdGlvbl9vYmplY3RfdW5sb2NrKG9iai0+cmVzdik7CiAKIAkJaTkxNV9zd19mZW5jZV9jb21t
aXQoJmNsZmx1c2gtPndhaXQpOwogCX0gZWxzZSBpZiAob2JqLT5tbS5wYWdlcykgewpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RtYWJ1Zi5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RtYWJ1Zi5jCmluZGV4IDYyNTM5N2RlYjcwMS4u
YTkzZTIzM2NmYWE5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fZG1hYnVmLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RtYWJ1
Zi5jCkBAIC0xNTEsNyArMTUxLDYgQEAgc3RhdGljIGludCBpOTE1X2dlbV9kbWFidWZfbW1hcChz
dHJ1Y3QgZG1hX2J1ZiAqZG1hX2J1Ziwgc3RydWN0IHZtX2FyZWFfc3RydWN0ICoKIHN0YXRpYyBp
bnQgaTkxNV9nZW1fYmVnaW5fY3B1X2FjY2VzcyhzdHJ1Y3QgZG1hX2J1ZiAqZG1hX2J1ZiwgZW51
bSBkbWFfZGF0YV9kaXJlY3Rpb24gZGlyZWN0aW9uKQogewogCXN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0ICpvYmogPSBkbWFfYnVmX3RvX29iaihkbWFfYnVmKTsKLQlzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2ID0gb2JqLT5iYXNlLmRldjsKIAlib29sIHdyaXRlID0gKGRpcmVjdGlvbiA9PSBETUFf
QklESVJFQ1RJT05BTCB8fCBkaXJlY3Rpb24gPT0gRE1BX1RPX0RFVklDRSk7CiAJaW50IGVycjsK
IApAQCAtMTU5LDEyICsxNTgsMTIgQEAgc3RhdGljIGludCBpOTE1X2dlbV9iZWdpbl9jcHVfYWNj
ZXNzKHN0cnVjdCBkbWFfYnVmICpkbWFfYnVmLCBlbnVtIGRtYV9kYXRhX2RpcmUKIAlpZiAoZXJy
KQogCQlyZXR1cm4gZXJyOwogCi0JZXJyID0gaTkxNV9tdXRleF9sb2NrX2ludGVycnVwdGlibGUo
ZGV2KTsKKwllcnIgPSBpOTE1X2dlbV9vYmplY3RfbG9ja19pbnRlcnJ1cHRpYmxlKG9iaik7CiAJ
aWYgKGVycikKIAkJZ290byBvdXQ7CiAKIAllcnIgPSBpOTE1X2dlbV9vYmplY3Rfc2V0X3RvX2Nw
dV9kb21haW4ob2JqLCB3cml0ZSk7Ci0JbXV0ZXhfdW5sb2NrKCZkZXYtPnN0cnVjdF9tdXRleCk7
CisJaTkxNV9nZW1fb2JqZWN0X3VubG9jayhvYmopOwogCiBvdXQ6CiAJaTkxNV9nZW1fb2JqZWN0
X3VucGluX3BhZ2VzKG9iaik7CkBAIC0xNzQsMTkgKzE3MywxOCBAQCBzdGF0aWMgaW50IGk5MTVf
Z2VtX2JlZ2luX2NwdV9hY2Nlc3Moc3RydWN0IGRtYV9idWYgKmRtYV9idWYsIGVudW0gZG1hX2Rh
dGFfZGlyZQogc3RhdGljIGludCBpOTE1X2dlbV9lbmRfY3B1X2FjY2VzcyhzdHJ1Y3QgZG1hX2J1
ZiAqZG1hX2J1ZiwgZW51bSBkbWFfZGF0YV9kaXJlY3Rpb24gZGlyZWN0aW9uKQogewogCXN0cnVj
dCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPSBkbWFfYnVmX3RvX29iaihkbWFfYnVmKTsKLQlz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gb2JqLT5iYXNlLmRldjsKIAlpbnQgZXJyOwogCiAJZXJy
ID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9wYWdlcyhvYmopOwogCWlmIChlcnIpCiAJCXJldHVybiBl
cnI7CiAKLQllcnIgPSBpOTE1X211dGV4X2xvY2tfaW50ZXJydXB0aWJsZShkZXYpOworCWVyciA9
IGk5MTVfZ2VtX29iamVjdF9sb2NrX2ludGVycnVwdGlibGUob2JqKTsKIAlpZiAoZXJyKQogCQln
b3RvIG91dDsKIAogCWVyciA9IGk5MTVfZ2VtX29iamVjdF9zZXRfdG9fZ3R0X2RvbWFpbihvYmos
IGZhbHNlKTsKLQltdXRleF91bmxvY2soJmRldi0+c3RydWN0X211dGV4KTsKKwlpOTE1X2dlbV9v
YmplY3RfdW5sb2NrKG9iaik7CiAKIG91dDoKIAlpOTE1X2dlbV9vYmplY3RfdW5waW5fcGFnZXMo
b2JqKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9kb21h
aW4uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9kb21haW4uYwppbmRleCBi
YmM3ZmI3NTgxODYuLmNjZTk2ZTZjNmU1MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9kb21haW4uYwpAQCAtMjksOSArMjksOSBAQCB2b2lkIGk5MTVfZ2VtX29iamVjdF9m
bHVzaF9pZl9kaXNwbGF5KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiAJaWYgKCFS
RUFEX09OQ0Uob2JqLT5waW5fZ2xvYmFsKSkKIAkJcmV0dXJuOwogCi0JbXV0ZXhfbG9jaygmb2Jq
LT5iYXNlLmRldi0+c3RydWN0X211dGV4KTsKKwlpOTE1X2dlbV9vYmplY3RfbG9jayhvYmopOwog
CV9faTkxNV9nZW1fb2JqZWN0X2ZsdXNoX2Zvcl9kaXNwbGF5KG9iaik7Ci0JbXV0ZXhfdW5sb2Nr
KCZvYmotPmJhc2UuZGV2LT5zdHJ1Y3RfbXV0ZXgpOworCWk5MTVfZ2VtX29iamVjdF91bmxvY2so
b2JqKTsKIH0KIAogLyoqCkBAIC00NywxMSArNDcsMTAgQEAgaTkxNV9nZW1fb2JqZWN0X3NldF90
b193Y19kb21haW4oc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwgYm9vbCB3cml0ZSkK
IHsKIAlpbnQgcmV0OwogCi0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmb2JqLT5iYXNlLmRldi0+c3Ry
dWN0X211dGV4KTsKKwlhc3NlcnRfb2JqZWN0X2hlbGQob2JqKTsKIAogCXJldCA9IGk5MTVfZ2Vt
X29iamVjdF93YWl0KG9iaiwKIAkJCQkgICBJOTE1X1dBSVRfSU5URVJSVVBUSUJMRSB8Ci0JCQkJ
ICAgSTkxNV9XQUlUX0xPQ0tFRCB8CiAJCQkJICAgKHdyaXRlID8gSTkxNV9XQUlUX0FMTCA6IDAp
LAogCQkJCSAgIE1BWF9TQ0hFRFVMRV9USU1FT1VUKTsKIAlpZiAocmV0KQpAQCAtMTA5LDExICsx
MDgsMTAgQEAgaTkxNV9nZW1fb2JqZWN0X3NldF90b19ndHRfZG9tYWluKHN0cnVjdCBkcm1faTkx
NV9nZW1fb2JqZWN0ICpvYmosIGJvb2wgd3JpdGUpCiB7CiAJaW50IHJldDsKIAotCWxvY2tkZXBf
YXNzZXJ0X2hlbGQoJm9iai0+YmFzZS5kZXYtPnN0cnVjdF9tdXRleCk7CisJYXNzZXJ0X29iamVj
dF9oZWxkKG9iaik7CiAKIAlyZXQgPSBpOTE1X2dlbV9vYmplY3Rfd2FpdChvYmosCiAJCQkJICAg
STkxNV9XQUlUX0lOVEVSUlVQVElCTEUgfAotCQkJCSAgIEk5MTVfV0FJVF9MT0NLRUQgfAogCQkJ
CSAgICh3cml0ZSA/IEk5MTVfV0FJVF9BTEwgOiAwKSwKIAkJCQkgICBNQVhfU0NIRURVTEVfVElN
RU9VVCk7CiAJaWYgKHJldCkKQEAgLTE3OSw3ICsxNzcsNyBAQCBpbnQgaTkxNV9nZW1fb2JqZWN0
X3NldF9jYWNoZV9sZXZlbChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCXN0cnVj
dCBpOTE1X3ZtYSAqdm1hOwogCWludCByZXQ7CiAKLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZvYmot
PmJhc2UuZGV2LT5zdHJ1Y3RfbXV0ZXgpOworCWFzc2VydF9vYmplY3RfaGVsZChvYmopOwogCiAJ
aWYgKG9iai0+Y2FjaGVfbGV2ZWwgPT0gY2FjaGVfbGV2ZWwpCiAJCXJldHVybiAwOwpAQCAtMjI4
LDcgKzIyNiw2IEBAIGludCBpOTE1X2dlbV9vYmplY3Rfc2V0X2NhY2hlX2xldmVsKHN0cnVjdCBk
cm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJCSAqLwogCQlyZXQgPSBpOTE1X2dlbV9vYmplY3Rf
d2FpdChvYmosCiAJCQkJCSAgIEk5MTVfV0FJVF9JTlRFUlJVUFRJQkxFIHwKLQkJCQkJICAgSTkx
NV9XQUlUX0xPQ0tFRCB8CiAJCQkJCSAgIEk5MTVfV0FJVF9BTEwsCiAJCQkJCSAgIE1BWF9TQ0hF
RFVMRV9USU1FT1VUKTsKIAkJaWYgKHJldCkKQEAgLTM3MiwxMiArMzY5LDE2IEBAIGludCBpOTE1
X2dlbV9zZXRfY2FjaGluZ19pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRh
LAogCWlmIChyZXQpCiAJCWdvdG8gb3V0OwogCi0JcmV0ID0gaTkxNV9tdXRleF9sb2NrX2ludGVy
cnVwdGlibGUoZGV2KTsKKwlyZXQgPSBtdXRleF9sb2NrX2ludGVycnVwdGlibGUoJmk5MTUtPmRy
bS5zdHJ1Y3RfbXV0ZXgpOwogCWlmIChyZXQpCiAJCWdvdG8gb3V0OwogCi0JcmV0ID0gaTkxNV9n
ZW1fb2JqZWN0X3NldF9jYWNoZV9sZXZlbChvYmosIGxldmVsKTsKLQltdXRleF91bmxvY2soJmRl
di0+c3RydWN0X211dGV4KTsKKwlyZXQgPSBpOTE1X2dlbV9vYmplY3RfbG9ja19pbnRlcnJ1cHRp
YmxlKG9iaik7CisJaWYgKHJldCA9PSAwKSB7CisJCXJldCA9IGk5MTVfZ2VtX29iamVjdF9zZXRf
Y2FjaGVfbGV2ZWwob2JqLCBsZXZlbCk7CisJCWk5MTVfZ2VtX29iamVjdF91bmxvY2sob2JqKTsK
Kwl9CisJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAogb3V0OgogCWk5
MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKQEAgLTM5OSw3ICs0MDAsNyBAQCBpOTE1X2dlbV9vYmpl
Y3RfcGluX3RvX2Rpc3BsYXlfcGxhbmUoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwK
IAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKIAlpbnQgcmV0OwogCi0JbG9ja2RlcF9hc3NlcnRfaGVs
ZCgmb2JqLT5iYXNlLmRldi0+c3RydWN0X211dGV4KTsKKwlhc3NlcnRfb2JqZWN0X2hlbGQob2Jq
KTsKIAogCS8qIE1hcmsgdGhlIGdsb2JhbCBwaW4gZWFybHkgc28gdGhhdCB3ZSBhY2NvdW50IGZv
ciB0aGUKIAkgKiBkaXNwbGF5IGNvaGVyZW5jeSB3aGlsc3Qgc2V0dGluZyB1cCB0aGUgY2FjaGUg
ZG9tYWlucy4KQEAgLTQ4NCwxNiArNDg1LDE4IEBAIHN0YXRpYyB2b2lkIGk5MTVfZ2VtX29iamVj
dF9idW1wX2luYWN0aXZlX2dndHQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIHZv
aWQKIGk5MTVfZ2VtX29iamVjdF91bnBpbl9mcm9tX2Rpc3BsYXlfcGxhbmUoc3RydWN0IGk5MTVf
dm1hICp2bWEpCiB7Ci0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmdm1hLT52bS0+aTkxNS0+ZHJtLnN0
cnVjdF9tdXRleCk7CisJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IHZtYS0+b2Jq
OworCisJYXNzZXJ0X29iamVjdF9oZWxkKG9iaik7CiAKLQlpZiAoV0FSTl9PTih2bWEtPm9iai0+
cGluX2dsb2JhbCA9PSAwKSkKKwlpZiAoV0FSTl9PTihvYmotPnBpbl9nbG9iYWwgPT0gMCkpCiAJ
CXJldHVybjsKIAotCWlmICgtLXZtYS0+b2JqLT5waW5fZ2xvYmFsID09IDApCisJaWYgKC0tb2Jq
LT5waW5fZ2xvYmFsID09IDApCiAJCXZtYS0+ZGlzcGxheV9hbGlnbm1lbnQgPSBJOTE1X0dUVF9N
SU5fQUxJR05NRU5UOwogCiAJLyogQnVtcCB0aGUgTFJVIHRvIHRyeSBhbmQgYXZvaWQgcHJlbWF0
dXJlIGV2aWN0aW9uIHdoaWxzdCBmbGlwcGluZyAgKi8KLQlpOTE1X2dlbV9vYmplY3RfYnVtcF9p
bmFjdGl2ZV9nZ3R0KHZtYS0+b2JqKTsKKwlpOTE1X2dlbV9vYmplY3RfYnVtcF9pbmFjdGl2ZV9n
Z3R0KG9iaik7CiAKIAlpOTE1X3ZtYV91bnBpbih2bWEpOwogfQpAQCAtNTExLDExICs1MTQsMTAg
QEAgaTkxNV9nZW1fb2JqZWN0X3NldF90b19jcHVfZG9tYWluKHN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0ICpvYmosIGJvb2wgd3JpdGUpCiB7CiAJaW50IHJldDsKIAotCWxvY2tkZXBfYXNzZXJ0
X2hlbGQoJm9iai0+YmFzZS5kZXYtPnN0cnVjdF9tdXRleCk7CisJYXNzZXJ0X29iamVjdF9oZWxk
KG9iaik7CiAKIAlyZXQgPSBpOTE1X2dlbV9vYmplY3Rfd2FpdChvYmosCiAJCQkJICAgSTkxNV9X
QUlUX0lOVEVSUlVQVElCTEUgfAotCQkJCSAgIEk5MTVfV0FJVF9MT0NLRUQgfAogCQkJCSAgICh3
cml0ZSA/IEk5MTVfV0FJVF9BTEwgOiAwKSwKIAkJCQkgICBNQVhfU0NIRURVTEVfVElNRU9VVCk7
CiAJaWYgKHJldCkKQEAgLTYzNyw3ICs2MzksNyBAQCBpOTE1X2dlbV9zZXRfZG9tYWluX2lvY3Rs
KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAJaWYgKGVycikKIAkJZ290byBv
dXQ7CiAKLQllcnIgPSBpOTE1X211dGV4X2xvY2tfaW50ZXJydXB0aWJsZShkZXYpOworCWVyciA9
IGk5MTVfZ2VtX29iamVjdF9sb2NrX2ludGVycnVwdGlibGUob2JqKTsKIAlpZiAoZXJyKQogCQln
b3RvIG91dF91bnBpbjsKIApAQCAtNjUxLDcgKzY1Myw3IEBAIGk5MTVfZ2VtX3NldF9kb21haW5f
aW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIAkvKiBBbmQgYnVtcCB0
aGUgTFJVIGZvciB0aGlzIGFjY2VzcyAqLwogCWk5MTVfZ2VtX29iamVjdF9idW1wX2luYWN0aXZl
X2dndHQob2JqKTsKIAotCW11dGV4X3VubG9jaygmZGV2LT5zdHJ1Y3RfbXV0ZXgpOworCWk5MTVf
Z2VtX29iamVjdF91bmxvY2sob2JqKTsKIAogCWlmICh3cml0ZV9kb21haW4gIT0gMCkKIAkJaW50
ZWxfZmJfb2JqX2ludmFsaWRhdGUob2JqLApAQCAtNjc0LDIyICs2NzYsMjMgQEAgaW50IGk5MTVf
Z2VtX29iamVjdF9wcmVwYXJlX3JlYWQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwK
IHsKIAlpbnQgcmV0OwogCi0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmb2JqLT5iYXNlLmRldi0+c3Ry
dWN0X211dGV4KTsKLQogCSpuZWVkc19jbGZsdXNoID0gMDsKIAlpZiAoIWk5MTVfZ2VtX29iamVj
dF9oYXNfc3RydWN0X3BhZ2Uob2JqKSkKIAkJcmV0dXJuIC1FTk9ERVY7CiAKKwlyZXQgPSBpOTE1
X2dlbV9vYmplY3RfbG9ja19pbnRlcnJ1cHRpYmxlKG9iaik7CisJaWYgKHJldCkKKwkJcmV0dXJu
IHJldDsKKwogCXJldCA9IGk5MTVfZ2VtX29iamVjdF93YWl0KG9iaiwKLQkJCQkgICBJOTE1X1dB
SVRfSU5URVJSVVBUSUJMRSB8Ci0JCQkJICAgSTkxNV9XQUlUX0xPQ0tFRCwKKwkJCQkgICBJOTE1
X1dBSVRfSU5URVJSVVBUSUJMRSwKIAkJCQkgICBNQVhfU0NIRURVTEVfVElNRU9VVCk7CiAJaWYg
KHJldCkKLQkJcmV0dXJuIHJldDsKKwkJZ290byBlcnJfdW5sb2NrOwogCiAJcmV0ID0gaTkxNV9n
ZW1fb2JqZWN0X3Bpbl9wYWdlcyhvYmopOwogCWlmIChyZXQpCi0JCXJldHVybiByZXQ7CisJCWdv
dG8gZXJyX3VubG9jazsKIAogCWlmIChvYmotPmNhY2hlX2NvaGVyZW50ICYgSTkxNV9CT19DQUNI
RV9DT0hFUkVOVF9GT1JfUkVBRCB8fAogCSAgICAhc3RhdGljX2NwdV9oYXMoWDg2X0ZFQVRVUkVf
Q0xGTFVTSCkpIHsKQEAgLTcxNyw2ICs3MjAsOCBAQCBpbnQgaTkxNV9nZW1fb2JqZWN0X3ByZXBh
cmVfcmVhZChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCiBlcnJfdW5waW46CiAJ
aTkxNV9nZW1fb2JqZWN0X3VucGluX3BhZ2VzKG9iaik7CitlcnJfdW5sb2NrOgorCWk5MTVfZ2Vt
X29iamVjdF91bmxvY2sob2JqKTsKIAlyZXR1cm4gcmV0OwogfQogCkBAIC03MjUsMjMgKzczMCwy
NCBAQCBpbnQgaTkxNV9nZW1fb2JqZWN0X3ByZXBhcmVfd3JpdGUoc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKm9iaiwKIHsKIAlpbnQgcmV0OwogCi0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmb2Jq
LT5iYXNlLmRldi0+c3RydWN0X211dGV4KTsKLQogCSpuZWVkc19jbGZsdXNoID0gMDsKIAlpZiAo
IWk5MTVfZ2VtX29iamVjdF9oYXNfc3RydWN0X3BhZ2Uob2JqKSkKIAkJcmV0dXJuIC1FTk9ERVY7
CiAKKwlyZXQgPSBpOTE1X2dlbV9vYmplY3RfbG9ja19pbnRlcnJ1cHRpYmxlKG9iaik7CisJaWYg
KHJldCkKKwkJcmV0dXJuIHJldDsKKwogCXJldCA9IGk5MTVfZ2VtX29iamVjdF93YWl0KG9iaiwK
IAkJCQkgICBJOTE1X1dBSVRfSU5URVJSVVBUSUJMRSB8Ci0JCQkJICAgSTkxNV9XQUlUX0xPQ0tF
RCB8CiAJCQkJICAgSTkxNV9XQUlUX0FMTCwKIAkJCQkgICBNQVhfU0NIRURVTEVfVElNRU9VVCk7
CiAJaWYgKHJldCkKLQkJcmV0dXJuIHJldDsKKwkJZ290byBlcnJfdW5sb2NrOwogCiAJcmV0ID0g
aTkxNV9nZW1fb2JqZWN0X3Bpbl9wYWdlcyhvYmopOwogCWlmIChyZXQpCi0JCXJldHVybiByZXQ7
CisJCWdvdG8gZXJyX3VubG9jazsKIAogCWlmIChvYmotPmNhY2hlX2NvaGVyZW50ICYgSTkxNV9C
T19DQUNIRV9DT0hFUkVOVF9GT1JfV1JJVEUgfHwKIAkgICAgIXN0YXRpY19jcHVfaGFzKFg4Nl9G
RUFUVVJFX0NMRkxVU0gpKSB7CkBAIC03NzgsNSArNzg0LDcgQEAgaW50IGk5MTVfZ2VtX29iamVj
dF9wcmVwYXJlX3dyaXRlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAKIGVycl91
bnBpbjoKIAlpOTE1X2dlbV9vYmplY3RfdW5waW5fcGFnZXMob2JqKTsKK2Vycl91bmxvY2s6CisJ
aTkxNV9nZW1fb2JqZWN0X3VubG9jayhvYmopOwogCXJldHVybiByZXQ7CiB9CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYwppbmRleCAwOWU2NGJmMzM4
NDIuLmVkNTIyZmRmYmU3ZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5
MTVfZ2VtX2V4ZWNidWZmZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fZXhlY2J1ZmZlci5jCkBAIC0xMDc1LDcgKzEwNzUsOSBAQCBzdGF0aWMgdm9pZCAqcmVsb2Nf
aW9tYXAoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAkJaWYgKHVzZV9jcHVfcmVs
b2MoY2FjaGUsIG9iaikpCiAJCQlyZXR1cm4gTlVMTDsKIAorCQlpOTE1X2dlbV9vYmplY3RfbG9j
ayhvYmopOwogCQllcnIgPSBpOTE1X2dlbV9vYmplY3Rfc2V0X3RvX2d0dF9kb21haW4ob2JqLCB0
cnVlKTsKKwkJaTkxNV9nZW1fb2JqZWN0X3VubG9jayhvYmopOwogCQlpZiAoZXJyKQogCQkJcmV0
dXJuIEVSUl9QVFIoZXJyKTsKIApAQCAtMTE2NCw2ICsxMTY2LDI2IEBAIHN0YXRpYyB2b2lkIGNs
Zmx1c2hfd3JpdGUzMih1MzIgKmFkZHIsIHUzMiB2YWx1ZSwgdW5zaWduZWQgaW50IGZsdXNoZXMp
CiAJCSphZGRyID0gdmFsdWU7CiB9CiAKK3N0YXRpYyBpbnQgcmVsb2NfbW92ZV90b19ncHUoc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnEsIHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQoreworCXN0cnVjdCBk
cm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPSB2bWEtPm9iajsKKwlpbnQgZXJyOworCisJaTkxNV92
bWFfbG9jayh2bWEpOworCisJaWYgKG9iai0+Y2FjaGVfZGlydHkgJiB+b2JqLT5jYWNoZV9jb2hl
cmVudCkKKwkJaTkxNV9nZW1fY2xmbHVzaF9vYmplY3Qob2JqLCAwKTsKKwlvYmotPndyaXRlX2Rv
bWFpbiA9IDA7CisKKwllcnIgPSBpOTE1X3JlcXVlc3RfYXdhaXRfb2JqZWN0KHJxLCB2bWEtPm9i
aiwgdHJ1ZSk7CisJaWYgKGVyciA9PSAwKQorCQllcnIgPSBpOTE1X3ZtYV9tb3ZlX3RvX2FjdGl2
ZSh2bWEsIHJxLCBFWEVDX09CSkVDVF9XUklURSk7CisKKwlpOTE1X3ZtYV91bmxvY2sodm1hKTsK
KworCXJldHVybiBlcnI7Cit9CisKIHN0YXRpYyBpbnQgX19yZWxvY19ncHVfYWxsb2Moc3RydWN0
IGk5MTVfZXhlY2J1ZmZlciAqZWIsCiAJCQkgICAgIHN0cnVjdCBpOTE1X3ZtYSAqdm1hLAogCQkJ
ICAgICB1bnNpZ25lZCBpbnQgbGVuKQpAQCAtMTE3NSwxNSArMTE5Nyw2IEBAIHN0YXRpYyBpbnQg
X19yZWxvY19ncHVfYWxsb2Moc3RydWN0IGk5MTVfZXhlY2J1ZmZlciAqZWIsCiAJdTMyICpjbWQ7
CiAJaW50IGVycjsKIAotCWlmIChEQkdfRk9SQ0VfUkVMT0MgPT0gRk9SQ0VfR1BVX1JFTE9DKSB7
Ci0JCW9iaiA9IHZtYS0+b2JqOwotCQlpZiAob2JqLT5jYWNoZV9kaXJ0eSAmIH5vYmotPmNhY2hl
X2NvaGVyZW50KQotCQkJaTkxNV9nZW1fY2xmbHVzaF9vYmplY3Qob2JqLCAwKTsKLQkJb2JqLT53
cml0ZV9kb21haW4gPSAwOwotCX0KLQotCUdFTV9CVUdfT04odm1hLT5vYmotPndyaXRlX2RvbWFp
biAmIEk5MTVfR0VNX0RPTUFJTl9DUFUpOwotCiAJb2JqID0gaTkxNV9nZW1fYmF0Y2hfcG9vbF9n
ZXQoJmViLT5lbmdpbmUtPmJhdGNoX3Bvb2wsIFBBR0VfU0laRSk7CiAJaWYgKElTX0VSUihvYmop
KQogCQlyZXR1cm4gUFRSX0VSUihvYmopOwpAQCAtMTIxMiw3ICsxMjI1LDcgQEAgc3RhdGljIGlu
dCBfX3JlbG9jX2dwdV9hbGxvYyhzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYiwKIAkJZ290byBl
cnJfdW5waW47CiAJfQogCi0JZXJyID0gaTkxNV9yZXF1ZXN0X2F3YWl0X29iamVjdChycSwgdm1h
LT5vYmosIHRydWUpOworCWVyciA9IHJlbG9jX21vdmVfdG9fZ3B1KHJxLCB2bWEpOwogCWlmIChl
cnIpCiAJCWdvdG8gZXJyX3JlcXVlc3Q7CiAKQEAgLTEyMjAsMTQgKzEyMzMsMTIgQEAgc3RhdGlj
IGludCBfX3JlbG9jX2dwdV9hbGxvYyhzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYiwKIAkJCQkJ
YmF0Y2gtPm5vZGUuc3RhcnQsIFBBR0VfU0laRSwKIAkJCQkJY2FjaGUtPmdlbiA+IDUgPyAwIDog
STkxNV9ESVNQQVRDSF9TRUNVUkUpOwogCWlmIChlcnIpCi0JCWdvdG8gZXJyX3JlcXVlc3Q7CisJ
CWdvdG8gc2tpcF9yZXF1ZXN0OwogCisJaTkxNV92bWFfbG9jayhiYXRjaCk7CiAJR0VNX0JVR19P
TighcmVzZXJ2YXRpb25fb2JqZWN0X3Rlc3Rfc2lnbmFsZWRfcmN1KGJhdGNoLT5yZXN2LCB0cnVl
KSk7CiAJZXJyID0gaTkxNV92bWFfbW92ZV90b19hY3RpdmUoYmF0Y2gsIHJxLCAwKTsKLQlpZiAo
ZXJyKQotCQlnb3RvIHNraXBfcmVxdWVzdDsKLQotCWVyciA9IGk5MTVfdm1hX21vdmVfdG9fYWN0
aXZlKHZtYSwgcnEsIEVYRUNfT0JKRUNUX1dSSVRFKTsKKwlpOTE1X3ZtYV91bmxvY2soYmF0Y2gp
OwogCWlmIChlcnIpCiAJCWdvdG8gc2tpcF9yZXF1ZXN0OwogCkBAIC0xODM3LDI0ICsxODQ4LDU5
IEBAIHN0YXRpYyBpbnQgZWJfcmVsb2NhdGUoc3RydWN0IGk5MTVfZXhlY2J1ZmZlciAqZWIpCiBz
dGF0aWMgaW50IGViX21vdmVfdG9fZ3B1KHN0cnVjdCBpOTE1X2V4ZWNidWZmZXIgKmViKQogewog
CWNvbnN0IHVuc2lnbmVkIGludCBjb3VudCA9IGViLT5idWZmZXJfY291bnQ7CisJc3RydWN0IHd3
X2FjcXVpcmVfY3R4IGFjcXVpcmU7CiAJdW5zaWduZWQgaW50IGk7Ci0JaW50IGVycjsKKwlpbnQg
ZXJyID0gMDsKKworCXd3X2FjcXVpcmVfaW5pdCgmYWNxdWlyZSwgJnJlc2VydmF0aW9uX3d3X2Ns
YXNzKTsKIAogCWZvciAoaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CisJCXN0cnVjdCBpOTE1X3Zt
YSAqdm1hID0gZWItPnZtYVtpXTsKKworCQllcnIgPSB3d19tdXRleF9sb2NrX2ludGVycnVwdGli
bGUoJnZtYS0+cmVzdi0+bG9jaywgJmFjcXVpcmUpOworCQlpZiAoIWVycikKKwkJCWNvbnRpbnVl
OworCisJCUdFTV9CVUdfT04oZXJyID09IC1FQUxSRUFEWSk7IC8qIE5vIGR1cGxpY2F0ZSB2bWEg
Ki8KKworCQlpZiAoZXJyID09IC1FREVBRExLKSB7CisJCQlHRU1fQlVHX09OKGkgPT0gMCk7CisJ
CQlkbyB7CisJCQkJaW50IGogPSBpIC0gMTsKKworCQkJCXd3X211dGV4X3VubG9jaygmZWItPnZt
YVtqXS0+cmVzdi0+bG9jayk7CisKKwkJCQlzd2FwKGViLT5mbGFnc1tpXSwgZWItPmZsYWdzW2pd
KTsKKwkJCQlzd2FwKGViLT52bWFbaV0sICBlYi0+dm1hW2pdKTsKKwkJCQllYi0+dm1hW2ldLT5l
eGVjX2ZsYWdzID0gJmViLT5mbGFnc1tpXTsKKwkJCX0gd2hpbGUgKC0taSk7CisJCQlHRU1fQlVH
X09OKHZtYSAhPSBlYi0+dm1hWzBdKTsKKwkJCXZtYS0+ZXhlY19mbGFncyA9ICZlYi0+ZmxhZ3Nb
MF07CisKKwkJCWVyciA9IHd3X211dGV4X2xvY2tfc2xvd19pbnRlcnJ1cHRpYmxlKCZ2bWEtPnJl
c3YtPmxvY2ssCisJCQkJCQkJICAgICAgICZhY3F1aXJlKTsKKwkJfQorCQlpZiAoZXJyKQorCQkJ
YnJlYWs7CisJfQorCXd3X2FjcXVpcmVfZG9uZSgmYWNxdWlyZSk7CisKKwl3aGlsZSAoaS0tKSB7
CiAJCXVuc2lnbmVkIGludCBmbGFncyA9IGViLT5mbGFnc1tpXTsKIAkJc3RydWN0IGk5MTVfdm1h
ICp2bWEgPSBlYi0+dm1hW2ldOwogCQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0g
dm1hLT5vYmo7CiAKKwkJYXNzZXJ0X3ZtYV9oZWxkKHZtYSk7CisKIAkJaWYgKGZsYWdzICYgRVhF
Q19PQkpFQ1RfQ0FQVFVSRSkgewogCQkJc3RydWN0IGk5MTVfY2FwdHVyZV9saXN0ICpjYXB0dXJl
OwogCiAJCQljYXB0dXJlID0ga21hbGxvYyhzaXplb2YoKmNhcHR1cmUpLCBHRlBfS0VSTkVMKTsK
LQkJCWlmICh1bmxpa2VseSghY2FwdHVyZSkpCi0JCQkJcmV0dXJuIC1FTk9NRU07Ci0KLQkJCWNh
cHR1cmUtPm5leHQgPSBlYi0+cmVxdWVzdC0+Y2FwdHVyZV9saXN0OwotCQkJY2FwdHVyZS0+dm1h
ID0gZWItPnZtYVtpXTsKLQkJCWViLT5yZXF1ZXN0LT5jYXB0dXJlX2xpc3QgPSBjYXB0dXJlOwor
CQkJaWYgKGNhcHR1cmUpIHsKKwkJCQljYXB0dXJlLT5uZXh0ID0gZWItPnJlcXVlc3QtPmNhcHR1
cmVfbGlzdDsKKwkJCQljYXB0dXJlLT52bWEgPSB2bWE7CisJCQkJZWItPnJlcXVlc3QtPmNhcHR1
cmVfbGlzdCA9IGNhcHR1cmU7CisJCQl9CiAJCX0KIAogCQkvKgpAQCAtMTg3NCwyNCArMTkyMCwx
NSBAQCBzdGF0aWMgaW50IGViX21vdmVfdG9fZ3B1KHN0cnVjdCBpOTE1X2V4ZWNidWZmZXIgKmVi
KQogCQkJCWZsYWdzICY9IH5FWEVDX09CSkVDVF9BU1lOQzsKIAkJfQogCi0JCWlmIChmbGFncyAm
IEVYRUNfT0JKRUNUX0FTWU5DKQotCQkJY29udGludWU7Ci0KLQkJZXJyID0gaTkxNV9yZXF1ZXN0
X2F3YWl0X29iamVjdAotCQkJKGViLT5yZXF1ZXN0LCBvYmosIGZsYWdzICYgRVhFQ19PQkpFQ1Rf
V1JJVEUpOwotCQlpZiAoZXJyKQotCQkJcmV0dXJuIGVycjsKLQl9CisJCWlmIChlcnIgPT0gMCAm
JiAhKGZsYWdzICYgRVhFQ19PQkpFQ1RfQVNZTkMpKSB7CisJCQllcnIgPSBpOTE1X3JlcXVlc3Rf
YXdhaXRfb2JqZWN0CisJCQkJKGViLT5yZXF1ZXN0LCBvYmosIGZsYWdzICYgRVhFQ19PQkpFQ1Rf
V1JJVEUpOworCQl9CiAKLQlmb3IgKGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewotCQl1bnNpZ25l
ZCBpbnQgZmxhZ3MgPSBlYi0+ZmxhZ3NbaV07Ci0JCXN0cnVjdCBpOTE1X3ZtYSAqdm1hID0gZWIt
PnZtYVtpXTsKKwkJaWYgKGVyciA9PSAwKQorCQkJZXJyID0gaTkxNV92bWFfbW92ZV90b19hY3Rp
dmUodm1hLCBlYi0+cmVxdWVzdCwgZmxhZ3MpOwogCi0JCWVyciA9IGk5MTVfdm1hX21vdmVfdG9f
YWN0aXZlKHZtYSwgZWItPnJlcXVlc3QsIGZsYWdzKTsKLQkJaWYgKHVubGlrZWx5KGVycikpIHsK
LQkJCWk5MTVfcmVxdWVzdF9za2lwKGViLT5yZXF1ZXN0LCBlcnIpOwotCQkJcmV0dXJuIGVycjsK
LQkJfQorCQlpOTE1X3ZtYV91bmxvY2sodm1hKTsKIAogCQlfX2ViX3VucmVzZXJ2ZV92bWEodm1h
LCBmbGFncyk7CiAJCXZtYS0+ZXhlY19mbGFncyA9IE5VTEw7CkBAIC0xODk5LDEyICsxOTM2LDIw
IEBAIHN0YXRpYyBpbnQgZWJfbW92ZV90b19ncHUoc3RydWN0IGk5MTVfZXhlY2J1ZmZlciAqZWIp
CiAJCWlmICh1bmxpa2VseShmbGFncyAmIF9fRVhFQ19PQkpFQ1RfSEFTX1JFRikpCiAJCQlpOTE1
X3ZtYV9wdXQodm1hKTsKIAl9CisJd3dfYWNxdWlyZV9maW5pKCZhY3F1aXJlKTsKKworCWlmICh1
bmxpa2VseShlcnIpKQorCQlnb3RvIGVycl9za2lwOworCiAJZWItPmV4ZWMgPSBOVUxMOwogCiAJ
LyogVW5jb25kaXRpb25hbGx5IGZsdXNoIGFueSBjaGlwc2V0IGNhY2hlcyAoZm9yIHN0cmVhbWlu
ZyB3cml0ZXMpLiAqLwogCWk5MTVfZ2VtX2NoaXBzZXRfZmx1c2goZWItPmk5MTUpOwotCiAJcmV0
dXJuIDA7CisKK2Vycl9za2lwOgorCWk5MTVfcmVxdWVzdF9za2lwKGViLT5yZXF1ZXN0LCBlcnIp
OworCXJldHVybiBlcnI7CiB9CiAKIHN0YXRpYyBib29sIGk5MTVfZ2VtX2NoZWNrX2V4ZWNidWZm
ZXIoc3RydWN0IGRybV9pOTE1X2dlbV9leGVjYnVmZmVyMiAqZXhlYykKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9mZW5jZS5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX2ZlbmNlLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAw
MDAwMDAwMDAwLi41N2RiYzA4NjI3MTMKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fZmVuY2UuYwpAQCAtMCwwICsxLDk2IEBACisvKgorICogU1BE
WC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAorICoKKyAqIENvcHlyaWdodCDCqSAyMDE5IEludGVs
IENvcnBvcmF0aW9uCisgKi8KKworI2luY2x1ZGUgImk5MTVfZHJ2LmgiCisjaW5jbHVkZSAiaTkx
NV9nZW1fb2JqZWN0LmgiCisKK3N0cnVjdCBzdHViX2ZlbmNlIHsKKwlzdHJ1Y3QgZG1hX2ZlbmNl
IGRtYTsKKwlzdHJ1Y3QgaTkxNV9zd19mZW5jZSBjaGFpbjsKK307CisKK3N0YXRpYyBpbnQgX19p
OTE1X3N3X2ZlbmNlX2NhbGwKK3N0dWJfbm90aWZ5KHN0cnVjdCBpOTE1X3N3X2ZlbmNlICpmZW5j
ZSwgZW51bSBpOTE1X3N3X2ZlbmNlX25vdGlmeSBzdGF0ZSkKK3sKKwlzdHJ1Y3Qgc3R1Yl9mZW5j
ZSAqc3R1YiA9IGNvbnRhaW5lcl9vZihmZW5jZSwgdHlwZW9mKCpzdHViKSwgY2hhaW4pOworCisJ
c3dpdGNoIChzdGF0ZSkgeworCWNhc2UgRkVOQ0VfQ09NUExFVEU6CisJCWRtYV9mZW5jZV9zaWdu
YWwoJnN0dWItPmRtYSk7CisJCWJyZWFrOworCisJY2FzZSBGRU5DRV9GUkVFOgorCQlkbWFfZmVu
Y2VfcHV0KCZzdHViLT5kbWEpOworCQlicmVhazsKKwl9CisKKwlyZXR1cm4gTk9USUZZX0RPTkU7
Cit9CisKK3N0YXRpYyBjb25zdCBjaGFyICpzdHViX2RyaXZlcl9uYW1lKHN0cnVjdCBkbWFfZmVu
Y2UgKmZlbmNlKQoreworCXJldHVybiBEUklWRVJfTkFNRTsKK30KKworc3RhdGljIGNvbnN0IGNo
YXIgKnN0dWJfdGltZWxpbmVfbmFtZShzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSkKK3sKKwlyZXR1
cm4gIm9iamVjdCI7Cit9CisKK3N0YXRpYyB2b2lkIHN0dWJfcmVsZWFzZShzdHJ1Y3QgZG1hX2Zl
bmNlICpmZW5jZSkKK3sKKwlzdHJ1Y3Qgc3R1Yl9mZW5jZSAqc3R1YiA9IGNvbnRhaW5lcl9vZihm
ZW5jZSwgdHlwZW9mKCpzdHViKSwgZG1hKTsKKworCWk5MTVfc3dfZmVuY2VfZmluaSgmc3R1Yi0+
Y2hhaW4pOworCisJQlVJTERfQlVHX09OKG9mZnNldG9mKHR5cGVvZigqc3R1YiksIGRtYSkpOwor
CWRtYV9mZW5jZV9mcmVlKCZzdHViLT5kbWEpOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRt
YV9mZW5jZV9vcHMgc3R1Yl9mZW5jZV9vcHMgPSB7CisJLmdldF9kcml2ZXJfbmFtZSA9IHN0dWJf
ZHJpdmVyX25hbWUsCisJLmdldF90aW1lbGluZV9uYW1lID0gc3R1Yl90aW1lbGluZV9uYW1lLAor
CS5yZWxlYXNlID0gc3R1Yl9yZWxlYXNlLAorfTsKKworc3RydWN0IGRtYV9mZW5jZSAqCitpOTE1
X2dlbV9vYmplY3RfbG9ja19mZW5jZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQor
eworCXN0cnVjdCBzdHViX2ZlbmNlICpzdHViOworCisJYXNzZXJ0X29iamVjdF9oZWxkKG9iaik7
CisKKwlzdHViID0ga21hbGxvYyhzaXplb2YoKnN0dWIpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIXN0
dWIpCisJCXJldHVybiBOVUxMOworCisJaTkxNV9zd19mZW5jZV9pbml0KCZzdHViLT5jaGFpbiwg
c3R1Yl9ub3RpZnkpOworCWRtYV9mZW5jZV9pbml0KCZzdHViLT5kbWEsICZzdHViX2ZlbmNlX29w
cywgJnN0dWItPmNoYWluLndhaXQubG9jaywKKwkJICAgICAgIHRvX2k5MTUob2JqLT5iYXNlLmRl
diktPm1tLnVub3JkZXJlZF90aW1lbGluZSwKKwkJICAgICAgIDApOworCisJaWYgKGk5MTVfc3df
ZmVuY2VfYXdhaXRfcmVzZXJ2YXRpb24oJnN0dWItPmNoYWluLAorCQkJCQkgICAgb2JqLT5yZXN2
LCBOVUxMLAorCQkJCQkgICAgdHJ1ZSwgSTkxNV9GRU5DRV9USU1FT1VULAorCQkJCQkgICAgSTkx
NV9GRU5DRV9HRlApIDwgMCkKKwkJZ290byBlcnI7CisKKwlyZXNlcnZhdGlvbl9vYmplY3RfYWRk
X2V4Y2xfZmVuY2Uob2JqLT5yZXN2LCAmc3R1Yi0+ZG1hKTsKKworCXJldHVybiAmc3R1Yi0+ZG1h
OworCitlcnI6CisJc3R1Yl9yZWxlYXNlKCZzdHViLT5kbWEpOworCXJldHVybiBOVUxMOworfQor
Cit2b2lkIGk5MTVfZ2VtX29iamVjdF91bmxvY2tfZmVuY2Uoc3RydWN0IGRybV9pOTE1X2dlbV9v
YmplY3QgKm9iaiwKKwkJCQkgIHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlKQoreworCXN0cnVjdCBz
dHViX2ZlbmNlICpzdHViID0gY29udGFpbmVyX29mKGZlbmNlLCB0eXBlb2YoKnN0dWIpLCBkbWEp
OworCisJaTkxNV9zd19mZW5jZV9jb21taXQoJnN0dWItPmNoYWluKTsKK30KZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYwppbmRleCA0NTdlNjk0YTVjM2YuLmE2YTM0
NTJkMmIzZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29i
amVjdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYwpA
QCAtMzc4LDYgKzM3OCw4IEBAIGk5MTVfZ2VtX29iamVjdF9mbHVzaF93cml0ZV9kb21haW4oc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KG9iai0+YmFzZS5kZXYpOwogCXN0cnVjdCBpOTE1X3ZtYSAqdm1h
OwogCisJYXNzZXJ0X29iamVjdF9oZWxkKG9iaik7CisKIAlpZiAoIShvYmotPndyaXRlX2RvbWFp
biAmIGZsdXNoX2RvbWFpbnMpKQogCQlyZXR1cm47CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9vYmplY3QuaAppbmRleCA4Y2YwODJhYmIwYWIuLmIwNDg4NTE3ZTk0NSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaApAQCAtOTksMTYgKzk5
LDI5IEBAIGk5MTVfZ2VtX29iamVjdF9wdXQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
aikKIAlfX2RybV9nZW1fb2JqZWN0X3B1dCgmb2JqLT5iYXNlKTsKIH0KIAorI2RlZmluZSBhc3Nl
cnRfb2JqZWN0X2hlbGQob2JqKSByZXNlcnZhdGlvbl9vYmplY3RfYXNzZXJ0X2hlbGQoKG9iaikt
PnJlc3YpCisKIHN0YXRpYyBpbmxpbmUgdm9pZCBpOTE1X2dlbV9vYmplY3RfbG9jayhzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogewogCXJlc2VydmF0aW9uX29iamVjdF9sb2NrKG9i
ai0+cmVzdiwgTlVMTCk7CiB9CiAKK3N0YXRpYyBpbmxpbmUgaW50CitpOTE1X2dlbV9vYmplY3Rf
bG9ja19pbnRlcnJ1cHRpYmxlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCit7CisJ
cmV0dXJuIHJlc2VydmF0aW9uX29iamVjdF9sb2NrX2ludGVycnVwdGlibGUob2JqLT5yZXN2LCBO
VUxMKTsKK30KKwogc3RhdGljIGlubGluZSB2b2lkIGk5MTVfZ2VtX29iamVjdF91bmxvY2soc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIHsKIAlyZXNlcnZhdGlvbl9vYmplY3RfdW5s
b2NrKG9iai0+cmVzdik7CiB9CiAKK3N0cnVjdCBkbWFfZmVuY2UgKgoraTkxNV9nZW1fb2JqZWN0
X2xvY2tfZmVuY2Uoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaik7Cit2b2lkIGk5MTVf
Z2VtX29iamVjdF91bmxvY2tfZmVuY2Uoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwK
KwkJCQkgIHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlKTsKKwogc3RhdGljIGlubGluZSB2b2lkCiBp
OTE1X2dlbV9vYmplY3Rfc2V0X3JlYWRvbmx5KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpv
YmopCiB7CkBAIC0zNzIsNiArMzg1LDcgQEAgc3RhdGljIGlubGluZSB2b2lkCiBpOTE1X2dlbV9v
YmplY3RfZmluaXNoX2FjY2VzcyhzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogewog
CWk5MTVfZ2VtX29iamVjdF91bnBpbl9wYWdlcyhvYmopOworCWk5MTVfZ2VtX29iamVjdF91bmxv
Y2sob2JqKTsKIH0KIAogc3RhdGljIGlubGluZSBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICoKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKaW5kZXggYmU3NWE1MmE3YWIwLi4xMTFi
Njg3ZjE0YjUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9w
bS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5jCkBAIC0xODYs
MTIgKzE4NiwxMyBAQCB2b2lkIGk5MTVfZ2VtX3N1c3BlbmRfbGF0ZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKIAkgKiBtYWNoaW5lIGluIGFuIHVudXNhYmxlIGNvbmRpdGlvbi4KIAkg
Ki8KIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWZvciAocGhhc2Ug
PSBwaGFzZXM7ICpwaGFzZTsgcGhhc2UrKykgewotCQlsaXN0X2Zvcl9lYWNoX2VudHJ5KG9iaiwg
KnBoYXNlLCBtbS5saW5rKQorCQlsaXN0X2Zvcl9lYWNoX2VudHJ5KG9iaiwgKnBoYXNlLCBtbS5s
aW5rKSB7CisJCQlpOTE1X2dlbV9vYmplY3RfbG9jayhvYmopOwogCQkJV0FSTl9PTihpOTE1X2dl
bV9vYmplY3Rfc2V0X3RvX2d0dF9kb21haW4ob2JqLCBmYWxzZSkpOworCQkJaTkxNV9nZW1fb2Jq
ZWN0X3VubG9jayhvYmopOworCQl9CiAJfQotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVj
dF9tdXRleCk7CiAKIAlpbnRlbF91Y19zYW5pdGl6ZShpOTE1KTsKIAlpOTE1X2dlbV9zYW5pdGl6
ZShpOTE1KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMv
aHVnZV9wYWdlcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3Bh
Z2VzLmMKaW5kZXggN2I0MzdmMDZhOWJlLi40NjVlMGUxZDRhYTMgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaHVnZV9wYWdlcy5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaHVnZV9wYWdlcy5jCkBAIC05NjAsMTAgKzk2MCw2
IEBAIHN0YXRpYyBpbnQgZ3B1X3dyaXRlKHN0cnVjdCBpOTE1X3ZtYSAqdm1hLAogCiAJR0VNX0JV
R19PTighaW50ZWxfZW5naW5lX2Nhbl9zdG9yZV9kd29yZChlbmdpbmUpKTsKIAotCWVyciA9IGk5
MTVfZ2VtX29iamVjdF9zZXRfdG9fZ3R0X2RvbWFpbih2bWEtPm9iaiwgdHJ1ZSk7Ci0JaWYgKGVy
cikKLQkJcmV0dXJuIGVycjsKLQogCWJhdGNoID0gZ3B1X3dyaXRlX2R3KHZtYSwgZHdvcmQgKiBz
aXplb2YodTMyKSwgdmFsdWUpOwogCWlmIChJU19FUlIoYmF0Y2gpKQogCQlyZXR1cm4gUFRSX0VS
UihiYXRjaCk7CkBAIC05NzQsMTMgKzk3MCwxOSBAQCBzdGF0aWMgaW50IGdwdV93cml0ZShzdHJ1
Y3QgaTkxNV92bWEgKnZtYSwKIAkJZ290byBlcnJfYmF0Y2g7CiAJfQogCisJaTkxNV92bWFfbG9j
ayhiYXRjaCk7CiAJZXJyID0gaTkxNV92bWFfbW92ZV90b19hY3RpdmUoYmF0Y2gsIHJxLCAwKTsK
KwlpOTE1X3ZtYV91bmxvY2soYmF0Y2gpOwogCWlmIChlcnIpCiAJCWdvdG8gZXJyX3JlcXVlc3Q7
CiAKIAlpOTE1X2dlbV9vYmplY3Rfc2V0X2FjdGl2ZV9yZWZlcmVuY2UoYmF0Y2gtPm9iaik7CiAK
LQllcnIgPSBpOTE1X3ZtYV9tb3ZlX3RvX2FjdGl2ZSh2bWEsIHJxLCBFWEVDX09CSkVDVF9XUklU
RSk7CisJaTkxNV92bWFfbG9jayh2bWEpOworCWVyciA9IGk5MTVfZ2VtX29iamVjdF9zZXRfdG9f
Z3R0X2RvbWFpbih2bWEtPm9iaiwgZmFsc2UpOworCWlmIChlcnIgPT0gMCkKKwkJZXJyID0gaTkx
NV92bWFfbW92ZV90b19hY3RpdmUodm1hLCBycSwgRVhFQ19PQkpFQ1RfV1JJVEUpOworCWk5MTVf
dm1hX3VubG9jayh2bWEpOwogCWlmIChlcnIpCiAJCWdvdG8gZXJyX3JlcXVlc3Q7CiAKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fY29oZXJl
bmN5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvaGVy
ZW5jeS5jCmluZGV4IDU0OTU4NzViNDhiMy4uYjVjNWRkMDM0ZDVjIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvaGVyZW5jeS5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fY29oZXJlbmN5LmMK
QEAgLTc4LDcgKzc4LDkgQEAgc3RhdGljIGludCBndHRfc2V0KHN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0ICpvYmosCiAJdTMyIF9faW9tZW0gKm1hcDsKIAlpbnQgZXJyOwogCisJaTkxNV9nZW1f
b2JqZWN0X2xvY2sob2JqKTsKIAllcnIgPSBpOTE1X2dlbV9vYmplY3Rfc2V0X3RvX2d0dF9kb21h
aW4ob2JqLCB0cnVlKTsKKwlpOTE1X2dlbV9vYmplY3RfdW5sb2NrKG9iaik7CiAJaWYgKGVycikK
IAkJcmV0dXJuIGVycjsKIApAQCAtMTA1LDcgKzEwNyw5IEBAIHN0YXRpYyBpbnQgZ3R0X2dldChz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCXUzMiBfX2lvbWVtICptYXA7CiAJaW50
IGVycjsKIAorCWk5MTVfZ2VtX29iamVjdF9sb2NrKG9iaik7CiAJZXJyID0gaTkxNV9nZW1fb2Jq
ZWN0X3NldF90b19ndHRfZG9tYWluKG9iaiwgZmFsc2UpOworCWk5MTVfZ2VtX29iamVjdF91bmxv
Y2sob2JqKTsKIAlpZiAoZXJyKQogCQlyZXR1cm4gZXJyOwogCkBAIC0xMzEsNyArMTM1LDkgQEAg
c3RhdGljIGludCB3Y19zZXQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAl1MzIg
Km1hcDsKIAlpbnQgZXJyOwogCisJaTkxNV9nZW1fb2JqZWN0X2xvY2sob2JqKTsKIAllcnIgPSBp
OTE1X2dlbV9vYmplY3Rfc2V0X3RvX3djX2RvbWFpbihvYmosIHRydWUpOworCWk5MTVfZ2VtX29i
amVjdF91bmxvY2sob2JqKTsKIAlpZiAoZXJyKQogCQlyZXR1cm4gZXJyOwogCkBAIC0xNTIsNyAr
MTU4LDkgQEAgc3RhdGljIGludCB3Y19nZXQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
aiwKIAl1MzIgKm1hcDsKIAlpbnQgZXJyOwogCisJaTkxNV9nZW1fb2JqZWN0X2xvY2sob2JqKTsK
IAllcnIgPSBpOTE1X2dlbV9vYmplY3Rfc2V0X3RvX3djX2RvbWFpbihvYmosIGZhbHNlKTsKKwlp
OTE1X2dlbV9vYmplY3RfdW5sb2NrKG9iaik7CiAJaWYgKGVycikKIAkJcmV0dXJuIGVycjsKIApA
QCAtMTc2LDcgKzE4NCw5IEBAIHN0YXRpYyBpbnQgZ3B1X3NldChzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdCAqb2JqLAogCXUzMiAqY3M7CiAJaW50IGVycjsKIAorCWk5MTVfZ2VtX29iamVjdF9s
b2NrKG9iaik7CiAJZXJyID0gaTkxNV9nZW1fb2JqZWN0X3NldF90b19ndHRfZG9tYWluKG9iaiwg
dHJ1ZSk7CisJaTkxNV9nZW1fb2JqZWN0X3VubG9jayhvYmopOwogCWlmIChlcnIpCiAJCXJldHVy
biBlcnI7CiAKQEAgLTIxNSw3ICsyMjUsOSBAQCBzdGF0aWMgaW50IGdwdV9zZXQoc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAl9CiAJaW50ZWxfcmluZ19hZHZhbmNlKHJxLCBjcyk7
CiAKKwlpOTE1X3ZtYV9sb2NrKHZtYSk7CiAJZXJyID0gaTkxNV92bWFfbW92ZV90b19hY3RpdmUo
dm1hLCBycSwgRVhFQ19PQkpFQ1RfV1JJVEUpOworCWk5MTVfdm1hX3VubG9jayh2bWEpOwogCWk5
MTVfdm1hX3VucGluKHZtYSk7CiAKIAlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fY29udGV4dC5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMKaW5k
ZXggNjUzYWUwOGEyNzdmLi43MmVlZGQ2YzJhMGEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fY29udGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fY29udGV4dC5jCkBAIC0yMDksNyArMjA5
LDkgQEAgZ3B1X2ZpbGxfZHcoc3RydWN0IGk5MTVfdm1hICp2bWEsIHU2NCBvZmZzZXQsIHVuc2ln
bmVkIGxvbmcgY291bnQsIHUzMiB2YWx1ZSkKIAlpOTE1X2dlbV9vYmplY3RfZmx1c2hfbWFwKG9i
aik7CiAJaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChvYmopOwogCisJaTkxNV9nZW1fb2JqZWN0
X2xvY2sob2JqKTsKIAllcnIgPSBpOTE1X2dlbV9vYmplY3Rfc2V0X3RvX2d0dF9kb21haW4ob2Jq
LCBmYWxzZSk7CisJaTkxNV9nZW1fb2JqZWN0X3VubG9jayhvYmopOwogCWlmIChlcnIpCiAJCWdv
dG8gZXJyOwogCkBAIC0yNjEsNyArMjYzLDkgQEAgc3RhdGljIGludCBncHVfZmlsbChzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCWlmIChJU19FUlIodm1hKSkKIAkJcmV0dXJuIFBU
Ul9FUlIodm1hKTsKIAorCWk5MTVfZ2VtX29iamVjdF9sb2NrKG9iaik7CiAJZXJyID0gaTkxNV9n
ZW1fb2JqZWN0X3NldF90b19ndHRfZG9tYWluKG9iaiwgZmFsc2UpOworCWk5MTVfZ2VtX29iamVj
dF91bmxvY2sob2JqKTsKIAlpZiAoZXJyKQogCQlyZXR1cm4gZXJyOwogCkBAIC0zMDIsMTEgKzMw
NiwxNSBAQCBzdGF0aWMgaW50IGdwdV9maWxsKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpv
YmosCiAJaWYgKGVycikKIAkJZ290byBlcnJfcmVxdWVzdDsKIAorCWk5MTVfdm1hX2xvY2soYmF0
Y2gpOwogCWVyciA9IGk5MTVfdm1hX21vdmVfdG9fYWN0aXZlKGJhdGNoLCBycSwgMCk7CisJaTkx
NV92bWFfdW5sb2NrKGJhdGNoKTsKIAlpZiAoZXJyKQogCQlnb3RvIHNraXBfcmVxdWVzdDsKIAor
CWk5MTVfdm1hX2xvY2sodm1hKTsKIAllcnIgPSBpOTE1X3ZtYV9tb3ZlX3RvX2FjdGl2ZSh2bWEs
IHJxLCBFWEVDX09CSkVDVF9XUklURSk7CisJaTkxNV92bWFfdW5sb2NrKHZtYSk7CiAJaWYgKGVy
cikKIAkJZ290byBza2lwX3JlcXVlc3Q7CiAKQEAgLTc1NCw3ICs3NjIsOSBAQCBlbWl0X3JwY3Nf
cXVlcnkoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAlpZiAoSVNfRVJSKHZtYSkp
CiAJCXJldHVybiBQVFJfRVJSKHZtYSk7CiAKKwlpOTE1X2dlbV9vYmplY3RfbG9jayhvYmopOwog
CWVyciA9IGk5MTVfZ2VtX29iamVjdF9zZXRfdG9fZ3R0X2RvbWFpbihvYmosIGZhbHNlKTsKKwlp
OTE1X2dlbV9vYmplY3RfdW5sb2NrKG9iaik7CiAJaWYgKGVycikKIAkJcmV0dXJuIGVycjsKIApA
QCAtNzgwLDExICs3OTAsMTUgQEAgZW1pdF9ycGNzX3F1ZXJ5KHN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0ICpvYmosCiAJaWYgKGVycikKIAkJZ290byBlcnJfcmVxdWVzdDsKIAorCWk5MTVfdm1h
X2xvY2soYmF0Y2gpOwogCWVyciA9IGk5MTVfdm1hX21vdmVfdG9fYWN0aXZlKGJhdGNoLCBycSwg
MCk7CisJaTkxNV92bWFfdW5sb2NrKGJhdGNoKTsKIAlpZiAoZXJyKQogCQlnb3RvIHNraXBfcmVx
dWVzdDsKIAorCWk5MTVfdm1hX2xvY2sodm1hKTsKIAllcnIgPSBpOTE1X3ZtYV9tb3ZlX3RvX2Fj
dGl2ZSh2bWEsIHJxLCBFWEVDX09CSkVDVF9XUklURSk7CisJaTkxNV92bWFfdW5sb2NrKHZtYSk7
CiAJaWYgKGVycikKIAkJZ290byBza2lwX3JlcXVlc3Q7CiAKQEAgLTEzNDUsNyArMTM1OSw5IEBA
IHN0YXRpYyBpbnQgd3JpdGVfdG9fc2NyYXRjaChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4
LAogCWlmIChlcnIpCiAJCWdvdG8gZXJyX3JlcXVlc3Q7CiAKKwlpOTE1X3ZtYV9sb2NrKHZtYSk7
CiAJZXJyID0gaTkxNV92bWFfbW92ZV90b19hY3RpdmUodm1hLCBycSwgMCk7CisJaTkxNV92bWFf
dW5sb2NrKHZtYSk7CiAJaWYgKGVycikKIAkJZ290byBza2lwX3JlcXVlc3Q7CiAKQEAgLTE0NDAs
NyArMTQ1Niw5IEBAIHN0YXRpYyBpbnQgcmVhZF9mcm9tX3NjcmF0Y2goc3RydWN0IGk5MTVfZ2Vt
X2NvbnRleHQgKmN0eCwKIAlpZiAoZXJyKQogCQlnb3RvIGVycl9yZXF1ZXN0OwogCisJaTkxNV92
bWFfbG9jayh2bWEpOwogCWVyciA9IGk5MTVfdm1hX21vdmVfdG9fYWN0aXZlKHZtYSwgcnEsIEVY
RUNfT0JKRUNUX1dSSVRFKTsKKwlpOTE1X3ZtYV91bmxvY2sodm1hKTsKIAlpZiAoZXJyKQogCQln
b3RvIHNraXBfcmVxdWVzdDsKIApAQCAtMTQ0OSw3ICsxNDY3LDkgQEAgc3RhdGljIGludCByZWFk
X2Zyb21fc2NyYXRjaChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAogCiAJaTkxNV9yZXF1
ZXN0X2FkZChycSk7CiAKKwlpOTE1X2dlbV9vYmplY3RfbG9jayhvYmopOwogCWVyciA9IGk5MTVf
Z2VtX29iamVjdF9zZXRfdG9fY3B1X2RvbWFpbihvYmosIGZhbHNlKTsKKwlpOTE1X2dlbV9vYmpl
Y3RfdW5sb2NrKG9iaik7CiAJaWYgKGVycikKIAkJZ290byBlcnI7CiAKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fbW1hbi5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9tbWFuLmMKaW5kZXggMTJjOTBk
OGZlMGZiLi4yOTdmODg2NGQzOTIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9zZWxmdGVzdHMvaTkxNV9nZW1fbW1hbi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9zZWxmdGVzdHMvaTkxNV9nZW1fbW1hbi5jCkBAIC0xMTAsNyArMTEwLDkgQEAgc3RhdGljIGlu
dCBjaGVja19wYXJ0aWFsX21hcHBpbmcoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwK
IAkJR0VNX0JVR19PTih2aWV3LnBhcnRpYWwuc2l6ZSA+IG5yZWFsKTsKIAkJY29uZF9yZXNjaGVk
KCk7CiAKKwkJaTkxNV9nZW1fb2JqZWN0X2xvY2sob2JqKTsKIAkJZXJyID0gaTkxNV9nZW1fb2Jq
ZWN0X3NldF90b19ndHRfZG9tYWluKG9iaiwgdHJ1ZSk7CisJCWk5MTVfZ2VtX29iamVjdF91bmxv
Y2sob2JqKTsKIAkJaWYgKGVycikgewogCQkJcHJfZXJyKCJGYWlsZWQgdG8gZmx1c2ggdG8gR1RU
IHdyaXRlIGRvbWFpbjsgZXJyPSVkXG4iLAogCQkJICAgICAgIGVycik7CkBAIC0xNDIsNyArMTQ0
LDkgQEAgc3RhdGljIGludCBjaGVja19wYXJ0aWFsX21hcHBpbmcoc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKm9iaiwKIAkJaWYgKG9mZnNldCA+PSBvYmotPmJhc2Uuc2l6ZSkKIAkJCWNvbnRp
bnVlOwogCisJCWk5MTVfZ2VtX29iamVjdF9sb2NrKG9iaik7CiAJCWk5MTVfZ2VtX29iamVjdF9m
bHVzaF93cml0ZV9kb21haW4ob2JqLCB+STkxNV9HRU1fRE9NQUlOX0NQVSk7CisJCWk5MTVfZ2Vt
X29iamVjdF91bmxvY2sob2JqKTsKIAogCQlwID0gaTkxNV9nZW1fb2JqZWN0X2dldF9wYWdlKG9i
aiwgb2Zmc2V0ID4+IFBBR0VfU0hJRlQpOwogCQljcHUgPSBrbWFwKHApICsgb2Zmc2V0X2luX3Bh
Z2Uob2Zmc2V0KTsKQEAgLTM0NCw3ICszNDgsOSBAQCBzdGF0aWMgaW50IG1ha2Vfb2JqX2J1c3ko
c3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIAkJcmV0dXJuIFBUUl9FUlIocnEpOwog
CX0KIAorCWk5MTVfdm1hX2xvY2sodm1hKTsKIAllcnIgPSBpOTE1X3ZtYV9tb3ZlX3RvX2FjdGl2
ZSh2bWEsIHJxLCBFWEVDX09CSkVDVF9XUklURSk7CisJaTkxNV92bWFfdW5sb2NrKHZtYSk7CiAK
IAlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9waHlzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX3BoeXMuYwppbmRleCBlZDY0MDEyZTVkMjQuLjk0YTE1ZTNm
NmRiOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1
X2dlbV9waHlzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1
X2dlbV9waHlzLmMKQEAgLTQ2LDkgKzQ2LDkgQEAgc3RhdGljIGludCBtb2NrX3BoeXNfb2JqZWN0
KHZvaWQgKmFyZykKIAl9CiAKIAkvKiBNYWtlIHRoZSBvYmplY3QgZGlydHkgc28gdGhhdCBwdXRf
cGFnZXMgbXVzdCBkbyBjb3B5IGJhY2sgdGhlIGRhdGEgKi8KLQltdXRleF9sb2NrKCZpOTE1LT5k
cm0uc3RydWN0X211dGV4KTsKKwlpOTE1X2dlbV9vYmplY3RfbG9jayhvYmopOwogCWVyciA9IGk5
MTVfZ2VtX29iamVjdF9zZXRfdG9fZ3R0X2RvbWFpbihvYmosIHRydWUpOwotCW11dGV4X3VubG9j
aygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CisJaTkxNV9nZW1fb2JqZWN0X3VubG9jayhvYmop
OwogCWlmIChlcnIpIHsKIAkJcHJfZXJyKCJpOTE1X2dlbV9vYmplY3Rfc2V0X3RvX2d0dF9kb21h
aW4gZmFpbGVkIHdpdGggZXJyPSVkXG4iLAogCQkgICAgICAgZXJyKTsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfaGFuZ2NoZWNrLmMKaW5kZXggNGI0NTg5YjkyNTIxLi40NTc0
NWUzNmI1ZjQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hh
bmdjaGVjay5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVj
ay5jCkBAIC0xMTUsNyArMTE1LDkgQEAgc3RhdGljIGludCBtb3ZlX3RvX2FjdGl2ZShzdHJ1Y3Qg
aTkxNV92bWEgKnZtYSwKIHsKIAlpbnQgZXJyOwogCisJaTkxNV92bWFfbG9jayh2bWEpOwogCWVy
ciA9IGk5MTVfdm1hX21vdmVfdG9fYWN0aXZlKHZtYSwgcnEsIGZsYWdzKTsKKwlpOTE1X3ZtYV91
bmxvY2sodm1hKTsKIAlpZiAoZXJyKQogCQlyZXR1cm4gZXJyOwogCkBAIC0xMjk4LDcgKzEzMDAs
OSBAQCBzdGF0aWMgaW50IF9faWd0X3Jlc2V0X2V2aWN0X3ZtYShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKIAkJfQogCX0KIAorCWk5MTVfdm1hX2xvY2soYXJnLnZtYSk7CiAJZXJyID0g
aTkxNV92bWFfbW92ZV90b19hY3RpdmUoYXJnLnZtYSwgcnEsIGZsYWdzKTsKKwlpOTE1X3ZtYV91
bmxvY2soYXJnLnZtYSk7CiAKIAlpZiAoZmxhZ3MgJiBFWEVDX09CSkVDVF9ORUVEU19GRU5DRSkK
IAkJaTkxNV92bWFfdW5waW5fZmVuY2UoYXJnLnZtYSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3Nl
bGZ0ZXN0X2xyYy5jCmluZGV4IGRmYWNjNDZhZTdkMy4uZDE2MmIwZDNlYzhlIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwpAQCAtMTEwOCwxMSArMTEwOCwxMyBAQCBzdGF0
aWMgaW50IHNtb2tlX3N1Ym1pdChzdHJ1Y3QgcHJlZW1wdF9zbW9rZSAqc21va2UsCiAJfQogCiAJ
aWYgKHZtYSkgeworCQlpOTE1X3ZtYV9sb2NrKHZtYSk7CiAJCWVyciA9IHJxLT5lbmdpbmUtPmVt
aXRfYmJfc3RhcnQocnEsCiAJCQkJCQl2bWEtPm5vZGUuc3RhcnQsCiAJCQkJCQlQQUdFX1NJWkUs
IDApOwogCQlpZiAoIWVycikKIAkJCWVyciA9IGk5MTVfdm1hX21vdmVfdG9fYWN0aXZlKHZtYSwg
cnEsIDApOworCQlpOTE1X3ZtYV91bmxvY2sodm1hKTsKIAl9CiAKIAlpOTE1X3JlcXVlc3RfYWRk
KHJxKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmth
cm91bmRzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF93b3JrYXJvdW5kcy5j
CmluZGV4IDQwYjZkZjkxMWQ4ZC4uZDRiYTUyOTZiMmM4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9zZWxmdGVzdF93b3JrYXJvdW5kcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMKQEAgLTExMSw3ICsxMTEsOSBAQCByZWFk
X25vbnByaXZzKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsIHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSkKIAkJZ290byBlcnJfcGluOwogCX0KIAorCWk5MTVfdm1hX2xvY2sodm1h
KTsKIAllcnIgPSBpOTE1X3ZtYV9tb3ZlX3RvX2FjdGl2ZSh2bWEsIHJxLCBFWEVDX09CSkVDVF9X
UklURSk7CisJaTkxNV92bWFfdW5sb2NrKHZtYSk7CiAJaWYgKGVycikKIAkJZ290byBlcnJfcmVx
OwogCkBAIC0xODgsOCArMTkwLDEwIEBAIHN0YXRpYyBpbnQgY2hlY2tfd2hpdGVsaXN0KHN0cnVj
dCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsCiAJCXJldHVybiBQVFJfRVJSKHJlc3VsdHMpOwogCiAJ
ZXJyID0gMDsKKwlpOTE1X2dlbV9vYmplY3RfbG9jayhyZXN1bHRzKTsKIAlpZ3Rfd2VkZ2Vfb25f
dGltZW91dCgmd2VkZ2UsIGN0eC0+aTkxNSwgSFogLyA1KSAvKiBhIHNhZmV0eSBuZXQhICovCiAJ
CWVyciA9IGk5MTVfZ2VtX29iamVjdF9zZXRfdG9fY3B1X2RvbWFpbihyZXN1bHRzLCBmYWxzZSk7
CisJaTkxNV9nZW1fb2JqZWN0X3VubG9jayhyZXN1bHRzKTsKIAlpZiAoaTkxNV90ZXJtaW5hbGx5
X3dlZGdlZChjdHgtPmk5MTUpKQogCQllcnIgPSAtRUlPOwogCWlmIChlcnIpCkBAIC0zNjAsNyAr
MzY0LDkgQEAgc3RhdGljIHN0cnVjdCBpOTE1X3ZtYSAqY3JlYXRlX2JhdGNoKHN0cnVjdCBpOTE1
X2dlbV9jb250ZXh0ICpjdHgpCiAJaWYgKGVycikKIAkJZ290byBlcnJfb2JqOwogCisJaTkxNV9n
ZW1fb2JqZWN0X2xvY2sob2JqKTsKIAllcnIgPSBpOTE1X2dlbV9vYmplY3Rfc2V0X3RvX3djX2Rv
bWFpbihvYmosIHRydWUpOworCWk5MTVfZ2VtX29iamVjdF91bmxvY2sob2JqKTsKIAlpZiAoZXJy
KQogCQlnb3RvIGVycl9vYmo7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2
dC9jbWRfcGFyc2VyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvY21kX3BhcnNlci5jCmlu
ZGV4IGUzNjA4YjE3MDEwNS4uNzVjYjk4ZGE2Y2M4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndnQvY21kX3BhcnNlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9j
bWRfcGFyc2VyLmMKQEAgLTI4NDQsNyArMjg0NCw5IEBAIHN0YXRpYyBpbnQgc2hhZG93X2luZGly
ZWN0X2N0eChzdHJ1Y3QgaW50ZWxfc2hhZG93X3dhX2N0eCAqd2FfY3R4KQogCQlnb3RvIHB1dF9v
Ymo7CiAJfQogCisJaTkxNV9nZW1fb2JqZWN0X2xvY2sob2JqKTsKIAlyZXQgPSBpOTE1X2dlbV9v
YmplY3Rfc2V0X3RvX2NwdV9kb21haW4ob2JqLCBmYWxzZSk7CisJaTkxNV9nZW1fb2JqZWN0X3Vu
bG9jayhvYmopOwogCWlmIChyZXQpIHsKIAkJZ3Z0X3ZncHVfZXJyKCJmYWlsZWQgdG8gc2V0IHNo
YWRvdyBpbmRpcmVjdCBjdHggdG8gQ1BVXG4iKTsKIAkJZ290byB1bm1hcF9zcmM7CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMKaW5kZXggZDY2YmY3N2Y1NWZkLi44YTAwZTJkMGM4MWMg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMKQEAgLTUwOSwxOCArNTA5LDE4IEBA
IHN0YXRpYyBpbnQgcHJlcGFyZV9zaGFkb3dfYmF0Y2hfYnVmZmVyKHN0cnVjdCBpbnRlbF92Z3B1
X3dvcmtsb2FkICp3b3JrbG9hZCkKIAkJCX0KIAogCQkJcmV0ID0gaTkxNV9nZW1fb2JqZWN0X3Nl
dF90b19ndHRfZG9tYWluKGJiLT5vYmosCi0JCQkJCWZhbHNlKTsKKwkJCQkJCQkJZmFsc2UpOwog
CQkJaWYgKHJldCkKIAkJCQlnb3RvIGVycjsKIAotCQkJaTkxNV9nZW1fb2JqZWN0X2ZpbmlzaF9h
Y2Nlc3MoYmItPm9iaik7Ci0JCQliYi0+YWNjZXNzaW5nID0gZmFsc2U7Ci0KIAkJCXJldCA9IGk5
MTVfdm1hX21vdmVfdG9fYWN0aXZlKGJiLT52bWEsCiAJCQkJCQkgICAgICB3b3JrbG9hZC0+cmVx
LAogCQkJCQkJICAgICAgMCk7CiAJCQlpZiAocmV0KQogCQkJCWdvdG8gZXJyOworCisJCQlpOTE1
X2dlbV9vYmplY3RfZmluaXNoX2FjY2VzcyhiYi0+b2JqKTsKKwkJCWJiLT5hY2Nlc3NpbmcgPSBm
YWxzZTsKIAkJfQogCX0KIAlyZXR1cm4gMDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfY21kX3BhcnNlci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9jbWRfcGFy
c2VyLmMKaW5kZXggYzg5M2JkNGViMmM4Li5hMjhiY2QyZDdjMDkgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfY21kX3BhcnNlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfY21kX3BhcnNlci5jCkBAIC0xMDU4LDE5ICsxMDU4LDIwIEBAIHN0YXRpYyB1MzIg
KmNvcHlfYmF0Y2goc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKmRzdF9vYmosCiAJdm9pZCAq
ZHN0LCAqc3JjOwogCWludCByZXQ7CiAKLQlyZXQgPSBpOTE1X2dlbV9vYmplY3RfcHJlcGFyZV9y
ZWFkKHNyY19vYmosICZzcmNfbmVlZHNfY2xmbHVzaCk7CisJcmV0ID0gaTkxNV9nZW1fb2JqZWN0
X3ByZXBhcmVfd3JpdGUoZHN0X29iaiwgJmRzdF9uZWVkc19jbGZsdXNoKTsKIAlpZiAocmV0KQog
CQlyZXR1cm4gRVJSX1BUUihyZXQpOwogCi0JcmV0ID0gaTkxNV9nZW1fb2JqZWN0X3ByZXBhcmVf
d3JpdGUoZHN0X29iaiwgJmRzdF9uZWVkc19jbGZsdXNoKTsKLQlpZiAocmV0KSB7Ci0JCWRzdCA9
IEVSUl9QVFIocmV0KTsKLQkJZ290byB1bnBpbl9zcmM7Ci0JfQotCiAJZHN0ID0gaTkxNV9nZW1f
b2JqZWN0X3Bpbl9tYXAoZHN0X29iaiwgSTkxNV9NQVBfRk9SQ0VfV0IpOworCWk5MTVfZ2VtX29i
amVjdF9maW5pc2hfYWNjZXNzKGRzdF9vYmopOwogCWlmIChJU19FUlIoZHN0KSkKLQkJZ290byB1
bnBpbl9kc3Q7CisJCXJldHVybiBkc3Q7CisKKwlyZXQgPSBpOTE1X2dlbV9vYmplY3RfcHJlcGFy
ZV9yZWFkKHNyY19vYmosICZzcmNfbmVlZHNfY2xmbHVzaCk7CisJaWYgKHJldCkgeworCQlpOTE1
X2dlbV9vYmplY3RfdW5waW5fbWFwKGRzdF9vYmopOworCQlyZXR1cm4gRVJSX1BUUihyZXQpOwor
CX0KIAogCXNyYyA9IEVSUl9QVFIoLUVOT0RFVik7CiAJaWYgKHNyY19uZWVkc19jbGZsdXNoICYm
CkBAIC0xMTE2LDEzICsxMTE3LDExIEBAIHN0YXRpYyB1MzIgKmNvcHlfYmF0Y2goc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3QgKmRzdF9vYmosCiAJCX0KIAl9CiAKKwlpOTE1X2dlbV9vYmplY3Rf
ZmluaXNoX2FjY2VzcyhzcmNfb2JqKTsKKwogCS8qIGRzdF9vYmogaXMgcmV0dXJuZWQgd2l0aCB2
bWFwIHBpbm5lZCAqLwogCSpuZWVkc19jbGZsdXNoX2FmdGVyID0gZHN0X25lZWRzX2NsZmx1c2gg
JiBDTEZMVVNIX0FGVEVSOwogCi11bnBpbl9kc3Q6Ci0JaTkxNV9nZW1fb2JqZWN0X2ZpbmlzaF9h
Y2Nlc3MoZHN0X29iaik7Ci11bnBpbl9zcmM6Ci0JaTkxNV9nZW1fb2JqZWN0X2ZpbmlzaF9hY2Nl
c3Moc3JjX29iaik7CiAJcmV0dXJuIGRzdDsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKaW5k
ZXggOTFkZjkzNTQyYTY4Li5kMGJjZmVmNTYwOGMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZ2VtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwpA
QCAtMTA0LDE5ICsxMDQsMTAgQEAgaW50IGk5MTVfZ2VtX29iamVjdF91bmJpbmQoc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIHsKIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKIAlMSVNU
X0hFQUQoc3RpbGxfaW5fbGlzdCk7Ci0JaW50IHJldDsKKwlpbnQgcmV0ID0gMDsKIAogCWxvY2tk
ZXBfYXNzZXJ0X2hlbGQoJm9iai0+YmFzZS5kZXYtPnN0cnVjdF9tdXRleCk7CiAKLQkvKiBDbG9z
ZWQgdm1hIGFyZSByZW1vdmVkIGZyb20gdGhlIG9iai0+dm1hX2xpc3QgLSBidXQgdGhleSBtYXkK
LQkgKiBzdGlsbCBoYXZlIGFuIGFjdGl2ZSBiaW5kaW5nIG9uIHRoZSBvYmplY3QuIFRvIHJlbW92
ZSB0aG9zZSB3ZQotCSAqIG11c3Qgd2FpdCBmb3IgYWxsIHJlbmRlcmluZyB0byBjb21wbGV0ZSB0
byB0aGUgb2JqZWN0IChhcyB1bmJpbmRpbmcKLQkgKiBtdXN0IGFueXdheSksIGFuZCByZXRpcmUg
dGhlIHJlcXVlc3RzLgotCSAqLwotCXJldCA9IGk5MTVfZ2VtX29iamVjdF9zZXRfdG9fY3B1X2Rv
bWFpbihvYmosIGZhbHNlKTsKLQlpZiAocmV0KQotCQlyZXR1cm4gcmV0OwotCiAJc3Bpbl9sb2Nr
KCZvYmotPnZtYS5sb2NrKTsKIAl3aGlsZSAoIXJldCAmJiAodm1hID0gbGlzdF9maXJzdF9lbnRy
eV9vcl9udWxsKCZvYmotPnZtYS5saXN0LAogCQkJCQkJICAgICAgIHN0cnVjdCBpOTE1X3ZtYSwK
QEAgLTEzOSwyOSArMTMwLDE3IEBAIGk5MTVfZ2VtX29iamVjdF93YWl0X2ZlbmNlKHN0cnVjdCBk
bWFfZmVuY2UgKmZlbmNlLAogCQkJICAgdW5zaWduZWQgaW50IGZsYWdzLAogCQkJICAgbG9uZyB0
aW1lb3V0KQogewotCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOwotCiAJQlVJTERfQlVHX09OKEk5
MTVfV0FJVF9JTlRFUlJVUFRJQkxFICE9IDB4MSk7CiAKIAlpZiAodGVzdF9iaXQoRE1BX0ZFTkNF
X0ZMQUdfU0lHTkFMRURfQklULCAmZmVuY2UtPmZsYWdzKSkKIAkJcmV0dXJuIHRpbWVvdXQ7CiAK
LQlpZiAoIWRtYV9mZW5jZV9pc19pOTE1KGZlbmNlKSkKLQkJcmV0dXJuIGRtYV9mZW5jZV93YWl0
X3RpbWVvdXQoZmVuY2UsCi0JCQkJCSAgICAgIGZsYWdzICYgSTkxNV9XQUlUX0lOVEVSUlVQVElC
TEUsCi0JCQkJCSAgICAgIHRpbWVvdXQpOworCWlmIChkbWFfZmVuY2VfaXNfaTkxNShmZW5jZSkp
CisJCXJldHVybiBpOTE1X3JlcXVlc3Rfd2FpdCh0b19yZXF1ZXN0KGZlbmNlKSwgZmxhZ3MsIHRp
bWVvdXQpOwogCi0JcnEgPSB0b19yZXF1ZXN0KGZlbmNlKTsKLQlpZiAoaTkxNV9yZXF1ZXN0X2Nv
bXBsZXRlZChycSkpCi0JCWdvdG8gb3V0OwotCi0JdGltZW91dCA9IGk5MTVfcmVxdWVzdF93YWl0
KHJxLCBmbGFncywgdGltZW91dCk7Ci0KLW91dDoKLQlpZiAoZmxhZ3MgJiBJOTE1X1dBSVRfTE9D
S0VEICYmIGk5MTVfcmVxdWVzdF9jb21wbGV0ZWQocnEpKQotCQlpOTE1X3JlcXVlc3RfcmV0aXJl
X3VwdG8ocnEpOwotCi0JcmV0dXJuIHRpbWVvdXQ7CisJcmV0dXJuIGRtYV9mZW5jZV93YWl0X3Rp
bWVvdXQoZmVuY2UsCisJCQkJICAgICAgZmxhZ3MgJiBJOTE1X1dBSVRfSU5URVJSVVBUSUJMRSwK
KwkJCQkgICAgICB0aW1lb3V0KTsKIH0KIAogc3RhdGljIGxvbmcKQEAgLTQ4NywyMSArNDY2LDIy
IEBAIHN0YXRpYyBpbnQKIGk5MTVfZ2VtX3NobWVtX3ByZWFkKHN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0ICpvYmosCiAJCSAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9wcmVhZCAqYXJncykKIHsK
LQljaGFyIF9fdXNlciAqdXNlcl9kYXRhOwotCXU2NCByZW1haW47CiAJdW5zaWduZWQgaW50IG5l
ZWRzX2NsZmx1c2g7CiAJdW5zaWduZWQgaW50IGlkeCwgb2Zmc2V0OworCXN0cnVjdCBkbWFfZmVu
Y2UgKmZlbmNlOworCWNoYXIgX191c2VyICp1c2VyX2RhdGE7CisJdTY0IHJlbWFpbjsKIAlpbnQg
cmV0OwogCi0JcmV0ID0gbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKCZvYmotPmJhc2UuZGV2LT5z
dHJ1Y3RfbXV0ZXgpOwotCWlmIChyZXQpCi0JCXJldHVybiByZXQ7Ci0KIAlyZXQgPSBpOTE1X2dl
bV9vYmplY3RfcHJlcGFyZV9yZWFkKG9iaiwgJm5lZWRzX2NsZmx1c2gpOwotCW11dGV4X3VubG9j
aygmb2JqLT5iYXNlLmRldi0+c3RydWN0X211dGV4KTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0
OwogCisJZmVuY2UgPSBpOTE1X2dlbV9vYmplY3RfbG9ja19mZW5jZShvYmopOworCWk5MTVfZ2Vt
X29iamVjdF9maW5pc2hfYWNjZXNzKG9iaik7CisJaWYgKCFmZW5jZSkKKwkJcmV0dXJuIC1FTk9N
RU07CisKIAlyZW1haW4gPSBhcmdzLT5zaXplOwogCXVzZXJfZGF0YSA9IHU2NF90b191c2VyX3B0
cihhcmdzLT5kYXRhX3B0cik7CiAJb2Zmc2V0ID0gb2Zmc2V0X2luX3BhZ2UoYXJncy0+b2Zmc2V0
KTsKQEAgLTUxOSw3ICs0OTksNyBAQCBpOTE1X2dlbV9zaG1lbV9wcmVhZChzdHJ1Y3QgZHJtX2k5
MTVfZ2VtX29iamVjdCAqb2JqLAogCQlvZmZzZXQgPSAwOwogCX0KIAotCWk5MTVfZ2VtX29iamVj
dF9maW5pc2hfYWNjZXNzKG9iaik7CisJaTkxNV9nZW1fb2JqZWN0X3VubG9ja19mZW5jZShvYmos
IGZlbmNlKTsKIAlyZXR1cm4gcmV0OwogfQogCkBAIC01NTUsOCArNTM1LDkgQEAgaTkxNV9nZW1f
Z3R0X3ByZWFkKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJc3RydWN0IGk5MTVf
Z2d0dCAqZ2d0dCA9ICZpOTE1LT5nZ3R0OwogCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwogCXN0
cnVjdCBkcm1fbW1fbm9kZSBub2RlOwotCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOworCXN0cnVjdCBk
bWFfZmVuY2UgKmZlbmNlOwogCXZvaWQgX191c2VyICp1c2VyX2RhdGE7CisJc3RydWN0IGk5MTVf
dm1hICp2bWE7CiAJdTY0IHJlbWFpbiwgb2Zmc2V0OwogCWludCByZXQ7CiAKQEAgLTU4NSwxMSAr
NTY2LDI0IEBAIGk5MTVfZ2VtX2d0dF9wcmVhZChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAq
b2JqLAogCQlHRU1fQlVHX09OKCFub2RlLmFsbG9jYXRlZCk7CiAJfQogCi0JcmV0ID0gaTkxNV9n
ZW1fb2JqZWN0X3NldF90b19ndHRfZG9tYWluKG9iaiwgZmFsc2UpOworCW11dGV4X3VubG9jaygm
aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CisKKwlyZXQgPSBpOTE1X2dlbV9vYmplY3RfbG9ja19p
bnRlcnJ1cHRpYmxlKG9iaik7CiAJaWYgKHJldCkKIAkJZ290byBvdXRfdW5waW47CiAKLQltdXRl
eF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCXJldCA9IGk5MTVfZ2VtX29iamVj
dF9zZXRfdG9fZ3R0X2RvbWFpbihvYmosIGZhbHNlKTsKKwlpZiAocmV0KSB7CisJCWk5MTVfZ2Vt
X29iamVjdF91bmxvY2sob2JqKTsKKwkJZ290byBvdXRfdW5waW47CisJfQorCisJZmVuY2UgPSBp
OTE1X2dlbV9vYmplY3RfbG9ja19mZW5jZShvYmopOworCWk5MTVfZ2VtX29iamVjdF91bmxvY2so
b2JqKTsKKwlpZiAoIWZlbmNlKSB7CisJCXJldCA9IC1FTk9NRU07CisJCWdvdG8gb3V0X3VucGlu
OworCX0KIAogCXVzZXJfZGF0YSA9IHU2NF90b191c2VyX3B0cihhcmdzLT5kYXRhX3B0cik7CiAJ
cmVtYWluID0gYXJncy0+c2l6ZTsKQEAgLTYyNyw4ICs2MjEsOSBAQCBpOTE1X2dlbV9ndHRfcHJl
YWQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAkJb2Zmc2V0ICs9IHBhZ2VfbGVu
Z3RoOwogCX0KIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCWk5MTVf
Z2VtX29iamVjdF91bmxvY2tfZmVuY2Uob2JqLCBmZW5jZSk7CiBvdXRfdW5waW46CisJbXV0ZXhf
bG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJaWYgKG5vZGUuYWxsb2NhdGVkKSB7CiAJ
CXdtYigpOwogCQlnZ3R0LT52bS5jbGVhcl9yYW5nZSgmZ2d0dC0+dm0sIG5vZGUuc3RhcnQsIG5v
ZGUuc2l6ZSk7CkBAIC03MzksNiArNzM0LDcgQEAgaTkxNV9nZW1fZ3R0X3B3cml0ZV9mYXN0KHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCA9
ICZpOTE1LT5nZ3R0OwogCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwogCXN0cnVjdCBkcm1fbW1f
bm9kZSBub2RlOworCXN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlOwogCXN0cnVjdCBpOTE1X3ZtYSAq
dm1hOwogCXU2NCByZW1haW4sIG9mZnNldDsKIAl2b2lkIF9fdXNlciAqdXNlcl9kYXRhOwpAQCAt
Nzg2LDExICs3ODIsMjQgQEAgaTkxNV9nZW1fZ3R0X3B3cml0ZV9mYXN0KHN0cnVjdCBkcm1faTkx
NV9nZW1fb2JqZWN0ICpvYmosCiAJCUdFTV9CVUdfT04oIW5vZGUuYWxsb2NhdGVkKTsKIAl9CiAK
LQlyZXQgPSBpOTE1X2dlbV9vYmplY3Rfc2V0X3RvX2d0dF9kb21haW4ob2JqLCB0cnVlKTsKKwlt
dXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCisJcmV0ID0gaTkxNV9nZW1f
b2JqZWN0X2xvY2tfaW50ZXJydXB0aWJsZShvYmopOwogCWlmIChyZXQpCiAJCWdvdG8gb3V0X3Vu
cGluOwogCi0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKKwlyZXQgPSBp
OTE1X2dlbV9vYmplY3Rfc2V0X3RvX2d0dF9kb21haW4ob2JqLCB0cnVlKTsKKwlpZiAocmV0KSB7
CisJCWk5MTVfZ2VtX29iamVjdF91bmxvY2sob2JqKTsKKwkJZ290byBvdXRfdW5waW47CisJfQor
CisJZmVuY2UgPSBpOTE1X2dlbV9vYmplY3RfbG9ja19mZW5jZShvYmopOworCWk5MTVfZ2VtX29i
amVjdF91bmxvY2sob2JqKTsKKwlpZiAoIWZlbmNlKSB7CisJCXJldCA9IC1FTk9NRU07CisJCWdv
dG8gb3V0X3VucGluOworCX0KIAogCWludGVsX2ZiX29ial9pbnZhbGlkYXRlKG9iaiwgT1JJR0lO
X0NQVSk7CiAKQEAgLTgzNSw4ICs4NDQsOSBAQCBpOTE1X2dlbV9ndHRfcHdyaXRlX2Zhc3Qoc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAl9CiAJaW50ZWxfZmJfb2JqX2ZsdXNoKG9i
aiwgT1JJR0lOX0NQVSk7CiAKLQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsK
KwlpOTE1X2dlbV9vYmplY3RfdW5sb2NrX2ZlbmNlKG9iaiwgZmVuY2UpOwogb3V0X3VucGluOgor
CW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWlmIChub2RlLmFsbG9jYXRl
ZCkgewogCQl3bWIoKTsKIAkJZ2d0dC0+dm0uY2xlYXJfcmFuZ2UoJmdndHQtPnZtLCBub2RlLnN0
YXJ0LCBub2RlLnNpemUpOwpAQCAtODgyLDIzICs4OTIsMjMgQEAgc3RhdGljIGludAogaTkxNV9n
ZW1fc2htZW1fcHdyaXRlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJCSAgICAg
IGNvbnN0IHN0cnVjdCBkcm1faTkxNV9nZW1fcHdyaXRlICphcmdzKQogewotCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShvYmotPmJhc2UuZGV2KTsKLQl2b2lkIF9fdXNl
ciAqdXNlcl9kYXRhOwotCXU2NCByZW1haW47CiAJdW5zaWduZWQgaW50IHBhcnRpYWxfY2FjaGVs
aW5lX3dyaXRlOwogCXVuc2lnbmVkIGludCBuZWVkc19jbGZsdXNoOwogCXVuc2lnbmVkIGludCBv
ZmZzZXQsIGlkeDsKKwlzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZTsKKwl2b2lkIF9fdXNlciAqdXNl
cl9kYXRhOworCXU2NCByZW1haW47CiAJaW50IHJldDsKIAotCXJldCA9IG11dGV4X2xvY2tfaW50
ZXJydXB0aWJsZSgmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0JaWYgKHJldCkKLQkJcmV0dXJu
IHJldDsKLQogCXJldCA9IGk5MTVfZ2VtX29iamVjdF9wcmVwYXJlX3dyaXRlKG9iaiwgJm5lZWRz
X2NsZmx1c2gpOwotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJaWYg
KHJldCkKIAkJcmV0dXJuIHJldDsKIAorCWZlbmNlID0gaTkxNV9nZW1fb2JqZWN0X2xvY2tfZmVu
Y2Uob2JqKTsKKwlpOTE1X2dlbV9vYmplY3RfZmluaXNoX2FjY2VzcyhvYmopOworCWlmICghZmVu
Y2UpCisJCXJldHVybiAtRU5PTUVNOworCiAJLyogSWYgd2UgZG9uJ3Qgb3ZlcndyaXRlIGEgY2Fj
aGVsaW5lIGNvbXBsZXRlbHkgd2UgbmVlZCB0byBiZQogCSAqIGNhcmVmdWwgdG8gaGF2ZSB1cC10
by1kYXRlIGRhdGEgYnkgZmlyc3QgY2xmbHVzaGluZy4gRG9uJ3QKIAkgKiBvdmVyY29tcGxpY2F0
ZSB0aGluZ3MgYW5kIGZsdXNoIHRoZSBlbnRpcmUgcGF0Y2guCkBAIC05MjYsNyArOTM2LDggQEAg
aTkxNV9nZW1fc2htZW1fcHdyaXRlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJ
fQogCiAJaW50ZWxfZmJfb2JqX2ZsdXNoKG9iaiwgT1JJR0lOX0NQVSk7Ci0JaTkxNV9nZW1fb2Jq
ZWN0X2ZpbmlzaF9hY2Nlc3Mob2JqKTsKKwlpOTE1X2dlbV9vYmplY3RfdW5sb2NrX2ZlbmNlKG9i
aiwgZmVuY2UpOworCiAJcmV0dXJuIHJldDsKIH0KIApAQCAtMTgwNSw3ICsxODE2LDkgQEAgc3Rh
dGljIGludCBfX2ludGVsX2VuZ2luZXNfcmVjb3JkX2RlZmF1bHRzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQogCQlpZiAoZXJyKQogCQkJZ290byBlcnJfYWN0aXZlOwogCisJCWk5MTVf
Z2VtX29iamVjdF9sb2NrKHN0YXRlLT5vYmopOwogCQllcnIgPSBpOTE1X2dlbV9vYmplY3Rfc2V0
X3RvX2NwdV9kb21haW4oc3RhdGUtPm9iaiwgZmFsc2UpOworCQlpOTE1X2dlbV9vYmplY3RfdW5s
b2NrKHN0YXRlLT5vYmopOwogCQlpZiAoZXJyKQogCQkJZ290byBlcnJfYWN0aXZlOwogCkBAIC0y
MjUyLDEyICsyMjY1LDEzIEBAIGludCBpOTE1X2dlbV9mcmVlemVfbGF0ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSkKIAlpOTE1X2dlbV9zaHJpbmsoaTkxNSwgLTFVTCwgTlVMTCwgSTkx
NV9TSFJJTktfVU5CT1VORCk7CiAJaTkxNV9nZW1fZHJhaW5fZnJlZWRfb2JqZWN0cyhpOTE1KTsK
IAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWZvciAocGhhc2UgPSBw
aGFzZXM7ICpwaGFzZTsgcGhhc2UrKykgewotCQlsaXN0X2Zvcl9lYWNoX2VudHJ5KG9iaiwgKnBo
YXNlLCBtbS5saW5rKQorCQlsaXN0X2Zvcl9lYWNoX2VudHJ5KG9iaiwgKnBoYXNlLCBtbS5saW5r
KSB7CisJCQlpOTE1X2dlbV9vYmplY3RfbG9jayhvYmopOwogCQkJV0FSTl9PTihpOTE1X2dlbV9v
YmplY3Rfc2V0X3RvX2NwdV9kb21haW4ob2JqLCB0cnVlKSk7CisJCQlpOTE1X2dlbV9vYmplY3Rf
dW5sb2NrKG9iaik7CisJCX0KIAl9Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211
dGV4KTsKIAogCXJldHVybiAwOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9nZW1fZ3R0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuYwppbmRl
eCAyYWY3NjJhMzZhYjIuLjU3NDdmNzg1YzBmNiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9nZW1fZ3R0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1f
Z3R0LmMKQEAgLTM1MTksOCArMzUxOSwxMSBAQCB2b2lkIGk5MTVfZ2VtX3Jlc3RvcmVfZ3R0X21h
cHBpbmdzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAkJV0FSTl9PTihpOTE1
X3ZtYV9iaW5kKHZtYSwKIAkJCQkgICAgICBvYmogPyBvYmotPmNhY2hlX2xldmVsIDogMCwKIAkJ
CQkgICAgICBQSU5fVVBEQVRFKSk7Ci0JCWlmIChvYmopCisJCWlmIChvYmopIHsKKwkJCWk5MTVf
Z2VtX29iamVjdF9sb2NrKG9iaik7CiAJCQlXQVJOX09OKGk5MTVfZ2VtX29iamVjdF9zZXRfdG9f
Z3R0X2RvbWFpbihvYmosIGZhbHNlKSk7CisJCQlpOTE1X2dlbV9vYmplY3RfdW5sb2NrKG9iaik7
CisJCX0KIAogbG9jazoKIAkJbXV0ZXhfbG9jaygmZ2d0dC0+dm0ubXV0ZXgpOwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fcmVuZGVyX3N0YXRlLmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9yZW5kZXJfc3RhdGUuYwppbmRleCBmM2I0MmIwMjZmZmYu
LjcwNmVkNzE0NjhlOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1f
cmVuZGVyX3N0YXRlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fcmVuZGVy
X3N0YXRlLmMKQEAgLTIyMiw3ICsyMjIsOSBAQCBpbnQgaTkxNV9nZW1fcmVuZGVyX3N0YXRlX2Vt
aXQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJCQlnb3RvIGVycl91bnBpbjsKIAl9CiAKKwlp
OTE1X3ZtYV9sb2NrKHNvLnZtYSk7CiAJZXJyID0gaTkxNV92bWFfbW92ZV90b19hY3RpdmUoc28u
dm1hLCBycSwgMCk7CisJaTkxNV92bWFfdW5sb2NrKHNvLnZtYSk7CiBlcnJfdW5waW46CiAJaTkx
NV92bWFfdW5waW4oc28udm1hKTsKIGVycl92bWE6CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3ZtYS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYwppbmRl
eCBjZjQwNWZmZGEwNDUuLmRiOTRkN2I2YzVhNiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV92bWEuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCkBA
IC04NDAsMTMgKzg0MCwxNCBAQCB2b2lkIGk5MTVfdm1hX2Rlc3Ryb3koc3RydWN0IGk5MTVfdm1h
ICp2bWEpCiB7CiAJbG9ja2RlcF9hc3NlcnRfaGVsZCgmdm1hLT52bS0+aTkxNS0+ZHJtLnN0cnVj
dF9tdXRleCk7CiAKLQlHRU1fQlVHX09OKGk5MTVfdm1hX2lzX2FjdGl2ZSh2bWEpKTsKIAlHRU1f
QlVHX09OKGk5MTVfdm1hX2lzX3Bpbm5lZCh2bWEpKTsKIAogCWlmIChpOTE1X3ZtYV9pc19jbG9z
ZWQodm1hKSkKIAkJbGlzdF9kZWwoJnZtYS0+Y2xvc2VkX2xpbmspOwogCiAJV0FSTl9PTihpOTE1
X3ZtYV91bmJpbmQodm1hKSk7CisJR0VNX0JVR19PTihpOTE1X3ZtYV9pc19hY3RpdmUodm1hKSk7
CisKIAlfX2k5MTVfdm1hX2Rlc3Ryb3kodm1hKTsKIH0KIApAQCAtOTA4LDEyICs5MDksMTAgQEAg
c3RhdGljIHZvaWQgZXhwb3J0X2ZlbmNlKHN0cnVjdCBpOTE1X3ZtYSAqdm1hLAogCSAqIGhhbmRs
ZSBhbiBlcnJvciByaWdodCBub3cuIFdvcnN0IGNhc2Ugc2hvdWxkIGJlIG1pc3NlZAogCSAqIHN5
bmNocm9uaXNhdGlvbiBsZWFkaW5nIHRvIHJlbmRlcmluZyBjb3JydXB0aW9uLgogCSAqLwotCXJl
c2VydmF0aW9uX29iamVjdF9sb2NrKHJlc3YsIE5VTEwpOwogCWlmIChmbGFncyAmIEVYRUNfT0JK
RUNUX1dSSVRFKQogCQlyZXNlcnZhdGlvbl9vYmplY3RfYWRkX2V4Y2xfZmVuY2UocmVzdiwgJnJx
LT5mZW5jZSk7CiAJZWxzZSBpZiAocmVzZXJ2YXRpb25fb2JqZWN0X3Jlc2VydmVfc2hhcmVkKHJl
c3YsIDEpID09IDApCiAJCXJlc2VydmF0aW9uX29iamVjdF9hZGRfc2hhcmVkX2ZlbmNlKHJlc3Ys
ICZycS0+ZmVuY2UpOwotCXJlc2VydmF0aW9uX29iamVjdF91bmxvY2socmVzdik7CiB9CiAKIGlu
dCBpOTE1X3ZtYV9tb3ZlX3RvX2FjdGl2ZShzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKQEAgLTkyMiw3
ICs5MjEsOCBAQCBpbnQgaTkxNV92bWFfbW92ZV90b19hY3RpdmUoc3RydWN0IGk5MTVfdm1hICp2
bWEsCiB7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IHZtYS0+b2JqOwogCi0J
bG9ja2RlcF9hc3NlcnRfaGVsZCgmcnEtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCWFzc2Vy
dF92bWFfaGVsZCh2bWEpOworCWFzc2VydF9vYmplY3RfaGVsZChvYmopOwogCUdFTV9CVUdfT04o
IWRybV9tbV9ub2RlX2FsbG9jYXRlZCgmdm1hLT5ub2RlKSk7CiAKIAkvKgpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfdm1hLmgKaW5kZXggNzU0YTc2MmQ5MGI0Li4yNjU3Yzk5ZmUxODcgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV92bWEuaApAQCAtMjk4LDYgKzI5OCwxOCBAQCB2b2lkIGk5MTVfdm1hX2Nsb3NlKHN0cnVj
dCBpOTE1X3ZtYSAqdm1hKTsKIHZvaWQgaTkxNV92bWFfcmVvcGVuKHN0cnVjdCBpOTE1X3ZtYSAq
dm1hKTsKIHZvaWQgaTkxNV92bWFfZGVzdHJveShzdHJ1Y3QgaTkxNV92bWEgKnZtYSk7CiAKKyNk
ZWZpbmUgYXNzZXJ0X3ZtYV9oZWxkKHZtYSkgcmVzZXJ2YXRpb25fb2JqZWN0X2Fzc2VydF9oZWxk
KCh2bWEpLT5yZXN2KQorCitzdGF0aWMgaW5saW5lIHZvaWQgaTkxNV92bWFfbG9jayhzdHJ1Y3Qg
aTkxNV92bWEgKnZtYSkKK3sKKwlyZXNlcnZhdGlvbl9vYmplY3RfbG9jayh2bWEtPnJlc3YsIE5V
TEwpOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQgaTkxNV92bWFfdW5sb2NrKHN0cnVjdCBpOTE1
X3ZtYSAqdm1hKQoreworCXJlc2VydmF0aW9uX29iamVjdF91bmxvY2sodm1hLT5yZXN2KTsKK30K
KwogaW50IF9faTkxNV92bWFfZG9fcGluKHN0cnVjdCBpOTE1X3ZtYSAqdm1hLAogCQkgICAgICB1
NjQgc2l6ZSwgdTY0IGFsaWdubWVudCwgdTY0IGZsYWdzKTsKIHN0YXRpYyBpbmxpbmUgaW50IF9f
bXVzdF9jaGVjawpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGlzcGxh
eS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGlzcGxheS5jCmluZGV4IGUwMGRlMjIz
N2ZkOC4uODY0MzYzN2IxNTRiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9kaXNwbGF5LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGlzcGxheS5jCkBA
IC0yMTEyLDYgKzIxMTIsNyBAQCBpbnRlbF9waW5fYW5kX2ZlbmNlX2ZiX29iaihzdHJ1Y3QgZHJt
X2ZyYW1lYnVmZmVyICpmYiwKIAkgKiBwaW4vdW5waW4vZmVuY2UgYW5kIG5vdCBtb3JlLgogCSAq
LwogCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7CisJaTkxNV9nZW1f
b2JqZWN0X2xvY2sob2JqKTsKIAogCWF0b21pY19pbmMoJmRldl9wcml2LT5ncHVfZXJyb3IucGVu
ZGluZ19mYl9waW4pOwogCkBAIC0yMTY2LDYgKzIxNjcsNyBAQCBpbnRlbF9waW5fYW5kX2ZlbmNl
X2ZiX29iaihzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiwKIGVycjoKIAlhdG9taWNfZGVjKCZk
ZXZfcHJpdi0+Z3B1X2Vycm9yLnBlbmRpbmdfZmJfcGluKTsKIAorCWk5MTVfZ2VtX29iamVjdF91
bmxvY2sob2JqKTsKIAlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7CiAJ
cmV0dXJuIHZtYTsKIH0KQEAgLTIxNzQsOSArMjE3NiwxMiBAQCB2b2lkIGludGVsX3VucGluX2Zi
X3ZtYShzdHJ1Y3QgaTkxNV92bWEgKnZtYSwgdW5zaWduZWQgbG9uZyBmbGFncykKIHsKIAlsb2Nr
ZGVwX2Fzc2VydF9oZWxkKCZ2bWEtPnZtLT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAorCWk5
MTVfZ2VtX29iamVjdF9sb2NrKHZtYS0+b2JqKTsKIAlpZiAoZmxhZ3MgJiBQTEFORV9IQVNfRkVO
Q0UpCiAJCWk5MTVfdm1hX3VucGluX2ZlbmNlKHZtYSk7CiAJaTkxNV9nZW1fb2JqZWN0X3VucGlu
X2Zyb21fZGlzcGxheV9wbGFuZSh2bWEpOworCWk5MTVfZ2VtX29iamVjdF91bmxvY2sodm1hLT5v
YmopOworCiAJaTkxNV92bWFfcHV0KHZtYSk7CiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX2d1Y19sb2cuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1
Y19sb2cuYwppbmRleCA3MTQ2NTI0MjY0ZGQuLjY3ZWFkYzgyYzM5NiAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2xvZy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX2d1Y19sb2cuYwpAQCAtMzQzLDggKzM0Myw2IEBAIHN0YXRpYyB2b2lkIGNhcHR1
cmVfbG9nc193b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKIAogc3RhdGljIGludCBndWNf
bG9nX21hcChzdHJ1Y3QgaW50ZWxfZ3VjX2xvZyAqbG9nKQogewotCXN0cnVjdCBpbnRlbF9ndWMg
Kmd1YyA9IGxvZ190b19ndWMobG9nKTsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSBndWNfdG9faTkxNShndWMpOwogCXZvaWQgKnZhZGRyOwogCWludCByZXQ7CiAKQEAgLTM1
Myw5ICszNTEsOSBAQCBzdGF0aWMgaW50IGd1Y19sb2dfbWFwKHN0cnVjdCBpbnRlbF9ndWNfbG9n
ICpsb2cpCiAJaWYgKCFsb2ctPnZtYSkKIAkJcmV0dXJuIC1FTk9ERVY7CiAKLQltdXRleF9sb2Nr
KCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7CisJaTkxNV9nZW1fb2JqZWN0X2xvY2sobG9n
LT52bWEtPm9iaik7CiAJcmV0ID0gaTkxNV9nZW1fb2JqZWN0X3NldF90b193Y19kb21haW4obG9n
LT52bWEtPm9iaiwgdHJ1ZSk7Ci0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9t
dXRleCk7CisJaTkxNV9nZW1fb2JqZWN0X3VubG9jayhsb2ctPnZtYS0+b2JqKTsKIAlpZiAocmV0
KQogCQlyZXR1cm4gcmV0OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9vdmVybGF5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9vdmVybGF5LmMKaW5kZXgg
ODBkY2Q4NzlmYzU4Li5hMmFjMDZhMDg3MTUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX292ZXJsYXkuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9vdmVy
bGF5LmMKQEAgLTc2NSw4ICs3NjUsMTAgQEAgc3RhdGljIGludCBpbnRlbF9vdmVybGF5X2RvX3B1
dF9pbWFnZShzdHJ1Y3QgaW50ZWxfb3ZlcmxheSAqb3ZlcmxheSwKIAogCWF0b21pY19pbmMoJmRl
dl9wcml2LT5ncHVfZXJyb3IucGVuZGluZ19mYl9waW4pOwogCisJaTkxNV9nZW1fb2JqZWN0X2xv
Y2sobmV3X2JvKTsKIAl2bWEgPSBpOTE1X2dlbV9vYmplY3RfcGluX3RvX2Rpc3BsYXlfcGxhbmUo
bmV3X2JvLAogCQkJCQkJICAgMCwgTlVMTCwgUElOX01BUFBBQkxFKTsKKwlpOTE1X2dlbV9vYmpl
Y3RfdW5sb2NrKG5ld19ibyk7CiAJaWYgKElTX0VSUih2bWEpKSB7CiAJCXJldCA9IFBUUl9FUlIo
dm1hKTsKIAkJZ290byBvdXRfcGluX3NlY3Rpb247CkBAIC0xMzA1LDE1ICsxMzA3LDIwIEBAIGlu
dCBpbnRlbF9vdmVybGF5X2F0dHJzX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQg
KmRhdGEsCiAKIHN0YXRpYyBpbnQgZ2V0X3JlZ2lzdGVycyhzdHJ1Y3QgaW50ZWxfb3ZlcmxheSAq
b3ZlcmxheSwgYm9vbCB1c2VfcGh5cykKIHsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IG92ZXJsYXktPmk5MTU7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKIAlz
dHJ1Y3QgaTkxNV92bWEgKnZtYTsKIAlpbnQgZXJyOwogCi0Jb2JqID0gaTkxNV9nZW1fb2JqZWN0
X2NyZWF0ZV9zdG9sZW4ob3ZlcmxheS0+aTkxNSwgUEFHRV9TSVpFKTsKKwltdXRleF9sb2NrKCZp
OTE1LT5kcm0uc3RydWN0X211dGV4KTsKKworCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVf
c3RvbGVuKGk5MTUsIFBBR0VfU0laRSk7CiAJaWYgKG9iaiA9PSBOVUxMKQotCQlvYmogPSBpOTE1
X2dlbV9vYmplY3RfY3JlYXRlX2ludGVybmFsKG92ZXJsYXktPmk5MTUsIFBBR0VfU0laRSk7Ci0J
aWYgKElTX0VSUihvYmopKQotCQlyZXR1cm4gUFRSX0VSUihvYmopOworCQlvYmogPSBpOTE1X2dl
bV9vYmplY3RfY3JlYXRlX2ludGVybmFsKGk5MTUsIFBBR0VfU0laRSk7CisJaWYgKElTX0VSUihv
YmopKSB7CisJCWVyciA9IFBUUl9FUlIob2JqKTsKKwkJZ290byBlcnJfdW5sb2NrOworCX0KIAog
CXZtYSA9IGk5MTVfZ2VtX29iamVjdF9nZ3R0X3BpbihvYmosIE5VTEwsIDAsIDAsIFBJTl9NQVBQ
QUJMRSk7CiAJaWYgKElTX0VSUih2bWEpKSB7CkBAIC0xMzM0LDEwICsxMzQxLDEzIEBAIHN0YXRp
YyBpbnQgZ2V0X3JlZ2lzdGVycyhzdHJ1Y3QgaW50ZWxfb3ZlcmxheSAqb3ZlcmxheSwgYm9vbCB1
c2VfcGh5cykKIAl9CiAKIAlvdmVybGF5LT5yZWdfYm8gPSBvYmo7CisJbXV0ZXhfdW5sb2NrKCZp
OTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlyZXR1cm4gMDsKIAogZXJyX3B1dF9ibzoKIAlpOTE1
X2dlbV9vYmplY3RfcHV0KG9iaik7CitlcnJfdW5sb2NrOgorCW11dGV4X3VubG9jaygmaTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7CiAJcmV0dXJuIGVycjsKIH0KIApAQCAtMTM2MywxOCArMTM3Mywx
NiBAQCB2b2lkIGludGVsX292ZXJsYXlfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQogCiAJSU5JVF9BQ1RJVkVfUkVRVUVTVCgmb3ZlcmxheS0+bGFzdF9mbGlwKTsKIAot
CW11dGV4X2xvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKLQogCXJldCA9IGdldF9y
ZWdpc3RlcnMob3ZlcmxheSwgT1ZFUkxBWV9ORUVEU19QSFlTSUNBTChkZXZfcHJpdikpOwogCWlm
IChyZXQpCiAJCWdvdG8gb3V0X2ZyZWU7CiAKKwlpOTE1X2dlbV9vYmplY3RfbG9jayhvdmVybGF5
LT5yZWdfYm8pOwogCXJldCA9IGk5MTVfZ2VtX29iamVjdF9zZXRfdG9fZ3R0X2RvbWFpbihvdmVy
bGF5LT5yZWdfYm8sIHRydWUpOworCWk5MTVfZ2VtX29iamVjdF91bmxvY2sob3ZlcmxheS0+cmVn
X2JvKTsKIAlpZiAocmV0KQogCQlnb3RvIG91dF9yZWdfYm87CiAKLQltdXRleF91bmxvY2soJmRl
dl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKLQogCW1lbXNldF9pbyhvdmVybGF5LT5yZWdzLCAw
LCBzaXplb2Yoc3RydWN0IG92ZXJsYXlfcmVnaXN0ZXJzKSk7CiAJdXBkYXRlX3BvbHlwaGFzZV9m
aWx0ZXIob3ZlcmxheS0+cmVncyk7CiAJdXBkYXRlX3JlZ19hdHRycyhvdmVybGF5LCBvdmVybGF5
LT5yZWdzKTsKQEAgLTEzODYsNyArMTM5NCw2IEBAIHZvaWQgaW50ZWxfb3ZlcmxheV9zZXR1cChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiBvdXRfcmVnX2JvOgogCWk5MTVfZ2Vt
X29iamVjdF9wdXQob3ZlcmxheS0+cmVnX2JvKTsKIG91dF9mcmVlOgotCW11dGV4X3VubG9jaygm
ZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWtmcmVlKG92ZXJsYXkpOwogfQogCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91Y19mdy5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfdWNfZncuYwppbmRleCAzMjU3YTA1NGNiMGIuLmUwMDQyNjUwNzI2YSAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdWNfZncuYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91Y19mdy5jCkBAIC0yNDYsMTUgKzI0NiwxMyBAQCBpbnQg
aW50ZWxfdWNfZndfdXBsb2FkKHN0cnVjdCBpbnRlbF91Y19mdyAqdWNfZncsCiAJCQkgaW50ZWxf
dWNfZndfdHlwZV9yZXByKHVjX2Z3LT50eXBlKSwKIAkJCSBpbnRlbF91Y19md19zdGF0dXNfcmVw
cih1Y19mdy0+bG9hZF9zdGF0dXMpKTsKIAotCWludGVsX3VjX2Z3X2dndHRfYmluZCh1Y19mdyk7
Ci0KIAkvKiBDYWxsIGN1c3RvbSBsb2FkZXIgKi8KKwlpbnRlbF91Y19md19nZ3R0X2JpbmQodWNf
ZncpOwogCWVyciA9IHhmZXIodWNfZncpOworCWludGVsX3VjX2Z3X2dndHRfdW5iaW5kKHVjX2Z3
KTsKIAlpZiAoZXJyKQogCQlnb3RvIGZhaWw7CiAKLQlpbnRlbF91Y19md19nZ3R0X3VuYmluZCh1
Y19mdyk7Ci0KIAl1Y19mdy0+bG9hZF9zdGF0dXMgPSBJTlRFTF9VQ19GSVJNV0FSRV9TVUNDRVNT
OwogCURSTV9ERUJVR19EUklWRVIoIiVzIGZ3IGxvYWQgJXNcbiIsCiAJCQkgaW50ZWxfdWNfZndf
dHlwZV9yZXByKHVjX2Z3LT50eXBlKSwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L3NlbGZ0ZXN0cy9pOTE1X3JlcXVlc3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0
cy9pOTE1X3JlcXVlc3QuYwppbmRleCA0ZmQ1MzU2YzY1NzcuLjJjNTQ3OWNhMWY2OSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfcmVxdWVzdC5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3JlcXVlc3QuYwpAQCAtODc0LDcg
Kzg3NCw5IEBAIHN0YXRpYyBpbnQgbGl2ZV9hbGxfZW5naW5lcyh2b2lkICphcmcpCiAJCQlpOTE1
X2dlbV9vYmplY3Rfc2V0X2FjdGl2ZV9yZWZlcmVuY2UoYmF0Y2gtPm9iaik7CiAJCX0KIAorCQlp
OTE1X3ZtYV9sb2NrKGJhdGNoKTsKIAkJZXJyID0gaTkxNV92bWFfbW92ZV90b19hY3RpdmUoYmF0
Y2gsIHJlcXVlc3RbaWRdLCAwKTsKKwkJaTkxNV92bWFfdW5sb2NrKGJhdGNoKTsKIAkJR0VNX0JV
R19PTihlcnIpOwogCiAJCWk5MTVfcmVxdWVzdF9nZXQocmVxdWVzdFtpZF0pOwpAQCAtOTg5LDcg
Kzk5MSw5IEBAIHN0YXRpYyBpbnQgbGl2ZV9zZXF1ZW50aWFsX2VuZ2luZXModm9pZCAqYXJnKQog
CQlHRU1fQlVHX09OKGVycik7CiAJCXJlcXVlc3RbaWRdLT5iYXRjaCA9IGJhdGNoOwogCisJCWk5
MTVfdm1hX2xvY2soYmF0Y2gpOwogCQllcnIgPSBpOTE1X3ZtYV9tb3ZlX3RvX2FjdGl2ZShiYXRj
aCwgcmVxdWVzdFtpZF0sIDApOworCQlpOTE1X3ZtYV91bmxvY2soYmF0Y2gpOwogCQlHRU1fQlVH
X09OKGVycik7CiAKIAkJaTkxNV9nZW1fb2JqZWN0X3NldF9hY3RpdmVfcmVmZXJlbmNlKGJhdGNo
LT5vYmopOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2lndF9z
cGlubmVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaWd0X3NwaW5uZXIuYwpp
bmRleCAzOGQ2ZjFiMTBjNTQuLjE1YzBmMGFmOTY1OCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvc2VsZnRlc3RzL2lndF9zcGlubmVyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvc2VsZnRlc3RzL2lndF9zcGlubmVyLmMKQEAgLTc2LDcgKzc2LDkgQEAgc3RhdGljIGludCBt
b3ZlX3RvX2FjdGl2ZShzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKIHsKIAlpbnQgZXJyOwogCisJaTkx
NV92bWFfbG9jayh2bWEpOwogCWVyciA9IGk5MTVfdm1hX21vdmVfdG9fYWN0aXZlKHZtYSwgcnEs
IGZsYWdzKTsKKwlpOTE1X3ZtYV91bmxvY2sodm1hKTsKIAlpZiAoZXJyKQogCQlyZXR1cm4gZXJy
OwogCi0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9w
Lm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVs
LWdmeA==

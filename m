Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 9663127E18A
	for <lists+intel-gfx@lfdr.de>; Wed, 30 Sep 2020 08:43:20 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 622626E50B;
	Wed, 30 Sep 2020 06:43:18 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga17.intel.com (mga17.intel.com [192.55.52.151])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B027B6E509
 for <intel-gfx@lists.freedesktop.org>; Wed, 30 Sep 2020 06:42:54 +0000 (UTC)
IronPort-SDR: PlAPSmELlj7TKrfnAg4phYkFT6RTuk4ITXrN/E6YXojzhEOalKXTGP0tB94Ncahg+dSBYO0vpK
 D91jEFCMkFkA==
X-IronPort-AV: E=McAfee;i="6000,8403,9759"; a="142387782"
X-IronPort-AV: E=Sophos;i="5.77,321,1596524400"; d="scan'208";a="142387782"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga006.jf.intel.com ([10.7.209.51])
 by fmsmga107.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 29 Sep 2020 23:42:54 -0700
IronPort-SDR: WUPdIHBYYlWA+yOV2hfd/xZvHqg/UlVYLDFbZtB+gIlUpT9/KjZGAQhvnHzo7n/ALZgsp5w57Z
 SWlz1qbsjDRQ==
X-IronPort-AV: E=Sophos;i="5.77,321,1596524400"; d="scan'208";a="312487765"
Received: from cdgarci1-mobl1.amr.corp.intel.com (HELO
 ldmartin-desk1.intel.com) ([10.213.164.152])
 by orsmga006-auth.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 29 Sep 2020 23:42:53 -0700
From: Lucas De Marchi <lucas.demarchi@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 29 Sep 2020 23:42:31 -0700
Message-Id: <20200930064234.85769-22-lucas.demarchi@intel.com>
X-Mailer: git-send-email 2.28.0
In-Reply-To: <20200930064234.85769-1-lucas.demarchi@intel.com>
References: <20200930064234.85769-1-lucas.demarchi@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v6 21/24] drm/i915/dg1: Add initial DG1
 workarounds
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogU3R1YXJ0IFN1bW1lcnMgPHN0dWFydC5zdW1tZXJzQGludGVsLmNvbT4KCkRHMSBzaGFy
ZXMgc29tZSB3b3JrYXJvdW5kcyB3aXRoIFRHTCBhbmQgUktMIGFuZCBhbHNvIGhhcyBzb21lCmFk
ZGl0aW9uYWwgd29ya2Fyb3VuZHMgb2YgaXRzIG93bi4KCnYyOiBDb3JyZWN0IGxvY2F0aW9uIG9m
IFdhXzE0MDg2MTUwNzIgKEpvaG5IKS4KdjM6IEFwcGx5IFdBcyAxNjA2NzAwNjE3LCAxODAxMTQ2
NDE2NCBhbmQgMjIwMTA5MzEyOTYgdG8gREcxIChKb3PDqSkKdjQgKEFudXNoYSkKICAtIEFkZCBX
YV8yMjAxMDI3MTAyMQogIC0gcy9XYV8xNDAxMDA5Njg0NC9XYV8xNDA5ODM2Njg2CnY1OgogIC0g
RXh0ZW5kIFdhXzE0MDEwOTE5MTM4IHRvIGFsbCByZXZzIChNYXR0IEF0d29vZCkKICAtIFBvd2Vy
IGdhdGUgbWVkaWEgaXMgZ2xvYmFsIGdlbjEyIGRlc2lnbi4gKFJvZHJpZ28pCiAgLSBSZWJhc2Ug
KEx1Y2FzKQoKQlNwZWM6IDUzNTA4CgpDYzogTWF0dCBBdHdvb2QgPG1hdHRoZXcucy5hdHdvb2RA
aW50ZWwuY29tPgpDYzogTWF0dCBSb3BlciA8bWF0dGhldy5kLnJvcGVyQGludGVsLmNvbT4KQ2M6
IFJhZGhha3Jpc2huYSBTcmlwYWRhIDxyYWRoYWtyaXNobmEuc3JpcGFkYUBpbnRlbC5jb20+CkNj
OiBKb3PDqSBSb2JlcnRvIGRlIFNvdXphIDxqb3NlLnNvdXphQGludGVsLmNvbT4KU2lnbmVkLW9m
Zi1ieTogU3R1YXJ0IFN1bW1lcnMgPHN0dWFydC5zdW1tZXJzQGludGVsLmNvbT4KU2lnbmVkLW9m
Zi1ieTogQW51c2hhIFNyaXZhdHNhIDxhbnVzaGEuc3JpdmF0c2FAaW50ZWwuY29tPgpTaWduZWQt
b2ZmLWJ5OiBSb2RyaWdvIFZpdmkgPHJvZHJpZ28udml2aUBpbnRlbC5jb20+ClNpZ25lZC1vZmYt
Ynk6IEx1Y2FzIERlIE1hcmNoaSA8bHVjYXMuZGVtYXJjaGlAaW50ZWwuY29tPgotLS0KIC4uLi9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfcG93ZXIuYyAgICB8ICAgNSArLQogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zcHJpdGUuYyAgIHwgICA0ICstCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF93b3JrYXJvdW5kcy5jICAgfCAxMTEgKysrKysrKysrKysr
KystLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BjaS5jICAgICAgICAgICAgICAgfCAg
IDIgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZWcuaCAgICAgICAgICAgICAgIHwgIDEw
ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5jICAgICAgICAgICAgICAgfCAgMzkg
KysrKy0tCiA2IGZpbGVzIGNoYW5nZWQsIDEyOSBpbnNlcnRpb25zKCspLCA0MiBkZWxldGlvbnMo
LSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3Bs
YXlfcG93ZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV9w
b3dlci5jCmluZGV4IDk0YmU2NGZjZTVkMy4uMDgyN2U2OGE5ZDg5IDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfcG93ZXIuYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfcG93ZXIuYwpAQCAtNTQ2Miw4
ICs1NDYyLDkgQEAgc3RhdGljIHZvaWQgdGdsX2J3X2J1ZGR5X2luaXQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQogCXVuc2lnbmVkIGxvbmcgYWJveF9tYXNrID0gSU5URUxfSU5G
TyhkZXZfcHJpdiktPmFib3hfbWFzazsKIAlpbnQgY29uZmlnLCBpOwogCi0JaWYgKElTX1RHTF9E
SVNQX1JFVklEKGRldl9wcml2LCBUR0xfUkVWSURfQTAsIFRHTF9SRVZJRF9CMCkpCi0JCS8qIFdh
XzE0MDk3NjcxMDg6IHRnbCAqLworCWlmIChJU19ERzFfUkVWSUQoZGV2X3ByaXYsIERHMV9SRVZJ
RF9BMCwgREcxX1JFVklEX0EwKSB8fAorCSAgICBJU19UR0xfRElTUF9SRVZJRChkZXZfcHJpdiwg
VEdMX1JFVklEX0EwLCBUR0xfUkVWSURfQjApKQorCQkvKiBXYV8xNDA5NzY3MTA4OnRnbCxkZzEg
Ki8KIAkJdGFibGUgPSB3YV8xNDA5NzY3MTA4X2J1ZGR5X3BhZ2VfbWFza3M7CiAJZWxzZQogCQl0
YWJsZSA9IHRnbF9idWRkeV9wYWdlX21hc2tzOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9zcHJpdGUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfc3ByaXRlLmMKaW5kZXggMmRhMTFhYjYzNDNjLi43OTczNTM5OGNkNTYgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3ByaXRlLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zcHJpdGUuYwpAQCAtMjg4MCw4ICsy
ODgwLDggQEAgc3RhdGljIGJvb2wgc2tsX3BsYW5lX2Zvcm1hdF9tb2Rfc3VwcG9ydGVkKHN0cnVj
dCBkcm1fcGxhbmUgKl9wbGFuZSwKIHN0YXRpYyBib29sIGdlbjEyX3BsYW5lX3N1cHBvcnRzX21j
X2NjcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJCQkJCWVudW0gcGxhbmVf
aWQgcGxhbmVfaWQpCiB7Ci0JLyogV2FfMTQwMTA0NzcwMDg6dGdsW2EwLi5jMF0scmtsW2FsbF0g
Ki8KLQlpZiAoSVNfUk9DS0VUTEFLRShkZXZfcHJpdikgfHwKKwkvKiBXYV8xNDAxMDQ3NzAwODp0
Z2xbYTAuLmMwXSxya2xbYWxsXSxkZzFbYWxsXSAqLworCWlmIChJU19ERzEoZGV2X3ByaXYpIHx8
IElTX1JPQ0tFVExBS0UoZGV2X3ByaXYpIHx8CiAJICAgIElTX1RHTF9ESVNQX1JFVklEKGRldl9w
cml2LCBUR0xfUkVWSURfQTAsIFRHTF9SRVZJRF9DMCkpCiAJCXJldHVybiBmYWxzZTsKIApkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfd29ya2Fyb3VuZHMuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3dvcmthcm91bmRzLmMKaW5kZXggNmM1ODBkMGQ5
ZWE4Li4wYWJiNTJiZDViZjQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX3dvcmthcm91bmRzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfd29y
a2Fyb3VuZHMuYwpAQCAtNjcyLDYgKzY3MiwyMCBAQCBzdGF0aWMgdm9pZCB0Z2xfY3R4X3dvcmth
cm91bmRzX2luaXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAogCSAgICAgICAwKTsK
IH0KIAorc3RhdGljIHZvaWQgZGcxX2N0eF93b3JrYXJvdW5kc19pbml0KHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSwKKwkJCQkgICAgIHN0cnVjdCBpOTE1X3dhX2xpc3QgKndhbCkKK3sK
KwlnZW4xMl9jdHhfd29ya2Fyb3VuZHNfaW5pdChlbmdpbmUsIHdhbCk7CisKKwkvKiBXYV8xNDA5
MDQ0NzY0ICovCisJV0FfQ0xSX0JJVF9NQVNLRUQoR0VOMTFfQ09NTU9OX1NMSUNFX0NISUNLRU4z
LAorCQkJICBERzFfRkxPQVRfUE9JTlRfQkxFTkRfT1BUX1NUUklDVF9NT0RFX0VOKTsKKworCS8q
IFdhXzIyMDEwNDkzMjk4ICovCisJV0FfU0VUX0JJVF9NQVNLRUQoSElaX0NISUNLRU4sCisJCQkg
IERHMV9IWl9SRUFEX1NVUFBSRVNTSU9OX09QVElNSVpBVElPTl9ESVNBQkxFKTsKK30KKwogc3Rh
dGljIHZvaWQKIF9faW50ZWxfZW5naW5lX2luaXRfY3R4X3dhKHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSwKIAkJCSAgIHN0cnVjdCBpOTE1X3dhX2xpc3QgKndhbCwKQEAgLTY4NCw3ICs2
OTgsOSBAQCBfX2ludGVsX2VuZ2luZV9pbml0X2N0eF93YShzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmUsCiAKIAl3YV9pbml0X3N0YXJ0KHdhbCwgbmFtZSwgZW5naW5lLT5uYW1lKTsKIAot
CWlmIChJU19ST0NLRVRMQUtFKGk5MTUpIHx8IElTX1RJR0VSTEFLRShpOTE1KSkKKwlpZiAoSVNf
REcxKGk5MTUpKQorCQlkZzFfY3R4X3dvcmthcm91bmRzX2luaXQoZW5naW5lLCB3YWwpOworCWVs
c2UgaWYgKElTX1JPQ0tFVExBS0UoaTkxNSkgfHwgSVNfVElHRVJMQUtFKGk5MTUpKQogCQl0Z2xf
Y3R4X3dvcmthcm91bmRzX2luaXQoZW5naW5lLCB3YWwpOwogCWVsc2UgaWYgKElTX0dFTihpOTE1
LCAxMikpCiAJCWdlbjEyX2N0eF93b3JrYXJvdW5kc19pbml0KGVuZ2luZSwgd2FsKTsKQEAgLTEy
NDQsMTAgKzEyNjAsMzYgQEAgdGdsX2d0X3dvcmthcm91bmRzX2luaXQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsIHN0cnVjdCBpOTE1X3dhX2xpc3QgKndhbCkKIAkJCSAgICBMM19DTEtH
QVRFX0RJUyB8IEwzX0NSMlhfQ0xLR0FURV9ESVMpOwogfQogCitzdGF0aWMgdm9pZAorZGcxX2d0
X3dvcmthcm91bmRzX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHN0cnVjdCBp
OTE1X3dhX2xpc3QgKndhbCkKK3sKKwlnZW4xMl9ndF93b3JrYXJvdW5kc19pbml0KGk5MTUsIHdh
bCk7CisKKwkvKiBXYV8xNjA3MDg3MDU2OmRnMSAqLworCWlmIChJU19ERzFfUkVWSUQoaTkxNSwg
REcxX1JFVklEX0EwLCBERzFfUkVWSURfQTApKQorCQl3YV93cml0ZV9vcih3YWwsCisJCQkgICAg
U0xJQ0VfVU5JVF9MRVZFTF9DTEtHQVRFLAorCQkJICAgIEwzX0NMS0dBVEVfRElTIHwgTDNfQ1Iy
WF9DTEtHQVRFX0RJUyk7CisKKwkvKiBXYV8xNDA5NDIwNjA0OmRnMSAqLworCWlmIChJU19ERzEo
aTkxNSkpCisJCXdhX3dyaXRlX29yKHdhbCwKKwkJCSAgICBTVUJTTElDRV9VTklUX0xFVkVMX0NM
S0dBVEUyLAorCQkJICAgIENQU1NVTklUX0NMS0dBVEVfRElTKTsKKworCS8qIFdhXzE0MDg2MTUw
NzI6ZGcxICovCisJLyogRW1waXJpY2FsIHRlc3Rpbmcgc2hvd3MgdGhpcyByZWdpc3RlciBpcyB1
bmFmZmVjdGVkIGJ5IGVuZ2luZSByZXNldC4gKi8KKwlpZiAoSVNfREcxKGk5MTUpKQorCQl3YV93
cml0ZV9vcih3YWwsIFVOU0xJQ0VfVU5JVF9MRVZFTF9DTEtHQVRFMiwKKwkJCSAgICBWU1VOSVRf
Q0xLR0FURV9ESVNfVEdMKTsKK30KKwogc3RhdGljIHZvaWQKIGd0X2luaXRfd29ya2Fyb3VuZHMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHN0cnVjdCBpOTE1X3dhX2xpc3QgKndhbCkK
IHsKLQlpZiAoSVNfVElHRVJMQUtFKGk5MTUpKQorCWlmIChJU19ERzEoaTkxNSkpCisJCWRnMV9n
dF93b3JrYXJvdW5kc19pbml0KGk5MTUsIHdhbCk7CisJZWxzZSBpZiAoSVNfVElHRVJMQUtFKGk5
MTUpKQogCQl0Z2xfZ3Rfd29ya2Fyb3VuZHNfaW5pdChpOTE1LCB3YWwpOwogCWVsc2UgaWYgKElT
X0dFTihpOTE1LCAxMikpCiAJCWdlbjEyX2d0X3dvcmthcm91bmRzX2luaXQoaTkxNSwgd2FsKTsK
QEAgLTE2MTIsNiArMTY1NCwyMCBAQCBzdGF0aWMgdm9pZCB0Z2xfd2hpdGVsaXN0X2J1aWxkKHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAl9CiB9CiAKK3N0YXRpYyB2b2lkIGRnMV93
aGl0ZWxpc3RfYnVpbGQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCXN0cnVj
dCBpOTE1X3dhX2xpc3QgKncgPSAmZW5naW5lLT53aGl0ZWxpc3Q7CisKKwl0Z2xfd2hpdGVsaXN0
X2J1aWxkKGVuZ2luZSk7CisKKwkvKiBHRU46QlVHOjE0MDkyODA0NDE6ZGcxICovCisJaWYgKElT
X0RHMV9SRVZJRChlbmdpbmUtPmk5MTUsIERHMV9SRVZJRF9BMCwgREcxX1JFVklEX0EwKSAmJgor
CSAgICAoZW5naW5lLT5jbGFzcyA9PSBSRU5ERVJfQ0xBU1MgfHwKKwkgICAgIGVuZ2luZS0+Y2xh
c3MgPT0gQ09QWV9FTkdJTkVfQ0xBU1MpKQorCQl3aGl0ZWxpc3RfcmVnX2V4dCh3LCBSSU5HX0lE
KGVuZ2luZS0+bW1pb19iYXNlKSwKKwkJCQkgIFJJTkdfRk9SQ0VfVE9fTk9OUFJJVl9BQ0NFU1Nf
UkQpOworfQorCiB2b2lkIGludGVsX2VuZ2luZV9pbml0X3doaXRlbGlzdChzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBl
bmdpbmUtPmk5MTU7CkBAIC0xNjE5LDcgKzE2NzUsOSBAQCB2b2lkIGludGVsX2VuZ2luZV9pbml0
X3doaXRlbGlzdChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAKIAl3YV9pbml0X3N0
YXJ0KHcsICJ3aGl0ZWxpc3QiLCBlbmdpbmUtPm5hbWUpOwogCi0JaWYgKElTX0dFTihpOTE1LCAx
MikpCisJaWYgKElTX0RHMShpOTE1KSkKKwkJZGcxX3doaXRlbGlzdF9idWlsZChlbmdpbmUpOwor
CWVsc2UgaWYgKElTX0dFTihpOTE1LCAxMikpCiAJCXRnbF93aGl0ZWxpc3RfYnVpbGQoZW5naW5l
KTsKIAllbHNlIGlmIChJU19HRU4oaTkxNSwgMTEpKQogCQlpY2xfd2hpdGVsaXN0X2J1aWxkKGVu
Z2luZSk7CkBAIC0xNjczLDE1ICsxNzMxLDE4IEBAIHJjc19lbmdpbmVfd2FfaW5pdChzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHN0cnVjdCBpOTE1X3dhX2xpc3QgKndhbCkKIHsKIAlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGVuZ2luZS0+aTkxNTsKIAotCWlmIChJU19U
R0xfVVlfR1RfUkVWSUQoaTkxNSwgVEdMX1JFVklEX0EwLCBUR0xfUkVWSURfQTApKSB7CisJaWYg
KElTX0RHMV9SRVZJRChpOTE1LCBERzFfUkVWSURfQTAsIERHMV9SRVZJRF9BMCkgfHwKKwkgICAg
SVNfVEdMX1VZX0dUX1JFVklEKGk5MTUsIFRHTF9SRVZJRF9BMCwgVEdMX1JFVklEX0EwKSkgewog
CQkvKgotCQkgKiBXYV8xNjA3MTM4MzM2OnRnbAotCQkgKiBXYV8xNjA3MDYzOTg4OnRnbAorCQkg
KiBXYV8xNjA3MTM4MzM2OnRnbFthMF0sZGcxW2EwXQorCQkgKiBXYV8xNjA3MDYzOTg4OnRnbFth
MF0sZGcxW2EwXQogCQkgKi8KIAkJd2Ffd3JpdGVfb3Iod2FsLAogCQkJICAgIEdFTjlfQ1RYX1BS
RUVNUFRfUkVHLAogCQkJICAgIEdFTjEyX0RJU0FCTEVfUE9TSF9CVVNZX0ZGX0RPUF9DRyk7CisJ
fQogCisJaWYgKElTX1RHTF9VWV9HVF9SRVZJRChpOTE1LCBUR0xfUkVWSURfQTAsIFRHTF9SRVZJ
RF9BMCkpIHsKIAkJLyoKIAkJICogV2FfMTYwNjY3OTEwMzp0Z2wKIAkJICogKHNlZSBhbHNvIFdh
XzE2MDY2ODIxNjY6aWNsKQpAQCAtMTY5NSwzNSArMTc1Niw0MSBAQCByY3NfZW5naW5lX3dhX2lu
aXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBzdHJ1Y3QgaTkxNV93YV9saXN0ICp3
YWwpCiAJCQkgICAgVlNVTklUX0NMS0dBVEVfRElTX1RHTCk7CiAJfQogCi0JaWYgKElTX1JPQ0tF
VExBS0UoaTkxNSkgfHwgSVNfVElHRVJMQUtFKGk5MTUpKSB7Ci0JCS8qIFdhXzE2MDY5MzE2MDE6
dGdsLHJrbCAqLworCWlmIChJU19ERzEoaTkxNSkgfHwgSVNfUk9DS0VUTEFLRShpOTE1KSB8fCBJ
U19USUdFUkxBS0UoaTkxNSkpIHsKKwkJLyogV2FfMTYwNjkzMTYwMTp0Z2wscmtsLGRnMSAqLwog
CQl3YV9tYXNrZWRfZW4od2FsLCBHRU43X1JPV19DSElDS0VOMiwgR0VOMTJfRElTQUJMRV9FQVJM
WV9SRUFEKTsKIAotCQkvKiBXYV8xNDA5ODA0ODA4OnRnbCxya2wgKi8KKwkJLyoKKwkJICogV2Ff
MTQwNzkyODk3OTp0Z2wgQSoKKwkJICogV2FfMTgwMTE0NjQxNjQ6dGdsW0IwK10sZGcxW0IwK10K
KwkJICogV2FfMjIwMTA5MzEyOTY6dGdsW0IwK10sZGcxW0IwK10KKwkJICogV2FfMTQwMTA5MTkx
Mzg6cmtsLCBkZzEKKwkJICovCisJCXdhX3dyaXRlX29yKHdhbCwgR0VON19GRl9USFJFQURfTU9E
RSwKKwkJCSAgICBHRU4xMl9GRl9URVNTRUxBVElPTl9ET1BfR0FURV9ESVNBQkxFKTsKKwl9CisK
KwlpZiAoSVNfREcxX1JFVklEKGk5MTUsIERHMV9SRVZJRF9BMCwgREcxX1JFVklEX0EwKSB8fAor
CSAgICBJU19ST0NLRVRMQUtFKGk5MTUpIHx8IElTX1RJR0VSTEFLRShpOTE1KSkgeworCQkvKiBX
YV8xNDA5ODA0ODA4OnRnbCxya2wsZGcxW2EwXSAqLwogCQl3YV9tYXNrZWRfZW4od2FsLCBHRU43
X1JPV19DSElDS0VOMiwKIAkJCSAgICAgR0VOMTJfUFVTSF9DT05TVF9ERVJFRl9IT0xEX0RJUyk7
CiAKIAkJLyoKIAkJICogV2FfMTQwOTA4NTIyNTp0Z2wKLQkJICogV2FfMTQwMTAyMjkyMDY6dGds
LHJrbAorCQkgKiBXYV8xNDAxMDIyOTIwNjp0Z2wscmtsLGRnMVthMF0KIAkJICovCiAJCXdhX21h
c2tlZF9lbih3YWwsIEdFTjlfUk9XX0NISUNLRU40LCBHRU4xMl9ESVNBQkxFX1RETF9QVVNIKTsK
IAotCQkvKgotCQkgKiBXYV8xNDA3OTI4OTc5OnRnbCBBKgotCQkgKiBXYV8xODAxMTQ2NDE2NDp0
Z2wgQjArCi0JCSAqIFdhXzIyMDEwOTMxMjk2OnRnbCBCMCsKLQkJICogV2FfMTQwMTA5MTkxMzg6
cmtsLHRnbAotCQkgKi8KLQkJd2Ffd3JpdGVfb3Iod2FsLCBHRU43X0ZGX1RIUkVBRF9NT0RFLAot
CQkJICAgIEdFTjEyX0ZGX1RFU1NFTEFUSU9OX0RPUF9HQVRFX0RJU0FCTEUpOwotCiAJCS8qCiAJ
CSAqIFdhXzE2MDcwMzAzMTc6dGdsCiAJCSAqIFdhXzE2MDcxODY1MDA6dGdsCi0JCSAqIFdhXzE2
MDcyOTc2Mjc6dGdsLHJrbCB0aGVyZSBhcmUgbXVsdGlwbGUgZW50cmllcyBmb3IgdGhpcwotCQkg
KiBXQSBpbiB0aGUgQlNwZWM7IHNvbWUgaW5kaWNhdGUgdGhpcyBpcyBhbiBBMC1vbmx5IFdBLAot
CQkgKiBvdGhlcnMgaW5kaWNhdGUgaXQgYXBwbGllcyB0byBhbGwgc3RlcHBpbmdzLgorCQkgKiBX
YV8xNjA3Mjk3NjI3OnRnbCxya2wsZGcxW2EwXQorCQkgKgorCQkgKiBPbiBUR0wgYW5kIFJLTCB0
aGVyZSBhcmUgbXVsdGlwbGUgZW50cmllcyBmb3IgdGhpcyBXQSBpbiB0aGUKKwkJICogQlNwZWM7
IHNvbWUgaW5kaWNhdGUgdGhpcyBpcyBhbiBBMC1vbmx5IFdBLCBvdGhlcnMgaW5kaWNhdGUKKwkJ
ICogaXQgYXBwbGllcyB0byBhbGwgc3RlcHBpbmdzIHNvIHdlIHRydXN0IHRoZSAiYWxsIHN0ZXBw
aW5ncy4iCisJCSAqIEZvciBERzEgdGhpcyBvbmx5IGFwcGxpZXMgdG8gQTAuCiAJCSAqLwogCQl3
YV9tYXNrZWRfZW4od2FsLAogCQkJICAgICBHRU42X1JDX1NMRUVQX1BTTUlfQ09OVFJPTCwKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGNpLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3BjaS5jCmluZGV4IDM2NmRkZmM4ZGY2Yi4uYzJkZmRmNTI0MTliIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BjaS5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfcGNpLmMKQEAgLTkxMCw2ICs5MTAsOCBAQCBzdGF0aWMgY29uc3Qgc3Ry
dWN0IGludGVsX2RldmljZV9pbmZvIGRnMV9pbmZvIF9fbWF5YmVfdW51c2VkID0gewogCS5wbGF0
Zm9ybV9lbmdpbmVfbWFzayA9CiAJCUJJVChSQ1MwKSB8IEJJVChCQ1MwKSB8IEJJVChWRUNTMCkg
fAogCQlCSVQoVkNTMCkgfCBCSVQoVkNTMiksCisJLyogV2FfMTYwMTEyMjc5MjIgKi8KKwkucHBn
dHRfc2l6ZSA9IDQ3LAogfTsKIAogI3VuZGVmIEdFTgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9yZWcuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVnLmgKaW5k
ZXggZTRjNDcxMzNjMWE5Li5iYjUwOTRiODBmMTUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfcmVnLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZWcuaApA
QCAtMjUzMCw2ICsyNTMwLDcgQEAgc3RhdGljIGlubGluZSBib29sIGk5MTVfbW1pb19yZWdfdmFs
aWQoaTkxNV9yZWdfdCByZWcpCiAjZGVmaW5lIFJJTkdfUFNNSV9DVEwoYmFzZSkJX01NSU8oKGJh
c2UpICsgMHg1MCkKICNkZWZpbmUgUklOR19NQVhfSURMRShiYXNlKQlfTU1JTygoYmFzZSkgKyAw
eDU0KQogI2RlZmluZSBSSU5HX0hXU19QR0EoYmFzZSkJX01NSU8oKGJhc2UpICsgMHg4MCkKKyNk
ZWZpbmUgUklOR19JRChiYXNlKQkJX01NSU8oKGJhc2UpICsgMHg4YykKICNkZWZpbmUgUklOR19I
V1NfUEdBX0dFTjYoYmFzZSkJX01NSU8oKGJhc2UpICsgMHgyMDgwKQogI2RlZmluZSBSSU5HX1JF
U0VUX0NUTChiYXNlKQlfTU1JTygoYmFzZSkgKyAweGQwKQogI2RlZmluZSAgIFJFU0VUX0NUTF9D
QVRfRVJST1IJICAgUkVHX0JJVCgyKQpAQCAtNDE0OSw2ICs0MTUwLDcgQEAgZW51bSB7CiAKICNk
ZWZpbmUgR0VOOV9DTEtHQVRFX0RJU18zCQlfTU1JTygweDQ2NTM4KQogI2RlZmluZSAgIFRHTF9W
UkhfR0FUSU5HX0RJUwkJUkVHX0JJVCgzMSkKKyNkZWZpbmUgICBEUFRfR0FUSU5HX0RJUwkJUkVH
X0JJVCgyMikKIAogI2RlZmluZSBHRU45X0NMS0dBVEVfRElTXzQJCV9NTUlPKDB4NDY1M0MpCiAj
ZGVmaW5lICAgQlhUX0dNQlVTX0dBVElOR19ESVMJCSgxIDw8IDE0KQpAQCAtODAxOCwxMiArODAy
MCwxNCBAQCBlbnVtIHsKICNkZWZpbmUgR0VOOF9MM0NOVExSRUcJX01NSU8oMHg3MDM0KQogICAj
ZGVmaW5lIEdFTjhfRVJSREVUQkNUUkwgKDEgPDwgOSkKIAotI2RlZmluZSBHRU4xMV9DT01NT05f
U0xJQ0VfQ0hJQ0tFTjMJCV9NTUlPKDB4NzMwNCkKLSAgI2RlZmluZSBHRU4xMV9CTEVORF9FTUJf
RklYX0RJU0FCTEVfSU5fUkNDCSgxIDw8IDExKQotICAjZGVmaW5lIEdFTjEyX0RJU0FCTEVfQ1BT
X0FXQVJFX0NPTE9SX1BJUEUJKDEgPDwgOSkKKyNkZWZpbmUgR0VOMTFfQ09NTU9OX1NMSUNFX0NI
SUNLRU4zCQkJX01NSU8oMHg3MzA0KQorICAjZGVmaW5lIERHMV9GTE9BVF9QT0lOVF9CTEVORF9P
UFRfU1RSSUNUX01PREVfRU4JUkVHX0JJVCgxMikKKyAgI2RlZmluZSBHRU4xMV9CTEVORF9FTUJf
RklYX0RJU0FCTEVfSU5fUkNDCQlSRUdfQklUKDExKQorICAjZGVmaW5lIEdFTjEyX0RJU0FCTEVf
Q1BTX0FXQVJFX0NPTE9SX1BJUEUJCVJFR19CSVQoOSkKIAogI2RlZmluZSBISVpfQ0hJQ0tFTgkJ
CQkJX01NSU8oMHg3MDE4KQogIyBkZWZpbmUgQ0hWX0haXzhYOF9NT0RFX0lOXzFYCQkJCSgxIDw8
IDE1KQorIyBkZWZpbmUgREcxX0haX1JFQURfU1VQUFJFU1NJT05fT1BUSU1JWkFUSU9OX0RJU0FC
TEUgICAoMSA8PCAxNCkKICMgZGVmaW5lIEJEV19ISVpfUE9XRVJfQ09NUElMRVJfQ0xPQ0tfR0FU
SU5HX0RJU0FCTEUJKDEgPDwgMykKIAogI2RlZmluZSBHRU45X1NMSUNFX0NPTU1PTl9FQ09fQ0hJ
Q0tFTjAJCV9NTUlPKDB4NzMwOCkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5jCmluZGV4IDhjZDYyNDAy
ZDU5Ny4uYWU2YjM2N2U2M2NiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9wbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMKQEAgLTcxMTYsMjUg
KzcxMTYsMjYgQEAgc3RhdGljIHZvaWQgaWNsX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAkJCSAwLCBDTkxfREVMQVlfUE1SU1ApOwogfQogCi1z
dGF0aWMgdm9pZCB0Z2xfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQorc3RhdGljIHZvaWQgZ2VuMTJfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7Ci0JdTMyIHZkX3BnX2VuYWJsZSA9IDA7CiAJdW5zaWdu
ZWQgaW50IGk7CiAKKwkvKiBUaGlzIGlzIG5vdCBhIFdBLiBFbmFibGUgVkQgSENQICYgTUZYX0VO
QyBwb3dlcmdhdGUgKi8KKwlmb3IgKGkgPSAwOyBpIDwgSTkxNV9NQVhfVkNTOyBpKyspCisJCWlm
IChIQVNfRU5HSU5FKCZpOTE1LT5ndCwgX1ZDUyhpKSkpCisJCQlpbnRlbF91bmNvcmVfcm13KCZp
OTE1LT51bmNvcmUsIFBPV0VSR0FURV9FTkFCTEUsIDAsCisJCQkJCSBWRE5fSENQX1BPV0VSR0FU
RV9FTkFCTEUoaSkgfAorCQkJCQkgVkROX01GWF9QT1dFUkdBVEVfRU5BQkxFKGkpKTsKK30KKwor
c3RhdGljIHZvaWQgdGdsX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKK3sKKwlnZW4xMl9pbml0X2Nsb2NrX2dhdGluZyhkZXZfcHJpdik7CisKIAkv
KiBXYV8xNDA5MTIwMDEzOnRnbCAqLwogCUk5MTVfV1JJVEUoSUxLX0RQRkNfQ0hJQ0tFTiwKIAkJ
ICAgSUxLX0RQRkNfQ0hJQ0tFTl9DT01QX0RVTU1ZX1BJWEVMKTsKIAotCS8qIFRoaXMgaXMgbm90
IGEgV0EuIEVuYWJsZSBWRCBIQ1AgJiBNRlhfRU5DIHBvd2VyZ2F0ZSAqLwotCWZvciAoaSA9IDA7
IGkgPCBJOTE1X01BWF9WQ1M7IGkrKykgewotCQlpZiAoSEFTX0VOR0lORSgmZGV2X3ByaXYtPmd0
LCBfVkNTKGkpKSkKLQkJCXZkX3BnX2VuYWJsZSB8PSBWRE5fSENQX1BPV0VSR0FURV9FTkFCTEUo
aSkgfAotCQkJCQlWRE5fTUZYX1BPV0VSR0FURV9FTkFCTEUoaSk7Ci0JfQotCi0JSTkxNV9XUklU
RShQT1dFUkdBVEVfRU5BQkxFLAotCQkgICBJOTE1X1JFQUQoUE9XRVJHQVRFX0VOQUJMRSkgfCB2
ZF9wZ19lbmFibGUpOwotCiAJLyogV2FfMTQwOTgyNTM3Njp0Z2wgKHByZS1wcm9kKSovCiAJaWYg
KElTX1RHTF9ESVNQX1JFVklEKGRldl9wcml2LCBUR0xfUkVWSURfQTAsIFRHTF9SRVZJRF9CMSkp
CiAJCUk5MTVfV1JJVEUoR0VOOV9DTEtHQVRFX0RJU18zLCBJOTE1X1JFQUQoR0VOOV9DTEtHQVRF
X0RJU18zKSB8CkBAIC03MTQ1LDYgKzcxNDYsMTYgQEAgc3RhdGljIHZvaWQgdGdsX2luaXRfY2xv
Y2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAkJCSAwLCBERlJf
RElTQUJMRSk7CiB9CiAKK3N0YXRpYyB2b2lkIGRnMV9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCit7CisJZ2VuMTJfaW5pdF9jbG9ja19nYXRpbmco
ZGV2X3ByaXYpOworCisJLyogV2FfMTQwOTgzNjY4NjpkZzFbYTBdICovCisJaWYgKElTX0RHMV9S
RVZJRChkZXZfcHJpdiwgREcxX1JFVklEX0EwLCBERzFfUkVWSURfQTApKQorCQlJOTE1X1dSSVRF
KEdFTjlfQ0xLR0FURV9ESVNfMywgSTkxNV9SRUFEKEdFTjlfQ0xLR0FURV9ESVNfMykgfAorCQkJ
ICAgRFBUX0dBVElOR19ESVMpOworfQorCiBzdGF0aWMgdm9pZCBjbnBfaW5pdF9jbG9ja19nYXRp
bmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewogCWlmICghSEFTX1BDSF9D
TlAoZGV2X3ByaXYpKQpAQCAtNzU5MCw3ICs3NjAxLDkgQEAgc3RhdGljIHZvaWQgbm9wX2luaXRf
Y2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKICAqLwogdm9p
ZCBpbnRlbF9pbml0X2Nsb2NrX2dhdGluZ19ob29rcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCiB7Ci0JaWYgKElTX0dFTihkZXZfcHJpdiwgMTIpKQorCWlmIChJU19ERzEoZGV2
X3ByaXYpKQorCQlkZXZfcHJpdi0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGRnMV9pbml0
X2Nsb2NrX2dhdGluZzsKKwllbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDEyKSkKIAkJZGV2X3By
aXYtPmRpc3BsYXkuaW5pdF9jbG9ja19nYXRpbmcgPSB0Z2xfaW5pdF9jbG9ja19nYXRpbmc7CiAJ
ZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCAxMSkpCiAJCWRldl9wcml2LT5kaXNwbGF5LmluaXRf
Y2xvY2tfZ2F0aW5nID0gaWNsX2luaXRfY2xvY2tfZ2F0aW5nOwotLSAKMi4yOC4wCgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGlu
ZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVl
ZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZngK

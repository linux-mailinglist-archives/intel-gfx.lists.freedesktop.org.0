Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 4354BB55C4
	for <lists+intel-gfx@lfdr.de>; Tue, 17 Sep 2019 20:56:42 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 83B266E316;
	Tue, 17 Sep 2019 18:56:40 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7C0176E2F0
 for <intel-gfx@lists.freedesktop.org>; Tue, 17 Sep 2019 18:56:38 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 18523932-1500050 for multiple; Tue, 17 Sep 2019 19:56:34 +0100
MIME-Version: 1.0
From: Chris Wilson <chris@chris-wilson.co.uk>
User-Agent: alot/0.6
To: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>,
 intel-gfx@lists.freedesktop.org
References: <20190902040303.14195-1-chris@chris-wilson.co.uk>
 <20190902040303.14195-13-chris@chris-wilson.co.uk>
 <d65c569b-6a91-cf77-782a-6a134be6564d@linux.intel.com>
In-Reply-To: <d65c569b-6a91-cf77-782a-6a134be6564d@linux.intel.com>
Message-ID: <156874659243.5729.22780974956498892@skylake-alporthouse-com>
Date: Tue, 17 Sep 2019 19:56:32 +0100
Subject: Re: [Intel-gfx] [PATCH 13/21] drm/i915: Pull i915_vma_pin under the
 vm->mutex
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVvdGluZyBUdnJ0a28gVXJzdWxpbiAoMjAxOS0wOS0xNyAxMzozNzo1NSkKPiBPbiAwMi8wOS8y
MDE5IDA1OjAyLCBDaHJpcyBXaWxzb24gd3JvdGU6Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21tYW4uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9tbWFuLmMKPiA+IGluZGV4IDgyZGIyYjc4MzEyMy4uOWE4YzMwN2M1YWViIDEw
MDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21tYW4uYwo+
ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21tYW4uYwo+ID4gQEAg
LTI1MSwxNiArMjUxLDYgQEAgdm1fZmF1bHRfdCBpOTE1X2dlbV9mYXVsdChzdHJ1Y3Qgdm1fZmF1
bHQgKnZtZikKPiA+ICAgICAgICAgICAgICAgZ290byBlcnJfcnBtOwo+ID4gICAgICAgfQo+ID4g
ICAKPiA+IC0gICAgIHJldCA9IGk5MTVfbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKGRldik7Cj4g
PiAtICAgICBpZiAocmV0KQo+ID4gLSAgICAgICAgICAgICBnb3RvIGVycl9yZXNldDsKPiA+IC0K
PiA+IC0gICAgIC8qIEFjY2VzcyB0byBzbm9vcGFibGUgcGFnZXMgdGhyb3VnaCB0aGUgR1RUIGlz
IGluY29oZXJlbnQuICovCj4gPiAtICAgICBpZiAob2JqLT5jYWNoZV9sZXZlbCAhPSBJOTE1X0NB
Q0hFX05PTkUgJiYgIUhBU19MTEMoaTkxNSkpIHsKPiA+IC0gICAgICAgICAgICAgcmV0ID0gLUVG
QVVMVDsKPiA+IC0gICAgICAgICAgICAgZ290byBlcnJfdW5sb2NrOwo+ID4gLSAgICAgfQo+ID4g
LQo+ID4gICAgICAgLyogTm93IHBpbiBpdCBpbnRvIHRoZSBHVFQgYXMgbmVlZGVkICovCj4gPiAg
ICAgICB2bWEgPSBpOTE1X2dlbV9vYmplY3RfZ2d0dF9waW4ob2JqLCBOVUxMLCAwLCAwLAo+ID4g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBJTl9NQVBQQUJMRSB8Cj4gPiBA
QCAtMjkzLDcgKzI4MywxMyBAQCB2bV9mYXVsdF90IGk5MTVfZ2VtX2ZhdWx0KHN0cnVjdCB2bV9m
YXVsdCAqdm1mKQo+ID4gICAgICAgfQo+ID4gICAgICAgaWYgKElTX0VSUih2bWEpKSB7Cj4gPiAg
ICAgICAgICAgICAgIHJldCA9IFBUUl9FUlIodm1hKTsKPiA+IC0gICAgICAgICAgICAgZ290byBl
cnJfdW5sb2NrOwo+ID4gKyAgICAgICAgICAgICBnb3RvIGVycl9yZXNldDsKPiA+ICsgICAgIH0K
PiA+ICsKPiA+ICsgICAgIC8qIEFjY2VzcyB0byBzbm9vcGFibGUgcGFnZXMgdGhyb3VnaCB0aGUg
R1RUIGlzIGluY29oZXJlbnQuICovCj4gPiArICAgICBpZiAob2JqLT5jYWNoZV9sZXZlbCAhPSBJ
OTE1X0NBQ0hFX05PTkUgJiYgIUhBU19MTEMoaTkxNSkpIHsKPiA+ICsgICAgICAgICAgICAgcmV0
ID0gLUVGQVVMVDsKPiA+ICsgICAgICAgICAgICAgZ290byBlcnJfdW5waW47Cj4gPiAgICAgICB9
Cj4gCj4gV2h5IGhhdmUgeW91IG1vdmVkIHRoaXMgY2hlY2sgdG8gYWZ0ZXIgcGlubmluZz8KClNp
bmNlIHdlJ3ZlIGRyb3BwZWQgdGhlIGxvY2sgYXJvdW5kIHRoaXMgY2hlY2ssIHRoZSBpbnRlbnQg
aXMgdG8gdXNlIHRoZQpwaW4gYXMgYSBndWFyYW50ZWUgdGhhdCB0aGUgdm1hIGNhbm5vdCBiZSBj
aGFuZ2VkLiBXaGF0IHdlIGFjdHVhbGx5IHdhbnQKaGVyZSwgZm9yIGNsYXJpdHksIGlzIHZtYS0+
Y2FjaGVfbGV2ZWwuCgo+ID4gICAKPiA+ICAgICAgIHJldCA9IGk5MTVfdm1hX3Bpbl9mZW5jZSh2
bWEpOwo+ID4gQEAgLTMyMSwxNCArMzE3LDEyIEBAIHZtX2ZhdWx0X3QgaTkxNV9nZW1fZmF1bHQo
c3RydWN0IHZtX2ZhdWx0ICp2bWYpCj4gPiAgICAgICAgICAgICAgIGludGVsX3dha2VyZWZfYXV0
bygmaTkxNS0+Z2d0dC51c2VyZmF1bHRfd2FrZXJlZiwKPiA+ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIG1zZWNzX3RvX2ppZmZpZXNfdGltZW91dChDT05GSUdfRFJNX0k5MTVfVVNF
UkZBVUxUX0FVVE9TVVNQRU5EKSk7Cj4gPiAgIAo+ID4gLSAgICAgaTkxNV92bWFfc2V0X2dndHRf
d3JpdGUodm1hKTsKPiA+IC0KPiA+ICsgICAgIGlmICh3cml0ZSkKPiA+ICsgICAgICAgICAgICAg
aTkxNV92bWFfc2V0X2dndHRfd3JpdGUodm1hKTsKPiAKPiBOb2lzZSBmb3Igd2hhdCB0aGlzIHBh
dGNoIGlzIGNvbmNlcm5lZD8KClllYWgsIEkgaGFkIHRvIHN0YXJlIGF0IGFuIGluY29ycmVjdCBf
X3NldF9iaXQoR0dUVF9XUklURSkgZm9yIHRvbyBsb25nLgoKPiAKPiA+ICAgZXJyX2ZlbmNlOgo+
ID4gICAgICAgaTkxNV92bWFfdW5waW5fZmVuY2Uodm1hKTsKPiA+ICAgZXJyX3VucGluOgo+ID4g
ICAgICAgX19pOTE1X3ZtYV91bnBpbih2bWEpOwo+ID4gLWVycl91bmxvY2s6Cj4gPiAtICAgICBt
dXRleF91bmxvY2soJmRldi0+c3RydWN0X211dGV4KTsKPiA+ICAgZXJyX3Jlc2V0Ogo+ID4gICAg
ICAgaW50ZWxfZ3RfcmVzZXRfdW5sb2NrKGdndHQtPnZtLmd0LCBzcmN1KTsKPiA+ICAgZXJyX3Jw
bToKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2Jq
ZWN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMKPiA+IGlu
ZGV4IDBlZjYwZGFlMjNhNy4uZGJmOWJlOWE3OWY0IDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMKPiA+IEBAIC0xNTUsMjEgKzE1NSwzMCBAQCBz
dGF0aWMgdm9pZCBfX2k5MTVfZ2VtX2ZyZWVfb2JqZWN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwKPiA+ICAgCj4gPiAgICAgICB3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQo
Jmk5MTUtPnJ1bnRpbWVfcG0pOwo+ID4gICAgICAgbGxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShv
YmosIG9uLCBmcmVlZCwgZnJlZWQpIHsKPiA+IC0gICAgICAgICAgICAgc3RydWN0IGk5MTVfdm1h
ICp2bWEsICp2bjsKPiA+IC0KPiA+ICAgICAgICAgICAgICAgdHJhY2VfaTkxNV9nZW1fb2JqZWN0
X2Rlc3Ryb3kob2JqKTsKPiA+ICAgCj4gPiAtICAgICAgICAgICAgIG11dGV4X2xvY2soJmk5MTUt
PmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gLQo+ID4gLSAgICAgICAgICAgICBsaXN0X2Zvcl9lYWNo
X2VudHJ5X3NhZmUodm1hLCB2biwgJm9iai0+dm1hLmxpc3QsIG9ial9saW5rKSB7Cj4gPiAtICAg
ICAgICAgICAgICAgICAgICAgR0VNX0JVR19PTihpOTE1X3ZtYV9pc19hY3RpdmUodm1hKSk7Cj4g
PiAtICAgICAgICAgICAgICAgICAgICAgYXRvbWljX2FuZCh+STkxNV9WTUFfUElOX01BU0ssICZ2
bWEtPmZsYWdzKTsKPiA+IC0gICAgICAgICAgICAgICAgICAgICBpOTE1X3ZtYV9kZXN0cm95KHZt
YSk7Cj4gPiArICAgICAgICAgICAgIGlmICghbGlzdF9lbXB0eSgmb2JqLT52bWEubGlzdCkpIHsK
PiA+ICsgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKPiA+ICsKPiA+
ICsgICAgICAgICAgICAgICAgICAgICAvKgo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAqIE5v
dGUgdGhhdCB0aGUgdm1hIGtlZXBzIGFuIG9iamVjdCByZWZlcmVuY2Ugd2hpbGUKPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgKiBpdCBpcyBhY3RpdmUsIHNvIGl0ICpzaG91bGQqIG5vdCBzbGVl
cCB3aGlsZSB3ZQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAqIGRlc3Ryb3kgaXQuIE91ciBk
ZWJ1ZyBjb2RlIGVycnMgaW5zaXRzIGl0ICptaWdodCouCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgICogRm9yIHRoZSBtb21lbnQsIHBsYXkgYWxvbmcuCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgICovCj4gPiArICAgICAgICAgICAgICAgICAgICAgc3Bpbl9sb2NrKCZvYmotPnZtYS5sb2Nr
KTsKPiA+ICsgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoKHZtYSA9IGxpc3RfZmlyc3RfZW50
cnlfb3JfbnVsbCgmb2JqLT52bWEubGlzdCwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgaTkxNV92bWEsCj4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgb2JqX2xpbmspKSkgCj4gCj4gV2hhdCBpcyB0aGUgcG9pbnQgb2YgaGF2aW5nIGEgd2hpbGUg
bG9vcCBpbnNpZGUgdG9wLWxldmVsIGlmICFsaXN0X2VtcHR5IAo+IGNoZWNrPyBMb29rcyB0aGVv
cmV0aWNhbGx5IHJhY3ksIGFuZCBldmVuIGlmIHRoYXQgaXMgaXJyZWxldmFudCwgaXQgCj4gd291
bGQgYmUgY2xlYXJlciB0byBqdXN0IGRvIHRoZSB3aGlsZSBsb29wLgoKV2UgY2FuJ3QgYWRkIG1v
cmUgdm1hIHRvIHRoZSBvYmplY3QsIGFzIHRoZXJlIGFyZSBubyBtb3JlIHJlZnMgdG8gdGhlCm9i
amVjdC4gVGhlIGNoYWxsZW5nZSBpcyBpbiBkcm9wcGluZyB0aGUgbGlua3MuIEluIHRoZSBlbmQg
aXQgbWFrZXMgbm8KZGlmZmVyZW5jZSwgaXQncyBhbiB1bmxvY2tlZCBjb21wYXJlIGJlZm9yZSB0
aGUgc3BpbmxvY2sgKGFuZCB1Z2x5Cmxvb3ApLgoKPiA+ICAgICAgIEdFTV9CVUdfT04oIWRybV9t
bV9ub2RlX2FsbG9jYXRlZCgmdm1hLT5ub2RlKSk7Cj4gPiAgIAo+ID4gKyAgICAgR0VNX0JVR19P
Tih2bWEtPnBhZ2VzKTsKPiA+ICAgICAgIHZtYS0+cGFnZXMgPSBvYmotPm1tLnBhZ2VzOwo+ID4g
KyAgICAgYXRvbWljX3NldCgmdm1hLT5wYWdlc19jb3VudCwgSTkxNV9WTUFfUEFHRVNfQUNUSVZF
KTsKPiAKPiBXaGF0IGlzIEk5MTVfVk1BX1BBR0VTX0FDVElWRSB1c2VkIGZvcj8gUGlubmVkPyBI
YXMgcGFnZXM/CgpJdCdzIGEgY291bnRlciBmb3IgdGhlIG51bWJlciBvZiB1bmlxdWUgYmluZHMg
YXMgb3Bwb3NlZCB0byBjYWxsZXJzCm1lcmVseSBhY3F1aXJpbmcgdGhlIHBhZ2VzIHByaW9yIHRv
IGJpbmRpbmc7IHNvIHRoYXQgd2UgY2FuIGJhbGFuY2UKdm1hX3VuYmluZF9wYWdlcygpIHdoaWNo
IGlzIGNhbGxlZCBvbmNlIChpOTE1X3ZtYV91bmJpbmQpIGJ1dAppOTE1X3ZtYV9iaW5kKCkgY2Fu
IGJlIGNhbGxlZCBmb3IgYm90aCBQSU5fR0xPQkFMIGFuZCBQSU5fVVNFUi4KCj4gPiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3RpbGluZy5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3RpbGluZy5jCj4gPiBpbmRleCBjYTBjMmY0NTE3
NDIuLmI5Y2ZhZTBlNDQzNSAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV90aWxpbmcuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5
MTVfZ2VtX3RpbGluZy5jCj4gPiBAQCAtMTgxLDIyICsxODEsMjUgQEAgc3RhdGljIGludAo+ID4g
ICBpOTE1X2dlbV9vYmplY3RfZmVuY2VfcHJlcGFyZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVj
dCAqb2JqLAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCB0aWxpbmdfbW9kZSwg
dW5zaWduZWQgaW50IHN0cmlkZSkKPiA+ICAgewo+ID4gKyAgICAgc3RydWN0IGk5MTVfZ2d0dCAq
Z2d0dCA9ICZ0b19pOTE1KG9iai0+YmFzZS5kZXYpLT5nZ3R0Owo+ID4gICAgICAgc3RydWN0IGk5
MTVfdm1hICp2bWE7Cj4gPiAtICAgICBpbnQgcmV0Owo+ID4gKyAgICAgaW50IHJldCA9IDA7Cj4g
PiAgIAo+ID4gICAgICAgaWYgKHRpbGluZ19tb2RlID09IEk5MTVfVElMSU5HX05PTkUpCj4gPiAg
ICAgICAgICAgICAgIHJldHVybiAwOwo+ID4gICAKPiA+ICsgICAgIG11dGV4X2xvY2soJmdndHQt
PnZtLm11dGV4KTsKPiA+ICAgICAgIGZvcl9lYWNoX2dndHRfdm1hKHZtYSwgb2JqKSB7Cj4gPiAg
ICAgICAgICAgICAgIGlmIChpOTE1X3ZtYV9mZW5jZV9wcmVwYXJlKHZtYSwgdGlsaW5nX21vZGUs
IHN0cmlkZSkpCj4gPiAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7Cj4gCj4gdm1hX2Zl
bmNlX3ByZXBhcmUgZG9lc24ndCBuZWVkIHRvIGJlIHVuZGVyIG11dGV4LCBidXQgaXQncyBtdWNo
IGVhc2llciAKPiBmb3IgdGhpcyBsb29wLCB5ZXM/CgpmZW5jZV9wcmVwYXJlIGlzIGp1c3QgYSBz
aW1wbGUgcHJlZGljYXRlLCBzbyBuby4gV2hhdCB3ZSBkbyBuZWVkIHRob3VnaAppcyB0byBwdWxs
IGl0IHVuZGVyIHRoZSBvYmplY3QtbG9jayBzbyB0aGF0IHdlIGRvbid0IHByZXBhcmUgZm9yIG9u
ZQp0aWxpbmcgYW5kIGJpbmQgYW5vdGhlci4gSG1tLgoKPiA+IEBAIC0zMzMsNyArMzQ0LDExIEBA
IHN0YXRpYyBpbnQgaWd0X2NoZWNrX3BhZ2Vfc2l6ZXMoc3RydWN0IGk5MTVfdm1hICp2bWEpCj4g
PiAgICAgICBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHZtYS0+dm0tPmk5MTU7Cj4g
PiAgICAgICB1bnNpZ25lZCBpbnQgc3VwcG9ydGVkID0gSU5URUxfSU5GTyhpOTE1KS0+cGFnZV9z
aXplczsKPiA+ICAgICAgIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPSB2bWEtPm9i
ajsKPiA+IC0gICAgIGludCBlcnIgPSAwOwo+ID4gKyAgICAgaW50IGVycjsKPiA+ICsKPiA+ICsg
ICAgIGVyciA9IGk5MTVfYWN0aXZlX3dhaXQoJnZtYS0+YWN0aXZlKTsKPiA+ICsgICAgIGlmIChl
cnIpCj4gPiArICAgICAgICAgICAgIHJldHVybiBlcnI7Cj4gCj4gVG91Y2hlZCB1cG9uIHRoaXMg
aW4gdGhlIHByZXZpb3VzIGVtYWlsLCBidXQgSSB0aGluayB3ZSBuZWVkIHRvIHB1dCBzb21lIAo+
IGNsZWFyIG5vdGVzIGluIHdyaXRpbmcsIGluIHNvbWUgZ29vZCBwbGFjZSwgcmVnYXJkaW5nIHdo
ZW4gY2FsbGVycyBuZWVkIAo+IHRvIGV4cGxpY2l0bHkgZG8gdGhpcyBhbmQgd2hlbiBub3QuIERv
bid0IGtub3cgd2hlcmUgdGhvdWdoLi4gY29tbWl0IAo+IG1lc3NhZ2UgaXMgd2Vhay4gTWF5YmUg
a2VybmVsIGRvYyBuZXh0IHRvIGk5MTVfdm1hX3VuYmluZD8KClRoZSBjb3VwbGUgb2YgcGxhY2Vz
IHRoYXQgY2FyZSBhcmUgdGhlIGV4Y2VwdGlvbi4gVGhvdWdoIEknbQpjb250ZW1wbGF0aW5nIHVz
aW5nIHRoZSBhc3luYyBiaW5kIHRvIGNpcmN1bXZlbnQgdGhlIHN0b3BfbWFjaGluZSgpLi4uCgo+
ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9n
ZW1fY29udGV4dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dl
bV9jb250ZXh0LmMKPiA+IGluZGV4IGRhNTRhNzE4YzcxMi4uYWE2N2MwMmJhOThjIDEwMDY0NAo+
ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250
ZXh0LmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9n
ZW1fY29udGV4dC5jCj4gPiBAQCAtNzQ3LDEwICs3NDcsNyBAQCBlbWl0X3JwY3NfcXVlcnkoc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKPiA+ICAgICAgIGlmIChlcnIpCj4gPiAgICAg
ICAgICAgICAgIGdvdG8gc2tpcF9yZXF1ZXN0Owo+ID4gICAKPiA+IC0gICAgIGk5MTVfdm1hX3Vu
cGluKGJhdGNoKTsKPiA+IC0gICAgIGk5MTVfdm1hX2Nsb3NlKGJhdGNoKTsKPiA+IC0gICAgIGk5
MTVfdm1hX3B1dChiYXRjaCk7Cj4gPiAtCj4gPiArICAgICBpOTE1X3ZtYV91bnBpbl9hbmRfcmVs
ZWFzZSgmYmF0Y2gsIDApOwo+IAo+IElzIHRoaXMgY29uc29saWRhdGlvbiBlbmFibGVkIGJ5IHRo
aXMgcGF0Y2ggb3Igd2FzIG90aGVyd2lzZSBwb3NzaWJsZT8gCgpBdCB0aGlzIHBvaW50LCBpdCBp
cyBkZWR1cGxpY2F0aW9uLiBXaGF0IHByb21wdGVkIHRoZSBjaGFuZ2Ugd2VyZSBhIGZldwpjYWxs
ZXJzIG1peGVkIHVwIHRoZSBwb3RlbnRpYWwgdXNlIGFmdGVyIGZyZWUgb2Ygdm1hLT5vYmouCgo+
IFNvbWV0aGluZyByaW5ncyBmYW1pbGlhciBhYm91dCBzb21lIHByb2JsZW0gd2l0aCAKPiBpOTE1
X3ZtYV91bnBpbl9hbmRfcmVsZWFzZSBidXQgSSBjYW4ndCByZW1lbWJlciB3aGF0Li4gU2VtYW50
aWNzIGFyZSBhIAo+IGJpdCB3ZWlyZCB0aG91Z2guLiB3aGVyZWFzIHBhdHRlcm4gYmVmb3JlIHdh
cyB0byBpOTE1X3ZtYV9wdXQgYWZ0ZXIgCj4gaW5zdGFudGlhdGluZyBhIHZtYSwgbm93IGl0IGlz
IHVucGluX2FuZF9yZWxlYXNlLi4gcmVsZWFzZSBiZWluZyBhIGJpdCAKPiBvZiBhbiBvZGQgdGVy
bSBpbiB0aGlzIHNwYWNlLiBUaGVyZSB3YXMvaXMgbm8gc3ltbWV0cnkgd2l0aCBnZXQvcHV0IAo+
IGFueXdheSBzbyBJIGd1ZXNzIGl0J3MgZmluZS4KCkl0J2xsIGJlIGJhY2sgdG8gaTkxNV92bWFf
cHV0KCkgZXZlbnR1YWxseS4KCj4gPiArdm9pZCBpOTE1X2FjdGl2ZV9zZXRfZXhjbHVzaXZlKHN0
cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLCBzdHJ1Y3QgZG1hX2ZlbmNlICpmKQo+ID4gK3sKPiA+ICsg
ICAgIEdFTV9CVUdfT04oaTkxNV9hY3RpdmVfaXNfaWRsZShyZWYpKTsKPiA+ICsKPiA+ICsgICAg
IGRtYV9mZW5jZV9nZXQoZik7Cj4gPiArCj4gPiArICAgICByY3VfcmVhZF9sb2NrKCk7Cj4gPiAr
ICAgICBpZiAocmN1X2FjY2Vzc19wb2ludGVyKHJlZi0+ZXhjbCkpIHsKPiA+ICsgICAgICAgICAg
ICAgc3RydWN0IGRtYV9mZW5jZSAqb2xkOwo+ID4gKwo+ID4gKyAgICAgICAgICAgICBvbGQgPSBk
bWFfZmVuY2VfZ2V0X3JjdV9zYWZlKCZyZWYtPmV4Y2wpOwo+ID4gKyAgICAgICAgICAgICBpZiAo
b2xkKSB7Cj4gPiArICAgICAgICAgICAgICAgICAgICAgaWYgKGRtYV9mZW5jZV9yZW1vdmVfY2Fs
bGJhY2sob2xkLCAmcmVmLT5leGNsX2NiKSkKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGF0b21pY19kZWMoJnJlZi0+Y291bnQpOwo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGRt
YV9mZW5jZV9wdXQob2xkKTsKPiA+ICsgICAgICAgICAgICAgfQo+IAo+IFB1dCBzb21lIGNvbW1l
bnRhcnkgaW4gZGVzY3JpYmluZyB0aGUgYnVzaW5lc3MgZG9uZSB3aXRoIHJlZi0+ZXhjbCBhbmQg
Cj4gY2FsbGJhY2tzLiBPciB0aGlzIGdvZXMgYXdheSBsYXRlcj8KCnZvaWQgaTkxNV9hY3RpdmVf
c2V0X2V4Y2x1c2l2ZShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwgc3RydWN0IGRtYV9mZW5jZSAq
ZikKewogICAgICAgIEdFTV9CVUdfT04oaTkxNV9hY3RpdmVfaXNfaWRsZShyZWYpKTsKCiAgICAg
ICAgbXV0ZXhfYWNxdWlyZSgmcmVmLT5tdXRleC5kZXBfbWFwLCAwLCAwLCBfVEhJU19JUF8pOwog
ICAgICAgIGlmICghX19pOTE1X2FjdGl2ZV9mZW5jZV9zZXQoJnJlZi0+ZXhjbCwgZikpCiAgICAg
ICAgICAgICAgICBhdG9taWNfaW5jKCZyZWYtPmNvdW50KTsKICAgICAgICBtdXRleF9yZWxlYXNl
KCZyZWYtPm11dGV4LmRlcF9tYXAsIDAsIF9USElTX0lQXyk7Cn0KCj4gPiArc3RhdGljIGludCBl
eGNsX3dhaXQoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCj4gPiArewo+ID4gKyAgICAgc3RydWN0
IGRtYV9mZW5jZSAqb2xkOwo+ID4gKyAgICAgaW50IGVyciA9IDA7Cj4gPiArCj4gPiArICAgICBp
ZiAoIXJjdV9hY2Nlc3NfcG9pbnRlcihyZWYtPmV4Y2wpKQo+ID4gKyAgICAgICAgICAgICByZXR1
cm4gMDsKPiA+ICsKPiA+ICsgICAgIHJjdV9yZWFkX2xvY2soKTsKPiA+ICsgICAgIG9sZCA9IGRt
YV9mZW5jZV9nZXRfcmN1X3NhZmUoJnJlZi0+ZXhjbCk7Cj4gPiArICAgICByY3VfcmVhZF91bmxv
Y2soKTsKPiAKPiByZWYtPmV4Y2wgY2FuIGdvIHNvbWV0aGluZyB0byBOVUxMIGJ1dCBub3QgTlVM
TCB0byBzb21ldGhpbmcgaW4gaGVyZT8KClllcywgYnV0IHRoZSB3YWl0IGlzIG9uIHRoZSBzbmFw
c2hvdCBvZiBmZW5jZXMgYXQgdGhhdCBtb21lbnQgaW4gdGltZS4KRm9yIHRoaW5ncyBsaWtlIHVu
YmluZCBpZiBpdCBiZWNvbWVzIGJ1c3kgYWdhaW4gYWZ0ZXIgd2Ugc3RhcnQsIHdoYXQgaXMKdGhl
IGJlc3QgY291cnNlIG9mIGFjdGlvbiAtLSBjdXJyZW50bHkgd2Ugc3dlYXIgYW5kIHRyeSBhZ2Fp
bi4KClRoZSBwcm9ibGVtIGlzIG1vcmUgZXZpZGVudCBsYXRlciBpbiB0aGUgY29tbWVudDoKCi8q
IEFueSBmZW5jZSBhZGRlZCBhZnRlciB0aGUgd2FpdCBiZWdpbnMgd2lsbCBub3QgYmUgYXV0by1z
aWduYWxlZCAqLwoKd2hpY2ggbWVhbnMgdGhlIHdhaXQgbWF5IGVuZCB3YWl0aW5nIGZvciB0aGUg
YmFja2dyb3VuZCB3b3JrZXIgdG8gZmx1c2gKZmVuY2VzLgoKPiA+ICAgaW50IGk5MTVfcmVxdWVz
dF9hd2FpdF9hY3RpdmUoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsIHN0cnVjdCBpOTE1X2FjdGl2
ZSAqcmVmKQo+ID4gICB7Cj4gPiAtICAgICBzdHJ1Y3QgYWN0aXZlX25vZGUgKml0LCAqbjsKPiA+
IC0gICAgIGludCBlcnI7Cj4gPiAtCj4gPiAtICAgICBpZiAoUkJfRU1QVFlfUk9PVCgmcmVmLT50
cmVlKSkKPiA+IC0gICAgICAgICAgICAgcmV0dXJuIDA7Cj4gPiArICAgICBpbnQgZXJyID0gMDsK
PiA+ICAgCj4gPiAtICAgICAvKiBhd2FpdCBhbGxvY2F0ZXMgYW5kIHNvIHdlIG5lZWQgdG8gYXZv
aWQgaGl0dGluZyB0aGUgc2hyaW5rZXIgKi8KPiA+IC0gICAgIGVyciA9IGk5MTVfYWN0aXZlX2Fj
cXVpcmUocmVmKTsKPiA+IC0gICAgIGlmIChlcnIpCj4gPiAtICAgICAgICAgICAgIHJldHVybiBl
cnI7Cj4gPiArICAgICBpZiAocmN1X2FjY2Vzc19wb2ludGVyKHJlZi0+ZXhjbCkpIHsKPiAKPiBl
eGNsX3dhaXQgdXNlZCBpZi1ub3QtcmV0dXJuIHBhdHRlcm4sIGJ1dCBlc3NlbnRpYWx5IHRoZSBz
YW1lIHF1ZXN0aW9uIAo+IGFib3V0IHBvc3NpYmxlIHJhY2VzLiBJIGd1ZXNzIHRoZXJlIGFyZW4n
dCBhbnkgc2luY2Ugb25seSByZXRpcmVtZW50IGlzIAo+IHJlbGV2YW50IHdoaWNoIGlzIHNvbWV0
aGluZy10by1OVUxMIGFuZCB0aGF0J3MgaGFuZGxlZCBmaW5lLiBCdXQgSSBhbSAKPiBub3Qgc3Vy
ZSwgcG9zc2libHkgY29tbWVudHMgYXJlIGluIG9yZGVyLgoKSXQncyB0aGUgc2FtZSBhcyBhbnkg
b3RoZXIgd2FpdCBvbiBhIHNldC1vZi1mZW5jZSwgdGhlIHdhaXQgaXMgb24gdGhlCnNuYXBzaG90
IG9mIGZlbmNlcyBhdCB0aGF0IG1vbWVudC4KCklmIHlvdSBuZWVkIHN0cmljdGVyIGNvbnRyb2wg
KHN1Y2ggYXMgZW5zdXJpbmcgb3JkZXJpbmcgd2l0aGluIGEKcGFydGljdWxhciB0aW1lbGluZSkg
eW91IGhhdmUgdG8gcHJvdmlkZSB0aGUgb3JkZXJpbmcgb24gdGhhdCBleHRlcm5hbAp0aW1lbGlu
ZS4gVGhhdCdzIHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gc2ltcGx5IHdhaXRpbmcgb24gdGhlCmk5
MTVfYWN0aXZlLCBhbmQgc2V0dGluZyBhIGZlbmNlIHdpdGhpbiBhbiBpOTE1X2FjdGl2ZV9mZW5j
ZSAodGhlIGxhdHRlcgpoYXMgYSBzdHJpY3Qgb3JkZXIpLgoKPiA+IEBAIC0xMDksMjAgKzEyMSwz
MSBAQCBpbnQgaTkxNV9nZW1fb2JqZWN0X3VuYmluZChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVj
dCAqb2JqLAo+ID4gICAgICAgTElTVF9IRUFEKHN0aWxsX2luX2xpc3QpOwo+ID4gICAgICAgaW50
IHJldCA9IDA7Cj4gPiAgIAo+ID4gLSAgICAgbG9ja2RlcF9hc3NlcnRfaGVsZCgmb2JqLT5iYXNl
LmRldi0+c3RydWN0X211dGV4KTsKPiA+IC0KPiA+ICAgICAgIHNwaW5fbG9jaygmb2JqLT52bWEu
bG9jayk7Cj4gPiAgICAgICB3aGlsZSAoIXJldCAmJiAodm1hID0gbGlzdF9maXJzdF9lbnRyeV9v
cl9udWxsKCZvYmotPnZtYS5saXN0LAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgaTkxNV92bWEsCj4gPiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ial9saW5rKSkpIHsKPiA+
ICsgICAgICAgICAgICAgc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSB2bWEtPnZtOwo+
ID4gKwo+ID4gKyAgICAgICAgICAgICByZXQgPSAtRUJVU1k7Cj4gPiArICAgICAgICAgICAgIGlm
ICghaTkxNV92bV90cnlvcGVuKHZtKSkKPiA+ICsgICAgICAgICAgICAgICAgICAgICBicmVhazsK
PiAKPiBUaGlzIGlzIHNvbWUgcmFjZSBiZXR3ZWVuIGRpZmZlcmVudCBwYXRocyBvZiB2bSBjbG9z
aW5nL2Rlc3RydWN0aW9uIGFuZCAKPiB2bWEgY2xlYW51cD8gV2UgbmVlZCBhIGNvbW1lbnQgYWJv
dXQgaXQgc29tZXdoZXJlLi4gSGVyZSBJIGd1ZXNzIGlzIGEgCj4gZ29vZCBwbGFjZS4KCjQgZGlm
ZmVyZW50IHBhdGhzIGFsbCBmaWdodGluZzsgYW5kIGNvb3JkaW5hdGUgYnkgcHJldmVudGluZyB0
aGUgb3RoZXIgMgpkZXN0cnVjdGlvbiBwYXRocyBmcm9tIHJ1bm5pbmcgYXMgdGhleSBydW4sIGFu
ZCBzcGlubG9ja3MgdG8gcHJldmVudCB0aGUKb3RoZXIuCiAKPiBBbmQgd2h5IGJyZWFrIGFuZCBu
b3QgY29udGludWUsIHRoZXJlIHdpbGwgYmUgYSBzZWNvbmQgY2FsbCBjb21pbmcgZnJvbSAKPiBz
b21ld2hlcmUgd2hlbiBpdCBmYWlscz8KCkl0IGZhaWxlZCB0byB1bmJpbmQgdGhlIG9iamVjdCwg
c28gaXQgd291bGQgZW5kIHVwIGluIGEgYnVzeSBzcGluCnByZXZlbnRpbmcgdGhlIGFjdHVhbCB2
bSByZWxlYXNlIGZyb20gcmVtb3ZpbmcgdGhlIHZtYS4KCj4gPiBAQCAtMTAxNSwxNCArMTAxNiw5
IEBAIGk5MTVfZ2VtX29iamVjdF9nZ3R0X3BpbihzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAq
b2JqLAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEVSUl9QVFIoLUVO
T1NQQyk7Cj4gPiAgICAgICAgICAgICAgIH0KPiA+ICAgCj4gPiAtICAgICAgICAgICAgIFdBUk4o
aTkxNV92bWFfaXNfcGlubmVkKHZtYSksCj4gPiAtICAgICAgICAgICAgICAgICAgImJvIGlzIGFs
cmVhZHkgcGlubmVkIGluIGdndHQgd2l0aCBpbmNvcnJlY3QgYWxpZ25tZW50OiIKPiA+IC0gICAg
ICAgICAgICAgICAgICAiIG9mZnNldD0lMDh4LCByZXEuYWxpZ25tZW50PSVsbHgsIgo+ID4gLSAg
ICAgICAgICAgICAgICAgICIgcmVxLm1hcF9hbmRfZmVuY2VhYmxlPSVkLCB2bWEtPm1hcF9hbmRf
ZmVuY2VhYmxlPSVkXG4iLAo+ID4gLSAgICAgICAgICAgICAgICAgIGk5MTVfZ2d0dF9vZmZzZXQo
dm1hKSwgYWxpZ25tZW50LAo+ID4gLSAgICAgICAgICAgICAgICAgICEhKGZsYWdzICYgUElOX01B
UFBBQkxFKSwKPiA+IC0gICAgICAgICAgICAgICAgICBpOTE1X3ZtYV9pc19tYXBfYW5kX2ZlbmNl
YWJsZSh2bWEpKTsKPiAKPiBXaHkgcmVtb3ZpbmcgdGhlIFdBUk4/CgpJdCdzIGZ1bmRhbWVudGFs
bHkgcmFjeS4gTm90IHVudGlsIHlvdSBsb2NrLCBmbHVzaCB0aGUgYWN0aXZlLCBkbyB5b3UKa25v
dyB3aGV0aGVyIG9yIG5vdCB0aGUgdm1hIGlzIGFjdHVhbGx5IHBpbm5lZC4gKFdoZXJlYXMgcHJl
dmlvdXNseSBpdAp3YXMgbG9ja2VkIHVuZGVyIHN0cnVjdF9tdXRleC4pIFdpdGggbXVsdGlwbGUg
c2ltdWx0YW5lb3VzIHBpbm5lcnMsIHRoZQpjaGFuY2UgdGhhdCB3ZSBlbmQgdXAgd2l0aCBhIHBp
biB3ZSBkbyBub3QgbGlrZSBpcyBpbmNyZWFzZWQuIChIbW0sCmVhcmx5IG9uIHRoaXMgZW50aXJl
IGZ1bmN0aW9uIHdhcyB1bmRlciBhIHNpbmdsZSB2bS0+bXV0ZXgsIHRoYXQgcmVtb3Zlcwpzb21l
IHJhY2UgY29uZGl0aW9ucyB0aGF0IGN1cnJlbnRseSBjYXVzZSBhbiB1bmxpa2VseSBmYWlsdXJl
IGF0IHRoZQplbmQsIGJ1dCBzdWNoIHJhY2VzIHdvdWxkIGJlIHBpbmctcG9uZ2luZywgc28gYm90
aCBzdHJhdGVnaWVzIGhhdmUgdGhlaXIKZmF1bHRzLikKCj4gPiArICAgICAgICAgICAgIG11dGV4
X2xvY2soJnZtYS0+dm0tPm11dGV4KTsKPiA+ICAgICAgICAgICAgICAgcmV0ID0gaTkxNV92bWFf
dW5iaW5kKHZtYSk7Cj4gPiArICAgICAgICAgICAgIG11dGV4X3VubG9jaygmdm1hLT52bS0+bXV0
ZXgpOwo+ID4gICAgICAgICAgICAgICBpZiAocmV0KQo+ID4gICAgICAgICAgICAgICAgICAgICAg
IHJldHVybiBFUlJfUFRSKHJldCk7Cj4gPiAgICAgICB9Cgo+ID4gQEAgLTEyNywxNSArMTI2LDYg
QEAgaTkxNV9nZW1fZXZpY3Rfc29tZXRoaW5nKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZt
LAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbl9zaXplLCBhbGlnbm1l
bnQsIGNhY2hlX2xldmVsLAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0
YXJ0LCBlbmQsIG1vZGUpOwo+ID4gICAKPiA+IC0gICAgIC8qCj4gPiAtICAgICAgKiBSZXRpcmUg
YmVmb3JlIHdlIHNlYXJjaCB0aGUgYWN0aXZlIGxpc3QuIEFsdGhvdWdoIHdlIGhhdmUKPiA+IC0g
ICAgICAqIHJlYXNvbmFibGUgYWNjdXJhY3kgaW4gb3VyIHJldGlyZW1lbnQgbGlzdHMsIHdlIG1h
eSBoYXZlCj4gPiAtICAgICAgKiBhIHN0cmF5IHBpbiAocHJldmVudGluZyBldmljdGlvbikgdGhh
dCBjYW4gb25seSBiZSByZXNvbHZlZCBieQo+ID4gLSAgICAgICogcmV0aXJpbmcuCj4gPiAtICAg
ICAgKi8KPiA+IC0gICAgIGlmICghKGZsYWdzICYgUElOX05PTkJMT0NLKSkKPiA+IC0gICAgICAg
ICAgICAgaTkxNV9yZXRpcmVfcmVxdWVzdHMoZGV2X3ByaXYpOwo+IAo+IE5vdCBuZWVkZWQgYW55
IG1vcmUgYmVjYXVzZT8KCkl0J3MgaWxsZWdhbCwgcmVxdWlyZXMgc3RydWN0X211dGV4LCB3ZSBk
byBub3QgaG9sZCBzdHJ1Y3RfbXV0ZXguIChVbnRpbAp0aGUgZW5kIG9mIHRoaXMgc2VyaWVzIHdo
ZW4gaTkxNV9yZXRpcmVfcmVxdWVzdHMgaXMgaW5kZXBlbmRlbnQgb2YKc3RydWN0X211dGV4IGFu
ZCB3ZSByZXN0b3JlIGl0LikKCj4gPiBAQCAtMTc1LDcgKzE3OCw4IEBAIHN0YXRpYyBpbnQgcHBn
dHRfYmluZF92bWEoc3RydWN0IGk5MTVfdm1hICp2bWEsCj4gPiAgIAo+ID4gICBzdGF0aWMgdm9p
ZCBwcGd0dF91bmJpbmRfdm1hKHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQo+ID4gICB7Cj4gPiAtICAg
ICB2bWEtPnZtLT5jbGVhcl9yYW5nZSh2bWEtPnZtLCB2bWEtPm5vZGUuc3RhcnQsIHZtYS0+c2l6
ZSk7Cj4gPiArICAgICBpZiAodGVzdF9hbmRfY2xlYXJfYml0KEk5MTVfVk1BX0FMTE9DX0JJVCwg
X19pOTE1X3ZtYV9mbGFncyh2bWEpKSkKPiA+ICsgICAgICAgICAgICAgdm1hLT52bS0+Y2xlYXJf
cmFuZ2Uodm1hLT52bSwgdm1hLT5ub2RlLnN0YXJ0LCB2bWEtPnNpemUpOwo+IAo+IFZNQSBib3Vu
ZCBhbmQgYWxsb2NhdGVkIGFyZSBub3cgc3lub255bXM/CgpjbGVhcl9yYW5nZSBkZWNyZW1lbnRz
IHRoZSBwdCB1c2UgY291bnRlcnMgdGhhdCBhbGxvYyBpbmNyZW1lbnRlZC4KCj4gPiArc3RydWN0
IGk5MTVfdm1hX3dvcmsgKmk5MTVfdm1hX3dvcmsodm9pZCkKPiA+ICt7Cj4gPiArICAgICBzdHJ1
Y3QgaTkxNV92bWFfd29yayAqdnc7Cj4gPiArCj4gPiArICAgICB2dyA9IGt6YWxsb2Moc2l6ZW9m
KCp2dyksIEdGUF9LRVJORUwpOwo+IAo+IFRoaXMgY291bGQgYmUgcmVhc29uYWJseSBoaWdoIHRy
YWZmaWMgdG8gd2FycmFudCBhIGRlZGljYXRlZCBzbGFiLgoKSXQncyBhbHNvIG5vdCBnb2luZyB0
byBzdXJ2aXZlIGZvciBtb3JlIHRoYW4gMiBrZXJuZWwgcmVsZWFzZXMuIDooCgo+ID4gKyAgICAg
aWYgKCF2dykKPiA+ICsgICAgICAgICAgICAgcmV0dXJuIE5VTEw7Cj4gPiArCj4gPiArICAgICBk
bWFfZmVuY2Vfd29ya19pbml0KCZ2dy0+YmFzZSwgJmJpbmRfb3BzKTsKPiAKPiBIbSwgbmV3IChm
b3IgbWUpIEFQSS4uIHdoYXQgaXMgdGhlIGFkdmFudGFnZS9uZWVkIGNvbXBhcmVkIHRvIHBsYWlu
IHdvcmtlcnM/CgpJdCBpcyBhIHBsYWluIHdvcmtlciB3aXRoIHRoZSBkbWEtZmVuY2UgY291cGxp
bmcgd2UndmUgYWxsIGdyb3duIHRvCmNoZXJpc2guCgo+ID4gQEAgLTMzMyw5ICszNzUsMzIgQEAg
aW50IGk5MTVfdm1hX2JpbmQoc3RydWN0IGk5MTVfdm1hICp2bWEsIGVudW0gaTkxNV9jYWNoZV9s
ZXZlbCBjYWNoZV9sZXZlbCwKPiA+ICAgICAgIEdFTV9CVUdfT04oIXZtYS0+cGFnZXMpOwo+ID4g
ICAKPiA+ICAgICAgIHRyYWNlX2k5MTVfdm1hX2JpbmQodm1hLCBiaW5kX2ZsYWdzKTsKPiA+IC0g
ICAgIHJldCA9IHZtYS0+b3BzLT5iaW5kX3ZtYSh2bWEsIGNhY2hlX2xldmVsLCBiaW5kX2ZsYWdz
KTsKPiA+IC0gICAgIGlmIChyZXQpCj4gPiAtICAgICAgICAgICAgIHJldHVybiByZXQ7Cj4gPiAr
ICAgICBpZiAod29yayAmJiAoYmluZF9mbGFncyAmIH52bWFfZmxhZ3MpICYgdm1hLT52bS0+Ymlu
ZF9hbGxvYykgewo+IAo+IFdoYXQgaXMgdGhlIGJpdHdpc2UgbG9naWMgY2hlY2tpbmcgZm9yPwoK
V2hldGhlciB3ZSBhcmUgYWRkaW5nIGEgYmluZCB0aGF0IHJlcXVpcmVzIGFsbG9jYXRpb25zIHRo
YXQgdGhlIGNhbGxlcgpyZXF1aXJlcyB0byBiZSBhc3luYy4KCj4gPiArICAgICAgICAgICAgIHdv
cmstPnZtYSA9IHZtYTsKPiA+ICsgICAgICAgICAgICAgd29yay0+Y2FjaGVfbGV2ZWwgPSBjYWNo
ZV9sZXZlbDsKPiA+ICsgICAgICAgICAgICAgd29yay0+ZmxhZ3MgPSBiaW5kX2ZsYWdzIHwgSTkx
NV9WTUFfQUxMT0M7Cj4gPiArCj4gPiArICAgICAgICAgICAgIC8qCj4gPiArICAgICAgICAgICAg
ICAqIE5vdGUgd2Ugb25seSB3YW50IHRvIGNoYWluIHVwIHRvIHRoZSBtaWdyYXRpb24gZmVuY2Ug
b24KPiA+ICsgICAgICAgICAgICAgICogdGhlIHBhZ2VzIChub3QgdGhlIG9iamVjdCBpdHNlbGYp
LiBBcyB3ZSBkb24ndCB0cmFjayB0aGF0LAo+ID4gKyAgICAgICAgICAgICAgKiB5ZXQsIHdlIGhh
dmUgdG8gdXNlIHRoZSBleGNsdXNpdmUgZmVuY2UgaW5zdGVhZC4KPiA+ICsgICAgICAgICAgICAg
ICoKPiA+ICsgICAgICAgICAgICAgICogQWxzbyBub3RlIHRoYXQgd2UgZG8gbm90IHdhbnQgdG8g
dHJhY2sgdGhlIGFzeW5jIHZtYSBhcwo+ID4gKyAgICAgICAgICAgICAgKiBwYXJ0IG9mIHRoZSBv
YmotPnJlc3YtPmV4Y2xfZmVuY2UgYXMgaXQgb25seSBhZmZlY3RzCj4gPiArICAgICAgICAgICAg
ICAqIGV4ZWN1dGlvbiBhbmQgbm90IGNvbnRlbnQgb3Igb2JqZWN0J3MgYmFja2luZyBzdG9yZSBs
aWZldGltZS4KPiA+ICsgICAgICAgICAgICAgICovCj4gPiArICAgICAgICAgICAgIEdFTV9CVUdf
T04oaTkxNV9hY3RpdmVfaGFzX2V4Y2x1c2l2ZSgmdm1hLT5hY3RpdmUpKTsKPiA+ICsgICAgICAg
ICAgICAgaTkxNV9hY3RpdmVfc2V0X2V4Y2x1c2l2ZSgmdm1hLT5hY3RpdmUsICZ3b3JrLT5iYXNl
LmRtYSk7Cj4gCj4gT2ggcmlnaHQsIGRtYV9mZW5jZV93b3JrIHNpbmNlIGl0J3Mgbm90IGEgd29y
a2VyIGJ1dCBjYWxsYmFjayBvbiAKPiBzaWduYWxsaW5nIHRoZSBmZW5jZS4uLiBGcm9tIHdoYXQg
Y29udGV4dCBpdCBnZXRzIGNhbGxlZCAoaG9sZGluZyBhbnkgCj4gbG9ja3M/KSBhbmQgd2hpY2gg
bG9ja3MgdGhlIGNhbGxiYWNrIGNhbi93aWxsIHRha2U/CgpkbWFfZmVuY2Vfd29yayBoYXMgYSBk
bWFfZmVuY2VfY2IgdGhhdCBzY2hlZHVsZXMgYSB3b3JrX3N0dWN0IHdoaWNoCmV4ZWN1dGVzIG91
ciBmdW5jdGlvbi4gKEFuZCBpdCBhbHNvIGhhcyBhIGRtYS1mZW5jZSB0aHJvdWdoIHdoaWNoIHdl
IGNhbgpzaWduYWwgdGhlIGNvbXBsZXRpb24vZXJyb3Igb2YgdGhhdCBmdW5jdGlvbi4pCgo+ID4g
QEAgLTM2OCw3ICs0MzEsOCBAQCB2b2lkIF9faW9tZW0gKmk5MTVfdm1hX3Bpbl9pb21hcChzdHJ1
Y3QgaTkxNV92bWEgKnZtYSkKPiA+ICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGVycjsKPiA+
ICAgICAgICAgICAgICAgfQo+ID4gICAKPiA+IC0gICAgICAgICAgICAgdm1hLT5pb21hcCA9IHB0
cjsKPiA+ICsgICAgICAgICAgICAgaWYgKHVubGlrZWx5KGNtcHhjaGcoJnZtYS0+aW9tYXAsIE5V
TEwsIHB0cikpKQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGlvX21hcHBpbmdfdW5tYXAocHRy
KTsKPiAKPiBXaHkgdGhpcyBjaGFuZ2U/CgpNdWx0aXBsZSBwaW5uZXJzIHJhY2UgdG8gc2VlIHdo
byB3aW4gdGhlIGlvX21hcHBpbmcgY29tcGV0aXRpb24uIEVhY2gKdGhyZWFkIGRvZXMgdGhlaXIg
b3duIGFsbG9jYXRpb24sIGlmIGZpcnN0IHRoZXkgcGFzcyBvd25lcnNoaXAgdG8gdGhlCnZtYSwg
aWYgbGFzdCB0aGV5IGRlbGV0ZSB0aGVpciBvd24gaW9fbWFwcGluZyBhbmQgZ28gb24gdG8gdXNl
IHRoZQp3aW5uZXIncyB2bWEtPmlvbWFwLiBFeGNlcHQgYW4gaWRpb3QgZm9yZ290IHRvIHVwZGF0
ZSB0aGUgbG9zZXIncyBwdHIKaGVyZS4KCj4gPiBAQCAtNTgwLDM1ICs2NDAsMjEgQEAgaTkxNV92
bWFfaW5zZXJ0KHN0cnVjdCBpOTE1X3ZtYSAqdm1hLCB1NjQgc2l6ZSwgdTY0IGFsaWdubWVudCwg
dTY0IGZsYWdzKQo+ID4gICAgICAgICAgICAgICByZXR1cm4gLUVOT1NQQzsKPiA+ICAgICAgIH0K
PiA+ICAgCj4gPiAtICAgICBpZiAodm1hLT5vYmopIHsKPiA+IC0gICAgICAgICAgICAgcmV0ID0g
aTkxNV9nZW1fb2JqZWN0X3Bpbl9wYWdlcyh2bWEtPm9iaik7Cj4gPiAtICAgICAgICAgICAgIGlm
IChyZXQpCj4gPiAtICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKPiA+IC0KPiA+ICsg
ICAgIGNhY2hlX2xldmVsID0gMDsKPiA+ICsgICAgIGlmICh2bWEtPm9iaikKPiA+ICAgICAgICAg
ICAgICAgY2FjaGVfbGV2ZWwgPSB2bWEtPm9iai0+Y2FjaGVfbGV2ZWw7Cj4gPiAtICAgICB9IGVs
c2Ugewo+ID4gLSAgICAgICAgICAgICBjYWNoZV9sZXZlbCA9IDA7Cj4gPiAtICAgICB9Cj4gPiAt
Cj4gPiAtICAgICBHRU1fQlVHX09OKHZtYS0+cGFnZXMpOwo+ID4gLQo+ID4gLSAgICAgcmV0ID0g
dm1hLT5vcHMtPnNldF9wYWdlcyh2bWEpOwo+ID4gLSAgICAgaWYgKHJldCkKPiA+IC0gICAgICAg
ICAgICAgZ290byBlcnJfdW5waW47Cj4gPiAgIAo+ID4gICAgICAgaWYgKGZsYWdzICYgUElOX09G
RlNFVF9GSVhFRCkgewo+ID4gICAgICAgICAgICAgICB1NjQgb2Zmc2V0ID0gZmxhZ3MgJiBQSU5f
T0ZGU0VUX01BU0s7Cj4gPiAgICAgICAgICAgICAgIGlmICghSVNfQUxJR05FRChvZmZzZXQsIGFs
aWdubWVudCkgfHwKPiA+IC0gICAgICAgICAgICAgICAgIHJhbmdlX292ZXJmbG93cyhvZmZzZXQs
IHNpemUsIGVuZCkpIHsKPiA+IC0gICAgICAgICAgICAgICAgICAgICByZXQgPSAtRUlOVkFMOwo+
ID4gLSAgICAgICAgICAgICAgICAgICAgIGdvdG8gZXJyX2NsZWFyOwo+ID4gLSAgICAgICAgICAg
ICB9Cj4gPiArICAgICAgICAgICAgICAgICByYW5nZV9vdmVyZmxvd3Mob2Zmc2V0LCBzaXplLCBl
bmQpKQo+IAo+IEEgbG90IG9mIGNoZWNrcy9vcHMgcmVtb3ZlZCBmcm9tIGhlcmUuLiBJIHRoaW5r
IEknbGwgbmVlZCB0byBhcHBseSB0byAKPiBmaWd1cmUgb3V0IGhvdyBmbG93cyB3b3JrLiBPciBy
ZXZpZXcgb24gaGlnaCBsZXZlbCBhbmQgaGF2ZSBmYWl0aCBpbiBDSS4KCkNoZWNrcyBkaWRuJ3Qg
Z2V0IGRyb3BwZWQsIGp1c3QgdGhlIG9wcyBtb3ZlZCB0byB0aGUgY2FsbGVyLiBUaG9zZSB0aGF0
Cm5lZWQgdG8gYmUgZG9uZSBiZWZvcmUgdGhlIG11dGV4IGhhdmUgdG8gYmUgaW4gdGhlIGNhbGxl
ci4gVGhpcyBmdW5jdGlvbgppcyBub3cgb25seSByZXNwb25zaWJsZSBmb3IgZmluZC9yZXNlcnZp
bmcgdGhlIHBsYWNlIGluIHRoZSBkcm1fbW0uCgo+ID4gK3N0YXRpYyBib29sIHRyeV9mYXN0X3Bp
bihzdHJ1Y3QgaTkxNV92bWEgKnZtYSwgdW5zaWduZWQgaW50IGZsYWdzKQo+ID4gICB7Cj4gPiAt
ICAgICBjb25zdCB1bnNpZ25lZCBpbnQgYm91bmQgPSBhdG9taWNfcmVhZCgmdm1hLT5mbGFncyk7
Cj4gPiAtICAgICBpbnQgcmV0Owo+ID4gKyAgICAgdW5zaWduZWQgaW50IGJvdW5kOwo+ID4gKyAg
ICAgYm9vbCBwaW5uZWQgPSB0cnVlOwo+ID4gICAKPiA+IC0gICAgIGxvY2tkZXBfYXNzZXJ0X2hl
bGQoJnZtYS0+dm0tPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gLSAgICAgR0VNX0JVR19P
TigoZmxhZ3MgJiAoUElOX0dMT0JBTCB8IFBJTl9VU0VSKSkgPT0gMCk7Cj4gPiAtICAgICBHRU1f
QlVHX09OKChmbGFncyAmIFBJTl9HTE9CQUwpICYmICFpOTE1X3ZtYV9pc19nZ3R0KHZtYSkpOwo+
ID4gKyAgICAgYm91bmQgPSBhdG9taWNfcmVhZCgmdm1hLT5mbGFncyk7Cj4gPiArICAgICBkbyB7
Cj4gPiArICAgICAgICAgICAgIGlmICh1bmxpa2VseShmbGFncyAmIH5ib3VuZCkpCj4gPiArICAg
ICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwo+IAo+IFdoYXQgaXMgdGhpcyBjaGVja2lu
ZyBmb3I/CgpJZiB0aGUgcmVxdWVzdGVkIGJpbmRpbmcgKGZsYWdzKSBpcyBhbHJlYWR5IGF2YWls
YWJsZSAoYm91bmQpLgoKPiA+IC0gICAgIGlmIChXQVJOX09OKGJvdW5kICYgSTkxNV9WTUFfUElO
X09WRVJGTE9XKSkgewo+ID4gLSAgICAgICAgICAgICByZXQgPSAtRUJVU1k7Cj4gPiAtICAgICAg
ICAgICAgIGdvdG8gZXJyX3VucGluOwo+ID4gKyAgICAgICAgICAgICBpZiAodW5saWtlbHkoYm91
bmQgJiAoSTkxNV9WTUFfT1ZFUkZMT1cgfCBJOTE1X1ZNQV9FUlJPUikpKQo+ID4gKyAgICAgICAg
ICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKPiAKPiBXaGF0IHdpbGwgdGhlIGNhbGxlciB0cnkg
dG8gZG8gaW4gdGhlc2UgY2FzZXM/CgpOb3QgZG8gdGhlIGVhcmx5IHJldHVybi4KCj4gPiArCj4g
PiArICAgICAgICAgICAgIGlmICghKGJvdW5kICYgSTkxNV9WTUFfUElOX01BU0spKQo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgIGdvdG8gc2xvdzsKPiAKPiBTaW5jZSBmYXN0IHBhdGggY2FuIGdv
IHRvIHNsb3csIG5vdCBzdXJlIHdoYXQgaXMgZmFzdCByZWZlcnJpbmcgdG8uCj4gCj4gPiArCj4g
PiArICAgICAgICAgICAgIEdFTV9CVUdfT04oKChib3VuZCArIDEpICYgSTkxNV9WTUFfUElOX01B
U0spID09IDApOwo+ID4gKyAgICAgfSB3aGlsZSAoIWF0b21pY190cnlfY21weGNoZygmdm1hLT5m
bGFncywgJmJvdW5kLCBib3VuZCArIDEpKTsKPiA+ICsKPiA+ICsgICAgIHJldHVybiB0cnVlOwo+
ID4gKwo+ID4gK3Nsb3c6Cj4gPiArICAgICAvKgo+ID4gKyAgICAgICogSWYgcGluX2NvdW50PT0w
LCBidXQgd2UgYXJlIGJvdW5kLCBjaGVjayB1bmRlciB0aGUgbG9jayB0byBhdm9pZAo+ID4gKyAg
ICAgICogcmFjaW5nIHdpdGggYSBjb25jdXJyZW50IGk5MTVfdm1hX3VuYmluZCgpLgo+ID4gKyAg
ICAgICovCj4gPiArICAgICBtdXRleF9sb2NrKCZ2bWEtPnZtLT5tdXRleCk7Cj4gCj4gVGhpcyBp
cyBuZXZlciBmcm9tIHByb2Nlc3MgY29udGV4dCB0byBuZWVkIHRvIGJlIGludGVycnVwdGlibGU/
CgpJIHN0YXJ0ZWQgd2l0aCBhIHRyaXN0YXRlIHJldHVybiwgZGlkbid0IGxpa2UgaXQgbXVjaCAo
dHJ5KCkgbWVhbnMgYm9vbAp0byBtZSkuIEl0IGNhbiBiZSBfaW50ZXJydXB0aWJsZSBoZXJlLCB3
ZSB0aGVuIGRvIGFuIGFsbG9jIGJlZm9yZSBnaXZpbmcKdXAuCgo+ID4gKyAgICAgZG8gewo+ID4g
KyAgICAgICAgICAgICBpZiAodW5saWtlbHkoYm91bmQgJiAoSTkxNV9WTUFfT1ZFUkZMT1cgfCBJ
OTE1X1ZNQV9FUlJPUikpKSB7Cj4gPiArICAgICAgICAgICAgICAgICAgICAgcGlubmVkID0gZmFs
c2U7Cj4gPiArICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Cj4gPiArICAgICAgICAgICAgIH0K
PiA+ICsKPiA+ICsgICAgICAgICAgICAgaWYgKHVubGlrZWx5KGZsYWdzICYgfmJvdW5kKSkgewo+
ID4gKyAgICAgICAgICAgICAgICAgICAgIHBpbm5lZCA9IGZhbHNlOwo+ID4gKyAgICAgICAgICAg
ICAgICAgICAgIGJyZWFrOwo+ID4gKyAgICAgICAgICAgICB9Cj4gPiArICAgICB9IHdoaWxlICgh
YXRvbWljX3RyeV9jbXB4Y2hnKCZ2bWEtPmZsYWdzLCAmYm91bmQsIGJvdW5kICsgMSkpOwo+ID4g
KyAgICAgbXV0ZXhfdW5sb2NrKCZ2bWEtPnZtLT5tdXRleCk7Cj4gCj4gc2xvdyA9IDAgLT4gMSBw
aW4gdHJhbnNpdGlvbiwgdGhlIHJlc3QgYXJlIGZhc3Q/CgoxKyBhcmUgZmFzdDsgdW5ib3VuZCBp
cyBzbG93ZXN0LgoKPiA+ICsKPiA+ICsgICAgIHJldHVybiBwaW5uZWQ7Cj4gPiArfQo+ID4gKwo+
ID4gK3N0YXRpYyBpbnQgdm1hX2dldF9wYWdlcyhzdHJ1Y3QgaTkxNV92bWEgKnZtYSkKPiA+ICt7
Cj4gPiArICAgICBpbnQgZXJyID0gMDsKPiA+ICsKPiA+ICsgICAgIGlmIChhdG9taWNfYWRkX3Vu
bGVzcygmdm1hLT5wYWdlc19jb3VudCwgMSwgMCkpCj4gPiArICAgICAgICAgICAgIHJldHVybiAw
Owo+ID4gKwo+ID4gKyAgICAgaWYgKG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmdm1hLT5wYWdl
c19tdXRleCkpCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRUlOVFI7Cj4gPiArCj4gPiArICAg
ICBpZiAoIWF0b21pY19yZWFkKCZ2bWEtPnBhZ2VzX2NvdW50KSkgewo+ID4gKyAgICAgICAgICAg
ICBpZiAodm1hLT5vYmopIHsKPiA+ICsgICAgICAgICAgICAgICAgICAgICBlcnIgPSBpOTE1X2dl
bV9vYmplY3RfcGluX3BhZ2VzKHZtYS0+b2JqKTsKPiA+ICsgICAgICAgICAgICAgICAgICAgICBp
ZiAoZXJyKQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ290byB1bmxvY2s7Cj4g
PiArICAgICAgICAgICAgIH0KPiA+ICsKPiA+ICsgICAgICAgICAgICAgZXJyID0gdm1hLT5vcHMt
PnNldF9wYWdlcyh2bWEpOwo+ID4gKyAgICAgICAgICAgICBpZiAoZXJyKQo+ID4gKyAgICAgICAg
ICAgICAgICAgICAgIGdvdG8gdW5sb2NrOwo+ID4gICAgICAgfQo+ID4gKyAgICAgYXRvbWljX2lu
Yygmdm1hLT5wYWdlc19jb3VudCk7Cj4gPiAgIAo+ID4gLSAgICAgaWYgKChib3VuZCAmIEk5MTVf
Vk1BX0JJTkRfTUFTSykgPT0gMCkgewo+ID4gLSAgICAgICAgICAgICByZXQgPSBpOTE1X3ZtYV9p
bnNlcnQodm1hLCBzaXplLCBhbGlnbm1lbnQsIGZsYWdzKTsKPiA+IC0gICAgICAgICAgICAgaWYg
KHJldCkKPiA+IC0gICAgICAgICAgICAgICAgICAgICBnb3RvIGVycl91bnBpbjsKPiA+ICt1bmxv
Y2s6Cj4gPiArICAgICBtdXRleF91bmxvY2soJnZtYS0+cGFnZXNfbXV0ZXgpOwo+ID4gKwo+ID4g
KyAgICAgcmV0dXJuIGVycjsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHZvaWQgX192bWFfcHV0
X3BhZ2VzKHN0cnVjdCBpOTE1X3ZtYSAqdm1hLCB1bnNpZ25lZCBpbnQgY291bnQpCj4gPiArewo+
ID4gKyAgICAgbXV0ZXhfbG9ja19uZXN0ZWQoJnZtYS0+cGFnZXNfbXV0ZXgsIFNJTkdMRV9ERVBU
SF9ORVNUSU5HKTsKPiAKPiBOZXN0aW5nIGFubm90YXRpb24gb25seSBuZWVkZWQgb24gdGhlIHB1
dCBwYXRoPyBDb21tZW50IHRvIGRlc2NyaWJlIHdoeSAKPiBpdCBpcyBuZWVkZWQgd291bGQgYmUg
Z29vZC4KCkl0J3MgYW4gYWxsb2NhdGluZyBtdXRleCwgc28gd2UgY2FuIGJlIGNhbGxlZCBmcm9t
IHVuZGVybmVhdGggYW5vdGhlcgp2bWEtPnBhZ2VzX211dGV4LiBTdGFuZGFyZCBtaXNlcnkuCgo+
ID4gKyAgICAgR0VNX0JVR19PTihhdG9taWNfcmVhZCgmdm1hLT5wYWdlc19jb3VudCkgPCBjb3Vu
dCk7Cj4gPiArICAgICBpZiAoYXRvbWljX3N1Yl9yZXR1cm4oY291bnQsICZ2bWEtPnBhZ2VzX2Nv
dW50KSA9PSAwKSB7Cj4gPiArICAgICAgICAgICAgIHZtYS0+b3BzLT5jbGVhcl9wYWdlcyh2bWEp
Owo+ID4gKyAgICAgICAgICAgICBHRU1fQlVHX09OKHZtYS0+cGFnZXMpOwo+ID4gKyAgICAgICAg
ICAgICBpZiAodm1hLT5vYmopCj4gPiArICAgICAgICAgICAgICAgICAgICAgaTkxNV9nZW1fb2Jq
ZWN0X3VucGluX3BhZ2VzKHZtYS0+b2JqKTsKPiA+ICAgICAgIH0KPiA+IC0gICAgIEdFTV9CVUdf
T04oIWRybV9tbV9ub2RlX2FsbG9jYXRlZCgmdm1hLT5ub2RlKSk7Cj4gPiArICAgICBtdXRleF91
bmxvY2soJnZtYS0+cGFnZXNfbXV0ZXgpOwo+ID4gK30KPiA+ICAgCj4gPiAtICAgICByZXQgPSBp
OTE1X3ZtYV9iaW5kKHZtYSwgdm1hLT5vYmogPyB2bWEtPm9iai0+Y2FjaGVfbGV2ZWwgOiAwLCBm
bGFncyk7Cj4gPiAtICAgICBpZiAocmV0KQo+ID4gLSAgICAgICAgICAgICBnb3RvIGVycl9yZW1v
dmU7Cj4gPiArc3RhdGljIHZvaWQgdm1hX3B1dF9wYWdlcyhzdHJ1Y3QgaTkxNV92bWEgKnZtYSkK
PiA+ICt7Cj4gPiArICAgICBpZiAoYXRvbWljX2FkZF91bmxlc3MoJnZtYS0+cGFnZXNfY291bnQs
IC0xLCAxKSkKPiA+ICsgICAgICAgICAgICAgcmV0dXJuOwo+ID4gICAKPiA+IC0gICAgIEdFTV9C
VUdfT04oIWk5MTVfdm1hX2lzX2JvdW5kKHZtYSwgSTkxNV9WTUFfQklORF9NQVNLKSk7Cj4gPiAr
ICAgICBfX3ZtYV9wdXRfcGFnZXModm1hLCAxKTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHZv
aWQgdm1hX3VuYmluZF9wYWdlcyhzdHJ1Y3QgaTkxNV92bWEgKnZtYSkKPiA+ICt7Cj4gPiArICAg
ICB1bnNpZ25lZCBpbnQgY291bnQ7Cj4gPiArCj4gPiArICAgICBsb2NrZGVwX2Fzc2VydF9oZWxk
KCZ2bWEtPnZtLT5tdXRleCk7Cj4gPiArCj4gPiArICAgICBjb3VudCA9IGF0b21pY19yZWFkKCZ2
bWEtPnBhZ2VzX2NvdW50KTsKPiA+ICsgICAgIGNvdW50ID4+PSBJOTE1X1ZNQV9QQUdFU19CSUFT
Owo+ID4gKyAgICAgR0VNX0JVR19PTighY291bnQpOwo+ID4gKwo+ID4gKyAgICAgX192bWFfcHV0
X3BhZ2VzKHZtYSwgY291bnQgfCBjb3VudCA8PCBJOTE1X1ZNQV9QQUdFU19CSUFTKTsKPiAKPiBJ
IHRoaW5rIHdlIG5lZWQgZG9jdW1lbnRhdGlvbiBvbiB2YXJpb3VzIGZsYWdzIGFuZCBwb3NzaWJs
ZSBzdGF0ZXMuCgpJdCBsaXRlcmFsbHkgaXMganVzdCBhIGJpYXMhICgyIGNvdW50ZXJzIHdpdGhp
biBvbmUuKQoKPiA+ICtpbnQgaTkxNV92bWFfcGluKHN0cnVjdCBpOTE1X3ZtYSAqdm1hLCB1NjQg
c2l6ZSwgdTY0IGFsaWdubWVudCwgdTY0IGZsYWdzKQo+ID4gK3sKPiA+ICsgICAgIHN0cnVjdCBp
OTE1X3ZtYV93b3JrICp3b3JrID0gTlVMTDsKPiA+ICsgICAgIHVuc2lnbmVkIGludCBib3VuZDsK
PiA+ICsgICAgIGludCBlcnI7Cj4gPiArCj4gPiArICAgICBCVUlMRF9CVUdfT04oUElOX0dMT0JB
TCAhPSBJOTE1X1ZNQV9HTE9CQUxfQklORCk7Cj4gPiArICAgICBCVUlMRF9CVUdfT04oUElOX1VT
RVIgIT0gSTkxNV9WTUFfTE9DQUxfQklORCk7Cj4gPiArCj4gPiArICAgICBHRU1fQlVHX09OKGZs
YWdzICYgUElOX1VQREFURSk7Cj4gPiArICAgICBHRU1fQlVHX09OKCEoZmxhZ3MgJiAoUElOX1VT
RVIgfCBQSU5fR0xPQkFMKSkpOwo+ID4gICAKPiA+IC0gICAgIGlmICgoYm91bmQgXiBhdG9taWNf
cmVhZCgmdm1hLT5mbGFncykpICYgSTkxNV9WTUFfR0xPQkFMX0JJTkQpCj4gPiAtICAgICAgICAg
ICAgIF9faTkxNV92bWFfc2V0X21hcF9hbmRfZmVuY2VhYmxlKHZtYSk7Cj4gPiArICAgICBpZiAo
dHJ5X2Zhc3RfcGluKHZtYSwgZmxhZ3MgJiBJOTE1X1ZNQV9CSU5EX01BU0spKQo+ID4gKyAgICAg
ICAgICAgICByZXR1cm4gMDsKPiA+ICsKPiA+ICsgICAgIGVyciA9IHZtYV9nZXRfcGFnZXModm1h
KTsKPiA+ICsgICAgIGlmIChlcnIpCj4gPiArICAgICAgICAgICAgIHJldHVybiBlcnI7Cj4gPiAr
Cj4gPiArICAgICBpZiAoZmxhZ3MgJiBQSU5fVVNFUikgewo+ID4gKyAgICAgICAgICAgICB3b3Jr
ID0gaTkxNV92bWFfd29yaygpOwo+ID4gKyAgICAgICAgICAgICBpZiAoIXdvcmspIHsKPiA+ICsg
ICAgICAgICAgICAgICAgICAgICBlcnIgPSAtRU5PTUVNOwo+ID4gKyAgICAgICAgICAgICAgICAg
ICAgIGdvdG8gZXJyX3BhZ2VzOwo+ID4gKyAgICAgICAgICAgICB9Cj4gPiArICAgICB9Cj4gCj4g
R29vZCBwbGFjZSBmb3IgYSBjb21tZW50IHRvIGV4cGxhaW4gd2h5IFBJTl9VU0VSIG5lZWRzIHRv
IGdvIHZpYSB3b3JrZXIgCj4gYW5kIHRoZSByZXN0IGRvbnQuCgpQcm9iYWJseSB3aWxsIGNoYW5n
ZSBpZiBteSBwbGFucyBmb3IgYnN3L2J4dCBjb21lIHRvIGZydWl0aW9uLiBBbmQKY2VydGFpbmx5
IHdpbGwgY2hhbmdlIGFnYWluIGFzIHdlIHdpbGwgbmVlZCB0byBwYXNzIGRvd24gdGhlIGZlbmNl
Li4uCgo+ID4gKyAgICAgZXJyID0gbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKCZ2bWEtPnZtLT5t
dXRleCk7Cj4gPiArICAgICBpZiAoZXJyKQo+ID4gKyAgICAgICAgICAgICBnb3RvIGVycl9mZW5j
ZTsKPiA+ICsKPiA+ICsgICAgIGJvdW5kID0gYXRvbWljX3JlYWQoJnZtYS0+ZmxhZ3MpOwo+ID4g
KyAgICAgaWYgKHVubGlrZWx5KGJvdW5kICYgSTkxNV9WTUFfRVJST1IpKSB7Cj4gPiArICAgICAg
ICAgICAgIGVyciA9IC1FTk9NRU07Cj4gPiArICAgICAgICAgICAgIGdvdG8gZXJyX3VubG9jazsK
PiA+ICsgICAgIH0KPiA+ICAgCj4gPiArICAgICBpZiAodW5saWtlbHkoISgoYm91bmQgKyAxKSAm
IEk5MTVfVk1BX1BJTl9NQVNLKSkpIHsKPiA+ICsgICAgICAgICAgICAgZXJyID0gLUVBR0FJTjsg
LyogcGlucyBhcmUgbWVhbnQgdG8gYmUgZmFpcmx5IHRlbXBvcmFyeSAqLwo+ID4gKyAgICAgICAg
ICAgICBnb3RvIGVycl91bmxvY2s7Cj4gPiArICAgICB9Cj4gCj4gRGlkIG5vdCBnZXQgd2hhdCB0
aGlzIGlzPwoKVGhlIG92ZXJmbG93IHRlc3QuCgo+ID4gKyAgICAgaWYgKHVubGlrZWx5KCEoZmxh
Z3MgJiB+Ym91bmQgJiBJOTE1X1ZNQV9CSU5EX01BU0spKSkgewo+ID4gKyAgICAgICAgICAgICBf
X2k5MTVfdm1hX3Bpbih2bWEpOwo+ID4gKyAgICAgICAgICAgICBnb3RvIGVycl91bmxvY2s7Cj4g
PiArICAgICB9Cj4gCj4gT3IgdGhpcy4gKENvbW1lbnQgcGxlYXNlLikKCkFscmVhZHkgYm91bmQg
YnkgYW5vdGhlciB0aHJlYWQuCgo+ID4gKwo+ID4gKyAgICAgZXJyID0gaTkxNV9hY3RpdmVfYWNx
dWlyZSgmdm1hLT5hY3RpdmUpOwo+IAo+IEl0J3MgZHJvcHBlZCBzb21ld2hlcmUgdG8gcmVsZWFz
ZSBpdCBpbnRvIG5vcm1hbCBmbG93cz8KCk5vdCBtYW55IGxpbmVzIGJlbG93IGJlZm9yZSB3ZSBl
eGl0LiBUaGUgYWN0aXZlIGlzIGFjcXVpcmVkIGFnYWluIGZvcgp0aGUgYXN5bmMgb3BlcmF0aW9u
IHRvIGF2b2lkIHRoZSBlYXJseSByZWxlYXNlIChvbiB0aGUgc3VjY2VzcyBwYXRoKS4KCj4gPiAr
ICAgICBpZiAoZXJyKQo+ID4gKyAgICAgICAgICAgICBnb3RvIGVycl91bmxvY2s7Cj4gPiArCj4g
PiArICAgICBpZiAoIShib3VuZCAmIEk5MTVfVk1BX0JJTkRfTUFTSykpIHsKPiA+ICsgICAgICAg
ICAgICAgZXJyID0gaTkxNV92bWFfaW5zZXJ0KHZtYSwgc2l6ZSwgYWxpZ25tZW50LCBmbGFncyk7
Cj4gPiArICAgICAgICAgICAgIGlmIChlcnIpCj4gPiArICAgICAgICAgICAgICAgICAgICAgZ290
byBlcnJfYWN0aXZlOwo+ID4gKwo+ID4gKyAgICAgICAgICAgICBpZiAoaTkxNV9pc19nZ3R0KHZt
YS0+dm0pKQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIF9faTkxNV92bWFfc2V0X21hcF9hbmRf
ZmVuY2VhYmxlKHZtYSk7Cj4gPiArICAgICB9Cj4gPiArCj4gPiArICAgICBHRU1fQlVHX09OKCF2
bWEtPnBhZ2VzKTsKPiA+ICsgICAgIGVyciA9IGk5MTVfdm1hX2JpbmQodm1hLAo+ID4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICB2bWEtPm9iaiA/IHZtYS0+b2JqLT5jYWNoZV9sZXZlbCA6IDAs
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgIGZsYWdzLCB3b3JrKTsKPiA+ICsgICAgIGlm
IChlcnIpCj4gPiArICAgICAgICAgICAgIGdvdG8gZXJyX3JlbW92ZTsKPiA+ICsKPiA+ICsgICAg
IC8qIFRoZXJlIHNob3VsZCBvbmx5IGJlIGF0IG1vc3QgMiBhY3RpdmUgYmluZGluZ3MgKHVzZXIs
IGdsb2JhbCkgKi8KPiAKPiBzL2JpbmRpbmdzL3BpbnMvID8gSSB0aG91Z2h0IG9uZSB2bWEgaXMg
b25lIGJpbmRpbmcgYnkgZGVmaW5pdGlvbi4uIHNvIEkgCj4gYW0gY29uZnVzZWQuCgpPaCBubywg
dGhhdCB3b3VsZCBiZSBmYXIgdG9vIHNpbXBsZS4gT24gZ2VuNi03ICYgYnN3LCB0aGUgdm1hIGlz
IGFsaWFzZWQuCk9uZSB2bWEsIHR3byBiaW5kaW5nIChQSU5fVVNFUiAtPiBnZ3R0LT5hbGlhcywg
UElOX0dMT0JBTCAtPiBnZ3R0KS4KCj4gPiArICAgICBHRU1fQlVHX09OKGJvdW5kICsgSTkxNV9W
TUFfUEFHRVNfQUNUSVZFIDwgYm91bmQpOwo+ID4gKyAgICAgYXRvbWljX2FkZChJOTE1X1ZNQV9Q
QUdFU19BQ1RJVkUsICZ2bWEtPnBhZ2VzX2NvdW50KTsKPiA+ICsgICAgIGxpc3RfbW92ZV90YWls
KCZ2bWEtPnZtX2xpbmssICZ2bWEtPnZtLT5ib3VuZF9saXN0KTsKPiA+ICsKPiA+ICsgICAgIF9f
aTkxNV92bWFfcGluKHZtYSk7Cj4gPiArICAgICBHRU1fQlVHX09OKCFpOTE1X3ZtYV9pc19waW5u
ZWQodm1hKSk7Cj4gPiArICAgICBHRU1fQlVHX09OKCFpOTE1X3ZtYV9pc19ib3VuZCh2bWEsIGZs
YWdzKSk7Cj4gPiAgICAgICBHRU1fQlVHX09OKGk5MTVfdm1hX21pc3BsYWNlZCh2bWEsIHNpemUs
IGFsaWdubWVudCwgZmxhZ3MpKTsKPiA+IC0gICAgIHJldHVybiAwOwo+ID4gICAKPiA+ICAgZXJy
X3JlbW92ZToKPiA+IC0gICAgIGlmICgoYm91bmQgJiBJOTE1X1ZNQV9CSU5EX01BU0spID09IDAp
IHsKPiA+ICsgICAgIGlmICghaTkxNV92bWFfaXNfYm91bmQodm1hLCBJOTE1X1ZNQV9CSU5EX01B
U0spKQo+ID4gICAgICAgICAgICAgICBpOTE1X3ZtYV9yZW1vdmUodm1hKTsKPiA+IC0gICAgICAg
ICAgICAgR0VNX0JVR19PTih2bWEtPnBhZ2VzKTsKPiA+IC0gICAgICAgICAgICAgR0VNX0JVR19P
TihhdG9taWNfcmVhZCgmdm1hLT5mbGFncykgJiBJOTE1X1ZNQV9CSU5EX01BU0spOwo+ID4gLSAg
ICAgfQo+ID4gLWVycl91bnBpbjoKPiA+IC0gICAgIF9faTkxNV92bWFfdW5waW4odm1hKTsKPiA+
IC0gICAgIHJldHVybiByZXQ7Cj4gPiArZXJyX2FjdGl2ZToKPiA+ICsgICAgIGk5MTVfYWN0aXZl
X3JlbGVhc2UoJnZtYS0+YWN0aXZlKTsKPiA+ICtlcnJfdW5sb2NrOgo+ID4gKyAgICAgbXV0ZXhf
dW5sb2NrKCZ2bWEtPnZtLT5tdXRleCk7Cj4gPiArZXJyX2ZlbmNlOgo+ID4gKyAgICAgaWYgKHdv
cmspCj4gPiArICAgICAgICAgICAgIGRtYV9mZW5jZV93b3JrX2NvbW1pdCgmd29yay0+YmFzZSk7
Cj4gPiArZXJyX3BhZ2VzOgo+ID4gKyAgICAgdm1hX3B1dF9wYWdlcyh2bWEpOwo+ID4gKyAgICAg
cmV0dXJuIGVycjsKPiA+ICAgfQoKPiA+ICAgdm9pZCBpOTE1X3ZtYV9wYXJrZWQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiBAQCAtODMxLDEyICsxMDExLDMyIEBAIHZvaWQgaTkx
NV92bWFfcGFya2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICAKPiA+ICAg
ICAgIHNwaW5fbG9ja19pcnEoJmk5MTUtPmd0LmNsb3NlZF9sb2NrKTsKPiA+ICAgICAgIGxpc3Rf
Zm9yX2VhY2hfZW50cnlfc2FmZSh2bWEsIG5leHQsICZpOTE1LT5ndC5jbG9zZWRfdm1hLCBjbG9z
ZWRfbGluaykgewo+ID4gLSAgICAgICAgICAgICBsaXN0X2RlbF9pbml0KCZ2bWEtPmNsb3NlZF9s
aW5rKTsKPiA+ICsgICAgICAgICAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9
IHZtYS0+b2JqOwo+ID4gKyAgICAgICAgICAgICBzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2
bSA9IHZtYS0+dm07Cj4gPiArCj4gPiArICAgICAgICAgICAgIC8qIFhYWCBBbGwgdG8gYXZvaWQg
a2VlcGluZyBhIHJlZmVyZW5jZSBvbiBpOTE1X3ZtYSBpdHNlbGYgKi8KPiAKPiBEb2VzIFhYWCBz
aWduaWZ5IGl0IGlzIGEgdGVtcG9yYXJ5IHN0YXRlIG9mIGNvZGUsIG9yIGp1c3QgbGlrZSBhIGNv
bW1lbnQgCj4gYnV0IG1vcmUgaW1wb3J0YW50IGluIHNvbWUgd2F5PwoKSXQncyBhIGNyaXRpcXVl
IG9mIHRoZSB1Z2x5IGNvZGUgKHRoZSBjb21tZW50IHlvdSBhc2tlZCBmb3IgYmVmb3JlKSB0aGF0
CmlzIHJlcXVpcmVkIGJlY2F1c2UgSSBkaWRuJ3Qgd2FudCB0byBoYXZlIHRvIHRocm93IGF3YXkg
dGhlIGVudGlyZSBsbWVtCm9iamVjdCBoYW5kbGluZyBjb2RlLgoKPiA+IEBAIC05NzYsNyArOTc3
LDYgQEAgc3RhdGljIGludCBpZ3Rfdm1hX3JlbWFwcGVkX2d0dCh2b2lkICphcmcpCj4gPiAgIAo+
ID4gICBvdXQ6Cj4gPiAgICAgICBpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGltZV9w
bSwgd2FrZXJlZik7Cj4gPiAtICAgICBtdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwo+ID4gICAgICAgaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOwo+ID4gICAKPiA+ICAgICAg
IHJldHVybiBlcnI7Cj4gPiAKPiAKPiBJbiBnZW5lcmFsLCBldmVuIHdoZW4gSSBkaWQgbm90IGV4
cGxpY2l0bHkgYXNrZWQgZm9yIGEgY29tbWVudCwgcGxhY2VzIAo+IHdoZXJlIHRoaW5ncyB3ZXJl
bid0IGNsZWFyIHRvIG1lIHNob3VsZCBiZSBjb25zaWRlcmVkIHRvIGhhdmUgdGhlbSBhZGRlZCAK
PiBhbmQgcHJvYmFibHkgbW9yZS4KCkhvdyBlbHNlIGRvIEkga25vdyB3aGF0IGlzbid0IGNsZWFy
IHRvIHlvdS4uLiA7KQotQ2hyaXMKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRl
c2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8v
aW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id F31861792B
	for <lists+intel-gfx@lfdr.de>; Wed,  8 May 2019 14:11:31 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8F44B89933;
	Wed,  8 May 2019 12:11:27 +0000 (UTC)
X-Original-To: Intel-gfx@lists.freedesktop.org
Delivered-To: Intel-gfx@lists.freedesktop.org
Received: from mga17.intel.com (mga17.intel.com [192.55.52.151])
 by gabe.freedesktop.org (Postfix) with ESMTPS id D193189907;
 Wed,  8 May 2019 12:11:25 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga008.fm.intel.com ([10.253.24.58])
 by fmsmga107.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 08 May 2019 05:11:25 -0700
X-ExtLoop1: 1
Received: from jzapadkx-mobl1.ger.corp.intel.com (HELO localhost.localdomain)
 ([10.252.0.159])
 by fmsmga008.fm.intel.com with ESMTP; 08 May 2019 05:11:24 -0700
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
To: igt-dev@lists.freedesktop.org
Date: Wed,  8 May 2019 13:10:57 +0100
Message-Id: <20190508121058.27038-21-tvrtko.ursulin@linux.intel.com>
X-Mailer: git-send-email 2.19.1
In-Reply-To: <20190508121058.27038-1-tvrtko.ursulin@linux.intel.com>
References: <20190508121058.27038-1-tvrtko.ursulin@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t 20/21] gem_wsim: Allow RCS virtual engine
 with SSEU control
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Intel-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KClRvIGFsbG93
IGV4ZXJjaXNpbmcgdGhlIFNTRVUgY29uZmlndXJhdGlvbiBpbiBjb21iaW5hdGlvbiB3aXRoIFZp
cnR1YWwKRW5naW5lLCBhbGxvdyBSQ1MgdG8gYmUgc3BlY2lmaWVkIGluIHRoZSBlbmdpbmUgbWFw
IGFuZCB1c2UgYXBwcm9wcmlhdGUKaW5kZXggYmFzZWQgYWRkcmVzc2luZyB3aGVuIGFwcGx5aW5n
IFNTRVUgY29uZmlndXJhdGlvbiB0byBpdC4KClNpZ25lZC1vZmYtYnk6IFR2cnRrbyBVcnN1bGlu
IDx0dnJ0a28udXJzdWxpbkBpbnRlbC5jb20+Ci0tLQogYmVuY2htYXJrcy9nZW1fd3NpbS5jIHwg
NTEgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLQogMSBmaWxlIGNo
YW5nZWQsIDM2IGluc2VydGlvbnMoKyksIDE1IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2Jl
bmNobWFya3MvZ2VtX3dzaW0uYyBiL2JlbmNobWFya3MvZ2VtX3dzaW0uYwppbmRleCBlZDVhY2Vl
MDJlMjAuLjc5OTBhYjQxZjZmYSAxMDA2NDQKLS0tIGEvYmVuY2htYXJrcy9nZW1fd3NpbS5jCisr
KyBiL2JlbmNobWFya3MvZ2VtX3dzaW0uYwpAQCAtMzgxLDcgKzM4MSw3IEBAIHN0YXRpYyBpbnQg
cGFyc2VfZW5naW5lX21hcChzdHJ1Y3Qgd19zdGVwICpzdGVwLCBjb25zdCBjaGFyICpfc3RyKQog
CQlpZiAoKGludCllbmdpbmUgPCAwKQogCQkJcmV0dXJuIC0xOwogCi0JCWlmIChlbmdpbmUgIT0g
VkNTMSAmJiBlbmdpbmUgIT0gVkNTMikKKwkJaWYgKGVuZ2luZSAhPSBWQ1MxICYmIGVuZ2luZSAh
PSBWQ1MyICYmIGVuZ2luZSAhPSBSQ1MpCiAJCQlyZXR1cm4gLTE7IC8qIFRPRE8gKi8KIAogCQlz
dGVwLT5lbmdpbmVfbWFwX2NvdW50Kys7CkBAIC0xMDk3LDcgKzEwOTcsNyBAQCBzdGF0aWMgdm9p
ZCBfX2N0eF9zZXRfcHJpbyh1aW50MzJfdCBjdHhfaWQsIHVuc2lnbmVkIGludCBwcmlvKQogfQog
CiBzdGF0aWMgdWludDY0X3QKLXNldF9jdHhfc3NldSh1aW50MzJfdCBjdHgsIHVpbnQ2NF90IHNs
aWNlX21hc2spCitzZXRfY3R4X3NzZXUoc3RydWN0IGN0eCAqY3R4LCB1aW50NjRfdCBzbGljZV9t
YXNrKQogewogCXN0cnVjdCBkcm1faTkxNV9nZW1fY29udGV4dF9wYXJhbV9zc2V1IHNzZXUgPSBk
ZXZpY2Vfc3NldTsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2NvbnRleHRfcGFyYW0gcGFyYW0gPSB7
IH07CkBAIC0xMTA1LDEwICsxMTA1LDE3IEBAIHNldF9jdHhfc3NldSh1aW50MzJfdCBjdHgsIHVp
bnQ2NF90IHNsaWNlX21hc2spCiAJaWYgKHNsaWNlX21hc2sgPT0gLTEpCiAJCXNsaWNlX21hc2sg
PSBkZXZpY2Vfc3NldS5zbGljZV9tYXNrOwogCisJaWYgKGN0eC0+ZW5naW5lX21hcCAmJiBjdHgt
PndhbnRzX2JhbGFuY2UpIHsKKwkJc3NldS5mbGFncyA9IEk5MTVfQ09OVEVYVF9TU0VVX0ZMQUdf
RU5HSU5FX0lOREVYOworCQlzc2V1LmVuZ2luZS5lbmdpbmVfY2xhc3MgPSBJOTE1X0VOR0lORV9D
TEFTU19JTlZBTElEOworCQlzc2V1LmVuZ2luZS5lbmdpbmVfaW5zdGFuY2UgPSAwOworCX0KKwog
CXNzZXUuc2xpY2VfbWFzayA9IHNsaWNlX21hc2s7CiAKLQlwYXJhbS5jdHhfaWQgPSBjdHg7CisJ
cGFyYW0uY3R4X2lkID0gY3R4LT5pZDsKIAlwYXJhbS5wYXJhbSA9IEk5MTVfQ09OVEVYVF9QQVJB
TV9TU0VVOworCXBhcmFtLnNpemUgPSBzaXplb2Yoc3NldSk7CiAJcGFyYW0udmFsdWUgPSAodWlu
dHB0cl90KSZzc2V1OwogCiAJZ2VtX2NvbnRleHRfc2V0X3BhcmFtKGZkLCAmcGFyYW0pOwpAQCAt
MTM3NywxMCArMTM4NCwxNyBAQCBwcmVwYXJlX3dvcmtsb2FkKHVuc2lnbmVkIGludCBpZCwgc3Ry
dWN0IHdvcmtsb2FkICp3cmssIHVuc2lnbmVkIGludCBmbGFncykKIAkJCQkJY3R4LT5lbmdpbmVf
bWFwX2NvdW50OwogCiAJCQkJZm9yIChqID0gMDsgaiA8IGN0eC0+ZW5naW5lX21hcF9jb3VudDsg
aisrKSB7Ci0JCQkJCWxvYWRfYmFsYW5jZS5lbmdpbmVzW2pdLmVuZ2luZV9jbGFzcyA9Ci0JCQkJ
CQlJOTE1X0VOR0lORV9DTEFTU19WSURFTzsgLyogRklYTUUgKi8KLQkJCQkJbG9hZF9iYWxhbmNl
LmVuZ2luZXNbal0uZW5naW5lX2luc3RhbmNlID0KLQkJCQkJCWN0eC0+ZW5naW5lX21hcFtqXSAt
IFZDUzE7IC8qIEZJWE1FICovCisJCQkJCWlmIChjdHgtPmVuZ2luZV9tYXBbal0gPT0gUkNTKSB7
CisJCQkJCQlsb2FkX2JhbGFuY2UuZW5naW5lc1tqXS5lbmdpbmVfY2xhc3MgPQorCQkJCQkJCUk5
MTVfRU5HSU5FX0NMQVNTX1JFTkRFUjsKKwkJCQkJCWxvYWRfYmFsYW5jZS5lbmdpbmVzW2pdLmVu
Z2luZV9pbnN0YW5jZSA9CisJCQkJCQkJMDsgLyogRklYTUUgKi8KKwkJCQkJfSBlbHNlIHsKKwkJ
CQkJCWxvYWRfYmFsYW5jZS5lbmdpbmVzW2pdLmVuZ2luZV9jbGFzcyA9CisJCQkJCQkJSTkxNV9F
TkdJTkVfQ0xBU1NfVklERU87IC8qIEZJWE1FICovCisJCQkJCQlsb2FkX2JhbGFuY2UuZW5naW5l
c1tqXS5lbmdpbmVfaW5zdGFuY2UgPQorCQkJCQkJCWN0eC0+ZW5naW5lX21hcFtqXSAtIFZDUzE7
IC8qIEZJWE1FICovCisJCQkJCX0KIAkJCQl9CiAJCQl9IGVsc2UgewogCQkJCXNldF9lbmdpbmVz
LmV4dGVuc2lvbnMgPSAwOwpAQCAtMTM5MywxMCArMTQwNywxNiBAQCBwcmVwYXJlX3dvcmtsb2Fk
KHVuc2lnbmVkIGludCBpZCwgc3RydWN0IHdvcmtsb2FkICp3cmssIHVuc2lnbmVkIGludCBmbGFn
cykKIAkJCQlJOTE1X0VOR0lORV9DTEFTU19JTlZBTElEX05PTkU7CiAKIAkJCWZvciAoaiA9IDE7
IGogPD0gY3R4LT5lbmdpbmVfbWFwX2NvdW50OyBqKyspIHsKLQkJCQlzZXRfZW5naW5lcy5lbmdp
bmVzW2pdLmVuZ2luZV9jbGFzcyA9Ci0JCQkJCUk5MTVfRU5HSU5FX0NMQVNTX1ZJREVPOyAvKiBG
SVhNRSAqLwotCQkJCXNldF9lbmdpbmVzLmVuZ2luZXNbal0uZW5naW5lX2luc3RhbmNlID0KLQkJ
CQkJY3R4LT5lbmdpbmVfbWFwW2ogLSAxXSAtIFZDUzE7IC8qIEZJWE1FICovCisJCQkJaWYgKGN0
eC0+ZW5naW5lX21hcFtqIC0gMV0gPT0gUkNTKSB7CisJCQkJCXNldF9lbmdpbmVzLmVuZ2luZXNb
al0uZW5naW5lX2NsYXNzID0KKwkJCQkJCUk5MTVfRU5HSU5FX0NMQVNTX1JFTkRFUjsKKwkJCQkJ
c2V0X2VuZ2luZXMuZW5naW5lc1tqXS5lbmdpbmVfaW5zdGFuY2UgPSAwOyAvKiBGSVhNRSAqLwor
CQkJCX0gZWxzZSB7CisJCQkJCXNldF9lbmdpbmVzLmVuZ2luZXNbal0uZW5naW5lX2NsYXNzID0K
KwkJCQkJCUk5MTVfRU5HSU5FX0NMQVNTX1ZJREVPOyAvKiBGSVhNRSAqLworCQkJCQlzZXRfZW5n
aW5lcy5lbmdpbmVzW2pdLmVuZ2luZV9pbnN0YW5jZSA9CisJCQkJCQljdHgtPmVuZ2luZV9tYXBb
aiAtIDFdIC0gVkNTMTsgLyogRklYTUUgKi8KKwkJCQl9CiAJCQl9CiAKIAkJCWZvciAoaiA9IDA7
IGogPCBjdHgtPmJvbmRfY291bnQ7IGorKykgewpAQCAtMTQ2Nyw3ICsxNDg3LDcgQEAgcHJlcGFy
ZV93b3JrbG9hZCh1bnNpZ25lZCBpbnQgaWQsIHN0cnVjdCB3b3JrbG9hZCAqd3JrLCB1bnNpZ25l
ZCBpbnQgZmxhZ3MpCiAKIAkJaWYgKHdyay0+c3NldSkgewogCQkJLyogU2V0IHRvIHNsaWNlIDAg
b25seSwgb25lIHNsaWNlLiAqLwotCQkJY3R4LT5zc2V1ID0gc2V0X2N0eF9zc2V1KGN0eF9pZCwg
MSk7CisJCQljdHgtPnNzZXUgPSBzZXRfY3R4X3NzZXUoY3R4LCAxKTsKIAkJfQogCX0KIApAQCAt
MjQzOCw5ICsyNDU4LDkgQEAgc3RhdGljIHZvaWQgKnJ1bl93b3JrbG9hZCh2b2lkICpkYXRhKQog
CQkJCSAgIHctPnR5cGUgPT0gQk9ORCkgewogCQkJCWNvbnRpbnVlOwogCQkJfSBlbHNlIGlmICh3
LT50eXBlID09IFNTRVUpIHsKLQkJCQlpZiAody0+c3NldSAhPSB3cmstPmN0eF9saXN0W3ctPmNv
bnRleHRdLnNzZXUpIHsKLQkJCQkJd3JrLT5jdHhfbGlzdFt3LT5jb250ZXh0XS5zc2V1ID0KLQkJ
CQkJCXNldF9jdHhfc3NldSh3cmstPmN0eF9saXN0W3ctPmNvbnRleHRdLmlkLAorCQkJCWlmICh3
LT5zc2V1ICE9IHdyay0+Y3R4X2xpc3Rbdy0+Y29udGV4dCAqIDJdLnNzZXUpIHsKKwkJCQkJd3Jr
LT5jdHhfbGlzdFt3LT5jb250ZXh0ICogMl0uc3NldSA9CisJCQkJCQlzZXRfY3R4X3NzZXUoJndy
ay0+Y3R4X2xpc3Rbdy0+Y29udGV4dCAqIDJdLAogCQkJCQkJCSAgICAgdy0+c3NldSk7CiAJCQkJ
fQogCQkJCWNvbnRpbnVlOwpAQCAtMjc2Niw2ICsyNzg2LDcgQEAgc3RhdGljIHZvaWQgZ2V0X2Rl
dmljZV9zc2V1KHZvaWQpCiAKIAlwYXJhbS5wYXJhbSA9IEk5MTVfQ09OVEVYVF9QQVJBTV9TU0VV
OwogCXBhcmFtLnZhbHVlID0gKHVpbnRwdHJfdCkmZGV2aWNlX3NzZXU7CisJcGFyYW0uc2l6ZSA9
IHNpemVvZihkZXZpY2Vfc3NldSk7CiAKIAlnZW1fY29udGV4dF9nZXRfcGFyYW0oZmQsICZwYXJh
bSk7CiB9Ci0tIAoyLjE5LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNr
dG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2lu
dGVsLWdmeA==

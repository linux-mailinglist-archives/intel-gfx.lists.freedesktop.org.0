Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 91850F6AF1
	for <lists+intel-gfx@lfdr.de>; Sun, 10 Nov 2019 19:58:34 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 72D0E6E79F;
	Sun, 10 Nov 2019 18:58:32 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 09DD26E0C8
 for <intel-gfx@lists.freedesktop.org>; Sun, 10 Nov 2019 18:58:26 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19151905-1500050 
 for multiple; Sun, 10 Nov 2019 18:58:14 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Sun, 10 Nov 2019 18:58:06 +0000
Message-Id: <20191110185806.17413-25-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191110185806.17413-1-chris@chris-wilson.co.uk>
References: <20191110185806.17413-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 25/25] drm/i915/gt: Pull GT initialisation under
 intel_gt_init()
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QmVnaW4gcHVsbGluZyB0aGUgR1Qgc2V0dXAgdW5kZXJuZWF0aCBhIHNpbmdsZSBHVCB1bWJyZWxs
YTsgbGV0IGludGVsX2d0CnRha2Ugb3duZXJzaGlwIG9mIGl0cyBlbmdpbmVzISBBcyBoaW50ZWQs
IHRoZSBjb21wbGljYXRpb24gaXMgdGhlCmxpZmV0aW1lIG9mIHRoZSBwcm9iZWQgZW5naW5lIHZl
cnN1cyB0aGUgYWN0aXZlIGxpZmV0aW1lIG9mIHRoZSBHVApiYWNrZW5kcy4gV2UgbmVlZCB0byBk
ZXRlY3QgdGhlIGVuZ2luZSBsYXlvdXQgZWFybHkgYW5kIGtlZXAgaXQgdW50aWwKdGhlIGVuZCBz
byB0aGF0IHdlIGNhbiBzYW5pdGl6ZSBzdGF0ZSBvbiB0YWtlb3ZlciBhbmQgcmVsZWFzZS4KClNp
Z25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgotLS0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfb3ZlcmxheS5jICB8ICAgNiArLQog
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lLmggICAgICAgIHwgICA4ICstCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYyAgICAgfCAgNDIgKystLQog
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmggIHwgIDE1ICstCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5jICAgICAgICAgICAgfCAyMzAgKysrKysr
KysrKysrKysrKystCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyAgICAgICAg
ICAgfCAgMTcgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMgICAgICAg
ICB8ICAgOSArLQogLi4uL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nX3N1Ym1pc3Npb24uYyAg
IHwgIDE0ICstCiAuLi4vZ3B1L2RybS9pOTE1L2d0L2ludGVsX3RpbWVsaW5lX3R5cGVzLmggICAg
fCAgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L21vY2tfZW5naW5lLmMgICAgICAgICB8
ICAxNiArLQogLi4uL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfc3VibWlzc2lvbi5jIHwg
ICA5ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jICAgICAgICAgICAgICAgfCAg
IDEgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyAgICAgICAgICAgICAgIHwgMjI4
ICstLS0tLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9n
ZW0uYyAgICAgfCAgIDEgKwogMTQgZmlsZXMgY2hhbmdlZCwgMzAyIGluc2VydGlvbnMoKyksIDI5
OCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX292ZXJsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfb3Zl
cmxheS5jCmluZGV4IDhjZmI3ODVlNzYxYy4uOTczMDI2ZjBjNzE3IDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX292ZXJsYXkuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX292ZXJsYXkuYwpAQCAtMTMyNiwxMiArMTMyNiwxNCBA
QCBzdGF0aWMgaW50IGdldF9yZWdpc3RlcnMoc3RydWN0IGludGVsX292ZXJsYXkgKm92ZXJsYXks
IGJvb2wgdXNlX3BoeXMpCiB2b2lkIGludGVsX292ZXJsYXlfc2V0dXAoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQogewogCXN0cnVjdCBpbnRlbF9vdmVybGF5ICpvdmVybGF5Owor
CXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKIAlpbnQgcmV0OwogCiAJaWYgKCFIQVNf
T1ZFUkxBWShkZXZfcHJpdikpCiAJCXJldHVybjsKIAotCWlmICghSEFTX0VOR0lORShkZXZfcHJp
diwgUkNTMCkpCisJZW5naW5lID0gZGV2X3ByaXYtPmVuZ2luZVtSQ1MwXTsKKwlpZiAoIWVuZ2lu
ZSB8fCAhZW5naW5lLT5rZXJuZWxfY29udGV4dCkKIAkJcmV0dXJuOwogCiAJb3ZlcmxheSA9IGt6
YWxsb2Moc2l6ZW9mKCpvdmVybGF5KSwgR0ZQX0tFUk5FTCk7CkBAIC0xMzM5LDcgKzEzNDEsNyBA
QCB2b2lkIGludGVsX292ZXJsYXlfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQogCQlyZXR1cm47CiAKIAlvdmVybGF5LT5pOTE1ID0gZGV2X3ByaXY7Ci0Jb3ZlcmxheS0+
Y29udGV4dCA9IGRldl9wcml2LT5lbmdpbmVbUkNTMF0tPmtlcm5lbF9jb250ZXh0OworCW92ZXJs
YXktPmNvbnRleHQgPSBlbmdpbmUtPmtlcm5lbF9jb250ZXh0OwogCUdFTV9CVUdfT04oIW92ZXJs
YXktPmNvbnRleHQpOwogCiAJb3ZlcmxheS0+Y29sb3Jfa2V5ID0gMHgwMTAxZmU7CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaCBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oCmluZGV4IGJjM2I3MmJmYTllMy4uODMzZGRiZTUw
MWMxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaAor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaApAQCAtMTgxLDcgKzE4
MSw5IEBAIHZvaWQgaW50ZWxfZW5naW5lX2NsZWFudXAoc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lKTsKIGludCBpbnRlbF9lbmdpbmVzX2luaXRfbW1pbyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0
KTsKIGludCBpbnRlbF9lbmdpbmVzX3NldHVwKHN0cnVjdCBpbnRlbF9ndCAqZ3QpOwogaW50IGlu
dGVsX2VuZ2luZXNfaW5pdChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKLXZvaWQgaW50ZWxfZW5naW5l
c19jbGVhbnVwKHN0cnVjdCBpbnRlbF9ndCAqZ3QpOworCit2b2lkIGludGVsX2VuZ2luZXNfcmVs
ZWFzZShzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKK3ZvaWQgaW50ZWxfZW5naW5lc19mcmVlKHN0cnVj
dCBpbnRlbF9ndCAqZ3QpOwogCiBpbnQgaW50ZWxfZW5naW5lX2luaXRfY29tbW9uKHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7CiB2b2lkIGludGVsX2VuZ2luZV9jbGVhbnVwX2NvbW1v
bihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpOwpAQCAtMjcyLDggKzI3NCw4IEBAIGdl
bjhfZW1pdF9nZ3R0X3dyaXRlKHUzMiAqY3MsIHUzMiB2YWx1ZSwgdTMyIGd0dF9vZmZzZXQsIHUz
MiBmbGFncykKIHN0YXRpYyBpbmxpbmUgdm9pZCBfX2ludGVsX2VuZ2luZV9yZXNldChzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUsCiAJCQkJCWJvb2wgc3RhbGxlZCkKIHsKLQlpZiAoZW5n
aW5lLT5yZXNldC5yZXNldCkKLQkJZW5naW5lLT5yZXNldC5yZXNldChlbmdpbmUsIHN0YWxsZWQp
OworCWlmIChlbmdpbmUtPnJlc2V0LnJld2luZCkKKwkJZW5naW5lLT5yZXNldC5yZXdpbmQoZW5n
aW5lLCBzdGFsbGVkKTsKIAllbmdpbmUtPnNlcmlhbCsrOyAvKiBjb250ZXh0cyBsb3N0ICovCiB9
CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKaW5kZXggYTI3YjIy
OTE0ZmIyLi5jNGMwMGIwMWY0NWUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2VuZ2luZV9jcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2Vu
Z2luZV9jcy5jCkBAIC0zMTgsMTIgKzMxOCw2IEBAIHN0YXRpYyBpbnQgaW50ZWxfZW5naW5lX3Nl
dHVwKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGVudW0gaW50ZWxfZW5naW5lX2lkIGlkKQogCWVuZ2lu
ZS0+cHJvcHMudGltZXNsaWNlX2R1cmF0aW9uX21zID0KIAkJQ09ORklHX0RSTV9JOTE1X1RJTUVT
TElDRV9EVVJBVElPTjsKIAotCS8qCi0JICogVG8gYmUgb3ZlcnJpZGRlbiBieSB0aGUgYmFja2Vu
ZCBvbiBzZXR1cC4gSG93ZXZlciB0byBmYWNpbGl0YXRlCi0JICogY2xlYW51cCBvbiBlcnJvciBk
dXJpbmcgc2V0dXAsIHdlIGFsd2F5cyBwcm92aWRlIHRoZSBkZXN0cm95IHZmdW5jLgotCSAqLwot
CWVuZ2luZS0+ZGVzdHJveSA9ICh0eXBlb2YoZW5naW5lLT5kZXN0cm95KSlrZnJlZTsKLQogCWVu
Z2luZS0+Y29udGV4dF9zaXplID0gaW50ZWxfZW5naW5lX2NvbnRleHRfc2l6ZShndC0+aTkxNSwK
IAkJCQkJCQkgZW5naW5lLT5jbGFzcyk7CiAJaWYgKFdBUk5fT04oZW5naW5lLT5jb250ZXh0X3Np
emUgPiBCSVQoMjApKSkKQEAgLTM4OSwyMSArMzgzLDM5IEBAIHN0YXRpYyB2b2lkIGludGVsX3Nl
dHVwX2VuZ2luZV9jYXBhYmlsaXRpZXMoc3RydWN0IGludGVsX2d0ICpndCkKIH0KIAogLyoqCi0g
KiBpbnRlbF9lbmdpbmVzX2NsZWFudXAoKSAtIGZyZWUgdGhlIHJlc291cmNlcyBhbGxvY2F0ZWQg
Zm9yIENvbW1hbmQgU3RyZWFtZXJzCisgKiBpbnRlbF9lbmdpbmVzX3JlbGVhc2UoKSAtIGZyZWUg
dGhlIHJlc291cmNlcyBhbGxvY2F0ZWQgZm9yIENvbW1hbmQgU3RyZWFtZXJzCiAgKiBAZ3Q6IHBv
aW50ZXIgdG8gc3RydWN0IGludGVsX2d0CiAgKi8KLXZvaWQgaW50ZWxfZW5naW5lc19jbGVhbnVw
KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCit2b2lkIGludGVsX2VuZ2luZXNfcmVsZWFzZShzdHJ1Y3Qg
aW50ZWxfZ3QgKmd0KQogewogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKIAllbnVt
IGludGVsX2VuZ2luZV9pZCBpZDsKIAorCS8qIERlY291cGxlIHRoZSBiYWNrZW5kOyBidXQga2Vl
cCB0aGUgbGF5b3V0IGZvciBsYXRlIEdQVSByZXNldHMgKi8KIAlmb3JfZWFjaF9lbmdpbmUoZW5n
aW5lLCBndCwgaWQpIHsKLQkJZW5naW5lLT5kZXN0cm95KGVuZ2luZSk7Ci0JCWd0LT5lbmdpbmVb
aWRdID0gTlVMTDsKKwkJaWYgKCFlbmdpbmUtPnJlbGVhc2UpCisJCQljb250aW51ZTsKKworCQll
bmdpbmUtPnJlbGVhc2UoZW5naW5lKTsKKwkJZW5naW5lLT5yZWxlYXNlID0gTlVMTDsKKworCQlt
ZW1zZXQoJmVuZ2luZS0+cmVzZXQsIDAsIHNpemVvZihlbmdpbmUtPnJlc2V0KSk7CisKIAkJZ3Qt
Pmk5MTUtPmVuZ2luZVtpZF0gPSBOVUxMOwogCX0KIH0KIAordm9pZCBpbnRlbF9lbmdpbmVzX2Zy
ZWUoc3RydWN0IGludGVsX2d0ICpndCkKK3sKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmU7CisJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CisKKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5l
LCBndCwgaWQpIHsKKwkJa2ZyZWUoZW5naW5lKTsKKwkJZ3QtPmVuZ2luZVtpZF0gPSBOVUxMOwor
CX0KK30KKwogLyoqCiAgKiBpbnRlbF9lbmdpbmVzX2luaXRfbW1pbygpIC0gYWxsb2NhdGUgYW5k
IHByZXBhcmUgdGhlIEVuZ2luZSBDb21tYW5kIFN0cmVhbWVycwogICogQGd0OiBwb2ludGVyIHRv
IHN0cnVjdCBpbnRlbF9ndApAQCAtNDU0LDcgKzQ2Niw3IEBAIGludCBpbnRlbF9lbmdpbmVzX2lu
aXRfbW1pbyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogCXJldHVybiAwOwogCiBjbGVhbnVwOgotCWlu
dGVsX2VuZ2luZXNfY2xlYW51cChndCk7CisJaW50ZWxfZW5naW5lc19mcmVlKGd0KTsKIAlyZXR1
cm4gZXJyOwogfQogCkBAIC00ODcsNyArNDk5LDcgQEAgaW50IGludGVsX2VuZ2luZXNfaW5pdChz
dHJ1Y3QgaW50ZWxfZ3QgKmd0KQogCXJldHVybiAwOwogCiBjbGVhbnVwOgotCWludGVsX2VuZ2lu
ZXNfY2xlYW51cChndCk7CisJaW50ZWxfZW5naW5lc19yZWxlYXNlKGd0KTsKIAlyZXR1cm4gZXJy
OwogfQogCkBAIC02NjEsMTYgKzY3MywxMyBAQCBpbnQgaW50ZWxfZW5naW5lc19zZXR1cChzdHJ1
Y3QgaW50ZWxfZ3QgKmd0KQogCQlpZiAoZXJyKQogCQkJZ290byBjbGVhbnVwOwogCi0JCS8qIFdl
IGV4cGVjdCB0aGUgYmFja2VuZCB0byB0YWtlIGNvbnRyb2wgb3ZlciBpdHMgc3RhdGUgKi8KLQkJ
R0VNX0JVR19PTihlbmdpbmUtPmRlc3Ryb3kgPT0gKHR5cGVvZihlbmdpbmUtPmRlc3Ryb3kpKWtm
cmVlKTsKLQogCQlHRU1fQlVHX09OKCFlbmdpbmUtPmNvcHMpOwogCX0KIAogCXJldHVybiAwOwog
CiBjbGVhbnVwOgotCWludGVsX2VuZ2luZXNfY2xlYW51cChndCk7CisJaW50ZWxfZW5naW5lc19y
ZWxlYXNlKGd0KTsKIAlyZXR1cm4gZXJyOwogfQogCkBAIC04MzEsNiArODQwLDcgQEAgaW50IGlu
dGVsX2VuZ2luZV9pbml0X2NvbW1vbihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB2
b2lkIGludGVsX2VuZ2luZV9jbGVhbnVwX2NvbW1vbihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUpCiB7CiAJR0VNX0JVR19PTighbGlzdF9lbXB0eSgmZW5naW5lLT5hY3RpdmUucmVxdWVz
dHMpKTsKKwl0YXNrbGV0X2tpbGwoJmVuZ2luZS0+ZXhlY2xpc3RzLnRhc2tsZXQpOyAvKiBmbHVz
aCB0aGUgY2FsbGJhY2sgKi8KIAogCWNsZWFudXBfc3RhdHVzX3BhZ2UoZW5naW5lKTsKIApkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmggYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaAppbmRleCBjNWQxMDQ3
YTRiYzUuLjZiZGNhM2U3YWU5ZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfZW5naW5lX3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
ZW5naW5lX3R5cGVzLmgKQEAgLTM4OSw3ICszODksMTAgQEAgc3RydWN0IGludGVsX2VuZ2luZV9j
cyB7CiAKIAlzdHJ1Y3QgewogCQl2b2lkICgqcHJlcGFyZSkoc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lKTsKLQkJdm9pZCAoKnJlc2V0KShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUsIGJvb2wgc3RhbGxlZCk7CisKKwkJdm9pZCAoKnJld2luZCkoc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lLCBib29sIHN0YWxsZWQpOworCQl2b2lkICgqY2FuY2VsKShzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUpOworCiAJCXZvaWQgKCpmaW5pc2gpKHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSk7CiAJfSByZXNldDsKIApAQCAtNDM5LDE1ICs0NDIsNyBAQCBzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzIHsKIAl2b2lkCQkoKnNjaGVkdWxlKShzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpyZXF1ZXN0LAogCQkJCSAgICBjb25zdCBzdHJ1Y3QgaTkxNV9zY2hlZF9hdHRyICphdHRy
KTsKIAotCS8qCi0JICogQ2FuY2VsIGFsbCByZXF1ZXN0cyBvbiB0aGUgaGFyZHdhcmUsIG9yIHF1
ZXVlZCBmb3IgZXhlY3V0aW9uLgotCSAqIFRoaXMgc2hvdWxkIG9ubHkgY2FuY2VsIHRoZSByZWFk
eSByZXF1ZXN0cyB0aGF0IGhhdmUgYmVlbgotCSAqIHN1Ym1pdHRlZCB0byB0aGUgZW5naW5lICh2
aWEgdGhlIGVuZ2luZS0+c3VibWl0X3JlcXVlc3QgY2FsbGJhY2spLgotCSAqIFRoaXMgaXMgY2Fs
bGVkIHdoZW4gbWFya2luZyB0aGUgZGV2aWNlIGFzIHdlZGdlZC4KLQkgKi8KLQl2b2lkCQkoKmNh
bmNlbF9yZXF1ZXN0cykoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKLQotCXZvaWQJ
CSgqZGVzdHJveSkoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKKwl2b2lkCQkoKnJl
bGVhc2UpKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7CiAKIAlzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2V4ZWNsaXN0cyBleGVjbGlzdHM7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2d0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5j
CmluZGV4IDRjMDc4MjQ3ODI1ZC4uZDYyYjFmMThiYzU2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2d0LmMKQEAgLTQsMTEgKzQsMTMgQEAKICAqLwogCiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIK
KyNpbmNsdWRlICJpbnRlbF9jb250ZXh0LmgiCiAjaW5jbHVkZSAiaW50ZWxfZ3QuaCIKICNpbmNs
dWRlICJpbnRlbF9ndF9wbS5oIgogI2luY2x1ZGUgImludGVsX2d0X3JlcXVlc3RzLmgiCiAjaW5j
bHVkZSAiaW50ZWxfbW9jcy5oIgogI2luY2x1ZGUgImludGVsX3JjNi5oIgorI2luY2x1ZGUgImlu
dGVsX3JlbmRlcnN0YXRlLmgiCiAjaW5jbHVkZSAiaW50ZWxfcnBzLmgiCiAjaW5jbHVkZSAiaW50
ZWxfdW5jb3JlLmgiCiAjaW5jbHVkZSAiaW50ZWxfcG0uaCIKQEAgLTM3MiwzMiArMzc0LDI0OSBA
QCBzdGF0aWMgc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqa2VybmVsX3ZtKHN0cnVjdCBpbnRl
bF9ndCAqZ3QpCiAJCXJldHVybiBpOTE1X3ZtX2dldCgmZ3QtPmdndHQtPnZtKTsKIH0KIAorc3Rh
dGljIGludCBfX2VuZ2luZXNfcmVjb3JkX2RlZmF1bHRzKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCit7
CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdHNbSTkxNV9OVU1fRU5HSU5FU10gPSB7fTsK
KwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CisJZW51bSBpbnRlbF9lbmdpbmVfaWQg
aWQ7CisJaW50IGVyciA9IDA7CisKKwkvKgorCSAqIEFzIHdlIHJlc2V0IHRoZSBncHUgZHVyaW5n
IHZlcnkgZWFybHkgc2FuaXRpc2F0aW9uLCB0aGUgY3VycmVudAorCSAqIHJlZ2lzdGVyIHN0YXRl
IG9uIHRoZSBHUFUgc2hvdWxkIHJlZmxlY3QgaXRzIGRlZmF1bHRzIHZhbHVlcy4KKwkgKiBXZSBs
b2FkIGEgY29udGV4dCBvbnRvIHRoZSBodyAod2l0aCByZXN0b3JlLWluaGliaXQpLCB0aGVuIHN3
aXRjaAorCSAqIG92ZXIgdG8gYSBzZWNvbmQgY29udGV4dCB0byBzYXZlIHRoYXQgZGVmYXVsdCBy
ZWdpc3RlciBzdGF0ZS4gV2UKKwkgKiBjYW4gdGhlbiBwcmltZSBldmVyeSBuZXcgY29udGV4dCB3
aXRoIHRoYXQgc3RhdGUgc28gdGhleSBhbGwgc3RhcnQKKwkgKiBmcm9tIHRoZSBzYW1lIGRlZmF1
bHQgSFcgdmFsdWVzLgorCSAqLworCisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7
CisJCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsKKwkJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7
CisKKwkJLyogV2UgbXVzdCBiZSBhYmxlIHRvIHN3aXRjaCB0byBzb21ldGhpbmchICovCisJCUdF
TV9CVUdfT04oIWVuZ2luZS0+a2VybmVsX2NvbnRleHQpOworCQllbmdpbmUtPnNlcmlhbCsrOyAv
KiBmb3JjZSB0aGUga2VybmVsIGNvbnRleHQgc3dpdGNoICovCisKKwkJY2UgPSBpbnRlbF9jb250
ZXh0X2NyZWF0ZShlbmdpbmUpOworCQlpZiAoSVNfRVJSKGNlKSkgeworCQkJZXJyID0gUFRSX0VS
UihjZSk7CisJCQlnb3RvIG91dDsKKwkJfQorCisJCXJxID0gaW50ZWxfY29udGV4dF9jcmVhdGVf
cmVxdWVzdChjZSk7CisJCWlmIChJU19FUlIocnEpKSB7CisJCQllcnIgPSBQVFJfRVJSKHJxKTsK
KwkJCWludGVsX2NvbnRleHRfcHV0KGNlKTsKKwkJCWdvdG8gb3V0OworCQl9CisKKwkJZXJyID0g
aW50ZWxfZW5naW5lX2VtaXRfY3R4X3dhKHJxKTsKKwkJaWYgKGVycikKKwkJCWdvdG8gZXJyX3Jx
OworCisJCWVyciA9IGludGVsX3JlbmRlcnN0YXRlX2VtaXQocnEpOworCQlpZiAoZXJyKQorCQkJ
Z290byBlcnJfcnE7CisKK2Vycl9ycToKKwkJcmVxdWVzdHNbaWRdID0gaTkxNV9yZXF1ZXN0X2dl
dChycSk7CisJCWk5MTVfcmVxdWVzdF9hZGQocnEpOworCQlpZiAoZXJyKQorCQkJZ290byBvdXQ7
CisJfQorCisJLyogRmx1c2ggdGhlIGRlZmF1bHQgY29udGV4dCBpbWFnZSB0byBtZW1vcnksIGFu
ZCBlbmFibGUgcG93ZXJzYXZpbmcuICovCisJaWYgKGludGVsX2d0X3dhaXRfZm9yX2lkbGUoZ3Qs
IEk5MTVfR0VNX0lETEVfVElNRU9VVCkgPT0gLUVUSU1FKSB7CisJCWVyciA9IC1FSU87CisJCWdv
dG8gb3V0OworCX0KKworCWZvciAoaWQgPSAwOyBpZCA8IEFSUkFZX1NJWkUocmVxdWVzdHMpOyBp
ZCsrKSB7CisJCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOworCQlzdHJ1Y3QgaTkxNV92bWEgKnN0
YXRlOworCQl2b2lkICp2YWRkcjsKKworCQlycSA9IHJlcXVlc3RzW2lkXTsKKwkJaWYgKCFycSkK
KwkJCWNvbnRpbnVlOworCisJCS8qIFdlIHdhbnQgdG8gYmUgYWJsZSB0byB1bmJpbmQgdGhlIHN0
YXRlIGZyb20gdGhlIEdHVFQgKi8KKwkJR0VNX0JVR19PTihpbnRlbF9jb250ZXh0X2lzX3Bpbm5l
ZChycS0+Y29udGV4dCkpOworCisJCXN0YXRlID0gcnEtPmNvbnRleHQtPnN0YXRlOworCQlpZiAo
IXN0YXRlKQorCQkJY29udGludWU7CisKKwkJLyoKKwkJICogQXMgd2Ugd2lsbCBob2xkIGEgcmVm
ZXJlbmNlIHRvIHRoZSBsb2dpY2FsIHN0YXRlLCBpdCB3aWxsCisJCSAqIG5vdCBiZSB0b3JuIGRv
d24gd2l0aCB0aGUgY29udGV4dCwgYW5kIGltcG9ydGFudGx5IHRoZQorCQkgKiBvYmplY3Qgd2ls
bCBob2xkIG9udG8gaXRzIHZtYSAobWFraW5nIGl0IHBvc3NpYmxlIGZvciBhCisJCSAqIHN0cmF5
IEdUVCB3cml0ZSB0byBjb3JydXB0IG91ciBkZWZhdWx0cykuIFVubWFwIHRoZSB2bWEKKwkJICog
ZnJvbSB0aGUgR1RUIHRvIHByZXZlbnQgc3VjaCBhY2NpZGVudHMgYW5kIHJlY2xhaW0gdGhlCisJ
CSAqIHNwYWNlLgorCQkgKi8KKwkJZXJyID0gaTkxNV92bWFfdW5iaW5kKHN0YXRlKTsKKwkJaWYg
KGVycikKKwkJCWdvdG8gb3V0OworCisJCWk5MTVfZ2VtX29iamVjdF9sb2NrKHN0YXRlLT5vYmop
OworCQllcnIgPSBpOTE1X2dlbV9vYmplY3Rfc2V0X3RvX2NwdV9kb21haW4oc3RhdGUtPm9iaiwg
ZmFsc2UpOworCQlpOTE1X2dlbV9vYmplY3RfdW5sb2NrKHN0YXRlLT5vYmopOworCQlpZiAoZXJy
KQorCQkJZ290byBvdXQ7CisKKwkJaTkxNV9nZW1fb2JqZWN0X3NldF9jYWNoZV9jb2hlcmVuY3ko
c3RhdGUtPm9iaiwgSTkxNV9DQUNIRV9MTEMpOworCisJCS8qIENoZWNrIHdlIGNhbiBhY3F1aXJl
IHRoZSBpbWFnZSBvZiB0aGUgY29udGV4dCBzdGF0ZSAqLworCQl2YWRkciA9IGk5MTVfZ2VtX29i
amVjdF9waW5fbWFwKHN0YXRlLT5vYmosIEk5MTVfTUFQX0ZPUkNFX1dCKTsKKwkJaWYgKElTX0VS
Uih2YWRkcikpIHsKKwkJCWVyciA9IFBUUl9FUlIodmFkZHIpOworCQkJZ290byBvdXQ7CisJCX0K
KworCQlycS0+ZW5naW5lLT5kZWZhdWx0X3N0YXRlID0gaTkxNV9nZW1fb2JqZWN0X2dldChzdGF0
ZS0+b2JqKTsKKwkJaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChzdGF0ZS0+b2JqKTsKKwl9CisK
K291dDoKKwkvKgorCSAqIElmIHdlIGhhdmUgdG8gYWJhbmRvbiBub3csIHdlIGV4cGVjdCB0aGUg
ZW5naW5lcyB0byBiZSBpZGxlCisJICogYW5kIHJlYWR5IHRvIGJlIHRvcm4tZG93bi4gVGhlIHF1
aWNrZXN0IHdheSB3ZSBjYW4gYWNjb21wbGlzaAorCSAqIHRoaXMgaXMgYnkgZGVjbGFyaW5nIG91
cnNlbHZlcyB3ZWRnZWQuCisJICovCisJaWYgKGVycikKKwkJaW50ZWxfZ3Rfc2V0X3dlZGdlZChn
dCk7CisKKwlmb3IgKGlkID0gMDsgaWQgPCBBUlJBWV9TSVpFKHJlcXVlc3RzKTsgaWQrKykgewor
CQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7CisJCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOwor
CisJCXJxID0gcmVxdWVzdHNbaWRdOworCQlpZiAoIXJxKQorCQkJY29udGludWU7CisKKwkJY2Ug
PSBycS0+Y29udGV4dDsKKwkJaTkxNV9yZXF1ZXN0X3B1dChycSk7CisJCWludGVsX2NvbnRleHRf
cHV0KGNlKTsKKwl9CisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIGludCBfX2VuZ2luZXNfdmVy
aWZ5X3dvcmthcm91bmRzKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCit7CisJc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lOworCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOworCWludCBlcnIgPSAw
OworCisJaWYgKCFJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9ERUJVR19HRU0pKQorCQlyZXR1
cm4gMDsKKworCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LCBpZCkgeworCQlpZiAoaW50ZWxf
ZW5naW5lX3ZlcmlmeV93b3JrYXJvdW5kcyhlbmdpbmUsICJsb2FkIikpCisJCQllcnIgPSAtRUlP
OworCX0KKworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyB2b2lkIF9faW50ZWxfZ3RfZGlzYWJs
ZShzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQoreworCWludGVsX2d0X3NldF93ZWRnZWRfb25faW5pdChn
dCk7CisKKwlpbnRlbF9ndF9zdXNwZW5kX3ByZXBhcmUoZ3QpOworCWludGVsX2d0X3N1c3BlbmRf
bGF0ZShndCk7CisKKwlHRU1fQlVHX09OKGludGVsX2d0X3BtX2lzX2F3YWtlKGd0KSk7Cit9CisK
IGludCBpbnRlbF9ndF9pbml0KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7CiAJaW50IGVycjsKIAot
CWVyciA9IGludGVsX2d0X2luaXRfc2NyYXRjaChndCwgSVNfR0VOKGd0LT5pOTE1LCAyKSA/IFNa
XzI1NksgOiBTWl80Syk7CisJZXJyID0gaTkxNV9pbmplY3RfcHJvYmVfZXJyb3IoZ3QtPmk5MTUs
IC1FTk9ERVYpOwogCWlmIChlcnIpCiAJCXJldHVybiBlcnI7CiAKKwkvKgorCSAqIFRoaXMgaXMg
anVzdCBhIHNlY3VyaXR5IGJsYW5rZXQgdG8gcGxhY2F0ZSBkcmFnb25zLgorCSAqIE9uIHNvbWUg
c3lzdGVtcywgd2UgdmVyeSBzcG9yYWRpY2FsbHkgb2JzZXJ2ZSB0aGF0IHRoZSBmaXJzdCBUTEJz
CisJICogdXNlZCBieSB0aGUgQ1MgbWF5IGJlIHN0YWxlLCBkZXNwaXRlIHVzIHBva2luZyB0aGUg
VExCIHJlc2V0LiBJZgorCSAqIHdlIGhvbGQgdGhlIGZvcmNld2FrZSBkdXJpbmcgaW5pdGlhbGlz
YXRpb24gdGhlc2UgcHJvYmxlbXMKKwkgKiBqdXN0IG1hZ2ljYWxseSBnbyBhd2F5LgorCSAqLwor
CWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KGd0LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwor
CisJZXJyID0gaW50ZWxfZ3RfaW5pdF9zY3JhdGNoKGd0LCBJU19HRU4oZ3QtPmk5MTUsIDIpID8g
U1pfMjU2SyA6IFNaXzRLKTsKKwlpZiAoZXJyKQorCQlnb3RvIG91dF9mdzsKKwogCWludGVsX2d0
X3BtX2luaXQoZ3QpOwogCiAJZ3QtPnZtID0ga2VybmVsX3ZtKGd0KTsKIAlpZiAoIWd0LT52bSkg
ewogCQllcnIgPSAtRU5PTUVNOwotCQlnb3RvIGVycl9zY3JhdGNoOworCQlnb3RvIGVycl9wbTsK
IAl9CiAKLQlyZXR1cm4gMDsKKwllcnIgPSBpbnRlbF9lbmdpbmVzX3NldHVwKGd0KTsKKwlpZiAo
ZXJyKQorCQlnb3RvIGVycl92bTsKKworCWVyciA9IGludGVsX2VuZ2luZXNfaW5pdChndCk7CisJ
aWYgKGVycikKKwkJZ290byBlcnJfZW5naW5lczsKKworCWludGVsX3VjX2luaXQoJmd0LT51Yyk7
CisKKwllcnIgPSBpbnRlbF9ndF9pbml0X2h3KGd0KTsKKwlpZiAoZXJyKQorCQlnb3RvIGVycl91
Y19pbml0OworCisJLyogT25seSB3aGVuIHRoZSBIVyBpcyByZS1pbml0aWFsaXNlZCwgY2FuIHdl
IHJlcGxheSB0aGUgcmVxdWVzdHMgKi8KKwllcnIgPSBpbnRlbF9ndF9yZXN1bWUoZ3QpOworCWlm
IChlcnIpCisJCWdvdG8gZXJyX3VjX2luaXQ7CisKKwllcnIgPSBfX2VuZ2luZXNfcmVjb3JkX2Rl
ZmF1bHRzKGd0KTsKKwlpZiAoZXJyKQorCQlnb3RvIGVycl9ndDsKKworCWVyciA9IF9fZW5naW5l
c192ZXJpZnlfd29ya2Fyb3VuZHMoZ3QpOworCWlmIChlcnIpCisJCWdvdG8gZXJyX2d0OwogCi1l
cnJfc2NyYXRjaDoKKwllcnIgPSBpOTE1X2luamVjdF9wcm9iZV9lcnJvcihndC0+aTkxNSwgLUVJ
Tyk7CisJaWYgKGVycikKKwkJZ290byBlcnJfZ3Q7CisKKwlnb3RvIG91dF9mdzsKK2Vycl9ndDoK
KwlfX2ludGVsX2d0X2Rpc2FibGUoZ3QpOworZXJyX3VjX2luaXQ6CisJaW50ZWxfdWNfZmluaSgm
Z3QtPnVjKTsKK2Vycl9lbmdpbmVzOgorCWludGVsX2VuZ2luZXNfcmVsZWFzZShndCk7CitlcnJf
dm06CisJaTkxNV92bV9wdXQoZmV0Y2hfYW5kX3plcm8oJmd0LT52bSkpOworZXJyX3BtOgorCWlu
dGVsX2d0X3BtX2ZpbmkoZ3QpOwogCWludGVsX2d0X2Zpbmlfc2NyYXRjaChndCk7CitvdXRfZnc6
CisJaWYgKGVycikKKwkJaW50ZWxfZ3Rfc2V0X3dlZGdlZF9vbl9pbml0KGd0KTsKKwlpbnRlbF91
bmNvcmVfZm9yY2V3YWtlX3B1dChndC0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKIAlyZXR1cm4g
ZXJyOwogfQogCiB2b2lkIGludGVsX2d0X2RyaXZlcl9yZW1vdmUoc3RydWN0IGludGVsX2d0ICpn
dCkKIHsKLQlHRU1fQlVHX09OKGd0LT5hd2FrZSk7CisJX19pbnRlbF9ndF9kaXNhYmxlKGd0KTsK
KworCWludGVsX3VjX2ZpbmlfaHcoJmd0LT51Yyk7CisJaW50ZWxfdWNfZmluaSgmZ3QtPnVjKTsK
KworCWludGVsX2VuZ2luZXNfcmVsZWFzZShndCk7CiB9CiAKIHZvaWQgaW50ZWxfZ3RfZHJpdmVy
X3VucmVnaXN0ZXIoc3RydWN0IGludGVsX2d0ICpndCkKQEAgLTQyMiw0ICs2NDEsNSBAQCB2b2lk
IGludGVsX2d0X2RyaXZlcl9sYXRlX3JlbGVhc2Uoc3RydWN0IGludGVsX2d0ICpndCkKIAlpbnRl
bF91Y19kcml2ZXJfbGF0ZV9yZWxlYXNlKCZndC0+dWMpOwogCWludGVsX2d0X2ZpbmlfcmVzZXQo
Z3QpOwogCWludGVsX2d0X2ZpbmlfdGltZWxpbmVzKGd0KTsKKwlpbnRlbF9lbmdpbmVzX2ZyZWUo
Z3QpOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwppbmRleCA4NGI0NTJkMTdlYzku
LmZmOTE4NDliZWIyZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
bHJjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKQEAgLTMxMTIs
NyArMzExMiw3IEBAIHN0YXRpYyB2b2lkIF9fZXhlY2xpc3RzX3Jlc2V0KHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSwgYm9vbCBzdGFsbGVkKQogCV9fdW53aW5kX2luY29tcGxldGVfcmVx
dWVzdHMoZW5naW5lKTsKIH0KIAotc3RhdGljIHZvaWQgZXhlY2xpc3RzX3Jlc2V0KHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgYm9vbCBzdGFsbGVkKQorc3RhdGljIHZvaWQgZXhlY2xp
c3RzX3Jlc2V0X3Jld2luZChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIGJvb2wgc3Rh
bGxlZCkKIHsKIAl1bnNpZ25lZCBsb25nIGZsYWdzOwogCkBAIC0zMTMwLDcgKzMxMzAsNyBAQCBz
dGF0aWMgdm9pZCBub3Bfc3VibWlzc2lvbl90YXNrbGV0KHVuc2lnbmVkIGxvbmcgZGF0YSkKIAkv
KiBUaGUgZHJpdmVyIGlzIHdlZGdlZDsgZG9uJ3QgcHJvY2VzcyBhbnkgbW9yZSBldmVudHMuICov
CiB9CiAKLXN0YXRpYyB2b2lkIGV4ZWNsaXN0c19jYW5jZWxfcmVxdWVzdHMoc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lKQorc3RhdGljIHZvaWQgZXhlY2xpc3RzX3Jlc2V0X2NhbmNlbChz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7CiAJc3RydWN0IGludGVsX2VuZ2luZV9l
eGVjbGlzdHMgKiBjb25zdCBleGVjbGlzdHMgPSAmZW5naW5lLT5leGVjbGlzdHM7CiAJc3RydWN0
IGk5MTVfcmVxdWVzdCAqcnEsICpybjsKQEAgLTM3MTksMTIgKzM3MTksMTIgQEAgc3RhdGljIHZv
aWQgZXhlY2xpc3RzX3Bhcmsoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogdm9pZCBp
bnRlbF9leGVjbGlzdHNfc2V0X2RlZmF1bHRfc3VibWlzc2lvbihzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUpCiB7CiAJZW5naW5lLT5zdWJtaXRfcmVxdWVzdCA9IGV4ZWNsaXN0c19zdWJt
aXRfcmVxdWVzdDsKLQllbmdpbmUtPmNhbmNlbF9yZXF1ZXN0cyA9IGV4ZWNsaXN0c19jYW5jZWxf
cmVxdWVzdHM7CiAJZW5naW5lLT5zY2hlZHVsZSA9IGk5MTVfc2NoZWR1bGU7CiAJZW5naW5lLT5l
eGVjbGlzdHMudGFza2xldC5mdW5jID0gZXhlY2xpc3RzX3N1Ym1pc3Npb25fdGFza2xldDsKIAog
CWVuZ2luZS0+cmVzZXQucHJlcGFyZSA9IGV4ZWNsaXN0c19yZXNldF9wcmVwYXJlOwotCWVuZ2lu
ZS0+cmVzZXQucmVzZXQgPSBleGVjbGlzdHNfcmVzZXQ7CisJZW5naW5lLT5yZXNldC5yZXdpbmQg
PSBleGVjbGlzdHNfcmVzZXRfcmV3aW5kOworCWVuZ2luZS0+cmVzZXQuY2FuY2VsID0gZXhlY2xp
c3RzX3Jlc2V0X2NhbmNlbDsKIAllbmdpbmUtPnJlc2V0LmZpbmlzaCA9IGV4ZWNsaXN0c19yZXNl
dF9maW5pc2g7CiAKIAllbmdpbmUtPnBhcmsgPSBleGVjbGlzdHNfcGFyazsKQEAgLTM3NDEsMTEg
KzM3NDEsMTAgQEAgdm9pZCBpbnRlbF9leGVjbGlzdHNfc2V0X2RlZmF1bHRfc3VibWlzc2lvbihz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJCWVuZ2luZS0+ZmxhZ3MgfD0gSTkxNV9F
TkdJTkVfSEFTX1JFTEFUSVZFX01NSU87CiB9CiAKLXN0YXRpYyB2b2lkIGV4ZWNsaXN0c19kZXN0
cm95KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3N0YXRpYyB2b2lkIGV4ZWNsaXN0
c19yZWxlYXNlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsKIAlpbnRlbF9lbmdp
bmVfY2xlYW51cF9jb21tb24oZW5naW5lKTsKIAlscmNfZGVzdHJveV93YV9jdHgoZW5naW5lKTsK
LQlrZnJlZShlbmdpbmUpOwogfQogCiBzdGF0aWMgdm9pZApAQCAtMzc1MywxMyArMzc1Miw5IEBA
IGxvZ2ljYWxfcmluZ19kZWZhdWx0X3ZmdW5jcyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpCiB7CiAJLyogRGVmYXVsdCB2ZnVuY3Mgd2hpY2ggY2FuIGJlIG92ZXJyaWRlbiBieSBlYWNo
IGVuZ2luZS4gKi8KIAotCWVuZ2luZS0+ZGVzdHJveSA9IGV4ZWNsaXN0c19kZXN0cm95OworCWVu
Z2luZS0+cmVsZWFzZSA9IGV4ZWNsaXN0c19yZWxlYXNlOwogCWVuZ2luZS0+cmVzdW1lID0gZXhl
Y2xpc3RzX3Jlc3VtZTsKIAotCWVuZ2luZS0+cmVzZXQucHJlcGFyZSA9IGV4ZWNsaXN0c19yZXNl
dF9wcmVwYXJlOwotCWVuZ2luZS0+cmVzZXQucmVzZXQgPSBleGVjbGlzdHNfcmVzZXQ7Ci0JZW5n
aW5lLT5yZXNldC5maW5pc2ggPSBleGVjbGlzdHNfcmVzZXRfZmluaXNoOwotCiAJZW5naW5lLT5j
b3BzID0gJmV4ZWNsaXN0c19jb250ZXh0X29wczsKIAllbmdpbmUtPnJlcXVlc3RfYWxsb2MgPSBl
eGVjbGlzdHNfcmVxdWVzdF9hbGxvYzsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfcmVzZXQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0
LmMKaW5kZXggOWVjZjI0NDM5ZmRlLi5jNjBlNjM2MWE2MzggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfcmVzZXQuYwpAQCAtNjY2LDcgKzY2Niw4IEBAIHN0YXRpYyB2b2lkIHJlc2V0X3By
ZXBhcmVfZW5naW5lKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAkgKiBHUFUgc3Rh
dGUgdXBvbiByZXN1bWUsIGkuZS4gZmFpbCB0byByZXN0YXJ0IGFmdGVyIGEgcmVzZXQuCiAJICov
CiAJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoZW5naW5lLT51bmNvcmUsIEZPUkNFV0FLRV9B
TEwpOwotCWVuZ2luZS0+cmVzZXQucHJlcGFyZShlbmdpbmUpOworCWlmIChlbmdpbmUtPnJlc2V0
LnByZXBhcmUpCisJCWVuZ2luZS0+cmVzZXQucHJlcGFyZShlbmdpbmUpOwogfQogCiBzdGF0aWMg
dm9pZCByZXZva2VfbW1hcHMoc3RydWN0IGludGVsX2d0ICpndCkKQEAgLTc0MSw3ICs3NDIsOCBA
QCBzdGF0aWMgaW50IGd0X3Jlc2V0KHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGludGVsX2VuZ2luZV9t
YXNrX3Qgc3RhbGxlZF9tYXNrKQogCiBzdGF0aWMgdm9pZCByZXNldF9maW5pc2hfZW5naW5lKHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsKLQllbmdpbmUtPnJlc2V0LmZpbmlzaChl
bmdpbmUpOworCWlmIChlbmdpbmUtPnJlc2V0LmZpbmlzaCkKKwkJZW5naW5lLT5yZXNldC5maW5p
c2goZW5naW5lKTsKIAlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dChlbmdpbmUtPnVuY29yZSwg
Rk9SQ0VXQUtFX0FMTCk7CiAKIAlpbnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNfaXJxKGVuZ2luZSk7
CkBAIC04MTgsNyArODIwLDggQEAgc3RhdGljIHZvaWQgX19pbnRlbF9ndF9zZXRfd2VkZ2VkKHN0
cnVjdCBpbnRlbF9ndCAqZ3QpCiAKIAkvKiBNYXJrIGFsbCBleGVjdXRpbmcgcmVxdWVzdHMgYXMg
c2tpcHBlZCAqLwogCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LCBpZCkKLQkJZW5naW5lLT5j
YW5jZWxfcmVxdWVzdHMoZW5naW5lKTsKKwkJaWYgKGVuZ2luZS0+cmVzZXQuY2FuY2VsKQorCQkJ
ZW5naW5lLT5yZXNldC5jYW5jZWwoZW5naW5lKTsKIAogCXJlc2V0X2ZpbmlzaChndCwgYXdha2Up
OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nX3N1Ym1p
c3Npb24uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jpbmdfc3VibWlzc2lvbi5j
CmluZGV4IDZkZGZlOGE4NmRiZS4uNzJmZmNjNTY3MWM4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nX3N1Ym1pc3Npb24uYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9yaW5nX3N1Ym1pc3Npb24uYwpAQCAtNzcxLDcgKzc3MSw3IEBAIHN0
YXRpYyB2b2lkIHJlc2V0X3ByZXBhcmUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQog
CQkJICBpbnRlbF91bmNvcmVfcmVhZF9mdyh1bmNvcmUsIFJJTkdfSEVBRChiYXNlKSkpOwogfQog
Ci1zdGF0aWMgdm9pZCByZXNldF9yaW5nKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwg
Ym9vbCBzdGFsbGVkKQorc3RhdGljIHZvaWQgcmVzZXRfcmV3aW5kKHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSwgYm9vbCBzdGFsbGVkKQogewogCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnBv
cywgKnJxOwogCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CkBAIC04OTksNyArODk5LDcgQEAgc3RhdGlj
IGludCByY3NfcmVzdW1lKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAlyZXR1cm4g
eGNzX3Jlc3VtZShlbmdpbmUpOwogfQogCi1zdGF0aWMgdm9pZCBjYW5jZWxfcmVxdWVzdHMoc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQorc3RhdGljIHZvaWQgcmVzZXRfY2FuY2VsKHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsKIAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpy
ZXF1ZXN0OwogCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CkBAIC0xODA0LDcgKzE4MDQsNiBAQCBzdGF0
aWMgaW50IGdlbjZfcmluZ19mbHVzaChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgdTMyIG1vZGUp
CiBzdGF0aWMgdm9pZCBpOXh4X3NldF9kZWZhdWx0X3N1Ym1pc3Npb24oc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQogewogCWVuZ2luZS0+c3VibWl0X3JlcXVlc3QgPSBpOXh4X3N1Ym1p
dF9yZXF1ZXN0OwotCWVuZ2luZS0+Y2FuY2VsX3JlcXVlc3RzID0gY2FuY2VsX3JlcXVlc3RzOwog
CiAJZW5naW5lLT5wYXJrID0gTlVMTDsKIAllbmdpbmUtPnVucGFyayA9IE5VTEw7CkBAIC0xODE2
LDcgKzE4MTUsNyBAQCBzdGF0aWMgdm9pZCBnZW42X2JzZF9zZXRfZGVmYXVsdF9zdWJtaXNzaW9u
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAllbmdpbmUtPnN1Ym1pdF9yZXF1ZXN0
ID0gZ2VuNl9ic2Rfc3VibWl0X3JlcXVlc3Q7CiB9CiAKLXN0YXRpYyB2b2lkIHJpbmdfZGVzdHJv
eShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCitzdGF0aWMgdm9pZCByaW5nX3JlbGVh
c2Uoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewogCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IGVuZ2luZS0+aTkxNTsKIApAQCAtMTgzMCw4ICsxODI5LDYgQEAg
c3RhdGljIHZvaWQgcmluZ19kZXN0cm95KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkK
IAogCWludGVsX3RpbWVsaW5lX3VucGluKGVuZ2luZS0+bGVnYWN5LnRpbWVsaW5lKTsKIAlpbnRl
bF90aW1lbGluZV9wdXQoZW5naW5lLT5sZWdhY3kudGltZWxpbmUpOwotCi0Ja2ZyZWUoZW5naW5l
KTsKIH0KIAogc3RhdGljIHZvaWQgc2V0dXBfaXJxKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSkKQEAgLTE4NjIsMTEgKzE4NTksMTIgQEAgc3RhdGljIHZvaWQgc2V0dXBfY29tbW9uKHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAogCXNldHVwX2lycShlbmdpbmUpOwogCi0J
ZW5naW5lLT5kZXN0cm95ID0gcmluZ19kZXN0cm95OworCWVuZ2luZS0+cmVsZWFzZSA9IHJpbmdf
cmVsZWFzZTsKIAogCWVuZ2luZS0+cmVzdW1lID0geGNzX3Jlc3VtZTsKIAllbmdpbmUtPnJlc2V0
LnByZXBhcmUgPSByZXNldF9wcmVwYXJlOwotCWVuZ2luZS0+cmVzZXQucmVzZXQgPSByZXNldF9y
aW5nOworCWVuZ2luZS0+cmVzZXQucmV3aW5kID0gcmVzZXRfcmV3aW5kOworCWVuZ2luZS0+cmVz
ZXQuY2FuY2VsID0gcmVzZXRfY2FuY2VsOwogCWVuZ2luZS0+cmVzZXQuZmluaXNoID0gcmVzZXRf
ZmluaXNoOwogCiAJZW5naW5lLT5jb3BzID0gJnJpbmdfY29udGV4dF9vcHM7CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF90aW1lbGluZV90eXBlcy5oIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfdGltZWxpbmVfdHlwZXMuaAppbmRleCA5OGQ5ZWUxNjYz
NzkuLjM0ZDI4ZDc3NzFkMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfdGltZWxpbmVfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF90
aW1lbGluZV90eXBlcy5oCkBAIC0xNCwxMCArMTQsMTAgQEAKIAogI2luY2x1ZGUgImk5MTVfYWN0
aXZlX3R5cGVzLmgiCiAKLXN0cnVjdCBkcm1faTkxNV9wcml2YXRlOwogc3RydWN0IGk5MTVfdm1h
Owotc3RydWN0IGludGVsX3RpbWVsaW5lX2NhY2hlbGluZTsKIHN0cnVjdCBpOTE1X3N5bmNtYXA7
CitzdHJ1Y3QgaW50ZWxfZ3Q7CitzdHJ1Y3QgaW50ZWxfdGltZWxpbmVfY2FjaGVsaW5lOwogCiBz
dHJ1Y3QgaW50ZWxfdGltZWxpbmUgewogCXU2NCBmZW5jZV9jb250ZXh0OwpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvbW9ja19lbmdpbmUuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L21vY2tfZW5naW5lLmMKaW5kZXggODNmNTQ5ZDIwM2EwLi44YmI1YWNmNzE5OWUgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L21vY2tfZW5naW5lLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvbW9ja19lbmdpbmUuYwpAQCAtMjA3LDE2ICsyMDcsMTIgQEAg
c3RhdGljIHZvaWQgbW9ja19yZXNldF9wcmVwYXJlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSkKIHsKIH0KIAotc3RhdGljIHZvaWQgbW9ja19yZXNldChzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUsIGJvb2wgc3RhbGxlZCkKK3N0YXRpYyB2b2lkIG1vY2tfcmVzZXRfcmV3aW5k
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgYm9vbCBzdGFsbGVkKQogewogCUdFTV9C
VUdfT04oc3RhbGxlZCk7CiB9CiAKLXN0YXRpYyB2b2lkIG1vY2tfcmVzZXRfZmluaXNoKHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKLXsKLX0KLQotc3RhdGljIHZvaWQgbW9ja19jYW5j
ZWxfcmVxdWVzdHMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQorc3RhdGljIHZvaWQg
bW9ja19yZXNldF9jYW5jZWwoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewogCXN0
cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3Q7CiAJdW5zaWduZWQgbG9uZyBmbGFnczsKQEAgLTIz
NCw2ICsyMzAsMTAgQEAgc3RhdGljIHZvaWQgbW9ja19jYW5jZWxfcmVxdWVzdHMoc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmVuZ2luZS0+
YWN0aXZlLmxvY2ssIGZsYWdzKTsKIH0KIAorc3RhdGljIHZvaWQgbW9ja19yZXNldF9maW5pc2go
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworfQorCiBzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICptb2NrX2VuZ2luZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJCQkg
ICAgY29uc3QgY2hhciAqbmFtZSwKIAkJCQkgICAgaW50IGlkKQpAQCAtMjY1LDkgKzI2NSw5IEBA
IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKm1vY2tfZW5naW5lKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAogCWVuZ2luZS0+YmFzZS5zdWJtaXRfcmVxdWVzdCA9IG1vY2tfc3VibWl0X3Jl
cXVlc3Q7CiAKIAllbmdpbmUtPmJhc2UucmVzZXQucHJlcGFyZSA9IG1vY2tfcmVzZXRfcHJlcGFy
ZTsKLQllbmdpbmUtPmJhc2UucmVzZXQucmVzZXQgPSBtb2NrX3Jlc2V0OworCWVuZ2luZS0+YmFz
ZS5yZXNldC5yZXdpbmQgPSBtb2NrX3Jlc2V0X3Jld2luZDsKKwllbmdpbmUtPmJhc2UucmVzZXQu
Y2FuY2VsID0gbW9ja19yZXNldF9jYW5jZWw7CiAJZW5naW5lLT5iYXNlLnJlc2V0LmZpbmlzaCA9
IG1vY2tfcmVzZXRfZmluaXNoOwotCWVuZ2luZS0+YmFzZS5jYW5jZWxfcmVxdWVzdHMgPSBtb2Nr
X2NhbmNlbF9yZXF1ZXN0czsKIAogCWk5MTUtPmd0LmVuZ2luZVtpZF0gPSAmZW5naW5lLT5iYXNl
OwogCWk5MTUtPmd0LmVuZ2luZV9jbGFzc1swXVtpZF0gPSAmZW5naW5lLT5iYXNlOwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9uLmMKaW5kZXgg
MDgyNjdkMmMzY2ZjLi42M2FiNmE5NTY3ZTAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9uLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvdWMvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYwpAQCAtNjU4LDcgKzY1OCw3IEBAIGNhbmNl
bF9wb3J0X3JlcXVlc3RzKHN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3RzICogY29uc3QgZXhl
Y2xpc3RzKQogCQltZW1zZXQoZXhlY2xpc3RzLT5pbmZsaWdodCwgMCwgc2l6ZW9mKGV4ZWNsaXN0
cy0+aW5mbGlnaHQpKTsKIH0KIAotc3RhdGljIHZvaWQgZ3VjX3Jlc2V0KHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSwgYm9vbCBzdGFsbGVkKQorc3RhdGljIHZvaWQgZ3VjX3Jlc2V0X3Jl
d2luZChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIGJvb2wgc3RhbGxlZCkKIHsKIAlz
dHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAqIGNvbnN0IGV4ZWNsaXN0cyA9ICZlbmdpbmUt
PmV4ZWNsaXN0czsKIAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKQEAgLTY4Myw3ICs2ODMsNyBA
QCBzdGF0aWMgdm9pZCBndWNfcmVzZXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBi
b29sIHN0YWxsZWQpCiAJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZW5naW5lLT5hY3RpdmUubG9j
aywgZmxhZ3MpOwogfQogCi1zdGF0aWMgdm9pZCBndWNfY2FuY2VsX3JlcXVlc3RzKHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3N0YXRpYyB2b2lkIGd1Y19yZXNldF9jYW5jZWwoc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewogCXN0cnVjdCBpbnRlbF9lbmdpbmVfZXhl
Y2xpc3RzICogY29uc3QgZXhlY2xpc3RzID0gJmVuZ2luZS0+ZXhlY2xpc3RzOwogCXN0cnVjdCBp
OTE1X3JlcXVlc3QgKnJxLCAqcm47CkBAIC0xMTAyLDExICsxMTAyLDEwIEBAIHN0YXRpYyB2b2lk
IGd1Y19zZXRfZGVmYXVsdF9zdWJtaXNzaW9uKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSkKIAllbmdpbmUtPnBhcmsgPSBlbmdpbmUtPnVucGFyayA9IE5VTEw7CiAKIAllbmdpbmUtPnJl
c2V0LnByZXBhcmUgPSBndWNfcmVzZXRfcHJlcGFyZTsKLQllbmdpbmUtPnJlc2V0LnJlc2V0ID0g
Z3VjX3Jlc2V0OworCWVuZ2luZS0+cmVzZXQucmV3aW5kID0gZ3VjX3Jlc2V0X3Jld2luZDsKKwll
bmdpbmUtPnJlc2V0LmNhbmNlbCA9IGd1Y19yZXNldF9jYW5jZWw7CiAJZW5naW5lLT5yZXNldC5m
aW5pc2ggPSBndWNfcmVzZXRfZmluaXNoOwogCi0JZW5naW5lLT5jYW5jZWxfcmVxdWVzdHMgPSBn
dWNfY2FuY2VsX3JlcXVlc3RzOwotCiAJZW5naW5lLT5mbGFncyAmPSB+STkxNV9FTkdJTkVfU1VQ
UE9SVFNfU1RBVFM7CiAJZW5naW5lLT5mbGFncyB8PSBJOTE1X0VOR0lORV9ORUVEU19CUkVBRENS
VU1CX1RBU0tMRVQ7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCmluZGV4IDY0ZjhiYTM0NDllZC4u
NzM0MDY0ZTM1NWVjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKQEAgLTYxNyw3ICs2MTcsNiBA
QCBzdGF0aWMgaW50IGk5MTVfZHJpdmVyX21taW9fcHJvYmUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQogICovCiBzdGF0aWMgdm9pZCBpOTE1X2RyaXZlcl9tbWlvX3JlbGVhc2Uo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewotCWludGVsX2VuZ2luZXNfY2xl
YW51cCgmZGV2X3ByaXYtPmd0KTsKIAlpbnRlbF90ZWFyZG93bl9tY2hiYXIoZGV2X3ByaXYpOwog
CWludGVsX3VuY29yZV9maW5pX21taW8oJmRldl9wcml2LT51bmNvcmUpOwogCXBjaV9kZXZfcHV0
KGRldl9wcml2LT5icmlkZ2VfZGV2KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCmluZGV4IDA0MzUw
ZTYxYzg2Yy4uZTE5NDMyZDE3OTVkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2dlbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKQEAgLTQ0LDE5
ICs0NCwxMSBAQAogI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9jbGZsdXNoLmgiCiAjaW5jbHVkZSAi
Z2VtL2k5MTVfZ2VtX2NvbnRleHQuaCIKICNpbmNsdWRlICJnZW0vaTkxNV9nZW1faW9jdGxzLmgi
Ci0jaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX3BtLmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfZW5naW5l
X3VzZXIuaCIKICNpbmNsdWRlICJndC9pbnRlbF9ndC5oIgotI2luY2x1ZGUgImd0L2ludGVsX2d0
X3BtLmgiCi0jaW5jbHVkZSAiZ3QvaW50ZWxfZ3RfcmVxdWVzdHMuaCIKLSNpbmNsdWRlICJndC9p
bnRlbF9tb2NzLmgiCi0jaW5jbHVkZSAiZ3QvaW50ZWxfcmVzZXQuaCIKLSNpbmNsdWRlICJndC9p
bnRlbF9yZW5kZXJzdGF0ZS5oIgotI2luY2x1ZGUgImd0L2ludGVsX3Jwcy5oIgogI2luY2x1ZGUg
Imd0L2ludGVsX3dvcmthcm91bmRzLmgiCiAKICNpbmNsdWRlICJpOTE1X2Rydi5oIgotI2luY2x1
ZGUgImk5MTVfc2NhdHRlcmxpc3QuaCIKICNpbmNsdWRlICJpOTE1X3RyYWNlLmgiCiAjaW5jbHVk
ZSAiaTkxNV92Z3B1LmgiCiAKQEAgLTEwMzksMTUyICsxMDMxLDYgQEAgaTkxNV9nZW1fbWFkdmlz
ZV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCXJldHVybiBlcnI7
CiB9CiAKLXN0YXRpYyBpbnQgX19pbnRlbF9lbmdpbmVzX3JlY29yZF9kZWZhdWx0cyhzdHJ1Y3Qg
aW50ZWxfZ3QgKmd0KQotewotCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3RzW0k5MTVfTlVN
X0VOR0lORVNdID0ge307Ci0Jc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCWVudW0g
aW50ZWxfZW5naW5lX2lkIGlkOwotCWludCBlcnIgPSAwOwotCi0JLyoKLQkgKiBBcyB3ZSByZXNl
dCB0aGUgZ3B1IGR1cmluZyB2ZXJ5IGVhcmx5IHNhbml0aXNhdGlvbiwgdGhlIGN1cnJlbnQKLQkg
KiByZWdpc3RlciBzdGF0ZSBvbiB0aGUgR1BVIHNob3VsZCByZWZsZWN0IGl0cyBkZWZhdWx0cyB2
YWx1ZXMuCi0JICogV2UgbG9hZCBhIGNvbnRleHQgb250byB0aGUgaHcgKHdpdGggcmVzdG9yZS1p
bmhpYml0KSwgdGhlbiBzd2l0Y2gKLQkgKiBvdmVyIHRvIGEgc2Vjb25kIGNvbnRleHQgdG8gc2F2
ZSB0aGF0IGRlZmF1bHQgcmVnaXN0ZXIgc3RhdGUuIFdlCi0JICogY2FuIHRoZW4gcHJpbWUgZXZl
cnkgbmV3IGNvbnRleHQgd2l0aCB0aGF0IHN0YXRlIHNvIHRoZXkgYWxsIHN0YXJ0Ci0JICogZnJv
bSB0aGUgc2FtZSBkZWZhdWx0IEhXIHZhbHVlcy4KLQkgKi8KLQotCWZvcl9lYWNoX2VuZ2luZShl
bmdpbmUsIGd0LCBpZCkgewotCQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7Ci0JCXN0cnVjdCBp
OTE1X3JlcXVlc3QgKnJxOwotCi0JCS8qIFdlIG11c3QgYmUgYWJsZSB0byBzd2l0Y2ggdG8gc29t
ZXRoaW5nISAqLwotCQlHRU1fQlVHX09OKCFlbmdpbmUtPmtlcm5lbF9jb250ZXh0KTsKLQkJZW5n
aW5lLT5zZXJpYWwrKzsgLyogZm9yY2UgdGhlIGtlcm5lbCBjb250ZXh0IHN3aXRjaCAqLwotCi0J
CWNlID0gaW50ZWxfY29udGV4dF9jcmVhdGUoZW5naW5lKTsKLQkJaWYgKElTX0VSUihjZSkpIHsK
LQkJCWVyciA9IFBUUl9FUlIoY2UpOwotCQkJZ290byBvdXQ7Ci0JCX0KLQotCQlycSA9IGludGVs
X2NvbnRleHRfY3JlYXRlX3JlcXVlc3QoY2UpOwotCQlpZiAoSVNfRVJSKHJxKSkgewotCQkJZXJy
ID0gUFRSX0VSUihycSk7Ci0JCQlpbnRlbF9jb250ZXh0X3B1dChjZSk7Ci0JCQlnb3RvIG91dDsK
LQkJfQotCi0JCWVyciA9IGludGVsX2VuZ2luZV9lbWl0X2N0eF93YShycSk7Ci0JCWlmIChlcnIp
Ci0JCQlnb3RvIGVycl9ycTsKLQotCQllcnIgPSBpbnRlbF9yZW5kZXJzdGF0ZV9lbWl0KHJxKTsK
LQkJaWYgKGVycikKLQkJCWdvdG8gZXJyX3JxOwotCi1lcnJfcnE6Ci0JCXJlcXVlc3RzW2lkXSA9
IGk5MTVfcmVxdWVzdF9nZXQocnEpOwotCQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKLQkJaWYgKGVy
cikKLQkJCWdvdG8gb3V0OwotCX0KLQotCS8qIEZsdXNoIHRoZSBkZWZhdWx0IGNvbnRleHQgaW1h
Z2UgdG8gbWVtb3J5LCBhbmQgZW5hYmxlIHBvd2Vyc2F2aW5nLiAqLwotCWlmIChpbnRlbF9ndF93
YWl0X2Zvcl9pZGxlKGd0LCBJOTE1X0dFTV9JRExFX1RJTUVPVVQpID09IC1FVElNRSkgewotCQll
cnIgPSAtRUlPOwotCQlnb3RvIG91dDsKLQl9Ci0KLQlmb3IgKGlkID0gMDsgaWQgPCBBUlJBWV9T
SVpFKHJlcXVlc3RzKTsgaWQrKykgewotCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKLQkJc3Ry
dWN0IGk5MTVfdm1hICpzdGF0ZTsKLQkJdm9pZCAqdmFkZHI7Ci0KLQkJcnEgPSByZXF1ZXN0c1tp
ZF07Ci0JCWlmICghcnEpCi0JCQljb250aW51ZTsKLQotCQkvKiBXZSB3YW50IHRvIGJlIGFibGUg
dG8gdW5iaW5kIHRoZSBzdGF0ZSBmcm9tIHRoZSBHR1RUICovCi0JCUdFTV9CVUdfT04oaW50ZWxf
Y29udGV4dF9pc19waW5uZWQocnEtPmNvbnRleHQpKTsKLQotCQlzdGF0ZSA9IHJxLT5jb250ZXh0
LT5zdGF0ZTsKLQkJaWYgKCFzdGF0ZSkKLQkJCWNvbnRpbnVlOwotCi0JCS8qCi0JCSAqIEFzIHdl
IHdpbGwgaG9sZCBhIHJlZmVyZW5jZSB0byB0aGUgbG9naWNhbCBzdGF0ZSwgaXQgd2lsbAotCQkg
KiBub3QgYmUgdG9ybiBkb3duIHdpdGggdGhlIGNvbnRleHQsIGFuZCBpbXBvcnRhbnRseSB0aGUK
LQkJICogb2JqZWN0IHdpbGwgaG9sZCBvbnRvIGl0cyB2bWEgKG1ha2luZyBpdCBwb3NzaWJsZSBm
b3IgYQotCQkgKiBzdHJheSBHVFQgd3JpdGUgdG8gY29ycnVwdCBvdXIgZGVmYXVsdHMpLiBVbm1h
cCB0aGUgdm1hCi0JCSAqIGZyb20gdGhlIEdUVCB0byBwcmV2ZW50IHN1Y2ggYWNjaWRlbnRzIGFu
ZCByZWNsYWltIHRoZQotCQkgKiBzcGFjZS4KLQkJICovCi0JCWVyciA9IGk5MTVfdm1hX3VuYmlu
ZChzdGF0ZSk7Ci0JCWlmIChlcnIpCi0JCQlnb3RvIG91dDsKLQotCQlpOTE1X2dlbV9vYmplY3Rf
bG9jayhzdGF0ZS0+b2JqKTsKLQkJZXJyID0gaTkxNV9nZW1fb2JqZWN0X3NldF90b19jcHVfZG9t
YWluKHN0YXRlLT5vYmosIGZhbHNlKTsKLQkJaTkxNV9nZW1fb2JqZWN0X3VubG9jayhzdGF0ZS0+
b2JqKTsKLQkJaWYgKGVycikKLQkJCWdvdG8gb3V0OwotCi0JCWk5MTVfZ2VtX29iamVjdF9zZXRf
Y2FjaGVfY29oZXJlbmN5KHN0YXRlLT5vYmosIEk5MTVfQ0FDSEVfTExDKTsKLQotCQkvKiBDaGVj
ayB3ZSBjYW4gYWNxdWlyZSB0aGUgaW1hZ2Ugb2YgdGhlIGNvbnRleHQgc3RhdGUgKi8KLQkJdmFk
ZHIgPSBpOTE1X2dlbV9vYmplY3RfcGluX21hcChzdGF0ZS0+b2JqLCBJOTE1X01BUF9GT1JDRV9X
Qik7Ci0JCWlmIChJU19FUlIodmFkZHIpKSB7Ci0JCQllcnIgPSBQVFJfRVJSKHZhZGRyKTsKLQkJ
CWdvdG8gb3V0OwotCQl9Ci0KLQkJcnEtPmVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSA9IGk5MTVfZ2Vt
X29iamVjdF9nZXQoc3RhdGUtPm9iaik7Ci0JCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAoc3Rh
dGUtPm9iaik7Ci0JfQotCi1vdXQ6Ci0JLyoKLQkgKiBJZiB3ZSBoYXZlIHRvIGFiYW5kb24gbm93
LCB3ZSBleHBlY3QgdGhlIGVuZ2luZXMgdG8gYmUgaWRsZQotCSAqIGFuZCByZWFkeSB0byBiZSB0
b3JuLWRvd24uIFRoZSBxdWlja2VzdCB3YXkgd2UgY2FuIGFjY29tcGxpc2gKLQkgKiB0aGlzIGlz
IGJ5IGRlY2xhcmluZyBvdXJzZWx2ZXMgd2VkZ2VkLgotCSAqLwotCWlmIChlcnIpCi0JCWludGVs
X2d0X3NldF93ZWRnZWQoZ3QpOwotCi0JZm9yIChpZCA9IDA7IGlkIDwgQVJSQVlfU0laRShyZXF1
ZXN0cyk7IGlkKyspIHsKLQkJc3RydWN0IGludGVsX2NvbnRleHQgKmNlOwotCQlzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpycTsKLQotCQlycSA9IHJlcXVlc3RzW2lkXTsKLQkJaWYgKCFycSkKLQkJCWNv
bnRpbnVlOwotCi0JCWNlID0gcnEtPmNvbnRleHQ7Ci0JCWk5MTVfcmVxdWVzdF9wdXQocnEpOwot
CQlpbnRlbF9jb250ZXh0X3B1dChjZSk7Ci0JfQotCXJldHVybiBlcnI7Ci19Ci0KLXN0YXRpYyBp
bnQgaW50ZWxfZW5naW5lc192ZXJpZnlfd29ya2Fyb3VuZHMoc3RydWN0IGludGVsX2d0ICpndCkK
LXsKLQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0JZW51bSBpbnRlbF9lbmdpbmVf
aWQgaWQ7Ci0JaW50IGVyciA9IDA7Ci0KLQlpZiAoIUlTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1
X0RFQlVHX0dFTSkpCi0JCXJldHVybiAwOwotCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3Qs
IGlkKSB7Ci0JCWlmIChpbnRlbF9lbmdpbmVfdmVyaWZ5X3dvcmthcm91bmRzKGVuZ2luZSwgImxv
YWQiKSkKLQkJCWVyciA9IC1FSU87Ci0JfQotCi0JcmV0dXJuIGVycjsKLX0KLQogaW50IGk5MTVf
Z2VtX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewogCWludCByZXQ7
CkBAIC0xMjAxLDQ1ICsxMDQ3LDEyIEBAIGludCBpOTE1X2dlbV9pbml0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKIAlpbnRlbF91Y19mZXRjaF9maXJtd2FyZXMoJmRldl9wcml2
LT5ndC51Yyk7CiAJaW50ZWxfd29wY21faW5pdCgmZGV2X3ByaXYtPndvcGNtKTsKIAotCS8qIFRo
aXMgaXMganVzdCBhIHNlY3VyaXR5IGJsYW5rZXQgdG8gcGxhY2F0ZSBkcmFnb25zLgotCSAqIE9u
IHNvbWUgc3lzdGVtcywgd2UgdmVyeSBzcG9yYWRpY2FsbHkgb2JzZXJ2ZSB0aGF0IHRoZSBmaXJz
dCBUTEJzCi0JICogdXNlZCBieSB0aGUgQ1MgbWF5IGJlIHN0YWxlLCBkZXNwaXRlIHVzIHBva2lu
ZyB0aGUgVExCIHJlc2V0LiBJZgotCSAqIHdlIGhvbGQgdGhlIGZvcmNld2FrZSBkdXJpbmcgaW5p
dGlhbGlzYXRpb24gdGhlc2UgcHJvYmxlbXMKLQkgKiBqdXN0IG1hZ2ljYWxseSBnbyBhd2F5Lgot
CSAqLwotCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JD
RVdBS0VfQUxMKTsKLQogCXJldCA9IGk5MTVfaW5pdF9nZ3R0KGRldl9wcml2KTsKIAlpZiAocmV0
KSB7CiAJCUdFTV9CVUdfT04ocmV0ID09IC1FSU8pOwogCQlnb3RvIGVycl91bmxvY2s7CiAJfQog
Ci0JaW50ZWxfZ3RfaW5pdCgmZGV2X3ByaXYtPmd0KTsKLQotCXJldCA9IGludGVsX2VuZ2luZXNf
c2V0dXAoJmRldl9wcml2LT5ndCk7Ci0JaWYgKHJldCkgewotCQlHRU1fQlVHX09OKHJldCA9PSAt
RUlPKTsKLQkJZ290byBlcnJfZ3RfZWFybHk7Ci0JfQotCi0JcmV0ID0gaW50ZWxfZW5naW5lc19p
bml0KCZkZXZfcHJpdi0+Z3QpOwotCWlmIChyZXQpIHsKLQkJR0VNX0JVR19PTihyZXQgPT0gLUVJ
Tyk7Ci0JCWdvdG8gZXJyX2VuZ2luZXM7Ci0JfQotCi0JaW50ZWxfdWNfaW5pdCgmZGV2X3ByaXYt
Pmd0LnVjKTsKLQotCXJldCA9IGludGVsX2d0X2luaXRfaHcoJmRldl9wcml2LT5ndCk7Ci0JaWYg
KHJldCkKLQkJZ290byBlcnJfdWNfaW5pdDsKLQotCS8qIE9ubHkgd2hlbiB0aGUgSFcgaXMgcmUt
aW5pdGlhbGlzZWQsIGNhbiB3ZSByZXBsYXkgdGhlIHJlcXVlc3RzICovCi0JcmV0ID0gaW50ZWxf
Z3RfcmVzdW1lKCZkZXZfcHJpdi0+Z3QpOwotCWlmIChyZXQpCi0JCWdvdG8gZXJyX2luaXRfaHc7
Ci0KIAkvKgogCSAqIERlc3BpdGUgaXRzIG5hbWUgaW50ZWxfaW5pdF9jbG9ja19nYXRpbmcgYXBw
bGllcyBib3RoIGRpc3BsYXkKIAkgKiBjbG9jayBnYXRpbmcgd29ya2Fyb3VuZHM7IEdUIG1taW8g
d29ya2Fyb3VuZHMgYW5kIHRoZSBvY2Nhc2lvbmFsCkBAIC0xMjUxLDIzICsxMDY0LDkgQEAgaW50
IGk5MTVfZ2VtX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCSAqLwog
CWludGVsX2luaXRfY2xvY2tfZ2F0aW5nKGRldl9wcml2KTsKIAotCXJldCA9IGludGVsX2VuZ2lu
ZXNfdmVyaWZ5X3dvcmthcm91bmRzKCZkZXZfcHJpdi0+Z3QpOwotCWlmIChyZXQpCi0JCWdvdG8g
ZXJyX2d0X2xhdGU7Ci0KLQlyZXQgPSBfX2ludGVsX2VuZ2luZXNfcmVjb3JkX2RlZmF1bHRzKCZk
ZXZfcHJpdi0+Z3QpOwotCWlmIChyZXQpCi0JCWdvdG8gZXJyX2d0X2xhdGU7Ci0KLQlyZXQgPSBp
OTE1X2luamVjdF9wcm9iZV9lcnJvcihkZXZfcHJpdiwgLUVOT0RFVik7CisJcmV0ID0gaW50ZWxf
Z3RfaW5pdCgmZGV2X3ByaXYtPmd0KTsKIAlpZiAocmV0KQotCQlnb3RvIGVycl9ndF9sYXRlOwot
Ci0JcmV0ID0gaTkxNV9pbmplY3RfcHJvYmVfZXJyb3IoZGV2X3ByaXYsIC1FSU8pOwotCWlmIChy
ZXQpCi0JCWdvdG8gZXJyX2d0X2xhdGU7Ci0KLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgm
ZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7CisJCWdvdG8gZXJyX3VubG9jazsKIAog
CXJldHVybiAwOwogCkBAIC0xMjc3LDI0ICsxMDc2LDggQEAgaW50IGk5MTVfZ2VtX2luaXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCSAqIEhXIGFzIGlycmV2aXNpYmx5IHdl
ZGdlZCwgYnV0IGtlZXAgZW5vdWdoIHN0YXRlIGFyb3VuZCB0aGF0IHRoZQogCSAqIGRyaXZlciBk
b2Vzbid0IGV4cGxvZGUgZHVyaW5nIHJ1bnRpbWUuCiAJICovCi1lcnJfZ3RfbGF0ZToKLQlpbnRl
bF9ndF9zZXRfd2VkZ2VkX29uX2luaXQoJmRldl9wcml2LT5ndCk7Ci0JaTkxNV9nZW1fc3VzcGVu
ZChkZXZfcHJpdik7Ci0JaTkxNV9nZW1fc3VzcGVuZF9sYXRlKGRldl9wcml2KTsKLQotCWk5MTVf
Z2VtX2RyYWluX3dvcmtxdWV1ZShkZXZfcHJpdik7Ci1lcnJfaW5pdF9odzoKLQlpbnRlbF91Y19m
aW5pX2h3KCZkZXZfcHJpdi0+Z3QudWMpOwotZXJyX3VjX2luaXQ6Ci0JaWYgKHJldCAhPSAtRUlP
KQotCQlpbnRlbF91Y19maW5pKCZkZXZfcHJpdi0+Z3QudWMpOwotZXJyX2VuZ2luZXM6Ci0JaWYg
KHJldCAhPSAtRUlPKQotCQlpbnRlbF9lbmdpbmVzX2NsZWFudXAoJmRldl9wcml2LT5ndCk7Ci1l
cnJfZ3RfZWFybHk6Ci0JaW50ZWxfZ3RfZHJpdmVyX3JlbGVhc2UoJmRldl9wcml2LT5ndCk7CiBl
cnJfdW5sb2NrOgotCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZkZXZfcHJpdi0+dW5jb3Jl
LCBGT1JDRVdBS0VfQUxMKTsKKwlpOTE1X2dlbV9kcmFpbl93b3JrcXVldWUoZGV2X3ByaXYpOwog
CiAJaWYgKHJldCAhPSAtRUlPKSB7CiAJCWludGVsX3VjX2NsZWFudXBfZmlybXdhcmVzKCZkZXZf
cHJpdi0+Z3QudWMpOwpAQCAtMTM0MiwxOSArMTEyNSwxNiBAQCB2b2lkIGk5MTVfZ2VtX2RyaXZl
cl9yZW1vdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCiAJaTkxNV9nZW1f
c3VzcGVuZF9sYXRlKGRldl9wcml2KTsKIAlpbnRlbF9ndF9kcml2ZXJfcmVtb3ZlKCZkZXZfcHJp
di0+Z3QpOworCWRldl9wcml2LT51YWJpX2VuZ2luZXMgPSBSQl9ST09UOwogCiAJLyogRmx1c2gg
YW55IG91dHN0YW5kaW5nIHVucGluX3dvcmsuICovCiAJaTkxNV9nZW1fZHJhaW5fd29ya3F1ZXVl
KGRldl9wcml2KTsKIAotCWludGVsX3VjX2ZpbmlfaHcoJmRldl9wcml2LT5ndC51Yyk7Ci0JaW50
ZWxfdWNfZmluaSgmZGV2X3ByaXYtPmd0LnVjKTsKLQogCWk5MTVfZ2VtX2RyYWluX2ZyZWVkX29i
amVjdHMoZGV2X3ByaXYpOwogfQogCiB2b2lkIGk5MTVfZ2VtX2RyaXZlcl9yZWxlYXNlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKLQlpbnRlbF9lbmdpbmVzX2NsZWFudXAo
JmRldl9wcml2LT5ndCk7CiAJaW50ZWxfZ3RfZHJpdmVyX3JlbGVhc2UoJmRldl9wcml2LT5ndCk7
CiAKIAlpbnRlbF93YV9saXN0X2ZyZWUoJmRldl9wcml2LT5ndF93YV9saXN0KTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbS5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtLmMKaW5kZXggNjU3ZTIzYThkZDExLi5iMzdm
YzUzOTczY2MgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1
X2dlbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbS5jCkBA
IC05LDYgKzksNyBAQAogI2luY2x1ZGUgImdlbS9zZWxmdGVzdHMvaWd0X2dlbV91dGlscy5oIgog
I2luY2x1ZGUgImdlbS9zZWxmdGVzdHMvbW9ja19jb250ZXh0LmgiCiAjaW5jbHVkZSAiZ3QvaW50
ZWxfZ3QuaCIKKyNpbmNsdWRlICJndC9pbnRlbF9ndF9wbS5oIgogCiAjaW5jbHVkZSAiaTkxNV9z
ZWxmdGVzdC5oIgogCi0tIAoyLjI0LjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZy
ZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3Rp
bmZvL2ludGVsLWdmeA==

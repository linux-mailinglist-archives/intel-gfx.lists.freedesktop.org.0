Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id BDBAB9B420
	for <lists+intel-gfx@lfdr.de>; Fri, 23 Aug 2019 18:01:01 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2334B6ECDA;
	Fri, 23 Aug 2019 16:01:00 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga01.intel.com (mga01.intel.com [192.55.52.88])
 by gabe.freedesktop.org (Postfix) with ESMTPS id D3B976ECDA
 for <intel-gfx@lists.freedesktop.org>; Fri, 23 Aug 2019 16:00:58 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga008.fm.intel.com ([10.253.24.58])
 by fmsmga101.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 23 Aug 2019 09:00:58 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,421,1559545200"; d="scan'208";a="179200947"
Received: from gaia.fi.intel.com ([10.237.72.192])
 by fmsmga008.fm.intel.com with ESMTP; 23 Aug 2019 09:00:57 -0700
Received: by gaia.fi.intel.com (Postfix, from userid 1000)
 id 5240C5C1EC1; Fri, 23 Aug 2019 19:00:08 +0300 (EEST)
From: Mika Kuoppala <mika.kuoppala@linux.intel.com>
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
In-Reply-To: <20190823132700.25286-7-chris@chris-wilson.co.uk>
References: <20190823132700.25286-1-chris@chris-wilson.co.uk>
 <20190823132700.25286-7-chris@chris-wilson.co.uk>
Date: Fri, 23 Aug 2019 19:00:08 +0300
Message-ID: <87o90fub1z.fsf@gaia.fi.intel.com>
MIME-Version: 1.0
Subject: Re: [Intel-gfx] [PATCH 06/15] drm/i915: Mark up obj->pin_global as
 being atomic
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Q2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+IHdyaXRlczoKCj4gQ29taW5n
IHVwIG5leHQsIHdlIHdpbGwgd2FudCB0byBtYW5pcHVsYXRlIHRoZSBwaW5fZ2xvYmFsIGNvdW50
ZXIKPiBvdXRzaWRlIG9mIHRoZSBwcmluY2lwbGUgbG9ja3MsIHNvIGNvbnZlcnQgaXQgdG8gYW4g
YXRvbWljLgo+CgpJIGFtIG5vdCB5ZXQgdXAgdG8gc3BlZWQgb24gcGluX2dsb2JhbCBidXQKYmVp
bmcgcGFydCBvZiBhIHNlcmllcyB3aGVyZSB3aGVyZSB0aGlzIG5lZWRzCnRvIGJlIGF0b21pYywg
dGhlIHBhdGNoIGRvZXMgd2hhdCBpdCBzYXlzIG9uIHRoZSB0aW4uCgpSZXZpZXdlZC1ieTogTWlr
YSBLdW9wcGFsYSA8bWlrYS5rdW9wcGFsYUBsaW51eC5pbnRlbC5jb20+CgoKPiBTaWduZWQtb2Zm
LWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KPiAtLS0KPiAgZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5jICAgICAgIHwgMTIgKysrKysr
LS0tLS0tCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaCAgICAg
ICB8ICAzICsrLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0X3R5
cGVzLmggfCAgMiArLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fc2hyaW5r
ZXIuYyAgICAgfCAgMiArLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYyAg
ICAgICAgICAgICAgfCAgNCArKy0tCj4gIDUgZmlsZXMgY2hhbmdlZCwgMTIgaW5zZXJ0aW9ucygr
KSwgMTEgZGVsZXRpb25zKC0pCj4KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX2RvbWFpbi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X2RvbWFpbi5jCj4gaW5kZXggZWYzMzAwMWU4ZGRiLi5iN2JlOWFkMmI2MmMgMTAwNjQ0Cj4gLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5jCj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5jCj4gQEAgLTI3LDcgKzI3LDcg
QEAgc3RhdGljIHZvaWQgX19pOTE1X2dlbV9vYmplY3RfZmx1c2hfZm9yX2Rpc3BsYXkoc3RydWN0
IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKPiAgCj4gIHZvaWQgaTkxNV9nZW1fb2JqZWN0X2Zs
dXNoX2lmX2Rpc3BsYXkoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKPiAgewo+IC0J
aWYgKCFSRUFEX09OQ0Uob2JqLT5waW5fZ2xvYmFsKSkKPiArCWlmICghYXRvbWljX3JlYWQoJm9i
ai0+cGluX2dsb2JhbCkpCj4gIAkJcmV0dXJuOwo+ICAKPiAgCWk5MTVfZ2VtX29iamVjdF9sb2Nr
KG9iaik7Cj4gQEAgLTQyNSw3ICs0MjUsNyBAQCBpOTE1X2dlbV9vYmplY3RfcGluX3RvX2Rpc3Bs
YXlfcGxhbmUoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKPiAgCS8qIE1hcmsgdGhl
IGdsb2JhbCBwaW4gZWFybHkgc28gdGhhdCB3ZSBhY2NvdW50IGZvciB0aGUKPiAgCSAqIGRpc3Bs
YXkgY29oZXJlbmN5IHdoaWxzdCBzZXR0aW5nIHVwIHRoZSBjYWNoZSBkb21haW5zLgo+ICAJICov
Cj4gLQlvYmotPnBpbl9nbG9iYWwrKzsKPiArCWF0b21pY19pbmMoJm9iai0+cGluX2dsb2JhbCk7
Cj4gIAo+ICAJLyogVGhlIGRpc3BsYXkgZW5naW5lIGlzIG5vdCBjb2hlcmVudCB3aXRoIHRoZSBM
TEMgY2FjaGUgb24gZ2VuNi4gIEFzCj4gIAkgKiBhIHJlc3VsdCwgd2UgbWFrZSBzdXJlIHRoYXQg
dGhlIHBpbm5pbmcgdGhhdCBpcyBhYm91dCB0byBvY2N1ciBpcwo+IEBAIC00NzUsNyArNDc1LDcg
QEAgaTkxNV9nZW1fb2JqZWN0X3Bpbl90b19kaXNwbGF5X3BsYW5lKHN0cnVjdCBkcm1faTkxNV9n
ZW1fb2JqZWN0ICpvYmosCj4gIAlyZXR1cm4gdm1hOwo+ICAKPiAgZXJyX3VucGluX2dsb2JhbDoK
PiAtCW9iai0+cGluX2dsb2JhbC0tOwo+ICsJYXRvbWljX2RlYygmb2JqLT5waW5fZ2xvYmFsKTsK
PiAgCXJldHVybiB2bWE7Cj4gIH0KPiAgCj4gQEAgLTUxNSwxMSArNTE1LDExIEBAIGk5MTVfZ2Vt
X29iamVjdF91bnBpbl9mcm9tX2Rpc3BsYXlfcGxhbmUoc3RydWN0IGk5MTVfdm1hICp2bWEpCj4g
IAo+ICAJYXNzZXJ0X29iamVjdF9oZWxkKG9iaik7Cj4gIAo+IC0JaWYgKFdBUk5fT04ob2JqLT5w
aW5fZ2xvYmFsID09IDApKQo+ICsJaWYgKEdFTV9XQVJOX09OKCFhdG9taWNfcmVhZCgmb2JqLT5w
aW5fZ2xvYmFsKSkpCj4gIAkJcmV0dXJuOwo+ICAKPiAtCWlmICgtLW9iai0+cGluX2dsb2JhbCA9
PSAwKQo+IC0JCXZtYS0+ZGlzcGxheV9hbGlnbm1lbnQgPSBJOTE1X0dUVF9NSU5fQUxJR05NRU5U
Owo+ICsJaWYgKGF0b21pY19kZWNfYW5kX3Rlc3QoJm9iai0+cGluX2dsb2JhbCkpCj4gKwkJdm1h
LT5kaXNwbGF5X2FsaWdubWVudCA9IEk5MTVfR1RUX01JTl9BTElHTk1FTlQ7IC8qIFhYWCByYWNl
ICovCj4gIAo+ICAJLyogQnVtcCB0aGUgTFJVIHRvIHRyeSBhbmQgYXZvaWQgcHJlbWF0dXJlIGV2
aWN0aW9uIHdoaWxzdCBmbGlwcGluZyAgKi8KPiAgCWk5MTVfZ2VtX29iamVjdF9idW1wX2luYWN0
aXZlX2dndHQob2JqKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5
MTVfZ2VtX29iamVjdC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVj
dC5oCj4gaW5kZXggNWVmYjk5MzZlMDViLi4xMWJiMWE0MTJlNGYgMTAwNjQ0Cj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oCj4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oCj4gQEAgLTQwNiw3ICs0MDYsOCBAQCBz
dGF0aWMgaW5saW5lIGJvb2wgY3B1X3dyaXRlX25lZWRzX2NsZmx1c2goc3RydWN0IGRybV9pOTE1
X2dlbV9vYmplY3QgKm9iaikKPiAgCWlmICghKG9iai0+Y2FjaGVfY29oZXJlbnQgJiBJOTE1X0JP
X0NBQ0hFX0NPSEVSRU5UX0ZPUl9XUklURSkpCj4gIAkJcmV0dXJuIHRydWU7Cj4gIAo+IC0JcmV0
dXJuIG9iai0+cGluX2dsb2JhbDsgLyogY3VycmVudGx5IGluIHVzZSBieSBIVywga2VlcCBmbHVz
aGVkICovCj4gKwkvKiBDdXJyZW50bHkgaW4gdXNlIGJ5IEhXIChkaXNwbGF5IGVuZ2luZSk/IEtl
ZXAgZmx1c2hlZC4gKi8KPiArCXJldHVybiBhdG9taWNfcmVhZCgmb2JqLT5waW5fZ2xvYmFsKTsK
PiAgfQo+ICAKPiAgc3RhdGljIGlubGluZSB2b2lkIF9fc3RhcnRfY3B1X3dyaXRlKHN0cnVjdCBk
cm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaAo+IGluZGV4IDUxMWZjZTc5MTNlYy4uYTA5ZTc0ZTI3
NzM0IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmpl
Y3RfdHlwZXMuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmpl
Y3RfdHlwZXMuaAo+IEBAIC0xNTMsNyArMTUzLDcgQEAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3Qgewo+ICAJLyoqIENvdW50IG9mIFZNQSBhY3R1YWxseSBib3VuZCBieSB0aGlzIG9iamVjdCAq
Lwo+ICAJYXRvbWljX3QgYmluZF9jb3VudDsKPiAgCS8qKiBDb3VudCBvZiBob3cgbWFueSBnbG9i
YWwgVk1BIGFyZSBjdXJyZW50bHkgcGlubmVkIGZvciB1c2UgYnkgSFcgKi8KPiAtCXVuc2lnbmVk
IGludCBwaW5fZ2xvYmFsOwo+ICsJYXRvbWljX3QgcGluX2dsb2JhbDsKPiAgCj4gIAlzdHJ1Y3Qg
ewo+ICAJCXN0cnVjdCBtdXRleCBsb2NrOyAvKiBwcm90ZWN0cyB0aGUgcGFnZXMgYW5kIHRoZWly
IHVzZSAqLwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
c2hyaW5rZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9zaHJpbmtlci5j
Cj4gaW5kZXggOTQ5NzBmNjBkN2Y2Li44NDFmMTgzODZiNTQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3Nocmlua2VyLmMKPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fc2hyaW5rZXIuYwo+IEBAIC03OCw3ICs3OCw3IEBAIHN0
YXRpYyBib29sIGNhbl9yZWxlYXNlX3BhZ2VzKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpv
YmopCj4gIAkgKiBUbyBzaW1wbGlmeSB0aGUgc2NhbiwgYW5kIHRvIGF2b2lkIHdhbGtpbmcgdGhl
IGxpc3Qgb2Ygdm1hIHVuZGVyIHRoZQo+ICAJICogb2JqZWN0LCB3ZSBqdXN0IGNoZWNrIHRoZSBj
b3VudCBvZiBpdHMgcGVybWFuZW50bHkgcGlubmVkLgo+ICAJICovCj4gLQlpZiAoUkVBRF9PTkNF
KG9iai0+cGluX2dsb2JhbCkpCj4gKwlpZiAoYXRvbWljX3JlYWQoJm9iai0+cGluX2dsb2JhbCkp
Cj4gIAkJcmV0dXJuIGZhbHNlOwo+ICAKPiAgCS8qIFdlIGNhbiBvbmx5IHJldHVybiBwaHlzaWNh
bCBwYWdlcyB0byB0aGUgc3lzdGVtIGlmIHdlIGNhbiBlaXRoZXIKPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2RlYnVnZnMuYwo+IGluZGV4IGUxMDNmY2JhNjQzNS4uYzM2NTM4ZjFiMzZjIDEwMDY0NAo+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCj4gKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKPiBAQCAtNzksNyArNzksNyBAQCBzdGF0aWMg
aW50IGk5MTVfY2FwYWJpbGl0aWVzKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiAg
Cj4gIHN0YXRpYyBjaGFyIGdldF9waW5fZmxhZyhzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAq
b2JqKQo+ICB7Cj4gLQlyZXR1cm4gb2JqLT5waW5fZ2xvYmFsID8gJ3AnIDogJyAnOwo+ICsJcmV0
dXJuIGF0b21pY19yZWFkKCZvYmotPnBpbl9nbG9iYWwpID8gJ3AnIDogJyAnOwo+ICB9Cj4gIAo+
ICBzdGF0aWMgY2hhciBnZXRfdGlsaW5nX2ZsYWcoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iaikKPiBAQCAtMjIxLDcgKzIyMSw3IEBAIGRlc2NyaWJlX29iaihzdHJ1Y3Qgc2VxX2ZpbGUg
Km0sIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCj4gIAlzZXFfcHJpbnRmKG0sICIg
KHBpbm5lZCB4ICVkKSIsIHBpbl9jb3VudCk7Cj4gIAlpZiAob2JqLT5zdG9sZW4pCj4gIAkJc2Vx
X3ByaW50ZihtLCAiIChzdG9sZW46ICUwOGxseCkiLCBvYmotPnN0b2xlbi0+c3RhcnQpOwo+IC0J
aWYgKG9iai0+cGluX2dsb2JhbCkKPiArCWlmIChhdG9taWNfcmVhZCgmb2JqLT5waW5fZ2xvYmFs
KSkKPiAgCQlzZXFfcHJpbnRmKG0sICIgKGdsb2JhbCkiKTsKPiAgCj4gIAllbmdpbmUgPSBpOTE1
X2dlbV9vYmplY3RfbGFzdF93cml0ZV9lbmdpbmUob2JqKTsKPiAtLSAKPiAyLjIzLjAKPgo+IF9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCj4gSW50ZWwtZ2Z4
IG1haWxpbmcgbGlzdAo+IEludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKPiBodHRwczov
L2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeApfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGlu
ZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVl
ZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 0C27B10FA83
	for <lists+intel-gfx@lfdr.de>; Tue,  3 Dec 2019 10:13:43 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 4FDDE6E43C;
	Tue,  3 Dec 2019 09:13:41 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga04.intel.com (mga04.intel.com [192.55.52.120])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 388856E43C
 for <intel-gfx@lists.freedesktop.org>; Tue,  3 Dec 2019 09:13:39 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga008.jf.intel.com ([10.7.209.65])
 by fmsmga104.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 03 Dec 2019 01:13:38 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.69,272,1571727600"; d="scan'208";a="204907079"
Received: from dkhazov-mobl.ger.corp.intel.com (HELO [10.252.34.197])
 ([10.252.34.197])
 by orsmga008.jf.intel.com with ESMTP; 03 Dec 2019 01:13:37 -0800
To: =?UTF-8?B?VmlsbGUgU3lyasOkbMOk?= <ville.syrjala@linux.intel.com>
References: <20191114160522.9699-1-maarten.lankhorst@linux.intel.com>
 <20191114160522.9699-5-maarten.lankhorst@linux.intel.com>
 <20191128192435.GA1208@intel.com>
From: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
Message-ID: <9ace2b1b-597d-6d4a-c74b-7eaaedf29f9d@linux.intel.com>
Date: Tue, 3 Dec 2019 10:13:36 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.9.0
MIME-Version: 1.0
In-Reply-To: <20191128192435.GA1208@intel.com>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH 05/11] drm/i915: Try to make bigjoiner work
 in atomic check, v3.
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: intel-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T3AgMjgtMTEtMjAxOSBvbSAyMDoyNCBzY2hyZWVmIFZpbGxlIFN5cmrDpGzDpDoKPiBPbiBUaHUs
IE5vdiAxNCwgMjAxOSBhdCAwNTowNToxNlBNICswMTAwLCBNYWFydGVuIExhbmtob3JzdCB3cm90
ZToKPj4gV2hlbiB0aGUgY2xvY2sgaXMgaGlnaGVyIHRoYW4gdGhlIGRvdGNsb2NrLCB0cnkgd2l0
aCAyIHBpcGVzIGVuYWJsZWQuCj4+IElmIHdlIGNhbiBlbmFibGUgMiwgdGhlbiB3ZSB3aWxsIGdv
IGludG8gYmlnIGpvaW5lciBtb2RlLCBhbmQgc3RlYWwKPj4gdGhlIGFkamFjZW50IGNydGMuCj4+
Cj4+IFRoaXMgb25seSBsaW5rcyB0aGUgY3J0YydzIGluIHNvZnR3YXJlLCBubyBoYXJkd2FyZSBv
ciBwbGFuZQo+PiBwcm9ncmFtbWluZyBpcyBkb25lIHlldC4gQmxvYnMgYXJlIGFsc28gY29waWVk
IGZyb20gdGhlIG1hc3RlcidzCj4+IGNydGNfc3RhdGUsIHNvIGl0IGRvZXNuJ3QgZGVwZW5kIGF0
IGNvbW1pdCB0aW1lIG9uIHRoZSBvdGhlcgo+PiBjcnRjX3N0YXRlLgo+Pgo+PiBDaGFuZ2VzIHNp
bmNlIHYxOgo+PiAtIFJlbmFtZSBwaXBlIHRpbWluZ3MgdG8gdHJhbnNjb2RlciB0aW1pbmdzLCBh
cyB0aGV5IGFyZSBub3cgZGlmZmVyZW50Lgo+PiBDaGFuZ2VzIHNpbmNlIHYyOgo+PiAtIFJld29y
ayBiaWdqb2luZXIgY2hlY2tzOyBhbHdheXMgZGlzYWJsZSBzbGF2ZSB3aGVuIHJlY2FsY3VsYXRp
bmcKPj4gICBtYXN0ZXIuIE5vIG5lZWQgdG8gaGF2ZSBhIHNlcGFyYXRlIGJpZ2pvaW5lciBwYXNz
IGFueSBtb3JlLgo+PiAtIFVzZSBwaXBlX21vZGUgaW5zdGVhZCBvZiB0cmFuc2NvZGVyX21vZGUs
IHRvIGNsZWFuIHVwIHRoZSBjb2RlLgo+Pgo+PiBTaWduZWQtb2ZmLWJ5OiBNYWFydGVuIExhbmto
b3JzdCA8bWFhcnRlbi5sYW5raG9yc3RAbGludXguaW50ZWwuY29tPgo+PiAtLS0KPj4gIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWljLmMgICB8ICAgOSArLQo+PiAgZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9taWMuaCAgIHwgICAzICstCj4+ICBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyAgfCAxOTggKysrKysr
KysrKysrKysrKy0tCj4+ICAuLi4vZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVz
LmggICAgfCAgIDkgKwo+PiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5j
ICAgICAgIHwgIDIyICstCj4+ICA1IGZpbGVzIGNoYW5nZWQsIDIwNyBpbnNlcnRpb25zKCspLCAz
NCBkZWxldGlvbnMoLSkKPj4KPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfYXRvbWljLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2F0b21pYy5jCj4+IGluZGV4IGZkMDAyNmZjMzYxOC4uYjVjMTdkOGMwMjA4IDEwMDY0NAo+PiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0b21pYy5jCj4+ICsrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWljLmMKPj4gQEAgLTIyOSwx
NCArMjI5LDE1IEBAIHZvaWQgaW50ZWxfY3J0Y19mcmVlX2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgCWludGVsX2NydGNfcHV0X2NvbG9yX2Jsb2JzKGNy
dGNfc3RhdGUpOwo+PiAgfQo+PiAgCj4+IC12b2lkIGludGVsX2NydGNfY29weV9jb2xvcl9ibG9i
cyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gK3ZvaWQgaW50ZWxfY3J0
Y19jb3B5X2NvbG9yX2Jsb2JzKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+
PiArCQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqZnJvbV9jcnRjX3N0YXRlKQo+
PiAgewo+PiAgCWRybV9wcm9wZXJ0eV9yZXBsYWNlX2Jsb2IoJmNydGNfc3RhdGUtPmh3LmRlZ2Ft
bWFfbHV0LAo+PiAtCQkJCSAgY3J0Y19zdGF0ZS0+dWFwaS5kZWdhbW1hX2x1dCk7Cj4+ICsJCQkJ
ICBmcm9tX2NydGNfc3RhdGUtPnVhcGkuZGVnYW1tYV9sdXQpOwo+PiAgCWRybV9wcm9wZXJ0eV9y
ZXBsYWNlX2Jsb2IoJmNydGNfc3RhdGUtPmh3LmdhbW1hX2x1dCwKPj4gLQkJCQkgIGNydGNfc3Rh
dGUtPnVhcGkuZ2FtbWFfbHV0KTsKPj4gKwkJCQkgIGZyb21fY3J0Y19zdGF0ZS0+dWFwaS5nYW1t
YV9sdXQpOwo+PiAgCWRybV9wcm9wZXJ0eV9yZXBsYWNlX2Jsb2IoJmNydGNfc3RhdGUtPmh3LmN0
bSwKPj4gLQkJCQkgIGNydGNfc3RhdGUtPnVhcGkuY3RtKTsKPj4gKwkJCQkgIGZyb21fY3J0Y19z
dGF0ZS0+dWFwaS5jdG0pOwo+PiAgfQo+PiAgCj4+ICAvKioKPj4gZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWljLmggYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2F0b21pYy5oCj4+IGluZGV4IDdiNDk2MjM0MTliYS4uZTY0NDcz
MjI3Mjg1IDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2F0b21pYy5oCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRv
bWljLmgKPj4gQEAgLTM3LDcgKzM3LDggQEAgc3RydWN0IGRybV9jcnRjX3N0YXRlICppbnRlbF9j
cnRjX2R1cGxpY2F0ZV9zdGF0ZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMpOwo+PiAgdm9pZCBpbnRl
bF9jcnRjX2Rlc3Ryb3lfc3RhdGUoc3RydWN0IGRybV9jcnRjICpjcnRjLAo+PiAgCQkJICAgICAg
IHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqc3RhdGUpOwo+PiAgdm9pZCBpbnRlbF9jcnRjX2ZyZWVf
aHdfc3RhdGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpOwo+PiAtdm9pZCBp
bnRlbF9jcnRjX2NvcHlfY29sb3JfYmxvYnMoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUpOwo+PiArdm9pZCBpbnRlbF9jcnRjX2NvcHlfY29sb3JfYmxvYnMoc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+ICsJCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpmcm9tX2NydGNfc3RhdGUpOwo+PiAgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKmlu
dGVsX2F0b21pY19zdGF0ZV9hbGxvYyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KTsKPj4gIHZvaWQg
aW50ZWxfYXRvbWljX3N0YXRlX2NsZWFyKHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSk7
Cj4+ICAKPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZGlzcGxheS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMK
Pj4gaW5kZXggN2E2ZGE4NTgyM2FmLi4yZGM2M2VmNWNhZjggMTAwNjQ0Cj4+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCj4+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCj4+IEBAIC03NTc2LDkgKzc1NzYs
MjUgQEAgc3RhdGljIGludCBpbnRlbF9jcnRjX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjLAo+PiAgCQkJCSAgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29u
ZmlnKQo+PiAgewo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY3J0Yy0+YmFzZS5kZXYpOwo+PiAtCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICpw
aXBlX21vZGUgPSAmcGlwZV9jb25maWctPmh3LnBpcGVfbW9kZTsKPj4gKwlzdHJ1Y3QgZHJtX2Rp
c3BsYXlfbW9kZSAqcGlwZV9tb2RlID0gJnBpcGVfY29uZmlnLT5ody5waXBlX21vZGU7Cj4+ICAJ
aW50IGNsb2NrX2xpbWl0ID0gZGV2X3ByaXYtPm1heF9kb3RjbGtfZnJlcTsKPj4gIAo+PiArCSpw
aXBlX21vZGUgPSBwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZTsKPj4gKwo+PiArCS8qIEFk
anVzdCBwaXBlX21vZGUgZm9yIGJpZ2pvaW5lciwgd2l0aCBoYWxmIHRoZSBob3Jpem9udGFsIG1v
ZGUgKi8KPj4gKwlpZiAocGlwZV9jb25maWctPmJpZ2pvaW5lcikgewo+PiArCQlwaXBlX21vZGUt
PmNydGNfY2xvY2sgLz0gMjsKPj4gKwkJcGlwZV9tb2RlLT5jcnRjX2hkaXNwbGF5IC89IDI7Cj4+
ICsJCXBpcGVfbW9kZS0+Y3J0Y19oYmxhbmtfc3RhcnQgLz0gMjsKPj4gKwkJcGlwZV9tb2RlLT5j
cnRjX2hibGFua19lbmQgLz0gMjsKPj4gKwkJcGlwZV9tb2RlLT5jcnRjX2hzeW5jX3N0YXJ0IC89
IDI7Cj4+ICsJCXBpcGVfbW9kZS0+Y3J0Y19oc3luY19lbmQgLz0gMjsKPj4gKwkJcGlwZV9tb2Rl
LT5jcnRjX2h0b3RhbCAvPSAyOwo+PiArCQlwaXBlX21vZGUtPmNydGNfaHNrZXcgLz0gMjsKPj4g
Kwo+PiArCQlwaXBlX2NvbmZpZy0+cGlwZV9zcmNfdyAvPSAyOwo+PiArCX0KPj4gKwo+PiAgCWlm
IChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNCkgewo+PiAgCQljbG9ja19saW1pdCA9IGRldl9wcml2
LT5tYXhfY2RjbGtfZnJlcSAqIDkgLyAxMDsKPj4gIAo+PiBAQCAtNzYzNSw3ICs3NjUxLDcgQEAg
c3RhdGljIGludCBpbnRlbF9jcnRjX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjLAo+PiAgCSAqIFdhUHJ1bmVNb2RlV2l0aEluY29ycmVjdEhzeW5jT2Zmc2V0OmN0ZyxlbGss
aWxrLHNuYixpdmIsdmx2LGhzdy4KPj4gIAkgKi8KPj4gIAlpZiAoKElOVEVMX0dFTihkZXZfcHJp
dikgPiA0IHx8IElTX0c0WChkZXZfcHJpdikpICYmCj4+IC0JCXBpcGVfbW9kZS0+Y3J0Y19oc3lu
Y19zdGFydCA9PSBwaXBlX21vZGUtPmNydGNfaGRpc3BsYXkpCj4+ICsJICAgIHBpcGVfY29uZmln
LT5ody5hZGp1c3RlZF9tb2RlLmNydGNfaHN5bmNfc3RhcnQgPT0gcGlwZV9tb2RlLT5jcnRjX2hk
aXNwbGF5KQo+IEEgYml0IGluY29uc2lzdGVudCBub3cuClllYWggc2hvdWxkIHByb2JhYmx5IHVz
ZSBhZGp1c3RlZF9tb2RlIGZvciBib3RoLgo+PiAgCQlyZXR1cm4gLUVJTlZBTDsKPj4gIAo+PiAg
CWludGVsX2NydGNfY29tcHV0ZV9waXhlbF9yYXRlKHBpcGVfY29uZmlnKTsKPj4gQEAgLTExOTIx
LDcgKzExOTM3LDcgQEAgc3RhdGljIGJvb2wgZW5jb2RlcnNfY2xvbmVhYmxlKGNvbnN0IHN0cnVj
dCBpbnRlbF9lbmNvZGVyICphLAo+PiAgCQkJICBiLT5jbG9uZWFibGUgJiAoMSA8PCBhLT50eXBl
KSk7Cj4+ICB9Cj4+ICAKPj4gLXN0YXRpYyBib29sIGNoZWNrX3NpbmdsZV9lbmNvZGVyX2Nsb25p
bmcoc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlLAo+PiArc3RhdGljIGJvb2wgY2hlY2tf
c2luZ2xlX2VuY29kZXJfY2xvbmluZyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwK
Pj4gIAkJCQkJIHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+PiAgCQkJCQkgc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIpCj4+ICB7Cj4+IEBAIC0xMTkzMCw3ICsxMTk0Niw3IEBAIHN0YXRp
YyBib29sIGNoZWNrX3NpbmdsZV9lbmNvZGVyX2Nsb25pbmcoc3RydWN0IGRybV9hdG9taWNfc3Rh
dGUgKnN0YXRlLAo+PiAgCXN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uZWN0b3Jfc3Rh
dGU7Cj4+ICAJaW50IGk7Cj4+ICAKPj4gLQlmb3JfZWFjaF9uZXdfY29ubmVjdG9yX2luX3N0YXRl
KHN0YXRlLCBjb25uZWN0b3IsIGNvbm5lY3Rvcl9zdGF0ZSwgaSkgewo+PiArCWZvcl9lYWNoX25l
d19jb25uZWN0b3JfaW5fc3RhdGUoJnN0YXRlLT5iYXNlLCBjb25uZWN0b3IsIGNvbm5lY3Rvcl9z
dGF0ZSwgaSkgewo+PiAgCQlpZiAoY29ubmVjdG9yX3N0YXRlLT5jcnRjICE9ICZjcnRjLT5iYXNl
KQo+PiAgCQkJY29udGludWU7Cj4+ICAKPj4gQEAgLTEyMTY3LDYgKzEyMTgzLDcgQEAgc3RhdGlj
IGludCBpbnRlbF9jcnRjX2F0b21pY19jaGVjayhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpz
dGF0ZSwKPj4gIAo+PiAgCWlmIChtb2RlX2NoYW5nZWQgJiYgY3J0Y19zdGF0ZS0+aHcuZW5hYmxl
ICYmCj4+ICAJICAgIGRldl9wcml2LT5kaXNwbGF5LmNydGNfY29tcHV0ZV9jbG9jayAmJgo+PiAr
CSAgICAhY3J0Y19zdGF0ZS0+Ymlnam9pbmVyX3NsYXZlICYmCj4gV2h5IGRvIHdlIG5lZWQgdGhp
cz8gV291bGRuJ3Qgd2UganVzdCBlbmQgdXAgc2hhcmluZyB0aGUgc2FtZSBEUExMCj4gZm9yIGJv
dGggcGlwZXMgYW55d2F5PwpUaGVyZSBpcyBubyBkcGxsIG9uIGJpZ2pvaW5lciBzbGF2ZS4gT25s
eSB0aGUgcGlwZSByZWdpc3RlcnMgYXJlIHRvdWNoZWQuIDopCj4KPj4gIAkgICAgIVdBUk5fT04o
Y3J0Y19zdGF0ZS0+c2hhcmVkX2RwbGwpKSB7Cj4+ICAJCXJldCA9IGRldl9wcml2LT5kaXNwbGF5
LmNydGNfY29tcHV0ZV9jbG9jayhjcnRjLCBjcnRjX3N0YXRlKTsKPj4gIAkJaWYgKHJldCkKPj4g
QEAgLTEyNjI3LDE4ICsxMjY0NCwzMSBAQCBzdGF0aWMgYm9vbCBjaGVja19kaWdpdGFsX3BvcnRf
Y29uZmxpY3RzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+PiAgfQo+PiAgCj4+
ICBzdGF0aWMgdm9pZAo+PiAtaW50ZWxfY3J0Y19jb3B5X3VhcGlfdG9faHdfc3RhdGVfbm9tb2Rl
c2V0KHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAraW50ZWxfY3J0Y19j
b3B5X3VhcGlfdG9faHdfc3RhdGVfbm9tb2Rlc2V0KHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUg
KnN0YXRlLAo+PiArCQkJCQkgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkK
Pj4gIHsKPj4gLQlpbnRlbF9jcnRjX2NvcHlfY29sb3JfYmxvYnMoY3J0Y19zdGF0ZSk7Cj4+ICsJ
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmZyb21fY3J0Y19zdGF0ZSA9IGNydGNfc3Rh
dGU7Cj4+ICsKPj4gKwlpZiAoY3J0Y19zdGF0ZS0+Ymlnam9pbmVyX3NsYXZlKSB7Cj4+ICsJCWZy
b21fY3J0Y19zdGF0ZSA9IGludGVsX2F0b21pY19nZXRfbmV3X2NydGNfc3RhdGUoc3RhdGUsCj4+
ICsJCQkJCWNydGNfc3RhdGUtPmJpZ2pvaW5lcl9saW5rZWRfY3J0Yyk7Cj4+ICsKPj4gKwkJLyog
Tm8gbmVlZCB0byBjb3B5IHN0YXRlIGlmIHRoZSBtYXN0ZXIgc3RhdGUgaXMgdW5jaGFuZ2VkICov
Cj4+ICsJCWlmICghZnJvbV9jcnRjX3N0YXRlKQo+PiArCQkJcmV0dXJuOwo+PiArCX0KPj4gKwo+
PiArCWludGVsX2NydGNfY29weV9jb2xvcl9ibG9icyhjcnRjX3N0YXRlLCBmcm9tX2NydGNfc3Rh
dGUpOwo+PiAgfQo+PiAgCj4+ICBzdGF0aWMgdm9pZAo+PiAtaW50ZWxfY3J0Y19jb3B5X3VhcGlf
dG9faHdfc3RhdGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICtpbnRl
bF9jcnRjX2NvcHlfdWFwaV90b19od19zdGF0ZShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpz
dGF0ZSwKPj4gKwkJCQkgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7
Cj4+ICAJY3J0Y19zdGF0ZS0+aHcuZW5hYmxlID0gY3J0Y19zdGF0ZS0+dWFwaS5lbmFibGU7Cj4+
ICAJY3J0Y19zdGF0ZS0+aHcuYWN0aXZlID0gY3J0Y19zdGF0ZS0+dWFwaS5hY3RpdmU7Cj4+ICAJ
Y3J0Y19zdGF0ZS0+aHcucGlwZV9tb2RlID0gY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZSA9
IGNydGNfc3RhdGUtPnVhcGkuYWRqdXN0ZWRfbW9kZTsKPj4gLQlpbnRlbF9jcnRjX2NvcHlfdWFw
aV90b19od19zdGF0ZV9ub21vZGVzZXQoY3J0Y19zdGF0ZSk7Cj4+ICsJaW50ZWxfY3J0Y19jb3B5
X3VhcGlfdG9faHdfc3RhdGVfbm9tb2Rlc2V0KHN0YXRlLCBjcnRjX3N0YXRlKTsKPj4gIH0KPj4g
IAo+PiAgc3RhdGljIHZvaWQgaW50ZWxfY3J0Y19jb3B5X2h3X3RvX3VhcGlfc3RhdGUoc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+IEBAIC0xMjY2MCw3ICsxMjY5MCw0OSBA
QCBzdGF0aWMgdm9pZCBpbnRlbF9jcnRjX2NvcHlfaHdfdG9fdWFwaV9zdGF0ZShzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZQo+PiAgfQo+PiAgCj4+ICBzdGF0aWMgaW50Cj4+IC1p
bnRlbF9jcnRjX3ByZXBhcmVfY2xlYXJlZF9zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSkKPj4gK2NvcHlfYmlnam9pbmVyX2NydGNfc3RhdGUoc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+ICsJCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpmcm9tX2NydGNfc3RhdGUpCj4+ICt7Cj4+ICsJc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KnNhdmVkX3N0YXRlOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0
YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiArCj4+ICsJc2F2ZWRfc3RhdGUgPSBrbWVtZHVw
KGZyb21fY3J0Y19zdGF0ZSwgc2l6ZW9mKCpzYXZlZF9zdGF0ZSksIEdGUF9LRVJORUwpOwo+PiAr
CWlmICghc2F2ZWRfc3RhdGUpCj4+ICsJCXJldHVybiAtRU5PTUVNOwo+PiArCj4+ICsJc2F2ZWRf
c3RhdGUtPnVhcGkgPSBjcnRjX3N0YXRlLT51YXBpOwo+PiArCXNhdmVkX3N0YXRlLT5zY2FsZXJf
c3RhdGUgPSBjcnRjX3N0YXRlLT5zY2FsZXJfc3RhdGU7Cj4+ICsJc2F2ZWRfc3RhdGUtPnNoYXJl
ZF9kcGxsID0gY3J0Y19zdGF0ZS0+c2hhcmVkX2RwbGw7Cj4+ICsJc2F2ZWRfc3RhdGUtPmRwbGxf
aHdfc3RhdGUgPSBjcnRjX3N0YXRlLT5kcGxsX2h3X3N0YXRlOwo+PiArCXNhdmVkX3N0YXRlLT5j
cmNfZW5hYmxlZCA9IGNydGNfc3RhdGUtPmNyY19lbmFibGVkOwo+PiArCj4+ICsJaW50ZWxfY3J0
Y19mcmVlX2h3X3N0YXRlKGNydGNfc3RhdGUpOwo+PiArCW1lbWNweShjcnRjX3N0YXRlLCBzYXZl
ZF9zdGF0ZSwgc2l6ZW9mKCpjcnRjX3N0YXRlKSk7Cj4+ICsJa2ZyZWUoc2F2ZWRfc3RhdGUpOwo+
PiArCj4+ICsJLyogUmUtaW5pdCBodyBzdGF0ZSAqLwo+PiArCW1lbXNldCgmY3J0Y19zdGF0ZS0+
aHcsIDAsIHNpemVvZihzYXZlZF9zdGF0ZS0+aHcpKTsKPj4gKwljcnRjX3N0YXRlLT5ody5lbmFi
bGUgPSBmcm9tX2NydGNfc3RhdGUtPmh3LmVuYWJsZTsKPj4gKwljcnRjX3N0YXRlLT5ody5hY3Rp
dmUgPSBmcm9tX2NydGNfc3RhdGUtPmh3LmFjdGl2ZTsKPj4gKwljcnRjX3N0YXRlLT5ody5waXBl
X21vZGUgPSBmcm9tX2NydGNfc3RhdGUtPmh3LnBpcGVfbW9kZTsKPj4gKwljcnRjX3N0YXRlLT5o
dy5hZGp1c3RlZF9tb2RlID0gZnJvbV9jcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlOwo+PiAr
Cj4+ICsJLyogU29tZSBmaXh1cHMgKi8KPj4gKwljcnRjX3N0YXRlLT51YXBpLm1vZGVfY2hhbmdl
ZCA9IGZyb21fY3J0Y19zdGF0ZS0+dWFwaS5tb2RlX2NoYW5nZWQ7Cj4+ICsJY3J0Y19zdGF0ZS0+
dWFwaS5jb25uZWN0b3JzX2NoYW5nZWQgPSBmcm9tX2NydGNfc3RhdGUtPnVhcGkuY29ubmVjdG9y
c19jaGFuZ2VkOwo+PiArCWNydGNfc3RhdGUtPnVhcGkuYWN0aXZlX2NoYW5nZWQgPSBmcm9tX2Ny
dGNfc3RhdGUtPnVhcGkuYWN0aXZlX2NoYW5nZWQ7Cj4+ICsJY3J0Y19zdGF0ZS0+bnYxMl9wbGFu
ZXMgPSBjcnRjX3N0YXRlLT5jOF9wbGFuZXMgPSBjcnRjX3N0YXRlLT51cGRhdGVfcGxhbmVzID0g
MDsKPj4gKwljcnRjX3N0YXRlLT5iaWdqb2luZXJfbGlua2VkX2NydGMgPSB0b19pbnRlbF9jcnRj
KGZyb21fY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gKwljcnRjX3N0YXRlLT5iaWdqb2luZXJf
c2xhdmUgPSB0cnVlOwo+PiArCWNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyID0gKGVudW0gdHJh
bnNjb2RlciljcnRjLT5waXBlOwo+PiArCWNydGNfc3RhdGUtPmhhc19hdWRpbyA9IGZhbHNlOwo+
PiArCj4+ICsJcmV0dXJuIDA7Cj4+ICt9Cj4+ICsKPj4gK3N0YXRpYyBpbnQKPj4gK2ludGVsX2Ny
dGNfcHJlcGFyZV9jbGVhcmVkX3N0YXRlKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRl
LAo+PiArCQkJCSBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHsKPj4g
IAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+PiAgCQl0b19pOTE1KGNydGNf
c3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsKPj4gQEAgLTEyNzAzLDE2ICsxMjc3NSwxNiBAQCBpbnRl
bF9jcnRjX3ByZXBhcmVfY2xlYXJlZF9zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSkKPj4gIAljcnRjX3N0YXRlLT51YXBpLm1vZGUucHJpdmF0ZV9mbGFncyA9IDA7Cj4+
ICAJY3J0Y19zdGF0ZS0+dWFwaS5hZGp1c3RlZF9tb2RlLnByaXZhdGVfZmxhZ3MgPSAwOwo+PiAg
Cj4+IC0JaW50ZWxfY3J0Y19jb3B5X3VhcGlfdG9faHdfc3RhdGUoY3J0Y19zdGF0ZSk7Cj4+ICsJ
aW50ZWxfY3J0Y19jb3B5X3VhcGlfdG9faHdfc3RhdGUoc3RhdGUsIGNydGNfc3RhdGUpOwo+PiAg
Cj4+ICAJcmV0dXJuIDA7Cj4+ICB9Cj4+ICAKPj4gIHN0YXRpYyBpbnQKPj4gLWludGVsX21vZGVz
ZXRfcGlwZV9jb25maWcoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+PiAr
aW50ZWxfbW9kZXNldF9waXBlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0
ZSwKPj4gKwkJCSAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+PiAgewo+
PiAgCXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9IHBpcGVfY29uZmlnLT51YXBpLmNydGM7Cj4+IC0J
c3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0gcGlwZV9jb25maWctPnVhcGkuc3RhdGU7
Cj4+ICAJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXI7Cj4+ICAJc3RydWN0IGRybV9jb25u
ZWN0b3IgKmNvbm5lY3RvcjsKPj4gIAlzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubmVj
dG9yX3N0YXRlOwo+PiBAQCAtMTI3NTUsNyArMTI4MjcsNyBAQCBpbnRlbF9tb2Rlc2V0X3BpcGVf
Y29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPj4gIAkJCSAgICAg
ICAmcGlwZV9jb25maWctPnBpcGVfc3JjX3csCj4+ICAJCQkgICAgICAgJnBpcGVfY29uZmlnLT5w
aXBlX3NyY19oKTsKPj4gIAo+PiAtCWZvcl9lYWNoX25ld19jb25uZWN0b3JfaW5fc3RhdGUoc3Rh
dGUsIGNvbm5lY3RvciwgY29ubmVjdG9yX3N0YXRlLCBpKSB7Cj4+ICsJZm9yX2VhY2hfbmV3X2Nv
bm5lY3Rvcl9pbl9zdGF0ZSgmc3RhdGUtPmJhc2UsIGNvbm5lY3RvciwgY29ubmVjdG9yX3N0YXRl
LCBpKSB7Cj4+ICAJCWlmIChjb25uZWN0b3Jfc3RhdGUtPmNydGMgIT0gY3J0YykKPj4gIAkJCWNv
bnRpbnVlOwo+PiAgCj4+IEBAIC0xMjgwMCw3ICsxMjg3Miw3IEBAIGludGVsX21vZGVzZXRfcGlw
ZV9jb25maWcoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+PiAgCSAqIGFk
anVzdCBpdCBhY2NvcmRpbmcgdG8gbGltaXRhdGlvbnMgb3IgY29ubmVjdG9yIHByb3BlcnRpZXMs
IGFuZCBhbHNvCj4+ICAJICogYSBjaGFuY2UgdG8gcmVqZWN0IHRoZSBtb2RlIGVudGlyZWx5Lgo+
PiAgCSAqLwo+PiAtCWZvcl9lYWNoX25ld19jb25uZWN0b3JfaW5fc3RhdGUoc3RhdGUsIGNvbm5l
Y3RvciwgY29ubmVjdG9yX3N0YXRlLCBpKSB7Cj4+ICsJZm9yX2VhY2hfbmV3X2Nvbm5lY3Rvcl9p
bl9zdGF0ZSgmc3RhdGUtPmJhc2UsIGNvbm5lY3RvciwgY29ubmVjdG9yX3N0YXRlLCBpKSB7Cj4+
ICAJCWlmIChjb25uZWN0b3Jfc3RhdGUtPmNydGMgIT0gY3J0YykKPj4gIAkJCWNvbnRpbnVlOwo+
PiAgCj4+IEBAIC0xMjg1Myw4ICsxMjkyNSw2IEBAIGludGVsX21vZGVzZXRfcGlwZV9jb25maWco
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+PiAgCSAqLwo+PiAgCXBpcGVf
Y29uZmlnLT51YXBpLmFkanVzdGVkX21vZGUgPSBwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9k
ZTsKPj4gIAo+PiAtCS8qIHdpdGhvdXQgYmlnam9pbmVyLCBwaXBlX21vZGUgPT0gYWRqdXN0ZWRf
bW9kZSAqLwo+PiAtCXBpcGVfY29uZmlnLT5ody5waXBlX21vZGUgPSBwaXBlX2NvbmZpZy0+aHcu
YWRqdXN0ZWRfbW9kZTsKPj4gIAlyZXR1cm4gMDsKPj4gIH0KPj4gIAo+PiBAQCAtMTQwOTEsNiAr
MTQxNjEsNzQgQEAgc3RhdGljIGludCBpbnRlbF9hdG9taWNfY2hlY2tfY3J0Y3Moc3RydWN0IGlu
dGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4+ICAJcmV0dXJuIDA7Cj4+ICB9Cj4+ICAKPj4gK3N0
YXRpYyBpbnQgaW50ZWxfYXRvbWljX2NoZWNrX2JpZ2pvaW5lcihzdHJ1Y3QgaW50ZWxfYXRvbWlj
X3N0YXRlICpzdGF0ZSwKPj4gKwkJCQkJc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4+ICsJCQkJ
CXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKPj4gKwkJCQkJc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+PiArewo+PiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoc3RhdGUtPmJhc2UuZGV2KTsKPj4gKwlz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqc2xhdmVfY3J0Y19zdGF0ZSwgKm1hc3Rlcl9jcnRjX3N0
YXRlOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpzbGF2ZSwgKm1hc3RlcjsKPj4gKwo+PiArCS8q
IHNsYXZlIGJlaW5nIGVuYWJsZWQsIGlzIG1hc3RlciBpcyBzdGlsbCBjbGFpbWluZyB0aGlzIGNy
dGM/ICovCj4+ICsJaWYgKG9sZF9jcnRjX3N0YXRlLT5iaWdqb2luZXJfc2xhdmUpIHsKPj4gKwkJ
c2xhdmUgPSBjcnRjOwo+PiArCQltYXN0ZXIgPSBvbGRfY3J0Y19zdGF0ZS0+Ymlnam9pbmVyX2xp
bmtlZF9jcnRjOwo+PiArCQltYXN0ZXJfY3J0Y19zdGF0ZSA9IGludGVsX2F0b21pY19nZXRfbmV3
X2NydGNfc3RhdGUoc3RhdGUsIG1hc3Rlcik7Cj4+ICsJCWlmICghbWFzdGVyX2NydGNfc3RhdGUg
fHwgIW5lZWRzX21vZGVzZXQobWFzdGVyX2NydGNfc3RhdGUpKQo+PiArCQkJZ290byBjbGFpbWVk
Owo+PiArCX0KPj4gKwo+PiArCWlmICghbmV3X2NydGNfc3RhdGUtPmJpZ2pvaW5lcikKPj4gKwkJ
cmV0dXJuIDA7Cj4+ICsKPj4gKwlpZiAoMSArIGNydGMtPnBpcGUgPj0gSU5URUxfTlVNX1BJUEVT
KGRldl9wcml2KSkgewo+PiArCQlEUk1fREVCVUdfS01TKCJbQ1JUQzolZDolc10gQmlnIGpvaW5l
ciBjb25maWd1cmF0aW9uIHJlcXVpcmVzICIKPj4gKwkJCSAgICAgICJDUlRDICsgMSB0byBiZSB1
c2VkLCBkb2Vzbid0IGV4aXN0XG4iLAo+PiArCQkJICAgICAgY3J0Yy0+YmFzZS5iYXNlLmlkLCBj
cnRjLT5iYXNlLm5hbWUpOwo+PiArCQlyZXR1cm4gLUVJTlZBTDsKPj4gKwl9Cj4+ICsKPj4gKwlz
bGF2ZSA9IG5ld19jcnRjX3N0YXRlLT5iaWdqb2luZXJfbGlua2VkX2NydGMgPQo+PiArCQlpbnRl
bF9nZXRfY3J0Y19mb3JfcGlwZShkZXZfcHJpdiwgY3J0Yy0+cGlwZSArIDEpOwo+PiArCXNsYXZl
X2NydGNfc3RhdGUgPSBpbnRlbF9hdG9taWNfZ2V0X2NydGNfc3RhdGUoJnN0YXRlLT5iYXNlLCBz
bGF2ZSk7Cj4+ICsJbWFzdGVyID0gY3J0YzsKPj4gKwlpZiAoSVNfRVJSKHNsYXZlX2NydGNfc3Rh
dGUpKQo+PiArCQlyZXR1cm4gUFRSX0VSUihzbGF2ZV9jcnRjX3N0YXRlKTsKPj4gKwo+PiArCS8q
IG1hc3RlciBiZWluZyBlbmFibGVkLCBzbGF2ZSB3YXMgYWxyZWFkeSBjb25maWd1cmVkPyAqLwo+
PiArCWlmIChzbGF2ZV9jcnRjX3N0YXRlLT51YXBpLmVuYWJsZSkKPj4gKwkJZ290byBjbGFpbWVk
Owo+PiArCj4+ICsJRFJNX0RFQlVHX0tNUygiW0NSVEM6JWQ6JXNdIFVzZWQgYXMgc2xhdmUgZm9y
IGJpZyBqb2luZXJcbiIsCj4+ICsJCSAgICAgIHNsYXZlLT5iYXNlLmJhc2UuaWQsIHNsYXZlLT5i
YXNlLm5hbWUpOwo+PiArCXJldHVybiBjb3B5X2JpZ2pvaW5lcl9jcnRjX3N0YXRlKHNsYXZlX2Ny
dGNfc3RhdGUsIG5ld19jcnRjX3N0YXRlKTsKPj4gKwo+PiArY2xhaW1lZDoKPj4gKwlEUk1fREVC
VUdfS01TKCJbQ1JUQzolZDolc10gU2xhdmUgaXMgZW5hYmxlZCBhcyBub3JtYWwgQ1JUQywgYnV0
ICIKPj4gKwkJICAgICAgIltDUlRDOiVkOiVzXSBjbGFpbWluZyB0aGlzIENSVEMgZm9yIGJpZ2pv
aW5lci5cbiIsCj4+ICsJCSAgICAgIHNsYXZlLT5iYXNlLmJhc2UuaWQsIHNsYXZlLT5iYXNlLm5h
bWUsCj4+ICsJCSAgICAgIG1hc3Rlci0+YmFzZS5iYXNlLmlkLCBtYXN0ZXItPmJhc2UubmFtZSk7
Cj4+ICsJcmV0dXJuIC1FSU5WQUw7Cj4+ICt9Cj4+ICsKPj4gK3N0YXRpYyBpbnQga2lsbF9iaWdq
b2luZXJfc2xhdmUoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4+ICsJCQkJc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKm1hc3Rlcl9jcnRjX3N0YXRlKQo+PiArewo+PiArCXN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpzbGF2ZV9jcnRjX3N0YXRlID0KPj4gKwkJaW50ZWxfYXRvbWlj
X2dldF9jcnRjX3N0YXRlKCZzdGF0ZS0+YmFzZSwKPj4gKwkJCW1hc3Rlcl9jcnRjX3N0YXRlLT5i
aWdqb2luZXJfbGlua2VkX2NydGMpOwo+IG5pdDogSSdkIGRvIHRoaXMgYXMKPgo+IHN0cnVjdCBm
b28gKmJhcjsKPgo+IGJhciA9IHdoYXRldmVyKCk7Cj4gaWYgKElTX0VSUikKPiAJLi4uCj4KPiB0
byBtYWtlIGl0IHN0YW5kIG91dCBtb3JlIHNpbmNlIHRoYXQgZnVuY3Rpb24gaGFzIHNvbWUgcmVh
bAo+IHNpZGUgZWZmZWN0cy4KSSB0aGluayB0aGUgbmFtZSBnaXZlcyBpdCBhd2F5LiA6KQo+PiAr
Cj4+ICsJaWYgKElTX0VSUihzbGF2ZV9jcnRjX3N0YXRlKSkKPj4gKwkJcmV0dXJuIFBUUl9FUlIo
c2xhdmVfY3J0Y19zdGF0ZSk7Cj4+ICsKPj4gKwlzbGF2ZV9jcnRjX3N0YXRlLT5iaWdqb2luZXIg
PSBtYXN0ZXJfY3J0Y19zdGF0ZS0+Ymlnam9pbmVyID0gZmFsc2U7Cj4+ICsJc2xhdmVfY3J0Y19z
dGF0ZS0+Ymlnam9pbmVyX3NsYXZlID0gbWFzdGVyX2NydGNfc3RhdGUtPmJpZ2pvaW5lcl9zbGF2
ZSA9IGZhbHNlOwo+PiArCXNsYXZlX2NydGNfc3RhdGUtPmJpZ2pvaW5lcl9saW5rZWRfY3J0YyA9
IG1hc3Rlcl9jcnRjX3N0YXRlLT5iaWdqb2luZXJfbGlua2VkX2NydGMgPSBOVUxMOwo+PiArCWlu
dGVsX2NydGNfY29weV91YXBpX3RvX2h3X3N0YXRlKHN0YXRlLCBzbGF2ZV9jcnRjX3N0YXRlKTsK
Pj4gKwlyZXR1cm4gMDsKPj4gK30KPj4gKwo+PiAgLyoqCj4+ICAgKiBpbnRlbF9hdG9taWNfY2hl
Y2sgLSB2YWxpZGF0ZSBzdGF0ZSBvYmplY3QKPj4gICAqIEBkZXY6IGRybSBkZXZpY2UKPj4gQEAg
LTE0MTIyLDIzICsxNDI2MCwzMSBAQCBzdGF0aWMgaW50IGludGVsX2F0b21pY19jaGVjayhzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2LAo+PiAgCQkJCQkgICAgbmV3X2NydGNfc3RhdGUsIGkpIHsKPj4g
IAkJaWYgKCFuZWVkc19tb2Rlc2V0KG5ld19jcnRjX3N0YXRlKSkgewo+PiAgCQkJLyogTGlnaHQg
Y29weSAqLwo+PiAtCQkJaW50ZWxfY3J0Y19jb3B5X3VhcGlfdG9faHdfc3RhdGVfbm9tb2Rlc2V0
KG5ld19jcnRjX3N0YXRlKTsKPj4gKwkJCWludGVsX2NydGNfY29weV91YXBpX3RvX2h3X3N0YXRl
X25vbW9kZXNldChzdGF0ZSwgbmV3X2NydGNfc3RhdGUpOwo+PiAgCj4+ICAJCQljb250aW51ZTsK
Pj4gIAkJfQo+PiAgCj4+IC0JCWlmICghbmV3X2NydGNfc3RhdGUtPnVhcGkuZW5hYmxlKSB7Cj4+
IC0JCQlpbnRlbF9jcnRjX2NvcHlfdWFwaV90b19od19zdGF0ZShuZXdfY3J0Y19zdGF0ZSk7Cj4+
ICsJCS8qIEtpbGwgb2xkIGJpZ2pvaW5lciBsaW5rLCB3ZSBtYXkgcmUtZXN0YWJsaXNoIGFmdGVy
d2FyZHMgKi8KPj4gKwkJaWYgKG9sZF9jcnRjX3N0YXRlLT5iaWdqb2luZXIgJiYgIW9sZF9jcnRj
X3N0YXRlLT5iaWdqb2luZXJfc2xhdmUpIHsKPj4gKwkJCXJldCA9IGtpbGxfYmlnam9pbmVyX3Ns
YXZlKHN0YXRlLCBuZXdfY3J0Y19zdGF0ZSk7Cj4+ICsJCQlpZiAocmV0KQo+PiArCQkJCWdvdG8g
ZmFpbDsKPj4gKwkJfQo+PiAgCj4+IC0JCQlhbnlfbXMgPSB0cnVlOwo+PiArCQlpZiAoIW5ld19j
cnRjX3N0YXRlLT51YXBpLmVuYWJsZSkgewo+PiArCQkJaWYgKCFuZXdfY3J0Y19zdGF0ZS0+Ymln
am9pbmVyX3NsYXZlKSB7Cj4+ICsJCQkJaW50ZWxfY3J0Y19jb3B5X3VhcGlfdG9faHdfc3RhdGUo
c3RhdGUsIG5ld19jcnRjX3N0YXRlKTsKPj4gKwkJCQlhbnlfbXMgPSB0cnVlOwo+PiArCQkJfQo+
PiAgCQkJY29udGludWU7Cj4+ICAJCX0KPiBIb3cgZG9lcyB0aGlzIGhhbmRsZSB0aGUgY2FzZSB3
aGVyZSB0aGUgc2xhdmUgdWFwaS5lbmFibGUgZ2V0cwo+IGVuYWJsZWQgYnV0IHRoZSBtYXN0ZXIg
aXMgbm90IHBhcnQgb2YgdGhlIHN0YXRlIHlldD8KCkZpcnN0IGxpbmVzIGluIGludGVsX2F0b21p
Y19jaGVja19iaWdqb2luZXIgaW50ZWxfYXRvbWljX2NoZWNrX2JpZ2pvaW5lcigpIGhhbmRsZSB0
aGlzLgoKCS8qIHNsYXZlIGJlaW5nIGVuYWJsZWQsIGlzIG1hc3RlciBpcyBzdGlsbCBjbGFpbWlu
ZyB0aGlzIGNydGM/ICovCglpZiAob2xkX2NydGNfc3RhdGUtPmJpZ2pvaW5lcl9zbGF2ZSkgewoJ
CXNsYXZlID0gY3J0YzsKCQltYXN0ZXIgPSBvbGRfY3J0Y19zdGF0ZS0+Ymlnam9pbmVyX2xpbmtl
ZF9jcnRjOwoJCW1hc3Rlcl9jcnRjX3N0YXRlID0gaW50ZWxfYXRvbWljX2dldF9uZXdfY3J0Y19z
dGF0ZShzdGF0ZSwgbWFzdGVyKTsKCQlpZiAoIW1hc3Rlcl9jcnRjX3N0YXRlIHx8ICFuZWVkc19t
b2Rlc2V0KG1hc3Rlcl9jcnRjX3N0YXRlKSkKCQkJZ290byBjbGFpbWVkOwoJfQoKPgo+PiAgCj4+
IC0JCXJldCA9IGludGVsX2NydGNfcHJlcGFyZV9jbGVhcmVkX3N0YXRlKG5ld19jcnRjX3N0YXRl
KTsKPj4gKwkJcmV0ID0gaW50ZWxfY3J0Y19wcmVwYXJlX2NsZWFyZWRfc3RhdGUoc3RhdGUsIG5l
d19jcnRjX3N0YXRlKTsKPj4gIAkJaWYgKHJldCkKPj4gIAkJCWdvdG8gZmFpbDsKPj4gIAo+PiAt
CQlyZXQgPSBpbnRlbF9tb2Rlc2V0X3BpcGVfY29uZmlnKG5ld19jcnRjX3N0YXRlKTsKPj4gKwkJ
cmV0ID0gaW50ZWxfbW9kZXNldF9waXBlX2NvbmZpZyhzdGF0ZSwgbmV3X2NydGNfc3RhdGUpOwo+
PiAgCQlpZiAocmV0KQo+PiAgCQkJZ290byBmYWlsOwo+PiAgCj4+IEBAIC0xNDE0Niw2ICsxNDI5
MiwxMCBAQCBzdGF0aWMgaW50IGludGVsX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2LAo+PiAgCj4+ICAJCWlmIChuZWVkc19tb2Rlc2V0KG5ld19jcnRjX3N0YXRlKSkKPj4gIAkJ
CWFueV9tcyA9IHRydWU7Cj4+ICsKPj4gKwkJcmV0ID0gaW50ZWxfYXRvbWljX2NoZWNrX2JpZ2pv
aW5lcihzdGF0ZSwgY3J0Yywgb2xkX2NydGNfc3RhdGUsIG5ld19jcnRjX3N0YXRlKTsKPj4gKwkJ
aWYgKHJldCkKPj4gKwkJCWdvdG8gZmFpbDsKPj4gIAl9Cj4+ICAKPj4gIAlpZiAoYW55X21zICYm
ICFjaGVja19kaWdpdGFsX3BvcnRfY29uZmxpY3RzKHN0YXRlKSkgewo+PiBAQCAtMTQzNTAsNyAr
MTQ1MDAsOSBAQCBzdGF0aWMgdm9pZCBpbnRlbF91cGRhdGVfY3J0YyhzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YywKPj4gIAo+PiAgCWNvbW1pdF9waXBlX2NvbmZpZyhzdGF0ZSwgb2xkX2NydGNfc3Rh
dGUsIG5ld19jcnRjX3N0YXRlKTsKPj4gIAo+PiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDkpCj4+ICsJaWYgKG5ld19jcnRjX3N0YXRlLT5iaWdqb2luZXIpCj4+ICsJCXsvKiBOb3Qgc3Vw
cG9ydGVkIHlldCAqL30KPj4gKwllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4+
ICAJCXNrbF91cGRhdGVfcGxhbmVzX29uX2NydGMoc3RhdGUsIGNydGMpOwo+PiAgCWVsc2UKPj4g
IAkJaTl4eF91cGRhdGVfcGxhbmVzX29uX2NydGMoc3RhdGUsIGNydGMpOwo+PiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmggYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaAo+PiBpbmRl
eCA3ZjQ2YzE2NDZkM2YuLmNmMmVjZmExNzQxNiAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgKPj4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgKPj4gQEAgLTEwNDQsNiAr
MTA0NCwxNSBAQCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSB7Cj4+ICAJLyogZW5hYmxlIHBpcGUg
Y3NjPyAqLwo+PiAgCWJvb2wgY3NjX2VuYWJsZTsKPj4gIAo+PiArCS8qIGVuYWJsZSBwaXBlIGJp
ZyBqb2luZXI/ICovCj4+ICsJYm9vbCBiaWdqb2luZXI7Cj4+ICsKPj4gKwkvKiBiaWcgam9pbmVy
IHNsYXZlIGNydGM/ICovCj4+ICsJYm9vbCBiaWdqb2luZXJfc2xhdmU7Cj4+ICsKPj4gKwkvKiBs
aW5rZWQgY3J0YyBmb3IgYmlnam9pbmVyLCBlaXRoZXIgc2xhdmUgb3IgbWFzdGVyICovCj4+ICsJ
c3RydWN0IGludGVsX2NydGMgKmJpZ2pvaW5lcl9saW5rZWRfY3J0YzsKPj4gKwo+PiAgCS8qIERp
c3BsYXkgU3RyZWFtIGNvbXByZXNzaW9uIHN0YXRlICovCj4+ICAJc3RydWN0IHsKPj4gIAkJYm9v
bCBjb21wcmVzc2lvbl9lbmFibGU7Cj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2RwLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2RwLmMKPj4gaW5kZXggOWI3ZGY4ZTg1ZWEyLi41NGZkZTRjNGM0ZGQgMTAwNjQ0Cj4+IC0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHAuYwo+PiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwLmMKPj4gQEAgLTIxNDcsNiArMjE0NywxNSBA
QCBzdGF0aWMgaW50IGludGVsX2RwX2RzY19jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZHAg
KmludGVsX2RwLAo+PiAgCXBpcGVfY29uZmlnLT5wb3J0X2Nsb2NrID0gaW50ZWxfZHAtPmNvbW1v
bl9yYXRlc1tsaW1pdHMtPm1heF9jbG9ja107Cj4+ICAJcGlwZV9jb25maWctPmxhbmVfY291bnQg
PSBsaW1pdHMtPm1heF9sYW5lX2NvdW50Owo+PiAgCj4+ICsJaWYgKGFkanVzdGVkX21vZGUtPmNy
dGNfY2xvY2sgPiBpbnRlbF9kcF9tYXhfZG90Y2xvY2soaW50ZWxfZHAsIGZhbHNlKSkgewo+PiAr
CQlpZiAoYWRqdXN0ZWRfbW9kZS0+Y3J0Y19jbG9jayA+IGludGVsX2RwX21heF9kb3RjbG9jayhp
bnRlbF9kcCwgdHJ1ZSkpIHsKPj4gKwkJCURSTV9ERUJVR19LTVMoIkNsb2NrIHJhdGUgdG9vIGhp
Z2ggZm9yIGJpZyBqb2luZXJcbiIpOwo+PiArCQkJcmV0dXJuIC1FSU5WQUw7Cj4+ICsJCX0KPj4g
KwkJcGlwZV9jb25maWctPmJpZ2pvaW5lciA9IHRydWU7Cj4+ICsJCURSTV9ERUJVR19LTVMoIlVz
aW5nIGJpZ2pvaW5lciBjb25maWd1cmF0aW9uXG4iKTsKPj4gKwl9Cj4+ICsKPj4gIAlpZiAoaW50
ZWxfZHBfaXNfZWRwKGludGVsX2RwKSkgewo+PiAgCQlwaXBlX2NvbmZpZy0+ZHNjLmNvbXByZXNz
ZWRfYnBwID0KPj4gIAkJCW1pbl90KHUxNiwgZHJtX2VkcF9kc2Nfc2lua19vdXRwdXRfYnBwKGlu
dGVsX2RwLT5kc2NfZHBjZCkgPj4gNCwKPj4gQEAgLTIxNjQsMTIgKzIxNzMsMTIgQEAgc3RhdGlj
IGludCBpbnRlbF9kcF9kc2NfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2RwICppbnRlbF9k
cCwKPj4gIAkJCQkJCSAgICBwaXBlX2NvbmZpZy0+bGFuZV9jb3VudCwKPj4gIAkJCQkJCSAgICBh
ZGp1c3RlZF9tb2RlLT5jcnRjX2Nsb2NrLAo+PiAgCQkJCQkJICAgIGFkanVzdGVkX21vZGUtPmNy
dGNfaGRpc3BsYXksCj4+IC0JCQkJCQkgICAgZmFsc2UpOwo+PiArCQkJCQkJICAgIHBpcGVfY29u
ZmlnLT5iaWdqb2luZXIpOwo+PiAgCQlkc2NfZHBfc2xpY2VfY291bnQgPQo+PiAgCQkJaW50ZWxf
ZHBfZHNjX2dldF9zbGljZV9jb3VudChpbnRlbF9kcCwKPj4gIAkJCQkJCSAgICAgYWRqdXN0ZWRf
bW9kZS0+Y3J0Y19jbG9jaywKPj4gIAkJCQkJCSAgICAgYWRqdXN0ZWRfbW9kZS0+Y3J0Y19oZGlz
cGxheSwKPj4gLQkJCQkJCSAgICAgZmFsc2UpOwo+PiArCQkJCQkJICAgICBwaXBlX2NvbmZpZy0+
Ymlnam9pbmVyKTsKPj4gIAkJaWYgKCFkc2NfbWF4X291dHB1dF9icHAgfHwgIWRzY19kcF9zbGlj
ZV9jb3VudCkgewo+PiAgCQkJRFJNX0RFQlVHX0tNUygiQ29tcHJlc3NlZCBCUFAvU2xpY2UgQ291
bnQgbm90IHN1cHBvcnRlZFxuIik7Cj4+ICAJCQlyZXR1cm4gLUVJTlZBTDsKPj4gQEAgLTIxODQs
MTMgKzIxOTMsMTQgQEAgc3RhdGljIGludCBpbnRlbF9kcF9kc2NfY29tcHV0ZV9jb25maWcoc3Ry
dWN0IGludGVsX2RwICppbnRlbF9kcCwKPj4gIAkgKiBpcyBncmVhdGVyIHRoYW4gdGhlIG1heGlt
dW0gQ2RjbG9jayBhbmQgaWYgc2xpY2UgY291bnQgaXMgZXZlbgo+PiAgCSAqIHRoZW4gd2UgbmVl
ZCB0byB1c2UgMiBWRFNDIGluc3RhbmNlcy4KPj4gIAkgKi8KPj4gLQlpZiAoYWRqdXN0ZWRfbW9k
ZS0+Y3J0Y19jbG9jayA+IGRldl9wcml2LT5tYXhfY2RjbGtfZnJlcSkgewo+PiAtCQlpZiAocGlw
ZV9jb25maWctPmRzYy5zbGljZV9jb3VudCA+IDEpIHsKPj4gLQkJCXBpcGVfY29uZmlnLT5kc2Mu
ZHNjX3NwbGl0ID0gdHJ1ZTsKPj4gLQkJfSBlbHNlIHsKPj4gKwlpZiAoYWRqdXN0ZWRfbW9kZS0+
Y3J0Y19jbG9jayA+IGRldl9wcml2LT5tYXhfY2RjbGtfZnJlcSB8fAo+PiArCSAgICBwaXBlX2Nv
bmZpZy0+Ymlnam9pbmVyKSB7Cj4+ICsJCWlmIChwaXBlX2NvbmZpZy0+ZHNjLnNsaWNlX2NvdW50
IDwgMikgewo+PiAgCQkJRFJNX0RFQlVHX0tNUygiQ2Fubm90IHNwbGl0IHN0cmVhbSB0byB1c2Ug
MiBWRFNDIGluc3RhbmNlc1xuIik7Cj4+ICAJCQlyZXR1cm4gLUVJTlZBTDsKPj4gIAkJfQo+PiAr
Cj4+ICsJCXBpcGVfY29uZmlnLT5kc2MuZHNjX3NwbGl0ID0gdHJ1ZTsKPj4gIAl9Cj4+ICAKPj4g
IAlyZXQgPSBpbnRlbF9kc2NfY29tcHV0ZV9wYXJhbXMoJmRpZ19wb3J0LT5iYXNlLCBwaXBlX2Nv
bmZpZyk7Cj4+IC0tIAo+PiAyLjI0LjAKPj4KPj4gX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KPj4gSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdAo+PiBJbnRlbC1n
ZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCj4+IGh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
L21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4CgoKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlz
dHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4v
bGlzdGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id F22FFCF956
	for <lists+intel-gfx@lfdr.de>; Tue,  8 Oct 2019 14:10:27 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E04A86E79C;
	Tue,  8 Oct 2019 12:10:25 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 12FCE6E79C
 for <intel-gfx@lists.freedesktop.org>; Tue,  8 Oct 2019 12:10:23 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 18763751-1500050 for multiple; Tue, 08 Oct 2019 13:09:59 +0100
MIME-Version: 1.0
To: Matthew Auld <matthew.auld@intel.com>, intel-gfx@lists.freedesktop.org
From: Chris Wilson <chris@chris-wilson.co.uk>
In-Reply-To: <d3cd9d29-a74c-2c0f-1e4b-3dbf812b509b@intel.com>
References: <20191004170452.15410-1-matthew.auld@intel.com>
 <20191004170452.15410-3-matthew.auld@intel.com>
 <157052516398.5063.14609672594270239962@skylake-alporthouse-com>
 <d3cd9d29-a74c-2c0f-1e4b-3dbf812b509b@intel.com>
Message-ID: <157053659746.5063.10359745135706011702@skylake-alporthouse-com>
User-Agent: alot/0.6
Date: Tue, 08 Oct 2019 13:09:57 +0100
Subject: Re: [Intel-gfx] [PATCH v3 02/21] drm/i915: introduce
 intel_memory_region
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVvdGluZyBNYXR0aGV3IEF1bGQgKDIwMTktMTAtMDggMTI6NTc6NTApCj4gT24gMDgvMTAvMjAx
OSAwOTo1OSwgQ2hyaXMgV2lsc29uIHdyb3RlOgo+ID4gUXVvdGluZyBNYXR0aGV3IEF1bGQgKDIw
MTktMTAtMDQgMTg6MDQ6MzMpCj4gPj4gK2ludAo+ID4+ICtpOTE1X2dlbV9vYmplY3RfZ2V0X3Bh
Z2VzX2J1ZGR5KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCj4gPj4gK3sKPiA+PiAr
ICAgICAgIHN0cnVjdCBpbnRlbF9tZW1vcnlfcmVnaW9uICptZW0gPSBvYmotPm1tLnJlZ2lvbjsK
PiA+PiArICAgICAgIHN0cnVjdCBsaXN0X2hlYWQgKmJsb2NrcyA9ICZvYmotPm1tLmJsb2NrczsK
PiA+PiArICAgICAgIHVuc2lnbmVkIGludCBmbGFncyA9IEk5MTVfQUxMT0NfTUlOX1BBR0VfU0la
RTsKPiA+PiArICAgICAgIHJlc291cmNlX3NpemVfdCBzaXplID0gb2JqLT5iYXNlLnNpemU7Cj4g
Pj4gKyAgICAgICByZXNvdXJjZV9zaXplX3QgcHJldl9lbmQ7Cj4gPj4gKyAgICAgICBzdHJ1Y3Qg
aTkxNV9idWRkeV9ibG9jayAqYmxvY2s7Cj4gPj4gKyAgICAgICBzdHJ1Y3Qgc2dfdGFibGUgKnN0
Owo+ID4+ICsgICAgICAgc3RydWN0IHNjYXR0ZXJsaXN0ICpzZzsKPiA+PiArICAgICAgIHVuc2ln
bmVkIGludCBzZ19wYWdlX3NpemVzOwo+ID4+ICsgICAgICAgdW5zaWduZWQgbG9uZyBpOwo+ID4+
ICsgICAgICAgaW50IHJldDsKPiA+PiArCj4gPj4gKyAgICAgICBzdCA9IGttYWxsb2Moc2l6ZW9m
KCpzdCksIEdGUF9LRVJORUwpOwo+ID4+ICsgICAgICAgaWYgKCFzdCkKPiA+PiArICAgICAgICAg
ICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gPj4gKwo+ID4+ICsgICAgICAgaWYgKHNnX2FsbG9jX3Rh
YmxlKHN0LCBzaXplID4+IGlsb2cyKG1lbS0+bW0uY2h1bmtfc2l6ZSksIEdGUF9LRVJORUwpKSB7
Cj4gPj4gKyAgICAgICAgICAgICAgIGtmcmVlKHN0KTsKPiA+PiArICAgICAgICAgICAgICAgcmV0
dXJuIC1FTk9NRU07Cj4gPj4gKyAgICAgICB9Cj4gPj4gKwo+ID4+ICsgICAgICAgcmV0ID0gX19p
bnRlbF9tZW1vcnlfcmVnaW9uX2dldF9wYWdlc19idWRkeShtZW0sIHNpemUsIGZsYWdzLCBibG9j
a3MpOwo+ID4+ICsgICAgICAgaWYgKHJldCkKPiA+PiArICAgICAgICAgICAgICAgZ290byBlcnJf
ZnJlZV9zZzsKPiA+PiArCj4gPj4gKyAgICAgICBHRU1fQlVHX09OKGxpc3RfZW1wdHkoYmxvY2tz
KSk7Cj4gPj4gKwo+ID4+ICsgICAgICAgc2cgPSBzdC0+c2dsOwo+ID4+ICsgICAgICAgc3QtPm5l
bnRzID0gMDsKPiA+PiArICAgICAgIHNnX3BhZ2Vfc2l6ZXMgPSAwOwo+ID4+ICsgICAgICAgaSA9
IDA7Cj4gPj4gKwo+ID4+ICsgICAgICAgbGlzdF9mb3JfZWFjaF9lbnRyeShibG9jaywgYmxvY2tz
LCBsaW5rKSB7Cj4gPj4gKyAgICAgICAgICAgICAgIHU2NCBibG9ja19zaXplLCBvZmZzZXQ7Cj4g
Pj4gKwo+ID4+ICsgICAgICAgICAgICAgICBibG9ja19zaXplID0gaTkxNV9idWRkeV9ibG9ja19z
aXplKCZtZW0tPm1tLCBibG9jayk7Cj4gPj4gKyAgICAgICAgICAgICAgIG9mZnNldCA9IGk5MTVf
YnVkZHlfYmxvY2tfb2Zmc2V0KGJsb2NrKTsKPiA+PiArCj4gPj4gKyAgICAgICAgICAgICAgIEdF
TV9CVUdfT04ob3ZlcmZsb3dzX3R5cGUoYmxvY2tfc2l6ZSwgc2ctPmxlbmd0aCkpOwo+ID4+ICsK
PiA+PiArICAgICAgICAgICAgICAgaWYgKCFpIHx8IG9mZnNldCAhPSBwcmV2X2VuZCB8fAo+ID4+
ICsgICAgICAgICAgICAgICAgICAgYWRkX292ZXJmbG93c190KHR5cGVvZihzZy0+bGVuZ3RoKSwg
c2ctPmxlbmd0aCwgYmxvY2tfc2l6ZSkpIHsKPiA+PiArICAgICAgICAgICAgICAgICAgICAgICBp
ZiAoaSkgewo+ID4gCj4gPiBpIGlzIG9ubHkgYmVpbmcgaGVyZSB0byBkZXRlY3QgdGhlIHN0YXJ0
Lgo+ID4gcHJldl9lbmQgPSAocmVzb3VyY2Vfc2l6ZV90KS0xOwo+ID4gVGhlbiBJIGRvbid0IGhh
dmUgdG8gd29ycnkgYWJvdXQgaSBvdmVyZmxvd2luZywgYWx0aG91Z2ggdGhhdCBzZWVtcwo+ID4g
aGFybWxlc3MsIGFuZCBhcyByaWRpY3Vsb3VzIGFzIHRoYXQgbWF5IGJlLgo+ID4gCj4gPj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZ19wYWdlX3NpemVzIHw9IHNnLT5sZW5ndGg7
Cj4gPj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZyA9IF9fc2dfbmV4dChzZyk7
Cj4gPj4gKyAgICAgICAgICAgICAgICAgICAgICAgfQo+ID4+ICsKPiA+PiArICAgICAgICAgICAg
ICAgICAgICAgICBzZ19kbWFfYWRkcmVzcyhzZykgPSBtZW0tPnJlZ2lvbi5zdGFydCArIG9mZnNl
dDsKPiA+PiArICAgICAgICAgICAgICAgICAgICAgICBzZ19kbWFfbGVuKHNnKSA9IGJsb2NrX3Np
emU7Cj4gPj4gKwo+ID4+ICsgICAgICAgICAgICAgICAgICAgICAgIHNnLT5sZW5ndGggPSBibG9j
a19zaXplOwo+ID4+ICsKPiA+PiArICAgICAgICAgICAgICAgICAgICAgICBzdC0+bmVudHMrKzsK
PiA+PiArICAgICAgICAgICAgICAgfSBlbHNlIHsKPiA+PiArICAgICAgICAgICAgICAgICAgICAg
ICBzZy0+bGVuZ3RoICs9IGJsb2NrX3NpemU7Cj4gPj4gKyAgICAgICAgICAgICAgICAgICAgICAg
c2dfZG1hX2xlbihzZykgKz0gYmxvY2tfc2l6ZTsKPiA+PiArICAgICAgICAgICAgICAgfQo+ID4+
ICsKPiA+PiArICAgICAgICAgICAgICAgcHJldl9lbmQgPSBvZmZzZXQgKyBibG9ja19zaXplOwo+
ID4+ICsgICAgICAgICAgICAgICBpKys7Cj4gPj4gKyAgICAgICB9Owo+ID4+ICsKPiA+PiArICAg
ICAgIHNnX3BhZ2Vfc2l6ZXMgfD0gc2ctPmxlbmd0aDsKPiA+PiArICAgICAgIHNnX21hcmtfZW5k
KHNnKTsKPiA+PiArICAgICAgIGk5MTVfc2dfdHJpbShzdCk7Cj4gPj4gKwo+ID4+ICsgICAgICAg
X19pOTE1X2dlbV9vYmplY3Rfc2V0X3BhZ2VzKG9iaiwgc3QsIHNnX3BhZ2Vfc2l6ZXMpOwo+ID4+
ICsKPiA+PiArICAgICAgIHJldHVybiAwOwo+ID4+ICsKPiA+PiArZXJyX2ZyZWVfc2c6Cj4gPj4g
KyAgICAgICBzZ19mcmVlX3RhYmxlKHN0KTsKPiA+PiArICAgICAgIGtmcmVlKHN0KTsKPiA+PiAr
ICAgICAgIHJldHVybiByZXQ7Cj4gPj4gK30KPiA+IAo+ID4+ICtzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdCAqCj4gPj4gK2k5MTVfZ2VtX29iamVjdF9jcmVhdGVfcmVnaW9uKHN0cnVjdCBpbnRl
bF9tZW1vcnlfcmVnaW9uICptZW0sCj4gPj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
cmVzb3VyY2Vfc2l6ZV90IHNpemUsCj4gPj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
dW5zaWduZWQgaW50IGZsYWdzKQo+ID4+ICt7Cj4gPj4gKyAgICAgICBzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqOwo+ID4+ICsKPiA+PiArICAgICAgIGlmICghbWVtKQo+ID4+ICsgICAg
ICAgICAgICAgICByZXR1cm4gRVJSX1BUUigtRU5PREVWKTsKPiA+PiArCj4gPj4gKyAgICAgICBz
aXplID0gcm91bmRfdXAoc2l6ZSwgbWVtLT5taW5fcGFnZV9zaXplKTsKPiA+PiArCj4gPj4gKyAg
ICAgICBHRU1fQlVHX09OKCFzaXplKTsKPiA+PiArICAgICAgIEdFTV9CVUdfT04oIUlTX0FMSUdO
RUQoc2l6ZSwgSTkxNV9HVFRfTUlOX0FMSUdOTUVOVCkpOwo+ID4+ICsKPiA+IAo+ID4gUHV0IHRo
ZSBGSVhNRSBoZXJlIGZyb20gdGhlIHN0YXJ0Cj4gPiAKPiA+PiArICAgICAgIGlmIChzaXplID4+
IFBBR0VfU0hJRlQgPiBJTlRfTUFYKQo+ID4+ICsgICAgICAgICAgICAgICByZXR1cm4gRVJSX1BU
UigtRTJCSUcpOwo+ID4+ICsKPiA+PiArICAgICAgIGlmIChvdmVyZmxvd3NfdHlwZShzaXplLCBv
YmotPmJhc2Uuc2l6ZSkpCj4gPj4gKyAgICAgICAgICAgICAgIHJldHVybiBFUlJfUFRSKC1FMkJJ
Ryk7Cj4gPj4gKwo+ID4+ICsgICAgICAgcmV0dXJuIG1lbS0+b3BzLT5jcmVhdGVfb2JqZWN0KG1l
bSwgc2l6ZSwgZmxhZ3MpOwo+ID4+ICt9Cj4gPiAKPiA+IEknbSBoYXBweSB3aXRoIHRoaXMuIEJ1
dCBJIHdvdWxkIGxpa2UgYSBkaXNjdXNzaW9uIG9uIHdoeQo+ID4gcmVzb3VyY2Vfc2l6ZV90IHdh
cyBjaG9zZW4gYW5kIGZvciB0aGF0IHJhdGlvbmFsZSB0byBiZSBjYXB0dXJlZCBpbiB0aGUKPiA+
IGNvZGUgY29tbWVudHMuIEF0IHRoZSBlbmQgb2YgdGhlIGRheSwgd2UgbmVlZCB0byBidW1wIG9i
ai0+YmFzZS5zaXplIHRvCj4gPiBzdWl0Lgo+IAo+IE5vIGdvb2QgcmVhc29uLCBJIGd1ZXNzIGl0
IGp1c3Qgc3RlbXMgZnJvbSB1c2luZyAic3RydWN0IHJlc291cmNlIAo+IHJlZ2lvbiIuIE1heWJl
IGZvciB0aGUgb2JqZWN0X2NyZWF0ZSBpbnRlcmZhY2Ugd2Ugc2hvdWxkIGp1c3QgdXNlIHU2ND8K
CnJlc291cmNlX3NpemVfdCBpcyBkZWZpbml0ZWx5IGEgYmV0dGVyIHN0YXJ0aW5nIHBvaW50IHRo
YW4gc2l6ZV90LCBhbmQKYWZhaWsgaXMgdGhlIHByZWZlcnJlZCB0eXBlIGZvciB0aGlzIHBoeXNp
Y2FsIHVzYWdlLCBldmVuIHdoZW4KZG1hX2FkZHJfdCBjb25mbGljdHMuIEJ1dCB0aGF0IGp1c3Qg
ZmVlbHMgc3RyYW5nZSwgYW5kIEkgY291bGRuJ3QgZmluZAphbnkgZGVmaW5pdGl2ZSBndWlkZS4g
U28gd3JpdGluZyBkb3duIHdoeSB3ZSBjaG9zZSB0aGUgdHlwZSB3aWxsIGhlbHAKdGhlIGluZXZp
dGFibGUgbGF0ZXIgZGlzY3Vzc2lvbnMuCiAKPiBPbiB0aGF0IHRvcGljIHNob3VsZCB3ZSBhbHNv
IHN0b3AgdXNpbmcgInN0cnVjdCByZXNvdXJjZSIgaGVyZSwgc2luY2UgCj4gdGhhdCdzIHN0YXJ0
aW5nIHRvIGdldCBjb25mdXNpbmcsIG1heWJlIHVzZSB1NjQgdGhlcmUgYWxzbz8KCldlbGwsIEkn
bSBzdGlsbCBsb29raW5nIGF0IHN0cnVjdCByZXNvdXJjZSBhbmQgdGhpbmtpbmcvaG9waW5nIGl0
IG1heQpsZWFkIHRvIHVzIHJldXNpbmcgbW9yZSBzaGFyZWQgbGliLyByb3V0aW5lcy4gU28gSSdt
IGFtYml2YWxlbnQgaGVyZS4gOikKCk15IGNvcmUgb2JqZWN0aXZlIGhlcmUgaXMgc3VwcG9ydGlu
ZyBbaW4gdGhvdWdodCBleHBlcmltZW50cyBhdCBsZWFzdF0KNCtHaUIgbG9jYWwgbWVtb3J5IG9u
IDMyYiBwbGF0Zm9ybXMuIFRvIHB1bGwgaXQgb2ZmIHdvdWxkIG5lZWQgYSBiaXQKbW9yZSBjbGVh
bmluZyB1cCAoc28gdGhhdCB3ZSBuZXZlciBleHBvc2UgbW9yZSB0aGFuIHdlIGhhdmUgdG8pIHRv
IHN0YXkKd2l0aGluIHRoZSBkbWEgYnVkZ2V0IC0tIGFuZCB0aGF0IGhhcyBpbnRlcmVzdGluZyBy
YW1pZmljYXRpb25zIG9udG8KaW9tZW0gKHdlIHdvdWxkIG5lZWQgYSBtYXBwYWJsZS9ub24tbWFw
cGFibGUgc3BsaXQgYWdhaW4sIG9yIG1heWJlIHRoZQpIVyB3aWxsIG9ubHkgYWxsb3cgd2hhdCBj
YW4gYmUgbWFwcGVkPz8/KQotQ2hyaXMKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGlu
Zm8vaW50ZWwtZ2Z4

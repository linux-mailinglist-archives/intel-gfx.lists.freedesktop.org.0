Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 621C2347BC
	for <lists+intel-gfx@lfdr.de>; Tue,  4 Jun 2019 15:11:59 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id AC45189856;
	Tue,  4 Jun 2019 13:11:57 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga17.intel.com (mga17.intel.com [192.55.52.151])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6ECA989864
 for <intel-gfx@lists.freedesktop.org>; Tue,  4 Jun 2019 13:11:56 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga003.fm.intel.com ([10.253.24.29])
 by fmsmga107.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 04 Jun 2019 06:11:56 -0700
X-ExtLoop1: 1
Received: from bblokx-mobl.ger.corp.intel.com (HELO delly.ger.corp.intel.com)
 ([10.249.139.199])
 by FMSMGA003.fm.intel.com with ESMTP; 04 Jun 2019 06:11:54 -0700
From: Lionel Landwerlin <lionel.g.landwerlin@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Tue,  4 Jun 2019 16:11:39 +0300
Message-Id: <20190604131140.12647-7-lionel.g.landwerlin@intel.com>
X-Mailer: git-send-email 2.21.0.392.gf8f6787159e
In-Reply-To: <20190604131140.12647-1-lionel.g.landwerlin@intel.com>
References: <20190604131140.12647-1-lionel.g.landwerlin@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v3 6/7] drm/i915/perf: allow holding preemption
 on filtered ctx
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

V2Ugd291bGQgbGlrZSB0byBtYWtlIHVzZSBvZiBwZXJmIGluIFZ1bGthbi4gVGhlIFZ1bGthbiBB
UEkgaXMgbXVjaApsb3dlciBsZXZlbCB0aGFuIE9wZW5HTCwgd2l0aCBhcHBsaWNhdGlvbnMgZGly
ZWN0bHkgZXhwb3NlZCB0byB0aGUKY29uY2VwdCBvZiBjb21tYW5kIGJ1ZmZlcnMgKHByZXR0eSBt
dWNoIGVxdWl2YWxlbnQgdG8gb3VyIGJhdGNoCmJ1ZmZlcnMpLiBJbiBWdWxrYW4sIHF1ZXJpZXMg
YXJlIGFsd2F5cyBsaW1pdGVkIGluIHNjb3BlIHRvIGEgY29tbWFuZApidWZmZXIuIEluIE9wZW5H
TCwgdGhlIGxhY2sgb2YgY29tbWFuZCBidWZmZXIgY29uY2VwdCBtZWFudCB0aGF0CnF1ZXJpZXMn
IGR1cmF0aW9uIGNvdWxkIHNwYW4gbXVsdGlwbGUgY29tbWFuZCBidWZmZXJzLgoKV2l0aCB0aGF0
IHJlc3RyaWN0aW9uIGdvbmUgaW4gVnVsa2FuLCB3ZSB3b3VsZCBsaWtlIHRvIHNpbXBsaWZ5Cm1l
YXN1cmluZyBwZXJmb3JtYW5jZSBqdXN0IGJ5IG1lYXN1cmluZyB0aGUgZGVsdGFzIGJldHdlZW4g
dGhlIGNvdW50ZXIKc25hcHNob3RzIHdyaXR0ZW4gYnkgMiBNSV9SRUNPUkRfUEVSRl9DT1VOVCBj
b21tYW5kcywgcmF0aGVyIHRoYW4gdGhlCm1vcmUgY29tcGxleCBzY2hlbWUgd2UgY3VycmVudGx5
IGhhdmUgaW4gdGhlIEdMIGRyaXZlciwgdXNpbmcgMgpNSV9SRUNPUkRfUEVSRl9DT1VOVCBjb21t
YW5kcyBhbmQgZG9pbmcgc29tZSBwb3N0IHByb2Nlc3Npbmcgb24gdGhlCnN0cmVhbSBvZiBPQSBy
ZXBvcnRzLCBjb21pbmcgZnJvbSB0aGUgZ2xvYmFsIE9BIGJ1ZmZlciwgdG8gcmVtb3ZlIGFueQp1
bnJlbGF0ZWQgZGVsdGFzIGluIGJldHdlZW4gdGhlIDIgTUlfUkVDT1JEX1BFUkZfQ09VTlQuCgpE
aXNhYmxpbmcgcHJlZW1wdGlvbiBvbmx5IGFwcGx5IHRvIGEgc2luZ2xlIGNvbnRleHQgd2l0aCB3
aGljaCB3YW50IHRvCnF1ZXJ5IHBlcmZvcm1hbmNlIGNvdW50ZXJzIGZvciBhbmQgaXMgY29uc2lk
ZXJlZCBhIHByaXZpbGVnZWQKb3BlcmF0aW9uLCBieSBkZWZhdWx0IHByb3RlY3RlZCBieSBDQVBf
U1lTX0FETUlOLiBJdCBpcyBwb3NzaWJsZSB0bwplbmFibGUgaXQgZm9yIGEgbm9ybWFsIHVzZXIg
YnkgZGlzYWJsaW5nIHRoZSBwYXJhbm9pZCBzdHJlYW0gc2V0dGluZy4KCnYyOiBTdG9yZSBwcmVl
bXB0aW9uIHNldHRpbmcgaW4gaW50ZWxfY29udGV4dCAoQ2hyaXMpCgp2MzogVXNlIHByaW9yaXRp
ZXMgdG8gYXZvaWQgcHJlZW1wdGlvbiByYXRoZXIgdGhhbiB0aGUgSFcgbWVjaGFuaXNtCgpTaWdu
ZWQtb2ZmLWJ5OiBMaW9uZWwgTGFuZHdlcmxpbiA8bGlvbmVsLmcubGFuZHdlcmxpbkBpbnRlbC5j
b20+Ci0tLQogLi4uL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jICAgIHwg
IDggKysrKysrKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMgICAgICAgICAg
IHwgIDYgKysrKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgICAgICAgICAgICAg
ICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oICAgICAgICAgICAgICAg
fCAgOCArKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYyAgICAgICAgICAg
ICAgfCAyMiArKysrKysrKysrKysrKysrKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3By
aW9saXN0X3R5cGVzLmggICAgfCAgNyArKysrKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
cmVxdWVzdC5jICAgICAgICAgICB8ICAxICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVx
dWVzdC5oICAgICAgICAgICB8ICAxICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Y19z
dWJtaXNzaW9uLmMgICB8ICA2ICsrKysrCiBpbmNsdWRlL3VhcGkvZHJtL2k5MTVfZHJtLmggICAg
ICAgICAgICAgICAgICAgfCAxMCArKysrKysrKysKIDEwIGZpbGVzIGNoYW5nZWQsIDY4IGluc2Vy
dGlvbnMoKyksIDMgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9leGVjYnVmZmVyLmMKaW5kZXggNGE3ODU5OTlhOWM1Li41OWVjMWMwYTg4NzkgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYwpAQCAt
MjEwMCw2ICsyMTAwLDE0IEBAIHN0YXRpYyBpbnQgZWJfb2FfY29uZmlnKHN0cnVjdCBpOTE1X2V4
ZWNidWZmZXIgKmViKQogCWlmICghZWItPm9hX2NvbmZpZykKIAkJcmV0dXJuIDA7CiAKKwkvKgor
CSAqIElmIHRoZSBwZXJmIHN0cmVhbSB3YXMgb3BlbmVkIHdpdGggaG9sZCBwcmVlbXB0aW9uLCBm
bGFnIHRoZQorCSAqIHJlcXVlc3QgcHJvcGVybHkgc28gdGhhdCB0aGUgcHJpb3JpdHkgb2YgdGhl
IHJlcXVlc3QgaXMgYnVtcGVkIG9uY2UKKwkgKiBpdCByZWFjaGVzIHRoZSBleGVjbGlzdCBwb3J0
cy4KKwkgKi8KKwlpZiAoZWItPmk5MTUtPnBlcmYub2EuZXhjbHVzaXZlX3N0cmVhbS0+aG9sZF9w
cmVlbXB0aW9uKQorCQllYi0+cmVxdWVzdC0+aGFzX3BlcmYgPSB0cnVlOworCiAJLyoKIAkgKiBJ
ZiB0aGUgY29uZmlnIGhhc24ndCBjaGFuZ2VkLCBza2lwIHJlY29uZmlndXJpbmcgdGhlIEhXICh0
aGlzIGlzCiAJICogc3ViamVjdCB0byBhIGRlbGF5IHdlIHdhbnQgdG8gYXZvaWQgaGFzIG11Y2gg
YXMgcG9zc2libGUpLgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
bHJjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwppbmRleCBlZDE5ZjRl
NTNkMzEuLjQwNDZmMDQ1NDA4YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfbHJjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKQEAg
LTY4Myw2ICs2ODMsMTIgQEAgc3RhdGljIHZvaWQgcG9ydF9hc3NpZ24oc3RydWN0IGV4ZWNsaXN0
X3BvcnQgKnBvcnQsIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogCWlmIChwb3J0X2lzc2V0KHBv
cnQpKQogCQlpOTE1X3JlcXVlc3RfcHV0KHBvcnRfcmVxdWVzdChwb3J0KSk7CiAKKwlpZiAocnEt
Pmhhc19wZXJmKSB7CisJCXJxLT5zY2hlZC5hdHRyLnByaW9yaXR5ID0KKwkJCShJOTE1X1BSSU9S
SVRZX01BU0sgJiBycS0+c2NoZWQuYXR0ci5wcmlvcml0eSkgfAorCQkJSTkxNV9VU0VSX1BSSU9S
SVRZKEk5MTVfUFJJT1JJVFlfUEVSRik7CisJfQorCiAJcG9ydF9zZXQocG9ydCwgcG9ydF9wYWNr
KGk5MTVfcmVxdWVzdF9nZXQocnEpLCBwb3J0X2NvdW50KHBvcnQpKSk7CiB9CiAKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2Rydi5jCmluZGV4IDc1MDI5ZDFhMzgwMi4uOTg0Yjc2YTA5Y2ZhIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZHJ2LmMKQEAgLTQ3Niw3ICs0NzYsNyBAQCBzdGF0aWMgaW50IGk5MTVfZ2V0cGFy
YW1faW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIAkJdmFsdWUgPSBJ
TlRFTF9JTkZPKGRldl9wcml2KS0+aGFzX2NvaGVyZW50X2dndHQ7CiAJCWJyZWFrOwogCWNhc2Ug
STkxNV9QQVJBTV9QRVJGX1JFVklTSU9OOgotCQl2YWx1ZSA9IDE7CisJCXZhbHVlID0gMjsKIAkJ
YnJlYWs7CiAJY2FzZSBJOTE1X1BBUkFNX0hBU19FWEVDX1BFUkZfQ09ORklHOgogCQkvKiBPYnZp
b3VzbHkgcmVxdWlyZXMgcGVyZiBzdXBwb3J0LiAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKaW5k
ZXggYWVmZGFlODU2ZTc3Li41N2Y5MTU3NTFkNzYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaApA
QCAtMTM5Niw2ICsxMzk2LDE0IEBAIHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtIHsKIAkgKi8KIAli
b29sIGVuYWJsZWQ7CiAKKwkvKioKKwkgKiBAaG9sZF9wcmVlbXB0aW9uOiBXaGV0aGVyIHByZWVt
cHRpb24gaXMgcHV0IG9uIGhvbGQgZm9yIGNvbW1hbmQKKwkgKiBzdWJtaXNzaW9ucyBkb25lIG9u
IHRoZSBAY3R4LiBUaGlzIGlzIHVzZWZ1bCBmb3Igc29tZSBkcml2ZXJzIHRoYXQKKwkgKiBjYW5u
b3QgZWFzaWx5IHBvc3QgcHJvY2VzcyB0aGUgT0EgYnVmZmVyIGNvbnRleHQgdG8gc3VidHJhY3Qg
ZGVsdGEKKwkgKiBvZiBwZXJmb3JtYW5jZSBjb3VudGVycyBub3QgYXNzb2NpYXRlZCB3aXRoIEBj
dHguCisJICovCisJYm9vbCBob2xkX3ByZWVtcHRpb247CisKIAkvKioKIAkgKiBAb3BzOiBUaGUg
Y2FsbGJhY2tzIHByb3ZpZGluZyB0aGUgaW1wbGVtZW50YXRpb24gb2YgdGhpcyBzcGVjaWZpYwog
CSAqIHR5cGUgb2YgY29uZmlndXJlZCBzdHJlYW0uCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3BlcmYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5jCmlu
ZGV4IDgyYTI4MmY2NjhjMC4uZjg4OTdlM2NjODYyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3BlcmYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYu
YwpAQCAtMzQzLDYgKzM0Myw4IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9vYV9mb3JtYXQg
Z2VuOF9wbHVzX29hX2Zvcm1hdHNbSTkxNV9PQV9GT1JNQVRfTUFYXSA9IHsKICAqIHN0cnVjdCBw
ZXJmX29wZW5fcHJvcGVydGllcyAtIGZvciB2YWxpZGF0ZWQgcHJvcGVydGllcyBnaXZlbiB0byBv
cGVuIGEgc3RyZWFtCiAgKiBAc2FtcGxlX2ZsYWdzOiBgRFJNX0k5MTVfUEVSRl9QUk9QX1NBTVBM
RV8qYCBwcm9wZXJ0aWVzIGFyZSB0cmFja2VkIGFzIGZsYWdzCiAgKiBAc2luZ2xlX2NvbnRleHQ6
IFdoZXRoZXIgYSBzaW5nbGUgb3IgYWxsIGdwdSBjb250ZXh0cyBzaG91bGQgYmUgbW9uaXRvcmVk
CisgKiBAaG9sZF9wcmVlbXB0aW9uOiBXaGV0aGVyIHRoZSBwcmVlbXB0aW9uIGlzIGRpc2FibGVk
IGZvciB0aGUgZmlsdGVyZWQKKyAqICAgICAgICAgICAgICAgICAgIGNvbnRleHQKICAqIEBjdHhf
aGFuZGxlOiBBIGdlbSBjdHggaGFuZGxlIGZvciB1c2Ugd2l0aCBAc2luZ2xlX2NvbnRleHQKICAq
IEBtZXRyaWNzX3NldDogQW4gSUQgZm9yIGFuIE9BIHVuaXQgbWV0cmljIHNldCBhZHZlcnRpc2Vk
IHZpYSBzeXNmcwogICogQG9hX2Zvcm1hdDogQW4gT0EgdW5pdCBIVyByZXBvcnQgZm9ybWF0CkBA
IC0zNTcsNiArMzU5LDcgQEAgc3RydWN0IHBlcmZfb3Blbl9wcm9wZXJ0aWVzIHsKIAl1MzIgc2Ft
cGxlX2ZsYWdzOwogCiAJdTY0IHNpbmdsZV9jb250ZXh0OjE7CisJdTY0IGhvbGRfcHJlZW1wdGlv
bjoxOwogCXU2NCBjdHhfaGFuZGxlOwogCiAJLyogT0Egc2FtcGxpbmcgc3RhdGUgKi8KQEAgLTIx
NzAsNiArMjE3Myw4IEBAIHN0YXRpYyBpbnQgaTkxNV9vYV9zdHJlYW1faW5pdChzdHJ1Y3QgaTkx
NV9wZXJmX3N0cmVhbSAqc3RyZWFtLAogCXN0cmVhbS0+c2FtcGxlX2ZsYWdzIHw9IFNBTVBMRV9P
QV9SRVBPUlQ7CiAJc3RyZWFtLT5zYW1wbGVfc2l6ZSArPSBmb3JtYXRfc2l6ZTsKIAorCXN0cmVh
bS0+aG9sZF9wcmVlbXB0aW9uID0gcHJvcHMtPmhvbGRfcHJlZW1wdGlvbjsKKwogCWRldl9wcml2
LT5wZXJmLm9hLm9hX2J1ZmZlci5mb3JtYXRfc2l6ZSA9IGZvcm1hdF9zaXplOwogCWlmIChXQVJO
X09OKGRldl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZlci5mb3JtYXRfc2l6ZSA9PSAwKSkKIAkJcmV0
dXJuIC1FSU5WQUw7CkBAIC0yNjk1LDYgKzI3MDAsMTUgQEAgaTkxNV9wZXJmX29wZW5faW9jdGxf
bG9ja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAkJfQogCX0KIAorCWlm
IChwcm9wcy0+aG9sZF9wcmVlbXB0aW9uKSB7CisJCWlmICghcHJvcHMtPnNpbmdsZV9jb250ZXh0
KSB7CisJCQlEUk1fREVCVUcoInByZWVtcHRpb24gZGlzYWJsZSB3aXRoIG5vIGNvbnRleHRcbiIp
OworCQkJcmV0ID0gLUVJTlZBTDsKKwkJCWdvdG8gZXJyOworCQl9CisJCXByaXZpbGVnZWRfb3Ag
PSB0cnVlOworCX0KKwogCS8qCiAJICogT24gSGFzd2VsbCB0aGUgT0EgdW5pdCBzdXBwb3J0cyBj
bG9jayBnYXRpbmcgb2ZmIGZvciBhIHNwZWNpZmljCiAJICogY29udGV4dCBhbmQgaW4gdGhpcyBt
b2RlIHRoZXJlJ3Mgbm8gdmlzaWJpbGl0eSBvZiBtZXRyaWNzIGZvciB0aGUKQEAgLTI3MDksOCAr
MjcyMyw5IEBAIGk5MTVfcGVyZl9vcGVuX2lvY3RsX2xvY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCiAJICogTUlfUkVQT1JUX1BFUkZfQ09VTlQgY29tbWFuZHMgYW5kIHNv
IGNvbnNpZGVyIGl0IGEgcHJpdmlsZWdlZCBvcCB0bwogCSAqIGVuYWJsZSB0aGUgT0EgdW5pdCBi
eSBkZWZhdWx0LgogCSAqLwotCWlmIChJU19IQVNXRUxMKGRldl9wcml2KSAmJiBzcGVjaWZpY19j
dHgpCisJaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpICYmIHNwZWNpZmljX2N0eCAmJiAhcHJvcHMt
PmhvbGRfcHJlZW1wdGlvbikgewogCQlwcml2aWxlZ2VkX29wID0gZmFsc2U7CisJfQogCiAJLyog
U2ltaWxhciB0byBwZXJmJ3Mga2VybmVsLnBlcmZfcGFyYW5vaWRfY3B1IHN5c2N0bCBvcHRpb24K
IAkgKiB3ZSBjaGVjayBhIGRldi5pOTE1LnBlcmZfc3RyZWFtX3BhcmFub2lkIHN5c2N0bCBvcHRp
b24KQEAgLTI3MTksNyArMjczNCw3IEBAIGk5MTVfcGVyZl9vcGVuX2lvY3RsX2xvY2tlZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJICovCiAJaWYgKHByaXZpbGVnZWRfb3Ag
JiYKIAkgICAgaTkxNV9wZXJmX3N0cmVhbV9wYXJhbm9pZCAmJiAhY2FwYWJsZShDQVBfU1lTX0FE
TUlOKSkgewotCQlEUk1fREVCVUcoIkluc3VmZmljaWVudCBwcml2aWxlZ2VzIHRvIG9wZW4gc3lz
dGVtLXdpZGUgaTkxNSBwZXJmIHN0cmVhbVxuIik7CisJCURSTV9ERUJVRygiSW5zdWZmaWNpZW50
IHByaXZpbGVnZXMgdG8gb3BlbiBpOTE1IHBlcmYgc3RyZWFtXG4iKTsKIAkJcmV0ID0gLUVBQ0NF
UzsKIAkJZ290byBlcnJfY3R4OwogCX0KQEAgLTI5MTEsNiArMjkyNiw5IEBAIHN0YXRpYyBpbnQg
cmVhZF9wcm9wZXJ0aWVzX3VubG9ja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKIAkJCXByb3BzLT5vYV9wZXJpb2RpYyA9IHRydWU7CiAJCQlwcm9wcy0+b2FfcGVyaW9kX2V4
cG9uZW50ID0gdmFsdWU7CiAJCQlicmVhazsKKwkJY2FzZSBEUk1fSTkxNV9QRVJGX1BST1BfSE9M
RF9QUkVFTVBUSU9OOgorCQkJcHJvcHMtPmhvbGRfcHJlZW1wdGlvbiA9IHZhbHVlICE9IDAgPyAx
IDogMDsKKwkJCWJyZWFrOwogCQljYXNlIERSTV9JOTE1X1BFUkZfUFJPUF9NQVg6CiAJCQlNSVNT
SU5HX0NBU0UoaWQpOwogCQkJcmV0dXJuIC1FSU5WQUw7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3ByaW9saXN0X3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3ByaW9saXN0X3R5cGVzLmgKaW5kZXggNDk3MDlkZTY5ODc1Li5mYzFjMWZlN2NlNTggMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcHJpb2xpc3RfdHlwZXMuaAorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ByaW9saXN0X3R5cGVzLmgKQEAgLTE3LDYgKzE3
LDEzIEBAIGVudW0gewogCUk5MTVfUFJJT1JJVFlfTk9STUFMID0gSTkxNV9DT05URVhUX0RFRkFV
TFRfUFJJT1JJVFksCiAJSTkxNV9QUklPUklUWV9NQVggPSBJOTE1X0NPTlRFWFRfTUFYX1VTRVJf
UFJJT1JJVFkgKyAxLAogCisJLyogUmVxdWVzdHMgY29udGFpbmluZyBwZXJmb3JtYW5jZSBxdWVy
aWVzIG11c3Qgbm90IGJlIHByZWVtcHRlZCBieQorCSAqIGFub3RoZXIgY29udGV4dC4gVGhleSBn
ZXQgc2NoZWR1bGVkIHdpdGggdGhlaXIgZGVmYXVsdCBwcmlvcml0eSBhbmQKKwkgKiBvbmNlIHRo
ZXkgcmVhY2ggdGhlIGV4ZWNsaXN0IHBvcnRzIHdlIGJ1bXAgdGhlbSB0bworCSAqIEk5MTVfUFJJ
T1JJVFlfUEVSRiBzbyB0aGF0IHRoZXkgc3RpY2sgdG8gdGhlIEhXIHVudGlsIHRoZXkgZmluaXNo
LgorCSAqLworCUk5MTVfUFJJT1JJVFlfUEVSRiA9IEk5MTVfQ09OVEVYVF9NQVhfVVNFUl9QUklP
UklUWSArIDIsCisKIAlJOTE1X1BSSU9SSVRZX0lOVkFMSUQgPSBJTlRfTUlOCiB9OwogCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jCmluZGV4IGRhMWU2OTg0YThjYy4uNDhkYmU5ODhkYjIz
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYwpAQCAtNzI1LDYgKzcyNSw3IEBAIF9f
aTkxNV9yZXF1ZXN0X2NyZWF0ZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIGdmcF90IGdmcCkK
IAlycS0+YmF0Y2ggPSBOVUxMOwogCXJxLT5jYXB0dXJlX2xpc3QgPSBOVUxMOwogCXJxLT53YWl0
Ym9vc3QgPSBmYWxzZTsKKwlycS0+aGFzX3BlcmYgPSBmYWxzZTsKIAlycS0+ZXhlY3V0aW9uX21h
c2sgPSBBTExfRU5HSU5FUzsKIAogCUlOSVRfTElTVF9IRUFEKCZycS0+YWN0aXZlX2xpc3QpOwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmggYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuaAppbmRleCBjOWY3ZDA3OTkxYzguLmFiMDliNWJi
ODlmNyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmgKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmgKQEAgLTIxNiw2ICsyMTYsNyBA
QCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0IHsKIAl1bnNpZ25lZCBsb25nIGVtaXR0ZWRfamlmZmllczsK
IAogCWJvb2wgd2FpdGJvb3N0OworCWJvb2wgaGFzX3BlcmY7CiAKIAkvKiogZW5naW5lLT5yZXF1
ZXN0X2xpc3QgZW50cnkgZm9yIHRoaXMgcmVxdWVzdCAqLwogCXN0cnVjdCBsaXN0X2hlYWQgbGlu
azsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Y19zdWJtaXNzaW9u
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfc3VibWlzc2lvbi5jCmluZGV4IGE0
Zjk4Y2NlZjBmZS4uY2JhM2Y1MGRjMWZlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9ndWNfc3VibWlzc2lvbi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X2d1Y19zdWJtaXNzaW9uLmMKQEAgLTcxNyw2ICs3MTcsMTIgQEAgc3RhdGljIHZvaWQgcG9ydF9h
c3NpZ24oc3RydWN0IGV4ZWNsaXN0X3BvcnQgKnBvcnQsIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJx
KQogewogCUdFTV9CVUdfT04ocG9ydF9pc3NldChwb3J0KSk7CiAKKwlpZiAocnEtPmhhc19wZXJm
KSB7CisJCXJxLT5zY2hlZC5hdHRyLnByaW9yaXR5ID0KKwkJCShJOTE1X1BSSU9SSVRZX01BU0sg
JiBycS0+c2NoZWQuYXR0ci5wcmlvcml0eSkgfAorCQkJSTkxNV9VU0VSX1BSSU9SSVRZKEk5MTVf
UFJJT1JJVFlfUEVSRik7CisJfQorCiAJcG9ydF9zZXQocG9ydCwgaTkxNV9yZXF1ZXN0X2dldChy
cSkpOwogfQogCmRpZmYgLS1naXQgYS9pbmNsdWRlL3VhcGkvZHJtL2k5MTVfZHJtLmggYi9pbmNs
dWRlL3VhcGkvZHJtL2k5MTVfZHJtLmgKaW5kZXggN2Y3NzAxODNlZTMxLi44ZmZkYmMwZTQ2MTYg
MTAwNjQ0Ci0tLSBhL2luY2x1ZGUvdWFwaS9kcm0vaTkxNV9kcm0uaAorKysgYi9pbmNsdWRlL3Vh
cGkvZHJtL2k5MTVfZHJtLmgKQEAgLTIwMDEsNiArMjAwMSwxNiBAQCBlbnVtIGRybV9pOTE1X3Bl
cmZfcHJvcGVydHlfaWQgewogCSAqLwogCURSTV9JOTE1X1BFUkZfUFJPUF9PQV9FWFBPTkVOVCwK
IAorCS8qKgorCSAqIFNwZWNpZnlpbmcgdGhpcyBwcm9wZXJ0eSBpcyBvbmx5IHZhbGlkIHdoZW4g
c3BlY2lmeSBhIGNvbnRleHQgdG8KKwkgKiBmaWx0ZXIgd2l0aCBEUk1fSTkxNV9QRVJGX1BST1Bf
Q1RYX0hBTkRMRS4gU3BlY2lmeWluZyB0aGlzIHByb3BlcnR5CisJICogd2lsbCBob2xkIHByZWVt
cHRpb24gb2YgdGhlIHBhcnRpY3VsYXIgY29udGV4dCB3ZSB3YW50IHRvIGdhdGhlcgorCSAqIHBl
cmZvcm1hbmNlIGRhdGEgYWJvdXQuCisJICoKKwkgKiBUaGlzIHByb3BlcnR5IGlzIGF2YWlsYWJs
ZSBpbiBwZXJmIHJldmlzaW9uIDIuCisJICovCisJRFJNX0k5MTVfUEVSRl9QUk9QX0hPTERfUFJF
RU1QVElPTiwKKwogCURSTV9JOTE1X1BFUkZfUFJPUF9NQVggLyogbm9uLUFCSSAqLwogfTsKIAot
LSAKMi4yMS4wLjM5Mi5nZjhmNjc4NzE1OWUKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3Rz
LmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xp
c3RpbmZvL2ludGVsLWdmeA==

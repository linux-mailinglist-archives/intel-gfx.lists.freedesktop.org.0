Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 57CC2181CF4
	for <lists+intel-gfx@lfdr.de>; Wed, 11 Mar 2020 16:54:37 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A5A586E9AD;
	Wed, 11 Mar 2020 15:54:35 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga18.intel.com (mga18.intel.com [134.134.136.126])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0F7226E9AF
 for <intel-gfx@lists.freedesktop.org>; Wed, 11 Mar 2020 15:54:34 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga002.jf.intel.com ([10.7.209.21])
 by orsmga106.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 11 Mar 2020 08:54:33 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.70,518,1574150400"; d="scan'208";a="261181459"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.174])
 by orsmga002.jf.intel.com with SMTP; 11 Mar 2020 08:54:31 -0700
Received: by stinkbox (sSMTP sendmail emulation);
 Wed, 11 Mar 2020 17:54:30 +0200
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 11 Mar 2020 17:54:22 +0200
Message-Id: <20200311155422.3043-4-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.24.1
In-Reply-To: <20200311155422.3043-1-ville.syrjala@linux.intel.com>
References: <20200311155422.3043-1-ville.syrjala@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v3 3/3] drm/i915: Use stashed away hpd isr bits
 in intel_digital_port_connected()
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KCkdl
dCByaWQgb2Ygc2V2ZXJhbCBwbGF0Zm9ybSBzcGVjaWZpYyB2YXJpYW50cyBvZgppbnRlbF9kaWdp
dGFsX3BvcnRfY29ubmVjdGVkKCkgYW5kIGp1c3QgdXNlIHRoZSBJU1IgYml0cyB3ZSd2ZQpzdGFz
aGVkIGF3YXkuCgp2MjogRHVwbGljYXRlIHN0dWZmIHRvIGF2b2lkIGV4cG9zaW5nIHBsYXRmb3Jt
IHNwZWNpZmljCiAgICBmdW5jdGlvbnMgYWNyb3NzIGZpbGVzIChKYW5pKQoKU2lnbmVkLW9mZi1i
eTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KLS0tCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RkaS5jIHwgODggKysrLS0tLS0tLS0t
LS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwLmMgIHwg
NTkgKystLS0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF90
Yy5jICB8ICA0ICstCiAzIGZpbGVzIGNoYW5nZWQsIDE3IGluc2VydGlvbnMoKyksIDEzNCBkZWxl
dGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2RkaS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGkuYwppbmRleCBj
OGNlYjA4ZjhkMDUuLmQ2NGZjYzE4YWU0ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9kZGkuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2RkaS5jCkBAIC00MzQ2LDQxICs0MzQ2LDcgQEAgaW50ZWxfZGRpX2hvdHBsdWcoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiBzdGF0aWMgYm9vbCBscHRfZGlnaXRhbF9wb3J0
X2Nvbm5lY3RlZChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKIHsKIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKLQl1
MzIgYml0OwotCi0Jc3dpdGNoIChlbmNvZGVyLT5ocGRfcGluKSB7Ci0JY2FzZSBIUERfUE9SVF9C
OgotCQliaXQgPSBTREVfUE9SVEJfSE9UUExVR19DUFQ7Ci0JCWJyZWFrOwotCWNhc2UgSFBEX1BP
UlRfQzoKLQkJYml0ID0gU0RFX1BPUlRDX0hPVFBMVUdfQ1BUOwotCQlicmVhazsKLQljYXNlIEhQ
RF9QT1JUX0Q6Ci0JCWJpdCA9IFNERV9QT1JURF9IT1RQTFVHX0NQVDsKLQkJYnJlYWs7Ci0JZGVm
YXVsdDoKLQkJTUlTU0lOR19DQVNFKGVuY29kZXItPmhwZF9waW4pOwotCQlyZXR1cm4gZmFsc2U7
Ci0JfQotCi0JcmV0dXJuIGludGVsX2RlX3JlYWQoZGV2X3ByaXYsIFNERUlTUikgJiBiaXQ7Ci19
Ci0KLXN0YXRpYyBib29sIHNwdF9kaWdpdGFsX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyKQotewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwotCXUzMiBiaXQ7Ci0KLQlzd2l0Y2ggKGVuY29k
ZXItPmhwZF9waW4pIHsKLQljYXNlIEhQRF9QT1JUX0E6Ci0JCWJpdCA9IFNERV9QT1JUQV9IT1RQ
TFVHX1NQVDsKLQkJYnJlYWs7Ci0JY2FzZSBIUERfUE9SVF9FOgotCQliaXQgPSBTREVfUE9SVEVf
SE9UUExVR19TUFQ7Ci0JCWJyZWFrOwotCWRlZmF1bHQ6Ci0JCXJldHVybiBscHRfZGlnaXRhbF9w
b3J0X2Nvbm5lY3RlZChlbmNvZGVyKTsKLQl9CisJdTMyIGJpdCA9IGRldl9wcml2LT5ob3RwbHVn
LnBjaF9ocGRbZW5jb2Rlci0+aHBkX3Bpbl07CiAKIAlyZXR1cm4gaW50ZWxfZGVfcmVhZChkZXZf
cHJpdiwgU0RFSVNSKSAmIGJpdDsKIH0KQEAgLTQzODgsNTEgKzQzNTQsMTkgQEAgc3RhdGljIGJv
b2wgc3B0X2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIpCiBzdGF0aWMgYm9vbCBoc3dfZGlnaXRhbF9wb3J0X2Nvbm5lY3RlZChzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlcikKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKKwl1MzIgYml0ID0gZGV2X3ByaXYtPmhvdHBs
dWcuaHBkW2VuY29kZXItPmhwZF9waW5dOwogCi0JcmV0dXJuIGludGVsX2RlX3JlYWQoZGV2X3By
aXYsIERFSVNSKSAmIERFX0RQX0FfSE9UUExVR19JVkI7CisJcmV0dXJuIGludGVsX2RlX3JlYWQo
ZGV2X3ByaXYsIERFSVNSKSAmIGJpdDsKIH0KIAogc3RhdGljIGJvb2wgYmR3X2RpZ2l0YWxfcG9y
dF9jb25uZWN0ZWQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCiB7CiAJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Ci0K
LQlyZXR1cm4gaW50ZWxfZGVfcmVhZChkZXZfcHJpdiwgR0VOOF9ERV9QT1JUX0lTUikgJiBHRU44
X1BPUlRfRFBfQV9IT1RQTFVHOwotfQotCi1zdGF0aWMgYm9vbCBieHRfZGlnaXRhbF9wb3J0X2Nv
bm5lY3RlZChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKLXsKLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKLQl1MzIg
Yml0OwotCi0Jc3dpdGNoIChlbmNvZGVyLT5ocGRfcGluKSB7Ci0JY2FzZSBIUERfUE9SVF9BOgot
CQliaXQgPSBCWFRfREVfUE9SVF9IUF9ERElBOwotCQlicmVhazsKLQljYXNlIEhQRF9QT1JUX0I6
Ci0JCWJpdCA9IEJYVF9ERV9QT1JUX0hQX0RESUI7Ci0JCWJyZWFrOwotCWNhc2UgSFBEX1BPUlRf
QzoKLQkJYml0ID0gQlhUX0RFX1BPUlRfSFBfRERJQzsKLQkJYnJlYWs7Ci0JZGVmYXVsdDoKLQkJ
TUlTU0lOR19DQVNFKGVuY29kZXItPmhwZF9waW4pOwotCQlyZXR1cm4gZmFsc2U7Ci0JfQorCXUz
MiBiaXQgPSBkZXZfcHJpdi0+aG90cGx1Zy5ocGRbZW5jb2Rlci0+aHBkX3Bpbl07CiAKIAlyZXR1
cm4gaW50ZWxfZGVfcmVhZChkZXZfcHJpdiwgR0VOOF9ERV9QT1JUX0lTUikgJiBiaXQ7CiB9CiAK
LXN0YXRpYyBib29sIGljcF9kaWdpdGFsX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyKQotewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwotCWVudW0gcGh5IHBoeSA9IGludGVsX3BvcnRfdG9f
cGh5KGRldl9wcml2LCBlbmNvZGVyLT5wb3J0KTsKLQotCWlmIChIQVNfUENIX01DQyhkZXZfcHJp
dikgJiYgcGh5ID09IFBIWV9DKQotCQlyZXR1cm4gaW50ZWxfZGVfcmVhZChkZXZfcHJpdiwgU0RF
SVNSKSAmIFNERV9UQ19IT1RQTFVHX0lDUChQT1JUX1RDMSk7Ci0KLQlyZXR1cm4gaW50ZWxfZGVf
cmVhZChkZXZfcHJpdiwgU0RFSVNSKSAmIFNERV9ERElfSE9UUExVR19JQ1AocGh5KTsKLX0KLQog
c3RhdGljIHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKgogaW50ZWxfZGRpX2luaXRfaGRtaV9jb25u
ZWN0b3Ioc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQpCiB7CkBAIC00
NjI4LDE3ICs0NTYyLDE1IEBAIHZvaWQgaW50ZWxfZGRpX2luaXQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LCBlbnVtIHBvcnQgcG9ydCkKIAkJaWYgKGludGVsX3BoeV9pc190Yyhk
ZXZfcHJpdiwgcGh5KSkKIAkJCWludGVsX2RpZ19wb3J0LT5jb25uZWN0ZWQgPSBpbnRlbF90Y19w
b3J0X2Nvbm5lY3RlZDsKIAkJZWxzZQotCQkJaW50ZWxfZGlnX3BvcnQtPmNvbm5lY3RlZCA9IGlj
cF9kaWdpdGFsX3BvcnRfY29ubmVjdGVkOwotCX0gZWxzZSBpZiAoSVNfR0VOOV9MUChkZXZfcHJp
dikpIHsKLQkJaW50ZWxfZGlnX3BvcnQtPmNvbm5lY3RlZCA9IGJ4dF9kaWdpdGFsX3BvcnRfY29u
bmVjdGVkOwotCX0gZWxzZSBpZiAocG9ydCA9PSBQT1JUX0EpIHsKLQkJaWYgKElOVEVMX0dFTihk
ZXZfcHJpdikgPj0gOCkKKwkJCWludGVsX2RpZ19wb3J0LT5jb25uZWN0ZWQgPSBscHRfZGlnaXRh
bF9wb3J0X2Nvbm5lY3RlZDsKKwl9IGVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOCkg
eworCQlpZiAocG9ydCA9PSBQT1JUX0EgfHwgSVNfR0VOOV9MUChkZXZfcHJpdikpCiAJCQlpbnRl
bF9kaWdfcG9ydC0+Y29ubmVjdGVkID0gYmR3X2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQ7CiAJCWVs
c2UKKwkJCWludGVsX2RpZ19wb3J0LT5jb25uZWN0ZWQgPSBscHRfZGlnaXRhbF9wb3J0X2Nvbm5l
Y3RlZDsKKwl9IGVsc2UgeworCQlpZiAocG9ydCA9PSBQT1JUX0EpCiAJCQlpbnRlbF9kaWdfcG9y
dC0+Y29ubmVjdGVkID0gaHN3X2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQ7Ci0JfSBlbHNlIHsKLQkJ
aWYgKElOVEVMX1BDSF9UWVBFKGRldl9wcml2KSA+PSBQQ0hfU1BUKQotCQkJaW50ZWxfZGlnX3Bv
cnQtPmNvbm5lY3RlZCA9IHNwdF9kaWdpdGFsX3BvcnRfY29ubmVjdGVkOwogCQllbHNlCiAJCQlp
bnRlbF9kaWdfcG9ydC0+Y29ubmVjdGVkID0gbHB0X2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQ7CiAJ
fQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jCmluZGV4IGNmZjE0ZjUyYzM5
MS4uYjM0OTMzOTU5ZTU0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2RwLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5j
CkBAIC01NDA0LDQ1ICs1NDA0LDcgQEAgZWRwX2RldGVjdChzdHJ1Y3QgaW50ZWxfZHAgKmludGVs
X2RwKQogc3RhdGljIGJvb2wgaWJ4X2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Ci0JdTMyIGJpdDsKLQotCXN3aXRjaCAoZW5j
b2Rlci0+aHBkX3BpbikgewotCWNhc2UgSFBEX1BPUlRfQjoKLQkJYml0ID0gU0RFX1BPUlRCX0hP
VFBMVUc7Ci0JCWJyZWFrOwotCWNhc2UgSFBEX1BPUlRfQzoKLQkJYml0ID0gU0RFX1BPUlRDX0hP
VFBMVUc7Ci0JCWJyZWFrOwotCWNhc2UgSFBEX1BPUlRfRDoKLQkJYml0ID0gU0RFX1BPUlREX0hP
VFBMVUc7Ci0JCWJyZWFrOwotCWRlZmF1bHQ6Ci0JCU1JU1NJTkdfQ0FTRShlbmNvZGVyLT5ocGRf
cGluKTsKLQkJcmV0dXJuIGZhbHNlOwotCX0KLQotCXJldHVybiBpbnRlbF9kZV9yZWFkKGRldl9w
cml2LCBTREVJU1IpICYgYml0OwotfQotCi1zdGF0aWMgYm9vbCBjcHRfZGlnaXRhbF9wb3J0X2Nv
bm5lY3RlZChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKLXsKLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKLQl1MzIg
Yml0OwotCi0Jc3dpdGNoIChlbmNvZGVyLT5ocGRfcGluKSB7Ci0JY2FzZSBIUERfUE9SVF9COgot
CQliaXQgPSBTREVfUE9SVEJfSE9UUExVR19DUFQ7Ci0JCWJyZWFrOwotCWNhc2UgSFBEX1BPUlRf
QzoKLQkJYml0ID0gU0RFX1BPUlRDX0hPVFBMVUdfQ1BUOwotCQlicmVhazsKLQljYXNlIEhQRF9Q
T1JUX0Q6Ci0JCWJpdCA9IFNERV9QT1JURF9IT1RQTFVHX0NQVDsKLQkJYnJlYWs7Ci0JZGVmYXVs
dDoKLQkJTUlTU0lOR19DQVNFKGVuY29kZXItPmhwZF9waW4pOwotCQlyZXR1cm4gZmFsc2U7Ci0J
fQorCXUzMiBiaXQgPSBkZXZfcHJpdi0+aG90cGx1Zy5wY2hfaHBkW2VuY29kZXItPmhwZF9waW5d
OwogCiAJcmV0dXJuIGludGVsX2RlX3JlYWQoZGV2X3ByaXYsIFNERUlTUikgJiBiaXQ7CiB9CkBA
IC01NDk2LDE1ICs1NDU4LDkgQEAgc3RhdGljIGJvb2wgZ200NV9kaWdpdGFsX3BvcnRfY29ubmVj
dGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQogc3RhdGljIGJvb2wgaWxrX2RpZ2l0
YWxfcG9ydF9jb25uZWN0ZWQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCiB7CiAJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRl
dik7CisJdTMyIGJpdCA9IGRldl9wcml2LT5ob3RwbHVnLmhwZFtlbmNvZGVyLT5ocGRfcGluXTsK
IAotCXJldHVybiBpbnRlbF9kZV9yZWFkKGRldl9wcml2LCBERUlTUikgJiBERV9EUF9BX0hPVFBM
VUc7Ci19Ci0KLXN0YXRpYyBib29sIGl2Yl9kaWdpdGFsX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyKQotewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwotCi0JcmV0dXJuIGludGVsX2RlX3Jl
YWQoZGV2X3ByaXYsIERFSVNSKSAmIERFX0RQX0FfSE9UUExVR19JVkI7CisJcmV0dXJuIGludGVs
X2RlX3JlYWQoZGV2X3ByaXYsIERFSVNSKSAmIGJpdDsKIH0KIAogLyoKQEAgLTc3MzUsMTQgKzc2
OTEsOSBAQCBib29sIGludGVsX2RwX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAogCQkJaW50ZWxfZGlnX3BvcnQtPmNvbm5lY3RlZCA9IGdtNDVfZGlnaXRhbF9wb3J0X2Nv
bm5lY3RlZDsKIAkJZWxzZQogCQkJaW50ZWxfZGlnX3BvcnQtPmNvbm5lY3RlZCA9IGc0eF9kaWdp
dGFsX3BvcnRfY29ubmVjdGVkOwotCX0gZWxzZSBpZiAocG9ydCA9PSBQT1JUX0EpIHsKLQkJaWYg
KElTX0lWWUJSSURHRShkZXZfcHJpdikpCi0JCQlpbnRlbF9kaWdfcG9ydC0+Y29ubmVjdGVkID0g
aXZiX2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQ7Ci0JCWVsc2UKKwl9IGVsc2UgeworCQlpZiAocG9y
dCA9PSBQT1JUX0EpCiAJCQlpbnRlbF9kaWdfcG9ydC0+Y29ubmVjdGVkID0gaWxrX2RpZ2l0YWxf
cG9ydF9jb25uZWN0ZWQ7Ci0JfSBlbHNlIHsKLQkJaWYgKEhBU19QQ0hfQ1BUKGRldl9wcml2KSkK
LQkJCWludGVsX2RpZ19wb3J0LT5jb25uZWN0ZWQgPSBjcHRfZGlnaXRhbF9wb3J0X2Nvbm5lY3Rl
ZDsKIAkJZWxzZQogCQkJaW50ZWxfZGlnX3BvcnQtPmNvbm5lY3RlZCA9IGlieF9kaWdpdGFsX3Bv
cnRfY29ubmVjdGVkOwogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfdGMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfdGMuYwpp
bmRleCAxZTY0YjRjOTJlZWMuLjBiNmMxOTUwZWM2ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF90Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfdGMuYwpAQCAtMTczLDggKzE3Myw4IEBAIHN0YXRpYyB2b2lkIHRjX3BvcnRf
Zml4dXBfbGVnYWN5X2ZsYWcoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQsCiBz
dGF0aWMgdTMyIHRjX3BvcnRfbGl2ZV9zdGF0dXNfbWFzayhzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9w
b3J0ICpkaWdfcG9ydCkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOwotCWVudW0gdGNfcG9ydCB0Y19wb3J0ID0gaW50
ZWxfcG9ydF90b190YyhpOTE1LCBkaWdfcG9ydC0+YmFzZS5wb3J0KTsKIAlzdHJ1Y3QgaW50ZWxf
dW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOworCXUzMiBpc3JfYml0ID0gaTkxNS0+aG90
cGx1Zy5wY2hfaHBkW2RpZ19wb3J0LT5iYXNlLmhwZF9waW5dOwogCXUzMiBtYXNrID0gMDsKIAl1
MzIgdmFsOwogCkBAIC0xOTMsNyArMTkzLDcgQEAgc3RhdGljIHUzMiB0Y19wb3J0X2xpdmVfc3Rh
dHVzX21hc2soc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQpCiAJaWYgKHZhbCAm
IFRDX0xJVkVfU1RBVEVfVEMoZGlnX3BvcnQtPnRjX3BoeV9maWFfaWR4KSkKIAkJbWFzayB8PSBC
SVQoVENfUE9SVF9EUF9BTFQpOwogCi0JaWYgKGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgU0RF
SVNSKSAmIFNERV9UQ19IT1RQTFVHX0lDUCh0Y19wb3J0KSkKKwlpZiAoaW50ZWxfdW5jb3JlX3Jl
YWQodW5jb3JlLCBTREVJU1IpICYgaXNyX2JpdCkKIAkJbWFzayB8PSBCSVQoVENfUE9SVF9MRUdB
Q1kpOwogCiAJLyogVGhlIHNpbmsgY2FuIGJlIGNvbm5lY3RlZCBvbmx5IGluIGEgc2luZ2xlIG1v
ZGUuICovCi0tIAoyLjI0LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNr
dG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2lu
dGVsLWdmeAo=

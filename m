Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 23806191AB1
	for <lists+intel-gfx@lfdr.de>; Tue, 24 Mar 2020 21:13:25 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 570736E52C;
	Tue, 24 Mar 2020 20:13:23 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga06.intel.com (mga06.intel.com [134.134.136.31])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 75A7F6E52C
 for <intel-gfx@lists.freedesktop.org>; Tue, 24 Mar 2020 20:13:16 +0000 (UTC)
IronPort-SDR: zK+PvWZbJMMxqCUAIkQcFYB9XeYuJEXkUSAIh2nlNIzvvN9XnwwF3rqhwDEmL8rEA9Qjj7BqQD
 dp5WhpyIOrNA==
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga007.jf.intel.com ([10.7.209.58])
 by orsmga104.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 24 Mar 2020 13:13:14 -0700
IronPort-SDR: jCCREOkai4wBsuRTyi7mcLJB4nykM4OkGOlIrNgpGKERvAdFIPdcCSLW9U7hK9dgzsEDXGVKkI
 D9c5NqfV6nOw==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.72,301,1580803200"; d="scan'208";a="235700559"
Received: from josouza-mobl2.jf.intel.com (HELO josouza-MOBL2.intel.com)
 ([10.24.15.8])
 by orsmga007.jf.intel.com with ESMTP; 24 Mar 2020 13:13:14 -0700
From: =?UTF-8?q?Jos=C3=A9=20Roberto=20de=20Souza?= <jose.souza@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 24 Mar 2020 13:14:28 -0700
Message-Id: <20200324201429.29153-5-jose.souza@intel.com>
X-Mailer: git-send-email 2.26.0
In-Reply-To: <20200324201429.29153-1-jose.souza@intel.com>
References: <20200324201429.29153-1-jose.souza@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v3 5/6] drm/i915/tc/icl: Implement the TC cold
 exit sequence
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Cooper Chiou <cooper.chiou@intel.com>,
 Kai-Heng Feng <kai.heng.feng@canonical.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VGhpcyBpcyByZXF1aXJlZCBmb3IgbGVnYWN5L3N0YXRpYyBUQyBwb3J0cyBhcyBJT00gaXMgbm90
IGF3YXJlIG9mCnRoZSBjb25uZWN0aW9uIGFuZCB3aWxsIG5vdCB0cmlnZ2VyIHRoZSBUQyBjb2xk
IGV4aXQuCgpKdXN0IHJlcXVlc3QgUENPREUgdG8gZXhpdCBUQ0NPTEQgaXMgbm90IGVub3VnaCBh
cyBpdCBjb3VsZCBlbnRlcgphZ2FpbiBiZSBkcml2ZXIgbWFrZXMgdXNlIG9mIHRoZSBwb3J0LCB0
byBwcmV2ZW50IGl0IEJTcGVjIHN0YXRlcyB0aGF0CmF1eCBwb3dlcndlbGwgc2hvdWxkIGJlIGhl
bGQuCgpTbyBiZWZvcmUgZGV0ZWN0aW5nIHRoZSBtb2RlLCBhdXggcG93ZXIgaXMgcmVxdWVzdGVk
IHdpdGhvdXQgd2FpdCBmb3IKaGFyZHdhcmUgYWNrLCBQQ09ERSBpcyByZXF1ZXN0ZWQgdG8gZXhp
dCBUQ0NPTEQgYW5kIHRoZSBUQyBkZXRlY3Rpb24Kc2VxdWVuY2VzIGZvbGxvd3MgYXMgbm9ybWFs
LgpBZnRlciBkZXRlY3Rpb24gaWYgbW9kZSBpcyBub3Qgc3RhdGljIGF1eCBjYW4gYmUgcG93ZXJl
ZCBvZmYgb3RoZXJ3aXNlCndlIG5lZWQgdG8gd2FpdCBmb3IgSFcgYWNrIGFzIGZ1dHVyZSBjYWxs
cyB0byBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldCgpCm92ZXIgYXV4IHdpbGwgbm90IGNoZWNrIGZv
ciBIVyBhY2suCgp2MjoKLSBmaXhlZCB0eXBvIHRjX2xvY2tfd2FrZXJlZiB0byB0Y19jb2xkX3dh
a2VyZWYgaW4gaWNsX3RjX2NvbGRfcmVxdWVzdCgpCgp2MzoKLSBmaXhlZCBub24gaW5pdGlhbGl6
ZWQgcmV0IGluIGljbF90Y19jb2xkX3JlcXVlc3QoKQotIGFkZGVkIG1pc3Npbmcgc2xlZXAgc3Rl
cCwgaW5pdGlhbGx5IGl0IHdhcyBub3QgYWRkZWQgYmVjYXVzZSBJCnRob3VnaHQgdGhhdCB0aGUg
YXV4IGVuYWJsZSBhbmQgdGhlbiBIVyBhY2sgd2FpdCB3b3VsZCB0YWtlIGNhcmUgb2YKdGhhdCBi
dXQgdGhhdCBpcyBub3QgdGhlIGNhc2UKCkJTcGVjOiAyMTc1MApGaXhlczogaHR0cHM6Ly9naXRs
YWIuZnJlZWRlc2t0b3Aub3JnL2RybS9pbnRlbC9pc3N1ZXMvMTI5NgpDYzogSW1yZSBEZWFrIDxp
bXJlLmRlYWtAaW50ZWwuY29tPgpDYzogQ29vcGVyIENoaW91IDxjb29wZXIuY2hpb3VAaW50ZWwu
Y29tPgpDYzogS2FpLUhlbmcgRmVuZyA8a2FpLmhlbmcuZmVuZ0BjYW5vbmljYWwuY29tPgpTaWdu
ZWQtb2ZmLWJ5OiBKb3PDqSBSb2JlcnRvIGRlIFNvdXphIDxqb3NlLnNvdXphQGludGVsLmNvbT4K
LS0tCiAuLi4vZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmMgICAgfCAzMCAr
KysrKysrKystCiAuLi4vZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmggICAg
fCAgMSArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3RjLmMgICAgICAgfCA2
MCArKysrKysrKysrKysrKysrKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlZy5oICAg
ICAgICAgICAgICAgfCAgMSArCiA0IGZpbGVzIGNoYW5nZWQsIDg0IGluc2VydGlvbnMoKyksIDgg
ZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kaXNwbGF5X3Bvd2VyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2Rpc3BsYXlfcG93ZXIuYwppbmRleCBhN2U1MzFiNjRlMTYuLjcxYTRjNWQ3OTBlYSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmMK
QEAgLTU3Myw4ICs1NzMsOSBAQCBzdGF0aWMgdm9pZCBpY2xfdGNfcG9ydF9hc3NlcnRfcmVmX2hl
bGQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogI2RlZmluZSBUR0xfQVVYX1BX
X1RPX1RDX1BPUlQocHdfaWR4KQkoKHB3X2lkeCkgLSBUR0xfUFdfQ1RMX0lEWF9BVVhfVEMxKQog
CiBzdGF0aWMgdm9pZAotaWNsX3RjX3BoeV9hdXhfcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAotCQkJCSBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpw
b3dlcl93ZWxsKQorX2ljbF90Y19waHlfYXV4X3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKKwkJCQkgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBv
d2VyX3dlbGwsCisJCQkJICBib29sIHdhaXRfYWNrKQogewogCWVudW0gYXV4X2NoIGF1eF9jaCA9
IGljbF90Y19waHlfYXV4X2NoKGRldl9wcml2LCBwb3dlcl93ZWxsKTsKIAl1MzIgdmFsOwpAQCAt
NTg3LDcgKzU4OCw3IEBAIGljbF90Y19waHlfYXV4X3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAkJdmFsIHw9IERQX0FVWF9DSF9DVExfVEJUX0lP
OwogCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBEUF9BVVhfQ0hfQ1RMKGF1eF9jaCksIHZhbCk7
CiAKLQloc3dfcG93ZXJfd2VsbF9lbmFibGUoZGV2X3ByaXYsIHBvd2VyX3dlbGwpOworCV9oc3df
cG93ZXJfd2VsbF9lbmFibGUoZGV2X3ByaXYsIHBvd2VyX3dlbGwsIHdhaXRfYWNrKTsKIAogCWlm
IChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEyICYmICFwb3dlcl93ZWxsLT5kZXNjLT5oc3cuaXNf
dGNfdGJ0KSB7CiAJCWVudW0gdGNfcG9ydCB0Y19wb3J0OwpAQCAtNjAzLDYgKzYwNCwyMCBAQCBp
Y2xfdGNfcGh5X2F1eF9wb3dlcl93ZWxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCiAJfQogfQogCitzdGF0aWMgdm9pZAoraWNsX3RjX3BoeV9hdXhfcG93ZXJfd2Vs
bF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCSBzdHJ1Y3Qg
aTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQoreworCV9pY2xfdGNfcGh5X2F1eF9wb3dlcl93
ZWxsX2VuYWJsZShkZXZfcHJpdiwgcG93ZXJfd2VsbCwgdHJ1ZSk7Cit9CisKK3N0YXRpYyB2b2lk
CitpY2xfdGNfcGh5X2F1eF9wb3dlcl93ZWxsX2VuYWJsZV93aXRob3V0X2FjayhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkJCSAgICAgc3RydWN0IGk5MTVfcG93ZXJfd2Vs
bCAqcG93ZXJfd2VsbCkKK3sKKwlfaWNsX3RjX3BoeV9hdXhfcG93ZXJfd2VsbF9lbmFibGUoZGV2
X3ByaXYsIHBvd2VyX3dlbGwsIGZhbHNlKTsKK30KKwogc3RhdGljIHZvaWQKIGljbF90Y19waHlf
YXV4X3Bvd2VyX3dlbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
CiAJCQkJICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQpAQCAtNjQyLDYgKzY1
NywxMyBAQCBzdGF0aWMgYm9vbCBoc3dfcG93ZXJfd2VsbF9lbmFibGVkKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKIAlyZXR1cm4gKHZhbCAmIG1hc2spID09IG1hc2s7CiB9CiAK
K3N0YXRpYyB2b2lkCitoc3dfcG93ZXJfd2VsbF93YWl0X2FjayhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCisJCQlzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQor
eworCWhzd193YWl0X2Zvcl9wb3dlcl93ZWxsX2VuYWJsZShkZXZfcHJpdiwgcG93ZXJfd2VsbCk7
Cit9CisKIHN0YXRpYyB2b2lkIGFzc2VydF9jYW5fZW5hYmxlX2RjOShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCiB7CiAJZHJtX1dBUk5fT05DRSgmZGV2X3ByaXYtPmRybSwKQEAg
LTM1ODIsOCArMzYwNCwxMCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJfd2VsbF9v
cHMgaWNsX2NvbWJvX3BoeV9hdXhfcG93ZXJfd2VsbF9vcHMgPSB7CiBzdGF0aWMgY29uc3Qgc3Ry
dWN0IGk5MTVfcG93ZXJfd2VsbF9vcHMgaWNsX3RjX3BoeV9hdXhfcG93ZXJfd2VsbF9vcHMgPSB7
CiAJLnN5bmNfaHcgPSBoc3dfcG93ZXJfd2VsbF9zeW5jX2h3LAogCS5lbmFibGUgPSBpY2xfdGNf
cGh5X2F1eF9wb3dlcl93ZWxsX2VuYWJsZSwKKwkuZW5hYmxlX3dpdGhvdXRfYWNrID0gaWNsX3Rj
X3BoeV9hdXhfcG93ZXJfd2VsbF9lbmFibGVfd2l0aG91dF9hY2ssCiAJLmRpc2FibGUgPSBpY2xf
dGNfcGh5X2F1eF9wb3dlcl93ZWxsX2Rpc2FibGUsCiAJLmlzX2VuYWJsZWQgPSBoc3dfcG93ZXJf
d2VsbF9lbmFibGVkLAorCS53YWl0X2VuYWJsZV9hY2sgPSBoc3dfcG93ZXJfd2VsbF93YWl0X2Fj
aywKIH07CiAKIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsX3JlZ3MgaWNsX2F1
eF9wb3dlcl93ZWxsX3JlZ3MgPSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfZGlzcGxheV90eXBlcy5oCmluZGV4IDE3NmFiNWYxZTg2Ny4uNDI5NTRiZTgwNDM1
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlf
dHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlf
dHlwZXMuaApAQCAtMTM5Nyw2ICsxMzk3LDcgQEAgc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCB7
CiAJZW51bSB0Y19wb3J0X21vZGUgdGNfbW9kZTsKIAllbnVtIHBoeV9maWEgdGNfcGh5X2ZpYTsK
IAl1OCB0Y19waHlfZmlhX2lkeDsKKwlpbnRlbF93YWtlcmVmX3QgdGNfY29sZF93YWtlcmVmOwog
CiAJdm9pZCAoKndyaXRlX2luZm9mcmFtZSkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
CiAJCQkJY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3RjLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3RjLmMKaW5kZXggZTRjNWRlNWNlODc0Li41ODhmY2E4
NzNiNTUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfdGMu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3RjLmMKQEAgLTQxNiw5
ICs0MTYsNiBAQCBzdGF0aWMgdm9pZCBpbnRlbF90Y19wb3J0X3Jlc2V0X21vZGUoc3RydWN0IGlu
dGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQsCiAJZW51bSB0Y19wb3J0X21vZGUgb2xkX3RjX21v
ZGUgPSBkaWdfcG9ydC0+dGNfbW9kZTsKIAogCWludGVsX2Rpc3BsYXlfcG93ZXJfZmx1c2hfd29y
ayhpOTE1KTsKLQlkcm1fV0FSTl9PTigmaTkxNS0+ZHJtLAotCQkgICAgaW50ZWxfZGlzcGxheV9w
b3dlcl9pc19lbmFibGVkKGk5MTUsCi0JCQkJCWludGVsX2F1eF9wb3dlcl9kb21haW4oZGlnX3Bv
cnQpKSk7CiAKIAlpY2xfdGNfcGh5X2Rpc2Nvbm5lY3QoZGlnX3BvcnQpOwogCWljbF90Y19waHlf
Y29ubmVjdChkaWdfcG9ydCwgcmVxdWlyZWRfbGFuZXMpOwpAQCAtNTI4LDYgKzUyNSwzOSBAQCBz
dGF0aWMgaW5saW5lIGludCB0Z2xfdGNfY29sZF9yZXF1ZXN0KHN0cnVjdCBpbnRlbF9kaWdpdGFs
X3BvcnQgKmRpZ19wb3J0LAogCXJldHVybiByZXQ7CiB9CiAKK3N0YXRpYyBpbmxpbmUgaW50IGlj
bF90Y19jb2xkX3JlcXVlc3Qoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQsCisJ
CQkJICAgICAgYm9vbCBibG9jaykKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOworCWVudW0gaW50ZWxfZGlzcGxheV9w
b3dlcl9kb21haW4gYXV4X2RvbWFpbjsKKwlpbnQgcmV0OworCisJYXV4X2RvbWFpbiA9IGludGVs
X2F1eF9jaF90b19wb3dlcl9kb21haW4oZGlnX3BvcnQtPmF1eF9jaCk7CisKKwlpZiAoYmxvY2sp
IHsKKwkJZGlnX3BvcnQtPnRjX2NvbGRfd2FrZXJlZiA9CisJCQlpbnRlbF9kaXNwbGF5X3Bvd2Vy
X2dldF93aXRob3V0X2FjayhpOTE1LCBhdXhfZG9tYWluKTsKKworCQlkbyB7CisJCQlyZXQgPSBz
YW5keWJyaWRnZV9wY29kZV93cml0ZV90aW1lb3V0KGk5MTUsCisJCQkJCQkJICAgICAgSUNMX1BD
T0RFX0VYSVRfVENDT0xELAorCQkJCQkJCSAgICAgIDAsIDI1MCwgMSk7CisKKwkJfSB3aGlsZSAo
cmV0ID09IC1FQUdBSU4pOworCisJCWlmICghcmV0KQorCQkJbXNsZWVwKDEpOworCX0gZWxzZSBp
ZiAoZGlnX3BvcnQtPnRjX21vZGUgPT0gVENfUE9SVF9MRUdBQ1kpIHsKKwkJZHJtX1dBUk5fT04o
Jmk5MTUtPmRybSwgIWRpZ19wb3J0LT50Y19jb2xkX3dha2VyZWYpOworCQlpbnRlbF9kaXNwbGF5
X3Bvd2VyX3B1dChpOTE1LCBhdXhfZG9tYWluLAorCQkJCQlkaWdfcG9ydC0+dGNfY29sZF93YWtl
cmVmKTsKKwkJZGlnX3BvcnQtPnRjX2NvbGRfd2FrZXJlZiA9IDA7CisJCXJldCA9IDA7CisJfQor
CisJcmV0dXJuIHJldDsKK30KKwogc3RhdGljIGludCB0Y19jb2xkX3JlcXVlc3Qoc3RydWN0IGlu
dGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQsIGJvb2wgYmxvY2spCiB7CiAJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsKQEAg
LTUzNiw4ICs1NjYsNyBAQCBzdGF0aWMgaW50IHRjX2NvbGRfcmVxdWVzdChzdHJ1Y3QgaW50ZWxf
ZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCwgYm9vbCBibG9jaykKIAlpZiAoSU5URUxfR0VOKGk5MTUp
ID49IDEyKQogCQlyZXQgPSB0Z2xfdGNfY29sZF9yZXF1ZXN0KGRpZ19wb3J0LCBibG9jayk7CiAJ
ZWxzZQotCQkvKiBUT0RPOiBpbXBsZW1lbnQgR0VOMTEgVENDT0xEIHNlcXVlbmNlcyAqLwotCQly
ZXQgPSAwOworCQlyZXQgPSBpY2xfdGNfY29sZF9yZXF1ZXN0KGRpZ19wb3J0LCBibG9jayk7CiAK
IAlkcm1fZGJnX2ttcygmaTkxNS0+ZHJtLCAiUG9ydCAlczogVENDT0xEICVzYmxvY2sgJXNcbiIs
CiAJCSAgICBkaWdfcG9ydC0+dGNfcG9ydF9uYW1lLCAoYmxvY2sgPyAiIiA6ICJ1biIpLApAQCAt
NTQ2LDYgKzU3NSwyNiBAQCBzdGF0aWMgaW50IHRjX2NvbGRfcmVxdWVzdChzdHJ1Y3QgaW50ZWxf
ZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCwgYm9vbCBibG9jaykKIAlyZXR1cm4gcmV0OwogfQogCitz
dGF0aWMgdm9pZCB0Y19jb2xkX2FmdGVyX3Jlc2V0X21vZGUoc3RydWN0IGludGVsX2RpZ2l0YWxf
cG9ydCAqZGlnX3BvcnQpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsKKwllbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJf
ZG9tYWluIGF1eF9kb21haW47CisKKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDEyKQorCQlyZXR1
cm47CisKKwlhdXhfZG9tYWluID0gaW50ZWxfYXV4X2NoX3RvX3Bvd2VyX2RvbWFpbihkaWdfcG9y
dC0+YXV4X2NoKTsKKworCWlmIChkaWdfcG9ydC0+dGNfbW9kZSA9PSBUQ19QT1JUX0xFR0FDWSkg
eworCQlpbnRlbF9kaXNwbGF5X3Bvd2VyX3dhaXRfZW5hYmxlX2FjayhpOTE1LCBhdXhfZG9tYWlu
KTsKKwl9IGVsc2UgeworCQlkcm1fV0FSTl9PTigmaTkxNS0+ZHJtLCAhZGlnX3BvcnQtPnRjX2Nv
bGRfd2FrZXJlZik7CisJCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5MTUsIGF1eF9kb21haW4s
CisJCQkJCWRpZ19wb3J0LT50Y19jb2xkX3dha2VyZWYpOworCQlkaWdfcG9ydC0+dGNfY29sZF93
YWtlcmVmID0gMDsKKwl9Cit9CisKIHN0YXRpYyB2b2lkIF9faW50ZWxfdGNfcG9ydF9sb2NrKHN0
cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0LAogCQkJCSBpbnQgcmVxdWlyZWRfbGFu
ZXMpCiB7CkBAIC01NjAsNiArNjA5LDcgQEAgc3RhdGljIHZvaWQgX19pbnRlbF90Y19wb3J0X2xv
Y2soc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQsCiAJCXRjX2NvbGRfcmVxdWVz
dChkaWdfcG9ydCwgdHJ1ZSk7CiAJCWludGVsX3RjX3BvcnRfbmVlZHNfcmVzZXQoZGlnX3BvcnQp
OwogCQlpbnRlbF90Y19wb3J0X3Jlc2V0X21vZGUoZGlnX3BvcnQsIHJlcXVpcmVkX2xhbmVzKTsK
KwkJdGNfY29sZF9hZnRlcl9yZXNldF9tb2RlKGRpZ19wb3J0KTsKIAl9CiAKIAlkcm1fV0FSTl9P
TigmaTkxNS0+ZHJtLCBkaWdfcG9ydC0+dGNfbG9ja193YWtlcmVmKTsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVnLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3JlZy5oCmluZGV4IDdlMzQxZDk5NDViMy4uOGQ0ZjQwYTcwYTRkIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlZy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfcmVnLmgKQEAgLTkwMTcsNiArOTAxNyw3IEBAIGVudW0gewogI2RlZmluZSAgICAgSUNMX1BD
T0RFX01FTV9TU19SRUFEX1FHVl9QT0lOVF9JTkZPKHBvaW50KQkoKChwb2ludCkgPDwgMTYpIHwg
KDB4MSA8PCA4KSkKICNkZWZpbmUgICBHRU42X1BDT0RFX1JFQURfRF9DT01QCQkweDEwCiAjZGVm
aW5lICAgR0VONl9QQ09ERV9XUklURV9EX0NPTVAJCTB4MTEKKyNkZWZpbmUgICBJQ0xfUENPREVf
RVhJVF9UQ0NPTEQJCQkweDEyCiAjZGVmaW5lICAgSFNXX1BDT0RFX0RFX1dSSVRFX0ZSRVFfUkVR
CQkweDE3CiAjZGVmaW5lICAgRElTUExBWV9JUFNfQ09OVFJPTAkJCTB4MTkKICNkZWZpbmUgICBU
R0xfUENPREVfVENDT0xECQkJCTB4MjYKLS0gCjIuMjYuMAoKX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1n
ZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21h
aWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4Cg==

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id CEFD948B8C
	for <lists+intel-gfx@lfdr.de>; Mon, 17 Jun 2019 20:12:52 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9337E892C9;
	Mon, 17 Jun 2019 18:12:50 +0000 (UTC)
X-Original-To: Intel-gfx@lists.freedesktop.org
Delivered-To: Intel-gfx@lists.freedesktop.org
Received: from mga03.intel.com (mga03.intel.com [134.134.136.65])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1E9C08893B
 for <Intel-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 18:12:47 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga007.fm.intel.com ([10.253.24.52])
 by orsmga103.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 17 Jun 2019 11:12:46 -0700
X-ExtLoop1: 1
Received: from yyosef-mobl.ger.corp.intel.com (HELO localhost.localdomain)
 ([10.252.23.42])
 by fmsmga007.fm.intel.com with ESMTP; 17 Jun 2019 11:12:45 -0700
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
To: Intel-gfx@lists.freedesktop.org
Date: Mon, 17 Jun 2019 19:12:04 +0100
Message-Id: <20190617181236.7981-2-tvrtko.ursulin@linux.intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190617181236.7981-1-tvrtko.ursulin@linux.intel.com>
References: <20190617181236.7981-1-tvrtko.ursulin@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [RFC 01/33] drm/i915: Convert intel_vgt_(de)balloon to
 uncore
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KCk1vcmUgcmVt
b3ZhbCBvZiBpbXBsaWNpdCBkZXZfcHJpdiBmcm9tIHVzaW5nIG9sZCBtbWlvIGFjY2Vzc29ycy4K
CkZ1cnRoZXJtb3JlIHRoZXNlIGNhbGxzIHJlYWxseSBvcGVyYXRlIG9uIGdndHQgc28gaXQgbG9n
aWNhbGx5IG1ha2VzIHNlbnNlCmlmIHRoZXkgdGFrZSBpdCBhcyBwYXJhbWV0ZXIuCgpTaWduZWQt
b2ZmLWJ5OiBUdnJ0a28gVXJzdWxpbiA8dHZydGtvLnVyc3VsaW5AaW50ZWwuY29tPgpSZXZpZXdl
ZC1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Ci0tLQogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMgfCAgNCArKy0tCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3ZncHUuYyAgICB8IDI0ICsrKysrKysrKysrKysrLS0tLS0tLS0tLQogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV92Z3B1LmggICAgfCAgNCArKy0tCiAzIGZpbGVzIGNoYW5nZWQs
IDE4IGluc2VydGlvbnMoKyksIDE0IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9n
ZW1fZ3R0LmMKaW5kZXggMjc4ZGUwNGE5NmFhLi43YzVkM2E5ZjE4ZjcgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZ2VtX2d0dC5jCkBAIC0yODU5LDcgKzI4NTksNyBAQCBpbnQgaTkxNV9nZW1faW5p
dF9nZ3R0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlnZ3R0LT5waW5fYmlh
cyA9IG1heF90KHUzMiwgSTkxNV9HVFRfUEFHRV9TSVpFLAogCQkJICAgICAgIGludGVsX3dvcGNt
X2d1Y19zaXplKCZkZXZfcHJpdi0+d29wY20pKTsKIAotCXJldCA9IGludGVsX3ZndF9iYWxsb29u
KGRldl9wcml2KTsKKwlyZXQgPSBpbnRlbF92Z3RfYmFsbG9vbihnZ3R0KTsKIAlpZiAocmV0KQog
CQlyZXR1cm4gcmV0OwogCkBAIC0yOTMwLDcgKzI5MzAsNyBAQCB2b2lkIGk5MTVfZ2d0dF9jbGVh
bnVwX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlnZ3R0X3JlbGVhc2Vf
Z3VjX3RvcChnZ3R0KTsKIAogCWlmIChkcm1fbW1faW5pdGlhbGl6ZWQoJmdndHQtPnZtLm1tKSkg
ewotCQlpbnRlbF92Z3RfZGViYWxsb29uKGRldl9wcml2KTsKKwkJaW50ZWxfdmd0X2RlYmFsbG9v
bihnZ3R0KTsKIAkJaTkxNV9hZGRyZXNzX3NwYWNlX2ZpbmkoJmdndHQtPnZtKTsKIAl9CiAKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdmdwdS5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV92Z3B1LmMKaW5kZXggOTRkMzk5MmI1OTlkLi40MWVkOWEzZjUyYjQgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdmdwdS5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfdmdwdS5jCkBAIC0xMTcsMTcgKzExNywxNyBAQCBzdGF0aWMgdm9p
ZCB2Z3RfZGViYWxsb29uX3NwYWNlKHN0cnVjdCBpOTE1X2dndHQgKmdndHQsCiAgKiBUaGlzIGZ1
bmN0aW9uIGlzIGNhbGxlZCB0byBkZWFsbG9jYXRlIHRoZSBiYWxsb29uZWQtb3V0IGdyYXBoaWMg
bWVtb3J5LCB3aGVuCiAgKiBkcml2ZXIgaXMgdW5sb2FkZWQgb3Igd2hlbiBiYWxsb29uaW5nIGZh
aWxzLgogICovCi12b2lkIGludGVsX3ZndF9kZWJhbGxvb24oc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQordm9pZCBpbnRlbF92Z3RfZGViYWxsb29uKHN0cnVjdCBpOTE1X2dndHQg
KmdndHQpCiB7CiAJaW50IGk7CiAKLQlpZiAoIWludGVsX3ZncHVfYWN0aXZlKGRldl9wcml2KSkK
KwlpZiAoIWludGVsX3ZncHVfYWN0aXZlKGdndHQtPnZtLmk5MTUpKQogCQlyZXR1cm47CiAKIAlE
Uk1fREVCVUcoIlZHVCBkZWJhbGxvb24uXG4iKTsKIAogCWZvciAoaSA9IDA7IGkgPCA0OyBpKysp
Ci0JCXZndF9kZWJhbGxvb25fc3BhY2UoJmRldl9wcml2LT5nZ3R0LCAmYmxfaW5mby5zcGFjZVtp
XSk7CisJCXZndF9kZWJhbGxvb25fc3BhY2UoZ2d0dCwgJmJsX2luZm8uc3BhY2VbaV0pOwogfQog
CiBzdGF0aWMgaW50IHZndF9iYWxsb29uX3NwYWNlKHN0cnVjdCBpOTE1X2dndHQgKmdndHQsCkBA
IC0xOTUsMjIgKzE5NSwyNiBAQCBzdGF0aWMgaW50IHZndF9iYWxsb29uX3NwYWNlKHN0cnVjdCBp
OTE1X2dndHQgKmdndHQsCiAgKiBSZXR1cm5zOgogICogemVybyBvbiBzdWNjZXNzLCBub24temVy
byBpZiBjb25maWd1cmF0aW9uIGludmFsaWQgb3IgYmFsbG9vbmluZyBmYWlsZWQKICAqLwotaW50
IGludGVsX3ZndF9iYWxsb29uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKK2lu
dCBpbnRlbF92Z3RfYmFsbG9vbihzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0KQogewotCXN0cnVjdCBp
OTE1X2dndHQgKmdndHQgPSAmZGV2X3ByaXYtPmdndHQ7CisJc3RydWN0IGludGVsX3VuY29yZSAq
dW5jb3JlID0gJmdndHQtPnZtLmk5MTUtPnVuY29yZTsKIAl1bnNpZ25lZCBsb25nIGdndHRfZW5k
ID0gZ2d0dC0+dm0udG90YWw7CiAKIAl1bnNpZ25lZCBsb25nIG1hcHBhYmxlX2Jhc2UsIG1hcHBh
YmxlX3NpemUsIG1hcHBhYmxlX2VuZDsKIAl1bnNpZ25lZCBsb25nIHVubWFwcGFibGVfYmFzZSwg
dW5tYXBwYWJsZV9zaXplLCB1bm1hcHBhYmxlX2VuZDsKIAlpbnQgcmV0OwogCi0JaWYgKCFpbnRl
bF92Z3B1X2FjdGl2ZShkZXZfcHJpdikpCisJaWYgKCFpbnRlbF92Z3B1X2FjdGl2ZShnZ3R0LT52
bS5pOTE1KSkKIAkJcmV0dXJuIDA7CiAKLQltYXBwYWJsZV9iYXNlID0gSTkxNV9SRUFEKHZndGlm
X3JlZyhhdmFpbF9ycy5tYXBwYWJsZV9nbWFkci5iYXNlKSk7Ci0JbWFwcGFibGVfc2l6ZSA9IEk5
MTVfUkVBRCh2Z3RpZl9yZWcoYXZhaWxfcnMubWFwcGFibGVfZ21hZHIuc2l6ZSkpOwotCXVubWFw
cGFibGVfYmFzZSA9IEk5MTVfUkVBRCh2Z3RpZl9yZWcoYXZhaWxfcnMubm9ubWFwcGFibGVfZ21h
ZHIuYmFzZSkpOwotCXVubWFwcGFibGVfc2l6ZSA9IEk5MTVfUkVBRCh2Z3RpZl9yZWcoYXZhaWxf
cnMubm9ubWFwcGFibGVfZ21hZHIuc2l6ZSkpOworCW1hcHBhYmxlX2Jhc2UgPQorCSAgaW50ZWxf
dW5jb3JlX3JlYWQodW5jb3JlLCB2Z3RpZl9yZWcoYXZhaWxfcnMubWFwcGFibGVfZ21hZHIuYmFz
ZSkpOworCW1hcHBhYmxlX3NpemUgPQorCSAgaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCB2Z3Rp
Zl9yZWcoYXZhaWxfcnMubWFwcGFibGVfZ21hZHIuc2l6ZSkpOworCXVubWFwcGFibGVfYmFzZSA9
CisJICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIHZndGlmX3JlZyhhdmFpbF9ycy5ub25tYXBw
YWJsZV9nbWFkci5iYXNlKSk7CisJdW5tYXBwYWJsZV9zaXplID0KKwkgIGludGVsX3VuY29yZV9y
ZWFkKHVuY29yZSwgdmd0aWZfcmVnKGF2YWlsX3JzLm5vbm1hcHBhYmxlX2dtYWRyLnNpemUpKTsK
IAogCW1hcHBhYmxlX2VuZCA9IG1hcHBhYmxlX2Jhc2UgKyBtYXBwYWJsZV9zaXplOwogCXVubWFw
cGFibGVfZW5kID0gdW5tYXBwYWJsZV9iYXNlICsgdW5tYXBwYWJsZV9zaXplOwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92Z3B1LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3ZncHUuaAppbmRleCBlYmUxYjdiY2VkOTguLmU5MThmNDE4NTAzZiAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92Z3B1LmgKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV92Z3B1LmgKQEAgLTQyLDcgKzQyLDcgQEAgaW50ZWxfdmdwdV9oYXNfaHVnZV9n
dHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCXJldHVybiBkZXZfcHJpdi0+
dmdwdS5jYXBzICYgVkdUX0NBUFNfSFVHRV9HVFQ7CiB9CiAKLWludCBpbnRlbF92Z3RfYmFsbG9v
bihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwotdm9pZCBpbnRlbF92Z3RfZGVi
YWxsb29uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CitpbnQgaW50ZWxfdmd0
X2JhbGxvb24oc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCk7Cit2b2lkIGludGVsX3ZndF9kZWJhbGxv
b24oc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCk7CiAKICNlbmRpZiAvKiBfSTkxNV9WR1BVX0hfICov
Ci0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9y
ZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdm
eA==

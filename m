Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8329011BC20
	for <lists+intel-gfx@lfdr.de>; Wed, 11 Dec 2019 19:45:44 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CD7CB6EBB4;
	Wed, 11 Dec 2019 18:45:42 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga09.intel.com (mga09.intel.com [134.134.136.24])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 599836EBB3
 for <intel-gfx@lists.freedesktop.org>; Wed, 11 Dec 2019 18:45:30 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga003.jf.intel.com ([10.7.209.27])
 by orsmga102.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 11 Dec 2019 10:45:29 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.69,302,1571727600"; d="scan'208";a="216016745"
Received: from josouza-mobl.jf.intel.com (HELO josouza-MOBL.intel.com)
 ([10.24.8.163])
 by orsmga003.jf.intel.com with ESMTP; 11 Dec 2019 10:45:28 -0800
From: =?UTF-8?q?Jos=C3=A9=20Roberto=20de=20Souza?= <jose.souza@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 11 Dec 2019 10:45:23 -0800
Message-Id: <20191211184526.142413-8-jose.souza@intel.com>
X-Mailer: git-send-email 2.24.1
In-Reply-To: <20191211184526.142413-1-jose.souza@intel.com>
References: <20191211184526.142413-1-jose.souza@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v2 rebased 08/11] drm/i915/display: Always
 enables MST master pipe first
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RHVlIHRvIEREQiBvdmVybGFwcyB0aGUgcGlwZSBlbmFibGluZyBzZXF1ZW5jZSBpcyBub3QgYWx3
YXlzIGNyZXNjZW50LgpBcyB0aGUgcHJldmlvdXMgcGF0Y2ggc2VsZWN0cyB0aGUgc21hbGxlc3Qg
cGlwZS90cmFuc2NvZGVyIGluIHRoZSBNU1QKc3RyZWFtIHRvIGJlIG1hc3RlciBhbmQgaXQgbmVl
ZHMgdG8gYmUgZW5hYmxlZCBmaXJzdCB0aGlzIGNoYW5nZXMKd2VyZSBuZWVkZWQgdG8gZ3VhcmFu
dGVlIHRoYXQuCgpTbyBmaXJzdCBsZXRzIGVuYWJsZSBhbGwgcGlwZXMgdGhhdCBkaWQgbm90IG5l
ZWRlZCBhIGZ1bGxtb2Rlc2V0IHNvCml0IGRvbid0IGhhdmUgYW55IGV4dGVybmFsIGRlcGVuZGVu
Y3ksIHRoaXMgb25lcyBjYW4gb3ZlcmxhcCB3aXRoCmVhY2ggb3RoZXIgZGRiIGFsbG9jYXRpb25z
LgoKVGhlbiBvbiB0aGUgc2Vjb25kIGxvb3AgaXQgd2lsbCBlbmFibGUgYWxsIHRoZSBwaXBlcyB0
aGF0IG5lZWRzIGEKbW9kZXNldCBhbmQgZG9uJ3QgZGVwZW5kcyBvbiBvdGhlciBwaXBlcyBsaWtl
IE1TVCBtYXN0ZXIKcGlwZS90cmFuc2NvZGVyLgoKVGhlbiBmaW5hbGx5IGFsbCB0aGUgcGlwZXMg
dGhhdCBuZWVkcyBhIG1vZGVzZXQgYW5kIGhhdmUgZGVwZW5kZW5jeQpvbiBvdGhlciBwaXBlcy4K
CkNjOiBWaWxsZSBTeXJqw6Rsw6QgPHZpbGxlLnN5cmphbGFAbGludXguaW50ZWwuY29tPgpDYzog
TWFhcnRlbiBMYW5raG9yc3QgPG1hYXJ0ZW4ubGFua2hvcnN0QGxpbnV4LmludGVsLmNvbT4KQ2M6
IE1hdHQgUm9wZXIgPG1hdHRoZXcuZC5yb3BlckBpbnRlbC5jb20+CkNjOiBNYW5hc2kgTmF2YXJl
IDxtYW5hc2kuZC5uYXZhcmVAaW50ZWwuY29tPgpTaWduZWQtb2ZmLWJ5OiBKb3PDqSBSb2JlcnRv
IGRlIFNvdXphIDxqb3NlLnNvdXphQGludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyB8IDc3ICsrKysrKysrKysrKysrLS0tLS0tCiAxIGZp
bGUgY2hhbmdlZCwgNTYgaW5zZXJ0aW9ucygrKSwgMjEgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwppbmRleCAxY2VjY2UyZjU0Zjgu
LmZhNThiMzk2ZTA4NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kaXNwbGF5LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9k
aXNwbGF5LmMKQEAgLTE0NTY2LDE4ICsxNDU2NiwyNCBAQCBzdGF0aWMgdm9pZCBza2xfY29tbWl0
X21vZGVzZXRfZW5hYmxlcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKIAkvKgog
CSAqIFdoZW5ldmVyIHRoZSBudW1iZXIgb2YgYWN0aXZlIHBpcGVzIGNoYW5nZXMsIHdlIG5lZWQg
dG8gbWFrZSBzdXJlIHdlCiAJICogdXBkYXRlIHRoZSBwaXBlcyBpbiB0aGUgcmlnaHQgb3JkZXIg
c28gdGhhdCB0aGVpciBkZGIgYWxsb2NhdGlvbnMKLQkgKiBuZXZlciBvdmVybGFwIHdpdGggZWFj
aG90aGVyIGluYmV0d2VlbiBDUlRDIHVwZGF0ZXMuIE90aGVyd2lzZSB3ZSdsbAorCSAqIG5ldmVy
IG92ZXJsYXAgd2l0aCBlYWNoIG90aGVyIGJldHdlZW4gQ1JUQyB1cGRhdGVzLiBPdGhlcndpc2Ug
d2UnbGwKIAkgKiBjYXVzZSBwaXBlIHVuZGVycnVucyBhbmQgb3RoZXIgYmFkIHN0dWZmLgorCSAq
CisJICogU28gZmlyc3QgbGV0cyBlbmFibGUgYWxsIHBpcGVzIHRoYXQgZGlkIG5vdCBuZWVkZWQg
YSBmdWxsbW9kZXNldCBzbworCSAqIGl0IGRvbid0IGhhdmUgYW55IGV4dGVybmFsIGRlcGVuZGVu
Y3kKIAkgKi8KIAlkbyB7CiAJCXByb2dyZXNzID0gZmFsc2U7CiAKLQkJZm9yX2VhY2hfb2xkbmV3
X2ludGVsX2NydGNfaW5fc3RhdGUoc3RhdGUsIGNydGMsIG9sZF9jcnRjX3N0YXRlLCBuZXdfY3J0
Y19zdGF0ZSwgaSkgewotCQkJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwotCQkJYm9vbCB2
Ymxfd2FpdCA9IGZhbHNlOwotCQkJYm9vbCBtb2Rlc2V0ID0gbmVlZHNfbW9kZXNldChuZXdfY3J0
Y19zdGF0ZSk7CisJCWZvcl9lYWNoX29sZG5ld19pbnRlbF9jcnRjX2luX3N0YXRlKHN0YXRlLCBj
cnRjLCBvbGRfY3J0Y19zdGF0ZSwKKwkJCQkJCSAgICBuZXdfY3J0Y19zdGF0ZSwgaSkgeworCQkJ
Ym9vbCB2Ymxfd2FpdDsKKworCQkJaWYgKHVwZGF0ZWQgJiBCSVQoY3J0Yy0+cGlwZSkgfHwKKwkJ
CSAgICAhbmV3X2NydGNfc3RhdGUtPmh3LmFjdGl2ZSkKKwkJCQljb250aW51ZTsKIAotCQkJaWYg
KHVwZGF0ZWQgJiBCSVQoY3J0Yy0+cGlwZSkgfHwgIW5ld19jcnRjX3N0YXRlLT5ody5hY3RpdmUp
CisJCQlpZiAobmVlZHNfbW9kZXNldChuZXdfY3J0Y19zdGF0ZSkpCiAJCQkJY29udGludWU7CiAK
IAkJCWlmIChza2xfZGRiX2FsbG9jYXRpb25fb3ZlcmxhcHMoJm5ld19jcnRjX3N0YXRlLT53bS5z
a2wuZGRiLApAQCAtMTQ1ODUsNyArMTQ1OTEsNyBAQCBzdGF0aWMgdm9pZCBza2xfY29tbWl0X21v
ZGVzZXRfZW5hYmxlcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKIAkJCQkJCQlJ
TlRFTF9OVU1fUElQRVMoZGV2X3ByaXYpLCBpKSkKIAkJCQljb250aW51ZTsKIAotCQkJdXBkYXRl
ZCB8PSBCSVQocGlwZSk7CisJCQl1cGRhdGVkIHw9IEJJVChjcnRjLT5waXBlKTsKIAkJCWVudHJp
ZXNbaV0gPSBuZXdfY3J0Y19zdGF0ZS0+d20uc2tsLmRkYjsKIAogCQkJLyoKQEAgLTE0NTk2LDMw
ICsxNDYwMiw1OSBAQCBzdGF0aWMgdm9pZCBza2xfY29tbWl0X21vZGVzZXRfZW5hYmxlcyhzdHJ1
Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKIAkJCSAqLwogCQkJaWYgKCFza2xfZGRiX2Vu
dHJ5X2VxdWFsKCZuZXdfY3J0Y19zdGF0ZS0+d20uc2tsLmRkYiwKIAkJCQkJCSAmb2xkX2NydGNf
c3RhdGUtPndtLnNrbC5kZGIpICYmCi0JCQkgICAgIW1vZGVzZXQgJiYKIAkJCSAgICBzdGF0ZS0+
d21fcmVzdWx0cy5kaXJ0eV9waXBlcyAhPSB1cGRhdGVkKQogCQkJCXZibF93YWl0ID0gdHJ1ZTsK
IAotCQkJaWYgKG1vZGVzZXQgJiYgaXNfdHJhbnNfcG9ydF9zeW5jX21vZGUobmV3X2NydGNfc3Rh
dGUpKSB7Ci0JCQkJaWYgKGlzX3RyYW5zX3BvcnRfc3luY19tYXN0ZXIobmV3X2NydGNfc3RhdGUp
KQotCQkJCQlpbnRlbF91cGRhdGVfdHJhbnNfcG9ydF9zeW5jX2NydGNzKGNydGMsCi0JCQkJCQkJ
CQkgICBzdGF0ZSwKLQkJCQkJCQkJCSAgIG9sZF9jcnRjX3N0YXRlLAotCQkJCQkJCQkJICAgbmV3
X2NydGNfc3RhdGUpOwotCQkJCWVsc2UKLQkJCQkJY29udGludWU7Ci0JCQl9IGVsc2UgewotCQkJ
CWludGVsX3VwZGF0ZV9jcnRjKGNydGMsIHN0YXRlLCBvbGRfY3J0Y19zdGF0ZSwKLQkJCQkJCSAg
bmV3X2NydGNfc3RhdGUpOwotCQkJfQorCQkJaW50ZWxfdXBkYXRlX2NydGMoY3J0Yywgc3RhdGUs
IG9sZF9jcnRjX3N0YXRlLAorCQkJCQkgIG5ld19jcnRjX3N0YXRlKTsKIAogCQkJaWYgKHZibF93
YWl0KQotCQkJCWludGVsX3dhaXRfZm9yX3ZibGFuayhkZXZfcHJpdiwgcGlwZSk7CisJCQkJaW50
ZWxfd2FpdF9mb3JfdmJsYW5rKGRldl9wcml2LCBjcnRjLT5waXBlKTsKIAogCQkJcHJvZ3Jlc3Mg
PSB0cnVlOwogCQl9CiAJfSB3aGlsZSAocHJvZ3Jlc3MpOwogCisJLyoKKwkgKiBFbmFibGluZyBh
bGwgcGlwZXMgdGhhdCBuZWVkcyBhIG1vZGVzZXQgYW5kIGRvIG5vdCBkZXBlbmRzIG9uIG90aGVy
CisJICogcGlwZXMKKwkgKi8KKwlmb3JfZWFjaF9vbGRuZXdfaW50ZWxfY3J0Y19pbl9zdGF0ZShz
dGF0ZSwgY3J0Yywgb2xkX2NydGNfc3RhdGUsCisJCQkJCSAgICBuZXdfY3J0Y19zdGF0ZSwgaSkg
eworCQlpZiAodXBkYXRlZCAmIEJJVChjcnRjLT5waXBlKSB8fCAhbmV3X2NydGNfc3RhdGUtPmh3
LmFjdGl2ZSkKKwkJCWNvbnRpbnVlOworCisJCWlmIChpbnRlbF9kcF9tc3RfaXNfc2xhdmVfdHJh
bnMobmV3X2NydGNfc3RhdGUpIHx8CisJCSAgICBpc190cmFuc19wb3J0X3N5bmNfc2xhdmUobmV3
X2NydGNfc3RhdGUpKQorCQkJY29udGludWU7CisKKwkJdXBkYXRlZCB8PSBCSVQoY3J0Yy0+cGlw
ZSk7CisKKwkJaWYgKGlzX3RyYW5zX3BvcnRfc3luY19tb2RlKG5ld19jcnRjX3N0YXRlKSkKKwkJ
CWludGVsX3VwZGF0ZV90cmFuc19wb3J0X3N5bmNfY3J0Y3MoY3J0Yywgc3RhdGUsCisJCQkJCQkJ
ICAgb2xkX2NydGNfc3RhdGUsCisJCQkJCQkJICAgbmV3X2NydGNfc3RhdGUpOworCQllbHNlCisJ
CQlpbnRlbF91cGRhdGVfY3J0YyhjcnRjLCBzdGF0ZSwgb2xkX2NydGNfc3RhdGUsCisJCQkJCSAg
bmV3X2NydGNfc3RhdGUpOworCX0KKworCS8qCisJICogRmluYWxseSBlbmFibGUgYWxsIHBpcGVz
IHRoYXQgbmVlZHMgYSBtb2Rlc2V0IGFuZCBkZXBlbmRzIG9uCisJICogb3RoZXIgcGlwZXMsIHJp
Z2h0IG5vdyBpdCBpcyBvbmx5IE1TVCBzbGF2ZXMgYXMgYm90aCBwb3J0IHN5bmMgc2xhdmUKKwkg
KiBhbmQgbWFzdGVyIGFyZSBlbmFibGVkIHRvZ2V0aGVyCisJICovCisJZm9yX2VhY2hfb2xkbmV3
X2ludGVsX2NydGNfaW5fc3RhdGUoc3RhdGUsIGNydGMsIG9sZF9jcnRjX3N0YXRlLAorCQkJCQkg
ICAgbmV3X2NydGNfc3RhdGUsIGkpIHsKKwkJaWYgKHVwZGF0ZWQgJiBCSVQoY3J0Yy0+cGlwZSkg
fHwgIW5ld19jcnRjX3N0YXRlLT5ody5hY3RpdmUpCisJCQljb250aW51ZTsKKworCQlpZiAoaXNf
dHJhbnNfcG9ydF9zeW5jX3NsYXZlKG5ld19jcnRjX3N0YXRlKSkKKwkJCWNvbnRpbnVlOworCisJ
CWludGVsX3VwZGF0ZV9jcnRjKGNydGMsIHN0YXRlLCBvbGRfY3J0Y19zdGF0ZSwgbmV3X2NydGNf
c3RhdGUpOworCX0KKwogCS8qIElmIDJuZCBEQnVmIHNsaWNlIGlzIG5vIG1vcmUgcmVxdWlyZWQg
ZGlzYWJsZSBpdCAqLwogCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExICYmIHJlcXVpcmVk
X3NsaWNlcyA8IGh3X2VuYWJsZWRfc2xpY2VzKQogCQlpY2xfZGJ1Zl9zbGljZXNfdXBkYXRlKGRl
dl9wcml2LCByZXF1aXJlZF9zbGljZXMpOwotLSAKMi4yNC4xCgpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVs
LWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcv
bWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZngK

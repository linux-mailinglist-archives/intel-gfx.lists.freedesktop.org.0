Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id D262DA14D9
	for <lists+intel-gfx@lfdr.de>; Thu, 29 Aug 2019 11:26:08 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 06BEE6E061;
	Thu, 29 Aug 2019 09:26:04 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga17.intel.com (mga17.intel.com [192.55.52.151])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 136716E049
 for <intel-gfx@lists.freedesktop.org>; Thu, 29 Aug 2019 09:26:03 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga008.jf.intel.com ([10.7.209.65])
 by fmsmga107.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 29 Aug 2019 02:26:02 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,442,1559545200"; d="scan'208";a="175211175"
Received: from tbthomps-mobl.amr.corp.intel.com (HELO
 ldmartin-desk1.intel.com) ([10.254.111.220])
 by orsmga008.jf.intel.com with ESMTP; 29 Aug 2019 02:26:02 -0700
From: Lucas De Marchi <lucas.demarchi@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 29 Aug 2019 02:25:48 -0700
Message-Id: <20190829092554.32198-2-lucas.demarchi@intel.com>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190829092554.32198-1-lucas.demarchi@intel.com>
References: <20190829092554.32198-1-lucas.demarchi@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v3 1/7] drm/i915/psr: Only handle interruptions
 of the transcoder in use
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Dhinakaran Pandiyan <dhinakaran.pandiyan@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogSm9zw6kgUm9iZXJ0byBkZSBTb3V6YSA8am9zZS5zb3V6YUBpbnRlbC5jb20+CgpJdCB3
YXMgZW5hYmxpbmcgYW5kIGNoZWNraW5nIFBTUiBpbnRlcnJ1cHRpb25zIGluIGV2ZXJ5IHRyYW5z
Y29kZXIKd2hpbGUgaXQgc2hvdWxkIGtlZXAgdGhlIGludGVycnVwdGlvbnMgb24gdGhlIG5vbi11
c2VkIHRyYW5zY29kZXJzCm1hc2tlZC4KCldoaWxlIGRvaW5nIHRoaXMgaXQgZ2l2ZXMgdXMgdHJv
dWJsZSBvbiBUaWdlciBMYWtlIGlmIHdlIGFyZQpyZWFkaW5nL3dyaXRpbmcgdG8gcmVnaXN0ZXJz
IG9mIGRpc2FibGVkIHRyYW5zY29kZXJzIHNpbmNlIGZyb20gZ2VuMTIKb253YXJkcyB0aGUgcmVn
aXN0ZXJzIGFyZSByZWxhdGl2ZSB0byB0aGUgdHJhbnNjb2Rlci4gSW5zdGVhZCBvZiBmb3JjaW5n
CnRoZW0gT04gdG8gYWNjZXNzIHRob3NlIHJlZ2lzdGVycywganVzdCBhdm9pZCB0aGUgYWNjZXNz
ZXMgYXMgdGhleSBhcmUKbm90IG5lZWRlZC4KCnYyIChMdWNhcyk6CiAgLSBFeHBsYWluIHdoeSB3
ZSBjYW4ndCBrZWVwIGFjY2Vzc2luZyBhbGwgdHJhbnNjb2RlcnMKICAtIFJlbW92ZSBUT0RPIGFi
b3V0IGV4dGVuZGluZyB0aGUgaXJxIGhhbmRsaW5nIHRvIG11bHRpcGxlIGluc3RhbmNlczoKICAg
IHdoZW4vaWYgaW1wbGVtZW50aW5nIG11bHRpcGxlIGluc3RhbmNlcyBpdCdzIHByZXR0eSBjbGVh
ciBieSB0aGUKICAgIHNpbmdsZXRvbiBwc3IgdGhhdCBpdCBuZWVkcyB0byBiZSBleHRlbmRlZAog
IC0gRml4IGludGVsX3Bzcl9kZWJ1Z19zZXQoKSBjYWxsaW5nIHBzcl9pcnFfY29udHJvbCgpIHdp
dGgKICAgIHBzci50cmFuc2NvZGVyIG5vdCBzZXQgeWV0IChmcm9tIEltcmUpLiBOb3cgd2Ugb25s
eSBzZXQgdGhlIGRlYnVnCiAgICByZWdpc3RlciByaWdodCBhd2F5IGlmIHBzciBpcyBhbHJlYWR5
IGVuYWJsZWQuIE90aGVyd2lzZSB3ZSBqdXN0CiAgICByZWNvcmQgdGhlIHZhbHVlIHRvIGJlIHNl
dCB3aGVuIGVuYWJsaW5nIHRoZSBzb3VyY2UuCiAgLSBEbyBub3QgZGVwZW5kIG9uIHRoZSB2YWx1
ZSBvZiBUUkFOU0NPREVSX0EuIEp1c3QgYmUgcmVsYXRpdmUgdG8gaXQKICAgIChmcm9tIEltcmUp
CiAgLSBoYW5kbGUgcHNyIGVycm9yIGxhc3Qgc28gd2UgZG9uJ3Qgc2NoZWR1bGUgdGhlIHdvcmsg
YmVmb3JlIGhhbmRsaW5nCiAgICB0aGUgb3RoZXIgZmxhZ3MKCkNjOiBJbXJlIERlYWsgPGltcmUu
ZGVha0BpbnRlbC5jb20+CkNjOiBEaGluYWthcmFuIFBhbmRpeWFuIDxkaGluYWthcmFuLnBhbmRp
eWFuQGludGVsLmNvbT4KU2lnbmVkLW9mZi1ieTogSm9zw6kgUm9iZXJ0byBkZSBTb3V6YSA8am9z
ZS5zb3V6YUBpbnRlbC5jb20+ClNpZ25lZC1vZmYtYnk6IEx1Y2FzIERlIE1hcmNoaSA8bHVjYXMu
ZGVtYXJjaGlAaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfcHNyLmMgfCAxMzcgKysrKysrKysrLS0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfcmVnLmggICAgICAgICAgfCAgMTMgKy0tCiAyIGZpbGVzIGNoYW5nZWQsIDU3IGlu
c2VydGlvbnMoKyksIDkzIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfcHNyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX3Bzci5jCmluZGV4IDYyOWI4Yjk4YTk3Zi4uNmYyYmY1MGI2ZDgwIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Bzci5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcHNyLmMKQEAgLTg4LDQ4ICs4OCwxOSBAQCBzdGF0
aWMgYm9vbCBpbnRlbF9wc3IyX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAogCX0KIH0KIAotc3RhdGljIGludCBlZHBfcHNyX3NoaWZ0KGVudW0gdHJhbnNjb2RlciBj
cHVfdHJhbnNjb2RlcikKK3N0YXRpYyB2b2lkIHBzcl9pcnFfY29udHJvbChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7Ci0Jc3dpdGNoIChjcHVfdHJhbnNjb2RlcikgewotCWNh
c2UgVFJBTlNDT0RFUl9BOgotCQlyZXR1cm4gRURQX1BTUl9UUkFOU0NPREVSX0FfU0hJRlQ7Ci0J
Y2FzZSBUUkFOU0NPREVSX0I6Ci0JCXJldHVybiBFRFBfUFNSX1RSQU5TQ09ERVJfQl9TSElGVDsK
LQljYXNlIFRSQU5TQ09ERVJfQzoKLQkJcmV0dXJuIEVEUF9QU1JfVFJBTlNDT0RFUl9DX1NISUZU
OwotCWRlZmF1bHQ6Ci0JCU1JU1NJTkdfQ0FTRShjcHVfdHJhbnNjb2Rlcik7Ci0JCS8qIGZhbGx0
aHJvdWdoICovCi0JY2FzZSBUUkFOU0NPREVSX0VEUDoKLQkJcmV0dXJuIEVEUF9QU1JfVFJBTlND
T0RFUl9FRFBfU0hJRlQ7Ci0JfQotfQotCi1zdGF0aWMgdm9pZCBwc3JfaXJxX2NvbnRyb2woc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgZGVidWcpCi17Ci0JdTMyIGRlYnVn
X21hc2ssIG1hc2s7Ci0JZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyOwotCXUzMiB0cmFu
c2NvZGVycyA9IEJJVChUUkFOU0NPREVSX0VEUCk7Ci0KLQlpZiAoSU5URUxfR0VOKGRldl9wcml2
KSA+PSA4KQotCQl0cmFuc2NvZGVycyB8PSBCSVQoVFJBTlNDT0RFUl9BKSB8Ci0JCQkgICAgICAg
QklUKFRSQU5TQ09ERVJfQikgfAotCQkJICAgICAgIEJJVChUUkFOU0NPREVSX0MpOwotCi0JZGVi
dWdfbWFzayA9IDA7Ci0JbWFzayA9IDA7Ci0JZm9yX2VhY2hfY3B1X3RyYW5zY29kZXJfbWFza2Vk
KGRldl9wcml2LCBjcHVfdHJhbnNjb2RlciwgdHJhbnNjb2RlcnMpIHsKLQkJaW50IHNoaWZ0ID0g
ZWRwX3Bzcl9zaGlmdChjcHVfdHJhbnNjb2Rlcik7Ci0KLQkJbWFzayB8PSBFRFBfUFNSX0VSUk9S
KHNoaWZ0KTsKLQkJZGVidWdfbWFzayB8PSBFRFBfUFNSX1BPU1RfRVhJVChzaGlmdCkgfAotCQkJ
ICAgICAgRURQX1BTUl9QUkVfRU5UUlkoc2hpZnQpOwotCX0KKwllbnVtIHRyYW5zY29kZXIgdHJh
bnMgPSBkZXZfcHJpdi0+cHNyLnRyYW5zY29kZXI7CisJdTMyIHZhbCwgbWFzazsKIAotCWlmIChk
ZWJ1ZyAmIEk5MTVfUFNSX0RFQlVHX0lSUSkKLQkJbWFzayB8PSBkZWJ1Z19tYXNrOworCW1hc2sg
PSBFRFBfUFNSX0VSUk9SKHRyYW5zKTsKKwlpZiAoZGV2X3ByaXYtPnBzci5kZWJ1ZyAmIEk5MTVf
UFNSX0RFQlVHX0lSUSkKKwkJbWFzayB8PSBFRFBfUFNSX1BPU1RfRVhJVCh0cmFucykgfCBFRFBf
UFNSX1BSRV9FTlRSWSh0cmFucyk7CiAKLQlJOTE1X1dSSVRFKEVEUF9QU1JfSU1SLCB+bWFzayk7
CisJdmFsID0gSTkxNV9SRUFEKEVEUF9QU1JfSU1SKTsKKwl2YWwgJj0gfkVEUF9QU1JfVFJBTlNf
TUFTSyh0cmFucyk7CisJdmFsIHw9IH5tYXNrOworCUk5MTVfV1JJVEUoRURQX1BTUl9JTVIsIHZh
bCk7CiB9CiAKIHN0YXRpYyB2b2lkIHBzcl9ldmVudF9wcmludCh1MzIgdmFsLCBib29sIHBzcjJf
ZW5hYmxlZCkKQEAgLTE3MSw2MCArMTQyLDQ4IEBAIHN0YXRpYyB2b2lkIHBzcl9ldmVudF9wcmlu
dCh1MzIgdmFsLCBib29sIHBzcjJfZW5hYmxlZCkKIAogdm9pZCBpbnRlbF9wc3JfaXJxX2hhbmRs
ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgcHNyX2lpcikKIHsKLQl1
MzIgdHJhbnNjb2RlcnMgPSBCSVQoVFJBTlNDT0RFUl9FRFApOwotCWVudW0gdHJhbnNjb2RlciBj
cHVfdHJhbnNjb2RlcjsKKwllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBkZXZfcHJp
di0+cHNyLnRyYW5zY29kZXI7CiAJa3RpbWVfdCB0aW1lX25zID0gIGt0aW1lX2dldCgpOwotCXUz
MiBtYXNrID0gMDsKLQotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDgpCi0JCXRyYW5zY29k
ZXJzIHw9IEJJVChUUkFOU0NPREVSX0EpIHwKLQkJCSAgICAgICBCSVQoVFJBTlNDT0RFUl9CKSB8
Ci0JCQkgICAgICAgQklUKFRSQU5TQ09ERVJfQyk7CiAKLQlmb3JfZWFjaF9jcHVfdHJhbnNjb2Rl
cl9tYXNrZWQoZGV2X3ByaXYsIGNwdV90cmFuc2NvZGVyLCB0cmFuc2NvZGVycykgewotCQlpbnQg
c2hpZnQgPSBlZHBfcHNyX3NoaWZ0KGNwdV90cmFuc2NvZGVyKTsKKwlpZiAocHNyX2lpciAmIEVE
UF9QU1JfUFJFX0VOVFJZKGNwdV90cmFuc2NvZGVyKSkgeworCQlkZXZfcHJpdi0+cHNyLmxhc3Rf
ZW50cnlfYXR0ZW1wdCA9IHRpbWVfbnM7CisJCURSTV9ERUJVR19LTVMoIlt0cmFuc2NvZGVyICVz
XSBQU1IgZW50cnkgYXR0ZW1wdCBpbiAyIHZibGFua3NcbiIsCisJCQkgICAgICB0cmFuc2NvZGVy
X25hbWUoY3B1X3RyYW5zY29kZXIpKTsKKwl9CiAKLQkJaWYgKHBzcl9paXIgJiBFRFBfUFNSX0VS
Uk9SKHNoaWZ0KSkgewotCQkJRFJNX1dBUk4oIlt0cmFuc2NvZGVyICVzXSBQU1IgYXV4IGVycm9y
XG4iLAotCQkJCSB0cmFuc2NvZGVyX25hbWUoY3B1X3RyYW5zY29kZXIpKTsKKwlpZiAocHNyX2lp
ciAmIEVEUF9QU1JfUE9TVF9FWElUKGNwdV90cmFuc2NvZGVyKSkgeworCQlkZXZfcHJpdi0+cHNy
Lmxhc3RfZXhpdCA9IHRpbWVfbnM7CisJCURSTV9ERUJVR19LTVMoIlt0cmFuc2NvZGVyICVzXSBQ
U1IgZXhpdCBjb21wbGV0ZWRcbiIsCisJCQkgICAgICB0cmFuc2NvZGVyX25hbWUoY3B1X3RyYW5z
Y29kZXIpKTsKIAotCQkJZGV2X3ByaXYtPnBzci5pcnFfYXV4X2Vycm9yID0gdHJ1ZTsKKwkJaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkgeworCQkJdTMyIHZhbCA9IEk5MTVfUkVBRChQU1Jf
RVZFTlQoY3B1X3RyYW5zY29kZXIpKTsKKwkJCWJvb2wgcHNyMl9lbmFibGVkID0gZGV2X3ByaXYt
PnBzci5wc3IyX2VuYWJsZWQ7CiAKLQkJCS8qCi0JCQkgKiBJZiB0aGlzIGludGVycnVwdGlvbiBp
cyBub3QgbWFza2VkIGl0IHdpbGwga2VlcAotCQkJICogaW50ZXJydXB0aW5nIHNvIGZhc3QgdGhh
dCBpdCBwcmV2ZW50cyB0aGUgc2NoZWR1bGVkCi0JCQkgKiB3b3JrIHRvIHJ1bi4KLQkJCSAqIEFs
c28gYWZ0ZXIgYSBQU1IgZXJyb3IsIHdlIGRvbid0IHdhbnQgdG8gYXJtIFBTUgotCQkJICogYWdh
aW4gc28gd2UgZG9uJ3QgY2FyZSBhYm91dCB1bm1hc2sgdGhlIGludGVycnVwdGlvbgotCQkJICog
b3IgdW5zZXQgaXJxX2F1eF9lcnJvci4KLQkJCSAqLwotCQkJbWFzayB8PSBFRFBfUFNSX0VSUk9S
KHNoaWZ0KTsKLQkJfQotCi0JCWlmIChwc3JfaWlyICYgRURQX1BTUl9QUkVfRU5UUlkoc2hpZnQp
KSB7Ci0JCQlkZXZfcHJpdi0+cHNyLmxhc3RfZW50cnlfYXR0ZW1wdCA9IHRpbWVfbnM7Ci0JCQlE
Uk1fREVCVUdfS01TKCJbdHJhbnNjb2RlciAlc10gUFNSIGVudHJ5IGF0dGVtcHQgaW4gMiB2Ymxh
bmtzXG4iLAotCQkJCSAgICAgIHRyYW5zY29kZXJfbmFtZShjcHVfdHJhbnNjb2RlcikpOworCQkJ
STkxNV9XUklURShQU1JfRVZFTlQoY3B1X3RyYW5zY29kZXIpLCB2YWwpOworCQkJcHNyX2V2ZW50
X3ByaW50KHZhbCwgcHNyMl9lbmFibGVkKTsKIAkJfQorCX0KIAotCQlpZiAocHNyX2lpciAmIEVE
UF9QU1JfUE9TVF9FWElUKHNoaWZ0KSkgewotCQkJZGV2X3ByaXYtPnBzci5sYXN0X2V4aXQgPSB0
aW1lX25zOwotCQkJRFJNX0RFQlVHX0tNUygiW3RyYW5zY29kZXIgJXNdIFBTUiBleGl0IGNvbXBs
ZXRlZFxuIiwKLQkJCQkgICAgICB0cmFuc2NvZGVyX25hbWUoY3B1X3RyYW5zY29kZXIpKTsKKwlp
ZiAocHNyX2lpciAmIEVEUF9QU1JfRVJST1IoY3B1X3RyYW5zY29kZXIpKSB7CisJCXUzMiB2YWw7
CiAKLQkJCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpIHsKLQkJCQl1MzIgdmFsID0gSTkx
NV9SRUFEKFBTUl9FVkVOVChjcHVfdHJhbnNjb2RlcikpOwotCQkJCWJvb2wgcHNyMl9lbmFibGVk
ID0gZGV2X3ByaXYtPnBzci5wc3IyX2VuYWJsZWQ7CisJCURSTV9XQVJOKCJbdHJhbnNjb2RlciAl
c10gUFNSIGF1eCBlcnJvclxuIiwKKwkJCSB0cmFuc2NvZGVyX25hbWUoY3B1X3RyYW5zY29kZXIp
KTsKIAotCQkJCUk5MTVfV1JJVEUoUFNSX0VWRU5UKGNwdV90cmFuc2NvZGVyKSwgdmFsKTsKLQkJ
CQlwc3JfZXZlbnRfcHJpbnQodmFsLCBwc3IyX2VuYWJsZWQpOwotCQkJfQotCQl9Ci0JfQorCQlk
ZXZfcHJpdi0+cHNyLmlycV9hdXhfZXJyb3IgPSB0cnVlOwogCi0JaWYgKG1hc2spIHsKLQkJbWFz
ayB8PSBJOTE1X1JFQUQoRURQX1BTUl9JTVIpOwotCQlJOTE1X1dSSVRFKEVEUF9QU1JfSU1SLCBt
YXNrKTsKKwkJLyoKKwkJICogSWYgdGhpcyBpbnRlcnJ1cHRpb24gaXMgbm90IG1hc2tlZCBpdCB3
aWxsIGtlZXAKKwkJICogaW50ZXJydXB0aW5nIHNvIGZhc3QgdGhhdCBpdCBwcmV2ZW50cyB0aGUg
c2NoZWR1bGVkCisJCSAqIHdvcmsgdG8gcnVuLgorCQkgKiBBbHNvIGFmdGVyIGEgUFNSIGVycm9y
LCB3ZSBkb24ndCB3YW50IHRvIGFybSBQU1IKKwkJICogYWdhaW4gc28gd2UgZG9uJ3QgY2FyZSBh
Ym91dCB1bm1hc2sgdGhlIGludGVycnVwdGlvbgorCQkgKiBvciB1bnNldCBpcnFfYXV4X2Vycm9y
LgorCQkgKi8KKwkJdmFsID0gSTkxNV9SRUFEKEVEUF9QU1JfSU1SKTsKKwkJdmFsIHw9IEVEUF9Q
U1JfRVJST1IoY3B1X3RyYW5zY29kZXIpOworCQlJOTE1X1dSSVRFKEVEUF9QU1JfSU1SLCB2YWwp
OwogCiAJCXNjaGVkdWxlX3dvcmsoJmRldl9wcml2LT5wc3Iud29yayk7CiAJfQpAQCAtNzQ3LDcg
KzcwNiw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3Bzcl9lbmFibGVfc291cmNlKHN0cnVjdCBpbnRl
bF9kcCAqaW50ZWxfZHAsCiAKIAlJOTE1X1dSSVRFKEVEUF9QU1JfREVCVUcoZGV2X3ByaXYtPnBz
ci50cmFuc2NvZGVyKSwgbWFzayk7CiAKLQlwc3JfaXJxX2NvbnRyb2woZGV2X3ByaXYsIGRldl9w
cml2LT5wc3IuZGVidWcpOworCXBzcl9pcnFfY29udHJvbChkZXZfcHJpdik7CiB9CiAKIHN0YXRp
YyB2b2lkIGludGVsX3Bzcl9lbmFibGVfbG9ja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKQEAgLTc3Miw3ICs3MzEsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wc3JfZW5hYmxl
X2xvY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJICogdG8gYXZvaWQg
YW55IHJlbmRlcmluZyBwcm9ibGVtcy4KIAkgKi8KIAl2YWwgPSBJOTE1X1JFQUQoRURQX1BTUl9J
SVIpOwotCXZhbCAmPSBFRFBfUFNSX0VSUk9SKGVkcF9wc3Jfc2hpZnQoZGV2X3ByaXYtPnBzci50
cmFuc2NvZGVyKSk7CisJdmFsICY9IEVEUF9QU1JfRVJST1IoZGV2X3ByaXYtPnBzci50cmFuc2Nv
ZGVyKTsKIAlpZiAodmFsKSB7CiAJCWRldl9wcml2LT5wc3Iuc2lua19ub3RfcmVsaWFibGUgPSB0
cnVlOwogCQlEUk1fREVCVUdfS01TKCJQU1IgaW50ZXJydXB0aW9uIGVycm9yIHNldCwgbm90IGVu
YWJsaW5nIFBTUlxuIik7CkBAIC0xMTIwLDcgKzEwNzksMTMgQEAgaW50IGludGVsX3Bzcl9kZWJ1
Z19zZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1NjQgdmFsKQogCiAJb2xk
X21vZGUgPSBkZXZfcHJpdi0+cHNyLmRlYnVnICYgSTkxNV9QU1JfREVCVUdfTU9ERV9NQVNLOwog
CWRldl9wcml2LT5wc3IuZGVidWcgPSB2YWw7Ci0JcHNyX2lycV9jb250cm9sKGRldl9wcml2LCBk
ZXZfcHJpdi0+cHNyLmRlYnVnKTsKKworCS8qCisJICogRG8gaXQgcmlnaHQgYXdheSBpZiBpdCdz
IGFscmVhZHkgZW5hYmxlZCwgb3RoZXJ3aXNlIGl0IHdpbGwgYmUgZG9uZQorCSAqIHdoZW4gZW5h
YmxpbmcgdGhlIHNvdXJjZS4KKwkgKi8KKwlpZiAoZGV2X3ByaXYtPnBzci5lbmFibGVkKQorCQlw
c3JfaXJxX2NvbnRyb2woZGV2X3ByaXYpOwogCiAJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+cHNy
LmxvY2spOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlZy5oIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZWcuaAppbmRleCAwMmUxZWYxMGM0N2UuLjZlN2Ri
OWM2NTk4MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZWcuaAorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlZy5oCkBAIC00MjI1LDEzICs0MjI1LDEyIEBA
IGVudW0gewogLyogQnNwZWMgY2xhaW1zIHRob3NlIGFyZW4ndCBzaGlmdGVkIGJ1dCBzdGF5IGF0
IDB4NjQ4MDAgKi8KICNkZWZpbmUgRURQX1BTUl9JTVIJCQkJX01NSU8oMHg2NDgzNCkKICNkZWZp
bmUgRURQX1BTUl9JSVIJCQkJX01NSU8oMHg2NDgzOCkKLSNkZWZpbmUgICBFRFBfUFNSX0VSUk9S
KHNoaWZ0KQkJCSgxIDw8ICgoc2hpZnQpICsgMikpCi0jZGVmaW5lICAgRURQX1BTUl9QT1NUX0VY
SVQoc2hpZnQpCQkoMSA8PCAoKHNoaWZ0KSArIDEpKQotI2RlZmluZSAgIEVEUF9QU1JfUFJFX0VO
VFJZKHNoaWZ0KQkJKDEgPDwgKHNoaWZ0KSkKLSNkZWZpbmUgICBFRFBfUFNSX1RSQU5TQ09ERVJf
Q19TSElGVAkJMjQKLSNkZWZpbmUgICBFRFBfUFNSX1RSQU5TQ09ERVJfQl9TSElGVAkJMTYKLSNk
ZWZpbmUgICBFRFBfUFNSX1RSQU5TQ09ERVJfQV9TSElGVAkJOAotI2RlZmluZSAgIEVEUF9QU1Jf
VFJBTlNDT0RFUl9FRFBfU0hJRlQJCTAKKyNkZWZpbmUgICBfRURQX1BTUl9UUkFOU19TSElGVCh0
cmFucykJCSgodHJhbnMpID09IFRSQU5TQ09ERVJfRURQID8gXAorCQkJCQkJIDAgOiAoKHRyYW5z
KSAtIFRSQU5TQ09ERVJfQSArIDEpICogOCkKKyNkZWZpbmUgICBFRFBfUFNSX1RSQU5TX01BU0so
dHJhbnMpCQkoMHg3IDw8IF9FRFBfUFNSX1RSQU5TX1NISUZUKHRyYW5zKSkKKyNkZWZpbmUgICBF
RFBfUFNSX0VSUk9SKHRyYW5zKQkJCSgweDQgPDwgX0VEUF9QU1JfVFJBTlNfU0hJRlQodHJhbnMp
KQorI2RlZmluZSAgIEVEUF9QU1JfUE9TVF9FWElUKHRyYW5zKQkJKDB4MiA8PCBfRURQX1BTUl9U
UkFOU19TSElGVCh0cmFucykpCisjZGVmaW5lICAgRURQX1BTUl9QUkVfRU5UUlkodHJhbnMpCQko
MHgxIDw8IF9FRFBfUFNSX1RSQU5TX1NISUZUKHRyYW5zKSkKIAogI2RlZmluZSBfU1JEX0FVWF9D
VExfQQkJCQkweDYwODEwCiAjZGVmaW5lIF9TUkRfQVVYX0NUTF9FRFAJCQkweDZmODEwCi0tIAoy
LjIzLjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCklu
dGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRw
czovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

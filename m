Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id EE08E6C9A4
	for <lists+intel-gfx@lfdr.de>; Thu, 18 Jul 2019 09:01:12 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 569826E316;
	Thu, 18 Jul 2019 07:01:11 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 71D3D6E319
 for <intel-gfx@lists.freedesktop.org>; Thu, 18 Jul 2019 07:00:42 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17390376-1500050 
 for multiple; Thu, 18 Jul 2019 08:00:27 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 18 Jul 2019 08:00:12 +0100
Message-Id: <20190718070024.21781-8-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20190718070024.21781-1-chris@chris-wilson.co.uk>
References: <20190718070024.21781-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 08/20] drm/i915: Introduce for_each_user_engine()
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Tm93IHRoYXQgd2UgaGF2ZSBhIGNvbXBhY3QgdHJlZSByZXByZXNlbnRhdGlvbiBmb3IgdWFiaSBl
bmdpbmVzLCBtYWtlCnVzZSBvZiBpdCBmb3Igd2Fsa2luZyBhbGwgdXNlciBlbmdpbmVzIGZyb20g
Y2F0Y2hhbGwgdXNlciBpbnRlcmZhY2VzCmxpa2UgZGVidWdmcyBhbmQgY2FwYWJpbGl0aWVzLgoK
U2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Ci0t
LQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMgICAgIHwgIDYgKyst
LS0KIC4uLi9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYyB8ICAyICst
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2NtZF9wYXJzZXIuYyAgICAgICAgfCAgMyArLS0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jICAgICAgICAgICB8IDI2ICsrKysr
KystLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggICAgICAgICAg
ICAgICB8ICA4ICsrKysrKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9xdWVyeS5jICAgICAg
ICAgICAgIHwgIDMgKy0tCiA2IGZpbGVzIGNoYW5nZWQsIDIyIGluc2VydGlvbnMoKyksIDI2IGRl
bGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2Vu
Z2luZV9jcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKaW5k
ZXggMDJiNjU2NWIyNTUwLi4yY2ZlMTBjODJiZDkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2VuZ2luZV9jcy5jCkBAIC02OTUsMTIgKzY5NSwxMSBAQCB2b2lkIGludGVsX2VuZ2lu
ZXNfc2V0X3NjaGVkdWxlcl9jYXBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogI3Vu
ZGVmIE1BUAogCX07CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCWVudW0gaW50
ZWxfZW5naW5lX2lkIGlkOwogCXUzMiBlbmFibGVkLCBkaXNhYmxlZDsKIAogCWVuYWJsZWQgPSAw
OwogCWRpc2FibGVkID0gMDsKLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgeyAv
KiBhbGwgZW5naW5lcyBtdXN0IGFncmVlISAqLworCWZvcl9lYWNoX3VzZXJfZW5naW5lKGVuZ2lu
ZSwgaTkxNSkgeyAvKiBhbGwgZW5naW5lcyBtdXN0IGFncmVlISAqLwogCQlpbnQgaTsKIAogCQlp
ZiAoZW5naW5lLT5zY2hlZHVsZSkKQEAgLTEyMjcsMTEgKzEyMjYsMTAgQEAgYm9vbCBpbnRlbF9l
bmdpbmVfY2FuX3N0b3JlX2R3b3JkKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHVu
c2lnbmVkIGludCBpbnRlbF9lbmdpbmVzX2hhc19jb250ZXh0X2lzb2xhdGlvbihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKIHsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7
Ci0JZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CiAJdW5zaWduZWQgaW50IHdoaWNoOwogCiAJd2hp
Y2ggPSAwOwotCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKQorCWZvcl9lYWNoX3Vz
ZXJfZW5naW5lKGVuZ2luZSwgaTkxNSkKIAkJaWYgKGVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSkKIAkJ
CXdoaWNoIHw9IEJJVChlbmdpbmUtPnVhYmlfY2xhc3MpOwogCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfc3VibWlzc2lvbi5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYwppbmRleCBhMGYyYTAxMzY1YmMu
LmM5OWNkYmNjZTY0ZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50
ZWxfZ3VjX3N1Ym1pc3Npb24uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRl
bF9ndWNfc3VibWlzc2lvbi5jCkBAIC00ODgsNyArNDg4LDcgQEAgc3RhdGljIHZvaWQgZ3VjX2Fk
ZF9yZXF1ZXN0KHN0cnVjdCBpbnRlbF9ndWMgKmd1Yywgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEp
CiAJCQkgICByaW5nX3RhaWwsIHJxLT5mZW5jZS5zZXFubyk7CiAJZ3VjX3JpbmdfZG9vcmJlbGwo
Y2xpZW50KTsKIAotCWNsaWVudC0+c3VibWlzc2lvbnNbZW5naW5lLT5pZF0gKz0gMTsKKwljbGll
bnQtPnN1Ym1pc3Npb25zW2VuZ2luZS0+Z3VjX2lkXSArPSAxOwogfQogCiAvKgpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9jbWRfcGFyc2VyLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2NtZF9wYXJzZXIuYwppbmRleCBhMjhiY2QyZDdjMDkuLjczMGMxZWQ2ZDJh
NyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9jbWRfcGFyc2VyLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9jbWRfcGFyc2VyLmMKQEAgLTEzNTIsMTEgKzEz
NTIsMTAgQEAgaW50IGludGVsX2VuZ2luZV9jbWRfcGFyc2VyKHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSwKIGludCBpOTE1X2NtZF9wYXJzZXJfZ2V0X3ZlcnNpb24oc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQogewogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZTsKLQllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKIAlib29sIGFjdGl2ZSA9IGZhbHNlOwogCiAJ
LyogSWYgdGhlIGNvbW1hbmQgcGFyc2VyIGlzIG5vdCBlbmFibGVkLCByZXBvcnQgMCAtIHVuc3Vw
cG9ydGVkICovCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYsIGlkKSB7CisJZm9y
X2VhY2hfdXNlcl9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdikgewogCQlpZiAoaW50ZWxfZW5naW5l
X25lZWRzX2NtZF9wYXJzZXIoZW5naW5lKSkgewogCQkJYWN0aXZlID0gdHJ1ZTsKIAkJCWJyZWFr
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwppbmRleCBjNDNmMjcwMDg1ZjUuLjY3NWE3
Nzc1ZDQ0OSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKQEAgLTMwMSwxMCArMzAx
LDkgQEAgc3RhdGljIHZvaWQgcHJpbnRfYmF0Y2hfcG9vbF9zdGF0cyhzdHJ1Y3Qgc2VxX2ZpbGUg
Km0sCiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKIAlzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmU7CiAJc3RydWN0IGZpbGVfc3RhdHMgc3RhdHMgPSB7fTsKLQllbnVtIGlu
dGVsX2VuZ2luZV9pZCBpZDsKIAlpbnQgajsKIAotCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGRl
dl9wcml2LCBpZCkgeworCWZvcl9lYWNoX3VzZXJfZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYpIHsK
IAkJZm9yIChqID0gMDsgaiA8IEFSUkFZX1NJWkUoZW5naW5lLT5iYXRjaF9wb29sLmNhY2hlX2xp
c3QpOyBqKyspIHsKIAkJCWxpc3RfZm9yX2VhY2hfZW50cnkob2JqLAogCQkJCQkgICAgJmVuZ2lu
ZS0+YmF0Y2hfcG9vbC5jYWNoZV9saXN0W2pdLApAQCAtMzg3LDcgKzM4Niw2IEBAIHN0YXRpYyBp
bnQgaTkxNV9nZW1fYmF0Y2hfcG9vbF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0
YSkKIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmRldl9wcml2LT5kcm07CiAJc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3QgKm9iajsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7
Ci0JZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CiAJaW50IHRvdGFsID0gMDsKIAlpbnQgcmV0LCBq
OwogCkBAIC0zOTUsNyArMzkzLDcgQEAgc3RhdGljIGludCBpOTE1X2dlbV9iYXRjaF9wb29sX2lu
Zm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQogCWlmIChyZXQpCiAJCXJldHVybiBy
ZXQ7CiAKLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpIHsKKwlmb3JfZWFj
aF91c2VyX2VuZ2luZShlbmdpbmUsIGRldl9wcml2KSB7CiAJCWZvciAoaiA9IDA7IGogPCBBUlJB
WV9TSVpFKGVuZ2luZS0+YmF0Y2hfcG9vbC5jYWNoZV9saXN0KTsgaisrKSB7CiAJCQlpbnQgY291
bnQ7CiAKQEAgLTQ4Miw3ICs0ODAsNiBAQCBzdGF0aWMgaW50IGk5MTVfaW50ZXJydXB0X2luZm8o
c3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKIAlzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmU7Ci0JZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CiAJaW50ZWxfd2Fr
ZXJlZl90IHdha2VyZWY7CiAJaW50IGksIHBpcGU7CiAKQEAgLTY4NSw3ICs2ODIsNyBAQCBzdGF0
aWMgaW50IGk5MTVfaW50ZXJydXB0X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRh
KQogCQkJICAgSTkxNV9SRUFEKEdFTjExX0dVTklUX0NTTUVfSU5UUl9NQVNLKSk7CiAKIAl9IGVs
c2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNikgewotCQlmb3JfZWFjaF9lbmdpbmUoZW5n
aW5lLCBkZXZfcHJpdiwgaWQpIHsKKwkJZm9yX2VhY2hfdXNlcl9lbmdpbmUoZW5naW5lLCBkZXZf
cHJpdikgewogCQkJc2VxX3ByaW50ZihtLAogCQkJCSAgICJHcmFwaGljcyBJbnRlcnJ1cHQgbWFz
ayAoJXMpOgklMDh4XG4iLAogCQkJCSAgIGVuZ2luZS0+bmFtZSwgRU5HSU5FX1JFQUQoZW5naW5l
LCBSSU5HX0lNUikpOwpAQCAtMTA3OSw3ICsxMDc2LDYgQEAgc3RhdGljIGludCBpOTE1X2hhbmdj
aGVja19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogCXN0cnVjdCBpbnRl
bF9ndCAqZ3QgPSAmaTkxNS0+Z3Q7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwog
CWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwotCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwogCiAJ
c2VxX3ByaW50ZihtLCAiUmVzZXQgZmxhZ3M6ICVseFxuIiwgZ3QtPnJlc2V0LmZsYWdzKTsKIAlp
ZiAodGVzdF9iaXQoSTkxNV9XRURHRUQsICZndC0+cmVzZXQuZmxhZ3MpKQpAQCAtMTEwNCw3ICsx
MTAwLDcgQEAgc3RhdGljIGludCBpOTE1X2hhbmdjaGVja19pbmZvKHN0cnVjdCBzZXFfZmlsZSAq
bSwgdm9pZCAqdW51c2VkKQogCXNlcV9wcmludGYobSwgIkdUIGFjdGl2ZT8gJXNcbiIsIHllc25v
KGd0LT5hd2FrZSkpOwogCiAJd2l0aF9pbnRlbF9ydW50aW1lX3BtKCZpOTE1LT5ydW50aW1lX3Bt
LCB3YWtlcmVmKSB7Ci0JCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKSB7CisJCWZv
cl9lYWNoX3VzZXJfZW5naW5lKGVuZ2luZSwgaTkxNSkgewogCQkJc3RydWN0IGludGVsX2luc3Rk
b25lIGluc3Rkb25lOwogCiAJCQlzZXFfcHJpbnRmKG0sICIlczogJWQgbXMgYWdvXG4iLApAQCAt
MTk1Nyw3ICsxOTUzLDYgQEAgc3RhdGljIHZvaWQgaTkxNV9ndWNfY2xpZW50X2luZm8oc3RydWN0
IHNlcV9maWxlICptLAogCQkJCSBzdHJ1Y3QgaW50ZWxfZ3VjX2NsaWVudCAqY2xpZW50KQogewog
CXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKLQllbnVtIGludGVsX2VuZ2luZV9pZCBp
ZDsKIAl1NjQgdG90ID0gMDsKIAogCXNlcV9wcmludGYobSwgIlx0UHJpb3JpdHkgJWQsIEd1QyBz
dGFnZSBpbmRleDogJXUsIFBEIG9mZnNldCAweCV4XG4iLApAQCAtMTk2NSw4ICsxOTYwLDggQEAg
c3RhdGljIHZvaWQgaTkxNV9ndWNfY2xpZW50X2luZm8oc3RydWN0IHNlcV9maWxlICptLAogCXNl
cV9wcmludGYobSwgIlx0RG9vcmJlbGwgaWQgJWQsIG9mZnNldDogMHglbHhcbiIsCiAJCWNsaWVu
dC0+ZG9vcmJlbGxfaWQsIGNsaWVudC0+ZG9vcmJlbGxfb2Zmc2V0KTsKIAotCWZvcl9lYWNoX2Vu
Z2luZShlbmdpbmUsIGRldl9wcml2LCBpZCkgewotCQl1NjQgc3VibWlzc2lvbnMgPSBjbGllbnQt
PnN1Ym1pc3Npb25zW2lkXTsKKwlmb3JfZWFjaF91c2VyX2VuZ2luZShlbmdpbmUsIGRldl9wcml2
KSB7CisJCXU2NCBzdWJtaXNzaW9ucyA9IGNsaWVudC0+c3VibWlzc2lvbnNbZW5naW5lLT5ndWNf
aWRdOwogCQl0b3QgKz0gc3VibWlzc2lvbnM7CiAJCXNlcV9wcmludGYobSwgIlx0U3VibWlzc2lv
bnM6ICVsbHUgJXNcbiIsCiAJCQkJc3VibWlzc2lvbnMsIGVuZ2luZS0+bmFtZSk7CkBAIC0yMDA2
LDcgKzIwMDEsNiBAQCBzdGF0aWMgaW50IGk5MTVfZ3VjX3N0YWdlX3Bvb2woc3RydWN0IHNlcV9m
aWxlICptLCB2b2lkICpkYXRhKQogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKIAljb25zdCBzdHJ1Y3QgaW50ZWxfZ3VjICpndWMg
PSAmZGV2X3ByaXYtPmd0LnVjLmd1YzsKIAlzdHJ1Y3QgZ3VjX3N0YWdlX2Rlc2MgKmRlc2MgPSBn
dWMtPnN0YWdlX2Rlc2NfcG9vbF92YWRkcjsKLQlpbnRlbF9lbmdpbmVfbWFza190IHRtcDsKIAlp
bnQgaW5kZXg7CiAKIAlpZiAoIVVTRVNfR1VDX1NVQk1JU1NJT04oZGV2X3ByaXYpKQpAQCAtMjAz
NSw3ICsyMDI5LDcgQEAgc3RhdGljIGludCBpOTE1X2d1Y19zdGFnZV9wb29sKHN0cnVjdCBzZXFf
ZmlsZSAqbSwgdm9pZCAqZGF0YSkKIAkJCSAgIGRlc2MtPndxX2FkZHIsIGRlc2MtPndxX3NpemUp
OwogCQlzZXFfcHV0YyhtLCAnXG4nKTsKIAotCQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZf
cHJpdiwgdG1wKSB7CisJCWZvcl9lYWNoX3VzZXJfZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYpIHsK
IAkJCXUzMiBndWNfZW5naW5lX2lkID0gZW5naW5lLT5ndWNfaWQ7CiAJCQlzdHJ1Y3QgZ3VjX2V4
ZWNsaXN0X2NvbnRleHQgKmxyYyA9CiAJCQkJCQkmZGVzYy0+bHJjW2d1Y19lbmdpbmVfaWRdOwpA
QCAtMjg0MSw3ICsyODM1LDYgQEAgc3RhdGljIGludCBpOTE1X2VuZ2luZV9pbmZvKHN0cnVjdCBz
ZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmU7CiAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Ci0JZW51bSBpbnRlbF9lbmdpbmVf
aWQgaWQ7CiAJc3RydWN0IGRybV9wcmludGVyIHA7CiAKIAl3YWtlcmVmID0gaW50ZWxfcnVudGlt
ZV9wbV9nZXQoJmRldl9wcml2LT5ydW50aW1lX3BtKTsKQEAgLTI4NTMsNyArMjg0Niw3IEBAIHN0
YXRpYyBpbnQgaTkxNV9lbmdpbmVfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNl
ZCkKIAkJICAgUlVOVElNRV9JTkZPKGRldl9wcml2KS0+Y3NfdGltZXN0YW1wX2ZyZXF1ZW5jeV9r
aHopOwogCiAJcCA9IGRybV9zZXFfZmlsZV9wcmludGVyKG0pOwotCWZvcl9lYWNoX2VuZ2luZShl
bmdpbmUsIGRldl9wcml2LCBpZCkKKwlmb3JfZWFjaF91c2VyX2VuZ2luZShlbmdpbmUsIGRldl9w
cml2KQogCQlpbnRlbF9lbmdpbmVfZHVtcChlbmdpbmUsICZwLCAiJXNcbiIsIGVuZ2luZS0+bmFt
ZSk7CiAKIAlpbnRlbF9ydW50aW1lX3BtX3B1dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2Vy
ZWYpOwpAQCAtMjkzNCw5ICsyOTI3LDggQEAgc3RhdGljIGludCBpOTE1X3dhX3JlZ2lzdGVycyhz
dHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKIAlzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmU7Ci0JZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CiAKLQlmb3JfZWFjaF9l
bmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgeworCWZvcl9lYWNoX3VzZXJfZW5naW5lKGVuZ2luZSwg
aTkxNSkgewogCQljb25zdCBzdHJ1Y3QgaTkxNV93YV9saXN0ICp3YWwgPSAmZW5naW5lLT5jdHhf
d2FfbGlzdDsKIAkJY29uc3Qgc3RydWN0IGk5MTVfd2EgKndhOwogCQl1bnNpZ25lZCBpbnQgY291
bnQ7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAppbmRleCBiOGE2OWYyMzY1MTAuLjhkMWFkMjdiMTMy
ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAorKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCkBAIC0xOTE1LDYgKzE5MTUsMTQgQEAgc3RhdGlj
IGlubGluZSBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqd29wY21fdG9faTkxNShzdHJ1Y3QgaW50
ZWxfd29wY20gKndvcGNtKQogCSAgICAgKChlbmdpbmVfXykgPSAoZGV2X3ByaXZfXyktPmVuZ2lu
ZVtfX21hc2tfbmV4dF9iaXQodG1wX18pXSksIDEgOiBcCiAJICAgICAwOykKIAorI2RlZmluZSBy
Yl90b191YWJpX2VuZ2luZShyYikgXAorCXJiX2VudHJ5X3NhZmUocmIsIHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MsIHVhYmlfbm9kZSkKKworI2RlZmluZSBmb3JfZWFjaF91c2VyX2VuZ2luZShlbmdp
bmVfXywgaTkxNV9fKSBcCisJZm9yICgoZW5naW5lX18pID0gcmJfdG9fdWFiaV9lbmdpbmUocmJf
Zmlyc3QoJihpOTE1X18pLT51YWJpX2VuZ2luZXMpKTtcCisJICAgICAoZW5naW5lX18pOyBcCisJ
ICAgICAoZW5naW5lX18pID0gcmJfdG9fdWFiaV9lbmdpbmUocmJfbmV4dCgmKGVuZ2luZV9fKS0+
dWFiaV9ub2RlKSkpCisKIGVudW0gaGRtaV9mb3JjZV9hdWRpbyB7CiAJSERNSV9BVURJT19PRkZf
RFZJID0gLTIsCS8qIG5vIGF1eCBkYXRhIGZvciBIRE1JLURWSSBjb252ZXJ0ZXIgKi8KIAlIRE1J
X0FVRElPX09GRiwJCQkvKiBmb3JjZSB0dXJuIG9mZiBIRE1JIGF1ZGlvICovCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3F1ZXJ5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3F1ZXJ5LmMKaW5kZXggNzBiMWFkMzhlNjE1Li44YWJiYTNhMzE3NjcgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcXVlcnkuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3F1ZXJ5LmMKQEAgLTEwNSw3ICsxMDUsNiBAQCBxdWVyeV9lbmdpbmVfaW5m
byhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAlzdHJ1Y3QgZHJtX2k5MTVfcXVlcnlf
ZW5naW5lX2luZm8gcXVlcnk7CiAJc3RydWN0IGRybV9pOTE1X2VuZ2luZV9pbmZvIGluZm8gPSB7
IH07CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCWVudW0gaW50ZWxfZW5naW5l
X2lkIGlkOwogCWludCBsZW4sIHJldDsKIAogCWlmIChxdWVyeV9pdGVtLT5mbGFncykKQEAgLTEy
NSw3ICsxMjQsNyBAQCBxdWVyeV9lbmdpbmVfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKIAogCWluZm9fcHRyID0gJnF1ZXJ5X3B0ci0+ZW5naW5lc1swXTsKIAotCWZvcl9lYWNo
X2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKSB7CisJZm9yX2VhY2hfdXNlcl9lbmdpbmUoZW5naW5l
LCBpOTE1KSB7CiAJCWluZm8uZW5naW5lLmVuZ2luZV9jbGFzcyA9IGVuZ2luZS0+dWFiaV9jbGFz
czsKIAkJaW5mby5lbmdpbmUuZW5naW5lX2luc3RhbmNlID0gZW5naW5lLT51YWJpX2luc3RhbmNl
OwogCQlpbmZvLmNhcGFiaWxpdGllcyA9IGVuZ2luZS0+dWFiaV9jYXBhYmlsaXRpZXM7Ci0tIAoy
LjIyLjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCklu
dGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRw
czovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

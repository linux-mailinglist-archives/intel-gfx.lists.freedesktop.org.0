Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8268F175AA
	for <lists+intel-gfx@lfdr.de>; Wed,  8 May 2019 12:10:40 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 047E489338;
	Wed,  8 May 2019 10:10:31 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A69F5895B5;
 Wed,  8 May 2019 10:10:24 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16487701-1500050 
 for multiple; Wed, 08 May 2019 11:10:13 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed,  8 May 2019 11:09:56 +0100
Message-Id: <20190508100958.32637-14-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190508100958.32637-1-chris@chris-wilson.co.uk>
References: <20190508100958.32637-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t 14/16] i915/gem_exec_balancer: Exercise
 bonded pairs
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: igt-dev@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VGhlIHN1Ym1pdC1mZW5jZSArIGxvYWRfYmFsYW5jaW5nIGFwaXMgYWxsb3cgZm9yIHVzIHRvIGV4
ZWN1dGUgYSBuYW1lZApwYWlyIG9mIGVuZ2luZXMgaW4gcGFyYWxsZWw7IHRoYXQgdGhpcyBieSBz
dWJtaXR0aW5nIGEgcmVxdWVzdCB0byBvbmUKZW5naW5lLCB3ZSBjYW4gdGhlbiB1c2UgdGhlIGdl
bmVyYXRlZCBzdWJtaXQtZmVuY2UgdG8gc3VibWl0IGEgc2Vjb25kCnJlcXVlc3QgdG8gYW5vdGhl
ciBlbmdpbmUgYW5kIGhhdmUgaXQgZXhlY3V0ZSBhdCB0aGUgc2FtZSB0aW1lLgpGdXJ0aGVybW9y
ZSwgYnkgc3BlY2lmeWluZyBib25kZWQgcGFpcnMsIHdlIGNhbiBkaXJlY3QgdGhlIHZpcnR1YWwK
ZW5naW5lIHRvIHVzZSBhIHBhcnRpY3VsYXIgZW5naW5lIGluIHBhcmFsbGVsIHRvIHRoZSBmaXJz
dCByZXF1ZXN0LgoKU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxz
b24uY28udWs+Ci0tLQogdGVzdHMvaTkxNS9nZW1fZXhlY19iYWxhbmNlci5jIHwgMjM0ICsrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKystLQogMSBmaWxlIGNoYW5nZWQsIDIyNCBpbnNlcnRp
b25zKCspLCAxMCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1L2dlbV9leGVj
X2JhbGFuY2VyLmMgYi90ZXN0cy9pOTE1L2dlbV9leGVjX2JhbGFuY2VyLmMKaW5kZXggMjUxOTVk
NDc4Li4yMGFkNjY3MjcgMTAwNjQ0Ci0tLSBhL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfYmFsYW5jZXIu
YworKysgYi90ZXN0cy9pOTE1L2dlbV9leGVjX2JhbGFuY2VyLmMKQEAgLTk4LDkgKzk4LDM1IEBA
IGxpc3RfZW5naW5lcyhpbnQgaTkxNSwgdWludDMyX3QgY2xhc3NfbWFzaywgdW5zaWduZWQgaW50
ICpvdXQpCiAJcmV0dXJuIGVuZ2luZXM7CiB9CiAKK3N0YXRpYyBpbnQgX19zZXRfZW5naW5lcyhp
bnQgaTkxNSwgdWludDMyX3QgY3R4LAorCQkJIGNvbnN0IHN0cnVjdCBpOTE1X2VuZ2luZV9jbGFz
c19pbnN0YW5jZSAqY2ksCisJCQkgdW5zaWduZWQgaW50IGNvdW50KQoreworCUk5MTVfREVGSU5F
X0NPTlRFWFRfUEFSQU1fRU5HSU5FUyhlbmdpbmVzLCBjb3VudCk7CisJc3RydWN0IGRybV9pOTE1
X2dlbV9jb250ZXh0X3BhcmFtIHAgPSB7CisJCS5jdHhfaWQgPSBjdHgsCisJCS5wYXJhbSA9IEk5
MTVfQ09OVEVYVF9QQVJBTV9FTkdJTkVTLAorCQkuc2l6ZSA9IHNpemVvZihlbmdpbmVzKSwKKwkJ
LnZhbHVlID0gdG9fdXNlcl9wb2ludGVyKCZlbmdpbmVzKQorCX07CisKKwllbmdpbmVzLmV4dGVu
c2lvbnMgPSAwOworCW1lbWNweShlbmdpbmVzLmVuZ2luZXMsIGNpLCBzaXplb2YoZW5naW5lcy5l
bmdpbmVzKSk7CisKKwlyZXR1cm4gX19nZW1fY29udGV4dF9zZXRfcGFyYW0oaTkxNSwgJnApOwor
fQorCitzdGF0aWMgdm9pZCBzZXRfZW5naW5lcyhpbnQgaTkxNSwgdWludDMyX3QgY3R4LAorCQkJ
Y29uc3Qgc3RydWN0IGk5MTVfZW5naW5lX2NsYXNzX2luc3RhbmNlICpjaSwKKwkJCXVuc2lnbmVk
IGludCBjb3VudCkKK3sKKwlpZ3RfYXNzZXJ0X2VxKF9fc2V0X2VuZ2luZXMoaTkxNSwgY3R4LCBj
aSwgY291bnQpLCAwKTsKK30KKwogc3RhdGljIGludCBfX3NldF9sb2FkX2JhbGFuY2VyKGludCBp
OTE1LCB1aW50MzJfdCBjdHgsCiAJCQkgICAgICAgY29uc3Qgc3RydWN0IGk5MTVfZW5naW5lX2Ns
YXNzX2luc3RhbmNlICpjaSwKLQkJCSAgICAgICB1bnNpZ25lZCBpbnQgY291bnQpCisJCQkgICAg
ICAgdW5zaWduZWQgaW50IGNvdW50LAorCQkJICAgICAgIHZvaWQgKmV4dCkKIHsKIAlJOTE1X0RF
RklORV9DT05URVhUX0VOR0lORVNfTE9BRF9CQUxBTkNFKGJhbGFuY2VyLCBjb3VudCk7CiAJSTkx
NV9ERUZJTkVfQ09OVEVYVF9QQVJBTV9FTkdJTkVTKGVuZ2luZXMsIDEgKyBjb3VudCk7CkBAIC0x
MTMsNiArMTM5LDcgQEAgc3RhdGljIGludCBfX3NldF9sb2FkX2JhbGFuY2VyKGludCBpOTE1LCB1
aW50MzJfdCBjdHgsCiAKIAltZW1zZXQoJmJhbGFuY2VyLCAwLCBzaXplb2YoYmFsYW5jZXIpKTsK
IAliYWxhbmNlci5iYXNlLm5hbWUgPSBJOTE1X0NPTlRFWFRfRU5HSU5FU19FWFRfTE9BRF9CQUxB
TkNFOworCWJhbGFuY2VyLmJhc2UubmV4dF9leHRlbnNpb24gPSB0b191c2VyX3BvaW50ZXIoZXh0
KTsKIAogCWlndF9hc3NlcnQoY291bnQpOwogCWJhbGFuY2VyLm51bV9zaWJsaW5ncyA9IGNvdW50
OwpAQCAtMTMxLDkgKzE1OCwxMCBAQCBzdGF0aWMgaW50IF9fc2V0X2xvYWRfYmFsYW5jZXIoaW50
IGk5MTUsIHVpbnQzMl90IGN0eCwKIAogc3RhdGljIHZvaWQgc2V0X2xvYWRfYmFsYW5jZXIoaW50
IGk5MTUsIHVpbnQzMl90IGN0eCwKIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBpOTE1X2VuZ2luZV9j
bGFzc19pbnN0YW5jZSAqY2ksCi0JCQkgICAgICB1bnNpZ25lZCBpbnQgY291bnQpCisJCQkgICAg
ICB1bnNpZ25lZCBpbnQgY291bnQsCisJCQkgICAgICB2b2lkICpleHQpCiB7Ci0JaWd0X2Fzc2Vy
dF9lcShfX3NldF9sb2FkX2JhbGFuY2VyKGk5MTUsIGN0eCwgY2ksIGNvdW50KSwgMCk7CisJaWd0
X2Fzc2VydF9lcShfX3NldF9sb2FkX2JhbGFuY2VyKGk5MTUsIGN0eCwgY2ksIGNvdW50LCBleHQp
LCAwKTsKIH0KIAogc3RhdGljIHVpbnQzMl90IGxvYWRfYmFsYW5jZXJfY3JlYXRlKGludCBpOTE1
LApAQCAtMTQzLDcgKzE3MSw3IEBAIHN0YXRpYyB1aW50MzJfdCBsb2FkX2JhbGFuY2VyX2NyZWF0
ZShpbnQgaTkxNSwKIAl1aW50MzJfdCBjdHg7CiAKIAljdHggPSBnZW1fY29udGV4dF9jcmVhdGUo
aTkxNSk7Ci0Jc2V0X2xvYWRfYmFsYW5jZXIoaTkxNSwgY3R4LCBjaSwgY291bnQpOworCXNldF9s
b2FkX2JhbGFuY2VyKGk5MTUsIGN0eCwgY2ksIGNvdW50LCBOVUxMKTsKIAogCXJldHVybiBjdHg7
CiB9CkBAIC0yODgsNiArMzE2LDc0IEBAIHN0YXRpYyB2b2lkIGludmFsaWRfYmFsYW5jZXIoaW50
IGk5MTUpCiAJfQogfQogCitzdGF0aWMgdm9pZCBpbnZhbGlkX2JvbmRzKGludCBpOTE1KQorewor
CUk5MTVfREVGSU5FX0NPTlRFWFRfRU5HSU5FU19CT05EKGJvbmRzWzE2XSwgMSk7CisJSTkxNV9E
RUZJTkVfQ09OVEVYVF9QQVJBTV9FTkdJTkVTKGVuZ2luZXMsIDEpOworCXN0cnVjdCBkcm1faTkx
NV9nZW1fY29udGV4dF9wYXJhbSBwID0geworCQkuY3R4X2lkID0gZ2VtX2NvbnRleHRfY3JlYXRl
KGk5MTUpLAorCQkucGFyYW0gPSBJOTE1X0NPTlRFWFRfUEFSQU1fRU5HSU5FUywKKwkJLnZhbHVl
ID0gdG9fdXNlcl9wb2ludGVyKCZlbmdpbmVzKSwKKwkJLnNpemUgPSBzaXplb2YoZW5naW5lcyks
CisJfTsKKwl1aW50MzJfdCBoYW5kbGU7CisJdm9pZCAqcHRyOworCisJbWVtc2V0KCZlbmdpbmVz
LCAwLCBzaXplb2YoZW5naW5lcykpOworCWdlbV9jb250ZXh0X3NldF9wYXJhbShpOTE1LCAmcCk7
CisKKwltZW1zZXQoYm9uZHMsIDAsIHNpemVvZihib25kcykpOworCWZvciAoaW50IG4gPSAwOyBu
IDwgQVJSQVlfU0laRShib25kcyk7IG4rKykgeworCQlib25kc1tuXS5iYXNlLm5hbWUgPSBJOTE1
X0NPTlRFWFRfRU5HSU5FU19FWFRfQk9ORDsKKwkJYm9uZHNbbl0uYmFzZS5uZXh0X2V4dGVuc2lv
biA9CisJCQluID8gdG9fdXNlcl9wb2ludGVyKCZib25kc1tuIC0gMV0pIDogMDsKKwkJYm9uZHNb
bl0ubnVtX2JvbmRzID0gMTsKKwl9CisJZW5naW5lcy5leHRlbnNpb25zID0gdG9fdXNlcl9wb2lu
dGVyKCZib25kcyk7CisJZ2VtX2NvbnRleHRfc2V0X3BhcmFtKGk5MTUsICZwKTsKKworCWJvbmRz
WzBdLmJhc2UubmV4dF9leHRlbnNpb24gPSAtMXVsbDsKKwlpZ3RfYXNzZXJ0X2VxKF9fZ2VtX2Nv
bnRleHRfc2V0X3BhcmFtKGk5MTUsICZwKSwgLUVGQVVMVCk7CisKKwlib25kc1swXS5iYXNlLm5l
eHRfZXh0ZW5zaW9uID0gdG9fdXNlcl9wb2ludGVyKCZib25kc1swXSk7CisJaWd0X2Fzc2VydF9l
cShfX2dlbV9jb250ZXh0X3NldF9wYXJhbShpOTE1LCAmcCksIC1FMkJJRyk7CisKKwllbmdpbmVz
LmV4dGVuc2lvbnMgPSB0b191c2VyX3BvaW50ZXIoJmJvbmRzWzFdKTsKKwlpZ3RfYXNzZXJ0X2Vx
KF9fZ2VtX2NvbnRleHRfc2V0X3BhcmFtKGk5MTUsICZwKSwgLUUyQklHKTsKKwlib25kc1swXS5i
YXNlLm5leHRfZXh0ZW5zaW9uID0gMDsKKwlnZW1fY29udGV4dF9zZXRfcGFyYW0oaTkxNSwgJnAp
OworCisJaGFuZGxlID0gZ2VtX2NyZWF0ZShpOTE1LCA0MDk2ICogMyk7CisJcHRyID0gZ2VtX21t
YXBfX2d0dChpOTE1LCBoYW5kbGUsIDQwOTYgKiAzLCBQUk9UX1dSSVRFKTsKKwlnZW1fY2xvc2Uo
aTkxNSwgaGFuZGxlKTsKKworCW1lbWNweShwdHIgKyA0MDk2LCAmYm9uZHNbMF0sIHNpemVvZihi
b25kc1swXSkpOworCWVuZ2luZXMuZXh0ZW5zaW9ucyA9IHRvX3VzZXJfcG9pbnRlcihwdHIpICsg
NDA5NjsKKwlnZW1fY29udGV4dF9zZXRfcGFyYW0oaTkxNSwgJnApOworCisJbWVtY3B5KHB0ciwg
JmJvbmRzWzBdLCBzaXplb2YoYm9uZHNbMF0pKTsKKwlib25kc1swXS5iYXNlLm5leHRfZXh0ZW5z
aW9uID0gdG9fdXNlcl9wb2ludGVyKHB0cik7CisJbWVtY3B5KHB0ciArIDQwOTYsICZib25kc1sw
XSwgc2l6ZW9mKGJvbmRzWzBdKSk7CisJZ2VtX2NvbnRleHRfc2V0X3BhcmFtKGk5MTUsICZwKTsK
KworCW11bm1hcChwdHIsIDQwOTYpOworCWlndF9hc3NlcnRfZXEoX19nZW1fY29udGV4dF9zZXRf
cGFyYW0oaTkxNSwgJnApLCAtRUZBVUxUKTsKKworCWJvbmRzWzBdLmJhc2UubmV4dF9leHRlbnNp
b24gPSAwOworCW1lbWNweShwdHIgKyA4MTkyLCAmYm9uZHNbMF0sIHNpemVvZihib25kc1swXSkp
OworCWJvbmRzWzBdLmJhc2UubmV4dF9leHRlbnNpb24gPSB0b191c2VyX3BvaW50ZXIocHRyKSAr
IDgxOTI7CisJbWVtY3B5KHB0ciArIDQwOTYsICZib25kc1swXSwgc2l6ZW9mKGJvbmRzWzBdKSk7
CisJZ2VtX2NvbnRleHRfc2V0X3BhcmFtKGk5MTUsICZwKTsKKworCW11bm1hcChwdHIgKyA4MTky
LCA0MDk2KTsKKwlpZ3RfYXNzZXJ0X2VxKF9fZ2VtX2NvbnRleHRfc2V0X3BhcmFtKGk5MTUsICZw
KSwgLUVGQVVMVCk7CisKKwltdW5tYXAocHRyICsgNDA5NiwgNDA5Nik7CisJaWd0X2Fzc2VydF9l
cShfX2dlbV9jb250ZXh0X3NldF9wYXJhbShpOTE1LCAmcCksIC1FRkFVTFQpOworCisJZ2VtX2Nv
bnRleHRfZGVzdHJveShpOTE1LCBwLmN0eF9pZCk7Cit9CisKIHN0YXRpYyB2b2lkIGtpY2tfa3Ro
cmVhZHMoaW50IHBlcmlvZF91cykKIHsKIAlzY2hlZF95aWVsZCgpOwpAQCAtMzk3LDcgKzQ5Myw3
IEBAIHN0YXRpYyB2b2lkIGluZGl2aWR1YWwoaW50IGk5MTUpCiAKIAkJZm9yIChpbnQgcGFzcyA9
IDA7IHBhc3MgPCBjb3VudDsgcGFzcysrKSB7IC8qIGFwcHJveC4gY291bnQhICovCiAJCQlpZ3Rf
cGVybXV0ZV9hcnJheShjaSwgY291bnQsIGlndF9leGNoYW5nZV9pbnQ2NCk7Ci0JCQlzZXRfbG9h
ZF9iYWxhbmNlcihpOTE1LCBjdHgsIGNpLCBjb3VudCk7CisJCQlzZXRfbG9hZF9iYWxhbmNlcihp
OTE1LCBjdHgsIGNpLCBjb3VudCwgTlVMTCk7CiAJCQlmb3IgKHVuc2lnbmVkIGludCBuID0gMDsg
biA8IGNvdW50OyBuKyspCiAJCQkJY2hlY2tfaW5kaXZpZHVhbF9lbmdpbmUoaTkxNSwgY3R4LCBj
aSwgbik7CiAJCX0KQEAgLTQwOSw2ICs1MDUsMTE1IEBAIHN0YXRpYyB2b2lkIGluZGl2aWR1YWwo
aW50IGk5MTUpCiAJZ2VtX3F1aWVzY2VudF9ncHUoaTkxNSk7CiB9CiAKK3N0YXRpYyB2b2lkIGJv
bmRlZChpbnQgaTkxNSwgdW5zaWduZWQgaW50IGZsYWdzKQorI2RlZmluZSBDT1JLIDB4MQorewor
CUk5MTVfREVGSU5FX0NPTlRFWFRfRU5HSU5FU19CT05EKGJvbmRzWzE2XSwgMSk7CisJc3RydWN0
IGk5MTVfZW5naW5lX2NsYXNzX2luc3RhbmNlICptYXN0ZXJfZW5naW5lczsKKwl1aW50MzJfdCBt
YXN0ZXI7CisKKwkvKgorCSAqIEk5MTVfQ09OVEVYVF9QQVJBTV9FTkdJTkUgcHJvdmlkZXMgYW4g
ZXh0ZW5zaW9uIHRoYXQgYWxsb3dzIHVzCisJICogdG8gc3BlY2lmeSB3aGljaCBlbmdpbmUocykg
dG8gcGFpciB3aXRoIGEgcGFyYWxsZWwgKEVYRUNfU1VCTUlUKQorCSAqIHJlcXVlc3Qgc3VibWl0
dGVkIHRvIGFub3RoZXIgZW5naW5lLgorCSAqLworCisJbWFzdGVyID0gZ2VtX3F1ZXVlX2NyZWF0
ZShpOTE1KTsKKworCW1lbXNldChib25kcywgMCwgc2l6ZW9mKGJvbmRzKSk7CisJZm9yIChpbnQg
biA9IDA7IG4gPCBBUlJBWV9TSVpFKGJvbmRzKTsgbisrKSB7CisJCWJvbmRzW25dLmJhc2UubmFt
ZSA9IEk5MTVfQ09OVEVYVF9FTkdJTkVTX0VYVF9CT05EOworCQlib25kc1tuXS5iYXNlLm5leHRf
ZXh0ZW5zaW9uID0KKwkJCW4gPyB0b191c2VyX3BvaW50ZXIoJmJvbmRzW24gLSAxXSkgOiAwOwor
CQlib25kc1tuXS5udW1fYm9uZHMgPSAxOworCX0KKworCWZvciAoaW50IG1hc2sgPSAwOyBtYXNr
IDwgMzI7IG1hc2srKykgeworCQl1bnNpZ25lZCBpbnQgY291bnQsIGxpbWl0OworCQlzdHJ1Y3Qg
aTkxNV9lbmdpbmVfY2xhc3NfaW5zdGFuY2UgKnNpYmxpbmdzOworCQl1aW50MzJfdCBjdHg7CisJ
CWludCBuOworCisJCXNpYmxpbmdzID0gbGlzdF9lbmdpbmVzKGk5MTUsIDF1IDw8IG1hc2ssICZj
b3VudCk7CisJCWlmICghc2libGluZ3MpCisJCQljb250aW51ZTsKKworCQlpZiAoY291bnQgPCAy
KSB7CisJCQlmcmVlKHNpYmxpbmdzKTsKKwkJCWNvbnRpbnVlOworCQl9CisKKwkJaWd0X2RlYnVn
KCJGb3VuZCAlZCBlbmdpbmVzIG9mIGNsYXNzICVkXG4iLCBjb3VudCwgbWFzayk7CisKKwkJbWFz
dGVyX2VuZ2luZXMgPSBsaXN0X2VuZ2luZXMoaTkxNSwgfigxdSA8PCBtYXNrKSwgJmxpbWl0KTsK
KwkJc2V0X2VuZ2luZXMoaTkxNSwgbWFzdGVyLCBtYXN0ZXJfZW5naW5lcywgbGltaXQpOworCisJ
CWxpbWl0ID0gbWluKGNvdW50LCBsaW1pdCk7CisJCWZvciAobiA9IDA7IG4gPCBsaW1pdDsgbisr
KSB7CisJCQlib25kc1tuXS5tYXN0ZXIgPSBtYXN0ZXJfZW5naW5lc1tuXTsKKwkJCWJvbmRzW25d
LmVuZ2luZXNbMF0gPSBzaWJsaW5nc1tuXTsKKwkJfQorCisJCWN0eCA9IGdlbV9jb250ZXh0X2Ns
b25lKGk5MTUsCisJCQkJICAgICAgIAltYXN0ZXIsIEk5MTVfQ09OVEVYVF9DTE9ORV9WTSwKKwkJ
CQkJSTkxNV9DT05URVhUX0NSRUFURV9GTEFHU19TSU5HTEVfVElNRUxJTkUpOworCQlzZXRfbG9h
ZF9iYWxhbmNlcihpOTE1LCBjdHgsIHNpYmxpbmdzLCBjb3VudCwgJmJvbmRzW2xpbWl0IC0gMV0p
OworCisJCWZvciAobiA9IDA7IG4gPCBsaW1pdDsgbisrKSB7CisJCQlzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX2V4ZWNidWZmZXIyIGViOworCQkJSUdUX0NPUktfSEFORExFKGNvcmspOworCQkJaWd0X3Nw
aW5fdCAqc3BpbiwgKnBsdWc7CisJCQlkb3VibGUgbG9hZDsKKwkJCWludCBwbXU7CisKKwkJCWln
dF9hc3NlcnQoc2libGluZ3Nbbl0uZW5naW5lX2NsYXNzICE9IG1hc3Rlcl9lbmdpbmVzW25dLmVu
Z2luZV9jbGFzcyk7CisKKwkJCXBtdSA9IHBlcmZfaTkxNV9vcGVuKEk5MTVfUE1VX0VOR0lORV9C
VVNZKHNpYmxpbmdzW25dLmVuZ2luZV9jbGFzcywKKwkJCQkJCQkJICBzaWJsaW5nc1tuXS5lbmdp
bmVfaW5zdGFuY2UpKTsKKworCQkJcGx1ZyA9IE5VTEw7CisJCQlpZiAoZmxhZ3MgJiBDT1JLKSB7
CisJCQkJcGx1ZyA9IF9faWd0X3NwaW5fbmV3KGk5MTUsCisJCQkJCQkgICAgICAuY3R4ID0gbWFz
dGVyLAorCQkJCQkJICAgICAgLmVuZ2luZSA9IG4sCisJCQkJCQkgICAgICAuZGVwZW5kZW5jeSA9
IGlndF9jb3JrX3BsdWcoJmNvcmssIGk5MTUpKTsKKwkJCX0KKworCQkJc3BpbiA9IF9faWd0X3Nw
aW5fbmV3KGk5MTUsCisJCQkJCSAgICAgIC5jdHggPSBtYXN0ZXIsCisJCQkJCSAgICAgIC5lbmdp
bmUgPSBuLAorCQkJCQkgICAgICAuZmxhZ3MgPSBJR1RfU1BJTl9GRU5DRV9PVVQpOworCisJCQll
YiA9IHNwaW4tPmV4ZWNidWY7CisJCQllYi5yc3ZkMSA9IGN0eDsKKwkJCWViLnJzdmQyID0gc3Bp
bi0+b3V0X2ZlbmNlOworCQkJZWIuZmxhZ3MgPSBJOTE1X0VYRUNfRkVOQ0VfU1VCTUlUOworCQkJ
Z2VtX2V4ZWNidWYoaTkxNSwgJmViKTsKKworCQkJaWYgKHBsdWcpIHsKKwkJCQlpZ3RfY29ya191
bnBsdWcoJmNvcmspOworCQkJCWlndF9zcGluX2ZyZWUoaTkxNSwgcGx1Zyk7CisJCQl9CisKKwkJ
CWxvYWQgPSBtZWFzdXJlX2xvYWQocG11LCAxMDAwMCk7CisJCQlpZ3Rfc3Bpbl9mcmVlKGk5MTUs
IHNwaW4pOworCisJCQljbG9zZShwbXUpOworCisJCQlpZ3RfYXNzZXJ0X2YobG9hZCA+IDAuOTAs
CisJCQkJICAgICAiZW5naW5lICVkIChjbGFzczppbnN0YW5jZSAlZDolZCkgd2FzIGZvdW5kIHRv
IGJlIG9ubHkgJS4xZiUlIGJ1c3lcbiIsCisJCQkJICAgICBuLCBzaWJsaW5nc1tuXS5lbmdpbmVf
Y2xhc3MsIHNpYmxpbmdzW25dLmVuZ2luZV9pbnN0YW5jZSwKKwkJCQkgICAgIGxvYWQqMTAwKTsK
KwkJfQorCisJCWdlbV9jb250ZXh0X2Rlc3Ryb3koaTkxNSwgY3R4KTsKKwkJZnJlZShtYXN0ZXJf
ZW5naW5lcyk7CisJCWZyZWUoc2libGluZ3MpOworCX0KKworCWdlbV9jb250ZXh0X2Rlc3Ryb3ko
aTkxNSwgbWFzdGVyKTsKK30KKwogc3RhdGljIHZvaWQgaW5kaWNpZXMoaW50IGk5MTUpCiB7CiAJ
STkxNV9ERUZJTkVfQ09OVEVYVF9QQVJBTV9FTkdJTkVTKGVuZ2luZXMsIEk5MTVfRVhFQ19SSU5H
X01BU0sgKyAxKTsKQEAgLTg1NiwxMCArMTA2MSwxMCBAQCBzdGF0aWMgdm9pZCBzZW1hcGhvcmUo
aW50IGk5MTUpCiAJCWNvdW50ID0gQVJSQVlfU0laRShibG9jayk7CiAKIAkJZm9yIChpbnQgaSA9
IDA7IGkgPCBjb3VudDsgaSsrKSB7Ci0JCQlzZXRfbG9hZF9iYWxhbmNlcihpOTE1LCBibG9ja1tp
XSwgY2ksIGNvdW50KTsKKwkJCXNldF9sb2FkX2JhbGFuY2VyKGk5MTUsIGJsb2NrW2ldLCBjaSwg
Y291bnQsIE5VTEwpOwogCQkJc3BpbltpXSA9IF9faWd0X3NwaW5fbmV3KGk5MTUsCi0JCQkJCQkg
ICAgICAgLmN0eCA9IGJsb2NrW2ldLAotCQkJCQkJICAgICAgIC5kZXBlbmRlbmN5ID0gc2NyYXRj
aCk7CisJCQkJCQkgLmN0eCA9IGJsb2NrW2ldLAorCQkJCQkJIC5kZXBlbmRlbmN5ID0gc2NyYXRj
aCk7CiAJCX0KIAogCQkvKgpAQCAtODY3LDcgKzEwNzIsNyBAQCBzdGF0aWMgdm9pZCBzZW1hcGhv
cmUoaW50IGk5MTUpCiAJCSAqIG9yIHdlIGxldCB0aGUgdmlwIHRocm91Z2guIElmIG5vdCwgd2Ug
aGFuZy4KIAkJICovCiAJCXZpcCA9IGdlbV9jb250ZXh0X2NyZWF0ZShpOTE1KTsKLQkJc2V0X2xv
YWRfYmFsYW5jZXIoaTkxNSwgdmlwLCBjaSwgY291bnQpOworCQlzZXRfbG9hZF9iYWxhbmNlcihp
OTE1LCB2aXAsIGNpLCBjb3VudCwgTlVMTCk7CiAJCXBpbmcoaTkxNSwgdmlwLCAwKTsKIAkJZ2Vt
X2NvbnRleHRfZGVzdHJveShpOTE1LCB2aXApOwogCkBAIC05ODQsNyArMTE4OSw3IEBAIHN0YXRp
YyBib29sIGhhc19sb2FkX2JhbGFuY2VyKGludCBpOTE1KQogCWludCBlcnI7CiAKIAljdHggPSBn
ZW1fY29udGV4dF9jcmVhdGUoaTkxNSk7Ci0JZXJyID0gX19zZXRfbG9hZF9iYWxhbmNlcihpOTE1
LCBjdHgsICZjaSwgMSk7CisJZXJyID0gX19zZXRfbG9hZF9iYWxhbmNlcihpOTE1LCBjdHgsICZj
aSwgMSwgTlVMTCk7CiAJZ2VtX2NvbnRleHRfZGVzdHJveShpOTE1LCBjdHgpOwogCiAJcmV0dXJu
IGVyciA9PSAwOwpAQCAtMTAxMCw2ICsxMjE1LDkgQEAgaWd0X21haW4KIAlpZ3Rfc3VidGVzdCgi
aW52YWxpZC1iYWxhbmNlciIpCiAJCWludmFsaWRfYmFsYW5jZXIoaTkxNSk7CiAKKwlpZ3Rfc3Vi
dGVzdCgiaW52YWxpZC1ib25kcyIpCisJCWludmFsaWRfYm9uZHMoaTkxNSk7CisKIAlpZ3Rfc3Vi
dGVzdCgiaW5kaXZpZHVhbCIpCiAJCWluZGl2aWR1YWwoaTkxNSk7CiAKQEAgLTEwNDQsNiArMTI1
MiwxMiBAQCBpZ3RfbWFpbgogCWlndF9zdWJ0ZXN0KCJzbW9rZSIpCiAJCXNtb2tldGVzdChpOTE1
LCAyMCk7CiAKKwlpZ3Rfc3VidGVzdCgiYm9uZGVkLWltbSIpCisJCWJvbmRlZChpOTE1LCAwKTsK
KworCWlndF9zdWJ0ZXN0KCJib25kZWQtY29yayIpCisJCWJvbmRlZChpOTE1LCBDT1JLKTsKKwog
CWlndF9maXh0dXJlIHsKIAkJaWd0X3N0b3BfaGFuZ19kZXRlY3RvcigpOwogCX0KLS0gCjIuMjAu
MQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwt
Z2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8v
bGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

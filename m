Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 9E9F11792A
	for <lists+intel-gfx@lfdr.de>; Wed,  8 May 2019 14:11:30 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id EC0588991C;
	Wed,  8 May 2019 12:11:24 +0000 (UTC)
X-Original-To: Intel-gfx@lists.freedesktop.org
Delivered-To: Intel-gfx@lists.freedesktop.org
Received: from mga17.intel.com (mga17.intel.com [192.55.52.151])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4F9AA898A7;
 Wed,  8 May 2019 12:11:19 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga008.fm.intel.com ([10.253.24.58])
 by fmsmga107.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 08 May 2019 05:11:19 -0700
X-ExtLoop1: 1
Received: from jzapadkx-mobl1.ger.corp.intel.com (HELO localhost.localdomain)
 ([10.252.0.159])
 by fmsmga008.fm.intel.com with ESMTP; 08 May 2019 05:11:18 -0700
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
To: igt-dev@lists.freedesktop.org
Date: Wed,  8 May 2019 13:10:51 +0100
Message-Id: <20190508121058.27038-15-tvrtko.ursulin@linux.intel.com>
X-Mailer: git-send-email 2.19.1
In-Reply-To: <20190508121058.27038-1-tvrtko.ursulin@linux.intel.com>
References: <20190508121058.27038-1-tvrtko.ursulin@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t 14/21] gem_wsim: Engine map load balance
 command
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Intel-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KCkEgbmV3IHdv
cmtsb2FkIGNvbW1hbmQgZm9yIGVuYWJsaW5nIGEgbG9hZCBiYWxhbmNlZCBjb250ZXh0IG1hcCAo
YWthClZpcnR1YWwgRW5naW5lKS4gRXhhbXBsZSB1c2FnZToKCiAgQi4xCgpUaGlzIHR1cm5zIG9u
IGxvYWQgYmFsYW5jaW5nIGZvciBjb250ZXh0IG9uZSwgYXNzdW1pbmcgaXQgaGFzIGFscmVhZHkg
YmVlbgpjb25maWd1cmVkIHdpdGggYW4gZW5naW5lIG1hcC4gT25seSBERUZBVUxUIGVuZ2luZSBz
cGVjaWZpZXIgY2FuIGJlIHVzZWQKd2l0aCBsb2FkIGJhbGFuY2VkIGVuZ2luZSBtYXBzLgoKU2ln
bmVkLW9mZi1ieTogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KLS0t
CiBiZW5jaG1hcmtzL2dlbV93c2ltLmMgIHwgNzMgKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKystLS0tCiBiZW5jaG1hcmtzL3dzaW0vUkVBRE1FIHwgMTggKysrKysrKysrKysK
IDIgZmlsZXMgY2hhbmdlZCwgODQgaW5zZXJ0aW9ucygrKSwgNyBkZWxldGlvbnMoLSkKCmRpZmYg
LS1naXQgYS9iZW5jaG1hcmtzL2dlbV93c2ltLmMgYi9iZW5jaG1hcmtzL2dlbV93c2ltLmMKaW5k
ZXggYzJlMTNkOTkzOWMyLi5iNjEwYTYwM2Y3YjAgMTAwNjQ0Ci0tLSBhL2JlbmNobWFya3MvZ2Vt
X3dzaW0uYworKysgYi9iZW5jaG1hcmtzL2dlbV93c2ltLmMKQEAgLTgzLDcgKzgzLDggQEAgZW51
bSB3X3R5cGUKIAlTV19GRU5DRV9TSUdOQUwsCiAJQ1RYX1BSSU9SSVRZLAogCVBSRUVNUFRJT04s
Ci0JRU5HSU5FX01BUAorCUVOR0lORV9NQVAsCisJTE9BRF9CQUxBTkNFLAogfTsKIAogc3RydWN0
IGRlcHMKQEAgLTEyMSw2ICsxMjIsNyBAQCBzdHJ1Y3Qgd19zdGVwCiAJCQl1bnNpZ25lZCBpbnQg
ZW5naW5lX21hcF9jb3VudDsKIAkJCWVudW0gaW50ZWxfZW5naW5lX2lkICplbmdpbmVfbWFwOwog
CQl9OworCQlib29sIGxvYWRfYmFsYW5jZTsKIAl9OwogCiAJLyogSW1wbGVtZW50YXRpb24gZGV0
YWlscyAqLwpAQCAtNTAxLDYgKzUwMywyNSBAQCBwYXJzZV93b3JrbG9hZChzdHJ1Y3Qgd19hcmcg
KmFyZywgdW5zaWduZWQgaW50IGZsYWdzLCBzdHJ1Y3Qgd29ya2xvYWQgKmFwcF93KQogCiAJCQkJ
c3RlcC50eXBlID0gUFJFRU1QVElPTjsKIAkJCQlnb3RvIGFkZF9zdGVwOworCQkJfSBlbHNlIGlm
ICghc3RyY21wKGZpZWxkLCAiQiIpKSB7CisJCQkJdW5zaWduZWQgaW50IG5yID0gMDsKKwkJCQl3
aGlsZSAoKGZpZWxkID0gc3RydG9rX3IoZnN0YXJ0LCAiLiIsICZmY3R4KSkpIHsKKwkJCQkJdG1w
ID0gYXRvaShmaWVsZCk7CisJCQkJCWNoZWNrX2FyZyhuciA9PSAwICYmIHRtcCA8PSAwLAorCQkJ
CQkJICAiSW52YWxpZCBjb250ZXh0IGF0IHN0ZXAgJXUhXG4iLAorCQkJCQkJICBucl9zdGVwcyk7
CisJCQkJCWNoZWNrX2FyZyhuciA+IDAsCisJCQkJCQkgICJJbnZhbGlkIGxvYWQgYmFsYW5jZSBm
b3JtYXQgYXQgc3RlcCAldSFcbiIsCisJCQkJCQkgIG5yX3N0ZXBzKTsKKworCQkJCQlzdGVwLmNv
bnRleHQgPSB0bXA7CisJCQkJCXN0ZXAubG9hZF9iYWxhbmNlID0gdHJ1ZTsKKworCQkJCQlucisr
OworCQkJCX0KKworCQkJCXN0ZXAudHlwZSA9IExPQURfQkFMQU5DRTsKKwkJCQlnb3RvIGFkZF9z
dGVwOwogCQkJfQogCiAJCQlpZiAoIWZpZWxkKSB7CkBAIC04MzMsNyArODU0LDcgQEAgZmluZF9l
bmdpbmVfaW5fbWFwKHN0cnVjdCBjdHggKmN0eCwgZW51bSBpbnRlbF9lbmdpbmVfaWQgZW5naW5l
KQogCQkJcmV0dXJuIGkgKyAxOwogCX0KIAotCWlndF9hc3NlcnQoMCk7CisJaWd0X2Fzc2VydChj
dHgtPndhbnRzX2JhbGFuY2UpOwogCXJldHVybiAwOwogfQogCkBAIC0xMDQ0LDEyICsxMDY1LDE5
IEBAIHByZXBhcmVfd29ya2xvYWQodW5zaWduZWQgaW50IGlkLCBzdHJ1Y3Qgd29ya2xvYWQgKndy
aywgdW5zaWduZWQgaW50IGZsYWdzKQogCQkJCXdyay0+Y3R4X2xpc3Rbal0uZW5naW5lX21hcCA9
IHctPmVuZ2luZV9tYXA7CiAJCQkJd3JrLT5jdHhfbGlzdFtqXS5lbmdpbmVfbWFwX2NvdW50ID0K
IAkJCQkJdy0+ZW5naW5lX21hcF9jb3VudDsKKwkJCX0gZWxzZSBpZiAody0+dHlwZSA9PSBMT0FE
X0JBTEFOQ0UpIHsKKwkJCQlpZiAoIXdyay0+Y3R4X2xpc3Rbal0uZW5naW5lX21hcCkgeworCQkJ
CQl3c2ltX2VycigiTG9hZCBiYWxhbmNpbmcgbmVlZHMgYW4gZW5naW5lIG1hcCFcbiIpOworCQkJ
CQlyZXR1cm4gMTsKKwkJCQl9CisJCQkJd3JrLT5jdHhfbGlzdFtqXS53YW50c19iYWxhbmNlID0K
KwkJCQkJdy0+bG9hZF9iYWxhbmNlOwogCQkJfQogCQl9CiAKIAkJd3JrLT5jdHhfbGlzdFtqXS50
YXJnZXRzX2luc3RhbmNlID0gdGFyZ2V0czsKIAkJaWYgKGZsYWdzICYgSTkxNSkKLQkJCXdyay0+
Y3R4X2xpc3Rbal0ud2FudHNfYmFsYW5jZSA9IGJhbGFuY2U7CisJCQl3cmstPmN0eF9saXN0W2pd
LndhbnRzX2JhbGFuY2UgfD0gYmFsYW5jZTsKIAl9CiAKIAkvKgpAQCAtMTA2MywxMCArMTA5MSwx
OSBAQCBwcmVwYXJlX3dvcmtsb2FkKHVuc2lnbmVkIGludCBpZCwgc3RydWN0IHdvcmtsb2FkICp3
cmssIHVuc2lnbmVkIGludCBmbGFncykKIAkJCWlmICh3LT50eXBlICE9IEJBVENIKQogCQkJCWNv
bnRpbnVlOwogCi0JCQlpZiAod3JrLT5jdHhfbGlzdFtqXS5lbmdpbmVfbWFwICYmIHctPmVuZ2lu
ZSA9PSBWQ1MpIHsKKwkJCWlmICh3cmstPmN0eF9saXN0W2pdLmVuZ2luZV9tYXAgJiYKKwkJCSAg
ICAhd3JrLT5jdHhfbGlzdFtqXS53YW50c19iYWxhbmNlICYmCisJCQkgICAgKHctPmVuZ2luZSA9
PSBWQ1MgfHwgdy0+ZW5naW5lID09IERFRkFVTFQpKSB7CiAJCQkJd3NpbV9lcnIoIkJhdGNoZXMg
dGFyZ2V0dGluZyBlbmdpbmUgbWFwcyBtdXN0IHVzZSBleHBsaWNpdCBlbmdpbmVzIVxuIik7CiAJ
CQkJcmV0dXJuIC0xOwogCQkJfQorCisJCQlpZiAod3JrLT5jdHhfbGlzdFtqXS5lbmdpbmVfbWFw
ICYmCisJCQkgICAgd3JrLT5jdHhfbGlzdFtqXS53YW50c19iYWxhbmNlICYmCisJCQkgICAgdy0+
ZW5naW5lICE9IERFRkFVTFQpIHsKKwkJCQl3c2ltX2VycigiQmF0Y2hlcyB0YXJnZXR0aW5nIGxv
YWQgYmFsYW5jZWQgbWFwcyBtdXN0IG5vdCB1c2UgZXhwbGljaXQgZW5naW5lcyFcbiIpOworCQkJ
CXJldHVybiAtMTsKKwkJCX0KIAkJfQogCX0KIApAQCAtMTExMSw3ICsxMTQ4LDggQEAgcHJlcGFy
ZV93b3JrbG9hZCh1bnNpZ25lZCBpbnQgaWQsIHN0cnVjdCB3b3JrbG9hZCAqd3JrLCB1bnNpZ25l
ZCBpbnQgZmxhZ3MpCiAJCQkJYnJlYWs7CiAJCQl9CiAKLQkJCWlmICghY3R4LT5lbmdpbmVfbWFw
ICYmICFjdHgtPnRhcmdldHNfaW5zdGFuY2UpCisJCQlpZiAoKCFjdHgtPmVuZ2luZV9tYXAgJiYg
IWN0eC0+dGFyZ2V0c19pbnN0YW5jZSkgfHwKKwkJCSAgICAoY3R4LT5lbmdpbmVfbWFwICYmIGN0
eC0+d2FudHNfYmFsYW5jZSkpCiAJCQkJYXJncy5mbGFncyB8PQogCQkJCSAgICAgSTkxNV9DT05U
RVhUX0NSRUFURV9GTEFHU19TSU5HTEVfVElNRUxJTkU7CiAKQEAgLTExNzIsNiArMTIxMCw4IEBA
IHByZXBhcmVfd29ya2xvYWQodW5zaWduZWQgaW50IGlkLCBzdHJ1Y3Qgd29ya2xvYWQgKndyaywg
dW5zaWduZWQgaW50IGZsYWdzKQogCQlpZiAoY3R4LT5lbmdpbmVfbWFwKSB7CiAJCQlJOTE1X0RF
RklORV9DT05URVhUX1BBUkFNX0VOR0lORVMoc2V0X2VuZ2luZXMsCiAJCQkJCQkJICBjdHgtPmVu
Z2luZV9tYXBfY291bnQgKyAxKTsKKwkJCUk5MTVfREVGSU5FX0NPTlRFWFRfRU5HSU5FU19MT0FE
X0JBTEFOQ0UobG9hZF9iYWxhbmNlLAorCQkJCQkJCQkgY3R4LT5lbmdpbmVfbWFwX2NvdW50KTsK
IAkJCXN0cnVjdCBkcm1faTkxNV9nZW1fY29udGV4dF9wYXJhbSBwYXJhbSA9IHsKIAkJCQkuY3R4
X2lkID0gY3R4X2lkLAogCQkJCS5wYXJhbSA9IEk5MTVfQ09OVEVYVF9QQVJBTV9FTkdJTkVTLApA
QCAtMTE3OSw3ICsxMjE5LDI1IEBAIHByZXBhcmVfd29ya2xvYWQodW5zaWduZWQgaW50IGlkLCBz
dHJ1Y3Qgd29ya2xvYWQgKndyaywgdW5zaWduZWQgaW50IGZsYWdzKQogCQkJCS52YWx1ZSA9IHRv
X3VzZXJfcG9pbnRlcigmc2V0X2VuZ2luZXMpLAogCQkJfTsKIAotCQkJc2V0X2VuZ2luZXMuZXh0
ZW5zaW9ucyA9IDA7CisJCQlpZiAoY3R4LT53YW50c19iYWxhbmNlKSB7CisJCQkJc2V0X2VuZ2lu
ZXMuZXh0ZW5zaW9ucyA9CisJCQkJCXRvX3VzZXJfcG9pbnRlcigmbG9hZF9iYWxhbmNlKTsKKwor
CQkJCW1lbXNldCgmbG9hZF9iYWxhbmNlLCAwLCBzaXplb2YobG9hZF9iYWxhbmNlKSk7CisJCQkJ
bG9hZF9iYWxhbmNlLmJhc2UubmFtZSA9CisJCQkJCUk5MTVfQ09OVEVYVF9FTkdJTkVTX0VYVF9M
T0FEX0JBTEFOQ0U7CisJCQkJbG9hZF9iYWxhbmNlLm51bV9zaWJsaW5ncyA9CisJCQkJCWN0eC0+
ZW5naW5lX21hcF9jb3VudDsKKworCQkJCWZvciAoaiA9IDA7IGogPCBjdHgtPmVuZ2luZV9tYXBf
Y291bnQ7IGorKykgeworCQkJCQlsb2FkX2JhbGFuY2UuZW5naW5lc1tqXS5lbmdpbmVfY2xhc3Mg
PQorCQkJCQkJSTkxNV9FTkdJTkVfQ0xBU1NfVklERU87IC8qIEZJWE1FICovCisJCQkJCWxvYWRf
YmFsYW5jZS5lbmdpbmVzW2pdLmVuZ2luZV9pbnN0YW5jZSA9CisJCQkJCQljdHgtPmVuZ2luZV9t
YXBbal0gLSBWQ1MxOyAvKiBGSVhNRSAqLworCQkJCX0KKwkJCX0gZWxzZSB7CisJCQkJc2V0X2Vu
Z2luZXMuZXh0ZW5zaW9ucyA9IDA7CisJCQl9CiAKIAkJCS8qIFJlc2VydmUgc2xvdCBmb3Igdmly
dHVhbCBlbmdpbmUuICovCiAJCQlzZXRfZW5naW5lcy5lbmdpbmVzWzBdLmVuZ2luZV9jbGFzcyA9
CkBAIC0yMTY0LDcgKzIyMjIsOCBAQCBzdGF0aWMgdm9pZCAqcnVuX3dvcmtsb2FkKHZvaWQgKmRh
dGEpCiAJCQkJfQogCQkJCWNvbnRpbnVlOwogCQkJfSBlbHNlIGlmICh3LT50eXBlID09IFBSRUVN
UFRJT04gfHwKLQkJCQkgICB3LT50eXBlID09IEVOR0lORV9NQVApIHsKKwkJCQkgICB3LT50eXBl
ID09IEVOR0lORV9NQVAgfHwKKwkJCQkgICB3LT50eXBlID09IExPQURfQkFMQU5DRSkgewogCQkJ
CWNvbnRpbnVlOwogCQkJfQogCmRpZmYgLS1naXQgYS9iZW5jaG1hcmtzL3dzaW0vUkVBRE1FIGIv
YmVuY2htYXJrcy93c2ltL1JFQURNRQppbmRleCA0YjE0YWEyOGJmYTcuLjQ1ZmExZTBhMWQ3NiAx
MDA2NDQKLS0tIGEvYmVuY2htYXJrcy93c2ltL1JFQURNRQorKysgYi9iZW5jaG1hcmtzL3dzaW0v
UkVBRE1FCkBAIC0zLDYgKzMsNyBAQCBXb3JrbG9hZCBkZXNjcmlwdG9yIGZvcm1hdAogCiBjdHgu
ZW5naW5lLmR1cmF0aW9uX3VzLmRlcGVuZGVuY3kud2FpdCwuLi4KIDx1aW50Pi48c3RyPi48dWlu
dD5bLTx1aW50Pl0uPGludCA8PSAwPlsvPGludCA8PSAwPl1bLi4uXS48MHwxPiwuLi4KK0IuPHVp
bnQ+CiBNLjx1aW50Pi48c3RyPlt8PHN0cj5dLi4uCiBQfFguPHVpbnQ+LjxpbnQ+CiBkfHB8c3x0
fHF8YS48aW50PiwuLi4KQEAgLTI0LDYgKzI1LDcgQEAgQWRkaXRpb25hbCB3b3JrbG9hZCBzdGVw
cyBhcmUgYWxzbyBzdXBwb3J0ZWQ6CiAgJ3EnIC0gVGhyb3R0bGUgdG8gbiBtYXggcXVldWUgZGVw
dGguCiAgJ2YnIC0gQ3JlYXRlIGEgc3luYyBmZW5jZS4KICAnYScgLSBBZHZhbmNlIHRoZSBwcmV2
aW91c2x5IGNyZWF0ZWQgc3luYyBmZW5jZS4KKyAnQicgLSBUdXJuIG9uIGNvbnRleHQgbG9hZCBi
YWxhbmNpbmcuCiAgJ00nIC0gU2V0IHVwIGVuZ2luZSBtYXAuCiAgJ1AnIC0gQ29udGV4dCBwcmlv
cml0eS4KICAnWCcgLSBDb250ZXh0IHByZWVtcHRpb24gY29udHJvbC4KQEAgLTE3NiwzICsxNzgs
MTkgQEAgRXhhbXBsZToKIAogVGhpcyBzZXRzIHVwIGNvbnRleHQgMSB3aXRoIGFuIGVuZ2luZSBt
YXAgY29udGFpbmluZyBWQ1MxIGFuZCBWQ1MyIGVuZ2luZS4KIFN1Ym1pc3Npb24gdG8gdGhpcyBj
b250ZXh0IGNhbiBub3cgb25seSByZWZlcmVuY2UgdGhlc2UgdHdvIGVuZ2luZXMuCisKK0NvbnRl
eHQgbG9hZCBiYWxhbmNpbmcKKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKworQ29udGV4dCBsb2Fk
IGJhbGFuY2luZyAoYWthIFZpcnR1YWwgRW5naW5lKSBpcyBhbiBpOTE1IGZlYXR1cmUgd2hlcmUg
dGhlIGRyaXZlcgord2lsbCBwaWNrIHRoZSBiZXN0IGVuZ2luZSAobW9zdCBpZGxlKSB0byBzdWJt
aXQgdG8gZ2l2ZW4gcHJldmlvdXNseSBjb25maWd1cmVkCitlbmdpbmUgbWFwLgorCitFeGFtcGxl
OgorCisgIEIuMQorCitUaGlzIGVuYWJsZXMgbG9hZCBiYWxhbmNpbmcgZm9yIGNvbnRleHQgbnVt
YmVyIG9uZS4KKworU3VibWlzc2lvbnMgdG8gbG9hZCBiYWxhbmNlZCBjb250ZXh0cyBhcmUgb25s
eSBhbGxvd2VkIHRvIHVzZSB0aGUgREVGQVVMVCBlbmdpbmUKK3NwZWNpZmllci4KLS0gCjIuMTku
MQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwt
Z2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8v
bGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id CF0F3D19A0
	for <lists+intel-gfx@lfdr.de>; Wed,  9 Oct 2019 22:37:08 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 90E8D6E85F;
	Wed,  9 Oct 2019 20:37:06 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E44C46E321
 for <intel-gfx@lists.freedesktop.org>; Wed,  9 Oct 2019 20:36:54 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18782944-1500050 
 for multiple; Wed, 09 Oct 2019 21:36:44 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed,  9 Oct 2019 21:36:37 +0100
Message-Id: <20191009203641.15477-7-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191009203641.15477-1-chris@chris-wilson.co.uk>
References: <20191009203641.15477-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 07/11] drm/i915/perf: implement active wait for
 noa configurations
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogTGlvbmVsIExhbmR3ZXJsaW4gPGxpb25lbC5nLmxhbmR3ZXJsaW5AaW50ZWwuY29tPgoK
Tk9BIGNvbmZpZ3VyYXRpb24gdGFrZSBzb21lIGFtb3VudCBvZiB0aW1lIHRvIGFwcGx5LiBUaGF0
IGFtb3VudCBvZgp0aW1lIGRlcGVuZHMgb24gdGhlIHNpemUgb2YgdGhlIEdULiBUaGVyZSBpcyBu
byBkb2N1bWVudGVkIHRpbWUgZm9yCnRoaXMuIEZvciBleGFtcGxlLCBwYXN0IGV4cGVyaW1lbnRh
dGlvbnMgd2l0aCBwb3dlcmdhdGluZwpjb25maWd1cmF0aW9uIGNoYW5nZXMgc2VlbSB0byBpbmRp
Y2F0ZSBhIDYwfjcwdXMgZGVsYXkuIFdlIGdvIHdpdGgKNTAwdXMgYXMgZGVmYXVsdCBmb3Igbm93
IHdoaWNoIHNob3VsZCBiZSBvdmVyIHRoZSByZXF1aXJlZCBhbW91bnQgb2YKdGltZSAoYWNjb3Jk
aW5nIHRvIEhXIGFyY2hpdGVjdHMpLgoKdjI6IERvbid0IGZvcmdldCB0byBzYXZlL3Jlc3RvcmUg
cmVnaXN0ZXJzIHVzZWQgZm9yIHRoZSB3YWl0IChDaHJpcykKCnYzOiBOYW1lIHVzZWQgQ1NfR1BS
IHJlZ2lzdGVycyAoQ2hyaXMpCiAgICBGaXggY29tcGlsZSBpc3N1ZSBkdWUgdG8gcmViYXNlIChM
aW9uZWwpCgp2NDogRml4IHNhdmUvcmVzdG9yZSBoZWxwZXJzIChVbWVzaCkKCnY1OiBNb3ZlIG5v
YV93YWl0IGZyb20gZHJtX2k5MTVfcHJpdmF0ZSB0byBpOTE1X3BlcmZfc3RyZWFtIChMaW9uZWwp
Cgp2NjogQWRkIG1pc3Npbmcgc3RydWN0IGRlY2xhcmF0aW9ucyBpbiBpOTE1X3BlcmYuaAoKU2ln
bmVkLW9mZi1ieTogTGlvbmVsIExhbmR3ZXJsaW4gPGxpb25lbC5nLmxhbmR3ZXJsaW5AaW50ZWwu
Y29tPgpSZXZpZXdlZC1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+
ICh2NCkKLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ncHVfY29tbWFuZHMuaCAg
fCAgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3R5cGVzLmggICAgICB8
ICAgNSArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYyAgICAgICAgICAgfCAg
MzIgKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYyAgICAgICAgICAgICAgfCAy
MjMgKysrKysrKysrKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmZfdHlw
ZXMuaCAgICAgICAgfCAgIDggKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZWcuaCAgICAg
ICAgICAgICAgIHwgICA0ICstCiAuLi4vZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfbGl2ZV9zZWxm
dGVzdHMuaCAgfCAgIDEgKwogNyBmaWxlcyBjaGFuZ2VkLCAyNzUgaW5zZXJ0aW9ucygrKSwgMiBk
ZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9n
cHVfY29tbWFuZHMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2dwdV9jb21tYW5k
cy5oCmluZGV4IDA5ODcxMDBjNzg2Yi4uOGU2M2NmZmNhYmUwIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ncHVfY29tbWFuZHMuaAorKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9ncHVfY29tbWFuZHMuaApAQCAtMTYzLDcgKzE2Myw4IEBACiAjZGVm
aW5lIE1JX0JBVENIX0JVRkZFUl9TVEFSVAlNSV9JTlNUUigweDMxLCAwKQogI2RlZmluZSAgIE1J
X0JBVENIX0dUVAkJICAgICgyPDw2KSAvKiBhbGlhc2VkIHdpdGggKDE8PDcpIG9uIGdlbjQgKi8K
ICNkZWZpbmUgTUlfQkFUQ0hfQlVGRkVSX1NUQVJUX0dFTjgJTUlfSU5TVFIoMHgzMSwgMSkKLSNk
ZWZpbmUgICBNSV9CQVRDSF9SRVNPVVJDRV9TVFJFQU1FUiAoMTw8MTApCisjZGVmaW5lICAgTUlf
QkFUQ0hfUkVTT1VSQ0VfU1RSRUFNRVIgUkVHX0JJVCgxMCkKKyNkZWZpbmUgICBNSV9CQVRDSF9Q
UkVESUNBVEUgICAgICAgICBSRUdfQklUKDE1KSAvKiBIU1crIG9uIFJDUyBvbmx5Ki8KIAogLyoK
ICAqIDNEIGluc3RydWN0aW9ucyB1c2VkIGJ5IHRoZSBrZXJuZWwKQEAgLTIyNCw2ICsyMjUsNyBA
QAogI2RlZmluZSAgIFBJUEVfQ09OVFJPTF9DU19TVEFMTAkJCQkoMTw8MjApCiAjZGVmaW5lICAg
UElQRV9DT05UUk9MX1RMQl9JTlZBTElEQVRFCQkJKDE8PDE4KQogI2RlZmluZSAgIFBJUEVfQ09O
VFJPTF9NRURJQV9TVEFURV9DTEVBUgkJKDE8PDE2KQorI2RlZmluZSAgIFBJUEVfQ09OVFJPTF9X
UklURV9USU1FU1RBTVAJCQkoMzw8MTQpCiAjZGVmaW5lICAgUElQRV9DT05UUk9MX1FXX1dSSVRF
CQkJCSgxPDwxNCkKICNkZWZpbmUgICBQSVBFX0NPTlRST0xfUE9TVF9TWU5DX09QX01BU0sgICAg
ICAgICAgICAgICAgKDM8PDE0KQogI2RlZmluZSAgIFBJUEVfQ09OVFJPTF9ERVBUSF9TVEFMTAkJ
CSgxPDwxMykKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3R5
cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF90eXBlcy5oCmluZGV4IDgw
MmY1MTZhMzQzMC4uYmU0YjI2MzYyMWM4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9ndF90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2d0X3R5cGVzLmgKQEAgLTEwOSw2ICsxMDksMTEgQEAgZW51bSBpbnRlbF9ndF9zY3JhdGNoX2Zp
ZWxkIHsKIAkvKiA4IGJ5dGVzICovCiAJSU5URUxfR1RfU0NSQVRDSF9GSUVMRF9DT0hFUkVOVEwz
X1dBID0gMjU2LAogCisJLyogNiAqIDggYnl0ZXMgKi8KKwlJTlRFTF9HVF9TQ1JBVENIX0ZJRUxE
X1BFUkZfQ1NfR1BSID0gMjA0OCwKKworCS8qIDQgYnl0ZXMgKi8KKwlJTlRFTF9HVF9TQ1JBVENI
X0ZJRUxEX1BFUkZfUFJFRElDQVRFX1JFU1VMVF8xID0gMjA5NiwKIH07CiAKICNlbmRpZiAvKiBf
X0lOVEVMX0dUX1RZUEVTX0hfXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9kZWJ1Z2ZzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwppbmRl
eCAyNzdmMzEyOTdmMjkuLmQ0NjNhMjhiNzQ3NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1
Z2ZzLmMKQEAgLTM1OTAsNiArMzU5MCwzNyBAQCBERUZJTkVfU0lNUExFX0FUVFJJQlVURShpOTE1
X3dlZGdlZF9mb3BzLAogCQkJaTkxNV93ZWRnZWRfZ2V0LCBpOTE1X3dlZGdlZF9zZXQsCiAJCQki
JWxsdVxuIik7CiAKK3N0YXRpYyBpbnQKK2k5MTVfcGVyZl9ub2FfZGVsYXlfc2V0KHZvaWQgKmRh
dGEsIHU2NCB2YWwpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkYXRhOwor
CWNvbnN0IHUzMiBjbGsgPSBSVU5USU1FX0lORk8oaTkxNSktPmNzX3RpbWVzdGFtcF9mcmVxdWVu
Y3lfa2h6OworCisJLyoKKwkgKiBUaGlzIHdvdWxkIGxlYWQgdG8gaW5maW5pdGUgd2FpdHMgYXMg
d2UncmUgZG9pbmcgdGltZXN0YW1wCisJICogZGlmZmVyZW5jZSBvbiB0aGUgQ1Mgd2l0aCBvbmx5
IDMyYml0cy4KKwkgKi8KKwlpZiAodmFsID4gbXVsX3UzMl91MzIoVTMyX01BWCwgY2xrKSkKKwkJ
cmV0dXJuIC1FSU5WQUw7CisKKwlhdG9taWM2NF9zZXQoJmk5MTUtPnBlcmYubm9hX3Byb2dyYW1t
aW5nX2RlbGF5LCB2YWwpOworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50CitpOTE1X3BlcmZf
bm9hX2RlbGF5X2dldCh2b2lkICpkYXRhLCB1NjQgKnZhbCkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IGRhdGE7CisKKwkqdmFsID0gYXRvbWljNjRfcmVhZCgmaTkxNS0+cGVy
Zi5ub2FfcHJvZ3JhbW1pbmdfZGVsYXkpOworCXJldHVybiAwOworfQorCitERUZJTkVfU0lNUExF
X0FUVFJJQlVURShpOTE1X3BlcmZfbm9hX2RlbGF5X2ZvcHMsCisJCQlpOTE1X3BlcmZfbm9hX2Rl
bGF5X2dldCwKKwkJCWk5MTVfcGVyZl9ub2FfZGVsYXlfc2V0LAorCQkJIiVsbHVcbiIpOworCiAj
ZGVmaW5lIERST1BfVU5CT1VORAlCSVQoMCkKICNkZWZpbmUgRFJPUF9CT1VORAlCSVQoMSkKICNk
ZWZpbmUgRFJPUF9SRVRJUkUJQklUKDIpCkBAIC00MzQwLDYgKzQzNzEsNyBAQCBzdGF0aWMgY29u
c3Qgc3RydWN0IGk5MTVfZGVidWdmc19maWxlcyB7CiAJY29uc3QgY2hhciAqbmFtZTsKIAljb25z
dCBzdHJ1Y3QgZmlsZV9vcGVyYXRpb25zICpmb3BzOwogfSBpOTE1X2RlYnVnZnNfZmlsZXNbXSA9
IHsKKwl7Imk5MTVfcGVyZl9ub2FfZGVsYXkiLCAmaTkxNV9wZXJmX25vYV9kZWxheV9mb3BzfSwK
IAl7Imk5MTVfd2VkZ2VkIiwgJmk5MTVfd2VkZ2VkX2ZvcHN9LAogCXsiaTkxNV9jYWNoZV9zaGFy
aW5nIiwgJmk5MTVfY2FjaGVfc2hhcmluZ19mb3BzfSwKIAl7Imk5MTVfZ2VtX2Ryb3BfY2FjaGVz
IiwgJmk5MTVfZHJvcF9jYWNoZXNfZm9wc30sCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3BlcmYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5jCmluZGV4
IDVlMTRkZDZjNGM3OC4uNmJmMDJlNGM1ZjA5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3BlcmYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYwpA
QCAtMTk4LDYgKzE5OCw3IEBACiAjaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaCIKICNp
bmNsdWRlICJnZW0vaTkxNV9nZW1fcG0uaCIKICNpbmNsdWRlICJndC9pbnRlbF9lbmdpbmVfdXNl
ci5oIgorI2luY2x1ZGUgImd0L2ludGVsX2d0LmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfbHJjX3Jl
Zy5oIgogCiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKQEAgLTEzMzcsNiArMTMzOCwxMiBAQCBmcmVl
X29hX2J1ZmZlcihzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtKQogCXN0cmVhbS0+b2Ff
YnVmZmVyLnZhZGRyID0gTlVMTDsKIH0KIAorc3RhdGljIHZvaWQKK2ZyZWVfbm9hX3dhaXQoc3Ry
dWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSkKK3sKKwlpOTE1X3ZtYV91bnBpbl9hbmRfcmVs
ZWFzZSgmc3RyZWFtLT5ub2Ffd2FpdCwgMCk7Cit9CisKIHN0YXRpYyB2b2lkCiBmcmVlX29hX2Nv
bmZpZ3Moc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSkKIHsKQEAgLTEzNjQsNiArMTM3
MSw3IEBAIHN0YXRpYyB2b2lkIGk5MTVfb2Ffc3RyZWFtX2Rlc3Ryb3koc3RydWN0IGk5MTVfcGVy
Zl9zdHJlYW0gKnN0cmVhbSkKIAlwdXRfb2FfY29udGV4dChzdHJlYW0pOwogCiAJZnJlZV9vYV9j
b25maWdzKHN0cmVhbSk7CisJZnJlZV9ub2Ffd2FpdChzdHJlYW0pOwogCiAJaWYgKHBlcmYtPnNw
dXJpb3VzX3JlcG9ydF9ycy5taXNzZWQpIHsKIAkJRFJNX05PVEUoIiVkIHNwdXJpb3VzIE9BIHJl
cG9ydCBub3RpY2VzIHN1cHByZXNzZWQgZHVlIHRvIHJhdGVsaW1pdGluZ1xuIiwKQEAgLTE1MjQs
NiArMTUzMiwyMDUgQEAgc3RhdGljIGludCBhbGxvY19vYV9idWZmZXIoc3RydWN0IGk5MTVfcGVy
Zl9zdHJlYW0gKnN0cmVhbSkKIAlyZXR1cm4gcmV0OwogfQogCitzdGF0aWMgdTMyICpzYXZlX3Jl
c3RvcmVfcmVnaXN0ZXIoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSwgdTMyICpjcywK
KwkJCQkgIGJvb2wgc2F2ZSwgaTkxNV9yZWdfdCByZWcsIHUzMiBvZmZzZXQsCisJCQkJICB1MzIg
ZHdvcmRfY291bnQpCit7CisJdTMyIGNtZDsKKwl1MzIgZDsKKworCWNtZCA9IHNhdmUgPyBNSV9T
VE9SRV9SRUdJU1RFUl9NRU0gOiBNSV9MT0FEX1JFR0lTVEVSX01FTTsKKwlpZiAoSU5URUxfR0VO
KHN0cmVhbS0+cGVyZi0+aTkxNSkgPj0gOCkKKwkJY21kKys7CisKKwlmb3IgKGQgPSAwOyBkIDwg
ZHdvcmRfY291bnQ7IGQrKykgeworCQkqY3MrKyA9IGNtZDsKKwkJKmNzKysgPSBpOTE1X21taW9f
cmVnX29mZnNldChyZWcpICsgNCAqIGQ7CisJCSpjcysrID0gaW50ZWxfZ3Rfc2NyYXRjaF9vZmZz
ZXQoc3RyZWFtLT5ndCwgb2Zmc2V0KSArIDQgKiBkOworCQkqY3MrKyA9IDA7CisJfQorCisJcmV0
dXJuIGNzOworfQorCitzdGF0aWMgaW50IGFsbG9jX25vYV93YWl0KHN0cnVjdCBpOTE1X3BlcmZf
c3RyZWFtICpzdHJlYW0pCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBzdHJl
YW0tPnBlcmYtPmk5MTU7CisJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKmJvOworCXN0cnVj
dCBpOTE1X3ZtYSAqdm1hOworCWNvbnN0IHU2NCBkZWxheV90aWNrcyA9IDB4ZmZmZmZmZmZmZmZm
ZmZmZiAtCisJCURJVjY0X1U2NF9ST1VORF9VUCgKKwkJCWF0b21pYzY0X3JlYWQoJnN0cmVhbS0+
cGVyZi0+bm9hX3Byb2dyYW1taW5nX2RlbGF5KSAqCisJCQlSVU5USU1FX0lORk8oaTkxNSktPmNz
X3RpbWVzdGFtcF9mcmVxdWVuY3lfa2h6LAorCQkJMTAwMDAwMHVsbCk7CisJY29uc3QgdTMyIGJh
c2UgPSBzdHJlYW0tPmVuZ2luZS0+bW1pb19iYXNlOworI2RlZmluZSBDU19HUFIoeCkgR0VOOF9S
SU5HX0NTX0dQUihiYXNlLCB4KQorCXUzMiAqYmF0Y2gsICp0czAsICpjcywgKmp1bXA7CisJaW50
IHJldCwgaTsKKwllbnVtIHsKKwkJU1RBUlRfVFMsCisJCU5PV19UUywKKwkJREVMVEFfVFMsCisJ
CUpVTVBfUFJFRElDQVRFLAorCQlERUxUQV9UQVJHRVQsCisJCU5fQ1NfR1BSCisJfTsKKworCWJv
ID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5hbChpOTE1LCA0MDk2KTsKKwlpZiAoSVNf
RVJSKGJvKSkgeworCQlEUk1fRVJST1IoIkZhaWxlZCB0byBhbGxvY2F0ZSBOT0Egd2FpdCBiYXRj
aGJ1ZmZlclxuIik7CisJCXJldHVybiBQVFJfRVJSKGJvKTsKKwl9CisKKwkvKgorCSAqIFdlIHBp
biBpbiBHR1RUIGJlY2F1c2Ugd2UganVtcCBpbnRvIHRoaXMgYnVmZmVyIG5vdyBiZWNhdXNlCisJ
ICogbXVsdGlwbGUgT0EgY29uZmlnIEJPcyB3aWxsIGhhdmUgYSBqdW1wIHRvIHRoaXMgYWRkcmVz
cyBhbmQgaXQKKwkgKiBuZWVkcyB0byBiZSBmaXhlZCBkdXJpbmcgdGhlIGxpZmV0aW1lIG9mIHRo
ZSBpOTE1L3BlcmYgc3RyZWFtLgorCSAqLworCXZtYSA9IGk5MTVfZ2VtX29iamVjdF9nZ3R0X3Bp
bihibywgTlVMTCwgMCwgMCwgUElOX0hJR0gpOworCWlmIChJU19FUlIodm1hKSkgeworCQlyZXQg
PSBQVFJfRVJSKHZtYSk7CisJCWdvdG8gZXJyX3VucmVmOworCX0KKworCWJhdGNoID0gY3MgPSBp
OTE1X2dlbV9vYmplY3RfcGluX21hcChibywgSTkxNV9NQVBfV0IpOworCWlmIChJU19FUlIoYmF0
Y2gpKSB7CisJCXJldCA9IFBUUl9FUlIoYmF0Y2gpOworCQlnb3RvIGVycl91bnBpbjsKKwl9CisK
KwkvKiBTYXZlIHJlZ2lzdGVycy4gKi8KKwlmb3IgKGkgPSAwOyBpIDwgTl9DU19HUFI7IGkrKykK
KwkJY3MgPSBzYXZlX3Jlc3RvcmVfcmVnaXN0ZXIoCisJCQlzdHJlYW0sIGNzLCB0cnVlIC8qIHNh
dmUgKi8sIENTX0dQUihpKSwKKwkJCUlOVEVMX0dUX1NDUkFUQ0hfRklFTERfUEVSRl9DU19HUFIg
KyA4ICogaSwgMik7CisJY3MgPSBzYXZlX3Jlc3RvcmVfcmVnaXN0ZXIoCisJCXN0cmVhbSwgY3Ms
IHRydWUgLyogc2F2ZSAqLywgTUlfUFJFRElDQVRFX1JFU1VMVF8xLAorCQlJTlRFTF9HVF9TQ1JB
VENIX0ZJRUxEX1BFUkZfUFJFRElDQVRFX1JFU1VMVF8xLCAxKTsKKworCS8qIEZpcnN0IHRpbWVz
dGFtcCBzbmFwc2hvdCBsb2NhdGlvbi4gKi8KKwl0czAgPSBjczsKKworCS8qCisJICogSW5pdGlh
bCBzbmFwc2hvdCBvZiB0aGUgdGltZXN0YW1wIHJlZ2lzdGVyIHRvIGltcGxlbWVudCB0aGUgd2Fp
dC4KKwkgKiBXZSB3b3JrIHdpdGggMzJiIHZhbHVlcywgc28gY2xlYXIgb3V0IHRoZSB0b3AgMzJi
IGJpdHMgb2YgdGhlCisJICogcmVnaXN0ZXIgYmVjYXVzZSB0aGUgQUxVIHdvcmtzIDY0Yml0cy4K
KwkgKi8KKwkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKDEpOworCSpjcysrID0gaTkxNV9t
bWlvX3JlZ19vZmZzZXQoQ1NfR1BSKFNUQVJUX1RTKSkgKyA0OworCSpjcysrID0gMDsKKwkqY3Mr
KyA9IE1JX0xPQURfUkVHSVNURVJfUkVHIHwgKDMgLSAyKTsKKwkqY3MrKyA9IGk5MTVfbW1pb19y
ZWdfb2Zmc2V0KFJJTkdfVElNRVNUQU1QKGJhc2UpKTsKKwkqY3MrKyA9IGk5MTVfbW1pb19yZWdf
b2Zmc2V0KENTX0dQUihTVEFSVF9UUykpOworCisJLyoKKwkgKiBUaGlzIGlzIHRoZSBsb2NhdGlv
biB3ZSdyZSBnb2luZyB0byBqdW1wIGJhY2sgaW50byB1bnRpbCB0aGUKKwkgKiByZXF1aXJlZCBh
bW91bnQgb2YgdGltZSBoYXMgcGFzc2VkLgorCSAqLworCWp1bXAgPSBjczsKKworCS8qCisJICog
VGFrZSBhbm90aGVyIHNuYXBzaG90IG9mIHRoZSB0aW1lc3RhbXAgcmVnaXN0ZXIuIFRha2UgY2Fy
ZSB0byBjbGVhcgorCSAqIHVwIHRoZSB0b3AgMzJiaXRzIG9mIENTX0dQUigxKSBhcyB3ZSdyZSB1
c2luZyBpdCBmb3Igb3RoZXIKKwkgKiBvcGVyYXRpb25zIGJlbG93LgorCSAqLworCSpjcysrID0g
TUlfTE9BRF9SRUdJU1RFUl9JTU0oMSk7CisJKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChD
U19HUFIoTk9XX1RTKSkgKyA0OworCSpjcysrID0gMDsKKwkqY3MrKyA9IE1JX0xPQURfUkVHSVNU
RVJfUkVHIHwgKDMgLSAyKTsKKwkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfVElN
RVNUQU1QKGJhc2UpKTsKKwkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KENTX0dQUihOT1df
VFMpKTsKKworCS8qCisJICogRG8gYSBkaWZmIGJldHdlZW4gdGhlIDIgdGltZXN0YW1wcyBhbmQg
c3RvcmUgdGhlIHJlc3VsdCBiYWNrIGludG8KKwkgKiBDU19HUFIoMSkuCisJICovCisJKmNzKysg
PSBNSV9NQVRIKDUpOworCSpjcysrID0gTUlfTUFUSF9MT0FEKE1JX01BVEhfUkVHX1NSQ0EsIE1J
X01BVEhfUkVHKE5PV19UUykpOworCSpjcysrID0gTUlfTUFUSF9MT0FEKE1JX01BVEhfUkVHX1NS
Q0IsIE1JX01BVEhfUkVHKFNUQVJUX1RTKSk7CisJKmNzKysgPSBNSV9NQVRIX1NVQjsKKwkqY3Mr
KyA9IE1JX01BVEhfU1RPUkUoTUlfTUFUSF9SRUcoREVMVEFfVFMpLCBNSV9NQVRIX1JFR19BQ0NV
KTsKKwkqY3MrKyA9IE1JX01BVEhfU1RPUkUoTUlfTUFUSF9SRUcoSlVNUF9QUkVESUNBVEUpLCBN
SV9NQVRIX1JFR19DRik7CisKKwkvKgorCSAqIFRyYW5zZmVyIHRoZSBjYXJyeSBmbGFnIChzZXQg
dG8gMSBpZiB0czEgPCB0czAsIG1lYW5pbmcgdGhlCisJICogdGltZXN0YW1wIGhhdmUgcm9sbGVk
IG92ZXIgdGhlIDMyYml0cykgaW50byB0aGUgcHJlZGljYXRlIHJlZ2lzdGVyCisJICogdG8gYmUg
dXNlZCBmb3IgdGhlIHByZWRpY2F0ZWQganVtcC4KKwkgKi8KKwkqY3MrKyA9IE1JX0xPQURfUkVH
SVNURVJfUkVHIHwgKDMgLSAyKTsKKwkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KENTX0dQ
UihKVU1QX1BSRURJQ0FURSkpOworCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoTUlfUFJF
RElDQVRFX1JFU1VMVF8xKTsKKworCS8qIFJlc3RhcnQgZnJvbSB0aGUgYmVnaW5uaW5nIGlmIHdl
IGhhZCB0aW1lc3RhbXBzIHJvbGwgb3Zlci4gKi8KKwkqY3MrKyA9IChJTlRFTF9HRU4oaTkxNSkg
PCA4ID8KKwkJIE1JX0JBVENIX0JVRkZFUl9TVEFSVCA6CisJCSBNSV9CQVRDSF9CVUZGRVJfU1RB
UlRfR0VOOCkgfAorCQlNSV9CQVRDSF9QUkVESUNBVEU7CisJKmNzKysgPSBpOTE1X2dndHRfb2Zm
c2V0KHZtYSkgKyAodHMwIC0gYmF0Y2gpICogNDsKKwkqY3MrKyA9IDA7CisKKwkvKgorCSAqIE5v
dyBhZGQgdGhlIGRpZmYgYmV0d2VlbiB0byBwcmV2aW91cyB0aW1lc3RhbXBzIGFuZCBhZGQgaXQg
dG8gOgorCSAqICAgICAgKCgoMSAqIDw8IDY0KSAtIDEpIC0gZGVsYXlfbnMpCisJICoKKwkgKiBX
aGVuIHRoZSBDYXJyeSBGbGFnIGNvbnRhaW5zIDEgdGhpcyBtZWFucyB0aGUgZWxhcHNlZCB0aW1l
IGlzCisJICogbG9uZ2VyIHRoYW4gdGhlIGV4cGVjdGVkIGRlbGF5LCBhbmQgd2UgY2FuIGV4aXQg
dGhlIHdhaXQgbG9vcC4KKwkgKi8KKwkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKDIpOwor
CSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoQ1NfR1BSKERFTFRBX1RBUkdFVCkpOworCSpj
cysrID0gbG93ZXJfMzJfYml0cyhkZWxheV90aWNrcyk7CisJKmNzKysgPSBpOTE1X21taW9fcmVn
X29mZnNldChDU19HUFIoREVMVEFfVEFSR0VUKSkgKyA0OworCSpjcysrID0gdXBwZXJfMzJfYml0
cyhkZWxheV90aWNrcyk7CisKKwkqY3MrKyA9IE1JX01BVEgoNCk7CisJKmNzKysgPSBNSV9NQVRI
X0xPQUQoTUlfTUFUSF9SRUdfU1JDQSwgTUlfTUFUSF9SRUcoREVMVEFfVFMpKTsKKwkqY3MrKyA9
IE1JX01BVEhfTE9BRChNSV9NQVRIX1JFR19TUkNCLCBNSV9NQVRIX1JFRyhERUxUQV9UQVJHRVQp
KTsKKwkqY3MrKyA9IE1JX01BVEhfQUREOworCSpjcysrID0gTUlfTUFUSF9TVE9SRUlOVihNSV9N
QVRIX1JFRyhKVU1QX1BSRURJQ0FURSksIE1JX01BVEhfUkVHX0NGKTsKKworCS8qCisJICogVHJh
bnNmZXIgdGhlIHJlc3VsdCBpbnRvIHRoZSBwcmVkaWNhdGUgcmVnaXN0ZXIgdG8gYmUgdXNlZCBm
b3IgdGhlCisJICogcHJlZGljYXRlZCBqdW1wLgorCSAqLworCSpjcysrID0gTUlfTE9BRF9SRUdJ
U1RFUl9SRUcgfCAoMyAtIDIpOworCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoQ1NfR1BS
KEpVTVBfUFJFRElDQVRFKSk7CisJKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChNSV9QUkVE
SUNBVEVfUkVTVUxUXzEpOworCisJLyogUHJlZGljYXRlIHRoZSBqdW1wLiAgKi8KKwkqY3MrKyA9
IChJTlRFTF9HRU4oaTkxNSkgPCA4ID8KKwkJIE1JX0JBVENIX0JVRkZFUl9TVEFSVCA6CisJCSBN
SV9CQVRDSF9CVUZGRVJfU1RBUlRfR0VOOCkgfAorCQlNSV9CQVRDSF9QUkVESUNBVEU7CisJKmNz
KysgPSBpOTE1X2dndHRfb2Zmc2V0KHZtYSkgKyAoanVtcCAtIGJhdGNoKSAqIDQ7CisJKmNzKysg
PSAwOworCisJLyogUmVzdG9yZSByZWdpc3RlcnMuICovCisJZm9yIChpID0gMDsgaSA8IE5fQ1Nf
R1BSOyBpKyspCisJCWNzID0gc2F2ZV9yZXN0b3JlX3JlZ2lzdGVyKAorCQkJc3RyZWFtLCBjcywg
ZmFsc2UgLyogcmVzdG9yZSAqLywgQ1NfR1BSKGkpLAorCQkJSU5URUxfR1RfU0NSQVRDSF9GSUVM
RF9QRVJGX0NTX0dQUiArIDggKiBpLCAyKTsKKwljcyA9IHNhdmVfcmVzdG9yZV9yZWdpc3RlcigK
KwkJc3RyZWFtLCBjcywgZmFsc2UgLyogcmVzdG9yZSAqLywgTUlfUFJFRElDQVRFX1JFU1VMVF8x
LAorCQlJTlRFTF9HVF9TQ1JBVENIX0ZJRUxEX1BFUkZfUFJFRElDQVRFX1JFU1VMVF8xLCAxKTsK
KworCS8qIEFuZCByZXR1cm4gdG8gdGhlIHJpbmcuICovCisJKmNzKysgPSBNSV9CQVRDSF9CVUZG
RVJfRU5EOworCisJR0VNX0JVR19PTihjcyAtIGJhdGNoID4gUEFHRV9TSVpFIC8gc2l6ZW9mKCpi
YXRjaCkpOworCisJaTkxNV9nZW1fb2JqZWN0X2ZsdXNoX21hcChibyk7CisJaTkxNV9nZW1fb2Jq
ZWN0X3VucGluX21hcChibyk7CisKKwlzdHJlYW0tPm5vYV93YWl0ID0gdm1hOworCXJldHVybiAw
OworCitlcnJfdW5waW46CisJX19pOTE1X3ZtYV91bnBpbih2bWEpOworZXJyX3VucmVmOgorCWk5
MTVfZ2VtX29iamVjdF9wdXQoYm8pOworCXJldHVybiByZXQ7Cit9CisKIHN0YXRpYyB2b2lkIGNv
bmZpZ19vYV9yZWdzKHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSwKIAkJCSAgIGNvbnN0IHN0
cnVjdCBpOTE1X29hX3JlZyAqcmVncywKIAkJCSAgIHUzMiBuX3JlZ3MpCkBAIC0yMjAwLDYgKzI0
MDcsMTIgQEAgc3RhdGljIGludCBpOTE1X29hX3N0cmVhbV9pbml0KHN0cnVjdCBpOTE1X3BlcmZf
c3RyZWFtICpzdHJlYW0sCiAJCX0KIAl9CiAKKwlyZXQgPSBhbGxvY19ub2Ffd2FpdChzdHJlYW0p
OworCWlmIChyZXQpIHsKKwkJRFJNX0RFQlVHKCJVbmFibGUgdG8gYWxsb2NhdGUgTk9BIHdhaXQg
YmF0Y2ggYnVmZmVyXG4iKTsKKwkJZ290byBlcnJfbm9hX3dhaXRfYWxsb2M7CisJfQorCiAJc3Ry
ZWFtLT5vYV9jb25maWcgPSBpOTE1X3BlcmZfZ2V0X29hX2NvbmZpZyhwZXJmLCBwcm9wcy0+bWV0
cmljc19zZXQpOwogCWlmICghc3RyZWFtLT5vYV9jb25maWcpIHsKIAkJRFJNX0RFQlVHKCJJbnZh
bGlkIE9BIGNvbmZpZyBpZD0laVxuIiwgcHJvcHMtPm1ldHJpY3Nfc2V0KTsKQEAgLTIyNDEsNiAr
MjQ1NCw5IEBAIHN0YXRpYyBpbnQgaTkxNV9vYV9zdHJlYW1faW5pdChzdHJ1Y3QgaTkxNV9wZXJm
X3N0cmVhbSAqc3RyZWFtLAogCWZyZWVfb2FfY29uZmlncyhzdHJlYW0pOwogCiBlcnJfY29uZmln
OgorCWZyZWVfbm9hX3dhaXQoc3RyZWFtKTsKKworZXJyX25vYV93YWl0X2FsbG9jOgogCXB1dF9v
YV9jb250ZXh0KHN0cmVhbSk7CiAKIAlyZXR1cm4gcmV0OwpAQCAtMzY0Miw2ICszODU4LDkgQEAg
dm9pZCBpOTE1X3BlcmZfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkJcmF0
ZWxpbWl0X3NldF9mbGFncygmcGVyZi0+c3B1cmlvdXNfcmVwb3J0X3JzLAogCQkJCSAgICBSQVRF
TElNSVRfTVNHX09OX1JFTEVBU0UpOwogCisJCWF0b21pYzY0X3NldCgmcGVyZi0+bm9hX3Byb2dy
YW1taW5nX2RlbGF5LAorCQkJICAgICA1MDAgKiAxMDAwIC8qIDUwMHVzICovKTsKKwogCQlwZXJm
LT5pOTE1ID0gaTkxNTsKIAl9CiB9CkBAIC0zNjgxLDMgKzM5MDAsNyBAQCBpbnQgaTkxNV9wZXJm
X2lvY3RsX3ZlcnNpb24odm9pZCkKIHsKIAlyZXR1cm4gMTsKIH0KKworI2lmIElTX0VOQUJMRUQo
Q09ORklHX0RSTV9JOTE1X1NFTEZURVNUKQorI2luY2x1ZGUgInNlbGZ0ZXN0cy9pOTE1X3BlcmYu
YyIKKyNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmX3R5
cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmZfdHlwZXMuaAppbmRleCBiMWI3
YzhkMDRmNTAuLjUzZGE4Njc2YjA2OCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9wZXJmX3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmX3R5
cGVzLmgKQEAgLTI2OCw2ICsyNjgsMTIgQEAgc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gewogCQkg
Ki8KIAkJdTMyIGhlYWQ7CiAJfSBvYV9idWZmZXI7CisKKwkvKioKKwkgKiBBIGJhdGNoIGJ1ZmZl
ciBkb2luZyBhIHdhaXQgb24gdGhlIEdQVSBmb3IgdGhlIE5PQSBsb2dpYyB0byBiZQorCSAqIHJl
cHJvZ3JhbW1lZC4KKwkgKi8KKwlzdHJ1Y3QgaTkxNV92bWEgKm5vYV93YWl0OwogfTsKIAogLyoq
CkBAIC0zODcsNiArMzkzLDggQEAgc3RydWN0IGk5MTVfcGVyZiB7CiAKIAlzdHJ1Y3QgaTkxNV9v
YV9vcHMgb3BzOwogCWNvbnN0IHN0cnVjdCBpOTE1X29hX2Zvcm1hdCAqb2FfZm9ybWF0czsKKwor
CWF0b21pYzY0X3Qgbm9hX3Byb2dyYW1taW5nX2RlbGF5OwogfTsKIAogI2VuZGlmIC8qIF9JOTE1
X1BFUkZfVFlQRVNfSF8gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
cmVnLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlZy5oCmluZGV4IDFkYzA2N2ZjNTdh
Yi4uOTlmOGEwOGRjMmIyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3Jl
Zy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVnLmgKQEAgLTU0NSw3ICs1NDUs
OSBAQCBzdGF0aWMgaW5saW5lIGJvb2wgaTkxNV9tbWlvX3JlZ192YWxpZChpOTE1X3JlZ190IHJl
ZykKICNkZWZpbmUgTUlfUFJFRElDQVRFX1NSQzBfVURXCV9NTUlPKDB4MjQwMCArIDQpCiAjZGVm
aW5lIE1JX1BSRURJQ0FURV9TUkMxCV9NTUlPKDB4MjQwOCkKICNkZWZpbmUgTUlfUFJFRElDQVRF
X1NSQzFfVURXCV9NTUlPKDB4MjQwOCArIDQpCi0KKyNkZWZpbmUgTUlfUFJFRElDQVRFX0RBVEEg
ICAgICAgX01NSU8oMHgyNDEwKQorI2RlZmluZSBNSV9QUkVESUNBVEVfUkVTVUxUICAgICBfTU1J
TygweDI0MTgpCisjZGVmaW5lIE1JX1BSRURJQ0FURV9SRVNVTFRfMSAgIF9NTUlPKDB4MjQxYykK
ICNkZWZpbmUgTUlfUFJFRElDQVRFX1JFU1VMVF8yCV9NTUlPKDB4MjIxNCkKICNkZWZpbmUgIExP
V0VSX1NMSUNFX0VOQUJMRUQJKDEgPDwgMCkKICNkZWZpbmUgIExPV0VSX1NMSUNFX0RJU0FCTEVE
CSgwIDw8IDApCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkx
NV9saXZlX3NlbGZ0ZXN0cy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVf
bGl2ZV9zZWxmdGVzdHMuaAppbmRleCA2NzEzZWZlYTM1MGIuLjZkYWY2NTk5ZWM3OSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfbGl2ZV9zZWxmdGVzdHMu
aAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9saXZlX3NlbGZ0ZXN0
cy5oCkBAIC0zNSwzICszNSw0IEBAIHNlbGZ0ZXN0KHJlc2V0LCBpbnRlbF9yZXNldF9saXZlX3Nl
bGZ0ZXN0cykKIHNlbGZ0ZXN0KGhhbmdjaGVjaywgaW50ZWxfaGFuZ2NoZWNrX2xpdmVfc2VsZnRl
c3RzKQogc2VsZnRlc3QoZXhlY2xpc3RzLCBpbnRlbF9leGVjbGlzdHNfbGl2ZV9zZWxmdGVzdHMp
CiBzZWxmdGVzdChndWMsIGludGVsX2d1Y19saXZlX3NlbGZ0ZXN0KQorc2VsZnRlc3QocGVyZiwg
aTkxNV9wZXJmX2xpdmVfc2VsZnRlc3RzKQotLSAKMi4yMy4wCgpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVs
LWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcv
bWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

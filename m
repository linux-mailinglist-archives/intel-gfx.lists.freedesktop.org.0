Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 5BB78347BA
	for <lists+intel-gfx@lfdr.de>; Tue,  4 Jun 2019 15:11:55 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8EF0C89842;
	Tue,  4 Jun 2019 13:11:53 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga17.intel.com (mga17.intel.com [192.55.52.151])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4C15389830
 for <intel-gfx@lists.freedesktop.org>; Tue,  4 Jun 2019 13:11:52 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga003.fm.intel.com ([10.253.24.29])
 by fmsmga107.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 04 Jun 2019 06:11:52 -0700
X-ExtLoop1: 1
Received: from bblokx-mobl.ger.corp.intel.com (HELO delly.ger.corp.intel.com)
 ([10.249.139.199])
 by FMSMGA003.fm.intel.com with ESMTP; 04 Jun 2019 06:11:50 -0700
From: Lionel Landwerlin <lionel.g.landwerlin@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Tue,  4 Jun 2019 16:11:37 +0300
Message-Id: <20190604131140.12647-5-lionel.g.landwerlin@intel.com>
X-Mailer: git-send-email 2.21.0.392.gf8f6787159e
In-Reply-To: <20190604131140.12647-1-lionel.g.landwerlin@intel.com>
References: <20190604131140.12647-1-lionel.g.landwerlin@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v3 4/7] drm/i915: add syncobj timeline support
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

SW50cm9kdWNlcyBhIG5ldyBwYXJhbWV0ZXJzIHRvIGV4ZWNidWYgc28gdGhhdCB3ZSBjYW4gc3Bl
Y2lmeSBzeW5jb2JqCmhhbmRsZXMgYXMgd2VsbCBhcyB0aW1lbGluZSBwb2ludHMuCgpTaWduZWQt
b2ZmLWJ5OiBMaW9uZWwgTGFuZHdlcmxpbiA8bGlvbmVsLmcubGFuZHdlcmxpbkBpbnRlbC5jb20+
Ci0tLQogLi4uL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jICAgIHwgMjcw
ICsrKysrKysrKysrKysrLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYyAgICAg
ICAgICAgICAgIHwgICA0ICstCiBpbmNsdWRlL3VhcGkvZHJtL2k5MTVfZHJtLmggICAgICAgICAg
ICAgICAgICAgfCAgMzcgKysrCiAzIGZpbGVzIGNoYW5nZWQsIDI1NSBpbnNlcnRpb25zKCspLCA1
NiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fZXhlY2J1ZmZlci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4
ZWNidWZmZXIuYwppbmRleCA0ODBlMjAwNDNkODAuLjAyZGM1NDgwZThmZSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jCkBAIC0yMTAsNiArMjEw
LDEzIEBAIGVudW0gewogICogdGhlIGJhdGNoYnVmZmVyIGluIHRydXN0ZWQgbW9kZSwgb3RoZXJ3
aXNlIHRoZSBpb2N0bCBpcyByZWplY3RlZC4KICAqLwogCitzdHJ1Y3QgaTkxNV9kcm1fZG1hX2Zl
bmNlcyB7CisJc3RydWN0IGRybV9zeW5jb2JqICpzeW5jb2JqOyAvKiBVc2Ugd2l0aCBwdHJfbWFz
a19iaXRzKCkgKi8KKwlzdHJ1Y3QgZG1hX2ZlbmNlICpkbWFfZmVuY2U7CisJdTY0IHZhbHVlOwor
CXN0cnVjdCBkbWFfZmVuY2VfY2hhaW4gKmNoYWluX2ZlbmNlOworfTsKKwogc3RydWN0IGk5MTVf
ZXhlY2J1ZmZlciB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTU7IC8qKiBpOTE1IGJh
Y2twb2ludGVyICovCiAJc3RydWN0IGRybV9maWxlICpmaWxlOyAvKiogcGVyLWZpbGUgbG9va3Vw
IHRhYmxlcyBhbmQgbGltaXRzICovCkBAIC0yNzIsNiArMjc5LDcgQEAgc3RydWN0IGk5MTVfZXhl
Y2J1ZmZlciB7CiAKIAlzdHJ1Y3QgewogCQl1NjQgZmxhZ3M7IC8qKiBBdmFpbGFibGUgZXh0ZW5z
aW9ucyBwYXJhbWV0ZXJzICovCisJCXN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY190aW1lbGluZV9m
ZW5jZXMgdGltZWxpbmVfZmVuY2VzOwogCX0gZXh0ZW5zaW9uczsKIH07CiAKQEAgLTIyMTIsNjcg
KzIyMjAsMjAzIEBAIGViX3NlbGVjdF9lbmdpbmUoc3RydWN0IGk5MTVfZXhlY2J1ZmZlciAqZWIs
CiB9CiAKIHN0YXRpYyB2b2lkCi1fX2ZyZWVfZmVuY2VfYXJyYXkoc3RydWN0IGRybV9zeW5jb2Jq
ICoqZmVuY2VzLCB1bnNpZ25lZCBpbnQgbikKK19fZnJlZV9mZW5jZV9hcnJheShzdHJ1Y3QgaTkx
NV9kcm1fZG1hX2ZlbmNlcyAqZmVuY2VzLCB1bnNpZ25lZCBpbnQgbikKIHsKLQl3aGlsZSAobi0t
KQotCQlkcm1fc3luY29ial9wdXQocHRyX21hc2tfYml0cyhmZW5jZXNbbl0sIDIpKTsKKwl3aGls
ZSAobi0tKSB7CisJCWRybV9zeW5jb2JqX3B1dChwdHJfbWFza19iaXRzKGZlbmNlc1tuXS5zeW5j
b2JqLCAyKSk7CisJCWRtYV9mZW5jZV9wdXQoZmVuY2VzW25dLmRtYV9mZW5jZSk7CisJCWtmcmVl
KGZlbmNlc1tuXS5jaGFpbl9mZW5jZSk7CisJfQogCWt2ZnJlZShmZW5jZXMpOwogfQogCi1zdGF0
aWMgc3RydWN0IGRybV9zeW5jb2JqICoqCitzdGF0aWMgc3RydWN0IGk5MTVfZHJtX2RtYV9mZW5j
ZXMgKgorZ2V0X3RpbWVsaW5lX2ZlbmNlX2FycmF5KHN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY2J1
ZmZlcjIgKmFyZ3MsCisJCQkgc3RydWN0IGRybV9pOTE1X2dlbV9leGVjX3RpbWVsaW5lX2ZlbmNl
cyAqdGltZWxpbmVfZmVuY2VzLAorCQkJIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSwKKwkJCSBpbnQg
Km91dF9uX2ZlbmNlcykKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNfZmVuY2UgX191c2Vy
ICp1c2VyX2ZlbmNlczsKKwlzdHJ1Y3QgaTkxNV9kcm1fZG1hX2ZlbmNlcyAqZmVuY2VzOworCXU2
NCBfX3VzZXIgKnVzZXJfdmFsdWVzOworCXVuc2lnbmVkIGxvbmcgbjsKKwlpbnQgZXJyOworCisJ
Km91dF9uX2ZlbmNlcyA9IHRpbWVsaW5lX2ZlbmNlcy0+aGFuZGxlX2NvdW50OworCisJLyogSW5j
b21wYXRpYmxlIHdpdGggSTkxNV9FWEVDX0ZFTkNFX0FSUkFZLiAqLworCWlmIChhcmdzLT5mbGFn
cyAmIEk5MTVfRVhFQ19GRU5DRV9BUlJBWSkKKwkJcmV0dXJuIEVSUl9QVFIoLUVJTlZBTCk7CisK
KwkvKiBDaGVjayBtdWx0aXBsaWNhdGlvbiBvdmVyZmxvdyBmb3IgYWNjZXNzX29rKCkgYW5kIGt2
bWFsbG9jX2FycmF5KCkgKi8KKwlCVUlMRF9CVUdfT04oc2l6ZW9mKHNpemVfdCkgPiBzaXplb2Yo
dW5zaWduZWQgbG9uZykpOworCWlmICgqb3V0X25fZmVuY2VzID4gbWluX3QodW5zaWduZWQgbG9u
ZywKKwkJCQkgIFVMT05HX01BWCAvIHNpemVvZigqdXNlcl9mZW5jZXMpLAorCQkJCSAgU0laRV9N
QVggLyBzaXplb2YoKmZlbmNlcykpKQorCQlyZXR1cm4gRVJSX1BUUigtRUlOVkFMKTsKKworCXVz
ZXJfZmVuY2VzID0gdTY0X3RvX3VzZXJfcHRyKHRpbWVsaW5lX2ZlbmNlcy0+aGFuZGxlc19wdHIp
OworCWlmICghYWNjZXNzX29rKHVzZXJfZmVuY2VzLCAqb3V0X25fZmVuY2VzICogc2l6ZW9mKCp1
c2VyX2ZlbmNlcykpKQorCQlyZXR1cm4gRVJSX1BUUigtRUZBVUxUKTsKKworCXVzZXJfdmFsdWVz
ID0gdTY0X3RvX3VzZXJfcHRyKHRpbWVsaW5lX2ZlbmNlcy0+dmFsdWVzX3B0cik7CisJaWYgKCFh
Y2Nlc3Nfb2sodXNlcl92YWx1ZXMsICpvdXRfbl9mZW5jZXMgKiBzaXplb2YoKnVzZXJfdmFsdWVz
KSkpCisJCXJldHVybiBFUlJfUFRSKC1FRkFVTFQpOworCisJZmVuY2VzID0ga3ZtYWxsb2NfYXJy
YXkoKm91dF9uX2ZlbmNlcywgc2l6ZW9mKCpmZW5jZXMpLAorCQkJCV9fR0ZQX05PV0FSTiB8IEdG
UF9LRVJORUwpOworCWlmICghZmVuY2VzKQorCQlyZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKKwor
CUJVSUxEX0JVR19PTih+KEFSQ0hfS01BTExPQ19NSU5BTElHTiAtIDEpICYKKwkJICAgICB+X19J
OTE1X0VYRUNfRkVOQ0VfVU5LTk9XTl9GTEFHUyk7CisKKwlmb3IgKG4gPSAwOyBuIDwgKm91dF9u
X2ZlbmNlczsgbisrKSB7CisJCXN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY19mZW5jZSB1c2VyX2Zl
bmNlOworCQlzdHJ1Y3QgZHJtX3N5bmNvYmogKnN5bmNvYmo7CisJCXN0cnVjdCBkbWFfZmVuY2Ug
KmZlbmNlID0gTlVMTDsKKwkJdTY0IHBvaW50OworCisJCWlmIChfX2NvcHlfZnJvbV91c2VyKCZ1
c2VyX2ZlbmNlLCB1c2VyX2ZlbmNlcysrLCBzaXplb2YodXNlcl9mZW5jZSkpKSB7CisJCQllcnIg
PSAtRUZBVUxUOworCQkJZ290byBlcnI7CisJCX0KKworCQlpZiAodXNlcl9mZW5jZS5mbGFncyAm
IF9fSTkxNV9FWEVDX0ZFTkNFX1VOS05PV05fRkxBR1MpIHsKKwkJCWVyciA9IC1FSU5WQUw7CisJ
CQlnb3RvIGVycjsKKwkJfQorCisJCWlmIChfX2dldF91c2VyKHBvaW50LCB1c2VyX3ZhbHVlcysr
KSkgeworCQkJZXJyID0gLUVGQVVMVDsKKwkJCWdvdG8gZXJyOworCQl9CisKKwkJc3luY29iaiA9
IGRybV9zeW5jb2JqX2ZpbmQoZmlsZSwgdXNlcl9mZW5jZS5oYW5kbGUpOworCQlpZiAoIXN5bmNv
YmopIHsKKwkJCURSTV9ERUJVRygiSW52YWxpZCBzeW5jb2JqIGhhbmRsZSBwcm92aWRlZFxuIik7
CisJCQllcnIgPSAtRUlOVkFMOworCQkJZ290byBlcnI7CisJCX0KKworCQlpZiAodXNlcl9mZW5j
ZS5mbGFncyAmIEk5MTVfRVhFQ19GRU5DRV9XQUlUKSB7CisJCQlmZW5jZSA9IGRybV9zeW5jb2Jq
X2ZlbmNlX2dldChzeW5jb2JqKTsKKwkJCWlmICghZmVuY2UpIHsKKwkJCQlEUk1fREVCVUcoIlN5
bmNvYmogaGFuZGxlIGhhcyBubyBmZW5jZVxuIik7CisJCQkJZHJtX3N5bmNvYmpfcHV0KHN5bmNv
YmopOworCQkJCWVyciA9IC1FSU5WQUw7CisJCQkJZ290byBlcnI7CisJCQl9CisKKwkJCWVyciA9
IGRtYV9mZW5jZV9jaGFpbl9maW5kX3NlcW5vKCZmZW5jZSwgcG9pbnQpOworCQkJaWYgKGVycikg
eworCQkJCURSTV9ERUJVRygiU3luY29iaiBoYW5kbGUgbWlzc2luZyByZXF1ZXN0ZWQgcG9pbnRc
biIpOworCQkJCWdvdG8gZXJyOworCQkJfQorCQl9CisKKwkJLyoKKwkJICogRm9yIHRpbWVsaW5l
IHN5bmNvYmpzIHdlIG5lZWQgdG8gY3JlYXRlIGEgY2hhaW4uCisJCSAqLworCQlpZiAocG9pbnQg
IT0gMCAmJiB1c2VyX2ZlbmNlLmZsYWdzICYgSTkxNV9FWEVDX0ZFTkNFX1NJR05BTCkgeworCQkJ
ZmVuY2VzW25dLmNoYWluX2ZlbmNlID0KKwkJCQlrbWFsbG9jKHNpemVvZigqZmVuY2VzW25dLmNo
YWluX2ZlbmNlKSwKKwkJCQkJR0ZQX0tFUk5FTCk7CisJCQlpZiAoIWZlbmNlc1tuXS5jaGFpbl9m
ZW5jZSkgeworCQkJCWRtYV9mZW5jZV9wdXQoZmVuY2UpOworCQkJCWRybV9zeW5jb2JqX3B1dChz
eW5jb2JqKTsKKwkJCQllcnIgPSAtRU5PTUVNOworCQkJCURSTV9ERUJVRygiVW5hYmxlIHRvIGFs
bG9jIGNoYWluX2ZlbmNlXG4iKTsKKwkJCQlnb3RvIGVycjsKKwkJCX0KKwkJfSBlbHNlIHsKKwkJ
CWZlbmNlc1tuXS5jaGFpbl9mZW5jZSA9IE5VTEw7CisJCX0KKworCQlmZW5jZXNbbl0uc3luY29i
aiA9IHB0cl9wYWNrX2JpdHMoc3luY29iaiwgdXNlcl9mZW5jZS5mbGFncywgMik7CisJCWZlbmNl
c1tuXS5kbWFfZmVuY2UgPSBmZW5jZTsKKwkJZmVuY2VzW25dLnZhbHVlID0gcG9pbnQ7CisJfQor
CisJcmV0dXJuIGZlbmNlczsKKworZXJyOgorCV9fZnJlZV9mZW5jZV9hcnJheShmZW5jZXMsIG4p
OworCXJldHVybiBFUlJfUFRSKGVycik7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgaTkxNV9kcm1fZG1h
X2ZlbmNlcyAqCiBnZXRfZmVuY2VfYXJyYXkoc3RydWN0IGRybV9pOTE1X2dlbV9leGVjYnVmZmVy
MiAqYXJncywKLQkJc3RydWN0IGRybV9maWxlICpmaWxlKQorCQlzdHJ1Y3QgaTkxNV9leGVjYnVm
ZmVyICplYiwKKwkJc3RydWN0IGRybV9maWxlICpmaWxlLAorCQlpbnQgKm91dF9uX2ZlbmNlcykK
IHsKLQljb25zdCB1bnNpZ25lZCBsb25nIG5mZW5jZXMgPSBhcmdzLT5udW1fY2xpcHJlY3RzOwog
CXN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY19mZW5jZSBfX3VzZXIgKnVzZXI7Ci0Jc3RydWN0IGRy
bV9zeW5jb2JqICoqZmVuY2VzOworCXN0cnVjdCBpOTE1X2RybV9kbWFfZmVuY2VzICpmZW5jZXM7
CiAJdW5zaWduZWQgbG9uZyBuOwogCWludCBlcnI7CiAKLQlpZiAoIShhcmdzLT5mbGFncyAmIEk5
MTVfRVhFQ19GRU5DRV9BUlJBWSkpCi0JCXJldHVybiBOVUxMOworCSpvdXRfbl9mZW5jZXMgPSBh
cmdzLT5udW1fY2xpcHJlY3RzOworCisJLyogVGltZWxpbmUgZmVuY2VzIGFyZSBpbmNvbXBhdGli
bGUgd2l0aCB0aGUgZmVuY2UgYXJyYXkuICovCisJaWYgKGViLT5leHRlbnNpb25zLmZsYWdzICYg
QklUKERSTV9JOTE1X0dFTV9CQVNFX0VYRUNCVUZGRVJfVFlQRV9USU1FTElORV9GRU5DRVMpKQor
CQlyZXR1cm4gRVJSX1BUUigtRUlOVkFMKTsKIAogCS8qIENoZWNrIG11bHRpcGxpY2F0aW9uIG92
ZXJmbG93IGZvciBhY2Nlc3Nfb2soKSBhbmQga3ZtYWxsb2NfYXJyYXkoKSAqLwogCUJVSUxEX0JV
R19PTihzaXplb2Yoc2l6ZV90KSA+IHNpemVvZih1bnNpZ25lZCBsb25nKSk7Ci0JaWYgKG5mZW5j
ZXMgPiBtaW5fdCh1bnNpZ25lZCBsb25nLAotCQkJICAgIFVMT05HX01BWCAvIHNpemVvZigqdXNl
ciksCi0JCQkgICAgU0laRV9NQVggLyBzaXplb2YoKmZlbmNlcykpKQorCWlmICgqb3V0X25fZmVu
Y2VzID4gbWluX3QodW5zaWduZWQgbG9uZywKKwkJCQkgIFVMT05HX01BWCAvIHNpemVvZigqdXNl
ciksCisJCQkJICBTSVpFX01BWCAvIHNpemVvZigqZmVuY2VzKSkpCiAJCXJldHVybiBFUlJfUFRS
KC1FSU5WQUwpOwogCiAJdXNlciA9IHU2NF90b191c2VyX3B0cihhcmdzLT5jbGlwcmVjdHNfcHRy
KTsKLQlpZiAoIWFjY2Vzc19vayh1c2VyLCBuZmVuY2VzICogc2l6ZW9mKCp1c2VyKSkpCisJaWYg
KCFhY2Nlc3Nfb2sodXNlciwgKm91dF9uX2ZlbmNlcyAqIHNpemVvZigqdXNlcikpKQogCQlyZXR1
cm4gRVJSX1BUUigtRUZBVUxUKTsKIAotCWZlbmNlcyA9IGt2bWFsbG9jX2FycmF5KG5mZW5jZXMs
IHNpemVvZigqZmVuY2VzKSwKKwlmZW5jZXMgPSBrdm1hbGxvY19hcnJheSgqb3V0X25fZmVuY2Vz
LCBzaXplb2YoKmZlbmNlcyksCiAJCQkJX19HRlBfTk9XQVJOIHwgR0ZQX0tFUk5FTCk7CiAJaWYg
KCFmZW5jZXMpCiAJCXJldHVybiBFUlJfUFRSKC1FTk9NRU0pOwogCi0JZm9yIChuID0gMDsgbiA8
IG5mZW5jZXM7IG4rKykgewotCQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNfZmVuY2UgZmVuY2U7
CisJZm9yIChuID0gMDsgbiA8ICpvdXRfbl9mZW5jZXM7IG4rKykgeworCQlzdHJ1Y3QgZHJtX2k5
MTVfZ2VtX2V4ZWNfZmVuY2UgdXNlcl9mZW5jZTsKIAkJc3RydWN0IGRybV9zeW5jb2JqICpzeW5j
b2JqOworCQlzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSA9IE5VTEw7CiAKLQkJaWYgKF9fY29weV9m
cm9tX3VzZXIoJmZlbmNlLCB1c2VyKyssIHNpemVvZihmZW5jZSkpKSB7CisJCWlmIChfX2NvcHlf
ZnJvbV91c2VyKCZ1c2VyX2ZlbmNlLCB1c2VyKyssIHNpemVvZih1c2VyX2ZlbmNlKSkpIHsKIAkJ
CWVyciA9IC1FRkFVTFQ7CiAJCQlnb3RvIGVycjsKIAkJfQogCi0JCWlmIChmZW5jZS5mbGFncyAm
IF9fSTkxNV9FWEVDX0ZFTkNFX1VOS05PV05fRkxBR1MpIHsKKwkJaWYgKHVzZXJfZmVuY2UuZmxh
Z3MgJiBfX0k5MTVfRVhFQ19GRU5DRV9VTktOT1dOX0ZMQUdTKSB7CiAJCQllcnIgPSAtRUlOVkFM
OwogCQkJZ290byBlcnI7CiAJCX0KIAotCQlzeW5jb2JqID0gZHJtX3N5bmNvYmpfZmluZChmaWxl
LCBmZW5jZS5oYW5kbGUpOworCQlzeW5jb2JqID0gZHJtX3N5bmNvYmpfZmluZChmaWxlLCB1c2Vy
X2ZlbmNlLmhhbmRsZSk7CiAJCWlmICghc3luY29iaikgewogCQkJRFJNX0RFQlVHKCJJbnZhbGlk
IHN5bmNvYmogaGFuZGxlIHByb3ZpZGVkXG4iKTsKIAkJCWVyciA9IC1FTk9FTlQ7CiAJCQlnb3Rv
IGVycjsKIAkJfQogCisJCWlmICh1c2VyX2ZlbmNlLmZsYWdzICYgSTkxNV9FWEVDX0ZFTkNFX1dB
SVQpIHsKKwkJCWZlbmNlID0gZHJtX3N5bmNvYmpfZmVuY2VfZ2V0KHN5bmNvYmopOworCQkJaWYg
KCFmZW5jZSkgeworCQkJCURSTV9ERUJVRygiU3luY29iaiBoYW5kbGUgaGFzIG5vIGZlbmNlXG4i
KTsKKwkJCQlkcm1fc3luY29ial9wdXQoc3luY29iaik7CisJCQkJZXJyID0gLUVJTlZBTDsKKwkJ
CQlnb3RvIGVycjsKKwkJCX0KKwkJfQorCiAJCUJVSUxEX0JVR19PTih+KEFSQ0hfS01BTExPQ19N
SU5BTElHTiAtIDEpICYKIAkJCSAgICAgfl9fSTkxNV9FWEVDX0ZFTkNFX1VOS05PV05fRkxBR1Mp
OwogCi0JCWZlbmNlc1tuXSA9IHB0cl9wYWNrX2JpdHMoc3luY29iaiwgZmVuY2UuZmxhZ3MsIDIp
OworCQlmZW5jZXNbbl0uc3luY29iaiA9IHB0cl9wYWNrX2JpdHMoc3luY29iaiwgdXNlcl9mZW5j
ZS5mbGFncywgMik7CisJCWZlbmNlc1tuXS5kbWFfZmVuY2UgPSBmZW5jZTsKKwkJZmVuY2VzW25d
LnZhbHVlID0gMDsKKwkJZmVuY2VzW25dLmNoYWluX2ZlbmNlID0gTlVMTDsKIAl9CiAKIAlyZXR1
cm4gZmVuY2VzOwpAQCAtMjI4MywzNiArMjQyNywzMCBAQCBnZXRfZmVuY2VfYXJyYXkoc3RydWN0
IGRybV9pOTE1X2dlbV9leGVjYnVmZmVyMiAqYXJncywKIH0KIAogc3RhdGljIHZvaWQKLXB1dF9m
ZW5jZV9hcnJheShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNidWZmZXIyICphcmdzLAotCQlzdHJ1
Y3QgZHJtX3N5bmNvYmogKipmZW5jZXMpCitwdXRfZmVuY2VfYXJyYXkoc3RydWN0IGk5MTVfZHJt
X2RtYV9mZW5jZXMgKmZlbmNlcywgaW50IG5mZW5jZXMpCiB7CiAJaWYgKGZlbmNlcykKLQkJX19m
cmVlX2ZlbmNlX2FycmF5KGZlbmNlcywgYXJncy0+bnVtX2NsaXByZWN0cyk7CisJCV9fZnJlZV9m
ZW5jZV9hcnJheShmZW5jZXMsIG5mZW5jZXMpOwogfQogCiBzdGF0aWMgaW50CiBhd2FpdF9mZW5j
ZV9hcnJheShzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYiwKLQkJICBzdHJ1Y3QgZHJtX3N5bmNv
YmogKipmZW5jZXMpCisJCSAgc3RydWN0IGk5MTVfZHJtX2RtYV9mZW5jZXMgKmZlbmNlcywKKwkJ
ICBpbnQgbmZlbmNlcykKIHsKLQljb25zdCB1bnNpZ25lZCBpbnQgbmZlbmNlcyA9IGViLT5hcmdz
LT5udW1fY2xpcHJlY3RzOwogCXVuc2lnbmVkIGludCBuOwogCWludCBlcnI7CiAKIAlmb3IgKG4g
PSAwOyBuIDwgbmZlbmNlczsgbisrKSB7CiAJCXN0cnVjdCBkcm1fc3luY29iaiAqc3luY29iajsK
LQkJc3RydWN0IGRtYV9mZW5jZSAqZmVuY2U7CiAJCXVuc2lnbmVkIGludCBmbGFnczsKIAotCQlz
eW5jb2JqID0gcHRyX3VucGFja19iaXRzKGZlbmNlc1tuXSwgJmZsYWdzLCAyKTsKKwkJc3luY29i
aiA9IHB0cl91bnBhY2tfYml0cyhmZW5jZXNbbl0uc3luY29iaiwgJmZsYWdzLCAyKTsKIAkJaWYg
KCEoZmxhZ3MgJiBJOTE1X0VYRUNfRkVOQ0VfV0FJVCkpCiAJCQljb250aW51ZTsKIAotCQlmZW5j
ZSA9IGRybV9zeW5jb2JqX2ZlbmNlX2dldChzeW5jb2JqKTsKLQkJaWYgKCFmZW5jZSkKLQkJCXJl
dHVybiAtRUlOVkFMOwotCi0JCWVyciA9IGk5MTVfcmVxdWVzdF9hd2FpdF9kbWFfZmVuY2UoZWIt
PnJlcXVlc3QsIGZlbmNlKTsKLQkJZG1hX2ZlbmNlX3B1dChmZW5jZSk7CisJCWVyciA9IGk5MTVf
cmVxdWVzdF9hd2FpdF9kbWFfZmVuY2UoZWItPnJlcXVlc3QsCisJCQkJCQkgICBmZW5jZXNbbl0u
ZG1hX2ZlbmNlKTsKIAkJaWYgKGVyciA8IDApCiAJCQlyZXR1cm4gZXJyOwogCX0KQEAgLTIzMjIs
OSArMjQ2MCw5IEBAIGF3YWl0X2ZlbmNlX2FycmF5KHN0cnVjdCBpOTE1X2V4ZWNidWZmZXIgKmVi
LAogCiBzdGF0aWMgdm9pZAogc2lnbmFsX2ZlbmNlX2FycmF5KHN0cnVjdCBpOTE1X2V4ZWNidWZm
ZXIgKmViLAotCQkgICBzdHJ1Y3QgZHJtX3N5bmNvYmogKipmZW5jZXMpCisJCSAgIHN0cnVjdCBp
OTE1X2RybV9kbWFfZmVuY2VzICpmZW5jZXMsCisJCSAgIGludCBuZmVuY2VzKQogewotCWNvbnN0
IHVuc2lnbmVkIGludCBuZmVuY2VzID0gZWItPmFyZ3MtPm51bV9jbGlwcmVjdHM7CiAJc3RydWN0
IGRtYV9mZW5jZSAqIGNvbnN0IGZlbmNlID0gJmViLT5yZXF1ZXN0LT5mZW5jZTsKIAl1bnNpZ25l
ZCBpbnQgbjsKIApAQCAtMjMzMiwxMSArMjQ3MCwyMSBAQCBzaWduYWxfZmVuY2VfYXJyYXkoc3Ry
dWN0IGk5MTVfZXhlY2J1ZmZlciAqZWIsCiAJCXN0cnVjdCBkcm1fc3luY29iaiAqc3luY29iajsK
IAkJdW5zaWduZWQgaW50IGZsYWdzOwogCi0JCXN5bmNvYmogPSBwdHJfdW5wYWNrX2JpdHMoZmVu
Y2VzW25dLCAmZmxhZ3MsIDIpOworCQlzeW5jb2JqID0gcHRyX3VucGFja19iaXRzKGZlbmNlc1tu
XS5zeW5jb2JqLCAmZmxhZ3MsIDIpOwogCQlpZiAoIShmbGFncyAmIEk5MTVfRVhFQ19GRU5DRV9T
SUdOQUwpKQogCQkJY29udGludWU7CiAKLQkJZHJtX3N5bmNvYmpfcmVwbGFjZV9mZW5jZShzeW5j
b2JqLCBmZW5jZSk7CisJCWlmIChmZW5jZXNbbl0uY2hhaW5fZmVuY2UpIHsKKwkJCWRybV9zeW5j
b2JqX2FkZF9wb2ludChzeW5jb2JqLCBmZW5jZXNbbl0uY2hhaW5fZmVuY2UsCisJCQkJCSAgICAg
IGZlbmNlLCBmZW5jZXNbbl0udmFsdWUpOworCQkJLyoKKwkJCSAqIFRoZSBjaGFpbidzIG93bmVy
c2hpcCBpcyB0cmFuc2ZlcmVkIHRvIHRoZQorCQkJICogdGltZWxpbmUuCisJCQkgKi8KKwkJCWZl
bmNlc1tuXS5jaGFpbl9mZW5jZSA9IE5VTEw7CisJCX0gZWxzZSB7CisJCQlkcm1fc3luY29ial9y
ZXBsYWNlX2ZlbmNlKHN5bmNvYmosIGZlbmNlKTsKKwkJfQogCX0KIH0KIApAQCAtMjM2NCw2ICsy
NTEyLDEzIEBAIHBhcnNlX2V4ZWNidWYyX2V4dGVuc2lvbnMoc3RydWN0IGRybV9pOTE1X2dlbV9l
eGVjYnVmZmVyMiAqYXJncywKIAkJCXJldHVybiAtRUlOVkFMOwogCiAJCXN3aXRjaCAoaXRlci50
eXBlKSB7CisJCWNhc2UgRFJNX0k5MTVfR0VNX0JBU0VfRVhFQ0JVRkZFUl9UWVBFX1RJTUVMSU5F
X0ZFTkNFUzoKKwkJCWlmIChjb3B5X2Zyb21fdXNlcigmZWItPmV4dGVuc2lvbnMudGltZWxpbmVf
ZmVuY2VzLAorCQkJCQkgICB1NjRfdG9fdXNlcl9wdHIoaXRlcl9wdHIpLAorCQkJCQkgICBzaXpl
b2YoZWItPmV4dGVuc2lvbnMudGltZWxpbmVfZmVuY2VzKSkpCisJCQkJcmV0dXJuIC1FRkFVTFQ7
CisJCQlicmVhazsKKwogCQlkZWZhdWx0OgogCQkJcmV0dXJuIC1FSU5WQUw7CiAJCX0KQEAgLTIz
ODAsMTQgKzI1MzUsMTUgQEAgc3RhdGljIGludAogaTkxNV9nZW1fZG9fZXhlY2J1ZmZlcihzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2LAogCQkgICAgICAgc3RydWN0IGRybV9maWxlICpmaWxlLAogCQkg
ICAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9leGVjYnVmZmVyMiAqYXJncywKLQkJICAgICAgIHN0
cnVjdCBkcm1faTkxNV9nZW1fZXhlY19vYmplY3QyICpleGVjLAotCQkgICAgICAgc3RydWN0IGRy
bV9zeW5jb2JqICoqZmVuY2VzKQorCQkgICAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9leGVjX29i
amVjdDIgKmV4ZWMpCiB7CiAJc3RydWN0IGk5MTVfZXhlY2J1ZmZlciBlYjsKIAlzdHJ1Y3QgZG1h
X2ZlbmNlICppbl9mZW5jZSA9IE5VTEw7CiAJc3RydWN0IGRtYV9mZW5jZSAqZXhlY19mZW5jZSA9
IE5VTEw7CiAJc3RydWN0IHN5bmNfZmlsZSAqb3V0X2ZlbmNlID0gTlVMTDsKKwlzdHJ1Y3QgaTkx
NV9kcm1fZG1hX2ZlbmNlcyAqZmVuY2VzID0gTlVMTDsKIAlpbnQgb3V0X2ZlbmNlX2ZkID0gLTE7
CisJaW50IG5mZW5jZXMgPSAwOwogCWludCBlcnI7CiAKIAlCVUlMRF9CVUdfT04oX19FWEVDX0lO
VEVSTkFMX0ZMQUdTICYgfl9fSTkxNV9FWEVDX0lMTEVHQUxfRkxBR1MpOwpAQCAtMjQyOSwxMCAr
MjU4NSwyMiBAQCBpOTE1X2dlbV9kb19leGVjYnVmZmVyKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYs
CiAJCQlyZXR1cm4gZXJyOwogCX0KIAorCWlmIChhcmdzLT5mbGFncyAmIEk5MTVfRVhFQ19GRU5D
RV9BUlJBWSkgeworCQlmZW5jZXMgPSBnZXRfZmVuY2VfYXJyYXkoYXJncywgJmViLCBmaWxlLCAm
bmZlbmNlcyk7CisJfSBlbHNlIGlmIChlYi5leHRlbnNpb25zLmZsYWdzICYgQklUKERSTV9JOTE1
X0dFTV9CQVNFX0VYRUNCVUZGRVJfVFlQRV9USU1FTElORV9GRU5DRVMpKSB7CisJCWZlbmNlcyA9
IGdldF90aW1lbGluZV9mZW5jZV9hcnJheSgKKwkJCWFyZ3MsICZlYi5leHRlbnNpb25zLnRpbWVs
aW5lX2ZlbmNlcywgZmlsZSwgJm5mZW5jZXMpOworCX0KKworCWlmIChJU19FUlIoZmVuY2VzKSkK
KwkJcmV0dXJuIFBUUl9FUlIoZmVuY2VzKTsKKwogCWlmIChhcmdzLT5mbGFncyAmIEk5MTVfRVhF
Q19GRU5DRV9JTikgewogCQlpbl9mZW5jZSA9IHN5bmNfZmlsZV9nZXRfZmVuY2UobG93ZXJfMzJf
Yml0cyhhcmdzLT5yc3ZkMikpOwotCQlpZiAoIWluX2ZlbmNlKQotCQkJcmV0dXJuIC1FSU5WQUw7
CisJCWlmICghaW5fZmVuY2UpIHsKKwkJCWVyciA9IC1FSU5WQUw7CisJCQlnb3RvIGVycl9mZW5j
ZXM7CisJCX0KIAl9CiAKIAlpZiAoYXJncy0+ZmxhZ3MgJiBJOTE1X0VYRUNfRkVOQ0VfU1VCTUlU
KSB7CkBAIC0yNTkwLDcgKzI3NTgsNyBAQCBpOTE1X2dlbV9kb19leGVjYnVmZmVyKHN0cnVjdCBk
cm1fZGV2aWNlICpkZXYsCiAJfQogCiAJaWYgKGZlbmNlcykgewotCQllcnIgPSBhd2FpdF9mZW5j
ZV9hcnJheSgmZWIsIGZlbmNlcyk7CisJCWVyciA9IGF3YWl0X2ZlbmNlX2FycmF5KCZlYiwgZmVu
Y2VzLCBuZmVuY2VzKTsKIAkJaWYgKGVycikKIAkJCWdvdG8gZXJyX3JlcXVlc3Q7CiAJfQpAQCAt
MjYxOSw3ICsyNzg3LDcgQEAgaTkxNV9nZW1fZG9fZXhlY2J1ZmZlcihzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2LAogCWk5MTVfcmVxdWVzdF9hZGQoZWIucmVxdWVzdCk7CiAKIAlpZiAoZmVuY2VzKQot
CQlzaWduYWxfZmVuY2VfYXJyYXkoJmViLCBmZW5jZXMpOworCQlzaWduYWxfZmVuY2VfYXJyYXko
JmViLCBmZW5jZXMsIG5mZW5jZXMpOwogCiAJaWYgKG91dF9mZW5jZSkgewogCQlpZiAoZXJyID09
IDApIHsKQEAgLTI2NTQsNiArMjgyMiw4IEBAIGk5MTVfZ2VtX2RvX2V4ZWNidWZmZXIoc3RydWN0
IGRybV9kZXZpY2UgKmRldiwKIAlkbWFfZmVuY2VfcHV0KGV4ZWNfZmVuY2UpOwogZXJyX2luX2Zl
bmNlOgogCWRtYV9mZW5jZV9wdXQoaW5fZmVuY2UpOworZXJyX2ZlbmNlczoKKwlwdXRfZmVuY2Vf
YXJyYXkoZmVuY2VzLCBuZmVuY2VzKTsKIAlyZXR1cm4gZXJyOwogfQogCkBAIC0yNzQ3LDcgKzI5
MTcsNyBAQCBpOTE1X2dlbV9leGVjYnVmZmVyX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYs
IHZvaWQgKmRhdGEsCiAJCQlleGVjMl9saXN0W2ldLmZsYWdzID0gMDsKIAl9CiAKLQllcnIgPSBp
OTE1X2dlbV9kb19leGVjYnVmZmVyKGRldiwgZmlsZSwgJmV4ZWMyLCBleGVjMl9saXN0LCBOVUxM
KTsKKwllcnIgPSBpOTE1X2dlbV9kb19leGVjYnVmZmVyKGRldiwgZmlsZSwgJmV4ZWMyLCBleGVj
Ml9saXN0KTsKIAlpZiAoZXhlYzIuZmxhZ3MgJiBfX0VYRUNfSEFTX1JFTE9DKSB7CiAJCXN0cnVj
dCBkcm1faTkxNV9nZW1fZXhlY19vYmplY3QgX191c2VyICp1c2VyX2V4ZWNfbGlzdCA9CiAJCQl1
NjRfdG9fdXNlcl9wdHIoYXJncy0+YnVmZmVyc19wdHIpOwpAQCAtMjc3OCw3ICsyOTQ4LDYgQEAg
aTkxNV9nZW1fZXhlY2J1ZmZlcjJfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAq
ZGF0YSwKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNidWZmZXIyICphcmdzID0gZGF0YTsK
IAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNfb2JqZWN0MiAqZXhlYzJfbGlzdDsKLQlzdHJ1Y3Qg
ZHJtX3N5bmNvYmogKipmZW5jZXMgPSBOVUxMOwogCWNvbnN0IHNpemVfdCBjb3VudCA9IGFyZ3Mt
PmJ1ZmZlcl9jb3VudDsKIAlpbnQgZXJyOwogCkBAIC0yODA2LDE1ICsyOTc1LDcgQEAgaTkxNV9n
ZW1fZXhlY2J1ZmZlcjJfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwK
IAkJcmV0dXJuIC1FRkFVTFQ7CiAJfQogCi0JaWYgKGFyZ3MtPmZsYWdzICYgSTkxNV9FWEVDX0ZF
TkNFX0FSUkFZKSB7Ci0JCWZlbmNlcyA9IGdldF9mZW5jZV9hcnJheShhcmdzLCBmaWxlKTsKLQkJ
aWYgKElTX0VSUihmZW5jZXMpKSB7Ci0JCQlrdmZyZWUoZXhlYzJfbGlzdCk7Ci0JCQlyZXR1cm4g
UFRSX0VSUihmZW5jZXMpOwotCQl9Ci0JfQotCi0JZXJyID0gaTkxNV9nZW1fZG9fZXhlY2J1ZmZl
cihkZXYsIGZpbGUsIGFyZ3MsIGV4ZWMyX2xpc3QsIGZlbmNlcyk7CisJZXJyID0gaTkxNV9nZW1f
ZG9fZXhlY2J1ZmZlcihkZXYsIGZpbGUsIGFyZ3MsIGV4ZWMyX2xpc3QpOwogCiAJLyoKIAkgKiBO
b3cgdGhhdCB3ZSBoYXZlIGJlZ3VuIGV4ZWN1dGlvbiBvZiB0aGUgYmF0Y2hidWZmZXIsIHdlIGln
bm9yZQpAQCAtMjg1NCw3ICszMDE1LDYgQEAgZW5kOjsKIAl9CiAKIAlhcmdzLT5mbGFncyAmPSB+
X19JOTE1X0VYRUNfVU5LTk9XTl9GTEFHUzsKLQlwdXRfZmVuY2VfYXJyYXkoYXJncywgZmVuY2Vz
KTsKIAlrdmZyZWUoZXhlYzJfbGlzdCk7CiAJcmV0dXJuIGVycjsKIH0KZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2Rydi5jCmluZGV4IDllZDRkMDAxNmVlMS4uYTg3Mjc5MWY5OGJkIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfZHJ2LmMKQEAgLTQ0OCw2ICs0NDgsNyBAQCBzdGF0aWMgaW50IGk5MTVfZ2V0cGFyYW1faW9j
dGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIAljYXNlIEk5MTVfUEFSQU1f
SEFTX0VYRUNfQkFUQ0hfRklSU1Q6CiAJY2FzZSBJOTE1X1BBUkFNX0hBU19FWEVDX0ZFTkNFX0FS
UkFZOgogCWNhc2UgSTkxNV9QQVJBTV9IQVNfRVhFQ19TVUJNSVRfRkVOQ0U6CisJY2FzZSBJOTE1
X1BBUkFNX0hBU19FWEVDX1RJTUVMSU5FX0ZFTkNFUzoKIAkJLyogRm9yIHRoZSB0aW1lIGJlaW5n
IGFsbCBvZiB0aGVzZSBhcmUgYWx3YXlzIHRydWU7CiAJCSAqIGlmIHNvbWUgc3VwcG9ydGVkIGhh
cmR3YXJlIGRvZXMgbm90IGhhdmUgb25lIG9mIHRoZXNlCiAJCSAqIGZlYXR1cmVzIHRoaXMgdmFs
dWUgbmVlZHMgdG8gYmUgcHJvdmlkZWQgZnJvbQpAQCAtMzE5Miw3ICszMTkzLDggQEAgc3RhdGlj
IHN0cnVjdCBkcm1fZHJpdmVyIGRyaXZlciA9IHsKIAkgKi8KIAkuZHJpdmVyX2ZlYXR1cmVzID0K
IAkgICAgRFJJVkVSX0dFTSB8IERSSVZFUl9QUklNRSB8Ci0JICAgIERSSVZFUl9SRU5ERVIgfCBE
UklWRVJfTU9ERVNFVCB8IERSSVZFUl9BVE9NSUMgfCBEUklWRVJfU1lOQ09CSiwKKwkgICAgRFJJ
VkVSX1JFTkRFUiB8IERSSVZFUl9NT0RFU0VUIHwgRFJJVkVSX0FUT01JQyB8IERSSVZFUl9TWU5D
T0JKIHwKKwkgICAgRFJJVkVSX1NZTkNPQkpfVElNRUxJTkUsCiAJLnJlbGVhc2UgPSBpOTE1X2Ry
aXZlcl9yZWxlYXNlLAogCS5vcGVuID0gaTkxNV9kcml2ZXJfb3BlbiwKIAkubGFzdGNsb3NlID0g
aTkxNV9kcml2ZXJfbGFzdGNsb3NlLApkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2RybS9pOTE1
X2RybS5oIGIvaW5jbHVkZS91YXBpL2RybS9pOTE1X2RybS5oCmluZGV4IDJlZjVhYjBkYWFlNC4u
YmExYjAyODU5MzQ2IDEwMDY0NAotLS0gYS9pbmNsdWRlL3VhcGkvZHJtL2k5MTVfZHJtLmgKKysr
IGIvaW5jbHVkZS91YXBpL2RybS9pOTE1X2RybS5oCkBAIC02MTcsNiArNjE3LDEyIEBAIHR5cGVk
ZWYgc3RydWN0IGRybV9pOTE1X2lycV93YWl0IHsKICAqLwogI2RlZmluZSBJOTE1X1BBUkFNX1BF
UkZfUkVWSVNJT04JNTQKIAorLyogUXVlcnkgd2hldGhlciBEUk1fSTkxNV9HRU1fRVhFQ0JVRkZF
UjIgc3VwcG9ydHMgc3VwcGx5aW5nIGFuIGFycmF5IG9mCisgKiB0aW1lbGluZSBzeW5jb2JqIHRo
cm91Z2ggZHJtX2k5MTVfZ2VtX2V4ZWNfdGltZWxpbmVfZmVuY2VzLiBTZWUKKyAqIEk5MTVfRVhF
Q19FWFQuCisgKi8KKyNkZWZpbmUgSTkxNV9QQVJBTV9IQVNfRVhFQ19USU1FTElORV9GRU5DRVMg
NTUKKwogLyogTXVzdCBiZSBrZXB0IGNvbXBhY3QgLS0gbm8gaG9sZXMgYW5kIHdlbGwgZG9jdW1l
bnRlZCAqLwogCiB0eXBlZGVmIHN0cnVjdCBkcm1faTkxNV9nZXRwYXJhbSB7CkBAIC0xMDE0LDYg
KzEwMjAsMTIgQEAgc3RydWN0IGRybV9pOTE1X2dlbV9leGVjX2ZlbmNlIHsKIH07CiAKIGVudW0g
ZHJtX2k5MTVfZ2VtX2Jhc2VfZXhlY2J1ZmZlcl90eXBlIHsKKwkvKioKKwkgKiBUaGlzIGlkZW50
aWZpZXIgaXMgYXNzb2NpYXRlZCB3aXRoCisJICogZHJtX2k5MTVfZ2VtX2V4ZWNfdGltZWxpbmVf
ZmVuY2VzLgorCSAqLworCURSTV9JOTE1X0dFTV9CQVNFX0VYRUNCVUZGRVJfVFlQRV9USU1FTElO
RV9GRU5DRVMsCisKIAlEUk1fSTkxNV9HRU1fQkFTRV9FWEVDQlVGRkVSX1RZUEVfTUFYIC8qIG5v
bi1BQkkgKi8KIH07CiAKQEAgLTEwMzYsNiArMTA0OCwzMSBAQCBzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X2Jhc2VfZXhlY2J1ZmZlcl9leHQgewogCV9fdTY0IG5leHRfcHRyOwogfTsKIAorLyoqCisgKiBU
aGlzIHN0cnVjdHVyZSBkZXNjcmliZXMgYW4gYXJyYXkgb2YgZHJtX3N5bmNvYmogYW5kIGFzc29j
aWF0ZWQgcG9pbnRzIGZvcgorICogdGltZWxpbmUgdmFyaWFudHMgb2YgZHJtX3N5bmNvYmouIEl0
IGlzIGludmFsaWQgdG8gYXBwZW5kIHRoaXMgc3RydWN0dXJlIHRvCisgKiB0aGUgZXhlY2J1ZiBp
ZiBJOTE1X0VYRUNfRkVOQ0VfQVJSQVkgaXMgc2V0LgorICovCitzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X2V4ZWNfdGltZWxpbmVfZmVuY2VzIHsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2Jhc2VfZXhlY2J1
ZmZlcl9leHQgYmFzZTsKKworCS8qKgorCSAqIE51bWJlciBvZiBlbGVtZW50IGluIHRoZSBoYW5k
bGVzX3B0ciAmIHZhbHVlX3B0ciBhcnJheXMuCisJICovCisJX191NjQgaGFuZGxlX2NvdW50Owor
CisJLyoqCisJICogUG9pbnRlciB0byBhbiBhcnJheSBvZiBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4
ZWNfZmVuY2Ugb2Ygc2l6ZSBoYW5kbGVfY291bnQuCisJICovCisJX191NjQgaGFuZGxlc19wdHI7
CisKKwkvKioKKwkgKiBQb2ludGVyIHRvIGFuIGFycmF5IG9mIHU2NCB2YWx1ZXMgb2Ygc2l6ZSBo
YW5kbGVfY291bnQuIFZhbHVlcyBtdXN0CisJICogYmUgMCBmb3IgYSBiaW5hcnkgZHJtX3N5bmNv
YmouCisJICovCisJX191NjQgdmFsdWVzX3B0cjsKK307CisKIHN0cnVjdCBkcm1faTkxNV9nZW1f
ZXhlY2J1ZmZlcjIgewogCS8qKgogCSAqIExpc3Qgb2YgZ2VtX2V4ZWNfb2JqZWN0MiBzdHJ1Y3Rz
Ci0tIAoyLjIxLjAuMzkyLmdmOGY2Nzg3MTU5ZQoKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlz
dHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4v
bGlzdGluZm8vaW50ZWwtZ2Z4

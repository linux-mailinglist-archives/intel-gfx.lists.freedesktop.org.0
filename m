Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8102D8FCB0
	for <lists+intel-gfx@lfdr.de>; Fri, 16 Aug 2019 09:46:42 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6AF706EB09;
	Fri, 16 Aug 2019 07:46:40 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B30BC6EB09
 for <intel-gfx@lists.freedesktop.org>; Fri, 16 Aug 2019 07:46:38 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18158673-1500050 
 for <intel-gfx@lists.freedesktop.org>; Fri, 16 Aug 2019 08:46:36 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 16 Aug 2019 08:46:35 +0100
Message-Id: <20190816074635.26062-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0.rc1
MIME-Version: 1.0
Subject: [Intel-gfx] [CI] drm/i915: Extract intel_frontbuffer active tracking
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

TW92ZSB0aGUgYWN0aXZlIHRyYWNraW5nIGZvciB0aGUgZnJvbnRidWZmZXIgb3BlcmF0aW9ucyBv
dXQgb2YgdGhlCmk5MTVfZ2VtX29iamVjdCBhbmQgaW50byBpdHMgb3duIGZpcnN0IGNsYXNzIChy
ZWZjb3VudGVkKSBvYmplY3QuIEluIHRoZQpwcm9jZXNzIG9mIGRldGFuZ2xpbmcsIHdlIHN3aXRj
aCBmcm9tIGxvdyBsZXZlbCByZXF1ZXN0IHRyYWNraW5nIHRvIHRoZQplYXNpZXIgaTkxNV9hY3Rp
dmUgLS0gd2l0aCB0aGUgcGxhbiB0aGF0IHRoaXMgYXZvaWRzIGFueSBwb3RlbnRpYWwKYXRvbWlj
IGNhbGxiYWNrcyBhcyB0aGUgZnJvbnRidWZmZXIgdHJhY2tpbmcgd2lzaGVzIHRvIHNsZWVwIGFz
IGl0CmZsdXNoZXMuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdp
bHNvbi5jby51az4KUmV2aWV3ZWQtYnk6IE1hdHRoZXcgQXVsZCA8bWF0dGhldy5hdWxkQGludGVs
LmNvbT4KLS0tCiBEb2N1bWVudGF0aW9uL2dwdS9pOTE1LnJzdCAgICAgICAgICAgICAgICAgICAg
fCAgIDMgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMgIHwg
IDcwICsrKy0tCiAuLi4vZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmggICAg
fCAgIDEgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mYmRldi5jICAgIHwg
IDQwICsrLQogLi4uL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Zyb250YnVmZmVyLmMgIHwg
MjU1ICsrKysrKysrKysrKystLS0tLQogLi4uL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Zy
b250YnVmZmVyLmggIHwgIDcwICsrKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX292ZXJsYXkuYyAgfCAgIDggKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9jbGZsdXNoLmMgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X2RvbWFpbi5jICAgIHwgIDE0ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
bW1hbi5jICAgICAgfCAgIDQgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29i
amVjdC5jICAgIHwgIDI3ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2Jq
ZWN0LmggICAgfCAgIDIgKy0KIC4uLi9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90
eXBlcy5oICB8ICAgOCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMgICAg
ICAgICAgIHwgICA1IC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggICAgICAgICAg
ICAgICB8ICAgNCAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jICAgICAgICAgICAg
ICAgfCAgNDcgKy0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYyAgICAgICAgICAg
ICAgIHwgICA2ICstCiAxNyBmaWxlcyBjaGFuZ2VkLCAzMDYgaW5zZXJ0aW9ucygrKSwgMjYwIGRl
bGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL0RvY3VtZW50YXRpb24vZ3B1L2k5MTUucnN0IGIvRG9j
dW1lbnRhdGlvbi9ncHUvaTkxNS5yc3QKaW5kZXggMGUzMjI2ODhiZTVjLi4zNDE1MjU1YWQzZGMg
MTAwNjQ0Ci0tLSBhL0RvY3VtZW50YXRpb24vZ3B1L2k5MTUucnN0CisrKyBiL0RvY3VtZW50YXRp
b24vZ3B1L2k5MTUucnN0CkBAIC05MSw5ICs5MSw2IEBAIEZyb250YnVmZmVyIFRyYWNraW5nCiAu
LiBrZXJuZWwtZG9jOjogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mcm9udGJ1
ZmZlci5jCiAgICA6aW50ZXJuYWw6CiAKLS4uIGtlcm5lbC1kb2M6OiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2dlbS5jCi0gICA6ZnVuY3Rpb25zOiBpOTE1X2dlbV90cmFja19mYgotCiBEaXNw
bGF5IEZJRk8gVW5kZXJydW4gUmVwb3J0aW5nCiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tCiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlz
cGxheS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKaW5k
ZXggNWI3MzNlMzhlYWUzLi5jNmEzZjU3NTM3NjkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCkBAIC0zMDQ5LDEyICszMDQ5LDEzIEBAIGludGVsX2Fs
bG9jX2luaXRpYWxfcGxhbmVfb2JqKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAogewogCXN0cnVj
dCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5iYXNlLmRldjsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Ci0Jc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iaiA9IE5VTEw7CiAJc3RydWN0IGRybV9tb2RlX2ZiX2NtZDIgbW9kZV9jbWQgPSB7IDAg
fTsKIAlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9ICZwbGFuZV9jb25maWctPmZiLT5iYXNl
OwogCXUzMiBiYXNlX2FsaWduZWQgPSByb3VuZF9kb3duKHBsYW5lX2NvbmZpZy0+YmFzZSwgUEFH
RV9TSVpFKTsKIAl1MzIgc2l6ZV9hbGlnbmVkID0gcm91bmRfdXAocGxhbmVfY29uZmlnLT5iYXNl
ICsgcGxhbmVfY29uZmlnLT5zaXplLAogCQkJCSAgICBQQUdFX1NJWkUpOworCXN0cnVjdCBkcm1f
aTkxNV9nZW1fb2JqZWN0ICpvYmo7CisJYm9vbCByZXQgPSBmYWxzZTsKIAogCXNpemVfYWxpZ25l
ZCAtPSBiYXNlX2FsaWduZWQ7CiAKQEAgLTMwOTYsNyArMzA5Nyw3IEBAIGludGVsX2FsbG9jX2lu
aXRpYWxfcGxhbmVfb2JqKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAogCQlicmVhazsKIAlkZWZh
dWx0OgogCQlNSVNTSU5HX0NBU0UocGxhbmVfY29uZmlnLT50aWxpbmcpOwotCQlyZXR1cm4gZmFs
c2U7CisJCWdvdG8gb3V0OwogCX0KIAogCW1vZGVfY21kLnBpeGVsX2Zvcm1hdCA9IGZiLT5mb3Jt
YXQtPmZvcm1hdDsKQEAgLTMxMDgsMTYgKzMxMDksMTUgQEAgaW50ZWxfYWxsb2NfaW5pdGlhbF9w
bGFuZV9vYmooc3RydWN0IGludGVsX2NydGMgKmNydGMsCiAKIAlpZiAoaW50ZWxfZnJhbWVidWZm
ZXJfaW5pdCh0b19pbnRlbF9mcmFtZWJ1ZmZlcihmYiksIG9iaiwgJm1vZGVfY21kKSkgewogCQlE
Uk1fREVCVUdfS01TKCJpbnRlbCBmYiBpbml0IGZhaWxlZFxuIik7Ci0JCWdvdG8gb3V0X3VucmVm
X29iajsKKwkJZ290byBvdXQ7CiAJfQogCiAKIAlEUk1fREVCVUdfS01TKCJpbml0aWFsIHBsYW5l
IGZiIG9iaiAlcFxuIiwgb2JqKTsKLQlyZXR1cm4gdHJ1ZTsKLQotb3V0X3VucmVmX29iajoKKwly
ZXQgPSB0cnVlOworb3V0OgogCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKLQlyZXR1cm4gZmFs
c2U7CisJcmV0dXJuIHJldDsKIH0KIAogc3RhdGljIHZvaWQKQEAgLTMxNzQsNiArMzE3NCwxMiBA
QCBzdGF0aWMgdm9pZCBpbnRlbF9wbGFuZV9kaXNhYmxlX25vYXRvbWljKHN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjLAogCWludGVsX2Rpc2FibGVfcGxhbmUocGxhbmUsIGNydGNfc3RhdGUpOwogfQog
CitzdGF0aWMgc3RydWN0IGludGVsX2Zyb250YnVmZmVyICoKK3RvX2ludGVsX2Zyb250YnVmZmVy
KHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiKQoreworCXJldHVybiBmYiA/IHRvX2ludGVsX2Zy
YW1lYnVmZmVyKGZiKS0+ZnJvbnRidWZmZXIgOiBOVUxMOworfQorCiBzdGF0aWMgdm9pZAogaW50
ZWxfZmluZF9pbml0aWFsX3BsYW5lX29iaihzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YywK
IAkJCSAgICAgc3RydWN0IGludGVsX2luaXRpYWxfcGxhbmVfY29uZmlnICpwbGFuZV9jb25maWcp
CkBAIC0zMTgxLDcgKzMxODcsNiBAQCBpbnRlbF9maW5kX2luaXRpYWxfcGxhbmVfb2JqKHN0cnVj
dCBpbnRlbF9jcnRjICppbnRlbF9jcnRjLAogCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBpbnRl
bF9jcnRjLT5iYXNlLmRldjsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGRldik7CiAJc3RydWN0IGRybV9jcnRjICpjOwotCXN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0ICpvYmo7CiAJc3RydWN0IGRybV9wbGFuZSAqcHJpbWFyeSA9IGludGVsX2NydGMtPmJh
c2UucHJpbWFyeTsKIAlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSA9IHByaW1h
cnktPnN0YXRlOwogCXN0cnVjdCBpbnRlbF9wbGFuZSAqaW50ZWxfcGxhbmUgPSB0b19pbnRlbF9w
bGFuZShwcmltYXJ5KTsKQEAgLTMyNTcsOCArMzI2Miw3IEBAIGludGVsX2ZpbmRfaW5pdGlhbF9w
bGFuZV9vYmooc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMsCiAJCXJldHVybjsKIAl9CiAK
LQlvYmogPSBpbnRlbF9mYl9vYmooZmIpOwotCWludGVsX2ZiX29ial9mbHVzaChvYmosIE9SSUdJ
Tl9ESVJUWUZCKTsKKwlpbnRlbF9mcm9udGJ1ZmZlcl9mbHVzaCh0b19pbnRlbF9mcm9udGJ1ZmZl
cihmYiksIE9SSUdJTl9ESVJUWUZCKTsKIAogCXBsYW5lX3N0YXRlLT5zcmNfeCA9IDA7CiAJcGxh
bmVfc3RhdGUtPnNyY195ID0gMDsKQEAgLTMyNzMsMTQgKzMyNzcsMTQgQEAgaW50ZWxfZmluZF9p
bml0aWFsX3BsYW5lX29iaihzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YywKIAlpbnRlbF9z
dGF0ZS0+YmFzZS5zcmMgPSBkcm1fcGxhbmVfc3RhdGVfc3JjKHBsYW5lX3N0YXRlKTsKIAlpbnRl
bF9zdGF0ZS0+YmFzZS5kc3QgPSBkcm1fcGxhbmVfc3RhdGVfZGVzdChwbGFuZV9zdGF0ZSk7CiAK
LQlpZiAoaTkxNV9nZW1fb2JqZWN0X2lzX3RpbGVkKG9iaikpCisJaWYgKHBsYW5lX2NvbmZpZy0+
dGlsaW5nKQogCQlkZXZfcHJpdi0+cHJlc2VydmVfYmlvc19zd2l6emxlID0gdHJ1ZTsKIAogCXBs
YW5lX3N0YXRlLT5mYiA9IGZiOwogCXBsYW5lX3N0YXRlLT5jcnRjID0gJmludGVsX2NydGMtPmJh
c2U7CiAKIAlhdG9taWNfb3IodG9faW50ZWxfcGxhbmUocHJpbWFyeSktPmZyb250YnVmZmVyX2Jp
dCwKLQkJICAmb2JqLT5mcm9udGJ1ZmZlcl9iaXRzKTsKKwkJICAmdG9faW50ZWxfZnJvbnRidWZm
ZXIoZmIpLT5iaXRzKTsKIH0KIAogc3RhdGljIGludCBza2xfbWF4X3BsYW5lX3dpZHRoKGNvbnN0
IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLApAQCAtMTQxMzIsOSArMTQxMzYsOSBAQCBzdGF0
aWMgdm9pZCBpbnRlbF9hdG9taWNfdHJhY2tfZmJzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUg
KnN0YXRlKQogCiAJZm9yX2VhY2hfb2xkbmV3X2ludGVsX3BsYW5lX2luX3N0YXRlKHN0YXRlLCBw
bGFuZSwgb2xkX3BsYW5lX3N0YXRlLAogCQkJCQkgICAgIG5ld19wbGFuZV9zdGF0ZSwgaSkKLQkJ
aTkxNV9nZW1fdHJhY2tfZmIoaW50ZWxfZmJfb2JqKG9sZF9wbGFuZV9zdGF0ZS0+YmFzZS5mYiks
Ci0JCQkJICBpbnRlbF9mYl9vYmoobmV3X3BsYW5lX3N0YXRlLT5iYXNlLmZiKSwKLQkJCQkgIHBs
YW5lLT5mcm9udGJ1ZmZlcl9iaXQpOworCQlpbnRlbF9mcm9udGJ1ZmZlcl90cmFjayh0b19pbnRl
bF9mcm9udGJ1ZmZlcihvbGRfcGxhbmVfc3RhdGUtPmJhc2UuZmIpLAorCQkJCQl0b19pbnRlbF9m
cm9udGJ1ZmZlcihuZXdfcGxhbmVfc3RhdGUtPmJhc2UuZmIpLAorCQkJCQlwbGFuZS0+ZnJvbnRi
dWZmZXJfYml0KTsKIH0KIAogc3RhdGljIGludCBpbnRlbF9hdG9taWNfY29tbWl0KHN0cnVjdCBk
cm1fZGV2aWNlICpkZXYsCkBAIC0xNDQxOCw3ICsxNDQyMiw3IEBAIGludGVsX3ByZXBhcmVfcGxh
bmVfZmIoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsCiAJCXJldHVybiByZXQ7CiAKIAlmYl9vYmpf
YnVtcF9yZW5kZXJfcHJpb3JpdHkob2JqKTsKLQlpbnRlbF9mYl9vYmpfZmx1c2gob2JqLCBPUklH
SU5fRElSVFlGQik7CisJaW50ZWxfZnJvbnRidWZmZXJfZmx1c2gob2JqLT5mcm9udGJ1ZmZlciwg
T1JJR0lOX0RJUlRZRkIpOwogCiAJaWYgKCFuZXdfc3RhdGUtPmZlbmNlKSB7IC8qIGltcGxpY2l0
IGZlbmNpbmcgKi8KIAkJc3RydWN0IGRtYV9mZW5jZSAqZmVuY2U7CkBAIC0xNDY4MSwxMyArMTQ2
ODUsMTIgQEAgaW50ZWxfbGVnYWN5X2N1cnNvcl91cGRhdGUoc3RydWN0IGRybV9wbGFuZSAqcGxh
bmUsCiAJCQkgICBzdHJ1Y3QgZHJtX21vZGVzZXRfYWNxdWlyZV9jdHggKmN0eCkKIHsKIAlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmRldik7Ci0JaW50
IHJldDsKIAlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpvbGRfcGxhbmVfc3RhdGUsICpuZXdfcGxh
bmVfc3RhdGU7CiAJc3RydWN0IGludGVsX3BsYW5lICppbnRlbF9wbGFuZSA9IHRvX2ludGVsX3Bs
YW5lKHBsYW5lKTsKLQlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpvbGRfZmI7CiAJc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUgPQogCQl0b19pbnRlbF9jcnRjX3N0YXRlKGNydGMt
PnN0YXRlKTsKIAlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGU7CisJaW50
IHJldDsKIAogCS8qCiAJICogV2hlbiBjcnRjIGlzIGluYWN0aXZlIG9yIHRoZXJlIGlzIGEgbW9k
ZXNldCBwZW5kaW5nLApAQCAtMTQ3NTUsMTEgKzE0NzU4LDEwIEBAIGludGVsX2xlZ2FjeV9jdXJz
b3JfdXBkYXRlKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLAogCWlmIChyZXQpCiAJCWdvdG8gb3V0
X3VubG9jazsKIAotCWludGVsX2ZiX29ial9mbHVzaChpbnRlbF9mYl9vYmooZmIpLCBPUklHSU5f
RkxJUCk7Ci0KLQlvbGRfZmIgPSBvbGRfcGxhbmVfc3RhdGUtPmZiOwotCWk5MTVfZ2VtX3RyYWNr
X2ZiKGludGVsX2ZiX29iaihvbGRfZmIpLCBpbnRlbF9mYl9vYmooZmIpLAotCQkJICBpbnRlbF9w
bGFuZS0+ZnJvbnRidWZmZXJfYml0KTsKKwlpbnRlbF9mcm9udGJ1ZmZlcl9mbHVzaCh0b19pbnRl
bF9mcm9udGJ1ZmZlcihmYiksIE9SSUdJTl9GTElQKTsKKwlpbnRlbF9mcm9udGJ1ZmZlcl90cmFj
ayh0b19pbnRlbF9mcm9udGJ1ZmZlcihvbGRfcGxhbmVfc3RhdGUtPmZiKSwKKwkJCQl0b19pbnRl
bF9mcm9udGJ1ZmZlcihmYiksCisJCQkJaW50ZWxfcGxhbmUtPmZyb250YnVmZmVyX2JpdCk7CiAK
IAkvKiBTd2FwIHBsYW5lIHN0YXRlICovCiAJcGxhbmUtPnN0YXRlID0gbmV3X3BsYW5lX3N0YXRl
OwpAQCAtMTU1NDAsMTUgKzE1NTQyLDkgQEAgc3RhdGljIHZvaWQgaW50ZWxfc2V0dXBfb3V0cHV0
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiBzdGF0aWMgdm9pZCBpbnRlbF91
c2VyX2ZyYW1lYnVmZmVyX2Rlc3Ryb3koc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIpCiB7CiAJ
c3RydWN0IGludGVsX2ZyYW1lYnVmZmVyICppbnRlbF9mYiA9IHRvX2ludGVsX2ZyYW1lYnVmZmVy
KGZiKTsKLQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gaW50ZWxfZmJfb2JqKGZi
KTsKIAogCWRybV9mcmFtZWJ1ZmZlcl9jbGVhbnVwKGZiKTsKLQotCWk5MTVfZ2VtX29iamVjdF9s
b2NrKG9iaik7Ci0JV0FSTl9PTighb2JqLT5mcmFtZWJ1ZmZlcl9yZWZlcmVuY2VzLS0pOwotCWk5
MTVfZ2VtX29iamVjdF91bmxvY2sob2JqKTsKLQotCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsK
KwlpbnRlbF9mcm9udGJ1ZmZlcl9wdXQoaW50ZWxfZmItPmZyb250YnVmZmVyKTsKIAogCWtmcmVl
KGludGVsX2ZiKTsKIH0KQEAgLTE1NTc2LDcgKzE1NTcyLDcgQEAgc3RhdGljIGludCBpbnRlbF91
c2VyX2ZyYW1lYnVmZmVyX2RpcnR5KHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLAogCXN0cnVj
dCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPSBpbnRlbF9mYl9vYmooZmIpOwogCiAJaTkxNV9n
ZW1fb2JqZWN0X2ZsdXNoX2lmX2Rpc3BsYXkob2JqKTsKLQlpbnRlbF9mYl9vYmpfZmx1c2gob2Jq
LCBPUklHSU5fRElSVFlGQik7CisJaW50ZWxfZnJvbnRidWZmZXJfZmx1c2godG9faW50ZWxfZnJv
bnRidWZmZXIoZmIpLCBPUklHSU5fRElSVFlGQik7CiAKIAlyZXR1cm4gMDsKIH0KQEAgLTE1NTk4
LDggKzE1NTk0LDExIEBAIHN0YXRpYyBpbnQgaW50ZWxfZnJhbWVidWZmZXJfaW5pdChzdHJ1Y3Qg
aW50ZWxfZnJhbWVidWZmZXIgKmludGVsX2ZiLAogCWludCByZXQgPSAtRUlOVkFMOwogCWludCBp
OwogCisJaW50ZWxfZmItPmZyb250YnVmZmVyID0gaW50ZWxfZnJvbnRidWZmZXJfZ2V0KG9iaik7
CisJaWYgKCFpbnRlbF9mYi0+ZnJvbnRidWZmZXIpCisJCXJldHVybiAtRU5PTUVNOworCiAJaTkx
NV9nZW1fb2JqZWN0X2xvY2sob2JqKTsKLQlvYmotPmZyYW1lYnVmZmVyX3JlZmVyZW5jZXMrKzsK
IAl0aWxpbmcgPSBpOTE1X2dlbV9vYmplY3RfZ2V0X3RpbGluZyhvYmopOwogCXN0cmlkZSA9IGk5
MTVfZ2VtX29iamVjdF9nZXRfc3RyaWRlKG9iaik7CiAJaTkxNV9nZW1fb2JqZWN0X3VubG9jayhv
YmopOwpAQCAtMTU3MTYsOSArMTU3MTUsNyBAQCBzdGF0aWMgaW50IGludGVsX2ZyYW1lYnVmZmVy
X2luaXQoc3RydWN0IGludGVsX2ZyYW1lYnVmZmVyICppbnRlbF9mYiwKIAlyZXR1cm4gMDsKIAog
ZXJyOgotCWk5MTVfZ2VtX29iamVjdF9sb2NrKG9iaik7Ci0Jb2JqLT5mcmFtZWJ1ZmZlcl9yZWZl
cmVuY2VzLS07Ci0JaTkxNV9nZW1fb2JqZWN0X3VubG9jayhvYmopOworCWludGVsX2Zyb250YnVm
ZmVyX3B1dChpbnRlbF9mYi0+ZnJvbnRidWZmZXIpOwogCXJldHVybiByZXQ7CiB9CiAKQEAgLTE1
NzM2LDggKzE1NzMzLDcgQEAgaW50ZWxfdXNlcl9mcmFtZWJ1ZmZlcl9jcmVhdGUoc3RydWN0IGRy
bV9kZXZpY2UgKmRldiwKIAkJcmV0dXJuIEVSUl9QVFIoLUVOT0VOVCk7CiAKIAlmYiA9IGludGVs
X2ZyYW1lYnVmZmVyX2NyZWF0ZShvYmosICZtb2RlX2NtZCk7Ci0JaWYgKElTX0VSUihmYikpCi0J
CWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKKwlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CiAK
IAlyZXR1cm4gZmI7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2Rpc3BsYXlfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfZGlzcGxheV90eXBlcy5oCmluZGV4IGE4OGVjOWFhOWNhMC4uM2MxYTVmM2UxZDIyIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMu
aAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMu
aApAQCAtODQsNiArODQsNyBAQCBlbnVtIGludGVsX2Jyb2FkY2FzdF9yZ2IgewogCiBzdHJ1Y3Qg
aW50ZWxfZnJhbWVidWZmZXIgewogCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgYmFzZTsKKwlzdHJ1
Y3QgaW50ZWxfZnJvbnRidWZmZXIgKmZyb250YnVmZmVyOwogCXN0cnVjdCBpbnRlbF9yb3RhdGlv
bl9pbmZvIHJvdF9pbmZvOwogCiAJLyogZm9yIGVhY2ggcGxhbmUgaW4gdGhlIG5vcm1hbCBHVFQg
dmlldyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9m
YmRldi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mYmRldi5jCmluZGV4
IDJkNzRjMzNhNTA0ZC4uZDU5ZWVlNWM1ZDljIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2ZiZGV2LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9mYmRldi5jCkBAIC00NywxMyArNDcsMTQgQEAKICNpbmNsdWRlICJpbnRlbF9m
YmRldi5oIgogI2luY2x1ZGUgImludGVsX2Zyb250YnVmZmVyLmgiCiAKLXN0YXRpYyB2b2lkIGlu
dGVsX2ZiZGV2X2ludmFsaWRhdGUoc3RydWN0IGludGVsX2ZiZGV2ICppZmJkZXYpCitzdGF0aWMg
c3RydWN0IGludGVsX2Zyb250YnVmZmVyICp0b19mcm9udGJ1ZmZlcihzdHJ1Y3QgaW50ZWxfZmJk
ZXYgKmlmYmRldikKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gaW50ZWxf
ZmJfb2JqKCZpZmJkZXYtPmZiLT5iYXNlKTsKLQl1bnNpZ25lZCBpbnQgb3JpZ2luID0KLQkJaWZi
ZGV2LT52bWFfZmxhZ3MgJiBQTEFORV9IQVNfRkVOQ0UgPyBPUklHSU5fR1RUIDogT1JJR0lOX0NQ
VTsKKwlyZXR1cm4gaWZiZGV2LT5mYi0+ZnJvbnRidWZmZXI7Cit9CiAKLQlpbnRlbF9mYl9vYmpf
aW52YWxpZGF0ZShvYmosIG9yaWdpbik7CitzdGF0aWMgdm9pZCBpbnRlbF9mYmRldl9pbnZhbGlk
YXRlKHN0cnVjdCBpbnRlbF9mYmRldiAqaWZiZGV2KQoreworCWludGVsX2Zyb250YnVmZmVyX2lu
dmFsaWRhdGUodG9fZnJvbnRidWZmZXIoaWZiZGV2KSwgT1JJR0lOX0NQVSk7CiB9CiAKIHN0YXRp
YyBpbnQgaW50ZWxfZmJkZXZfc2V0X3BhcihzdHJ1Y3QgZmJfaW5mbyAqaW5mbykKQEAgLTEyMCw3
ICsxMjEsNyBAQCBzdGF0aWMgaW50IGludGVsZmJfYWxsb2Moc3RydWN0IGRybV9mYl9oZWxwZXIg
KmhlbHBlciwKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRl
dik7CiAJc3RydWN0IGRybV9tb2RlX2ZiX2NtZDIgbW9kZV9jbWQgPSB7fTsKIAlzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdCAqb2JqOwotCWludCBzaXplLCByZXQ7CisJaW50IHNpemU7CiAKIAkv
KiB3ZSBkb24ndCBkbyBwYWNrZWQgMjRicHAgKi8KIAlpZiAoc2l6ZXMtPnN1cmZhY2VfYnBwID09
IDI0KQpAQCAtMTQ3LDI0ICsxNDgsMTYgQEAgc3RhdGljIGludCBpbnRlbGZiX2FsbG9jKHN0cnVj
dCBkcm1fZmJfaGVscGVyICpoZWxwZXIsCiAJCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVf
c2htZW0oZGV2X3ByaXYsIHNpemUpOwogCWlmIChJU19FUlIob2JqKSkgewogCQlEUk1fRVJST1Io
ImZhaWxlZCB0byBhbGxvY2F0ZSBmcmFtZWJ1ZmZlclxuIik7Ci0JCXJldCA9IFBUUl9FUlIob2Jq
KTsKLQkJZ290byBlcnI7CisJCXJldHVybiBQVFJfRVJSKG9iaik7CiAJfQogCiAJZmIgPSBpbnRl
bF9mcmFtZWJ1ZmZlcl9jcmVhdGUob2JqLCAmbW9kZV9jbWQpOwotCWlmIChJU19FUlIoZmIpKSB7
Ci0JCXJldCA9IFBUUl9FUlIoZmIpOwotCQlnb3RvIGVycl9vYmo7Ci0JfQorCWk5MTVfZ2VtX29i
amVjdF9wdXQob2JqKTsKKwlpZiAoSVNfRVJSKGZiKSkKKwkJcmV0dXJuIFBUUl9FUlIoZmIpOwog
CiAJaWZiZGV2LT5mYiA9IHRvX2ludGVsX2ZyYW1lYnVmZmVyKGZiKTsKLQogCXJldHVybiAwOwot
Ci1lcnJfb2JqOgotCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKLWVycjoKLQlyZXR1cm4gcmV0
OwogfQogCiBzdGF0aWMgaW50IGludGVsZmJfY3JlYXRlKHN0cnVjdCBkcm1fZmJfaGVscGVyICpo
ZWxwZXIsCkBAIC0xODAsNyArMTczLDYgQEAgc3RhdGljIGludCBpbnRlbGZiX2NyZWF0ZShzdHJ1
Y3QgZHJtX2ZiX2hlbHBlciAqaGVscGVyLAogCWNvbnN0IHN0cnVjdCBpOTE1X2dndHRfdmlldyB2
aWV3ID0gewogCQkudHlwZSA9IEk5MTVfR0dUVF9WSUVXX05PUk1BTCwKIAl9OwotCXN0cnVjdCBk
cm1fZnJhbWVidWZmZXIgKmZiOwogCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwogCXN0cnVjdCBm
Yl9pbmZvICppbmZvOwogCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwpAQCAtMjI2LDggKzIxOCw3IEBA
IHN0YXRpYyBpbnQgaW50ZWxmYl9jcmVhdGUoc3RydWN0IGRybV9mYl9oZWxwZXIgKmhlbHBlciwK
IAkJZ290byBvdXRfdW5sb2NrOwogCX0KIAotCWZiID0gJmlmYmRldi0+ZmItPmJhc2U7Ci0JaW50
ZWxfZmJfb2JqX2ZsdXNoKGludGVsX2ZiX29iaihmYiksIE9SSUdJTl9ESVJUWUZCKTsKKwlpbnRl
bF9mcm9udGJ1ZmZlcl9mbHVzaCh0b19mcm9udGJ1ZmZlcihpZmJkZXYpLCBPUklHSU5fRElSVFlG
Qik7CiAKIAlpbmZvID0gZHJtX2ZiX2hlbHBlcl9hbGxvY19mYmkoaGVscGVyKTsKIAlpZiAoSVNf
RVJSKGluZm8pKSB7CkBAIC0yMzYsNyArMjI3LDcgQEAgc3RhdGljIGludCBpbnRlbGZiX2NyZWF0
ZShzdHJ1Y3QgZHJtX2ZiX2hlbHBlciAqaGVscGVyLAogCQlnb3RvIG91dF91bnBpbjsKIAl9CiAK
LQlpZmJkZXYtPmhlbHBlci5mYiA9IGZiOworCWlmYmRldi0+aGVscGVyLmZiID0gJmlmYmRldi0+
ZmItPmJhc2U7CiAKIAlpbmZvLT5mYm9wcyA9ICZpbnRlbGZiX29wczsKIApAQCAtMjYzLDEzICsy
NTQsMTQgQEAgc3RhdGljIGludCBpbnRlbGZiX2NyZWF0ZShzdHJ1Y3QgZHJtX2ZiX2hlbHBlciAq
aGVscGVyLAogCSAqIElmIHRoZSBvYmplY3QgaXMgc3RvbGVuIGhvd2V2ZXIsIGl0IHdpbGwgYmUg
ZnVsbCBvZiB3aGF0ZXZlcgogCSAqIGdhcmJhZ2Ugd2FzIGxlZnQgaW4gdGhlcmUuCiAJICovCi0J
aWYgKGludGVsX2ZiX29iaihmYiktPnN0b2xlbiAmJiAhcHJlYWxsb2MpCisJaWYgKHZtYS0+b2Jq
LT5zdG9sZW4gJiYgIXByZWFsbG9jKQogCQltZW1zZXRfaW8oaW5mby0+c2NyZWVuX2Jhc2UsIDAs
IGluZm8tPnNjcmVlbl9zaXplKTsKIAogCS8qIFVzZSBkZWZhdWx0IHNjcmF0Y2ggcGl4bWFwIChp
bmZvLT5waXhtYXAuZmxhZ3MgPSBGQl9QSVhNQVBfU1lTVEVNKSAqLwogCiAJRFJNX0RFQlVHX0tN
UygiYWxsb2NhdGVkICVkeCVkIGZiOiAweCUwOHhcbiIsCi0JCSAgICAgIGZiLT53aWR0aCwgZmIt
PmhlaWdodCwgaTkxNV9nZ3R0X29mZnNldCh2bWEpKTsKKwkJICAgICAgaWZiZGV2LT5mYi0+YmFz
ZS53aWR0aCwgaWZiZGV2LT5mYi0+YmFzZS5oZWlnaHQsCisJCSAgICAgIGk5MTVfZ2d0dF9vZmZz
ZXQodm1hKSk7CiAJaWZiZGV2LT52bWEgPSB2bWE7CiAJaWZiZGV2LT52bWFfZmxhZ3MgPSBmbGFn
czsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mcm9u
dGJ1ZmZlci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mcm9udGJ1ZmZl
ci5jCmluZGV4IDljZGE4OGU0MWQyOS4uNzE5Mzc5Nzc0ZmE1IDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Zyb250YnVmZmVyLmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mcm9udGJ1ZmZlci5jCkBAIC0zMCwxMSArMzAsMTEg
QEAKICAqIE1hbnkgZmVhdHVyZXMgcmVxdWlyZSB1cyB0byB0cmFjayBjaGFuZ2VzIHRvIHRoZSBj
dXJyZW50bHkgYWN0aXZlCiAgKiBmcm9udGJ1ZmZlciwgZXNwZWNpYWxseSByZW5kZXJpbmcgdGFy
Z2V0ZWQgYXQgdGhlIGZyb250YnVmZmVyLgogICoKLSAqIFRvIGJlIGFibGUgdG8gZG8gc28gR0VN
IHRyYWNrcyBmcm9udGJ1ZmZlcnMgdXNpbmcgYSBiaXRtYXNrIGZvciBhbGwgcG9zc2libGUKLSAq
IGZyb250YnVmZmVyIHNsb3RzIHRocm91Z2ggaTkxNV9nZW1fdHJhY2tfZmIoKS4gVGhlIGZ1bmN0
aW9uIGluIHRoaXMgZmlsZSBhcmUKLSAqIHRoZW4gY2FsbGVkIHdoZW4gdGhlIGNvbnRlbnRzIG9m
IHRoZSBmcm9udGJ1ZmZlciBhcmUgaW52YWxpZGF0ZWQsIHdoZW4KLSAqIGZyb250YnVmZmVyIHJl
bmRlcmluZyBoYXMgc3RvcHBlZCBhZ2FpbiB0byBmbHVzaCBvdXQgYWxsIHRoZSBjaGFuZ2VzIGFu
ZCB3aGVuCi0gKiB0aGUgZnJvbnRidWZmZXIgaXMgZXhjaGFuZ2VkIHdpdGggYSBmbGlwLiBTdWJz
eXN0ZW1zIGludGVyZXN0ZWQgaW4KKyAqIFRvIGJlIGFibGUgdG8gZG8gc28gd2UgdHJhY2sgZnJv
bnRidWZmZXJzIHVzaW5nIGEgYml0bWFzayBmb3IgYWxsIHBvc3NpYmxlCisgKiBmcm9udGJ1ZmZl
ciBzbG90cyB0aHJvdWdoIGludGVsX2Zyb250YnVmZmVyX3RyYWNrKCkuIFRoZSBmdW5jdGlvbnMg
aW4gdGhpcworICogZmlsZSBhcmUgdGhlbiBjYWxsZWQgd2hlbiB0aGUgY29udGVudHMgb2YgdGhl
IGZyb250YnVmZmVyIGFyZSBpbnZhbGlkYXRlZCwKKyAqIHdoZW4gZnJvbnRidWZmZXIgcmVuZGVy
aW5nIGhhcyBzdG9wcGVkIGFnYWluIHRvIGZsdXNoIG91dCBhbGwgdGhlIGNoYW5nZXMKKyAqIGFu
ZCB3aGVuIHRoZSBmcm9udGJ1ZmZlciBpcyBleGNoYW5nZWQgd2l0aCBhIGZsaXAuIFN1YnN5c3Rl
bXMgaW50ZXJlc3RlZCBpbgogICogZnJvbnRidWZmZXIgY2hhbmdlcyAoZS5nLiBQU1IsIEZCQywg
RFJSUykgc2hvdWxkIGRpcmVjdGx5IHB1dCB0aGVpciBjYWxsYmFja3MKICAqIGludG8gdGhlIHJl
bGV2YW50IHBsYWNlcyBhbmQgZmlsdGVyIGZvciB0aGUgZnJvbnRidWZmZXIgc2xvdHMgdGhhdCB0
aGV5IGFyZQogICogaW50ZXJlc3RlZCBpbnQuCkBAIC02MywyOCArNjMsOSBAQAogI2luY2x1ZGUg
ImludGVsX2Zyb250YnVmZmVyLmgiCiAjaW5jbHVkZSAiaW50ZWxfcHNyLmgiCiAKLXZvaWQgX19p
bnRlbF9mYl9vYmpfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAot
CQkJICAgICAgIGVudW0gZmJfb3Bfb3JpZ2luIG9yaWdpbiwKLQkJCSAgICAgICB1bnNpZ25lZCBp
bnQgZnJvbnRidWZmZXJfYml0cykKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KG9iai0+YmFzZS5kZXYpOwotCi0JaWYgKG9yaWdpbiA9PSBPUklHSU5fQ1Mp
IHsKLQkJc3Bpbl9sb2NrKCZkZXZfcHJpdi0+ZmJfdHJhY2tpbmcubG9jayk7Ci0JCWRldl9wcml2
LT5mYl90cmFja2luZy5idXN5X2JpdHMgfD0gZnJvbnRidWZmZXJfYml0czsKLQkJZGV2X3ByaXYt
PmZiX3RyYWNraW5nLmZsaXBfYml0cyAmPSB+ZnJvbnRidWZmZXJfYml0czsKLQkJc3Bpbl91bmxv
Y2soJmRldl9wcml2LT5mYl90cmFja2luZy5sb2NrKTsKLQl9Ci0KLQltaWdodF9zbGVlcCgpOwot
CWludGVsX3Bzcl9pbnZhbGlkYXRlKGRldl9wcml2LCBmcm9udGJ1ZmZlcl9iaXRzLCBvcmlnaW4p
OwotCWludGVsX2VkcF9kcnJzX2ludmFsaWRhdGUoZGV2X3ByaXYsIGZyb250YnVmZmVyX2JpdHMp
OwotCWludGVsX2ZiY19pbnZhbGlkYXRlKGRldl9wcml2LCBmcm9udGJ1ZmZlcl9iaXRzLCBvcmln
aW4pOwotfQotCiAvKioKLSAqIGludGVsX2Zyb250YnVmZmVyX2ZsdXNoIC0gZmx1c2ggZnJvbnRi
dWZmZXIKLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UKKyAqIGZyb250YnVmZmVyX2ZsdXNoIC0g
Zmx1c2ggZnJvbnRidWZmZXIKKyAqIEBpOTE1OiBpOTE1IGRldmljZQogICogQGZyb250YnVmZmVy
X2JpdHM6IGZyb250YnVmZmVyIHBsYW5lIHRyYWNraW5nIGJpdHMKICAqIEBvcmlnaW46IHdoaWNo
IG9wZXJhdGlvbiBjYXVzZWQgdGhlIGZsdXNoCiAgKgpAQCAtOTQsNDUgKzc1LDI3IEBAIHZvaWQg
X19pbnRlbF9mYl9vYmpfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2Jq
LAogICoKICAqIENhbiBiZSBjYWxsZWQgd2l0aG91dCBhbnkgbG9ja3MgaGVsZC4KICAqLwotc3Rh
dGljIHZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmx1c2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAotCQkJCSAgICB1bnNpZ25lZCBmcm9udGJ1ZmZlcl9iaXRzLAotCQkJCSAgICBl
bnVtIGZiX29wX29yaWdpbiBvcmlnaW4pCitzdGF0aWMgdm9pZCBmcm9udGJ1ZmZlcl9mbHVzaChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKKwkJCSAgICAgIHVuc2lnbmVkIGludCBmcm9u
dGJ1ZmZlcl9iaXRzLAorCQkJICAgICAgZW51bSBmYl9vcF9vcmlnaW4gb3JpZ2luKQogewogCS8q
IERlbGF5IGZsdXNoaW5nIHdoZW4gcmluZ3MgYXJlIHN0aWxsIGJ1c3kuKi8KLQlzcGluX2xvY2so
JmRldl9wcml2LT5mYl90cmFja2luZy5sb2NrKTsKLQlmcm9udGJ1ZmZlcl9iaXRzICY9IH5kZXZf
cHJpdi0+ZmJfdHJhY2tpbmcuYnVzeV9iaXRzOwotCXNwaW5fdW5sb2NrKCZkZXZfcHJpdi0+ZmJf
dHJhY2tpbmcubG9jayk7CisJc3Bpbl9sb2NrKCZpOTE1LT5mYl90cmFja2luZy5sb2NrKTsKKwlm
cm9udGJ1ZmZlcl9iaXRzICY9IH5pOTE1LT5mYl90cmFja2luZy5idXN5X2JpdHM7CisJc3Bpbl91
bmxvY2soJmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOwogCiAJaWYgKCFmcm9udGJ1ZmZlcl9iaXRz
KQogCQlyZXR1cm47CiAKIAltaWdodF9zbGVlcCgpOwotCWludGVsX2VkcF9kcnJzX2ZsdXNoKGRl
dl9wcml2LCBmcm9udGJ1ZmZlcl9iaXRzKTsKLQlpbnRlbF9wc3JfZmx1c2goZGV2X3ByaXYsIGZy
b250YnVmZmVyX2JpdHMsIG9yaWdpbik7Ci0JaW50ZWxfZmJjX2ZsdXNoKGRldl9wcml2LCBmcm9u
dGJ1ZmZlcl9iaXRzLCBvcmlnaW4pOwotfQotCi12b2lkIF9faW50ZWxfZmJfb2JqX2ZsdXNoKHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCi0JCQkgIGVudW0gZmJfb3Bfb3JpZ2luIG9y
aWdpbiwKLQkJCSAgdW5zaWduZWQgaW50IGZyb250YnVmZmVyX2JpdHMpCi17Ci0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShvYmotPmJhc2UuZGV2KTsKLQotCWlm
IChvcmlnaW4gPT0gT1JJR0lOX0NTKSB7Ci0JCXNwaW5fbG9jaygmZGV2X3ByaXYtPmZiX3RyYWNr
aW5nLmxvY2spOwotCQkvKiBGaWx0ZXIgb3V0IG5ldyBiaXRzIHNpbmNlIHJlbmRlcmluZyBzdGFy
dGVkLiAqLwotCQlmcm9udGJ1ZmZlcl9iaXRzICY9IGRldl9wcml2LT5mYl90cmFja2luZy5idXN5
X2JpdHM7Ci0JCWRldl9wcml2LT5mYl90cmFja2luZy5idXN5X2JpdHMgJj0gfmZyb250YnVmZmVy
X2JpdHM7Ci0JCXNwaW5fdW5sb2NrKCZkZXZfcHJpdi0+ZmJfdHJhY2tpbmcubG9jayk7Ci0JfQot
Ci0JaWYgKGZyb250YnVmZmVyX2JpdHMpCi0JCWludGVsX2Zyb250YnVmZmVyX2ZsdXNoKGRldl9w
cml2LCBmcm9udGJ1ZmZlcl9iaXRzLCBvcmlnaW4pOworCWludGVsX2VkcF9kcnJzX2ZsdXNoKGk5
MTUsIGZyb250YnVmZmVyX2JpdHMpOworCWludGVsX3Bzcl9mbHVzaChpOTE1LCBmcm9udGJ1ZmZl
cl9iaXRzLCBvcmlnaW4pOworCWludGVsX2ZiY19mbHVzaChpOTE1LCBmcm9udGJ1ZmZlcl9iaXRz
LCBvcmlnaW4pOwogfQogCiAvKioKICAqIGludGVsX2Zyb250YnVmZmVyX2ZsaXBfcHJlcGFyZSAt
IHByZXBhcmUgYXN5bmNocm9ub3VzIGZyb250YnVmZmVyIGZsaXAKLSAqIEBkZXZfcHJpdjogaTkx
NSBkZXZpY2UKKyAqIEBpOTE1OiBpOTE1IGRldmljZQogICogQGZyb250YnVmZmVyX2JpdHM6IGZy
b250YnVmZmVyIHBsYW5lIHRyYWNraW5nIGJpdHMKICAqCiAgKiBUaGlzIGZ1bmN0aW9uIGdldHMg
Y2FsbGVkIGFmdGVyIHNjaGVkdWxpbmcgYSBmbGlwIG9uIEBvYmouIFRoZSBhY3R1YWwKQEAgLTE0
MiwxOSArMTA1LDE5IEBAIHZvaWQgX19pbnRlbF9mYl9vYmpfZmx1c2goc3RydWN0IGRybV9pOTE1
X2dlbV9vYmplY3QgKm9iaiwKICAqCiAgKiBDYW4gYmUgY2FsbGVkIHdpdGhvdXQgYW55IGxvY2tz
IGhlbGQuCiAgKi8KLXZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmxpcF9wcmVwYXJlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKK3ZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmxpcF9w
cmVwYXJlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCQkJCSAgICB1bnNpZ25lZCBm
cm9udGJ1ZmZlcl9iaXRzKQogewotCXNwaW5fbG9jaygmZGV2X3ByaXYtPmZiX3RyYWNraW5nLmxv
Y2spOwotCWRldl9wcml2LT5mYl90cmFja2luZy5mbGlwX2JpdHMgfD0gZnJvbnRidWZmZXJfYml0
czsKKwlzcGluX2xvY2soJmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOworCWk5MTUtPmZiX3RyYWNr
aW5nLmZsaXBfYml0cyB8PSBmcm9udGJ1ZmZlcl9iaXRzOwogCS8qIFJlbW92ZSBzdGFsZSBidXN5
IGJpdHMgZHVlIHRvIHRoZSBvbGQgYnVmZmVyLiAqLwotCWRldl9wcml2LT5mYl90cmFja2luZy5i
dXN5X2JpdHMgJj0gfmZyb250YnVmZmVyX2JpdHM7Ci0Jc3Bpbl91bmxvY2soJmRldl9wcml2LT5m
Yl90cmFja2luZy5sb2NrKTsKKwlpOTE1LT5mYl90cmFja2luZy5idXN5X2JpdHMgJj0gfmZyb250
YnVmZmVyX2JpdHM7CisJc3Bpbl91bmxvY2soJmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOwogfQog
CiAvKioKICAqIGludGVsX2Zyb250YnVmZmVyX2ZsaXBfY29tcGxldGUgLSBjb21wbGV0ZSBhc3lu
Y2hyb25vdXMgZnJvbnRidWZmZXIgZmxpcAotICogQGRldl9wcml2OiBpOTE1IGRldmljZQorICog
QGk5MTU6IGk5MTUgZGV2aWNlCiAgKiBAZnJvbnRidWZmZXJfYml0czogZnJvbnRidWZmZXIgcGxh
bmUgdHJhY2tpbmcgYml0cwogICoKICAqIFRoaXMgZnVuY3Rpb24gZ2V0cyBjYWxsZWQgYWZ0ZXIg
dGhlIGZsaXAgaGFzIGJlZW4gbGF0Y2hlZCBhbmQgd2lsbCBjb21wbGV0ZQpAQCAtMTYyLDIzICsx
MjUsMjIgQEAgdm9pZCBpbnRlbF9mcm9udGJ1ZmZlcl9mbGlwX3ByZXBhcmUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAogICoKICAqIENhbiBiZSBjYWxsZWQgd2l0aG91dCBhbnkg
bG9ja3MgaGVsZC4KICAqLwotdm9pZCBpbnRlbF9mcm9udGJ1ZmZlcl9mbGlwX2NvbXBsZXRlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKK3ZvaWQgaW50ZWxfZnJvbnRidWZmZXJf
ZmxpcF9jb21wbGV0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJCQkgICAgIHVu
c2lnbmVkIGZyb250YnVmZmVyX2JpdHMpCiB7Ci0Jc3Bpbl9sb2NrKCZkZXZfcHJpdi0+ZmJfdHJh
Y2tpbmcubG9jayk7CisJc3Bpbl9sb2NrKCZpOTE1LT5mYl90cmFja2luZy5sb2NrKTsKIAkvKiBN
YXNrIGFueSBjYW5jZWxsZWQgZmxpcHMuICovCi0JZnJvbnRidWZmZXJfYml0cyAmPSBkZXZfcHJp
di0+ZmJfdHJhY2tpbmcuZmxpcF9iaXRzOwotCWRldl9wcml2LT5mYl90cmFja2luZy5mbGlwX2Jp
dHMgJj0gfmZyb250YnVmZmVyX2JpdHM7Ci0Jc3Bpbl91bmxvY2soJmRldl9wcml2LT5mYl90cmFj
a2luZy5sb2NrKTsKKwlmcm9udGJ1ZmZlcl9iaXRzICY9IGk5MTUtPmZiX3RyYWNraW5nLmZsaXBf
Yml0czsKKwlpOTE1LT5mYl90cmFja2luZy5mbGlwX2JpdHMgJj0gfmZyb250YnVmZmVyX2JpdHM7
CisJc3Bpbl91bmxvY2soJmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOwogCiAJaWYgKGZyb250YnVm
ZmVyX2JpdHMpCi0JCWludGVsX2Zyb250YnVmZmVyX2ZsdXNoKGRldl9wcml2LAotCQkJCQlmcm9u
dGJ1ZmZlcl9iaXRzLCBPUklHSU5fRkxJUCk7CisJCWZyb250YnVmZmVyX2ZsdXNoKGk5MTUsIGZy
b250YnVmZmVyX2JpdHMsIE9SSUdJTl9GTElQKTsKIH0KIAogLyoqCiAgKiBpbnRlbF9mcm9udGJ1
ZmZlcl9mbGlwIC0gc3luY2hyb25vdXMgZnJvbnRidWZmZXIgZmxpcAotICogQGRldl9wcml2OiBp
OTE1IGRldmljZQorICogQGk5MTU6IGk5MTUgZGV2aWNlCiAgKiBAZnJvbnRidWZmZXJfYml0czog
ZnJvbnRidWZmZXIgcGxhbmUgdHJhY2tpbmcgYml0cwogICoKICAqIFRoaXMgZnVuY3Rpb24gZ2V0
cyBjYWxsZWQgYWZ0ZXIgc2NoZWR1bGluZyBhIGZsaXAgb24gQG9iai4gVGhpcyBpcyBmb3IKQEAg
LTE4NywxMyArMTQ5LDE2MCBAQCB2b2lkIGludGVsX2Zyb250YnVmZmVyX2ZsaXBfY29tcGxldGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogICoKICAqIENhbiBiZSBjYWxsZWQg
d2l0aG91dCBhbnkgbG9ja3MgaGVsZC4KICAqLwotdm9pZCBpbnRlbF9mcm9udGJ1ZmZlcl9mbGlw
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKK3ZvaWQgaW50ZWxfZnJvbnRidWZm
ZXJfZmxpcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJCSAgICB1bnNpZ25lZCBm
cm9udGJ1ZmZlcl9iaXRzKQogewotCXNwaW5fbG9jaygmZGV2X3ByaXYtPmZiX3RyYWNraW5nLmxv
Y2spOworCXNwaW5fbG9jaygmaTkxNS0+ZmJfdHJhY2tpbmcubG9jayk7CiAJLyogUmVtb3ZlIHN0
YWxlIGJ1c3kgYml0cyBkdWUgdG8gdGhlIG9sZCBidWZmZXIuICovCi0JZGV2X3ByaXYtPmZiX3Ry
YWNraW5nLmJ1c3lfYml0cyAmPSB+ZnJvbnRidWZmZXJfYml0czsKLQlzcGluX3VubG9jaygmZGV2
X3ByaXYtPmZiX3RyYWNraW5nLmxvY2spOworCWk5MTUtPmZiX3RyYWNraW5nLmJ1c3lfYml0cyAm
PSB+ZnJvbnRidWZmZXJfYml0czsKKwlzcGluX3VubG9jaygmaTkxNS0+ZmJfdHJhY2tpbmcubG9j
ayk7CiAKLQlpbnRlbF9mcm9udGJ1ZmZlcl9mbHVzaChkZXZfcHJpdiwgZnJvbnRidWZmZXJfYml0
cywgT1JJR0lOX0ZMSVApOworCWZyb250YnVmZmVyX2ZsdXNoKGk5MTUsIGZyb250YnVmZmVyX2Jp
dHMsIE9SSUdJTl9GTElQKTsKK30KKwordm9pZCBfX2ludGVsX2ZiX2ludmFsaWRhdGUoc3RydWN0
IGludGVsX2Zyb250YnVmZmVyICpmcm9udCwKKwkJCSAgIGVudW0gZmJfb3Bfb3JpZ2luIG9yaWdp
biwKKwkJCSAgIHVuc2lnbmVkIGludCBmcm9udGJ1ZmZlcl9iaXRzKQoreworCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShmcm9udC0+b2JqLT5iYXNlLmRldik7CisKKwlp
ZiAob3JpZ2luID09IE9SSUdJTl9DUykgeworCQlzcGluX2xvY2soJmk5MTUtPmZiX3RyYWNraW5n
LmxvY2spOworCQlpOTE1LT5mYl90cmFja2luZy5idXN5X2JpdHMgfD0gZnJvbnRidWZmZXJfYml0
czsKKwkJaTkxNS0+ZmJfdHJhY2tpbmcuZmxpcF9iaXRzICY9IH5mcm9udGJ1ZmZlcl9iaXRzOwor
CQlzcGluX3VubG9jaygmaTkxNS0+ZmJfdHJhY2tpbmcubG9jayk7CisJfQorCisJbWlnaHRfc2xl
ZXAoKTsKKwlpbnRlbF9wc3JfaW52YWxpZGF0ZShpOTE1LCBmcm9udGJ1ZmZlcl9iaXRzLCBvcmln
aW4pOworCWludGVsX2VkcF9kcnJzX2ludmFsaWRhdGUoaTkxNSwgZnJvbnRidWZmZXJfYml0cyk7
CisJaW50ZWxfZmJjX2ludmFsaWRhdGUoaTkxNSwgZnJvbnRidWZmZXJfYml0cywgb3JpZ2luKTsK
K30KKwordm9pZCBfX2ludGVsX2ZiX2ZsdXNoKHN0cnVjdCBpbnRlbF9mcm9udGJ1ZmZlciAqZnJv
bnQsCisJCSAgICAgIGVudW0gZmJfb3Bfb3JpZ2luIG9yaWdpbiwKKwkJICAgICAgdW5zaWduZWQg
aW50IGZyb250YnVmZmVyX2JpdHMpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGZyb250LT5vYmotPmJhc2UuZGV2KTsKKworCWlmIChvcmlnaW4gPT0gT1JJR0lO
X0NTKSB7CisJCXNwaW5fbG9jaygmaTkxNS0+ZmJfdHJhY2tpbmcubG9jayk7CisJCS8qIEZpbHRl
ciBvdXQgbmV3IGJpdHMgc2luY2UgcmVuZGVyaW5nIHN0YXJ0ZWQuICovCisJCWZyb250YnVmZmVy
X2JpdHMgJj0gaTkxNS0+ZmJfdHJhY2tpbmcuYnVzeV9iaXRzOworCQlpOTE1LT5mYl90cmFja2lu
Zy5idXN5X2JpdHMgJj0gfmZyb250YnVmZmVyX2JpdHM7CisJCXNwaW5fdW5sb2NrKCZpOTE1LT5m
Yl90cmFja2luZy5sb2NrKTsKKwl9CisKKwlpZiAoZnJvbnRidWZmZXJfYml0cykKKwkJZnJvbnRi
dWZmZXJfZmx1c2goaTkxNSwgZnJvbnRidWZmZXJfYml0cywgb3JpZ2luKTsKK30KKworc3RhdGlj
IGludCBmcm9udGJ1ZmZlcl9hY3RpdmUoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCit7CisJc3Ry
dWN0IGludGVsX2Zyb250YnVmZmVyICpmcm9udCA9CisJCWNvbnRhaW5lcl9vZihyZWYsIHR5cGVv
ZigqZnJvbnQpLCB3cml0ZSk7CisKKwlrcmVmX2dldCgmZnJvbnQtPnJlZik7CisJcmV0dXJuIDA7
Cit9CisKK3N0YXRpYyB2b2lkIGZyb250YnVmZmVyX3JldGlyZShzdHJ1Y3QgaTkxNV9hY3RpdmUg
KnJlZikKK3sKKwlzdHJ1Y3QgaW50ZWxfZnJvbnRidWZmZXIgKmZyb250ID0KKwkJY29udGFpbmVy
X29mKHJlZiwgdHlwZW9mKCpmcm9udCksIHdyaXRlKTsKKworCWludGVsX2Zyb250YnVmZmVyX2Zs
dXNoKGZyb250LCBPUklHSU5fQ1MpOworCWludGVsX2Zyb250YnVmZmVyX3B1dChmcm9udCk7Cit9
CisKK3N0YXRpYyB2b2lkIGZyb250YnVmZmVyX3JlbGVhc2Uoc3RydWN0IGtyZWYgKnJlZikKKwlf
X3JlbGVhc2VzKCZ0b19pOTE1KGZyb250LT5vYmotPmJhc2UuZGV2KS0+ZmJfdHJhY2tpbmcubG9j
aykKK3sKKwlzdHJ1Y3QgaW50ZWxfZnJvbnRidWZmZXIgKmZyb250ID0KKwkJY29udGFpbmVyX29m
KHJlZiwgdHlwZW9mKCpmcm9udCksIHJlZik7CisKKwlmcm9udC0+b2JqLT5mcm9udGJ1ZmZlciA9
IE5VTEw7CisJc3Bpbl91bmxvY2soJnRvX2k5MTUoZnJvbnQtPm9iai0+YmFzZS5kZXYpLT5mYl90
cmFja2luZy5sb2NrKTsKKworCWk5MTVfZ2VtX29iamVjdF9wdXQoZnJvbnQtPm9iaik7CisJa2Zy
ZWUoZnJvbnQpOworfQorCitzdHJ1Y3QgaW50ZWxfZnJvbnRidWZmZXIgKgoraW50ZWxfZnJvbnRi
dWZmZXJfZ2V0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCit7CisJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KG9iai0+YmFzZS5kZXYpOworCXN0cnVjdCBp
bnRlbF9mcm9udGJ1ZmZlciAqZnJvbnQ7CisKKwlzcGluX2xvY2soJmk5MTUtPmZiX3RyYWNraW5n
LmxvY2spOworCWZyb250ID0gb2JqLT5mcm9udGJ1ZmZlcjsKKwlpZiAoZnJvbnQpCisJCWtyZWZf
Z2V0KCZmcm9udC0+cmVmKTsKKwlzcGluX3VubG9jaygmaTkxNS0+ZmJfdHJhY2tpbmcubG9jayk7
CisJaWYgKGZyb250KQorCQlyZXR1cm4gZnJvbnQ7CisKKwlmcm9udCA9IGttYWxsb2Moc2l6ZW9m
KCpmcm9udCksIEdGUF9LRVJORUwpOworCWlmICghZnJvbnQpCisJCXJldHVybiBOVUxMOworCisJ
ZnJvbnQtPm9iaiA9IG9iajsKKwlrcmVmX2luaXQoJmZyb250LT5yZWYpOworCWF0b21pY19zZXQo
JmZyb250LT5iaXRzLCAwKTsKKwlpOTE1X2FjdGl2ZV9pbml0KGk5MTUsICZmcm9udC0+d3JpdGUs
CisJCQkgZnJvbnRidWZmZXJfYWN0aXZlLCBmcm9udGJ1ZmZlcl9yZXRpcmUpOworCisJc3Bpbl9s
b2NrKCZpOTE1LT5mYl90cmFja2luZy5sb2NrKTsKKwlpZiAob2JqLT5mcm9udGJ1ZmZlcikgewor
CQlrZnJlZShmcm9udCk7CisJCWZyb250ID0gb2JqLT5mcm9udGJ1ZmZlcjsKKwkJa3JlZl9nZXQo
JmZyb250LT5yZWYpOworCX0gZWxzZSB7CisJCWk5MTVfZ2VtX29iamVjdF9nZXQob2JqKTsKKwkJ
b2JqLT5mcm9udGJ1ZmZlciA9IGZyb250OworCX0KKwlzcGluX3VubG9jaygmaTkxNS0+ZmJfdHJh
Y2tpbmcubG9jayk7CisKKwlyZXR1cm4gZnJvbnQ7Cit9CisKK3ZvaWQgaW50ZWxfZnJvbnRidWZm
ZXJfcHV0KHN0cnVjdCBpbnRlbF9mcm9udGJ1ZmZlciAqZnJvbnQpCit7CisJa3JlZl9wdXRfbG9j
aygmZnJvbnQtPnJlZiwKKwkJICAgICAgZnJvbnRidWZmZXJfcmVsZWFzZSwKKwkJICAgICAgJnRv
X2k5MTUoZnJvbnQtPm9iai0+YmFzZS5kZXYpLT5mYl90cmFja2luZy5sb2NrKTsKK30KKworLyoq
CisgKiBpbnRlbF9mcm9udGJ1ZmZlcl90cmFjayAtIHVwZGF0ZSBmcm9udGJ1ZmZlciB0cmFja2lu
ZworICogQG9sZDogY3VycmVudCBidWZmZXIgZm9yIHRoZSBmcm9udGJ1ZmZlciBzbG90cworICog
QG5ldzogbmV3IGJ1ZmZlciBmb3IgdGhlIGZyb250YnVmZmVyIHNsb3RzCisgKiBAZnJvbnRidWZm
ZXJfYml0czogYml0bWFzayBvZiBmcm9udGJ1ZmZlciBzbG90cworICoKKyAqIFRoaXMgdXBkYXRl
cyB0aGUgZnJvbnRidWZmZXIgdHJhY2tpbmcgYml0cyBAZnJvbnRidWZmZXJfYml0cyBieSBjbGVh
cmluZyB0aGVtCisgKiBmcm9tIEBvbGQgYW5kIHNldHRpbmcgdGhlbSBpbiBAbmV3LiBCb3RoIEBv
bGQgYW5kIEBuZXcgY2FuIGJlIE5VTEwuCisgKi8KK3ZvaWQgaW50ZWxfZnJvbnRidWZmZXJfdHJh
Y2soc3RydWN0IGludGVsX2Zyb250YnVmZmVyICpvbGQsCisJCQkgICAgIHN0cnVjdCBpbnRlbF9m
cm9udGJ1ZmZlciAqbmV3LAorCQkJICAgICB1bnNpZ25lZCBpbnQgZnJvbnRidWZmZXJfYml0cykK
K3sKKwkvKgorCSAqIENvbnRyb2wgb2YgaW5kaXZpZHVhbCBiaXRzIHdpdGhpbiB0aGUgbWFzayBh
cmUgZ3VhcmRlZCBieQorCSAqIHRoZSBvd25pbmcgcGxhbmUtPm11dGV4LCBpLmUuIHdlIGNhbiBu
ZXZlciBzZWUgY29uY3VycmVudAorCSAqIG1hbmlwdWxhdGlvbiBvZiBpbmRpdmlkdWFsIGJpdHMu
IEJ1dCBzaW5jZSB0aGUgYml0ZmllbGQgYXMgYSB3aG9sZQorCSAqIGlzIHVwZGF0ZWQgdXNpbmcg
Uk1XLCB3ZSBuZWVkIHRvIHVzZSBhdG9taWNzIGluIG9yZGVyIHRvIHVwZGF0ZQorCSAqIHRoZSBi
aXRzLgorCSAqLworCUJVSUxEX0JVR19PTihJTlRFTF9GUk9OVEJVRkZFUl9CSVRTX1BFUl9QSVBF
ICogSTkxNV9NQVhfUElQRVMgPgorCQkgICAgIEJJVFNfUEVSX1RZUEUoYXRvbWljX3QpKTsKKwor
CWlmIChvbGQpIHsKKwkJV0FSTl9PTighKGF0b21pY19yZWFkKCZvbGQtPmJpdHMpICYgZnJvbnRi
dWZmZXJfYml0cykpOworCQlhdG9taWNfYW5kbm90KGZyb250YnVmZmVyX2JpdHMsICZvbGQtPmJp
dHMpOworCX0KKworCWlmIChuZXcpIHsKKwkJV0FSTl9PTihhdG9taWNfcmVhZCgmbmV3LT5iaXRz
KSAmIGZyb250YnVmZmVyX2JpdHMpOworCQlhdG9taWNfb3IoZnJvbnRidWZmZXJfYml0cywgJm5l
dy0+Yml0cyk7CisJfQogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9mcm9udGJ1ZmZlci5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9mcm9udGJ1ZmZlci5oCmluZGV4IDU3MjczMjBjODA4NC4uYWRjNjRkNjFhNGE1IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Zyb250YnVmZmVyLmgKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mcm9udGJ1ZmZlci5oCkBAIC0y
NCw3ICsyNCwxMCBAQAogI2lmbmRlZiBfX0lOVEVMX0ZST05UQlVGRkVSX0hfXwogI2RlZmluZSBf
X0lOVEVMX0ZST05UQlVGRkVSX0hfXwogCi0jaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX29iamVjdC5o
IgorI2luY2x1ZGUgPGxpbnV4L2F0b21pYy5oPgorI2luY2x1ZGUgPGxpbnV4L2tyZWYuaD4KKwor
I2luY2x1ZGUgImk5MTVfYWN0aXZlLmgiCiAKIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlOwogc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3Q7CkBAIC0zNywyMyArNDAsMzAgQEAgZW51bSBmYl9vcF9v
cmlnaW4gewogCU9SSUdJTl9ESVJUWUZCLAogfTsKIAotdm9pZCBpbnRlbF9mcm9udGJ1ZmZlcl9m
bGlwX3ByZXBhcmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorc3RydWN0IGlu
dGVsX2Zyb250YnVmZmVyIHsKKwlzdHJ1Y3Qga3JlZiByZWY7CisJYXRvbWljX3QgYml0czsKKwlz
dHJ1Y3QgaTkxNV9hY3RpdmUgd3JpdGU7CisJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
ajsKK307CisKK3ZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmxpcF9wcmVwYXJlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAogCQkJCSAgICB1bnNpZ25lZCBmcm9udGJ1ZmZlcl9iaXRzKTsK
LXZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmxpcF9jb21wbGV0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCit2b2lkIGludGVsX2Zyb250YnVmZmVyX2ZsaXBfY29tcGxldGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCQkJICAgICB1bnNpZ25lZCBmcm9udGJ1ZmZl
cl9iaXRzKTsKLXZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmxpcChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCit2b2lkIGludGVsX2Zyb250YnVmZmVyX2ZsaXAoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCiAJCQkgICAgdW5zaWduZWQgZnJvbnRidWZmZXJfYml0cyk7CiAK
LXZvaWQgX19pbnRlbF9mYl9vYmpfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVj
dCAqb2JqLAotCQkJICAgICAgIGVudW0gZmJfb3Bfb3JpZ2luIG9yaWdpbiwKLQkJCSAgICAgICB1
bnNpZ25lZCBpbnQgZnJvbnRidWZmZXJfYml0cyk7Ci12b2lkIF9faW50ZWxfZmJfb2JqX2ZsdXNo
KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCi0JCQkgIGVudW0gZmJfb3Bfb3JpZ2lu
IG9yaWdpbiwKLQkJCSAgdW5zaWduZWQgaW50IGZyb250YnVmZmVyX2JpdHMpOworc3RydWN0IGlu
dGVsX2Zyb250YnVmZmVyICoKK2ludGVsX2Zyb250YnVmZmVyX2dldChzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqKTsKKwordm9pZCBfX2ludGVsX2ZiX2ludmFsaWRhdGUoc3RydWN0IGlu
dGVsX2Zyb250YnVmZmVyICpmcm9udCwKKwkJCSAgIGVudW0gZmJfb3Bfb3JpZ2luIG9yaWdpbiwK
KwkJCSAgIHVuc2lnbmVkIGludCBmcm9udGJ1ZmZlcl9iaXRzKTsKIAogLyoqCi0gKiBpbnRlbF9m
Yl9vYmpfaW52YWxpZGF0ZSAtIGludmFsaWRhdGUgZnJvbnRidWZmZXIgb2JqZWN0Ci0gKiBAb2Jq
OiBHRU0gb2JqZWN0IHRvIGludmFsaWRhdGUKKyAqIGludGVsX2Zyb250YnVmZmVyX2ludmFsaWRh
dGUgLSBpbnZhbGlkYXRlIGZyb250YnVmZmVyIG9iamVjdAorICogQGZyb250OiBHRU0gb2JqZWN0
IHRvIGludmFsaWRhdGUKICAqIEBvcmlnaW46IHdoaWNoIG9wZXJhdGlvbiBjYXVzZWQgdGhlIGlu
dmFsaWRhdGlvbgogICoKICAqIFRoaXMgZnVuY3Rpb24gZ2V0cyBjYWxsZWQgZXZlcnkgdGltZSBy
ZW5kZXJpbmcgb24gdGhlIGdpdmVuIG9iamVjdCBzdGFydHMgYW5kCkBAIC02MiwzNyArNzIsNTMg
QEAgdm9pZCBfX2ludGVsX2ZiX29ial9mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAq
b2JqLAogICogdW50aWwgdGhlIHJlbmRlcmluZyBjb21wbGV0ZXMgb3IgYSBmbGlwIG9uIHRoaXMg
ZnJvbnRidWZmZXIgcGxhbmUgaXMKICAqIHNjaGVkdWxlZC4KICAqLwotc3RhdGljIGlubGluZSBi
b29sIGludGVsX2ZiX29ial9pbnZhbGlkYXRlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpv
YmosCi0JCQkJCSAgIGVudW0gZmJfb3Bfb3JpZ2luIG9yaWdpbikKK3N0YXRpYyBpbmxpbmUgYm9v
bCBpbnRlbF9mcm9udGJ1ZmZlcl9pbnZhbGlkYXRlKHN0cnVjdCBpbnRlbF9mcm9udGJ1ZmZlciAq
ZnJvbnQsCisJCQkJCQllbnVtIGZiX29wX29yaWdpbiBvcmlnaW4pCiB7CiAJdW5zaWduZWQgaW50
IGZyb250YnVmZmVyX2JpdHM7CiAKLQlmcm9udGJ1ZmZlcl9iaXRzID0gYXRvbWljX3JlYWQoJm9i
ai0+ZnJvbnRidWZmZXJfYml0cyk7CisJaWYgKCFmcm9udCkKKwkJcmV0dXJuIGZhbHNlOworCisJ
ZnJvbnRidWZmZXJfYml0cyA9IGF0b21pY19yZWFkKCZmcm9udC0+Yml0cyk7CiAJaWYgKCFmcm9u
dGJ1ZmZlcl9iaXRzKQogCQlyZXR1cm4gZmFsc2U7CiAKLQlfX2ludGVsX2ZiX29ial9pbnZhbGlk
YXRlKG9iaiwgb3JpZ2luLCBmcm9udGJ1ZmZlcl9iaXRzKTsKKwlfX2ludGVsX2ZiX2ludmFsaWRh
dGUoZnJvbnQsIG9yaWdpbiwgZnJvbnRidWZmZXJfYml0cyk7CiAJcmV0dXJuIHRydWU7CiB9CiAK
K3ZvaWQgX19pbnRlbF9mYl9mbHVzaChzdHJ1Y3QgaW50ZWxfZnJvbnRidWZmZXIgKmZyb250LAor
CQkgICAgICBlbnVtIGZiX29wX29yaWdpbiBvcmlnaW4sCisJCSAgICAgIHVuc2lnbmVkIGludCBm
cm9udGJ1ZmZlcl9iaXRzKTsKKwogLyoqCi0gKiBpbnRlbF9mYl9vYmpfZmx1c2ggLSBmbHVzaCBm
cm9udGJ1ZmZlciBvYmplY3QKLSAqIEBvYmo6IEdFTSBvYmplY3QgdG8gZmx1c2gKKyAqIGludGVs
X2Zyb250YnVmZmVyX2ZsdXNoIC0gZmx1c2ggZnJvbnRidWZmZXIgb2JqZWN0CisgKiBAZnJvbnQ6
IEdFTSBvYmplY3QgdG8gZmx1c2gKICAqIEBvcmlnaW46IHdoaWNoIG9wZXJhdGlvbiBjYXVzZWQg
dGhlIGZsdXNoCiAgKgogICogVGhpcyBmdW5jdGlvbiBnZXRzIGNhbGxlZCBldmVyeSB0aW1lIHJl
bmRlcmluZyBvbiB0aGUgZ2l2ZW4gb2JqZWN0IGhhcwogICogY29tcGxldGVkIGFuZCBmcm9udGJ1
ZmZlciBjYWNoaW5nIGNhbiBiZSBzdGFydGVkIGFnYWluLgogICovCi1zdGF0aWMgaW5saW5lIHZv
aWQgaW50ZWxfZmJfb2JqX2ZsdXNoKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCi0J
CQkJICAgICAgZW51bSBmYl9vcF9vcmlnaW4gb3JpZ2luKQorc3RhdGljIGlubGluZSB2b2lkIGlu
dGVsX2Zyb250YnVmZmVyX2ZsdXNoKHN0cnVjdCBpbnRlbF9mcm9udGJ1ZmZlciAqZnJvbnQsCisJ
CQkJCSAgIGVudW0gZmJfb3Bfb3JpZ2luIG9yaWdpbikKIHsKIAl1bnNpZ25lZCBpbnQgZnJvbnRi
dWZmZXJfYml0czsKIAotCWZyb250YnVmZmVyX2JpdHMgPSBhdG9taWNfcmVhZCgmb2JqLT5mcm9u
dGJ1ZmZlcl9iaXRzKTsKKwlpZiAoIWZyb250KQorCQlyZXR1cm47CisKKwlmcm9udGJ1ZmZlcl9i
aXRzID0gYXRvbWljX3JlYWQoJmZyb250LT5iaXRzKTsKIAlpZiAoIWZyb250YnVmZmVyX2JpdHMp
CiAJCXJldHVybjsKIAotCV9faW50ZWxfZmJfb2JqX2ZsdXNoKG9iaiwgb3JpZ2luLCBmcm9udGJ1
ZmZlcl9iaXRzKTsKKwlfX2ludGVsX2ZiX2ZsdXNoKGZyb250LCBvcmlnaW4sIGZyb250YnVmZmVy
X2JpdHMpOwogfQogCit2b2lkIGludGVsX2Zyb250YnVmZmVyX3RyYWNrKHN0cnVjdCBpbnRlbF9m
cm9udGJ1ZmZlciAqb2xkLAorCQkJICAgICBzdHJ1Y3QgaW50ZWxfZnJvbnRidWZmZXIgKm5ldywK
KwkJCSAgICAgdW5zaWduZWQgaW50IGZyb250YnVmZmVyX2JpdHMpOworCit2b2lkIGludGVsX2Zy
b250YnVmZmVyX3B1dChzdHJ1Y3QgaW50ZWxfZnJvbnRidWZmZXIgKmZyb250KTsKKwogI2VuZGlm
IC8qIF9fSU5URUxfRlJPTlRCVUZGRVJfSF9fICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX292ZXJsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfb3ZlcmxheS5jCmluZGV4IDRmNzg1ODZlZTA1ZS4uZTEyNDhlYWNlMGUxIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX292ZXJsYXkuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX292ZXJsYXkuYwpAQCAtMjgx
LDkgKzI4MSw5IEBAIHN0YXRpYyB2b2lkIGludGVsX292ZXJsYXlfZmxpcF9wcmVwYXJlKHN0cnVj
dCBpbnRlbF9vdmVybGF5ICpvdmVybGF5LAogCiAJV0FSTl9PTihvdmVybGF5LT5vbGRfdm1hKTsK
IAotCWk5MTVfZ2VtX3RyYWNrX2ZiKG92ZXJsYXktPnZtYSA/IG92ZXJsYXktPnZtYS0+b2JqIDog
TlVMTCwKLQkJCSAgdm1hID8gdm1hLT5vYmogOiBOVUxMLAotCQkJICBJTlRFTF9GUk9OVEJVRkZF
Ul9PVkVSTEFZKHBpcGUpKTsKKwlpbnRlbF9mcm9udGJ1ZmZlcl90cmFjayhvdmVybGF5LT52bWEg
PyBvdmVybGF5LT52bWEtPm9iai0+ZnJvbnRidWZmZXIgOiBOVUxMLAorCQkJCXZtYSA/IHZtYS0+
b2JqLT5mcm9udGJ1ZmZlciA6IE5VTEwsCisJCQkJSU5URUxfRlJPTlRCVUZGRVJfT1ZFUkxBWShw
aXBlKSk7CiAKIAlpbnRlbF9mcm9udGJ1ZmZlcl9mbGlwX3ByZXBhcmUob3ZlcmxheS0+aTkxNSwK
IAkJCQkgICAgICAgSU5URUxfRlJPTlRCVUZGRVJfT1ZFUkxBWShwaXBlKSk7CkBAIC03NjgsNyAr
NzY4LDcgQEAgc3RhdGljIGludCBpbnRlbF9vdmVybGF5X2RvX3B1dF9pbWFnZShzdHJ1Y3QgaW50
ZWxfb3ZlcmxheSAqb3ZlcmxheSwKIAkJcmV0ID0gUFRSX0VSUih2bWEpOwogCQlnb3RvIG91dF9w
aW5fc2VjdGlvbjsKIAl9Ci0JaW50ZWxfZmJfb2JqX2ZsdXNoKG5ld19ibywgT1JJR0lOX0RJUlRZ
RkIpOworCWludGVsX2Zyb250YnVmZmVyX2ZsdXNoKG5ld19iby0+ZnJvbnRidWZmZXIsIE9SSUdJ
Tl9ESVJUWUZCKTsKIAogCXJldCA9IGk5MTVfdm1hX3B1dF9mZW5jZSh2bWEpOwogCWlmIChyZXQp
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY2xmbHVzaC5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NsZmx1c2guYwppbmRleCAxNzVk
YzE0YWNmMTQuLjcyNDI0MmVjMzk3MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX2NsZmx1c2guYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fY2xmbHVzaC5jCkBAIC00OSw3ICs0OSw3IEBAIHN0YXRpYyB2b2lkIF9faTkxNV9kb19j
bGZsdXNoKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiB7CiAJR0VNX0JVR19PTigh
aTkxNV9nZW1fb2JqZWN0X2hhc19wYWdlcyhvYmopKTsKIAlkcm1fY2xmbHVzaF9zZyhvYmotPm1t
LnBhZ2VzKTsKLQlpbnRlbF9mYl9vYmpfZmx1c2gob2JqLCBPUklHSU5fQ1BVKTsKKwlpbnRlbF9m
cm9udGJ1ZmZlcl9mbHVzaChvYmotPmZyb250YnVmZmVyLCBPUklHSU5fQ1BVKTsKIH0KIAogc3Rh
dGljIHZvaWQgaTkxNV9jbGZsdXNoX3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5jCmluZGV4IDJlM2NlMmE2OTY1
My4uYTFhZmMyNjkwZTllIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fZG9tYWluLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2Rv
bWFpbi5jCkBAIC01NTEsMTMgKzU1MSw2IEBAIGk5MTVfZ2VtX29iamVjdF9zZXRfdG9fY3B1X2Rv
bWFpbihzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLCBib29sIHdyaXRlKQogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgaW5saW5lIGVudW0gZmJfb3Bfb3JpZ2luCi1mYl93cml0ZV9vcmln
aW4oc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwgdW5zaWduZWQgaW50IGRvbWFpbikK
LXsKLQlyZXR1cm4gKGRvbWFpbiA9PSBJOTE1X0dFTV9ET01BSU5fR1RUID8KLQkJb2JqLT5mcm9u
dGJ1ZmZlcl9nZ3R0X29yaWdpbiA6IE9SSUdJTl9DUFUpOwotfQotCiAvKioKICAqIENhbGxlZCB3
aGVuIHVzZXIgc3BhY2UgcHJlcGFyZXMgdG8gdXNlIGFuIG9iamVjdCB3aXRoIHRoZSBDUFUsIGVp
dGhlcgogICogdGhyb3VnaCB0aGUgbW1hcCBpb2N0bCdzIG1hcHBpbmcgb3IgYSBHVFQgbWFwcGlu
Zy4KQEAgLTY2MSw5ICs2NTQsOCBAQCBpOTE1X2dlbV9zZXRfZG9tYWluX2lvY3RsKHN0cnVjdCBk
cm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAKIAlpOTE1X2dlbV9vYmplY3RfdW5sb2NrKG9i
aik7CiAKLQlpZiAod3JpdGVfZG9tYWluICE9IDApCi0JCWludGVsX2ZiX29ial9pbnZhbGlkYXRl
KG9iaiwKLQkJCQkJZmJfd3JpdGVfb3JpZ2luKG9iaiwgd3JpdGVfZG9tYWluKSk7CisJaWYgKHdy
aXRlX2RvbWFpbikKKwkJaW50ZWxfZnJvbnRidWZmZXJfaW52YWxpZGF0ZShvYmotPmZyb250YnVm
ZmVyLCBPUklHSU5fQ1BVKTsKIAogb3V0X3VucGluOgogCWk5MTVfZ2VtX29iamVjdF91bnBpbl9w
YWdlcyhvYmopOwpAQCAtNzgzLDcgKzc3NSw3IEBAIGludCBpOTE1X2dlbV9vYmplY3RfcHJlcGFy
ZV93cml0ZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCX0KIAogb3V0OgotCWlu
dGVsX2ZiX29ial9pbnZhbGlkYXRlKG9iaiwgT1JJR0lOX0NQVSk7CisJaW50ZWxfZnJvbnRidWZm
ZXJfaW52YWxpZGF0ZShvYmotPmZyb250YnVmZmVyLCBPUklHSU5fQ1BVKTsKIAlvYmotPm1tLmRp
cnR5ID0gdHJ1ZTsKIAkvKiByZXR1cm4gd2l0aCB0aGUgcGFnZXMgcGlubmVkICovCiAJcmV0dXJu
IDA7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fbW1hbi5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21tYW4uYwppbmRleCAxZTczMTE0
OTM1MzAuLjQ4YzJjYmU5YjI3OCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX21tYW4uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
bW1hbi5jCkBAIC0xMDEsOSArMTAxLDYgQEAgaTkxNV9nZW1fbW1hcF9pb2N0bChzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCQl1cF93cml0ZSgmbW0tPm1tYXBfc2VtKTsKIAkJ
aWYgKElTX0VSUl9WQUxVRShhZGRyKSkKIAkJCWdvdG8gZXJyOwotCi0JCS8qIFRoaXMgbWF5IHJh
Y2UsIGJ1dCB0aGF0J3Mgb2ssIGl0IG9ubHkgZ2V0cyBzZXQgKi8KLQkJV1JJVEVfT05DRShvYmot
PmZyb250YnVmZmVyX2dndHRfb3JpZ2luLCBPUklHSU5fQ1BVKTsKIAl9CiAJaTkxNV9nZW1fb2Jq
ZWN0X3B1dChvYmopOwogCkBAIC0yODMsNyArMjgwLDYgQEAgdm1fZmF1bHRfdCBpOTE1X2dlbV9m
YXVsdChzdHJ1Y3Qgdm1fZmF1bHQgKnZtZikKIAkJICogVXNlcnNwYWNlIGlzIG5vdyB3cml0aW5n
IHRocm91Z2ggYW4gdW50cmFja2VkIFZNQSwgYWJhbmRvbgogCQkgKiBhbGwgaG9wZSB0aGF0IHRo
ZSBoYXJkd2FyZSBpcyBhYmxlIHRvIHRyYWNrIGZ1dHVyZSB3cml0ZXMuCiAJCSAqLwotCQlvYmot
PmZyb250YnVmZmVyX2dndHRfb3JpZ2luID0gT1JJR0lOX0NQVTsKIAogCQl2bWEgPSBpOTE1X2dl
bV9vYmplY3RfZ2d0dF9waW4ob2JqLCAmdmlldywgMCwgMCwgZmxhZ3MpOwogCQlpZiAoSVNfRVJS
KHZtYSkgJiYgIXZpZXcudHlwZSkgewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX29iamVjdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X29iamVjdC5jCmluZGV4IDY3ZGM2MWUwMmM5Zi4uZDc4NTVkYzVhNWM1IDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5jCkBAIC00NiwxNiArNDYsNiBAQCB2b2lk
IGk5MTVfZ2VtX29iamVjdF9mcmVlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiAJ
cmV0dXJuIGttZW1fY2FjaGVfZnJlZShnbG9iYWwuc2xhYl9vYmplY3RzLCBvYmopOwogfQogCi1z
dGF0aWMgdm9pZAotZnJvbnRidWZmZXJfcmV0aXJlKHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0
ICphY3RpdmUsCi0JCSAgIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QpCi17Ci0Jc3RydWN0
IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9Ci0JCWNvbnRhaW5lcl9vZihhY3RpdmUsIHR5cGVv
Zigqb2JqKSwgZnJvbnRidWZmZXJfd3JpdGUpOwotCi0JaW50ZWxfZmJfb2JqX2ZsdXNoKG9iaiwg
T1JJR0lOX0NTKTsKLX0KLQogdm9pZCBpOTE1X2dlbV9vYmplY3RfaW5pdChzdHJ1Y3QgZHJtX2k5
MTVfZ2VtX29iamVjdCAqb2JqLAogCQkJICBjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVj
dF9vcHMgKm9wcykKIHsKQEAgLTcyLDEwICs2Miw2IEBAIHZvaWQgaTkxNV9nZW1fb2JqZWN0X2lu
aXQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAogCW9iai0+b3BzID0gb3BzOwog
Ci0Jb2JqLT5mcm9udGJ1ZmZlcl9nZ3R0X29yaWdpbiA9IE9SSUdJTl9HVFQ7Ci0JaTkxNV9hY3Rp
dmVfcmVxdWVzdF9pbml0KCZvYmotPmZyb250YnVmZmVyX3dyaXRlLAotCQkJCSBOVUxMLCBmcm9u
dGJ1ZmZlcl9yZXRpcmUpOwotCiAJb2JqLT5tbS5tYWR2ID0gSTkxNV9NQURWX1dJTExORUVEOwog
CUlOSVRfUkFESVhfVFJFRSgmb2JqLT5tbS5nZXRfcGFnZS5yYWRpeCwgR0ZQX0tFUk5FTCB8IF9f
R0ZQX05PV0FSTik7CiAJbXV0ZXhfaW5pdCgmb2JqLT5tbS5nZXRfcGFnZS5sb2NrKTsKQEAgLTE4
Nyw3ICsxNzMsNiBAQCBzdGF0aWMgdm9pZCBfX2k5MTVfZ2VtX2ZyZWVfb2JqZWN0cyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAogCQlHRU1fQlVHX09OKGF0b21pY19yZWFkKCZvYmot
PmJpbmRfY291bnQpKTsKIAkJR0VNX0JVR19PTihvYmotPnVzZXJmYXVsdF9jb3VudCk7Ci0JCUdF
TV9CVUdfT04oYXRvbWljX3JlYWQoJm9iai0+ZnJvbnRidWZmZXJfYml0cykpOwogCQlHRU1fQlVH
X09OKCFsaXN0X2VtcHR5KCZvYmotPmx1dF9saXN0KSk7CiAKIAkJYXRvbWljX3NldCgmb2JqLT5t
bS5wYWdlc19waW5fY291bnQsIDApOwpAQCAtMjMwLDYgKzIxNSw4IEBAIHZvaWQgaTkxNV9nZW1f
ZnJlZV9vYmplY3Qoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpnZW1fb2JqKQogCXN0cnVjdCBkcm1f
aTkxNV9nZW1fb2JqZWN0ICpvYmogPSB0b19pbnRlbF9ibyhnZW1fb2JqKTsKIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUob2JqLT5iYXNlLmRldik7CiAKKwlHRU1fQlVH
X09OKGk5MTVfZ2VtX29iamVjdF9pc19mcmFtZWJ1ZmZlcihvYmopKTsKKwogCS8qCiAJICogQmVm
b3JlIHdlIGZyZWUgdGhlIG9iamVjdCwgbWFrZSBzdXJlIGFueSBwdXJlIFJDVS1vbmx5CiAJICog
cmVhZC1zaWRlIGNyaXRpY2FsIHNlY3Rpb25zIGFyZSBjb21wbGV0ZSwgZS5nLgpAQCAtMjYxLDEz
ICsyNDgsNiBAQCB2b2lkIGk5MTVfZ2VtX2ZyZWVfb2JqZWN0KHN0cnVjdCBkcm1fZ2VtX29iamVj
dCAqZ2VtX29iaikKIAkJcXVldWVfd29yayhpOTE1LT53cSwgJmk5MTUtPm1tLmZyZWVfd29yayk7
CiB9CiAKLXN0YXRpYyBpbmxpbmUgZW51bSBmYl9vcF9vcmlnaW4KLWZiX3dyaXRlX29yaWdpbihz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLCB1bnNpZ25lZCBpbnQgZG9tYWluKQotewot
CXJldHVybiAoZG9tYWluID09IEk5MTVfR0VNX0RPTUFJTl9HVFQgPwotCQlvYmotPmZyb250YnVm
ZmVyX2dndHRfb3JpZ2luIDogT1JJR0lOX0NQVSk7Ci19Ci0KIHN0YXRpYyBib29sIGdwdV93cml0
ZV9uZWVkc19jbGZsdXNoKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiB7CiAJcmV0
dXJuICEob2JqLT5jYWNoZV9sZXZlbCA9PSBJOTE1X0NBQ0hFX05PTkUgfHwKQEAgLTI5MCw4ICsy
NzAsNyBAQCBpOTE1X2dlbV9vYmplY3RfZmx1c2hfd3JpdGVfZG9tYWluKHN0cnVjdCBkcm1faTkx
NV9nZW1fb2JqZWN0ICpvYmosCiAJCWZvcl9lYWNoX2dndHRfdm1hKHZtYSwgb2JqKQogCQkJaW50
ZWxfZ3RfZmx1c2hfZ2d0dF93cml0ZXModm1hLT52bS0+Z3QpOwogCi0JCWludGVsX2ZiX29ial9m
bHVzaChvYmosCi0JCQkJICAgZmJfd3JpdGVfb3JpZ2luKG9iaiwgSTkxNV9HRU1fRE9NQUlOX0dU
VCkpOworCQlpbnRlbF9mcm9udGJ1ZmZlcl9mbHVzaChvYmotPmZyb250YnVmZmVyLCBPUklHSU5f
Q1BVKTsKIAogCQlmb3JfZWFjaF9nZ3R0X3ZtYSh2bWEsIG9iaikgewogCQkJaWYgKHZtYS0+aW9t
YXApCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0
LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmgKaW5kZXggNzRi
Y2Q1ODBjY2MzLi41ZWZiOTkzNmUwNWIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9vYmplY3QuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fb2JqZWN0LmgKQEAgLTE2MSw3ICsxNjEsNyBAQCBpOTE1X2dlbV9vYmplY3RfbmVlZHNf
YXN5bmNfY2FuY2VsKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiBzdGF0
aWMgaW5saW5lIGJvb2wKIGk5MTVfZ2VtX29iamVjdF9pc19mcmFtZWJ1ZmZlcihjb25zdCBzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogewotCXJldHVybiBSRUFEX09OQ0Uob2JqLT5m
cmFtZWJ1ZmZlcl9yZWZlcmVuY2VzKTsKKwlyZXR1cm4gUkVBRF9PTkNFKG9iai0+ZnJvbnRidWZm
ZXIpOwogfQogCiBzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGludApkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oCmluZGV4IGQ0NzRjNmFjNDEwMC4u
ZWRlMGViNDIxOGE4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fb2JqZWN0X3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X29iamVjdF90eXBlcy5oCkBAIC0xMyw2ICsxMyw3IEBACiAjaW5jbHVkZSAiaTkxNV9zZWxmdGVz
dC5oIgogCiBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdDsKK3N0cnVjdCBpbnRlbF9mcm9uYnVm
ZmVyOwogCiAvKgogICogc3RydWN0IGk5MTVfbHV0X2hhbmRsZSB0cmFja3MgdGhlIGZhc3QgbG9v
a3VwcyBmcm9tIGhhbmRsZSB0byB2bWEgdXNlZApAQCAtMTQxLDkgKzE0Miw3IEBAIHN0cnVjdCBk
cm1faTkxNV9nZW1fb2JqZWN0IHsKIAkgKi8KIAl1MTYgd3JpdGVfZG9tYWluOwogCi0JYXRvbWlj
X3QgZnJvbnRidWZmZXJfYml0czsKLQl1bnNpZ25lZCBpbnQgZnJvbnRidWZmZXJfZ2d0dF9vcmln
aW47IC8qIHdyaXRlIG9uY2UgKi8KLQlzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCBmcm9udGJ1
ZmZlcl93cml0ZTsKKwlzdHJ1Y3QgaW50ZWxfZnJvbnRidWZmZXIgKmZyb250YnVmZmVyOwogCiAJ
LyoqIEN1cnJlbnQgdGlsaW5nIHN0cmlkZSBmb3IgdGhlIG9iamVjdCwgaWYgaXQncyB0aWxlZC4g
Ki8KIAl1bnNpZ25lZCBpbnQgdGlsaW5nX2FuZF9zdHJpZGU7CkBAIC0yMjQsOSArMjIzLDYgQEAg
c3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgewogCQlib29sIHF1aXJrZWQ6MTsKIAl9IG1tOwog
Ci0JLyoqIFJlZmVyZW5jZXMgZnJvbSBmcmFtZWJ1ZmZlcnMsIGxvY2tzIG91dCB0aWxpbmcgY2hh
bmdlcy4gKi8KLQl1bnNpZ25lZCBpbnQgZnJhbWVidWZmZXJfcmVmZXJlbmNlczsKLQogCS8qKiBS
ZWNvcmQgb2YgYWRkcmVzcyBiaXQgMTcgb2YgZWFjaCBwYWdlIGF0IGxhc3QgdW5iaW5kLiAqLwog
CXVuc2lnbmVkIGxvbmcgKmJpdF8xNzsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9kZWJ1Z2ZzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwpp
bmRleCBlZjRmODRlMDYwZWUuLmU3Y2U3MzlmZTU0NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9k
ZWJ1Z2ZzLmMKQEAgLTEzOCw3ICsxMzgsNiBAQCBkZXNjcmliZV9vYmooc3RydWN0IHNlcV9maWxl
ICptLCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUob2JqLT5iYXNlLmRldik7CiAJc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lOwogCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwotCXVuc2lnbmVkIGlu
dCBmcm9udGJ1ZmZlcl9iaXRzOwogCWludCBwaW5fY291bnQgPSAwOwogCiAJc2VxX3ByaW50Ziht
LCAiJXBLOiAlYyVjJWMlYyAlOHpkS2lCICUwMnggJTAyeCAlcyVzJXMiLApAQCAtMjI4LDEwICsy
MjcsNiBAQCBkZXNjcmliZV9vYmooc3RydWN0IHNlcV9maWxlICptLCBzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqKQogCWVuZ2luZSA9IGk5MTVfZ2VtX29iamVjdF9sYXN0X3dyaXRlX2Vu
Z2luZShvYmopOwogCWlmIChlbmdpbmUpCiAJCXNlcV9wcmludGYobSwgIiAoJXMpIiwgZW5naW5l
LT5uYW1lKTsKLQotCWZyb250YnVmZmVyX2JpdHMgPSBhdG9taWNfcmVhZCgmb2JqLT5mcm9udGJ1
ZmZlcl9iaXRzKTsKLQlpZiAoZnJvbnRidWZmZXJfYml0cykKLQkJc2VxX3ByaW50ZihtLCAiIChm
cm9udGJ1ZmZlcjogMHglMDN4KSIsIGZyb250YnVmZmVyX2JpdHMpOwogfQogCiBzdHJ1Y3QgZmls
ZV9zdGF0cyB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAppbmRleCBjNDQwNmE2MGYzZTQuLjA1Mjdl
ZGU2ZTBmMiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCkBAIC0yMzU1LDEwICsyMzU1LDYgQEAg
aW50IGk5MTVfZ2VtX21tYXBfZ3R0KHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wcml2LCBzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2LAogCQkgICAgICB1MzIgaGFuZGxlLCB1NjQgKm9mZnNldCk7CiBpbnQg
aTkxNV9nZW1fbW1hcF9ndHRfdmVyc2lvbih2b2lkKTsKIAotdm9pZCBpOTE1X2dlbV90cmFja19m
YihzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2xkLAotCQkgICAgICAgc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3QgKm5ldywKLQkJICAgICAgIHVuc2lnbmVkIGZyb250YnVmZmVyX2JpdHMp
OwotCiBpbnQgX19tdXN0X2NoZWNrIGk5MTVfZ2VtX3NldF9nbG9iYWxfc2Vxbm8oc3RydWN0IGRy
bV9kZXZpY2UgKmRldiwgdTMyIHNlcW5vKTsKIAogc3RhdGljIGlubGluZSB1MzIgaTkxNV9yZXNl
dF9jb3VudChzdHJ1Y3QgaTkxNV9ncHVfZXJyb3IgKmVycm9yKQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2Vt
LmMKaW5kZXggMDdkYTdkNWY4NTVhLi4zZjBkODhjYjQ3ZGQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9n
ZW0uYwpAQCAtMTM5LDE3ICsxMzksMTkgQEAgaTkxNV9nZW1fcGh5c19wd3JpdGUoc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAl2b2lkICp2YWRkciA9IG9iai0+cGh5c19oYW5kbGUt
PnZhZGRyICsgYXJncy0+b2Zmc2V0OwogCWNoYXIgX191c2VyICp1c2VyX2RhdGEgPSB1NjRfdG9f
dXNlcl9wdHIoYXJncy0+ZGF0YV9wdHIpOwogCi0JLyogV2UgbWFudWFsbHkgY29udHJvbCB0aGUg
ZG9tYWluIGhlcmUgYW5kIHByZXRlbmQgdGhhdCBpdAorCS8qCisJICogV2UgbWFudWFsbHkgY29u
dHJvbCB0aGUgZG9tYWluIGhlcmUgYW5kIHByZXRlbmQgdGhhdCBpdAogCSAqIHJlbWFpbnMgY29o
ZXJlbnQgaS5lLiBpbiB0aGUgR1RUIGRvbWFpbiwgbGlrZSBzaG1lbV9wd3JpdGUuCiAJICovCi0J
aW50ZWxfZmJfb2JqX2ludmFsaWRhdGUob2JqLCBPUklHSU5fQ1BVKTsKKwlpbnRlbF9mcm9udGJ1
ZmZlcl9pbnZhbGlkYXRlKG9iai0+ZnJvbnRidWZmZXIsIE9SSUdJTl9DUFUpOworCiAJaWYgKGNv
cHlfZnJvbV91c2VyKHZhZGRyLCB1c2VyX2RhdGEsIGFyZ3MtPnNpemUpKQogCQlyZXR1cm4gLUVG
QVVMVDsKIAogCWRybV9jbGZsdXNoX3ZpcnRfcmFuZ2UodmFkZHIsIGFyZ3MtPnNpemUpOwogCWlu
dGVsX2d0X2NoaXBzZXRfZmx1c2goJnRvX2k5MTUob2JqLT5iYXNlLmRldiktPmd0KTsKIAotCWlu
dGVsX2ZiX29ial9mbHVzaChvYmosIE9SSUdJTl9DUFUpOworCWludGVsX2Zyb250YnVmZmVyX2Zs
dXNoKG9iai0+ZnJvbnRidWZmZXIsIE9SSUdJTl9DUFUpOwogCXJldHVybiAwOwogfQogCkBAIC01
OTQsNyArNTk2LDcgQEAgaTkxNV9nZW1fZ3R0X3B3cml0ZV9mYXN0KHN0cnVjdCBkcm1faTkxNV9n
ZW1fb2JqZWN0ICpvYmosCiAJCWdvdG8gb3V0X3VucGluOwogCX0KIAotCWludGVsX2ZiX29ial9p
bnZhbGlkYXRlKG9iaiwgT1JJR0lOX0NQVSk7CisJaW50ZWxfZnJvbnRidWZmZXJfaW52YWxpZGF0
ZShvYmotPmZyb250YnVmZmVyLCBPUklHSU5fQ1BVKTsKIAogCXVzZXJfZGF0YSA9IHU2NF90b191
c2VyX3B0cihhcmdzLT5kYXRhX3B0cik7CiAJb2Zmc2V0ID0gYXJncy0+b2Zmc2V0OwpAQCAtNjM2
LDcgKzYzOCw3IEBAIGk5MTVfZ2VtX2d0dF9wd3JpdGVfZmFzdChzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdCAqb2JqLAogCQl1c2VyX2RhdGEgKz0gcGFnZV9sZW5ndGg7CiAJCW9mZnNldCArPSBw
YWdlX2xlbmd0aDsKIAl9Ci0JaW50ZWxfZmJfb2JqX2ZsdXNoKG9iaiwgT1JJR0lOX0NQVSk7CisJ
aW50ZWxfZnJvbnRidWZmZXJfZmx1c2gob2JqLT5mcm9udGJ1ZmZlciwgT1JJR0lOX0NQVSk7CiAK
IAlpOTE1X2dlbV9vYmplY3RfdW5sb2NrX2ZlbmNlKG9iaiwgZmVuY2UpOwogb3V0X3VucGluOgpA
QCAtNzI5LDcgKzczMSw3IEBAIGk5MTVfZ2VtX3NobWVtX3B3cml0ZShzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqLAogCQlvZmZzZXQgPSAwOwogCX0KIAotCWludGVsX2ZiX29ial9mbHVz
aChvYmosIE9SSUdJTl9DUFUpOworCWludGVsX2Zyb250YnVmZmVyX2ZsdXNoKG9iai0+ZnJvbnRi
dWZmZXIsIE9SSUdJTl9DUFUpOwogCWk5MTVfZ2VtX29iamVjdF91bmxvY2tfZmVuY2Uob2JqLCBm
ZW5jZSk7CiAKIAlyZXR1cm4gcmV0OwpAQCAtMTc2MywzOSArMTc2NSw2IEBAIGludCBpOTE1X2dl
bV9vcGVuKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBzdHJ1Y3QgZHJtX2ZpbGUgKmZp
bGUpCiAJcmV0dXJuIHJldDsKIH0KIAotLyoqCi0gKiBpOTE1X2dlbV90cmFja19mYiAtIHVwZGF0
ZSBmcm9udGJ1ZmZlciB0cmFja2luZwotICogQG9sZDogY3VycmVudCBHRU0gYnVmZmVyIGZvciB0
aGUgZnJvbnRidWZmZXIgc2xvdHMKLSAqIEBuZXc6IG5ldyBHRU0gYnVmZmVyIGZvciB0aGUgZnJv
bnRidWZmZXIgc2xvdHMKLSAqIEBmcm9udGJ1ZmZlcl9iaXRzOiBiaXRtYXNrIG9mIGZyb250YnVm
ZmVyIHNsb3RzCi0gKgotICogVGhpcyB1cGRhdGVzIHRoZSBmcm9udGJ1ZmZlciB0cmFja2luZyBi
aXRzIEBmcm9udGJ1ZmZlcl9iaXRzIGJ5IGNsZWFyaW5nIHRoZW0KLSAqIGZyb20gQG9sZCBhbmQg
c2V0dGluZyB0aGVtIGluIEBuZXcuIEJvdGggQG9sZCBhbmQgQG5ldyBjYW4gYmUgTlVMTC4KLSAq
Lwotdm9pZCBpOTE1X2dlbV90cmFja19mYihzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2xk
LAotCQkgICAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm5ldywKLQkJICAgICAgIHVu
c2lnbmVkIGZyb250YnVmZmVyX2JpdHMpCi17Ci0JLyogQ29udHJvbCBvZiBpbmRpdmlkdWFsIGJp
dHMgd2l0aGluIHRoZSBtYXNrIGFyZSBndWFyZGVkIGJ5Ci0JICogdGhlIG93bmluZyBwbGFuZS0+
bXV0ZXgsIGkuZS4gd2UgY2FuIG5ldmVyIHNlZSBjb25jdXJyZW50Ci0JICogbWFuaXB1bGF0aW9u
IG9mIGluZGl2aWR1YWwgYml0cy4gQnV0IHNpbmNlIHRoZSBiaXRmaWVsZCBhcyBhIHdob2xlCi0J
ICogaXMgdXBkYXRlZCB1c2luZyBSTVcsIHdlIG5lZWQgdG8gdXNlIGF0b21pY3MgaW4gb3JkZXIg
dG8gdXBkYXRlCi0JICogdGhlIGJpdHMuCi0JICovCi0JQlVJTERfQlVHX09OKElOVEVMX0ZST05U
QlVGRkVSX0JJVFNfUEVSX1BJUEUgKiBJOTE1X01BWF9QSVBFUyA+Ci0JCSAgICAgQklUU19QRVJf
VFlQRShhdG9taWNfdCkpOwotCi0JaWYgKG9sZCkgewotCQlXQVJOX09OKCEoYXRvbWljX3JlYWQo
Jm9sZC0+ZnJvbnRidWZmZXJfYml0cykgJiBmcm9udGJ1ZmZlcl9iaXRzKSk7Ci0JCWF0b21pY19h
bmRub3QoZnJvbnRidWZmZXJfYml0cywgJm9sZC0+ZnJvbnRidWZmZXJfYml0cyk7Ci0JfQotCi0J
aWYgKG5ldykgewotCQlXQVJOX09OKGF0b21pY19yZWFkKCZuZXctPmZyb250YnVmZmVyX2JpdHMp
ICYgZnJvbnRidWZmZXJfYml0cyk7Ci0JCWF0b21pY19vcihmcm9udGJ1ZmZlcl9iaXRzLCAmbmV3
LT5mcm9udGJ1ZmZlcl9iaXRzKTsKLQl9Ci19Ci0KICNpZiBJU19FTkFCTEVEKENPTkZJR19EUk1f
STkxNV9TRUxGVEVTVCkKICNpbmNsdWRlICJzZWxmdGVzdHMvbW9ja19nZW1fZGV2aWNlLmMiCiAj
aW5jbHVkZSAic2VsZnRlc3RzL2k5MTVfZ2VtLmMiCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3ZtYS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYwppbmRl
eCBjYzA4NDhlZjVkZjAuLmEzMjI0Mzk1MWIyOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV92bWEuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCkBA
IC05MDgsOCArOTA4LDEwIEBAIGludCBpOTE1X3ZtYV9tb3ZlX3RvX2FjdGl2ZShzdHJ1Y3QgaTkx
NV92bWEgKnZtYSwKIAkJcmV0dXJuIGVycjsKIAogCWlmIChmbGFncyAmIEVYRUNfT0JKRUNUX1dS
SVRFKSB7Ci0JCWlmIChpbnRlbF9mYl9vYmpfaW52YWxpZGF0ZShvYmosIE9SSUdJTl9DUykpCi0J
CQlfX2k5MTVfYWN0aXZlX3JlcXVlc3Rfc2V0KCZvYmotPmZyb250YnVmZmVyX3dyaXRlLCBycSk7
CisJCWlmIChpbnRlbF9mcm9udGJ1ZmZlcl9pbnZhbGlkYXRlKG9iai0+ZnJvbnRidWZmZXIsIE9S
SUdJTl9DUykpCisJCQlpOTE1X2FjdGl2ZV9yZWYoJm9iai0+ZnJvbnRidWZmZXItPndyaXRlLAor
CQkJCQlycS0+ZmVuY2UuY29udGV4dCwKKwkJCQkJcnEpOwogCiAJCWRtYV9yZXN2X2FkZF9leGNs
X2ZlbmNlKHZtYS0+cmVzdiwgJnJxLT5mZW5jZSk7CiAJCW9iai0+d3JpdGVfZG9tYWluID0gSTkx
NV9HRU1fRE9NQUlOX1JFTkRFUjsKLS0gCjIuMjMuMC5yYzEKCl9fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwt
Z2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9t
YWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

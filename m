Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id BE7FDAC805
	for <lists+intel-gfx@lfdr.de>; Sat,  7 Sep 2019 19:21:48 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2A1C889DBC;
	Sat,  7 Sep 2019 17:21:47 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga11.intel.com (mga11.intel.com [192.55.52.93])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2CFA589DBF
 for <intel-gfx@lists.freedesktop.org>; Sat,  7 Sep 2019 17:21:45 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga003.fm.intel.com ([10.253.24.29])
 by fmsmga102.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 07 Sep 2019 10:21:45 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,478,1559545200"; d="scan'208";a="191111451"
Received: from genxfsim-desktop.iind.intel.com ([10.223.74.120])
 by FMSMGA003.fm.intel.com with ESMTP; 07 Sep 2019 10:21:42 -0700
From: Anshuman Gupta <anshuman.gupta@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Sat,  7 Sep 2019 22:44:41 +0530
Message-Id: <20190907171443.16181-6-anshuman.gupta@intel.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190907171443.16181-1-anshuman.gupta@intel.com>
References: <20190907171443.16181-1-anshuman.gupta@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v7 5/7] drm/i915/tgl: DC3CO PSR2 helper
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: jani.nikula@intel.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QWRkIGRjM2NvIGhlbHBlciBmdW5jdGlvbnMgdG8gZW5hYmxlL2Rpc2FibGUgcHNyMiBkZWVwIHNs
ZWVwLgpBZGhlcmUgQi5TcGVjcyBieSBkaXNhbGxvdyBEQzNDTyBzdGF0ZSBiZWZvcmUgUFNSMiBl
eGl0LgpFbmFibGUgUFNSMiBleGl0bGluZSBldmVudCBhbmQgcHJvZ3JhbSB0aGUgZGVzaXJlZCBz
Y2FubGluZXMKdG8gZXhpdCBEQzNDTyBpbiBpbnRlbF9wc3JfZW5hYmxlIGZ1bmN0aW9uIGF0IG1v
ZGVzZXQgcGF0aC4KRGlzYWJsZSB0aGUgREMzQ08gZXhpdGxpbmUgaW4gb3JkZXIgdG8gbWFpbnRp
YW4gY29uc2lzdGVudApwaXBlIGNvbmZpZyBzdGF0ZSBpbiBlbmNvZGVyIGRpc2FibGUgcGF0aC4K
CnYxOiBtb3ZlZCBjYWxsaW5nIG9mIHRnbF9lbmFibGVfcHNyMl90cmFuc2NvZGVyX2V4aXRsaW5l
KCkgdG8KICAgIGludGVsX3Bzcl9lbmFibGUoKS4gW0ltcmVdCgpDYzogSmFuaSBOaWt1bGEgPGph
bmkubmlrdWxhQGludGVsLmNvbT4KQ2M6IEltcmUgRGVhayA8aW1yZS5kZWFrQGludGVsLmNvbT4K
Q2M6IEFuaW1lc2ggTWFubmEgPGFuaW1lc2gubWFubmFAaW50ZWwuY29tPgpDYzogSm9zw6kgUm9i
ZXJ0byBkZSBTb3V6YSA8am9zZS5zb3V6YUBpbnRlbC5jb20+ClNpZ25lZC1vZmYtYnk6IEFuc2h1
bWFuIEd1cHRhIDxhbnNodW1hbi5ndXB0YUBpbnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9wc3IuYyB8IDUxICsrKysrKysrKysrKysrKysrKysrKysrKwog
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9wc3IuaCB8ICAyICsKIDIgZmlsZXMg
Y2hhbmdlZCwgNTMgaW5zZXJ0aW9ucygrKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfcHNyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX3Bzci5jCmluZGV4IGIzYzdlZWY1M2JmMy4uOTViMTI5NDZjNzJhIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Bzci5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcHNyLmMKQEAgLTUzNCw2ICs1MzQsNDggQEAgdHJhbnNj
b2Rlcl9oYXNfcHNyMihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gdHJh
bnNjb2RlciB0cmFucykKIAkJcmV0dXJuIHRyYW5zID09IFRSQU5TQ09ERVJfRURQOwogfQogCitz
dGF0aWMgdm9pZCBwc3IyX3Byb2dyYW1faWRsZV9mcmFtZXMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAorCQkJCSAgICAgdTMyIGlkbGVfZnJhbWVzKQoreworCXUzMiB2YWw7CisK
KwlpZGxlX2ZyYW1lcyA8PD0gIEVEUF9QU1IyX0lETEVfRlJBTUVfU0hJRlQ7CisJdmFsID0gSTkx
NV9SRUFEKEVEUF9QU1IyX0NUTChkZXZfcHJpdi0+cHNyLnRyYW5zY29kZXIpKTsKKwl2YWwgJj0g
fkVEUF9QU1IyX0lETEVfRlJBTUVfTUFTSzsKKwl2YWwgfD0gaWRsZV9mcmFtZXM7CisJSTkxNV9X
UklURShFRFBfUFNSMl9DVEwoZGV2X3ByaXYtPnBzci50cmFuc2NvZGVyKSwgdmFsKTsKK30KKwor
dm9pZCB0Z2xfcHNyMl9kZWVwX3NsZWVwX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQoreworCWludCBpZGxlX2ZyYW1lcyA9IDA7CisKKwlwc3IyX3Byb2dyYW1faWRs
ZV9mcmFtZXMoZGV2X3ByaXYsIGlkbGVfZnJhbWVzKTsKK30KKwordm9pZCB0Z2xfcHNyMl9kZWVw
X3NsZWVwX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCit7CisJaW50
IGlkbGVfZnJhbWVzOworCisJLyoKKwkgKiBMZXQncyB1c2UgNiBhcyB0aGUgbWluaW11bSB0byBj
b3ZlciBhbGwga25vd24gY2FzZXMgaW5jbHVkaW5nIHRoZQorCSAqIG9mZi1ieS1vbmUgaXNzdWUg
dGhhdCBIVyBoYXMgaW4gc29tZSBjYXNlcy4KKwkgKi8KKwlpZGxlX2ZyYW1lcyA9IG1heCg2LCBk
ZXZfcHJpdi0+dmJ0LnBzci5pZGxlX2ZyYW1lcyk7CisJaWRsZV9mcmFtZXMgPSBtYXgoaWRsZV9m
cmFtZXMsIGRldl9wcml2LT5wc3Iuc2lua19zeW5jX2xhdGVuY3kgKyAxKTsKKwlwc3IyX3Byb2dy
YW1faWRsZV9mcmFtZXMoZGV2X3ByaXYsIGlkbGVfZnJhbWVzKTsKK30KKworc3RhdGljIHZvaWQg
dGdsX2Rpc2FsbG93X2RjM2NvX29uX3BzcjJfZXhpdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCit7CisJaWYgKCFJU19USUdFUkxBS0UoZGV2X3ByaXYpKQorCQlyZXR1cm47CisK
KwljYW5jZWxfZGVsYXllZF93b3JrKCZkZXZfcHJpdi0+Y3NyLmlkbGVfd29yayk7CisJLyogQmVm
b3JlIFBTUjIgZXhpdCBkaXNhbGxvdyBkYzNjbyovCisJdGdsX3NldF90YXJnZXRfZGNfc3RhdGUo
ZGV2X3ByaXYsIERDX1NUQVRFX0VOX1VQVE9fREM2LCB0cnVlKTsKK30KKwogc3RhdGljIGJvb2wg
aW50ZWxfcHNyMl9jb25maWdfdmFsaWQoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKIAkJCQkg
ICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCiB7CkBAIC03OTksNiArODQx
LDEwIEBAIHZvaWQgaW50ZWxfcHNyX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAog
CiAJV0FSTl9PTihkZXZfcHJpdi0+ZHJycy5kcCk7CiAKKwkvKiBFbmFibGUgUFNSMiB0cmFuc2Nv
ZGVyIGV4aXQgbGluZSAqLworCWlmIChjcnRjX3N0YXRlLT5oYXNfcHNyMikKKwkJdGdsX2VuYWJs
ZV9wc3IyX3RyYW5zY29kZXJfZXhpdGxpbmUoY3J0Y19zdGF0ZSk7CisKIAltdXRleF9sb2NrKCZk
ZXZfcHJpdi0+cHNyLmxvY2spOwogCiAJaWYgKCFwc3JfZ2xvYmFsX2VuYWJsZWQoZGV2X3ByaXYt
PnBzci5kZWJ1ZykpIHsKQEAgLTgyOSw2ICs4NzUsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wc3Jf
ZXhpdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJfQogCiAJaWYgKGRldl9w
cml2LT5wc3IucHNyMl9lbmFibGVkKSB7CisJCXRnbF9kaXNhbGxvd19kYzNjb19vbl9wc3IyX2V4
aXQoZGV2X3ByaXYpOwogCQl2YWwgPSBJOTE1X1JFQUQoRURQX1BTUjJfQ1RMKGRldl9wcml2LT5w
c3IudHJhbnNjb2RlcikpOwogCQlXQVJOX09OKCEodmFsICYgRURQX1BTUjJfRU5BQkxFKSk7CiAJ
CXZhbCAmPSB+RURQX1BTUjJfRU5BQkxFOwpAQCAtODk1LDYgKzk0MiwxMCBAQCB2b2lkIGludGVs
X3Bzcl9kaXNhYmxlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCiAJaWYgKFdBUk5fT04oIUNB
Tl9QU1IoZGV2X3ByaXYpKSkKIAkJcmV0dXJuOwogCisJLyogRGlzYWJsZSBQU1IyIHRyYW5zY29k
ZXIgZXhpdCBsaW5lICovCisJaWYgKG9sZF9jcnRjX3N0YXRlLT5oYXNfcHNyMikKKwkJdGdsX2Rp
c2FibGVfcHNyMl90cmFuc2NvZGVyX2V4aXRsaW5lKG9sZF9jcnRjX3N0YXRlKTsKKwogCW11dGV4
X2xvY2soJmRldl9wcml2LT5wc3IubG9jayk7CiAKIAlpbnRlbF9wc3JfZGlzYWJsZV9sb2NrZWQo
aW50ZWxfZHApOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9wc3IuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcHNyLmgKaW5kZXgg
NDZlNGRlOGI4Y2Q1Li43NWE5ODYyZjM2ZmQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfcHNyLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9wc3IuaApAQCAtMzUsNSArMzUsNyBAQCB2b2lkIGludGVsX3Bzcl9zaG9ydF9wdWxz
ZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKTsKIGludCBpbnRlbF9wc3Jfd2FpdF9mb3JfaWRs
ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUsCiAJCQkgICAg
dTMyICpvdXRfdmFsdWUpOwogYm9vbCBpbnRlbF9wc3JfZW5hYmxlZChzdHJ1Y3QgaW50ZWxfZHAg
KmludGVsX2RwKTsKK3ZvaWQgdGdsX3BzcjJfZGVlcF9zbGVlcF9kaXNhYmxlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cit2b2lkIHRnbF9wc3IyX2RlZXBfc2xlZXBfZW5hYmxl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiAKICNlbmRpZiAvKiBfX0lOVEVM
X1BTUl9IX18gKi8KLS0gCjIuMjEuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGlu
Zm8vaW50ZWwtZ2Z4

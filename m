Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 47F1247AB7
	for <lists+intel-gfx@lfdr.de>; Mon, 17 Jun 2019 09:22:37 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9971A891A1;
	Mon, 17 Jun 2019 07:22:34 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B880B8918F
 for <intel-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 07:22:32 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16923055-1500050 
 for multiple; Mon, 17 Jun 2019 08:19:16 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Mon, 17 Jun 2019 08:19:09 +0100
Message-Id: <20190617071912.20256-19-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190617071912.20256-1-chris@chris-wilson.co.uk>
References: <20190617071912.20256-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 19/22] drm/i915: Extract intel_frontbuffer
 active tracking
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: matthew.auld@intel.com, mika.kuoppala@intel.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

TW92ZSB0aGUgYWN0aXZlIHRyYWNraW5nIGZvciB0aGUgZnJvbnRidWZmZXIgb3BlcmF0aW9ucyBv
dXQgb2YgdGhlCmk5MTVfZ2VtX29iamVjdCBhbmQgaW50byBpdHMgb3duIGZpcnN0IGNsYXNzIChy
ZWZjb3VudGVkKSBvYmplY3QuIEluIHRoZQpwcm9jZXNzIG9mIGRldGFuZ2xpbmcsIHdlIHN3aXRj
aCBmcm9tIGxvdyBsZXZlbCByZXF1ZXN0IHRyYWNraW5nIHRvIHRoZQplYXNpZXIgaTkxNV9hY3Rp
dmUgLS0gd2l0aCB0aGUgcGxhbiB0aGF0IHRoaXMgYXZvaWRzIGFueSBwb3RlbnRpYWwKYXRvbWlj
IGNhbGxiYWNrcyBhcyB0aGUgZnJvbnRidWZmZXIgdHJhY2tpbmcgd2lzaGVzIHRvIHNsZWVwIGFz
IGl0CmZsdXNoZXMuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdp
bHNvbi5jby51az4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY2xmbHVz
aC5jICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9kb21haW4u
YyAgICB8ICAxNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21tYW4uYyAg
ICAgIHwgICA0IC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYyAg
ICB8ICAyOCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oICAg
IHwgICAyICstCiAuLi4vZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaCAg
fCAgIDggKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jICAgICAgICAgICB8
ICAgNSAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oICAgICAgICAgICAgICAgfCAg
IDQgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyAgICAgICAgICAgICAgIHwgIDQ3
ICstLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMgICAgICAgICAgICAgICB8ICAg
NiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGlzcGxheS5jICAgICAgICAgIHwgIDY3
ICsrKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcnYuaCAgICAgICAgICAgICAgfCAg
IDEgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZmJkZXYuYyAgICAgICAgICAgIHwgIDIy
ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9mcm9udGJ1ZmZlci5jICAgICAgfCAyNTUg
KysrKysrKysrKysrKy0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9mcm9udGJ1ZmZl
ci5oICAgICAgfCAgNzAgKysrLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX292ZXJsYXku
YyAgICAgICAgICB8ICAgOCArLQogMTYgZmlsZXMgY2hhbmdlZCwgMzAwIGluc2VydGlvbnMoKyks
IDI0MyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fY2xmbHVzaC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2Ns
Zmx1c2guYwppbmRleCA1MzdhYTIzMzdjYzguLjU0YjQ0NzUzOTQzMCAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NsZmx1c2guYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY2xmbHVzaC5jCkBAIC00Nyw3ICs0Nyw3IEBAIHN0YXRp
YyB2b2lkIF9faTkxNV9kb19jbGZsdXNoKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmop
CiB7CiAJR0VNX0JVR19PTighaTkxNV9nZW1fb2JqZWN0X2hhc19wYWdlcyhvYmopKTsKIAlkcm1f
Y2xmbHVzaF9zZyhvYmotPm1tLnBhZ2VzKTsKLQlpbnRlbF9mYl9vYmpfZmx1c2gob2JqLCBPUklH
SU5fQ1BVKTsKKwlpbnRlbF9mcm9udGJ1ZmZlcl9mbHVzaChvYmotPmZyb250YnVmZmVyLCBPUklH
SU5fQ1BVKTsKIH0KIAogc3RhdGljIHZvaWQgaTkxNV9jbGZsdXNoX3dvcmsoc3RydWN0IHdvcmtf
c3RydWN0ICp3b3JrKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX2RvbWFpbi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5j
CmluZGV4IGJkMTgwZWY0NmFlYi4uN2U2ZWQ3NjczNDhjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZG9tYWluLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5jCkBAIC01NTAsMTMgKzU1MCw2IEBAIGk5MTVfZ2VtX29i
amVjdF9zZXRfdG9fY3B1X2RvbWFpbihzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLCBi
b29sIHdyaXRlKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW5saW5lIGVudW0gZmJfb3Bfb3Jp
Z2luCi1mYl93cml0ZV9vcmlnaW4oc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwgdW5z
aWduZWQgaW50IGRvbWFpbikKLXsKLQlyZXR1cm4gKGRvbWFpbiA9PSBJOTE1X0dFTV9ET01BSU5f
R1RUID8KLQkJb2JqLT5mcm9udGJ1ZmZlcl9nZ3R0X29yaWdpbiA6IE9SSUdJTl9DUFUpOwotfQot
CiAvKioKICAqIENhbGxlZCB3aGVuIHVzZXIgc3BhY2UgcHJlcGFyZXMgdG8gdXNlIGFuIG9iamVj
dCB3aXRoIHRoZSBDUFUsIGVpdGhlcgogICogdGhyb3VnaCB0aGUgbW1hcCBpb2N0bCdzIG1hcHBp
bmcgb3IgYSBHVFQgbWFwcGluZy4KQEAgLTY2MCw5ICs2NTMsOCBAQCBpOTE1X2dlbV9zZXRfZG9t
YWluX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAKIAlpOTE1X2dl
bV9vYmplY3RfdW5sb2NrKG9iaik7CiAKLQlpZiAod3JpdGVfZG9tYWluICE9IDApCi0JCWludGVs
X2ZiX29ial9pbnZhbGlkYXRlKG9iaiwKLQkJCQkJZmJfd3JpdGVfb3JpZ2luKG9iaiwgd3JpdGVf
ZG9tYWluKSk7CisJaWYgKHdyaXRlX2RvbWFpbikKKwkJaW50ZWxfZnJvbnRidWZmZXJfaW52YWxp
ZGF0ZShvYmotPmZyb250YnVmZmVyLCBPUklHSU5fQ1BVKTsKIAogb3V0X3VucGluOgogCWk5MTVf
Z2VtX29iamVjdF91bnBpbl9wYWdlcyhvYmopOwpAQCAtNzgyLDcgKzc3NCw3IEBAIGludCBpOTE1
X2dlbV9vYmplY3RfcHJlcGFyZV93cml0ZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2Jq
LAogCX0KIAogb3V0OgotCWludGVsX2ZiX29ial9pbnZhbGlkYXRlKG9iaiwgT1JJR0lOX0NQVSk7
CisJaW50ZWxfZnJvbnRidWZmZXJfaW52YWxpZGF0ZShvYmotPmZyb250YnVmZmVyLCBPUklHSU5f
Q1BVKTsKIAlvYmotPm1tLmRpcnR5ID0gdHJ1ZTsKIAkvKiByZXR1cm4gd2l0aCB0aGUgcGFnZXMg
cGlubmVkICovCiAJcmV0dXJuIDA7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fbW1hbi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21t
YW4uYwppbmRleCAzOTE2MjFlZTNjYmIuLmJjYzUzYzJiNGY2OSAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21tYW4uYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fbW1hbi5jCkBAIC05OSw5ICs5OSw2IEBAIGk5MTVfZ2VtX21tYXBf
aW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIAkJdXBfd3JpdGUoJm1t
LT5tbWFwX3NlbSk7CiAJCWlmIChJU19FUlJfVkFMVUUoYWRkcikpCiAJCQlnb3RvIGVycjsKLQot
CQkvKiBUaGlzIG1heSByYWNlLCBidXQgdGhhdCdzIG9rLCBpdCBvbmx5IGdldHMgc2V0ICovCi0J
CVdSSVRFX09OQ0Uob2JqLT5mcm9udGJ1ZmZlcl9nZ3R0X29yaWdpbiwgT1JJR0lOX0NQVSk7CiAJ
fQogCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKIApAQCAtMjgxLDcgKzI3OCw2IEBAIHZtX2Zh
dWx0X3QgaTkxNV9nZW1fZmF1bHQoc3RydWN0IHZtX2ZhdWx0ICp2bWYpCiAJCSAqIFVzZXJzcGFj
ZSBpcyBub3cgd3JpdGluZyB0aHJvdWdoIGFuIHVudHJhY2tlZCBWTUEsIGFiYW5kb24KIAkJICog
YWxsIGhvcGUgdGhhdCB0aGUgaGFyZHdhcmUgaXMgYWJsZSB0byB0cmFjayBmdXR1cmUgd3JpdGVz
LgogCQkgKi8KLQkJb2JqLT5mcm9udGJ1ZmZlcl9nZ3R0X29yaWdpbiA9IE9SSUdJTl9DUFU7CiAK
IAkJdm1hID0gaTkxNV9nZW1fb2JqZWN0X2dndHRfcGluKG9iaiwgJnZpZXcsIDAsIDAsIGZsYWdz
KTsKIAkJaWYgKElTX0VSUih2bWEpICYmICF2aWV3LnR5cGUpIHsKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYwppbmRleCAyNTJlNzUyZGEyMTEuLjkxYzM5OTgzNTFk
OSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYwpAQCAtNDQs
MTYgKzQ0LDYgQEAgdm9pZCBpOTE1X2dlbV9vYmplY3RfZnJlZShzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdCAqb2JqKQogCXJldHVybiBrbWVtX2NhY2hlX2ZyZWUoZ2xvYmFsLnNsYWJfb2JqZWN0
cywgb2JqKTsKIH0KIAotc3RhdGljIHZvaWQKLWZyb250YnVmZmVyX3JldGlyZShzdHJ1Y3QgaTkx
NV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlLAotCQkgICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1
ZXN0KQotewotCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPQotCQljb250YWluZXJf
b2YoYWN0aXZlLCB0eXBlb2YoKm9iaiksIGZyb250YnVmZmVyX3dyaXRlKTsKLQotCWludGVsX2Zi
X29ial9mbHVzaChvYmosIE9SSUdJTl9DUyk7Ci19Ci0KIHZvaWQgaTkxNV9nZW1fb2JqZWN0X2lu
aXQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAkJCSAgY29uc3Qgc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3Rfb3BzICpvcHMpCiB7CkBAIC03MiwxMCArNjIsNiBAQCB2b2lkIGk5
MTVfZ2VtX29iamVjdF9pbml0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJcmVz
ZXJ2YXRpb25fb2JqZWN0X2luaXQoJm9iai0+X19idWlsdGluX3Jlc3YpOwogCW9iai0+cmVzdiA9
ICZvYmotPl9fYnVpbHRpbl9yZXN2OwogCi0Jb2JqLT5mcm9udGJ1ZmZlcl9nZ3R0X29yaWdpbiA9
IE9SSUdJTl9HVFQ7Ci0JaTkxNV9hY3RpdmVfcmVxdWVzdF9pbml0KCZvYmotPmZyb250YnVmZmVy
X3dyaXRlLAotCQkJCSBOVUxMLCBmcm9udGJ1ZmZlcl9yZXRpcmUpOwotCiAJb2JqLT5tbS5tYWR2
ID0gSTkxNV9NQURWX1dJTExORUVEOwogCUlOSVRfUkFESVhfVFJFRSgmb2JqLT5tbS5nZXRfcGFn
ZS5yYWRpeCwgR0ZQX0tFUk5FTCB8IF9fR0ZQX05PV0FSTik7CiAJbXV0ZXhfaW5pdCgmb2JqLT5t
bS5nZXRfcGFnZS5sb2NrKTsKQEAgLTE5MCw3ICsxNzYsNiBAQCBzdGF0aWMgdm9pZCBfX2k5MTVf
Z2VtX2ZyZWVfb2JqZWN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAogCQlHRU1f
QlVHX09OKGF0b21pY19yZWFkKCZvYmotPmJpbmRfY291bnQpKTsKIAkJR0VNX0JVR19PTihvYmot
PnVzZXJmYXVsdF9jb3VudCk7Ci0JCUdFTV9CVUdfT04oYXRvbWljX3JlYWQoJm9iai0+ZnJvbnRi
dWZmZXJfYml0cykpOwogCQlHRU1fQlVHX09OKCFsaXN0X2VtcHR5KCZvYmotPmx1dF9saXN0KSk7
CiAKIAkJaWYgKG9iai0+b3BzLT5yZWxlYXNlKQpAQCAtMjk0LDYgKzI3OSw4IEBAIHZvaWQgaTkx
NV9nZW1fZnJlZV9vYmplY3Qoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpnZW1fb2JqKQogewogCXN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPSB0b19pbnRlbF9ibyhnZW1fb2JqKTsKIAor
CUdFTV9CVUdfT04oaTkxNV9nZW1fb2JqZWN0X2lzX2ZyYW1lYnVmZmVyKG9iaikpOworCiAJLyoK
IAkgKiBCZWZvcmUgd2UgZnJlZSB0aGUgb2JqZWN0LCBtYWtlIHN1cmUgYW55IHB1cmUgUkNVLW9u
bHkKIAkgKiByZWFkLXNpZGUgY3JpdGljYWwgc2VjdGlvbnMgYXJlIGNvbXBsZXRlLCBlLmcuCkBA
IC0zMDQsMTMgKzI5MSw2IEBAIHZvaWQgaTkxNV9nZW1fZnJlZV9vYmplY3Qoc3RydWN0IGRybV9n
ZW1fb2JqZWN0ICpnZW1fb2JqKQogCWNhbGxfcmN1KCZvYmotPnJjdSwgX19pOTE1X2dlbV9mcmVl
X29iamVjdF9yY3UpOwogfQogCi1zdGF0aWMgaW5saW5lIGVudW0gZmJfb3Bfb3JpZ2luCi1mYl93
cml0ZV9vcmlnaW4oc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwgdW5zaWduZWQgaW50
IGRvbWFpbikKLXsKLQlyZXR1cm4gKGRvbWFpbiA9PSBJOTE1X0dFTV9ET01BSU5fR1RUID8KLQkJ
b2JqLT5mcm9udGJ1ZmZlcl9nZ3R0X29yaWdpbiA6IE9SSUdJTl9DUFUpOwotfQotCiBzdGF0aWMg
Ym9vbCBncHVfd3JpdGVfbmVlZHNfY2xmbHVzaChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAq
b2JqKQogewogCXJldHVybiAhKG9iai0+Y2FjaGVfbGV2ZWwgPT0gSTkxNV9DQUNIRV9OT05FIHx8
CkBAIC0zMzIsOSArMzEyLDcgQEAgaTkxNV9nZW1fb2JqZWN0X2ZsdXNoX3dyaXRlX2RvbWFpbihz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCXN3aXRjaCAob2JqLT53cml0ZV9kb21h
aW4pIHsKIAljYXNlIEk5MTVfR0VNX0RPTUFJTl9HVFQ6CiAJCWk5MTVfZ2VtX2ZsdXNoX2dndHRf
d3JpdGVzKGRldl9wcml2KTsKLQotCQlpbnRlbF9mYl9vYmpfZmx1c2gob2JqLAotCQkJCSAgIGZi
X3dyaXRlX29yaWdpbihvYmosIEk5MTVfR0VNX0RPTUFJTl9HVFQpKTsKKwkJaW50ZWxfZnJvbnRi
dWZmZXJfZmx1c2gob2JqLT5mcm9udGJ1ZmZlciwgT1JJR0lOX0NQVSk7CiAKIAkJZm9yX2VhY2hf
Z2d0dF92bWEodm1hLCBvYmopIHsKIAkJCWlmICh2bWEtPmlvbWFwKQpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oCmluZGV4IDQ1NGJmYjQ5ODAwMS4uNjdkNzBkMTQ0
YmQ5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0
LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oCkBAIC0x
NjEsNyArMTYxLDcgQEAgaTkxNV9nZW1fb2JqZWN0X25lZWRzX2FzeW5jX2NhbmNlbChjb25zdCBz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogc3RhdGljIGlubGluZSBib29sCiBpOTE1
X2dlbV9vYmplY3RfaXNfZnJhbWVidWZmZXIoY29uc3Qgc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iaikKIHsKLQlyZXR1cm4gUkVBRF9PTkNFKG9iai0+ZnJhbWVidWZmZXJfcmVmZXJlbmNl
cyk7CisJcmV0dXJuIFJFQURfT05DRShvYmotPmZyb250YnVmZmVyKTsKIH0KIAogc3RhdGljIGlu
bGluZSB1bnNpZ25lZCBpbnQKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9vYmplY3RfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9vYmplY3RfdHlwZXMuaAppbmRleCBjMjk5ZmVkMmM2YjEuLjIxYmZiN2JkMGY1NyAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaApAQCAt
MTUsNiArMTUsNyBAQAogI2luY2x1ZGUgImk5MTVfc2VsZnRlc3QuaCIKIAogc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3Q7CitzdHJ1Y3QgaW50ZWxfZnJvbmJ1ZmZlcjsKIAogLyoKICAqIHN0cnVj
dCBpOTE1X2x1dF9oYW5kbGUgdHJhY2tzIHRoZSBmYXN0IGxvb2t1cHMgZnJvbSBoYW5kbGUgdG8g
dm1hIHVzZWQKQEAgLTE0NCw5ICsxNDUsNyBAQCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCB7
CiAJICovCiAJdTE2IHdyaXRlX2RvbWFpbjsKIAotCWF0b21pY190IGZyb250YnVmZmVyX2JpdHM7
Ci0JdW5zaWduZWQgaW50IGZyb250YnVmZmVyX2dndHRfb3JpZ2luOyAvKiB3cml0ZSBvbmNlICov
Ci0Jc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgZnJvbnRidWZmZXJfd3JpdGU7CisJc3RydWN0
IGludGVsX2Zyb250YnVmZmVyICpmcm9udGJ1ZmZlcjsKIAogCS8qKiBDdXJyZW50IHRpbGluZyBz
dHJpZGUgZm9yIHRoZSBvYmplY3QsIGlmIGl0J3MgdGlsZWQuICovCiAJdW5zaWduZWQgaW50IHRp
bGluZ19hbmRfc3RyaWRlOwpAQCAtMjM5LDkgKzIzOCw2IEBAIHN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0IHsKIAkgKi8KIAlzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpyZXN2OwogCi0JLyoq
IFJlZmVyZW5jZXMgZnJvbSBmcmFtZWJ1ZmZlcnMsIGxvY2tzIG91dCB0aWxpbmcgY2hhbmdlcy4g
Ki8KLQl1bnNpZ25lZCBpbnQgZnJhbWVidWZmZXJfcmVmZXJlbmNlczsKLQogCS8qKiBSZWNvcmQg
b2YgYWRkcmVzcyBiaXQgMTcgb2YgZWFjaCBwYWdlIGF0IGxhc3QgdW5iaW5kLiAqLwogCXVuc2ln
bmVkIGxvbmcgKmJpdF8xNzsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kZWJ1Z2ZzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwppbmRleCBm
OWQzNmZhZjQ3NmEuLjhlMmFkMzFhN2RmOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9kZWJ1Z2ZzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2Zz
LmMKQEAgLTEzNSw3ICsxMzUsNiBAQCBkZXNjcmliZV9vYmooc3RydWN0IHNlcV9maWxlICptLCBz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUob2JqLT5iYXNlLmRldik7CiAJc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lOwogCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwotCXVuc2lnbmVkIGludCBmcm9u
dGJ1ZmZlcl9iaXRzOwogCWludCBwaW5fY291bnQgPSAwOwogCiAJc2VxX3ByaW50ZihtLCAiJXBL
OiAlYyVjJWMlYyAlOHpkS2lCICUwMnggJTAyeCAlcyVzJXMiLApAQCAtMjI1LDEwICsyMjQsNiBA
QCBkZXNjcmliZV9vYmooc3RydWN0IHNlcV9maWxlICptLCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29i
amVjdCAqb2JqKQogCWVuZ2luZSA9IGk5MTVfZ2VtX29iamVjdF9sYXN0X3dyaXRlX2VuZ2luZShv
YmopOwogCWlmIChlbmdpbmUpCiAJCXNlcV9wcmludGYobSwgIiAoJXMpIiwgZW5naW5lLT5uYW1l
KTsKLQotCWZyb250YnVmZmVyX2JpdHMgPSBhdG9taWNfcmVhZCgmb2JqLT5mcm9udGJ1ZmZlcl9i
aXRzKTsKLQlpZiAoZnJvbnRidWZmZXJfYml0cykKLQkJc2VxX3ByaW50ZihtLCAiIChmcm9udGJ1
ZmZlcjogMHglMDN4KSIsIGZyb250YnVmZmVyX2JpdHMpOwogfQogCiBzdHJ1Y3QgZmlsZV9zdGF0
cyB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAppbmRleCA5ZGNlMWM3MWJiOWQuLjBhZDI4OTlkMTU2
YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAorKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCkBAIC0yNTM1LDEwICsyNTM1LDYgQEAgaW50IGk5
MTVfZ2VtX21tYXBfZ3R0KHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wcml2LCBzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LAogCQkgICAgICB1MzIgaGFuZGxlLCB1NjQgKm9mZnNldCk7CiBpbnQgaTkxNV9n
ZW1fbW1hcF9ndHRfdmVyc2lvbih2b2lkKTsKIAotdm9pZCBpOTE1X2dlbV90cmFja19mYihzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2xkLAotCQkgICAgICAgc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKm5ldywKLQkJICAgICAgIHVuc2lnbmVkIGZyb250YnVmZmVyX2JpdHMpOwotCiBp
bnQgX19tdXN0X2NoZWNrIGk5MTVfZ2VtX3NldF9nbG9iYWxfc2Vxbm8oc3RydWN0IGRybV9kZXZp
Y2UgKmRldiwgdTMyIHNlcW5vKTsKIAogc3RhdGljIGlubGluZSBib29sIF9faTkxNV93ZWRnZWQo
c3RydWN0IGk5MTVfZ3B1X2Vycm9yICplcnJvcikKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCmluZGV4
IDMzNWVmZWFhZDRmMS4uOGY3OTY4MWY4OTc1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2dlbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKQEAg
LTEzMywxNyArMTMzLDE5IEBAIGk5MTVfZ2VtX3BoeXNfcHdyaXRlKHN0cnVjdCBkcm1faTkxNV9n
ZW1fb2JqZWN0ICpvYmosCiAJdm9pZCAqdmFkZHIgPSBvYmotPnBoeXNfaGFuZGxlLT52YWRkciAr
IGFyZ3MtPm9mZnNldDsKIAljaGFyIF9fdXNlciAqdXNlcl9kYXRhID0gdTY0X3RvX3VzZXJfcHRy
KGFyZ3MtPmRhdGFfcHRyKTsKIAotCS8qIFdlIG1hbnVhbGx5IGNvbnRyb2wgdGhlIGRvbWFpbiBo
ZXJlIGFuZCBwcmV0ZW5kIHRoYXQgaXQKKwkvKgorCSAqIFdlIG1hbnVhbGx5IGNvbnRyb2wgdGhl
IGRvbWFpbiBoZXJlIGFuZCBwcmV0ZW5kIHRoYXQgaXQKIAkgKiByZW1haW5zIGNvaGVyZW50IGku
ZS4gaW4gdGhlIEdUVCBkb21haW4sIGxpa2Ugc2htZW1fcHdyaXRlLgogCSAqLwotCWludGVsX2Zi
X29ial9pbnZhbGlkYXRlKG9iaiwgT1JJR0lOX0NQVSk7CisJaW50ZWxfZnJvbnRidWZmZXJfaW52
YWxpZGF0ZShvYmotPmZyb250YnVmZmVyLCBPUklHSU5fQ1BVKTsKKwogCWlmIChjb3B5X2Zyb21f
dXNlcih2YWRkciwgdXNlcl9kYXRhLCBhcmdzLT5zaXplKSkKIAkJcmV0dXJuIC1FRkFVTFQ7CiAK
IAlkcm1fY2xmbHVzaF92aXJ0X3JhbmdlKHZhZGRyLCBhcmdzLT5zaXplKTsKIAlpOTE1X2dlbV9j
aGlwc2V0X2ZsdXNoKHRvX2k5MTUob2JqLT5iYXNlLmRldikpOwogCi0JaW50ZWxfZmJfb2JqX2Zs
dXNoKG9iaiwgT1JJR0lOX0NQVSk7CisJaW50ZWxfZnJvbnRidWZmZXJfZmx1c2gob2JqLT5mcm9u
dGJ1ZmZlciwgT1JJR0lOX0NQVSk7CiAJcmV0dXJuIDA7CiB9CiAKQEAgLTYzMSw3ICs2MzMsNyBA
QCBpOTE1X2dlbV9ndHRfcHdyaXRlX2Zhc3Qoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
aiwKIAkJZ290byBvdXRfdW5waW47CiAJfQogCi0JaW50ZWxfZmJfb2JqX2ludmFsaWRhdGUob2Jq
LCBPUklHSU5fQ1BVKTsKKwlpbnRlbF9mcm9udGJ1ZmZlcl9pbnZhbGlkYXRlKG9iai0+ZnJvbnRi
dWZmZXIsIE9SSUdJTl9DUFUpOwogCiAJdXNlcl9kYXRhID0gdTY0X3RvX3VzZXJfcHRyKGFyZ3Mt
PmRhdGFfcHRyKTsKIAlvZmZzZXQgPSBhcmdzLT5vZmZzZXQ7CkBAIC02NzIsNyArNjc0LDcgQEAg
aTkxNV9nZW1fZ3R0X3B3cml0ZV9mYXN0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmos
CiAJCXVzZXJfZGF0YSArPSBwYWdlX2xlbmd0aDsKIAkJb2Zmc2V0ICs9IHBhZ2VfbGVuZ3RoOwog
CX0KLQlpbnRlbF9mYl9vYmpfZmx1c2gob2JqLCBPUklHSU5fQ1BVKTsKKwlpbnRlbF9mcm9udGJ1
ZmZlcl9mbHVzaChvYmotPmZyb250YnVmZmVyLCBPUklHSU5fQ1BVKTsKIAogCWk5MTVfZ2VtX29i
amVjdF91bmxvY2tfZmVuY2Uob2JqLCBmZW5jZSk7CiBvdXRfdW5waW46CkBAIC03NjUsNyArNzY3
LDcgQEAgaTkxNV9nZW1fc2htZW1fcHdyaXRlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpv
YmosCiAJCW9mZnNldCA9IDA7CiAJfQogCi0JaW50ZWxfZmJfb2JqX2ZsdXNoKG9iaiwgT1JJR0lO
X0NQVSk7CisJaW50ZWxfZnJvbnRidWZmZXJfZmx1c2gob2JqLT5mcm9udGJ1ZmZlciwgT1JJR0lO
X0NQVSk7CiAJaTkxNV9nZW1fb2JqZWN0X3VubG9ja19mZW5jZShvYmosIGZlbmNlKTsKIAogCXJl
dHVybiByZXQ7CkBAIC0xODcxLDM5ICsxODczLDYgQEAgaW50IGk5MTVfZ2VtX29wZW4oc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkKIAlyZXR1cm4g
cmV0OwogfQogCi0vKioKLSAqIGk5MTVfZ2VtX3RyYWNrX2ZiIC0gdXBkYXRlIGZyb250YnVmZmVy
IHRyYWNraW5nCi0gKiBAb2xkOiBjdXJyZW50IEdFTSBidWZmZXIgZm9yIHRoZSBmcm9udGJ1ZmZl
ciBzbG90cwotICogQG5ldzogbmV3IEdFTSBidWZmZXIgZm9yIHRoZSBmcm9udGJ1ZmZlciBzbG90
cwotICogQGZyb250YnVmZmVyX2JpdHM6IGJpdG1hc2sgb2YgZnJvbnRidWZmZXIgc2xvdHMKLSAq
Ci0gKiBUaGlzIHVwZGF0ZXMgdGhlIGZyb250YnVmZmVyIHRyYWNraW5nIGJpdHMgQGZyb250YnVm
ZmVyX2JpdHMgYnkgY2xlYXJpbmcgdGhlbQotICogZnJvbSBAb2xkIGFuZCBzZXR0aW5nIHRoZW0g
aW4gQG5ldy4gQm90aCBAb2xkIGFuZCBAbmV3IGNhbiBiZSBOVUxMLgotICovCi12b2lkIGk5MTVf
Z2VtX3RyYWNrX2ZiKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvbGQsCi0JCSAgICAgICBz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqbmV3LAotCQkgICAgICAgdW5zaWduZWQgZnJvbnRi
dWZmZXJfYml0cykKLXsKLQkvKiBDb250cm9sIG9mIGluZGl2aWR1YWwgYml0cyB3aXRoaW4gdGhl
IG1hc2sgYXJlIGd1YXJkZWQgYnkKLQkgKiB0aGUgb3duaW5nIHBsYW5lLT5tdXRleCwgaS5lLiB3
ZSBjYW4gbmV2ZXIgc2VlIGNvbmN1cnJlbnQKLQkgKiBtYW5pcHVsYXRpb24gb2YgaW5kaXZpZHVh
bCBiaXRzLiBCdXQgc2luY2UgdGhlIGJpdGZpZWxkIGFzIGEgd2hvbGUKLQkgKiBpcyB1cGRhdGVk
IHVzaW5nIFJNVywgd2UgbmVlZCB0byB1c2UgYXRvbWljcyBpbiBvcmRlciB0byB1cGRhdGUKLQkg
KiB0aGUgYml0cy4KLQkgKi8KLQlCVUlMRF9CVUdfT04oSU5URUxfRlJPTlRCVUZGRVJfQklUU19Q
RVJfUElQRSAqIEk5MTVfTUFYX1BJUEVTID4KLQkJICAgICBCSVRTX1BFUl9UWVBFKGF0b21pY190
KSk7Ci0KLQlpZiAob2xkKSB7Ci0JCVdBUk5fT04oIShhdG9taWNfcmVhZCgmb2xkLT5mcm9udGJ1
ZmZlcl9iaXRzKSAmIGZyb250YnVmZmVyX2JpdHMpKTsKLQkJYXRvbWljX2FuZG5vdChmcm9udGJ1
ZmZlcl9iaXRzLCAmb2xkLT5mcm9udGJ1ZmZlcl9iaXRzKTsKLQl9Ci0KLQlpZiAobmV3KSB7Ci0J
CVdBUk5fT04oYXRvbWljX3JlYWQoJm5ldy0+ZnJvbnRidWZmZXJfYml0cykgJiBmcm9udGJ1ZmZl
cl9iaXRzKTsKLQkJYXRvbWljX29yKGZyb250YnVmZmVyX2JpdHMsICZuZXctPmZyb250YnVmZmVy
X2JpdHMpOwotCX0KLX0KLQogI2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X1NFTEZURVNU
KQogI2luY2x1ZGUgInNlbGZ0ZXN0cy9tb2NrX2dlbV9kZXZpY2UuYyIKICNpbmNsdWRlICJzZWxm
dGVzdHMvaTkxNV9nZW0uYyIKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
dm1hLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCmluZGV4IDNkMjI2NmNjMjFm
OC4uYTBlNDUyMzViNTgxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3Zt
YS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMKQEAgLTkxOSw4ICs5MTks
MTAgQEAgaW50IGk5MTVfdm1hX21vdmVfdG9fYWN0aXZlKHN0cnVjdCBpOTE1X3ZtYSAqdm1hLAog
CWlmIChmbGFncyAmIEVYRUNfT0JKRUNUX1dSSVRFKSB7CiAJCW9iai0+d3JpdGVfZG9tYWluID0g
STkxNV9HRU1fRE9NQUlOX1JFTkRFUjsKIAotCQlpZiAoaW50ZWxfZmJfb2JqX2ludmFsaWRhdGUo
b2JqLCBPUklHSU5fQ1MpKQotCQkJX19pOTE1X2FjdGl2ZV9yZXF1ZXN0X3NldCgmb2JqLT5mcm9u
dGJ1ZmZlcl93cml0ZSwgcnEpOworCQlpZiAoaW50ZWxfZnJvbnRidWZmZXJfaW52YWxpZGF0ZShv
YmotPmZyb250YnVmZmVyLCBPUklHSU5fQ1MpKQorCQkJaTkxNV9hY3RpdmVfcmVmKCZvYmotPmZy
b250YnVmZmVyLT53cml0ZSwKKwkJCQkJcnEtPmZlbmNlLmNvbnRleHQsCisJCQkJCXJxKTsKIAog
CQlvYmotPnJlYWRfZG9tYWlucyA9IDA7CiAJfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfZGlzcGxheS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGlzcGxh
eS5jCmluZGV4IDBiZjFlMDlhY2YyMi4uZmNkMmY1ZWJiYjAyIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9kaXNwbGF5LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfZGlzcGxheS5jCkBAIC0zMDQ3LDEyICszMDQ3LDEzIEBAIGludGVsX2FsbG9jX2luaXRp
YWxfcGxhbmVfb2JqKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAogewogCXN0cnVjdCBkcm1fZGV2
aWNlICpkZXYgPSBjcnRjLT5iYXNlLmRldjsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGRldik7Ci0Jc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9
IE5VTEw7CiAJc3RydWN0IGRybV9tb2RlX2ZiX2NtZDIgbW9kZV9jbWQgPSB7IDAgfTsKIAlzdHJ1
Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9ICZwbGFuZV9jb25maWctPmZiLT5iYXNlOwogCXUzMiBi
YXNlX2FsaWduZWQgPSByb3VuZF9kb3duKHBsYW5lX2NvbmZpZy0+YmFzZSwgUEFHRV9TSVpFKTsK
IAl1MzIgc2l6ZV9hbGlnbmVkID0gcm91bmRfdXAocGxhbmVfY29uZmlnLT5iYXNlICsgcGxhbmVf
Y29uZmlnLT5zaXplLAogCQkJCSAgICBQQUdFX1NJWkUpOworCXN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0ICpvYmo7CisJYm9vbCByZXQgPSBmYWxzZTsKIAogCXNpemVfYWxpZ25lZCAtPSBiYXNl
X2FsaWduZWQ7CiAKQEAgLTMwOTQsNyArMzA5NSw3IEBAIGludGVsX2FsbG9jX2luaXRpYWxfcGxh
bmVfb2JqKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAogCQlicmVhazsKIAlkZWZhdWx0OgogCQlN
SVNTSU5HX0NBU0UocGxhbmVfY29uZmlnLT50aWxpbmcpOwotCQlyZXR1cm4gZmFsc2U7CisJCWdv
dG8gb3V0OwogCX0KIAogCW1vZGVfY21kLnBpeGVsX2Zvcm1hdCA9IGZiLT5mb3JtYXQtPmZvcm1h
dDsKQEAgLTMxMDYsMTYgKzMxMDcsMTUgQEAgaW50ZWxfYWxsb2NfaW5pdGlhbF9wbGFuZV9vYmoo
c3RydWN0IGludGVsX2NydGMgKmNydGMsCiAKIAlpZiAoaW50ZWxfZnJhbWVidWZmZXJfaW5pdCh0
b19pbnRlbF9mcmFtZWJ1ZmZlcihmYiksIG9iaiwgJm1vZGVfY21kKSkgewogCQlEUk1fREVCVUdf
S01TKCJpbnRlbCBmYiBpbml0IGZhaWxlZFxuIik7Ci0JCWdvdG8gb3V0X3VucmVmX29iajsKKwkJ
Z290byBvdXQ7CiAJfQogCiAKIAlEUk1fREVCVUdfS01TKCJpbml0aWFsIHBsYW5lIGZiIG9iaiAl
cFxuIiwgb2JqKTsKLQlyZXR1cm4gdHJ1ZTsKLQotb3V0X3VucmVmX29iajoKKwlyZXQgPSB0cnVl
Oworb3V0OgogCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKLQlyZXR1cm4gZmFsc2U7CisJcmV0
dXJuIHJldDsKIH0KIAogc3RhdGljIHZvaWQKQEAgLTMxNzIsNiArMzE3MiwxMiBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9wbGFuZV9kaXNhYmxlX25vYXRvbWljKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
LAogCWludGVsX2Rpc2FibGVfcGxhbmUocGxhbmUsIGNydGNfc3RhdGUpOwogfQogCitzdGF0aWMg
c3RydWN0IGludGVsX2Zyb250YnVmZmVyICoKK3RvX2ludGVsX2Zyb250YnVmZmVyKHN0cnVjdCBk
cm1fZnJhbWVidWZmZXIgKmZiKQoreworCXJldHVybiBmYiA/IHRvX2ludGVsX2ZyYW1lYnVmZmVy
KGZiKS0+ZnJvbnRidWZmZXIgOiBOVUxMOworfQorCiBzdGF0aWMgdm9pZAogaW50ZWxfZmluZF9p
bml0aWFsX3BsYW5lX29iaihzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YywKIAkJCSAgICAg
c3RydWN0IGludGVsX2luaXRpYWxfcGxhbmVfY29uZmlnICpwbGFuZV9jb25maWcpCkBAIC0zMTc5
LDcgKzMxODUsNiBAQCBpbnRlbF9maW5kX2luaXRpYWxfcGxhbmVfb2JqKHN0cnVjdCBpbnRlbF9j
cnRjICppbnRlbF9jcnRjLAogCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBpbnRlbF9jcnRjLT5i
YXNlLmRldjsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRl
dik7CiAJc3RydWN0IGRybV9jcnRjICpjOwotCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpv
Ymo7CiAJc3RydWN0IGRybV9wbGFuZSAqcHJpbWFyeSA9IGludGVsX2NydGMtPmJhc2UucHJpbWFy
eTsKIAlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSA9IHByaW1hcnktPnN0YXRl
OwogCXN0cnVjdCBpbnRlbF9wbGFuZSAqaW50ZWxfcGxhbmUgPSB0b19pbnRlbF9wbGFuZShwcmlt
YXJ5KTsKQEAgLTMyNTUsOCArMzI2MCw3IEBAIGludGVsX2ZpbmRfaW5pdGlhbF9wbGFuZV9vYmoo
c3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMsCiAJCXJldHVybjsKIAl9CiAKLQlvYmogPSBp
bnRlbF9mYl9vYmooZmIpOwotCWludGVsX2ZiX29ial9mbHVzaChvYmosIE9SSUdJTl9ESVJUWUZC
KTsKKwlpbnRlbF9mcm9udGJ1ZmZlcl9mbHVzaCh0b19pbnRlbF9mcm9udGJ1ZmZlcihmYiksIE9S
SUdJTl9ESVJUWUZCKTsKIAogCXBsYW5lX3N0YXRlLT5zcmNfeCA9IDA7CiAJcGxhbmVfc3RhdGUt
PnNyY195ID0gMDsKQEAgLTMyNzEsMTQgKzMyNzUsMTQgQEAgaW50ZWxfZmluZF9pbml0aWFsX3Bs
YW5lX29iaihzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YywKIAlpbnRlbF9zdGF0ZS0+YmFz
ZS5zcmMgPSBkcm1fcGxhbmVfc3RhdGVfc3JjKHBsYW5lX3N0YXRlKTsKIAlpbnRlbF9zdGF0ZS0+
YmFzZS5kc3QgPSBkcm1fcGxhbmVfc3RhdGVfZGVzdChwbGFuZV9zdGF0ZSk7CiAKLQlpZiAoaTkx
NV9nZW1fb2JqZWN0X2lzX3RpbGVkKG9iaikpCisJaWYgKHBsYW5lX2NvbmZpZy0+dGlsaW5nKQog
CQlkZXZfcHJpdi0+cHJlc2VydmVfYmlvc19zd2l6emxlID0gdHJ1ZTsKIAogCXBsYW5lX3N0YXRl
LT5mYiA9IGZiOwogCXBsYW5lX3N0YXRlLT5jcnRjID0gJmludGVsX2NydGMtPmJhc2U7CiAKIAlh
dG9taWNfb3IodG9faW50ZWxfcGxhbmUocHJpbWFyeSktPmZyb250YnVmZmVyX2JpdCwKLQkJICAm
b2JqLT5mcm9udGJ1ZmZlcl9iaXRzKTsKKwkJICAmdG9faW50ZWxfZnJvbnRidWZmZXIoZmIpLT5i
aXRzKTsKIH0KIAogc3RhdGljIGludCBza2xfbWF4X3BsYW5lX3dpZHRoKGNvbnN0IHN0cnVjdCBk
cm1fZnJhbWVidWZmZXIgKmZiLApAQCAtMTM5ODEsOSArMTM5ODUsOSBAQCBzdGF0aWMgdm9pZCBp
bnRlbF9hdG9taWNfdHJhY2tfZmJzKHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkKIAlp
bnQgaTsKIAogCWZvcl9lYWNoX29sZG5ld19wbGFuZV9pbl9zdGF0ZShzdGF0ZSwgcGxhbmUsIG9s
ZF9wbGFuZV9zdGF0ZSwgbmV3X3BsYW5lX3N0YXRlLCBpKQotCQlpOTE1X2dlbV90cmFja19mYihp
bnRlbF9mYl9vYmoob2xkX3BsYW5lX3N0YXRlLT5mYiksCi0JCQkJICBpbnRlbF9mYl9vYmoobmV3
X3BsYW5lX3N0YXRlLT5mYiksCi0JCQkJICB0b19pbnRlbF9wbGFuZShwbGFuZSktPmZyb250YnVm
ZmVyX2JpdCk7CisJCWludGVsX2Zyb250YnVmZmVyX3RyYWNrKHRvX2ludGVsX2Zyb250YnVmZmVy
KG9sZF9wbGFuZV9zdGF0ZS0+ZmIpLAorCQkJCQl0b19pbnRlbF9mcm9udGJ1ZmZlcihuZXdfcGxh
bmVfc3RhdGUtPmZiKSwKKwkJCQkJdG9faW50ZWxfcGxhbmUocGxhbmUpLT5mcm9udGJ1ZmZlcl9i
aXQpOwogfQogCiAvKioKQEAgLTE0MjkzLDcgKzE0Mjk3LDcgQEAgaW50ZWxfcHJlcGFyZV9wbGFu
ZV9mYihzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKIAkJcmV0dXJuIHJldDsKIAogCWZiX29ial9i
dW1wX3JlbmRlcl9wcmlvcml0eShvYmopOwotCWludGVsX2ZiX29ial9mbHVzaChvYmosIE9SSUdJ
Tl9ESVJUWUZCKTsKKwlpbnRlbF9mcm9udGJ1ZmZlcl9mbHVzaChvYmotPmZyb250YnVmZmVyLCBP
UklHSU5fRElSVFlGQik7CiAKIAlpZiAoIW5ld19zdGF0ZS0+ZmVuY2UpIHsgLyogaW1wbGljaXQg
ZmVuY2luZyAqLwogCQlzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZTsKQEAgLTE0NTYwLDEzICsxNDU2
NCwxMiBAQCBpbnRlbF9sZWdhY3lfY3Vyc29yX3VwZGF0ZShzdHJ1Y3QgZHJtX3BsYW5lICpwbGFu
ZSwKIAkJCSAgIHN0cnVjdCBkcm1fbW9kZXNldF9hY3F1aXJlX2N0eCAqY3R4KQogewogCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+ZGV2KTsKLQlpbnQg
cmV0OwogCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm9sZF9wbGFuZV9zdGF0ZSwgKm5ld19wbGFu
ZV9zdGF0ZTsKIAlzdHJ1Y3QgaW50ZWxfcGxhbmUgKmludGVsX3BsYW5lID0gdG9faW50ZWxfcGxh
bmUocGxhbmUpOwotCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKm9sZF9mYjsKIAlzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9CiAJCXRvX2ludGVsX2NydGNfc3RhdGUoY3J0Yy0+
c3RhdGUpOwogCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0ZTsKKwlpbnQg
cmV0OwogCiAJLyoKIAkgKiBXaGVuIGNydGMgaXMgaW5hY3RpdmUgb3IgdGhlcmUgaXMgYSBtb2Rl
c2V0IHBlbmRpbmcsCkBAIC0xNDYzNCwxMSArMTQ2MzcsMTAgQEAgaW50ZWxfbGVnYWN5X2N1cnNv
cl91cGRhdGUoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsCiAJaWYgKHJldCkKIAkJZ290byBvdXRf
dW5sb2NrOwogCi0JaW50ZWxfZmJfb2JqX2ZsdXNoKGludGVsX2ZiX29iaihmYiksIE9SSUdJTl9G
TElQKTsKLQotCW9sZF9mYiA9IG9sZF9wbGFuZV9zdGF0ZS0+ZmI7Ci0JaTkxNV9nZW1fdHJhY2tf
ZmIoaW50ZWxfZmJfb2JqKG9sZF9mYiksIGludGVsX2ZiX29iaihmYiksCi0JCQkgIGludGVsX3Bs
YW5lLT5mcm9udGJ1ZmZlcl9iaXQpOworCWludGVsX2Zyb250YnVmZmVyX2ZsdXNoKHRvX2ludGVs
X2Zyb250YnVmZmVyKGZiKSwgT1JJR0lOX0ZMSVApOworCWludGVsX2Zyb250YnVmZmVyX3RyYWNr
KHRvX2ludGVsX2Zyb250YnVmZmVyKG9sZF9wbGFuZV9zdGF0ZS0+ZmIpLAorCQkJCXRvX2ludGVs
X2Zyb250YnVmZmVyKGZiKSwKKwkJCQlpbnRlbF9wbGFuZS0+ZnJvbnRidWZmZXJfYml0KTsKIAog
CS8qIFN3YXAgcGxhbmUgc3RhdGUgKi8KIAlwbGFuZS0+c3RhdGUgPSBuZXdfcGxhbmVfc3RhdGU7
CkBAIC0xNTMyOCwxNSArMTUzMzAsOSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9zZXR1cF9vdXRwdXRz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHN0YXRpYyB2b2lkIGludGVsX3Vz
ZXJfZnJhbWVidWZmZXJfZGVzdHJveShzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYikKIHsKIAlz
dHJ1Y3QgaW50ZWxfZnJhbWVidWZmZXIgKmludGVsX2ZiID0gdG9faW50ZWxfZnJhbWVidWZmZXIo
ZmIpOwotCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPSBpbnRlbF9mYl9vYmooZmIp
OwogCiAJZHJtX2ZyYW1lYnVmZmVyX2NsZWFudXAoZmIpOwotCi0JaTkxNV9nZW1fb2JqZWN0X2xv
Y2sob2JqKTsKLQlXQVJOX09OKCFvYmotPmZyYW1lYnVmZmVyX3JlZmVyZW5jZXMtLSk7Ci0JaTkx
NV9nZW1fb2JqZWN0X3VubG9jayhvYmopOwotCi0JaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOwor
CWludGVsX2Zyb250YnVmZmVyX3B1dChpbnRlbF9mYi0+ZnJvbnRidWZmZXIpOwogCiAJa2ZyZWUo
aW50ZWxfZmIpOwogfQpAQCAtMTUzNjQsNyArMTUzNjAsNyBAQCBzdGF0aWMgaW50IGludGVsX3Vz
ZXJfZnJhbWVidWZmZXJfZGlydHkoc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIsCiAJc3RydWN0
IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IGludGVsX2ZiX29iaihmYik7CiAKIAlpOTE1X2dl
bV9vYmplY3RfZmx1c2hfaWZfZGlzcGxheShvYmopOwotCWludGVsX2ZiX29ial9mbHVzaChvYmos
IE9SSUdJTl9ESVJUWUZCKTsKKwlpbnRlbF9mcm9udGJ1ZmZlcl9mbHVzaCh0b19pbnRlbF9mcm9u
dGJ1ZmZlcihmYiksIE9SSUdJTl9ESVJUWUZCKTsKIAogCXJldHVybiAwOwogfQpAQCAtMTUzODYs
OCArMTUzODIsMTEgQEAgc3RhdGljIGludCBpbnRlbF9mcmFtZWJ1ZmZlcl9pbml0KHN0cnVjdCBp
bnRlbF9mcmFtZWJ1ZmZlciAqaW50ZWxfZmIsCiAJaW50IHJldCA9IC1FSU5WQUw7CiAJaW50IGk7
CiAKKwlpbnRlbF9mYi0+ZnJvbnRidWZmZXIgPSBpbnRlbF9mcm9udGJ1ZmZlcl9nZXQob2JqKTsK
KwlpZiAoIWludGVsX2ZiLT5mcm9udGJ1ZmZlcikKKwkJcmV0dXJuIC1FTk9NRU07CisKIAlpOTE1
X2dlbV9vYmplY3RfbG9jayhvYmopOwotCW9iai0+ZnJhbWVidWZmZXJfcmVmZXJlbmNlcysrOwog
CXRpbGluZyA9IGk5MTVfZ2VtX29iamVjdF9nZXRfdGlsaW5nKG9iaik7CiAJc3RyaWRlID0gaTkx
NV9nZW1fb2JqZWN0X2dldF9zdHJpZGUob2JqKTsKIAlpOTE1X2dlbV9vYmplY3RfdW5sb2NrKG9i
aik7CkBAIC0xNTUwNCw5ICsxNTUwMyw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfZnJhbWVidWZmZXJf
aW5pdChzdHJ1Y3QgaW50ZWxfZnJhbWVidWZmZXIgKmludGVsX2ZiLAogCXJldHVybiAwOwogCiBl
cnI6Ci0JaTkxNV9nZW1fb2JqZWN0X2xvY2sob2JqKTsKLQlvYmotPmZyYW1lYnVmZmVyX3JlZmVy
ZW5jZXMtLTsKLQlpOTE1X2dlbV9vYmplY3RfdW5sb2NrKG9iaik7CisJaW50ZWxfZnJvbnRidWZm
ZXJfcHV0KGludGVsX2ZiLT5mcm9udGJ1ZmZlcik7CiAJcmV0dXJuIHJldDsKIH0KIApkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHJ2LmggYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9kcnYuaAppbmRleCAxZDU4ZjdlYzVkODQuLjMxMzQ0OTA1NjQyZCAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfZHJ2LmgKQEAgLTY5LDYgKzY5LDcgQEAgZW51bSBpbnRlbF9vdXRwdXRf
dHlwZSB7CiAKIHN0cnVjdCBpbnRlbF9mcmFtZWJ1ZmZlciB7CiAJc3RydWN0IGRybV9mcmFtZWJ1
ZmZlciBiYXNlOworCXN0cnVjdCBpbnRlbF9mcm9udGJ1ZmZlciAqZnJvbnRidWZmZXI7CiAJc3Ry
dWN0IGludGVsX3JvdGF0aW9uX2luZm8gcm90X2luZm87CiAKIAkvKiBmb3IgZWFjaCBwbGFuZSBp
biB0aGUgbm9ybWFsIEdUVCB2aWV3ICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9mYmRldi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZmJkZXYuYwppbmRl
eCAxZWRkNDRlZTMyYjIuLjVlYWQyNjhkNTVlYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfZmJkZXYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9mYmRl
di5jCkBAIC00NywxMyArNDcsMTQgQEAKICNpbmNsdWRlICJpbnRlbF9mYmRldi5oIgogI2luY2x1
ZGUgImludGVsX2Zyb250YnVmZmVyLmgiCiAKLXN0YXRpYyB2b2lkIGludGVsX2ZiZGV2X2ludmFs
aWRhdGUoc3RydWN0IGludGVsX2ZiZGV2ICppZmJkZXYpCitzdGF0aWMgc3RydWN0IGludGVsX2Zy
b250YnVmZmVyICp0b19mcm9udGJ1ZmZlcihzdHJ1Y3QgaW50ZWxfZmJkZXYgKmlmYmRldikKIHsK
LQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gaW50ZWxfZmJfb2JqKCZpZmJkZXYt
PmZiLT5iYXNlKTsKLQl1bnNpZ25lZCBpbnQgb3JpZ2luID0KLQkJaWZiZGV2LT52bWFfZmxhZ3Mg
JiBQTEFORV9IQVNfRkVOQ0UgPyBPUklHSU5fR1RUIDogT1JJR0lOX0NQVTsKKwlyZXR1cm4gaWZi
ZGV2LT5mYi0+ZnJvbnRidWZmZXI7Cit9CiAKLQlpbnRlbF9mYl9vYmpfaW52YWxpZGF0ZShvYmos
IG9yaWdpbik7CitzdGF0aWMgdm9pZCBpbnRlbF9mYmRldl9pbnZhbGlkYXRlKHN0cnVjdCBpbnRl
bF9mYmRldiAqaWZiZGV2KQoreworCWludGVsX2Zyb250YnVmZmVyX2ludmFsaWRhdGUodG9fZnJv
bnRidWZmZXIoaWZiZGV2KSwgT1JJR0lOX0NQVSk7CiB9CiAKIHN0YXRpYyBpbnQgaW50ZWxfZmJk
ZXZfc2V0X3BhcihzdHJ1Y3QgZmJfaW5mbyAqaW5mbykKQEAgLTE4MCw3ICsxODEsNiBAQCBzdGF0
aWMgaW50IGludGVsZmJfY3JlYXRlKHN0cnVjdCBkcm1fZmJfaGVscGVyICpoZWxwZXIsCiAJY29u
c3Qgc3RydWN0IGk5MTVfZ2d0dF92aWV3IHZpZXcgPSB7CiAJCS50eXBlID0gSTkxNV9HR1RUX1ZJ
RVdfTk9STUFMLAogCX07Ci0Jc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmI7CiAJaW50ZWxfd2Fr
ZXJlZl90IHdha2VyZWY7CiAJc3RydWN0IGZiX2luZm8gKmluZm87CiAJc3RydWN0IGk5MTVfdm1h
ICp2bWE7CkBAIC0yMjYsOCArMjI2LDcgQEAgc3RhdGljIGludCBpbnRlbGZiX2NyZWF0ZShzdHJ1
Y3QgZHJtX2ZiX2hlbHBlciAqaGVscGVyLAogCQlnb3RvIG91dF91bmxvY2s7CiAJfQogCi0JZmIg
PSAmaWZiZGV2LT5mYi0+YmFzZTsKLQlpbnRlbF9mYl9vYmpfZmx1c2goaW50ZWxfZmJfb2JqKGZi
KSwgT1JJR0lOX0RJUlRZRkIpOworCWludGVsX2Zyb250YnVmZmVyX2ZsdXNoKHRvX2Zyb250YnVm
ZmVyKGlmYmRldiksIE9SSUdJTl9ESVJUWUZCKTsKIAogCWluZm8gPSBkcm1fZmJfaGVscGVyX2Fs
bG9jX2ZiaShoZWxwZXIpOwogCWlmIChJU19FUlIoaW5mbykpIHsKQEAgLTIzNiw3ICsyMzUsNyBA
QCBzdGF0aWMgaW50IGludGVsZmJfY3JlYXRlKHN0cnVjdCBkcm1fZmJfaGVscGVyICpoZWxwZXIs
CiAJCWdvdG8gb3V0X3VucGluOwogCX0KIAotCWlmYmRldi0+aGVscGVyLmZiID0gZmI7CisJaWZi
ZGV2LT5oZWxwZXIuZmIgPSAmaWZiZGV2LT5mYi0+YmFzZTsKIAogCWluZm8tPmZib3BzID0gJmlu
dGVsZmJfb3BzOwogCkBAIC0yNjIsMTMgKzI2MSwxNCBAQCBzdGF0aWMgaW50IGludGVsZmJfY3Jl
YXRlKHN0cnVjdCBkcm1fZmJfaGVscGVyICpoZWxwZXIsCiAJICogSWYgdGhlIG9iamVjdCBpcyBz
dG9sZW4gaG93ZXZlciwgaXQgd2lsbCBiZSBmdWxsIG9mIHdoYXRldmVyCiAJICogZ2FyYmFnZSB3
YXMgbGVmdCBpbiB0aGVyZS4KIAkgKi8KLQlpZiAoaW50ZWxfZmJfb2JqKGZiKS0+c3RvbGVuICYm
ICFwcmVhbGxvYykKKwlpZiAodm1hLT5vYmotPnN0b2xlbiAmJiAhcHJlYWxsb2MpCiAJCW1lbXNl
dF9pbyhpbmZvLT5zY3JlZW5fYmFzZSwgMCwgaW5mby0+c2NyZWVuX3NpemUpOwogCiAJLyogVXNl
IGRlZmF1bHQgc2NyYXRjaCBwaXhtYXAgKGluZm8tPnBpeG1hcC5mbGFncyA9IEZCX1BJWE1BUF9T
WVNURU0pICovCiAKIAlEUk1fREVCVUdfS01TKCJhbGxvY2F0ZWQgJWR4JWQgZmI6IDB4JTA4eFxu
IiwKLQkJICAgICAgZmItPndpZHRoLCBmYi0+aGVpZ2h0LCBpOTE1X2dndHRfb2Zmc2V0KHZtYSkp
OworCQkgICAgICBpZmJkZXYtPmZiLT5iYXNlLndpZHRoLCBpZmJkZXYtPmZiLT5iYXNlLmhlaWdo
dCwKKwkJICAgICAgaTkxNV9nZ3R0X29mZnNldCh2bWEpKTsKIAlpZmJkZXYtPnZtYSA9IHZtYTsK
IAlpZmJkZXYtPnZtYV9mbGFncyA9IGZsYWdzOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9mcm9udGJ1ZmZlci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
ZnJvbnRidWZmZXIuYwppbmRleCBkNjAzNmI5YWQxNmEuLjNmYWVlOGU3NThiMCAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZnJvbnRidWZmZXIuYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9mcm9udGJ1ZmZlci5jCkBAIC0zMCwxMSArMzAsMTEgQEAKICAq
IE1hbnkgZmVhdHVyZXMgcmVxdWlyZSB1cyB0byB0cmFjayBjaGFuZ2VzIHRvIHRoZSBjdXJyZW50
bHkgYWN0aXZlCiAgKiBmcm9udGJ1ZmZlciwgZXNwZWNpYWxseSByZW5kZXJpbmcgdGFyZ2V0ZWQg
YXQgdGhlIGZyb250YnVmZmVyLgogICoKLSAqIFRvIGJlIGFibGUgdG8gZG8gc28gR0VNIHRyYWNr
cyBmcm9udGJ1ZmZlcnMgdXNpbmcgYSBiaXRtYXNrIGZvciBhbGwgcG9zc2libGUKLSAqIGZyb250
YnVmZmVyIHNsb3RzIHRocm91Z2ggaTkxNV9nZW1fdHJhY2tfZmIoKS4gVGhlIGZ1bmN0aW9uIGlu
IHRoaXMgZmlsZSBhcmUKLSAqIHRoZW4gY2FsbGVkIHdoZW4gdGhlIGNvbnRlbnRzIG9mIHRoZSBm
cm9udGJ1ZmZlciBhcmUgaW52YWxpZGF0ZWQsIHdoZW4KLSAqIGZyb250YnVmZmVyIHJlbmRlcmlu
ZyBoYXMgc3RvcHBlZCBhZ2FpbiB0byBmbHVzaCBvdXQgYWxsIHRoZSBjaGFuZ2VzIGFuZCB3aGVu
Ci0gKiB0aGUgZnJvbnRidWZmZXIgaXMgZXhjaGFuZ2VkIHdpdGggYSBmbGlwLiBTdWJzeXN0ZW1z
IGludGVyZXN0ZWQgaW4KKyAqIFRvIGJlIGFibGUgdG8gZG8gc28gd2UgdHJhY2sgZnJvbnRidWZm
ZXJzIHVzaW5nIGEgYml0bWFzayBmb3IgYWxsIHBvc3NpYmxlCisgKiBmcm9udGJ1ZmZlciBzbG90
cyB0aHJvdWdoIGludGVsX2Zyb250YnVmZmVyX3RyYWNrKCkuIFRoZSBmdW5jdGlvbnMgaW4gdGhp
cworICogZmlsZSBhcmUgdGhlbiBjYWxsZWQgd2hlbiB0aGUgY29udGVudHMgb2YgdGhlIGZyb250
YnVmZmVyIGFyZSBpbnZhbGlkYXRlZCwKKyAqIHdoZW4gZnJvbnRidWZmZXIgcmVuZGVyaW5nIGhh
cyBzdG9wcGVkIGFnYWluIHRvIGZsdXNoIG91dCBhbGwgdGhlIGNoYW5nZXMKKyAqIGFuZCB3aGVu
IHRoZSBmcm9udGJ1ZmZlciBpcyBleGNoYW5nZWQgd2l0aCBhIGZsaXAuIFN1YnN5c3RlbXMgaW50
ZXJlc3RlZCBpbgogICogZnJvbnRidWZmZXIgY2hhbmdlcyAoZS5nLiBQU1IsIEZCQywgRFJSUykg
c2hvdWxkIGRpcmVjdGx5IHB1dCB0aGVpciBjYWxsYmFja3MKICAqIGludG8gdGhlIHJlbGV2YW50
IHBsYWNlcyBhbmQgZmlsdGVyIGZvciB0aGUgZnJvbnRidWZmZXIgc2xvdHMgdGhhdCB0aGV5IGFy
ZQogICogaW50ZXJlc3RlZCBpbnQuCkBAIC02MiwyOCArNjIsOSBAQAogI2luY2x1ZGUgImludGVs
X2Zyb250YnVmZmVyLmgiCiAjaW5jbHVkZSAiaW50ZWxfcHNyLmgiCiAKLXZvaWQgX19pbnRlbF9m
Yl9vYmpfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAotCQkJICAg
ICAgIGVudW0gZmJfb3Bfb3JpZ2luIG9yaWdpbiwKLQkJCSAgICAgICB1bnNpZ25lZCBpbnQgZnJv
bnRidWZmZXJfYml0cykKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KG9iai0+YmFzZS5kZXYpOwotCi0JaWYgKG9yaWdpbiA9PSBPUklHSU5fQ1MpIHsKLQkJ
c3Bpbl9sb2NrKCZkZXZfcHJpdi0+ZmJfdHJhY2tpbmcubG9jayk7Ci0JCWRldl9wcml2LT5mYl90
cmFja2luZy5idXN5X2JpdHMgfD0gZnJvbnRidWZmZXJfYml0czsKLQkJZGV2X3ByaXYtPmZiX3Ry
YWNraW5nLmZsaXBfYml0cyAmPSB+ZnJvbnRidWZmZXJfYml0czsKLQkJc3Bpbl91bmxvY2soJmRl
dl9wcml2LT5mYl90cmFja2luZy5sb2NrKTsKLQl9Ci0KLQltaWdodF9zbGVlcCgpOwotCWludGVs
X3Bzcl9pbnZhbGlkYXRlKGRldl9wcml2LCBmcm9udGJ1ZmZlcl9iaXRzLCBvcmlnaW4pOwotCWlu
dGVsX2VkcF9kcnJzX2ludmFsaWRhdGUoZGV2X3ByaXYsIGZyb250YnVmZmVyX2JpdHMpOwotCWlu
dGVsX2ZiY19pbnZhbGlkYXRlKGRldl9wcml2LCBmcm9udGJ1ZmZlcl9iaXRzLCBvcmlnaW4pOwot
fQotCiAvKioKLSAqIGludGVsX2Zyb250YnVmZmVyX2ZsdXNoIC0gZmx1c2ggZnJvbnRidWZmZXIK
LSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UKKyAqIGZyb250YnVmZmVyX2ZsdXNoIC0gZmx1c2gg
ZnJvbnRidWZmZXIKKyAqIEBpOTE1OiBpOTE1IGRldmljZQogICogQGZyb250YnVmZmVyX2JpdHM6
IGZyb250YnVmZmVyIHBsYW5lIHRyYWNraW5nIGJpdHMKICAqIEBvcmlnaW46IHdoaWNoIG9wZXJh
dGlvbiBjYXVzZWQgdGhlIGZsdXNoCiAgKgpAQCAtOTMsNDUgKzc0LDI3IEBAIHZvaWQgX19pbnRl
bF9mYl9vYmpfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogICoK
ICAqIENhbiBiZSBjYWxsZWQgd2l0aG91dCBhbnkgbG9ja3MgaGVsZC4KICAqLwotc3RhdGljIHZv
aWQgaW50ZWxfZnJvbnRidWZmZXJfZmx1c2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAotCQkJCSAgICB1bnNpZ25lZCBmcm9udGJ1ZmZlcl9iaXRzLAotCQkJCSAgICBlbnVtIGZi
X29wX29yaWdpbiBvcmlnaW4pCitzdGF0aWMgdm9pZCBmcm9udGJ1ZmZlcl9mbHVzaChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKKwkJCSAgICAgIHVuc2lnbmVkIGludCBmcm9udGJ1ZmZl
cl9iaXRzLAorCQkJICAgICAgZW51bSBmYl9vcF9vcmlnaW4gb3JpZ2luKQogewogCS8qIERlbGF5
IGZsdXNoaW5nIHdoZW4gcmluZ3MgYXJlIHN0aWxsIGJ1c3kuKi8KLQlzcGluX2xvY2soJmRldl9w
cml2LT5mYl90cmFja2luZy5sb2NrKTsKLQlmcm9udGJ1ZmZlcl9iaXRzICY9IH5kZXZfcHJpdi0+
ZmJfdHJhY2tpbmcuYnVzeV9iaXRzOwotCXNwaW5fdW5sb2NrKCZkZXZfcHJpdi0+ZmJfdHJhY2tp
bmcubG9jayk7CisJc3Bpbl9sb2NrKCZpOTE1LT5mYl90cmFja2luZy5sb2NrKTsKKwlmcm9udGJ1
ZmZlcl9iaXRzICY9IH5pOTE1LT5mYl90cmFja2luZy5idXN5X2JpdHM7CisJc3Bpbl91bmxvY2so
Jmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOwogCiAJaWYgKCFmcm9udGJ1ZmZlcl9iaXRzKQogCQly
ZXR1cm47CiAKIAltaWdodF9zbGVlcCgpOwotCWludGVsX2VkcF9kcnJzX2ZsdXNoKGRldl9wcml2
LCBmcm9udGJ1ZmZlcl9iaXRzKTsKLQlpbnRlbF9wc3JfZmx1c2goZGV2X3ByaXYsIGZyb250YnVm
ZmVyX2JpdHMsIG9yaWdpbik7Ci0JaW50ZWxfZmJjX2ZsdXNoKGRldl9wcml2LCBmcm9udGJ1ZmZl
cl9iaXRzLCBvcmlnaW4pOwotfQotCi12b2lkIF9faW50ZWxfZmJfb2JqX2ZsdXNoKHN0cnVjdCBk
cm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCi0JCQkgIGVudW0gZmJfb3Bfb3JpZ2luIG9yaWdpbiwK
LQkJCSAgdW5zaWduZWQgaW50IGZyb250YnVmZmVyX2JpdHMpCi17Ci0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShvYmotPmJhc2UuZGV2KTsKLQotCWlmIChvcmln
aW4gPT0gT1JJR0lOX0NTKSB7Ci0JCXNwaW5fbG9jaygmZGV2X3ByaXYtPmZiX3RyYWNraW5nLmxv
Y2spOwotCQkvKiBGaWx0ZXIgb3V0IG5ldyBiaXRzIHNpbmNlIHJlbmRlcmluZyBzdGFydGVkLiAq
LwotCQlmcm9udGJ1ZmZlcl9iaXRzICY9IGRldl9wcml2LT5mYl90cmFja2luZy5idXN5X2JpdHM7
Ci0JCWRldl9wcml2LT5mYl90cmFja2luZy5idXN5X2JpdHMgJj0gfmZyb250YnVmZmVyX2JpdHM7
Ci0JCXNwaW5fdW5sb2NrKCZkZXZfcHJpdi0+ZmJfdHJhY2tpbmcubG9jayk7Ci0JfQotCi0JaWYg
KGZyb250YnVmZmVyX2JpdHMpCi0JCWludGVsX2Zyb250YnVmZmVyX2ZsdXNoKGRldl9wcml2LCBm
cm9udGJ1ZmZlcl9iaXRzLCBvcmlnaW4pOworCWludGVsX2VkcF9kcnJzX2ZsdXNoKGk5MTUsIGZy
b250YnVmZmVyX2JpdHMpOworCWludGVsX3Bzcl9mbHVzaChpOTE1LCBmcm9udGJ1ZmZlcl9iaXRz
LCBvcmlnaW4pOworCWludGVsX2ZiY19mbHVzaChpOTE1LCBmcm9udGJ1ZmZlcl9iaXRzLCBvcmln
aW4pOwogfQogCiAvKioKICAqIGludGVsX2Zyb250YnVmZmVyX2ZsaXBfcHJlcGFyZSAtIHByZXBh
cmUgYXN5bmNocm9ub3VzIGZyb250YnVmZmVyIGZsaXAKLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZp
Y2UKKyAqIEBpOTE1OiBpOTE1IGRldmljZQogICogQGZyb250YnVmZmVyX2JpdHM6IGZyb250YnVm
ZmVyIHBsYW5lIHRyYWNraW5nIGJpdHMKICAqCiAgKiBUaGlzIGZ1bmN0aW9uIGdldHMgY2FsbGVk
IGFmdGVyIHNjaGVkdWxpbmcgYSBmbGlwIG9uIEBvYmouIFRoZSBhY3R1YWwKQEAgLTE0MSwxOSAr
MTA0LDE5IEBAIHZvaWQgX19pbnRlbF9mYl9vYmpfZmx1c2goc3RydWN0IGRybV9pOTE1X2dlbV9v
YmplY3QgKm9iaiwKICAqCiAgKiBDYW4gYmUgY2FsbGVkIHdpdGhvdXQgYW55IGxvY2tzIGhlbGQu
CiAgKi8KLXZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmxpcF9wcmVwYXJlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKK3ZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmxpcF9wcmVwYXJl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCQkJCSAgICB1bnNpZ25lZCBmcm9udGJ1
ZmZlcl9iaXRzKQogewotCXNwaW5fbG9jaygmZGV2X3ByaXYtPmZiX3RyYWNraW5nLmxvY2spOwot
CWRldl9wcml2LT5mYl90cmFja2luZy5mbGlwX2JpdHMgfD0gZnJvbnRidWZmZXJfYml0czsKKwlz
cGluX2xvY2soJmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOworCWk5MTUtPmZiX3RyYWNraW5nLmZs
aXBfYml0cyB8PSBmcm9udGJ1ZmZlcl9iaXRzOwogCS8qIFJlbW92ZSBzdGFsZSBidXN5IGJpdHMg
ZHVlIHRvIHRoZSBvbGQgYnVmZmVyLiAqLwotCWRldl9wcml2LT5mYl90cmFja2luZy5idXN5X2Jp
dHMgJj0gfmZyb250YnVmZmVyX2JpdHM7Ci0Jc3Bpbl91bmxvY2soJmRldl9wcml2LT5mYl90cmFj
a2luZy5sb2NrKTsKKwlpOTE1LT5mYl90cmFja2luZy5idXN5X2JpdHMgJj0gfmZyb250YnVmZmVy
X2JpdHM7CisJc3Bpbl91bmxvY2soJmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOwogfQogCiAvKioK
ICAqIGludGVsX2Zyb250YnVmZmVyX2ZsaXBfY29tcGxldGUgLSBjb21wbGV0ZSBhc3luY2hyb25v
dXMgZnJvbnRidWZmZXIgZmxpcAotICogQGRldl9wcml2OiBpOTE1IGRldmljZQorICogQGk5MTU6
IGk5MTUgZGV2aWNlCiAgKiBAZnJvbnRidWZmZXJfYml0czogZnJvbnRidWZmZXIgcGxhbmUgdHJh
Y2tpbmcgYml0cwogICoKICAqIFRoaXMgZnVuY3Rpb24gZ2V0cyBjYWxsZWQgYWZ0ZXIgdGhlIGZs
aXAgaGFzIGJlZW4gbGF0Y2hlZCBhbmQgd2lsbCBjb21wbGV0ZQpAQCAtMTYxLDIzICsxMjQsMjIg
QEAgdm9pZCBpbnRlbF9mcm9udGJ1ZmZlcl9mbGlwX3ByZXBhcmUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAogICoKICAqIENhbiBiZSBjYWxsZWQgd2l0aG91dCBhbnkgbG9ja3Mg
aGVsZC4KICAqLwotdm9pZCBpbnRlbF9mcm9udGJ1ZmZlcl9mbGlwX2NvbXBsZXRlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKK3ZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmxpcF9j
b21wbGV0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJCQkgICAgIHVuc2lnbmVk
IGZyb250YnVmZmVyX2JpdHMpCiB7Ci0Jc3Bpbl9sb2NrKCZkZXZfcHJpdi0+ZmJfdHJhY2tpbmcu
bG9jayk7CisJc3Bpbl9sb2NrKCZpOTE1LT5mYl90cmFja2luZy5sb2NrKTsKIAkvKiBNYXNrIGFu
eSBjYW5jZWxsZWQgZmxpcHMuICovCi0JZnJvbnRidWZmZXJfYml0cyAmPSBkZXZfcHJpdi0+ZmJf
dHJhY2tpbmcuZmxpcF9iaXRzOwotCWRldl9wcml2LT5mYl90cmFja2luZy5mbGlwX2JpdHMgJj0g
fmZyb250YnVmZmVyX2JpdHM7Ci0Jc3Bpbl91bmxvY2soJmRldl9wcml2LT5mYl90cmFja2luZy5s
b2NrKTsKKwlmcm9udGJ1ZmZlcl9iaXRzICY9IGk5MTUtPmZiX3RyYWNraW5nLmZsaXBfYml0czsK
KwlpOTE1LT5mYl90cmFja2luZy5mbGlwX2JpdHMgJj0gfmZyb250YnVmZmVyX2JpdHM7CisJc3Bp
bl91bmxvY2soJmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOwogCiAJaWYgKGZyb250YnVmZmVyX2Jp
dHMpCi0JCWludGVsX2Zyb250YnVmZmVyX2ZsdXNoKGRldl9wcml2LAotCQkJCQlmcm9udGJ1ZmZl
cl9iaXRzLCBPUklHSU5fRkxJUCk7CisJCWZyb250YnVmZmVyX2ZsdXNoKGk5MTUsIGZyb250YnVm
ZmVyX2JpdHMsIE9SSUdJTl9GTElQKTsKIH0KIAogLyoqCiAgKiBpbnRlbF9mcm9udGJ1ZmZlcl9m
bGlwIC0gc3luY2hyb25vdXMgZnJvbnRidWZmZXIgZmxpcAotICogQGRldl9wcml2OiBpOTE1IGRl
dmljZQorICogQGk5MTU6IGk5MTUgZGV2aWNlCiAgKiBAZnJvbnRidWZmZXJfYml0czogZnJvbnRi
dWZmZXIgcGxhbmUgdHJhY2tpbmcgYml0cwogICoKICAqIFRoaXMgZnVuY3Rpb24gZ2V0cyBjYWxs
ZWQgYWZ0ZXIgc2NoZWR1bGluZyBhIGZsaXAgb24gQG9iai4gVGhpcyBpcyBmb3IKQEAgLTE4Niwx
MyArMTQ4LDE2MCBAQCB2b2lkIGludGVsX2Zyb250YnVmZmVyX2ZsaXBfY29tcGxldGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogICoKICAqIENhbiBiZSBjYWxsZWQgd2l0aG91
dCBhbnkgbG9ja3MgaGVsZC4KICAqLwotdm9pZCBpbnRlbF9mcm9udGJ1ZmZlcl9mbGlwKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKK3ZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmxp
cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJCSAgICB1bnNpZ25lZCBmcm9udGJ1
ZmZlcl9iaXRzKQogewotCXNwaW5fbG9jaygmZGV2X3ByaXYtPmZiX3RyYWNraW5nLmxvY2spOwor
CXNwaW5fbG9jaygmaTkxNS0+ZmJfdHJhY2tpbmcubG9jayk7CiAJLyogUmVtb3ZlIHN0YWxlIGJ1
c3kgYml0cyBkdWUgdG8gdGhlIG9sZCBidWZmZXIuICovCi0JZGV2X3ByaXYtPmZiX3RyYWNraW5n
LmJ1c3lfYml0cyAmPSB+ZnJvbnRidWZmZXJfYml0czsKLQlzcGluX3VubG9jaygmZGV2X3ByaXYt
PmZiX3RyYWNraW5nLmxvY2spOworCWk5MTUtPmZiX3RyYWNraW5nLmJ1c3lfYml0cyAmPSB+ZnJv
bnRidWZmZXJfYml0czsKKwlzcGluX3VubG9jaygmaTkxNS0+ZmJfdHJhY2tpbmcubG9jayk7CiAK
LQlpbnRlbF9mcm9udGJ1ZmZlcl9mbHVzaChkZXZfcHJpdiwgZnJvbnRidWZmZXJfYml0cywgT1JJ
R0lOX0ZMSVApOworCWZyb250YnVmZmVyX2ZsdXNoKGk5MTUsIGZyb250YnVmZmVyX2JpdHMsIE9S
SUdJTl9GTElQKTsKK30KKwordm9pZCBfX2ludGVsX2ZiX2ludmFsaWRhdGUoc3RydWN0IGludGVs
X2Zyb250YnVmZmVyICpmcm9udCwKKwkJCSAgIGVudW0gZmJfb3Bfb3JpZ2luIG9yaWdpbiwKKwkJ
CSAgIHVuc2lnbmVkIGludCBmcm9udGJ1ZmZlcl9iaXRzKQoreworCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShmcm9udC0+b2JqLT5iYXNlLmRldik7CisKKwlpZiAob3Jp
Z2luID09IE9SSUdJTl9DUykgeworCQlzcGluX2xvY2soJmk5MTUtPmZiX3RyYWNraW5nLmxvY2sp
OworCQlpOTE1LT5mYl90cmFja2luZy5idXN5X2JpdHMgfD0gZnJvbnRidWZmZXJfYml0czsKKwkJ
aTkxNS0+ZmJfdHJhY2tpbmcuZmxpcF9iaXRzICY9IH5mcm9udGJ1ZmZlcl9iaXRzOworCQlzcGlu
X3VubG9jaygmaTkxNS0+ZmJfdHJhY2tpbmcubG9jayk7CisJfQorCisJbWlnaHRfc2xlZXAoKTsK
KwlpbnRlbF9wc3JfaW52YWxpZGF0ZShpOTE1LCBmcm9udGJ1ZmZlcl9iaXRzLCBvcmlnaW4pOwor
CWludGVsX2VkcF9kcnJzX2ludmFsaWRhdGUoaTkxNSwgZnJvbnRidWZmZXJfYml0cyk7CisJaW50
ZWxfZmJjX2ludmFsaWRhdGUoaTkxNSwgZnJvbnRidWZmZXJfYml0cywgb3JpZ2luKTsKK30KKwor
dm9pZCBfX2ludGVsX2ZiX2ZsdXNoKHN0cnVjdCBpbnRlbF9mcm9udGJ1ZmZlciAqZnJvbnQsCisJ
CSAgICAgIGVudW0gZmJfb3Bfb3JpZ2luIG9yaWdpbiwKKwkJICAgICAgdW5zaWduZWQgaW50IGZy
b250YnVmZmVyX2JpdHMpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGZyb250LT5vYmotPmJhc2UuZGV2KTsKKworCWlmIChvcmlnaW4gPT0gT1JJR0lOX0NTKSB7
CisJCXNwaW5fbG9jaygmaTkxNS0+ZmJfdHJhY2tpbmcubG9jayk7CisJCS8qIEZpbHRlciBvdXQg
bmV3IGJpdHMgc2luY2UgcmVuZGVyaW5nIHN0YXJ0ZWQuICovCisJCWZyb250YnVmZmVyX2JpdHMg
Jj0gaTkxNS0+ZmJfdHJhY2tpbmcuYnVzeV9iaXRzOworCQlpOTE1LT5mYl90cmFja2luZy5idXN5
X2JpdHMgJj0gfmZyb250YnVmZmVyX2JpdHM7CisJCXNwaW5fdW5sb2NrKCZpOTE1LT5mYl90cmFj
a2luZy5sb2NrKTsKKwl9CisKKwlpZiAoZnJvbnRidWZmZXJfYml0cykKKwkJZnJvbnRidWZmZXJf
Zmx1c2goaTkxNSwgZnJvbnRidWZmZXJfYml0cywgb3JpZ2luKTsKK30KKworc3RhdGljIGludCBm
cm9udGJ1ZmZlcl9hY3RpdmUoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCit7CisJc3RydWN0IGlu
dGVsX2Zyb250YnVmZmVyICpmcm9udCA9CisJCWNvbnRhaW5lcl9vZihyZWYsIHR5cGVvZigqZnJv
bnQpLCB3cml0ZSk7CisKKwlrcmVmX2dldCgmZnJvbnQtPnJlZik7CisJcmV0dXJuIDA7Cit9CisK
K3N0YXRpYyB2b2lkIGZyb250YnVmZmVyX3JldGlyZShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZikK
K3sKKwlzdHJ1Y3QgaW50ZWxfZnJvbnRidWZmZXIgKmZyb250ID0KKwkJY29udGFpbmVyX29mKHJl
ZiwgdHlwZW9mKCpmcm9udCksIHdyaXRlKTsKKworCWludGVsX2Zyb250YnVmZmVyX2ZsdXNoKGZy
b250LCBPUklHSU5fQ1MpOworCWludGVsX2Zyb250YnVmZmVyX3B1dChmcm9udCk7Cit9CisKK3N0
YXRpYyB2b2lkIGZyb250YnVmZmVyX3JlbGVhc2Uoc3RydWN0IGtyZWYgKnJlZikKK3sKKwlzdHJ1
Y3QgaW50ZWxfZnJvbnRidWZmZXIgKmZyb250ID0KKwkJY29udGFpbmVyX29mKHJlZiwgdHlwZW9m
KCpmcm9udCksIHJlZik7CisKKwlmcm9udC0+b2JqLT5mcm9udGJ1ZmZlciA9IE5VTEw7CisJc3Bp
bl91bmxvY2soJnRvX2k5MTUoZnJvbnQtPm9iai0+YmFzZS5kZXYpLT5mYl90cmFja2luZy5sb2Nr
KTsKKworCWk5MTVfZ2VtX29iamVjdF9wdXQoZnJvbnQtPm9iaik7CisJa2ZyZWUoZnJvbnQpOwor
fQorCitzdHJ1Y3QgaW50ZWxfZnJvbnRidWZmZXIgKgoraW50ZWxfZnJvbnRidWZmZXJfZ2V0KHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KG9iai0+YmFzZS5kZXYpOworCXN0cnVjdCBpbnRlbF9mcm9udGJ1
ZmZlciAqZnJvbnQ7CisKKwlzcGluX2xvY2soJmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOworCWZy
b250ID0gb2JqLT5mcm9udGJ1ZmZlcjsKKwlpZiAoZnJvbnQpCisJCWtyZWZfZ2V0KCZmcm9udC0+
cmVmKTsKKwlzcGluX3VubG9jaygmaTkxNS0+ZmJfdHJhY2tpbmcubG9jayk7CisJaWYgKGZyb250
KQorCQlyZXR1cm4gZnJvbnQ7CisKKwlmcm9udCA9IGttYWxsb2Moc2l6ZW9mKCpmcm9udCksIEdG
UF9LRVJORUwpOworCWlmICghZnJvbnQpCisJCXJldHVybiBOVUxMOworCisJZnJvbnQtPm9iaiA9
IG9iajsKKwlrcmVmX2luaXQoJmZyb250LT5yZWYpOworCWF0b21pY19zZXQoJmZyb250LT5iaXRz
LCAwKTsKKwlpOTE1X2FjdGl2ZV9pbml0KGk5MTUsICZmcm9udC0+d3JpdGUsCisJCQkgZnJvbnRi
dWZmZXJfYWN0aXZlLAorCQkJIGk5MTVfYWN0aXZlX21heV9zbGVlcChmcm9udGJ1ZmZlcl9yZXRp
cmUpKTsKKworCXNwaW5fbG9jaygmaTkxNS0+ZmJfdHJhY2tpbmcubG9jayk7CisJaWYgKG9iai0+
ZnJvbnRidWZmZXIpIHsKKwkJa2ZyZWUoZnJvbnQpOworCQlmcm9udCA9IG9iai0+ZnJvbnRidWZm
ZXI7CisJCWtyZWZfZ2V0KCZmcm9udC0+cmVmKTsKKwl9IGVsc2UgeworCQlpOTE1X2dlbV9vYmpl
Y3RfZ2V0KG9iaik7CisJCW9iai0+ZnJvbnRidWZmZXIgPSBmcm9udDsKKwl9CisJc3Bpbl91bmxv
Y2soJmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOworCisJcmV0dXJuIGZyb250OworfQorCit2b2lk
IGludGVsX2Zyb250YnVmZmVyX3B1dChzdHJ1Y3QgaW50ZWxfZnJvbnRidWZmZXIgKmZyb250KQor
eworCWtyZWZfcHV0X2xvY2soJmZyb250LT5yZWYsCisJCSAgICAgIGZyb250YnVmZmVyX3JlbGVh
c2UsCisJCSAgICAgICZ0b19pOTE1KGZyb250LT5vYmotPmJhc2UuZGV2KS0+ZmJfdHJhY2tpbmcu
bG9jayk7Cit9CisKKy8qKgorICogaW50ZWxfZnJvbnRidWZmZXJfdHJhY2sgLSB1cGRhdGUgZnJv
bnRidWZmZXIgdHJhY2tpbmcKKyAqIEBvbGQ6IGN1cnJlbnQgYnVmZmVyIGZvciB0aGUgZnJvbnRi
dWZmZXIgc2xvdHMKKyAqIEBuZXc6IG5ldyBidWZmZXIgZm9yIHRoZSBmcm9udGJ1ZmZlciBzbG90
cworICogQGZyb250YnVmZmVyX2JpdHM6IGJpdG1hc2sgb2YgZnJvbnRidWZmZXIgc2xvdHMKKyAq
CisgKiBUaGlzIHVwZGF0ZXMgdGhlIGZyb250YnVmZmVyIHRyYWNraW5nIGJpdHMgQGZyb250YnVm
ZmVyX2JpdHMgYnkgY2xlYXJpbmcgdGhlbQorICogZnJvbSBAb2xkIGFuZCBzZXR0aW5nIHRoZW0g
aW4gQG5ldy4gQm90aCBAb2xkIGFuZCBAbmV3IGNhbiBiZSBOVUxMLgorICovCit2b2lkIGludGVs
X2Zyb250YnVmZmVyX3RyYWNrKHN0cnVjdCBpbnRlbF9mcm9udGJ1ZmZlciAqb2xkLAorCQkJICAg
ICBzdHJ1Y3QgaW50ZWxfZnJvbnRidWZmZXIgKm5ldywKKwkJCSAgICAgdW5zaWduZWQgaW50IGZy
b250YnVmZmVyX2JpdHMpCit7CisJLyoKKwkgKiBDb250cm9sIG9mIGluZGl2aWR1YWwgYml0cyB3
aXRoaW4gdGhlIG1hc2sgYXJlIGd1YXJkZWQgYnkKKwkgKiB0aGUgb3duaW5nIHBsYW5lLT5tdXRl
eCwgaS5lLiB3ZSBjYW4gbmV2ZXIgc2VlIGNvbmN1cnJlbnQKKwkgKiBtYW5pcHVsYXRpb24gb2Yg
aW5kaXZpZHVhbCBiaXRzLiBCdXQgc2luY2UgdGhlIGJpdGZpZWxkIGFzIGEgd2hvbGUKKwkgKiBp
cyB1cGRhdGVkIHVzaW5nIFJNVywgd2UgbmVlZCB0byB1c2UgYXRvbWljcyBpbiBvcmRlciB0byB1
cGRhdGUKKwkgKiB0aGUgYml0cy4KKwkgKi8KKwlCVUlMRF9CVUdfT04oSU5URUxfRlJPTlRCVUZG
RVJfQklUU19QRVJfUElQRSAqIEk5MTVfTUFYX1BJUEVTID4KKwkJICAgICBCSVRTX1BFUl9UWVBF
KGF0b21pY190KSk7CisKKwlpZiAob2xkKSB7CisJCVdBUk5fT04oIShhdG9taWNfcmVhZCgmb2xk
LT5iaXRzKSAmIGZyb250YnVmZmVyX2JpdHMpKTsKKwkJYXRvbWljX2FuZG5vdChmcm9udGJ1ZmZl
cl9iaXRzLCAmb2xkLT5iaXRzKTsKKwl9CisKKwlpZiAobmV3KSB7CisJCVdBUk5fT04oYXRvbWlj
X3JlYWQoJm5ldy0+Yml0cykgJiBmcm9udGJ1ZmZlcl9iaXRzKTsKKwkJYXRvbWljX29yKGZyb250
YnVmZmVyX2JpdHMsICZuZXctPmJpdHMpOworCX0KIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX2Zyb250YnVmZmVyLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9mcm9udGJ1ZmZlci5oCmluZGV4IDU3MjczMjBjODA4NC4uYWRjNjRkNjFhNGE1IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9mcm9udGJ1ZmZlci5oCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX2Zyb250YnVmZmVyLmgKQEAgLTI0LDcgKzI0LDEwIEBACiAj
aWZuZGVmIF9fSU5URUxfRlJPTlRCVUZGRVJfSF9fCiAjZGVmaW5lIF9fSU5URUxfRlJPTlRCVUZG
RVJfSF9fCiAKLSNpbmNsdWRlICJnZW0vaTkxNV9nZW1fb2JqZWN0LmgiCisjaW5jbHVkZSA8bGlu
dXgvYXRvbWljLmg+CisjaW5jbHVkZSA8bGludXgva3JlZi5oPgorCisjaW5jbHVkZSAiaTkxNV9h
Y3RpdmUuaCIKIAogc3RydWN0IGRybV9pOTE1X3ByaXZhdGU7CiBzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdDsKQEAgLTM3LDIzICs0MCwzMCBAQCBlbnVtIGZiX29wX29yaWdpbiB7CiAJT1JJR0lO
X0RJUlRZRkIsCiB9OwogCi12b2lkIGludGVsX2Zyb250YnVmZmVyX2ZsaXBfcHJlcGFyZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCitzdHJ1Y3QgaW50ZWxfZnJvbnRidWZmZXIg
eworCXN0cnVjdCBrcmVmIHJlZjsKKwlhdG9taWNfdCBiaXRzOworCXN0cnVjdCBpOTE1X2FjdGl2
ZSB3cml0ZTsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOworfTsKKwordm9pZCBp
bnRlbF9mcm9udGJ1ZmZlcl9mbGlwX3ByZXBhcmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCiAJCQkJICAgIHVuc2lnbmVkIGZyb250YnVmZmVyX2JpdHMpOwotdm9pZCBpbnRlbF9mcm9u
dGJ1ZmZlcl9mbGlwX2NvbXBsZXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
K3ZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmxpcF9jb21wbGV0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKIAkJCQkgICAgIHVuc2lnbmVkIGZyb250YnVmZmVyX2JpdHMpOwotdm9pZCBp
bnRlbF9mcm9udGJ1ZmZlcl9mbGlwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
K3ZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmxpcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKIAkJCSAgICB1bnNpZ25lZCBmcm9udGJ1ZmZlcl9iaXRzKTsKIAotdm9pZCBfX2ludGVsX2Zi
X29ial9pbnZhbGlkYXRlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCi0JCQkgICAg
ICAgZW51bSBmYl9vcF9vcmlnaW4gb3JpZ2luLAotCQkJICAgICAgIHVuc2lnbmVkIGludCBmcm9u
dGJ1ZmZlcl9iaXRzKTsKLXZvaWQgX19pbnRlbF9mYl9vYmpfZmx1c2goc3RydWN0IGRybV9pOTE1
X2dlbV9vYmplY3QgKm9iaiwKLQkJCSAgZW51bSBmYl9vcF9vcmlnaW4gb3JpZ2luLAotCQkJICB1
bnNpZ25lZCBpbnQgZnJvbnRidWZmZXJfYml0cyk7CitzdHJ1Y3QgaW50ZWxfZnJvbnRidWZmZXIg
KgoraW50ZWxfZnJvbnRidWZmZXJfZ2V0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmop
OworCit2b2lkIF9faW50ZWxfZmJfaW52YWxpZGF0ZShzdHJ1Y3QgaW50ZWxfZnJvbnRidWZmZXIg
KmZyb250LAorCQkJICAgZW51bSBmYl9vcF9vcmlnaW4gb3JpZ2luLAorCQkJICAgdW5zaWduZWQg
aW50IGZyb250YnVmZmVyX2JpdHMpOwogCiAvKioKLSAqIGludGVsX2ZiX29ial9pbnZhbGlkYXRl
IC0gaW52YWxpZGF0ZSBmcm9udGJ1ZmZlciBvYmplY3QKLSAqIEBvYmo6IEdFTSBvYmplY3QgdG8g
aW52YWxpZGF0ZQorICogaW50ZWxfZnJvbnRidWZmZXJfaW52YWxpZGF0ZSAtIGludmFsaWRhdGUg
ZnJvbnRidWZmZXIgb2JqZWN0CisgKiBAZnJvbnQ6IEdFTSBvYmplY3QgdG8gaW52YWxpZGF0ZQog
ICogQG9yaWdpbjogd2hpY2ggb3BlcmF0aW9uIGNhdXNlZCB0aGUgaW52YWxpZGF0aW9uCiAgKgog
ICogVGhpcyBmdW5jdGlvbiBnZXRzIGNhbGxlZCBldmVyeSB0aW1lIHJlbmRlcmluZyBvbiB0aGUg
Z2l2ZW4gb2JqZWN0IHN0YXJ0cyBhbmQKQEAgLTYyLDM3ICs3Miw1MyBAQCB2b2lkIF9faW50ZWxf
ZmJfb2JqX2ZsdXNoKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAgKiB1bnRpbCB0
aGUgcmVuZGVyaW5nIGNvbXBsZXRlcyBvciBhIGZsaXAgb24gdGhpcyBmcm9udGJ1ZmZlciBwbGFu
ZSBpcwogICogc2NoZWR1bGVkLgogICovCi1zdGF0aWMgaW5saW5lIGJvb2wgaW50ZWxfZmJfb2Jq
X2ludmFsaWRhdGUoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKLQkJCQkJICAgZW51
bSBmYl9vcF9vcmlnaW4gb3JpZ2luKQorc3RhdGljIGlubGluZSBib29sIGludGVsX2Zyb250YnVm
ZmVyX2ludmFsaWRhdGUoc3RydWN0IGludGVsX2Zyb250YnVmZmVyICpmcm9udCwKKwkJCQkJCWVu
dW0gZmJfb3Bfb3JpZ2luIG9yaWdpbikKIHsKIAl1bnNpZ25lZCBpbnQgZnJvbnRidWZmZXJfYml0
czsKIAotCWZyb250YnVmZmVyX2JpdHMgPSBhdG9taWNfcmVhZCgmb2JqLT5mcm9udGJ1ZmZlcl9i
aXRzKTsKKwlpZiAoIWZyb250KQorCQlyZXR1cm4gZmFsc2U7CisKKwlmcm9udGJ1ZmZlcl9iaXRz
ID0gYXRvbWljX3JlYWQoJmZyb250LT5iaXRzKTsKIAlpZiAoIWZyb250YnVmZmVyX2JpdHMpCiAJ
CXJldHVybiBmYWxzZTsKIAotCV9faW50ZWxfZmJfb2JqX2ludmFsaWRhdGUob2JqLCBvcmlnaW4s
IGZyb250YnVmZmVyX2JpdHMpOworCV9faW50ZWxfZmJfaW52YWxpZGF0ZShmcm9udCwgb3JpZ2lu
LCBmcm9udGJ1ZmZlcl9iaXRzKTsKIAlyZXR1cm4gdHJ1ZTsKIH0KIAordm9pZCBfX2ludGVsX2Zi
X2ZsdXNoKHN0cnVjdCBpbnRlbF9mcm9udGJ1ZmZlciAqZnJvbnQsCisJCSAgICAgIGVudW0gZmJf
b3Bfb3JpZ2luIG9yaWdpbiwKKwkJICAgICAgdW5zaWduZWQgaW50IGZyb250YnVmZmVyX2JpdHMp
OworCiAvKioKLSAqIGludGVsX2ZiX29ial9mbHVzaCAtIGZsdXNoIGZyb250YnVmZmVyIG9iamVj
dAotICogQG9iajogR0VNIG9iamVjdCB0byBmbHVzaAorICogaW50ZWxfZnJvbnRidWZmZXJfZmx1
c2ggLSBmbHVzaCBmcm9udGJ1ZmZlciBvYmplY3QKKyAqIEBmcm9udDogR0VNIG9iamVjdCB0byBm
bHVzaAogICogQG9yaWdpbjogd2hpY2ggb3BlcmF0aW9uIGNhdXNlZCB0aGUgZmx1c2gKICAqCiAg
KiBUaGlzIGZ1bmN0aW9uIGdldHMgY2FsbGVkIGV2ZXJ5IHRpbWUgcmVuZGVyaW5nIG9uIHRoZSBn
aXZlbiBvYmplY3QgaGFzCiAgKiBjb21wbGV0ZWQgYW5kIGZyb250YnVmZmVyIGNhY2hpbmcgY2Fu
IGJlIHN0YXJ0ZWQgYWdhaW4uCiAgKi8KLXN0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9mYl9vYmpf
Zmx1c2goc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKLQkJCQkgICAgICBlbnVtIGZi
X29wX29yaWdpbiBvcmlnaW4pCitzdGF0aWMgaW5saW5lIHZvaWQgaW50ZWxfZnJvbnRidWZmZXJf
Zmx1c2goc3RydWN0IGludGVsX2Zyb250YnVmZmVyICpmcm9udCwKKwkJCQkJICAgZW51bSBmYl9v
cF9vcmlnaW4gb3JpZ2luKQogewogCXVuc2lnbmVkIGludCBmcm9udGJ1ZmZlcl9iaXRzOwogCi0J
ZnJvbnRidWZmZXJfYml0cyA9IGF0b21pY19yZWFkKCZvYmotPmZyb250YnVmZmVyX2JpdHMpOwor
CWlmICghZnJvbnQpCisJCXJldHVybjsKKworCWZyb250YnVmZmVyX2JpdHMgPSBhdG9taWNfcmVh
ZCgmZnJvbnQtPmJpdHMpOwogCWlmICghZnJvbnRidWZmZXJfYml0cykKIAkJcmV0dXJuOwogCi0J
X19pbnRlbF9mYl9vYmpfZmx1c2gob2JqLCBvcmlnaW4sIGZyb250YnVmZmVyX2JpdHMpOworCV9f
aW50ZWxfZmJfZmx1c2goZnJvbnQsIG9yaWdpbiwgZnJvbnRidWZmZXJfYml0cyk7CiB9CiAKK3Zv
aWQgaW50ZWxfZnJvbnRidWZmZXJfdHJhY2soc3RydWN0IGludGVsX2Zyb250YnVmZmVyICpvbGQs
CisJCQkgICAgIHN0cnVjdCBpbnRlbF9mcm9udGJ1ZmZlciAqbmV3LAorCQkJICAgICB1bnNpZ25l
ZCBpbnQgZnJvbnRidWZmZXJfYml0cyk7CisKK3ZvaWQgaW50ZWxfZnJvbnRidWZmZXJfcHV0KHN0
cnVjdCBpbnRlbF9mcm9udGJ1ZmZlciAqZnJvbnQpOworCiAjZW5kaWYgLyogX19JTlRFTF9GUk9O
VEJVRkZFUl9IX18gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX292
ZXJsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX292ZXJsYXkuYwppbmRleCBjN2Qy
ZDk4MGRmOGMuLmYwNzQzYWY3OWZjYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfb3ZlcmxheS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX292ZXJsYXku
YwpAQCAtMjgxLDkgKzI4MSw5IEBAIHN0YXRpYyB2b2lkIGludGVsX292ZXJsYXlfZmxpcF9wcmVw
YXJlKHN0cnVjdCBpbnRlbF9vdmVybGF5ICpvdmVybGF5LAogCiAJV0FSTl9PTihvdmVybGF5LT5v
bGRfdm1hKTsKIAotCWk5MTVfZ2VtX3RyYWNrX2ZiKG92ZXJsYXktPnZtYSA/IG92ZXJsYXktPnZt
YS0+b2JqIDogTlVMTCwKLQkJCSAgdm1hID8gdm1hLT5vYmogOiBOVUxMLAotCQkJICBJTlRFTF9G
Uk9OVEJVRkZFUl9PVkVSTEFZKHBpcGUpKTsKKwlpbnRlbF9mcm9udGJ1ZmZlcl90cmFjayhvdmVy
bGF5LT52bWEgPyBvdmVybGF5LT52bWEtPm9iai0+ZnJvbnRidWZmZXIgOiBOVUxMLAorCQkJCXZt
YSA/IHZtYS0+b2JqLT5mcm9udGJ1ZmZlciA6IE5VTEwsCisJCQkJSU5URUxfRlJPTlRCVUZGRVJf
T1ZFUkxBWShwaXBlKSk7CiAKIAlpbnRlbF9mcm9udGJ1ZmZlcl9mbGlwX3ByZXBhcmUob3Zlcmxh
eS0+aTkxNSwKIAkJCQkgICAgICAgSU5URUxfRlJPTlRCVUZGRVJfT1ZFUkxBWShwaXBlKSk7CkBA
IC03NjgsNyArNzY4LDcgQEAgc3RhdGljIGludCBpbnRlbF9vdmVybGF5X2RvX3B1dF9pbWFnZShz
dHJ1Y3QgaW50ZWxfb3ZlcmxheSAqb3ZlcmxheSwKIAkJcmV0ID0gUFRSX0VSUih2bWEpOwogCQln
b3RvIG91dF9waW5fc2VjdGlvbjsKIAl9Ci0JaW50ZWxfZmJfb2JqX2ZsdXNoKG5ld19ibywgT1JJ
R0lOX0RJUlRZRkIpOworCWludGVsX2Zyb250YnVmZmVyX2ZsdXNoKG5ld19iby0+ZnJvbnRidWZm
ZXIsIE9SSUdJTl9ESVJUWUZCKTsKIAogCXJldCA9IGk5MTVfdm1hX3B1dF9mZW5jZSh2bWEpOwog
CWlmIChyZXQpCi0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVk
ZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZv
L2ludGVsLWdmeA==

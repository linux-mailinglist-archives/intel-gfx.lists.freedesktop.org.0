Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 1A7641AAC3A
	for <lists+intel-gfx@lfdr.de>; Wed, 15 Apr 2020 17:49:43 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 47DE26EA18;
	Wed, 15 Apr 2020 15:49:40 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id C6E5D6EA18
 for <intel-gfx@lists.freedesktop.org>; Wed, 15 Apr 2020 15:49:38 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from build.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 20908110-1500050 
 for multiple; Wed, 15 Apr 2020 16:49:26 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 15 Apr 2020 16:49:24 +0100
Message-Id: <20200415154924.15120-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20200415131259.32732-1-chris@chris-wilson.co.uk>
References: <20200415131259.32732-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915/selftests: Exercise basic RPS
 interrupt generation
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Chris Wilson <chris@chris-wilson.co.uk>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

U2luY2Ugd2UgZGVwZW5kIHVwb24gUlBTIGdlbmVyYXRpbmcgaW50ZXJydXB0cyBhZnRlciBldmFs
dWF0aW9uCmludGVydmFscyB0byBkZXRlcm1pbmUgd2hlbiB0byB1cC9kb3duIGNsb2NrIHRoZSBH
UFUsIGl0IGlzIGltcGVyYXRpdmUKdGhhdCB3ZSBzdWNjZXNzZnVsbHkgZW5hYmxlIGludGVycnVw
dCBnZW5lcmF0aW9uISBWZXJpZnkgdGhhdCB3ZSBkbyBzZWUKYW4gaW50ZXJydXB0IGlmIHdlIGtl
ZXAgdGhlIEdQVSBidXN5IGZvciBhbiBlbnRpcmUgRUkuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBX
aWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9ycHMuYyAgICAgIHwgICA0ICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3Nl
bGZ0ZXN0X2d0X3BtLmMgfCAgIDIgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rf
cnBzLmMgICB8IDIyMCArKysrKysrKysrKysrKysrKysrKysrKwogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Qvc2VsZnRlc3RfcnBzLmggICB8ICAxMSArKwogNCBmaWxlcyBjaGFuZ2VkLCAyMzcgaW5z
ZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3Nl
bGZ0ZXN0X3Jwcy5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
c2VsZnRlc3RfcnBzLmgKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9ycHMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jwcy5jCmluZGV4IDg2MTEw
NDU4ZTJhNy4uZDE5MTYxYzdhM2Q4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9ycHMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ycHMuYwpA
QCAtMTkyMywzICsxOTIzLDcgQEAgYm9vbCBpOTE1X2dwdV90dXJib19kaXNhYmxlKHZvaWQpCiAJ
cmV0dXJuIHJldDsKIH0KIEVYUE9SVF9TWU1CT0xfR1BMKGk5MTVfZ3B1X3R1cmJvX2Rpc2FibGUp
OworCisjaWYgSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfU0VMRlRFU1QpCisjaW5jbHVkZSAi
c2VsZnRlc3RfcnBzLmMiCisjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L3NlbGZ0ZXN0X2d0X3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9n
dF9wbS5jCmluZGV4IDA5ZmY4ZTRmODhhZi4uYzUwYmI1MDJmZTAzIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9ndF9wbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3NlbGZ0ZXN0X2d0X3BtLmMKQEAgLTcsNiArNyw3IEBACiAKICNpbmNsdWRlICJz
ZWxmdGVzdF9sbGMuaCIKICNpbmNsdWRlICJzZWxmdGVzdF9yYzYuaCIKKyNpbmNsdWRlICJzZWxm
dGVzdF9ycHMuaCIKIAogc3RhdGljIGludCBsaXZlX2d0X3Jlc3VtZSh2b2lkICphcmcpCiB7CkBA
IC01Miw2ICs1Myw3IEBAIGludCBpbnRlbF9ndF9wbV9saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKIHsKIAlzdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVfc3VidGVz
dCB0ZXN0c1tdID0gewogCQlTVUJURVNUKGxpdmVfcmM2X21hbnVhbCksCisJCVNVQlRFU1QobGl2
ZV9ycHNfaW50ZXJydXB0KSwKIAkJU1VCVEVTVChsaXZlX2d0X3Jlc3VtZSksCiAJfTsKIApkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfcnBzLmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9ycHMuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRl
eCAwMDAwMDAwMDAwMDAuLjI2YTgzYzRlMzBjZQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3Jwcy5jCkBAIC0wLDAgKzEsMjIwIEBACisvLyBTUERY
LUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCisvKgorICogQ29weXJpZ2h0IMKpIDIwMjAgSW50ZWwg
Q29ycG9yYXRpb24KKyAqLworCisjaW5jbHVkZSAiaW50ZWxfZW5naW5lX3BtLmgiCisjaW5jbHVk
ZSAiaW50ZWxfZ3RfcG0uaCIKKyNpbmNsdWRlICJpbnRlbF9yYzYuaCIKKyNpbmNsdWRlICJzZWxm
dGVzdF9ycHMuaCIKKyNpbmNsdWRlICJzZWxmdGVzdHMvaWd0X2ZsdXNoX3Rlc3QuaCIKKyNpbmNs
dWRlICJzZWxmdGVzdHMvaWd0X3NwaW5uZXIuaCIKKworc3RhdGljIHZvaWQgZHVtbXlfcnBzX3dv
cmsoc3RydWN0IHdvcmtfc3RydWN0ICp3cmspCit7Cit9CisKK3N0YXRpYyBpbnQgX19ycHNfdXBf
aW50ZXJydXB0KHN0cnVjdCBpbnRlbF9ycHMgKnJwcywKKwkJCSAgICAgIHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSwKKwkJCSAgICAgIHN0cnVjdCBpZ3Rfc3Bpbm5lciAqc3BpbikKK3sK
KwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBlbmdpbmUtPnVuY29yZTsKKwlzdHJ1Y3Qg
aTkxNV9yZXF1ZXN0ICpycTsKKwl1MzIgdGltZW91dDsKKworCWludGVsX2d0X3BtX3dhaXRfZm9y
X2lkbGUoZW5naW5lLT5ndCk7CisJR0VNX0JVR19PTihycHMtPmFjdGl2ZSk7CisKKwlycHMtPnBt
X2lpciA9IDA7CisJcnBzLT5jdXJfZnJlcSA9IHJwcy0+bWluX2ZyZXE7CisKKwlycSA9IGlndF9z
cGlubmVyX2NyZWF0ZV9yZXF1ZXN0KHNwaW4sIGVuZ2luZS0+a2VybmVsX2NvbnRleHQsIE1JX05P
T1ApOworCWlmIChJU19FUlIocnEpKQorCQlyZXR1cm4gUFRSX0VSUihycSk7CisKKwlpOTE1X3Jl
cXVlc3RfZ2V0KHJxKTsKKwlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKKworCWlmICghaWd0X3dhaXRf
Zm9yX3NwaW5uZXIoc3BpbiwgcnEpKSB7CisJCXByX2VycigiJXM6IFJQUyBzcGlubmVyIGRpZCBu
b3Qgc3RhcnRcbiIsCisJCSAgICAgICBlbmdpbmUtPm5hbWUpOworCQlpOTE1X3JlcXVlc3RfcHV0
KHJxKTsKKwkJaW50ZWxfZ3Rfc2V0X3dlZGdlZChlbmdpbmUtPmd0KTsKKwkJcmV0dXJuIC1FSU87
CisJfQorCisJaWYgKCFycHMtPmFjdGl2ZSkgeworCQlwcl9lcnIoIiVzOiBSUFMgbm90IGVuYWJs
ZWQgb24gc3RhcnRpbmcgc3Bpbm5lclxuIiwKKwkJICAgICAgIGVuZ2luZS0+bmFtZSk7CisJCWln
dF9zcGlubmVyX2VuZChzcGluKTsKKwkJaTkxNV9yZXF1ZXN0X3B1dChycSk7CisJCXJldHVybiAt
RUlOVkFMOworCX0KKworCWlmICghKHJwcy0+cG1fZXZlbnRzICYgR0VONl9QTV9SUF9VUF9USFJF
U0hPTEQpKSB7CisJCXByX2VycigiJXM6IFJQUyBkaWQgbm90IHJlZ2lzdGVyIFVQIGludGVycnVw
dFxuIiwKKwkJICAgICAgIGVuZ2luZS0+bmFtZSk7CisJCWk5MTVfcmVxdWVzdF9wdXQocnEpOwor
CQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlpZiAocnBzLT5sYXN0X2ZyZXEgIT0gcnBzLT5taW5f
ZnJlcSkgeworCQlwcl9lcnIoIiVzOiBSUFMgZGlkIG5vdCBwcm9ncmFtIG1pbiBmcmVxdWVuY3lc
biIsCisJCSAgICAgICBlbmdpbmUtPm5hbWUpOworCQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKKwkJ
cmV0dXJuIC1FSU5WQUw7CisJfQorCisJdGltZW91dCA9IGludGVsX3VuY29yZV9yZWFkKHVuY29y
ZSwgR0VONl9SUF9VUF9FSSk7CisJdGltZW91dCA9IEdUX1BNX0lOVEVSVkFMX1RPX1VTKGVuZ2lu
ZS0+aTkxNSwgdGltZW91dCk7CisKKwl1c2xlZXBfcmFuZ2UoMiAqIHRpbWVvdXQsIDMgKiB0aW1l
b3V0KTsKKwlHRU1fQlVHX09OKGk5MTVfcmVxdWVzdF9jb21wbGV0ZWQocnEpKTsKKworCWlndF9z
cGlubmVyX2VuZChzcGluKTsKKwlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKKworCWlmIChycHMtPmN1
cl9mcmVxICE9IHJwcy0+bWluX2ZyZXEpIHsKKwkJcHJfZXJyKCIlczogRnJlcXVlbmN5IHVuZXhw
ZWN0ZWRseSBjaGFuZ2VkIFt1cF0sIG5vdyAlZCFcbiIsCisJCSAgICAgICBlbmdpbmUtPm5hbWUs
IGludGVsX3Jwc19yZWFkX2FjdHVhbF9mcmVxdWVuY3kocnBzKSk7CisJCXJldHVybiAtRUlOVkFM
OworCX0KKworCWlmICghKHJwcy0+cG1faWlyICYgR0VONl9QTV9SUF9VUF9USFJFU0hPTEQpKSB7
CisJCXByX2VycigiJXM6IFVQIGludGVycnVwdCBub3QgcmVjb3JkZWQgZm9yIHNwaW5uZXIsIHBt
X2lpcjoleCwgcHJldl91cDoleCwgdXBfdGhyZXNob2xkOiV4LCB1cF9laToleFxuIiwKKwkJICAg
ICAgIGVuZ2luZS0+bmFtZSwgcnBzLT5wbV9paXIsCisJCSAgICAgICBpbnRlbF91bmNvcmVfcmVh
ZCh1bmNvcmUsIEdFTjZfUlBfUFJFVl9VUCksCisJCSAgICAgICBpbnRlbF91bmNvcmVfcmVhZCh1
bmNvcmUsIEdFTjZfUlBfVVBfVEhSRVNIT0xEKSwKKwkJICAgICAgIGludGVsX3VuY29yZV9yZWFk
KHVuY29yZSwgR0VONl9SUF9VUF9FSSkpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlpbnRl
bF9ndF9wbV93YWl0X2Zvcl9pZGxlKGVuZ2luZS0+Z3QpOworCXJldHVybiAwOworfQorCitzdGF0
aWMgaW50IF9fcnBzX2Rvd25faW50ZXJydXB0KHN0cnVjdCBpbnRlbF9ycHMgKnJwcywKKwkJCQlz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJc3RydWN0IGludGVsX3VuY29yZSAq
dW5jb3JlID0gZW5naW5lLT51bmNvcmU7CisJdTMyIHRpbWVvdXQ7CisKKwltdXRleF9sb2NrKCZy
cHMtPmxvY2spOworCUdFTV9CVUdfT04oIXJwcy0+YWN0aXZlKTsKKwlpbnRlbF9ycHNfc2V0KHJw
cywgcnBzLT5tYXhfZnJlcSk7CisJbXV0ZXhfdW5sb2NrKCZycHMtPmxvY2spOworCisJaWYgKCEo
cnBzLT5wbV9ldmVudHMgJiBHRU42X1BNX1JQX0RPV05fVEhSRVNIT0xEKSkgeworCQlwcl9lcnIo
IiVzOiBSUFMgZGlkIG5vdCByZWdpc3RlciBET1dOIGludGVycnVwdFxuIiwKKwkJICAgICAgIGVu
Z2luZS0+bmFtZSk7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCWlmIChycHMtPmxhc3RfZnJl
cSAhPSBycHMtPm1heF9mcmVxKSB7CisJCXByX2VycigiJXM6IFJQUyBkaWQgbm90IHByb2dyYW0g
bWF4IGZyZXF1ZW5jeVxuIiwKKwkJICAgICAgIGVuZ2luZS0+bmFtZSk7CisJCXJldHVybiAtRUlO
VkFMOworCX0KKworCXRpbWVvdXQgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUlBf
RE9XTl9FSSk7CisJdGltZW91dCA9IEdUX1BNX0lOVEVSVkFMX1RPX1VTKGVuZ2luZS0+aTkxNSwg
dGltZW91dCk7CisKKwkvKiBGbHVzaCBhbnkgcHJldmlvdXMgRUkgKi8KKwl1c2xlZXBfcmFuZ2Uo
dGltZW91dCwgMiAqIHRpbWVvdXQpOworCisJLyogUmVzZXQgdGhlIGludGVycnVwdCBzdGF0dXMg
Ki8KKwlycHNfZGlzYWJsZV9pbnRlcnJ1cHRzKHJwcyk7CisJR0VNX0JVR19PTihycHMtPnBtX2lp
cik7CisJcnBzX2VuYWJsZV9pbnRlcnJ1cHRzKHJwcyk7CisKKwkvKiBBbmQgdGhlbiB3YWl0IGZv
ciB0aGUgdGltZW91dCwgZm9yIHJlYWwgdGhpcyB0aW1lICovCisJdXNsZWVwX3JhbmdlKDIgKiB0
aW1lb3V0LCAzICogdGltZW91dCk7CisKKwlpZiAocnBzLT5jdXJfZnJlcSAhPSBycHMtPm1heF9m
cmVxKSB7CisJCXByX2VycigiJXM6IEZyZXF1ZW5jeSB1bmV4cGVjdGVkbHkgY2hhbmdlZCBbZG93
bl0sIG5vdyAlZCFcbiIsCisJCSAgICAgICBlbmdpbmUtPm5hbWUsCisJCSAgICAgICBpbnRlbF9y
cHNfcmVhZF9hY3R1YWxfZnJlcXVlbmN5KHJwcykpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisK
KwlpZiAoIShycHMtPnBtX2lpciAmIChHRU42X1BNX1JQX0RPV05fVEhSRVNIT0xEIHwgR0VONl9Q
TV9SUF9ET1dOX1RJTUVPVVQpKSkgeworCQlwcl9lcnIoIiVzOiBET1dOIGludGVycnVwdCBub3Qg
cmVjb3JkZWQgZm9yIGlkbGUsIHBtX2lpcjoleCwgcHJldl9kb3duOiV4LCBkb3duX3RocmVzaG9s
ZDoleCwgZG93bl9laToleCBbcHJldl91cDoleCwgdXBfdGhyZXNob2xkOiV4LCB1cF9laToleF1c
biIsCisJCSAgICAgICBlbmdpbmUtPm5hbWUsIHJwcy0+cG1faWlyLAorCQkgICAgICAgaW50ZWxf
dW5jb3JlX3JlYWQodW5jb3JlLCBHRU42X1JQX1BSRVZfRE9XTiksCisJCSAgICAgICBpbnRlbF91
bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUlBfRE9XTl9USFJFU0hPTEQpLAorCQkgICAgICAgaW50
ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU42X1JQX0RPV05fRUkpLAorCQkgICAgICAgaW50ZWxf
dW5jb3JlX3JlYWQodW5jb3JlLCBHRU42X1JQX1BSRVZfVVApLAorCQkgICAgICAgaW50ZWxfdW5j
b3JlX3JlYWQodW5jb3JlLCBHRU42X1JQX1VQX1RIUkVTSE9MRCksCisJCSAgICAgICBpbnRlbF91
bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUlBfVVBfRUkpKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJ
fQorCisJcmV0dXJuIDA7Cit9CisKK2ludCBsaXZlX3Jwc19pbnRlcnJ1cHQodm9pZCAqYXJnKQor
eworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7CisJc3RydWN0IGludGVsX3JwcyAqcnBzID0g
Jmd0LT5ycHM7CisJdm9pZCAoKnNhdmVkX3dvcmspKHN0cnVjdCB3b3JrX3N0cnVjdCAqd3JrKTsK
KwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CisJZW51bSBpbnRlbF9lbmdpbmVfaWQg
aWQ7CisJc3RydWN0IGlndF9zcGlubmVyIHNwaW47CisJdTMyIHBtX2V2ZW50czsKKwlpbnQgZXJy
ID0gMDsKKworCS8qCisJICogRmlyc3QsIGxldCdzIGNoZWNrIHdoZXRoZXIgb3Igbm90IHdlIGFy
ZSByZWNlaXZpbmcgaW50ZXJydXB0cy4KKwkgKi8KKworCWlmICghcnBzLT5lbmFibGVkIHx8IHJw
cy0+bWF4X2ZyZXEgPD0gcnBzLT5taW5fZnJlcSkKKwkJcmV0dXJuIDA7CisKKwlpbnRlbF9ndF9w
bV9nZXQoZ3QpOworCXBtX2V2ZW50cyA9IHJwcy0+cG1fZXZlbnRzOworCWludGVsX2d0X3BtX3B1
dChndCk7CisJaWYgKCFwbV9ldmVudHMpIHsKKwkJcHJfZXJyKCJObyBSUFMgUE0gZXZlbnRzIHJl
Z2lzdGVyZWQsIGJ1dCBSUFMgaXMgZW5hYmxlZD9cbiIpOworCQlyZXR1cm4gLUVOT0RFVjsKKwl9
CisKKwlpZiAoaWd0X3NwaW5uZXJfaW5pdCgmc3BpbiwgZ3QpKQorCQlyZXR1cm4gLUVOT01FTTsK
KworCWludGVsX2d0X3BtX3dhaXRfZm9yX2lkbGUoZ3QpOworCXNhdmVkX3dvcmsgPSBycHMtPndv
cmsuZnVuYzsKKwlycHMtPndvcmsuZnVuYyA9IGR1bW15X3Jwc193b3JrOworCisJZm9yX2VhY2hf
ZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7CisJCS8qIEtlZXAgdGhlIGVuZ2luZSBidXN5IHdpdGgg
YSBzcGlubmVyOyBleHBlY3QgYW4gVVAhICovCisJCWlmIChwbV9ldmVudHMgJiBHRU42X1BNX1JQ
X1VQX1RIUkVTSE9MRCkgeworCQkJZXJyID0gX19ycHNfdXBfaW50ZXJydXB0KHJwcywgZW5naW5l
LCAmc3Bpbik7CisJCQlpZiAoZXJyKQorCQkJCWdvdG8gb3V0OworCQl9CisKKwkJLyogS2VlcCB0
aGUgZW5naW5lIGF3YWtlIGJ1dCBpZGxlIGFuZCBjaGVjayBmb3IgRE9XTiAqLworCQlpZiAocG1f
ZXZlbnRzICYgR0VONl9QTV9SUF9ET1dOX1RIUkVTSE9MRCkgeworCQkJaW50ZWxfZW5naW5lX3Bt
X2dldChlbmdpbmUpOworCQkJaW50ZWxfcmM2X2Rpc2FibGUoJmd0LT5yYzYpOworCisJCQllcnIg
PSBfX3Jwc19kb3duX2ludGVycnVwdChycHMsIGVuZ2luZSk7CisKKwkJCWludGVsX3JjNl9lbmFi
bGUoJmd0LT5yYzYpOworCQkJaW50ZWxfZW5naW5lX3BtX3B1dChlbmdpbmUpOworCQkJaWYgKGVy
cikKKwkJCQlnb3RvIG91dDsKKwkJfQorCX0KKworb3V0OgorCWlmIChpZ3RfZmx1c2hfdGVzdChn
dC0+aTkxNSkpCisJCWVyciA9IC1FSU87CisKKwlpZ3Rfc3Bpbm5lcl9maW5pKCZzcGluKTsKKwor
CWludGVsX2d0X3BtX3dhaXRfZm9yX2lkbGUoZ3QpOworCXJwcy0+d29yay5mdW5jID0gc2F2ZWRf
d29yazsKKworCXJldHVybiBlcnI7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9zZWxmdGVzdF9ycHMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3Jw
cy5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uYWJiYTY2NDIwOTk2
Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfcnBz
LmgKQEAgLTAsMCArMSwxMSBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVCAqLwor
LyoKKyAqIENvcHlyaWdodCDCqSAyMDIwIEludGVsIENvcnBvcmF0aW9uCisgKi8KKworI2lmbmRl
ZiBTRUxGVEVTVF9SUFNfSAorI2RlZmluZSBTRUxGVEVTVF9SUFNfSAorCitpbnQgbGl2ZV9ycHNf
aW50ZXJydXB0KHZvaWQgKmFyZyk7CisKKyNlbmRpZiAvKiBTRUxGVEVTVF9SUFNfSCAqLwotLSAK
Mi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJ
bnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0
cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZngK

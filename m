Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1B5379B469
	for <lists+intel-gfx@lfdr.de>; Fri, 23 Aug 2019 18:20:56 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 58A6D6ECE9;
	Fri, 23 Aug 2019 16:20:53 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4D6216ECEA
 for <intel-gfx@lists.freedesktop.org>; Fri, 23 Aug 2019 16:20:51 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18242826-1500050 
 for multiple; Fri, 23 Aug 2019 17:20:43 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 23 Aug 2019 17:20:41 +0100
Message-Id: <20190823162041.9482-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915: Replace obj->pin_global with
 obj->frontbuffer
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

b2JqLT5waW5fZ2xvYmFsIHdhcyBvcmlnaW5hbCB1c2VkIGFzIGEgbWVhbnMgdG8ga2VlcCB0aGUg
c2hyaW5rZXIgb2ZmCnRoZSBhY3RpdmUgc2Nhbm91dCwgYnV0IHdlIHVzZSB0aGUgdm1hLT5waW5f
Y291bnQgaXRzZWxmIGZvciB0aGF0IGFuZAp0aGUgb2JqLT5mcm9udGJ1ZmZlciB0byBkZWxheSBz
aHJpbmtpbmcgYWN0aXZlIGZyYW1lYnVmZmVycy4gVGhlIG90aGVyCnJvbGUgdGhhdCBvYmotPnBp
bl9nbG9iYWwgZ2FpbmVkIHdhcyBmb3Igc3BvdHRpbmcgZGlzcGxheSBvYmplY3RzIGluc2lkZQpH
RU0gYW5kIHdvcmtpbmcgaGFyZGVyIHRvIGtlZXAgdGhvc2UgY29oZXJlbnQ7IGZvciB3aGljaCB3
ZSBjYW4gYWdhaW4Kc2ltcGx5IGluc3BlY3Qgb2JqLT5mcm9udGJ1ZmZlciBkaXJlY3RseS4KCkNv
bWluZyB1cCBuZXh0LCB3ZSB3aWxsIHdhbnQgdG8gbWFuaXB1bGF0ZSB0aGUgcGluX2dsb2JhbCBj
b3VudGVyCm91dHNpZGUgb2YgdGhlIHByaW5jaXBsZSBsb2Nrcywgc28gd291bGQgbmVlZCB0byBt
YWtlIHBpbl9nbG9iYWwgYXRvbWljLgpIb3dldmVyLCBzaW5jZSBvYmotPmZyb250YnVmZmVyIGlz
IGFscmVhZHkgbWFuYWdlZCBhdG9taWNhbGx5LCBpdCBtYWtlcwpzZW5zZSB0byB1c2UgdGhhdCB0
aGUgcHJpbWFyeSBrZXkgZm9yIGRpc3BsYXkgb2JqZWN0cyBpbnN0ZWFkIG9mIGhhdmluZwpwaW5f
Z2xvYmFsLgoKU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24u
Y28udWs+CkNjOiBNaWthIEt1b3BwYWxhIDxtaWthLmt1b3BwYWxhQGxpbnV4LmludGVsLmNvbT4K
LS0tCiAuLi4vZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZnJvbnRidWZmZXIuYyAgfCAxMyAr
KysrKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZG9tYWluLmMgICAgfCAz
NCArKysrKystLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
b2JqZWN0LmggICAgfCAgMyArLQogLi4uL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0
X3R5cGVzLmggIHwgIDIgLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9zaHJp
bmtlci5jICB8IDE1ICsrKy0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMu
YyAgICAgICAgICAgfCAxMiArKy0tLS0tCiA2IGZpbGVzIGNoYW5nZWQsIDI5IGluc2VydGlvbnMo
KyksIDUwIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfZnJvbnRidWZmZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfZnJvbnRidWZmZXIuYwppbmRleCA3MTkzNzk3NzRmYTUuLjQzMDQ3YjY3NmI3YiAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mcm9udGJ1ZmZlci5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZnJvbnRidWZmZXIuYwpA
QCAtMjIwLDExICsyMjAsMTggQEAgc3RhdGljIHZvaWQgZnJvbnRidWZmZXJfcmVsZWFzZShzdHJ1
Y3Qga3JlZiAqcmVmKQogewogCXN0cnVjdCBpbnRlbF9mcm9udGJ1ZmZlciAqZnJvbnQgPQogCQlj
b250YWluZXJfb2YocmVmLCB0eXBlb2YoKmZyb250KSwgcmVmKTsKKwlzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqID0gZnJvbnQtPm9iajsKKwlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKIAot
CWZyb250LT5vYmotPmZyb250YnVmZmVyID0gTlVMTDsKLQlzcGluX3VubG9jaygmdG9faTkxNShm
cm9udC0+b2JqLT5iYXNlLmRldiktPmZiX3RyYWNraW5nLmxvY2spOworCXNwaW5fbG9jaygmb2Jq
LT52bWEubG9jayk7CisJZm9yX2VhY2hfZ2d0dF92bWEodm1hLCBvYmopCisJCXZtYS0+ZGlzcGxh
eV9hbGlnbm1lbnQgPSBJOTE1X0dUVF9QQUdFX1NJWkU7CisJc3Bpbl91bmxvY2soJm9iai0+dm1h
LmxvY2spOwogCi0JaTkxNV9nZW1fb2JqZWN0X3B1dChmcm9udC0+b2JqKTsKKwlvYmotPmZyb250
YnVmZmVyID0gTlVMTDsKKwlzcGluX3VubG9jaygmdG9faTkxNShvYmotPmJhc2UuZGV2KS0+ZmJf
dHJhY2tpbmcubG9jayk7CisKKwlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CiAJa2ZyZWUoZnJv
bnQpOwogfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
ZG9tYWluLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZG9tYWluLmMKaW5k
ZXggOWM1OGU4ZmFjMWQ5Li4wMzQxYjNkYTkzMGEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9kb21haW4uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fZG9tYWluLmMKQEAgLTI3LDcgKzI3LDcgQEAgc3RhdGljIHZvaWQgX19pOTE1
X2dlbV9vYmplY3RfZmx1c2hfZm9yX2Rpc3BsYXkoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iaikKIAogdm9pZCBpOTE1X2dlbV9vYmplY3RfZmx1c2hfaWZfZGlzcGxheShzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdCAqb2JqKQogewotCWlmICghUkVBRF9PTkNFKG9iai0+cGluX2dsb2Jh
bCkpCisJaWYgKCFSRUFEX09OQ0Uob2JqLT5mcm9udGJ1ZmZlcikpCiAJCXJldHVybjsKIAogCWk5
MTVfZ2VtX29iamVjdF9sb2NrKG9iaik7CkBAIC00MjIsMTIgKzQyMiw4IEBAIGk5MTVfZ2VtX29i
amVjdF9waW5fdG9fZGlzcGxheV9wbGFuZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2Jq
LAogCiAJYXNzZXJ0X29iamVjdF9oZWxkKG9iaik7CiAKLQkvKiBNYXJrIHRoZSBnbG9iYWwgcGlu
IGVhcmx5IHNvIHRoYXQgd2UgYWNjb3VudCBmb3IgdGhlCi0JICogZGlzcGxheSBjb2hlcmVuY3kg
d2hpbHN0IHNldHRpbmcgdXAgdGhlIGNhY2hlIGRvbWFpbnMuCi0JICovCi0Jb2JqLT5waW5fZ2xv
YmFsKys7Ci0KLQkvKiBUaGUgZGlzcGxheSBlbmdpbmUgaXMgbm90IGNvaGVyZW50IHdpdGggdGhl
IExMQyBjYWNoZSBvbiBnZW42LiAgQXMKKwkvKgorCSAqIFRoZSBkaXNwbGF5IGVuZ2luZSBpcyBu
b3QgY29oZXJlbnQgd2l0aCB0aGUgTExDIGNhY2hlIG9uIGdlbjYuICBBcwogCSAqIGEgcmVzdWx0
LCB3ZSBtYWtlIHN1cmUgdGhhdCB0aGUgcGlubmluZyB0aGF0IGlzIGFib3V0IHRvIG9jY3VyIGlz
CiAJICogZG9uZSB3aXRoIHVuY2FjaGVkIFBURXMuIFRoaXMgaXMgbG93ZXN0IGNvbW1vbiBkZW5v
bWluYXRvciBmb3IgYWxsCiAJICogY2hpcHNldHMuCkBAIC00MzksMTIgKzQzNSwxMSBAQCBpOTE1
X2dlbV9vYmplY3RfcGluX3RvX2Rpc3BsYXlfcGxhbmUoc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iaiwKIAlyZXQgPSBpOTE1X2dlbV9vYmplY3Rfc2V0X2NhY2hlX2xldmVsKG9iaiwKIAkJ
CQkJICAgICAgSEFTX1dUKHRvX2k5MTUob2JqLT5iYXNlLmRldikpID8KIAkJCQkJICAgICAgSTkx
NV9DQUNIRV9XVCA6IEk5MTVfQ0FDSEVfTk9ORSk7Ci0JaWYgKHJldCkgewotCQl2bWEgPSBFUlJf
UFRSKHJldCk7Ci0JCWdvdG8gZXJyX3VucGluX2dsb2JhbDsKLQl9CisJaWYgKHJldCkKKwkJcmV0
dXJuIEVSUl9QVFIocmV0KTsKIAotCS8qIEFzIHRoZSB1c2VyIG1heSBtYXAgdGhlIGJ1ZmZlciBv
bmNlIHBpbm5lZCBpbiB0aGUgZGlzcGxheSBwbGFuZQorCS8qCisJICogQXMgdGhlIHVzZXIgbWF5
IG1hcCB0aGUgYnVmZmVyIG9uY2UgcGlubmVkIGluIHRoZSBkaXNwbGF5IHBsYW5lCiAJICogKGUu
Zy4gbGlia21zIGZvciB0aGUgYm9vdHVwIHNwbGFzaCksIHdlIGhhdmUgdG8gZW5zdXJlIHRoYXQg
d2UKIAkgKiBhbHdheXMgdXNlIG1hcF9hbmRfZmVuY2VhYmxlIGZvciBhbGwgc2Nhbm91dCBidWZm
ZXJzLiBIb3dldmVyLAogCSAqIGl0IG1heSBzaW1wbHkgYmUgdG9vIGJpZyB0byBmaXQgaW50byBt
YXBwYWJsZSwgaW4gd2hpY2ggY2FzZQpAQCAtNDYxLDIyICs0NTYsMTkgQEAgaTkxNV9nZW1fb2Jq
ZWN0X3Bpbl90b19kaXNwbGF5X3BsYW5lKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmos
CiAJaWYgKElTX0VSUih2bWEpKQogCQl2bWEgPSBpOTE1X2dlbV9vYmplY3RfZ2d0dF9waW4ob2Jq
LCB2aWV3LCAwLCBhbGlnbm1lbnQsIGZsYWdzKTsKIAlpZiAoSVNfRVJSKHZtYSkpCi0JCWdvdG8g
ZXJyX3VucGluX2dsb2JhbDsKKwkJcmV0dXJuIHZtYTsKIAogCXZtYS0+ZGlzcGxheV9hbGlnbm1l
bnQgPSBtYXhfdCh1NjQsIHZtYS0+ZGlzcGxheV9hbGlnbm1lbnQsIGFsaWdubWVudCk7CiAKIAlf
X2k5MTVfZ2VtX29iamVjdF9mbHVzaF9mb3JfZGlzcGxheShvYmopOwogCi0JLyogSXQgc2hvdWxk
IG5vdyBiZSBvdXQgb2YgYW55IG90aGVyIHdyaXRlIGRvbWFpbnMsIGFuZCB3ZSBjYW4gdXBkYXRl
CisJLyoKKwkgKiBJdCBzaG91bGQgbm93IGJlIG91dCBvZiBhbnkgb3RoZXIgd3JpdGUgZG9tYWlu
cywgYW5kIHdlIGNhbiB1cGRhdGUKIAkgKiB0aGUgZG9tYWluIHZhbHVlcyBmb3Igb3VyIGNoYW5n
ZXMuCiAJICovCiAJb2JqLT5yZWFkX2RvbWFpbnMgfD0gSTkxNV9HRU1fRE9NQUlOX0dUVDsKIAog
CXJldHVybiB2bWE7Ci0KLWVycl91bnBpbl9nbG9iYWw6Ci0Jb2JqLT5waW5fZ2xvYmFsLS07Ci0J
cmV0dXJuIHZtYTsKIH0KIAogc3RhdGljIHZvaWQgaTkxNV9nZW1fb2JqZWN0X2J1bXBfaW5hY3Rp
dmVfZ2d0dChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQpAQCAtNTE0LDEyICs1MDYs
NiBAQCBpOTE1X2dlbV9vYmplY3RfdW5waW5fZnJvbV9kaXNwbGF5X3BsYW5lKHN0cnVjdCBpOTE1
X3ZtYSAqdm1hKQogCiAJYXNzZXJ0X29iamVjdF9oZWxkKG9iaik7CiAKLQlpZiAoV0FSTl9PTihv
YmotPnBpbl9nbG9iYWwgPT0gMCkpCi0JCXJldHVybjsKLQotCWlmICgtLW9iai0+cGluX2dsb2Jh
bCA9PSAwKQotCQl2bWEtPmRpc3BsYXlfYWxpZ25tZW50ID0gSTkxNV9HVFRfTUlOX0FMSUdOTUVO
VDsKLQogCS8qIEJ1bXAgdGhlIExSVSB0byB0cnkgYW5kIGF2b2lkIHByZW1hdHVyZSBldmljdGlv
biB3aGlsc3QgZmxpcHBpbmcgICovCiAJaTkxNV9nZW1fb2JqZWN0X2J1bXBfaW5hY3RpdmVfZ2d0
dChvYmopOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
b2JqZWN0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmgKaW5k
ZXggNWVmYjk5MzZlMDViLi5kNjAwNWNhZDlkNWMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fb2JqZWN0LmgKQEAgLTQwNiw3ICs0MDYsOCBAQCBzdGF0aWMgaW5saW5lIGJv
b2wgY3B1X3dyaXRlX25lZWRzX2NsZmx1c2goc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
aikKIAlpZiAoIShvYmotPmNhY2hlX2NvaGVyZW50ICYgSTkxNV9CT19DQUNIRV9DT0hFUkVOVF9G
T1JfV1JJVEUpKQogCQlyZXR1cm4gdHJ1ZTsKIAotCXJldHVybiBvYmotPnBpbl9nbG9iYWw7IC8q
IGN1cnJlbnRseSBpbiB1c2UgYnkgSFcsIGtlZXAgZmx1c2hlZCAqLworCS8qIEN1cnJlbnRseSBp
biB1c2UgYnkgSFcgKGRpc3BsYXkgZW5naW5lKT8gS2VlcCBmbHVzaGVkLiAqLworCXJldHVybiBS
RUFEX09OQ0Uob2JqLT5mcm9udGJ1ZmZlcik7CiB9CiAKIHN0YXRpYyBpbmxpbmUgdm9pZCBfX3N0
YXJ0X2NwdV93cml0ZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oCmluZGV4IGVkZTBl
YjQyMThhOC4uMTNiOWRjMGUxYTg5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fb2JqZWN0X3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX29iamVjdF90eXBlcy5oCkBAIC0xNTIsOCArMTUyLDYgQEAgc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3QgewogCiAJLyoqIENvdW50IG9mIFZNQSBhY3R1YWxseSBib3VuZCBieSB0
aGlzIG9iamVjdCAqLwogCWF0b21pY190IGJpbmRfY291bnQ7Ci0JLyoqIENvdW50IG9mIGhvdyBt
YW55IGdsb2JhbCBWTUEgYXJlIGN1cnJlbnRseSBwaW5uZWQgZm9yIHVzZSBieSBIVyAqLwotCXVu
c2lnbmVkIGludCBwaW5fZ2xvYmFsOwogCiAJc3RydWN0IHsKIAkJc3RydWN0IG11dGV4IGxvY2s7
IC8qIHByb3RlY3RzIHRoZSBwYWdlcyBhbmQgdGhlaXIgdXNlICovCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fc2hyaW5rZXIuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9zaHJpbmtlci5jCmluZGV4IGVkZDIxZDE0ZTY0Zi4uNGU1NWNm
YzJiMGRjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fc2hy
aW5rZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fc2hyaW5rZXIu
YwpAQCAtNjEsNyArNjEsOCBAQCBzdGF0aWMgYm9vbCBjYW5fcmVsZWFzZV9wYWdlcyhzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogCWlmICghaTkxNV9nZW1fb2JqZWN0X2lzX3Nocmlu
a2FibGUob2JqKSkKIAkJcmV0dXJuIGZhbHNlOwogCi0JLyogT25seSByZXBvcnQgdHJ1ZSBpZiBi
eSB1bmJpbmRpbmcgdGhlIG9iamVjdCBhbmQgcHV0dGluZyBpdHMgcGFnZXMKKwkvKgorCSAqIE9u
bHkgcmVwb3J0IHRydWUgaWYgYnkgdW5iaW5kaW5nIHRoZSBvYmplY3QgYW5kIHB1dHRpbmcgaXRz
IHBhZ2VzCiAJICogd2UgY2FuIGFjdHVhbGx5IG1ha2UgZm9yd2FyZCBwcm9ncmVzcyB0b3dhcmRz
IGZyZWVpbmcgcGh5c2ljYWwKIAkgKiBwYWdlcy4KIAkgKgpAQCAtNzIsMTYgKzczLDggQEAgc3Rh
dGljIGJvb2wgY2FuX3JlbGVhc2VfcGFnZXMoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
aikKIAlpZiAoYXRvbWljX3JlYWQoJm9iai0+bW0ucGFnZXNfcGluX2NvdW50KSA+IGF0b21pY19y
ZWFkKCZvYmotPmJpbmRfY291bnQpKQogCQlyZXR1cm4gZmFsc2U7CiAKLQkvKiBJZiBhbnkgdm1h
IGFyZSAicGVybWFuZW50bHkiIHBpbm5lZCwgaXQgd2lsbCBwcmV2ZW50IHVzIGZyb20KLQkgKiBy
ZWNsYWltaW5nIHRoZSBvYmotPm1tLnBhZ2VzLiBXZSBvbmx5IGFsbG93IHNjYW5vdXQgb2JqZWN0
cyB0byBjbGFpbQotCSAqIGEgcGVybWFuZW50IHBpbiwgYWxvbmcgd2l0aCBhIGZldyBvdGhlcnMg
bGlrZSB0aGUgY29udGV4dCBvYmplY3RzLgotCSAqIFRvIHNpbXBsaWZ5IHRoZSBzY2FuLCBhbmQg
dG8gYXZvaWQgd2Fsa2luZyB0aGUgbGlzdCBvZiB2bWEgdW5kZXIgdGhlCi0JICogb2JqZWN0LCB3
ZSBqdXN0IGNoZWNrIHRoZSBjb3VudCBvZiBpdHMgcGVybWFuZW50bHkgcGlubmVkLgotCSAqLwot
CWlmIChSRUFEX09OQ0Uob2JqLT5waW5fZ2xvYmFsKSkKLQkJcmV0dXJuIGZhbHNlOwotCi0JLyog
V2UgY2FuIG9ubHkgcmV0dXJuIHBoeXNpY2FsIHBhZ2VzIHRvIHRoZSBzeXN0ZW0gaWYgd2UgY2Fu
IGVpdGhlcgorCS8qCisJICogV2UgY2FuIG9ubHkgcmV0dXJuIHBoeXNpY2FsIHBhZ2VzIHRvIHRo
ZSBzeXN0ZW0gaWYgd2UgY2FuIGVpdGhlcgogCSAqIGRpc2NhcmQgdGhlIGNvbnRlbnRzIChiZWNh
dXNlIHRoZSB1c2VyIGhhcyBtYXJrZWQgdGhlbSBhcyBiZWluZwogCSAqIHB1cmdlYWJsZSkgb3Ig
aWYgd2UgY2FuIG1vdmUgdGhlaXIgY29udGVudHMgb3V0IHRvIHN3YXAuCiAJICovCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZGVidWdmcy5jCmluZGV4IGUxMDNmY2JhNjQzNS4uYjkwMzcxODQ0Njg5IDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwpAQCAtNzcsMTEgKzc3LDYgQEAgc3RhdGlj
IGludCBpOTE1X2NhcGFiaWxpdGllcyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCiAJ
cmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBjaGFyIGdldF9waW5fZmxhZyhzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqKQotewotCXJldHVybiBvYmotPnBpbl9nbG9iYWwgPyAncCcgOiAnICc7
Ci19Ci0KIHN0YXRpYyBjaGFyIGdldF90aWxpbmdfZmxhZyhzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29i
amVjdCAqb2JqKQogewogCXN3aXRjaCAoaTkxNV9nZW1fb2JqZWN0X2dldF90aWxpbmcob2JqKSkg
ewpAQCAtMTQwLDkgKzEzNSw4IEBAIGRlc2NyaWJlX29iaihzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiAJc3RydWN0IGk5MTVfdm1hICp2bWE7CiAJ
aW50IHBpbl9jb3VudCA9IDA7CiAKLQlzZXFfcHJpbnRmKG0sICIlcEs6ICVjJWMlYyVjICU4emRL
aUIgJTAyeCAlMDJ4ICVzJXMlcyIsCisJc2VxX3ByaW50ZihtLCAiJXBLOiAlYyVjJWMgJTh6ZEtp
QiAlMDJ4ICUwMnggJXMlcyVzIiwKIAkJICAgJm9iai0+YmFzZSwKLQkJICAgZ2V0X3Bpbl9mbGFn
KG9iaiksCiAJCSAgIGdldF90aWxpbmdfZmxhZyhvYmopLAogCQkgICBnZXRfZ2xvYmFsX2ZsYWco
b2JqKSwKIAkJICAgZ2V0X3Bpbl9tYXBwZWRfZmxhZyhvYmopLApAQCAtMjIxLDggKzIxNSw4IEBA
IGRlc2NyaWJlX29iaihzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICpvYmopCiAJc2VxX3ByaW50ZihtLCAiIChwaW5uZWQgeCAlZCkiLCBwaW5fY291bnQpOwog
CWlmIChvYmotPnN0b2xlbikKIAkJc2VxX3ByaW50ZihtLCAiIChzdG9sZW46ICUwOGxseCkiLCBv
YmotPnN0b2xlbi0+c3RhcnQpOwotCWlmIChvYmotPnBpbl9nbG9iYWwpCi0JCXNlcV9wcmludGYo
bSwgIiAoZ2xvYmFsKSIpOworCWlmIChSRUFEX09OQ0Uob2JqLT5mcm9udGJ1ZmZlcikpCisJCXNl
cV9wcmludGYobSwgIiAoZnJvbnQpIik7CiAKIAllbmdpbmUgPSBpOTE1X2dlbV9vYmplY3RfbGFz
dF93cml0ZV9lbmdpbmUob2JqKTsKIAlpZiAoZW5naW5lKQotLSAKMi4yMy4wCgpfX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBs
aXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVz
a3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

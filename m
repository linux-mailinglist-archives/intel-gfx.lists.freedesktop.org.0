Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 07A618FF67
	for <lists+intel-gfx@lfdr.de>; Fri, 16 Aug 2019 11:48:19 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 67C0F6E2A6;
	Fri, 16 Aug 2019 09:48:17 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga03.intel.com (mga03.intel.com [134.134.136.65])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5CB106E2A6
 for <intel-gfx@lists.freedesktop.org>; Fri, 16 Aug 2019 09:48:15 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga008.fm.intel.com ([10.253.24.58])
 by orsmga103.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 16 Aug 2019 02:48:03 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,391,1559545200"; d="scan'208";a="177140447"
Received: from rosetta.fi.intel.com ([10.237.72.194])
 by fmsmga008.fm.intel.com with ESMTP; 16 Aug 2019 02:48:02 -0700
Received: by rosetta.fi.intel.com (Postfix, from userid 1000)
 id B743F840810; Fri, 16 Aug 2019 12:47:55 +0300 (EEST)
From: Mika Kuoppala <mika.kuoppala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 16 Aug 2019 12:47:54 +0300
Message-Id: <20190816094754.26492-1-mika.kuoppala@linux.intel.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <156587846595.5838.15496642378834924864@skylake-alporthouse-com>
References: <156587846595.5838.15496642378834924864@skylake-alporthouse-com>
Subject: [Intel-gfx] [PATCH] drm/i915/gtt: Fold gen8 insertions into one
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QXMgd2UgZ2l2ZSBwYWdlIGRpcmVjdG9yeSBwb2ludGVyIChsdmwgMykgc3RydWN0dXJlCmZvciBw
dGUgaW5zZXJ0aW9uLCB3ZSBjYW4gZm9sZCBib3RoIHZlcnNpb25zIGludG8Kb25lIGZ1bmN0aW9u
IGJ5IHRlYWNoaW5nIGl0IHRvIGdldCBwZHAgcmVnYXJkbGVzcwpvZiB0b3AgbGV2ZWwuCgp2Mjog
bmFtaW5nIGFuZCBhc3NlcnRzIChDaHJpcykKCkNjOiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlz
LXdpbHNvbi5jby51az4KU2lnbmVkLW9mZi1ieTogTWlrYSBLdW9wcGFsYSA8bWlrYS5rdW9wcGFs
YUBsaW51eC5pbnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0
LmMgfCA5NiArKysrKysrKysrKysrKystLS0tLS0tLS0tLS0tLQogMSBmaWxlIGNoYW5nZWQsIDUw
IGluc2VydGlvbnMoKyksIDQ2IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1f
Z3R0LmMKaW5kZXggZmNmMDVjMjEzYjBhLi4zODUwMjhmOGE5NGIgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZ2VtX2d0dC5jCkBAIC05MTAsNiArOTEwLDIzIEBAIHN0YXRpYyBpbmxpbmUgdW5zaWdu
ZWQgaW50IGdlbjhfcGRfdG9wX2NvdW50KGNvbnN0IHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2Ug
KnZtCiAJcmV0dXJuICh2bS0+dG90YWwgKyAoMXVsbCA8PCBzaGlmdCkgLSAxKSA+PiBzaGlmdDsK
IH0KIAorc3RhdGljIGlubGluZSBzdHJ1Y3QgaTkxNV9wYWdlX2RpcmVjdG9yeSAqCitnZW44X3Bk
cF9mb3JfcGFnZV9pbmRleChzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICogY29uc3Qgdm0sIGNv
bnN0IHU2NCBpZHgpCit7CisJc3RydWN0IGk5MTVfcHBndHQgKiBjb25zdCBwcGd0dCA9IGk5MTVf
dm1fdG9fcHBndHQodm0pOworCisJaWYgKHZtLT50b3AgPT0gMikKKwkJcmV0dXJuIHBwZ3R0LT5w
ZDsKKwllbHNlCisJCXJldHVybiBpOTE1X3BkX2VudHJ5KHBwZ3R0LT5wZCwgZ2VuOF9wZF9pbmRl
eChpZHgsIHZtLT50b3ApKTsKK30KKworc3RhdGljIGlubGluZSBzdHJ1Y3QgaTkxNV9wYWdlX2Rp
cmVjdG9yeSAqCitnZW44X3BkcF9mb3JfcGFnZV9hZGRyZXNzKHN0cnVjdCBpOTE1X2FkZHJlc3Nf
c3BhY2UgKiBjb25zdCB2bSwgY29uc3QgdTY0IGFkZHIpCit7CisJcmV0dXJuIGdlbjhfcGRwX2Zv
cl9wYWdlX2luZGV4KHZtLCBhZGRyID4+IEdFTjhfUFRFX1NISUZUKTsKK30KKwogc3RhdGljIHZv
aWQgX19nZW44X3BwZ3R0X2NsZWFudXAoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCiAJ
CQkJIHN0cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5ICpwZCwKIAkJCQkgaW50IGNvdW50LCBpbnQg
bHZsKQpAQCAtMTEzNiwxMiArMTE1MywxMiBAQCBzdGF0aWMgaW5saW5lIHN0cnVjdCBzZ3RfZG1h
IHsKIH0KIAogc3RhdGljIF9fYWx3YXlzX2lubGluZSB1NjQKLWdlbjhfcHBndHRfaW5zZXJ0X3B0
ZV9lbnRyaWVzKHN0cnVjdCBpOTE1X3BwZ3R0ICpwcGd0dCwKLQkJCSAgICAgIHN0cnVjdCBpOTE1
X3BhZ2VfZGlyZWN0b3J5ICpwZHAsCi0JCQkgICAgICBzdHJ1Y3Qgc2d0X2RtYSAqaXRlciwKLQkJ
CSAgICAgIHU2NCBpZHgsCi0JCQkgICAgICBlbnVtIGk5MTVfY2FjaGVfbGV2ZWwgY2FjaGVfbGV2
ZWwsCi0JCQkgICAgICB1MzIgZmxhZ3MpCitnZW44X3BwZ3R0X2luc2VydF9wdGUoc3RydWN0IGk5
MTVfcHBndHQgKnBwZ3R0LAorCQkgICAgICBzdHJ1Y3QgaTkxNV9wYWdlX2RpcmVjdG9yeSAqcGRw
LAorCQkgICAgICBzdHJ1Y3Qgc2d0X2RtYSAqaXRlciwKKwkJICAgICAgdTY0IGlkeCwKKwkJICAg
ICAgZW51bSBpOTE1X2NhY2hlX2xldmVsIGNhY2hlX2xldmVsLAorCQkgICAgICB1MzIgZmxhZ3Mp
CiB7CiAJc3RydWN0IGk5MTVfcGFnZV9kaXJlY3RvcnkgKnBkOwogCWNvbnN0IGdlbjhfcHRlX3Qg
cHRlX2VuY29kZSA9IGdlbjhfcHRlX2VuY29kZSgwLCBjYWNoZV9sZXZlbCwgZmxhZ3MpOwpAQCAt
MTE4MiwzNSArMTE5OSwyMSBAQCBnZW44X3BwZ3R0X2luc2VydF9wdGVfZW50cmllcyhzdHJ1Y3Qg
aTkxNV9wcGd0dCAqcHBndHQsCiAJcmV0dXJuIGlkeDsKIH0KIAotc3RhdGljIHZvaWQgZ2VuOF9w
cGd0dF9pbnNlcnRfM2x2bChzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSwKLQkJCQkgICBz
dHJ1Y3QgaTkxNV92bWEgKnZtYSwKK3N0YXRpYyB2b2lkIGdlbjhfcHBndHRfaW5zZXJ0X2h1Z2Uo
c3RydWN0IGk5MTVfdm1hICp2bWEsCisJCQkJICAgc3RydWN0IHNndF9kbWEgKml0ZXIsCiAJCQkJ
ICAgZW51bSBpOTE1X2NhY2hlX2xldmVsIGNhY2hlX2xldmVsLAogCQkJCSAgIHUzMiBmbGFncykK
LXsKLQlzdHJ1Y3QgaTkxNV9wcGd0dCAqcHBndHQgPSBpOTE1X3ZtX3RvX3BwZ3R0KHZtKTsKLQlz
dHJ1Y3Qgc2d0X2RtYSBpdGVyID0gc2d0X2RtYSh2bWEpOwotCi0JZ2VuOF9wcGd0dF9pbnNlcnRf
cHRlX2VudHJpZXMocHBndHQsIHBwZ3R0LT5wZCwgJml0ZXIsCi0JCQkJICAgICAgdm1hLT5ub2Rl
LnN0YXJ0ID4+IEdFTjhfUFRFX1NISUZULAotCQkJCSAgICAgIGNhY2hlX2xldmVsLCBmbGFncyk7
Ci0KLQl2bWEtPnBhZ2Vfc2l6ZXMuZ3R0ID0gSTkxNV9HVFRfUEFHRV9TSVpFOwotfQotCi1zdGF0
aWMgdm9pZCBnZW44X3BwZ3R0X2luc2VydF9odWdlX2VudHJpZXMoc3RydWN0IGk5MTVfdm1hICp2
bWEsCi0JCQkJCSAgIHN0cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5ICpwbWw0LAotCQkJCQkgICBz
dHJ1Y3Qgc2d0X2RtYSAqaXRlciwKLQkJCQkJICAgZW51bSBpOTE1X2NhY2hlX2xldmVsIGNhY2hl
X2xldmVsLAotCQkJCQkgICB1MzIgZmxhZ3MpCiB7CiAJY29uc3QgZ2VuOF9wdGVfdCBwdGVfZW5j
b2RlID0gZ2VuOF9wdGVfZW5jb2RlKDAsIGNhY2hlX2xldmVsLCBmbGFncyk7CiAJdTY0IHN0YXJ0
ID0gdm1hLT5ub2RlLnN0YXJ0OwogCWRtYV9hZGRyX3QgcmVtID0gaXRlci0+c2ctPmxlbmd0aDsK
IAorCUdFTV9CVUdfT04oIWk5MTVfdm1faXNfNGx2bCh2bWEtPnZtKSk7CisKIAlkbyB7Ci0JCXN0
cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5ICpwZHAgPQotCQkJaTkxNV9wZF9lbnRyeShwbWw0LCBf
X2dlbjhfcHRlX2luZGV4KHN0YXJ0LCAzKSk7Ci0JCXN0cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5
ICpwZCA9CisJCXN0cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5ICogY29uc3QgcGRwID0KKwkJCWdl
bjhfcGRwX2Zvcl9wYWdlX2FkZHJlc3Modm1hLT52bSwgc3RhcnQpOworCQlzdHJ1Y3QgaTkxNV9w
YWdlX2RpcmVjdG9yeSAqIGNvbnN0IHBkID0KIAkJCWk5MTVfcGRfZW50cnkocGRwLCBfX2dlbjhf
cHRlX2luZGV4KHN0YXJ0LCAyKSk7CiAJCWdlbjhfcHRlX3QgZW5jb2RlID0gcHRlX2VuY29kZTsK
IAkJdW5zaWduZWQgaW50IG1heWJlXzY0SyA9IC0xOwpAQCAtMTMxNiwyNiArMTMxOSwzMCBAQCBz
dGF0aWMgdm9pZCBnZW44X3BwZ3R0X2luc2VydF9odWdlX2VudHJpZXMoc3RydWN0IGk5MTVfdm1h
ICp2bWEsCiAJfSB3aGlsZSAoaXRlci0+c2cpOwogfQogCi1zdGF0aWMgdm9pZCBnZW44X3BwZ3R0
X2luc2VydF80bHZsKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtLAotCQkJCSAgIHN0cnVj
dCBpOTE1X3ZtYSAqdm1hLAotCQkJCSAgIGVudW0gaTkxNV9jYWNoZV9sZXZlbCBjYWNoZV9sZXZl
bCwKLQkJCQkgICB1MzIgZmxhZ3MpCitzdGF0aWMgdm9pZCBnZW44X3BwZ3R0X2luc2VydChzdHJ1
Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSwKKwkJCSAgICAgIHN0cnVjdCBpOTE1X3ZtYSAqdm1h
LAorCQkJICAgICAgZW51bSBpOTE1X2NhY2hlX2xldmVsIGNhY2hlX2xldmVsLAorCQkJICAgICAg
dTMyIGZsYWdzKQogewotCXN0cnVjdCBpOTE1X3BwZ3R0ICpwcGd0dCA9IGk5MTVfdm1fdG9fcHBn
dHQodm0pOworCXN0cnVjdCBpOTE1X3BwZ3R0ICogY29uc3QgcHBndHQgPSBpOTE1X3ZtX3RvX3Bw
Z3R0KHZtKTsKIAlzdHJ1Y3Qgc2d0X2RtYSBpdGVyID0gc2d0X2RtYSh2bWEpOwotCXN0cnVjdCBp
OTE1X3BhZ2VfZGlyZWN0b3J5ICogY29uc3QgcG1sNCA9IHBwZ3R0LT5wZDsKIAogCWlmICh2bWEt
PnBhZ2Vfc2l6ZXMuc2cgPiBJOTE1X0dUVF9QQUdFX1NJWkUpIHsKLQkJZ2VuOF9wcGd0dF9pbnNl
cnRfaHVnZV9lbnRyaWVzKHZtYSwgcG1sNCwgJml0ZXIsIGNhY2hlX2xldmVsLAotCQkJCQkgICAg
ICAgZmxhZ3MpOwotCX0gZWxzZSB7CisJCWdlbjhfcHBndHRfaW5zZXJ0X2h1Z2Uodm1hLCAmaXRl
ciwgY2FjaGVfbGV2ZWwsIGZsYWdzKTsKKwl9IGVsc2UgIHsKIAkJdTY0IGlkeCA9IHZtYS0+bm9k
ZS5zdGFydCA+PiBHRU44X1BURV9TSElGVDsKIAotCQl3aGlsZSAoKGlkeCA9IGdlbjhfcHBndHRf
aW5zZXJ0X3B0ZV9lbnRyaWVzKHBwZ3R0LAotCQkJCQkJCSAgICBpOTE1X3BkX2VudHJ5KHBtbDQs
IGdlbjhfcGRfaW5kZXgoaWR4LCAzKSksCi0JCQkJCQkJICAgICZpdGVyLCBpZHgsIGNhY2hlX2xl
dmVsLAotCQkJCQkJCSAgICBmbGFncykpKQotCQkJOworCQlkbyB7CisJCQlzdHJ1Y3QgaTkxNV9w
YWdlX2RpcmVjdG9yeSAqIGNvbnN0IHBkcCA9CisJCQkJZ2VuOF9wZHBfZm9yX3BhZ2VfaW5kZXgo
dm0sIGlkeCk7CisKKwkJCWlkeCA9IGdlbjhfcHBndHRfaW5zZXJ0X3B0ZShwcGd0dCwKKwkJCQkJ
CSAgICBwZHAsCisJCQkJCQkgICAgJml0ZXIsCisJCQkJCQkgICAgaWR4LAorCQkJCQkJICAgIGNh
Y2hlX2xldmVsLAorCQkJCQkJICAgIGZsYWdzKTsKKwkJfSB3aGlsZSAoaWR4KTsKIAogCQl2bWEt
PnBhZ2Vfc2l6ZXMuZ3R0ID0gSTkxNV9HVFRfUEFHRV9TSVpFOwogCX0KQEAgLTE0OTQsMTggKzE1
MDEsMTUgQEAgc3RhdGljIHN0cnVjdCBpOTE1X3BwZ3R0ICpnZW44X3BwZ3R0X2NyZWF0ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkJZ290byBlcnJfZnJlZV9zY3JhdGNoOwogCX0K
IAotCWlmIChpOTE1X3ZtX2lzXzRsdmwoJnBwZ3R0LT52bSkpIHsKLQkJcHBndHQtPnZtLmluc2Vy
dF9lbnRyaWVzID0gZ2VuOF9wcGd0dF9pbnNlcnRfNGx2bDsKLQl9IGVsc2UgeworCWlmICghaTkx
NV92bV9pc180bHZsKCZwcGd0dC0+dm0pKSB7CiAJCWlmIChpbnRlbF92Z3B1X2FjdGl2ZShpOTE1
KSkgewogCQkJZXJyID0gZ2VuOF9wcmVhbGxvY2F0ZV90b3BfbGV2ZWxfcGRwKHBwZ3R0KTsKIAkJ
CWlmIChlcnIpCiAJCQkJZ290byBlcnJfZnJlZV9wZDsKIAkJfQotCi0JCXBwZ3R0LT52bS5pbnNl
cnRfZW50cmllcyA9IGdlbjhfcHBndHRfaW5zZXJ0XzNsdmw7CiAJfQogCisJcHBndHQtPnZtLmlu
c2VydF9lbnRyaWVzID0gZ2VuOF9wcGd0dF9pbnNlcnQ7CiAJcHBndHQtPnZtLmFsbG9jYXRlX3Zh
X3JhbmdlID0gZ2VuOF9wcGd0dF9hbGxvYzsKIAlwcGd0dC0+dm0uY2xlYXJfcmFuZ2UgPSBnZW44
X3BwZ3R0X2NsZWFyOwogCi0tIAoyLjE3LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3Rz
LmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xp
c3RpbmZvL2ludGVsLWdmeA==

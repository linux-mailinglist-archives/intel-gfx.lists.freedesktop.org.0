Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 0CD514805E
	for <lists+intel-gfx@lfdr.de>; Mon, 17 Jun 2019 13:15:10 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2F9FC891B5;
	Mon, 17 Jun 2019 11:15:08 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id CB5B989026;
 Mon, 17 Jun 2019 11:15:05 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16926061-1500050 
 for multiple; Mon, 17 Jun 2019 12:14:57 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Mon, 17 Jun 2019 12:14:57 +0100
Message-Id: <20190617111457.9226-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t] i915/gem_ctx_shared: Check for a large
 enough hole in the GTT
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: igt-dev@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

SW4gdGhlIGV4ZWMtc2hhcmVkLWd0dCB0ZXN0LCB3ZSBjaGVla2lseSB0cnkgdG8gcmVmZXJlbmNl
IGFuIG9iamVjdCB3ZQpwbGFjZWQgaW4gdGhlIEdUVCBpbiBhbiBlYXJsaWVyIGV4ZWNidWYgKGFu
ZCBhdm9pZCBkZWNsYXJpbmcgaXQgaW4gdGhlCmxhdGVyIGNhbGwpLiBGb3IgYSBnbG9iYWwgR1RU
LCB3aGVyZSB0aGVyZSBtYXkgYmUgZXhpc3Rpbmcgb2JqZWN0cywgd2UKaGF2ZSB0byBmaW5kIGEg
aG9sZSBsYXJnZSBlbm91Z2ggdG8gZml0IGJvdGggYW5kIGF2b2lkIGFuZCBpbXBsaWNpdApndWFy
ZCBwYWdlcy4KCkJ1Z3ppbGxhOiBodHRwczovL2J1Z3MuZnJlZWRlc2t0b3Aub3JnL3Nob3dfYnVn
LmNnaT9pZD0xMTA4NzYKU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13
aWxzb24uY28udWs+Ci0tLQogdGVzdHMvaTkxNS9nZW1fY3R4X3NoYXJlZC5jIHwgMTYgKysrKysr
KysrKysrLS0tLQogMSBmaWxlIGNoYW5nZWQsIDEyIGluc2VydGlvbnMoKyksIDQgZGVsZXRpb25z
KC0pCgpkaWZmIC0tZ2l0IGEvdGVzdHMvaTkxNS9nZW1fY3R4X3NoYXJlZC5jIGIvdGVzdHMvaTkx
NS9nZW1fY3R4X3NoYXJlZC5jCmluZGV4IGVkNDNlODkwMy4uNGIxMDIwYjk2IDEwMDY0NAotLS0g
YS90ZXN0cy9pOTE1L2dlbV9jdHhfc2hhcmVkLmMKKysrIGIvdGVzdHMvaTkxNS9nZW1fY3R4X3No
YXJlZC5jCkBAIC0xODQsNiArMTg0LDcgQEAgc3RhdGljIHZvaWQgZXhoYXVzdF9zaGFyZWRfZ3R0
KGludCBpOTE1LCB1bnNpZ25lZCBpbnQgZmxhZ3MpCiBzdGF0aWMgdm9pZCBleGVjX3NoYXJlZF9n
dHQoaW50IGk5MTUsIHVuc2lnbmVkIGludCByaW5nKQogewogCWNvbnN0IGludCBnZW4gPSBpbnRl
bF9nZW4oaW50ZWxfZ2V0X2RybV9kZXZpZChpOTE1KSk7CisJY29uc3QgdWludDMyX3QgYmJlID0g
TUlfQkFUQ0hfQlVGRkVSX0VORDsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNfb2JqZWN0MiBv
YmogPSB7fTsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNidWZmZXIyIGV4ZWNidWYgPSB7CiAJ
CS5idWZmZXJzX3B0ciA9IHRvX3VzZXJfcG9pbnRlcigmb2JqKSwKQEAgLTE5NywxMSArMTk4LDE5
IEBAIHN0YXRpYyB2b2lkIGV4ZWNfc2hhcmVkX2d0dChpbnQgaTkxNSwgdW5zaWduZWQgaW50IHJp
bmcpCiAJZ2VtX3JlcXVpcmVfcmluZyhpOTE1LCByaW5nKTsKIAlpZ3RfcmVxdWlyZShnZW1fY2Fu
X3N0b3JlX2R3b3JkKGk5MTUsIHJpbmcpKTsKIAorCS8qIEZpbmQgYSBob2xlIGJpZyBlbm91Z2gg
Zm9yIGJvdGggb2JqZWN0cyBsYXRlciAqLworCXNjcmF0Y2ggPSBnZW1fY3JlYXRlKGk5MTUsIDE2
Mzg0KTsKKwlnZW1fd3JpdGUoaTkxNSwgc2NyYXRjaCwgMCwgJmJiZSwgc2l6ZW9mKGJiZSkpOwor
CW9iai5oYW5kbGUgPSBzY3JhdGNoOworCWdlbV9leGVjYnVmKGk5MTUsICZleGVjYnVmKTsKKwln
ZW1fY2xvc2UoaTkxNSwgc2NyYXRjaCk7CisJb2JqLmZsYWdzIHw9IEVYRUNfT0JKRUNUX1BJTk5F
RDsgLyogcmV1c2UgdGhpcyBhZGRyZXNzICovCisKIAlzY3JhdGNoID0gZ2VtX2NyZWF0ZShpOTE1
LCA0MDk2KTsKIAlzID0gZ2VtX21tYXBfX2NwdShpOTE1LCBzY3JhdGNoLCAwLCA0MDk2LCBQUk9U
X1dSSVRFKTsKIAogCWdlbV9zZXRfZG9tYWluKGk5MTUsIHNjcmF0Y2gsIEk5MTVfR0VNX0RPTUFJ
Tl9DUFUsIEk5MTVfR0VNX0RPTUFJTl9DUFUpOwotCSpzID0gTUlfQkFUQ0hfQlVGRkVSX0VORDsK
KwkqcyA9IGJiZTsKIAogCS8qIExvYWQgb2JqZWN0IGludG8gcGxhY2UgaW4gdGhlIEdUVCAqLwog
CW9iai5oYW5kbGUgPSBzY3JhdGNoOwpAQCAtMjI0LDExICsyMzMsMTAgQEAgc3RhdGljIHZvaWQg
ZXhlY19zaGFyZWRfZ3R0KGludCBpOTE1LCB1bnNpZ25lZCBpbnQgcmluZykKIAkJYmF0Y2hbKytp
XSA9IG9iai5vZmZzZXQ7CiAJfQogCWJhdGNoWysraV0gPSAweGMwZmZlZTsKLQliYXRjaFsrK2ld
ID0gTUlfQkFUQ0hfQlVGRkVSX0VORDsKKwliYXRjaFsrK2ldID0gYmJlOwogCWdlbV93cml0ZShp
OTE1LCBvYmouaGFuZGxlLCAwLCBiYXRjaCwgc2l6ZW9mKGJhdGNoKSk7CiAKLQlvYmoub2Zmc2V0
ICs9IDQwOTY7IC8qIG1ha2Ugc3VyZSB3ZSBkb24ndCBjYXVzZSBhbiBldmljdGlvbiEgKi8KLQlv
YmouZmxhZ3MgfD0gRVhFQ19PQkpFQ1RfUElOTkVEOworCW9iai5vZmZzZXQgKz0gODE5MjsgLyog
bWFrZSBzdXJlIHdlIGRvbid0IGNhdXNlIGFuIGV2aWN0aW9uISAqLwogCWV4ZWNidWYucnN2ZDEg
PSBnZW1fY29udGV4dF9jbG9uZShpOTE1LCAwLCBJOTE1X0NPTlRFWFRfQ0xPTkVfVk0sIDApOwog
CWlmIChnZW4gPiAzICYmIGdlbiA8IDYpCiAJCWV4ZWNidWYuZmxhZ3MgfD0gSTkxNV9FWEVDX1NF
Q1VSRTsKLS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0
b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50
ZWwtZ2Z4

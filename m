Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 59179127F4F
	for <lists+intel-gfx@lfdr.de>; Fri, 20 Dec 2019 16:30:29 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B6DE76EC5C;
	Fri, 20 Dec 2019 15:30:26 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga06.intel.com (mga06.intel.com [134.134.136.31])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0FED46EC59
 for <intel-gfx@lists.freedesktop.org>; Fri, 20 Dec 2019 15:30:25 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga007.jf.intel.com ([10.7.209.58])
 by orsmga104.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 20 Dec 2019 07:30:24 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.69,336,1571727600"; d="scan'208";a="206571128"
Received: from kitaracr-mobl.amr.corp.intel.com (HELO
 josouza-MOBL.amr.corp.intel.com) ([10.252.207.149])
 by orsmga007.jf.intel.com with ESMTP; 20 Dec 2019 07:30:22 -0800
From: =?UTF-8?q?Jos=C3=A9=20Roberto=20de=20Souza?= <jose.souza@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 20 Dec 2019 07:29:53 -0800
Message-Id: <20191220152954.83276-6-jose.souza@intel.com>
X-Mailer: git-send-email 2.24.1
In-Reply-To: <20191220152954.83276-1-jose.souza@intel.com>
References: <20191220152954.83276-1-jose.souza@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v5 6/7] drm/i915/display: Check if pipe fastset
 is allowed by external dependencies
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Lucas De Marchi <lucas.demarchi@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Q2hlY2sgaWYgZmFzdHNldCBpcyBhbGxvd2VkIGJ5IGV4dGVybmFsIGRlcGVuZGVuY2llcyBsaWtl
IG90aGVyIHBpcGVzCmFuZCB0cmFuc2NvZGVycy4KClJpZ2h0IG5vdyB0aGlzIHBhdGNoIG9ubHkg
Zm9yY2VzIGEgZnVsbG1vZGVzZXQgaW4gTVNUIHNsYXZlcyBvZiBNU1QKbWFzdGVycyB0aGF0IG5l
ZWRzIGEgZnVsbG1vZGVzZXQgYnV0IGl0IHdpbGwgYmUgbmVlZGVkIGZvciBwb3J0IHN5bmMKYXMg
d2VsbC4KCnYzOgotIG1vdmVkIGhhbmRsaW5nIHRvIGludGVsX2F0b21pY19jaGVjaygpIHRoaXMg
d2F5IGlzIGd1YXJhbnRlZSB0aGF0CmFsbCBwaXBlcyB3aWxsIGhhdmUgaXRzIHN0YXRlIGNvbXB1
dGVkCgp2NDoKLSBhZGRlZCBhIGZ1bmN0aW9uIHRvIHJldHVybiBpZiBNU1QgbWFzdGVyIG5lZWVk
cyBtb2Rlc2V0IHRvIHNpbXBseQpjb2RlIGluIGludGVsX2F0b21pY19jaGVjaygpCgp2NToKLSBm
aXhlZCBhbmQgbW92ZWQgY29kZSB0byBjaGVjayBpZiBNU1QgbWFzdGVyIG5lZWRzIGEgbW9kZXNl
dAoKQ2M6IFZpbGxlIFN5cmrDpGzDpCA8dmlsbGUuc3lyamFsYUBsaW51eC5pbnRlbC5jb20+CkNj
OiBMdWNhcyBEZSBNYXJjaGkgPGx1Y2FzLmRlbWFyY2hpQGludGVsLmNvbT4KQ2M6IE1hYXJ0ZW4g
TGFua2hvcnN0IDxtYWFydGVuLmxhbmtob3JzdEBsaW51eC5pbnRlbC5jb20+CkNjOiBNYW5hc2kg
TmF2YXJlIDxtYW5hc2kuZC5uYXZhcmVAaW50ZWwuY29tPgpSZXZpZXdlZC1ieTogVmlsbGUgU3ly
asOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KU2lnbmVkLW9mZi1ieTogSm9z
w6kgUm9iZXJ0byBkZSBTb3V6YSA8am9zZS5zb3V6YUBpbnRlbC5jb20+Ci0tLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMgfCA3MCArKysrKysrKysrKysrKysr
LS0tLQogMSBmaWxlIGNoYW5nZWQsIDU3IGluc2VydGlvbnMoKyksIDEzIGRlbGV0aW9ucygtKQoK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKaW5kZXggMjQ4
NDFkZGU0OTBiLi4xMWYyYzEzZWMyM2UgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfZGlzcGxheS5jCkBAIC0xMzkwOSwxOSArMTM5MDksNiBAQCBzdGF0aWMgdm9pZCBp
bnRlbF9jcnRjX2NoZWNrX2Zhc3RzZXQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9s
ZF9jcnRjX3N0YQogCiAJbmV3X2NydGNfc3RhdGUtPnVhcGkubW9kZV9jaGFuZ2VkID0gZmFsc2U7
CiAJbmV3X2NydGNfc3RhdGUtPnVwZGF0ZV9waXBlID0gdHJ1ZTsKLQotCS8qCi0JICogSWYgd2Un
cmUgbm90IGRvaW5nIHRoZSBmdWxsIG1vZGVzZXQgd2Ugd2FudCB0bwotCSAqIGtlZXAgdGhlIGN1
cnJlbnQgTS9OIHZhbHVlcyBhcyB0aGV5IG1heSBiZQotCSAqIHN1ZmZpY2llbnRseSBkaWZmZXJl
bnQgdG8gdGhlIGNvbXB1dGVkIHZhbHVlcwotCSAqIHRvIGNhdXNlIHByb2JsZW1zLgotCSAqCi0J
ICogRklYTUU6IHNob3VsZCByZWFsbHkgY29weSBtb3JlIGZ1enp5IHN0YXRlIGhlcmUKLQkgKi8K
LQluZXdfY3J0Y19zdGF0ZS0+ZmRpX21fbiA9IG9sZF9jcnRjX3N0YXRlLT5mZGlfbV9uOwotCW5l
d19jcnRjX3N0YXRlLT5kcF9tX24gPSBvbGRfY3J0Y19zdGF0ZS0+ZHBfbV9uOwotCW5ld19jcnRj
X3N0YXRlLT5kcF9tMl9uMiA9IG9sZF9jcnRjX3N0YXRlLT5kcF9tMl9uMjsKLQluZXdfY3J0Y19z
dGF0ZS0+aGFzX2RycnMgPSBvbGRfY3J0Y19zdGF0ZS0+aGFzX2RycnM7CiB9CiAKIHN0YXRpYyBp
bnQgaW50ZWxfY3J0Y19hZGRfcGxhbmVzX3RvX3N0YXRlKHN0cnVjdCBpbnRlbF9hdG9taWNfc3Rh
dGUgKnN0YXRlLApAQCAtMTQwMzIsNiArMTQwMTksMjAgQEAgc3RhdGljIGludCBpbnRlbF9hdG9t
aWNfY2hlY2tfY3J0Y3Moc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCiAJcmV0dXJu
IDA7CiB9CiAKK3N0YXRpYyBib29sIGludGVsX2NwdV90cmFuc2NvZGVyX25lZWRzX21vZGVzZXQo
c3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkJCSAgICAgICBlbnVtIHRyYW5z
Y29kZXIgdHJhbnNjb2RlcikKK3sKKwlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNf
c3RhdGU7CisJc3RydWN0IGludGVsX2NydGMgKmNydGM7CisJaW50IGk7CisKKwlmb3JfZWFjaF9u
ZXdfaW50ZWxfY3J0Y19pbl9zdGF0ZShzdGF0ZSwgY3J0YywgbmV3X2NydGNfc3RhdGUsIGkpCisJ
CWlmIChuZXdfY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXIgPT0gdHJhbnNjb2RlcikKKwkJCXJl
dHVybiBuZWVkc19tb2Rlc2V0KG5ld19jcnRjX3N0YXRlKTsKKworCXJldHVybiBmYWxzZTsKK30K
KwogLyoqCiAgKiBpbnRlbF9hdG9taWNfY2hlY2sgLSB2YWxpZGF0ZSBzdGF0ZSBvYmplY3QKICAq
IEBkZXY6IGRybSBkZXZpY2UKQEAgLTE0MDg5LDYgKzE0MDkwLDQ5IEBAIHN0YXRpYyBpbnQgaW50
ZWxfYXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJCQlhbnlfbXMgPSB0cnVl
OwogCX0KIAorCS8qKgorCSAqIENoZWNrIGlmIGZhc3RzZXQgaXMgYWxsb3dlZCBieSBleHRlcm5h
bCBkZXBlbmRlbmNpZXMgbGlrZSBvdGhlcgorCSAqIHBpcGVzIGFuZCB0cmFuc2NvZGVycy4KKwkg
KgorCSAqIFJpZ2h0IG5vdyBpdCBvbmx5IGZvcmNlcyBhIGZ1bGxtb2Rlc2V0IHdoZW4gdGhlIE1T
VCBtYXN0ZXIKKwkgKiB0cmFuc2NvZGVyIGRpZCBub3QgY2hhbmdlZCBidXQgdGhlIHBpcGUgb2Yg
dGhlIG1hc3RlciB0cmFuc2NvZGVyCisJICogbmVlZHMgYSBmdWxsbW9kZXNldCBzbyBhbGwgc2xh
dmVzIGFsc28gbmVlZHMgdG8gZG8gYSBmdWxsbW9kZXNldC4KKwkgKi8KKwlmb3JfZWFjaF9uZXdf
aW50ZWxfY3J0Y19pbl9zdGF0ZShzdGF0ZSwgY3J0YywgbmV3X2NydGNfc3RhdGUsIGkpIHsKKwkJ
ZW51bSB0cmFuc2NvZGVyIG1hc3RlciA9IG5ld19jcnRjX3N0YXRlLT5tc3RfbWFzdGVyX3RyYW5z
Y29kZXI7CisKKwkJaWYgKCFuZXdfY3J0Y19zdGF0ZS0+dWFwaS5lbmFibGUgfHwKKwkJICAgICFp
bnRlbF9kcF9tc3RfaXNfc2xhdmVfdHJhbnMobmV3X2NydGNfc3RhdGUpIHx8CisJCSAgICBuZWVk
c19tb2Rlc2V0KG5ld19jcnRjX3N0YXRlKSkKKwkJCWNvbnRpbnVlOworCisJCWlmIChpbnRlbF9j
cHVfdHJhbnNjb2Rlcl9uZWVkc19tb2Rlc2V0KHN0YXRlLCBtYXN0ZXIpKSB7CisJCQluZXdfY3J0
Y19zdGF0ZS0+dWFwaS5tb2RlX2NoYW5nZWQgPSB0cnVlOworCQkJbmV3X2NydGNfc3RhdGUtPnVw
ZGF0ZV9waXBlID0gZmFsc2U7CisJCX0KKwl9CisKKwlmb3JfZWFjaF9vbGRuZXdfaW50ZWxfY3J0
Y19pbl9zdGF0ZShzdGF0ZSwgY3J0Yywgb2xkX2NydGNfc3RhdGUsCisJCQkJCSAgICBuZXdfY3J0
Y19zdGF0ZSwgaSkgeworCQlpZiAoIW5ld19jcnRjX3N0YXRlLT51YXBpLmVuYWJsZSB8fAorCQkg
ICAgbmVlZHNfbW9kZXNldChuZXdfY3J0Y19zdGF0ZSkgfHwKKwkJICAgICFuZXdfY3J0Y19zdGF0
ZS0+dXBkYXRlX3BpcGUpCisJCQljb250aW51ZTsKKworCQkvKgorCQkgKiBJZiB3ZSdyZSBub3Qg
ZG9pbmcgdGhlIGZ1bGwgbW9kZXNldCB3ZSB3YW50IHRvCisJCSAqIGtlZXAgdGhlIGN1cnJlbnQg
TS9OIHZhbHVlcyBhcyB0aGV5IG1heSBiZQorCQkgKiBzdWZmaWNpZW50bHkgZGlmZmVyZW50IHRv
IHRoZSBjb21wdXRlZCB2YWx1ZXMKKwkJICogdG8gY2F1c2UgcHJvYmxlbXMuCisJCSAqCisJCSAq
IEZJWE1FOiBzaG91bGQgcmVhbGx5IGNvcHkgbW9yZSBmdXp6eSBzdGF0ZSBoZXJlCisJCSAqLwor
CQluZXdfY3J0Y19zdGF0ZS0+ZmRpX21fbiA9IG9sZF9jcnRjX3N0YXRlLT5mZGlfbV9uOworCQlu
ZXdfY3J0Y19zdGF0ZS0+ZHBfbV9uID0gb2xkX2NydGNfc3RhdGUtPmRwX21fbjsKKwkJbmV3X2Ny
dGNfc3RhdGUtPmRwX20yX24yID0gb2xkX2NydGNfc3RhdGUtPmRwX20yX24yOworCQluZXdfY3J0
Y19zdGF0ZS0+aGFzX2RycnMgPSBvbGRfY3J0Y19zdGF0ZS0+aGFzX2RycnM7CisJfQorCiAJaWYg
KGFueV9tcyAmJiAhY2hlY2tfZGlnaXRhbF9wb3J0X2NvbmZsaWN0cyhzdGF0ZSkpIHsKIAkJRFJN
X0RFQlVHX0tNUygicmVqZWN0aW5nIGNvbmZsaWN0aW5nIGRpZ2l0YWwgcG9ydCBjb25maWd1cmF0
aW9uXG4iKTsKIAkJcmV0ID0gRUlOVkFMOwotLSAKMi4yNC4xCgpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVs
LWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcv
bWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZngK

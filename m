Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 792B12E9468
	for <lists+intel-gfx@lfdr.de>; Mon,  4 Jan 2021 12:59:15 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 91239899DE;
	Mon,  4 Jan 2021 11:59:12 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga09.intel.com (mga09.intel.com [134.134.136.24])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 190748982A
 for <intel-gfx@lists.freedesktop.org>; Mon,  4 Jan 2021 11:59:11 +0000 (UTC)
IronPort-SDR: o8J7aTZcKQQqKsB4q3pJ5jo9ep0ZWwl2MZol9eTZ6n2pfWEtxpo5Fh4kByIXBLzGByUz+F2BUU
 EU1Vqxbd8+/Q==
X-IronPort-AV: E=McAfee;i="6000,8403,9853"; a="177097757"
X-IronPort-AV: E=Sophos;i="5.78,473,1599548400"; d="scan'208";a="177097757"
Received: from orsmga008.jf.intel.com ([10.7.209.65])
 by orsmga102.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 04 Jan 2021 03:59:10 -0800
IronPort-SDR: BUGwqx7zBN+46xSYs2C8G+N7CtH7pmMy61jjussoLMYshLGlei2nRRjRtmHOWPGC0Oh2QT/e4Y
 Px2ZpQKPO80Q==
X-IronPort-AV: E=Sophos;i="5.78,473,1599548400"; d="scan'208";a="378390075"
Received: from helsinki.fi.intel.com ([10.237.66.162])
 by orsmga008-auth.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 04 Jan 2021 03:59:09 -0800
From: Gwan-gyeong Mun <gwan-gyeong.mun@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Mon,  4 Jan 2021 13:58:41 +0200
Message-Id: <20210104115844.1068561-2-gwan-gyeong.mun@intel.com>
X-Mailer: git-send-email 2.25.0
In-Reply-To: <20210104115844.1068561-1-gwan-gyeong.mun@intel.com>
References: <20210104115844.1068561-1-gwan-gyeong.mun@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v10 2/5] drm/i915/display/psr: Use plane damage
 clips to calculate damaged area
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogSm9zw6kgUm9iZXJ0byBkZSBTb3V6YSA8am9zZS5zb3V6YUBpbnRlbC5jb20+CgpOb3cg
dXNpbmcgcGxhbmUgZGFtYWdlIGNsaXBzIHByb3BlcnR5IHRvIGNhbGN1YWx0ZSB0aGUgZGFtYWdl
ZCBhcmVhLgpTZWxlY3RpdmUgZmV0Y2ggb25seSBzdXBwb3J0cyBvbmUgcmVnaW9uIHRvIGJlIGZl
dGNoZWQgc28gc29mdHdhcmUKbmVlZHMgdG8gY2FsY3VsYXRlIGEgYm91bmRpbmcgYm94IGFyb3Vu
ZCBhbGwgZGFtYWdlIGNsaXBzLgoKTm93IHRoYXQgd2UgYXJlIG5vdCBjb21wbGV0ZSBmZXRjaGlu
ZyBlYWNoIHBsYW5lLCB0aGVyZSBpcyBhbm90aGVyCmxvb3AgbmVlZGVkIGFzIGFsbCB0aGUgcGxh
bmUgYXJlYXMgdGhhdCBpbnRlcnNlY3Qgd2l0aCB0aGUgcGlwZQpkYW1hZ2VkIGFyZWEgbmVlZHMg
dG8gYmUgZmV0Y2hlZCBmcm9tIG1lbW9yeSBzbyB0aGUgY29tcGxldGUgYmxlbmRpbmcKb2YgYWxs
IHBsYW5lcyBjYW4gaGFwcGVuLgoKdjI6Ci0gZG8gbm90IHNoaWZ0aW5nIG5ld19wbGFuZV9zdGF0
ZS0+dWFwaS5kc3Qgb25seSBzcmMgaXMgaW4gMTYuMTYgZm9ybWF0Cgp2NDoKLSBzZXR0aW5nIHBs
YW5lIHNlbGVjdGl2ZSBmZXRjaCBhcmVhIHVzaW5nIHRoZSB3aG9sZSBwaXBlIGRhbWFnZSBhcmVh
Ci0gbWFyayB0aGUgd2hvbGUgcGxhbmUgYXJlYSBkYW1hZ2VkIGlmIHBsYW5lIHZpc2liaWxpdHkg
b3IgYWxwaGEKY2hhbmdlZAoKdjU6Ci0gdGFraW5nIGluIGNvbnNpZGVyYXRpb24gc3JjLnkxIGlu
IHRoZSBkYW1hZ2UgY29vcmRpbmF0ZXMKLSBhZGRpbmcgdG8gdGhlIHBpcGUgZGFtYWdlZCBhcmVh
IHBsYW5lcyB0aGF0IHdlcmUgdmlzaWJsZSBidXQgYXJlCmludmlzaWJsZSBpbiB0aGUgbmV3IHN0
YXRlCgp2NjoKLSBjb25zaWRlciBvbGQgc3RhdGUgcGxhbmUgY29vcmRpbmF0ZXMgd2hlbiB2aXNp
YmlsaXR5IGNoYW5nZXMgb3IgaXQKbW92ZWQgdG8gY2FsY3VsYXRlIGRhbWFnZWQgYXJlYQotIHJl
bW92ZSBmcm9tIGRhbWFnZWQgYXJlYSB0aGUgcG9ydGlvbiBub3QgaW4gc3JjIGNsaXAKCnY3Ogot
IGludGVyc2VjIGV2ZXJ5IGRhbWFnZSBjbGlwIHdpdGggc3JjIHRvIG1pbmltaXplIGRhbWFnZWQg
YXJlYQoKdjg6Ci0gYWRqdXN0IHBpcGVfZGFtYWdlZCBhcmVhIHRvIDQgbGluZXMgZ3JvdXBpbmcK
LSBhZGp1c3QgY2FsY3VsYXRpb24gbm93IHRoYXQgaXMgdW5kZXJzdG9vZCB0aGF0IHVhcGkuc3Jj
IGlzIHRoZQpmcmFtZWJ1ZmZlciBjb29yZGluYXRlcyB0aGF0IHBsYW5lIHdpbGwgc3RhcnQgdG8g
ZmV0Y2ggZnJvbQoKdjk6Ci0gT25seSBhZGQgcGxhbmUgZHN0IG9yIHNyYyB0byBkYW1hZ2VkX2Fy
ZWEgaWYgdmlzaWJsZQotIEVhcmx5IHNraXAgcGxhbmUgZGFtYWdlIGNhbGN1bGF0aW9uIGlmIGl0
IHdhcyBub3QgdmlzaWJsZSBpbiBvbGQgYW5kCm5ldyBzdGF0ZQoKQ2M6IFZpbGxlIFN5cmrDpGzD
pCA8dmlsbGUuc3lyamFsYUBsaW51eC5pbnRlbC5jb20+CkNjOiBHd2FuLWd5ZW9uZyBNdW4gPGd3
YW4tZ3llb25nLm11bkBpbnRlbC5jb20+ClNpZ25lZC1vZmYtYnk6IEpvc8OpIFJvYmVydG8gZGUg
U291emEgPGpvc2Uuc291emFAaW50ZWwuY29tPgpSZXZpZXdlZC1ieTogR3dhbi1neWVvbmcgTXVu
IDxnd2FuLWd5ZW9uZy5tdW5AaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfcHNyLmMgfCAxMTMgKysrKysrKysrKysrKysrKysrKystLS0KIDEgZmlsZSBj
aGFuZ2VkLCA5OSBpbnNlcnRpb25zKCspLCAxNCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Bzci5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9wc3IuYwppbmRleCBkOWEzOTVjNDg2ZDMuLmY1Yjk1MTliMzc1
NiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9wc3IuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Bzci5jCkBAIC0xMjQyLDkg
KzEyNDIsMTEgQEAgc3RhdGljIHZvaWQgcHNyMl9tYW5fdHJrX2N0bF9jYWxjKHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCWlmIChjbGlwLT55MSA9PSAtMSkKIAkJZ290byBl
eGl0OwogCisJZHJtX1dBUk5fT04oY3J0Y19zdGF0ZS0+dWFwaS5jcnRjLT5kZXYsIGNsaXAtPnkx
ICUgNCB8fCBjbGlwLT55MiAlIDQpOworCiAJdmFsIHw9IFBTUjJfTUFOX1RSS19DVExfU0ZfUEFS
VElBTF9GUkFNRV9VUERBVEU7CiAJdmFsIHw9IFBTUjJfTUFOX1RSS19DVExfU1VfUkVHSU9OX1NU
QVJUX0FERFIoY2xpcC0+eTEgLyA0ICsgMSk7Ci0JdmFsIHw9IFBTUjJfTUFOX1RSS19DVExfU1Vf
UkVHSU9OX0VORF9BRERSKERJVl9ST1VORF9VUChjbGlwLT55MiwgNCkgKyAxKTsKKwl2YWwgfD0g
UFNSMl9NQU5fVFJLX0NUTF9TVV9SRUdJT05fRU5EX0FERFIoY2xpcC0+eTIgLyA0ICsgMSk7CiBl
eGl0OgogCWNydGNfc3RhdGUtPnBzcjJfbWFuX3RyYWNrX2N0bCA9IHZhbDsKIH0KQEAgLTEyNjks
OCArMTI3MSw4IEBAIGludCBpbnRlbF9wc3IyX3NlbF9mZXRjaF91cGRhdGUoc3RydWN0IGludGVs
X2F0b21pY19zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IGludGVsX2NydGMgKmNydGMpCiB7CiAJ
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUgPSBpbnRlbF9hdG9taWNfZ2V0X25l
d19jcnRjX3N0YXRlKHN0YXRlLCBjcnRjKTsKKwlzdHJ1Y3QgZHJtX3JlY3QgcGlwZV9jbGlwID0g
eyAueDEgPSAwLCAueTEgPSAtMSwgLngyID0gSU5UX01BWCwgLnkyID0gLTEgfTsKIAlzdHJ1Y3Qg
aW50ZWxfcGxhbmVfc3RhdGUgKm5ld19wbGFuZV9zdGF0ZSwgKm9sZF9wbGFuZV9zdGF0ZTsKLQlz
dHJ1Y3QgZHJtX3JlY3QgcGlwZV9jbGlwID0geyAueTEgPSAtMSB9OwogCXN0cnVjdCBpbnRlbF9w
bGFuZSAqcGxhbmU7CiAJYm9vbCBmdWxsX3VwZGF0ZSA9IGZhbHNlOwogCWludCBpLCByZXQ7CkBA
IC0xMjgyLDEzICsxMjg0LDI1IEBAIGludCBpbnRlbF9wc3IyX3NlbF9mZXRjaF91cGRhdGUoc3Ry
dWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsK
IAorCS8qCisJICogQ2FsY3VsYXRlIG1pbmltYWwgc2VsZWN0aXZlIGZldGNoIGFyZWEgb2YgZWFj
aCBwbGFuZSBhbmQgY2FsY3VsYXRlCisJICogdGhlIHBpcGUgZGFtYWdlZCBhcmVhLgorCSAqIElu
IHRoZSBuZXh0IGxvb3AgdGhlIHBsYW5lIHNlbGVjdGl2ZSBmZXRjaCBhcmVhIHdpbGwgYWN0dWFs
bHkgYmUgc2V0CisJICogdXNpbmcgd2hvbGUgcGlwZSBkYW1hZ2VkIGFyZWEuCisJICovCiAJZm9y
X2VhY2hfb2xkbmV3X2ludGVsX3BsYW5lX2luX3N0YXRlKHN0YXRlLCBwbGFuZSwgb2xkX3BsYW5l
X3N0YXRlLAogCQkJCQkgICAgIG5ld19wbGFuZV9zdGF0ZSwgaSkgewotCQlzdHJ1Y3QgZHJtX3Jl
Y3QgKnNlbF9mZXRjaF9hcmVhLCB0ZW1wOworCQlzdHJ1Y3QgZHJtX3JlY3Qgc3JjLCBkYW1hZ2Vk
X2FyZWEgPSB7IC55MSA9IC0xIH07CisJCXN0cnVjdCBkcm1fbW9kZV9yZWN0ICpkYW1hZ2VkX2Ns
aXBzOworCQl1MzIgbnVtX2NsaXBzLCBqOwogCiAJCWlmIChuZXdfcGxhbmVfc3RhdGUtPnVhcGku
Y3J0YyAhPSBjcnRjX3N0YXRlLT51YXBpLmNydGMpCiAJCQljb250aW51ZTsKIAorCQlpZiAoIW5l
d19wbGFuZV9zdGF0ZS0+dWFwaS52aXNpYmxlICYmCisJCSAgICAhb2xkX3BsYW5lX3N0YXRlLT51
YXBpLnZpc2libGUpCisJCQljb250aW51ZTsKKwogCQkvKgogCQkgKiBUT0RPOiBOb3QgY2xlYXIg
aG93IHRvIGhhbmRsZSBwbGFuZXMgd2l0aCBuZWdhdGl2ZSBwb3NpdGlvbiwKIAkJICogYWxzbyBw
bGFuZXMgYXJlIG5vdCB1cGRhdGVkIGlmIHRoZXkgaGF2ZSBhIG5lZ2F0aXZlIFgKQEAgLTEzMDAs
MjMgKzEzMTQsOTQgQEAgaW50IGludGVsX3BzcjJfc2VsX2ZldGNoX3VwZGF0ZShzdHJ1Y3QgaW50
ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKIAkJCWJyZWFrOwogCQl9CiAKLQkJaWYgKCFuZXdfcGxh
bmVfc3RhdGUtPnVhcGkudmlzaWJsZSkKLQkJCWNvbnRpbnVlOworCQludW1fY2xpcHMgPSBkcm1f
cGxhbmVfZ2V0X2RhbWFnZV9jbGlwc19jb3VudCgmbmV3X3BsYW5lX3N0YXRlLT51YXBpKTsKIAog
CQkvKgotCQkgKiBGb3Igbm93IGRvaW5nIGEgc2VsZWN0aXZlIGZldGNoIGluIHRoZSB3aG9sZSBw
bGFuZSBhcmVhLAotCQkgKiBvcHRpbWl6YXRpb25zIHdpbGwgY29tZSBpbiB0aGUgZnV0dXJlLgor
CQkgKiBJZiB2aXNpYmlsaXR5IG9yIHBsYW5lIG1vdmVkLCBtYXJrIHRoZSB3aG9sZSBwbGFuZSBh
cmVhIGFzCisJCSAqIGRhbWFnZWQgYXMgaXQgbmVlZHMgdG8gYmUgY29tcGxldGUgcmVkcmF3IGlu
IHRoZSBuZXcgYW5kIG9sZAorCQkgKiBwb3NpdGlvbi4KIAkJICovCi0JCXNlbF9mZXRjaF9hcmVh
ID0gJm5ld19wbGFuZV9zdGF0ZS0+cHNyMl9zZWxfZmV0Y2hfYXJlYTsKLQkJc2VsX2ZldGNoX2Fy
ZWEtPnkxID0gbmV3X3BsYW5lX3N0YXRlLT51YXBpLnNyYy55MSA+PiAxNjsKLQkJc2VsX2ZldGNo
X2FyZWEtPnkyID0gbmV3X3BsYW5lX3N0YXRlLT51YXBpLnNyYy55MiA+PiAxNjsKKwkJaWYgKG5l
d19wbGFuZV9zdGF0ZS0+dWFwaS52aXNpYmxlICE9IG9sZF9wbGFuZV9zdGF0ZS0+dWFwaS52aXNp
YmxlIHx8CisJCSAgICAhZHJtX3JlY3RfZXF1YWxzKCZuZXdfcGxhbmVfc3RhdGUtPnVhcGkuZHN0
LAorCQkJCSAgICAgJm9sZF9wbGFuZV9zdGF0ZS0+dWFwaS5kc3QpKSB7CisJCQlpZiAob2xkX3Bs
YW5lX3N0YXRlLT51YXBpLnZpc2libGUpIHsKKwkJCQlkYW1hZ2VkX2FyZWEueTEgPSBvbGRfcGxh
bmVfc3RhdGUtPnVhcGkuZHN0LnkxOworCQkJCWRhbWFnZWRfYXJlYS55MiA9IG9sZF9wbGFuZV9z
dGF0ZS0+dWFwaS5kc3QueTI7CisJCQkJY2xpcF9hcmVhX3VwZGF0ZSgmcGlwZV9jbGlwLCAmZGFt
YWdlZF9hcmVhKTsKKwkJCX0KKworCQkJaWYgKG5ld19wbGFuZV9zdGF0ZS0+dWFwaS52aXNpYmxl
KSB7CisJCQkJZGFtYWdlZF9hcmVhLnkxID0gbmV3X3BsYW5lX3N0YXRlLT51YXBpLmRzdC55MTsK
KwkJCQlkYW1hZ2VkX2FyZWEueTIgPSBuZXdfcGxhbmVfc3RhdGUtPnVhcGkuZHN0LnkyOworCQkJ
CWNsaXBfYXJlYV91cGRhdGUoJnBpcGVfY2xpcCwgJmRhbWFnZWRfYXJlYSk7CisJCQl9CisJCQlj
b250aW51ZTsKKwkJfSBlbHNlIGlmIChuZXdfcGxhbmVfc3RhdGUtPnVhcGkuYWxwaGEgIT0gb2xk
X3BsYW5lX3N0YXRlLT51YXBpLmFscGhhIHx8CisJCQkgICAoIW51bV9jbGlwcyAmJgorCQkJICAg
IG5ld19wbGFuZV9zdGF0ZS0+dWFwaS5mYiAhPSBvbGRfcGxhbmVfc3RhdGUtPnVhcGkuZmIpKSB7
CisJCQkvKgorCQkJICogSWYgdGhlIHBsYW5lIGRvbid0IGhhdmUgZGFtYWdlZCBhcmVhcyBidXQg
dGhlCisJCQkgKiBmcmFtZWJ1ZmZlciBjaGFuZ2VkIG9yIGFscGhhIGNoYW5nZWQsIG1hcmsgdGhl
IHdob2xlCisJCQkgKiBwbGFuZSBhcmVhIGFzIGRhbWFnZWQuCisJCQkgKi8KKwkJCWRhbWFnZWRf
YXJlYS55MSA9IG5ld19wbGFuZV9zdGF0ZS0+dWFwaS5kc3QueTE7CisJCQlkYW1hZ2VkX2FyZWEu
eTIgPSBuZXdfcGxhbmVfc3RhdGUtPnVhcGkuZHN0LnkyOworCQkJY2xpcF9hcmVhX3VwZGF0ZSgm
cGlwZV9jbGlwLCAmZGFtYWdlZF9hcmVhKTsKKwkJCWNvbnRpbnVlOworCQl9CisKKwkJZHJtX3Jl
Y3RfZnBfdG9faW50KCZzcmMsICZuZXdfcGxhbmVfc3RhdGUtPnVhcGkuc3JjKTsKKwkJZGFtYWdl
ZF9jbGlwcyA9IGRybV9wbGFuZV9nZXRfZGFtYWdlX2NsaXBzKCZuZXdfcGxhbmVfc3RhdGUtPnVh
cGkpOworCisJCWZvciAoaiA9IDA7IGogPCBudW1fY2xpcHM7IGorKykgeworCQkJc3RydWN0IGRy
bV9yZWN0IGNsaXA7CisKKwkJCWNsaXAueDEgPSBkYW1hZ2VkX2NsaXBzW2pdLngxOworCQkJY2xp
cC55MSA9IGRhbWFnZWRfY2xpcHNbal0ueTE7CisJCQljbGlwLngyID0gZGFtYWdlZF9jbGlwc1tq
XS54MjsKKwkJCWNsaXAueTIgPSBkYW1hZ2VkX2NsaXBzW2pdLnkyOworCQkJaWYgKGRybV9yZWN0
X2ludGVyc2VjdCgmY2xpcCwgJnNyYykpCisJCQkJY2xpcF9hcmVhX3VwZGF0ZSgmZGFtYWdlZF9h
cmVhLCAmY2xpcCk7CisJCX0KIAotCQl0ZW1wID0gKnNlbF9mZXRjaF9hcmVhOwotCQl0ZW1wLnkx
ICs9IG5ld19wbGFuZV9zdGF0ZS0+dWFwaS5kc3QueTE7Ci0JCXRlbXAueTIgKz0gbmV3X3BsYW5l
X3N0YXRlLT51YXBpLmRzdC55MjsKLQkJY2xpcF9hcmVhX3VwZGF0ZSgmcGlwZV9jbGlwLCAmdGVt
cCk7CisJCWlmIChkYW1hZ2VkX2FyZWEueTEgPT0gLTEpCisJCQljb250aW51ZTsKKworCQlkYW1h
Z2VkX2FyZWEueTEgKz0gbmV3X3BsYW5lX3N0YXRlLT51YXBpLmRzdC55MSAtIHNyYy55MTsKKwkJ
ZGFtYWdlZF9hcmVhLnkyICs9IG5ld19wbGFuZV9zdGF0ZS0+dWFwaS5kc3QueTEgLSBzcmMueTE7
CisJCWNsaXBfYXJlYV91cGRhdGUoJnBpcGVfY2xpcCwgJmRhbWFnZWRfYXJlYSk7CisJfQorCisJ
aWYgKGZ1bGxfdXBkYXRlKQorCQlnb3RvIHNraXBfc2VsX2ZldGNoX3NldF9sb29wOworCisJLyog
SXQgbXVzdCBiZSBhbGlnbmVkIHRvIDQgbGluZXMgKi8KKwlwaXBlX2NsaXAueTEgLT0gcGlwZV9j
bGlwLnkxICUgNDsKKwlpZiAocGlwZV9jbGlwLnkyICUgNCkKKwkJcGlwZV9jbGlwLnkyID0gKChw
aXBlX2NsaXAueTIgLyA0KSArIDEpICogNDsKKworCS8qCisJICogTm93IHRoYXQgd2UgaGF2ZSB0
aGUgcGlwZSBkYW1hZ2VkIGFyZWEgY2hlY2sgaWYgaXQgaW50ZXJzZWN0IHdpdGgKKwkgKiBldmVy
eSBwbGFuZSwgaWYgaXQgZG9lcyBzZXQgdGhlIHBsYW5lIHNlbGVjdGl2ZSBmZXRjaCBhcmVhLgor
CSAqLworCWZvcl9lYWNoX29sZG5ld19pbnRlbF9wbGFuZV9pbl9zdGF0ZShzdGF0ZSwgcGxhbmUs
IG9sZF9wbGFuZV9zdGF0ZSwKKwkJCQkJICAgICBuZXdfcGxhbmVfc3RhdGUsIGkpIHsKKwkJc3Ry
dWN0IGRybV9yZWN0ICpzZWxfZmV0Y2hfYXJlYSwgaW50ZXI7CisKKwkJaWYgKG5ld19wbGFuZV9z
dGF0ZS0+dWFwaS5jcnRjICE9IGNydGNfc3RhdGUtPnVhcGkuY3J0YyB8fAorCQkgICAgIW5ld19w
bGFuZV9zdGF0ZS0+dWFwaS52aXNpYmxlKQorCQkJY29udGludWU7CisKKwkJaW50ZXIgPSBwaXBl
X2NsaXA7CisJCWlmICghZHJtX3JlY3RfaW50ZXJzZWN0KCZpbnRlciwgJm5ld19wbGFuZV9zdGF0
ZS0+dWFwaS5kc3QpKQorCQkJY29udGludWU7CisKKwkJc2VsX2ZldGNoX2FyZWEgPSAmbmV3X3Bs
YW5lX3N0YXRlLT5wc3IyX3NlbF9mZXRjaF9hcmVhOworCQlzZWxfZmV0Y2hfYXJlYS0+eTEgPSBp
bnRlci55MSAtIG5ld19wbGFuZV9zdGF0ZS0+dWFwaS5kc3QueTE7CisJCXNlbF9mZXRjaF9hcmVh
LT55MiA9IGludGVyLnkyIC0gbmV3X3BsYW5lX3N0YXRlLT51YXBpLmRzdC55MTsKIAl9CiAKK3Nr
aXBfc2VsX2ZldGNoX3NldF9sb29wOgogCXBzcjJfbWFuX3Rya19jdGxfY2FsYyhjcnRjX3N0YXRl
LCAmcGlwZV9jbGlwLCBmdWxsX3VwZGF0ZSk7CiAJcmV0dXJuIDA7CiB9Ci0tIAoyLjI1LjAKCl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBt
YWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3Rz
LmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeAo=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 49E4D63B0C
	for <lists+intel-gfx@lfdr.de>; Tue,  9 Jul 2019 20:35:11 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6E61589C80;
	Tue,  9 Jul 2019 18:35:09 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mail-wm1-x344.google.com (mail-wm1-x344.google.com
 [IPv6:2a00:1450:4864:20::344])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E4C7F89C80
 for <intel-gfx@lists.freedesktop.org>; Tue,  9 Jul 2019 18:35:07 +0000 (UTC)
Received: by mail-wm1-x344.google.com with SMTP id f17so4286604wme.2
 for <intel-gfx@lists.freedesktop.org>; Tue, 09 Jul 2019 11:35:07 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc:content-transfer-encoding;
 bh=vM1twDX72voXngCwmTy/7zYndMwdlKKq7EHhPeT/uXc=;
 b=JUnPRHebopw1SON64dzo2wcHeukS43jk9OOLP8RJudW1s68ra4FPvnRk9gZRsDudlo
 NvFXBsVy3b78OLMvmABXy3s3Z499pMMufa0WQNY44dNJWfaB8H4VzPh/XVEJAeJKUbFW
 +wkQT4i5Lst3rXjQp2GfZwNfrR14+hm7UDc3zoy+vRzqNrPgGnqtYWEdL55qy6juQt2t
 tg/Wp3q8S/CTqA/gajFMffuKWl2ELKxilgMjQPzKb3ZI4JMwiWyFhyGJwWztuZhUpH/Q
 qnr+AxcUs8jow6tX7vuEkXiKA80ARisXw7Nb0NbkaU8zTPPKY0ye4021Pdh0beZixKRF
 2gDQ==
X-Gm-Message-State: APjAAAWcBu1D8ADbpmKSoEuSiKT4PjcCrX6ksXe8tpZyGaVA2Hw6lUJt
 aYc6AZhSjQQo24jPZoljXNLpnQTMRC1YXTQgV5bYfQ==
X-Google-Smtp-Source: APXvYqweHiFdtx6xKI0MhxOCg0L/q2y4kr07ndJRYOTmH9b/VDXi/y38Lce/JA2TYQ+aHbeAhXOGw4Ues07nyUUXWlY=
X-Received: by 2002:a1c:e108:: with SMTP id y8mr1010144wmg.65.1562697306514;
 Tue, 09 Jul 2019 11:35:06 -0700 (PDT)
MIME-Version: 1.0
References: <20190218195052.1729-2-ville.syrjala@linux.intel.com>
 <20190517135101.6961-1-ville.syrjala@linux.intel.com>
In-Reply-To: <20190517135101.6961-1-ville.syrjala@linux.intel.com>
From: Mario Kleiner <mario.kleiner.de@gmail.com>
Date: Tue, 9 Jul 2019 20:34:54 +0200
Message-ID: <CAEsyxyjyNx9DZTP12t=rV5FCnGFVkRoYBV=0z6OPkUKX+J5j8g@mail.gmail.com>
To: Ville Syrjala <ville.syrjala@linux.intel.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc:content-transfer-encoding;
 bh=vM1twDX72voXngCwmTy/7zYndMwdlKKq7EHhPeT/uXc=;
 b=Z56YrTAtWyBW2Lc+tTEqAujgOIx+5/h5nr8Ao1P3JQCnQ1fr7hdBDxcc9MVWQX2bbu
 Nm3hypRZb0/2MnRHNQeOXl57/uhZlC+SV9pMjhkYFbl49pscFzk7K0vbz3VLgFuS24Nu
 esPMwfKo8Pm7aU5YkTWYQ7FquyZ+YUqfLSO/zUs4HaeE+JnInpF2jyg3pM+3RhWrYAgw
 emDPssLvSZw2knOX/6RjFuXWOHs2jOw7ObVcRuJTcDBjb0fb73a3QlNb6mqz3tepCJcg
 qdCv/SlCsOiGF89ch7Joyv3PmQ/d+9RlY8TVoyp3M6XuMeMkO7aqH0gCcUTgtIS9MNv9
 wXpg==
Subject: Re: [Intel-gfx] [PATCH xf86-video-intel v3 2/2] sna: Support 10bpc
 gamma via the GAMMA_LUT crtc property
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: intel-gfx <intel-gfx@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

SGkgVmlsbGUsCgpub3cgc29tZWJvZHkganVzdCBuZWVkcyB0byBtZXJnZSB0aGVzZSB0d28gMTAg
Yml0IGdhbW1hIGx1dCBwYXRjaGVzCmludG8gaW50ZWwtZGR4PwoKdGhhbmtzLAotbWFyaW8KCk9u
IEZyaSwgTWF5IDE3LCAyMDE5IGF0IDM6NTEgUE0gVmlsbGUgU3lyamFsYQo8dmlsbGUuc3lyamFs
YUBsaW51eC5pbnRlbC5jb20+IHdyb3RlOgo+Cj4gRnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxs
ZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KPgo+IFByb2JlIHRoZSBHQU1NQV9MVVQvR0FNTUFf
TFVUX1NJWkUgcHJvcHMgYW5kIHV0aWxpemUgdGhlbSB3aGVuCj4gdGhlIHJ1bm5pbmcgd2l0aCA+
IDhicGMuCj4KPiB2Mjogcy9zbmFfY3J0Y19pZC9fX3NuYV9jcnRjX2lkLyBpbiBEQkcgc2luY2Ug
d2UgaGF2ZSBhIHNuYV9jcnRjCj4gdjM6IEZpeCB0aGUgdmcgImJsdWVyZWQiIHR5cG8gKE1hcmlv
KQo+ICAgICBUaGlzIHRpbWUgSSBldmVuIGJ1aWxkIHRlc3RlZCB3aXRoIHZnIHN1cHBvcnQKPgo+
IENjOiBNYXJpbyBLbGVpbmVyIDxtYXJpby5rbGVpbmVyLmRlQGdtYWlsLmNvbT4KPiBTaWduZWQt
b2ZmLWJ5OiBWaWxsZSBTeXJqw6Rsw6QgPHZpbGxlLnN5cmphbGFAbGludXguaW50ZWwuY29tPgo+
IFJldmlld2VkLWFuZC10ZXN0ZWQtYnk6IE1hcmlvIEtsZWluZXIgPG1hcmlvLmtsZWluZXIuZGVA
Z21haWwuY29tPgo+IC0tLQo+ICBzcmMvc25hL3NuYV9kaXNwbGF5LmMgfCAyNDcgKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0tCj4gIDEgZmlsZSBjaGFuZ2VkLCAyMDgg
aW5zZXJ0aW9ucygrKSwgMzkgZGVsZXRpb25zKC0pCj4KPiBkaWZmIC0tZ2l0IGEvc3JjL3NuYS9z
bmFfZGlzcGxheS5jIGIvc3JjL3NuYS9zbmFfZGlzcGxheS5jCj4gaW5kZXggNDFlZGZlYzEyODM5
Li5kNjIxMGNjN2JiYzggMTAwNjQ0Cj4gLS0tIGEvc3JjL3NuYS9zbmFfZGlzcGxheS5jCj4gKysr
IGIvc3JjL3NuYS9zbmFfZGlzcGxheS5jCj4gQEAgLTEyNyw2ICsxMjcsNyBAQCBzdHJ1Y3QgbG9j
YWxfbW9kZV9vYmpfZ2V0X3Byb3BlcnRpZXMgewo+ICAgICAgICAgdWludDMyX3Qgb2JqX3R5cGU7
Cj4gICAgICAgICB1aW50MzJfdCBwYWQ7Cj4gIH07Cj4gKyNkZWZpbmUgTE9DQUxfTU9ERV9PQkpF
Q1RfQ1JUQyAweGNjY2NjY2NjCj4gICNkZWZpbmUgTE9DQUxfTU9ERV9PQkpFQ1RfUExBTkUgMHhl
ZWVlZWVlZQo+Cj4gIHN0cnVjdCBsb2NhbF9tb2RlX3NldF9wbGFuZSB7Cj4gQEAgLTIyOSw2ICsy
MzAsMTEgQEAgc3RydWN0IHNuYV9jcnRjIHsKPiAgICAgICAgIH0gcHJpbWFyeTsKPiAgICAgICAg
IHN0cnVjdCBsaXN0IHNwcml0ZXM7Cj4KPiArICAgICAgIHN0cnVjdCBkcm1fY29sb3JfbHV0ICpn
YW1tYV9sdXQ7Cj4gKyAgICAgICB1aW50NjRfdCBnYW1tYV9sdXRfcHJvcDsKPiArICAgICAgIHVp
bnQ2NF90IGdhbW1hX2x1dF9ibG9iOwo+ICsgICAgICAgdWludDMyX3QgZ2FtbWFfbHV0X3NpemU7
Cj4gKwo+ICAgICAgICAgdWludDMyX3QgbW9kZV9zZXJpYWwsIGZsaXBfc2VyaWFsOwo+Cj4gICAg
ICAgICB1aW50MzJfdCBsYXN0X3NlcSwgd3JhcF9zZXE7Cj4gQEAgLTMxNyw2ICszMjMsOSBAQCBz
dGF0aWMgdm9pZCBfX3NuYV9vdXRwdXRfZHBtcyh4Zjg2T3V0cHV0UHRyIG91dHB1dCwgaW50IGRw
bXMsIGludCBmaXh1cCk7Cj4gIHN0YXRpYyB2b2lkIHNuYV9jcnRjX2Rpc2FibGVfY3Vyc29yKHN0
cnVjdCBzbmEgKnNuYSwgc3RydWN0IHNuYV9jcnRjICpjcnRjKTsKPiAgc3RhdGljIGJvb2wgc25h
X2NydGNfZmxpcChzdHJ1Y3Qgc25hICpzbmEsIHN0cnVjdCBzbmFfY3J0YyAqY3J0YywKPiAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBrZ2VtX2JvICpibywgaW50IHgsIGludCB5KTsK
PiArc3RhdGljIHZvaWQgc25hX2NydGNfZ2FtbWFfc2V0KHhmODZDcnRjUHRyIGNydGMsCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIENBUkQxNiAqcmVkLCBDQVJEMTYgKmdyZWVuLAo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDQVJEMTYgKmJsdWUsIGludCBzaXplKTsK
Pgo+ICBzdGF0aWMgYm9vbCBpc196YXBob2QoU2NybkluZm9QdHIgc2NybikKPiAgewo+IEBAIC0z
MTUwLDExICszMTU5LDkgQEAgc25hX2NydGNfc2V0X21vZGVfbWFqb3IoeGY4NkNydGNQdHIgY3J0
YywgRGlzcGxheU1vZGVQdHIgbW9kZSwKPiAgICAgICAgICAgICAgICBtb2RlLT5WRGlzcGxheSA8
PSBzbmEtPm1vZGUubWF4X2NydGNfaGVpZ2h0KTsKPgo+ICAjaWYgSEFTX0dBTU1BCj4gLSAgICAg
ICBkcm1Nb2RlQ3J0Y1NldEdhbW1hKHNuYS0+a2dlbS5mZCwgX19zbmFfY3J0Y19pZChzbmFfY3J0
YyksCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgIGNydGMtPmdhbW1hX3NpemUsCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGNydGMtPmdhbW1hX3JlZCwKPiAtICAgICAgICAgICAg
ICAgICAgICAgICAgICAgY3J0Yy0+Z2FtbWFfZ3JlZW4sCj4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGNydGMtPmdhbW1hX2JsdWUpOwo+ICsgICAgICAgc25hX2NydGNfZ2FtbWFfc2V0KGNy
dGMsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgY3J0Yy0+Z2FtbWFfcmVkLCBjcnRjLT5n
YW1tYV9ncmVlbiwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICBjcnRjLT5nYW1tYV9ibHVl
LCBjcnRjLT5nYW1tYV9zaXplKTsKPiAgI2VuZGlmCj4KPiAgICAgICAgIHNhdmVkX2ttb2RlID0g
c25hX2NydGMtPmttb2RlOwo+IEBAIC0zMjEyLDEyICszMjE5LDQ0IEBAIHZvaWQgc25hX21vZGVf
YWRqdXN0X2ZyYW1lKHN0cnVjdCBzbmEgKnNuYSwgaW50IHgsIGludCB5KQo+Cj4gIHN0YXRpYyB2
b2lkCj4gIHNuYV9jcnRjX2dhbW1hX3NldCh4Zjg2Q3J0Y1B0ciBjcnRjLAo+IC0gICAgICAgICAg
ICAgICAgICAgICAgQ0FSRDE2ICpyZWQsIENBUkQxNiAqZ3JlZW4sIENBUkQxNiAqYmx1ZSwgaW50
IHNpemUpCj4gKyAgICAgICAgICAgICAgICAgIENBUkQxNiAqcmVkLCBDQVJEMTYgKmdyZWVuLCBD
QVJEMTYgKmJsdWUsIGludCBzaXplKQo+ICB7Cj4gLSAgICAgICBhc3NlcnQodG9fc25hX2NydGMo
Y3J0YykpOwo+IC0gICAgICAgZHJtTW9kZUNydGNTZXRHYW1tYSh0b19zbmEoY3J0Yy0+c2Nybikt
PmtnZW0uZmQsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgIHNuYV9jcnRjX2lkKGNydGMp
LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplLCByZWQsIGdyZWVuLCBibHVlKTsK
PiArICAgICAgIHN0cnVjdCBzbmEgKnNuYSA9IHRvX3NuYShjcnRjLT5zY3JuKTsKPiArICAgICAg
IHN0cnVjdCBzbmFfY3J0YyAqc25hX2NydGMgPSB0b19zbmFfY3J0YyhjcnRjKTsKPiArICAgICAg
IHN0cnVjdCBkcm1fY29sb3JfbHV0ICpsdXQgPSBzbmFfY3J0Yy0+Z2FtbWFfbHV0Owo+ICsgICAg
ICAgdWludDMyX3QgYmxvYl9zaXplID0gc2l6ZSAqIHNpemVvZihsdXRbMF0pOwo+ICsgICAgICAg
dWludDMyX3QgYmxvYl9pZDsKPiArICAgICAgIGludCByZXQsIGk7Cj4gKwo+ICsgICAgICAgREJH
KCgiJXM6IGdhbW1hX3NpemUgJWRcbiIsIF9fRlVOQ1RJT05fXywgc2l6ZSkpOwo+ICsKPiArICAg
ICAgIGlmICghbHV0KSB7Cj4gKyAgICAgICAgICAgICAgIGFzc2VydChzaXplID09IDI1Nik7Cj4g
Kwo+ICsgICAgICAgICAgICAgICBkcm1Nb2RlQ3J0Y1NldEdhbW1hKHRvX3NuYShjcnRjLT5zY3Ju
KS0+a2dlbS5mZCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbmFfY3J0
Y19pZChjcnRjKSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplLCBy
ZWQsIGdyZWVuLCBibHVlKTsKPiArICAgICAgICAgICAgICAgcmV0dXJuOwo+ICsgICAgICAgfQo+
ICsKPiArICAgICAgIGFzc2VydChzaXplID09IHNuYV9jcnRjLT5nYW1tYV9sdXRfc2l6ZSk7Cj4g
Kwo+ICsgICAgICAgZm9yIChpID0gMDsgaSA8IHNpemU7IGkrKykgewo+ICsgICAgICAgICAgICAg
ICBsdXRbaV0ucmVkID0gcmVkW2ldOwo+ICsgICAgICAgICAgICAgICBsdXRbaV0uZ3JlZW4gPSBn
cmVlbltpXTsKPiArICAgICAgICAgICAgICAgbHV0W2ldLmJsdWUgPSBibHVlW2ldOwo+ICsgICAg
ICAgfQo+ICsKPiArICAgICAgIHJldCA9IGRybU1vZGVDcmVhdGVQcm9wZXJ0eUJsb2Ioc25hLT5r
Z2VtLmZkLCBsdXQsIGJsb2Jfc2l6ZSwgJmJsb2JfaWQpOwo+ICsgICAgICAgaWYgKHJldCkKPiAr
ICAgICAgICAgICAgICAgcmV0dXJuOwo+ICsKPiArICAgICAgIHJldCA9IGRybU1vZGVPYmplY3RT
ZXRQcm9wZXJ0eShzbmEtPmtnZW0uZmQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgc25hX2NydGMtPmlkLCBEUk1fTU9ERV9PQkpFQ1RfQ1JUQywKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbmFfY3J0Yy0+Z2FtbWFfbHV0X3Byb3AsCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvYl9pZCk7Cj4gKwo+ICsg
ICAgICAgZHJtTW9kZURlc3Ryb3lQcm9wZXJ0eUJsb2Ioc25hLT5rZ2VtLmZkLCBibG9iX2lkKTsK
PiAgfQo+Cj4gIHN0YXRpYyB2b2lkCj4gQEAgLTMyMjksNiArMzI2OCw4IEBAIHNuYV9jcnRjX2Rl
c3Ryb3koeGY4NkNydGNQdHIgY3J0YykKPiAgICAgICAgIGlmIChzbmFfY3J0YyA9PSBOVUxMKQo+
ICAgICAgICAgICAgICAgICByZXR1cm47Cj4KPiArICAgICAgIGZyZWUoc25hX2NydGMtPmdhbW1h
X2x1dCk7Cj4gKwo+ICAgICAgICAgbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKHNwcml0ZSwgc24s
ICZzbmFfY3J0Yy0+c3ByaXRlcywgbGluaykKPiAgICAgICAgICAgICAgICAgZnJlZShzcHJpdGUp
Owo+Cj4gQEAgLTM2NjMsNiArMzcwNCw1NSBAQCBib29sIHNuYV9oYXNfc3ByaXRlX2Zvcm1hdChz
dHJ1Y3Qgc25hICpzbmEsIHVpbnQzMl90IGZvcm1hdCkKPiAgICAgICAgIHJldHVybiBmYWxzZTsK
PiAgfQo+Cj4gK2lubGluZSBzdGF0aWMgYm9vbCBwcm9wX2lzX2dhbW1hX2x1dChjb25zdCBzdHJ1
Y3QgZHJtX21vZGVfZ2V0X3Byb3BlcnR5ICpwcm9wKQo+ICt7Cj4gKyAgICAgICByZXR1cm4gcHJv
cF9oYXNfdHlwZV9hbmRfbmFtZShwcm9wLCA0LCAiR0FNTUFfTFVUIik7Cj4gK30KPiArCj4gK2lu
bGluZSBzdGF0aWMgYm9vbCBwcm9wX2lzX2dhbW1hX2x1dF9zaXplKGNvbnN0IHN0cnVjdCBkcm1f
bW9kZV9nZXRfcHJvcGVydHkgKnByb3ApCj4gK3sKPiArICAgICAgIHJldHVybiBwcm9wX2hhc190
eXBlX2FuZF9uYW1lKHByb3AsIDEsICJHQU1NQV9MVVRfU0laRSIpOwo+ICt9Cj4gKwo+ICtzdGF0
aWMgdm9pZCBzbmFfY3J0Y19wYXJzZV9wcm9wKHN0cnVjdCBzbmEgKnNuYSwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBkcm1fbW9kZV9nZXRfcHJvcGVydHkgKnByb3As
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50NjRfdCB2YWx1ZSwgdm9pZCAq
ZGF0YSkKPiArewo+ICsgICAgICAgc3RydWN0IHNuYV9jcnRjICpjcnRjID0gZGF0YTsKPiArCj4g
KyAgICAgICBpZiAocHJvcF9pc19nYW1tYV9sdXQocHJvcCkpIHsKPiArICAgICAgICAgICAgICAg
Y3J0Yy0+Z2FtbWFfbHV0X3Byb3AgPSBwcm9wLT5wcm9wX2lkOwo+ICsgICAgICAgICAgICAgICBj
cnRjLT5nYW1tYV9sdXRfYmxvYiA9IHZhbHVlOwo+ICsgICAgICAgfSBlbHNlIGlmIChwcm9wX2lz
X2dhbW1hX2x1dF9zaXplKHByb3ApKSB7Cj4gKyAgICAgICAgICAgICAgIGNydGMtPmdhbW1hX2x1
dF9zaXplID0gdmFsdWU7Cj4gKyAgICAgICB9Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkCj4gK3Nu
YV9jcnRjX2luaXRfX3Byb3BzKHN0cnVjdCBzbmEgKnNuYSwgc3RydWN0IHNuYV9jcnRjICpjcnRj
KQo+ICt7Cj4gKyAgICAgICBTY3JuSW5mb1B0ciBzY3JuID0gc25hLT5zY3JuOwo+ICsKPiArICAg
ICAgIHBhcnNlX3Byb3BzKHNuYSwgTE9DQUxfTU9ERV9PQkpFQ1RfQ1JUQywgY3J0Yy0+aWQsCj4g
KyAgICAgICAgICAgICAgICAgICBzbmFfY3J0Y19wYXJzZV9wcm9wLCBjcnRjKTsKPiArCj4gKyAg
ICAgICAvKiB1c2UgaGlnaCBwcmVjaXNpb24gZ2FtbWEgTFVUIGZvciA+IDhicGMgKi8KPiArICAg
ICAgIC8qIFgtU2VydmVyIDwgMS4yMCBtaXNoYW5kbGVzID4gMjU2IHNsb3RzIC8gPiA4IGJwYyBj
b2xvciBtYXBzLiAqLwo+ICsgICAgICAgaWYgKHNjcm4tPnJnYkJpdHMgPD0gOCB8fAo+ICsgICAg
ICAgICAgIFhPUkdfVkVSU0lPTl9DVVJSRU5UIDwgWE9SR19WRVJTSU9OX05VTUVSSUMoMSwyMCww
LDAsMCkpCj4gKyAgICAgICAgICAgICAgIGNydGMtPmdhbW1hX2x1dF9zaXplID0gMDsKPiArCj4g
KyAgICAgICBpZiAoY3J0Yy0+Z2FtbWFfbHV0X3NpemUpIHsKPiArICAgICAgICAgICAgICAgY3J0
Yy0+Z2FtbWFfbHV0ID0gY2FsbG9jKG1heChjcnRjLT5nYW1tYV9sdXRfc2l6ZSwgMjU2KSwKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVvZihjcnRjLT5nYW1t
YV9sdXRbMF0pKTsKPiArICAgICAgICAgICAgICAgaWYgKCFjcnRjLT5nYW1tYV9sdXQpCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgY3J0Yy0+Z2FtbWFfbHV0X3NpemUgPSAwOwo+ICsgICAgICAg
fQo+ICsKPiArICAgICAgIERCRygoIiVzOiBDUlRDOiVkLCBnYW1tYV9sdXRfc2l6ZT0lZFxuIiwg
X19GVU5DVElPTl9fLAo+ICsgICAgICAgICAgICBfX3NuYV9jcnRjX2lkKGNydGMpLCBjcnRjLT5n
YW1tYV9sdXRfc2l6ZSkpOwo+ICt9Cj4gKwo+ICBzdGF0aWMgdm9pZAo+ICBzbmFfY3J0Y19pbml0
X19yb3RhdGlvbihzdHJ1Y3Qgc25hICpzbmEsIHN0cnVjdCBzbmFfY3J0YyAqY3J0YykKPiAgewo+
IEBAIC0zNzIzLDYgKzM4MTMsOSBAQCBzbmFfY3J0Y19hZGQoU2NybkluZm9QdHIgc2NybiwgdW5z
aWduZWQgaWQpCj4KPiAgICAgICAgIGxpc3RfaW5pdCgmc25hX2NydGMtPnNwcml0ZXMpOwo+ICAg
ICAgICAgc25hX2NydGNfaW5pdF9fcm90YXRpb24oc25hLCBzbmFfY3J0Yyk7Cj4gKwo+ICsgICAg
ICAgc25hX2NydGNfaW5pdF9fcHJvcHMoc25hLCBzbmFfY3J0Yyk7Cj4gKwo+ICAgICAgICAgc25h
X2NydGNfZmluZF9wbGFuZXMoc25hLCBzbmFfY3J0Yyk7Cj4KPiAgICAgICAgIERCRygoIiVzOiBD
UlRDOiVkIFtwaXBlPSVkXSwgcHJpbWFyeSBpZD0leDogc3VwcG9ydGVkLXJvdGF0aW9ucz0leCwg
Y3VycmVudC1yb3RhdGlvbj0leFxuIiwKPiBAQCAtNzI3NCwzNiArNzM2NywxMTAgQEAgc3RhdGlj
IHZvaWQgb3V0cHV0X3NldF9nYW1tYSh4Zjg2T3V0cHV0UHRyIG91dHB1dCwgeGY4NkNydGNQdHIg
Y3J0YykKPiAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vbi0+bW9uX2dhbW1hX2JsdWUpOwo+
ICB9Cj4KPiArc3RhdGljIGJvb2wKPiArY3J0Y19nZXRfZ2FtbWFfbHV0KHhmODZDcnRjUHRyIGNy
dGMsCj4gKyAgICAgICAgICAgICAgICAgIENBUkQxNiAqcmVkLCBDQVJEMTYgKmdyZWVuLCBDQVJE
MTYgKmJsdWUsIGludCBzaXplKQo+ICt7Cj4gKwo+ICsgICAgICAgc3RydWN0IHNuYSAqc25hID0g
dG9fc25hKGNydGMtPnNjcm4pOwo+ICsgICAgICAgc3RydWN0IHNuYV9jcnRjICpzbmFfY3J0YyA9
IHRvX3NuYV9jcnRjKGNydGMpOwo+ICsgICAgICAgc3RydWN0IGRybV9jb2xvcl9sdXQgKmx1dCA9
IHNuYV9jcnRjLT5nYW1tYV9sdXQ7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX21vZGVfZ2V0X2Jsb2Ig
YmxvYjsKPiArICAgICAgIGludCBsdXRfc2l6ZSwgaTsKPiArCj4gKyAgICAgICBEQkcoKCIlczog
Z2FtbWFfc2l6ZSAlZFxuIiwgX19GVU5DVElPTl9fLCBzaXplKSk7Cj4gKwo+ICsgICAgICAgbWVt
c2V0KCZibG9iLCAwLCBzaXplb2YoYmxvYikpOwo+ICsgICAgICAgYmxvYi5ibG9iX2lkID0gc25h
X2NydGMtPmdhbW1hX2x1dF9ibG9iOwo+ICsKPiArICAgICAgIGlmIChkcm1Jb2N0bChzbmEtPmtn
ZW0uZmQsIERSTV9JT0NUTF9NT0RFX0dFVFBST1BCTE9CLCAmYmxvYikpCj4gKyAgICAgICAgICAg
ICAgIHJldHVybiBmYWxzZTsKPiArCj4gKyAgICAgICBsdXRfc2l6ZSA9IGJsb2IubGVuZ3RoIC8g
c2l6ZW9mKGx1dFswXSk7Cj4gKwo+ICsgICAgICAgaWYgKGx1dF9zaXplID09IDAgfHwKPiArICAg
ICAgICAgICBsdXRfc2l6ZSA+IG1heChzbmFfY3J0Yy0+Z2FtbWFfbHV0X3NpemUsIDI1NikpCj4g
KyAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKPiArCj4gKyAgICAgICBibG9iLmRhdGEgPSAo
dWludHB0cl90KWx1dDsKPiArCj4gKyAgICAgICBpZiAoZHJtSW9jdGwoc25hLT5rZ2VtLmZkLCBE
Uk1fSU9DVExfTU9ERV9HRVRQUk9QQkxPQiwgJmJsb2IpKQo+ICsgICAgICAgICAgICAgICByZXR1
cm4gZmFsc2U7Cj4gKwo+ICsgICAgICAgZm9yIChpID0gMDsgaSA8IHNpemU7IGkrKykgewo+ICsg
ICAgICAgICAgICAgICBzdHJ1Y3QgZHJtX2NvbG9yX2x1dCAqZW50cnkgPQo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICZsdXRbaSAqIChsdXRfc2l6ZSAtIDEpIC8gKHNpemUgLSAxKV07Cj4gKwo+
ICsgICAgICAgICAgICAgICByZWRbaV0gPSBlbnRyeS0+cmVkOwo+ICsgICAgICAgICAgICAgICBn
cmVlbltpXSA9IGVudHJ5LT5ncmVlbjsKPiArICAgICAgICAgICAgICAgYmx1ZVtpXSA9IGVudHJ5
LT5ibHVlOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIHJldHVybiByZWRbc2l6ZSAtIDFdICYm
Cj4gKyAgICAgICAgICAgICAgIGdyZWVuW3NpemUgLSAxXSAmJgo+ICsgICAgICAgICAgICAgICBi
bHVlW3NpemUgLSAxXTsKPiArfQo+ICsKPiArc3RhdGljIGJvb2wgY3J0Y19nZXRfZ2FtbWFfbGVn
YWN5KHhmODZDcnRjUHRyIGNydGMsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IENBUkQxNiAqcmVkLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDQVJEMTYg
KmdyZWVuLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDQVJEMTYgKmJsdWUs
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBzaXplKQo+ICt7Cj4gKyAg
ICAgICBzdHJ1Y3Qgc25hICpzbmEgPSB0b19zbmEoY3J0Yy0+c2Nybik7Cj4gKyAgICAgICBzdHJ1
Y3Qgc25hX2NydGMgKnNuYV9jcnRjID0gdG9fc25hX2NydGMoY3J0Yyk7Cj4gKyAgICAgICBzdHJ1
Y3QgZHJtX21vZGVfY3J0Y19sdXQgbHV0ID0gewo+ICsgICAgICAgICAgICAgICAuY3J0Y19pZCA9
IF9fc25hX2NydGNfaWQoc25hX2NydGMpLAo+ICsgICAgICAgICAgICAgICAuZ2FtbWFfc2l6ZSA9
IHNpemUsCj4gKyAgICAgICAgICAgICAgIC5yZWQgPSAodWludHB0cl90KXJlZCwKPiArICAgICAg
ICAgICAgICAgLmdyZWVuID0gKHVpbnRwdHJfdClncmVlbiwKPiArICAgICAgICAgICAgICAgLmJs
dWUgPSAodWludHB0cl90KWJsdWUsCj4gKyAgICAgICB9Owo+ICsKPiArICAgICAgIGlmIChkcm1J
b2N0bChzbmEtPmtnZW0uZmQsIERSTV9JT0NUTF9NT0RFX0dFVEdBTU1BLCAmbHV0KSAhPSAwKQo+
ICsgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7Cj4gKwo+ICsgICAgICAgVkcoVkFMR1JJTkRf
TUFLRV9NRU1fREVGSU5FRChyZWQsIHNpemUqc2l6ZW9mKHJlZFswXSkpKTsKPiArICAgICAgIFZH
KFZBTEdSSU5EX01BS0VfTUVNX0RFRklORUQoZ3JlZW4sIHNpemUqc2l6ZW9mKGdyZWVuWzBdKSkp
Owo+ICsgICAgICAgVkcoVkFMR1JJTkRfTUFLRV9NRU1fREVGSU5FRChibHVlLCBzaXplKnNpemVv
ZihibHVlWzBdKSkpOwo+ICsKPiArICAgICAgIHJldHVybiByZWRbc2l6ZSAtIDFdICYmCj4gKyAg
ICAgICAgICAgICAgIGdyZWVuW3NpemUgLSAxXSAmJgo+ICsgICAgICAgICAgICAgICBibHVlW3Np
emUgLSAxXTsKPiArfQo+ICsKPiAgc3RhdGljIHZvaWQgY3J0Y19pbml0X2dhbW1hKHhmODZDcnRj
UHRyIGNydGMpCj4gIHsKPiArICAgICAgIHN0cnVjdCBzbmEgKnNuYSA9IHRvX3NuYShjcnRjLT5z
Y3JuKTsKPiArICAgICAgIHN0cnVjdCBzbmFfY3J0YyAqc25hX2NydGMgPSB0b19zbmFfY3J0Yyhj
cnRjKTsKPiAgICAgICAgIHVpbnQxNl90ICpnYW1tYTsKPiArICAgICAgIGludCBzaXplOwo+ICsK
PiArICAgICAgIGFzc2VydChzbmFfY3J0Yyk7Cj4gKwo+ICsgICAgICAgc2l6ZSA9IHNuYV9jcnRj
LT5nYW1tYV9sdXRfc2l6ZTsKPiArICAgICAgIGlmICghc2l6ZSkKPiArICAgICAgICAgICAgICAg
c2l6ZSA9IDI1NjsKPgo+ICAgICAgICAgLyogSW5pdGlhbGl6ZSB0aGUgZ2FtbWEgcmFtcHMgKi8K
PiAgICAgICAgIGdhbW1hID0gTlVMTDsKPiAtICAgICAgIGlmIChjcnRjLT5nYW1tYV9zaXplID09
IDI1NikKPiArICAgICAgIGlmIChjcnRjLT5nYW1tYV9zaXplID09IHNpemUpCj4gICAgICAgICAg
ICAgICAgIGdhbW1hID0gY3J0Yy0+Z2FtbWFfcmVkOwo+ICAgICAgICAgaWYgKGdhbW1hID09IE5V
TEwpCj4gLSAgICAgICAgICAgICAgIGdhbW1hID0gbWFsbG9jKDMgKiAyNTYgKiBzaXplb2YodWlu
dDE2X3QpKTsKPiArICAgICAgICAgICAgICAgZ2FtbWEgPSBtYWxsb2MoMyAqIHNpemUgKiBzaXpl
b2YodWludDE2X3QpKTsKPiAgICAgICAgIGlmIChnYW1tYSkgewo+IC0gICAgICAgICAgICAgICBz
dHJ1Y3Qgc25hICpzbmEgPSB0b19zbmEoY3J0Yy0+c2Nybik7Cj4gLSAgICAgICAgICAgICAgIHN0
cnVjdCBzbmFfY3J0YyAqc25hX2NydGMgPSB0b19zbmFfY3J0YyhjcnRjKTsKPiAgICAgICAgICAg
ICAgICAgc3RydWN0IGRybV9tb2RlX2NydGNfbHV0IGx1dDsKPiAtICAgICAgICAgICAgICAgYm9v
bCBnYW1tYV9zZXQgPSBmYWxzZTsKPiAtCj4gLSAgICAgICAgICAgICAgIGFzc2VydChzbmFfY3J0
Yyk7Cj4gLQo+IC0gICAgICAgICAgICAgICBsdXQuY3J0Y19pZCA9IF9fc25hX2NydGNfaWQoc25h
X2NydGMpOwo+IC0gICAgICAgICAgICAgICBsdXQuZ2FtbWFfc2l6ZSA9IDI1NjsKPiAtICAgICAg
ICAgICAgICAgbHV0LnJlZCA9ICh1aW50cHRyX3QpKGdhbW1hKTsKPiAtICAgICAgICAgICAgICAg
bHV0LmdyZWVuID0gKHVpbnRwdHJfdCkoZ2FtbWEgKyAyNTYpOwo+IC0gICAgICAgICAgICAgICBs
dXQuYmx1ZSA9ICh1aW50cHRyX3QpKGdhbW1hICsgMiAqIDI1Nik7Cj4gLSAgICAgICAgICAgICAg
IGlmIChkcm1Jb2N0bChzbmEtPmtnZW0uZmQsIERSTV9JT0NUTF9NT0RFX0dFVEdBTU1BLCAmbHV0
KSA9PSAwKSB7Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgVkcoVkFMR1JJTkRfTUFLRV9NRU1f
REVGSU5FRChnYW1tYSwgMyoyNTYqc2l6ZW9mKGdhbW1hWzBdKSkpOwo+IC0gICAgICAgICAgICAg
ICAgICAgICAgIGdhbW1hX3NldCA9Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBn
YW1tYVsyNTYgLSAxXSAmJgo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtbWFb
MioyNTYgLSAxXSAmJgo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtbWFbMyoy
NTYgLSAxXTsKPiAtICAgICAgICAgICAgICAgfQo+ICsgICAgICAgICAgICAgICBib29sIGdhbW1h
X3NldDsKPiArICAgICAgICAgICAgICAgdWludDE2X3QgKnJlZCA9IGdhbW1hOwo+ICsgICAgICAg
ICAgICAgICB1aW50MTZfdCAqZ3JlZW4gPSBnYW1tYSArIHNpemU7Cj4gKyAgICAgICAgICAgICAg
IHVpbnQxNl90ICpibHVlID0gZ2FtbWEgKyAyICogc2l6ZTsKPiArCj4gKyAgICAgICAgICAgICAg
IGlmIChzbmFfY3J0Yy0+Z2FtbWFfbHV0X3NpemUpCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
Z2FtbWFfc2V0ID0gY3J0Y19nZXRfZ2FtbWFfbHV0KGNydGMsIHJlZCwKPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JlZW4sIGJsdWUsIHNp
emUpOwo+ICsgICAgICAgICAgICAgICBlbHNlCj4gKyAgICAgICAgICAgICAgICAgICAgICAgZ2Ft
bWFfc2V0ID0gY3J0Y19nZXRfZ2FtbWFfbGVnYWN5KGNydGMsIHJlZCwKPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JlZW4sIGJsdWUs
IHNpemUpOwo+Cj4gICAgICAgICAgICAgICAgIERCRygoIiVzOiBDUlRDOiVkLCBwaXBlPSVkOiBn
YW1tYSBzZXQ/PSVkXG4iLAo+ICAgICAgICAgICAgICAgICAgICAgIF9fRlVOQ1RJT05fXywgX19z
bmFfY3J0Y19pZChzbmFfY3J0YyksIF9fc25hX2NydGNfcGlwZShzbmFfY3J0YyksCj4gQEAgLTcz
MTEsMTkgKzc0NzgsMjEgQEAgc3RhdGljIHZvaWQgY3J0Y19pbml0X2dhbW1hKHhmODZDcnRjUHRy
IGNydGMpCj4gICAgICAgICAgICAgICAgIGlmICghZ2FtbWFfc2V0KSB7Cj4gICAgICAgICAgICAg
ICAgICAgICAgICAgaW50IGk7Cj4KPiAtICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAw
OyBpIDwgMjU2OyBpKyspIHsKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbW1h
W2ldID0gaSA8PCA4Owo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtbWFbMjU2
ICsgaV0gPSBpIDw8IDg7Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1tYVsy
KjI1NiArIGldID0gaSA8PCA4Owo+ICsgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7
IGkgPCBzaXplOyBpKyspIHsKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQx
Nl90IHZhbCA9IGkgKiAweGZmZmYgLyAoc2l6ZSAtIDEpOwo+ICsKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHJlZFtpXSA9IHZhbDsKPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGdyZWVuW2ldID0gdmFsOwo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Ymx1ZVtpXSA9IHZhbDsKPiAgICAgICAgICAgICAgICAgICAgICAgICB9Cj4gICAgICAgICAgICAg
ICAgIH0KPgo+IC0gICAgICAgICAgICAgICBpZiAoZ2FtbWEgIT0gY3J0Yy0+Z2FtbWFfcmVkKSB7
Cj4gKyAgICAgICAgICAgICAgIGlmIChyZWQgIT0gY3J0Yy0+Z2FtbWFfcmVkKSB7Cj4gICAgICAg
ICAgICAgICAgICAgICAgICAgZnJlZShjcnRjLT5nYW1tYV9yZWQpOwo+IC0gICAgICAgICAgICAg
ICAgICAgICAgIGNydGMtPmdhbW1hX3JlZCA9IGdhbW1hOwo+IC0gICAgICAgICAgICAgICAgICAg
ICAgIGNydGMtPmdhbW1hX2dyZWVuID0gZ2FtbWEgKyAyNTY7Cj4gLSAgICAgICAgICAgICAgICAg
ICAgICAgY3J0Yy0+Z2FtbWFfYmx1ZSA9IGdhbW1hICsgMioyNTY7Cj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgY3J0Yy0+Z2FtbWFfc2l6ZSA9IDI1NjsKPiArICAgICAgICAgICAgICAgICAgICAg
ICBjcnRjLT5nYW1tYV9yZWQgPSByZWQ7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgY3J0Yy0+
Z2FtbWFfZ3JlZW4gPSBncmVlbjsKPiArICAgICAgICAgICAgICAgICAgICAgICBjcnRjLT5nYW1t
YV9ibHVlID0gYmx1ZTsKPiArICAgICAgICAgICAgICAgICAgICAgICBjcnRjLT5nYW1tYV9zaXpl
ID0gc2l6ZTsKPiAgICAgICAgICAgICAgICAgfQo+ICAgICAgICAgfQo+ICB9Cj4gLS0KPiAyLjIx
LjAKPgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRl
bC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6
Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

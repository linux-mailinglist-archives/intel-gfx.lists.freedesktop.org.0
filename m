Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id F0AF5788AE
	for <lists+intel-gfx@lfdr.de>; Mon, 29 Jul 2019 11:43:37 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B00AE89BF5;
	Mon, 29 Jul 2019 09:43:35 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga01.intel.com (mga01.intel.com [192.55.52.88])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9C53089BF5
 for <intel-gfx@lists.freedesktop.org>; Mon, 29 Jul 2019 09:43:34 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga005.jf.intel.com ([10.7.209.41])
 by fmsmga101.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 29 Jul 2019 02:43:34 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,322,1559545200"; d="scan'208";a="346545294"
Received: from hinestho-mobl1.amr.corp.intel.com (HELO [10.252.1.47])
 ([10.252.1.47])
 by orsmga005.jf.intel.com with ESMTP; 29 Jul 2019 02:43:32 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20190725131447.27515-1-chris@chris-wilson.co.uk>
 <20190725131447.27515-2-chris@chris-wilson.co.uk>
 <61bdd86d-6465-bcf3-5574-013a7096b73a@linux.intel.com>
 <156439044497.6902.14013218874564584104@skylake-alporthouse-com>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <5142d90b-502b-6ba9-49fe-2961433019ca@linux.intel.com>
Date: Mon, 29 Jul 2019 10:43:31 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <156439044497.6902.14013218874564584104@skylake-alporthouse-com>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH 2/2] drm/i915: Unshare the idle-barrier from
 other kernel requests
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDI5LzA3LzIwMTkgMDk6NTQsIENocmlzIFdpbHNvbiB3cm90ZToKPiBRdW90aW5nIFR2cnRr
byBVcnN1bGluICgyMDE5LTA3LTI5IDA4OjQ2OjU5KQo+Pgo+PiBPbiAyNS8wNy8yMDE5IDE0OjE0
LCBDaHJpcyBXaWxzb24gd3JvdGU6Cj4+PiArc3RhdGljIGludCBfX2xpdmVfcmVtb3RlX2NvbnRl
eHQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAo+Pj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpmaXhtZSkKPj4+ICt7Cj4+PiAr
ICAgICBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqbG9jYWwsICpyZW1vdGU7Cj4+PiArICAgICBzdHJ1
Y3QgaTkxNV9yZXF1ZXN0ICpycTsKPj4+ICsgICAgIGludCBwYXNzOwo+Pj4gKyAgICAgaW50IGVy
cjsKPj4+ICsKPj4+ICsgICAgIC8qCj4+PiArICAgICAgKiBDaGVjayB0aGF0IG91ciBpZGxlIGJh
cnJpZXJzIGRvIG5vdCBpbnRlcmZlcmUgd2l0aCBub3JtYWwKPj4+ICsgICAgICAqIGFjdGl2aXR5
IHRyYWNraW5nLiBJbiBwYXJ0aWN1bGFyLCBjaGVjayB0aGF0IG9wZXJhdGluZwo+Pj4gKyAgICAg
ICogb24gdGhlIGNvbnRleHQgaW1hZ2UgcmVtb3RlbHkgKGludGVsX2NvbnRleHRfcHJlcGFyZV9y
ZW1vdGVfcmVxdWVzdCkKPj4+ICsgICAgICAqIHdoaWNoIGluc2VydHMgZm9yaWVnbiBmZW5jZXMg
aW50byBpbnRlbF9jb250ZXh0LmFjdGl2ZSBhcmUgbm90Cj4+Cj4+IHR5cG8gaW4gZm9yZWlnbgo+
Pgo+PiAib3BlcmF0aW5nIC4uLiBhcmUgbm90IC4uIiA/IEZvcmVpZ24gZmVuY2VzIGFyZSBub3Qg
Y2xvYmJlcmVkPwo+IAo+ICwgZG9lcyBub3QgY2xvYmJlciB0aGUgYWN0aXZlIHRyYWNraW5nLgo+
IAo+Pgo+Pj4gKyAgICAgICogY2xvYmJlcmVkLgo+Pj4gKyAgICAgICovCj4+PiArCj4+PiArICAg
ICByZW1vdGUgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZShmaXhtZSwgZW5naW5lKTsKPj4+ICsgICAg
IGlmICghcmVtb3RlKQo+Pj4gKyAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKPj4+ICsKPj4+
ICsgICAgIGxvY2FsID0gaW50ZWxfY29udGV4dF9jcmVhdGUoZml4bWUsIGVuZ2luZSk7Cj4+PiAr
ICAgICBpZiAoIWxvY2FsKSB7Cj4+PiArICAgICAgICAgICAgIGVyciA9IC1FTk9NRU07Cj4+PiAr
ICAgICAgICAgICAgIGdvdG8gZXJyX3JlbW90ZTsKPj4+ICsgICAgIH0KPj4+ICsKPj4+ICsgICAg
IGZvciAocGFzcyA9IDA7IHBhc3MgPD0gMjsgcGFzcysrKSB7Cj4+PiArICAgICAgICAgICAgIGVy
ciA9IGludGVsX2NvbnRleHRfcGluKHJlbW90ZSk7Cj4+PiArICAgICAgICAgICAgIGlmIChlcnIp
Cj4+PiArICAgICAgICAgICAgICAgICAgICAgZ290byBlcnJfbG9jYWw7Cj4+PiArCj4+PiArICAg
ICAgICAgICAgIHJxID0gaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVzdChsb2NhbCk7Cj4+PiAr
ICAgICAgICAgICAgIGlmIChJU19FUlIocnEpKSB7Cj4+PiArICAgICAgICAgICAgICAgICAgICAg
ZXJyID0gUFRSX0VSUihycSk7Cj4+PiArICAgICAgICAgICAgICAgICAgICAgZ290byBlcnJfdW5w
aW47Cj4+PiArICAgICAgICAgICAgIH0KPj4+ICsKPj4+ICsgICAgICAgICAgICAgZXJyID0gaW50
ZWxfY29udGV4dF9wcmVwYXJlX3JlbW90ZV9yZXF1ZXN0KHJlbW90ZSwgcnEpOwo+Pj4gKyAgICAg
ICAgICAgICBpZiAoZXJyKSB7Cj4+PiArICAgICAgICAgICAgICAgICAgICAgaTkxNV9yZXF1ZXN0
X2FkZChycSk7Cj4+PiArICAgICAgICAgICAgICAgICAgICAgZ290byBlcnJfdW5waW47Cj4+PiAr
ICAgICAgICAgICAgIH0KPj4+ICsKPj4+ICsgICAgICAgICAgICAgZXJyID0gcmVxdWVzdF9zeW5j
KHJxKTsKPj4+ICsgICAgICAgICAgICAgaWYgKGVycikKPj4+ICsgICAgICAgICAgICAgICAgICAg
ICBnb3RvIGVycl91bnBpbjsKPj4+ICsKPj4+ICsgICAgICAgICAgICAgaW50ZWxfY29udGV4dF91
bnBpbihyZW1vdGUpOwo+Pj4gKyAgICAgICAgICAgICBlcnIgPSBpbnRlbF9jb250ZXh0X3Bpbihy
ZW1vdGUpOwo+Pgo+PiB1bnBpbi1waW4gaXMgdG8gdHJpZ2dlciB0cmFuc2ZlciBvZiBpZGxlIGJh
cnJpZXJzIGFuZCBtYXliZSB0cmlnZ2VyIHNvbWUKPj4gYXNzZXJ0cz8KPiAKPiB1bnBpbiBpcyB0
byB0cmlnZ2VyIHRoZSBpZGxlLWJhcnJpZXIuIFRoZSBwaW4gaXMganVzdCB0aGUgc3RhcnQgb2Yg
dGhlCj4gbmV4dCBwaGFzZSB3aXRoIGFub3RoZXIgY29udGV4dC4gQXQgZmlyc3QgSSB0cmllZCBk
b2luZyB0d28gcmVtb3RlCj4gcmVxdWVzdHMgd2l0aGluIG9uIHBpbi1waGFzZSwgYnV0IHRoYXQg
ZG9lc24ndCBoaXQgdGhlIGJ1Zy4gSXQgbmVlZGVkCj4gdGhlIGlkbGUgYmFycmllciBpbiB0aGUg
bWlkZGxlIG9mIHRoZSB0ZXN0LCBub3QgYmV0d2VlbiBwYXNzZXMuCj4gCj4gdjIgd3JhcHBlZCBp
dCB3aXRoIGFub3RoZXIgc3Vicm91dGluZSBzbyB0aGUgdW5waW4tcGluIGlzIG5vdCBzbwo+IGds
YXJpbmdseSBvYnZpb3VzLgoKdioyKj8gOkQgSGFyZCB0byBrbm93IHdpdGhvdXQgcmV2aXNpb25p
bmcgYW5kIG11bHRpcGxlIHNlbmRzLi4uIEkndmUgCmZvdW5kIGl0IG5vdywgSSd2ZSBiZWVuIGxv
b2tpbmcgYXQgYSB2ZXJ5IGRpZmZlcmVudCB2ZXJzaW9uIGhlcmUuCgo+IAo+Pj4gKyAgICAgICAg
ICAgICBpZiAoZXJyKQo+Pj4gKyAgICAgICAgICAgICAgICAgICAgIGdvdG8gZXJyX2xvY2FsOwo+
Pj4gKwo+Pj4gKyAgICAgICAgICAgICBycSA9IGk5MTVfcmVxdWVzdF9jcmVhdGUoZW5naW5lLT5r
ZXJuZWxfY29udGV4dCk7Cj4+Cj4+IFdoeSBhIHJlcXVlc3Qgb24ga2VybmVsIGNvbnRleHQgaGVy
ZSwgYSB0aGlyZCBjb250ZXh0Pwo+IAo+IFRoZSBrZXJuZWxfY29udGV4dCBpcyBtb3N0IGltcG9y
dGFudCBzaW5jZSB0aGF0J3MgdGhlIG9uZSB1c2VkIGJ5IHRoZQo+IGlkbGUgYmFycmllci4gSSBp
bmNsdWRlZCB0aGUgbm9ybWFsIGNvbnRleHQgYXMgd2VsbCBmb3IgY29tcGxldGVuZXNzIGFzCj4g
dGhlIGludGVsX2NvbnRleHRfcHJlcGFyZV9yZW1vdGVfcmVxdWVzdCgpIGludGVyZmFjZSBzaG91
bGQgbm90IGFzc3VtZQo+IGl0IGlzIHdvcmtpbmcgZnJvbSB0aGUga2VybmVsIGNvbnRleHQuCgpN
b3N0IGltcG9ydGFudCA9IHdvcnRoeSBvZiBhIGNvbW1lbnQ/IDspCgo+IAo+Pj4gKyAgICAgICAg
ICAgICBpZiAoSVNfRVJSKHJxKSkgewo+Pj4gKyAgICAgICAgICAgICAgICAgICAgIGVyciA9IFBU
Ul9FUlIocnEpOwo+Pj4gKyAgICAgICAgICAgICAgICAgICAgIGdvdG8gZXJyX3VucGluOwo+Pj4g
KyAgICAgICAgICAgICB9Cj4+PiArCj4+PiArICAgICAgICAgICAgIGVyciA9IGludGVsX2NvbnRl
eHRfcHJlcGFyZV9yZW1vdGVfcmVxdWVzdChyZW1vdGUsIHJxKTsKPj4+ICsgICAgICAgICAgICAg
aWYgKGVycikgewo+Pj4gKyAgICAgICAgICAgICAgICAgICAgIGk5MTVfcmVxdWVzdF9hZGQocnEp
Owo+Pj4gKyAgICAgICAgICAgICAgICAgICAgIGdvdG8gZXJyX3VucGluOwo+Pj4gKyAgICAgICAg
ICAgICB9Cj4+PiArCj4+PiArICAgICAgICAgICAgIGVyciA9IHJlcXVlc3Rfc3luYyhycSk7Cj4+
PiArICAgICAgICAgICAgIGlmIChlcnIpCj4+PiArICAgICAgICAgICAgICAgICAgICAgZ290byBl
cnJfdW5waW47Cj4+PiArCj4+PiArICAgICAgICAgICAgIGludGVsX2NvbnRleHRfdW5waW4ocmVt
b3RlKTsKPj4+ICsKPj4+ICsgICAgICAgICAgICAgaWYgKGk5MTVfYWN0aXZlX2lzX2lkbGUoJnJl
bW90ZS0+YWN0aXZlKSkgewo+Pj4gKyAgICAgICAgICAgICAgICAgICAgIHByX2VycigicmVtb3Rl
IGNvbnRleHQgaXMgbm90IGFjdGl2ZTsgZXhwZWN0ZWQgaWRsZS1iYXJyaWVyIChwYXNzICVkKVxu
IiwgcGFzcyk7Cj4+PiArICAgICAgICAgICAgICAgICAgICAgZXJyID0gLUVJTlZBTDsKPj4+ICsg
ICAgICAgICAgICAgICAgICAgICBnb3RvIGVycl9sb2NhbDsKPj4+ICsgICAgICAgICAgICAgfQo+
Pj4gKyAgICAgfQo+Pj4gKwo+Pj4gKyAgICAgZ290byBlcnJfbG9jYWw7Cj4+PiArCj4+PiArZXJy
X3VucGluOgo+Pj4gKyAgICAgaW50ZWxfY29udGV4dF91bnBpbihyZW1vdGUpOwo+Pj4gK2Vycl9s
b2NhbDoKPj4+ICsgICAgIGludGVsX2NvbnRleHRfcHV0KGxvY2FsKTsKPj4+ICtlcnJfcmVtb3Rl
Ogo+Pj4gKyAgICAgaW50ZWxfY29udGV4dF9wdXQocmVtb3RlKTsKPj4+ICsgICAgIHJldHVybiBl
cnI7Cj4+PiArfQo+Pj4gKwo+Pj4gK3N0YXRpYyBpbnQgbGl2ZV9yZW1vdGVfY29udGV4dCh2b2lk
ICphcmcpCj4+PiArewo+Pj4gKyAgICAgc3RydWN0IGludGVsX2d0ICpndCA9IGFyZzsKPj4+ICsg
ICAgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKPj4+ICsgICAgIHN0cnVjdCBpOTE1
X2dlbV9jb250ZXh0ICpmaXhtZTsKPj4+ICsgICAgIGVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwo+
Pj4gKyAgICAgc3RydWN0IGRybV9maWxlICpmaWxlOwo+Pj4gKyAgICAgaW50IGVyciA9IDA7Cj4+
PiArCj4+PiArICAgICBmaWxlID0gbW9ja19maWxlKGd0LT5pOTE1KTsKPj4+ICsgICAgIGlmIChJ
U19FUlIoZmlsZSkpCj4+PiArICAgICAgICAgICAgIHJldHVybiBQVFJfRVJSKGZpbGUpOwo+Pj4g
Kwo+Pj4gKyAgICAgbXV0ZXhfbG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+Pj4g
Kwo+Pj4gKyAgICAgZml4bWUgPSBsaXZlX2NvbnRleHQoZ3QtPmk5MTUsIGZpbGUpOwo+Pj4gKyAg
ICAgaWYgKCFmaXhtZSkgewo+Pj4gKyAgICAgICAgICAgICBlcnIgPSAtRU5PTUVNOwo+Pj4gKyAg
ICAgICAgICAgICBnb3RvIHVubG9jazsKPj4+ICsgICAgIH0KPj4+ICsKPj4+ICsgICAgIGZvcl9l
YWNoX2VuZ2luZShlbmdpbmUsIGd0LT5pOTE1LCBpZCkgewo+Pj4gKyAgICAgICAgICAgICBlcnIg
PSBfX2xpdmVfcmVtb3RlX2NvbnRleHQoZW5naW5lLCBmaXhtZSk7Cj4+PiArICAgICAgICAgICAg
IGlmIChlcnIpCj4+PiArICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Cj4+PiArCj4+PiArICAg
ICAgICAgICAgIGVyciA9IGlndF9mbHVzaF90ZXN0KGd0LT5pOTE1LCBJOTE1X1dBSVRfTE9DS0VE
KTsKPj4+ICsgICAgICAgICAgICAgaWYgKGVycikKPj4+ICsgICAgICAgICAgICAgICAgICAgICBi
cmVhazsKPj4+ICsgICAgIH0KPj4+ICsKPj4+ICt1bmxvY2s6Cj4+PiArICAgICBtdXRleF91bmxv
Y2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPj4+ICsgICAgIG1vY2tfZmlsZV9mcmVl
KGd0LT5pOTE1LCBmaWxlKTsKPj4+ICsgICAgIHJldHVybiBlcnI7Cj4+PiArfQo+Pj4gKwo+Pj4g
K2ludCBpbnRlbF9jb250ZXh0X2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQo+Pj4gK3sKPj4+ICsgICAgIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9zdWJ0ZXN0
IHRlc3RzW10gPSB7Cj4+PiArICAgICAgICAgICAgIFNVQlRFU1QobGl2ZV9hY3RpdmVfY29udGV4
dCksCj4+PiArICAgICAgICAgICAgIFNVQlRFU1QobGl2ZV9yZW1vdGVfY29udGV4dCksCj4+PiAr
ICAgICB9Owo+Pj4gKyAgICAgc3RydWN0IGludGVsX2d0ICpndCA9ICZpOTE1LT5ndDsKPj4+ICsK
Pj4+ICsgICAgIGlmIChpbnRlbF9ndF9pc193ZWRnZWQoZ3QpKQo+Pj4gKyAgICAgICAgICAgICBy
ZXR1cm4gMDsKPj4+ICsKPj4+ICsgICAgIHJldHVybiBpbnRlbF9ndF9saXZlX3N1YnRlc3RzKHRl
c3RzLCBndCk7Cj4+PiArfQo+Pj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfYWN0aXZlLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5jCj4+PiBpbmRl
eCAxM2YzMDRhMjlmYzguLmUwNGFmYjUxOTI2NCAxMDA2NDQKPj4+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMKPj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfYWN0aXZlLmMKPj4+IEBAIC0xODQsNiArMTg0LDcgQEAgYWN0aXZlX2luc3RhbmNlKHN0cnVj
dCBpOTE1X2FjdGl2ZSAqcmVmLCB1NjQgaWR4KQo+Pj4gICAgICAgIHJlZi0+Y2FjaGUgPSBub2Rl
Owo+Pj4gICAgICAgIG11dGV4X3VubG9jaygmcmVmLT5tdXRleCk7Cj4+PiAgICAKPj4+ICsgICAg
IEJVSUxEX0JVR19PTihvZmZzZXRvZih0eXBlb2YoKm5vZGUpLCBiYXNlKSk7Cj4+PiAgICAgICAg
cmV0dXJuICZub2RlLT5iYXNlOwo+Pj4gICAgfQo+Pj4gICAgCj4+PiBAQCAtMjEyLDYgKzIxMyw4
IEBAIGludCBpOTE1X2FjdGl2ZV9yZWYoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsCj4+PiAgICAg
ICAgc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2ZTsKPj4+ICAgICAgICBpbnQgZXJy
Owo+Pj4gICAgCj4+PiArICAgICBHRU1fQlVHX09OKCF0aW1lbGluZSk7IC8qIHJlc2VydmVkIGZv
ciBpZGxlLWJhcnJpZXIgKi8KPj4+ICsKPj4+ICAgICAgICAvKiBQcmV2ZW50IHJlYXBpbmcgaW4g
Y2FzZSB3ZSBtYWxsb2Mvd2FpdCB3aGlsZSBidWlsZGluZyB0aGUgdHJlZSAqLwo+Pj4gICAgICAg
IGVyciA9IGk5MTVfYWN0aXZlX2FjcXVpcmUocmVmKTsKPj4+ICAgICAgICBpZiAoZXJyKQo+Pj4g
QEAgLTIyMiw2ICsyMjUsNyBAQCBpbnQgaTkxNV9hY3RpdmVfcmVmKHN0cnVjdCBpOTE1X2FjdGl2
ZSAqcmVmLAo+Pj4gICAgICAgICAgICAgICAgZXJyID0gLUVOT01FTTsKPj4+ICAgICAgICAgICAg
ICAgIGdvdG8gb3V0Owo+Pj4gICAgICAgIH0KPj4+ICsgICAgIEdFTV9CVUdfT04oSVNfRVJSKGFj
dGl2ZS0+cmVxdWVzdCkpOwo+Pj4gICAgCj4+PiAgICAgICAgaWYgKCFpOTE1X2FjdGl2ZV9yZXF1
ZXN0X2lzc2V0KGFjdGl2ZSkpCj4+PiAgICAgICAgICAgICAgICBhdG9taWNfaW5jKCZyZWYtPmNv
dW50KTsKPj4+IEBAIC0zNDIsNiArMzQ2LDM0IEBAIHZvaWQgaTkxNV9hY3RpdmVfZmluaShzdHJ1
Y3QgaTkxNV9hY3RpdmUgKnJlZikKPj4+ICAgIH0KPj4+ICAgICNlbmRpZgo+Pj4gICAgCj4+PiAr
c3RhdGljIHN0cnVjdCBhY3RpdmVfbm9kZSAqaWRsZV9iYXJyaWVyKHN0cnVjdCBpOTE1X2FjdGl2
ZSAqcmVmKQo+Pj4gK3sKPj4+ICsgICAgIHN0cnVjdCBhY3RpdmVfbm9kZSAqaWRsZSA9IE5VTEw7
Cj4+PiArICAgICBzdHJ1Y3QgcmJfbm9kZSAqcmI7Cj4+PiArCj4+PiArICAgICBpZiAoUkJfRU1Q
VFlfUk9PVCgmcmVmLT50cmVlKSkKPj4+ICsgICAgICAgICAgICAgcmV0dXJuIE5VTEw7Cj4+PiAr
Cj4+PiArICAgICBtdXRleF9sb2NrKCZyZWYtPm11dGV4KTsKPj4+ICsgICAgIGZvciAocmIgPSBy
Yl9maXJzdCgmcmVmLT50cmVlKTsgcmI7IHJiID0gcmJfbmV4dChyYikpIHsKPj4+ICsgICAgICAg
ICAgICAgc3RydWN0IGFjdGl2ZV9ub2RlICpub2RlOwo+Pj4gKwo+Pj4gKyAgICAgICAgICAgICBu
b2RlID0gcmJfZW50cnkocmIsIHR5cGVvZigqbm9kZSksIG5vZGUpOwo+Pj4gKyAgICAgICAgICAg
ICBpZiAobm9kZS0+dGltZWxpbmUpCj4+PiArICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Cj4+
PiArCj4+PiArICAgICAgICAgICAgIGlmICghaTkxNV9hY3RpdmVfcmVxdWVzdF9pc3NldCgmbm9k
ZS0+YmFzZSkpIHsKPj4+ICsgICAgICAgICAgICAgICAgICAgICBHRU1fQlVHX09OKCFsaXN0X2Vt
cHR5KCZub2RlLT5iYXNlLmxpbmspKTsKPj4+ICsgICAgICAgICAgICAgICAgICAgICByYl9lcmFz
ZShyYiwgJnJlZi0+dHJlZSk7Cj4+PiArICAgICAgICAgICAgICAgICAgICAgaWRsZSA9IG5vZGU7
Cj4+PiArICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Cj4+PiArICAgICAgICAgICAgIH0KPj4K
Pj4gVW5kZXIgd2hhdCBjaXJjdW1zdGFuY2VzIGRvZXMgdGhlIHdhbGsgY29udGludWU/IFRoZXJl
IGNhbiBiZSB0d28gaWRsZQo+PiBiYXJyaWVycyAodGltZWxpbmUgPT0gMCkgaW4gdGhlIHRyZWU/
Cj4gCj4gWWVzLCB0aGVyZSBjYW4gYmUgbW9yZSB0aGFuIG9uZSAodmlydHVhbCBlbmdpbmVzKS4g
SXQgc2hvdWxkIGJlIHRoZSBjYXNlCj4gdGhhdCB3aGVuIGk5MTVfYWN0aXZlIGJlY29tZXMgaWRs
ZSAoYWxsIGlkbGUgYmFycmllcnMgYXJlIGlkbGUpIHRoYXQgdGhlCj4gdHJlZSBpcyByZWFwZWQu
IEJ1dC4uLiBpZiB3ZSBvdmVybGFwIGFjdGl2ZSBwaGFzZXMsIHdlIHdpbGwgZ2V0IG11bHRpcGxl
Cj4gaWRsZSBiYXJyaWVycywgc29tZSBpZGxlLCBzb21lIGFjdGl2ZSwgd2hpY2ggd2Ugd2FudCB0
byByZXVzZSB0byBhdm9pZAo+IGhhdmluZyBhIHBvdGVudGlhbGx5IHVuYm91bmRlZCBhbGxvY2F0
aW9uLgoKVGhpcyBmZWVscyBpcyBjb21tZW50IHdvcnRoeSBhcyB3ZWxsLgoKUmVnYXJkcywKClR2
cnRrbwpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRl
bC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6
Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 1052EAB4F0
	for <lists+intel-gfx@lfdr.de>; Fri,  6 Sep 2019 11:33:23 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 64AF56E218;
	Fri,  6 Sep 2019 09:33:21 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga18.intel.com (mga18.intel.com [134.134.136.126])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 3A60A6E218
 for <intel-gfx@lists.freedesktop.org>; Fri,  6 Sep 2019 09:33:20 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga003.jf.intel.com ([10.7.209.27])
 by orsmga106.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 06 Sep 2019 02:33:20 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,472,1559545200"; d="scan'208";a="185737757"
Received: from chlopez-mobl1.amr.corp.intel.com (HELO
 delly.ger.corp.intel.com) ([10.252.36.202])
 by orsmga003.jf.intel.com with ESMTP; 06 Sep 2019 02:33:18 -0700
From: Lionel Landwerlin <lionel.g.landwerlin@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri,  6 Sep 2019 12:32:50 +0300
Message-Id: <20190906093256.26198-8-lionel.g.landwerlin@intel.com>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190906093256.26198-1-lionel.g.landwerlin@intel.com>
References: <20190906093256.26198-1-lionel.g.landwerlin@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v15 07/13] drm/i915/perf: allow for CS OA
 configs to be created lazily
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

SGVyZSB3ZSBpbnRyb2R1Y2UgYSBtZWNoYW5pc20gYnkgd2hpY2ggdGhlIGV4ZWNidWYgcGFydCBv
ZiB0aGUgaTkxNQpkcml2ZXIgd2lsbCBiZSBhYmxlIHRvIHJlcXVlc3QgdGhhdCBhIGJhdGNoIGJ1
ZmZlciBjb250YWluaW5nIHRoZQpwcm9ncmFtbWluZyBmb3IgYSBwYXJ0aWN1bGFyIE9BIGNvbmZp
ZyBiZSBjcmVhdGVkLgoKV2UnbGwgZXhlY3V0ZSB0aGVzZSBPQSBjb25maWd1cmF0aW9uIGJ1ZmZl
cnMgcmlnaHQgYmVmb3JlIGV4ZWN1dGluZyBhCnNldCBvZiB1c2Vyc3BhY2UgY29tbWFuZHMgc28g
dGhhdCBhIHBhcnRpY3VsYXIgdXNlciBiYXRjaGJ1ZmZlciBiZQpleGVjdXRlZCB3aXRoIGEgZ2l2
ZW4gT0EgY29uZmlndXJhdGlvbi4KClRoaXMgbWVjaGFuaXNtIGVzc2VudGlhbGx5IGFsbG93cyB0
aGUgdXNlcnNwYWNlIGRyaXZlciB0byBnbyB0aHJvdWdoCnNldmVyYWwgT0EgY29uZmlndXJhdGlv
biB3aXRob3V0IGhhdmluZyB0byBvcGVuL2Nsb3NlIHRoZSBpOTE1L3BlcmYKc3RyZWFtLgoKdjI6
IE5vIG5lZWQgZm9yIGxvY2tpbmcgb24gb2JqZWN0IE9BIGNvbmZpZyBvYmplY3QgY3JlYXRpb24g
KENocmlzKQogICAgRmx1c2ggY3B1IG1hcHBpbmcgb2YgT0EgY29uZmlnIChDaHJpcykKCnYzOiBQ
cm9wZXJseSBkZWFsIHdpdGggdGhlIHBlcmZfbWV0cmljIGxvY2sgKENocmlzL0xpb25lbCkKCnY0
OiBGaXggb2EgY29uZmlnIHVucmVmL3B1dCB3aGVuIG5vdCBmb3VuZCAoTGlvbmVsKQoKdjU6IEFs
bG9jYXRlIEJPcyBmb3IgY29uZmlndXJhdGlvbnMgb24gdGhlIHN0cmVhbSBpbnN0ZWFkIG9mIGds
b2JhbGx5CiAgICAoTGlvbmVsKQoKdjY6IEZpeCA2NGJpdCBkaXZpc2lvbiAoQ2hyaXMpCgp2Nzog
U3RvcmUgYWxsb2NhdGVkIGNvbmZpZyBCT3MgaW50byB0aGUgc3RyZWFtIChMaW9uZWwpCgpTaWdu
ZWQtb2ZmLWJ5OiBMaW9uZWwgTGFuZHdlcmxpbiA8bGlvbmVsLmcubGFuZHdlcmxpbkBpbnRlbC5j
b20+ClJldmlld2VkLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4g
KHY0KQotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2dwdV9jb21tYW5kcy5oIHwg
ICAxICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggICAgICAgICAgICAgIHwgICA0
ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYyAgICAgICAgICAgICB8IDI3MCAr
KysrKysrKysrKysrKysrLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuaCAgICAg
ICAgICAgICB8ICAyNiArKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmX3R5cGVzLmgg
ICAgICAgfCAgMTUgKy0KIDUgZmlsZXMgY2hhbmdlZCwgMjczIGluc2VydGlvbnMoKyksIDQzIGRl
bGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2dw
dV9jb21tYW5kcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3B1X2NvbW1hbmRz
LmgKaW5kZXggODZlMDBhMmRiOGE0Li5hN2YxMzc3YTU0YTIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2dwdV9jb21tYW5kcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2dwdV9jb21tYW5kcy5oCkBAIC0xMzMsNiArMTMzLDcgQEAKICAqLwog
I2RlZmluZSBNSV9MT0FEX1JFR0lTVEVSX0lNTSh4KQlNSV9JTlNUUigweDIyLCAyKih4KS0xKQog
I2RlZmluZSAgIE1JX0xSSV9GT1JDRV9QT1NURUQJCSgxPDwxMikKKyNkZWZpbmUgTUlfTE9BRF9S
RUdJU1RFUl9JTU1fTUFYX1JFR1MgKDEyNikKICNkZWZpbmUgTUlfU1RPUkVfUkVHSVNURVJfTUVN
ICAgICAgICBNSV9JTlNUUigweDI0LCAxKQogI2RlZmluZSBNSV9TVE9SRV9SRUdJU1RFUl9NRU1f
R0VOOCAgIE1JX0lOU1RSKDB4MjQsIDIpCiAjZGVmaW5lICAgTUlfU1JNX0xSTV9HTE9CQUxfR1RU
CQkoMTw8MjIpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAppbmRleCBmNDE0NWFlNmFiNmUuLjdlYjMx
OTIzY2RlOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCkBAIC0xMzYzLDggKzEzNjMsOCBAQCBz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSB7CiAJCXN0cnVjdCBtdXRleCBtZXRyaWNzX2xvY2s7CiAK
IAkJLyoKLQkJICogTGlzdCBvZiBkeW5hbWljIGNvbmZpZ3VyYXRpb25zLCB5b3UgbmVlZCB0byBo
b2xkCi0JCSAqIGRldl9wcml2LT5wZXJmLm1ldHJpY3NfbG9jayB0byBhY2Nlc3MgaXQuCisJCSAq
IExpc3Qgb2YgZHluYW1pYyBjb25maWd1cmF0aW9ucyAoc3RydWN0IGk5MTVfb2FfY29uZmlnKSwg
eW91CisJCSAqIG5lZWQgdG8gaG9sZCBkZXZfcHJpdi0+cGVyZi5tZXRyaWNzX2xvY2sgdG8gYWNj
ZXNzIGl0LgogCQkgKi8KIAkJc3RydWN0IGlkciBtZXRyaWNzX2lkcjsKIApkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3BlcmYuYwppbmRleCA0MGExZWMyYmM5NmIuLmM5ZDBkZTMwNTBmYiAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9wZXJmLmMKQEAgLTM2NywxMSArMzY3LDE5IEBAIHN0cnVjdCBwZXJmX29wZW5fcHJv
cGVydGllcyB7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwogfTsKIAorc3RydWN0
IGk5MTVfb2FfY29uZmlnX2JvIHsKKwlzdHJ1Y3QgbGlzdF9oZWFkIGxpbms7CisKKwlzdHJ1Y3Qg
aTkxNV9vYV9jb25maWcgKm9hX2NvbmZpZzsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAq
Ym87Cit9OworCiBzdGF0aWMgZW51bSBocnRpbWVyX3Jlc3RhcnQgb2FfcG9sbF9jaGVja190aW1l
cl9jYihzdHJ1Y3QgaHJ0aW1lciAqaHJ0aW1lcik7CiAKLXN0YXRpYyB2b2lkIGZyZWVfb2FfY29u
ZmlnKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCSAgIHN0cnVjdCBpOTE1
X29hX2NvbmZpZyAqb2FfY29uZmlnKQordm9pZCBpOTE1X29hX2NvbmZpZ19yZWxlYXNlKHN0cnVj
dCBrcmVmICpyZWYpCiB7CisJc3RydWN0IGk5MTVfb2FfY29uZmlnICpvYV9jb25maWcgPSBjb250
YWluZXJfb2YocmVmLCB0eXBlb2YoKm9hX2NvbmZpZyksIHJlZik7CisKIAlpZiAoIVBUUl9FUlIo
b2FfY29uZmlnLT5mbGV4X3JlZ3MpKQogCQlrZnJlZShvYV9jb25maWctPmZsZXhfcmVncyk7CiAJ
aWYgKCFQVFJfRVJSKG9hX2NvbmZpZy0+Yl9jb3VudGVyX3JlZ3MpKQpAQCAtMzgxLDQwICszODks
MTk0IEBAIHN0YXRpYyB2b2lkIGZyZWVfb2FfY29uZmlnKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKIAlrZnJlZShvYV9jb25maWcpOwogfQogCi1zdGF0aWMgdm9pZCBwdXRfb2Ff
Y29uZmlnKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCSAgc3RydWN0IGk5
MTVfb2FfY29uZmlnICpvYV9jb25maWcpCitzdGF0aWMgdTMyICp3cml0ZV9jc19taV9scmkodTMy
ICpjcywgY29uc3Qgc3RydWN0IGk5MTVfb2FfcmVnICpyZWdfZGF0YSwgdTMyIG5fcmVncykKIHsK
LQlpZiAoIWF0b21pY19kZWNfYW5kX3Rlc3QoJm9hX2NvbmZpZy0+cmVmX2NvdW50KSkKLQkJcmV0
dXJuOworCXUzMiBpOworCisJZm9yIChpID0gMDsgaSA8IG5fcmVnczsgaSsrKSB7CisJCWlmICgo
aSAlIE1JX0xPQURfUkVHSVNURVJfSU1NX01BWF9SRUdTKSA9PSAwKSB7CisJCQl1MzIgbl9scmkg
PSBtaW4obl9yZWdzIC0gaSwKKwkJCQkJKHUzMikgTUlfTE9BRF9SRUdJU1RFUl9JTU1fTUFYX1JF
R1MpOwogCi0JZnJlZV9vYV9jb25maWcoZGV2X3ByaXYsIG9hX2NvbmZpZyk7CisJCQkqY3MrKyA9
IE1JX0xPQURfUkVHSVNURVJfSU1NKG5fbHJpKTsKKwkJfQorCQkqY3MrKyA9IGk5MTVfbW1pb19y
ZWdfb2Zmc2V0KHJlZ19kYXRhW2ldLmFkZHIpOworCQkqY3MrKyA9IHJlZ19kYXRhW2ldLnZhbHVl
OworCX0KKworCXJldHVybiBjczsKIH0KIAotc3RhdGljIGludCBnZXRfb2FfY29uZmlnKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCSBpbnQgbWV0cmljc19zZXQsCi0JCQkg
c3RydWN0IGk5MTVfb2FfY29uZmlnICoqb3V0X2NvbmZpZykKK3N0YXRpYyBzdHJ1Y3QgaTkxNV9v
YV9jb25maWdfYm8qIGFsbG9jX29hX2NvbmZpZ19idWZmZXIoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCisJCQkJCQkJc3RydWN0IGk5MTVfb2FfY29uZmlnICpvYV9jb25maWcpCiB7Ci0J
aW50IHJldDsKKwlzdHJ1Y3QgaTkxNV9vYV9jb25maWdfYm8gKm9hX2JvOworCXNpemVfdCBjb25m
aWdfbGVuZ3RoID0gMDsKKwl1MzIgKmNzOworCWludCBlcnI7CisKKwlvYV9ibyA9IGt6YWxsb2Mo
c2l6ZW9mKCpvYV9ibyksIEdGUF9LRVJORUwpOworCWlmICghb2FfYm8pCisJCXJldHVybiBFUlJf
UFRSKC1FTk9NRU0pOworCisJb2FfYm8tPm9hX2NvbmZpZyA9IGk5MTVfb2FfY29uZmlnX2dldChv
YV9jb25maWcpOworCisJaWYgKG9hX2NvbmZpZy0+bXV4X3JlZ3NfbGVuID4gMCkgeworCQljb25m
aWdfbGVuZ3RoICs9IERJVl9ST1VORF9VUChvYV9jb25maWctPm11eF9yZWdzX2xlbiwKKwkJCQkJ
ICAgICAgTUlfTE9BRF9SRUdJU1RFUl9JTU1fTUFYX1JFR1MpICogNDsKKwkJY29uZmlnX2xlbmd0
aCArPSBvYV9jb25maWctPm11eF9yZWdzX2xlbiAqIDg7CisJfQorCWlmIChvYV9jb25maWctPmJf
Y291bnRlcl9yZWdzX2xlbiA+IDApIHsKKwkJY29uZmlnX2xlbmd0aCArPSBESVZfUk9VTkRfVVAo
b2FfY29uZmlnLT5iX2NvdW50ZXJfcmVnc19sZW4sCisJCQkJCSAgICAgIE1JX0xPQURfUkVHSVNU
RVJfSU1NX01BWF9SRUdTKSAqIDQ7CisJCWNvbmZpZ19sZW5ndGggKz0gb2FfY29uZmlnLT5iX2Nv
dW50ZXJfcmVnc19sZW4gKiA4OworCX0KKwlpZiAob2FfY29uZmlnLT5mbGV4X3JlZ3NfbGVuID4g
MCkgeworCQljb25maWdfbGVuZ3RoICs9IERJVl9ST1VORF9VUChvYV9jb25maWctPmZsZXhfcmVn
c19sZW4sCisJCQkJCSAgICAgIE1JX0xPQURfUkVHSVNURVJfSU1NX01BWF9SRUdTKSAqIDQ7CisJ
CWNvbmZpZ19sZW5ndGggKz0gb2FfY29uZmlnLT5mbGV4X3JlZ3NfbGVuICogODsKKwl9CisJY29u
ZmlnX2xlbmd0aCArPSA0OyAvKiBNSV9CQVRDSF9CVUZGRVJfRU5EICovCisJY29uZmlnX2xlbmd0
aCA9IEFMSUdOKGNvbmZpZ19sZW5ndGgsIEk5MTVfR1RUX1BBR0VfU0laRSk7CisKKwlvYV9iby0+
Ym8gPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3NobWVtKGk5MTUsIGNvbmZpZ19sZW5ndGgpOwor
CWlmIChJU19FUlIob2FfYm8tPmJvKSkgeworCQllcnIgPSBQVFJfRVJSKG9hX2JvLT5ibyk7CisJ
CWdvdG8gZXJyX29hX2NvbmZpZzsKKwl9CisKKwljcyA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFw
KG9hX2JvLT5ibywgSTkxNV9NQVBfV0IpOworCWlmIChJU19FUlIoY3MpKSB7CisJCWVyciA9IFBU
Ul9FUlIoY3MpOworCQlnb3RvIGVycl9vYV9ibzsKKwl9CisKKwljcyA9IHdyaXRlX2NzX21pX2xy
aShjcywgb2FfY29uZmlnLT5tdXhfcmVncywgb2FfY29uZmlnLT5tdXhfcmVnc19sZW4pOworCWNz
ID0gd3JpdGVfY3NfbWlfbHJpKGNzLCBvYV9jb25maWctPmJfY291bnRlcl9yZWdzLCBvYV9jb25m
aWctPmJfY291bnRlcl9yZWdzX2xlbik7CisJY3MgPSB3cml0ZV9jc19taV9scmkoY3MsIG9hX2Nv
bmZpZy0+ZmxleF9yZWdzLCBvYV9jb25maWctPmZsZXhfcmVnc19sZW4pOworCisJKmNzKysgPSBN
SV9CQVRDSF9CVUZGRVJfRU5EOworCisJaTkxNV9nZW1fb2JqZWN0X2ZsdXNoX21hcChvYV9iby0+
Ym8pOworCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAob2FfYm8tPmJvKTsKKworCXJldHVybiBv
YV9ibzsKKworZXJyX29hX2JvOgorCWk5MTVfZ2VtX29iamVjdF9wdXQob2FfYm8tPmJvKTsKK2Vy
cl9vYV9jb25maWc6CisJaTkxNV9vYV9jb25maWdfcHV0KG9hX2JvLT5vYV9jb25maWcpOworCWtm
cmVlKG9hX2JvKTsKKworCXJldHVybiBFUlJfUFRSKGVycik7Cit9CisKK2ludCBpOTE1X3BlcmZf
Z2V0X29hX2NvbmZpZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKKwkJCSAgICBpbnQg
bWV0cmljc19zZXQsCisJCQkgICAgc3RydWN0IGk5MTVfb2FfY29uZmlnICoqb3V0X2NvbmZpZykK
K3sKKwlzdHJ1Y3QgaTkxNV9vYV9jb25maWcgKm9hX2NvbmZpZzsKKwlpbnQgZXJyOworCisJaWYg
KCFpOTE1LT5wZXJmLmluaXRpYWxpemVkKQorCQlyZXR1cm4gLUVOT0RFVjsKKworCWVyciA9IG11
dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmaTkxNS0+cGVyZi5tZXRyaWNzX2xvY2spOworCWlmIChl
cnIpCisJCXJldHVybiBlcnI7CiAKIAlpZiAobWV0cmljc19zZXQgPT0gMSkgewotCQkqb3V0X2Nv
bmZpZyA9ICZkZXZfcHJpdi0+cGVyZi50ZXN0X2NvbmZpZzsKLQkJYXRvbWljX2luYygmZGV2X3By
aXYtPnBlcmYudGVzdF9jb25maWcucmVmX2NvdW50KTsKLQkJcmV0dXJuIDA7CisJCW9hX2NvbmZp
ZyA9ICZpOTE1LT5wZXJmLnRlc3RfY29uZmlnOworCX0gZWxzZSB7CisJCW9hX2NvbmZpZyA9IGlk
cl9maW5kKCZpOTE1LT5wZXJmLm1ldHJpY3NfaWRyLCBtZXRyaWNzX3NldCk7CisJCWlmICghb2Ff
Y29uZmlnKQorCQkJZXJyID0gLUVJTlZBTDsKIAl9CiAKLQlyZXQgPSBtdXRleF9sb2NrX2ludGVy
cnVwdGlibGUoJmRldl9wcml2LT5wZXJmLm1ldHJpY3NfbG9jayk7Ci0JaWYgKHJldCkKLQkJcmV0
dXJuIHJldDsKKwlpZiAoIWVycikKKwkJKm91dF9jb25maWcgPSBpOTE1X29hX2NvbmZpZ19nZXQo
b2FfY29uZmlnKTsKIAotCSpvdXRfY29uZmlnID0gaWRyX2ZpbmQoJmRldl9wcml2LT5wZXJmLm1l
dHJpY3NfaWRyLCBtZXRyaWNzX3NldCk7Ci0JaWYgKCEqb3V0X2NvbmZpZykKLQkJcmV0ID0gLUVJ
TlZBTDsKLQllbHNlCi0JCWF0b21pY19pbmMoJigqb3V0X2NvbmZpZyktPnJlZl9jb3VudCk7CisJ
bXV0ZXhfdW5sb2NrKCZpOTE1LT5wZXJmLm1ldHJpY3NfbG9jayk7CiAKLQltdXRleF91bmxvY2so
JmRldl9wcml2LT5wZXJmLm1ldHJpY3NfbG9jayk7CisJcmV0dXJuIGVycjsKK30KIAotCXJldHVy
biByZXQ7CitzdGF0aWMgdm9pZCBmcmVlX29hX2NvbmZpZ19ibyhzdHJ1Y3QgaTkxNV9vYV9jb25m
aWdfYm8gKm9hX2JvKQoreworCWk5MTVfb2FfY29uZmlnX3B1dChvYV9iby0+b2FfY29uZmlnKTsK
KwlpOTE1X2dlbV9vYmplY3RfcHV0KG9hX2JvLT5ibyk7CisJa2ZyZWUob2FfYm8pOworfQorCitp
bnQgaTkxNV9wZXJmX2dldF9vYV9jb25maWdfYW5kX2JvKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFt
ICpzdHJlYW0sCisJCQkJICAgaW50IG1ldHJpY3Nfc2V0LAorCQkJCSAgIHN0cnVjdCBpOTE1X29h
X2NvbmZpZyAqKm91dF9jb25maWcsCisJCQkJICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
KipvdXRfb2JqKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gc3RyZWFtLT5k
ZXZfcHJpdjsKKwlzdHJ1Y3QgaTkxNV9vYV9jb25maWcgKm9hX2NvbmZpZzsKKwlpbnQgZXJyID0g
MDsKKworCWlmICghaTkxNS0+cGVyZi5pbml0aWFsaXplZCkKKwkJcmV0dXJuIC1FTk9ERVY7CisK
KwllcnIgPSBpOTE1X3BlcmZfZ2V0X29hX2NvbmZpZyhpOTE1LCBtZXRyaWNzX3NldCwgJm9hX2Nv
bmZpZyk7CisJaWYgKGVycikKKwkJcmV0dXJuIGVycjsKKworCWlmIChvdXRfY29uZmlnKQorCQkq
b3V0X2NvbmZpZyA9IG9hX2NvbmZpZzsKKworCWlmIChvdXRfb2JqKSB7CisJCXN0cnVjdCBpOTE1
X29hX2NvbmZpZ19ibyAqb2FfYm8gPSBOVUxMLCAqb2FfYm9faXRlcjsKKworCQkvKiBMb29rIGZv
ciB0aGUgYnVmZmVyIGluIHRoZSBhbHJlYWR5IGFsbG9jYXRlZCBCT3MgYXR0YWNoZWQKKwkJICog
dG8gdGhlIHN0cmVhbS4KKwkJICovCisJCWVyciA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgm
c3RyZWFtLT5jb25maWdfbXV0ZXgpOworCQlpZiAoZXJyKQorCQkJZ290byBlcnI7CisKKwkJbGlz
dF9mb3JfZWFjaF9lbnRyeShvYV9ib19pdGVyLCAmc3RyZWFtLT5vYV9jb25maWdfYm9zLCBsaW5r
KSB7CisJCQlpZiAob2FfYm9faXRlci0+b2FfY29uZmlnID09IG9hX2NvbmZpZyAmJgorCQkJICAg
IG1lbWNtcChvYV9ib19pdGVyLT5vYV9jb25maWctPnV1aWQsCisJCQkJICAgb2FfY29uZmlnLT51
dWlkLAorCQkJCSAgIHNpemVvZihvYV9jb25maWctPnV1aWQpKSA9PSAwKSB7CisJCQkJb2FfYm8g
PSBvYV9ib19pdGVyOworCQkJCWJyZWFrOworCQkJfQorCQl9CisKKwkJbXV0ZXhfdW5sb2NrKCZz
dHJlYW0tPmNvbmZpZ19tdXRleCk7CisKKwkJaWYgKCFvYV9ibykgeworCQkJb2FfYm8gPSBhbGxv
Y19vYV9jb25maWdfYnVmZmVyKGk5MTUsIG9hX2NvbmZpZyk7CisJCQlpZiAoSVNfRVJSKG9hX2Jv
KSkgeworCQkJCWVyciA9IFBUUl9FUlIob2FfYm8pOworCQkJCWdvdG8gZXJyOworCQkJfQorCisJ
CQllcnIgPSBtdXRleF9sb2NrX2ludGVycnVwdGlibGUoJnN0cmVhbS0+Y29uZmlnX211dGV4KTsK
KwkJCWlmIChlcnIpIHsKKwkJCQlmcmVlX29hX2NvbmZpZ19ibyhvYV9ibyk7CisJCQkJZ290byBl
cnI7CisJCQl9CisKKwkJCWxpc3RfYWRkKCZvYV9iby0+bGluaywgJnN0cmVhbS0+b2FfY29uZmln
X2Jvcyk7CisKKwkJCW11dGV4X3VubG9jaygmc3RyZWFtLT5jb25maWdfbXV0ZXgpOworCQl9CisK
KwkJKm91dF9vYmogPSBpOTE1X2dlbV9vYmplY3RfZ2V0KG9hX2JvLT5ibyk7CisJfQorCitlcnI6
CisJaWYgKGVycikgeworCQlpOTE1X29hX2NvbmZpZ19wdXQob2FfY29uZmlnKTsKKwkJKm91dF9j
b25maWcgPSBOVUxMOworCX0KKworCXJldHVybiBlcnI7CiB9CiAKIHN0YXRpYyB1MzIgZ2VuOF9v
YV9od190YWlsX3JlYWQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSkKQEAgLTEzNjIs
NiArMTUyNCwxOCBAQCBmcmVlX29hX2J1ZmZlcihzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3Ry
ZWFtKQogCXN0cmVhbS0+b2FfYnVmZmVyLnZhZGRyID0gTlVMTDsKIH0KIAorc3RhdGljIHZvaWQK
K2ZyZWVfb2FfY29uZmlncyhzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtKQoreworCXN0
cnVjdCBpOTE1X29hX2NvbmZpZ19ibyAqb2FfYm8sICp0bXA7CisKKwlpOTE1X29hX2NvbmZpZ19w
dXQoc3RyZWFtLT5vYV9jb25maWcpOworCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShvYV9ibywg
dG1wLCAmc3RyZWFtLT5vYV9jb25maWdfYm9zLCBsaW5rKSB7CisJCWxpc3RfZGVsKCZvYV9iby0+
bGluayk7CisJCWZyZWVfb2FfY29uZmlnX2JvKG9hX2JvKTsKKwl9Cit9CisKIHN0YXRpYyB2b2lk
IGk5MTVfb2Ffc3RyZWFtX2Rlc3Ryb3koc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSkK
IHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBzdHJlYW0tPmRldl9wcml2
OwpAQCAtMTM4NSw3ICsxNTU5LDcgQEAgc3RhdGljIHZvaWQgaTkxNV9vYV9zdHJlYW1fZGVzdHJv
eShzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtKQogCWlmIChzdHJlYW0tPmN0eCkKIAkJ
b2FfcHV0X3JlbmRlcl9jdHhfaWQoc3RyZWFtKTsKIAotCXB1dF9vYV9jb25maWcoZGV2X3ByaXYs
IHN0cmVhbS0+b2FfY29uZmlnKTsKKwlmcmVlX29hX2NvbmZpZ3Moc3RyZWFtKTsKIAogCWlmIChk
ZXZfcHJpdi0+cGVyZi5zcHVyaW91c19yZXBvcnRfcnMubWlzc2VkKSB7CiAJCURSTV9OT1RFKCIl
ZCBzcHVyaW91cyBPQSByZXBvcnQgbm90aWNlcyBzdXBwcmVzc2VkIGR1ZSB0byByYXRlbGltaXRp
bmdcbiIsCkBAIC0yMTk5LDYgKzIzNzMsOCBAQCBzdGF0aWMgaW50IGk5MTVfb2Ffc3RyZWFtX2lu
aXQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSwKIAkJcmV0dXJuIC1FSU5WQUw7CiAJ
fQogCisJbXV0ZXhfaW5pdCgmc3RyZWFtLT5jb25maWdfbXV0ZXgpOworCiAJc3RyZWFtLT5zYW1w
bGVfc2l6ZSA9IHNpemVvZihzdHJ1Y3QgZHJtX2k5MTVfcGVyZl9yZWNvcmRfaGVhZGVyKTsKIAog
CWZvcm1hdF9zaXplID0gZGV2X3ByaXYtPnBlcmYub2FfZm9ybWF0c1twcm9wcy0+b2FfZm9ybWF0
XS5zaXplOwpAQCAtMjIyNyw3ICsyNDAzLDggQEAgc3RhdGljIGludCBpOTE1X29hX3N0cmVhbV9p
bml0KHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0sCiAJCX0KIAl9CiAKLQlyZXQgPSBn
ZXRfb2FfY29uZmlnKGRldl9wcml2LCBwcm9wcy0+bWV0cmljc19zZXQsICZzdHJlYW0tPm9hX2Nv
bmZpZyk7CisJcmV0ID0gaTkxNV9wZXJmX2dldF9vYV9jb25maWcoZGV2X3ByaXYsIHByb3BzLT5t
ZXRyaWNzX3NldCwKKwkJCQkgICAgICAmc3RyZWFtLT5vYV9jb25maWcpOwogCWlmIChyZXQpIHsK
IAkJRFJNX0RFQlVHKCJJbnZhbGlkIE9BIGNvbmZpZyBpZD0laVxuIiwgcHJvcHMtPm1ldHJpY3Nf
c2V0KTsKIAkJZ290byBlcnJfY29uZmlnOwpAQCAtMjI2NSw2ICsyNDQyLDggQEAgc3RhdGljIGlu
dCBpOTE1X29hX3N0cmVhbV9pbml0KHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0sCiAJ
CWdvdG8gZXJyX2VuYWJsZTsKIAl9CiAKKwlEUk1fREVCVUcoIm9wZW5pbmcgc3RyZWFtIG9hIGNv
bmZpZyB1dWlkPSVzXG4iLCBzdHJlYW0tPm9hX2NvbmZpZy0+dXVpZCk7CisKIAltdXRleF91bmxv
Y2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKIAogCWhydGltZXJfaW5pdCgmc3RyZWFt
LT5wb2xsX2NoZWNrX3RpbWVyLApAQCAtMjI4NCwxMSArMjQ2MywxMSBAQCBzdGF0aWMgaW50IGk5
MTVfb2Ffc3RyZWFtX2luaXQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSwKIAlmcmVl
X29hX2J1ZmZlcihzdHJlYW0pOwogCiBlcnJfb2FfYnVmX2FsbG9jOgotCXB1dF9vYV9jb25maWco
ZGV2X3ByaXYsIHN0cmVhbS0+b2FfY29uZmlnKTsKLQogCWludGVsX3VuY29yZV9mb3JjZXdha2Vf
cHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKIAlpbnRlbF9ydW50aW1lX3Bt
X3B1dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHN0cmVhbS0+d2FrZXJlZik7CiAKKwlmcmVlX29h
X2NvbmZpZ3Moc3RyZWFtKTsKKwogZXJyX2NvbmZpZzoKIAlpZiAoc3RyZWFtLT5jdHgpCiAJCW9h
X3B1dF9yZW5kZXJfY3R4X2lkKHN0cmVhbSk7CkBAIC0yMzA5LDggKzI0ODgsMTIgQEAgdm9pZCBp
OTE1X29hX2luaXRfcmVnX3N0YXRlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAkJ
cmV0dXJuOwogCiAJc3RyZWFtID0gZW5naW5lLT5pOTE1LT5wZXJmLmV4Y2x1c2l2ZV9zdHJlYW07
Ci0JaWYgKHN0cmVhbSkKKworCWlmIChzdHJlYW0pIHsKKwkJbXV0ZXhfbG9jaygmc3RyZWFtLT5j
b25maWdfbXV0ZXgpOwogCQlnZW44X3VwZGF0ZV9yZWdfc3RhdGVfdW5sb2NrZWQoc3RyZWFtLCBj
ZSwgcmVncywgc3RyZWFtLT5vYV9jb25maWcpOworCQltdXRleF91bmxvY2soJnN0cmVhbS0+Y29u
ZmlnX211dGV4KTsKKwl9CiB9CiAKIC8qKgpAQCAtMjY1Myw3ICsyODM2LDkgQEAgc3RhdGljIGlu
dCBpOTE1X3BlcmZfcmVsZWFzZShzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZmls
ZSkKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBzdHJlYW0tPmRldl9wcml2
OwogCiAJbXV0ZXhfbG9jaygmZGV2X3ByaXYtPnBlcmYubG9jayk7CisKIAlpOTE1X3BlcmZfZGVz
dHJveV9sb2NrZWQoc3RyZWFtKTsKKwogCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPnBlcmYubG9j
ayk7CiAKIAkvKiBSZWxlYXNlIHRoZSByZWZlcmVuY2UgdGhlIHBlcmYgc3RyZWFtIGtlcHQgb24g
dGhlIGRyaXZlci4gKi8KQEAgLTI3NjIsNiArMjk0Nyw3IEBAIGk5MTVfcGVyZl9vcGVuX2lvY3Rs
X2xvY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJCWdvdG8gZXJyX2N0
eDsKIAl9CiAKKwlJTklUX0xJU1RfSEVBRCgmc3RyZWFtLT5vYV9jb25maWdfYm9zKTsKIAlzdHJl
YW0tPmRldl9wcml2ID0gZGV2X3ByaXY7CiAJc3RyZWFtLT5jdHggPSBzcGVjaWZpY19jdHg7CiAK
QEAgLTMwODgsNyArMzI3NCw4IEBAIHZvaWQgaTkxNV9wZXJmX3JlZ2lzdGVyKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlpZiAocmV0KQogCQlnb3RvIHN5c2ZzX2Vycm9yOwog
Ci0JYXRvbWljX3NldCgmZGV2X3ByaXYtPnBlcmYudGVzdF9jb25maWcucmVmX2NvdW50LCAxKTsK
KwlkZXZfcHJpdi0+cGVyZi50ZXN0X2NvbmZpZy5pOTE1ID0gZGV2X3ByaXY7CisJa3JlZl9pbml0
KCZkZXZfcHJpdi0+cGVyZi50ZXN0X2NvbmZpZy5yZWYpOwogCiAJZ290byBleGl0OwogCkBAIC0z
MzQ0LDcgKzM1MzEsOCBAQCBpbnQgaTkxNV9wZXJmX2FkZF9jb25maWdfaW9jdGwoc3RydWN0IGRy
bV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIAkJcmV0dXJuIC1FTk9NRU07CiAJfQogCi0JYXRv
bWljX3NldCgmb2FfY29uZmlnLT5yZWZfY291bnQsIDEpOworCW9hX2NvbmZpZy0+aTkxNSA9IGRl
dl9wcml2OworCWtyZWZfaW5pdCgmb2FfY29uZmlnLT5yZWYpOwogCiAJaWYgKCF1dWlkX2lzX3Zh
bGlkKGFyZ3MtPnV1aWQpKSB7CiAJCURSTV9ERUJVRygiSW52YWxpZCB1dWlkIGZvcm1hdCBmb3Ig
T0EgY29uZmlnXG4iKTsKQEAgLTM0NDMsNyArMzYzMSw3IEBAIGludCBpOTE1X3BlcmZfYWRkX2Nv
bmZpZ19pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogc3lzZnNfZXJy
OgogCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPnBlcmYubWV0cmljc19sb2NrKTsKIHJlZ19lcnI6
Ci0JcHV0X29hX2NvbmZpZyhkZXZfcHJpdiwgb2FfY29uZmlnKTsKKwlpOTE1X29hX2NvbmZpZ19w
dXQob2FfY29uZmlnKTsKIAlEUk1fREVCVUcoIkZhaWxlZCB0byBhZGQgbmV3IE9BIGNvbmZpZ1xu
Iik7CiAJcmV0dXJuIGVycjsKIH0KQEAgLTM0NzksMTMgKzM2NjcsMTMgQEAgaW50IGk5MTVfcGVy
Zl9yZW1vdmVfY29uZmlnX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEs
CiAKIAlyZXQgPSBtdXRleF9sb2NrX2ludGVycnVwdGlibGUoJmRldl9wcml2LT5wZXJmLm1ldHJp
Y3NfbG9jayk7CiAJaWYgKHJldCkKLQkJZ290byBsb2NrX2VycjsKKwkJcmV0dXJuIHJldDsKIAog
CW9hX2NvbmZpZyA9IGlkcl9maW5kKCZkZXZfcHJpdi0+cGVyZi5tZXRyaWNzX2lkciwgKmFyZyk7
CiAJaWYgKCFvYV9jb25maWcpIHsKIAkJRFJNX0RFQlVHKCJGYWlsZWQgdG8gcmVtb3ZlIHVua25v
d24gT0EgY29uZmlnXG4iKTsKIAkJcmV0ID0gLUVOT0VOVDsKLQkJZ290byBjb25maWdfZXJyOwor
CQlnb3RvIGVycl91bmxvY2s7CiAJfQogCiAJR0VNX0JVR19PTigqYXJnICE9IG9hX2NvbmZpZy0+
aWQpOwpAQCAtMzQ5NSwxMyArMzY4MywxNiBAQCBpbnQgaTkxNV9wZXJmX3JlbW92ZV9jb25maWdf
aW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIAogCWlkcl9yZW1vdmUo
JmRldl9wcml2LT5wZXJmLm1ldHJpY3NfaWRyLCAqYXJnKTsKIAorCW11dGV4X3VubG9jaygmZGV2
X3ByaXYtPnBlcmYubWV0cmljc19sb2NrKTsKKwogCURSTV9ERUJVRygiUmVtb3ZlZCBjb25maWcg
JXMgaWQ9JWlcbiIsIG9hX2NvbmZpZy0+dXVpZCwgb2FfY29uZmlnLT5pZCk7CiAKLQlwdXRfb2Ff
Y29uZmlnKGRldl9wcml2LCBvYV9jb25maWcpOworCWk5MTVfb2FfY29uZmlnX3B1dChvYV9jb25m
aWcpOworCisJcmV0dXJuIDA7CiAKLWNvbmZpZ19lcnI6CitlcnJfdW5sb2NrOgogCW11dGV4X3Vu
bG9jaygmZGV2X3ByaXYtPnBlcmYubWV0cmljc19sb2NrKTsKLWxvY2tfZXJyOgogCXJldHVybiBy
ZXQ7CiB9CiAKQEAgLTM2NzEsMTAgKzM4NjIsOSBAQCB2b2lkIGk5MTVfcGVyZl9pbml0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAogc3RhdGljIGludCBkZXN0cm95X2NvbmZp
ZyhpbnQgaWQsIHZvaWQgKnAsIHZvaWQgKmRhdGEpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gZGF0YTsKIAlzdHJ1Y3QgaTkxNV9vYV9jb25maWcgKm9hX2NvbmZpZyA9
IHA7CiAKLQlwdXRfb2FfY29uZmlnKGRldl9wcml2LCBvYV9jb25maWcpOworCWk5MTVfb2FfY29u
ZmlnX3B1dChvYV9jb25maWcpOwogCiAJcmV0dXJuIDA7CiB9CkBAIC0zNjg4LDcgKzM4NzgsNyBA
QCB2b2lkIGk5MTVfcGVyZl9maW5pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
IAlpZiAoIWRldl9wcml2LT5wZXJmLmluaXRpYWxpemVkKQogCQlyZXR1cm47CiAKLQlpZHJfZm9y
X2VhY2goJmRldl9wcml2LT5wZXJmLm1ldHJpY3NfaWRyLCBkZXN0cm95X2NvbmZpZywgZGV2X3By
aXYpOworCWlkcl9mb3JfZWFjaCgmZGV2X3ByaXYtPnBlcmYubWV0cmljc19pZHIsIGRlc3Ryb3lf
Y29uZmlnLCBOVUxMKTsKIAlpZHJfZGVzdHJveSgmZGV2X3ByaXYtPnBlcmYubWV0cmljc19pZHIp
OwogCiAJdW5yZWdpc3Rlcl9zeXNjdGxfdGFibGUoZGV2X3ByaXYtPnBlcmYuc3lzY3RsX2hlYWRl
cik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuaCBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5oCmluZGV4IDI3MDE5MzUyNmI1Ni4uMWM4NTQ4Nzg3
NmE0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuaAorKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuaApAQCAtNywxMiArNywxNiBAQAogI2RlZmlu
ZSBfX0k5MTVfUEVSRl9IX18KIAogI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CisjaW5jbHVkZSA8
bGludXgva3JlZi5oPgogCiAjaW5jbHVkZSAiaTkxNV9wZXJmX3R5cGVzLmgiCiAKIHN0cnVjdCBk
cm1fZGV2aWNlOwogc3RydWN0IGRybV9maWxlOworc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Q7
CiBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKK3N0cnVjdCBpOTE1X29hX2NvbmZpZzsKK3N0cnVj
dCBpOTE1X3BlcmZfc3RyZWFtOwogc3RydWN0IGludGVsX2NvbnRleHQ7CiBzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzOwogCkBAIC0zMSw1ICszNSwyNyBAQCBpbnQgaTkxNV9wZXJmX3JlbW92ZV9jb25m
aWdfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIHZvaWQgaTkxNV9v
YV9pbml0X3JlZ19zdGF0ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCiAJCQkgICAg
c3RydWN0IGludGVsX2NvbnRleHQgKmNlLAogCQkJICAgIHUzMiAqcmVnX3N0YXRlKTsKK2ludCBp
OTE1X3BlcmZfZ2V0X29hX2NvbmZpZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKKwkJ
CSAgICBpbnQgbWV0cmljc19zZXQsCisJCQkgICAgc3RydWN0IGk5MTVfb2FfY29uZmlnICoqb3V0
X2NvbmZpZyk7CitpbnQgaTkxNV9wZXJmX2dldF9vYV9jb25maWdfYW5kX2JvKHN0cnVjdCBpOTE1
X3BlcmZfc3RyZWFtICpzdHJlYW0sCisJCQkJICAgaW50IG1ldHJpY3Nfc2V0LAorCQkJCSAgIHN0
cnVjdCBpOTE1X29hX2NvbmZpZyAqKm91dF9jb25maWcsCisJCQkJICAgc3RydWN0IGRybV9pOTE1
X2dlbV9vYmplY3QgKipvdXRfb2JqKTsKK3ZvaWQgaTkxNV9vYV9jb25maWdfcmVsZWFzZShzdHJ1
Y3Qga3JlZiAqcmVmKTsKKworc3RhdGljIGlubGluZSBzdHJ1Y3QgaTkxNV9vYV9jb25maWcgKmk5
MTVfb2FfY29uZmlnX2dldChzdHJ1Y3QgaTkxNV9vYV9jb25maWcgKm9hX2NvbmZpZykKK3sKKwlr
cmVmX2dldCgmb2FfY29uZmlnLT5yZWYpOworCXJldHVybiBvYV9jb25maWc7Cit9CisKK3N0YXRp
YyBpbmxpbmUgdm9pZCBpOTE1X29hX2NvbmZpZ19wdXQoc3RydWN0IGk5MTVfb2FfY29uZmlnICpv
YV9jb25maWcpCit7CisJaWYgKCFvYV9jb25maWcpCisJCXJldHVybjsKKworCWtyZWZfcHV0KCZv
YV9jb25maWctPnJlZiwgaTkxNV9vYV9jb25maWdfcmVsZWFzZSk7Cit9CiAKICNlbmRpZiAvKiBf
X0k5MTVfUEVSRl9IX18gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
cGVyZl90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmX3R5cGVzLmgKaW5k
ZXggMmE5MzFiYTQ4ZWQ4Li5iMWM4MTEwN2MwNjIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfcGVyZl90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
cGVyZl90eXBlcy5oCkBAIC0yNyw2ICsyNyw4IEBAIHN0cnVjdCBpOTE1X29hX3JlZyB7CiB9Owog
CiBzdHJ1Y3QgaTkxNV9vYV9jb25maWcgeworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
OworCiAJY2hhciB1dWlkW1VVSURfU1RSSU5HX0xFTiArIDFdOwogCWludCBpZDsKIApAQCAtNDEs
NyArNDMsNyBAQCBzdHJ1Y3QgaTkxNV9vYV9jb25maWcgewogCXN0cnVjdCBhdHRyaWJ1dGUgKmF0
dHJzWzJdOwogCXN0cnVjdCBkZXZpY2VfYXR0cmlidXRlIHN5c2ZzX21ldHJpY19pZDsKIAotCWF0
b21pY190IHJlZl9jb3VudDsKKwlzdHJ1Y3Qga3JlZiByZWY7CiB9OwogCiBzdHJ1Y3QgaTkxNV9w
ZXJmX3N0cmVhbTsKQEAgLTE2MywxMSArMTY1LDIyIEBAIHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFt
IHsKIAkgKi8KIAljb25zdCBzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbV9vcHMgKm9wczsKIAorCS8q
KgorCSAqIEBhY3RpdmVfY29uZmlnX211dGV4OiBQcm90ZWN0cyBhY2Nlc3MgdG8gQG9hX2NvbmZp
ZyAmIEBvYV9jb25maWdfYm9zLgorCSAqLworCXN0cnVjdCBtdXRleCBjb25maWdfbXV0ZXg7CisK
IAkvKioKIAkgKiBAb2FfY29uZmlnOiBUaGUgT0EgY29uZmlndXJhdGlvbiB1c2VkIGJ5IHRoZSBz
dHJlYW0uCiAJICovCiAJc3RydWN0IGk5MTVfb2FfY29uZmlnICpvYV9jb25maWc7CiAKKwkvKioK
KwkgKiBAb2FfY29uZmlnX2JvczogQSBsaXN0IG9mIHN0cnVjdCBpOTE1X29hX2NvbmZpZ19ibyBh
bGxvY2F0ZWQgbGF6aWx5CisJICogZWFjaCB0aW1lIEBvYV9jb25maWcgY2hhbmdlcy4KKwkgKi8K
KwlzdHJ1Y3QgbGlzdF9oZWFkIG9hX2NvbmZpZ19ib3M7CisKIAkvKioKIAkgKiBUaGUgT0EgY29u
dGV4dCBzcGVjaWZpYyBpbmZvcm1hdGlvbi4KIAkgKi8KLS0gCjIuMjMuMAoKX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlz
dApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0
b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 381FEA952D
	for <lists+intel-gfx@lfdr.de>; Wed,  4 Sep 2019 23:34:34 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 4A73189BF5;
	Wed,  4 Sep 2019 21:34:31 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga17.intel.com (mga17.intel.com [192.55.52.151])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 916D589BF5
 for <intel-gfx@lists.freedesktop.org>; Wed,  4 Sep 2019 21:34:30 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga001.fm.intel.com ([10.253.24.23])
 by fmsmga107.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 04 Sep 2019 14:34:30 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,468,1559545200"; d="scan'208";a="199121699"
Received: from josouza-mobl.jf.intel.com (HELO josouza-MOBL.intel.com)
 ([10.24.9.135])
 by fmsmga001.fm.intel.com with ESMTP; 04 Sep 2019 14:34:29 -0700
From: =?UTF-8?q?Jos=C3=A9=20Roberto=20de=20Souza?= <jose.souza@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed,  4 Sep 2019 14:34:14 -0700
Message-Id: <20190904213419.27547-2-jose.souza@intel.com>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190904213419.27547-1-jose.souza@intel.com>
References: <20190904213419.27547-1-jose.souza@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 1/6] drm/i915/psr: Only handle interruptions of
 the transcoder in use
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Lucas De Marchi <lucas.demarchi@intel.com>,
 Dhinakaran Pandiyan <dhinakaran.pandiyan@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

SXQgd2FzIGVuYWJsaW5nIGFuZCBjaGVja2luZyBQU1IgaW50ZXJydXB0aW9ucyBpbiBldmVyeSB0
cmFuc2NvZGVyCndoaWxlIGl0IHNob3VsZCBrZWVwIHRoZSBpbnRlcnJ1cHRpb25zIG9uIHRoZSBu
b24tdXNlZCB0cmFuc2NvZGVycwptYXNrZWQuCgpXaGlsZSBkb2luZyB0aGlzIGl0IGdpdmVzIHVz
IHRyb3VibGUgb24gVGlnZXIgTGFrZSBpZiB3ZSBhcmUKcmVhZGluZy93cml0aW5nIHRvIHJlZ2lz
dGVycyBvZiBkaXNhYmxlZCB0cmFuc2NvZGVycyBzaW5jZSBmcm9tIGdlbjEyCm9ud2FyZHMgdGhl
IHJlZ2lzdGVycyBhcmUgcmVsYXRpdmUgdG8gdGhlIHRyYW5zY29kZXIuIEluc3RlYWQgb2YgZm9y
Y2luZwp0aGVtIE9OIHRvIGFjY2VzcyB0aG9zZSByZWdpc3RlcnMsIGp1c3QgYXZvaWQgdGhlIGFj
Y2Vzc2VzIGFzIHRoZXkgYXJlCm5vdCBuZWVkZWQuCgp2MiAoTHVjYXMpOgogIC0gRXhwbGFpbiB3
aHkgd2UgY2FuJ3Qga2VlcCBhY2Nlc3NpbmcgYWxsIHRyYW5zY29kZXJzCiAgLSBSZW1vdmUgVE9E
TyBhYm91dCBleHRlbmRpbmcgdGhlIGlycSBoYW5kbGluZyB0byBtdWx0aXBsZSBpbnN0YW5jZXM6
CiAgICB3aGVuL2lmIGltcGxlbWVudGluZyBtdWx0aXBsZSBpbnN0YW5jZXMgaXQncyBwcmV0dHkg
Y2xlYXIgYnkgdGhlCiAgICBzaW5nbGV0b24gcHNyIHRoYXQgaXQgbmVlZHMgdG8gYmUgZXh0ZW5k
ZWQKICAtIEZpeCBpbnRlbF9wc3JfZGVidWdfc2V0KCkgY2FsbGluZyBwc3JfaXJxX2NvbnRyb2wo
KSB3aXRoCiAgICBwc3IudHJhbnNjb2RlciBub3Qgc2V0IHlldCAoZnJvbSBJbXJlKS4gTm93IHdl
IG9ubHkgc2V0IHRoZSBkZWJ1ZwogICAgcmVnaXN0ZXIgcmlnaHQgYXdheSBpZiBwc3IgaXMgYWxy
ZWFkeSBlbmFibGVkLiBPdGhlcndpc2Ugd2UganVzdAogICAgcmVjb3JkIHRoZSB2YWx1ZSB0byBi
ZSBzZXQgd2hlbiBlbmFibGluZyB0aGUgc291cmNlLgogIC0gRG8gbm90IGRlcGVuZCBvbiB0aGUg
dmFsdWUgb2YgVFJBTlNDT0RFUl9BLiBKdXN0IGJlIHJlbGF0aXZlIHRvIGl0CiAgICAoZnJvbSBJ
bXJlKQogIC0gaGFuZGxlIHBzciBlcnJvciBsYXN0IHNvIHdlIGRvbid0IHNjaGVkdWxlIHRoZSB3
b3JrIGJlZm9yZSBoYW5kbGluZwogICAgdGhlIG90aGVyIGZsYWdzCgp2MzoKICAtIEFkZGluZyBh
IHdhcm5pbmcgYWJvdXQgc2V0dGluZyByZXNlcnZlcmQgYml0cyBvbiBFRFBfUFNSX0lNUgoKQ2M6
IEltcmUgRGVhayA8aW1yZS5kZWFrQGludGVsLmNvbT4KQ2M6IERoaW5ha2FyYW4gUGFuZGl5YW4g
PGRoaW5ha2FyYW4ucGFuZGl5YW5AaW50ZWwuY29tPgpTaWduZWQtb2ZmLWJ5OiBKb3PDqSBSb2Jl
cnRvIGRlIFNvdXphIDxqb3NlLnNvdXphQGludGVsLmNvbT4KU2lnbmVkLW9mZi1ieTogTHVjYXMg
RGUgTWFyY2hpIDxsdWNhcy5kZW1hcmNoaUBpbnRlbC5jb20+ClJldmlld2VkLWJ5OiBNYXR0IFJv
cGVyIDxtYXR0aGV3LmQucm9wZXJAaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfcHNyLmMgfCAxNDIgKysrKysrKysrLS0tLS0tLS0tLS0tLS0KIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVnLmggICAgICAgICAgfCAgMTMgKy0tCiAyIGZpbGVzIGNo
YW5nZWQsIDYwIGluc2VydGlvbnMoKyksIDk1IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcHNyLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX3Bzci5jCmluZGV4IDYyOWI4Yjk4YTk3Zi4uMWQ5OWZmZWFhMzZh
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Bzci5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcHNyLmMKQEAgLTg4LDQ4ICs4
OCwyMCBAQCBzdGF0aWMgYm9vbCBpbnRlbF9wc3IyX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAogCX0KIH0KIAotc3RhdGljIGludCBlZHBfcHNyX3NoaWZ0KGVudW0g
dHJhbnNjb2RlciBjcHVfdHJhbnNjb2RlcikKK3N0YXRpYyB2b2lkIHBzcl9pcnFfY29udHJvbChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7Ci0Jc3dpdGNoIChjcHVfdHJhbnNj
b2RlcikgewotCWNhc2UgVFJBTlNDT0RFUl9BOgotCQlyZXR1cm4gRURQX1BTUl9UUkFOU0NPREVS
X0FfU0hJRlQ7Ci0JY2FzZSBUUkFOU0NPREVSX0I6Ci0JCXJldHVybiBFRFBfUFNSX1RSQU5TQ09E
RVJfQl9TSElGVDsKLQljYXNlIFRSQU5TQ09ERVJfQzoKLQkJcmV0dXJuIEVEUF9QU1JfVFJBTlND
T0RFUl9DX1NISUZUOwotCWRlZmF1bHQ6Ci0JCU1JU1NJTkdfQ0FTRShjcHVfdHJhbnNjb2Rlcik7
Ci0JCS8qIGZhbGx0aHJvdWdoICovCi0JY2FzZSBUUkFOU0NPREVSX0VEUDoKLQkJcmV0dXJuIEVE
UF9QU1JfVFJBTlNDT0RFUl9FRFBfU0hJRlQ7Ci0JfQotfQotCi1zdGF0aWMgdm9pZCBwc3JfaXJx
X2NvbnRyb2woc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgZGVidWcpCi17
Ci0JdTMyIGRlYnVnX21hc2ssIG1hc2s7Ci0JZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVy
OwotCXUzMiB0cmFuc2NvZGVycyA9IEJJVChUUkFOU0NPREVSX0VEUCk7Ci0KLQlpZiAoSU5URUxf
R0VOKGRldl9wcml2KSA+PSA4KQotCQl0cmFuc2NvZGVycyB8PSBCSVQoVFJBTlNDT0RFUl9BKSB8
Ci0JCQkgICAgICAgQklUKFRSQU5TQ09ERVJfQikgfAotCQkJICAgICAgIEJJVChUUkFOU0NPREVS
X0MpOwotCi0JZGVidWdfbWFzayA9IDA7Ci0JbWFzayA9IDA7Ci0JZm9yX2VhY2hfY3B1X3RyYW5z
Y29kZXJfbWFza2VkKGRldl9wcml2LCBjcHVfdHJhbnNjb2RlciwgdHJhbnNjb2RlcnMpIHsKLQkJ
aW50IHNoaWZ0ID0gZWRwX3Bzcl9zaGlmdChjcHVfdHJhbnNjb2Rlcik7Ci0KLQkJbWFzayB8PSBF
RFBfUFNSX0VSUk9SKHNoaWZ0KTsKLQkJZGVidWdfbWFzayB8PSBFRFBfUFNSX1BPU1RfRVhJVChz
aGlmdCkgfAotCQkJICAgICAgRURQX1BTUl9QUkVfRU5UUlkoc2hpZnQpOwotCX0KLQotCWlmIChk
ZWJ1ZyAmIEk5MTVfUFNSX0RFQlVHX0lSUSkKLQkJbWFzayB8PSBkZWJ1Z19tYXNrOwotCi0JSTkx
NV9XUklURShFRFBfUFNSX0lNUiwgfm1hc2spOworCWVudW0gdHJhbnNjb2RlciB0cmFucyA9IGRl
dl9wcml2LT5wc3IudHJhbnNjb2RlcjsKKwl1MzIgdmFsLCBtYXNrOworCisJbWFzayA9IEVEUF9Q
U1JfRVJST1IodHJhbnMpOworCWlmIChkZXZfcHJpdi0+cHNyLmRlYnVnICYgSTkxNV9QU1JfREVC
VUdfSVJRKQorCQltYXNrIHw9IEVEUF9QU1JfUE9TVF9FWElUKHRyYW5zKSB8IEVEUF9QU1JfUFJF
X0VOVFJZKHRyYW5zKTsKKworCS8qIFdhcm5pbmc6IGl0IGlzIG1hc2tpbmcvc2V0dGluZyByZXNl
cnZlZCBiaXRzIHRvbyAqLworCXZhbCA9IEk5MTVfUkVBRChFRFBfUFNSX0lNUik7CisJdmFsICY9
IH5FRFBfUFNSX1RSQU5TX01BU0sodHJhbnMpOworCXZhbCB8PSB+bWFzazsKKwlJOTE1X1dSSVRF
KEVEUF9QU1JfSU1SLCB2YWwpOwogfQogCiBzdGF0aWMgdm9pZCBwc3JfZXZlbnRfcHJpbnQodTMy
IHZhbCwgYm9vbCBwc3IyX2VuYWJsZWQpCkBAIC0xNzEsNjAgKzE0Myw0OCBAQCBzdGF0aWMgdm9p
ZCBwc3JfZXZlbnRfcHJpbnQodTMyIHZhbCwgYm9vbCBwc3IyX2VuYWJsZWQpCiAKIHZvaWQgaW50
ZWxfcHNyX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMy
IHBzcl9paXIpCiB7Ci0JdTMyIHRyYW5zY29kZXJzID0gQklUKFRSQU5TQ09ERVJfRURQKTsKLQll
bnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXI7CisJZW51bSB0cmFuc2NvZGVyIGNwdV90cmFu
c2NvZGVyID0gZGV2X3ByaXYtPnBzci50cmFuc2NvZGVyOwogCWt0aW1lX3QgdGltZV9ucyA9ICBr
dGltZV9nZXQoKTsKLQl1MzIgbWFzayA9IDA7Ci0KLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+
PSA4KQotCQl0cmFuc2NvZGVycyB8PSBCSVQoVFJBTlNDT0RFUl9BKSB8Ci0JCQkgICAgICAgQklU
KFRSQU5TQ09ERVJfQikgfAotCQkJICAgICAgIEJJVChUUkFOU0NPREVSX0MpOwotCi0JZm9yX2Vh
Y2hfY3B1X3RyYW5zY29kZXJfbWFza2VkKGRldl9wcml2LCBjcHVfdHJhbnNjb2RlciwgdHJhbnNj
b2RlcnMpIHsKLQkJaW50IHNoaWZ0ID0gZWRwX3Bzcl9zaGlmdChjcHVfdHJhbnNjb2Rlcik7CiAK
LQkJaWYgKHBzcl9paXIgJiBFRFBfUFNSX0VSUk9SKHNoaWZ0KSkgewotCQkJRFJNX1dBUk4oIlt0
cmFuc2NvZGVyICVzXSBQU1IgYXV4IGVycm9yXG4iLAotCQkJCSB0cmFuc2NvZGVyX25hbWUoY3B1
X3RyYW5zY29kZXIpKTsKKwlpZiAocHNyX2lpciAmIEVEUF9QU1JfUFJFX0VOVFJZKGNwdV90cmFu
c2NvZGVyKSkgeworCQlkZXZfcHJpdi0+cHNyLmxhc3RfZW50cnlfYXR0ZW1wdCA9IHRpbWVfbnM7
CisJCURSTV9ERUJVR19LTVMoIlt0cmFuc2NvZGVyICVzXSBQU1IgZW50cnkgYXR0ZW1wdCBpbiAy
IHZibGFua3NcbiIsCisJCQkgICAgICB0cmFuc2NvZGVyX25hbWUoY3B1X3RyYW5zY29kZXIpKTsK
Kwl9CiAKLQkJCWRldl9wcml2LT5wc3IuaXJxX2F1eF9lcnJvciA9IHRydWU7CisJaWYgKHBzcl9p
aXIgJiBFRFBfUFNSX1BPU1RfRVhJVChjcHVfdHJhbnNjb2RlcikpIHsKKwkJZGV2X3ByaXYtPnBz
ci5sYXN0X2V4aXQgPSB0aW1lX25zOworCQlEUk1fREVCVUdfS01TKCJbdHJhbnNjb2RlciAlc10g
UFNSIGV4aXQgY29tcGxldGVkXG4iLAorCQkJICAgICAgdHJhbnNjb2Rlcl9uYW1lKGNwdV90cmFu
c2NvZGVyKSk7CiAKLQkJCS8qCi0JCQkgKiBJZiB0aGlzIGludGVycnVwdGlvbiBpcyBub3QgbWFz
a2VkIGl0IHdpbGwga2VlcAotCQkJICogaW50ZXJydXB0aW5nIHNvIGZhc3QgdGhhdCBpdCBwcmV2
ZW50cyB0aGUgc2NoZWR1bGVkCi0JCQkgKiB3b3JrIHRvIHJ1bi4KLQkJCSAqIEFsc28gYWZ0ZXIg
YSBQU1IgZXJyb3IsIHdlIGRvbid0IHdhbnQgdG8gYXJtIFBTUgotCQkJICogYWdhaW4gc28gd2Ug
ZG9uJ3QgY2FyZSBhYm91dCB1bm1hc2sgdGhlIGludGVycnVwdGlvbgotCQkJICogb3IgdW5zZXQg
aXJxX2F1eF9lcnJvci4KLQkJCSAqLwotCQkJbWFzayB8PSBFRFBfUFNSX0VSUk9SKHNoaWZ0KTsK
LQkJfQorCQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KSB7CisJCQl1MzIgdmFsID0gSTkx
NV9SRUFEKFBTUl9FVkVOVChjcHVfdHJhbnNjb2RlcikpOworCQkJYm9vbCBwc3IyX2VuYWJsZWQg
PSBkZXZfcHJpdi0+cHNyLnBzcjJfZW5hYmxlZDsKIAotCQlpZiAocHNyX2lpciAmIEVEUF9QU1Jf
UFJFX0VOVFJZKHNoaWZ0KSkgewotCQkJZGV2X3ByaXYtPnBzci5sYXN0X2VudHJ5X2F0dGVtcHQg
PSB0aW1lX25zOwotCQkJRFJNX0RFQlVHX0tNUygiW3RyYW5zY29kZXIgJXNdIFBTUiBlbnRyeSBh
dHRlbXB0IGluIDIgdmJsYW5rc1xuIiwKLQkJCQkgICAgICB0cmFuc2NvZGVyX25hbWUoY3B1X3Ry
YW5zY29kZXIpKTsKKwkJCUk5MTVfV1JJVEUoUFNSX0VWRU5UKGNwdV90cmFuc2NvZGVyKSwgdmFs
KTsKKwkJCXBzcl9ldmVudF9wcmludCh2YWwsIHBzcjJfZW5hYmxlZCk7CiAJCX0KKwl9CiAKLQkJ
aWYgKHBzcl9paXIgJiBFRFBfUFNSX1BPU1RfRVhJVChzaGlmdCkpIHsKLQkJCWRldl9wcml2LT5w
c3IubGFzdF9leGl0ID0gdGltZV9uczsKLQkJCURSTV9ERUJVR19LTVMoIlt0cmFuc2NvZGVyICVz
XSBQU1IgZXhpdCBjb21wbGV0ZWRcbiIsCi0JCQkJICAgICAgdHJhbnNjb2Rlcl9uYW1lKGNwdV90
cmFuc2NvZGVyKSk7CisJaWYgKHBzcl9paXIgJiBFRFBfUFNSX0VSUk9SKGNwdV90cmFuc2NvZGVy
KSkgeworCQl1MzIgdmFsOwogCi0JCQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KSB7Ci0J
CQkJdTMyIHZhbCA9IEk5MTVfUkVBRChQU1JfRVZFTlQoY3B1X3RyYW5zY29kZXIpKTsKLQkJCQli
b29sIHBzcjJfZW5hYmxlZCA9IGRldl9wcml2LT5wc3IucHNyMl9lbmFibGVkOworCQlEUk1fV0FS
TigiW3RyYW5zY29kZXIgJXNdIFBTUiBhdXggZXJyb3JcbiIsCisJCQkgdHJhbnNjb2Rlcl9uYW1l
KGNwdV90cmFuc2NvZGVyKSk7CiAKLQkJCQlJOTE1X1dSSVRFKFBTUl9FVkVOVChjcHVfdHJhbnNj
b2RlciksIHZhbCk7Ci0JCQkJcHNyX2V2ZW50X3ByaW50KHZhbCwgcHNyMl9lbmFibGVkKTsKLQkJ
CX0KLQkJfQotCX0KKwkJZGV2X3ByaXYtPnBzci5pcnFfYXV4X2Vycm9yID0gdHJ1ZTsKIAotCWlm
IChtYXNrKSB7Ci0JCW1hc2sgfD0gSTkxNV9SRUFEKEVEUF9QU1JfSU1SKTsKLQkJSTkxNV9XUklU
RShFRFBfUFNSX0lNUiwgbWFzayk7CisJCS8qCisJCSAqIElmIHRoaXMgaW50ZXJydXB0aW9uIGlz
IG5vdCBtYXNrZWQgaXQgd2lsbCBrZWVwCisJCSAqIGludGVycnVwdGluZyBzbyBmYXN0IHRoYXQg
aXQgcHJldmVudHMgdGhlIHNjaGVkdWxlZAorCQkgKiB3b3JrIHRvIHJ1bi4KKwkJICogQWxzbyBh
ZnRlciBhIFBTUiBlcnJvciwgd2UgZG9uJ3Qgd2FudCB0byBhcm0gUFNSCisJCSAqIGFnYWluIHNv
IHdlIGRvbid0IGNhcmUgYWJvdXQgdW5tYXNrIHRoZSBpbnRlcnJ1cHRpb24KKwkJICogb3IgdW5z
ZXQgaXJxX2F1eF9lcnJvci4KKwkJICovCisJCXZhbCA9IEk5MTVfUkVBRChFRFBfUFNSX0lNUik7
CisJCXZhbCB8PSBFRFBfUFNSX0VSUk9SKGNwdV90cmFuc2NvZGVyKTsKKwkJSTkxNV9XUklURShF
RFBfUFNSX0lNUiwgdmFsKTsKIAogCQlzY2hlZHVsZV93b3JrKCZkZXZfcHJpdi0+cHNyLndvcmsp
OwogCX0KQEAgLTc0Nyw3ICs3MDcsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wc3JfZW5hYmxlX3Nv
dXJjZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAogCiAJSTkxNV9XUklURShFRFBfUFNSX0RF
QlVHKGRldl9wcml2LT5wc3IudHJhbnNjb2RlciksIG1hc2spOwogCi0JcHNyX2lycV9jb250cm9s
KGRldl9wcml2LCBkZXZfcHJpdi0+cHNyLmRlYnVnKTsKKwlwc3JfaXJxX2NvbnRyb2woZGV2X3By
aXYpOwogfQogCiBzdGF0aWMgdm9pZCBpbnRlbF9wc3JfZW5hYmxlX2xvY2tlZChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCkBAIC03NzIsNyArNzMyLDcgQEAgc3RhdGljIHZvaWQg
aW50ZWxfcHNyX2VuYWJsZV9sb2NrZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAogCSAqIHRvIGF2b2lkIGFueSByZW5kZXJpbmcgcHJvYmxlbXMuCiAJICovCiAJdmFsID0gSTkx
NV9SRUFEKEVEUF9QU1JfSUlSKTsKLQl2YWwgJj0gRURQX1BTUl9FUlJPUihlZHBfcHNyX3NoaWZ0
KGRldl9wcml2LT5wc3IudHJhbnNjb2RlcikpOworCXZhbCAmPSBFRFBfUFNSX0VSUk9SKGRldl9w
cml2LT5wc3IudHJhbnNjb2Rlcik7CiAJaWYgKHZhbCkgewogCQlkZXZfcHJpdi0+cHNyLnNpbmtf
bm90X3JlbGlhYmxlID0gdHJ1ZTsKIAkJRFJNX0RFQlVHX0tNUygiUFNSIGludGVycnVwdGlvbiBl
cnJvciBzZXQsIG5vdCBlbmFibGluZyBQU1JcbiIpOwpAQCAtMTEyMCw3ICsxMDgwLDEzIEBAIGlu
dCBpbnRlbF9wc3JfZGVidWdfc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwg
dTY0IHZhbCkKIAogCW9sZF9tb2RlID0gZGV2X3ByaXYtPnBzci5kZWJ1ZyAmIEk5MTVfUFNSX0RF
QlVHX01PREVfTUFTSzsKIAlkZXZfcHJpdi0+cHNyLmRlYnVnID0gdmFsOwotCXBzcl9pcnFfY29u
dHJvbChkZXZfcHJpdiwgZGV2X3ByaXYtPnBzci5kZWJ1Zyk7CisKKwkvKgorCSAqIERvIGl0IHJp
Z2h0IGF3YXkgaWYgaXQncyBhbHJlYWR5IGVuYWJsZWQsIG90aGVyd2lzZSBpdCB3aWxsIGJlIGRv
bmUKKwkgKiB3aGVuIGVuYWJsaW5nIHRoZSBzb3VyY2UuCisJICovCisJaWYgKGRldl9wcml2LT5w
c3IuZW5hYmxlZCkKKwkJcHNyX2lycV9jb250cm9sKGRldl9wcml2KTsKIAogCW11dGV4X3VubG9j
aygmZGV2X3ByaXYtPnBzci5sb2NrKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9yZWcuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVnLmgKaW5kZXggNDVl
ZDk2ZDdjNTk5Li44MWY2ODQ1NWQ0OTIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfcmVnLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZWcuaApAQCAtNDIy
NSwxMyArNDIyNSwxMiBAQCBlbnVtIHsKIC8qIEJzcGVjIGNsYWltcyB0aG9zZSBhcmVuJ3Qgc2hp
ZnRlZCBidXQgc3RheSBhdCAweDY0ODAwICovCiAjZGVmaW5lIEVEUF9QU1JfSU1SCQkJCV9NTUlP
KDB4NjQ4MzQpCiAjZGVmaW5lIEVEUF9QU1JfSUlSCQkJCV9NTUlPKDB4NjQ4MzgpCi0jZGVmaW5l
ICAgRURQX1BTUl9FUlJPUihzaGlmdCkJCQkoMSA8PCAoKHNoaWZ0KSArIDIpKQotI2RlZmluZSAg
IEVEUF9QU1JfUE9TVF9FWElUKHNoaWZ0KQkJKDEgPDwgKChzaGlmdCkgKyAxKSkKLSNkZWZpbmUg
ICBFRFBfUFNSX1BSRV9FTlRSWShzaGlmdCkJCSgxIDw8IChzaGlmdCkpCi0jZGVmaW5lICAgRURQ
X1BTUl9UUkFOU0NPREVSX0NfU0hJRlQJCTI0Ci0jZGVmaW5lICAgRURQX1BTUl9UUkFOU0NPREVS
X0JfU0hJRlQJCTE2Ci0jZGVmaW5lICAgRURQX1BTUl9UUkFOU0NPREVSX0FfU0hJRlQJCTgKLSNk
ZWZpbmUgICBFRFBfUFNSX1RSQU5TQ09ERVJfRURQX1NISUZUCQkwCisjZGVmaW5lICAgX0VEUF9Q
U1JfVFJBTlNfU0hJRlQodHJhbnMpCQkoKHRyYW5zKSA9PSBUUkFOU0NPREVSX0VEUCA/IFwKKwkJ
CQkJCSAwIDogKCh0cmFucykgLSBUUkFOU0NPREVSX0EgKyAxKSAqIDgpCisjZGVmaW5lICAgRURQ
X1BTUl9UUkFOU19NQVNLKHRyYW5zKQkJKDB4NyA8PCBfRURQX1BTUl9UUkFOU19TSElGVCh0cmFu
cykpCisjZGVmaW5lICAgRURQX1BTUl9FUlJPUih0cmFucykJCQkoMHg0IDw8IF9FRFBfUFNSX1RS
QU5TX1NISUZUKHRyYW5zKSkKKyNkZWZpbmUgICBFRFBfUFNSX1BPU1RfRVhJVCh0cmFucykJCSgw
eDIgPDwgX0VEUF9QU1JfVFJBTlNfU0hJRlQodHJhbnMpKQorI2RlZmluZSAgIEVEUF9QU1JfUFJF
X0VOVFJZKHRyYW5zKQkJKDB4MSA8PCBfRURQX1BTUl9UUkFOU19TSElGVCh0cmFucykpCiAKICNk
ZWZpbmUgX1NSRF9BVVhfQ1RMX0EJCQkJMHg2MDgxMAogI2RlZmluZSBfU1JEX0FVWF9DVExfRURQ
CQkJMHg2ZjgxMAotLSAKMi4yMy4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVl
ZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5m
by9pbnRlbC1nZng=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 79FEA7B613
	for <lists+intel-gfx@lfdr.de>; Wed, 31 Jul 2019 01:08:05 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1699C89FA0;
	Tue, 30 Jul 2019 23:08:03 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga17.intel.com (mga17.intel.com [192.55.52.151])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 87C4A89FA0
 for <intel-gfx@lists.freedesktop.org>; Tue, 30 Jul 2019 23:08:01 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga006.fm.intel.com ([10.253.24.20])
 by fmsmga107.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 30 Jul 2019 16:08:00 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,327,1559545200"; d="scan'208";a="371854024"
Received: from dceraolo-linux.fm.intel.com ([10.1.27.145])
 by fmsmga006.fm.intel.com with ESMTP; 30 Jul 2019 16:08:01 -0700
From: Daniele Ceraolo Spurio <daniele.ceraolospurio@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 30 Jul 2019 16:07:39 -0700
Message-Id: <20190730230743.19542-1-daniele.ceraolospurio@intel.com>
X-Mailer: git-send-email 2.22.0
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v2 1/5] drm/i915/uc: Don't enable communication
 twice on resume
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

V2hlbiBjb21pbmcgb3V0IG9mIFMzL1M0IHdlIHNhbml0aXplIGFuZCByZS1pbml0IHRoZSBIVywg
d2hpY2ggaW5jbHVkZXMKZW5hYmxpbmcgY29tbXVuaWNhdGlvbiBkdXJpbmcgdWNfaW5pdF9ody4g
V2UgdGhlcmVmb3JlIGRvbid0IHdhbnQgdG8gZG8KdGhhdCBhZ2FpbiBpbiB1Y19yZXN1bWUgYW5k
IGNhbiBqdXN0IHRlbGwgR3VDIHRvIHJlbG9hZCBpdHMgc3RhdGUuCgp2Mjogc3BsaXQgdWNfcmVz
dW1lIGFuZCB1Y19ydW50aW1lX3Jlc3VtZSB0byBtYXRjaCB0aGUgc3VzcGVuZAogICAgZnVuY3Rp
b25zIGFuZCB0byBiZXR0ZXIgZGlmZmVyZW50aWF0ZSB0aGUgZXhwZWN0ZWQgc3RhdGUgaW4gdGhl
IDIKICAgIHNjZW5hcmlvcyAoQ2hyaXMpCgpTaWduZWQtb2ZmLWJ5OiBEYW5pZWxlIENlcmFvbG8g
U3B1cmlvIDxkYW5pZWxlLmNlcmFvbG9zcHVyaW9AaW50ZWwuY29tPgpDYzogTWljaGFsIFdhamRl
Y3prbyA8bWljaGFsLndhamRlY3prb0BpbnRlbC5jb20+CkNjOiBDaHJpcyBXaWxzb24gPGNocmlz
QGNocmlzLXdpbHNvbi5jby51az4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRl
bF91Yy5jIHwgMzUgKysrKysrKysrKysrKysrKysrKysrKysrKy0tCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC91Yy9pbnRlbF91Yy5oIHwgIDEgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9k
cnYuYyAgICAgICB8ICA0ICstLQogMyBmaWxlcyBjaGFuZ2VkLCAzNiBpbnNlcnRpb25zKCspLCA0
IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2lu
dGVsX3VjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF91Yy5jCmluZGV4IDZl
YjhiYjNmYTI1Mi4uNjU3ZmRjYjcwZDAwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC91Yy9pbnRlbF91Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVs
X3VjLmMKQEAgLTIzMywxMSArMjMzLDIwIEBAIHN0YXRpYyB2b2lkIGd1Y19kaXNhYmxlX2ludGVy
cnVwdHMoc3RydWN0IGludGVsX2d1YyAqZ3VjKQogCWd1Yy0+aW50ZXJydXB0cy5kaXNhYmxlKGd1
Yyk7CiB9CiAKKyNpZmRlZiBDT05GSUdfRFJNX0k5MTVfREVCVUdfR0VNCitzdGF0aWMgYm9vbCBn
dWNfY29tbXVuaWNhdGlvbl9lbmFibGVkKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKK3sKKwlyZXR1
cm4gZ3VjLT5zZW5kICE9IGludGVsX2d1Y19zZW5kX25vcDsKK30KKyNlbmRpZgorCiBzdGF0aWMg
aW50IGd1Y19lbmFibGVfY29tbXVuaWNhdGlvbihzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCiB7CiAJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndWNfdG9fZ3QoZ3VjKS0+aTkxNTsKIAlp
bnQgcmV0OwogCisJR0VNX0JVR19PTihndWNfY29tbXVuaWNhdGlvbl9lbmFibGVkKGd1YykpOwor
CiAJcmV0ID0gaW50ZWxfZ3VjX2N0X2VuYWJsZSgmZ3VjLT5jdCk7CiAJaWYgKHJldCkKIAkJcmV0
dXJuIHJldDsKQEAgLTU1MCw3ICs1NTksNyBAQCB2b2lkIGludGVsX3VjX3N1c3BlbmQoc3RydWN0
IGludGVsX3VjICp1YykKIAkJaW50ZWxfdWNfcnVudGltZV9zdXNwZW5kKHVjKTsKIH0KIAotaW50
IGludGVsX3VjX3Jlc3VtZShzdHJ1Y3QgaW50ZWxfdWMgKnVjKQorc3RhdGljIGludCBfX3VjX3Jl
c3VtZShzdHJ1Y3QgaW50ZWxfdWMgKnVjLCBib29sIGVuYWJsZV9jb21tdW5pY2F0aW9uKQogewog
CXN0cnVjdCBpbnRlbF9ndWMgKmd1YyA9ICZ1Yy0+Z3VjOwogCWludCBlcnI7CkBAIC01NTgsNyAr
NTY3LDExIEBAIGludCBpbnRlbF91Y19yZXN1bWUoc3RydWN0IGludGVsX3VjICp1YykKIAlpZiAo
IWludGVsX2d1Y19pc19ydW5uaW5nKGd1YykpCiAJCXJldHVybiAwOwogCi0JZ3VjX2VuYWJsZV9j
b21tdW5pY2F0aW9uKGd1Yyk7CisJLyogTWFrZSBzdXJlIHdlIGVuYWJsZSBjb21tdW5pY2F0aW9u
IGlmIGFuZCBvbmx5IGlmIGl0J3MgZGlzYWJsZWQgKi8KKwlHRU1fQlVHX09OKGVuYWJsZV9jb21t
dW5pY2F0aW9uID09IGd1Y19jb21tdW5pY2F0aW9uX2VuYWJsZWQoZ3VjKSk7CisKKwlpZiAoZW5h
YmxlX2NvbW11bmljYXRpb24pCisJCWd1Y19lbmFibGVfY29tbXVuaWNhdGlvbihndWMpOwogCiAJ
ZXJyID0gaW50ZWxfZ3VjX3Jlc3VtZShndWMpOwogCWlmIChlcnIpIHsKQEAgLTU2OCwzICs1ODEs
MjEgQEAgaW50IGludGVsX3VjX3Jlc3VtZShzdHJ1Y3QgaW50ZWxfdWMgKnVjKQogCiAJcmV0dXJu
IDA7CiB9CisKK2ludCBpbnRlbF91Y19yZXN1bWUoc3RydWN0IGludGVsX3VjICp1YykKK3sKKwkv
KgorCSAqIFdoZW4gY29taW5nIG91dCBvZiBTMy9TNCB3ZSBzYW5pdGl6ZSBhbmQgcmUtaW5pdCB0
aGUgSFcsIHNvCisJICogY29tbXVuaWNhdGlvbiBpcyBhbHJlYWR5IHJlLWVuYWJsZWQgYXQgdGhp
cyBwb2ludC4KKwkgKi8KKwlyZXR1cm4gX191Y19yZXN1bWUodWMsIGZhbHNlKTsKK30KKworaW50
IGludGVsX3VjX3J1bnRpbWVfcmVzdW1lKHN0cnVjdCBpbnRlbF91YyAqdWMpCit7CisJLyoKKwkg
KiBEdXJpbmcgcnVudGltZSByZXN1bWUgd2UgZG9uJ3Qgc2FuaXRpemUsIHNvIHdlIG5lZWQgdG8g
cmUtaW5pdAorCSAqIGNvbW11bmljYXRpb24gYXMgd2VsbC4KKwkgKi8KKwlyZXR1cm4gX191Y19y
ZXN1bWUodWMsIHRydWUpOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
dWMvaW50ZWxfdWMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX3VjLmgKaW5k
ZXggZmUzMzYyZmQ3NzA2Li4yNWRhNTFlOTU0MTcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3VjL2ludGVsX3VjLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMv
aW50ZWxfdWMuaApAQCAtNDcsNiArNDcsNyBAQCB2b2lkIGludGVsX3VjX3Jlc2V0X3ByZXBhcmUo
c3RydWN0IGludGVsX3VjICp1Yyk7CiB2b2lkIGludGVsX3VjX3N1c3BlbmQoc3RydWN0IGludGVs
X3VjICp1Yyk7CiB2b2lkIGludGVsX3VjX3J1bnRpbWVfc3VzcGVuZChzdHJ1Y3QgaW50ZWxfdWMg
KnVjKTsKIGludCBpbnRlbF91Y19yZXN1bWUoc3RydWN0IGludGVsX3VjICp1Yyk7CitpbnQgaW50
ZWxfdWNfcnVudGltZV9yZXN1bWUoc3RydWN0IGludGVsX3VjICp1Yyk7CiAKIHN0YXRpYyBpbmxp
bmUgYm9vbCBpbnRlbF91Y19pc191c2luZ19ndWMoc3RydWN0IGludGVsX3VjICp1YykKIHsKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2Rydi5jCmluZGV4IGYyZDNkNzU0YWYzNy4uNzYxNzI2ODE4YTIyIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZHJ2LmMKQEAgLTI5NTAsNyArMjk1MCw3IEBAIHN0YXRpYyBpbnQgaW50
ZWxfcnVudGltZV9zdXNwZW5kKHN0cnVjdCBkZXZpY2UgKmtkZXYpCiAKIAkJaW50ZWxfcnVudGlt
ZV9wbV9lbmFibGVfaW50ZXJydXB0cyhkZXZfcHJpdik7CiAKLQkJaW50ZWxfdWNfcmVzdW1lKCZk
ZXZfcHJpdi0+Z3QudWMpOworCQlpbnRlbF91Y19ydW50aW1lX3Jlc3VtZSgmZGV2X3ByaXYtPmd0
LnVjKTsKIAogCQlpbnRlbF9ndF9pbml0X3N3aXp6bGluZygmZGV2X3ByaXYtPmd0KTsKIAkJaTkx
NV9nZW1fcmVzdG9yZV9mZW5jZXMoZGV2X3ByaXYpOwpAQCAtMzA0Nyw3ICszMDQ3LDcgQEAgc3Rh
dGljIGludCBpbnRlbF9ydW50aW1lX3Jlc3VtZShzdHJ1Y3QgZGV2aWNlICprZGV2KQogCiAJaW50
ZWxfcnVudGltZV9wbV9lbmFibGVfaW50ZXJydXB0cyhkZXZfcHJpdik7CiAKLQlpbnRlbF91Y19y
ZXN1bWUoJmRldl9wcml2LT5ndC51Yyk7CisJaW50ZWxfdWNfcnVudGltZV9yZXN1bWUoJmRldl9w
cml2LT5ndC51Yyk7CiAKIAkvKgogCSAqIE5vIHBvaW50IG9mIHJvbGxpbmcgYmFjayB0aGluZ3Mg
aW4gY2FzZSBvZiBhbiBlcnJvciwgYXMgdGhlIGJlc3QKLS0gCjIuMjIuMAoKX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlz
dApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0
b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

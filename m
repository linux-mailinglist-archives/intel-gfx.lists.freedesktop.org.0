Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 78C6145A99
	for <lists+intel-gfx@lfdr.de>; Fri, 14 Jun 2019 12:39:48 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D65AE892EA;
	Fri, 14 Jun 2019 10:39:46 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mblankhorst.nl (mblankhorst.nl [141.105.120.124])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 557B6892EA
 for <intel-gfx@lists.freedesktop.org>; Fri, 14 Jun 2019 10:39:45 +0000 (UTC)
From: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 14 Jun 2019 12:39:41 +0200
Message-Id: <20190614103941.15399-1-maarten.lankhorst@linux.intel.com>
X-Mailer: git-send-email 2.20.1
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915: Check visibility in icl_build_plane_wm
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

V2hlbiBhIHBsYW5hciBZVVYgcGxhbmUgaXMgY29uZmlndXJlZCwgYnV0IHRoZSBjcnRjIGlzCm1h
cmtlZCBpbmFjdGl2ZSwgd2UgY2FuIGVuZCB1cCB3aXRoIGEgbGlua2VkIHBsYW5lIHdpdGhvdXQK
dmlzaWJpbGl0eS4gSGFuZGxlIHRoaXMgYnkgY2hlY2tpbmcgZm9yIHZpc2liaWxpdHkgZWFybHks
Cmluc3RlYWQgb2YgZG9pbmcgYSBXQVJOLgoKPDQ+IFsyMDEuNzQyOTE5XSAtLS0tLS0tLS0tLS1b
IGN1dCBoZXJlIF0tLS0tLS0tLS0tLS0KPDQ+IFsyMDEuNzQyOTIwXSBXQVJOX09OKCFpbnRlbF93
bV9wbGFuZV92aXNpYmxlKGNydGNfc3RhdGUsIHBsYW5lX3N0YXRlKSkKPDQ+IFsyMDEuNzQyOTQ3
XSBXQVJOSU5HOiBDUFU6IDcgUElEOiAxMjY4IGF0IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X3BtLmM6NTA2OCBza2xfY29tcHV0ZV93bSsweDJiZS8weDEwYTAgW2k5MTVdCjw0PiBbMjAxLjc0
Mjk0OF0gTW9kdWxlcyBsaW5rZWQgaW46IHNuZF9oZGFfY29kZWNfaGRtaSBzbmRfaGRhX2NvZGVj
X3JlYWx0ZWsgc25kX2hkYV9jb2RlY19nZW5lcmljIGk5MTUgeDg2X3BrZ190ZW1wX3RoZXJtYWwg
c25kX2hkYV9pbnRlbCBjb3JldGVtcCBzbmRfaGRhX2NvZGVjIG1laV9oZGNwIHNuZF9od2RlcCBz
bmRfaGRhX2NvcmUgY3JjdDEwZGlmX3BjbG11bCBjZGNfZXRoZXIgdXNibmV0IGNyYzMyX3BjbG11
bCBtaWkgc25kX3BjbSBnaGFzaF9jbG11bG5pX2ludGVsIG1laV9tZSBtZWkgcHJpbWVfbnVtYmVy
cwo8ND4gWzIwMS43NDI5NThdIENQVTogNyBQSUQ6IDEyNjggQ29tbToga21zX2NoYW1lbGl1bSBU
YWludGVkOiBHICAgICBVICAgICAgICAgICAgNS4yLjAtcmMzLUNJLUNJX0RSTV82MjE2KyAjMQo8
ND4gWzIwMS43NDI5NjBdIEhhcmR3YXJlIG5hbWU6IEludGVsIENvcnBvcmF0aW9uIEljZSBMYWtl
IENsaWVudCBQbGF0Zm9ybS9JY2VMYWtlIFUgRERSNCBTT0RJTU0gUEQgUlZQIFRMQywgQklPUyBJ
Q0xTRldSMS5SMDAuMzE4My5BMDAuMTkwNTAyMDQxMSAwNS8wMi8yMDE5Cjw0PiBbMjAxLjc0Mjk3
OF0gUklQOiAwMDEwOnNrbF9jb21wdXRlX3dtKzB4MmJlLzB4MTBhMCBbaTkxNV0KPDQ+IFsyMDEu
NzQyOTgwXSBDb2RlOiAyNCAxMCA4YiA5MiBmYyAwMiAwMCAwMCAwZiA4NSBiYSAwNCAwMCAwMCA0
OCBjNyBjNiBlMCAzOCAyZSBhMCA0OCBjNyBjNyA5MyA5OSAzMSBhMCA4OSA1NCAyNCAyMCA0OCA4
OSA0NCAyNCAwOCBlOCA4MiBhMiBmNSBlMCA8MGY+IDBiIDhiIDU0IDI0IDIwIDQ4IDhiIDQ0IDI0
IDA4IDQ4IDhiIDQwIDQ4IDgwIDc4IDEyIDAwIDBmIDg1IDc2Cjw0PiBbMjAxLjc0Mjk4MV0gUlNQ
OiAwMDE4OmZmZmZjOTAwMDA2NGY5YTggRUZMQUdTOiAwMDAxMDI4Mgo8ND4gWzIwMS43NDI5ODNd
IFJBWDogMDAwMDAwMDAwMDAwMDAwMCBSQlg6IDAwMDAwMDAwMDAwMDAwMDAgUkNYOiAwMDAwMDAw
MDAwMDAwMDA3Cjw0PiBbMjAxLjc0Mjk4NF0gUkRYOiAwMDAwMDAwMDAwMDAxNzVjIFJTSTogZmZm
Zjg4ODQ5MzRkNDhlMCBSREk6IGZmZmZmZmZmODIxMmRmNDkKPDQ+IFsyMDEuNzQyOTg1XSBSQlA6
IGZmZmY4ODg0OTM0MDg1NTggUjA4OiAwMDAwMDAwMGI1NmRhYjQ0IFIwOTogMDAwMDAwMDAwMDAw
MDAwMAo8ND4gWzIwMS43NDI5ODZdIFIxMDogZmZmZjg4ODQ4YmUwMDAwMCBSMTE6IDAwMDAwMDAw
MDAwMDAwMDAgUjEyOiBmZmZmODg4NDlhZmQ4OWY4Cjw0PiBbMjAxLjc0Mjk4N10gUjEzOiBmZmZm
ODg4NDdlYWY2N2U4IFIxNDogZmZmZjg4ODQ4YzM0NGE4OCBSMTU6IGZmZmY4ODg0OGJlMDAwMDAK
PDQ+IFsyMDEuNzQyOTg4XSBGUzogIDAwMDA3ZjRkOWI2MGI3MDAoMDAwMCkgR1M6ZmZmZjg4ODQ5
ZmY4MDAwMCgwMDAwKSBrbmxHUzowMDAwMDAwMDAwMDAwMDAwCjw0PiBbMjAxLjc0Mjk4OV0gQ1M6
ICAwMDEwIERTOiAwMDAwIEVTOiAwMDAwIENSMDogMDAwMDAwMDA4MDA1MDAzMwo8ND4gWzIwMS43
NDI5OTFdIENSMjogMDAwMDdmNGQ5YjYwOWZmOCBDUjM6IDAwMDAwMDA0OGMzMjYwMDYgQ1I0OiAw
MDAwMDAwMDAwNzYwZWUwCjw0PiBbMjAxLjc0Mjk5Ml0gUEtSVTogNTU1NTU1NTQKPDQ+IFsyMDEu
NzQyOTkzXSBDYWxsIFRyYWNlOgo8ND4gWzIwMS43NDMwMjFdICA/IGludGVsX2F0b21pY19jaGVj
aysweDdiMi8weDE0NDAgW2k5MTVdCjw0PiBbMjAxLjc0MzAyNl0gID8gX19tdXRleF91bmxvY2tf
c2xvd3BhdGgrMHg0Ni8weDJiMAo8ND4gWzIwMS43NDMwNTJdICBpbnRlbF9hdG9taWNfY2hlY2sr
MHg3Y2EvMHgxNDQwIFtpOTE1XQo8ND4gWzIwMS43NDMwNjBdICBkcm1fYXRvbWljX2NoZWNrX29u
bHkrMHg1NWEvMHg3ZjAKPDQ+IFsyMDEuNzQzMDY0XSAgZHJtX2F0b21pY19jb21taXQrMHhlLzB4
NTAKPDQ+IFsyMDEuNzQzMDY3XSAgZHJtX2F0b21pY19jb25uZWN0b3JfY29tbWl0X2RwbXMrMHhl
MC8weGYwCjw0PiBbMjAxLjc0MzA2OV0gIHNldF9wcm9wZXJ0eV9hdG9taWMrMHhiYS8weDE0MAo8
ND4gWzIwMS43NDMwNzVdICBkcm1fbW9kZV9vYmpfc2V0X3Byb3BlcnR5X2lvY3RsKzB4MTExLzB4
MWQwCjw0PiBbMjAxLjc0MzA3N10gID8gZHJtX2Rldl9leGl0KzB4OC8weDQwCjw0PiBbMjAxLjc0
MzA4MF0gID8gZHJtX2Nvbm5lY3Rvcl9zZXRfb2JqX3Byb3ArMHg3MC8weDcwCjw0PiBbMjAxLjc0
MzA4Ml0gIGRybV9jb25uZWN0b3JfcHJvcGVydHlfc2V0X2lvY3RsKzB4MzkvMHg2MAo8ND4gWzIw
MS43NDMwODRdICBkcm1faW9jdGxfa2VybmVsKzB4ODMvMHhmMAo8ND4gWzIwMS43NDMwODddICBk
cm1faW9jdGwrMHgyZjMvMHgzYjAKPDQ+IFsyMDEuNzQzMDkwXSAgPyBkcm1fY29ubmVjdG9yX3Nl
dF9vYmpfcHJvcCsweDcwLzB4NzAKPDQ+IFsyMDEuNzQzMDk2XSAgPyBsb2NrX2FjcXVpcmUrMHhh
Ni8weDFjMAo8ND4gWzIwMS43NDMxMDBdICBkb192ZnNfaW9jdGwrMHhhMC8weDZlMAo8ND4gWzIw
MS43NDMxMDNdICA/IF9fZmdldCsweDEwZi8weDIwMAo8ND4gWzIwMS43NDMxMDVdICBrc3lzX2lv
Y3RsKzB4MzUvMHg2MAo8ND4gWzIwMS43NDMxMDhdICBfX3g2NF9zeXNfaW9jdGwrMHgxMS8weDIw
Cjw0PiBbMjAxLjc0MzExMF0gIGRvX3N5c2NhbGxfNjQrMHg1NS8weDFjMAo8ND4gWzIwMS43NDMx
MTJdICBlbnRyeV9TWVNDQUxMXzY0X2FmdGVyX2h3ZnJhbWUrMHg0OS8weGJlCjw0PiBbMjAxLjc0
MzExNF0gUklQOiAwMDMzOjB4N2Y0ZGE2YzhkNWQ3Cjw0PiBbMjAxLjc0MzExNV0gQ29kZTogYjMg
NjYgOTAgNDggOGIgMDUgYjEgNDggMmQgMDAgNjQgYzcgMDAgMjYgMDAgMDAgMDAgNDggYzcgYzAg
ZmYgZmYgZmYgZmYgYzMgNjYgMmUgMGYgMWYgODQgMDAgMDAgMDAgMDAgMDAgYjggMTAgMDAgMDAg
MDAgMGYgMDUgPDQ4PiAzZCAwMSBmMCBmZiBmZiA3MyAwMSBjMyA0OCA4YiAwZCA4MSA0OCAyZCAw
MCBmNyBkOCA2NCA4OSAwMSA0OAo8ND4gWzIwMS43NDMxMTZdIFJTUDogMDAyYjowMDAwN2Y0ZDli
NjBhYmE4IEVGTEFHUzogMDAwMDAyNDYgT1JJR19SQVg6IDAwMDAwMDAwMDAwMDAwMTAKPDQ+IFsy
MDEuNzQzMTE4XSBSQVg6IGZmZmZmZmZmZmZmZmZmZGEgUkJYOiAwMDAwN2Y0ZDk0MDAxYWMwIFJD
WDogMDAwMDdmNGRhNmM4ZDVkNwo8ND4gWzIwMS43NDMxMTldIFJEWDogMDAwMDdmNGQ5YjYwYWJl
MCBSU0k6IDAwMDAwMDAwYzAxMDY0YWIgUkRJOiAwMDAwMDAwMDAwMDAwMDA1Cjw0PiBbMjAxLjc0
MzEyMF0gUkJQOiAwMDAwN2Y0ZDliNjBhYmUwIFIwODogMDAwMDdmNGQ5NDAwMTVjMCBSMDk6IDAw
MDA3ZjRkOTQwMDE1ZjAKPDQ+IFsyMDEuNzQzMTIxXSBSMTA6IDAwMDAwMDAwMDAwMDAwNTUgUjEx
OiAwMDAwMDAwMDAwMDAwMjQ2IFIxMjogMDAwMDAwMDBjMDEwNjRhYgo8ND4gWzIwMS43NDMxMjJd
IFIxMzogMDAwMDAwMDAwMDAwMDAwNSBSMTQ6IDAwMDAwMDAwMDAwMDAwMDUgUjE1OiAwMDAwN2Y0
ZGE3YTJjMGM3Cjw0PiBbMjAxLjc0MzE1Nl0gaXJxIGV2ZW50IHN0YW1wOiAzNjIKPDQ+IFsyMDEu
NzQzMTYyXSBoYXJkaXJxcyBsYXN0ICBlbmFibGVkIGF0ICgzNjEpOiBbPGZmZmZmZmZmODExMjg2
MmM+XSB2cHJpbnRrX2VtaXQrMHhjYy8weDM0MAo8ND4gWzIwMS43NDMxNjhdIGhhcmRpcnFzIGxh
c3QgZGlzYWJsZWQgYXQgKDM2Mik6IFs8ZmZmZmZmZmY4MTAwMTllMD5dIHRyYWNlX2hhcmRpcnFz
X29mZl90aHVuaysweDFhLzB4MWMKPDQ+IFsyMDEuNzQzMTc0XSBzb2Z0aXJxcyBsYXN0ICBlbmFi
bGVkIGF0ICgwKTogWzxmZmZmZmZmZjgxMGFiZjc4Pl0gY29weV9wcm9jZXNzLnBhcnQuNisweDRl
OC8weDFkYzAKPDQ+IFsyMDEuNzQzMTc4XSBzb2Z0aXJxcyBsYXN0IGRpc2FibGVkIGF0ICgwKTog
WzwwMDAwMDAwMDAwMDAwMDAwPl0gMHgwCjw0PiBbMjAxLjc0MzI0M10gV0FSTklORzogQ1BVOiA3
IFBJRDogMTI2OCBhdCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5jOjUwNjggc2tsX2Nv
bXB1dGVfd20rMHgyYmUvMHgxMGEwIFtpOTE1XQo8ND4gWzIwMS43NDMyNDZdIC0tLVsgZW5kIHRy
YWNlIDMzZTY3MDMwODczNzZlZmEgXS0tLQoKU2lnbmVkLW9mZi1ieTogTWFhcnRlbiBMYW5raG9y
c3QgPG1hYXJ0ZW4ubGFua2hvcnN0QGxpbnV4LmludGVsLmNvbT4KQnVnemlsbGE6IGh0dHBzOi8v
YnVncy5mcmVlZGVza3RvcC5vcmcvc2hvd19idWcuY2dpP2lkPTExMDg5NQpUZXN0Y2FzZToga21z
X2NoYW1lbGl1bUBoZG1pLWNtcC1udjEyCi0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
cG0uYyB8IDggKysrKy0tLS0KIDEgZmlsZSBjaGFuZ2VkLCA0IGluc2VydGlvbnMoKyksIDQgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMKaW5kZXggNGU1MmRhZDg0ZDY0Li5lMGU1
N2RlMjIzODggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYwpAQCAtNTA2MCwxNSArNTA2MCwxNSBA
QCBzdGF0aWMgaW50IGljbF9idWlsZF9wbGFuZV93bShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSwKIAllbnVtIHBsYW5lX2lkIHBsYW5lX2lkID0gdG9faW50ZWxfcGxhbmUocGxh
bmVfc3RhdGUtPmJhc2UucGxhbmUpLT5pZDsKIAlpbnQgcmV0OwogCi0JLyogV2F0ZXJtYXJrcyBj
YWxjdWxhdGVkIGluIG1hc3RlciAqLwotCWlmIChwbGFuZV9zdGF0ZS0+c2xhdmUpCisJLyogV2F0
ZXJtYXJrcyBhcmUgY2FsY3VsYXRlZCBpbiBtYXN0ZXIgKi8KKwlpZiAocGxhbmVfc3RhdGUtPnNs
YXZlIHx8CisJICAgICFpbnRlbF93bV9wbGFuZV92aXNpYmxlKGNydGNfc3RhdGUsIHBsYW5lX3N0
YXRlKSkKIAkJcmV0dXJuIDA7CiAKIAlpZiAocGxhbmVfc3RhdGUtPmxpbmtlZF9wbGFuZSkgewog
CQljb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IHBsYW5lX3N0YXRlLT5iYXNlLmZi
OwogCQllbnVtIHBsYW5lX2lkIHlfcGxhbmVfaWQgPSBwbGFuZV9zdGF0ZS0+bGlua2VkX3BsYW5l
LT5pZDsKIAotCQlXQVJOX09OKCFpbnRlbF93bV9wbGFuZV92aXNpYmxlKGNydGNfc3RhdGUsIHBs
YW5lX3N0YXRlKSk7CiAJCVdBUk5fT04oIWZiLT5mb3JtYXQtPmlzX3l1diB8fAogCQkJZmItPmZv
cm1hdC0+bnVtX3BsYW5lcyA9PSAxKTsKIApAQCAtNTA4MSw3ICs1MDgxLDcgQEAgc3RhdGljIGlu
dCBpY2xfYnVpbGRfcGxhbmVfd20oc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
CiAJCQkJCQlwbGFuZV9pZCwgMSk7CiAJCWlmIChyZXQpCiAJCQlyZXR1cm4gcmV0OwotCX0gZWxz
ZSBpZiAoaW50ZWxfd21fcGxhbmVfdmlzaWJsZShjcnRjX3N0YXRlLCBwbGFuZV9zdGF0ZSkpIHsK
Kwl9IGVsc2UgewogCQlyZXQgPSBza2xfYnVpbGRfcGxhbmVfd21fc2luZ2xlKGNydGNfc3RhdGUs
IHBsYW5lX3N0YXRlLAogCQkJCQkJcGxhbmVfaWQsIDApOwogCQlpZiAocmV0KQotLSAKMi4yMC4x
CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1n
ZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9s
aXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

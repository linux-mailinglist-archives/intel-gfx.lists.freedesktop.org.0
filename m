Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 92F0B3C711
	for <lists+intel-gfx@lfdr.de>; Tue, 11 Jun 2019 11:12:46 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F26FE89174;
	Tue, 11 Jun 2019 09:12:44 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 476E48916F
 for <intel-gfx@lists.freedesktop.org>; Tue, 11 Jun 2019 09:12:41 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16860890-1500050 
 for <intel-gfx@lists.freedesktop.org>; Tue, 11 Jun 2019 10:12:37 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 11 Jun 2019 10:12:37 +0100
Message-Id: <20190611091238.15808-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
MIME-Version: 1.0
Subject: [Intel-gfx] [CI 1/2] drm/i915: Pull kref into i915_address_space
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

TWFrZSB0aGUga3JlZiBjb21tb24gdG8gYm90aCBkZXJpdmVkIHN0cnVjdHMgKGk5MTVfZ2d0dCBh
bmQgaTkxNV9wcGd0dCkKc28gdGhhdCB3ZSBjYW4gc2FmZWx5IHJlZmVyZW5jZSBjb3VudCBhbiBh
YnN0cmFjdCBjdHgtPnZtIGFkZHJlc3Mgc3BhY2UuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxz
b24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KUmV2aWV3ZWQtYnk6IE1hdHRoZXcgQXVsZCA8
bWF0dGhldy5hdWxkQGludGVsLmNvbT4KLS0tCiAuLi4vZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9jbGllbnRfYmx0LmMgICAgfCAgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV9jb250ZXh0LmMgICB8IDEzMiArKysrKysrKystLS0tLS0tLS0KIC4uLi9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaCB8ICAgNiArLQogLi4uL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jICAgIHwgICA0ICstCiAuLi4vZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9vYmplY3RfYmx0LmMgICAgfCAgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV91c2VycHRyLmMgICB8ICAgNiArLQogLi4uL2dwdS9kcm0vaTkxNS9n
ZW0vc2VsZnRlc3RzL2h1Z2VfcGFnZXMuYyAgIHwgIDI2ICsrLS0KIC4uLi9kcm0vaTkxNS9nZW0v
c2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQuYyB8ICAzNiArKystLQogLi4uL2dwdS9kcm0vaTkx
NS9nZW0vc2VsZnRlc3RzL21vY2tfY29udGV4dC5jIHwgICAzICstCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9scmMuYyAgICAgICAgICAgfCAgIDkgKy0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX3JpbmdidWZmZXIuYyAgICB8ICAyNiArKy0tCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hlY2suYyAgfCAgIDcgKy0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L3NlbGZ0ZXN0X2xyYy5jICAgICAgICB8ICAgMiArLQogLi4uL2dwdS9kcm0vaTkxNS9n
dC9zZWxmdGVzdF93b3JrYXJvdW5kcy5jICAgIHwgIDEwICstCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndnQvc2NoZWR1bGVyLmMgICAgICAgICAgfCAgIDggKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZGVidWdmcy5jICAgICAgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9kcnYuaCAgICAgICAgICAgICAgIHwgICA2IC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfZ2VtX2d0dC5jICAgICAgICAgICB8ICAzNSArKy0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9nZW1fZ3R0LmggICAgICAgICAgIHwgIDI3ICsrLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZ3B1X2Vycm9yLmMgICAgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV90cmFjZS5oICAgICAgICAgICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9z
ZWxmdGVzdHMvaTkxNV9nZW1fZ3R0LmMgfCAgMTAgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L3Nl
bGZ0ZXN0cy9pOTE1X3JlcXVlc3QuYyB8ICAgMyArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvc2Vs
ZnRlc3RzL2k5MTVfdm1hLmMgICAgIHwgICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxm
dGVzdHMvaWd0X3NwaW5uZXIuYyAgfCAgIDUgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0
ZXN0cy9tb2NrX2d0dC5jICAgICB8ICAgMSAtCiAyNiBmaWxlcyBjaGFuZ2VkLCAxODggaW5zZXJ0
aW9ucygrKSwgMTkyIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9jbGllbnRfYmx0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fY2xpZW50X2JsdC5jCmluZGV4IDQ4OTljYTFkZDc2Yy4uZjI1M2VjNTc2NWFkIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY2xpZW50X2JsdC5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jbGllbnRfYmx0LmMKQEAg
LTI1MCwxMyArMjUwLDExIEBAIGludCBpOTE1X2dlbV9zY2hlZHVsZV9maWxsX3BhZ2VzX2JsdChz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogewogCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShvYmotPmJhc2UuZGV2KTsKIAlzdHJ1Y3QgaTkxNV9nZW1fY29u
dGV4dCAqY3R4ID0gY2UtPmdlbV9jb250ZXh0OwotCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2Ug
KnZtOworCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0gY3R4LT52bSA/OiAmaTkxNS0+
Z2d0dC52bTsKIAlzdHJ1Y3QgY2xlYXJfcGFnZXNfd29yayAqd29yazsKIAlzdHJ1Y3QgaTkxNV9z
bGVldmUgKnNsZWV2ZTsKIAlpbnQgZXJyOwogCi0Jdm0gPSBjdHgtPnBwZ3R0ID8gJmN0eC0+cHBn
dHQtPnZtIDogJmk5MTUtPmdndHQudm07Ci0KIAlzbGVldmUgPSBjcmVhdGVfc2xlZXZlKHZtLCBv
YmosIHBhZ2VzLCBwYWdlX3NpemVzKTsKIAlpZiAoSVNfRVJSKHNsZWV2ZSkpCiAJCXJldHVybiBQ
VFJfRVJSKHNsZWV2ZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fY29udGV4dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRl
eHQuYwppbmRleCBkZDlhYTc3ZTM4YWUuLjc1YjBkMWRiYjIxNSAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCkBAIC0zMDksNyArMzA5LDggQEAgc3RhdGlj
IHZvaWQgaTkxNV9nZW1fY29udGV4dF9mcmVlKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgp
CiAJR0VNX0JVR19PTighaTkxNV9nZW1fY29udGV4dF9pc19jbG9zZWQoY3R4KSk7CiAKIAlyZWxl
YXNlX2h3X2lkKGN0eCk7Ci0JaTkxNV9wcGd0dF9wdXQoY3R4LT5wcGd0dCk7CisJaWYgKGN0eC0+
dm0pCisJCWk5MTVfdm1fcHV0KGN0eC0+dm0pOwogCiAJZnJlZV9lbmdpbmVzKHJjdV9hY2Nlc3Nf
cG9pbnRlcihjdHgtPmVuZ2luZXMpKTsKIAltdXRleF9kZXN0cm95KCZjdHgtPmVuZ2luZXNfbXV0
ZXgpOwpAQCAtMzk3LDcgKzM5OCw3IEBAIHN0YXRpYyB2b2lkIGNvbnRleHRfY2xvc2Uoc3RydWN0
IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKIH0KIAogc3RhdGljIHUzMiBkZWZhdWx0X2Rlc2NfdGVt
cGxhdGUoY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCi0JCQkJIGNvbnN0IHN0
cnVjdCBpOTE1X2h3X3BwZ3R0ICpwcGd0dCkKKwkJCQkgY29uc3Qgc3RydWN0IGk5MTVfYWRkcmVz
c19zcGFjZSAqdm0pCiB7CiAJdTMyIGFkZHJlc3NfbW9kZTsKIAl1MzIgZGVzYzsKQEAgLTQwNSw3
ICs0MDYsNyBAQCBzdGF0aWMgdTMyIGRlZmF1bHRfZGVzY190ZW1wbGF0ZShjb25zdCBzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAlkZXNjID0gR0VOOF9DVFhfVkFMSUQgfCBHRU44X0NU
WF9QUklWSUxFR0U7CiAKIAlhZGRyZXNzX21vZGUgPSBJTlRFTF9MRUdBQ1lfMzJCX0NPTlRFWFQ7
Ci0JaWYgKHBwZ3R0ICYmIGk5MTVfdm1faXNfNGx2bCgmcHBndHQtPnZtKSkKKwlpZiAodm0gJiYg
aTkxNV92bV9pc180bHZsKHZtKSkKIAkJYWRkcmVzc19tb2RlID0gSU5URUxfTEVHQUNZXzY0Ql9D
T05URVhUOwogCWRlc2MgfD0gYWRkcmVzc19tb2RlIDw8IEdFTjhfQ1RYX0FERFJFU1NJTkdfTU9E
RV9TSElGVDsKIApAQCAtNDIxLDcgKzQyMiw3IEBAIHN0YXRpYyB1MzIgZGVmYXVsdF9kZXNjX3Rl
bXBsYXRlKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogfQogCiBzdGF0aWMg
c3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKgotX19jcmVhdGVfY29udGV4dChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCitfX2NyZWF0ZV9jb250ZXh0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQogewogCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7CiAJc3RydWN0
IGk5MTVfZ2VtX2VuZ2luZXMgKmU7CkBAIC00MzMsOCArNDM0LDggQEAgX19jcmVhdGVfY29udGV4
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJCXJldHVybiBFUlJfUFRSKC1F
Tk9NRU0pOwogCiAJa3JlZl9pbml0KCZjdHgtPnJlZik7Ci0JbGlzdF9hZGRfdGFpbCgmY3R4LT5s
aW5rLCAmZGV2X3ByaXYtPmNvbnRleHRzLmxpc3QpOwotCWN0eC0+aTkxNSA9IGRldl9wcml2Owor
CWxpc3RfYWRkX3RhaWwoJmN0eC0+bGluaywgJmk5MTUtPmNvbnRleHRzLmxpc3QpOworCWN0eC0+
aTkxNSA9IGk5MTU7CiAJY3R4LT5zY2hlZC5wcmlvcml0eSA9IEk5MTVfVVNFUl9QUklPUklUWShJ
OTE1X1BSSU9SSVRZX05PUk1BTCk7CiAJbXV0ZXhfaW5pdCgmY3R4LT5tdXRleCk7CiAKQEAgLTQ1
MiwxNCArNDUzLDE0IEBAIF9fY3JlYXRlX2NvbnRleHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQogCS8qIE5COiBNYXJrIGFsbCBzbGljZXMgYXMgbmVlZGluZyBhIHJlbWFwIHNv
IHRoYXQgd2hlbiB0aGUgY29udGV4dCBmaXJzdAogCSAqIGxvYWRzIGl0IHdpbGwgcmVzdG9yZSB3
aGF0ZXZlciByZW1hcCBzdGF0ZSBhbHJlYWR5IGV4aXN0cy4gSWYgdGhlcmUKIAkgKiBpcyBubyBy
ZW1hcCBpbmZvLCBpdCB3aWxsIGJlIGEgTk9QLiAqLwotCWN0eC0+cmVtYXBfc2xpY2UgPSBBTExf
TDNfU0xJQ0VTKGRldl9wcml2KTsKKwljdHgtPnJlbWFwX3NsaWNlID0gQUxMX0wzX1NMSUNFUyhp
OTE1KTsKIAogCWk5MTVfZ2VtX2NvbnRleHRfc2V0X2Jhbm5hYmxlKGN0eCk7CiAJaTkxNV9nZW1f
Y29udGV4dF9zZXRfcmVjb3ZlcmFibGUoY3R4KTsKIAogCWN0eC0+cmluZ19zaXplID0gNCAqIFBB
R0VfU0laRTsKIAljdHgtPmRlc2NfdGVtcGxhdGUgPQotCQlkZWZhdWx0X2Rlc2NfdGVtcGxhdGUo
ZGV2X3ByaXYsIGRldl9wcml2LT5tbS5hbGlhc2luZ19wcGd0dCk7CisJCWRlZmF1bHRfZGVzY190
ZW1wbGF0ZShpOTE1LCAmaTkxNS0+bW0uYWxpYXNpbmdfcHBndHQtPnZtKTsKIAogCWZvciAoaSA9
IDA7IGkgPCBBUlJBWV9TSVpFKGN0eC0+aGFuZ190aW1lc3RhbXApOyBpKyspCiAJCWN0eC0+aGFu
Z190aW1lc3RhbXBbaV0gPSBqaWZmaWVzIC0gQ09OVEVYVF9GQVNUX0hBTkdfSklGRklFUzsKQEAg
LTQ3MSwyNiArNDcyLDI2IEBAIF9fY3JlYXRlX2NvbnRleHQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQogCXJldHVybiBFUlJfUFRSKGVycik7CiB9CiAKLXN0YXRpYyBzdHJ1Y3Qg
aTkxNV9od19wcGd0dCAqCi1fX3NldF9wcGd0dChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4
LCBzdHJ1Y3QgaTkxNV9od19wcGd0dCAqcHBndHQpCitzdGF0aWMgc3RydWN0IGk5MTVfYWRkcmVz
c19zcGFjZSAqCitfX3NldF9wcGd0dChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LCBzdHJ1
Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSkKIHsKLQlzdHJ1Y3QgaTkxNV9od19wcGd0dCAqb2xk
ID0gY3R4LT5wcGd0dDsKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICpvbGQgPSBjdHgtPnZt
OwogCi0JY3R4LT5wcGd0dCA9IGk5MTVfcHBndHRfZ2V0KHBwZ3R0KTsKLQljdHgtPmRlc2NfdGVt
cGxhdGUgPSBkZWZhdWx0X2Rlc2NfdGVtcGxhdGUoY3R4LT5pOTE1LCBwcGd0dCk7CisJY3R4LT52
bSA9IGk5MTVfdm1fZ2V0KHZtKTsKKwljdHgtPmRlc2NfdGVtcGxhdGUgPSBkZWZhdWx0X2Rlc2Nf
dGVtcGxhdGUoY3R4LT5pOTE1LCB2bSk7CiAKIAlyZXR1cm4gb2xkOwogfQogCiBzdGF0aWMgdm9p
ZCBfX2Fzc2lnbl9wcGd0dChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAotCQkJICAgc3Ry
dWN0IGk5MTVfaHdfcHBndHQgKnBwZ3R0KQorCQkJICAgc3RydWN0IGk5MTVfYWRkcmVzc19zcGFj
ZSAqdm0pCiB7Ci0JaWYgKHBwZ3R0ID09IGN0eC0+cHBndHQpCisJaWYgKHZtID09IGN0eC0+dm0p
CiAJCXJldHVybjsKIAotCXBwZ3R0ID0gX19zZXRfcHBndHQoY3R4LCBwcGd0dCk7Ci0JaWYgKHBw
Z3R0KQotCQlpOTE1X3BwZ3R0X3B1dChwcGd0dCk7CisJdm0gPSBfX3NldF9wcGd0dChjdHgsIHZt
KTsKKwlpZiAodm0pCisJCWk5MTVfdm1fcHV0KHZtKTsKIH0KIAogc3RhdGljIHN0cnVjdCBpOTE1
X2dlbV9jb250ZXh0ICoKQEAgLTUyMiw4ICs1MjMsOCBAQCBpOTE1X2dlbV9jcmVhdGVfY29udGV4
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHVuc2lnbmVkIGludCBmbGFncykK
IAkJCXJldHVybiBFUlJfQ0FTVChwcGd0dCk7CiAJCX0KIAotCQlfX2Fzc2lnbl9wcGd0dChjdHgs
IHBwZ3R0KTsKLQkJaTkxNV9wcGd0dF9wdXQocHBndHQpOworCQlfX2Fzc2lnbl9wcGd0dChjdHgs
ICZwcGd0dC0+dm0pOworCQlpOTE1X3ZtX3B1dCgmcHBndHQtPnZtKTsKIAl9CiAKIAlpZiAoZmxh
Z3MgJiBJOTE1X0NPTlRFWFRfQ1JFQVRFX0ZMQUdTX1NJTkdMRV9USU1FTElORSkgewpAQCAtNzIz
LDcgKzcyNCw3IEBAIHN0YXRpYyBpbnQgY29udGV4dF9pZHJfY2xlYW51cChpbnQgaWQsIHZvaWQg
KnAsIHZvaWQgKmRhdGEpCiAKIHN0YXRpYyBpbnQgdm1faWRyX2NsZWFudXAoaW50IGlkLCB2b2lk
ICpwLCB2b2lkICpkYXRhKQogewotCWk5MTVfcHBndHRfcHV0KHApOworCWk5MTVfdm1fcHV0KHAp
OwogCXJldHVybiAwOwogfQogCkBAIC03MzMsOCArNzM0LDggQEAgc3RhdGljIGludCBnZW1fY29u
dGV4dF9yZWdpc3RlcihzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAogCWludCByZXQ7CiAK
IAljdHgtPmZpbGVfcHJpdiA9IGZwcml2OwotCWlmIChjdHgtPnBwZ3R0KQotCQljdHgtPnBwZ3R0
LT52bS5maWxlID0gZnByaXY7CisJaWYgKGN0eC0+dm0pCisJCWN0eC0+dm0tPmZpbGUgPSBmcHJp
djsKIAogCWN0eC0+cGlkID0gZ2V0X3Rhc2tfcGlkKGN1cnJlbnQsIFBJRFRZUEVfUElEKTsKIAlj
dHgtPm5hbWUgPSBrYXNwcmludGYoR0ZQX0tFUk5FTCwgIiVzWyVkXSIsCkBAIC04NDQsNyArODQ1
LDcgQEAgaW50IGk5MTVfZ2VtX3ZtX2NyZWF0ZV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
LCB2b2lkICpkYXRhLAogCWlmIChlcnIpCiAJCWdvdG8gZXJyX3B1dDsKIAotCWVyciA9IGlkcl9h
bGxvYygmZmlsZV9wcml2LT52bV9pZHIsIHBwZ3R0LCAwLCAwLCBHRlBfS0VSTkVMKTsKKwllcnIg
PSBpZHJfYWxsb2MoJmZpbGVfcHJpdi0+dm1faWRyLCAmcHBndHQtPnZtLCAwLCAwLCBHRlBfS0VS
TkVMKTsKIAlpZiAoZXJyIDwgMCkKIAkJZ290byBlcnJfdW5sb2NrOwogCkBAIC04NTgsNyArODU5
LDcgQEAgaW50IGk5MTVfZ2VtX3ZtX2NyZWF0ZV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
LCB2b2lkICpkYXRhLAogZXJyX3VubG9jazoKIAltdXRleF91bmxvY2soJmZpbGVfcHJpdi0+dm1f
aWRyX2xvY2spOwogZXJyX3B1dDoKLQlpOTE1X3BwZ3R0X3B1dChwcGd0dCk7CisJaTkxNV92bV9w
dXQoJnBwZ3R0LT52bSk7CiAJcmV0dXJuIGVycjsKIH0KIApAQCAtODY3LDcgKzg2OCw3IEBAIGlu
dCBpOTE1X2dlbV92bV9kZXN0cm95X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQg
KmRhdGEsCiB7CiAJc3RydWN0IGRybV9pOTE1X2ZpbGVfcHJpdmF0ZSAqZmlsZV9wcml2ID0gZmls
ZS0+ZHJpdmVyX3ByaXY7CiAJc3RydWN0IGRybV9pOTE1X2dlbV92bV9jb250cm9sICphcmdzID0g
ZGF0YTsKLQlzdHJ1Y3QgaTkxNV9od19wcGd0dCAqcHBndHQ7CisJc3RydWN0IGk5MTVfYWRkcmVz
c19zcGFjZSAqdm07CiAJaW50IGVycjsKIAl1MzIgaWQ7CiAKQEAgLTg4NSwxMyArODg2LDEzIEBA
IGludCBpOTE1X2dlbV92bV9kZXN0cm95X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZv
aWQgKmRhdGEsCiAJaWYgKGVycikKIAkJcmV0dXJuIGVycjsKIAotCXBwZ3R0ID0gaWRyX3JlbW92
ZSgmZmlsZV9wcml2LT52bV9pZHIsIGlkKTsKKwl2bSA9IGlkcl9yZW1vdmUoJmZpbGVfcHJpdi0+
dm1faWRyLCBpZCk7CiAKIAltdXRleF91bmxvY2soJmZpbGVfcHJpdi0+dm1faWRyX2xvY2spOwot
CWlmICghcHBndHQpCisJaWYgKCF2bSkKIAkJcmV0dXJuIC1FTk9FTlQ7CiAKLQlpOTE1X3BwZ3R0
X3B1dChwcGd0dCk7CisJaTkxNV92bV9wdXQodm0pOwogCXJldHVybiAwOwogfQogCkBAIC05ODEs
MTAgKzk4MiwxMCBAQCBzdGF0aWMgaW50IGdldF9wcGd0dChzdHJ1Y3QgZHJtX2k5MTVfZmlsZV9w
cml2YXRlICpmaWxlX3ByaXYsCiAJCSAgICAgc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwK
IAkJICAgICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2NvbnRleHRfcGFyYW0gKmFyZ3MpCiB7Ci0Jc3Ry
dWN0IGk5MTVfaHdfcHBndHQgKnBwZ3R0OworCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZt
OwogCWludCByZXQ7CiAKLQlpZiAoIWN0eC0+cHBndHQpCisJaWYgKCFjdHgtPnZtKQogCQlyZXR1
cm4gLUVOT0RFVjsKIAogCS8qIFhYWCByY3UgYWNxdWlyZT8gKi8KQEAgLTk5MiwxOSArOTkzLDE5
IEBAIHN0YXRpYyBpbnQgZ2V0X3BwZ3R0KHN0cnVjdCBkcm1faTkxNV9maWxlX3ByaXZhdGUgKmZp
bGVfcHJpdiwKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCi0JcHBndHQgPSBpOTE1X3BwZ3R0
X2dldChjdHgtPnBwZ3R0KTsKKwl2bSA9IGk5MTVfdm1fZ2V0KGN0eC0+dm0pOwogCW11dGV4X3Vu
bG9jaygmY3R4LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAogCXJldCA9IG11dGV4X2xvY2tf
aW50ZXJydXB0aWJsZSgmZmlsZV9wcml2LT52bV9pZHJfbG9jayk7CiAJaWYgKHJldCkKIAkJZ290
byBlcnJfcHV0OwogCi0JcmV0ID0gaWRyX2FsbG9jKCZmaWxlX3ByaXYtPnZtX2lkciwgcHBndHQs
IDAsIDAsIEdGUF9LRVJORUwpOworCXJldCA9IGlkcl9hbGxvYygmZmlsZV9wcml2LT52bV9pZHIs
IHZtLCAwLCAwLCBHRlBfS0VSTkVMKTsKIAlHRU1fQlVHX09OKCFyZXQpOwogCWlmIChyZXQgPCAw
KQogCQlnb3RvIGVycl91bmxvY2s7CiAKLQlpOTE1X3BwZ3R0X2dldChwcGd0dCk7CisJaTkxNV92
bV9nZXQodm0pOwogCiAJYXJncy0+c2l6ZSA9IDA7CiAJYXJncy0+dmFsdWUgPSByZXQ7CkBAIC0x
MDEzLDI5ICsxMDE0LDMwIEBAIHN0YXRpYyBpbnQgZ2V0X3BwZ3R0KHN0cnVjdCBkcm1faTkxNV9m
aWxlX3ByaXZhdGUgKmZpbGVfcHJpdiwKIGVycl91bmxvY2s6CiAJbXV0ZXhfdW5sb2NrKCZmaWxl
X3ByaXYtPnZtX2lkcl9sb2NrKTsKIGVycl9wdXQ6Ci0JaTkxNV9wcGd0dF9wdXQocHBndHQpOwor
CWk5MTVfdm1fcHV0KHZtKTsKIAlyZXR1cm4gcmV0OwogfQogCiBzdGF0aWMgdm9pZCBzZXRfcHBn
dHRfYmFycmllcih2b2lkICpkYXRhKQogewotCXN0cnVjdCBpOTE1X2h3X3BwZ3R0ICpvbGQgPSBk
YXRhOworCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKm9sZCA9IGRhdGE7CiAKLQlpZiAoSU5U
RUxfR0VOKG9sZC0+dm0uaTkxNSkgPCA4KQotCQlnZW42X3BwZ3R0X3VucGluX2FsbChvbGQpOwor
CWlmIChJTlRFTF9HRU4ob2xkLT5pOTE1KSA8IDgpCisJCWdlbjZfcHBndHRfdW5waW5fYWxsKGk5
MTVfdm1fdG9fcHBndHQob2xkKSk7CiAKLQlpOTE1X3BwZ3R0X3B1dChvbGQpOworCWk5MTVfdm1f
cHV0KG9sZCk7CiB9CiAKIHN0YXRpYyBpbnQgZW1pdF9wcGd0dF91cGRhdGUoc3RydWN0IGk5MTVf
cmVxdWVzdCAqcnEsIHZvaWQgKmRhdGEpCiB7Ci0Jc3RydWN0IGk5MTVfaHdfcHBndHQgKnBwZ3R0
ID0gcnEtPmdlbV9jb250ZXh0LT5wcGd0dDsKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2
bSA9IHJxLT5nZW1fY29udGV4dC0+dm07CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
ID0gcnEtPmVuZ2luZTsKIAl1MzIgYmFzZSA9IGVuZ2luZS0+bW1pb19iYXNlOwogCXUzMiAqY3M7
CiAJaW50IGk7CiAKLQlpZiAoaTkxNV92bV9pc180bHZsKCZwcGd0dC0+dm0pKSB7CisJaWYgKGk5
MTVfdm1faXNfNGx2bCh2bSkpIHsKKwkJc3RydWN0IGk5MTVfaHdfcHBndHQgKnBwZ3R0ID0gaTkx
NV92bV90b19wcGd0dCh2bSk7CiAJCWNvbnN0IGRtYV9hZGRyX3QgcGRfZGFkZHIgPSBweF9kbWEo
JnBwZ3R0LT5wbWw0KTsKIAogCQljcyA9IGludGVsX3JpbmdfYmVnaW4ocnEsIDYpOwpAQCAtMTA1
Miw2ICsxMDU0LDggQEAgc3RhdGljIGludCBlbWl0X3BwZ3R0X3VwZGF0ZShzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICpycSwgdm9pZCAqZGF0YSkKIAkJKmNzKysgPSBNSV9OT09QOwogCQlpbnRlbF9yaW5n
X2FkdmFuY2UocnEsIGNzKTsKIAl9IGVsc2UgaWYgKEhBU19MT0dJQ0FMX1JJTkdfQ09OVEVYVFMo
ZW5naW5lLT5pOTE1KSkgeworCQlzdHJ1Y3QgaTkxNV9od19wcGd0dCAqcHBndHQgPSBpOTE1X3Zt
X3RvX3BwZ3R0KHZtKTsKKwogCQljcyA9IGludGVsX3JpbmdfYmVnaW4ocnEsIDQgKiBHRU44XzNM
VkxfUERQRVMgKyAyKTsKIAkJaWYgKElTX0VSUihjcykpCiAJCQlyZXR1cm4gUFRSX0VSUihjcyk7
CkBAIC0xMDY5LDcgKzEwNzMsNyBAQCBzdGF0aWMgaW50IGVtaXRfcHBndHRfdXBkYXRlKHN0cnVj
dCBpOTE1X3JlcXVlc3QgKnJxLCB2b2lkICpkYXRhKQogCQlpbnRlbF9yaW5nX2FkdmFuY2UocnEs
IGNzKTsKIAl9IGVsc2UgewogCQkvKiBwcEdUVCBpcyBub3QgcGFydCBvZiB0aGUgbGVnYWN5IGNv
bnRleHQgaW1hZ2UgKi8KLQkJZ2VuNl9wcGd0dF9waW4ocHBndHQpOworCQlnZW42X3BwZ3R0X3Bp
bihpOTE1X3ZtX3RvX3BwZ3R0KHZtKSk7CiAJfQogCiAJcmV0dXJuIDA7CkBAIC0xMDg3LDEzICsx
MDkxLDEzIEBAIHN0YXRpYyBpbnQgc2V0X3BwZ3R0KHN0cnVjdCBkcm1faTkxNV9maWxlX3ByaXZh
dGUgKmZpbGVfcHJpdiwKIAkJICAgICBzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAogCQkg
ICAgIHN0cnVjdCBkcm1faTkxNV9nZW1fY29udGV4dF9wYXJhbSAqYXJncykKIHsKLQlzdHJ1Y3Qg
aTkxNV9od19wcGd0dCAqcHBndHQsICpvbGQ7CisJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAq
dm0sICpvbGQ7CiAJaW50IGVycjsKIAogCWlmIChhcmdzLT5zaXplKQogCQlyZXR1cm4gLUVJTlZB
TDsKIAotCWlmICghY3R4LT5wcGd0dCkKKwlpZiAoIWN0eC0+dm0pCiAJCXJldHVybiAtRU5PREVW
OwogCiAJaWYgKHVwcGVyXzMyX2JpdHMoYXJncy0+dmFsdWUpKQpAQCAtMTEwMywxOCArMTEwNywx
OCBAQCBzdGF0aWMgaW50IHNldF9wcGd0dChzdHJ1Y3QgZHJtX2k5MTVfZmlsZV9wcml2YXRlICpm
aWxlX3ByaXYsCiAJaWYgKGVycikKIAkJcmV0dXJuIGVycjsKIAotCXBwZ3R0ID0gaWRyX2ZpbmQo
JmZpbGVfcHJpdi0+dm1faWRyLCBhcmdzLT52YWx1ZSk7Ci0JaWYgKHBwZ3R0KQotCQlpOTE1X3Bw
Z3R0X2dldChwcGd0dCk7CisJdm0gPSBpZHJfZmluZCgmZmlsZV9wcml2LT52bV9pZHIsIGFyZ3Mt
PnZhbHVlKTsKKwlpZiAodm0pCisJCWk5MTVfdm1fZ2V0KHZtKTsKIAltdXRleF91bmxvY2soJmZp
bGVfcHJpdi0+dm1faWRyX2xvY2spOwotCWlmICghcHBndHQpCisJaWYgKCF2bSkKIAkJcmV0dXJu
IC1FTk9FTlQ7CiAKIAllcnIgPSBtdXRleF9sb2NrX2ludGVycnVwdGlibGUoJmN0eC0+aTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7CiAJaWYgKGVycikKIAkJZ290byBvdXQ7CiAKLQlpZiAocHBndHQg
PT0gY3R4LT5wcGd0dCkKKwlpZiAodm0gPT0gY3R4LT52bSkKIAkJZ290byB1bmxvY2s7CiAKIAkv
KiBUZWFyZG93biB0aGUgZXhpc3Rpbmcgb2JqOnZtYSBjYWNoZSwgaXQgd2lsbCBoYXZlIHRvIGJl
IHJlYnVpbHQuICovCkBAIC0xMTIyLDcgKzExMjYsNyBAQCBzdGF0aWMgaW50IHNldF9wcGd0dChz
dHJ1Y3QgZHJtX2k5MTVfZmlsZV9wcml2YXRlICpmaWxlX3ByaXYsCiAJbHV0X2Nsb3NlKGN0eCk7
CiAJbXV0ZXhfdW5sb2NrKCZjdHgtPm11dGV4KTsKIAotCW9sZCA9IF9fc2V0X3BwZ3R0KGN0eCwg
cHBndHQpOworCW9sZCA9IF9fc2V0X3BwZ3R0KGN0eCwgdm0pOwogCiAJLyoKIAkgKiBXZSBuZWVk
IHRvIGZsdXNoIGFueSByZXF1ZXN0cyB1c2luZyB0aGUgY3VycmVudCBwcGd0dCBiZWZvcmUKQEAg
LTExMzUsMTYgKzExMzksMTYgQEAgc3RhdGljIGludCBzZXRfcHBndHQoc3RydWN0IGRybV9pOTE1
X2ZpbGVfcHJpdmF0ZSAqZmlsZV9wcml2LAogCQkJCSAgIHNldF9wcGd0dF9iYXJyaWVyLAogCQkJ
CSAgIG9sZCk7CiAJaWYgKGVycikgewotCQljdHgtPnBwZ3R0ID0gb2xkOworCQljdHgtPnZtID0g
b2xkOwogCQljdHgtPmRlc2NfdGVtcGxhdGUgPSBkZWZhdWx0X2Rlc2NfdGVtcGxhdGUoY3R4LT5p
OTE1LCBvbGQpOwotCQlpOTE1X3BwZ3R0X3B1dChwcGd0dCk7CisJCWk5MTVfdm1fcHV0KHZtKTsK
IAl9CiAKIHVubG9jazoKIAltdXRleF91bmxvY2soJmN0eC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRl
eCk7CiAKIG91dDoKLQlpOTE1X3BwZ3R0X3B1dChwcGd0dCk7CisJaTkxNV92bV9wdXQodm0pOwog
CXJldHVybiBlcnI7CiB9CiAKQEAgLTIwMzMsMTUgKzIwMzcsMTUgQEAgc3RhdGljIGludCBjbG9u
ZV90aW1lbGluZShzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqZHN0LAogc3RhdGljIGludCBjbG9u
ZV92bShzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqZHN0LAogCQkgICAgc3RydWN0IGk5MTVfZ2Vt
X2NvbnRleHQgKnNyYykKIHsKLQlzdHJ1Y3QgaTkxNV9od19wcGd0dCAqcHBndHQ7CisJc3RydWN0
IGk5MTVfYWRkcmVzc19zcGFjZSAqdm07CiAKIAlyY3VfcmVhZF9sb2NrKCk7CiAJZG8gewotCQlw
cGd0dCA9IFJFQURfT05DRShzcmMtPnBwZ3R0KTsKLQkJaWYgKCFwcGd0dCkKKwkJdm0gPSBSRUFE
X09OQ0Uoc3JjLT52bSk7CisJCWlmICghdm0pCiAJCQlicmVhazsKIAotCQlpZiAoIWtyZWZfZ2V0
X3VubGVzc196ZXJvKCZwcGd0dC0+cmVmKSkKKwkJaWYgKCFrcmVmX2dldF91bmxlc3NfemVybygm
dm0tPnJlZikpCiAJCQljb250aW51ZTsKIAogCQkvKgpAQCAtMjA1OSwxNiArMjA2MywxNiBAQCBz
dGF0aWMgaW50IGNsb25lX3ZtKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpkc3QsCiAJCSAqIGl0
IGNhbm5vdCBiZSByZWFsbG9jYXRlZCBlbHNld2hlcmUuCiAJCSAqLwogCi0JCWlmIChwcGd0dCA9
PSBSRUFEX09OQ0Uoc3JjLT5wcGd0dCkpCisJCWlmICh2bSA9PSBSRUFEX09OQ0Uoc3JjLT52bSkp
CiAJCQlicmVhazsKIAotCQlpOTE1X3BwZ3R0X3B1dChwcGd0dCk7CisJCWk5MTVfdm1fcHV0KHZt
KTsKIAl9IHdoaWxlICgxKTsKIAlyY3VfcmVhZF91bmxvY2soKTsKIAotCWlmIChwcGd0dCkgewot
CQlfX2Fzc2lnbl9wcGd0dChkc3QsIHBwZ3R0KTsKLQkJaTkxNV9wcGd0dF9wdXQocHBndHQpOwor
CWlmICh2bSkgeworCQlfX2Fzc2lnbl9wcGd0dChkc3QsIHZtKTsKKwkJaTkxNV92bV9wdXQodm0p
OwogCX0KIAogCXJldHVybiAwOwpAQCAtMjI5Myw4ICsyMjk3LDggQEAgaW50IGk5MTVfZ2VtX2Nv
bnRleHRfZ2V0cGFyYW1faW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwK
IAogCWNhc2UgSTkxNV9DT05URVhUX1BBUkFNX0dUVF9TSVpFOgogCQlhcmdzLT5zaXplID0gMDsK
LQkJaWYgKGN0eC0+cHBndHQpCi0JCQlhcmdzLT52YWx1ZSA9IGN0eC0+cHBndHQtPnZtLnRvdGFs
OworCQlpZiAoY3R4LT52bSkKKwkJCWFyZ3MtPnZhbHVlID0gY3R4LT52bS0+dG90YWw7CiAJCWVs
c2UgaWYgKHRvX2k5MTUoZGV2KS0+bW0uYWxpYXNpbmdfcHBndHQpCiAJCQlhcmdzLT52YWx1ZSA9
IHRvX2k5MTUoZGV2KS0+bW0uYWxpYXNpbmdfcHBndHQtPnZtLnRvdGFsOwogCQllbHNlCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dF90eXBlcy5o
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaAppbmRl
eCAzZGI3NDQ4Yjk3MzIuLmNjNTEzNDEwZWVlZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dF90eXBlcy5oCkBAIC0yNSw3ICsyNSw3IEBAIHN0cnVj
dCBwaWQ7CiAKIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlOwogc3RydWN0IGRybV9pOTE1X2ZpbGVf
cHJpdmF0ZTsKLXN0cnVjdCBpOTE1X2h3X3BwZ3R0Oworc3RydWN0IGk5MTVfYWRkcmVzc19zcGFj
ZTsKIHN0cnVjdCBpOTE1X3RpbWVsaW5lOwogc3RydWN0IGludGVsX3Jpbmc7CiAKQEAgLTgwLDcg
KzgwLDcgQEAgc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgewogCXN0cnVjdCBpOTE1X3RpbWVsaW5l
ICp0aW1lbGluZTsKIAogCS8qKgotCSAqIEBwcGd0dDogdW5pcXVlIGFkZHJlc3Mgc3BhY2UgKEdU
VCkKKwkgKiBAdm06IHVuaXF1ZSBhZGRyZXNzIHNwYWNlIChHVFQpCiAJICoKIAkgKiBJbiBmdWxs
LXBwZ3R0IG1vZGUsIGVhY2ggY29udGV4dCBoYXMgaXRzIG93biBhZGRyZXNzIHNwYWNlIGVuc3Vy
aW5nCiAJICogY29tcGxldGUgc2VwZXJhdGlvbiBvZiBvbmUgY2xpZW50IGZyb20gYWxsIG90aGVy
cy4KQEAgLTg4LDcgKzg4LDcgQEAgc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgewogCSAqIEluIG90
aGVyIG1vZGVzLCB0aGlzIGlzIGEgTlVMTCBwb2ludGVyIHdpdGggdGhlIGV4cGVjdGF0aW9uIHRo
YXQKIAkgKiB0aGUgY2FsbGVyIHVzZXMgdGhlIHNoYXJlZCBnbG9iYWwgR1RULgogCSAqLwotCXN0
cnVjdCBpOTE1X2h3X3BwZ3R0ICpwcGd0dDsKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2
bTsKIAogCS8qKgogCSAqIEBwaWQ6IHByb2Nlc3MgaWQgb2YgY3JlYXRvcgpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKaW5kZXggMmM0ZjMyMjkzNjFk
Li41MjhlZWE0NGRjY2YgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV9leGVjYnVmZmVyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X2V4ZWNidWZmZXIuYwpAQCAtNzIzLDggKzcyMyw4IEBAIHN0YXRpYyBpbnQgZWJfc2VsZWN0X2Nv
bnRleHQoc3RydWN0IGk5MTVfZXhlY2J1ZmZlciAqZWIpCiAJCXJldHVybiAtRU5PRU5UOwogCiAJ
ZWItPmdlbV9jb250ZXh0ID0gY3R4OwotCWlmIChjdHgtPnBwZ3R0KSB7Ci0JCWViLT52bSA9ICZj
dHgtPnBwZ3R0LT52bTsKKwlpZiAoY3R4LT52bSkgeworCQllYi0+dm0gPSBjdHgtPnZtOwogCQll
Yi0+aW52YWxpZF9mbGFncyB8PSBFWEVDX09CSkVDVF9ORUVEU19HVFQ7CiAJfSBlbHNlIHsKIAkJ
ZWItPnZtID0gJmViLT5pOTE1LT5nZ3R0LnZtOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF9ibHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9vYmplY3RfYmx0LmMKaW5kZXggZmM4ZWU3ZWYzZDY5Li5jYjQyZTNhMzEyZTIg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfYmx0
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF9ibHQuYwpA
QCAtNDksMTQgKzQ5LDEyIEBAIGludCBpOTE1X2dlbV9vYmplY3RfZmlsbF9ibHQoc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUob2JqLT5iYXNlLmRldik7CiAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0
eCA9IGNlLT5nZW1fY29udGV4dDsKLQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsKKwlz
dHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9IGN0eC0+dm0gPzogJmk5MTUtPmdndHQudm07
CiAJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7CiAJc3RydWN0IGk5MTVfdm1hICp2bWE7CiAJaW50
IGVycjsKIAogCS8qIFhYWDogY2UtPnZtIHBsZWFzZSAqLwotCXZtID0gY3R4LT5wcGd0dCA/ICZj
dHgtPnBwZ3R0LT52bSA6ICZpOTE1LT5nZ3R0LnZtOwotCiAJdm1hID0gaTkxNV92bWFfaW5zdGFu
Y2Uob2JqLCB2bSwgTlVMTCk7CiAJaWYgKElTX0VSUih2bWEpKQogCQlyZXR1cm4gUFRSX0VSUih2
bWEpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3VzZXJw
dHIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV91c2VycHRyLmMKaW5kZXgg
Y2ZhOTkwZWRiMzUxLi41MjhiNjE2NzgzMzQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV91c2VycHRyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX3VzZXJwdHIuYwpAQCAtNzY4LDE0ICs3NjgsMTQgQEAgaTkxNV9nZW1fdXNlcnB0
cl9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAogCQlyZXR1cm4gLUVGQVVMVDsKIAogCWlm
IChhcmdzLT5mbGFncyAmIEk5MTVfVVNFUlBUUl9SRUFEX09OTFkpIHsKLQkJc3RydWN0IGk5MTVf
aHdfcHBndHQgKnBwZ3R0OworCQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsKIAogCQkv
KgogCQkgKiBPbiBhbG1vc3QgYWxsIG9mIHRoZSBvbGRlciBodywgd2UgY2Fubm90IHRlbGwgdGhl
IEdQVSB0aGF0CiAJCSAqIGEgcGFnZSBpcyByZWFkb25seS4KIAkJICovCi0JCXBwZ3R0ID0gZGV2
X3ByaXYtPmtlcm5lbF9jb250ZXh0LT5wcGd0dDsKLQkJaWYgKCFwcGd0dCB8fCAhcHBndHQtPnZt
Lmhhc19yZWFkX29ubHkpCisJCXZtID0gZGV2X3ByaXYtPmtlcm5lbF9jb250ZXh0LT52bTsKKwkJ
aWYgKCF2bSB8fCAhdm0tPmhhc19yZWFkX29ubHkpCiAJCQlyZXR1cm4gLUVOT0RFVjsKIAl9CiAK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaHVnZV9wYWdl
cy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2VzLmMKaW5k
ZXggZWMyOTg1YzBhOTJlLi4yMzJkNWNmNDM5NmMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9zZWxmdGVzdHMvaHVnZV9wYWdlcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9zZWxmdGVzdHMvaHVnZV9wYWdlcy5jCkBAIC0xMDM4LDggKzEwMzgsNyBAQCBzdGF0
aWMgaW50IF9faWd0X3dyaXRlX2h1Z2Uoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKIAkJ
CSAgICB1MzIgZHdvcmQsIHUzMiB2YWwpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KG9iai0+YmFzZS5kZXYpOwotCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2Ug
KnZtID0KLQkJY3R4LT5wcGd0dCA/ICZjdHgtPnBwZ3R0LT52bSA6ICZpOTE1LT5nZ3R0LnZtOwor
CXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0gY3R4LT52bSA/OiAmaTkxNS0+Z2d0dC52
bTsKIAl1bnNpZ25lZCBpbnQgZmxhZ3MgPSBQSU5fVVNFUiB8IFBJTl9PRkZTRVRfRklYRUQ7CiAJ
c3RydWN0IGk5MTVfdm1hICp2bWE7CiAJaW50IGVycjsKQEAgLTEwOTIsOCArMTA5MSw3IEBAIHN0
YXRpYyBpbnQgaWd0X3dyaXRlX2h1Z2Uoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKIAkJ
CSAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUob2JqLT5iYXNlLmRldik7Ci0Jc3RydWN0IGk5MTVfYWRk
cmVzc19zcGFjZSAqdm0gPQotCQljdHgtPnBwZ3R0ID8gJmN0eC0+cHBndHQtPnZtIDogJmk5MTUt
PmdndHQudm07CisJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSBjdHgtPnZtID86ICZp
OTE1LT5nZ3R0LnZtOwogCXN0YXRpYyBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmVzW0k5
MTVfTlVNX0VOR0lORVNdOwogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKIAlJOTE1
X1JORF9TVEFURShwcm5nKTsKQEAgLTE0MTksNyArMTQxNyw3IEBAIHN0YXRpYyBpbnQgaWd0X3Bw
Z3R0X3Bpbl91cGRhdGUodm9pZCAqYXJnKQogCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgg
PSBhcmc7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gY3R4LT5pOTE1Owog
CXVuc2lnbmVkIGxvbmcgc3VwcG9ydGVkID0gSU5URUxfSU5GTyhkZXZfcHJpdiktPnBhZ2Vfc2l6
ZXM7Ci0Jc3RydWN0IGk5MTVfaHdfcHBndHQgKnBwZ3R0ID0gY3R4LT5wcGd0dDsKKwlzdHJ1Y3Qg
aTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9IGN0eC0+dm07CiAJc3RydWN0IGRybV9pOTE1X2dlbV9v
YmplY3QgKm9iajsKIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKIAl1bnNpZ25lZCBpbnQgZmxhZ3Mg
PSBQSU5fVVNFUiB8IFBJTl9PRkZTRVRfRklYRUQ7CkBAIC0xNDM0LDcgKzE0MzIsNyBAQCBzdGF0
aWMgaW50IGlndF9wcGd0dF9waW5fdXBkYXRlKHZvaWQgKmFyZykKIAkgKiBodWdlLWd0dC1wYWdl
cy4KIAkgKi8KIAotCWlmICghcHBndHQgfHwgIWk5MTVfdm1faXNfNGx2bCgmcHBndHQtPnZtKSkg
eworCWlmICghdm0gfHwgIWk5MTVfdm1faXNfNGx2bCh2bSkpIHsKIAkJcHJfaW5mbygiNDhiIFBQ
R1RUIG5vdCBzdXBwb3J0ZWQsIHNraXBwaW5nXG4iKTsKIAkJcmV0dXJuIDA7CiAJfQpAQCAtMTQ0
OSw3ICsxNDQ3LDcgQEAgc3RhdGljIGludCBpZ3RfcHBndHRfcGluX3VwZGF0ZSh2b2lkICphcmcp
CiAJCWlmIChJU19FUlIob2JqKSkKIAkJCXJldHVybiBQVFJfRVJSKG9iaik7CiAKLQkJdm1hID0g
aTkxNV92bWFfaW5zdGFuY2Uob2JqLCAmcHBndHQtPnZtLCBOVUxMKTsKKwkJdm1hID0gaTkxNV92
bWFfaW5zdGFuY2Uob2JqLCB2bSwgTlVMTCk7CiAJCWlmIChJU19FUlIodm1hKSkgewogCQkJZXJy
ID0gUFRSX0VSUih2bWEpOwogCQkJZ290byBvdXRfcHV0OwpAQCAtMTUwMyw3ICsxNTAxLDcgQEAg
c3RhdGljIGludCBpZ3RfcHBndHRfcGluX3VwZGF0ZSh2b2lkICphcmcpCiAJaWYgKElTX0VSUihv
YmopKQogCQlyZXR1cm4gUFRSX0VSUihvYmopOwogCi0Jdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uo
b2JqLCAmcHBndHQtPnZtLCBOVUxMKTsKKwl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosIHZt
LCBOVUxMKTsKIAlpZiAoSVNfRVJSKHZtYSkpIHsKIAkJZXJyID0gUFRSX0VSUih2bWEpOwogCQln
b3RvIG91dF9wdXQ7CkBAIC0xNTQxLDggKzE1MzksNyBAQCBzdGF0aWMgaW50IGlndF90bXBmc19m
YWxsYmFjayh2b2lkICphcmcpCiAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCA9IGFyZzsK
IAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGN0eC0+aTkxNTsKIAlzdHJ1Y3QgdmZz
bW91bnQgKmdlbWZzID0gaTkxNS0+bW0uZ2VtZnM7Ci0Jc3RydWN0IGk5MTVfYWRkcmVzc19zcGFj
ZSAqdm0gPQotCQljdHgtPnBwZ3R0ID8gJmN0eC0+cHBndHQtPnZtIDogJmk5MTUtPmdndHQudm07
CisJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSBjdHgtPnZtID86ICZpOTE1LT5nZ3R0
LnZtOwogCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CiAJc3RydWN0IGk5MTVfdm1h
ICp2bWE7CiAJdTMyICp2YWRkcjsKQEAgLTE1OTksOCArMTU5Niw3IEBAIHN0YXRpYyBpbnQgaWd0
X3Nocmlua190aHAodm9pZCAqYXJnKQogewogCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgg
PSBhcmc7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBjdHgtPmk5MTU7Ci0Jc3Ry
dWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPQotCQljdHgtPnBwZ3R0ID8gJmN0eC0+cHBndHQt
PnZtIDogJmk5MTUtPmdndHQudm07CisJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSBj
dHgtPnZtID86ICZpOTE1LT5nZ3R0LnZtOwogCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpv
Ymo7CiAJc3RydWN0IGk5MTVfdm1hICp2bWE7CiAJdW5zaWduZWQgaW50IGZsYWdzID0gUElOX1VT
RVI7CkBAIC0xNzIxLDcgKzE3MTcsNyBAQCBpbnQgaTkxNV9nZW1faHVnZV9wYWdlX21vY2tfc2Vs
ZnRlc3RzKHZvaWQpCiAJZXJyID0gaTkxNV9zdWJ0ZXN0cyh0ZXN0cywgcHBndHQpOwogCiBvdXRf
Y2xvc2U6Ci0JaTkxNV9wcGd0dF9wdXQocHBndHQpOworCWk5MTVfdm1fcHV0KCZwcGd0dC0+dm0p
OwogCiBvdXRfdW5sb2NrOgogCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwpAQCAtMTc2Niw4ICsxNzYyLDggQEAgaW50IGk5MTVfZ2VtX2h1Z2VfcGFnZV9saXZlX3Nl
bGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJCWdvdG8gb3V0X3Vu
bG9jazsKIAl9CiAKLQlpZiAoY3R4LT5wcGd0dCkKLQkJY3R4LT5wcGd0dC0+dm0uc2NydWJfNjRL
ID0gdHJ1ZTsKKwlpZiAoY3R4LT52bSkKKwkJY3R4LT52bS0+c2NydWJfNjRLID0gdHJ1ZTsKIAog
CWVyciA9IGk5MTVfc3VidGVzdHModGVzdHMsIGN0eCk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fY29udGV4dC5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMKaW5kZXggNDExMDVm
NmVkMjA2Li43NGIwZTU4NzFjNGIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9zZWxmdGVzdHMvaTkxNV9nZW1fY29udGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fY29udGV4dC5jCkBAIC0yNDgsOCArMjQ4LDcgQEAgc3Rh
dGljIGludCBncHVfZmlsbChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCQkgICAg
dW5zaWduZWQgaW50IGR3KQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShvYmotPmJhc2UuZGV2KTsKLQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9Ci0J
CWN0eC0+cHBndHQgPyAmY3R4LT5wcGd0dC0+dm0gOiAmaTkxNS0+Z2d0dC52bTsKKwlzdHJ1Y3Qg
aTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9IGN0eC0+dm0gPzogJmk5MTUtPmdndHQudm07CiAJc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnE7CiAJc3RydWN0IGk5MTVfdm1hICp2bWE7CiAJc3RydWN0IGk5
MTVfdm1hICpiYXRjaDsKQEAgLTQzOCw4ICs0MzcsNyBAQCBjcmVhdGVfdGVzdF9vYmplY3Qoc3Ry
dWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKIAkJICAgc3RydWN0IGxpc3RfaGVhZCAqb2JqZWN0
cykKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwotCXN0cnVjdCBpOTE1X2Fk
ZHJlc3Nfc3BhY2UgKnZtID0KLQkJY3R4LT5wcGd0dCA/ICZjdHgtPnBwZ3R0LT52bSA6ICZjdHgt
Pmk5MTUtPmdndHQudm07CisJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSBjdHgtPnZt
ID86ICZjdHgtPmk5MTUtPmdndHQudm07CiAJdTY0IHNpemU7CiAJaW50IGVycjsKIApAQCAtNTQx
LDcgKzUzOSw3IEBAIHN0YXRpYyBpbnQgaWd0X2N0eF9leGVjKHZvaWQgKmFyZykKIAkJCQlwcl9l
cnIoIkZhaWxlZCB0byBmaWxsIGR3b3JkICVsdSBbJWx1LyVsdV0gd2l0aCBncHUgKCVzKSBpbiBj
dHggJXUgW2Z1bGwtcHBndHQ/ICVzXSwgZXJyPSVkXG4iLAogCQkJCSAgICAgICBuZHdvcmRzLCBk
dywgbWF4X2R3b3JkcyhvYmopLAogCQkJCSAgICAgICBlbmdpbmUtPm5hbWUsIGN0eC0+aHdfaWQs
Ci0JCQkJICAgICAgIHllc25vKCEhY3R4LT5wcGd0dCksIGVycik7CisJCQkJICAgICAgIHllc25v
KCEhY3R4LT52bSksIGVycik7CiAJCQkJZ290byBvdXRfdW5sb2NrOwogCQkJfQogCkBAIC02MTIs
NyArNjEwLDcgQEAgc3RhdGljIGludCBpZ3Rfc2hhcmVkX2N0eF9leGVjKHZvaWQgKmFyZykKIAkJ
Z290byBvdXRfdW5sb2NrOwogCX0KIAotCWlmICghcGFyZW50LT5wcGd0dCkgeyAvKiBub3QgZnVs
bC1wcGd0dDsgbm90aGluZyB0byBzaGFyZSAqLworCWlmICghcGFyZW50LT52bSkgeyAvKiBub3Qg
ZnVsbC1wcGd0dDsgbm90aGluZyB0byBzaGFyZSAqLwogCQllcnIgPSAwOwogCQlnb3RvIG91dF91
bmxvY2s7CiAJfQpAQCAtNjQzLDcgKzY0MSw3IEBAIHN0YXRpYyBpbnQgaWd0X3NoYXJlZF9jdHhf
ZXhlYyh2b2lkICphcmcpCiAJCQkJZ290byBvdXRfdGVzdDsKIAkJCX0KIAotCQkJX19hc3NpZ25f
cHBndHQoY3R4LCBwYXJlbnQtPnBwZ3R0KTsKKwkJCV9fYXNzaWduX3BwZ3R0KGN0eCwgcGFyZW50
LT52bSk7CiAKIAkJCWlmICghb2JqKSB7CiAJCQkJb2JqID0gY3JlYXRlX3Rlc3Rfb2JqZWN0KHBh
cmVudCwgZmlsZSwgJm9iamVjdHMpOwpAQCAtNjYxLDcgKzY1OSw3IEBAIHN0YXRpYyBpbnQgaWd0
X3NoYXJlZF9jdHhfZXhlYyh2b2lkICphcmcpCiAJCQkJcHJfZXJyKCJGYWlsZWQgdG8gZmlsbCBk
d29yZCAlbHUgWyVsdS8lbHVdIHdpdGggZ3B1ICglcykgaW4gY3R4ICV1IFtmdWxsLXBwZ3R0PyAl
c10sIGVycj0lZFxuIiwKIAkJCQkgICAgICAgbmR3b3JkcywgZHcsIG1heF9kd29yZHMob2JqKSwK
IAkJCQkgICAgICAgZW5naW5lLT5uYW1lLCBjdHgtPmh3X2lkLAotCQkJCSAgICAgICB5ZXNubygh
IWN0eC0+cHBndHQpLCBlcnIpOworCQkJCSAgICAgICB5ZXNubyghIWN0eC0+dm0pLCBlcnIpOwog
CQkJCWtlcm5lbF9jb250ZXh0X2Nsb3NlKGN0eCk7CiAJCQkJZ290byBvdXRfdGVzdDsKIAkJCX0K
QEAgLTc1OCw3ICs3NTYsNyBAQCBlbWl0X3JwY3NfcXVlcnkoc3RydWN0IGRybV9pOTE1X2dlbV9v
YmplY3QgKm9iaiwKIAogCUdFTV9CVUdfT04oIWludGVsX2VuZ2luZV9jYW5fc3RvcmVfZHdvcmQo
Y2UtPmVuZ2luZSkpOwogCi0Jdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uob2JqLCAmY2UtPmdlbV9j
b250ZXh0LT5wcGd0dC0+dm0sIE5VTEwpOworCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9iaiwg
Y2UtPmdlbV9jb250ZXh0LT52bSwgTlVMTCk7CiAJaWYgKElTX0VSUih2bWEpKQogCQlyZXR1cm4g
UFRSX0VSUih2bWEpOwogCkBAIC0xMTc2LDggKzExNzQsOCBAQCBzdGF0aWMgaW50IGlndF9jdHhf
cmVhZG9ubHkodm9pZCAqYXJnKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
YXJnOwogCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPSBOVUxMOworCXN0cnVjdCBp
OTE1X2FkZHJlc3Nfc3BhY2UgKnZtOwogCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7Ci0J
c3RydWN0IGk5MTVfaHdfcHBndHQgKnBwZ3R0OwogCXVuc2lnbmVkIGxvbmcgaWR4LCBuZHdvcmRz
LCBkdzsKIAlzdHJ1Y3QgaWd0X2xpdmVfdGVzdCB0OwogCXN0cnVjdCBkcm1fZmlsZSAqZmlsZTsK
QEAgLTEyMDgsOCArMTIwNiw4IEBAIHN0YXRpYyBpbnQgaWd0X2N0eF9yZWFkb25seSh2b2lkICph
cmcpCiAJCWdvdG8gb3V0X3VubG9jazsKIAl9CiAKLQlwcGd0dCA9IGN0eC0+cHBndHQgPzogaTkx
NS0+bW0uYWxpYXNpbmdfcHBndHQ7Ci0JaWYgKCFwcGd0dCB8fCAhcHBndHQtPnZtLmhhc19yZWFk
X29ubHkpIHsKKwl2bSA9IGN0eC0+dm0gPzogJmk5MTUtPm1tLmFsaWFzaW5nX3BwZ3R0LT52bTsK
KwlpZiAoIXZtIHx8ICF2bS0+aGFzX3JlYWRfb25seSkgewogCQllcnIgPSAwOwogCQlnb3RvIG91
dF91bmxvY2s7CiAJfQpAQCAtMTI0NCw3ICsxMjQyLDcgQEAgc3RhdGljIGludCBpZ3RfY3R4X3Jl
YWRvbmx5KHZvaWQgKmFyZykKIAkJCQlwcl9lcnIoIkZhaWxlZCB0byBmaWxsIGR3b3JkICVsdSBb
JWx1LyVsdV0gd2l0aCBncHUgKCVzKSBpbiBjdHggJXUgW2Z1bGwtcHBndHQ/ICVzXSwgZXJyPSVk
XG4iLAogCQkJCSAgICAgICBuZHdvcmRzLCBkdywgbWF4X2R3b3JkcyhvYmopLAogCQkJCSAgICAg
ICBlbmdpbmUtPm5hbWUsIGN0eC0+aHdfaWQsCi0JCQkJICAgICAgIHllc25vKCEhY3R4LT5wcGd0
dCksIGVycik7CisJCQkJICAgICAgIHllc25vKCEhY3R4LT52bSksIGVycik7CiAJCQkJZ290byBv
dXRfdW5sb2NrOwogCQkJfQogCkBAIC0xMjg4LDcgKzEyODYsNyBAQCBzdGF0aWMgaW50IGlndF9j
dHhfcmVhZG9ubHkodm9pZCAqYXJnKQogc3RhdGljIGludCBjaGVja19zY3JhdGNoKHN0cnVjdCBp
OTE1X2dlbV9jb250ZXh0ICpjdHgsIHU2NCBvZmZzZXQpCiB7CiAJc3RydWN0IGRybV9tbV9ub2Rl
ICpub2RlID0KLQkJX19kcm1fbW1faW50ZXJ2YWxfZmlyc3QoJmN0eC0+cHBndHQtPnZtLm1tLAor
CQlfX2RybV9tbV9pbnRlcnZhbF9maXJzdCgmY3R4LT52bS0+bW0sCiAJCQkJCW9mZnNldCwgb2Zm
c2V0ICsgc2l6ZW9mKHUzMikgLSAxKTsKIAlpZiAoIW5vZGUgfHwgbm9kZS0+c3RhcnQgPiBvZmZz
ZXQpCiAJCXJldHVybiAwOwpAQCAtMTMzNiw3ICsxMzM0LDcgQEAgc3RhdGljIGludCB3cml0ZV90
b19zY3JhdGNoKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsCiAJX19pOTE1X2dlbV9vYmpl
Y3RfZmx1c2hfbWFwKG9iaiwgMCwgNjQpOwogCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAob2Jq
KTsKIAotCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9iaiwgJmN0eC0+cHBndHQtPnZtLCBOVUxM
KTsKKwl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosIGN0eC0+dm0sIE5VTEwpOwogCWlmIChJ
U19FUlIodm1hKSkgewogCQllcnIgPSBQVFJfRVJSKHZtYSk7CiAJCWdvdG8gZXJyOwpAQCAtMTQz
Myw3ICsxNDMxLDcgQEAgc3RhdGljIGludCByZWFkX2Zyb21fc2NyYXRjaChzdHJ1Y3QgaTkxNV9n
ZW1fY29udGV4dCAqY3R4LAogCWk5MTVfZ2VtX29iamVjdF9mbHVzaF9tYXAob2JqKTsKIAlpOTE1
X2dlbV9vYmplY3RfdW5waW5fbWFwKG9iaik7CiAKLQl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShv
YmosICZjdHgtPnBwZ3R0LT52bSwgTlVMTCk7CisJdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uob2Jq
LCBjdHgtPnZtLCBOVUxMKTsKIAlpZiAoSVNfRVJSKHZtYSkpIHsKIAkJZXJyID0gUFRSX0VSUih2
bWEpOwogCQlnb3RvIGVycjsKQEAgLTE1NDIsMTEgKzE1NDAsMTEgQEAgc3RhdGljIGludCBpZ3Rf
dm1faXNvbGF0aW9uKHZvaWQgKmFyZykKIAl9CiAKIAkvKiBXZSBjYW4gb25seSB0ZXN0IHZtIGlz
b2xhdGlvbiwgaWYgdGhlIHZtIGFyZSBkaXN0aW5jdCAqLwotCWlmIChjdHhfYS0+cHBndHQgPT0g
Y3R4X2ItPnBwZ3R0KQorCWlmIChjdHhfYS0+dm0gPT0gY3R4X2ItPnZtKQogCQlnb3RvIG91dF91
bmxvY2s7CiAKLQl2bV90b3RhbCA9IGN0eF9hLT5wcGd0dC0+dm0udG90YWw7Ci0JR0VNX0JVR19P
TihjdHhfYi0+cHBndHQtPnZtLnRvdGFsICE9IHZtX3RvdGFsKTsKKwl2bV90b3RhbCA9IGN0eF9h
LT52bS0+dG90YWw7CisJR0VNX0JVR19PTihjdHhfYi0+dm0tPnRvdGFsICE9IHZtX3RvdGFsKTsK
IAl2bV90b3RhbCAtPSBJOTE1X0dUVF9QQUdFX1NJWkU7CiAKIAl3YWtlcmVmID0gaW50ZWxfcnVu
dGltZV9wbV9nZXQoaTkxNSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
c2VsZnRlc3RzL21vY2tfY29udGV4dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0
ZXN0cy9tb2NrX2NvbnRleHQuYwppbmRleCA2NTc4ZjJmNmMzZjguLjgyMzcxYzYwZDRhYSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9tb2NrX2NvbnRleHQu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL21vY2tfY29udGV4dC5j
CkBAIC00OCw3ICs0OCw4IEBAIG1vY2tfY29udGV4dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKIAkJaWYgKCFwcGd0dCkKIAkJCWdvdG8gZXJyX3B1dDsKIAotCQlfX3NldF9wcGd0dChj
dHgsIHBwZ3R0KTsKKwkJX19zZXRfcHBndHQoY3R4LCAmcHBndHQtPnZtKTsKKwkJaTkxNV92bV9w
dXQoJnBwZ3R0LT52bSk7CiAJfQogCiAJcmV0dXJuIGN0eDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfbHJjLmMKaW5kZXggNDk3YWMwMzZjNGE5Li41NzlkNjA1ZmJmYzMgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2xyYy5jCkBAIC0xNTA1LDcgKzE1MDUsNyBAQCBfX2V4ZWNsaXN0c19jb250
ZXh0X3BpbihzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCiAJdm9pZCAqdmFkZHI7CiAJaW50IHJl
dDsKIAotCUdFTV9CVUdfT04oIWNlLT5nZW1fY29udGV4dC0+cHBndHQpOworCUdFTV9CVUdfT04o
IWNlLT5nZW1fY29udGV4dC0+dm0pOwogCiAJcmV0ID0gZXhlY2xpc3RzX2NvbnRleHRfZGVmZXJy
ZWRfYWxsb2MoY2UsIGVuZ2luZSk7CiAJaWYgKHJldCkKQEAgLTE2MjEsNyArMTYyMSw4IEBAIHN0
YXRpYyBpbnQgZ2VuOF9lbWl0X2luaXRfYnJlYWRjcnVtYihzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpy
cSkKIHN0YXRpYyBpbnQgZW1pdF9wZHBzKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogewogCWNv
bnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKiBjb25zdCBlbmdpbmUgPSBycS0+ZW5naW5lOwot
CXN0cnVjdCBpOTE1X2h3X3BwZ3R0ICogY29uc3QgcHBndHQgPSBycS0+Z2VtX2NvbnRleHQtPnBw
Z3R0OworCXN0cnVjdCBpOTE1X2h3X3BwZ3R0ICogY29uc3QgcHBndHQgPQorCQlpOTE1X3ZtX3Rv
X3BwZ3R0KHJxLT5nZW1fY29udGV4dC0+dm0pOwogCWludCBlcnIsIGk7CiAJdTMyICpjczsKIApA
QCAtMTY5NCw3ICsxNjk1LDcgQEAgc3RhdGljIGludCBleGVjbGlzdHNfcmVxdWVzdF9hbGxvYyhz
dHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0KQogCSAqLwogCiAJLyogVW5jb25kaXRpb25hbGx5
IGludmFsaWRhdGUgR1BVIGNhY2hlcyBhbmQgVExCcy4gKi8KLQlpZiAoaTkxNV92bV9pc180bHZs
KCZyZXF1ZXN0LT5nZW1fY29udGV4dC0+cHBndHQtPnZtKSkKKwlpZiAoaTkxNV92bV9pc180bHZs
KHJlcXVlc3QtPmdlbV9jb250ZXh0LT52bSkpCiAJCXJldCA9IHJlcXVlc3QtPmVuZ2luZS0+ZW1p
dF9mbHVzaChyZXF1ZXN0LCBFTUlUX0lOVkFMSURBVEUpOwogCWVsc2UKIAkJcmV0ID0gZW1pdF9w
ZHBzKHJlcXVlc3QpOwpAQCAtMjgyNCw3ICsyODI1LDcgQEAgc3RhdGljIHZvaWQgZXhlY2xpc3Rz
X2luaXRfcmVnX3N0YXRlKHUzMiAqcmVncywKIAkJCQkgICAgIHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSwKIAkJCQkgICAgIHN0cnVjdCBpbnRlbF9yaW5nICpyaW5nKQogewotCXN0cnVj
dCBpOTE1X2h3X3BwZ3R0ICpwcGd0dCA9IGNlLT5nZW1fY29udGV4dC0+cHBndHQ7CisJc3RydWN0
IGk5MTVfaHdfcHBndHQgKnBwZ3R0ID0gaTkxNV92bV90b19wcGd0dChjZS0+Z2VtX2NvbnRleHQt
PnZtKTsKIAlib29sIHJjcyA9IGVuZ2luZS0+Y2xhc3MgPT0gUkVOREVSX0NMQVNTOwogCXUzMiBi
YXNlID0gZW5naW5lLT5tbWlvX2Jhc2U7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX3JpbmdidWZmZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X3JpbmdidWZmZXIuYwppbmRleCBmZjU4ZDY1OGUzZTIuLjYzNjljYzVlMjJiNCAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JpbmdidWZmZXIuYwpAQCAtMTMzMCwyMyArMTMzMCwy
MyBAQCBzdGF0aWMgdm9pZCByaW5nX2NvbnRleHRfZGVzdHJveShzdHJ1Y3Qga3JlZiAqcmVmKQog
CiBzdGF0aWMgaW50IF9fY29udGV4dF9waW5fcHBndHQoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQg
KmN0eCkKIHsKLQlzdHJ1Y3QgaTkxNV9od19wcGd0dCAqcHBndHQ7CisJc3RydWN0IGk5MTVfYWRk
cmVzc19zcGFjZSAqdm07CiAJaW50IGVyciA9IDA7CiAKLQlwcGd0dCA9IGN0eC0+cHBndHQgPzog
Y3R4LT5pOTE1LT5tbS5hbGlhc2luZ19wcGd0dDsKLQlpZiAocHBndHQpCi0JCWVyciA9IGdlbjZf
cHBndHRfcGluKHBwZ3R0KTsKKwl2bSA9IGN0eC0+dm0gPzogJmN0eC0+aTkxNS0+bW0uYWxpYXNp
bmdfcHBndHQtPnZtOworCWlmICh2bSkKKwkJZXJyID0gZ2VuNl9wcGd0dF9waW4oaTkxNV92bV90
b19wcGd0dCgodm0pKSk7CiAKIAlyZXR1cm4gZXJyOwogfQogCiBzdGF0aWMgdm9pZCBfX2NvbnRl
eHRfdW5waW5fcHBndHQoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKIHsKLQlzdHJ1Y3Qg
aTkxNV9od19wcGd0dCAqcHBndHQ7CisJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm07CiAK
LQlwcGd0dCA9IGN0eC0+cHBndHQgPzogY3R4LT5pOTE1LT5tbS5hbGlhc2luZ19wcGd0dDsKLQlp
ZiAocHBndHQpCi0JCWdlbjZfcHBndHRfdW5waW4ocHBndHQpOworCXZtID0gY3R4LT52bSA/OiAm
Y3R4LT5pOTE1LT5tbS5hbGlhc2luZ19wcGd0dC0+dm07CisJaWYgKHZtKQorCQlnZW42X3BwZ3R0
X3VucGluKGk5MTVfdm1fdG9fcHBndHQodm0pKTsKIH0KIAogc3RhdGljIGludCBfX2NvbnRleHRf
cGluKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKQEAgLTE3MDQsMTQgKzE3MDQsMTYgQEAgc3Rh
dGljIGludCBzd2l0Y2hfY29udGV4dChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIHsKIAlzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUgPSBycS0+ZW5naW5lOwogCXN0cnVjdCBpOTE1X2dl
bV9jb250ZXh0ICpjdHggPSBycS0+Z2VtX2NvbnRleHQ7Ci0Jc3RydWN0IGk5MTVfaHdfcHBndHQg
KnBwZ3R0ID0gY3R4LT5wcGd0dCA/OiBycS0+aTkxNS0+bW0uYWxpYXNpbmdfcHBndHQ7CisJc3Ry
dWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPQorCQljdHgtPnZtID86ICZycS0+aTkxNS0+bW0u
YWxpYXNpbmdfcHBndHQtPnZtOwogCXVuc2lnbmVkIGludCB1bndpbmRfbW0gPSAwOwogCXUzMiBo
d19mbGFncyA9IDA7CiAJaW50IHJldCwgaTsKIAogCUdFTV9CVUdfT04oSEFTX0VYRUNMSVNUUyhy
cS0+aTkxNSkpOwogCi0JaWYgKHBwZ3R0KSB7CisJaWYgKHZtKSB7CisJCXN0cnVjdCBpOTE1X2h3
X3BwZ3R0ICpwcGd0dCA9IGk5MTVfdm1fdG9fcHBndHQodm0pOwogCQlpbnQgbG9vcHM7CiAKIAkJ
LyoKQEAgLTE3NTgsNyArMTc2MCw3IEBAIHN0YXRpYyBpbnQgc3dpdGNoX2NvbnRleHQoc3RydWN0
IGk5MTVfcmVxdWVzdCAqcnEpCiAJCQlnb3RvIGVycl9tbTsKIAl9CiAKLQlpZiAocHBndHQpIHsK
KwlpZiAodm0pIHsKIAkJcmV0ID0gZW5naW5lLT5lbWl0X2ZsdXNoKHJxLCBFTUlUX0lOVkFMSURB
VEUpOwogCQlpZiAocmV0KQogCQkJZ290byBlcnJfbW07CkBAIC0xODAxLDcgKzE4MDMsNyBAQCBz
dGF0aWMgaW50IHN3aXRjaF9jb250ZXh0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogCiBlcnJf
bW06CiAJaWYgKHVud2luZF9tbSkKLQkJcHBndHQtPnBkX2RpcnR5X2VuZ2luZXMgfD0gdW53aW5k
X21tOworCQlpOTE1X3ZtX3RvX3BwZ3R0KHZtKS0+cGRfZGlydHlfZW5naW5lcyB8PSB1bndpbmRf
bW07CiBlcnI6CiAJcmV0dXJuIHJldDsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2Vs
ZnRlc3RfaGFuZ2NoZWNrLmMKaW5kZXggM2JlNjdlNTYxYzI2Li40NTM3OWE2M2UwMTMgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jCkBAIC0xMjgsOCAr
MTI4LDcgQEAgc3RhdGljIHN0cnVjdCBpOTE1X3JlcXVlc3QgKgogaGFuZ19jcmVhdGVfcmVxdWVz
dChzdHJ1Y3QgaGFuZyAqaCwgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewogCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gaC0+aTkxNTsKLQlzdHJ1Y3QgaTkxNV9hZGRy
ZXNzX3NwYWNlICp2bSA9Ci0JCWgtPmN0eC0+cHBndHQgPyAmaC0+Y3R4LT5wcGd0dC0+dm0gOiAm
aTkxNS0+Z2d0dC52bTsKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9IGgtPmN0eC0+
dm0gPzogJmk5MTUtPmdndHQudm07CiAJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEgPSBOVUxMOwog
CXN0cnVjdCBpOTE1X3ZtYSAqaHdzLCAqdm1hOwogCXVuc2lnbmVkIGludCBmbGFnczsKQEAgLTEz
NTQsOCArMTM1Myw4IEBAIHN0YXRpYyBpbnQgaWd0X3Jlc2V0X2V2aWN0X3BwZ3R0KHZvaWQgKmFy
ZykKIAl9CiAKIAllcnIgPSAwOwotCWlmIChjdHgtPnBwZ3R0KSAvKiBhbGlhc2luZyA9PSBnbG9i
YWwgZ3R0IGxvY2tpbmcsIGNvdmVyZWQgYWJvdmUgKi8KLQkJZXJyID0gX19pZ3RfcmVzZXRfZXZp
Y3Rfdm1hKGk5MTUsICZjdHgtPnBwZ3R0LT52bSwKKwlpZiAoY3R4LT52bSkgLyogYWxpYXNpbmcg
PT0gZ2xvYmFsIGd0dCBsb2NraW5nLCBjb3ZlcmVkIGFib3ZlICovCisJCWVyciA9IF9faWd0X3Jl
c2V0X2V2aWN0X3ZtYShpOTE1LCBjdHgtPnZtLAogCQkJCQkgICAgZXZpY3Rfdm1hLCBFWEVDX09C
SkVDVF9XUklURSk7CiAKIG91dDoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L3NlbGZ0ZXN0X2xyYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMK
aW5kZXggMDY1OTMyNTRiN2Q2Li5mMGNhMmEwOWRhYmQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L3NlbGZ0ZXN0X2xyYy5jCkBAIC0xMDkwLDcgKzEwOTAsNyBAQCBzdGF0aWMgaW50IHNtb2tlX3N1
Ym1pdChzdHJ1Y3QgcHJlZW1wdF9zbW9rZSAqc21va2UsCiAJaW50IGVyciA9IDA7CiAKIAlpZiAo
YmF0Y2gpIHsKLQkJdm1hID0gaTkxNV92bWFfaW5zdGFuY2UoYmF0Y2gsICZjdHgtPnBwZ3R0LT52
bSwgTlVMTCk7CisJCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKGJhdGNoLCBjdHgtPnZtLCBOVUxM
KTsKIAkJaWYgKElTX0VSUih2bWEpKQogCQkJcmV0dXJuIFBUUl9FUlIodm1hKTsKIApkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rfd29ya2Fyb3VuZHMuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMKaW5kZXggMmNiMTUx
OWZkZTQyLi5jOGQzMzVkNjNmOWMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2Vs
ZnRlc3Rfd29ya2Fyb3VuZHMuYwpAQCAtMzU4LDcgKzM1OCw3IEBAIHN0YXRpYyBzdHJ1Y3QgaTkx
NV92bWEgKmNyZWF0ZV9iYXRjaChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQogCWlmIChJ
U19FUlIob2JqKSkKIAkJcmV0dXJuIEVSUl9DQVNUKG9iaik7CiAKLQl2bWEgPSBpOTE1X3ZtYV9p
bnN0YW5jZShvYmosICZjdHgtPnBwZ3R0LT52bSwgTlVMTCk7CisJdm1hID0gaTkxNV92bWFfaW5z
dGFuY2Uob2JqLCBjdHgtPnZtLCBOVUxMKTsKIAlpZiAoSVNfRVJSKHZtYSkpIHsKIAkJZXJyID0g
UFRSX0VSUih2bWEpOwogCQlnb3RvIGVycl9vYmo7CkBAIC00NDIsNyArNDQyLDcgQEAgc3RhdGlj
IGludCBjaGVja19kaXJ0eV93aGl0ZWxpc3Qoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwK
IAlpbnQgZXJyID0gMCwgaSwgdjsKIAl1MzIgKmNzLCAqcmVzdWx0czsKIAotCXNjcmF0Y2ggPSBj
cmVhdGVfc2NyYXRjaCgmY3R4LT5wcGd0dC0+dm0sIDIgKiBBUlJBWV9TSVpFKHZhbHVlcykgKyAx
KTsKKwlzY3JhdGNoID0gY3JlYXRlX3NjcmF0Y2goY3R4LT52bSwgMiAqIEFSUkFZX1NJWkUodmFs
dWVzKSArIDEpOwogCWlmIChJU19FUlIoc2NyYXRjaCkpCiAJCXJldHVybiBQVFJfRVJSKHNjcmF0
Y2gpOwogCkBAIC05MjUsNyArOTI1LDcgQEAgc3RhdGljIGludCBsaXZlX2lzb2xhdGVkX3doaXRl
bGlzdCh2b2lkICphcmcpCiAJaWYgKCFpbnRlbF9lbmdpbmVzX2hhc19jb250ZXh0X2lzb2xhdGlv
bihpOTE1KSkKIAkJcmV0dXJuIDA7CiAKLQlpZiAoIWk5MTUtPmtlcm5lbF9jb250ZXh0LT5wcGd0
dCkKKwlpZiAoIWk5MTUtPmtlcm5lbF9jb250ZXh0LT52bSkKIAkJcmV0dXJuIDA7CiAKIAlmb3Ig
KGkgPSAwOyBpIDwgQVJSQVlfU0laRShjbGllbnQpOyBpKyspIHsKQEAgLTkzNywxNCArOTM3LDE0
IEBAIHN0YXRpYyBpbnQgbGl2ZV9pc29sYXRlZF93aGl0ZWxpc3Qodm9pZCAqYXJnKQogCQkJZ290
byBlcnI7CiAJCX0KIAotCQljbGllbnRbaV0uc2NyYXRjaFswXSA9IGNyZWF0ZV9zY3JhdGNoKCZj
LT5wcGd0dC0+dm0sIDEwMjQpOworCQljbGllbnRbaV0uc2NyYXRjaFswXSA9IGNyZWF0ZV9zY3Jh
dGNoKGMtPnZtLCAxMDI0KTsKIAkJaWYgKElTX0VSUihjbGllbnRbaV0uc2NyYXRjaFswXSkpIHsK
IAkJCWVyciA9IFBUUl9FUlIoY2xpZW50W2ldLnNjcmF0Y2hbMF0pOwogCQkJa2VybmVsX2NvbnRl
eHRfY2xvc2UoYyk7CiAJCQlnb3RvIGVycjsKIAkJfQogCi0JCWNsaWVudFtpXS5zY3JhdGNoWzFd
ID0gY3JlYXRlX3NjcmF0Y2goJmMtPnBwZ3R0LT52bSwgMTAyNCk7CisJCWNsaWVudFtpXS5zY3Jh
dGNoWzFdID0gY3JlYXRlX3NjcmF0Y2goYy0+dm0sIDEwMjQpOwogCQlpZiAoSVNfRVJSKGNsaWVu
dFtpXS5zY3JhdGNoWzFdKSkgewogCQkJZXJyID0gUFRSX0VSUihjbGllbnRbaV0uc2NyYXRjaFsx
XSk7CiAJCQlpOTE1X3ZtYV91bnBpbl9hbmRfcmVsZWFzZSgmY2xpZW50W2ldLnNjcmF0Y2hbMF0s
IDApOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCmluZGV4IDZjZDcyZGQ5NmE0Yi4u
OTIyZTEzNzc3ZDJlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1
bGVyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCkBAIC0zNjgs
NyArMzY4LDcgQEAgc3RhdGljIGludCBzZXRfY29udGV4dF9wcGd0dF9mcm9tX3NoYWRvdyhzdHJ1
Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xvYWQsCiAJCQkJCSBzdHJ1Y3QgaTkxNV9nZW1f
Y29udGV4dCAqY3R4KQogewogCXN0cnVjdCBpbnRlbF92Z3B1X21tICptbSA9IHdvcmtsb2FkLT5z
aGFkb3dfbW07Ci0Jc3RydWN0IGk5MTVfaHdfcHBndHQgKnBwZ3R0ID0gY3R4LT5wcGd0dDsKKwlz
dHJ1Y3QgaTkxNV9od19wcGd0dCAqcHBndHQgPSBpOTE1X3ZtX3RvX3BwZ3R0KGN0eC0+dm0pOwog
CWludCBpID0gMDsKIAogCWlmIChtbS0+dHlwZSAhPSBJTlRFTF9HVlRfTU1fUFBHVFQgfHwgIW1t
LT5wcGd0dF9tbS5zaGFkb3dlZCkKQEAgLTExNTEsNyArMTE1MSw3IEBAIHZvaWQgaW50ZWxfdmdw
dV9jbGVhbl9zdWJtaXNzaW9uKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQogCiAJaW50ZWxfdmdw
dV9zZWxlY3Rfc3VibWlzc2lvbl9vcHModmdwdSwgQUxMX0VOR0lORVMsIDApOwogCi0JaTkxNV9j
b250ZXh0X3BwZ3R0X3Jvb3RfcmVzdG9yZShzLCBzLT5zaGFkb3dbMF0tPmdlbV9jb250ZXh0LT5w
cGd0dCk7CisJaTkxNV9jb250ZXh0X3BwZ3R0X3Jvb3RfcmVzdG9yZShzLCBpOTE1X3ZtX3RvX3Bw
Z3R0KHMtPnNoYWRvd1swXS0+Z2VtX2NvbnRleHQtPnZtKSk7CiAJZm9yX2VhY2hfZW5naW5lKGVu
Z2luZSwgdmdwdS0+Z3Z0LT5kZXZfcHJpdiwgaWQpCiAJCWludGVsX2NvbnRleHRfdW5waW4ocy0+
c2hhZG93W2lkXSk7CiAKQEAgLTEyMTYsNyArMTIxNiw3IEBAIGludCBpbnRlbF92Z3B1X3NldHVw
X3N1Ym1pc3Npb24oc3RydWN0IGludGVsX3ZncHUgKnZncHUpCiAJaWYgKElTX0VSUihjdHgpKQog
CQlyZXR1cm4gUFRSX0VSUihjdHgpOwogCi0JaTkxNV9jb250ZXh0X3BwZ3R0X3Jvb3Rfc2F2ZShz
LCBjdHgtPnBwZ3R0KTsKKwlpOTE1X2NvbnRleHRfcHBndHRfcm9vdF9zYXZlKHMsIGk5MTVfdm1f
dG9fcHBndHQoY3R4LT52bSkpOwogCiAJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgdmdwdS0+Z3Z0
LT5kZXZfcHJpdiwgaSkgewogCQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7CkBAIC0xMjU5LDcg
KzEyNTksNyBAQCBpbnQgaW50ZWxfdmdwdV9zZXR1cF9zdWJtaXNzaW9uKHN0cnVjdCBpbnRlbF92
Z3B1ICp2Z3B1KQogCXJldHVybiAwOwogCiBvdXRfc2hhZG93X2N0eDoKLQlpOTE1X2NvbnRleHRf
cHBndHRfcm9vdF9yZXN0b3JlKHMsIGN0eC0+cHBndHQpOworCWk5MTVfY29udGV4dF9wcGd0dF9y
b290X3Jlc3RvcmUocywgaTkxNV92bV90b19wcGd0dChjdHgtPnZtKSk7CiAJZm9yX2VhY2hfZW5n
aW5lKGVuZ2luZSwgdmdwdS0+Z3Z0LT5kZXZfcHJpdiwgaSkgewogCQlpZiAoSVNfRVJSKHMtPnNo
YWRvd1tpXSkpCiAJCQlicmVhazsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfZGVidWdmcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKaW5kZXgg
MmU3OWYwZTRjNWFmLi5iMDcwZTZmMzc4MGMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZGVidWdmcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdm
cy5jCkBAIC00MjcsNyArNDI3LDcgQEAgc3RhdGljIHZvaWQgcHJpbnRfY29udGV4dF9zdGF0cyhz
dHJ1Y3Qgc2VxX2ZpbGUgKm0sCiAJCWk5MTVfZ2VtX2NvbnRleHRfdW5sb2NrX2VuZ2luZXMoY3R4
KTsKIAogCQlpZiAoIUlTX0VSUl9PUl9OVUxMKGN0eC0+ZmlsZV9wcml2KSkgewotCQkJc3RydWN0
IGZpbGVfc3RhdHMgc3RhdHMgPSB7IC52bSA9ICZjdHgtPnBwZ3R0LT52bSwgfTsKKwkJCXN0cnVj
dCBmaWxlX3N0YXRzIHN0YXRzID0geyAudm0gPSBjdHgtPnZtLCB9OwogCQkJc3RydWN0IGRybV9m
aWxlICpmaWxlID0gY3R4LT5maWxlX3ByaXYtPmZpbGU7CiAJCQlzdHJ1Y3QgdGFza19zdHJ1Y3Qg
KnRhc2s7CiAJCQljaGFyIG5hbWVbODBdOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKaW5kZXggZDNj
MDJlMDA5YTk4Li42ZTdlNzJhYjUzNjAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaApAQCAtMjY1
OCwxMiArMjY1OCw2IEBAIHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqaTkxNV9nZW1fcHJpbWVfaW1w
b3J0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiBzdHJ1Y3QgZG1hX2J1ZiAqaTkxNV9nZW1fcHJp
bWVfZXhwb3J0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJCQkJc3RydWN0IGRybV9nZW1fb2Jq
ZWN0ICpnZW1fb2JqLCBpbnQgZmxhZ3MpOwogCi1zdGF0aWMgaW5saW5lIHN0cnVjdCBpOTE1X2h3
X3BwZ3R0ICoKLWk5MTVfdm1fdG9fcHBndHQoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0p
Ci17Ci0JcmV0dXJuIGNvbnRhaW5lcl9vZih2bSwgc3RydWN0IGk5MTVfaHdfcHBndHQsIHZtKTsK
LX0KLQogLyogaTkxNV9nZW1fZmVuY2VfcmVnLmMgKi8KIHN0cnVjdCBkcm1faTkxNV9mZW5jZV9y
ZWcgKgogaTkxNV9yZXNlcnZlX2ZlbmNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jCmluZGV4IDJlMTU4NTBiZDk4Ny4uNjll
YjBiZjc2NzBiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuYwpAQCAtNDgzLDYgKzQ4
Myw4IEBAIHN0YXRpYyB2b2lkIHZtX2ZyZWVfcGFnZShzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNl
ICp2bSwgc3RydWN0IHBhZ2UgKnBhZ2UpCiAKIHN0YXRpYyB2b2lkIGk5MTVfYWRkcmVzc19zcGFj
ZV9pbml0KHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtLCBpbnQgc3ViY2xhc3MpCiB7CisJ
a3JlZl9pbml0KCZ2bS0+cmVmKTsKKwogCS8qCiAJICogVGhlIHZtLT5tdXRleCBtdXN0IGJlIHJl
Y2xhaW0gc2FmZSAoZm9yIHVzZSBpbiB0aGUgc2hyaW5rZXIpLgogCSAqIERvIGEgZHVtbXkgYWNx
dWlyZSBub3cgdW5kZXIgZnNfcmVjbGFpbSBzbyB0aGF0IGFueSBhbGxvY2F0aW9uCkBAIC0xMjMw
LDkgKzEyMzIsOCBAQCBzdGF0aWMgaW50IGdlbjhfaW5pdF9zY3JhdGNoKHN0cnVjdCBpOTE1X2Fk
ZHJlc3Nfc3BhY2UgKnZtKQogCSAqLwogCWlmICh2bS0+aGFzX3JlYWRfb25seSAmJgogCSAgICB2
bS0+aTkxNS0+a2VybmVsX2NvbnRleHQgJiYKLQkgICAgdm0tPmk5MTUtPmtlcm5lbF9jb250ZXh0
LT5wcGd0dCkgewotCQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICpjbG9uZSA9Ci0JCQkmdm0t
Pmk5MTUtPmtlcm5lbF9jb250ZXh0LT5wcGd0dC0+dm07CisJICAgIHZtLT5pOTE1LT5rZXJuZWxf
Y29udGV4dC0+dm0pIHsKKwkJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqY2xvbmUgPSB2bS0+
aTkxNS0+a2VybmVsX2NvbnRleHQtPnZtOwogCiAJCUdFTV9CVUdfT04oIWNsb25lLT5oYXNfcmVh
ZF9vbmx5KTsKIApAQCAtMTU5MSw4ICsxNTkyLDYgQEAgc3RhdGljIGludCBnZW44X3ByZWFsbG9j
YXRlX3RvcF9sZXZlbF9wZHAoc3RydWN0IGk5MTVfaHdfcHBndHQgKnBwZ3R0KQogc3RhdGljIHZv
aWQgcHBndHRfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJICAgICAgIHN0
cnVjdCBpOTE1X2h3X3BwZ3R0ICpwcGd0dCkKIHsKLQlrcmVmX2luaXQoJnBwZ3R0LT5yZWYpOwot
CiAJcHBndHQtPnZtLmk5MTUgPSBpOTE1OwogCXBwZ3R0LT52bS5kbWEgPSAmaTkxNS0+ZHJtLnBk
ZXYtPmRldjsKIAlwcGd0dC0+dm0udG90YWwgPSBCSVRfVUxMKElOVEVMX0lORk8oaTkxNSktPnBw
Z3R0X3NpemUpOwpAQCAtMjI3MiwyMSArMjI3MSwyMyBAQCBzdGF0aWMgdm9pZCBwcGd0dF9kZXN0
cm95X3ZtYShzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSkKIAl9CiB9CiAKLXZvaWQgaTkx
NV9wcGd0dF9yZWxlYXNlKHN0cnVjdCBrcmVmICprcmVmKQordm9pZCBpOTE1X3ZtX3JlbGVhc2Uo
c3RydWN0IGtyZWYgKmtyZWYpCiB7Ci0Jc3RydWN0IGk5MTVfaHdfcHBndHQgKnBwZ3R0ID0KLQkJ
Y29udGFpbmVyX29mKGtyZWYsIHN0cnVjdCBpOTE1X2h3X3BwZ3R0LCByZWYpOworCXN0cnVjdCBp
OTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0KKwkJY29udGFpbmVyX29mKGtyZWYsIHN0cnVjdCBpOTE1
X2FkZHJlc3Nfc3BhY2UsIHJlZik7CiAKLQl0cmFjZV9pOTE1X3BwZ3R0X3JlbGVhc2UoJnBwZ3R0
LT52bSk7CisJR0VNX0JVR19PTihpOTE1X2lzX2dndHQodm0pKTsKKwl0cmFjZV9pOTE1X3BwZ3R0
X3JlbGVhc2Uodm0pOwogCi0JcHBndHRfZGVzdHJveV92bWEoJnBwZ3R0LT52bSk7CisJcHBndHRf
ZGVzdHJveV92bWEodm0pOwogCi0JR0VNX0JVR19PTighbGlzdF9lbXB0eSgmcHBndHQtPnZtLmJv
dW5kX2xpc3QpKTsKLQlHRU1fQlVHX09OKCFsaXN0X2VtcHR5KCZwcGd0dC0+dm0udW5ib3VuZF9s
aXN0KSk7CisJR0VNX0JVR19PTighbGlzdF9lbXB0eSgmdm0tPmJvdW5kX2xpc3QpKTsKKwlHRU1f
QlVHX09OKCFsaXN0X2VtcHR5KCZ2bS0+dW5ib3VuZF9saXN0KSk7CiAKLQlwcGd0dC0+dm0uY2xl
YW51cCgmcHBndHQtPnZtKTsKLQlpOTE1X2FkZHJlc3Nfc3BhY2VfZmluaSgmcHBndHQtPnZtKTsK
LQlrZnJlZShwcGd0dCk7CisJdm0tPmNsZWFudXAodm0pOworCWk5MTVfYWRkcmVzc19zcGFjZV9m
aW5pKHZtKTsKKworCWtmcmVlKHZtKTsKIH0KIAogLyogQ2VydGFpbiBHZW41IGNoaXBzZXRzIHJl
cXVpcmUgcmVxdWlyZSBpZGxpbmcgdGhlIEdQVSBiZWZvcmUKQEAgLTI3ODgsNyArMjc4OSw3IEBA
IHN0YXRpYyBpbnQgaW5pdF9hbGlhc2luZ19wcGd0dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKIAlyZXR1cm4gMDsKIAogZXJyX3BwZ3R0OgotCWk5MTVfcHBndHRfcHV0KHBwZ3R0KTsK
KwlpOTE1X3ZtX3B1dCgmcHBndHQtPnZtKTsKIAlyZXR1cm4gZXJyOwogfQogCkBAIC0yODAxLDcg
KzI4MDIsNyBAQCBzdGF0aWMgdm9pZCBmaW5pX2FsaWFzaW5nX3BwZ3R0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQogCWlmICghcHBndHQpCiAJCXJldHVybjsKIAotCWk5MTVfcHBndHRf
cHV0KHBwZ3R0KTsKKwlpOTE1X3ZtX3B1dCgmcHBndHQtPnZtKTsKIAogCWdndHQtPnZtLnZtYV9v
cHMuYmluZF92bWEgICA9IGdndHRfYmluZF92bWE7CiAJZ2d0dC0+dm0udm1hX29wcy51bmJpbmRf
dm1hID0gZ2d0dF91bmJpbmRfdm1hOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9nZW1fZ3R0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuaAppbmRl
eCA5NzcwMGEzN2MxMmIuLjNiNjMzNmVmNjRmMiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9nZW1fZ3R0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1f
Z3R0LmgKQEAgLTI5Myw2ICsyOTMsOCBAQCBzdHJ1Y3QgcGFnZXN0YXNoIHsKIH07CiAKIHN0cnVj
dCBpOTE1X2FkZHJlc3Nfc3BhY2UgeworCXN0cnVjdCBrcmVmIHJlZjsKKwogCXN0cnVjdCBkcm1f
bW0gbW07CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTU7CiAJc3RydWN0IGRldmljZSAq
ZG1hOwpAQCAtNDEyLDcgKzQxNCw2IEBAIHN0cnVjdCBpOTE1X2dndHQgewogCiBzdHJ1Y3QgaTkx
NV9od19wcGd0dCB7CiAJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSB2bTsKLQlzdHJ1Y3Qga3Jl
ZiByZWY7CiAKIAlpbnRlbF9lbmdpbmVfbWFza190IHBkX2RpcnR5X2VuZ2luZXM7CiAJdW5pb24g
ewpAQCAtNTgyLDEwICs1ODMsMTkgQEAgaTkxNV9wYWdlX2Rpcl9kbWFfYWRkcihjb25zdCBzdHJ1
Y3QgaTkxNV9od19wcGd0dCAqcHBndHQsIGNvbnN0IHVuc2lnbmVkIG4pCiBzdGF0aWMgaW5saW5l
IHN0cnVjdCBpOTE1X2dndHQgKgogaTkxNV92bV90b19nZ3R0KHN0cnVjdCBpOTE1X2FkZHJlc3Nf
c3BhY2UgKnZtKQogeworCUJVSUxEX0JVR19PTihvZmZzZXRvZihzdHJ1Y3QgaTkxNV9nZ3R0LCB2
bSkpOwogCUdFTV9CVUdfT04oIWk5MTVfaXNfZ2d0dCh2bSkpOwogCXJldHVybiBjb250YWluZXJf
b2Yodm0sIHN0cnVjdCBpOTE1X2dndHQsIHZtKTsKIH0KIAorc3RhdGljIGlubGluZSBzdHJ1Y3Qg
aTkxNV9od19wcGd0dCAqCitpOTE1X3ZtX3RvX3BwZ3R0KHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3Bh
Y2UgKnZtKQoreworCUJVSUxEX0JVR19PTihvZmZzZXRvZihzdHJ1Y3QgaTkxNV9od19wcGd0dCwg
dm0pKTsKKwlHRU1fQlVHX09OKGk5MTVfaXNfZ2d0dCh2bSkpOworCXJldHVybiBjb250YWluZXJf
b2Yodm0sIHN0cnVjdCBpOTE1X2h3X3BwZ3R0LCB2bSk7Cit9CisKICNkZWZpbmUgSU5URUxfTUFY
X1BQQVRfRU5UUklFUyA4CiAjZGVmaW5lIElOVEVMX1BQQVRfUEVSRkVDVF9NQVRDSCAofjBVKQog
CkBAIC02MjgsMTggKzYzOCwxOSBAQCB2b2lkIGk5MTVfZ2d0dF9jbGVhbnVwX2h3KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiBpbnQgaTkxNV9wcGd0dF9pbml0X2h3KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiAKIHN0cnVjdCBpOTE1X2h3X3BwZ3R0ICpp
OTE1X3BwZ3R0X2NyZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwotdm9p
ZCBpOTE1X3BwZ3R0X3JlbGVhc2Uoc3RydWN0IGtyZWYgKmtyZWYpOwogCi1zdGF0aWMgaW5saW5l
IHN0cnVjdCBpOTE1X2h3X3BwZ3R0ICppOTE1X3BwZ3R0X2dldChzdHJ1Y3QgaTkxNV9od19wcGd0
dCAqcHBndHQpCitzdGF0aWMgaW5saW5lIHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKgoraTkx
NV92bV9nZXQoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0pCiB7Ci0Ja3JlZl9nZXQoJnBw
Z3R0LT5yZWYpOwotCXJldHVybiBwcGd0dDsKKwlrcmVmX2dldCgmdm0tPnJlZik7CisJcmV0dXJu
IHZtOwogfQogCi1zdGF0aWMgaW5saW5lIHZvaWQgaTkxNV9wcGd0dF9wdXQoc3RydWN0IGk5MTVf
aHdfcHBndHQgKnBwZ3R0KQordm9pZCBpOTE1X3ZtX3JlbGVhc2Uoc3RydWN0IGtyZWYgKmtyZWYp
OworCitzdGF0aWMgaW5saW5lIHZvaWQgaTkxNV92bV9wdXQoc3RydWN0IGk5MTVfYWRkcmVzc19z
cGFjZSAqdm0pCiB7Ci0JaWYgKHBwZ3R0KQotCQlrcmVmX3B1dCgmcHBndHQtPnJlZiwgaTkxNV9w
cGd0dF9yZWxlYXNlKTsKKwlrcmVmX3B1dCgmdm0tPnJlZiwgaTkxNV92bV9yZWxlYXNlKTsKIH0K
IAogaW50IGdlbjZfcHBndHRfcGluKHN0cnVjdCBpOTE1X2h3X3BwZ3R0ICpiYXNlKTsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jCmluZGV4IGE1MjNiZjA1MGEyNS4uZGMwMjZkNWNk
N2EwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmMKQEAgLTE0MzEsNyArMTQz
MSw3IEBAIHN0YXRpYyB2b2lkIGdlbV9yZWNvcmRfcmluZ3Moc3RydWN0IGk5MTVfZ3B1X3N0YXRl
ICplcnJvcikKIAkJCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHggPSByZXF1ZXN0LT5nZW1f
Y29udGV4dDsKIAkJCXN0cnVjdCBpbnRlbF9yaW5nICpyaW5nOwogCi0JCQllZS0+dm0gPSBjdHgt
PnBwZ3R0ID8gJmN0eC0+cHBndHQtPnZtIDogJmdndHQtPnZtOworCQkJZWUtPnZtID0gY3R4LT52
bSA/OiAmZ2d0dC0+dm07CiAKIAkJCXJlY29yZF9jb250ZXh0KCZlZS0+Y29udGV4dCwgY3R4KTsK
IApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90cmFjZS5oIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV90cmFjZS5oCmluZGV4IDgzYjM4OWUzNGI1MC4uNWM4Y2ZhYTcw
ZDcyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3RyYWNlLmgKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90cmFjZS5oCkBAIC05NzcsNyArOTc3LDcgQEAgREVD
TEFSRV9FVkVOVF9DTEFTUyhpOTE1X2NvbnRleHQsCiAJCQlfX2VudHJ5LT5kZXYgPSBjdHgtPmk5
MTUtPmRybS5wcmltYXJ5LT5pbmRleDsKIAkJCV9fZW50cnktPmN0eCA9IGN0eDsKIAkJCV9fZW50
cnktPmh3X2lkID0gY3R4LT5od19pZDsKLQkJCV9fZW50cnktPnZtID0gY3R4LT5wcGd0dCA/ICZj
dHgtPnBwZ3R0LT52bSA6IE5VTEw7CisJCQlfX2VudHJ5LT52bSA9IGN0eC0+dm07CiAJKSwKIAog
CVRQX3ByaW50aygiZGV2PSV1LCBjdHg9JXAsIGN0eF92bT0lcCwgaHdfaWQ9JXUiLApkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jCmluZGV4IGYxZTk1ZWFm
NjkyMy4uMzVkYjY3NzU3NDMyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxm
dGVzdHMvaTkxNV9nZW1fZ3R0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3Rz
L2k5MTVfZ2VtX2d0dC5jCkBAIC0yMDksNyArMjA5LDcgQEAgc3RhdGljIGludCBpZ3RfcHBndHRf
YWxsb2Modm9pZCAqYXJnKQogCiBlcnJfcHBndHRfY2xlYW51cDoKIAltdXRleF9sb2NrKCZkZXZf
cHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0JaTkxNV9wcGd0dF9wdXQocHBndHQpOworCWk5MTVf
dm1fcHV0KCZwcGd0dC0+dm0pOwogCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3Rf
bXV0ZXgpOwogCXJldHVybiBlcnI7CiB9CkBAIC0xMDIxLDcgKzEwMjEsNyBAQCBzdGF0aWMgaW50
IGV4ZXJjaXNlX3BwZ3R0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAogCWVy
ciA9IGZ1bmMoZGV2X3ByaXYsICZwcGd0dC0+dm0sIDAsIHBwZ3R0LT52bS50b3RhbCwgZW5kX3Rp
bWUpOwogCi0JaTkxNV9wcGd0dF9wdXQocHBndHQpOworCWk5MTVfdm1fcHV0KCZwcGd0dC0+dm0p
Owogb3V0X3VubG9jazoKIAltdXRleF91bmxvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4
KTsKIApAQCAtMTI1MSw3ICsxMjUxLDYgQEAgc3RhdGljIGludCBleGVyY2lzZV9tb2NrKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogewogCWNvbnN0IHU2NCBsaW1pdCA9IHRvdGFscmFt
X3BhZ2VzKCkgPDwgUEFHRV9TSElGVDsKIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4Owot
CXN0cnVjdCBpOTE1X2h3X3BwZ3R0ICpwcGd0dDsKIAlJR1RfVElNRU9VVChlbmRfdGltZSk7CiAJ
aW50IGVycjsKIApAQCAtMTI1OSwxMCArMTI1OCw3IEBAIHN0YXRpYyBpbnQgZXhlcmNpc2VfbW9j
ayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAlpZiAoIWN0eCkKIAkJcmV0dXJuIC1F
Tk9NRU07CiAKLQlwcGd0dCA9IGN0eC0+cHBndHQ7Ci0JR0VNX0JVR19PTighcHBndHQpOwotCi0J
ZXJyID0gZnVuYyhpOTE1LCAmcHBndHQtPnZtLCAwLCBtaW4ocHBndHQtPnZtLnRvdGFsLCBsaW1p
dCksIGVuZF90aW1lKTsKKwllcnIgPSBmdW5jKGk5MTUsIGN0eC0+dm0sIDAsIG1pbihjdHgtPnZt
LT50b3RhbCwgbGltaXQpLCBlbmRfdGltZSk7CiAKIAltb2NrX2NvbnRleHRfY2xvc2UoY3R4KTsK
IAlyZXR1cm4gZXJyOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3Rz
L2k5MTVfcmVxdWVzdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfcmVx
dWVzdC5jCmluZGV4IGRmYWE1YmM1MmVjYy4uMTEyNzhiYWMzYTI0IDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9yZXF1ZXN0LmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfcmVxdWVzdC5jCkBAIC03NTQsOCArNzU0LDcgQEAg
c3RhdGljIGludCBsaXZlX2VtcHR5X3JlcXVlc3Qodm9pZCAqYXJnKQogc3RhdGljIHN0cnVjdCBp
OTE1X3ZtYSAqcmVjdXJzaXZlX2JhdGNoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQog
ewogCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHggPSBpOTE1LT5rZXJuZWxfY29udGV4dDsK
LQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9Ci0JCWN0eC0+cHBndHQgPyAmY3R4LT5w
cGd0dC0+dm0gOiAmaTkxNS0+Z2d0dC52bTsKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2
bSA9IGN0eC0+dm0gPzogJmk5MTUtPmdndHQudm07CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iajsKIAljb25zdCBpbnQgZ2VuID0gSU5URUxfR0VOKGk5MTUpOwogCXN0cnVjdCBpOTE1
X3ZtYSAqdm1hOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5
MTVfdm1hLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV92bWEuYwppbmRl
eCA2ZjNlNDFjMGNiM2YuLmExNjZkOTQwNWE5NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvc2VsZnRlc3RzL2k5MTVfdm1hLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2Vs
ZnRlc3RzL2k5MTVfdm1hLmMKQEAgLTM4LDcgKzM4LDcgQEAgc3RhdGljIGJvb2wgYXNzZXJ0X3Zt
YShzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKIHsKIAlib29sIG9rID0gdHJ1ZTsKIAotCWlmICh2bWEt
PnZtICE9ICZjdHgtPnBwZ3R0LT52bSkgeworCWlmICh2bWEtPnZtICE9IGN0eC0+dm0pIHsKIAkJ
cHJfZXJyKCJWTUEgY3JlYXRlZCB3aXRoIHdyb25nIFZNXG4iKTsKIAkJb2sgPSBmYWxzZTsKIAl9
CkBAIC0xMTMsNyArMTEzLDcgQEAgc3RhdGljIGludCBjcmVhdGVfdm1hcyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKIAlsaXN0X2Zvcl9lYWNoX2VudHJ5KG9iaiwgb2JqZWN0cywgc3Rf
bGluaykgewogCQlmb3IgKHBpbm5lZCA9IDA7IHBpbm5lZCA8PSAxOyBwaW5uZWQrKykgewogCQkJ
bGlzdF9mb3JfZWFjaF9lbnRyeShjdHgsIGNvbnRleHRzLCBsaW5rKSB7Ci0JCQkJc3RydWN0IGk5
MTVfYWRkcmVzc19zcGFjZSAqdm0gPSAmY3R4LT5wcGd0dC0+dm07CisJCQkJc3RydWN0IGk5MTVf
YWRkcmVzc19zcGFjZSAqdm0gPSBjdHgtPnZtOwogCQkJCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwog
CQkJCWludCBlcnI7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0
cy9pZ3Rfc3Bpbm5lci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2lndF9zcGlu
bmVyLmMKaW5kZXggM2VhNzdjMGNhNjc4Li4xZTU5YjU0M2NmMjcgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pZ3Rfc3Bpbm5lci5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L3NlbGZ0ZXN0cy9pZ3Rfc3Bpbm5lci5jCkBAIC04OSwxNyArODksMTYgQEAgaWd0
X3NwaW5uZXJfY3JlYXRlX3JlcXVlc3Qoc3RydWN0IGlndF9zcGlubmVyICpzcGluLAogCQkJICAg
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAogCQkJICAgdTMyIGFyYml0cmF0aW9uX2Nv
bW1hbmQpCiB7Ci0Jc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSAmY3R4LT5wcGd0dC0+
dm07CiAJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEgPSBOVUxMOwogCXN0cnVjdCBpOTE1X3ZtYSAq
aHdzLCAqdm1hOwogCXUzMiAqYmF0Y2g7CiAJaW50IGVycjsKIAotCXZtYSA9IGk5MTVfdm1hX2lu
c3RhbmNlKHNwaW4tPm9iaiwgdm0sIE5VTEwpOworCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKHNw
aW4tPm9iaiwgY3R4LT52bSwgTlVMTCk7CiAJaWYgKElTX0VSUih2bWEpKQogCQlyZXR1cm4gRVJS
X0NBU1Qodm1hKTsKIAotCWh3cyA9IGk5MTVfdm1hX2luc3RhbmNlKHNwaW4tPmh3cywgdm0sIE5V
TEwpOworCWh3cyA9IGk5MTVfdm1hX2luc3RhbmNlKHNwaW4tPmh3cywgY3R4LT52bSwgTlVMTCk7
CiAJaWYgKElTX0VSUihod3MpKQogCQlyZXR1cm4gRVJSX0NBU1QoaHdzKTsKIApkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfZ3R0LmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9zZWxmdGVzdHMvbW9ja19ndHQuYwppbmRleCBjZDgzOTI5ZmRlOGUuLjllNjFj
MmYwNmNjOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tf
Z3R0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfZ3R0LmMKQEAg
LTY1LDcgKzY1LDYgQEAgbW9ja19wcGd0dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
IAlpZiAoIXBwZ3R0KQogCQlyZXR1cm4gTlVMTDsKIAotCWtyZWZfaW5pdCgmcHBndHQtPnJlZik7
CiAJcHBndHQtPnZtLmk5MTUgPSBpOTE1OwogCXBwZ3R0LT52bS50b3RhbCA9IHJvdW5kX2Rvd24o
VTY0X01BWCwgUEFHRV9TSVpFKTsKIAlwcGd0dC0+dm0uZmlsZSA9IEVSUl9QVFIoLUVOT0RFVik7
Ci0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9y
ZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdm
eA==

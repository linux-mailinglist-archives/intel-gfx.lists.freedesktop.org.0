Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1A15411492A
	for <lists+intel-gfx@lfdr.de>; Thu,  5 Dec 2019 23:23:58 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7AEAB6E9AB;
	Thu,  5 Dec 2019 22:23:56 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 378F86E9AB
 for <intel-gfx@lists.freedesktop.org>; Thu,  5 Dec 2019 22:23:55 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19477124-1500050 
 for multiple; Thu, 05 Dec 2019 22:23:51 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu,  5 Dec 2019 22:23:49 +0000
Message-Id: <20191205222349.903322-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191205222034.896901-1-chris@chris-wilson.co.uk>
References: <20191205222034.896901-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915/gem: Pin gen6_ppgtt prior to
 constructing the request
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QWxsIHBpbm5pbmcgbXVzdCBiZSBkb25lIHByaW9yIHRvIGk5MTVfcmVxdWVzdF9jcmVhdGUsIHRv
IGF2b2lkCnRpbWVsaW5lLT5tdXRleCBpbnZlcnNpb25zLgoKSGVyZSB3ZSBzbGlnaHRseSBhYnVz
ZSB0aGUgY29udGV4dF9iYXJyaWVyX3Rhc2sgc3RhZ2VzIHRvIHV0aWxpc2UgdGhlCidza2lwJyBk
ZWNpc2lvbiBhcyBhbiBvcHBvcnR1bml0eSB0byBhY3F1aXJlIHRoZSBwaW4gb24gdGhlIG5ldyBw
cGd0dC4KQ29uc2lkZXIgaXQgcy9za2lwL3ByZXBhcmUvLiBBdCB0aGUgbW9tZW50LCB3ZSBvbmx5
IGhhdmUgb24gdXNlciBvZgpjb250ZXh0X2JhcnJpZXJfdGFzaywgc28gaXQgbWlnaHQgYmUgd29y
dGggYnJlYWtpbmcgaXQgZG93biBmb3IgdGhlCnNwZWNpZmljIHRhc2sgb2Ygc2V0LXZtIGFuZCBy
ZWZhY3RvciBpdCBsYXRlciBpZiB3ZSBmaW5kIGEgc2Vjb25kCnB1cnBvc2UuCgo8ND4gWzQwMi4z
Nzc0ODddIFdBUk5JTkc6IHBvc3NpYmxlIGNpcmN1bGFyIGxvY2tpbmcgZGVwZW5kZW5jeSBkZXRl
Y3RlZAo8ND4gWzQwMi4zNzc0OTNdIDUuNC4wLXJjOC1DSS1DSV9EUk1fNzQ5MSsgIzEgVGFpbnRl
ZDogRyAgICAgVQo8ND4gWzQwMi4zNzc0OTddIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQo8ND4gWzQwMi4zNzc1MDJdIGdlbV9leGVjX3BhcmFs
bC8yNTA2IGlzIHRyeWluZyB0byBhY3F1aXJlIGxvY2s6Cjw0PiBbNDAyLjM3NzUwN10gZmZmZjg4
ODQwM2NkYWM3MCAoJmtlcm5lbCMyKXsrLisufSwgYXQ6IGk5MTVfcmVxdWVzdF9jcmVhdGUrMHgx
Ni8weDFjMCBbaTkxNV0KPDQ+IFs0MDIuMzc3NTkzXQpidXQgdGFzayBpcyBhbHJlYWR5IGhvbGRp
bmcgbG9jazoKPDQ+IFs0MDIuMzc3NTk3XSBmZmZmODg4MzVlZmFkNTUwICgmcHBndHQtPnBpbl9t
dXRleCl7Ky4rLn0sIGF0OiBnZW42X3BwZ3R0X3BpbisweDRkLzB4MTEwIFtpOTE1XQo8ND4gWzQw
Mi4zNzc2NjBdCndoaWNoIGxvY2sgYWxyZWFkeSBkZXBlbmRzIG9uIHRoZSBuZXcgbG9jay4KCjw0
PiBbNDAyLjM3NzY2NF0KdGhlIGV4aXN0aW5nIGRlcGVuZGVuY3kgY2hhaW4gKGluIHJldmVyc2Ug
b3JkZXIpIGlzOgo8ND4gWzQwMi4zNzc2NjhdCi0+ICMxICgmcHBndHQtPnBpbl9tdXRleCl7Ky4r
Ln06Cjw0PiBbNDAyLjM3NzY3NF0gICAgICAgIF9fbXV0ZXhfbG9jaysweDlhLzB4OWQwCjw0PiBb
NDAyLjM3NzcxM10gICAgICAgIGdlbjZfcHBndHRfcGluKzB4NGQvMHgxMTAgW2k5MTVdCjw0PiBb
NDAyLjM3Nzc1Nl0gICAgICAgIGVtaXRfcHBndHRfdXBkYXRlKzB4MWRjLzB4MzcwIFtpOTE1XQo8
ND4gWzQwMi4zNzc4MDFdICAgICAgICBjb250ZXh0X2JhcnJpZXJfdGFzaysweDE3Ni8weDMxMCBb
aTkxNV0KPDQ+IFs0MDIuMzc3ODQ0XSAgICAgICAgY3R4X3NldHBhcmFtKzB4NDAwLzB4YjEwIFtp
OTE1XQo8ND4gWzQwMi4zNzc4ODZdICAgICAgICBpOTE1X2dlbV9jb250ZXh0X3NldHBhcmFtX2lv
Y3RsKzB4YzgvMHgxNjAgW2k5MTVdCjw0PiBbNDAyLjM3Nzg5MV0gICAgICAgIGRybV9pb2N0bF9r
ZXJuZWwrMHhhNy8weGYwCjw0PiBbNDAyLjM3Nzg5NV0gICAgICAgIGRybV9pb2N0bCsweDJlMS8w
eDM5MAo8ND4gWzQwMi4zNzc4OTldICAgICAgICBkb192ZnNfaW9jdGwrMHhhMC8weDZmMAo8ND4g
WzQwMi4zNzc5MDNdICAgICAgICBrc3lzX2lvY3RsKzB4MzUvMHg2MAo8ND4gWzQwMi4zNzc5MDZd
ICAgICAgICBfX3g2NF9zeXNfaW9jdGwrMHgxMS8weDIwCjw0PiBbNDAyLjM3NzkxMF0gICAgICAg
IGRvX3N5c2NhbGxfNjQrMHg0Zi8weDIxMAo8ND4gWzQwMi4zNzc5MTRdICAgICAgICBlbnRyeV9T
WVNDQUxMXzY0X2FmdGVyX2h3ZnJhbWUrMHg0OS8weGJlCjw0PiBbNDAyLjM3NzkxN10KLT4gIzAg
KCZrZXJuZWwjMil7Ky4rLn06Cjw0PiBbNDAyLjM3NzkyM10gICAgICAgIF9fbG9ja19hY3F1aXJl
KzB4MTMyOC8weDE1ZDAKPDQ+IFs0MDIuMzc3OTI2XSAgICAgICAgbG9ja19hY3F1aXJlKzB4YTcv
MHgxYzAKPDQ+IFs0MDIuMzc3OTMwXSAgICAgICAgX19tdXRleF9sb2NrKzB4OWEvMHg5ZDAKPDQ+
IFs0MDIuMzc3OTc3XSAgICAgICAgaTkxNV9yZXF1ZXN0X2NyZWF0ZSsweDE2LzB4MWMwIFtpOTE1
XQo8ND4gWzQwMi4zNzgwMTNdICAgICAgICBpbnRlbF9lbmdpbmVfZmx1c2hfYmFycmllcnMrMHg0
Yy8weDEwMCBbaTkxNV0KPDQ+IFs0MDIuMzc4MDYyXSAgICAgICAgaTkxNV9nZ3R0X3BpbisweDdk
LzB4MTMwIFtpOTE1XQo8ND4gWzQwMi4zNzgxMDhdICAgICAgICBnZW42X3BwZ3R0X3BpbisweDlj
LzB4MTEwIFtpOTE1XQo8ND4gWzQwMi4zNzgxNDhdICAgICAgICByaW5nX2NvbnRleHRfcGluKzB4
MmUvMHhjMCBbaTkxNV0KPDQ+IFs0MDIuMzc4MTgzXSAgICAgICAgX19pbnRlbF9jb250ZXh0X2Rv
X3BpbisweDZiLzB4MTkwIFtpOTE1XQo8ND4gWzQwMi4zNzgyMjZdICAgICAgICBpOTE1X2dlbV9k
b19leGVjYnVmZmVyKzB4MTgwYy8weDI2YjAgW2k5MTVdCjw0PiBbNDAyLjM3ODI2OF0gICAgICAg
IGk5MTVfZ2VtX2V4ZWNidWZmZXIyX2lvY3RsKzB4MTFiLzB4NDYwIFtpOTE1XQo8ND4gWzQwMi4z
NzgyNzJdICAgICAgICBkcm1faW9jdGxfa2VybmVsKzB4YTcvMHhmMAo8ND4gWzQwMi4zNzgyNzVd
ICAgICAgICBkcm1faW9jdGwrMHgyZTEvMHgzOTAKPDQ+IFs0MDIuMzc4Mjc5XSAgICAgICAgZG9f
dmZzX2lvY3RsKzB4YTAvMHg2ZjAKPDQ+IFs0MDIuMzc4MjgyXSAgICAgICAga3N5c19pb2N0bCsw
eDM1LzB4NjAKPDQ+IFs0MDIuMzc4Mjg2XSAgICAgICAgX194NjRfc3lzX2lvY3RsKzB4MTEvMHgy
MAo8ND4gWzQwMi4zNzgyODldICAgICAgICBkb19zeXNjYWxsXzY0KzB4NGYvMHgyMTAKPDQ+IFs0
MDIuMzc4MjkyXSAgICAgICAgZW50cnlfU1lTQ0FMTF82NF9hZnRlcl9od2ZyYW1lKzB4NDkvMHhi
ZQo8ND4gWzQwMi4zNzgyOTVdCm90aGVyIGluZm8gdGhhdCBtaWdodCBoZWxwIHVzIGRlYnVnIHRo
aXM6Cgo8ND4gWzQwMi4zNzgyOTldICBQb3NzaWJsZSB1bnNhZmUgbG9ja2luZyBzY2VuYXJpbzoK
Cjw0PiBbNDAyLjM3ODMwMl0gICAgICAgIENQVTAgICAgICAgICAgICAgICAgICAgIENQVTEKPDQ+
IFs0MDIuMzc4MzA1XSAgICAgICAgLS0tLSAgICAgICAgICAgICAgICAgICAgLS0tLQo8ND4gWzQw
Mi4zNzgzMDddICAgbG9jaygmcHBndHQtPnBpbl9tdXRleCk7Cjw0PiBbNDAyLjM3ODMxMF0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2soJmtlcm5lbCMyKTsKPDQ+IFs0MDIuMzc4
MzE0XSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jaygmcHBndHQtPnBpbl9tdXRl
eCk7Cjw0PiBbNDAyLjM3ODMxN10gICBsb2NrKCZrZXJuZWwjMik7Cjw0PiBbNDAyLjM3ODMyMF0K
ClNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgot
LS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMgfCAxOCArKysr
KysrKysrKysrLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCAxMyBpbnNlcnRpb25zKCspLCA1IGRlbGV0
aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9j
b250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCmlu
ZGV4IDlmMWRjOTZiMTBhNi4uOWQ4ZDc1NzY1ZWU0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKQEAgLTExNDEsOCArMTE0MSw2IEBAIHN0YXRpYyBpbnQg
ZW1pdF9wcGd0dF91cGRhdGUoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsIHZvaWQgKmRhdGEpCiAJ
CSpjcysrID0gTUlfTk9PUDsKIAkJaW50ZWxfcmluZ19hZHZhbmNlKHJxLCBjcyk7CiAJfSBlbHNl
IHsKLQkJLyogcHBHVFQgaXMgbm90IHBhcnQgb2YgdGhlIGxlZ2FjeSBjb250ZXh0IGltYWdlICov
Ci0JCWdlbjZfcHBndHRfcGluKGk5MTVfdm1fdG9fcHBndHQodm0pKTsKIAl9CiAKIAlyZXR1cm4g
MDsKQEAgLTExNTAsMTAgKzExNDgsMjAgQEAgc3RhdGljIGludCBlbWl0X3BwZ3R0X3VwZGF0ZShz
dHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgdm9pZCAqZGF0YSkKIAogc3RhdGljIGJvb2wgc2tpcF9w
cGd0dF91cGRhdGUoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCB2b2lkICpkYXRhKQogeworCWlm
ICghdGVzdF9iaXQoQ09OVEVYVF9BTExPQ19CSVQsICZjZS0+ZmxhZ3MpKQorCQlyZXR1cm4gdHJ1
ZTsKKwogCWlmIChIQVNfTE9HSUNBTF9SSU5HX0NPTlRFWFRTKGNlLT5lbmdpbmUtPmk5MTUpKQot
CQlyZXR1cm4gIWNlLT5zdGF0ZTsKLQllbHNlCi0JCXJldHVybiAhYXRvbWljX3JlYWQoJmNlLT5w
aW5fY291bnQpOworCQlyZXR1cm4gZmFsc2U7CisKKwlpZiAoIWF0b21pY19yZWFkKCZjZS0+cGlu
X2NvdW50KSkKKwkJcmV0dXJuIHRydWU7CisKKwkvKiBwcEdUVCBpcyBub3QgcGFydCBvZiB0aGUg
bGVnYWN5IGNvbnRleHQgaW1hZ2UgKi8KKwlpZiAoZ2VuNl9wcGd0dF9waW4oaTkxNV92bV90b19w
cGd0dChjZS0+dm0pKSkKKwkJcmV0dXJuIHRydWU7CisKKwlyZXR1cm4gZmFsc2U7CiB9CiAKIHN0
YXRpYyBpbnQgc2V0X3BwZ3R0KHN0cnVjdCBkcm1faTkxNV9maWxlX3ByaXZhdGUgKmZpbGVfcHJp
diwKLS0gCjIuMjQuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Au
b3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwt
Z2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 049A7BFC10
	for <lists+intel-gfx@lfdr.de>; Fri, 27 Sep 2019 01:54:29 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A05ED6EE00;
	Thu, 26 Sep 2019 23:54:26 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga09.intel.com (mga09.intel.com [134.134.136.24])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 646126EE00
 for <intel-gfx@lists.freedesktop.org>; Thu, 26 Sep 2019 23:54:25 +0000 (UTC)
X-Amp-Result: UNKNOWN
X-Amp-Original-Verdict: FILE UNKNOWN
X-Amp-File-Uploaded: False
Received: from fmsmga003.fm.intel.com ([10.253.24.29])
 by orsmga102.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 26 Sep 2019 16:54:24 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,553,1559545200"; d="scan'208";a="196538385"
Received: from mdroper-desk1.fm.intel.com (HELO
 mdroper-desk1.amr.corp.intel.com) ([10.1.27.135])
 by FMSMGA003.fm.intel.com with ESMTP; 26 Sep 2019 16:54:24 -0700
Date: Thu, 26 Sep 2019 16:54:35 -0700
From: Matt Roper <matthew.d.roper@intel.com>
To: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
Message-ID: <20190926235435.GZ1869@mdroper-desk1.amr.corp.intel.com>
References: <20190920114235.22411-1-maarten.lankhorst@linux.intel.com>
 <20190920114235.22411-12-maarten.lankhorst@linux.intel.com>
 <20190926051819.GW1869@mdroper-desk1.amr.corp.intel.com>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <20190926051819.GW1869@mdroper-desk1.amr.corp.intel.com>
User-Agent: Mutt/1.12.1 (2019-06-15)
Subject: Re: [Intel-gfx] [PATCH 12/23] drm/i915: Enable big joiner support
 in enable and disable sequences.
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: intel-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T24gV2VkLCBTZXAgMjUsIDIwMTkgYXQgMTA6MTg6MTlQTSAtMDcwMCwgTWF0dCBSb3BlciB3cm90
ZToKPiBPbiBGcmksIFNlcCAyMCwgMjAxOSBhdCAwMTo0MjoyNFBNICswMjAwLCBNYWFydGVuIExh
bmtob3JzdCB3cm90ZToKPiA+IE1ha2UgdmRzYyB3b3JrIHdoZW4gbm8gb3V0cHV0IGlzIGVuYWJs
ZWQuIFRoZSBiaWcgam9pbmVyIG5lZWRzIFZEU0MKPiA+IG9uIHRoZSBzbGF2ZSwgc28gZW5hYmxl
IGl0IGFuZCBzZXQgdGhlIGFwcHJvcHJpYXRlIGJpdHMuCj4gPiBBbHNvIHVwZGF0ZSB0aW1lc3Rh
bXBpbmcgY29uc3RhbnRzLCBiZWNhdXNlIHNsYXZlIGNydGMncyBhcmUgbm90Cj4gPiB1cGRhdGVk
IGluIGRybV9hdG9taWNfaGVscGVyX3VwZGF0ZV9sZWdhY3lfbW9kZXNldF9zdGF0ZSgpLgo+ID4g
Cj4gPiBUaGlzIHNob3VsZCBiZSBlbm91Z2ggdG8gYnJpbmcgdXAgQ1JUQydzIGluIGEgYmlnIGpv
aW5lciBjb25maWd1cmF0aW9uLAo+ID4gd2l0aG91dCBhbnkgcGxhbmUgY29uZmlndXJhdGlvbiBv
biB0aGUgc2Vjb25kIHBpcGUgeWV0Lgo+ID4gCj4gPiBIT1dFVkVSLCB3ZSBicmluZyB1cCB0aGUg
Y3J0YydzIGluIHRoZSB3cm9uZyBvcmRlci4gV2UgbmVlZCB0byBtYWtlCj4gPiBzdXJlIHRoYXQg
dGhlIG1hc3RlciBjcnRjIGlzIGJyb3VnaHQgdXAgYWZ0ZXIgdGhlIHNsYXZlIGNydGMsIHdlCj4g
PiBkb24ndCBkbyB0aGF0IHlldC4gVGhpcyBpcyBkb25lIGNvcnJlY3RseSBsYXRlciBpbiB0aGlz
IHNlcmllcy4KPiA+IAo+ID4gVGhlIG5leHQgc3RlcHMgYXJlIHRvIGFkZCBhdG9taWMgY29tbWl0
LCBhbmQgbWFrZSBzdXJlIHdlIGVuYWJsZSBhbmQKPiA+IHVwZGF0ZSBib3RoIG1hc3RlciBhbmQg
c2xhdmUgaW4gdGhlIGNvcnJlY3Qgb3JkZXIuCj4gPiAKPiA+IFNpZ25lZC1vZmYtYnk6IE1hYXJ0
ZW4gTGFua2hvcnN0IDxtYWFydGVuLmxhbmtob3JzdEBsaW51eC5pbnRlbC5jb20+Cj4gCj4gQSBj
b3VwbGUgbWlub3IgY29tbWVudHMgaW5saW5lIGJlbG93LCBidXQgSSBkaWRuJ3Qgc2VlIGFueSBj
bGVhcgo+IHByb2JsZW1zIHdpdGggdGhpcyBwYXRjaCBzbwo+IAo+IEFja2VkLWJ5OiBNYXR0IFJv
cGVyIDxtYXR0aGV3LmQucm9wZXJAaW50ZWwuY29tPgo+IAo+IEhvd2V2ZXIgdGhlcmUncyBhIGxv
dCBvZiBwcmV0dHkgY29tcGxpY2F0ZWQgY2hhbmdlcyBoZXJlIGluIGFyZWFzIHRoYXQKPiBJJ20g
b25seSB2YWd1ZWx5IGZhbWlsaWFyIHdpdGgsIHNvIEkgdGhpbmsgaXQgd291bGQgYmUgZ29vZCBp
ZiBzb21lb25lCj4gbGlrZSBNYW5hc2kgd2hvJ3MgbW9yZSBmYW1pbGlhciB3aXRoIHRoaXMgYXJl
YSBvZiB0aGUgY29kZSBjb3VsZCBsb29rIGl0Cj4gb3Zlci4KPiAKPiAKPiBNYXR0Cj4gCj4gCj4g
PiAtLS0KPiA+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RkaS5jICAgICAg
fCAgNTUgKystCj4gPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5
LmMgIHwgNDAyICsrKysrKysrKysrKy0tLS0tLQo+ID4gIC4uLi9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX2Rpc3BsYXlfdHlwZXMuaCAgICB8ICAxNyArCj4gPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF9kcC5jICAgICAgIHwgIDE4ICstCj4gPiAgZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF92ZHNjLmMgICAgIHwgMTIyICsrKystLQo+ID4gIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfdmRzYy5oICAgICB8ICAgMiArCj4gPiAgNiBmaWxlcyBj
aGFuZ2VkLCA0MTggaW5zZXJ0aW9ucygrKSwgMTk4IGRlbGV0aW9ucygtKQo+ID4gCj4gPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGkuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpLmMKPiA+IGluZGV4IGM3NzVmZDIwNTkx
NS4uYTI2MTU1ZjkwMjYxIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kZGkuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kZGkuYwo+ID4gQEAgLTE2OTQsNiArMTY5NCwxMyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9k
ZGlfY2xvY2tfZ2V0KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gIAkJc2tsX2Rk
aV9jbG9ja19nZXQoZW5jb2RlciwgcGlwZV9jb25maWcpOwo+ID4gIAllbHNlIGlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpIDw9IDgpCj4gPiAgCQloc3dfZGRpX2Nsb2NrX2dldChlbmNvZGVyLCBwaXBl
X2NvbmZpZyk7Cj4gPiArCj4gPiArCWlmIChwaXBlX2NvbmZpZy0+Ymlnam9pbmVyKSB7Cj4gPiAr
CQlwaXBlX2NvbmZpZy0+aHcudHJhbnNjb2Rlcl9tb2RlLmNydGNfY2xvY2sgPQo+ID4gKwkJCXBp
cGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2s7Cj4gPiArCj4gPiArCQlwaXBl
X2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrIC89IDI7Cj4gPiArCX0KPiA+ICB9
Cj4gPiAgCj4gPiAgdm9pZCBpbnRlbF9kZGlfc2V0X3BpcGVfc2V0dGluZ3MoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiBAQCAtMjE3NiwxMyArMjE4Myw2IEBA
IHN0YXRpYyB2b2lkIGludGVsX2RkaV9nZXRfcG93ZXJfZG9tYWlucyhzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKPiA+ICAJICAgIGludGVsX3BoeV9pc190YyhkZXZfcHJpdiwgcGh5KSkK
PiA+ICAJCWludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGRldl9wcml2LAo+ID4gIAkJCQkJaW50ZWxf
ZGRpX21haW5fbGlua19hdXhfZG9tYWluKGRpZ19wb3J0KSk7Cj4gPiAtCj4gPiAtCS8qCj4gPiAt
CSAqIFZEU0MgcG93ZXIgaXMgbmVlZGVkIHdoZW4gRFNDIGlzIGVuYWJsZWQKPiA+IC0JICovCj4g
PiAtCWlmIChjcnRjX3N0YXRlLT5kc2NfcGFyYW1zLmNvbXByZXNzaW9uX2VuYWJsZSkKPiA+IC0J
CWludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGRldl9wcml2LAo+ID4gLQkJCQkJaW50ZWxfZHNjX3Bv
d2VyX2RvbWFpbihjcnRjX3N0YXRlKSk7Cj4gPiAgfQo+ID4gIAo+ID4gIHZvaWQgaW50ZWxfZGRp
X2VuYWJsZV9waXBlX2Nsb2NrKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlKQo+ID4gQEAgLTMyOTAsNyArMzI5MCw4IEBAIHN0YXRpYyB2b2lkIHRnbF9kZGlfcHJlX2Vu
YWJsZV9kcChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAKPiA+ICAJLyogNy5s
ICovCj4gPiAgCWludGVsX2RkaV9lbmFibGVfZmVjKGVuY29kZXIsIGNydGNfc3RhdGUpOwo+ID4g
LQlpbnRlbF9kc2NfZW5hYmxlKGVuY29kZXIsIGNydGNfc3RhdGUpOwo+ID4gKwlpZiAoIWNydGNf
c3RhdGUtPmJpZ2pvaW5lcikKPiA+ICsJCWludGVsX2RzY19lbmFibGUoZW5jb2RlciwgY3J0Y19z
dGF0ZSk7Cj4gPiAgfQo+ID4gIAo+ID4gIHN0YXRpYyB2b2lkIGhzd19kZGlfcHJlX2VuYWJsZV9k
cChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+IEBAIC0zMzYxLDcgKzMzNjIsOCBA
QCBzdGF0aWMgdm9pZCBoc3dfZGRpX3ByZV9lbmFibGVfZHAoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4gPiAgCWlmICghaXNfbXN0KQo+ID4gIAkJaW50ZWxfZGRpX2VuYWJsZV9waXBl
X2Nsb2NrKGNydGNfc3RhdGUpOwo+ID4gIAo+ID4gLQlpbnRlbF9kc2NfZW5hYmxlKGVuY29kZXIs
IGNydGNfc3RhdGUpOwo+ID4gKwlpZiAoIWNydGNfc3RhdGUtPmJpZ2pvaW5lcikKPiA+ICsJCWlu
dGVsX2RzY19lbmFibGUoZW5jb2RlciwgY3J0Y19zdGF0ZSk7Cj4gPiAgfQo+ID4gIAo+ID4gIHN0
YXRpYyB2b2lkIGludGVsX2RkaV9wcmVfZW5hYmxlX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAo+ID4gQEAgLTM5NzIsMTkgKzM5NzQsMTggQEAgdm9pZCBpbnRlbF9kZGlfY29tcHV0
ZV9taW5fdm9sdGFnZV9sZXZlbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
PiAgCQljcnRjX3N0YXRlLT5taW5fdm9sdGFnZV9sZXZlbCA9IDI7Cj4gPiAgfQo+ID4gIAo+ID4g
LXZvaWQgaW50ZWxfZGRpX2dldF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
Cj4gPiAtCQkJICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gPiArc3Rh
dGljIHZvaWQgaW50ZWxfZGRpX3JlYWRfZnVuY19jdGwoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCj4gPiArCQkJCSAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcp
Cj4gPiAgewo+ID4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAJc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMg
PSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT51YXBpLmNydGMpOwo+ID4gIAllbnVtIHRyYW5z
Y29kZXIgY3B1X3RyYW5zY29kZXIgPSBwaXBlX2NvbmZpZy0+Y3B1X3RyYW5zY29kZXI7Cj4gPiAg
CXUzMiB0ZW1wLCBmbGFncyA9IDA7Cj4gPiAgCj4gPiAtCS8qIFhYWDogRFNJIHRyYW5zY29kZXIg
cGFyYW5vaWEgKi8KPiA+IC0JaWYgKFdBUk5fT04odHJhbnNjb2Rlcl9pc19kc2koY3B1X3RyYW5z
Y29kZXIpKSkKPiA+ICsJdGVtcCA9IEk5MTVfUkVBRChUUkFOU19ERElfRlVOQ19DVEwoY3B1X3Ry
YW5zY29kZXIpKTsKPiA+ICsJaWYgKCEodGVtcCAmIFRSQU5TX0RESV9GVU5DX0VOQUJMRSkpCj4g
PiAgCQlyZXR1cm47Cj4gPiAgCj4gPiAtCXRlbXAgPSBJOTE1X1JFQUQoVFJBTlNfRERJX0ZVTkNf
Q1RMKGNwdV90cmFuc2NvZGVyKSk7Cj4gPiAgCWlmICh0ZW1wICYgVFJBTlNfRERJX1BIU1lOQykK
PiA+ICAJCWZsYWdzIHw9IERSTV9NT0RFX0ZMQUdfUEhTWU5DOwo+ID4gIAllbHNlCj4gPiBAQCAt
NDA2Niw2ICs0MDY3LDI5IEBAIHZvaWQgaW50ZWxfZGRpX2dldF9jb25maWcoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsCj4gPiAgCWRlZmF1bHQ6Cj4gPiAgCQlicmVhazsKPiA+ICAJfQo+
ID4gK30KPiA+ICsKPiA+ICt2b2lkIGludGVsX2RkaV9nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+ID4gKwkJCSAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVf
Y29uZmlnKQo+ID4gK3sKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCWVudW0gdHJhbnNjb2RlciBjcHVfdHJh
bnNjb2RlciA9IHBpcGVfY29uZmlnLT5jcHVfdHJhbnNjb2RlcjsKPiA+ICsKPiA+ICsJLyogWFhY
OiBEU0kgdHJhbnNjb2RlciBwYXJhbm9pYSAqLwo+ID4gKwlpZiAoV0FSTl9PTih0cmFuc2NvZGVy
X2lzX2RzaShjcHVfdHJhbnNjb2RlcikpKQo+ID4gKwkJcmV0dXJuOwo+ID4gKwo+ID4gKwlpbnRl
bF9kZGlfcmVhZF9mdW5jX2N0bChlbmNvZGVyLCBwaXBlX2NvbmZpZyk7Cj4gPiArCWlmIChwaXBl
X2NvbmZpZy0+Ymlnam9pbmVyX3NsYXZlKSB7Cj4gPiArCQkvKiByZWFkIG91dCBwaXBlIHNldHRp
bmdzIGZyb20gbWFzdGVyICovCj4gPiArCQllbnVtIHRyYW5zY29kZXIgc2F2ZSA9IHBpcGVfY29u
ZmlnLT5jcHVfdHJhbnNjb2RlcjsKPiA+ICsKPiA+ICsJCSAvKiBPdXIgb3duIHRyYW5zY29kZXIg
bmVlZHMgdG8gYmUgZGlzYWJsZWQgd2hlbiByZWFkaW5nIGl0IGluIGludGVsX2RkaV9yZWFkX2Z1
bmNfY3RsKCkgKi8KPiA+ICsJCVdBUk5fT04ocGlwZV9jb25maWctPm91dHB1dF90eXBlcyk7Cj4g
PiArCQlwaXBlX2NvbmZpZy0+Y3B1X3RyYW5zY29kZXIgPSAoZW51bSB0cmFuc2NvZGVyKXBpcGVf
Y29uZmlnLT5iaWdqb2luZXJfbGlua2VkX2NydGMtPnBpcGU7Cj4gPiArCQlpbnRlbF9kZGlfcmVh
ZF9mdW5jX2N0bChlbmNvZGVyLCBwaXBlX2NvbmZpZyk7Cj4gPiArCQlwaXBlX2NvbmZpZy0+Y3B1
X3RyYW5zY29kZXIgPSBzYXZlOwo+ID4gKwl9Cj4gPiAgCj4gPiAgCXBpcGVfY29uZmlnLT5oYXNf
YXVkaW8gPQo+ID4gIAkJaW50ZWxfZGRpX2lzX2F1ZGlvX2VuYWJsZWQoZGV2X3ByaXYsIGNwdV90
cmFuc2NvZGVyKTsKPiA+IEBAIC00MDkwLDcgKzQxMTQsOCBAQCB2b2lkIGludGVsX2RkaV9nZXRf
Y29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gIAkJZGV2X3ByaXYtPnZi
dC5lZHAuYnBwID0gcGlwZV9jb25maWctPnBpcGVfYnBwOwo+ID4gIAl9Cj4gPiAgCj4gPiAtCWlu
dGVsX2RkaV9jbG9ja19nZXQoZW5jb2RlciwgcGlwZV9jb25maWcpOwo+ID4gKwlpZiAoIXBpcGVf
Y29uZmlnLT5iaWdqb2luZXJfc2xhdmUpCj4gPiArCQlpbnRlbF9kZGlfY2xvY2tfZ2V0KGVuY29k
ZXIsIHBpcGVfY29uZmlnKTsKPiA+ICAKPiA+ICAJaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKQo+
ID4gIAkJcGlwZV9jb25maWctPmxhbmVfbGF0X29wdGltX21hc2sgPQo+ID4gZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKPiA+IGluZGV4IDE0M2Q1MzFjNGM4
MS4uOGMwOGM0OTE0YzliIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kaXNwbGF5LmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfZGlzcGxheS5jCj4gPiBAQCAtNjQ0OSw2ICs2NDQ5LDQ1IEBAIHN0YXRpYyB2b2lk
IGljbF9waXBlX21idXNfZW5hYmxlKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+ID4gIAlJOTE1
X1dSSVRFKFBJUEVfTUJVU19EQk9YX0NUTChwaXBlKSwgdmFsKTsKPiA+ICB9Cj4gPiAgCj4gPiAr
c3RhdGljIHZvaWQgaWNsX2RkaV9iaWdqb2luZXJfcHJlX2VuYWJsZShzdHJ1Y3QgaW50ZWxfYXRv
bWljX3N0YXRlICpzdGF0ZSwKPiA+ICsJCQkJCSBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSkKPiA+ICt7Cj4gPiArCXN0cnVjdCBpbnRlbF9jcnRjICptYXN0ZXIgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gPiArCXN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICptYXN0ZXJfY3J0Y19zdGF0ZTsKPiA+ICsJc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUg
KmNvbm5fc3RhdGU7Cj4gPiArCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uOwo+ID4gKwlzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciA9IE5VTEw7Cj4gPiArCWludCBpOwo+ID4gKwo+ID4g
KwlpZiAoY3J0Y19zdGF0ZS0+Ymlnam9pbmVyX3NsYXZlKQo+ID4gKwkJbWFzdGVyID0gY3J0Y19z
dGF0ZS0+Ymlnam9pbmVyX2xpbmtlZF9jcnRjOwo+ID4gKwo+ID4gKwltYXN0ZXJfY3J0Y19zdGF0
ZSA9IGludGVsX2F0b21pY19nZXRfbmV3X2NydGNfc3RhdGUoc3RhdGUsIG1hc3Rlcik7Cj4gPiAr
Cj4gPiArCWZvcl9lYWNoX25ld19jb25uZWN0b3JfaW5fc3RhdGUoJnN0YXRlLT5iYXNlLCBjb25u
LCBjb25uX3N0YXRlLCBpKSB7Cj4gPiArCQlpZiAoY29ubl9zdGF0ZS0+Y3J0YyAhPSAmbWFzdGVy
LT5iYXNlKQo+ID4gKwkJCWNvbnRpbnVlOwo+ID4gKwo+ID4gKwkJZW5jb2RlciA9IHRvX2ludGVs
X2VuY29kZXIoY29ubl9zdGF0ZS0+YmVzdF9lbmNvZGVyKTsKPiA+ICsJCWJyZWFrOwo+ID4gKwl9
Cj4gPiArCj4gPiArCWlmICghY3J0Y19zdGF0ZS0+Ymlnam9pbmVyX3NsYXZlKSB7Cj4gPiArCQkv
KiBuZWVkIHRvIGVuYWJsZSBWRFNDLCB3aGljaCB3ZSBza2lwcGVkIGluIHByZS1lbmFibGUgKi8K
PiA+ICsJCWludGVsX2RzY19lbmFibGUoZW5jb2RlciwgY3J0Y19zdGF0ZSk7Cj4gPiArCX0gZWxz
ZSB7Cj4gPiArCQkvKgo+ID4gKwkJICogRW5hYmxlIHNlcXVlbmNlIHN0ZXBzIDEtNyBvbiBiaWdq
b2luZXIgbWFzdGVyCj4gPiArCQkgKi8KPiAKPiBJJ2QgZXh0ZW5kIHRoaXMgY29tbWVudCB0byBp
bmRpY2F0ZSB0aGF0IHdlIGRvIHRoaXMgb24gdGhlIHNsYXZlICh1c2luZwo+IHRoZSBtYXN0ZXIn
cyBzdGF0ZSwgdHJhbnNjb2RlciwgYW5kIERESSkgYmVjYXVzZSB0aGUgW3dpbGxdIHByb2dyYW0g
dGhlCj4gc2xhdmUgQ1JUQyBiZWZvcmUgdGhlIG1hc3Rlci4KPiAKPiA+ICsJCWludGVsX2VuY29k
ZXJzX3ByZV9wbGxfZW5hYmxlKG1hc3RlciwgbWFzdGVyX2NydGNfc3RhdGUsIHN0YXRlKTsKPiA+
ICsJCWludGVsX2VuYWJsZV9zaGFyZWRfZHBsbChtYXN0ZXJfY3J0Y19zdGF0ZSk7Cj4gPiArCQlp
bnRlbF9lbmNvZGVyc19wcmVfZW5hYmxlKG1hc3RlciwgbWFzdGVyX2NydGNfc3RhdGUsIHN0YXRl
KTsKPiA+ICsKPiA+ICsJCS8qIGFuZCBEU0Mgb24gc2xhdmUgKi8KPiA+ICsJCWludGVsX2RzY19l
bmFibGUoTlVMTCwgY3J0Y19zdGF0ZSk7Cj4gPiArCX0KPiA+ICt9Cj4gPiArCj4gPiAgc3RhdGlj
IHZvaWQgaGFzd2VsbF9jcnRjX2VuYWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9j
b25maWcsCj4gPiAgCQkJCXN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ID4gIHsK
PiA+IEBAIC02NDYyLDM3ICs2NTAxLDM4IEBAIHN0YXRpYyB2b2lkIGhhc3dlbGxfY3J0Y19lbmFi
bGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ID4gIAlpZiAoV0FSTl9P
TihpbnRlbF9jcnRjLT5hY3RpdmUpKQo+ID4gIAkJcmV0dXJuOwo+ID4gIAo+ID4gLQlpbnRlbF9l
bmNvZGVyc19wcmVfcGxsX2VuYWJsZShpbnRlbF9jcnRjLCBwaXBlX2NvbmZpZywgc3RhdGUpOwo+
ID4gKwlpZiAoIXBpcGVfY29uZmlnLT5iaWdqb2luZXIpIHsKPiA+ICsJCWludGVsX2VuY29kZXJz
X3ByZV9wbGxfZW5hYmxlKGludGVsX2NydGMsIHBpcGVfY29uZmlnLCBzdGF0ZSk7Cj4gPiAgCj4g
PiAtCWlmIChwaXBlX2NvbmZpZy0+c2hhcmVkX2RwbGwpCj4gPiAtCQlpbnRlbF9lbmFibGVfc2hh
cmVkX2RwbGwocGlwZV9jb25maWcpOwo+ID4gKwkJaWYgKHBpcGVfY29uZmlnLT5zaGFyZWRfZHBs
bCkKPiA+ICsJCQlpbnRlbF9lbmFibGVfc2hhcmVkX2RwbGwocGlwZV9jb25maWcpOwo+ID4gIAo+
ID4gLQlpbnRlbF9lbmNvZGVyc19wcmVfZW5hYmxlKGludGVsX2NydGMsIHBpcGVfY29uZmlnLCBz
dGF0ZSk7Cj4gPiArCQlpbnRlbF9lbmNvZGVyc19wcmVfZW5hYmxlKGludGVsX2NydGMsIHBpcGVf
Y29uZmlnLCBzdGF0ZSk7Cj4gPiArCX0gZWxzZSB7Cj4gPiArCQlpY2xfZGRpX2JpZ2pvaW5lcl9w
cmVfZW5hYmxlKHN0YXRlLCBwaXBlX2NvbmZpZyk7Cj4gPiArCX0KPiA+ICAKPiA+IC0JaWYgKGlu
dGVsX2NydGNfaGFzX2RwX2VuY29kZXIocGlwZV9jb25maWcpKQo+ID4gLQkJaW50ZWxfZHBfc2V0
X21fbihwaXBlX2NvbmZpZywgTTFfTjEpOwo+ID4gKwlpbnRlbF9zZXRfcGlwZV9zcmNfc2l6ZShw
aXBlX2NvbmZpZyk7Cj4gPiArCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkgfHwgSVNfQlJP
QURXRUxMKGRldl9wcml2KSkKPiA+ICsJCWJkd19zZXRfcGlwZW1pc2MocGlwZV9jb25maWcpOwo+
ID4gIAo+ID4gLQlpZiAoIXRyYW5zY29kZXJfaXNfZHNpKGNwdV90cmFuc2NvZGVyKSkKPiA+IC0J
CWludGVsX3NldF9waXBlX3RpbWluZ3MocGlwZV9jb25maWcpOwo+ID4gKwlpZiAoIXBpcGVfY29u
ZmlnLT5iaWdqb2luZXJfc2xhdmUgJiYgIXRyYW5zY29kZXJfaXNfZHNpKGNwdV90cmFuc2NvZGVy
KSkgewo+ID4gKwkJaWYgKGludGVsX2NydGNfaGFzX2RwX2VuY29kZXIocGlwZV9jb25maWcpKQo+
ID4gKwkJCWludGVsX2RwX3NldF9tX24ocGlwZV9jb25maWcsIE0xX04xKTsKPiA+ICAKPiA+IC0J
aW50ZWxfc2V0X3BpcGVfc3JjX3NpemUocGlwZV9jb25maWcpOwo+ID4gKwkJaW50ZWxfc2V0X3Bp
cGVfdGltaW5ncyhwaXBlX2NvbmZpZyk7Cj4gPiAgCj4gPiAtCWlmIChjcHVfdHJhbnNjb2RlciAh
PSBUUkFOU0NPREVSX0VEUCAmJgo+ID4gLQkgICAgIXRyYW5zY29kZXJfaXNfZHNpKGNwdV90cmFu
c2NvZGVyKSkgewo+ID4gLQkJSTkxNV9XUklURShQSVBFX01VTFQoY3B1X3RyYW5zY29kZXIpLAo+
ID4gLQkJCSAgIHBpcGVfY29uZmlnLT5waXhlbF9tdWx0aXBsaWVyIC0gMSk7Cj4gPiAtCX0KPiA+
ICsJCWlmIChjcHVfdHJhbnNjb2RlciAhPSBUUkFOU0NPREVSX0VEUCkKPiA+ICsJCQlJOTE1X1dS
SVRFKFBJUEVfTVVMVChjcHVfdHJhbnNjb2RlciksCj4gPiArCQkJCSAgcGlwZV9jb25maWctPnBp
eGVsX211bHRpcGxpZXIgLSAxKTsKPiA+ICAKPiA+IC0JaWYgKHBpcGVfY29uZmlnLT5oYXNfcGNo
X2VuY29kZXIpIHsKPiA+IC0JCWludGVsX2NwdV90cmFuc2NvZGVyX3NldF9tX24ocGlwZV9jb25m
aWcsCj4gPiAtCQkJCQkgICAgICZwaXBlX2NvbmZpZy0+ZmRpX21fbiwgTlVMTCk7Cj4gPiAtCX0K
PiA+ICsJCWlmIChwaXBlX2NvbmZpZy0+aGFzX3BjaF9lbmNvZGVyKSB7Cj4gPiArCQkJaW50ZWxf
Y3B1X3RyYW5zY29kZXJfc2V0X21fbihwaXBlX2NvbmZpZywKPiA+ICsJCQkJCQkgICAgJnBpcGVf
Y29uZmlnLT5mZGlfbV9uLCBOVUxMKTsKPiA+ICsJCX0KPiA+ICAKPiA+IC0JaWYgKCF0cmFuc2Nv
ZGVyX2lzX2RzaShjcHVfdHJhbnNjb2RlcikpCj4gPiAgCQloYXN3ZWxsX3NldF9waXBlY29uZihw
aXBlX2NvbmZpZyk7Cj4gPiAtCj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkgfHwg
SVNfQlJPQURXRUxMKGRldl9wcml2KSkKPiA+IC0JCWJkd19zZXRfcGlwZW1pc2MocGlwZV9jb25m
aWcpOwo+ID4gKwl9Cj4gPiAgCj4gPiAgCWludGVsX2NydGMtPmFjdGl2ZSA9IHRydWU7Cj4gPiAg
Cj4gPiBAQCAtNjUyMCw5ICs2NTYwLDExIEBAIHN0YXRpYyB2b2lkIGhhc3dlbGxfY3J0Y19lbmFi
bGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ID4gIAlpZiAoSU5URUxf
R0VOKGRldl9wcml2KSA+PSAxMSkKPiA+ICAJCWljbF9zZXRfcGlwZV9jaGlja2VuKGludGVsX2Ny
dGMpOwo+ID4gIAo+ID4gLQlpbnRlbF9kZGlfc2V0X3BpcGVfc2V0dGluZ3MocGlwZV9jb25maWcp
Owo+ID4gLQlpZiAoIXRyYW5zY29kZXJfaXNfZHNpKGNwdV90cmFuc2NvZGVyKSkKPiA+ICsJaWYg
KCFwaXBlX2NvbmZpZy0+Ymlnam9pbmVyX3NsYXZlICYmICF0cmFuc2NvZGVyX2lzX2RzaShjcHVf
dHJhbnNjb2RlcikpIHsKPiA+ICsJCWludGVsX2RkaV9zZXRfcGlwZV9zZXR0aW5ncyhwaXBlX2Nv
bmZpZyk7Cj4gPiArCj4gPiAgCQlpbnRlbF9kZGlfZW5hYmxlX3RyYW5zY29kZXJfZnVuYyhwaXBl
X2NvbmZpZyk7Cj4gPiArCX0KPiA+ICAKPiA+ICAJaWYgKGRldl9wcml2LT5kaXNwbGF5LmluaXRp
YWxfd2F0ZXJtYXJrcyAhPSBOVUxMKQo+ID4gIAkJZGV2X3ByaXYtPmRpc3BsYXkuaW5pdGlhbF93
YXRlcm1hcmtzKHN0YXRlLCBwaXBlX2NvbmZpZyk7Cj4gPiBAQCAtNjUzMSw4ICs2NTczLDEwIEBA
IHN0YXRpYyB2b2lkIGhhc3dlbGxfY3J0Y19lbmFibGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KnBpcGVfY29uZmlnLAo+ID4gIAkJaWNsX3BpcGVfbWJ1c19lbmFibGUoaW50ZWxfY3J0Yyk7Cj4g
PiAgCj4gPiAgCS8qIFhYWDogRG8gdGhlIHBpcGUgYXNzZXJ0aW9ucyBhdCB0aGUgcmlnaHQgcGxh
Y2UgZm9yIEJYVCBEU0kuICovCj4gPiAtCWlmICghdHJhbnNjb2Rlcl9pc19kc2koY3B1X3RyYW5z
Y29kZXIpKQo+ID4gKwlpZiAoIXBpcGVfY29uZmlnLT5iaWdqb2luZXJfc2xhdmUgJiYgIXRyYW5z
Y29kZXJfaXNfZHNpKGNwdV90cmFuc2NvZGVyKSkKPiA+ICAJCWludGVsX2VuYWJsZV9waXBlKHBp
cGVfY29uZmlnKTsKPiA+ICsJZWxzZQo+ID4gKwkJdHJhY2VfaW50ZWxfcGlwZV9lbmFibGUoaW50
ZWxfY3J0Yyk7Cj4gPiAgCj4gPiAgCWlmIChwaXBlX2NvbmZpZy0+aGFzX3BjaF9lbmNvZGVyKQo+
ID4gIAkJbHB0X3BjaF9lbmFibGUoc3RhdGUsIHBpcGVfY29uZmlnKTsKPiA+IEBAIC02NjYzLDkg
KzY3MDcsMjcgQEAgc3RhdGljIHZvaWQgaGFzd2VsbF9jcnRjX2Rpc2FibGUoc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+ID4gIAllbHNlCj4gPiAgCQlpcm9ubGFrZV9w
Zml0X2Rpc2FibGUob2xkX2NydGNfc3RhdGUpOwo+ID4gIAo+ID4gLQlpbnRlbF9lbmNvZGVyc19w
b3N0X2Rpc2FibGUoaW50ZWxfY3J0Yywgb2xkX2NydGNfc3RhdGUsIHN0YXRlKTsKPiA+ICsJaWYg
KG9sZF9jcnRjX3N0YXRlLT5iaWdqb2luZXIpIHsKPiA+ICsJCXN0cnVjdCBpbnRlbF9jcnRjICpt
YXN0ZXI7Cj4gPiArCQlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbWFzdGVyX2NydGNfc3RhdGU7
Cj4gPiAgCj4gPiAtCWludGVsX2VuY29kZXJzX3Bvc3RfcGxsX2Rpc2FibGUoaW50ZWxfY3J0Yywg
b2xkX2NydGNfc3RhdGUsIHN0YXRlKTsKPiA+ICsJCS8qIHBvcnRzIGFyZSBkaXNhYmxlZCBmcm9t
IHRoZSBzbGF2ZSwgYWZ0ZXIgaXQgZGVjb25maWd1cmVzICovCj4gPiArCQlpZiAoIW9sZF9jcnRj
X3N0YXRlLT5iaWdqb2luZXJfc2xhdmUpCj4gPiArCQkJcmV0dXJuOwo+ID4gKwo+ID4gKwkJbWFz
dGVyID0gb2xkX2NydGNfc3RhdGUtPmJpZ2pvaW5lcl9saW5rZWRfY3J0YzsKPiA+ICsJCW1hc3Rl
cl9jcnRjX3N0YXRlID0gaW50ZWxfYXRvbWljX2dldF9vbGRfY3J0Y19zdGF0ZShzdGF0ZSwgbWFz
dGVyKTsKPiA+ICsKPiA+ICsJCWludGVsX2RkaV9kaXNhYmxlX3BpcGVfY2xvY2sob2xkX2NydGNf
c3RhdGUpOwo+ID4gKwo+ID4gKwkJLyogZGlzYWJsZSBwb3J0cyBvbiB0aGUgbWFzdGVyIGNydGMg
Ki8KPiA+ICsJCWludGVsX2VuY29kZXJzX3Bvc3RfZGlzYWJsZShtYXN0ZXIsIG1hc3Rlcl9jcnRj
X3N0YXRlLCBzdGF0ZSk7Cj4gPiArCQlpbnRlbF9lbmNvZGVyc19wb3N0X3BsbF9kaXNhYmxlKG1h
c3RlciwgbWFzdGVyX2NydGNfc3RhdGUsIHN0YXRlKTsKPiA+ICsJfSBlbHNlIHsKPiA+ICsJCWlu
dGVsX2VuY29kZXJzX3Bvc3RfZGlzYWJsZShpbnRlbF9jcnRjLCBvbGRfY3J0Y19zdGF0ZSwgc3Rh
dGUpOwo+ID4gKwo+ID4gKwkJaW50ZWxfZW5jb2RlcnNfcG9zdF9wbGxfZGlzYWJsZShpbnRlbF9j
cnRjLCBvbGRfY3J0Y19zdGF0ZSwgc3RhdGUpOwo+ID4gKwl9Cj4gPiAgfQo+ID4gIAo+ID4gIHN0
YXRpYyB2b2lkIGk5eHhfcGZpdF9lbmFibGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUpCj4gPiBAQCAtNjgyOSw2ICs2ODkxLDkgQEAgc3RhdGljIHU2NCBnZXRfY3J0
Y19wb3dlcl9kb21haW5zKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4g
IAlpZiAoY3J0Y19zdGF0ZS0+c2hhcmVkX2RwbGwpCj4gPiAgCQltYXNrIHw9IEJJVF9VTEwoUE9X
RVJfRE9NQUlOX0RJU1BMQVlfQ09SRSk7Cj4gPiAgCj4gPiArCWlmIChjcnRjX3N0YXRlLT5kc2Nf
cGFyYW1zLmNvbXByZXNzaW9uX2VuYWJsZSkKPiA+ICsJCW1hc2sgfD0gQklUX1VMTChpbnRlbF9k
c2NfcG93ZXJfZG9tYWluKGNydGNfc3RhdGUpKTsKPiA+ICsKPiA+ICAJcmV0dXJuIG1hc2s7Cj4g
PiAgfQo+ID4gIAo+ID4gQEAgLTc0MTcsNiArNzQ4MiwxOSBAQCBzdGF0aWMgdTMyIGlsa19waXBl
X3BpeGVsX3JhdGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+
ID4gIAlyZXR1cm4gcGl4ZWxfcmF0ZTsKPiA+ICB9Cj4gPiAgCj4gPiArc3RhdGljIHZvaWQgaW50
ZWxfZW5jb2Rlcl9nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4g
KwkJCQkgICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gK3sKPiA+
ICsJZW5jb2Rlci0+Z2V0X2NvbmZpZyhlbmNvZGVyLCBjcnRjX3N0YXRlKTsKPiA+ICsKPiA+ICsJ
Y3J0Y19zdGF0ZS0+aHcudHJhbnNjb2Rlcl9tb2RlLmZsYWdzID0gY3J0Y19zdGF0ZS0+aHcuYWRq
dXN0ZWRfbW9kZS5mbGFnczsKPiA+ICsKPiA+ICsJLyogaWYgdHJhbnNjb2RlciBjbG9jayBpcyBu
b3Qgc2V0LCBhc3N1bWUgc2FtZSBhcyBhZGp1c3RlZF9tb2RlIGNsb2NrICovCj4gPiArCWlmICgh
Y3J0Y19zdGF0ZS0+aHcudHJhbnNjb2Rlcl9tb2RlLmNydGNfY2xvY2spCj4gPiArCQljcnRjX3N0
YXRlLT5ody50cmFuc2NvZGVyX21vZGUuY3J0Y19jbG9jayA9Cj4gPiArCQkJY3J0Y19zdGF0ZS0+
aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrOwo+ID4gK30KPiA+ICsKPiA+ICBzdGF0aWMgdm9p
ZCBpbnRlbF9jcnRjX2NvbXB1dGVfcGl4ZWxfcmF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSkKPiA+ICB7Cj4gPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjLT5kZXYpOwo+ID4gQEAgLTgyNjUsNiAr
ODM0MywyNCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9nZXRfcGlwZV90aW1pbmdzKHN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjLAo+ID4gIAkJcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUuY3J0Y192
dG90YWwgKz0gMTsKPiA+ICAJCXBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfdmJs
YW5rX2VuZCArPSAxOwo+ID4gIAl9Cj4gPiArCj4gPiArCXBpcGVfY29uZmlnLT5ody50cmFuc2Nv
ZGVyX21vZGUgPSBwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZTsKPiA+ICsJaWYgKHBpcGVf
Y29uZmlnLT5iaWdqb2luZXIpIHsKPiA+ICsJCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1
c3RlZF9tb2RlID0KPiA+ICsJCQkmcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGU7Cj4gPiAr
Cj4gPiArCQkvKgo+ID4gKwkJICAqIHRyYW5zY29kZXIgaXMgcHJvZ3JhbW1lZCB0byB0aGUgZnVs
bCBtb2RlLAo+ID4gKwkJICAqIGJ1dCBwaXBqZSB0aW1pbmdzIGFyZSBoYWxmIG9mIHRoZSB0cmFu
c2NvZGVyIG1vZGUKPiA+ICsJCSAgKi8KPiA+ICsJCWFkanVzdGVkX21vZGUtPmNydGNfaGRpc3Bs
YXkgLz0gMjsKPiA+ICsJCWFkanVzdGVkX21vZGUtPmNydGNfaGJsYW5rX3N0YXJ0IC89IDI7Cj4g
PiArCQlhZGp1c3RlZF9tb2RlLT5jcnRjX2hibGFua19lbmQgLz0gMjsKPiA+ICsJCWFkanVzdGVk
X21vZGUtPmNydGNfaHN5bmNfc3RhcnQgLz0gMjsKPiA+ICsJCWFkanVzdGVkX21vZGUtPmNydGNf
aHN5bmNfZW5kIC89IDI7Cj4gPiArCQlhZGp1c3RlZF9tb2RlLT5jcnRjX2h0b3RhbCAvPSAyOwo+
ID4gKwkJYWRqdXN0ZWRfbW9kZS0+Y3J0Y19oc2tldyAvPSAyOwo+ID4gKwl9Cj4gPiAgfQo+ID4g
IAo+ID4gIHN0YXRpYyB2b2lkIGludGVsX2dldF9waXBlX3NyY19zaXplKHN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjLAo+ID4gQEAgLTgyODUsMjAgKzgzODEsMjIgQEAgc3RhdGljIHZvaWQgaW50ZWxf
Z2V0X3BpcGVfc3JjX3NpemUoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgdm9pZCBpbnRl
bF9tb2RlX2Zyb21fcGlwZV9jb25maWcoc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUsCj4g
PiAgCQkJCSBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gPiAgewo+ID4g
LQltb2RlLT5oZGlzcGxheSA9IHBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfaGRp
c3BsYXk7Cj4gPiAtCW1vZGUtPmh0b3RhbCA9IHBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2Rl
LmNydGNfaHRvdGFsOwo+ID4gLQltb2RlLT5oc3luY19zdGFydCA9IHBpcGVfY29uZmlnLT5ody5h
ZGp1c3RlZF9tb2RlLmNydGNfaHN5bmNfc3RhcnQ7Cj4gPiAtCW1vZGUtPmhzeW5jX2VuZCA9IHBp
cGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfaHN5bmNfZW5kOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2Rpc3BsYXlfbW9kZSAqaHdfbW9kZSA9ICZwaXBlX2NvbmZpZy0+aHcudHJhbnNjb2Rlcl9t
b2RlOwo+ID4gIAo+ID4gLQltb2RlLT52ZGlzcGxheSA9IHBpcGVfY29uZmlnLT5ody5hZGp1c3Rl
ZF9tb2RlLmNydGNfdmRpc3BsYXk7Cj4gPiAtCW1vZGUtPnZ0b3RhbCA9IHBpcGVfY29uZmlnLT5o
dy5hZGp1c3RlZF9tb2RlLmNydGNfdnRvdGFsOwo+ID4gLQltb2RlLT52c3luY19zdGFydCA9IHBp
cGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfdnN5bmNfc3RhcnQ7Cj4gPiAtCW1vZGUt
PnZzeW5jX2VuZCA9IHBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfdnN5bmNfZW5k
Owo+ID4gKwltb2RlLT5oZGlzcGxheSA9IGh3X21vZGUtPmNydGNfaGRpc3BsYXk7Cj4gPiArCW1v
ZGUtPmh0b3RhbCA9IGh3X21vZGUtPmNydGNfaHRvdGFsOwo+ID4gKwltb2RlLT5oc3luY19zdGFy
dCA9IGh3X21vZGUtPmNydGNfaHN5bmNfc3RhcnQ7Cj4gPiArCW1vZGUtPmhzeW5jX2VuZCA9IGh3
X21vZGUtPmNydGNfaHN5bmNfZW5kOwo+ID4gIAo+ID4gLQltb2RlLT5mbGFncyA9IHBpcGVfY29u
ZmlnLT5ody5hZGp1c3RlZF9tb2RlLmZsYWdzOwo+ID4gKwltb2RlLT52ZGlzcGxheSA9IGh3X21v
ZGUtPmNydGNfdmRpc3BsYXk7Cj4gPiArCW1vZGUtPnZ0b3RhbCA9IGh3X21vZGUtPmNydGNfdnRv
dGFsOwo+ID4gKwltb2RlLT52c3luY19zdGFydCA9IGh3X21vZGUtPmNydGNfdnN5bmNfc3RhcnQ7
Cj4gPiArCW1vZGUtPnZzeW5jX2VuZCA9IGh3X21vZGUtPmNydGNfdnN5bmNfZW5kOwo+ID4gKwo+
ID4gKwltb2RlLT5mbGFncyA9IGh3X21vZGUtPmZsYWdzOwo+ID4gIAltb2RlLT50eXBlID0gRFJN
X01PREVfVFlQRV9EUklWRVI7Cj4gPiAgCj4gPiAtCW1vZGUtPmNsb2NrID0gcGlwZV9jb25maWct
Pmh3LmFkanVzdGVkX21vZGUuY3J0Y19jbG9jazsKPiA+ICsJbW9kZS0+Y2xvY2sgPSBod19tb2Rl
LT5jcnRjX2Nsb2NrOwo+ID4gIAo+ID4gIAltb2RlLT5oc3luYyA9IGRybV9tb2RlX2hzeW5jKG1v
ZGUpOwo+ID4gIAltb2RlLT52cmVmcmVzaCA9IGRybV9tb2RlX3ZyZWZyZXNoKG1vZGUpOwo+ID4g
QEAgLTEwMzg1LDYgKzEwNDgzLDggQEAgc3RhdGljIHZvaWQgaGFzd2VsbF9nZXRfZGRpX3BvcnRf
c3RhdGUoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgCXUzMiB0bXA7Cj4gPiAgCj4gPiAg
CXRtcCA9IEk5MTVfUkVBRChUUkFOU19ERElfRlVOQ19DVEwocGlwZV9jb25maWctPmNwdV90cmFu
c2NvZGVyKSk7Cj4gPiArCWlmICghKHRtcCAmIFRSQU5TX0RESV9GVU5DX0VOQUJMRSkpCj4gPiAr
CQlyZXR1cm47Cj4gPiAgCj4gPiAgCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEyKQo+ID4g
IAkJcG9ydCA9IFRHTF9UUkFOU19ERElfRlVOQ19DVExfVkFMX1RPX1BPUlQodG1wKTsKPiA+IEBA
IC0xMDQ1NSwxMSArMTA1NTUsMTkgQEAgc3RhdGljIGJvb2wgaGFzd2VsbF9nZXRfcGlwZV9jb25m
aWcoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgCQlXQVJOX09OKGFjdGl2ZSk7Cj4gPiAg
CQlhY3RpdmUgPSB0cnVlOwo+ID4gIAl9Cj4gPiArCWludGVsX2RzY19nZXRfY29uZmlnKHBpcGVf
Y29uZmlnKTsKPiA+ICAKPiA+IC0JaWYgKCFhY3RpdmUpCj4gPiAtCQlnb3RvIG91dDsKPiA+ICsJ
aWYgKCFhY3RpdmUpIHsKPiA+ICsJCS8qIGJpZ2pvaW5lciBzbGF2ZSBkb2Vzbid0IGVuYWJsZSB0
cmFuc2NvZGVyICovCj4gPiArCQlpZiAoIXBpcGVfY29uZmlnLT5iaWdqb2luZXJfc2xhdmUpCj4g
PiArCQkJZ290byBvdXQ7Cj4gPiArCj4gPiArCQlhY3RpdmUgPSB0cnVlOwo+ID4gKwkJcGlwZV9j
b25maWctPnBpeGVsX211bHRpcGxpZXIgPSAxOwo+ID4gIAo+ID4gLQlpZiAoIXRyYW5zY29kZXJf
aXNfZHNpKHBpcGVfY29uZmlnLT5jcHVfdHJhbnNjb2RlcikgfHwKPiA+ICsJCS8qIHdlIGNhbm5v
dCByZWFkIG91dCBtb3N0IHN0YXRlLCBzbyBkb24ndCBib3RoZXIuLiAqLwo+ID4gKwkJcGlwZV9j
b25maWctPnF1aXJrcyB8PSBQSVBFX0NPTkZJR19RVUlSS19CSUdKT0lORVJfU0xBVkU7Cj4gPiAr
CX0gZWxzZSBpZiAoIXRyYW5zY29kZXJfaXNfZHNpKHBpcGVfY29uZmlnLT5jcHVfdHJhbnNjb2Rl
cikgfHwKPiA+ICAJICAgIElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpIHsKPiA+ICAJCWhhc3dl
bGxfZ2V0X2RkaV9wb3J0X3N0YXRlKGNydGMsIHBpcGVfY29uZmlnKTsKPiA+ICAJCWludGVsX2dl
dF9waXBlX3RpbWluZ3MoY3J0YywgcGlwZV9jb25maWcpOwo+ID4gQEAgLTEwNTEzLDcgKzEwNjIx
LDEwIEBAIHN0YXRpYyBib29sIGhhc3dlbGxfZ2V0X3BpcGVfY29uZmlnKHN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjLAo+ID4gIAkJfQo+ID4gIAl9Cj4gPiAgCj4gPiAtCWlmIChwaXBlX2NvbmZpZy0+
Y3B1X3RyYW5zY29kZXIgIT0gVFJBTlNDT0RFUl9FRFAgJiYKPiA+ICsJaWYgKHBpcGVfY29uZmln
LT5iaWdqb2luZXJfc2xhdmUpIHsKPiA+ICsJCS8qIENhbm5vdCBiZSByZWFkIG91dCBhcyBhIHNs
YXZlLCBzZXQgdG8gMC4gKi8KPiA+ICsJCXBpcGVfY29uZmlnLT5waXhlbF9tdWx0aXBsaWVyID0g
MDsKPiA+ICsJfSBlbHNlIGlmIChwaXBlX2NvbmZpZy0+Y3B1X3RyYW5zY29kZXIgIT0gVFJBTlND
T0RFUl9FRFAgJiYKPiA+ICAJICAgICF0cmFuc2NvZGVyX2lzX2RzaShwaXBlX2NvbmZpZy0+Y3B1
X3RyYW5zY29kZXIpKSB7Cj4gPiAgCQlwaXBlX2NvbmZpZy0+cGl4ZWxfbXVsdGlwbGllciA9Cj4g
PiAgCQkJSTkxNV9SRUFEKFBJUEVfTVVMVChwaXBlX2NvbmZpZy0+Y3B1X3RyYW5zY29kZXIpKSAr
IDE7Cj4gPiBAQCAtMTE0NjgsNyArMTE1NzksNyBAQCBpbnRlbF9lbmNvZGVyX2N1cnJlbnRfbW9k
ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAJCXJldHVybiBOVUxMOwo+ID4g
IAl9Cj4gPiAgCj4gPiAtCWVuY29kZXItPmdldF9jb25maWcoZW5jb2RlciwgY3J0Y19zdGF0ZSk7
Cj4gPiArCWludGVsX2VuY29kZXJfZ2V0X2NvbmZpZyhlbmNvZGVyLCBjcnRjX3N0YXRlKTsKPiA+
ICAKPiA+ICAJaW50ZWxfbW9kZV9mcm9tX3BpcGVfY29uZmlnKG1vZGUsIGNydGNfc3RhdGUpOwo+
ID4gIAo+ID4gQEAgLTEyMjg1LDkgKzEyMzk2LDExIEBAIHN0YXRpYyB2b2lkIGNvcHlfdWFwaV90
b19od19zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAKPiA+
ICBzdGF0aWMgdm9pZCBjb3B5X2h3X3RvX3VhcGlfc3RhdGUoc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUpCj4gPiAgewo+ID4gLQljcnRjX3N0YXRlLT51YXBpLmVuYWJsZSA9IGNy
dGNfc3RhdGUtPmh3LmVuYWJsZTsKPiA+IC0JY3J0Y19zdGF0ZS0+dWFwaS5hY3RpdmUgPSBjcnRj
X3N0YXRlLT5ody5hY3RpdmU7Cj4gPiAtCWNydGNfc3RhdGUtPnVhcGkubW9kZSA9IGNydGNfc3Rh
dGUtPmh3Lm1vZGU7Cj4gPiArCWlmICghY3J0Y19zdGF0ZS0+Ymlnam9pbmVyX3NsYXZlKSB7Cj4g
PiArCQljcnRjX3N0YXRlLT51YXBpLmVuYWJsZSA9IGNydGNfc3RhdGUtPmh3LmVuYWJsZTsKPiA+
ICsJCWNydGNfc3RhdGUtPnVhcGkuYWN0aXZlID0gY3J0Y19zdGF0ZS0+aHcuYWN0aXZlOwo+ID4g
KwkJY3J0Y19zdGF0ZS0+dWFwaS5tb2RlID0gY3J0Y19zdGF0ZS0+aHcubW9kZTsKPiA+ICsJfQo+
ID4gIAljcnRjX3N0YXRlLT51YXBpLmFkanVzdGVkX21vZGUgPSBjcnRjX3N0YXRlLT5ody50cmFu
c2NvZGVyX21vZGU7Cj4gPiAgfQo+ID4gIAo+ID4gQEAgLTEyMzE4LDYgKzEyNDMxLDcgQEAgY29w
eV9iaWdqb2luZXJfY3J0Y19zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSwKPiA+ICAJY3J0Y19zdGF0ZS0+aHcuYWN0aXZlID0gZnJvbV9jcnRjX3N0YXRlLT5ody5hY3Rp
dmU7Cj4gPiAgCWNydGNfc3RhdGUtPmh3Lm1vZGUgPSBmcm9tX2NydGNfc3RhdGUtPmh3Lm1vZGU7
Cj4gPiAgCWNydGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGUgPSBmcm9tX2NydGNfc3RhdGUtPmh3
LmFkanVzdGVkX21vZGU7Cj4gPiArCWNydGNfc3RhdGUtPmh3LnRyYW5zY29kZXJfbW9kZSA9IGZy
b21fY3J0Y19zdGF0ZS0+aHcudHJhbnNjb2Rlcl9tb2RlOwo+ID4gIAo+ID4gIAkvKiBTb21lIGZp
eHVwcyAqLwo+ID4gIAljcnRjX3N0YXRlLT51YXBpLm1vZGVfY2hhbmdlZCA9IGZyb21fY3J0Y19z
dGF0ZS0+dWFwaS5tb2RlX2NoYW5nZWQ7Cj4gPiBAQCAtMTI4MzMsMTkgKzEyOTQ3LDQxIEBAIGlu
dGVsX3BpcGVfY29uZmlnX2NvbXBhcmUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmN1
cnJlbnRfY29uZmlnLAo+ID4gIAo+ID4gIAlQSVBFX0NPTkZfQ0hFQ0tfWChvdXRwdXRfdHlwZXMp
Owo+ID4gIAo+ID4gLQlQSVBFX0NPTkZfQ0hFQ0tfSShody5hZGp1c3RlZF9tb2RlLmNydGNfaGRp
c3BsYXkpOwo+ID4gLQlQSVBFX0NPTkZfQ0hFQ0tfSShody5hZGp1c3RlZF9tb2RlLmNydGNfaHRv
dGFsKTsKPiA+IC0JUElQRV9DT05GX0NIRUNLX0koaHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2hibGFu
a19zdGFydCk7Cj4gPiAtCVBJUEVfQ09ORl9DSEVDS19JKGh3LmFkanVzdGVkX21vZGUuY3J0Y19o
YmxhbmtfZW5kKTsKPiA+IC0JUElQRV9DT05GX0NIRUNLX0koaHcuYWRqdXN0ZWRfbW9kZS5jcnRj
X2hzeW5jX3N0YXJ0KTsKPiA+IC0JUElQRV9DT05GX0NIRUNLX0koaHcuYWRqdXN0ZWRfbW9kZS5j
cnRjX2hzeW5jX2VuZCk7Cj4gPiAtCj4gPiAtCVBJUEVfQ09ORl9DSEVDS19JKGh3LmFkanVzdGVk
X21vZGUuY3J0Y192ZGlzcGxheSk7Cj4gPiAtCVBJUEVfQ09ORl9DSEVDS19JKGh3LmFkanVzdGVk
X21vZGUuY3J0Y192dG90YWwpOwo+ID4gLQlQSVBFX0NPTkZfQ0hFQ0tfSShody5hZGp1c3RlZF9t
b2RlLmNydGNfdmJsYW5rX3N0YXJ0KTsKPiA+IC0JUElQRV9DT05GX0NIRUNLX0koaHcuYWRqdXN0
ZWRfbW9kZS5jcnRjX3ZibGFua19lbmQpOwo+ID4gLQlQSVBFX0NPTkZfQ0hFQ0tfSShody5hZGp1
c3RlZF9tb2RlLmNydGNfdnN5bmNfc3RhcnQpOwo+ID4gLQlQSVBFX0NPTkZfQ0hFQ0tfSShody5h
ZGp1c3RlZF9tb2RlLmNydGNfdnN5bmNfZW5kKTsKPiA+ICsJaWYgKCFQSVBFX0NPTkZfUVVJUkso
UElQRV9DT05GSUdfUVVJUktfQklHSk9JTkVSX1NMQVZFKSkgewo+ID4gKwkJLyogYmlnam9pbmVy
IG1vZGUgPSB0cmFuc2NvZGVyIG1vZGUgLyAyLCBmb3IgY2FsY3VsYXRpb25zICovCj4gPiArCQlQ
SVBFX0NPTkZfQ0hFQ0tfSShody5hZGp1c3RlZF9tb2RlLmNydGNfaGRpc3BsYXkpOwo+ID4gKwkJ
UElQRV9DT05GX0NIRUNLX0koaHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2h0b3RhbCk7Cj4gPiArCQlQ
SVBFX0NPTkZfQ0hFQ0tfSShody5hZGp1c3RlZF9tb2RlLmNydGNfdmRpc3BsYXkpOwo+ID4gKwkJ
UElQRV9DT05GX0NIRUNLX0koaHcuYWRqdXN0ZWRfbW9kZS5jcnRjX3Z0b3RhbCk7Cj4gPiArCj4g
PiArCQlQSVBFX0NPTkZfQ0hFQ0tfSShody50cmFuc2NvZGVyX21vZGUuY3J0Y19oZGlzcGxheSk7
Cj4gPiArCQlQSVBFX0NPTkZfQ0hFQ0tfSShody50cmFuc2NvZGVyX21vZGUuY3J0Y19odG90YWwp
Owo+ID4gKwkJUElQRV9DT05GX0NIRUNLX0koaHcudHJhbnNjb2Rlcl9tb2RlLmNydGNfaGJsYW5r
X3N0YXJ0KTsKPiA+ICsJCVBJUEVfQ09ORl9DSEVDS19JKGh3LnRyYW5zY29kZXJfbW9kZS5jcnRj
X2hibGFua19lbmQpOwo+ID4gKwkJUElQRV9DT05GX0NIRUNLX0koaHcudHJhbnNjb2Rlcl9tb2Rl
LmNydGNfaHN5bmNfc3RhcnQpOwo+ID4gKwkJUElQRV9DT05GX0NIRUNLX0koaHcudHJhbnNjb2Rl
cl9tb2RlLmNydGNfaHN5bmNfZW5kKTsKPiA+ICsKPiA+ICsJCVBJUEVfQ09ORl9DSEVDS19JKGh3
LnRyYW5zY29kZXJfbW9kZS5jcnRjX3ZkaXNwbGF5KTsKPiA+ICsJCVBJUEVfQ09ORl9DSEVDS19J
KGh3LnRyYW5zY29kZXJfbW9kZS5jcnRjX3Z0b3RhbCk7Cj4gPiArCQlQSVBFX0NPTkZfQ0hFQ0tf
SShody50cmFuc2NvZGVyX21vZGUuY3J0Y192Ymxhbmtfc3RhcnQpOwo+ID4gKwkJUElQRV9DT05G
X0NIRUNLX0koaHcudHJhbnNjb2Rlcl9tb2RlLmNydGNfdmJsYW5rX2VuZCk7Cj4gPiArCQlQSVBF
X0NPTkZfQ0hFQ0tfSShody50cmFuc2NvZGVyX21vZGUuY3J0Y192c3luY19zdGFydCk7Cj4gPiAr
CQlQSVBFX0NPTkZfQ0hFQ0tfSShody50cmFuc2NvZGVyX21vZGUuY3J0Y192c3luY19lbmQpOwo+
ID4gKwo+ID4gKwkJUElQRV9DT05GX0NIRUNLX0ZMQUdTKGh3LnRyYW5zY29kZXJfbW9kZS5mbGFn
cywKPiA+ICsJCQkJICAgICAgRFJNX01PREVfRkxBR19JTlRFUkxBQ0UpOwo+ID4gKwo+ID4gKwkJ
aWYgKCFQSVBFX0NPTkZfUVVJUksoUElQRV9DT05GSUdfUVVJUktfTU9ERV9TWU5DX0ZMQUdTKSkg
ewo+ID4gKwkJCVBJUEVfQ09ORl9DSEVDS19GTEFHUyhody50cmFuc2NvZGVyX21vZGUuZmxhZ3Ms
Cj4gPiArCQkJCQkgICAgICBEUk1fTU9ERV9GTEFHX1BIU1lOQyk7Cj4gPiArCQkJUElQRV9DT05G
X0NIRUNLX0ZMQUdTKGh3LnRyYW5zY29kZXJfbW9kZS5mbGFncywKPiA+ICsJCQkJCSAgICAgIERS
TV9NT0RFX0ZMQUdfTkhTWU5DKTsKPiA+ICsJCQlQSVBFX0NPTkZfQ0hFQ0tfRkxBR1MoaHcudHJh
bnNjb2Rlcl9tb2RlLmZsYWdzLAo+ID4gKwkJCQkJICAgICAgRFJNX01PREVfRkxBR19QVlNZTkMp
Owo+ID4gKwkJCVBJUEVfQ09ORl9DSEVDS19GTEFHUyhody50cmFuc2NvZGVyX21vZGUuZmxhZ3Ms
Cj4gPiArCQkJCQkgICAgICBEUk1fTU9ERV9GTEFHX05WU1lOQyk7Cj4gPiArCQl9Cj4gPiArCX0K
PiA+ICAKPiA+ICAJUElQRV9DT05GX0NIRUNLX0kocGl4ZWxfbXVsdGlwbGllcik7Cj4gPiAgCVBJ
UEVfQ09ORl9DSEVDS19JKG91dHB1dF9mb3JtYXQpOwo+ID4gQEAgLTEyODU3LDI0ICsxMjk5Mywx
MSBAQCBpbnRlbF9waXBlX2NvbmZpZ19jb21wYXJlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjdXJyZW50X2NvbmZpZywKPiA+ICAJUElQRV9DT05GX0NIRUNLX0JPT0woaGRtaV9zY3Jh
bWJsaW5nKTsKPiA+ICAJUElQRV9DT05GX0NIRUNLX0JPT0woaGRtaV9oaWdoX3RtZHNfY2xvY2tf
cmF0aW8pOwo+ID4gIAlQSVBFX0NPTkZfQ0hFQ0tfQk9PTChoYXNfaW5mb2ZyYW1lKTsKPiA+IC0J
UElQRV9DT05GX0NIRUNLX0JPT0woZmVjX2VuYWJsZSk7Cj4gPiArCWlmICghUElQRV9DT05GX1FV
SVJLKFBJUEVfQ09ORklHX1FVSVJLX0JJR0pPSU5FUl9TTEFWRSkpCj4gPiArCQlQSVBFX0NPTkZf
Q0hFQ0tfQk9PTChmZWNfZW5hYmxlKTsKPiA+ICAKPiA+ICAJUElQRV9DT05GX0NIRUNLX0JPT0xf
SU5DT01QTEVURShoYXNfYXVkaW8pOwo+ID4gIAo+ID4gLQlQSVBFX0NPTkZfQ0hFQ0tfRkxBR1Mo
aHcuYWRqdXN0ZWRfbW9kZS5mbGFncywKPiA+IC0JCQkgICAgICBEUk1fTU9ERV9GTEFHX0lOVEVS
TEFDRSk7Cj4gPiAtCj4gPiAtCWlmICghUElQRV9DT05GX1FVSVJLKFBJUEVfQ09ORklHX1FVSVJL
X01PREVfU1lOQ19GTEFHUykpIHsKPiA+IC0JCVBJUEVfQ09ORl9DSEVDS19GTEFHUyhody5hZGp1
c3RlZF9tb2RlLmZsYWdzLAo+ID4gLQkJCQkgICAgICBEUk1fTU9ERV9GTEFHX1BIU1lOQyk7Cj4g
PiAtCQlQSVBFX0NPTkZfQ0hFQ0tfRkxBR1MoaHcuYWRqdXN0ZWRfbW9kZS5mbGFncywKPiA+IC0J
CQkJICAgICAgRFJNX01PREVfRkxBR19OSFNZTkMpOwo+ID4gLQkJUElQRV9DT05GX0NIRUNLX0ZM
QUdTKGh3LmFkanVzdGVkX21vZGUuZmxhZ3MsCj4gPiAtCQkJCSAgICAgIERSTV9NT0RFX0ZMQUdf
UFZTWU5DKTsKPiA+IC0JCVBJUEVfQ09ORl9DSEVDS19GTEFHUyhody5hZGp1c3RlZF9tb2RlLmZs
YWdzLAo+ID4gLQkJCQkgICAgICBEUk1fTU9ERV9GTEFHX05WU1lOQyk7Cj4gPiAtCX0KPiA+IC0K
PiA+ICAJUElQRV9DT05GX0NIRUNLX1goZ21jaF9wZml0LmNvbnRyb2wpOwo+ID4gIAkvKiBwZml0
IHJhdGlvcyBhcmUgYXV0b2NvbXB1dGVkIGJ5IHRoZSBodyBvbiBnZW40KyAqLwo+ID4gIAlpZiAo
SU5URUxfR0VOKGRldl9wcml2KSA8IDQpCj4gPiBAQCAtMTI4OTgsNyArMTMwMjEsOCBAQCBpbnRl
bF9waXBlX2NvbmZpZ19jb21wYXJlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjdXJy
ZW50X2NvbmZpZywKPiA+ICAJCX0KPiA+ICAKPiA+ICAJCVBJUEVfQ09ORl9DSEVDS19JKHNjYWxl
cl9zdGF0ZS5zY2FsZXJfaWQpOwo+ID4gLQkJUElQRV9DT05GX0NIRUNLX0NMT0NLX0ZVWlpZKHBp
eGVsX3JhdGUpOwo+ID4gKwkJaWYgKCFQSVBFX0NPTkZfUVVJUksoUElQRV9DT05GSUdfUVVJUktf
QklHSk9JTkVSX1NMQVZFKSkKPiA+ICsJCQlQSVBFX0NPTkZfQ0hFQ0tfQ0xPQ0tfRlVaWlkocGl4
ZWxfcmF0ZSk7Cj4gPiAgCj4gPiAgCQlQSVBFX0NPTkZfQ0hFQ0tfWChnYW1tYV9tb2RlKTsKPiA+
ICAJCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiA+IEBAIC0xMjkxNyw0OCArMTMwNDEs
NTAgQEAgaW50ZWxfcGlwZV9jb25maWdfY29tcGFyZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3VycmVudF9jb25maWcsCj4gPiAgCVBJUEVfQ09ORl9DSEVDS19CT09MKGRvdWJsZV93
aWRlKTsKPiA+ICAKPiA+ICAJUElQRV9DT05GX0NIRUNLX1Aoc2hhcmVkX2RwbGwpOwo+ID4gKwlp
ZiAoIVBJUEVfQ09ORl9RVUlSSyhQSVBFX0NPTkZJR19RVUlSS19CSUdKT0lORVJfU0xBVkUpKSB7
Cj4gPiAgCVBJUEVfQ09ORl9DSEVDS19YKGRwbGxfaHdfc3RhdGUuZHBsbCk7Cj4gCj4gTWlzc2lu
ZyBpbmRlbnQgb24gdGhpcyBsaW5lPwo+IAo+ID4gLQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3
X3N0YXRlLmRwbGxfbWQpOwo+ID4gLQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLmZw
MCk7Cj4gPiAtCVBJUEVfQ09ORl9DSEVDS19YKGRwbGxfaHdfc3RhdGUuZnAxKTsKPiA+IC0JUElQ
RV9DT05GX0NIRUNLX1goZHBsbF9od19zdGF0ZS53cnBsbCk7Cj4gPiAtCVBJUEVfQ09ORl9DSEVD
S19YKGRwbGxfaHdfc3RhdGUuc3BsbCk7Cj4gPiAtCVBJUEVfQ09ORl9DSEVDS19YKGRwbGxfaHdf
c3RhdGUuY3RybDEpOwo+ID4gLQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLmNmZ2Ny
MSk7Cj4gPiAtCVBJUEVfQ09ORl9DSEVDS19YKGRwbGxfaHdfc3RhdGUuY2ZnY3IyKTsKPiA+IC0J
UElQRV9DT05GX0NIRUNLX1goZHBsbF9od19zdGF0ZS5jZmdjcjApOwo+ID4gLQlQSVBFX0NPTkZf
Q0hFQ0tfWChkcGxsX2h3X3N0YXRlLmViYjApOwo+ID4gLQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxs
X2h3X3N0YXRlLmViYjQpOwo+ID4gLQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLnBs
bDApOwo+ID4gLQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLnBsbDEpOwo+ID4gLQlQ
SVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLnBsbDIpOwo+ID4gLQlQSVBFX0NPTkZfQ0hF
Q0tfWChkcGxsX2h3X3N0YXRlLnBsbDMpOwo+ID4gLQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3
X3N0YXRlLnBsbDYpOwo+ID4gLQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLnBsbDgp
Owo+ID4gLQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLnBsbDkpOwo+ID4gLQlQSVBF
X0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLnBsbDEwKTsKPiA+IC0JUElQRV9DT05GX0NIRUNL
X1goZHBsbF9od19zdGF0ZS5wY3NkdzEyKTsKPiA+IC0JUElQRV9DT05GX0NIRUNLX1goZHBsbF9o
d19zdGF0ZS5tZ19yZWZjbGtpbl9jdGwpOwo+ID4gLQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3
X3N0YXRlLm1nX2Nsa3RvcDJfY29yZWNsa2N0bDEpOwo+ID4gLQlQSVBFX0NPTkZfQ0hFQ0tfWChk
cGxsX2h3X3N0YXRlLm1nX2Nsa3RvcDJfaHNjbGtjdGwpOwo+ID4gLQlQSVBFX0NPTkZfQ0hFQ0tf
WChkcGxsX2h3X3N0YXRlLm1nX3BsbF9kaXYwKTsKPiA+IC0JUElQRV9DT05GX0NIRUNLX1goZHBs
bF9od19zdGF0ZS5tZ19wbGxfZGl2MSk7Cj4gPiAtCVBJUEVfQ09ORl9DSEVDS19YKGRwbGxfaHdf
c3RhdGUubWdfcGxsX2xmKTsKPiA+IC0JUElQRV9DT05GX0NIRUNLX1goZHBsbF9od19zdGF0ZS5t
Z19wbGxfZnJhY19sb2NrKTsKPiA+IC0JUElQRV9DT05GX0NIRUNLX1goZHBsbF9od19zdGF0ZS5t
Z19wbGxfc3NjKTsKPiA+IC0JUElQRV9DT05GX0NIRUNLX1goZHBsbF9od19zdGF0ZS5tZ19wbGxf
Ymlhcyk7Cj4gPiAtCVBJUEVfQ09ORl9DSEVDS19YKGRwbGxfaHdfc3RhdGUubWdfcGxsX3RkY19j
b2xkc3RfYmlhcyk7Cj4gPiAtCj4gPiAtCVBJUEVfQ09ORl9DSEVDS19YKGRzaV9wbGwuY3RybCk7
Cj4gPiAtCVBJUEVfQ09ORl9DSEVDS19YKGRzaV9wbGwuZGl2KTsKPiA+IC0KPiA+IC0JaWYgKElT
X0c0WChkZXZfcHJpdikgfHwgSU5URUxfR0VOKGRldl9wcml2KSA+PSA1KQo+ID4gLQkJUElQRV9D
T05GX0NIRUNLX0kocGlwZV9icHApOwo+ID4gLQo+ID4gLQlQSVBFX0NPTkZfQ0hFQ0tfQ0xPQ0tf
RlVaWlkoaHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrKTsKPiA+IC0JUElQRV9DT05GX0NIRUNL
X0NMT0NLX0ZVWlpZKHBvcnRfY2xvY2spOwo+ID4gLQo+ID4gLQlQSVBFX0NPTkZfQ0hFQ0tfSSht
aW5fdm9sdGFnZV9sZXZlbCk7Cj4gPiArCQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRl
LmRwbGxfbWQpOwo+ID4gKwkJUElQRV9DT05GX0NIRUNLX1goZHBsbF9od19zdGF0ZS5mcDApOwo+
ID4gKwkJUElQRV9DT05GX0NIRUNLX1goZHBsbF9od19zdGF0ZS5mcDEpOwo+ID4gKwkJUElQRV9D
T05GX0NIRUNLX1goZHBsbF9od19zdGF0ZS53cnBsbCk7Cj4gPiArCQlQSVBFX0NPTkZfQ0hFQ0tf
WChkcGxsX2h3X3N0YXRlLnNwbGwpOwo+ID4gKwkJUElQRV9DT05GX0NIRUNLX1goZHBsbF9od19z
dGF0ZS5jdHJsMSk7Cj4gPiArCQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLmNmZ2Ny
MSk7Cj4gPiArCQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLmNmZ2NyMik7Cj4gPiAr
CQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLmNmZ2NyMCk7Cj4gPiArCQlQSVBFX0NP
TkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLmViYjApOwo+ID4gKwkJUElQRV9DT05GX0NIRUNLX1go
ZHBsbF9od19zdGF0ZS5lYmI0KTsKPiA+ICsJCVBJUEVfQ09ORl9DSEVDS19YKGRwbGxfaHdfc3Rh
dGUucGxsMCk7Cj4gPiArCQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLnBsbDEpOwo+
ID4gKwkJUElQRV9DT05GX0NIRUNLX1goZHBsbF9od19zdGF0ZS5wbGwyKTsKPiA+ICsJCVBJUEVf
Q09ORl9DSEVDS19YKGRwbGxfaHdfc3RhdGUucGxsMyk7Cj4gPiArCQlQSVBFX0NPTkZfQ0hFQ0tf
WChkcGxsX2h3X3N0YXRlLnBsbDYpOwo+ID4gKwkJUElQRV9DT05GX0NIRUNLX1goZHBsbF9od19z
dGF0ZS5wbGw4KTsKPiA+ICsJCVBJUEVfQ09ORl9DSEVDS19YKGRwbGxfaHdfc3RhdGUucGxsOSk7
Cj4gPiArCQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLnBsbDEwKTsKPiA+ICsJCVBJ
UEVfQ09ORl9DSEVDS19YKGRwbGxfaHdfc3RhdGUucGNzZHcxMik7Cj4gPiArCQlQSVBFX0NPTkZf
Q0hFQ0tfWChkcGxsX2h3X3N0YXRlLm1nX3JlZmNsa2luX2N0bCk7Cj4gPiArCQlQSVBFX0NPTkZf
Q0hFQ0tfWChkcGxsX2h3X3N0YXRlLm1nX2Nsa3RvcDJfY29yZWNsa2N0bDEpOwo+ID4gKwkJUElQ
RV9DT05GX0NIRUNLX1goZHBsbF9od19zdGF0ZS5tZ19jbGt0b3AyX2hzY2xrY3RsKTsKPiA+ICsJ
CVBJUEVfQ09ORl9DSEVDS19YKGRwbGxfaHdfc3RhdGUubWdfcGxsX2RpdjApOwo+ID4gKwkJUElQ
RV9DT05GX0NIRUNLX1goZHBsbF9od19zdGF0ZS5tZ19wbGxfZGl2MSk7Cj4gPiArCQlQSVBFX0NP
TkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLm1nX3BsbF9sZik7Cj4gPiArCQlQSVBFX0NPTkZfQ0hF
Q0tfWChkcGxsX2h3X3N0YXRlLm1nX3BsbF9mcmFjX2xvY2spOwo+ID4gKwkJUElQRV9DT05GX0NI
RUNLX1goZHBsbF9od19zdGF0ZS5tZ19wbGxfc3NjKTsKPiA+ICsJCVBJUEVfQ09ORl9DSEVDS19Y
KGRwbGxfaHdfc3RhdGUubWdfcGxsX2JpYXMpOwo+ID4gKwkJUElQRV9DT05GX0NIRUNLX1goZHBs
bF9od19zdGF0ZS5tZ19wbGxfdGRjX2NvbGRzdF9iaWFzKTsKPiA+ICsKPiA+ICsJCVBJUEVfQ09O
Rl9DSEVDS19YKGRzaV9wbGwuY3RybCk7Cj4gPiArCQlQSVBFX0NPTkZfQ0hFQ0tfWChkc2lfcGxs
LmRpdik7Cj4gPiArCj4gPiArCQlpZiAoSVNfRzRYKGRldl9wcml2KSB8fCBJTlRFTF9HRU4oZGV2
X3ByaXYpID49IDUpCj4gPiArCQkJUElQRV9DT05GX0NIRUNLX0kocGlwZV9icHApOwo+ID4gKwo+
ID4gKwkJUElQRV9DT05GX0NIRUNLX0NMT0NLX0ZVWlpZKGh3LmFkanVzdGVkX21vZGUuY3J0Y19j
bG9jayk7Cj4gPiArCQlQSVBFX0NPTkZfQ0hFQ0tfQ0xPQ0tfRlVaWlkocG9ydF9jbG9jayk7Cj4g
PiArCj4gPiArCQlQSVBFX0NPTkZfQ0hFQ0tfSShtaW5fdm9sdGFnZV9sZXZlbCk7Cj4gPiArCX0K
PiA+ICAKPiA+ICAJUElQRV9DT05GX0NIRUNLX1goaW5mb2ZyYW1lcy5lbmFibGUpOwo+ID4gIAlQ
SVBFX0NPTkZfQ0hFQ0tfWChpbmZvZnJhbWVzLmdjcCk7Cj4gPiBAQCAtMTI5NjcsNiArMTMwOTMs
MTIgQEAgaW50ZWxfcGlwZV9jb25maWdfY29tcGFyZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3VycmVudF9jb25maWcsCj4gPiAgCVBJUEVfQ09ORl9DSEVDS19JTkZPRlJBTUUoaGRt
aSk7Cj4gPiAgCVBJUEVfQ09ORl9DSEVDS19JTkZPRlJBTUUoZHJtKTsKPiA+ICAKPiA+ICsJUElQ
RV9DT05GX0NIRUNLX0JPT0woYmlnam9pbmVyKTsKPiA+ICsJUElQRV9DT05GX0NIRUNLX0JPT0wo
Ymlnam9pbmVyX3NsYXZlKTsKPiA+ICsJUElQRV9DT05GX0NIRUNLX1AoYmlnam9pbmVyX2xpbmtl
ZF9jcnRjKTsKPiA+ICsJUElQRV9DT05GX0NIRUNLX0JPT0woZHNjX3BhcmFtcy5jb21wcmVzc2lv
bl9lbmFibGUpOwo+ID4gKwlQSVBFX0NPTkZfQ0hFQ0tfQk9PTChkc2NfcGFyYW1zLmRzY19zcGxp
dCk7Cj4gPiArCj4gPiAgI3VuZGVmIFBJUEVfQ09ORl9DSEVDS19YCj4gPiAgI3VuZGVmIFBJUEVf
Q09ORl9DSEVDS19JCj4gPiAgI3VuZGVmIFBJUEVfQ09ORl9DSEVDS19CT09MCj4gPiBAQCAtMTMy
MjEsNiArMTMzNTMsNyBAQCB2ZXJpZnlfY3J0Y19zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YywKPiA+ICAJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXI7Cj4gPiAgCXN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZzsKPiA+ICAJc3RydWN0IGRybV9hdG9taWNfc3RhdGUg
KnN0YXRlOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqbWFzdGVyID0gY3J0YzsKPiA+ICAJYm9v
bCBhY3RpdmU7Cj4gPiAgCj4gPiAgCXN0YXRlID0gb2xkX2NydGNfc3RhdGUtPnVhcGkuc3RhdGU7
Cj4gPiBAQCAtMTMyNTAsNyArMTMzODMsMTAgQEAgdmVyaWZ5X2NydGNfc3RhdGUoc3RydWN0IGlu
dGVsX2NydGMgKmNydGMsCj4gPiAgCQkJIihleHBlY3RlZCAlaSwgZm91bmQgJWkpXG4iLAo+ID4g
IAkJCW5ld19jcnRjX3N0YXRlLT5ody5hY3RpdmUsIGNydGMtPmFjdGl2ZSk7Cj4gPiAgCj4gPiAt
CWZvcl9lYWNoX2VuY29kZXJfb25fY3J0YyhkZXYsICZjcnRjLT5iYXNlLCBlbmNvZGVyKSB7Cj4g
PiArCWlmIChuZXdfY3J0Y19zdGF0ZS0+Ymlnam9pbmVyX3NsYXZlKQo+ID4gKwkJbWFzdGVyID0g
bmV3X2NydGNfc3RhdGUtPmJpZ2pvaW5lcl9saW5rZWRfY3J0YzsKPiA+ICsKPiA+ICsJZm9yX2Vh
Y2hfZW5jb2Rlcl9vbl9jcnRjKGRldiwgJm1hc3Rlci0+YmFzZSwgZW5jb2Rlcikgewo+ID4gIAkJ
ZW51bSBwaXBlIHBpcGU7Cj4gPiAgCj4gPiAgCQlhY3RpdmUgPSBlbmNvZGVyLT5nZXRfaHdfc3Rh
dGUoZW5jb2RlciwgJnBpcGUpOwo+ID4gQEAgLTEzMjU5LDEyICsxMzM5NSwxMiBAQCB2ZXJpZnlf
Y3J0Y19zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAJCQkJZW5jb2Rlci0+YmFz
ZS5iYXNlLmlkLCBhY3RpdmUsCj4gPiAgCQkJCW5ld19jcnRjX3N0YXRlLT5ody5hY3RpdmUpOwo+
ID4gIAo+ID4gLQkJSTkxNV9TVEFURV9XQVJOKGFjdGl2ZSAmJiBjcnRjLT5waXBlICE9IHBpcGUs
Cj4gPiArCQlJOTE1X1NUQVRFX1dBUk4oYWN0aXZlICYmIG1hc3Rlci0+cGlwZSAhPSBwaXBlLAo+
ID4gIAkJCQkiRW5jb2RlciBjb25uZWN0ZWQgdG8gd3JvbmcgcGlwZSAlY1xuIiwKPiA+ICAJCQkJ
cGlwZV9uYW1lKHBpcGUpKTsKPiA+ICAKPiA+ICAJCWlmIChhY3RpdmUpCj4gPiAtCQkJZW5jb2Rl
ci0+Z2V0X2NvbmZpZyhlbmNvZGVyLCBwaXBlX2NvbmZpZyk7Cj4gPiArCQkJaW50ZWxfZW5jb2Rl
cl9nZXRfY29uZmlnKGVuY29kZXIsIHBpcGVfY29uZmlnKTsKPiA+ICAJfQo+ID4gIAo+ID4gIAlp
bnRlbF9jcnRjX2NvbXB1dGVfcGl4ZWxfcmF0ZShwaXBlX2NvbmZpZyk7Cj4gPiBAQCAtMTM5MDYs
NiArMTQwNDIsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF91cGRhdGVfY3J0YyhzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YywKPiA+ICAKPiA+ICAJaWYgKG1vZGVzZXQpIHsKPiA+ICAJCXVwZGF0ZV9zY2Fu
bGluZV9vZmZzZXQobmV3X2NydGNfc3RhdGUpOwo+ID4gKwkJZHJtX2NhbGNfdGltZXN0YW1waW5n
X2NvbnN0YW50cygmY3J0Yy0+YmFzZSwgJm5ld19jcnRjX3N0YXRlLT5ody50cmFuc2NvZGVyX21v
ZGUpOwo+ID4gIAkJZGV2X3ByaXYtPmRpc3BsYXkuY3J0Y19lbmFibGUobmV3X2NydGNfc3RhdGUs
IHN0YXRlKTsKPiA+ICAKPiA+ICAJCS8qIHZibGFua3Mgd29yayBhZ2FpbiwgcmUtZW5hYmxlIHBp
cGUgQ1JDLiAqLwo+ID4gQEAgLTEzOTkwLDcgKzE0MTI3LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxf
Y29tbWl0X21vZGVzZXRfZGlzYWJsZXMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUp
Cj4gPiAgCSAqLwo+ID4gIAlmb3JfZWFjaF9vbGRuZXdfaW50ZWxfY3J0Y19pbl9zdGF0ZV9yZXZl
cnNlKHN0YXRlLCBjcnRjLCBvbGRfY3J0Y19zdGF0ZSwKPiA+ICAJCQkJCQkgICAgbmV3X2NydGNf
c3RhdGUsIGkpIHsKPiA+IC0JCWlmICghbmVlZHNfbW9kZXNldChuZXdfY3J0Y19zdGF0ZSkpCj4g
PiArCQlpZiAoIW5lZWRzX21vZGVzZXQobmV3X2NydGNfc3RhdGUpIHx8IG9sZF9jcnRjX3N0YXRl
LT5iaWdqb2luZXJfc2xhdmUpCj4gPiAgCQkJY29udGludWU7Cj4gPiAgCj4gPiAgCQlpbnRlbF9w
cmVfcGxhbmVfdXBkYXRlKG9sZF9jcnRjX3N0YXRlLCBuZXdfY3J0Y19zdGF0ZSk7Cj4gPiBAQCAt
MTQwMDAsNiArMTQxMzcsMTkgQEAgc3RhdGljIHZvaWQgaW50ZWxfY29tbWl0X21vZGVzZXRfZGlz
YWJsZXMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gPiAgCQkJCQkJICAgICAg
b2xkX2NydGNfc3RhdGUsCj4gPiAgCQkJCQkJICAgICAgbmV3X2NydGNfc3RhdGUsCj4gPiAgCQkJ
CQkJICAgICAgY3J0Yyk7Cj4gPiArCj4gPiArCQlpZiAob2xkX2NydGNfc3RhdGUtPmJpZ2pvaW5l
cikgewo+ID4gKwkJCXN0cnVjdCBpbnRlbF9jcnRjICpzbGF2ZSA9IG9sZF9jcnRjX3N0YXRlLT5i
aWdqb2luZXJfbGlua2VkX2NydGM7Cj4gPiArCQkJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9s
ZF9zbGF2ZV9jcnRjX3N0YXRlID0KPiA+ICsJCQkJaW50ZWxfYXRvbWljX2dldF9jcnRjX3N0YXRl
KCZzdGF0ZS0+YmFzZSwgc2xhdmUpOwo+ID4gKwkJCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpu
ZXdfc2xhdmVfY3J0Y19zdGF0ZSA9Cj4gPiArCQkJCWludGVsX2F0b21pY19nZXRfY3J0Y19zdGF0
ZSgmc3RhdGUtPmJhc2UsIHNsYXZlKTsKPiA+ICsKPiA+ICsJCQlpbnRlbF9vbGRfY3J0Y19zdGF0
ZV9kaXNhYmxlcyhzdGF0ZSwKPiA+ICsJCQkJCQkgICAgICBvbGRfc2xhdmVfY3J0Y19zdGF0ZSwK
PiA+ICsJCQkJCQkgICAgICBuZXdfc2xhdmVfY3J0Y19zdGF0ZSwKPiA+ICsJCQkJCQkgICAgICBz
bGF2ZSk7Cj4gPiArCQl9Cj4gPiAgCX0KPiA+ICB9Cj4gPiAgCj4gPiBAQCAtMTY0MzMsNyArMTY1
ODMsNyBAQCBpbnQgaW50ZWxfbW9kZXNldF9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4g
PiAgCWZvcl9lYWNoX2ludGVsX2NydGMoZGV2LCBjcnRjKSB7Cj4gPiAgCQlzdHJ1Y3QgaW50ZWxf
aW5pdGlhbF9wbGFuZV9jb25maWcgcGxhbmVfY29uZmlnID0ge307Cj4gPiAgCj4gPiAtCQlpZiAo
IWNydGMtPmFjdGl2ZSkKPiA+ICsJCWlmICghdG9faW50ZWxfY3J0Y19zdGF0ZShjcnRjLT5iYXNl
LnN0YXRlKS0+dWFwaS5hY3RpdmUpCj4gPiAgCQkJY29udGludWU7Cj4gPiAgCj4gPiAgCQkvKgo+
ID4gQEAgLTE2OTIzLDcgKzE3MDczLDE3IEBAIHN0YXRpYyB2b2lkIGludGVsX21vZGVzZXRfcmVh
ZG91dF9od19zdGF0ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ID4gIAkJCWNydGNfc3RhdGUg
PSB0b19pbnRlbF9jcnRjX3N0YXRlKGNydGMtPmJhc2Uuc3RhdGUpOwo+ID4gIAo+ID4gIAkJCWVu
Y29kZXItPmJhc2UuY3J0YyA9ICZjcnRjLT5iYXNlOwo+ID4gLQkJCWVuY29kZXItPmdldF9jb25m
aWcoZW5jb2RlciwgY3J0Y19zdGF0ZSk7Cj4gPiArCQkJaW50ZWxfZW5jb2Rlcl9nZXRfY29uZmln
KGVuY29kZXIsIGNydGNfc3RhdGUpOwo+ID4gKwo+ID4gKwkJCS8qIHJlYWQgb3V0IHRvIHNsYXZl
IGNydGMgYXMgd2VsbCBmb3IgYmlnam9pbmVyICovCj4gPiArCQkJaWYgKGNydGNfc3RhdGUtPmJp
Z2pvaW5lcikgewo+ID4gKwkJCQkvKiBlbmNvZGVyIHNob3VsZCByZWFkIGJlIGxpbmtlZCB0byBi
aWdqb2luZXIgbWFzdGVyICovCj4gPiArCQkJCVdBUk5fT04oY3J0Y19zdGF0ZS0+Ymlnam9pbmVy
X3NsYXZlKTsKPiA+ICsKPiA+ICsJCQkJY3J0YyA9IGNydGNfc3RhdGUtPmJpZ2pvaW5lcl9saW5r
ZWRfY3J0YzsKPiA+ICsJCQkJY3J0Y19zdGF0ZSA9IHRvX2ludGVsX2NydGNfc3RhdGUoY3J0Yy0+
YmFzZS5zdGF0ZSk7Cj4gPiArCQkJCWludGVsX2VuY29kZXJfZ2V0X2NvbmZpZyhlbmNvZGVyLCBj
cnRjX3N0YXRlKTsKPiA+ICsJCQl9Cj4gPiAgCQl9IGVsc2Ugewo+ID4gIAkJCWVuY29kZXItPmJh
c2UuY3J0YyA9IE5VTEw7Cj4gPiAgCQl9Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaAo+ID4gaW5kZXggZGQwMzI5YTRiOWZmLi43
ZTA2YzYxNDQ3ZTYgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2Rpc3BsYXlfdHlwZXMuaAo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgKPiA+IEBAIC03ODYsNiArNzg2LDcgQEAgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgewo+ID4gIAkgKiBhY2NvcmRpbmdseS4KPiA+ICAJICovCj4gPiAg
I2RlZmluZSBQSVBFX0NPTkZJR19RVUlSS19NT0RFX1NZTkNfRkxBR1MJKDE8PDApIC8qIHVucmVs
aWFibGUgc3luYyBtb2RlLmZsYWdzICovCj4gPiArI2RlZmluZSBQSVBFX0NPTkZJR19RVUlSS19C
SUdKT0lORVJfU0xBVkUJKDE8PDEpIC8qIGJpZ2pvaW5lciBzbGF2ZSwgcGFydGlhbCByZWFkb3V0
ICovCj4gPiAgCXVuc2lnbmVkIGxvbmcgcXVpcmtzOwo+ID4gIAo+ID4gIAl1bnNpZ25lZCBmYl9i
aXRzOyAvKiBmcmFtZWJ1ZmZlcnMgdG8gZmxpcCAqLwo+ID4gQEAgLTE1NzIsNCArMTU3MywyMCBA
QCBzdGF0aWMgaW5saW5lIHUzMiBpbnRlbF9wbGFuZV9nZ3R0X29mZnNldChjb25zdCBzdHJ1Y3Qg
aW50ZWxfcGxhbmVfc3RhdGUgKnN0YXRlKQo+ID4gIAlyZXR1cm4gaTkxNV9nZ3R0X29mZnNldChz
dGF0ZS0+dm1hKTsKPiA+ICB9Cj4gPiAgCj4gPiArc3RhdGljIGlubGluZSBib29sCj4gPiAraW50
ZWxfY3J0Y19zdXBwb3J0c19kc2MoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVf
Y29uZmlnKQo+ID4gK3sKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShwaXBlX2NvbmZpZy0+dWFwaS5jcnRjLT5kZXYpOwo+ID4gKwo+ID4gKwkvKiBPbiBU
R0wsIERTQyBpcyBzdXBwb3J0ZWQgb24gYWxsIFBpcGVzICovCj4gPiArCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDEyKQo+ID4gKwkJcmV0dXJuIHRydWU7Cj4gPiArCj4gPiArCWlmIChJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDEwICYmCj4gPiArCSAgICBwaXBlX2NvbmZpZy0+Y3B1X3RyYW5z
Y29kZXIgIT0gVFJBTlNDT0RFUl9BKQo+ID4gKwkJcmV0dXJuIHRydWU7Cj4gPiArCj4gPiArCXJl
dHVybiBmYWxzZTsKPiA+ICt9Cj4gPiArCj4gPiAgI2VuZGlmIC8qICBfX0lOVEVMX0RJU1BMQVlf
VFlQRVNfSF9fICovCj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9kcC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jCj4g
PiBpbmRleCAzZDQ4N2NlMTYxNTEuLjIzNGJlMWMzMTk1OCAxMDA2NDQKPiA+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHAuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jCj4gPiBAQCAtMTkwNywyMiArMTkwNyw2IEBAIHN0
YXRpYyBib29sIGludGVsX2RwX3N1cHBvcnRzX2ZlYyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2Rw
LAo+ID4gIAkJZHJtX2RwX3Npbmtfc3VwcG9ydHNfZmVjKGludGVsX2RwLT5mZWNfY2FwYWJsZSk7
Cj4gPiAgfQo+ID4gIAo+ID4gLXN0YXRpYyBib29sIGludGVsX2RwX3NvdXJjZV9zdXBwb3J0c19k
c2Moc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiA+IC0JCQkJCSBjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gPiAtewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiA+IC0KPiA+IC0JLyog
T24gVEdMLCBEU0MgaXMgc3VwcG9ydGVkIG9uIGFsbCBQaXBlcyAqLwo+ID4gLQlpZiAoSU5URUxf
R0VOKGRldl9wcml2KSA+PSAxMikKPiA+IC0JCXJldHVybiB0cnVlOwo+ID4gLQo+ID4gLQlpZiAo
SU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCAmJgo+ID4gLQkgICAgcGlwZV9jb25maWctPmNwdV90
cmFuc2NvZGVyICE9IFRSQU5TQ09ERVJfQSkKPiA+IC0JCXJldHVybiB0cnVlOwo+ID4gLQo+ID4g
LQlyZXR1cm4gZmFsc2U7Cj4gPiAtfQo+ID4gLQo+ID4gIHN0YXRpYyBib29sIGludGVsX2RwX3N1
cHBvcnRzX2RzYyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ID4gIAkJCQkgIGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiA+ICB7Cj4gPiBAQCAtMTkzMCw3
ICsxOTE0LDcgQEAgc3RhdGljIGJvb2wgaW50ZWxfZHBfc3VwcG9ydHNfZHNjKHN0cnVjdCBpbnRl
bF9kcCAqaW50ZWxfZHAsCj4gPiAgCWlmICghaW50ZWxfZHBfaXNfZWRwKGludGVsX2RwKSAmJiAh
cGlwZV9jb25maWctPmZlY19lbmFibGUgJiYgMCkKPiA+ICAJCXJldHVybiBmYWxzZTsKPiA+ICAK
PiA+IC0JcmV0dXJuIGludGVsX2RwX3NvdXJjZV9zdXBwb3J0c19kc2MoaW50ZWxfZHAsIHBpcGVf
Y29uZmlnKSAmJgo+ID4gKwlyZXR1cm4gaW50ZWxfY3J0Y19zdXBwb3J0c19kc2MocGlwZV9jb25m
aWcpICYmCj4gPiAgCQlkcm1fZHBfc2lua19zdXBwb3J0c19kc2MoaW50ZWxfZHAtPmRzY19kcGNk
KTsKPiA+ICB9Cj4gPiAgCj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF92ZHNjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Zk
c2MuYwo+ID4gaW5kZXggMzhjMTgxNDk5NTA1Li4xMWQ0ZGE5NzM0YTAgMTAwNjQ0Cj4gPiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Zkc2MuYwo+ID4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF92ZHNjLmMKPiA+IEBAIC00ODAsMTEgKzQ4
MCwxMCBAQCBpbnRlbF9kc2NfcG93ZXJfZG9tYWluKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlKQo+ID4gIAkJcmV0dXJuIFBPV0VSX0RPTUFJTl9UUkFOU0NPREVSKGNw
dV90cmFuc2NvZGVyKTsKPiA+ICB9Cj4gPiAgCj4gPiAtc3RhdGljIHZvaWQgaW50ZWxfY29uZmln
dXJlX3Bwc19mb3JfZHNjX2VuY29kZXIoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4g
PiAtCQkJCQkJY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAr
c3RhdGljIHZvaWQgaW50ZWxfY29uZmlndXJlX3Bwc19mb3JfZHNjX2VuY29kZXIoY29uc3Qgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgewo+ID4gIAlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5i
YXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gIAljb25zdCBzdHJ1Y3QgZHJtX2RzY19jb25maWcgKnZk
c2NfY2ZnID0gJmNydGNfc3RhdGUtPmRwX2RzY19jZmc7Cj4gPiAgCWVudW0gcGlwZSBwaXBlID0g
Y3J0Yy0+cGlwZTsKPiA+ICAJZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0gY3J0Y19z
dGF0ZS0+Y3B1X3RyYW5zY29kZXI7Cj4gPiBAQCAtNDk0LDYgKzQ5Myw5IEBAIHN0YXRpYyB2b2lk
IGludGVsX2NvbmZpZ3VyZV9wcHNfZm9yX2RzY19lbmNvZGVyKHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLAo+ID4gIAl1OCBudW1fdmRzY19pbnN0YW5jZXMgPSAoY3J0Y19zdGF0ZS0+ZHNj
X3BhcmFtcy5kc2Nfc3BsaXQpID8gMiA6IDE7Cj4gPiAgCWludCBpID0gMDsKPiA+ICAKPiA+ICsJ
aWYgKGNydGNfc3RhdGUtPmJpZ2pvaW5lcikKPiA+ICsJCW51bV92ZHNjX2luc3RhbmNlcyAqPSAy
Owo+ID4gKwo+ID4gIAkvKiBQb3B1bGF0ZSBQSUNUVVJFX1BBUkFNRVRFUl9TRVRfMCByZWdpc3Rl
cnMgKi8KPiA+ICAJcHBzX3ZhbCA9IERTQ19WRVJfTUFKIHwgdmRzY19jZmctPmRzY192ZXJzaW9u
X21pbm9yIDw8Cj4gPiAgCQlEU0NfVkVSX01JTl9TSElGVCB8Cj4gPiBAQCAtODk5LDc0ICs5MDEs
MTA0IEBAIHN0YXRpYyB2b2lkIGludGVsX2RwX3dyaXRlX2RzY19wcHNfc2RwKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+ID4gIAkJCQkJc2l6ZW9mKGRwX2RzY19wcHNfc2RwKSk7Cj4g
PiAgfQo+ID4gIAo+ID4gK3N0YXRpYyBpOTE1X3JlZ190IGRzc19jdGwxX3JlZyhjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICt7Cj4gPiArCWVudW0gcGlwZSBw
aXBlID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpLT5waXBlOwo+ID4gKwo+
ID4gKwlpZiAoY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXIgPT0gVFJBTlNDT0RFUl9FRFApCj4g
PiArCQlyZXR1cm4gRFNTX0NUTDE7Cj4gPiArCj4gPiArCXJldHVybiBJQ0xfUElQRV9EU1NfQ1RM
MShwaXBlKTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGk5MTVfcmVnX3QgZHNzX2N0bDJfcmVn
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gK3sKPiA+ICsJ
ZW51bSBwaXBlIHBpcGUgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0YyktPnBp
cGU7Cj4gPiArCj4gPiArCWlmIChjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlciA9PSBUUkFOU0NP
REVSX0VEUCkKPiA+ICsJCXJldHVybiBEU1NfQ1RMMjsKPiA+ICsKPiA+ICsJcmV0dXJuIElDTF9Q
SVBFX0RTU19DVEwyKHBpcGUpOwo+ID4gK30KPiA+ICsKPiA+ICB2b2lkIGludGVsX2RzY19lbmFi
bGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgCQkgICAgICBjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICB7Cj4gPiAgCXN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ID4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiA+IC0JZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ID4gLQlpOTE1X3Jl
Z190IGRzc19jdGwxX3JlZywgZHNzX2N0bDJfcmVnOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICAJdTMyIGRzc19j
dGwxX3ZhbCA9IDA7Cj4gPiAgCXUzMiBkc3NfY3RsMl92YWwgPSAwOwo+ID4gIAo+ID4gIAlpZiAo
IWNydGNfc3RhdGUtPmRzY19wYXJhbXMuY29tcHJlc3Npb25fZW5hYmxlKQo+ID4gIAkJcmV0dXJu
Owo+ID4gIAo+ID4gLQkvKiBFbmFibGUgUG93ZXIgd2VsbHMgZm9yIFZEU0Mvam9pbmluZyAqLwo+
ID4gLQlpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChkZXZfcHJpdiwKPiA+IC0JCQkJaW50ZWxfZHNj
X3Bvd2VyX2RvbWFpbihjcnRjX3N0YXRlKSk7Cj4gPiArCWludGVsX2NvbmZpZ3VyZV9wcHNfZm9y
X2RzY19lbmNvZGVyKGNydGNfc3RhdGUpOwo+ID4gIAo+ID4gLQlpbnRlbF9jb25maWd1cmVfcHBz
X2Zvcl9kc2NfZW5jb2RlcihlbmNvZGVyLCBjcnRjX3N0YXRlKTsKPiA+ICsJaWYgKCFjcnRjX3N0
YXRlLT5iaWdqb2luZXJfc2xhdmUpCj4gPiArCQlpbnRlbF9kcF93cml0ZV9kc2NfcHBzX3NkcChl
bmNvZGVyLCBjcnRjX3N0YXRlKTsKPiA+ICAKPiA+IC0JaW50ZWxfZHBfd3JpdGVfZHNjX3Bwc19z
ZHAoZW5jb2RlciwgY3J0Y19zdGF0ZSk7Cj4gPiAtCj4gPiAtCWlmIChjcnRjX3N0YXRlLT5jcHVf
dHJhbnNjb2RlciA9PSBUUkFOU0NPREVSX0VEUCkgewo+ID4gLQkJZHNzX2N0bDFfcmVnID0gRFNT
X0NUTDE7Cj4gPiAtCQlkc3NfY3RsMl9yZWcgPSBEU1NfQ1RMMjsKPiA+IC0JfSBlbHNlIHsKPiA+
IC0JCWRzc19jdGwxX3JlZyA9IElDTF9QSVBFX0RTU19DVEwxKHBpcGUpOwo+ID4gLQkJZHNzX2N0
bDJfcmVnID0gSUNMX1BJUEVfRFNTX0NUTDIocGlwZSk7Cj4gPiAtCX0KPiA+ICAJZHNzX2N0bDJf
dmFsIHw9IExFRlRfQlJBTkNIX1ZEU0NfRU5BQkxFOwo+ID4gIAlpZiAoY3J0Y19zdGF0ZS0+ZHNj
X3BhcmFtcy5kc2Nfc3BsaXQpIHsKPiA+ICAJCWRzc19jdGwyX3ZhbCB8PSBSSUdIVF9CUkFOQ0hf
VkRTQ19FTkFCTEU7Cj4gPiAgCQlkc3NfY3RsMV92YWwgfD0gSk9JTkVSX0VOQUJMRTsKPiA+ICAJ
fQo+ID4gLQlJOTE1X1dSSVRFKGRzc19jdGwxX3JlZywgZHNzX2N0bDFfdmFsKTsKPiA+IC0JSTkx
NV9XUklURShkc3NfY3RsMl9yZWcsIGRzc19jdGwyX3ZhbCk7Cj4gPiArCWlmIChjcnRjX3N0YXRl
LT5iaWdqb2luZXIpIHsKPiA+ICsJCWRzc19jdGwxX3ZhbCB8PSBCSUdfSk9JTkVSX0VOQUJMRTsK
PiA+ICsJCWlmICghY3J0Y19zdGF0ZS0+Ymlnam9pbmVyX3NsYXZlKQo+ID4gKwkJCWRzc19jdGwx
X3ZhbCB8PSBNQVNURVJfQklHX0pPSU5FUl9FTkFCTEU7Cj4gPiArCX0KPiA+ICsJSTkxNV9XUklU
RShkc3NfY3RsMV9yZWcoY3J0Y19zdGF0ZSksIGRzc19jdGwxX3ZhbCk7Cj4gPiArCUk5MTVfV1JJ
VEUoZHNzX2N0bDJfcmVnKGNydGNfc3RhdGUpLCBkc3NfY3RsMl92YWwpOwo+ID4gIH0KPiA+ICAK
PiA+ICB2b2lkIGludGVsX2RzY19kaXNhYmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpvbGRfY3J0Y19zdGF0ZSkKPiA+ICB7Cj4gPiAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0g
dG9faW50ZWxfY3J0YyhvbGRfY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiA+ICAJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAt
CWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiA+IC0JaTkxNV9yZWdfdCBkc3NfY3RsMV9y
ZWcsIGRzc19jdGwyX3JlZzsKPiA+IC0JdTMyIGRzc19jdGwxX3ZhbCA9IDAsIGRzc19jdGwyX3Zh
bCA9IDA7Cj4gPiAgCj4gPiAgCWlmICghb2xkX2NydGNfc3RhdGUtPmRzY19wYXJhbXMuY29tcHJl
c3Npb25fZW5hYmxlKQo+ID4gIAkJcmV0dXJuOwo+ID4gIAo+ID4gLQlpZiAob2xkX2NydGNfc3Rh
dGUtPmNwdV90cmFuc2NvZGVyID09IFRSQU5TQ09ERVJfRURQKSB7Cj4gPiAtCQlkc3NfY3RsMV9y
ZWcgPSBEU1NfQ1RMMTsKPiA+IC0JCWRzc19jdGwyX3JlZyA9IERTU19DVEwyOwo+ID4gLQl9IGVs
c2Ugewo+ID4gLQkJZHNzX2N0bDFfcmVnID0gSUNMX1BJUEVfRFNTX0NUTDEocGlwZSk7Cj4gPiAt
CQlkc3NfY3RsMl9yZWcgPSBJQ0xfUElQRV9EU1NfQ1RMMihwaXBlKTsKPiA+ICsJSTkxNV9XUklU
RShkc3NfY3RsMV9yZWcob2xkX2NydGNfc3RhdGUpLCAwKTsKPiA+ICsJSTkxNV9XUklURShkc3Nf
Y3RsMl9yZWcob2xkX2NydGNfc3RhdGUpLCAwKTsKPiA+ICt9Cj4gPiArCj4gPiArdm9pZCBpbnRl
bF9kc2NfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+
ICt7Cj4gPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0
YXRlLT51YXBpLmNydGMpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJdTMyIGRzc19jdGwxX3ZhbCwgZHNzX2N0
bDJfdmFsOwo+ID4gKwlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiA+ICsKPiA+ICsJaWYgKCFp
bnRlbF9jcnRjX3N1cHBvcnRzX2RzYyhjcnRjX3N0YXRlKSkKPiA+ICsJCXJldHVybjsKPiA+ICsK
PiA+ICsJd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2X3By
aXYsIGludGVsX2RzY19wb3dlcl9kb21haW4oY3J0Y19zdGF0ZSkpOwo+ID4gKwlpZiAoIXdha2Vy
ZWYpCj4gPiArCQlyZXR1cm47Cj4gPiArCj4gPiArCWRzc19jdGwxX3ZhbCA9IEk5MTVfUkVBRChk
c3NfY3RsMV9yZWcoY3J0Y19zdGF0ZSkpOwo+ID4gKwlkc3NfY3RsMl92YWwgPSBJOTE1X1JFQUQo
ZHNzX2N0bDJfcmVnKGNydGNfc3RhdGUpKTsKPiA+ICsJaWYgKGRzc19jdGwyX3ZhbCAmIExFRlRf
QlJBTkNIX1ZEU0NfRU5BQkxFKQo+ID4gKwkJY3J0Y19zdGF0ZS0+ZHNjX3BhcmFtcy5jb21wcmVz
c2lvbl9lbmFibGUgPSB0cnVlOwo+ID4gKwo+ID4gKwlpZiAoKGRzc19jdGwxX3ZhbCAmIEpPSU5F
Ul9FTkFCTEUpICYmIChkc3NfY3RsMl92YWwgJiBSSUdIVF9CUkFOQ0hfVkRTQ19FTkFCTEUpKQo+
ID4gKwkJY3J0Y19zdGF0ZS0+ZHNjX3BhcmFtcy5kc2Nfc3BsaXQgPSB0cnVlOwo+ID4gKwo+ID4g
KwlpZiAoZHNzX2N0bDFfdmFsICYgQklHX0pPSU5FUl9FTkFCTEUpIHsKPiA+ICsJCWNydGNfc3Rh
dGUtPmJpZ2pvaW5lciA9IHRydWU7CgpJcyBjcnRjX3N0YXRlLT5iaWdqb2luZXIgc3VwcG9zZWQg
dG8gYmUgc2V0IG9uIGJvdGggbWFzdGVyIGFuZCBzbGF2ZSBvcgpqdXN0IG9uIHRoZSBtYXN0ZXI/
ICBJIHRob3VnaHQgd2Ugb25seSBzZXQgaXQgZm9yIHRoZSBtYXN0ZXIgYmFzZWQgb24Kd2hhdCBJ
IHNlZSBpbiBpbnRlbF9kcF9kc2NfY29tcHV0ZV9jb25maWcsIGJ1dCB0aGlzIGFwcGVhcnMgdG8g
c2V0IGluIG9uCmJvdGggZHVyaW5nIHJlYWRvdXQgKG15IGludGVycHJldGF0aW9uIG9mIGJzcGVj
ICM1MDE3NCBpcyB0aGF0IGJpdCAyOSBpcwpzZXQgb24gYm90aCBtYXN0ZXIgYW5kIHNsYXZlLCB3
aGVyZWFzIGJpdCAyOCBpcyBvbmx5IHNldCBvbiB0aGUgbWFzdGVyKS4KU2hvdWxkIHRoaXMgYmUg
dGVzdGluZyBhZ2FpbnN0IE1BU1RFUl9CSUdfSk9JTkVSX0VOQUJMRSBpbnN0ZWFkPwoKCk1hdHQK
Cj4gPiArCj4gPiArCQlpZiAoIShkc3NfY3RsMV92YWwgJiBNQVNURVJfQklHX0pPSU5FUl9FTkFC
TEUpKSB7Cj4gPiArCQkJY3J0Y19zdGF0ZS0+Ymlnam9pbmVyX3NsYXZlID0gdHJ1ZTsKPiA+ICsJ
CQlpZiAoIVdBUk5fT04oY3J0Yy0+cGlwZSA9PSBQSVBFX0EpKQo+ID4gKwkJCQljcnRjX3N0YXRl
LT5iaWdqb2luZXJfbGlua2VkX2NydGMgPQo+ID4gKwkJCQkJaW50ZWxfZ2V0X2NydGNfZm9yX3Bp
cGUoZGV2X3ByaXYsIGNydGMtPnBpcGUgLSAxKTsKPiA+ICsJCX0gZWxzZSB7Cj4gPiArCQkJaWYg
KCFXQVJOX09OKElOVEVMX05VTV9QSVBFUyhkZXZfcHJpdikgPT0gY3J0Yy0+cGlwZSArIDEpKQo+
ID4gKwkJCQljcnRjX3N0YXRlLT5iaWdqb2luZXJfbGlua2VkX2NydGMgPQo+ID4gKwkJCQkJaW50
ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIGNydGMtPnBpcGUgKyAxKTsKPiA+ICsJCX0K
PiA+ICAJfQo+ID4gLQlkc3NfY3RsMV92YWwgPSBJOTE1X1JFQUQoZHNzX2N0bDFfcmVnKTsKPiA+
IC0JaWYgKGRzc19jdGwxX3ZhbCAmIEpPSU5FUl9FTkFCTEUpCj4gPiAtCQlkc3NfY3RsMV92YWwg
Jj0gfkpPSU5FUl9FTkFCTEU7Cj4gPiAtCUk5MTVfV1JJVEUoZHNzX2N0bDFfcmVnLCBkc3NfY3Rs
MV92YWwpOwo+ID4gLQo+ID4gLQlkc3NfY3RsMl92YWwgPSBJOTE1X1JFQUQoZHNzX2N0bDJfcmVn
KTsKPiA+IC0JaWYgKGRzc19jdGwyX3ZhbCAmIExFRlRfQlJBTkNIX1ZEU0NfRU5BQkxFIHx8Cj4g
PiAtCSAgICBkc3NfY3RsMl92YWwgJiBSSUdIVF9CUkFOQ0hfVkRTQ19FTkFCTEUpCj4gPiAtCQlk
c3NfY3RsMl92YWwgJj0gfihMRUZUX0JSQU5DSF9WRFNDX0VOQUJMRSB8Cj4gPiAtCQkJCSAgUklH
SFRfQlJBTkNIX1ZEU0NfRU5BQkxFKTsKPiA+IC0JSTkxNV9XUklURShkc3NfY3RsMl9yZWcsIGRz
c19jdGwyX3ZhbCk7Cj4gPiAtCj4gPiAtCS8qIERpc2FibGUgUG93ZXIgd2VsbHMgZm9yIFZEU0Mv
am9pbmluZyAqLwo+ID4gLQlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dF91bmNoZWNrZWQoZGV2X3By
aXYsCj4gPiAtCQkJCQkgIGludGVsX2RzY19wb3dlcl9kb21haW4ob2xkX2NydGNfc3RhdGUpKTsK
PiA+ICsKPiA+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIGludGVsX2RzY19w
b3dlcl9kb21haW4oY3J0Y19zdGF0ZSksIHdha2VyZWYpOwo+ID4gIH0KPiA+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Zkc2MuaCBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfdmRzYy5oCj4gPiBpbmRleCA5MGQzZjYwMTdmY2IuLjU2
OWNmMTc0MDJiYSAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfdmRzYy5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X3Zkc2MuaAo+ID4gQEAgLTE1LDYgKzE1LDggQEAgdm9pZCBpbnRlbF9kc2NfZW5hYmxlKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gIHZvaWQgaW50ZWxfZHNjX2Rpc2FibGUoY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpOwo+ID4gIGludCBpbnRlbF9k
cF9jb21wdXRlX2RzY19wYXJhbXMoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiA+ICAJCQkJ
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKTsKPiA+ICt2b2lkIGludGVsX2Rz
Y19nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKTsKPiA+ICsK
PiA+ICBlbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluCj4gPiAgaW50ZWxfZHNjX3Bvd2Vy
X2RvbWFpbihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7Cj4gPiAg
Cj4gPiAtLSAKPiA+IDIuMjAuMQo+ID4gCj4gPiBfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwo+ID4gSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdAo+ID4gSW50ZWwt
Z2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwo+ID4gaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5v
cmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZngKPiAKPiAtLSAKPiBNYXR0IFJvcGVyCj4gR3Jh
cGhpY3MgU29mdHdhcmUgRW5naW5lZXIKPiBWVFQtT1NHQyBQbGF0Zm9ybSBFbmFibGVtZW50Cj4g
SW50ZWwgQ29ycG9yYXRpb24KPiAoOTE2KSAzNTYtMjc5NQo+IF9fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fCj4gSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdAo+IElu
dGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKPiBodHRwczovL2xpc3RzLmZyZWVkZXNrdG9w
Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeAoKLS0gCk1hdHQgUm9wZXIKR3JhcGhpY3Mg
U29mdHdhcmUgRW5naW5lZXIKVlRULU9TR0MgUGxhdGZvcm0gRW5hYmxlbWVudApJbnRlbCBDb3Jw
b3JhdGlvbgooOTE2KSAzNTYtMjc5NQpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVl
ZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5m
by9pbnRlbC1nZng=

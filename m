Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 0CB3583198
	for <lists+intel-gfx@lfdr.de>; Tue,  6 Aug 2019 14:43:10 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CA94A6E37C;
	Tue,  6 Aug 2019 12:43:07 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0AE0A6E36D
 for <intel-gfx@lists.freedesktop.org>; Tue,  6 Aug 2019 12:43:05 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17905194-1500050 
 for <intel-gfx@lists.freedesktop.org>; Tue, 06 Aug 2019 13:43:01 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Tue,  6 Aug 2019 13:43:00 +0100
Message-Id: <20190806124300.24945-2-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0.rc1
In-Reply-To: <20190806124300.24945-1-chris@chris-wilson.co.uk>
References: <20190806124300.24945-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [CI 2/2] drm/i915/gt: Move the [class][inst] lookup for
 engines onto the GT
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VG8gbWFpbnRhaW4gYSBmYXN0IGxvb2t1cCBmcm9tIGEgR1QgY2VudHJpYyBpcnEgaGFuZGxlciwg
d2Ugd2FudCB0aGUKZW5naW5lIGxvb2t1cCB0YWJsZXMgb24gdGhlIGludGVsX2d0LiBUbyBhdm9p
ZCBoYXZpbmcgbXVsdGlwbGUgY29waWVzIG9mCnRoZSBzYW1lIG11bHRpLWRpbWVuc2lvbiBsb29r
dXAgdGFibGUsIG1vdmUgdGhlIGdlbmVyaWMgdXNlciBlbmdpbmUKbG9va3VwIGludG8gYW4gcmJ0
cmVlIChmb3IgZmFzdCBhbmQgZmxleGlibGUgaW5kZXhpbmcpLgoKdjI6IFNwbGl0IHVhYmlfaW5z
dGFuY2UgY2YgdWFiaV9jbGFzcwp2MzogU2V0IHVhYmlfY2xhc3MvdWFiaV9pbnN0YW5jZSBhZnRl
ciBjb2xsYXRpbmcgYWxsIGVuZ2luZXMgdG8gcHJvdmlkZSBhCnN0YWJsZSB1YWJpIGFjcm9zcyBw
YXJhbGxlbCB1bm9yZGVyZWQgY29uc3RydWN0aW9uLgoKU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2ls
c29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+CkNjOiBUdnJ0a28gVXJzdWxpbiA8dHZydGtv
LnVyc3VsaW5AaW50ZWwuY29tPgpDYzogRGFuaWVsZSBDZXJhb2xvIFNwdXJpbyA8ZGFuaWVsZS5j
ZXJhb2xvc3B1cmlvQGludGVsLmNvbT4KUmV2aWV3ZWQtYnk6IERhbmllbGUgQ2VyYW9sbyBTcHVy
aW8gPGRhbmllbGUuY2VyYW9sb3NwdXJpb0BpbnRlbC5jb20+ICN2MgotLS0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L01ha2VmaWxlICAgICAgICAgICAgICAgICB8ICAgMSArCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jICAgfCAgIDMgKy0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oICAgICAgICB8ICAgNiAtCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYyAgICAgfCAxMDkgKystLS0tLS0tCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaCAgfCAgIDkgKy0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV91c2VyLmMgICB8IDIyOCArKysrKysrKysrKysrKysr
KysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV91c2VyLmggICB8ICAyMyAr
KwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfdHlwZXMuaCAgICAgIHwgICA0ICsK
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jICAgICAgICB8ICAxNSArLQog
Li4uL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF93b3JrYXJvdW5kcy5jICAgIHwgICAxICsKIC4u
Li9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYyB8ICAgMiArLQogZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9jbWRfcGFyc2VyLmMgICAgICAgIHwgICAzICstCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYyAgICAgICAgICAgfCAgMTcgKy0KIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgICAgICAgICAgICAgICB8ICAgMSArCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oICAgICAgICAgICAgICAgfCAgMTUgKy0KIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMgICAgICAgICAgICAgICB8ICAyMiArLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9pcnEuYyAgICAgICAgICAgICAgIHwgICAyICstCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3BlcmYuYyAgICAgICAgICAgICAgfCAgIDMgKy0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfcG11LmMgICAgICAgICAgICAgICB8ICAgOCArLQogZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9xdWVyeS5jICAgICAgICAgICAgIHwgICA1ICstCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3RyYWNlLmggICAgICAgICAgICAgfCAgMTAgKy0KIDIxIGZpbGVzIGNoYW5n
ZWQsIDMyNyBpbnNlcnRpb25zKCspLCAxNjAgZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA2
NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3VzZXIuYwogY3JlYXRlIG1v
ZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV91c2VyLmgKCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L01ha2VmaWxlCmluZGV4IGExMDE2ODU4ZDAxNC4uNmJkNGZhZDZlNzg1IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9NYWtlZmlsZQpAQCAtNzQsNiArNzQsNyBAQCBndC15ICs9IFwKIAlndC9pbnRlbF9lbmdp
bmVfcG9vbC5vIFwKIAlndC9pbnRlbF9lbmdpbmVfY3MubyBcCiAJZ3QvaW50ZWxfZW5naW5lX3Bt
Lm8gXAorCWd0L2ludGVsX2VuZ2luZV91c2VyLm8gXAogCWd0L2ludGVsX2d0Lm8gXAogCWd0L2lu
dGVsX2d0X3BtLm8gXAogCWd0L2ludGVsX2hhbmdjaGVjay5vIFwKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCmluZGV4IDY0ZjdhNTMzZTg4Ni4uMWM1YmMyMWE4
MGZmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4
dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKQEAg
LTcwLDYgKzcwLDcgQEAKICNpbmNsdWRlIDxkcm0vaTkxNV9kcm0uaD4KIAogI2luY2x1ZGUgImd0
L2ludGVsX2xyY19yZWcuaCIKKyNpbmNsdWRlICJndC9pbnRlbF9lbmdpbmVfdXNlci5oIgogCiAj
aW5jbHVkZSAiaTkxNV9nZW1fY29udGV4dC5oIgogI2luY2x1ZGUgImk5MTVfZ2xvYmFscy5oIgpA
QCAtMTcyOSw3ICsxNzMwLDcgQEAgZ2V0X2VuZ2luZXMoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQg
KmN0eCwKIAogCQlpZiAoZS0+ZW5naW5lc1tuXSkgewogCQkJY2kuZW5naW5lX2NsYXNzID0gZS0+
ZW5naW5lc1tuXS0+ZW5naW5lLT51YWJpX2NsYXNzOwotCQkJY2kuZW5naW5lX2luc3RhbmNlID0g
ZS0+ZW5naW5lc1tuXS0+ZW5naW5lLT5pbnN0YW5jZTsKKwkJCWNpLmVuZ2luZV9pbnN0YW5jZSA9
IGUtPmVuZ2luZXNbbl0tPmVuZ2luZS0+dWFiaV9pbnN0YW5jZTsKIAkJfQogCiAJCWlmIChjb3B5
X3RvX3VzZXIoJnVzZXItPmVuZ2luZXNbbl0sICZjaSwgc2l6ZW9mKGNpKSkpIHsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lLmgKaW5kZXggYTRkYjRkZDIyYjRmLi4zN2MzOTFjZWU0
NDEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oCkBAIC0xMjIsOCArMTIy
LDYgQEAgaGFuZ2NoZWNrX2FjdGlvbl90b19zdHIoY29uc3QgZW51bSBpbnRlbF9lbmdpbmVfaGFu
Z2NoZWNrX2FjdGlvbiBhKQogCXJldHVybiAidW5rbm93biI7CiB9CiAKLXZvaWQgaW50ZWxfZW5n
aW5lc19zZXRfc2NoZWR1bGVyX2NhcHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwot
CiBzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGludAogZXhlY2xpc3RzX251bV9wb3J0cyhjb25zdCBz
dHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAqIGNvbnN0IGV4ZWNsaXN0cykKIHsKQEAgLTQy
Miw3ICs0MjAsNiBAQCBib29sIGludGVsX2VuZ2luZV9pc19pZGxlKHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSk7CiBib29sIGludGVsX2VuZ2luZXNfYXJlX2lkbGUoc3RydWN0IGludGVs
X2d0ICpndCk7CiAKIHZvaWQgaW50ZWxfZW5naW5lc19yZXNldF9kZWZhdWx0X3N1Ym1pc3Npb24o
c3RydWN0IGludGVsX2d0ICpndCk7Ci11bnNpZ25lZCBpbnQgaW50ZWxfZW5naW5lc19oYXNfY29u
dGV4dF9pc29sYXRpb24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwogCiBib29sIGlu
dGVsX2VuZ2luZV9jYW5fc3RvcmVfZHdvcmQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KTsKIApAQCAtNDMxLDkgKzQyOCw2IEBAIHZvaWQgaW50ZWxfZW5naW5lX2R1bXAoc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lLAogCQkgICAgICAgc3RydWN0IGRybV9wcmludGVyICptLAog
CQkgICAgICAgY29uc3QgY2hhciAqaGVhZGVyLCAuLi4pOwogCi1zdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICoKLWludGVsX2VuZ2luZV9sb29rdXBfdXNlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwgdTggY2xhc3MsIHU4IGluc3RhbmNlKTsKLQogc3RhdGljIGlubGluZSB2b2lkIGludGVs
X2VuZ2luZV9jb250ZXh0X2luKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsKIAl1
bnNpZ25lZCBsb25nIGZsYWdzOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfZW5naW5lX2NzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVf
Y3MuYwppbmRleCBhOTFmMTU3MTdjYzEuLmQwYmVmZDZjMDIzYSAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKQEAgLTMzLDYgKzMzLDcgQEAKICNpbmNsdWRlICJp
bnRlbF9lbmdpbmUuaCIKICNpbmNsdWRlICJpbnRlbF9lbmdpbmVfcG0uaCIKICNpbmNsdWRlICJp
bnRlbF9lbmdpbmVfcG9vbC5oIgorI2luY2x1ZGUgImludGVsX2VuZ2luZV91c2VyLmgiCiAjaW5j
bHVkZSAiaW50ZWxfY29udGV4dC5oIgogI2luY2x1ZGUgImludGVsX2xyYy5oIgogI2luY2x1ZGUg
ImludGVsX3Jlc2V0LmgiCkBAIC0yODYsOSArMjg3LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZW5n
aW5lX3Nhbml0aXplX21taW8oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCWludGVs
X2VuZ2luZV9zZXRfaHdzcF93cml0ZW1hc2soZW5naW5lLCB+MHUpOwogfQogCi1zdGF0aWMgaW50
Ci1pbnRlbF9lbmdpbmVfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAot
CQkgICBlbnVtIGludGVsX2VuZ2luZV9pZCBpZCkKK3N0YXRpYyBpbnQgaW50ZWxfZW5naW5lX3Nl
dHVwKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGVudW0gaW50ZWxfZW5naW5lX2lkIGlkKQogewogCWNv
bnN0IHN0cnVjdCBlbmdpbmVfaW5mbyAqaW5mbyA9ICZpbnRlbF9lbmdpbmVzW2lkXTsKIAlzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CkBAIC0zMDQsMTAgKzMwMyw5IEBAIGludGVsX2Vu
Z2luZV9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJaWYgKEdFTV9E
RUJVR19XQVJOX09OKGluZm8tPmluc3RhbmNlID4gTUFYX0VOR0lORV9JTlNUQU5DRSkpCiAJCXJl
dHVybiAtRUlOVkFMOwogCi0JaWYgKEdFTV9ERUJVR19XQVJOX09OKGRldl9wcml2LT5lbmdpbmVf
Y2xhc3NbaW5mby0+Y2xhc3NdW2luZm8tPmluc3RhbmNlXSkpCisJaWYgKEdFTV9ERUJVR19XQVJO
X09OKGd0LT5lbmdpbmVfY2xhc3NbaW5mby0+Y2xhc3NdW2luZm8tPmluc3RhbmNlXSkpCiAJCXJl
dHVybiAtRUlOVkFMOwogCi0JR0VNX0JVR19PTihkZXZfcHJpdi0+ZW5naW5lW2lkXSk7CiAJZW5n
aW5lID0ga3phbGxvYyhzaXplb2YoKmVuZ2luZSksIEdGUF9LRVJORUwpOwogCWlmICghZW5naW5l
KQogCQlyZXR1cm4gLUVOT01FTTsKQEAgLTMxNiwxMiArMzE0LDEyIEBAIGludGVsX2VuZ2luZV9z
ZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAKIAllbmdpbmUtPmlkID0g
aWQ7CiAJZW5naW5lLT5tYXNrID0gQklUKGlkKTsKLQllbmdpbmUtPmk5MTUgPSBkZXZfcHJpdjsK
LQllbmdpbmUtPmd0ID0gJmRldl9wcml2LT5ndDsKLQllbmdpbmUtPnVuY29yZSA9ICZkZXZfcHJp
di0+dW5jb3JlOworCWVuZ2luZS0+aTkxNSA9IGd0LT5pOTE1OworCWVuZ2luZS0+Z3QgPSBndDsK
KwllbmdpbmUtPnVuY29yZSA9IGd0LT51bmNvcmU7CiAJX19zcHJpbnRfZW5naW5lX25hbWUoZW5n
aW5lLT5uYW1lLCBpbmZvKTsKIAllbmdpbmUtPmh3X2lkID0gZW5naW5lLT5ndWNfaWQgPSBpbmZv
LT5od19pZDsKLQllbmdpbmUtPm1taW9fYmFzZSA9IF9fZW5naW5lX21taW9fYmFzZShkZXZfcHJp
diwgaW5mby0+bW1pb19iYXNlcyk7CisJZW5naW5lLT5tbWlvX2Jhc2UgPSBfX2VuZ2luZV9tbWlv
X2Jhc2UoZ3QtPmk5MTUsIGluZm8tPm1taW9fYmFzZXMpOwogCWVuZ2luZS0+Y2xhc3MgPSBpbmZv
LT5jbGFzczsKIAllbmdpbmUtPmluc3RhbmNlID0gaW5mby0+aW5zdGFuY2U7CiAKQEAgLTMzMSwx
NCArMzI5LDEyIEBAIGludGVsX2VuZ2luZV9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCiAJICovCiAJZW5naW5lLT5kZXN0cm95ID0gKHR5cGVvZihlbmdpbmUtPmRlc3Ry
b3kpKWtmcmVlOwogCi0JZW5naW5lLT51YWJpX2NsYXNzID0gaW50ZWxfZW5naW5lX2NsYXNzZXNb
aW5mby0+Y2xhc3NdLnVhYmlfY2xhc3M7Ci0KLQllbmdpbmUtPmNvbnRleHRfc2l6ZSA9IGludGVs
X2VuZ2luZV9jb250ZXh0X3NpemUoZGV2X3ByaXYsCisJZW5naW5lLT5jb250ZXh0X3NpemUgPSBp
bnRlbF9lbmdpbmVfY29udGV4dF9zaXplKGd0LT5pOTE1LAogCQkJCQkJCSBlbmdpbmUtPmNsYXNz
KTsKIAlpZiAoV0FSTl9PTihlbmdpbmUtPmNvbnRleHRfc2l6ZSA+IEJJVCgyMCkpKQogCQllbmdp
bmUtPmNvbnRleHRfc2l6ZSA9IDA7CiAJaWYgKGVuZ2luZS0+Y29udGV4dF9zaXplKQotCQlEUklW
RVJfQ0FQUyhkZXZfcHJpdiktPmhhc19sb2dpY2FsX2NvbnRleHRzID0gdHJ1ZTsKKwkJRFJJVkVS
X0NBUFMoZ3QtPmk5MTUpLT5oYXNfbG9naWNhbF9jb250ZXh0cyA9IHRydWU7CiAKIAkvKiBOb3Ro
aW5nIHRvIGRvIGhlcmUsIGV4ZWN1dGUgaW4gb3JkZXIgb2YgZGVwZW5kZW5jaWVzICovCiAJZW5n
aW5lLT5zY2hlZHVsZSA9IE5VTEw7CkBAIC0zNTAsOCArMzQ2LDExIEBAIGludGVsX2VuZ2luZV9z
ZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJLyogU2NydWIgbW1pbyBz
dGF0ZSBvbiB0YWtlb3ZlciAqLwogCWludGVsX2VuZ2luZV9zYW5pdGl6ZV9tbWlvKGVuZ2luZSk7
CiAKLQlkZXZfcHJpdi0+ZW5naW5lX2NsYXNzW2luZm8tPmNsYXNzXVtpbmZvLT5pbnN0YW5jZV0g
PSBlbmdpbmU7Ci0JZGV2X3ByaXYtPmVuZ2luZVtpZF0gPSBlbmdpbmU7CisJZ3QtPmVuZ2luZV9j
bGFzc1tpbmZvLT5jbGFzc11baW5mby0+aW5zdGFuY2VdID0gZW5naW5lOworCisJaW50ZWxfZW5n
aW5lX2FkZF91c2VyKGVuZ2luZSk7CisJZ3QtPmk5MTUtPmVuZ2luZVtpZF0gPSBlbmdpbmU7CisK
IAlyZXR1cm4gMDsKIH0KIApAQCAtNDM0LDcgKzQzMyw3IEBAIGludCBpbnRlbF9lbmdpbmVzX2lu
aXRfbW1pbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkJaWYgKCFIQVNfRU5HSU5F
KGk5MTUsIGkpKQogCQkJY29udGludWU7CiAKLQkJZXJyID0gaW50ZWxfZW5naW5lX3NldHVwKGk5
MTUsIGkpOworCQllcnIgPSBpbnRlbF9lbmdpbmVfc2V0dXAoJmk5MTUtPmd0LCBpKTsKIAkJaWYg
KGVycikKIAkJCWdvdG8gY2xlYW51cDsKIApAQCAtNjc3LDQ3ICs2NzYsNiBAQCBpbnQgaW50ZWxf
ZW5naW5lc19zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAlyZXR1cm4gZXJy
OwogfQogCi12b2lkIGludGVsX2VuZ2luZXNfc2V0X3NjaGVkdWxlcl9jYXBzKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQotewotCXN0YXRpYyBjb25zdCBzdHJ1Y3QgewotCQl1OCBlbmdp
bmU7Ci0JCXU4IHNjaGVkOwotCX0gbWFwW10gPSB7Ci0jZGVmaW5lIE1BUCh4LCB5KSB7IGlsb2cy
KEk5MTVfRU5HSU5FXyMjeCksIGlsb2cyKEk5MTVfU0NIRURVTEVSX0NBUF8jI3kpIH0KLQkJTUFQ
KEhBU19QUkVFTVBUSU9OLCBQUkVFTVBUSU9OKSwKLQkJTUFQKEhBU19TRU1BUEhPUkVTLCBTRU1B
UEhPUkVTKSwKLQkJTUFQKFNVUFBPUlRTX1NUQVRTLCBFTkdJTkVfQlVTWV9TVEFUUyksCi0jdW5k
ZWYgTUFQCi0JfTsKLQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0JZW51bSBpbnRl
bF9lbmdpbmVfaWQgaWQ7Ci0JdTMyIGVuYWJsZWQsIGRpc2FibGVkOwotCi0JZW5hYmxlZCA9IDA7
Ci0JZGlzYWJsZWQgPSAwOwotCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKSB7IC8q
IGFsbCBlbmdpbmVzIG11c3QgYWdyZWUhICovCi0JCWludCBpOwotCi0JCWlmIChlbmdpbmUtPnNj
aGVkdWxlKQotCQkJZW5hYmxlZCB8PSAoSTkxNV9TQ0hFRFVMRVJfQ0FQX0VOQUJMRUQgfAotCQkJ
CSAgICBJOTE1X1NDSEVEVUxFUl9DQVBfUFJJT1JJVFkpOwotCQllbHNlCi0JCQlkaXNhYmxlZCB8
PSAoSTkxNV9TQ0hFRFVMRVJfQ0FQX0VOQUJMRUQgfAotCQkJCSAgICAgSTkxNV9TQ0hFRFVMRVJf
Q0FQX1BSSU9SSVRZKTsKLQotCQlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShtYXApOyBpKysp
IHsKLQkJCWlmIChlbmdpbmUtPmZsYWdzICYgQklUKG1hcFtpXS5lbmdpbmUpKQotCQkJCWVuYWJs
ZWQgfD0gQklUKG1hcFtpXS5zY2hlZCk7Ci0JCQllbHNlCi0JCQkJZGlzYWJsZWQgfD0gQklUKG1h
cFtpXS5zY2hlZCk7Ci0JCX0KLQl9Ci0KLQlpOTE1LT5jYXBzLnNjaGVkdWxlciA9IGVuYWJsZWQg
JiB+ZGlzYWJsZWQ7Ci0JaWYgKCEoaTkxNS0+Y2Fwcy5zY2hlZHVsZXIgJiBJOTE1X1NDSEVEVUxF
Ul9DQVBfRU5BQkxFRCkpCi0JCWk5MTUtPmNhcHMuc2NoZWR1bGVyID0gMDsKLX0KLQogc3RydWN0
IG1lYXN1cmVfYnJlYWRjcnVtYiB7CiAJc3RydWN0IGk5MTVfcmVxdWVzdCBycTsKIAlzdHJ1Y3Qg
aW50ZWxfdGltZWxpbmUgdGltZWxpbmU7CkBAIC0xMTg3LDIwICsxMTQ1LDYgQEAgYm9vbCBpbnRl
bF9lbmdpbmVfY2FuX3N0b3JlX2R3b3JkKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkK
IAl9CiB9CiAKLXVuc2lnbmVkIGludCBpbnRlbF9lbmdpbmVzX2hhc19jb250ZXh0X2lzb2xhdGlv
bihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKLXsKLQlzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmU7Ci0JZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Ci0JdW5zaWduZWQgaW50IHdo
aWNoOwotCi0Jd2hpY2ggPSAwOwotCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKQot
CQlpZiAoZW5naW5lLT5kZWZhdWx0X3N0YXRlKQotCQkJd2hpY2ggfD0gQklUKGVuZ2luZS0+dWFi
aV9jbGFzcyk7Ci0KLQlyZXR1cm4gd2hpY2g7Ci19Ci0KIHN0YXRpYyBpbnQgcHJpbnRfc2NoZWRf
YXR0cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJCSAgICBjb25zdCBzdHJ1Y3Qg
aTkxNV9zY2hlZF9hdHRyICphdHRyLAogCQkJICAgIGNoYXIgKmJ1ZiwgaW50IHgsIGludCBsZW4p
CkBAIC0xNDk4LDI5ICsxNDQyLDYgQEAgdm9pZCBpbnRlbF9lbmdpbmVfZHVtcChzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUsCiAJaW50ZWxfZW5naW5lX3ByaW50X2JyZWFkY3J1bWJzKGVu
Z2luZSwgbSk7CiB9CiAKLXN0YXRpYyB1OCB1c2VyX2NsYXNzX21hcFtdID0gewotCVtJOTE1X0VO
R0lORV9DTEFTU19SRU5ERVJdID0gUkVOREVSX0NMQVNTLAotCVtJOTE1X0VOR0lORV9DTEFTU19D
T1BZXSA9IENPUFlfRU5HSU5FX0NMQVNTLAotCVtJOTE1X0VOR0lORV9DTEFTU19WSURFT10gPSBW
SURFT19ERUNPREVfQ0xBU1MsCi0JW0k5MTVfRU5HSU5FX0NMQVNTX1ZJREVPX0VOSEFOQ0VdID0g
VklERU9fRU5IQU5DRU1FTlRfQ0xBU1MsCi19OwotCi1zdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICoK
LWludGVsX2VuZ2luZV9sb29rdXBfdXNlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwg
dTggY2xhc3MsIHU4IGluc3RhbmNlKQotewotCWlmIChjbGFzcyA+PSBBUlJBWV9TSVpFKHVzZXJf
Y2xhc3NfbWFwKSkKLQkJcmV0dXJuIE5VTEw7Ci0KLQljbGFzcyA9IHVzZXJfY2xhc3NfbWFwW2Ns
YXNzXTsKLQotCUdFTV9CVUdfT04oY2xhc3MgPiBNQVhfRU5HSU5FX0NMQVNTKTsKLQotCWlmIChp
bnN0YW5jZSA+IE1BWF9FTkdJTkVfSU5TVEFOQ0UpCi0JCXJldHVybiBOVUxMOwotCi0JcmV0dXJu
IGk5MTUtPmVuZ2luZV9jbGFzc1tjbGFzc11baW5zdGFuY2VdOwotfQotCiAvKioKICAqIGludGVs
X2VuYWJsZV9lbmdpbmVfc3RhdHMoKSAtIEVuYWJsZSBlbmdpbmUgYnVzeSB0cmFja2luZyBvbiBl
bmdpbmUKICAqIEBlbmdpbmU6IGVuZ2luZSB0byBlbmFibGUgc3RhdHMgY29sbGVjdGlvbgpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmggYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaAppbmRleCAyZTI3M2U4
ZjUwNjQuLmRhY2FhNzA3Yzc5NyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfZW5naW5lX3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
ZW5naW5lX3R5cGVzLmgKQEAgLTEyLDYgKzEyLDcgQEAKICNpbmNsdWRlIDxsaW51eC9rcmVmLmg+
CiAjaW5jbHVkZSA8bGludXgvbGlzdC5oPgogI2luY2x1ZGUgPGxpbnV4L2xsaXN0Lmg+CisjaW5j
bHVkZSA8bGludXgvcmJ0cmVlLmg+CiAjaW5jbHVkZSA8bGludXgvdGltZXIuaD4KICNpbmNsdWRl
IDxsaW51eC90eXBlcy5oPgogCkBAIC0yNjcsMTUgKzI2OCwxOSBAQCBzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzIHsKIAl1bnNpZ25lZCBpbnQgZ3VjX2lkOwogCWludGVsX2VuZ2luZV9tYXNrX3QgbWFz
azsKIAotCXU4IHVhYmlfY2xhc3M7Ci0KIAl1OCBjbGFzczsKIAl1OCBpbnN0YW5jZTsKKworCXU4
IHVhYmlfY2xhc3M7CisJdTggdWFiaV9pbnN0YW5jZTsKKwogCXUzMiBjb250ZXh0X3NpemU7CiAJ
dTMyIG1taW9fYmFzZTsKIAogCXUzMiB1YWJpX2NhcGFiaWxpdGllczsKIAorCXN0cnVjdCByYl9u
b2RlIHVhYmlfbm9kZTsKKwogCXN0cnVjdCBpbnRlbF9zc2V1IHNzZXU7CiAKIAlzdHJ1Y3QgaW50
ZWxfcmluZyAqYnVmZmVyOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZW5naW5lX3VzZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV91
c2VyLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi42OGZkYTFhYzNj
NjAKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdp
bmVfdXNlci5jCkBAIC0wLDAgKzEsMjI4IEBACisvKgorICogU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IE1JVAorICoKKyAqIENvcHlyaWdodCDCqSAyMDE5IEludGVsIENvcnBvcmF0aW9uCisgKi8K
KworI2luY2x1ZGUgPGxpbnV4L2xpc3QuaD4KKyNpbmNsdWRlIDxsaW51eC9saXN0X3NvcnQuaD4K
KyNpbmNsdWRlIDxsaW51eC9sbGlzdC5oPgorCisjaW5jbHVkZSAiaTkxNV9kcnYuaCIKKyNpbmNs
dWRlICJpbnRlbF9lbmdpbmUuaCIKKyNpbmNsdWRlICJpbnRlbF9lbmdpbmVfdXNlci5oIgorCitz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICoKK2ludGVsX2VuZ2luZV9sb29rdXBfdXNlcihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTggY2xhc3MsIHU4IGluc3RhbmNlKQoreworCXN0cnVj
dCByYl9ub2RlICpwID0gaTkxNS0+dWFiaV9lbmdpbmVzLnJiX25vZGU7CisKKwl3aGlsZSAocCkg
eworCQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICppdCA9CisJCQlyYl9lbnRyeShwLCB0eXBlb2Yo
Kml0KSwgdWFiaV9ub2RlKTsKKworCQlpZiAoY2xhc3MgPCBpdC0+dWFiaV9jbGFzcykKKwkJCXAg
PSBwLT5yYl9sZWZ0OworCQllbHNlIGlmIChjbGFzcyA+IGl0LT51YWJpX2NsYXNzIHx8CisJCQkg
aW5zdGFuY2UgPiBpdC0+dWFiaV9pbnN0YW5jZSkKKwkJCXAgPSBwLT5yYl9yaWdodDsKKwkJZWxz
ZSBpZiAoaW5zdGFuY2UgPCBpdC0+dWFiaV9pbnN0YW5jZSkKKwkJCXAgPSBwLT5yYl9sZWZ0Owor
CQllbHNlCisJCQlyZXR1cm4gaXQ7CisJfQorCisJcmV0dXJuIE5VTEw7Cit9CisKK3ZvaWQgaW50
ZWxfZW5naW5lX2FkZF91c2VyKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwls
bGlzdF9hZGQoKHN0cnVjdCBsbGlzdF9ub2RlICopJmVuZ2luZS0+dWFiaV9ub2RlLAorCQkgIChz
dHJ1Y3QgbGxpc3RfaGVhZCAqKSZlbmdpbmUtPmk5MTUtPnVhYmlfZW5naW5lcyk7Cit9CisKK3N0
YXRpYyBjb25zdCB1OCB1YWJpX2NsYXNzZXNbXSA9IHsKKwlbUkVOREVSX0NMQVNTXSA9IEk5MTVf
RU5HSU5FX0NMQVNTX1JFTkRFUiwKKwlbQ09QWV9FTkdJTkVfQ0xBU1NdID0gSTkxNV9FTkdJTkVf
Q0xBU1NfQ09QWSwKKwlbVklERU9fREVDT0RFX0NMQVNTXSA9IEk5MTVfRU5HSU5FX0NMQVNTX1ZJ
REVPLAorCVtWSURFT19FTkhBTkNFTUVOVF9DTEFTU10gPSBJOTE1X0VOR0lORV9DTEFTU19WSURF
T19FTkhBTkNFLAorfTsKKworc3RhdGljIGludCBlbmdpbmVfY21wKHZvaWQgKnByaXYsIHN0cnVj
dCBsaXN0X2hlYWQgKkEsIHN0cnVjdCBsaXN0X2hlYWQgKkIpCit7CisJY29uc3Qgc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqYSA9CisJCWNvbnRhaW5lcl9vZigoc3RydWN0IHJiX25vZGUgKilBLCB0
eXBlb2YoKmEpLCB1YWJpX25vZGUpOworCWNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmIg
PQorCQljb250YWluZXJfb2YoKHN0cnVjdCByYl9ub2RlICopQiwgdHlwZW9mKCpiKSwgdWFiaV9u
b2RlKTsKKworCWlmICh1YWJpX2NsYXNzZXNbYS0+Y2xhc3NdIDwgdWFiaV9jbGFzc2VzW2ItPmNs
YXNzXSkKKwkJcmV0dXJuIC0xOworCWlmICh1YWJpX2NsYXNzZXNbYS0+Y2xhc3NdID4gdWFiaV9j
bGFzc2VzW2ItPmNsYXNzXSkKKwkJcmV0dXJuIDE7CisKKwlpZiAoYS0+aW5zdGFuY2UgPCBiLT5p
bnN0YW5jZSkKKwkJcmV0dXJuIC0xOworCWlmIChhLT5pbnN0YW5jZSA+IGItPmluc3RhbmNlKQor
CQlyZXR1cm4gMTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgc3RydWN0IGxsaXN0X25vZGUg
KmdldF9lbmdpbmVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQoreworCXJldHVybiBs
bGlzdF9kZWxfYWxsKChzdHJ1Y3QgbGxpc3RfaGVhZCAqKSZpOTE1LT51YWJpX2VuZ2luZXMpOwor
fQorCitzdGF0aWMgdm9pZCBzb3J0X2VuZ2luZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCisJCQkgc3RydWN0IGxpc3RfaGVhZCAqZW5naW5lcykKK3sKKwlzdHJ1Y3QgbGxpc3Rfbm9k
ZSAqcG9zLCAqbmV4dDsKKworCWxsaXN0X2Zvcl9lYWNoX3NhZmUocG9zLCBuZXh0LCBnZXRfZW5n
aW5lcyhpOTE1KSkgeworCQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUgPQorCQkJY29u
dGFpbmVyX29mKChzdHJ1Y3QgcmJfbm9kZSAqKXBvcywgdHlwZW9mKCplbmdpbmUpLAorCQkJCSAg
ICAgdWFiaV9ub2RlKTsKKwkJbGlzdF9hZGQoKHN0cnVjdCBsaXN0X2hlYWQgKikmZW5naW5lLT51
YWJpX25vZGUsIGVuZ2luZXMpOworCX0KKwlsaXN0X3NvcnQoTlVMTCwgZW5naW5lcywgZW5naW5l
X2NtcCk7Cit9CisKK3N0YXRpYyB2b2lkIHNldF9zY2hlZHVsZXJfY2FwcyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSkKK3sKKwlzdGF0aWMgY29uc3Qgc3RydWN0IHsKKwkJdTggZW5naW5l
OworCQl1OCBzY2hlZDsKKwl9IG1hcFtdID0geworI2RlZmluZSBNQVAoeCwgeSkgeyBpbG9nMihJ
OTE1X0VOR0lORV8jI3gpLCBpbG9nMihJOTE1X1NDSEVEVUxFUl9DQVBfIyN5KSB9CisJCU1BUChI
QVNfUFJFRU1QVElPTiwgUFJFRU1QVElPTiksCisJCU1BUChIQVNfU0VNQVBIT1JFUywgU0VNQVBI
T1JFUyksCisJCU1BUChTVVBQT1JUU19TVEFUUywgRU5HSU5FX0JVU1lfU1RBVFMpLAorI3VuZGVm
IE1BUAorCX07CisJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOworCXUzMiBlbmFibGVk
LCBkaXNhYmxlZDsKKworCWVuYWJsZWQgPSAwOworCWRpc2FibGVkID0gMDsKKwlmb3JfZWFjaF91
YWJpX2VuZ2luZShlbmdpbmUsIGk5MTUpIHsgLyogYWxsIGVuZ2luZXMgbXVzdCBhZ3JlZSEgKi8K
KwkJaW50IGk7CisKKwkJaWYgKGVuZ2luZS0+c2NoZWR1bGUpCisJCQllbmFibGVkIHw9IChJOTE1
X1NDSEVEVUxFUl9DQVBfRU5BQkxFRCB8CisJCQkJICAgIEk5MTVfU0NIRURVTEVSX0NBUF9QUklP
UklUWSk7CisJCWVsc2UKKwkJCWRpc2FibGVkIHw9IChJOTE1X1NDSEVEVUxFUl9DQVBfRU5BQkxF
RCB8CisJCQkJICAgICBJOTE1X1NDSEVEVUxFUl9DQVBfUFJJT1JJVFkpOworCisJCWZvciAoaSA9
IDA7IGkgPCBBUlJBWV9TSVpFKG1hcCk7IGkrKykgeworCQkJaWYgKGVuZ2luZS0+ZmxhZ3MgJiBC
SVQobWFwW2ldLmVuZ2luZSkpCisJCQkJZW5hYmxlZCB8PSBCSVQobWFwW2ldLnNjaGVkKTsKKwkJ
CWVsc2UKKwkJCQlkaXNhYmxlZCB8PSBCSVQobWFwW2ldLnNjaGVkKTsKKwkJfQorCX0KKworCWk5
MTUtPmNhcHMuc2NoZWR1bGVyID0gZW5hYmxlZCAmIH5kaXNhYmxlZDsKKwlpZiAoIShpOTE1LT5j
YXBzLnNjaGVkdWxlciAmIEk5MTVfU0NIRURVTEVSX0NBUF9FTkFCTEVEKSkKKwkJaTkxNS0+Y2Fw
cy5zY2hlZHVsZXIgPSAwOworfQorCit2b2lkIGludGVsX2VuZ2luZXNfZHJpdmVyX3JlZ2lzdGVy
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQoreworCXU4IHVhYmlfaW5zdGFuY2VzWzRd
ID0ge307CisJc3RydWN0IGxpc3RfaGVhZCAqaXQsICpuZXh0OworCXN0cnVjdCByYl9ub2RlICoq
cCwgKnByZXY7CisJTElTVF9IRUFEKGVuZ2luZXMpOworCisJc29ydF9lbmdpbmVzKGk5MTUsICZl
bmdpbmVzKTsKKworCXByZXYgPSBOVUxMOworCXAgPSAmaTkxNS0+dWFiaV9lbmdpbmVzLnJiX25v
ZGU7CisJbGlzdF9mb3JfZWFjaF9zYWZlKGl0LCBuZXh0LCAmZW5naW5lcykgeworCQlzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUgPQorCQkJY29udGFpbmVyX29mKChzdHJ1Y3QgcmJfbm9k
ZSAqKWl0LCB0eXBlb2YoKmVuZ2luZSksCisJCQkJICAgICB1YWJpX25vZGUpOworCisJCUdFTV9C
VUdfT04oZW5naW5lLT5jbGFzcyA+PSBBUlJBWV9TSVpFKHVhYmlfY2xhc3NlcykpOworCQllbmdp
bmUtPnVhYmlfY2xhc3MgPSB1YWJpX2NsYXNzZXNbZW5naW5lLT5jbGFzc107CisKKwkJR0VNX0JV
R19PTihlbmdpbmUtPnVhYmlfY2xhc3MgPj0gQVJSQVlfU0laRSh1YWJpX2luc3RhbmNlcykpOwor
CQllbmdpbmUtPnVhYmlfaW5zdGFuY2UgPSB1YWJpX2luc3RhbmNlc1tlbmdpbmUtPnVhYmlfY2xh
c3NdKys7CisKKwkJcmJfbGlua19ub2RlKCZlbmdpbmUtPnVhYmlfbm9kZSwgcHJldiwgcCk7CisJ
CXJiX2luc2VydF9jb2xvcigmZW5naW5lLT51YWJpX25vZGUsICZpOTE1LT51YWJpX2VuZ2luZXMp
OworCisJCUdFTV9CVUdfT04oaW50ZWxfZW5naW5lX2xvb2t1cF91c2VyKGk5MTUsCisJCQkJCQkg
ICAgZW5naW5lLT51YWJpX2NsYXNzLAorCQkJCQkJICAgIGVuZ2luZS0+dWFiaV9pbnN0YW5jZSkg
IT0gZW5naW5lKTsKKworCQlwcmV2ID0gJmVuZ2luZS0+dWFiaV9ub2RlOworCQlwID0gJnByZXYt
PnJiX3JpZ2h0OworCX0KKworCWlmIChJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9TRUxGVEVT
VFMpICYmCisJICAgIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X0RFQlVHX0dFTSkpIHsKKwkJ
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOworCQl1bnNpZ25lZCBpbnQgaXNvbGF0aW9u
OworCQlpbnQgY2xhc3MsIGluc3Q7CisJCWludCBlcnJvcnMgPSAwOworCisJCWZvciAoY2xhc3Mg
PSAwOyBjbGFzcyA8IEFSUkFZX1NJWkUodWFiaV9pbnN0YW5jZXMpOyBjbGFzcysrKSB7CisJCQlm
b3IgKGluc3QgPSAwOyBpbnN0IDwgdWFiaV9pbnN0YW5jZXNbY2xhc3NdOyBpbnN0KyspIHsKKwkJ
CQllbmdpbmUgPSBpbnRlbF9lbmdpbmVfbG9va3VwX3VzZXIoaTkxNSwKKwkJCQkJCQkJICBjbGFz
cywgaW5zdCk7CisJCQkJaWYgKCFlbmdpbmUpIHsKKwkJCQkJcHJfZXJyKCJVQUJJIGVuZ2luZSBu
b3QgZm91bmQgZm9yIHsgY2xhc3M6JWQsIGluc3RhbmNlOiVkIH1cbiIsCisJCQkJCSAgICAgICBj
bGFzcywgaW5zdCk7CisJCQkJCWVycm9ycysrOworCQkJCQljb250aW51ZTsKKwkJCQl9CisKKwkJ
CQlpZiAoZW5naW5lLT51YWJpX2NsYXNzICE9IGNsYXNzIHx8CisJCQkJICAgIGVuZ2luZS0+dWFi
aV9pbnN0YW5jZSAhPSBpbnN0KSB7CisJCQkJCXByX2VycigiV3JvbmcgVUFCSSBlbmdpbmU6JXMg
eyBjbGFzczolZCwgaW5zdGFuY2U6JWQgfSBmb3VuZCBmb3IgeyBjbGFzczolZCwgaW5zdGFuY2U6
JWQgfVxuIiwKKwkJCQkJICAgICAgIGVuZ2luZS0+bmFtZSwKKwkJCQkJICAgICAgIGVuZ2luZS0+
dWFiaV9jbGFzcywKKwkJCQkJICAgICAgIGVuZ2luZS0+dWFiaV9pbnN0YW5jZSwKKwkJCQkJICAg
ICAgIGNsYXNzLCBpbnN0KTsKKwkJCQkJZXJyb3JzKys7CisJCQkJCWNvbnRpbnVlOworCQkJCX0K
KwkJCX0KKwkJfQorCisJCS8qCisJCSAqIE1ha2Ugc3VyZSB0aGF0IGNsYXNzZXMgd2l0aCBtdWx0
aXBsZSBlbmdpbmUgaW5zdGFuY2VzIGFsbAorCQkgKiBzaGFyZSB0aGUgc2FtZSBiYXNpYyBjb25m
aWd1cmF0aW9uLgorCQkgKi8KKwkJaXNvbGF0aW9uID0gaW50ZWxfZW5naW5lc19oYXNfY29udGV4
dF9pc29sYXRpb24oaTkxNSk7CisJCWZvcl9lYWNoX3VhYmlfZW5naW5lKGVuZ2luZSwgaTkxNSkg
eworCQkJdW5zaWduZWQgaW50IGJpdCA9IEJJVChlbmdpbmUtPnVhYmlfY2xhc3MpOworCQkJdW5z
aWduZWQgaW50IGV4cGVjdGVkID0gZW5naW5lLT5kZWZhdWx0X3N0YXRlID8gYml0IDogMDsKKwor
CQkJaWYgKChpc29sYXRpb24gJiBiaXQpICE9IGV4cGVjdGVkKSB7CisJCQkJcHJfZXJyKCJtaXNt
YXRjaGluZyBkZWZhdWx0IGNvbnRleHQgc3RhdGUgZm9yIGNsYXNzICVkIG9uIGVuZ2luZSAlc1xu
IiwKKwkJCQkgICAgICAgZW5naW5lLT51YWJpX2NsYXNzLCBlbmdpbmUtPm5hbWUpOworCQkJCWVy
cm9ycysrOworCQkJfQorCQl9CisKKwkJaWYgKFdBUk4oZXJyb3JzLCAiSW52YWxpZCBVQUJJIGVu
Z2luZSBtYXBwaW5nIGZvdW5kIikpCisJCQlpOTE1LT51YWJpX2VuZ2luZXMgPSBSQl9ST09UOwor
CX0KKworCXNldF9zY2hlZHVsZXJfY2FwcyhpOTE1KTsKK30KKwordW5zaWduZWQgaW50IGludGVs
X2VuZ2luZXNfaGFzX2NvbnRleHRfaXNvbGF0aW9uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQoreworCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKKwl1bnNpZ25lZCBpbnQg
d2hpY2g7CisKKwl3aGljaCA9IDA7CisJZm9yX2VhY2hfdWFiaV9lbmdpbmUoZW5naW5lLCBpOTE1
KQorCQlpZiAoZW5naW5lLT5kZWZhdWx0X3N0YXRlKQorCQkJd2hpY2ggfD0gQklUKGVuZ2luZS0+
dWFiaV9jbGFzcyk7CisKKwlyZXR1cm4gd2hpY2g7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdXNlci5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZW5naW5lX3VzZXIuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAw
MDAwMDAuLjllNWYxMTNlNTAyNwotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2VuZ2luZV91c2VyLmgKQEAgLTAsMCArMSwyMyBAQAorLyoKKyAqIFNQRFgt
TGljZW5zZS1JZGVudGlmaWVyOiBNSVQKKyAqCisgKiBDb3B5cmlnaHQgwqkgMjAxOSBJbnRlbCBD
b3Jwb3JhdGlvbgorICovCisKKyNpZm5kZWYgSU5URUxfRU5HSU5FX1VTRVJfSAorI2RlZmluZSBJ
TlRFTF9FTkdJTkVfVVNFUl9ICisKKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgorCitzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZTsKK3N0cnVjdCBpbnRlbF9lbmdpbmVfY3M7CisKK3N0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKgoraW50ZWxfZW5naW5lX2xvb2t1cF91c2VyKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LCB1OCBjbGFzcywgdTggaW5zdGFuY2UpOworCit1bnNpZ25lZCBpbnQgaW50
ZWxfZW5naW5lc19oYXNfY29udGV4dF9pc29sYXRpb24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpOworCit2b2lkIGludGVsX2VuZ2luZV9hZGRfdXNlcihzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUpOwordm9pZCBpbnRlbF9lbmdpbmVzX2RyaXZlcl9yZWdpc3RlcihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7CisKKyNlbmRpZiAvKiBJTlRFTF9FTkdJTkVfVVNFUl9I
ICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF90eXBlcy5o
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfdHlwZXMuaAppbmRleCAzNGQ0YTg2
OGU0ZjEuLjVmZDExZTM2MWQwMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfZ3RfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF90
eXBlcy5oCkBAIC0yMSw2ICsyMSw3IEBACiAKIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlOwogc3Ry
dWN0IGk5MTVfZ2d0dDsKK3N0cnVjdCBpbnRlbF9lbmdpbmVfY3M7CiBzdHJ1Y3QgaW50ZWxfdW5j
b3JlOwogCiBzdHJ1Y3QgaW50ZWxfaGFuZ2NoZWNrIHsKQEAgLTc2LDYgKzc3LDkgQEAgc3RydWN0
IGludGVsX2d0IHsKIAl1MzIgcG1faWVyOwogCiAJdTMyIHBtX2d1Y19ldmVudHM7CisKKwlzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmVfY2xhc3NbTUFYX0VOR0lORV9DTEFTUyArIDFdCisJ
CQkJCSAgICBbTUFYX0VOR0lORV9JTlNUQU5DRSArIDFdOwogfTsKIAogZW51bSBpbnRlbF9ndF9z
Y3JhdGNoX2ZpZWxkIHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0
ZXN0X2xyYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKaW5kZXgg
YjQwYjU3ZDJkYWFlLi5iMjYyMjU3NTFhNTQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0
ZXN0X2xyYy5jCkBAIC0xNzkyLDYgKzE3OTIsNyBAQCBzdGF0aWMgaW50IGxpdmVfdmlydHVhbF9l
bmdpbmUodm9pZCAqYXJnKQogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYXJnOwog
CXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKnNpYmxpbmdzW01BWF9FTkdJTkVfSU5TVEFOQ0UgKyAx
XTsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CisJc3RydWN0IGludGVsX2d0ICpn
dCA9ICZpOTE1LT5ndDsKIAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKIAl1bnNpZ25lZCBpbnQg
Y2xhc3MsIGluc3Q7CiAJaW50IGVyciA9IC1FTk9ERVY7CkBAIC0xODE1LDEwICsxODE2LDEwIEBA
IHN0YXRpYyBpbnQgbGl2ZV92aXJ0dWFsX2VuZ2luZSh2b2lkICphcmcpCiAKIAkJbnNpYmxpbmcg
PSAwOwogCQlmb3IgKGluc3QgPSAwOyBpbnN0IDw9IE1BWF9FTkdJTkVfSU5TVEFOQ0U7IGluc3Qr
KykgewotCQkJaWYgKCFpOTE1LT5lbmdpbmVfY2xhc3NbY2xhc3NdW2luc3RdKQorCQkJaWYgKCFn
dC0+ZW5naW5lX2NsYXNzW2NsYXNzXVtpbnN0XSkKIAkJCQljb250aW51ZTsKIAotCQkJc2libGlu
Z3NbbnNpYmxpbmcrK10gPSBpOTE1LT5lbmdpbmVfY2xhc3NbY2xhc3NdW2luc3RdOworCQkJc2li
bGluZ3NbbnNpYmxpbmcrK10gPSBndC0+ZW5naW5lX2NsYXNzW2NsYXNzXVtpbnN0XTsKIAkJfQog
CQlpZiAobnNpYmxpbmcgPCAyKQogCQkJY29udGludWU7CkBAIC0xOTM5LDYgKzE5NDAsNyBAQCBz
dGF0aWMgaW50IGxpdmVfdmlydHVhbF9tYXNrKHZvaWQgKmFyZykKIHsKIAlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IGFyZzsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpzaWJsaW5n
c1tNQVhfRU5HSU5FX0lOU1RBTkNFICsgMV07CisJc3RydWN0IGludGVsX2d0ICpndCA9ICZpOTE1
LT5ndDsKIAl1bnNpZ25lZCBpbnQgY2xhc3MsIGluc3Q7CiAJaW50IGVyciA9IDA7CiAKQEAgLTE5
NTIsMTAgKzE5NTQsMTAgQEAgc3RhdGljIGludCBsaXZlX3ZpcnR1YWxfbWFzayh2b2lkICphcmcp
CiAKIAkJbnNpYmxpbmcgPSAwOwogCQlmb3IgKGluc3QgPSAwOyBpbnN0IDw9IE1BWF9FTkdJTkVf
SU5TVEFOQ0U7IGluc3QrKykgewotCQkJaWYgKCFpOTE1LT5lbmdpbmVfY2xhc3NbY2xhc3NdW2lu
c3RdKQorCQkJaWYgKCFndC0+ZW5naW5lX2NsYXNzW2NsYXNzXVtpbnN0XSkKIAkJCQlicmVhazsK
IAotCQkJc2libGluZ3NbbnNpYmxpbmcrK10gPSBpOTE1LT5lbmdpbmVfY2xhc3NbY2xhc3NdW2lu
c3RdOworCQkJc2libGluZ3NbbnNpYmxpbmcrK10gPSBndC0+ZW5naW5lX2NsYXNzW2NsYXNzXVtp
bnN0XTsKIAkJfQogCQlpZiAobnNpYmxpbmcgPCAyKQogCQkJY29udGludWU7CkBAIC0yMTE2LDYg
KzIxMTgsNyBAQCBzdGF0aWMgaW50IGxpdmVfdmlydHVhbF9ib25kKHZvaWQgKmFyZykKIAl9Owog
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYXJnOwogCXN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKnNpYmxpbmdzW01BWF9FTkdJTkVfSU5TVEFOQ0UgKyAxXTsKKwlzdHJ1Y3QgaW50ZWxf
Z3QgKmd0ID0gJmk5MTUtPmd0OwogCXVuc2lnbmVkIGludCBjbGFzcywgaW5zdDsKIAlpbnQgZXJy
ID0gMDsKIApAQCAtMjEzMCwxMSArMjEzMywxMSBAQCBzdGF0aWMgaW50IGxpdmVfdmlydHVhbF9i
b25kKHZvaWQgKmFyZykKIAogCQluc2libGluZyA9IDA7CiAJCWZvciAoaW5zdCA9IDA7IGluc3Qg
PD0gTUFYX0VOR0lORV9JTlNUQU5DRTsgaW5zdCsrKSB7Ci0JCQlpZiAoIWk5MTUtPmVuZ2luZV9j
bGFzc1tjbGFzc11baW5zdF0pCisJCQlpZiAoIWd0LT5lbmdpbmVfY2xhc3NbY2xhc3NdW2luc3Rd
KQogCQkJCWJyZWFrOwogCiAJCQlHRU1fQlVHX09OKG5zaWJsaW5nID09IEFSUkFZX1NJWkUoc2li
bGluZ3MpKTsKLQkJCXNpYmxpbmdzW25zaWJsaW5nKytdID0gaTkxNS0+ZW5naW5lX2NsYXNzW2Ns
YXNzXVtpbnN0XTsKKwkJCXNpYmxpbmdzW25zaWJsaW5nKytdID0gZ3QtPmVuZ2luZV9jbGFzc1tj
bGFzc11baW5zdF07CiAJCX0KIAkJaWYgKG5zaWJsaW5nIDwgMikKIAkJCWNvbnRpbnVlOwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rfd29ya2Fyb3VuZHMuYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMKaW5kZXggOTk3
ZGE5NDgyMWQ5Li41ZWZkMmJiODlkNWYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
c2VsZnRlc3Rfd29ya2Fyb3VuZHMuYwpAQCAtNSw2ICs1LDcgQEAKICAqLwogCiAjaW5jbHVkZSAi
Z2VtL2k5MTVfZ2VtX3BtLmgiCisjaW5jbHVkZSAiZ3QvaW50ZWxfZW5naW5lX3VzZXIuaCIKICNp
bmNsdWRlICJndC9pbnRlbF9ndC5oIgogI2luY2x1ZGUgImk5MTVfc2VsZnRlc3QuaCIKICNpbmNs
dWRlICJpbnRlbF9yZXNldC5oIgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
dWMvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2lu
dGVsX2d1Y19zdWJtaXNzaW9uLmMKaW5kZXggNDEyODkyMDk2ZGFhLi5hNzhiZDk5YmM2Y2IgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9u
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX3N1Ym1pc3Npb24u
YwpAQCAtNDg4LDcgKzQ4OCw3IEBAIHN0YXRpYyB2b2lkIGd1Y19hZGRfcmVxdWVzdChzdHJ1Y3Qg
aW50ZWxfZ3VjICpndWMsIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogCQkJICAgcmluZ190YWls
LCBycS0+ZmVuY2Uuc2Vxbm8pOwogCWd1Y19yaW5nX2Rvb3JiZWxsKGNsaWVudCk7CiAKLQljbGll
bnQtPnN1Ym1pc3Npb25zW2VuZ2luZS0+aWRdICs9IDE7CisJY2xpZW50LT5zdWJtaXNzaW9uc1tl
bmdpbmUtPmd1Y19pZF0gKz0gMTsKIH0KIAogLyoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfY21kX3BhcnNlci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9jbWRf
cGFyc2VyLmMKaW5kZXggYTI4YmNkMmQ3YzA5Li5jYjRhMGNhNzJlZmUgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfY21kX3BhcnNlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfY21kX3BhcnNlci5jCkBAIC0xMzUyLDExICsxMzUyLDEwIEBAIGludCBpbnRl
bF9lbmdpbmVfY21kX3BhcnNlcihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCiBpbnQg
aTkxNV9jbWRfcGFyc2VyX2dldF92ZXJzaW9uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKIHsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0JZW51bSBpbnRlbF9l
bmdpbmVfaWQgaWQ7CiAJYm9vbCBhY3RpdmUgPSBmYWxzZTsKIAogCS8qIElmIHRoZSBjb21tYW5k
IHBhcnNlciBpcyBub3QgZW5hYmxlZCwgcmVwb3J0IDAgLSB1bnN1cHBvcnRlZCAqLwotCWZvcl9l
YWNoX2VuZ2luZShlbmdpbmUsIGRldl9wcml2LCBpZCkgeworCWZvcl9lYWNoX3VhYmlfZW5naW5l
KGVuZ2luZSwgZGV2X3ByaXYpIHsKIAkJaWYgKGludGVsX2VuZ2luZV9uZWVkc19jbWRfcGFyc2Vy
KGVuZ2luZSkpIHsKIAkJCWFjdGl2ZSA9IHRydWU7CiAJCQlicmVhazsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9kZWJ1Z2ZzLmMKaW5kZXggODk1MzMzNmYyYWU1Li42M2I1OTlmNTg0ZGIgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCkBAIC00MTUsNyArNDE1LDYgQEAgc3RhdGljIGludCBp
OTE1X2ludGVycnVwdF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKIHsKIAlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0
ZSk7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCWVudW0gaW50ZWxfZW5naW5l
X2lkIGlkOwogCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwogCWludCBpLCBwaXBlOwogCkBAIC02
MTgsNyArNjE3LDcgQEAgc3RhdGljIGludCBpOTE1X2ludGVycnVwdF9pbmZvKHN0cnVjdCBzZXFf
ZmlsZSAqbSwgdm9pZCAqZGF0YSkKIAkJCSAgIEk5MTVfUkVBRChHRU4xMV9HVU5JVF9DU01FX0lO
VFJfTUFTSykpOwogCiAJfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDYpIHsKLQkJ
Zm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYsIGlkKSB7CisJCWZvcl9lYWNoX3VhYmlf
ZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYpIHsKIAkJCXNlcV9wcmludGYobSwKIAkJCQkgICAiR3Jh
cGhpY3MgSW50ZXJydXB0IG1hc2sgKCVzKToJJTA4eFxuIiwKIAkJCQkgICBlbmdpbmUtPm5hbWUs
IEVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19JTVIpKTsKQEAgLTE4OTAsNyArMTg4OSw2IEBAIHN0
YXRpYyB2b2lkIGk5MTVfZ3VjX2NsaWVudF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwKIAkJCQkg
c3RydWN0IGludGVsX2d1Y19jbGllbnQgKmNsaWVudCkKIHsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmU7Ci0JZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CiAJdTY0IHRvdCA9IDA7CiAK
IAlzZXFfcHJpbnRmKG0sICJcdFByaW9yaXR5ICVkLCBHdUMgc3RhZ2UgaW5kZXg6ICV1LCBQRCBv
ZmZzZXQgMHgleFxuIiwKQEAgLTE4OTgsOCArMTg5Niw4IEBAIHN0YXRpYyB2b2lkIGk5MTVfZ3Vj
X2NsaWVudF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwKIAlzZXFfcHJpbnRmKG0sICJcdERvb3Ji
ZWxsIGlkICVkLCBvZmZzZXQ6IDB4JWx4XG4iLAogCQljbGllbnQtPmRvb3JiZWxsX2lkLCBjbGll
bnQtPmRvb3JiZWxsX29mZnNldCk7CiAKLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJp
diwgaWQpIHsKLQkJdTY0IHN1Ym1pc3Npb25zID0gY2xpZW50LT5zdWJtaXNzaW9uc1tpZF07CisJ
Zm9yX2VhY2hfdWFiaV9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdikgeworCQl1NjQgc3VibWlzc2lv
bnMgPSBjbGllbnQtPnN1Ym1pc3Npb25zW2VuZ2luZS0+Z3VjX2lkXTsKIAkJdG90ICs9IHN1Ym1p
c3Npb25zOwogCQlzZXFfcHJpbnRmKG0sICJcdFN1Ym1pc3Npb25zOiAlbGx1ICVzXG4iLAogCQkJ
CXN1Ym1pc3Npb25zLCBlbmdpbmUtPm5hbWUpOwpAQCAtMTkzOSw3ICsxOTM3LDYgQEAgc3RhdGlj
IGludCBpOTE1X2d1Y19zdGFnZV9wb29sKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkK
IAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJp
dmF0ZSk7CiAJY29uc3Qgc3RydWN0IGludGVsX2d1YyAqZ3VjID0gJmRldl9wcml2LT5ndC51Yy5n
dWM7CiAJc3RydWN0IGd1Y19zdGFnZV9kZXNjICpkZXNjID0gZ3VjLT5zdGFnZV9kZXNjX3Bvb2xf
dmFkZHI7Ci0JaW50ZWxfZW5naW5lX21hc2tfdCB0bXA7CiAJaW50IGluZGV4OwogCiAJaWYgKCFV
U0VTX0dVQ19TVUJNSVNTSU9OKGRldl9wcml2KSkKQEAgLTE5NjgsNyArMTk2NSw3IEBAIHN0YXRp
YyBpbnQgaTkxNV9ndWNfc3RhZ2VfcG9vbChzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEp
CiAJCQkgICBkZXNjLT53cV9hZGRyLCBkZXNjLT53cV9zaXplKTsKIAkJc2VxX3B1dGMobSwgJ1xu
Jyk7CiAKLQkJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYsIHRtcCkgeworCQlmb3Jf
ZWFjaF91YWJpX2VuZ2luZShlbmdpbmUsIGRldl9wcml2KSB7CiAJCQl1MzIgZ3VjX2VuZ2luZV9p
ZCA9IGVuZ2luZS0+Z3VjX2lkOwogCQkJc3RydWN0IGd1Y19leGVjbGlzdF9jb250ZXh0ICpscmMg
PQogCQkJCQkJJmRlc2MtPmxyY1tndWNfZW5naW5lX2lkXTsKQEAgLTI4MDYsNyArMjgwMyw2IEBA
IHN0YXRpYyBpbnQgaTkxNV9lbmdpbmVfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVu
dXNlZCkKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUo
bS0+cHJpdmF0ZSk7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwogCWludGVsX3dh
a2VyZWZfdCB3YWtlcmVmOwotCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwogCXN0cnVjdCBkcm1f
cHJpbnRlciBwOwogCiAJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0+
cnVudGltZV9wbSk7CkBAIC0yODE4LDcgKzI4MTQsNyBAQCBzdGF0aWMgaW50IGk5MTVfZW5naW5l
X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCiAJCSAgIFJVTlRJTUVfSU5G
TyhkZXZfcHJpdiktPmNzX3RpbWVzdGFtcF9mcmVxdWVuY3lfa2h6KTsKIAogCXAgPSBkcm1fc2Vx
X2ZpbGVfcHJpbnRlcihtKTsKLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQp
CisJZm9yX2VhY2hfdWFiaV9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdikKIAkJaW50ZWxfZW5naW5l
X2R1bXAoZW5naW5lLCAmcCwgIiVzXG4iLCBlbmdpbmUtPm5hbWUpOwogCiAJaW50ZWxfcnVudGlt
ZV9wbV9wdXQoJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKQEAgLTI4OTksOSArMjg5
NSw4IEBAIHN0YXRpYyBpbnQgaTkxNV93YV9yZWdpc3RlcnMoc3RydWN0IHNlcV9maWxlICptLCB2
b2lkICp1bnVzZWQpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3Rv
X2k5MTUobS0+cHJpdmF0ZSk7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCWVu
dW0gaW50ZWxfZW5naW5lX2lkIGlkOwogCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwg
aWQpIHsKKwlmb3JfZWFjaF91YWJpX2VuZ2luZShlbmdpbmUsIGk5MTUpIHsKIAkJY29uc3Qgc3Ry
dWN0IGk5MTVfd2FfbGlzdCAqd2FsID0gJmVuZ2luZS0+Y3R4X3dhX2xpc3Q7CiAJCWNvbnN0IHN0
cnVjdCBpOTE1X3dhICp3YTsKIAkJdW5zaWduZWQgaW50IGNvdW50OwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
ZHJ2LmMKaW5kZXggNzdkYzY2ZDZlODhmLi5hYzU4NjhjMTJiOTcgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kcnYuYwpAQCAtNjEsNiArNjEsNyBAQAogCiAjaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX2NvbnRl
eHQuaCIKICNpbmNsdWRlICJnZW0vaTkxNV9nZW1faW9jdGxzLmgiCisjaW5jbHVkZSAiZ3QvaW50
ZWxfZW5naW5lX3VzZXIuaCIKICNpbmNsdWRlICJndC9pbnRlbF9ndC5oIgogI2luY2x1ZGUgImd0
L2ludGVsX2d0X3BtLmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfcmVzZXQuaCIKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2Rydi5oCmluZGV4IGMyNDFhYWUwN2IzZS4uZDFhNDAwZjY1NDMyIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZHJ2LmgKQEAgLTEzNzYsMTEgKzEzNzYsMTIgQEAgc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgewogCXdhaXRfcXVldWVfaGVhZF90IGdtYnVzX3dhaXRfcXVldWU7CiAKIAlzdHJ1Y3QgcGNp
X2RldiAqYnJpZGdlX2RldjsKLQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmVbSTkxNV9O
VU1fRU5HSU5FU107CisKIAkvKiBDb250ZXh0IHVzZWQgaW50ZXJuYWxseSB0byBpZGxlIHRoZSBH
UFUgYW5kIHNldHVwIGluaXRpYWwgc3RhdGUgKi8KIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAq
a2VybmVsX2NvbnRleHQ7Ci0Jc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lX2NsYXNzW01B
WF9FTkdJTkVfQ0xBU1MgKyAxXQotCQkJCQkgICAgW01BWF9FTkdJTkVfSU5TVEFOQ0UgKyAxXTsK
KworCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZVtJOTE1X05VTV9FTkdJTkVTXTsKKwlz
dHJ1Y3QgcmJfcm9vdCB1YWJpX2VuZ2luZXM7CiAKIAlzdHJ1Y3QgcmVzb3VyY2UgbWNoX3JlczsK
IApAQCAtMTkyNCw2ICsxOTI1LDE0IEBAIHN0YXRpYyBpbmxpbmUgc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKndvcGNtX3RvX2k5MTUoc3RydWN0IGludGVsX3dvcGNtICp3b3BjbSkKIAkgICAgICgo
ZW5naW5lX18pID0gKGRldl9wcml2X18pLT5lbmdpbmVbX19tYXNrX25leHRfYml0KHRtcF9fKV0p
LCAxIDogXAogCSAgICAgMDspCiAKKyNkZWZpbmUgcmJfdG9fdWFiaV9lbmdpbmUocmIpIFwKKwly
Yl9lbnRyeV9zYWZlKHJiLCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzLCB1YWJpX25vZGUpCisKKyNk
ZWZpbmUgZm9yX2VhY2hfdWFiaV9lbmdpbmUoZW5naW5lX18sIGk5MTVfXykgXAorCWZvciAoKGVu
Z2luZV9fKSA9IHJiX3RvX3VhYmlfZW5naW5lKHJiX2ZpcnN0KCYoaTkxNV9fKS0+dWFiaV9lbmdp
bmVzKSk7XAorCSAgICAgKGVuZ2luZV9fKTsgXAorCSAgICAgKGVuZ2luZV9fKSA9IHJiX3RvX3Vh
YmlfZW5naW5lKHJiX25leHQoJihlbmdpbmVfXyktPnVhYmlfbm9kZSkpKQorCiBlbnVtIGhkbWlf
Zm9yY2VfYXVkaW8gewogCUhETUlfQVVESU9fT0ZGX0RWSSA9IC0yLAkvKiBubyBhdXggZGF0YSBm
b3IgSERNSS1EVkkgY29udmVydGVyICovCiAJSERNSV9BVURJT19PRkYsCQkJLyogZm9yY2UgdHVy
biBvZmYgSERNSSBhdWRpbyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKaW5kZXggNWFiMWRkZmVm
MjNjLi43ZWZmZjE0YjkxMzcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
Z2VtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwpAQCAtNDYsNiArNDYs
NyBAQAogI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9pb2N0bHMuaCIKICNpbmNsdWRlICJnZW0vaTkx
NV9nZW1fcG0uaCIKICNpbmNsdWRlICJnZW0vaTkxNV9nZW1mcy5oIgorI2luY2x1ZGUgImd0L2lu
dGVsX2VuZ2luZV91c2VyLmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfZ3QuaCIKICNpbmNsdWRlICJn
dC9pbnRlbF9ndF9wbS5oIgogI2luY2x1ZGUgImd0L2ludGVsX21vY3MuaCIKQEAgLTEzNTksMjQg
KzEzNjAsNiBAQCBzdGF0aWMgaW50IF9faW50ZWxfZW5naW5lc19yZWNvcmRfZGVmYXVsdHMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAo
ZW5naW5lLT5kZWZhdWx0X3N0YXRlKTsKIAl9CiAKLQlpZiAoSVNfRU5BQkxFRChDT05GSUdfRFJN
X0k5MTVfREVCVUdfR0VNKSkgewotCQl1bnNpZ25lZCBpbnQgZm91bmQgPSBpbnRlbF9lbmdpbmVz
X2hhc19jb250ZXh0X2lzb2xhdGlvbihpOTE1KTsKLQotCQkvKgotCQkgKiBNYWtlIHN1cmUgdGhh
dCBjbGFzc2VzIHdpdGggbXVsdGlwbGUgZW5naW5lIGluc3RhbmNlcyBhbGwKLQkJICogc2hhcmUg
dGhlIHNhbWUgYmFzaWMgY29uZmlndXJhdGlvbi4KLQkJICovCi0JCWZvcl9lYWNoX2VuZ2luZShl
bmdpbmUsIGk5MTUsIGlkKSB7Ci0JCQl1bnNpZ25lZCBpbnQgYml0ID0gQklUKGVuZ2luZS0+dWFi
aV9jbGFzcyk7Ci0JCQl1bnNpZ25lZCBpbnQgZXhwZWN0ZWQgPSBlbmdpbmUtPmRlZmF1bHRfc3Rh
dGUgPyBiaXQgOiAwOwotCi0JCQlpZiAoKGZvdW5kICYgYml0KSAhPSBleHBlY3RlZCkgewotCQkJ
CURSTV9FUlJPUigibWlzbWF0Y2hpbmcgZGVmYXVsdCBjb250ZXh0IHN0YXRlIGZvciBjbGFzcyAl
ZCBvbiBlbmdpbmUgJXNcbiIsCi0JCQkJCSAgZW5naW5lLT51YWJpX2NsYXNzLCBlbmdpbmUtPm5h
bWUpOwotCQkJfQotCQl9Ci0JfQotCiBvdXRfY3R4OgogCWk5MTVfZ2VtX2NvbnRleHRfdW5sb2Nr
X2VuZ2luZXMoY3R4KTsKIAlpOTE1X2dlbV9jb250ZXh0X3NldF9jbG9zZWQoY3R4KTsKQEAgLTE2
MDAsNyArMTU4Myw4IEBAIGludCBpOTE1X2dlbV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKIHZvaWQgaTkxNV9nZW1fZHJpdmVyX3JlZ2lzdGVyKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQogewogCWk5MTVfZ2VtX2RyaXZlcl9yZWdpc3Rlcl9fc2hyaW5rZXIo
aTkxNSk7Ci0JaW50ZWxfZW5naW5lc19zZXRfc2NoZWR1bGVyX2NhcHMoaTkxNSk7CisKKwlpbnRl
bF9lbmdpbmVzX2RyaXZlcl9yZWdpc3RlcihpOTE1KTsKIH0KIAogdm9pZCBpOTE1X2dlbV9kcml2
ZXJfdW5yZWdpc3RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2lycS5jCmluZGV4IDMzYWM1ZDdlMWU5ZS4uOTA5NGM0ODExZjU0IDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2lycS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfaXJxLmMKQEAgLTMyNTEsNyArMzI1MSw3IEBAIGdlbjExX2VuZ2luZV9pcnFfaGFuZGxl
cihzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBjb25zdCB1OCBjbGFzcywKIAlzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmU7CiAKIAlpZiAoaW5zdGFuY2UgPD0gTUFYX0VOR0lORV9JTlNUQU5DRSkK
LQkJZW5naW5lID0gZ3QtPmk5MTUtPmVuZ2luZV9jbGFzc1tjbGFzc11baW5zdGFuY2VdOworCQll
bmdpbmUgPSBndC0+ZW5naW5lX2NsYXNzW2NsYXNzXVtpbnN0YW5jZV07CiAJZWxzZQogCQllbmdp
bmUgPSBOVUxMOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYu
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5jCmluZGV4IGYyY2M2OWNjYjYzNS4u
MmJjZjBkNmUyZWUyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYwpAQCAtMTg3NSw3ICsxODc1
LDYgQEAgc3RhdGljIGludCBnZW44X2NvbmZpZ3VyZV9hbGxfY29udGV4dHMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCiAjdW5kZWYgY3R4X2ZsZXhldU4KIAlzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmU7CiAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eDsKLQllbnVtIGlu
dGVsX2VuZ2luZV9pZCBpZDsKIAlpbnQgaTsKIAogCWZvciAoaSA9IDI7IGkgPCBBUlJBWV9TSVpF
KHJlZ3MpOyBpKyspCkBAIC0xOTE1LDcgKzE5MTQsNyBAQCBzdGF0aWMgaW50IGdlbjhfY29uZmln
dXJlX2FsbF9jb250ZXh0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkgKiBJZiB3
ZSBkb24ndCBtb2RpZnkgdGhlIGtlcm5lbF9jb250ZXh0LCB3ZSBkbyBub3QgZ2V0IGV2ZW50cyB3
aGlsZQogCSAqIGlkbGUuCiAJICovCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQp
IHsKKwlmb3JfZWFjaF91YWJpX2VuZ2luZShlbmdpbmUsIGk5MTUpIHsKIAkJc3RydWN0IGludGVs
X2NvbnRleHQgKmNlID0gZW5naW5lLT5rZXJuZWxfY29udGV4dDsKIAkJaW50IGVycjsKIApkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wbXUuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfcG11LmMKaW5kZXggYzJlNWY2ZDVjMWUwLi5jN2VlMGFiMTgwZTggMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11LmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9wbXUuYwpAQCAtOSw2ICs5LDcgQEAKIAogI2luY2x1ZGUgImd0L2ludGVs
X2VuZ2luZS5oIgogI2luY2x1ZGUgImd0L2ludGVsX2VuZ2luZV9wbS5oIgorI2luY2x1ZGUgImd0
L2ludGVsX2VuZ2luZV91c2VyLmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfZ3RfcG0uaCIKIAogI2lu
Y2x1ZGUgImk5MTVfZHJ2LmgiCkBAIC04NjAsNyArODYxLDYgQEAgY3JlYXRlX2V2ZW50X2F0dHJp
YnV0ZXMoc3RydWN0IGk5MTVfcG11ICpwbXUpCiAJc3RydWN0IGk5MTVfZXh0X2F0dHJpYnV0ZSAq
aTkxNV9hdHRyID0gTlVMTCwgKmk5MTVfaXRlcjsKIAlzdHJ1Y3QgYXR0cmlidXRlICoqYXR0ciA9
IE5VTEwsICoqYXR0cl9pdGVyOwogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKLQll
bnVtIGludGVsX2VuZ2luZV9pZCBpZDsKIAl1bnNpZ25lZCBpbnQgaTsKIAogCS8qIENvdW50IGhv
dyBtYW55IGNvdW50ZXJzIHdlIHdpbGwgYmUgZXhwb3NpbmcuICovCkBAIC04NjksNyArODY5LDcg
QEAgY3JlYXRlX2V2ZW50X2F0dHJpYnV0ZXMoc3RydWN0IGk5MTVfcG11ICpwbXUpCiAJCQljb3Vu
dCsrOwogCX0KIAotCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKSB7CisJZm9yX2Vh
Y2hfdWFiaV9lbmdpbmUoZW5naW5lLCBpOTE1KSB7CiAJCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9T
SVpFKGVuZ2luZV9ldmVudHMpOyBpKyspIHsKIAkJCWlmICghZW5naW5lX2V2ZW50X3N0YXR1cyhl
bmdpbmUsCiAJCQkJCQkgZW5naW5lX2V2ZW50c1tpXS5zYW1wbGUpKQpAQCAtOTIwLDcgKzkyMCw3
IEBAIGNyZWF0ZV9ldmVudF9hdHRyaWJ1dGVzKHN0cnVjdCBpOTE1X3BtdSAqcG11KQogCX0KIAog
CS8qIEluaXRpYWxpemUgc3VwcG9ydGVkIGVuZ2luZSBjb3VudGVycy4gKi8KLQlmb3JfZWFjaF9l
bmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgeworCWZvcl9lYWNoX3VhYmlfZW5naW5lKGVuZ2luZSwg
aTkxNSkgewogCQlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShlbmdpbmVfZXZlbnRzKTsgaSsr
KSB7CiAJCQljaGFyICpzdHI7CiAKQEAgLTkzNyw3ICs5MzcsNyBAQCBjcmVhdGVfZXZlbnRfYXR0
cmlidXRlcyhzdHJ1Y3QgaTkxNV9wbXUgKnBtdSkKIAkJCWk5MTVfaXRlciA9CiAJCQkJYWRkX2k5
MTVfYXR0cihpOTE1X2l0ZXIsIHN0ciwKIAkJCQkJICAgICAgX19JOTE1X1BNVV9FTkdJTkUoZW5n
aW5lLT51YWJpX2NsYXNzLAotCQkJCQkJCQllbmdpbmUtPmluc3RhbmNlLAorCQkJCQkJCQllbmdp
bmUtPnVhYmlfaW5zdGFuY2UsCiAJCQkJCQkJCWVuZ2luZV9ldmVudHNbaV0uc2FtcGxlKSk7CiAK
IAkJCXN0ciA9IGthc3ByaW50ZihHRlBfS0VSTkVMLCAiJXMtJXMudW5pdCIsCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3F1ZXJ5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3F1ZXJ5LmMKaW5kZXggN2I3MDE2MTcxMDU3Li5hZDkyNDBhMDgxN2EgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcXVlcnkuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3F1ZXJ5LmMKQEAgLTEwNSw3ICsxMDUsNiBAQCBxdWVyeV9lbmdpbmVfaW5m
byhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAlzdHJ1Y3QgZHJtX2k5MTVfcXVlcnlf
ZW5naW5lX2luZm8gcXVlcnk7CiAJc3RydWN0IGRybV9pOTE1X2VuZ2luZV9pbmZvIGluZm8gPSB7
IH07CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCWVudW0gaW50ZWxfZW5naW5l
X2lkIGlkOwogCWludCBsZW4sIHJldDsKIAogCWlmIChxdWVyeV9pdGVtLT5mbGFncykKQEAgLTEy
NSw5ICsxMjQsOSBAQCBxdWVyeV9lbmdpbmVfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKIAogCWluZm9fcHRyID0gJnF1ZXJ5X3B0ci0+ZW5naW5lc1swXTsKIAotCWZvcl9lYWNo
X2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKSB7CisJZm9yX2VhY2hfdWFiaV9lbmdpbmUoZW5naW5l
LCBpOTE1KSB7CiAJCWluZm8uZW5naW5lLmVuZ2luZV9jbGFzcyA9IGVuZ2luZS0+dWFiaV9jbGFz
czsKLQkJaW5mby5lbmdpbmUuZW5naW5lX2luc3RhbmNlID0gZW5naW5lLT5pbnN0YW5jZTsKKwkJ
aW5mby5lbmdpbmUuZW5naW5lX2luc3RhbmNlID0gZW5naW5lLT51YWJpX2luc3RhbmNlOwogCQlp
bmZvLmNhcGFiaWxpdGllcyA9IGVuZ2luZS0+dWFiaV9jYXBhYmlsaXRpZXM7CiAKIAkJaWYgKF9f
Y29weV90b191c2VyKGluZm9fcHRyLCAmaW5mbywgc2l6ZW9mKGluZm8pKSkKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdHJhY2UuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfdHJhY2UuaAppbmRleCBkYTE4YjhkNmI4MGMuLjFkMTEyNDVjNGM4NyAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90cmFjZS5oCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfdHJhY2UuaApAQCAtNjc3LDcgKzY3Nyw3IEBAIFRSQUNFX0VWRU5UKGk5MTVf
cmVxdWVzdF9xdWV1ZSwKIAkJCSAgIF9fZW50cnktPmRldiA9IHJxLT5pOTE1LT5kcm0ucHJpbWFy
eS0+aW5kZXg7CiAJCQkgICBfX2VudHJ5LT5od19pZCA9IHJxLT5nZW1fY29udGV4dC0+aHdfaWQ7
CiAJCQkgICBfX2VudHJ5LT5jbGFzcyA9IHJxLT5lbmdpbmUtPnVhYmlfY2xhc3M7Ci0JCQkgICBf
X2VudHJ5LT5pbnN0YW5jZSA9IHJxLT5lbmdpbmUtPmluc3RhbmNlOworCQkJICAgX19lbnRyeS0+
aW5zdGFuY2UgPSBycS0+ZW5naW5lLT51YWJpX2luc3RhbmNlOwogCQkJICAgX19lbnRyeS0+Y3R4
ID0gcnEtPmZlbmNlLmNvbnRleHQ7CiAJCQkgICBfX2VudHJ5LT5zZXFubyA9IHJxLT5mZW5jZS5z
ZXFubzsKIAkJCSAgIF9fZW50cnktPmZsYWdzID0gZmxhZ3M7CkBAIC03MDYsNyArNzA2LDcgQEAg
REVDTEFSRV9FVkVOVF9DTEFTUyhpOTE1X3JlcXVlc3QsCiAJCQkgICBfX2VudHJ5LT5kZXYgPSBy
cS0+aTkxNS0+ZHJtLnByaW1hcnktPmluZGV4OwogCQkJICAgX19lbnRyeS0+aHdfaWQgPSBycS0+
Z2VtX2NvbnRleHQtPmh3X2lkOwogCQkJICAgX19lbnRyeS0+Y2xhc3MgPSBycS0+ZW5naW5lLT51
YWJpX2NsYXNzOwotCQkJICAgX19lbnRyeS0+aW5zdGFuY2UgPSBycS0+ZW5naW5lLT5pbnN0YW5j
ZTsKKwkJCSAgIF9fZW50cnktPmluc3RhbmNlID0gcnEtPmVuZ2luZS0+dWFiaV9pbnN0YW5jZTsK
IAkJCSAgIF9fZW50cnktPmN0eCA9IHJxLT5mZW5jZS5jb250ZXh0OwogCQkJICAgX19lbnRyeS0+
c2Vxbm8gPSBycS0+ZmVuY2Uuc2Vxbm87CiAJCQkgICApLApAQCAtNzUxLDcgKzc1MSw3IEBAIFRS
QUNFX0VWRU5UKGk5MTVfcmVxdWVzdF9pbiwKIAkJCSAgIF9fZW50cnktPmRldiA9IHJxLT5pOTE1
LT5kcm0ucHJpbWFyeS0+aW5kZXg7CiAJCQkgICBfX2VudHJ5LT5od19pZCA9IHJxLT5nZW1fY29u
dGV4dC0+aHdfaWQ7CiAJCQkgICBfX2VudHJ5LT5jbGFzcyA9IHJxLT5lbmdpbmUtPnVhYmlfY2xh
c3M7Ci0JCQkgICBfX2VudHJ5LT5pbnN0YW5jZSA9IHJxLT5lbmdpbmUtPmluc3RhbmNlOworCQkJ
ICAgX19lbnRyeS0+aW5zdGFuY2UgPSBycS0+ZW5naW5lLT51YWJpX2luc3RhbmNlOwogCQkJICAg
X19lbnRyeS0+Y3R4ID0gcnEtPmZlbmNlLmNvbnRleHQ7CiAJCQkgICBfX2VudHJ5LT5zZXFubyA9
IHJxLT5mZW5jZS5zZXFubzsKIAkJCSAgIF9fZW50cnktPnByaW8gPSBycS0+c2NoZWQuYXR0ci5w
cmlvcml0eTsKQEAgLTc4Miw3ICs3ODIsNyBAQCBUUkFDRV9FVkVOVChpOTE1X3JlcXVlc3Rfb3V0
LAogCQkJICAgX19lbnRyeS0+ZGV2ID0gcnEtPmk5MTUtPmRybS5wcmltYXJ5LT5pbmRleDsKIAkJ
CSAgIF9fZW50cnktPmh3X2lkID0gcnEtPmdlbV9jb250ZXh0LT5od19pZDsKIAkJCSAgIF9fZW50
cnktPmNsYXNzID0gcnEtPmVuZ2luZS0+dWFiaV9jbGFzczsKLQkJCSAgIF9fZW50cnktPmluc3Rh
bmNlID0gcnEtPmVuZ2luZS0+aW5zdGFuY2U7CisJCQkgICBfX2VudHJ5LT5pbnN0YW5jZSA9IHJx
LT5lbmdpbmUtPnVhYmlfaW5zdGFuY2U7CiAJCQkgICBfX2VudHJ5LT5jdHggPSBycS0+ZmVuY2Uu
Y29udGV4dDsKIAkJCSAgIF9fZW50cnktPnNlcW5vID0gcnEtPmZlbmNlLnNlcW5vOwogCQkJICAg
X19lbnRyeS0+Y29tcGxldGVkID0gaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChycSk7CkBAIC04NDcs
NyArODQ3LDcgQEAgVFJBQ0VfRVZFTlQoaTkxNV9yZXF1ZXN0X3dhaXRfYmVnaW4sCiAJCQkgICBf
X2VudHJ5LT5kZXYgPSBycS0+aTkxNS0+ZHJtLnByaW1hcnktPmluZGV4OwogCQkJICAgX19lbnRy
eS0+aHdfaWQgPSBycS0+Z2VtX2NvbnRleHQtPmh3X2lkOwogCQkJICAgX19lbnRyeS0+Y2xhc3Mg
PSBycS0+ZW5naW5lLT51YWJpX2NsYXNzOwotCQkJICAgX19lbnRyeS0+aW5zdGFuY2UgPSBycS0+
ZW5naW5lLT5pbnN0YW5jZTsKKwkJCSAgIF9fZW50cnktPmluc3RhbmNlID0gcnEtPmVuZ2luZS0+
dWFiaV9pbnN0YW5jZTsKIAkJCSAgIF9fZW50cnktPmN0eCA9IHJxLT5mZW5jZS5jb250ZXh0Owog
CQkJICAgX19lbnRyeS0+c2Vxbm8gPSBycS0+ZmVuY2Uuc2Vxbm87CiAJCQkgICBfX2VudHJ5LT5m
bGFncyA9IGZsYWdzOwotLSAKMi4yMy4wLnJjMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlz
dHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4v
bGlzdGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 63D3489FDF
	for <lists+intel-gfx@lfdr.de>; Mon, 12 Aug 2019 15:41:07 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 79A2089CAA;
	Mon, 12 Aug 2019 13:41:05 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5284989CAA
 for <intel-gfx@lists.freedesktop.org>; Mon, 12 Aug 2019 13:41:04 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17969919-1500050 
 for multiple; Mon, 12 Aug 2019 14:39:17 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Mon, 12 Aug 2019 14:39:02 +0100
Message-Id: <20190812133915.18824-5-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0.rc1
In-Reply-To: <20190812133915.18824-1-chris@chris-wilson.co.uk>
References: <20190812133915.18824-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 05/18] drm/i915/gt: Track timeline activeness in
 enter/exit
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

TGlmdCBtb3ZpbmcgdGhlIHRpbWVsaW5lIHRvL2Zyb20gdGhlIGFjdGl2ZV9saXN0IG9uIGVudGVy
L2V4aXQgaW4gb3JkZXIKdG8gc2hvcnRlbiB0aGUgYWN0aXZlIHRyYWNraW5nIHNwYW4gaW4gY29t
cGFyaXNvbiB0byB0aGUgZXhpc3RpbmcKcGluL3VucGluLgoKU2lnbmVkLW9mZi1ieTogQ2hyaXMg
V2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX3BtLmMgICAgICAgIHwgIDEgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfY29udGV4dC5jICAgICAgIHwgIDIgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfZW5naW5lX3BtLmMgICAgIHwgIDIgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfbHJjLmMgICAgICAgICAgIHwgIDQgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
dGltZWxpbmUuYyAgICAgIHwgOTggKysrKysrKy0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfdGltZWxpbmUuaCAgICAgIHwgIDMgKy0KIC4uLi9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfdGltZWxpbmVfdHlwZXMuaCAgICB8IDE4ICsrKysKIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L3NlbGZ0ZXN0X3RpbWVsaW5lLmMgICB8ICAyIC0KIDggZmlsZXMgY2hhbmdlZCwgNjQg
aW5zZXJ0aW9ucygrKSwgNjYgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fcG0uYwppbmRleCAxN2UzNjE4MjQxYzUuLjkyZTUzYzI1NDI0YyAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKQEAgLTM3LDcgKzM3LDYgQEAgc3RhdGljIHZvaWQg
aTkxNV9nZW1fcGFyayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAlmb3JfZWFjaF9l
bmdpbmUoZW5naW5lLCBpOTE1LCBpZCkKIAkJY2FsbF9pZGxlX2JhcnJpZXJzKGVuZ2luZSk7IC8q
IGNsZWFudXAgYWZ0ZXIgd2VkZ2luZyAqLwogCi0JaW50ZWxfdGltZWxpbmVzX3BhcmsoaTkxNSk7
CiAJaTkxNV92bWFfcGFya2VkKGk5MTUpOwogCiAJaTkxNV9nbG9iYWxzX3BhcmsoKTsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYwppbmRleCA3NzgzM2YxNTU4YTkuLjkxMTQ5
NTNiZjkyMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4
dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYwpAQCAtMjgw
LDEwICsyODAsMTIgQEAgaW50IF9faW5pdCBpOTE1X2dsb2JhbF9jb250ZXh0X2luaXQodm9pZCkK
IHZvaWQgaW50ZWxfY29udGV4dF9lbnRlcl9lbmdpbmUoc3RydWN0IGludGVsX2NvbnRleHQgKmNl
KQogewogCWludGVsX2VuZ2luZV9wbV9nZXQoY2UtPmVuZ2luZSk7CisJaW50ZWxfdGltZWxpbmVf
ZW50ZXIoY2UtPnRpbWVsaW5lKTsKIH0KIAogdm9pZCBpbnRlbF9jb250ZXh0X2V4aXRfZW5naW5l
KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKIHsKKwlpbnRlbF90aW1lbGluZV9leGl0KGNlLT50
aW1lbGluZSk7CiAJaW50ZWxfZW5naW5lX3BtX3B1dChjZS0+ZW5naW5lKTsKIH0KIApkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uYwppbmRleCBhZDM3Yzk4MDhjMWYuLmQ2
YTAwYTA0ZWQ2ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5n
aW5lX3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMK
QEAgLTY2LDYgKzY2LDggQEAgc3RhdGljIGJvb2wgc3dpdGNoX3RvX2tlcm5lbF9jb250ZXh0KHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAkJLyogQ29udGV4dCBzd2l0Y2ggZmFpbGVk
LCBob3BlIGZvciB0aGUgYmVzdCEgTWF5YmUgcmVzZXQ/ICovCiAJCXJldHVybiB0cnVlOwogCisJ
aW50ZWxfdGltZWxpbmVfZW50ZXIocnEtPnRpbWVsaW5lKTsKKwogCS8qIENoZWNrIGFnYWluIG9u
IHRoZSBuZXh0IHJldGlyZW1lbnQuICovCiAJZW5naW5lLT53YWtlcmVmX3NlcmlhbCA9IGVuZ2lu
ZS0+c2VyaWFsICsgMTsKIAlpOTE1X3JlcXVlc3RfYWRkX2FjdGl2ZV9iYXJyaWVycyhycSk7CmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCmluZGV4IDk0NWYzYWNjMmU3NS4uYjU2MThlNmMx
MzYxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwpAQCAtMzI1NSw2ICszMjU1LDgg
QEAgc3RhdGljIHZvaWQgdmlydHVhbF9jb250ZXh0X2VudGVyKHN0cnVjdCBpbnRlbF9jb250ZXh0
ICpjZSkKIAogCWZvciAobiA9IDA7IG4gPCB2ZS0+bnVtX3NpYmxpbmdzOyBuKyspCiAJCWludGVs
X2VuZ2luZV9wbV9nZXQodmUtPnNpYmxpbmdzW25dKTsKKworCWludGVsX3RpbWVsaW5lX2VudGVy
KGNlLT50aW1lbGluZSk7CiB9CiAKIHN0YXRpYyB2b2lkIHZpcnR1YWxfY29udGV4dF9leGl0KHN0
cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKQEAgLTMyNjIsNiArMzI2NCw4IEBAIHN0YXRpYyB2b2lk
IHZpcnR1YWxfY29udGV4dF9leGl0KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKIAlzdHJ1Y3Qg
dmlydHVhbF9lbmdpbmUgKnZlID0gY29udGFpbmVyX29mKGNlLCB0eXBlb2YoKnZlKSwgY29udGV4
dCk7CiAJdW5zaWduZWQgaW50IG47CiAKKwlpbnRlbF90aW1lbGluZV9leGl0KGNlLT50aW1lbGlu
ZSk7CisKIAlmb3IgKG4gPSAwOyBuIDwgdmUtPm51bV9zaWJsaW5nczsgbisrKQogCQlpbnRlbF9l
bmdpbmVfcG1fcHV0KHZlLT5zaWJsaW5nc1tuXSk7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF90aW1lbGluZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfdGltZWxpbmUuYwppbmRleCA2ZGFhOWViNTllMTkuLjRhZjBiOTgwMWQ5MSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfdGltZWxpbmUuYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF90aW1lbGluZS5jCkBAIC0yNzgsNjQgKzI3OCwxMSBA
QCB2b2lkIGludGVsX3RpbWVsaW5lc19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQogCXRpbWVsaW5lc19pbml0KCZpOTE1LT5ndCk7CiB9CiAKLXN0YXRpYyB2b2lkIHRpbWVsaW5l
X2FkZF90b19hY3RpdmUoc3RydWN0IGludGVsX3RpbWVsaW5lICp0bCkKLXsKLQlzdHJ1Y3QgaW50
ZWxfZ3RfdGltZWxpbmVzICpndCA9ICZ0bC0+Z3QtPnRpbWVsaW5lczsKLQotCW11dGV4X2xvY2so
Jmd0LT5tdXRleCk7Ci0JbGlzdF9hZGQoJnRsLT5saW5rLCAmZ3QtPmFjdGl2ZV9saXN0KTsKLQlt
dXRleF91bmxvY2soJmd0LT5tdXRleCk7Ci19Ci0KLXN0YXRpYyB2b2lkIHRpbWVsaW5lX3JlbW92
ZV9mcm9tX2FjdGl2ZShzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRsKQotewotCXN0cnVjdCBpbnRl
bF9ndF90aW1lbGluZXMgKmd0ID0gJnRsLT5ndC0+dGltZWxpbmVzOwotCi0JbXV0ZXhfbG9jaygm
Z3QtPm11dGV4KTsKLQlsaXN0X2RlbCgmdGwtPmxpbmspOwotCW11dGV4X3VubG9jaygmZ3QtPm11
dGV4KTsKLX0KLQotc3RhdGljIHZvaWQgdGltZWxpbmVzX3Bhcmsoc3RydWN0IGludGVsX2d0ICpn
dCkKLXsKLQlzdHJ1Y3QgaW50ZWxfZ3RfdGltZWxpbmVzICp0aW1lbGluZXMgPSAmZ3QtPnRpbWVs
aW5lczsKLQlzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRpbWVsaW5lOwotCi0JbXV0ZXhfbG9jaygm
dGltZWxpbmVzLT5tdXRleCk7Ci0JbGlzdF9mb3JfZWFjaF9lbnRyeSh0aW1lbGluZSwgJnRpbWVs
aW5lcy0+YWN0aXZlX2xpc3QsIGxpbmspIHsKLQkJLyoKLQkJICogQWxsIGtub3duIGZlbmNlcyBh
cmUgY29tcGxldGVkIHNvIHdlIGNhbiBzY3JhcAotCQkgKiB0aGUgY3VycmVudCBzeW5jIHBvaW50
IHRyYWNraW5nIGFuZCBzdGFydCBhZnJlc2gsCi0JCSAqIGFueSBhdHRlbXB0IHRvIHdhaXQgdXBv
biBhIHByZXZpb3VzIHN5bmMgcG9pbnQKLQkJICogd2lsbCBiZSBza2lwcGVkIGFzIHRoZSBmZW5j
ZSB3YXMgc2lnbmFsZWQuCi0JCSAqLwotCQlpOTE1X3N5bmNtYXBfZnJlZSgmdGltZWxpbmUtPnN5
bmMpOwotCX0KLQltdXRleF91bmxvY2soJnRpbWVsaW5lcy0+bXV0ZXgpOwotfQotCi0vKioKLSAq
IGludGVsX3RpbWVsaW5lc19wYXJrIC0gY2FsbGVkIHdoZW4gdGhlIGRyaXZlciBpZGxlcwotICog
QGk5MTU6IHRoZSBkcm1faTkxNV9wcml2YXRlIGRldmljZQotICoKLSAqIFdoZW4gdGhlIGRyaXZl
ciBpcyBjb21wbGV0ZWx5IGlkbGUsIHdlIGtub3cgdGhhdCBhbGwgb2Ygb3VyIHN5bmMgcG9pbnRz
Ci0gKiBoYXZlIGJlZW4gc2lnbmFsZWQgYW5kIG91ciB0cmFja2luZyBpcyB0aGVuIGVudGlyZWx5
IHJlZHVuZGFudC4gQW55IHJlcXVlc3QKLSAqIHRvIHdhaXQgdXBvbiBhbiBvbGRlciBzeW5jIHBv
aW50IHdpbGwgYmUgY29tcGxldGVkIGluc3RhbnRseSBhcyB3ZSBrbm93Ci0gKiB0aGUgZmVuY2Ug
aXMgc2lnbmFsZWQgYW5kIHRoZXJlZm9yZSB3ZSB3aWxsIG5vdCBldmVuIGxvb2sgdGhlbSB1cCBp
biB0aGUKLSAqIHN5bmMgcG9pbnQgbWFwLgotICovCi12b2lkIGludGVsX3RpbWVsaW5lc19wYXJr
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQotewotCXRpbWVsaW5lc19wYXJrKCZpOTE1
LT5ndCk7Ci19Ci0KIHZvaWQgaW50ZWxfdGltZWxpbmVfZmluaShzdHJ1Y3QgaW50ZWxfdGltZWxp
bmUgKnRpbWVsaW5lKQogewogCUdFTV9CVUdfT04odGltZWxpbmUtPnBpbl9jb3VudCk7CiAJR0VN
X0JVR19PTighbGlzdF9lbXB0eSgmdGltZWxpbmUtPnJlcXVlc3RzKSk7CiAKLQlpOTE1X3N5bmNt
YXBfZnJlZSgmdGltZWxpbmUtPnN5bmMpOwotCiAJaWYgKHRpbWVsaW5lLT5od3NwX2NhY2hlbGlu
ZSkKIAkJY2FjaGVsaW5lX2ZyZWUodGltZWxpbmUtPmh3c3BfY2FjaGVsaW5lKTsKIAllbHNlCkBA
IC0zNzAsNiArMzE3LDcgQEAgaW50IGludGVsX3RpbWVsaW5lX3BpbihzdHJ1Y3QgaW50ZWxfdGlt
ZWxpbmUgKnRsKQogCWlmICh0bC0+cGluX2NvdW50KyspCiAJCXJldHVybiAwOwogCUdFTV9CVUdf
T04oIXRsLT5waW5fY291bnQpOworCUdFTV9CVUdfT04odGwtPmFjdGl2ZV9jb3VudCk7CiAKIAll
cnIgPSBpOTE1X3ZtYV9waW4odGwtPmh3c3BfZ2d0dCwgMCwgMCwgUElOX0dMT0JBTCB8IFBJTl9I
SUdIKTsKIAlpZiAoZXJyKQpAQCAtMzgwLDcgKzMyOCw2IEBAIGludCBpbnRlbF90aW1lbGluZV9w
aW4oc3RydWN0IGludGVsX3RpbWVsaW5lICp0bCkKIAkJb2Zmc2V0X2luX3BhZ2UodGwtPmh3c3Bf
b2Zmc2V0KTsKIAogCWNhY2hlbGluZV9hY3F1aXJlKHRsLT5od3NwX2NhY2hlbGluZSk7Ci0JdGlt
ZWxpbmVfYWRkX3RvX2FjdGl2ZSh0bCk7CiAKIAlyZXR1cm4gMDsKIApAQCAtMzg5LDYgKzMzNiw0
MCBAQCBpbnQgaW50ZWxfdGltZWxpbmVfcGluKHN0cnVjdCBpbnRlbF90aW1lbGluZSAqdGwpCiAJ
cmV0dXJuIGVycjsKIH0KIAordm9pZCBpbnRlbF90aW1lbGluZV9lbnRlcihzdHJ1Y3QgaW50ZWxf
dGltZWxpbmUgKnRsKQoreworCXN0cnVjdCBpbnRlbF9ndF90aW1lbGluZXMgKnRpbWVsaW5lcyA9
ICZ0bC0+Z3QtPnRpbWVsaW5lczsKKworCUdFTV9CVUdfT04oIXRsLT5waW5fY291bnQpOworCWlm
ICh0bC0+YWN0aXZlX2NvdW50KyspCisJCXJldHVybjsKKwlHRU1fQlVHX09OKCF0bC0+YWN0aXZl
X2NvdW50KTsgLyogb3ZlcmZsb3c/ICovCisKKwltdXRleF9sb2NrKCZ0aW1lbGluZXMtPm11dGV4
KTsKKwlsaXN0X2FkZCgmdGwtPmxpbmssICZ0aW1lbGluZXMtPmFjdGl2ZV9saXN0KTsKKwltdXRl
eF91bmxvY2soJnRpbWVsaW5lcy0+bXV0ZXgpOworfQorCit2b2lkIGludGVsX3RpbWVsaW5lX2V4
aXQoc3RydWN0IGludGVsX3RpbWVsaW5lICp0bCkKK3sKKwlzdHJ1Y3QgaW50ZWxfZ3RfdGltZWxp
bmVzICp0aW1lbGluZXMgPSAmdGwtPmd0LT50aW1lbGluZXM7CisKKwlHRU1fQlVHX09OKCF0bC0+
YWN0aXZlX2NvdW50KTsKKwlpZiAoLS10bC0+YWN0aXZlX2NvdW50KQorCQlyZXR1cm47CisKKwlt
dXRleF9sb2NrKCZ0aW1lbGluZXMtPm11dGV4KTsKKwlsaXN0X2RlbCgmdGwtPmxpbmspOworCW11
dGV4X3VubG9jaygmdGltZWxpbmVzLT5tdXRleCk7CisKKwkvKgorCSAqIFNpbmNlIHRoaXMgdGlt
ZWxpbmUgaXMgaWRsZSwgYWxsIGJhcmllcnMgdXBvbiB3aGljaCB3ZSB3ZXJlIHdhaXRpbmcKKwkg
KiBtdXN0IGFsc28gYmUgY29tcGxldGUgYW5kIHNvIHdlIGNhbiBkaXNjYXJkIHRoZSBsYXN0IHVz
ZWQgYmFycmllcnMKKwkgKiB3aXRob3V0IGxvc3Mgb2YgaW5mb3JtYXRpb24uCisJICovCisJaTkx
NV9zeW5jbWFwX2ZyZWUoJnRsLT5zeW5jKTsKK30KKwogc3RhdGljIHUzMiB0aW1lbGluZV9hZHZh
bmNlKHN0cnVjdCBpbnRlbF90aW1lbGluZSAqdGwpCiB7CiAJR0VNX0JVR19PTighdGwtPnBpbl9j
b3VudCk7CkBAIC01NDYsMTYgKzUyNyw5IEBAIHZvaWQgaW50ZWxfdGltZWxpbmVfdW5waW4oc3Ry
dWN0IGludGVsX3RpbWVsaW5lICp0bCkKIAlpZiAoLS10bC0+cGluX2NvdW50KQogCQlyZXR1cm47
CiAKLQl0aW1lbGluZV9yZW1vdmVfZnJvbV9hY3RpdmUodGwpOworCUdFTV9CVUdfT04odGwtPmFj
dGl2ZV9jb3VudCk7CiAJY2FjaGVsaW5lX3JlbGVhc2UodGwtPmh3c3BfY2FjaGVsaW5lKTsKIAot
CS8qCi0JICogU2luY2UgdGhpcyB0aW1lbGluZSBpcyBpZGxlLCBhbGwgYmFyaWVycyB1cG9uIHdo
aWNoIHdlIHdlcmUgd2FpdGluZwotCSAqIG11c3QgYWxzbyBiZSBjb21wbGV0ZSBhbmQgc28gd2Ug
Y2FuIGRpc2NhcmQgdGhlIGxhc3QgdXNlZCBiYXJyaWVycwotCSAqIHdpdGhvdXQgbG9zcyBvZiBp
bmZvcm1hdGlvbi4KLQkgKi8KLQlpOTE1X3N5bmNtYXBfZnJlZSgmdGwtPnN5bmMpOwotCiAJX19p
OTE1X3ZtYV91bnBpbih0bC0+aHdzcF9nZ3R0KTsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfdGltZWxpbmUuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX3RpbWVsaW5lLmgKaW5kZXggZTA4Y2ViZjY0ODMzLi5mNTgzYWYxYmExOGQgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3RpbWVsaW5lLmgKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfdGltZWxpbmUuaApAQCAtNzcsOSArNzcsMTEgQEAg
c3RhdGljIGlubGluZSBib29sIGludGVsX3RpbWVsaW5lX3N5bmNfaXNfbGF0ZXIoc3RydWN0IGlu
dGVsX3RpbWVsaW5lICp0bCwKIH0KIAogaW50IGludGVsX3RpbWVsaW5lX3BpbihzdHJ1Y3QgaW50
ZWxfdGltZWxpbmUgKnRsKTsKK3ZvaWQgaW50ZWxfdGltZWxpbmVfZW50ZXIoc3RydWN0IGludGVs
X3RpbWVsaW5lICp0bCk7CiBpbnQgaW50ZWxfdGltZWxpbmVfZ2V0X3NlcW5vKHN0cnVjdCBpbnRl
bF90aW1lbGluZSAqdGwsCiAJCQkgICAgIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAogCQkJICAg
ICB1MzIgKnNlcW5vKTsKK3ZvaWQgaW50ZWxfdGltZWxpbmVfZXhpdChzdHJ1Y3QgaW50ZWxfdGlt
ZWxpbmUgKnRsKTsKIHZvaWQgaW50ZWxfdGltZWxpbmVfdW5waW4oc3RydWN0IGludGVsX3RpbWVs
aW5lICp0bCk7CiAKIGludCBpbnRlbF90aW1lbGluZV9yZWFkX2h3c3Aoc3RydWN0IGk5MTVfcmVx
dWVzdCAqZnJvbSwKQEAgLTg3LDcgKzg5LDYgQEAgaW50IGludGVsX3RpbWVsaW5lX3JlYWRfaHdz
cChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpmcm9tLAogCQkJICAgICB1MzIgKmh3c3Bfb2Zmc2V0KTsK
IAogdm9pZCBpbnRlbF90aW1lbGluZXNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSk7Ci12b2lkIGludGVsX3RpbWVsaW5lc19wYXJrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KTsKIHZvaWQgaW50ZWxfdGltZWxpbmVzX2Zpbmkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpOwogCiAjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX3RpbWVsaW5lX3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF90aW1l
bGluZV90eXBlcy5oCmluZGV4IDlhNzFhZWE3YTMzOC4uYjFhOWYwYzU0YmYwIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF90aW1lbGluZV90eXBlcy5oCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3RpbWVsaW5lX3R5cGVzLmgKQEAgLTI1LDcgKzI1
LDI1IEBAIHN0cnVjdCBpbnRlbF90aW1lbGluZSB7CiAKIAlzdHJ1Y3QgbXV0ZXggbXV0ZXg7IC8q
IHByb3RlY3RzIHRoZSBmbG93IG9mIHJlcXVlc3RzICovCiAKKwkvKgorCSAqIHBpbl9jb3VudCBh
bmQgYWN0aXZlX2NvdW50IHRyYWNrIGVzc2VudGlhbGx5IHRoZSBzYW1lIHRoaW5nOgorCSAqIEhv
dyBtYW55IHJlcXVlc3RzIGFyZSBpbiBmbGlnaHQgb3IgbWF5IGJlIHVuZGVyIGNvbnN0cnVjdGlv
bi4KKwkgKgorCSAqIFdlIG5lZWQgdHdvIGRpc3RpbmN0IGNvdW50ZXJzIHNvIHRoYXQgd2UgY2Fu
IGFzc2lnbiBkaWZmZXJlbnQKKwkgKiBsaWZldGltZXMgdG8gdGhlIGV2ZW50cyBmb3IgZGlmZmVy
ZW50IHVzZS1jYXNlcy4gRm9yIGV4YW1wbGUsCisJICogd2Ugd2FudCB0byBwZXJtYW5lbnRseSBr
ZWVwIHRoZSB0aW1lbGluZSBwaW5uZWQgZm9yIHRoZSBrZXJuZWwKKwkgKiBjb250ZXh0IHNvIHRo
YXQgd2UgY2FuIGlzc3VlIHJlcXVlc3RzIGF0IGFueSB0aW1lIHdpdGhvdXQgaGF2aW5nCisJICog
dG8gYWNxdWlyZSBzcGFjZSBpbiB0aGUgR0dUVC4gSG93ZXZlciwgd2Ugd2FudCB0byBrZWVwIHRy
YWNraW5nCisJICogdGhlIGFjdGl2aXR5ICh0byBiZSBhYmxlIHRvIGRldGVjdCB3aGVuIHdlIGJl
Y29tZSBpZGxlKSBhbG9uZyB0aGF0CisJICogcGVybWFuZW50bHkgcGlubmVkIHRpbWVsaW5lIGFu
ZCBzbyBlbmQgdXAgcmVxdWlyaW5nIHR3byBjb3VudGVycy4KKwkgKgorCSAqIE5vdGUgdGhhdCB0
aGUgYWN0aXZlX2NvdW50IGlzIHByb3RlY3RlZCBieSB0aGUgaW50ZWxfdGltZWxpbmUubXV0ZXgs
CisJICogYnV0IHRoZSBwaW5fY291bnQgaXMgcHJvdGVjdGVkIGJ5IGEgY29tYmluYXRpb24gb2Yg
c2VyaWFsaXNhdGlvbgorCSAqIGZyb20gdGhlIGludGVsX2NvbnRleHQgY2FsbGVyIHBsdXMgaW50
ZXJuYWwgYXRvbWljaXR5LgorCSAqLwogCXVuc2lnbmVkIGludCBwaW5fY291bnQ7CisJdW5zaWdu
ZWQgaW50IGFjdGl2ZV9jb3VudDsKKwogCWNvbnN0IHUzMiAqaHdzcF9zZXFubzsKIAlzdHJ1Y3Qg
aTkxNV92bWEgKmh3c3BfZ2d0dDsKIAl1MzIgaHdzcF9vZmZzZXQ7CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF90aW1lbGluZS5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Qvc2VsZnRlc3RfdGltZWxpbmUuYwppbmRleCBmMGE4NDAwMzAzODIuLmQ1NDExMzY5
Nzc0NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfdGltZWxp
bmUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF90aW1lbGluZS5jCkBA
IC04MTYsOCArODE2LDYgQEAgc3RhdGljIGludCBsaXZlX2h3c3BfcmVjeWNsZSh2b2lkICphcmcp
CiAKIAkJCWlmIChlcnIpCiAJCQkJZ290byBvdXQ7Ci0KLQkJCWludGVsX3RpbWVsaW5lc19wYXJr
KGk5MTUpOyAvKiBFbmNvdXJhZ2UgcmVjeWNsaW5nISAqLwogCQl9IHdoaWxlICghX19pZ3RfdGlt
ZW91dChlbmRfdGltZSwgTlVMTCkpOwogCX0KIAotLSAKMi4yMy4wLnJjMQoKX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlz
dApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0
b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id D5636D627E
	for <lists+intel-gfx@lfdr.de>; Mon, 14 Oct 2019 14:26:04 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1AD416E1ED;
	Mon, 14 Oct 2019 12:26:03 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga07.intel.com (mga07.intel.com [134.134.136.100])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6F8286E1ED
 for <intel-gfx@lists.freedesktop.org>; Mon, 14 Oct 2019 12:26:02 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga007.jf.intel.com ([10.7.209.58])
 by orsmga105.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 14 Oct 2019 05:26:01 -0700
X-IronPort-AV: E=Sophos;i="5.67,295,1566889200"; d="scan'208";a="185478293"
Received: from dwiesing-mobl.ger.corp.intel.com (HELO [10.252.31.172])
 ([10.252.31.172])
 by orsmga007-auth.jf.intel.com with ESMTP/TLS/AES256-SHA;
 14 Oct 2019 05:26:00 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20191014090757.32111-1-chris@chris-wilson.co.uk>
 <20191014090757.32111-11-chris@chris-wilson.co.uk>
 <8b030734-330f-49e1-cbd0-d7d44c965983@linux.intel.com>
 <157105478333.18859.11636359770694964440@skylake-alporthouse-com>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <9d2f73a9-745d-7c59-770e-c94fc40e7a1c@linux.intel.com>
Date: Mon, 14 Oct 2019 13:25:58 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <157105478333.18859.11636359770694964440@skylake-alporthouse-com>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH 11/15] drm/i915/execlists: Cancel banned
 contexts on schedule-out
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDE0LzEwLzIwMTkgMTM6MDYsIENocmlzIFdpbHNvbiB3cm90ZToKPiBRdW90aW5nIFR2cnRr
byBVcnN1bGluICgyMDE5LTEwLTE0IDEzOjAwOjAxKQo+Pgo+PiBPbiAxNC8xMC8yMDE5IDEwOjA3
LCBDaHJpcyBXaWxzb24gd3JvdGU6Cj4+PiBPbiBzY2hlZHVsZS1vdXQgKENTIGNvbXBsZXRpb24p
IG9mIGEgYmFubmVkIGNvbnRleHQsIHNjcnViIHRoZSBjb250ZXh0Cj4+PiBpbWFnZSBzbyB0aGF0
IHdlIGRvIG5vdCByZXBsYXkgdGhlIGFjdGl2ZSBwYXlsb2FkLiBUaGUgaW50ZW50IGlzIHRoYXQg
d2UKPj4+IHNraXAgYmFubmVkIHBheWxvYWRzIG9uIHJlcXVlc3Qgc3VibWlzc2lvbiBzbyB0aGF0
IHRoZSB0aW1lbGluZQo+Pj4gYWR2YW5jZW1lbnQgY29udGludWVzIG9uIGluIHRoZSBiYWNrZ3Jv
dW5kLiBIb3dldmVyLCBpZiB3ZSBhcmUgcmV0dXJuaW5nCj4+PiB0byBhIHByZWVtcHRlZCByZXF1
ZXN0LCBpOTE1X3JlcXVlc3Rfc2tpcCgpIGlzIGluZWZmZWN0aXZlIGFuZCBpbnN0ZWFkIHdlCj4+
PiBuZWVkIHRvIHBhdGNoIHVwIHRoZSBjb250ZXh0IGltYWdlIHNvIHRoYXQgaXQgY29udGludWVz
IGZyb20gdGhlIHN0YXJ0Cj4+PiBvZiB0aGUgbmV4dCByZXF1ZXN0Lgo+Pj4KPj4+IHYyOiBGaXh1
cCBjYW5jZWxsYXRpb24gc28gdGhhdCB3ZSBvbmx5IHNjcnViIHRoZSBwYXlsb2FkIG9mIHRoZSBh
Y3RpdmUKPj4+IHJlcXVlc3QgYW5kIGRvIG5vdCBzaG9ydC1jaXJjdWl0IHRoZSBicmVhZGNydW1i
cyAod2hpY2ggbWlnaHQgY2F1c2UKPj4+IG90aGVyIGNvbnRleHRzIHRvIGV4ZWN1dGUgb3V0IG9m
IG9yZGVyKS4KPj4+Cj4+PiBTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlz
LXdpbHNvbi5jby51az4KPj4+IENjOiBUdnJ0a28gVXJzdWxpbiA8dHZydGtvLnVyc3VsaW5AaW50
ZWwuY29tPgo+Pj4gLS0tCj4+PiAgICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMu
YyAgICB8IDEyOSArKysrKysrKy0tLS0KPj4+ICAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3Nl
bGZ0ZXN0X2xyYy5jIHwgMjczICsrKysrKysrKysrKysrKysrKysrKysrKysKPj4+ICAgIDIgZmls
ZXMgY2hhbmdlZCwgMzYxIGluc2VydGlvbnMoKyksIDQxIGRlbGV0aW9ucygtKQo+Pj4KPj4+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCj4+PiBpbmRleCBlMTZlZGU3NTQxMmIuLmI3NmIz
NTE5NDExNCAxMDA2NDQKPj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xy
Yy5jCj4+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwo+Pj4gQEAg
LTIzNCw2ICsyMzQsOSBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfaW5pdF9yZWdfc3RhdGUodTMy
ICpyZWdfc3RhdGUsCj4+PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25z
dCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCj4+PiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfcmluZyAqcmluZywKPj4+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgY2xvc2UpOwo+Pj4gK3N0YXRpYyB2
b2lkCj4+PiArX19leGVjbGlzdHNfdXBkYXRlX3JlZ19zdGF0ZShjb25zdCBzdHJ1Y3QgaW50ZWxf
Y29udGV4dCAqY2UsCj4+PiArICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUpOwo+Pj4gICAgCj4+PiAgICBzdGF0aWMgdm9pZCBjYW5j
ZWxfdGltZXIoc3RydWN0IHRpbWVyX2xpc3QgKnQpCj4+PiAgICB7Cj4+PiBAQCAtMjcwLDYgKzI3
MywzMSBAQCBzdGF0aWMgdm9pZCBtYXJrX2VpbyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKPj4+
ICAgICAgICBpOTE1X3JlcXVlc3RfbWFya19jb21wbGV0ZShycSk7Cj4+PiAgICB9Cj4+PiAgICAK
Pj4+ICtzdGF0aWMgc3RydWN0IGk5MTVfcmVxdWVzdCAqYWN0aXZlX3JlcXVlc3Qoc3RydWN0IGk5
MTVfcmVxdWVzdCAqcnEpCj4+PiArewo+Pj4gKyAgICAgY29uc3Qgc3RydWN0IGludGVsX2NvbnRl
eHQgKiBjb25zdCBjZSA9IHJxLT5od19jb250ZXh0Owo+Pj4gKyAgICAgc3RydWN0IGk5MTVfcmVx
dWVzdCAqYWN0aXZlID0gTlVMTDsKPj4+ICsgICAgIHN0cnVjdCBsaXN0X2hlYWQgKmxpc3Q7Cj4+
PiArCj4+PiArICAgICBpZiAoIWk5MTVfcmVxdWVzdF9pc19hY3RpdmUocnEpKSAvKiB1bndvdW5k
LCBidXQgaW5jb21wbGV0ZSEgKi8KPj4+ICsgICAgICAgICAgICAgcmV0dXJuIHJxOwo+Pj4gKwo+
Pj4gKyAgICAgcmN1X3JlYWRfbG9jaygpOwo+Pj4gKyAgICAgbGlzdCA9ICZyY3VfZGVyZWZlcmVu
Y2UocnEtPnRpbWVsaW5lKS0+cmVxdWVzdHM7Cj4+PiArICAgICBsaXN0X2Zvcl9lYWNoX2VudHJ5
X2Zyb21fcmV2ZXJzZShycSwgbGlzdCwgbGluaykgewo+Pj4gKyAgICAgICAgICAgICBpZiAoaTkx
NV9yZXF1ZXN0X2NvbXBsZXRlZChycSkpCj4+PiArICAgICAgICAgICAgICAgICAgICAgYnJlYWs7
Cj4+PiArCj4+PiArICAgICAgICAgICAgIGlmIChycS0+aHdfY29udGV4dCAhPSBjZSkKPj4+ICsg
ICAgICAgICAgICAgICAgICAgICBicmVhazsKPj4+ICsKPj4+ICsgICAgICAgICAgICAgYWN0aXZl
ID0gcnE7Cj4+PiArICAgICB9Cj4+PiArICAgICByY3VfcmVhZF91bmxvY2soKTsKPj4+ICsKPj4+
ICsgICAgIHJldHVybiBhY3RpdmU7Cj4+PiArfQo+Pj4gKwo+Pj4gICAgc3RhdGljIGlubGluZSB1
MzIgaW50ZWxfaHdzX3ByZWVtcHRfYWRkcmVzcyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpCj4+PiAgICB7Cj4+PiAgICAgICAgcmV0dXJuIChpOTE1X2dndHRfb2Zmc2V0KGVuZ2luZS0+
c3RhdHVzX3BhZ2Uudm1hKSArCj4+PiBAQCAtOTkxLDYgKzEwMTksNTYgQEAgc3RhdGljIHZvaWQg
a2lja19zaWJsaW5ncyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgc3RydWN0IGludGVsX2NvbnRl
eHQgKmNlKQo+Pj4gICAgICAgICAgICAgICAgdGFza2xldF9zY2hlZHVsZSgmdmUtPmJhc2UuZXhl
Y2xpc3RzLnRhc2tsZXQpOwo+Pj4gICAgfQo+Pj4gICAgCj4+PiArc3RhdGljIHZvaWQgcmVzdG9y
ZV9kZWZhdWx0X3N0YXRlKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKPj4+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+Pj4g
K3sKPj4+ICsgICAgIHUzMiAqcmVncyA9IGNlLT5scmNfcmVnX3N0YXRlOwo+Pj4gKwo+Pj4gKyAg
ICAgaWYgKGVuZ2luZS0+cGlubmVkX2RlZmF1bHRfc3RhdGUpCj4+PiArICAgICAgICAgICAgIG1l
bWNweShyZWdzLCAvKiBza2lwIHJlc3RvcmluZyB0aGUgdmFuaWxsYSBQUEhXU1AgKi8KPj4+ICsg
ICAgICAgICAgICAgICAgICAgIGVuZ2luZS0+cGlubmVkX2RlZmF1bHRfc3RhdGUgKyBMUkNfU1RB
VEVfUE4gKiBQQUdFX1NJWkUsCj4+PiArICAgICAgICAgICAgICAgICAgICBlbmdpbmUtPmNvbnRl
eHRfc2l6ZSAtIFBBR0VfU0laRSk7Cj4+PiArCj4+PiArICAgICBleGVjbGlzdHNfaW5pdF9yZWdf
c3RhdGUocmVncywgY2UsIGVuZ2luZSwgY2UtPnJpbmcsIGZhbHNlKTsKPj4+ICt9Cj4+PiArCj4+
PiArc3RhdGljIHZvaWQgY2FuY2VsX2FjdGl2ZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKPj4+
ICsgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkK
Pj4+ICt7Cj4+PiArICAgICBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqIGNvbnN0IGNlID0gcnEtPmh3
X2NvbnRleHQ7Cj4+PiArCj4+PiArICAgICAvKgo+Pj4gKyAgICAgICogVGhlIGV4ZWN1dGluZyBj
b250ZXh0IGhhcyBiZWVuIGNhbmNlbGxlZC4gRml4dXAgdGhlIGNvbnRleHQgc28gdGhhdAo+Pj4g
KyAgICAgICogaXQgd2lsbCBiZSBtYXJrZWQgYXMgaW5jb21wbGV0ZSBbLUVJT10gdXBvbiByZXN1
Ym1pc3Npb24gYW5kIG5vdAoKKHJlYWQgYmVsb3cgZmlyc3QpCgouLi4gYW5kIG5vdCBtaXNsZWFk
aW5nbHkgc2F5ICJGaXh1cCB0aGUgY29udGV4dCBzbyB0aGF0IGl0IHdpbGwgYmUgCm1hcmtlZCBh
cyBpbmNvbXBsZXRlIiBiZWNhdXNlIHRoZXJlIGlzIG5vdGhpbmcgaW4gdGhpcyBmdW5jdGlvbiB3
aGljaCAKZG9lcyB0aGF0LiBJdCBtb3N0bHkgaGFwcGVucyBieSB0aGUgdmlydHVhbCBvZiBjb250
ZXh0IGFscmVhZHkgYmVpbmcgCm1hcmtlZCBhcyBiYW5uZWQgc29tZXdoZXJlIGVsc2UuIFRoaXMg
Y29tbWVudCBzaG91bGQganVzdCBleHBsYWluIHRoZSAKZGVjaXNpb24gdG8gcmV3aW5kIHRoZSBy
aW5nLT5oZWFkIGZvciBtb3JlIGRldGVybWluaXNtLiBJdCBjYW4gc3RpbGwgCm1lbnRpb24gY2Fu
Y2VsaW5nIG9mIHVzZXIgcGF5bG9hZCBhbmQgLUVJTy4gSnVzdCBuZWVkcyB0byBiZSBjbGVhciBv
ZiAKdGhlIHNpbmdsZSBleHRyYSB0aGluZyBhY2hpZXZlZCBoZXJlIGJ5IHRoZSBoZWFkIHJld2lu
ZCBhbmQgY29udGV4dCBlZGl0LgoKPj4+ICsgICAgICAqIGV4ZWN1dGUgYW55IHVzZXIgcGF5bG9h
ZHMuIFdlIHByZXNlcnZlIHRoZSBicmVhZGNydW1icyBhbmQKPj4+ICsgICAgICAqIHNlbWFwaG9y
ZXMgb2YgdGhlIGluY29tcGxldGUgcmVxdWVzdHMgc28gdGhhdCBpbnRlci10aW1lbGluZQo+Pj4g
KyAgICAgICogZGVwZW5kZW5jaWVzIChpLmUgb3RoZXIgdGltZWxpbmVzKSByZW1haW4gY29ycmVj
dGx5IG9yZGVyZWQuCj4+PiArICAgICAgKgo+Pj4gKyAgICAgICogU2VlIF9faTkxNV9yZXF1ZXN0
X3N1Ym1pdCgpIGZvciBhcHBseWluZyAtRUlPIGFuZCByZW1vdmluZyB0aGUKPj4+ICsgICAgICAq
IHBheWxvYWQgb24gcmVzdWJtaXNzaW9uLgo+Pj4gKyAgICAgICovCj4+PiArICAgICBHRU1fVFJB
Q0UoIiVzKCVzKTogeyBycT0lbGx4OiVsbGQgfVxuIiwKPj4+ICsgICAgICAgICAgICAgICBfX2Z1
bmNfXywgZW5naW5lLT5uYW1lLCBycS0+ZmVuY2UuY29udGV4dCwgcnEtPmZlbmNlLnNlcW5vKTsK
Pj4+ICsgICAgIF9fY29udGV4dF9waW5fYWNxdWlyZShjZSk7Cj4+PiArCj4+PiArICAgICAvKiBP
biByZXN1Ym1pc3Npb24gb2YgdGhlIGFjdGl2ZSByZXF1ZXN0LCBwYXlsb2FkIHdpbGwgYmUgc2Ny
dWJiZWQgKi8KPj4+ICsgICAgIHJxID0gYWN0aXZlX3JlcXVlc3QocnEpOwo+Pj4gKyAgICAgaWYg
KHJxKQo+Pj4gKyAgICAgICAgICAgICBjZS0+cmluZy0+aGVhZCA9IGludGVsX3Jpbmdfd3JhcChj
ZS0+cmluZywgcnEtPmhlYWQpOwo+Pgo+PiBXaXRob3V0IHRoaXMgY2hhbmdlLCB3aGVyZSB3b3Vs
ZCB0aGUgaGVhZCBiZSBwb2ludGluZyBhZnRlcgo+PiBzY2hlZHVsZV9vdXQ/IFNvbWV3aGVyZSBp
biB0aGUgbWlkZGxlIG9mIHRoZSBhY3RpdmUgcmVxdWVzdD8gQW5kIHdpdGgKPj4gdGhpcyBjaGFu
Z2UgaXQgaXMgcmV3b3VuZCB0byB0aGUgc3RhcnQgb2YgaXQ/Cj4gCj4gUklOR19IRUFEIGNvdWxk
IGJlIGFueXdoZXJlIGJldHdlZW4gcnEtPmhlYWQgYW5kIHJxLT50YWlsLiBXZSBjb3VsZCBqdXN0
Cj4gbGVhdmUgaXQgYmUsIGJ1dCBpdCB3b3VsZCBiZSBiZXR0ZXIgaWYgd2UgcmVzZXQgaXQgaWYg
aXQgd2FzIHBhc3QKPiBycS0+cG9zdGZpeCAoYXMgd2UgcmV3cml0ZSB0aG9zZSBpbnN0cnVjdGlv
bnMpLiBJdCdzIGp1c3Qgc2ltcGxlciBpZiB3ZQo+IHJlc2V0IGl0IGJhY2sgdG8gdGhlIHN0YXJ0
LCBhbmQgc2NydWIgdGhlIHJlcXVlc3QuCgpPa2F5LCBub3cgSSBmb2xsb3cuIEkgc3VnZ2VzdCBn
b2luZyBiYWNrIHVwIF5eXiBhbmQgbWFraW5nIHRoZSBjb21tZW50IApjbGVhci4uLgoKUmVnYXJk
cywKClR2cnRrbwpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
XwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcK
aHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

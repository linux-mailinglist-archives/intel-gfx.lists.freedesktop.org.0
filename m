Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 6C47E26310
	for <lists+intel-gfx@lfdr.de>; Wed, 22 May 2019 13:37:38 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1D50E899D4;
	Wed, 22 May 2019 11:37:31 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2221D899B3;
 Wed, 22 May 2019 11:37:28 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16639709-1500050 
 for multiple; Wed, 22 May 2019 12:37:14 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 22 May 2019 12:37:06 +0100
Message-Id: <20190522113712.23512-6-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190522113712.23512-1-chris@chris-wilson.co.uk>
References: <20190522113712.23512-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t 06/12] i915/gem_ctx_switch: Exercise queues
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: igt-dev@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVldWVzIGFyZSBhIGZvcm0gb2YgY29udGV4dHMgdGhhdCBzaGFyZSB2bSBhbmQgZW5mb3JlIGEg
c2luZ2xlIHRpbWVsaW5lCmFjcm9zcyBhbGwgZW5naW5lcy4gVGVzdCBzd2l0Y2hpbmcgYmV0d2Vl
biB0aGVtLCBqdXN0IGxpa2Ugb3JkaW5hcnkKY29udGV4dHMuCgpTaWduZWQtb2ZmLWJ5OiBDaHJp
cyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KUmV2aWV3ZWQtYnk6IFR2cnRrbyBV
cnN1bGluIDx0dnJ0a28udXJzdWxpbkBpbnRlbC5jb20+Ci0tLQogdGVzdHMvaTkxNS9nZW1fY3R4
X3N3aXRjaC5jIHwgNzUgKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLQogMSBm
aWxlIGNoYW5nZWQsIDU1IGluc2VydGlvbnMoKyksIDIwIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdp
dCBhL3Rlc3RzL2k5MTUvZ2VtX2N0eF9zd2l0Y2guYyBiL3Rlc3RzL2k5MTUvZ2VtX2N0eF9zd2l0
Y2guYwppbmRleCA4N2UxM2I5MTUuLjY0NzkxMWQ0YyAxMDA2NDQKLS0tIGEvdGVzdHMvaTkxNS9n
ZW1fY3R4X3N3aXRjaC5jCisrKyBiL3Rlc3RzL2k5MTUvZ2VtX2N0eF9zd2l0Y2guYwpAQCAtNDQs
NyArNDQsOCBAQAogI2RlZmluZSBMT0NBTF9JOTE1X0VYRUNfTk9fUkVMT0MgKDE8PDExKQogI2Rl
ZmluZSBMT0NBTF9JOTE1X0VYRUNfSEFORExFX0xVVCAoMTw8MTIpCiAKLSNkZWZpbmUgSU5URVJS
VVBUSUJMRSAxCisjZGVmaW5lIElOVEVSUlVQVElCTEUgMHgxCisjZGVmaW5lIFFVRVVFIDB4Mgog
CiBzdGF0aWMgZG91YmxlIGVsYXBzZWQoY29uc3Qgc3RydWN0IHRpbWVzcGVjICpzdGFydCwgY29u
c3Qgc3RydWN0IHRpbWVzcGVjICplbmQpCiB7CkBAIC0xMjYsOCArMTI3LDEyIEBAIHN0YXRpYyB2
b2lkIHNpbmdsZShpbnQgZmQsIHVpbnQzMl90IGhhbmRsZSwKIAogCWdlbV9yZXF1aXJlX3Jpbmco
ZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncyk7CiAKLQlmb3IgKG4gPSAwOyBuIDwgNjQ7IG4rKykK
LQkJY29udGV4dHNbbl0gPSBnZW1fY29udGV4dF9jcmVhdGUoZmQpOworCWZvciAobiA9IDA7IG4g
PCA2NDsgbisrKSB7CisJCWlmIChmbGFncyAmIFFVRVVFKQorCQkJY29udGV4dHNbbl0gPSBnZW1f
cXVldWVfY3JlYXRlKGZkKTsKKwkJZWxzZQorCQkJY29udGV4dHNbbl0gPSBnZW1fY29udGV4dF9j
cmVhdGUoZmQpOworCX0KIAogCW1lbXNldCgmb2JqLCAwLCBzaXplb2Yob2JqKSk7CiAJb2JqLmhh
bmRsZSA9IGhhbmRsZTsKQEAgLTIzMiw4ICsyMzcsMTIgQEAgc3RhdGljIHZvaWQgYWxsKGludCBm
ZCwgdWludDMyX3QgaGFuZGxlLCB1bnNpZ25lZCBmbGFncywgaW50IHRpbWVvdXQpCiAJfQogCWln
dF9yZXF1aXJlKG5lbmdpbmUpOwogCi0JZm9yIChuID0gMDsgbiA8IEFSUkFZX1NJWkUoY29udGV4
dHMpOyBuKyspCi0JCWNvbnRleHRzW25dID0gZ2VtX2NvbnRleHRfY3JlYXRlKGZkKTsKKwlmb3Ig
KG4gPSAwOyBuIDwgQVJSQVlfU0laRShjb250ZXh0cyk7IG4rKykgeworCQlpZiAoZmxhZ3MgJiBR
VUVVRSkKKwkJCWNvbnRleHRzW25dID0gZ2VtX3F1ZXVlX2NyZWF0ZShmZCk7CisJCWVsc2UKKwkJ
CWNvbnRleHRzW25dID0gZ2VtX2NvbnRleHRfY3JlYXRlKGZkKTsKKwl9CiAKIAltZW1zZXQob2Jq
LCAwLCBzaXplb2Yob2JqKSk7CiAJb2JqWzFdLmhhbmRsZSA9IGhhbmRsZTsKQEAgLTI5OCw2ICsz
MDcsMTcgQEAgaWd0X21haW4KIHsKIAljb25zdCBpbnQgbmNwdXMgPSBzeXNjb25mKF9TQ19OUFJP
Q0VTU09SU19PTkxOKTsKIAljb25zdCBzdHJ1Y3QgaW50ZWxfZXhlY3V0aW9uX2VuZ2luZSAqZTsK
KwlzdGF0aWMgY29uc3Qgc3RydWN0IHsKKwkJY29uc3QgY2hhciAqbmFtZTsKKwkJdW5zaWduZWQg
aW50IGZsYWdzOworCQlib29sICgqcmVxdWlyZSkoaW50IGZkKTsKKwl9IHBoYXNlc1tdID0gewor
CQl7ICIiLCAwLCBOVUxMIH0sCisJCXsgIi1pbnRlcnJ1cHRpYmxlIiwgSU5URVJSVVBUSUJMRSwg
TlVMTCB9LAorCQl7ICItcXVldWUiLCBRVUVVRSwgZ2VtX2hhc19xdWV1ZXMgfSwKKwkJeyAiLXF1
ZXVlLWludGVycnVwdGlibGUiLCBRVUVVRSB8IElOVEVSUlVQVElCTEUsIGdlbV9oYXNfcXVldWVz
IH0sCisJCXsgfQorCX07CiAJdWludDMyX3QgbGlnaHQgPSAwLCBoZWF2eTsKIAlpbnQgZmQgPSAt
MTsKIApAQCAtMzE5LDIxICszMzksMjYgQEAgaWd0X21haW4KIAl9CiAKIAlmb3IgKGUgPSBpbnRl
bF9leGVjdXRpb25fZW5naW5lczsgZS0+bmFtZTsgZSsrKSB7Ci0JCWlndF9zdWJ0ZXN0X2YoIiVz
JXMiLCBlLT5leGVjX2lkID09IDAgPyAiYmFzaWMtIiA6ICIiLCBlLT5uYW1lKQotCQkJc2luZ2xl
KGZkLCBsaWdodCwgZSwgMCwgMSwgNSk7Ci0KLQkJaWd0X3NraXBfb25fc2ltdWxhdGlvbigpOwot
Ci0JCWlndF9zdWJ0ZXN0X2YoIiVzJXMtaGVhdnkiLCBlLT5leGVjX2lkID09IDAgPyAiYmFzaWMt
IiA6ICIiLCBlLT5uYW1lKQotCQkJc2luZ2xlKGZkLCBoZWF2eSwgZSwgMCwgMSwgNSk7Ci0JCWln
dF9zdWJ0ZXN0X2YoIiVzLWludGVycnVwdGlibGUiLCBlLT5uYW1lKQotCQkJc2luZ2xlKGZkLCBs
aWdodCwgZSwgSU5URVJSVVBUSUJMRSwgMSwgMTUwKTsKLQkJaWd0X3N1YnRlc3RfZigiZm9ya2Vk
LSVzIiwgZS0+bmFtZSkKLQkJCXNpbmdsZShmZCwgbGlnaHQsIGUsIDAsIG5jcHVzLCAxNTApOwot
CQlpZ3Rfc3VidGVzdF9mKCJmb3JrZWQtJXMtaGVhdnkiLCBlLT5uYW1lKQotCQkJc2luZ2xlKGZk
LCBoZWF2eSwgZSwgMCwgbmNwdXMsIDE1MCk7Ci0JCWlndF9zdWJ0ZXN0X2YoImZvcmtlZC0lcy1p
bnRlcnJ1cHRpYmxlIiwgZS0+bmFtZSkKLQkJCXNpbmdsZShmZCwgbGlnaHQsIGUsIElOVEVSUlVQ
VElCTEUsIG5jcHVzLCAxNTApOworCQlmb3IgKHR5cGVvZigqcGhhc2VzKSAqcCA9IHBoYXNlczsg
cC0+bmFtZTsgcCsrKSB7CisJCQlpZ3Rfc3VidGVzdF9ncm91cCB7CisJCQkJaWd0X2ZpeHR1cmUg
eworCQkJCQlpZiAocC0+cmVxdWlyZSkKKwkJCQkJCWlndF9yZXF1aXJlKHAtPnJlcXVpcmUoZmQp
KTsKKwkJCQl9CisKKwkJCQlpZ3Rfc3VidGVzdF9mKCIlcyVzJXMiLCBlLT5leGVjX2lkID09IDAg
PyAiYmFzaWMtIiA6ICIiLCBlLT5uYW1lLCBwLT5uYW1lKQorCQkJCQlzaW5nbGUoZmQsIGxpZ2h0
LCBlLCBwLT5mbGFncywgMSwgNSk7CisKKwkJCQlpZ3Rfc2tpcF9vbl9zaW11bGF0aW9uKCk7CisK
KwkJCQlpZ3Rfc3VidGVzdF9mKCIlcyVzLWhlYXZ5JXMiLCBlLT5leGVjX2lkID09IDAgPyAiYmFz
aWMtIiA6ICIiLCBlLT5uYW1lLCBwLT5uYW1lKQorCQkJCQlzaW5nbGUoZmQsIGhlYXZ5LCBlLCBw
LT5mbGFncywgMSwgNSk7CisJCQkJaWd0X3N1YnRlc3RfZigiZm9ya2VkLSVzJXMiLCBlLT5uYW1l
LCBwLT5uYW1lKQorCQkJCQlzaW5nbGUoZmQsIGxpZ2h0LCBlLCBwLT5mbGFncywgbmNwdXMsIDE1
MCk7CisJCQkJaWd0X3N1YnRlc3RfZigiZm9ya2VkLSVzLWhlYXZ5JXMiLCBlLT5uYW1lLCBwLT5u
YW1lKQorCQkJCQlzaW5nbGUoZmQsIGhlYXZ5LCBlLCBwLT5mbGFncywgbmNwdXMsIDE1MCk7CisJ
CQl9CisJCX0KIAl9CiAKIAlpZ3Rfc3VidGVzdCgiYmFzaWMtYWxsLWxpZ2h0IikKQEAgLTM0MSw2
ICszNjYsMTYgQEAgaWd0X21haW4KIAlpZ3Rfc3VidGVzdCgiYmFzaWMtYWxsLWhlYXZ5IikKIAkJ
YWxsKGZkLCBoZWF2eSwgMCwgNSk7CiAKKwlpZ3Rfc3VidGVzdF9ncm91cCB7CisJCWlndF9maXh0
dXJlIHsKKwkJCWlndF9yZXF1aXJlKGdlbV9oYXNfcXVldWVzKGZkKSk7CisJCX0KKwkJaWd0X3N1
YnRlc3QoImJhc2ljLXF1ZXVlLWxpZ2h0IikKKwkJCWFsbChmZCwgbGlnaHQsIFFVRVVFLCA1KTsK
KwkJaWd0X3N1YnRlc3QoImJhc2ljLXF1ZXVlLWhlYXZ5IikKKwkJCWFsbChmZCwgaGVhdnksIFFV
RVVFLCA1KTsKKwl9CisKIAlpZ3RfZml4dHVyZSB7CiAJCWlndF9zdG9wX2hhbmdfZGV0ZWN0b3Io
KTsKIAkJZ2VtX2Nsb3NlKGZkLCBoZWF2eSk7Ci0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50
ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9y
Zy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

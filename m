Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1315DA3A64
	for <lists+intel-gfx@lfdr.de>; Fri, 30 Aug 2019 17:32:58 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 71C696E102;
	Fri, 30 Aug 2019 15:32:56 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0AA0D6E102
 for <intel-gfx@lists.freedesktop.org>; Fri, 30 Aug 2019 15:32:53 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 18319920-1500050 for multiple; Fri, 30 Aug 2019 16:32:51 +0100
MIME-Version: 1.0
From: Chris Wilson <chris@chris-wilson.co.uk>
User-Agent: alot/0.6
To: Lionel Landwerlin <lionel.g.landwerlin@intel.com>,
 intel-gfx@lists.freedesktop.org
References: <20190830144726.18291-1-lionel.g.landwerlin@intel.com>
 <20190830144726.18291-10-lionel.g.landwerlin@intel.com>
In-Reply-To: <20190830144726.18291-10-lionel.g.landwerlin@intel.com>
Message-ID: <156717916897.29078.17215944341470076099@skylake-alporthouse-com>
Date: Fri, 30 Aug 2019 16:32:48 +0100
Subject: Re: [Intel-gfx] [PATCH v12 09/11] drm/i915: add a new perf
 configuration execbuf parameter
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVvdGluZyBMaW9uZWwgTGFuZHdlcmxpbiAoMjAxOS0wOC0zMCAxNTo0NzoyNCkKPiArc3RhdGlj
IGludAo+ICtnZXRfZXhlY2J1Zl9vYV9jb25maWcoc3RydWN0IGk5MTVfZXhlY2J1ZmZlciAqZWIp
Cj4gK3sKPiArICAgICAgIGludCBlcnIgPSAwOwo+ICsKPiArICAgICAgIGViLT5wZXJmX2ZpbGUg
PSBOVUxMOwo+ICsgICAgICAgZWItPm9hX2NvbmZpZyA9IE5VTEw7Cj4gKyAgICAgICBlYi0+b2Ff
dm1hID0gTlVMTDsKPiArICAgICAgIGViLT5vYV9ibyA9IE5VTEw7Cj4gKwo+ICsgICAgICAgaWYg
KChlYi0+ZXh0ZW5zaW9ucy5mbGFncyAmIEJJVF9VTEwoRFJNX0k5MTVfR0VNX0VYRUNCVUZGRVJf
RVhUX1BFUkYpKSA9PSAwKQo+ICsgICAgICAgICAgICAgICByZXR1cm4gMDsKPiArCj4gKyAgICAg
ICBlYi0+cGVyZl9maWxlID0gZmdldChlYi0+ZXh0ZW5zaW9ucy5wZXJmX2NvbmZpZy5wZXJmX2Zk
KTsKPiArICAgICAgIGlmICghZWItPnBlcmZfZmlsZSkKPiArICAgICAgICAgICAgICAgcmV0dXJu
IC1FSU5WQUw7Cj4gKwo+ICsgICAgICAgZXJyID0gaTkxNV9tdXRleF9sb2NrX2ludGVycnVwdGli
bGUoJmViLT5pOTE1LT5kcm0pOwo+ICsgICAgICAgaWYgKGVycikgewo+ICsgICAgICAgICAgICAg
ICBmcHV0KGViLT5wZXJmX2ZpbGUpOwo+ICsgICAgICAgICAgICAgICBlYi0+cGVyZl9maWxlID0g
TlVMTDsKPiArICAgICAgICAgICAgICAgcmV0dXJuIGVycjsKPiArICAgICAgIH0KPiArCj4gKyAg
ICAgICBpZiAoZWItPnBlcmZfZmlsZS0+cHJpdmF0ZV9kYXRhICE9IGViLT5pOTE1LT5wZXJmLmV4
Y2x1c2l2ZV9zdHJlYW0pCj4gKyAgICAgICAgICAgICAgIGVyciA9IC1FSU5WQUw7Cj4gKwo+ICsg
ICAgICAgbXV0ZXhfdW5sb2NrKCZlYi0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CgpTbyB3aHkg
Y2FuIGk5MTUtPnBlcmYuZXhlY2x1c2l2ZV9zdHJlYW0gbm90IGNoYW5nZSBhZnRlciB0aGlzIHBv
aW50PwoKPiArCj4gKyAgICAgICBpZiAoIWVycikgewo+ICsgICAgICAgICAgICAgICBlcnIgPSBp
OTE1X3BlcmZfZ2V0X29hX2NvbmZpZ19hbmRfYm8oCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ZWItPmk5MTUtPnBlcmYuZXhjbHVzaXZlX3N0cmVhbSwKPiArICAgICAgICAgICAgICAgICAgICAg
ICBlYi0+ZXh0ZW5zaW9ucy5wZXJmX2NvbmZpZy5vYV9jb25maWcsCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgJmViLT5vYV9jb25maWcsICZlYi0+b2FfYm8pOwo+ICsgICAgICAgfQo+ICsKPiAr
ICAgICAgIHJldHVybiBlcnI7Cj4gK30KPiArCj4gIHN0YXRpYyBpbnQgX19yZWxvY19ncHVfYWxs
b2Moc3RydWN0IGk5MTVfZXhlY2J1ZmZlciAqZWIsCj4gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHVuc2lnbmVkIGludCBsZW4pCj4gQEAgLTIwNTEsNiArMjA5OCw1MCBAQCBhZGRfdG9fY2xpZW50
KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpCj4gICAgICAg
ICBzcGluX3VubG9jaygmZmlsZV9wcml2LT5tbS5sb2NrKTsKPiAgfQo+ICAKPiArc3RhdGljIGlu
dCBlYl9vYV9jb25maWcoc3RydWN0IGk5MTVfZXhlY2J1ZmZlciAqZWIpCj4gK3sKPiArICAgICAg
IHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpwZXJmX3N0cmVhbTsKPiArICAgICAgIGludCBlcnI7
Cj4gKwo+ICsgICAgICAgaWYgKCFlYi0+b2FfY29uZmlnKQo+ICsgICAgICAgICAgICAgICByZXR1
cm4gMDsKPiArCj4gKyAgICAgICBwZXJmX3N0cmVhbSA9IGViLT5wZXJmX2ZpbGUtPnByaXZhdGVf
ZGF0YTsKPiArCj4gKyAgICAgICBlcnIgPSBtdXRleF9sb2NrX2ludGVycnVwdGlibGUoJnBlcmZf
c3RyZWFtLT5jb25maWdfbXV0ZXgpOwo+ICsgICAgICAgaWYgKGVycikKPiArICAgICAgICAgICAg
ICAgcmV0dXJuIGVycjsKPiArCj4gKyAgICAgICBlcnIgPSBpOTE1X2FjdGl2ZV9yZXF1ZXN0X3Nl
dCgmcGVyZl9zdHJlYW0tPmFjdGl2ZV9jb25maWdfcnEsCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBlYi0+cmVxdWVzdCk7Cj4gKyAgICAgICBpZiAoZXJyKQo+ICsgICAg
ICAgICAgICAgICBnb3RvIG91dDsKPiArCj4gKyAgICAgICAvKgo+ICsgICAgICAgICogSWYgdGhl
IGNvbmZpZyBoYXNuJ3QgY2hhbmdlZCwgc2tpcCByZWNvbmZpZ3VyaW5nIHRoZSBIVyAodGhpcyBp
cwo+ICsgICAgICAgICogc3ViamVjdCB0byBhIGRlbGF5IHdlIHdhbnQgdG8gYXZvaWQgaGFzIG11
Y2ggYXMgcG9zc2libGUpLgo+ICsgICAgICAgICovCj4gKyAgICAgICBpZiAoZWItPm9hX2NvbmZp
ZyA9PSBwZXJmX3N0cmVhbS0+b2FfY29uZmlnKQo+ICsgICAgICAgICAgICAgICBnb3RvIG91dDsK
PiArCgpXZSBuZWVkIHRvIHdhaXQgZm9yIGFueSBleGNsdXNpdmUgZmVuY2VzIGluIGNhc2Ugd2Ug
bWlncmF0ZSB0aGlzIG9iamVjdAppbiBmdXR1cmU6CgppOTE1X3ZtYV9sb2NrKGViLT5vYV92bWEp
OwplcnIgPSBpOTE1X3JlcXVlc3RfYXdhaXRfb2JqZWN0KGViLT5yZXF1ZXN0LCBlYi0+b2Ffdm1h
LT5vYmosIGZhbHNlKTsgLyogYXdhaXRfcmVzdiBhbHJlYWR5ISAqLwppZiAoZXJyID0gMCkKCWVy
ciA9IGk5MTVfdm1hX21vdmVfdG9fYWN0aXZlKGViLT5vYV92bWEsIGViLT5yZXF1ZXN0LCAwKTsK
aTkxNV92bWFfdW5sb2NrKGViLT5vYV92bWEpOwoKVGhvdWdoIHRoaXMgcmFpc2VzIGFuIGludGVy
ZXN0aW5nIHBvaW50LCB3ZSBkbyBub3QgYWN0dWFsbHkgd2FudCB0byBlbWl0CmEgc2VtYXBob3Jl
IGhlcmUgKGFsYmVpdCB0aGUgZW5naW5lIGlzIGZpeGVkIGF0bSkgYXMgd2UgYXJlIGFmdGVyIHRo
ZQpwb2ludCB3aGVyZSB3ZSBoYXZlIGRlY2xhcmVkIGFsbCBzZW1hcGhvcmUgd2FpdHMgY29tcGxl
dGVkLiAoTm90IGFuCmlzc3VlIHRvIHdvcnJ5IGFib3V0IHJpZ2h0IG5vdyEpCgo+ICsgICAgICAg
aWYgKGVycikKPiArICAgICAgICAgICAgICAgZ290byBvdXQ7Cj4gKwo+ICsgICAgICAgZXJyID0g
ZWItPmVuZ2luZS0+ZW1pdF9iYl9zdGFydChlYi0+cmVxdWVzdCwKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgZWItPm9hX3ZtYS0+bm9kZS5zdGFydCwKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCwgSTkxNV9ESVNQQVRDSF9TRUNVUkUp
Owo+ICsgICAgICAgaWYgKGVycikKPiArICAgICAgICAgICAgICAgZ290byBvdXQ7Cj4gKwo+ICsg
ICAgICAgc3dhcChlYi0+b2FfY29uZmlnLCBwZXJmX3N0cmVhbS0+b2FfY29uZmlnKTsKPiArCj4g
K291dDoKPiArICAgICAgIG11dGV4X3VubG9jaygmcGVyZl9zdHJlYW0tPmNvbmZpZ19tdXRleCk7
Cj4gKwo+ICsgICAgICAgcmV0dXJuIGVycjsKPiArfQo+ICsKPiAgc3RhdGljIGludCBlYl9zdWJt
aXQoc3RydWN0IGk5MTVfZXhlY2J1ZmZlciAqZWIpCj4gIHsKPiAgICAgICAgIGludCBlcnI7Cj4g
QEAgLTIwNzcsNiArMjE2OCwxMCBAQCBzdGF0aWMgaW50IGViX3N1Ym1pdChzdHJ1Y3QgaTkxNV9l
eGVjYnVmZmVyICplYikKPiAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXJyOwo+ICAg
ICAgICAgfQo+ICAKPiArICAgICAgIGVyciA9IGViX29hX2NvbmZpZyhlYik7Cj4gKyAgICAgICBp
ZiAoZXJyKQo+ICsgICAgICAgICAgICAgICByZXR1cm4gZXJyOwoKT2ssIGRlZmluaXRlbHkgbmVl
ZHMgdG8gYmUgYWZ0ZXIgdGhlIHdhaXRzIQoKPiArCj4gICAgICAgICBlcnIgPSBlYi0+ZW5naW5l
LT5lbWl0X2JiX3N0YXJ0KGViLT5yZXF1ZXN0LAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBlYi0+YmF0Y2gtPm5vZGUuc3RhcnQgKwo+ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBlYi0+YmF0Y2hfc3RhcnRfb2Zmc2V0LAo+IEBAIC0yNjQz
LDggKzI3MzgsMjUgQEAgc3RhdGljIGludCBwYXJzZV90aW1lbGluZV9mZW5jZXMoc3RydWN0IGk5
MTVfdXNlcl9leHRlbnNpb24gX191c2VyICpleHQsIHZvaWQgKmQKPiAgICAgICAgIHJldHVybiAw
Owo+ICB9Cj4gIAo+ICtzdGF0aWMgaW50IHBhcnNlX3BlcmZfY29uZmlnKHN0cnVjdCBpOTE1X3Vz
ZXJfZXh0ZW5zaW9uIF9fdXNlciAqZXh0LCB2b2lkICpkYXRhKQo+ICt7Cj4gKyAgICAgICBzdHJ1
Y3QgaTkxNV9leGVjYnVmZmVyICplYiA9IGRhdGE7Cj4gKwo+ICsgICAgICAgaWYgKGViLT5leHRl
bnNpb25zLmZsYWdzICYgQklUX1VMTChEUk1fSTkxNV9HRU1fRVhFQ0JVRkZFUl9FWFRfUEVSRikp
Cj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwo+ICsKPiArICAgICAgIGlmIChjb3B5
X2Zyb21fdXNlcigmZWItPmV4dGVuc2lvbnMucGVyZl9jb25maWcsIGV4dCwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICBzaXplb2YoZWItPmV4dGVuc2lvbnMucGVyZl9jb25maWcpKSkKPiAr
ICAgICAgICAgICAgICAgcmV0dXJuIC1FRkFVTFQ7Cj4gKwo+ICsgICAgICAgZWItPmV4dGVuc2lv
bnMuZmxhZ3MgfD0gQklUX1VMTChEUk1fSTkxNV9HRU1fRVhFQ0JVRkZFUl9FWFRfUEVSRik7Cj4g
Kwo+ICsgICAgICAgcmV0dXJuIDA7Cj4gK30KPiArCj4gIHN0YXRpYyBjb25zdCBpOTE1X3VzZXJf
ZXh0ZW5zaW9uX2ZuIGV4ZWNidWZfZXh0ZW5zaW9uc1tdID0gewo+ICAgICAgICAgIFtEUk1fSTkx
NV9HRU1fRVhFQ0JVRkZFUl9FWFRfVElNRUxJTkVfRkVOQ0VTXSA9IHBhcnNlX3RpbWVsaW5lX2Zl
bmNlcywKPiArICAgICAgICBbRFJNX0k5MTVfR0VNX0VYRUNCVUZGRVJfRVhUX1BFUkZdID0gcGFy
c2VfcGVyZl9jb25maWcsCj4gIH07Cj4gIAo+ICBzdGF0aWMgaW50Cj4gQEAgLTI3NTUsMTAgKzI4
NjcsMTQgQEAgaTkxNV9nZW1fZG9fZXhlY2J1ZmZlcihzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+
ICAgICAgICAgICAgICAgICB9Cj4gICAgICAgICB9Cj4gIAo+IC0gICAgICAgZXJyID0gZWJfY3Jl
YXRlKCZlYik7Cj4gKyAgICAgICBlcnIgPSBnZXRfZXhlY2J1Zl9vYV9jb25maWcoJmViKTsKPiAg
ICAgICAgIGlmIChlcnIpCj4gICAgICAgICAgICAgICAgIGdvdG8gZXJyX291dF9mZW5jZTsKPiAg
Cj4gKyAgICAgICBlcnIgPSBlYl9jcmVhdGUoJmViKTsKPiArICAgICAgIGlmIChlcnIpCj4gKyAg
ICAgICAgICAgICAgIGdvdG8gZXJyX29hX2NvbmZpZzsKPiArCj4gICAgICAgICBHRU1fQlVHX09O
KCFlYi5sdXRfc2l6ZSk7Cj4gIAo+ICAgICAgICAgZXJyID0gZWJfc2VsZWN0X2NvbnRleHQoJmVi
KTsKPiBAQCAtMjc2OSw2ICsyODg1LDE2IEBAIGk5MTVfZ2VtX2RvX2V4ZWNidWZmZXIoc3RydWN0
IGRybV9kZXZpY2UgKmRldiwKPiAgICAgICAgIGlmICh1bmxpa2VseShlcnIpKQo+ICAgICAgICAg
ICAgICAgICBnb3RvIGVycl9jb250ZXh0Owo+ICAKPiArICAgICAgIGlmIChlYi5leHRlbnNpb25z
LmZsYWdzICYgQklUX1VMTChEUk1fSTkxNV9HRU1fRVhFQ0JVRkZFUl9FWFRfUEVSRikpIHsKPiAr
ICAgICAgICAgICAgICAgc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnBlcmZfc3RyZWFtID0KPiAr
ICAgICAgICAgICAgICAgICAgICAgICBlYi5wZXJmX2ZpbGUtPnByaXZhdGVfZGF0YTsKPiArCj4g
KyAgICAgICAgICAgICAgIGlmIChwZXJmX3N0cmVhbS0+ZW5naW5lICE9IGViLmVuZ2luZSkgewo+
ICsgICAgICAgICAgICAgICAgICAgICAgIGVyciA9IC1FSU5WQUw7Cj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgZ290byBlcnJfZW5naW5lOwo+ICsgICAgICAgICAgICAgICB9Cj4gKyAgICAgICB9
Cj4gKwo+ICAgICAgICAgZXJyID0gaTkxNV9tdXRleF9sb2NrX2ludGVycnVwdGlibGUoZGV2KTsK
PiAgICAgICAgIGlmIChlcnIpCj4gICAgICAgICAgICAgICAgIGdvdG8gZXJyX2VuZ2luZTsKPiBA
QCAtMjg4OSw2ICszMDE1LDIwIEBAIGk5MTVfZ2VtX2RvX2V4ZWNidWZmZXIoc3RydWN0IGRybV9k
ZXZpY2UgKmRldiwKPiAgICAgICAgICAgICAgICAgfQo+ICAgICAgICAgfQo+ICAKPiArICAgICAg
IGlmIChlYi5leHRlbnNpb25zLmZsYWdzICYgQklUX1VMTChEUk1fSTkxNV9HRU1fRVhFQ0JVRkZF
Ul9FWFRfUEVSRikpIHsKPiArICAgICAgICAgICAgICAgZWIub2Ffdm1hID0gaTkxNV92bWFfaW5z
dGFuY2UoZWIub2FfYm8sCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICZlYi5lbmdpbmUtPmk5MTUtPmdndHQudm0sIE5VTEwpOwoKZWIuZW5naW5lLT5ndC0+
Z2d0dC52bQoKVGhlIGk5MTVfdm1hX2luc3RhbmNlKCkgY2FuIGJlIGNyZWF0ZWQgb3V0c2lkZSBv
ZiB0aGUgc3RydWN0X211dGV4LCBhbmQKb25jZSB3ZSBoYXZlIHRoZSBvYV92bWEsIHdlIGRvbid0
IG5lZWQgdG8ga2VlcCBhIG9hX2JvIHBvaW50ZXIuCgpMYXRlciB3ZSBjYW4gZG8gdGhlIGk5MTVf
dm1hX3BpbigpIGJlZm9yZSBzdHJ1Y3RfbXV0ZXggYXMgd2VsbC4KClRoYW5rcywgdGhhdCdzIGxv
b2tpbmcgYSBiZXR0ZXIgd2l0aCByZWdhcmQgdGhlIHBsYW4gdG8gZWxpbWluYXRlCnN0cnVjdF9t
dXRleC4KLUNocmlzCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9y
ZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdm
eA==

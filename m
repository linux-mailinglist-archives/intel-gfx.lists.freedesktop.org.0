Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 357257E224
	for <lists+intel-gfx@lfdr.de>; Thu,  1 Aug 2019 20:27:19 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6957F6E76A;
	Thu,  1 Aug 2019 18:27:16 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A17CD6E76A
 for <intel-gfx@lists.freedesktop.org>; Thu,  1 Aug 2019 18:27:14 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17796132-1500050 
 for multiple; Thu, 01 Aug 2019 19:26:59 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu,  1 Aug 2019 19:26:57 +0100
Message-Id: <20190801182657.5311-2-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0.rc0
In-Reply-To: <20190801182657.5311-1-chris@chris-wilson.co.uk>
References: <20190801182657.5311-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 2/2] drm/i915/pmu: Use GT parked for estimating
 RC6 while asleep
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QXMgd2UgdHJhY2sgd2hlbiB3ZSBwdXQgdGhlIEdUIGRldmljZSB0byBzbGVlcCB1cG9uIGlkbGlu
Zywgd2UgY2FuIHVzZQp0aGF0IGNhbGxiYWNrIHRvIHNhbXBsZSB0aGUgY3VycmVudCByYzYgY291
bnRlcnMgYW5kIHJlY29yZCB0aGUKdGltZXN0YW1wIGZvciBlc3RpbWF0aW5nIHNhbXBsZXMgYWZ0
ZXIgdGhhdCBwb2ludCB3aGlsZSBhc2xlZXAuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24g
PGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KQ2M6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJz
dWxpbkBpbnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMg
fCAgMjEgKystLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11LmMgICAgIHwgMTIyICsr
KysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11
LmggICAgIHwgICA0ICstCiAzIGZpbGVzIGNoYW5nZWQsIDcxIGluc2VydGlvbnMoKyksIDc2IGRl
bGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdm
cy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKaW5kZXggMjQ3ODdiYjQ4
YzlmLi5hOTZlNjMwZDNmODYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
ZGVidWdmcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCkBAIC0z
OSw2ICszOSw3IEBACiAjaW5jbHVkZSAiZGlzcGxheS9pbnRlbF9wc3IuaCIKIAogI2luY2x1ZGUg
ImdlbS9pOTE1X2dlbV9jb250ZXh0LmgiCisjaW5jbHVkZSAiZ3QvaW50ZWxfZ3RfcG0uaCIKICNp
bmNsdWRlICJndC9pbnRlbF9yZXNldC5oIgogI2luY2x1ZGUgImd0L3VjL2ludGVsX2d1Y19zdWJt
aXNzaW9uLmgiCiAKQEAgLTQwNTcsMTMgKzQwNTgsMTEgQEAgc3RhdGljIGludCBpOTE1X3NzZXVf
c3RhdHVzKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogc3RhdGljIGludCBpOTE1
X2ZvcmNld2FrZV9vcGVuKHN0cnVjdCBpbm9kZSAqaW5vZGUsIHN0cnVjdCBmaWxlICpmaWxlKQog
ewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gaW5vZGUtPmlfcHJpdmF0ZTsKKwlz
dHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gJmk5MTUtPmd0OwogCi0JaWYgKElOVEVMX0dFTihpOTE1KSA8
IDYpCi0JCXJldHVybiAwOwotCi0JZmlsZS0+cHJpdmF0ZV9kYXRhID0KLQkJKHZvaWQgKikodWlu
dHB0cl90KWludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKLQlpbnRlbF91
bmNvcmVfZm9yY2V3YWtlX3VzZXJfZ2V0KCZpOTE1LT51bmNvcmUpOworCWludGVsX2d0X3BtX2dl
dChndCk7CisJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA2KQorCQlpbnRlbF91bmNvcmVfZm9yY2V3
YWtlX3VzZXJfZ2V0KGd0LT51bmNvcmUpOwogCiAJcmV0dXJuIDA7CiB9CkBAIC00MDcxLDEzICs0
MDcwLDExIEBAIHN0YXRpYyBpbnQgaTkxNV9mb3JjZXdha2Vfb3BlbihzdHJ1Y3QgaW5vZGUgKmlu
b2RlLCBzdHJ1Y3QgZmlsZSAqZmlsZSkKIHN0YXRpYyBpbnQgaTkxNV9mb3JjZXdha2VfcmVsZWFz
ZShzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZmlsZSkKIHsKIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGlub2RlLT5pX3ByaXZhdGU7CisJc3RydWN0IGludGVsX2d0
ICpndCA9ICZpOTE1LT5ndDsKIAotCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA2KQotCQlyZXR1cm4g
MDsKLQotCWludGVsX3VuY29yZV9mb3JjZXdha2VfdXNlcl9wdXQoJmk5MTUtPnVuY29yZSk7Ci0J
aW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sCi0JCQkgICAgIChpbnRlbF93
YWtlcmVmX3QpKHVpbnRwdHJfdClmaWxlLT5wcml2YXRlX2RhdGEpOworCWlmIChJTlRFTF9HRU4o
aTkxNSkgPj0gNikKKwkJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV91c2VyX3B1dCgmaTkxNS0+dW5j
b3JlKTsKKwlpbnRlbF9ndF9wbV9wdXQoZ3QpOwogCiAJcmV0dXJuIDA7CiB9CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9wbXUuYwppbmRleCA0ZDdjYWJlZWE2ODcuLjY4MDYxOGJkMzg1YyAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wbXUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3BtdS5jCkBAIC0xMTQsMTcgKzExNCw1MCBAQCBzdGF0aWMgYm9vbCBwbXVfbmVlZHNf
dGltZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGJvb2wgZ3B1X2FjdGl2ZSkKIAly
ZXR1cm4gZW5hYmxlOwogfQogCitzdGF0aWMgdTY0IF9fZ2V0X3JjNihzdHJ1Y3QgaW50ZWxfZ3Qg
Kmd0KQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3QtPmk5MTU7CisJdTY0
IHZhbDsKKworCXZhbCA9IGludGVsX3JjNl9yZXNpZGVuY3lfbnMoaTkxNSwKKwkJCQkgICAgIElT
X1ZBTExFWVZJRVcoaTkxNSkgPworCQkJCSAgICAgVkxWX0dUX1JFTkRFUl9SQzYgOgorCQkJCSAg
ICAgR0VONl9HVF9HRlhfUkM2KTsKKworCWlmIChIQVNfUkM2cChpOTE1KSkKKwkJdmFsICs9IGlu
dGVsX3JjNl9yZXNpZGVuY3lfbnMoaTkxNSwgR0VONl9HVF9HRlhfUkM2cCk7CisKKwlpZiAoSEFT
X1JDNnBwKGk5MTUpKQorCQl2YWwgKz0gaW50ZWxfcmM2X3Jlc2lkZW5jeV9ucyhpOTE1LCBHRU42
X0dUX0dGWF9SQzZwcCk7CisKKwlyZXR1cm4gdmFsOworfQorCiB2b2lkIGk5MTVfcG11X2d0X3Bh
cmtlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIHsKKwl1NjQgdmFsOworCiAJaWYg
KCFpOTE1LT5wbXUuYmFzZS5ldmVudF9pbml0KQogCQlyZXR1cm47CiAKKwl2YWwgPSAwOworCWlm
IChpOTE1LT5wbXUuc2FtcGxlW19fSTkxNV9TQU1QTEVfUkM2XS5jdXIpCisJCXZhbCA9IF9fZ2V0
X3JjNigmaTkxNS0+Z3QpOworCiAJc3Bpbl9sb2NrX2lycSgmaTkxNS0+cG11LmxvY2spOworCisJ
aWYgKHZhbCA+PSBpOTE1LT5wbXUuc2FtcGxlW19fSTkxNV9TQU1QTEVfUkM2X0VTVElNQVRFRF0u
Y3VyKSB7CisJCWk5MTUtPnBtdS5zYW1wbGVbX19JOTE1X1NBTVBMRV9SQzZfRVNUSU1BVEVEXS5j
dXIgPSAwOworCQlpOTE1LT5wbXUuc2FtcGxlW19fSTkxNV9TQU1QTEVfUkM2XS5jdXIgPSB2YWw7
CisJfQorCWk5MTUtPnBtdS5zbGVlcF90aW1lc3RhbXAgPSBqaWZmaWVzOworCiAJLyoKIAkgKiBT
aWduYWwgc2FtcGxpbmcgdGltZXIgdG8gc3RvcCBpZiBvbmx5IGVuZ2luZSBldmVudHMgYXJlIGVu
YWJsZWQgYW5kCiAJICogR1BVIHdlbnQgaWRsZS4KIAkgKi8KIAlpOTE1LT5wbXUudGltZXJfZW5h
YmxlZCA9IHBtdV9uZWVkc190aW1lcihpOTE1LCBmYWxzZSk7CisKIAlzcGluX3VubG9ja19pcnEo
Jmk5MTUtPnBtdS5sb2NrKTsKIH0KIApAQCAtMTQ1LDEwICsxNzgsMjMgQEAgdm9pZCBpOTE1X3Bt
dV9ndF91bnBhcmtlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkJcmV0dXJuOwog
CiAJc3Bpbl9sb2NrX2lycSgmaTkxNS0+cG11LmxvY2spOworCiAJLyoKIAkgKiBSZS1lbmFibGUg
c2FtcGxpbmcgdGltZXIgd2hlbiBHUFUgZ29lcyBhY3RpdmUuCiAJICovCiAJX19pOTE1X3BtdV9t
YXliZV9zdGFydF90aW1lcihpOTE1KTsKKworCS8qIEVzdGltYXRlIGhvdyBsb25nIHdlIHNsZXB0
IGFuZCBhY2N1bXVsYXRlIHRoYXQgaW50byByYzYgY291bnRlcnMgKi8KKwlpZiAoaTkxNS0+cG11
LnNhbXBsZVtfX0k5MTVfU0FNUExFX1JDNl0uY3VyKSB7CisJCXU2NCB2YWw7CisKKwkJdmFsID0g
amlmZmllcyAtIGk5MTUtPnBtdS5zbGVlcF90aW1lc3RhbXA7CisJCXZhbCA9IGppZmZpZXNfdG9f
bnNlY3ModmFsKTsKKwkJdmFsICs9IGk5MTUtPnBtdS5zYW1wbGVbX19JOTE1X1NBTVBMRV9SQzZd
LmN1cjsKKworCQlpOTE1LT5wbXUuc2FtcGxlW19fSTkxNV9TQU1QTEVfUkM2X0VTVElNQVRFRF0u
Y3VyID0gdmFsOworCX0KKwogCXNwaW5fdW5sb2NrX2lycSgmaTkxNS0+cG11LmxvY2spOwogfQog
CkBAIC00MTcsMzYgKzQ2MywxNyBAQCBzdGF0aWMgaW50IGk5MTVfcG11X2V2ZW50X2luaXQoc3Ry
dWN0IHBlcmZfZXZlbnQgKmV2ZW50KQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgdTY0IF9fZ2V0
X3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKK3N0YXRpYyB1NjQgZ2V0X3JjNihz
dHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewotCXU2NCB2YWw7Ci0KLQl2YWwgPSBpbnRlbF9yYzZfcmVz
aWRlbmN5X25zKGk5MTUsCi0JCQkJICAgICBJU19WQUxMRVlWSUVXKGk5MTUpID8KLQkJCQkgICAg
IFZMVl9HVF9SRU5ERVJfUkM2IDoKLQkJCQkgICAgIEdFTjZfR1RfR0ZYX1JDNik7Ci0KLQlpZiAo
SEFTX1JDNnAoaTkxNSkpCi0JCXZhbCArPSBpbnRlbF9yYzZfcmVzaWRlbmN5X25zKGk5MTUsIEdF
TjZfR1RfR0ZYX1JDNnApOwotCi0JaWYgKEhBU19SQzZwcChpOTE1KSkKLQkJdmFsICs9IGludGVs
X3JjNl9yZXNpZGVuY3lfbnMoaTkxNSwgR0VONl9HVF9HRlhfUkM2cHApOwotCi0JcmV0dXJuIHZh
bDsKLX0KLQotc3RhdGljIHU2NCBnZXRfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQotewotI2lmIElTX0VOQUJMRUQoQ09ORklHX1BNKQotCXN0cnVjdCBpbnRlbF9ydW50aW1lX3Bt
ICpycG0gPSAmaTkxNS0+cnVudGltZV9wbTsKLQlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd0LT5pOTE1OwogCXVuc2lnbmVkIGxvbmcg
ZmxhZ3M7CiAJdTY0IHZhbDsKIAotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9p
bl91c2UocnBtKTsKLQlpZiAod2FrZXJlZikgewotCQl2YWwgPSBfX2dldF9yYzYoaTkxNSk7Ci0J
CWludGVsX3J1bnRpbWVfcG1fcHV0KHJwbSwgd2FrZXJlZik7CisJc3Bpbl9sb2NrX2lycXNhdmUo
Jmk5MTUtPnBtdS5sb2NrLCBmbGFncyk7CisKKwlpZiAoaW50ZWxfZ3RfcG1fZ2V0X2lmX2F3YWtl
KGd0KSkgeworCQl2YWwgPSBfX2dldF9yYzYoZ3QpOworCQlpbnRlbF9ndF9wbV9wdXQoZ3QpOwog
CiAJCS8qCiAJCSAqIElmIHdlIGFyZSBjb21pbmcgYmFjayBmcm9tIGJlaW5nIHJ1bnRpbWUgc3Vz
cGVuZGVkIHdlIG11c3QKQEAgLTQ1NCw3ICs0ODEsNiBAQCBzdGF0aWMgdTY0IGdldF9yYzYoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJCSAqIHByZXZpb3VzbHkuCiAJCSAqLwogCi0J
CXNwaW5fbG9ja19pcnFzYXZlKCZpOTE1LT5wbXUubG9jaywgZmxhZ3MpOwogCiAJCWlmICh2YWwg
Pj0gaTkxNS0+cG11LnNhbXBsZVtfX0k5MTVfU0FNUExFX1JDNl9FU1RJTUFURURdLmN1cikgewog
CQkJaTkxNS0+cG11LnNhbXBsZVtfX0k5MTVfU0FNUExFX1JDNl9FU1RJTUFURURdLmN1ciA9IDA7
CkBAIC00NjIsMTEgKzQ4OCw3IEBAIHN0YXRpYyB1NjQgZ2V0X3JjNihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKIAkJfSBlbHNlIHsKIAkJCXZhbCA9IGk5MTUtPnBtdS5zYW1wbGVbX19J
OTE1X1NBTVBMRV9SQzZfRVNUSU1BVEVEXS5jdXI7CiAJCX0KLQotCQlzcGluX3VubG9ja19pcnFy
ZXN0b3JlKCZpOTE1LT5wbXUubG9jaywgZmxhZ3MpOwogCX0gZWxzZSB7Ci0JCXN0cnVjdCBkZXZp
Y2UgKmtkZXYgPSBycG0tPmtkZXY7Ci0KIAkJLyoKIAkJICogV2UgYXJlIHJ1bnRpbWUgc3VzcGVu
ZGVkLgogCQkgKgpAQCAtNDc0LDQyICs0OTYsMTggQEAgc3RhdGljIHU2NCBnZXRfcmM2KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCQkgKiBvbiB0b3Agb2YgdGhlIGxhc3Qga25vd24g
cmVhbCB2YWx1ZSwgYXMgdGhlIGFwcHJveGltYXRlZCBSQzYKIAkJICogY291bnRlciB2YWx1ZS4K
IAkJICovCi0JCXNwaW5fbG9ja19pcnFzYXZlKCZpOTE1LT5wbXUubG9jaywgZmxhZ3MpOwogCi0J
CS8qCi0JCSAqIEFmdGVyIHRoZSBhYm92ZSBicmFuY2ggaW50ZWxfcnVudGltZV9wbV9nZXRfaWZf
aW5fdXNlIGZhaWxlZAotCQkgKiB0byBnZXQgdGhlIHJ1bnRpbWUgUE0gcmVmZXJlbmNlIHdlIGNh
bm5vdCBhc3N1bWUgd2UgYXJlIGluCi0JCSAqIHJ1bnRpbWUgc3VzcGVuZCBzaW5jZSB3ZSBjYW4g
ZWl0aGVyOiBhKSByYWNlIHdpdGggY29taW5nIG91dAotCQkgKiBvZiBpdCBiZWZvcmUgd2UgdG9v
ayB0aGUgcG93ZXIubG9jaywgb3IgYikgdGhlcmUgYXJlIG90aGVyCi0JCSAqIHN0YXRlcyB0aGFu
IHN1c3BlbmRlZCB3aGljaCBjYW4gYnJpbmcgdXMgaGVyZS4KLQkJICoKLQkJICogV2UgbmVlZCB0
byBkb3VibGUtY2hlY2sgdGhhdCB3ZSBhcmUgaW5kZWVkIGN1cnJlbnRseSBydW50aW1lCi0JCSAq
IHN1c3BlbmRlZCBhbmQgaWYgbm90IHdlIGNhbm5vdCBkbyBiZXR0ZXIgdGhhbiByZXBvcnQgdGhl
IGxhc3QKLQkJICoga25vd24gUkM2IHZhbHVlLgotCQkgKi8KLQkJaWYgKHBtX3J1bnRpbWVfc3Rh
dHVzX3N1c3BlbmRlZChrZGV2KSkgewotCQkJdmFsID0gcG1fcnVudGltZV9zdXNwZW5kZWRfdGlt
ZShrZGV2KTsKKwkJdmFsID0gamlmZmllcyAtIGk5MTUtPnBtdS5zbGVlcF90aW1lc3RhbXA7CisJ
CXZhbCA9IGppZmZpZXNfdG9fbnNlY3ModmFsKTsKKwkJdmFsICs9IGk5MTUtPnBtdS5zYW1wbGVb
X19JOTE1X1NBTVBMRV9SQzZdLmN1cjsKIAotCQkJaWYgKCFpOTE1LT5wbXUuc2FtcGxlW19fSTkx
NV9TQU1QTEVfUkM2X0VTVElNQVRFRF0uY3VyKQotCQkJCWk5MTUtPnBtdS5zdXNwZW5kZWRfdGlt
ZV9sYXN0ID0gdmFsOworCQlpOTE1LT5wbXUuc2FtcGxlW19fSTkxNV9TQU1QTEVfUkM2X0VTVElN
QVRFRF0uY3VyID0gdmFsOwogCi0JCQl2YWwgLT0gaTkxNS0+cG11LnN1c3BlbmRlZF90aW1lX2xh
c3Q7Ci0JCQl2YWwgKz0gaTkxNS0+cG11LnNhbXBsZVtfX0k5MTVfU0FNUExFX1JDNl0uY3VyOwot
Ci0JCQlpOTE1LT5wbXUuc2FtcGxlW19fSTkxNV9TQU1QTEVfUkM2X0VTVElNQVRFRF0uY3VyID0g
dmFsOwotCQl9IGVsc2UgaWYgKGk5MTUtPnBtdS5zYW1wbGVbX19JOTE1X1NBTVBMRV9SQzZfRVNU
SU1BVEVEXS5jdXIpIHsKLQkJCXZhbCA9IGk5MTUtPnBtdS5zYW1wbGVbX19JOTE1X1NBTVBMRV9S
QzZfRVNUSU1BVEVEXS5jdXI7Ci0JCX0gZWxzZSB7Ci0JCQl2YWwgPSBpOTE1LT5wbXUuc2FtcGxl
W19fSTkxNV9TQU1QTEVfUkM2XS5jdXI7Ci0JCX0KLQotCQlzcGluX3VubG9ja19pcnFyZXN0b3Jl
KCZpOTE1LT5wbXUubG9jaywgZmxhZ3MpOwogCX0KIAorCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUo
Jmk5MTUtPnBtdS5sb2NrLCBmbGFncyk7CisKIAlyZXR1cm4gdmFsOwotI2Vsc2UKLQlyZXR1cm4g
X19nZXRfcmM2KGk5MTUpOwotI2VuZGlmCiB9CiAKIHN0YXRpYyB1NjQgX19pOTE1X3BtdV9ldmVu
dF9yZWFkKHN0cnVjdCBwZXJmX2V2ZW50ICpldmVudCkKQEAgLTU1MCw3ICs1NDgsNyBAQCBzdGF0
aWMgdTY0IF9faTkxNV9wbXVfZXZlbnRfcmVhZChzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQpCiAJ
CQl2YWwgPSBjb3VudF9pbnRlcnJ1cHRzKGk5MTUpOwogCQkJYnJlYWs7CiAJCWNhc2UgSTkxNV9Q
TVVfUkM2X1JFU0lERU5DWToKLQkJCXZhbCA9IGdldF9yYzYoaTkxNSk7CisJCQl2YWwgPSBnZXRf
cmM2KCZpOTE1LT5ndCk7CiAJCQlicmVhazsKIAkJfQogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfcG11LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5o
CmluZGV4IDRmYzRmMjQ3ODMwMS4uNmZhMDI0MGExNzA0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3BtdS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11
LmgKQEAgLTk3LDkgKzk3LDkgQEAgc3RydWN0IGk5MTVfcG11IHsKIAkgKi8KIAlzdHJ1Y3QgaTkx
NV9wbXVfc2FtcGxlIHNhbXBsZVtfX0k5MTVfTlVNX1BNVV9TQU1QTEVSU107CiAJLyoqCi0JICog
QHN1c3BlbmRlZF90aW1lX2xhc3Q6IENhY2hlZCBzdXNwZW5kIHRpbWUgZnJvbSBQTSBjb3JlLgor
CSAqIEBzbGVlcF90aW1lc3RhbXA6IExhc3QgdGltZSBHVCBwYXJrZWQgZm9yIFJDNiBlc3RpbWF0
aW9uLgogCSAqLwotCXU2NCBzdXNwZW5kZWRfdGltZV9sYXN0OworCXVuc2lnbmVkIGxvbmcgc2xl
ZXBfdGltZXN0YW1wOwogCS8qKgogCSAqIEBpOTE1X2F0dHI6IE1lbW9yeSBibG9jayBob2xkaW5n
IGRldmljZSBhdHRyaWJ1dGVzLgogCSAqLwotLSAKMi4yMy4wLnJjMAoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJ
bnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Au
b3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

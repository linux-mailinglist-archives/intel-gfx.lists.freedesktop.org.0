Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id B38BD16799D
	for <lists+intel-gfx@lfdr.de>; Fri, 21 Feb 2020 10:43:33 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 13A996E248;
	Fri, 21 Feb 2020 09:43:32 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (unknown [77.68.26.236])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A5EC96E248;
 Fri, 21 Feb 2020 09:43:30 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 20299108-1500050 
 for multiple; Fri, 21 Feb 2020 09:43:22 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 21 Feb 2020 09:43:21 +0000
Message-Id: <20200221094321.2534304-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.25.1
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t] i915: Exercise I915_CONTEXT_PARAM_RINGSIZE
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: igt-dev@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

STkxNV9DT05URVhUX1BBUkFNX1JJTkdTSVpFIHNwZWNpZmllcyBob3cgbGFyZ2UgdG8gY3JlYXRl
IHRoZSBjb21tYW5kCnJpbmdidWZmZXIgZm9yIGxvZ2ljYWwgcmluZyBjb250ZWN0cy4gVGhpcyBk
aXJlY3RseSBhZmZlY3RzIHRoZSBudW1iZXIKb2YgYmF0Y2hlcyB1c2Vyc3BhY2UgY2FuIHN1Ym1p
dCBiZWZvcmUgYmxvY2tpbmcgd2FpdGluZyBmb3Igc3BhY2UuCgpTaWduZWQtb2ZmLWJ5OiBDaHJp
cyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KLS0tCiB0ZXN0cy9NYWtlZmlsZS5z
b3VyY2VzICAgICAgICB8ICAgMyArCiB0ZXN0cy9pOTE1L2dlbV9jdHhfcmluZ3NpemUuYyB8IDMz
NCArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiB0ZXN0cy9tZXNvbi5idWlsZCAg
ICAgICAgICAgICB8ICAgMSArCiAzIGZpbGVzIGNoYW5nZWQsIDMzOCBpbnNlcnRpb25zKCspCiBj
cmVhdGUgbW9kZSAxMDA2NDQgdGVzdHMvaTkxNS9nZW1fY3R4X3JpbmdzaXplLmMKCmRpZmYgLS1n
aXQgYS90ZXN0cy9NYWtlZmlsZS5zb3VyY2VzIGIvdGVzdHMvTWFrZWZpbGUuc291cmNlcwppbmRl
eCBiODdkNjMzM2IuLjc2Y2Y5OWRhNSAxMDA2NDQKLS0tIGEvdGVzdHMvTWFrZWZpbGUuc291cmNl
cworKysgYi90ZXN0cy9NYWtlZmlsZS5zb3VyY2VzCkBAIC0xNjMsNiArMTYzLDkgQEAgZ2VtX2N0
eF9wYXJhbV9TT1VSQ0VTID0gaTkxNS9nZW1fY3R4X3BhcmFtLmMKIFRFU1RTX3Byb2dzICs9IGdl
bV9jdHhfcGVyc2lzdGVuY2UKIGdlbV9jdHhfcGVyc2lzdGVuY2VfU09VUkNFUyA9IGk5MTUvZ2Vt
X2N0eF9wZXJzaXN0ZW5jZS5jCiAKK1RFU1RTX3Byb2dzICs9IGdlbV9jdHhfcmluZ3NpemUKK2dl
bV9jdHhfcmluZ3NpemVfU09VUkNFUyA9IGk5MTUvZ2VtX2N0eF9yaW5nc2l6ZS5jCisKIFRFU1RT
X3Byb2dzICs9IGdlbV9jdHhfc2hhcmVkCiBnZW1fY3R4X3NoYXJlZF9TT1VSQ0VTID0gaTkxNS9n
ZW1fY3R4X3NoYXJlZC5jCiAKZGlmZiAtLWdpdCBhL3Rlc3RzL2k5MTUvZ2VtX2N0eF9yaW5nc2l6
ZS5jIGIvdGVzdHMvaTkxNS9nZW1fY3R4X3JpbmdzaXplLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQK
aW5kZXggMDAwMDAwMDAwLi5jMzc3YWMwNzYKLS0tIC9kZXYvbnVsbAorKysgYi90ZXN0cy9pOTE1
L2dlbV9jdHhfcmluZ3NpemUuYwpAQCAtMCwwICsxLDMzNCBAQAorLyoKKyAqIENvcHlyaWdodCDC
qSAyMDE5IEludGVsIENvcnBvcmF0aW9uCisgKgorICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3Jh
bnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEKKyAqIGNvcHkg
b2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUg
IlNvZnR3YXJlIiksCisgKiB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0
aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uCisgKiB0aGUgcmlnaHRzIHRvIHVzZSwg
Y29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwKKyAq
IGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29u
cyB0byB3aG9tIHRoZQorICogU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0
IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKKyAqCisgKiBUaGUgYWJvdmUgY29weXJpZ2h0
IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSAoaW5jbHVkaW5nIHRoZSBuZXh0Cisg
KiBwYXJhZ3JhcGgpIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRp
YWwgcG9ydGlvbnMgb2YgdGhlCisgKiBTb2Z0d2FyZS4KKyAqCisgKiBUSEUgU09GVFdBUkUgSVMg
UFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBP
UgorICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElF
UyBPRiBNRVJDSEFOVEFCSUxJVFksCisgKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9T
RSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwKKyAqIFRIRSBBVVRIT1JT
IE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9S
IE9USEVSCisgKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBU
T1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORworICogRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJ
T04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUworICogSU4g
VEhFIFNPRlRXQVJFLgorICovCisKKyNpbmNsdWRlIDxlcnJuby5oPgorI2luY2x1ZGUgPGZjbnRs
Lmg+CisjaW5jbHVkZSA8aW50dHlwZXMuaD4KKyNpbmNsdWRlIDxtYXRoLmg+CisjaW5jbHVkZSA8
c3lzL2lvY3RsLmg+CisjaW5jbHVkZSA8c3lzL3R5cGVzLmg+CisjaW5jbHVkZSA8dW5pc3RkLmg+
CisKKyNpbmNsdWRlICJkcm10ZXN0LmgiIC8qIGdlbV9xdWllc2NlbnRfZ3B1KCkhICovCisjaW5j
bHVkZSAiaTkxNS9nZW1fY29udGV4dC5oIgorI2luY2x1ZGUgImk5MTUvZ2VtX2VuZ2luZV90b3Bv
bG9neS5oIgorI2luY2x1ZGUgImlvY3RsX3dyYXBwZXJzLmgiIC8qIGdlbV93YWl0KCkhICovCisj
aW5jbHVkZSAic3dfc3luYy5oIgorCisjZGVmaW5lIEk5MTVfQ09OVEVYVF9QQVJBTV9SSU5HU0la
RSAweGMKKworc3RhdGljIGJvb2wgaGFzX3JpbmdzaXplKGludCBpOTE1KQoreworCXN0cnVjdCBk
cm1faTkxNV9nZW1fY29udGV4dF9wYXJhbSBwID0geworCQkucGFyYW0gPSBJOTE1X0NPTlRFWFRf
UEFSQU1fUklOR1NJWkUsCisJfTsKKworCXJldHVybiBfX2dlbV9jb250ZXh0X2dldF9wYXJhbShp
OTE1LCAmcCkgPT0gMDsKK30KKworc3RhdGljIHZvaWQgdGVzdF9pZGVtcG90ZW50KGludCBpOTE1
KQoreworCXN0cnVjdCBkcm1faTkxNV9nZW1fY29udGV4dF9wYXJhbSBwID0geworCQkucGFyYW0g
PSBJOTE1X0NPTlRFWFRfUEFSQU1fUklOR1NJWkUsCisJfTsKKwl1aW50MzJfdCBzYXZlZDsKKwor
CS8qCisJICogU2ltcGxlIHRlc3QgdG8gdmVyaWZ5IHRoYXQgd2UgYXJlIGFibGUgdG8gcmVhZCBi
YWNrIHRoZSBzYW1lCisJICogdmFsdWUgYXMgd2Ugc2V0LgorCSAqLworCisJZ2VtX2NvbnRleHRf
Z2V0X3BhcmFtKGk5MTUsICZwKTsKKwlzYXZlZCA9IHAudmFsdWU7CisKKwlmb3IgKHVpbnQzMl90
IHggPSAxIDw8IDEyOyB4IDw9IDEyOCA8PCAxMjsgeCA8PD0gMSkgeworCQlwLnZhbHVlID0geDsK
KwkJZ2VtX2NvbnRleHRfc2V0X3BhcmFtKGk5MTUsICZwKTsKKwkJZ2VtX2NvbnRleHRfZ2V0X3Bh
cmFtKGk5MTUsICZwKTsKKwkJaWd0X2Fzc2VydF9lcV91MzIocC52YWx1ZSwgeCk7CisJfQorCisJ
cC52YWx1ZSA9IHNhdmVkOworCWdlbV9jb250ZXh0X3NldF9wYXJhbShpOTE1LCAmcCk7Cit9CisK
K3N0YXRpYyB2b2lkIHRlc3RfaW52YWxpZChpbnQgaTkxNSkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX2NvbnRleHRfcGFyYW0gcCA9IHsKKwkJLnBhcmFtID0gSTkxNV9DT05URVhUX1BBUkFNX1JJ
TkdTSVpFLAorCX07CisJdWludDY0X3QgaW52YWxpZFtdID0geworCQkwLCAxLCA0MDk1LCA0MDk3
LCA4MTkxLCA4MTkzLAorCQkvKiB1cHBlciBsaW1pdCBtYXkgYmUgSFcgZGVwZW5kZW50LCBhdG0g
aXQgaXMgNTEyS2lCICovCisJCSg1MTIgPDwgMTApIC0gMSwgKDUxMiA8PCAxMCkgKyAxLAorCQkt
MSwgLTF1CisJfTsKKwl1aW50MzJfdCBzYXZlZDsKKworCS8qCisJICogVGhlIEhXIG9ubHkgYWNj
ZXB0cyBjZXJ0YWluIGFsaWduZWQgdmFsdWVzIGFuZCBzbyB3ZSByZWplY3QKKwkgKiBhbnkgaW52
YWxpZCBzaXplcyBzcGVjaWZpZWQgYnkgdGhlIHVzZXIuCisJICoKKwkgKiBDdXJyZW50bHksIHRo
ZSBIVyBvbmx5IGFjY2VwdHMgNEtpQiAtIDUxMktpQiBpbiA0SyBpbmNyZW1lbnRzLAorCSAqIGFu
ZCBpcyB1bmxpa2VseSB0byBldmVyIGFjY2VwdCBzbWFsbGVyLgorCSAqLworCisJZ2VtX2NvbnRl
eHRfZ2V0X3BhcmFtKGk5MTUsICZwKTsKKwlzYXZlZCA9IHAudmFsdWU7CisKKwlmb3IgKGludCBp
ID0gMDsgaSA8IEFSUkFZX1NJWkUoaW52YWxpZCk7IGkrKykgeworCQlwLnZhbHVlID0gaW52YWxp
ZFtpXTsKKwkJaWd0X2Fzc2VydF9lcShfX2dlbV9jb250ZXh0X3NldF9wYXJhbShpOTE1LCAmcCks
IC1FSU5WQUwpOworCQlnZW1fY29udGV4dF9nZXRfcGFyYW0oaTkxNSwgJnApOworCQlpZ3RfYXNz
ZXJ0X2VxX3U2NChwLnZhbHVlLCBzYXZlZCk7CisJfQorfQorCitzdGF0aWMgaW50IGNyZWF0ZV9l
eHRfaW9jdGwoaW50IGk5MTUsCisJCQkgICAgc3RydWN0IGRybV9pOTE1X2dlbV9jb250ZXh0X2Ny
ZWF0ZV9leHQgKmFyZykKK3sKKwlpbnQgZXJyOworCisJZXJyID0gMDsKKwlpZiAoaWd0X2lvY3Rs
KGk5MTUsIERSTV9JT0NUTF9JOTE1X0dFTV9DT05URVhUX0NSRUFURV9FWFQsIGFyZykpIHsKKwkJ
ZXJyID0gLWVycm5vOworCQlpZ3RfYXNzdW1lKGVycik7CisJfQorCisJZXJybm8gPSAwOworCXJl
dHVybiBlcnI7Cit9CisKK3N0YXRpYyB2b2lkIHRlc3RfY3JlYXRlKGludCBpOTE1KQoreworCXN0
cnVjdCBkcm1faTkxNV9nZW1fY29udGV4dF9jcmVhdGVfZXh0X3NldHBhcmFtIHAgPSB7CisJCS5i
YXNlID0geworCQkJLm5hbWUgPSBJOTE1X0NPTlRFWFRfQ1JFQVRFX0VYVF9TRVRQQVJBTSwKKwkJ
CS5uZXh0X2V4dGVuc2lvbiA9IDAsIC8qIGVuZCBvZiBjaGFpbiAqLworCQl9LAorCQkucGFyYW0g
PSB7CisJCQkucGFyYW0gPSBJOTE1X0NPTlRFWFRfUEFSQU1fUklOR1NJWkUsCisJCQkudmFsdWUg
PSA1MTIgPDwgMTAsCisJCX0KKwl9OworCXN0cnVjdCBkcm1faTkxNV9nZW1fY29udGV4dF9jcmVh
dGVfZXh0IGNyZWF0ZSA9IHsKKwkJLmZsYWdzID0gSTkxNV9DT05URVhUX0NSRUFURV9GTEFHU19V
U0VfRVhURU5TSU9OUywKKwkJLmV4dGVuc2lvbnMgPSB0b191c2VyX3BvaW50ZXIoJnApLAorCX07
CisKKwkvKgorCSAqIENoZWNrIHRoYXQgdGhlIHJpbmdzaXplIHBhcmFtZXRlciBpcyB1c2VkIGR1
cmluZyBjb250ZXh0IGNvbnN0dWN0aW9uLgorCSAqLworCisJaWd0X2Fzc2VydF9lcShjcmVhdGVf
ZXh0X2lvY3RsKGk5MTUsICZjcmVhdGUpLCAgMCk7CisKKwlwLnBhcmFtLmN0eF9pZCA9IGNyZWF0
ZS5jdHhfaWQ7CisJcC5wYXJhbS52YWx1ZSA9IDA7CisJZ2VtX2NvbnRleHRfZ2V0X3BhcmFtKGk5
MTUsICZwLnBhcmFtKTsKKwlpZ3RfYXNzZXJ0X2VxKHAucGFyYW0udmFsdWUsIDUxMiA8PCAxMCk7
CisKKwlnZW1fY29udGV4dF9kZXN0cm95KGk5MTUsIGNyZWF0ZS5jdHhfaWQpOworfQorCitzdGF0
aWMgdm9pZCB0ZXN0X2Nsb25lKGludCBpOTE1KQoreworCXN0cnVjdCBkcm1faTkxNV9nZW1fY29u
dGV4dF9jcmVhdGVfZXh0X3NldHBhcmFtIHAgPSB7CisJCS5iYXNlID0geworCQkJLm5hbWUgPSBJ
OTE1X0NPTlRFWFRfQ1JFQVRFX0VYVF9TRVRQQVJBTSwKKwkJCS5uZXh0X2V4dGVuc2lvbiA9IDAs
IC8qIGVuZCBvZiBjaGFpbiAqLworCQl9LAorCQkucGFyYW0gPSB7CisJCQkucGFyYW0gPSBJOTE1
X0NPTlRFWFRfUEFSQU1fUklOR1NJWkUsCisJCQkudmFsdWUgPSA1MTIgPDwgMTAsCisJCX0KKwl9
OworCXN0cnVjdCBkcm1faTkxNV9nZW1fY29udGV4dF9jcmVhdGVfZXh0IGNyZWF0ZSA9IHsKKwkJ
LmZsYWdzID0gSTkxNV9DT05URVhUX0NSRUFURV9GTEFHU19VU0VfRVhURU5TSU9OUywKKwkJLmV4
dGVuc2lvbnMgPSB0b191c2VyX3BvaW50ZXIoJnApLAorCX07CisKKwkvKgorCSAqIENoZWNrIHRo
YXQgdGhlIHJpbmdzaXplIGlzIGNvcGllZCBhY3Jvc3MgZHVyaW5nIGNvbnRleHQgY2xvbmluZy4K
KwkgKi8KKworCWlndF9hc3NlcnRfZXEoY3JlYXRlX2V4dF9pb2N0bChpOTE1LCAmY3JlYXRlKSwg
IDApOworCisJcC5wYXJhbS5jdHhfaWQgPSBnZW1fY29udGV4dF9jbG9uZShpOTE1LCBjcmVhdGUu
Y3R4X2lkLAorCQkJCQkgICBJOTE1X0NPTlRFWFRfQ0xPTkVfRU5HSU5FUywgMCk7CisJaWd0X2Fz
c2VydF9uZXEocC5wYXJhbS5jdHhfaWQsIGNyZWF0ZS5jdHhfaWQpOworCWdlbV9jb250ZXh0X2Rl
c3Ryb3koaTkxNSwgY3JlYXRlLmN0eF9pZCk7CisKKwlwLnBhcmFtLnZhbHVlID0gMDsKKwlnZW1f
Y29udGV4dF9nZXRfcGFyYW0oaTkxNSwgJnAucGFyYW0pOworCWlndF9hc3NlcnRfZXEocC5wYXJh
bS52YWx1ZSwgNTEyIDw8IDEwKTsKKworCWdlbV9jb250ZXh0X2Rlc3Ryb3koaTkxNSwgcC5wYXJh
bS5jdHhfaWQpOworfQorCitzdGF0aWMgaW50IF9fZXhlY2J1ZihpbnQgaTkxNSwgc3RydWN0IGRy
bV9pOTE1X2dlbV9leGVjYnVmZmVyMiAqZXhlY2J1ZikKK3sKKwlpbnQgZXJyOworCisJZXJyID0g
MDsKKwlpZiAoaW9jdGwoaTkxNSwgRFJNX0lPQ1RMX0k5MTVfR0VNX0VYRUNCVUZGRVIyLCBleGVj
YnVmKSkgeworCQllcnIgPSAtZXJybm87CisJCWlndF9hc3N1bWUoZXJyKTsKKwl9CisKKwllcnJu
byA9IDA7CisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIHVpbnQzMl90IF9fYmF0Y2hfY3JlYXRl
KGludCBpOTE1LCB1aW50MzJfdCBvZmZzZXQpCit7CisJY29uc3QgdWludDMyX3QgYmJlID0gMHhh
IDw8IDIzOworCXVpbnQzMl90IGhhbmRsZTsKKworCWhhbmRsZSA9IGdlbV9jcmVhdGUoaTkxNSwg
b2Zmc2V0ICsgc2l6ZW9mKGJiZSkpOworCWdlbV93cml0ZShpOTE1LCBoYW5kbGUsIG9mZnNldCwg
JmJiZSwgc2l6ZW9mKGJiZSkpOworCisJcmV0dXJuIGhhbmRsZTsKK30KKworc3RhdGljIHVpbnQz
Ml90IGJhdGNoX2NyZWF0ZShpbnQgaTkxNSkKK3sKKwlyZXR1cm4gX19iYXRjaF9jcmVhdGUoaTkx
NSwgMCk7Cit9CisKK3N0YXRpYyB1bnNpZ25lZCBpbnQgbWVhc3VyZV9pbmZsaWdodChpbnQgaTkx
NSwgdW5zaWduZWQgaW50IGVuZ2luZSwgaW50IHRpbWVvdXQpCit7CisJSUdUX0NPUktfRkVOQ0Uo
Y29yayk7CisJc3RydWN0IGRybV9pOTE1X2dlbV9leGVjX29iamVjdDIgb2JqID0geworCQkuaGFu
ZGxlID0gYmF0Y2hfY3JlYXRlKGk5MTUpCisJfTsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNi
dWZmZXIyIGV4ZWNidWYgPSB7CisJCS5idWZmZXJzX3B0ciA9IHRvX3VzZXJfcG9pbnRlcigmb2Jq
KSwKKwkJLmJ1ZmZlcl9jb3VudCA9IDEsCisJCS5mbGFncyA9IGVuZ2luZSB8IEk5MTVfRVhFQ19G
RU5DRV9JTiwKKwkJLnJzdmQyID0gaWd0X2NvcmtfcGx1ZygmY29yaywgaTkxNSksCisJfTsKKwl1
bnNpZ25lZCBpbnQgY291bnQ7CisJaW50IGVycjsKKworCWZjbnRsKGk5MTUsIEZfU0VURkwsIGZj
bnRsKGk5MTUsIEZfR0VURkwpIHwgT19OT05CTE9DSyk7CisJaWd0X3NldF90aW1lb3V0KHRpbWVv
dXQsICJleGVjYnVmIGJsb2NrZWQhIik7CisKKwlnZW1fZXhlY2J1ZihpOTE1LCAmZXhlY2J1Zik7
CisJZm9yIChjb3VudCA9IDE7IChlcnIgPSBfX2V4ZWNidWYoaTkxNSwgJmV4ZWNidWYpKSA9PSAw
OyBjb3VudCsrKQorCQk7CisJaWd0X2Fzc2VydF9lcShlcnIsIC1FV09VTERCTE9DSyk7CisJY2xv
c2UoZXhlY2J1Zi5yc3ZkMik7CisKKwlpZ3RfcmVzZXRfdGltZW91dCgpOworCWZjbnRsKGk5MTUs
IEZfU0VURkwsIGZjbnRsKGk5MTUsIEZfR0VURkwpICYgfk9fTk9OQkxPQ0spOworCisJaWd0X2Nv
cmtfdW5wbHVnKCZjb3JrKTsKKwlnZW1fY2xvc2UoaTkxNSwgb2JqLmhhbmRsZSk7CisKKwlyZXR1
cm4gY291bnQ7Cit9CisKK3N0YXRpYyB2b2lkIHRlc3RfcmVzaXplKGludCBpOTE1LAorCQkJY29u
c3Qgc3RydWN0IGludGVsX2V4ZWN1dGlvbl9lbmdpbmUyICplLAorCQkJdW5zaWduZWQgaW50IGZs
YWdzKQorI2RlZmluZSBJRExFICgxIDw8IDApCit7CisJc3RydWN0IGRybV9pOTE1X2dlbV9jb250
ZXh0X3BhcmFtIHAgPSB7CisJCS5wYXJhbSA9IEk5MTVfQ09OVEVYVF9QQVJBTV9SSU5HU0laRSwK
Kwl9OworCXVuc2lnbmVkIGludCBwcmV2WzJdID0ge307CisJdWludDY0X3QgZWxhcHNlZDsKKwl1
aW50MzJfdCBzYXZlZDsKKworCS8qCisJICogVGhlIHJpbmdzaXplIGRpcmVjdGx5IGFmZmVjdHMg
dGhlIG51bWJlciBvZiBiYXRjaGVzIHdlIGNhbiBoYXZlCisJICogaW5mbGlnaHQgLS0gd2hlbiB3
ZSBydW4gb3V0IG9mIHJvb20gaW4gdGhlIHJpbmcsIHRoZSBjbGllbnQgaXMKKwkgKiBibG9ja2Vk
IChvciBpZiBPX05PTkJMT0NLIGlzIHNwZWNpZmllZCwgLUVXT1VMREJMT0NLIGlzIHJlcG9ydGVk
KS4KKwkgKiBUaGUga2VybmVsIHRocm90dGxlcyB0aGUgY2xpZW50IHdoZW4gdGhleSBlbnRlciB0
aGUgbGFzdCA0S2lCIHBhZ2UsCisJICogc28gYXMgd2UgZG91YmxlIHRoZSBzaXplIG9mIHRoZSBy
aW5nLCB3ZSBuZWFybHkgZG91YmxlIHRoZSBudW1iZXIKKwkgKiBvZiByZXF1ZXN0cyB3ZSBjYW4g
Zml0IGFzIDJebi0xOiBpLmUgMCwgMSwgMywgNywgMTUsIDMxIHBhZ2VzLgorCSAqLworCisJZ2Vt
X2NvbnRleHRfZ2V0X3BhcmFtKGk5MTUsICZwKTsKKwlzYXZlZCA9IHAudmFsdWU7CisKKwllbGFw
c2VkID0gMDsKKwlnZW1fcXVpZXNjZW50X2dwdShpOTE1KTsKKwlmb3IgKHAudmFsdWUgPSAxIDw8
IDEyOyBwLnZhbHVlIDw9IDEyOCA8PCAxMjsgcC52YWx1ZSA8PD0gMSkgeworCQlzdHJ1Y3QgdGlt
ZXNwZWMgdHYgPSB7fTsKKwkJdW5zaWduZWQgaW50IGNvdW50OworCisJCWdlbV9jb250ZXh0X3Nl
dF9wYXJhbShpOTE1LCAmcCk7CisKKwkJaWd0X25zZWNfZWxhcHNlZCgmdHYpOworCQljb3VudCA9
IG1lYXN1cmVfaW5mbGlnaHQoaTkxNSwgZS0+ZmxhZ3MsIDEgKyBjZWlsKDIgKiBlbGFwc2VkKjFl
LTkpKTsKKwkJZWxhcHNlZCA9IGlndF9uc2VjX2VsYXBzZWQoJnR2KTsKKworCQlpZ3RfaW5mbygi
JXM6ICVsbHggLT4gJWRcbiIsIGUtPm5hbWUsIHAudmFsdWUsIGNvdW50KTsKKwkJaWd0X2Fzc2Vy
dChjb3VudCA+IDMgKiAocHJldlsxXSAtIHByZXZbMF0pIC8gNCArIHByZXZbMV0pOworCQlpZiAo
ZmxhZ3MgJiBJRExFKQorCQkJZ2VtX3F1aWVzY2VudF9ncHUoaTkxNSk7CisKKwkJcHJldlswXSA9
IHByZXZbMV07CisJCXByZXZbMV0gPSBjb3VudDsKKwl9CisJZ2VtX3F1aWVzY2VudF9ncHUoaTkx
NSk7CisKKwlwLnZhbHVlID0gc2F2ZWQ7CisJZ2VtX2NvbnRleHRfc2V0X3BhcmFtKGk5MTUsICZw
KTsKK30KKworaWd0X21haW4KK3sKKwljb25zdCBzdHJ1Y3QgaW50ZWxfZXhlY3V0aW9uX2VuZ2lu
ZTIgKmU7CisJaW50IGk5MTU7CisKKwlpZ3RfZml4dHVyZSB7CisJCWk5MTUgPSBkcm1fb3Blbl9k
cml2ZXIoRFJJVkVSX0lOVEVMKTsKKwkJaWd0X3JlcXVpcmVfZ2VtKGk5MTUpOworCisJCWlndF9y
ZXF1aXJlKGhhc19yaW5nc2l6ZShpOTE1KSk7CisJfQorCisJaWd0X3N1YnRlc3QoImlkZW1wb3Rl
bnQiKQorCQl0ZXN0X2lkZW1wb3RlbnQoaTkxNSk7CisKKwlpZ3Rfc3VidGVzdCgiaW52YWxpZCIp
CisJCXRlc3RfaW52YWxpZChpOTE1KTsKKworCWlndF9zdWJ0ZXN0KCJjcmVhdGUiKQorCQl0ZXN0
X2NyZWF0ZShpOTE1KTsKKwlpZ3Rfc3VidGVzdCgiY2xvbmUiKQorCQl0ZXN0X2Nsb25lKGk5MTUp
OworCisJX19mb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoaTkxNSwgZSkgeworCQlpZ3Rfc3VidGVz
dF9mKCIlcy1pZGxlIiwgZS0+bmFtZSkKKwkJCXRlc3RfcmVzaXplKGk5MTUsIGUsIElETEUpOwor
CQlpZ3Rfc3VidGVzdF9mKCIlcy1hY3RpdmUiLCBlLT5uYW1lKQorCQkJdGVzdF9yZXNpemUoaTkx
NSwgZSwgMCk7CisJfQorCisJaWd0X2ZpeHR1cmUgeworCQljbG9zZShpOTE1KTsKKwl9Cit9CmRp
ZmYgLS1naXQgYS90ZXN0cy9tZXNvbi5idWlsZCBiL3Rlc3RzL21lc29uLmJ1aWxkCmluZGV4IGZh
MDEwM2UzYS4uYzk0MGU4NWIwIDEwMDY0NAotLS0gYS90ZXN0cy9tZXNvbi5idWlsZAorKysgYi90
ZXN0cy9tZXNvbi5idWlsZApAQCAtMTI0LDYgKzEyNCw3IEBAIGk5MTVfcHJvZ3MgPSBbCiAJJ2dl
bV9jdHhfaXNvbGF0aW9uJywKIAknZ2VtX2N0eF9wYXJhbScsCiAJJ2dlbV9jdHhfcGVyc2lzdGVu
Y2UnLAorCSdnZW1fY3R4X3JpbmdzaXplJywKIAknZ2VtX2N0eF9zaGFyZWQnLAogCSdnZW1fY3R4
X3N3aXRjaCcsCiAJJ2dlbV9jdHhfdGhyYXNoJywKLS0gCjIuMjUuMQoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJ
bnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Au
b3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4Cg==

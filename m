Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id A7AC257D98
	for <lists+intel-gfx@lfdr.de>; Thu, 27 Jun 2019 10:01:03 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2D29C6E827;
	Thu, 27 Jun 2019 08:01:01 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga18.intel.com (mga18.intel.com [134.134.136.126])
 by gabe.freedesktop.org (Postfix) with ESMTPS id ADA186E827
 for <intel-gfx@lists.freedesktop.org>; Thu, 27 Jun 2019 08:00:55 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga004.jf.intel.com ([10.7.209.38])
 by orsmga106.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 27 Jun 2019 01:00:55 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,423,1557212400"; d="scan'208";a="313709812"
Received: from lswidere-mobl.ger.corp.intel.com (HELO
 delly.ger.corp.intel.com) ([10.249.140.121])
 by orsmga004.jf.intel.com with ESMTP; 27 Jun 2019 01:00:54 -0700
From: Lionel Landwerlin <lionel.g.landwerlin@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 27 Jun 2019 11:00:39 +0300
Message-Id: <20190627080045.8814-5-lionel.g.landwerlin@intel.com>
X-Mailer: git-send-email 2.21.0.392.gf8f6787159e
In-Reply-To: <20190627080045.8814-1-lionel.g.landwerlin@intel.com>
References: <20190627080045.8814-1-lionel.g.landwerlin@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v5 04/10] drm/i915/perf: implement active wait
 for noa configurations
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Tk9BIGNvbmZpZ3VyYXRpb24gdGFrZSBzb21lIGFtb3VudCBvZiB0aW1lIHRvIGFwcGx5LiBUaGF0
IGFtb3VudCBvZgp0aW1lIGRlcGVuZHMgb24gdGhlIHNpemUgb2YgdGhlIEdULiBUaGVyZSBpcyBu
byBkb2N1bWVudGVkIHRpbWUgZm9yCnRoaXMuIEZvciBleGFtcGxlLCBwYXN0IGV4cGVyaW1lbnRh
dGlvbnMgd2l0aCBwb3dlcmdhdGluZwpjb25maWd1cmF0aW9uIGNoYW5nZXMgc2VlbSB0byBpbmRp
Y2F0ZSBhIDYwfjcwdXMgZGVsYXkuIFdlIGdvIHdpdGgKNTAwdXMgYXMgZGVmYXVsdCBmb3Igbm93
IHdoaWNoIHNob3VsZCBiZSBvdmVyIHRoZSByZXF1aXJlZCBhbW91bnQgb2YKdGltZSAoYWNjb3Jk
aW5nIHRvIEhXIGFyY2hpdGVjdHMpLgoKU2lnbmVkLW9mZi1ieTogTGlvbmVsIExhbmR3ZXJsaW4g
PGxpb25lbC5nLmxhbmR3ZXJsaW5AaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2dwdV9jb21tYW5kcy5oIHwgIDI0ICsrKwogZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9kZWJ1Z2ZzLmMgICAgICAgICAgfCAgMjUgKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2Rydi5oICAgICAgICAgICAgICB8ICAgOCArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3BlcmYuYyAgICAgICAgICAgICB8IDE3OCArKysrKysrKysrKysrKysrKystCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3JlZy5oICAgICAgICAgICAgICB8ICAgNCArLQogNSBmaWxlcyBjaGFu
Z2VkLCAyMzYgaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ncHVfY29tbWFuZHMuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2dwdV9jb21tYW5kcy5oCmluZGV4IGU3ZWZmOWRiMzQzZS4uNGE2NmFm
MzhjODdiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ncHVfY29t
bWFuZHMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ncHVfY29tbWFuZHMu
aApAQCAtMTUxLDYgKzE1MSw3IEBACiAjZGVmaW5lICAgTUlfQkFUQ0hfR1RUCQkgICAgKDI8PDYp
IC8qIGFsaWFzZWQgd2l0aCAoMTw8Nykgb24gZ2VuNCAqLwogI2RlZmluZSBNSV9CQVRDSF9CVUZG
RVJfU1RBUlRfR0VOOAlNSV9JTlNUUigweDMxLCAxKQogI2RlZmluZSAgIE1JX0JBVENIX1JFU09V
UkNFX1NUUkVBTUVSICgxPDwxMCkKKyNkZWZpbmUgICBNSV9CQVRDSF9QUkVESUNBVEUgICAgICAg
ICAoMSA8PCAxNSkgLyogSFNXKyBvbiBSQ1Mgb25seSovCiAKIC8qCiAgKiAzRCBpbnN0cnVjdGlv
bnMgdXNlZCBieSB0aGUga2VybmVsCkBAIC0yMjYsNiArMjI3LDI5IEBACiAjZGVmaW5lICAgUElQ
RV9DT05UUk9MX0RFUFRIX0NBQ0hFX0ZMVVNICQkoMTw8MCkKICNkZWZpbmUgICBQSVBFX0NPTlRS
T0xfR0xPQkFMX0dUVCAoMTw8MikgLyogaW4gYWRkciBkd29yZCAqLwogCisjZGVmaW5lIE1JX01B
VEgoeCkgTUlfSU5TVFIoMHgxYSwgKHgpLTEpCisjZGVmaW5lICAgTUlfQUxVX09QKG9wLCBzcmMx
LCBzcmMyKSAoKChvcCkgPDwgMjApIHwgKChzcmMxKSA8PCAxMCkgfCAoc3JjMikpCisvKiBvcGVy
YW5kcyAqLworI2RlZmluZSAgIE1JX0FMVV9PUF9OT09QICAgICAwCisjZGVmaW5lICAgTUlfQUxV
X09QX0xPQUQgICAgIDEyOAorI2RlZmluZSAgIE1JX0FMVV9PUF9MT0FESU5WICAxMTUyCisjZGVm
aW5lICAgTUlfQUxVX09QX0xPQUQwICAgIDEyOQorI2RlZmluZSAgIE1JX0FMVV9PUF9MT0FEMSAg
ICAxMTUzCisjZGVmaW5lICAgTUlfQUxVX09QX0FERCAgICAgIDI1NgorI2RlZmluZSAgIE1JX0FM
VV9PUF9TVUIgICAgICAyNTcKKyNkZWZpbmUgICBNSV9BTFVfT1BfQU5EICAgICAgMjU4CisjZGVm
aW5lICAgTUlfQUxVX09QX09SICAgICAgIDI1OQorI2RlZmluZSAgIE1JX0FMVV9PUF9YT1IgICAg
ICAyNjAKKyNkZWZpbmUgICBNSV9BTFVfT1BfU1RPUkUgICAgMzg0CisjZGVmaW5lICAgTUlfQUxV
X09QX1NUT1JFSU5WIDE0MDgKKy8qIHNvdXJjZXMgKi8KKyNkZWZpbmUgICBNSV9BTFVfU1JDX1JF
Ryh4KSAgKHgpIC8qIDAgLT4gMTUgKi8KKyNkZWZpbmUgICBNSV9BTFVfU1JDX1NSQ0EgICAgMzIK
KyNkZWZpbmUgICBNSV9BTFVfU1JDX1NSQ0IgICAgMzMKKyNkZWZpbmUgICBNSV9BTFVfU1JDX0FD
Q1UgICAgNDkKKyNkZWZpbmUgICBNSV9BTFVfU1JDX1pGICAgICAgNTAKKyNkZWZpbmUgICBNSV9B
TFVfU1JDX0NGICAgICAgNTEKKwogLyoKICAqIENvbW1hbmRzIHVzZWQgb25seSBieSB0aGUgY29t
bWFuZCBwYXJzZXIKICAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9k
ZWJ1Z2ZzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwppbmRleCBlZWVj
ZGFkMGUzY2EuLjZiNDlmZGExNDVlNyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9kZWJ1Z2ZzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMK
QEAgLTM2NDYsNiArMzY0NiwzMCBAQCBERUZJTkVfU0lNUExFX0FUVFJJQlVURShpOTE1X3dlZGdl
ZF9mb3BzLAogCQkJaTkxNV93ZWRnZWRfZ2V0LCBpOTE1X3dlZGdlZF9zZXQsCiAJCQkiJWxsdVxu
Iik7CiAKK3N0YXRpYyBpbnQKK2k5MTVfcGVyZl9ub2FfZGVsYXlfc2V0KHZvaWQgKmRhdGEsIHU2
NCB2YWwpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkYXRhOworCisJYXRv
bWljNjRfc2V0KCZpOTE1LT5wZXJmLm9hLm5vYV9wcm9ncmFtbWluZ19kZWxheSwgdmFsKTsKKwly
ZXR1cm4gMDsKK30KKworc3RhdGljIGludAoraTkxNV9wZXJmX25vYV9kZWxheV9nZXQodm9pZCAq
ZGF0YSwgdTY0ICp2YWwpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkYXRh
OworCisJKnZhbCA9IGF0b21pYzY0X3JlYWQoJmk5MTUtPnBlcmYub2Eubm9hX3Byb2dyYW1taW5n
X2RlbGF5KTsKKwlyZXR1cm4gMDsKK30KKworREVGSU5FX1NJTVBMRV9BVFRSSUJVVEUoaTkxNV9w
ZXJmX25vYV9kZWxheV9mb3BzLAorCQkJaTkxNV9wZXJmX25vYV9kZWxheV9nZXQsCisJCQlpOTE1
X3BlcmZfbm9hX2RlbGF5X3NldCwKKwkJCSIlbGx1XG4iKTsKKworCiAjZGVmaW5lIERST1BfVU5C
T1VORAlCSVQoMCkKICNkZWZpbmUgRFJPUF9CT1VORAlCSVQoMSkKICNkZWZpbmUgRFJPUF9SRVRJ
UkUJQklUKDIpCkBAIC00NDExLDYgKzQ0MzUsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVf
ZGVidWdmc19maWxlcyB7CiAJY29uc3QgY2hhciAqbmFtZTsKIAljb25zdCBzdHJ1Y3QgZmlsZV9v
cGVyYXRpb25zICpmb3BzOwogfSBpOTE1X2RlYnVnZnNfZmlsZXNbXSA9IHsKKwl7Imk5MTVfcGVy
Zl9ub2FfZGVsYXkiLCAmaTkxNV9wZXJmX25vYV9kZWxheV9mb3BzfSwKIAl7Imk5MTVfd2VkZ2Vk
IiwgJmk5MTVfd2VkZ2VkX2ZvcHN9LAogCXsiaTkxNV9jYWNoZV9zaGFyaW5nIiwgJmk5MTVfY2Fj
aGVfc2hhcmluZ19mb3BzfSwKIAl7Imk5MTVfZ2VtX2Ryb3BfY2FjaGVzIiwgJmk5MTVfZHJvcF9j
YWNoZXNfZm9wc30sCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5o
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAppbmRleCAzMzNjYzNjNzY5MGMuLjAz
MjNjODE4MmE2NyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCkBAIC0xODM1LDYgKzE4MzUsMTQg
QEAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgewogCiAJCQlzdHJ1Y3QgaTkxNV9vYV9vcHMgb3Bz
OwogCQkJY29uc3Qgc3RydWN0IGk5MTVfb2FfZm9ybWF0ICpvYV9mb3JtYXRzOworCisJCQkvKioK
KwkJCSAqIEEgYmF0Y2ggYnVmZmVyIGRvaW5nIGEgd2FpdCBvbiB0aGUgR1BVIGZvciB0aGUgTk9B
CisJCQkgKiBsb2dpYyB0byBiZSByZXByb2dyYW1tZWQuCisJCQkgKi8KKwkJCXN0cnVjdCBpOTE1
X3ZtYSAqbm9hX3dhaXQ7CisKKwkJCWF0b21pYzY0X3Qgbm9hX3Byb2dyYW1taW5nX2RlbGF5Owog
CQl9IG9hOwogCX0gcGVyZjsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9wZXJmLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYwppbmRleCAyZjFkYzli
ZTNiZmIuLmIyZjViYTg3OTIxYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9wZXJmLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMKQEAgLTQxMCw2
ICs0MTAsOCBAQCBzdGF0aWMgaW50IGFsbG9jX29hX2NvbmZpZ19idWZmZXIoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCiAJc2l6ZV90IGNvbmZpZ19sZW5ndGggPSAwOwogCXUzMiAqY3M7
CiAKKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKKwogCWlm
IChvYV9jb25maWctPm11eF9yZWdzX2xlbiA+IDApIHsKIAkJY29uZmlnX2xlbmd0aCArPSBESVZf
Uk9VTkRfVVAob2FfY29uZmlnLT5tdXhfcmVnc19sZW4sCiAJCQkJCSAgICAgIE1JX0xPQURfUkVH
SVNURVJfSU1NX01BWF9SRUdTKSAqIDQ7CkBAIC00MjUsNyArNDI3LDcgQEAgc3RhdGljIGludCBh
bGxvY19vYV9jb25maWdfYnVmZmVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCQkJ
CQkgICAgICBNSV9MT0FEX1JFR0lTVEVSX0lNTV9NQVhfUkVHUykgKiA0OwogCQljb25maWdfbGVu
Z3RoICs9IG9hX2NvbmZpZy0+ZmxleF9yZWdzX2xlbiAqIDg7CiAJfQotCWNvbmZpZ19sZW5ndGgg
Kz0gNDsgLyogTUlfQkFUQ0hfQlVGRkVSX0VORCAqLworCWNvbmZpZ19sZW5ndGggKz0gMTI7IC8q
IE1JX0JBVENIX0JVRkZFUl9TVEFSVCBpbnRvIG5vYV93YWl0IGxvb3AgKi8KIAljb25maWdfbGVu
Z3RoID0gQUxJR04oY29uZmlnX2xlbmd0aCwgSTkxNV9HVFRfUEFHRV9TSVpFKTsKIAogCWJvID0g
aTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zaG1lbShpOTE1LCBjb25maWdfbGVuZ3RoKTsKQEAgLTQ0
Miw3ICs0NDQsMTIgQEAgc3RhdGljIGludCBhbGxvY19vYV9jb25maWdfYnVmZmVyKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAogCWNzID0gd3JpdGVfY3NfbWlfbHJpKGNzLCBvYV9jb25m
aWctPmJfY291bnRlcl9yZWdzLCBvYV9jb25maWctPmJfY291bnRlcl9yZWdzX2xlbik7CiAJY3Mg
PSB3cml0ZV9jc19taV9scmkoY3MsIG9hX2NvbmZpZy0+ZmxleF9yZWdzLCBvYV9jb25maWctPmZs
ZXhfcmVnc19sZW4pOwogCi0JKmNzKysgPSBNSV9CQVRDSF9CVUZGRVJfRU5EOworCisJLyogSnVt
cCBpbnRvIHRoZSBOT0Egd2FpdCBidXN5IGxvb3AuICovCisJKmNzKysgPSAoSU5URUxfR0VOKGk5
MTUpIDwgOCA/CisJCSBNSV9CQVRDSF9CVUZGRVJfU1RBUlQgOiBNSV9CQVRDSF9CVUZGRVJfU1RB
UlRfR0VOOCk7CisJKmNzKysgPSBpOTE1LT5wZXJmLm9hLm5vYV93YWl0LT5ub2RlLnN0YXJ0Owor
CSpjcysrID0gMDsKIAogCWk5MTVfZ2VtX29iamVjdF9mbHVzaF9tYXAoYm8pOwogCWk5MTVfZ2Vt
X29iamVjdF91bnBpbl9tYXAoYm8pOwpAQCAtMTQ2NSw2ICsxNDcyLDcgQEAgc3RhdGljIHZvaWQg
aTkxNV9vYV9zdHJlYW1fZGVzdHJveShzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtKQog
CW11dGV4X2xvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKIAlkZXZfcHJpdi0+cGVy
Zi5vYS5leGNsdXNpdmVfc3RyZWFtID0gTlVMTDsKIAlkZXZfcHJpdi0+cGVyZi5vYS5vcHMuZGlz
YWJsZV9tZXRyaWNfc2V0KGRldl9wcml2KTsKKwlpOTE1X3ZtYV91bnBpbl9hbmRfcmVsZWFzZSgm
ZGV2X3ByaXYtPnBlcmYub2Eubm9hX3dhaXQsIDApOwogCW11dGV4X3VubG9jaygmZGV2X3ByaXYt
PmRybS5zdHJ1Y3RfbXV0ZXgpOwogCiAJZnJlZV9vYV9idWZmZXIoZGV2X3ByaXYpOwpAQCAtMTY1
MSw2ICsxNjU5LDE1NiBAQCBzdGF0aWMgaW50IGFsbG9jX29hX2J1ZmZlcihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJcmV0dXJuIHJldDsKIH0KIAorc3RhdGljIGludCBhbGxv
Y19ub2Ffd2FpdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKK3sKKwlzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdCAqYm87CisJc3RydWN0IGk5MTVfdm1hICp2bWE7CisJdTY0IGRlbGF5
X25zID0gYXRvbWljNjRfcmVhZCgmaTkxNS0+cGVyZi5vYS5ub2FfcHJvZ3JhbW1pbmdfZGVsYXkp
LCBkZWxheV90aWNrczsKKwl1MzIgKmJhdGNoLCAqY3MsICpqdW1wOworCWludCByZXQ7CisKKwli
byA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfc2htZW0oaTkxNSwgNDA5Nik7CisJaWYgKElTX0VS
UihibykpIHsKKwkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gYWxsb2NhdGUgTk9BIHdhaXQgYmF0Y2hi
dWZmZXJcbiIpOworCQlyZXR1cm4gUFRSX0VSUihibyk7CisJfQorCisJLyoKKwkgKiBXZSBwaW4g
aW4gR0dUVCBiZWNhdXNlIHdlIGp1bXAgaW50byB0aGlzIGJ1ZmZlciBub3cgYmVjYXVzZQorCSAq
IG11bHRpcGxlIE9BIGNvbmZpZyBCT3Mgd2lsbCBoYXZlIGEganVtcCB0byB0aGlzIGFkZHJlc3Mg
YW5kIGl0CisJICogbmVlZHMgdG8gYmUgZml4ZWQgZHVyaW5nIHRoZSBsaWZldGltZSBvZiB0aGUg
aTkxNS9wZXJmIHN0cmVhbS4KKwkgKi8KKwl2bWEgPSBpOTE1X2dlbV9vYmplY3RfZ2d0dF9waW4o
Ym8sIE5VTEwsIDAsIDQwOTYsIDApOworCWlmIChJU19FUlIodm1hKSkgeworCQlyZXQgPSBQVFJf
RVJSKHZtYSk7CisJCWdvdG8gZXJyX3VucmVmOworCX0KKworCWJhdGNoID0gY3MgPSBpOTE1X2dl
bV9vYmplY3RfcGluX21hcChibywgSTkxNV9NQVBfV0IpOworCWlmIChJU19FUlIoYmF0Y2gpKSB7
CisJCXJldCA9IFBUUl9FUlIoYmF0Y2gpOworCQlnb3RvIGVycl91bnBpbjsKKwl9CisKKwkvKgor
CSAqIEluaXRpYWwgc25hcHNob3Qgb2YgdGhlIHRpbWVzdGFtcCByZWdpc3RlciB0byBpbXBsZW1l
bnQgdGhlIHdhaXQuCisJICogV2Ugd29yayB3aXRoIDMyYiB2YWx1ZXMsIHNvIGNsZWFyIG91dCB0
aGUgdG9wIDMyYiBiaXRzIG9mIHRoZQorCSAqIHJlZ2lzdGVyIGJlY2F1c2UgdGhlIEFMVSB3b3Jr
cyA2NGJpdHMuCisJICovCisJKmNzKysgPSBNSV9MT0FEX1JFR0lTVEVSX0lNTSgxKTsKKwkqY3Mr
KyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEhTV19DU19HUFIoMCkpICsgNDsKKwkqY3MrKyA9IDA7
CisJKmNzKysgPSBNSV9MT0FEX1JFR0lTVEVSX1JFRyB8ICgzIC0gMik7CisJKmNzKysgPSBpOTE1
X21taW9fcmVnX29mZnNldChSSU5HX1RJTUVTVEFNUChSRU5ERVJfUklOR19CQVNFKSk7CisJKmNz
KysgPSBpOTE1X21taW9fcmVnX29mZnNldChIU1dfQ1NfR1BSKDApKTsKKworCS8qCisJICogVGhp
cyBpcyB0aGUgbG9jYXRpb24gd2UncmUgZ29pbmcgdG8ganVtcCBiYWNrIGludG8gdW50aWwgdGhl
CisJICogcmVxdWlyZWQgYW1vdW50IG9mIHRpbWUgaGFzIHBhc3NlZC4KKwkgKi8KKwlqdW1wID0g
Y3M7CisKKwkvKgorCSAqIFRha2UgYW5vdGhlciBzbmFwc2hvdCBvZiB0aGUgdGltZXN0YW1wIHJl
Z2lzdGVyLiBUYWtlIGNhcmUgdG8gY2xlYXIKKwkgKiB1cCB0aGUgdG9wIDMyYml0cyBvZiBDU19H
UFIoMSkgYXMgd2UncmUgdXNpbmcgaXQgZm9yIG90aGVyCisJICogb3BlcmF0aW9ucyBiZWxvdy4K
KwkgKi8KKwkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKDEpOworCSpjcysrID0gaTkxNV9t
bWlvX3JlZ19vZmZzZXQoSFNXX0NTX0dQUigxKSkgKyA0OworCSpjcysrID0gMDsKKwkqY3MrKyA9
IE1JX0xPQURfUkVHSVNURVJfUkVHIHwgKDMgLSAyKTsKKwkqY3MrKyA9IGk5MTVfbW1pb19yZWdf
b2Zmc2V0KFJJTkdfVElNRVNUQU1QKFJFTkRFUl9SSU5HX0JBU0UpKTsKKwkqY3MrKyA9IGk5MTVf
bW1pb19yZWdfb2Zmc2V0KEhTV19DU19HUFIoMSkpOworCisJLyoKKwkgKiBEbyBhIGRpZmYgYmV0
d2VlbiB0aGUgMiB0aW1lc3RhbXBzIGFuZCBzdG9yZSB0aGUgcmVzdWx0IGJhY2sgaW50bworCSAq
IENTX0dQUigxKS4KKwkgKi8KKwkqY3MrKyA9IE1JX01BVEgoNSk7CisJKmNzKysgPSBNSV9BTFVf
T1AoTUlfQUxVX09QX0xPQUQsIE1JX0FMVV9TUkNfU1JDQSwgTUlfQUxVX1NSQ19SRUcoMSkpOwor
CSpjcysrID0gTUlfQUxVX09QKE1JX0FMVV9PUF9MT0FELCBNSV9BTFVfU1JDX1NSQ0IsIE1JX0FM
VV9TUkNfUkVHKDApKTsKKwkqY3MrKyA9IE1JX0FMVV9PUChNSV9BTFVfT1BfU1VCLCAwLCAwKTsK
KwkqY3MrKyA9IE1JX0FMVV9PUChNSV9BTFVfT1BfU1RPUkUsIE1JX0FMVV9TUkNfUkVHKDIpLCBN
SV9BTFVfU1JDX0FDQ1UpOworCSpjcysrID0gTUlfQUxVX09QKE1JX0FMVV9PUF9TVE9SRSwgTUlf
QUxVX1NSQ19SRUcoMyksIE1JX0FMVV9TUkNfQ0YpOworCisJLyoKKwkgKiBUcmFuc2ZlciB0aGUg
Y2FycnkgZmxhZyAoc2V0IHRvIDEgaWYgdHMxIDwgdHMwLCBtZWFuaW5nIHRoZQorCSAqIHRpbWVz
dGFtcCBoYXZlIHJvbGxlZCBvdmVyIHRoZSAzMmJpdHMpIGludG8gdGhlIHByZWRpY2F0ZSByZWdp
c3RlcgorCSAqIHRvIGJlIHVzZWQgZm9yIHRoZSBwcmVkaWNhdGVkIGp1bXAuCisJICovCisJKmNz
KysgPSBNSV9MT0FEX1JFR0lTVEVSX1JFRyB8ICgzIC0gMik7CisJKmNzKysgPSBpOTE1X21taW9f
cmVnX29mZnNldChIU1dfQ1NfR1BSKDMpKTsKKwkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0
KE1JX1BSRURJQ0FURV9SRVNVTFRfMSk7CisKKwkvKiBSZXN0YXJ0IGZyb20gdGhlIGJlZ2lubmlu
ZyBpZiB3ZSBoYWQgdGltZXN0YW1wcyByb2xsIG92ZXIuICovCisJKmNzKysgPSAoSU5URUxfR0VO
KGk5MTUpIDwgOCA/CisJCSBNSV9CQVRDSF9CVUZGRVJfU1RBUlQgOiBNSV9CQVRDSF9CVUZGRVJf
U1RBUlRfR0VOOCkgfAorCQlNSV9CQVRDSF9QUkVESUNBVEU7CisJKmNzKysgPSB2bWEtPm5vZGUu
c3RhcnQ7CisJKmNzKysgPSAwOworCisJLyoKKwkgKiBOb3cgYWRkIHRoZSBkaWZmIGJldHdlZW4g
dG8gcHJldmlvdXMgdGltZXN0YW1wcyBhbmQgYWRkIGl0IHRvIDoKKwkgKiAgICAgICgoKDEgKiA8
PCA2NCkgLSAxKSAtIGRlbGF5X25zKQorCSAqCisJICogV2hlbiB0aGUgQ2FycnkgRmxhZyBjb250
YWlucyAxIHRoaXMgbWVhbnMgdGhlIGVsYXBzZWQgdGltZSBpcworCSAqIGxvbmdlciB0aGFuIHRo
ZSBleHBlY3RlZCBkZWxheSwgYW5kIHdlIGNhbiBleGl0IHRoZSB3YWl0IGxvb3AuCisJICovCisJ
ZGVsYXlfdGlja3MgPSAweGZmZmZmZmZmZmZmZmZmZmYgLQorCQlESVY2NF9VNjRfUk9VTkRfVVAo
ZGVsYXlfbnMgKgorCQkJCSAgIFJVTlRJTUVfSU5GTyhpOTE1KS0+Y3NfdGltZXN0YW1wX2ZyZXF1
ZW5jeV9raHosCisJCQkJICAgMTAwMDAwMHVsbCk7CisJKmNzKysgPSBNSV9MT0FEX1JFR0lTVEVS
X0lNTSgyKTsKKwkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEhTV19DU19HUFIoNCkpOwor
CSpjcysrID0gbG93ZXJfMzJfYml0cyhkZWxheV90aWNrcyk7CisJKmNzKysgPSBpOTE1X21taW9f
cmVnX29mZnNldChIU1dfQ1NfR1BSKDQpKSArIDQ7CisJKmNzKysgPSB1cHBlcl8zMl9iaXRzKGRl
bGF5X3RpY2tzKTsKKworCSpjcysrID0gTUlfTUFUSCg0KTsKKwkqY3MrKyA9IE1JX0FMVV9PUChN
SV9BTFVfT1BfTE9BRCwgTUlfQUxVX1NSQ19TUkNBLCBNSV9BTFVfU1JDX1JFRygyKSk7CisJKmNz
KysgPSBNSV9BTFVfT1AoTUlfQUxVX09QX0xPQUQsIE1JX0FMVV9TUkNfU1JDQiwgTUlfQUxVX1NS
Q19SRUcoNCkpOworCSpjcysrID0gTUlfQUxVX09QKE1JX0FMVV9PUF9BREQsIDAsIDApOworCSpj
cysrID0gTUlfQUxVX09QKE1JX0FMVV9PUF9TVE9SRUlOViwgTUlfQUxVX1NSQ19SRUcoNSksIE1J
X0FMVV9TUkNfQ0YpOworCisJLyoKKwkgKiBUcmFuc2ZlciB0aGUgcmVzdWx0IGludG8gdGhlIHBy
ZWRpY2F0ZSByZWdpc3RlciB0byBiZSB1c2VkIGZvciB0aGUKKwkgKiBwcmVkaWNhdGVkIGp1bXAu
CisJICovCisJKmNzKysgPSBNSV9MT0FEX1JFR0lTVEVSX1JFRyB8ICgzIC0gMik7CisJKmNzKysg
PSBpOTE1X21taW9fcmVnX29mZnNldChIU1dfQ1NfR1BSKDUpKTsKKwkqY3MrKyA9IGk5MTVfbW1p
b19yZWdfb2Zmc2V0KE1JX1BSRURJQ0FURV9SRVNVTFRfMSk7CisKKwkvKiBQcmVkaWNhdGUgdGhl
IGp1bXAuICAqLworCSpjcysrID0gKElOVEVMX0dFTihpOTE1KSA8IDggPworCQkgTUlfQkFUQ0hf
QlVGRkVSX1NUQVJUIDogTUlfQkFUQ0hfQlVGRkVSX1NUQVJUX0dFTjgpIHwKKwkJTUlfQkFUQ0hf
UFJFRElDQVRFOworCSpjcysrID0gdm1hLT5ub2RlLnN0YXJ0ICsgKGp1bXAgLSBiYXRjaCkgKiA0
OworCSpjcysrID0gMDsKKworCS8qIENsZWFyIHRoZSBwcmVkaWNhdGUgcmVnaXN0ZXIgKi8KKwkq
Y3MrKyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKDEpOworCSpjcysrID0gaTkxNV9tbWlvX3JlZ19v
ZmZzZXQoTUlfUFJFRElDQVRFX1JFU1VMVF8xKTsKKwkqY3MrKyA9IDA7CisKKwkvKiBBbmQgcmV0
dXJuIHRvIHRoZSByaW5nLiAqLworCSpjcysrID0gTUlfQkFUQ0hfQlVGRkVSX0VORDsKKworCWk5
MTVfZ2VtX29iamVjdF9mbHVzaF9tYXAoYm8pOworCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAo
Ym8pOworCisJaTkxNS0+cGVyZi5vYS5ub2Ffd2FpdCA9IHZtYTsKKworCXJldHVybiAwOworCitl
cnJfdW5waW46CisJX19pOTE1X3ZtYV91bnBpbih2bWEpOworCitlcnJfdW5yZWY6CisJaTkxNV9n
ZW1fb2JqZWN0X3B1dChibyk7CisKKwlyZXR1cm4gcmV0OworfQorCiBzdGF0aWMgdm9pZCBjb25m
aWdfb2FfcmVncyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJCQkgICBjb25z
dCBzdHJ1Y3QgaTkxNV9vYV9yZWcgKnJlZ3MsCiAJCQkgICB1MzIgbl9yZWdzKQpAQCAtMjIxOSw2
ICsyMzc3LDEyIEBAIHN0YXRpYyBpbnQgaTkxNV9vYV9zdHJlYW1faW5pdChzdHJ1Y3QgaTkxNV9w
ZXJmX3N0cmVhbSAqc3RyZWFtLAogCQlnb3RvIGVycl9jb25maWc7CiAJfQogCisJcmV0ID0gYWxs
b2Nfbm9hX3dhaXQoZGV2X3ByaXYpOworCWlmIChyZXQpIHsKKwkJRFJNX0RFQlVHKCJVbmFibGUg
dG8gYWxsb2NhdGUgTk9BIHdhaXQgYmF0Y2ggYnVmZmVyXG4iKTsKKwkJZ290byBlcnJfbm9hX3dh
aXRfYWxsb2M7CisJfQorCiAJLyogUFJNIC0gb2JzZXJ2YWJpbGl0eSBwZXJmb3JtYW5jZSBjb3Vu
dGVyczoKIAkgKgogCSAqICAgT0FDT05UUk9MLCBwZXJmb3JtYW5jZSBjb3VudGVyIGVuYWJsZSwg
bm90ZToKQEAgLTIyNzEsNiArMjQzNSwxMyBAQCBzdGF0aWMgaW50IGk5MTVfb2Ffc3RyZWFtX2lu
aXQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSwKIAlpbnRlbF91bmNvcmVfZm9yY2V3
YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7CiAJaW50ZWxfcnVudGlt
ZV9wbV9wdXQoJmRldl9wcml2LT5ydW50aW1lX3BtLCBzdHJlYW0tPndha2VyZWYpOwogCisJbXV0
ZXhfbG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCWk5MTVfdm1hX3VucGluX2Fu
ZF9yZWxlYXNlKCZkZXZfcHJpdi0+cGVyZi5vYS5ub2Ffd2FpdCwgMCk7CisJbXV0ZXhfdW5sb2Nr
KCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7CisKK2Vycl9ub2Ffd2FpdF9hbGxvYzoKKwlp
OTE1X29hX2NvbmZpZ19wdXQoc3RyZWFtLT5vYV9jb25maWcpOworCiBlcnJfY29uZmlnOgogCWlm
IChzdHJlYW0tPmN0eCkKIAkJb2FfcHV0X3JlbmRlcl9jdHhfaWQoc3RyZWFtKTsKQEAgLTM2NDIs
NiArMzgxMyw5IEBAIHZvaWQgaTkxNV9wZXJmX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQogCQltdXRleF9pbml0KCZkZXZfcHJpdi0+cGVyZi5tZXRyaWNzX2xvY2spOwog
CQlpZHJfaW5pdCgmZGV2X3ByaXYtPnBlcmYubWV0cmljc19pZHIpOwogCisJCWF0b21pYzY0X3Nl
dCgmZGV2X3ByaXYtPnBlcmYub2Eubm9hX3Byb2dyYW1taW5nX2RlbGF5LAorCQkJICAgICA1MDAg
KiAxMDAwIC8qIDUwMHVzICovKTsKKwogCQlkZXZfcHJpdi0+cGVyZi5pbml0aWFsaXplZCA9IHRy
dWU7CiAJfQogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZWcuaCBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVnLmgKaW5kZXggN2U2MDA5Y2VmYjE4Li5lMTJi
MmZjY2VmNzAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVnLmgKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZWcuaApAQCAtNTY3LDcgKzU2Nyw5IEBAIHN0
YXRpYyBpbmxpbmUgYm9vbCBpOTE1X21taW9fcmVnX3ZhbGlkKGk5MTVfcmVnX3QgcmVnKQogI2Rl
ZmluZSBNSV9QUkVESUNBVEVfU1JDMF9VRFcJX01NSU8oMHgyNDAwICsgNCkKICNkZWZpbmUgTUlf
UFJFRElDQVRFX1NSQzEJX01NSU8oMHgyNDA4KQogI2RlZmluZSBNSV9QUkVESUNBVEVfU1JDMV9V
RFcJX01NSU8oMHgyNDA4ICsgNCkKLQorI2RlZmluZSBNSV9QUkVESUNBVEVfREFUQSAgICAgICBf
TU1JTygweDI0MTApCisjZGVmaW5lIE1JX1BSRURJQ0FURV9SRVNVTFQgICAgIF9NTUlPKDB4MjQx
OCkKKyNkZWZpbmUgTUlfUFJFRElDQVRFX1JFU1VMVF8xICAgX01NSU8oMHgyNDFjKQogI2RlZmlu
ZSBNSV9QUkVESUNBVEVfUkVTVUxUXzIJX01NSU8oMHgyMjE0KQogI2RlZmluZSAgTE9XRVJfU0xJ
Q0VfRU5BQkxFRAkoMSA8PCAwKQogI2RlZmluZSAgTE9XRVJfU0xJQ0VfRElTQUJMRUQJKDAgPDwg
MCkKLS0gCjIuMjEuMC4zOTIuZ2Y4ZjY3ODcxNTllCgpfX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBs
aXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1h
bi9saXN0aW5mby9pbnRlbC1nZng=

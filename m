Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 25E24B8F22
	for <lists+intel-gfx@lfdr.de>; Fri, 20 Sep 2019 13:42:55 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 927476FC9E;
	Fri, 20 Sep 2019 11:42:49 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mblankhorst.nl (mblankhorst.nl
 [IPv6:2a02:2308::216:3eff:fe92:dfa3])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9FA4C6FC9D
 for <intel-gfx@lists.freedesktop.org>; Fri, 20 Sep 2019 11:42:43 +0000 (UTC)
From: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 20 Sep 2019 13:42:29 +0200
Message-Id: <20190920114235.22411-17-maarten.lankhorst@linux.intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190920114235.22411-1-maarten.lankhorst@linux.intel.com>
References: <20190920114235.22411-1-maarten.lankhorst@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 17/23] drm/i915: Add intel_update_bigjoiner
 handling.
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RW5hYmxpbmcgaXMgZG9uZSBpbiBhIHNwZWNpYWwgc2VxdWVuY2UgYW5kIHRvIGJlIGZhaXIsIHNv
IHNob3VsZApwbGFuZSB1cGRhdGVzIGJlLiBJZGVhbGx5IHRoZSBlbmQgdXNlciBuZXZlciBub3Rp
Y2VzIHRoZSBzZWNvbmQKcGlwZSBpcyB1c2VkLCBzbyB1c2UgdGhlIHZibGFuayBldmFzaW9uIHRv
IGNvdmVyIGJvdGggcGlwZXMuCgpUaGlzIHdheSBpZGVhbGx5IGV2ZXJ5dGhpbmcgd2lsbCBiZSB0
ZWFyIGZyZWUsIGFuZCB1cGRhdGVzIGFyZQpyZWFsbHkgYXRvbWljIGFzIHVzZXJzcGFjZSBleHBl
Y3RzIGl0LgoKVGhlIGRpc2FibGUgc2VxdWVuY2Ugc3RpbGwgbmVlZHMgc29tZSBsb3ZlLCBidXQg
b3RoZXJ3aXNlIGJpZ2pvaW5lcgppcyBjbG9zZSB0byByZWFkeSBub3cuCgpTaWduZWQtb2ZmLWJ5
OiBNYWFydGVuIExhbmtob3JzdCA8bWFhcnRlbi5sYW5raG9yc3RAbGludXguaW50ZWwuY29tPgot
LS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jIHwgMTE4ICsr
KysrKysrKysrKysrKystLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3By
aXRlLmMgIHwgIDIyICsrKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3By
aXRlLmggIHwgICAzICstCiAzIGZpbGVzIGNoYW5nZWQsIDEyMyBpbnNlcnRpb25zKCspLCAyMCBk
ZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX2Rpc3BsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxh
eS5jCmluZGV4IGFjYjNjNTk3NGU5OS4uN2Y4NmMzNThjZjQ1IDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwpAQCAtMTQyMzAsNyArMTQyMzAsNyBAQCBz
dGF0aWMgdm9pZCBpbnRlbF91cGRhdGVfY3J0YyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKIAll
bHNlCiAJCWk5eHhfdXBkYXRlX3BsYW5lc19vbl9jcnRjKHN0YXRlLCBjcnRjKTsKIAotCWludGVs
X3BpcGVfdXBkYXRlX2VuZChuZXdfY3J0Y19zdGF0ZSk7CisJaW50ZWxfcGlwZV91cGRhdGVfZW5k
KG5ld19jcnRjX3N0YXRlLCBOVUxMKTsKIAogCWlmIChuZXdfY3J0Y19zdGF0ZS0+dXBkYXRlX3Bp
cGUgJiYgIW1vZGVzZXQgJiYKIAkgICAgb2xkX2NydGNfc3RhdGUtPmh3Lm1vZGUucHJpdmF0ZV9m
bGFncyAmIEk5MTVfTU9ERV9GTEFHX0lOSEVSSVRFRCkKQEAgLTE0MzEyLDYgKzE0MzEyLDU2IEBA
IHN0YXRpYyB2b2lkIGludGVsX2NvbW1pdF9tb2Rlc2V0X2Rpc2FibGVzKHN0cnVjdCBpbnRlbF9h
dG9taWNfc3RhdGUgKnN0YXRlKQogCX0KIH0KIAorc3RhdGljIHZvaWQgaW50ZWxfdXBkYXRlX2Jp
Z2pvaW5lcihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKKwkJCQkgICBzdHJ1Y3QgaW50ZWxfYXRv
bWljX3N0YXRlICpzdGF0ZSwKKwkJCQkgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2Ny
dGNfc3RhdGUsCisJCQkJICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRl
KQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoc3RhdGUt
PmJhc2UuZGV2KTsKKwlib29sIG1vZGVzZXQgPSBuZWVkc19tb2Rlc2V0KG5ld19jcnRjX3N0YXRl
KTsKKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqc2xhdmUgPSBuZXdfY3J0Y19zdGF0ZS0+Ymlnam9pbmVy
X2xpbmtlZF9jcnRjOworCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpuZXdfc2xhdmVfY3J0Y19z
dGF0ZSA9CisJCWludGVsX2F0b21pY19nZXRfbmV3X2NydGNfc3RhdGUoc3RhdGUsIHNsYXZlKTsK
KwlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX3NsYXZlX2NydGNfc3RhdGUgPQorCQlpbnRl
bF9hdG9taWNfZ2V0X29sZF9jcnRjX3N0YXRlKHN0YXRlLCBzbGF2ZSk7CisKKwlpZiAobW9kZXNl
dCkgeworCQkvKiBFbmFibGUgc2xhdmUgZmlyc3QgKi8KKwkJdXBkYXRlX3NjYW5saW5lX29mZnNl
dChuZXdfc2xhdmVfY3J0Y19zdGF0ZSk7CisJCWRybV9jYWxjX3RpbWVzdGFtcGluZ19jb25zdGFu
dHMoJnNsYXZlLT5iYXNlLCAmbmV3X3NsYXZlX2NydGNfc3RhdGUtPmh3LnRyYW5zY29kZXJfbW9k
ZSk7CisJCWRldl9wcml2LT5kaXNwbGF5LmNydGNfZW5hYmxlKG5ld19zbGF2ZV9jcnRjX3N0YXRl
LCBzdGF0ZSk7CisKKwkJLyogVGhlbiBtYXN0ZXIgKi8KKwkJdXBkYXRlX3NjYW5saW5lX29mZnNl
dChuZXdfY3J0Y19zdGF0ZSk7CisJCWRybV9jYWxjX3RpbWVzdGFtcGluZ19jb25zdGFudHMoJmNy
dGMtPmJhc2UsICZuZXdfY3J0Y19zdGF0ZS0+aHcudHJhbnNjb2Rlcl9tb2RlKTsKKwkJZGV2X3By
aXYtPmRpc3BsYXkuY3J0Y19lbmFibGUobmV3X2NydGNfc3RhdGUsIHN0YXRlKTsKKworCQkvKiB2
YmxhbmtzIHdvcmsgYWdhaW4sIHJlLWVuYWJsZSBwaXBlIENSQy4gKi8KKwkJaW50ZWxfY3J0Y19l
bmFibGVfcGlwZV9jcmMoY3J0Yyk7CisKKwl9IGVsc2UgeworCQlpbnRlbF9wcmVfcGxhbmVfdXBk
YXRlKG9sZF9jcnRjX3N0YXRlLCBuZXdfY3J0Y19zdGF0ZSk7CisJCWludGVsX3ByZV9wbGFuZV91
cGRhdGUob2xkX3NsYXZlX2NydGNfc3RhdGUsIG5ld19zbGF2ZV9jcnRjX3N0YXRlKTsKKworCQlp
ZiAobmV3X2NydGNfc3RhdGUtPnVwZGF0ZV9waXBlKQorCQkJaW50ZWxfZW5jb2RlcnNfdXBkYXRl
X3BpcGUoY3J0YywgbmV3X2NydGNfc3RhdGUsIHN0YXRlKTsKKwl9CisKKwkvKgorCSAqIFBlcmZv
cm0gdmJsYW5rIGV2YXNpb24gYXJvdW5kIGNvbW1pdCBvcGVyYXRpb24sIGFuZCBtYWtlIHN1cmUg
dG8KKwkgKiBjb21taXQgYm90aCBwbGFuZXMgc2ltdWx0YW5lb3VzbHkgZm9yIGJlc3QgcmVzdWx0
cy4KKwkgKi8KKwlpbnRlbF9waXBlX3VwZGF0ZV9zdGFydChuZXdfY3J0Y19zdGF0ZSk7CisKKwlj
b21taXRfcGlwZV9jb25maWcoc3RhdGUsIG9sZF9jcnRjX3N0YXRlLCBuZXdfY3J0Y19zdGF0ZSk7
CisJY29tbWl0X3BpcGVfY29uZmlnKHN0YXRlLCBvbGRfc2xhdmVfY3J0Y19zdGF0ZSwgbmV3X3Ns
YXZlX2NydGNfc3RhdGUpOworCisJc2tsX3VwZGF0ZV9wbGFuZXNfb25fY3J0YyhzdGF0ZSwgY3J0
Yyk7CisJaWNsX3VwZGF0ZV9iaWdqb2luZXJfcGxhbmVzX29uX2NydGMoc3RhdGUsIHNsYXZlKTsK
KworCWludGVsX3BpcGVfdXBkYXRlX2VuZChuZXdfY3J0Y19zdGF0ZSwgbmV3X3NsYXZlX2NydGNf
c3RhdGUpOworfQorCiBzdGF0aWMgdm9pZCBpbnRlbF9jb21taXRfbW9kZXNldF9lbmFibGVzKHN0
cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQogewogCXN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjOwpAQCAtMTQzMzAsNyArMTQzODAsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9jb21taXRfbW9k
ZXNldF9lbmFibGVzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQogc3RhdGljIHZv
aWQgc2tsX2NvbW1pdF9tb2Rlc2V0X2VuYWJsZXMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAq
c3RhdGUpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShz
dGF0ZS0+YmFzZS5kZXYpOwotCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOworCXN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjLCAqc2xhdmU7CiAJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRj
X3N0YXRlLCAqbmV3X2NydGNfc3RhdGU7CiAJdW5zaWduZWQgaW50IHVwZGF0ZWQgPSAwOwogCWJv
b2wgcHJvZ3Jlc3M7CkBAIC0xNDMzOSwxMSArMTQzODksNDcgQEAgc3RhdGljIHZvaWQgc2tsX2Nv
bW1pdF9tb2Rlc2V0X2VuYWJsZXMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCiAJ
dTggaHdfZW5hYmxlZF9zbGljZXMgPSBkZXZfcHJpdi0+d20uc2tsX2h3LmRkYi5lbmFibGVkX3Ns
aWNlczsKIAl1OCByZXF1aXJlZF9zbGljZXMgPSBzdGF0ZS0+d21fcmVzdWx0cy5kZGIuZW5hYmxl
ZF9zbGljZXM7CiAJc3RydWN0IHNrbF9kZGJfZW50cnkgZW50cmllc1tJOTE1X01BWF9QSVBFU10g
PSB7fTsKKwlzdHJ1Y3Qgc2tsX2RkYl9lbnRyeSBuZXdfZW50cmllc1tJOTE1X01BWF9QSVBFU10g
PSB7fTsKKwljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqc2xhdmVfY3J0Y19zdGF0ZTsK
Kwl1MzIgZGlydHlfcGlwZXMgPSBzdGF0ZS0+d21fcmVzdWx0cy5kaXJ0eV9waXBlczsKKworCWZv
cl9lYWNoX29sZG5ld19pbnRlbF9jcnRjX2luX3N0YXRlKHN0YXRlLCBjcnRjLCBvbGRfY3J0Y19z
dGF0ZSwgbmV3X2NydGNfc3RhdGUsIGkpIHsKKwkJaWYgKG5ld19jcnRjX3N0YXRlLT5iaWdqb2lu
ZXJfc2xhdmUpIHsKKwkJCS8qIGNsZWFyIGRpcnR5IGJpdCwgd2UncmUgdXBkYXRlZCBpbiBtYXN0
ZXIgKi8KKwkJCWRpcnR5X3BpcGVzICY9IH5kcm1fY3J0Y19tYXNrKCZjcnRjLT5iYXNlKTsKKwkJ
CWNvbnRpbnVlOworCQl9CisKKwkJaWYgKG5ld19jcnRjX3N0YXRlLT5ody5hY3RpdmUpIHsKKwkJ
CWlmIChuZXdfY3J0Y19zdGF0ZS0+Ymlnam9pbmVyKSB7CisJCQkJc2xhdmUgPSBuZXdfY3J0Y19z
dGF0ZS0+Ymlnam9pbmVyX2xpbmtlZF9jcnRjOworCQkJCXNsYXZlX2NydGNfc3RhdGUgPQorCQkJ
CQlpbnRlbF9hdG9taWNfZ2V0X25ld19jcnRjX3N0YXRlKHN0YXRlLAorCQkJCQkJCQkJc2xhdmUp
OworCisJCQkJLyogcHV0IGJvdGggZW50cmllcyBpbiAqLworCQkJCW5ld19lbnRyaWVzW2ldLnN0
YXJ0ID0gbmV3X2NydGNfc3RhdGUtPndtLnNrbC5kZGIuc3RhcnQ7CisJCQkJbmV3X2VudHJpZXNb
aV0uZW5kID0gc2xhdmVfY3J0Y19zdGF0ZS0+d20uc2tsLmRkYi5lbmQ7CisJCQl9IGVsc2Ugewor
CQkJCW5ld19lbnRyaWVzW2ldID0gbmV3X2NydGNfc3RhdGUtPndtLnNrbC5kZGI7CisJCQl9CisJ
CX0KIAotCWZvcl9lYWNoX29sZG5ld19pbnRlbF9jcnRjX2luX3N0YXRlKHN0YXRlLCBjcnRjLCBv
bGRfY3J0Y19zdGF0ZSwgbmV3X2NydGNfc3RhdGUsIGkpCiAJCS8qIGlnbm9yZSBhbGxvY2F0aW9u
cyBmb3IgY3J0YydzIHRoYXQgaGF2ZSBiZWVuIHR1cm5lZCBvZmYuICovCi0JCWlmIChuZXdfY3J0
Y19zdGF0ZS0+aHcuYWN0aXZlKQorCQlpZiAoIW5ld19jcnRjX3N0YXRlLT5ody5hY3RpdmUgfHwg
bmVlZHNfbW9kZXNldChuZXdfY3J0Y19zdGF0ZSkpCisJCQljb250aW51ZTsKKworCQlpZiAob2xk
X2NydGNfc3RhdGUtPmJpZ2pvaW5lcikgeworCQkJc2xhdmUgPSBvbGRfY3J0Y19zdGF0ZS0+Ymln
am9pbmVyX2xpbmtlZF9jcnRjOworCQkJc2xhdmVfY3J0Y19zdGF0ZSA9CisJCQkJaW50ZWxfYXRv
bWljX2dldF9vbGRfY3J0Y19zdGF0ZShzdGF0ZSwgc2xhdmUpOworCisJCQllbnRyaWVzW2ldLnN0
YXJ0ID0gb2xkX2NydGNfc3RhdGUtPndtLnNrbC5kZGIuc3RhcnQ7CisJCQllbnRyaWVzW2ldLmVu
ZCA9IHNsYXZlX2NydGNfc3RhdGUtPndtLnNrbC5kZGIuZW5kOworCQl9IGVsc2UgewogCQkJZW50
cmllc1tpXSA9IG9sZF9jcnRjX3N0YXRlLT53bS5za2wuZGRiOworCQl9CisJfQogCiAJLyogSWYg
Mm5kIERCdWYgc2xpY2UgcmVxdWlyZWQsIGVuYWJsZSBpdCBoZXJlICovCiAJaWYgKElOVEVMX0dF
TihkZXZfcHJpdikgPj0gMTEgJiYgcmVxdWlyZWRfc2xpY2VzID4gaHdfZW5hYmxlZF9zbGljZXMp
CkBAIC0xNDM2NCwxNiArMTQ0NTAsMTUgQEAgc3RhdGljIHZvaWQgc2tsX2NvbW1pdF9tb2Rlc2V0
X2VuYWJsZXMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCiAKIAkJCXBpcGUgPSBj
cnRjLT5waXBlOwogCi0JCQlpZiAodXBkYXRlZCAmIGNtYXNrIHx8ICFuZXdfY3J0Y19zdGF0ZS0+
aHcuYWN0aXZlKQorCQkJaWYgKHVwZGF0ZWQgJiBjbWFzayB8fCAhbmV3X2NydGNfc3RhdGUtPmh3
LmFjdGl2ZSB8fAorCQkJICAgIG5ld19jcnRjX3N0YXRlLT5iaWdqb2luZXJfc2xhdmUpCiAJCQkJ
Y29udGludWU7CiAKLQkJCWlmIChza2xfZGRiX2FsbG9jYXRpb25fb3ZlcmxhcHMoJm5ld19jcnRj
X3N0YXRlLT53bS5za2wuZGRiLAotCQkJCQkJCWVudHJpZXMsCisJCQlpZiAoc2tsX2RkYl9hbGxv
Y2F0aW9uX292ZXJsYXBzKCZuZXdfZW50cmllc1tpXSwgZW50cmllcywKIAkJCQkJCQlJTlRFTF9O
VU1fUElQRVMoZGV2X3ByaXYpLCBpKSkKIAkJCQljb250aW51ZTsKIAogCQkJdXBkYXRlZCB8PSBj
bWFzazsKLQkJCWVudHJpZXNbaV0gPSBuZXdfY3J0Y19zdGF0ZS0+d20uc2tsLmRkYjsKIAogCQkJ
LyoKIAkJCSAqIElmIHRoaXMgaXMgYW4gYWxyZWFkeSBhY3RpdmUgcGlwZSwgaXQncyBEREIgY2hh
bmdlZCwKQEAgLTE0MzgxLDE4ICsxNDQ2NiwyMyBAQCBzdGF0aWMgdm9pZCBza2xfY29tbWl0X21v
ZGVzZXRfZW5hYmxlcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKIAkJCSAqIHRo
ZW4gd2UgbmVlZCB0byB3YWl0IGZvciBhIHZibGFuayB0byBwYXNzIGZvciB0aGUKIAkJCSAqIG5l
dyBkZGIgYWxsb2NhdGlvbiB0byB0YWtlIGVmZmVjdC4KIAkJCSAqLwotCQkJaWYgKCFza2xfZGRi
X2VudHJ5X2VxdWFsKCZuZXdfY3J0Y19zdGF0ZS0+d20uc2tsLmRkYiwKLQkJCQkJCSAmb2xkX2Ny
dGNfc3RhdGUtPndtLnNrbC5kZGIpICYmCi0JCQkgICAgIW5ld19jcnRjX3N0YXRlLT51YXBpLmFj
dGl2ZV9jaGFuZ2VkICYmCi0JCQkgICAgc3RhdGUtPndtX3Jlc3VsdHMuZGlydHlfcGlwZXMgIT0g
dXBkYXRlZCkKKwkJCWlmICghc2tsX2RkYl9lbnRyeV9lcXVhbCgmZW50cmllc1tpXSwgJm5ld19l
bnRyaWVzW2ldKSAmJgorCQkJICAgICFuZWVkc19tb2Rlc2V0KG5ld19jcnRjX3N0YXRlKSAmJgor
CQkJICAgIGRpcnR5X3BpcGVzICE9IHVwZGF0ZWQpCiAJCQkJdmJsX3dhaXQgPSB0cnVlOwogCi0J
CQlpbnRlbF91cGRhdGVfY3J0YyhjcnRjLCBzdGF0ZSwgb2xkX2NydGNfc3RhdGUsCi0JCQkJCSAg
bmV3X2NydGNfc3RhdGUpOworCQkJaWYgKG5ld19jcnRjX3N0YXRlLT5iaWdqb2luZXIpCisJCQkJ
aW50ZWxfdXBkYXRlX2JpZ2pvaW5lcihjcnRjLCBzdGF0ZSwKKwkJCQkJCSAgICAgICBvbGRfY3J0
Y19zdGF0ZSwKKwkJCQkJCSAgICAgICBuZXdfY3J0Y19zdGF0ZSk7CisJCQllbHNlCisJCQkJaW50
ZWxfdXBkYXRlX2NydGMoY3J0Yywgc3RhdGUsIG9sZF9jcnRjX3N0YXRlLAorCQkJCQkJICBuZXdf
Y3J0Y19zdGF0ZSk7CiAKIAkJCWlmICh2Ymxfd2FpdCkKIAkJCQlpbnRlbF93YWl0X2Zvcl92Ymxh
bmsoZGV2X3ByaXYsIHBpcGUpOwogCisJCQllbnRyaWVzW2ldID0gbmV3X2VudHJpZXNbaV07CiAJ
CQlwcm9ncmVzcyA9IHRydWU7CiAJCX0KIAl9IHdoaWxlIChwcm9ncmVzcyk7CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nwcml0ZS5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zcHJpdGUuYwppbmRleCBiY2E3ZmY4YTg5MDcuLjkz
MzdmNWE4ZGNlMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9zcHJpdGUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nwcml0
ZS5jCkBAIC05OCw2ICs5OCw4IEBAIHZvaWQgaW50ZWxfcGlwZV91cGRhdGVfc3RhcnQoY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQogCiAJLyogRklYTUUgbmVl
ZHMgdG8gYmUgY2FsaWJyYXRlZCBzZW5zaWJseSAqLwogCW1pbiA9IHZibGFua19zdGFydCAtIGlu
dGVsX3VzZWNzX3RvX3NjYW5saW5lcyhhZGp1c3RlZF9tb2RlLAorCQkJCQkJICAgICAgbmV3X2Ny
dGNfc3RhdGUtPmJpZ2pvaW5lciA/CisJCQkJCQkgICAgICAyICogVkJMQU5LX0VWQVNJT05fVElN
RV9VUyA6CiAJCQkJCQkgICAgICBWQkxBTktfRVZBU0lPTl9USU1FX1VTKTsKIAltYXggPSB2Ymxh
bmtfc3RhcnQgLSAxOwogCkBAIC0xODgsNyArMTkwLDggQEAgdm9pZCBpbnRlbF9waXBlX3VwZGF0
ZV9zdGFydChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUpCiAg
KiByZS1lbmFibGVzIGludGVycnVwdHMgYW5kIHZlcmlmaWVzIHRoZSB1cGRhdGUgd2FzIGFjdHVh
bGx5IGNvbXBsZXRlZAogICogYmVmb3JlIGEgdmJsYW5rLgogICovCi12b2lkIGludGVsX3BpcGVf
dXBkYXRlX2VuZChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUpCit2b2lk
IGludGVsX3BpcGVfdXBkYXRlX2VuZChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNf
c3RhdGUsCisJCQkgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqc2xhdmVfY3J0Y19zdGF0ZSkK
IHsKIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMobmV3X2NydGNfc3Rh
dGUtPnVhcGkuY3J0Yyk7CiAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwpAQCAtMjAzLDE1
ICsyMDYsMjQgQEAgdm9pZCBpbnRlbF9waXBlX3VwZGF0ZV9lbmQoc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKm5ld19jcnRjX3N0YXRlKQogCSAqIFdvdWxkIGJlIHNsaWdodGx5IG5pY2UgdG8ganVz
dCBncmFiIHRoZSB2YmxhbmsgY291bnQgYW5kIGFybSB0aGUKIAkgKiBldmVudCBvdXRzaWRlIG9m
IHRoZSBjcml0aWNhbCBzZWN0aW9uIC0gdGhlIHNwaW5sb2NrIG1pZ2h0IHNwaW4gZm9yIGEKIAkg
KiB3aGlsZSAuLi4gKi8KLQlpZiAobmV3X2NydGNfc3RhdGUtPnVhcGkuZXZlbnQpIHsKLQkJV0FS
Tl9PTihkcm1fY3J0Y192YmxhbmtfZ2V0KCZjcnRjLT5iYXNlKSAhPSAwKTsKKwlpZiAobmV3X2Ny
dGNfc3RhdGUtPnVhcGkuZXZlbnQgfHwgKHNsYXZlX2NydGNfc3RhdGUgJiYgc2xhdmVfY3J0Y19z
dGF0ZS0+dWFwaS5ldmVudCkpIHsKKwkJaWYgKG5ld19jcnRjX3N0YXRlLT51YXBpLmV2ZW50KQor
CQkJV0FSTl9PTihkcm1fY3J0Y192YmxhbmtfZ2V0KCZjcnRjLT5iYXNlKSAhPSAwKTsKKwkJaWYg
KHNsYXZlX2NydGNfc3RhdGUgJiYgc2xhdmVfY3J0Y19zdGF0ZS0+dWFwaS5ldmVudCkKKwkJCVdB
Uk5fT04oZHJtX2NydGNfdmJsYW5rX2dldCgmY3J0Yy0+YmFzZSkgIT0gMCk7CiAKIAkJc3Bpbl9s
b2NrKCZjcnRjLT5iYXNlLmRldi0+ZXZlbnRfbG9jayk7Ci0JCWRybV9jcnRjX2FybV92Ymxhbmtf
ZXZlbnQoJmNydGMtPmJhc2UsCi0JCQkJICAgICAgICAgIG5ld19jcnRjX3N0YXRlLT51YXBpLmV2
ZW50KTsKKwkJaWYgKG5ld19jcnRjX3N0YXRlLT51YXBpLmV2ZW50KQorCQkJZHJtX2NydGNfYXJt
X3ZibGFua19ldmVudCgmY3J0Yy0+YmFzZSwKKwkJCQkJCSAgbmV3X2NydGNfc3RhdGUtPnVhcGku
ZXZlbnQpOworCQlpZiAoc2xhdmVfY3J0Y19zdGF0ZSAmJiBzbGF2ZV9jcnRjX3N0YXRlLT51YXBp
LmV2ZW50KQorCQkJZHJtX2NydGNfYXJtX3ZibGFua19ldmVudCgmY3J0Yy0+YmFzZSwKKwkJCQkJ
CSAgc2xhdmVfY3J0Y19zdGF0ZS0+dWFwaS5ldmVudCk7CiAJCXNwaW5fdW5sb2NrKCZjcnRjLT5i
YXNlLmRldi0+ZXZlbnRfbG9jayk7CiAKIAkJbmV3X2NydGNfc3RhdGUtPnVhcGkuZXZlbnQgPSBO
VUxMOworCQlpZiAoc2xhdmVfY3J0Y19zdGF0ZSkKKwkJCXNsYXZlX2NydGNfc3RhdGUtPnVhcGku
ZXZlbnQgPSBOVUxMOwogCX0KIAogCWxvY2FsX2lycV9lbmFibGUoKTsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3ByaXRlLmggYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nwcml0ZS5oCmluZGV4IDIyOTMzNjIxNGY2OC4uNmRmNjJm
YWU5MzY4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nw
cml0ZS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3ByaXRlLmgK
QEAgLTI0LDcgKzI0LDggQEAgc3RydWN0IGludGVsX3BsYW5lICppbnRlbF9zcHJpdGVfcGxhbmVf
Y3JlYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIGludCBpbnRlbF9zcHJp
dGVfc2V0X2NvbG9ya2V5X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEs
CiAJCQkJICAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wcml2KTsKIHZvaWQgaW50ZWxfcGlwZV91
cGRhdGVfc3RhcnQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRl
KTsKLXZvaWQgaW50ZWxfcGlwZV91cGRhdGVfZW5kKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpu
ZXdfY3J0Y19zdGF0ZSk7Cit2b2lkIGludGVsX3BpcGVfdXBkYXRlX2VuZChzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUsCisJCQkgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqc2xhdmVfY3J0Y19zdGF0ZSk7CiBpbnQgaW50ZWxfcGxhbmVfY2hlY2tfc3RyaWRlKGNvbnN0
IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpOwogaW50IGludGVsX3BsYW5l
X2NoZWNrX3NyY19jb29yZGluYXRlcyhzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0
YXRlKTsKIGludCBjaHZfcGxhbmVfY2hlY2tfcm90YXRpb24oY29uc3Qgc3RydWN0IGludGVsX3Bs
YW5lX3N0YXRlICpwbGFuZV9zdGF0ZSk7Ci0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwt
Z2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9t
YWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

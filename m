Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8381413D6C3
	for <lists+intel-gfx@lfdr.de>; Thu, 16 Jan 2020 10:24:39 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CD5826EC5E;
	Thu, 16 Jan 2020 09:24:37 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga06.intel.com (mga06.intel.com [134.134.136.31])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7F64B6EC5E
 for <intel-gfx@lists.freedesktop.org>; Thu, 16 Jan 2020 09:24:34 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga007.jf.intel.com ([10.7.209.58])
 by orsmga104.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 16 Jan 2020 01:24:34 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.70,325,1574150400"; d="scan'208";a="214016841"
Received: from slisovsk-lenovo-ideapad-720s-13ikb.fi.intel.com ([10.237.72.89])
 by orsmga007.jf.intel.com with ESMTP; 16 Jan 2020 01:24:32 -0800
From: Stanislav Lisovskiy <stanislav.lisovskiy@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 16 Jan 2020 11:22:12 +0200
Message-Id: <20200116092214.2342-4-stanislav.lisovskiy@intel.com>
X-Mailer: git-send-email 2.24.1.485.gad05a3d8e5
In-Reply-To: <20200116092214.2342-1-stanislav.lisovskiy@intel.com>
References: <20200116092214.2342-1-stanislav.lisovskiy@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v12 3/5] drm/i915: Manipulate DBuf slices
 properly
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

U3RhcnQgbWFuaXB1bGF0aW5nIERCdWYgc2xpY2VzIGFzIGEgbWFzaywKYnV0IG5vdCBhcyBhIHRv
dGFsIG51bWJlciwgYXMgY3VycmVudCBhcHByb2FjaApkb2Vzbid0IGdpdmUgdXMgZnVsbCBjb250
cm9sIG9uIGFsbCBjb21iaW5hdGlvbnMKb2Ygc2xpY2VzLCB3aGljaCB3ZSBtaWdodCBuZWVkKGxp
a2UgZW5hYmxpbmcgUzIKb25seSBjYW4ndCBlbmFibGVkIGJ5IHNldHRpbmcgZW5hYmxlZF9zbGlj
ZXM9MSkuCgpSZW1vdmVkIHdyb25nIGNvZGUgZnJvbSBpbnRlbF9nZXRfZGRiX3NpemUgYXMKaXQg
ZG9lc24ndCBtYXRjaCB0byBCU3BlYy4gRm9yIG5vdyBzdGlsbCBqdXN0CnVzZSBEQnVmIHNsaWNl
IHVudGlsIHByb3BlciBhbGdvcml0aG0gaXMgaW1wbGVtZW50ZWQuCgpPdGhlciBtaW5vciBjb2Rl
IHJlZmFjdG9yaW5nIHRvIGdldCBwcmVwYXJlZApmb3IgbWFqb3IgREJ1ZiBhc3NpZ25tZW50IGNo
YW5nZXMgbGFuZGVkOgotIEFzIG5vdyBlbmFibGVkIHNsaWNlcyBjb250YWluIGEgbWFzawogIHdl
IHN0aWxsIG5lZWQgc29tZSB2YWx1ZSB3aGljaCBzaG91bGQKICByZWZsZWN0IGhvdyBtdWNoIERC
dWYgc2xpY2VzIGFyZSBzdXBwb3J0ZWQKICBieSB0aGUgcGxhdGZvcm0sIG5vdyBkZXZpY2UgaW5m
byBjb250YWlucwogIG51bV9zdXBwb3J0ZWRfZGJ1Zl9zbGljZXMuCi0gUmVtb3ZlZCB1bm5lZWRl
ZCBhc3NlcnRpb24gYXMgd2UgYXJlIG5vdwogIG1hbmlwdWxhdGluZyBzbGljZXMgaW4gYSBtb3Jl
IHByb3BlciB3YXkuCgp2MjogU3RhcnQgdXNpbmcgZW5hYmxlZF9zbGljZXMgaW4gZGV2X3ByaXYK
CnYzOiAiZW5hYmxlZF9zbGljZXMiIGlzIG5vdyAiZW5hYmxlZF9kYnVmX3NsaWNlc19tYXNrIiwK
ICAgIGFzIHRoaXMgbm93IHNpdHMgaW4gZGV2X3ByaXYgaW5kZXBlbmRlbnRseS4KCnY0OiAtIEZp
eGVkIGRlYnVnIHByaW50IGZvcm1hdHRpbmcgdG8gaGV4KE1hdHQgUm9wZXIpCiAgICAtIE9wdGlt
aXplZCBkYnVmIHNsaWNlIHVwZGF0ZXMgdG8gYmUgdXNlZCBvbmx5CiAgICAgIGlmIHNsaWNlIHVu
aW9uIGlzIGRpZmZlcmVudCBmcm9tIGN1cnJlbnQgY29uZihNYXR0IFJvcGVyKQogICAgLSBGaXhl
ZCBzb21lIGZ1bmN0aW9ucyB0byBiZSBzdGF0aWMoTWF0dCBSb3BlcikKICAgIC0gQ3JlYXRlZCBh
IHBhcmFtZXRlcml6ZWQgdmVyc2lvbiBmb3IgREJVRl9DVEwgdG8KICAgICAgc2ltcGxpZnkgREJ1
ZiBwcm9ncmFtbWluZyBjeWNsZShNYXR0IFJvcGVyKQogICAgLSBSZW1vdmVkIHVucmVxdXJlZCBm
aWVsZCBmcm9tIEdFTjEwX0ZFQVRVUkVTKE1hdHQgUm9wZXIpCgp2NTogLSBSZW1vdmVkIHJlZHVu
ZGFudCBwcm9ncmFtbWluZyBkYnVmIHNsaWNlcyBoZWxwZXIoVmlsbGUgU3lyasOkbMOkKQogICAg
LSBTdGFydGVkIHRvIHVzZSBwYXJhbWV0ZXJpemVkIGxvb3AgZm9yIGh3IHJlYWRvdXQgdG8gZ2V0
IHNsaWNlcwogICAgICAoVmlsbGUgU3lyasOkbMOkKQogICAgLSBBZGRlZCBiYWNrIGFzc2VydGlv
biBjaGVja2luZyBhbW91bnQgb2YgREJVRiBzbGljZXMgZW5hYmxlZAogICAgICBhZnRlciBEQyBz
dGF0ZXMgNS82IHRyYW5zaXRpb24sIGFsc28gYWRkZWQgbmV3IGFzc2VydGlvbgogICAgICBhcyBz
dGFydGluZyBmcm9tIElDTCBETUMgc2VlbXMgdG8gcmVzdG9yZSB0aGUgbGFzdCBEQnVmCiAgICAg
IHBvd2VyIHN0YXRlIHNldCwgcmF0aGVyIHRoYW4gcG93ZXIgdXAgYWxsIGRidWYgc2xpY2VzCiAg
ICAgIGFzIGFzc2VydGlvbiB3YXMgcHJldmlvdXNseSBleHBlY3RpbmcoVmlsbGUgU3lyasOkbMOk
KQoKdjY6IC0gTm93IHVzaW5nIGVudW0gZm9yIERCdWYgc2xpY2VzIGluIHRoaXMgcGF0Y2ggKFZp
bGxlIFN5cmrDpGzDpCkKICAgIC0gUmVtb3ZlZCBnZW4xMV9hc3NlcnRfZGJ1Zl9lbmFibGVkIGFu
ZCBwdXQgZ2VuOV9hc3NlcnRfZGJ1Zl9lbmFibGVkCiAgICAgIGJhY2ssIGFzIHdlIHJlYWxseSBu
ZWVkIHRvIGhhdmUgYSBzaW5nbGUgdW5pZmllZCBhc3NlcnQgaGVyZQogICAgICBob3dldmVyIGN1
cnJlbnRseSBlbmFibGluZyBhbHdheXMgc2xpY2UgMSBpcyBlbmZvcmNlZCBieSBCU3BlYywKICAg
ICAgc28gd2Ugd2lsbCBoYXZlIHRvIE9SIGVuYWJsZWQgc2xpY2VzIG1hc2sgd2l0aCAxIGluIG9y
ZGVyCiAgICAgIHRvIGJlIGNvbnNpc3RlbnQgd2l0aCBCU3BlYywgdGhhdCB3YXkgd2UgY2FuIHVu
aWZ5IHRoYXQKICAgICAgYXNzZXJ0aW9uIGFuZCBhZ2FpbnN0IHRoZSBhY3R1YWwgc3RhdGUgZnJv
bSB0aGUgZHJpdmVyLCBidXQKICAgICAgbm90IHNvbWUgaGFyZGNvZGVkIHZhbHVlLihjb25jbHVk
ZWQgd2l0aCBWaWxsZSkKICAgIC0gUmVtb3ZlIHBhcmFtZXRlcml6ZWQgREJVRl9DVEwgdmVyc2lv
biwgdG8gZXh0cmFjdCBpdCB0byBhbm90aGVyCiAgICAgIHBhdGNoLihWaWxsZSBTeXJqw6Rsw6Qp
CiAgICAtIFJlbW92ZWQgdW5uZWVkZWQgaGFyZGNvZGVkIHJldHVybiB2YWx1ZSBmb3Igb2xkZXIg
Z2VucyBmcm9tCiAgICAgIGludGVsX2VuYWJsZWRfZGJ1Zl9zbGljZXNfbWFzayAtIHRoaXMgbm93
IGlzIGhhbmRsZWQgaW4gYQogICAgICB1bmlmaWVkIG1hbm5lciBzaW5jZSBkZXZpY2UgaW5mbyBh
bnl3YXkgcmV0dXJucyBtYXggZGJ1ZiBzbGljZXMKICAgICAgYXMgMSBmb3Igb2xkZXIgcGxhdGZv
cm1zKE1hdHRoZXcgUm9wZXIpCiAgICAtIE5vdyB1c2luZyBJTlRFTF9JTkZPKGRldl9wcml2KS0+
bnVtX3N1cHBvcnRlZF9kYnVmX3NsaWNlcyBpbnN0ZWFkCiAgICAgIG9mIGludGVsX2RidWZfbWF4
X3NsaWNlcyBmdW5jdGlvbiBhcyBpdCBpcyB0cml2aWFsKE1hdHRoZXcgUm9wZXIpCgpTaWduZWQt
b2ZmLWJ5OiBTdGFuaXNsYXYgTGlzb3Zza2l5IDxzdGFuaXNsYXYubGlzb3Zza2l5QGludGVsLmNv
bT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyAgfCAy
MyArKy0tLQogLi4uL2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV9wb3dlci5jICAgIHwg
OTggKysrKysrKystLS0tLS0tLS0tLQogLi4uL2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxh
eV9wb3dlci5oICAgIHwgIDUgKwogLi4uL2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90
eXBlcy5oICAgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggICAgICAg
ICAgICAgICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BjaS5jICAgICAgICAg
ICAgICAgfCAgNSArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGV2aWNlX2luZm8uaCAg
ICAgIHwgIDEgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYyAgICAgICAgICAgICAg
IHwgNjMgKysrKystLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5oICAgICAg
ICAgICAgICAgfCAgMiArLQogOSBmaWxlcyBjaGFuZ2VkLCA5MiBpbnNlcnRpb25zKCspLCAxMDkg
ZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kaXNwbGF5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3Bs
YXkuYwppbmRleCA4YjA2ZWYyOTY5M2UuLjA2MWRlMTYxYjk1YiAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKQEAgLTEzNzcwLDEyICsxMzc3MCwxMiBA
QCBzdGF0aWMgdm9pZCB2ZXJpZnlfd21fc3RhdGUoc3RydWN0IGludGVsX2NydGMgKmNydGMsCiAK
IAlza2xfcGlwZV9kZGJfZ2V0X2h3X3N0YXRlKGNydGMsIGh3LT5kZGJfeSwgaHctPmRkYl91dik7
CiAKLQlod19lbmFibGVkX3NsaWNlcyA9IGludGVsX2VuYWJsZWRfZGJ1Zl9zbGljZXNfbnVtKGRl
dl9wcml2KTsKKwlod19lbmFibGVkX3NsaWNlcyA9IGludGVsX2VuYWJsZWRfZGJ1Zl9zbGljZXNf
bWFzayhkZXZfcHJpdik7CiAKIAlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSAmJgotCSAg
ICBod19lbmFibGVkX3NsaWNlcyAhPSBkZXZfcHJpdi0+ZW5hYmxlZF9kYnVmX3NsaWNlc19udW0p
Ci0JCURSTV9FUlJPUigibWlzbWF0Y2ggaW4gREJVRiBTbGljZXMgKGV4cGVjdGVkICV1LCBnb3Qg
JXUpXG4iLAotCQkJICBkZXZfcHJpdi0+ZW5hYmxlZF9kYnVmX3NsaWNlc19udW0sCisJICAgIGh3
X2VuYWJsZWRfc2xpY2VzICE9IGRldl9wcml2LT5lbmFibGVkX2RidWZfc2xpY2VzX21hc2spCisJ
CURSTV9FUlJPUigibWlzbWF0Y2ggaW4gREJVRiBTbGljZXMgKGV4cGVjdGVkIDB4JXgsIGdvdCAw
eCV4KVxuIiwKKwkJCSAgZGV2X3ByaXYtPmVuYWJsZWRfZGJ1Zl9zbGljZXNfbWFzaywKIAkJCSAg
aHdfZW5hYmxlZF9zbGljZXMpOwogCiAJLyogcGxhbmVzICovCkBAIC0xNTExOSwyMiArMTUxMTks
MjMgQEAgc3RhdGljIHZvaWQgaW50ZWxfdXBkYXRlX3RyYW5zX3BvcnRfc3luY19jcnRjcyhzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YywKIHN0YXRpYyB2b2lkIGljbF9kYnVmX3NsaWNlX3ByZV91cGRh
dGUoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCiB7CiAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShzdGF0ZS0+YmFzZS5kZXYpOwotCXU4IGh3X2Vu
YWJsZWRfc2xpY2VzID0gZGV2X3ByaXYtPmVuYWJsZWRfZGJ1Zl9zbGljZXNfbnVtOwotCXU4IHJl
cXVpcmVkX3NsaWNlcyA9IHN0YXRlLT5lbmFibGVkX2RidWZfc2xpY2VzX251bTsKKwl1OCBod19l
bmFibGVkX3NsaWNlcyA9IGRldl9wcml2LT5lbmFibGVkX2RidWZfc2xpY2VzX21hc2s7CisJdTgg
cmVxdWlyZWRfc2xpY2VzID0gc3RhdGUtPmVuYWJsZWRfZGJ1Zl9zbGljZXNfbWFzazsKKwl1OCBz
bGljZXNfdW5pb24gPSBod19lbmFibGVkX3NsaWNlcyB8IHJlcXVpcmVkX3NsaWNlczsKIAogCS8q
IElmIDJuZCBEQnVmIHNsaWNlIHJlcXVpcmVkLCBlbmFibGUgaXQgaGVyZSAqLwotCWlmIChJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDExICYmIHJlcXVpcmVkX3NsaWNlcyA+IGh3X2VuYWJsZWRfc2xp
Y2VzKQotCQlpY2xfZGJ1Zl9zbGljZXNfdXBkYXRlKGRldl9wcml2LCByZXF1aXJlZF9zbGljZXMp
OworCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExICYmIHNsaWNlc191bmlvbiAhPSBod19l
bmFibGVkX3NsaWNlcykKKwkJaWNsX2RidWZfc2xpY2VzX3VwZGF0ZShkZXZfcHJpdiwgc2xpY2Vz
X3VuaW9uKTsKIH0KIAogc3RhdGljIHZvaWQgaWNsX2RidWZfc2xpY2VfcG9zdF91cGRhdGUoc3Ry
dWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShzdGF0ZS0+YmFzZS5kZXYpOwotCXU4IGh3X2VuYWJsZWRf
c2xpY2VzID0gZGV2X3ByaXYtPmVuYWJsZWRfZGJ1Zl9zbGljZXNfbnVtOwotCXU4IHJlcXVpcmVk
X3NsaWNlcyA9IHN0YXRlLT5lbmFibGVkX2RidWZfc2xpY2VzX251bTsKKwl1OCBod19lbmFibGVk
X3NsaWNlcyA9IGRldl9wcml2LT5lbmFibGVkX2RidWZfc2xpY2VzX21hc2s7CisJdTggcmVxdWly
ZWRfc2xpY2VzID0gc3RhdGUtPmVuYWJsZWRfZGJ1Zl9zbGljZXNfbWFzazsKIAogCS8qIElmIDJu
ZCBEQnVmIHNsaWNlIGlzIG5vIG1vcmUgcmVxdWlyZWQgZGlzYWJsZSBpdCAqLwotCWlmIChJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDExICYmIHJlcXVpcmVkX3NsaWNlcyA8IGh3X2VuYWJsZWRfc2xp
Y2VzKQorCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExICYmIHJlcXVpcmVkX3NsaWNlcyAh
PSBod19lbmFibGVkX3NsaWNlcykKIAkJaWNsX2RidWZfc2xpY2VzX3VwZGF0ZShkZXZfcHJpdiwg
cmVxdWlyZWRfc2xpY2VzKTsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2Rpc3BsYXlfcG93ZXIuYwppbmRleCA1ZTFjNjAxZjBmOTkuLjQ3NGQ2ZDRmM2Vi
NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5
X3Bvd2VyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5
X3Bvd2VyLmMKQEAgLTE1LDYgKzE1LDcgQEAKICNpbmNsdWRlICJpbnRlbF9kaXNwbGF5X3R5cGVz
LmgiCiAjaW5jbHVkZSAiaW50ZWxfZHBpb19waHkuaCIKICNpbmNsdWRlICJpbnRlbF9ob3RwbHVn
LmgiCisjaW5jbHVkZSAiaW50ZWxfcG0uaCIKICNpbmNsdWRlICJpbnRlbF9zaWRlYmFuZC5oIgog
I2luY2x1ZGUgImludGVsX3RjLmgiCiAjaW5jbHVkZSAiaW50ZWxfdmdhLmgiCkBAIC0xMDI4LDEx
ICsxMDI5LDEyIEBAIHN0YXRpYyBib29sIGdlbjlfZGNfb2ZmX3Bvd2VyX3dlbGxfZW5hYmxlZChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAKIHN0YXRpYyB2b2lkIGdlbjlfYXNz
ZXJ0X2RidWZfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7Ci0J
dTMyIHRtcCA9IEk5MTVfUkVBRChEQlVGX0NUTCk7CisJdTggZW5hYmxlZF9kYnVmX3NsaWNlcyA9
IGludGVsX2VuYWJsZWRfZGJ1Zl9zbGljZXNfbWFzayhkZXZfcHJpdik7CiAKLQlXQVJOKCh0bXAg
JiAoREJVRl9QT1dFUl9TVEFURSB8IERCVUZfUE9XRVJfUkVRVUVTVCkpICE9Ci0JICAgICAoREJV
Rl9QT1dFUl9TVEFURSB8IERCVUZfUE9XRVJfUkVRVUVTVCksCi0JICAgICAiVW5leHBlY3RlZCBE
QnVmIHBvd2VyIHBvd2VyIHN0YXRlICgweCUwOHgpXG4iLCB0bXApOworCVdBUk4oZW5hYmxlZF9k
YnVmX3NsaWNlcyAhPSBkZXZfcHJpdi0+ZW5hYmxlZF9kYnVmX3NsaWNlc19tYXNrLAorCSAgICAg
IlVuZXhwZWN0ZWQgREJ1ZiBwb3dlciBwb3dlciBzdGF0ZSAoMHglMDh4LCBleHBlY3RlZCAweCUw
OHgpXG4iLAorCSAgICAgZW5hYmxlZF9kYnVmX3NsaWNlcywKKwkgICAgIGRldl9wcml2LT5lbmFi
bGVkX2RidWZfc2xpY2VzX21hc2spOwogfQogCiBzdGF0aWMgdm9pZCBnZW45X2Rpc2FibGVfZGNf
c3RhdGVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKQEAgLTQzODgsODAgKzQz
OTAsNjIgQEAgYm9vbCBpbnRlbF9kYnVmX3NsaWNlX3NldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCiAKIHN0YXRpYyB2b2lkIGdlbjlfZGJ1Zl9lbmFibGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQogewotCWludGVsX2RidWZfc2xpY2Vfc2V0KGRldl9wcml2
LCBEQlVGX0NUTCwgdHJ1ZSk7CisJaWNsX2RidWZfc2xpY2VzX3VwZGF0ZShkZXZfcHJpdiwgQklU
KERCVUZfUzEpKTsKIH0KIAogc3RhdGljIHZvaWQgZ2VuOV9kYnVmX2Rpc2FibGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewotCWludGVsX2RidWZfc2xpY2Vfc2V0KGRldl9w
cml2LCBEQlVGX0NUTCwgZmFsc2UpOwotfQotCi1zdGF0aWMgdTggaW50ZWxfZGJ1Zl9tYXhfc2xp
Y2VzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA8IDExKQotCQlyZXR1cm4gMTsKLQlyZXR1cm4gMjsKKwlpY2xfZGJ1Zl9zbGlj
ZXNfdXBkYXRlKGRldl9wcml2LCAwKTsKIH0KIAogdm9pZCBpY2xfZGJ1Zl9zbGljZXNfdXBkYXRl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAkJCSAgICB1OCByZXFfc2xpY2Vz
KQogewotCWNvbnN0IHU4IGh3X2VuYWJsZWRfc2xpY2VzID0gZGV2X3ByaXYtPmVuYWJsZWRfZGJ1
Zl9zbGljZXNfbnVtOwotCWJvb2wgcmV0OworCWludCBpOworCWludCBtYXhfc2xpY2VzID0gSU5U
RUxfSU5GTyhkZXZfcHJpdiktPm51bV9zdXBwb3J0ZWRfZGJ1Zl9zbGljZXM7CiAKLQlpZiAocmVx
X3NsaWNlcyA+IGludGVsX2RidWZfbWF4X3NsaWNlcyhkZXZfcHJpdikpIHsKLQkJRFJNX0VSUk9S
KCJJbnZhbGlkIG51bWJlciBvZiBkYnVmIHNsaWNlcyByZXF1ZXN0ZWRcbiIpOwotCQlyZXR1cm47
Ci0JfQorCVdBUk4oaHdlaWdodDgocmVxX3NsaWNlcykgPiBtYXhfc2xpY2VzLAorCSAgICAgIklu
dmFsaWQgbnVtYmVyIG9mIGRidWYgc2xpY2VzIHJlcXVlc3RlZFxuIik7CiAKLQlpZiAocmVxX3Ns
aWNlcyA9PSBod19lbmFibGVkX3NsaWNlcyB8fCByZXFfc2xpY2VzID09IDApCi0JCXJldHVybjsK
KwlEUk1fREVCVUdfS01TKCJVcGRhdGluZyBkYnVmIHNsaWNlcyB0byAweCV4XG4iLCByZXFfc2xp
Y2VzKTsKIAotCWlmIChyZXFfc2xpY2VzID4gaHdfZW5hYmxlZF9zbGljZXMpCi0JCXJldCA9IGlu
dGVsX2RidWZfc2xpY2Vfc2V0KGRldl9wcml2LCBEQlVGX0NUTF9TMiwgdHJ1ZSk7Ci0JZWxzZQot
CQlyZXQgPSBpbnRlbF9kYnVmX3NsaWNlX3NldChkZXZfcHJpdiwgREJVRl9DVExfUzIsIGZhbHNl
KTsKKwlmb3IgKGkgPSAwOyBpIDwgbWF4X3NsaWNlczsgaSsrKSB7CisJCXU4IHNsaWNlX3NldCA9
IHJlcV9zbGljZXMgJiBCSVQoaSk7CiAKLQlpZiAocmV0KQotCQlkZXZfcHJpdi0+ZW5hYmxlZF9k
YnVmX3NsaWNlc19udW0gPSByZXFfc2xpY2VzOworCQlzd2l0Y2ggKGkpIHsKKwkJY2FzZSBEQlVG
X1MxOgorCQkJaW50ZWxfZGJ1Zl9zbGljZV9zZXQoZGV2X3ByaXYsCisJCQkJCSAgICAgREJVRl9D
VExfUzEsCisJCQkJCSAgICAgc2xpY2Vfc2V0KTsKKwkJCWJyZWFrOworCQljYXNlIERCVUZfUzI6
CisJCQlpbnRlbF9kYnVmX3NsaWNlX3NldChkZXZfcHJpdiwKKwkJCQkJICAgICBEQlVGX0NUTF9T
MiwKKwkJCQkJICAgICBzbGljZV9zZXQpOworCQkJYnJlYWs7CisJCWRlZmF1bHQ6CisJCQlNSVNT
SU5HX0NBU0UoaSk7CisJCX0KKwl9CisKKwlkZXZfcHJpdi0+ZW5hYmxlZF9kYnVmX3NsaWNlc19t
YXNrID0gcmVxX3NsaWNlczsKIH0KIAogc3RhdGljIHZvaWQgaWNsX2RidWZfZW5hYmxlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKLQlJOTE1X1dSSVRFKERCVUZfQ1RMX1Mx
LCBJOTE1X1JFQUQoREJVRl9DVExfUzEpIHwgREJVRl9QT1dFUl9SRVFVRVNUKTsKLQlJOTE1X1dS
SVRFKERCVUZfQ1RMX1MyLCBJOTE1X1JFQUQoREJVRl9DVExfUzIpIHwgREJVRl9QT1dFUl9SRVFV
RVNUKTsKLQlQT1NUSU5HX1JFQUQoREJVRl9DVExfUzIpOwotCi0JdWRlbGF5KDEwKTsKLQotCWlm
ICghKEk5MTVfUkVBRChEQlVGX0NUTF9TMSkgJiBEQlVGX1BPV0VSX1NUQVRFKSB8fAotCSAgICAh
KEk5MTVfUkVBRChEQlVGX0NUTF9TMikgJiBEQlVGX1BPV0VSX1NUQVRFKSkKLQkJRFJNX0VSUk9S
KCJEQnVmIHBvd2VyIGVuYWJsZSB0aW1lb3V0XG4iKTsKLQllbHNlCi0JCS8qCi0JCSAqIEZJWE1F
OiBmb3Igbm93IHByZXRlbmQgdGhhdCB3ZSBvbmx5IGhhdmUgMSBzbGljZSwgc2VlCi0JCSAqIGlu
dGVsX2VuYWJsZWRfZGJ1Zl9zbGljZXNfbnVtKCkuCi0JCSAqLwotCQlkZXZfcHJpdi0+ZW5hYmxl
ZF9kYnVmX3NsaWNlc19udW0gPSAxOworCS8qCisJICogSnVzdCBwb3dlciB1cCAxIHNsaWNlLCB3
ZSB3aWxsCisJICogZmlndXJlIG91dCBsYXRlciB3aGljaCBzbGljZXMgd2UgaGF2ZSBhbmQgd2hh
dCB3ZSBuZWVkLgorCSAqLworCWljbF9kYnVmX3NsaWNlc191cGRhdGUoZGV2X3ByaXYsIEJJVChE
QlVGX1MxKSk7CiB9CiAKIHN0YXRpYyB2b2lkIGljbF9kYnVmX2Rpc2FibGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQogewotCUk5MTVfV1JJVEUoREJVRl9DVExfUzEsIEk5MTVf
UkVBRChEQlVGX0NUTF9TMSkgJiB+REJVRl9QT1dFUl9SRVFVRVNUKTsKLQlJOTE1X1dSSVRFKERC
VUZfQ1RMX1MyLCBJOTE1X1JFQUQoREJVRl9DVExfUzIpICYgfkRCVUZfUE9XRVJfUkVRVUVTVCk7
Ci0JUE9TVElOR19SRUFEKERCVUZfQ1RMX1MyKTsKLQotCXVkZWxheSgxMCk7Ci0KLQlpZiAoKEk5
MTVfUkVBRChEQlVGX0NUTF9TMSkgJiBEQlVGX1BPV0VSX1NUQVRFKSB8fAotCSAgICAoSTkxNV9S
RUFEKERCVUZfQ1RMX1MyKSAmIERCVUZfUE9XRVJfU1RBVEUpKQotCQlEUk1fRVJST1IoIkRCdWYg
cG93ZXIgZGlzYWJsZSB0aW1lb3V0IVxuIik7Ci0JZWxzZQotCQkvKgotCQkgKiBGSVhNRTogZm9y
IG5vdyBwcmV0ZW5kIHRoYXQgdGhlIGZpcnN0IHNsaWNlIGlzIGFsd2F5cwotCQkgKiBlbmFibGVk
LCBzZWUgaW50ZWxfZW5hYmxlZF9kYnVmX3NsaWNlc19udW0oKS4KLQkJICovCi0JCWRldl9wcml2
LT5lbmFibGVkX2RidWZfc2xpY2VzX251bSA9IDE7CisJLyoKKwkgKiBBcyBvZiBCU3BlYyBTbGlj
ZSAxIGlzIGFsd2F5cyBlbmFibGVkLgorCSAqLworCWljbF9kYnVmX3NsaWNlc191cGRhdGUoZGV2
X3ByaXYsIEJJVChEQlVGX1MxKSk7CiB9CiAKIHN0YXRpYyB2b2lkIGljbF9tYnVzX2luaXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmggYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfcG93ZXIuaAppbmRleCAyNjA4YTY1YWY3ZmEuLjYw
MWUwMDBmZmQwZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9kaXNwbGF5X3Bvd2VyLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9kaXNwbGF5X3Bvd2VyLmgKQEAgLTMwNyw2ICszMDcsMTEgQEAgaW50ZWxfZGlzcGxheV9wb3dl
cl9wdXRfYXN5bmMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiB9CiAjZW5kaWYKIAor
ZW51bSBkYnVmX3NsaWNlIHsKKwlEQlVGX1MxLAorCURCVUZfUzIsCit9OworCiAjZGVmaW5lIHdp
dGhfaW50ZWxfZGlzcGxheV9wb3dlcihpOTE1LCBkb21haW4sIHdmKSBcCiAJZm9yICgod2YpID0g
aW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoKGk5MTUpLCAoZG9tYWluKSk7ICh3Zik7IFwKIAkgICAg
IGludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X2FzeW5jKChpOTE1KSwgKGRvbWFpbiksICh3ZikpLCAo
d2YpID0gMCkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZGlzcGxheV90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNw
bGF5X3R5cGVzLmgKaW5kZXggNmRjYTkwZWJjYTM1Li4wOWYxNGU5ZTc4NjMgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oCkBAIC01
MTgsNyArNTE4LDcgQEAgc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSB7CiAJc3RydWN0IHNrbF9k
ZGJfdmFsdWVzIHdtX3Jlc3VsdHM7CiAKIAkvKiBOdW1iZXIgb2YgZW5hYmxlZCBEQnVmIHNsaWNl
cyAqLwotCXU4IGVuYWJsZWRfZGJ1Zl9zbGljZXNfbnVtOworCXU4IGVuYWJsZWRfZGJ1Zl9zbGlj
ZXNfbWFzazsKIAogCXN0cnVjdCBpOTE1X3N3X2ZlbmNlIGNvbW1pdF9yZWFkeTsKIApkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZHJ2LmgKaW5kZXggOWRiZjJlNTdiMDFiLi41Yjg5NWFkMzhmYmMgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9kcnYuaApAQCAtMTIwOCw3ICsxMjA4LDcgQEAgc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgewogCQlib29sIGRpc3RydXN0X2Jpb3Nfd207CiAJfSB3bTsKIAotCXU4IGVuYWJsZWRf
ZGJ1Zl9zbGljZXNfbnVtOyAvKiBHRU4xMSBoYXMgY29uZmlndXJhYmxlIDIgc2xpY2VzICovCisJ
dTggZW5hYmxlZF9kYnVmX3NsaWNlc19tYXNrOyAvKiBHRU4xMSBoYXMgY29uZmlndXJhYmxlIDIg
c2xpY2VzICovCiAKIAlzdHJ1Y3QgZHJhbV9pbmZvIHsKIAkJYm9vbCB2YWxpZDsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGNpLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3BjaS5jCmluZGV4IDgzZjAxNDAxYjhiNS4uNmM2ZGFhNDRjNDM5IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BjaS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfcGNpLmMKQEAgLTYxNSw3ICs2MTUsOCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGlu
dGVsX2RldmljZV9pbmZvIGNodl9pbmZvID0gewogCS5oYXNfZ3RfdWMgPSAxLCBcCiAJLmRpc3Bs
YXkuaGFzX2hkY3AgPSAxLCBcCiAJLmRpc3BsYXkuaGFzX2lwYyA9IDEsIFwKLQkuZGRiX3NpemUg
PSA4OTYKKwkuZGRiX3NpemUgPSA4OTYsIFwKKwkubnVtX3N1cHBvcnRlZF9kYnVmX3NsaWNlcyA9
IDEKIAogI2RlZmluZSBTS0xfUExBVEZPUk0gXAogCUdFTjlfRkVBVFVSRVMsIFwKQEAgLTY1MCw2
ICs2NTEsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGludGVsX2RldmljZV9pbmZvIHNrbF9ndDRf
aW5mbyA9IHsKICNkZWZpbmUgR0VOOV9MUF9GRUFUVVJFUyBcCiAJR0VOKDkpLCBcCiAJLmlzX2xw
ID0gMSwgXAorCS5udW1fc3VwcG9ydGVkX2RidWZfc2xpY2VzID0gMSwgXAogCS5kaXNwbGF5Lmhh
c19ob3RwbHVnID0gMSwgXAogCS5lbmdpbmVfbWFzayA9IEJJVChSQ1MwKSB8IEJJVChWQ1MwKSB8
IEJJVChCQ1MwKSB8IEJJVChWRUNTMCksIFwKIAkucGlwZV9tYXNrID0gQklUKFBJUEVfQSkgfCBC
SVQoUElQRV9CKSB8IEJJVChQSVBFX0MpLCBcCkBAIC03NzQsNiArNzc2LDcgQEAgc3RhdGljIGNv
bnN0IHN0cnVjdCBpbnRlbF9kZXZpY2VfaW5mbyBjbmxfaW5mbyA9IHsKIAl9LCBcCiAJR0VOKDEx
KSwgXAogCS5kZGJfc2l6ZSA9IDIwNDgsIFwKKwkubnVtX3N1cHBvcnRlZF9kYnVmX3NsaWNlcyA9
IDIsIFwKIAkuaGFzX2xvZ2ljYWxfcmluZ19lbHNxID0gMSwgXAogCS5jb2xvciA9IHsgLmRlZ2Ft
bWFfbHV0X3NpemUgPSAzMywgLmdhbW1hX2x1dF9zaXplID0gMjYyMTQ1IH0KIApkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGV2aWNlX2luZm8uaCBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX2RldmljZV9pbmZvLmgKaW5kZXggMjcyNWNiN2ZjMTY5Li43ZDRkMTIy
ZDIxODIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RldmljZV9pbmZv
LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGV2aWNlX2luZm8uaApAQCAtMTgw
LDYgKzE4MCw3IEBAIHN0cnVjdCBpbnRlbF9kZXZpY2VfaW5mbyB7CiAJfSBkaXNwbGF5OwogCiAJ
dTE2IGRkYl9zaXplOyAvKiBpbiBibG9ja3MgKi8KKwl1OCBudW1fc3VwcG9ydGVkX2RidWZfc2xp
Y2VzOyAvKiBudW1iZXIgb2YgREJ1ZiBzbGljZXMgKi8KIAogCS8qIFJlZ2lzdGVyIG9mZnNldHMg
Zm9yIHRoZSB2YXJpb3VzIGRpc3BsYXkgcGlwZXMgYW5kIHRyYW5zY29kZXJzICovCiAJaW50IHBp
cGVfb2Zmc2V0c1tJOTE1X01BWF9UUkFOU0NPREVSU107CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYwpp
bmRleCA4ZjZmNjQ3MjYyNmEuLjUyNTU3ODkzMzY1OCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfcG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5j
CkBAIC0zNjQ0LDI2ICszNjQ0LDMyIEBAIGJvb2wgaWxrX2Rpc2FibGVfbHBfd20oc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCXJldHVybiBfaWxrX2Rpc2FibGVfbHBfd20oZGV2
X3ByaXYsIFdNX0RJUlRZX0xQX0FMTCk7CiB9CiAKLXU4IGludGVsX2VuYWJsZWRfZGJ1Zl9zbGlj
ZXNfbnVtKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKK3U4IGludGVsX2VuYWJs
ZWRfZGJ1Zl9zbGljZXNfbWFzayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7
Ci0JdTggZW5hYmxlZF9kYnVmX3NsaWNlc19udW07CisJaW50IGk7CisJaW50IG1heF9zbGljZXMg
PSBJTlRFTF9JTkZPKGRldl9wcml2KS0+bnVtX3N1cHBvcnRlZF9kYnVmX3NsaWNlczsKKwl1OCBl
bmFibGVkX3NsaWNlc19tYXNrID0gMDsKIAotCS8qIFNsaWNlIDEgd2lsbCBhbHdheXMgYmUgZW5h
YmxlZCAqLwotCWVuYWJsZWRfZGJ1Zl9zbGljZXNfbnVtID0gMTsKKwlmb3IgKGkgPSAwOyBpIDwg
bWF4X3NsaWNlczsgaSsrKSB7CisJCXU4IHNsaWNlX2JpdCA9IEJJVChpKTsKKwkJYm9vbCByZXM7
CiAKLQkvKiBHZW4gcHJpb3IgdG8gR0VOMTEgaGF2ZSBvbmx5IG9uZSBEQnVmIHNsaWNlICovCi0J
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCAxMSkKLQkJcmV0dXJuIGVuYWJsZWRfZGJ1Zl9zbGlj
ZXNfbnVtOworCQlzd2l0Y2ggKGkpIHsKKwkJY2FzZSBEQlVGX1MxOgorCQkJcmVzID0gSTkxNV9S
RUFEKERCVUZfQ1RMX1MxKSAmIERCVUZfUE9XRVJfU1RBVEU7CisJCQlicmVhazsKKwkJY2FzZSBE
QlVGX1MyOgorCQkJcmVzID0gSTkxNV9SRUFEKERCVUZfQ1RMX1MyKSAmIERCVUZfUE9XRVJfU1RB
VEU7CisJCQlicmVhazsKKwkJZGVmYXVsdDoKKwkJCU1JU1NJTkdfQ0FTRShzbGljZV9iaXQpOwor
CQl9CiAKLQkvKgotCSAqIEZJWE1FOiBmb3Igbm93IHdlJ2xsIG9ubHkgZXZlciB1c2UgMSBzbGlj
ZTsgcHJldGVuZCB0aGF0IHdlIGhhdmUKLQkgKiBvbmx5IHRoYXQgMSBzbGljZSBlbmFibGVkIHVu
dGlsIHdlIGhhdmUgYSBwcm9wZXIgd2F5IGZvciBvbi1kZW1hbmQKLQkgKiB0b2dnbGluZyBvZiB0
aGUgc2Vjb25kIHNsaWNlLgotCSAqLwotCWlmICgwICYmIEk5MTVfUkVBRChEQlVGX0NUTF9TMikg
JiBEQlVGX1BPV0VSX1NUQVRFKQotCQllbmFibGVkX2RidWZfc2xpY2VzX251bSsrOworCQlpZiAo
cmVzKQorCQkJZW5hYmxlZF9zbGljZXNfbWFzayB8PSBzbGljZV9iaXQ7CisJfQogCi0JcmV0dXJu
IGVuYWJsZWRfZGJ1Zl9zbGljZXNfbnVtOworCXJldHVybiBlbmFibGVkX3NsaWNlc19tYXNrOwog
fQogCiAvKgpAQCAtMzg3MSw4ICszODc3LDYgQEAgc3RhdGljIHUxNiBpbnRlbF9nZXRfZGRiX3Np
emUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogewogCXN0cnVjdCBkcm1fYXRv
bWljX3N0YXRlICpzdGF0ZSA9IGNydGNfc3RhdGUtPnVhcGkuc3RhdGU7CiAJc3RydWN0IGludGVs
X2F0b21pY19zdGF0ZSAqaW50ZWxfc3RhdGUgPSB0b19pbnRlbF9hdG9taWNfc3RhdGUoc3RhdGUp
OwotCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlOwotCXU2NCB0
b3RhbF9kYXRhX2J3OwogCXUxNiBkZGJfc2l6ZSA9IElOVEVMX0lORk8oZGV2X3ByaXYpLT5kZGJf
c2l6ZTsKIAogCVdBUk5fT04oZGRiX3NpemUgPT0gMCk7CkBAIC0zODgwLDIzICszODg0LDggQEAg
c3RhdGljIHUxNiBpbnRlbF9nZXRfZGRiX3NpemUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAogCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgMTEpCiAJCXJldHVybiBkZGJfc2l6
ZSAtIDQ7IC8qIDQgYmxvY2tzIGZvciBieXBhc3MgcGF0aCBhbGxvY2F0aW9uICovCiAKLQlhZGp1
c3RlZF9tb2RlID0gJmNydGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGU7Ci0JdG90YWxfZGF0YV9i
dyA9IHRvdGFsX2RhdGFfcmF0ZSAqIGRybV9tb2RlX3ZyZWZyZXNoKGFkanVzdGVkX21vZGUpOwot
Ci0JLyoKLQkgKiAxMkdCL3MgaXMgbWF4aW11bSBCVyBzdXBwb3J0ZWQgYnkgc2luZ2xlIERCdWYg
c2xpY2UuCi0JICoKLQkgKiBGSVhNRSBkYnVmIHNsaWNlIGNvZGUgaXMgYnJva2VuOgotCSAqIC0g
bXVzdCB3YWl0IGZvciBwbGFuZXMgdG8gc3RvcCB1c2luZyB0aGUgc2xpY2UgYmVmb3JlIHBvd2Vy
aW5nIGl0IG9mZgotCSAqIC0gcGxhbmUgc3RyYWRkbGluZyBib3RoIHNsaWNlcyBpcyBpbGxlZ2Fs
IGluIG11bHRpLXBpcGUgc2NlbmFyaW9zCi0JICogLSBzaG91bGQgdmFsaWRhdGUgd2Ugc3RheSB3
aXRoaW4gdGhlIGh3IGJhbmR3aWR0aCBsaW1pdHMKLQkgKi8KLQlpZiAoMCAmJiAobnVtX2FjdGl2
ZSA+IDEgfHwgdG90YWxfZGF0YV9idyA+PSBHQnBzKDEyKSkpIHsKLQkJaW50ZWxfc3RhdGUtPmVu
YWJsZWRfZGJ1Zl9zbGljZXNfbnVtID0gMjsKLQl9IGVsc2UgewotCQlpbnRlbF9zdGF0ZS0+ZW5h
YmxlZF9kYnVmX3NsaWNlc19udW0gPSAxOwotCQlkZGJfc2l6ZSAvPSAyOwotCX0KKwlpbnRlbF9z
dGF0ZS0+ZW5hYmxlZF9kYnVmX3NsaWNlc19tYXNrID0gQklUKERCVUZfUzEpOworCWRkYl9zaXpl
IC89IDI7CiAKIAlyZXR1cm4gZGRiX3NpemU7CiB9CkBAIC00MDkzLDggKzQwODIsOCBAQCB2b2lk
IHNrbF9waXBlX2RkYl9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVsX2NydGMgKmNydGMsCiAKIHZv
aWQgc2tsX2RkYl9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQogewotCWRldl9wcml2LT5lbmFibGVkX2RidWZfc2xpY2VzX251bSA9Ci0JCQkJaW50ZWxfZW5h
YmxlZF9kYnVmX3NsaWNlc19udW0oZGV2X3ByaXYpOworCWRldl9wcml2LT5lbmFibGVkX2RidWZf
c2xpY2VzX21hc2sgPQorCQkJCWludGVsX2VuYWJsZWRfZGJ1Zl9zbGljZXNfbWFzayhkZXZfcHJp
dik7CiB9CiAKIC8qCkBAIC01MjM2LDcgKzUyMjUsNyBAQCBza2xfY29tcHV0ZV9kZGIoc3RydWN0
IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCiAJc3RydWN0IGludGVsX2NydGMgKmNydGM7CiAJ
aW50IHJldCwgaTsKIAotCXN0YXRlLT5lbmFibGVkX2RidWZfc2xpY2VzX251bSA9IGRldl9wcml2
LT5lbmFibGVkX2RidWZfc2xpY2VzX251bTsKKwlzdGF0ZS0+ZW5hYmxlZF9kYnVmX3NsaWNlc19t
YXNrID0gZGV2X3ByaXYtPmVuYWJsZWRfZGJ1Zl9zbGljZXNfbWFzazsKIAogCWZvcl9lYWNoX29s
ZG5ld19pbnRlbF9jcnRjX2luX3N0YXRlKHN0YXRlLCBjcnRjLCBvbGRfY3J0Y19zdGF0ZSwKIAkJ
CQkJICAgIG5ld19jcnRjX3N0YXRlLCBpKSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9wbS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uaAppbmRleCAy
MmZkMmRhZjYwOGUuLmQ2MGE4NTQyMWM1YSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfcG0uaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5oCkBAIC0z
Miw3ICszMiw3IEBAIHZvaWQgZzR4X3dtX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpOwogdm9pZCB2bHZfd21fZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdik7CiB2b2lkIGlsa193bV9nZXRfaHdfc3RhdGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKIHZvaWQgc2tsX3dtX2dldF9od19zdGF0ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwotdTggaW50ZWxfZW5hYmxlZF9kYnVmX3Ns
aWNlc19udW0oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKK3U4IGludGVsX2Vu
YWJsZWRfZGJ1Zl9zbGljZXNfbWFzayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Owogdm9pZCBza2xfcGlwZV9kZGJfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
LAogCQkJICAgICAgIHN0cnVjdCBza2xfZGRiX2VudHJ5ICpkZGJfeSwKIAkJCSAgICAgICBzdHJ1
Y3Qgc2tsX2RkYl9lbnRyeSAqZGRiX3V2KTsKLS0gCjIuMjQuMS40ODUuZ2FkMDVhM2Q4ZTUKCl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBt
YWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3Rz
LmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeAo=

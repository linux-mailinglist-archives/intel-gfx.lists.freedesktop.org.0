Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 435C2300E54
	for <lists+intel-gfx@lfdr.de>; Fri, 22 Jan 2021 21:56:59 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A93696EA56;
	Fri, 22 Jan 2021 20:56:57 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga05.intel.com (mga05.intel.com [192.55.52.43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4D38B6EA56
 for <intel-gfx@lists.freedesktop.org>; Fri, 22 Jan 2021 20:56:56 +0000 (UTC)
IronPort-SDR: 9yoBhGI21h5yP+7LG/j40LQCfp0dcs6LRu0gQ4W1J2qnpnDiAI0pYOldSD0ma9ibfU6F/ZBP0l
 CB62wnSTZ1iA==
X-IronPort-AV: E=McAfee;i="6000,8403,9872"; a="264326608"
X-IronPort-AV: E=Sophos;i="5.79,367,1602572400"; d="scan'208";a="264326608"
Received: from orsmga008.jf.intel.com ([10.7.209.65])
 by fmsmga105.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 22 Jan 2021 12:56:55 -0800
IronPort-SDR: AX9+vTDXaH0PbMl4ZasytSCY31xWyVqNgOGYQ3pTdG1bVo/5ZZT6UiHZuOM/Vg2rDiIfn7PgPK
 aAoql3zEG5GA==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.79,367,1602572400"; d="scan'208";a="385977860"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.174])
 by orsmga008.jf.intel.com with SMTP; 22 Jan 2021 12:56:49 -0800
Received: by stinkbox (sSMTP sendmail emulation);
 Fri, 22 Jan 2021 22:56:49 +0200
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 22 Jan 2021 22:56:30 +0200
Message-Id: <20210122205633.18492-6-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.26.2
In-Reply-To: <20210122205633.18492-1-ville.syrjala@linux.intel.com>
References: <20210122205633.18492-1-ville.syrjala@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v3 5/8] drm/i915: Add pipe ddb entries into the
 dbuf state
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KClRo
ZSBkYnVmIHN0YXRlIHdpbGwgYmUgd2hlcmUgd2UgY29sbGVjdCBhbGwgdGhlIGludGVyLXBpcGUg
ZGJ1ZgphbGxvY2F0aW9uIHN0dWZmLiBTdGFydCBieSBhZGRpbmcgdGhlIGFjdHVhbCBwZXItcGlw
ZSBkZGIgZW50cmllcwp0aGVyZS4KCk9yaWdpbmFsbHkgdGhlIHBsYW4gd2FzIHRvIG1vdmUgdGhl
bSB0aGVyZSBvdXRyaWdodCwgYnV0IHRoYXQgbm8gbG9uZ2VyCndvcmtzIGFzIHdlJ3JlIG5vIGxv
bmdlciBndWFyYW50ZWVkIHRvIGhhdmUgYSBkYnVmIHN0YXRlIHdoZW4gaXQgY29tZXMKdGltZSB0
byBzYW5pdHkgY2hlY2sgdGhlIGRkYiBvdmVybGFwcyBpbiBza2xfY29tbWl0X21vZGVzZXRfZW5h
YmxlcygpLgpJIHRoaW5rIHdoZW4gSSB3cm90ZSB0aGlzIG9yaWdpbmFsbHkgd2UgZGlkIHRoZSB3
YXRlcm1hcmsvZGRiCmNhbGN1bGF0aW9uIGxhc3QsIGFuZCBzbyB3ZSBjb3VsZG4ndCBoYXZlIGFu
eSBjcnRjcyBpbiB0aGUgc3RhdGUgdy9vCmFsc28gaGF2aW5nIHRoZSBkYnVmIHN0YXRlLiBCdXQg
dGhhdCBoYXMgc2luY2UgY2hhbmdlZCBhbmQgd2UgZG8gdGhlCndhdGVybWFyay9kZGIgY2FsY3Vs
YXRpb24gbXVjaCBlYXJsaWVyLCBhbmQgdGh1cyBpdCBpcyBub3cgcG9zc2libGUKdG8gY29tbWl0
IGNydGNzIHcvbyBhIGRidWYgc3RhdGUuIFNvIHdlIGtlZXAgYW5vdGhlciBjb3B5IG9mIHRoZQpp
bmZvcm1hdGlvbiBpbiB0aGUgY3J0YyBzdGF0ZS4KCnYyOiBSZWJhc2UKdjM6IER1cGxpY2F0ZSB0
aGUgZW50cmllcyBpbnN0ZWFkIG9mIG1vdmluZwoKUmV2aWV3ZWQtYnk6IFN0YW5pc2xhdiBMaXNv
dnNraXkgPHN0YW5pc2xhdi5saXNvdnNraXlAaW50ZWwuY29tPgpTaWduZWQtb2ZmLWJ5OiBWaWxs
ZSBTeXJqw6Rsw6QgPHZpbGxlLnN5cmphbGFAbGludXguaW50ZWwuY29tPgotLS0KIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX3BtLmMgfCAxOSArKysrKysrKy0tLS0tLS0tLS0tCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5oIHwgIDQgKysrKwogMiBmaWxlcyBjaGFuZ2VkLCAxMiBp
bnNlcnRpb25zKCspLCAxMSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYwppbmRl
eCA0ZWIyZDM2ZWQxMDguLmE2Y2ZiNWExNDc1NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfcG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5jCkBA
IC00MTA1LDcgKzQxMDUsNyBAQCBzdGF0aWMgdTggc2tsX2NvbXB1dGVfZGJ1Zl9zbGljZXMoc3Ry
dWN0IGludGVsX2NydGMgKmNydGMsCiAKIHN0YXRpYyBpbnQKIHNrbF9kZGJfZ2V0X3BpcGVfYWxs
b2NhdGlvbl9saW1pdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAotCQkJCSAg
IGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAorCQkJCSAgIHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCQkJCSAgIGNvbnN0IHU2NCB0b3RhbF9k
YXRhX3JhdGUsCiAJCQkJICAgc3RydWN0IHNrbF9kZGJfZW50cnkgKmFsbG9jLCAvKiBvdXQgKi8K
IAkJCQkgICBpbnQgKm51bV9hY3RpdmUgLyogb3V0ICovKQpAQCAtNDEzNCw2ICs0MTM0LDcgQEAg
c2tsX2RkYl9nZXRfcGlwZV9hbGxvY2F0aW9uX2xpbWl0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCiAJaWYgKCFjcnRjX3N0YXRlLT5ody5hY3RpdmUpIHsKIAkJYWxsb2MtPnN0
YXJ0ID0gMDsKIAkJYWxsb2MtPmVuZCA9IDA7CisJCWNydGNfc3RhdGUtPndtLnNrbC5kZGIgPSAq
YWxsb2M7CiAJCXJldHVybiAwOwogCX0KIApAQCAtNDE0NiwxNiArNDE0Nyw4IEBAIHNrbF9kZGJf
Z2V0X3BpcGVfYWxsb2NhdGlvbl9saW1pdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAogCSAqIGdyYWIgX2FsbF8gY3J0YyBsb2NrcywgaW5jbHVkaW5nIHRoZSBvbmUgd2UgY3Vy
cmVudGx5IGhvbGQuCiAJICovCiAJaWYgKG9sZF9kYnVmX3N0YXRlLT5hY3RpdmVfcGlwZXMgPT0g
bmV3X2RidWZfc3RhdGUtPmFjdGl2ZV9waXBlcyAmJgotCSAgICAhZGV2X3ByaXYtPndtLmRpc3Ry
dXN0X2Jpb3Nfd20pIHsKLQkJLyoKLQkJICogYWxsb2MgbWF5IGJlIGNsZWFyZWQgYnkgY2xlYXJf
aW50ZWxfY3J0Y19zdGF0ZSwKLQkJICogY29weSBmcm9tIG9sZCBzdGF0ZSB0byBiZSBzdXJlCi0J
CSAqCi0JCSAqIEZJWE1FIGdldCByaWQgb2YgdGhpcyBtZXNzCi0JCSAqLwotCQkqYWxsb2MgPSB0
b19pbnRlbF9jcnRjX3N0YXRlKGZvcl9jcnRjLT5iYXNlLnN0YXRlKS0+d20uc2tsLmRkYjsKKwkg
ICAgIWRldl9wcml2LT53bS5kaXN0cnVzdF9iaW9zX3dtKQogCQlyZXR1cm4gMDsKLQl9CiAKIAkv
KgogCSAqIEdldCBhbGxvd2VkIERCdWYgc2xpY2VzIGZvciBjb3JyZXNwb25kZW50IHBpcGUgYW5k
IHBsYXRmb3JtLgpAQCAtNDIyMiw2ICs0MjE1LDcgQEAgc2tsX2RkYl9nZXRfcGlwZV9hbGxvY2F0
aW9uX2xpbWl0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAKIAlhbGxvYy0+
c3RhcnQgPSBkZGJfc2xpY2VzLnN0YXJ0ICsgc3RhcnQ7CiAJYWxsb2MtPmVuZCA9IGRkYl9zbGlj
ZXMuc3RhcnQgKyBlbmQ7CisJY3J0Y19zdGF0ZS0+d20uc2tsLmRkYiA9ICphbGxvYzsKIAogCWRy
bV9kYmdfa21zKCZkZXZfcHJpdi0+ZHJtLAogCQkgICAgIltDUlRDOiVkOiVzXSBkYnVmIHNsaWNl
cyAweCV4LCBkZGIgKCVkIC0gJWQpLCBhY3RpdmUgcGlwZXMgMHgleFxuIiwKQEAgLTQ3OTgsNyAr
NDc5Miw5IEBAIHNrbF9hbGxvY2F0ZV9waXBlX2RkYihzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRl
ICpzdGF0ZSwKIAlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9CiAJCWludGVs
X2F0b21pY19nZXRfbmV3X2NydGNfc3RhdGUoc3RhdGUsIGNydGMpOwogCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwotCXN0cnVjdCBz
a2xfZGRiX2VudHJ5ICphbGxvYyA9ICZjcnRjX3N0YXRlLT53bS5za2wuZGRiOworCXN0cnVjdCBp
bnRlbF9kYnVmX3N0YXRlICpkYnVmX3N0YXRlID0KKwkJaW50ZWxfYXRvbWljX2dldF9uZXdfZGJ1
Zl9zdGF0ZShzdGF0ZSk7CisJc3RydWN0IHNrbF9kZGJfZW50cnkgKmFsbG9jID0gJmRidWZfc3Rh
dGUtPmRkYltjcnRjLT5waXBlXTsKIAl1MTYgYWxsb2Nfc2l6ZSwgc3RhcnQgPSAwOwogCXUxNiB0
b3RhbFtJOTE1X01BWF9QTEFORVNdID0ge307CiAJdTE2IHV2X3RvdGFsW0k5MTVfTUFYX1BMQU5F
U10gPSB7fTsKQEAgLTQ4MzksNiArNDgzNSw3IEBAIHNrbF9hbGxvY2F0ZV9waXBlX2RkYihzdHJ1
Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKIAkJfQogCiAJCWFsbG9jLT5zdGFydCA9IGFs
bG9jLT5lbmQgPSAwOworCQljcnRjX3N0YXRlLT53bS5za2wuZGRiID0gKmFsbG9jOwogCQlyZXR1
cm4gMDsKIAl9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmgg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5oCmluZGV4IDAwOTEwYmMwMTQwNy4uNzI0
MjA0YmI4NDQyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5oCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmgKQEAgLTksOCArOSwxMCBAQAogI2lu
Y2x1ZGUgPGxpbnV4L3R5cGVzLmg+CiAKICNpbmNsdWRlICJkaXNwbGF5L2ludGVsX2J3LmgiCisj
aW5jbHVkZSAiZGlzcGxheS9pbnRlbF9kaXNwbGF5LmgiCiAjaW5jbHVkZSAiZGlzcGxheS9pbnRl
bF9nbG9iYWxfc3RhdGUuaCIKIAorI2luY2x1ZGUgImk5MTVfZHJ2LmgiCiAjaW5jbHVkZSAiaTkx
NV9yZWcuaCIKIAogc3RydWN0IGRybV9kZXZpY2U7CkBAIC02OCw2ICs3MCw4IEBAIGJvb2wgaW50
ZWxfc2V0X21lbW9yeV9jeHNyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgYm9v
bCBlbmFibGUpOwogc3RydWN0IGludGVsX2RidWZfc3RhdGUgewogCXN0cnVjdCBpbnRlbF9nbG9i
YWxfc3RhdGUgYmFzZTsKIAorCXN0cnVjdCBza2xfZGRiX2VudHJ5IGRkYltJOTE1X01BWF9QSVBF
U107CisKIAl1OCBlbmFibGVkX3NsaWNlczsKIAl1OCBhY3RpdmVfcGlwZXM7CiB9OwotLSAKMi4y
Ni4yCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRl
bC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6
Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZngK

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 438FF2DA60B
	for <lists+intel-gfx@lfdr.de>; Tue, 15 Dec 2020 03:15:31 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E99C889C84;
	Tue, 15 Dec 2020 02:15:28 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (unknown [77.68.26.236])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 72DC589C83
 for <intel-gfx@lists.freedesktop.org>; Tue, 15 Dec 2020 02:15:24 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from build.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 23326307-1500050 
 for multiple; Tue, 15 Dec 2020 02:15:08 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 15 Dec 2020 02:15:08 +0000
Message-Id: <20201215021509.32176-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 1/2] drm/i915/gt: Split logical ring contexts
 from execlist submission
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Chris Wilson <chris@chris-wilson.co.uk>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

U3BsaXQgdGhlIGRlZmluaXRpb24sIGNvbnN0cnVjdGlvbiBhbmQgdXBkYXRpbmcgb2YgdGhlIExv
Z2ljYWwgUmluZwpDb250ZXh0IGZyb20gdGhlIGV4ZWNsaXN0IHN1Ym1pc3Npb24gaW50ZXJmYWNl
LiBUaGUgTFJDIGlzIHVzZWQgYnkgdGhlCkhXLCBpcnJlc3BlY3RpdmUgb2Ygb3VyIGRpZmZlcmVu
dCBzdWJtaXNzaW9uIGJhY2tlbmRzLgoKU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJp
c0BjaHJpcy13aWxzb24uY28udWs+ClJldmlld2VkLWJ5OiBEYW5pZWxlIENlcmFvbG8gU3B1cmlv
IDxkYW5pZWxlLmNlcmFvbG9zcHVyaW9AaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L01ha2VmaWxlICAgICAgICAgICAgICAgICB8ICAgIDEgKwogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvZ2VuOF9lbmdpbmVfY3MuYyAgICAgIHwgICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfY29udGV4dF9zc2V1LmMgIHwgICAgMyArLQogLi4uL2RybS9pOTE1L2d0L2lu
dGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uLmMgIHwgMTUyMiArLS0tLS0tLS0tLS0tLQogLi4uL2Ry
bS9pOTE1L2d0L2ludGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uLmggIHwgICAxNyAtCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyAgICAgICAgICAgfCAxNDcwICsrKysrKysrKysr
KysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5oICAgICAgICAgICB8ICAgNjcg
KwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjX3JlZy5oICAgICAgIHwgICAgMiAr
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9leGVjbGlzdHMuYyAgfCAxNzc2ICst
LS0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jICAg
ICAgICB8IDE4NjUgKysrKysrKysrKysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3Vj
L2ludGVsX2d1Y19hZHMuYyAgICB8ICAgIDIgKy0KIC4uLi9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50
ZWxfZ3VjX3N1Ym1pc3Npb24uYyB8ICAgMjYgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9z
Y2hlZHVsZXIuYyAgICAgICAgICB8ICAgIDEgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9w
ZXJmLmMgICAgICAgICAgICAgIHwgICAgMiArLQogMTQgZmlsZXMgY2hhbmdlZCwgMzQ1NiBpbnNl
cnRpb25zKCspLCAzMzAwIGRlbGV0aW9ucygtKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L01ha2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUKaW5kZXggZjll
ZjUxOTliMTI0Li44NDljN2IzZmM5NDEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L01ha2VmaWxlCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCkBAIC0xMDQsNiAr
MTA0LDcgQEAgZ3QteSArPSBcCiAJZ3QvaW50ZWxfZ3RfcmVxdWVzdHMubyBcCiAJZ3QvaW50ZWxf
Z3R0Lm8gXAogCWd0L2ludGVsX2xsYy5vIFwKKwlndC9pbnRlbF9scmMubyBcCiAJZ3QvaW50ZWxf
bW9jcy5vIFwKIAlndC9pbnRlbF9wcGd0dC5vIFwKIAlndC9pbnRlbF9yYzYubyBcCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9nZW44X2VuZ2luZV9jcy5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvZ2VuOF9lbmdpbmVfY3MuYwppbmRleCA5YzZmMGViZmEzY2YuLjE5NzJk
ZDVkY2EwMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZ2VuOF9lbmdpbmVf
Y3MuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9nZW44X2VuZ2luZV9jcy5jCkBAIC01
LDcgKzUsNyBAQAogCiAjaW5jbHVkZSAiZ2VuOF9lbmdpbmVfY3MuaCIKICNpbmNsdWRlICJpOTE1
X2Rydi5oIgotI2luY2x1ZGUgImludGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uLmgiIC8qIFhYWCAq
LworI2luY2x1ZGUgImludGVsX2xyYy5oIgogI2luY2x1ZGUgImludGVsX2dwdV9jb21tYW5kcy5o
IgogI2luY2x1ZGUgImludGVsX3JpbmcuaCIKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfY29udGV4dF9zc2V1LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9jb250ZXh0X3NzZXUuYwppbmRleCA1Zjk0YjQ0MDIyZGMuLjhkZmQ4ZjY1NmFhYSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dF9zc2V1LmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dF9zc2V1LmMKQEAgLTgsOCAr
OCw3IEBACiAjaW5jbHVkZSAiaW50ZWxfY29udGV4dC5oIgogI2luY2x1ZGUgImludGVsX2VuZ2lu
ZV9wbS5oIgogI2luY2x1ZGUgImludGVsX2dwdV9jb21tYW5kcy5oIgotI2luY2x1ZGUgImludGVs
X2V4ZWNsaXN0c19zdWJtaXNzaW9uLmgiCi0jaW5jbHVkZSAiaW50ZWxfbHJjX3JlZy5oIgorI2lu
Y2x1ZGUgImludGVsX2xyYy5oIgogI2luY2x1ZGUgImludGVsX3JpbmcuaCIKICNpbmNsdWRlICJp
bnRlbF9zc2V1LmgiCiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2V4ZWNsaXN0c19zdWJtaXNzaW9uLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9l
eGVjbGlzdHNfc3VibWlzc2lvbi5jCmluZGV4IGRjZWNjMjg4Nzg5MS4uNjVmZjNmMzAxM2E3IDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9leGVjbGlzdHNfc3VibWlz
c2lvbi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2V4ZWNsaXN0c19zdWJt
aXNzaW9uLmMKQEAgLTEwOSw3ICsxMDksNiBAQAogI2luY2x1ZGUgPGxpbnV4L2ludGVycnVwdC5o
PgogCiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKLSNpbmNsdWRlICJpOTE1X3BlcmYuaCIKICNpbmNs
dWRlICJpOTE1X3RyYWNlLmgiCiAjaW5jbHVkZSAiaTkxNV92Z3B1LmgiCiAjaW5jbHVkZSAiZ2Vu
OF9lbmdpbmVfY3MuaCIKQEAgLTEyMCw2ICsxMTksNyBAQAogI2luY2x1ZGUgImludGVsX2d0Lmgi
CiAjaW5jbHVkZSAiaW50ZWxfZ3RfcG0uaCIKICNpbmNsdWRlICJpbnRlbF9ndF9yZXF1ZXN0cy5o
IgorI2luY2x1ZGUgImludGVsX2xyYy5oIgogI2luY2x1ZGUgImludGVsX2xyY19yZWcuaCIKICNp
bmNsdWRlICJpbnRlbF9tb2NzLmgiCiAjaW5jbHVkZSAiaW50ZWxfcmVzZXQuaCIKQEAgLTE0NCw4
ICsxNDQsNiBAQAogI2RlZmluZSBHRU44X0NUWF9TVEFUVVNfQ09NUExFVEVEX01BU0sgXAogCSAo
R0VOOF9DVFhfU1RBVFVTX0NPTVBMRVRFIHwgR0VOOF9DVFhfU1RBVFVTX1BSRUVNUFRFRCkKIAot
I2RlZmluZSBDVFhfREVTQ19GT1JDRV9SRVNUT1JFIEJJVF9VTEwoMikKLQogI2RlZmluZSBHRU4x
Ml9DVFhfU1RBVFVTX1NXSVRDSEVEX1RPX05FV19RVUVVRQkoMHgxKSAvKiBsb3dlciBjc2IgZHdv
cmQgKi8KICNkZWZpbmUgR0VOMTJfQ1RYX1NXSVRDSF9ERVRBSUwoY3NiX2R3KQkoKGNzYl9kdykg
JiAweEYpIC8qIHVwcGVyIGNzYiBkd29yZCAqLwogI2RlZmluZSBHRU4xMl9DU0JfU1dfQ1RYX0lE
X01BU0sJCUdFTk1BU0soMjUsIDE1KQpAQCAtMjA4LDEzMyArMjA2LDYgQEAgc3RhdGljIHN0cnVj
dCB2aXJ0dWFsX2VuZ2luZSAqdG9fdmlydHVhbF9lbmdpbmUoc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lKQogc3RhdGljIGludCBfX2V4ZWNsaXN0c19jb250ZXh0X2FsbG9jKHN0cnVjdCBp
bnRlbF9jb250ZXh0ICpjZSwKIAkJCQkgICAgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSk7CiAKLXN0YXRpYyB2b2lkIGV4ZWNsaXN0c19pbml0X3JlZ19zdGF0ZSh1MzIgKnJlZ19zdGF0
ZSwKLQkJCQkgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKLQkJCQkgICAgIGNv
bnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCQkgICAgIGNvbnN0IHN0cnVj
dCBpbnRlbF9yaW5nICpyaW5nLAotCQkJCSAgICAgYm9vbCBjbG9zZSk7Ci1zdGF0aWMgdm9pZAot
X19leGVjbGlzdHNfdXBkYXRlX3JlZ19zdGF0ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAq
Y2UsCi0JCQkgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCSAg
ICAgdTMyIGhlYWQpOwotCi1zdGF0aWMgaW50IGxyY19yaW5nX21pX21vZGUoY29uc3Qgc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQotewotCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1
KSA+PSAxMikKLQkJcmV0dXJuIDB4NjA7Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkx
NSkgPj0gOSkKLQkJcmV0dXJuIDB4NTQ7Ci0JZWxzZSBpZiAoZW5naW5lLT5jbGFzcyA9PSBSRU5E
RVJfQ0xBU1MpCi0JCXJldHVybiAweDU4OwotCWVsc2UKLQkJcmV0dXJuIC0xOwotfQotCi1zdGF0
aWMgaW50IGxyY19yaW5nX2dwcjAoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KQotewotCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMikKLQkJcmV0dXJuIDB4NzQ7
Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gOSkKLQkJcmV0dXJuIDB4Njg7
Ci0JZWxzZSBpZiAoZW5naW5lLT5jbGFzcyA9PSBSRU5ERVJfQ0xBU1MpCi0JCXJldHVybiAweGQ4
OwotCWVsc2UKLQkJcmV0dXJuIC0xOwotfQotCi1zdGF0aWMgaW50IGxyY19yaW5nX3dhX2JiX3Bl
cl9jdHgoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQotewotCWlmIChJTlRF
TF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMikKLQkJcmV0dXJuIDB4MTI7Ci0JZWxzZSBpZiAoSU5U
RUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gOSB8fCBlbmdpbmUtPmNsYXNzID09IFJFTkRFUl9DTEFT
UykKLQkJcmV0dXJuIDB4MTg7Ci0JZWxzZQotCQlyZXR1cm4gLTE7Ci19Ci0KLXN0YXRpYyBpbnQg
bHJjX3JpbmdfaW5kaXJlY3RfcHRyKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSkKLXsKLQlpbnQgeDsKLQotCXggPSBscmNfcmluZ193YV9iYl9wZXJfY3R4KGVuZ2luZSk7Ci0J
aWYgKHggPCAwKQotCQlyZXR1cm4geDsKLQotCXJldHVybiB4ICsgMjsKLX0KLQotc3RhdGljIGlu
dCBscmNfcmluZ19pbmRpcmVjdF9vZmZzZXQoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lKQotewotCWludCB4OwotCi0JeCA9IGxyY19yaW5nX2luZGlyZWN0X3B0cihlbmdpbmUp
OwotCWlmICh4IDwgMCkKLQkJcmV0dXJuIHg7Ci0KLQlyZXR1cm4geCArIDI7Ci19Ci0KLXN0YXRp
YyBpbnQgbHJjX3JpbmdfY21kX2J1Zl9jY3RsKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSkKLXsKLQlpZiAoZW5naW5lLT5jbGFzcyAhPSBSRU5ERVJfQ0xBU1MpCi0JCXJldHVy
biAtMTsKLQotCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMikKLQkJcmV0dXJuIDB4
YjY7Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTEpCi0JCXJldHVybiAw
eGFhOwotCWVsc2UKLQkJcmV0dXJuIC0xOwotfQotCi1zdGF0aWMgdTMyCi1scmNfcmluZ19pbmRp
cmVjdF9vZmZzZXRfZGVmYXVsdChjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUp
Ci17Ci0Jc3dpdGNoIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSkgewotCWRlZmF1bHQ6Ci0JCU1J
U1NJTkdfQ0FTRShJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSk7Ci0JCWZhbGx0aHJvdWdoOwotCWNh
c2UgMTI6Ci0JCXJldHVybiBHRU4xMl9DVFhfUkNTX0lORElSRUNUX0NUWF9PRkZTRVRfREVGQVVM
VDsKLQljYXNlIDExOgotCQlyZXR1cm4gR0VOMTFfQ1RYX1JDU19JTkRJUkVDVF9DVFhfT0ZGU0VU
X0RFRkFVTFQ7Ci0JY2FzZSAxMDoKLQkJcmV0dXJuIEdFTjEwX0NUWF9SQ1NfSU5ESVJFQ1RfQ1RY
X09GRlNFVF9ERUZBVUxUOwotCWNhc2UgOToKLQkJcmV0dXJuIEdFTjlfQ1RYX1JDU19JTkRJUkVD
VF9DVFhfT0ZGU0VUX0RFRkFVTFQ7Ci0JY2FzZSA4OgotCQlyZXR1cm4gR0VOOF9DVFhfUkNTX0lO
RElSRUNUX0NUWF9PRkZTRVRfREVGQVVMVDsKLQl9Ci19Ci0KLXN0YXRpYyB2b2lkCi1scmNfcmlu
Z19zZXR1cF9pbmRpcmVjdF9jdHgodTMyICpyZWdzLAotCQkJICAgIGNvbnN0IHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCSAgICB1MzIgY3R4X2JiX2dndHRfYWRkciwKLQkJCSAg
ICB1MzIgc2l6ZSkKLXsKLQlHRU1fQlVHX09OKCFzaXplKTsKLQlHRU1fQlVHX09OKCFJU19BTElH
TkVEKHNpemUsIENBQ0hFTElORV9CWVRFUykpOwotCUdFTV9CVUdfT04obHJjX3JpbmdfaW5kaXJl
Y3RfcHRyKGVuZ2luZSkgPT0gLTEpOwotCXJlZ3NbbHJjX3JpbmdfaW5kaXJlY3RfcHRyKGVuZ2lu
ZSkgKyAxXSA9Ci0JCWN0eF9iYl9nZ3R0X2FkZHIgfCAoc2l6ZSAvIENBQ0hFTElORV9CWVRFUyk7
Ci0KLQlHRU1fQlVHX09OKGxyY19yaW5nX2luZGlyZWN0X29mZnNldChlbmdpbmUpID09IC0xKTsK
LQlyZWdzW2xyY19yaW5nX2luZGlyZWN0X29mZnNldChlbmdpbmUpICsgMV0gPQotCQlscmNfcmlu
Z19pbmRpcmVjdF9vZmZzZXRfZGVmYXVsdChlbmdpbmUpIDw8IDY7Ci19Ci0KLXN0YXRpYyB1MzIg
aW50ZWxfY29udGV4dF9nZXRfcnVudGltZShjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2Up
Ci17Ci0JLyoKLQkgKiBXZSBjYW4gdXNlIGVpdGhlciBwcEhXU1BbMTZdIHdoaWNoIGlzIHJlY29y
ZGVkIGJlZm9yZSB0aGUgY29udGV4dAotCSAqIHN3aXRjaCAoYW5kIHNvIGV4Y2x1ZGVzIHRoZSBj
b3N0IG9mIGNvbnRleHQgc3dpdGNoZXMpIG9yIHVzZSB0aGUKLQkgKiB2YWx1ZSBmcm9tIHRoZSBj
b250ZXh0IGltYWdlIGl0c2VsZiwgd2hpY2ggaXMgc2F2ZWQvcmVzdG9yZWQgZWFybGllcgotCSAq
IGFuZCBzbyBpbmNsdWRlcyB0aGUgY29zdCBvZiB0aGUgc2F2ZS4KLQkgKi8KLQlyZXR1cm4gUkVB
RF9PTkNFKGNlLT5scmNfcmVnX3N0YXRlW0NUWF9USU1FU1RBTVBdKTsKLX0KLQogc3RhdGljIHZv
aWQgbWFya19laW8oc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiB7CiAJaWYgKGk5MTVfcmVxdWVz
dF9jb21wbGV0ZWQocnEpKQpAQCAtNTEzLDU2OCArMzg0LDYgQEAgYXNzZXJ0X3ByaW9yaXR5X3F1
ZXVlKGNvbnN0IHN0cnVjdCBpOTE1X3JlcXVlc3QgKnByZXYsCiAJcmV0dXJuIHJxX3ByaW8ocHJl
dikgPj0gcnFfcHJpbyhuZXh0KTsKIH0KIAotLyoKLSAqIFRoZSBjb250ZXh0IGRlc2NyaXB0b3Ig
ZW5jb2RlcyB2YXJpb3VzIGF0dHJpYnV0ZXMgb2YgYSBjb250ZXh0LAotICogaW5jbHVkaW5nIGl0
cyBHVFQgYWRkcmVzcyBhbmQgc29tZSBmbGFncy4gQmVjYXVzZSBpdCdzIGZhaXJseQotICogZXhw
ZW5zaXZlIHRvIGNhbGN1bGF0ZSwgd2UnbGwganVzdCBkbyBpdCBvbmNlIGFuZCBjYWNoZSB0aGUg
cmVzdWx0LAotICogd2hpY2ggcmVtYWlucyB2YWxpZCB1bnRpbCB0aGUgY29udGV4dCBpcyB1bnBp
bm5lZC4KLSAqCi0gKiBUaGlzIGlzIHdoYXQgYSBkZXNjcmlwdG9yIGxvb2tzIGxpa2UsIGZyb20g
TFNCIHRvIE1TQjo6Ci0gKgotICogICAgICBiaXRzICAwLTExOiAgICBmbGFncywgR0VOOF9DVFhf
KiAoY2FjaGVkIGluIGN0eC0+ZGVzY190ZW1wbGF0ZSkKLSAqICAgICAgYml0cyAxMi0zMTogICAg
TFJDQSwgR1RUIGFkZHJlc3Mgb2YgKHRoZSBIV1NQIG9mKSB0aGlzIGNvbnRleHQKLSAqICAgICAg
Yml0cyAzMi01MjogICAgY3R4IElELCBhIGdsb2JhbGx5IHVuaXF1ZSB0YWcgKGhpZ2hlc3QgYml0
IHVzZWQgYnkgR3VDKQotICogICAgICBiaXRzIDUzLTU0OiAgICBtYnosIHJlc2VydmVkIGZvciB1
c2UgYnkgaGFyZHdhcmUKLSAqICAgICAgYml0cyA1NS02MzogICAgZ3JvdXAgSUQsIGN1cnJlbnRs
eSB1bnVzZWQgYW5kIHNldCB0byAwCi0gKgotICogU3RhcnRpbmcgZnJvbSBHZW4xMSwgdGhlIHVw
cGVyIGR3b3JkIG9mIHRoZSBkZXNjcmlwdG9yIGhhcyBhIG5ldyBmb3JtYXQ6Ci0gKgotICogICAg
ICBiaXRzIDMyLTM2OiAgICByZXNlcnZlZAotICogICAgICBiaXRzIDM3LTQ3OiAgICBTVyBjb250
ZXh0IElECi0gKiAgICAgIGJpdHMgNDg6NTM6ICAgIGVuZ2luZSBpbnN0YW5jZQotICogICAgICBi
aXQgNTQ6ICAgICAgICBtYnosIHJlc2VydmVkIGZvciB1c2UgYnkgaGFyZHdhcmUKLSAqICAgICAg
Yml0cyA1NS02MDogICAgU1cgY291bnRlcgotICogICAgICBiaXRzIDYxLTYzOiAgICBlbmdpbmUg
Y2xhc3MKLSAqCi0gKiBlbmdpbmUgaW5mbywgU1cgY29udGV4dCBJRCBhbmQgU1cgY291bnRlciBu
ZWVkIHRvIGZvcm0gYSB1bmlxdWUgbnVtYmVyCi0gKiAoQ29udGV4dCBJRCkgcGVyIGxyYy4KLSAq
Lwotc3RhdGljIHUzMgotbHJjX2Rlc2NyaXB0b3Ioc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCBz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCi17Ci0JdTMyIGRlc2M7Ci0KLQlkZXNjID0g
SU5URUxfTEVHQUNZXzMyQl9DT05URVhUOwotCWlmIChpOTE1X3ZtX2lzXzRsdmwoY2UtPnZtKSkK
LQkJZGVzYyA9IElOVEVMX0xFR0FDWV82NEJfQ09OVEVYVDsKLQlkZXNjIDw8PSBHRU44X0NUWF9B
RERSRVNTSU5HX01PREVfU0hJRlQ7Ci0KLQlkZXNjIHw9IEdFTjhfQ1RYX1ZBTElEIHwgR0VOOF9D
VFhfUFJJVklMRUdFOwotCWlmIChJU19HRU4oZW5naW5lLT5pOTE1LCA4KSkKLQkJZGVzYyB8PSBH
RU44X0NUWF9MM0xMQ19DT0hFUkVOVDsKLQotCXJldHVybiBpOTE1X2dndHRfb2Zmc2V0KGNlLT5z
dGF0ZSkgfCBkZXNjOwotfQotCi1zdGF0aWMgaW5saW5lIHVuc2lnbmVkIGludCBkd29yZF9pbl9w
YWdlKHZvaWQgKmFkZHIpCi17Ci0JcmV0dXJuIG9mZnNldF9pbl9wYWdlKGFkZHIpIC8gc2l6ZW9m
KHUzMik7Ci19Ci0KLXN0YXRpYyB2b2lkIHNldF9vZmZzZXRzKHUzMiAqcmVncywKLQkJCWNvbnN0
IHU4ICpkYXRhLAotCQkJY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAotCQkJ
Ym9vbCBjbGVhcikKLSNkZWZpbmUgTk9QKHgpIChCSVQoNykgfCAoeCkpCi0jZGVmaW5lIExSSShj
b3VudCwgZmxhZ3MpICgoZmxhZ3MpIDw8IDYgfCAoY291bnQpIHwgQlVJTERfQlVHX09OX1pFUk8o
Y291bnQgPj0gQklUKDYpKSkKLSNkZWZpbmUgUE9TVEVEIEJJVCgwKQotI2RlZmluZSBSRUcoeCkg
KCgoeCkgPj4gMikgfCBCVUlMRF9CVUdfT05fWkVSTyh4ID49IDB4MjAwKSkKLSNkZWZpbmUgUkVH
MTYoeCkgXAotCSgoKHgpID4+IDkpIHwgQklUKDcpIHwgQlVJTERfQlVHX09OX1pFUk8oeCA+PSAw
eDEwMDAwKSksIFwKLQkoKCh4KSA+PiAyKSAmIDB4N2YpCi0jZGVmaW5lIEVORCh0b3RhbF9zdGF0
ZV9zaXplKSAwLCAodG90YWxfc3RhdGVfc2l6ZSkKLXsKLQljb25zdCB1MzIgYmFzZSA9IGVuZ2lu
ZS0+bW1pb19iYXNlOwotCi0Jd2hpbGUgKCpkYXRhKSB7Ci0JCXU4IGNvdW50LCBmbGFnczsKLQot
CQlpZiAoKmRhdGEgJiBCSVQoNykpIHsgLyogc2tpcCAqLwotCQkJY291bnQgPSAqZGF0YSsrICYg
fkJJVCg3KTsKLQkJCWlmIChjbGVhcikKLQkJCQltZW1zZXQzMihyZWdzLCBNSV9OT09QLCBjb3Vu
dCk7Ci0JCQlyZWdzICs9IGNvdW50OwotCQkJY29udGludWU7Ci0JCX0KLQotCQljb3VudCA9ICpk
YXRhICYgMHgzZjsKLQkJZmxhZ3MgPSAqZGF0YSA+PiA2OwotCQlkYXRhKys7Ci0KLQkJKnJlZ3Mg
PSBNSV9MT0FEX1JFR0lTVEVSX0lNTShjb3VudCk7Ci0JCWlmIChmbGFncyAmIFBPU1RFRCkKLQkJ
CSpyZWdzIHw9IE1JX0xSSV9GT1JDRV9QT1NURUQ7Ci0JCWlmIChJTlRFTF9HRU4oZW5naW5lLT5p
OTE1KSA+PSAxMSkKLQkJCSpyZWdzIHw9IE1JX0xSSV9MUk1fQ1NfTU1JTzsKLQkJcmVncysrOwot
Ci0JCUdFTV9CVUdfT04oIWNvdW50KTsKLQkJZG8gewotCQkJdTMyIG9mZnNldCA9IDA7Ci0JCQl1
OCB2OwotCi0JCQlkbyB7Ci0JCQkJdiA9ICpkYXRhKys7Ci0JCQkJb2Zmc2V0IDw8PSA3OwotCQkJ
CW9mZnNldCB8PSB2ICYgfkJJVCg3KTsKLQkJCX0gd2hpbGUgKHYgJiBCSVQoNykpOwotCi0JCQly
ZWdzWzBdID0gYmFzZSArIChvZmZzZXQgPDwgMik7Ci0JCQlpZiAoY2xlYXIpCi0JCQkJcmVnc1sx
XSA9IDA7Ci0JCQlyZWdzICs9IDI7Ci0JCX0gd2hpbGUgKC0tY291bnQpOwotCX0KLQotCWlmIChj
bGVhcikgewotCQl1OCBjb3VudCA9ICorK2RhdGE7Ci0KLQkJLyogQ2xlYXIgcGFzdCB0aGUgdGFp
bCBmb3IgSFcgYWNjZXNzICovCi0JCUdFTV9CVUdfT04oZHdvcmRfaW5fcGFnZShyZWdzKSA+IGNv
dW50KTsKLQkJbWVtc2V0MzIocmVncywgTUlfTk9PUCwgY291bnQgLSBkd29yZF9pbl9wYWdlKHJl
Z3MpKTsKLQotCQkvKiBDbG9zZSB0aGUgYmF0Y2g7IHVzZWQgbWFpbmx5IGJ5IGxpdmVfbHJjX2xh
eW91dCgpICovCi0JCSpyZWdzID0gTUlfQkFUQ0hfQlVGRkVSX0VORDsKLQkJaWYgKElOVEVMX0dF
TihlbmdpbmUtPmk5MTUpID49IDEwKQotCQkJKnJlZ3MgfD0gQklUKDApOwotCX0KLX0KLQotc3Rh
dGljIGNvbnN0IHU4IGdlbjhfeGNzX29mZnNldHNbXSA9IHsKLQlOT1AoMSksCi0JTFJJKDExLCAw
KSwKLQlSRUcxNigweDI0NCksCi0JUkVHKDB4MDM0KSwKLQlSRUcoMHgwMzApLAotCVJFRygweDAz
OCksCi0JUkVHKDB4MDNjKSwKLQlSRUcoMHgxNjgpLAotCVJFRygweDE0MCksCi0JUkVHKDB4MTEw
KSwKLQlSRUcoMHgxMWMpLAotCVJFRygweDExNCksCi0JUkVHKDB4MTE4KSwKLQotCU5PUCg5KSwK
LQlMUkkoOSwgMCksCi0JUkVHMTYoMHgzYTgpLAotCVJFRzE2KDB4MjhjKSwKLQlSRUcxNigweDI4
OCksCi0JUkVHMTYoMHgyODQpLAotCVJFRzE2KDB4MjgwKSwKLQlSRUcxNigweDI3YyksCi0JUkVH
MTYoMHgyNzgpLAotCVJFRzE2KDB4Mjc0KSwKLQlSRUcxNigweDI3MCksCi0KLQlOT1AoMTMpLAot
CUxSSSgyLCAwKSwKLQlSRUcxNigweDIwMCksCi0JUkVHKDB4MDI4KSwKLQotCUVORCg4MCkKLX07
Ci0KLXN0YXRpYyBjb25zdCB1OCBnZW45X3hjc19vZmZzZXRzW10gPSB7Ci0JTk9QKDEpLAotCUxS
SSgxNCwgUE9TVEVEKSwKLQlSRUcxNigweDI0NCksCi0JUkVHKDB4MDM0KSwKLQlSRUcoMHgwMzAp
LAotCVJFRygweDAzOCksCi0JUkVHKDB4MDNjKSwKLQlSRUcoMHgxNjgpLAotCVJFRygweDE0MCks
Ci0JUkVHKDB4MTEwKSwKLQlSRUcoMHgxMWMpLAotCVJFRygweDExNCksCi0JUkVHKDB4MTE4KSwK
LQlSRUcoMHgxYzApLAotCVJFRygweDFjNCksCi0JUkVHKDB4MWM4KSwKLQotCU5PUCgzKSwKLQlM
UkkoOSwgUE9TVEVEKSwKLQlSRUcxNigweDNhOCksCi0JUkVHMTYoMHgyOGMpLAotCVJFRzE2KDB4
Mjg4KSwKLQlSRUcxNigweDI4NCksCi0JUkVHMTYoMHgyODApLAotCVJFRzE2KDB4MjdjKSwKLQlS
RUcxNigweDI3OCksCi0JUkVHMTYoMHgyNzQpLAotCVJFRzE2KDB4MjcwKSwKLQotCU5PUCgxMyks
Ci0JTFJJKDEsIFBPU1RFRCksCi0JUkVHMTYoMHgyMDApLAotCi0JTk9QKDEzKSwKLQlMUkkoNDQs
IFBPU1RFRCksCi0JUkVHKDB4MDI4KSwKLQlSRUcoMHgwOWMpLAotCVJFRygweDBjMCksCi0JUkVH
KDB4MTc4KSwKLQlSRUcoMHgxN2MpLAotCVJFRzE2KDB4MzU4KSwKLQlSRUcoMHgxNzApLAotCVJF
RygweDE1MCksCi0JUkVHKDB4MTU0KSwKLQlSRUcoMHgxNTgpLAotCVJFRzE2KDB4NDFjKSwKLQlS
RUcxNigweDYwMCksCi0JUkVHMTYoMHg2MDQpLAotCVJFRzE2KDB4NjA4KSwKLQlSRUcxNigweDYw
YyksCi0JUkVHMTYoMHg2MTApLAotCVJFRzE2KDB4NjE0KSwKLQlSRUcxNigweDYxOCksCi0JUkVH
MTYoMHg2MWMpLAotCVJFRzE2KDB4NjIwKSwKLQlSRUcxNigweDYyNCksCi0JUkVHMTYoMHg2Mjgp
LAotCVJFRzE2KDB4NjJjKSwKLQlSRUcxNigweDYzMCksCi0JUkVHMTYoMHg2MzQpLAotCVJFRzE2
KDB4NjM4KSwKLQlSRUcxNigweDYzYyksCi0JUkVHMTYoMHg2NDApLAotCVJFRzE2KDB4NjQ0KSwK
LQlSRUcxNigweDY0OCksCi0JUkVHMTYoMHg2NGMpLAotCVJFRzE2KDB4NjUwKSwKLQlSRUcxNigw
eDY1NCksCi0JUkVHMTYoMHg2NTgpLAotCVJFRzE2KDB4NjVjKSwKLQlSRUcxNigweDY2MCksCi0J
UkVHMTYoMHg2NjQpLAotCVJFRzE2KDB4NjY4KSwKLQlSRUcxNigweDY2YyksCi0JUkVHMTYoMHg2
NzApLAotCVJFRzE2KDB4Njc0KSwKLQlSRUcxNigweDY3OCksCi0JUkVHMTYoMHg2N2MpLAotCVJF
RygweDA2OCksCi0KLQlFTkQoMTc2KQotfTsKLQotc3RhdGljIGNvbnN0IHU4IGdlbjEyX3hjc19v
ZmZzZXRzW10gPSB7Ci0JTk9QKDEpLAotCUxSSSgxMywgUE9TVEVEKSwKLQlSRUcxNigweDI0NCks
Ci0JUkVHKDB4MDM0KSwKLQlSRUcoMHgwMzApLAotCVJFRygweDAzOCksCi0JUkVHKDB4MDNjKSwK
LQlSRUcoMHgxNjgpLAotCVJFRygweDE0MCksCi0JUkVHKDB4MTEwKSwKLQlSRUcoMHgxYzApLAot
CVJFRygweDFjNCksCi0JUkVHKDB4MWM4KSwKLQlSRUcoMHgxODApLAotCVJFRzE2KDB4MmI0KSwK
LQotCU5PUCg1KSwKLQlMUkkoOSwgUE9TVEVEKSwKLQlSRUcxNigweDNhOCksCi0JUkVHMTYoMHgy
OGMpLAotCVJFRzE2KDB4Mjg4KSwKLQlSRUcxNigweDI4NCksCi0JUkVHMTYoMHgyODApLAotCVJF
RzE2KDB4MjdjKSwKLQlSRUcxNigweDI3OCksCi0JUkVHMTYoMHgyNzQpLAotCVJFRzE2KDB4Mjcw
KSwKLQotCUVORCg4MCkKLX07Ci0KLXN0YXRpYyBjb25zdCB1OCBnZW44X3Jjc19vZmZzZXRzW10g
PSB7Ci0JTk9QKDEpLAotCUxSSSgxNCwgUE9TVEVEKSwKLQlSRUcxNigweDI0NCksCi0JUkVHKDB4
MDM0KSwKLQlSRUcoMHgwMzApLAotCVJFRygweDAzOCksCi0JUkVHKDB4MDNjKSwKLQlSRUcoMHgx
NjgpLAotCVJFRygweDE0MCksCi0JUkVHKDB4MTEwKSwKLQlSRUcoMHgxMWMpLAotCVJFRygweDEx
NCksCi0JUkVHKDB4MTE4KSwKLQlSRUcoMHgxYzApLAotCVJFRygweDFjNCksCi0JUkVHKDB4MWM4
KSwKLQotCU5PUCgzKSwKLQlMUkkoOSwgUE9TVEVEKSwKLQlSRUcxNigweDNhOCksCi0JUkVHMTYo
MHgyOGMpLAotCVJFRzE2KDB4Mjg4KSwKLQlSRUcxNigweDI4NCksCi0JUkVHMTYoMHgyODApLAot
CVJFRzE2KDB4MjdjKSwKLQlSRUcxNigweDI3OCksCi0JUkVHMTYoMHgyNzQpLAotCVJFRzE2KDB4
MjcwKSwKLQotCU5PUCgxMyksCi0JTFJJKDEsIDApLAotCVJFRygweDBjOCksCi0KLQlFTkQoODAp
Ci19OwotCi1zdGF0aWMgY29uc3QgdTggZ2VuOV9yY3Nfb2Zmc2V0c1tdID0gewotCU5PUCgxKSwK
LQlMUkkoMTQsIFBPU1RFRCksCi0JUkVHMTYoMHgyNDQpLAotCVJFRygweDM0KSwKLQlSRUcoMHgz
MCksCi0JUkVHKDB4MzgpLAotCVJFRygweDNjKSwKLQlSRUcoMHgxNjgpLAotCVJFRygweDE0MCks
Ci0JUkVHKDB4MTEwKSwKLQlSRUcoMHgxMWMpLAotCVJFRygweDExNCksCi0JUkVHKDB4MTE4KSwK
LQlSRUcoMHgxYzApLAotCVJFRygweDFjNCksCi0JUkVHKDB4MWM4KSwKLQotCU5PUCgzKSwKLQlM
UkkoOSwgUE9TVEVEKSwKLQlSRUcxNigweDNhOCksCi0JUkVHMTYoMHgyOGMpLAotCVJFRzE2KDB4
Mjg4KSwKLQlSRUcxNigweDI4NCksCi0JUkVHMTYoMHgyODApLAotCVJFRzE2KDB4MjdjKSwKLQlS
RUcxNigweDI3OCksCi0JUkVHMTYoMHgyNzQpLAotCVJFRzE2KDB4MjcwKSwKLQotCU5PUCgxMyks
Ci0JTFJJKDEsIDApLAotCVJFRygweGM4KSwKLQotCU5PUCgxMyksCi0JTFJJKDQ0LCBQT1NURUQp
LAotCVJFRygweDI4KSwKLQlSRUcoMHg5YyksCi0JUkVHKDB4YzApLAotCVJFRygweDE3OCksCi0J
UkVHKDB4MTdjKSwKLQlSRUcxNigweDM1OCksCi0JUkVHKDB4MTcwKSwKLQlSRUcoMHgxNTApLAot
CVJFRygweDE1NCksCi0JUkVHKDB4MTU4KSwKLQlSRUcxNigweDQxYyksCi0JUkVHMTYoMHg2MDAp
LAotCVJFRzE2KDB4NjA0KSwKLQlSRUcxNigweDYwOCksCi0JUkVHMTYoMHg2MGMpLAotCVJFRzE2
KDB4NjEwKSwKLQlSRUcxNigweDYxNCksCi0JUkVHMTYoMHg2MTgpLAotCVJFRzE2KDB4NjFjKSwK
LQlSRUcxNigweDYyMCksCi0JUkVHMTYoMHg2MjQpLAotCVJFRzE2KDB4NjI4KSwKLQlSRUcxNigw
eDYyYyksCi0JUkVHMTYoMHg2MzApLAotCVJFRzE2KDB4NjM0KSwKLQlSRUcxNigweDYzOCksCi0J
UkVHMTYoMHg2M2MpLAotCVJFRzE2KDB4NjQwKSwKLQlSRUcxNigweDY0NCksCi0JUkVHMTYoMHg2
NDgpLAotCVJFRzE2KDB4NjRjKSwKLQlSRUcxNigweDY1MCksCi0JUkVHMTYoMHg2NTQpLAotCVJF
RzE2KDB4NjU4KSwKLQlSRUcxNigweDY1YyksCi0JUkVHMTYoMHg2NjApLAotCVJFRzE2KDB4NjY0
KSwKLQlSRUcxNigweDY2OCksCi0JUkVHMTYoMHg2NmMpLAotCVJFRzE2KDB4NjcwKSwKLQlSRUcx
NigweDY3NCksCi0JUkVHMTYoMHg2NzgpLAotCVJFRzE2KDB4NjdjKSwKLQlSRUcoMHg2OCksCi0K
LQlFTkQoMTc2KQotfTsKLQotc3RhdGljIGNvbnN0IHU4IGdlbjExX3Jjc19vZmZzZXRzW10gPSB7
Ci0JTk9QKDEpLAotCUxSSSgxNSwgUE9TVEVEKSwKLQlSRUcxNigweDI0NCksCi0JUkVHKDB4MDM0
KSwKLQlSRUcoMHgwMzApLAotCVJFRygweDAzOCksCi0JUkVHKDB4MDNjKSwKLQlSRUcoMHgxNjgp
LAotCVJFRygweDE0MCksCi0JUkVHKDB4MTEwKSwKLQlSRUcoMHgxMWMpLAotCVJFRygweDExNCks
Ci0JUkVHKDB4MTE4KSwKLQlSRUcoMHgxYzApLAotCVJFRygweDFjNCksCi0JUkVHKDB4MWM4KSwK
LQlSRUcoMHgxODApLAotCi0JTk9QKDEpLAotCUxSSSg5LCBQT1NURUQpLAotCVJFRzE2KDB4M2E4
KSwKLQlSRUcxNigweDI4YyksCi0JUkVHMTYoMHgyODgpLAotCVJFRzE2KDB4Mjg0KSwKLQlSRUcx
NigweDI4MCksCi0JUkVHMTYoMHgyN2MpLAotCVJFRzE2KDB4Mjc4KSwKLQlSRUcxNigweDI3NCks
Ci0JUkVHMTYoMHgyNzApLAotCi0JTFJJKDEsIFBPU1RFRCksCi0JUkVHKDB4MWIwKSwKLQotCU5P
UCgxMCksCi0JTFJJKDEsIDApLAotCVJFRygweDBjOCksCi0KLQlFTkQoODApCi19OwotCi1zdGF0
aWMgY29uc3QgdTggZ2VuMTJfcmNzX29mZnNldHNbXSA9IHsKLQlOT1AoMSksCi0JTFJJKDEzLCBQ
T1NURUQpLAotCVJFRzE2KDB4MjQ0KSwKLQlSRUcoMHgwMzQpLAotCVJFRygweDAzMCksCi0JUkVH
KDB4MDM4KSwKLQlSRUcoMHgwM2MpLAotCVJFRygweDE2OCksCi0JUkVHKDB4MTQwKSwKLQlSRUco
MHgxMTApLAotCVJFRygweDFjMCksCi0JUkVHKDB4MWM0KSwKLQlSRUcoMHgxYzgpLAotCVJFRygw
eDE4MCksCi0JUkVHMTYoMHgyYjQpLAotCi0JTk9QKDUpLAotCUxSSSg5LCBQT1NURUQpLAotCVJF
RzE2KDB4M2E4KSwKLQlSRUcxNigweDI4YyksCi0JUkVHMTYoMHgyODgpLAotCVJFRzE2KDB4Mjg0
KSwKLQlSRUcxNigweDI4MCksCi0JUkVHMTYoMHgyN2MpLAotCVJFRzE2KDB4Mjc4KSwKLQlSRUcx
NigweDI3NCksCi0JUkVHMTYoMHgyNzApLAotCi0JTFJJKDMsIFBPU1RFRCksCi0JUkVHKDB4MWIw
KSwKLQlSRUcxNigweDVhOCksCi0JUkVHMTYoMHg1YWMpLAotCi0JTk9QKDYpLAotCUxSSSgxLCAw
KSwKLQlSRUcoMHgwYzgpLAotCU5PUCgzICsgOSArIDEpLAotCi0JTFJJKDUxLCBQT1NURUQpLAot
CVJFRzE2KDB4NTg4KSwKLQlSRUcxNigweDU4OCksCi0JUkVHMTYoMHg1ODgpLAotCVJFRzE2KDB4
NTg4KSwKLQlSRUcxNigweDU4OCksCi0JUkVHMTYoMHg1ODgpLAotCVJFRygweDAyOCksCi0JUkVH
KDB4MDljKSwKLQlSRUcoMHgwYzApLAotCVJFRygweDE3OCksCi0JUkVHKDB4MTdjKSwKLQlSRUcx
NigweDM1OCksCi0JUkVHKDB4MTcwKSwKLQlSRUcoMHgxNTApLAotCVJFRygweDE1NCksCi0JUkVH
KDB4MTU4KSwKLQlSRUcxNigweDQxYyksCi0JUkVHMTYoMHg2MDApLAotCVJFRzE2KDB4NjA0KSwK
LQlSRUcxNigweDYwOCksCi0JUkVHMTYoMHg2MGMpLAotCVJFRzE2KDB4NjEwKSwKLQlSRUcxNigw
eDYxNCksCi0JUkVHMTYoMHg2MTgpLAotCVJFRzE2KDB4NjFjKSwKLQlSRUcxNigweDYyMCksCi0J
UkVHMTYoMHg2MjQpLAotCVJFRzE2KDB4NjI4KSwKLQlSRUcxNigweDYyYyksCi0JUkVHMTYoMHg2
MzApLAotCVJFRzE2KDB4NjM0KSwKLQlSRUcxNigweDYzOCksCi0JUkVHMTYoMHg2M2MpLAotCVJF
RzE2KDB4NjQwKSwKLQlSRUcxNigweDY0NCksCi0JUkVHMTYoMHg2NDgpLAotCVJFRzE2KDB4NjRj
KSwKLQlSRUcxNigweDY1MCksCi0JUkVHMTYoMHg2NTQpLAotCVJFRzE2KDB4NjU4KSwKLQlSRUcx
NigweDY1YyksCi0JUkVHMTYoMHg2NjApLAotCVJFRzE2KDB4NjY0KSwKLQlSRUcxNigweDY2OCks
Ci0JUkVHMTYoMHg2NmMpLAotCVJFRzE2KDB4NjcwKSwKLQlSRUcxNigweDY3NCksCi0JUkVHMTYo
MHg2NzgpLAotCVJFRzE2KDB4NjdjKSwKLQlSRUcoMHgwNjgpLAotCVJFRygweDA4NCksCi0JTk9Q
KDEpLAotCi0JRU5EKDE5MikKLX07Ci0KLSN1bmRlZiBFTkQKLSN1bmRlZiBSRUcxNgotI3VuZGVm
IFJFRwotI3VuZGVmIExSSQotI3VuZGVmIE5PUAotCi1zdGF0aWMgY29uc3QgdTggKnJlZ19vZmZz
ZXRzKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKLXsKLQkvKgotCSAqIFRo
ZSBnZW4xMisgbGlzdHMgb25seSBoYXZlIHRoZSByZWdpc3RlcnMgd2UgcHJvZ3JhbSBpbiB0aGUg
YmFzaWMKLQkgKiBkZWZhdWx0IHN0YXRlLiBXZSByZWx5IG9uIHRoZSBjb250ZXh0IGltYWdlIHVz
aW5nIHJlbGF0aXZlCi0JICogYWRkcmVzc2luZyB0byBhdXRvbWF0aWMgZml4dXAgdGhlIHJlZ2lz
dGVyIHN0YXRlIGJldHdlZW4gdGhlCi0JICogcGh5c2ljYWwgZW5naW5lcyBmb3IgdmlydHVhbCBl
bmdpbmUuCi0JICovCi0JR0VNX0JVR19PTihJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMiAm
JgotCQkgICAhaW50ZWxfZW5naW5lX2hhc19yZWxhdGl2ZV9tbWlvKGVuZ2luZSkpOwotCi0JaWYg
KGVuZ2luZS0+Y2xhc3MgPT0gUkVOREVSX0NMQVNTKSB7Ci0JCWlmIChJTlRFTF9HRU4oZW5naW5l
LT5pOTE1KSA+PSAxMikKLQkJCXJldHVybiBnZW4xMl9yY3Nfb2Zmc2V0czsKLQkJZWxzZSBpZiAo
SU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTEpCi0JCQlyZXR1cm4gZ2VuMTFfcmNzX29mZnNl
dHM7Ci0JCWVsc2UgaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDkpCi0JCQlyZXR1cm4g
Z2VuOV9yY3Nfb2Zmc2V0czsKLQkJZWxzZQotCQkJcmV0dXJuIGdlbjhfcmNzX29mZnNldHM7Ci0J
fSBlbHNlIHsKLQkJaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDEyKQotCQkJcmV0dXJu
IGdlbjEyX3hjc19vZmZzZXRzOwotCQllbHNlIGlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+
PSA5KQotCQkJcmV0dXJuIGdlbjlfeGNzX29mZnNldHM7Ci0JCWVsc2UKLQkJCXJldHVybiBnZW44
X3hjc19vZmZzZXRzOwotCX0KLX0KLQogc3RhdGljIHN0cnVjdCBpOTE1X3JlcXVlc3QgKgogX191
bndpbmRfaW5jb21wbGV0ZV9yZXF1ZXN0cyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUp
CiB7CkBAIC0xMTg3LDU4ICs0OTYsNiBAQCBzdGF0aWMgdm9pZCBpbnRlbF9lbmdpbmVfY29udGV4
dF9vdXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCXdyaXRlX3NlcXVubG9ja19p
cnFyZXN0b3JlKCZlbmdpbmUtPnN0YXRzLmxvY2ssIGZsYWdzKTsKIH0KIAotc3RhdGljIHZvaWQK
LWV4ZWNsaXN0c19jaGVja19jb250ZXh0KGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwK
LQkJCWNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCWNvbnN0IGNoYXIg
KndoZW4pCi17Ci0JY29uc3Qgc3RydWN0IGludGVsX3JpbmcgKnJpbmcgPSBjZS0+cmluZzsKLQl1
MzIgKnJlZ3MgPSBjZS0+bHJjX3JlZ19zdGF0ZTsKLQlib29sIHZhbGlkID0gdHJ1ZTsKLQlpbnQg
eDsKLQotCWlmIChyZWdzW0NUWF9SSU5HX1NUQVJUXSAhPSBpOTE1X2dndHRfb2Zmc2V0KHJpbmct
PnZtYSkpIHsKLQkJcHJfZXJyKCIlczogY29udGV4dCBzdWJtaXR0ZWQgd2l0aCBpbmNvcnJlY3Qg
UklOR19TVEFSVCBbJTA4eF0sIGV4cGVjdGVkICUwOHhcbiIsCi0JCSAgICAgICBlbmdpbmUtPm5h
bWUsCi0JCSAgICAgICByZWdzW0NUWF9SSU5HX1NUQVJUXSwKLQkJICAgICAgIGk5MTVfZ2d0dF9v
ZmZzZXQocmluZy0+dm1hKSk7Ci0JCXJlZ3NbQ1RYX1JJTkdfU1RBUlRdID0gaTkxNV9nZ3R0X29m
ZnNldChyaW5nLT52bWEpOwotCQl2YWxpZCA9IGZhbHNlOwotCX0KLQotCWlmICgocmVnc1tDVFhf
UklOR19DVExdICYgfihSSU5HX1dBSVQgfCBSSU5HX1dBSVRfU0VNQVBIT1JFKSkgIT0KLQkgICAg
KFJJTkdfQ1RMX1NJWkUocmluZy0+c2l6ZSkgfCBSSU5HX1ZBTElEKSkgewotCQlwcl9lcnIoIiVz
OiBjb250ZXh0IHN1Ym1pdHRlZCB3aXRoIGluY29ycmVjdCBSSU5HX0NUTCBbJTA4eF0sIGV4cGVj
dGVkICUwOHhcbiIsCi0JCSAgICAgICBlbmdpbmUtPm5hbWUsCi0JCSAgICAgICByZWdzW0NUWF9S
SU5HX0NUTF0sCi0JCSAgICAgICAodTMyKShSSU5HX0NUTF9TSVpFKHJpbmctPnNpemUpIHwgUklO
R19WQUxJRCkpOwotCQlyZWdzW0NUWF9SSU5HX0NUTF0gPSBSSU5HX0NUTF9TSVpFKHJpbmctPnNp
emUpIHwgUklOR19WQUxJRDsKLQkJdmFsaWQgPSBmYWxzZTsKLQl9Ci0KLQl4ID0gbHJjX3Jpbmdf
bWlfbW9kZShlbmdpbmUpOwotCWlmICh4ICE9IC0xICYmIHJlZ3NbeCArIDFdICYgKHJlZ3NbeCAr
IDFdID4+IDE2KSAmIFNUT1BfUklORykgewotCQlwcl9lcnIoIiVzOiBjb250ZXh0IHN1Ym1pdHRl
ZCB3aXRoIFNUT1BfUklORyBbJTA4eF0gaW4gUklOR19NSV9NT0RFXG4iLAotCQkgICAgICAgZW5n
aW5lLT5uYW1lLCByZWdzW3ggKyAxXSk7Ci0JCXJlZ3NbeCArIDFdICY9IH5TVE9QX1JJTkc7Ci0J
CXJlZ3NbeCArIDFdIHw9IFNUT1BfUklORyA8PCAxNjsKLQkJdmFsaWQgPSBmYWxzZTsKLQl9Ci0K
LQlXQVJOX09OQ0UoIXZhbGlkLCAiSW52YWxpZCBscmMgc3RhdGUgZm91bmQgJXMgc3VibWlzc2lv
blxuIiwgd2hlbik7Ci19Ci0KLXN0YXRpYyB2b2lkIHJlc3RvcmVfZGVmYXVsdF9zdGF0ZShzdHJ1
Y3QgaW50ZWxfY29udGV4dCAqY2UsCi0JCQkJICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpCi17Ci0JdTMyICpyZWdzOwotCi0JcmVncyA9IG1lbXNldChjZS0+bHJjX3JlZ19zdGF0ZSwg
MCwgZW5naW5lLT5jb250ZXh0X3NpemUgLSBQQUdFX1NJWkUpOwotCWV4ZWNsaXN0c19pbml0X3Jl
Z19zdGF0ZShyZWdzLCBjZSwgZW5naW5lLCBjZS0+cmluZywgdHJ1ZSk7Ci0KLQljZS0+cnVudGlt
ZS5sYXN0ID0gaW50ZWxfY29udGV4dF9nZXRfcnVudGltZShjZSk7Ci19Ci0KIHN0YXRpYyB2b2lk
IHJlc2V0X2FjdGl2ZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKIAkJCSBzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUpCiB7CkBAIC0xMjcxLDExICs1MjgsMTAgQEAgc3RhdGljIHZvaWQg
cmVzZXRfYWN0aXZlKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAogCWhlYWQgPSBpbnRlbF9yaW5n
X3dyYXAoY2UtPnJpbmcsIGhlYWQpOwogCiAJLyogU2NydWIgdGhlIGNvbnRleHQgaW1hZ2UgdG8g
cHJldmVudCByZXBsYXlpbmcgdGhlIHByZXZpb3VzIGJhdGNoICovCi0JcmVzdG9yZV9kZWZhdWx0
X3N0YXRlKGNlLCBlbmdpbmUpOwotCV9fZXhlY2xpc3RzX3VwZGF0ZV9yZWdfc3RhdGUoY2UsIGVu
Z2luZSwgaGVhZCk7CisJbHJjX3Jlc3RvcmVfZGVmYXVsdHMoY2UsIGVuZ2luZSk7CiAKIAkvKiBX
ZSd2ZSBzd2l0Y2hlZCBhd2F5LCBzbyB0aGlzIHNob3VsZCBiZSBhIG5vLW9wLCBidXQgaW50ZW50
IG1hdHRlcnMgKi8KLQljZS0+bHJjLmRlc2MgfD0gQ1RYX0RFU0NfRk9SQ0VfUkVTVE9SRTsKKwlj
ZS0+bHJjLmxyY2EgPSBscmNfdXBkYXRlX3JlZ3MoY2UsIGVuZ2luZSwgaGVhZCk7CiB9CiAKIHN0
YXRpYyB2b2lkIHN0X3VwZGF0ZV9ydW50aW1lX3VuZGVyZmxvdyhzdHJ1Y3QgaW50ZWxfY29udGV4
dCAqY2UsIHMzMiBkdCkKQEAgLTEyOTUsNyArNTUxLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfY29u
dGV4dF91cGRhdGVfcnVudGltZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCiAJCXJldHVybjsK
IAogCW9sZCA9IGNlLT5ydW50aW1lLmxhc3Q7Ci0JY2UtPnJ1bnRpbWUubGFzdCA9IGludGVsX2Nv
bnRleHRfZ2V0X3J1bnRpbWUoY2UpOworCWNlLT5ydW50aW1lLmxhc3QgPSBscmNfZ2V0X3J1bnRp
bWUoY2UpOwogCWR0ID0gY2UtPnJ1bnRpbWUubGFzdCAtIG9sZDsKIAogCWlmICh1bmxpa2VseShk
dCA8IDApKSB7CkBAIC0xMzIxLDcgKzU3Nyw3IEBAIF9fZXhlY2xpc3RzX3NjaGVkdWxlX2luKHN0
cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogCQlyZXNldF9hY3RpdmUocnEsIGVuZ2luZSk7CiAKIAlp
ZiAoSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfREVCVUdfR0VNKSkKLQkJZXhlY2xpc3RzX2No
ZWNrX2NvbnRleHQoY2UsIGVuZ2luZSwgImJlZm9yZSIpOworCQlscmNfY2hlY2tfcmVncyhjZSwg
ZW5naW5lLCAiYmVmb3JlIik7CiAKIAlpZiAoY2UtPnRhZykgewogCQkvKiBVc2UgYSBmaXhlZCB0
YWcgZm9yIE9BIGFuZCBmcmllbmRzICovCkBAIC0xMzkzLDcgKzY0OSw3IEBAIF9fZXhlY2xpc3Rz
X3NjaGVkdWxlX291dChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKIAkgKi8KIAogCWlmIChJU19F
TkFCTEVEKENPTkZJR19EUk1fSTkxNV9ERUJVR19HRU0pKQotCQlleGVjbGlzdHNfY2hlY2tfY29u
dGV4dChjZSwgZW5naW5lLCAiYWZ0ZXIiKTsKKwkJbHJjX2NoZWNrX3JlZ3MoY2UsIGVuZ2luZSwg
ImFmdGVyIik7CiAKIAkvKgogCSAqIElmIHdlIGhhdmUganVzdCBjb21wbGV0ZWQgdGhpcyBjb250
ZXh0LCB0aGUgZW5naW5lIG1heSBub3cgYmUKQEAgLTE3NTIsMTIgKzEwMDgsNiBAQCBzdGF0aWMg
Ym9vbCBjYW5fbWVyZ2VfcnEoY29uc3Qgc3RydWN0IGk5MTVfcmVxdWVzdCAqcHJldiwKIAlyZXR1
cm4gdHJ1ZTsKIH0KIAotc3RhdGljIHZvaWQgdmlydHVhbF91cGRhdGVfcmVnaXN0ZXJfb2Zmc2V0
cyh1MzIgKnJlZ3MsCi0JCQkJCSAgICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCi17
Ci0Jc2V0X29mZnNldHMocmVncywgcmVnX29mZnNldHMoZW5naW5lKSwgZW5naW5lLCBmYWxzZSk7
Ci19Ci0KIHN0YXRpYyBib29sIHZpcnR1YWxfbWF0Y2hlcyhjb25zdCBzdHJ1Y3QgdmlydHVhbF9l
bmdpbmUgKnZlLAogCQkJICAgIGNvbnN0IHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAogCQkJICAg
IGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKQEAgLTE3OTMsOCArMTA0Myw3
IEBAIHN0YXRpYyB2b2lkIHZpcnR1YWxfeGZlcl9jb250ZXh0KHN0cnVjdCB2aXJ0dWFsX2VuZ2lu
ZSAqdmUsCiAKIAlHRU1fQlVHX09OKFJFQURfT05DRSh2ZS0+Y29udGV4dC5pbmZsaWdodCkpOwog
CWlmICghaW50ZWxfZW5naW5lX2hhc19yZWxhdGl2ZV9tbWlvKGVuZ2luZSkpCi0JCXZpcnR1YWxf
dXBkYXRlX3JlZ2lzdGVyX29mZnNldHModmUtPmNvbnRleHQubHJjX3JlZ19zdGF0ZSwKLQkJCQkJ
CWVuZ2luZSk7CisJCWxyY191cGRhdGVfb2Zmc2V0cygmdmUtPmNvbnRleHQsIGVuZ2luZSk7CiAK
IAkvKgogCSAqIE1vdmUgdGhlIGJvdW5kIGVuZ2luZSB0byB0aGUgdG9wIG9mIHRoZSBsaXN0IGZv
cgpAQCAtMzMwNywzNSArMjU1Niw5IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19jb250ZXh0X2Rl
c3Ryb3koc3RydWN0IGtyZWYgKmtyZWYpCiAJaW50ZWxfY29udGV4dF9mcmVlKGNlKTsKIH0KIAot
c3RhdGljIHZvaWQKLXNldF9yZWR6b25lKHZvaWQgKnZhZGRyLCBjb25zdCBzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUpCi17Ci0JaWYgKCFJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9E
RUJVR19HRU0pKQotCQlyZXR1cm47Ci0KLQl2YWRkciArPSBlbmdpbmUtPmNvbnRleHRfc2l6ZTsK
LQotCW1lbXNldCh2YWRkciwgQ09OVEVYVF9SRURaT05FLCBJOTE1X0dUVF9QQUdFX1NJWkUpOwot
fQotCi1zdGF0aWMgdm9pZAotY2hlY2tfcmVkem9uZShjb25zdCB2b2lkICp2YWRkciwgY29uc3Qg
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQotewotCWlmICghSVNfRU5BQkxFRChDT05G
SUdfRFJNX0k5MTVfREVCVUdfR0VNKSkKLQkJcmV0dXJuOwotCi0JdmFkZHIgKz0gZW5naW5lLT5j
b250ZXh0X3NpemU7Ci0KLQlpZiAobWVtY2hyX2ludih2YWRkciwgQ09OVEVYVF9SRURaT05FLCBJ
OTE1X0dUVF9QQUdFX1NJWkUpKQotCQlkcm1fZXJyX29uY2UoJmVuZ2luZS0+aTkxNS0+ZHJtLAot
CQkJICAgICAiJXMgY29udGV4dCByZWR6b25lIG92ZXJ3cml0dGVuIVxuIiwKLQkJCSAgICAgZW5n
aW5lLT5uYW1lKTsKLX0KLQogc3RhdGljIHZvaWQgZXhlY2xpc3RzX2NvbnRleHRfdW5waW4oc3Ry
dWN0IGludGVsX2NvbnRleHQgKmNlKQogewotCWNoZWNrX3JlZHpvbmUoKHZvaWQgKiljZS0+bHJj
X3JlZ19zdGF0ZSAtIExSQ19TVEFURV9PRkZTRVQsCi0JCSAgICAgIGNlLT5lbmdpbmUpOworCWxy
Y19jaGVja19yZWR6b25lKGNlKTsKIH0KIAogc3RhdGljIHZvaWQgZXhlY2xpc3RzX2NvbnRleHRf
cG9zdF91bnBpbihzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCkBAIC0zMzQzLDE2MyArMjU2Niw2
IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19jb250ZXh0X3Bvc3RfdW5waW4oc3RydWN0IGludGVs
X2NvbnRleHQgKmNlKQogCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAoY2UtPnN0YXRlLT5vYmop
OwogfQogCi1zdGF0aWMgdTMyICoKLWdlbjEyX2VtaXRfdGltZXN0YW1wX3dhKGNvbnN0IHN0cnVj
dCBpbnRlbF9jb250ZXh0ICpjZSwgdTMyICpjcykKLXsKLQkqY3MrKyA9IE1JX0xPQURfUkVHSVNU
RVJfTUVNX0dFTjggfAotCQlNSV9TUk1fTFJNX0dMT0JBTF9HVFQgfAotCQlNSV9MUklfTFJNX0NT
X01NSU87Ci0JKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X1JJTkdfQ1NfR1BSKDAs
IDApKTsKLQkqY3MrKyA9IGk5MTVfZ2d0dF9vZmZzZXQoY2UtPnN0YXRlKSArIExSQ19TVEFURV9P
RkZTRVQgKwotCQlDVFhfVElNRVNUQU1QICogc2l6ZW9mKHUzMik7Ci0JKmNzKysgPSAwOwotCi0J
KmNzKysgPSBNSV9MT0FEX1JFR0lTVEVSX1JFRyB8Ci0JCU1JX0xSUl9TT1VSQ0VfQ1NfTU1JTyB8
Ci0JCU1JX0xSSV9MUk1fQ1NfTU1JTzsKLQkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEdF
TjhfUklOR19DU19HUFIoMCwgMCkpOwotCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklO
R19DVFhfVElNRVNUQU1QKDApKTsKLQotCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9SRUcgfAot
CQlNSV9MUlJfU09VUkNFX0NTX01NSU8gfAotCQlNSV9MUklfTFJNX0NTX01NSU87Ci0JKmNzKysg
PSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X1JJTkdfQ1NfR1BSKDAsIDApKTsKLQkqY3MrKyA9
IGk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfQ1RYX1RJTUVTVEFNUCgwKSk7Ci0KLQlyZXR1cm4g
Y3M7Ci19Ci0KLXN0YXRpYyB1MzIgKgotZ2VuMTJfZW1pdF9yZXN0b3JlX3NjcmF0Y2goY29uc3Qg
c3RydWN0IGludGVsX2NvbnRleHQgKmNlLCB1MzIgKmNzKQotewotCUdFTV9CVUdfT04obHJjX3Jp
bmdfZ3ByMChjZS0+ZW5naW5lKSA9PSAtMSk7Ci0KLQkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJf
TUVNX0dFTjggfAotCQlNSV9TUk1fTFJNX0dMT0JBTF9HVFQgfAotCQlNSV9MUklfTFJNX0NTX01N
SU87Ci0JKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X1JJTkdfQ1NfR1BSKDAsIDAp
KTsKLQkqY3MrKyA9IGk5MTVfZ2d0dF9vZmZzZXQoY2UtPnN0YXRlKSArIExSQ19TVEFURV9PRkZT
RVQgKwotCQkobHJjX3JpbmdfZ3ByMChjZS0+ZW5naW5lKSArIDEpICogc2l6ZW9mKHUzMik7Ci0J
KmNzKysgPSAwOwotCi0JcmV0dXJuIGNzOwotfQotCi1zdGF0aWMgdTMyICoKLWdlbjEyX2VtaXRf
Y21kX2J1Zl93YShjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHUzMiAqY3MpCi17Ci0J
R0VNX0JVR19PTihscmNfcmluZ19jbWRfYnVmX2NjdGwoY2UtPmVuZ2luZSkgPT0gLTEpOwotCi0J
KmNzKysgPSBNSV9MT0FEX1JFR0lTVEVSX01FTV9HRU44IHwKLQkJTUlfU1JNX0xSTV9HTE9CQUxf
R1RUIHwKLQkJTUlfTFJJX0xSTV9DU19NTUlPOwotCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZz
ZXQoR0VOOF9SSU5HX0NTX0dQUigwLCAwKSk7Ci0JKmNzKysgPSBpOTE1X2dndHRfb2Zmc2V0KGNl
LT5zdGF0ZSkgKyBMUkNfU1RBVEVfT0ZGU0VUICsKLQkJKGxyY19yaW5nX2NtZF9idWZfY2N0bChj
ZS0+ZW5naW5lKSArIDEpICogc2l6ZW9mKHUzMik7Ci0JKmNzKysgPSAwOwotCi0JKmNzKysgPSBN
SV9MT0FEX1JFR0lTVEVSX1JFRyB8Ci0JCU1JX0xSUl9TT1VSQ0VfQ1NfTU1JTyB8Ci0JCU1JX0xS
SV9MUk1fQ1NfTU1JTzsKLQkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEdFTjhfUklOR19D
U19HUFIoMCwgMCkpOwotCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19DTURfQlVG
X0NDVEwoMCkpOwotCi0JcmV0dXJuIGNzOwotfQotCi1zdGF0aWMgdTMyICoKLWdlbjEyX2VtaXRf
aW5kaXJlY3RfY3R4X3Jjcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHUzMiAqY3Mp
Ci17Ci0JY3MgPSBnZW4xMl9lbWl0X3RpbWVzdGFtcF93YShjZSwgY3MpOwotCWNzID0gZ2VuMTJf
ZW1pdF9jbWRfYnVmX3dhKGNlLCBjcyk7Ci0JY3MgPSBnZW4xMl9lbWl0X3Jlc3RvcmVfc2NyYXRj
aChjZSwgY3MpOwotCi0JcmV0dXJuIGNzOwotfQotCi1zdGF0aWMgdTMyICoKLWdlbjEyX2VtaXRf
aW5kaXJlY3RfY3R4X3hjcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHUzMiAqY3Mp
Ci17Ci0JY3MgPSBnZW4xMl9lbWl0X3RpbWVzdGFtcF93YShjZSwgY3MpOwotCWNzID0gZ2VuMTJf
ZW1pdF9yZXN0b3JlX3NjcmF0Y2goY2UsIGNzKTsKLQotCXJldHVybiBjczsKLX0KLQotc3RhdGlj
IGlubGluZSB1MzIgY29udGV4dF93YV9iYl9vZmZzZXQoY29uc3Qgc3RydWN0IGludGVsX2NvbnRl
eHQgKmNlKQotewotCXJldHVybiBQQUdFX1NJWkUgKiBjZS0+d2FfYmJfcGFnZTsKLX0KLQotc3Rh
dGljIHUzMiAqY29udGV4dF9pbmRpcmVjdF9iYihjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAq
Y2UpCi17Ci0Jdm9pZCAqcHRyOwotCi0JR0VNX0JVR19PTighY2UtPndhX2JiX3BhZ2UpOwotCi0J
cHRyID0gY2UtPmxyY19yZWdfc3RhdGU7Ci0JcHRyIC09IExSQ19TVEFURV9PRkZTRVQ7IC8qIGJh
Y2sgdG8gc3RhcnQgb2YgY29udGV4dCBpbWFnZSAqLwotCXB0ciArPSBjb250ZXh0X3dhX2JiX29m
ZnNldChjZSk7Ci0KLQlyZXR1cm4gcHRyOwotfQotCi1zdGF0aWMgdm9pZAotc2V0dXBfaW5kaXJl
Y3RfY3R4X2JiKGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKLQkJICAgICAgY29uc3Qg
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAotCQkgICAgICB1MzIgKigqZW1pdCkoY29u
c3Qgc3RydWN0IGludGVsX2NvbnRleHQgKiwgdTMyICopKQotewotCXUzMiAqIGNvbnN0IHN0YXJ0
ID0gY29udGV4dF9pbmRpcmVjdF9iYihjZSk7Ci0JdTMyICpjczsKLQotCWNzID0gZW1pdChjZSwg
c3RhcnQpOwotCUdFTV9CVUdfT04oY3MgLSBzdGFydCA+IEk5MTVfR1RUX1BBR0VfU0laRSAvIHNp
emVvZigqY3MpKTsKLQl3aGlsZSAoKHVuc2lnbmVkIGxvbmcpY3MgJSBDQUNIRUxJTkVfQllURVMp
Ci0JCSpjcysrID0gTUlfTk9PUDsKLQotCWxyY19yaW5nX3NldHVwX2luZGlyZWN0X2N0eChjZS0+
bHJjX3JlZ19zdGF0ZSwgZW5naW5lLAotCQkJCSAgICBpOTE1X2dndHRfb2Zmc2V0KGNlLT5zdGF0
ZSkgKwotCQkJCSAgICBjb250ZXh0X3dhX2JiX29mZnNldChjZSksCi0JCQkJICAgIChjcyAtIHN0
YXJ0KSAqIHNpemVvZigqY3MpKTsKLX0KLQotc3RhdGljIHZvaWQKLV9fZXhlY2xpc3RzX3VwZGF0
ZV9yZWdfc3RhdGUoY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAotCQkJICAgICBjb25z
dCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCi0JCQkgICAgIHUzMiBoZWFkKQotewot
CXN0cnVjdCBpbnRlbF9yaW5nICpyaW5nID0gY2UtPnJpbmc7Ci0JdTMyICpyZWdzID0gY2UtPmxy
Y19yZWdfc3RhdGU7Ci0KLQlHRU1fQlVHX09OKCFpbnRlbF9yaW5nX29mZnNldF92YWxpZChyaW5n
LCBoZWFkKSk7Ci0JR0VNX0JVR19PTighaW50ZWxfcmluZ19vZmZzZXRfdmFsaWQocmluZywgcmlu
Zy0+dGFpbCkpOwotCi0JcmVnc1tDVFhfUklOR19TVEFSVF0gPSBpOTE1X2dndHRfb2Zmc2V0KHJp
bmctPnZtYSk7Ci0JcmVnc1tDVFhfUklOR19IRUFEXSA9IGhlYWQ7Ci0JcmVnc1tDVFhfUklOR19U
QUlMXSA9IHJpbmctPnRhaWw7Ci0JcmVnc1tDVFhfUklOR19DVExdID0gUklOR19DVExfU0laRShy
aW5nLT5zaXplKSB8IFJJTkdfVkFMSUQ7Ci0KLQkvKiBSUENTICovCi0JaWYgKGVuZ2luZS0+Y2xh
c3MgPT0gUkVOREVSX0NMQVNTKSB7Ci0JCXJlZ3NbQ1RYX1JfUFdSX0NMS19TVEFURV0gPQotCQkJ
aW50ZWxfc3NldV9tYWtlX3JwY3MoZW5naW5lLT5ndCwgJmNlLT5zc2V1KTsKLQotCQlpOTE1X29h
X2luaXRfcmVnX3N0YXRlKGNlLCBlbmdpbmUpOwotCX0KLQotCWlmIChjZS0+d2FfYmJfcGFnZSkg
ewotCQl1MzIgKigqZm4pKGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgdTMyICpjcyk7
Ci0KLQkJZm4gPSBnZW4xMl9lbWl0X2luZGlyZWN0X2N0eF94Y3M7Ci0JCWlmIChjZS0+ZW5naW5l
LT5jbGFzcyA9PSBSRU5ERVJfQ0xBU1MpCi0JCQlmbiA9IGdlbjEyX2VtaXRfaW5kaXJlY3RfY3R4
X3JjczsKLQotCQkvKiBNdXR1YWxseSBleGNsdXNpdmUgd3J0IHRvIGdsb2JhbCBpbmRpcmVjdCBi
YiAqLwotCQlHRU1fQlVHX09OKGVuZ2luZS0+d2FfY3R4LmluZGlyZWN0X2N0eC5zaXplKTsKLQkJ
c2V0dXBfaW5kaXJlY3RfY3R4X2JiKGNlLCBlbmdpbmUsIGZuKTsKLQl9Ci19Ci0KIHN0YXRpYyBp
bnQKIGV4ZWNsaXN0c19jb250ZXh0X3ByZV9waW4oc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAog
CQkJICBzdHJ1Y3QgaTkxNV9nZW1fd3dfY3R4ICp3dywgdm9pZCAqKnZhZGRyKQpAQCAtMzUxOSwx
MCArMjU4NSw4IEBAIF9fZXhlY2xpc3RzX2NvbnRleHRfcGluKHN0cnVjdCBpbnRlbF9jb250ZXh0
ICpjZSwKIAkJCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAkJCXZvaWQgKnZhZGRy
KQogewotCWNlLT5scmMubHJjYSA9IGxyY19kZXNjcmlwdG9yKGNlLCBlbmdpbmUpIHwgQ1RYX0RF
U0NfRk9SQ0VfUkVTVE9SRTsKIAljZS0+bHJjX3JlZ19zdGF0ZSA9IHZhZGRyICsgTFJDX1NUQVRF
X09GRlNFVDsKLQlfX2V4ZWNsaXN0c191cGRhdGVfcmVnX3N0YXRlKGNlLCBlbmdpbmUsIGNlLT5y
aW5nLT50YWlsKTsKLQorCWNlLT5scmMubHJjYSA9IGxyY191cGRhdGVfcmVncyhjZSwgZW5naW5l
LCBjZS0+cmluZy0+dGFpbCk7CiAJcmV0dXJuIDA7CiB9CiAKQEAgLTM1NDQsMTEgKzI2MDgsOCBA
QCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfY29udGV4dF9yZXNldChzdHJ1Y3QgaW50ZWxfY29udGV4
dCAqY2UpCiAJaW50ZWxfcmluZ19yZXNldChjZS0+cmluZywgY2UtPnJpbmctPmVtaXQpOwogCiAJ
LyogU2NydWIgYXdheSB0aGUgZ2FyYmFnZSAqLwotCWV4ZWNsaXN0c19pbml0X3JlZ19zdGF0ZShj
ZS0+bHJjX3JlZ19zdGF0ZSwKLQkJCQkgY2UsIGNlLT5lbmdpbmUsIGNlLT5yaW5nLCB0cnVlKTsK
LQlfX2V4ZWNsaXN0c191cGRhdGVfcmVnX3N0YXRlKGNlLCBjZS0+ZW5naW5lLCBjZS0+cmluZy0+
dGFpbCk7Ci0KLQljZS0+bHJjLmRlc2MgfD0gQ1RYX0RFU0NfRk9SQ0VfUkVTVE9SRTsKKwlscmNf
aW5pdF9yZWdzKGNlLCBjZS0+ZW5naW5lLCBjZS0+cmluZywgdHJ1ZSk7CisJY2UtPmxyYy5scmNh
ID0gbHJjX3VwZGF0ZV9yZWdzKGNlLCBjZS0+ZW5naW5lLCBjZS0+cmluZy0+dGFpbCk7CiB9CiAK
IHN0YXRpYyBjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dF9vcHMgZXhlY2xpc3RzX2NvbnRleHRf
b3BzID0gewpAQCAtMzY1MCwzMzAgKzI3MTEsNiBAQCBzdGF0aWMgaW50IGV4ZWNsaXN0c19yZXF1
ZXN0X2FsbG9jKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QpCiAJcmV0dXJuIDA7CiB9CiAK
LS8qCi0gKiBJbiB0aGlzIFdBIHdlIG5lZWQgdG8gc2V0IEdFTjhfTDNTUUNSRUc0WzIxOjIxXSBh
bmQgcmVzZXQgaXQgYWZ0ZXIKLSAqIFBJUEVfQ09OVFJPTCBpbnN0cnVjdGlvbi4gVGhpcyBpcyBy
ZXF1aXJlZCBmb3IgdGhlIGZsdXNoIHRvIGhhcHBlbiBjb3JyZWN0bHkKLSAqIGJ1dCB0aGVyZSBp
cyBhIHNsaWdodCBjb21wbGljYXRpb24gYXMgdGhpcyBpcyBhcHBsaWVkIGluIFdBIGJhdGNoIHdo
ZXJlIHRoZQotICogdmFsdWVzIGFyZSBvbmx5IGluaXRpYWxpemVkIG9uY2Ugc28gd2UgY2Fubm90
IHRha2UgcmVnaXN0ZXIgdmFsdWUgYXQgdGhlCi0gKiBiZWdpbm5pbmcgYW5kIHJldXNlIGl0IGZ1
cnRoZXI7IGhlbmNlIHdlIHNhdmUgaXRzIHZhbHVlIHRvIG1lbW9yeSwgdXBsb2FkIGEKLSAqIGNv
bnN0YW50IHZhbHVlIHdpdGggYml0MjEgc2V0IGFuZCB0aGVuIHdlIHJlc3RvcmUgaXQgYmFjayB3
aXRoIHRoZSBzYXZlZCB2YWx1ZS4KLSAqIFRvIHNpbXBsaWZ5IHRoZSBXQSwgYSBjb25zdGFudCB2
YWx1ZSBpcyBmb3JtZWQgYnkgdXNpbmcgdGhlIGRlZmF1bHQgdmFsdWUKLSAqIG9mIHRoaXMgcmVn
aXN0ZXIuIFRoaXMgc2hvdWxkbid0IGJlIGEgcHJvYmxlbSBiZWNhdXNlIHdlIGFyZSBvbmx5IG1v
ZGlmeWluZwotICogaXQgZm9yIGEgc2hvcnQgcGVyaW9kIGFuZCB0aGlzIGJhdGNoIGluIG5vbi1w
cmVtcHRpYmxlLiBXZSBjYW4gb2Zjb3Vyc2UKLSAqIHVzZSBhZGRpdGlvbmFsIGluc3RydWN0aW9u
cyB0aGF0IHJlYWQgdGhlIGFjdHVhbCB2YWx1ZSBvZiB0aGUgcmVnaXN0ZXIKLSAqIGF0IHRoYXQg
dGltZSBhbmQgc2V0IG91ciBiaXQgb2YgaW50ZXJlc3QgYnV0IGl0IG1ha2VzIHRoZSBXQSBjb21w
bGljYXRlZC4KLSAqCi0gKiBUaGlzIFdBIGlzIGFsc28gcmVxdWlyZWQgZm9yIEdlbjkgc28gZXh0
cmFjdGluZyBhcyBhIGZ1bmN0aW9uIGF2b2lkcwotICogY29kZSBkdXBsaWNhdGlvbi4KLSAqLwot
c3RhdGljIHUzMiAqCi1nZW44X2VtaXRfZmx1c2hfY29oZXJlbnRsM193YShzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUsIHUzMiAqYmF0Y2gpCi17Ci0JLyogTkIgbm8gb25lIGVsc2UgaXMg
YWxsb3dlZCB0byBzY3JpYmJsZSBvdmVyIHNjcmF0Y2ggKyAyNTYhICovCi0JKmJhdGNoKysgPSBN
SV9TVE9SRV9SRUdJU1RFUl9NRU1fR0VOOCB8IE1JX1NSTV9MUk1fR0xPQkFMX0dUVDsKLQkqYmF0
Y2grKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEdFTjhfTDNTUUNSRUc0KTsKLQkqYmF0Y2grKyA9
IGludGVsX2d0X3NjcmF0Y2hfb2Zmc2V0KGVuZ2luZS0+Z3QsCi0JCQkJCSAgIElOVEVMX0dUX1ND
UkFUQ0hfRklFTERfQ09IRVJFTlRMM19XQSk7Ci0JKmJhdGNoKysgPSAwOwotCi0JKmJhdGNoKysg
PSBNSV9MT0FEX1JFR0lTVEVSX0lNTSgxKTsKLQkqYmF0Y2grKyA9IGk5MTVfbW1pb19yZWdfb2Zm
c2V0KEdFTjhfTDNTUUNSRUc0KTsKLQkqYmF0Y2grKyA9IDB4NDA0MDAwMDAgfCBHRU44X0xRU0Nf
RkxVU0hfQ09IRVJFTlRfTElORVM7Ci0KLQliYXRjaCA9IGdlbjhfZW1pdF9waXBlX2NvbnRyb2wo
YmF0Y2gsCi0JCQkJICAgICAgIFBJUEVfQ09OVFJPTF9DU19TVEFMTCB8Ci0JCQkJICAgICAgIFBJ
UEVfQ09OVFJPTF9EQ19GTFVTSF9FTkFCTEUsCi0JCQkJICAgICAgIDApOwotCi0JKmJhdGNoKysg
PSBNSV9MT0FEX1JFR0lTVEVSX01FTV9HRU44IHwgTUlfU1JNX0xSTV9HTE9CQUxfR1RUOwotCSpi
YXRjaCsrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9MM1NRQ1JFRzQpOwotCSpiYXRjaCsr
ID0gaW50ZWxfZ3Rfc2NyYXRjaF9vZmZzZXQoZW5naW5lLT5ndCwKLQkJCQkJICAgSU5URUxfR1Rf
U0NSQVRDSF9GSUVMRF9DT0hFUkVOVEwzX1dBKTsKLQkqYmF0Y2grKyA9IDA7Ci0KLQlyZXR1cm4g
YmF0Y2g7Ci19Ci0KLS8qCi0gKiBUeXBpY2FsbHkgd2Ugb25seSBoYXZlIG9uZSBpbmRpcmVjdF9j
dHggYW5kIHBlcl9jdHggYmF0Y2ggYnVmZmVyIHdoaWNoIGFyZQotICogaW5pdGlhbGl6ZWQgYXQg
dGhlIGJlZ2lubmluZyBhbmQgc2hhcmVkIGFjcm9zcyBhbGwgY29udGV4dHMgYnV0IHRoaXMgZmll
bGQKLSAqIGhlbHBzIHVzIHRvIGhhdmUgbXVsdGlwbGUgYmF0Y2hlcyBhdCBkaWZmZXJlbnQgb2Zm
c2V0cyBhbmQgc2VsZWN0IHRoZW0gYmFzZWQKLSAqIG9uIGEgY3JpdGVyaWEuIEF0IHRoZSBtb21l
bnQgdGhpcyBiYXRjaCBhbHdheXMgc3RhcnQgYXQgdGhlIGJlZ2lubmluZyBvZiB0aGUgcGFnZQot
ICogYW5kIGF0IHRoaXMgcG9pbnQgd2UgZG9uJ3QgaGF2ZSBtdWx0aXBsZSB3YV9jdHggYmF0Y2gg
YnVmZmVycy4KLSAqCi0gKiBUaGUgbnVtYmVyIG9mIFdBIGFwcGxpZWQgYXJlIG5vdCBrbm93biBh
dCB0aGUgYmVnaW5uaW5nOyB3ZSB1c2UgdGhpcyBmaWVsZAotICogdG8gcmV0dXJuIHRoZSBubyBv
ZiBEV09SRFMgd3JpdHRlbi4KLSAqCi0gKiBJdCBpcyB0byBiZSBub3RlZCB0aGF0IHRoaXMgYmF0
Y2ggZG9lcyBub3QgY29udGFpbiBNSV9CQVRDSF9CVUZGRVJfRU5ECi0gKiBzbyBpdCBhZGRzIE5P
T1BzIGFzIHBhZGRpbmcgdG8gbWFrZSBpdCBjYWNoZWxpbmUgYWxpZ25lZC4KLSAqIE1JX0JBVENI
X0JVRkZFUl9FTkQgd2lsbCBiZSBhZGRlZCB0byBwZXJjdHggYmF0Y2ggYW5kIGJvdGggb2YgdGhl
bSB0b2dldGhlcgotICogbWFrZXMgYSBjb21wbGV0ZSBiYXRjaCBidWZmZXIuCi0gKi8KLXN0YXRp
YyB1MzIgKmdlbjhfaW5pdF9pbmRpcmVjdGN0eF9iYihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUsIHUzMiAqYmF0Y2gpCi17Ci0JLyogV2FEaXNhYmxlQ3R4UmVzdG9yZUFyYml0cmF0aW9u
OmJkdyxjaHYgKi8KLQkqYmF0Y2grKyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJfRElTQUJMRTsK
LQotCS8qIFdhRmx1c2hDb2hlcmVudEwzQ2FjaGVMaW5lc0F0Q29udGV4dFN3aXRjaDpiZHcgKi8K
LQlpZiAoSVNfQlJPQURXRUxMKGVuZ2luZS0+aTkxNSkpCi0JCWJhdGNoID0gZ2VuOF9lbWl0X2Zs
dXNoX2NvaGVyZW50bDNfd2EoZW5naW5lLCBiYXRjaCk7Ci0KLQkvKiBXYUNsZWFyU2xtU3BhY2VB
dENvbnRleHRTd2l0Y2g6YmR3LGNodiAqLwotCS8qIEFjdHVhbCBzY3JhdGNoIGxvY2F0aW9uIGlz
IGF0IDEyOCBieXRlcyBvZmZzZXQgKi8KLQliYXRjaCA9IGdlbjhfZW1pdF9waXBlX2NvbnRyb2wo
YmF0Y2gsCi0JCQkJICAgICAgIFBJUEVfQ09OVFJPTF9GTFVTSF9MMyB8Ci0JCQkJICAgICAgIFBJ
UEVfQ09OVFJPTF9TVE9SRV9EQVRBX0lOREVYIHwKLQkJCQkgICAgICAgUElQRV9DT05UUk9MX0NT
X1NUQUxMIHwKLQkJCQkgICAgICAgUElQRV9DT05UUk9MX1FXX1dSSVRFLAotCQkJCSAgICAgICBM
UkNfUFBIV1NQX1NDUkFUQ0hfQUREUik7Ci0KLQkqYmF0Y2grKyA9IE1JX0FSQl9PTl9PRkYgfCBN
SV9BUkJfRU5BQkxFOwotCi0JLyogUGFkIHRvIGVuZCBvZiBjYWNoZWxpbmUgKi8KLQl3aGlsZSAo
KHVuc2lnbmVkIGxvbmcpYmF0Y2ggJSBDQUNIRUxJTkVfQllURVMpCi0JCSpiYXRjaCsrID0gTUlf
Tk9PUDsKLQotCS8qCi0JICogTUlfQkFUQ0hfQlVGRkVSX0VORCBpcyBub3QgcmVxdWlyZWQgaW4g
SW5kaXJlY3QgY3R4IEJCIGJlY2F1c2UKLQkgKiBleGVjdXRpb24gZGVwZW5kcyBvbiB0aGUgbGVu
Z3RoIHNwZWNpZmllZCBpbiB0ZXJtcyBvZiBjYWNoZSBsaW5lcwotCSAqIGluIHRoZSByZWdpc3Rl
ciBDVFhfUkNTX0lORElSRUNUX0NUWAotCSAqLwotCi0JcmV0dXJuIGJhdGNoOwotfQotCi1zdHJ1
Y3QgbHJpIHsKLQlpOTE1X3JlZ190IHJlZzsKLQl1MzIgdmFsdWU7Ci19OwotCi1zdGF0aWMgdTMy
ICplbWl0X2xyaSh1MzIgKmJhdGNoLCBjb25zdCBzdHJ1Y3QgbHJpICpscmksIHVuc2lnbmVkIGlu
dCBjb3VudCkKLXsKLQlHRU1fQlVHX09OKCFjb3VudCB8fCBjb3VudCA+IDYzKTsKLQotCSpiYXRj
aCsrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oY291bnQpOwotCWRvIHsKLQkJKmJhdGNoKysgPSBp
OTE1X21taW9fcmVnX29mZnNldChscmktPnJlZyk7Ci0JCSpiYXRjaCsrID0gbHJpLT52YWx1ZTsK
LQl9IHdoaWxlIChscmkrKywgLS1jb3VudCk7Ci0JKmJhdGNoKysgPSBNSV9OT09QOwotCi0JcmV0
dXJuIGJhdGNoOwotfQotCi1zdGF0aWMgdTMyICpnZW45X2luaXRfaW5kaXJlY3RjdHhfYmIoc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1MzIgKmJhdGNoKQotewotCXN0YXRpYyBjb25z
dCBzdHJ1Y3QgbHJpIGxyaVtdID0gewotCQkvKiBXYURpc2FibGVHYXRoZXJBdFNldFNoYWRlckNv
bW1vblNsaWNlOnNrbCxieHQsa2JsLGdsayAqLwotCQl7Ci0JCQlDT01NT05fU0xJQ0VfQ0hJQ0tF
TjIsCi0JCQlfX01BU0tFRF9GSUVMRChHRU45X0RJU0FCTEVfR0FUSEVSX0FUX1NFVF9TSEFERVJf
Q09NTU9OX1NMSUNFLAotCQkJCSAgICAgICAwKSwKLQkJfSwKLQotCQkvKiBCU3BlYzogMTEzOTEg
Ki8KLQkJewotCQkJRkZfU0xJQ0VfQ0hJQ0tFTiwKLQkJCV9fTUFTS0VEX0ZJRUxEKEZGX1NMSUNF
X0NISUNLRU5fQ0xfUFJPVk9LSU5HX1ZFUlRFWF9GSVgsCi0JCQkJICAgICAgIEZGX1NMSUNFX0NI
SUNLRU5fQ0xfUFJPVk9LSU5HX1ZFUlRFWF9GSVgpLAotCQl9LAotCi0JCS8qIEJTcGVjOiAxMTI5
OSAqLwotCQl7Ci0JCQlfM0RfQ0hJQ0tFTjMsCi0JCQlfX01BU0tFRF9GSUVMRChfM0RfQ0hJQ0tF
Tl9TRl9QUk9WT0tJTkdfVkVSVEVYX0ZJWCwKLQkJCQkgICAgICAgXzNEX0NISUNLRU5fU0ZfUFJP
Vk9LSU5HX1ZFUlRFWF9GSVgpLAotCQl9Ci0JfTsKLQotCSpiYXRjaCsrID0gTUlfQVJCX09OX09G
RiB8IE1JX0FSQl9ESVNBQkxFOwotCi0JLyogV2FGbHVzaENvaGVyZW50TDNDYWNoZUxpbmVzQXRD
b250ZXh0U3dpdGNoOnNrbCxieHQsZ2xrICovCi0JYmF0Y2ggPSBnZW44X2VtaXRfZmx1c2hfY29o
ZXJlbnRsM193YShlbmdpbmUsIGJhdGNoKTsKLQotCS8qIFdhQ2xlYXJTbG1TcGFjZUF0Q29udGV4
dFN3aXRjaDpza2wsYnh0LGtibCxnbGssY2ZsICovCi0JYmF0Y2ggPSBnZW44X2VtaXRfcGlwZV9j
b250cm9sKGJhdGNoLAotCQkJCSAgICAgICBQSVBFX0NPTlRST0xfRkxVU0hfTDMgfAotCQkJCSAg
ICAgICBQSVBFX0NPTlRST0xfU1RPUkVfREFUQV9JTkRFWCB8Ci0JCQkJICAgICAgIFBJUEVfQ09O
VFJPTF9DU19TVEFMTCB8Ci0JCQkJICAgICAgIFBJUEVfQ09OVFJPTF9RV19XUklURSwKLQkJCQkg
ICAgICAgTFJDX1BQSFdTUF9TQ1JBVENIX0FERFIpOwotCi0JYmF0Y2ggPSBlbWl0X2xyaShiYXRj
aCwgbHJpLCBBUlJBWV9TSVpFKGxyaSkpOwotCi0JLyogV2FNZWRpYVBvb2xTdGF0ZUNtZEluV0FC
QjpieHQsZ2xrICovCi0JaWYgKEhBU19QT09MRURfRVUoZW5naW5lLT5pOTE1KSkgewotCQkvKgot
CQkgKiBFVSBwb29sIGNvbmZpZ3VyYXRpb24gaXMgc2V0dXAgYWxvbmcgd2l0aCBnb2xkZW4gY29u
dGV4dAotCQkgKiBkdXJpbmcgY29udGV4dCBpbml0aWFsaXphdGlvbi4gVGhpcyB2YWx1ZSBkZXBl
bmRzIG9uCi0JCSAqIGRldmljZSB0eXBlICgyeDYgb3IgM3g2KSBhbmQgbmVlZHMgdG8gYmUgdXBk
YXRlZCBiYXNlZAotCQkgKiBvbiB3aGljaCBzdWJzbGljZSBpcyBkaXNhYmxlZCBlc3BlY2lhbGx5
IGZvciAyeDYKLQkJICogZGV2aWNlcywgaG93ZXZlciBpdCBpcyBzYWZlIHRvIGxvYWQgZGVmYXVs
dAotCQkgKiBjb25maWd1cmF0aW9uIG9mIDN4NiBkZXZpY2UgaW5zdGVhZCBvZiBtYXNraW5nIG9m
ZgotCQkgKiBjb3JyZXNwb25kaW5nIGJpdHMgYmVjYXVzZSBIVyBpZ25vcmVzIGJpdHMgb2YgYSBk
aXNhYmxlZAotCQkgKiBzdWJzbGljZSBhbmQgZHJvcHMgZG93biB0byBhcHByb3ByaWF0ZSBjb25m
aWcuIFBsZWFzZQotCQkgKiBzZWUgcmVuZGVyX3N0YXRlX3NldHVwKCkgaW4gaTkxNV9nZW1fcmVu
ZGVyX3N0YXRlLmMgZm9yCi0JCSAqIHBvc3NpYmxlIGNvbmZpZ3VyYXRpb25zLCB0byBhdm9pZCBk
dXBsaWNhdGlvbiB0aGV5IGFyZQotCQkgKiBub3Qgc2hvd24gaGVyZSBhZ2Fpbi4KLQkJICovCi0J
CSpiYXRjaCsrID0gR0VOOV9NRURJQV9QT09MX1NUQVRFOwotCQkqYmF0Y2grKyA9IEdFTjlfTUVE
SUFfUE9PTF9FTkFCTEU7Ci0JCSpiYXRjaCsrID0gMHgwMDc3NzAwMDsKLQkJKmJhdGNoKysgPSAw
OwotCQkqYmF0Y2grKyA9IDA7Ci0JCSpiYXRjaCsrID0gMDsKLQl9Ci0KLQkqYmF0Y2grKyA9IE1J
X0FSQl9PTl9PRkYgfCBNSV9BUkJfRU5BQkxFOwotCi0JLyogUGFkIHRvIGVuZCBvZiBjYWNoZWxp
bmUgKi8KLQl3aGlsZSAoKHVuc2lnbmVkIGxvbmcpYmF0Y2ggJSBDQUNIRUxJTkVfQllURVMpCi0J
CSpiYXRjaCsrID0gTUlfTk9PUDsKLQotCXJldHVybiBiYXRjaDsKLX0KLQotc3RhdGljIHUzMiAq
Ci1nZW4xMF9pbml0X2luZGlyZWN0Y3R4X2JiKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSwgdTMyICpiYXRjaCkKLXsKLQlpbnQgaTsKLQotCS8qCi0JICogV2FQaXBlQ29udHJvbEJlZm9y
ZTNEU3RhdGVTYW1wbGVQYXR0ZXJuOiBjbmwKLQkgKgotCSAqIEVuc3VyZSB0aGUgZW5naW5lIGlz
IGlkbGUgcHJpb3IgdG8gcHJvZ3JhbW1pbmcgYQotCSAqIDNEU1RBVEVfU0FNUExFX1BBVFRFUk4g
ZHVyaW5nIGEgY29udGV4dCByZXN0b3JlLgotCSAqLwotCWJhdGNoID0gZ2VuOF9lbWl0X3BpcGVf
Y29udHJvbChiYXRjaCwKLQkJCQkgICAgICAgUElQRV9DT05UUk9MX0NTX1NUQUxMLAotCQkJCSAg
ICAgICAwKTsKLQkvKgotCSAqIFdhUGlwZUNvbnRyb2xCZWZvcmUzRFN0YXRlU2FtcGxlUGF0dGVy
biBzYXlzIHdlIG5lZWQgNCBkd29yZHMgZm9yCi0JICogdGhlIFBJUEVfQ09OVFJPTCBmb2xsb3dl
ZCBieSAxMiBkd29yZHMgb2YgMHgwLCBzbyAxNiBkd29yZHMgaW4KLQkgKiB0b3RhbC4gSG93ZXZl
ciwgYSBQSVBFX0NPTlRST0wgaXMgNiBkd29yZHMgbG9uZywgbm90IDQsIHdoaWNoIGlzCi0JICog
Y29uZnVzaW5nLiBTaW5jZSBnZW44X2VtaXRfcGlwZV9jb250cm9sKCkgYWxyZWFkeSBhZHZhbmNl
cyB0aGUKLQkgKiBiYXRjaCBieSA2IGR3b3Jkcywgd2UgYWR2YW5jZSB0aGUgb3RoZXIgMTAgaGVy
ZSwgY29tcGxldGluZyBhCi0JICogY2FjaGVsaW5lLiBJdCdzIG5vdCBjbGVhciBpZiB0aGUgd29y
a2Fyb3VuZCByZXF1aXJlcyB0aGlzIHBhZGRpbmcKLQkgKiBiZWZvcmUgb3RoZXIgY29tbWFuZHMs
IG9yIGlmIGl0J3MganVzdCB0aGUgcmVndWxhciBwYWRkaW5nIHdlIHdvdWxkCi0JICogYWxyZWFk
eSBoYXZlIGZvciB0aGUgd29ya2Fyb3VuZCBiYiwgc28gbGVhdmUgaXQgaGVyZSBmb3Igbm93Lgot
CSAqLwotCWZvciAoaSA9IDA7IGkgPCAxMDsgaSsrKQotCQkqYmF0Y2grKyA9IE1JX05PT1A7Ci0K
LQkvKiBQYWQgdG8gZW5kIG9mIGNhY2hlbGluZSAqLwotCXdoaWxlICgodW5zaWduZWQgbG9uZyli
YXRjaCAlIENBQ0hFTElORV9CWVRFUykKLQkJKmJhdGNoKysgPSBNSV9OT09QOwotCi0JcmV0dXJu
IGJhdGNoOwotfQotCi0jZGVmaW5lIENUWF9XQV9CQl9PQkpfU0laRSAoUEFHRV9TSVpFKQotCi1z
dGF0aWMgaW50IGxyY19zZXR1cF93YV9jdHgoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KQotewotCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7Ci0Jc3RydWN0IGk5MTVfdm1h
ICp2bWE7Ci0JaW50IGVycjsKLQotCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfc2htZW0o
ZW5naW5lLT5pOTE1LCBDVFhfV0FfQkJfT0JKX1NJWkUpOwotCWlmIChJU19FUlIob2JqKSkKLQkJ
cmV0dXJuIFBUUl9FUlIob2JqKTsKLQotCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9iaiwgJmVu
Z2luZS0+Z3QtPmdndHQtPnZtLCBOVUxMKTsKLQlpZiAoSVNfRVJSKHZtYSkpIHsKLQkJZXJyID0g
UFRSX0VSUih2bWEpOwotCQlnb3RvIGVycjsKLQl9Ci0KLQllcnIgPSBpOTE1X2dndHRfcGluKHZt
YSwgTlVMTCwgMCwgUElOX0hJR0gpOwotCWlmIChlcnIpCi0JCWdvdG8gZXJyOwotCi0JZW5naW5l
LT53YV9jdHgudm1hID0gdm1hOwotCXJldHVybiAwOwotCi1lcnI6Ci0JaTkxNV9nZW1fb2JqZWN0
X3B1dChvYmopOwotCXJldHVybiBlcnI7Ci19Ci0KLXN0YXRpYyB2b2lkIGxyY19kZXN0cm95X3dh
X2N0eChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCi17Ci0JaTkxNV92bWFfdW5waW5f
YW5kX3JlbGVhc2UoJmVuZ2luZS0+d2FfY3R4LnZtYSwgMCk7Ci19Ci0KLXR5cGVkZWYgdTMyICoo
KndhX2JiX2Z1bmNfdCkoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1MzIgKmJhdGNo
KTsKLQotc3RhdGljIGludCBpbnRlbF9pbml0X3dvcmthcm91bmRfYmIoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQotewotCXN0cnVjdCBpOTE1X2N0eF93b3JrYXJvdW5kcyAqd2FfY3R4
ID0gJmVuZ2luZS0+d2FfY3R4OwotCXN0cnVjdCBpOTE1X3dhX2N0eF9iYiAqd2FfYmJbMl0gPSB7
ICZ3YV9jdHgtPmluZGlyZWN0X2N0eCwKLQkJCQkJICAgICZ3YV9jdHgtPnBlcl9jdHggfTsKLQl3
YV9iYl9mdW5jX3Qgd2FfYmJfZm5bMl07Ci0Jdm9pZCAqYmF0Y2gsICpiYXRjaF9wdHI7Ci0JdW5z
aWduZWQgaW50IGk7Ci0JaW50IHJldDsKLQotCWlmIChlbmdpbmUtPmNsYXNzICE9IFJFTkRFUl9D
TEFTUykKLQkJcmV0dXJuIDA7Ci0KLQlzd2l0Y2ggKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpKSB7
Ci0JY2FzZSAxMjoKLQljYXNlIDExOgotCQlyZXR1cm4gMDsKLQljYXNlIDEwOgotCQl3YV9iYl9m
blswXSA9IGdlbjEwX2luaXRfaW5kaXJlY3RjdHhfYmI7Ci0JCXdhX2JiX2ZuWzFdID0gTlVMTDsK
LQkJYnJlYWs7Ci0JY2FzZSA5OgotCQl3YV9iYl9mblswXSA9IGdlbjlfaW5pdF9pbmRpcmVjdGN0
eF9iYjsKLQkJd2FfYmJfZm5bMV0gPSBOVUxMOwotCQlicmVhazsKLQljYXNlIDg6Ci0JCXdhX2Ji
X2ZuWzBdID0gZ2VuOF9pbml0X2luZGlyZWN0Y3R4X2JiOwotCQl3YV9iYl9mblsxXSA9IE5VTEw7
Ci0JCWJyZWFrOwotCWRlZmF1bHQ6Ci0JCU1JU1NJTkdfQ0FTRShJTlRFTF9HRU4oZW5naW5lLT5p
OTE1KSk7Ci0JCXJldHVybiAwOwotCX0KLQotCXJldCA9IGxyY19zZXR1cF93YV9jdHgoZW5naW5l
KTsKLQlpZiAocmV0KSB7Ci0JCWRybV9kYmcoJmVuZ2luZS0+aTkxNS0+ZHJtLAotCQkJIkZhaWxl
ZCB0byBzZXR1cCBjb250ZXh0IFdBIHBhZ2U6ICVkXG4iLCByZXQpOwotCQlyZXR1cm4gcmV0Owot
CX0KLQotCWJhdGNoID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAod2FfY3R4LT52bWEtPm9iaiwg
STkxNV9NQVBfV0IpOwotCi0JLyoKLQkgKiBFbWl0IHRoZSB0d28gd29ya2Fyb3VuZCBiYXRjaCBi
dWZmZXJzLCByZWNvcmRpbmcgdGhlIG9mZnNldCBmcm9tIHRoZQotCSAqIHN0YXJ0IG9mIHRoZSB3
b3JrYXJvdW5kIGJhdGNoIGJ1ZmZlciBvYmplY3QgZm9yIGVhY2ggYW5kIHRoZWlyCi0JICogcmVz
cGVjdGl2ZSBzaXplcy4KLQkgKi8KLQliYXRjaF9wdHIgPSBiYXRjaDsKLQlmb3IgKGkgPSAwOyBp
IDwgQVJSQVlfU0laRSh3YV9iYl9mbik7IGkrKykgewotCQl3YV9iYltpXS0+b2Zmc2V0ID0gYmF0
Y2hfcHRyIC0gYmF0Y2g7Ci0JCWlmIChHRU1fREVCVUdfV0FSTl9PTighSVNfQUxJR05FRCh3YV9i
YltpXS0+b2Zmc2V0LAotCQkJCQkJICBDQUNIRUxJTkVfQllURVMpKSkgewotCQkJcmV0ID0gLUVJ
TlZBTDsKLQkJCWJyZWFrOwotCQl9Ci0JCWlmICh3YV9iYl9mbltpXSkKLQkJCWJhdGNoX3B0ciA9
IHdhX2JiX2ZuW2ldKGVuZ2luZSwgYmF0Y2hfcHRyKTsKLQkJd2FfYmJbaV0tPnNpemUgPSBiYXRj
aF9wdHIgLSAoYmF0Y2ggKyB3YV9iYltpXS0+b2Zmc2V0KTsKLQl9Ci0JR0VNX0JVR19PTihiYXRj
aF9wdHIgLSBiYXRjaCA+IENUWF9XQV9CQl9PQkpfU0laRSk7Ci0KLQlfX2k5MTVfZ2VtX29iamVj
dF9mbHVzaF9tYXAod2FfY3R4LT52bWEtPm9iaiwgMCwgYmF0Y2hfcHRyIC0gYmF0Y2gpOwotCV9f
aTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbWFwKHdhX2N0eC0+dm1hLT5vYmopOwotCWlmIChyZXQp
Ci0JCWxyY19kZXN0cm95X3dhX2N0eChlbmdpbmUpOwotCi0JcmV0dXJuIHJldDsKLX0KLQogc3Rh
dGljIHZvaWQgcmVzZXRfY3NiX3BvaW50ZXJzKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSkKIHsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAqIGNvbnN0IGV4ZWNsaXN0cyA9
ICZlbmdpbmUtPmV4ZWNsaXN0czsKQEAgLTQxODUsMjUgKzI5MjIsNiBAQCBzdGF0aWMgdm9pZCBl
eGVjbGlzdHNfcmVzZXRfcHJlcGFyZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJ
ZW5naW5lLT5leGVjbGlzdHMucmVzZXRfY2NpZCA9IGFjdGl2ZV9jY2lkKGVuZ2luZSk7CiB9CiAK
LXN0YXRpYyB2b2lkIF9fcmVzZXRfc3RvcF9yaW5nKHUzMiAqcmVncywgY29uc3Qgc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lKQotewotCWludCB4OwotCi0JeCA9IGxyY19yaW5nX21pX21v
ZGUoZW5naW5lKTsKLQlpZiAoeCAhPSAtMSkgewotCQlyZWdzW3ggKyAxXSAmPSB+U1RPUF9SSU5H
OwotCQlyZWdzW3ggKyAxXSB8PSBTVE9QX1JJTkcgPDwgMTY7Ci0JfQotfQotCi1zdGF0aWMgdm9p
ZCBfX2V4ZWNsaXN0c19yZXNldF9yZWdfc3RhdGUoY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQg
KmNlLAotCQkJCQljb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCi17Ci0JdTMy
ICpyZWdzID0gY2UtPmxyY19yZWdfc3RhdGU7Ci0KLQlfX3Jlc2V0X3N0b3BfcmluZyhyZWdzLCBl
bmdpbmUpOwotfQotCiBzdGF0aWMgdm9pZCBfX2V4ZWNsaXN0c19yZXNldChzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUsIGJvb2wgc3RhbGxlZCkKIHsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5l
X2V4ZWNsaXN0cyAqIGNvbnN0IGV4ZWNsaXN0cyA9ICZlbmdpbmUtPmV4ZWNsaXN0czsKQEAgLTQy
ODcsOSArMzAwNSw4IEBAIHN0YXRpYyB2b2lkIF9fZXhlY2xpc3RzX3Jlc2V0KHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSwgYm9vbCBzdGFsbGVkKQogb3V0X3JlcGxheToKIAlFTkdJTkVf
VFJBQ0UoZW5naW5lLCAicmVwbGF5IHtoZWFkOiUwNHgsIHRhaWw6JTA0eH1cbiIsCiAJCSAgICAg
aGVhZCwgY2UtPnJpbmctPnRhaWwpOwotCV9fZXhlY2xpc3RzX3Jlc2V0X3JlZ19zdGF0ZShjZSwg
ZW5naW5lKTsKLQlfX2V4ZWNsaXN0c191cGRhdGVfcmVnX3N0YXRlKGNlLCBlbmdpbmUsIGhlYWQp
OwotCWNlLT5scmMuZGVzYyB8PSBDVFhfREVTQ19GT1JDRV9SRVNUT1JFOyAvKiBwYXJhbm9pZDog
R1BVIHdhcyByZXNldCEgKi8KKwlscmNfcmVzZXRfcmVncyhjZSwgZW5naW5lKTsKKwljZS0+bHJj
LmxyY2EgPSBscmNfdXBkYXRlX3JlZ3MoY2UsIGVuZ2luZSwgaGVhZCk7CiAKIHVud2luZDoKIAkv
KiBQdXNoIGJhY2sgYW55IGluY29tcGxldGUgcmVxdWVzdHMgZm9yIHJlcGxheSBhZnRlciB0aGUg
cmVzZXQuICovCkBAIC00NDg3LDcgKzMyMDQsNyBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfcmVs
ZWFzZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJZXhlY2xpc3RzX3NodXRkb3du
KGVuZ2luZSk7CiAKIAlpbnRlbF9lbmdpbmVfY2xlYW51cF9jb21tb24oZW5naW5lKTsKLQlscmNf
ZGVzdHJveV93YV9jdHgoZW5naW5lKTsKKwlscmNfZmluaV93YV9jdHgoZW5naW5lKTsKIH0KIAog
c3RhdGljIHZvaWQKQEAgLTQ1ODEsNyArMzI5OCw3IEBAIGludCBpbnRlbF9leGVjbGlzdHNfc3Vi
bWlzc2lvbl9zZXR1cChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJaWYgKGVuZ2lu
ZS0+Y2xhc3MgPT0gUkVOREVSX0NMQVNTKQogCQlyY3Nfc3VibWlzc2lvbl9vdmVycmlkZShlbmdp
bmUpOwogCi0JaWYgKGludGVsX2luaXRfd29ya2Fyb3VuZF9iYihlbmdpbmUpKQorCWlmIChscmNf
aW5pdF93YV9jdHgoZW5naW5lKSkKIAkJLyoKIAkJICogV2UgY29udGludWUgZXZlbiBpZiB3ZSBm
YWlsIHRvIGluaXRpYWxpemUgV0EgYmF0Y2gKIAkJICogYmVjYXVzZSB3ZSBvbmx5IGV4cGVjdCBy
YXJlIGdsaXRjaGVzIGJ1dCBub3RoaW5nCkBAIC00NjIyLDEzNiArMzMzOSw2IEBAIGludCBpbnRl
bF9leGVjbGlzdHNfc3VibWlzc2lvbl9zZXR1cChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyB2b2lkIGluaXRfY29tbW9uX3JlZ19zdGF0ZSh1
MzIgKiBjb25zdCByZWdzLAotCQkJCSAgY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lLAotCQkJCSAgY29uc3Qgc3RydWN0IGludGVsX3JpbmcgKnJpbmcsCi0JCQkJICBib29sIGlu
aGliaXQpCi17Ci0JdTMyIGN0bDsKLQotCWN0bCA9IF9NQVNLRURfQklUX0VOQUJMRShDVFhfQ1RS
TF9JTkhJQklUX1NZTl9DVFhfU1dJVENIKTsKLQljdGwgfD0gX01BU0tFRF9CSVRfRElTQUJMRShD
VFhfQ1RSTF9FTkdJTkVfQ1RYX1JFU1RPUkVfSU5ISUJJVCk7Ci0JaWYgKGluaGliaXQpCi0JCWN0
bCB8PSBDVFhfQ1RSTF9FTkdJTkVfQ1RYX1JFU1RPUkVfSU5ISUJJVDsKLQlpZiAoSU5URUxfR0VO
KGVuZ2luZS0+aTkxNSkgPCAxMSkKLQkJY3RsIHw9IF9NQVNLRURfQklUX0RJU0FCTEUoQ1RYX0NU
UkxfRU5HSU5FX0NUWF9TQVZFX0lOSElCSVQgfAotCQkJCQkgICBDVFhfQ1RSTF9SU19DVFhfRU5B
QkxFKTsKLQlyZWdzW0NUWF9DT05URVhUX0NPTlRST0xdID0gY3RsOwotCi0JcmVnc1tDVFhfUklO
R19DVExdID0gUklOR19DVExfU0laRShyaW5nLT5zaXplKSB8IFJJTkdfVkFMSUQ7Ci0JcmVnc1tD
VFhfVElNRVNUQU1QXSA9IDA7Ci19Ci0KLXN0YXRpYyB2b2lkIGluaXRfd2FfYmJfcmVnX3N0YXRl
KHUzMiAqIGNvbnN0IHJlZ3MsCi0JCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSkKLXsKLQljb25zdCBzdHJ1Y3QgaTkxNV9jdHhfd29ya2Fyb3VuZHMgKiBjb25zdCB3YV9j
dHggPSAmZW5naW5lLT53YV9jdHg7Ci0KLQlpZiAod2FfY3R4LT5wZXJfY3R4LnNpemUpIHsKLQkJ
Y29uc3QgdTMyIGdndHRfb2Zmc2V0ID0gaTkxNV9nZ3R0X29mZnNldCh3YV9jdHgtPnZtYSk7Ci0K
LQkJR0VNX0JVR19PTihscmNfcmluZ193YV9iYl9wZXJfY3R4KGVuZ2luZSkgPT0gLTEpOwotCQly
ZWdzW2xyY19yaW5nX3dhX2JiX3Blcl9jdHgoZW5naW5lKSArIDFdID0KLQkJCShnZ3R0X29mZnNl
dCArIHdhX2N0eC0+cGVyX2N0eC5vZmZzZXQpIHwgMHgwMTsKLQl9Ci0KLQlpZiAod2FfY3R4LT5p
bmRpcmVjdF9jdHguc2l6ZSkgewotCQlscmNfcmluZ19zZXR1cF9pbmRpcmVjdF9jdHgocmVncywg
ZW5naW5lLAotCQkJCQkgICAgaTkxNV9nZ3R0X29mZnNldCh3YV9jdHgtPnZtYSkgKwotCQkJCQkg
ICAgd2FfY3R4LT5pbmRpcmVjdF9jdHgub2Zmc2V0LAotCQkJCQkgICAgd2FfY3R4LT5pbmRpcmVj
dF9jdHguc2l6ZSk7Ci0JfQotfQotCi1zdGF0aWMgdm9pZCBpbml0X3BwZ3R0X3JlZ19zdGF0ZSh1
MzIgKnJlZ3MsIGNvbnN0IHN0cnVjdCBpOTE1X3BwZ3R0ICpwcGd0dCkKLXsKLQlpZiAoaTkxNV92
bV9pc180bHZsKCZwcGd0dC0+dm0pKSB7Ci0JCS8qIDY0YiBQUEdUVCAoNDhiaXQgY2Fub25pY2Fs
KQotCQkgKiBQRFAwX0RFU0NSSVBUT1IgY29udGFpbnMgdGhlIGJhc2UgYWRkcmVzcyB0byBQTUw0
IGFuZAotCQkgKiBvdGhlciBQRFAgRGVzY3JpcHRvcnMgYXJlIGlnbm9yZWQuCi0JCSAqLwotCQlB
U1NJR05fQ1RYX1BNTDQocHBndHQsIHJlZ3MpOwotCX0gZWxzZSB7Ci0JCUFTU0lHTl9DVFhfUERQ
KHBwZ3R0LCByZWdzLCAzKTsKLQkJQVNTSUdOX0NUWF9QRFAocHBndHQsIHJlZ3MsIDIpOwotCQlB
U1NJR05fQ1RYX1BEUChwcGd0dCwgcmVncywgMSk7Ci0JCUFTU0lHTl9DVFhfUERQKHBwZ3R0LCBy
ZWdzLCAwKTsKLQl9Ci19Ci0KLXN0YXRpYyBzdHJ1Y3QgaTkxNV9wcGd0dCAqdm1fYWxpYXMoc3Ry
dWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0pCi17Ci0JaWYgKGk5MTVfaXNfZ2d0dCh2bSkpCi0J
CXJldHVybiBpOTE1X3ZtX3RvX2dndHQodm0pLT5hbGlhczsKLQllbHNlCi0JCXJldHVybiBpOTE1
X3ZtX3RvX3BwZ3R0KHZtKTsKLX0KLQotc3RhdGljIHZvaWQgZXhlY2xpc3RzX2luaXRfcmVnX3N0
YXRlKHUzMiAqcmVncywKLQkJCQkgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwK
LQkJCQkgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCQkgICAg
IGNvbnN0IHN0cnVjdCBpbnRlbF9yaW5nICpyaW5nLAotCQkJCSAgICAgYm9vbCBpbmhpYml0KQot
ewotCS8qCi0JICogQSBjb250ZXh0IGlzIGFjdHVhbGx5IGEgYmlnIGJhdGNoIGJ1ZmZlciB3aXRo
IHNldmVyYWwKLQkgKiBNSV9MT0FEX1JFR0lTVEVSX0lNTSBjb21tYW5kcyBmb2xsb3dlZCBieSAo
cmVnLCB2YWx1ZSkgcGFpcnMuIFRoZQotCSAqIHZhbHVlcyB3ZSBhcmUgc2V0dGluZyBoZXJlIGFy
ZSBvbmx5IGZvciB0aGUgZmlyc3QgY29udGV4dCByZXN0b3JlOgotCSAqIG9uIGEgc3Vic2VxdWVu
dCBzYXZlLCB0aGUgR1BVIHdpbGwgcmVjcmVhdGUgdGhpcyBiYXRjaGJ1ZmZlciB3aXRoIG5ldwot
CSAqIHZhbHVlcyAoaW5jbHVkaW5nIGFsbCB0aGUgbWlzc2luZyBNSV9MT0FEX1JFR0lTVEVSX0lN
TSBjb21tYW5kcyB0aGF0Ci0JICogd2UgYXJlIG5vdCBpbml0aWFsaXppbmcgaGVyZSkuCi0JICoK
LQkgKiBNdXN0IGtlZXAgY29uc2lzdGVudCB3aXRoIHZpcnR1YWxfdXBkYXRlX3JlZ2lzdGVyX29m
ZnNldHMoKS4KLQkgKi8KLQlzZXRfb2Zmc2V0cyhyZWdzLCByZWdfb2Zmc2V0cyhlbmdpbmUpLCBl
bmdpbmUsIGluaGliaXQpOwotCi0JaW5pdF9jb21tb25fcmVnX3N0YXRlKHJlZ3MsIGVuZ2luZSwg
cmluZywgaW5oaWJpdCk7Ci0JaW5pdF9wcGd0dF9yZWdfc3RhdGUocmVncywgdm1fYWxpYXMoY2Ut
PnZtKSk7Ci0KLQlpbml0X3dhX2JiX3JlZ19zdGF0ZShyZWdzLCBlbmdpbmUpOwotCi0JX19yZXNl
dF9zdG9wX3JpbmcocmVncywgZW5naW5lKTsKLX0KLQotc3RhdGljIGludAotcG9wdWxhdGVfbHJf
Y29udGV4dChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCi0JCSAgICBzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqY3R4X29iaiwKLQkJICAgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSwKLQkJICAgIHN0cnVjdCBpbnRlbF9yaW5nICpyaW5nKQotewotCWJvb2wgaW5oaWJpdCA9IHRy
dWU7Ci0Jdm9pZCAqdmFkZHI7Ci0KLQl2YWRkciA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKGN0
eF9vYmosIEk5MTVfTUFQX1dCKTsKLQlpZiAoSVNfRVJSKHZhZGRyKSkgewotCQlkcm1fZGJnKCZl
bmdpbmUtPmk5MTUtPmRybSwgIkNvdWxkIG5vdCBtYXAgb2JqZWN0IHBhZ2VzIVxuIik7Ci0JCXJl
dHVybiBQVFJfRVJSKHZhZGRyKTsKLQl9Ci0KLQlzZXRfcmVkem9uZSh2YWRkciwgZW5naW5lKTsK
LQotCWlmIChlbmdpbmUtPmRlZmF1bHRfc3RhdGUpIHsKLQkJc2htZW1fcmVhZChlbmdpbmUtPmRl
ZmF1bHRfc3RhdGUsIDAsCi0JCQkgICB2YWRkciwgZW5naW5lLT5jb250ZXh0X3NpemUpOwotCQlf
X3NldF9iaXQoQ09OVEVYVF9WQUxJRF9CSVQsICZjZS0+ZmxhZ3MpOwotCQlpbmhpYml0ID0gZmFs
c2U7Ci0JfQotCi0JLyogQ2xlYXIgdGhlIHBwSFdTUCAoaW5jLiBwZXItY29udGV4dCBjb3VudGVy
cykgKi8KLQltZW1zZXQodmFkZHIsIDAsIFBBR0VfU0laRSk7Ci0KLQkvKgotCSAqIFRoZSBzZWNv
bmQgcGFnZSBvZiB0aGUgY29udGV4dCBvYmplY3QgY29udGFpbnMgc29tZSByZWdpc3RlcnMgd2hp
Y2gKLQkgKiBtdXN0IGJlIHNldCB1cCBwcmlvciB0byB0aGUgZmlyc3QgZXhlY3V0aW9uLgotCSAq
LwotCWV4ZWNsaXN0c19pbml0X3JlZ19zdGF0ZSh2YWRkciArIExSQ19TVEFURV9PRkZTRVQsCi0J
CQkJIGNlLCBlbmdpbmUsIHJpbmcsIGluaGliaXQpOwotCi0JX19pOTE1X2dlbV9vYmplY3RfZmx1
c2hfbWFwKGN0eF9vYmosIDAsIGVuZ2luZS0+Y29udGV4dF9zaXplKTsKLQlpOTE1X2dlbV9vYmpl
Y3RfdW5waW5fbWFwKGN0eF9vYmopOwotCXJldHVybiAwOwotfQotCiBzdGF0aWMgc3RydWN0IGlu
dGVsX3RpbWVsaW5lICpwaW5uZWRfdGltZWxpbmUoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQog
ewogCXN0cnVjdCBpbnRlbF90aW1lbGluZSAqdGwgPSBmZXRjaF9hbmRfemVybygmY2UtPnRpbWVs
aW5lKTsKQEAgLTQ3NjMsMzIgKzMzNTAsMTEgQEAgc3RhdGljIHN0cnVjdCBpbnRlbF90aW1lbGlu
ZSAqcGlubmVkX3RpbWVsaW5lKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKIHN0YXRpYyBpbnQg
X19leGVjbGlzdHNfY29udGV4dF9hbGxvYyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCiAJCQkJ
ICAgICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7Ci0Jc3RydWN0IGRybV9pOTE1
X2dlbV9vYmplY3QgKmN0eF9vYmo7Ci0Jc3RydWN0IGludGVsX3JpbmcgKnJpbmc7Ci0Jc3RydWN0
IGk5MTVfdm1hICp2bWE7Ci0JdTMyIGNvbnRleHRfc2l6ZTsKLQlpbnQgcmV0OwotCi0JR0VNX0JV
R19PTihjZS0+c3RhdGUpOwotCWNvbnRleHRfc2l6ZSA9IHJvdW5kX3VwKGVuZ2luZS0+Y29udGV4
dF9zaXplLCBJOTE1X0dUVF9QQUdFX1NJWkUpOwotCi0JaWYgKElTX0VOQUJMRUQoQ09ORklHX0RS
TV9JOTE1X0RFQlVHX0dFTSkpCi0JCWNvbnRleHRfc2l6ZSArPSBJOTE1X0dUVF9QQUdFX1NJWkU7
IC8qIGZvciByZWR6b25lICovCi0KLQlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPT0gMTIp
IHsKLQkJY2UtPndhX2JiX3BhZ2UgPSBjb250ZXh0X3NpemUgLyBQQUdFX1NJWkU7Ci0JCWNvbnRl
eHRfc2l6ZSArPSBQQUdFX1NJWkU7Ci0JfQotCi0JY3R4X29iaiA9IGk5MTVfZ2VtX29iamVjdF9j
cmVhdGVfc2htZW0oZW5naW5lLT5pOTE1LCBjb250ZXh0X3NpemUpOwotCWlmIChJU19FUlIoY3R4
X29iaikpCi0JCXJldHVybiBQVFJfRVJSKGN0eF9vYmopOworCWludCBlcnI7CiAKLQl2bWEgPSBp
OTE1X3ZtYV9pbnN0YW5jZShjdHhfb2JqLCAmZW5naW5lLT5ndC0+Z2d0dC0+dm0sIE5VTEwpOwot
CWlmIChJU19FUlIodm1hKSkgewotCQlyZXQgPSBQVFJfRVJSKHZtYSk7Ci0JCWdvdG8gZXJyb3Jf
ZGVyZWZfb2JqOwotCX0KKwllcnIgPSBscmNfYWxsb2MoY2UsIGVuZ2luZSk7CisJaWYgKGVycikK
KwkJcmV0dXJuIGVycjsKIAogCWlmICghcGFnZV9tYXNrX2JpdHMoY2UtPnRpbWVsaW5lKSkgewog
CQlzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRsOwpAQCAtNDgwMSwzNyArMzM2NywxMyBAQCBzdGF0
aWMgaW50IF9fZXhlY2xpc3RzX2NvbnRleHRfYWxsb2Moc3RydWN0IGludGVsX2NvbnRleHQgKmNl
LAogCQkJdGwgPSBwaW5uZWRfdGltZWxpbmUoY2UpOwogCQllbHNlCiAJCQl0bCA9IGludGVsX3Rp
bWVsaW5lX2NyZWF0ZShlbmdpbmUtPmd0KTsKLQkJaWYgKElTX0VSUih0bCkpIHsKLQkJCXJldCA9
IFBUUl9FUlIodGwpOwotCQkJZ290byBlcnJvcl9kZXJlZl9vYmo7Ci0JCX0KKwkJaWYgKElTX0VS
Uih0bCkpCisJCQlyZXR1cm4gUFRSX0VSUih0bCk7CiAKIAkJY2UtPnRpbWVsaW5lID0gdGw7CiAJ
fQogCi0JcmluZyA9IGludGVsX2VuZ2luZV9jcmVhdGVfcmluZyhlbmdpbmUsICh1bnNpZ25lZCBs
b25nKWNlLT5yaW5nKTsKLQlpZiAoSVNfRVJSKHJpbmcpKSB7Ci0JCXJldCA9IFBUUl9FUlIocmlu
Zyk7Ci0JCWdvdG8gZXJyb3JfZGVyZWZfb2JqOwotCX0KLQotCXJldCA9IHBvcHVsYXRlX2xyX2Nv
bnRleHQoY2UsIGN0eF9vYmosIGVuZ2luZSwgcmluZyk7Ci0JaWYgKHJldCkgewotCQlkcm1fZGJn
KCZlbmdpbmUtPmk5MTUtPmRybSwKLQkJCSJGYWlsZWQgdG8gcG9wdWxhdGUgTFJDOiAlZFxuIiwg
cmV0KTsKLQkJZ290byBlcnJvcl9yaW5nX2ZyZWU7Ci0JfQotCi0JY2UtPnJpbmcgPSByaW5nOwot
CWNlLT5zdGF0ZSA9IHZtYTsKLQogCXJldHVybiAwOwotCi1lcnJvcl9yaW5nX2ZyZWU6Ci0JaW50
ZWxfcmluZ19wdXQocmluZyk7Ci1lcnJvcl9kZXJlZl9vYmo6Ci0JaTkxNV9nZW1fb2JqZWN0X3B1
dChjdHhfb2JqKTsKLQlyZXR1cm4gcmV0OwogfQogCiBzdGF0aWMgc3RydWN0IGxpc3RfaGVhZCAq
dmlydHVhbF9xdWV1ZShzdHJ1Y3QgdmlydHVhbF9lbmdpbmUgKnZlKQpAQCAtNTQ3MCwyOCArNDAx
Miw2IEBAIHZvaWQgaW50ZWxfZXhlY2xpc3RzX3Nob3dfcmVxdWVzdHMoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lLAogCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmVuZ2luZS0+YWN0aXZl
LmxvY2ssIGZsYWdzKTsKIH0KIAotdm9pZCBpbnRlbF9scl9jb250ZXh0X3Jlc2V0KHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCSAgICBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2Us
Ci0JCQkgICAgdTMyIGhlYWQsCi0JCQkgICAgYm9vbCBzY3J1YikKLXsKLQlHRU1fQlVHX09OKCFp
bnRlbF9jb250ZXh0X2lzX3Bpbm5lZChjZSkpOwotCi0JLyoKLQkgKiBXZSB3YW50IGEgc2ltcGxl
IGNvbnRleHQgKyByaW5nIHRvIGV4ZWN1dGUgdGhlIGJyZWFkY3J1bWIgdXBkYXRlLgotCSAqIFdl
IGNhbm5vdCByZWx5IG9uIHRoZSBjb250ZXh0IGJlaW5nIGludGFjdCBhY3Jvc3MgdGhlIEdQVSBo
YW5nLAotCSAqIHNvIGNsZWFyIGl0IGFuZCByZWJ1aWxkIGp1c3Qgd2hhdCB3ZSBuZWVkIGZvciB0
aGUgYnJlYWRjcnVtYi4KLQkgKiBBbGwgcGVuZGluZyByZXF1ZXN0cyBmb3IgdGhpcyBjb250ZXh0
IHdpbGwgYmUgemFwcGVkLCBhbmQgYW55Ci0JICogZnV0dXJlIHJlcXVlc3Qgd2lsbCBiZSBhZnRl
ciB1c2Vyc3BhY2UgaGFzIGhhZCB0aGUgb3Bwb3J0dW5pdHkKLQkgKiB0byByZWNyZWF0ZSBpdHMg
b3duIHN0YXRlLgotCSAqLwotCWlmIChzY3J1YikKLQkJcmVzdG9yZV9kZWZhdWx0X3N0YXRlKGNl
LCBlbmdpbmUpOwotCi0JLyogUmVydW4gdGhlIHJlcXVlc3Q7IGl0cyBwYXlsb2FkIGhhcyBiZWVu
IG5ldXRlcmVkIChpZiBndWlsdHkpLiAqLwotCV9fZXhlY2xpc3RzX3VwZGF0ZV9yZWdfc3RhdGUo
Y2UsIGVuZ2luZSwgaGVhZCk7Ci19Ci0KIGJvb2wKIGludGVsX2VuZ2luZV9pbl9leGVjbGlzdHNf
c3VibWlzc2lvbl9tb2RlKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2V4ZWNsaXN0c19zdWJt
aXNzaW9uLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9leGVjbGlzdHNfc3VibWlz
c2lvbi5oCmluZGV4IDJjOWQ3MzU0YjQyZi4uMGM2NzViYmZmMzUxIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9leGVjbGlzdHNfc3VibWlzc2lvbi5oCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uLmgKQEAgLTIy
LDI1ICsyMiw4IEBAIGVudW0gewogCiBpbnQgaW50ZWxfZXhlY2xpc3RzX3N1Ym1pc3Npb25fc2V0
dXAoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKIAotLyogTG9naWNhbCBSaW5nIENv
bnRleHRzICovCi0vKiBBdCB0aGUgc3RhcnQgb2YgdGhlIGNvbnRleHQgaW1hZ2UgaXMgaXRzIHBl
ci1wcm9jZXNzIEhXUyBwYWdlICovCi0jZGVmaW5lIExSQ19QUEhXU1BfUE4JKDApCi0jZGVmaW5l
IExSQ19QUEhXU1BfU1oJKDEpCi0vKiBBZnRlciB0aGUgUFBIV1NQIHdlIGhhdmUgdGhlIGxvZ2lj
YWwgc3RhdGUgZm9yIHRoZSBjb250ZXh0ICovCi0jZGVmaW5lIExSQ19TVEFURV9QTgkoTFJDX1BQ
SFdTUF9QTiArIExSQ19QUEhXU1BfU1opCi0jZGVmaW5lIExSQ19TVEFURV9PRkZTRVQgKExSQ19T
VEFURV9QTiAqIFBBR0VfU0laRSkKLQotLyogU3BhY2Ugd2l0aGluIFBQSFdTUCByZXNlcnZlZCB0
byBiZSB1c2VkIGFzIHNjcmF0Y2ggKi8KLSNkZWZpbmUgTFJDX1BQSFdTUF9TQ1JBVENICQkweDM0
Ci0jZGVmaW5lIExSQ19QUEhXU1BfU0NSQVRDSF9BRERSCQkoTFJDX1BQSFdTUF9TQ1JBVENIICog
c2l6ZW9mKHUzMikpCi0KIHZvaWQgaW50ZWxfZXhlY2xpc3RzX3NldF9kZWZhdWx0X3N1Ym1pc3Np
b24oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKIAotdm9pZCBpbnRlbF9scl9jb250
ZXh0X3Jlc2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCSAgICBzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqY2UsCi0JCQkgICAgdTMyIGhlYWQsCi0JCQkgICAgYm9vbCBzY3J1Yik7
Ci0KIHZvaWQgaW50ZWxfZXhlY2xpc3RzX3Nob3dfcmVxdWVzdHMoc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lLAogCQkJCSAgIHN0cnVjdCBkcm1fcHJpbnRlciAqbSwKIAkJCQkgICB2b2lk
ICgqc2hvd19yZXF1ZXN0KShzdHJ1Y3QgZHJtX3ByaW50ZXIgKm0sCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2xyYy5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uODVi
M2QxMTE3NTMzCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfbHJjLmMKQEAgLTAsMCArMSwxNDcwIEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjog
TUlUCisvKgorICogQ29weXJpZ2h0IMKpIDIwMTQgSW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisj
aW5jbHVkZSAiaTkxNV9kcnYuaCIKKyNpbmNsdWRlICJpOTE1X3BlcmYuaCIKKyNpbmNsdWRlICJp
bnRlbF9lbmdpbmUuaCIKKyNpbmNsdWRlICJpbnRlbF9ndC5oIgorI2luY2x1ZGUgImludGVsX2xy
Yy5oIgorI2luY2x1ZGUgImludGVsX2xyY19yZWcuaCIKKyNpbmNsdWRlICJpbnRlbF9yaW5nLmgi
CisjaW5jbHVkZSAic2htZW1fdXRpbHMuaCIKKworc3RhdGljIGlubGluZSB1bnNpZ25lZCBpbnQg
ZHdvcmRfaW5fcGFnZSh2b2lkICphZGRyKQoreworCXJldHVybiBvZmZzZXRfaW5fcGFnZShhZGRy
KSAvIHNpemVvZih1MzIpOworfQorCitzdGF0aWMgdm9pZCBzZXRfb2Zmc2V0cyh1MzIgKnJlZ3Ms
CisJCQljb25zdCB1OCAqZGF0YSwKKwkJCWNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSwKKwkJCWJvb2wgY2xlYXIpCisjZGVmaW5lIE5PUCh4KSAoQklUKDcpIHwgKHgpKQorI2Rl
ZmluZSBMUkkoY291bnQsIGZsYWdzKSAoKGZsYWdzKSA8PCA2IHwgKGNvdW50KSB8IEJVSUxEX0JV
R19PTl9aRVJPKGNvdW50ID49IEJJVCg2KSkpCisjZGVmaW5lIFBPU1RFRCBCSVQoMCkKKyNkZWZp
bmUgUkVHKHgpICgoKHgpID4+IDIpIHwgQlVJTERfQlVHX09OX1pFUk8oeCA+PSAweDIwMCkpCisj
ZGVmaW5lIFJFRzE2KHgpIFwKKwkoKCh4KSA+PiA5KSB8IEJJVCg3KSB8IEJVSUxEX0JVR19PTl9a
RVJPKHggPj0gMHgxMDAwMCkpLCBcCisJKCgoeCkgPj4gMikgJiAweDdmKQorI2RlZmluZSBFTkQo
dG90YWxfc3RhdGVfc2l6ZSkgMCwgKHRvdGFsX3N0YXRlX3NpemUpCit7CisJY29uc3QgdTMyIGJh
c2UgPSBlbmdpbmUtPm1taW9fYmFzZTsKKworCXdoaWxlICgqZGF0YSkgeworCQl1OCBjb3VudCwg
ZmxhZ3M7CisKKwkJaWYgKCpkYXRhICYgQklUKDcpKSB7IC8qIHNraXAgKi8KKwkJCWNvdW50ID0g
KmRhdGErKyAmIH5CSVQoNyk7CisJCQlpZiAoY2xlYXIpCisJCQkJbWVtc2V0MzIocmVncywgTUlf
Tk9PUCwgY291bnQpOworCQkJcmVncyArPSBjb3VudDsKKwkJCWNvbnRpbnVlOworCQl9CisKKwkJ
Y291bnQgPSAqZGF0YSAmIDB4M2Y7CisJCWZsYWdzID0gKmRhdGEgPj4gNjsKKwkJZGF0YSsrOwor
CisJCSpyZWdzID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oY291bnQpOworCQlpZiAoZmxhZ3MgJiBQ
T1NURUQpCisJCQkqcmVncyB8PSBNSV9MUklfRk9SQ0VfUE9TVEVEOworCQlpZiAoSU5URUxfR0VO
KGVuZ2luZS0+aTkxNSkgPj0gMTEpCisJCQkqcmVncyB8PSBNSV9MUklfTFJNX0NTX01NSU87CisJ
CXJlZ3MrKzsKKworCQlHRU1fQlVHX09OKCFjb3VudCk7CisJCWRvIHsKKwkJCXUzMiBvZmZzZXQg
PSAwOworCQkJdTggdjsKKworCQkJZG8geworCQkJCXYgPSAqZGF0YSsrOworCQkJCW9mZnNldCA8
PD0gNzsKKwkJCQlvZmZzZXQgfD0gdiAmIH5CSVQoNyk7CisJCQl9IHdoaWxlICh2ICYgQklUKDcp
KTsKKworCQkJcmVnc1swXSA9IGJhc2UgKyAob2Zmc2V0IDw8IDIpOworCQkJaWYgKGNsZWFyKQor
CQkJCXJlZ3NbMV0gPSAwOworCQkJcmVncyArPSAyOworCQl9IHdoaWxlICgtLWNvdW50KTsKKwl9
CisKKwlpZiAoY2xlYXIpIHsKKwkJdTggY291bnQgPSAqKytkYXRhOworCisJCS8qIENsZWFyIHBh
c3QgdGhlIHRhaWwgZm9yIEhXIGFjY2VzcyAqLworCQlHRU1fQlVHX09OKGR3b3JkX2luX3BhZ2Uo
cmVncykgPiBjb3VudCk7CisJCW1lbXNldDMyKHJlZ3MsIE1JX05PT1AsIGNvdW50IC0gZHdvcmRf
aW5fcGFnZShyZWdzKSk7CisKKwkJLyogQ2xvc2UgdGhlIGJhdGNoOyB1c2VkIG1haW5seSBieSBs
aXZlX2xyY19sYXlvdXQoKSAqLworCQkqcmVncyA9IE1JX0JBVENIX0JVRkZFUl9FTkQ7CisJCWlm
IChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMCkKKwkJCSpyZWdzIHw9IEJJVCgwKTsKKwl9
Cit9CisKK3N0YXRpYyBjb25zdCB1OCBnZW44X3hjc19vZmZzZXRzW10gPSB7CisJTk9QKDEpLAor
CUxSSSgxMSwgMCksCisJUkVHMTYoMHgyNDQpLAorCVJFRygweDAzNCksCisJUkVHKDB4MDMwKSwK
KwlSRUcoMHgwMzgpLAorCVJFRygweDAzYyksCisJUkVHKDB4MTY4KSwKKwlSRUcoMHgxNDApLAor
CVJFRygweDExMCksCisJUkVHKDB4MTFjKSwKKwlSRUcoMHgxMTQpLAorCVJFRygweDExOCksCisK
KwlOT1AoOSksCisJTFJJKDksIDApLAorCVJFRzE2KDB4M2E4KSwKKwlSRUcxNigweDI4YyksCisJ
UkVHMTYoMHgyODgpLAorCVJFRzE2KDB4Mjg0KSwKKwlSRUcxNigweDI4MCksCisJUkVHMTYoMHgy
N2MpLAorCVJFRzE2KDB4Mjc4KSwKKwlSRUcxNigweDI3NCksCisJUkVHMTYoMHgyNzApLAorCisJ
Tk9QKDEzKSwKKwlMUkkoMiwgMCksCisJUkVHMTYoMHgyMDApLAorCVJFRygweDAyOCksCisKKwlF
TkQoODApCit9OworCitzdGF0aWMgY29uc3QgdTggZ2VuOV94Y3Nfb2Zmc2V0c1tdID0geworCU5P
UCgxKSwKKwlMUkkoMTQsIFBPU1RFRCksCisJUkVHMTYoMHgyNDQpLAorCVJFRygweDAzNCksCisJ
UkVHKDB4MDMwKSwKKwlSRUcoMHgwMzgpLAorCVJFRygweDAzYyksCisJUkVHKDB4MTY4KSwKKwlS
RUcoMHgxNDApLAorCVJFRygweDExMCksCisJUkVHKDB4MTFjKSwKKwlSRUcoMHgxMTQpLAorCVJF
RygweDExOCksCisJUkVHKDB4MWMwKSwKKwlSRUcoMHgxYzQpLAorCVJFRygweDFjOCksCisKKwlO
T1AoMyksCisJTFJJKDksIFBPU1RFRCksCisJUkVHMTYoMHgzYTgpLAorCVJFRzE2KDB4MjhjKSwK
KwlSRUcxNigweDI4OCksCisJUkVHMTYoMHgyODQpLAorCVJFRzE2KDB4MjgwKSwKKwlSRUcxNigw
eDI3YyksCisJUkVHMTYoMHgyNzgpLAorCVJFRzE2KDB4Mjc0KSwKKwlSRUcxNigweDI3MCksCisK
KwlOT1AoMTMpLAorCUxSSSgxLCBQT1NURUQpLAorCVJFRzE2KDB4MjAwKSwKKworCU5PUCgxMyks
CisJTFJJKDQ0LCBQT1NURUQpLAorCVJFRygweDAyOCksCisJUkVHKDB4MDljKSwKKwlSRUcoMHgw
YzApLAorCVJFRygweDE3OCksCisJUkVHKDB4MTdjKSwKKwlSRUcxNigweDM1OCksCisJUkVHKDB4
MTcwKSwKKwlSRUcoMHgxNTApLAorCVJFRygweDE1NCksCisJUkVHKDB4MTU4KSwKKwlSRUcxNigw
eDQxYyksCisJUkVHMTYoMHg2MDApLAorCVJFRzE2KDB4NjA0KSwKKwlSRUcxNigweDYwOCksCisJ
UkVHMTYoMHg2MGMpLAorCVJFRzE2KDB4NjEwKSwKKwlSRUcxNigweDYxNCksCisJUkVHMTYoMHg2
MTgpLAorCVJFRzE2KDB4NjFjKSwKKwlSRUcxNigweDYyMCksCisJUkVHMTYoMHg2MjQpLAorCVJF
RzE2KDB4NjI4KSwKKwlSRUcxNigweDYyYyksCisJUkVHMTYoMHg2MzApLAorCVJFRzE2KDB4NjM0
KSwKKwlSRUcxNigweDYzOCksCisJUkVHMTYoMHg2M2MpLAorCVJFRzE2KDB4NjQwKSwKKwlSRUcx
NigweDY0NCksCisJUkVHMTYoMHg2NDgpLAorCVJFRzE2KDB4NjRjKSwKKwlSRUcxNigweDY1MCks
CisJUkVHMTYoMHg2NTQpLAorCVJFRzE2KDB4NjU4KSwKKwlSRUcxNigweDY1YyksCisJUkVHMTYo
MHg2NjApLAorCVJFRzE2KDB4NjY0KSwKKwlSRUcxNigweDY2OCksCisJUkVHMTYoMHg2NmMpLAor
CVJFRzE2KDB4NjcwKSwKKwlSRUcxNigweDY3NCksCisJUkVHMTYoMHg2NzgpLAorCVJFRzE2KDB4
NjdjKSwKKwlSRUcoMHgwNjgpLAorCisJRU5EKDE3NikKK307CisKK3N0YXRpYyBjb25zdCB1OCBn
ZW4xMl94Y3Nfb2Zmc2V0c1tdID0geworCU5PUCgxKSwKKwlMUkkoMTMsIFBPU1RFRCksCisJUkVH
MTYoMHgyNDQpLAorCVJFRygweDAzNCksCisJUkVHKDB4MDMwKSwKKwlSRUcoMHgwMzgpLAorCVJF
RygweDAzYyksCisJUkVHKDB4MTY4KSwKKwlSRUcoMHgxNDApLAorCVJFRygweDExMCksCisJUkVH
KDB4MWMwKSwKKwlSRUcoMHgxYzQpLAorCVJFRygweDFjOCksCisJUkVHKDB4MTgwKSwKKwlSRUcx
NigweDJiNCksCisKKwlOT1AoNSksCisJTFJJKDksIFBPU1RFRCksCisJUkVHMTYoMHgzYTgpLAor
CVJFRzE2KDB4MjhjKSwKKwlSRUcxNigweDI4OCksCisJUkVHMTYoMHgyODQpLAorCVJFRzE2KDB4
MjgwKSwKKwlSRUcxNigweDI3YyksCisJUkVHMTYoMHgyNzgpLAorCVJFRzE2KDB4Mjc0KSwKKwlS
RUcxNigweDI3MCksCisKKwlFTkQoODApCit9OworCitzdGF0aWMgY29uc3QgdTggZ2VuOF9yY3Nf
b2Zmc2V0c1tdID0geworCU5PUCgxKSwKKwlMUkkoMTQsIFBPU1RFRCksCisJUkVHMTYoMHgyNDQp
LAorCVJFRygweDAzNCksCisJUkVHKDB4MDMwKSwKKwlSRUcoMHgwMzgpLAorCVJFRygweDAzYyks
CisJUkVHKDB4MTY4KSwKKwlSRUcoMHgxNDApLAorCVJFRygweDExMCksCisJUkVHKDB4MTFjKSwK
KwlSRUcoMHgxMTQpLAorCVJFRygweDExOCksCisJUkVHKDB4MWMwKSwKKwlSRUcoMHgxYzQpLAor
CVJFRygweDFjOCksCisKKwlOT1AoMyksCisJTFJJKDksIFBPU1RFRCksCisJUkVHMTYoMHgzYTgp
LAorCVJFRzE2KDB4MjhjKSwKKwlSRUcxNigweDI4OCksCisJUkVHMTYoMHgyODQpLAorCVJFRzE2
KDB4MjgwKSwKKwlSRUcxNigweDI3YyksCisJUkVHMTYoMHgyNzgpLAorCVJFRzE2KDB4Mjc0KSwK
KwlSRUcxNigweDI3MCksCisKKwlOT1AoMTMpLAorCUxSSSgxLCAwKSwKKwlSRUcoMHgwYzgpLAor
CisJRU5EKDgwKQorfTsKKworc3RhdGljIGNvbnN0IHU4IGdlbjlfcmNzX29mZnNldHNbXSA9IHsK
KwlOT1AoMSksCisJTFJJKDE0LCBQT1NURUQpLAorCVJFRzE2KDB4MjQ0KSwKKwlSRUcoMHgzNCks
CisJUkVHKDB4MzApLAorCVJFRygweDM4KSwKKwlSRUcoMHgzYyksCisJUkVHKDB4MTY4KSwKKwlS
RUcoMHgxNDApLAorCVJFRygweDExMCksCisJUkVHKDB4MTFjKSwKKwlSRUcoMHgxMTQpLAorCVJF
RygweDExOCksCisJUkVHKDB4MWMwKSwKKwlSRUcoMHgxYzQpLAorCVJFRygweDFjOCksCisKKwlO
T1AoMyksCisJTFJJKDksIFBPU1RFRCksCisJUkVHMTYoMHgzYTgpLAorCVJFRzE2KDB4MjhjKSwK
KwlSRUcxNigweDI4OCksCisJUkVHMTYoMHgyODQpLAorCVJFRzE2KDB4MjgwKSwKKwlSRUcxNigw
eDI3YyksCisJUkVHMTYoMHgyNzgpLAorCVJFRzE2KDB4Mjc0KSwKKwlSRUcxNigweDI3MCksCisK
KwlOT1AoMTMpLAorCUxSSSgxLCAwKSwKKwlSRUcoMHhjOCksCisKKwlOT1AoMTMpLAorCUxSSSg0
NCwgUE9TVEVEKSwKKwlSRUcoMHgyOCksCisJUkVHKDB4OWMpLAorCVJFRygweGMwKSwKKwlSRUco
MHgxNzgpLAorCVJFRygweDE3YyksCisJUkVHMTYoMHgzNTgpLAorCVJFRygweDE3MCksCisJUkVH
KDB4MTUwKSwKKwlSRUcoMHgxNTQpLAorCVJFRygweDE1OCksCisJUkVHMTYoMHg0MWMpLAorCVJF
RzE2KDB4NjAwKSwKKwlSRUcxNigweDYwNCksCisJUkVHMTYoMHg2MDgpLAorCVJFRzE2KDB4NjBj
KSwKKwlSRUcxNigweDYxMCksCisJUkVHMTYoMHg2MTQpLAorCVJFRzE2KDB4NjE4KSwKKwlSRUcx
NigweDYxYyksCisJUkVHMTYoMHg2MjApLAorCVJFRzE2KDB4NjI0KSwKKwlSRUcxNigweDYyOCks
CisJUkVHMTYoMHg2MmMpLAorCVJFRzE2KDB4NjMwKSwKKwlSRUcxNigweDYzNCksCisJUkVHMTYo
MHg2MzgpLAorCVJFRzE2KDB4NjNjKSwKKwlSRUcxNigweDY0MCksCisJUkVHMTYoMHg2NDQpLAor
CVJFRzE2KDB4NjQ4KSwKKwlSRUcxNigweDY0YyksCisJUkVHMTYoMHg2NTApLAorCVJFRzE2KDB4
NjU0KSwKKwlSRUcxNigweDY1OCksCisJUkVHMTYoMHg2NWMpLAorCVJFRzE2KDB4NjYwKSwKKwlS
RUcxNigweDY2NCksCisJUkVHMTYoMHg2NjgpLAorCVJFRzE2KDB4NjZjKSwKKwlSRUcxNigweDY3
MCksCisJUkVHMTYoMHg2NzQpLAorCVJFRzE2KDB4Njc4KSwKKwlSRUcxNigweDY3YyksCisJUkVH
KDB4NjgpLAorCisJRU5EKDE3NikKK307CisKK3N0YXRpYyBjb25zdCB1OCBnZW4xMV9yY3Nfb2Zm
c2V0c1tdID0geworCU5PUCgxKSwKKwlMUkkoMTUsIFBPU1RFRCksCisJUkVHMTYoMHgyNDQpLAor
CVJFRygweDAzNCksCisJUkVHKDB4MDMwKSwKKwlSRUcoMHgwMzgpLAorCVJFRygweDAzYyksCisJ
UkVHKDB4MTY4KSwKKwlSRUcoMHgxNDApLAorCVJFRygweDExMCksCisJUkVHKDB4MTFjKSwKKwlS
RUcoMHgxMTQpLAorCVJFRygweDExOCksCisJUkVHKDB4MWMwKSwKKwlSRUcoMHgxYzQpLAorCVJF
RygweDFjOCksCisJUkVHKDB4MTgwKSwKKworCU5PUCgxKSwKKwlMUkkoOSwgUE9TVEVEKSwKKwlS
RUcxNigweDNhOCksCisJUkVHMTYoMHgyOGMpLAorCVJFRzE2KDB4Mjg4KSwKKwlSRUcxNigweDI4
NCksCisJUkVHMTYoMHgyODApLAorCVJFRzE2KDB4MjdjKSwKKwlSRUcxNigweDI3OCksCisJUkVH
MTYoMHgyNzQpLAorCVJFRzE2KDB4MjcwKSwKKworCUxSSSgxLCBQT1NURUQpLAorCVJFRygweDFi
MCksCisKKwlOT1AoMTApLAorCUxSSSgxLCAwKSwKKwlSRUcoMHgwYzgpLAorCisJRU5EKDgwKQor
fTsKKworc3RhdGljIGNvbnN0IHU4IGdlbjEyX3Jjc19vZmZzZXRzW10gPSB7CisJTk9QKDEpLAor
CUxSSSgxMywgUE9TVEVEKSwKKwlSRUcxNigweDI0NCksCisJUkVHKDB4MDM0KSwKKwlSRUcoMHgw
MzApLAorCVJFRygweDAzOCksCisJUkVHKDB4MDNjKSwKKwlSRUcoMHgxNjgpLAorCVJFRygweDE0
MCksCisJUkVHKDB4MTEwKSwKKwlSRUcoMHgxYzApLAorCVJFRygweDFjNCksCisJUkVHKDB4MWM4
KSwKKwlSRUcoMHgxODApLAorCVJFRzE2KDB4MmI0KSwKKworCU5PUCg1KSwKKwlMUkkoOSwgUE9T
VEVEKSwKKwlSRUcxNigweDNhOCksCisJUkVHMTYoMHgyOGMpLAorCVJFRzE2KDB4Mjg4KSwKKwlS
RUcxNigweDI4NCksCisJUkVHMTYoMHgyODApLAorCVJFRzE2KDB4MjdjKSwKKwlSRUcxNigweDI3
OCksCisJUkVHMTYoMHgyNzQpLAorCVJFRzE2KDB4MjcwKSwKKworCUxSSSgzLCBQT1NURUQpLAor
CVJFRygweDFiMCksCisJUkVHMTYoMHg1YTgpLAorCVJFRzE2KDB4NWFjKSwKKworCU5PUCg2KSwK
KwlMUkkoMSwgMCksCisJUkVHKDB4MGM4KSwKKwlOT1AoMyArIDkgKyAxKSwKKworCUxSSSg1MSwg
UE9TVEVEKSwKKwlSRUcxNigweDU4OCksCisJUkVHMTYoMHg1ODgpLAorCVJFRzE2KDB4NTg4KSwK
KwlSRUcxNigweDU4OCksCisJUkVHMTYoMHg1ODgpLAorCVJFRzE2KDB4NTg4KSwKKwlSRUcoMHgw
MjgpLAorCVJFRygweDA5YyksCisJUkVHKDB4MGMwKSwKKwlSRUcoMHgxNzgpLAorCVJFRygweDE3
YyksCisJUkVHMTYoMHgzNTgpLAorCVJFRygweDE3MCksCisJUkVHKDB4MTUwKSwKKwlSRUcoMHgx
NTQpLAorCVJFRygweDE1OCksCisJUkVHMTYoMHg0MWMpLAorCVJFRzE2KDB4NjAwKSwKKwlSRUcx
NigweDYwNCksCisJUkVHMTYoMHg2MDgpLAorCVJFRzE2KDB4NjBjKSwKKwlSRUcxNigweDYxMCks
CisJUkVHMTYoMHg2MTQpLAorCVJFRzE2KDB4NjE4KSwKKwlSRUcxNigweDYxYyksCisJUkVHMTYo
MHg2MjApLAorCVJFRzE2KDB4NjI0KSwKKwlSRUcxNigweDYyOCksCisJUkVHMTYoMHg2MmMpLAor
CVJFRzE2KDB4NjMwKSwKKwlSRUcxNigweDYzNCksCisJUkVHMTYoMHg2MzgpLAorCVJFRzE2KDB4
NjNjKSwKKwlSRUcxNigweDY0MCksCisJUkVHMTYoMHg2NDQpLAorCVJFRzE2KDB4NjQ4KSwKKwlS
RUcxNigweDY0YyksCisJUkVHMTYoMHg2NTApLAorCVJFRzE2KDB4NjU0KSwKKwlSRUcxNigweDY1
OCksCisJUkVHMTYoMHg2NWMpLAorCVJFRzE2KDB4NjYwKSwKKwlSRUcxNigweDY2NCksCisJUkVH
MTYoMHg2NjgpLAorCVJFRzE2KDB4NjZjKSwKKwlSRUcxNigweDY3MCksCisJUkVHMTYoMHg2NzQp
LAorCVJFRzE2KDB4Njc4KSwKKwlSRUcxNigweDY3YyksCisJUkVHKDB4MDY4KSwKKwlSRUcoMHgw
ODQpLAorCU5PUCgxKSwKKworCUVORCgxOTIpCit9OworCisjdW5kZWYgRU5ECisjdW5kZWYgUkVH
MTYKKyN1bmRlZiBSRUcKKyN1bmRlZiBMUkkKKyN1bmRlZiBOT1AKKworc3RhdGljIGNvbnN0IHU4
ICpyZWdfb2Zmc2V0cyhjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJ
LyoKKwkgKiBUaGUgZ2VuMTIrIGxpc3RzIG9ubHkgaGF2ZSB0aGUgcmVnaXN0ZXJzIHdlIHByb2dy
YW0gaW4gdGhlIGJhc2ljCisJICogZGVmYXVsdCBzdGF0ZS4gV2UgcmVseSBvbiB0aGUgY29udGV4
dCBpbWFnZSB1c2luZyByZWxhdGl2ZQorCSAqIGFkZHJlc3NpbmcgdG8gYXV0b21hdGljIGZpeHVw
IHRoZSByZWdpc3RlciBzdGF0ZSBiZXR3ZWVuIHRoZQorCSAqIHBoeXNpY2FsIGVuZ2luZXMgZm9y
IHZpcnR1YWwgZW5naW5lLgorCSAqLworCUdFTV9CVUdfT04oSU5URUxfR0VOKGVuZ2luZS0+aTkx
NSkgPj0gMTIgJiYKKwkJICAgIWludGVsX2VuZ2luZV9oYXNfcmVsYXRpdmVfbW1pbyhlbmdpbmUp
KTsKKworCWlmIChlbmdpbmUtPmNsYXNzID09IFJFTkRFUl9DTEFTUykgeworCQlpZiAoSU5URUxf
R0VOKGVuZ2luZS0+aTkxNSkgPj0gMTIpCisJCQlyZXR1cm4gZ2VuMTJfcmNzX29mZnNldHM7CisJ
CWVsc2UgaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDExKQorCQkJcmV0dXJuIGdlbjEx
X3Jjc19vZmZzZXRzOworCQllbHNlIGlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSA5KQor
CQkJcmV0dXJuIGdlbjlfcmNzX29mZnNldHM7CisJCWVsc2UKKwkJCXJldHVybiBnZW44X3Jjc19v
ZmZzZXRzOworCX0gZWxzZSB7CisJCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMikK
KwkJCXJldHVybiBnZW4xMl94Y3Nfb2Zmc2V0czsKKwkJZWxzZSBpZiAoSU5URUxfR0VOKGVuZ2lu
ZS0+aTkxNSkgPj0gOSkKKwkJCXJldHVybiBnZW45X3hjc19vZmZzZXRzOworCQllbHNlCisJCQly
ZXR1cm4gZ2VuOF94Y3Nfb2Zmc2V0czsKKwl9Cit9CisKK3N0YXRpYyBpbnQgbHJjX3JpbmdfbWlf
bW9kZShjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJaWYgKElOVEVM
X0dFTihlbmdpbmUtPmk5MTUpID49IDEyKQorCQlyZXR1cm4gMHg2MDsKKwllbHNlIGlmIChJTlRF
TF9HRU4oZW5naW5lLT5pOTE1KSA+PSA5KQorCQlyZXR1cm4gMHg1NDsKKwllbHNlIGlmIChlbmdp
bmUtPmNsYXNzID09IFJFTkRFUl9DTEFTUykKKwkJcmV0dXJuIDB4NTg7CisJZWxzZQorCQlyZXR1
cm4gLTE7Cit9CisKK3N0YXRpYyBpbnQgbHJjX3JpbmdfZ3ByMChjb25zdCBzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUpCit7CisJaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDEy
KQorCQlyZXR1cm4gMHg3NDsKKwllbHNlIGlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSA5
KQorCQlyZXR1cm4gMHg2ODsKKwllbHNlIGlmIChlbmdpbmUtPmNsYXNzID09IFJFTkRFUl9DTEFT
UykKKwkJcmV0dXJuIDB4ZDg7CisJZWxzZQorCQlyZXR1cm4gLTE7Cit9CisKK3N0YXRpYyBpbnQg
bHJjX3Jpbmdfd2FfYmJfcGVyX2N0eChjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpCit7CisJaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDEyKQorCQlyZXR1cm4gMHgx
MjsKKwllbHNlIGlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSA5IHx8IGVuZ2luZS0+Y2xh
c3MgPT0gUkVOREVSX0NMQVNTKQorCQlyZXR1cm4gMHgxODsKKwllbHNlCisJCXJldHVybiAtMTsK
K30KKworc3RhdGljIGludCBscmNfcmluZ19pbmRpcmVjdF9wdHIoY29uc3Qgc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lKQoreworCWludCB4OworCisJeCA9IGxyY19yaW5nX3dhX2JiX3Bl
cl9jdHgoZW5naW5lKTsKKwlpZiAoeCA8IDApCisJCXJldHVybiB4OworCisJcmV0dXJuIHggKyAy
OworfQorCitzdGF0aWMgaW50IGxyY19yaW5nX2luZGlyZWN0X29mZnNldChjb25zdCBzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJaW50IHg7CisKKwl4ID0gbHJjX3JpbmdfaW5k
aXJlY3RfcHRyKGVuZ2luZSk7CisJaWYgKHggPCAwKQorCQlyZXR1cm4geDsKKworCXJldHVybiB4
ICsgMjsKK30KKworc3RhdGljIGludCBscmNfcmluZ19jbWRfYnVmX2NjdGwoY29uc3Qgc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCWlmIChlbmdpbmUtPmNsYXNzICE9IFJFTkRF
Ul9DTEFTUykKKwkJcmV0dXJuIC0xOworCisJaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49
IDEyKQorCQlyZXR1cm4gMHhiNjsKKwllbHNlIGlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+
PSAxMSkKKwkJcmV0dXJuIDB4YWE7CisJZWxzZQorCQlyZXR1cm4gLTE7Cit9CisKK3N0YXRpYyB1
MzIKK2xyY19yaW5nX2luZGlyZWN0X29mZnNldF9kZWZhdWx0KGNvbnN0IHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlzd2l0Y2ggKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpKSB7
CisJZGVmYXVsdDoKKwkJTUlTU0lOR19DQVNFKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpKTsKKwkJ
ZmFsbHRocm91Z2g7CisJY2FzZSAxMjoKKwkJcmV0dXJuIEdFTjEyX0NUWF9SQ1NfSU5ESVJFQ1Rf
Q1RYX09GRlNFVF9ERUZBVUxUOworCWNhc2UgMTE6CisJCXJldHVybiBHRU4xMV9DVFhfUkNTX0lO
RElSRUNUX0NUWF9PRkZTRVRfREVGQVVMVDsKKwljYXNlIDEwOgorCQlyZXR1cm4gR0VOMTBfQ1RY
X1JDU19JTkRJUkVDVF9DVFhfT0ZGU0VUX0RFRkFVTFQ7CisJY2FzZSA5OgorCQlyZXR1cm4gR0VO
OV9DVFhfUkNTX0lORElSRUNUX0NUWF9PRkZTRVRfREVGQVVMVDsKKwljYXNlIDg6CisJCXJldHVy
biBHRU44X0NUWF9SQ1NfSU5ESVJFQ1RfQ1RYX09GRlNFVF9ERUZBVUxUOworCX0KK30KKworc3Rh
dGljIHZvaWQKK2xyY19zZXR1cF9pbmRpcmVjdF9jdHgodTMyICpyZWdzLAorCQkgICAgICAgY29u
c3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAorCQkgICAgICAgdTMyIGN0eF9iYl9n
Z3R0X2FkZHIsCisJCSAgICAgICB1MzIgc2l6ZSkKK3sKKwlHRU1fQlVHX09OKCFzaXplKTsKKwlH
RU1fQlVHX09OKCFJU19BTElHTkVEKHNpemUsIENBQ0hFTElORV9CWVRFUykpOworCUdFTV9CVUdf
T04obHJjX3JpbmdfaW5kaXJlY3RfcHRyKGVuZ2luZSkgPT0gLTEpOworCXJlZ3NbbHJjX3Jpbmdf
aW5kaXJlY3RfcHRyKGVuZ2luZSkgKyAxXSA9CisJCWN0eF9iYl9nZ3R0X2FkZHIgfCAoc2l6ZSAv
IENBQ0hFTElORV9CWVRFUyk7CisKKwlHRU1fQlVHX09OKGxyY19yaW5nX2luZGlyZWN0X29mZnNl
dChlbmdpbmUpID09IC0xKTsKKwlyZWdzW2xyY19yaW5nX2luZGlyZWN0X29mZnNldChlbmdpbmUp
ICsgMV0gPQorCQlscmNfcmluZ19pbmRpcmVjdF9vZmZzZXRfZGVmYXVsdChlbmdpbmUpIDw8IDY7
Cit9CisKK3N0YXRpYyB2b2lkIGluaXRfY29tbW9uX3JlZ3ModTMyICogY29uc3QgcmVncywKKwkJ
CSAgICAgY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAorCQkJICAgICBjb25z
dCBzdHJ1Y3QgaW50ZWxfcmluZyAqcmluZywKKwkJCSAgICAgYm9vbCBpbmhpYml0KQoreworCXUz
MiBjdGw7CisKKwljdGwgPSBfTUFTS0VEX0JJVF9FTkFCTEUoQ1RYX0NUUkxfSU5ISUJJVF9TWU5f
Q1RYX1NXSVRDSCk7CisJY3RsIHw9IF9NQVNLRURfQklUX0RJU0FCTEUoQ1RYX0NUUkxfRU5HSU5F
X0NUWF9SRVNUT1JFX0lOSElCSVQpOworCWlmIChpbmhpYml0KQorCQljdGwgfD0gQ1RYX0NUUkxf
RU5HSU5FX0NUWF9SRVNUT1JFX0lOSElCSVQ7CisJaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUp
IDwgMTEpCisJCWN0bCB8PSBfTUFTS0VEX0JJVF9ESVNBQkxFKENUWF9DVFJMX0VOR0lORV9DVFhf
U0FWRV9JTkhJQklUIHwKKwkJCQkJICAgQ1RYX0NUUkxfUlNfQ1RYX0VOQUJMRSk7CisJcmVnc1tD
VFhfQ09OVEVYVF9DT05UUk9MXSA9IGN0bDsKKworCXJlZ3NbQ1RYX1JJTkdfQ1RMXSA9IFJJTkdf
Q1RMX1NJWkUocmluZy0+c2l6ZSkgfCBSSU5HX1ZBTElEOworCXJlZ3NbQ1RYX1RJTUVTVEFNUF0g
PSAwOworfQorCitzdGF0aWMgdm9pZCBpbml0X3dhX2JiX3JlZ3ModTMyICogY29uc3QgcmVncywK
KwkJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJY29uc3Qg
c3RydWN0IGk5MTVfY3R4X3dvcmthcm91bmRzICogY29uc3Qgd2FfY3R4ID0gJmVuZ2luZS0+d2Ff
Y3R4OworCisJaWYgKHdhX2N0eC0+cGVyX2N0eC5zaXplKSB7CisJCWNvbnN0IHUzMiBnZ3R0X29m
ZnNldCA9IGk5MTVfZ2d0dF9vZmZzZXQod2FfY3R4LT52bWEpOworCisJCUdFTV9CVUdfT04obHJj
X3Jpbmdfd2FfYmJfcGVyX2N0eChlbmdpbmUpID09IC0xKTsKKwkJcmVnc1tscmNfcmluZ193YV9i
Yl9wZXJfY3R4KGVuZ2luZSkgKyAxXSA9CisJCQkoZ2d0dF9vZmZzZXQgKyB3YV9jdHgtPnBlcl9j
dHgub2Zmc2V0KSB8IDB4MDE7CisJfQorCisJaWYgKHdhX2N0eC0+aW5kaXJlY3RfY3R4LnNpemUp
IHsKKwkJbHJjX3NldHVwX2luZGlyZWN0X2N0eChyZWdzLCBlbmdpbmUsCisJCQkJICAgICAgIGk5
MTVfZ2d0dF9vZmZzZXQod2FfY3R4LT52bWEpICsKKwkJCQkgICAgICAgd2FfY3R4LT5pbmRpcmVj
dF9jdHgub2Zmc2V0LAorCQkJCSAgICAgICB3YV9jdHgtPmluZGlyZWN0X2N0eC5zaXplKTsKKwl9
Cit9CisKK3N0YXRpYyB2b2lkIGluaXRfcHBndHRfcmVncyh1MzIgKnJlZ3MsIGNvbnN0IHN0cnVj
dCBpOTE1X3BwZ3R0ICpwcGd0dCkKK3sKKwlpZiAoaTkxNV92bV9pc180bHZsKCZwcGd0dC0+dm0p
KSB7CisJCS8qIDY0YiBQUEdUVCAoNDhiaXQgY2Fub25pY2FsKQorCQkgKiBQRFAwX0RFU0NSSVBU
T1IgY29udGFpbnMgdGhlIGJhc2UgYWRkcmVzcyB0byBQTUw0IGFuZAorCQkgKiBvdGhlciBQRFAg
RGVzY3JpcHRvcnMgYXJlIGlnbm9yZWQuCisJCSAqLworCQlBU1NJR05fQ1RYX1BNTDQocHBndHQs
IHJlZ3MpOworCX0gZWxzZSB7CisJCUFTU0lHTl9DVFhfUERQKHBwZ3R0LCByZWdzLCAzKTsKKwkJ
QVNTSUdOX0NUWF9QRFAocHBndHQsIHJlZ3MsIDIpOworCQlBU1NJR05fQ1RYX1BEUChwcGd0dCwg
cmVncywgMSk7CisJCUFTU0lHTl9DVFhfUERQKHBwZ3R0LCByZWdzLCAwKTsKKwl9Cit9CisKK3N0
YXRpYyBzdHJ1Y3QgaTkxNV9wcGd0dCAqdm1fYWxpYXMoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFj
ZSAqdm0pCit7CisJaWYgKGk5MTVfaXNfZ2d0dCh2bSkpCisJCXJldHVybiBpOTE1X3ZtX3RvX2dn
dHQodm0pLT5hbGlhczsKKwllbHNlCisJCXJldHVybiBpOTE1X3ZtX3RvX3BwZ3R0KHZtKTsKK30K
Kworc3RhdGljIHZvaWQgX19yZXNldF9zdG9wX3JpbmcodTMyICpyZWdzLCBjb25zdCBzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJaW50IHg7CisKKwl4ID0gbHJjX3JpbmdfbWlf
bW9kZShlbmdpbmUpOworCWlmICh4ICE9IC0xKSB7CisJCXJlZ3NbeCArIDFdICY9IH5TVE9QX1JJ
Tkc7CisJCXJlZ3NbeCArIDFdIHw9IFNUT1BfUklORyA8PCAxNjsKKwl9Cit9CisKK3N0YXRpYyB2
b2lkIF9fbHJjX2luaXRfcmVncyh1MzIgKnJlZ3MsCisJCQkgICAgY29uc3Qgc3RydWN0IGludGVs
X2NvbnRleHQgKmNlLAorCQkJICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSwKKwkJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfcmluZyAqcmluZywKKwkJCSAgICBib29sIGlu
aGliaXQpCit7CisJLyoKKwkgKiBBIGNvbnRleHQgaXMgYWN0dWFsbHkgYSBiaWcgYmF0Y2ggYnVm
ZmVyIHdpdGggc2V2ZXJhbAorCSAqIE1JX0xPQURfUkVHSVNURVJfSU1NIGNvbW1hbmRzIGZvbGxv
d2VkIGJ5IChyZWcsIHZhbHVlKSBwYWlycy4gVGhlCisJICogdmFsdWVzIHdlIGFyZSBzZXR0aW5n
IGhlcmUgYXJlIG9ubHkgZm9yIHRoZSBmaXJzdCBjb250ZXh0IHJlc3RvcmU6CisJICogb24gYSBz
dWJzZXF1ZW50IHNhdmUsIHRoZSBHUFUgd2lsbCByZWNyZWF0ZSB0aGlzIGJhdGNoYnVmZmVyIHdp
dGggbmV3CisJICogdmFsdWVzIChpbmNsdWRpbmcgYWxsIHRoZSBtaXNzaW5nIE1JX0xPQURfUkVH
SVNURVJfSU1NIGNvbW1hbmRzIHRoYXQKKwkgKiB3ZSBhcmUgbm90IGluaXRpYWxpemluZyBoZXJl
KS4KKwkgKgorCSAqIE11c3Qga2VlcCBjb25zaXN0ZW50IHdpdGggdmlydHVhbF91cGRhdGVfcmVn
aXN0ZXJfb2Zmc2V0cygpLgorCSAqLworCXNldF9vZmZzZXRzKHJlZ3MsIHJlZ19vZmZzZXRzKGVu
Z2luZSksIGVuZ2luZSwgaW5oaWJpdCk7CisKKwlpbml0X2NvbW1vbl9yZWdzKHJlZ3MsIGVuZ2lu
ZSwgcmluZywgaW5oaWJpdCk7CisJaW5pdF9wcGd0dF9yZWdzKHJlZ3MsIHZtX2FsaWFzKGNlLT52
bSkpOworCisJaW5pdF93YV9iYl9yZWdzKHJlZ3MsIGVuZ2luZSk7CisKKwlfX3Jlc2V0X3N0b3Bf
cmluZyhyZWdzLCBlbmdpbmUpOworfQorCit2b2lkIGxyY19pbml0X3JlZ3MoY29uc3Qgc3RydWN0
IGludGVsX2NvbnRleHQgKmNlLAorCQkgICBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUsCisJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9yaW5nICpyaW5nLAorCQkgICBib29sIGlu
aGliaXQpCit7CisJX19scmNfaW5pdF9yZWdzKGNlLT5scmNfcmVnX3N0YXRlLCBjZSwgZW5naW5l
LCByaW5nLCBpbmhpYml0KTsKK30KKwordm9pZCBscmNfcmVzZXRfcmVncyhjb25zdCBzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqY2UsCisJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUpCit7CisJX19yZXNldF9zdG9wX3JpbmcoY2UtPmxyY19yZWdfc3RhdGUsIGVuZ2luZSk7
Cit9CisKK3ZvaWQgbHJjX3Jlc3RvcmVfZGVmYXVsdHMoc3RydWN0IGludGVsX2NvbnRleHQgKmNl
LAorCQkJICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJdTMyICpyZWdzOwor
CisJcmVncyA9IG1lbXNldChjZS0+bHJjX3JlZ19zdGF0ZSwgMCwgZW5naW5lLT5jb250ZXh0X3Np
emUgLSBQQUdFX1NJWkUpOworCV9fbHJjX2luaXRfcmVncyhyZWdzLCBjZSwgZW5naW5lLCBjZS0+
cmluZywgdHJ1ZSk7CisKKwljZS0+cnVudGltZS5sYXN0ID0gbHJjX2dldF9ydW50aW1lKGNlKTsK
K30KKworc3RhdGljIHZvaWQKK3NldF9yZWR6b25lKHZvaWQgKnZhZGRyLCBjb25zdCBzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJaWYgKCFJU19FTkFCTEVEKENPTkZJR19EUk1f
STkxNV9ERUJVR19HRU0pKQorCQlyZXR1cm47CisKKwl2YWRkciArPSBlbmdpbmUtPmNvbnRleHRf
c2l6ZTsKKworCW1lbXNldCh2YWRkciwgQ09OVEVYVF9SRURaT05FLCBJOTE1X0dUVF9QQUdFX1NJ
WkUpOworfQorCitzdGF0aWMgdm9pZAorY2hlY2tfcmVkem9uZShjb25zdCB2b2lkICp2YWRkciwg
Y29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCWlmICghSVNfRU5BQkxF
RChDT05GSUdfRFJNX0k5MTVfREVCVUdfR0VNKSkKKwkJcmV0dXJuOworCisJdmFkZHIgKz0gZW5n
aW5lLT5jb250ZXh0X3NpemU7CisKKwlpZiAobWVtY2hyX2ludih2YWRkciwgQ09OVEVYVF9SRURa
T05FLCBJOTE1X0dUVF9QQUdFX1NJWkUpKQorCQlkcm1fZXJyX29uY2UoJmVuZ2luZS0+aTkxNS0+
ZHJtLAorCQkJICAgICAiJXMgY29udGV4dCByZWR6b25lIG92ZXJ3cml0dGVuIVxuIiwKKwkJCSAg
ICAgZW5naW5lLT5uYW1lKTsKK30KKwordm9pZCBscmNfY2hlY2tfcmVkem9uZShzdHJ1Y3QgaW50
ZWxfY29udGV4dCAqY2UpCit7CisJY2hlY2tfcmVkem9uZSgodm9pZCAqKWNlLT5scmNfcmVnX3N0
YXRlIC0gTFJDX1NUQVRFX09GRlNFVCwgY2UtPmVuZ2luZSk7Cit9CisKK3N0YXRpYyBpbnQgX19s
cmNfc2V0dXAoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAorCQkgICAgICAgc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3QgKm9iaiwKKwkJICAgICAgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSwKKwkJICAgICAgIHN0cnVjdCBpbnRlbF9yaW5nICpyaW5nKQoreworCWJvb2wgaW5oaWJp
dCA9IHRydWU7CisJdm9pZCAqdmFkZHI7CisKKwl2YWRkciA9IGk5MTVfZ2VtX29iamVjdF9waW5f
bWFwKG9iaiwgSTkxNV9NQVBfV0IpOworCWlmIChJU19FUlIodmFkZHIpKSB7CisJCWRybV9kYmco
JmVuZ2luZS0+aTkxNS0+ZHJtLCAiQ291bGQgbm90IG1hcCBvYmplY3QgcGFnZXMhXG4iKTsKKwkJ
cmV0dXJuIFBUUl9FUlIodmFkZHIpOworCX0KKworCXNldF9yZWR6b25lKHZhZGRyLCBlbmdpbmUp
OworCisJaWYgKGVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSkgeworCQlzaG1lbV9yZWFkKGVuZ2luZS0+
ZGVmYXVsdF9zdGF0ZSwgMCwKKwkJCSAgIHZhZGRyLCBlbmdpbmUtPmNvbnRleHRfc2l6ZSk7CisJ
CV9fc2V0X2JpdChDT05URVhUX1ZBTElEX0JJVCwgJmNlLT5mbGFncyk7CisJCWluaGliaXQgPSBm
YWxzZTsKKwl9CisKKwkvKiBDbGVhciB0aGUgcHBIV1NQIChpbmMuIHBlci1jb250ZXh0IGNvdW50
ZXJzKSAqLworCW1lbXNldCh2YWRkciwgMCwgUEFHRV9TSVpFKTsKKworCS8qCisJICogVGhlIHNl
Y29uZCBwYWdlIG9mIHRoZSBjb250ZXh0IG9iamVjdCBjb250YWlucyBzb21lIHJlZ2lzdGVycyB3
aGljaAorCSAqIG11c3QgYmUgc2V0IHVwIHByaW9yIHRvIHRoZSBmaXJzdCBleGVjdXRpb24uCisJ
ICovCisJX19scmNfaW5pdF9yZWdzKHZhZGRyICsgTFJDX1NUQVRFX09GRlNFVCwgY2UsIGVuZ2lu
ZSwgcmluZywgaW5oaWJpdCk7CisKKwlfX2k5MTVfZ2VtX29iamVjdF9mbHVzaF9tYXAob2JqLCAw
LCBlbmdpbmUtPmNvbnRleHRfc2l6ZSk7CisJaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChvYmop
OworCXJldHVybiAwOworfQorCitzdGF0aWMgc3RydWN0IGk5MTVfdm1hICoKK19fbHJjX2FsbG9j
X3N0YXRlKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lKQoreworCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CisJc3RydWN0IGk5
MTVfdm1hICp2bWE7CisJdTMyIGNvbnRleHRfc2l6ZTsKKworCWNvbnRleHRfc2l6ZSA9IHJvdW5k
X3VwKGVuZ2luZS0+Y29udGV4dF9zaXplLCBJOTE1X0dUVF9QQUdFX1NJWkUpOworCisJaWYgKElT
X0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X0RFQlVHX0dFTSkpCisJCWNvbnRleHRfc2l6ZSArPSBJ
OTE1X0dUVF9QQUdFX1NJWkU7IC8qIGZvciByZWR6b25lICovCisKKwlpZiAoSU5URUxfR0VOKGVu
Z2luZS0+aTkxNSkgPT0gMTIpIHsKKwkJY2UtPndhX2JiX3BhZ2UgPSBjb250ZXh0X3NpemUgLyBQ
QUdFX1NJWkU7CisJCWNvbnRleHRfc2l6ZSArPSBQQUdFX1NJWkU7CisJfQorCisJb2JqID0gaTkx
NV9nZW1fb2JqZWN0X2NyZWF0ZV9zaG1lbShlbmdpbmUtPmk5MTUsIGNvbnRleHRfc2l6ZSk7CisJ
aWYgKElTX0VSUihvYmopKQorCQlyZXR1cm4gRVJSX0NBU1Qob2JqKTsKKworCXZtYSA9IGk5MTVf
dm1hX2luc3RhbmNlKG9iaiwgJmVuZ2luZS0+Z3QtPmdndHQtPnZtLCBOVUxMKTsKKwlpZiAoSVNf
RVJSKHZtYSkpIHsKKwkJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOworCQlyZXR1cm4gdm1hOwor
CX0KKworCXJldHVybiB2bWE7Cit9CisKK2ludCBscmNfYWxsb2Moc3RydWN0IGludGVsX2NvbnRl
eHQgKmNlLCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJc3RydWN0IGludGVs
X3JpbmcgKnJpbmc7CisJc3RydWN0IGk5MTVfdm1hICp2bWE7CisJaW50IGVycjsKKworCUdFTV9C
VUdfT04oY2UtPnN0YXRlKTsKKworCXZtYSA9IF9fbHJjX2FsbG9jX3N0YXRlKGNlLCBlbmdpbmUp
OworCWlmIChJU19FUlIodm1hKSkKKwkJcmV0dXJuIFBUUl9FUlIodm1hKTsKKworCXJpbmcgPSBp
bnRlbF9lbmdpbmVfY3JlYXRlX3JpbmcoZW5naW5lLCAodW5zaWduZWQgbG9uZyljZS0+cmluZyk7
CisJaWYgKElTX0VSUihyaW5nKSkgeworCQllcnIgPSBQVFJfRVJSKHJpbmcpOworCQlnb3RvIGVy
cl92bWE7CisJfQorCisJZXJyID0gX19scmNfc2V0dXAoY2UsIHZtYS0+b2JqLCBlbmdpbmUsIHJp
bmcpOworCWlmIChlcnIpCisJCWdvdG8gZXJyX3Jpbmc7CisKKwljZS0+cmluZyA9IHJpbmc7CisJ
Y2UtPnN0YXRlID0gdm1hOworCXJldHVybiAwOworCitlcnJfcmluZzoKKwlpbnRlbF9yaW5nX3B1
dChyaW5nKTsKK2Vycl92bWE6CisJaTkxNV92bWFfcHV0KHZtYSk7CisJcmV0dXJuIGVycjsKK30K
Kworc3RhdGljIHUzMiAqCitnZW4xMl9lbWl0X3RpbWVzdGFtcF93YShjb25zdCBzdHJ1Y3QgaW50
ZWxfY29udGV4dCAqY2UsIHUzMiAqY3MpCit7CisJKmNzKysgPSBNSV9MT0FEX1JFR0lTVEVSX01F
TV9HRU44IHwKKwkJTUlfU1JNX0xSTV9HTE9CQUxfR1RUIHwKKwkJTUlfTFJJX0xSTV9DU19NTUlP
OworCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9SSU5HX0NTX0dQUigwLCAwKSk7
CisJKmNzKysgPSBpOTE1X2dndHRfb2Zmc2V0KGNlLT5zdGF0ZSkgKyBMUkNfU1RBVEVfT0ZGU0VU
ICsKKwkJQ1RYX1RJTUVTVEFNUCAqIHNpemVvZih1MzIpOworCSpjcysrID0gMDsKKworCSpjcysr
ID0gTUlfTE9BRF9SRUdJU1RFUl9SRUcgfAorCQlNSV9MUlJfU09VUkNFX0NTX01NSU8gfAorCQlN
SV9MUklfTFJNX0NTX01NSU87CisJKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X1JJ
TkdfQ1NfR1BSKDAsIDApKTsKKwkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfQ1RY
X1RJTUVTVEFNUCgwKSk7CisKKwkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJfUkVHIHwKKwkJTUlf
TFJSX1NPVVJDRV9DU19NTUlPIHwKKwkJTUlfTFJJX0xSTV9DU19NTUlPOworCSpjcysrID0gaTkx
NV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9SSU5HX0NTX0dQUigwLCAwKSk7CisJKmNzKysgPSBpOTE1
X21taW9fcmVnX29mZnNldChSSU5HX0NUWF9USU1FU1RBTVAoMCkpOworCisJcmV0dXJuIGNzOwor
fQorCitzdGF0aWMgdTMyICoKK2dlbjEyX2VtaXRfcmVzdG9yZV9zY3JhdGNoKGNvbnN0IHN0cnVj
dCBpbnRlbF9jb250ZXh0ICpjZSwgdTMyICpjcykKK3sKKwlHRU1fQlVHX09OKGxyY19yaW5nX2dw
cjAoY2UtPmVuZ2luZSkgPT0gLTEpOworCisJKmNzKysgPSBNSV9MT0FEX1JFR0lTVEVSX01FTV9H
RU44IHwKKwkJTUlfU1JNX0xSTV9HTE9CQUxfR1RUIHwKKwkJTUlfTFJJX0xSTV9DU19NTUlPOwor
CSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9SSU5HX0NTX0dQUigwLCAwKSk7CisJ
KmNzKysgPSBpOTE1X2dndHRfb2Zmc2V0KGNlLT5zdGF0ZSkgKyBMUkNfU1RBVEVfT0ZGU0VUICsK
KwkJKGxyY19yaW5nX2dwcjAoY2UtPmVuZ2luZSkgKyAxKSAqIHNpemVvZih1MzIpOworCSpjcysr
ID0gMDsKKworCXJldHVybiBjczsKK30KKworc3RhdGljIHUzMiAqCitnZW4xMl9lbWl0X2NtZF9i
dWZfd2EoY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCB1MzIgKmNzKQoreworCUdFTV9C
VUdfT04obHJjX3JpbmdfY21kX2J1Zl9jY3RsKGNlLT5lbmdpbmUpID09IC0xKTsKKworCSpjcysr
ID0gTUlfTE9BRF9SRUdJU1RFUl9NRU1fR0VOOCB8CisJCU1JX1NSTV9MUk1fR0xPQkFMX0dUVCB8
CisJCU1JX0xSSV9MUk1fQ1NfTU1JTzsKKwkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEdF
TjhfUklOR19DU19HUFIoMCwgMCkpOworCSpjcysrID0gaTkxNV9nZ3R0X29mZnNldChjZS0+c3Rh
dGUpICsgTFJDX1NUQVRFX09GRlNFVCArCisJCShscmNfcmluZ19jbWRfYnVmX2NjdGwoY2UtPmVu
Z2luZSkgKyAxKSAqIHNpemVvZih1MzIpOworCSpjcysrID0gMDsKKworCSpjcysrID0gTUlfTE9B
RF9SRUdJU1RFUl9SRUcgfAorCQlNSV9MUlJfU09VUkNFX0NTX01NSU8gfAorCQlNSV9MUklfTFJN
X0NTX01NSU87CisJKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X1JJTkdfQ1NfR1BS
KDAsIDApKTsKKwkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfQ01EX0JVRl9DQ1RM
KDApKTsKKworCXJldHVybiBjczsKK30KKworc3RhdGljIHUzMiAqCitnZW4xMl9lbWl0X2luZGly
ZWN0X2N0eF9yY3MoY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCB1MzIgKmNzKQorewor
CWNzID0gZ2VuMTJfZW1pdF90aW1lc3RhbXBfd2EoY2UsIGNzKTsKKwljcyA9IGdlbjEyX2VtaXRf
Y21kX2J1Zl93YShjZSwgY3MpOworCWNzID0gZ2VuMTJfZW1pdF9yZXN0b3JlX3NjcmF0Y2goY2Us
IGNzKTsKKworCXJldHVybiBjczsKK30KKworc3RhdGljIHUzMiAqCitnZW4xMl9lbWl0X2luZGly
ZWN0X2N0eF94Y3MoY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCB1MzIgKmNzKQorewor
CWNzID0gZ2VuMTJfZW1pdF90aW1lc3RhbXBfd2EoY2UsIGNzKTsKKwljcyA9IGdlbjEyX2VtaXRf
cmVzdG9yZV9zY3JhdGNoKGNlLCBjcyk7CisKKwlyZXR1cm4gY3M7Cit9CisKK3N0YXRpYyBpbmxp
bmUgdTMyIGNvbnRleHRfd2FfYmJfb2Zmc2V0KGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpj
ZSkKK3sKKwlyZXR1cm4gUEFHRV9TSVpFICogY2UtPndhX2JiX3BhZ2U7Cit9CisKK3N0YXRpYyB1
MzIgKmNvbnRleHRfaW5kaXJlY3RfYmIoY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQor
eworCXZvaWQgKnB0cjsKKworCUdFTV9CVUdfT04oIWNlLT53YV9iYl9wYWdlKTsKKworCXB0ciA9
IGNlLT5scmNfcmVnX3N0YXRlOworCXB0ciAtPSBMUkNfU1RBVEVfT0ZGU0VUOyAvKiBiYWNrIHRv
IHN0YXJ0IG9mIGNvbnRleHQgaW1hZ2UgKi8KKwlwdHIgKz0gY29udGV4dF93YV9iYl9vZmZzZXQo
Y2UpOworCisJcmV0dXJuIHB0cjsKK30KKworc3RhdGljIHZvaWQKK3NldHVwX2luZGlyZWN0X2N0
eF9iYihjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCisJCSAgICAgIGNvbnN0IHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKKwkJICAgICAgdTMyICooKmVtaXQpKGNvbnN0IHN0
cnVjdCBpbnRlbF9jb250ZXh0ICosIHUzMiAqKSkKK3sKKwl1MzIgKiBjb25zdCBzdGFydCA9IGNv
bnRleHRfaW5kaXJlY3RfYmIoY2UpOworCXUzMiAqY3M7CisKKwljcyA9IGVtaXQoY2UsIHN0YXJ0
KTsKKwlHRU1fQlVHX09OKGNzIC0gc3RhcnQgPiBJOTE1X0dUVF9QQUdFX1NJWkUgLyBzaXplb2Yo
KmNzKSk7CisJd2hpbGUgKCh1bnNpZ25lZCBsb25nKWNzICUgQ0FDSEVMSU5FX0JZVEVTKQorCQkq
Y3MrKyA9IE1JX05PT1A7CisKKwlscmNfc2V0dXBfaW5kaXJlY3RfY3R4KGNlLT5scmNfcmVnX3N0
YXRlLCBlbmdpbmUsCisJCQkgICAgICAgaTkxNV9nZ3R0X29mZnNldChjZS0+c3RhdGUpICsKKwkJ
CSAgICAgICBjb250ZXh0X3dhX2JiX29mZnNldChjZSksCisJCQkgICAgICAgKGNzIC0gc3RhcnQp
ICogc2l6ZW9mKCpjcykpOworfQorCisvKgorICogVGhlIGNvbnRleHQgZGVzY3JpcHRvciBlbmNv
ZGVzIHZhcmlvdXMgYXR0cmlidXRlcyBvZiBhIGNvbnRleHQsCisgKiBpbmNsdWRpbmcgaXRzIEdU
VCBhZGRyZXNzIGFuZCBzb21lIGZsYWdzLiBCZWNhdXNlIGl0J3MgZmFpcmx5CisgKiBleHBlbnNp
dmUgdG8gY2FsY3VsYXRlLCB3ZSdsbCBqdXN0IGRvIGl0IG9uY2UgYW5kIGNhY2hlIHRoZSByZXN1
bHQsCisgKiB3aGljaCByZW1haW5zIHZhbGlkIHVudGlsIHRoZSBjb250ZXh0IGlzIHVucGlubmVk
LgorICoKKyAqIFRoaXMgaXMgd2hhdCBhIGRlc2NyaXB0b3IgbG9va3MgbGlrZSwgZnJvbSBMU0Ig
dG8gTVNCOjoKKyAqCisgKiAgICAgIGJpdHMgIDAtMTE6ICAgIGZsYWdzLCBHRU44X0NUWF8qIChj
YWNoZWQgaW4gY3R4LT5kZXNjX3RlbXBsYXRlKQorICogICAgICBiaXRzIDEyLTMxOiAgICBMUkNB
LCBHVFQgYWRkcmVzcyBvZiAodGhlIEhXU1Agb2YpIHRoaXMgY29udGV4dAorICogICAgICBiaXRz
IDMyLTUyOiAgICBjdHggSUQsIGEgZ2xvYmFsbHkgdW5pcXVlIHRhZyAoaGlnaGVzdCBiaXQgdXNl
ZCBieSBHdUMpCisgKiAgICAgIGJpdHMgNTMtNTQ6ICAgIG1ieiwgcmVzZXJ2ZWQgZm9yIHVzZSBi
eSBoYXJkd2FyZQorICogICAgICBiaXRzIDU1LTYzOiAgICBncm91cCBJRCwgY3VycmVudGx5IHVu
dXNlZCBhbmQgc2V0IHRvIDAKKyAqCisgKiBTdGFydGluZyBmcm9tIEdlbjExLCB0aGUgdXBwZXIg
ZHdvcmQgb2YgdGhlIGRlc2NyaXB0b3IgaGFzIGEgbmV3IGZvcm1hdDoKKyAqCisgKiAgICAgIGJp
dHMgMzItMzY6ICAgIHJlc2VydmVkCisgKiAgICAgIGJpdHMgMzctNDc6ICAgIFNXIGNvbnRleHQg
SUQKKyAqICAgICAgYml0cyA0ODo1MzogICAgZW5naW5lIGluc3RhbmNlCisgKiAgICAgIGJpdCA1
NDogICAgICAgIG1ieiwgcmVzZXJ2ZWQgZm9yIHVzZSBieSBoYXJkd2FyZQorICogICAgICBiaXRz
IDU1LTYwOiAgICBTVyBjb3VudGVyCisgKiAgICAgIGJpdHMgNjEtNjM6ICAgIGVuZ2luZSBjbGFz
cworICoKKyAqIGVuZ2luZSBpbmZvLCBTVyBjb250ZXh0IElEIGFuZCBTVyBjb3VudGVyIG5lZWQg
dG8gZm9ybSBhIHVuaXF1ZSBudW1iZXIKKyAqIChDb250ZXh0IElEKSBwZXIgbHJjLgorICovCitz
dGF0aWMgaW5saW5lIHUzMiBscmNfZGVzY3JpcHRvcihjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4
dCAqY2UpCit7CisJdTMyIGRlc2M7CisKKwlkZXNjID0gSU5URUxfTEVHQUNZXzMyQl9DT05URVhU
OworCWlmIChpOTE1X3ZtX2lzXzRsdmwoY2UtPnZtKSkKKwkJZGVzYyA9IElOVEVMX0xFR0FDWV82
NEJfQ09OVEVYVDsKKwlkZXNjIDw8PSBHRU44X0NUWF9BRERSRVNTSU5HX01PREVfU0hJRlQ7CisK
KwlkZXNjIHw9IEdFTjhfQ1RYX1ZBTElEIHwgR0VOOF9DVFhfUFJJVklMRUdFOworCWlmIChJU19H
RU4oY2UtPnZtLT5pOTE1LCA4KSkKKwkJZGVzYyB8PSBHRU44X0NUWF9MM0xMQ19DT0hFUkVOVDsK
KworCXJldHVybiBpOTE1X2dndHRfb2Zmc2V0KGNlLT5zdGF0ZSkgfCBkZXNjOworfQorCit1MzIg
bHJjX3VwZGF0ZV9yZWdzKGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJICAgIGNv
bnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKKwkJICAgIHUzMiBoZWFkKQorewor
CXN0cnVjdCBpbnRlbF9yaW5nICpyaW5nID0gY2UtPnJpbmc7CisJdTMyICpyZWdzID0gY2UtPmxy
Y19yZWdfc3RhdGU7CisKKwlHRU1fQlVHX09OKCFpbnRlbF9yaW5nX29mZnNldF92YWxpZChyaW5n
LCBoZWFkKSk7CisJR0VNX0JVR19PTighaW50ZWxfcmluZ19vZmZzZXRfdmFsaWQocmluZywgcmlu
Zy0+dGFpbCkpOworCisJcmVnc1tDVFhfUklOR19TVEFSVF0gPSBpOTE1X2dndHRfb2Zmc2V0KHJp
bmctPnZtYSk7CisJcmVnc1tDVFhfUklOR19IRUFEXSA9IGhlYWQ7CisJcmVnc1tDVFhfUklOR19U
QUlMXSA9IHJpbmctPnRhaWw7CisJcmVnc1tDVFhfUklOR19DVExdID0gUklOR19DVExfU0laRShy
aW5nLT5zaXplKSB8IFJJTkdfVkFMSUQ7CisKKwkvKiBSUENTICovCisJaWYgKGVuZ2luZS0+Y2xh
c3MgPT0gUkVOREVSX0NMQVNTKSB7CisJCXJlZ3NbQ1RYX1JfUFdSX0NMS19TVEFURV0gPQorCQkJ
aW50ZWxfc3NldV9tYWtlX3JwY3MoZW5naW5lLT5ndCwgJmNlLT5zc2V1KTsKKworCQlpOTE1X29h
X2luaXRfcmVnX3N0YXRlKGNlLCBlbmdpbmUpOworCX0KKworCWlmIChjZS0+d2FfYmJfcGFnZSkg
eworCQl1MzIgKigqZm4pKGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgdTMyICpjcyk7
CisKKwkJZm4gPSBnZW4xMl9lbWl0X2luZGlyZWN0X2N0eF94Y3M7CisJCWlmIChjZS0+ZW5naW5l
LT5jbGFzcyA9PSBSRU5ERVJfQ0xBU1MpCisJCQlmbiA9IGdlbjEyX2VtaXRfaW5kaXJlY3RfY3R4
X3JjczsKKworCQkvKiBNdXR1YWxseSBleGNsdXNpdmUgd3J0IHRvIGdsb2JhbCBpbmRpcmVjdCBi
YiAqLworCQlHRU1fQlVHX09OKGVuZ2luZS0+d2FfY3R4LmluZGlyZWN0X2N0eC5zaXplKTsKKwkJ
c2V0dXBfaW5kaXJlY3RfY3R4X2JiKGNlLCBlbmdpbmUsIGZuKTsKKwl9CisKKwlyZXR1cm4gbHJj
X2Rlc2NyaXB0b3IoY2UpIHwgQ1RYX0RFU0NfRk9SQ0VfUkVTVE9SRTsKK30KKwordm9pZCBscmNf
dXBkYXRlX29mZnNldHMoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAorCQkJc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lKQoreworCXNldF9vZmZzZXRzKGNlLT5scmNfcmVnX3N0YXRlLCBy
ZWdfb2Zmc2V0cyhlbmdpbmUpLCBlbmdpbmUsIGZhbHNlKTsKK30KKwordm9pZCBscmNfY2hlY2tf
cmVncyhjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCisJCSAgICBjb25zdCBzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUsCisJCSAgICBjb25zdCBjaGFyICp3aGVuKQoreworCWNv
bnN0IHN0cnVjdCBpbnRlbF9yaW5nICpyaW5nID0gY2UtPnJpbmc7CisJdTMyICpyZWdzID0gY2Ut
PmxyY19yZWdfc3RhdGU7CisJYm9vbCB2YWxpZCA9IHRydWU7CisJaW50IHg7CisKKwlpZiAocmVn
c1tDVFhfUklOR19TVEFSVF0gIT0gaTkxNV9nZ3R0X29mZnNldChyaW5nLT52bWEpKSB7CisJCXBy
X2VycigiJXM6IGNvbnRleHQgc3VibWl0dGVkIHdpdGggaW5jb3JyZWN0IFJJTkdfU1RBUlQgWyUw
OHhdLCBleHBlY3RlZCAlMDh4XG4iLAorCQkgICAgICAgZW5naW5lLT5uYW1lLAorCQkgICAgICAg
cmVnc1tDVFhfUklOR19TVEFSVF0sCisJCSAgICAgICBpOTE1X2dndHRfb2Zmc2V0KHJpbmctPnZt
YSkpOworCQlyZWdzW0NUWF9SSU5HX1NUQVJUXSA9IGk5MTVfZ2d0dF9vZmZzZXQocmluZy0+dm1h
KTsKKwkJdmFsaWQgPSBmYWxzZTsKKwl9CisKKwlpZiAoKHJlZ3NbQ1RYX1JJTkdfQ1RMXSAmIH4o
UklOR19XQUlUIHwgUklOR19XQUlUX1NFTUFQSE9SRSkpICE9CisJICAgIChSSU5HX0NUTF9TSVpF
KHJpbmctPnNpemUpIHwgUklOR19WQUxJRCkpIHsKKwkJcHJfZXJyKCIlczogY29udGV4dCBzdWJt
aXR0ZWQgd2l0aCBpbmNvcnJlY3QgUklOR19DVEwgWyUwOHhdLCBleHBlY3RlZCAlMDh4XG4iLAor
CQkgICAgICAgZW5naW5lLT5uYW1lLAorCQkgICAgICAgcmVnc1tDVFhfUklOR19DVExdLAorCQkg
ICAgICAgKHUzMikoUklOR19DVExfU0laRShyaW5nLT5zaXplKSB8IFJJTkdfVkFMSUQpKTsKKwkJ
cmVnc1tDVFhfUklOR19DVExdID0gUklOR19DVExfU0laRShyaW5nLT5zaXplKSB8IFJJTkdfVkFM
SUQ7CisJCXZhbGlkID0gZmFsc2U7CisJfQorCisJeCA9IGxyY19yaW5nX21pX21vZGUoZW5naW5l
KTsKKwlpZiAoeCAhPSAtMSAmJiByZWdzW3ggKyAxXSAmIChyZWdzW3ggKyAxXSA+PiAxNikgJiBT
VE9QX1JJTkcpIHsKKwkJcHJfZXJyKCIlczogY29udGV4dCBzdWJtaXR0ZWQgd2l0aCBTVE9QX1JJ
TkcgWyUwOHhdIGluIFJJTkdfTUlfTU9ERVxuIiwKKwkJICAgICAgIGVuZ2luZS0+bmFtZSwgcmVn
c1t4ICsgMV0pOworCQlyZWdzW3ggKyAxXSAmPSB+U1RPUF9SSU5HOworCQlyZWdzW3ggKyAxXSB8
PSBTVE9QX1JJTkcgPDwgMTY7CisJCXZhbGlkID0gZmFsc2U7CisJfQorCisJV0FSTl9PTkNFKCF2
YWxpZCwgIkludmFsaWQgbHJjIHN0YXRlIGZvdW5kICVzIHN1Ym1pc3Npb25cbiIsIHdoZW4pOwor
fQorCisvKgorICogSW4gdGhpcyBXQSB3ZSBuZWVkIHRvIHNldCBHRU44X0wzU1FDUkVHNFsyMToy
MV0gYW5kIHJlc2V0IGl0IGFmdGVyCisgKiBQSVBFX0NPTlRST0wgaW5zdHJ1Y3Rpb24uIFRoaXMg
aXMgcmVxdWlyZWQgZm9yIHRoZSBmbHVzaCB0byBoYXBwZW4gY29ycmVjdGx5CisgKiBidXQgdGhl
cmUgaXMgYSBzbGlnaHQgY29tcGxpY2F0aW9uIGFzIHRoaXMgaXMgYXBwbGllZCBpbiBXQSBiYXRj
aCB3aGVyZSB0aGUKKyAqIHZhbHVlcyBhcmUgb25seSBpbml0aWFsaXplZCBvbmNlIHNvIHdlIGNh
bm5vdCB0YWtlIHJlZ2lzdGVyIHZhbHVlIGF0IHRoZQorICogYmVnaW5uaW5nIGFuZCByZXVzZSBp
dCBmdXJ0aGVyOyBoZW5jZSB3ZSBzYXZlIGl0cyB2YWx1ZSB0byBtZW1vcnksIHVwbG9hZCBhCisg
KiBjb25zdGFudCB2YWx1ZSB3aXRoIGJpdDIxIHNldCBhbmQgdGhlbiB3ZSByZXN0b3JlIGl0IGJh
Y2sgd2l0aCB0aGUgc2F2ZWQgdmFsdWUuCisgKiBUbyBzaW1wbGlmeSB0aGUgV0EsIGEgY29uc3Rh
bnQgdmFsdWUgaXMgZm9ybWVkIGJ5IHVzaW5nIHRoZSBkZWZhdWx0IHZhbHVlCisgKiBvZiB0aGlz
IHJlZ2lzdGVyLiBUaGlzIHNob3VsZG4ndCBiZSBhIHByb2JsZW0gYmVjYXVzZSB3ZSBhcmUgb25s
eSBtb2RpZnlpbmcKKyAqIGl0IGZvciBhIHNob3J0IHBlcmlvZCBhbmQgdGhpcyBiYXRjaCBpbiBu
b24tcHJlbXB0aWJsZS4gV2UgY2FuIG9mY291cnNlCisgKiB1c2UgYWRkaXRpb25hbCBpbnN0cnVj
dGlvbnMgdGhhdCByZWFkIHRoZSBhY3R1YWwgdmFsdWUgb2YgdGhlIHJlZ2lzdGVyCisgKiBhdCB0
aGF0IHRpbWUgYW5kIHNldCBvdXIgYml0IG9mIGludGVyZXN0IGJ1dCBpdCBtYWtlcyB0aGUgV0Eg
Y29tcGxpY2F0ZWQuCisgKgorICogVGhpcyBXQSBpcyBhbHNvIHJlcXVpcmVkIGZvciBHZW45IHNv
IGV4dHJhY3RpbmcgYXMgYSBmdW5jdGlvbiBhdm9pZHMKKyAqIGNvZGUgZHVwbGljYXRpb24uCisg
Ki8KK3N0YXRpYyB1MzIgKgorZ2VuOF9lbWl0X2ZsdXNoX2NvaGVyZW50bDNfd2Eoc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1MzIgKmJhdGNoKQoreworCS8qIE5CIG5vIG9uZSBlbHNl
IGlzIGFsbG93ZWQgdG8gc2NyaWJibGUgb3ZlciBzY3JhdGNoICsgMjU2ISAqLworCSpiYXRjaCsr
ID0gTUlfU1RPUkVfUkVHSVNURVJfTUVNX0dFTjggfCBNSV9TUk1fTFJNX0dMT0JBTF9HVFQ7CisJ
KmJhdGNoKysgPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X0wzU1FDUkVHNCk7CisJKmJhdGNo
KysgPSBpbnRlbF9ndF9zY3JhdGNoX29mZnNldChlbmdpbmUtPmd0LAorCQkJCQkgICBJTlRFTF9H
VF9TQ1JBVENIX0ZJRUxEX0NPSEVSRU5UTDNfV0EpOworCSpiYXRjaCsrID0gMDsKKworCSpiYXRj
aCsrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oMSk7CisJKmJhdGNoKysgPSBpOTE1X21taW9fcmVn
X29mZnNldChHRU44X0wzU1FDUkVHNCk7CisJKmJhdGNoKysgPSAweDQwNDAwMDAwIHwgR0VOOF9M
UVNDX0ZMVVNIX0NPSEVSRU5UX0xJTkVTOworCisJYmF0Y2ggPSBnZW44X2VtaXRfcGlwZV9jb250
cm9sKGJhdGNoLAorCQkJCSAgICAgICBQSVBFX0NPTlRST0xfQ1NfU1RBTEwgfAorCQkJCSAgICAg
ICBQSVBFX0NPTlRST0xfRENfRkxVU0hfRU5BQkxFLAorCQkJCSAgICAgICAwKTsKKworCSpiYXRj
aCsrID0gTUlfTE9BRF9SRUdJU1RFUl9NRU1fR0VOOCB8IE1JX1NSTV9MUk1fR0xPQkFMX0dUVDsK
KwkqYmF0Y2grKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEdFTjhfTDNTUUNSRUc0KTsKKwkqYmF0
Y2grKyA9IGludGVsX2d0X3NjcmF0Y2hfb2Zmc2V0KGVuZ2luZS0+Z3QsCisJCQkJCSAgIElOVEVM
X0dUX1NDUkFUQ0hfRklFTERfQ09IRVJFTlRMM19XQSk7CisJKmJhdGNoKysgPSAwOworCisJcmV0
dXJuIGJhdGNoOworfQorCisvKgorICogVHlwaWNhbGx5IHdlIG9ubHkgaGF2ZSBvbmUgaW5kaXJl
Y3RfY3R4IGFuZCBwZXJfY3R4IGJhdGNoIGJ1ZmZlciB3aGljaCBhcmUKKyAqIGluaXRpYWxpemVk
IGF0IHRoZSBiZWdpbm5pbmcgYW5kIHNoYXJlZCBhY3Jvc3MgYWxsIGNvbnRleHRzIGJ1dCB0aGlz
IGZpZWxkCisgKiBoZWxwcyB1cyB0byBoYXZlIG11bHRpcGxlIGJhdGNoZXMgYXQgZGlmZmVyZW50
IG9mZnNldHMgYW5kIHNlbGVjdCB0aGVtIGJhc2VkCisgKiBvbiBhIGNyaXRlcmlhLiBBdCB0aGUg
bW9tZW50IHRoaXMgYmF0Y2ggYWx3YXlzIHN0YXJ0IGF0IHRoZSBiZWdpbm5pbmcgb2YgdGhlIHBh
Z2UKKyAqIGFuZCBhdCB0aGlzIHBvaW50IHdlIGRvbid0IGhhdmUgbXVsdGlwbGUgd2FfY3R4IGJh
dGNoIGJ1ZmZlcnMuCisgKgorICogVGhlIG51bWJlciBvZiBXQSBhcHBsaWVkIGFyZSBub3Qga25v
d24gYXQgdGhlIGJlZ2lubmluZzsgd2UgdXNlIHRoaXMgZmllbGQKKyAqIHRvIHJldHVybiB0aGUg
bm8gb2YgRFdPUkRTIHdyaXR0ZW4uCisgKgorICogSXQgaXMgdG8gYmUgbm90ZWQgdGhhdCB0aGlz
IGJhdGNoIGRvZXMgbm90IGNvbnRhaW4gTUlfQkFUQ0hfQlVGRkVSX0VORAorICogc28gaXQgYWRk
cyBOT09QcyBhcyBwYWRkaW5nIHRvIG1ha2UgaXQgY2FjaGVsaW5lIGFsaWduZWQuCisgKiBNSV9C
QVRDSF9CVUZGRVJfRU5EIHdpbGwgYmUgYWRkZWQgdG8gcGVyY3R4IGJhdGNoIGFuZCBib3RoIG9m
IHRoZW0gdG9nZXRoZXIKKyAqIG1ha2VzIGEgY29tcGxldGUgYmF0Y2ggYnVmZmVyLgorICovCitz
dGF0aWMgdTMyICpnZW44X2luaXRfaW5kaXJlY3RjdHhfYmIoc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lLCB1MzIgKmJhdGNoKQoreworCS8qIFdhRGlzYWJsZUN0eFJlc3RvcmVBcmJpdHJh
dGlvbjpiZHcsY2h2ICovCisJKmJhdGNoKysgPSBNSV9BUkJfT05fT0ZGIHwgTUlfQVJCX0RJU0FC
TEU7CisKKwkvKiBXYUZsdXNoQ29oZXJlbnRMM0NhY2hlTGluZXNBdENvbnRleHRTd2l0Y2g6YmR3
ICovCisJaWYgKElTX0JST0FEV0VMTChlbmdpbmUtPmk5MTUpKQorCQliYXRjaCA9IGdlbjhfZW1p
dF9mbHVzaF9jb2hlcmVudGwzX3dhKGVuZ2luZSwgYmF0Y2gpOworCisJLyogV2FDbGVhclNsbVNw
YWNlQXRDb250ZXh0U3dpdGNoOmJkdyxjaHYgKi8KKwkvKiBBY3R1YWwgc2NyYXRjaCBsb2NhdGlv
biBpcyBhdCAxMjggYnl0ZXMgb2Zmc2V0ICovCisJYmF0Y2ggPSBnZW44X2VtaXRfcGlwZV9jb250
cm9sKGJhdGNoLAorCQkJCSAgICAgICBQSVBFX0NPTlRST0xfRkxVU0hfTDMgfAorCQkJCSAgICAg
ICBQSVBFX0NPTlRST0xfU1RPUkVfREFUQV9JTkRFWCB8CisJCQkJICAgICAgIFBJUEVfQ09OVFJP
TF9DU19TVEFMTCB8CisJCQkJICAgICAgIFBJUEVfQ09OVFJPTF9RV19XUklURSwKKwkJCQkgICAg
ICAgTFJDX1BQSFdTUF9TQ1JBVENIX0FERFIpOworCisJKmJhdGNoKysgPSBNSV9BUkJfT05fT0ZG
IHwgTUlfQVJCX0VOQUJMRTsKKworCS8qIFBhZCB0byBlbmQgb2YgY2FjaGVsaW5lICovCisJd2hp
bGUgKCh1bnNpZ25lZCBsb25nKWJhdGNoICUgQ0FDSEVMSU5FX0JZVEVTKQorCQkqYmF0Y2grKyA9
IE1JX05PT1A7CisKKwkvKgorCSAqIE1JX0JBVENIX0JVRkZFUl9FTkQgaXMgbm90IHJlcXVpcmVk
IGluIEluZGlyZWN0IGN0eCBCQiBiZWNhdXNlCisJICogZXhlY3V0aW9uIGRlcGVuZHMgb24gdGhl
IGxlbmd0aCBzcGVjaWZpZWQgaW4gdGVybXMgb2YgY2FjaGUgbGluZXMKKwkgKiBpbiB0aGUgcmVn
aXN0ZXIgQ1RYX1JDU19JTkRJUkVDVF9DVFgKKwkgKi8KKworCXJldHVybiBiYXRjaDsKK30KKwor
c3RydWN0IGxyaSB7CisJaTkxNV9yZWdfdCByZWc7CisJdTMyIHZhbHVlOworfTsKKworc3RhdGlj
IHUzMiAqZW1pdF9scmkodTMyICpiYXRjaCwgY29uc3Qgc3RydWN0IGxyaSAqbHJpLCB1bnNpZ25l
ZCBpbnQgY291bnQpCit7CisJR0VNX0JVR19PTighY291bnQgfHwgY291bnQgPiA2Myk7CisKKwkq
YmF0Y2grKyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKGNvdW50KTsKKwlkbyB7CisJCSpiYXRjaCsr
ID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQobHJpLT5yZWcpOworCQkqYmF0Y2grKyA9IGxyaS0+dmFs
dWU7CisJfSB3aGlsZSAobHJpKyssIC0tY291bnQpOworCSpiYXRjaCsrID0gTUlfTk9PUDsKKwor
CXJldHVybiBiYXRjaDsKK30KKworc3RhdGljIHUzMiAqZ2VuOV9pbml0X2luZGlyZWN0Y3R4X2Ji
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgdTMyICpiYXRjaCkKK3sKKwlzdGF0aWMg
Y29uc3Qgc3RydWN0IGxyaSBscmlbXSA9IHsKKwkJLyogV2FEaXNhYmxlR2F0aGVyQXRTZXRTaGFk
ZXJDb21tb25TbGljZTpza2wsYnh0LGtibCxnbGsgKi8KKwkJeworCQkJQ09NTU9OX1NMSUNFX0NI
SUNLRU4yLAorCQkJX19NQVNLRURfRklFTEQoR0VOOV9ESVNBQkxFX0dBVEhFUl9BVF9TRVRfU0hB
REVSX0NPTU1PTl9TTElDRSwKKwkJCQkgICAgICAgMCksCisJCX0sCisKKwkJLyogQlNwZWM6IDEx
MzkxICovCisJCXsKKwkJCUZGX1NMSUNFX0NISUNLRU4sCisJCQlfX01BU0tFRF9GSUVMRChGRl9T
TElDRV9DSElDS0VOX0NMX1BST1ZPS0lOR19WRVJURVhfRklYLAorCQkJCSAgICAgICBGRl9TTElD
RV9DSElDS0VOX0NMX1BST1ZPS0lOR19WRVJURVhfRklYKSwKKwkJfSwKKworCQkvKiBCU3BlYzog
MTEyOTkgKi8KKwkJeworCQkJXzNEX0NISUNLRU4zLAorCQkJX19NQVNLRURfRklFTEQoXzNEX0NI
SUNLRU5fU0ZfUFJPVk9LSU5HX1ZFUlRFWF9GSVgsCisJCQkJICAgICAgIF8zRF9DSElDS0VOX1NG
X1BST1ZPS0lOR19WRVJURVhfRklYKSwKKwkJfQorCX07CisKKwkqYmF0Y2grKyA9IE1JX0FSQl9P
Tl9PRkYgfCBNSV9BUkJfRElTQUJMRTsKKworCS8qIFdhRmx1c2hDb2hlcmVudEwzQ2FjaGVMaW5l
c0F0Q29udGV4dFN3aXRjaDpza2wsYnh0LGdsayAqLworCWJhdGNoID0gZ2VuOF9lbWl0X2ZsdXNo
X2NvaGVyZW50bDNfd2EoZW5naW5lLCBiYXRjaCk7CisKKwkvKiBXYUNsZWFyU2xtU3BhY2VBdENv
bnRleHRTd2l0Y2g6c2tsLGJ4dCxrYmwsZ2xrLGNmbCAqLworCWJhdGNoID0gZ2VuOF9lbWl0X3Bp
cGVfY29udHJvbChiYXRjaCwKKwkJCQkgICAgICAgUElQRV9DT05UUk9MX0ZMVVNIX0wzIHwKKwkJ
CQkgICAgICAgUElQRV9DT05UUk9MX1NUT1JFX0RBVEFfSU5ERVggfAorCQkJCSAgICAgICBQSVBF
X0NPTlRST0xfQ1NfU1RBTEwgfAorCQkJCSAgICAgICBQSVBFX0NPTlRST0xfUVdfV1JJVEUsCisJ
CQkJICAgICAgIExSQ19QUEhXU1BfU0NSQVRDSF9BRERSKTsKKworCWJhdGNoID0gZW1pdF9scmko
YmF0Y2gsIGxyaSwgQVJSQVlfU0laRShscmkpKTsKKworCS8qIFdhTWVkaWFQb29sU3RhdGVDbWRJ
bldBQkI6Ynh0LGdsayAqLworCWlmIChIQVNfUE9PTEVEX0VVKGVuZ2luZS0+aTkxNSkpIHsKKwkJ
LyoKKwkJICogRVUgcG9vbCBjb25maWd1cmF0aW9uIGlzIHNldHVwIGFsb25nIHdpdGggZ29sZGVu
IGNvbnRleHQKKwkJICogZHVyaW5nIGNvbnRleHQgaW5pdGlhbGl6YXRpb24uIFRoaXMgdmFsdWUg
ZGVwZW5kcyBvbgorCQkgKiBkZXZpY2UgdHlwZSAoMng2IG9yIDN4NikgYW5kIG5lZWRzIHRvIGJl
IHVwZGF0ZWQgYmFzZWQKKwkJICogb24gd2hpY2ggc3Vic2xpY2UgaXMgZGlzYWJsZWQgZXNwZWNp
YWxseSBmb3IgMng2CisJCSAqIGRldmljZXMsIGhvd2V2ZXIgaXQgaXMgc2FmZSB0byBsb2FkIGRl
ZmF1bHQKKwkJICogY29uZmlndXJhdGlvbiBvZiAzeDYgZGV2aWNlIGluc3RlYWQgb2YgbWFza2lu
ZyBvZmYKKwkJICogY29ycmVzcG9uZGluZyBiaXRzIGJlY2F1c2UgSFcgaWdub3JlcyBiaXRzIG9m
IGEgZGlzYWJsZWQKKwkJICogc3Vic2xpY2UgYW5kIGRyb3BzIGRvd24gdG8gYXBwcm9wcmlhdGUg
Y29uZmlnLiBQbGVhc2UKKwkJICogc2VlIHJlbmRlcl9zdGF0ZV9zZXR1cCgpIGluIGk5MTVfZ2Vt
X3JlbmRlcl9zdGF0ZS5jIGZvcgorCQkgKiBwb3NzaWJsZSBjb25maWd1cmF0aW9ucywgdG8gYXZv
aWQgZHVwbGljYXRpb24gdGhleSBhcmUKKwkJICogbm90IHNob3duIGhlcmUgYWdhaW4uCisJCSAq
LworCQkqYmF0Y2grKyA9IEdFTjlfTUVESUFfUE9PTF9TVEFURTsKKwkJKmJhdGNoKysgPSBHRU45
X01FRElBX1BPT0xfRU5BQkxFOworCQkqYmF0Y2grKyA9IDB4MDA3NzcwMDA7CisJCSpiYXRjaCsr
ID0gMDsKKwkJKmJhdGNoKysgPSAwOworCQkqYmF0Y2grKyA9IDA7CisJfQorCisJKmJhdGNoKysg
PSBNSV9BUkJfT05fT0ZGIHwgTUlfQVJCX0VOQUJMRTsKKworCS8qIFBhZCB0byBlbmQgb2YgY2Fj
aGVsaW5lICovCisJd2hpbGUgKCh1bnNpZ25lZCBsb25nKWJhdGNoICUgQ0FDSEVMSU5FX0JZVEVT
KQorCQkqYmF0Y2grKyA9IE1JX05PT1A7CisKKwlyZXR1cm4gYmF0Y2g7Cit9CisKK3N0YXRpYyB1
MzIgKgorZ2VuMTBfaW5pdF9pbmRpcmVjdGN0eF9iYihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUsIHUzMiAqYmF0Y2gpCit7CisJaW50IGk7CisKKwkvKgorCSAqIFdhUGlwZUNvbnRyb2xC
ZWZvcmUzRFN0YXRlU2FtcGxlUGF0dGVybjogY25sCisJICoKKwkgKiBFbnN1cmUgdGhlIGVuZ2lu
ZSBpcyBpZGxlIHByaW9yIHRvIHByb2dyYW1taW5nIGEKKwkgKiAzRFNUQVRFX1NBTVBMRV9QQVRU
RVJOIGR1cmluZyBhIGNvbnRleHQgcmVzdG9yZS4KKwkgKi8KKwliYXRjaCA9IGdlbjhfZW1pdF9w
aXBlX2NvbnRyb2woYmF0Y2gsCisJCQkJICAgICAgIFBJUEVfQ09OVFJPTF9DU19TVEFMTCwKKwkJ
CQkgICAgICAgMCk7CisJLyoKKwkgKiBXYVBpcGVDb250cm9sQmVmb3JlM0RTdGF0ZVNhbXBsZVBh
dHRlcm4gc2F5cyB3ZSBuZWVkIDQgZHdvcmRzIGZvcgorCSAqIHRoZSBQSVBFX0NPTlRST0wgZm9s
bG93ZWQgYnkgMTIgZHdvcmRzIG9mIDB4MCwgc28gMTYgZHdvcmRzIGluCisJICogdG90YWwuIEhv
d2V2ZXIsIGEgUElQRV9DT05UUk9MIGlzIDYgZHdvcmRzIGxvbmcsIG5vdCA0LCB3aGljaCBpcwor
CSAqIGNvbmZ1c2luZy4gU2luY2UgZ2VuOF9lbWl0X3BpcGVfY29udHJvbCgpIGFscmVhZHkgYWR2
YW5jZXMgdGhlCisJICogYmF0Y2ggYnkgNiBkd29yZHMsIHdlIGFkdmFuY2UgdGhlIG90aGVyIDEw
IGhlcmUsIGNvbXBsZXRpbmcgYQorCSAqIGNhY2hlbGluZS4gSXQncyBub3QgY2xlYXIgaWYgdGhl
IHdvcmthcm91bmQgcmVxdWlyZXMgdGhpcyBwYWRkaW5nCisJICogYmVmb3JlIG90aGVyIGNvbW1h
bmRzLCBvciBpZiBpdCdzIGp1c3QgdGhlIHJlZ3VsYXIgcGFkZGluZyB3ZSB3b3VsZAorCSAqIGFs
cmVhZHkgaGF2ZSBmb3IgdGhlIHdvcmthcm91bmQgYmIsIHNvIGxlYXZlIGl0IGhlcmUgZm9yIG5v
dy4KKwkgKi8KKwlmb3IgKGkgPSAwOyBpIDwgMTA7IGkrKykKKwkJKmJhdGNoKysgPSBNSV9OT09Q
OworCisJLyogUGFkIHRvIGVuZCBvZiBjYWNoZWxpbmUgKi8KKwl3aGlsZSAoKHVuc2lnbmVkIGxv
bmcpYmF0Y2ggJSBDQUNIRUxJTkVfQllURVMpCisJCSpiYXRjaCsrID0gTUlfTk9PUDsKKworCXJl
dHVybiBiYXRjaDsKK30KKworI2RlZmluZSBDVFhfV0FfQkJfU0laRSAoUEFHRV9TSVpFKQorCitz
dGF0aWMgaW50IGxyY19zZXR1cF93YV9jdHgoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KQoreworCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CisJc3RydWN0IGk5MTVfdm1h
ICp2bWE7CisJaW50IGVycjsKKworCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfc2htZW0o
ZW5naW5lLT5pOTE1LCBDVFhfV0FfQkJfU0laRSk7CisJaWYgKElTX0VSUihvYmopKQorCQlyZXR1
cm4gUFRSX0VSUihvYmopOworCisJdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uob2JqLCAmZW5naW5l
LT5ndC0+Z2d0dC0+dm0sIE5VTEwpOworCWlmIChJU19FUlIodm1hKSkgeworCQllcnIgPSBQVFJf
RVJSKHZtYSk7CisJCWdvdG8gZXJyOworCX0KKworCWVyciA9IGk5MTVfZ2d0dF9waW4odm1hLCBO
VUxMLCAwLCBQSU5fSElHSCk7CisJaWYgKGVycikKKwkJZ290byBlcnI7CisKKwllbmdpbmUtPndh
X2N0eC52bWEgPSB2bWE7CisJcmV0dXJuIDA7CisKK2VycjoKKwlpOTE1X2dlbV9vYmplY3RfcHV0
KG9iaik7CisJcmV0dXJuIGVycjsKK30KKwordm9pZCBscmNfZmluaV93YV9jdHgoc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCWk5MTVfdm1hX3VucGluX2FuZF9yZWxlYXNlKCZl
bmdpbmUtPndhX2N0eC52bWEsIDApOworfQorCit0eXBlZGVmIHUzMiAqKCp3YV9iYl9mdW5jX3Qp
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgdTMyICpiYXRjaCk7CisKK2ludCBscmNf
aW5pdF93YV9jdHgoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCXN0cnVjdCBp
OTE1X2N0eF93b3JrYXJvdW5kcyAqd2FfY3R4ID0gJmVuZ2luZS0+d2FfY3R4OworCXN0cnVjdCBp
OTE1X3dhX2N0eF9iYiAqd2FfYmJbXSA9IHsKKwkJJndhX2N0eC0+aW5kaXJlY3RfY3R4LCAmd2Ff
Y3R4LT5wZXJfY3R4CisJfTsKKwl3YV9iYl9mdW5jX3Qgd2FfYmJfZm5bQVJSQVlfU0laRSh3YV9i
YildOworCXZvaWQgKmJhdGNoLCAqYmF0Y2hfcHRyOworCXVuc2lnbmVkIGludCBpOworCWludCBy
ZXQ7CisKKwlpZiAoZW5naW5lLT5jbGFzcyAhPSBSRU5ERVJfQ0xBU1MpCisJCXJldHVybiAwOwor
CisJc3dpdGNoIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSkgeworCWNhc2UgMTI6CisJY2FzZSAx
MToKKwkJcmV0dXJuIDA7CisJY2FzZSAxMDoKKwkJd2FfYmJfZm5bMF0gPSBnZW4xMF9pbml0X2lu
ZGlyZWN0Y3R4X2JiOworCQl3YV9iYl9mblsxXSA9IE5VTEw7CisJCWJyZWFrOworCWNhc2UgOToK
KwkJd2FfYmJfZm5bMF0gPSBnZW45X2luaXRfaW5kaXJlY3RjdHhfYmI7CisJCXdhX2JiX2ZuWzFd
ID0gTlVMTDsKKwkJYnJlYWs7CisJY2FzZSA4OgorCQl3YV9iYl9mblswXSA9IGdlbjhfaW5pdF9p
bmRpcmVjdGN0eF9iYjsKKwkJd2FfYmJfZm5bMV0gPSBOVUxMOworCQlicmVhazsKKwlkZWZhdWx0
OgorCQlNSVNTSU5HX0NBU0UoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkpOworCQlyZXR1cm4gMDsK
Kwl9CisKKwlyZXQgPSBscmNfc2V0dXBfd2FfY3R4KGVuZ2luZSk7CisJaWYgKHJldCkgeworCQlk
cm1fZGJnKCZlbmdpbmUtPmk5MTUtPmRybSwKKwkJCSJGYWlsZWQgdG8gc2V0dXAgY29udGV4dCBX
QSBwYWdlOiAlZFxuIiwgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwliYXRjaCA9IGk5MTVf
Z2VtX29iamVjdF9waW5fbWFwKHdhX2N0eC0+dm1hLT5vYmosIEk5MTVfTUFQX1dCKTsKKworCS8q
CisJICogRW1pdCB0aGUgdHdvIHdvcmthcm91bmQgYmF0Y2ggYnVmZmVycywgcmVjb3JkaW5nIHRo
ZSBvZmZzZXQgZnJvbSB0aGUKKwkgKiBzdGFydCBvZiB0aGUgd29ya2Fyb3VuZCBiYXRjaCBidWZm
ZXIgb2JqZWN0IGZvciBlYWNoIGFuZCB0aGVpcgorCSAqIHJlc3BlY3RpdmUgc2l6ZXMuCisJICov
CisJYmF0Y2hfcHRyID0gYmF0Y2g7CisJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUod2FfYmJf
Zm4pOyBpKyspIHsKKwkJd2FfYmJbaV0tPm9mZnNldCA9IGJhdGNoX3B0ciAtIGJhdGNoOworCQlp
ZiAoR0VNX0RFQlVHX1dBUk5fT04oIUlTX0FMSUdORUQod2FfYmJbaV0tPm9mZnNldCwKKwkJCQkJ
CSAgQ0FDSEVMSU5FX0JZVEVTKSkpIHsKKwkJCXJldCA9IC1FSU5WQUw7CisJCQlicmVhazsKKwkJ
fQorCQlpZiAod2FfYmJfZm5baV0pCisJCQliYXRjaF9wdHIgPSB3YV9iYl9mbltpXShlbmdpbmUs
IGJhdGNoX3B0cik7CisJCXdhX2JiW2ldLT5zaXplID0gYmF0Y2hfcHRyIC0gKGJhdGNoICsgd2Ff
YmJbaV0tPm9mZnNldCk7CisJfQorCUdFTV9CVUdfT04oYmF0Y2hfcHRyIC0gYmF0Y2ggPiBDVFhf
V0FfQkJfU0laRSk7CisKKwlfX2k5MTVfZ2VtX29iamVjdF9mbHVzaF9tYXAod2FfY3R4LT52bWEt
Pm9iaiwgMCwgYmF0Y2hfcHRyIC0gYmF0Y2gpOworCV9faTkxNV9nZW1fb2JqZWN0X3JlbGVhc2Vf
bWFwKHdhX2N0eC0+dm1hLT5vYmopOworCWlmIChyZXQpCisJCWxyY19maW5pX3dhX2N0eChlbmdp
bmUpOworCisJcmV0dXJuIHJldDsKK30KKworI2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1
X1NFTEZURVNUKQorI2luY2x1ZGUgInNlbGZ0ZXN0X2xyYy5jIgorI2VuZGlmCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuaCBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2xyYy5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAw
MC4uZDExYWY2ZmE0OGRhCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfbHJjLmgKQEAgLTAsMCArMSw2NyBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IE1JVCAqLworLyoKKyAqIENvcHlyaWdodCDCqSAyMDE0IEludGVsIENvcnBvcmF0aW9uCisg
Ki8KKworI2lmbmRlZiBfX0lOVEVMX0xSQ19IX18KKyNkZWZpbmUgX19JTlRFTF9MUkNfSF9fCisK
KyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgorCisjaW5jbHVkZSAiaW50ZWxfY29udGV4dC5oIgor
I2luY2x1ZGUgImludGVsX2xyY19yZWcuaCIKKworc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Q7
CitzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzOworc3RydWN0IGludGVsX3Jpbmc7CisKKy8qIEF0IHRo
ZSBzdGFydCBvZiB0aGUgY29udGV4dCBpbWFnZSBpcyBpdHMgcGVyLXByb2Nlc3MgSFdTIHBhZ2Ug
Ki8KKyNkZWZpbmUgTFJDX1BQSFdTUF9QTgkoMCkKKyNkZWZpbmUgTFJDX1BQSFdTUF9TWgkoMSkK
Ky8qIEFmdGVyIHRoZSBQUEhXU1Agd2UgaGF2ZSB0aGUgbG9naWNhbCBzdGF0ZSBmb3IgdGhlIGNv
bnRleHQgKi8KKyNkZWZpbmUgTFJDX1NUQVRFX1BOCShMUkNfUFBIV1NQX1BOICsgTFJDX1BQSFdT
UF9TWikKKyNkZWZpbmUgTFJDX1NUQVRFX09GRlNFVCAoTFJDX1NUQVRFX1BOICogUEFHRV9TSVpF
KQorCisvKiBTcGFjZSB3aXRoaW4gUFBIV1NQIHJlc2VydmVkIHRvIGJlIHVzZWQgYXMgc2NyYXRj
aCAqLworI2RlZmluZSBMUkNfUFBIV1NQX1NDUkFUQ0gJCTB4MzQKKyNkZWZpbmUgTFJDX1BQSFdT
UF9TQ1JBVENIX0FERFIJCShMUkNfUFBIV1NQX1NDUkFUQ0ggKiBzaXplb2YodTMyKSkKKworaW50
IGxyY19pbml0X3dhX2N0eChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpOwordm9pZCBs
cmNfZmluaV93YV9jdHgoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKKworaW50IGxy
Y19hbGxvYyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCisJICAgICAgc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKTsKKwordm9pZCBscmNfcmVzdG9yZV9kZWZhdWx0cyhzdHJ1Y3QgaW50
ZWxfY29udGV4dCAqY2UsCisJCQkgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7CisK
K3ZvaWQgbHJjX2luaXRfcmVncyhjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCisJCSAg
IGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKKwkJICAgY29uc3Qgc3RydWN0
IGludGVsX3JpbmcgKnJpbmcsCisJCSAgIGJvb2wgY2xvc2UpOwordm9pZCBscmNfcmVzZXRfcmVn
cyhjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCisJCSAgICBjb25zdCBzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUpOworCit1MzIgbHJjX3VwZGF0ZV9yZWdzKGNvbnN0IHN0cnVj
dCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSwKKwkJICAgIHUzMiBoZWFkKTsKK3ZvaWQgbHJjX3VwZGF0ZV9vZmZzZXRzKHN0cnVj
dCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7
CisKK3ZvaWQgbHJjX2NoZWNrX3JlZ3MoY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAor
CQkgICAgY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAorCQkgICAgY29uc3Qg
Y2hhciAqd2hlbik7Cit2b2lkIGxyY19jaGVja19yZWR6b25lKHN0cnVjdCBpbnRlbF9jb250ZXh0
ICpjZSk7CisKK3N0YXRpYyBpbmxpbmUgdTMyIGxyY19nZXRfcnVudGltZShjb25zdCBzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqY2UpCit7CisJLyoKKwkgKiBXZSBjYW4gdXNlIGVpdGhlciBwcEhXU1Bb
MTZdIHdoaWNoIGlzIHJlY29yZGVkIGJlZm9yZSB0aGUgY29udGV4dAorCSAqIHN3aXRjaCAoYW5k
IHNvIGV4Y2x1ZGVzIHRoZSBjb3N0IG9mIGNvbnRleHQgc3dpdGNoZXMpIG9yIHVzZSB0aGUKKwkg
KiB2YWx1ZSBmcm9tIHRoZSBjb250ZXh0IGltYWdlIGl0c2VsZiwgd2hpY2ggaXMgc2F2ZWQvcmVz
dG9yZWQgZWFybGllcgorCSAqIGFuZCBzbyBpbmNsdWRlcyB0aGUgY29zdCBvZiB0aGUgc2F2ZS4K
KwkgKi8KKwlyZXR1cm4gUkVBRF9PTkNFKGNlLT5scmNfcmVnX3N0YXRlW0NUWF9USU1FU1RBTVBd
KTsKK30KKworI2VuZGlmIC8qIF9fSU5URUxfTFJDX0hfXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjX3JlZy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfbHJjX3JlZy5oCmluZGV4IGIyZTAzY2UzNTU5OS4uNjVmZTc2NzM4MzM1IDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmNfcmVnLmgKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjX3JlZy5oCkBAIC05LDYgKzksOCBAQAogCiAj
aW5jbHVkZSA8bGludXgvdHlwZXMuaD4KIAorI2RlZmluZSBDVFhfREVTQ19GT1JDRV9SRVNUT1JF
IEJJVF9VTEwoMikKKwogLyogR0VOOCB0byBHRU4xMiBSZWcgU3RhdGUgQ29udGV4dCAqLwogI2Rl
ZmluZSBDVFhfQ09OVEVYVF9DT05UUk9MCQkoMHgwMiArIDEpCiAjZGVmaW5lIENUWF9SSU5HX0hF
QUQJCQkoMHgwNCArIDEpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxm
dGVzdF9leGVjbGlzdHMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2V4ZWNs
aXN0cy5jCmluZGV4IDk1ZDQxYzAxZDBlMC4uMzRjMmJiODMxM2ViIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9leGVjbGlzdHMuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9leGVjbGlzdHMuYwpAQCAtMjQ5LDcgKzI0OSw3IEBAIHN0
YXRpYyBpbnQgbGl2ZV91bmxpdGVfcmVzdG9yZShzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBpbnQgcHJp
bykKIAkJfQogCQlHRU1fQlVHX09OKCFjZVsxXS0+cmluZy0+c2l6ZSk7CiAJCWludGVsX3Jpbmdf
cmVzZXQoY2VbMV0tPnJpbmcsIGNlWzFdLT5yaW5nLT5zaXplIC8gMik7Ci0JCV9fZXhlY2xpc3Rz
X3VwZGF0ZV9yZWdfc3RhdGUoY2VbMV0sIGVuZ2luZSwgY2VbMV0tPnJpbmctPmhlYWQpOworCQls
cmNfdXBkYXRlX3JlZ3MoY2VbMV0sIGVuZ2luZSwgY2VbMV0tPnJpbmctPmhlYWQpOwogCiAJCXJx
WzBdID0gaWd0X3NwaW5uZXJfY3JlYXRlX3JlcXVlc3QoJnNwaW4sIGNlWzBdLCBNSV9BUkJfQ0hF
Q0spOwogCQlpZiAoSVNfRVJSKHJxWzBdKSkgewpAQCAtNDcwNSwxNzc3ICs0NzA1LDMgQEAgaW50
IGludGVsX2V4ZWNsaXN0c19saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKIAogCXJldHVybiBpbnRlbF9ndF9saXZlX3N1YnRlc3RzKHRlc3RzLCAmaTkxNS0+Z3Qp
OwogfQotCi1zdGF0aWMgaW50IGVtaXRfc2VtYXBob3JlX3NpZ25hbChzdHJ1Y3QgaW50ZWxfY29u
dGV4dCAqY2UsIHZvaWQgKnNsb3QpCi17Ci0JY29uc3QgdTMyIG9mZnNldCA9Ci0JCWk5MTVfZ2d0
dF9vZmZzZXQoY2UtPmVuZ2luZS0+c3RhdHVzX3BhZ2Uudm1hKSArCi0JCW9mZnNldF9pbl9wYWdl
KHNsb3QpOwotCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOwotCXUzMiAqY3M7Ci0KLQlycSA9IGlu
dGVsX2NvbnRleHRfY3JlYXRlX3JlcXVlc3QoY2UpOwotCWlmIChJU19FUlIocnEpKQotCQlyZXR1
cm4gUFRSX0VSUihycSk7Ci0KLQljcyA9IGludGVsX3JpbmdfYmVnaW4ocnEsIDQpOwotCWlmIChJ
U19FUlIoY3MpKSB7Ci0JCWk5MTVfcmVxdWVzdF9hZGQocnEpOwotCQlyZXR1cm4gUFRSX0VSUihj
cyk7Ci0JfQotCi0JKmNzKysgPSBNSV9TVE9SRV9EV09SRF9JTU1fR0VONCB8IE1JX1VTRV9HR1RU
OwotCSpjcysrID0gb2Zmc2V0OwotCSpjcysrID0gMDsKLQkqY3MrKyA9IDE7Ci0KLQlpbnRlbF9y
aW5nX2FkdmFuY2UocnEsIGNzKTsKLQotCXJxLT5zY2hlZC5hdHRyLnByaW9yaXR5ID0gSTkxNV9Q
UklPUklUWV9CQVJSSUVSOwotCWk5MTVfcmVxdWVzdF9hZGQocnEpOwotCXJldHVybiAwOwotfQot
Ci1zdGF0aWMgaW50IGNvbnRleHRfZmx1c2goc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCBsb25n
IHRpbWVvdXQpCi17Ci0Jc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7Ci0Jc3RydWN0IGRtYV9mZW5j
ZSAqZmVuY2U7Ci0JaW50IGVyciA9IDA7Ci0KLQlycSA9IGludGVsX2VuZ2luZV9jcmVhdGVfa2Vy
bmVsX3JlcXVlc3QoY2UtPmVuZ2luZSk7Ci0JaWYgKElTX0VSUihycSkpCi0JCXJldHVybiBQVFJf
RVJSKHJxKTsKLQotCWZlbmNlID0gaTkxNV9hY3RpdmVfZmVuY2VfZ2V0KCZjZS0+dGltZWxpbmUt
Pmxhc3RfcmVxdWVzdCk7Ci0JaWYgKGZlbmNlKSB7Ci0JCWk5MTVfcmVxdWVzdF9hd2FpdF9kbWFf
ZmVuY2UocnEsIGZlbmNlKTsKLQkJZG1hX2ZlbmNlX3B1dChmZW5jZSk7Ci0JfQotCi0JcnEgPSBp
OTE1X3JlcXVlc3RfZ2V0KHJxKTsKLQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKLQlpZiAoaTkxNV9y
ZXF1ZXN0X3dhaXQocnEsIDAsIHRpbWVvdXQpIDwgMCkKLQkJZXJyID0gLUVUSU1FOwotCWk5MTVf
cmVxdWVzdF9wdXQocnEpOwotCi0Jcm1iKCk7IC8qIFdlIGtub3cgdGhlIHJlcXVlc3QgaXMgd3Jp
dHRlbiwgbWFrZSBzdXJlIGFsbCBzdGF0ZSBpcyB0b28hICovCi0JcmV0dXJuIGVycjsKLX0KLQot
c3RhdGljIGludCBsaXZlX2xyY19sYXlvdXQodm9pZCAqYXJnKQotewotCXN0cnVjdCBpbnRlbF9n
dCAqZ3QgPSBhcmc7Ci0Jc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCWVudW0gaW50
ZWxfZW5naW5lX2lkIGlkOwotCXUzMiAqbHJjOwotCWludCBlcnI7Ci0KLQkvKgotCSAqIENoZWNr
IHRoZSByZWdpc3RlcnMgb2Zmc2V0cyB3ZSB1c2UgdG8gY3JlYXRlIHRoZSBpbml0aWFsIHJlZyBz
dGF0ZQotCSAqIG1hdGNoIHRoZSBsYXlvdXQgc2F2ZWQgYnkgSFcuCi0JICovCi0KLQlscmMgPSBr
bWFsbG9jKFBBR0VfU0laRSwgR0ZQX0tFUk5FTCk7Ci0JaWYgKCFscmMpCi0JCXJldHVybiAtRU5P
TUVNOwotCi0JZXJyID0gMDsKLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndCwgaWQpIHsKLQkJ
dTMyICpodzsKLQkJaW50IGR3OwotCi0JCWlmICghZW5naW5lLT5kZWZhdWx0X3N0YXRlKQotCQkJ
Y29udGludWU7Ci0KLQkJaHcgPSBzaG1lbV9waW5fbWFwKGVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSk7
Ci0JCWlmIChJU19FUlIoaHcpKSB7Ci0JCQllcnIgPSBQVFJfRVJSKGh3KTsKLQkJCWJyZWFrOwot
CQl9Ci0JCWh3ICs9IExSQ19TVEFURV9PRkZTRVQgLyBzaXplb2YoKmh3KTsKLQotCQlleGVjbGlz
dHNfaW5pdF9yZWdfc3RhdGUobWVtc2V0KGxyYywgUE9JU09OX0lOVVNFLCBQQUdFX1NJWkUpLAot
CQkJCQkgZW5naW5lLT5rZXJuZWxfY29udGV4dCwKLQkJCQkJIGVuZ2luZSwKLQkJCQkJIGVuZ2lu
ZS0+a2VybmVsX2NvbnRleHQtPnJpbmcsCi0JCQkJCSB0cnVlKTsKLQotCQlkdyA9IDA7Ci0JCWRv
IHsKLQkJCXUzMiBscmkgPSBod1tkd107Ci0KLQkJCWlmIChscmkgPT0gMCkgewotCQkJCWR3Kys7
Ci0JCQkJY29udGludWU7Ci0JCQl9Ci0KLQkJCWlmIChscmNbZHddID09IDApIHsKLQkJCQlwcl9k
ZWJ1ZygiJXM6IHNraXBwZWQgaW5zdHJ1Y3Rpb24gJXggYXQgZHdvcmQgJWRcbiIsCi0JCQkJCSBl
bmdpbmUtPm5hbWUsIGxyaSwgZHcpOwotCQkJCWR3Kys7Ci0JCQkJY29udGludWU7Ci0JCQl9Ci0K
LQkJCWlmICgobHJpICYgR0VOTUFTSygzMSwgMjMpKSAhPSBNSV9JTlNUUigweDIyLCAwKSkgewot
CQkJCXByX2VycigiJXM6IEV4cGVjdGVkIExSSSBjb21tYW5kIGF0IGR3b3JkICVkLCBmb3VuZCAl
MDh4XG4iLAotCQkJCSAgICAgICBlbmdpbmUtPm5hbWUsIGR3LCBscmkpOwotCQkJCWVyciA9IC1F
SU5WQUw7Ci0JCQkJYnJlYWs7Ci0JCQl9Ci0KLQkJCWlmIChscmNbZHddICE9IGxyaSkgewotCQkJ
CXByX2VycigiJXM6IExSSSBjb21tYW5kIG1pc21hdGNoIGF0IGR3b3JkICVkLCBleHBlY3RlZCAl
MDh4IGZvdW5kICUwOHhcbiIsCi0JCQkJICAgICAgIGVuZ2luZS0+bmFtZSwgZHcsIGxyaSwgbHJj
W2R3XSk7Ci0JCQkJZXJyID0gLUVJTlZBTDsKLQkJCQlicmVhazsKLQkJCX0KLQotCQkJbHJpICY9
IDB4N2Y7Ci0JCQlscmkrKzsKLQkJCWR3Kys7Ci0KLQkJCXdoaWxlIChscmkpIHsKLQkJCQlpZiAo
aHdbZHddICE9IGxyY1tkd10pIHsKLQkJCQkJcHJfZXJyKCIlczogRGlmZmVyZW50IHJlZ2lzdGVy
cyBmb3VuZCBhdCBkd29yZCAlZCwgZXhwZWN0ZWQgJXgsIGZvdW5kICV4XG4iLAotCQkJCQkgICAg
ICAgZW5naW5lLT5uYW1lLCBkdywgaHdbZHddLCBscmNbZHddKTsKLQkJCQkJZXJyID0gLUVJTlZB
TDsKLQkJCQkJYnJlYWs7Ci0JCQkJfQotCi0JCQkJLyoKLQkJCQkgKiBTa2lwIG92ZXIgdGhlIGFj
dHVhbCByZWdpc3RlciB2YWx1ZSBhcyB3ZQotCQkJCSAqIGV4cGVjdCB0aGF0IHRvIGRpZmZlci4K
LQkJCQkgKi8KLQkJCQlkdyArPSAyOwotCQkJCWxyaSAtPSAyOwotCQkJfQotCQl9IHdoaWxlICgo
bHJjW2R3XSAmIH5CSVQoMCkpICE9IE1JX0JBVENIX0JVRkZFUl9FTkQpOwotCi0JCWlmIChlcnIp
IHsKLQkJCXByX2luZm8oIiVzOiBIVyByZWdpc3RlciBpbWFnZTpcbiIsIGVuZ2luZS0+bmFtZSk7
Ci0JCQlpZ3RfaGV4ZHVtcChodywgUEFHRV9TSVpFKTsKLQotCQkJcHJfaW5mbygiJXM6IFNXIHJl
Z2lzdGVyIGltYWdlOlxuIiwgZW5naW5lLT5uYW1lKTsKLQkJCWlndF9oZXhkdW1wKGxyYywgUEFH
RV9TSVpFKTsKLQkJfQotCi0JCXNobWVtX3VucGluX21hcChlbmdpbmUtPmRlZmF1bHRfc3RhdGUs
IGh3KTsKLQkJaWYgKGVycikKLQkJCWJyZWFrOwotCX0KLQotCWtmcmVlKGxyYyk7Ci0JcmV0dXJu
IGVycjsKLX0KLQotc3RhdGljIGludCBmaW5kX29mZnNldChjb25zdCB1MzIgKmxyaSwgdTMyIG9m
ZnNldCkKLXsKLQlpbnQgaTsKLQotCWZvciAoaSA9IDA7IGkgPCBQQUdFX1NJWkUgLyBzaXplb2Yo
dTMyKTsgaSsrKQotCQlpZiAobHJpW2ldID09IG9mZnNldCkKLQkJCXJldHVybiBpOwotCi0JcmV0
dXJuIC0xOwotfQotCi1zdGF0aWMgaW50IGxpdmVfbHJjX2ZpeGVkKHZvaWQgKmFyZykKLXsKLQlz
dHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOwotCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZTsKLQllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKLQlpbnQgZXJyID0gMDsKLQotCS8qCi0JICog
Q2hlY2sgdGhlIGFzc3VtZWQgcmVnaXN0ZXIgb2Zmc2V0cyBtYXRjaCB0aGUgYWN0dWFsIGxvY2F0
aW9ucyBpbgotCSAqIHRoZSBjb250ZXh0IGltYWdlLgotCSAqLwotCi0JZm9yX2VhY2hfZW5naW5l
KGVuZ2luZSwgZ3QsIGlkKSB7Ci0JCWNvbnN0IHN0cnVjdCB7Ci0JCQl1MzIgcmVnOwotCQkJdTMy
IG9mZnNldDsKLQkJCWNvbnN0IGNoYXIgKm5hbWU7Ci0JCX0gdGJsW10gPSB7Ci0JCQl7Ci0JCQkJ
aTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19TVEFSVChlbmdpbmUtPm1taW9fYmFzZSkpLAotCQkJ
CUNUWF9SSU5HX1NUQVJUIC0gMSwKLQkJCQkiUklOR19TVEFSVCIKLQkJCX0sCi0JCQl7Ci0JCQkJ
aTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19DVEwoZW5naW5lLT5tbWlvX2Jhc2UpKSwKLQkJCQlD
VFhfUklOR19DVEwgLSAxLAotCQkJCSJSSU5HX0NUTCIKLQkJCX0sCi0JCQl7Ci0JCQkJaTkxNV9t
bWlvX3JlZ19vZmZzZXQoUklOR19IRUFEKGVuZ2luZS0+bW1pb19iYXNlKSksCi0JCQkJQ1RYX1JJ
TkdfSEVBRCAtIDEsCi0JCQkJIlJJTkdfSEVBRCIKLQkJCX0sCi0JCQl7Ci0JCQkJaTkxNV9tbWlv
X3JlZ19vZmZzZXQoUklOR19UQUlMKGVuZ2luZS0+bW1pb19iYXNlKSksCi0JCQkJQ1RYX1JJTkdf
VEFJTCAtIDEsCi0JCQkJIlJJTkdfVEFJTCIKLQkJCX0sCi0JCQl7Ci0JCQkJaTkxNV9tbWlvX3Jl
Z19vZmZzZXQoUklOR19NSV9NT0RFKGVuZ2luZS0+bW1pb19iYXNlKSksCi0JCQkJbHJjX3Jpbmdf
bWlfbW9kZShlbmdpbmUpLAotCQkJCSJSSU5HX01JX01PREUiCi0JCQl9LAotCQkJewotCQkJCWk5
MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfQkJTVEFURShlbmdpbmUtPm1taW9fYmFzZSkpLAotCQkJ
CUNUWF9CQl9TVEFURSAtIDEsCi0JCQkJIkJCX1NUQVRFIgotCQkJfSwKLQkJCXsKLQkJCQlpOTE1
X21taW9fcmVnX29mZnNldChSSU5HX0JCX1BFUl9DVFhfUFRSKGVuZ2luZS0+bW1pb19iYXNlKSks
Ci0JCQkJbHJjX3Jpbmdfd2FfYmJfcGVyX2N0eChlbmdpbmUpLAotCQkJCSJSSU5HX0JCX1BFUl9D
VFhfUFRSIgotCQkJfSwKLQkJCXsKLQkJCQlpOTE1X21taW9fcmVnX29mZnNldChSSU5HX0lORElS
RUNUX0NUWChlbmdpbmUtPm1taW9fYmFzZSkpLAotCQkJCWxyY19yaW5nX2luZGlyZWN0X3B0cihl
bmdpbmUpLAotCQkJCSJSSU5HX0lORElSRUNUX0NUWF9QVFIiCi0JCQl9LAotCQkJewotCQkJCWk5
MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfSU5ESVJFQ1RfQ1RYX09GRlNFVChlbmdpbmUtPm1taW9f
YmFzZSkpLAotCQkJCWxyY19yaW5nX2luZGlyZWN0X29mZnNldChlbmdpbmUpLAotCQkJCSJSSU5H
X0lORElSRUNUX0NUWF9PRkZTRVQiCi0JCQl9LAotCQkJewotCQkJCWk5MTVfbW1pb19yZWdfb2Zm
c2V0KFJJTkdfQ1RYX1RJTUVTVEFNUChlbmdpbmUtPm1taW9fYmFzZSkpLAotCQkJCUNUWF9USU1F
U1RBTVAgLSAxLAotCQkJCSJSSU5HX0NUWF9USU1FU1RBTVAiCi0JCQl9LAotCQkJewotCQkJCWk5
MTVfbW1pb19yZWdfb2Zmc2V0KEdFTjhfUklOR19DU19HUFIoZW5naW5lLT5tbWlvX2Jhc2UsIDAp
KSwKLQkJCQlscmNfcmluZ19ncHIwKGVuZ2luZSksCi0JCQkJIlJJTkdfQ1NfR1BSMCIKLQkJCX0s
Ci0JCQl7Ci0JCQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19DTURfQlVGX0NDVEwoZW5naW5l
LT5tbWlvX2Jhc2UpKSwKLQkJCQlscmNfcmluZ19jbWRfYnVmX2NjdGwoZW5naW5lKSwKLQkJCQki
UklOR19DTURfQlVGX0NDVEwiCi0JCQl9LAotCQkJeyB9LAotCQl9LCAqdDsKLQkJdTMyICpodzsK
LQotCQlpZiAoIWVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSkKLQkJCWNvbnRpbnVlOwotCi0JCWh3ID0g
c2htZW1fcGluX21hcChlbmdpbmUtPmRlZmF1bHRfc3RhdGUpOwotCQlpZiAoSVNfRVJSKGh3KSkg
ewotCQkJZXJyID0gUFRSX0VSUihodyk7Ci0JCQlicmVhazsKLQkJfQotCQlodyArPSBMUkNfU1RB
VEVfT0ZGU0VUIC8gc2l6ZW9mKCpodyk7Ci0KLQkJZm9yICh0ID0gdGJsOyB0LT5uYW1lOyB0Kysp
IHsKLQkJCWludCBkdyA9IGZpbmRfb2Zmc2V0KGh3LCB0LT5yZWcpOwotCi0JCQlpZiAoZHcgIT0g
dC0+b2Zmc2V0KSB7Ci0JCQkJcHJfZXJyKCIlczogT2Zmc2V0IGZvciAlcyBbMHgleF0gbWlzbWF0
Y2gsIGZvdW5kICV4LCBleHBlY3RlZCAleFxuIiwKLQkJCQkgICAgICAgZW5naW5lLT5uYW1lLAot
CQkJCSAgICAgICB0LT5uYW1lLAotCQkJCSAgICAgICB0LT5yZWcsCi0JCQkJICAgICAgIGR3LAot
CQkJCSAgICAgICB0LT5vZmZzZXQpOwotCQkJCWVyciA9IC1FSU5WQUw7Ci0JCQl9Ci0JCX0KLQot
CQlzaG1lbV91bnBpbl9tYXAoZW5naW5lLT5kZWZhdWx0X3N0YXRlLCBodyk7Ci0JfQotCi0JcmV0
dXJuIGVycjsKLX0KLQotc3RhdGljIGludCBfX2xpdmVfbHJjX3N0YXRlKHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSwKLQkJCSAgICBzdHJ1Y3QgaTkxNV92bWEgKnNjcmF0Y2gpCi17Ci0J
c3RydWN0IGludGVsX2NvbnRleHQgKmNlOwotCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOwotCXN0
cnVjdCBpOTE1X2dlbV93d19jdHggd3c7Ci0JZW51bSB7Ci0JCVJJTkdfU1RBUlRfSURYID0gMCwK
LQkJUklOR19UQUlMX0lEWCwKLQkJTUFYX0lEWAotCX07Ci0JdTMyIGV4cGVjdGVkW01BWF9JRFhd
OwotCXUzMiAqY3M7Ci0JaW50IGVycjsKLQlpbnQgbjsKLQotCWNlID0gaW50ZWxfY29udGV4dF9j
cmVhdGUoZW5naW5lKTsKLQlpZiAoSVNfRVJSKGNlKSkKLQkJcmV0dXJuIFBUUl9FUlIoY2UpOwot
Ci0JaTkxNV9nZW1fd3dfY3R4X2luaXQoJnd3LCBmYWxzZSk7Ci1yZXRyeToKLQllcnIgPSBpOTE1
X2dlbV9vYmplY3RfbG9jayhzY3JhdGNoLT5vYmosICZ3dyk7Ci0JaWYgKCFlcnIpCi0JCWVyciA9
IGludGVsX2NvbnRleHRfcGluX3d3KGNlLCAmd3cpOwotCWlmIChlcnIpCi0JCWdvdG8gZXJyX3B1
dDsKLQotCXJxID0gaTkxNV9yZXF1ZXN0X2NyZWF0ZShjZSk7Ci0JaWYgKElTX0VSUihycSkpIHsK
LQkJZXJyID0gUFRSX0VSUihycSk7Ci0JCWdvdG8gZXJyX3VucGluOwotCX0KLQotCWNzID0gaW50
ZWxfcmluZ19iZWdpbihycSwgNCAqIE1BWF9JRFgpOwotCWlmIChJU19FUlIoY3MpKSB7Ci0JCWVy
ciA9IFBUUl9FUlIoY3MpOwotCQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKLQkJZ290byBlcnJfdW5w
aW47Ci0JfQotCi0JKmNzKysgPSBNSV9TVE9SRV9SRUdJU1RFUl9NRU1fR0VOOCB8IE1JX1VTRV9H
R1RUOwotCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19TVEFSVChlbmdpbmUtPm1t
aW9fYmFzZSkpOwotCSpjcysrID0gaTkxNV9nZ3R0X29mZnNldChzY3JhdGNoKSArIFJJTkdfU1RB
UlRfSURYICogc2l6ZW9mKHUzMik7Ci0JKmNzKysgPSAwOwotCi0JZXhwZWN0ZWRbUklOR19TVEFS
VF9JRFhdID0gaTkxNV9nZ3R0X29mZnNldChjZS0+cmluZy0+dm1hKTsKLQotCSpjcysrID0gTUlf
U1RPUkVfUkVHSVNURVJfTUVNX0dFTjggfCBNSV9VU0VfR0dUVDsKLQkqY3MrKyA9IGk5MTVfbW1p
b19yZWdfb2Zmc2V0KFJJTkdfVEFJTChlbmdpbmUtPm1taW9fYmFzZSkpOwotCSpjcysrID0gaTkx
NV9nZ3R0X29mZnNldChzY3JhdGNoKSArIFJJTkdfVEFJTF9JRFggKiBzaXplb2YodTMyKTsKLQkq
Y3MrKyA9IDA7Ci0KLQllcnIgPSBpOTE1X3JlcXVlc3RfYXdhaXRfb2JqZWN0KHJxLCBzY3JhdGNo
LT5vYmosIHRydWUpOwotCWlmICghZXJyKQotCQllcnIgPSBpOTE1X3ZtYV9tb3ZlX3RvX2FjdGl2
ZShzY3JhdGNoLCBycSwgRVhFQ19PQkpFQ1RfV1JJVEUpOwotCi0JaTkxNV9yZXF1ZXN0X2dldChy
cSk7Ci0JaTkxNV9yZXF1ZXN0X2FkZChycSk7Ci0JaWYgKGVycikKLQkJZ290byBlcnJfcnE7Ci0K
LQlpbnRlbF9lbmdpbmVfZmx1c2hfc3VibWlzc2lvbihlbmdpbmUpOwotCWV4cGVjdGVkW1JJTkdf
VEFJTF9JRFhdID0gY2UtPnJpbmctPnRhaWw7Ci0KLQlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQocnEs
IDAsIEhaIC8gNSkgPCAwKSB7Ci0JCWVyciA9IC1FVElNRTsKLQkJZ290byBlcnJfcnE7Ci0JfQot
Ci0JY3MgPSBpOTE1X2dlbV9vYmplY3RfcGluX21hcChzY3JhdGNoLT5vYmosIEk5MTVfTUFQX1dC
KTsKLQlpZiAoSVNfRVJSKGNzKSkgewotCQllcnIgPSBQVFJfRVJSKGNzKTsKLQkJZ290byBlcnJf
cnE7Ci0JfQotCi0JZm9yIChuID0gMDsgbiA8IE1BWF9JRFg7IG4rKykgewotCQlpZiAoY3Nbbl0g
IT0gZXhwZWN0ZWRbbl0pIHsKLQkJCXByX2VycigiJXM6IFN0b3JlZCByZWdpc3RlclslZF0gdmFs
dWVbMHgleF0gZGlkIG5vdCBtYXRjaCBleHBlY3RlZFsweCV4XVxuIiwKLQkJCSAgICAgICBlbmdp
bmUtPm5hbWUsIG4sIGNzW25dLCBleHBlY3RlZFtuXSk7Ci0JCQllcnIgPSAtRUlOVkFMOwotCQkJ
YnJlYWs7Ci0JCX0KLQl9Ci0KLQlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHNjcmF0Y2gtPm9i
aik7Ci0KLWVycl9ycToKLQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKLWVycl91bnBpbjoKLQlpbnRl
bF9jb250ZXh0X3VucGluKGNlKTsKLWVycl9wdXQ6Ci0JaWYgKGVyciA9PSAtRURFQURMSykgewot
CQllcnIgPSBpOTE1X2dlbV93d19jdHhfYmFja29mZigmd3cpOwotCQlpZiAoIWVycikKLQkJCWdv
dG8gcmV0cnk7Ci0JfQotCWk5MTVfZ2VtX3d3X2N0eF9maW5pKCZ3dyk7Ci0JaW50ZWxfY29udGV4
dF9wdXQoY2UpOwotCXJldHVybiBlcnI7Ci19Ci0KLXN0YXRpYyBpbnQgbGl2ZV9scmNfc3RhdGUo
dm9pZCAqYXJnKQotewotCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7Ci0Jc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lOwotCXN0cnVjdCBpOTE1X3ZtYSAqc2NyYXRjaDsKLQllbnVtIGlu
dGVsX2VuZ2luZV9pZCBpZDsKLQlpbnQgZXJyID0gMDsKLQotCS8qCi0JICogQ2hlY2sgdGhlIGxp
dmUgcmVnaXN0ZXIgc3RhdGUgbWF0Y2hlcyB3aGF0IHdlIGV4cGVjdCBmb3IgdGhpcwotCSAqIGlu
dGVsX2NvbnRleHQuCi0JICovCi0KLQlzY3JhdGNoID0gY3JlYXRlX3NjcmF0Y2goZ3QpOwotCWlm
IChJU19FUlIoc2NyYXRjaCkpCi0JCXJldHVybiBQVFJfRVJSKHNjcmF0Y2gpOwotCi0JZm9yX2Vh
Y2hfZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7Ci0JCWVyciA9IF9fbGl2ZV9scmNfc3RhdGUoZW5n
aW5lLCBzY3JhdGNoKTsKLQkJaWYgKGVycikKLQkJCWJyZWFrOwotCX0KLQotCWlmIChpZ3RfZmx1
c2hfdGVzdChndC0+aTkxNSkpCi0JCWVyciA9IC1FSU87Ci0KLQlpOTE1X3ZtYV91bnBpbl9hbmRf
cmVsZWFzZSgmc2NyYXRjaCwgMCk7Ci0JcmV0dXJuIGVycjsKLX0KLQotc3RhdGljIGludCBncHJf
bWFrZV9kaXJ0eShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCi17Ci0Jc3RydWN0IGk5MTVfcmVx
dWVzdCAqcnE7Ci0JdTMyICpjczsKLQlpbnQgbjsKLQotCXJxID0gaW50ZWxfY29udGV4dF9jcmVh
dGVfcmVxdWVzdChjZSk7Ci0JaWYgKElTX0VSUihycSkpCi0JCXJldHVybiBQVFJfRVJSKHJxKTsK
LQotCWNzID0gaW50ZWxfcmluZ19iZWdpbihycSwgMiAqIE5VTV9HUFJfRFcgKyAyKTsKLQlpZiAo
SVNfRVJSKGNzKSkgewotCQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKLQkJcmV0dXJuIFBUUl9FUlIo
Y3MpOwotCX0KLQotCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oTlVNX0dQUl9EVyk7Ci0J
Zm9yIChuID0gMDsgbiA8IE5VTV9HUFJfRFc7IG4rKykgewotCQkqY3MrKyA9IENTX0dQUihjZS0+
ZW5naW5lLCBuKTsKLQkJKmNzKysgPSBTVEFDS19NQUdJQzsKLQl9Ci0JKmNzKysgPSBNSV9OT09Q
OwotCi0JaW50ZWxfcmluZ19hZHZhbmNlKHJxLCBjcyk7Ci0KLQlycS0+c2NoZWQuYXR0ci5wcmlv
cml0eSA9IEk5MTVfUFJJT1JJVFlfQkFSUklFUjsKLQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKLQot
CXJldHVybiAwOwotfQotCi1zdGF0aWMgc3RydWN0IGk5MTVfcmVxdWVzdCAqCi1fX2dwcl9yZWFk
KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgc3RydWN0IGk5MTVfdm1hICpzY3JhdGNoLCB1MzIg
KnNsb3QpCi17Ci0JY29uc3QgdTMyIG9mZnNldCA9Ci0JCWk5MTVfZ2d0dF9vZmZzZXQoY2UtPmVu
Z2luZS0+c3RhdHVzX3BhZ2Uudm1hKSArCi0JCW9mZnNldF9pbl9wYWdlKHNsb3QpOwotCXN0cnVj
dCBpOTE1X3JlcXVlc3QgKnJxOwotCXUzMiAqY3M7Ci0JaW50IGVycjsKLQlpbnQgbjsKLQotCXJx
ID0gaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVzdChjZSk7Ci0JaWYgKElTX0VSUihycSkpCi0J
CXJldHVybiBycTsKLQotCWNzID0gaW50ZWxfcmluZ19iZWdpbihycSwgNiArIDQgKiBOVU1fR1BS
X0RXKTsKLQlpZiAoSVNfRVJSKGNzKSkgewotCQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKLQkJcmV0
dXJuIEVSUl9DQVNUKGNzKTsKLQl9Ci0KLQkqY3MrKyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJf
RU5BQkxFOwotCSpjcysrID0gTUlfTk9PUDsKLQotCSpjcysrID0gTUlfU0VNQVBIT1JFX1dBSVQg
fAotCQlNSV9TRU1BUEhPUkVfR0xPQkFMX0dUVCB8Ci0JCU1JX1NFTUFQSE9SRV9QT0xMIHwKLQkJ
TUlfU0VNQVBIT1JFX1NBRF9ORVFfU0REOwotCSpjcysrID0gMDsKLQkqY3MrKyA9IG9mZnNldDsK
LQkqY3MrKyA9IDA7Ci0KLQlmb3IgKG4gPSAwOyBuIDwgTlVNX0dQUl9EVzsgbisrKSB7Ci0JCSpj
cysrID0gTUlfU1RPUkVfUkVHSVNURVJfTUVNX0dFTjggfCBNSV9VU0VfR0dUVDsKLQkJKmNzKysg
PSBDU19HUFIoY2UtPmVuZ2luZSwgbik7Ci0JCSpjcysrID0gaTkxNV9nZ3R0X29mZnNldChzY3Jh
dGNoKSArIG4gKiBzaXplb2YodTMyKTsKLQkJKmNzKysgPSAwOwotCX0KLQotCWk5MTVfdm1hX2xv
Y2soc2NyYXRjaCk7Ci0JZXJyID0gaTkxNV9yZXF1ZXN0X2F3YWl0X29iamVjdChycSwgc2NyYXRj
aC0+b2JqLCB0cnVlKTsKLQlpZiAoIWVycikKLQkJZXJyID0gaTkxNV92bWFfbW92ZV90b19hY3Rp
dmUoc2NyYXRjaCwgcnEsIEVYRUNfT0JKRUNUX1dSSVRFKTsKLQlpOTE1X3ZtYV91bmxvY2soc2Ny
YXRjaCk7Ci0KLQlpOTE1X3JlcXVlc3RfZ2V0KHJxKTsKLQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsK
LQlpZiAoZXJyKSB7Ci0JCWk5MTVfcmVxdWVzdF9wdXQocnEpOwotCQlycSA9IEVSUl9QVFIoZXJy
KTsKLQl9Ci0KLQlyZXR1cm4gcnE7Ci19Ci0KLXN0YXRpYyBpbnQgX19saXZlX2xyY19ncHIoc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAotCQkJICBzdHJ1Y3QgaTkxNV92bWEgKnNjcmF0
Y2gsCi0JCQkgIGJvb2wgcHJlZW1wdCkKLXsKLQl1MzIgKnNsb3QgPSBtZW1zZXQzMihlbmdpbmUt
PnN0YXR1c19wYWdlLmFkZHIgKyAxMDAwLCAwLCA0KTsKLQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAq
Y2U7Ci0Jc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7Ci0JdTMyICpjczsKLQlpbnQgZXJyOwotCWlu
dCBuOwotCi0JaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpIDwgOSAmJiBlbmdpbmUtPmNsYXNz
ICE9IFJFTkRFUl9DTEFTUykKLQkJcmV0dXJuIDA7IC8qIEdQUiBvbmx5IG9uIHJjczAgZm9yIGdl
bjggKi8KLQotCWVyciA9IGdwcl9tYWtlX2RpcnR5KGVuZ2luZS0+a2VybmVsX2NvbnRleHQpOwot
CWlmIChlcnIpCi0JCXJldHVybiBlcnI7Ci0KLQljZSA9IGludGVsX2NvbnRleHRfY3JlYXRlKGVu
Z2luZSk7Ci0JaWYgKElTX0VSUihjZSkpCi0JCXJldHVybiBQVFJfRVJSKGNlKTsKLQotCXJxID0g
X19ncHJfcmVhZChjZSwgc2NyYXRjaCwgc2xvdCk7Ci0JaWYgKElTX0VSUihycSkpIHsKLQkJZXJy
ID0gUFRSX0VSUihycSk7Ci0JCWdvdG8gZXJyX3B1dDsKLQl9Ci0KLQllcnIgPSB3YWl0X2Zvcl9z
dWJtaXQoZW5naW5lLCBycSwgSFogLyAyKTsKLQlpZiAoZXJyKQotCQlnb3RvIGVycl9ycTsKLQot
CWlmIChwcmVlbXB0KSB7Ci0JCWVyciA9IGdwcl9tYWtlX2RpcnR5KGVuZ2luZS0+a2VybmVsX2Nv
bnRleHQpOwotCQlpZiAoZXJyKQotCQkJZ290byBlcnJfcnE7Ci0KLQkJZXJyID0gZW1pdF9zZW1h
cGhvcmVfc2lnbmFsKGVuZ2luZS0+a2VybmVsX2NvbnRleHQsIHNsb3QpOwotCQlpZiAoZXJyKQot
CQkJZ290byBlcnJfcnE7Ci0JfSBlbHNlIHsKLQkJc2xvdFswXSA9IDE7Ci0JCXdtYigpOwotCX0K
LQotCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgSFogLyA1KSA8IDApIHsKLQkJZXJyID0g
LUVUSU1FOwotCQlnb3RvIGVycl9ycTsKLQl9Ci0KLQljcyA9IGk5MTVfZ2VtX29iamVjdF9waW5f
bWFwKHNjcmF0Y2gtPm9iaiwgSTkxNV9NQVBfV0IpOwotCWlmIChJU19FUlIoY3MpKSB7Ci0JCWVy
ciA9IFBUUl9FUlIoY3MpOwotCQlnb3RvIGVycl9ycTsKLQl9Ci0KLQlmb3IgKG4gPSAwOyBuIDwg
TlVNX0dQUl9EVzsgbisrKSB7Ci0JCWlmIChjc1tuXSkgewotCQkJcHJfZXJyKCIlczogR1BSWyVk
XS4lcyB3YXMgbm90IHplcm8sIGZvdW5kIDB4JTA4eCFcbiIsCi0JCQkgICAgICAgZW5naW5lLT5u
YW1lLAotCQkJICAgICAgIG4gLyAyLCBuICYgMSA/ICJ1ZHciIDogImxkdyIsCi0JCQkgICAgICAg
Y3Nbbl0pOwotCQkJZXJyID0gLUVJTlZBTDsKLQkJCWJyZWFrOwotCQl9Ci0JfQotCi0JaTkxNV9n
ZW1fb2JqZWN0X3VucGluX21hcChzY3JhdGNoLT5vYmopOwotCi1lcnJfcnE6Ci0JbWVtc2V0MzIo
JnNsb3RbMF0sIC0xLCA0KTsKLQl3bWIoKTsKLQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKLWVycl9w
dXQ6Ci0JaW50ZWxfY29udGV4dF9wdXQoY2UpOwotCXJldHVybiBlcnI7Ci19Ci0KLXN0YXRpYyBp
bnQgbGl2ZV9scmNfZ3ByKHZvaWQgKmFyZykKLXsKLQlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJn
OwotCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKLQlzdHJ1Y3QgaTkxNV92bWEgKnNj
cmF0Y2g7Ci0JZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Ci0JaW50IGVyciA9IDA7Ci0KLQkvKgot
CSAqIENoZWNrIHRoYXQgR1BSIHJlZ2lzdGVycyBhcmUgY2xlYXJlZCBpbiBuZXcgY29udGV4dHMg
YXMgd2UgbmVlZAotCSAqIHRvIGF2b2lkIGxlYWtpbmcgYW55IGluZm9ybWF0aW9uIGZyb20gcHJl
dmlvdXMgY29udGV4dHMuCi0JICovCi0KLQlzY3JhdGNoID0gY3JlYXRlX3NjcmF0Y2goZ3QpOwot
CWlmIChJU19FUlIoc2NyYXRjaCkpCi0JCXJldHVybiBQVFJfRVJSKHNjcmF0Y2gpOwotCi0JZm9y
X2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7Ci0JCXN0X2VuZ2luZV9oZWFydGJlYXRfZGlz
YWJsZShlbmdpbmUpOwotCi0JCWVyciA9IF9fbGl2ZV9scmNfZ3ByKGVuZ2luZSwgc2NyYXRjaCwg
ZmFsc2UpOwotCQlpZiAoZXJyKQotCQkJZ290byBlcnI7Ci0KLQkJZXJyID0gX19saXZlX2xyY19n
cHIoZW5naW5lLCBzY3JhdGNoLCB0cnVlKTsKLQkJaWYgKGVycikKLQkJCWdvdG8gZXJyOwotCi1l
cnI6Ci0JCXN0X2VuZ2luZV9oZWFydGJlYXRfZW5hYmxlKGVuZ2luZSk7Ci0JCWlmIChpZ3RfZmx1
c2hfdGVzdChndC0+aTkxNSkpCi0JCQllcnIgPSAtRUlPOwotCQlpZiAoZXJyKQotCQkJYnJlYWs7
Ci0JfQotCi0JaTkxNV92bWFfdW5waW5fYW5kX3JlbGVhc2UoJnNjcmF0Y2gsIDApOwotCXJldHVy
biBlcnI7Ci19Ci0KLXN0YXRpYyBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICoKLWNyZWF0ZV90aW1lc3Rh
bXAoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCB2b2lkICpzbG90LCBpbnQgaWR4KQotewotCWNv
bnN0IHUzMiBvZmZzZXQgPQotCQlpOTE1X2dndHRfb2Zmc2V0KGNlLT5lbmdpbmUtPnN0YXR1c19w
YWdlLnZtYSkgKwotCQlvZmZzZXRfaW5fcGFnZShzbG90KTsKLQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0
ICpycTsKLQl1MzIgKmNzOwotCWludCBlcnI7Ci0KLQlycSA9IGludGVsX2NvbnRleHRfY3JlYXRl
X3JlcXVlc3QoY2UpOwotCWlmIChJU19FUlIocnEpKQotCQlyZXR1cm4gcnE7Ci0KLQljcyA9IGlu
dGVsX3JpbmdfYmVnaW4ocnEsIDEwKTsKLQlpZiAoSVNfRVJSKGNzKSkgewotCQllcnIgPSBQVFJf
RVJSKGNzKTsKLQkJZ290byBlcnI7Ci0JfQotCi0JKmNzKysgPSBNSV9BUkJfT05fT0ZGIHwgTUlf
QVJCX0VOQUJMRTsKLQkqY3MrKyA9IE1JX05PT1A7Ci0KLQkqY3MrKyA9IE1JX1NFTUFQSE9SRV9X
QUlUIHwKLQkJTUlfU0VNQVBIT1JFX0dMT0JBTF9HVFQgfAotCQlNSV9TRU1BUEhPUkVfUE9MTCB8
Ci0JCU1JX1NFTUFQSE9SRV9TQURfTkVRX1NERDsKLQkqY3MrKyA9IDA7Ci0JKmNzKysgPSBvZmZz
ZXQ7Ci0JKmNzKysgPSAwOwotCi0JKmNzKysgPSBNSV9TVE9SRV9SRUdJU1RFUl9NRU1fR0VOOCB8
IE1JX1VTRV9HR1RUOwotCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19DVFhfVElN
RVNUQU1QKHJxLT5lbmdpbmUtPm1taW9fYmFzZSkpOwotCSpjcysrID0gb2Zmc2V0ICsgaWR4ICog
c2l6ZW9mKHUzMik7Ci0JKmNzKysgPSAwOwotCi0JaW50ZWxfcmluZ19hZHZhbmNlKHJxLCBjcyk7
Ci0KLQlycS0+c2NoZWQuYXR0ci5wcmlvcml0eSA9IEk5MTVfUFJJT1JJVFlfTUFTSzsKLQllcnIg
PSAwOwotZXJyOgotCWk5MTVfcmVxdWVzdF9nZXQocnEpOwotCWk5MTVfcmVxdWVzdF9hZGQocnEp
OwotCWlmIChlcnIpIHsKLQkJaTkxNV9yZXF1ZXN0X3B1dChycSk7Ci0JCXJldHVybiBFUlJfUFRS
KGVycik7Ci0JfQotCi0JcmV0dXJuIHJxOwotfQotCi1zdHJ1Y3QgbHJjX3RpbWVzdGFtcCB7Ci0J
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpj
ZVsyXTsKLQl1MzIgcG9pc29uOwotfTsKLQotc3RhdGljIGJvb2wgdGltZXN0YW1wX2FkdmFuY2Vk
KHUzMiBzdGFydCwgdTMyIGVuZCkKLXsKLQlyZXR1cm4gKHMzMikoZW5kIC0gc3RhcnQpID4gMDsK
LX0KLQotc3RhdGljIGludCBfX2xyY190aW1lc3RhbXAoY29uc3Qgc3RydWN0IGxyY190aW1lc3Rh
bXAgKmFyZywgYm9vbCBwcmVlbXB0KQotewotCXUzMiAqc2xvdCA9IG1lbXNldDMyKGFyZy0+ZW5n
aW5lLT5zdGF0dXNfcGFnZS5hZGRyICsgMTAwMCwgMCwgNCk7Ci0Jc3RydWN0IGk5MTVfcmVxdWVz
dCAqcnE7Ci0JdTMyIHRpbWVzdGFtcDsKLQlpbnQgZXJyID0gMDsKLQotCWFyZy0+Y2VbMF0tPmxy
Y19yZWdfc3RhdGVbQ1RYX1RJTUVTVEFNUF0gPSBhcmctPnBvaXNvbjsKLQlycSA9IGNyZWF0ZV90
aW1lc3RhbXAoYXJnLT5jZVswXSwgc2xvdCwgMSk7Ci0JaWYgKElTX0VSUihycSkpCi0JCXJldHVy
biBQVFJfRVJSKHJxKTsKLQotCWVyciA9IHdhaXRfZm9yX3N1Ym1pdChycS0+ZW5naW5lLCBycSwg
SFogLyAyKTsKLQlpZiAoZXJyKQotCQlnb3RvIGVycjsKLQotCWlmIChwcmVlbXB0KSB7Ci0JCWFy
Zy0+Y2VbMV0tPmxyY19yZWdfc3RhdGVbQ1RYX1RJTUVTVEFNUF0gPSAweGRlYWRiZWVmOwotCQll
cnIgPSBlbWl0X3NlbWFwaG9yZV9zaWduYWwoYXJnLT5jZVsxXSwgc2xvdCk7Ci0JCWlmIChlcnIp
Ci0JCQlnb3RvIGVycjsKLQl9IGVsc2UgewotCQlzbG90WzBdID0gMTsKLQkJd21iKCk7Ci0JfQot
Ci0JLyogQW5kIHdhaXQgZm9yIHN3aXRjaCB0byBrZXJuZWwgKHRvIHNhdmUgb3VyIGNvbnRleHQg
dG8gbWVtb3J5KSAqLwotCWVyciA9IGNvbnRleHRfZmx1c2goYXJnLT5jZVswXSwgSFogLyAyKTsK
LQlpZiAoZXJyKQotCQlnb3RvIGVycjsKLQotCWlmICghdGltZXN0YW1wX2FkdmFuY2VkKGFyZy0+
cG9pc29uLCBzbG90WzFdKSkgewotCQlwcl9lcnIoIiVzKCVzKTogaW52YWxpZCB0aW1lc3RhbXAg
b24gcmVzdG9yZSwgY29udGV4dDoleCwgcmVxdWVzdDoleFxuIiwKLQkJICAgICAgIGFyZy0+ZW5n
aW5lLT5uYW1lLCBwcmVlbXB0ID8gInByZWVtcHQiIDogInNpbXBsZSIsCi0JCSAgICAgICBhcmct
PnBvaXNvbiwgc2xvdFsxXSk7Ci0JCWVyciA9IC1FSU5WQUw7Ci0JfQotCi0JdGltZXN0YW1wID0g
UkVBRF9PTkNFKGFyZy0+Y2VbMF0tPmxyY19yZWdfc3RhdGVbQ1RYX1RJTUVTVEFNUF0pOwotCWlm
ICghdGltZXN0YW1wX2FkdmFuY2VkKHNsb3RbMV0sIHRpbWVzdGFtcCkpIHsKLQkJcHJfZXJyKCIl
cyglcyk6IGludmFsaWQgdGltZXN0YW1wIG9uIHNhdmUsIHJlcXVlc3Q6JXgsIGNvbnRleHQ6JXhc
biIsCi0JCSAgICAgICBhcmctPmVuZ2luZS0+bmFtZSwgcHJlZW1wdCA/ICJwcmVlbXB0IiA6ICJz
aW1wbGUiLAotCQkgICAgICAgc2xvdFsxXSwgdGltZXN0YW1wKTsKLQkJZXJyID0gLUVJTlZBTDsK
LQl9Ci0KLWVycjoKLQltZW1zZXQzMihzbG90LCAtMSwgNCk7Ci0JaTkxNV9yZXF1ZXN0X3B1dChy
cSk7Ci0JcmV0dXJuIGVycjsKLX0KLQotc3RhdGljIGludCBsaXZlX2xyY190aW1lc3RhbXAodm9p
ZCAqYXJnKQotewotCXN0cnVjdCBscmNfdGltZXN0YW1wIGRhdGEgPSB7fTsKLQlzdHJ1Y3QgaW50
ZWxfZ3QgKmd0ID0gYXJnOwotCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwotCWNvbnN0IHUzMiBw
b2lzb25bXSA9IHsKLQkJMCwKLQkJUzMyX01BWCwKLQkJKHUzMilTMzJfTUFYICsgMSwKLQkJVTMy
X01BWCwKLQl9OwotCi0JLyoKLQkgKiBXZSB3YW50IHRvIHZlcmlmeSB0aGF0IHRoZSB0aW1lc3Rh
bXAgaXMgc2F2ZWQgYW5kIHJlc3RvcmUgYWNyb3NzCi0JICogY29udGV4dCBzd2l0Y2hlcyBhbmQg
aXMgbW9ub3RvbmljLgotCSAqCi0JICogU28gd2UgZG8gdGhpcyB3aXRoIGEgbGl0dGxlIGJpdCBv
ZiBMUkMgcG9pc29uaW5nIHRvIGNoZWNrIHZhcmlvdXMKLQkgKiBib3VuZGFyeSBjb25kaXRpb25z
LCBhbmQgc2VlIHdoYXQgaGFwcGVucyBpZiB3ZSBwcmVlbXB0IHRoZSBjb250ZXh0Ci0JICogd2l0
aCBhIHNlY29uZCByZXF1ZXN0IChjYXJyeWluZyBtb3JlIHBvaXNvbiBpbnRvIHRoZSB0aW1lc3Rh
bXApLgotCSAqLwotCi0JZm9yX2VhY2hfZW5naW5lKGRhdGEuZW5naW5lLCBndCwgaWQpIHsKLQkJ
aW50IGksIGVyciA9IDA7Ci0KLQkJc3RfZW5naW5lX2hlYXJ0YmVhdF9kaXNhYmxlKGRhdGEuZW5n
aW5lKTsKLQotCQlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShkYXRhLmNlKTsgaSsrKSB7Ci0J
CQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqdG1wOwotCi0JCQl0bXAgPSBpbnRlbF9jb250ZXh0X2Ny
ZWF0ZShkYXRhLmVuZ2luZSk7Ci0JCQlpZiAoSVNfRVJSKHRtcCkpIHsKLQkJCQllcnIgPSBQVFJf
RVJSKHRtcCk7Ci0JCQkJZ290byBlcnI7Ci0JCQl9Ci0KLQkJCWVyciA9IGludGVsX2NvbnRleHRf
cGluKHRtcCk7Ci0JCQlpZiAoZXJyKSB7Ci0JCQkJaW50ZWxfY29udGV4dF9wdXQodG1wKTsKLQkJ
CQlnb3RvIGVycjsKLQkJCX0KLQotCQkJZGF0YS5jZVtpXSA9IHRtcDsKLQkJfQotCi0JCWZvciAo
aSA9IDA7IGkgPCBBUlJBWV9TSVpFKHBvaXNvbik7IGkrKykgewotCQkJZGF0YS5wb2lzb24gPSBw
b2lzb25baV07Ci0KLQkJCWVyciA9IF9fbHJjX3RpbWVzdGFtcCgmZGF0YSwgZmFsc2UpOwotCQkJ
aWYgKGVycikKLQkJCQlicmVhazsKLQotCQkJZXJyID0gX19scmNfdGltZXN0YW1wKCZkYXRhLCB0
cnVlKTsKLQkJCWlmIChlcnIpCi0JCQkJYnJlYWs7Ci0JCX0KLQotZXJyOgotCQlzdF9lbmdpbmVf
aGVhcnRiZWF0X2VuYWJsZShkYXRhLmVuZ2luZSk7Ci0JCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9T
SVpFKGRhdGEuY2UpOyBpKyspIHsKLQkJCWlmICghZGF0YS5jZVtpXSkKLQkJCQlicmVhazsKLQot
CQkJaW50ZWxfY29udGV4dF91bnBpbihkYXRhLmNlW2ldKTsKLQkJCWludGVsX2NvbnRleHRfcHV0
KGRhdGEuY2VbaV0pOwotCQl9Ci0KLQkJaWYgKGlndF9mbHVzaF90ZXN0KGd0LT5pOTE1KSkKLQkJ
CWVyciA9IC1FSU87Ci0JCWlmIChlcnIpCi0JCQlyZXR1cm4gZXJyOwotCX0KLQotCXJldHVybiAw
OwotfQotCi1zdGF0aWMgc3RydWN0IGk5MTVfdm1hICoKLWNyZWF0ZV91c2VyX3ZtYShzdHJ1Y3Qg
aTkxNV9hZGRyZXNzX3NwYWNlICp2bSwgdW5zaWduZWQgbG9uZyBzaXplKQotewotCXN0cnVjdCBk
cm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7Ci0Jc3RydWN0IGk5MTVfdm1hICp2bWE7Ci0JaW50IGVy
cjsKLQotCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfaW50ZXJuYWwodm0tPmk5MTUsIHNp
emUpOwotCWlmIChJU19FUlIob2JqKSkKLQkJcmV0dXJuIEVSUl9DQVNUKG9iaik7Ci0KLQl2bWEg
PSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosIHZtLCBOVUxMKTsKLQlpZiAoSVNfRVJSKHZtYSkpIHsK
LQkJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOwotCQlyZXR1cm4gdm1hOwotCX0KLQotCWVyciA9
IGk5MTVfdm1hX3Bpbih2bWEsIDAsIDAsIFBJTl9VU0VSKTsKLQlpZiAoZXJyKSB7Ci0JCWk5MTVf
Z2VtX29iamVjdF9wdXQob2JqKTsKLQkJcmV0dXJuIEVSUl9QVFIoZXJyKTsKLQl9Ci0KLQlyZXR1
cm4gdm1hOwotfQotCi1zdGF0aWMgc3RydWN0IGk5MTVfdm1hICoKLXN0b3JlX2NvbnRleHQoc3Ry
dWN0IGludGVsX2NvbnRleHQgKmNlLCBzdHJ1Y3QgaTkxNV92bWEgKnNjcmF0Y2gpCi17Ci0Jc3Ry
dWN0IGk5MTVfdm1hICpiYXRjaDsKLQl1MzIgZHcsIHgsICpjcywgKmh3OwotCXUzMiAqZGVmYXVs
dHM7Ci0KLQliYXRjaCA9IGNyZWF0ZV91c2VyX3ZtYShjZS0+dm0sIFNaXzY0Syk7Ci0JaWYgKElT
X0VSUihiYXRjaCkpCi0JCXJldHVybiBiYXRjaDsKLQotCWNzID0gaTkxNV9nZW1fb2JqZWN0X3Bp
bl9tYXAoYmF0Y2gtPm9iaiwgSTkxNV9NQVBfV0MpOwotCWlmIChJU19FUlIoY3MpKSB7Ci0JCWk5
MTVfdm1hX3B1dChiYXRjaCk7Ci0JCXJldHVybiBFUlJfQ0FTVChjcyk7Ci0JfQotCi0JZGVmYXVs
dHMgPSBzaG1lbV9waW5fbWFwKGNlLT5lbmdpbmUtPmRlZmF1bHRfc3RhdGUpOwotCWlmICghZGVm
YXVsdHMpIHsKLQkJaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChiYXRjaC0+b2JqKTsKLQkJaTkx
NV92bWFfcHV0KGJhdGNoKTsKLQkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7Ci0JfQotCi0JeCA9
IDA7Ci0JZHcgPSAwOwotCWh3ID0gZGVmYXVsdHM7Ci0JaHcgKz0gTFJDX1NUQVRFX09GRlNFVCAv
IHNpemVvZigqaHcpOwotCWRvIHsKLQkJdTMyIGxlbiA9IGh3W2R3XSAmIDB4N2Y7Ci0KLQkJaWYg
KGh3W2R3XSA9PSAwKSB7Ci0JCQlkdysrOwotCQkJY29udGludWU7Ci0JCX0KLQotCQlpZiAoKGh3
W2R3XSAmIEdFTk1BU0soMzEsIDIzKSkgIT0gTUlfSU5TVFIoMHgyMiwgMCkpIHsKLQkJCWR3ICs9
IGxlbiArIDI7Ci0JCQljb250aW51ZTsKLQkJfQotCi0JCWR3Kys7Ci0JCWxlbiA9IChsZW4gKyAx
KSAvIDI7Ci0JCXdoaWxlIChsZW4tLSkgewotCQkJKmNzKysgPSBNSV9TVE9SRV9SRUdJU1RFUl9N
RU1fR0VOODsKLQkJCSpjcysrID0gaHdbZHddOwotCQkJKmNzKysgPSBsb3dlcl8zMl9iaXRzKHNj
cmF0Y2gtPm5vZGUuc3RhcnQgKyB4KTsKLQkJCSpjcysrID0gdXBwZXJfMzJfYml0cyhzY3JhdGNo
LT5ub2RlLnN0YXJ0ICsgeCk7Ci0KLQkJCWR3ICs9IDI7Ci0JCQl4ICs9IDQ7Ci0JCX0KLQl9IHdo
aWxlIChkdyA8IFBBR0VfU0laRSAvIHNpemVvZih1MzIpICYmCi0JCSAoaHdbZHddICYgfkJJVCgw
KSkgIT0gTUlfQkFUQ0hfQlVGRkVSX0VORCk7Ci0KLQkqY3MrKyA9IE1JX0JBVENIX0JVRkZFUl9F
TkQ7Ci0KLQlzaG1lbV91bnBpbl9tYXAoY2UtPmVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSwgZGVmYXVs
dHMpOwotCi0JaTkxNV9nZW1fb2JqZWN0X2ZsdXNoX21hcChiYXRjaC0+b2JqKTsKLQlpOTE1X2dl
bV9vYmplY3RfdW5waW5fbWFwKGJhdGNoLT5vYmopOwotCi0JcmV0dXJuIGJhdGNoOwotfQotCi1z
dGF0aWMgaW50IG1vdmVfdG9fYWN0aXZlKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAotCQkJICBz
dHJ1Y3QgaTkxNV92bWEgKnZtYSwKLQkJCSAgdW5zaWduZWQgaW50IGZsYWdzKQotewotCWludCBl
cnI7Ci0KLQlpOTE1X3ZtYV9sb2NrKHZtYSk7Ci0JZXJyID0gaTkxNV9yZXF1ZXN0X2F3YWl0X29i
amVjdChycSwgdm1hLT5vYmosIGZsYWdzKTsKLQlpZiAoIWVycikKLQkJZXJyID0gaTkxNV92bWFf
bW92ZV90b19hY3RpdmUodm1hLCBycSwgZmxhZ3MpOwotCWk5MTVfdm1hX3VubG9jayh2bWEpOwot
Ci0JcmV0dXJuIGVycjsKLX0KLQotc3RhdGljIHN0cnVjdCBpOTE1X3JlcXVlc3QgKgotcmVjb3Jk
X3JlZ2lzdGVycyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCi0JCSBzdHJ1Y3QgaTkxNV92bWEg
KmJlZm9yZSwKLQkJIHN0cnVjdCBpOTE1X3ZtYSAqYWZ0ZXIsCi0JCSB1MzIgKnNlbWEpCi17Ci0J
c3RydWN0IGk5MTVfdm1hICpiX2JlZm9yZSwgKmJfYWZ0ZXI7Ci0Jc3RydWN0IGk5MTVfcmVxdWVz
dCAqcnE7Ci0JdTMyICpjczsKLQlpbnQgZXJyOwotCi0JYl9iZWZvcmUgPSBzdG9yZV9jb250ZXh0
KGNlLCBiZWZvcmUpOwotCWlmIChJU19FUlIoYl9iZWZvcmUpKQotCQlyZXR1cm4gRVJSX0NBU1Qo
Yl9iZWZvcmUpOwotCi0JYl9hZnRlciA9IHN0b3JlX2NvbnRleHQoY2UsIGFmdGVyKTsKLQlpZiAo
SVNfRVJSKGJfYWZ0ZXIpKSB7Ci0JCXJxID0gRVJSX0NBU1QoYl9hZnRlcik7Ci0JCWdvdG8gZXJy
X2JlZm9yZTsKLQl9Ci0KLQlycSA9IGludGVsX2NvbnRleHRfY3JlYXRlX3JlcXVlc3QoY2UpOwot
CWlmIChJU19FUlIocnEpKQotCQlnb3RvIGVycl9hZnRlcjsKLQotCWVyciA9IG1vdmVfdG9fYWN0
aXZlKHJxLCBiZWZvcmUsIEVYRUNfT0JKRUNUX1dSSVRFKTsKLQlpZiAoZXJyKQotCQlnb3RvIGVy
cl9ycTsKLQotCWVyciA9IG1vdmVfdG9fYWN0aXZlKHJxLCBiX2JlZm9yZSwgMCk7Ci0JaWYgKGVy
cikKLQkJZ290byBlcnJfcnE7Ci0KLQllcnIgPSBtb3ZlX3RvX2FjdGl2ZShycSwgYWZ0ZXIsIEVY
RUNfT0JKRUNUX1dSSVRFKTsKLQlpZiAoZXJyKQotCQlnb3RvIGVycl9ycTsKLQotCWVyciA9IG1v
dmVfdG9fYWN0aXZlKHJxLCBiX2FmdGVyLCAwKTsKLQlpZiAoZXJyKQotCQlnb3RvIGVycl9ycTsK
LQotCWNzID0gaW50ZWxfcmluZ19iZWdpbihycSwgMTQpOwotCWlmIChJU19FUlIoY3MpKSB7Ci0J
CWVyciA9IFBUUl9FUlIoY3MpOwotCQlnb3RvIGVycl9ycTsKLQl9Ci0KLQkqY3MrKyA9IE1JX0FS
Ql9PTl9PRkYgfCBNSV9BUkJfRElTQUJMRTsKLQkqY3MrKyA9IE1JX0JBVENIX0JVRkZFUl9TVEFS
VF9HRU44IHwgQklUKDgpOwotCSpjcysrID0gbG93ZXJfMzJfYml0cyhiX2JlZm9yZS0+bm9kZS5z
dGFydCk7Ci0JKmNzKysgPSB1cHBlcl8zMl9iaXRzKGJfYmVmb3JlLT5ub2RlLnN0YXJ0KTsKLQot
CSpjcysrID0gTUlfQVJCX09OX09GRiB8IE1JX0FSQl9FTkFCTEU7Ci0JKmNzKysgPSBNSV9TRU1B
UEhPUkVfV0FJVCB8Ci0JCU1JX1NFTUFQSE9SRV9HTE9CQUxfR1RUIHwKLQkJTUlfU0VNQVBIT1JF
X1BPTEwgfAotCQlNSV9TRU1BUEhPUkVfU0FEX05FUV9TREQ7Ci0JKmNzKysgPSAwOwotCSpjcysr
ID0gaTkxNV9nZ3R0X29mZnNldChjZS0+ZW5naW5lLT5zdGF0dXNfcGFnZS52bWEpICsKLQkJb2Zm
c2V0X2luX3BhZ2Uoc2VtYSk7Ci0JKmNzKysgPSAwOwotCSpjcysrID0gTUlfTk9PUDsKLQotCSpj
cysrID0gTUlfQVJCX09OX09GRiB8IE1JX0FSQl9ESVNBQkxFOwotCSpjcysrID0gTUlfQkFUQ0hf
QlVGRkVSX1NUQVJUX0dFTjggfCBCSVQoOCk7Ci0JKmNzKysgPSBsb3dlcl8zMl9iaXRzKGJfYWZ0
ZXItPm5vZGUuc3RhcnQpOwotCSpjcysrID0gdXBwZXJfMzJfYml0cyhiX2FmdGVyLT5ub2RlLnN0
YXJ0KTsKLQotCWludGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOwotCi0JV1JJVEVfT05DRSgqc2Vt
YSwgMCk7Ci0JaTkxNV9yZXF1ZXN0X2dldChycSk7Ci0JaTkxNV9yZXF1ZXN0X2FkZChycSk7Ci1l
cnJfYWZ0ZXI6Ci0JaTkxNV92bWFfcHV0KGJfYWZ0ZXIpOwotZXJyX2JlZm9yZToKLQlpOTE1X3Zt
YV9wdXQoYl9iZWZvcmUpOwotCXJldHVybiBycTsKLQotZXJyX3JxOgotCWk5MTVfcmVxdWVzdF9h
ZGQocnEpOwotCXJxID0gRVJSX1BUUihlcnIpOwotCWdvdG8gZXJyX2FmdGVyOwotfQotCi1zdGF0
aWMgc3RydWN0IGk5MTVfdm1hICpsb2FkX2NvbnRleHQoc3RydWN0IGludGVsX2NvbnRleHQgKmNl
LCB1MzIgcG9pc29uKQotewotCXN0cnVjdCBpOTE1X3ZtYSAqYmF0Y2g7Ci0JdTMyIGR3LCAqY3Ms
ICpodzsKLQl1MzIgKmRlZmF1bHRzOwotCi0JYmF0Y2ggPSBjcmVhdGVfdXNlcl92bWEoY2UtPnZt
LCBTWl82NEspOwotCWlmIChJU19FUlIoYmF0Y2gpKQotCQlyZXR1cm4gYmF0Y2g7Ci0KLQljcyA9
IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKGJhdGNoLT5vYmosIEk5MTVfTUFQX1dDKTsKLQlpZiAo
SVNfRVJSKGNzKSkgewotCQlpOTE1X3ZtYV9wdXQoYmF0Y2gpOwotCQlyZXR1cm4gRVJSX0NBU1Qo
Y3MpOwotCX0KLQotCWRlZmF1bHRzID0gc2htZW1fcGluX21hcChjZS0+ZW5naW5lLT5kZWZhdWx0
X3N0YXRlKTsKLQlpZiAoIWRlZmF1bHRzKSB7Ci0JCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAo
YmF0Y2gtPm9iaik7Ci0JCWk5MTVfdm1hX3B1dChiYXRjaCk7Ci0JCXJldHVybiBFUlJfUFRSKC1F
Tk9NRU0pOwotCX0KLQotCWR3ID0gMDsKLQlodyA9IGRlZmF1bHRzOwotCWh3ICs9IExSQ19TVEFU
RV9PRkZTRVQgLyBzaXplb2YoKmh3KTsKLQlkbyB7Ci0JCXUzMiBsZW4gPSBod1tkd10gJiAweDdm
OwotCi0JCWlmIChod1tkd10gPT0gMCkgewotCQkJZHcrKzsKLQkJCWNvbnRpbnVlOwotCQl9Ci0K
LQkJaWYgKChod1tkd10gJiBHRU5NQVNLKDMxLCAyMykpICE9IE1JX0lOU1RSKDB4MjIsIDApKSB7
Ci0JCQlkdyArPSBsZW4gKyAyOwotCQkJY29udGludWU7Ci0JCX0KLQotCQlkdysrOwotCQlsZW4g
PSAobGVuICsgMSkgLyAyOwotCQkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKGxlbik7Ci0J
CXdoaWxlIChsZW4tLSkgewotCQkJKmNzKysgPSBod1tkd107Ci0JCQkqY3MrKyA9IHBvaXNvbjsK
LQkJCWR3ICs9IDI7Ci0JCX0KLQl9IHdoaWxlIChkdyA8IFBBR0VfU0laRSAvIHNpemVvZih1MzIp
ICYmCi0JCSAoaHdbZHddICYgfkJJVCgwKSkgIT0gTUlfQkFUQ0hfQlVGRkVSX0VORCk7Ci0KLQkq
Y3MrKyA9IE1JX0JBVENIX0JVRkZFUl9FTkQ7Ci0KLQlzaG1lbV91bnBpbl9tYXAoY2UtPmVuZ2lu
ZS0+ZGVmYXVsdF9zdGF0ZSwgZGVmYXVsdHMpOwotCi0JaTkxNV9nZW1fb2JqZWN0X2ZsdXNoX21h
cChiYXRjaC0+b2JqKTsKLQlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKGJhdGNoLT5vYmopOwot
Ci0JcmV0dXJuIGJhdGNoOwotfQotCi1zdGF0aWMgaW50IHBvaXNvbl9yZWdpc3RlcnMoc3RydWN0
IGludGVsX2NvbnRleHQgKmNlLCB1MzIgcG9pc29uLCB1MzIgKnNlbWEpCi17Ci0Jc3RydWN0IGk5
MTVfcmVxdWVzdCAqcnE7Ci0Jc3RydWN0IGk5MTVfdm1hICpiYXRjaDsKLQl1MzIgKmNzOwotCWlu
dCBlcnI7Ci0KLQliYXRjaCA9IGxvYWRfY29udGV4dChjZSwgcG9pc29uKTsKLQlpZiAoSVNfRVJS
KGJhdGNoKSkKLQkJcmV0dXJuIFBUUl9FUlIoYmF0Y2gpOwotCi0JcnEgPSBpbnRlbF9jb250ZXh0
X2NyZWF0ZV9yZXF1ZXN0KGNlKTsKLQlpZiAoSVNfRVJSKHJxKSkgewotCQllcnIgPSBQVFJfRVJS
KHJxKTsKLQkJZ290byBlcnJfYmF0Y2g7Ci0JfQotCi0JZXJyID0gbW92ZV90b19hY3RpdmUocnEs
IGJhdGNoLCAwKTsKLQlpZiAoZXJyKQotCQlnb3RvIGVycl9ycTsKLQotCWNzID0gaW50ZWxfcmlu
Z19iZWdpbihycSwgOCk7Ci0JaWYgKElTX0VSUihjcykpIHsKLQkJZXJyID0gUFRSX0VSUihjcyk7
Ci0JCWdvdG8gZXJyX3JxOwotCX0KLQotCSpjcysrID0gTUlfQVJCX09OX09GRiB8IE1JX0FSQl9E
SVNBQkxFOwotCSpjcysrID0gTUlfQkFUQ0hfQlVGRkVSX1NUQVJUX0dFTjggfCBCSVQoOCk7Ci0J
KmNzKysgPSBsb3dlcl8zMl9iaXRzKGJhdGNoLT5ub2RlLnN0YXJ0KTsKLQkqY3MrKyA9IHVwcGVy
XzMyX2JpdHMoYmF0Y2gtPm5vZGUuc3RhcnQpOwotCi0JKmNzKysgPSBNSV9TVE9SRV9EV09SRF9J
TU1fR0VONCB8IE1JX1VTRV9HR1RUOwotCSpjcysrID0gaTkxNV9nZ3R0X29mZnNldChjZS0+ZW5n
aW5lLT5zdGF0dXNfcGFnZS52bWEpICsKLQkJb2Zmc2V0X2luX3BhZ2Uoc2VtYSk7Ci0JKmNzKysg
PSAwOwotCSpjcysrID0gMTsKLQotCWludGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOwotCi0JcnEt
PnNjaGVkLmF0dHIucHJpb3JpdHkgPSBJOTE1X1BSSU9SSVRZX0JBUlJJRVI7Ci1lcnJfcnE6Ci0J
aTkxNV9yZXF1ZXN0X2FkZChycSk7Ci1lcnJfYmF0Y2g6Ci0JaTkxNV92bWFfcHV0KGJhdGNoKTsK
LQlyZXR1cm4gZXJyOwotfQotCi1zdGF0aWMgYm9vbCBpc19tb3ZpbmcodTMyIGEsIHUzMiBiKQot
ewotCXJldHVybiBhICE9IGI7Ci19Ci0KLXN0YXRpYyBpbnQgY29tcGFyZV9pc29sYXRpb24oc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAotCQkJICAgICBzdHJ1Y3QgaTkxNV92bWEgKnJl
ZlsyXSwKLQkJCSAgICAgc3RydWN0IGk5MTVfdm1hICpyZXN1bHRbMl0sCi0JCQkgICAgIHN0cnVj
dCBpbnRlbF9jb250ZXh0ICpjZSwKLQkJCSAgICAgdTMyIHBvaXNvbikKLXsKLQl1MzIgeCwgZHcs
ICpodywgKmxyYzsKLQl1MzIgKkFbMl0sICpCWzJdOwotCXUzMiAqZGVmYXVsdHM7Ci0JaW50IGVy
ciA9IDA7Ci0KLQlBWzBdID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAocmVmWzBdLT5vYmosIEk5
MTVfTUFQX1dDKTsKLQlpZiAoSVNfRVJSKEFbMF0pKQotCQlyZXR1cm4gUFRSX0VSUihBWzBdKTsK
LQotCUFbMV0gPSBpOTE1X2dlbV9vYmplY3RfcGluX21hcChyZWZbMV0tPm9iaiwgSTkxNV9NQVBf
V0MpOwotCWlmIChJU19FUlIoQVsxXSkpIHsKLQkJZXJyID0gUFRSX0VSUihBWzFdKTsKLQkJZ290
byBlcnJfQTA7Ci0JfQotCi0JQlswXSA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKHJlc3VsdFsw
XS0+b2JqLCBJOTE1X01BUF9XQyk7Ci0JaWYgKElTX0VSUihCWzBdKSkgewotCQllcnIgPSBQVFJf
RVJSKEJbMF0pOwotCQlnb3RvIGVycl9BMTsKLQl9Ci0KLQlCWzFdID0gaTkxNV9nZW1fb2JqZWN0
X3Bpbl9tYXAocmVzdWx0WzFdLT5vYmosIEk5MTVfTUFQX1dDKTsKLQlpZiAoSVNfRVJSKEJbMV0p
KSB7Ci0JCWVyciA9IFBUUl9FUlIoQlsxXSk7Ci0JCWdvdG8gZXJyX0IwOwotCX0KLQotCWxyYyA9
IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKGNlLT5zdGF0ZS0+b2JqLAotCQkJCSAgICAgIGk5MTVf
Y29oZXJlbnRfbWFwX3R5cGUoZW5naW5lLT5pOTE1KSk7Ci0JaWYgKElTX0VSUihscmMpKSB7Ci0J
CWVyciA9IFBUUl9FUlIobHJjKTsKLQkJZ290byBlcnJfQjE7Ci0JfQotCWxyYyArPSBMUkNfU1RB
VEVfT0ZGU0VUIC8gc2l6ZW9mKCpodyk7Ci0KLQlkZWZhdWx0cyA9IHNobWVtX3Bpbl9tYXAoY2Ut
PmVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSk7Ci0JaWYgKCFkZWZhdWx0cykgewotCQllcnIgPSAtRU5P
TUVNOwotCQlnb3RvIGVycl9scmM7Ci0JfQotCi0JeCA9IDA7Ci0JZHcgPSAwOwotCWh3ID0gZGVm
YXVsdHM7Ci0JaHcgKz0gTFJDX1NUQVRFX09GRlNFVCAvIHNpemVvZigqaHcpOwotCWRvIHsKLQkJ
dTMyIGxlbiA9IGh3W2R3XSAmIDB4N2Y7Ci0KLQkJaWYgKGh3W2R3XSA9PSAwKSB7Ci0JCQlkdysr
OwotCQkJY29udGludWU7Ci0JCX0KLQotCQlpZiAoKGh3W2R3XSAmIEdFTk1BU0soMzEsIDIzKSkg
IT0gTUlfSU5TVFIoMHgyMiwgMCkpIHsKLQkJCWR3ICs9IGxlbiArIDI7Ci0JCQljb250aW51ZTsK
LQkJfQotCi0JCWR3Kys7Ci0JCWxlbiA9IChsZW4gKyAxKSAvIDI7Ci0JCXdoaWxlIChsZW4tLSkg
ewotCQkJaWYgKCFpc19tb3ZpbmcoQVswXVt4XSwgQVsxXVt4XSkgJiYKLQkJCSAgICAoQVswXVt4
XSAhPSBCWzBdW3hdIHx8IEFbMV1beF0gIT0gQlsxXVt4XSkpIHsKLQkJCQlzd2l0Y2ggKGh3W2R3
XSAmIDQwOTUpIHsKLQkJCQljYXNlIDB4MzA6IC8qIFJJTkdfSEVBRCAqLwotCQkJCWNhc2UgMHgz
NDogLyogUklOR19UQUlMICovCi0JCQkJCWJyZWFrOwotCi0JCQkJZGVmYXVsdDoKLQkJCQkJcHJf
ZXJyKCIlc1slZF06IE1pc21hdGNoIGZvciByZWdpc3RlciAlNHgsIGRlZmF1bHQgJTA4eCwgcmVm
ZXJlbmNlICUwOHgsIHJlc3VsdCAoJTA4eCwgJTA4eCksIHBvaXNvbiAlMDh4LCBjb250ZXh0ICUw
OHhcbiIsCi0JCQkJCSAgICAgICBlbmdpbmUtPm5hbWUsIGR3LAotCQkJCQkgICAgICAgaHdbZHdd
LCBod1tkdyArIDFdLAotCQkJCQkgICAgICAgQVswXVt4XSwgQlswXVt4XSwgQlsxXVt4XSwKLQkJ
CQkJICAgICAgIHBvaXNvbiwgbHJjW2R3ICsgMV0pOwotCQkJCQllcnIgPSAtRUlOVkFMOwotCQkJ
CX0KLQkJCX0KLQkJCWR3ICs9IDI7Ci0JCQl4Kys7Ci0JCX0KLQl9IHdoaWxlIChkdyA8IFBBR0Vf
U0laRSAvIHNpemVvZih1MzIpICYmCi0JCSAoaHdbZHddICYgfkJJVCgwKSkgIT0gTUlfQkFUQ0hf
QlVGRkVSX0VORCk7Ci0KLQlzaG1lbV91bnBpbl9tYXAoY2UtPmVuZ2luZS0+ZGVmYXVsdF9zdGF0
ZSwgZGVmYXVsdHMpOwotZXJyX2xyYzoKLQlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKGNlLT5z
dGF0ZS0+b2JqKTsKLWVycl9CMToKLQlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHJlc3VsdFsx
XS0+b2JqKTsKLWVycl9CMDoKLQlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHJlc3VsdFswXS0+
b2JqKTsKLWVycl9BMToKLQlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHJlZlsxXS0+b2JqKTsK
LWVycl9BMDoKLQlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHJlZlswXS0+b2JqKTsKLQlyZXR1
cm4gZXJyOwotfQotCi1zdGF0aWMgaW50IF9fbHJjX2lzb2xhdGlvbihzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmUsIHUzMiBwb2lzb24pCi17Ci0JdTMyICpzZW1hID0gbWVtc2V0MzIoZW5n
aW5lLT5zdGF0dXNfcGFnZS5hZGRyICsgMTAwMCwgMCwgMSk7Ci0Jc3RydWN0IGk5MTVfdm1hICpy
ZWZbMl0sICpyZXN1bHRbMl07Ci0Jc3RydWN0IGludGVsX2NvbnRleHQgKkEsICpCOwotCXN0cnVj
dCBpOTE1X3JlcXVlc3QgKnJxOwotCWludCBlcnI7Ci0KLQlBID0gaW50ZWxfY29udGV4dF9jcmVh
dGUoZW5naW5lKTsKLQlpZiAoSVNfRVJSKEEpKQotCQlyZXR1cm4gUFRSX0VSUihBKTsKLQotCUIg
PSBpbnRlbF9jb250ZXh0X2NyZWF0ZShlbmdpbmUpOwotCWlmIChJU19FUlIoQikpIHsKLQkJZXJy
ID0gUFRSX0VSUihCKTsKLQkJZ290byBlcnJfQTsKLQl9Ci0KLQlyZWZbMF0gPSBjcmVhdGVfdXNl
cl92bWEoQS0+dm0sIFNaXzY0Syk7Ci0JaWYgKElTX0VSUihyZWZbMF0pKSB7Ci0JCWVyciA9IFBU
Ul9FUlIocmVmWzBdKTsKLQkJZ290byBlcnJfQjsKLQl9Ci0KLQlyZWZbMV0gPSBjcmVhdGVfdXNl
cl92bWEoQS0+dm0sIFNaXzY0Syk7Ci0JaWYgKElTX0VSUihyZWZbMV0pKSB7Ci0JCWVyciA9IFBU
Ul9FUlIocmVmWzFdKTsKLQkJZ290byBlcnJfcmVmMDsKLQl9Ci0KLQlycSA9IHJlY29yZF9yZWdp
c3RlcnMoQSwgcmVmWzBdLCByZWZbMV0sIHNlbWEpOwotCWlmIChJU19FUlIocnEpKSB7Ci0JCWVy
ciA9IFBUUl9FUlIocnEpOwotCQlnb3RvIGVycl9yZWYxOwotCX0KLQotCVdSSVRFX09OQ0UoKnNl
bWEsIDEpOwotCXdtYigpOwotCi0JaWYgKGk5MTVfcmVxdWVzdF93YWl0KHJxLCAwLCBIWiAvIDIp
IDwgMCkgewotCQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKLQkJZXJyID0gLUVUSU1FOwotCQlnb3Rv
IGVycl9yZWYxOwotCX0KLQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKLQotCXJlc3VsdFswXSA9IGNy
ZWF0ZV91c2VyX3ZtYShBLT52bSwgU1pfNjRLKTsKLQlpZiAoSVNfRVJSKHJlc3VsdFswXSkpIHsK
LQkJZXJyID0gUFRSX0VSUihyZXN1bHRbMF0pOwotCQlnb3RvIGVycl9yZWYxOwotCX0KLQotCXJl
c3VsdFsxXSA9IGNyZWF0ZV91c2VyX3ZtYShBLT52bSwgU1pfNjRLKTsKLQlpZiAoSVNfRVJSKHJl
c3VsdFsxXSkpIHsKLQkJZXJyID0gUFRSX0VSUihyZXN1bHRbMV0pOwotCQlnb3RvIGVycl9yZXN1
bHQwOwotCX0KLQotCXJxID0gcmVjb3JkX3JlZ2lzdGVycyhBLCByZXN1bHRbMF0sIHJlc3VsdFsx
XSwgc2VtYSk7Ci0JaWYgKElTX0VSUihycSkpIHsKLQkJZXJyID0gUFRSX0VSUihycSk7Ci0JCWdv
dG8gZXJyX3Jlc3VsdDE7Ci0JfQotCi0JZXJyID0gcG9pc29uX3JlZ2lzdGVycyhCLCBwb2lzb24s
IHNlbWEpOwotCWlmIChlcnIpIHsKLQkJV1JJVEVfT05DRSgqc2VtYSwgLTEpOwotCQlpOTE1X3Jl
cXVlc3RfcHV0KHJxKTsKLQkJZ290byBlcnJfcmVzdWx0MTsKLQl9Ci0KLQlpZiAoaTkxNV9yZXF1
ZXN0X3dhaXQocnEsIDAsIEhaIC8gMikgPCAwKSB7Ci0JCWk5MTVfcmVxdWVzdF9wdXQocnEpOwot
CQllcnIgPSAtRVRJTUU7Ci0JCWdvdG8gZXJyX3Jlc3VsdDE7Ci0JfQotCWk5MTVfcmVxdWVzdF9w
dXQocnEpOwotCi0JZXJyID0gY29tcGFyZV9pc29sYXRpb24oZW5naW5lLCByZWYsIHJlc3VsdCwg
QSwgcG9pc29uKTsKLQotZXJyX3Jlc3VsdDE6Ci0JaTkxNV92bWFfcHV0KHJlc3VsdFsxXSk7Ci1l
cnJfcmVzdWx0MDoKLQlpOTE1X3ZtYV9wdXQocmVzdWx0WzBdKTsKLWVycl9yZWYxOgotCWk5MTVf
dm1hX3B1dChyZWZbMV0pOwotZXJyX3JlZjA6Ci0JaTkxNV92bWFfcHV0KHJlZlswXSk7Ci1lcnJf
QjoKLQlpbnRlbF9jb250ZXh0X3B1dChCKTsKLWVycl9BOgotCWludGVsX2NvbnRleHRfcHV0KEEp
OwotCXJldHVybiBlcnI7Ci19Ci0KLXN0YXRpYyBib29sIHNraXBfaXNvbGF0aW9uKGNvbnN0IHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKLXsKLQlpZiAoZW5naW5lLT5jbGFzcyA9PSBD
T1BZX0VOR0lORV9DTEFTUyAmJiBJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA9PSA5KQotCQlyZXR1
cm4gdHJ1ZTsKLQotCWlmIChlbmdpbmUtPmNsYXNzID09IFJFTkRFUl9DTEFTUyAmJiBJTlRFTF9H
RU4oZW5naW5lLT5pOTE1KSA9PSAxMSkKLQkJcmV0dXJuIHRydWU7Ci0KLQlyZXR1cm4gZmFsc2U7
Ci19Ci0KLXN0YXRpYyBpbnQgbGl2ZV9scmNfaXNvbGF0aW9uKHZvaWQgKmFyZykKLXsKLQlzdHJ1
Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOwotCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsK
LQllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKLQljb25zdCB1MzIgcG9pc29uW10gPSB7Ci0JCVNU
QUNLX01BR0lDLAotCQkweDNhM2EzYTNhLAotCQkweDVjNWM1YzVjLAotCQkweGZmZmZmZmZmLAot
CQkweGZmZmYwMDAwLAotCX07Ci0JaW50IGVyciA9IDA7Ci0KLQkvKgotCSAqIE91ciBnb2FsIGlz
IHRyeSBhbmQgdmVyaWZ5IHRoYXQgcGVyLWNvbnRleHQgc3RhdGUgY2Fubm90IGJlCi0JICogdGFt
cGVyZWQgd2l0aCBieSBhbm90aGVyIG5vbi1wcml2aWxlZ2VkIGNsaWVudC4KLQkgKgotCSAqIFdl
IHRha2UgdGhlIGxpc3Qgb2YgY29udGV4dCByZWdpc3RlcnMgZnJvbSB0aGUgTFJJIGluIHRoZSBk
ZWZhdWx0Ci0JICogY29udGV4dCBpbWFnZSBhbmQgYXR0ZW1wdCB0byBtb2RpZnkgdGhhdCBsaXN0
IGZyb20gYSByZW1vdGUgY29udGV4dC4KLQkgKi8KLQotCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUs
IGd0LCBpZCkgewotCQlpbnQgaTsKLQotCQkvKiBKdXN0IGRvbid0IGV2ZW4gYXNrICovCi0JCWlm
ICghSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfU0VMRlRFU1RfQlJPS0VOKSAmJgotCQkgICAg
c2tpcF9pc29sYXRpb24oZW5naW5lKSkKLQkJCWNvbnRpbnVlOwotCi0JCWludGVsX2VuZ2luZV9w
bV9nZXQoZW5naW5lKTsKLQkJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUocG9pc29uKTsgaSsr
KSB7Ci0JCQlpbnQgcmVzdWx0OwotCi0JCQlyZXN1bHQgPSBfX2xyY19pc29sYXRpb24oZW5naW5l
LCBwb2lzb25baV0pOwotCQkJaWYgKHJlc3VsdCAmJiAhZXJyKQotCQkJCWVyciA9IHJlc3VsdDsK
LQotCQkJcmVzdWx0ID0gX19scmNfaXNvbGF0aW9uKGVuZ2luZSwgfnBvaXNvbltpXSk7Ci0JCQlp
ZiAocmVzdWx0ICYmICFlcnIpCi0JCQkJZXJyID0gcmVzdWx0OwotCQl9Ci0JCWludGVsX2VuZ2lu
ZV9wbV9wdXQoZW5naW5lKTsKLQkJaWYgKGlndF9mbHVzaF90ZXN0KGd0LT5pOTE1KSkgewotCQkJ
ZXJyID0gLUVJTzsKLQkJCWJyZWFrOwotCQl9Ci0JfQotCi0JcmV0dXJuIGVycjsKLX0KLQotc3Rh
dGljIGludCBpbmRpcmVjdF9jdHhfc3VibWl0X3JlcShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2Up
Ci17Ci0Jc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7Ci0JaW50IGVyciA9IDA7Ci0KLQlycSA9IGlu
dGVsX2NvbnRleHRfY3JlYXRlX3JlcXVlc3QoY2UpOwotCWlmIChJU19FUlIocnEpKQotCQlyZXR1
cm4gUFRSX0VSUihycSk7Ci0KLQlpOTE1X3JlcXVlc3RfZ2V0KHJxKTsKLQlpOTE1X3JlcXVlc3Rf
YWRkKHJxKTsKLQotCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgSFogLyA1KSA8IDApCi0J
CWVyciA9IC1FVElNRTsKLQotCWk5MTVfcmVxdWVzdF9wdXQocnEpOwotCi0JcmV0dXJuIGVycjsK
LX0KLQotI2RlZmluZSBDVFhfQkJfQ0FOQVJZX09GRlNFVCAoMyAqIDEwMjQpCi0jZGVmaW5lIENU
WF9CQl9DQU5BUllfSU5ERVggIChDVFhfQkJfQ0FOQVJZX09GRlNFVCAvIHNpemVvZih1MzIpKQot
Ci1zdGF0aWMgdTMyICoKLWVtaXRfaW5kaXJlY3RfY3R4X2JiX2NhbmFyeShjb25zdCBzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqY2UsIHUzMiAqY3MpCi17Ci0JKmNzKysgPSBNSV9TVE9SRV9SRUdJU1RF
Ul9NRU1fR0VOOCB8Ci0JCU1JX1NSTV9MUk1fR0xPQkFMX0dUVCB8Ci0JCU1JX0xSSV9MUk1fQ1Nf
TU1JTzsKLQkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfU1RBUlQoMCkpOwotCSpj
cysrID0gaTkxNV9nZ3R0X29mZnNldChjZS0+c3RhdGUpICsKLQkJY29udGV4dF93YV9iYl9vZmZz
ZXQoY2UpICsKLQkJQ1RYX0JCX0NBTkFSWV9PRkZTRVQ7Ci0JKmNzKysgPSAwOwotCi0JcmV0dXJu
IGNzOwotfQotCi1zdGF0aWMgdm9pZAotaW5kaXJlY3RfY3R4X2JiX3NldHVwKHN0cnVjdCBpbnRl
bF9jb250ZXh0ICpjZSkKLXsKLQl1MzIgKmNzID0gY29udGV4dF9pbmRpcmVjdF9iYihjZSk7Ci0K
LQljc1tDVFhfQkJfQ0FOQVJZX0lOREVYXSA9IDB4ZGVhZGYwMGQ7Ci0KLQlzZXR1cF9pbmRpcmVj
dF9jdHhfYmIoY2UsIGNlLT5lbmdpbmUsIGVtaXRfaW5kaXJlY3RfY3R4X2JiX2NhbmFyeSk7Ci19
Ci0KLXN0YXRpYyBib29sIGNoZWNrX3Jpbmdfc3RhcnQoc3RydWN0IGludGVsX2NvbnRleHQgKmNl
KQotewotCWNvbnN0IHUzMiAqIGNvbnN0IGN0eF9iYiA9ICh2b2lkICopKGNlLT5scmNfcmVnX3N0
YXRlKSAtCi0JCUxSQ19TVEFURV9PRkZTRVQgKyBjb250ZXh0X3dhX2JiX29mZnNldChjZSk7Ci0K
LQlpZiAoY3R4X2JiW0NUWF9CQl9DQU5BUllfSU5ERVhdID09IGNlLT5scmNfcmVnX3N0YXRlW0NU
WF9SSU5HX1NUQVJUXSkKLQkJcmV0dXJuIHRydWU7Ci0KLQlwcl9lcnIoInJpbmcgc3RhcnQgbWlz
bWF0Y2g6IGNhbmFyeSAweCUwOHggdnMgc3RhdGUgMHglMDh4XG4iLAotCSAgICAgICBjdHhfYmJb
Q1RYX0JCX0NBTkFSWV9JTkRFWF0sCi0JICAgICAgIGNlLT5scmNfcmVnX3N0YXRlW0NUWF9SSU5H
X1NUQVJUXSk7Ci0KLQlyZXR1cm4gZmFsc2U7Ci19Ci0KLXN0YXRpYyBpbnQgaW5kaXJlY3RfY3R4
X2JiX2NoZWNrKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKLXsKLQlpbnQgZXJyOwotCi0JZXJy
ID0gaW5kaXJlY3RfY3R4X3N1Ym1pdF9yZXEoY2UpOwotCWlmIChlcnIpCi0JCXJldHVybiBlcnI7
Ci0KLQlpZiAoIWNoZWNrX3Jpbmdfc3RhcnQoY2UpKQotCQlyZXR1cm4gLUVJTlZBTDsKLQotCXJl
dHVybiAwOwotfQotCi1zdGF0aWMgaW50IF9fbGl2ZV9scmNfaW5kaXJlY3RfY3R4X2JiKHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKLXsKLQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqYSwg
KmI7Ci0JaW50IGVycjsKLQotCWEgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZShlbmdpbmUpOwotCWlm
IChJU19FUlIoYSkpCi0JCXJldHVybiBQVFJfRVJSKGEpOwotCWVyciA9IGludGVsX2NvbnRleHRf
cGluKGEpOwotCWlmIChlcnIpCi0JCWdvdG8gcHV0X2E7Ci0KLQliID0gaW50ZWxfY29udGV4dF9j
cmVhdGUoZW5naW5lKTsKLQlpZiAoSVNfRVJSKGIpKSB7Ci0JCWVyciA9IFBUUl9FUlIoYik7Ci0J
CWdvdG8gdW5waW5fYTsKLQl9Ci0JZXJyID0gaW50ZWxfY29udGV4dF9waW4oYik7Ci0JaWYgKGVy
cikKLQkJZ290byBwdXRfYjsKLQotCS8qIFdlIHVzZSB0aGUgYWxyZWFkeSByZXNlcnZlZCBleHRy
YSBwYWdlIGluIGNvbnRleHQgc3RhdGUgKi8KLQlpZiAoIWEtPndhX2JiX3BhZ2UpIHsKLQkJR0VN
X0JVR19PTihiLT53YV9iYl9wYWdlKTsKLQkJR0VNX0JVR19PTihJTlRFTF9HRU4oZW5naW5lLT5p
OTE1KSA9PSAxMik7Ci0JCWdvdG8gdW5waW5fYjsKLQl9Ci0KLQkvKgotCSAqIEluIG9yZGVyIHRv
IHRlc3QgdGhhdCBvdXIgcGVyIGNvbnRleHQgYmIgaXMgdHJ1bHkgcGVyIGNvbnRleHQsCi0JICog
YW5kIGV4ZWN1dGVzIGF0IHRoZSBpbnRlbmRlZCBzcG90IG9uIGNvbnRleHQgcmVzdG9yaW5nIHBy
b2Nlc3MsCi0JICogbWFrZSB0aGUgYmF0Y2ggc3RvcmUgdGhlIHJpbmcgc3RhcnQgdmFsdWUgdG8g
bWVtb3J5LgotCSAqIEFzIHJpbmcgc3RhcnQgaXMgcmVzdG9yZWQgYXByaW9yaSBvZiBzdGFydGlu
ZyB0aGUgaW5kaXJlY3QgY3R4IGJiIGFuZAotCSAqIGFzIGl0IHdpbGwgYmUgZGlmZmVyZW50IGZv
ciBlYWNoIGNvbnRleHQsIGl0IGZpdHMgdG8gdGhpcyBwdXJwb3NlLgotCSAqLwotCWluZGlyZWN0
X2N0eF9iYl9zZXR1cChhKTsKLQlpbmRpcmVjdF9jdHhfYmJfc2V0dXAoYik7Ci0KLQllcnIgPSBp
bmRpcmVjdF9jdHhfYmJfY2hlY2soYSk7Ci0JaWYgKGVycikKLQkJZ290byB1bnBpbl9iOwotCi0J
ZXJyID0gaW5kaXJlY3RfY3R4X2JiX2NoZWNrKGIpOwotCi11bnBpbl9iOgotCWludGVsX2NvbnRl
eHRfdW5waW4oYik7Ci1wdXRfYjoKLQlpbnRlbF9jb250ZXh0X3B1dChiKTsKLXVucGluX2E6Ci0J
aW50ZWxfY29udGV4dF91bnBpbihhKTsKLXB1dF9hOgotCWludGVsX2NvbnRleHRfcHV0KGEpOwot
Ci0JcmV0dXJuIGVycjsKLX0KLQotc3RhdGljIGludCBsaXZlX2xyY19pbmRpcmVjdF9jdHhfYmIo
dm9pZCAqYXJnKQotewotCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7Ci0Jc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lOwotCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwotCWludCBlcnIg
PSAwOwotCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7Ci0JCWludGVsX2VuZ2lu
ZV9wbV9nZXQoZW5naW5lKTsKLQkJZXJyID0gX19saXZlX2xyY19pbmRpcmVjdF9jdHhfYmIoZW5n
aW5lKTsKLQkJaW50ZWxfZW5naW5lX3BtX3B1dChlbmdpbmUpOwotCi0JCWlmIChpZ3RfZmx1c2hf
dGVzdChndC0+aTkxNSkpCi0JCQllcnIgPSAtRUlPOwotCi0JCWlmIChlcnIpCi0JCQlicmVhazsK
LQl9Ci0KLQlyZXR1cm4gZXJyOwotfQotCi1zdGF0aWMgdm9pZCBnYXJiYWdlX3Jlc2V0KHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCSAgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEp
Ci17Ci0JY29uc3QgdW5zaWduZWQgaW50IGJpdCA9IEk5MTVfUkVTRVRfRU5HSU5FICsgZW5naW5l
LT5pZDsKLQl1bnNpZ25lZCBsb25nICpsb2NrID0gJmVuZ2luZS0+Z3QtPnJlc2V0LmZsYWdzOwot
Ci0JaWYgKHRlc3RfYW5kX3NldF9iaXQoYml0LCBsb2NrKSkKLQkJcmV0dXJuOwotCi0JdGFza2xl
dF9kaXNhYmxlKCZlbmdpbmUtPmV4ZWNsaXN0cy50YXNrbGV0KTsKLQotCWlmICghcnEtPmZlbmNl
LmVycm9yKQotCQlpbnRlbF9lbmdpbmVfcmVzZXQoZW5naW5lLCBOVUxMKTsKLQotCXRhc2tsZXRf
ZW5hYmxlKCZlbmdpbmUtPmV4ZWNsaXN0cy50YXNrbGV0KTsKLQljbGVhcl9hbmRfd2FrZV91cF9i
aXQoYml0LCBsb2NrKTsKLX0KLQotc3RhdGljIHN0cnVjdCBpOTE1X3JlcXVlc3QgKmdhcmJhZ2Uo
c3RydWN0IGludGVsX2NvbnRleHQgKmNlLAotCQkJCSAgICBzdHJ1Y3Qgcm5kX3N0YXRlICpwcm5n
KQotewotCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOwotCWludCBlcnI7Ci0KLQllcnIgPSBpbnRl
bF9jb250ZXh0X3BpbihjZSk7Ci0JaWYgKGVycikKLQkJcmV0dXJuIEVSUl9QVFIoZXJyKTsKLQot
CXByYW5kb21fYnl0ZXNfc3RhdGUocHJuZywKLQkJCSAgICBjZS0+bHJjX3JlZ19zdGF0ZSwKLQkJ
CSAgICBjZS0+ZW5naW5lLT5jb250ZXh0X3NpemUgLQotCQkJICAgIExSQ19TVEFURV9PRkZTRVQp
OwotCi0JcnEgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZV9yZXF1ZXN0KGNlKTsKLQlpZiAoSVNfRVJS
KHJxKSkgewotCQllcnIgPSBQVFJfRVJSKHJxKTsKLQkJZ290byBlcnJfdW5waW47Ci0JfQotCi0J
aTkxNV9yZXF1ZXN0X2dldChycSk7Ci0JaTkxNV9yZXF1ZXN0X2FkZChycSk7Ci0JcmV0dXJuIHJx
OwotCi1lcnJfdW5waW46Ci0JaW50ZWxfY29udGV4dF91bnBpbihjZSk7Ci0JcmV0dXJuIEVSUl9Q
VFIoZXJyKTsKLX0KLQotc3RhdGljIGludCBfX2xyY19nYXJiYWdlKHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSwgc3RydWN0IHJuZF9zdGF0ZSAqcHJuZykKLXsKLQlzdHJ1Y3QgaW50ZWxf
Y29udGV4dCAqY2U7Ci0Jc3RydWN0IGk5MTVfcmVxdWVzdCAqaGFuZzsKLQlpbnQgZXJyID0gMDsK
LQotCWNlID0gaW50ZWxfY29udGV4dF9jcmVhdGUoZW5naW5lKTsKLQlpZiAoSVNfRVJSKGNlKSkK
LQkJcmV0dXJuIFBUUl9FUlIoY2UpOwotCi0JaGFuZyA9IGdhcmJhZ2UoY2UsIHBybmcpOwotCWlm
IChJU19FUlIoaGFuZykpIHsKLQkJZXJyID0gUFRSX0VSUihoYW5nKTsKLQkJZ290byBlcnJfY2U7
Ci0JfQotCi0JaWYgKHdhaXRfZm9yX3N1Ym1pdChlbmdpbmUsIGhhbmcsIEhaIC8gMikpIHsKLQkJ
aTkxNV9yZXF1ZXN0X3B1dChoYW5nKTsKLQkJZXJyID0gLUVUSU1FOwotCQlnb3RvIGVycl9jZTsK
LQl9Ci0KLQlpbnRlbF9jb250ZXh0X3NldF9iYW5uZWQoY2UpOwotCWdhcmJhZ2VfcmVzZXQoZW5n
aW5lLCBoYW5nKTsKLQotCWludGVsX2VuZ2luZV9mbHVzaF9zdWJtaXNzaW9uKGVuZ2luZSk7Ci0J
aWYgKCFoYW5nLT5mZW5jZS5lcnJvcikgewotCQlpOTE1X3JlcXVlc3RfcHV0KGhhbmcpOwotCQlw
cl9lcnIoIiVzOiBjb3JydXB0ZWQgY29udGV4dCB3YXMgbm90IHJlc2V0XG4iLAotCQkgICAgICAg
ZW5naW5lLT5uYW1lKTsKLQkJZXJyID0gLUVJTlZBTDsKLQkJZ290byBlcnJfY2U7Ci0JfQotCi0J
aWYgKGk5MTVfcmVxdWVzdF93YWl0KGhhbmcsIDAsIEhaIC8gMikgPCAwKSB7Ci0JCXByX2Vycigi
JXM6IGNvcnJ1cHRlZCBjb250ZXh0IGRpZCBub3QgcmVjb3ZlclxuIiwKLQkJICAgICAgIGVuZ2lu
ZS0+bmFtZSk7Ci0JCWk5MTVfcmVxdWVzdF9wdXQoaGFuZyk7Ci0JCWVyciA9IC1FSU87Ci0JCWdv
dG8gZXJyX2NlOwotCX0KLQlpOTE1X3JlcXVlc3RfcHV0KGhhbmcpOwotCi1lcnJfY2U6Ci0JaW50
ZWxfY29udGV4dF9wdXQoY2UpOwotCXJldHVybiBlcnI7Ci19Ci0KLXN0YXRpYyBpbnQgbGl2ZV9s
cmNfZ2FyYmFnZSh2b2lkICphcmcpCi17Ci0Jc3RydWN0IGludGVsX2d0ICpndCA9IGFyZzsKLQlz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0JZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7
Ci0KLQkvKgotCSAqIFZlcmlmeSB0aGF0IHdlIGNhbiByZWNvdmVyIGlmIG9uZSBjb250ZXh0IHN0
YXRlIGlzIGNvbXBsZXRlbHkKLQkgKiBjb3JydXB0ZWQuCi0JICovCi0KLQlpZiAoIUlTX0VOQUJM
RUQoQ09ORklHX0RSTV9JOTE1X1NFTEZURVNUX0JST0tFTikpCi0JCXJldHVybiAwOwotCi0JZm9y
X2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7Ci0JCUk5MTVfUk5EX1NUQVRFKHBybmcpOwot
CQlpbnQgZXJyID0gMCwgaTsKLQotCQlpZiAoIWludGVsX2hhc19yZXNldF9lbmdpbmUoZW5naW5l
LT5ndCkpCi0JCQljb250aW51ZTsKLQotCQlpbnRlbF9lbmdpbmVfcG1fZ2V0KGVuZ2luZSk7Ci0J
CWZvciAoaSA9IDA7IGkgPCAzOyBpKyspIHsKLQkJCWVyciA9IF9fbHJjX2dhcmJhZ2UoZW5naW5l
LCAmcHJuZyk7Ci0JCQlpZiAoZXJyKQotCQkJCWJyZWFrOwotCQl9Ci0JCWludGVsX2VuZ2luZV9w
bV9wdXQoZW5naW5lKTsKLQotCQlpZiAoaWd0X2ZsdXNoX3Rlc3QoZ3QtPmk5MTUpKQotCQkJZXJy
ID0gLUVJTzsKLQkJaWYgKGVycikKLQkJCXJldHVybiBlcnI7Ci0JfQotCi0JcmV0dXJuIDA7Ci19
Ci0KLXN0YXRpYyBpbnQgX19saXZlX3BwaHdzcF9ydW50aW1lKHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSkKLXsKLQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7Ci0Jc3RydWN0IGk5MTVf
cmVxdWVzdCAqcnE7Ci0JSUdUX1RJTUVPVVQoZW5kX3RpbWUpOwotCWludCBlcnI7Ci0KLQljZSA9
IGludGVsX2NvbnRleHRfY3JlYXRlKGVuZ2luZSk7Ci0JaWYgKElTX0VSUihjZSkpCi0JCXJldHVy
biBQVFJfRVJSKGNlKTsKLQotCWNlLT5ydW50aW1lLm51bV91bmRlcmZsb3cgPSAwOwotCWNlLT5y
dW50aW1lLm1heF91bmRlcmZsb3cgPSAwOwotCi0JZG8gewotCQl1bnNpZ25lZCBpbnQgbG9vcCA9
IDEwMjQ7Ci0KLQkJd2hpbGUgKGxvb3ApIHsKLQkJCXJxID0gaW50ZWxfY29udGV4dF9jcmVhdGVf
cmVxdWVzdChjZSk7Ci0JCQlpZiAoSVNfRVJSKHJxKSkgewotCQkJCWVyciA9IFBUUl9FUlIocnEp
OwotCQkJCWdvdG8gZXJyX3JxOwotCQkJfQotCi0JCQlpZiAoLS1sb29wID09IDApCi0JCQkJaTkx
NV9yZXF1ZXN0X2dldChycSk7Ci0KLQkJCWk5MTVfcmVxdWVzdF9hZGQocnEpOwotCQl9Ci0KLQkJ
aWYgKF9faWd0X3RpbWVvdXQoZW5kX3RpbWUsIE5VTEwpKQotCQkJYnJlYWs7Ci0KLQkJaTkxNV9y
ZXF1ZXN0X3B1dChycSk7Ci0JfSB3aGlsZSAoMSk7Ci0KLQllcnIgPSBpOTE1X3JlcXVlc3Rfd2Fp
dChycSwgMCwgSFogLyA1KTsKLQlpZiAoZXJyIDwgMCkgewotCQlwcl9lcnIoIiVzOiByZXF1ZXN0
IG5vdCBjb21wbGV0ZWQhXG4iLCBlbmdpbmUtPm5hbWUpOwotCQlnb3RvIGVycl93YWl0OwotCX0K
LQotCWlndF9mbHVzaF90ZXN0KGVuZ2luZS0+aTkxNSk7Ci0KLQlwcl9pbmZvKCIlczogcHBod3Nw
IHJ1bnRpbWUgJWxsdW5zLCBhdmVyYWdlICVsbHVuc1xuIiwKLQkJZW5naW5lLT5uYW1lLAotCQlp
bnRlbF9jb250ZXh0X2dldF90b3RhbF9ydW50aW1lX25zKGNlKSwKLQkJaW50ZWxfY29udGV4dF9n
ZXRfYXZnX3J1bnRpbWVfbnMoY2UpKTsKLQotCWVyciA9IDA7Ci0JaWYgKGNlLT5ydW50aW1lLm51
bV91bmRlcmZsb3cpIHsKLQkJcHJfZXJyKCIlczogcHBod3NwIHVuZGVyZmxvdyAldSB0aW1lKHMp
LCBtYXggJXUgY3ljbGVzIVxuIiwKLQkJICAgICAgIGVuZ2luZS0+bmFtZSwKLQkJICAgICAgIGNl
LT5ydW50aW1lLm51bV91bmRlcmZsb3csCi0JCSAgICAgICBjZS0+cnVudGltZS5tYXhfdW5kZXJm
bG93KTsKLQkJR0VNX1RSQUNFX0RVTVAoKTsKLQkJZXJyID0gLUVPVkVSRkxPVzsKLQl9Ci0KLWVy
cl93YWl0OgotCWk5MTVfcmVxdWVzdF9wdXQocnEpOwotZXJyX3JxOgotCWludGVsX2NvbnRleHRf
cHV0KGNlKTsKLQlyZXR1cm4gZXJyOwotfQotCi1zdGF0aWMgaW50IGxpdmVfcHBod3NwX3J1bnRp
bWUodm9pZCAqYXJnKQotewotCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7Ci0Jc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwotCWludCBl
cnIgPSAwOwotCi0JLyoKLQkgKiBDaGVjayB0aGF0IGN1bXVsYXRpdmUgY29udGV4dCBydW50aW1l
IGFzIHN0b3JlZCBpbiB0aGUgcHBod3NwWzE2XQotCSAqIGlzIG1vbm90b25pYy4KLQkgKi8KLQot
CWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LCBpZCkgewotCQllcnIgPSBfX2xpdmVfcHBod3Nw
X3J1bnRpbWUoZW5naW5lKTsKLQkJaWYgKGVycikKLQkJCWJyZWFrOwotCX0KLQotCWlmIChpZ3Rf
Zmx1c2hfdGVzdChndC0+aTkxNSkpCi0JCWVyciA9IC1FSU87Ci0KLQlyZXR1cm4gZXJyOwotfQot
Ci1pbnQgaW50ZWxfbHJjX2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQotewotCXN0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9zdWJ0ZXN0IHRlc3RzW10gPSB7Ci0J
CVNVQlRFU1QobGl2ZV9scmNfbGF5b3V0KSwKLQkJU1VCVEVTVChsaXZlX2xyY19maXhlZCksCi0J
CVNVQlRFU1QobGl2ZV9scmNfc3RhdGUpLAotCQlTVUJURVNUKGxpdmVfbHJjX2dwciksCi0JCVNV
QlRFU1QobGl2ZV9scmNfaXNvbGF0aW9uKSwKLQkJU1VCVEVTVChsaXZlX2xyY190aW1lc3RhbXAp
LAotCQlTVUJURVNUKGxpdmVfbHJjX2dhcmJhZ2UpLAotCQlTVUJURVNUKGxpdmVfcHBod3NwX3J1
bnRpbWUpLAotCQlTVUJURVNUKGxpdmVfbHJjX2luZGlyZWN0X2N0eF9iYiksCi0JfTsKLQotCWlm
ICghSEFTX0xPR0lDQUxfUklOR19DT05URVhUUyhpOTE1KSkKLQkJcmV0dXJuIDA7Ci0KLQlyZXR1
cm4gaW50ZWxfZ3RfbGl2ZV9zdWJ0ZXN0cyh0ZXN0cywgJmk5MTUtPmd0KTsKLX0KZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAw
MDAwMDAwMDAwLi41Nzc0NjI2ZDNkMzQKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwpAQCAtMCwwICsxLDE4NjUgQEAKKy8vIFNQRFgtTGlj
ZW5zZS1JZGVudGlmaWVyOiBNSVQKKy8qCisgKiBDb3B5cmlnaHQgwqkgMjAxOCBJbnRlbCBDb3Jw
b3JhdGlvbgorICovCisKKyNpbmNsdWRlIDxsaW51eC9wcmltZV9udW1iZXJzLmg+CisKKyNpbmNs
dWRlICJndC9pbnRlbF9lbmdpbmVfaGVhcnRiZWF0LmgiCisjaW5jbHVkZSAiZ3QvaW50ZWxfZW5n
aW5lX3BtLmgiCisjaW5jbHVkZSAiZ3QvaW50ZWxfcmVzZXQuaCIKKyNpbmNsdWRlICJndC9pbnRl
bF9yaW5nLmgiCisjaW5jbHVkZSAiZ3Qvc2VsZnRlc3RfZW5naW5lX2hlYXJ0YmVhdC5oIgorI2lu
Y2x1ZGUgImd0L3NobWVtX3V0aWxzLmgiCisKKyNpbmNsdWRlICJpOTE1X3NlbGZ0ZXN0LmgiCisj
aW5jbHVkZSAic2VsZnRlc3RzL2k5MTVfcmFuZG9tLmgiCisjaW5jbHVkZSAic2VsZnRlc3RzL2ln
dF9mbHVzaF90ZXN0LmgiCisjaW5jbHVkZSAic2VsZnRlc3RzL2lndF9saXZlX3Rlc3QuaCIKKyNp
bmNsdWRlICJzZWxmdGVzdHMvaWd0X3NwaW5uZXIuaCIKKyNpbmNsdWRlICJzZWxmdGVzdHMvbGli
X3N3X2ZlbmNlLmgiCisKKyNpbmNsdWRlICJnZW0vc2VsZnRlc3RzL2lndF9nZW1fdXRpbHMuaCIK
KyNpbmNsdWRlICJnZW0vc2VsZnRlc3RzL21vY2tfY29udGV4dC5oIgorCisjZGVmaW5lIENTX0dQ
UihlbmdpbmUsIG4pICgoZW5naW5lKS0+bW1pb19iYXNlICsgMHg2MDAgKyAobikgKiA0KQorI2Rl
ZmluZSBOVU1fR1BSIDE2CisjZGVmaW5lIE5VTV9HUFJfRFcgKE5VTV9HUFIgKiAyKSAvKiBlYWNo
IEdQUiBpcyAyIGR3b3JkcyAqLworCitzdGF0aWMgc3RydWN0IGk5MTVfdm1hICpjcmVhdGVfc2Ny
YXRjaChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQoreworCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0
ICpvYmo7CisJc3RydWN0IGk5MTVfdm1hICp2bWE7CisJaW50IGVycjsKKworCW9iaiA9IGk5MTVf
Z2VtX29iamVjdF9jcmVhdGVfaW50ZXJuYWwoZ3QtPmk5MTUsIFBBR0VfU0laRSk7CisJaWYgKElT
X0VSUihvYmopKQorCQlyZXR1cm4gRVJSX0NBU1Qob2JqKTsKKworCWk5MTVfZ2VtX29iamVjdF9z
ZXRfY2FjaGVfY29oZXJlbmN5KG9iaiwgSTkxNV9DQUNISU5HX0NBQ0hFRCk7CisKKwl2bWEgPSBp
OTE1X3ZtYV9pbnN0YW5jZShvYmosICZndC0+Z2d0dC0+dm0sIE5VTEwpOworCWlmIChJU19FUlIo
dm1hKSkgeworCQlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CisJCXJldHVybiB2bWE7CisJfQor
CisJZXJyID0gaTkxNV92bWFfcGluKHZtYSwgMCwgMCwgUElOX0dMT0JBTCk7CisJaWYgKGVycikg
eworCQlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CisJCXJldHVybiBFUlJfUFRSKGVycik7CisJ
fQorCisJcmV0dXJuIHZtYTsKK30KKworc3RhdGljIGJvb2wgaXNfYWN0aXZlKHN0cnVjdCBpOTE1
X3JlcXVlc3QgKnJxKQoreworCWlmIChpOTE1X3JlcXVlc3RfaXNfYWN0aXZlKHJxKSkKKwkJcmV0
dXJuIHRydWU7CisKKwlpZiAoaTkxNV9yZXF1ZXN0X29uX2hvbGQocnEpKQorCQlyZXR1cm4gdHJ1
ZTsKKworCWlmIChpOTE1X3JlcXVlc3RfaGFzX2luaXRpYWxfYnJlYWRjcnVtYihycSkgJiYgaTkx
NV9yZXF1ZXN0X3N0YXJ0ZWQocnEpKQorCQlyZXR1cm4gdHJ1ZTsKKworCXJldHVybiBmYWxzZTsK
K30KKworc3RhdGljIGludCB3YWl0X2Zvcl9zdWJtaXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lLAorCQkJICAgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCisJCQkgICB1bnNpZ25lZCBs
b25nIHRpbWVvdXQpCit7CisJdGltZW91dCArPSBqaWZmaWVzOworCWRvIHsKKwkJYm9vbCBkb25l
ID0gdGltZV9hZnRlcihqaWZmaWVzLCB0aW1lb3V0KTsKKworCQlpZiAoaTkxNV9yZXF1ZXN0X2Nv
bXBsZXRlZChycSkpIC8qIHRoYXQgd2FzIHF1aWNrISAqLworCQkJcmV0dXJuIDA7CisKKwkJLyog
V2FpdCB1bnRpbCB0aGUgSFcgaGFzIGFja25vd2xlZ2VkIHRoZSBzdWJtaXNzaW9uIChvciBlcnIp
ICovCisJCWludGVsX2VuZ2luZV9mbHVzaF9zdWJtaXNzaW9uKGVuZ2luZSk7CisJCWlmICghUkVB
RF9PTkNFKGVuZ2luZS0+ZXhlY2xpc3RzLnBlbmRpbmdbMF0pICYmIGlzX2FjdGl2ZShycSkpCisJ
CQlyZXR1cm4gMDsKKworCQlpZiAoZG9uZSkKKwkJCXJldHVybiAtRVRJTUU7CisKKwkJY29uZF9y
ZXNjaGVkKCk7CisJfSB3aGlsZSAoMSk7Cit9CisKK3N0YXRpYyBpbnQgZW1pdF9zZW1hcGhvcmVf
c2lnbmFsKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgdm9pZCAqc2xvdCkKK3sKKwljb25zdCB1
MzIgb2Zmc2V0ID0KKwkJaTkxNV9nZ3R0X29mZnNldChjZS0+ZW5naW5lLT5zdGF0dXNfcGFnZS52
bWEpICsKKwkJb2Zmc2V0X2luX3BhZ2Uoc2xvdCk7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7
CisJdTMyICpjczsKKworCXJxID0gaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVzdChjZSk7CisJ
aWYgKElTX0VSUihycSkpCisJCXJldHVybiBQVFJfRVJSKHJxKTsKKworCWNzID0gaW50ZWxfcmlu
Z19iZWdpbihycSwgNCk7CisJaWYgKElTX0VSUihjcykpIHsKKwkJaTkxNV9yZXF1ZXN0X2FkZChy
cSk7CisJCXJldHVybiBQVFJfRVJSKGNzKTsKKwl9CisKKwkqY3MrKyA9IE1JX1NUT1JFX0RXT1JE
X0lNTV9HRU40IHwgTUlfVVNFX0dHVFQ7CisJKmNzKysgPSBvZmZzZXQ7CisJKmNzKysgPSAwOwor
CSpjcysrID0gMTsKKworCWludGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOworCisJcnEtPnNjaGVk
LmF0dHIucHJpb3JpdHkgPSBJOTE1X1BSSU9SSVRZX0JBUlJJRVI7CisJaTkxNV9yZXF1ZXN0X2Fk
ZChycSk7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgY29udGV4dF9mbHVzaChzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqY2UsIGxvbmcgdGltZW91dCkKK3sKKwlzdHJ1Y3QgaTkxNV9yZXF1ZXN0
ICpycTsKKwlzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZTsKKwlpbnQgZXJyID0gMDsKKworCXJxID0g
aW50ZWxfZW5naW5lX2NyZWF0ZV9rZXJuZWxfcmVxdWVzdChjZS0+ZW5naW5lKTsKKwlpZiAoSVNf
RVJSKHJxKSkKKwkJcmV0dXJuIFBUUl9FUlIocnEpOworCisJZmVuY2UgPSBpOTE1X2FjdGl2ZV9m
ZW5jZV9nZXQoJmNlLT50aW1lbGluZS0+bGFzdF9yZXF1ZXN0KTsKKwlpZiAoZmVuY2UpIHsKKwkJ
aTkxNV9yZXF1ZXN0X2F3YWl0X2RtYV9mZW5jZShycSwgZmVuY2UpOworCQlkbWFfZmVuY2VfcHV0
KGZlbmNlKTsKKwl9CisKKwlycSA9IGk5MTVfcmVxdWVzdF9nZXQocnEpOworCWk5MTVfcmVxdWVz
dF9hZGQocnEpOworCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgdGltZW91dCkgPCAwKQor
CQllcnIgPSAtRVRJTUU7CisJaTkxNV9yZXF1ZXN0X3B1dChycSk7CisKKwlybWIoKTsgLyogV2Ug
a25vdyB0aGUgcmVxdWVzdCBpcyB3cml0dGVuLCBtYWtlIHN1cmUgYWxsIHN0YXRlIGlzIHRvbyEg
Ki8KKwlyZXR1cm4gZXJyOworfQorCitzdGF0aWMgaW50IGxpdmVfbHJjX2xheW91dCh2b2lkICph
cmcpCit7CisJc3RydWN0IGludGVsX2d0ICpndCA9IGFyZzsKKwlzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmU7CisJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CisJdTMyICpscmM7CisJaW50
IGVycjsKKworCS8qCisJICogQ2hlY2sgdGhlIHJlZ2lzdGVycyBvZmZzZXRzIHdlIHVzZSB0byBj
cmVhdGUgdGhlIGluaXRpYWwgcmVnIHN0YXRlCisJICogbWF0Y2ggdGhlIGxheW91dCBzYXZlZCBi
eSBIVy4KKwkgKi8KKworCWxyYyA9IGttYWxsb2MoUEFHRV9TSVpFLCBHRlBfS0VSTkVMKTsKKwlp
ZiAoIWxyYykKKwkJcmV0dXJuIC1FTk9NRU07CisKKwllcnIgPSAwOworCWZvcl9lYWNoX2VuZ2lu
ZShlbmdpbmUsIGd0LCBpZCkgeworCQl1MzIgKmh3OworCQlpbnQgZHc7CisKKwkJaWYgKCFlbmdp
bmUtPmRlZmF1bHRfc3RhdGUpCisJCQljb250aW51ZTsKKworCQlodyA9IHNobWVtX3Bpbl9tYXAo
ZW5naW5lLT5kZWZhdWx0X3N0YXRlKTsKKwkJaWYgKElTX0VSUihodykpIHsKKwkJCWVyciA9IFBU
Ul9FUlIoaHcpOworCQkJYnJlYWs7CisJCX0KKwkJaHcgKz0gTFJDX1NUQVRFX09GRlNFVCAvIHNp
emVvZigqaHcpOworCisJCV9fbHJjX2luaXRfcmVncyhtZW1zZXQobHJjLCBQT0lTT05fSU5VU0Us
IFBBR0VfU0laRSksCisJCQkJZW5naW5lLT5rZXJuZWxfY29udGV4dCwKKwkJCQllbmdpbmUsCisJ
CQkJZW5naW5lLT5rZXJuZWxfY29udGV4dC0+cmluZywKKwkJCQl0cnVlKTsKKworCQlkdyA9IDA7
CisJCWRvIHsKKwkJCXUzMiBscmkgPSBod1tkd107CisKKwkJCWlmIChscmkgPT0gMCkgeworCQkJ
CWR3Kys7CisJCQkJY29udGludWU7CisJCQl9CisKKwkJCWlmIChscmNbZHddID09IDApIHsKKwkJ
CQlwcl9kZWJ1ZygiJXM6IHNraXBwZWQgaW5zdHJ1Y3Rpb24gJXggYXQgZHdvcmQgJWRcbiIsCisJ
CQkJCSBlbmdpbmUtPm5hbWUsIGxyaSwgZHcpOworCQkJCWR3Kys7CisJCQkJY29udGludWU7CisJ
CQl9CisKKwkJCWlmICgobHJpICYgR0VOTUFTSygzMSwgMjMpKSAhPSBNSV9JTlNUUigweDIyLCAw
KSkgeworCQkJCXByX2VycigiJXM6IEV4cGVjdGVkIExSSSBjb21tYW5kIGF0IGR3b3JkICVkLCBm
b3VuZCAlMDh4XG4iLAorCQkJCSAgICAgICBlbmdpbmUtPm5hbWUsIGR3LCBscmkpOworCQkJCWVy
ciA9IC1FSU5WQUw7CisJCQkJYnJlYWs7CisJCQl9CisKKwkJCWlmIChscmNbZHddICE9IGxyaSkg
eworCQkJCXByX2VycigiJXM6IExSSSBjb21tYW5kIG1pc21hdGNoIGF0IGR3b3JkICVkLCBleHBl
Y3RlZCAlMDh4IGZvdW5kICUwOHhcbiIsCisJCQkJICAgICAgIGVuZ2luZS0+bmFtZSwgZHcsIGxy
aSwgbHJjW2R3XSk7CisJCQkJZXJyID0gLUVJTlZBTDsKKwkJCQlicmVhazsKKwkJCX0KKworCQkJ
bHJpICY9IDB4N2Y7CisJCQlscmkrKzsKKwkJCWR3Kys7CisKKwkJCXdoaWxlIChscmkpIHsKKwkJ
CQlpZiAoaHdbZHddICE9IGxyY1tkd10pIHsKKwkJCQkJcHJfZXJyKCIlczogRGlmZmVyZW50IHJl
Z2lzdGVycyBmb3VuZCBhdCBkd29yZCAlZCwgZXhwZWN0ZWQgJXgsIGZvdW5kICV4XG4iLAorCQkJ
CQkgICAgICAgZW5naW5lLT5uYW1lLCBkdywgaHdbZHddLCBscmNbZHddKTsKKwkJCQkJZXJyID0g
LUVJTlZBTDsKKwkJCQkJYnJlYWs7CisJCQkJfQorCisJCQkJLyoKKwkJCQkgKiBTa2lwIG92ZXIg
dGhlIGFjdHVhbCByZWdpc3RlciB2YWx1ZSBhcyB3ZQorCQkJCSAqIGV4cGVjdCB0aGF0IHRvIGRp
ZmZlci4KKwkJCQkgKi8KKwkJCQlkdyArPSAyOworCQkJCWxyaSAtPSAyOworCQkJfQorCQl9IHdo
aWxlICgobHJjW2R3XSAmIH5CSVQoMCkpICE9IE1JX0JBVENIX0JVRkZFUl9FTkQpOworCisJCWlm
IChlcnIpIHsKKwkJCXByX2luZm8oIiVzOiBIVyByZWdpc3RlciBpbWFnZTpcbiIsIGVuZ2luZS0+
bmFtZSk7CisJCQlpZ3RfaGV4ZHVtcChodywgUEFHRV9TSVpFKTsKKworCQkJcHJfaW5mbygiJXM6
IFNXIHJlZ2lzdGVyIGltYWdlOlxuIiwgZW5naW5lLT5uYW1lKTsKKwkJCWlndF9oZXhkdW1wKGxy
YywgUEFHRV9TSVpFKTsKKwkJfQorCisJCXNobWVtX3VucGluX21hcChlbmdpbmUtPmRlZmF1bHRf
c3RhdGUsIGh3KTsKKwkJaWYgKGVycikKKwkJCWJyZWFrOworCX0KKworCWtmcmVlKGxyYyk7CisJ
cmV0dXJuIGVycjsKK30KKworc3RhdGljIGludCBmaW5kX29mZnNldChjb25zdCB1MzIgKmxyaSwg
dTMyIG9mZnNldCkKK3sKKwlpbnQgaTsKKworCWZvciAoaSA9IDA7IGkgPCBQQUdFX1NJWkUgLyBz
aXplb2YodTMyKTsgaSsrKQorCQlpZiAobHJpW2ldID09IG9mZnNldCkKKwkJCXJldHVybiBpOwor
CisJcmV0dXJuIC0xOworfQorCitzdGF0aWMgaW50IGxpdmVfbHJjX2ZpeGVkKHZvaWQgKmFyZykK
K3sKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOworCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZTsKKwllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKKwlpbnQgZXJyID0gMDsKKworCS8q
CisJICogQ2hlY2sgdGhlIGFzc3VtZWQgcmVnaXN0ZXIgb2Zmc2V0cyBtYXRjaCB0aGUgYWN0dWFs
IGxvY2F0aW9ucyBpbgorCSAqIHRoZSBjb250ZXh0IGltYWdlLgorCSAqLworCisJZm9yX2VhY2hf
ZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7CisJCWNvbnN0IHN0cnVjdCB7CisJCQl1MzIgcmVnOwor
CQkJdTMyIG9mZnNldDsKKwkJCWNvbnN0IGNoYXIgKm5hbWU7CisJCX0gdGJsW10gPSB7CisJCQl7
CisJCQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19TVEFSVChlbmdpbmUtPm1taW9fYmFzZSkp
LAorCQkJCUNUWF9SSU5HX1NUQVJUIC0gMSwKKwkJCQkiUklOR19TVEFSVCIKKwkJCX0sCisJCQl7
CisJCQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19DVEwoZW5naW5lLT5tbWlvX2Jhc2UpKSwK
KwkJCQlDVFhfUklOR19DVEwgLSAxLAorCQkJCSJSSU5HX0NUTCIKKwkJCX0sCisJCQl7CisJCQkJ
aTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19IRUFEKGVuZ2luZS0+bW1pb19iYXNlKSksCisJCQkJ
Q1RYX1JJTkdfSEVBRCAtIDEsCisJCQkJIlJJTkdfSEVBRCIKKwkJCX0sCisJCQl7CisJCQkJaTkx
NV9tbWlvX3JlZ19vZmZzZXQoUklOR19UQUlMKGVuZ2luZS0+bW1pb19iYXNlKSksCisJCQkJQ1RY
X1JJTkdfVEFJTCAtIDEsCisJCQkJIlJJTkdfVEFJTCIKKwkJCX0sCisJCQl7CisJCQkJaTkxNV9t
bWlvX3JlZ19vZmZzZXQoUklOR19NSV9NT0RFKGVuZ2luZS0+bW1pb19iYXNlKSksCisJCQkJbHJj
X3JpbmdfbWlfbW9kZShlbmdpbmUpLAorCQkJCSJSSU5HX01JX01PREUiCisJCQl9LAorCQkJewor
CQkJCWk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfQkJTVEFURShlbmdpbmUtPm1taW9fYmFzZSkp
LAorCQkJCUNUWF9CQl9TVEFURSAtIDEsCisJCQkJIkJCX1NUQVRFIgorCQkJfSwKKwkJCXsKKwkJ
CQlpOTE1X21taW9fcmVnX29mZnNldChSSU5HX0JCX1BFUl9DVFhfUFRSKGVuZ2luZS0+bW1pb19i
YXNlKSksCisJCQkJbHJjX3Jpbmdfd2FfYmJfcGVyX2N0eChlbmdpbmUpLAorCQkJCSJSSU5HX0JC
X1BFUl9DVFhfUFRSIgorCQkJfSwKKwkJCXsKKwkJCQlpOTE1X21taW9fcmVnX29mZnNldChSSU5H
X0lORElSRUNUX0NUWChlbmdpbmUtPm1taW9fYmFzZSkpLAorCQkJCWxyY19yaW5nX2luZGlyZWN0
X3B0cihlbmdpbmUpLAorCQkJCSJSSU5HX0lORElSRUNUX0NUWF9QVFIiCisJCQl9LAorCQkJewor
CQkJCWk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfSU5ESVJFQ1RfQ1RYX09GRlNFVChlbmdpbmUt
Pm1taW9fYmFzZSkpLAorCQkJCWxyY19yaW5nX2luZGlyZWN0X29mZnNldChlbmdpbmUpLAorCQkJ
CSJSSU5HX0lORElSRUNUX0NUWF9PRkZTRVQiCisJCQl9LAorCQkJeworCQkJCWk5MTVfbW1pb19y
ZWdfb2Zmc2V0KFJJTkdfQ1RYX1RJTUVTVEFNUChlbmdpbmUtPm1taW9fYmFzZSkpLAorCQkJCUNU
WF9USU1FU1RBTVAgLSAxLAorCQkJCSJSSU5HX0NUWF9USU1FU1RBTVAiCisJCQl9LAorCQkJewor
CQkJCWk5MTVfbW1pb19yZWdfb2Zmc2V0KEdFTjhfUklOR19DU19HUFIoZW5naW5lLT5tbWlvX2Jh
c2UsIDApKSwKKwkJCQlscmNfcmluZ19ncHIwKGVuZ2luZSksCisJCQkJIlJJTkdfQ1NfR1BSMCIK
KwkJCX0sCisJCQl7CisJCQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19DTURfQlVGX0NDVEwo
ZW5naW5lLT5tbWlvX2Jhc2UpKSwKKwkJCQlscmNfcmluZ19jbWRfYnVmX2NjdGwoZW5naW5lKSwK
KwkJCQkiUklOR19DTURfQlVGX0NDVEwiCisJCQl9LAorCQkJeyB9LAorCQl9LCAqdDsKKwkJdTMy
ICpodzsKKworCQlpZiAoIWVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSkKKwkJCWNvbnRpbnVlOworCisJ
CWh3ID0gc2htZW1fcGluX21hcChlbmdpbmUtPmRlZmF1bHRfc3RhdGUpOworCQlpZiAoSVNfRVJS
KGh3KSkgeworCQkJZXJyID0gUFRSX0VSUihodyk7CisJCQlicmVhazsKKwkJfQorCQlodyArPSBM
UkNfU1RBVEVfT0ZGU0VUIC8gc2l6ZW9mKCpodyk7CisKKwkJZm9yICh0ID0gdGJsOyB0LT5uYW1l
OyB0KyspIHsKKwkJCWludCBkdyA9IGZpbmRfb2Zmc2V0KGh3LCB0LT5yZWcpOworCisJCQlpZiAo
ZHcgIT0gdC0+b2Zmc2V0KSB7CisJCQkJcHJfZXJyKCIlczogT2Zmc2V0IGZvciAlcyBbMHgleF0g
bWlzbWF0Y2gsIGZvdW5kICV4LCBleHBlY3RlZCAleFxuIiwKKwkJCQkgICAgICAgZW5naW5lLT5u
YW1lLAorCQkJCSAgICAgICB0LT5uYW1lLAorCQkJCSAgICAgICB0LT5yZWcsCisJCQkJICAgICAg
IGR3LAorCQkJCSAgICAgICB0LT5vZmZzZXQpOworCQkJCWVyciA9IC1FSU5WQUw7CisJCQl9CisJ
CX0KKworCQlzaG1lbV91bnBpbl9tYXAoZW5naW5lLT5kZWZhdWx0X3N0YXRlLCBodyk7CisJfQor
CisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIGludCBfX2xpdmVfbHJjX3N0YXRlKHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKKwkJCSAgICBzdHJ1Y3QgaTkxNV92bWEgKnNjcmF0Y2gp
Cit7CisJc3RydWN0IGludGVsX2NvbnRleHQgKmNlOworCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJx
OworCXN0cnVjdCBpOTE1X2dlbV93d19jdHggd3c7CisJZW51bSB7CisJCVJJTkdfU1RBUlRfSURY
ID0gMCwKKwkJUklOR19UQUlMX0lEWCwKKwkJTUFYX0lEWAorCX07CisJdTMyIGV4cGVjdGVkW01B
WF9JRFhdOworCXUzMiAqY3M7CisJaW50IGVycjsKKwlpbnQgbjsKKworCWNlID0gaW50ZWxfY29u
dGV4dF9jcmVhdGUoZW5naW5lKTsKKwlpZiAoSVNfRVJSKGNlKSkKKwkJcmV0dXJuIFBUUl9FUlIo
Y2UpOworCisJaTkxNV9nZW1fd3dfY3R4X2luaXQoJnd3LCBmYWxzZSk7CityZXRyeToKKwllcnIg
PSBpOTE1X2dlbV9vYmplY3RfbG9jayhzY3JhdGNoLT5vYmosICZ3dyk7CisJaWYgKCFlcnIpCisJ
CWVyciA9IGludGVsX2NvbnRleHRfcGluX3d3KGNlLCAmd3cpOworCWlmIChlcnIpCisJCWdvdG8g
ZXJyX3B1dDsKKworCXJxID0gaTkxNV9yZXF1ZXN0X2NyZWF0ZShjZSk7CisJaWYgKElTX0VSUihy
cSkpIHsKKwkJZXJyID0gUFRSX0VSUihycSk7CisJCWdvdG8gZXJyX3VucGluOworCX0KKworCWNz
ID0gaW50ZWxfcmluZ19iZWdpbihycSwgNCAqIE1BWF9JRFgpOworCWlmIChJU19FUlIoY3MpKSB7
CisJCWVyciA9IFBUUl9FUlIoY3MpOworCQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKKwkJZ290byBl
cnJfdW5waW47CisJfQorCisJKmNzKysgPSBNSV9TVE9SRV9SRUdJU1RFUl9NRU1fR0VOOCB8IE1J
X1VTRV9HR1RUOworCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19TVEFSVChlbmdp
bmUtPm1taW9fYmFzZSkpOworCSpjcysrID0gaTkxNV9nZ3R0X29mZnNldChzY3JhdGNoKSArIFJJ
TkdfU1RBUlRfSURYICogc2l6ZW9mKHUzMik7CisJKmNzKysgPSAwOworCisJZXhwZWN0ZWRbUklO
R19TVEFSVF9JRFhdID0gaTkxNV9nZ3R0X29mZnNldChjZS0+cmluZy0+dm1hKTsKKworCSpjcysr
ID0gTUlfU1RPUkVfUkVHSVNURVJfTUVNX0dFTjggfCBNSV9VU0VfR0dUVDsKKwkqY3MrKyA9IGk5
MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfVEFJTChlbmdpbmUtPm1taW9fYmFzZSkpOworCSpjcysr
ID0gaTkxNV9nZ3R0X29mZnNldChzY3JhdGNoKSArIFJJTkdfVEFJTF9JRFggKiBzaXplb2YodTMy
KTsKKwkqY3MrKyA9IDA7CisKKwllcnIgPSBpOTE1X3JlcXVlc3RfYXdhaXRfb2JqZWN0KHJxLCBz
Y3JhdGNoLT5vYmosIHRydWUpOworCWlmICghZXJyKQorCQllcnIgPSBpOTE1X3ZtYV9tb3ZlX3Rv
X2FjdGl2ZShzY3JhdGNoLCBycSwgRVhFQ19PQkpFQ1RfV1JJVEUpOworCisJaTkxNV9yZXF1ZXN0
X2dldChycSk7CisJaTkxNV9yZXF1ZXN0X2FkZChycSk7CisJaWYgKGVycikKKwkJZ290byBlcnJf
cnE7CisKKwlpbnRlbF9lbmdpbmVfZmx1c2hfc3VibWlzc2lvbihlbmdpbmUpOworCWV4cGVjdGVk
W1JJTkdfVEFJTF9JRFhdID0gY2UtPnJpbmctPnRhaWw7CisKKwlpZiAoaTkxNV9yZXF1ZXN0X3dh
aXQocnEsIDAsIEhaIC8gNSkgPCAwKSB7CisJCWVyciA9IC1FVElNRTsKKwkJZ290byBlcnJfcnE7
CisJfQorCisJY3MgPSBpOTE1X2dlbV9vYmplY3RfcGluX21hcChzY3JhdGNoLT5vYmosIEk5MTVf
TUFQX1dCKTsKKwlpZiAoSVNfRVJSKGNzKSkgeworCQllcnIgPSBQVFJfRVJSKGNzKTsKKwkJZ290
byBlcnJfcnE7CisJfQorCisJZm9yIChuID0gMDsgbiA8IE1BWF9JRFg7IG4rKykgeworCQlpZiAo
Y3Nbbl0gIT0gZXhwZWN0ZWRbbl0pIHsKKwkJCXByX2VycigiJXM6IFN0b3JlZCByZWdpc3Rlclsl
ZF0gdmFsdWVbMHgleF0gZGlkIG5vdCBtYXRjaCBleHBlY3RlZFsweCV4XVxuIiwKKwkJCSAgICAg
ICBlbmdpbmUtPm5hbWUsIG4sIGNzW25dLCBleHBlY3RlZFtuXSk7CisJCQllcnIgPSAtRUlOVkFM
OworCQkJYnJlYWs7CisJCX0KKwl9CisKKwlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHNjcmF0
Y2gtPm9iaik7CisKK2Vycl9ycToKKwlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKK2Vycl91bnBpbjoK
KwlpbnRlbF9jb250ZXh0X3VucGluKGNlKTsKK2Vycl9wdXQ6CisJaWYgKGVyciA9PSAtRURFQURM
SykgeworCQllcnIgPSBpOTE1X2dlbV93d19jdHhfYmFja29mZigmd3cpOworCQlpZiAoIWVycikK
KwkJCWdvdG8gcmV0cnk7CisJfQorCWk5MTVfZ2VtX3d3X2N0eF9maW5pKCZ3dyk7CisJaW50ZWxf
Y29udGV4dF9wdXQoY2UpOworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBpbnQgbGl2ZV9scmNf
c3RhdGUodm9pZCAqYXJnKQoreworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7CisJc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOworCXN0cnVjdCBpOTE1X3ZtYSAqc2NyYXRjaDsKKwll
bnVtIGludGVsX2VuZ2luZV9pZCBpZDsKKwlpbnQgZXJyID0gMDsKKworCS8qCisJICogQ2hlY2sg
dGhlIGxpdmUgcmVnaXN0ZXIgc3RhdGUgbWF0Y2hlcyB3aGF0IHdlIGV4cGVjdCBmb3IgdGhpcwor
CSAqIGludGVsX2NvbnRleHQuCisJICovCisKKwlzY3JhdGNoID0gY3JlYXRlX3NjcmF0Y2goZ3Qp
OworCWlmIChJU19FUlIoc2NyYXRjaCkpCisJCXJldHVybiBQVFJfRVJSKHNjcmF0Y2gpOworCisJ
Zm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7CisJCWVyciA9IF9fbGl2ZV9scmNfc3Rh
dGUoZW5naW5lLCBzY3JhdGNoKTsKKwkJaWYgKGVycikKKwkJCWJyZWFrOworCX0KKworCWlmIChp
Z3RfZmx1c2hfdGVzdChndC0+aTkxNSkpCisJCWVyciA9IC1FSU87CisKKwlpOTE1X3ZtYV91bnBp
bl9hbmRfcmVsZWFzZSgmc2NyYXRjaCwgMCk7CisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIGlu
dCBncHJfbWFrZV9kaXJ0eShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCit7CisJc3RydWN0IGk5
MTVfcmVxdWVzdCAqcnE7CisJdTMyICpjczsKKwlpbnQgbjsKKworCXJxID0gaW50ZWxfY29udGV4
dF9jcmVhdGVfcmVxdWVzdChjZSk7CisJaWYgKElTX0VSUihycSkpCisJCXJldHVybiBQVFJfRVJS
KHJxKTsKKworCWNzID0gaW50ZWxfcmluZ19iZWdpbihycSwgMiAqIE5VTV9HUFJfRFcgKyAyKTsK
KwlpZiAoSVNfRVJSKGNzKSkgeworCQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKKwkJcmV0dXJuIFBU
Ul9FUlIoY3MpOworCX0KKworCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oTlVNX0dQUl9E
Vyk7CisJZm9yIChuID0gMDsgbiA8IE5VTV9HUFJfRFc7IG4rKykgeworCQkqY3MrKyA9IENTX0dQ
UihjZS0+ZW5naW5lLCBuKTsKKwkJKmNzKysgPSBTVEFDS19NQUdJQzsKKwl9CisJKmNzKysgPSBN
SV9OT09QOworCisJaW50ZWxfcmluZ19hZHZhbmNlKHJxLCBjcyk7CisKKwlycS0+c2NoZWQuYXR0
ci5wcmlvcml0eSA9IEk5MTVfUFJJT1JJVFlfQkFSUklFUjsKKwlpOTE1X3JlcXVlc3RfYWRkKHJx
KTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgc3RydWN0IGk5MTVfcmVxdWVzdCAqCitfX2dw
cl9yZWFkKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgc3RydWN0IGk5MTVfdm1hICpzY3JhdGNo
LCB1MzIgKnNsb3QpCit7CisJY29uc3QgdTMyIG9mZnNldCA9CisJCWk5MTVfZ2d0dF9vZmZzZXQo
Y2UtPmVuZ2luZS0+c3RhdHVzX3BhZ2Uudm1hKSArCisJCW9mZnNldF9pbl9wYWdlKHNsb3QpOwor
CXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOworCXUzMiAqY3M7CisJaW50IGVycjsKKwlpbnQgbjsK
KworCXJxID0gaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVzdChjZSk7CisJaWYgKElTX0VSUihy
cSkpCisJCXJldHVybiBycTsKKworCWNzID0gaW50ZWxfcmluZ19iZWdpbihycSwgNiArIDQgKiBO
VU1fR1BSX0RXKTsKKwlpZiAoSVNfRVJSKGNzKSkgeworCQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsK
KwkJcmV0dXJuIEVSUl9DQVNUKGNzKTsKKwl9CisKKwkqY3MrKyA9IE1JX0FSQl9PTl9PRkYgfCBN
SV9BUkJfRU5BQkxFOworCSpjcysrID0gTUlfTk9PUDsKKworCSpjcysrID0gTUlfU0VNQVBIT1JF
X1dBSVQgfAorCQlNSV9TRU1BUEhPUkVfR0xPQkFMX0dUVCB8CisJCU1JX1NFTUFQSE9SRV9QT0xM
IHwKKwkJTUlfU0VNQVBIT1JFX1NBRF9ORVFfU0REOworCSpjcysrID0gMDsKKwkqY3MrKyA9IG9m
ZnNldDsKKwkqY3MrKyA9IDA7CisKKwlmb3IgKG4gPSAwOyBuIDwgTlVNX0dQUl9EVzsgbisrKSB7
CisJCSpjcysrID0gTUlfU1RPUkVfUkVHSVNURVJfTUVNX0dFTjggfCBNSV9VU0VfR0dUVDsKKwkJ
KmNzKysgPSBDU19HUFIoY2UtPmVuZ2luZSwgbik7CisJCSpjcysrID0gaTkxNV9nZ3R0X29mZnNl
dChzY3JhdGNoKSArIG4gKiBzaXplb2YodTMyKTsKKwkJKmNzKysgPSAwOworCX0KKworCWk5MTVf
dm1hX2xvY2soc2NyYXRjaCk7CisJZXJyID0gaTkxNV9yZXF1ZXN0X2F3YWl0X29iamVjdChycSwg
c2NyYXRjaC0+b2JqLCB0cnVlKTsKKwlpZiAoIWVycikKKwkJZXJyID0gaTkxNV92bWFfbW92ZV90
b19hY3RpdmUoc2NyYXRjaCwgcnEsIEVYRUNfT0JKRUNUX1dSSVRFKTsKKwlpOTE1X3ZtYV91bmxv
Y2soc2NyYXRjaCk7CisKKwlpOTE1X3JlcXVlc3RfZ2V0KHJxKTsKKwlpOTE1X3JlcXVlc3RfYWRk
KHJxKTsKKwlpZiAoZXJyKSB7CisJCWk5MTVfcmVxdWVzdF9wdXQocnEpOworCQlycSA9IEVSUl9Q
VFIoZXJyKTsKKwl9CisKKwlyZXR1cm4gcnE7Cit9CisKK3N0YXRpYyBpbnQgX19saXZlX2xyY19n
cHIoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAorCQkJICBzdHJ1Y3QgaTkxNV92bWEg
KnNjcmF0Y2gsCisJCQkgIGJvb2wgcHJlZW1wdCkKK3sKKwl1MzIgKnNsb3QgPSBtZW1zZXQzMihl
bmdpbmUtPnN0YXR1c19wYWdlLmFkZHIgKyAxMDAwLCAwLCA0KTsKKwlzdHJ1Y3QgaW50ZWxfY29u
dGV4dCAqY2U7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7CisJdTMyICpjczsKKwlpbnQgZXJy
OworCWludCBuOworCisJaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpIDwgOSAmJiBlbmdpbmUt
PmNsYXNzICE9IFJFTkRFUl9DTEFTUykKKwkJcmV0dXJuIDA7IC8qIEdQUiBvbmx5IG9uIHJjczAg
Zm9yIGdlbjggKi8KKworCWVyciA9IGdwcl9tYWtlX2RpcnR5KGVuZ2luZS0+a2VybmVsX2NvbnRl
eHQpOworCWlmIChlcnIpCisJCXJldHVybiBlcnI7CisKKwljZSA9IGludGVsX2NvbnRleHRfY3Jl
YXRlKGVuZ2luZSk7CisJaWYgKElTX0VSUihjZSkpCisJCXJldHVybiBQVFJfRVJSKGNlKTsKKwor
CXJxID0gX19ncHJfcmVhZChjZSwgc2NyYXRjaCwgc2xvdCk7CisJaWYgKElTX0VSUihycSkpIHsK
KwkJZXJyID0gUFRSX0VSUihycSk7CisJCWdvdG8gZXJyX3B1dDsKKwl9CisKKwllcnIgPSB3YWl0
X2Zvcl9zdWJtaXQoZW5naW5lLCBycSwgSFogLyAyKTsKKwlpZiAoZXJyKQorCQlnb3RvIGVycl9y
cTsKKworCWlmIChwcmVlbXB0KSB7CisJCWVyciA9IGdwcl9tYWtlX2RpcnR5KGVuZ2luZS0+a2Vy
bmVsX2NvbnRleHQpOworCQlpZiAoZXJyKQorCQkJZ290byBlcnJfcnE7CisKKwkJZXJyID0gZW1p
dF9zZW1hcGhvcmVfc2lnbmFsKGVuZ2luZS0+a2VybmVsX2NvbnRleHQsIHNsb3QpOworCQlpZiAo
ZXJyKQorCQkJZ290byBlcnJfcnE7CisJfSBlbHNlIHsKKwkJc2xvdFswXSA9IDE7CisJCXdtYigp
OworCX0KKworCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgSFogLyA1KSA8IDApIHsKKwkJ
ZXJyID0gLUVUSU1FOworCQlnb3RvIGVycl9ycTsKKwl9CisKKwljcyA9IGk5MTVfZ2VtX29iamVj
dF9waW5fbWFwKHNjcmF0Y2gtPm9iaiwgSTkxNV9NQVBfV0IpOworCWlmIChJU19FUlIoY3MpKSB7
CisJCWVyciA9IFBUUl9FUlIoY3MpOworCQlnb3RvIGVycl9ycTsKKwl9CisKKwlmb3IgKG4gPSAw
OyBuIDwgTlVNX0dQUl9EVzsgbisrKSB7CisJCWlmIChjc1tuXSkgeworCQkJcHJfZXJyKCIlczog
R1BSWyVkXS4lcyB3YXMgbm90IHplcm8sIGZvdW5kIDB4JTA4eCFcbiIsCisJCQkgICAgICAgZW5n
aW5lLT5uYW1lLAorCQkJICAgICAgIG4gLyAyLCBuICYgMSA/ICJ1ZHciIDogImxkdyIsCisJCQkg
ICAgICAgY3Nbbl0pOworCQkJZXJyID0gLUVJTlZBTDsKKwkJCWJyZWFrOworCQl9CisJfQorCisJ
aTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChzY3JhdGNoLT5vYmopOworCitlcnJfcnE6CisJbWVt
c2V0MzIoJnNsb3RbMF0sIC0xLCA0KTsKKwl3bWIoKTsKKwlpOTE1X3JlcXVlc3RfcHV0KHJxKTsK
K2Vycl9wdXQ6CisJaW50ZWxfY29udGV4dF9wdXQoY2UpOworCXJldHVybiBlcnI7Cit9CisKK3N0
YXRpYyBpbnQgbGl2ZV9scmNfZ3ByKHZvaWQgKmFyZykKK3sKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0
ID0gYXJnOworCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKKwlzdHJ1Y3QgaTkxNV92
bWEgKnNjcmF0Y2g7CisJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CisJaW50IGVyciA9IDA7CisK
KwkvKgorCSAqIENoZWNrIHRoYXQgR1BSIHJlZ2lzdGVycyBhcmUgY2xlYXJlZCBpbiBuZXcgY29u
dGV4dHMgYXMgd2UgbmVlZAorCSAqIHRvIGF2b2lkIGxlYWtpbmcgYW55IGluZm9ybWF0aW9uIGZy
b20gcHJldmlvdXMgY29udGV4dHMuCisJICovCisKKwlzY3JhdGNoID0gY3JlYXRlX3NjcmF0Y2go
Z3QpOworCWlmIChJU19FUlIoc2NyYXRjaCkpCisJCXJldHVybiBQVFJfRVJSKHNjcmF0Y2gpOwor
CisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7CisJCXN0X2VuZ2luZV9oZWFydGJl
YXRfZGlzYWJsZShlbmdpbmUpOworCisJCWVyciA9IF9fbGl2ZV9scmNfZ3ByKGVuZ2luZSwgc2Ny
YXRjaCwgZmFsc2UpOworCQlpZiAoZXJyKQorCQkJZ290byBlcnI7CisKKwkJZXJyID0gX19saXZl
X2xyY19ncHIoZW5naW5lLCBzY3JhdGNoLCB0cnVlKTsKKwkJaWYgKGVycikKKwkJCWdvdG8gZXJy
OworCitlcnI6CisJCXN0X2VuZ2luZV9oZWFydGJlYXRfZW5hYmxlKGVuZ2luZSk7CisJCWlmIChp
Z3RfZmx1c2hfdGVzdChndC0+aTkxNSkpCisJCQllcnIgPSAtRUlPOworCQlpZiAoZXJyKQorCQkJ
YnJlYWs7CisJfQorCisJaTkxNV92bWFfdW5waW5fYW5kX3JlbGVhc2UoJnNjcmF0Y2gsIDApOwor
CXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICoKK2NyZWF0ZV90
aW1lc3RhbXAoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCB2b2lkICpzbG90LCBpbnQgaWR4KQor
eworCWNvbnN0IHUzMiBvZmZzZXQgPQorCQlpOTE1X2dndHRfb2Zmc2V0KGNlLT5lbmdpbmUtPnN0
YXR1c19wYWdlLnZtYSkgKworCQlvZmZzZXRfaW5fcGFnZShzbG90KTsKKwlzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICpycTsKKwl1MzIgKmNzOworCWludCBlcnI7CisKKwlycSA9IGludGVsX2NvbnRleHRf
Y3JlYXRlX3JlcXVlc3QoY2UpOworCWlmIChJU19FUlIocnEpKQorCQlyZXR1cm4gcnE7CisKKwlj
cyA9IGludGVsX3JpbmdfYmVnaW4ocnEsIDEwKTsKKwlpZiAoSVNfRVJSKGNzKSkgeworCQllcnIg
PSBQVFJfRVJSKGNzKTsKKwkJZ290byBlcnI7CisJfQorCisJKmNzKysgPSBNSV9BUkJfT05fT0ZG
IHwgTUlfQVJCX0VOQUJMRTsKKwkqY3MrKyA9IE1JX05PT1A7CisKKwkqY3MrKyA9IE1JX1NFTUFQ
SE9SRV9XQUlUIHwKKwkJTUlfU0VNQVBIT1JFX0dMT0JBTF9HVFQgfAorCQlNSV9TRU1BUEhPUkVf
UE9MTCB8CisJCU1JX1NFTUFQSE9SRV9TQURfTkVRX1NERDsKKwkqY3MrKyA9IDA7CisJKmNzKysg
PSBvZmZzZXQ7CisJKmNzKysgPSAwOworCisJKmNzKysgPSBNSV9TVE9SRV9SRUdJU1RFUl9NRU1f
R0VOOCB8IE1JX1VTRV9HR1RUOworCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19D
VFhfVElNRVNUQU1QKHJxLT5lbmdpbmUtPm1taW9fYmFzZSkpOworCSpjcysrID0gb2Zmc2V0ICsg
aWR4ICogc2l6ZW9mKHUzMik7CisJKmNzKysgPSAwOworCisJaW50ZWxfcmluZ19hZHZhbmNlKHJx
LCBjcyk7CisKKwlycS0+c2NoZWQuYXR0ci5wcmlvcml0eSA9IEk5MTVfUFJJT1JJVFlfTUFTSzsK
KwllcnIgPSAwOworZXJyOgorCWk5MTVfcmVxdWVzdF9nZXQocnEpOworCWk5MTVfcmVxdWVzdF9h
ZGQocnEpOworCWlmIChlcnIpIHsKKwkJaTkxNV9yZXF1ZXN0X3B1dChycSk7CisJCXJldHVybiBF
UlJfUFRSKGVycik7CisJfQorCisJcmV0dXJuIHJxOworfQorCitzdHJ1Y3QgbHJjX3RpbWVzdGFt
cCB7CisJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOworCXN0cnVjdCBpbnRlbF9jb250
ZXh0ICpjZVsyXTsKKwl1MzIgcG9pc29uOworfTsKKworc3RhdGljIGJvb2wgdGltZXN0YW1wX2Fk
dmFuY2VkKHUzMiBzdGFydCwgdTMyIGVuZCkKK3sKKwlyZXR1cm4gKHMzMikoZW5kIC0gc3RhcnQp
ID4gMDsKK30KKworc3RhdGljIGludCBfX2xyY190aW1lc3RhbXAoY29uc3Qgc3RydWN0IGxyY190
aW1lc3RhbXAgKmFyZywgYm9vbCBwcmVlbXB0KQoreworCXUzMiAqc2xvdCA9IG1lbXNldDMyKGFy
Zy0+ZW5naW5lLT5zdGF0dXNfcGFnZS5hZGRyICsgMTAwMCwgMCwgNCk7CisJc3RydWN0IGk5MTVf
cmVxdWVzdCAqcnE7CisJdTMyIHRpbWVzdGFtcDsKKwlpbnQgZXJyID0gMDsKKworCWFyZy0+Y2Vb
MF0tPmxyY19yZWdfc3RhdGVbQ1RYX1RJTUVTVEFNUF0gPSBhcmctPnBvaXNvbjsKKwlycSA9IGNy
ZWF0ZV90aW1lc3RhbXAoYXJnLT5jZVswXSwgc2xvdCwgMSk7CisJaWYgKElTX0VSUihycSkpCisJ
CXJldHVybiBQVFJfRVJSKHJxKTsKKworCWVyciA9IHdhaXRfZm9yX3N1Ym1pdChycS0+ZW5naW5l
LCBycSwgSFogLyAyKTsKKwlpZiAoZXJyKQorCQlnb3RvIGVycjsKKworCWlmIChwcmVlbXB0KSB7
CisJCWFyZy0+Y2VbMV0tPmxyY19yZWdfc3RhdGVbQ1RYX1RJTUVTVEFNUF0gPSAweGRlYWRiZWVm
OworCQllcnIgPSBlbWl0X3NlbWFwaG9yZV9zaWduYWwoYXJnLT5jZVsxXSwgc2xvdCk7CisJCWlm
IChlcnIpCisJCQlnb3RvIGVycjsKKwl9IGVsc2UgeworCQlzbG90WzBdID0gMTsKKwkJd21iKCk7
CisJfQorCisJLyogQW5kIHdhaXQgZm9yIHN3aXRjaCB0byBrZXJuZWwgKHRvIHNhdmUgb3VyIGNv
bnRleHQgdG8gbWVtb3J5KSAqLworCWVyciA9IGNvbnRleHRfZmx1c2goYXJnLT5jZVswXSwgSFog
LyAyKTsKKwlpZiAoZXJyKQorCQlnb3RvIGVycjsKKworCWlmICghdGltZXN0YW1wX2FkdmFuY2Vk
KGFyZy0+cG9pc29uLCBzbG90WzFdKSkgeworCQlwcl9lcnIoIiVzKCVzKTogaW52YWxpZCB0aW1l
c3RhbXAgb24gcmVzdG9yZSwgY29udGV4dDoleCwgcmVxdWVzdDoleFxuIiwKKwkJICAgICAgIGFy
Zy0+ZW5naW5lLT5uYW1lLCBwcmVlbXB0ID8gInByZWVtcHQiIDogInNpbXBsZSIsCisJCSAgICAg
ICBhcmctPnBvaXNvbiwgc2xvdFsxXSk7CisJCWVyciA9IC1FSU5WQUw7CisJfQorCisJdGltZXN0
YW1wID0gUkVBRF9PTkNFKGFyZy0+Y2VbMF0tPmxyY19yZWdfc3RhdGVbQ1RYX1RJTUVTVEFNUF0p
OworCWlmICghdGltZXN0YW1wX2FkdmFuY2VkKHNsb3RbMV0sIHRpbWVzdGFtcCkpIHsKKwkJcHJf
ZXJyKCIlcyglcyk6IGludmFsaWQgdGltZXN0YW1wIG9uIHNhdmUsIHJlcXVlc3Q6JXgsIGNvbnRl
eHQ6JXhcbiIsCisJCSAgICAgICBhcmctPmVuZ2luZS0+bmFtZSwgcHJlZW1wdCA/ICJwcmVlbXB0
IiA6ICJzaW1wbGUiLAorCQkgICAgICAgc2xvdFsxXSwgdGltZXN0YW1wKTsKKwkJZXJyID0gLUVJ
TlZBTDsKKwl9CisKK2VycjoKKwltZW1zZXQzMihzbG90LCAtMSwgNCk7CisJaTkxNV9yZXF1ZXN0
X3B1dChycSk7CisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIGludCBsaXZlX2xyY190aW1lc3Rh
bXAodm9pZCAqYXJnKQoreworCXN0cnVjdCBscmNfdGltZXN0YW1wIGRhdGEgPSB7fTsKKwlzdHJ1
Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOworCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOworCWNvbnN0
IHUzMiBwb2lzb25bXSA9IHsKKwkJMCwKKwkJUzMyX01BWCwKKwkJKHUzMilTMzJfTUFYICsgMSwK
KwkJVTMyX01BWCwKKwl9OworCisJLyoKKwkgKiBXZSB3YW50IHRvIHZlcmlmeSB0aGF0IHRoZSB0
aW1lc3RhbXAgaXMgc2F2ZWQgYW5kIHJlc3RvcmUgYWNyb3NzCisJICogY29udGV4dCBzd2l0Y2hl
cyBhbmQgaXMgbW9ub3RvbmljLgorCSAqCisJICogU28gd2UgZG8gdGhpcyB3aXRoIGEgbGl0dGxl
IGJpdCBvZiBMUkMgcG9pc29uaW5nIHRvIGNoZWNrIHZhcmlvdXMKKwkgKiBib3VuZGFyeSBjb25k
aXRpb25zLCBhbmQgc2VlIHdoYXQgaGFwcGVucyBpZiB3ZSBwcmVlbXB0IHRoZSBjb250ZXh0CisJ
ICogd2l0aCBhIHNlY29uZCByZXF1ZXN0IChjYXJyeWluZyBtb3JlIHBvaXNvbiBpbnRvIHRoZSB0
aW1lc3RhbXApLgorCSAqLworCisJZm9yX2VhY2hfZW5naW5lKGRhdGEuZW5naW5lLCBndCwgaWQp
IHsKKwkJaW50IGksIGVyciA9IDA7CisKKwkJc3RfZW5naW5lX2hlYXJ0YmVhdF9kaXNhYmxlKGRh
dGEuZW5naW5lKTsKKworCQlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShkYXRhLmNlKTsgaSsr
KSB7CisJCQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqdG1wOworCisJCQl0bXAgPSBpbnRlbF9jb250
ZXh0X2NyZWF0ZShkYXRhLmVuZ2luZSk7CisJCQlpZiAoSVNfRVJSKHRtcCkpIHsKKwkJCQllcnIg
PSBQVFJfRVJSKHRtcCk7CisJCQkJZ290byBlcnI7CisJCQl9CisKKwkJCWVyciA9IGludGVsX2Nv
bnRleHRfcGluKHRtcCk7CisJCQlpZiAoZXJyKSB7CisJCQkJaW50ZWxfY29udGV4dF9wdXQodG1w
KTsKKwkJCQlnb3RvIGVycjsKKwkJCX0KKworCQkJZGF0YS5jZVtpXSA9IHRtcDsKKwkJfQorCisJ
CWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKHBvaXNvbik7IGkrKykgeworCQkJZGF0YS5wb2lz
b24gPSBwb2lzb25baV07CisKKwkJCWVyciA9IF9fbHJjX3RpbWVzdGFtcCgmZGF0YSwgZmFsc2Up
OworCQkJaWYgKGVycikKKwkJCQlicmVhazsKKworCQkJZXJyID0gX19scmNfdGltZXN0YW1wKCZk
YXRhLCB0cnVlKTsKKwkJCWlmIChlcnIpCisJCQkJYnJlYWs7CisJCX0KKworZXJyOgorCQlzdF9l
bmdpbmVfaGVhcnRiZWF0X2VuYWJsZShkYXRhLmVuZ2luZSk7CisJCWZvciAoaSA9IDA7IGkgPCBB
UlJBWV9TSVpFKGRhdGEuY2UpOyBpKyspIHsKKwkJCWlmICghZGF0YS5jZVtpXSkKKwkJCQlicmVh
azsKKworCQkJaW50ZWxfY29udGV4dF91bnBpbihkYXRhLmNlW2ldKTsKKwkJCWludGVsX2NvbnRl
eHRfcHV0KGRhdGEuY2VbaV0pOworCQl9CisKKwkJaWYgKGlndF9mbHVzaF90ZXN0KGd0LT5pOTE1
KSkKKwkJCWVyciA9IC1FSU87CisJCWlmIChlcnIpCisJCQlyZXR1cm4gZXJyOworCX0KKworCXJl
dHVybiAwOworfQorCitzdGF0aWMgc3RydWN0IGk5MTVfdm1hICoKK2NyZWF0ZV91c2VyX3ZtYShz
dHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSwgdW5zaWduZWQgbG9uZyBzaXplKQoreworCXN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CisJc3RydWN0IGk5MTVfdm1hICp2bWE7CisJ
aW50IGVycjsKKworCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfaW50ZXJuYWwodm0tPmk5
MTUsIHNpemUpOworCWlmIChJU19FUlIob2JqKSkKKwkJcmV0dXJuIEVSUl9DQVNUKG9iaik7CisK
Kwl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosIHZtLCBOVUxMKTsKKwlpZiAoSVNfRVJSKHZt
YSkpIHsKKwkJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOworCQlyZXR1cm4gdm1hOworCX0KKwor
CWVyciA9IGk5MTVfdm1hX3Bpbih2bWEsIDAsIDAsIFBJTl9VU0VSKTsKKwlpZiAoZXJyKSB7CisJ
CWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKKwkJcmV0dXJuIEVSUl9QVFIoZXJyKTsKKwl9CisK
KwlyZXR1cm4gdm1hOworfQorCitzdGF0aWMgc3RydWN0IGk5MTVfdm1hICoKK3N0b3JlX2NvbnRl
eHQoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCBzdHJ1Y3QgaTkxNV92bWEgKnNjcmF0Y2gpCit7
CisJc3RydWN0IGk5MTVfdm1hICpiYXRjaDsKKwl1MzIgZHcsIHgsICpjcywgKmh3OworCXUzMiAq
ZGVmYXVsdHM7CisKKwliYXRjaCA9IGNyZWF0ZV91c2VyX3ZtYShjZS0+dm0sIFNaXzY0Syk7CisJ
aWYgKElTX0VSUihiYXRjaCkpCisJCXJldHVybiBiYXRjaDsKKworCWNzID0gaTkxNV9nZW1fb2Jq
ZWN0X3Bpbl9tYXAoYmF0Y2gtPm9iaiwgSTkxNV9NQVBfV0MpOworCWlmIChJU19FUlIoY3MpKSB7
CisJCWk5MTVfdm1hX3B1dChiYXRjaCk7CisJCXJldHVybiBFUlJfQ0FTVChjcyk7CisJfQorCisJ
ZGVmYXVsdHMgPSBzaG1lbV9waW5fbWFwKGNlLT5lbmdpbmUtPmRlZmF1bHRfc3RhdGUpOworCWlm
ICghZGVmYXVsdHMpIHsKKwkJaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChiYXRjaC0+b2JqKTsK
KwkJaTkxNV92bWFfcHV0KGJhdGNoKTsKKwkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7CisJfQor
CisJeCA9IDA7CisJZHcgPSAwOworCWh3ID0gZGVmYXVsdHM7CisJaHcgKz0gTFJDX1NUQVRFX09G
RlNFVCAvIHNpemVvZigqaHcpOworCWRvIHsKKwkJdTMyIGxlbiA9IGh3W2R3XSAmIDB4N2Y7CisK
KwkJaWYgKGh3W2R3XSA9PSAwKSB7CisJCQlkdysrOworCQkJY29udGludWU7CisJCX0KKworCQlp
ZiAoKGh3W2R3XSAmIEdFTk1BU0soMzEsIDIzKSkgIT0gTUlfSU5TVFIoMHgyMiwgMCkpIHsKKwkJ
CWR3ICs9IGxlbiArIDI7CisJCQljb250aW51ZTsKKwkJfQorCisJCWR3Kys7CisJCWxlbiA9IChs
ZW4gKyAxKSAvIDI7CisJCXdoaWxlIChsZW4tLSkgeworCQkJKmNzKysgPSBNSV9TVE9SRV9SRUdJ
U1RFUl9NRU1fR0VOODsKKwkJCSpjcysrID0gaHdbZHddOworCQkJKmNzKysgPSBsb3dlcl8zMl9i
aXRzKHNjcmF0Y2gtPm5vZGUuc3RhcnQgKyB4KTsKKwkJCSpjcysrID0gdXBwZXJfMzJfYml0cyhz
Y3JhdGNoLT5ub2RlLnN0YXJ0ICsgeCk7CisKKwkJCWR3ICs9IDI7CisJCQl4ICs9IDQ7CisJCX0K
Kwl9IHdoaWxlIChkdyA8IFBBR0VfU0laRSAvIHNpemVvZih1MzIpICYmCisJCSAoaHdbZHddICYg
fkJJVCgwKSkgIT0gTUlfQkFUQ0hfQlVGRkVSX0VORCk7CisKKwkqY3MrKyA9IE1JX0JBVENIX0JV
RkZFUl9FTkQ7CisKKwlzaG1lbV91bnBpbl9tYXAoY2UtPmVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSwg
ZGVmYXVsdHMpOworCisJaTkxNV9nZW1fb2JqZWN0X2ZsdXNoX21hcChiYXRjaC0+b2JqKTsKKwlp
OTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKGJhdGNoLT5vYmopOworCisJcmV0dXJuIGJhdGNoOwor
fQorCitzdGF0aWMgaW50IG1vdmVfdG9fYWN0aXZlKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAor
CQkJICBzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKKwkJCSAgdW5zaWduZWQgaW50IGZsYWdzKQorewor
CWludCBlcnI7CisKKwlpOTE1X3ZtYV9sb2NrKHZtYSk7CisJZXJyID0gaTkxNV9yZXF1ZXN0X2F3
YWl0X29iamVjdChycSwgdm1hLT5vYmosIGZsYWdzKTsKKwlpZiAoIWVycikKKwkJZXJyID0gaTkx
NV92bWFfbW92ZV90b19hY3RpdmUodm1hLCBycSwgZmxhZ3MpOworCWk5MTVfdm1hX3VubG9jayh2
bWEpOworCisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIHN0cnVjdCBpOTE1X3JlcXVlc3QgKgor
cmVjb3JkX3JlZ2lzdGVycyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCisJCSBzdHJ1Y3QgaTkx
NV92bWEgKmJlZm9yZSwKKwkJIHN0cnVjdCBpOTE1X3ZtYSAqYWZ0ZXIsCisJCSB1MzIgKnNlbWEp
Cit7CisJc3RydWN0IGk5MTVfdm1hICpiX2JlZm9yZSwgKmJfYWZ0ZXI7CisJc3RydWN0IGk5MTVf
cmVxdWVzdCAqcnE7CisJdTMyICpjczsKKwlpbnQgZXJyOworCisJYl9iZWZvcmUgPSBzdG9yZV9j
b250ZXh0KGNlLCBiZWZvcmUpOworCWlmIChJU19FUlIoYl9iZWZvcmUpKQorCQlyZXR1cm4gRVJS
X0NBU1QoYl9iZWZvcmUpOworCisJYl9hZnRlciA9IHN0b3JlX2NvbnRleHQoY2UsIGFmdGVyKTsK
KwlpZiAoSVNfRVJSKGJfYWZ0ZXIpKSB7CisJCXJxID0gRVJSX0NBU1QoYl9hZnRlcik7CisJCWdv
dG8gZXJyX2JlZm9yZTsKKwl9CisKKwlycSA9IGludGVsX2NvbnRleHRfY3JlYXRlX3JlcXVlc3Qo
Y2UpOworCWlmIChJU19FUlIocnEpKQorCQlnb3RvIGVycl9hZnRlcjsKKworCWVyciA9IG1vdmVf
dG9fYWN0aXZlKHJxLCBiZWZvcmUsIEVYRUNfT0JKRUNUX1dSSVRFKTsKKwlpZiAoZXJyKQorCQln
b3RvIGVycl9ycTsKKworCWVyciA9IG1vdmVfdG9fYWN0aXZlKHJxLCBiX2JlZm9yZSwgMCk7CisJ
aWYgKGVycikKKwkJZ290byBlcnJfcnE7CisKKwllcnIgPSBtb3ZlX3RvX2FjdGl2ZShycSwgYWZ0
ZXIsIEVYRUNfT0JKRUNUX1dSSVRFKTsKKwlpZiAoZXJyKQorCQlnb3RvIGVycl9ycTsKKworCWVy
ciA9IG1vdmVfdG9fYWN0aXZlKHJxLCBiX2FmdGVyLCAwKTsKKwlpZiAoZXJyKQorCQlnb3RvIGVy
cl9ycTsKKworCWNzID0gaW50ZWxfcmluZ19iZWdpbihycSwgMTQpOworCWlmIChJU19FUlIoY3Mp
KSB7CisJCWVyciA9IFBUUl9FUlIoY3MpOworCQlnb3RvIGVycl9ycTsKKwl9CisKKwkqY3MrKyA9
IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJfRElTQUJMRTsKKwkqY3MrKyA9IE1JX0JBVENIX0JVRkZF
Ul9TVEFSVF9HRU44IHwgQklUKDgpOworCSpjcysrID0gbG93ZXJfMzJfYml0cyhiX2JlZm9yZS0+
bm9kZS5zdGFydCk7CisJKmNzKysgPSB1cHBlcl8zMl9iaXRzKGJfYmVmb3JlLT5ub2RlLnN0YXJ0
KTsKKworCSpjcysrID0gTUlfQVJCX09OX09GRiB8IE1JX0FSQl9FTkFCTEU7CisJKmNzKysgPSBN
SV9TRU1BUEhPUkVfV0FJVCB8CisJCU1JX1NFTUFQSE9SRV9HTE9CQUxfR1RUIHwKKwkJTUlfU0VN
QVBIT1JFX1BPTEwgfAorCQlNSV9TRU1BUEhPUkVfU0FEX05FUV9TREQ7CisJKmNzKysgPSAwOwor
CSpjcysrID0gaTkxNV9nZ3R0X29mZnNldChjZS0+ZW5naW5lLT5zdGF0dXNfcGFnZS52bWEpICsK
KwkJb2Zmc2V0X2luX3BhZ2Uoc2VtYSk7CisJKmNzKysgPSAwOworCSpjcysrID0gTUlfTk9PUDsK
KworCSpjcysrID0gTUlfQVJCX09OX09GRiB8IE1JX0FSQl9ESVNBQkxFOworCSpjcysrID0gTUlf
QkFUQ0hfQlVGRkVSX1NUQVJUX0dFTjggfCBCSVQoOCk7CisJKmNzKysgPSBsb3dlcl8zMl9iaXRz
KGJfYWZ0ZXItPm5vZGUuc3RhcnQpOworCSpjcysrID0gdXBwZXJfMzJfYml0cyhiX2FmdGVyLT5u
b2RlLnN0YXJ0KTsKKworCWludGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOworCisJV1JJVEVfT05D
RSgqc2VtYSwgMCk7CisJaTkxNV9yZXF1ZXN0X2dldChycSk7CisJaTkxNV9yZXF1ZXN0X2FkZChy
cSk7CitlcnJfYWZ0ZXI6CisJaTkxNV92bWFfcHV0KGJfYWZ0ZXIpOworZXJyX2JlZm9yZToKKwlp
OTE1X3ZtYV9wdXQoYl9iZWZvcmUpOworCXJldHVybiBycTsKKworZXJyX3JxOgorCWk5MTVfcmVx
dWVzdF9hZGQocnEpOworCXJxID0gRVJSX1BUUihlcnIpOworCWdvdG8gZXJyX2FmdGVyOworfQor
CitzdGF0aWMgc3RydWN0IGk5MTVfdm1hICpsb2FkX2NvbnRleHQoc3RydWN0IGludGVsX2NvbnRl
eHQgKmNlLCB1MzIgcG9pc29uKQoreworCXN0cnVjdCBpOTE1X3ZtYSAqYmF0Y2g7CisJdTMyIGR3
LCAqY3MsICpodzsKKwl1MzIgKmRlZmF1bHRzOworCisJYmF0Y2ggPSBjcmVhdGVfdXNlcl92bWEo
Y2UtPnZtLCBTWl82NEspOworCWlmIChJU19FUlIoYmF0Y2gpKQorCQlyZXR1cm4gYmF0Y2g7CisK
KwljcyA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKGJhdGNoLT5vYmosIEk5MTVfTUFQX1dDKTsK
KwlpZiAoSVNfRVJSKGNzKSkgeworCQlpOTE1X3ZtYV9wdXQoYmF0Y2gpOworCQlyZXR1cm4gRVJS
X0NBU1QoY3MpOworCX0KKworCWRlZmF1bHRzID0gc2htZW1fcGluX21hcChjZS0+ZW5naW5lLT5k
ZWZhdWx0X3N0YXRlKTsKKwlpZiAoIWRlZmF1bHRzKSB7CisJCWk5MTVfZ2VtX29iamVjdF91bnBp
bl9tYXAoYmF0Y2gtPm9iaik7CisJCWk5MTVfdm1hX3B1dChiYXRjaCk7CisJCXJldHVybiBFUlJf
UFRSKC1FTk9NRU0pOworCX0KKworCWR3ID0gMDsKKwlodyA9IGRlZmF1bHRzOworCWh3ICs9IExS
Q19TVEFURV9PRkZTRVQgLyBzaXplb2YoKmh3KTsKKwlkbyB7CisJCXUzMiBsZW4gPSBod1tkd10g
JiAweDdmOworCisJCWlmIChod1tkd10gPT0gMCkgeworCQkJZHcrKzsKKwkJCWNvbnRpbnVlOwor
CQl9CisKKwkJaWYgKChod1tkd10gJiBHRU5NQVNLKDMxLCAyMykpICE9IE1JX0lOU1RSKDB4MjIs
IDApKSB7CisJCQlkdyArPSBsZW4gKyAyOworCQkJY29udGludWU7CisJCX0KKworCQlkdysrOwor
CQlsZW4gPSAobGVuICsgMSkgLyAyOworCQkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKGxl
bik7CisJCXdoaWxlIChsZW4tLSkgeworCQkJKmNzKysgPSBod1tkd107CisJCQkqY3MrKyA9IHBv
aXNvbjsKKwkJCWR3ICs9IDI7CisJCX0KKwl9IHdoaWxlIChkdyA8IFBBR0VfU0laRSAvIHNpemVv
Zih1MzIpICYmCisJCSAoaHdbZHddICYgfkJJVCgwKSkgIT0gTUlfQkFUQ0hfQlVGRkVSX0VORCk7
CisKKwkqY3MrKyA9IE1JX0JBVENIX0JVRkZFUl9FTkQ7CisKKwlzaG1lbV91bnBpbl9tYXAoY2Ut
PmVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSwgZGVmYXVsdHMpOworCisJaTkxNV9nZW1fb2JqZWN0X2Zs
dXNoX21hcChiYXRjaC0+b2JqKTsKKwlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKGJhdGNoLT5v
YmopOworCisJcmV0dXJuIGJhdGNoOworfQorCitzdGF0aWMgaW50IHBvaXNvbl9yZWdpc3RlcnMo
c3RydWN0IGludGVsX2NvbnRleHQgKmNlLCB1MzIgcG9pc29uLCB1MzIgKnNlbWEpCit7CisJc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnE7CisJc3RydWN0IGk5MTVfdm1hICpiYXRjaDsKKwl1MzIgKmNz
OworCWludCBlcnI7CisKKwliYXRjaCA9IGxvYWRfY29udGV4dChjZSwgcG9pc29uKTsKKwlpZiAo
SVNfRVJSKGJhdGNoKSkKKwkJcmV0dXJuIFBUUl9FUlIoYmF0Y2gpOworCisJcnEgPSBpbnRlbF9j
b250ZXh0X2NyZWF0ZV9yZXF1ZXN0KGNlKTsKKwlpZiAoSVNfRVJSKHJxKSkgeworCQllcnIgPSBQ
VFJfRVJSKHJxKTsKKwkJZ290byBlcnJfYmF0Y2g7CisJfQorCisJZXJyID0gbW92ZV90b19hY3Rp
dmUocnEsIGJhdGNoLCAwKTsKKwlpZiAoZXJyKQorCQlnb3RvIGVycl9ycTsKKworCWNzID0gaW50
ZWxfcmluZ19iZWdpbihycSwgOCk7CisJaWYgKElTX0VSUihjcykpIHsKKwkJZXJyID0gUFRSX0VS
Uihjcyk7CisJCWdvdG8gZXJyX3JxOworCX0KKworCSpjcysrID0gTUlfQVJCX09OX09GRiB8IE1J
X0FSQl9ESVNBQkxFOworCSpjcysrID0gTUlfQkFUQ0hfQlVGRkVSX1NUQVJUX0dFTjggfCBCSVQo
OCk7CisJKmNzKysgPSBsb3dlcl8zMl9iaXRzKGJhdGNoLT5ub2RlLnN0YXJ0KTsKKwkqY3MrKyA9
IHVwcGVyXzMyX2JpdHMoYmF0Y2gtPm5vZGUuc3RhcnQpOworCisJKmNzKysgPSBNSV9TVE9SRV9E
V09SRF9JTU1fR0VONCB8IE1JX1VTRV9HR1RUOworCSpjcysrID0gaTkxNV9nZ3R0X29mZnNldChj
ZS0+ZW5naW5lLT5zdGF0dXNfcGFnZS52bWEpICsKKwkJb2Zmc2V0X2luX3BhZ2Uoc2VtYSk7CisJ
KmNzKysgPSAwOworCSpjcysrID0gMTsKKworCWludGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOwor
CisJcnEtPnNjaGVkLmF0dHIucHJpb3JpdHkgPSBJOTE1X1BSSU9SSVRZX0JBUlJJRVI7CitlcnJf
cnE6CisJaTkxNV9yZXF1ZXN0X2FkZChycSk7CitlcnJfYmF0Y2g6CisJaTkxNV92bWFfcHV0KGJh
dGNoKTsKKwlyZXR1cm4gZXJyOworfQorCitzdGF0aWMgYm9vbCBpc19tb3ZpbmcodTMyIGEsIHUz
MiBiKQoreworCXJldHVybiBhICE9IGI7Cit9CisKK3N0YXRpYyBpbnQgY29tcGFyZV9pc29sYXRp
b24oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAorCQkJICAgICBzdHJ1Y3QgaTkxNV92
bWEgKnJlZlsyXSwKKwkJCSAgICAgc3RydWN0IGk5MTVfdm1hICpyZXN1bHRbMl0sCisJCQkgICAg
IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJCSAgICAgdTMyIHBvaXNvbikKK3sKKwl1MzIg
eCwgZHcsICpodywgKmxyYzsKKwl1MzIgKkFbMl0sICpCWzJdOworCXUzMiAqZGVmYXVsdHM7CisJ
aW50IGVyciA9IDA7CisKKwlBWzBdID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAocmVmWzBdLT5v
YmosIEk5MTVfTUFQX1dDKTsKKwlpZiAoSVNfRVJSKEFbMF0pKQorCQlyZXR1cm4gUFRSX0VSUihB
WzBdKTsKKworCUFbMV0gPSBpOTE1X2dlbV9vYmplY3RfcGluX21hcChyZWZbMV0tPm9iaiwgSTkx
NV9NQVBfV0MpOworCWlmIChJU19FUlIoQVsxXSkpIHsKKwkJZXJyID0gUFRSX0VSUihBWzFdKTsK
KwkJZ290byBlcnJfQTA7CisJfQorCisJQlswXSA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKHJl
c3VsdFswXS0+b2JqLCBJOTE1X01BUF9XQyk7CisJaWYgKElTX0VSUihCWzBdKSkgeworCQllcnIg
PSBQVFJfRVJSKEJbMF0pOworCQlnb3RvIGVycl9BMTsKKwl9CisKKwlCWzFdID0gaTkxNV9nZW1f
b2JqZWN0X3Bpbl9tYXAocmVzdWx0WzFdLT5vYmosIEk5MTVfTUFQX1dDKTsKKwlpZiAoSVNfRVJS
KEJbMV0pKSB7CisJCWVyciA9IFBUUl9FUlIoQlsxXSk7CisJCWdvdG8gZXJyX0IwOworCX0KKwor
CWxyYyA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKGNlLT5zdGF0ZS0+b2JqLAorCQkJCSAgICAg
IGk5MTVfY29oZXJlbnRfbWFwX3R5cGUoZW5naW5lLT5pOTE1KSk7CisJaWYgKElTX0VSUihscmMp
KSB7CisJCWVyciA9IFBUUl9FUlIobHJjKTsKKwkJZ290byBlcnJfQjE7CisJfQorCWxyYyArPSBM
UkNfU1RBVEVfT0ZGU0VUIC8gc2l6ZW9mKCpodyk7CisKKwlkZWZhdWx0cyA9IHNobWVtX3Bpbl9t
YXAoY2UtPmVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSk7CisJaWYgKCFkZWZhdWx0cykgeworCQllcnIg
PSAtRU5PTUVNOworCQlnb3RvIGVycl9scmM7CisJfQorCisJeCA9IDA7CisJZHcgPSAwOworCWh3
ID0gZGVmYXVsdHM7CisJaHcgKz0gTFJDX1NUQVRFX09GRlNFVCAvIHNpemVvZigqaHcpOworCWRv
IHsKKwkJdTMyIGxlbiA9IGh3W2R3XSAmIDB4N2Y7CisKKwkJaWYgKGh3W2R3XSA9PSAwKSB7CisJ
CQlkdysrOworCQkJY29udGludWU7CisJCX0KKworCQlpZiAoKGh3W2R3XSAmIEdFTk1BU0soMzEs
IDIzKSkgIT0gTUlfSU5TVFIoMHgyMiwgMCkpIHsKKwkJCWR3ICs9IGxlbiArIDI7CisJCQljb250
aW51ZTsKKwkJfQorCisJCWR3Kys7CisJCWxlbiA9IChsZW4gKyAxKSAvIDI7CisJCXdoaWxlIChs
ZW4tLSkgeworCQkJaWYgKCFpc19tb3ZpbmcoQVswXVt4XSwgQVsxXVt4XSkgJiYKKwkJCSAgICAo
QVswXVt4XSAhPSBCWzBdW3hdIHx8IEFbMV1beF0gIT0gQlsxXVt4XSkpIHsKKwkJCQlzd2l0Y2gg
KGh3W2R3XSAmIDQwOTUpIHsKKwkJCQljYXNlIDB4MzA6IC8qIFJJTkdfSEVBRCAqLworCQkJCWNh
c2UgMHgzNDogLyogUklOR19UQUlMICovCisJCQkJCWJyZWFrOworCisJCQkJZGVmYXVsdDoKKwkJ
CQkJcHJfZXJyKCIlc1slZF06IE1pc21hdGNoIGZvciByZWdpc3RlciAlNHgsIGRlZmF1bHQgJTA4
eCwgcmVmZXJlbmNlICUwOHgsIHJlc3VsdCAoJTA4eCwgJTA4eCksIHBvaXNvbiAlMDh4LCBjb250
ZXh0ICUwOHhcbiIsCisJCQkJCSAgICAgICBlbmdpbmUtPm5hbWUsIGR3LAorCQkJCQkgICAgICAg
aHdbZHddLCBod1tkdyArIDFdLAorCQkJCQkgICAgICAgQVswXVt4XSwgQlswXVt4XSwgQlsxXVt4
XSwKKwkJCQkJICAgICAgIHBvaXNvbiwgbHJjW2R3ICsgMV0pOworCQkJCQllcnIgPSAtRUlOVkFM
OworCQkJCX0KKwkJCX0KKwkJCWR3ICs9IDI7CisJCQl4Kys7CisJCX0KKwl9IHdoaWxlIChkdyA8
IFBBR0VfU0laRSAvIHNpemVvZih1MzIpICYmCisJCSAoaHdbZHddICYgfkJJVCgwKSkgIT0gTUlf
QkFUQ0hfQlVGRkVSX0VORCk7CisKKwlzaG1lbV91bnBpbl9tYXAoY2UtPmVuZ2luZS0+ZGVmYXVs
dF9zdGF0ZSwgZGVmYXVsdHMpOworZXJyX2xyYzoKKwlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFw
KGNlLT5zdGF0ZS0+b2JqKTsKK2Vycl9CMToKKwlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHJl
c3VsdFsxXS0+b2JqKTsKK2Vycl9CMDoKKwlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHJlc3Vs
dFswXS0+b2JqKTsKK2Vycl9BMToKKwlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHJlZlsxXS0+
b2JqKTsKK2Vycl9BMDoKKwlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHJlZlswXS0+b2JqKTsK
KwlyZXR1cm4gZXJyOworfQorCitzdGF0aWMgaW50IF9fbHJjX2lzb2xhdGlvbihzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUsIHUzMiBwb2lzb24pCit7CisJdTMyICpzZW1hID0gbWVtc2V0
MzIoZW5naW5lLT5zdGF0dXNfcGFnZS5hZGRyICsgMTAwMCwgMCwgMSk7CisJc3RydWN0IGk5MTVf
dm1hICpyZWZbMl0sICpyZXN1bHRbMl07CisJc3RydWN0IGludGVsX2NvbnRleHQgKkEsICpCOwor
CXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOworCWludCBlcnI7CisKKwlBID0gaW50ZWxfY29udGV4
dF9jcmVhdGUoZW5naW5lKTsKKwlpZiAoSVNfRVJSKEEpKQorCQlyZXR1cm4gUFRSX0VSUihBKTsK
KworCUIgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZShlbmdpbmUpOworCWlmIChJU19FUlIoQikpIHsK
KwkJZXJyID0gUFRSX0VSUihCKTsKKwkJZ290byBlcnJfQTsKKwl9CisKKwlyZWZbMF0gPSBjcmVh
dGVfdXNlcl92bWEoQS0+dm0sIFNaXzY0Syk7CisJaWYgKElTX0VSUihyZWZbMF0pKSB7CisJCWVy
ciA9IFBUUl9FUlIocmVmWzBdKTsKKwkJZ290byBlcnJfQjsKKwl9CisKKwlyZWZbMV0gPSBjcmVh
dGVfdXNlcl92bWEoQS0+dm0sIFNaXzY0Syk7CisJaWYgKElTX0VSUihyZWZbMV0pKSB7CisJCWVy
ciA9IFBUUl9FUlIocmVmWzFdKTsKKwkJZ290byBlcnJfcmVmMDsKKwl9CisKKwlycSA9IHJlY29y
ZF9yZWdpc3RlcnMoQSwgcmVmWzBdLCByZWZbMV0sIHNlbWEpOworCWlmIChJU19FUlIocnEpKSB7
CisJCWVyciA9IFBUUl9FUlIocnEpOworCQlnb3RvIGVycl9yZWYxOworCX0KKworCVdSSVRFX09O
Q0UoKnNlbWEsIDEpOworCXdtYigpOworCisJaWYgKGk5MTVfcmVxdWVzdF93YWl0KHJxLCAwLCBI
WiAvIDIpIDwgMCkgeworCQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKKwkJZXJyID0gLUVUSU1FOwor
CQlnb3RvIGVycl9yZWYxOworCX0KKwlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKKworCXJlc3VsdFsw
XSA9IGNyZWF0ZV91c2VyX3ZtYShBLT52bSwgU1pfNjRLKTsKKwlpZiAoSVNfRVJSKHJlc3VsdFsw
XSkpIHsKKwkJZXJyID0gUFRSX0VSUihyZXN1bHRbMF0pOworCQlnb3RvIGVycl9yZWYxOworCX0K
KworCXJlc3VsdFsxXSA9IGNyZWF0ZV91c2VyX3ZtYShBLT52bSwgU1pfNjRLKTsKKwlpZiAoSVNf
RVJSKHJlc3VsdFsxXSkpIHsKKwkJZXJyID0gUFRSX0VSUihyZXN1bHRbMV0pOworCQlnb3RvIGVy
cl9yZXN1bHQwOworCX0KKworCXJxID0gcmVjb3JkX3JlZ2lzdGVycyhBLCByZXN1bHRbMF0sIHJl
c3VsdFsxXSwgc2VtYSk7CisJaWYgKElTX0VSUihycSkpIHsKKwkJZXJyID0gUFRSX0VSUihycSk7
CisJCWdvdG8gZXJyX3Jlc3VsdDE7CisJfQorCisJZXJyID0gcG9pc29uX3JlZ2lzdGVycyhCLCBw
b2lzb24sIHNlbWEpOworCWlmIChlcnIpIHsKKwkJV1JJVEVfT05DRSgqc2VtYSwgLTEpOworCQlp
OTE1X3JlcXVlc3RfcHV0KHJxKTsKKwkJZ290byBlcnJfcmVzdWx0MTsKKwl9CisKKwlpZiAoaTkx
NV9yZXF1ZXN0X3dhaXQocnEsIDAsIEhaIC8gMikgPCAwKSB7CisJCWk5MTVfcmVxdWVzdF9wdXQo
cnEpOworCQllcnIgPSAtRVRJTUU7CisJCWdvdG8gZXJyX3Jlc3VsdDE7CisJfQorCWk5MTVfcmVx
dWVzdF9wdXQocnEpOworCisJZXJyID0gY29tcGFyZV9pc29sYXRpb24oZW5naW5lLCByZWYsIHJl
c3VsdCwgQSwgcG9pc29uKTsKKworZXJyX3Jlc3VsdDE6CisJaTkxNV92bWFfcHV0KHJlc3VsdFsx
XSk7CitlcnJfcmVzdWx0MDoKKwlpOTE1X3ZtYV9wdXQocmVzdWx0WzBdKTsKK2Vycl9yZWYxOgor
CWk5MTVfdm1hX3B1dChyZWZbMV0pOworZXJyX3JlZjA6CisJaTkxNV92bWFfcHV0KHJlZlswXSk7
CitlcnJfQjoKKwlpbnRlbF9jb250ZXh0X3B1dChCKTsKK2Vycl9BOgorCWludGVsX2NvbnRleHRf
cHV0KEEpOworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBib29sIHNraXBfaXNvbGF0aW9uKGNv
bnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlpZiAoZW5naW5lLT5jbGFz
cyA9PSBDT1BZX0VOR0lORV9DTEFTUyAmJiBJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA9PSA5KQor
CQlyZXR1cm4gdHJ1ZTsKKworCWlmIChlbmdpbmUtPmNsYXNzID09IFJFTkRFUl9DTEFTUyAmJiBJ
TlRFTF9HRU4oZW5naW5lLT5pOTE1KSA9PSAxMSkKKwkJcmV0dXJuIHRydWU7CisKKwlyZXR1cm4g
ZmFsc2U7Cit9CisKK3N0YXRpYyBpbnQgbGl2ZV9scmNfaXNvbGF0aW9uKHZvaWQgKmFyZykKK3sK
KwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOworCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZTsKKwllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKKwljb25zdCB1MzIgcG9pc29uW10gPSB7
CisJCVNUQUNLX01BR0lDLAorCQkweDNhM2EzYTNhLAorCQkweDVjNWM1YzVjLAorCQkweGZmZmZm
ZmZmLAorCQkweGZmZmYwMDAwLAorCX07CisJaW50IGVyciA9IDA7CisKKwkvKgorCSAqIE91ciBn
b2FsIGlzIHRyeSBhbmQgdmVyaWZ5IHRoYXQgcGVyLWNvbnRleHQgc3RhdGUgY2Fubm90IGJlCisJ
ICogdGFtcGVyZWQgd2l0aCBieSBhbm90aGVyIG5vbi1wcml2aWxlZ2VkIGNsaWVudC4KKwkgKgor
CSAqIFdlIHRha2UgdGhlIGxpc3Qgb2YgY29udGV4dCByZWdpc3RlcnMgZnJvbSB0aGUgTFJJIGlu
IHRoZSBkZWZhdWx0CisJICogY29udGV4dCBpbWFnZSBhbmQgYXR0ZW1wdCB0byBtb2RpZnkgdGhh
dCBsaXN0IGZyb20gYSByZW1vdGUgY29udGV4dC4KKwkgKi8KKworCWZvcl9lYWNoX2VuZ2luZShl
bmdpbmUsIGd0LCBpZCkgeworCQlpbnQgaTsKKworCQkvKiBKdXN0IGRvbid0IGV2ZW4gYXNrICov
CisJCWlmICghSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfU0VMRlRFU1RfQlJPS0VOKSAmJgor
CQkgICAgc2tpcF9pc29sYXRpb24oZW5naW5lKSkKKwkJCWNvbnRpbnVlOworCisJCWludGVsX2Vu
Z2luZV9wbV9nZXQoZW5naW5lKTsKKwkJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUocG9pc29u
KTsgaSsrKSB7CisJCQlpbnQgcmVzdWx0OworCisJCQlyZXN1bHQgPSBfX2xyY19pc29sYXRpb24o
ZW5naW5lLCBwb2lzb25baV0pOworCQkJaWYgKHJlc3VsdCAmJiAhZXJyKQorCQkJCWVyciA9IHJl
c3VsdDsKKworCQkJcmVzdWx0ID0gX19scmNfaXNvbGF0aW9uKGVuZ2luZSwgfnBvaXNvbltpXSk7
CisJCQlpZiAocmVzdWx0ICYmICFlcnIpCisJCQkJZXJyID0gcmVzdWx0OworCQl9CisJCWludGVs
X2VuZ2luZV9wbV9wdXQoZW5naW5lKTsKKwkJaWYgKGlndF9mbHVzaF90ZXN0KGd0LT5pOTE1KSkg
eworCQkJZXJyID0gLUVJTzsKKwkJCWJyZWFrOworCQl9CisJfQorCisJcmV0dXJuIGVycjsKK30K
Kworc3RhdGljIGludCBpbmRpcmVjdF9jdHhfc3VibWl0X3JlcShzdHJ1Y3QgaW50ZWxfY29udGV4
dCAqY2UpCit7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7CisJaW50IGVyciA9IDA7CisKKwly
cSA9IGludGVsX2NvbnRleHRfY3JlYXRlX3JlcXVlc3QoY2UpOworCWlmIChJU19FUlIocnEpKQor
CQlyZXR1cm4gUFRSX0VSUihycSk7CisKKwlpOTE1X3JlcXVlc3RfZ2V0KHJxKTsKKwlpOTE1X3Jl
cXVlc3RfYWRkKHJxKTsKKworCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgSFogLyA1KSA8
IDApCisJCWVyciA9IC1FVElNRTsKKworCWk5MTVfcmVxdWVzdF9wdXQocnEpOworCisJcmV0dXJu
IGVycjsKK30KKworI2RlZmluZSBDVFhfQkJfQ0FOQVJZX09GRlNFVCAoMyAqIDEwMjQpCisjZGVm
aW5lIENUWF9CQl9DQU5BUllfSU5ERVggIChDVFhfQkJfQ0FOQVJZX09GRlNFVCAvIHNpemVvZih1
MzIpKQorCitzdGF0aWMgdTMyICoKK2VtaXRfaW5kaXJlY3RfY3R4X2JiX2NhbmFyeShjb25zdCBz
dHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHUzMiAqY3MpCit7CisJKmNzKysgPSBNSV9TVE9SRV9S
RUdJU1RFUl9NRU1fR0VOOCB8CisJCU1JX1NSTV9MUk1fR0xPQkFMX0dUVCB8CisJCU1JX0xSSV9M
Uk1fQ1NfTU1JTzsKKwkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfU1RBUlQoMCkp
OworCSpjcysrID0gaTkxNV9nZ3R0X29mZnNldChjZS0+c3RhdGUpICsKKwkJY29udGV4dF93YV9i
Yl9vZmZzZXQoY2UpICsKKwkJQ1RYX0JCX0NBTkFSWV9PRkZTRVQ7CisJKmNzKysgPSAwOworCisJ
cmV0dXJuIGNzOworfQorCitzdGF0aWMgdm9pZAoraW5kaXJlY3RfY3R4X2JiX3NldHVwKHN0cnVj
dCBpbnRlbF9jb250ZXh0ICpjZSkKK3sKKwl1MzIgKmNzID0gY29udGV4dF9pbmRpcmVjdF9iYihj
ZSk7CisKKwljc1tDVFhfQkJfQ0FOQVJZX0lOREVYXSA9IDB4ZGVhZGYwMGQ7CisKKwlzZXR1cF9p
bmRpcmVjdF9jdHhfYmIoY2UsIGNlLT5lbmdpbmUsIGVtaXRfaW5kaXJlY3RfY3R4X2JiX2NhbmFy
eSk7Cit9CisKK3N0YXRpYyBib29sIGNoZWNrX3Jpbmdfc3RhcnQoc3RydWN0IGludGVsX2NvbnRl
eHQgKmNlKQoreworCWNvbnN0IHUzMiAqIGNvbnN0IGN0eF9iYiA9ICh2b2lkICopKGNlLT5scmNf
cmVnX3N0YXRlKSAtCisJCUxSQ19TVEFURV9PRkZTRVQgKyBjb250ZXh0X3dhX2JiX29mZnNldChj
ZSk7CisKKwlpZiAoY3R4X2JiW0NUWF9CQl9DQU5BUllfSU5ERVhdID09IGNlLT5scmNfcmVnX3N0
YXRlW0NUWF9SSU5HX1NUQVJUXSkKKwkJcmV0dXJuIHRydWU7CisKKwlwcl9lcnIoInJpbmcgc3Rh
cnQgbWlzbWF0Y2g6IGNhbmFyeSAweCUwOHggdnMgc3RhdGUgMHglMDh4XG4iLAorCSAgICAgICBj
dHhfYmJbQ1RYX0JCX0NBTkFSWV9JTkRFWF0sCisJICAgICAgIGNlLT5scmNfcmVnX3N0YXRlW0NU
WF9SSU5HX1NUQVJUXSk7CisKKwlyZXR1cm4gZmFsc2U7Cit9CisKK3N0YXRpYyBpbnQgaW5kaXJl
Y3RfY3R4X2JiX2NoZWNrKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKK3sKKwlpbnQgZXJyOwor
CisJZXJyID0gaW5kaXJlY3RfY3R4X3N1Ym1pdF9yZXEoY2UpOworCWlmIChlcnIpCisJCXJldHVy
biBlcnI7CisKKwlpZiAoIWNoZWNrX3Jpbmdfc3RhcnQoY2UpKQorCQlyZXR1cm4gLUVJTlZBTDsK
KworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IF9fbGl2ZV9scmNfaW5kaXJlY3RfY3R4X2Ji
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlzdHJ1Y3QgaW50ZWxfY29udGV4
dCAqYSwgKmI7CisJaW50IGVycjsKKworCWEgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZShlbmdpbmUp
OworCWlmIChJU19FUlIoYSkpCisJCXJldHVybiBQVFJfRVJSKGEpOworCWVyciA9IGludGVsX2Nv
bnRleHRfcGluKGEpOworCWlmIChlcnIpCisJCWdvdG8gcHV0X2E7CisKKwliID0gaW50ZWxfY29u
dGV4dF9jcmVhdGUoZW5naW5lKTsKKwlpZiAoSVNfRVJSKGIpKSB7CisJCWVyciA9IFBUUl9FUlIo
Yik7CisJCWdvdG8gdW5waW5fYTsKKwl9CisJZXJyID0gaW50ZWxfY29udGV4dF9waW4oYik7CisJ
aWYgKGVycikKKwkJZ290byBwdXRfYjsKKworCS8qIFdlIHVzZSB0aGUgYWxyZWFkeSByZXNlcnZl
ZCBleHRyYSBwYWdlIGluIGNvbnRleHQgc3RhdGUgKi8KKwlpZiAoIWEtPndhX2JiX3BhZ2UpIHsK
KwkJR0VNX0JVR19PTihiLT53YV9iYl9wYWdlKTsKKwkJR0VNX0JVR19PTihJTlRFTF9HRU4oZW5n
aW5lLT5pOTE1KSA9PSAxMik7CisJCWdvdG8gdW5waW5fYjsKKwl9CisKKwkvKgorCSAqIEluIG9y
ZGVyIHRvIHRlc3QgdGhhdCBvdXIgcGVyIGNvbnRleHQgYmIgaXMgdHJ1bHkgcGVyIGNvbnRleHQs
CisJICogYW5kIGV4ZWN1dGVzIGF0IHRoZSBpbnRlbmRlZCBzcG90IG9uIGNvbnRleHQgcmVzdG9y
aW5nIHByb2Nlc3MsCisJICogbWFrZSB0aGUgYmF0Y2ggc3RvcmUgdGhlIHJpbmcgc3RhcnQgdmFs
dWUgdG8gbWVtb3J5LgorCSAqIEFzIHJpbmcgc3RhcnQgaXMgcmVzdG9yZWQgYXByaW9yaSBvZiBz
dGFydGluZyB0aGUgaW5kaXJlY3QgY3R4IGJiIGFuZAorCSAqIGFzIGl0IHdpbGwgYmUgZGlmZmVy
ZW50IGZvciBlYWNoIGNvbnRleHQsIGl0IGZpdHMgdG8gdGhpcyBwdXJwb3NlLgorCSAqLworCWlu
ZGlyZWN0X2N0eF9iYl9zZXR1cChhKTsKKwlpbmRpcmVjdF9jdHhfYmJfc2V0dXAoYik7CisKKwll
cnIgPSBpbmRpcmVjdF9jdHhfYmJfY2hlY2soYSk7CisJaWYgKGVycikKKwkJZ290byB1bnBpbl9i
OworCisJZXJyID0gaW5kaXJlY3RfY3R4X2JiX2NoZWNrKGIpOworCit1bnBpbl9iOgorCWludGVs
X2NvbnRleHRfdW5waW4oYik7CitwdXRfYjoKKwlpbnRlbF9jb250ZXh0X3B1dChiKTsKK3VucGlu
X2E6CisJaW50ZWxfY29udGV4dF91bnBpbihhKTsKK3B1dF9hOgorCWludGVsX2NvbnRleHRfcHV0
KGEpOworCisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIGludCBsaXZlX2xyY19pbmRpcmVjdF9j
dHhfYmIodm9pZCAqYXJnKQoreworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7CisJc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOworCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOworCWlu
dCBlcnIgPSAwOworCisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7CisJCWludGVs
X2VuZ2luZV9wbV9nZXQoZW5naW5lKTsKKwkJZXJyID0gX19saXZlX2xyY19pbmRpcmVjdF9jdHhf
YmIoZW5naW5lKTsKKwkJaW50ZWxfZW5naW5lX3BtX3B1dChlbmdpbmUpOworCisJCWlmIChpZ3Rf
Zmx1c2hfdGVzdChndC0+aTkxNSkpCisJCQllcnIgPSAtRUlPOworCisJCWlmIChlcnIpCisJCQli
cmVhazsKKwl9CisKKwlyZXR1cm4gZXJyOworfQorCitzdGF0aWMgdm9pZCBnYXJiYWdlX3Jlc2V0
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKKwkJCSAgc3RydWN0IGk5MTVfcmVxdWVz
dCAqcnEpCit7CisJY29uc3QgdW5zaWduZWQgaW50IGJpdCA9IEk5MTVfUkVTRVRfRU5HSU5FICsg
ZW5naW5lLT5pZDsKKwl1bnNpZ25lZCBsb25nICpsb2NrID0gJmVuZ2luZS0+Z3QtPnJlc2V0LmZs
YWdzOworCisJaWYgKHRlc3RfYW5kX3NldF9iaXQoYml0LCBsb2NrKSkKKwkJcmV0dXJuOworCisJ
dGFza2xldF9kaXNhYmxlKCZlbmdpbmUtPmV4ZWNsaXN0cy50YXNrbGV0KTsKKworCWlmICghcnEt
PmZlbmNlLmVycm9yKQorCQlpbnRlbF9lbmdpbmVfcmVzZXQoZW5naW5lLCBOVUxMKTsKKworCXRh
c2tsZXRfZW5hYmxlKCZlbmdpbmUtPmV4ZWNsaXN0cy50YXNrbGV0KTsKKwljbGVhcl9hbmRfd2Fr
ZV91cF9iaXQoYml0LCBsb2NrKTsKK30KKworc3RhdGljIHN0cnVjdCBpOTE1X3JlcXVlc3QgKmdh
cmJhZ2Uoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAorCQkJCSAgICBzdHJ1Y3Qgcm5kX3N0YXRl
ICpwcm5nKQoreworCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOworCWludCBlcnI7CisKKwllcnIg
PSBpbnRlbF9jb250ZXh0X3BpbihjZSk7CisJaWYgKGVycikKKwkJcmV0dXJuIEVSUl9QVFIoZXJy
KTsKKworCXByYW5kb21fYnl0ZXNfc3RhdGUocHJuZywKKwkJCSAgICBjZS0+bHJjX3JlZ19zdGF0
ZSwKKwkJCSAgICBjZS0+ZW5naW5lLT5jb250ZXh0X3NpemUgLQorCQkJICAgIExSQ19TVEFURV9P
RkZTRVQpOworCisJcnEgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZV9yZXF1ZXN0KGNlKTsKKwlpZiAo
SVNfRVJSKHJxKSkgeworCQllcnIgPSBQVFJfRVJSKHJxKTsKKwkJZ290byBlcnJfdW5waW47CisJ
fQorCisJaTkxNV9yZXF1ZXN0X2dldChycSk7CisJaTkxNV9yZXF1ZXN0X2FkZChycSk7CisJcmV0
dXJuIHJxOworCitlcnJfdW5waW46CisJaW50ZWxfY29udGV4dF91bnBpbihjZSk7CisJcmV0dXJu
IEVSUl9QVFIoZXJyKTsKK30KKworc3RhdGljIGludCBfX2xyY19nYXJiYWdlKHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSwgc3RydWN0IHJuZF9zdGF0ZSAqcHJuZykKK3sKKwlzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqY2U7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqaGFuZzsKKwlpbnQgZXJy
ID0gMDsKKworCWNlID0gaW50ZWxfY29udGV4dF9jcmVhdGUoZW5naW5lKTsKKwlpZiAoSVNfRVJS
KGNlKSkKKwkJcmV0dXJuIFBUUl9FUlIoY2UpOworCisJaGFuZyA9IGdhcmJhZ2UoY2UsIHBybmcp
OworCWlmIChJU19FUlIoaGFuZykpIHsKKwkJZXJyID0gUFRSX0VSUihoYW5nKTsKKwkJZ290byBl
cnJfY2U7CisJfQorCisJaWYgKHdhaXRfZm9yX3N1Ym1pdChlbmdpbmUsIGhhbmcsIEhaIC8gMikp
IHsKKwkJaTkxNV9yZXF1ZXN0X3B1dChoYW5nKTsKKwkJZXJyID0gLUVUSU1FOworCQlnb3RvIGVy
cl9jZTsKKwl9CisKKwlpbnRlbF9jb250ZXh0X3NldF9iYW5uZWQoY2UpOworCWdhcmJhZ2VfcmVz
ZXQoZW5naW5lLCBoYW5nKTsKKworCWludGVsX2VuZ2luZV9mbHVzaF9zdWJtaXNzaW9uKGVuZ2lu
ZSk7CisJaWYgKCFoYW5nLT5mZW5jZS5lcnJvcikgeworCQlpOTE1X3JlcXVlc3RfcHV0KGhhbmcp
OworCQlwcl9lcnIoIiVzOiBjb3JydXB0ZWQgY29udGV4dCB3YXMgbm90IHJlc2V0XG4iLAorCQkg
ICAgICAgZW5naW5lLT5uYW1lKTsKKwkJZXJyID0gLUVJTlZBTDsKKwkJZ290byBlcnJfY2U7CisJ
fQorCisJaWYgKGk5MTVfcmVxdWVzdF93YWl0KGhhbmcsIDAsIEhaIC8gMikgPCAwKSB7CisJCXBy
X2VycigiJXM6IGNvcnJ1cHRlZCBjb250ZXh0IGRpZCBub3QgcmVjb3ZlclxuIiwKKwkJICAgICAg
IGVuZ2luZS0+bmFtZSk7CisJCWk5MTVfcmVxdWVzdF9wdXQoaGFuZyk7CisJCWVyciA9IC1FSU87
CisJCWdvdG8gZXJyX2NlOworCX0KKwlpOTE1X3JlcXVlc3RfcHV0KGhhbmcpOworCitlcnJfY2U6
CisJaW50ZWxfY29udGV4dF9wdXQoY2UpOworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBpbnQg
bGl2ZV9scmNfZ2FyYmFnZSh2b2lkICphcmcpCit7CisJc3RydWN0IGludGVsX2d0ICpndCA9IGFy
ZzsKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CisJZW51bSBpbnRlbF9lbmdpbmVf
aWQgaWQ7CisKKwkvKgorCSAqIFZlcmlmeSB0aGF0IHdlIGNhbiByZWNvdmVyIGlmIG9uZSBjb250
ZXh0IHN0YXRlIGlzIGNvbXBsZXRlbHkKKwkgKiBjb3JydXB0ZWQuCisJICovCisKKwlpZiAoIUlT
X0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X1NFTEZURVNUX0JST0tFTikpCisJCXJldHVybiAwOwor
CisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7CisJCUk5MTVfUk5EX1NUQVRFKHBy
bmcpOworCQlpbnQgZXJyID0gMCwgaTsKKworCQlpZiAoIWludGVsX2hhc19yZXNldF9lbmdpbmUo
ZW5naW5lLT5ndCkpCisJCQljb250aW51ZTsKKworCQlpbnRlbF9lbmdpbmVfcG1fZ2V0KGVuZ2lu
ZSk7CisJCWZvciAoaSA9IDA7IGkgPCAzOyBpKyspIHsKKwkJCWVyciA9IF9fbHJjX2dhcmJhZ2Uo
ZW5naW5lLCAmcHJuZyk7CisJCQlpZiAoZXJyKQorCQkJCWJyZWFrOworCQl9CisJCWludGVsX2Vu
Z2luZV9wbV9wdXQoZW5naW5lKTsKKworCQlpZiAoaWd0X2ZsdXNoX3Rlc3QoZ3QtPmk5MTUpKQor
CQkJZXJyID0gLUVJTzsKKwkJaWYgKGVycikKKwkJCXJldHVybiBlcnI7CisJfQorCisJcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyBpbnQgX19saXZlX3BwaHdzcF9ydW50aW1lKHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7CisJc3RydWN0
IGk5MTVfcmVxdWVzdCAqcnE7CisJSUdUX1RJTUVPVVQoZW5kX3RpbWUpOworCWludCBlcnI7CisK
KwljZSA9IGludGVsX2NvbnRleHRfY3JlYXRlKGVuZ2luZSk7CisJaWYgKElTX0VSUihjZSkpCisJ
CXJldHVybiBQVFJfRVJSKGNlKTsKKworCWNlLT5ydW50aW1lLm51bV91bmRlcmZsb3cgPSAwOwor
CWNlLT5ydW50aW1lLm1heF91bmRlcmZsb3cgPSAwOworCisJZG8geworCQl1bnNpZ25lZCBpbnQg
bG9vcCA9IDEwMjQ7CisKKwkJd2hpbGUgKGxvb3ApIHsKKwkJCXJxID0gaW50ZWxfY29udGV4dF9j
cmVhdGVfcmVxdWVzdChjZSk7CisJCQlpZiAoSVNfRVJSKHJxKSkgeworCQkJCWVyciA9IFBUUl9F
UlIocnEpOworCQkJCWdvdG8gZXJyX3JxOworCQkJfQorCisJCQlpZiAoLS1sb29wID09IDApCisJ
CQkJaTkxNV9yZXF1ZXN0X2dldChycSk7CisKKwkJCWk5MTVfcmVxdWVzdF9hZGQocnEpOworCQl9
CisKKwkJaWYgKF9faWd0X3RpbWVvdXQoZW5kX3RpbWUsIE5VTEwpKQorCQkJYnJlYWs7CisKKwkJ
aTkxNV9yZXF1ZXN0X3B1dChycSk7CisJfSB3aGlsZSAoMSk7CisKKwllcnIgPSBpOTE1X3JlcXVl
c3Rfd2FpdChycSwgMCwgSFogLyA1KTsKKwlpZiAoZXJyIDwgMCkgeworCQlwcl9lcnIoIiVzOiBy
ZXF1ZXN0IG5vdCBjb21wbGV0ZWQhXG4iLCBlbmdpbmUtPm5hbWUpOworCQlnb3RvIGVycl93YWl0
OworCX0KKworCWlndF9mbHVzaF90ZXN0KGVuZ2luZS0+aTkxNSk7CisKKwlwcl9pbmZvKCIlczog
cHBod3NwIHJ1bnRpbWUgJWxsdW5zLCBhdmVyYWdlICVsbHVuc1xuIiwKKwkJZW5naW5lLT5uYW1l
LAorCQlpbnRlbF9jb250ZXh0X2dldF90b3RhbF9ydW50aW1lX25zKGNlKSwKKwkJaW50ZWxfY29u
dGV4dF9nZXRfYXZnX3J1bnRpbWVfbnMoY2UpKTsKKworCWVyciA9IDA7CisJaWYgKGNlLT5ydW50
aW1lLm51bV91bmRlcmZsb3cpIHsKKwkJcHJfZXJyKCIlczogcHBod3NwIHVuZGVyZmxvdyAldSB0
aW1lKHMpLCBtYXggJXUgY3ljbGVzIVxuIiwKKwkJICAgICAgIGVuZ2luZS0+bmFtZSwKKwkJICAg
ICAgIGNlLT5ydW50aW1lLm51bV91bmRlcmZsb3csCisJCSAgICAgICBjZS0+cnVudGltZS5tYXhf
dW5kZXJmbG93KTsKKwkJR0VNX1RSQUNFX0RVTVAoKTsKKwkJZXJyID0gLUVPVkVSRkxPVzsKKwl9
CisKK2Vycl93YWl0OgorCWk5MTVfcmVxdWVzdF9wdXQocnEpOworZXJyX3JxOgorCWludGVsX2Nv
bnRleHRfcHV0KGNlKTsKKwlyZXR1cm4gZXJyOworfQorCitzdGF0aWMgaW50IGxpdmVfcHBod3Nw
X3J1bnRpbWUodm9pZCAqYXJnKQoreworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7CisJc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOworCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwor
CWludCBlcnIgPSAwOworCisJLyoKKwkgKiBDaGVjayB0aGF0IGN1bXVsYXRpdmUgY29udGV4dCBy
dW50aW1lIGFzIHN0b3JlZCBpbiB0aGUgcHBod3NwWzE2XQorCSAqIGlzIG1vbm90b25pYy4KKwkg
Ki8KKworCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LCBpZCkgeworCQllcnIgPSBfX2xpdmVf
cHBod3NwX3J1bnRpbWUoZW5naW5lKTsKKwkJaWYgKGVycikKKwkJCWJyZWFrOworCX0KKworCWlm
IChpZ3RfZmx1c2hfdGVzdChndC0+aTkxNSkpCisJCWVyciA9IC1FSU87CisKKwlyZXR1cm4gZXJy
OworfQorCitpbnQgaW50ZWxfbHJjX2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQoreworCXN0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9zdWJ0ZXN0IHRlc3RzW10g
PSB7CisJCVNVQlRFU1QobGl2ZV9scmNfbGF5b3V0KSwKKwkJU1VCVEVTVChsaXZlX2xyY19maXhl
ZCksCisJCVNVQlRFU1QobGl2ZV9scmNfc3RhdGUpLAorCQlTVUJURVNUKGxpdmVfbHJjX2dwciks
CisJCVNVQlRFU1QobGl2ZV9scmNfaXNvbGF0aW9uKSwKKwkJU1VCVEVTVChsaXZlX2xyY190aW1l
c3RhbXApLAorCQlTVUJURVNUKGxpdmVfbHJjX2dhcmJhZ2UpLAorCQlTVUJURVNUKGxpdmVfcHBo
d3NwX3J1bnRpbWUpLAorCQlTVUJURVNUKGxpdmVfbHJjX2luZGlyZWN0X2N0eF9iYiksCisJfTsK
KworCWlmICghSEFTX0xPR0lDQUxfUklOR19DT05URVhUUyhpOTE1KSkKKwkJcmV0dXJuIDA7CisK
KwlyZXR1cm4gaW50ZWxfZ3RfbGl2ZV9zdWJ0ZXN0cyh0ZXN0cywgJmk5MTUtPmd0KTsKK30KZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19hZHMuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19hZHMuYwppbmRleCAxYTJlNGY2MzE3
NjMuLjE3NTI2NzE3MzY4YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMv
aW50ZWxfZ3VjX2Fkcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1
Y19hZHMuYwpAQCAtMyw4ICszLDggQEAKICAqIENvcHlyaWdodCDCqSAyMDE0LTIwMTkgSW50ZWwg
Q29ycG9yYXRpb24KICAqLwogCi0jaW5jbHVkZSAiZ3QvaW50ZWxfZXhlY2xpc3RzX3N1Ym1pc3Np
b24uaCIgLyogbHJjIGxheW91dCAqLwogI2luY2x1ZGUgImd0L2ludGVsX2d0LmgiCisjaW5jbHVk
ZSAiZ3QvaW50ZWxfbHJjLmgiCiAjaW5jbHVkZSAiaW50ZWxfZ3VjX2Fkcy5oIgogI2luY2x1ZGUg
ImludGVsX3VjLmgiCiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9uLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfc3VibWlzc2lvbi5jCmluZGV4IDg1MjhhYjU3NGRiZS4u
MTc5MjI3OThkNDBjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRl
bF9ndWNfc3VibWlzc2lvbi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVs
X2d1Y19zdWJtaXNzaW9uLmMKQEAgLTExLDcgKzExLDcgQEAKICNpbmNsdWRlICJndC9pbnRlbF9l
eGVjbGlzdHNfc3VibWlzc2lvbi5oIiAvKiBYWFggKi8KICNpbmNsdWRlICJndC9pbnRlbF9ndC5o
IgogI2luY2x1ZGUgImd0L2ludGVsX2d0X3BtLmgiCi0jaW5jbHVkZSAiZ3QvaW50ZWxfbHJjX3Jl
Zy5oIgorI2luY2x1ZGUgImd0L2ludGVsX2xyYy5oIgogI2luY2x1ZGUgImd0L2ludGVsX3Jpbmcu
aCIKIAogI2luY2x1ZGUgImludGVsX2d1Y19zdWJtaXNzaW9uLmgiCkBAIC00MDIsNiArNDAyLDI4
IEBAIGNhbmNlbF9wb3J0X3JlcXVlc3RzKHN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3RzICog
Y29uc3QgZXhlY2xpc3RzKQogCQltZW1zZXQoZXhlY2xpc3RzLT5pbmZsaWdodCwgMCwgc2l6ZW9m
KGV4ZWNsaXN0cy0+aW5mbGlnaHQpKTsKIH0KIAorc3RhdGljIHZvaWQgbHJjX3Jlc2V0KHN0cnVj
dCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJICAgICAgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lLAorCQkgICAgICB1MzIgaGVhZCwKKwkJICAgICAgYm9vbCBzY3J1YikKK3sKKwlHRU1fQlVH
X09OKCFpbnRlbF9jb250ZXh0X2lzX3Bpbm5lZChjZSkpOworCisJLyoKKwkgKiBXZSB3YW50IGEg
c2ltcGxlIGNvbnRleHQgKyByaW5nIHRvIGV4ZWN1dGUgdGhlIGJyZWFkY3J1bWIgdXBkYXRlLgor
CSAqIFdlIGNhbm5vdCByZWx5IG9uIHRoZSBjb250ZXh0IGJlaW5nIGludGFjdCBhY3Jvc3MgdGhl
IEdQVSBoYW5nLAorCSAqIHNvIGNsZWFyIGl0IGFuZCByZWJ1aWxkIGp1c3Qgd2hhdCB3ZSBuZWVk
IGZvciB0aGUgYnJlYWRjcnVtYi4KKwkgKiBBbGwgcGVuZGluZyByZXF1ZXN0cyBmb3IgdGhpcyBj
b250ZXh0IHdpbGwgYmUgemFwcGVkLCBhbmQgYW55CisJICogZnV0dXJlIHJlcXVlc3Qgd2lsbCBi
ZSBhZnRlciB1c2Vyc3BhY2UgaGFzIGhhZCB0aGUgb3Bwb3J0dW5pdHkKKwkgKiB0byByZWNyZWF0
ZSBpdHMgb3duIHN0YXRlLgorCSAqLworCWlmIChzY3J1YikKKwkJbHJjX3Jlc3RvcmVfZGVmYXVs
dHMoY2UsIGVuZ2luZSk7CisKKwkvKiBSZXJ1biB0aGUgcmVxdWVzdDsgaXRzIHBheWxvYWQgaGFz
IGJlZW4gbmV1dGVyZWQgKGlmIGd1aWx0eSkuICovCisJbHJjX3VwZGF0ZV9yZWdzKGNlLCBlbmdp
bmUsIGhlYWQpOworfQorCiBzdGF0aWMgdm9pZCBndWNfcmVzZXRfcmV3aW5kKHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSwgYm9vbCBzdGFsbGVkKQogewogCXN0cnVjdCBpbnRlbF9lbmdp
bmVfZXhlY2xpc3RzICogY29uc3QgZXhlY2xpc3RzID0gJmVuZ2luZS0+ZXhlY2xpc3RzOwpAQCAt
NDIxLDcgKzQ0Myw3IEBAIHN0YXRpYyB2b2lkIGd1Y19yZXNldF9yZXdpbmQoc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lLCBib29sIHN0YWxsZWQpCiAJCXN0YWxsZWQgPSBmYWxzZTsKIAog
CV9faTkxNV9yZXF1ZXN0X3Jlc2V0KHJxLCBzdGFsbGVkKTsKLQlpbnRlbF9scl9jb250ZXh0X3Jl
c2V0KGVuZ2luZSwgcnEtPmNvbnRleHQsIHJxLT5oZWFkLCBzdGFsbGVkKTsKKwlscmNfcmVzZXQo
cnEtPmNvbnRleHQsIGVuZ2luZSwgcnEtPmhlYWQsIHN0YWxsZWQpOwogCiBvdXRfdW5sb2NrOgog
CXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmVuZ2luZS0+YWN0aXZlLmxvY2ssIGZsYWdzKTsKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIuYwppbmRleCBlZDMwZmRkZTQxMTQuLjZhZjVjMDZj
YWVlMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIuYwpAQCAtMzgsNiArMzgsNyBA
QAogI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9wbS5oIgogI2luY2x1ZGUgImd0L2ludGVsX2NvbnRl
eHQuaCIKICNpbmNsdWRlICJndC9pbnRlbF9leGVjbGlzdHNfc3VibWlzc2lvbi5oIgorI2luY2x1
ZGUgImd0L2ludGVsX2xyYy5oIgogI2luY2x1ZGUgImd0L2ludGVsX3JpbmcuaCIKIAogI2luY2x1
ZGUgImk5MTVfZHJ2LmgiCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3Bl
cmYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5jCmluZGV4IGY1NTNjYWY0YjA2
ZC4uM2YwYTQ1MTFhY2VkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3Bl
cmYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYwpAQCAtMjAwLDcgKzIw
MCw3IEBACiAjaW5jbHVkZSAiZ3QvaW50ZWxfZW5naW5lX3VzZXIuaCIKICNpbmNsdWRlICJndC9p
bnRlbF9leGVjbGlzdHNfc3VibWlzc2lvbi5oIgogI2luY2x1ZGUgImd0L2ludGVsX2d0LmgiCi0j
aW5jbHVkZSAiZ3QvaW50ZWxfbHJjX3JlZy5oIgorI2luY2x1ZGUgImd0L2ludGVsX2xyYy5oIgog
I2luY2x1ZGUgImd0L2ludGVsX3JpbmcuaCIKIAogI2luY2x1ZGUgImk5MTVfZHJ2LmgiCi0tIAoy
LjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCklu
dGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRw
czovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeAo=

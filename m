Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 84994E1C38
	for <lists+intel-gfx@lfdr.de>; Wed, 23 Oct 2019 15:21:10 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id BE21B6EAA4;
	Wed, 23 Oct 2019 13:21:08 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga17.intel.com (mga17.intel.com [192.55.52.151])
 by gabe.freedesktop.org (Postfix) with ESMTPS id EA86C6EAA6
 for <intel-gfx@lists.freedesktop.org>; Wed, 23 Oct 2019 13:21:07 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga007.jf.intel.com ([10.7.209.58])
 by fmsmga107.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 23 Oct 2019 06:21:07 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.68,221,1569308400"; d="scan'208";a="188250454"
Received: from cmclare-mobl.ger.corp.intel.com (HELO
 mwahaha-bdw.ger.corp.intel.com) ([10.252.7.98])
 by orsmga007.jf.intel.com with ESMTP; 23 Oct 2019 06:21:06 -0700
From: Matthew Auld <matthew.auld@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 23 Oct 2019 14:20:57 +0100
Message-Id: <20191023132100.9578-4-matthew.auld@intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20191023132100.9578-1-matthew.auld@intel.com>
References: <20191023132100.9578-1-matthew.auld@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v3 4/7] drm/i915/selftests: add write-dword test
 for LMEM
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

U2ltcGxlIHRlc3Qgd3JpdGluZyB0byBkd29yZHMgYWNyb3NzIGFuIG9iamVjdCwgdXNpbmcgdmFy
aW91cyBlbmdpbmVzIGluCmEgcmFuZG9taXplZCBvcmRlciwgY2hlY2tpbmcgdGhhdCBvdXIgd3Jp
dGVzIGxhbmQgZnJvbSB0aGUgY3B1LgoKU2lnbmVkLW9mZi1ieTogTWF0dGhldyBBdWxkIDxtYXR0
aGV3LmF1bGRAaW50ZWwuY29tPgpSZXZpZXdlZC1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJp
cy13aWxzb24uY28udWs+Ci0tLQogLi4uL2RybS9pOTE1L3NlbGZ0ZXN0cy9pbnRlbF9tZW1vcnlf
cmVnaW9uLmMgIHwgMTY2ICsrKysrKysrKysrKysrKysrKwogMSBmaWxlIGNoYW5nZWQsIDE2NiBp
bnNlcnRpb25zKCspCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3Rz
L2ludGVsX21lbW9yeV9yZWdpb24uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9p
bnRlbF9tZW1vcnlfcmVnaW9uLmMKaW5kZXggMjkyNDg5MzcxODQyLi44ZTE0ZWYzZTFlMzIgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pbnRlbF9tZW1vcnlfcmVn
aW9uLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2ludGVsX21lbW9yeV9y
ZWdpb24uYwpAQCAtMTEsOSArMTEsMTEgQEAKICNpbmNsdWRlICJtb2NrX2dlbV9kZXZpY2UuaCIK
ICNpbmNsdWRlICJtb2NrX3JlZ2lvbi5oIgogCisjaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX2NvbnRl
eHQuaCIKICNpbmNsdWRlICJnZW0vaTkxNV9nZW1fbG1lbS5oIgogI2luY2x1ZGUgImdlbS9pOTE1
X2dlbV9yZWdpb24uaCIKICNpbmNsdWRlICJnZW0vaTkxNV9nZW1fb2JqZWN0X2JsdC5oIgorI2lu
Y2x1ZGUgImdlbS9zZWxmdGVzdHMvaWd0X2dlbV91dGlscy5oIgogI2luY2x1ZGUgImdlbS9zZWxm
dGVzdHMvbW9ja19jb250ZXh0LmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfZ3QuaCIKICNpbmNsdWRl
ICJzZWxmdGVzdHMvaWd0X2ZsdXNoX3Rlc3QuaCIKQEAgLTI1Niw2ICsyNTgsMTI1IEBAIHN0YXRp
YyBpbnQgaWd0X21vY2tfY29udGlndW91cyh2b2lkICphcmcpCiAJcmV0dXJuIGVycjsKIH0KIAor
c3RhdGljIGludCBpZ3RfZ3B1X3dyaXRlX2R3KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJ
CSAgICBzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKKwkJCSAgICB1MzIgZHdvcmQsCisJCQkgICAgdTMy
IHZhbHVlKQoreworCXJldHVybiBpZ3RfZ3B1X2ZpbGxfZHcoY2UsIHZtYSwgZHdvcmQgKiBzaXpl
b2YodTMyKSwKKwkJCSAgICAgICB2bWEtPnNpemUgPj4gUEFHRV9TSElGVCwgdmFsdWUpOworfQor
CitzdGF0aWMgaW50IGlndF9jcHVfY2hlY2soc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
aiwgdTMyIGR3b3JkLCB1MzIgdmFsKQoreworCXVuc2lnbmVkIGxvbmcgbjsKKwlpbnQgZXJyOwor
CisJaTkxNV9nZW1fb2JqZWN0X2xvY2sob2JqKTsKKwllcnIgPSBpOTE1X2dlbV9vYmplY3Rfc2V0
X3RvX3djX2RvbWFpbihvYmosIGZhbHNlKTsKKwlpOTE1X2dlbV9vYmplY3RfdW5sb2NrKG9iaik7
CisJaWYgKGVycikKKwkJcmV0dXJuIGVycjsKKworCWVyciA9IGk5MTVfZ2VtX29iamVjdF9waW5f
cGFnZXMob2JqKTsKKwlpZiAoZXJyKQorCQlyZXR1cm4gZXJyOworCisJZm9yIChuID0gMDsgbiA8
IG9iai0+YmFzZS5zaXplID4+IFBBR0VfU0hJRlQ7ICsrbikgeworCQl1MzIgX19pb21lbSAqYmFz
ZTsKKwkJdTMyIHJlYWRfdmFsOworCisJCWJhc2UgPSBpOTE1X2dlbV9vYmplY3RfbG1lbV9pb19t
YXBfcGFnZV9hdG9taWMob2JqLCBuKTsKKworCQlyZWFkX3ZhbCA9IGlvcmVhZDMyKGJhc2UgKyBk
d29yZCk7CisJCWlvX21hcHBpbmdfdW5tYXBfYXRvbWljKGJhc2UpOworCQlpZiAocmVhZF92YWwg
IT0gdmFsKSB7CisJCQlwcl9lcnIoIm49JWx1IGJhc2VbJXVdPSV1LCB2YWw9JXVcbiIsCisJCQkg
ICAgICAgbiwgZHdvcmQsIHJlYWRfdmFsLCB2YWwpOworCQkJZXJyID0gLUVJTlZBTDsKKwkJCWJy
ZWFrOworCQl9CisJfQorCisJaTkxNV9nZW1fb2JqZWN0X3VucGluX3BhZ2VzKG9iaik7CisJcmV0
dXJuIGVycjsKK30KKworc3RhdGljIGludCBpZ3RfZ3B1X3dyaXRlKHN0cnVjdCBpOTE1X2dlbV9j
b250ZXh0ICpjdHgsCisJCQkgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKK3sKKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGN0eC0+aTkxNTsKKwlzdHJ1Y3QgaTkxNV9h
ZGRyZXNzX3NwYWNlICp2bSA9IGN0eC0+dm0gPzogJmk5MTUtPmdndHQudm07CisJc3RydWN0IGk5
MTVfZ2VtX2VuZ2luZXMgKmVuZ2luZXM7CisJc3RydWN0IGk5MTVfZ2VtX2VuZ2luZXNfaXRlciBp
dDsKKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7CisJSTkxNV9STkRfU1RBVEUocHJuZyk7CisJ
SUdUX1RJTUVPVVQoZW5kX3RpbWUpOworCXVuc2lnbmVkIGludCBjb3VudDsKKwlzdHJ1Y3QgaTkx
NV92bWEgKnZtYTsKKwlpbnQgKm9yZGVyOworCWludCBpLCBuOworCWludCBlcnIgPSAwOworCisJ
R0VNX0JVR19PTighaTkxNV9nZW1fb2JqZWN0X2hhc19waW5uZWRfcGFnZXMob2JqKSk7CisKKwlu
ID0gMDsKKwljb3VudCA9IDA7CisJZm9yX2VhY2hfZ2VtX2VuZ2luZShjZSwgaTkxNV9nZW1fY29u
dGV4dF9sb2NrX2VuZ2luZXMoY3R4KSwgaXQpIHsKKwkJY291bnQrKzsKKwkJaWYgKCFpbnRlbF9l
bmdpbmVfY2FuX3N0b3JlX2R3b3JkKGNlLT5lbmdpbmUpKQorCQkJY29udGludWU7CisKKwkJbisr
OworCX0KKwlpOTE1X2dlbV9jb250ZXh0X3VubG9ja19lbmdpbmVzKGN0eCk7CisJaWYgKCFuKQor
CQlyZXR1cm4gMDsKKworCW9yZGVyID0gaTkxNV9yYW5kb21fb3JkZXIoY291bnQgKiBjb3VudCwg
JnBybmcpOworCWlmICghb3JkZXIpCisJCXJldHVybiAtRU5PTUVNOworCisJdm1hID0gaTkxNV92
bWFfaW5zdGFuY2Uob2JqLCB2bSwgTlVMTCk7CisJaWYgKElTX0VSUih2bWEpKSB7CisJCWVyciA9
IFBUUl9FUlIodm1hKTsKKwkJZ290byBvdXRfZnJlZTsKKwl9CisKKwllcnIgPSBpOTE1X3ZtYV9w
aW4odm1hLCAwLCAwLCBQSU5fVVNFUik7CisJaWYgKGVycikKKwkJZ290byBvdXRfZnJlZTsKKwor
CWkgPSAwOworCWVuZ2luZXMgPSBpOTE1X2dlbV9jb250ZXh0X2xvY2tfZW5naW5lcyhjdHgpOwor
CWRvIHsKKwkJdTMyIHJuZyA9IHByYW5kb21fdTMyX3N0YXRlKCZwcm5nKTsKKwkJdTMyIGR3b3Jk
ID0gb2Zmc2V0X2luX3BhZ2Uocm5nKSAvIDQ7CisKKwkJY2UgPSBlbmdpbmVzLT5lbmdpbmVzW29y
ZGVyW2ldICUgZW5naW5lcy0+bnVtX2VuZ2luZXNdOworCQlpID0gKGkgKyAxKSAlIChjb3VudCAq
IGNvdW50KTsKKwkJaWYgKCFjZSB8fCAhaW50ZWxfZW5naW5lX2Nhbl9zdG9yZV9kd29yZChjZS0+
ZW5naW5lKSkKKwkJCWNvbnRpbnVlOworCisJCWVyciA9IGlndF9ncHVfd3JpdGVfZHcoY2UsIHZt
YSwgZHdvcmQsIHJuZyk7CisJCWlmIChlcnIpCisJCQlicmVhazsKKworCQllcnIgPSBpZ3RfY3B1
X2NoZWNrKG9iaiwgZHdvcmQsIHJuZyk7CisJCWlmIChlcnIpCisJCQlicmVhazsKKwl9IHdoaWxl
ICghX19pZ3RfdGltZW91dChlbmRfdGltZSwgTlVMTCkpOworCWk5MTVfZ2VtX2NvbnRleHRfdW5s
b2NrX2VuZ2luZXMoY3R4KTsKKworb3V0X2ZyZWU6CisJa2ZyZWUob3JkZXIpOworCisJaWYgKGVy
ciA9PSAtRU5PTUVNKQorCQllcnIgPSAwOworCisJcmV0dXJuIGVycjsKK30KKwogc3RhdGljIGlu
dCBpZ3RfbG1lbV9jcmVhdGUodm9pZCAqYXJnKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gYXJnOwpAQCAtMjc3LDYgKzM5OCw1MCBAQCBzdGF0aWMgaW50IGlndF9sbWVtX2Ny
ZWF0ZSh2b2lkICphcmcpCiAJcmV0dXJuIGVycjsKIH0KIAorc3RhdGljIGludCBpZ3RfbG1lbV93
cml0ZV9ncHUodm9pZCAqYXJnKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
YXJnOworCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CisJc3RydWN0IGk5MTVfZ2Vt
X2NvbnRleHQgKmN0eDsKKwlzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGU7CisJSTkxNV9STkRfU1RBVEUo
cHJuZyk7CisJdTMyIHN6OworCWludCBlcnI7CisKKwlmaWxlID0gbW9ja19maWxlKGk5MTUpOwor
CWlmIChJU19FUlIoZmlsZSkpCisJCXJldHVybiBQVFJfRVJSKGZpbGUpOworCisJY3R4ID0gbGl2
ZV9jb250ZXh0KGk5MTUsIGZpbGUpOworCWlmIChJU19FUlIoY3R4KSkgeworCQllcnIgPSBQVFJf
RVJSKGN0eCk7CisJCWdvdG8gb3V0X2ZpbGU7CisJfQorCisJc3ogPSByb3VuZF91cChwcmFuZG9t
X3UzMl9zdGF0ZSgmcHJuZykgJSBTWl8zMk0sIFBBR0VfU0laRSk7CisKKwlvYmogPSBpOTE1X2dl
bV9vYmplY3RfY3JlYXRlX2xtZW0oaTkxNSwgc3osIDApOworCWlmIChJU19FUlIob2JqKSkgewor
CQllcnIgPSBQVFJfRVJSKG9iaik7CisJCWdvdG8gb3V0X2ZpbGU7CisJfQorCisJZXJyID0gaTkx
NV9nZW1fb2JqZWN0X3Bpbl9wYWdlcyhvYmopOworCWlmIChlcnIpCisJCWdvdG8gb3V0X3B1dDsK
KworCWVyciA9IGlndF9ncHVfd3JpdGUoY3R4LCBvYmopOworCWlmIChlcnIpCisJCXByX2Vycigi
aWd0X2dwdV93cml0ZSBmYWlsZWQoJWQpXG4iLCBlcnIpOworCisJaTkxNV9nZW1fb2JqZWN0X3Vu
cGluX3BhZ2VzKG9iaik7CitvdXRfcHV0OgorCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKK291
dF9maWxlOgorCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUpOworCXJldHVybiBlcnI7Cit9CisK
IHN0YXRpYyBpbnQgaWd0X2xtZW1fd3JpdGVfY3B1KHZvaWQgKmFyZykKIHsKIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGFyZzsKQEAgLTQyMSw2ICs1ODYsNyBAQCBpbnQgaW50ZWxf
bWVtb3J5X3JlZ2lvbl9saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKIAlzdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVfc3VidGVzdCB0ZXN0c1tdID0gewogCQlTVUJU
RVNUKGlndF9sbWVtX2NyZWF0ZSksCiAJCVNVQlRFU1QoaWd0X2xtZW1fd3JpdGVfY3B1KSwKKwkJ
U1VCVEVTVChpZ3RfbG1lbV93cml0ZV9ncHUpLAogCX07CiAKIAlpZiAoIUhBU19MTUVNKGk5MTUp
KSB7Ci0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9w
Lm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVs
LWdmeA==

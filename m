Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id B3F356BCC1
	for <lists+intel-gfx@lfdr.de>; Wed, 17 Jul 2019 15:08:48 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C7F196E14B;
	Wed, 17 Jul 2019 13:08:46 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id CE07A6E14B
 for <intel-gfx@lists.freedesktop.org>; Wed, 17 Jul 2019 13:08:44 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 17370945-1500050 for multiple; Wed, 17 Jul 2019 14:08:41 +0100
MIME-Version: 1.0
From: Chris Wilson <chris@chris-wilson.co.uk>
User-Agent: alot/0.6
To: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>,
 intel-gfx@lists.freedesktop.org
References: <20190716124931.5870-1-chris@chris-wilson.co.uk>
 <20190716124931.5870-2-chris@chris-wilson.co.uk>
 <dacd4362-4e76-5165-37e5-a9d4308835bb@linux.intel.com>
In-Reply-To: <dacd4362-4e76-5165-37e5-a9d4308835bb@linux.intel.com>
Message-ID: <156336891995.4375.4394847020984312949@skylake-alporthouse-com>
Date: Wed, 17 Jul 2019 14:08:39 +0100
Subject: Re: [Intel-gfx] [PATCH 2/5] drm/i915/gt: Push engine stopping into
 reset-prepare
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVvdGluZyBUdnJ0a28gVXJzdWxpbiAoMjAxOS0wNy0xNyAxNDowNDozNCkKPiAKPiBPbiAxNi8w
Ny8yMDE5IDEzOjQ5LCBDaHJpcyBXaWxzb24gd3JvdGU6Cj4gPiBQdXNoIHRoZSBlbmdpbmUgc3Rv
cCBpbnRvIHRoZSBiYWNrIHJlc2V0X3ByZXBhcmUgKHdoZXJlIGl0IGFscmVhZHkgd2FzISkKPiA+
IFRoaXMgYWxsb3dzIHVzIHRvIGF2b2lkIGRhbmdlcm91c2x5IHNldHRpbmcgdGhlIFJJTkcgcmVn
aXN0ZXJzIHRvIDAgZm9yCj4gPiBsb2dpY2FsIGNvbnRleHRzLiBJZiB3ZSBjbGVhciB0aGUgcmVn
aXN0ZXIgb24gYSBsaXZlIGNvbnRleHQsIHRob3NlCj4gPiBpbnZhbGlkIHJlZ2lzdGVyIHZhbHVl
cyBhcmUgcmVjb3JkZWQgaW4gdGhlIGxvZ2ljYWwgY29udGV4dCBzdGF0ZSBhbmQKPiA+IHJlcGxh
eWVkICh3aXRoIGhpbGFyaW91cyByZXN1bHRzKS4KPiAKPiBTbyBlc3NlbnRpYWxseSBzdGF0ZW1l
bnQgaXMgZ2VuM19zdG9wX2VuZ2luZSBpcyBub3QgbmVlZGVkIGFuZCBldmVuIAo+IGRhbmdlcm91
cyB3aXRoIGV4ZWNsaXN0cz8KClllcy4gSXQgaGFzIGJlZW4gYSBudWlzYW5jZSBpbiB0aGUgcGFz
dCwgd2hpY2ggaXMgd2h5IHdlIHRyeSB0byBhdm9pZAppdC4gSSBoYXZlIGNvbWUgdG8gY29uY2x1
c2lvbiB0aGF0IGl0IHNlcnZlcyBubyBwdXJwb3NlIGZvciBleGVjbGlzdHMKYW5kIG9ubHkgbWFr
ZXMgcmVjb3Zlcnkgd29yc2UuCgo+IAo+ID4gCj4gPiBTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxz
b24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KPiA+IC0tLQo+ID4gICBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9scmMuYyAgICAgICAgfCAxNiArKysrKy0KPiA+ICAgZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYyAgICAgIHwgNTggLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMgfCA0
MCArKysrKysrKysrKysrKy0KPiA+ICAgMyBmaWxlcyBjaGFuZ2VkLCA1MyBpbnNlcnRpb25zKCsp
LCA2MSBkZWxldGlvbnMoLSkKPiA+IAo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2xyYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMK
PiA+IGluZGV4IDllMDk5MjQ5ODA4Ny4uOWI4N2EyZmMxODZjIDEwMDY0NAo+ID4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2xyYy5jCj4gPiBAQCAtMjE3MywxMSArMjE3MywyMyBAQCBzdGF0aWMg
dm9pZCBleGVjbGlzdHNfcmVzZXRfcHJlcGFyZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpCj4gPiAgICAgICBfX3Rhc2tsZXRfZGlzYWJsZV9zeW5jX29uY2UoJmV4ZWNsaXN0cy0+dGFz
a2xldCk7Cj4gPiAgICAgICBHRU1fQlVHX09OKCFyZXNldF9pbl9wcm9ncmVzcyhleGVjbGlzdHMp
KTsKPiA+ICAgCj4gPiAtICAgICBpbnRlbF9lbmdpbmVfc3RvcF9jcyhlbmdpbmUpOwo+ID4gLQo+
ID4gICAgICAgLyogQW5kIGZsdXNoIGFueSBjdXJyZW50IGRpcmVjdCBzdWJtaXNzaW9uLiAqLwo+
ID4gICAgICAgc3Bpbl9sb2NrX2lycXNhdmUoJmVuZ2luZS0+YWN0aXZlLmxvY2ssIGZsYWdzKTsK
PiA+ICAgICAgIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmVuZ2luZS0+YWN0aXZlLmxvY2ssIGZs
YWdzKTsKPiA+ICsKPiA+ICsgICAgIC8qCj4gPiArICAgICAgKiBXZSBzdG9wIGVuZ2luZXMsIG90
aGVyd2lzZSB3ZSBtaWdodCBnZXQgZmFpbGVkIHJlc2V0IGFuZCBhCj4gPiArICAgICAgKiBkZWFk
IGdwdSAob24gZWxrKS4gQWxzbyBhcyBtb2Rlcm4gZ3B1IGFzIGtibCBjYW4gc3VmZmVyCj4gPiAr
ICAgICAgKiBmcm9tIHN5c3RlbSBoYW5nIGlmIGJhdGNoYnVmZmVyIGlzIHByb2dyZXNzaW5nIHdo
ZW4KPiA+ICsgICAgICAqIHRoZSByZXNldCBpcyBpc3N1ZWQsIHJlZ2FyZGxlc3Mgb2YgUkVBRFlf
VE9fUkVTRVQgYWNrLgo+ID4gKyAgICAgICogVGh1cyBhc3N1bWUgaXQgaXMgYmVzdCB0byBzdG9w
IGVuZ2luZXMgb24gYWxsIGdlbnMKPiA+ICsgICAgICAqIHdoZXJlIHdlIGhhdmUgYSBncHUgcmVz
ZXQuCj4gPiArICAgICAgKgo+ID4gKyAgICAgICogV2FLQkxWRUNTU2VtYXBob3JlV2FpdFBvbGw6
a2JsIChvbiBBTExfRU5HSU5FUykKPiA+ICsgICAgICAqCj4gPiArICAgICAgKiBGSVhNRTogV2Eg
Zm9yIG1vcmUgbW9kZXJuIGdlbnMgbmVlZHMgdG8gYmUgdmFsaWRhdGVkCj4gPiArICAgICAgKi8K
PiA+ICsgICAgIGludGVsX2VuZ2luZV9zdG9wX2NzKGVuZ2luZSk7Cj4gPiAgIH0KPiA+ICAgCj4g
PiAgIHN0YXRpYyB2b2lkIHJlc2V0X2NzYl9wb2ludGVycyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmUpCj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
cmVzZXQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMKPiA+IGluZGV4
IDdkZGVkZmIxNmFhMi4uNTVlMmRkY2JkMjE1IDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfcmVzZXQuYwo+ID4gQEAgLTEzNSw0NyArMTM1LDYgQEAgdm9pZCBfX2k5MTVfcmVx
dWVzdF9yZXNldChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgYm9vbCBndWlsdHkpCj4gPiAgICAg
ICB9Cj4gPiAgIH0KPiA+ICAgCj4gPiAtc3RhdGljIHZvaWQgZ2VuM19zdG9wX2VuZ2luZShzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gPiAtewo+ID4gLSAgICAgc3RydWN0IGludGVs
X3VuY29yZSAqdW5jb3JlID0gZW5naW5lLT51bmNvcmU7Cj4gPiAtICAgICBjb25zdCB1MzIgYmFz
ZSA9IGVuZ2luZS0+bW1pb19iYXNlOwo+ID4gLQo+ID4gLSAgICAgR0VNX1RSQUNFKCIlc1xuIiwg
ZW5naW5lLT5uYW1lKTsKPiA+IC0KPiA+IC0gICAgIGlmIChpbnRlbF9lbmdpbmVfc3RvcF9jcyhl
bmdpbmUpKQo+ID4gLSAgICAgICAgICAgICBHRU1fVFJBQ0UoIiVzOiB0aW1lZCBvdXQgb24gU1RP
UF9SSU5HXG4iLCBlbmdpbmUtPm5hbWUpOwo+ID4gLQo+ID4gLSAgICAgaW50ZWxfdW5jb3JlX3dy
aXRlX2Z3KHVuY29yZSwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICBSSU5HX0hFQUQo
YmFzZSksCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50ZWxfdW5jb3JlX3JlYWRf
ZncodW5jb3JlLCBSSU5HX1RBSUwoYmFzZSkpKTsKPiA+IC0gICAgIGludGVsX3VuY29yZV9wb3N0
aW5nX3JlYWRfZncodW5jb3JlLCBSSU5HX0hFQUQoYmFzZSkpOyAvKiBwYXJhbm9pYSAqLwo+ID4g
LQo+ID4gLSAgICAgaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgUklOR19IRUFEKGJhc2Up
LCAwKTsKPiA+IC0gICAgIGludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIFJJTkdfVEFJTChi
YXNlKSwgMCk7Cj4gPiAtICAgICBpbnRlbF91bmNvcmVfcG9zdGluZ19yZWFkX2Z3KHVuY29yZSwg
UklOR19UQUlMKGJhc2UpKTsKPiA+IC0KPiA+IC0gICAgIC8qIFRoZSByaW5nIG11c3QgYmUgZW1w
dHkgYmVmb3JlIGl0IGlzIGRpc2FibGVkICovCj4gPiAtICAgICBpbnRlbF91bmNvcmVfd3JpdGVf
ZncodW5jb3JlLCBSSU5HX0NUTChiYXNlKSwgMCk7Cj4gPiAtCj4gPiAtICAgICAvKiBDaGVjayBh
Y3RzIGFzIGEgcG9zdCAqLwo+ID4gLSAgICAgaWYgKGludGVsX3VuY29yZV9yZWFkX2Z3KHVuY29y
ZSwgUklOR19IRUFEKGJhc2UpKSkKPiA+IC0gICAgICAgICAgICAgR0VNX1RSQUNFKCIlczogcmlu
ZyBoZWFkIFsleF0gbm90IHBhcmtlZFxuIiwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGVu
Z2luZS0+bmFtZSwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGludGVsX3VuY29yZV9yZWFk
X2Z3KHVuY29yZSwgUklOR19IRUFEKGJhc2UpKSk7Cj4gPiAtfQo+ID4gLQo+ID4gLXN0YXRpYyB2
b2lkIHN0b3BfZW5naW5lcyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBpbnRlbF9lbmdpbmVfbWFza190
IGVuZ2luZV9tYXNrKQo+ID4gLXsKPiA+IC0gICAgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZTsKPiA+IC0gICAgIGludGVsX2VuZ2luZV9tYXNrX3QgdG1wOwo+ID4gLQo+ID4gLSAgICAg
aWYgKElOVEVMX0dFTihndC0+aTkxNSkgPCAzKQo+ID4gLSAgICAgICAgICAgICByZXR1cm47Cj4g
PiAtCj4gPiAtICAgICBmb3JfZWFjaF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgZ3QtPmk5MTUsIGVu
Z2luZV9tYXNrLCB0bXApCj4gPiAtICAgICAgICAgICAgIGdlbjNfc3RvcF9lbmdpbmUoZW5naW5l
KTsKPiA+IC19Cj4gPiAtCj4gPiAgIHN0YXRpYyBib29sIGk5MTVfaW5fcmVzZXQoc3RydWN0IHBj
aV9kZXYgKnBkZXYpCj4gPiAgIHsKPiA+ICAgICAgIHU4IGdkcnN0Owo+ID4gQEAgLTYwNywyMyAr
NTY2LDYgQEAgaW50IF9faW50ZWxfZ3RfcmVzZXQoc3RydWN0IGludGVsX2d0ICpndCwgaW50ZWxf
ZW5naW5lX21hc2tfdCBlbmdpbmVfbWFzaykKPiA+ICAgICAgICAqLwo+ID4gICAgICAgaW50ZWxf
dW5jb3JlX2ZvcmNld2FrZV9nZXQoZ3QtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiAgICAg
ICBmb3IgKHJldHJ5ID0gMDsgcmV0ID09IC1FVElNRURPVVQgJiYgcmV0cnkgPCByZXRyaWVzOyBy
ZXRyeSsrKSB7Cj4gPiAtICAgICAgICAgICAgIC8qCj4gPiAtICAgICAgICAgICAgICAqIFdlIHN0
b3AgZW5naW5lcywgb3RoZXJ3aXNlIHdlIG1pZ2h0IGdldCBmYWlsZWQgcmVzZXQgYW5kIGEKPiA+
IC0gICAgICAgICAgICAgICogZGVhZCBncHUgKG9uIGVsaykuIEFsc28gYXMgbW9kZXJuIGdwdSBh
cyBrYmwgY2FuIHN1ZmZlcgo+ID4gLSAgICAgICAgICAgICAgKiBmcm9tIHN5c3RlbSBoYW5nIGlm
IGJhdGNoYnVmZmVyIGlzIHByb2dyZXNzaW5nIHdoZW4KPiA+IC0gICAgICAgICAgICAgICogdGhl
IHJlc2V0IGlzIGlzc3VlZCwgcmVnYXJkbGVzcyBvZiBSRUFEWV9UT19SRVNFVCBhY2suCj4gPiAt
ICAgICAgICAgICAgICAqIFRodXMgYXNzdW1lIGl0IGlzIGJlc3QgdG8gc3RvcCBlbmdpbmVzIG9u
IGFsbCBnZW5zCj4gPiAtICAgICAgICAgICAgICAqIHdoZXJlIHdlIGhhdmUgYSBncHUgcmVzZXQu
Cj4gPiAtICAgICAgICAgICAgICAqCj4gPiAtICAgICAgICAgICAgICAqIFdhS0JMVkVDU1NlbWFw
aG9yZVdhaXRQb2xsOmtibCAob24gQUxMX0VOR0lORVMpCj4gPiAtICAgICAgICAgICAgICAqCj4g
PiAtICAgICAgICAgICAgICAqIFdhTWVkaWFSZXNldE1haW5SaW5nQ2xlYW51cDpjdGcsZWxrIChw
cmVzdW1hYmx5KQo+ID4gLSAgICAgICAgICAgICAgKgo+ID4gLSAgICAgICAgICAgICAgKiBGSVhN
RTogV2EgZm9yIG1vcmUgbW9kZXJuIGdlbnMgbmVlZHMgdG8gYmUgdmFsaWRhdGVkCj4gPiAtICAg
ICAgICAgICAgICAqLwo+ID4gLSAgICAgICAgICAgICBpZiAocmV0cnkpCj4gPiAtICAgICAgICAg
ICAgICAgICAgICAgc3RvcF9lbmdpbmVzKGd0LCBlbmdpbmVfbWFzayk7Cj4gPiAtCj4gCj4gT25s
eSBvdGhlciBmdW5jdGlvbmFsIGNoYW5nZSBJIHNlZSBpcyB0aGF0IHdlIHN0b3AgcmV0cnlpbmcg
dG8gc3RvcCB0aGUgCj4gZW5naW5lcyBiZWZvcmUgcmVzZXQgYXR0ZW1wdHMuIEkgZG9uJ3Qga25v
dyBpZiB0aGF0IGlzIGEgY29uY2VybiBvciBub3QuCgpBaCwgYnV0IHdlIGRvIHN0b3AgdGhlIGVu
Z2luZSBiZWZvcmUgcmVzZXRzIGluICpyZXNldF9wcmVwYXJlLiBUaGUgb3RoZXIKcGF0aCB0byBh
cnJpdmUgaXMgaW4gc2FuaXRpemUgd2hlcmUgd2UgZG9uJ3Qga25vdyBlbm91Z2ggc3RhdGUgdG8g
c2FmZWx5CnR3ZWFrIHRoZSBlbmdpbmVzLiBGb3IgdGhvc2UsIEkgY2xhaW0gaXQgc2hvdWxkbid0
IG1hdHRlciBhcyB0aGUgZW5naW5lcwpzaG91bGQgYmUgaWRsZSBhbmQgd2Ugb25seSBuZWVkIHRo
ZSByZXNldCB0byBjbGVhciBzdGFsZSBjb250ZXh0IHN0YXRlLgotQ2hyaXMKX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlz
dApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0
b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

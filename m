Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id EB01911294C
	for <lists+intel-gfx@lfdr.de>; Wed,  4 Dec 2019 11:30:22 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3688C6F614;
	Wed,  4 Dec 2019 10:30:21 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga18.intel.com (mga18.intel.com [134.134.136.126])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 002F96F614
 for <intel-gfx@lists.freedesktop.org>; Wed,  4 Dec 2019 10:30:19 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga001.fm.intel.com ([10.253.24.23])
 by orsmga106.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 04 Dec 2019 02:30:19 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.69,277,1571727600"; d="scan'208";a="218895376"
Received: from aquilante.fi.intel.com (HELO teofilatto.example.org)
 ([10.237.72.158])
 by fmsmga001.fm.intel.com with ESMTP; 04 Dec 2019 02:30:17 -0800
From: Andi Shyti <andi.shyti@intel.com>
To: Intel GFX <intel-gfx@lists.freedesktop.org>
Date: Wed,  4 Dec 2019 12:30:14 +0200
Message-Id: <20191204103014.1800-1-andi.shyti@intel.com>
X-Mailer: git-send-email 2.24.0
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915/rps: Add frequency translation helpers
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QWRkIHR3byBoZWxwZXJzIHRoYXQgZm9yIHJlYWRpbmcgdGhlIGFjdHVhbCBHVCdzIGZyZXF1ZW5j
eS4gVGhlCnR3byBoZWxwZXJzIGFyZToKCiAtIGludGVsX2NhZ2ZfcmVhZDogcmVhZHMgdGhlIGZy
ZXF1ZW5jeSBhbmQgcmV0dXJucyBpdCBub3QKICAgbm9ybWFsaXplZAoKIC0gaW50ZWxfY2FnZl9m
cmVxX3JlYWQ6IHByb3ZpZGVzIHRoZSBmcmVxdWVuY3kgaW4gSHouCgpVc2UgdGhlIGFib3ZlIGhl
bHBlcnMgaW4gc3lzZnMgYW5kIGRlYnVnZnMuCgpTaWduZWQtb2ZmLWJ5OiBBbmRpIFNoeXRpIDxh
bmRpLnNoeXRpQGludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9y
cHMuYyB8IDIyICsrKysrKysrKysrKysrKysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX3Jwcy5oIHwgIDIgKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5j
IHwgMjEgKysrKystLS0tLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3N5
c2ZzLmMgICB8IDE0ICsrLS0tLS0tLS0tLS0tCiA0IGZpbGVzIGNoYW5nZWQsIDMxIGluc2VydGlv
bnMoKyksIDI4IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX3Jwcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcnBzLmMKaW5k
ZXggMDhhMzhhM2I5MGIwLi43MmMzZGQ5NzZlMzIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX3Jwcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X3Jwcy5jCkBAIC0xNjgyLDYgKzE2ODIsMjggQEAgdTMyIGludGVsX2dldF9jYWdmKHN0cnVjdCBp
bnRlbF9ycHMgKnJwcywgdTMyIHJwc3RhdCkKIAlyZXR1cm4gIGNhZ2Y7CiB9CiAKK3UzMiBpbnRl
bF9jYWdmX3JlYWQoc3RydWN0IGludGVsX3JwcyAqcnBzKQoreworCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gcnBzX3RvX2k5MTUocnBzKTsKKwl1MzIgZnJlcTsKKworCWlmIChJU19W
QUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKKwkJdmx2X3B1bml0X2dl
dChpOTE1KTsKKwkJZnJlcSA9IHZsdl9wdW5pdF9yZWFkKGk5MTUsIFBVTklUX1JFR19HUFVfRlJF
UV9TVFMpOworCQl2bHZfcHVuaXRfcHV0KGk5MTUpOworCisJCXJldHVybiAoZnJlcSA+PiA4KSAm
IDB4ZmY7CisJfQorCisJcmV0dXJuIGludGVsX2dldF9jYWdmKHJwcywgaW50ZWxfdW5jb3JlX3Jl
YWQocnBzX3RvX2d0KHJwcyktPnVuY29yZSwKKwkJCQkJCSAgICAgR0VONl9SUFNUQVQxKSk7Cit9
CisKK3UzMiBpbnRlbF9jYWdmX2ZyZXFfcmVhZChzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCit7CisJ
cmV0dXJuIGludGVsX2dwdV9mcmVxKHJwcywgaW50ZWxfY2FnZl9yZWFkKHJwcykpOworfQorCiAv
KiBFeHRlcm5hbCBpbnRlcmZhY2UgZm9yIGludGVsX2lwcy5rbyAqLwogCiBzdGF0aWMgc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgX19yY3UgKmlwc19tY2hkZXY7CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ycHMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX3Jwcy5oCmluZGV4IDk1MThjNjZjOTc5Mi4uMzM4Zjg5MjRjZDBmIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ycHMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9ycHMuaApAQCAtMzAsNiArMzAsOCBAQCB2b2lkIGludGVsX3Jwc19tYXJr
X2ludGVyYWN0aXZlKHN0cnVjdCBpbnRlbF9ycHMgKnJwcywgYm9vbCBpbnRlcmFjdGl2ZSk7CiBp
bnQgaW50ZWxfZ3B1X2ZyZXEoc3RydWN0IGludGVsX3JwcyAqcnBzLCBpbnQgdmFsKTsKIGludCBp
bnRlbF9mcmVxX29wY29kZShzdHJ1Y3QgaW50ZWxfcnBzICpycHMsIGludCB2YWwpOwogdTMyIGlu
dGVsX2dldF9jYWdmKHN0cnVjdCBpbnRlbF9ycHMgKnJwcywgdTMyIHJwc3RhdDEpOwordTMyIGlu
dGVsX2NhZ2ZfcmVhZChzdHJ1Y3QgaW50ZWxfcnBzICpycHMpOwordTMyIGludGVsX2NhZ2ZfZnJl
cV9yZWFkKHN0cnVjdCBpbnRlbF9ycHMgKnJwcyk7CiAKIHZvaWQgZ2VuNV9ycHNfaXJxX2hhbmRs
ZXIoc3RydWN0IGludGVsX3JwcyAqcnBzKTsKIHZvaWQgZ2VuNl9ycHNfaXJxX2hhbmRsZXIoc3Ry
dWN0IGludGVsX3JwcyAqcnBzLCB1MzIgcG1faWlyKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1
Z2ZzLmMKaW5kZXggZWI4MGEyYzRiNTViLi4zZjFkMGUyZTc1NzYgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZGVidWdmcy5jCkBAIC04OTEsNyArODkxLDcgQEAgc3RhdGljIGludCBpOTE1X2ZyZXF1
ZW5jeV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogCQlycGRvd25laSA9
IEk5MTVfUkVBRChHRU42X1JQX0NVUl9ET1dOX0VJKSAmIEdFTjZfQ1VSSUFWR19NQVNLOwogCQly
cGN1cmRvd24gPSBJOTE1X1JFQUQoR0VONl9SUF9DVVJfRE9XTikgJiBHRU42X0NVUkJTWVRBVkdf
TUFTSzsKIAkJcnBwcmV2ZG93biA9IEk5MTVfUkVBRChHRU42X1JQX1BSRVZfRE9XTikgJiBHRU42
X0NVUkJTWVRBVkdfTUFTSzsKLQkJY2FnZiA9IGludGVsX2dwdV9mcmVxKHJwcywgaW50ZWxfZ2V0
X2NhZ2YocnBzLCBycHN0YXQpKTsKKwkJY2FnZiA9IGludGVsX2NhZ2ZfZnJlcV9yZWFkKHJwcyk7
CiAKIAkJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNF
V0FLRV9BTEwpOwogCkBAIC0xNjMzLDIxICsxNjMzLDExIEBAIHN0YXRpYyBpbnQgaTkxNV9ycHNf
Ym9vc3RfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCiB7CiAJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwogCXN0
cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3QucnBzOwotCXUzMiBhY3RfZnJlcSA9
IHJwcy0+Y3VyX2ZyZXE7CisJdTMyIGFjdF9mcmVxOwogCWludGVsX3dha2VyZWZfdCB3YWtlcmVm
OwogCi0Jd2l0aF9pbnRlbF9ydW50aW1lX3BtX2lmX2luX3VzZSgmZGV2X3ByaXYtPnJ1bnRpbWVf
cG0sIHdha2VyZWYpIHsKLQkJaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJS
WVZJRVcoZGV2X3ByaXYpKSB7Ci0JCQl2bHZfcHVuaXRfZ2V0KGRldl9wcml2KTsKLQkJCWFjdF9m
cmVxID0gdmx2X3B1bml0X3JlYWQoZGV2X3ByaXYsCi0JCQkJCQkgIFBVTklUX1JFR19HUFVfRlJF
UV9TVFMpOwotCQkJdmx2X3B1bml0X3B1dChkZXZfcHJpdik7Ci0JCQlhY3RfZnJlcSA9IChhY3Rf
ZnJlcSA+PiA4KSAmIDB4ZmY7Ci0JCX0gZWxzZSB7Ci0JCQlhY3RfZnJlcSA9IGludGVsX2dldF9j
YWdmKHJwcywKLQkJCQkJCSAgSTkxNV9SRUFEKEdFTjZfUlBTVEFUMSkpOwotCQl9Ci0JfQorCXdp
dGhfaW50ZWxfcnVudGltZV9wbV9pZl9pbl91c2UoJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtl
cmVmKQorCQlhY3RfZnJlcSA9IGludGVsX2NhZ2ZfZnJlcV9yZWFkKHJwcyk7CiAKIAlzZXFfcHJp
bnRmKG0sICJSUFMgZW5hYmxlZD8gJWRcbiIsIHJwcy0+ZW5hYmxlZCk7CiAJc2VxX3ByaW50Ziht
LCAiR1BVIGJ1c3k/ICVzXG4iLCB5ZXNubyhkZXZfcHJpdi0+Z3QuYXdha2UpKTsKQEAgLTE2NTUs
OCArMTY0NSw3IEBAIHN0YXRpYyBpbnQgaTkxNV9ycHNfYm9vc3RfaW5mbyhzdHJ1Y3Qgc2VxX2Zp
bGUgKm0sIHZvaWQgKmRhdGEpCiAJCSAgIGF0b21pY19yZWFkKCZycHMtPm51bV93YWl0ZXJzKSk7
CiAJc2VxX3ByaW50ZihtLCAiSW50ZXJhY3RpdmU/ICVkXG4iLCBSRUFEX09OQ0UocnBzLT5wb3dl
ci5pbnRlcmFjdGl2ZSkpOwogCXNlcV9wcmludGYobSwgIkZyZXF1ZW5jeSByZXF1ZXN0ZWQgJWQs
IGFjdHVhbCAlZFxuIiwKLQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmN1cl9mcmVxKSwK
LQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBhY3RfZnJlcSkpOworCQkgICBpbnRlbF9ncHVfZnJl
cShycHMsIHJwcy0+Y3VyX2ZyZXEpLCBhY3RfZnJlcSk7CiAJc2VxX3ByaW50ZihtLCAiICBtaW4g
aGFyZDolZCwgc29mdDolZDsgbWF4IHNvZnQ6JWQsIGhhcmQ6JWRcbiIsCiAJCSAgIGludGVsX2dw
dV9mcmVxKHJwcywgcnBzLT5taW5fZnJlcSksCiAJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBz
LT5taW5fZnJlcV9zb2Z0bGltaXQpLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9zeXNmcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zeXNmcy5jCmluZGV4IDY1
NDc2OTA5ZDFiZi4uMTc2Y2RiMTM5ZjBiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3N5c2ZzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zeXNmcy5jCkBA
IC0yNjUsMjAgKzI2NSwxMCBAQCBzdGF0aWMgc3NpemVfdCBndF9hY3RfZnJlcV9taHpfc2hvdyhz
dHJ1Y3QgZGV2aWNlICprZGV2LAogCXUzMiBmcmVxOwogCiAJd2FrZXJlZiA9IGludGVsX3J1bnRp
bWVfcG1fZ2V0KCZkZXZfcHJpdi0+cnVudGltZV9wbSk7Ci0KLQlpZiAoSVNfVkFMTEVZVklFVyhk
ZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKLQkJdmx2X3B1bml0X2dldChk
ZXZfcHJpdik7Ci0JCWZyZXEgPSB2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgUFVOSVRfUkVHX0dQ
VV9GUkVRX1NUUyk7Ci0JCXZsdl9wdW5pdF9wdXQoZGV2X3ByaXYpOwotCi0JCWZyZXEgPSAoZnJl
cSA+PiA4KSAmIDB4ZmY7Ci0JfSBlbHNlIHsKLQkJZnJlcSA9IGludGVsX2dldF9jYWdmKHJwcywg
STkxNV9SRUFEKEdFTjZfUlBTVEFUMSkpOwotCX0KLQorCWZyZXEgPSBpbnRlbF9jYWdmX2ZyZXFf
cmVhZChycHMpOwogCWludGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwg
d2FrZXJlZik7CiAKLQlyZXR1cm4gc25wcmludGYoYnVmLCBQQUdFX1NJWkUsICIlZFxuIiwgaW50
ZWxfZ3B1X2ZyZXEocnBzLCBmcmVxKSk7CisJcmV0dXJuIHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpF
LCAiJWRcbiIsIGZyZXEpOwogfQogCiBzdGF0aWMgc3NpemVfdCBndF9jdXJfZnJlcV9taHpfc2hv
dyhzdHJ1Y3QgZGV2aWNlICprZGV2LAotLSAKMi4yNC4wCgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdm
eEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFp
bG1hbi9saXN0aW5mby9pbnRlbC1nZng=

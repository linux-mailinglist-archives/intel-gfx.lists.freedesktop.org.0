Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id A12BE19E76
	for <lists+intel-gfx@lfdr.de>; Fri, 10 May 2019 15:49:07 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 5124B89C68;
	Fri, 10 May 2019 13:49:05 +0000 (UTC)
X-Original-To: Intel-gfx@lists.freedesktop.org
Delivered-To: Intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id DB1E189C68;
 Fri, 10 May 2019 13:49:03 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 16516945-1500050 for multiple; Fri, 10 May 2019 14:48:53 +0100
MIME-Version: 1.0
To: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>,
 igt-dev@lists.freedesktop.org
From: Chris Wilson <chris@chris-wilson.co.uk>
In-Reply-To: <20190508121058.27038-18-tvrtko.ursulin@linux.intel.com>
References: <20190508121058.27038-1-tvrtko.ursulin@linux.intel.com>
 <20190508121058.27038-18-tvrtko.ursulin@linux.intel.com>
Message-ID: <155749613109.10894.9454885750652959998@skylake-alporthouse-com>
User-Agent: alot/0.6
Date: Fri, 10 May 2019 14:48:51 +0100
Subject: Re: [Intel-gfx] [igt-dev] [PATCH i-g-t 17/21] gem_wsim: Infinite
 batch support
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Intel-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVvdGluZyBUdnJ0a28gVXJzdWxpbiAoMjAxOS0wNS0wOCAxMzoxMDo1NCkKPiBGcm9tOiBUdnJ0
a28gVXJzdWxpbiA8dHZydGtvLnVyc3VsaW5AaW50ZWwuY29tPgo+IAo+IEZvciBzaW11bGF0aW5n
IGZyYW1lIHNwbGl0IHdvcmtsb2FkcyBpdCBpcyB1c2VmdWwgdG8gZXhwcmVzcyBhIGJhdGNoIHdo
aWNoCj4gZW5kcyBhdCB0aGUgc2FtZSB0aW1lIGFzIHRoZSBwYXJhbGxlbCBzdWJtaXNzaW9uIG9u
IHRoZSByZXNwZWN0aXZlIGJvbmRlZAo+IGVuZ2luZS4gRm9yIHRoaXMgd2UgYWRkIHN1cHBvcnQg
Zm9yIGluZmluaXRlIGJhdGNoIGR1cmF0aW9ucyBhbmQgdGhlIGJhdGNoCj4gdGVybWluYXRlIGNv
bW1hbmQgKCdUJykuIFN5bnRheCBsb29rcyBsaWtlIHRoaXM6Cj4gCj4gICAxLlJDUy4qLjAuMAo+
ICAgVC4tMQo+IAo+IEZpcnN0IHN0ZXAgc3RhcnRzIGFuIGluZmluaXRlIGJhdGNoLCBhbmQgc2Vj
b25kIGNvbW1hbmQgdGVybWluYXRlcyB0aGUKPiBpbmZpbml0ZSBiYXRjaCB3aXRoIHRoZSB1c3Vh
bCByZWxhdGl2ZSB3b3JrbG9hZCBzdGVwIGFkZHJlc3NpbmcuCj4gCj4gU2lnbmVkLW9mZi1ieTog
VHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KPiAtLS0KPiAgYmVuY2ht
YXJrcy9nZW1fd3NpbS5jICAgICAgICAgICAgICAgICAgfCAxMTkgKysrKysrKysrKysrKysrKysr
Ky0tLS0tLQo+ICBiZW5jaG1hcmtzL3dzaW0vUkVBRE1FICAgICAgICAgICAgICAgICB8ICAgOSAr
LQo+ICBiZW5jaG1hcmtzL3dzaW0vZnJhbWUtc3BsaXQtNjBmcHMud3NpbSB8ICAgNiArLQo+ICAz
IGZpbGVzIGNoYW5nZWQsIDEwMiBpbnNlcnRpb25zKCspLCAzMiBkZWxldGlvbnMoLSkKPiAKPiBk
aWZmIC0tZ2l0IGEvYmVuY2htYXJrcy9nZW1fd3NpbS5jIGIvYmVuY2htYXJrcy9nZW1fd3NpbS5j
Cj4gaW5kZXggY2M2ZjRhNzQyYzEyLi45NzgyMWI3MjNiMDIgMTAwNjQ0Cj4gLS0tIGEvYmVuY2ht
YXJrcy9nZW1fd3NpbS5jCj4gKysrIGIvYmVuY2htYXJrcy9nZW1fd3NpbS5jCj4gQEAgLTg2LDYg
Kzg2LDcgQEAgZW51bSB3X3R5cGUKPiAgICAgICAgIEVOR0lORV9NQVAsCj4gICAgICAgICBMT0FE
X0JBTEFOQ0UsCj4gICAgICAgICBCT05ELAo+ICsgICAgICAgVEVSTUlOQVRFLAo+ICB9Owo+ICAK
PiAgc3RydWN0IGRlcHMKPiBAQCAtMTEzLDYgKzExNCw3IEBAIHN0cnVjdCB3X3N0ZXAKPiAgICAg
ICAgIHVuc2lnbmVkIGludCBjb250ZXh0Owo+ICAgICAgICAgdW5zaWduZWQgaW50IGVuZ2luZTsK
PiAgICAgICAgIHN0cnVjdCBkdXJhdGlvbiBkdXJhdGlvbjsKPiArICAgICAgIGJvb2wgdW5ib3Vu
ZF9kdXJhdGlvbjsKPiAgICAgICAgIHN0cnVjdCBkZXBzIGRhdGFfZGVwczsKPiAgICAgICAgIHN0
cnVjdCBkZXBzIGZlbmNlX2RlcHM7Cj4gICAgICAgICBpbnQgZW1pdF9mZW5jZTsKPiBAQCAtMTQz
LDcgKzE0NSw3IEBAIHN0cnVjdCB3X3N0ZXAKPiAgCj4gICAgICAgICBzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX2V4ZWNidWZmZXIyIGViOwo+ICAgICAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9leGVjX29i
amVjdDIgKm9iajsKPiAtICAgICAgIHN0cnVjdCBkcm1faTkxNV9nZW1fcmVsb2NhdGlvbl9lbnRy
eSByZWxvY1s0XTsKPiArICAgICAgIHN0cnVjdCBkcm1faTkxNV9nZW1fcmVsb2NhdGlvbl9lbnRy
eSByZWxvY1s1XTsKPiAgICAgICAgIHVuc2lnbmVkIGxvbmcgYmJfc3o7Cj4gICAgICAgICB1aW50
MzJfdCBiYl9oYW5kbGU7Cj4gICAgICAgICB1aW50MzJfdCAqc2Vxbm9fdmFsdWU7Cj4gQEAgLTE1
Myw2ICsxNTUsNyBAQCBzdHJ1Y3Qgd19zdGVwCj4gICAgICAgICB1aW50MzJfdCAqcnQxX2FkZHJl
c3M7Cj4gICAgICAgICB1aW50MzJfdCAqbGF0Y2hfdmFsdWU7Cj4gICAgICAgICB1aW50MzJfdCAq
bGF0Y2hfYWRkcmVzczsKPiArICAgICAgIHVpbnQzMl90ICpyZWN1cnNpdmVfYmJfc3RhcnQ7Cj4g
IH07Cj4gIAo+ICBERUNMQVJFX0VXTUEodWludDY0X3QsIHJ0LCA0LCAyKQo+IEBAIC00OTEsNiAr
NDk0LDEwIEBAIHBhcnNlX3dvcmtsb2FkKHN0cnVjdCB3X2FyZyAqYXJnLCB1bnNpZ25lZCBpbnQg
ZmxhZ3MsIHN0cnVjdCB3b3JrbG9hZCAqYXBwX3cpCj4gIAo+ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgc3RlcC50eXBlID0gRU5HSU5FX01BUDsKPiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGdvdG8gYWRkX3N0ZXA7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgfSBl
bHNlIGlmICghc3RyY21wKGZpZWxkLCAiVCIpKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBpbnRfZmllbGQoVEVSTUlOQVRFLCB0YXJnZXQsCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdG1wID49IDAgfHwgKChpbnQpbnJfc3RlcHMgKyB0bXAp
IDwgMCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiSW52YWxp
ZCB0ZXJtaW5hdGUgdGFyZ2V0IGF0IHN0ZXAgJXUhXG4iKTsKPiAgICAgICAgICAgICAgICAgICAg
ICAgICB9IGVsc2UgaWYgKCFzdHJjbXAoZmllbGQsICJYIikpIHsKPiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBuciA9IDA7Cj4gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB3aGlsZSAoKGZpZWxkID0gc3RydG9rX3IoZnN0YXJ0LCAiLiIsICZmY3R4
KSkpIHsKPiBAQCAtNjA1LDIzICs2MTIsMjggQEAgcGFyc2Vfd29ya2xvYWQoc3RydWN0IHdfYXJn
ICphcmcsIHVuc2lnbmVkIGludCBmbGFncywgc3RydWN0IHdvcmtsb2FkICphcHBfdykKPiAgCj4g
ICAgICAgICAgICAgICAgICAgICAgICAgZnN0YXJ0ID0gTlVMTDsKPiAgCj4gLSAgICAgICAgICAg
ICAgICAgICAgICAgdG1wbCA9IHN0cnRvbChmaWVsZCwgJnNlcCwgMTApOwo+IC0gICAgICAgICAg
ICAgICAgICAgICAgIGNoZWNrX2FyZyh0bXBsIDw9IDAgfHwgdG1wbCA9PSBMT05HX01JTiB8fAo+
IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBsID09IExPTkdfTUFYLAo+IC0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiSW52YWxpZCBkdXJhdGlvbiBhdCBzdGVw
ICV1IVxuIiwgbnJfc3RlcHMpOwo+IC0gICAgICAgICAgICAgICAgICAgICAgIHN0ZXAuZHVyYXRp
b24ubWluID0gdG1wbDsKPiAtCj4gLSAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlcCAmJiAq
c2VwID09ICctJykgewo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wbCA9IHN0
cnRvbChzZXAgKyAxLCBOVUxMLCAxMCk7Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBjaGVja19hcmcodG1wbCA8PSAwIHx8Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgdG1wbCA8PSBzdGVwLmR1cmF0aW9uLm1pbiB8fAo+IC0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcGwgPT0gTE9OR19NSU4gfHwKPiArICAgICAg
ICAgICAgICAgICAgICAgICBpZiAoZmllbGRbMF0gPT0gJyonKSB7Cj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzdGVwLnVuYm91bmRfZHVyYXRpb24gPSB0cnVlOwo+ICsgICAgICAg
ICAgICAgICAgICAgICAgIH0gZWxzZSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB0bXBsID0gc3RydG9sKGZpZWxkLCAmc2VwLCAxMCk7Cj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBjaGVja19hcmcodG1wbCA8PSAwIHx8IHRtcGwgPT0gTE9OR19NSU4gfHwKPiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBsID09IExPTkdfTUFY
LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJJbnZhbGlkIGR1
cmF0aW9uIHJhbmdlIGF0IHN0ZXAgJXUhXG4iLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICJJbnZhbGlkIGR1cmF0aW9uIGF0IHN0ZXAgJXUhXG4iLAo+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5yX3N0ZXBzKTsKPiAtICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXAuZHVyYXRpb24ubWF4ID0gdG1wbDsKPiAtICAg
ICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugewo+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgc3RlcC5kdXJhdGlvbi5tYXggPSBzdGVwLmR1cmF0aW9uLm1pbjsKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHN0ZXAuZHVyYXRpb24ubWluID0gdG1wbDsKPiArCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VwICYmICpzZXAgPT0gJy0nKSB7Cj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcGwgPSBzdHJ0b2woc2Vw
ICsgMSwgTlVMTCwgMTApOwo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBjaGVja19hcmcodG1wbCA8PSAwIHx8Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdG1wbCA8PSBzdGVwLmR1cmF0aW9uLm1pbiB8fAo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcGwgPT0gTE9OR19NSU4g
fHwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBs
ID09IExPTkdfTUFYLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICJJbnZhbGlkIGR1cmF0aW9uIHJhbmdlIGF0IHN0ZXAgJXUhXG4iLAo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5yX3N0ZXBzKTsKPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcC5kdXJhdGlvbi5tYXggPSB0
bXBsOwo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcC5kdXJhdGlvbi5tYXggPSBzdGVw
LmR1cmF0aW9uLm1pbjsKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KPiAgICAg
ICAgICAgICAgICAgICAgICAgICB9Cj4gIAo+ICAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlk
Kys7Cj4gQEAgLTc4MSw3ICs3OTMsNyBAQCBpbml0X2JiKHN0cnVjdCB3X3N0ZXAgKncsIHVuc2ln
bmVkIGludCBmbGFncykKPiAgICAgICAgIHVuc2lnbmVkIGludCBpOwo+ICAgICAgICAgdWludDMy
X3QgKnB0cjsKPiAgCj4gLSAgICAgICBpZiAoIWFyYl9wZXJpb2QpCj4gKyAgICAgICBpZiAody0+
dW5ib3VuZF9kdXJhdGlvbiB8fCAhYXJiX3BlcmlvZCkKPiAgICAgICAgICAgICAgICAgcmV0dXJu
Owo+ICAKPiAgICAgICAgIGdlbV9zZXRfZG9tYWluKGZkLCB3LT5iYl9oYW5kbGUsCj4gQEAgLTgw
MSw2ICs4MTMsNyBAQCB0ZXJtaW5hdGVfYmIoc3RydWN0IHdfc3RlcCAqdywgdW5zaWduZWQgaW50
IGZsYWdzKQo+ICAgICAgICAgY29uc3QgdWludDMyX3QgYmJlID0gMHhhIDw8IDIzOwo+ICAgICAg
ICAgdW5zaWduZWQgbG9uZyBtbWFwX3N0YXJ0LCBtbWFwX2xlbjsKPiAgICAgICAgIHVuc2lnbmVk
IGxvbmcgYmF0Y2hfc3RhcnQgPSB3LT5iYl9zejsKPiArICAgICAgIHVuc2lnbmVkIGludCByID0g
MDsKPiAgICAgICAgIHVpbnQzMl90ICpwdHIsICpjczsKPiAgCj4gICAgICAgICBpZ3RfYXNzZXJ0
KCgoZmxhZ3MgJiBSVCkgJiYgKGZsYWdzICYgU0VRTk8pKSB8fCAhKGZsYWdzICYgUlQpKTsKPiBA
QCAtODExLDYgKzgyNCw5IEBAIHRlcm1pbmF0ZV9iYihzdHJ1Y3Qgd19zdGVwICp3LCB1bnNpZ25l
ZCBpbnQgZmxhZ3MpCj4gICAgICAgICBpZiAoZmxhZ3MgJiBSVCkKPiAgICAgICAgICAgICAgICAg
YmF0Y2hfc3RhcnQgLT0gMTIgKiBzaXplb2YodWludDMyX3QpOwo+ICAKPiArICAgICAgIGlmICh3
LT51bmJvdW5kX2R1cmF0aW9uKQo+ICsgICAgICAgICAgICAgICBiYXRjaF9zdGFydCAtPSA0ICog
c2l6ZW9mKHVpbnQzMl90KTsgLyogTUlfQVJCX0NISyArIE1JX0JBVENIX0JVRkZFUl9TVEFSVCAq
Lwo+ICsKPiAgICAgICAgIG1tYXBfc3RhcnQgPSByb3VuZGRvd24oYmF0Y2hfc3RhcnQsIFBBR0Vf
U0laRSk7Cj4gICAgICAgICBtbWFwX2xlbiA9IEFMSUdOKHctPmJiX3N6IC0gbW1hcF9zdGFydCwg
UEFHRV9TSVpFKTsKPiAgCj4gQEAgLTgyMCw4ICs4MzYsMTkgQEAgdGVybWluYXRlX2JiKHN0cnVj
dCB3X3N0ZXAgKncsIHVuc2lnbmVkIGludCBmbGFncykKPiAgICAgICAgIHB0ciA9IGdlbV9tbWFw
X193YyhmZCwgdy0+YmJfaGFuZGxlLCBtbWFwX3N0YXJ0LCBtbWFwX2xlbiwgUFJPVF9XUklURSk7
Cj4gICAgICAgICBjcyA9ICh1aW50MzJfdCAqKSgoY2hhciAqKXB0ciArIGJhdGNoX3N0YXJ0IC0g
bW1hcF9zdGFydCk7Cj4gIAo+ICsgICAgICAgaWYgKHctPnVuYm91bmRfZHVyYXRpb24pIHsKPiAr
ICAgICAgICAgICAgICAgdy0+cmVsb2NbcisrXS5vZmZzZXQgPSBiYXRjaF9zdGFydCArIDIgKiBz
aXplb2YodWludDMyX3QpOwo+ICsgICAgICAgICAgICAgICBiYXRjaF9zdGFydCArPSA0ICogc2l6
ZW9mKHVpbnQzMl90KTsKPiArCj4gKyAgICAgICAgICAgICAgICpjcysrID0gdy0+cHJlZW1wdF91
cyA/IDB4NSA8PCAyMyAvKiBNSV9BUkJfQ0hLOyAqLyA6IE1JX05PT1A7Cj4gKyAgICAgICAgICAg
ICAgIHctPnJlY3Vyc2l2ZV9iYl9zdGFydCA9IGNzOwo+ICsgICAgICAgICAgICAgICAqY3MrKyA9
IE1JX0JBVENIX0JVRkZFUl9TVEFSVCB8IDEgPDwgOCB8IDE7Cj4gKyAgICAgICAgICAgICAgICpj
cysrID0gMDsKPiArICAgICAgICAgICAgICAgKmNzKysgPSAwOwoKSG1tLiBIYXZlIHdlIHByZXZp
b3VzbHkgY2hlY2tlZCBmb3IgZ2VuID49IDg/CgpTbyBwcmVlbXB0aW9uIGNoZWNrIGludGVydmFs
IGlzIGdpdmVuIGJ5IGJhdGNoX3N0YXJ0IC0gbW1hcF9zdGFydC4KV2hpY2ggaXMgbGltaXRlZCB0
byBhIG1heCBvZiA2NCBieXRlcy4gVGhhdCBtaWdodCBiZSBhIGJpdCBleGNlc3NpdmUgb24KdGhl
IGZyZXF1ZW5jeSBvZiBkb2luZyBNSV9CQl9TVEFSVCwgY2VydGFpbmx5IGZvciBnZW43LCBnZW44
KyBpcyBhIHRhZAptb3JlIGZvcmdpdmluZyBpLmUuIGl0IGhhcyBtb3JlIGJ3IGFuZCBkb2Vzbid0
IHN0YXJ2ZSB0aGUgY3B1IGFzIG11Y2guCgo+ICsgICAgICAgfQo+ICsKPiAgICAgICAgIGlmIChm
bGFncyAmIFNFUU5PKSB7Cj4gLSAgICAgICAgICAgICAgIHctPnJlbG9jWzBdLm9mZnNldCA9IGJh
dGNoX3N0YXJ0ICsgc2l6ZW9mKHVpbnQzMl90KTsKPiArICAgICAgICAgICAgICAgdy0+cmVsb2Nb
cisrXS5vZmZzZXQgPSBiYXRjaF9zdGFydCArIHNpemVvZih1aW50MzJfdCk7Cj4gICAgICAgICAg
ICAgICAgIGJhdGNoX3N0YXJ0ICs9IDQgKiBzaXplb2YodWludDMyX3QpOwo+ICAKPiAgICAgICAg
ICAgICAgICAgKmNzKysgPSBNSV9TVE9SRV9EV09SRF9JTU07Cj4gQEAgLTgzMyw3ICs4NjAsNyBA
QCB0ZXJtaW5hdGVfYmIoc3RydWN0IHdfc3RlcCAqdywgdW5zaWduZWQgaW50IGZsYWdzKQo+ICAg
ICAgICAgfQo+ICAKPiAgICAgICAgIGlmIChmbGFncyAmIFJUKSB7Cj4gLSAgICAgICAgICAgICAg
IHctPnJlbG9jWzFdLm9mZnNldCA9IGJhdGNoX3N0YXJ0ICsgc2l6ZW9mKHVpbnQzMl90KTsKPiAr
ICAgICAgICAgICAgICAgdy0+cmVsb2NbcisrXS5vZmZzZXQgPSBiYXRjaF9zdGFydCArIHNpemVv
Zih1aW50MzJfdCk7Cj4gICAgICAgICAgICAgICAgIGJhdGNoX3N0YXJ0ICs9IDQgKiBzaXplb2Yo
dWludDMyX3QpOwo+ICAKPiAgICAgICAgICAgICAgICAgKmNzKysgPSBNSV9TVE9SRV9EV09SRF9J
TU07Cj4gQEAgLTg0Myw3ICs4NzAsNyBAQCB0ZXJtaW5hdGVfYmIoc3RydWN0IHdfc3RlcCAqdywg
dW5zaWduZWQgaW50IGZsYWdzKQo+ICAgICAgICAgICAgICAgICB3LT5ydDBfdmFsdWUgPSBjczsK
PiAgICAgICAgICAgICAgICAgKmNzKysgPSAwOwo+ICAKPiAtICAgICAgICAgICAgICAgdy0+cmVs
b2NbMl0ub2Zmc2V0ID0gYmF0Y2hfc3RhcnQgKyAyICogc2l6ZW9mKHVpbnQzMl90KTsKPiArICAg
ICAgICAgICAgICAgdy0+cmVsb2NbcisrXS5vZmZzZXQgPSBiYXRjaF9zdGFydCArIDIgKiBzaXpl
b2YodWludDMyX3QpOwo+ICAgICAgICAgICAgICAgICBiYXRjaF9zdGFydCArPSA0ICogc2l6ZW9m
KHVpbnQzMl90KTsKPiAgCj4gICAgICAgICAgICAgICAgICpjcysrID0gMHgyNCA8PCAyMyB8IDI7
IC8qIE1JX1NUT1JFX1JFR19NRU0gKi8KPiBAQCAtODUyLDcgKzg3OSw3IEBAIHRlcm1pbmF0ZV9i
YihzdHJ1Y3Qgd19zdGVwICp3LCB1bnNpZ25lZCBpbnQgZmxhZ3MpCj4gICAgICAgICAgICAgICAg
ICpjcysrID0gMDsKPiAgICAgICAgICAgICAgICAgKmNzKysgPSAwOwo+ICAKPiAtICAgICAgICAg
ICAgICAgdy0+cmVsb2NbM10ub2Zmc2V0ID0gYmF0Y2hfc3RhcnQgKyBzaXplb2YodWludDMyX3Qp
Owo+ICsgICAgICAgICAgICAgICB3LT5yZWxvY1tyKytdLm9mZnNldCA9IGJhdGNoX3N0YXJ0ICsg
c2l6ZW9mKHVpbnQzMl90KTsKPiAgICAgICAgICAgICAgICAgYmF0Y2hfc3RhcnQgKz0gNCAqIHNp
emVvZih1aW50MzJfdCk7Cj4gIAo+ICAgICAgICAgICAgICAgICAqY3MrKyA9IE1JX1NUT1JFX0RX
T1JEX0lNTTsKPiBAQCAtOTg0LDE5ICsxMDExLDI4IEBAIGFsbG9jX3N0ZXBfYmF0Y2goc3RydWN0
IHdvcmtsb2FkICp3cmssIHN0cnVjdCB3X3N0ZXAgKncsIHVuc2lnbmVkIGludCBmbGFncykKPiAg
ICAgICAgICAgICAgICAgfQo+ICAgICAgICAgfQo+ICAKPiAtICAgICAgIHctPmJiX3N6ID0gZ2V0
X2JiX3N6KHctPmR1cmF0aW9uLm1heCk7Cj4gLSAgICAgICB3LT5iYl9oYW5kbGUgPSB3LT5vYmpb
al0uaGFuZGxlID0gZ2VtX2NyZWF0ZShmZCwgdy0+YmJfc3opOwo+ICsgICAgICAgaWYgKHctPnVu
Ym91bmRfZHVyYXRpb24pCj4gKyAgICAgICAgICAgICAgIC8qIG5vcHMgKyBNSV9BUkJfQ0hLICsg
TUlfQkFUQ0hfQlVGRkVSX1NUQVJUICovCj4gKyAgICAgICAgICAgICAgIHctPmJiX3N6ID0gbWF4
KDY0LCBnZXRfYmJfc3oody0+cHJlZW1wdF91cykpICsKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAoMSArIDMpICogc2l6ZW9mKHVpbnQzMl90KTsKPiArICAgICAgIGVsc2UKPiArICAgICAg
ICAgICAgICAgdy0+YmJfc3ogPSBnZXRfYmJfc3oody0+ZHVyYXRpb24ubWF4KTsKPiArICAgICAg
IHctPmJiX2hhbmRsZSA9IHctPm9ialtqXS5oYW5kbGUgPSBnZW1fY3JlYXRlKGZkLCB3LT5iYl9z
eiArICh3LT51bmJvdW5kX2R1cmF0aW9uID8gNDA5NiA6IDApKTsKPiAgICAgICAgIGluaXRfYmIo
dywgZmxhZ3MpOwo+ICAgICAgICAgdGVybWluYXRlX2JiKHcsIGZsYWdzKTsKPiAgCj4gLSAgICAg
ICBpZiAoZmxhZ3MgJiBTRVFOTykgewo+ICsgICAgICAgaWYgKChmbGFncyAmIFNFUU5PKSB8fCB3
LT51bmJvdW5kX2R1cmF0aW9uKSB7Cj4gICAgICAgICAgICAgICAgIHctPm9ialtqXS5yZWxvY3Nf
cHRyID0gdG9fdXNlcl9wb2ludGVyKCZ3LT5yZWxvYyk7Cj4gKyAgICAgICAgICAgICAgIGlmIChm
bGFncyAmIFNFUU5PKQo+ICsgICAgICAgICAgICAgICAgICAgICAgIHctPm9ialtqXS5yZWxvY2F0
aW9uX2NvdW50Kys7Cj4gICAgICAgICAgICAgICAgIGlmIChmbGFncyAmIFJUKQo+IC0gICAgICAg
ICAgICAgICAgICAgICAgIHctPm9ialtqXS5yZWxvY2F0aW9uX2NvdW50ID0gNDsKPiAtICAgICAg
ICAgICAgICAgZWxzZQo+IC0gICAgICAgICAgICAgICAgICAgICAgIHctPm9ialtqXS5yZWxvY2F0
aW9uX2NvdW50ID0gMTsKPiArICAgICAgICAgICAgICAgICAgICAgICB3LT5vYmpbal0ucmVsb2Nh
dGlvbl9jb3VudCArPSAzOwo+ICsgICAgICAgICAgICAgICBpZiAody0+dW5ib3VuZF9kdXJhdGlv
bikKPiArICAgICAgICAgICAgICAgICAgICAgICB3LT5vYmpbal0ucmVsb2NhdGlvbl9jb3VudCsr
OwoKSHVoLCBJIGV4cGVjdGVkIHRvIHNlZSB3LT5vYmpbal0ucmVsb2NhdGlvbl9jb3VudCA9IHI7
CkFscmVhZHkgb3V0IG9mIHNjb3BlPwoKPiAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8
IHctPm9ialtqXS5yZWxvY2F0aW9uX2NvdW50OyBpKyspCj4gICAgICAgICAgICAgICAgICAgICAg
ICAgdy0+cmVsb2NbaV0udGFyZ2V0X2hhbmRsZSA9IDE7Cj4gKyAgICAgICAgICAgICAgIGlmICh3
LT51bmJvdW5kX2R1cmF0aW9uKQo+ICsgICAgICAgICAgICAgICAgICAgICAgIHctPnJlbG9jWzBd
LnRhcmdldF9oYW5kbGUgPSBqOwoKT2ssIHJlY3Vyc2l2ZSBCQl9TVEFSVC4KPiAgICAgICAgIH0K
PiAgCj4gICAgICAgICB3LT5lYi5idWZmZXJzX3B0ciA9IHRvX3VzZXJfcG9pbnRlcih3LT5vYmop
Owo+IEBAIC0yMDM2LDYgKzIwNzIsMTggQEAgdXBkYXRlX2JiX3J0KHN0cnVjdCB3X3N0ZXAgKncs
IGVudW0gaW50ZWxfZW5naW5lX2lkIGVuZ2luZSwgdWludDMyX3Qgc2Vxbm8pCj4gICAgICAgICB9
Cj4gIH0KPiAgCj4gK3N0YXRpYyB2b2lkCj4gK3VwZGF0ZV9iYl9zdGFydChzdHJ1Y3Qgd19zdGVw
ICp3KQo+ICt7Cj4gKyAgICAgICBpZiAoIXctPnVuYm91bmRfZHVyYXRpb24pCj4gKyAgICAgICAg
ICAgICAgIHJldHVybjsKPiArCj4gKyAgICAgICBnZW1fc2V0X2RvbWFpbihmZCwgdy0+YmJfaGFu
ZGxlLAo+ICsgICAgICAgICAgICAgICAgICAgICAgSTkxNV9HRU1fRE9NQUlOX1dDLCBJOTE1X0dF
TV9ET01BSU5fV0MpOwoKSG1tLiBBIHNjYXJ5IHN5bmMgcG9pbnQuIERvIHlvdSBqdXN0IHdhbnQg
dG8gYmUgc3VyZSB5b3UgaGF2ZSBmbHVzaGVkCnRoZSBwcmV2aW91cyB1c2VyPwoKPiArICAgICAg
ICp3LT5yZWN1cnNpdmVfYmJfc3RhcnQgPSBNSV9CQVRDSF9CVUZGRVJfU1RBUlQgfCAoMSA8PCA4
KSB8IDE7Cj4gK30KPiArCj4gIHN0YXRpYyB2b2lkIHdfc3luY190byhzdHJ1Y3Qgd29ya2xvYWQg
Kndyaywgc3RydWN0IHdfc3RlcCAqdywgaW50IHRhcmdldCkKPiAgewo+ICAgICAgICAgaWYgKHRh
cmdldCA8IDApCj4gQEAgLTIxNzEsOSArMjIxOSwxMyBAQCBkb19lYihzdHJ1Y3Qgd29ya2xvYWQg
Kndyaywgc3RydWN0IHdfc3RlcCAqdywgZW51bSBpbnRlbF9lbmdpbmVfaWQgZW5naW5lLAo+ICAg
ICAgICAgaWYgKGZsYWdzICYgUlQpCj4gICAgICAgICAgICAgICAgIHVwZGF0ZV9iYl9ydCh3LCBl
bmdpbmUsIHNlcW5vKTsKPiAgCj4gKyAgICAgICB1cGRhdGVfYmJfc3RhcnQodyk7Cj4gKwo+ICAg
ICAgICAgdy0+ZWIuYmF0Y2hfc3RhcnRfb2Zmc2V0ID0KPiArICAgICAgICAgICAgICAgdy0+dW5i
b3VuZF9kdXJhdGlvbiA/Cj4gKyAgICAgICAgICAgICAgIDAgOgo+ICAgICAgICAgICAgICAgICBB
TElHTih3LT5iYl9zeiAtIGdldF9iYl9zeihnZXRfZHVyYXRpb24odykpLAo+IC0gICAgICAgICAg
ICAgICAgICAgICAgIDIgKiBzaXplb2YodWludDMyX3QpKTsKPiArICAgICAgICAgICAgICAgICAg
ICAgMiAqIHNpemVvZih1aW50MzJfdCkpOwo+ICAKPiAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB3
LT5mZW5jZV9kZXBzLm5yOyBpKyspIHsKPiAgICAgICAgICAgICAgICAgaW50IHRndCA9IHctPmlk
eCArIHctPmZlbmNlX2RlcHMubGlzdFtpXTsKPiBAQCAtMjMxMyw2ICsyMzY1LDE3IEBAIHN0YXRp
YyB2b2lkICpydW5fd29ya2xvYWQodm9pZCAqZGF0YSkKPiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHctPnByaW9yaXR5
Owo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQo+ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgY29udGludWU7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNl
IGlmICh3LT50eXBlID09IFRFUk1JTkFURSkgewo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdW5zaWduZWQgaW50IHRfaWR4ID0gaSArIHctPnRhcmdldDsKPiArCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBpZ3RfYXNzZXJ0KHRfaWR4ID49IDAgJiYgdF9pZHggPCBp
KTsKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlndF9hc3NlcnQod3JrLT5zdGVw
c1t0X2lkeF0udHlwZSA9PSBCQVRDSCk7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBpZ3RfYXNzZXJ0KHdyay0+c3RlcHNbdF9pZHhdLnVuYm91bmRfZHVyYXRpb24pOwo+ICsKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICp3cmstPnN0ZXBzW3RfaWR4XS5yZWN1cnNp
dmVfYmJfc3RhcnQgPQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBN
SV9CQVRDSF9CVUZGRVJfRU5EOwo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19z
eW5jX3N5bmNocm9uaXplKCk7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250
aW51ZTsKPiAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHctPnR5cGUgPT0gUFJF
RU1QVElPTiB8fAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdy0+dHlwZSA9
PSBFTkdJTkVfTUFQIHx8Cj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3LT50
eXBlID09IExPQURfQkFMQU5DRSB8fAo+IGRpZmYgLS1naXQgYS9iZW5jaG1hcmtzL3dzaW0vUkVB
RE1FIGIvYmVuY2htYXJrcy93c2ltL1JFQURNRQo+IGluZGV4IDZhZWM3MThiYzgxMi4uYzk0ZDAx
MDE4NDE5IDEwMDY0NAo+IC0tLSBhL2JlbmNobWFya3Mvd3NpbS9SRUFETUUKPiArKysgYi9iZW5j
aG1hcmtzL3dzaW0vUkVBRE1FCj4gQEAgLTIsMTEgKzIsMTEgQEAgV29ya2xvYWQgZGVzY3JpcHRv
ciBmb3JtYXQKPiAgPT09PT09PT09PT09PT09PT09PT09PT09PT0KPiAgCj4gIGN0eC5lbmdpbmUu
ZHVyYXRpb25fdXMuZGVwZW5kZW5jeS53YWl0LC4uLgo+IC08dWludD4uPHN0cj4uPHVpbnQ+Wy08
dWludD5dLjxpbnQgPD0gMD5bLzxpbnQgPD0gMD5dWy4uLl0uPDB8MT4sLi4uCj4gKzx1aW50Pi48
c3RyPi48dWludD5bLTx1aW50Pl18Ki48aW50IDw9IDA+Wy88aW50IDw9IDA+XVsuLi5dLjwwfDE+
LC4uLgo+ICBCLjx1aW50Pgo+ICBNLjx1aW50Pi48c3RyPlt8PHN0cj5dLi4uCj4gIFB8WC48dWlu
dD4uPGludD4KPiAtZHxwfHN8dHxxfGEuPGludD4sLi4uCj4gK2R8cHxzfHR8cXxhfFQuPGludD4s
Li4uCj4gIGIuPHVpbnQ+Ljx1aW50Pi48c3RyPgo+ICBmCj4gIAo+IEBAIC0zMCw2ICszMCw3IEBA
IEFkZGl0aW9uYWwgd29ya2xvYWQgc3RlcHMgYXJlIGFsc28gc3VwcG9ydGVkOgo+ICAgJ2InIC0g
U2V0IHVwIGVuZ2luZSBib25kcy4KPiAgICdNJyAtIFNldCB1cCBlbmdpbmUgbWFwLgo+ICAgJ1An
IC0gQ29udGV4dCBwcmlvcml0eS4KPiArICdUJyAtIFRlcm1pbmF0ZSBhbiBpbmZpbml0ZSBiYXRj
aC4KPiAgICdYJyAtIENvbnRleHQgcHJlZW1wdGlvbiBjb250cm9sLgo+ICAKPiAgRW5naW5lIGlk
czogREVGQVVMVCwgUkNTLCBCQ1MsIFZDUywgVkNTMSwgVkNTMiwgVkVDUwo+IEBAIC03Nyw2ICs3
OCwxMCBAQCBFeGFtcGxlOgo+ICAKPiAgSSB0aGlzIGNhc2UgdGhlIGxhc3Qgc3RlcCBoYXMgYSBk
YXRhIGRlcGVuZGVuY3kgb24gYm90aCBmaXJzdCBhbmQgc2Vjb25kIHN0ZXBzLgo+ICAKPiArQmF0
Y2ggZHVyYXRpb25zIGNhbiBhbHNvIGJlIHNwZWNpZmllZCBhcyBpbmZpbml0ZSBieSB1c2luZyB0
aGUgJyonIGluIHRoZQo+ICtkdXJhdGlvbiBmaWVsZC4gU3VjaCBiYXRjaGVzIG11c3QgYmUgZW5k
ZWQgYnkgdGhlIHRlcm1pbmF0ZSBjb21tYW5kICgnVCcpCj4gK290aGVyd2lzZSB0aGV5IHdpbGwg
Y2F1c2UgYSBHUFUgaGFuZyB0byBiZSByZXBvcnRlZC4KPiArCj4gIFN5bmMgKGZkKSBmZW5jZXMK
PiAgLS0tLS0tLS0tLS0tLS0tLQo+ICAKPiBkaWZmIC0tZ2l0IGEvYmVuY2htYXJrcy93c2ltL2Zy
YW1lLXNwbGl0LTYwZnBzLndzaW0gYi9iZW5jaG1hcmtzL3dzaW0vZnJhbWUtc3BsaXQtNjBmcHMu
d3NpbQo+IGluZGV4IGNmYmZjZDM5YmU3ZC4uZWE4OWRhM2FkZDQ4IDEwMDY0NAo+IC0tLSBhL2Jl
bmNobWFya3Mvd3NpbS9mcmFtZS1zcGxpdC02MGZwcy53c2ltCj4gKysrIGIvYmVuY2htYXJrcy93
c2ltL2ZyYW1lLXNwbGl0LTYwZnBzLndzaW0KPiBAQCAtNiwxMCArNiwxMiBAQCBNLjIuVkNTMgo+
ICBCLjIKPiAgYi4yLjEuVkNTMQo+ICBmCj4gLTEuREVGQVVMVC40MDAwLTYwMDAuZi0xLjAKPiAr
MS5ERUZBVUxULiouZi0xLjAKPiAgMi5ERUZBVUxULjQwMDAtNjAwMC5zLTEuMAo+ICBhLi0zCj4g
LTMuUkNTLjIwMDAtNDAwMC4tMy8tMi4wCj4gK3MuLTIKPiArVC4tNAo+ICszLlJDUy4yMDAwLTQw
MDAuLTUvLTQuMAo+ICAzLlZFQ1MuMjAwMC4tMS4wCj4gIDQuQkNTLjEwMDAuLTEuMAo+ICBzLi0y
CgpVc2VjYXNlIGxvb2tzIHJlYXNvbmFibGUuCgpSZXZpZXdlZC1ieTogQ2hyaXMgV2lsc29uIDxj
aHJpc0BjaHJpcy13aWxzb24uY28udWs+Ci1DaHJpcwpfX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBs
aXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1h
bi9saXN0aW5mby9pbnRlbC1nZng=

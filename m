Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id D1B7CBA349
	for <lists+intel-gfx@lfdr.de>; Sun, 22 Sep 2019 19:06:51 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 29C776E857;
	Sun, 22 Sep 2019 17:06:48 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga07.intel.com (mga07.intel.com [134.134.136.100])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A73D16E855
 for <intel-gfx@lists.freedesktop.org>; Sun, 22 Sep 2019 17:06:46 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga006.fm.intel.com ([10.253.24.20])
 by orsmga105.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 22 Sep 2019 10:06:46 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,537,1559545200"; d="scan'208";a="389235850"
Received: from labuser-z97x-ud5h.jf.intel.com ([10.54.75.49])
 by fmsmga006.fm.intel.com with ESMTP; 22 Sep 2019 10:06:45 -0700
From: Manasi Navare <manasi.d.navare@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Sun, 22 Sep 2019 10:08:05 -0700
Message-Id: <20190922170807.12436-4-manasi.d.navare@intel.com>
X-Mailer: git-send-email 2.19.1
In-Reply-To: <20190922170807.12436-1-manasi.d.navare@intel.com>
References: <20190922170807.12436-1-manasi.d.navare@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v3 4/6] drm/i915/display/icl: Enable
 master-slaves in trans port sync
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Daniel Vetter <daniel.vetter@ffwll.ch>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QXMgcGVyIHRoZSBkaXNwbGF5IGVuYWJsZSBzZXF1ZW5jZSwgd2UgbmVlZCB0byBmb2xsb3cgdGhl
IGVuYWJsZSBzZXF1ZW5jZQpmb3Igc2xhdmVzIGZpcnN0IHdpdGggRFBfVFBfQ1RMIHNldCB0byBJ
ZGxlIGFuZCBjb25maWd1cmUgdGhlIHRyYW5zY29kZXIKcG9ydCBzeW5jIHJlZ2lzdGVyIHRvIHNl
bGVjdCB0aGUgY29yZXJzcG9uZGluZyBtYXN0ZXIsIHRoZW4gZm9sbG93IHRoZQplbmFibGUgc2Vx
dWVuY2UgZm9yIG1hc3RlciBsZWF2aW5nIERQX1RQX0NUTCB0byBpZGxlLgpBdCB0aGlzIHBvaW50
IHRoZSB0cmFuc2NvZGVyIHBvcnQgc3luYyBtb2RlIGlzIGNvbmZpZ3VyZWQgYW5kIGVuYWJsZWQK
YW5kIHRoZSBWYmxhbmtzIG9mIGJvdGggcG9ydHMgYXJlIHN5bmNocm9uaXplZCBzbyB0aGVuIHNl
dCBEUF9UUF9DVEwKZm9yIHRoZSBzbGF2ZSBhbmQgbWFzdGVyIHRvIE5vcm1hbCBhbmQgZG8gcG9z
dCBjcnRjIGVuYWJsZSB1cGRhdGVzLgoKdjY6CiogTW9kZXNldCBpbXBsaWVzIGFjdGl2ZV9jaGFu
Z2VkLCByZW1vdmUgb25lIGNvbmRpdGlvbiAoTWFhcnRlbikKdjU6CiogRml4IGNoZWNrcGF0Y2gg
d2FybmluZyAoTWFuYXNpKQp2NDoKKiBSZXVzZSBza2xfY29tbWl0X21vZGVzZXRfZW5hYmxlcygp
IGhvb2sgKE1hYXJ0ZW4pCiogT2J0YWluIHNsYXZlIGNydGMgYW5kIHN0YXRlcyBmcm9tIG1hc3Rl
ciAoTWFhcnRlbikKdjM6CiogUmViYXNlIG9uIGRybS10aXAgKE1hbmFzaSkKdjI6CiogQ3JlYXRl
IGEgaWNsX3VwZGF0ZV9jcnRjcyBob29rIChNYWFydGVuLCBEYW52ZXQpCiogVGhpcyBzZXF1ZW5j
ZSBvbmx5IGZvciBDUlRDcyBpbiB0cmFucyBwb3J0IHN5bmMgbW9kZSAoTWFhcnRlbikKCkNjOiBE
YW5pZWwgVmV0dGVyIDxkYW5pZWwudmV0dGVyQGZmd2xsLmNoPgpDYzogVmlsbGUgU3lyasOkbMOk
IDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KQ2M6IE1hYXJ0ZW4gTGFua2hvcnN0IDxt
YWFydGVuLmxhbmtob3JzdEBsaW51eC5pbnRlbC5jb20+CkNjOiBNYXR0IFJvcGVyIDxtYXR0aGV3
LmQucm9wZXJAaW50ZWwuY29tPgpTaWduZWQtb2ZmLWJ5OiBNYW5hc2kgTmF2YXJlIDxtYW5hc2ku
ZC5uYXZhcmVAaW50ZWwuY29tPgpSZXZpZXdlZC1ieTogTWFhcnRlbiBMYW5raG9yc3QgPG1hYXJ0
ZW4ubGFua2hvcnN0QGxpbnV4LmludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2RkaS5jICAgICB8ICAgMyArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kaXNwbGF5LmMgfCAxNDEgKysrKysrKysrKysrKysrKysrLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmggfCAgIDIgKwogMyBmaWxlcyBjaGFu
Z2VkLCAxNDIgaW5zZXJ0aW9ucygrKSwgNCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RkaS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9kZGkuYwppbmRleCAzZTYzOTQxMzk5NjQuLjYyZTlmNTYwMmI2YiAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGkuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RkaS5jCkBAIC0zMzQ3LDcgKzMz
NDcsOCBAQCBzdGF0aWMgdm9pZCBoc3dfZGRpX3ByZV9lbmFibGVfZHAoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmVuY29kZXIsCiAJCQkJCSAgICAgIHRydWUpOwogCWludGVsX2RwX3Npbmtfc2V0X2Zl
Y19yZWFkeShpbnRlbF9kcCwgY3J0Y19zdGF0ZSk7CiAJaW50ZWxfZHBfc3RhcnRfbGlua190cmFp
bihpbnRlbF9kcCk7Ci0JaWYgKHBvcnQgIT0gUE9SVF9BIHx8IElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gOSkKKwlpZiAoKHBvcnQgIT0gUE9SVF9BIHx8IElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkg
JiYKKwkgICAgIWlzX3RyYW5zX3BvcnRfc3luY19tb2RlKGRldl9wcml2LCBjcnRjX3N0YXRlKSkK
IAkJaW50ZWxfZHBfc3RvcF9saW5rX3RyYWluKGludGVsX2RwKTsKIAogCWludGVsX2RkaV9lbmFi
bGVfZmVjKGVuY29kZXIsIGNydGNfc3RhdGUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2Rpc3BsYXkuYwppbmRleCA3MTE5ODdlYjRlOWUuLjEwNDI1YTc4OWI1ZSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKQEAgLTEzOTI4
LDYgKzEzOTI4LDMwIEBAIHN0YXRpYyB2b2lkIGludGVsX3VwZGF0ZV9jcnRjKHN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjLAogCWludGVsX2ZpbmlzaF9jcnRjX2NvbW1pdChzdGF0ZSwgY3J0Yyk7CiB9
CiAKK3N0YXRpYyBzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfZ2V0X3NsYXZlX2NydGMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCQkgICAgICAgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQoreworCWlmIChuZXdfY3J0Y19zdGF0ZS0+c3luY19t
b2RlX3NsYXZlc19tYXNrICYKKwkgICAgQklUKFRSQU5TQ09ERVJfQSkpCisJCXJldHVybiBpbnRl
bF9nZXRfY3J0Y19mb3JfcGlwZShkZXZfcHJpdiwKKwkJCQkJICAgICAgIFBJUEVfQSk7CisJZWxz
ZSBpZiAobmV3X2NydGNfc3RhdGUtPnN5bmNfbW9kZV9zbGF2ZXNfbWFzayAmCisJCSBCSVQoVFJB
TlNDT0RFUl9CKSkKKwkJcmV0dXJuIGludGVsX2dldF9jcnRjX2Zvcl9waXBlKGRldl9wcml2LAor
CQkJCQkgICAgICAgUElQRV9CKTsKKwllbHNlIGlmIChuZXdfY3J0Y19zdGF0ZS0+c3luY19tb2Rl
X3NsYXZlc19tYXNrICYKKwkJIEJJVChUUkFOU0NPREVSX0MpKQorCQlyZXR1cm4gaW50ZWxfZ2V0
X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsCisJCQkJCSAgICAgICBQSVBFX0MpOworCWVsc2UgaWYg
KG5ld19jcnRjX3N0YXRlLT5zeW5jX21vZGVfc2xhdmVzX21hc2sgJgorCQkgQklUKFRSQU5TQ09E
RVJfRCkpCisJCXJldHVybiBpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShkZXZfcHJpdiwKKwkJCQkJ
ICAgICAgIFBJUEVfRCk7CisJLyogc2hvdWxkIG5ldmVyIGhhcHBlbiAqLworCVdBUk5fT04oMSk7
CisJcmV0dXJuIE5VTEw7Cit9CisKIHN0YXRpYyB2b2lkIGludGVsX29sZF9jcnRjX3N0YXRlX2Rp
c2FibGVzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAogCQkJCQkgIHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKIAkJCQkJICBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUsCkBAIC0xNDAwNiw2ICsxNDAzMCwxMDQgQEAgc3RhdGlj
IHZvaWQgaW50ZWxfY29tbWl0X21vZGVzZXRfZW5hYmxlcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0
YXRlICpzdGF0ZSkKIAl9CiB9CiAKK3N0YXRpYyB2b2lkIGludGVsX2NydGNfZW5hYmxlX3RyYW5z
X3BvcnRfc3luYyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKKwkJCQkJICAgICAgc3RydWN0IGlu
dGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkJCSAgICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpuZXdfY3J0Y19zdGF0ZSkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KHN0YXRlLT5iYXNlLmRldik7CisKKwl1cGRhdGVfc2NhbmxpbmVfb2Zmc2V0
KG5ld19jcnRjX3N0YXRlKTsKKwlkZXZfcHJpdi0+ZGlzcGxheS5jcnRjX2VuYWJsZShuZXdfY3J0
Y19zdGF0ZSwgc3RhdGUpOworCWludGVsX2NydGNfZW5hYmxlX3BpcGVfY3JjKGNydGMpOworfQor
CitzdGF0aWMgdm9pZCBpbnRlbF9zZXRfZHBfdHBfY3RsX25vcm1hbChzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YywKKwkJCQkgICAgICAgc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCit7
CisJc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGU7CisJc3RydWN0IGRybV9j
b25uZWN0b3IgKmNvbm47CisJc3RydWN0IGludGVsX2RwICppbnRlbF9kcDsKKwlpbnQgaTsKKwor
CWZvcl9lYWNoX25ld19jb25uZWN0b3JfaW5fc3RhdGUoJnN0YXRlLT5iYXNlLCBjb25uLCBjb25u
X3N0YXRlLCBpKSB7CisJCWlmIChjb25uX3N0YXRlLT5jcnRjID09ICZjcnRjLT5iYXNlKQorCQkJ
YnJlYWs7CisJfQorCWludGVsX2RwID0gZW5jX3RvX2ludGVsX2RwKCZpbnRlbF9hdHRhY2hlZF9l
bmNvZGVyKGNvbm4pLT5iYXNlKTsKKwlpbnRlbF9kcF9zdG9wX2xpbmtfdHJhaW4oaW50ZWxfZHAp
OworfQorCitzdGF0aWMgdm9pZCBpbnRlbF9wb3N0X2NydGNfZW5hYmxlX3VwZGF0ZXMoc3RydWN0
IGludGVsX2NydGMgKmNydGMsCisJCQkJCSAgIHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0
YXRlLAorCQkJCQkgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCisJ
CQkJCSAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0ZSkKK3sKKwlzdHJ1
Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKm5ld19wbGFuZV9zdGF0ZSA9CisJCWludGVsX2F0b21pY19n
ZXRfbmV3X3BsYW5lX3N0YXRlKHN0YXRlLAorCQkJCQkJIHRvX2ludGVsX3BsYW5lKGNydGMtPmJh
c2UucHJpbWFyeSkpOworCisJaWYgKG5ld19jcnRjX3N0YXRlLT51cGRhdGVfcGlwZSAmJiAhbmV3
X2NydGNfc3RhdGUtPmVuYWJsZV9mYmMpCisJCWludGVsX2ZiY19kaXNhYmxlKGNydGMpOworCWVs
c2UgaWYgKG5ld19wbGFuZV9zdGF0ZSkKKwkJaW50ZWxfZmJjX2VuYWJsZShjcnRjLCBuZXdfY3J0
Y19zdGF0ZSwgbmV3X3BsYW5lX3N0YXRlKTsKKworCWludGVsX2JlZ2luX2NydGNfY29tbWl0KHN0
YXRlLCBjcnRjKTsKKwlza2xfdXBkYXRlX3BsYW5lc19vbl9jcnRjKHN0YXRlLCBjcnRjKTsKKwlp
bnRlbF9maW5pc2hfY3J0Y19jb21taXQoc3RhdGUsIGNydGMpOworfQorCitzdGF0aWMgdm9pZCBp
bnRlbF91cGRhdGVfdHJhbnNfcG9ydF9zeW5jX2NydGNzKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
LAorCQkJCQkgICAgICAgc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkJCSAg
ICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCisJCQkJCSAgICAg
ICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUpCit7CisJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShzdGF0ZS0+YmFzZS5kZXYpOworCXN0
cnVjdCBpbnRlbF9jcnRjICpzbGF2ZV9jcnRjID0gaW50ZWxfZ2V0X3NsYXZlX2NydGMoZGV2X3By
aXYsCisJCQkJCQkJICAgICBuZXdfY3J0Y19zdGF0ZSk7CisJc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKm5ld19zbGF2ZV9jcnRjX3N0YXRlID0KKwkJaW50ZWxfYXRvbWljX2dldF9uZXdfY3J0Y19z
dGF0ZShzdGF0ZSwgc2xhdmVfY3J0Yyk7CisJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9z
bGF2ZV9jcnRjX3N0YXRlID0KKwkJaW50ZWxfYXRvbWljX2dldF9vbGRfY3J0Y19zdGF0ZShzdGF0
ZSwgc2xhdmVfY3J0Yyk7CisKKwlXQVJOX09OKCFzbGF2ZV9jcnRjIHx8ICFuZXdfc2xhdmVfY3J0
Y19zdGF0ZSB8fAorCQkhb2xkX3NsYXZlX2NydGNfc3RhdGUpOworCisJRFJNX0RFQlVHX0tNUygi
VXBkYXRpbmcgVHJhbnNjb2RlciBQb3J0IFN5bmMgTWFzdGVyIENSVEMgPSAlZCAlcyBhbmQgU2xh
dmUgQ1JUQyAlZCAlc1xuIiwKKwkJICAgICAgY3J0Yy0+YmFzZS5iYXNlLmlkLCBjcnRjLT5iYXNl
Lm5hbWUsIHNsYXZlX2NydGMtPmJhc2UuYmFzZS5pZCwKKwkJICAgICAgc2xhdmVfY3J0Yy0+YmFz
ZS5uYW1lKTsKKworCS8qIEVuYWJsZSBzZXEgZm9yIHNsYXZlIHdpdGggd2l0aCBEUF9UUF9DVEwg
bGVmdCBJZGxlIHVudGlsIHRoZQorCSAqIG1hc3RlciBpcyByZWFkeQorCSAqLworCWludGVsX2Ny
dGNfZW5hYmxlX3RyYW5zX3BvcnRfc3luYyhzbGF2ZV9jcnRjLAorCQkJCQkgIHN0YXRlLAorCQkJ
CQkgIG5ld19zbGF2ZV9jcnRjX3N0YXRlKTsKKworCS8qIEVuYWJsZSBzZXEgZm9yIG1hc3RlciB3
aXRoIHdpdGggRFBfVFBfQ1RMIGxlZnQgSWRsZSAqLworCWludGVsX2NydGNfZW5hYmxlX3RyYW5z
X3BvcnRfc3luYyhjcnRjLAorCQkJCQkgIHN0YXRlLAorCQkJCQkgIG5ld19jcnRjX3N0YXRlKTsK
KworCS8qIFNldCBTbGF2ZSdzIERQX1RQX0NUTCB0byBOb3JtYWwgKi8KKwlpbnRlbF9zZXRfZHBf
dHBfY3RsX25vcm1hbChzbGF2ZV9jcnRjLAorCQkJCSAgIHN0YXRlKTsKKworCS8qIFNldCBNYXN0
ZXIncyBEUF9UUF9DVEwgVG8gTm9ybWFsICovCisJdXNsZWVwX3JhbmdlKDIwMCwgNDAwKTsKKwlp
bnRlbF9zZXRfZHBfdHBfY3RsX25vcm1hbChjcnRjLAorCQkJCSAgIHN0YXRlKTsKKworCS8qIE5v
dyBkbyB0aGUgcG9zdCBjcnRjIGVuYWJsZSBmb3IgYWxsIG1hc3RlciBhbmQgc2xhdmVzICovCisJ
aW50ZWxfcG9zdF9jcnRjX2VuYWJsZV91cGRhdGVzKHNsYXZlX2NydGMsCisJCQkJICAgICAgIHN0
YXRlLAorCQkJCSAgICAgICBuZXdfc2xhdmVfY3J0Y19zdGF0ZSwKKwkJCQkgICAgICAgb2xkX3Ns
YXZlX2NydGNfc3RhdGUpOworCWludGVsX3Bvc3RfY3J0Y19lbmFibGVfdXBkYXRlcyhjcnRjLAor
CQkJCSAgICAgICBzdGF0ZSwKKwkJCQkgICAgICAgbmV3X2NydGNfc3RhdGUsCisJCQkJICAgICAg
IG9sZF9jcnRjX3N0YXRlKTsKK30KKwogc3RhdGljIHZvaWQgc2tsX2NvbW1pdF9tb2Rlc2V0X2Vu
YWJsZXMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCiB7CiAJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShzdGF0ZS0+YmFzZS5kZXYpOwpAQCAtMTQw
NDAsNiArMTQxNjIsNyBAQCBzdGF0aWMgdm9pZCBza2xfY29tbWl0X21vZGVzZXRfZW5hYmxlcyhz
dHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKIAkJZm9yX2VhY2hfb2xkbmV3X2ludGVs
X2NydGNfaW5fc3RhdGUoc3RhdGUsIGNydGMsIG9sZF9jcnRjX3N0YXRlLCBuZXdfY3J0Y19zdGF0
ZSwgaSkgewogCQkJYm9vbCB2Ymxfd2FpdCA9IGZhbHNlOwogCQkJdW5zaWduZWQgaW50IGNtYXNr
ID0gZHJtX2NydGNfbWFzaygmY3J0Yy0+YmFzZSk7CisJCQlib29sIG1vZGVzZXQgPSBuZWVkc19t
b2Rlc2V0KG5ld19jcnRjX3N0YXRlKTsKIAogCQkJcGlwZSA9IGNydGMtPnBpcGU7CiAKQEAgLTE0
MDYyLDEyICsxNDE4NSwyNCBAQCBzdGF0aWMgdm9pZCBza2xfY29tbWl0X21vZGVzZXRfZW5hYmxl
cyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKIAkJCSAqLwogCQkJaWYgKCFza2xf
ZGRiX2VudHJ5X2VxdWFsKCZuZXdfY3J0Y19zdGF0ZS0+d20uc2tsLmRkYiwKIAkJCQkJCSAmb2xk
X2NydGNfc3RhdGUtPndtLnNrbC5kZGIpICYmCi0JCQkgICAgIW5ld19jcnRjX3N0YXRlLT5iYXNl
LmFjdGl2ZV9jaGFuZ2VkICYmCisJCQkgICAgIW1vZGVzZXQgJiYKIAkJCSAgICBzdGF0ZS0+d21f
cmVzdWx0cy5kaXJ0eV9waXBlcyAhPSB1cGRhdGVkKQogCQkJCXZibF93YWl0ID0gdHJ1ZTsKIAot
CQkJaW50ZWxfdXBkYXRlX2NydGMoY3J0Yywgc3RhdGUsIG9sZF9jcnRjX3N0YXRlLAotCQkJCQkg
IG5ld19jcnRjX3N0YXRlKTsKKwkJCWlmIChtb2Rlc2V0ICYmIGlzX3RyYW5zX3BvcnRfc3luY19t
b2RlKGRldl9wcml2LAorCQkJCQkJCSAgICAgICBuZXdfY3J0Y19zdGF0ZSkpIHsKKwkJCQlpZiAo
aXNfdHJhbnNfcG9ydF9zeW5jX21hc3RlcihkZXZfcHJpdiwKKwkJCQkJCQkgICAgICBuZXdfY3J0
Y19zdGF0ZSkpCisJCQkJCWludGVsX3VwZGF0ZV90cmFuc19wb3J0X3N5bmNfY3J0Y3MoY3J0YywK
KwkJCQkJCQkJCSAgIHN0YXRlLAorCQkJCQkJCQkJICAgb2xkX2NydGNfc3RhdGUsCisJCQkJCQkJ
CQkgICBuZXdfY3J0Y19zdGF0ZSk7CisJCQkJZWxzZQorCQkJCQljb250aW51ZTsKKwkJCX0gZWxz
ZSB7CisJCQkJaW50ZWxfdXBkYXRlX2NydGMoY3J0Yywgc3RhdGUsIG9sZF9jcnRjX3N0YXRlLAor
CQkJCQkJICBuZXdfY3J0Y19zdGF0ZSk7CisJCQl9CiAKIAkJCWlmICh2Ymxfd2FpdCkKIAkJCQlp
bnRlbF93YWl0X2Zvcl92YmxhbmsoZGV2X3ByaXYsIHBpcGUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmggYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuaAppbmRleCAxNjIzZmFjZTQzNmIuLmVmYTRkNjI1
MTRjZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNw
bGF5LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmgK
QEAgLTI3LDYgKzI3LDcgQEAKIAogI2luY2x1ZGUgPGRybS9kcm1fdXRpbC5oPgogI2luY2x1ZGUg
PGRybS9pOTE1X2RybS5oPgorI2luY2x1ZGUgImludGVsX2RwX2xpbmtfdHJhaW5pbmcuaCIKIAog
ZW51bSBsaW5rX21fbl9zZXQ7CiBzdHJ1Y3QgZHBsbDsKQEAgLTU0LDYgKzU1LDcgQEAgc3RydWN0
IGludGVsX3BsYW5lOwogc3RydWN0IGludGVsX3BsYW5lX3N0YXRlOwogc3RydWN0IGludGVsX3Jl
bWFwcGVkX2luZm87CiBzdHJ1Y3QgaW50ZWxfcm90YXRpb25faW5mbzsKK3N0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlOwogCiBlbnVtIGk5MTVfZ3BpbyB7CiAJR1BJT0EsCi0tIAoyLjE5LjEKCl9fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWls
aW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZy
ZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

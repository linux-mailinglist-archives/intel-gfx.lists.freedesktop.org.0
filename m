Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id C1458F6AFB
	for <lists+intel-gfx@lfdr.de>; Sun, 10 Nov 2019 19:58:45 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C3BFF6E7AB;
	Sun, 10 Nov 2019 18:58:34 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id D868A6E7AC
 for <intel-gfx@lists.freedesktop.org>; Sun, 10 Nov 2019 18:58:28 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19151900-1500050 
 for multiple; Sun, 10 Nov 2019 18:58:13 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Sun, 10 Nov 2019 18:58:01 +0000
Message-Id: <20191110185806.17413-20-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191110185806.17413-1-chris@chris-wilson.co.uk>
References: <20191110185806.17413-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 20/25] drm/i915: Drop GEM context as a direct
 link from i915_request
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

S2VlcCB0aGUgaW50ZWxfY29udGV4dCBhcyBiZWluZyB0aGUgcHJpbWFyeSBzdGF0ZSBmb3IgaTkx
NV9yZXF1ZXN0LCB3aXRoCnRoZSBHRU0gY29udGV4dCBhIGJhY2twb2ludGVyIGZyb20gdGhlIGxv
dyBsZXZlbCBzdGF0ZSBmb3IgdGhlIHJhcmVyCmNhc2VzIHdlIG5lZWQgY2xpZW50IGluZm9ybWF0
aW9uLiBPdXIgZ29hbCBpcyB0byByZW1vdmUgc3VjaCByZWZlcmVuY2VzCnRvIGNsaWVudHMgZnJv
bSB0aGUgYmFja2VuZCwgYW5kIGxlYXZlIHRoZSBIVyBzdWJtaXNzaW9uIGFnbm9zdGljIHRvCmNs
aWVudCBpbnRlcmZhY2VzIGFuZCBzZWxmLWNvbnRhaW5lZC4KClNpZ25lZC1vZmYtYnk6IENocmlz
IFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMgICB8IDE1ICsrLS0tLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaCAgIHwgMzggLS0tLS0tLS0tLS0tLS0tCiAuLi4v
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0X3R5cGVzLmggfCAgNyArLS0KIC4uLi9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYyAgICB8ICA4ICsrLS0KIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2JyZWFkY3J1bWJzLmMgICB8ICA0ICstCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMgICAgICAgfCAgMiArLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5oICAgICAgIHwgNDIgKysrKysrKysrKysrKysr
KysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHRfdHlwZXMuaCB8ICA1ICst
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYyAgICAgfCAgNiArLS0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jICAgICAgICAgICB8IDQ3ICsrKysr
KysrKy0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMgICAg
ICAgICB8IDQwICsrKysrKysrKy0tLS0tLS0KIC4uLi9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmlu
Z19zdWJtaXNzaW9uLmMgICB8IDEwICsrLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0
ZXN0X2xyYy5jICAgICAgICB8IDIwICsrKystLS0tCiAuLi4vZ3B1L2RybS9pOTE1L2d0L3VjL2lu
dGVsX2d1Y19zdWJtaXNzaW9uLmMgfCAgNiArLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9z
Y2hlZHVsZXIuYyAgICAgICAgICB8IDI3ICsrKysrLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2dlbS5jICAgICAgICAgICAgICAgfCAgNiArLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZ3B1X2Vycm9yLmMgICAgICAgICB8IDExICsrKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3BlcmYuYyAgICAgICAgICAgICAgfCAgNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9yZXF1ZXN0LmMgICAgICAgICAgIHwgMTggKysrLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9yZXF1ZXN0LmggICAgICAgICAgIHwgIDMgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfc2NoZWR1bGVyLmMgICAgICAgICB8ICAyICstCiAyMSBmaWxlcyBjaGFuZ2VkLCAxNjIg
aW5zZXJ0aW9ucygrKSwgMTU5IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fY29udGV4dC5jCmluZGV4IDkwN2MyZWMzMGI5OC4uOWY3NTZkZGVhNzkwIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKQEAgLTY5LDYg
KzY5LDcgQEAKIAogI2luY2x1ZGUgPGRybS9pOTE1X2RybS5oPgogCisjaW5jbHVkZSAiZ3QvaW50
ZWxfY29udGV4dC5oIgogI2luY2x1ZGUgImd0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQuaCIKICNp
bmNsdWRlICJndC9pbnRlbF9lbmdpbmVfdXNlci5oIgogI2luY2x1ZGUgImd0L2ludGVsX2xyY19y
ZWcuaCIKQEAgLTQyMiwxNSArNDIzLDYgQEAgc3RhdGljIHZvaWQga2lsbF9jb250ZXh0KHN0cnVj
dCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCiAJc3RydWN0IGk5MTVfZ2VtX2VuZ2luZXNfaXRlciBp
dDsKIAlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7CiAKLQkvKgotCSAqIElmIHdlIGFyZSBhbHJl
YWR5IGJhbm5lZCwgaXQgd2FzIGR1ZSB0byBhIGd1aWx0eSByZXF1ZXN0IGNhdXNpbmcKLQkgKiBh
IHJlc2V0IGFuZCB0aGUgZW50aXJlIGNvbnRleHQgYmVpbmcgZXZpY3RlZCBmcm9tIHRoZSBHUFUu
Ci0JICovCi0JaWYgKGk5MTVfZ2VtX2NvbnRleHRfaXNfYmFubmVkKGN0eCkpCi0JCXJldHVybjsK
LQotCWk5MTVfZ2VtX2NvbnRleHRfc2V0X2Jhbm5lZChjdHgpOwotCiAJLyoKIAkgKiBNYXAgdGhl
IHVzZXIncyBlbmdpbmUgYmFjayB0byB0aGUgYWN0dWFsIGVuZ2luZXM7IG9uZSB2aXJ0dWFsCiAJ
ICogZW5naW5lIHdpbGwgYmUgbWFwcGVkIHRvIG11bHRpcGxlIGVuZ2luZXMsIGFuZCB1c2luZyBj
dHgtPmVuZ2luZVtdCkBAIC00NDEsNiArNDMzLDkgQEAgc3RhdGljIHZvaWQga2lsbF9jb250ZXh0
KHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCiAJZm9yX2VhY2hfZ2VtX2VuZ2luZShjZSwg
X19jb250ZXh0X2VuZ2luZXNfc3RhdGljKGN0eCksIGl0KSB7CiAJCXN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZTsKIAorCQlpZiAoaW50ZWxfY29udGV4dF9zZXRfYmFubmVkKGNlKSkKKwkJ
CWNvbnRpbnVlOworCiAJCS8qCiAJCSAqIENoZWNrIHRoZSBjdXJyZW50IGFjdGl2ZSBzdGF0ZSBv
ZiB0aGlzIGNvbnRleHQ7IGlmIHdlCiAJCSAqIGFyZSBjdXJyZW50bHkgZXhlY3V0aW5nIG9uIHRo
ZSBHUFUgd2UgbmVlZCB0byBldmljdApAQCAtMTA5MSw3ICsxMDg2LDcgQEAgc3RhdGljIHZvaWQg
c2V0X3BwZ3R0X2JhcnJpZXIodm9pZCAqZGF0YSkKIAogc3RhdGljIGludCBlbWl0X3BwZ3R0X3Vw
ZGF0ZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgdm9pZCAqZGF0YSkKIHsKLQlzdHJ1Y3QgaTkx
NV9hZGRyZXNzX3NwYWNlICp2bSA9IHJxLT5od19jb250ZXh0LT52bTsKKwlzdHJ1Y3QgaTkxNV9h
ZGRyZXNzX3NwYWNlICp2bSA9IHJxLT5jb250ZXh0LT52bTsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUgPSBycS0+ZW5naW5lOwogCXUzMiBiYXNlID0gZW5naW5lLT5tbWlvX2Jhc2U7
CiAJdTMyICpjczsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9jb250ZXh0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5o
CmluZGV4IDE4ZTUwYTc2OWE2ZS4uNjk5MzI4OTk4MDNlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmgKQEAgLTkxLDI2ICs5MSw2IEBAIHN0YXRpYyBpbmxp
bmUgdm9pZCBpOTE1X2dlbV9jb250ZXh0X2NsZWFyX3BlcnNpc3RlbmNlKHN0cnVjdCBpOTE1X2dl
bV9jb250ZXh0ICpjCiAJY2xlYXJfYml0KFVDT05URVhUX1BFUlNJU1RFTkNFLCAmY3R4LT51c2Vy
X2ZsYWdzKTsKIH0KIAotc3RhdGljIGlubGluZSBib29sIGk5MTVfZ2VtX2NvbnRleHRfaXNfYmFu
bmVkKGNvbnN0IHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCi17Ci0JcmV0dXJuIHRlc3Rf
Yml0KENPTlRFWFRfQkFOTkVELCAmY3R4LT5mbGFncyk7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgdm9p
ZCBpOTE1X2dlbV9jb250ZXh0X3NldF9iYW5uZWQoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0
eCkKLXsKLQlzZXRfYml0KENPTlRFWFRfQkFOTkVELCAmY3R4LT5mbGFncyk7Ci19Ci0KLXN0YXRp
YyBpbmxpbmUgYm9vbCBpOTE1X2dlbV9jb250ZXh0X2ZvcmNlX3NpbmdsZV9zdWJtaXNzaW9uKGNv
bnN0IHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCi17Ci0JcmV0dXJuIHRlc3RfYml0KENP
TlRFWFRfRk9SQ0VfU0lOR0xFX1NVQk1JU1NJT04sICZjdHgtPmZsYWdzKTsKLX0KLQotc3RhdGlj
IGlubGluZSB2b2lkIGk5MTVfZ2VtX2NvbnRleHRfc2V0X2ZvcmNlX3NpbmdsZV9zdWJtaXNzaW9u
KHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCi17Ci0JX19zZXRfYml0KENPTlRFWFRfRk9S
Q0VfU0lOR0xFX1NVQk1JU1NJT04sICZjdHgtPmZsYWdzKTsKLX0KLQogc3RhdGljIGlubGluZSBi
b29sCiBpOTE1X2dlbV9jb250ZXh0X3VzZXJfZW5naW5lcyhjb25zdCBzdHJ1Y3QgaTkxNV9nZW1f
Y29udGV4dCAqY3R4KQogewpAQCAtMTI5LDI0ICsxMDksNiBAQCBpOTE1X2dlbV9jb250ZXh0X2Ns
ZWFyX3VzZXJfZW5naW5lcyhzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQogCWNsZWFyX2Jp
dChDT05URVhUX1VTRVJfRU5HSU5FUywgJmN0eC0+ZmxhZ3MpOwogfQogCi1zdGF0aWMgaW5saW5l
IGJvb2wKLWk5MTVfZ2VtX2NvbnRleHRfbm9wcmVlbXB0KGNvbnN0IHN0cnVjdCBpOTE1X2dlbV9j
b250ZXh0ICpjdHgpCi17Ci0JcmV0dXJuIHRlc3RfYml0KENPTlRFWFRfTk9QUkVFTVBULCAmY3R4
LT5mbGFncyk7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgdm9pZAotaTkxNV9nZW1fY29udGV4dF9zZXRf
bm9wcmVlbXB0KHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCi17Ci0Jc2V0X2JpdChDT05U
RVhUX05PUFJFRU1QVCwgJmN0eC0+ZmxhZ3MpOwotfQotCi1zdGF0aWMgaW5saW5lIHZvaWQKLWk5
MTVfZ2VtX2NvbnRleHRfY2xlYXJfbm9wcmVlbXB0KHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpj
dHgpCi17Ci0JY2xlYXJfYml0KENPTlRFWFRfTk9QUkVFTVBULCAmY3R4LT5mbGFncyk7Ci19Ci0K
IHN0YXRpYyBpbmxpbmUgYm9vbCBpOTE1X2dlbV9jb250ZXh0X2lzX2tlcm5lbChzdHJ1Y3QgaTkx
NV9nZW1fY29udGV4dCAqY3R4KQogewogCXJldHVybiAhY3R4LT5maWxlX3ByaXY7CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dF90eXBlcy5oIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaAppbmRleCA2
OWRmNTQ1OWMzNTAuLjAxN2NhODAzYWI0NyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fY29udGV4dF90eXBlcy5oCkBAIC0xMzQsMTEgKzEzNCw4IEBAIHN0cnVj
dCBpOTE1X2dlbV9jb250ZXh0IHsKIAkgKiBAZmxhZ3M6IHNtYWxsIHNldCBvZiBib29sZWFucwog
CSAqLwogCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Ci0jZGVmaW5lIENPTlRFWFRfQkFOTkVECQkJMAot
I2RlZmluZSBDT05URVhUX0NMT1NFRAkJCTEKLSNkZWZpbmUgQ09OVEVYVF9GT1JDRV9TSU5HTEVf
U1VCTUlTU0lPTgkyCi0jZGVmaW5lIENPTlRFWFRfVVNFUl9FTkdJTkVTCQkzCi0jZGVmaW5lIENP
TlRFWFRfTk9QUkVFTVBUCQk0CisjZGVmaW5lIENPTlRFWFRfQ0xPU0VECQkJMAorI2RlZmluZSBD
T05URVhUX1VTRVJfRU5HSU5FUwkJMQogCiAJc3RydWN0IG11dGV4IG11dGV4OwogCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYwppbmRleCA1ZGJmZWRl
YjBhNmYuLmRmZjVjMDE4MGJmMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX2V4ZWNidWZmZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fZXhlY2J1ZmZlci5jCkBAIC03NDUsOSArNzQ1LDYgQEAgc3RhdGljIGludCBlYl9sb29r
dXBfdm1hcyhzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYikKIAl1bnNpZ25lZCBpbnQgaSwgYmF0
Y2g7CiAJaW50IGVycjsKIAotCWlmICh1bmxpa2VseShpOTE1X2dlbV9jb250ZXh0X2lzX2Jhbm5l
ZChlYi0+Z2VtX2NvbnRleHQpKSkKLQkJcmV0dXJuIC1FSU87Ci0KIAlJTklUX0xJU1RfSEVBRCgm
ZWItPnJlbG9jcyk7CiAJSU5JVF9MSVNUX0hFQUQoJmViLT51bmJvdW5kKTsKIApAQCAtMjA1MCw3
ICsyMDQ3LDcgQEAgc3RhdGljIGludCBlYl9zdWJtaXQoc3RydWN0IGk5MTVfZXhlY2J1ZmZlciAq
ZWIpCiAJaWYgKGVycikKIAkJcmV0dXJuIGVycjsKIAotCWlmIChpOTE1X2dlbV9jb250ZXh0X25v
cHJlZW1wdChlYi0+Z2VtX2NvbnRleHQpKQorCWlmIChpbnRlbF9jb250ZXh0X25vcHJlZW1wdChl
Yi0+Y29udGV4dCkpCiAJCWViLT5yZXF1ZXN0LT5mbGFncyB8PSBJOTE1X1JFUVVFU1RfTk9QUkVF
TVBUOwogCiAJcmV0dXJuIDA7CkBAIC0yMTM2LDYgKzIxMzMsOSBAQCBzdGF0aWMgaW50IF9fZWJf
cGluX2VuZ2luZShzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYiwgc3RydWN0IGludGVsX2NvbnRl
eHQgKmNlKQogCWlmIChlcnIpCiAJCXJldHVybiBlcnI7CiAKKwlpZiAodW5saWtlbHkoaW50ZWxf
Y29udGV4dF9pc19iYW5uZWQoY2UpKSkKKwkJcmV0dXJuIC1FSU87CisKIAkvKgogCSAqIFBpbm5p
bmcgdGhlIGNvbnRleHRzIG1heSBnZW5lcmF0ZSByZXF1ZXN0cyBpbiBvcmRlciB0byBhY3F1aXJl
CiAJICogR0dUVCBzcGFjZSwgc28gZG8gdGhpcyBmaXJzdCBiZWZvcmUgd2UgcmVzZXJ2ZSBhIHNl
cW5vIGZvcgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfYnJlYWRj
cnVtYnMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2JyZWFkY3J1bWJzLmMKaW5k
ZXggNTUzMTcwODFkNDhiLi4yZjExYmVlNjM4ZDAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2JyZWFkY3J1bWJzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfYnJlYWRjcnVtYnMuYwpAQCAtMjcxLDcgKzI3MSw3IEBAIGJvb2wgaTkxNV9yZXF1
ZXN0X2VuYWJsZV9icmVhZGNydW1iKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogCiAJaWYgKHRl
c3RfYml0KEk5MTVfRkVOQ0VfRkxBR19BQ1RJVkUsICZycS0+ZmVuY2UuZmxhZ3MpKSB7CiAJCXN0
cnVjdCBpbnRlbF9icmVhZGNydW1icyAqYiA9ICZycS0+ZW5naW5lLT5icmVhZGNydW1iczsKLQkJ
c3RydWN0IGludGVsX2NvbnRleHQgKmNlID0gcnEtPmh3X2NvbnRleHQ7CisJCXN0cnVjdCBpbnRl
bF9jb250ZXh0ICpjZSA9IHJxLT5jb250ZXh0OwogCQlzdHJ1Y3QgbGlzdF9oZWFkICpwb3M7CiAK
IAkJc3Bpbl9sb2NrKCZiLT5pcnFfbG9jayk7CkBAIC0zMjYsNyArMzI2LDcgQEAgdm9pZCBpOTE1
X3JlcXVlc3RfY2FuY2VsX2JyZWFkY3J1bWIoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJICov
CiAJc3Bpbl9sb2NrKCZiLT5pcnFfbG9jayk7CiAJaWYgKHRlc3RfYml0KEk5MTVfRkVOQ0VfRkxB
R19TSUdOQUwsICZycS0+ZmVuY2UuZmxhZ3MpKSB7Ci0JCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpj
ZSA9IHJxLT5od19jb250ZXh0OworCQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UgPSBycS0+Y29u
dGV4dDsKIAogCQlsaXN0X2RlbCgmcnEtPnNpZ25hbF9saW5rKTsKIAkJaWYgKGxpc3RfZW1wdHko
JmNlLT5zaWduYWxzKSkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYwppbmRl
eCBlZTlkMmJjZDJjMTMuLjYyNWY3NWY3ODI1ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfY29udGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2NvbnRleHQuYwpAQCAtMzA3LDcgKzMwNyw3IEBAIGludCBpbnRlbF9jb250ZXh0X3ByZXBh
cmVfcmVtb3RlX3JlcXVlc3Qoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAogCWludCBlcnI7CiAK
IAkvKiBPbmx5IHN1aXRhYmxlIGZvciB1c2UgaW4gcmVtb3RlbHkgbW9kaWZ5aW5nIHRoaXMgY29u
dGV4dCAqLwotCUdFTV9CVUdfT04ocnEtPmh3X2NvbnRleHQgPT0gY2UpOworCUdFTV9CVUdfT04o
cnEtPmNvbnRleHQgPT0gY2UpOwogCiAJaWYgKHJjdV9hY2Nlc3NfcG9pbnRlcihycS0+dGltZWxp
bmUpICE9IHRsKSB7IC8qIHRpbWVsaW5lIHNoYXJpbmchICovCiAJCWVyciA9IG11dGV4X2xvY2tf
aW50ZXJydXB0aWJsZV9uZXN0ZWQoJnRsLT5tdXRleCwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2NvbnRleHQuaAppbmRleCA2OGIzZDMxN2Q5NTkuLjFlNjA3MzQzZDI1NiAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5oCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuaApAQCAtNyw3ICs3LDkgQEAKICNpZm5kZWYg
X19JTlRFTF9DT05URVhUX0hfXwogI2RlZmluZSBfX0lOVEVMX0NPTlRFWFRfSF9fCiAKKyNpbmNs
dWRlIDxsaW51eC9iaXRvcHMuaD4KICNpbmNsdWRlIDxsaW51eC9sb2NrZGVwLmg+CisjaW5jbHVk
ZSA8bGludXgvdHlwZXMuaD4KIAogI2luY2x1ZGUgImk5MTVfYWN0aXZlLmgiCiAjaW5jbHVkZSAi
aW50ZWxfY29udGV4dF90eXBlcy5oIgpAQCAtMTUzLDQgKzE1NSw0NCBAQCBzdGF0aWMgaW5saW5l
IHN0cnVjdCBpbnRlbF9yaW5nICpfX2ludGVsX2NvbnRleHRfcmluZ19zaXplKHU2NCBzeikKIAly
ZXR1cm4gdTY0X3RvX3B0cihzdHJ1Y3QgaW50ZWxfcmluZywgc3opOwogfQogCitzdGF0aWMgaW5s
aW5lIGJvb2wgaW50ZWxfY29udGV4dF9pc19iYW5uZWQoY29uc3Qgc3RydWN0IGludGVsX2NvbnRl
eHQgKmNlKQoreworCXJldHVybiB0ZXN0X2JpdChDT05URVhUX0JBTk5FRCwgJmNlLT5mbGFncyk7
Cit9CisKK3N0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF9jb250ZXh0X3NldF9iYW5uZWQoc3RydWN0
IGludGVsX2NvbnRleHQgKmNlKQoreworCXJldHVybiB0ZXN0X2FuZF9zZXRfYml0KENPTlRFWFRf
QkFOTkVELCAmY2UtPmZsYWdzKTsKK30KKworc3RhdGljIGlubGluZSBib29sCitpbnRlbF9jb250
ZXh0X2ZvcmNlX3NpbmdsZV9zdWJtaXNzaW9uKGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpj
ZSkKK3sKKwlyZXR1cm4gdGVzdF9iaXQoQ09OVEVYVF9GT1JDRV9TSU5HTEVfU1VCTUlTU0lPTiwg
JmNlLT5mbGFncyk7Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZAoraW50ZWxfY29udGV4dF9zZXRf
c2luZ2xlX3N1Ym1pc3Npb24oc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQoreworCV9fc2V0X2Jp
dChDT05URVhUX0ZPUkNFX1NJTkdMRV9TVUJNSVNTSU9OLCAmY2UtPmZsYWdzKTsKK30KKworc3Rh
dGljIGlubGluZSBib29sCitpbnRlbF9jb250ZXh0X25vcHJlZW1wdChjb25zdCBzdHJ1Y3QgaW50
ZWxfY29udGV4dCAqY2UpCit7CisJcmV0dXJuIHRlc3RfYml0KENPTlRFWFRfTk9QUkVFTVBULCAm
Y2UtPmZsYWdzKTsKK30KKworc3RhdGljIGlubGluZSB2b2lkCitpbnRlbF9jb250ZXh0X3NldF9u
b3ByZWVtcHQoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQoreworCXNldF9iaXQoQ09OVEVYVF9O
T1BSRUVNUFQsICZjZS0+ZmxhZ3MpOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQKK2ludGVsX2Nv
bnRleHRfY2xlYXJfbm9wcmVlbXB0KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKK3sKKwljbGVh
cl9iaXQoQ09OVEVYVF9OT1BSRUVNUFQsICZjZS0+ZmxhZ3MpOworfQorCiAjZW5kaWYgLyogX19J
TlRFTF9DT05URVhUX0hfXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfY29udGV4dF90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29u
dGV4dF90eXBlcy5oCmluZGV4IDY5NTliMDVhZTVmOC4uMDI1MWVkYzhmNTY4IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0X3R5cGVzLmgKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dF90eXBlcy5oCkBAIC01NCw3ICs1NCwx
MCBAQCBzdHJ1Y3QgaW50ZWxfY29udGV4dCB7CiAJc3RydWN0IGludGVsX3RpbWVsaW5lICp0aW1l
bGluZTsKIAogCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Ci0jZGVmaW5lIENPTlRFWFRfQUxMT0NfQklU
IDAKKyNkZWZpbmUgQ09OVEVYVF9BTExPQ19CSVQJCTAKKyNkZWZpbmUgQ09OVEVYVF9CQU5ORUQJ
CQkxCisjZGVmaW5lIENPTlRFWFRfRk9SQ0VfU0lOR0xFX1NVQk1JU1NJT04JMgorI2RlZmluZSBD
T05URVhUX05PUFJFRU1QVAkJMwogCiAJdTMyICpscmNfcmVnX3N0YXRlOwogCXU2NCBscmNfZGVz
YzsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKaW5kZXggYjk2MTNk
MDQ0MzkzLi43Zjc5NzQxYWQ2ODQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2VuZ2luZV9jcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2Vu
Z2luZV9jcy5jCkBAIC0xNTE2LDkgKzE1MTYsOSBAQCB2b2lkIGludGVsX2VuZ2luZV9kdW1wKHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAogCQlwcmludF9yZXF1ZXN0X3JpbmcobSwg
cnEpOwogCi0JCWlmIChycS0+aHdfY29udGV4dC0+bHJjX3JlZ19zdGF0ZSkgeworCQlpZiAocnEt
PmNvbnRleHQtPmxyY19yZWdfc3RhdGUpIHsKIAkJCWRybV9wcmludGYobSwgIkxvZ2ljYWwgUmlu
ZyBDb250ZXh0OlxuIik7Ci0JCQloZXhkdW1wKG0sIHJxLT5od19jb250ZXh0LT5scmNfcmVnX3N0
YXRlLCBQQUdFX1NJWkUpOworCQkJaGV4ZHVtcChtLCBycS0+Y29udGV4dC0+bHJjX3JlZ19zdGF0
ZSwgUEFHRV9TSVpFKTsKIAkJfQogCX0KIAlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZlbmdpbmUt
PmFjdGl2ZS5sb2NrLCBmbGFncyk7CkBAIC0xNTc5LDcgKzE1NzksNyBAQCBpbnQgaW50ZWxfZW5h
YmxlX2VuZ2luZV9zdGF0cyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAKIAkJZm9y
IChwb3J0ID0gZXhlY2xpc3RzLT5wZW5kaW5nOyAocnEgPSAqcG9ydCk7IHBvcnQrKykgewogCQkJ
LyogRXhjbHVkZSBhbnkgY29udGV4dHMgYWxyZWFkeSBjb3VudGVkIGluIGFjdGl2ZSAqLwotCQkJ
aWYgKCFpbnRlbF9jb250ZXh0X2luZmxpZ2h0X2NvdW50KHJxLT5od19jb250ZXh0KSkKKwkJCWlm
ICghaW50ZWxfY29udGV4dF9pbmZsaWdodF9jb3VudChycS0+Y29udGV4dCkpCiAJCQkJZW5naW5l
LT5zdGF0cy5hY3RpdmUrKzsKIAkJfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9scmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCmlu
ZGV4IDRiNmQ5ZTZiMWJmZC4uNzdlZmRjM2FmNGFjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9scmMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9scmMuYwpAQCAtODg3LDcgKzg4Nyw3IEBAIF9fdW53aW5kX2luY29tcGxldGVfcmVxdWVzdHMo
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCQkJbGlzdF9tb3ZlKCZycS0+c2NoZWQu
bGluaywgcGwpOwogCQkJYWN0aXZlID0gcnE7CiAJCX0gZWxzZSB7Ci0JCQlzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICpvd25lciA9IHJxLT5od19jb250ZXh0LT5lbmdpbmU7CisJCQlzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICpvd25lciA9IHJxLT5jb250ZXh0LT5lbmdpbmU7CiAKIAkJCS8qCiAJCQkg
KiBEZWNvdXBsZSB0aGUgdmlydHVhbCBicmVhZGNydW1iIGJlZm9yZSBtb3ZpbmcgaXQKQEAgLTEw
NTgsNyArMTA1OCw3IEBAIHN0YXRpYyB2b2lkIHJlc3RvcmVfZGVmYXVsdF9zdGF0ZShzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqY2UsCiBzdGF0aWMgdm9pZCByZXNldF9hY3RpdmUoc3RydWN0IGk5MTVf
cmVxdWVzdCAqcnEsCiAJCQkgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewotCXN0
cnVjdCBpbnRlbF9jb250ZXh0ICogY29uc3QgY2UgPSBycS0+aHdfY29udGV4dDsKKwlzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqIGNvbnN0IGNlID0gcnEtPmNvbnRleHQ7CiAJdTMyIGhlYWQ7CiAKIAkv
KgpAQCAtMTA5OSwxMSArMTA5OSwxMSBAQCBzdGF0aWMgaW5saW5lIHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKgogX19leGVjbGlzdHNfc2NoZWR1bGVfaW4oc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEp
CiB7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqIGNvbnN0IGVuZ2luZSA9IHJxLT5lbmdpbmU7
Ci0Jc3RydWN0IGludGVsX2NvbnRleHQgKiBjb25zdCBjZSA9IHJxLT5od19jb250ZXh0OworCXN0
cnVjdCBpbnRlbF9jb250ZXh0ICogY29uc3QgY2UgPSBycS0+Y29udGV4dDsKIAogCWludGVsX2Nv
bnRleHRfZ2V0KGNlKTsKIAotCWlmICh1bmxpa2VseShpOTE1X2dlbV9jb250ZXh0X2lzX2Jhbm5l
ZChjZS0+Z2VtX2NvbnRleHQpKSkKKwlpZiAodW5saWtlbHkoaW50ZWxfY29udGV4dF9pc19iYW5u
ZWQoY2UpKSkKIAkJcmVzZXRfYWN0aXZlKHJxLCBlbmdpbmUpOwogCiAJaWYgKElTX0VOQUJMRUQo
Q09ORklHX0RSTV9JOTE1X0RFQlVHX0dFTSkpCkBAIC0xMTMxLDcgKzExMzEsNyBAQCBfX2V4ZWNs
aXN0c19zY2hlZHVsZV9pbihzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIHN0YXRpYyBpbmxpbmUg
c3RydWN0IGk5MTVfcmVxdWVzdCAqCiBleGVjbGlzdHNfc2NoZWR1bGVfaW4oc3RydWN0IGk5MTVf
cmVxdWVzdCAqcnEsIGludCBpZHgpCiB7Ci0Jc3RydWN0IGludGVsX2NvbnRleHQgKiBjb25zdCBj
ZSA9IHJxLT5od19jb250ZXh0OworCXN0cnVjdCBpbnRlbF9jb250ZXh0ICogY29uc3QgY2UgPSBy
cS0+Y29udGV4dDsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpvbGQ7CiAKIAlHRU1fQlVHX09O
KCFpbnRlbF9lbmdpbmVfcG1faXNfYXdha2UocnEtPmVuZ2luZSkpOwpAQCAtMTE2Miw3ICsxMTYy
LDcgQEAgc3RhdGljIGlubGluZSB2b2lkCiBfX2V4ZWNsaXN0c19zY2hlZHVsZV9vdXQoc3RydWN0
IGk5MTVfcmVxdWVzdCAqcnEsCiAJCQkgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqIGNvbnN0IGVu
Z2luZSkKIHsKLQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqIGNvbnN0IGNlID0gcnEtPmh3X2NvbnRl
eHQ7CisJc3RydWN0IGludGVsX2NvbnRleHQgKiBjb25zdCBjZSA9IHJxLT5jb250ZXh0OwogCiAJ
aW50ZWxfZW5naW5lX2NvbnRleHRfb3V0KGVuZ2luZSk7CiAJZXhlY2xpc3RzX2NvbnRleHRfc3Rh
dHVzX2NoYW5nZShycSwgSU5URUxfQ09OVEVYVF9TQ0hFRFVMRV9PVVQpOwpAQCAtMTE4Niw3ICsx
MTg2LDcgQEAgX19leGVjbGlzdHNfc2NoZWR1bGVfb3V0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJx
LAogc3RhdGljIGlubGluZSB2b2lkCiBleGVjbGlzdHNfc2NoZWR1bGVfb3V0KHN0cnVjdCBpOTE1
X3JlcXVlc3QgKnJxKQogewotCXN0cnVjdCBpbnRlbF9jb250ZXh0ICogY29uc3QgY2UgPSBycS0+
aHdfY29udGV4dDsKKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqIGNvbnN0IGNlID0gcnEtPmNvbnRl
eHQ7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqY3VyLCAqb2xkOwogCiAJdHJhY2VfaTkxNV9y
ZXF1ZXN0X291dChycSk7CkBAIC0xMjAzLDcgKzEyMDMsNyBAQCBleGVjbGlzdHNfc2NoZWR1bGVf
b3V0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogCiBzdGF0aWMgdTY0IGV4ZWNsaXN0c191cGRh
dGVfY29udGV4dChjb25zdCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIHsKLQlzdHJ1Y3QgaW50
ZWxfY29udGV4dCAqY2UgPSBycS0+aHdfY29udGV4dDsKKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAq
Y2UgPSBycS0+Y29udGV4dDsKIAl1NjQgZGVzYzsKIAogCWNlLT5scmNfcmVnX3N0YXRlW0NUWF9S
SU5HX1RBSUxdID0KQEAgLTEyODUsMTkgKzEyODUsMTggQEAgYXNzZXJ0X3BlbmRpbmdfdmFsaWQo
Y29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9leGVjbGlzdHMgKmV4ZWNsaXN0cywKIAl9CiAKIAlm
b3IgKHBvcnQgPSBleGVjbGlzdHMtPnBlbmRpbmc7IChycSA9ICpwb3J0KTsgcG9ydCsrKSB7Ci0J
CWlmIChjZSA9PSBycS0+aHdfY29udGV4dCkgeworCQlpZiAoY2UgPT0gcnEtPmNvbnRleHQpIHsK
IAkJCUdFTV9UUkFDRV9FUlIoIkR1cCBjb250ZXh0OiVsbHggaW4gcGVuZGluZ1slemRdXG4iLAog
CQkJCSAgICAgIGNlLT50aW1lbGluZS0+ZmVuY2VfY29udGV4dCwKIAkJCQkgICAgICBwb3J0IC0g
ZXhlY2xpc3RzLT5wZW5kaW5nKTsKIAkJCXJldHVybiBmYWxzZTsKIAkJfQogCi0JCWNlID0gcnEt
Pmh3X2NvbnRleHQ7CisJCWNlID0gcnEtPmNvbnRleHQ7CiAJCWlmIChpOTE1X3JlcXVlc3RfY29t
cGxldGVkKHJxKSkKIAkJCWNvbnRpbnVlOwogCi0JCWlmIChpOTE1X2FjdGl2ZV9pc19pZGxlKCZj
ZS0+YWN0aXZlKSAmJgotCQkgICAgIWk5MTVfZ2VtX2NvbnRleHRfaXNfa2VybmVsKGNlLT5nZW1f
Y29udGV4dCkpIHsKKwkJaWYgKGk5MTVfYWN0aXZlX2lzX2lkbGUoJmNlLT5hY3RpdmUpICYmIGNl
LT5nZW1fY29udGV4dCkgewogCQkJR0VNX1RSQUNFX0VSUigiSW5hY3RpdmUgY29udGV4dDolbGx4
IGluIHBlbmRpbmdbJXpkXVxuIiwKIAkJCQkgICAgICBjZS0+dGltZWxpbmUtPmZlbmNlX2NvbnRl
eHQsCiAJCQkJICAgICAgcG9ydCAtIGV4ZWNsaXN0cy0+cGVuZGluZyk7CkBAIC0xMzYxLDcgKzEz
NjAsNyBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfc3VibWl0X3BvcnRzKHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSkKIHN0YXRpYyBib29sIGN0eF9zaW5nbGVfcG9ydF9zdWJtaXNzaW9u
KGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKIHsKIAlyZXR1cm4gKElTX0VOQUJMRUQo
Q09ORklHX0RSTV9JOTE1X0dWVCkgJiYKLQkJaTkxNV9nZW1fY29udGV4dF9mb3JjZV9zaW5nbGVf
c3VibWlzc2lvbihjZS0+Z2VtX2NvbnRleHQpKTsKKwkJaW50ZWxfY29udGV4dF9mb3JjZV9zaW5n
bGVfc3VibWlzc2lvbihjZSkpOwogfQogCiBzdGF0aWMgYm9vbCBjYW5fbWVyZ2VfY3R4KGNvbnN0
IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpwcmV2LApAQCAtMTM5Nyw3ICsxMzk2LDcgQEAgc3RhdGlj
IGJvb2wgY2FuX21lcmdlX3JxKGNvbnN0IHN0cnVjdCBpOTE1X3JlcXVlc3QgKnByZXYsCiAJCSAg
ICAgKEk5MTVfUkVRVUVTVF9OT1BSRUVNUFQgfCBJOTE1X1JFUVVFU1RfU0VOVElORUwpKSkKIAkJ
cmV0dXJuIGZhbHNlOwogCi0JaWYgKCFjYW5fbWVyZ2VfY3R4KHByZXYtPmh3X2NvbnRleHQsIG5l
eHQtPmh3X2NvbnRleHQpKQorCWlmICghY2FuX21lcmdlX2N0eChwcmV2LT5jb250ZXh0LCBuZXh0
LT5jb250ZXh0KSkKIAkJcmV0dXJuIGZhbHNlOwogCiAJcmV0dXJuIHRydWU7CkBAIC0xNTg0LDcg
KzE1ODMsNyBAQCBzdGF0aWMgdW5zaWduZWQgbG9uZyBhY3RpdmVfcHJlZW1wdF90aW1lb3V0KHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAkJcmV0dXJuIDA7CiAKIAkvKiBGb3JjZSBh
IGZhc3QgcmVzZXQgZm9yIHRlcm1pbmF0ZWQgY29udGV4dHMgKGlnbm9yaW5nIHN5c2ZzISkgKi8K
LQlpZiAodW5saWtlbHkoaTkxNV9nZW1fY29udGV4dF9pc19iYW5uZWQocnEtPmdlbV9jb250ZXh0
KSkpCisJaWYgKHVubGlrZWx5KGludGVsX2NvbnRleHRfaXNfYmFubmVkKHJxLT5jb250ZXh0KSkp
CiAJCXJldHVybiAxOwogCiAJcmV0dXJuIFJFQURfT05DRShlbmdpbmUtPnByb3BzLnByZWVtcHRf
dGltZW91dF9tcyk7CkBAIC0xNjkyLDcgKzE2OTEsNyBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNf
ZGVxdWV1ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJCQkgKiB0ZW5kZW5jeSB0
byBpZ25vcmUgdXMgcmV3aW5kaW5nIHRoZSBUQUlMIHRvIHRoZQogCQkJICogZW5kIG9mIGFuIGVh
cmxpZXIgcmVxdWVzdC4KIAkJCSAqLwotCQkJbGFzdC0+aHdfY29udGV4dC0+bHJjX2Rlc2MgfD0g
Q1RYX0RFU0NfRk9SQ0VfUkVTVE9SRTsKKwkJCWxhc3QtPmNvbnRleHQtPmxyY19kZXNjIHw9IENU
WF9ERVNDX0ZPUkNFX1JFU1RPUkU7CiAJCQlsYXN0ID0gTlVMTDsKIAkJfSBlbHNlIGlmIChuZWVk
X3RpbWVzbGljZShlbmdpbmUsIGxhc3QpICYmCiAJCQkgICB0aW1lcl9leHBpcmVkKCZlbmdpbmUt
PmV4ZWNsaXN0cy50aW1lcikpIHsKQEAgLTE3NzQsNyArMTc3Myw3IEBAIHN0YXRpYyB2b2lkIGV4
ZWNsaXN0c19kZXF1ZXVlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAogCQlHRU1f
QlVHX09OKHJxICE9IHZlLT5yZXF1ZXN0KTsKIAkJR0VNX0JVR19PTihycS0+ZW5naW5lICE9ICZ2
ZS0+YmFzZSk7Ci0JCUdFTV9CVUdfT04ocnEtPmh3X2NvbnRleHQgIT0gJnZlLT5jb250ZXh0KTsK
KwkJR0VNX0JVR19PTihycS0+Y29udGV4dCAhPSAmdmUtPmNvbnRleHQpOwogCiAJCWlmIChycV9w
cmlvKHJxKSA+PSBxdWV1ZV9wcmlvKGV4ZWNsaXN0cykpIHsKIAkJCWlmICghdmlydHVhbF9tYXRj
aGVzKHZlLCBycSwgZW5naW5lKSkgewpAQCAtMTg5Myw3ICsxODkyLDcgQEAgc3RhdGljIHZvaWQg
ZXhlY2xpc3RzX2RlcXVldWUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCQkJCSAq
IHNhbWUgTFJDQSwgaS5lLiB3ZSBtdXN0IHN1Ym1pdCAyIGRpZmZlcmVudAogCQkJCSAqIGNvbnRl
eHRzIGlmIHdlIHN1Ym1pdCAyIEVMU1AuCiAJCQkJICovCi0JCQkJaWYgKGxhc3QtPmh3X2NvbnRl
eHQgPT0gcnEtPmh3X2NvbnRleHQpCisJCQkJaWYgKGxhc3QtPmNvbnRleHQgPT0gcnEtPmNvbnRl
eHQpCiAJCQkJCWdvdG8gZG9uZTsKIAogCQkJCWlmIChpOTE1X3JlcXVlc3RfaGFzX3NlbnRpbmVs
KGxhc3QpKQpAQCAtMTkwNiw4ICsxOTA1LDggQEAgc3RhdGljIHZvaWQgZXhlY2xpc3RzX2RlcXVl
dWUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCQkJCSAqIHRoZSBzYW1lIGNvbnRl
eHQgKGV2ZW4gdGhvdWdoIGEgZGlmZmVyZW50CiAJCQkJICogcmVxdWVzdCkgdG8gdGhlIHNlY29u
ZCBwb3J0LgogCQkJCSAqLwotCQkJCWlmIChjdHhfc2luZ2xlX3BvcnRfc3VibWlzc2lvbihsYXN0
LT5od19jb250ZXh0KSB8fAotCQkJCSAgICBjdHhfc2luZ2xlX3BvcnRfc3VibWlzc2lvbihycS0+
aHdfY29udGV4dCkpCisJCQkJaWYgKGN0eF9zaW5nbGVfcG9ydF9zdWJtaXNzaW9uKGxhc3QtPmNv
bnRleHQpIHx8CisJCQkJICAgIGN0eF9zaW5nbGVfcG9ydF9zdWJtaXNzaW9uKHJxLT5jb250ZXh0
KSkKIAkJCQkJZ290byBkb25lOwogCiAJCQkJbWVyZ2UgPSBmYWxzZTsKQEAgLTE5MjEsOCArMTky
MCw4IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19kZXF1ZXVlKHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSkKIAkJCQl9CiAKIAkJCQlHRU1fQlVHX09OKGxhc3QgJiYKLQkJCQkJICAgIWNh
bl9tZXJnZV9jdHgobGFzdC0+aHdfY29udGV4dCwKLQkJCQkJCQkgIHJxLT5od19jb250ZXh0KSk7
CisJCQkJCSAgICFjYW5fbWVyZ2VfY3R4KGxhc3QtPmNvbnRleHQsCisJCQkJCQkJICBycS0+Y29u
dGV4dCkpOwogCiAJCQkJc3VibWl0ID0gdHJ1ZTsKIAkJCQlsYXN0ID0gcnE7CkBAIC0yNTM2LDcg
KzI1MzUsNyBAQCBzdGF0aWMgaW50IGV4ZWNsaXN0c19yZXF1ZXN0X2FsbG9jKHN0cnVjdCBpOTE1
X3JlcXVlc3QgKnJlcXVlc3QpCiB7CiAJaW50IHJldDsKIAotCUdFTV9CVUdfT04oIWludGVsX2Nv
bnRleHRfaXNfcGlubmVkKHJlcXVlc3QtPmh3X2NvbnRleHQpKTsKKwlHRU1fQlVHX09OKCFpbnRl
bF9jb250ZXh0X2lzX3Bpbm5lZChyZXF1ZXN0LT5jb250ZXh0KSk7CiAKIAkvKgogCSAqIEZsdXNo
IGVub3VnaCBzcGFjZSB0byByZWR1Y2UgdGhlIGxpa2VsaWhvb2Qgb2Ygd2FpdGluZyBhZnRlcgpA
QCAtMzA0Myw3ICszMDQyLDcgQEAgc3RhdGljIHZvaWQgX19leGVjbGlzdHNfcmVzZXQoc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBib29sIHN0YWxsZWQpCiAJLyogV2Ugc3RpbGwgaGF2
ZSByZXF1ZXN0cyBpbi1mbGlnaHQ7IHRoZSBlbmdpbmUgc2hvdWxkIGJlIGFjdGl2ZSAqLwogCUdF
TV9CVUdfT04oIWludGVsX2VuZ2luZV9wbV9pc19hd2FrZShlbmdpbmUpKTsKIAotCWNlID0gcnEt
Pmh3X2NvbnRleHQ7CisJY2UgPSBycS0+Y29udGV4dDsKIAlHRU1fQlVHX09OKCFpOTE1X3ZtYV9p
c19waW5uZWQoY2UtPnN0YXRlKSk7CiAKIAlpZiAoaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChycSkp
IHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jCmluZGV4IGI3MDA3Y2Q3OGM2Zi4u
MGQ0YzYxMGE5MGI3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9y
ZXNldC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMKQEAgLTQw
LDI3ICs0MCwzMSBAQCBzdGF0aWMgdm9pZCBybXdfY2xlYXJfZncoc3RydWN0IGludGVsX3VuY29y
ZSAqdW5jb3JlLCBpOTE1X3JlZ190IHJlZywgdTMyIGNscikKIHN0YXRpYyB2b2lkIGVuZ2luZV9z
a2lwX2NvbnRleHQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiB7CiAJc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lID0gcnEtPmVuZ2luZTsKLQlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAq
aHVuZ19jdHggPSBycS0+Z2VtX2NvbnRleHQ7CisJc3RydWN0IGludGVsX2NvbnRleHQgKmh1bmdf
Y3R4ID0gcnEtPmNvbnRleHQ7CiAKIAlpZiAoIWk5MTVfcmVxdWVzdF9pc19hY3RpdmUocnEpKQot
CQlyZXR1cm47CisJCXJxID0gbGlzdF9maXJzdF9lbnRyeSgmZW5naW5lLT5hY3RpdmUucmVxdWVz
dHMsCisJCQkJICAgICAgdHlwZW9mKCpycSksIHNjaGVkLmxpbmspOwogCiAJbG9ja2RlcF9hc3Nl
cnRfaGVsZCgmZW5naW5lLT5hY3RpdmUubG9jayk7CiAJbGlzdF9mb3JfZWFjaF9lbnRyeV9jb250
aW51ZShycSwgJmVuZ2luZS0+YWN0aXZlLnJlcXVlc3RzLCBzY2hlZC5saW5rKQotCQlpZiAocnEt
PmdlbV9jb250ZXh0ID09IGh1bmdfY3R4KQorCQlpZiAocnEtPmNvbnRleHQgPT0gaHVuZ19jdHgp
CiAJCQlpOTE1X3JlcXVlc3Rfc2tpcChycSwgLUVJTyk7CiB9CiAKLXN0YXRpYyB2b2lkIGNsaWVu
dF9tYXJrX2d1aWx0eShzdHJ1Y3QgZHJtX2k5MTVfZmlsZV9wcml2YXRlICpmaWxlX3ByaXYsCi0J
CQkgICAgICAgY29uc3Qgc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKK3N0YXRpYyB2b2lk
IGNsaWVudF9tYXJrX2d1aWx0eShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgYm9vbCBiYW5uZWQp
CiB7Ci0JdW5zaWduZWQgaW50IHNjb3JlOworCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgg
PSBycS0+Y29udGV4dC0+Z2VtX2NvbnRleHQ7CisJc3RydWN0IGRybV9pOTE1X2ZpbGVfcHJpdmF0
ZSAqZmlsZV9wcml2ID0gY3R4LT5maWxlX3ByaXY7CiAJdW5zaWduZWQgbG9uZyBwcmV2X2hhbmc7
CisJdW5zaWduZWQgaW50IHNjb3JlOwogCi0JaWYgKGk5MTVfZ2VtX2NvbnRleHRfaXNfYmFubmVk
KGN0eCkpCisJaWYgKElTX0VSUl9PUl9OVUxMKGZpbGVfcHJpdikpCisJCXJldHVybjsKKworCXNj
b3JlID0gMDsKKwlpZiAoYmFubmVkKQogCQlzY29yZSA9IEk5MTVfQ0xJRU5UX1NDT1JFX0NPTlRF
WFRfQkFOOwotCWVsc2UKLQkJc2NvcmUgPSAwOwogCiAJcHJldl9oYW5nID0geGNoZygmZmlsZV9w
cml2LT5oYW5nX3RpbWVzdGFtcCwgamlmZmllcyk7CiAJaWYgKHRpbWVfYmVmb3JlKGppZmZpZXMs
IHByZXZfaGFuZyArIEk5MTVfQ0xJRU5UX0ZBU1RfSEFOR19KSUZGSUVTKSkKQEAgLTc1LDE0ICs3
OSwxNSBAQCBzdGF0aWMgdm9pZCBjbGllbnRfbWFya19ndWlsdHkoc3RydWN0IGRybV9pOTE1X2Zp
bGVfcHJpdmF0ZSAqZmlsZV9wcml2LAogCX0KIH0KIAotc3RhdGljIGJvb2wgY29udGV4dF9tYXJr
X2d1aWx0eShzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQorc3RhdGljIGJvb2wgbWFya19n
dWlsdHkoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiB7CisJc3RydWN0IGk5MTVfZ2VtX2NvbnRl
eHQgKmN0eCA9IHJxLT5jb250ZXh0LT5nZW1fY29udGV4dDsKIAl1bnNpZ25lZCBsb25nIHByZXZf
aGFuZzsKIAlib29sIGJhbm5lZDsKIAlpbnQgaTsKIAogCWlmIChpOTE1X2dlbV9jb250ZXh0X2lz
X2Nsb3NlZChjdHgpKSB7Ci0JCWk5MTVfZ2VtX2NvbnRleHRfc2V0X2Jhbm5lZChjdHgpOworCQlp
bnRlbF9jb250ZXh0X3NldF9iYW5uZWQocnEtPmNvbnRleHQpOwogCQlyZXR1cm4gdHJ1ZTsKIAl9
CiAKQEAgLTEwOSwxOCArMTE0LDE3IEBAIHN0YXRpYyBib29sIGNvbnRleHRfbWFya19ndWlsdHko
c3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKIAlpZiAoYmFubmVkKSB7CiAJCURSTV9ERUJV
R19EUklWRVIoImNvbnRleHQgJXM6IGd1aWx0eSAlZCwgYmFubmVkXG4iLAogCQkJCSBjdHgtPm5h
bWUsIGF0b21pY19yZWFkKCZjdHgtPmd1aWx0eV9jb3VudCkpOwotCQlpOTE1X2dlbV9jb250ZXh0
X3NldF9iYW5uZWQoY3R4KTsKKwkJaW50ZWxfY29udGV4dF9zZXRfYmFubmVkKHJxLT5jb250ZXh0
KTsKIAl9CiAKLQlpZiAoIUlTX0VSUl9PUl9OVUxMKGN0eC0+ZmlsZV9wcml2KSkKLQkJY2xpZW50
X21hcmtfZ3VpbHR5KGN0eC0+ZmlsZV9wcml2LCBjdHgpOworCWNsaWVudF9tYXJrX2d1aWx0eShy
cSwgYmFubmVkKTsKIAogCXJldHVybiBiYW5uZWQ7CiB9CiAKLXN0YXRpYyB2b2lkIGNvbnRleHRf
bWFya19pbm5vY2VudChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQorc3RhdGljIHZvaWQg
bWFya19pbm5vY2VudChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIHsKLQlhdG9taWNfaW5jKCZj
dHgtPmFjdGl2ZV9jb3VudCk7CisJYXRvbWljX2luYygmcnEtPmNvbnRleHQtPmdlbV9jb250ZXh0
LT5hY3RpdmVfY291bnQpOwogfQogCiB2b2lkIF9faTkxNV9yZXF1ZXN0X3Jlc2V0KHN0cnVjdCBp
OTE1X3JlcXVlc3QgKnJxLCBib29sIGd1aWx0eSkKQEAgLTEzNiwxMSArMTQwLDExIEBAIHZvaWQg
X19pOTE1X3JlcXVlc3RfcmVzZXQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsIGJvb2wgZ3VpbHR5
KQogCXJjdV9yZWFkX2xvY2soKTsgLyogcHJvdGVjdCB0aGUgR0VNIGNvbnRleHQgKi8KIAlpZiAo
Z3VpbHR5KSB7CiAJCWk5MTVfcmVxdWVzdF9za2lwKHJxLCAtRUlPKTsKLQkJaWYgKGNvbnRleHRf
bWFya19ndWlsdHkocnEtPmdlbV9jb250ZXh0KSkKKwkJaWYgKG1hcmtfZ3VpbHR5KHJxKSkKIAkJ
CWVuZ2luZV9za2lwX2NvbnRleHQocnEpOwogCX0gZWxzZSB7CiAJCWRtYV9mZW5jZV9zZXRfZXJy
b3IoJnJxLT5mZW5jZSwgLUVBR0FJTik7Ci0JCWNvbnRleHRfbWFya19pbm5vY2VudChycS0+Z2Vt
X2NvbnRleHQpOworCQltYXJrX2lubm9jZW50KHJxKTsKIAl9CiAJcmN1X3JlYWRfdW5sb2NrKCk7
CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nX3N1Ym1p
c3Npb24uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jpbmdfc3VibWlzc2lvbi5j
CmluZGV4IGE0N2Q1YTdjMzJjOS4uMWMyZjNjM2E4ODQwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nX3N1Ym1pc3Npb24uYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9yaW5nX3N1Ym1pc3Npb24uYwpAQCAtMTQ4NSw3ICsxNDg1LDcgQEAg
c3RhdGljIGlubGluZSBpbnQgbWlfc2V0X2NvbnRleHQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEs
IHUzMiBmbGFncykKIAogCSpjcysrID0gTUlfTk9PUDsKIAkqY3MrKyA9IE1JX1NFVF9DT05URVhU
OwotCSpjcysrID0gaTkxNV9nZ3R0X29mZnNldChycS0+aHdfY29udGV4dC0+c3RhdGUpIHwgZmxh
Z3M7CisJKmNzKysgPSBpOTE1X2dndHRfb2Zmc2V0KHJxLT5jb250ZXh0LT5zdGF0ZSkgfCBmbGFn
czsKIAkvKgogCSAqIHcvYTogTUlfU0VUX0NPTlRFWFQgbXVzdCBhbHdheXMgYmUgZm9sbG93ZWQg
YnkgTUlfTk9PUAogCSAqIFdhTWlTZXRDb250ZXh0X0hhbmc6c25iLGl2Yix2bHYKQEAgLTE1NTUs
NyArMTU1NSw3IEBAIHN0YXRpYyBpbnQgcmVtYXBfbDNfc2xpY2Uoc3RydWN0IGk5MTVfcmVxdWVz
dCAqcnEsIGludCBzbGljZSkKIAogc3RhdGljIGludCByZW1hcF9sMyhzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpycSkKIHsKLQlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4ID0gcnEtPmdlbV9jb250
ZXh0OworCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHggPSBycS0+Y29udGV4dC0+Z2VtX2Nv
bnRleHQ7CiAJaW50IGksIGVycjsKIAogCWlmICghY3R4LT5yZW1hcF9zbGljZSkKQEAgLTE1NzYs
NyArMTU3Niw3IEBAIHN0YXRpYyBpbnQgcmVtYXBfbDMoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEp
CiAKIHN0YXRpYyBpbnQgc3dpdGNoX2NvbnRleHQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiB7
Ci0Jc3RydWN0IGludGVsX2NvbnRleHQgKmNlID0gcnEtPmh3X2NvbnRleHQ7CisJc3RydWN0IGlu
dGVsX2NvbnRleHQgKmNlID0gcnEtPmNvbnRleHQ7CiAJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFj
ZSAqdm0gPSB2bV9hbGlhcyhjZSk7CiAJaW50IHJldDsKIApAQCAtMTYwMSw3ICsxNjAxLDcgQEAg
c3RhdGljIGludCBzd2l0Y2hfY29udGV4dChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIAkJICog
aXMgcHVyZWx5IHVzZWQgZm9yIGZsdXNoaW5nIHVzZXIgY29udGV4dHMuCiAJCSAqLwogCQlod19m
bGFncyA9IDA7Ci0JCWlmIChpOTE1X2dlbV9jb250ZXh0X2lzX2tlcm5lbChycS0+Z2VtX2NvbnRl
eHQpKQorCQlpZiAoaTkxNV9nZW1fY29udGV4dF9pc19rZXJuZWwocnEtPmNvbnRleHQtPmdlbV9j
b250ZXh0KSkKIAkJCWh3X2ZsYWdzID0gTUlfUkVTVE9SRV9JTkhJQklUOwogCiAJCXJldCA9IG1p
X3NldF9jb250ZXh0KHJxLCBod19mbGFncyk7CkBAIC0xNjQ4LDcgKzE2NDgsNyBAQCBzdGF0aWMg
aW50IHJpbmdfcmVxdWVzdF9hbGxvYyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0KQogewog
CWludCByZXQ7CiAKLQlHRU1fQlVHX09OKCFpbnRlbF9jb250ZXh0X2lzX3Bpbm5lZChyZXF1ZXN0
LT5od19jb250ZXh0KSk7CisJR0VNX0JVR19PTighaW50ZWxfY29udGV4dF9pc19waW5uZWQocmVx
dWVzdC0+Y29udGV4dCkpOwogCUdFTV9CVUdfT04oaTkxNV9yZXF1ZXN0X3RpbWVsaW5lKHJlcXVl
c3QpLT5oYXNfaW5pdGlhbF9icmVhZGNydW1iKTsKIAogCS8qCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L3NlbGZ0ZXN0X2xyYy5jCmluZGV4IGQxZWQzYzBmODUxYy4uN2Q1NzEzZWE2YmRlIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwpAQCAtMTE4NywxMyArMTE4NywxMyBAQCBz
dGF0aWMgaW50IF9fY2FuY2VsX2FjdGl2ZTAoc3RydWN0IGxpdmVfcHJlZW1wdF9jYW5jZWwgKmFy
ZykKIAkJCQlfX2Z1bmNfXywgYXJnLT5lbmdpbmUtPm5hbWUpKQogCQlyZXR1cm4gLUVJTzsKIAot
CWNsZWFyX2JpdChDT05URVhUX0JBTk5FRCwgJmFyZy0+YS5jdHgtPmZsYWdzKTsKIAlycSA9IHNw
aW5uZXJfY3JlYXRlX3JlcXVlc3QoJmFyZy0+YS5zcGluLAogCQkJCSAgICBhcmctPmEuY3R4LCBh
cmctPmVuZ2luZSwKIAkJCQkgICAgTUlfQVJCX0NIRUNLKTsKIAlpZiAoSVNfRVJSKHJxKSkKIAkJ
cmV0dXJuIFBUUl9FUlIocnEpOwogCisJY2xlYXJfYml0KENPTlRFWFRfQkFOTkVELCAmcnEtPmNv
bnRleHQtPmZsYWdzKTsKIAlpOTE1X3JlcXVlc3RfZ2V0KHJxKTsKIAlpOTE1X3JlcXVlc3RfYWRk
KHJxKTsKIAlpZiAoIWlndF93YWl0X2Zvcl9zcGlubmVyKCZhcmctPmEuc3BpbiwgcnEpKSB7CkBA
IC0xMjAxLDcgKzEyMDEsNyBAQCBzdGF0aWMgaW50IF9fY2FuY2VsX2FjdGl2ZTAoc3RydWN0IGxp
dmVfcHJlZW1wdF9jYW5jZWwgKmFyZykKIAkJZ290byBvdXQ7CiAJfQogCi0JaTkxNV9nZW1fY29u
dGV4dF9zZXRfYmFubmVkKGFyZy0+YS5jdHgpOworCWludGVsX2NvbnRleHRfc2V0X2Jhbm5lZChy
cS0+Y29udGV4dCk7CiAJZXJyID0gaW50ZWxfZW5naW5lX3B1bHNlKGFyZy0+ZW5naW5lKTsKIAlp
ZiAoZXJyKQogCQlnb3RvIG91dDsKQEAgLTEyMzYsMTMgKzEyMzYsMTMgQEAgc3RhdGljIGludCBf
X2NhbmNlbF9hY3RpdmUxKHN0cnVjdCBsaXZlX3ByZWVtcHRfY2FuY2VsICphcmcpCiAJCQkJX19m
dW5jX18sIGFyZy0+ZW5naW5lLT5uYW1lKSkKIAkJcmV0dXJuIC1FSU87CiAKLQljbGVhcl9iaXQo
Q09OVEVYVF9CQU5ORUQsICZhcmctPmEuY3R4LT5mbGFncyk7CiAJcnFbMF0gPSBzcGlubmVyX2Ny
ZWF0ZV9yZXF1ZXN0KCZhcmctPmEuc3BpbiwKIAkJCQkgICAgICAgYXJnLT5hLmN0eCwgYXJnLT5l
bmdpbmUsCiAJCQkJICAgICAgIE1JX05PT1ApOyAvKiBubyBwcmVlbXB0aW9uICovCiAJaWYgKElT
X0VSUihycVswXSkpCiAJCXJldHVybiBQVFJfRVJSKHJxWzBdKTsKIAorCWNsZWFyX2JpdChDT05U
RVhUX0JBTk5FRCwgJnJxWzBdLT5jb250ZXh0LT5mbGFncyk7CiAJaTkxNV9yZXF1ZXN0X2dldChy
cVswXSk7CiAJaTkxNV9yZXF1ZXN0X2FkZChycVswXSk7CiAJaWYgKCFpZ3Rfd2FpdF9mb3Jfc3Bp
bm5lcigmYXJnLT5hLnNwaW4sIHJxWzBdKSkgewpAQCAtMTI1MCw3ICsxMjUwLDYgQEAgc3RhdGlj
IGludCBfX2NhbmNlbF9hY3RpdmUxKHN0cnVjdCBsaXZlX3ByZWVtcHRfY2FuY2VsICphcmcpCiAJ
CWdvdG8gb3V0OwogCX0KIAotCWNsZWFyX2JpdChDT05URVhUX0JBTk5FRCwgJmFyZy0+Yi5jdHgt
PmZsYWdzKTsKIAlycVsxXSA9IHNwaW5uZXJfY3JlYXRlX3JlcXVlc3QoJmFyZy0+Yi5zcGluLAog
CQkJCSAgICAgICBhcmctPmIuY3R4LCBhcmctPmVuZ2luZSwKIAkJCQkgICAgICAgTUlfQVJCX0NI
RUNLKTsKQEAgLTEyNTksMTMgKzEyNTgsMTQgQEAgc3RhdGljIGludCBfX2NhbmNlbF9hY3RpdmUx
KHN0cnVjdCBsaXZlX3ByZWVtcHRfY2FuY2VsICphcmcpCiAJCWdvdG8gb3V0OwogCX0KIAorCWNs
ZWFyX2JpdChDT05URVhUX0JBTk5FRCwgJnJxWzFdLT5jb250ZXh0LT5mbGFncyk7CiAJaTkxNV9y
ZXF1ZXN0X2dldChycVsxXSk7CiAJZXJyID0gaTkxNV9yZXF1ZXN0X2F3YWl0X2RtYV9mZW5jZShy
cVsxXSwgJnJxWzBdLT5mZW5jZSk7CiAJaTkxNV9yZXF1ZXN0X2FkZChycVsxXSk7CiAJaWYgKGVy
cikKIAkJZ290byBvdXQ7CiAKLQlpOTE1X2dlbV9jb250ZXh0X3NldF9iYW5uZWQoYXJnLT5iLmN0
eCk7CisJaW50ZWxfY29udGV4dF9zZXRfYmFubmVkKHJxWzFdLT5jb250ZXh0KTsKIAllcnIgPSBp
bnRlbF9lbmdpbmVfcHVsc2UoYXJnLT5lbmdpbmUpOwogCWlmIChlcnIpCiAJCWdvdG8gb3V0OwpA
QCAtMTMwOCwxMyArMTMwOCwxMyBAQCBzdGF0aWMgaW50IF9fY2FuY2VsX3F1ZXVlZChzdHJ1Y3Qg
bGl2ZV9wcmVlbXB0X2NhbmNlbCAqYXJnKQogCQkJCV9fZnVuY19fLCBhcmctPmVuZ2luZS0+bmFt
ZSkpCiAJCXJldHVybiAtRUlPOwogCi0JY2xlYXJfYml0KENPTlRFWFRfQkFOTkVELCAmYXJnLT5h
LmN0eC0+ZmxhZ3MpOwogCXJxWzBdID0gc3Bpbm5lcl9jcmVhdGVfcmVxdWVzdCgmYXJnLT5hLnNw
aW4sCiAJCQkJICAgICAgIGFyZy0+YS5jdHgsIGFyZy0+ZW5naW5lLAogCQkJCSAgICAgICBNSV9B
UkJfQ0hFQ0spOwogCWlmIChJU19FUlIocnFbMF0pKQogCQlyZXR1cm4gUFRSX0VSUihycVswXSk7
CiAKKwljbGVhcl9iaXQoQ09OVEVYVF9CQU5ORUQsICZycVswXS0+Y29udGV4dC0+ZmxhZ3MpOwog
CWk5MTVfcmVxdWVzdF9nZXQocnFbMF0pOwogCWk5MTVfcmVxdWVzdF9hZGQocnFbMF0pOwogCWlm
ICghaWd0X3dhaXRfZm9yX3NwaW5uZXIoJmFyZy0+YS5zcGluLCBycVswXSkpIHsKQEAgLTEzMjIs
MTMgKzEzMjIsMTMgQEAgc3RhdGljIGludCBfX2NhbmNlbF9xdWV1ZWQoc3RydWN0IGxpdmVfcHJl
ZW1wdF9jYW5jZWwgKmFyZykKIAkJZ290byBvdXQ7CiAJfQogCi0JY2xlYXJfYml0KENPTlRFWFRf
QkFOTkVELCAmYXJnLT5iLmN0eC0+ZmxhZ3MpOwogCXJxWzFdID0gaWd0X3JlcXVlc3RfYWxsb2Mo
YXJnLT5iLmN0eCwgYXJnLT5lbmdpbmUpOwogCWlmIChJU19FUlIocnFbMV0pKSB7CiAJCWVyciA9
IFBUUl9FUlIocnFbMV0pOwogCQlnb3RvIG91dDsKIAl9CiAKKwljbGVhcl9iaXQoQ09OVEVYVF9C
QU5ORUQsICZycVsxXS0+Y29udGV4dC0+ZmxhZ3MpOwogCWk5MTVfcmVxdWVzdF9nZXQocnFbMV0p
OwogCWVyciA9IGk5MTVfcmVxdWVzdF9hd2FpdF9kbWFfZmVuY2UocnFbMV0sICZycVswXS0+ZmVu
Y2UpOwogCWk5MTVfcmVxdWVzdF9hZGQocnFbMV0pOwpAQCAtMTM0OSw3ICsxMzQ5LDcgQEAgc3Rh
dGljIGludCBfX2NhbmNlbF9xdWV1ZWQoc3RydWN0IGxpdmVfcHJlZW1wdF9jYW5jZWwgKmFyZykK
IAlpZiAoZXJyKQogCQlnb3RvIG91dDsKIAotCWk5MTVfZ2VtX2NvbnRleHRfc2V0X2Jhbm5lZChh
cmctPmEuY3R4KTsKKwlpbnRlbF9jb250ZXh0X3NldF9iYW5uZWQocnFbMl0tPmNvbnRleHQpOwog
CWVyciA9IGludGVsX2VuZ2luZV9wdWxzZShhcmctPmVuZ2luZSk7CiAJaWYgKGVycikKIAkJZ290
byBvdXQ7CkBAIC0xMzk2LDEzICsxMzk2LDEzIEBAIHN0YXRpYyBpbnQgX19jYW5jZWxfaG9zdGls
ZShzdHJ1Y3QgbGl2ZV9wcmVlbXB0X2NhbmNlbCAqYXJnKQogCQlyZXR1cm4gMDsKIAogCUdFTV9U
UkFDRSgiJXMoJXMpXG4iLCBfX2Z1bmNfXywgYXJnLT5lbmdpbmUtPm5hbWUpOwotCWNsZWFyX2Jp
dChDT05URVhUX0JBTk5FRCwgJmFyZy0+YS5jdHgtPmZsYWdzKTsKIAlycSA9IHNwaW5uZXJfY3Jl
YXRlX3JlcXVlc3QoJmFyZy0+YS5zcGluLAogCQkJCSAgICBhcmctPmEuY3R4LCBhcmctPmVuZ2lu
ZSwKIAkJCQkgICAgTUlfTk9PUCk7IC8qIHByZWVtcHRpb24gZGlzYWJsZWQgKi8KIAlpZiAoSVNf
RVJSKHJxKSkKIAkJcmV0dXJuIFBUUl9FUlIocnEpOwogCisJY2xlYXJfYml0KENPTlRFWFRfQkFO
TkVELCAmcnEtPmNvbnRleHQtPmZsYWdzKTsKIAlpOTE1X3JlcXVlc3RfZ2V0KHJxKTsKIAlpOTE1
X3JlcXVlc3RfYWRkKHJxKTsKIAlpZiAoIWlndF93YWl0X2Zvcl9zcGlubmVyKCZhcmctPmEuc3Bp
biwgcnEpKSB7CkBAIC0xNDEwLDcgKzE0MTAsNyBAQCBzdGF0aWMgaW50IF9fY2FuY2VsX2hvc3Rp
bGUoc3RydWN0IGxpdmVfcHJlZW1wdF9jYW5jZWwgKmFyZykKIAkJZ290byBvdXQ7CiAJfQogCi0J
aTkxNV9nZW1fY29udGV4dF9zZXRfYmFubmVkKGFyZy0+YS5jdHgpOworCWludGVsX2NvbnRleHRf
c2V0X2Jhbm5lZChycS0+Y29udGV4dCk7CiAJZXJyID0gaW50ZWxfZW5naW5lX3B1bHNlKGFyZy0+
ZW5naW5lKTsgLyogZm9yY2UgcmVzZXQgKi8KIAlpZiAoZXJyKQogCQlnb3RvIG91dDsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9uLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfc3VibWlzc2lvbi5jCmluZGV4
IDI0OThjNTVlMGVhNS4uMDgyNjdkMmMzY2ZjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC91Yy9pbnRlbF9ndWNfc3VibWlzc2lvbi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9uLmMKQEAgLTQ3MSw3ICs0NzEsNyBAQCBzdGF0
aWMgdm9pZCBndWNfYWRkX3JlcXVlc3Qoc3RydWN0IGludGVsX2d1YyAqZ3VjLCBzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpycSkKIHsKIAlzdHJ1Y3QgaW50ZWxfZ3VjX2NsaWVudCAqY2xpZW50ID0gZ3Vj
LT5leGVjYnVmX2NsaWVudDsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUgPSBycS0+
ZW5naW5lOwotCXUzMiBjdHhfZGVzYyA9IGxvd2VyXzMyX2JpdHMocnEtPmh3X2NvbnRleHQtPmxy
Y19kZXNjKTsKKwl1MzIgY3R4X2Rlc2MgPSBsb3dlcl8zMl9iaXRzKHJxLT5jb250ZXh0LT5scmNf
ZGVzYyk7CiAJdTMyIHJpbmdfdGFpbCA9IGludGVsX3Jpbmdfc2V0X3RhaWwocnEtPnJpbmcsIHJx
LT50YWlsKSAvIHNpemVvZih1NjQpOwogCiAJZ3VjX3dxX2l0ZW1fYXBwZW5kKGNsaWVudCwgZW5n
aW5lLT5ndWNfaWQsIGN0eF9kZXNjLApAQCAtNTcyLDcgKzU3Miw3IEBAIHN0YXRpYyB2b2lkIF9f
Z3VjX2RlcXVldWUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCQlpbnQgaTsKIAog
CQlwcmlvbGlzdF9mb3JfZWFjaF9yZXF1ZXN0X2NvbnN1bWUocnEsIHJuLCBwLCBpKSB7Ci0JCQlp
ZiAobGFzdCAmJiBycS0+aHdfY29udGV4dCAhPSBsYXN0LT5od19jb250ZXh0KSB7CisJCQlpZiAo
bGFzdCAmJiBycS0+Y29udGV4dCAhPSBsYXN0LT5jb250ZXh0KSB7CiAJCQkJaWYgKHBvcnQgPT0g
bGFzdF9wb3J0KQogCQkJCQlnb3RvIGRvbmU7CiAKQEAgLTY3Nyw3ICs2NzcsNyBAQCBzdGF0aWMg
dm9pZCBndWNfcmVzZXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBib29sIHN0YWxs
ZWQpCiAJCXN0YWxsZWQgPSBmYWxzZTsKIAogCV9faTkxNV9yZXF1ZXN0X3Jlc2V0KHJxLCBzdGFs
bGVkKTsKLQlpbnRlbF9scl9jb250ZXh0X3Jlc2V0KGVuZ2luZSwgcnEtPmh3X2NvbnRleHQsIHJx
LT5oZWFkLCBzdGFsbGVkKTsKKwlpbnRlbF9scl9jb250ZXh0X3Jlc2V0KGVuZ2luZSwgcnEtPmNv
bnRleHQsIHJxLT5oZWFkLCBzdGFsbGVkKTsKIAogb3V0X3VubG9jazoKIAlzcGluX3VubG9ja19p
cnFyZXN0b3JlKCZlbmdpbmUtPmFjdGl2ZS5sb2NrLCBmbGFncyk7CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dnQvc2NoZWR1bGVyLmMKaW5kZXggNWIyYTdkMDcyZWM5Li4yMjhjNjY1MzRlMjEgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMKQEAgLTU5LDcgKzU5LDcgQEAgc3RhdGljIHZvaWQg
c2V0X2NvbnRleHRfcGRwX3Jvb3RfcG9pbnRlcigKIHN0YXRpYyB2b2lkIHVwZGF0ZV9zaGFkb3df
cGRwcyhzdHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xvYWQpCiB7CiAJc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3QgKmN0eF9vYmogPQotCQl3b3JrbG9hZC0+cmVxLT5od19jb250ZXh0
LT5zdGF0ZS0+b2JqOworCQl3b3JrbG9hZC0+cmVxLT5jb250ZXh0LT5zdGF0ZS0+b2JqOwogCXN0
cnVjdCBleGVjbGlzdF9yaW5nX2NvbnRleHQgKnNoYWRvd19yaW5nX2NvbnRleHQ7CiAJc3RydWN0
IHBhZ2UgKnBhZ2U7CiAKQEAgLTEzMCw3ICsxMzAsNyBAQCBzdGF0aWMgaW50IHBvcHVsYXRlX3No
YWRvd19jb250ZXh0KHN0cnVjdCBpbnRlbF92Z3B1X3dvcmtsb2FkICp3b3JrbG9hZCkKIAlzdHJ1
Y3QgaW50ZWxfZ3Z0ICpndnQgPSB2Z3B1LT5ndnQ7CiAJaW50IHJpbmdfaWQgPSB3b3JrbG9hZC0+
cmluZ19pZDsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqY3R4X29iaiA9Ci0JCXdvcmts
b2FkLT5yZXEtPmh3X2NvbnRleHQtPnN0YXRlLT5vYmo7CisJCXdvcmtsb2FkLT5yZXEtPmNvbnRl
eHQtPnN0YXRlLT5vYmo7CiAJc3RydWN0IGV4ZWNsaXN0X3JpbmdfY29udGV4dCAqc2hhZG93X3Jp
bmdfY29udGV4dDsKIAlzdHJ1Y3QgcGFnZSAqcGFnZTsKIAl2b2lkICpkc3Q7CkBAIC0yMDUsOSAr
MjA1LDkgQEAgc3RhdGljIGludCBwb3B1bGF0ZV9zaGFkb3dfY29udGV4dChzdHJ1Y3QgaW50ZWxf
dmdwdV93b3JrbG9hZCAqd29ya2xvYWQpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbmxpbmUg
Ym9vbCBpc19ndnRfcmVxdWVzdChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXEpCitzdGF0aWMgaW5s
aW5lIGJvb2wgaXNfZ3Z0X3JlcXVlc3Qoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiB7Ci0JcmV0
dXJuIGk5MTVfZ2VtX2NvbnRleHRfZm9yY2Vfc2luZ2xlX3N1Ym1pc3Npb24ocmVxLT5nZW1fY29u
dGV4dCk7CisJcmV0dXJuIGludGVsX2NvbnRleHRfZm9yY2Vfc2luZ2xlX3N1Ym1pc3Npb24ocnEt
PmNvbnRleHQpOwogfQogCiBzdGF0aWMgdm9pZCBzYXZlX3JpbmdfaHdfc3RhdGUoc3RydWN0IGlu
dGVsX3ZncHUgKnZncHUsIGludCByaW5nX2lkKQpAQCAtMzA3LDcgKzMwNyw3IEBAIHN0YXRpYyBp
bnQgY29weV93b3JrbG9hZF90b19yaW5nX2J1ZmZlcihzdHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9h
ZCAqd29ya2xvYWQpCiAJdTMyICpjczsKIAlpbnQgZXJyOwogCi0JaWYgKElTX0dFTihyZXEtPmk5
MTUsIDkpICYmIGlzX2luaGliaXRfY29udGV4dChyZXEtPmh3X2NvbnRleHQpKQorCWlmIChJU19H
RU4ocmVxLT5pOTE1LCA5KSAmJiBpc19pbmhpYml0X2NvbnRleHQocmVxLT5jb250ZXh0KSkKIAkJ
aW50ZWxfdmdwdV9yZXN0b3JlX2luaGliaXRfY29udGV4dCh2Z3B1LCByZXEpOwogCiAJLyoKQEAg
LTM2MywxMSArMzYzLDEwIEBAIHN0YXRpYyB2b2lkIHJlbGVhc2Vfc2hhZG93X3dhX2N0eChzdHJ1
Y3QgaW50ZWxfc2hhZG93X3dhX2N0eCAqd2FfY3R4KQogfQogCiBzdGF0aWMgdm9pZCBzZXRfY29u
dGV4dF9wcGd0dF9mcm9tX3NoYWRvdyhzdHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xv
YWQsCi0JCQkJCSAgc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKKwkJCQkJICBzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqY2UpCiB7CiAJc3RydWN0IGludGVsX3ZncHVfbW0gKm1tID0gd29ya2xv
YWQtPnNoYWRvd19tbTsKLQlzdHJ1Y3QgaTkxNV9wcGd0dCAqcHBndHQgPQotCQlpOTE1X3ZtX3Rv
X3BwZ3R0KGk5MTVfZ2VtX2NvbnRleHRfZ2V0X3ZtX3JjdShjdHgpKTsKKwlzdHJ1Y3QgaTkxNV9w
cGd0dCAqcHBndHQgPSBpOTE1X3ZtX3RvX3BwZ3R0KGNlLT52bSk7CiAJaW50IGkgPSAwOwogCiAJ
aWYgKG1tLT5wcGd0dF9tbS5yb290X2VudHJ5X3R5cGUgPT0gR1RUX1RZUEVfUFBHVFRfUk9PVF9M
NF9FTlRSWSkgewpAQCAtMzgwLDggKzM3OSw2IEBAIHN0YXRpYyB2b2lkIHNldF9jb250ZXh0X3Bw
Z3R0X2Zyb21fc2hhZG93KHN0cnVjdCBpbnRlbF92Z3B1X3dvcmtsb2FkICp3b3JrbG9hZCwKIAkJ
CXB4X2RtYShwZCkgPSBtbS0+cHBndHRfbW0uc2hhZG93X3BkcHNbaV07CiAJCX0KIAl9Ci0KLQlp
OTE1X3ZtX3B1dCgmcHBndHQtPnZtKTsKIH0KIAogc3RhdGljIGludApAQCAtNTI5LDcgKzUyNiw3
IEBAIHN0YXRpYyB2b2lkIHVwZGF0ZV93YV9jdHhfMl9zaGFkb3dfY3R4KHN0cnVjdCBpbnRlbF9z
aGFkb3dfd2FfY3R4ICp3YV9jdHgpCiAJCWNvbnRhaW5lcl9vZih3YV9jdHgsIHN0cnVjdCBpbnRl
bF92Z3B1X3dvcmtsb2FkLCB3YV9jdHgpOwogCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxID0gd29y
a2xvYWQtPnJlcTsKIAlzdHJ1Y3QgZXhlY2xpc3RfcmluZ19jb250ZXh0ICpzaGFkb3dfcmluZ19j
b250ZXh0ID0KLQkJKHN0cnVjdCBleGVjbGlzdF9yaW5nX2NvbnRleHQgKilycS0+aHdfY29udGV4
dC0+bHJjX3JlZ19zdGF0ZTsKKwkJKHN0cnVjdCBleGVjbGlzdF9yaW5nX2NvbnRleHQgKilycS0+
Y29udGV4dC0+bHJjX3JlZ19zdGF0ZTsKIAogCXNoYWRvd19yaW5nX2NvbnRleHQtPmJiX3Blcl9j
dHhfcHRyLnZhbCA9CiAJCShzaGFkb3dfcmluZ19jb250ZXh0LT5iYl9wZXJfY3R4X3B0ci52YWwg
JgpAQCAtNjI4LDcgKzYyNSw3IEBAIHN0YXRpYyBpbnQgcHJlcGFyZV93b3JrbG9hZChzdHJ1Y3Qg
aW50ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xvYWQpCiAKIAl1cGRhdGVfc2hhZG93X3BkcHMod29y
a2xvYWQpOwogCi0Jc2V0X2NvbnRleHRfcHBndHRfZnJvbV9zaGFkb3cod29ya2xvYWQsIHMtPnNo
YWRvd1tyaW5nXS0+Z2VtX2NvbnRleHQpOworCXNldF9jb250ZXh0X3BwZ3R0X2Zyb21fc2hhZG93
KHdvcmtsb2FkLCBzLT5zaGFkb3dbcmluZ10pOwogCiAJcmV0ID0gaW50ZWxfdmdwdV9zeW5jX29v
c19wYWdlcyh3b3JrbG9hZC0+dmdwdSk7CiAJaWYgKHJldCkgewpAQCAtNzg3LDcgKzc4NCw3IEBA
IHN0YXRpYyB2b2lkIHVwZGF0ZV9ndWVzdF9jb250ZXh0KHN0cnVjdCBpbnRlbF92Z3B1X3dvcmts
b2FkICp3b3JrbG9hZCkKIAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSA9IHdvcmtsb2FkLT5yZXE7
CiAJc3RydWN0IGludGVsX3ZncHUgKnZncHUgPSB3b3JrbG9hZC0+dmdwdTsKIAlzdHJ1Y3QgaW50
ZWxfZ3Z0ICpndnQgPSB2Z3B1LT5ndnQ7Ci0Jc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKmN0
eF9vYmogPSBycS0+aHdfY29udGV4dC0+c3RhdGUtPm9iajsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdCAqY3R4X29iaiA9IHJxLT5jb250ZXh0LT5zdGF0ZS0+b2JqOwogCXN0cnVjdCBleGVj
bGlzdF9yaW5nX2NvbnRleHQgKnNoYWRvd19yaW5nX2NvbnRleHQ7CiAJc3RydWN0IHBhZ2UgKnBh
Z2U7CiAJdm9pZCAqc3JjOwpAQCAtMTIzMiw4ICsxMjI5LDYgQEAgaW50IGludGVsX3ZncHVfc2V0
dXBfc3VibWlzc2lvbihzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKIAlpZiAoSVNfRVJSKGN0eCkp
CiAJCXJldHVybiBQVFJfRVJSKGN0eCk7CiAKLQlpOTE1X2dlbV9jb250ZXh0X3NldF9mb3JjZV9z
aW5nbGVfc3VibWlzc2lvbihjdHgpOwotCiAJcHBndHQgPSBpOTE1X3ZtX3RvX3BwZ3R0KGk5MTVf
Z2VtX2NvbnRleHRfZ2V0X3ZtX3JjdShjdHgpKTsKIAlpOTE1X2NvbnRleHRfcHBndHRfcm9vdF9z
YXZlKHMsIHBwZ3R0KTsKIApAQCAtMTI0OSw2ICsxMjQ0LDggQEAgaW50IGludGVsX3ZncHVfc2V0
dXBfc3VibWlzc2lvbihzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKIAkJCWdvdG8gb3V0X3NoYWRv
d19jdHg7CiAJCX0KIAorCQlpbnRlbF9jb250ZXh0X3NldF9zaW5nbGVfc3VibWlzc2lvbihjZSk7
CisKIAkJaWYgKCFVU0VTX0dVQ19TVUJNSVNTSU9OKGk5MTUpKSB7IC8qIE1heCByaW5nIGJ1ZmZl
ciBzaXplICovCiAJCQljb25zdCB1bnNpZ25lZCBpbnQgcmluZ19zaXplID0gNTEyICogU1pfNEs7
CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCmluZGV4IDE0M2E4OTUyYjczNi4uZjRjYmQzNzlkYjk1
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKQEAgLTExMDgsOSArMTEwOCw5IEBAIHN0YXRpYyBp
bnQgX19pbnRlbF9lbmdpbmVzX3JlY29yZF9kZWZhdWx0cyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQog
CQkJY29udGludWU7CiAKIAkJLyogV2Ugd2FudCB0byBiZSBhYmxlIHRvIHVuYmluZCB0aGUgc3Rh
dGUgZnJvbSB0aGUgR0dUVCAqLwotCQlHRU1fQlVHX09OKGludGVsX2NvbnRleHRfaXNfcGlubmVk
KHJxLT5od19jb250ZXh0KSk7CisJCUdFTV9CVUdfT04oaW50ZWxfY29udGV4dF9pc19waW5uZWQo
cnEtPmNvbnRleHQpKTsKIAotCQlzdGF0ZSA9IHJxLT5od19jb250ZXh0LT5zdGF0ZTsKKwkJc3Rh
dGUgPSBycS0+Y29udGV4dC0+c3RhdGU7CiAJCWlmICghc3RhdGUpCiAJCQljb250aW51ZTsKIApA
QCAtMTE2Miw3ICsxMTYyLDcgQEAgc3RhdGljIGludCBfX2ludGVsX2VuZ2luZXNfcmVjb3JkX2Rl
ZmF1bHRzKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiAJCWlmICghcnEpCiAJCQljb250aW51ZTsKIAot
CQljZSA9IHJxLT5od19jb250ZXh0OworCQljZSA9IHJxLT5jb250ZXh0OwogCQlpOTE1X3JlcXVl
c3RfcHV0KHJxKTsKIAkJaW50ZWxfY29udGV4dF9wdXQoY2UpOwogCX0KZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2dwdV9lcnJvci5jCmluZGV4IDFmMmYyNjZmMjZhZi4uNWM3MzY5YzU1ZjkyIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmMKQEAgLTEyMjAsNyArMTIyMCw3IEBAIHN0
YXRpYyB2b2lkIGVycm9yX3JlY29yZF9lbmdpbmVfcmVnaXN0ZXJzKHN0cnVjdCBpOTE1X2dwdV9z
dGF0ZSAqZXJyb3IsCiBzdGF0aWMgdm9pZCByZWNvcmRfcmVxdWVzdChjb25zdCBzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpyZXF1ZXN0LAogCQkJICAgc3RydWN0IGRybV9pOTE1X2Vycm9yX3JlcXVlc3Qg
KmVycSkKIHsKLQljb25zdCBzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4ID0gcmVxdWVzdC0+
Z2VtX2NvbnRleHQ7CisJY29uc3Qgc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCA9IHJlcXVl
c3QtPmNvbnRleHQtPmdlbV9jb250ZXh0OwogCiAJZXJxLT5mbGFncyA9IHJlcXVlc3QtPmZlbmNl
LmZsYWdzOwogCWVycS0+Y29udGV4dCA9IHJlcXVlc3QtPmZlbmNlLmNvbnRleHQ7CkBAIC0xMjMw
LDcgKzEyMzAsNyBAQCBzdGF0aWMgdm9pZCByZWNvcmRfcmVxdWVzdChjb25zdCBzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpyZXF1ZXN0LAogCWVycS0+c3RhcnQgPSBpOTE1X2dndHRfb2Zmc2V0KHJlcXVl
c3QtPnJpbmctPnZtYSk7CiAJZXJxLT5oZWFkID0gcmVxdWVzdC0+aGVhZDsKIAllcnEtPnRhaWwg
PSByZXF1ZXN0LT50YWlsOwotCWVycS0+cGlkID0gY3R4LT5waWQgPyBwaWRfbnIoY3R4LT5waWQp
IDogMDsKKwllcnEtPnBpZCA9IGN0eCAmJiBjdHgtPnBpZCA/IHBpZF9ucihjdHgtPnBpZCkgOiAw
OwogfQogCiBzdGF0aWMgdm9pZCBlbmdpbmVfcmVjb3JkX3JlcXVlc3RzKHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSwKQEAgLTEyOTcsNyArMTI5NywxMCBAQCBzdGF0aWMgdm9pZCBlcnJv
cl9yZWNvcmRfZW5naW5lX2V4ZWNsaXN0cyhjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUsCiBzdGF0aWMgYm9vbCByZWNvcmRfY29udGV4dChzdHJ1Y3QgZHJtX2k5MTVfZXJyb3Jf
Y29udGV4dCAqZSwKIAkJCSAgIGNvbnN0IHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogewotCWNv
bnN0IHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHggPSBycS0+Z2VtX2NvbnRleHQ7CisJY29u
c3Qgc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCA9IHJxLT5jb250ZXh0LT5nZW1fY29udGV4
dDsKKworCWlmICghY3R4KQorCQlyZXR1cm4gZmFsc2U7CiAKIAlpZiAoY3R4LT5waWQpIHsKIAkJ
c3RydWN0IHRhc2tfc3RydWN0ICp0YXNrOwpAQCAtMTQ1MSw3ICsxNDU0LDcgQEAgZ2VtX3JlY29y
ZF9yaW5ncyhzdHJ1Y3QgaTkxNV9ncHVfc3RhdGUgKmVycm9yLCBzdHJ1Y3QgY29tcHJlc3MgKmNv
bXByZXNzKQogCQljYXB0dXJlID0gcmVxdWVzdF9yZWNvcmRfdXNlcl9ibyhyZXF1ZXN0LCBlZSwg
Y2FwdHVyZSk7CiAKIAkJY2FwdHVyZSA9IGNhcHR1cmVfdm1hKGNhcHR1cmUsCi0JCQkJICAgICAg
cmVxdWVzdC0+aHdfY29udGV4dC0+c3RhdGUsCisJCQkJICAgICAgcmVxdWVzdC0+Y29udGV4dC0+
c3RhdGUsCiAJCQkJICAgICAgJmVlLT5jdHgpOwogCiAJCWNhcHR1cmUgPSBjYXB0dXJlX3ZtYShj
YXB0dXJlLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYwppbmRleCAyYzM4MGFiYTFjZTkuLjE5MjRk
NDQwODFlOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMKQEAgLTMwNzUsNyArMzA3NSw3IEBA
IHN0YXRpYyB2b2lkIGk5MTVfcGVyZl9lbmFibGVfbG9ja2VkKHN0cnVjdCBpOTE1X3BlcmZfc3Ry
ZWFtICpzdHJlYW0pCiAJCXN0cmVhbS0+b3BzLT5lbmFibGUoc3RyZWFtKTsKIAogCWlmIChzdHJl
YW0tPmhvbGRfcHJlZW1wdGlvbikKLQkJaTkxNV9nZW1fY29udGV4dF9zZXRfbm9wcmVlbXB0KHN0
cmVhbS0+Y3R4KTsKKwkJaW50ZWxfY29udGV4dF9zZXRfbm9wcmVlbXB0KHN0cmVhbS0+cGlubmVk
X2N0eCk7CiB9CiAKIC8qKgpAQCAtMzEwMSw3ICszMTAxLDcgQEAgc3RhdGljIHZvaWQgaTkxNV9w
ZXJmX2Rpc2FibGVfbG9ja2VkKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0pCiAJc3Ry
ZWFtLT5lbmFibGVkID0gZmFsc2U7CiAKIAlpZiAoc3RyZWFtLT5ob2xkX3ByZWVtcHRpb24pCi0J
CWk5MTVfZ2VtX2NvbnRleHRfY2xlYXJfbm9wcmVlbXB0KHN0cmVhbS0+Y3R4KTsKKwkJaW50ZWxf
Y29udGV4dF9jbGVhcl9ub3ByZWVtcHQoc3RyZWFtLT5waW5uZWRfY3R4KTsKIAogCWlmIChzdHJl
YW0tPm9wcy0+ZGlzYWJsZSkKIAkJc3RyZWFtLT5vcHMtPmRpc2FibGUoc3RyZWFtKTsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMKaW5kZXggZjdjYzEzZDlkMGFlLi44YTFmMTAyNmYwMzQg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jCkBAIC02Miw2ICs2Miw4IEBAIHN0YXRp
YyBjb25zdCBjaGFyICppOTE1X2ZlbmNlX2dldF9kcml2ZXJfbmFtZShzdHJ1Y3QgZG1hX2ZlbmNl
ICpmZW5jZSkKIAogc3RhdGljIGNvbnN0IGNoYXIgKmk5MTVfZmVuY2VfZ2V0X3RpbWVsaW5lX25h
bWUoc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UpCiB7CisJY29uc3Qgc3RydWN0IGk5MTVfZ2VtX2Nv
bnRleHQgKmN0eDsKKwogCS8qCiAJICogVGhlIHRpbWVsaW5lIHN0cnVjdCAoYXMgcGFydCBvZiB0
aGUgcHBndHQgdW5kZXJuZWF0aCBhIGNvbnRleHQpCiAJICogbWF5IGJlIGZyZWVkIHdoZW4gdGhl
IHJlcXVlc3QgaXMgbm8gbG9uZ2VyIGluIHVzZSBieSB0aGUgR1BVLgpAQCAtNzQsNyArNzYsOCBA
QCBzdGF0aWMgY29uc3QgY2hhciAqaTkxNV9mZW5jZV9nZXRfdGltZWxpbmVfbmFtZShzdHJ1Y3Qg
ZG1hX2ZlbmNlICpmZW5jZSkKIAlpZiAodGVzdF9iaXQoRE1BX0ZFTkNFX0ZMQUdfU0lHTkFMRURf
QklULCAmZmVuY2UtPmZsYWdzKSkKIAkJcmV0dXJuICJzaWduYWxlZCI7CiAKLQlyZXR1cm4gdG9f
cmVxdWVzdChmZW5jZSktPmdlbV9jb250ZXh0LT5uYW1lID86ICJbaTkxNV0iOworCWN0eCA9IHRv
X3JlcXVlc3QoZmVuY2UpLT5jb250ZXh0LT5nZW1fY29udGV4dDsKKwlyZXR1cm4gY3R4ICYmIGN0
eC0+bmFtZSA/IGN0eC0+bmFtZSA6ICJbaTkxNV0iOwogfQogCiBzdGF0aWMgYm9vbCBpOTE1X2Zl
bmNlX3NpZ25hbGVkKHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlKQpAQCAtMjcyLDggKzI3NSw4IEBA
IGJvb2wgaTkxNV9yZXF1ZXN0X3JldGlyZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIAlyZW1v
dmVfZnJvbV9jbGllbnQocnEpOwogCWxpc3RfZGVsKCZycS0+bGluayk7CiAKLQlpbnRlbF9jb250
ZXh0X2V4aXQocnEtPmh3X2NvbnRleHQpOwotCWludGVsX2NvbnRleHRfdW5waW4ocnEtPmh3X2Nv
bnRleHQpOworCWludGVsX2NvbnRleHRfZXhpdChycS0+Y29udGV4dCk7CisJaW50ZWxfY29udGV4
dF91bnBpbihycS0+Y29udGV4dCk7CiAKIAlmcmVlX2NhcHR1cmVfbGlzdChycSk7CiAJaTkxNV9z
Y2hlZF9ub2RlX2ZpbmkoJnJxLT5zY2hlZCk7CkBAIC0zNzYsNyArMzc5LDcgQEAgYm9vbCBfX2k5
MTVfcmVxdWVzdF9zdWJtaXQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCkKIAlpZiAoaTkx
NV9yZXF1ZXN0X2NvbXBsZXRlZChyZXF1ZXN0KSkKIAkJZ290byB4ZmVyOwogCi0JaWYgKGk5MTVf
Z2VtX2NvbnRleHRfaXNfYmFubmVkKHJlcXVlc3QtPmdlbV9jb250ZXh0KSkKKwlpZiAoaW50ZWxf
Y29udGV4dF9pc19iYW5uZWQocmVxdWVzdC0+Y29udGV4dCkpCiAJCWk5MTVfcmVxdWVzdF9za2lw
KHJlcXVlc3QsIC1FSU8pOwogCiAJLyoKQEAgLTY1NSw4ICs2NTgsNyBAQCBfX2k5MTVfcmVxdWVz
dF9jcmVhdGUoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCBnZnBfdCBnZnApCiAJCWdvdG8gZXJy
X2ZyZWU7CiAKIAlycS0+aTkxNSA9IGNlLT5lbmdpbmUtPmk5MTU7Ci0JcnEtPmh3X2NvbnRleHQg
PSBjZTsKLQlycS0+Z2VtX2NvbnRleHQgPSBjZS0+Z2VtX2NvbnRleHQ7CisJcnEtPmNvbnRleHQg
PSBjZTsKIAlycS0+ZW5naW5lID0gY2UtPmVuZ2luZTsKIAlycS0+cmluZyA9IGNlLT5yaW5nOwog
CXJxLT5leGVjdXRpb25fbWFzayA9IGNlLT5lbmdpbmUtPm1hc2s7CkBAIC05MDgsNyArOTEwLDcg
QEAgaTkxNV9yZXF1ZXN0X2F3YWl0X3JlcXVlc3Qoc3RydWN0IGk5MTVfcmVxdWVzdCAqdG8sIHN0
cnVjdCBpOTE1X3JlcXVlc3QgKmZyb20pCiAJCQkJCQkgICAgICAgJmZyb20tPnN1Ym1pdCwKIAkJ
CQkJCSAgICAgICBJOTE1X0ZFTkNFX0dGUCk7CiAJfSBlbHNlIGlmIChpbnRlbF9lbmdpbmVfaGFz
X3NlbWFwaG9yZXModG8tPmVuZ2luZSkgJiYKLQkJICAgdG8tPmdlbV9jb250ZXh0LT5zY2hlZC5w
cmlvcml0eSA+PSBJOTE1X1BSSU9SSVRZX05PUk1BTCkgeworCQkgICB0by0+Y29udGV4dC0+Z2Vt
X2NvbnRleHQtPnNjaGVkLnByaW9yaXR5ID49IEk5MTVfUFJJT1JJVFlfTk9STUFMKSB7CiAJCXJl
dCA9IGVtaXRfc2VtYXBob3JlX3dhaXQodG8sIGZyb20sIEk5MTVfRkVOQ0VfR0ZQKTsKIAl9IGVs
c2UgewogCQlyZXQgPSBpOTE1X3N3X2ZlbmNlX2F3YWl0X2RtYV9mZW5jZSgmdG8tPnN1Ym1pdCwK
QEAgLTEyMzYsNyArMTIzOCw3IEBAIHZvaWQgX19pOTE1X3JlcXVlc3RfcXVldWUoc3RydWN0IGk5
MTVfcmVxdWVzdCAqcnEsCiAKIHZvaWQgaTkxNV9yZXF1ZXN0X2FkZChzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpycSkKIHsKLQlzdHJ1Y3QgaTkxNV9zY2hlZF9hdHRyIGF0dHIgPSBycS0+Z2VtX2NvbnRl
eHQtPnNjaGVkOworCXN0cnVjdCBpOTE1X3NjaGVkX2F0dHIgYXR0ciA9IHJxLT5jb250ZXh0LT5n
ZW1fY29udGV4dC0+c2NoZWQ7CiAJc3RydWN0IGludGVsX3RpbWVsaW5lICogY29uc3QgdGwgPSBp
OTE1X3JlcXVlc3RfdGltZWxpbmUocnEpOwogCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnByZXY7CiAK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5oIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmgKaW5kZXggOTY5OTFkNjQ3NTljLi5iM2I2NTM0
YWU3OTggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5oCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5oCkBAIC0xMDksOSArMTA5LDgg
QEAgc3RydWN0IGk5MTVfcmVxdWVzdCB7CiAJICogaTkxNV9yZXF1ZXN0X2ZyZWUoKSB3aWxsIHRo
ZW4gZGVjcmVtZW50IHRoZSByZWZjb3VudCBvbiB0aGUKIAkgKiBjb250ZXh0LgogCSAqLwotCXN0
cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpnZW1fY29udGV4dDsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmU7Ci0Jc3RydWN0IGludGVsX2NvbnRleHQgKmh3X2NvbnRleHQ7CisJc3RydWN0
IGludGVsX2NvbnRleHQgKmNvbnRleHQ7CiAJc3RydWN0IGludGVsX3JpbmcgKnJpbmc7CiAJc3Ry
dWN0IGludGVsX3RpbWVsaW5lIF9fcmN1ICp0aW1lbGluZTsKIAlzdHJ1Y3QgbGlzdF9oZWFkIHNp
Z25hbF9saW5rOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zY2hlZHVs
ZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc2NoZWR1bGVyLmMKaW5kZXggNzI0ZTk2
ZmU5NmU5Li41NGY2OTQ5NGVjZjcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfc2NoZWR1bGVyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zY2hlZHVsZXIu
YwpAQCAtMjEzLDcgKzIxMyw3IEBAIHN0YXRpYyB2b2lkIGtpY2tfc3VibWlzc2lvbihzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUsCiAJICogSWYgd2UgYXJlIGFscmVhZHkgdGhlIGN1cnJl
bnRseSBleGVjdXRpbmcgY29udGV4dCwgZG9uJ3QKIAkgKiBib3RoZXIgZXZhbHVhdGluZyBpZiB3
ZSBzaG91bGQgcHJlZW1wdCBvdXJzZWx2ZXMuCiAJICovCi0JaWYgKGluZmxpZ2h0LT5od19jb250
ZXh0ID09IHJxLT5od19jb250ZXh0KQorCWlmIChpbmZsaWdodC0+Y29udGV4dCA9PSBycS0+Y29u
dGV4dCkKIAkJZ290byB1bmxvY2s7CiAKIAllbmdpbmUtPmV4ZWNsaXN0cy5xdWV1ZV9wcmlvcml0
eV9oaW50ID0gcHJpbzsKLS0gCjIuMjQuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlz
dGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id C37B78FC91
	for <lists+intel-gfx@lfdr.de>; Fri, 16 Aug 2019 09:41:22 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2962F6EB07;
	Fri, 16 Aug 2019 07:41:21 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga17.intel.com (mga17.intel.com [192.55.52.151])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A251E6EB07
 for <intel-gfx@lists.freedesktop.org>; Fri, 16 Aug 2019 07:41:20 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga001.fm.intel.com ([10.253.24.23])
 by fmsmga107.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 16 Aug 2019 00:41:20 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,391,1559545200"; d="scan'208";a="194943136"
Received: from irvmail001.ir.intel.com ([163.33.26.43])
 by fmsmga001.fm.intel.com with ESMTP; 16 Aug 2019 00:41:19 -0700
Received: from mwajdecz-MOBL1.ger.corp.intel.com
 (mwajdecz-mobl1.ger.corp.intel.com [10.249.129.244])
 by irvmail001.ir.intel.com (8.14.3/8.13.6/MailSET/Hub) with ESMTP id
 x7G7fIH6025956; Fri, 16 Aug 2019 08:41:18 +0100
From: Michal Wajdeczko <michal.wajdeczko@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 16 Aug 2019 07:41:13 +0000
Message-Id: <20190816074113.28160-1-michal.wajdeczko@intel.com>
X-Mailer: git-send-email 2.21.0.windows.1
In-Reply-To: <20190815234832.28836-1-michal.wajdeczko@intel.com>
References: <20190815234832.28836-1-michal.wajdeczko@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v2] drm/i915/uc: Add explicit DISABLED state for
 firmware
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

V2UgcmVhbGx5IG5lZWQgdG8gaGF2ZSBzZXBhcmF0ZSBOT1RfU1VQUE9SVEVEIHN0YXRlIChmb3IK
bGFjayBvZiBoYXJkd2FyZSBzdXBwb3J0KSBhbmQgRElTQUJMRUQgc3RhdGUgKHRvIGluZGljYXRl
CnVzZXIgZGVjaXNpb24pIGFzIHdlIHdpbGwgaGF2ZSB0byB0YWtlIHNwZWNpYWwgc3RlcHMgZXZl
bgppZiBHdUMgZmlybXdhcmUgaXMgbm93IGRpc2FibGVkIGJ1dCBoYXJkd2FyZSBleGlzdHMgYW5k
CmNvdWxkIGhhdmUgYmVlbiBwcmV2aW91c2x5IHVzZWQuCgp2MjogZml4IGxvZ2ljIChDaHJpcy9D
SSkKClNpZ25lZC1vZmYtYnk6IE1pY2hhbCBXYWpkZWN6a28gPG1pY2hhbC53YWpkZWN6a29AaW50
ZWwuY29tPgpDYzogRGFuaWVsZSBDZXJhb2xvIFNwdXJpbyA8ZGFuaWVsZS5jZXJhb2xvc3B1cmlv
QGludGVsLmNvbT4KQ2M6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgot
LS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Yy5oICAgIHwgIDcgKysrKy0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2h1Yy5oICAgIHwgIDcgKysrKy0KIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2h1Y19mdy5jIHwgIDIgKy0KIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX3VjLmMgICAgIHwgMzMgKysrKysrKysrKysrLS0tLS0t
LS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX3VjLmggICAgIHwgMTcgKysr
KysrKysrKystCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF91Y19mdy5jICB8ICA1
ICsrLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX3VjX2Z3LmggIHwgMjMgKysr
KysrKysrKystLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaCAgICAgICAgICAg
fCAgMiArLQogOCBmaWxlcyBjaGFuZ2VkLCA2OCBpbnNlcnRpb25zKCspLCAyOCBkZWxldGlvbnMo
LSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWMuaCBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Yy5oCmluZGV4IDQ5OTlkYjk2NTY4
NS4uMmIyZjA0NmQzY2MzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9p
bnRlbF9ndWMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWMuaApA
QCAtMTU0LDcgKzE1NCwxMiBAQCBzdHJ1Y3QgaTkxNV92bWEgKmludGVsX2d1Y19hbGxvY2F0ZV92
bWEoc3RydWN0IGludGVsX2d1YyAqZ3VjLCB1MzIgc2l6ZSk7CiAKIHN0YXRpYyBpbmxpbmUgYm9v
bCBpbnRlbF9ndWNfaXNfc3VwcG9ydGVkKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKIHsKLQlyZXR1
cm4gaW50ZWxfdWNfZndfc3VwcG9ydGVkKCZndWMtPmZ3KTsKKwlyZXR1cm4gaW50ZWxfdWNfZndf
aXNfc3VwcG9ydGVkKCZndWMtPmZ3KTsKK30KKworc3RhdGljIGlubGluZSBib29sIGludGVsX2d1
Y19pc19lbmFibGVkKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKK3sKKwlyZXR1cm4gaW50ZWxfdWNf
ZndfaXNfZW5hYmxlZCgmZ3VjLT5mdyk7CiB9CiAKIHN0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF9n
dWNfaXNfcnVubmluZyhzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9odWMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L3VjL2ludGVsX2h1Yy5oCmluZGV4IGY4YTQ1NTdjOGQ2ZC4uNjQ0YzA1OWZlMDFkIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9odWMuaAorKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9odWMuaApAQCAtMzgsNyArMzgsMTIgQEAgc3RhdGlj
IGlubGluZSBpbnQgaW50ZWxfaHVjX3Nhbml0aXplKHN0cnVjdCBpbnRlbF9odWMgKmh1YykKIAog
c3RhdGljIGlubGluZSBib29sIGludGVsX2h1Y19pc19zdXBwb3J0ZWQoc3RydWN0IGludGVsX2h1
YyAqaHVjKQogewotCXJldHVybiBpbnRlbF91Y19md19zdXBwb3J0ZWQoJmh1Yy0+ZncpOworCXJl
dHVybiBpbnRlbF91Y19md19pc19zdXBwb3J0ZWQoJmh1Yy0+ZncpOworfQorCitzdGF0aWMgaW5s
aW5lIGJvb2wgaW50ZWxfaHVjX2lzX2VuYWJsZWQoc3RydWN0IGludGVsX2h1YyAqaHVjKQorewor
CXJldHVybiBpbnRlbF91Y19md19pc19lbmFibGVkKCZodWMtPmZ3KTsKIH0KIAogc3RhdGljIGlu
bGluZSBib29sIGludGVsX2h1Y19pc19hdXRoZW50aWNhdGVkKHN0cnVjdCBpbnRlbF9odWMgKmh1
YykKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2h1Y19mdy5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfaHVjX2Z3LmMKaW5kZXggOTZmZWNh
OTkzMjJhLi43NDYwMjQ4N2VkNjcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L3VjL2ludGVsX2h1Y19mdy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVs
X2h1Y19mdy5jCkBAIC0zNSw3ICszNSw3IEBAIHZvaWQgaW50ZWxfaHVjX2Z3X2luaXRfZWFybHko
c3RydWN0IGludGVsX2h1YyAqaHVjKQogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
Z3QtPmk5MTU7CiAKIAlpbnRlbF91Y19md19pbml0X2Vhcmx5KCZodWMtPmZ3LCBJTlRFTF9VQ19G
V19UWVBFX0hVQywKLQkJCSAgICAgICBpbnRlbF91Y19zdXBwb3J0c19ndWModWMpLAorCQkJICAg
ICAgIGludGVsX3VjX3VzZXNfZ3VjKHVjKSwKIAkJCSAgICAgICBJTlRFTF9JTkZPKGk5MTUpLT5w
bGF0Zm9ybSwgSU5URUxfUkVWSUQoaTkxNSkpOwogfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC91Yy9pbnRlbF91Yy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMv
aW50ZWxfdWMuYwppbmRleCAwZGMyYjBjZjQ2MDQuLmIzNzVkYjQ2OGM5YyAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfdWMuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC91Yy9pbnRlbF91Yy5jCkBAIC00NSwxNyArNDUsMTcgQEAgc3RhdGljIHZvaWQg
X19jb25maXJtX29wdGlvbnMoc3RydWN0IGludGVsX3VjICp1YykKIAlEUk1fREVWX0RFQlVHX0RS
SVZFUihpOTE1LT5kcm0uZGV2LAogCQkJICAgICAiZW5hYmxlX2d1Yz0lZCAoZ3VjOiVzIHN1Ym1p
c3Npb246JXMgaHVjOiVzKVxuIiwKIAkJCSAgICAgaTkxNV9tb2RwYXJhbXMuZW5hYmxlX2d1YywK
LQkJCSAgICAgeWVzbm8oaW50ZWxfdWNfc3VwcG9ydHNfZ3VjKHVjKSksCi0JCQkgICAgIHllc25v
KGludGVsX3VjX3N1cHBvcnRzX2d1Y19zdWJtaXNzaW9uKHVjKSksCi0JCQkgICAgIHllc25vKGlu
dGVsX3VjX3N1cHBvcnRzX2h1Yyh1YykpKTsKKwkJCSAgICAgeWVzbm8oaW50ZWxfdWNfdXNlc19n
dWModWMpKSwKKwkJCSAgICAgeWVzbm8oaW50ZWxfdWNfdXNlc19ndWNfc3VibWlzc2lvbih1Yykp
LAorCQkJICAgICB5ZXNubyhpbnRlbF91Y191c2VzX2h1Yyh1YykpKTsKIAogCWlmIChpOTE1X21v
ZHBhcmFtcy5lbmFibGVfZ3VjID09IC0xKQogCQlyZXR1cm47CiAKIAlpZiAoaTkxNV9tb2RwYXJh
bXMuZW5hYmxlX2d1YyA9PSAwKSB7Ci0JCUdFTV9CVUdfT04oaW50ZWxfdWNfc3VwcG9ydHNfZ3Vj
KHVjKSk7Ci0JCUdFTV9CVUdfT04oaW50ZWxfdWNfc3VwcG9ydHNfZ3VjX3N1Ym1pc3Npb24odWMp
KTsKLQkJR0VNX0JVR19PTihpbnRlbF91Y19zdXBwb3J0c19odWModWMpKTsKKwkJR0VNX0JVR19P
TihpbnRlbF91Y191c2VzX2d1Yyh1YykpOworCQlHRU1fQlVHX09OKGludGVsX3VjX3VzZXNfZ3Vj
X3N1Ym1pc3Npb24odWMpKTsKKwkJR0VNX0JVR19PTihpbnRlbF91Y191c2VzX2h1Yyh1YykpOwog
CQlyZXR1cm47CiAJfQogCkBAIC0yNjYsMjMgKzI2NiwyMyBAQCB2b2lkIGludGVsX3VjX2ZldGNo
X2Zpcm13YXJlcyhzdHJ1Y3QgaW50ZWxfdWMgKnVjKQogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdWNfdG9fZ3QodWMpLT5pOTE1OwogCWludCBlcnI7CiAKLQlpZiAoIWludGVsX3Vj
X3N1cHBvcnRzX2d1Yyh1YykpCisJaWYgKCFpbnRlbF91Y191c2VzX2d1Yyh1YykpCiAJCXJldHVy
bjsKIAogCWVyciA9IGludGVsX3VjX2Z3X2ZldGNoKCZ1Yy0+Z3VjLmZ3LCBpOTE1KTsKIAlpZiAo
ZXJyKQogCQlyZXR1cm47CiAKLQlpZiAoaW50ZWxfdWNfc3VwcG9ydHNfaHVjKHVjKSkKKwlpZiAo
aW50ZWxfdWNfdXNlc19odWModWMpKQogCQlpbnRlbF91Y19md19mZXRjaCgmdWMtPmh1Yy5mdywg
aTkxNSk7CiB9CiAKIHZvaWQgaW50ZWxfdWNfY2xlYW51cF9maXJtd2FyZXMoc3RydWN0IGludGVs
X3VjICp1YykKIHsKLQlpZiAoIWludGVsX3VjX3N1cHBvcnRzX2d1Yyh1YykpCisJaWYgKCFpbnRl
bF91Y191c2VzX2d1Yyh1YykpCiAJCXJldHVybjsKIAotCWlmIChpbnRlbF91Y19zdXBwb3J0c19o
dWModWMpKQorCWlmIChpbnRlbF91Y191c2VzX2h1Yyh1YykpCiAJCWludGVsX3VjX2Z3X2NsZWFu
dXBfZmV0Y2goJnVjLT5odWMuZncpOwogCiAJaW50ZWxfdWNfZndfY2xlYW51cF9mZXRjaCgmdWMt
Pmd1Yy5mdyk7CkBAIC0zMDQsNyArMzA0LDcgQEAgaW50IGludGVsX3VjX2luaXQoc3RydWN0IGlu
dGVsX3VjICp1YykKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCi0JaWYgKGludGVsX3VjX3N1
cHBvcnRzX2h1Yyh1YykpIHsKKwlpZiAoaW50ZWxfdWNfdXNlc19odWModWMpKSB7CiAJCXJldCA9
IGludGVsX2h1Y19pbml0KGh1Yyk7CiAJCWlmIChyZXQpCiAJCQlnb3RvIG91dF9odWM7CkBAIC0z
MjQsNyArMzI0LDcgQEAgdm9pZCBpbnRlbF91Y19maW5pKHN0cnVjdCBpbnRlbF91YyAqdWMpCiAJ
aWYgKCFpbnRlbF91Y19zdXBwb3J0c19ndWModWMpKQogCQlyZXR1cm47CiAKLQlpZiAoaW50ZWxf
dWNfc3VwcG9ydHNfaHVjKHVjKSkKKwlpZiAoaW50ZWxfdWNfdXNlc19odWModWMpKQogCQlpbnRl
bF9odWNfZmluaSgmdWMtPmh1Yyk7CiAKIAlpbnRlbF9ndWNfZmluaShndWMpOwpAQCAtMzYwLDcg
KzM2MCw3IEBAIHN0YXRpYyBpbnQgdWNfaW5pdF93b3BjbShzdHJ1Y3QgaW50ZWxfdWMgKnVjKQog
CXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IGd0LT51bmNvcmU7CiAJdTMyIGJhc2UgPSBp
bnRlbF93b3BjbV9ndWNfYmFzZSgmZ3QtPmk5MTUtPndvcGNtKTsKIAl1MzIgc2l6ZSA9IGludGVs
X3dvcGNtX2d1Y19zaXplKCZndC0+aTkxNS0+d29wY20pOwotCXUzMiBodWNfYWdlbnQgPSBpbnRl
bF91Y19zdXBwb3J0c19odWModWMpID8gSFVDX0xPQURJTkdfQUdFTlRfR1VDIDogMDsKKwl1MzIg
aHVjX2FnZW50ID0gaW50ZWxfdWNfdXNlc19odWModWMpID8gSFVDX0xPQURJTkdfQUdFTlRfR1VD
IDogMDsKIAl1MzIgbWFzazsKIAlpbnQgZXJyOwogCkBAIC00MTcsNiArNDE3LDkgQEAgaW50IGlu
dGVsX3VjX2luaXRfaHcoc3RydWN0IGludGVsX3VjICp1YykKIAlpZiAoIWludGVsX3VjX3N1cHBv
cnRzX2d1Yyh1YykpCiAJCXJldHVybiAwOwogCisJaWYgKCFpbnRlbF91Y191c2VzX2d1Yyh1Yykp
CisJCXJldHVybiAwOworCiAJaWYgKCFpbnRlbF91Y19md19pc19hdmFpbGFibGUoJmd1Yy0+Zncp
KSB7CiAJCXJldCA9IGludGVsX3VjX2Z3X3N0YXR1c190b19lcnJvcihndWMtPmZ3LnN0YXR1cyk7
CiAJCWdvdG8gZXJyX291dDsKQEAgLTQ0NCw3ICs0NDcsNyBAQCBpbnQgaW50ZWxfdWNfaW5pdF9o
dyhzdHJ1Y3QgaW50ZWxfdWMgKnVjKQogCQlpZiAocmV0KQogCQkJZ290byBlcnJfb3V0OwogCi0J
CWlmIChpbnRlbF91Y19zdXBwb3J0c19odWModWMpKSB7CisJCWlmIChpbnRlbF91Y191c2VzX2h1
Yyh1YykpIHsKIAkJCXJldCA9IGludGVsX2h1Y19md191cGxvYWQoaHVjKTsKIAkJCWlmIChyZXQg
JiYgaW50ZWxfdWNfZndfaXNfb3ZlcnJpZGRlbigmaHVjLT5mdykpCiAJCQkJZ290byBlcnJfb3V0
OwpAQCAtNDkwLDcgKzQ5Myw3IEBAIGludCBpbnRlbF91Y19pbml0X2h3KHN0cnVjdCBpbnRlbF91
YyAqdWMpCiAJCSAic3VibWlzc2lvbiIsCiAJCSBlbmFibGVkZGlzYWJsZWQoaW50ZWxfdWNfc3Vw
cG9ydHNfZ3VjX3N1Ym1pc3Npb24odWMpKSk7CiAKLQlpZiAoaW50ZWxfdWNfc3VwcG9ydHNfaHVj
KHVjKSkgeworCWlmIChpbnRlbF91Y191c2VzX2h1Yyh1YykpIHsKIAkJZGV2X2luZm8oaTkxNS0+
ZHJtLmRldiwgIiVzIGZpcm13YXJlICVzIHZlcnNpb24gJXUuJXUgJXM6JXNcbiIsCiAJCQkgaW50
ZWxfdWNfZndfdHlwZV9yZXByKElOVEVMX1VDX0ZXX1RZUEVfSFVDKSwKIAkJCSBodWMtPmZ3LnBh
dGgsCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF91Yy5oIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfdWMuaAppbmRleCBiZmI2Zjk3NTc4YTUu
LjFiOTQwNGE3NWFjMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50
ZWxfdWMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF91Yy5oCkBAIC0z
OSwxNCArMzksMjkgQEAgc3RhdGljIGlubGluZSBib29sIGludGVsX3VjX3N1cHBvcnRzX2d1Yyhz
dHJ1Y3QgaW50ZWxfdWMgKnVjKQogCXJldHVybiBpbnRlbF9ndWNfaXNfc3VwcG9ydGVkKCZ1Yy0+
Z3VjKTsKIH0KIAorc3RhdGljIGlubGluZSBib29sIGludGVsX3VjX3VzZXNfZ3VjKHN0cnVjdCBp
bnRlbF91YyAqdWMpCit7CisJcmV0dXJuIGludGVsX2d1Y19pc19lbmFibGVkKCZ1Yy0+Z3VjKTsK
K30KKwogc3RhdGljIGlubGluZSBib29sIGludGVsX3VjX3N1cHBvcnRzX2d1Y19zdWJtaXNzaW9u
KHN0cnVjdCBpbnRlbF91YyAqdWMpCiB7CiAJcmV0dXJuIGludGVsX2d1Y19pc19zdWJtaXNzaW9u
X3N1cHBvcnRlZCgmdWMtPmd1Yyk7CiB9CiAKK3N0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF91Y191
c2VzX2d1Y19zdWJtaXNzaW9uKHN0cnVjdCBpbnRlbF91YyAqdWMpCit7CisJcmV0dXJuIGludGVs
X2d1Y19pc19zdWJtaXNzaW9uX3N1cHBvcnRlZCgmdWMtPmd1Yyk7Cit9CisKIHN0YXRpYyBpbmxp
bmUgYm9vbCBpbnRlbF91Y19zdXBwb3J0c19odWMoc3RydWN0IGludGVsX3VjICp1YykKIHsKLQly
ZXR1cm4gaW50ZWxfaHVjX2lzX3N1cHBvcnRlZCgmdWMtPmh1Yyk7CisJcmV0dXJuIGludGVsX3Vj
X3N1cHBvcnRzX2d1Yyh1Yyk7Cit9CisKK3N0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF91Y191c2Vz
X2h1YyhzdHJ1Y3QgaW50ZWxfdWMgKnVjKQoreworCXJldHVybiBpbnRlbF9odWNfaXNfZW5hYmxl
ZCgmdWMtPmh1Yyk7CiB9CiAKICNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvdWMvaW50ZWxfdWNfZncuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVs
X3VjX2Z3LmMKaW5kZXggZDA1NmUxZjRiZDZkLi5iZDY2MzVmZjllMmQgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX3VjX2Z3LmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvdWMvaW50ZWxfdWNfZncuYwpAQCAtMjA2LDggKzIwNiw5IEBAIHZvaWQgaW50
ZWxfdWNfZndfaW5pdF9lYXJseShzdHJ1Y3QgaW50ZWxfdWNfZncgKnVjX2Z3LAogCQlfX3VjX2Z3
X3VzZXJfb3ZlcnJpZGUodWNfZncpOwogCX0KIAotCWludGVsX3VjX2Z3X2NoYW5nZV9zdGF0dXMo
dWNfZncsIHVjX2Z3LT5wYXRoICYmICp1Y19mdy0+cGF0aCA/CisJaW50ZWxfdWNfZndfY2hhbmdl
X3N0YXR1cyh1Y19mdywgdWNfZnctPnBhdGggPyAqdWNfZnctPnBhdGggPwogCQkJCSAgSU5URUxf
VUNfRklSTVdBUkVfU0VMRUNURUQgOgorCQkJCSAgSU5URUxfVUNfRklSTVdBUkVfRElTQUJMRUQg
OgogCQkJCSAgSU5URUxfVUNfRklSTVdBUkVfTk9UX1NVUFBPUlRFRCk7CiB9CiAKQEAgLTI2NSw3
ICsyNjYsNyBAQCBpbnQgaW50ZWxfdWNfZndfZmV0Y2goc3RydWN0IGludGVsX3VjX2Z3ICp1Y19m
dywgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJc2l6ZV90IHNpemU7CiAJaW50IGVy
cjsKIAotCUdFTV9CVUdfT04oIWludGVsX3VjX2Z3X3N1cHBvcnRlZCh1Y19mdykpOworCUdFTV9C
VUdfT04oIWludGVsX3VjX2Z3X2lzX2VuYWJsZWQodWNfZncpKTsKIAogCWVyciA9IGk5MTVfaW5q
ZWN0X2xvYWRfZXJyb3IoaTkxNSwgLUVOWElPKTsKIAlpZiAoZXJyKQpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfdWNfZncuaCBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L3VjL2ludGVsX3VjX2Z3LmgKaW5kZXggY2U4ZTgzMTI4YTk1Li5mZGRhMTdmMGE5NTMg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX3VjX2Z3LmgKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfdWNfZncuaApAQCAtMTksOCArMTks
OSBAQCBzdHJ1Y3QgaW50ZWxfZ3Q7CiAjZGVmaW5lIElOVEVMX1VDX0ZJUk1XQVJFX1VSTCAiaHR0
cHM6Ly9naXQua2VybmVsLm9yZy9wdWIvc2NtL2xpbnV4L2tlcm5lbC9naXQvZmlybXdhcmUvbGlu
dXgtZmlybXdhcmUuZ2l0L3RyZWUvaTkxNSIKIAogZW51bSBpbnRlbF91Y19md19zdGF0dXMgewot
CUlOVEVMX1VDX0ZJUk1XQVJFX05PVF9TVVBQT1JURUQgPSAtMSwgLyogbm8gdWMgSFcgb3IgZGlz
YWJsZWQgKi8KKwlJTlRFTF9VQ19GSVJNV0FSRV9OT1RfU1VQUE9SVEVEID0gLTEsIC8qIG5vIHVj
IEhXICovCiAJSU5URUxfVUNfRklSTVdBUkVfVU5JTklUSUFMSVpFRCA9IDAsIC8qIHVzZWQgdG8g
Y2F0Y2ggY2hlY2tzIGRvbmUgdG9vIGVhcmx5ICovCisJSU5URUxfVUNfRklSTVdBUkVfRElTQUJM
RUQsIC8qIGRpc2FibGVkICovCiAJSU5URUxfVUNfRklSTVdBUkVfU0VMRUNURUQsIC8qIHNlbGVj
dGVkIHRoZSBibG9iIHdlIHdhbnQgdG8gbG9hZCAqLwogCUlOVEVMX1VDX0ZJUk1XQVJFX01JU1NJ
TkcsIC8qIGJsb2Igbm90IGZvdW5kIG9uIHRoZSBzeXN0ZW0gKi8KIAlJTlRFTF9VQ19GSVJNV0FS
RV9FUlJPUiwgLyogaW52YWxpZCBmb3JtYXQgb3IgdmVyc2lvbiAqLwpAQCAtODQsNiArODUsOCBA
QCBjb25zdCBjaGFyICppbnRlbF91Y19md19zdGF0dXNfcmVwcihlbnVtIGludGVsX3VjX2Z3X3N0
YXR1cyBzdGF0dXMpCiAJCXJldHVybiAiTi9BIjsKIAljYXNlIElOVEVMX1VDX0ZJUk1XQVJFX1VO
SU5JVElBTElaRUQ6CiAJCXJldHVybiAiVU5JTklUSUFMSVpFRCI7CisJY2FzZSBJTlRFTF9VQ19G
SVJNV0FSRV9ESVNBQkxFRDoKKwkJcmV0dXJuICJESVNBQkxFRCI7CiAJY2FzZSBJTlRFTF9VQ19G
SVJNV0FSRV9TRUxFQ1RFRDoKIAkJcmV0dXJuICJTRUxFQ1RFRCI7CiAJY2FzZSBJTlRFTF9VQ19G
SVJNV0FSRV9NSVNTSU5HOgpAQCAtMTA2LDcgKzEwOSwxMCBAQCBzdGF0aWMgaW5saW5lIGludCBp
bnRlbF91Y19md19zdGF0dXNfdG9fZXJyb3IoZW51bSBpbnRlbF91Y19md19zdGF0dXMgc3RhdHVz
KQogewogCXN3aXRjaCAoc3RhdHVzKSB7CiAJY2FzZSBJTlRFTF9VQ19GSVJNV0FSRV9OT1RfU1VQ
UE9SVEVEOgorCQlyZXR1cm4gLUVOT0RFVjsKIAljYXNlIElOVEVMX1VDX0ZJUk1XQVJFX1VOSU5J
VElBTElaRUQ6CisJCXJldHVybiAtRUFDQ0VTOworCWNhc2UgSU5URUxfVUNfRklSTVdBUkVfRElT
QUJMRUQ6CiAJCXJldHVybiAtRVBFUk07CiAJY2FzZSBJTlRFTF9VQ19GSVJNV0FSRV9NSVNTSU5H
OgogCQlyZXR1cm4gLUVOT0VOVDsKQEAgLTE0Miw2ICsxNDgsMTYgQEAgX19pbnRlbF91Y19md19z
dGF0dXMoc3RydWN0IGludGVsX3VjX2Z3ICp1Y19mdykKIAlyZXR1cm4gdWNfZnctPnN0YXR1czsK
IH0KIAorc3RhdGljIGlubGluZSBib29sIGludGVsX3VjX2Z3X2lzX3N1cHBvcnRlZChzdHJ1Y3Qg
aW50ZWxfdWNfZncgKnVjX2Z3KQoreworCXJldHVybiBfX2ludGVsX3VjX2Z3X3N0YXR1cyh1Y19m
dykgIT0gSU5URUxfVUNfRklSTVdBUkVfTk9UX1NVUFBPUlRFRDsKK30KKworc3RhdGljIGlubGlu
ZSBib29sIGludGVsX3VjX2Z3X2lzX2VuYWJsZWQoc3RydWN0IGludGVsX3VjX2Z3ICp1Y19mdykK
K3sKKwlyZXR1cm4gX19pbnRlbF91Y19md19zdGF0dXModWNfZncpID4gSU5URUxfVUNfRklSTVdB
UkVfRElTQUJMRUQ7Cit9CisKIHN0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF91Y19md19pc19hdmFp
bGFibGUoc3RydWN0IGludGVsX3VjX2Z3ICp1Y19mdykKIHsKIAlyZXR1cm4gX19pbnRlbF91Y19m
d19zdGF0dXModWNfZncpID49IElOVEVMX1VDX0ZJUk1XQVJFX0FWQUlMQUJMRTsKQEAgLTE1Nywx
MSArMTczLDYgQEAgc3RhdGljIGlubGluZSBib29sIGludGVsX3VjX2Z3X2lzX3J1bm5pbmcoc3Ry
dWN0IGludGVsX3VjX2Z3ICp1Y19mdykKIAlyZXR1cm4gX19pbnRlbF91Y19md19zdGF0dXModWNf
ZncpID09IElOVEVMX1VDX0ZJUk1XQVJFX1JVTk5JTkc7CiB9CiAKLXN0YXRpYyBpbmxpbmUgYm9v
bCBpbnRlbF91Y19md19zdXBwb3J0ZWQoc3RydWN0IGludGVsX3VjX2Z3ICp1Y19mdykKLXsKLQly
ZXR1cm4gX19pbnRlbF91Y19md19zdGF0dXModWNfZncpICE9IElOVEVMX1VDX0ZJUk1XQVJFX05P
VF9TVVBQT1JURUQ7Ci19Ci0KIHN0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF91Y19md19pc19vdmVy
cmlkZGVuKGNvbnN0IHN0cnVjdCBpbnRlbF91Y19mdyAqdWNfZncpCiB7CiAJcmV0dXJuIHVjX2Z3
LT51c2VyX292ZXJyaWRkZW47CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2Rydi5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAppbmRleCBjNDQwNmE2MGYz
ZTQuLjdjYjcwZjYxNGVjMiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9k
cnYuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCkBAIC0yMjE0LDcgKzIy
MTQsNyBAQCBJU19TVUJQTEFURk9STShjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKICNkZWZpbmUgSEFTX0dUX1VDKGRldl9wcml2KQkoSU5URUxfSU5GTyhkZXZfcHJpdiktPmhh
c19ndF91YykKIAogLyogSGF2aW5nIEd1QyBpcyBub3QgdGhlIHNhbWUgYXMgdXNpbmcgR3VDICov
Ci0jZGVmaW5lIFVTRVNfR1VDKGRldl9wcml2KQkJaW50ZWxfdWNfc3VwcG9ydHNfZ3VjKCYoZGV2
X3ByaXYpLT5ndC51YykKKyNkZWZpbmUgVVNFU19HVUMoZGV2X3ByaXYpCQlpbnRlbF91Y191c2Vz
X2d1YygmKGRldl9wcml2KS0+Z3QudWMpCiAjZGVmaW5lIFVTRVNfR1VDX1NVQk1JU1NJT04oZGV2
X3ByaXYpCWludGVsX3VjX3N1cHBvcnRzX2d1Y19zdWJtaXNzaW9uKCYoZGV2X3ByaXYpLT5ndC51
YykKIAogI2RlZmluZSBIQVNfUE9PTEVEX0VVKGRldl9wcml2KQkoSU5URUxfSU5GTyhkZXZfcHJp
diktPmhhc19wb29sZWRfZXUpCi0tIAoyLjE5LjIKCl9fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxp
c3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFu
L2xpc3RpbmZvL2ludGVsLWdmeA==

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id C781B4BF51
	for <lists+intel-gfx@lfdr.de>; Wed, 19 Jun 2019 19:08:54 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 31AA76E450;
	Wed, 19 Jun 2019 17:08:53 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga11.intel.com (mga11.intel.com [192.55.52.93])
 by gabe.freedesktop.org (Postfix) with ESMTPS id AC9D26E450
 for <intel-gfx@lists.freedesktop.org>; Wed, 19 Jun 2019 17:08:51 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga007.fm.intel.com ([10.253.24.52])
 by fmsmga102.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 19 Jun 2019 10:08:51 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,393,1557212400"; d="scan'208";a="162102923"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.174])
 by fmsmga007.fm.intel.com with SMTP; 19 Jun 2019 10:08:49 -0700
Received: by stinkbox (sSMTP sendmail emulation);
 Wed, 19 Jun 2019 20:08:48 +0300
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 19 Jun 2019 20:08:40 +0300
Message-Id: <20190619170842.20579-3-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190619170842.20579-1-ville.syrjala@linux.intel.com>
References: <20190619170842.20579-1-ville.syrjala@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 2/4] drm/i915: Switch to per-crtc vblank vfuncs
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KClN3
aXRjaCBmcm9tIHRoZSBkcml2ZXItd2lkZSB2YmxhbmsgdmZ1bmNzIHRvIHRoZSBwZXItY3J0YyBv
bmVzIHNvIHRoYXQKd2UgZG9uJ3QgaGF2ZSBzbyBtYW55IHBsYXRmb3JtIHNwZWNpZmljIHZmdW5j
cyBpbiB0aGUgZHJpdmVyIHN0cnVjdC4KCldlIHN0aWxsIG5lZWQgdG8gZG8gc29tZXRoaW5nIGFi
b3V0IHRoZSByZXN0IGZvIHRoZSBpcnEgdmZ1bmNzLi4uCgp2Mjogcy9JTlRFTF9HRU4+PTMvSVNf
R0VOMy8KClNpZ25lZC1vZmYtYnk6IFZpbGxlIFN5cmrDpGzDpCA8dmlsbGUuc3lyamFsYUBsaW51
eC5pbnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNw
bGF5LmMgfCAxMDQgKysrKysrKysrKysrKysrKy0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9pcnEuYyAgICAgICAgICAgICAgfCAgOTMgKysrKysrKy0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfaXJxLmggICAgICAgICAgICAgIHwgIDE0ICsrKwogMyBmaWxlcyBjaGFu
Z2VkLCAxNDMgaW5zZXJ0aW9ucygrKSwgNjggZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwppbmRleCA1ZjMwZjM0OGIwYzAuLmU1NWJk
NzU1MjhjMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9k
aXNwbGF5LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5
LmMKQEAgLTEzNTY3LDcgKzEzNTY3LDcgQEAgdTMyIGludGVsX2NydGNfZ2V0X3ZibGFua19jb3Vu
dGVyKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQogCWlmICghdmJsYW5rLT5tYXhfdmJsYW5rX2Nv
dW50KQogCQlyZXR1cm4gKHUzMilkcm1fY3J0Y19hY2N1cmF0ZV92YmxhbmtfY291bnQoJmNydGMt
PmJhc2UpOwogCi0JcmV0dXJuIGRldi0+ZHJpdmVyLT5nZXRfdmJsYW5rX2NvdW50ZXIoZGV2LCBj
cnRjLT5waXBlKTsKKwlyZXR1cm4gY3J0Yy0+YmFzZS5mdW5jcy0+Z2V0X3ZibGFua19jb3VudGVy
KCZjcnRjLT5iYXNlKTsKIH0KIAogc3RhdGljIHZvaWQgaW50ZWxfdXBkYXRlX2NydGMoc3RydWN0
IGRybV9jcnRjICpjcnRjLApAQCAtMTQxMDUsMTggKzE0MTA1LDYgQEAgc3RhdGljIGludCBpbnRl
bF9hdG9taWNfY29tbWl0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2NydGNfZnVuY3MgaW50ZWxfY3J0Y19mdW5jcyA9IHsK
LQkuZ2FtbWFfc2V0ID0gZHJtX2F0b21pY19oZWxwZXJfbGVnYWN5X2dhbW1hX3NldCwKLQkuc2V0
X2NvbmZpZyA9IGRybV9hdG9taWNfaGVscGVyX3NldF9jb25maWcsCi0JLmRlc3Ryb3kgPSBpbnRl
bF9jcnRjX2Rlc3Ryb3ksCi0JLnBhZ2VfZmxpcCA9IGRybV9hdG9taWNfaGVscGVyX3BhZ2VfZmxp
cCwKLQkuYXRvbWljX2R1cGxpY2F0ZV9zdGF0ZSA9IGludGVsX2NydGNfZHVwbGljYXRlX3N0YXRl
LAotCS5hdG9taWNfZGVzdHJveV9zdGF0ZSA9IGludGVsX2NydGNfZGVzdHJveV9zdGF0ZSwKLQku
c2V0X2NyY19zb3VyY2UgPSBpbnRlbF9jcnRjX3NldF9jcmNfc291cmNlLAotCS52ZXJpZnlfY3Jj
X3NvdXJjZSA9IGludGVsX2NydGNfdmVyaWZ5X2NyY19zb3VyY2UsCi0JLmdldF9jcmNfc291cmNl
cyA9IGludGVsX2NydGNfZ2V0X2NyY19zb3VyY2VzLAotfTsKLQogc3RydWN0IHdhaXRfcnBzX2Jv
b3N0IHsKIAlzdHJ1Y3Qgd2FpdF9xdWV1ZV9lbnRyeSB3YWl0OwogCkBAIC0xNDkxMCw4ICsxNDg5
OCw3NiBAQCBzdGF0aWMgdm9pZCBpbnRlbF9jcnRjX2luaXRfc2NhbGVycyhzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YywKIAlzY2FsZXJfc3RhdGUtPnNjYWxlcl9pZCA9IC0xOwogfQogCisjZGVmaW5l
IElOVEVMX0NSVENfRlVOQ1MgXAorCS5nYW1tYV9zZXQgPSBkcm1fYXRvbWljX2hlbHBlcl9sZWdh
Y3lfZ2FtbWFfc2V0LCBcCisJLnNldF9jb25maWcgPSBkcm1fYXRvbWljX2hlbHBlcl9zZXRfY29u
ZmlnLCBcCisJLmRlc3Ryb3kgPSBpbnRlbF9jcnRjX2Rlc3Ryb3ksIFwKKwkucGFnZV9mbGlwID0g
ZHJtX2F0b21pY19oZWxwZXJfcGFnZV9mbGlwLCBcCisJLmF0b21pY19kdXBsaWNhdGVfc3RhdGUg
PSBpbnRlbF9jcnRjX2R1cGxpY2F0ZV9zdGF0ZSwgXAorCS5hdG9taWNfZGVzdHJveV9zdGF0ZSA9
IGludGVsX2NydGNfZGVzdHJveV9zdGF0ZSwgXAorCS5zZXRfY3JjX3NvdXJjZSA9IGludGVsX2Ny
dGNfc2V0X2NyY19zb3VyY2UsIFwKKwkudmVyaWZ5X2NyY19zb3VyY2UgPSBpbnRlbF9jcnRjX3Zl
cmlmeV9jcmNfc291cmNlLCBcCisJLmdldF9jcmNfc291cmNlcyA9IGludGVsX2NydGNfZ2V0X2Ny
Y19zb3VyY2VzCisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2NydGNfZnVuY3MgYmR3X2NydGNf
ZnVuY3MgPSB7CisJSU5URUxfQ1JUQ19GVU5DUywKKworCS5nZXRfdmJsYW5rX2NvdW50ZXIgPSBn
NHhfZ2V0X3ZibGFua19jb3VudGVyLAorCS5lbmFibGVfdmJsYW5rID0gYmR3X2VuYWJsZV92Ymxh
bmssCisJLmRpc2FibGVfdmJsYW5rID0gYmR3X2Rpc2FibGVfdmJsYW5rLAorfTsKKworc3RhdGlj
IGNvbnN0IHN0cnVjdCBkcm1fY3J0Y19mdW5jcyBpbGtfY3J0Y19mdW5jcyA9IHsKKwlJTlRFTF9D
UlRDX0ZVTkNTLAorCisJLmdldF92YmxhbmtfY291bnRlciA9IGc0eF9nZXRfdmJsYW5rX2NvdW50
ZXIsCisJLmVuYWJsZV92YmxhbmsgPSBpbGtfZW5hYmxlX3ZibGFuaywKKwkuZGlzYWJsZV92Ymxh
bmsgPSBpbGtfZGlzYWJsZV92YmxhbmssCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9j
cnRjX2Z1bmNzIGc0eF9jcnRjX2Z1bmNzID0geworCUlOVEVMX0NSVENfRlVOQ1MsCisKKwkuZ2V0
X3ZibGFua19jb3VudGVyID0gZzR4X2dldF92YmxhbmtfY291bnRlciwKKwkuZW5hYmxlX3ZibGFu
ayA9IGk5NjVfZW5hYmxlX3ZibGFuaywKKwkuZGlzYWJsZV92YmxhbmsgPSBpOTY1X2Rpc2FibGVf
dmJsYW5rLAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY3J0Y19mdW5jcyBpOTY1X2Ny
dGNfZnVuY3MgPSB7CisJSU5URUxfQ1JUQ19GVU5DUywKKworCS5nZXRfdmJsYW5rX2NvdW50ZXIg
PSBpOTE1X2dldF92YmxhbmtfY291bnRlciwKKwkuZW5hYmxlX3ZibGFuayA9IGk5NjVfZW5hYmxl
X3ZibGFuaywKKwkuZGlzYWJsZV92YmxhbmsgPSBpOTY1X2Rpc2FibGVfdmJsYW5rLAorfTsKKwor
c3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY3J0Y19mdW5jcyBpOTQ1Z21fY3J0Y19mdW5jcyA9IHsK
KwlJTlRFTF9DUlRDX0ZVTkNTLAorCisJLmdldF92YmxhbmtfY291bnRlciA9IGk5MTVfZ2V0X3Zi
bGFua19jb3VudGVyLAorCS5lbmFibGVfdmJsYW5rID0gaTk0NWdtX2VuYWJsZV92YmxhbmssCisJ
LmRpc2FibGVfdmJsYW5rID0gaTk0NWdtX2Rpc2FibGVfdmJsYW5rLAorfTsKKworc3RhdGljIGNv
bnN0IHN0cnVjdCBkcm1fY3J0Y19mdW5jcyBpOTE1X2NydGNfZnVuY3MgPSB7CisJSU5URUxfQ1JU
Q19GVU5DUywKKworCS5nZXRfdmJsYW5rX2NvdW50ZXIgPSBpOTE1X2dldF92YmxhbmtfY291bnRl
ciwKKwkuZW5hYmxlX3ZibGFuayA9IGk4eHhfZW5hYmxlX3ZibGFuaywKKwkuZGlzYWJsZV92Ymxh
bmsgPSBpOHh4X2Rpc2FibGVfdmJsYW5rLAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1f
Y3J0Y19mdW5jcyBpOHh4X2NydGNfZnVuY3MgPSB7CisJSU5URUxfQ1JUQ19GVU5DUywKKworCS8q
IG5vIGh3IHZibGFuayBjb3VudGVyICovCisJLmVuYWJsZV92YmxhbmsgPSBpOHh4X2VuYWJsZV92
YmxhbmssCisJLmRpc2FibGVfdmJsYW5rID0gaTh4eF9kaXNhYmxlX3ZibGFuaywKK307CisKIHN0
YXRpYyBpbnQgaW50ZWxfY3J0Y19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwgZW51bSBwaXBlIHBpcGUpCiB7CisJY29uc3Qgc3RydWN0IGRybV9jcnRjX2Z1bmNzICpmdW5j
czsKIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YzsKIAlzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSA9IE5VTEw7CiAJc3RydWN0IGludGVsX3BsYW5lICpwcmltYXJ5ID0g
TlVMTDsKQEAgLTE0OTU1LDEwICsxNTAxMSwyOCBAQCBzdGF0aWMgaW50IGludGVsX2NydGNfaW5p
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlwZSBwaXBlKQogCX0K
IAlpbnRlbF9jcnRjLT5wbGFuZV9pZHNfbWFzayB8PSBCSVQoY3Vyc29yLT5pZCk7CiAKKwlpZiAo
SEFTX0dNQ0goZGV2X3ByaXYpKSB7CisJCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSB8fAor
CQkgICAgSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfRzRYKGRldl9wcml2KSkKKwkJCWZ1
bmNzID0gJmc0eF9jcnRjX2Z1bmNzOworCQllbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDQpKQor
CQkJZnVuY3MgPSAmaTk2NV9jcnRjX2Z1bmNzOworCQllbHNlIGlmIChJU19JOTQ1R00oZGV2X3By
aXYpKQorCQkJZnVuY3MgPSAmaTk0NWdtX2NydGNfZnVuY3M7CisJCWVsc2UgaWYgKElTX0dFTihk
ZXZfcHJpdiwgMykpCisJCQlmdW5jcyA9ICZpOTE1X2NydGNfZnVuY3M7CisJCWVsc2UKKwkJCWZ1
bmNzID0gJmk4eHhfY3J0Y19mdW5jczsKKwl9IGVsc2UgeworCQlpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA+PSA4KQorCQkJZnVuY3MgPSAmYmR3X2NydGNfZnVuY3M7CisJCWVsc2UKKwkJCWZ1bmNz
ID0gJmlsa19jcnRjX2Z1bmNzOworCX0KKwogCXJldCA9IGRybV9jcnRjX2luaXRfd2l0aF9wbGFu
ZXMoJmRldl9wcml2LT5kcm0sICZpbnRlbF9jcnRjLT5iYXNlLAogCQkJCQkmcHJpbWFyeS0+YmFz
ZSwgJmN1cnNvci0+YmFzZSwKLQkJCQkJJmludGVsX2NydGNfZnVuY3MsCi0JCQkJCSJwaXBlICVj
IiwgcGlwZV9uYW1lKHBpcGUpKTsKKwkJCQkJZnVuY3MsICJwaXBlICVjIiwgcGlwZV9uYW1lKHBp
cGUpKTsKIAlpZiAocmV0KQogCQlnb3RvIGZhaWw7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfaXJxLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2lycS5jCmlu
ZGV4IGIyZTI3YjViMGRmOS4uNGZiZThkOTA5NTBhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2lycS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmMK
QEAgLTkyNCwxMSArOTI0LDEyIEBAIHN0YXRpYyB2b2lkIGk5MTVfZW5hYmxlX2FzbGVfcGlwZXN0
YXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogLyogQ2FsbGVkIGZyb20gZHJt
IGdlbmVyaWMgY29kZSwgcGFzc2VkIGEgJ2NydGMnLCB3aGljaAogICogd2UgdXNlIGFzIGEgcGlw
ZSBpbmRleAogICovCi1zdGF0aWMgdTMyIGk5MTVfZ2V0X3ZibGFua19jb3VudGVyKHN0cnVjdCBk
cm1fZGV2aWNlICpkZXYsIHVuc2lnbmVkIGludCBwaXBlKQordTMyIGk5MTVfZ2V0X3ZibGFua19j
b3VudGVyKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Ci0Jc3RydWN0IGRybV92YmxhbmtfY3J0YyAqdmJs
YW5rID0gJmRldi0+dmJsYW5rW3BpcGVdOworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoY3J0Yy0+ZGV2KTsKKwlzdHJ1Y3QgZHJtX3ZibGFua19jcnRjICp2Ymxh
bmsgPSAmZGV2X3ByaXYtPmRybS52YmxhbmtbZHJtX2NydGNfaW5kZXgoY3J0YyldOwogCWNvbnN0
IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlID0gJnZibGFuay0+aHdtb2RlOworCWVudW0g
cGlwZSBwaXBlID0gdG9faW50ZWxfY3J0YyhjcnRjKS0+cGlwZTsKIAlpOTE1X3JlZ190IGhpZ2hf
ZnJhbWUsIGxvd19mcmFtZTsKIAl1MzIgaGlnaDEsIGhpZ2gyLCBsb3csIHBpeGVsLCB2Ymxfc3Rh
cnQsIGhzeW5jX3N0YXJ0LCBodG90YWw7CiAJdW5zaWduZWQgbG9uZyBpcnFmbGFnczsKQEAgLTk4
OSw5ICs5OTAsMTAgQEAgc3RhdGljIHUzMiBpOTE1X2dldF92YmxhbmtfY291bnRlcihzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2LCB1bnNpZ25lZCBpbnQgcGlwZSkKIAlyZXR1cm4gKCgoaGlnaDEgPDwg
OCkgfCBsb3cpICsgKHBpeGVsID49IHZibF9zdGFydCkpICYgMHhmZmZmZmY7CiB9CiAKLXN0YXRp
YyB1MzIgZzR4X2dldF92YmxhbmtfY291bnRlcihzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1bnNp
Z25lZCBpbnQgcGlwZSkKK3UzMiBnNHhfZ2V0X3ZibGFua19jb3VudGVyKHN0cnVjdCBkcm1fY3J0
YyAqY3J0YykKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGRldik7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRj
LT5kZXYpOworCWVudW0gcGlwZSBwaXBlID0gdG9faW50ZWxfY3J0YyhjcnRjKS0+cGlwZTsKIAog
CXJldHVybiBJOTE1X1JFQUQoUElQRV9GUk1DT1VOVF9HNFgocGlwZSkpOwogfQpAQCAtMzI0Myw5
ICszMjQ1LDEwIEBAIHN0YXRpYyBpcnFyZXR1cm5fdCBnZW4xMV9pcnFfaGFuZGxlcihpbnQgaXJx
LCB2b2lkICphcmcpCiAvKiBDYWxsZWQgZnJvbSBkcm0gZ2VuZXJpYyBjb2RlLCBwYXNzZWQgJ2Ny
dGMnIHdoaWNoCiAgKiB3ZSB1c2UgYXMgYSBwaXBlIGluZGV4CiAgKi8KLXN0YXRpYyBpbnQgaTh4
eF9lbmFibGVfdmJsYW5rKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHVuc2lnbmVkIGludCBwaXBl
KQoraW50IGk4eHhfZW5hYmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2NydGMgKmNydGMpCiB7Ci0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOworCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+ZGV2KTsKKwllbnVtIHBp
cGUgcGlwZSA9IHRvX2ludGVsX2NydGMoY3J0YyktPnBpcGU7CiAJdW5zaWduZWQgbG9uZyBpcnFm
bGFnczsKIAogCXNwaW5fbG9ja19pcnFzYXZlKCZkZXZfcHJpdi0+aXJxX2xvY2ssIGlycWZsYWdz
KTsKQEAgLTMyNTUsMTkgKzMyNTgsMjAgQEAgc3RhdGljIGludCBpOHh4X2VuYWJsZV92Ymxhbmso
c3RydWN0IGRybV9kZXZpY2UgKmRldiwgdW5zaWduZWQgaW50IHBpcGUpCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgaTk0NWdtX2VuYWJsZV92Ymxhbmsoc3RydWN0IGRybV9kZXZpY2UgKmRl
diwgdW5zaWduZWQgaW50IHBpcGUpCitpbnQgaTk0NWdtX2VuYWJsZV92Ymxhbmsoc3RydWN0IGRy
bV9jcnRjICpjcnRjKQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoZGV2KTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGNydGMtPmRldik7CiAKIAlpZiAoZGV2X3ByaXYtPmk5NDVnbV92YmxhbmsuZW5hYmxlZCsrID09
IDApCiAJCXNjaGVkdWxlX3dvcmsoJmRldl9wcml2LT5pOTQ1Z21fdmJsYW5rLndvcmspOwogCi0J
cmV0dXJuIGk4eHhfZW5hYmxlX3ZibGFuayhkZXYsIHBpcGUpOworCXJldHVybiBpOHh4X2VuYWJs
ZV92YmxhbmsoY3J0Yyk7CiB9CiAKLXN0YXRpYyBpbnQgaTk2NV9lbmFibGVfdmJsYW5rKHN0cnVj
dCBkcm1fZGV2aWNlICpkZXYsIHVuc2lnbmVkIGludCBwaXBlKQoraW50IGk5NjVfZW5hYmxlX3Zi
bGFuayhzdHJ1Y3QgZHJtX2NydGMgKmNydGMpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShkZXYpOworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoY3J0Yy0+ZGV2KTsKKwllbnVtIHBpcGUgcGlwZSA9IHRvX2ludGVsX2Ny
dGMoY3J0YyktPnBpcGU7CiAJdW5zaWduZWQgbG9uZyBpcnFmbGFnczsKIAogCXNwaW5fbG9ja19p
cnFzYXZlKCZkZXZfcHJpdi0+aXJxX2xvY2ssIGlycWZsYWdzKTsKQEAgLTMyNzgsOSArMzI4Miwx
MCBAQCBzdGF0aWMgaW50IGk5NjVfZW5hYmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
LCB1bnNpZ25lZCBpbnQgcGlwZSkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBpcm9ubGFr
ZV9lbmFibGVfdmJsYW5rKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHVuc2lnbmVkIGludCBwaXBl
KQoraW50IGlsa19lbmFibGVfdmJsYW5rKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykKIHsKLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7CisJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5kZXYpOworCWVudW0gcGlw
ZSBwaXBlID0gdG9faW50ZWxfY3J0YyhjcnRjKS0+cGlwZTsKIAl1bnNpZ25lZCBsb25nIGlycWZs
YWdzOwogCXUzMiBiaXQgPSBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDcgPwogCQlERV9QSVBFX1ZC
TEFOS19JVkIocGlwZSkgOiBERV9QSVBFX1ZCTEFOSyhwaXBlKTsKQEAgLTMyOTMsMTQgKzMyOTgs
MTUgQEAgc3RhdGljIGludCBpcm9ubGFrZV9lbmFibGVfdmJsYW5rKHN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYsIHVuc2lnbmVkIGludCBwaXBlKQogCSAqIFBTUiBpcyBhY3RpdmUgYXMgbm8gZnJhbWVz
IGFyZSBnZW5lcmF0ZWQuCiAJICovCiAJaWYgKEhBU19QU1IoZGV2X3ByaXYpKQotCQlkcm1fdmJs
YW5rX3Jlc3RvcmUoZGV2LCBwaXBlKTsKKwkJZHJtX2NydGNfdmJsYW5rX3Jlc3RvcmUoY3J0Yyk7
CiAKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBnZW44X2VuYWJsZV92Ymxhbmsoc3RydWN0
IGRybV9kZXZpY2UgKmRldiwgdW5zaWduZWQgaW50IHBpcGUpCitpbnQgYmR3X2VuYWJsZV92Ymxh
bmsoc3RydWN0IGRybV9jcnRjICpjcnRjKQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGNydGMtPmRldik7CisJZW51bSBwaXBlIHBpcGUgPSB0b19pbnRlbF9jcnRj
KGNydGMpLT5waXBlOwogCXVuc2lnbmVkIGxvbmcgaXJxZmxhZ3M7CiAKIAlzcGluX2xvY2tfaXJx
c2F2ZSgmZGV2X3ByaXYtPmlycV9sb2NrLCBpcnFmbGFncyk7CkBAIC0zMzExLDcgKzMzMTcsNyBA
QCBzdGF0aWMgaW50IGdlbjhfZW5hYmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1
bnNpZ25lZCBpbnQgcGlwZSkKIAkgKiBQU1IgaXMgYWN0aXZlIGFzIG5vIGZyYW1lcyBhcmUgZ2Vu
ZXJhdGVkLCBzbyBjaGVjayBvbmx5IGZvciBQU1IuCiAJICovCiAJaWYgKEhBU19QU1IoZGV2X3By
aXYpKQotCQlkcm1fdmJsYW5rX3Jlc3RvcmUoZGV2LCBwaXBlKTsKKwkJZHJtX2NydGNfdmJsYW5r
X3Jlc3RvcmUoY3J0Yyk7CiAKIAlyZXR1cm4gMDsKIH0KQEAgLTMzMTksOSArMzMyNSwxMCBAQCBz
dGF0aWMgaW50IGdlbjhfZW5hYmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1bnNp
Z25lZCBpbnQgcGlwZSkKIC8qIENhbGxlZCBmcm9tIGRybSBnZW5lcmljIGNvZGUsIHBhc3NlZCAn
Y3J0Yycgd2hpY2gKICAqIHdlIHVzZSBhcyBhIHBpcGUgaW5kZXgKICAqLwotc3RhdGljIHZvaWQg
aTh4eF9kaXNhYmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1bnNpZ25lZCBpbnQg
cGlwZSkKK3ZvaWQgaTh4eF9kaXNhYmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2NydGMgKmNydGMpCiB7
Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOworCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+ZGV2KTsKKwll
bnVtIHBpcGUgcGlwZSA9IHRvX2ludGVsX2NydGMoY3J0YyktPnBpcGU7CiAJdW5zaWduZWQgbG9u
ZyBpcnFmbGFnczsKIAogCXNwaW5fbG9ja19pcnFzYXZlKCZkZXZfcHJpdi0+aXJxX2xvY2ssIGly
cWZsYWdzKTsKQEAgLTMzMjksMTkgKzMzMzYsMjAgQEAgc3RhdGljIHZvaWQgaTh4eF9kaXNhYmxl
X3ZibGFuayhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1bnNpZ25lZCBpbnQgcGlwZSkKIAlzcGlu
X3VubG9ja19pcnFyZXN0b3JlKCZkZXZfcHJpdi0+aXJxX2xvY2ssIGlycWZsYWdzKTsKIH0KIAot
c3RhdGljIHZvaWQgaTk0NWdtX2Rpc2FibGVfdmJsYW5rKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYs
IHVuc2lnbmVkIGludCBwaXBlKQordm9pZCBpOTQ1Z21fZGlzYWJsZV92Ymxhbmsoc3RydWN0IGRy
bV9jcnRjICpjcnRjKQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoZGV2KTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGNydGMtPmRldik7CiAKLQlpOHh4X2Rpc2FibGVfdmJsYW5rKGRldiwgcGlwZSk7CisJaTh4eF9k
aXNhYmxlX3ZibGFuayhjcnRjKTsKIAogCWlmICgtLWRldl9wcml2LT5pOTQ1Z21fdmJsYW5rLmVu
YWJsZWQgPT0gMCkKIAkJc2NoZWR1bGVfd29yaygmZGV2X3ByaXYtPmk5NDVnbV92Ymxhbmsud29y
ayk7CiB9CiAKLXN0YXRpYyB2b2lkIGk5NjVfZGlzYWJsZV92Ymxhbmsoc3RydWN0IGRybV9kZXZp
Y2UgKmRldiwgdW5zaWduZWQgaW50IHBpcGUpCit2b2lkIGk5NjVfZGlzYWJsZV92Ymxhbmsoc3Ry
dWN0IGRybV9jcnRjICpjcnRjKQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZGV2KTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGNydGMtPmRldik7CisJZW51bSBwaXBlIHBpcGUgPSB0b19pbnRlbF9jcnRjKGNydGMp
LT5waXBlOwogCXVuc2lnbmVkIGxvbmcgaXJxZmxhZ3M7CiAKIAlzcGluX2xvY2tfaXJxc2F2ZSgm
ZGV2X3ByaXYtPmlycV9sb2NrLCBpcnFmbGFncyk7CkBAIC0zMzUwLDkgKzMzNTgsMTAgQEAgc3Rh
dGljIHZvaWQgaTk2NV9kaXNhYmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1bnNp
Z25lZCBpbnQgcGlwZSkKIAlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZkZXZfcHJpdi0+aXJxX2xv
Y2ssIGlycWZsYWdzKTsKIH0KIAotc3RhdGljIHZvaWQgaXJvbmxha2VfZGlzYWJsZV92Ymxhbmso
c3RydWN0IGRybV9kZXZpY2UgKmRldiwgdW5zaWduZWQgaW50IHBpcGUpCit2b2lkIGlsa19kaXNh
YmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2NydGMgKmNydGMpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+ZGV2KTsKKwllbnVtIHBpcGUgcGlwZSA9IHRvX2lu
dGVsX2NydGMoY3J0YyktPnBpcGU7CiAJdW5zaWduZWQgbG9uZyBpcnFmbGFnczsKIAl1MzIgYml0
ID0gSU5URUxfR0VOKGRldl9wcml2KSA+PSA3ID8KIAkJREVfUElQRV9WQkxBTktfSVZCKHBpcGUp
IDogREVfUElQRV9WQkxBTksocGlwZSk7CkBAIC0zMzYyLDkgKzMzNzEsMTAgQEAgc3RhdGljIHZv
aWQgaXJvbmxha2VfZGlzYWJsZV92Ymxhbmsoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdW5zaWdu
ZWQgaW50IHBpcGUpCiAJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZGV2X3ByaXYtPmlycV9sb2Nr
LCBpcnFmbGFncyk7CiB9CiAKLXN0YXRpYyB2b2lkIGdlbjhfZGlzYWJsZV92Ymxhbmsoc3RydWN0
IGRybV9kZXZpY2UgKmRldiwgdW5zaWduZWQgaW50IHBpcGUpCit2b2lkIGJkd19kaXNhYmxlX3Zi
bGFuayhzdHJ1Y3QgZHJtX2NydGMgKmNydGMpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShkZXYpOworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoY3J0Yy0+ZGV2KTsKKwllbnVtIHBpcGUgcGlwZSA9IHRvX2ludGVsX2Ny
dGMoY3J0YyktPnBpcGU7CiAJdW5zaWduZWQgbG9uZyBpcnFmbGFnczsKIAogCXNwaW5fbG9ja19p
cnFzYXZlKCZkZXZfcHJpdi0+aXJxX2xvY2ssIGlycWZsYWdzKTsKQEAgLTMzNzIsNyArMzM4Miw3
IEBAIHN0YXRpYyB2b2lkIGdlbjhfZGlzYWJsZV92Ymxhbmsoc3RydWN0IGRybV9kZXZpY2UgKmRl
diwgdW5zaWduZWQgaW50IHBpcGUpCiAJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZGV2X3ByaXYt
PmlycV9sb2NrLCBpcnFmbGFncyk7CiB9CiAKLXN0YXRpYyB2b2lkIGk5NDVnbV92Ymxhbmtfd29y
a19mdW5jKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKK3ZvaWQgaTk0NWdtX3ZibGFua193b3Jr
X2Z1bmMoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9CiAJCWNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSwgaTk0NWdtX3ZibGFuay53b3JrKTsKQEAgLTQ4MDUsMTEgKzQ4MTUsNiBAQCB2b2lkIGlu
dGVsX2lycV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA+PSA4KQogCQlycHMtPnBtX2ludHJtc2tfbWJ6IHw9IEdFTjhfUE1J
TlRSX0RJU0FCTEVfUkVESVJFQ1RfVE9fR1VDOwogCi0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gNSB8fCBJU19HNFgoZGV2X3ByaXYpKQotCQlkZXYtPmRyaXZlci0+Z2V0X3ZibGFua19jb3Vu
dGVyID0gZzR4X2dldF92YmxhbmtfY291bnRlcjsKLQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDMpCi0JCWRldi0+ZHJpdmVyLT5nZXRfdmJsYW5rX2NvdW50ZXIgPSBpOTE1X2dldF92
YmxhbmtfY291bnRlcjsKLQogCWRldi0+dmJsYW5rX2Rpc2FibGVfaW1tZWRpYXRlID0gdHJ1ZTsK
IAogCS8qIE1vc3QgcGxhdGZvcm1zIHRyZWF0IHRoZSBkaXNwbGF5IGlycSBibG9jayBhcyBhbiBh
bHdheXMtb24KQEAgLTQ4MzksMzIgKzQ4NDQsMjQgQEAgdm9pZCBpbnRlbF9pcnFfaW5pdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJCWRldi0+ZHJpdmVyLT5pcnFfcHJlaW5z
dGFsbCA9IGNoZXJyeXZpZXdfaXJxX3Jlc2V0OwogCQlkZXYtPmRyaXZlci0+aXJxX3Bvc3RpbnN0
YWxsID0gY2hlcnJ5dmlld19pcnFfcG9zdGluc3RhbGw7CiAJCWRldi0+ZHJpdmVyLT5pcnFfdW5p
bnN0YWxsID0gY2hlcnJ5dmlld19pcnFfcmVzZXQ7Ci0JCWRldi0+ZHJpdmVyLT5lbmFibGVfdmJs
YW5rID0gaTk2NV9lbmFibGVfdmJsYW5rOwotCQlkZXYtPmRyaXZlci0+ZGlzYWJsZV92Ymxhbmsg
PSBpOTY1X2Rpc2FibGVfdmJsYW5rOwogCQlkZXZfcHJpdi0+ZGlzcGxheS5ocGRfaXJxX3NldHVw
ID0gaTkxNV9ocGRfaXJxX3NldHVwOwogCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJp
dikpIHsKIAkJZGV2LT5kcml2ZXItPmlycV9oYW5kbGVyID0gdmFsbGV5dmlld19pcnFfaGFuZGxl
cjsKIAkJZGV2LT5kcml2ZXItPmlycV9wcmVpbnN0YWxsID0gdmFsbGV5dmlld19pcnFfcmVzZXQ7
CiAJCWRldi0+ZHJpdmVyLT5pcnFfcG9zdGluc3RhbGwgPSB2YWxsZXl2aWV3X2lycV9wb3N0aW5z
dGFsbDsKIAkJZGV2LT5kcml2ZXItPmlycV91bmluc3RhbGwgPSB2YWxsZXl2aWV3X2lycV9yZXNl
dDsKLQkJZGV2LT5kcml2ZXItPmVuYWJsZV92YmxhbmsgPSBpOTY1X2VuYWJsZV92Ymxhbms7Ci0J
CWRldi0+ZHJpdmVyLT5kaXNhYmxlX3ZibGFuayA9IGk5NjVfZGlzYWJsZV92Ymxhbms7CiAJCWRl
dl9wcml2LT5kaXNwbGF5LmhwZF9pcnFfc2V0dXAgPSBpOTE1X2hwZF9pcnFfc2V0dXA7CiAJfSBl
bHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKSB7CiAJCWRldi0+ZHJpdmVyLT5pcnFf
aGFuZGxlciA9IGdlbjExX2lycV9oYW5kbGVyOwogCQlkZXYtPmRyaXZlci0+aXJxX3ByZWluc3Rh
bGwgPSBnZW4xMV9pcnFfcmVzZXQ7CiAJCWRldi0+ZHJpdmVyLT5pcnFfcG9zdGluc3RhbGwgPSBn
ZW4xMV9pcnFfcG9zdGluc3RhbGw7CiAJCWRldi0+ZHJpdmVyLT5pcnFfdW5pbnN0YWxsID0gZ2Vu
MTFfaXJxX3Jlc2V0OwotCQlkZXYtPmRyaXZlci0+ZW5hYmxlX3ZibGFuayA9IGdlbjhfZW5hYmxl
X3ZibGFuazsKLQkJZGV2LT5kcml2ZXItPmRpc2FibGVfdmJsYW5rID0gZ2VuOF9kaXNhYmxlX3Zi
bGFuazsKIAkJZGV2X3ByaXYtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCA9IGdlbjExX2hwZF9pcnFf
c2V0dXA7CiAJfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDgpIHsKIAkJZGV2LT5k
cml2ZXItPmlycV9oYW5kbGVyID0gZ2VuOF9pcnFfaGFuZGxlcjsKIAkJZGV2LT5kcml2ZXItPmly
cV9wcmVpbnN0YWxsID0gZ2VuOF9pcnFfcmVzZXQ7CiAJCWRldi0+ZHJpdmVyLT5pcnFfcG9zdGlu
c3RhbGwgPSBnZW44X2lycV9wb3N0aW5zdGFsbDsKIAkJZGV2LT5kcml2ZXItPmlycV91bmluc3Rh
bGwgPSBnZW44X2lycV9yZXNldDsKLQkJZGV2LT5kcml2ZXItPmVuYWJsZV92YmxhbmsgPSBnZW44
X2VuYWJsZV92Ymxhbms7Ci0JCWRldi0+ZHJpdmVyLT5kaXNhYmxlX3ZibGFuayA9IGdlbjhfZGlz
YWJsZV92Ymxhbms7CiAJCWlmIChJU19HRU45X0xQKGRldl9wcml2KSkKIAkJCWRldl9wcml2LT5k
aXNwbGF5LmhwZF9pcnFfc2V0dXAgPSBieHRfaHBkX2lycV9zZXR1cDsKIAkJZWxzZSBpZiAoSU5U
RUxfUENIX1RZUEUoZGV2X3ByaXYpID49IFBDSF9TUFQpCkBAIC00ODc2LDggKzQ4NzMsNiBAQCB2
b2lkIGludGVsX2lycV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAkJ
ZGV2LT5kcml2ZXItPmlycV9wcmVpbnN0YWxsID0gaXJvbmxha2VfaXJxX3Jlc2V0OwogCQlkZXYt
PmRyaXZlci0+aXJxX3Bvc3RpbnN0YWxsID0gaXJvbmxha2VfaXJxX3Bvc3RpbnN0YWxsOwogCQlk
ZXYtPmRyaXZlci0+aXJxX3VuaW5zdGFsbCA9IGlyb25sYWtlX2lycV9yZXNldDsKLQkJZGV2LT5k
cml2ZXItPmVuYWJsZV92YmxhbmsgPSBpcm9ubGFrZV9lbmFibGVfdmJsYW5rOwotCQlkZXYtPmRy
aXZlci0+ZGlzYWJsZV92YmxhbmsgPSBpcm9ubGFrZV9kaXNhYmxlX3ZibGFuazsKIAkJZGV2X3By
aXYtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCA9IGlsa19ocGRfaXJxX3NldHVwOwogCX0gZWxzZSB7
CiAJCWlmIChJU19HRU4oZGV2X3ByaXYsIDIpKSB7CkBAIC00ODg1LDI5ICs0ODgwLDIxIEBAIHZv
aWQgaW50ZWxfaXJxX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCQkJ
ZGV2LT5kcml2ZXItPmlycV9wb3N0aW5zdGFsbCA9IGk4eHhfaXJxX3Bvc3RpbnN0YWxsOwogCQkJ
ZGV2LT5kcml2ZXItPmlycV9oYW5kbGVyID0gaTh4eF9pcnFfaGFuZGxlcjsKIAkJCWRldi0+ZHJp
dmVyLT5pcnFfdW5pbnN0YWxsID0gaTh4eF9pcnFfcmVzZXQ7Ci0JCQlkZXYtPmRyaXZlci0+ZW5h
YmxlX3ZibGFuayA9IGk4eHhfZW5hYmxlX3ZibGFuazsKLQkJCWRldi0+ZHJpdmVyLT5kaXNhYmxl
X3ZibGFuayA9IGk4eHhfZGlzYWJsZV92Ymxhbms7CiAJCX0gZWxzZSBpZiAoSVNfSTk0NUdNKGRl
dl9wcml2KSkgewogCQkJZGV2LT5kcml2ZXItPmlycV9wcmVpbnN0YWxsID0gaTkxNV9pcnFfcmVz
ZXQ7CiAJCQlkZXYtPmRyaXZlci0+aXJxX3Bvc3RpbnN0YWxsID0gaTkxNV9pcnFfcG9zdGluc3Rh
bGw7CiAJCQlkZXYtPmRyaXZlci0+aXJxX3VuaW5zdGFsbCA9IGk5MTVfaXJxX3Jlc2V0OwogCQkJ
ZGV2LT5kcml2ZXItPmlycV9oYW5kbGVyID0gaTkxNV9pcnFfaGFuZGxlcjsKLQkJCWRldi0+ZHJp
dmVyLT5lbmFibGVfdmJsYW5rID0gaTk0NWdtX2VuYWJsZV92Ymxhbms7Ci0JCQlkZXYtPmRyaXZl
ci0+ZGlzYWJsZV92YmxhbmsgPSBpOTQ1Z21fZGlzYWJsZV92Ymxhbms7CiAJCX0gZWxzZSBpZiAo
SVNfR0VOKGRldl9wcml2LCAzKSkgewogCQkJZGV2LT5kcml2ZXItPmlycV9wcmVpbnN0YWxsID0g
aTkxNV9pcnFfcmVzZXQ7CiAJCQlkZXYtPmRyaXZlci0+aXJxX3Bvc3RpbnN0YWxsID0gaTkxNV9p
cnFfcG9zdGluc3RhbGw7CiAJCQlkZXYtPmRyaXZlci0+aXJxX3VuaW5zdGFsbCA9IGk5MTVfaXJx
X3Jlc2V0OwogCQkJZGV2LT5kcml2ZXItPmlycV9oYW5kbGVyID0gaTkxNV9pcnFfaGFuZGxlcjsK
LQkJCWRldi0+ZHJpdmVyLT5lbmFibGVfdmJsYW5rID0gaTh4eF9lbmFibGVfdmJsYW5rOwotCQkJ
ZGV2LT5kcml2ZXItPmRpc2FibGVfdmJsYW5rID0gaTh4eF9kaXNhYmxlX3ZibGFuazsKIAkJfSBl
bHNlIHsKIAkJCWRldi0+ZHJpdmVyLT5pcnFfcHJlaW5zdGFsbCA9IGk5NjVfaXJxX3Jlc2V0Owog
CQkJZGV2LT5kcml2ZXItPmlycV9wb3N0aW5zdGFsbCA9IGk5NjVfaXJxX3Bvc3RpbnN0YWxsOwog
CQkJZGV2LT5kcml2ZXItPmlycV91bmluc3RhbGwgPSBpOTY1X2lycV9yZXNldDsKIAkJCWRldi0+
ZHJpdmVyLT5pcnFfaGFuZGxlciA9IGk5NjVfaXJxX2hhbmRsZXI7Ci0JCQlkZXYtPmRyaXZlci0+
ZW5hYmxlX3ZibGFuayA9IGk5NjVfZW5hYmxlX3ZibGFuazsKLQkJCWRldi0+ZHJpdmVyLT5kaXNh
YmxlX3ZibGFuayA9IGk5NjVfZGlzYWJsZV92Ymxhbms7CiAJCX0KIAkJaWYgKEk5MTVfSEFTX0hP
VFBMVUcoZGV2X3ByaXYpKQogCQkJZGV2X3ByaXYtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCA9IGk5
MTVfaHBkX2lycV9zZXR1cDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
aXJxLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2lycS5oCmluZGV4IGNiMjVkZDIxMzMw
OC4uZWY3ODJlNWFiMjQwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2ly
cS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmgKQEAgLTExNCw0ICsxMTQs
MTggQEAgdm9pZCBnZW4xMV9yZXNldF9ndWNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSk7CiB2b2lkIGdlbjExX2VuYWJsZV9ndWNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSk7CiB2b2lkIGdlbjExX2Rpc2FibGVfZ3VjX2ludGVycnVwdHMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwogCit1MzIgaTkxNV9nZXRfdmJsYW5rX2Nv
dW50ZXIoc3RydWN0IGRybV9jcnRjICpjcnRjKTsKK3UzMiBnNHhfZ2V0X3ZibGFua19jb3VudGVy
KHN0cnVjdCBkcm1fY3J0YyAqY3J0Yyk7CisKK2ludCBpOHh4X2VuYWJsZV92Ymxhbmsoc3RydWN0
IGRybV9jcnRjICpjcnRjKTsKK2ludCBpOTQ1Z21fZW5hYmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2Ny
dGMgKmNydGMpOworaW50IGk5NjVfZW5hYmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2NydGMgKmNydGMp
OworaW50IGlsa19lbmFibGVfdmJsYW5rKHN0cnVjdCBkcm1fY3J0YyAqY3J0Yyk7CitpbnQgYmR3
X2VuYWJsZV92Ymxhbmsoc3RydWN0IGRybV9jcnRjICpjcnRjKTsKK3ZvaWQgaTh4eF9kaXNhYmxl
X3ZibGFuayhzdHJ1Y3QgZHJtX2NydGMgKmNydGMpOwordm9pZCBpOTQ1Z21fZGlzYWJsZV92Ymxh
bmsoc3RydWN0IGRybV9jcnRjICpjcnRjKTsKK3ZvaWQgaTk2NV9kaXNhYmxlX3ZibGFuayhzdHJ1
Y3QgZHJtX2NydGMgKmNydGMpOwordm9pZCBpbGtfZGlzYWJsZV92Ymxhbmsoc3RydWN0IGRybV9j
cnRjICpjcnRjKTsKK3ZvaWQgYmR3X2Rpc2FibGVfdmJsYW5rKHN0cnVjdCBkcm1fY3J0YyAqY3J0
Yyk7CisKICNlbmRpZiAvKiBfX0k5MTVfSVJRX0hfXyAqLwotLSAKMi4yMS4wCgpfX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBs
aXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVz
a3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

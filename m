Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id DF6D94A62F
	for <lists+intel-gfx@lfdr.de>; Tue, 18 Jun 2019 18:06:47 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3F20D6E18F;
	Tue, 18 Jun 2019 16:06:46 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga14.intel.com (mga14.intel.com [192.55.52.115])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 58B3F6E18F
 for <intel-gfx@lists.freedesktop.org>; Tue, 18 Jun 2019 16:06:44 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga001.fm.intel.com ([10.253.24.23])
 by fmsmga103.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 18 Jun 2019 09:06:43 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,389,1557212400"; d="scan'208";a="181422478"
Received: from gaia.fi.intel.com ([10.237.72.169])
 by fmsmga001.fm.intel.com with ESMTP; 18 Jun 2019 09:06:42 -0700
Received: by gaia.fi.intel.com (Postfix, from userid 1000)
 id 0FD995C1EC4; Tue, 18 Jun 2019 19:06:36 +0300 (EEST)
From: Mika Kuoppala <mika.kuoppala@linux.intel.com>
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
In-Reply-To: <20190618074153.16055-2-chris@chris-wilson.co.uk>
References: <20190618074153.16055-1-chris@chris-wilson.co.uk>
 <20190618074153.16055-2-chris@chris-wilson.co.uk>
Date: Tue, 18 Jun 2019 19:06:36 +0300
Message-ID: <87muie7u9f.fsf@gaia.fi.intel.com>
MIME-Version: 1.0
Subject: Re: [Intel-gfx] [PATCH 02/26] drm/i915: Skip shrinking already
 freed pages
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Q2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+IHdyaXRlczoKCj4gUHJldmlv
dXNseSwgd2Ugd2FudCB0byBzaHJpbmsgdGhlIHBhZ2VzIG9mIGZyZWVkIG9iamVjdHMgYmVmb3Jl
IHRoZXkKPiB3ZXJlIFJDVSBjb2xsZWN0ZWQuIEhvd2V2ZXIsIGJ5IHJlbW92aW5nIHRoZSBzdHJ1
Y3RfbXV0ZXggc2VyaWFsaXNhdGlvbgo+IGFyb3VuZCB0aGUgYWN0aXZlIHJlZmVyZW5jZSwgd2Ug
bmVlZCB0byBhY3F1aXJlIGFuIGV4dHJhIHJlZmVyZW5jZQo+IGFyb3VuZCB0aGUgd2FpdC4gVW5m
b3J0dW5hdGVseSB0aGlzIG1lYW5zIHRoYXQgd2UgaGF2ZSB0byBza2lwIG9iamVjdHMKPiB0aGF0
IGFyZSB3YWl0aW5nIFJDVSBjb2xsZWN0aW9uLgo+Cj4gU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2ls
c29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Cj4gLS0tCj4gIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYyAgIHwgNDcgKy0tLS0tLS0tLS0tLS0tLS0tLS0KPiAg
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3Nocmlua2VyLmMgfCAgNSArKysKPiAg
MiBmaWxlcyBjaGFuZ2VkLCA2IGluc2VydGlvbnMoKyksIDQ2IGRlbGV0aW9ucygtKQo+Cj4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYwo+IGluZGV4IDI3MmNlMzBj
ZTFkMy4uMWI1NzFmZDI2ZWQ0IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9vYmplY3QuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV9vYmplY3QuYwo+IEBAIC0xNDksMzMgKzE0OSw2IEBAIHZvaWQgaTkxNV9nZW1fY2xvc2Vf
b2JqZWN0KHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqZ2VtLCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUp
Cj4gIAl9Cj4gIH0KPiAgCj4gLXN0YXRpYyBib29sIGRpc2NhcmRfYmFja2luZ19zdG9yYWdlKHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCj4gLXsKPiAtCS8qCj4gLQkgKiBJZiB3ZSBh
cmUgdGhlIGxhc3QgdXNlciBvZiB0aGUgYmFja2luZyBzdG9yYWdlIChiZSBpdCBzaG1lbWZzCj4g
LQkgKiBwYWdlcyBvciBzdG9sZW4gZXRjKSwgd2Uga25vdyB0aGF0IHRoZSBwYWdlcyBhcmUgZ29p
bmcgdG8gYmUKPiAtCSAqIGltbWVkaWF0ZWx5IHJlbGVhc2VkLiBJbiB0aGlzIGNhc2UsIHdlIGNh
biB0aGVuIHNraXAgY29weWluZwo+IC0JICogYmFjayB0aGUgY29udGVudHMgZnJvbSB0aGUgR1BV
Lgo+IC0JICovCj4gLQlpZiAoIWk5MTVfZ2VtX29iamVjdF9pc19zaHJpbmthYmxlKG9iaikpCj4g
LQkJcmV0dXJuIGZhbHNlOwo+IC0KPiAtCWlmIChvYmotPm1tLm1hZHYgIT0gSTkxNV9NQURWX1dJ
TExORUVEKQo+IC0JCXJldHVybiBmYWxzZTsKPiAtCj4gLQlpZiAoIW9iai0+YmFzZS5maWxwKQo+
IC0JCXJldHVybiB0cnVlOwo+IC0KPiAtCS8qIEF0IGZpcnN0IGdsYW5jZSwgdGhpcyBsb29rcyBy
YWN5LCBidXQgdGhlbiBhZ2FpbiBzbyB3b3VsZCBiZQo+IC0JICogdXNlcnNwYWNlIHJhY2luZyBt
bWFwIGFnYWluc3QgY2xvc2UuIEhvd2V2ZXIsIHRoZSBmaXJzdCBleHRlcm5hbAo+IC0JICogcmVm
ZXJlbmNlIHRvIHRoZSBmaWxwIGNhbiBvbmx5IGJlIG9idGFpbmVkIHRocm91Z2ggdGhlCj4gLQkg
KiBpOTE1X2dlbV9tbWFwX2lvY3RsKCkgd2hpY2ggc2FmZWd1YXJkcyB1cyBhZ2FpbnN0IHRoZSB1
c2VyCj4gLQkgKiBhY3F1aXJpbmcgc3VjaCBhIHJlZmVyZW5jZSB3aGlsc3Qgd2UgYXJlIGluIHRo
ZSBtaWRkbGUgb2YKPiAtCSAqIGZyZWVpbmcgdGhlIG9iamVjdC4KPiAtCSAqLwo+IC0JcmV0dXJu
IGZpbGVfY291bnQob2JqLT5iYXNlLmZpbHApID09IDE7Cj4gLX0KPiAtCj4gIHN0YXRpYyB2b2lk
IF9faTkxNV9nZW1fZnJlZV9vYmplY3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+
ICAJCQkJICAgIHN0cnVjdCBsbGlzdF9ub2RlICpmcmVlZCkKPiAgewo+IEBAIC0yMjUsOCArMTk4
LDcgQEAgc3RhdGljIHZvaWQgX19pOTE1X2dlbV9mcmVlX29iamVjdHMoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gIAkJaWYgKG9iai0+b3BzLT5yZWxlYXNlKQo+ICAJCQlvYmotPm9w
cy0+cmVsZWFzZShvYmopOwo+ICAKPiAtCQlpZiAoV0FSTl9PTihpOTE1X2dlbV9vYmplY3RfaGFz
X3Bpbm5lZF9wYWdlcyhvYmopKSkKPiAtCQkJYXRvbWljX3NldCgmb2JqLT5tbS5wYWdlc19waW5f
Y291bnQsIDApOwo+ICsJCWF0b21pY19zZXQoJm9iai0+bW0ucGFnZXNfcGluX2NvdW50LCAwKTsK
PiAgCQlfX2k5MTVfZ2VtX29iamVjdF9wdXRfcGFnZXMob2JqLCBJOTE1X01NX05PUk1BTCk7Cj4g
IAkJR0VNX0JVR19PTihpOTE1X2dlbV9vYmplY3RfaGFzX3BhZ2VzKG9iaikpOwo+ICAKPiBAQCAt
MzI0LDIzICsyOTYsNiBAQCB2b2lkIGk5MTVfZ2VtX2ZyZWVfb2JqZWN0KHN0cnVjdCBkcm1fZ2Vt
X29iamVjdCAqZ2VtX29iaikKPiAgewo+ICAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
aiA9IHRvX2ludGVsX2JvKGdlbV9vYmopOwo+ICAKPiAtCWlmIChvYmotPm1tLnF1aXJrZWQpCj4g
LQkJX19pOTE1X2dlbV9vYmplY3RfdW5waW5fcGFnZXMob2JqKTsKPiAtCj4gLQlpZiAoZGlzY2Fy
ZF9iYWNraW5nX3N0b3JhZ2Uob2JqKSkgewo+IC0JCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShvYmotPmJhc2UuZGV2KTsKPiAtCj4gLQkJb2JqLT5tbS5tYWR2ID0gSTkx
NV9NQURWX0RPTlRORUVEOwo+IC0KPiAtCQlpZiAoaTkxNV9nZW1fb2JqZWN0X2hhc19wYWdlcyhv
YmopKSB7Cj4gLQkJCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4gLQo+IC0JCQlzcGluX2xvY2tfaXJx
c2F2ZSgmaTkxNS0+bW0ub2JqX2xvY2ssIGZsYWdzKTsKPiAtCQkJbGlzdF9tb3ZlX3RhaWwoJm9i
ai0+bW0ubGluaywgJmk5MTUtPm1tLnB1cmdlX2xpc3QpOwo+IC0JCQlzcGluX3VubG9ja19pcnFy
ZXN0b3JlKCZpOTE1LT5tbS5vYmpfbG9jaywgZmxhZ3MpOwo+IC0JCX0KPiAtCX0KPiAtCj4gIAkv
Kgo+ICAJICogQmVmb3JlIHdlIGZyZWUgdGhlIG9iamVjdCwgbWFrZSBzdXJlIGFueSBwdXJlIFJD
VS1vbmx5Cj4gIAkgKiByZWFkLXNpZGUgY3JpdGljYWwgc2VjdGlvbnMgYXJlIGNvbXBsZXRlLCBl
LmcuCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9zaHJp
bmtlci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3Nocmlua2VyLmMKPiBp
bmRleCBjODUxYzQwMjk1OTcuLjNhOTI2YTg3NTVjNiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fc2hyaW5rZXIuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9zaHJpbmtlci5jCj4gQEAgLTI0MSw2ICsyNDEsOSBAQCBpOTE1
X2dlbV9zaHJpbmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gIAkJCWlmICghY2Fu
X3JlbGVhc2VfcGFnZXMob2JqKSkKPiAgCQkJCWNvbnRpbnVlOwo+ICAKPiArCQkJaWYgKCFrcmVm
X2dldF91bmxlc3NfemVybygmb2JqLT5iYXNlLnJlZmNvdW50KSkKPiArCQkJCWNvbnRpbnVlOwo+
ICsKClRoZSBjb21tZW50IGFib3ZlLCBpbiB0aGlzIGZ1bmN0aW9uLCBzZWVtcyBhIGxpdHRsZSBi
aXQKc3RhbGUgb24gdGFsa2luZyBhYm91dCBzdHJ1Y3QgbXV0ZXguIFN0cmFpZ2h0ZW4gaXQgdXAu
CgpSZXZpZXdlZC1ieTogTWlrYSBLdW9wcGFsYSA8bWlrYS5rdW9wcGFsYUBsaW51eC5pbnRlbC5j
b20+Cgo+ICAJCQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpOTE1LT5tbS5vYmpfbG9jaywgZmxh
Z3MpOwo+ICAKPiAgCQkJaWYgKHVuc2FmZV9kcm9wX3BhZ2VzKG9iaikpIHsKPiBAQCAtMjUzLDcg
KzI1Niw5IEBAIGk5MTVfZ2VtX3NocmluayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
PiAgCQkJCX0KPiAgCQkJCW11dGV4X3VubG9jaygmb2JqLT5tbS5sb2NrKTsKPiAgCQkJfQo+ICsK
PiAgCQkJc2Nhbm5lZCArPSBvYmotPmJhc2Uuc2l6ZSA+PiBQQUdFX1NISUZUOwo+ICsJCQlpOTE1
X2dlbV9vYmplY3RfcHV0KG9iaik7Cj4gIAo+ICAJCQlzcGluX2xvY2tfaXJxc2F2ZSgmaTkxNS0+
bW0ub2JqX2xvY2ssIGZsYWdzKTsKPiAgCQl9Cj4gLS0gCj4gMi4yMC4xCl9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QK
SW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9w
Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

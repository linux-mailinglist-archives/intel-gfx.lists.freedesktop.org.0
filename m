Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 8A6F22C331F
	for <lists+intel-gfx@lfdr.de>; Tue, 24 Nov 2020 22:38:50 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 763A389FC0;
	Tue, 24 Nov 2020 21:38:47 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (unknown [77.68.26.236])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 3949489FC0
 for <intel-gfx@lists.freedesktop.org>; Tue, 24 Nov 2020 21:38:44 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from build.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 23097102-1500050 
 for multiple; Tue, 24 Nov 2020 21:38:34 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 24 Nov 2020 21:38:32 +0000
Message-Id: <20201124213832.23149-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20201123162717.21845-1-chris@chris-wilson.co.uk>
References: <20201123162717.21845-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915/display: Record the plane update times
 for debugging
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Chris Wilson <chris@chris-wilson.co.uk>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

U2luY2Ugd2UgdHJ5IGFuZCBlc3RpbWF0ZSBob3cgbG9uZyB3ZSByZXF1aXJlIHRvIHVwZGF0ZSB0
aGUgcmVnaXN0ZXJzIHRvCnBlcmZvcm0gYSBwbGFuZSB1cGRhdGUsIGl0IGlzIG9mIHZpdGFsIGlt
cG9ydGFuY2UgdGhhdCB3ZSBtZWFzdXJlIHRoZQpkaXN0cmlidXRpb24gb2YgcGxhbmUgdXBkYXRl
cyB0byBiZXR0ZXIgZ3VpZGUgb3VyIGVzdGltYXRlLiBJZiB3ZQp1bmRlcmVzdGltYXRlIGhvdyBs
b25nIGl0IHRha2VzIHRvIHBlcmZvcm0gdGhlIHBsYW5lIHVwZGF0ZSwgd2UgbWF5CnNsaXAgaW50
byB0aGUgbmV4dCBzY2Fub3V0IGZyYW1lIGNhdXNpbmcgYSB0ZWFyLiBJZiB3ZSBvdmVyZXN0aW1h
dGUsIHdlCm1heSB1bm5lY2Vzc2FyaWx5IGRlbGF5IHRoZSB1cGRhdGUgdG8gdGhlIG5leHQgZnJh
bWUsIGNhdXNpbmcgdmlzaWJsZQpqaXR0ZXIuCgpSZXBsYWNlIHRoZSB3YXJuaW5nIHRoYXQgd2Ug
ZXhjZWVkIHNvbWUgYXJiaXRyYXJ5IHRocmVzaG9sZCBmb3IgdGhlCnZibGFuayB1cGRhdGUgd2l0
aCBhIGhpc3RvZ3JhbSBmb3IgZGVidWdmcy4KCkNsb3NlczogaHR0cHM6Ly9naXRsYWIuZnJlZWRl
c2t0b3Aub3JnL2RybS9pbnRlbC8tL2lzc3Vlcy8xOTgyClNpZ25lZC1vZmYtYnk6IENocmlzIFdp
bHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgpDYzogSmFuaSBOaWt1bGEgPGphbmkubmlr
dWxhQGxpbnV4LmludGVsLmNvbT4KQ2M6IFZpbGxlIFN5cmrDpGzDpCA8dmlsbGUuc3lyamFsYUBs
aW51eC5pbnRlbC5jb20+Ci0tLQogLi4uL2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV9k
ZWJ1Z2ZzLmMgIHwgNDcgKysrKysrKysrKysrKysrKysrKwogLi4uL2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfZGlzcGxheV90eXBlcy5oICAgIHwgIDcgKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX3Nwcml0ZS5jICAgfCAyOSArKysrKysrKystLS0KIDMgZmlsZXMgY2hhbmdl
ZCwgNzYgaW5zZXJ0aW9ucygrKSwgNyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfZGVidWdmcy5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X2RlYnVnZnMuYwppbmRleCBjYTQxZThj
MDBhZDcuLmIyOTEzNjIwOGQ1NiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kaXNwbGF5X2RlYnVnZnMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2Rpc3BsYXlfZGVidWdmcy5jCkBAIC04NjUsNiArODY1LDUxIEBAIHN0YXRp
YyB2b2lkIGludGVsX3NjYWxlcl9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgc3RydWN0IGludGVs
X2NydGMgKmNydGMpCiAJfQogfQogCisjaWZkZWYgQ09ORklHX0RSTV9JOTE1X0RFQlVHX1ZCTEFO
S19FVkFERQorc3RhdGljIHZvaWQgY3J0Y192YmxhbmtfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0s
IHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQoreworCWNoYXIgYnVmW0FSUkFZX1NJWkUoY3J0Yy0+
ZGVidWcudmJsX3RpbWVzKSArIDFdID0ge307CisJaW50IGgsIHJvdywgbWF4OworCXU2NCBjb3Vu
dDsKKworCW1heCA9IDA7CisJY291bnQgPSAwOworCWZvciAoaCA9IDA7IGggPCBBUlJBWV9TSVpF
KGNydGMtPmRlYnVnLnZibF90aW1lcyk7IGgrKykgeworCQlpZiAoY3J0Yy0+ZGVidWcudmJsX3Rp
bWVzW2hdID4gbWF4KQorCQkJbWF4ID0gY3J0Yy0+ZGVidWcudmJsX3RpbWVzW2hdOworCQljb3Vu
dCArPSBjcnRjLT5kZWJ1Zy52YmxfdGltZXNbaF07CisJfQorCXNlcV9wcmludGYobSwgIlx0VXBk
YXRlczogJWxsdVxuIiwgY291bnQpOworCWlmICghY291bnQpCisJCXJldHVybjsKKworCW1lbXNl
dChidWYsICctJywgc2l6ZW9mKGJ1ZikgLSAxKTsKKwlzZXFfcHJpbnRmKG0sICJcdCAgfCVzfFxu
IiwgYnVmKTsKKworCWZvciAocm93ID0gaWxvZzIobWF4KSAtIDE7IHJvdzsgcm93LS0pIHsKKwkJ
bWVtc2V0KGJ1ZiwgJyAnLCBzaXplb2YoYnVmKSAtIDEpOworCQlmb3IgKGggPSAwOyBoIDwgQVJS
QVlfU0laRShjcnRjLT5kZWJ1Zy52YmxfdGltZXMpOyBoKyspIHsKKwkJCWlmIChpbG9nMihjcnRj
LT5kZWJ1Zy52YmxfdGltZXNbaF0pID49IHJvdykKKwkJCQlidWZbaF0gPSAnKic7CisJCX0KKwkJ
c2VxX3ByaW50ZihtLCAiXHQgIHwlc3xcbiIsIGJ1Zik7CisJfQorCisJbWVtc2V0KGJ1ZiwgJy0n
LCBzaXplb2YoYnVmKSAtIDEpOworCXNlcV9wcmludGYobSwgIlx0ICB8JXN8XG4iLCBidWYpOwor
CXNlcV9wcmludGYobSwgIlx0ICAgIDF1cyAgICAgKGxvZykgICAgICAxbXNcbiIpOworCisJc2Vx
X3ByaW50ZihtLCAiXHRNaW4gdXBkYXRlOiAlbGx1bnNcbiIsIGNydGMtPmRlYnVnLm1pbl92Ymxf
dGltZSk7CisJc2VxX3ByaW50ZihtLCAiXHRNYXggdXBkYXRlOiAlbGx1bnNcbiIsIGNydGMtPmRl
YnVnLm1heF92YmxfdGltZSk7CisJc2VxX3ByaW50ZihtLCAiXHRBdmVyYWdlIHVwZGF0ZTogJWxs
dW5zXG4iLAorCQkgICBkaXY2NF91NjQoY3J0Yy0+ZGVidWcuc3VtX3ZibF90aW1lLCAgY291bnQp
KTsKKwlzZXFfcHJpbnRmKG0sICJcdE92ZXJydW5zID4gJXV1czogJWx1XG4iLAorCQkgICBWQkxB
TktfRVZBU0lPTl9USU1FX1VTLCBjcnRjLT5kZWJ1Zy5vdmVyX3ZibF90aW1lKTsKK30KKyNlbHNl
CitzdGF0aWMgdm9pZCBjcnRjX3ZibGFua19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgc3RydWN0
IGludGVsX2NydGMgKmNydGMpIHt9CisjZW5kaWYKKwogc3RhdGljIHZvaWQgaW50ZWxfY3J0Y19p
bmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgc3RydWN0IGludGVsX2NydGMgKmNydGMpCiB7CiAJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUp
OwpAQCAtOTA3LDYgKzk1Miw4IEBAIHN0YXRpYyB2b2lkIGludGVsX2NydGNfaW5mbyhzdHJ1Y3Qg
c2VxX2ZpbGUgKm0sIHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQogCXNlcV9wcmludGYobSwgIlx0
dW5kZXJydW4gcmVwb3J0aW5nOiBjcHU9JXMgcGNoPSVzXG4iLAogCQkgICB5ZXNubyghY3J0Yy0+
Y3B1X2ZpZm9fdW5kZXJydW5fZGlzYWJsZWQpLAogCQkgICB5ZXNubyghY3J0Yy0+cGNoX2ZpZm9f
dW5kZXJydW5fZGlzYWJsZWQpKTsKKworCWNydGNfdmJsYW5rX2luZm8obSwgY3J0Yyk7CiB9CiAK
IHN0YXRpYyBpbnQgaTkxNV9kaXNwbGF5X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1
bnVzZWQpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rp
c3BsYXlfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxh
eV90eXBlcy5oCmluZGV4IGNlODJkNjU0ZDBmMi4uZWZiYjdjNjFlNmZiIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaAorKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaApAQCAtMTE4
Niw2ICsxMTg2LDEzIEBAIHN0cnVjdCBpbnRlbF9jcnRjIHsKIAkJa3RpbWVfdCBzdGFydF92Ymxf
dGltZTsKIAkJaW50IG1pbl92YmwsIG1heF92Ymw7CiAJCWludCBzY2FubGluZV9zdGFydDsKKyNp
ZmRlZiBDT05GSUdfRFJNX0k5MTVfREVCVUdfVkJMQU5LX0VWQURFCisJCXU2NCBtaW5fdmJsX3Rp
bWU7CisJCXU2NCBtYXhfdmJsX3RpbWU7CisJCXU2NCBzdW1fdmJsX3RpbWU7CisJCXVuc2lnbmVk
IGludCB2YmxfdGltZXNbMjFdOyAvKiBbMXVzLCAxbXNdICovCisJCXVuc2lnbmVkIGxvbmcgb3Zl
cl92YmxfdGltZTsKKyNlbmRpZgogCX0gZGVidWc7CiAKIAkvKiBzY2FsZXJzIGF2YWlsYWJsZSBv
biB0aGlzIGNydGMgKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfc3ByaXRlLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nwcml0
ZS5jCmluZGV4IDAxOWEyZDZkODA3YS4uNjYxY2JhZjRjYzM4IDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nwcml0ZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3ByaXRlLmMKQEAgLTI1MCwxMyArMjUwLDI4IEBAIHZvaWQg
aW50ZWxfcGlwZV91cGRhdGVfZW5kKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpuZXdfY3J0Y19z
dGF0ZSkKIAkJCWNydGMtPmRlYnVnLnNjYW5saW5lX3N0YXJ0LCBzY2FubGluZV9lbmQpOwogCX0K
ICNpZmRlZiBDT05GSUdfRFJNX0k5MTVfREVCVUdfVkJMQU5LX0VWQURFCi0JZWxzZSBpZiAoa3Rp
bWVfdXNfZGVsdGEoZW5kX3ZibF90aW1lLCBjcnRjLT5kZWJ1Zy5zdGFydF92YmxfdGltZSkgPgot
CQkgVkJMQU5LX0VWQVNJT05fVElNRV9VUykKLQkJZHJtX3dhcm4oJmRldl9wcml2LT5kcm0sCi0J
CQkgIkF0b21pYyB1cGRhdGUgb24gcGlwZSAoJWMpIHRvb2sgJWxsZCB1cywgbWF4IHRpbWUgdW5k
ZXIgZXZhc2lvbiBpcyAldSB1c1xuIiwKLQkJCSBwaXBlX25hbWUocGlwZSksCi0JCQkga3RpbWVf
dXNfZGVsdGEoZW5kX3ZibF90aW1lLCBjcnRjLT5kZWJ1Zy5zdGFydF92YmxfdGltZSksCi0JCQkg
VkJMQU5LX0VWQVNJT05fVElNRV9VUyk7CisJeworCQl1bnNpZ25lZCBpbnQgaDsKKwkJdTY0IGRl
bHRhOworCisJCWRlbHRhID0ga3RpbWVfdG9fbnMoa3RpbWVfc3ViKGVuZF92YmxfdGltZSwKKwkJ
CQkJICAgICAgY3J0Yy0+ZGVidWcuc3RhcnRfdmJsX3RpbWUpKTsKKworCQloID0gaWxvZzIoZGVs
dGEgPj4gOSk7CisJCWlmIChoID49IEFSUkFZX1NJWkUoY3J0Yy0+ZGVidWcudmJsX3RpbWVzKSkK
KwkJCWggPSBBUlJBWV9TSVpFKGNydGMtPmRlYnVnLnZibF90aW1lcykgLSAxOworCQljcnRjLT5k
ZWJ1Zy52YmxfdGltZXNbaF0rKzsKKworCQljcnRjLT5kZWJ1Zy5zdW1fdmJsX3RpbWUgKz0gZGVs
dGE7CisJCWlmICghY3J0Yy0+ZGVidWcubWluX3ZibF90aW1lIHx8CisJCSAgICBkZWx0YSA8IGNy
dGMtPmRlYnVnLm1pbl92YmxfdGltZSkKKwkJCWNydGMtPmRlYnVnLm1pbl92YmxfdGltZSA9IGRl
bHRhOworCQlpZiAoZGVsdGEgPiBjcnRjLT5kZWJ1Zy5tYXhfdmJsX3RpbWUpCisJCQljcnRjLT5k
ZWJ1Zy5tYXhfdmJsX3RpbWUgPSBkZWx0YTsKKworCQlpZiAoZGVsdGEgPiAxMDAwICogVkJMQU5L
X0VWQVNJT05fVElNRV9VUykKKwkJCWNydGMtPmRlYnVnLm92ZXJfdmJsX3RpbWUrKzsKKwl9CiAj
ZW5kaWYKIH0KIAotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVl
ZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5m
by9pbnRlbC1nZngK

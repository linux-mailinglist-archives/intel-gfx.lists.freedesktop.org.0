Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8566E11E524
	for <lists+intel-gfx@lfdr.de>; Fri, 13 Dec 2019 15:03:26 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C839B6E8C2;
	Fri, 13 Dec 2019 14:03:24 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
X-Greylist: delayed 57707 seconds by postgrey-1.36 at gabe;
 Fri, 13 Dec 2019 14:03:23 UTC
Received: from 7.mo68.mail-out.ovh.net (7.mo68.mail-out.ovh.net
 [46.105.63.230])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A86F26E8C2
 for <intel-gfx@lists.freedesktop.org>; Fri, 13 Dec 2019 14:03:23 +0000 (UTC)
Received: from player159.ha.ovh.net (unknown [10.108.54.38])
 by mo68.mail-out.ovh.net (Postfix) with ESMTP id A6974153C21
 for <intel-gfx@lists.freedesktop.org>; Fri, 13 Dec 2019 13:45:44 +0100 (CET)
Received: from etezian.org (net-37-116-49-191.cust.vodafonedsl.it
 [37.116.49.191]) (Authenticated sender: andi@etezian.org)
 by player159.ha.ovh.net (Postfix) with ESMTPSA id AAC0BD2A8A21;
 Fri, 13 Dec 2019 12:45:40 +0000 (UTC)
From: Andi Shyti <andi@etezian.org>
To: Intel GFX <intel-gfx@lists.freedesktop.org>
Date: Fri, 13 Dec 2019 14:45:49 +0200
Message-Id: <20191213124549.28412-3-andi@etezian.org>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191213124549.28412-1-andi@etezian.org>
References: <20191213124549.28412-1-andi@etezian.org>
MIME-Version: 1.0
X-Ovh-Tracer-Id: 9797580992859521629
X-VR-SPAMSTATE: OK
X-VR-SPAMSCORE: -100
X-VR-SPAMCAUSE: gggruggvucftvghtrhhoucdtuddrgedufedrudelledggeehucetufdoteggodetrfdotffvucfrrhhofhhilhgvmecuqfggjfdpvefjgfevmfevgfenuceurghilhhouhhtmecuhedttdenucesvcftvggtihhpihgvnhhtshculddquddttddmnecujfgurhephffvufffkffojghfgggtgfesthekredtredtjeenucfhrhhomheptehnughiucfuhhihthhiuceorghnughisegvthgviihirghnrdhorhhgqeenucfkpheptddrtddrtddrtddpfeejrdduudeirdegledrudeludenucfrrghrrghmpehmohguvgepshhmthhpqdhouhhtpdhhvghlohepphhlrgihvghrudehledrhhgrrdhovhhhrdhnvghtpdhinhgvtheptddrtddrtddrtddpmhgrihhlfhhrohhmpegrnhguihesvghtvgiiihgrnhdrohhrghdprhgtphhtthhopehinhhtvghlqdhgfhigsehlihhsthhsrdhfrhgvvgguvghskhhtohhprdhorhhgnecuvehluhhsthgvrhfuihiivgeptd
Subject: [Intel-gfx] [PATCH v3 2/2] drm/i915/gt: Move power management debug
 files into a gt aware debugfs
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogQW5kaSBTaHl0aSA8YW5kaS5zaHl0aUBpbnRlbC5jb20+CgpUaGUgR1Qgc3lzdGVtIGlz
IGJlY29taW5nIG1vcmUgYW5kIG1vcmUgYSBzdGFuZC1hbG9uZSBzeXN0ZW0gaW4KaTkxNSBhbmQg
aXQncyBmYWlyIHRvIGFzc2lnbiBpdCBpdHMgb3duIGRlYnVnZnMgZGlyZWN0b3J5LgoKcmM2LCBy
cHMgYW5kIGxsYyBkZWJ1Z2ZzIGZpbGVzIGFyZSBndCByZWxhdGVkLCBtb3ZlIHRoZW0gaW50byB0
aGUKZ3QgZGVidWdmcyBkaXJlY3RvcnkuCgpTaWduZWQtb2ZmLWJ5OiBBbmRpIFNoeXRpIDxhbmRp
LnNoeXRpQGludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZSAgICAg
ICAgICAgIHwgICAyICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2RlYnVnZnNfZ3QuYyAgICAg
fCAgMTkgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19ndC5oICAgICB8ICAyNiAr
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX3BtLmMgICAgIHwgNjI2ICsrKysrKysr
KysrKysrKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX3BtLmggICAg
IHwgIDE2ICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3R5cGVzLmggfCAgIDMg
KwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMgICAgICB8IDU3OSArLS0tLS0t
LS0tLS0tLS0tLS0tLS0KIDcgZmlsZXMgY2hhbmdlZCwgNzAxIGluc2VydGlvbnMoKyksIDU3MCBk
ZWxldGlvbnMoLSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9k
ZWJ1Z2ZzX2d0LmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9k
ZWJ1Z2ZzX2d0LmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9k
ZWJ1Z2ZzX3BtLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9k
ZWJ1Z2ZzX3BtLmgKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZSBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCmluZGV4IGUwZmQxMGMwY2ZiOC4uOGY2Y2Rm
ZDA4YWM4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQorKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQpAQCAtNzUsNiArNzUsOCBAQCBpOTE1LSQoQ09O
RklHX1BFUkZfRVZFTlRTKSArPSBpOTE1X3BtdS5vCiAjICJHcmFwaGljcyBUZWNobm9sb2d5IiAo
YWthIHdlIHRhbGsgdG8gdGhlIGdwdSkKIG9iai15ICs9IGd0LwogZ3QteSArPSBcCisJZ3QvZGVi
dWdmc19ndC5vIFwKKwlndC9kZWJ1Z2ZzX3BtLm8gXAogCWd0L2ludGVsX2JyZWFkY3J1bWJzLm8g
XAogCWd0L2ludGVsX2NvbnRleHQubyBcCiAJZ3QvaW50ZWxfZW5naW5lX2NzLm8gXApkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19ndC5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvZGVidWdmc19ndC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAw
MDAwMDAwMC4uMzNhYmUwMjM0ZDU2Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvZGVidWdmc19ndC5jCkBAIC0wLDAgKzEsMTkgQEAKKy8qIFNQRFgtTGljZW5zZS1J
ZGVudGlmaWVyOiBNSVQgKi8KKy8qCisgKiBDb3B5cmlnaHQgwqkgMjAxOSBJbnRlbCBDb3Jwb3Jh
dGlvbgorICovCisKKyNpbmNsdWRlICJkZWJ1Z2ZzX3BtLmgiCisjaW5jbHVkZSAiaTkxNV90cmFj
ZS5oIgorCitpbnQgZGVidWdmc19ndF9pbml0KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCit7CisJc3Ry
dWN0IGRybV9taW5vciAqbWlub3IgPSBndC0+aTkxNS0+ZHJtLnByaW1hcnk7CisKKwlpZiAoIW1p
bm9yLT5kZWJ1Z2ZzX3Jvb3QpCisJCXJldHVybiAtRU5PREVWOworCisJZ3QtPmRlYnVnZnNfZW50
cnkgPSBkZWJ1Z2ZzX2NyZWF0ZV9kaXIoImd0IiwgbWlub3ItPmRlYnVnZnNfcm9vdCk7CisKKwly
ZXR1cm4gaW50ZWxfZ3RfcG1fZGVidWdmc19yZWdpc3RlcihndCk7Cit9CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX2d0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9kZWJ1Z2ZzX2d0LmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAw
Li5jYWM1YTM1MDM0NTkKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9kZWJ1Z2ZzX2d0LmgKQEAgLTAsMCArMSwyNiBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IE1JVCAqLworLyoKKyAqIENvcHlyaWdodCDCqSAyMDE5IEludGVsIENvcnBvcmF0aW9uCisg
Ki8KKworI2lmbmRlZiBERUJVR0ZTX0dUCisjZGVmaW5lIERFQlVHRlNfR1QKKworI2luY2x1ZGUg
ImludGVsX2d0X3R5cGVzLmgiCisKKyNkZWZpbmUgREVGSU5FX0dUX0RFQlVHRlNfQVRUUklCVVRF
KF9fbmFtZSkJCQkJXAorc3RhdGljIGludCBfX25hbWUgIyMgX29wZW4oc3RydWN0IGlub2RlICpp
bm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpCVwKK3sJCQkJCQkJCQlcCisJcmV0dXJuIHNpbmdsZV9v
cGVuKGZpbGUsIF9fbmFtZSAjIyBfc2hvdywgaW5vZGUtPmlfcHJpdmF0ZSk7CVwKK30JCQkJCQkJ
CQlcCitzdGF0aWMgY29uc3Qgc3RydWN0IGZpbGVfb3BlcmF0aW9ucyBfX25hbWUgIyMgX2ZvcHMg
PSB7CQkJXAorCS5vd25lciA9IFRISVNfTU9EVUxFLAkJCQkJCVwKKwkub3BlbiA9IF9fbmFtZSAj
IyBfb3BlbiwJCQkJCVwKKwkucmVhZCA9IHNlcV9yZWFkLAkJCQkJCVwKKwkubGxzZWVrID0gc2Vx
X2xzZWVrLAkJCQkJCVwKKwkucmVsZWFzZSA9IHNpbmdsZV9yZWxlYXNlLAkJCQkJXAorfQorCitp
bnQgZGVidWdmc19ndF9pbml0KHN0cnVjdCBpbnRlbF9ndCAqZ3QpOworCisjZW5kaWYgLyogREVC
VUdGU19HVCAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19w
bS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19wbS5jCm5ldyBmaWxlIG1vZGUg
MTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uYjVlYTg4NDhjZGZjCi0tLSAvZGV2L251bGwKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19wbS5jCkBAIC0wLDAgKzEsNjI2IEBA
CisvKgorICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAorICoKKyAqIENvcHlyaWdodCDC
qSAyMDE5IEludGVsIENvcnBvcmF0aW9uCisgKi8KKworI2luY2x1ZGUgImRlYnVnZnNfcG0uaCIK
KyNpbmNsdWRlICJkZWJ1Z2ZzX2d0LmgiCisjaW5jbHVkZSAiaTkxNV9kZWJ1Z2ZzLmgiCisjaW5j
bHVkZSAiaTkxNV90cmFjZS5oIgorI2luY2x1ZGUgImludGVsX3JjNi5oIgorI2luY2x1ZGUgImlu
dGVsX3Jwcy5oIgorI2luY2x1ZGUgImludGVsX3NpZGViYW5kLmgiCisKK3N0YXRpYyBpbnQgZnJl
cXVlbmN5X2luZm9fc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKK3sKKwlz
dHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gbS0+cHJpdmF0ZTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IGd0LT5pOTE1OworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IGd0LT51
bmNvcmU7CisJc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmd0LT5ycHM7CisJaW50ZWxfd2FrZXJl
Zl90IHdha2VyZWY7CisKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQodW5jb3JlLT5y
cG0pOworCisJaWYgKElTX0dFTihpOTE1LCA1KSkgeworCQl1MTYgcmd2c3djdGwgPSBpbnRlbF91
bmNvcmVfcmVhZDE2KHVuY29yZSwgTUVNU1dDVEwpOworCQl1MTYgcmd2c3RhdCA9IGludGVsX3Vu
Y29yZV9yZWFkMTYodW5jb3JlLCBNRU1TVEFUX0lMSyk7CisKKwkJc2VxX3ByaW50ZihtLCAiUmVx
dWVzdGVkIFAtc3RhdGU6ICVkXG4iLCAocmd2c3djdGwgPj4gOCkgJiAweGYpOworCQlzZXFfcHJp
bnRmKG0sICJSZXF1ZXN0ZWQgVklEOiAlZFxuIiwgcmd2c3djdGwgJiAweDNmKTsKKwkJc2VxX3By
aW50ZihtLCAiQ3VycmVudCBWSUQ6ICVkXG4iLCAocmd2c3RhdCAmIE1FTVNUQVRfVklEX01BU0sp
ID4+CisJCQkgICBNRU1TVEFUX1ZJRF9TSElGVCk7CisJCXNlcV9wcmludGYobSwgIkN1cnJlbnQg
UC1zdGF0ZTogJWRcbiIsCisJCQkgICAocmd2c3RhdCAmIE1FTVNUQVRfUFNUQVRFX01BU0spID4+
IE1FTVNUQVRfUFNUQVRFX1NISUZUKTsKKwl9IGVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkg
fHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkgeworCQl1MzIgcnBtb2RlY3RsLCBmcmVxX3N0czsKKwor
CQlycG1vZGVjdGwgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUlBfQ09OVFJPTCk7
CisJCXNlcV9wcmludGYobSwgIlZpZGVvIFR1cmJvIE1vZGU6ICVzXG4iLAorCQkJICAgeWVzbm8o
cnBtb2RlY3RsICYgR0VONl9SUF9NRURJQV9UVVJCTykpOworCQlzZXFfcHJpbnRmKG0sICJIVyBj
b250cm9sIGVuYWJsZWQ6ICVzXG4iLAorCQkJICAgeWVzbm8ocnBtb2RlY3RsICYgR0VONl9SUF9F
TkFCTEUpKTsKKwkJc2VxX3ByaW50ZihtLCAiU1cgY29udHJvbCBlbmFibGVkOiAlc1xuIiwKKwkJ
CSAgIHllc25vKChycG1vZGVjdGwgJiBHRU42X1JQX01FRElBX01PREVfTUFTSykgPT0KKwkJCQkg
IEdFTjZfUlBfTUVESUFfU1dfTU9ERSkpOworCisJCXZsdl9wdW5pdF9nZXQoaTkxNSk7CisJCWZy
ZXFfc3RzID0gdmx2X3B1bml0X3JlYWQoaTkxNSwgUFVOSVRfUkVHX0dQVV9GUkVRX1NUUyk7CisJ
CXZsdl9wdW5pdF9wdXQoaTkxNSk7CisKKwkJc2VxX3ByaW50ZihtLCAiUFVOSVRfUkVHX0dQVV9G
UkVRX1NUUzogMHglMDh4XG4iLCBmcmVxX3N0cyk7CisJCXNlcV9wcmludGYobSwgIkREUiBmcmVx
OiAlZCBNSHpcbiIsIGk5MTUtPm1lbV9mcmVxKTsKKworCQlzZXFfcHJpbnRmKG0sICJhY3R1YWwg
R1BVIGZyZXE6ICVkIE1IelxuIiwKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgKGZyZXFfc3Rz
ID4+IDgpICYgMHhmZikpOworCisJCXNlcV9wcmludGYobSwgImN1cnJlbnQgR1BVIGZyZXE6ICVk
IE1IelxuIiwKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5jdXJfZnJlcSkpOworCisJ
CXNlcV9wcmludGYobSwgIm1heCBHUFUgZnJlcTogJWQgTUh6XG4iLAorCQkJICAgaW50ZWxfZ3B1
X2ZyZXEocnBzLCBycHMtPm1heF9mcmVxKSk7CisKKwkJc2VxX3ByaW50ZihtLCAibWluIEdQVSBm
cmVxOiAlZCBNSHpcbiIsCisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWluX2ZyZXEp
KTsKKworCQlzZXFfcHJpbnRmKG0sICJpZGxlIEdQVSBmcmVxOiAlZCBNSHpcbiIsCisJCQkgICBp
bnRlbF9ncHVfZnJlcShycHMsIHJwcy0+aWRsZV9mcmVxKSk7CisKKwkJc2VxX3ByaW50ZihtLCAi
ZWZmaWNpZW50IChSUGUpIGZyZXF1ZW5jeTogJWQgTUh6XG4iLAorCQkJICAgaW50ZWxfZ3B1X2Zy
ZXEocnBzLCBycHMtPmVmZmljaWVudF9mcmVxKSk7CisJfSBlbHNlIGlmIChJTlRFTF9HRU4oaTkx
NSkgPj0gNikgeworCQl1MzIgcnBfc3RhdGVfbGltaXRzOworCQl1MzIgZ3RfcGVyZl9zdGF0dXM7
CisJCXUzMiBycF9zdGF0ZV9jYXA7CisJCXUzMiBycG1vZGVjdGwsIHJwaW5jbGltaXQsIHJwZGVj
bGltaXQ7CisJCXUzMiBycHN0YXQsIGNhZ2YsIHJlcWY7CisJCXUzMiBycHVwZWksIHJwY3VydXAs
IHJwcHJldnVwOworCQl1MzIgcnBkb3duZWksIHJwY3VyZG93biwgcnBwcmV2ZG93bjsKKwkJdTMy
IHBtX2llciwgcG1faW1yLCBwbV9pc3IsIHBtX2lpciwgcG1fbWFzazsKKwkJaW50IG1heF9mcmVx
OworCisJCXJwX3N0YXRlX2xpbWl0cyA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VONl9S
UF9TVEFURV9MSU1JVFMpOworCQlpZiAoSVNfR0VOOV9MUChpOTE1KSkgeworCQkJcnBfc3RhdGVf
Y2FwID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBCWFRfUlBfU1RBVEVfQ0FQKTsKKwkJCWd0
X3BlcmZfc3RhdHVzID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBCWFRfR1RfUEVSRl9TVEFU
VVMpOworCQl9IGVsc2UgeworCQkJcnBfc3RhdGVfY2FwID0gaW50ZWxfdW5jb3JlX3JlYWQodW5j
b3JlLCBHRU42X1JQX1NUQVRFX0NBUCk7CisJCQlndF9wZXJmX3N0YXR1cyA9IGludGVsX3VuY29y
ZV9yZWFkKHVuY29yZSwgR0VONl9HVF9QRVJGX1NUQVRVUyk7CisJCX0KKworCQkvKiBSUFNUQVQx
IGlzIGluIHRoZSBHVCBwb3dlciB3ZWxsICovCisJCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0
KHVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7CisKKwkJcmVxZiA9IGludGVsX3VuY29yZV9yZWFkKHVu
Y29yZSwgR0VONl9SUE5TV1JFUSk7CisJCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkKKwkJCXJl
cWYgPj49IDIzOworCQllbHNlIHsKKwkJCXJlcWYgJj0gfkdFTjZfVFVSQk9fRElTQUJMRTsKKwkJ
CWlmIChJU19IQVNXRUxMKGk5MTUpIHx8IElTX0JST0FEV0VMTChpOTE1KSkKKwkJCQlyZXFmID4+
PSAyNDsKKwkJCWVsc2UKKwkJCQlyZXFmID4+PSAyNTsKKwkJfQorCQlyZXFmID0gaW50ZWxfZ3B1
X2ZyZXEocnBzLCByZXFmKTsKKworCQlycG1vZGVjdGwgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNv
cmUsIEdFTjZfUlBfQ09OVFJPTCk7CisJCXJwaW5jbGltaXQgPSBpbnRlbF91bmNvcmVfcmVhZCh1
bmNvcmUsIEdFTjZfUlBfVVBfVEhSRVNIT0xEKTsKKwkJcnBkZWNsaW1pdCA9IGludGVsX3VuY29y
ZV9yZWFkKHVuY29yZSwgR0VONl9SUF9ET1dOX1RIUkVTSE9MRCk7CisKKwkJcnBzdGF0ID0gaW50
ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU42X1JQU1RBVDEpOworCQlycHVwZWkgPSBpbnRlbF91
bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUlBfQ1VSX1VQX0VJKSAmIEdFTjZfQ1VSSUNPTlRfTUFT
SzsKKwkJcnBjdXJ1cCA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VONl9SUF9DVVJfVVAp
ICYgR0VONl9DVVJCU1lUQVZHX01BU0s7CisJCXJwcHJldnVwID0gaW50ZWxfdW5jb3JlX3JlYWQo
dW5jb3JlLCBHRU42X1JQX1BSRVZfVVApICYgR0VONl9DVVJCU1lUQVZHX01BU0s7CisJCXJwZG93
bmVpID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU42X1JQX0NVUl9ET1dOX0VJKSAmIEdF
TjZfQ1VSSUFWR19NQVNLOworCQlycGN1cmRvd24gPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUs
IEdFTjZfUlBfQ1VSX0RPV04pICYgR0VONl9DVVJCU1lUQVZHX01BU0s7CisJCXJwcHJldmRvd24g
PSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUlBfUFJFVl9ET1dOKSAmIEdFTjZfQ1VS
QlNZVEFWR19NQVNLOworCQljYWdmID0gaW50ZWxfcnBzX3JlYWRfYWN0dWFsX2ZyZXF1ZW5jeShy
cHMpOworCisJCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KHVuY29yZSwgRk9SQ0VXQUtFX0FM
TCk7CisKKwkJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkgeworCQkJcG1faWVyID0gaW50ZWxf
dW5jb3JlX3JlYWQodW5jb3JlLCBHRU4xMV9HUE1fV0dCT1hQRVJGX0lOVFJfRU5BQkxFKTsKKwkJ
CXBtX2ltciA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VOMTFfR1BNX1dHQk9YUEVSRl9J
TlRSX01BU0spOworCQkJLyoKKwkJCSAqIFRoZSBlcXVpdmFsZW50IHRvIHRoZSBQTSBJU1IgJiBJ
SVIgY2Fubm90IGJlIHJlYWQKKwkJCSAqIHdpdGhvdXQgYWZmZWN0aW5nIHRoZSBjdXJyZW50IHN0
YXRlIG9mIHRoZSBzeXN0ZW0KKwkJCSAqLworCQkJcG1faXNyID0gMDsKKwkJCXBtX2lpciA9IDA7
CisJCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDgpIHsKKwkJCXBtX2llciA9IGludGVs
X3VuY29yZV9yZWFkKHVuY29yZSwgR0VOOF9HVF9JRVIoMikpOworCQkJcG1faW1yID0gaW50ZWxf
dW5jb3JlX3JlYWQodW5jb3JlLCBHRU44X0dUX0lNUigyKSk7CisJCQlwbV9pc3IgPSBpbnRlbF91
bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjhfR1RfSVNSKDIpKTsKKwkJCXBtX2lpciA9IGludGVsX3Vu
Y29yZV9yZWFkKHVuY29yZSwgR0VOOF9HVF9JSVIoMikpOworCQl9IGVsc2UgeworCQkJcG1faWVy
ID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU42X1BNSUVSKTsKKwkJCXBtX2ltciA9IGlu
dGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VONl9QTUlNUik7CisJCQlwbV9pc3IgPSBpbnRlbF91
bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUE1JU1IpOworCQkJcG1faWlyID0gaW50ZWxfdW5jb3Jl
X3JlYWQodW5jb3JlLCBHRU42X1BNSUlSKTsKKwkJfQorCQlwbV9tYXNrID0gaW50ZWxfdW5jb3Jl
X3JlYWQodW5jb3JlLCBHRU42X1BNSU5UUk1TSyk7CisKKwkJc2VxX3ByaW50ZihtLCAiVmlkZW8g
VHVyYm8gTW9kZTogJXNcbiIsCisJCQkgICB5ZXNubyhycG1vZGVjdGwgJiBHRU42X1JQX01FRElB
X1RVUkJPKSk7CisJCXNlcV9wcmludGYobSwgIkhXIGNvbnRyb2wgZW5hYmxlZDogJXNcbiIsCisJ
CQkgICB5ZXNubyhycG1vZGVjdGwgJiBHRU42X1JQX0VOQUJMRSkpOworCQlzZXFfcHJpbnRmKG0s
ICJTVyBjb250cm9sIGVuYWJsZWQ6ICVzXG4iLAorCQkJICAgeWVzbm8oKHJwbW9kZWN0bCAmIEdF
TjZfUlBfTUVESUFfTU9ERV9NQVNLKSA9PQorCQkJCSAgR0VONl9SUF9NRURJQV9TV19NT0RFKSk7
CisKKwkJc2VxX3ByaW50ZihtLCAiUE0gSUVSPTB4JTA4eCBJTVI9MHglMDh4LCBNQVNLPTB4JTA4
eFxuIiwKKwkJCSAgIHBtX2llciwgcG1faW1yLCBwbV9tYXNrKTsKKwkJaWYgKElOVEVMX0dFTihp
OTE1KSA8PSAxMCkKKwkJCXNlcV9wcmludGYobSwgIlBNIElTUj0weCUwOHggSUlSPTB4JTA4eFxu
IiwKKwkJCQkgICBwbV9pc3IsIHBtX2lpcik7CisJCXNlcV9wcmludGYobSwgInBtX2ludHJtc2tf
bWJ6OiAweCUwOHhcbiIsCisJCQkgICBycHMtPnBtX2ludHJtc2tfbWJ6KTsKKwkJc2VxX3ByaW50
ZihtLCAiR1RfUEVSRl9TVEFUVVM6IDB4JTA4eFxuIiwgZ3RfcGVyZl9zdGF0dXMpOworCQlzZXFf
cHJpbnRmKG0sICJSZW5kZXIgcC1zdGF0ZSByYXRpbzogJWRcbiIsCisJCQkgICAoZ3RfcGVyZl9z
dGF0dXMgJiAoSU5URUxfR0VOKGk5MTUpID49IDkgPyAweDFmZjAwIDogMHhmZjAwKSkgPj4gOCk7
CisJCXNlcV9wcmludGYobSwgIlJlbmRlciBwLXN0YXRlIFZJRDogJWRcbiIsCisJCQkgICBndF9w
ZXJmX3N0YXR1cyAmIDB4ZmYpOworCQlzZXFfcHJpbnRmKG0sICJSZW5kZXIgcC1zdGF0ZSBsaW1p
dDogJWRcbiIsCisJCQkgICBycF9zdGF0ZV9saW1pdHMgJiAweGZmKTsKKwkJc2VxX3ByaW50Ziht
LCAiUlBTVEFUMTogMHglMDh4XG4iLCBycHN0YXQpOworCQlzZXFfcHJpbnRmKG0sICJSUE1PREVD
VEw6IDB4JTA4eFxuIiwgcnBtb2RlY3RsKTsKKwkJc2VxX3ByaW50ZihtLCAiUlBJTkNMSU1JVDog
MHglMDh4XG4iLCBycGluY2xpbWl0KTsKKwkJc2VxX3ByaW50ZihtLCAiUlBERUNMSU1JVDogMHgl
MDh4XG4iLCBycGRlY2xpbWl0KTsKKwkJc2VxX3ByaW50ZihtLCAiUlBOU1dSRVE6ICVkTUh6XG4i
LCByZXFmKTsKKwkJc2VxX3ByaW50ZihtLCAiQ0FHRjogJWRNSHpcbiIsIGNhZ2YpOworCQlzZXFf
cHJpbnRmKG0sICJSUCBDVVIgVVAgRUk6ICVkICglZHVzKVxuIiwKKwkJCSAgIHJwdXBlaSwgR1Rf
UE1fSU5URVJWQUxfVE9fVVMoaTkxNSwgcnB1cGVpKSk7CisJCXNlcV9wcmludGYobSwgIlJQIENV
UiBVUDogJWQgKCVkdXMpXG4iLAorCQkJICAgcnBjdXJ1cCwgR1RfUE1fSU5URVJWQUxfVE9fVVMo
aTkxNSwgcnBjdXJ1cCkpOworCQlzZXFfcHJpbnRmKG0sICJSUCBQUkVWIFVQOiAlZCAoJWR1cylc
biIsCisJCQkgICBycHByZXZ1cCwgR1RfUE1fSU5URVJWQUxfVE9fVVMoaTkxNSwgcnBwcmV2dXAp
KTsKKwkJc2VxX3ByaW50ZihtLCAiVXAgdGhyZXNob2xkOiAlZCUlXG4iLAorCQkJICAgcnBzLT5w
b3dlci51cF90aHJlc2hvbGQpOworCisJCXNlcV9wcmludGYobSwgIlJQIENVUiBET1dOIEVJOiAl
ZCAoJWR1cylcbiIsCisJCQkgICBycGRvd25laSwgR1RfUE1fSU5URVJWQUxfVE9fVVMoaTkxNSwg
cnBkb3duZWkpKTsKKwkJc2VxX3ByaW50ZihtLCAiUlAgQ1VSIERPV046ICVkICglZHVzKVxuIiwK
KwkJCSAgIHJwY3VyZG93biwgR1RfUE1fSU5URVJWQUxfVE9fVVMoaTkxNSwgcnBjdXJkb3duKSk7
CisJCXNlcV9wcmludGYobSwgIlJQIFBSRVYgRE9XTjogJWQgKCVkdXMpXG4iLAorCQkJICAgcnBw
cmV2ZG93biwgR1RfUE1fSU5URVJWQUxfVE9fVVMoaTkxNSwgcnBwcmV2ZG93bikpOworCQlzZXFf
cHJpbnRmKG0sICJEb3duIHRocmVzaG9sZDogJWQlJVxuIiwKKwkJCSAgIHJwcy0+cG93ZXIuZG93
bl90aHJlc2hvbGQpOworCisJCW1heF9mcmVxID0gKElTX0dFTjlfTFAoaTkxNSkgPyBycF9zdGF0
ZV9jYXAgPj4gMCA6CisJCQkgICAgcnBfc3RhdGVfY2FwID4+IDE2KSAmIDB4ZmY7CisJCW1heF9m
cmVxICo9IChJU19HRU45X0JDKGk5MTUpIHx8CisJCQkgICAgIElOVEVMX0dFTihpOTE1KSA+PSAx
MCA/IEdFTjlfRlJFUV9TQ0FMRVIgOiAxKTsKKwkJc2VxX3ByaW50ZihtLCAiTG93ZXN0IChSUE4p
IGZyZXF1ZW5jeTogJWRNSHpcbiIsCisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIG1heF9mcmVx
KSk7CisKKwkJbWF4X2ZyZXEgPSAocnBfc3RhdGVfY2FwICYgMHhmZjAwKSA+PiA4OworCQltYXhf
ZnJlcSAqPSAoSVNfR0VOOV9CQyhpOTE1KSB8fAorCQkJICAgICBJTlRFTF9HRU4oaTkxNSkgPj0g
MTAgPyBHRU45X0ZSRVFfU0NBTEVSIDogMSk7CisJCXNlcV9wcmludGYobSwgIk5vbWluYWwgKFJQ
MSkgZnJlcXVlbmN5OiAlZE1IelxuIiwKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgbWF4X2Zy
ZXEpKTsKKworCQltYXhfZnJlcSA9IChJU19HRU45X0xQKGk5MTUpID8gcnBfc3RhdGVfY2FwID4+
IDE2IDoKKwkJCSAgICBycF9zdGF0ZV9jYXAgPj4gMCkgJiAweGZmOworCQltYXhfZnJlcSAqPSAo
SVNfR0VOOV9CQyhpOTE1KSB8fAorCQkJICAgICBJTlRFTF9HRU4oaTkxNSkgPj0gMTAgPyBHRU45
X0ZSRVFfU0NBTEVSIDogMSk7CisJCXNlcV9wcmludGYobSwgIk1heCBub24tb3ZlcmNsb2NrZWQg
KFJQMCkgZnJlcXVlbmN5OiAlZE1IelxuIiwKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgbWF4
X2ZyZXEpKTsKKwkJc2VxX3ByaW50ZihtLCAiTWF4IG92ZXJjbG9ja2VkIGZyZXF1ZW5jeTogJWRN
SHpcbiIsCisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWF4X2ZyZXEpKTsKKworCQlz
ZXFfcHJpbnRmKG0sICJDdXJyZW50IGZyZXE6ICVkIE1IelxuIiwKKwkJCSAgIGludGVsX2dwdV9m
cmVxKHJwcywgcnBzLT5jdXJfZnJlcSkpOworCQlzZXFfcHJpbnRmKG0sICJBY3R1YWwgZnJlcTog
JWQgTUh6XG4iLCBjYWdmKTsKKwkJc2VxX3ByaW50ZihtLCAiSWRsZSBmcmVxOiAlZCBNSHpcbiIs
CisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+aWRsZV9mcmVxKSk7CisJCXNlcV9wcmlu
dGYobSwgIk1pbiBmcmVxOiAlZCBNSHpcbiIsCisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJw
cy0+bWluX2ZyZXEpKTsKKwkJc2VxX3ByaW50ZihtLCAiQm9vc3QgZnJlcTogJWQgTUh6XG4iLAor
CQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmJvb3N0X2ZyZXEpKTsKKwkJc2VxX3ByaW50
ZihtLCAiTWF4IGZyZXE6ICVkIE1IelxuIiwKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBz
LT5tYXhfZnJlcSkpOworCQlzZXFfcHJpbnRmKG0sCisJCQkgICAiZWZmaWNpZW50IChSUGUpIGZy
ZXF1ZW5jeTogJWQgTUh6XG4iLAorCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmVmZmlj
aWVudF9mcmVxKSk7CisJfSBlbHNlIHsKKwkJc2VxX3B1dHMobSwgIm5vIFAtc3RhdGUgaW5mbyBh
dmFpbGFibGVcbiIpOworCX0KKworCXNlcV9wcmludGYobSwgIkN1cnJlbnQgQ0QgY2xvY2sgZnJl
cXVlbmN5OiAlZCBrSHpcbiIsIGk5MTUtPmNkY2xrLmh3LmNkY2xrKTsKKwlzZXFfcHJpbnRmKG0s
ICJNYXggQ0QgY2xvY2sgZnJlcXVlbmN5OiAlZCBrSHpcbiIsIGk5MTUtPm1heF9jZGNsa19mcmVx
KTsKKwlzZXFfcHJpbnRmKG0sICJNYXggcGl4ZWwgY2xvY2sgZnJlcXVlbmN5OiAlZCBrSHpcbiIs
IGk5MTUtPm1heF9kb3RjbGtfZnJlcSk7CisKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCh1bmNvcmUt
PnJwbSwgd2FrZXJlZik7CisKKwlyZXR1cm4gMDsKK30KK0RFRklORV9HVF9ERUJVR0ZTX0FUVFJJ
QlVURShmcmVxdWVuY3lfaW5mbyk7CisKK3N0YXRpYyBpbnQgcmluZ19mcmVxX3RhYmxlX3Nob3co
c3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCit7CisJc3RydWN0IGludGVsX2d0ICpn
dCA9IG0tPnByaXZhdGU7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndC0+aTkx
NTsKKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZ3QtPnJwczsKKwl1bnNpZ25lZCBpbnQgbWF4
X2dwdV9mcmVxLCBtaW5fZ3B1X2ZyZXE7CisJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7CisJaW50
IGdwdV9mcmVxLCBpYV9mcmVxOworCisJbWluX2dwdV9mcmVxID0gcnBzLT5taW5fZnJlcTsKKwlt
YXhfZ3B1X2ZyZXEgPSBycHMtPm1heF9mcmVxOworCWlmIChJU19HRU45X0JDKGk5MTUpIHx8IElO
VEVMX0dFTihpOTE1KSA+PSAxMCkgeworCQkvKiBDb252ZXJ0IEdUIGZyZXF1ZW5jeSB0byA1MCBI
WiB1bml0cyAqLworCQltaW5fZ3B1X2ZyZXEgLz0gR0VOOV9GUkVRX1NDQUxFUjsKKwkJbWF4X2dw
dV9mcmVxIC89IEdFTjlfRlJFUV9TQ0FMRVI7CisJfQorCisJc2VxX3B1dHMobSwgIkdQVSBmcmVx
IChNSHopXHRFZmZlY3RpdmUgQ1BVIGZyZXEgKE1IeilcdEVmZmVjdGl2ZSBSaW5nIGZyZXEgKE1I
eilcbiIpOworCisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGd0LT51bmNvcmUtPnJw
bSk7CisJZm9yIChncHVfZnJlcSA9IG1pbl9ncHVfZnJlcTsgZ3B1X2ZyZXEgPD0gbWF4X2dwdV9m
cmVxOyBncHVfZnJlcSsrKSB7CisJCWlhX2ZyZXEgPSBncHVfZnJlcTsKKwkJc2FuZHlicmlkZ2Vf
cGNvZGVfcmVhZChpOTE1LAorCQkJCSAgICAgICBHRU42X1BDT0RFX1JFQURfTUlOX0ZSRVFfVEFC
TEUsCisJCQkJICAgICAgICZpYV9mcmVxLCBOVUxMKTsKKwkJc2VxX3ByaW50ZihtLCAiJWRcdFx0
JWRcdFx0XHRcdCVkXG4iLAorCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLAorCQkJCQkgIChncHVf
ZnJlcSAqCisJCQkJCSAgIChJU19HRU45X0JDKGk5MTUpIHx8CisJCQkJCSAgICBJTlRFTF9HRU4o
aTkxNSkgPj0gMTAgPworCQkJCQkgICAgR0VOOV9GUkVRX1NDQUxFUiA6IDEpKSksCisJCQkgICAo
KGlhX2ZyZXEgPj4gMCkgJiAweGZmKSAqIDEwMCwKKwkJCSAgICgoaWFfZnJlcSA+PiA4KSAmIDB4
ZmYpICogMTAwKTsKKwl9CisJaW50ZWxfcnVudGltZV9wbV9wdXQoZ3QtPnVuY29yZS0+cnBtLCB3
YWtlcmVmKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgYm9vbCByaW5nX2ZyZXFfdGFibGVf
ZXZhbChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQoreworCXJldHVybiBIQVNfTExDKGd0LT5pOTE1KSA/
IHRydWUgOiBmYWxzZTsKK30KKworREVGSU5FX0dUX0RFQlVHRlNfQVRUUklCVVRFKHJpbmdfZnJl
cV90YWJsZSk7CisKK3N0YXRpYyBjb25zdCBjaGFyICpycHNfcG93ZXJfdG9fc3RyKHVuc2lnbmVk
IGludCBwb3dlcikKK3sKKwlzdGF0aWMgY29uc3QgY2hhciAqIGNvbnN0IHN0cmluZ3NbXSA9IHsK
KwkJW0xPV19QT1dFUl0gPSAibG93IHBvd2VyIiwKKwkJW0JFVFdFRU5dID0gIm1peGVkIiwKKwkJ
W0hJR0hfUE9XRVJdID0gImhpZ2ggcG93ZXIiLAorCX07CisKKwlpZiAocG93ZXIgPj0gQVJSQVlf
U0laRShzdHJpbmdzKSB8fCAhc3RyaW5nc1twb3dlcl0pCisJCXJldHVybiAidW5rbm93biI7CisK
KwlyZXR1cm4gc3RyaW5nc1twb3dlcl07Cit9CisKK3N0YXRpYyBpbnQgcnBzX2Jvb3N0X2luZm9f
c2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCit7CisJc3RydWN0IGludGVsX2d0
ICpndCA9IG0tPnByaXZhdGU7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndC0+
aTkxNTsKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBndC0+dW5jb3JlOworCXN0cnVj
dCBpbnRlbF9ycHMgKnJwcyA9ICZndC0+cnBzOworCXUzMiBhY3RfZnJlcTsKKwlpbnRlbF93YWtl
cmVmX3Qgd2FrZXJlZjsKKworCXdpdGhfaW50ZWxfcnVudGltZV9wbV9pZl9pbl91c2UodW5jb3Jl
LT5ycG0sIHdha2VyZWYpCisJCWFjdF9mcmVxID0gaW50ZWxfcnBzX3JlYWRfYWN0dWFsX2ZyZXF1
ZW5jeShycHMpOworCisJc2VxX3ByaW50ZihtLCAiUlBTIGVuYWJsZWQ/ICVkXG4iLCBycHMtPmVu
YWJsZWQpOworCXNlcV9wcmludGYobSwgIkdQVSBidXN5PyAlc1xuIiwgeWVzbm8oZ3QtPmF3YWtl
KSk7CisJc2VxX3ByaW50ZihtLCAiQm9vc3RzIG91dHN0YW5kaW5nPyAlZFxuIiwKKwkJICAgYXRv
bWljX3JlYWQoJnJwcy0+bnVtX3dhaXRlcnMpKTsKKwlzZXFfcHJpbnRmKG0sICJJbnRlcmFjdGl2
ZT8gJWRcbiIsIFJFQURfT05DRShycHMtPnBvd2VyLmludGVyYWN0aXZlKSk7CisJc2VxX3ByaW50
ZihtLCAiRnJlcXVlbmN5IHJlcXVlc3RlZCAlZCwgYWN0dWFsICVkXG4iLAorCQkgICBpbnRlbF9n
cHVfZnJlcShycHMsIHJwcy0+Y3VyX2ZyZXEpLCBhY3RfZnJlcSk7CisJc2VxX3ByaW50ZihtLCAi
ICBtaW4gaGFyZDolZCwgc29mdDolZDsgbWF4IHNvZnQ6JWQsIGhhcmQ6JWRcbiIsCisJCSAgIGlu
dGVsX2dwdV9mcmVxKHJwcywgcnBzLT5taW5fZnJlcSksCisJCSAgIGludGVsX2dwdV9mcmVxKHJw
cywgcnBzLT5taW5fZnJlcV9zb2Z0bGltaXQpLAorCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJw
cy0+bWF4X2ZyZXFfc29mdGxpbWl0KSwKKwkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPm1h
eF9mcmVxKSk7CisJc2VxX3ByaW50ZihtLCAiICBpZGxlOiVkLCBlZmZpY2llbnQ6JWQsIGJvb3N0
OiVkXG4iLAorCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+aWRsZV9mcmVxKSwKKwkJICAg
aW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmVmZmljaWVudF9mcmVxKSwKKwkJICAgaW50ZWxfZ3B1
X2ZyZXEocnBzLCBycHMtPmJvb3N0X2ZyZXEpKTsKKworCXNlcV9wcmludGYobSwgIldhaXQgYm9v
c3RzOiAlZFxuIiwgYXRvbWljX3JlYWQoJnJwcy0+Ym9vc3RzKSk7CisKKwlpZiAoSU5URUxfR0VO
KGk5MTUpID49IDYgJiYgcnBzLT5lbmFibGVkICYmIGd0LT5hd2FrZSkgeworCQl1MzIgcnB1cCwg
cnB1cGVpOworCQl1MzIgcnBkb3duLCBycGRvd25laTsKKworCQlpbnRlbF91bmNvcmVfZm9yY2V3
YWtlX2dldCh1bmNvcmUsIEZPUkNFV0FLRV9BTEwpOworCQlycHVwID0gaW50ZWxfdW5jb3JlX3Jl
YWRfZncodW5jb3JlLCBHRU42X1JQX0NVUl9VUCkgJiBHRU42X1JQX0VJX01BU0s7CisJCXJwdXBl
aSA9IGludGVsX3VuY29yZV9yZWFkX2Z3KHVuY29yZSwgR0VONl9SUF9DVVJfVVBfRUkpICYgR0VO
Nl9SUF9FSV9NQVNLOworCQlycGRvd24gPSBpbnRlbF91bmNvcmVfcmVhZF9mdyh1bmNvcmUsIEdF
TjZfUlBfQ1VSX0RPV04pICYgR0VONl9SUF9FSV9NQVNLOworCQlycGRvd25laSA9IGludGVsX3Vu
Y29yZV9yZWFkX2Z3KHVuY29yZSwgR0VONl9SUF9DVVJfRE9XTl9FSSkgJiBHRU42X1JQX0VJX01B
U0s7CisJCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KHVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7
CisKKwkJc2VxX3ByaW50ZihtLCAiXG5SUFMgQXV0b3R1bmluZyAoY3VycmVudCBcIiVzXCIgd2lu
ZG93KTpcbiIsCisJCQkgICBycHNfcG93ZXJfdG9fc3RyKHJwcy0+cG93ZXIubW9kZSkpOworCQlz
ZXFfcHJpbnRmKG0sICIgIEF2Zy4gdXA6ICVkJSUgW2Fib3ZlIHRocmVzaG9sZD8gJWQlJV1cbiIs
CisJCQkgICBycHVwICYmIHJwdXBlaSA/IDEwMCAqIHJwdXAgLyBycHVwZWkgOiAwLAorCQkJICAg
cnBzLT5wb3dlci51cF90aHJlc2hvbGQpOworCQlzZXFfcHJpbnRmKG0sICIgIEF2Zy4gZG93bjog
JWQlJSBbYmVsb3cgdGhyZXNob2xkPyAlZCUlXVxuIiwKKwkJCSAgIHJwZG93biAmJiBycGRvd25l
aSA/IDEwMCAqIHJwZG93biAvIHJwZG93bmVpIDogMCwKKwkJCSAgIHJwcy0+cG93ZXIuZG93bl90
aHJlc2hvbGQpOworCX0gZWxzZSB7CisJCXNlcV9wdXRzKG0sICJcblJQUyBBdXRvdHVuaW5nIGlu
YWN0aXZlXG4iKTsKKwl9CisKKwlyZXR1cm4gMDsKK30KK0RFRklORV9HVF9ERUJVR0ZTX0FUVFJJ
QlVURShycHNfYm9vc3RfaW5mbyk7CisKK3N0YXRpYyBpbnQgZm9yY2V3YWtlX2RvbWFpbnNfc2hv
dyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCit7CisJc3RydWN0IGludGVsX2d0ICpn
dCA9IG0tPnByaXZhdGU7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gZ3QtPnVuY29y
ZTsKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9kb21haW4gKmZ3X2RvbWFpbjsKKwl1
bnNpZ25lZCBpbnQgdG1wOworCisJc2VxX3ByaW50ZihtLCAidXNlci5ieXBhc3NfY291bnQgPSAl
dVxuIiwKKwkJICAgdW5jb3JlLT51c2VyX2ZvcmNld2FrZV9jb3VudCk7CisKKwlmb3JfZWFjaF9m
d19kb21haW4oZndfZG9tYWluLCB1bmNvcmUsIHRtcCkKKwkJc2VxX3ByaW50ZihtLCAiJXMud2Fr
ZV9jb3VudCA9ICV1XG4iLAorCQkJICAgaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9kb21haW5fdG9f
c3RyKGZ3X2RvbWFpbi0+aWQpLAorCQkJICAgUkVBRF9PTkNFKGZ3X2RvbWFpbi0+d2FrZV9jb3Vu
dCkpOworCisJcmV0dXJuIDA7Cit9CitERUZJTkVfR1RfREVCVUdGU19BVFRSSUJVVEUoZm9yY2V3
YWtlX2RvbWFpbnMpOworCitzdGF0aWMgdm9pZCBwcmludF9yYzZfcmVzKHN0cnVjdCBzZXFfZmls
ZSAqbSwKKwkJCSAgY29uc3QgY2hhciAqdGl0bGUsCisJCQkgIGNvbnN0IGk5MTVfcmVnX3QgcmVn
KQoreworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBtLT5wcml2YXRlOworCWludGVsX3dha2VyZWZf
dCB3YWtlcmVmOworCisJd2l0aF9pbnRlbF9ydW50aW1lX3BtKGd0LT51bmNvcmUtPnJwbSwgd2Fr
ZXJlZikKKwkJc2VxX3ByaW50ZihtLCAiJXMgJXUgKCVsbHUgdXMpXG4iLCB0aXRsZSwKKwkJCSAg
IGludGVsX3VuY29yZV9yZWFkKGd0LT51bmNvcmUsIHJlZyksCisJCQkgICBpbnRlbF9yYzZfcmVz
aWRlbmN5X3VzKCZndC0+cmM2LCByZWcpKTsKK30KKworc3RhdGljIGludCB2bHZfZHJwY19pbmZv
KHN0cnVjdCBzZXFfZmlsZSAqbSkKK3sKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gbS0+cHJpdmF0
ZTsKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBndC0+dW5jb3JlOworCXUzMiByY2N0
bDEsIHB3X3N0YXR1czsKKworCXB3X3N0YXR1cyA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwg
VkxWX0dUTENfUFdfU1RBVFVTKTsKKwlyY2N0bDEgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUs
IEdFTjZfUkNfQ09OVFJPTCk7CisKKwlzZXFfcHJpbnRmKG0sICJSQzYgRW5hYmxlZDogJXNcbiIs
CisJCSAgIHllc25vKHJjY3RsMSAmIChHRU43X1JDX0NUTF9UT19NT0RFIHwKKwkJCQkJR0VONl9S
Q19DVExfRUlfTU9ERSgxKSkpKTsKKwlzZXFfcHJpbnRmKG0sICJSZW5kZXIgUG93ZXIgV2VsbDog
JXNcbiIsCisJCSAgIChwd19zdGF0dXMgJiBWTFZfR1RMQ19QV19SRU5ERVJfU1RBVFVTX01BU0sp
ID8gIlVwIiA6ICJEb3duIik7CisJc2VxX3ByaW50ZihtLCAiTWVkaWEgUG93ZXIgV2VsbDogJXNc
biIsCisJCSAgIChwd19zdGF0dXMgJiBWTFZfR1RMQ19QV19NRURJQV9TVEFUVVNfTUFTSykgPyAi
VXAiIDogIkRvd24iKTsKKworCXByaW50X3JjNl9yZXMobSwgIlJlbmRlciBSQzYgcmVzaWRlbmN5
IHNpbmNlIGJvb3Q6IiwgVkxWX0dUX1JFTkRFUl9SQzYpOworCXByaW50X3JjNl9yZXMobSwgIk1l
ZGlhIFJDNiByZXNpZGVuY3kgc2luY2UgYm9vdDoiLCBWTFZfR1RfTUVESUFfUkM2KTsKKworCXJl
dHVybiBmb3JjZXdha2VfZG9tYWluc19zaG93KG0sIE5VTEwpOworfQorCitzdGF0aWMgaW50IGdl
bjZfZHJwY19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSkKK3sKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0
ID0gbS0+cHJpdmF0ZTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd0LT5pOTE1
OworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IGd0LT51bmNvcmU7CisJdTMyIGd0X2Nv
cmVfc3RhdHVzLCByY2N0bDEsIHJjNnZpZHMgPSAwOworCXUzMiBnZW45X3Bvd2VyZ2F0ZV9lbmFi
bGUgPSAwLCBnZW45X3Bvd2VyZ2F0ZV9zdGF0dXMgPSAwOworCisJZ3RfY29yZV9zdGF0dXMgPSBp
bnRlbF91bmNvcmVfcmVhZF9mdyh1bmNvcmUsIEdFTjZfR1RfQ09SRV9TVEFUVVMpOworCXRyYWNl
X2k5MTVfcmVnX3J3KGZhbHNlLCBHRU42X0dUX0NPUkVfU1RBVFVTLCBndF9jb3JlX3N0YXR1cywg
NCwgdHJ1ZSk7CisKKwlyY2N0bDEgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUkNf
Q09OVFJPTCk7CisJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KSB7CisJCWdlbjlfcG93ZXJnYXRl
X2VuYWJsZSA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwKKwkJCQkJCUdFTjlfUEdfRU5BQkxF
KTsKKwkJZ2VuOV9wb3dlcmdhdGVfc3RhdHVzID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLAor
CQkJCQkJR0VOOV9QV1JHVF9ET01BSU5fU1RBVFVTKTsKKwl9CisKKwlpZiAoSU5URUxfR0VOKGk5
MTUpIDw9IDcpCisJCXNhbmR5YnJpZGdlX3Bjb2RlX3JlYWQoaTkxNSwgR0VONl9QQ09ERV9SRUFE
X1JDNlZJRFMsCisJCQkJICAgICAgICZyYzZ2aWRzLCBOVUxMKTsKKworCXNlcV9wcmludGYobSwg
IlJDMWUgRW5hYmxlZDogJXNcbiIsCisJCSAgIHllc25vKHJjY3RsMSAmIEdFTjZfUkNfQ1RMX1JD
MWVfRU5BQkxFKSk7CisJc2VxX3ByaW50ZihtLCAiUkM2IEVuYWJsZWQ6ICVzXG4iLAorCQkgICB5
ZXNubyhyY2N0bDEgJiBHRU42X1JDX0NUTF9SQzZfRU5BQkxFKSk7CisJaWYgKElOVEVMX0dFTihp
OTE1KSA+PSA5KSB7CisJCXNlcV9wcmludGYobSwgIlJlbmRlciBXZWxsIEdhdGluZyBFbmFibGVk
OiAlc1xuIiwKKwkJCXllc25vKGdlbjlfcG93ZXJnYXRlX2VuYWJsZSAmIEdFTjlfUkVOREVSX1BH
X0VOQUJMRSkpOworCQlzZXFfcHJpbnRmKG0sICJNZWRpYSBXZWxsIEdhdGluZyBFbmFibGVkOiAl
c1xuIiwKKwkJCXllc25vKGdlbjlfcG93ZXJnYXRlX2VuYWJsZSAmIEdFTjlfTUVESUFfUEdfRU5B
QkxFKSk7CisJfQorCXNlcV9wcmludGYobSwgIkRlZXAgUkM2IEVuYWJsZWQ6ICVzXG4iLAorCQkg
ICB5ZXNubyhyY2N0bDEgJiBHRU42X1JDX0NUTF9SQzZwX0VOQUJMRSkpOworCXNlcV9wcmludGYo
bSwgIkRlZXBlc3QgUkM2IEVuYWJsZWQ6ICVzXG4iLAorCQkgICB5ZXNubyhyY2N0bDEgJiBHRU42
X1JDX0NUTF9SQzZwcF9FTkFCTEUpKTsKKwlzZXFfcHV0cyhtLCAiQ3VycmVudCBSQyBzdGF0ZTog
Iik7CisJc3dpdGNoIChndF9jb3JlX3N0YXR1cyAmIEdFTjZfUkNuX01BU0spIHsKKwljYXNlIEdF
TjZfUkMwOgorCQlpZiAoZ3RfY29yZV9zdGF0dXMgJiBHRU42X0NPUkVfQ1BEX1NUQVRFX01BU0sp
CisJCQlzZXFfcHV0cyhtLCAiQ29yZSBQb3dlciBEb3duXG4iKTsKKwkJZWxzZQorCQkJc2VxX3B1
dHMobSwgIm9uXG4iKTsKKwkJYnJlYWs7CisJY2FzZSBHRU42X1JDMzoKKwkJc2VxX3B1dHMobSwg
IlJDM1xuIik7CisJCWJyZWFrOworCWNhc2UgR0VONl9SQzY6CisJCXNlcV9wdXRzKG0sICJSQzZc
biIpOworCQlicmVhazsKKwljYXNlIEdFTjZfUkM3OgorCQlzZXFfcHV0cyhtLCAiUkM3XG4iKTsK
KwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJc2VxX3B1dHMobSwgIlVua25vd25cbiIpOworCQlicmVh
azsKKwl9CisKKwlzZXFfcHJpbnRmKG0sICJDb3JlIFBvd2VyIERvd246ICVzXG4iLAorCQkgICB5
ZXNubyhndF9jb3JlX3N0YXR1cyAmIEdFTjZfQ09SRV9DUERfU1RBVEVfTUFTSykpOworCWlmIChJ
TlRFTF9HRU4oaTkxNSkgPj0gOSkgeworCQlzZXFfcHJpbnRmKG0sICJSZW5kZXIgUG93ZXIgV2Vs
bDogJXNcbiIsCisJCQkoZ2VuOV9wb3dlcmdhdGVfc3RhdHVzICYKKwkJCSBHRU45X1BXUkdUX1JF
TkRFUl9TVEFUVVNfTUFTSykgPyAiVXAiIDogIkRvd24iKTsKKwkJc2VxX3ByaW50ZihtLCAiTWVk
aWEgUG93ZXIgV2VsbDogJXNcbiIsCisJCQkoZ2VuOV9wb3dlcmdhdGVfc3RhdHVzICYKKwkJCSBH
RU45X1BXUkdUX01FRElBX1NUQVRVU19NQVNLKSA/ICJVcCIgOiAiRG93biIpOworCX0KKworCS8q
IE5vdCBleGFjdGx5IHN1cmUgd2hhdCB0aGlzIGlzICovCisJcHJpbnRfcmM2X3JlcyhtLCAiUkM2
IFwiTG9ja2VkIHRvIFJQblwiIHJlc2lkZW5jeSBzaW5jZSBib290OiIsCisJCSAgICAgIEdFTjZf
R1RfR0ZYX1JDNl9MT0NLRUQpOworCXByaW50X3JjNl9yZXMobSwgIlJDNiByZXNpZGVuY3kgc2lu
Y2UgYm9vdDoiLCBHRU42X0dUX0dGWF9SQzYpOworCXByaW50X3JjNl9yZXMobSwgIlJDNisgcmVz
aWRlbmN5IHNpbmNlIGJvb3Q6IiwgR0VONl9HVF9HRlhfUkM2cCk7CisJcHJpbnRfcmM2X3Jlcyht
LCAiUkM2KysgcmVzaWRlbmN5IHNpbmNlIGJvb3Q6IiwgR0VONl9HVF9HRlhfUkM2cHApOworCisJ
aWYgKElOVEVMX0dFTihpOTE1KSA8PSA3KSB7CisJCXNlcV9wcmludGYobSwgIlJDNiAgIHZvbHRh
Z2U6ICVkbVZcbiIsCisJCQkgICBHRU42X0RFQ09ERV9SQzZfVklEKCgocmM2dmlkcyA+PiAwKSAm
IDB4ZmYpKSk7CisJCXNlcV9wcmludGYobSwgIlJDNisgIHZvbHRhZ2U6ICVkbVZcbiIsCisJCQkg
ICBHRU42X0RFQ09ERV9SQzZfVklEKCgocmM2dmlkcyA+PiA4KSAmIDB4ZmYpKSk7CisJCXNlcV9w
cmludGYobSwgIlJDNisrIHZvbHRhZ2U6ICVkbVZcbiIsCisJCQkgICBHRU42X0RFQ09ERV9SQzZf
VklEKCgocmM2dmlkcyA+PiAxNikgJiAweGZmKSkpOworCX0KKworCXJldHVybiBmb3JjZXdha2Vf
ZG9tYWluc19zaG93KG0sIE5VTEwpOworfQorCitzdGF0aWMgaW50IGlyb25sYWtlX2RycGNfaW5m
byhzdHJ1Y3Qgc2VxX2ZpbGUgKm0pCit7CisJc3RydWN0IGludGVsX2d0ICpndCA9IG0tPnByaXZh
dGU7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gZ3QtPnVuY29yZTsKKwl1MzIgcmd2
bW9kZWN0bCwgcnN0ZGJ5Y3RsOworCXUxNiBjcnN0YW5kdmlkOworCisJcmd2bW9kZWN0bCA9IGlu
dGVsX3VuY29yZV9yZWFkKHVuY29yZSwgTUVNTU9ERUNUTCk7CisJcnN0ZGJ5Y3RsID0gaW50ZWxf
dW5jb3JlX3JlYWQodW5jb3JlLCBSU1REQllDVEwpOworCWNyc3RhbmR2aWQgPSBpbnRlbF91bmNv
cmVfcmVhZDE2KHVuY29yZSwgQ1JTVEFORFZJRCk7CisKKwlzZXFfcHJpbnRmKG0sICJIRCBib29z
dDogJXNcbiIsIHllc25vKHJndm1vZGVjdGwgJiBNRU1NT0RFX0JPT1NUX0VOKSk7CisJc2VxX3By
aW50ZihtLCAiQm9vc3QgZnJlcTogJWRcbiIsCisJCSAgIChyZ3Ztb2RlY3RsICYgTUVNTU9ERV9C
T09TVF9GUkVRX01BU0spID4+CisJCSAgIE1FTU1PREVfQk9PU1RfRlJFUV9TSElGVCk7CisJc2Vx
X3ByaW50ZihtLCAiSFcgY29udHJvbCBlbmFibGVkOiAlc1xuIiwKKwkJICAgeWVzbm8ocmd2bW9k
ZWN0bCAmIE1FTU1PREVfSFdJRExFX0VOKSk7CisJc2VxX3ByaW50ZihtLCAiU1cgY29udHJvbCBl
bmFibGVkOiAlc1xuIiwKKwkJICAgeWVzbm8ocmd2bW9kZWN0bCAmIE1FTU1PREVfU1dNT0RFX0VO
KSk7CisJc2VxX3ByaW50ZihtLCAiR2F0ZWQgdm9sdGFnZSBjaGFuZ2U6ICVzXG4iLAorCQkgICB5
ZXNubyhyZ3Ztb2RlY3RsICYgTUVNTU9ERV9SQ0xLX0dBVEUpKTsKKwlzZXFfcHJpbnRmKG0sICJT
dGFydGluZyBmcmVxdWVuY3k6IFAlZFxuIiwKKwkJICAgKHJndm1vZGVjdGwgJiBNRU1NT0RFX0ZT
VEFSVF9NQVNLKSA+PiBNRU1NT0RFX0ZTVEFSVF9TSElGVCk7CisJc2VxX3ByaW50ZihtLCAiTWF4
IFAtc3RhdGU6IFAlZFxuIiwKKwkJICAgKHJndm1vZGVjdGwgJiBNRU1NT0RFX0ZNQVhfTUFTSykg
Pj4gTUVNTU9ERV9GTUFYX1NISUZUKTsKKwlzZXFfcHJpbnRmKG0sICJNaW4gUC1zdGF0ZTogUCVk
XG4iLCAocmd2bW9kZWN0bCAmIE1FTU1PREVfRk1JTl9NQVNLKSk7CisJc2VxX3ByaW50ZihtLCAi
UlMxIFZJRDogJWRcbiIsIChjcnN0YW5kdmlkICYgMHgzZikpOworCXNlcV9wcmludGYobSwgIlJT
MiBWSUQ6ICVkXG4iLCAoKGNyc3RhbmR2aWQgPj4gOCkgJiAweDNmKSk7CisJc2VxX3ByaW50Ziht
LCAiUmVuZGVyIHN0YW5kYnkgZW5hYmxlZDogJXNcbiIsCisJCSAgIHllc25vKCEocnN0ZGJ5Y3Rs
ICYgUkNYX1NXX0VYSVQpKSk7CisJc2VxX3B1dHMobSwgIkN1cnJlbnQgUlMgc3RhdGU6ICIpOwor
CXN3aXRjaCAocnN0ZGJ5Y3RsICYgUlNYX1NUQVRVU19NQVNLKSB7CisJY2FzZSBSU1hfU1RBVFVT
X09OOgorCQlzZXFfcHV0cyhtLCAib25cbiIpOworCQlicmVhazsKKwljYXNlIFJTWF9TVEFUVVNf
UkMxOgorCQlzZXFfcHV0cyhtLCAiUkMxXG4iKTsKKwkJYnJlYWs7CisJY2FzZSBSU1hfU1RBVFVT
X1JDMUU6CisJCXNlcV9wdXRzKG0sICJSQzFFXG4iKTsKKwkJYnJlYWs7CisJY2FzZSBSU1hfU1RB
VFVTX1JTMToKKwkJc2VxX3B1dHMobSwgIlJTMVxuIik7CisJCWJyZWFrOworCWNhc2UgUlNYX1NU
QVRVU19SUzI6CisJCXNlcV9wdXRzKG0sICJSUzIgKFJDNilcbiIpOworCQlicmVhazsKKwljYXNl
IFJTWF9TVEFUVVNfUlMzOgorCQlzZXFfcHV0cyhtLCAiUkMzIChSQzYrKVxuIik7CisJCWJyZWFr
OworCWRlZmF1bHQ6CisJCXNlcV9wdXRzKG0sICJ1bmtub3duXG4iKTsKKwkJYnJlYWs7CisJfQor
CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgZHJwY19pbmZvX3Nob3coc3RydWN0IHNlcV9m
aWxlICptLCB2b2lkICp1bnVzZWQpCit7CisJc3RydWN0IGludGVsX2d0ICpndCA9IG0tPnByaXZh
dGU7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndC0+aTkxNTsKKwlpbnRlbF93
YWtlcmVmX3Qgd2FrZXJlZjsKKwlpbnQgZXJyID0gLUVOT0RFVjsKKworCXdpdGhfaW50ZWxfcnVu
dGltZV9wbShndC0+dW5jb3JlLT5ycG0sIHdha2VyZWYpIHsKKwkJaWYgKElTX1ZBTExFWVZJRVco
aTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkKKwkJCWVyciA9IHZsdl9kcnBjX2luZm8obSk7
CisJCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA2KQorCQkJZXJyID0gZ2VuNl9kcnBjX2lu
Zm8obSk7CisJCWVsc2UKKwkJCWVyciA9IGlyb25sYWtlX2RycGNfaW5mbyhtKTsKKwl9CisKKwly
ZXR1cm4gZXJyOworfQorREVGSU5FX0dUX0RFQlVHRlNfQVRUUklCVVRFKGRycGNfaW5mbyk7CisK
K3N0YXRpYyBpbnQgbGxjX3Nob3coc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQorewor
CXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBtLT5wcml2YXRlOworCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gZ3QtPmk5MTU7CisJY29uc3QgYm9vbCBlZHJhbSA9IElOVEVMX0dFTihpOTE1
KSA+IDg7CisKKwlzZXFfcHJpbnRmKG0sICJMTEM6ICVzXG4iLCB5ZXNubyhIQVNfTExDKGk5MTUp
KSk7CisJc2VxX3ByaW50ZihtLCAiJXM6ICV1TUJcbiIsIGVkcmFtID8gImVEUkFNIiA6ICJlTExD
IiwKKwkJICAgaTkxNS0+ZWRyYW1fc2l6ZV9tYik7CisKKwlyZXR1cm4gMDsKK30KK0RFRklORV9H
VF9ERUJVR0ZTX0FUVFJJQlVURShsbGMpOworCitzdGF0aWMgY29uc3Qgc3RydWN0IGd0X3BtX2Rl
YnVnZnNfZmlsZXMgeworCWNvbnN0IGNoYXIgKm5hbWU7CisJY29uc3Qgc3RydWN0IGZpbGVfb3Bl
cmF0aW9ucyAqZm9wczsKKwlib29sICgqZXZhbCkoc3RydWN0IGludGVsX2d0ICpndCk7Cit9IGd0
X3BtX2RlYnVnZnNfZmlsZXNbXSA9IHsKKwl7ICJmcmVxdWVuY3lfaW5mbyIsICZmcmVxdWVuY3lf
aW5mb19mb3BzLCBOVUxMIH0sCisJeyAicmluZ19mcmVxX3RhYmxlIiwgJnJpbmdfZnJlcV90YWJs
ZV9mb3BzLCByaW5nX2ZyZXFfdGFibGVfZXZhbCB9LAorCXsgInJwc19ib29zdF9pbmZvIiwgJnJw
c19ib29zdF9pbmZvX2ZvcHMsIE5VTEwgfSwKKwl7ICJmb3JjZXdha2VfZG9tYWlucyIsICZmb3Jj
ZXdha2VfZG9tYWluc19mb3BzLCBOVUxMIH0sCisJeyAiZHJwY19pbmZvIiwgJmRycGNfaW5mb19m
b3BzLCBOVUxMIH0sCisJeyAibGxjIiwgJmxsY19mb3BzLCBOVUxMIH0sCit9OworCitpbnQgaW50
ZWxfZ3RfcG1fZGVidWdmc19yZWdpc3RlcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQoreworCXN0cnVj
dCBkZW50cnkgKnJvb3QgPSBndC0+ZGVidWdmc19lbnRyeTsKKwlpbnQgaTsKKworCXByX2luZm8o
IkFORElJSSBmdW5jdGlvbiBzdGFydFxuIik7CisJaWYgKHVubGlrZWx5KCFyb290KSkKKwkJcmV0
dXJuIC1FTk9ERVY7CisKKwlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShndF9wbV9kZWJ1Z2Zz
X2ZpbGVzKTsgaSsrKSB7CisJCWNvbnN0IHN0cnVjdCBndF9wbV9kZWJ1Z2ZzX2ZpbGVzICpmID0g
Jmd0X3BtX2RlYnVnZnNfZmlsZXNbaV07CisKKwkJaWYgKGYtPmV2YWwgJiYgIWYtPmV2YWwoZ3Qp
KQorCQkJY29udGludWU7CisKKwkJZGVidWdmc19jcmVhdGVfZmlsZShmLT5uYW1lLCAwNDQ0LCBy
b290LCBndCwgZi0+Zm9wcyk7CisJfQorCXByX2luZm8oIkFORElJSSBmdW5jdGlvbiBlbmRcbiIp
OworCisJcmV0dXJuIDA7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9k
ZWJ1Z2ZzX3BtLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX3BtLmgKbmV3IGZp
bGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5iNjFjNmJjOGE2OTQKLS0tIC9kZXYv
bnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX3BtLmgKQEAgLTAsMCAr
MSwxNiBAQAorLyoKKyAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBNSVQKKyAqCisgKiBDb3B5
cmlnaHQgwqkgMjAxOSBJbnRlbCBDb3Jwb3JhdGlvbgorICovCisKKyNpZm5kZWYgREVCVUdGU19Q
TQorI2RlZmluZSBERUJVR0ZTX1BNCisKKyNpbmNsdWRlIDxsaW51eC9zZXFfZmlsZS5oPgorCisj
aW5jbHVkZSAiaW50ZWxfZ3RfdHlwZXMuaCIKKworaW50IGludGVsX2d0X3BtX2RlYnVnZnNfcmVn
aXN0ZXIoc3RydWN0IGludGVsX2d0ICpndCk7CisKKyNlbmRpZiAvKiBERUJVR0ZTX1BNICovCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF90eXBlcy5oIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfdHlwZXMuaAppbmRleCBkNGUxNGRiZDE3MmUu
LjMzMmIwODRmOWMwNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
Z3RfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF90eXBlcy5o
CkBAIC05MCw2ICs5MCw5IEBAIHN0cnVjdCBpbnRlbF9ndCB7CiAJc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lW0k5MTVfTlVNX0VOR0lORVNdOwogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZV9jbGFzc1tNQVhfRU5HSU5FX0NMQVNTICsgMV0KIAkJCQkJICAgIFtNQVhfRU5HSU5F
X0lOU1RBTkNFICsgMV07CisKKwkvKiogQGRlYnVnZnNfZW50cnk6IGRlYnVnZnMgZGlyZWN0b3J5
IGZvciB0aGlzIEdUICovCisJc3RydWN0IGRlbnRyeSAqZGVidWdmc19lbnRyeTsKIH07CiAKIGVu
dW0gaW50ZWxfZ3Rfc2NyYXRjaF9maWVsZCB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2RlYnVnZnMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5j
CmluZGV4IDNlYzI2YjZhNDhjMS4uY2ZlM2RkMzA4YzY3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2RlYnVnZnMuYwpAQCAtNDAsMTEgKzQwLDEwIEBACiAjaW5jbHVkZSAiZGlzcGxheS9pbnRlbF9w
c3IuaCIKIAogI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9jb250ZXh0LmgiCisjaW5jbHVkZSAiZ3Qv
ZGVidWdmc19ndC5oIgogI2luY2x1ZGUgImd0L2ludGVsX2d0X3BtLmgiCiAjaW5jbHVkZSAiZ3Qv
aW50ZWxfZ3RfcmVxdWVzdHMuaCIKICNpbmNsdWRlICJndC9pbnRlbF9yZXNldC5oIgotI2luY2x1
ZGUgImd0L2ludGVsX3JjNi5oIgotI2luY2x1ZGUgImd0L2ludGVsX3Jwcy5oIgogI2luY2x1ZGUg
Imd0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9uLmgiCiAKICNpbmNsdWRlICJpOTE1X2RlYnVnZnMu
aCIKQEAgLTc3OCw0NDMgKzc3Nyw2IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVyYXRp
b25zIGk5MTVfZXJyb3Jfc3RhdGVfZm9wcyA9IHsKIH07CiAjZW5kaWYKIAotc3RhdGljIGludCBp
OTE1X2ZyZXF1ZW5jeV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQotewot
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2
YXRlKTsKLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsK
LQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0LnJwczsKLQlpbnRlbF93YWtl
cmVmX3Qgd2FrZXJlZjsKLQlpbnQgcmV0ID0gMDsKLQotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1l
X3BtX2dldCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOwotCi0JaWYgKElTX0dFTihkZXZfcHJpdiwg
NSkpIHsKLQkJdTE2IHJndnN3Y3RsID0gaW50ZWxfdW5jb3JlX3JlYWQxNih1bmNvcmUsIE1FTVNX
Q1RMKTsKLQkJdTE2IHJndnN0YXQgPSBpbnRlbF91bmNvcmVfcmVhZDE2KHVuY29yZSwgTUVNU1RB
VF9JTEspOwotCi0JCXNlcV9wcmludGYobSwgIlJlcXVlc3RlZCBQLXN0YXRlOiAlZFxuIiwgKHJn
dnN3Y3RsID4+IDgpICYgMHhmKTsKLQkJc2VxX3ByaW50ZihtLCAiUmVxdWVzdGVkIFZJRDogJWRc
biIsIHJndnN3Y3RsICYgMHgzZik7Ci0JCXNlcV9wcmludGYobSwgIkN1cnJlbnQgVklEOiAlZFxu
IiwgKHJndnN0YXQgJiBNRU1TVEFUX1ZJRF9NQVNLKSA+PgotCQkJICAgTUVNU1RBVF9WSURfU0hJ
RlQpOwotCQlzZXFfcHJpbnRmKG0sICJDdXJyZW50IFAtc3RhdGU6ICVkXG4iLAotCQkJICAgKHJn
dnN0YXQgJiBNRU1TVEFUX1BTVEFURV9NQVNLKSA+PiBNRU1TVEFUX1BTVEFURV9TSElGVCk7Ci0J
fSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9w
cml2KSkgewotCQl1MzIgcnBtb2RlY3RsLCBmcmVxX3N0czsKLQotCQlycG1vZGVjdGwgPSBJOTE1
X1JFQUQoR0VONl9SUF9DT05UUk9MKTsKLQkJc2VxX3ByaW50ZihtLCAiVmlkZW8gVHVyYm8gTW9k
ZTogJXNcbiIsCi0JCQkgICB5ZXNubyhycG1vZGVjdGwgJiBHRU42X1JQX01FRElBX1RVUkJPKSk7
Ci0JCXNlcV9wcmludGYobSwgIkhXIGNvbnRyb2wgZW5hYmxlZDogJXNcbiIsCi0JCQkgICB5ZXNu
byhycG1vZGVjdGwgJiBHRU42X1JQX0VOQUJMRSkpOwotCQlzZXFfcHJpbnRmKG0sICJTVyBjb250
cm9sIGVuYWJsZWQ6ICVzXG4iLAotCQkJICAgeWVzbm8oKHJwbW9kZWN0bCAmIEdFTjZfUlBfTUVE
SUFfTU9ERV9NQVNLKSA9PQotCQkJCSAgR0VONl9SUF9NRURJQV9TV19NT0RFKSk7Ci0KLQkJdmx2
X3B1bml0X2dldChkZXZfcHJpdik7Ci0JCWZyZXFfc3RzID0gdmx2X3B1bml0X3JlYWQoZGV2X3By
aXYsIFBVTklUX1JFR19HUFVfRlJFUV9TVFMpOwotCQl2bHZfcHVuaXRfcHV0KGRldl9wcml2KTsK
LQotCQlzZXFfcHJpbnRmKG0sICJQVU5JVF9SRUdfR1BVX0ZSRVFfU1RTOiAweCUwOHhcbiIsIGZy
ZXFfc3RzKTsKLQkJc2VxX3ByaW50ZihtLCAiRERSIGZyZXE6ICVkIE1IelxuIiwgZGV2X3ByaXYt
Pm1lbV9mcmVxKTsKLQotCQlzZXFfcHJpbnRmKG0sICJhY3R1YWwgR1BVIGZyZXE6ICVkIE1Ielxu
IiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgKGZyZXFfc3RzID4+IDgpICYgMHhmZikpOwot
Ci0JCXNlcV9wcmludGYobSwgImN1cnJlbnQgR1BVIGZyZXE6ICVkIE1IelxuIiwKLQkJCSAgIGlu
dGVsX2dwdV9mcmVxKHJwcywgcnBzLT5jdXJfZnJlcSkpOwotCi0JCXNlcV9wcmludGYobSwgIm1h
eCBHUFUgZnJlcTogJWQgTUh6XG4iLAotCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPm1h
eF9mcmVxKSk7Ci0KLQkJc2VxX3ByaW50ZihtLCAibWluIEdQVSBmcmVxOiAlZCBNSHpcbiIsCi0J
CQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWluX2ZyZXEpKTsKLQotCQlzZXFfcHJpbnRm
KG0sICJpZGxlIEdQVSBmcmVxOiAlZCBNSHpcbiIsCi0JCQkgICBpbnRlbF9ncHVfZnJlcShycHMs
IHJwcy0+aWRsZV9mcmVxKSk7Ci0KLQkJc2VxX3ByaW50ZihtLAotCQkJICAgImVmZmljaWVudCAo
UlBlKSBmcmVxdWVuY3k6ICVkIE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBz
LT5lZmZpY2llbnRfZnJlcSkpOwotCX0gZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA2
KSB7Ci0JCXUzMiBycF9zdGF0ZV9saW1pdHM7Ci0JCXUzMiBndF9wZXJmX3N0YXR1czsKLQkJdTMy
IHJwX3N0YXRlX2NhcDsKLQkJdTMyIHJwbW9kZWN0bCwgcnBpbmNsaW1pdCwgcnBkZWNsaW1pdDsK
LQkJdTMyIHJwc3RhdCwgY2FnZiwgcmVxZjsKLQkJdTMyIHJwdXBlaSwgcnBjdXJ1cCwgcnBwcmV2
dXA7Ci0JCXUzMiBycGRvd25laSwgcnBjdXJkb3duLCBycHByZXZkb3duOwotCQl1MzIgcG1faWVy
LCBwbV9pbXIsIHBtX2lzciwgcG1faWlyLCBwbV9tYXNrOwotCQlpbnQgbWF4X2ZyZXE7Ci0KLQkJ
cnBfc3RhdGVfbGltaXRzID0gSTkxNV9SRUFEKEdFTjZfUlBfU1RBVEVfTElNSVRTKTsKLQkJaWYg
KElTX0dFTjlfTFAoZGV2X3ByaXYpKSB7Ci0JCQlycF9zdGF0ZV9jYXAgPSBJOTE1X1JFQUQoQlhU
X1JQX1NUQVRFX0NBUCk7Ci0JCQlndF9wZXJmX3N0YXR1cyA9IEk5MTVfUkVBRChCWFRfR1RfUEVS
Rl9TVEFUVVMpOwotCQl9IGVsc2UgewotCQkJcnBfc3RhdGVfY2FwID0gSTkxNV9SRUFEKEdFTjZf
UlBfU1RBVEVfQ0FQKTsKLQkJCWd0X3BlcmZfc3RhdHVzID0gSTkxNV9SRUFEKEdFTjZfR1RfUEVS
Rl9TVEFUVVMpOwotCQl9Ci0KLQkJLyogUlBTVEFUMSBpcyBpbiB0aGUgR1QgcG93ZXIgd2VsbCAq
LwotCQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VX
QUtFX0FMTCk7Ci0KLQkJcmVxZiA9IEk5MTVfUkVBRChHRU42X1JQTlNXUkVRKTsKLQkJaWYgKElO
VEVMX0dFTihkZXZfcHJpdikgPj0gOSkKLQkJCXJlcWYgPj49IDIzOwotCQllbHNlIHsKLQkJCXJl
cWYgJj0gfkdFTjZfVFVSQk9fRElTQUJMRTsKLQkJCWlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8
fCBJU19CUk9BRFdFTEwoZGV2X3ByaXYpKQotCQkJCXJlcWYgPj49IDI0OwotCQkJZWxzZQotCQkJ
CXJlcWYgPj49IDI1OwotCQl9Ci0JCXJlcWYgPSBpbnRlbF9ncHVfZnJlcShycHMsIHJlcWYpOwot
Ci0JCXJwbW9kZWN0bCA9IEk5MTVfUkVBRChHRU42X1JQX0NPTlRST0wpOwotCQlycGluY2xpbWl0
ID0gSTkxNV9SRUFEKEdFTjZfUlBfVVBfVEhSRVNIT0xEKTsKLQkJcnBkZWNsaW1pdCA9IEk5MTVf
UkVBRChHRU42X1JQX0RPV05fVEhSRVNIT0xEKTsKLQotCQlycHN0YXQgPSBJOTE1X1JFQUQoR0VO
Nl9SUFNUQVQxKTsKLQkJcnB1cGVpID0gSTkxNV9SRUFEKEdFTjZfUlBfQ1VSX1VQX0VJKSAmIEdF
TjZfQ1VSSUNPTlRfTUFTSzsKLQkJcnBjdXJ1cCA9IEk5MTVfUkVBRChHRU42X1JQX0NVUl9VUCkg
JiBHRU42X0NVUkJTWVRBVkdfTUFTSzsKLQkJcnBwcmV2dXAgPSBJOTE1X1JFQUQoR0VONl9SUF9Q
UkVWX1VQKSAmIEdFTjZfQ1VSQlNZVEFWR19NQVNLOwotCQlycGRvd25laSA9IEk5MTVfUkVBRChH
RU42X1JQX0NVUl9ET1dOX0VJKSAmIEdFTjZfQ1VSSUFWR19NQVNLOwotCQlycGN1cmRvd24gPSBJ
OTE1X1JFQUQoR0VONl9SUF9DVVJfRE9XTikgJiBHRU42X0NVUkJTWVRBVkdfTUFTSzsKLQkJcnBw
cmV2ZG93biA9IEk5MTVfUkVBRChHRU42X1JQX1BSRVZfRE9XTikgJiBHRU42X0NVUkJTWVRBVkdf
TUFTSzsKLQkJY2FnZiA9IGludGVsX3Jwc19yZWFkX2FjdHVhbF9mcmVxdWVuY3kocnBzKTsKLQot
CQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtF
X0FMTCk7Ci0KLQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpIHsKLQkJCXBtX2llciA9
IEk5MTVfUkVBRChHRU4xMV9HUE1fV0dCT1hQRVJGX0lOVFJfRU5BQkxFKTsKLQkJCXBtX2ltciA9
IEk5MTVfUkVBRChHRU4xMV9HUE1fV0dCT1hQRVJGX0lOVFJfTUFTSyk7Ci0JCQkvKgotCQkJICog
VGhlIGVxdWl2YWxlbnQgdG8gdGhlIFBNIElTUiAmIElJUiBjYW5ub3QgYmUgcmVhZAotCQkJICog
d2l0aG91dCBhZmZlY3RpbmcgdGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIHN5c3RlbQotCQkJICov
Ci0JCQlwbV9pc3IgPSAwOwotCQkJcG1faWlyID0gMDsKLQkJfSBlbHNlIGlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDgpIHsKLQkJCXBtX2llciA9IEk5MTVfUkVBRChHRU44X0dUX0lFUigyKSk7
Ci0JCQlwbV9pbXIgPSBJOTE1X1JFQUQoR0VOOF9HVF9JTVIoMikpOwotCQkJcG1faXNyID0gSTkx
NV9SRUFEKEdFTjhfR1RfSVNSKDIpKTsKLQkJCXBtX2lpciA9IEk5MTVfUkVBRChHRU44X0dUX0lJ
UigyKSk7Ci0JCX0gZWxzZSB7Ci0JCQlwbV9pZXIgPSBJOTE1X1JFQUQoR0VONl9QTUlFUik7Ci0J
CQlwbV9pbXIgPSBJOTE1X1JFQUQoR0VONl9QTUlNUik7Ci0JCQlwbV9pc3IgPSBJOTE1X1JFQUQo
R0VONl9QTUlTUik7Ci0JCQlwbV9paXIgPSBJOTE1X1JFQUQoR0VONl9QTUlJUik7Ci0JCX0KLQkJ
cG1fbWFzayA9IEk5MTVfUkVBRChHRU42X1BNSU5UUk1TSyk7Ci0KLQkJc2VxX3ByaW50ZihtLCAi
VmlkZW8gVHVyYm8gTW9kZTogJXNcbiIsCi0JCQkgICB5ZXNubyhycG1vZGVjdGwgJiBHRU42X1JQ
X01FRElBX1RVUkJPKSk7Ci0JCXNlcV9wcmludGYobSwgIkhXIGNvbnRyb2wgZW5hYmxlZDogJXNc
biIsCi0JCQkgICB5ZXNubyhycG1vZGVjdGwgJiBHRU42X1JQX0VOQUJMRSkpOwotCQlzZXFfcHJp
bnRmKG0sICJTVyBjb250cm9sIGVuYWJsZWQ6ICVzXG4iLAotCQkJICAgeWVzbm8oKHJwbW9kZWN0
bCAmIEdFTjZfUlBfTUVESUFfTU9ERV9NQVNLKSA9PQotCQkJCSAgR0VONl9SUF9NRURJQV9TV19N
T0RFKSk7Ci0KLQkJc2VxX3ByaW50ZihtLCAiUE0gSUVSPTB4JTA4eCBJTVI9MHglMDh4LCBNQVNL
PTB4JTA4eFxuIiwKLQkJCSAgIHBtX2llciwgcG1faW1yLCBwbV9tYXNrKTsKLQkJaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPD0gMTApCi0JCQlzZXFfcHJpbnRmKG0sICJQTSBJU1I9MHglMDh4IElJ
Uj0weCUwOHhcbiIsCi0JCQkJICAgcG1faXNyLCBwbV9paXIpOwotCQlzZXFfcHJpbnRmKG0sICJw
bV9pbnRybXNrX21iejogMHglMDh4XG4iLAotCQkJICAgcnBzLT5wbV9pbnRybXNrX21ieik7Ci0J
CXNlcV9wcmludGYobSwgIkdUX1BFUkZfU1RBVFVTOiAweCUwOHhcbiIsIGd0X3BlcmZfc3RhdHVz
KTsKLQkJc2VxX3ByaW50ZihtLCAiUmVuZGVyIHAtc3RhdGUgcmF0aW86ICVkXG4iLAotCQkJICAg
KGd0X3BlcmZfc3RhdHVzICYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSA/IDB4MWZmMDAgOiAw
eGZmMDApKSA+PiA4KTsKLQkJc2VxX3ByaW50ZihtLCAiUmVuZGVyIHAtc3RhdGUgVklEOiAlZFxu
IiwKLQkJCSAgIGd0X3BlcmZfc3RhdHVzICYgMHhmZik7Ci0JCXNlcV9wcmludGYobSwgIlJlbmRl
ciBwLXN0YXRlIGxpbWl0OiAlZFxuIiwKLQkJCSAgIHJwX3N0YXRlX2xpbWl0cyAmIDB4ZmYpOwot
CQlzZXFfcHJpbnRmKG0sICJSUFNUQVQxOiAweCUwOHhcbiIsIHJwc3RhdCk7Ci0JCXNlcV9wcmlu
dGYobSwgIlJQTU9ERUNUTDogMHglMDh4XG4iLCBycG1vZGVjdGwpOwotCQlzZXFfcHJpbnRmKG0s
ICJSUElOQ0xJTUlUOiAweCUwOHhcbiIsIHJwaW5jbGltaXQpOwotCQlzZXFfcHJpbnRmKG0sICJS
UERFQ0xJTUlUOiAweCUwOHhcbiIsIHJwZGVjbGltaXQpOwotCQlzZXFfcHJpbnRmKG0sICJSUE5T
V1JFUTogJWRNSHpcbiIsIHJlcWYpOwotCQlzZXFfcHJpbnRmKG0sICJDQUdGOiAlZE1IelxuIiwg
Y2FnZik7Ci0JCXNlcV9wcmludGYobSwgIlJQIENVUiBVUCBFSTogJWQgKCVkdXMpXG4iLAotCQkJ
ICAgcnB1cGVpLCBHVF9QTV9JTlRFUlZBTF9UT19VUyhkZXZfcHJpdiwgcnB1cGVpKSk7Ci0JCXNl
cV9wcmludGYobSwgIlJQIENVUiBVUDogJWQgKCVkdXMpXG4iLAotCQkJICAgcnBjdXJ1cCwgR1Rf
UE1fSU5URVJWQUxfVE9fVVMoZGV2X3ByaXYsIHJwY3VydXApKTsKLQkJc2VxX3ByaW50ZihtLCAi
UlAgUFJFViBVUDogJWQgKCVkdXMpXG4iLAotCQkJICAgcnBwcmV2dXAsIEdUX1BNX0lOVEVSVkFM
X1RPX1VTKGRldl9wcml2LCBycHByZXZ1cCkpOwotCQlzZXFfcHJpbnRmKG0sICJVcCB0aHJlc2hv
bGQ6ICVkJSVcbiIsCi0JCQkgICBycHMtPnBvd2VyLnVwX3RocmVzaG9sZCk7Ci0KLQkJc2VxX3By
aW50ZihtLCAiUlAgQ1VSIERPV04gRUk6ICVkICglZHVzKVxuIiwKLQkJCSAgIHJwZG93bmVpLCBH
VF9QTV9JTlRFUlZBTF9UT19VUyhkZXZfcHJpdiwgcnBkb3duZWkpKTsKLQkJc2VxX3ByaW50Ziht
LCAiUlAgQ1VSIERPV046ICVkICglZHVzKVxuIiwKLQkJCSAgIHJwY3VyZG93biwgR1RfUE1fSU5U
RVJWQUxfVE9fVVMoZGV2X3ByaXYsIHJwY3VyZG93bikpOwotCQlzZXFfcHJpbnRmKG0sICJSUCBQ
UkVWIERPV046ICVkICglZHVzKVxuIiwKLQkJCSAgIHJwcHJldmRvd24sIEdUX1BNX0lOVEVSVkFM
X1RPX1VTKGRldl9wcml2LCBycHByZXZkb3duKSk7Ci0JCXNlcV9wcmludGYobSwgIkRvd24gdGhy
ZXNob2xkOiAlZCUlXG4iLAotCQkJICAgcnBzLT5wb3dlci5kb3duX3RocmVzaG9sZCk7Ci0KLQkJ
bWF4X2ZyZXEgPSAoSVNfR0VOOV9MUChkZXZfcHJpdikgPyBycF9zdGF0ZV9jYXAgPj4gMCA6Ci0J
CQkgICAgcnBfc3RhdGVfY2FwID4+IDE2KSAmIDB4ZmY7Ci0JCW1heF9mcmVxICo9IChJU19HRU45
X0JDKGRldl9wcml2KSB8fAotCQkJICAgICBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwID8gR0VO
OV9GUkVRX1NDQUxFUiA6IDEpOwotCQlzZXFfcHJpbnRmKG0sICJMb3dlc3QgKFJQTikgZnJlcXVl
bmN5OiAlZE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgbWF4X2ZyZXEpKTsKLQot
CQltYXhfZnJlcSA9IChycF9zdGF0ZV9jYXAgJiAweGZmMDApID4+IDg7Ci0JCW1heF9mcmVxICo9
IChJU19HRU45X0JDKGRldl9wcml2KSB8fAotCQkJICAgICBJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDEwID8gR0VOOV9GUkVRX1NDQUxFUiA6IDEpOwotCQlzZXFfcHJpbnRmKG0sICJOb21pbmFsIChS
UDEpIGZyZXF1ZW5jeTogJWRNSHpcbiIsCi0JCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIG1heF9m
cmVxKSk7Ci0KLQkJbWF4X2ZyZXEgPSAoSVNfR0VOOV9MUChkZXZfcHJpdikgPyBycF9zdGF0ZV9j
YXAgPj4gMTYgOgotCQkJICAgIHJwX3N0YXRlX2NhcCA+PiAwKSAmIDB4ZmY7Ci0JCW1heF9mcmVx
ICo9IChJU19HRU45X0JDKGRldl9wcml2KSB8fAotCQkJICAgICBJTlRFTF9HRU4oZGV2X3ByaXYp
ID49IDEwID8gR0VOOV9GUkVRX1NDQUxFUiA6IDEpOwotCQlzZXFfcHJpbnRmKG0sICJNYXggbm9u
LW92ZXJjbG9ja2VkIChSUDApIGZyZXF1ZW5jeTogJWRNSHpcbiIsCi0JCQkgICBpbnRlbF9ncHVf
ZnJlcShycHMsIG1heF9mcmVxKSk7Ci0JCXNlcV9wcmludGYobSwgIk1heCBvdmVyY2xvY2tlZCBm
cmVxdWVuY3k6ICVkTUh6XG4iLAotCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPm1heF9m
cmVxKSk7Ci0KLQkJc2VxX3ByaW50ZihtLCAiQ3VycmVudCBmcmVxOiAlZCBNSHpcbiIsCi0JCQkg
ICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+Y3VyX2ZyZXEpKTsKLQkJc2VxX3ByaW50ZihtLCAi
QWN0dWFsIGZyZXE6ICVkIE1IelxuIiwgY2FnZik7Ci0JCXNlcV9wcmludGYobSwgIklkbGUgZnJl
cTogJWQgTUh6XG4iLAotCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmlkbGVfZnJlcSkp
OwotCQlzZXFfcHJpbnRmKG0sICJNaW4gZnJlcTogJWQgTUh6XG4iLAotCQkJICAgaW50ZWxfZ3B1
X2ZyZXEocnBzLCBycHMtPm1pbl9mcmVxKSk7Ci0JCXNlcV9wcmludGYobSwgIkJvb3N0IGZyZXE6
ICVkIE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5ib29zdF9mcmVxKSk7
Ci0JCXNlcV9wcmludGYobSwgIk1heCBmcmVxOiAlZCBNSHpcbiIsCi0JCQkgICBpbnRlbF9ncHVf
ZnJlcShycHMsIHJwcy0+bWF4X2ZyZXEpKTsKLQkJc2VxX3ByaW50ZihtLAotCQkJICAgImVmZmlj
aWVudCAoUlBlKSBmcmVxdWVuY3k6ICVkIE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKHJw
cywgcnBzLT5lZmZpY2llbnRfZnJlcSkpOwotCX0gZWxzZSB7Ci0JCXNlcV9wdXRzKG0sICJubyBQ
LXN0YXRlIGluZm8gYXZhaWxhYmxlXG4iKTsKLQl9Ci0KLQlzZXFfcHJpbnRmKG0sICJDdXJyZW50
IENEIGNsb2NrIGZyZXF1ZW5jeTogJWQga0h6XG4iLCBkZXZfcHJpdi0+Y2RjbGsuaHcuY2RjbGsp
OwotCXNlcV9wcmludGYobSwgIk1heCBDRCBjbG9jayBmcmVxdWVuY3k6ICVkIGtIelxuIiwgZGV2
X3ByaXYtPm1heF9jZGNsa19mcmVxKTsKLQlzZXFfcHJpbnRmKG0sICJNYXggcGl4ZWwgY2xvY2sg
ZnJlcXVlbmN5OiAlZCBrSHpcbiIsIGRldl9wcml2LT5tYXhfZG90Y2xrX2ZyZXEpOwotCi0JaW50
ZWxfcnVudGltZV9wbV9wdXQoJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKLQlyZXR1
cm4gcmV0OwotfQotCi1zdGF0aWMgaW50IGlyb25sYWtlX2RycGNfaW5mbyhzdHJ1Y3Qgc2VxX2Zp
bGUgKm0pCi17Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUo
bS0+cHJpdmF0ZSk7Ci0Jc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29y
ZTsKLQl1MzIgcmd2bW9kZWN0bCwgcnN0ZGJ5Y3RsOwotCXUxNiBjcnN0YW5kdmlkOwotCi0Jcmd2
bW9kZWN0bCA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgTUVNTU9ERUNUTCk7Ci0JcnN0ZGJ5
Y3RsID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBSU1REQllDVEwpOwotCWNyc3RhbmR2aWQg
PSBpbnRlbF91bmNvcmVfcmVhZDE2KHVuY29yZSwgQ1JTVEFORFZJRCk7Ci0KLQlzZXFfcHJpbnRm
KG0sICJIRCBib29zdDogJXNcbiIsIHllc25vKHJndm1vZGVjdGwgJiBNRU1NT0RFX0JPT1NUX0VO
KSk7Ci0Jc2VxX3ByaW50ZihtLCAiQm9vc3QgZnJlcTogJWRcbiIsCi0JCSAgIChyZ3Ztb2RlY3Rs
ICYgTUVNTU9ERV9CT09TVF9GUkVRX01BU0spID4+Ci0JCSAgIE1FTU1PREVfQk9PU1RfRlJFUV9T
SElGVCk7Ci0Jc2VxX3ByaW50ZihtLCAiSFcgY29udHJvbCBlbmFibGVkOiAlc1xuIiwKLQkJICAg
eWVzbm8ocmd2bW9kZWN0bCAmIE1FTU1PREVfSFdJRExFX0VOKSk7Ci0Jc2VxX3ByaW50ZihtLCAi
U1cgY29udHJvbCBlbmFibGVkOiAlc1xuIiwKLQkJICAgeWVzbm8ocmd2bW9kZWN0bCAmIE1FTU1P
REVfU1dNT0RFX0VOKSk7Ci0Jc2VxX3ByaW50ZihtLCAiR2F0ZWQgdm9sdGFnZSBjaGFuZ2U6ICVz
XG4iLAotCQkgICB5ZXNubyhyZ3Ztb2RlY3RsICYgTUVNTU9ERV9SQ0xLX0dBVEUpKTsKLQlzZXFf
cHJpbnRmKG0sICJTdGFydGluZyBmcmVxdWVuY3k6IFAlZFxuIiwKLQkJICAgKHJndm1vZGVjdGwg
JiBNRU1NT0RFX0ZTVEFSVF9NQVNLKSA+PiBNRU1NT0RFX0ZTVEFSVF9TSElGVCk7Ci0Jc2VxX3By
aW50ZihtLCAiTWF4IFAtc3RhdGU6IFAlZFxuIiwKLQkJICAgKHJndm1vZGVjdGwgJiBNRU1NT0RF
X0ZNQVhfTUFTSykgPj4gTUVNTU9ERV9GTUFYX1NISUZUKTsKLQlzZXFfcHJpbnRmKG0sICJNaW4g
UC1zdGF0ZTogUCVkXG4iLCAocmd2bW9kZWN0bCAmIE1FTU1PREVfRk1JTl9NQVNLKSk7Ci0Jc2Vx
X3ByaW50ZihtLCAiUlMxIFZJRDogJWRcbiIsIChjcnN0YW5kdmlkICYgMHgzZikpOwotCXNlcV9w
cmludGYobSwgIlJTMiBWSUQ6ICVkXG4iLCAoKGNyc3RhbmR2aWQgPj4gOCkgJiAweDNmKSk7Ci0J
c2VxX3ByaW50ZihtLCAiUmVuZGVyIHN0YW5kYnkgZW5hYmxlZDogJXNcbiIsCi0JCSAgIHllc25v
KCEocnN0ZGJ5Y3RsICYgUkNYX1NXX0VYSVQpKSk7Ci0Jc2VxX3B1dHMobSwgIkN1cnJlbnQgUlMg
c3RhdGU6ICIpOwotCXN3aXRjaCAocnN0ZGJ5Y3RsICYgUlNYX1NUQVRVU19NQVNLKSB7Ci0JY2Fz
ZSBSU1hfU1RBVFVTX09OOgotCQlzZXFfcHV0cyhtLCAib25cbiIpOwotCQlicmVhazsKLQljYXNl
IFJTWF9TVEFUVVNfUkMxOgotCQlzZXFfcHV0cyhtLCAiUkMxXG4iKTsKLQkJYnJlYWs7Ci0JY2Fz
ZSBSU1hfU1RBVFVTX1JDMUU6Ci0JCXNlcV9wdXRzKG0sICJSQzFFXG4iKTsKLQkJYnJlYWs7Ci0J
Y2FzZSBSU1hfU1RBVFVTX1JTMToKLQkJc2VxX3B1dHMobSwgIlJTMVxuIik7Ci0JCWJyZWFrOwot
CWNhc2UgUlNYX1NUQVRVU19SUzI6Ci0JCXNlcV9wdXRzKG0sICJSUzIgKFJDNilcbiIpOwotCQli
cmVhazsKLQljYXNlIFJTWF9TVEFUVVNfUlMzOgotCQlzZXFfcHV0cyhtLCAiUkMzIChSQzYrKVxu
Iik7Ci0JCWJyZWFrOwotCWRlZmF1bHQ6Ci0JCXNlcV9wdXRzKG0sICJ1bmtub3duXG4iKTsKLQkJ
YnJlYWs7Ci0JfQotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQgaTkxNV9mb3JjZXdha2Vf
ZG9tYWlucyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCi17Ci0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Ci0Jc3RydWN0IGlu
dGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsKLQlzdHJ1Y3QgaW50ZWxfdW5jb3Jl
X2ZvcmNld2FrZV9kb21haW4gKmZ3X2RvbWFpbjsKLQl1bnNpZ25lZCBpbnQgdG1wOwotCi0Jc2Vx
X3ByaW50ZihtLCAidXNlci5ieXBhc3NfY291bnQgPSAldVxuIiwKLQkJICAgdW5jb3JlLT51c2Vy
X2ZvcmNld2FrZV9jb3VudCk7Ci0KLQlmb3JfZWFjaF9md19kb21haW4oZndfZG9tYWluLCB1bmNv
cmUsIHRtcCkKLQkJc2VxX3ByaW50ZihtLCAiJXMud2FrZV9jb3VudCA9ICV1XG4iLAotCQkJICAg
aW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9kb21haW5fdG9fc3RyKGZ3X2RvbWFpbi0+aWQpLAotCQkJ
ICAgUkVBRF9PTkNFKGZ3X2RvbWFpbi0+d2FrZV9jb3VudCkpOwotCi0JcmV0dXJuIDA7Ci19Ci0K
LXN0YXRpYyB2b2lkIHByaW50X3JjNl9yZXMoc3RydWN0IHNlcV9maWxlICptLAotCQkJICBjb25z
dCBjaGFyICp0aXRsZSwKLQkJCSAgY29uc3QgaTkxNV9yZWdfdCByZWcpCi17Ci0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Ci0JaW50ZWxf
d2FrZXJlZl90IHdha2VyZWY7Ci0KLQl3aXRoX2ludGVsX3J1bnRpbWVfcG0oJmk5MTUtPnJ1bnRp
bWVfcG0sIHdha2VyZWYpCi0JCXNlcV9wcmludGYobSwgIiVzICV1ICglbGx1IHVzKVxuIiwgdGl0
bGUsCi0JCQkgICBpbnRlbF91bmNvcmVfcmVhZCgmaTkxNS0+dW5jb3JlLCByZWcpLAotCQkJICAg
aW50ZWxfcmM2X3Jlc2lkZW5jeV91cygmaTkxNS0+Z3QucmM2LCByZWcpKTsKLX0KLQotc3RhdGlj
IGludCB2bHZfZHJwY19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSkKLXsKLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Ci0JdTMyIHJj
Y3RsMSwgcHdfc3RhdHVzOwotCi0JcHdfc3RhdHVzID0gSTkxNV9SRUFEKFZMVl9HVExDX1BXX1NU
QVRVUyk7Ci0JcmNjdGwxID0gSTkxNV9SRUFEKEdFTjZfUkNfQ09OVFJPTCk7Ci0KLQlzZXFfcHJp
bnRmKG0sICJSQzYgRW5hYmxlZDogJXNcbiIsCi0JCSAgIHllc25vKHJjY3RsMSAmIChHRU43X1JD
X0NUTF9UT19NT0RFIHwKLQkJCQkJR0VONl9SQ19DVExfRUlfTU9ERSgxKSkpKTsKLQlzZXFfcHJp
bnRmKG0sICJSZW5kZXIgUG93ZXIgV2VsbDogJXNcbiIsCi0JCSAgIChwd19zdGF0dXMgJiBWTFZf
R1RMQ19QV19SRU5ERVJfU1RBVFVTX01BU0spID8gIlVwIiA6ICJEb3duIik7Ci0Jc2VxX3ByaW50
ZihtLCAiTWVkaWEgUG93ZXIgV2VsbDogJXNcbiIsCi0JCSAgIChwd19zdGF0dXMgJiBWTFZfR1RM
Q19QV19NRURJQV9TVEFUVVNfTUFTSykgPyAiVXAiIDogIkRvd24iKTsKLQotCXByaW50X3JjNl9y
ZXMobSwgIlJlbmRlciBSQzYgcmVzaWRlbmN5IHNpbmNlIGJvb3Q6IiwgVkxWX0dUX1JFTkRFUl9S
QzYpOwotCXByaW50X3JjNl9yZXMobSwgIk1lZGlhIFJDNiByZXNpZGVuY3kgc2luY2UgYm9vdDoi
LCBWTFZfR1RfTUVESUFfUkM2KTsKLQotCXJldHVybiBpOTE1X2ZvcmNld2FrZV9kb21haW5zKG0s
IE5VTEwpOwotfQotCi1zdGF0aWMgaW50IGdlbjZfZHJwY19pbmZvKHN0cnVjdCBzZXFfZmlsZSAq
bSkKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUo
bS0+cHJpdmF0ZSk7Ci0JdTMyIGd0X2NvcmVfc3RhdHVzLCByY2N0bDEsIHJjNnZpZHMgPSAwOwot
CXUzMiBnZW45X3Bvd2VyZ2F0ZV9lbmFibGUgPSAwLCBnZW45X3Bvd2VyZ2F0ZV9zdGF0dXMgPSAw
OwotCi0JZ3RfY29yZV9zdGF0dXMgPSBJOTE1X1JFQURfRlcoR0VONl9HVF9DT1JFX1NUQVRVUyk7
Ci0JdHJhY2VfaTkxNV9yZWdfcncoZmFsc2UsIEdFTjZfR1RfQ09SRV9TVEFUVVMsIGd0X2NvcmVf
c3RhdHVzLCA0LCB0cnVlKTsKLQotCXJjY3RsMSA9IEk5MTVfUkVBRChHRU42X1JDX0NPTlRST0wp
OwotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpIHsKLQkJZ2VuOV9wb3dlcmdhdGVfZW5h
YmxlID0gSTkxNV9SRUFEKEdFTjlfUEdfRU5BQkxFKTsKLQkJZ2VuOV9wb3dlcmdhdGVfc3RhdHVz
ID0gSTkxNV9SRUFEKEdFTjlfUFdSR1RfRE9NQUlOX1NUQVRVUyk7Ci0JfQotCi0JaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPD0gNykKLQkJc2FuZHlicmlkZ2VfcGNvZGVfcmVhZChkZXZfcHJpdiwg
R0VONl9QQ09ERV9SRUFEX1JDNlZJRFMsCi0JCQkJICAgICAgICZyYzZ2aWRzLCBOVUxMKTsKLQot
CXNlcV9wcmludGYobSwgIlJDMWUgRW5hYmxlZDogJXNcbiIsCi0JCSAgIHllc25vKHJjY3RsMSAm
IEdFTjZfUkNfQ1RMX1JDMWVfRU5BQkxFKSk7Ci0Jc2VxX3ByaW50ZihtLCAiUkM2IEVuYWJsZWQ6
ICVzXG4iLAotCQkgICB5ZXNubyhyY2N0bDEgJiBHRU42X1JDX0NUTF9SQzZfRU5BQkxFKSk7Ci0J
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkgewotCQlzZXFfcHJpbnRmKG0sICJSZW5kZXIg
V2VsbCBHYXRpbmcgRW5hYmxlZDogJXNcbiIsCi0JCQl5ZXNubyhnZW45X3Bvd2VyZ2F0ZV9lbmFi
bGUgJiBHRU45X1JFTkRFUl9QR19FTkFCTEUpKTsKLQkJc2VxX3ByaW50ZihtLCAiTWVkaWEgV2Vs
bCBHYXRpbmcgRW5hYmxlZDogJXNcbiIsCi0JCQl5ZXNubyhnZW45X3Bvd2VyZ2F0ZV9lbmFibGUg
JiBHRU45X01FRElBX1BHX0VOQUJMRSkpOwotCX0KLQlzZXFfcHJpbnRmKG0sICJEZWVwIFJDNiBF
bmFibGVkOiAlc1xuIiwKLQkJICAgeWVzbm8ocmNjdGwxICYgR0VONl9SQ19DVExfUkM2cF9FTkFC
TEUpKTsKLQlzZXFfcHJpbnRmKG0sICJEZWVwZXN0IFJDNiBFbmFibGVkOiAlc1xuIiwKLQkJICAg
eWVzbm8ocmNjdGwxICYgR0VONl9SQ19DVExfUkM2cHBfRU5BQkxFKSk7Ci0Jc2VxX3B1dHMobSwg
IkN1cnJlbnQgUkMgc3RhdGU6ICIpOwotCXN3aXRjaCAoZ3RfY29yZV9zdGF0dXMgJiBHRU42X1JD
bl9NQVNLKSB7Ci0JY2FzZSBHRU42X1JDMDoKLQkJaWYgKGd0X2NvcmVfc3RhdHVzICYgR0VONl9D
T1JFX0NQRF9TVEFURV9NQVNLKQotCQkJc2VxX3B1dHMobSwgIkNvcmUgUG93ZXIgRG93blxuIik7
Ci0JCWVsc2UKLQkJCXNlcV9wdXRzKG0sICJvblxuIik7Ci0JCWJyZWFrOwotCWNhc2UgR0VONl9S
QzM6Ci0JCXNlcV9wdXRzKG0sICJSQzNcbiIpOwotCQlicmVhazsKLQljYXNlIEdFTjZfUkM2Ogot
CQlzZXFfcHV0cyhtLCAiUkM2XG4iKTsKLQkJYnJlYWs7Ci0JY2FzZSBHRU42X1JDNzoKLQkJc2Vx
X3B1dHMobSwgIlJDN1xuIik7Ci0JCWJyZWFrOwotCWRlZmF1bHQ6Ci0JCXNlcV9wdXRzKG0sICJV
bmtub3duXG4iKTsKLQkJYnJlYWs7Ci0JfQotCi0Jc2VxX3ByaW50ZihtLCAiQ29yZSBQb3dlciBE
b3duOiAlc1xuIiwKLQkJICAgeWVzbm8oZ3RfY29yZV9zdGF0dXMgJiBHRU42X0NPUkVfQ1BEX1NU
QVRFX01BU0spKTsKLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KSB7Ci0JCXNlcV9wcmlu
dGYobSwgIlJlbmRlciBQb3dlciBXZWxsOiAlc1xuIiwKLQkJCShnZW45X3Bvd2VyZ2F0ZV9zdGF0
dXMgJgotCQkJIEdFTjlfUFdSR1RfUkVOREVSX1NUQVRVU19NQVNLKSA/ICJVcCIgOiAiRG93biIp
OwotCQlzZXFfcHJpbnRmKG0sICJNZWRpYSBQb3dlciBXZWxsOiAlc1xuIiwKLQkJCShnZW45X3Bv
d2VyZ2F0ZV9zdGF0dXMgJgotCQkJIEdFTjlfUFdSR1RfTUVESUFfU1RBVFVTX01BU0spID8gIlVw
IiA6ICJEb3duIik7Ci0JfQotCi0JLyogTm90IGV4YWN0bHkgc3VyZSB3aGF0IHRoaXMgaXMgKi8K
LQlwcmludF9yYzZfcmVzKG0sICJSQzYgXCJMb2NrZWQgdG8gUlBuXCIgcmVzaWRlbmN5IHNpbmNl
IGJvb3Q6IiwKLQkJICAgICAgR0VONl9HVF9HRlhfUkM2X0xPQ0tFRCk7Ci0JcHJpbnRfcmM2X3Jl
cyhtLCAiUkM2IHJlc2lkZW5jeSBzaW5jZSBib290OiIsIEdFTjZfR1RfR0ZYX1JDNik7Ci0JcHJp
bnRfcmM2X3JlcyhtLCAiUkM2KyByZXNpZGVuY3kgc2luY2UgYm9vdDoiLCBHRU42X0dUX0dGWF9S
QzZwKTsKLQlwcmludF9yYzZfcmVzKG0sICJSQzYrKyByZXNpZGVuY3kgc2luY2UgYm9vdDoiLCBH
RU42X0dUX0dGWF9SQzZwcCk7Ci0KLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8PSA3KSB7Ci0J
CXNlcV9wcmludGYobSwgIlJDNiAgIHZvbHRhZ2U6ICVkbVZcbiIsCi0JCQkgICBHRU42X0RFQ09E
RV9SQzZfVklEKCgocmM2dmlkcyA+PiAwKSAmIDB4ZmYpKSk7Ci0JCXNlcV9wcmludGYobSwgIlJD
NisgIHZvbHRhZ2U6ICVkbVZcbiIsCi0JCQkgICBHRU42X0RFQ09ERV9SQzZfVklEKCgocmM2dmlk
cyA+PiA4KSAmIDB4ZmYpKSk7Ci0JCXNlcV9wcmludGYobSwgIlJDNisrIHZvbHRhZ2U6ICVkbVZc
biIsCi0JCQkgICBHRU42X0RFQ09ERV9SQzZfVklEKCgocmM2dmlkcyA+PiAxNikgJiAweGZmKSkp
OwotCX0KLQotCXJldHVybiBpOTE1X2ZvcmNld2FrZV9kb21haW5zKG0sIE5VTEwpOwotfQotCi1z
dGF0aWMgaW50IGk5MTVfZHJwY19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2Vk
KQotewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNSht
LT5wcml2YXRlKTsKLQlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKLQlpbnQgZXJyID0gLUVOT0RF
VjsKLQotCXdpdGhfaW50ZWxfcnVudGltZV9wbSgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2Vy
ZWYpIHsKLQkJaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2
X3ByaXYpKQotCQkJZXJyID0gdmx2X2RycGNfaW5mbyhtKTsKLQkJZWxzZSBpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSA2KQotCQkJZXJyID0gZ2VuNl9kcnBjX2luZm8obSk7Ci0JCWVsc2UKLQkJ
CWVyciA9IGlyb25sYWtlX2RycGNfaW5mbyhtKTsKLQl9Ci0KLQlyZXR1cm4gZXJyOwotfQotCiBz
dGF0aWMgaW50IGk5MTVfZnJvbnRidWZmZXJfdHJhY2tpbmcoc3RydWN0IHNlcV9maWxlICptLCB2
b2lkICp1bnVzZWQpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9k
ZV90b19pOTE1KG0tPnByaXZhdGUpOwpAQCAtMTM2Miw0NyArOTI0LDYgQEAgc3RhdGljIGludCBp
OTE1X3NyX3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCBpOTE1X3JpbmdfZnJlcV90YWJsZShzdHJ1Y3Qgc2VxX2ZpbGUg
Km0sIHZvaWQgKnVudXNlZCkKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRl
dl9wcml2LT5ndC5ycHM7Ci0JdW5zaWduZWQgaW50IG1heF9ncHVfZnJlcSwgbWluX2dwdV9mcmVx
OwotCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwotCWludCBncHVfZnJlcSwgaWFfZnJlcTsKLQot
CWlmICghSEFTX0xMQyhkZXZfcHJpdikpCi0JCXJldHVybiAtRU5PREVWOwotCi0JbWluX2dwdV9m
cmVxID0gcnBzLT5taW5fZnJlcTsKLQltYXhfZ3B1X2ZyZXEgPSBycHMtPm1heF9mcmVxOwotCWlm
IChJU19HRU45X0JDKGRldl9wcml2KSB8fCBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwKSB7Ci0J
CS8qIENvbnZlcnQgR1QgZnJlcXVlbmN5IHRvIDUwIEhaIHVuaXRzICovCi0JCW1pbl9ncHVfZnJl
cSAvPSBHRU45X0ZSRVFfU0NBTEVSOwotCQltYXhfZ3B1X2ZyZXEgLz0gR0VOOV9GUkVRX1NDQUxF
UjsKLQl9Ci0KLQlzZXFfcHV0cyhtLCAiR1BVIGZyZXEgKE1IeilcdEVmZmVjdGl2ZSBDUFUgZnJl
cSAoTUh6KVx0RWZmZWN0aXZlIFJpbmcgZnJlcSAoTUh6KVxuIik7Ci0KLQl3YWtlcmVmID0gaW50
ZWxfcnVudGltZV9wbV9nZXQoJmRldl9wcml2LT5ydW50aW1lX3BtKTsKLQlmb3IgKGdwdV9mcmVx
ID0gbWluX2dwdV9mcmVxOyBncHVfZnJlcSA8PSBtYXhfZ3B1X2ZyZXE7IGdwdV9mcmVxKyspIHsK
LQkJaWFfZnJlcSA9IGdwdV9mcmVxOwotCQlzYW5keWJyaWRnZV9wY29kZV9yZWFkKGRldl9wcml2
LAotCQkJCSAgICAgICBHRU42X1BDT0RFX1JFQURfTUlOX0ZSRVFfVEFCTEUsCi0JCQkJICAgICAg
ICZpYV9mcmVxLCBOVUxMKTsKLQkJc2VxX3ByaW50ZihtLCAiJWRcdFx0JWRcdFx0XHRcdCVkXG4i
LAotCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLAotCQkJCQkgIChncHVfZnJlcSAqCi0JCQkJCSAg
IChJU19HRU45X0JDKGRldl9wcml2KSB8fAotCQkJCQkgICAgSU5URUxfR0VOKGRldl9wcml2KSA+
PSAxMCA/Ci0JCQkJCSAgICBHRU45X0ZSRVFfU0NBTEVSIDogMSkpKSwKLQkJCSAgICgoaWFfZnJl
cSA+PiAwKSAmIDB4ZmYpICogMTAwLAotCQkJICAgKChpYV9mcmVxID4+IDgpICYgMHhmZikgKiAx
MDApOwotCX0KLQlpbnRlbF9ydW50aW1lX3BtX3B1dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdh
a2VyZWYpOwotCi0JcmV0dXJuIDA7Ci19Ci0KIHN0YXRpYyBpbnQgaTkxNV9vcHJlZ2lvbihzdHJ1
Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKIHsKIAlzdHJ1Y3QgaW50ZWxfb3ByZWdpb24g
Km9wcmVnaW9uID0gJm5vZGVfdG9faTkxNShtLT5wcml2YXRlKS0+b3ByZWdpb247CkBAIC0xNjA1
LDg3ICsxMTI2LDYgQEAgc3RhdGljIGludCBpOTE1X3N3aXp6bGVfaW5mbyhzdHJ1Y3Qgc2VxX2Zp
bGUgKm0sIHZvaWQgKmRhdGEpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBjb25zdCBjaGFyICpy
cHNfcG93ZXJfdG9fc3RyKHVuc2lnbmVkIGludCBwb3dlcikKLXsKLQlzdGF0aWMgY29uc3QgY2hh
ciAqIGNvbnN0IHN0cmluZ3NbXSA9IHsKLQkJW0xPV19QT1dFUl0gPSAibG93IHBvd2VyIiwKLQkJ
W0JFVFdFRU5dID0gIm1peGVkIiwKLQkJW0hJR0hfUE9XRVJdID0gImhpZ2ggcG93ZXIiLAotCX07
Ci0KLQlpZiAocG93ZXIgPj0gQVJSQVlfU0laRShzdHJpbmdzKSB8fCAhc3RyaW5nc1twb3dlcl0p
Ci0JCXJldHVybiAidW5rbm93biI7Ci0KLQlyZXR1cm4gc3RyaW5nc1twb3dlcl07Ci19Ci0KLXN0
YXRpYyBpbnQgaTkxNV9ycHNfYm9vc3RfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRh
dGEpCi17Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1
KG0tPnByaXZhdGUpOwotCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3QucnBz
OwotCXUzMiBhY3RfZnJlcTsKLQlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKLQotCXdpdGhfaW50
ZWxfcnVudGltZV9wbV9pZl9pbl91c2UoJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtlcmVmKQot
CQlhY3RfZnJlcSA9IGludGVsX3Jwc19yZWFkX2FjdHVhbF9mcmVxdWVuY3kocnBzKTsKLQotCXNl
cV9wcmludGYobSwgIlJQUyBlbmFibGVkPyAlZFxuIiwgcnBzLT5lbmFibGVkKTsKLQlzZXFfcHJp
bnRmKG0sICJHUFUgYnVzeT8gJXNcbiIsIHllc25vKGRldl9wcml2LT5ndC5hd2FrZSkpOwotCXNl
cV9wcmludGYobSwgIkJvb3N0cyBvdXRzdGFuZGluZz8gJWRcbiIsCi0JCSAgIGF0b21pY19yZWFk
KCZycHMtPm51bV93YWl0ZXJzKSk7Ci0Jc2VxX3ByaW50ZihtLCAiSW50ZXJhY3RpdmU/ICVkXG4i
LCBSRUFEX09OQ0UocnBzLT5wb3dlci5pbnRlcmFjdGl2ZSkpOwotCXNlcV9wcmludGYobSwgIkZy
ZXF1ZW5jeSByZXF1ZXN0ZWQgJWQsIGFjdHVhbCAlZFxuIiwKLQkJICAgaW50ZWxfZ3B1X2ZyZXEo
cnBzLCBycHMtPmN1cl9mcmVxKSwgYWN0X2ZyZXEpOwotCXNlcV9wcmludGYobSwgIiAgbWluIGhh
cmQ6JWQsIHNvZnQ6JWQ7IG1heCBzb2Z0OiVkLCBoYXJkOiVkXG4iLAotCQkgICBpbnRlbF9ncHVf
ZnJlcShycHMsIHJwcy0+bWluX2ZyZXEpLAotCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+
bWluX2ZyZXFfc29mdGxpbWl0KSwKLQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPm1heF9m
cmVxX3NvZnRsaW1pdCksCi0JCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5tYXhfZnJlcSkp
OwotCXNlcV9wcmludGYobSwgIiAgaWRsZTolZCwgZWZmaWNpZW50OiVkLCBib29zdDolZFxuIiwK
LQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmlkbGVfZnJlcSksCi0JCSAgIGludGVsX2dw
dV9mcmVxKHJwcywgcnBzLT5lZmZpY2llbnRfZnJlcSksCi0JCSAgIGludGVsX2dwdV9mcmVxKHJw
cywgcnBzLT5ib29zdF9mcmVxKSk7Ci0KLQlzZXFfcHJpbnRmKG0sICJXYWl0IGJvb3N0czogJWRc
biIsIGF0b21pY19yZWFkKCZycHMtPmJvb3N0cykpOwotCi0JaWYgKElOVEVMX0dFTihkZXZfcHJp
dikgPj0gNiAmJiBycHMtPmVuYWJsZWQgJiYgZGV2X3ByaXYtPmd0LmF3YWtlKSB7Ci0JCXUzMiBy
cHVwLCBycHVwZWk7Ci0JCXUzMiBycGRvd24sIHJwZG93bmVpOwotCi0JCWludGVsX3VuY29yZV9m
b3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKLQkJcnB1cCA9
IEk5MTVfUkVBRF9GVyhHRU42X1JQX0NVUl9VUCkgJiBHRU42X1JQX0VJX01BU0s7Ci0JCXJwdXBl
aSA9IEk5MTVfUkVBRF9GVyhHRU42X1JQX0NVUl9VUF9FSSkgJiBHRU42X1JQX0VJX01BU0s7Ci0J
CXJwZG93biA9IEk5MTVfUkVBRF9GVyhHRU42X1JQX0NVUl9ET1dOKSAmIEdFTjZfUlBfRUlfTUFT
SzsKLQkJcnBkb3duZWkgPSBJOTE1X1JFQURfRlcoR0VONl9SUF9DVVJfRE9XTl9FSSkgJiBHRU42
X1JQX0VJX01BU0s7Ci0JCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZkZXZfcHJpdi0+dW5j
b3JlLCBGT1JDRVdBS0VfQUxMKTsKLQotCQlzZXFfcHJpbnRmKG0sICJcblJQUyBBdXRvdHVuaW5n
IChjdXJyZW50IFwiJXNcIiB3aW5kb3cpOlxuIiwKLQkJCSAgIHJwc19wb3dlcl90b19zdHIocnBz
LT5wb3dlci5tb2RlKSk7Ci0JCXNlcV9wcmludGYobSwgIiAgQXZnLiB1cDogJWQlJSBbYWJvdmUg
dGhyZXNob2xkPyAlZCUlXVxuIiwKLQkJCSAgIHJwdXAgJiYgcnB1cGVpID8gMTAwICogcnB1cCAv
IHJwdXBlaSA6IDAsCi0JCQkgICBycHMtPnBvd2VyLnVwX3RocmVzaG9sZCk7Ci0JCXNlcV9wcmlu
dGYobSwgIiAgQXZnLiBkb3duOiAlZCUlIFtiZWxvdyB0aHJlc2hvbGQ/ICVkJSVdXG4iLAotCQkJ
ICAgcnBkb3duICYmIHJwZG93bmVpID8gMTAwICogcnBkb3duIC8gcnBkb3duZWkgOiAwLAotCQkJ
ICAgcnBzLT5wb3dlci5kb3duX3RocmVzaG9sZCk7Ci0JfSBlbHNlIHsKLQkJc2VxX3B1dHMobSwg
IlxuUlBTIEF1dG90dW5pbmcgaW5hY3RpdmVcbiIpOwotCX0KLQotCXJldHVybiAwOwotfQotCi1z
dGF0aWMgaW50IGk5MTVfbGxjKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKLXsKLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0
ZSk7Ci0JY29uc3QgYm9vbCBlZHJhbSA9IElOVEVMX0dFTihkZXZfcHJpdikgPiA4OwotCi0Jc2Vx
X3ByaW50ZihtLCAiTExDOiAlc1xuIiwgeWVzbm8oSEFTX0xMQyhkZXZfcHJpdikpKTsKLQlzZXFf
cHJpbnRmKG0sICIlczogJXVNQlxuIiwgZWRyYW0gPyAiZURSQU0iIDogImVMTEMiLAotCQkgICBk
ZXZfcHJpdi0+ZWRyYW1fc2l6ZV9tYik7Ci0KLQlyZXR1cm4gMDsKLX0KLQogc3RhdGljIGludCBp
OTE1X2h1Y19sb2FkX3N0YXR1c19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkK
IHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+
cHJpdmF0ZSk7CkBAIC00MjQ2LDkgKzM2ODYsNiBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9p
bmZvX2xpc3QgaTkxNV9kZWJ1Z2ZzX2xpc3RbXSA9IHsKIAl7Imk5MTVfZ3VjX2xvYWRfZXJyX2xv
Z19kdW1wIiwgaTkxNV9ndWNfbG9nX2R1bXAsIDAsICh2b2lkICopMX0sCiAJeyJpOTE1X2d1Y19z
dGFnZV9wb29sIiwgaTkxNV9ndWNfc3RhZ2VfcG9vbCwgMH0sCiAJeyJpOTE1X2h1Y19sb2FkX3N0
YXR1cyIsIGk5MTVfaHVjX2xvYWRfc3RhdHVzX2luZm8sIDB9LAotCXsiaTkxNV9mcmVxdWVuY3lf
aW5mbyIsIGk5MTVfZnJlcXVlbmN5X2luZm8sIDB9LAotCXsiaTkxNV9kcnBjX2luZm8iLCBpOTE1
X2RycGNfaW5mbywgMH0sCi0JeyJpOTE1X3JpbmdfZnJlcV90YWJsZSIsIGk5MTVfcmluZ19mcmVx
X3RhYmxlLCAwfSwKIAl7Imk5MTVfZnJvbnRidWZmZXJfdHJhY2tpbmciLCBpOTE1X2Zyb250YnVm
ZmVyX3RyYWNraW5nLCAwfSwKIAl7Imk5MTVfZmJjX3N0YXR1cyIsIGk5MTVfZmJjX3N0YXR1cywg
MH0sCiAJeyJpOTE1X2lwc19zdGF0dXMiLCBpOTE1X2lwc19zdGF0dXMsIDB9LApAQCAtNDI1Nyw5
ICszNjk0LDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1faW5mb19saXN0IGk5MTVfZGVidWdm
c19saXN0W10gPSB7CiAJeyJpOTE1X3ZidCIsIGk5MTVfdmJ0LCAwfSwKIAl7Imk5MTVfZ2VtX2Zy
YW1lYnVmZmVyIiwgaTkxNV9nZW1fZnJhbWVidWZmZXJfaW5mbywgMH0sCiAJeyJpOTE1X2NvbnRl
eHRfc3RhdHVzIiwgaTkxNV9jb250ZXh0X3N0YXR1cywgMH0sCi0JeyJpOTE1X2ZvcmNld2FrZV9k
b21haW5zIiwgaTkxNV9mb3JjZXdha2VfZG9tYWlucywgMH0sCiAJeyJpOTE1X3N3aXp6bGVfaW5m
byIsIGk5MTVfc3dpenpsZV9pbmZvLCAwfSwKLQl7Imk5MTVfbGxjIiwgaTkxNV9sbGMsIDB9LAog
CXsiaTkxNV9lZHBfcHNyX3N0YXR1cyIsIGk5MTVfZWRwX3Bzcl9zdGF0dXMsIDB9LAogCXsiaTkx
NV9lbmVyZ3lfdUoiLCBpOTE1X2VuZXJneV91SiwgMH0sCiAJeyJpOTE1X3J1bnRpbWVfcG1fc3Rh
dHVzIiwgaTkxNV9ydW50aW1lX3BtX3N0YXR1cywgMH0sCkBAIC00Mjc1LDcgKzM3MTAsNiBAQCBz
dGF0aWMgY29uc3Qgc3RydWN0IGRybV9pbmZvX2xpc3QgaTkxNV9kZWJ1Z2ZzX2xpc3RbXSA9IHsK
IAl7Imk5MTVfZGRiX2luZm8iLCBpOTE1X2RkYl9pbmZvLCAwfSwKIAl7Imk5MTVfc3NldV9zdGF0
dXMiLCBpOTE1X3NzZXVfc3RhdHVzLCAwfSwKIAl7Imk5MTVfZHJyc19zdGF0dXMiLCBpOTE1X2Ry
cnNfc3RhdHVzLCAwfSwKLQl7Imk5MTVfcnBzX2Jvb3N0X2luZm8iLCBpOTE1X3Jwc19ib29zdF9p
bmZvLCAwfSwKIH07CiAjZGVmaW5lIEk5MTVfREVCVUdGU19FTlRSSUVTIEFSUkFZX1NJWkUoaTkx
NV9kZWJ1Z2ZzX2xpc3QpCiAKQEAgLTQzMTEsNiArMzc0NSw3IEBAIHN0YXRpYyBjb25zdCBzdHJ1
Y3QgaTkxNV9kZWJ1Z2ZzX2ZpbGVzIHsKIGludCBpOTE1X2RlYnVnZnNfcmVnaXN0ZXIoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewogCXN0cnVjdCBkcm1fbWlub3IgKm1pbm9y
ID0gZGV2X3ByaXYtPmRybS5wcmltYXJ5OworCWludCBlcnI7CiAJaW50IGk7CiAKIAlkZWJ1Z2Zz
X2NyZWF0ZV9maWxlKCJpOTE1X2ZvcmNld2FrZV91c2VyIiwgU19JUlVTUiwgbWlub3ItPmRlYnVn
ZnNfcm9vdCwKQEAgLTQzMjQsOSArMzc1OSwxMyBAQCBpbnQgaTkxNV9kZWJ1Z2ZzX3JlZ2lzdGVy
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAkJCQkgICAgaTkxNV9kZWJ1Z2Zz
X2ZpbGVzW2ldLmZvcHMpOwogCX0KIAotCXJldHVybiBkcm1fZGVidWdmc19jcmVhdGVfZmlsZXMo
aTkxNV9kZWJ1Z2ZzX2xpc3QsCi0JCQkJCUk5MTVfREVCVUdGU19FTlRSSUVTLAotCQkJCQltaW5v
ci0+ZGVidWdmc19yb290LCBtaW5vcik7CisJZXJyID0gZHJtX2RlYnVnZnNfY3JlYXRlX2ZpbGVz
KGk5MTVfZGVidWdmc19saXN0LAorCQkJCSAgICAgICBJOTE1X0RFQlVHRlNfRU5UUklFUywKKwkJ
CQkgICAgICAgbWlub3ItPmRlYnVnZnNfcm9vdCwgbWlub3IpOworCWlmIChlcnIpCisJCXJldHVy
biBlcnI7CisKKwlyZXR1cm4gZGVidWdmc19ndF9pbml0KCZkZXZfcHJpdi0+Z3QpOwogfQogCiBz
dHJ1Y3QgZHBjZF9ibG9jayB7Ci0tIAoyLjI0LjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxp
c3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFu
L2xpc3RpbmZvL2ludGVsLWdmeAo=

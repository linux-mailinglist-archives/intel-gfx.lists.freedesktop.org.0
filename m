Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 2FDB3B7C0C
	for <lists+intel-gfx@lfdr.de>; Thu, 19 Sep 2019 16:22:27 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 0CF896F97F;
	Thu, 19 Sep 2019 14:22:25 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga01.intel.com (mga01.intel.com [192.55.52.88])
 by gabe.freedesktop.org (Postfix) with ESMTPS id D6CFE6F50D
 for <intel-gfx@lists.freedesktop.org>; Thu, 19 Sep 2019 14:22:23 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga006.jf.intel.com ([10.7.209.51])
 by fmsmga101.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 19 Sep 2019 07:22:23 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,523,1559545200"; d="scan'208";a="192059907"
Received: from aquilante.fi.intel.com (HELO brancaleone.example.org)
 ([10.237.72.186])
 by orsmga006.jf.intel.com with ESMTP; 19 Sep 2019 07:22:20 -0700
From: Andi Shyti <andi.shyti@intel.com>
To: Intel GFX <intel-gfx@lists.freedesktop.org>
Date: Thu, 19 Sep 2019 17:38:40 +0300
Message-Id: <20190919143840.20384-1-andi.shyti@intel.com>
X-Mailer: git-send-email 2.23.0
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915: Extract GT render sleep (rc6)
 management
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Q29udGludWluZyB0aGUgdGhlbWUgb2YgYnJlYWtpbmcgaW50ZWxfcG0uYyB1cCBpbiBhIHJlYXNv
bmFibGUgY2h1bmsgb2YKcG93ZXJtYW5hZ2VtZW50IHV0aWxpdGllcywgcHVsbCBvdXQgdGhlIHJj
NiBzZXR1cCBpbnRvIGl0cyBHVCBoYW5kbGVyLgoKQmFzZWQgb24gYSBwYXRjaCBieSBDaHJpcyBX
aWxzb24uCgpTaWduZWQtb2ZmLWJ5OiBBbmRpIFNoeXRpIDxhbmRpLnNoeXRpQGludGVsLmNvbT4K
Q2M6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgotLS0KIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L01ha2VmaWxlICAgICAgICAgICAgIHwgICAxICsKIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5jIHwgICAxICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2d0LmMgICAgICAgIHwgICAxICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2d0X3R5cGVzLmggIHwgICAzICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jj
Ni5jICAgICAgIHwgNjY2ICsrKysrKysrKysrKysrKysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX3JjNi5oICAgICAgIHwgIDI0ICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX3JjNl90eXBlcy5oIHwgIDI2ICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVi
dWdmcy5jICAgICAgIHwgIDExICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oICAg
ICAgICAgICB8ICAgNyAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5jICAgICAgICAg
ICB8ICAgOSArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zeXNmcy5jICAgICAgICAgfCAg
IDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMgICAgICAgICAgIHwgNjA3ICst
LS0tLS0tLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5oICAgICAg
ICAgICB8ICAgMiAtCiAxMyBmaWxlcyBjaGFuZ2VkLCA3NDEgaW5zZXJ0aW9ucygrKSwgNjIxIGRl
bGV0aW9ucygtKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX3JjNi5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfcmM2LmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9yYzZfdHlwZXMuaAoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxl
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUKaW5kZXggNjU4YjkzMGQzNGE4Li5kNmMy
NWQyMTQxM2MgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCkBAIC04NSw2ICs4NSw3IEBAIGd0LXkgKz0g
XAogCWd0L2ludGVsX2d0X3BtX2lycS5vIFwKIAlndC9pbnRlbF9oYW5nY2hlY2subyBcCiAJZ3Qv
aW50ZWxfbHJjLm8gXAorCWd0L2ludGVsX3JjNi5vIFwKIAlndC9pbnRlbF9yZW5kZXJzdGF0ZS5v
IFwKIAlndC9pbnRlbF9yZXNldC5vIFwKIAlndC9pbnRlbF9yaW5nYnVmZmVyLm8gXApkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uYwppbmRleCA2NWI1Y2E3NGIzOTQuLmFl
ZTM5YmEzOTUxYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5n
aW5lX3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMK
QEAgLTExLDYgKzExLDcgQEAKICNpbmNsdWRlICJpbnRlbF9lbmdpbmVfcG9vbC5oIgogI2luY2x1
ZGUgImludGVsX2d0LmgiCiAjaW5jbHVkZSAiaW50ZWxfZ3RfcG0uaCIKKyNpbmNsdWRlICJpbnRl
bF9yYzYuaCIKIAogc3RhdGljIGludCBfX2VuZ2luZV91bnBhcmsoc3RydWN0IGludGVsX3dha2Vy
ZWYgKndmKQogewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3Qu
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmMKaW5kZXggZWVmOWJkYWU4ZWJi
Li5mNjNkNTljZGI1MTIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2d0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuYwpAQCAtNyw2ICs3
LDcgQEAKICNpbmNsdWRlICJpbnRlbF9ndC5oIgogI2luY2x1ZGUgImludGVsX2d0X3BtLmgiCiAj
aW5jbHVkZSAiaW50ZWxfbW9jcy5oIgorI2luY2x1ZGUgImludGVsX3JjNi5oIgogI2luY2x1ZGUg
ImludGVsX3VuY29yZS5oIgogI2luY2x1ZGUgImludGVsX3BtLmgiCiAKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9ndF90eXBlcy5oCmluZGV4IDMwMzljZWY2NGIxMS4uZGQyYzYxMmJlNDJh
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF90eXBlcy5oCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3R5cGVzLmgKQEAgLTE4LDYgKzE4
LDcgQEAKICNpbmNsdWRlICJpOTE1X3ZtYS5oIgogI2luY2x1ZGUgImludGVsX2VuZ2luZV90eXBl
cy5oIgogI2luY2x1ZGUgImludGVsX3Jlc2V0X3R5cGVzLmgiCisjaW5jbHVkZSAiaW50ZWxfcmM2
X3R5cGVzLmgiCiAjaW5jbHVkZSAiaW50ZWxfd2FrZXJlZi5oIgogCiBzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZTsKQEAgLTY3LDYgKzY4LDggQEAgc3RydWN0IGludGVsX2d0IHsKIAkgKi8KIAlpbnRl
bF93YWtlcmVmX3QgYXdha2U7CiAKKwlzdHJ1Y3QgaW50ZWxfcmM2IHJjNjsKKwogCXN0cnVjdCBi
bG9ja2luZ19ub3RpZmllcl9oZWFkIHBtX25vdGlmaWNhdGlvbnM7CiAKIAlrdGltZV90IGxhc3Rf
aW5pdF90aW1lOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmM2
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yYzYuYwpuZXcgZmlsZSBtb2RlIDEw
MDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjliNGVhOGEwMDE5OQotLS0gL2Rldi9udWxsCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JjNi5jCkBAIC0wLDAgKzEsNjY2IEBACisv
KgorICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAorICoKKyAqIENvcHlyaWdodCDCqSAy
MDE5IEludGVsIENvcnBvcmF0aW9uCisgKi8KKworI2luY2x1ZGUgPGxpbnV4L3BtX3J1bnRpbWUu
aD4KKworI2luY2x1ZGUgImk5MTVfZHJ2LmgiCisjaW5jbHVkZSAiaW50ZWxfZ3QuaCIKKyNpbmNs
dWRlICJpbnRlbF9yYzYuaCIKKyNpbmNsdWRlICJpbnRlbF9zaWRlYmFuZC5oIgorCisvKioKKyAq
IERPQzogUkM2CisgKgorICogUkM2IGlzIGEgc3BlY2lhbCBwb3dlciBzdGFnZSB3aGljaCBhbGxv
d3MgdGhlIEdQVSB0byBlbnRlciBhbiB2ZXJ5CisgKiBsb3ctdm9sdGFnZSBtb2RlIHdoZW4gaWRs
ZSwgdXNpbmcgZG93biB0byAwViB3aGlsZSBhdCB0aGlzIHN0YWdlLiAgVGhpcworICogc3RhZ2Ug
aXMgZW50ZXJlZCBhdXRvbWF0aWNhbGx5IHdoZW4gdGhlIEdQVSBpcyBpZGxlIHdoZW4gUkM2IHN1
cHBvcnQgaXMKKyAqIGVuYWJsZWQsIGFuZCBhcyBzb29uIGFzIG5ldyB3b3JrbG9hZCBhcmlzZXMg
R1BVIHdha2VzIHVwIGF1dG9tYXRpY2FsbHkgYXMKKyAqIHdlbGwuCisgKgorICogVGhlcmUgYXJl
IGRpZmZlcmVudCBSQzYgbW9kZXMgYXZhaWxhYmxlIGluIEludGVsIEdQVSwgd2hpY2ggZGlmZmVy
ZW50aWF0ZQorICogYW1vbmcgZWFjaCBvdGhlciB3aXRoIHRoZSBsYXRlbmN5IHJlcXVpcmVkIHRv
IGVudGVyIGFuZCBsZWF2ZSBSQzYgYW5kCisgKiB2b2x0YWdlIGNvbnN1bWVkIGJ5IHRoZSBHUFUg
aW4gZGlmZmVyZW50IHN0YXRlcy4KKyAqCisgKiBUaGUgY29tYmluYXRpb24gb2YgdGhlIGZvbGxv
d2luZyBmbGFncyBkZWZpbmUgd2hpY2ggc3RhdGVzIEdQVSBpcyBhbGxvd2VkCisgKiB0byBlbnRl
ciwgd2hpbGUgUkM2IGlzIHRoZSBub3JtYWwgUkM2IHN0YXRlLCBSQzZwIGlzIHRoZSBkZWVwIFJD
NiwgYW5kCisgKiBSQzZwcCBpcyBkZWVwZXN0IFJDNi4gVGhlaXIgc3VwcG9ydCBieSBoYXJkd2Fy
ZSB2YXJpZXMgYWNjb3JkaW5nIHRvIHRoZQorICogR1BVLCBCSU9TLCBjaGlwc2V0IGFuZCBwbGF0
Zm9ybS4gUkM2IGlzIHVzdWFsbHkgdGhlIHNhZmVzdCBvbmUgYW5kIHRoZSBvbmUKKyAqIHdoaWNo
IGJyaW5ncyB0aGUgbW9zdCBwb3dlciBzYXZpbmdzOyBkZWVwZXIgc3RhdGVzIHNhdmUgbW9yZSBw
b3dlciwgYnV0CisgKiByZXF1aXJlIGhpZ2hlciBsYXRlbmN5IHRvIHN3aXRjaCB0byBhbmQgd2Fr
ZSB1cC4KKyAqLworCitzdGF0aWMgc3RydWN0IGludGVsX2d0ICpyYzZfdG9fZ3Qoc3RydWN0IGlu
dGVsX3JjNiAqcmM2KQoreworCXJldHVybiBjb250YWluZXJfb2YocmM2LCBzdHJ1Y3QgaW50ZWxf
Z3QsIHJjNik7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgaW50ZWxfdW5jb3JlICpyYzZfdG9fdW5jb3Jl
KHN0cnVjdCBpbnRlbF9yYzYgKnJjKQoreworCXJldHVybiByYzZfdG9fZ3QocmMpLT51bmNvcmU7
Cit9CisKK3N0YXRpYyBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqcmM2X3RvX2k5MTUoc3RydWN0
IGludGVsX3JjNiAqcmMpCit7CisJcmV0dXJuIHJjNl90b19ndChyYyktPmk5MTU7Cit9CisKK3N0
YXRpYyB2b2lkIGdlbjExX3JjNl9lbmFibGUoc3RydWN0IGludGVsX3JjNiAqcmM2KQoreworCXN0
cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IHJjNl90b191bmNvcmUocmM2KTsKKwlzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmU7CisJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CisKKwkv
KiAxYTogU29mdHdhcmUgUkMgc3RhdGUgLSBSQzAgKi8KKwlpbnRlbF91bmNvcmVfd3JpdGVfZnco
dW5jb3JlLCBHRU42X1JDX1NUQVRFLCAwKTsKKworCS8qIDJhOiBEaXNhYmxlIFJDIHN0YXRlcy4g
Ki8KKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JDX0NPTlRST0wsIDApOwor
CisJLyogMmI6IFByb2dyYW0gUkM2IHRocmVzaG9sZHMuKi8KKwlpbnRlbF91bmNvcmVfd3JpdGVf
ZncodW5jb3JlLCBHRU42X1JDNl9XQUtFX1JBVEVfTElNSVQsIDU0IDw8IDE2IHwgODUpOworCWlu
dGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjEwX01FRElBX1dBS0VfUkFURV9MSU1JVCwg
MTUwKTsKKworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUkNfRVZBTFVBVElP
Tl9JTlRFUlZBTCwgMTI1MDAwKTsgLyogMTI1MDAgKiAxMjgwbnMgKi8KKwlpbnRlbF91bmNvcmVf
d3JpdGVfZncodW5jb3JlLCBHRU42X1JDX0lETEVfSFlTVEVSU0lTLCAyNSk7IC8qIDI1ICogMTI4
MG5zICovCisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgcmM2X3RvX2d0KHJjNiktPmk5MTUsIGlk
KQorCQlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBSSU5HX01BWF9JRExFKGVuZ2luZS0+
bW1pb19iYXNlKSwgMTApOworCisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR1VDX01B
WF9JRExFX0NPVU5ULCAweEEpOworCisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VO
Nl9SQ19TTEVFUCwgMCk7CisKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JD
Nl9USFJFU0hPTEQsIDUwMDAwKTsgLyogNTAvMTI1bXMgcGVyIEVJICovCisKKwkvKgorCSAqIDJj
OiBQcm9ncmFtIENvYXJzZSBQb3dlciBHYXRpbmcgUG9saWNpZXMuCisJICoKKwkgKiBCc3BlYydz
IGd1aWRhbmNlIGlzIHRvIHVzZSAyNXVzIChyZWFsbHkgMjUgKiAxMjgwbnMpIGhlcmUuIFdoYXQg
d2UKKwkgKiB1c2UgaW5zdGVhZCBpcyBhIG1vcmUgY29uc2VydmF0aXZlIGVzdGltYXRlIGZvciB0
aGUgbWF4aW11bSB0aW1lCisJICogaXQgdGFrZXMgdXMgdG8gc2VydmljZSBhIENTIGludGVycnVw
dCBhbmQgc3VibWl0IGEgbmV3IEVMU1AgLSB0aGF0CisJICogaXMgdGhlIHRpbWUgd2hpY2ggdGhl
IEdQVSBpcyBpZGxlIHdhaXRpbmcgZm9yIHRoZSBDUFUgdG8gc2VsZWN0IHRoZQorCSAqIG5leHQg
cmVxdWVzdCB0byBleGVjdXRlLiBJZiB0aGUgaWRsZSBoeXN0ZXJlc2lzIGlzIGxlc3MgdGhhbiB0
aGF0CisJICogaW50ZXJydXB0IHNlcnZpY2UgbGF0ZW5jeSwgdGhlIGhhcmR3YXJlIHdpbGwgYXV0
b21hdGljYWxseSBnYXRlCisJICogdGhlIHBvd2VyIHdlbGwgYW5kIHdlIHdpbGwgdGhlbiBpbmN1
ciB0aGUgd2FrZSB1cCBjb3N0IG9uIHRvcCBvZgorCSAqIHRoZSBzZXJ2aWNlIGxhdGVuY3kuIEEg
c2ltaWxhciBndWlkZSBmcm9tIHBsYW5lX3N0YXRlIGlzIHRoYXQgd2UKKwkgKiBkbyBub3Qgd2Fu
dCB0aGUgZW5hYmxlIGh5c3RlcmVzaXMgdG8gbGVzcyB0aGFuIHRoZSB3YWtldXAgbGF0ZW5jeS4K
KwkgKgorCSAqIGlndC9nZW1fZXhlY19ub3Avc2VxdWVudGlhbCBwcm92aWRlcyBhIHJvdWdoIGVz
dGltYXRlIGZvciB0aGUKKwkgKiBzZXJ2aWNlIGxhdGVuY3ksIGFuZCBwdXRzIGl0IGFyb3VuZCAx
MHVzIGZvciBCcm9hZHdlbGwgKGFuZCBvdGhlcgorCSAqIGJpZyBjb3JlKSBhbmQgYXJvdW5kIDQw
dXMgZm9yIEJyb3h0b24gKGFuZCBvdGhlciBsb3cgcG93ZXIgY29yZXMpLgorCSAqIFtOb3RlIHRo
YXQgZm9yIGxlZ2FjeSByaW5nYnVmZmVyIHN1Ym1pc3Npb24sIHRoaXMgaXMgbGVzcyB0aGFuIDF1
cyFdCisJICogSG93ZXZlciwgdGhlIHdha2V1cCBsYXRlbmN5IG9uIEJyb3h0b24gaXMgY2xvc2Vy
IHRvIDEwMHVzLiBUbyBiZQorCSAqIGNvbnNlcnZhdGl2ZSwgd2UgaGF2ZSB0byBmYWN0b3IgaW4g
YSBjb250ZXh0IHN3aXRjaCBvbiB0b3AgKGR1ZQorCSAqIHRvIGtzb2Z0aXJxZCkuCisJICovCisJ
aW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VOOV9NRURJQV9QR19JRExFX0hZU1RFUkVT
SVMsIDI1MCk7CisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VOOV9SRU5ERVJfUEdf
SURMRV9IWVNURVJFU0lTLCAyNTApOworCisJLyogM2E6IEVuYWJsZSBSQzYgKi8KKwlpbnRlbF91
bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JDX0NPTlRST0wsCisJCQkgICAgICBHRU42X1JD
X0NUTF9IV19FTkFCTEUgfAorCQkJICAgICAgR0VONl9SQ19DVExfUkM2X0VOQUJMRSB8CisJCQkg
ICAgICBHRU42X1JDX0NUTF9FSV9NT0RFKDEpKTsKKworCWludGVsX3VuY29yZV93cml0ZV9mdyh1
bmNvcmUsIEdFTjlfUEdfRU5BQkxFLAorCQkJICAgICAgR0VOOV9SRU5ERVJfUEdfRU5BQkxFIHwK
KwkJCSAgICAgIEdFTjlfTUVESUFfUEdfRU5BQkxFIHwKKwkJCSAgICAgIEdFTjExX01FRElBX1NB
TVBMRVJfUEdfRU5BQkxFKTsKK30KKworc3RhdGljIHZvaWQgZ2VuOV9yYzZfZW5hYmxlKHN0cnVj
dCBpbnRlbF9yYzYgKnJjNikKK3sKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSByYzZf
dG9fdW5jb3JlKHJjNik7CisJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOworCWVudW0g
aW50ZWxfZW5naW5lX2lkIGlkOworCXUzMiByYzZfbW9kZTsKKworCS8qIDFhOiBTb2Z0d2FyZSBS
QyBzdGF0ZSAtIFJDMCAqLworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUkNf
U1RBVEUsIDApOworCisJLyogMmE6IERpc2FibGUgUkMgc3RhdGVzLiAqLworCWludGVsX3VuY29y
ZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUkNfQ09OVFJPTCwgMCk7CisKKwkvKiAyYjogUHJvZ3Jh
bSBSQzYgdGhyZXNob2xkcy4qLworCWlmIChJTlRFTF9HRU4ocmM2X3RvX2k5MTUocmM2KSkgPj0g
MTApIHsKKwkJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQzZfV0FLRV9SQVRF
X0xJTUlULCA1NCA8PCAxNiB8IDg1KTsKKwkJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwg
R0VOMTBfTUVESUFfV0FLRV9SQVRFX0xJTUlULCAxNTApOworCX0gZWxzZSBpZiAoSVNfU0tZTEFL
RShyYzZfdG9faTkxNShyYzYpKSkgeworCQkvKgorCQkgKiBXYVJzRG91YmxlUmM2V3JsV2l0aENv
YXJzZVBvd2VyR2F0aW5nOnNrbCBEb3VibGluZyBXUkwgb25seQorCQkgKiB3aGVuIENQRyBpcyBl
bmFibGVkCisJCSAqLworCQlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JDNl9X
QUtFX1JBVEVfTElNSVQsIDEwOCA8PCAxNik7CisJfSBlbHNlIHsKKwkJaW50ZWxfdW5jb3JlX3dy
aXRlX2Z3KHVuY29yZSwgR0VONl9SQzZfV0FLRV9SQVRFX0xJTUlULCA1NCA8PCAxNik7CisJfQor
CisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQ19FVkFMVUFUSU9OX0lOVEVS
VkFMLCAxMjUwMDApOyAvKiAxMjUwMCAqIDEyODBucyAqLworCWludGVsX3VuY29yZV93cml0ZV9m
dyh1bmNvcmUsIEdFTjZfUkNfSURMRV9IWVNURVJTSVMsIDI1KTsgLyogMjUgKiAxMjgwbnMgKi8K
Kwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCByYzZfdG9fZ3QocmM2KS0+aTkxNSwgaWQpCisJCWlu
dGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIFJJTkdfTUFYX0lETEUoZW5naW5lLT5tbWlvX2Jh
c2UpLCAxMCk7CisKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHVUNfTUFYX0lETEVf
Q09VTlQsIDB4QSk7CisKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JDX1NM
RUVQLCAwKTsKKworCS8qCisJICogMmM6IFByb2dyYW0gQ29hcnNlIFBvd2VyIEdhdGluZyBQb2xp
Y2llcy4KKwkgKgorCSAqIEJzcGVjJ3MgZ3VpZGFuY2UgaXMgdG8gdXNlIDI1dXMgKHJlYWxseSAy
NSAqIDEyODBucykgaGVyZS4gV2hhdCB3ZQorCSAqIHVzZSBpbnN0ZWFkIGlzIGEgbW9yZSBjb25z
ZXJ2YXRpdmUgZXN0aW1hdGUgZm9yIHRoZSBtYXhpbXVtIHRpbWUKKwkgKiBpdCB0YWtlcyB1cyB0
byBzZXJ2aWNlIGEgQ1MgaW50ZXJydXB0IGFuZCBzdWJtaXQgYSBuZXcgRUxTUCAtIHRoYXQKKwkg
KiBpcyB0aGUgdGltZSB3aGljaCB0aGUgR1BVIGlzIGlkbGUgd2FpdGluZyBmb3IgdGhlIENQVSB0
byBzZWxlY3QgdGhlCisJICogbmV4dCByZXF1ZXN0IHRvIGV4ZWN1dGUuIElmIHRoZSBpZGxlIGh5
c3RlcmVzaXMgaXMgbGVzcyB0aGFuIHRoYXQKKwkgKiBpbnRlcnJ1cHQgc2VydmljZSBsYXRlbmN5
LCB0aGUgaGFyZHdhcmUgd2lsbCBhdXRvbWF0aWNhbGx5IGdhdGUKKwkgKiB0aGUgcG93ZXIgd2Vs
bCBhbmQgd2Ugd2lsbCB0aGVuIGluY3VyIHRoZSB3YWtlIHVwIGNvc3Qgb24gdG9wIG9mCisJICog
dGhlIHNlcnZpY2UgbGF0ZW5jeS4gQSBzaW1pbGFyIGd1aWRlIGZyb20gcGxhbmVfc3RhdGUgaXMg
dGhhdCB3ZQorCSAqIGRvIG5vdCB3YW50IHRoZSBlbmFibGUgaHlzdGVyZXNpcyB0byBsZXNzIHRo
YW4gdGhlIHdha2V1cCBsYXRlbmN5LgorCSAqCisJICogaWd0L2dlbV9leGVjX25vcC9zZXF1ZW50
aWFsIHByb3ZpZGVzIGEgcm91Z2ggZXN0aW1hdGUgZm9yIHRoZQorCSAqIHNlcnZpY2UgbGF0ZW5j
eSwgYW5kIHB1dHMgaXQgYXJvdW5kIDEwdXMgZm9yIEJyb2Fkd2VsbCAoYW5kIG90aGVyCisJICog
YmlnIGNvcmUpIGFuZCBhcm91bmQgNDB1cyBmb3IgQnJveHRvbiAoYW5kIG90aGVyIGxvdyBwb3dl
ciBjb3JlcykuCisJICogW05vdGUgdGhhdCBmb3IgbGVnYWN5IHJpbmdidWZmZXIgc3VibWlzc2lv
biwgdGhpcyBpcyBsZXNzIHRoYW4gMXVzIV0KKwkgKiBIb3dldmVyLCB0aGUgd2FrZXVwIGxhdGVu
Y3kgb24gQnJveHRvbiBpcyBjbG9zZXIgdG8gMTAwdXMuIFRvIGJlCisJICogY29uc2VydmF0aXZl
LCB3ZSBoYXZlIHRvIGZhY3RvciBpbiBhIGNvbnRleHQgc3dpdGNoIG9uIHRvcCAoZHVlCisJICog
dG8ga3NvZnRpcnFkKS4KKwkgKi8KKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU45
X01FRElBX1BHX0lETEVfSFlTVEVSRVNJUywgMjUwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGVfZnco
dW5jb3JlLCBHRU45X1JFTkRFUl9QR19JRExFX0hZU1RFUkVTSVMsIDI1MCk7CisKKwkvKiAzYTog
RW5hYmxlIFJDNiAqLworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUkM2X1RI
UkVTSE9MRCwgMzc1MDApOyAvKiAzNy41LzEyNW1zIHBlciBFSSAqLworCisJLyogV2FSc1VzZVRp
bWVvdXRNb2RlOmNubCAocHJlLXByb2QpICovCisJaWYgKElTX0NOTF9SRVZJRChyYzZfdG9faTkx
NShyYzYpLCBDTkxfUkVWSURfQTAsIENOTF9SRVZJRF9DMCkpCisJCXJjNl9tb2RlID0gR0VON19S
Q19DVExfVE9fTU9ERTsKKwllbHNlCisJCXJjNl9tb2RlID0gR0VONl9SQ19DVExfRUlfTU9ERSgx
KTsKKworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUkNfQ09OVFJPTCwKKwkJ
CSAgICAgIEdFTjZfUkNfQ1RMX0hXX0VOQUJMRSB8CisJCQkgICAgICBHRU42X1JDX0NUTF9SQzZf
RU5BQkxFIHwKKwkJCSAgICAgIHJjNl9tb2RlKTsKKworCWludGVsX3VuY29yZV93cml0ZV9mdyh1
bmNvcmUsIEdFTjlfUEdfRU5BQkxFLAorCQkJICAgICAgR0VOOV9SRU5ERVJfUEdfRU5BQkxFIHwg
R0VOOV9NRURJQV9QR19FTkFCTEUpOworfQorCitzdGF0aWMgdm9pZCBnZW44X3JjNl9lbmFibGUo
c3RydWN0IGludGVsX3JjNiAqcmM2KQoreworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9
IHJjNl90b191bmNvcmUocmM2KTsKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CisJ
ZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CisKKwkvKiAxYTogU29mdHdhcmUgUkMgc3RhdGUgLSBS
QzAgKi8KKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JDX1NUQVRFLCAwKTsK
KworCS8qIDJhOiBEaXNhYmxlIFJDIHN0YXRlcy4gKi8KKwlpbnRlbF91bmNvcmVfd3JpdGVfZnco
dW5jb3JlLCBHRU42X1JDX0NPTlRST0wsIDApOworCisJLyogMmI6IFByb2dyYW0gUkM2IHRocmVz
aG9sZHMuKi8KKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JDNl9XQUtFX1JB
VEVfTElNSVQsIDQwIDw8IDE2KTsKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42
X1JDX0VWQUxVQVRJT05fSU5URVJWQUwsIDEyNTAwMCk7IC8qIDEyNTAwICogMTI4MG5zICovCisJ
aW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQ19JRExFX0hZU1RFUlNJUywgMjUp
OyAvKiAyNSAqIDEyODBucyAqLworCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIHJjNl90b19ndChy
YzYpLT5pOTE1LCBpZCkKKwkJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgUklOR19NQVhf
SURMRShlbmdpbmUtPm1taW9fYmFzZSksIDEwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5j
b3JlLCBHRU42X1JDX1NMRUVQLCAwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBH
RU42X1JDNl9USFJFU0hPTEQsIDYyNSk7IC8qIDgwMHVzLzEuMjggZm9yIFRPICovCisKKwkvKiAz
OiBFbmFibGUgUkM2ICovCisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQ19D
T05UUk9MLAorCQkJICAgICAgR0VONl9SQ19DVExfSFdfRU5BQkxFIHwKKwkJCSAgICAgIEdFTjdf
UkNfQ1RMX1RPX01PREUgfAorCQkJICAgICAgR0VONl9SQ19DVExfUkM2X0VOQUJMRSk7Cit9CisK
K3N0YXRpYyB2b2lkIGdlbjZfcmM2X2VuYWJsZShzdHJ1Y3QgaW50ZWxfcmM2ICpyYzYpCit7CisJ
c3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gcmM2X3RvX3VuY29yZShyYzYpOworCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gcmM2X3RvX2k5MTUocmM2KTsKKwlzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmU7CisJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CisJdTMyIHJj
NnZpZHMsIHJjNl9tYXNrOworCWludCByZXQ7CisKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5j
b3JlLCBHRU42X1JDX1NUQVRFLCAwKTsKKworCS8qIGRpc2FibGUgdGhlIGNvdW50ZXJzIGFuZCBz
ZXQgZGV0ZXJtaW5pc3RpYyB0aHJlc2hvbGRzICovCisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVu
Y29yZSwgR0VONl9SQ19DT05UUk9MLCAwKTsKKworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNv
cmUsIEdFTjZfUkMxX1dBS0VfUkFURV9MSU1JVCwgMTAwMCA8PCAxNik7CisJaW50ZWxfdW5jb3Jl
X3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQzZfV0FLRV9SQVRFX0xJTUlULCA0MCA8PCAxNiB8IDMw
KTsKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JDNnBwX1dBS0VfUkFURV9M
SU1JVCwgMzApOworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUkNfRVZBTFVB
VElPTl9JTlRFUlZBTCwgMTI1MDAwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBH
RU42X1JDX0lETEVfSFlTVEVSU0lTLCAyNSk7CisKKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBp
OTE1LCBpZCkKKwkJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgUklOR19NQVhfSURMRShl
bmdpbmUtPm1taW9fYmFzZSksCisJCQkJICAgICAgMTApOworCisJaW50ZWxfdW5jb3JlX3dyaXRl
X2Z3KHVuY29yZSwgR0VONl9SQ19TTEVFUCwgMCk7CisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVu
Y29yZSwgR0VONl9SQzFlX1RIUkVTSE9MRCwgMTAwMCk7CisJaWYgKElTX0lWWUJSSURHRShpOTE1
KSkKKwkJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQzZfVEhSRVNIT0xELCAx
MjUwMDApOworCWVsc2UKKwkJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQzZf
VEhSRVNIT0xELCA1MDAwMCk7CisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9S
QzZwX1RIUkVTSE9MRCwgMTUwMDAwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBH
RU42X1JDNnBwX1RIUkVTSE9MRCwgNjQwMDApOyAvKiB1bnVzZWQgKi8KKworCS8qIFdlIGRvbid0
IHVzZSB0aG9zZSBvbiBIYXN3ZWxsICovCisJcmM2X21hc2sgPSBHRU42X1JDX0NUTF9SQzZfRU5B
QkxFOworCWlmIChIQVNfUkM2cChpOTE1KSkKKwkJcmM2X21hc2sgfD0gR0VONl9SQ19DVExfUkM2
cF9FTkFCTEU7CisJaWYgKEhBU19SQzZwcChpOTE1KSkKKwkJcmM2X21hc2sgfD0gR0VONl9SQ19D
VExfUkM2cHBfRU5BQkxFOworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUkNf
Q09OVFJPTCwKKwkJCSAgICAgIHJjNl9tYXNrIHwKKwkJCSAgICAgIEdFTjZfUkNfQ1RMX0VJX01P
REUoMSkgfAorCQkJICAgICAgR0VONl9SQ19DVExfSFdfRU5BQkxFKTsKKworCXJjNnZpZHMgPSAw
OworCXJldCA9IHNhbmR5YnJpZGdlX3Bjb2RlX3JlYWQoaTkxNSwgR0VONl9QQ09ERV9SRUFEX1JD
NlZJRFMsCisJCQkJICAgICAmcmM2dmlkcywgTlVMTCk7CisJaWYgKElTX0dFTihpOTE1LCA2KSAm
JiByZXQpIHsKKwkJRFJNX0RFQlVHX0RSSVZFUigiQ291bGRuJ3QgY2hlY2sgZm9yIEJJT1Mgd29y
a2Fyb3VuZFxuIik7CisJfSBlbHNlIGlmIChJU19HRU4oaTkxNSwgNikgJiYKKwkJICAgKEdFTjZf
REVDT0RFX1JDNl9WSUQocmM2dmlkcyAmIDB4ZmYpIDwgNDUwKSkgeworCQlEUk1fREVCVUdfRFJJ
VkVSKCJZb3Ugc2hvdWxkIHVwZGF0ZSB5b3VyIEJJT1MuIENvcnJlY3RpbmcgbWluaW11bSByYzYg
dm9sdGFnZSAoJWRtVi0+JWRtVilcbiIsCisJCQkJIEdFTjZfREVDT0RFX1JDNl9WSUQocmM2dmlk
cyAmIDB4ZmYpLCA0NTApOworCQlyYzZ2aWRzICY9IDB4ZmZmZjAwOworCQlyYzZ2aWRzIHw9IEdF
TjZfRU5DT0RFX1JDNl9WSUQoNDUwKTsKKwkJcmV0ID0gc2FuZHlicmlkZ2VfcGNvZGVfd3JpdGUo
aTkxNSwgR0VONl9QQ09ERV9XUklURV9SQzZWSURTLCByYzZ2aWRzKTsKKwkJaWYgKHJldCkKKwkJ
CURSTV9FUlJPUigiQ291bGRuJ3QgZml4IGluY29ycmVjdCByYzYgdm9sdGFnZVxuIik7CisJfQor
fQorCisvKiBDaGVjayB0aGF0IHRoZSBwY2JyIGFkZHJlc3MgaXMgbm90IGVtcHR5LiAqLworc3Rh
dGljIHZvaWQgY2h2X3JjNl9pbml0KHN0cnVjdCBpbnRlbF9yYzYgKnJjNikKK3sKKwlzdHJ1Y3Qg
aW50ZWxfdW5jb3JlICp1bmNvcmUgPSByYzZfdG9fdW5jb3JlKHJjNik7CisJcmVzb3VyY2Vfc2l6
ZV90IHBjdHhfcGFkZHIsIHBhZGRyOworCXJlc291cmNlX3NpemVfdCBwY3R4X3NpemUgPSAzMiAq
IFNaXzFLOworCXUzMiBwY2JyOworCisJcGNiciA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwg
VkxWX1BDQlIpOworCWlmICgocGNiciA+PiBWTFZfUENCUl9BRERSX1NISUZUKSA9PSAwKSB7CisJ
CURSTV9ERUJVR19EUklWRVIoIkJJT1MgZGlkbid0IHNldCB1cCBQQ0JSLCBmaXhpbmcgdXBcbiIp
OworCQlwYWRkciA9IHJjNl90b19pOTE1KHJjNiktPmRzbS5lbmQgKyAxIC0gcGN0eF9zaXplOwor
CQlHRU1fQlVHX09OKHBhZGRyID4gVTMyX01BWCk7CisKKwkJcGN0eF9wYWRkciA9IChwYWRkciAm
IH40MDk1KTsKKwkJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgVkxWX1BDQlIsIHBjdHhfcGFk
ZHIpOworCX0KK30KKworc3RhdGljIHZvaWQgdmx2X3JjNl9pbml0KHN0cnVjdCBpbnRlbF9yYzYg
KnJjNikKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHJjNl90b19pOTE1KHJj
Nik7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gcmM2X3RvX3VuY29yZShyYzYpOwor
CXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpwY3R4OworCXJlc291cmNlX3NpemVfdCBwY3R4
X3BhZGRyOworCXJlc291cmNlX3NpemVfdCBwY3R4X3NpemUgPSAyNCAqIFNaXzFLOworCXUzMiBw
Y2JyOworCisJcGNiciA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgVkxWX1BDQlIpOworCWlm
IChwY2JyKSB7CisJCS8qIEJJT1Mgc2V0IGl0IHVwIGFscmVhZHksIGdyYWIgdGhlIHByZS1hbGxv
YydkIHNwYWNlICovCisJCXJlc291cmNlX3NpemVfdCBwY2JyX29mZnNldDsKKworCQlwY2JyX29m
ZnNldCA9IChwY2JyICYgfjQwOTUpIC0gaTkxNS0+ZHNtLnN0YXJ0OworCQlwY3R4ID0gaTkxNV9n
ZW1fb2JqZWN0X2NyZWF0ZV9zdG9sZW5fZm9yX3ByZWFsbG9jYXRlZChpOTE1LAorCQkJCQkJCQkg
ICAgICBwY2JyX29mZnNldCwKKwkJCQkJCQkJICAgICAgSTkxNV9HVFRfT0ZGU0VUX05PTkUsCisJ
CQkJCQkJCSAgICAgIHBjdHhfc2l6ZSk7CisJCWdvdG8gb3V0OworCX0KKworCURSTV9ERUJVR19E
UklWRVIoIkJJT1MgZGlkbid0IHNldCB1cCBQQ0JSLCBmaXhpbmcgdXBcbiIpOworCisJLyoKKwkg
KiBGcm9tIHRoZSBHdW5pdCByZWdpc3RlciBIQVM6CisJICogVGhlIEdmeCBkcml2ZXIgaXMgZXhw
ZWN0ZWQgdG8gcHJvZ3JhbSB0aGlzIHJlZ2lzdGVyIGFuZCBlbnN1cmUKKwkgKiBwcm9wZXIgYWxs
b2NhdGlvbiB3aXRoaW4gR2Z4IHN0b2xlbiBtZW1vcnkuICBGb3IgZXhhbXBsZSwgdGhpcworCSAq
IHJlZ2lzdGVyIHNob3VsZCBiZSBwcm9ncmFtbWVkIHN1Y2ggdGhhbiB0aGUgUENCUiByYW5nZSBk
b2VzIG5vdAorCSAqIG92ZXJsYXAgd2l0aCBvdGhlciByYW5nZXMsIHN1Y2ggYXMgdGhlIGZyYW1l
IGJ1ZmZlciwgcHJvdGVjdGVkCisJICogbWVtb3J5LCBvciBhbnkgb3RoZXIgcmVsZXZhbnQgcmFu
Z2VzLgorCSAqLworCXBjdHggPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3N0b2xlbihpOTE1LCBw
Y3R4X3NpemUpOworCWlmICghcGN0eCkgeworCQlEUk1fREVCVUcoIm5vdCBlbm91Z2ggc3RvbGVu
IHNwYWNlIGZvciBQQ1RYLCBkaXNhYmxpbmdcbiIpOworCQlnb3RvIG91dDsKKwl9CisKKwlHRU1f
QlVHX09OKHJhbmdlX292ZXJmbG93c190KHU2NCwKKwkJCQkgICAgIGk5MTUtPmRzbS5zdGFydCwK
KwkJCQkgICAgIHBjdHgtPnN0b2xlbi0+c3RhcnQsCisJCQkJICAgICBVMzJfTUFYKSk7CisJcGN0
eF9wYWRkciA9IGk5MTUtPmRzbS5zdGFydCArIHBjdHgtPnN0b2xlbi0+c3RhcnQ7CisJaW50ZWxf
dW5jb3JlX3dyaXRlKHVuY29yZSwgVkxWX1BDQlIsIHBjdHhfcGFkZHIpOworCitvdXQ6CisJcmM2
LT5wY3R4ID0gcGN0eDsKK30KKworc3RhdGljIHZvaWQgY2h2X3JjNl9lbmFibGUoc3RydWN0IGlu
dGVsX3JjNiAqcmM2KQoreworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IHJjNl90b191
bmNvcmUocmM2KTsKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CisJZW51bSBpbnRl
bF9lbmdpbmVfaWQgaWQ7CisKKwkvKiAgRGlzYWJsZSBSQyBzdGF0ZXMuICovCisJaW50ZWxfdW5j
b3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQ19DT05UUk9MLCAwKTsKKworCS8qIDJhOiBQcm9n
cmFtIFJDNiB0aHJlc2hvbGRzLiovCisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwKKwkJ
CSAgICAgIEdFTjZfUkM2X1dBS0VfUkFURV9MSU1JVCwgNDAgPDwgMTYpOworCWludGVsX3VuY29y
ZV93cml0ZV9mdyh1bmNvcmUsIC8qIDEyNTAwICogMTI4MG5zICovCisJCQkgICAgICBHRU42X1JD
X0VWQUxVQVRJT05fSU5URVJWQUwsIDEyNTAwMCk7CisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVu
Y29yZSwgLyogMjUgKiAxMjgwbnMgKi8KKwkJCSAgICAgIEdFTjZfUkNfSURMRV9IWVNURVJTSVMs
IDI1KTsKKworCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIHJjNl90b19ndChyYzYpLT5pOTE1LCBp
ZCkKKwkJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgUklOR19NQVhfSURMRShlbmdpbmUt
Pm1taW9fYmFzZSksCisJCQkJICAgICAgMTApOworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNv
cmUsIEdFTjZfUkNfU0xFRVAsIDApOworCisJLyogVE8gdGhyZXNob2xkIHNldCB0byA1MDAgdXMg
KCAweDE4NiAqIDEuMjggdXMpICovCisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VO
Nl9SQzZfVEhSRVNIT0xELCAweDE4Nik7CisKKwkvKiBBbGxvd3MgUkM2IHJlc2lkZW5jeSBjb3Vu
dGVyIHRvIHdvcmsgKi8KKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBWTFZfQ09VTlRF
Ul9DT05UUk9MLAorCQkJICAgICAgX01BU0tFRF9CSVRfRU5BQkxFKFZMVl9DT1VOVF9SQU5HRV9I
SUdIIHwKKwkJCQkJCSBWTFZfTUVESUFfUkM2X0NPVU5UX0VOIHwKKwkJCQkJCSBWTFZfUkVOREVS
X1JDNl9DT1VOVF9FTikpOworCisJLyogMzogRW5hYmxlIFJDNiAqLworCWludGVsX3VuY29yZV93
cml0ZV9mdyh1bmNvcmUsIEdFTjZfUkNfQ09OVFJPTCwgR0VON19SQ19DVExfVE9fTU9ERSk7Cit9
CisKK3N0YXRpYyB2b2lkIHZsdl9yYzZfZW5hYmxlKHN0cnVjdCBpbnRlbF9yYzYgKnJjNikKK3sK
KwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSByYzZfdG9fdW5jb3JlKHJjNik7CisJc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOworCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwor
CisJLyogIERpc2FibGUgUkMgc3RhdGVzLiAqLworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNv
cmUsIEdFTjZfUkNfQ09OVFJPTCwgMCk7CisKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3Jl
LCBHRU42X1JDNl9XQUtFX1JBVEVfTElNSVQsIDB4MDAyODAwMDApOworCWludGVsX3VuY29yZV93
cml0ZV9mdyh1bmNvcmUsIEdFTjZfUkNfRVZBTFVBVElPTl9JTlRFUlZBTCwgMTI1MDAwKTsKKwlp
bnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JDX0lETEVfSFlTVEVSU0lTLCAyNSk7
CisKKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCByYzZfdG9fZ3QocmM2KS0+aTkxNSwgaWQpCisJ
CWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsCisJCQkJICAgICAgUklOR19NQVhfSURMRShl
bmdpbmUtPm1taW9fYmFzZSksIDEwKTsKKworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUs
IEdFTjZfUkM2X1RIUkVTSE9MRCwgMHg1NTcpOworCisJLyogQWxsb3dzIFJDNiByZXNpZGVuY3kg
Y291bnRlciB0byB3b3JrICovCisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgVkxWX0NP
VU5URVJfQ09OVFJPTCwKKwkJCSAgICAgIF9NQVNLRURfQklUX0VOQUJMRShWTFZfQ09VTlRfUkFO
R0VfSElHSCB8CisJCQkJCQkgVkxWX01FRElBX1JDMF9DT1VOVF9FTiB8CisJCQkJCQkgVkxWX1JF
TkRFUl9SQzBfQ09VTlRfRU4gfAorCQkJCQkJIFZMVl9NRURJQV9SQzZfQ09VTlRfRU4gfAorCQkJ
CQkJIFZMVl9SRU5ERVJfUkM2X0NPVU5UX0VOKSk7CisKKwlpbnRlbF91bmNvcmVfd3JpdGVfZnco
dW5jb3JlLCBHRU42X1JDX0NPTlRST0wsCisJCQkgICAgICBHRU43X1JDX0NUTF9UT19NT0RFIHwg
VkxWX1JDX0NUTF9DVFhfUlNUX1BBUkFMTEVMKTsKK30KKwordm9pZCBpbnRlbF9yYzZfaW5pdChz
dHJ1Y3QgaW50ZWxfcmM2ICpyYzYpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSByYzZfdG9faTkxNShyYzYpOworCisJaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpCisJCWNodl9y
YzZfaW5pdChyYzYpOworCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkpCisJCXZsdl9yYzZf
aW5pdChyYzYpOworfQorCitzdGF0aWMgYm9vbCBieHRfY2hlY2tfYmlvc19yYzZfc2V0dXAoc3Ry
dWN0IGludGVsX3JjNiAqcmM2KQoreworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IHJj
Nl90b191bmNvcmUocmM2KTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHJjNl90
b19pOTE1KHJjNik7CisJdTMyIHJjNl9jdHhfYmFzZSwgcmNfY3RsLCByY19zd190YXJnZXQ7CisJ
Ym9vbCBlbmFibGVfcmM2ID0gdHJ1ZTsKKworCXJjX2N0bCA9IGludGVsX3VuY29yZV9yZWFkKHVu
Y29yZSwgR0VONl9SQ19DT05UUk9MKTsKKwlyY19zd190YXJnZXQgPSBpbnRlbF91bmNvcmVfcmVh
ZCh1bmNvcmUsIEdFTjZfUkNfU1RBVEUpOworCXJjX3N3X3RhcmdldCAmPSBSQ19TV19UQVJHRVRf
U1RBVEVfTUFTSzsKKwlyY19zd190YXJnZXQgPj49IFJDX1NXX1RBUkdFVF9TVEFURV9TSElGVDsK
KwlEUk1fREVCVUdfRFJJVkVSKCJCSU9TIGVuYWJsZWQgUkMgc3RhdGVzOiAiCisJCQkgIkhXX0NU
UkwgJXMgSFdfUkM2ICVzIFNXX1RBUkdFVF9TVEFURSAleFxuIiwKKwkJCSBvbm9mZihyY19jdGwg
JiBHRU42X1JDX0NUTF9IV19FTkFCTEUpLAorCQkJIG9ub2ZmKHJjX2N0bCAmIEdFTjZfUkNfQ1RM
X1JDNl9FTkFCTEUpLAorCQkJIHJjX3N3X3RhcmdldCk7CisKKwlpZiAoIShpbnRlbF91bmNvcmVf
cmVhZCh1bmNvcmUsIFJDNl9MT0NBVElPTikgJiBSQzZfQ1RYX0lOX0RSQU0pKSB7CisJCURSTV9E
RUJVR19EUklWRVIoIlJDNiBCYXNlIGxvY2F0aW9uIG5vdCBzZXQgcHJvcGVybHkuXG4iKTsKKwkJ
ZW5hYmxlX3JjNiA9IGZhbHNlOworCX0KKworCS8qCisJICogVGhlIGV4YWN0IGNvbnRleHQgc2l6
ZSBpcyBub3Qga25vd24gZm9yIEJYVCwgc28gYXNzdW1lIGEgcGFnZSBzaXplCisJICogZm9yIHRo
aXMgY2hlY2suCisJICovCisJcmM2X2N0eF9iYXNlID0KKwkJaW50ZWxfdW5jb3JlX3JlYWQodW5j
b3JlLCBSQzZfQ1RYX0JBU0UpICYgUkM2X0NUWF9CQVNFX01BU0s7CisJaWYgKCEocmM2X2N0eF9i
YXNlID49IGk5MTUtPmRzbV9yZXNlcnZlZC5zdGFydCAmJgorCSAgICAgIHJjNl9jdHhfYmFzZSAr
IFBBR0VfU0laRSA8IGk5MTUtPmRzbV9yZXNlcnZlZC5lbmQpKSB7CisJCURSTV9ERUJVR19EUklW
RVIoIlJDNiBCYXNlIGFkZHJlc3Mgbm90IGFzIGV4cGVjdGVkLlxuIik7CisJCWVuYWJsZV9yYzYg
PSBmYWxzZTsKKwl9CisKKwlpZiAoISgoaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBQV1JDVFhf
TUFYQ05UX1JDU1VOSVQpICYgSURMRV9USU1FX01BU0spID4gMSAmJgorCSAgICAgIChpbnRlbF91
bmNvcmVfcmVhZCh1bmNvcmUsIFBXUkNUWF9NQVhDTlRfVkNTVU5JVDApICYgSURMRV9USU1FX01B
U0spID4gMSAmJgorCSAgICAgIChpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIFBXUkNUWF9NQVhD
TlRfQkNTVU5JVCkgJiBJRExFX1RJTUVfTUFTSykgPiAxICYmCisJICAgICAgKGludGVsX3VuY29y
ZV9yZWFkKHVuY29yZSwgUFdSQ1RYX01BWENOVF9WRUNTVU5JVCkgJiBJRExFX1RJTUVfTUFTSykg
PiAxKSkgeworCQlEUk1fREVCVUdfRFJJVkVSKCJFbmdpbmUgSWRsZSB3YWl0IHRpbWUgbm90IHNl
dCBwcm9wZXJseS5cbiIpOworCQllbmFibGVfcmM2ID0gZmFsc2U7CisJfQorCisJaWYgKCFpbnRl
bF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjhfUFVTSEJVU19DT05UUk9MKSB8fAorCSAgICAhaW50
ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU44X1BVU0hCVVNfRU5BQkxFKSB8fAorCSAgICAhaW50
ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU44X1BVU0hCVVNfU0hJRlQpKSB7CisJCURSTV9ERUJV
R19EUklWRVIoIlB1c2hidXMgbm90IHNldHVwIHByb3Blcmx5LlxuIik7CisJCWVuYWJsZV9yYzYg
PSBmYWxzZTsKKwl9CisKKwlpZiAoIWludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VONl9HRlhQ
QVVTRSkpIHsKKwkJRFJNX0RFQlVHX0RSSVZFUigiR0ZYIHBhdXNlIG5vdCBzZXR1cCBwcm9wZXJs
eS5cbiIpOworCQllbmFibGVfcmM2ID0gZmFsc2U7CisJfQorCisJaWYgKCFpbnRlbF91bmNvcmVf
cmVhZCh1bmNvcmUsIEdFTjhfTUlTQ19DVFJMMCkpIHsKKwkJRFJNX0RFQlVHX0RSSVZFUigiR1BN
IGNvbnRyb2wgbm90IHNldHVwIHByb3Blcmx5LlxuIik7CisJCWVuYWJsZV9yYzYgPSBmYWxzZTsK
Kwl9CisKKwlyZXR1cm4gZW5hYmxlX3JjNjsKK30KKwordm9pZCBpbnRlbF9yYzZfZW5hYmxlKHN0
cnVjdCBpbnRlbF9yYzYgKnJjNikKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHJjNl90b19pOTE1KHJjNik7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gcmM2X3Rv
X3VuY29yZShyYzYpOworCisJaWYgKElTX0dFTjlfTFAoaTkxNSkgJiYgIWJ4dF9jaGVja19iaW9z
X3JjNl9zZXR1cChyYzYpKSB7CisJCURSTV9JTkZPKCJSQzYgYW5kIHBvd2Vyc2F2aW5nIGRpc2Fi
bGVkIGJ5IEJJT1NcbiIpOworCQlwbV9ydW50aW1lX2dldCgmaTkxNS0+ZHJtLnBkZXYtPmRldik7
CisJCXJldHVybjsKKwl9CisKKwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCh1bmNvcmUsIEZP
UkNFV0FLRV9BTEwpOworCisJaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpCisJCWNodl9yYzZfZW5h
YmxlKHJjNik7CisJZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSkKKwkJdmx2X3JjNl9lbmFi
bGUocmM2KTsKKwllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpCisJCWdlbjExX3JjNl9l
bmFibGUocmM2KTsKKwllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkKKwkJZ2VuOV9yYzZf
ZW5hYmxlKHJjNik7CisJZWxzZSBpZiAoSVNfQlJPQURXRUxMKGk5MTUpKQorCQlnZW44X3JjNl9l
bmFibGUocmM2KTsKKwllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNikKKwkJZ2VuNl9yYzZf
ZW5hYmxlKHJjNik7CisKKwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCh1bmNvcmUsIEZPUkNF
V0FLRV9BTEwpOworCisJcmM2LT5lbmFibGVkID0gdHJ1ZTsKK30KKwordm9pZCBpbnRlbF9yYzZf
ZGlzYWJsZShzdHJ1Y3QgaW50ZWxfcmM2ICpyYzYpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSByYzZfdG9faTkxNShyYzYpOworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29y
ZSA9IHJjNl90b191bmNvcmUocmM2KTsKKworCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA2KQorCQly
ZXR1cm47CisKKwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCh1bmNvcmUsIEZPUkNFV0FLRV9B
TEwpOworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUkNfQ09OVFJPTCwgMCk7
CisJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQorCQlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5j
b3JlLCBHRU45X1BHX0VOQUJMRSwgMCk7CisJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQodW5j
b3JlLCBGT1JDRVdBS0VfQUxMKTsKKworCXJjNi0+ZW5hYmxlZCA9IGZhbHNlOworfQorCit2b2lk
IGludGVsX3JjNl9maW5pKHN0cnVjdCBpbnRlbF9yYzYgKnJjNikKK3sKKwlzdHJ1Y3QgZHJtX2k5
MTVfZ2VtX29iamVjdCAqcGN0eDsKKworCXBjdHggPSBmZXRjaF9hbmRfemVybygmcmM2LT5wY3R4
KTsKKwlpZiAocGN0eCkKKwkJaTkxNV9nZW1fb2JqZWN0X3B1dChwY3R4KTsKK30KKworc3RhdGlj
IHU2NCB2bHZfcmVzaWRlbmN5X3JhdyhzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUsIGNvbnN0
IGk5MTVfcmVnX3QgcmVnKQoreworCXUzMiBsb3dlciwgdXBwZXIsIHRtcDsKKwlpbnQgbG9vcCA9
IDI7CisKKwkvKgorCSAqIFRoZSByZWdpc3RlciBhY2Nlc3NlZCBkbyBub3QgbmVlZCBmb3JjZXdh
a2UuIFdlIGJvcnJvdworCSAqIHVuY29yZSBsb2NrIHRvIHByZXZlbnQgY29uY3VycmVudCBhY2Nl
c3MgdG8gcmFuZ2UgcmVnLgorCSAqLworCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJnVuY29yZS0+bG9j
ayk7CisKKwkvKgorCSAqIHZsdiBhbmQgY2h2IHJlc2lkZW5jeSBjb3VudGVycyBhcmUgNDAgYml0
cyBpbiB3aWR0aC4KKwkgKiBXaXRoIGEgY29udHJvbCBiaXQsIHdlIGNhbiBjaG9vc2UgYmV0d2Vl
biB1cHBlciBvciBsb3dlcgorCSAqIDMyYml0IHdpbmRvdyBpbnRvIHRoaXMgY291bnRlci4KKwkg
KgorCSAqIEFsdGhvdWdoIHdlIGFsd2F5cyB1c2UgdGhlIGNvdW50ZXIgaW4gaGlnaC1yYW5nZSBt
b2RlIGVsc2V3aGVyZSwKKwkgKiB1c2Vyc3BhY2UgbWF5IGF0dGVtcHQgdG8gcmVhZCB0aGUgdmFs
dWUgYmVmb3JlIHJjNiBpcyBpbml0aWFsaXNlZCwKKwkgKiBiZWZvcmUgd2UgaGF2ZSBzZXQgdGhl
IGRlZmF1bHQgVkxWX0NPVU5URVJfQ09OVFJPTCB2YWx1ZS4gU28gYWx3YXlzCisJICogc2V0IHRo
ZSBoaWdoIGJpdCB0byBiZSBzYWZlLgorCSAqLworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNv
cmUsIFZMVl9DT1VOVEVSX0NPTlRST0wsCisJCQkgICAgICBfTUFTS0VEX0JJVF9FTkFCTEUoVkxW
X0NPVU5UX1JBTkdFX0hJR0gpKTsKKwl1cHBlciA9IGludGVsX3VuY29yZV9yZWFkX2Z3KHVuY29y
ZSwgcmVnKTsKKwlkbyB7CisJCXRtcCA9IHVwcGVyOworCisJCWludGVsX3VuY29yZV93cml0ZV9m
dyh1bmNvcmUsIFZMVl9DT1VOVEVSX0NPTlRST0wsCisJCQkJICAgICAgX01BU0tFRF9CSVRfRElT
QUJMRShWTFZfQ09VTlRfUkFOR0VfSElHSCkpOworCQlsb3dlciA9IGludGVsX3VuY29yZV9yZWFk
X2Z3KHVuY29yZSwgcmVnKTsKKworCQlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBWTFZf
Q09VTlRFUl9DT05UUk9MLAorCQkJCSAgICAgIF9NQVNLRURfQklUX0VOQUJMRShWTFZfQ09VTlRf
UkFOR0VfSElHSCkpOworCQl1cHBlciA9IGludGVsX3VuY29yZV9yZWFkX2Z3KHVuY29yZSwgcmVn
KTsKKwl9IHdoaWxlICh1cHBlciAhPSB0bXAgJiYgLS1sb29wKTsKKworCS8qCisJICogRXZlcnl3
aGVyZSBlbHNlIHdlIGFsd2F5cyB1c2UgVkxWX0NPVU5URVJfQ09OVFJPTCB3aXRoIHRoZQorCSAq
IFZMVl9DT1VOVF9SQU5HRV9ISUdIIGJpdCBzZXQgLSBzbyBpdCBpcyBzYWZlIHRvIGxlYXZlIGl0
IHNldAorCSAqIG5vdy4KKwkgKi8KKworCXJldHVybiBsb3dlciB8ICh1NjQpdXBwZXIgPDwgODsK
K30KKwordTY0IGludGVsX3JjNl9yZXNpZGVuY3lfbnMoc3RydWN0IGludGVsX3JjNiAqcmM2LCBj
b25zdCBpOTE1X3JlZ190IHJlZykKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHJjNl90b19pOTE1KHJjNik7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gcmM2X3Rv
X3VuY29yZShyYzYpOworCXU2NCB0aW1lX2h3LCBwcmV2X2h3LCBvdmVyZmxvd19odzsKKwl1bnNp
Z25lZCBpbnQgZndfZG9tYWluczsKKwl1bnNpZ25lZCBsb25nIGZsYWdzOworCXVuc2lnbmVkIGlu
dCBpOworCXUzMiBtdWwsIGRpdjsKKworCWlmICghcmM2LT5lbmFibGVkKQorCQlyZXR1cm4gMDsK
KworCS8qCisJICogU3RvcmUgcHJldmlvdXMgaHcgY291bnRlciB2YWx1ZXMgZm9yIGNvdW50ZXIg
d3JhcC1hcm91bmQgaGFuZGxpbmcuCisJICoKKwkgKiBUaGVyZSBhcmUgb25seSBmb3VyIGludGVy
ZXN0aW5nIHJlZ2lzdGVycyBhbmQgdGhleSBsaXZlIG5leHQgdG8gZWFjaAorCSAqIG90aGVyIHNv
IHdlIGNhbiB1c2UgdGhlIHJlbGF0aXZlIGFkZHJlc3MsIGNvbXBhcmVkIHRvIHRoZSBzbWFsbGVz
dAorCSAqIG9uZSBhcyB0aGUgaW5kZXggaW50byBkcml2ZXIgc3RvcmFnZS4KKwkgKi8KKwlpID0g
KGk5MTVfbW1pb19yZWdfb2Zmc2V0KHJlZykgLQorCSAgICAgaTkxNV9tbWlvX3JlZ19vZmZzZXQo
R0VONl9HVF9HRlhfUkM2X0xPQ0tFRCkpIC8gc2l6ZW9mKHUzMik7CisJaWYgKFdBUk5fT05fT05D
RShpID49IEFSUkFZX1NJWkUocmM2LT5jdXJfcmVzaWRlbmN5KSkpCisJCXJldHVybiAwOworCisJ
ZndfZG9tYWlucyA9IGludGVsX3VuY29yZV9mb3JjZXdha2VfZm9yX3JlZyh1bmNvcmUsIHJlZywg
RldfUkVHX1JFQUQpOworCisJc3Bpbl9sb2NrX2lycXNhdmUoJnVuY29yZS0+bG9jaywgZmxhZ3Mp
OworCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0X19sb2NrZWQodW5jb3JlLCBmd19kb21haW5z
KTsKKworCS8qIE9uIFZMViBhbmQgQ0hWLCByZXNpZGVuY3kgdGltZSBpcyBpbiBDWiB1bml0cyBy
YXRoZXIgdGhhbiAxLjI4dXMgKi8KKwlpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVS
UllWSUVXKGk5MTUpKSB7CisJCW11bCA9IDEwMDAwMDA7CisJCWRpdiA9IGk5MTUtPmN6Y2xrX2Zy
ZXE7CisJCW92ZXJmbG93X2h3ID0gQklUX1VMTCg0MCk7CisJCXRpbWVfaHcgPSB2bHZfcmVzaWRl
bmN5X3Jhdyh1bmNvcmUsIHJlZyk7CisJfSBlbHNlIHsKKwkJLyogODMzLjMzbnMgdW5pdHMgb24g
R2VuOUxQLCAxLjI4dXMgZWxzZXdoZXJlLiAqLworCQlpZiAoSVNfR0VOOV9MUChpOTE1KSkgewor
CQkJbXVsID0gMTAwMDA7CisJCQlkaXYgPSAxMjsKKwkJfSBlbHNlIHsKKwkJCW11bCA9IDEyODA7
CisJCQlkaXYgPSAxOworCQl9CisKKwkJb3ZlcmZsb3dfaHcgPSBCSVRfVUxMKDMyKTsKKwkJdGlt
ZV9odyA9IGludGVsX3VuY29yZV9yZWFkX2Z3KHVuY29yZSwgcmVnKTsKKwl9CisKKwkvKgorCSAq
IENvdW50ZXIgd3JhcCBoYW5kbGluZy4KKwkgKgorCSAqIEJ1dCByZWx5aW5nIG9uIGEgc3VmZmlj
aWVudCBmcmVxdWVuY3kgb2YgcXVlcmllcyBvdGhlcndpc2UgY291bnRlcnMKKwkgKiBjYW4gc3Rp
bGwgd3JhcC4KKwkgKi8KKwlwcmV2X2h3ID0gcmM2LT5wcmV2X2h3X3Jlc2lkZW5jeVtpXTsKKwly
YzYtPnByZXZfaHdfcmVzaWRlbmN5W2ldID0gdGltZV9odzsKKworCS8qIFJDNiBkZWx0YSBmcm9t
IGxhc3Qgc2FtcGxlLiAqLworCWlmICh0aW1lX2h3ID49IHByZXZfaHcpCisJCXRpbWVfaHcgLT0g
cHJldl9odzsKKwllbHNlCisJCXRpbWVfaHcgKz0gb3ZlcmZsb3dfaHcgLSBwcmV2X2h3OworCisJ
LyogQWRkIGRlbHRhIHRvIFJDNiBleHRlbmRlZCByYXcgZHJpdmVyIGNvcHkuICovCisJdGltZV9o
dyArPSByYzYtPmN1cl9yZXNpZGVuY3lbaV07CisJcmM2LT5jdXJfcmVzaWRlbmN5W2ldID0gdGlt
ZV9odzsKKworCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0X19sb2NrZWQodW5jb3JlLCBmd19k
b21haW5zKTsKKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZ1bmNvcmUtPmxvY2ssIGZsYWdzKTsK
KworCXJldHVybiBtdWxfdTY0X3UzMl9kaXYodGltZV9odywgbXVsLCBkaXYpOworfQorCit1NjQg
aW50ZWxfcmM2X3Jlc2lkZW5jeV91cyhzdHJ1Y3QgaW50ZWxfcmM2ICpyYzYsIGk5MTVfcmVnX3Qg
cmVnKQoreworCXJldHVybiBESVZfUk9VTkRfVVBfVUxMKGludGVsX3JjNl9yZXNpZGVuY3lfbnMo
cmM2LCByZWcpLCAxMDAwKTsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX3JjNi5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmM2LmgKbmV3IGZp
bGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5jYWE3ZTEwZTkwNjcKLS0tIC9kZXYv
bnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yYzYuaApAQCAtMCwwICsx
LDI0IEBACisvKgorICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAorICoKKyAqIENvcHly
aWdodCDCqSAyMDE5IEludGVsIENvcnBvcmF0aW9uCisgKi8KKworI2lmbmRlZiBJTlRFTF9SQzZf
SAorI2RlZmluZSBJTlRFTF9SQzZfSAorCisjaW5jbHVkZSAiaTkxNV9yZWcuaCIKKworc3RydWN0
IGludGVsX2VuZ2luZV9jczsKK3N0cnVjdCBpbnRlbF9yYzY7CisKK3ZvaWQgaW50ZWxfcmM2X2lu
aXQoc3RydWN0IGludGVsX3JjNiAqcmM2KTsKK3ZvaWQgaW50ZWxfcmM2X2Zpbmkoc3RydWN0IGlu
dGVsX3JjNiAqcmM2KTsKKwordm9pZCBpbnRlbF9yYzZfZW5hYmxlKHN0cnVjdCBpbnRlbF9yYzYg
KnJjNik7Cit2b2lkIGludGVsX3JjNl9kaXNhYmxlKHN0cnVjdCBpbnRlbF9yYzYgKnJjNik7CisK
K3U2NCBpbnRlbF9yYzZfcmVzaWRlbmN5X25zKHN0cnVjdCBpbnRlbF9yYzYgKnJjNiwgaTkxNV9y
ZWdfdCByZWcpOwordTY0IGludGVsX3JjNl9yZXNpZGVuY3lfdXMoc3RydWN0IGludGVsX3JjNiAq
cmM2LCBpOTE1X3JlZ190IHJlZyk7CisKKyNlbmRpZiAvKiBJTlRFTF9SQzZfSCAqLwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmM2X3R5cGVzLmggYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yYzZfdHlwZXMuaApuZXcgZmlsZSBtb2RlIDEwMDY0NApp
bmRleCAwMDAwMDAwMDAwMDAuLjM1ZTdlMTVjNmFmZgotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JjNl90eXBlcy5oCkBAIC0wLDAgKzEsMjYgQEAKKy8q
CisgKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCisgKgorICogQ29weXJpZ2h0IMKpIDIw
MTkgSW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisjaWZuZGVmIElOVEVMX1JDNl9UWVBFU19ICisj
ZGVmaW5lIElOVEVMX1JDNl9UWVBFU19ICisKKyNpbmNsdWRlIDxsaW51eC9zcGlubG9jay5oPgor
I2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CisKKyNpbmNsdWRlICJpbnRlbF9lbmdpbmVfdHlwZXMu
aCIKKworc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Q7CisKK3N0cnVjdCBpbnRlbF9yYzYgewor
CWJvb2wgZW5hYmxlZDsKKworCXU2NCBwcmV2X2h3X3Jlc2lkZW5jeVs0XTsKKwl1NjQgY3VyX3Jl
c2lkZW5jeVs0XTsKKworCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpwY3R4OworfTsKKwor
I2VuZGlmIC8qIElOVEVMX1JDNl9UWVBFU19IICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2RlYnVnZnMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdm
cy5jCmluZGV4IDQzZGI1MDA5NTI1Ny4uOTdhNjFkNDhiZjAxIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2RlYnVnZnMuYwpAQCAtNDIsNiArNDIsNyBAQAogI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9j
b250ZXh0LmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfZ3RfcG0uaCIKICNpbmNsdWRlICJndC9pbnRl
bF9yZXNldC5oIgorI2luY2x1ZGUgImd0L2ludGVsX3JjNi5oIgogI2luY2x1ZGUgImd0L3VjL2lu
dGVsX2d1Y19zdWJtaXNzaW9uLmgiCiAKICNpbmNsdWRlICJpOTE1X2RlYnVnZnMuaCIKQEAgLTEx
NjgsMTEgKzExNjksMTMgQEAgc3RhdGljIHZvaWQgcHJpbnRfcmM2X3JlcyhzdHJ1Y3Qgc2VxX2Zp
bGUgKm0sCiAJCQkgIGNvbnN0IGNoYXIgKnRpdGxlLAogCQkJICBjb25zdCBpOTE1X3JlZ190IHJl
ZykKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUo
bS0+cHJpdmF0ZSk7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5
MTUobS0+cHJpdmF0ZSk7CisJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7CiAKLQlzZXFfcHJpbnRm
KG0sICIlcyAldSAoJWxsdSB1cylcbiIsCi0JCSAgIHRpdGxlLCBJOTE1X1JFQUQocmVnKSwKLQkJ
ICAgaW50ZWxfcmM2X3Jlc2lkZW5jeV91cyhkZXZfcHJpdiwgcmVnKSk7CisJd2l0aF9pbnRlbF9y
dW50aW1lX3BtKCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKQorCQlzZXFfcHJpbnRmKG0sICIl
cyAldSAoJWxsdSB1cylcbiIsIHRpdGxlLAorCQkJICAgaW50ZWxfdW5jb3JlX3JlYWQoJmk5MTUt
PnVuY29yZSwgcmVnKSwKKwkJCSAgIGludGVsX3JjNl9yZXNpZGVuY3lfdXMoJmk5MTUtPmd0LnJj
NiwgcmVnKSk7CiB9CiAKIHN0YXRpYyBpbnQgdmx2X2RycGNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUg
Km0pCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAppbmRleCA0ZmFlYzJmOTRlMTkuLmY2MzRmMGFjY2Qx
OSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAorKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCkBAIC01OTgsMTkgKzU5OCwxMiBAQCBzdHJ1Y3Qg
aW50ZWxfcnBzIHsKIAlzdHJ1Y3QgaW50ZWxfcnBzX2VpIGVpOwogfTsKIAotc3RydWN0IGludGVs
X3JjNiB7Ci0JYm9vbCBlbmFibGVkOwotCXU2NCBwcmV2X2h3X3Jlc2lkZW5jeVs0XTsKLQl1NjQg
Y3VyX3Jlc2lkZW5jeVs0XTsKLX07Ci0KIHN0cnVjdCBpbnRlbF9sbGNfcHN0YXRlIHsKIAlib29s
IGVuYWJsZWQ7CiB9OwogCiBzdHJ1Y3QgaW50ZWxfZ2VuNl9wb3dlcl9tZ210IHsKIAlzdHJ1Y3Qg
aW50ZWxfcnBzIHJwczsKLQlzdHJ1Y3QgaW50ZWxfcmM2IHJjNjsKIAlzdHJ1Y3QgaW50ZWxfbGxj
X3BzdGF0ZSBsbGNfcHN0YXRlOwogfTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9wbXUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11LmMKaW5kZXggMzMx
MDM1Mzg5MGZiLi5kMDUwODcxOTQ5MmUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfcG11LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wbXUuYwpAQCAtMTEs
NiArMTEsNyBAQAogI2luY2x1ZGUgImd0L2ludGVsX2VuZ2luZV9wbS5oIgogI2luY2x1ZGUgImd0
L2ludGVsX2VuZ2luZV91c2VyLmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfZ3RfcG0uaCIKKyNpbmNs
dWRlICJndC9pbnRlbF9yYzYuaCIKIAogI2luY2x1ZGUgImk5MTVfZHJ2LmgiCiAjaW5jbHVkZSAi
aTkxNV9wbXUuaCIKQEAgLTExNiwyMSArMTE3LDIxIEBAIHN0YXRpYyBib29sIHBtdV9uZWVkc190
aW1lcihzdHJ1Y3QgaTkxNV9wbXUgKnBtdSwgYm9vbCBncHVfYWN0aXZlKQogCXJldHVybiBlbmFi
bGU7CiB9CiAKLXN0YXRpYyB1NjQgX19nZXRfcmM2KGNvbnN0IHN0cnVjdCBpbnRlbF9ndCAqZ3Qp
CitzdGF0aWMgdTY0IF9fZ2V0X3JjNihzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewogCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3QtPmk5MTU7CiAJdTY0IHZhbDsKIAotCXZhbCA9IGlu
dGVsX3JjNl9yZXNpZGVuY3lfbnMoaTkxNSwKKwl2YWwgPSBpbnRlbF9yYzZfcmVzaWRlbmN5X25z
KCZndC0+cmM2LAogCQkJCSAgICAgSVNfVkFMTEVZVklFVyhpOTE1KSA/CiAJCQkJICAgICBWTFZf
R1RfUkVOREVSX1JDNiA6CiAJCQkJICAgICBHRU42X0dUX0dGWF9SQzYpOwogCiAJaWYgKEhBU19S
QzZwKGk5MTUpKQotCQl2YWwgKz0gaW50ZWxfcmM2X3Jlc2lkZW5jeV9ucyhpOTE1LCBHRU42X0dU
X0dGWF9SQzZwKTsKKwkJdmFsICs9IGludGVsX3JjNl9yZXNpZGVuY3lfbnMoJmd0LT5yYzYsIEdF
TjZfR1RfR0ZYX1JDNnApOwogCiAJaWYgKEhBU19SQzZwcChpOTE1KSkKLQkJdmFsICs9IGludGVs
X3JjNl9yZXNpZGVuY3lfbnMoaTkxNSwgR0VONl9HVF9HRlhfUkM2cHApOworCQl2YWwgKz0gaW50
ZWxfcmM2X3Jlc2lkZW5jeV9ucygmZ3QtPnJjNiwgR0VONl9HVF9HRlhfUkM2cHApOwogCiAJcmV0
dXJuIHZhbDsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc3lzZnMu
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc3lzZnMuYwppbmRleCBkOGEzYjE4MGMwODQu
LjAzNGI4YWJjNTA2MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zeXNm
cy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc3lzZnMuYwpAQCAtMzAsNiArMzAs
OCBAQAogI2luY2x1ZGUgPGxpbnV4L3N0YXQuaD4KICNpbmNsdWRlIDxsaW51eC9zeXNmcy5oPgog
CisjaW5jbHVkZSAiZ3QvaW50ZWxfcmM2LmgiCisKICNpbmNsdWRlICJpOTE1X2Rydi5oIgogI2lu
Y2x1ZGUgImk5MTVfc3lzZnMuaCIKICNpbmNsdWRlICJpbnRlbF9wbS5oIgpAQCAtNDksNyArNTEs
NyBAQCBzdGF0aWMgdTMyIGNhbGNfcmVzaWRlbmN5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKIAl1NjQgcmVzID0gMDsKIAogCXdpdGhfaW50ZWxfcnVudGltZV9wbSgmZGV2X3By
aXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpCi0JCXJlcyA9IGludGVsX3JjNl9yZXNpZGVuY3lfdXMo
ZGV2X3ByaXYsIHJlZyk7CisJCXJlcyA9IGludGVsX3JjNl9yZXNpZGVuY3lfdXMoJmRldl9wcml2
LT5ndC5yYzYsIHJlZyk7CiAKIAlyZXR1cm4gRElWX1JPVU5EX0NMT1NFU1RfVUxMKHJlcywgMTAw
MCk7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYwppbmRleCA2YWE0MGY1NDYyMjYuLjRiNDJiMWI4
MWQwMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5jCkBAIC0zOCw2ICszOCw4IEBACiAjaW5jbHVk
ZSAiZGlzcGxheS9pbnRlbF9mYmMuaCIKICNpbmNsdWRlICJkaXNwbGF5L2ludGVsX3Nwcml0ZS5o
IgogCisjaW5jbHVkZSAiZ3QvaW50ZWxfcmM2LmgiCisKICNpbmNsdWRlICJpOTE1X2Rydi5oIgog
I2luY2x1ZGUgImk5MTVfaXJxLmgiCiAjaW5jbHVkZSAiaTkxNV90cmFjZS5oIgpAQCAtNDUsMjYg
KzQ3LDYgQEAKICNpbmNsdWRlICJpbnRlbF9zaWRlYmFuZC5oIgogI2luY2x1ZGUgIi4uLy4uLy4u
L3BsYXRmb3JtL3g4Ni9pbnRlbF9pcHMuaCIKIAotLyoqCi0gKiBET0M6IFJDNgotICoKLSAqIFJD
NiBpcyBhIHNwZWNpYWwgcG93ZXIgc3RhZ2Ugd2hpY2ggYWxsb3dzIHRoZSBHUFUgdG8gZW50ZXIg
YW4gdmVyeQotICogbG93LXZvbHRhZ2UgbW9kZSB3aGVuIGlkbGUsIHVzaW5nIGRvd24gdG8gMFYg
d2hpbGUgYXQgdGhpcyBzdGFnZS4gIFRoaXMKLSAqIHN0YWdlIGlzIGVudGVyZWQgYXV0b21hdGlj
YWxseSB3aGVuIHRoZSBHUFUgaXMgaWRsZSB3aGVuIFJDNiBzdXBwb3J0IGlzCi0gKiBlbmFibGVk
LCBhbmQgYXMgc29vbiBhcyBuZXcgd29ya2xvYWQgYXJpc2VzIEdQVSB3YWtlcyB1cCBhdXRvbWF0
aWNhbGx5IGFzIHdlbGwuCi0gKgotICogVGhlcmUgYXJlIGRpZmZlcmVudCBSQzYgbW9kZXMgYXZh
aWxhYmxlIGluIEludGVsIEdQVSwgd2hpY2ggZGlmZmVyZW50aWF0ZQotICogYW1vbmcgZWFjaCBv
dGhlciB3aXRoIHRoZSBsYXRlbmN5IHJlcXVpcmVkIHRvIGVudGVyIGFuZCBsZWF2ZSBSQzYgYW5k
Ci0gKiB2b2x0YWdlIGNvbnN1bWVkIGJ5IHRoZSBHUFUgaW4gZGlmZmVyZW50IHN0YXRlcy4KLSAq
Ci0gKiBUaGUgY29tYmluYXRpb24gb2YgdGhlIGZvbGxvd2luZyBmbGFncyBkZWZpbmUgd2hpY2gg
c3RhdGVzIEdQVSBpcyBhbGxvd2VkCi0gKiB0byBlbnRlciwgd2hpbGUgUkM2IGlzIHRoZSBub3Jt
YWwgUkM2IHN0YXRlLCBSQzZwIGlzIHRoZSBkZWVwIFJDNiwgYW5kCi0gKiBSQzZwcCBpcyBkZWVw
ZXN0IFJDNi4gVGhlaXIgc3VwcG9ydCBieSBoYXJkd2FyZSB2YXJpZXMgYWNjb3JkaW5nIHRvIHRo
ZQotICogR1BVLCBCSU9TLCBjaGlwc2V0IGFuZCBwbGF0Zm9ybS4gUkM2IGlzIHVzdWFsbHkgdGhl
IHNhZmVzdCBvbmUgYW5kIHRoZSBvbmUKLSAqIHdoaWNoIGJyaW5ncyB0aGUgbW9zdCBwb3dlciBz
YXZpbmdzOyBkZWVwZXIgc3RhdGVzIHNhdmUgbW9yZSBwb3dlciwgYnV0Ci0gKiByZXF1aXJlIGhp
Z2hlciBsYXRlbmN5IHRvIHN3aXRjaCB0byBhbmQgd2FrZSB1cC4KLSAqLwotCiBzdGF0aWMgdm9p
ZCBnZW45X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKIHsKIAlpZiAoSEFTX0xMQyhkZXZfcHJpdikpIHsKQEAgLTY5MTgsNDkgKzY5MDAsMjIgQEAg
aW50IGludGVsX3NldF9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1OCB2
YWwpCiAJcmV0dXJuIGVycjsKIH0KIAotc3RhdGljIHZvaWQgZ2VuOV9kaXNhYmxlX3JjNihzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JSTkxNV9XUklURShHRU42X1JDX0NP
TlRST0wsIDApOwotCUk5MTVfV1JJVEUoR0VOOV9QR19FTkFCTEUsIDApOwotfQotCiBzdGF0aWMg
dm9pZCBnZW45X2Rpc2FibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
IHsKIAlJOTE1X1dSSVRFKEdFTjZfUlBfQ09OVFJPTCwgMCk7CiB9CiAKLXN0YXRpYyB2b2lkIGdl
bjZfZGlzYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCUk5
MTVfV1JJVEUoR0VONl9SQ19DT05UUk9MLCAwKTsKLX0KLQogc3RhdGljIHZvaWQgZ2VuNl9kaXNh
YmxlX3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7CiAJSTkxNV9XUklU
RShHRU42X1JQTlNXUkVRLCAxIDw8IDMxKTsKIAlJOTE1X1dSSVRFKEdFTjZfUlBfQ09OVFJPTCwg
MCk7CiB9CiAKLXN0YXRpYyB2b2lkIGNoZXJyeXZpZXdfZGlzYWJsZV9yYzYoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCUk5MTVfV1JJVEUoR0VONl9SQ19DT05UUk9MLCAw
KTsKLX0KLQogc3RhdGljIHZvaWQgY2hlcnJ5dmlld19kaXNhYmxlX3JwcyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7CiAJSTkxNV9XUklURShHRU42X1JQX0NPTlRST0wsIDAp
OwogfQogCi1zdGF0aWMgdm9pZCB2YWxsZXl2aWV3X2Rpc2FibGVfcmM2KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQkvKiBXZSdyZSBkb2luZyBmb3JjZXdha2UgYmVmb3Jl
IERpc2FibGluZyBSQzYsCi0JICogVGhpcyB3aGF0IHRoZSBCSU9TIGV4cGVjdHMgd2hlbiBnb2lu
ZyBpbnRvIHN1c3BlbmQgKi8KLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYt
PnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Ci0KLQlJOTE1X1dSSVRFKEdFTjZfUkNfQ09OVFJPTCwg
MCk7Ci0KLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9S
Q0VXQUtFX0FMTCk7Ci19Ci0KIHN0YXRpYyB2b2lkIHZhbGxleXZpZXdfZGlzYWJsZV9ycHMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewogCUk5MTVfV1JJVEUoR0VONl9SUF9D
T05UUk9MLCAwKTsKQEAgLTcxNDAsMjAzICs3MDk1LDYgQEAgc3RhdGljIHZvaWQgZ2VuOV9lbmFi
bGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlpbnRlbF91bmNvcmVf
Zm9yY2V3YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7CiB9CiAKLXN0
YXRpYyB2b2lkIGdlbjExX2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQotewotCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKLQllbnVtIGludGVsX2Vu
Z2luZV9pZCBpZDsKLQotCS8qIDFhOiBTb2Z0d2FyZSBSQyBzdGF0ZSAtIFJDMCAqLwotCUk5MTVf
V1JJVEUoR0VONl9SQ19TVEFURSwgMCk7Ci0KLQkvKgotCSAqIDFiOiBHZXQgZm9yY2V3YWtlIGR1
cmluZyBwcm9ncmFtIHNlcXVlbmNlLiBBbHRob3VnaCB0aGUgZHJpdmVyCi0JICogaGFzbid0IGVu
YWJsZWQgYSBzdGF0ZSB5ZXQgd2hlcmUgd2UgbmVlZCBmb3JjZXdha2UsIEJJT1MgbWF5IGhhdmUu
Ci0JICovCi0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUsIEZP
UkNFV0FLRV9BTEwpOwotCi0JLyogMmE6IERpc2FibGUgUkMgc3RhdGVzLiAqLwotCUk5MTVfV1JJ
VEUoR0VONl9SQ19DT05UUk9MLCAwKTsKLQotCS8qIDJiOiBQcm9ncmFtIFJDNiB0aHJlc2hvbGRz
LiovCi0JSTkxNV9XUklURShHRU42X1JDNl9XQUtFX1JBVEVfTElNSVQsIDU0IDw8IDE2IHwgODUp
OwotCUk5MTVfV1JJVEUoR0VOMTBfTUVESUFfV0FLRV9SQVRFX0xJTUlULCAxNTApOwotCi0JSTkx
NV9XUklURShHRU42X1JDX0VWQUxVQVRJT05fSU5URVJWQUwsIDEyNTAwMCk7IC8qIDEyNTAwICog
MTI4MG5zICovCi0JSTkxNV9XUklURShHRU42X1JDX0lETEVfSFlTVEVSU0lTLCAyNSk7IC8qIDI1
ICogMTI4MG5zICovCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYsIGlkKQotCQlJ
OTE1X1dSSVRFKFJJTkdfTUFYX0lETEUoZW5naW5lLT5tbWlvX2Jhc2UpLCAxMCk7Ci0KLQlpZiAo
SEFTX0dUX1VDKGRldl9wcml2KSkKLQkJSTkxNV9XUklURShHVUNfTUFYX0lETEVfQ09VTlQsIDB4
QSk7Ci0KLQlJOTE1X1dSSVRFKEdFTjZfUkNfU0xFRVAsIDApOwotCi0JSTkxNV9XUklURShHRU42
X1JDNl9USFJFU0hPTEQsIDUwMDAwKTsgLyogNTAvMTI1bXMgcGVyIEVJICovCi0KLQkvKgotCSAq
IDJjOiBQcm9ncmFtIENvYXJzZSBQb3dlciBHYXRpbmcgUG9saWNpZXMuCi0JICoKLQkgKiBCc3Bl
YydzIGd1aWRhbmNlIGlzIHRvIHVzZSAyNXVzIChyZWFsbHkgMjUgKiAxMjgwbnMpIGhlcmUuIFdo
YXQgd2UKLQkgKiB1c2UgaW5zdGVhZCBpcyBhIG1vcmUgY29uc2VydmF0aXZlIGVzdGltYXRlIGZv
ciB0aGUgbWF4aW11bSB0aW1lCi0JICogaXQgdGFrZXMgdXMgdG8gc2VydmljZSBhIENTIGludGVy
cnVwdCBhbmQgc3VibWl0IGEgbmV3IEVMU1AgLSB0aGF0Ci0JICogaXMgdGhlIHRpbWUgd2hpY2gg
dGhlIEdQVSBpcyBpZGxlIHdhaXRpbmcgZm9yIHRoZSBDUFUgdG8gc2VsZWN0IHRoZQotCSAqIG5l
eHQgcmVxdWVzdCB0byBleGVjdXRlLiBJZiB0aGUgaWRsZSBoeXN0ZXJlc2lzIGlzIGxlc3MgdGhh
biB0aGF0Ci0JICogaW50ZXJydXB0IHNlcnZpY2UgbGF0ZW5jeSwgdGhlIGhhcmR3YXJlIHdpbGwg
YXV0b21hdGljYWxseSBnYXRlCi0JICogdGhlIHBvd2VyIHdlbGwgYW5kIHdlIHdpbGwgdGhlbiBp
bmN1ciB0aGUgd2FrZSB1cCBjb3N0IG9uIHRvcCBvZgotCSAqIHRoZSBzZXJ2aWNlIGxhdGVuY3ku
IEEgc2ltaWxhciBndWlkZSBmcm9tIHBsYW5lX3N0YXRlIGlzIHRoYXQgd2UKLQkgKiBkbyBub3Qg
d2FudCB0aGUgZW5hYmxlIGh5c3RlcmVzaXMgdG8gbGVzcyB0aGFuIHRoZSB3YWtldXAgbGF0ZW5j
eS4KLQkgKgotCSAqIGlndC9nZW1fZXhlY19ub3Avc2VxdWVudGlhbCBwcm92aWRlcyBhIHJvdWdo
IGVzdGltYXRlIGZvciB0aGUKLQkgKiBzZXJ2aWNlIGxhdGVuY3ksIGFuZCBwdXRzIGl0IGFyb3Vu
ZCAxMHVzIGZvciBCcm9hZHdlbGwgKGFuZCBvdGhlcgotCSAqIGJpZyBjb3JlKSBhbmQgYXJvdW5k
IDQwdXMgZm9yIEJyb3h0b24gKGFuZCBvdGhlciBsb3cgcG93ZXIgY29yZXMpLgotCSAqIFtOb3Rl
IHRoYXQgZm9yIGxlZ2FjeSByaW5nYnVmZmVyIHN1Ym1pc3Npb24sIHRoaXMgaXMgbGVzcyB0aGFu
IDF1cyFdCi0JICogSG93ZXZlciwgdGhlIHdha2V1cCBsYXRlbmN5IG9uIEJyb3h0b24gaXMgY2xv
c2VyIHRvIDEwMHVzLiBUbyBiZQotCSAqIGNvbnNlcnZhdGl2ZSwgd2UgaGF2ZSB0byBmYWN0b3Ig
aW4gYSBjb250ZXh0IHN3aXRjaCBvbiB0b3AgKGR1ZQotCSAqIHRvIGtzb2Z0aXJxZCkuCi0JICov
Ci0JSTkxNV9XUklURShHRU45X01FRElBX1BHX0lETEVfSFlTVEVSRVNJUywgMjUwKTsKLQlJOTE1
X1dSSVRFKEdFTjlfUkVOREVSX1BHX0lETEVfSFlTVEVSRVNJUywgMjUwKTsKLQotCS8qIDNhOiBF
bmFibGUgUkM2ICovCi0JSTkxNV9XUklURShHRU42X1JDX0NPTlRST0wsCi0JCSAgIEdFTjZfUkNf
Q1RMX0hXX0VOQUJMRSB8Ci0JCSAgIEdFTjZfUkNfQ1RMX1JDNl9FTkFCTEUgfAotCQkgICBHRU42
X1JDX0NUTF9FSV9NT0RFKDEpKTsKLQotCS8qIDNiOiBFbmFibGUgQ29hcnNlIFBvd2VyIEdhdGlu
ZyBvbmx5IHdoZW4gUkM2IGlzIGVuYWJsZWQuICovCi0JSTkxNV9XUklURShHRU45X1BHX0VOQUJM
RSwKLQkJICAgR0VOOV9SRU5ERVJfUEdfRU5BQkxFIHwKLQkJICAgR0VOOV9NRURJQV9QR19FTkFC
TEUgfAotCQkgICBHRU4xMV9NRURJQV9TQU1QTEVSX1BHX0VOQUJMRSk7Ci0KLQlpbnRlbF91bmNv
cmVfZm9yY2V3YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Ci19Ci0K
LXN0YXRpYyB2b2lkIGdlbjlfZW5hYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCi17Ci0Jc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCWVudW0gaW50ZWxf
ZW5naW5lX2lkIGlkOwotCXUzMiByYzZfbW9kZTsKLQotCS8qIDFhOiBTb2Z0d2FyZSBSQyBzdGF0
ZSAtIFJDMCAqLwotCUk5MTVfV1JJVEUoR0VONl9SQ19TVEFURSwgMCk7Ci0KLQkvKiAxYjogR2V0
IGZvcmNld2FrZSBkdXJpbmcgcHJvZ3JhbSBzZXF1ZW5jZS4gQWx0aG91Z2ggdGhlIGRyaXZlcgot
CSAqIGhhc24ndCBlbmFibGVkIGEgc3RhdGUgeWV0IHdoZXJlIHdlIG5lZWQgZm9yY2V3YWtlLCBC
SU9TIG1heSBoYXZlLiovCi0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmRldl9wcml2LT51
bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotCi0JLyogMmE6IERpc2FibGUgUkMgc3RhdGVzLiAqLwot
CUk5MTVfV1JJVEUoR0VONl9SQ19DT05UUk9MLCAwKTsKLQotCS8qIDJiOiBQcm9ncmFtIFJDNiB0
aHJlc2hvbGRzLiovCi0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTApIHsKLQkJSTkxNV9X
UklURShHRU42X1JDNl9XQUtFX1JBVEVfTElNSVQsIDU0IDw8IDE2IHwgODUpOwotCQlJOTE1X1dS
SVRFKEdFTjEwX01FRElBX1dBS0VfUkFURV9MSU1JVCwgMTUwKTsKLQl9IGVsc2UgaWYgKElTX1NL
WUxBS0UoZGV2X3ByaXYpKSB7Ci0JCS8qCi0JCSAqIFdhUnNEb3VibGVSYzZXcmxXaXRoQ29hcnNl
UG93ZXJHYXRpbmc6c2tsIERvdWJsaW5nIFdSTCBvbmx5Ci0JCSAqIHdoZW4gQ1BHIGlzIGVuYWJs
ZWQKLQkJICovCi0JCUk5MTVfV1JJVEUoR0VONl9SQzZfV0FLRV9SQVRFX0xJTUlULCAxMDggPDwg
MTYpOwotCX0gZWxzZSB7Ci0JCUk5MTVfV1JJVEUoR0VONl9SQzZfV0FLRV9SQVRFX0xJTUlULCA1
NCA8PCAxNik7Ci0JfQotCi0JSTkxNV9XUklURShHRU42X1JDX0VWQUxVQVRJT05fSU5URVJWQUws
IDEyNTAwMCk7IC8qIDEyNTAwICogMTI4MG5zICovCi0JSTkxNV9XUklURShHRU42X1JDX0lETEVf
SFlTVEVSU0lTLCAyNSk7IC8qIDI1ICogMTI4MG5zICovCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2lu
ZSwgZGV2X3ByaXYsIGlkKQotCQlJOTE1X1dSSVRFKFJJTkdfTUFYX0lETEUoZW5naW5lLT5tbWlv
X2Jhc2UpLCAxMCk7Ci0KLQlpZiAoSEFTX0dUX1VDKGRldl9wcml2KSkKLQkJSTkxNV9XUklURShH
VUNfTUFYX0lETEVfQ09VTlQsIDB4QSk7Ci0KLQlJOTE1X1dSSVRFKEdFTjZfUkNfU0xFRVAsIDAp
OwotCi0JLyoKLQkgKiAyYzogUHJvZ3JhbSBDb2Fyc2UgUG93ZXIgR2F0aW5nIFBvbGljaWVzLgot
CSAqCi0JICogQnNwZWMncyBndWlkYW5jZSBpcyB0byB1c2UgMjV1cyAocmVhbGx5IDI1ICogMTI4
MG5zKSBoZXJlLiBXaGF0IHdlCi0JICogdXNlIGluc3RlYWQgaXMgYSBtb3JlIGNvbnNlcnZhdGl2
ZSBlc3RpbWF0ZSBmb3IgdGhlIG1heGltdW0gdGltZQotCSAqIGl0IHRha2VzIHVzIHRvIHNlcnZp
Y2UgYSBDUyBpbnRlcnJ1cHQgYW5kIHN1Ym1pdCBhIG5ldyBFTFNQIC0gdGhhdAotCSAqIGlzIHRo
ZSB0aW1lIHdoaWNoIHRoZSBHUFUgaXMgaWRsZSB3YWl0aW5nIGZvciB0aGUgQ1BVIHRvIHNlbGVj
dCB0aGUKLQkgKiBuZXh0IHJlcXVlc3QgdG8gZXhlY3V0ZS4gSWYgdGhlIGlkbGUgaHlzdGVyZXNp
cyBpcyBsZXNzIHRoYW4gdGhhdAotCSAqIGludGVycnVwdCBzZXJ2aWNlIGxhdGVuY3ksIHRoZSBo
YXJkd2FyZSB3aWxsIGF1dG9tYXRpY2FsbHkgZ2F0ZQotCSAqIHRoZSBwb3dlciB3ZWxsIGFuZCB3
ZSB3aWxsIHRoZW4gaW5jdXIgdGhlIHdha2UgdXAgY29zdCBvbiB0b3Agb2YKLQkgKiB0aGUgc2Vy
dmljZSBsYXRlbmN5LiBBIHNpbWlsYXIgZ3VpZGUgZnJvbSBwbGFuZV9zdGF0ZSBpcyB0aGF0IHdl
Ci0JICogZG8gbm90IHdhbnQgdGhlIGVuYWJsZSBoeXN0ZXJlc2lzIHRvIGxlc3MgdGhhbiB0aGUg
d2FrZXVwIGxhdGVuY3kuCi0JICoKLQkgKiBpZ3QvZ2VtX2V4ZWNfbm9wL3NlcXVlbnRpYWwgcHJv
dmlkZXMgYSByb3VnaCBlc3RpbWF0ZSBmb3IgdGhlCi0JICogc2VydmljZSBsYXRlbmN5LCBhbmQg
cHV0cyBpdCBhcm91bmQgMTB1cyBmb3IgQnJvYWR3ZWxsIChhbmQgb3RoZXIKLQkgKiBiaWcgY29y
ZSkgYW5kIGFyb3VuZCA0MHVzIGZvciBCcm94dG9uIChhbmQgb3RoZXIgbG93IHBvd2VyIGNvcmVz
KS4KLQkgKiBbTm90ZSB0aGF0IGZvciBsZWdhY3kgcmluZ2J1ZmZlciBzdWJtaXNzaW9uLCB0aGlz
IGlzIGxlc3MgdGhhbiAxdXMhXQotCSAqIEhvd2V2ZXIsIHRoZSB3YWtldXAgbGF0ZW5jeSBvbiBC
cm94dG9uIGlzIGNsb3NlciB0byAxMDB1cy4gVG8gYmUKLQkgKiBjb25zZXJ2YXRpdmUsIHdlIGhh
dmUgdG8gZmFjdG9yIGluIGEgY29udGV4dCBzd2l0Y2ggb24gdG9wIChkdWUKLQkgKiB0byBrc29m
dGlycWQpLgotCSAqLwotCUk5MTVfV1JJVEUoR0VOOV9NRURJQV9QR19JRExFX0hZU1RFUkVTSVMs
IDI1MCk7Ci0JSTkxNV9XUklURShHRU45X1JFTkRFUl9QR19JRExFX0hZU1RFUkVTSVMsIDI1MCk7
Ci0KLQkvKiAzYTogRW5hYmxlIFJDNiAqLwotCUk5MTVfV1JJVEUoR0VONl9SQzZfVEhSRVNIT0xE
LCAzNzUwMCk7IC8qIDM3LjUvMTI1bXMgcGVyIEVJICovCi0KLQkvKiBXYVJzVXNlVGltZW91dE1v
ZGU6Y25sIChwcmUtcHJvZCkgKi8KLQlpZiAoSVNfQ05MX1JFVklEKGRldl9wcml2LCBDTkxfUkVW
SURfQTAsIENOTF9SRVZJRF9DMCkpCi0JCXJjNl9tb2RlID0gR0VON19SQ19DVExfVE9fTU9ERTsK
LQllbHNlCi0JCXJjNl9tb2RlID0gR0VONl9SQ19DVExfRUlfTU9ERSgxKTsKLQotCUk5MTVfV1JJ
VEUoR0VONl9SQ19DT05UUk9MLAotCQkgICBHRU42X1JDX0NUTF9IV19FTkFCTEUgfAotCQkgICBH
RU42X1JDX0NUTF9SQzZfRU5BQkxFIHwKLQkJICAgcmM2X21vZGUpOwotCi0JLyoKLQkgKiAzYjog
RW5hYmxlIENvYXJzZSBQb3dlciBHYXRpbmcgb25seSB3aGVuIFJDNiBpcyBlbmFibGVkLgotCSAq
IFdhUnNEaXNhYmxlQ29hcnNlUG93ZXJHYXRpbmc6c2tsLGNubCAtIFJlbmRlci9NZWRpYSBQRyBu
ZWVkIHRvIGJlIGRpc2FibGVkIHdpdGggUkM2LgotCSAqLwotCWlmIChORUVEU19XYVJzRGlzYWJs
ZUNvYXJzZVBvd2VyR2F0aW5nKGRldl9wcml2KSkKLQkJSTkxNV9XUklURShHRU45X1BHX0VOQUJM
RSwgMCk7Ci0JZWxzZQotCQlJOTE1X1dSSVRFKEdFTjlfUEdfRU5BQkxFLAotCQkJICAgR0VOOV9S
RU5ERVJfUEdfRU5BQkxFIHwgR0VOOV9NRURJQV9QR19FTkFCTEUpOwotCi0JaW50ZWxfdW5jb3Jl
X2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotfQotCi1z
dGF0aWMgdm9pZCBnZW44X2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQotewotCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKLQllbnVtIGludGVsX2Vu
Z2luZV9pZCBpZDsKLQotCS8qIDFhOiBTb2Z0d2FyZSBSQyBzdGF0ZSAtIFJDMCAqLwotCUk5MTVf
V1JJVEUoR0VONl9SQ19TVEFURSwgMCk7Ci0KLQkvKiAxYjogR2V0IGZvcmNld2FrZSBkdXJpbmcg
cHJvZ3JhbSBzZXF1ZW5jZS4gQWx0aG91Z2ggdGhlIGRyaXZlcgotCSAqIGhhc24ndCBlbmFibGVk
IGEgc3RhdGUgeWV0IHdoZXJlIHdlIG5lZWQgZm9yY2V3YWtlLCBCSU9TIG1heSBoYXZlLiovCi0J
aW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9B
TEwpOwotCi0JLyogMmE6IERpc2FibGUgUkMgc3RhdGVzLiAqLwotCUk5MTVfV1JJVEUoR0VONl9S
Q19DT05UUk9MLCAwKTsKLQotCS8qIDJiOiBQcm9ncmFtIFJDNiB0aHJlc2hvbGRzLiovCi0JSTkx
NV9XUklURShHRU42X1JDNl9XQUtFX1JBVEVfTElNSVQsIDQwIDw8IDE2KTsKLQlJOTE1X1dSSVRF
KEdFTjZfUkNfRVZBTFVBVElPTl9JTlRFUlZBTCwgMTI1MDAwKTsgLyogMTI1MDAgKiAxMjgwbnMg
Ki8KLQlJOTE1X1dSSVRFKEdFTjZfUkNfSURMRV9IWVNURVJTSVMsIDI1KTsgLyogMjUgKiAxMjgw
bnMgKi8KLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpCi0JCUk5MTVfV1JJ
VEUoUklOR19NQVhfSURMRShlbmdpbmUtPm1taW9fYmFzZSksIDEwKTsKLQlJOTE1X1dSSVRFKEdF
TjZfUkNfU0xFRVAsIDApOwotCUk5MTVfV1JJVEUoR0VONl9SQzZfVEhSRVNIT0xELCA2MjUpOyAv
KiA4MDB1cy8xLjI4IGZvciBUTyAqLwotCi0JLyogMzogRW5hYmxlIFJDNiAqLwotCi0JSTkxNV9X
UklURShHRU42X1JDX0NPTlRST0wsCi0JCSAgIEdFTjZfUkNfQ1RMX0hXX0VOQUJMRSB8Ci0JCSAg
IEdFTjdfUkNfQ1RMX1RPX01PREUgfAotCQkgICBHRU42X1JDX0NUTF9SQzZfRU5BQkxFKTsKLQot
CWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0Vf
QUxMKTsKLX0KLQogc3RhdGljIHZvaWQgZ2VuOF9lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKIHsKIAlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYt
Pmd0X3BtLnJwczsKQEAgLTczNzcsNzUgKzcxMzUsNiBAQCBzdGF0aWMgdm9pZCBnZW44X2VuYWJs
ZV9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCWludGVsX3VuY29yZV9m
b3JjZXdha2VfcHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKIH0KIAotc3Rh
dGljIHZvaWQgZ2VuNl9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKLXsKLQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0JZW51bSBpbnRlbF9lbmdp
bmVfaWQgaWQ7Ci0JdTMyIHJjNnZpZHMsIHJjNl9tYXNrOwotCXUzMiBndGZpZm9kYmc7Ci0JaW50
IHJldDsKLQotCUk5MTVfV1JJVEUoR0VONl9SQ19TVEFURSwgMCk7Ci0KLQkvKiBDbGVhciB0aGUg
REJHIG5vdyBzbyB3ZSBkb24ndCBjb25mdXNlIGVhcmxpZXIgZXJyb3JzICovCi0JZ3RmaWZvZGJn
ID0gSTkxNV9SRUFEKEdURklGT0RCRyk7Ci0JaWYgKGd0Zmlmb2RiZykgewotCQlEUk1fRVJST1Io
IkdUIGZpZm8gaGFkIGEgcHJldmlvdXMgZXJyb3IgJXhcbiIsIGd0Zmlmb2RiZyk7Ci0JCUk5MTVf
V1JJVEUoR1RGSUZPREJHLCBndGZpZm9kYmcpOwotCX0KLQotCWludGVsX3VuY29yZV9mb3JjZXdh
a2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKLQotCS8qIGRpc2FibGUg
dGhlIGNvdW50ZXJzIGFuZCBzZXQgZGV0ZXJtaW5pc3RpYyB0aHJlc2hvbGRzICovCi0JSTkxNV9X
UklURShHRU42X1JDX0NPTlRST0wsIDApOwotCi0JSTkxNV9XUklURShHRU42X1JDMV9XQUtFX1JB
VEVfTElNSVQsIDEwMDAgPDwgMTYpOwotCUk5MTVfV1JJVEUoR0VONl9SQzZfV0FLRV9SQVRFX0xJ
TUlULCA0MCA8PCAxNiB8IDMwKTsKLQlJOTE1X1dSSVRFKEdFTjZfUkM2cHBfV0FLRV9SQVRFX0xJ
TUlULCAzMCk7Ci0JSTkxNV9XUklURShHRU42X1JDX0VWQUxVQVRJT05fSU5URVJWQUwsIDEyNTAw
MCk7Ci0JSTkxNV9XUklURShHRU42X1JDX0lETEVfSFlTVEVSU0lTLCAyNSk7Ci0KLQlmb3JfZWFj
aF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpCi0JCUk5MTVfV1JJVEUoUklOR19NQVhfSURM
RShlbmdpbmUtPm1taW9fYmFzZSksIDEwKTsKLQotCUk5MTVfV1JJVEUoR0VONl9SQ19TTEVFUCwg
MCk7Ci0JSTkxNV9XUklURShHRU42X1JDMWVfVEhSRVNIT0xELCAxMDAwKTsKLQlpZiAoSVNfSVZZ
QlJJREdFKGRldl9wcml2KSkKLQkJSTkxNV9XUklURShHRU42X1JDNl9USFJFU0hPTEQsIDEyNTAw
MCk7Ci0JZWxzZQotCQlJOTE1X1dSSVRFKEdFTjZfUkM2X1RIUkVTSE9MRCwgNTAwMDApOwotCUk5
MTVfV1JJVEUoR0VONl9SQzZwX1RIUkVTSE9MRCwgMTUwMDAwKTsKLQlJOTE1X1dSSVRFKEdFTjZf
UkM2cHBfVEhSRVNIT0xELCA2NDAwMCk7IC8qIHVudXNlZCAqLwotCi0JLyogV2UgZG9uJ3QgdXNl
IHRob3NlIG9uIEhhc3dlbGwgKi8KLQlyYzZfbWFzayA9IEdFTjZfUkNfQ1RMX1JDNl9FTkFCTEU7
Ci0JaWYgKEhBU19SQzZwKGRldl9wcml2KSkKLQkJcmM2X21hc2sgfD0gR0VONl9SQ19DVExfUkM2
cF9FTkFCTEU7Ci0JaWYgKEhBU19SQzZwcChkZXZfcHJpdikpCi0JCXJjNl9tYXNrIHw9IEdFTjZf
UkNfQ1RMX1JDNnBwX0VOQUJMRTsKLQlJOTE1X1dSSVRFKEdFTjZfUkNfQ09OVFJPTCwKLQkJICAg
cmM2X21hc2sgfAotCQkgICBHRU42X1JDX0NUTF9FSV9NT0RFKDEpIHwKLQkJICAgR0VONl9SQ19D
VExfSFdfRU5BQkxFKTsKLQotCXJjNnZpZHMgPSAwOwotCXJldCA9IHNhbmR5YnJpZGdlX3Bjb2Rl
X3JlYWQoZGV2X3ByaXYsIEdFTjZfUENPREVfUkVBRF9SQzZWSURTLAotCQkJCSAgICAgJnJjNnZp
ZHMsIE5VTEwpOwotCWlmIChJU19HRU4oZGV2X3ByaXYsIDYpICYmIHJldCkgewotCQlEUk1fREVC
VUdfRFJJVkVSKCJDb3VsZG4ndCBjaGVjayBmb3IgQklPUyB3b3JrYXJvdW5kXG4iKTsKLQl9IGVs
c2UgaWYgKElTX0dFTihkZXZfcHJpdiwgNikgJiYgKEdFTjZfREVDT0RFX1JDNl9WSUQocmM2dmlk
cyAmIDB4ZmYpIDwgNDUwKSkgewotCQlEUk1fREVCVUdfRFJJVkVSKCJZb3Ugc2hvdWxkIHVwZGF0
ZSB5b3VyIEJJT1MuIENvcnJlY3RpbmcgbWluaW11bSByYzYgdm9sdGFnZSAoJWRtVi0+JWRtVilc
biIsCi0JCQkgIEdFTjZfREVDT0RFX1JDNl9WSUQocmM2dmlkcyAmIDB4ZmYpLCA0NTApOwotCQly
YzZ2aWRzICY9IDB4ZmZmZjAwOwotCQlyYzZ2aWRzIHw9IEdFTjZfRU5DT0RFX1JDNl9WSUQoNDUw
KTsKLQkJcmV0ID0gc2FuZHlicmlkZ2VfcGNvZGVfd3JpdGUoZGV2X3ByaXYsIEdFTjZfUENPREVf
V1JJVEVfUkM2VklEUywgcmM2dmlkcyk7Ci0JCWlmIChyZXQpCi0JCQlEUk1fRVJST1IoIkNvdWxk
bid0IGZpeCBpbmNvcnJlY3QgcmM2IHZvbHRhZ2VcbiIpOwotCX0KLQotCWludGVsX3VuY29yZV9m
b3JjZXdha2VfcHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKLX0KLQogc3Rh
dGljIHZvaWQgZ2VuNl9lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKIHsKIAkvKiBIZXJlIGJlZ2lucyBhIG1hZ2ljIHNlcXVlbmNlIG9mIHJlZ2lzdGVyIHdyaXRl
cyB0byBlbmFibGUKQEAgLTc2NjIsMjQgKzczNTEsNiBAQCBzdGF0aWMgaW50IHZhbGxleXZpZXdf
cnBzX21pbl9mcmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlyZXR1cm4g
bWF4X3QodTMyLCB2YWwsIDB4YzApOwogfQogCi0vKiBDaGVjayB0aGF0IHRoZSBwY3R4IGJ1ZmZl
ciB3YXNuJ3QgbW92ZSB1bmRlciB1cy4gKi8KLXN0YXRpYyB2b2lkIHZhbGxleXZpZXdfY2hlY2tf
cGN0eChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JdW5zaWduZWQgbG9u
ZyBwY3R4X2FkZHIgPSBJOTE1X1JFQUQoVkxWX1BDQlIpICYgfjQwOTU7Ci0KLQlXQVJOX09OKHBj
dHhfYWRkciAhPSBkZXZfcHJpdi0+ZHNtLnN0YXJ0ICsKLQkJCSAgICAgZGV2X3ByaXYtPnZsdl9w
Y3R4LT5zdG9sZW4tPnN0YXJ0KTsKLX0KLQotCi0vKiBDaGVjayB0aGF0IHRoZSBwY2JyIGFkZHJl
c3MgaXMgbm90IGVtcHR5LiAqLwotc3RhdGljIHZvaWQgY2hlcnJ5dmlld19jaGVja19wY3R4KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQl1bnNpZ25lZCBsb25nIHBjdHhf
YWRkciA9IEk5MTVfUkVBRChWTFZfUENCUikgJiB+NDA5NTsKLQotCVdBUk5fT04oKHBjdHhfYWRk
ciA+PiBWTFZfUENCUl9BRERSX1NISUZUKSA9PSAwKTsKLX0KLQogc3RhdGljIHZvaWQgY2hlcnJ5
dmlld19zZXR1cF9wY3R4KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKIAly
ZXNvdXJjZV9zaXplX3QgcGN0eF9wYWRkciwgcGFkZHI7CkBAIC03ODg1LDU5ICs3NTU2LDYgQEAg
c3RhdGljIHZvaWQgdmFsbGV5dmlld19jbGVhbnVwX2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJdmFsbGV5dmlld19jbGVhbnVwX3BjdHgoZGV2X3ByaXYp
OwogfQogCi1zdGF0aWMgdm9pZCBjaGVycnl2aWV3X2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQotewotCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsK
LQllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKLQl1MzIgZ3RmaWZvZGJnLCByYzZfbW9kZSwgcGNi
cjsKLQotCWd0Zmlmb2RiZyA9IEk5MTVfUkVBRChHVEZJRk9EQkcpICYgfihHVF9GSUZPX1NCREVE
SUNBVEVfRlJFRV9FTlRSWV9DSFYgfAotCQkJCQkgICAgIEdUX0ZJRk9fRlJFRV9FTlRSSUVTX0NI
Vik7Ci0JaWYgKGd0Zmlmb2RiZykgewotCQlEUk1fREVCVUdfRFJJVkVSKCJHVCBmaWZvIGhhZCBh
IHByZXZpb3VzIGVycm9yICV4XG4iLAotCQkJCSBndGZpZm9kYmcpOwotCQlJOTE1X1dSSVRFKEdU
RklGT0RCRywgZ3RmaWZvZGJnKTsKLQl9Ci0KLQljaGVycnl2aWV3X2NoZWNrX3BjdHgoZGV2X3By
aXYpOwotCi0JLyogMWEgJiAxYjogR2V0IGZvcmNld2FrZSBkdXJpbmcgcHJvZ3JhbSBzZXF1ZW5j
ZS4gQWx0aG91Z2ggdGhlIGRyaXZlcgotCSAqIGhhc24ndCBlbmFibGVkIGEgc3RhdGUgeWV0IHdo
ZXJlIHdlIG5lZWQgZm9yY2V3YWtlLCBCSU9TIG1heSBoYXZlLiovCi0JaW50ZWxfdW5jb3JlX2Zv
cmNld2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotCi0JLyogIERp
c2FibGUgUkMgc3RhdGVzLiAqLwotCUk5MTVfV1JJVEUoR0VONl9SQ19DT05UUk9MLCAwKTsKLQot
CS8qIDJhOiBQcm9ncmFtIFJDNiB0aHJlc2hvbGRzLiovCi0JSTkxNV9XUklURShHRU42X1JDNl9X
QUtFX1JBVEVfTElNSVQsIDQwIDw8IDE2KTsKLQlJOTE1X1dSSVRFKEdFTjZfUkNfRVZBTFVBVElP
Tl9JTlRFUlZBTCwgMTI1MDAwKTsgLyogMTI1MDAgKiAxMjgwbnMgKi8KLQlJOTE1X1dSSVRFKEdF
TjZfUkNfSURMRV9IWVNURVJTSVMsIDI1KTsgLyogMjUgKiAxMjgwbnMgKi8KLQotCWZvcl9lYWNo
X2VuZ2luZShlbmdpbmUsIGRldl9wcml2LCBpZCkKLQkJSTkxNV9XUklURShSSU5HX01BWF9JRExF
KGVuZ2luZS0+bW1pb19iYXNlKSwgMTApOwotCUk5MTVfV1JJVEUoR0VONl9SQ19TTEVFUCwgMCk7
Ci0KLQkvKiBUTyB0aHJlc2hvbGQgc2V0IHRvIDUwMCB1cyAoIDB4MTg2ICogMS4yOCB1cykgKi8K
LQlJOTE1X1dSSVRFKEdFTjZfUkM2X1RIUkVTSE9MRCwgMHgxODYpOwotCi0JLyogQWxsb3dzIFJD
NiByZXNpZGVuY3kgY291bnRlciB0byB3b3JrICovCi0JSTkxNV9XUklURShWTFZfQ09VTlRFUl9D
T05UUk9MLAotCQkgICBfTUFTS0VEX0JJVF9FTkFCTEUoVkxWX0NPVU5UX1JBTkdFX0hJR0ggfAot
CQkJCSAgICAgIFZMVl9NRURJQV9SQzZfQ09VTlRfRU4gfAotCQkJCSAgICAgIFZMVl9SRU5ERVJf
UkM2X0NPVU5UX0VOKSk7Ci0KLQkvKiBGb3Igbm93IHdlIGFzc3VtZSBCSU9TIGlzIGFsbG9jYXRp
bmcgYW5kIHBvcHVsYXRpbmcgdGhlIFBDQlIgICovCi0JcGNiciA9IEk5MTVfUkVBRChWTFZfUENC
Uik7Ci0KLQkvKiAzOiBFbmFibGUgUkM2ICovCi0JcmM2X21vZGUgPSAwOwotCWlmIChwY2JyID4+
IFZMVl9QQ0JSX0FERFJfU0hJRlQpCi0JCXJjNl9tb2RlID0gR0VON19SQ19DVExfVE9fTU9ERTsK
LQlJOTE1X1dSSVRFKEdFTjZfUkNfQ09OVFJPTCwgcmM2X21vZGUpOwotCi0JaW50ZWxfdW5jb3Jl
X2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotfQotCiBz
dGF0aWMgdm9pZCBjaGVycnl2aWV3X2VuYWJsZV9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQogewogCXUzMiB2YWw7CkBAIC03OTgyLDQ5ICs3NjAwLDYgQEAgc3RhdGljIHZv
aWQgY2hlcnJ5dmlld19lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKIAlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VX
QUtFX0FMTCk7CiB9CiAKLXN0YXRpYyB2b2lkIHZhbGxleXZpZXdfZW5hYmxlX3JjNihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0Jc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lOwotCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwotCXUzMiBndGZpZm9kYmc7Ci0KLQl2
YWxsZXl2aWV3X2NoZWNrX3BjdHgoZGV2X3ByaXYpOwotCi0JZ3RmaWZvZGJnID0gSTkxNV9SRUFE
KEdURklGT0RCRyk7Ci0JaWYgKGd0Zmlmb2RiZykgewotCQlEUk1fREVCVUdfRFJJVkVSKCJHVCBm
aWZvIGhhZCBhIHByZXZpb3VzIGVycm9yICV4XG4iLAotCQkJCSBndGZpZm9kYmcpOwotCQlJOTE1
X1dSSVRFKEdURklGT0RCRywgZ3RmaWZvZGJnKTsKLQl9Ci0KLQlpbnRlbF91bmNvcmVfZm9yY2V3
YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Ci0KLQkvKiAgRGlzYWJs
ZSBSQyBzdGF0ZXMuICovCi0JSTkxNV9XUklURShHRU42X1JDX0NPTlRST0wsIDApOwotCi0JSTkx
NV9XUklURShHRU42X1JDNl9XQUtFX1JBVEVfTElNSVQsIDB4MDAyODAwMDApOwotCUk5MTVfV1JJ
VEUoR0VONl9SQ19FVkFMVUFUSU9OX0lOVEVSVkFMLCAxMjUwMDApOwotCUk5MTVfV1JJVEUoR0VO
Nl9SQ19JRExFX0hZU1RFUlNJUywgMjUpOwotCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZGV2
X3ByaXYsIGlkKQotCQlJOTE1X1dSSVRFKFJJTkdfTUFYX0lETEUoZW5naW5lLT5tbWlvX2Jhc2Up
LCAxMCk7Ci0KLQlJOTE1X1dSSVRFKEdFTjZfUkM2X1RIUkVTSE9MRCwgMHg1NTcpOwotCi0JLyog
QWxsb3dzIFJDNiByZXNpZGVuY3kgY291bnRlciB0byB3b3JrICovCi0JSTkxNV9XUklURShWTFZf
Q09VTlRFUl9DT05UUk9MLAotCQkgICBfTUFTS0VEX0JJVF9FTkFCTEUoVkxWX0NPVU5UX1JBTkdF
X0hJR0ggfAotCQkJCSAgICAgIFZMVl9NRURJQV9SQzBfQ09VTlRfRU4gfAotCQkJCSAgICAgIFZM
Vl9SRU5ERVJfUkMwX0NPVU5UX0VOIHwKLQkJCQkgICAgICBWTFZfTUVESUFfUkM2X0NPVU5UX0VO
IHwKLQkJCQkgICAgICBWTFZfUkVOREVSX1JDNl9DT1VOVF9FTikpOwotCi0JSTkxNV9XUklURShH
RU42X1JDX0NPTlRST0wsCi0JCSAgIEdFTjdfUkNfQ1RMX1RPX01PREUgfCBWTFZfUkNfQ1RMX0NU
WF9SU1RfUEFSQUxMRUwpOwotCi0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2
LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotfQotCiBzdGF0aWMgdm9pZCB2YWxsZXl2aWV3X2Vu
YWJsZV9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewogCXUzMiB2YWw7
CkBAIC04NTk3LDE1ICs4MTcyLDEyIEBAIHZvaWQgaW50ZWxfY2xlYW51cF9ndF9wb3dlcnNhdmUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewogCWlmIChJU19WQUxMRVlWSUVX
KGRldl9wcml2KSkKIAkJdmFsbGV5dmlld19jbGVhbnVwX2d0X3Bvd2Vyc2F2ZShkZXZfcHJpdik7
Ci0KLQlpZiAoIUhBU19SQzYoZGV2X3ByaXYpKQotCQlwbV9ydW50aW1lX3B1dCgmZGV2X3ByaXYt
PmRybS5wZGV2LT5kZXYpOwogfQogCiB2b2lkIGludGVsX3Nhbml0aXplX2d0X3Bvd2Vyc2F2ZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7CiAJZGV2X3ByaXYtPmd0X3BtLnJw
cy5lbmFibGVkID0gdHJ1ZTsgLyogZm9yY2UgUlBTIGRpc2FibGluZyAqLwotCWRldl9wcml2LT5n
dF9wbS5yYzYuZW5hYmxlZCA9IHRydWU7IC8qIGZvcmNlIFJDNiBkaXNhYmxpbmcgKi8KKwlkZXZf
cHJpdi0+Z3QucmM2LmVuYWJsZWQgPSB0cnVlOyAvKiBmb3JjZSBSQzYgZGlzYWJsaW5nICovCiAJ
aW50ZWxfZGlzYWJsZV9ndF9wb3dlcnNhdmUoZGV2X3ByaXYpOwogCiAJaWYgKElOVEVMX0dFTihk
ZXZfcHJpdikgPj0gMTEpCkBAIC04NjI2LDI1ICs4MTk4LDYgQEAgc3RhdGljIGlubGluZSB2b2lk
IGludGVsX2Rpc2FibGVfbGxjX3BzdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
IAlpOTE1LT5ndF9wbS5sbGNfcHN0YXRlLmVuYWJsZWQgPSBmYWxzZTsKIH0KIAotc3RhdGljIHZv
aWQgaW50ZWxfZGlzYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQot
ewotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5ndF9wbS5ycHMubG9jayk7Ci0KLQlp
ZiAoIWRldl9wcml2LT5ndF9wbS5yYzYuZW5hYmxlZCkKLQkJcmV0dXJuOwotCi0JaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPj0gOSkKLQkJZ2VuOV9kaXNhYmxlX3JjNihkZXZfcHJpdik7Ci0JZWxz
ZSBpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCi0JCWNoZXJyeXZpZXdfZGlzYWJsZV9yYzYo
ZGV2X3ByaXYpOwotCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpKQotCQl2YWxsZXl2
aWV3X2Rpc2FibGVfcmM2KGRldl9wcml2KTsKLQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
ID49IDYpCi0JCWdlbjZfZGlzYWJsZV9yYzYoZGV2X3ByaXYpOwotCi0JZGV2X3ByaXYtPmd0X3Bt
LnJjNi5lbmFibGVkID0gZmFsc2U7Ci19Ci0KIHN0YXRpYyB2b2lkIGludGVsX2Rpc2FibGVfcnBz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKIAlsb2NrZGVwX2Fzc2VydF9o
ZWxkKCZkZXZfcHJpdi0+Z3RfcG0ucnBzLmxvY2spOwpAQCAtODY3MCw4ICs4MjIzLDYgQEAgdm9p
ZCBpbnRlbF9kaXNhYmxlX2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCiB7CiAJbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmd0X3BtLnJwcy5sb2NrKTsKIAotCWlu
dGVsX2Rpc2FibGVfcmM2KGRldl9wcml2KTsKLQogCWludGVsX2Rpc2FibGVfcnBzKGRldl9wcml2
KTsKIAlpZiAoSEFTX0xMQyhkZXZfcHJpdikpCiAJCWludGVsX2Rpc2FibGVfbGxjX3BzdGF0ZShk
ZXZfcHJpdik7CkBAIC04NjkxLDI5ICs4MjQyLDYgQEAgc3RhdGljIGlubGluZSB2b2lkIGludGVs
X2VuYWJsZV9sbGNfcHN0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCWk5MTUt
Pmd0X3BtLmxsY19wc3RhdGUuZW5hYmxlZCA9IHRydWU7CiB9CiAKLXN0YXRpYyB2b2lkIGludGVs
X2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCWxvY2tk
ZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5ndF9wbS5ycHMubG9jayk7Ci0KLQlpZiAoZGV2X3By
aXYtPmd0X3BtLnJjNi5lbmFibGVkKQotCQlyZXR1cm47Ci0KLQlpZiAoSVNfQ0hFUlJZVklFVyhk
ZXZfcHJpdikpCi0JCWNoZXJyeXZpZXdfZW5hYmxlX3JjNihkZXZfcHJpdik7Ci0JZWxzZSBpZiAo
SVNfVkFMTEVZVklFVyhkZXZfcHJpdikpCi0JCXZhbGxleXZpZXdfZW5hYmxlX3JjNihkZXZfcHJp
dik7Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKLQkJZ2VuMTFfZW5hYmxl
X3JjNihkZXZfcHJpdik7Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KQotCQln
ZW45X2VuYWJsZV9yYzYoZGV2X3ByaXYpOwotCWVsc2UgaWYgKElTX0JST0FEV0VMTChkZXZfcHJp
dikpCi0JCWdlbjhfZW5hYmxlX3JjNihkZXZfcHJpdik7Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGRl
dl9wcml2KSA+PSA2KQotCQlnZW42X2VuYWJsZV9yYzYoZGV2X3ByaXYpOwotCi0JZGV2X3ByaXYt
Pmd0X3BtLnJjNi5lbmFibGVkID0gdHJ1ZTsKLX0KLQogc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxl
X3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7CiAJc3RydWN0IGludGVs
X3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7CkBAIC04NzU2LDcgKzgyODQsNyBAQCB2
b2lkIGludGVsX2VuYWJsZV9ndF9wb3dlcnNhdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQogCW11dGV4X2xvY2soJmRldl9wcml2LT5ndF9wbS5ycHMubG9jayk7CiAKIAlpZiAo
SEFTX1JDNihkZXZfcHJpdikpCi0JCWludGVsX2VuYWJsZV9yYzYoZGV2X3ByaXYpOworCQlpbnRl
bF9yYzZfZW5hYmxlKCZkZXZfcHJpdi0+Z3QucmM2KTsKIAlpZiAoSEFTX1JQUyhkZXZfcHJpdikp
CiAJCWludGVsX2VuYWJsZV9ycHMoZGV2X3ByaXYpOwogCWlmIChIQVNfTExDKGRldl9wcml2KSkK
QEAgLTk4MTgsMTMzICs5MzQ2LDYgQEAgdm9pZCBpbnRlbF9wbV9zZXR1cChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJYXRvbWljX3NldCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0u
d2FrZXJlZl9jb3VudCwgMCk7CiB9CiAKLXN0YXRpYyB1NjQgdmx2X3Jlc2lkZW5jeV9yYXcoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAotCQkJICAgICBjb25zdCBpOTE1X3JlZ190
IHJlZykKLXsKLQl1MzIgbG93ZXIsIHVwcGVyLCB0bXA7Ci0JaW50IGxvb3AgPSAyOwotCi0JLyoK
LQkgKiBUaGUgcmVnaXN0ZXIgYWNjZXNzZWQgZG8gbm90IG5lZWQgZm9yY2V3YWtlLiBXZSBib3Jy
b3cKLQkgKiB1bmNvcmUgbG9jayB0byBwcmV2ZW50IGNvbmN1cnJlbnQgYWNjZXNzIHRvIHJhbmdl
IHJlZy4KLQkgKi8KLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+dW5jb3JlLmxvY2sp
OwotCi0JLyoKLQkgKiB2bHYgYW5kIGNodiByZXNpZGVuY3kgY291bnRlcnMgYXJlIDQwIGJpdHMg
aW4gd2lkdGguCi0JICogV2l0aCBhIGNvbnRyb2wgYml0LCB3ZSBjYW4gY2hvb3NlIGJldHdlZW4g
dXBwZXIgb3IgbG93ZXIKLQkgKiAzMmJpdCB3aW5kb3cgaW50byB0aGlzIGNvdW50ZXIuCi0JICoK
LQkgKiBBbHRob3VnaCB3ZSBhbHdheXMgdXNlIHRoZSBjb3VudGVyIGluIGhpZ2gtcmFuZ2UgbW9k
ZSBlbHNld2hlcmUsCi0JICogdXNlcnNwYWNlIG1heSBhdHRlbXB0IHRvIHJlYWQgdGhlIHZhbHVl
IGJlZm9yZSByYzYgaXMgaW5pdGlhbGlzZWQsCi0JICogYmVmb3JlIHdlIGhhdmUgc2V0IHRoZSBk
ZWZhdWx0IFZMVl9DT1VOVEVSX0NPTlRST0wgdmFsdWUuIFNvIGFsd2F5cwotCSAqIHNldCB0aGUg
aGlnaCBiaXQgdG8gYmUgc2FmZS4KLQkgKi8KLQlJOTE1X1dSSVRFX0ZXKFZMVl9DT1VOVEVSX0NP
TlRST0wsCi0JCSAgICAgIF9NQVNLRURfQklUX0VOQUJMRShWTFZfQ09VTlRfUkFOR0VfSElHSCkp
OwotCXVwcGVyID0gSTkxNV9SRUFEX0ZXKHJlZyk7Ci0JZG8gewotCQl0bXAgPSB1cHBlcjsKLQot
CQlJOTE1X1dSSVRFX0ZXKFZMVl9DT1VOVEVSX0NPTlRST0wsCi0JCQkgICAgICBfTUFTS0VEX0JJ
VF9ESVNBQkxFKFZMVl9DT1VOVF9SQU5HRV9ISUdIKSk7Ci0JCWxvd2VyID0gSTkxNV9SRUFEX0ZX
KHJlZyk7Ci0KLQkJSTkxNV9XUklURV9GVyhWTFZfQ09VTlRFUl9DT05UUk9MLAotCQkJICAgICAg
X01BU0tFRF9CSVRfRU5BQkxFKFZMVl9DT1VOVF9SQU5HRV9ISUdIKSk7Ci0JCXVwcGVyID0gSTkx
NV9SRUFEX0ZXKHJlZyk7Ci0JfSB3aGlsZSAodXBwZXIgIT0gdG1wICYmIC0tbG9vcCk7Ci0KLQkv
KgotCSAqIEV2ZXJ5d2hlcmUgZWxzZSB3ZSBhbHdheXMgdXNlIFZMVl9DT1VOVEVSX0NPTlRST0wg
d2l0aCB0aGUKLQkgKiBWTFZfQ09VTlRfUkFOR0VfSElHSCBiaXQgc2V0IC0gc28gaXQgaXMgc2Fm
ZSB0byBsZWF2ZSBpdCBzZXQKLQkgKiBub3cuCi0JICovCi0KLQlyZXR1cm4gbG93ZXIgfCAodTY0
KXVwcGVyIDw8IDg7Ci19Ci0KLXU2NCBpbnRlbF9yYzZfcmVzaWRlbmN5X25zKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCSAgIGNvbnN0IGk5MTVfcmVnX3QgcmVnKQotewot
CXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwotCXU2NCB0
aW1lX2h3LCBwcmV2X2h3LCBvdmVyZmxvd19odzsKLQl1bnNpZ25lZCBpbnQgZndfZG9tYWluczsK
LQl1bnNpZ25lZCBsb25nIGZsYWdzOwotCXVuc2lnbmVkIGludCBpOwotCXUzMiBtdWwsIGRpdjsK
LQotCWlmICghSEFTX1JDNihkZXZfcHJpdikpCi0JCXJldHVybiAwOwotCi0JLyoKLQkgKiBTdG9y
ZSBwcmV2aW91cyBodyBjb3VudGVyIHZhbHVlcyBmb3IgY291bnRlciB3cmFwLWFyb3VuZCBoYW5k
bGluZy4KLQkgKgotCSAqIFRoZXJlIGFyZSBvbmx5IGZvdXIgaW50ZXJlc3RpbmcgcmVnaXN0ZXJz
IGFuZCB0aGV5IGxpdmUgbmV4dCB0byBlYWNoCi0JICogb3RoZXIgc28gd2UgY2FuIHVzZSB0aGUg
cmVsYXRpdmUgYWRkcmVzcywgY29tcGFyZWQgdG8gdGhlIHNtYWxsZXN0Ci0JICogb25lIGFzIHRo
ZSBpbmRleCBpbnRvIGRyaXZlciBzdG9yYWdlLgotCSAqLwotCWkgPSAoaTkxNV9tbWlvX3JlZ19v
ZmZzZXQocmVnKSAtCi0JICAgICBpOTE1X21taW9fcmVnX29mZnNldChHRU42X0dUX0dGWF9SQzZf
TE9DS0VEKSkgLyBzaXplb2YodTMyKTsKLQlpZiAoV0FSTl9PTl9PTkNFKGkgPj0gQVJSQVlfU0la
RShkZXZfcHJpdi0+Z3RfcG0ucmM2LmN1cl9yZXNpZGVuY3kpKSkKLQkJcmV0dXJuIDA7Ci0KLQlm
d19kb21haW5zID0gaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9mb3JfcmVnKHVuY29yZSwgcmVnLCBG
V19SRUdfUkVBRCk7Ci0KLQlzcGluX2xvY2tfaXJxc2F2ZSgmdW5jb3JlLT5sb2NrLCBmbGFncyk7
Ci0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXRfX2xvY2tlZCh1bmNvcmUsIGZ3X2RvbWFpbnMp
OwotCi0JLyogT24gVkxWIGFuZCBDSFYsIHJlc2lkZW5jeSB0aW1lIGlzIGluIENaIHVuaXRzIHJh
dGhlciB0aGFuIDEuMjh1cyAqLwotCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19D
SEVSUllWSUVXKGRldl9wcml2KSkgewotCQltdWwgPSAxMDAwMDAwOwotCQlkaXYgPSBkZXZfcHJp
di0+Y3pjbGtfZnJlcTsKLQkJb3ZlcmZsb3dfaHcgPSBCSVRfVUxMKDQwKTsKLQkJdGltZV9odyA9
IHZsdl9yZXNpZGVuY3lfcmF3KGRldl9wcml2LCByZWcpOwotCX0gZWxzZSB7Ci0JCS8qIDgzMy4z
M25zIHVuaXRzIG9uIEdlbjlMUCwgMS4yOHVzIGVsc2V3aGVyZS4gKi8KLQkJaWYgKElTX0dFTjlf
TFAoZGV2X3ByaXYpKSB7Ci0JCQltdWwgPSAxMDAwMDsKLQkJCWRpdiA9IDEyOwotCQl9IGVsc2Ug
ewotCQkJbXVsID0gMTI4MDsKLQkJCWRpdiA9IDE7Ci0JCX0KLQotCQlvdmVyZmxvd19odyA9IEJJ
VF9VTEwoMzIpOwotCQl0aW1lX2h3ID0gaW50ZWxfdW5jb3JlX3JlYWRfZncodW5jb3JlLCByZWcp
OwotCX0KLQotCS8qCi0JICogQ291bnRlciB3cmFwIGhhbmRsaW5nLgotCSAqCi0JICogQnV0IHJl
bHlpbmcgb24gYSBzdWZmaWNpZW50IGZyZXF1ZW5jeSBvZiBxdWVyaWVzIG90aGVyd2lzZSBjb3Vu
dGVycwotCSAqIGNhbiBzdGlsbCB3cmFwLgotCSAqLwotCXByZXZfaHcgPSBkZXZfcHJpdi0+Z3Rf
cG0ucmM2LnByZXZfaHdfcmVzaWRlbmN5W2ldOwotCWRldl9wcml2LT5ndF9wbS5yYzYucHJldl9o
d19yZXNpZGVuY3lbaV0gPSB0aW1lX2h3OwotCi0JLyogUkM2IGRlbHRhIGZyb20gbGFzdCBzYW1w
bGUuICovCi0JaWYgKHRpbWVfaHcgPj0gcHJldl9odykKLQkJdGltZV9odyAtPSBwcmV2X2h3Owot
CWVsc2UKLQkJdGltZV9odyArPSBvdmVyZmxvd19odyAtIHByZXZfaHc7Ci0KLQkvKiBBZGQgZGVs
dGEgdG8gUkM2IGV4dGVuZGVkIHJhdyBkcml2ZXIgY29weS4gKi8KLQl0aW1lX2h3ICs9IGRldl9w
cml2LT5ndF9wbS5yYzYuY3VyX3Jlc2lkZW5jeVtpXTsKLQlkZXZfcHJpdi0+Z3RfcG0ucmM2LmN1
cl9yZXNpZGVuY3lbaV0gPSB0aW1lX2h3OwotCi0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXRf
X2xvY2tlZCh1bmNvcmUsIGZ3X2RvbWFpbnMpOwotCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnVu
Y29yZS0+bG9jaywgZmxhZ3MpOwotCi0JcmV0dXJuIG11bF91NjRfdTMyX2Rpdih0aW1lX2h3LCBt
dWwsIGRpdik7Ci19Ci0KLXU2NCBpbnRlbF9yYzZfcmVzaWRlbmN5X3VzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCSAgIGk5MTVfcmVnX3QgcmVnKQotewotCXJldHVybiBE
SVZfUk9VTkRfVVBfVUxMKGludGVsX3JjNl9yZXNpZGVuY3lfbnMoZGV2X3ByaXYsIHJlZyksIDEw
MDApOwotfQotCiB1MzIgaW50ZWxfZ2V0X2NhZ2Yoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LCB1MzIgcnBzdGF0KQogewogCXUzMiBjYWdmOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfcG0uaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmgK
aW5kZXggZTM1NzNlMWUxNmUzLi5jOTc0NGVhZTUwZTIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX3BtLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0u
aApAQCAtNzIsOCArNzIsNiBAQCB2b2lkIGludGVsX2VuYWJsZV9pcGMoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KTsKIAogaW50IGludGVsX2dwdV9mcmVxKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwgaW50IHZhbCk7CiBpbnQgaW50ZWxfZnJlcV9vcGNvZGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgdmFsKTsKLXU2NCBpbnRlbF9yYzZf
cmVzaWRlbmN5X25zKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaTkxNV9yZWdf
dCByZWcpOwotdTY0IGludGVsX3JjNl9yZXNpZGVuY3lfdXMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LCBpOTE1X3JlZ190IHJlZyk7CiAKIHUzMiBpbnRlbF9nZXRfY2FnZihzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBycHN0YXQxKTsKIAotLSAKMi4yMy4w
CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1n
ZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9s
aXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

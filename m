Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id D01D61150F3
	for <lists+intel-gfx@lfdr.de>; Fri,  6 Dec 2019 14:22:09 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B34AD6FA0D;
	Fri,  6 Dec 2019 13:22:07 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga09.intel.com (mga09.intel.com [134.134.136.24])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9DE336FA0D
 for <intel-gfx@lists.freedesktop.org>; Fri,  6 Dec 2019 13:22:06 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga004.jf.intel.com ([10.7.209.38])
 by orsmga102.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 06 Dec 2019 05:22:06 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.69,284,1571727600"; d="scan'208";a="362233494"
Received: from cfromme-mobl1.ger.corp.intel.com (HELO [10.252.34.238])
 ([10.252.34.238])
 by orsmga004.jf.intel.com with ESMTP; 06 Dec 2019 05:22:03 -0800
To: Umesh Nerlige Ramappa <umesh.nerlige.ramappa@intel.com>,
 intel-gfx@lists.freedesktop.org, Chris Wilson <chris.p.wilson@intel.com>
References: <20191118222432.65399-1-umesh.nerlige.ramappa@intel.com>
 <20191118222432.65399-2-umesh.nerlige.ramappa@intel.com>
From: Lionel Landwerlin <lionel.g.landwerlin@intel.com>
Organization: Intel Corporation (UK) Ltd. - Co. Reg. #1134945 - Pipers Way,
 Swindon SN3 1RJ
Message-ID: <e1f91b06-cd11-5224-ddde-c7a7fdfcff36@intel.com>
Date: Fri, 6 Dec 2019 15:22:02 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.2.2
MIME-Version: 1.0
In-Reply-To: <20191118222432.65399-2-umesh.nerlige.ramappa@intel.com>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH v3 2/2] drm/i915/perf: Configure OAR for
 specific context
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T24gMTkvMTEvMjAxOSAwMDoyNCwgVW1lc2ggTmVybGlnZSBSYW1hcHBhIHdyb3RlOgo+IEdlbjEy
IHN1cHBvcnRzIHNhdmluZy9yZXN0b3JpbmcgcmVuZGVyIGNvdW50ZXJzIHBlciBjb250ZXh0LiBB
cHBseSBPQVIKPiBjb25maWd1cmF0aW9uIG9ubHkgZm9yIHRoZSBjb250ZXh0IHRoYXQgaXMgcGFz
c2VkIGluIHRvIHBlcmYuCj4KPiB2MjoKPiAtIEZpeCBPQUNUWENPTlRST0wgdmFsdWUgdG8gb25s
eSBzdG9wL3Jlc3VtZSBjb3VudGVycy4KPiAtIFJlbW92ZSBnZW4xMl91cGRhdGVfcmVnX3N0YXRl
X3VubG9ja2VkIGFzIHBvd2VyIHN0YXRlIGlzIGFscmVhZHkKPiAgICBhcHBsaWVkIGJ5IHRoZSBj
YWxsZXIuCj4KPiB2MzogKExpb25lbCkKPiAtIE1vdmUgcmVnaXN0ZXIgaW5pdGlhbGl6YXRpb24g
aW50byB0aGUgYXJyYXkKPiAtIEFzc3VtZSBhIHZhbGlkIG9hX2NvbmZpZyBpbiBlbmFibGVfbWV0
cmljX3NldAo+Cj4gU2lnbmVkLW9mZi1ieTogVW1lc2ggTmVybGlnZSBSYW1hcHBhIDx1bWVzaC5u
ZXJsaWdlLnJhbWFwcGFAaW50ZWwuY29tPgoKTG9va3MgYWxsIGdvb2QsIHRoYW5rcyEKCgpSZXZp
ZXdlZC1ieTogTGlvbmVsIExhbmR3ZXJsaW4gPGxpb25lbC5nLmxhbmR3ZXJsaW5AaW50ZWwuY29t
PgoKPiAtLS0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5jIHwgMTk5ICsrKysr
KysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0KPiAgIDEgZmlsZSBjaGFuZ2VkLCAxMTIgaW5zZXJ0
aW9ucygrKSwgODcgZGVsZXRpb25zKC0pCj4KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9wZXJmLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYwo+IGlu
ZGV4IGNhNTg1MDJhNjdkOC4uZWE5MTE5NjFmZDhjIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfcGVyZi5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9w
ZXJmLmMKPiBAQCAtMjA4MCwyMCArMjA4MCwxMiBAQCBnZW44X3VwZGF0ZV9yZWdfc3RhdGVfdW5s
b2NrZWQoY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAo+ICAgCXUzMiAqcmVnX3N0YXRl
ID0gY2UtPmxyY19yZWdfc3RhdGU7Cj4gICAJaW50IGk7Cj4gICAKPiAtCWlmIChJU19HRU4oc3Ry
ZWFtLT5wZXJmLT5pOTE1LCAxMikpIHsKPiAtCQl1MzIgZm9ybWF0ID0gc3RyZWFtLT5vYV9idWZm
ZXIuZm9ybWF0Owo+ICsJcmVnX3N0YXRlW2N0eF9vYWN0eGN0cmwgKyAxXSA9Cj4gKwkJKHN0cmVh
bS0+cGVyaW9kX2V4cG9uZW50IDw8IEdFTjhfT0FfVElNRVJfUEVSSU9EX1NISUZUKSB8Cj4gKwkJ
KHN0cmVhbS0+cGVyaW9kaWMgPyBHRU44X09BX1RJTUVSX0VOQUJMRSA6IDApIHwKPiArCQlHRU44
X09BX0NPVU5URVJfUkVTVU1FOwo+ICAgCj4gLQkJcmVnX3N0YXRlW2N0eF9vYWN0eGN0cmwgKyAx
XSA9Cj4gLQkJCShmb3JtYXQgPDwgR0VOMTJfT0FSX09BQ09OVFJPTF9DT1VOVEVSX0ZPUk1BVF9T
SElGVCkgfAo+IC0JCQkoc3RyZWFtLT5vYV9jb25maWcgPyBHRU4xMl9PQVJfT0FDT05UUk9MX0NP
VU5URVJfRU5BQkxFIDogMCk7Cj4gLQl9IGVsc2Ugewo+IC0JCXJlZ19zdGF0ZVtjdHhfb2FjdHhj
dHJsICsgMV0gPQo+IC0JCQkoc3RyZWFtLT5wZXJpb2RfZXhwb25lbnQgPDwgR0VOOF9PQV9USU1F
Ul9QRVJJT0RfU0hJRlQpIHwKPiAtCQkJKHN0cmVhbS0+cGVyaW9kaWMgPyBHRU44X09BX1RJTUVS
X0VOQUJMRSA6IDApIHwKPiAtCQkJR0VOOF9PQV9DT1VOVEVSX1JFU1VNRTsKPiAtCX0KPiAtCj4g
LQlmb3IgKGkgPSAwOyAhIWN0eF9mbGV4ZXUwICYmIGkgPCBBUlJBWV9TSVpFKGZsZXhfcmVncyk7
IGkrKykKPiArCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGZsZXhfcmVncyk7IGkrKykKPiAg
IAkJcmVnX3N0YXRlW2N0eF9mbGV4ZXUwICsgaSAqIDIgKyAxXSA9Cj4gICAJCQlvYV9jb25maWdf
ZmxleF9yZWcoc3RyZWFtLT5vYV9jb25maWcsIGZsZXhfcmVnc1tpXSk7Cj4gICAKPiBAQCAtMjIy
NiwzNCArMjIxOCw1MSBAQCBzdGF0aWMgaW50IGdlbjhfY29uZmlndXJlX2NvbnRleHQoc3RydWN0
IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKPiAgIAlyZXR1cm4gZXJyOwo+ICAgfQo+ICAgCj4gLXN0
YXRpYyBpbnQgZ2VuMTJfZW1pdF9vYXJfY29uZmlnKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwg
Ym9vbCBlbmFibGUpCj4gK3N0YXRpYyBpbnQgZ2VuMTJfY29uZmlndXJlX29hcl9jb250ZXh0KHN0
cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0sIGJvb2wgZW5hYmxlKQo+ICAgewo+IC0Jc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnE7Cj4gLQl1MzIgKmNzOwo+IC0JaW50IGVyciA9IDA7Cj4gLQo+
IC0JcnEgPSBpOTE1X3JlcXVlc3RfY3JlYXRlKGNlKTsKPiAtCWlmIChJU19FUlIocnEpKQo+IC0J
CXJldHVybiBQVFJfRVJSKHJxKTsKPiAtCj4gLQljcyA9IGludGVsX3JpbmdfYmVnaW4ocnEsIDQp
Owo+IC0JaWYgKElTX0VSUihjcykpIHsKPiAtCQllcnIgPSBQVFJfRVJSKGNzKTsKPiAtCQlnb3Rv
IG91dDsKPiAtCX0KPiAtCj4gLQkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKDEpOwo+IC0J
KmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChSSU5HX0NPTlRFWFRfQ09OVFJPTChjZS0+ZW5n
aW5lLT5tbWlvX2Jhc2UpKTsKPiAtCSpjcysrID0gX01BU0tFRF9GSUVMRChHRU4xMl9DVFhfQ1RS
TF9PQVJfQ09OVEVYVF9FTkFCTEUsCj4gLQkJCSAgICAgIGVuYWJsZSA/IEdFTjEyX0NUWF9DVFJM
X09BUl9DT05URVhUX0VOQUJMRSA6IDApOwo+IC0JKmNzKysgPSBNSV9OT09QOwo+ICsJaW50IGVy
cjsKPiArCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSA9IHN0cmVhbS0+cGlubmVkX2N0eDsKPiAr
CXUzMiBmb3JtYXQgPSBzdHJlYW0tPm9hX2J1ZmZlci5mb3JtYXQ7Cj4gKwlzdHJ1Y3QgZmxleCBy
ZWdzX2NvbnRleHRbXSA9IHsKPiArCQl7Cj4gKwkJCUdFTjhfT0FDVFhDT05UUk9MLAo+ICsJCQlz
dHJlYW0tPnBlcmYtPmN0eF9vYWN0eGN0cmxfb2Zmc2V0ICsgMSwKPiArCQkJZW5hYmxlID8gR0VO
OF9PQV9DT1VOVEVSX1JFU1VNRSA6IDAsCj4gKwkJfSwKPiArCX07Cj4gKwkvKiBPZmZzZXRzIGlu
IHJlZ3NfbHJpIGFyZSBub3QgdXNlZCBzaW5jZSB0aGlzIGNvbmZpZ3VyYXRpb24gaXMgb25seQo+
ICsJICogYXBwbGllZCB1c2luZyBMUkkuIEluaXRpYWxpemUgdGhlIGNvcnJlY3Qgb2Zmc2V0cyBm
b3IgcG9zdGVyaXR5Lgo+ICsJICovCj4gKyNkZWZpbmUgR0VOMTJfT0FSX09BQ09OVFJPTF9PRkZT
RVQgMHg1QjAKPiArCXN0cnVjdCBmbGV4IHJlZ3NfbHJpW10gPSB7Cj4gKwkJewo+ICsJCQlHRU4x
Ml9PQVJfT0FDT05UUk9MLAo+ICsJCQlHRU4xMl9PQVJfT0FDT05UUk9MX09GRlNFVCArIDEsCj4g
KwkJCShmb3JtYXQgPDwgR0VOMTJfT0FSX09BQ09OVFJPTF9DT1VOVEVSX0ZPUk1BVF9TSElGVCkg
fAo+ICsJCQkoZW5hYmxlID8gR0VOMTJfT0FSX09BQ09OVFJPTF9DT1VOVEVSX0VOQUJMRSA6IDAp
Cj4gKwkJfSwKPiArCQl7Cj4gKwkJCVJJTkdfQ09OVEVYVF9DT05UUk9MKGNlLT5lbmdpbmUtPm1t
aW9fYmFzZSksCj4gKwkJCUNUWF9DT05URVhUX0NPTlRST0wsCj4gKwkJCV9NQVNLRURfRklFTEQo
R0VOMTJfQ1RYX0NUUkxfT0FSX0NPTlRFWFRfRU5BQkxFLAo+ICsJCQkJICAgICAgZW5hYmxlID8K
PiArCQkJCSAgICAgIEdFTjEyX0NUWF9DVFJMX09BUl9DT05URVhUX0VOQUJMRSA6Cj4gKwkJCQkg
ICAgICAwKQo+ICsJCX0sCj4gKwl9Owo+ICAgCj4gLQlpbnRlbF9yaW5nX2FkdmFuY2UocnEsIGNz
KTsKPiArCS8qIE1vZGlmeSB0aGUgY29udGV4dCBpbWFnZSBvZiBwaW5uZWQgY29udGV4dCB3aXRo
IHJlZ3NfY29udGV4dCovCj4gKwllcnIgPSBpbnRlbF9jb250ZXh0X2xvY2tfcGlubmVkKGNlKTsK
PiArCWlmIChlcnIpCj4gKwkJcmV0dXJuIGVycjsKPiAgIAo+IC1vdXQ6Cj4gLQlpOTE1X3JlcXVl
c3RfYWRkKHJxKTsKPiArCWVyciA9IGdlbjhfbW9kaWZ5X2NvbnRleHQoY2UsIHJlZ3NfY29udGV4
dCwgQVJSQVlfU0laRShyZWdzX2NvbnRleHQpKTsKPiArCWludGVsX2NvbnRleHRfdW5sb2NrX3Bp
bm5lZChjZSk7Cj4gKwlpZiAoZXJyKQo+ICsJCXJldHVybiBlcnI7Cj4gICAKPiAtCXJldHVybiBl
cnI7Cj4gKwkvKiBBcHBseSByZWdzX2xyaSB1c2luZyBMUkkgd2l0aCBwaW5uZWQgY29udGV4dCAq
Lwo+ICsJcmV0dXJuIGdlbjhfbW9kaWZ5X3NlbGYoY2UsIHJlZ3NfbHJpLCBBUlJBWV9TSVpFKHJl
Z3NfbHJpKSk7Cj4gICB9Cj4gICAKPiAgIC8qCj4gQEAgLTIyNzksNTMgKzIyODgsMTYgQEAgc3Rh
dGljIGludCBnZW4xMl9lbWl0X29hcl9jb25maWcoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCBi
b29sIGVuYWJsZSkKPiAgICAqICAgcGVyLWNvbnRleHQgT0Egc3RhdGUuCj4gICAgKgo+ICAgICog
Tm90ZTogaXQncyBvbmx5IHRoZSBSQ1MvUmVuZGVyIGNvbnRleHQgdGhhdCBoYXMgYW55IE9BIHN0
YXRlLgo+ICsgKiBOb3RlOiB0aGUgZmlyc3QgZmxleCByZWdpc3RlciBwYXNzZWQgbXVzdCBhbHdh
eXMgYmUgUl9QV1JfQ0xLX1NUQVRFCj4gICAgKi8KPiAtc3RhdGljIGludCBscmNfY29uZmlndXJl
X2FsbF9jb250ZXh0cyhzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtLAo+IC0JCQkJICAg
ICAgY29uc3Qgc3RydWN0IGk5MTVfb2FfY29uZmlnICpvYV9jb25maWcpCj4gK3N0YXRpYyBpbnQg
b2FfY29uZmlndXJlX2FsbF9jb250ZXh0cyhzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFt
LAo+ICsJCQkJICAgICBzdHJ1Y3QgZmxleCAqcmVncywKPiArCQkJCSAgICAgc2l6ZV90IG51bV9y
ZWdzKQo+ICAgewo+ICAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gc3RyZWFtLT5w
ZXJmLT5pOTE1Owo+IC0JLyogVGhlIE1NSU8gb2Zmc2V0cyBmb3IgRmxleCBFVSByZWdpc3RlcnMg
YXJlbid0IGNvbnRpZ3VvdXMgKi8KPiAtCWNvbnN0IHUzMiBjdHhfZmxleGV1MCA9IHN0cmVhbS0+
cGVyZi0+Y3R4X2ZsZXhldTBfb2Zmc2V0Owo+IC0jZGVmaW5lIGN0eF9mbGV4ZXVOKE4pIChjdHhf
ZmxleGV1MCArIDIgKiAoTikgKyAxKQo+IC0Jc3RydWN0IGZsZXggcmVnc1tdID0gewo+IC0JCXsK
PiAtCQkJR0VOOF9SX1BXUl9DTEtfU1RBVEUsCj4gLQkJCUNUWF9SX1BXUl9DTEtfU1RBVEUsCj4g
LQkJfSwKPiAtCQl7Cj4gLQkJCUlTX0dFTihpOTE1LCAxMikgPwo+IC0JCQlHRU4xMl9PQVJfT0FD
T05UUk9MIDogR0VOOF9PQUNUWENPTlRST0wsCj4gLQkJCXN0cmVhbS0+cGVyZi0+Y3R4X29hY3R4
Y3RybF9vZmZzZXQgKyAxLAo+IC0JCX0sCj4gLQkJeyBFVV9QRVJGX0NOVEwwLCBjdHhfZmxleGV1
TigwKSB9LAo+IC0JCXsgRVVfUEVSRl9DTlRMMSwgY3R4X2ZsZXhldU4oMSkgfSwKPiAtCQl7IEVV
X1BFUkZfQ05UTDIsIGN0eF9mbGV4ZXVOKDIpIH0sCj4gLQkJeyBFVV9QRVJGX0NOVEwzLCBjdHhf
ZmxleGV1TigzKSB9LAo+IC0JCXsgRVVfUEVSRl9DTlRMNCwgY3R4X2ZsZXhldU4oNCkgfSwKPiAt
CQl7IEVVX1BFUkZfQ05UTDUsIGN0eF9mbGV4ZXVOKDUpIH0sCj4gLQkJeyBFVV9QRVJGX0NOVEw2
LCBjdHhfZmxleGV1Tig2KSB9LAo+IC0JfTsKPiAtI3VuZGVmIGN0eF9mbGV4ZXVOCj4gICAJc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwo+ICAgCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0
ICpjdHgsICpjbjsKPiAtCXNpemVfdCBhcnJheV9zaXplID0gSVNfR0VOKGk5MTUsIDEyKSA/IDIg
OiBBUlJBWV9TSVpFKHJlZ3MpOwo+IC0JaW50IGksIGVycjsKPiAtCj4gLQlpZiAoSVNfR0VOKGk5
MTUsIDEyKSkgewo+IC0JCXUzMiBmb3JtYXQgPSBzdHJlYW0tPm9hX2J1ZmZlci5mb3JtYXQ7Cj4g
LQo+IC0JCXJlZ3NbMV0udmFsdWUgPQo+IC0JCQkoZm9ybWF0IDw8IEdFTjEyX09BUl9PQUNPTlRS
T0xfQ09VTlRFUl9GT1JNQVRfU0hJRlQpIHwKPiAtCQkJKG9hX2NvbmZpZyA/IEdFTjEyX09BUl9P
QUNPTlRST0xfQ09VTlRFUl9FTkFCTEUgOiAwKTsKPiAtCX0gZWxzZSB7Cj4gLQkJcmVnc1sxXS52
YWx1ZSA9Cj4gLQkJCShzdHJlYW0tPnBlcmlvZF9leHBvbmVudCA8PCBHRU44X09BX1RJTUVSX1BF
UklPRF9TSElGVCkgfAo+IC0JCQkoc3RyZWFtLT5wZXJpb2RpYyA/IEdFTjhfT0FfVElNRVJfRU5B
QkxFIDogMCkgfAo+IC0JCQlHRU44X09BX0NPVU5URVJfUkVTVU1FOwo+IC0JfQo+IC0KPiAtCWZv
ciAoaSA9IDI7ICEhY3R4X2ZsZXhldTAgJiYgaSA8IGFycmF5X3NpemU7IGkrKykKPiAtCQlyZWdz
W2ldLnZhbHVlID0gb2FfY29uZmlnX2ZsZXhfcmVnKG9hX2NvbmZpZywgcmVnc1tpXS5yZWcpOwo+
ICsJaW50IGVycjsKPiAgIAo+ICAgCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJnN0cmVhbS0+cGVyZi0+
bG9jayk7Cj4gICAKPiBAQCAtMjM1NSw3ICsyMzI3LDcgQEAgc3RhdGljIGludCBscmNfY29uZmln
dXJlX2FsbF9jb250ZXh0cyhzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtLAo+ICAgCj4g
ICAJCXNwaW5fdW5sb2NrKCZpOTE1LT5nZW0uY29udGV4dHMubG9jayk7Cj4gICAKPiAtCQllcnIg
PSBnZW44X2NvbmZpZ3VyZV9jb250ZXh0KGN0eCwgcmVncywgYXJyYXlfc2l6ZSk7Cj4gKwkJZXJy
ID0gZ2VuOF9jb25maWd1cmVfY29udGV4dChjdHgsIHJlZ3MsIG51bV9yZWdzKTsKPiAgIAkJaWYg
KGVycikgewo+ICAgCQkJaTkxNV9nZW1fY29udGV4dF9wdXQoY3R4KTsKPiAgIAkJCXJldHVybiBl
cnI7Cj4gQEAgLTIzODAsNyArMjM1Miw3IEBAIHN0YXRpYyBpbnQgbHJjX2NvbmZpZ3VyZV9hbGxf
Y29udGV4dHMoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSwKPiAgIAo+ICAgCQlyZWdz
WzBdLnZhbHVlID0gaW50ZWxfc3NldV9tYWtlX3JwY3MoaTkxNSwgJmNlLT5zc2V1KTsKPiAgIAo+
IC0JCWVyciA9IGdlbjhfbW9kaWZ5X3NlbGYoY2UsIHJlZ3MsIGFycmF5X3NpemUpOwo+ICsJCWVy
ciA9IGdlbjhfbW9kaWZ5X3NlbGYoY2UsIHJlZ3MsIG51bV9yZWdzKTsKPiAgIAkJaWYgKGVycikK
PiAgIAkJCXJldHVybiBlcnI7Cj4gICAJfQo+IEBAIC0yMzg4LDYgKzIzNjAsNTYgQEAgc3RhdGlj
IGludCBscmNfY29uZmlndXJlX2FsbF9jb250ZXh0cyhzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAq
c3RyZWFtLAo+ICAgCXJldHVybiAwOwo+ICAgfQo+ICAgCj4gK3N0YXRpYyBpbnQgZ2VuMTJfY29u
ZmlndXJlX2FsbF9jb250ZXh0cyhzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtLAo+ICsJ
CQkJCWNvbnN0IHN0cnVjdCBpOTE1X29hX2NvbmZpZyAqb2FfY29uZmlnKQo+ICt7Cj4gKwlzdHJ1
Y3QgZmxleCByZWdzW10gPSB7Cj4gKwkJewo+ICsJCQlHRU44X1JfUFdSX0NMS19TVEFURSwKPiAr
CQkJQ1RYX1JfUFdSX0NMS19TVEFURSwKPiArCQl9LAo+ICsJfTsKCgoKCj4gKwo+ICsJcmV0dXJu
IG9hX2NvbmZpZ3VyZV9hbGxfY29udGV4dHMoc3RyZWFtLCByZWdzLCBBUlJBWV9TSVpFKHJlZ3Mp
KTsKPiArfQo+ICsKPiArc3RhdGljIGludCBscmNfY29uZmlndXJlX2FsbF9jb250ZXh0cyhzdHJ1
Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtLAo+ICsJCQkJICAgICAgY29uc3Qgc3RydWN0IGk5
MTVfb2FfY29uZmlnICpvYV9jb25maWcpCj4gK3sKPiArCS8qIFRoZSBNTUlPIG9mZnNldHMgZm9y
IEZsZXggRVUgcmVnaXN0ZXJzIGFyZW4ndCBjb250aWd1b3VzICovCj4gKwljb25zdCB1MzIgY3R4
X2ZsZXhldTAgPSBzdHJlYW0tPnBlcmYtPmN0eF9mbGV4ZXUwX29mZnNldDsKPiArI2RlZmluZSBj
dHhfZmxleGV1TihOKSAoY3R4X2ZsZXhldTAgKyAyICogKE4pICsgMSkKPiArCXN0cnVjdCBmbGV4
IHJlZ3NbXSA9IHsKPiArCQl7Cj4gKwkJCUdFTjhfUl9QV1JfQ0xLX1NUQVRFLAo+ICsJCQlDVFhf
Ul9QV1JfQ0xLX1NUQVRFLAo+ICsJCX0sCj4gKwkJewo+ICsJCQlHRU44X09BQ1RYQ09OVFJPTCwK
PiArCQkJc3RyZWFtLT5wZXJmLT5jdHhfb2FjdHhjdHJsX29mZnNldCArIDEsCj4gKwkJfSwKPiAr
CQl7IEVVX1BFUkZfQ05UTDAsIGN0eF9mbGV4ZXVOKDApIH0sCj4gKwkJeyBFVV9QRVJGX0NOVEwx
LCBjdHhfZmxleGV1TigxKSB9LAo+ICsJCXsgRVVfUEVSRl9DTlRMMiwgY3R4X2ZsZXhldU4oMikg
fSwKPiArCQl7IEVVX1BFUkZfQ05UTDMsIGN0eF9mbGV4ZXVOKDMpIH0sCj4gKwkJeyBFVV9QRVJG
X0NOVEw0LCBjdHhfZmxleGV1Tig0KSB9LAo+ICsJCXsgRVVfUEVSRl9DTlRMNSwgY3R4X2ZsZXhl
dU4oNSkgfSwKPiArCQl7IEVVX1BFUkZfQ05UTDYsIGN0eF9mbGV4ZXVOKDYpIH0sCj4gKwl9Owo+
ICsjdW5kZWYgY3R4X2ZsZXhldU4KPiArCWludCBpOwo+ICsKPiArCXJlZ3NbMV0udmFsdWUgPQo+
ICsJCShzdHJlYW0tPnBlcmlvZF9leHBvbmVudCA8PCBHRU44X09BX1RJTUVSX1BFUklPRF9TSElG
VCkgfAo+ICsJCShzdHJlYW0tPnBlcmlvZGljID8gR0VOOF9PQV9USU1FUl9FTkFCTEUgOiAwKSB8
Cj4gKwkJR0VOOF9PQV9DT1VOVEVSX1JFU1VNRTsKPiArCj4gKwlmb3IgKGkgPSAyOyBpIDwgQVJS
QVlfU0laRShyZWdzKTsgaSsrKQo+ICsJCXJlZ3NbaV0udmFsdWUgPSBvYV9jb25maWdfZmxleF9y
ZWcob2FfY29uZmlnLCByZWdzW2ldLnJlZyk7Cj4gKwo+ICsJcmV0dXJuIG9hX2NvbmZpZ3VyZV9h
bGxfY29udGV4dHMoc3RyZWFtLCByZWdzLCBBUlJBWV9TSVpFKHJlZ3MpKTsKPiArfQo+ICsKPiAg
IHN0YXRpYyBpbnQgZ2VuOF9lbmFibGVfbWV0cmljX3NldChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVh
bSAqc3RyZWFtKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IHN0cmVh
bS0+dW5jb3JlOwo+IEBAIC0yNDcxLDcgKzI0OTMsNyBAQCBzdGF0aWMgaW50IGdlbjEyX2VuYWJs
ZV9tZXRyaWNfc2V0KHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0pCj4gICAJICogdG8g
bWFrZSBzdXJlIGFsbCBzbGljZXMvc3Vic2xpY2VzIGFyZSBPTiBiZWZvcmUgd3JpdGluZyB0byBO
T0EKPiAgIAkgKiByZWdpc3RlcnMuCj4gICAJICovCj4gLQlyZXQgPSBscmNfY29uZmlndXJlX2Fs
bF9jb250ZXh0cyhzdHJlYW0sIG9hX2NvbmZpZyk7Cj4gKwlyZXQgPSBnZW4xMl9jb25maWd1cmVf
YWxsX2NvbnRleHRzKHN0cmVhbSwgb2FfY29uZmlnKTsKPiAgIAlpZiAocmV0KQo+ICAgCQlyZXR1
cm4gcmV0Owo+ICAgCj4gQEAgLTI0ODEsOCArMjUwMyw3IEBAIHN0YXRpYyBpbnQgZ2VuMTJfZW5h
YmxlX21ldHJpY19zZXQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSkKPiAgIAkgKiBy
ZXF1ZXN0ZWQgdGhpcy4KPiAgIAkgKi8KPiAgIAlpZiAoc3RyZWFtLT5jdHgpIHsKPiAtCQlyZXQg
PSBnZW4xMl9lbWl0X29hcl9jb25maWcoc3RyZWFtLT5waW5uZWRfY3R4LAo+IC0JCQkJCSAgICBv
YV9jb25maWcgIT0gTlVMTCk7Cj4gKwkJcmV0ID0gZ2VuMTJfY29uZmlndXJlX29hcl9jb250ZXh0
KHN0cmVhbSwgdHJ1ZSk7Cj4gICAJCWlmIChyZXQpCj4gICAJCQlyZXR1cm4gcmV0Owo+ICAgCX0K
PiBAQCAtMjUxNiwxMSArMjUzNywxMSBAQCBzdGF0aWMgdm9pZCBnZW4xMl9kaXNhYmxlX21ldHJp
Y19zZXQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSkKPiAgIAlzdHJ1Y3QgaW50ZWxf
dW5jb3JlICp1bmNvcmUgPSBzdHJlYW0tPnVuY29yZTsKPiAgIAo+ICAgCS8qIFJlc2V0IGFsbCBj
b250ZXh0cycgc2xpY2VzL3N1YnNsaWNlcyBjb25maWd1cmF0aW9ucy4gKi8KPiAtCWxyY19jb25m
aWd1cmVfYWxsX2NvbnRleHRzKHN0cmVhbSwgTlVMTCk7Cj4gKwlnZW4xMl9jb25maWd1cmVfYWxs
X2NvbnRleHRzKHN0cmVhbSwgTlVMTCk7Cj4gICAKPiAgIAkvKiBkaXNhYmxlIHRoZSBjb250ZXh0
IHNhdmUvcmVzdG9yZSBvciBPQVIgY291bnRlcnMgKi8KPiAgIAlpZiAoc3RyZWFtLT5jdHgpCj4g
LQkJZ2VuMTJfZW1pdF9vYXJfY29uZmlnKHN0cmVhbS0+cGlubmVkX2N0eCwgZmFsc2UpOwo+ICsJ
CWdlbjEyX2NvbmZpZ3VyZV9vYXJfY29udGV4dChzdHJlYW0sIGZhbHNlKTsKPiAgIAo+ICAgCS8q
IE1ha2Ugc3VyZSB3ZSBkaXNhYmxlIG5vYSB0byBzYXZlIHBvd2VyLiAqLwo+ICAgCWludGVsX3Vu
Y29yZV9ybXcodW5jb3JlLCBSUE1fQ09ORklHMSwgR0VOMTBfR1RfTk9BX0VOQUJMRSwgMCk7Cj4g
QEAgLTI4NjIsNyArMjg4MywxMSBAQCB2b2lkIGk5MTVfb2FfaW5pdF9yZWdfc3RhdGUoY29uc3Qg
c3RydWN0IGludGVsX2NvbnRleHQgKmNlLAo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAlzdHJlYW0g
PSBlbmdpbmUtPmk5MTUtPnBlcmYuZXhjbHVzaXZlX3N0cmVhbTsKPiAtCWlmIChzdHJlYW0pCj4g
KwkvKgo+ICsJICogRm9yIGdlbjEyLCBvbmx5IENUWF9SX1BXUl9DTEtfU1RBVEUgbmVlZHMgdXBk
YXRlLCBidXQgdGhlIGNhbGxlcgo+ICsJICogaXMgYWxyZWFkeSBkb2luZyB0aGF0LCBzbyBub3Ro
aW5nIHRvIGJlIGRvbmUgZm9yIGdlbjEyIGhlcmUuCj4gKwkgKi8KPiArCWlmIChzdHJlYW0gJiYg
SU5URUxfR0VOKHN0cmVhbS0+cGVyZi0+aTkxNSkgPCAxMikKPiAgIAkJZ2VuOF91cGRhdGVfcmVn
X3N0YXRlX3VubG9ja2VkKGNlLCBzdHJlYW0pOwo+ICAgfQo+ICAgCgoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJ
bnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Au
b3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 39810D766D
	for <lists+intel-gfx@lfdr.de>; Tue, 15 Oct 2019 14:23:19 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 471B26E7D2;
	Tue, 15 Oct 2019 12:23:17 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 83FA16E22C
 for <intel-gfx@lists.freedesktop.org>; Tue, 15 Oct 2019 12:23:08 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18843897-1500050 
 for multiple; Tue, 15 Oct 2019 13:22:54 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 15 Oct 2019 13:22:49 +0100
Message-Id: <20191015122250.28884-6-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191015122250.28884-1-chris@chris-wilson.co.uk>
References: <20191015122250.28884-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 6/7] drm/i915: Replace hangcheck by heartbeats
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UmVwbGFjZSBzYW1wbGluZyB0aGUgZW5naW5lIHN0YXRlIGV2ZXJ5IHNvIG9mdGVuIHdpdGggYSBw
ZXJpb2RpYwpoZWFydGJlYXQgcmVxdWVzdCB0byBtZWFzdXJlIHRoZSBoZWFsdGggb2YgYW4gZW5n
aW5lLiBUaGlzIGlzIGNvdXBsZWQKd2l0aCB0aGUgZm9yY2VkLXByZWVtcHRpb24gdG8gYWxsb3cg
bG9uZyBydW5uaW5nIHJlcXVlc3RzIHRvIHN1cnZpdmUgc28KbG9uZyBhcyB0aGV5IGRvIG5vdCBi
bG9jayBvdGhlciB1c2Vycy4KClRoZSBoZWFydGJlYXQgaW50ZXJ2YWwgY2FuIGJlIGFkanVzdGVk
IHBlci1lbmdpbmUgdXNpbmcsCgoJL3N5cy9jbGFzcy9kcm0vY2FyZD8vZW5naW5lLyovaGVhcnRi
ZWF0X2ludGVydmFsX21zCgp2MjogQ291cGxlIGluIHN5c2ZzIGNvbnRyb2xzCgpTaWduZWQtb2Zm
LWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KQ2M6IEpvb25hcyBM
YWh0aW5lbiA8am9vbmFzLmxhaHRpbmVuQGxpbnV4LmludGVsLmNvbT4KQ2M6IFR2cnRrbyBVcnN1
bGluIDx0dnJ0a28udXJzdWxpbkBpbnRlbC5jb20+CkNjOiBKb24gQmxvb21maWVsZCA8am9uLmJs
b29tZmllbGRAaW50ZWwuY29tPgpSZXZpZXdlZC1ieTogSm9uIEJsb29tZmllbGQgPGpvbi5ibG9v
bWZpZWxkQGludGVsLmNvbT4KUmV2aWV3ZWQtYnk6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJz
dWxpbkBpbnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvS2NvbmZpZy5wcm9maWxl
ICAgICAgICAgIHwgIDE0ICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlICAgICAgICAg
ICAgICAgICB8ICAgMSAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3Bs
YXkuYyAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3Qu
aCAgICB8ICAgMSAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYyAgICAg
ICAgfCAgIDIgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lLmggICAgICAg
IHwgIDMyIC0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYyAgICAg
fCAgMTEgKy0KIC4uLi9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2hlYXJ0YmVhdC5jICB8
IDEyOCArKysrKysrCiAuLi4vZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQu
aCAgfCAgIDUgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMgICAg
IHwgICA1ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfc3lzZnMuYyAg
fCAgNDcgKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaCAg
fCAgMTcgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmMgICAgICAgICAgICB8
ICAgMSAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5oICAgICAgICAgICAgfCAg
IDQgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYyAgICAgICAgIHwgICAx
IC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3R5cGVzLmggICAgICB8ICAgOSAt
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5nY2hlY2suYyAgICAgfCAzNjEgLS0t
LS0tLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jICAg
ICAgICAgfCAgIDMgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVj
ay5jICB8ICAgNCAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYyAgICAgICAg
ICAgfCAgODcgLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgICAgICAgICAg
ICAgICB8ICAgMyAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oICAgICAgICAgICAg
ICAgfCAgIDEgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuYyAgICAgICAg
IHwgIDMzICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5oICAgICAgICAg
fCAgIDIgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wcmlvbGlzdF90eXBlcy5oICAgIHwg
ICA2ICsKIDI1IGZpbGVzIGNoYW5nZWQsIDIyNSBpbnNlcnRpb25zKCspLCA1NTUgZGVsZXRpb25z
KC0pCiBkZWxldGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfaGFu
Z2NoZWNrLmMKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9LY29uZmlnLnByb2Zp
bGUgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9LY29uZmlnLnByb2ZpbGUKaW5kZXggOGZjZWVhODU5
MzdiLi40YmVkMjkzZTFmYjQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L0tjb25m
aWcucHJvZmlsZQorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9LY29uZmlnLnByb2ZpbGUKQEAg
LTQwLDMgKzQwLDE3IEBAIGNvbmZpZyBEUk1fSTkxNV9QUkVFTVBUX1RJTUVPVVQKIAkgIC9zeXMv
Y2xhc3MvZHJtL2NhcmQ/L2VuZ2luZS8qL3ByZWVtcHRfdGltZW91dF9tcwogCiAJICBNYXkgYmUg
MCB0byBkaXNhYmxlIHRoZSB0aW1lb3V0LgorCitjb25maWcgRFJNX0k5MTVfSEVBUlRCRUFUX0lO
VEVSVkFMCisJaW50ICJJbnRlcnZhbCBiZXR3ZWVuIGhlYXJ0YmVhdCBwdWxzZXMgKG1zKSIKKwlk
ZWZhdWx0IDI1MDAgIyBtaWxsaXNlY29uZHMKKwloZWxwCisJICBUaGUgZHJpdmVyIHNlbmRzIGEg
cGVyaW9kaWMgaGVhcnRiZWF0IGRvd24gYWxsIGFjdGl2ZSBlbmdpbmVzIHRvCisJICBjaGVjayB0
aGUgaGVhbHRoIG9mIHRoZSBHUFUgYW5kIHVuZGVydGFrZSByZWd1bGFyIGhvdXNlLWtlZXBpbmcg
b2YKKwkgIGludGVybmFsIGRyaXZlciBzdGF0ZS4KKworCSAgVGhpcyBpcyBhZGp1c3RhYmxlIHZp
YQorCSAgL3N5cy9jbGFzcy9kcm0vY2FyZD8vZW5naW5lLyovaGVhcnRiZWF0X2ludGVydmFsX21z
CisKKwkgIE1heSBiZSAwIHRvIGRpc2FibGUgaGVhcnRiZWF0cyBhbmQgdGhlcmVmb3JlIGRpc2Fi
bGUgYXV0b21hdGljIEdQVQorCSAgaGFuZyBkZXRlY3Rpb24uCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCmlu
ZGV4IGNmYWI3Yzg1ODViMy4uNTlkMzU2Y2M0MDZjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQpAQCAt
ODgsNyArODgsNiBAQCBndC15ICs9IFwKIAlndC9pbnRlbF9ndF9wbS5vIFwKIAlndC9pbnRlbF9n
dF9wbV9pcnEubyBcCiAJZ3QvaW50ZWxfZ3RfcmVxdWVzdHMubyBcCi0JZ3QvaW50ZWxfaGFuZ2No
ZWNrLm8gXAogCWd0L2ludGVsX2xyYy5vIFwKIAlndC9pbnRlbF9yYzYubyBcCiAJZ3QvaW50ZWxf
cmVuZGVyc3RhdGUubyBcCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2Rpc3BsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlz
cGxheS5jCmluZGV4IDNjZjM5ZmMxNTNiMy4uYTJlZjRiY2Y5MjQyIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwpAQCAtMTQ0MDEsNyArMTQ0MDEsNyBA
QCBzdGF0aWMgdm9pZCBpbnRlbF9wbGFuZV91bnBpbl9mYihzdHJ1Y3QgaW50ZWxfcGxhbmVfc3Rh
dGUgKm9sZF9wbGFuZV9zdGF0ZSkKIHN0YXRpYyB2b2lkIGZiX29ial9idW1wX3JlbmRlcl9wcmlv
cml0eShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogewogCXN0cnVjdCBpOTE1X3Nj
aGVkX2F0dHIgYXR0ciA9IHsKLQkJLnByaW9yaXR5ID0gSTkxNV9QUklPUklUWV9ESVNQTEFZLAor
CQkucHJpb3JpdHkgPSBJOTE1X1VTRVJfUFJJT1JJVFkoSTkxNV9QUklPUklUWV9ESVNQTEFZKSwK
IAl9OwogCiAJaTkxNV9nZW1fb2JqZWN0X3dhaXRfcHJpb3JpdHkob2JqLCAwLCAmYXR0cik7CmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmggYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmgKaW5kZXggYzVlMTRjOWM4
MDVjLi41YmQ1MWUzOTczNzEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9vYmplY3QuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
b2JqZWN0LmgKQEAgLTQ2MCw2ICs0NjAsNSBAQCBpbnQgaTkxNV9nZW1fb2JqZWN0X3dhaXQoc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIGludCBpOTE1X2dlbV9vYmplY3Rfd2FpdF9w
cmlvcml0eShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCQkJCSAgdW5zaWduZWQg
aW50IGZsYWdzLAogCQkJCSAgY29uc3Qgc3RydWN0IGk5MTVfc2NoZWRfYXR0ciAqYXR0cik7Ci0j
ZGVmaW5lIEk5MTVfUFJJT1JJVFlfRElTUExBWSBJOTE1X1VTRVJfUFJJT1JJVFkoSTkxNV9QUklP
UklUWV9NQVgpCiAKICNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYwpp
bmRleCA3OTg3YjU0ZmIxZjUuLjBlOTc1MjBjYjFiYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX3BtLmMKQEAgLTEwMCw4ICsxMDAsNiBAQCB2b2lkIGk5MTVfZ2VtX3N1c3BlbmQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJaW50ZWxfZ3Rfc3VzcGVuZCgmaTkxNS0+
Z3QpOwogCWludGVsX3VjX3N1c3BlbmQoJmk5MTUtPmd0LnVjKTsKIAotCWNhbmNlbF9kZWxheWVk
X3dvcmtfc3luYygmaTkxNS0+Z3QuaGFuZ2NoZWNrLndvcmspOwotCiAJaTkxNV9nZW1fZHJhaW5f
ZnJlZWRfb2JqZWN0cyhpOTE1KTsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZW5naW5lLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdp
bmUuaAppbmRleCA5M2VhMzY3ZmU2MjQuLjhhZDU3ZWFjZTM1MSAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZW5naW5lLmgKQEAgLTg5LDM4ICs4OSw2IEBAIHN0cnVjdCBkcm1fcHJpbnRl
cjsKIC8qIHNlcW5vIHNpemUgaXMgYWN0dWFsbHkgb25seSBhIHVpbnQzMiwgYnV0IHNpbmNlIHdl
IHBsYW4gdG8gdXNlIE1JX0ZMVVNIX0RXIHRvCiAgKiBkbyB0aGUgd3JpdGVzLCBhbmQgdGhhdCBt
dXN0IGhhdmUgcXcgYWxpZ25lZCBvZmZzZXRzLCBzaW1wbHkgcHJldGVuZCBpdCdzIDhiLgogICov
Ci1lbnVtIGludGVsX2VuZ2luZV9oYW5nY2hlY2tfYWN0aW9uIHsKLQlFTkdJTkVfSURMRSA9IDAs
Ci0JRU5HSU5FX1dBSVQsCi0JRU5HSU5FX0FDVElWRV9TRVFOTywKLQlFTkdJTkVfQUNUSVZFX0hF
QUQsCi0JRU5HSU5FX0FDVElWRV9TVUJVTklUUywKLQlFTkdJTkVfV0FJVF9LSUNLLAotCUVOR0lO
RV9ERUFELAotfTsKLQotc3RhdGljIGlubGluZSBjb25zdCBjaGFyICoKLWhhbmdjaGVja19hY3Rp
b25fdG9fc3RyKGNvbnN0IGVudW0gaW50ZWxfZW5naW5lX2hhbmdjaGVja19hY3Rpb24gYSkKLXsK
LQlzd2l0Y2ggKGEpIHsKLQljYXNlIEVOR0lORV9JRExFOgotCQlyZXR1cm4gImlkbGUiOwotCWNh
c2UgRU5HSU5FX1dBSVQ6Ci0JCXJldHVybiAid2FpdCI7Ci0JY2FzZSBFTkdJTkVfQUNUSVZFX1NF
UU5POgotCQlyZXR1cm4gImFjdGl2ZSBzZXFubyI7Ci0JY2FzZSBFTkdJTkVfQUNUSVZFX0hFQUQ6
Ci0JCXJldHVybiAiYWN0aXZlIGhlYWQiOwotCWNhc2UgRU5HSU5FX0FDVElWRV9TVUJVTklUUzoK
LQkJcmV0dXJuICJhY3RpdmUgc3VidW5pdHMiOwotCWNhc2UgRU5HSU5FX1dBSVRfS0lDSzoKLQkJ
cmV0dXJuICJ3YWl0IGtpY2siOwotCWNhc2UgRU5HSU5FX0RFQUQ6Ci0JCXJldHVybiAiZGVhZCI7
Ci0JfQotCi0JcmV0dXJuICJ1bmtub3duIjsKLX0KIAogc3RhdGljIGlubGluZSB1bnNpZ25lZCBp
bnQKIGV4ZWNsaXN0c19udW1fcG9ydHMoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9leGVjbGlz
dHMgKiBjb25zdCBleGVjbGlzdHMpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9lbmdpbmVfY3MuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2lu
ZV9jcy5jCmluZGV4IGJjZmNjZDUyMTFlNy4uYWYyNzAxMDQxOTg4IDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYwpAQCAtMzA1LDYgKzMwNSw3IEBAIHN0YXRpYyBp
bnQgaW50ZWxfZW5naW5lX3NldHVwKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGVudW0gaW50ZWxfZW5n
aW5lX2lkIGlkKQogCV9fc3ByaW50X2VuZ2luZV9uYW1lKGVuZ2luZSk7CiAKIAllbmdpbmUtPnBy
b3BzLnByZWVtcHRfdGltZW91dCA9IENPTkZJR19EUk1fSTkxNV9QUkVFTVBUX1RJTUVPVVQ7CisJ
ZW5naW5lLT5wcm9wcy5oZWFydGJlYXRfaW50ZXJ2YWwgPSBDT05GSUdfRFJNX0k5MTVfSEVBUlRC
RUFUX0lOVEVSVkFMOwogCiAJLyoKIAkgKiBUbyBiZSBvdmVycmlkZGVuIGJ5IHRoZSBiYWNrZW5k
IG9uIHNldHVwLiBIb3dldmVyIHRvIGZhY2lsaXRhdGUKQEAgLTU5OSw3ICs2MDAsNiBAQCBzdGF0
aWMgaW50IGludGVsX2VuZ2luZV9zZXR1cF9jb21tb24oc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lKQogCWludGVsX2VuZ2luZV9pbml0X2FjdGl2ZShlbmdpbmUsIEVOR0lORV9QSFlTSUNB
TCk7CiAJaW50ZWxfZW5naW5lX2luaXRfYnJlYWRjcnVtYnMoZW5naW5lKTsKIAlpbnRlbF9lbmdp
bmVfaW5pdF9leGVjbGlzdHMoZW5naW5lKTsKLQlpbnRlbF9lbmdpbmVfaW5pdF9oYW5nY2hlY2so
ZW5naW5lKTsKIAlpbnRlbF9lbmdpbmVfaW5pdF9jbWRfcGFyc2VyKGVuZ2luZSk7CiAJaW50ZWxf
ZW5naW5lX2luaXRfX3BtKGVuZ2luZSk7CiAKQEAgLTE0MzMsOCArMTQzMywxMyBAQCB2b2lkIGlu
dGVsX2VuZ2luZV9kdW1wKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAkJZHJtX3By
aW50ZihtLCAiKioqIFdFREdFRCAqKipcbiIpOwogCiAJZHJtX3ByaW50ZihtLCAiXHRBd2FrZT8g
JWRcbiIsIGF0b21pY19yZWFkKCZlbmdpbmUtPndha2VyZWYuY291bnQpKTsKLQlkcm1fcHJpbnRm
KG0sICJcdEhhbmdjaGVjazogJWQgbXMgYWdvXG4iLAotCQkgICBqaWZmaWVzX3RvX21zZWNzKGpp
ZmZpZXMgLSBlbmdpbmUtPmhhbmdjaGVjay5hY3Rpb25fdGltZXN0YW1wKSk7CisKKwlyY3VfcmVh
ZF9sb2NrKCk7CisJcnEgPSBSRUFEX09OQ0UoZW5naW5lLT5oZWFydGJlYXQuc3lzdG9sZSk7CisJ
aWYgKHJxKQorCQlkcm1fcHJpbnRmKG0sICJcdEhlYXJ0YmVhdDogJWQgbXMgYWdvXG4iLAorCQkJ
ICAgamlmZmllc190b19tc2VjcyhqaWZmaWVzIC0gcnEtPmVtaXR0ZWRfamlmZmllcykpOworCXJj
dV9yZWFkX3VubG9jaygpOwogCWRybV9wcmludGYobSwgIlx0UmVzZXQgY291bnQ6ICVkIChnbG9i
YWwgJWQpXG4iLAogCQkgICBpOTE1X3Jlc2V0X2VuZ2luZV9jb3VudChlcnJvciwgZW5naW5lKSwK
IAkJICAgaTkxNV9yZXNldF9jb3VudChlcnJvcikpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2hlYXJ0YmVhdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZW5naW5lX2hlYXJ0YmVhdC5jCmluZGV4IDJmYzQxM2Y5ZDUwNi4uM2E0MzYx
ODY5M2Q0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVf
aGVhcnRiZWF0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2hl
YXJ0YmVhdC5jCkBAIC0xMSw2ICsxMSwyNyBAQAogI2luY2x1ZGUgImludGVsX2VuZ2luZV9wbS5o
IgogI2luY2x1ZGUgImludGVsX2VuZ2luZS5oIgogI2luY2x1ZGUgImludGVsX2d0LmgiCisjaW5j
bHVkZSAiaW50ZWxfcmVzZXQuaCIKKworLyoKKyAqIFdoaWxlIHRoZSBlbmdpbmUgaXMgYWN0aXZl
LCB3ZSBzZW5kIGEgcGVyaW9kaWMgcHVsc2UgYWxvbmcgdGhlIGVuZ2luZQorICogdG8gY2hlY2sg
b24gaXRzIGhlYWx0aCBhbmQgdG8gZmx1c2ggYW55IGlkbGUtYmFycmllcnMuIElmIHRoYXQgcmVx
dWVzdAorICogaXMgc3R1Y2ssIGFuZCB3ZSBmYWlsIHRvIHByZWVtcHQgaXQsIHdlIGRlY2xhcmUg
dGhlIGVuZ2luZSBodW5nIGFuZAorICogaXNzdWUgYSByZXNldCAtLSBpbiB0aGUgaG9wZSB0aGF0
IHJlc3RvcmVzIHByb2dyZXNzLgorICovCisKK3N0YXRpYyB2b2lkIG5leHRfaGVhcnRiZWF0KHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlsb25nIGRlbGF5OworCisJZGVsYXkg
PSBSRUFEX09OQ0UoZW5naW5lLT5wcm9wcy5oZWFydGJlYXRfaW50ZXJ2YWwpOworCWlmICghZGVs
YXkpCisJCXJldHVybjsKKworCWRlbGF5ID0gbXNlY3NfdG9famlmZmllc190aW1lb3V0KGRlbGF5
KTsKKwlzY2hlZHVsZV9kZWxheWVkX3dvcmsoJmVuZ2luZS0+aGVhcnRiZWF0LndvcmssCisJCQkg
ICAgICByb3VuZF9qaWZmaWVzX3VwX3JlbGF0aXZlKGRlbGF5KSk7Cit9CiAKIHN0YXRpYyB2b2lk
IGlkbGVfcHVsc2Uoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICpycSkKIHsKQEAgLTE4LDYgKzM5LDExMyBAQCBzdGF0aWMgdm9pZCBpZGxlX3B1bHNl
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEp
CiAJaTkxNV9yZXF1ZXN0X2FkZF9hY3RpdmVfYmFycmllcnMocnEpOwogfQogCitzdGF0aWMgdm9p
ZCBzaG93X2hlYXJ0YmVhdChjb25zdCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKKwkJCSAgIHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlzdHJ1Y3QgZHJtX3ByaW50ZXIgcCA9
IGRybV9kZWJ1Z19wcmludGVyKCJoZWFydGJlYXQiKTsKKworCWludGVsX2VuZ2luZV9kdW1wKGVu
Z2luZSwgJnAsCisJCQkgICIlcyBoZWFydGJlYXQge3ByaW86JWR9IG5vdCB0aWNraW5nXG4iLAor
CQkJICBlbmdpbmUtPm5hbWUsCisJCQkgIHJxLT5zY2hlZC5hdHRyLnByaW9yaXR5KTsKK30KKwor
c3RhdGljIHZvaWQgaGVhcnRiZWF0KHN0cnVjdCB3b3JrX3N0cnVjdCAqd3JrKQoreworCXN0cnVj
dCBpOTE1X3NjaGVkX2F0dHIgYXR0ciA9IHsKKwkJLnByaW9yaXR5ID0gSTkxNV9VU0VSX1BSSU9S
SVRZKEk5MTVfUFJJT1JJVFlfTUlOKSwKKwl9OworCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSA9CisJCWNvbnRhaW5lcl9vZih3cmssIHR5cGVvZigqZW5naW5lKSwgaGVhcnRiZWF0Lndv
cmsud29yayk7CisJc3RydWN0IGludGVsX2NvbnRleHQgKmNlID0gZW5naW5lLT5rZXJuZWxfY29u
dGV4dDsKKwlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKKworCWlmICghaW50ZWxfZW5naW5lX3Bt
X2dldF9pZl9hd2FrZShlbmdpbmUpKQorCQlyZXR1cm47CisKKwlycSA9IGVuZ2luZS0+aGVhcnRi
ZWF0LnN5c3RvbGU7CisJaWYgKHJxICYmIGk5MTVfcmVxdWVzdF9jb21wbGV0ZWQocnEpKSB7CisJ
CWk5MTVfcmVxdWVzdF9wdXQocnEpOworCQllbmdpbmUtPmhlYXJ0YmVhdC5zeXN0b2xlID0gTlVM
TDsKKwl9CisKKwlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKGVuZ2luZS0+Z3QpKQorCQlnb3RvIG91
dDsKKworCWlmIChlbmdpbmUtPmhlYXJ0YmVhdC5zeXN0b2xlKSB7CisJCWlmIChlbmdpbmUtPnNj
aGVkdWxlICYmCisJCSAgICBycS0+c2NoZWQuYXR0ci5wcmlvcml0eSA8IEk5MTVfUFJJT1JJVFlf
QkFSUklFUikgeworCQkJLyoKKwkJCSAqIEdyYWR1YWxseSByYWlzZSB0aGUgcHJpb3JpdHkgb2Yg
dGhlIGhlYXJ0YmVhdCB0bworCQkJICogZ2l2ZSBoaWdoIHByaW9yaXR5IHdvcmsgW3doaWNoIHBy
ZXN1bWFibHkgZGVzaXJlcworCQkJICogbG93IGxhdGVuY3kgYW5kIG5vIGppdHRlcl0gdGhlIGNo
YW5jZSB0byBuYXR1cmFsbHkKKwkJCSAqIGNvbXBsZXRlIGJlZm9yZSBiZWluZyBwcmVlbXB0ZWQu
CisJCQkgKi8KKwkJCWF0dHIucHJpb3JpdHkgPSBJOTE1X1BSSU9SSVRZX01BU0s7CisJCQlpZiAo
cnEtPnNjaGVkLmF0dHIucHJpb3JpdHkgPj0gYXR0ci5wcmlvcml0eSkKKwkJCQlhdHRyLnByaW9y
aXR5IHw9IEk5MTVfVVNFUl9QUklPUklUWShJOTE1X1BSSU9SSVRZX0hFQVJUQkVBVCk7CisJCQlp
ZiAocnEtPnNjaGVkLmF0dHIucHJpb3JpdHkgPj0gYXR0ci5wcmlvcml0eSkKKwkJCQlhdHRyLnBy
aW9yaXR5ID0gSTkxNV9QUklPUklUWV9CQVJSSUVSOworCisJCQlsb2NhbF9iaF9kaXNhYmxlKCk7
CisJCQllbmdpbmUtPnNjaGVkdWxlKHJxLCAmYXR0cik7CisJCQlsb2NhbF9iaF9lbmFibGUoKTsK
KwkJfSBlbHNlIHsKKwkJCWlmIChJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9ERUJVR19HRU0p
KQorCQkJCXNob3dfaGVhcnRiZWF0KHJxLCBlbmdpbmUpOworCisJCQlpbnRlbF9ndF9oYW5kbGVf
ZXJyb3IoZW5naW5lLT5ndCwgZW5naW5lLT5tYXNrLAorCQkJCQkgICAgICBJOTE1X0VSUk9SX0NB
UFRVUkUsCisJCQkJCSAgICAgICJzdG9wcGVkIGhlYXJ0YmVhdCBvbiAlcyIsCisJCQkJCSAgICAg
IGVuZ2luZS0+bmFtZSk7CisJCX0KKwkJZ290byBvdXQ7CisJfQorCisJaWYgKGVuZ2luZS0+d2Fr
ZXJlZl9zZXJpYWwgPT0gZW5naW5lLT5zZXJpYWwpCisJCWdvdG8gb3V0OworCisJbXV0ZXhfbG9j
aygmY2UtPnRpbWVsaW5lLT5tdXRleCk7CisKKwlpbnRlbF9jb250ZXh0X2VudGVyKGNlKTsKKwly
cSA9IF9faTkxNV9yZXF1ZXN0X2NyZWF0ZShjZSwgR0ZQX05PV0FJVCB8IF9fR0ZQX05PV0FSTik7
CisJaW50ZWxfY29udGV4dF9leGl0KGNlKTsKKwlpZiAoSVNfRVJSKHJxKSkKKwkJZ290byB1bmxv
Y2s7CisKKwlpZGxlX3B1bHNlKGVuZ2luZSwgcnEpOworCWlmIChpOTE1X21vZHBhcmFtcy5lbmFi
bGVfaGFuZ2NoZWNrKQorCQllbmdpbmUtPmhlYXJ0YmVhdC5zeXN0b2xlID0gaTkxNV9yZXF1ZXN0
X2dldChycSk7CisKKwlfX2k5MTVfcmVxdWVzdF9jb21taXQocnEpOworCV9faTkxNV9yZXF1ZXN0
X3F1ZXVlKHJxLCAmYXR0cik7CisKK3VubG9jazoKKwltdXRleF91bmxvY2soJmNlLT50aW1lbGlu
ZS0+bXV0ZXgpOworb3V0OgorCW5leHRfaGVhcnRiZWF0KGVuZ2luZSk7CisJaW50ZWxfZW5naW5l
X3BtX3B1dChlbmdpbmUpOworfQorCit2b2lkIGludGVsX2VuZ2luZV91bnBhcmtfaGVhcnRiZWF0
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlpZiAoIUNPTkZJR19EUk1fSTkx
NV9IRUFSVEJFQVRfSU5URVJWQUwpCisJCXJldHVybjsKKworCW5leHRfaGVhcnRiZWF0KGVuZ2lu
ZSk7Cit9CisKK3ZvaWQgaW50ZWxfZW5naW5lX3BhcmtfaGVhcnRiZWF0KHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSkKK3sKKwljYW5jZWxfZGVsYXllZF93b3JrKCZlbmdpbmUtPmhlYXJ0
YmVhdC53b3JrKTsKKwlpOTE1X3JlcXVlc3RfcHV0KGZldGNoX2FuZF96ZXJvKCZlbmdpbmUtPmhl
YXJ0YmVhdC5zeXN0b2xlKSk7Cit9CisKK3ZvaWQgaW50ZWxfZW5naW5lX2luaXRfaGVhcnRiZWF0
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlJTklUX0RFTEFZRURfV09SSygm
ZW5naW5lLT5oZWFydGJlYXQud29yaywgaGVhcnRiZWF0KTsKK30KKwogaW50IGludGVsX2VuZ2lu
ZV9wdWxzZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7CiAJc3RydWN0IGk5MTVf
c2NoZWRfYXR0ciBhdHRyID0geyAucHJpb3JpdHkgPSBJOTE1X1BSSU9SSVRZX0JBUlJJRVIgfTsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9oZWFydGJl
YXQuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQuaApp
bmRleCBiOTUwNDUxYjU5OTguLjM5MzkxMDA0NTU0ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2hlYXJ0YmVhdC5oCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQuaApAQCAtOSw2ICs5LDExIEBACiAKIHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3M7CiAKK3ZvaWQgaW50ZWxfZW5naW5lX2luaXRfaGVhcnRiZWF0
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7CisKK3ZvaWQgaW50ZWxfZW5naW5lX3Bh
cmtfaGVhcnRiZWF0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7Cit2b2lkIGludGVs
X2VuZ2luZV91bnBhcmtfaGVhcnRiZWF0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7
CisKIGludCBpbnRlbF9lbmdpbmVfcHVsc2Uoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KTsKIAogI2VuZGlmIC8qIElOVEVMX0VOR0lORV9IRUFSVEJFQVRfSCAqLwpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uYwppbmRleCA3ZDc2NjExZDlkZjEuLjZmYmZhMjE2
MmU1NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bt
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMKQEAgLTcs
NiArNyw3IEBACiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKIAogI2luY2x1ZGUgImludGVsX2VuZ2lu
ZS5oIgorI2luY2x1ZGUgImludGVsX2VuZ2luZV9oZWFydGJlYXQuaCIKICNpbmNsdWRlICJpbnRl
bF9lbmdpbmVfcG0uaCIKICNpbmNsdWRlICJpbnRlbF9lbmdpbmVfcG9vbC5oIgogI2luY2x1ZGUg
ImludGVsX2d0LmgiCkBAIC0zNCw3ICszNSw3IEBAIHN0YXRpYyBpbnQgX19lbmdpbmVfdW5wYXJr
KHN0cnVjdCBpbnRlbF93YWtlcmVmICp3ZikKIAlpZiAoZW5naW5lLT51bnBhcmspCiAJCWVuZ2lu
ZS0+dW5wYXJrKGVuZ2luZSk7CiAKLQlpbnRlbF9lbmdpbmVfaW5pdF9oYW5nY2hlY2soZW5naW5l
KTsKKwlpbnRlbF9lbmdpbmVfdW5wYXJrX2hlYXJ0YmVhdChlbmdpbmUpOwogCXJldHVybiAwOwog
fQogCkBAIC0xNTgsNiArMTU5LDcgQEAgc3RhdGljIGludCBfX2VuZ2luZV9wYXJrKHN0cnVjdCBp
bnRlbF93YWtlcmVmICp3ZikKIAogCWNhbGxfaWRsZV9iYXJyaWVycyhlbmdpbmUpOyAvKiBjbGVh
bnVwIGFmdGVyIHdlZGdpbmcgKi8KIAorCWludGVsX2VuZ2luZV9wYXJrX2hlYXJ0YmVhdChlbmdp
bmUpOwogCWludGVsX2VuZ2luZV9kaXNhcm1fYnJlYWRjcnVtYnMoZW5naW5lKTsKIAlpbnRlbF9l
bmdpbmVfcG9vbF9wYXJrKCZlbmdpbmUtPnBvb2wpOwogCkBAIC0xODgsNiArMTkwLDcgQEAgdm9p
ZCBpbnRlbF9lbmdpbmVfaW5pdF9fcG0oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQog
CXN0cnVjdCBpbnRlbF9ydW50aW1lX3BtICpycG0gPSBlbmdpbmUtPnVuY29yZS0+cnBtOwogCiAJ
aW50ZWxfd2FrZXJlZl9pbml0KCZlbmdpbmUtPndha2VyZWYsIHJwbSwgJndmX29wcyk7CisJaW50
ZWxfZW5naW5lX2luaXRfaGVhcnRiZWF0KGVuZ2luZSk7CiB9CiAKICNpZiBJU19FTkFCTEVEKENP
TkZJR19EUk1fSTkxNV9TRUxGVEVTVCkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2VuZ2luZV9zeXNmcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
ZW5naW5lX3N5c2ZzLmMKaW5kZXggMWFhZTgzZWI0MjM3Li5lYTFiZmRiMTBiODIgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9zeXNmcy5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9zeXNmcy5jCkBAIC05LDYgKzksOCBA
QAogCiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKICNpbmNsdWRlICJpbnRlbF9lbmdpbmUuaCIKKyNp
bmNsdWRlICJpbnRlbF9lbmdpbmVfaGVhcnRiZWF0LmgiCisjaW5jbHVkZSAiaW50ZWxfZW5naW5l
X3BtLmgiCiAjaW5jbHVkZSAiaW50ZWxfZW5naW5lX3N5c2ZzLmgiCiAKIHN0cnVjdCBrb2JqX2Vu
Z2luZSB7CkBAIC0xNjEsNiArMTYzLDQ4IEBAIHByZWVtcHRfdGltZW91dF9zdG9yZShzdHJ1Y3Qg
a29iamVjdCAqa29iaiwgc3RydWN0IGtvYmpfYXR0cmlidXRlICphdHRyLAogc3RhdGljIHN0cnVj
dCBrb2JqX2F0dHJpYnV0ZSBwcmVlbXB0X3RpbWVvdXRfYXR0ciA9CiBfX0FUVFIocHJlZW1wdF90
aW1lb3V0X21zLCAwNjQ0LCBwcmVlbXB0X3RpbWVvdXRfc2hvdywgcHJlZW1wdF90aW1lb3V0X3N0
b3JlKTsKIAorc3RhdGljIHNzaXplX3QKK2hlYXJ0YmVhdF9pbnRlcnZhbF9zaG93KHN0cnVjdCBr
b2JqZWN0ICprb2JqLCBzdHJ1Y3Qga29ial9hdHRyaWJ1dGUgKmF0dHIsCisJCQljaGFyICpidWYp
Cit7CisJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lID0ga29ial90b19lbmdpbmUoa29i
aik7CisKKwlyZXR1cm4gc3ByaW50ZihidWYsICIlbHVcbiIsIGVuZ2luZS0+cHJvcHMuaGVhcnRi
ZWF0X2ludGVydmFsKTsKK30KKworc3RhdGljIHNzaXplX3QKK2hlYXJ0YmVhdF9pbnRlcnZhbF9z
dG9yZShzdHJ1Y3Qga29iamVjdCAqa29iaiwgc3RydWN0IGtvYmpfYXR0cmlidXRlICphdHRyLAor
CQkJIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGNvdW50KQoreworCXN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSA9IGtvYmpfdG9fZW5naW5lKGtvYmopOworCXVuc2lnbmVkIGxvbmcgZGVs
YXk7CisJaW50IGVycjsKKworCWVyciA9IGtzdHJ0b3VsKGJ1ZiwgMCwgJmRlbGF5KTsKKwlpZiAo
ZXJyKQorCQlyZXR1cm4gZXJyOworCisJLyogU2VuZCBvbmUgbGFzdCBwdWxzZSBiZWZvcmUgdG8g
Y2xlYW51cCBwZXJzaXN0ZW50IGhvZ3MgKi8KKwlpZiAoIWRlbGF5ICYmIENPTkZJR19EUk1fSTkx
NV9QUkVFTVBUX1RJTUVPVVQpIHsKKwkJZXJyID0gaW50ZWxfZW5naW5lX3B1bHNlKGVuZ2luZSk7
CisJCWlmIChlcnIpCisJCQlyZXR1cm4gZXJyOworCX0KKworCVdSSVRFX09OQ0UoZW5naW5lLT5w
cm9wcy5oZWFydGJlYXRfaW50ZXJ2YWwsIGRlbGF5KTsKKworCWlmIChkZWxheSAmJiBpbnRlbF9l
bmdpbmVfcG1fZ2V0X2lmX2F3YWtlKGVuZ2luZSkpIHsKKwkJaW50ZWxfZW5naW5lX3VucGFya19o
ZWFydGJlYXQoZW5naW5lKTsKKwkJaW50ZWxfZW5naW5lX3BtX3B1dChlbmdpbmUpOworCX0KKwor
CXJldHVybiBjb3VudDsKK30KKworc3RhdGljIHN0cnVjdCBrb2JqX2F0dHJpYnV0ZSBoZWFydGJl
YXRfaW50ZXJ2YWxfYXR0ciA9CitfX0FUVFIoaGVhcnRiZWF0X2ludGVydmFsX21zLCAwNjQ0LAor
ICAgICAgIGhlYXJ0YmVhdF9pbnRlcnZhbF9zaG93LCBoZWFydGJlYXRfaW50ZXJ2YWxfc3RvcmUp
OworCiBzdGF0aWMgdm9pZCBrb2JqX2VuZ2luZV9yZWxlYXNlKHN0cnVjdCBrb2JqZWN0ICprb2Jq
KQogewogCWtmcmVlKGtvYmopOwpAQCAtMjAwLDYgKzI0NCw5IEBAIHZvaWQgaW50ZWxfZW5naW5l
c19hZGRfc3lzZnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJCSZpbnN0X2F0dHIu
YXR0ciwKIAkJJmNhcHNfYXR0ci5hdHRyLAogCQkmYWxsX2NhcHNfYXR0ci5hdHRyLAorI2lmIENP
TkZJR19EUk1fSTkxNV9IRUFSVEJFQVRfSU5URVJWQUwKKwkJJmhlYXJ0YmVhdF9pbnRlcnZhbF9h
dHRyLmF0dHIsCisjZW5kaWYKIAkJTlVMTAogCX07CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZW5naW5lX3R5cGVzLmgKaW5kZXggNmFmOWIwMDk2OTc1Li5hZDNiZTJmYmQ3MWEg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5o
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oCkBAIC0x
NSw2ICsxNSw3IEBACiAjaW5jbHVkZSA8bGludXgvcmJ0cmVlLmg+CiAjaW5jbHVkZSA8bGludXgv
dGltZXIuaD4KICNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgorI2luY2x1ZGUgPGxpbnV4L3dvcmtx
dWV1ZS5oPgogCiAjaW5jbHVkZSAiaTkxNV9nZW0uaCIKICNpbmNsdWRlICJpOTE1X3BtdS5oIgpA
QCAtNzYsMTQgKzc3LDYgQEAgc3RydWN0IGludGVsX2luc3Rkb25lIHsKIAl1MzIgcm93W0k5MTVf
TUFYX1NMSUNFU11bSTkxNV9NQVhfU1VCU0xJQ0VTXTsKIH07CiAKLXN0cnVjdCBpbnRlbF9lbmdp
bmVfaGFuZ2NoZWNrIHsKLQl1NjQgYWN0aGQ7Ci0JdTMyIGxhc3RfcmluZzsKLQl1MzIgbGFzdF9o
ZWFkOwotCXVuc2lnbmVkIGxvbmcgYWN0aW9uX3RpbWVzdGFtcDsKLQlzdHJ1Y3QgaW50ZWxfaW5z
dGRvbmUgaW5zdGRvbmU7Ci19OwotCiBzdHJ1Y3QgaW50ZWxfcmluZyB7CiAJc3RydWN0IGtyZWYg
cmVmOwogCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwpAQCAtMzMwLDYgKzMyMywxMSBAQCBzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzIHsKIAogCWludGVsX2VuZ2luZV9tYXNrX3Qgc2F0dXJhdGVkOyAvKiBz
dWJtaXR0aW5nIHNlbWFwaG9yZXMgdG9vIGxhdGU/ICovCiAKKwlzdHJ1Y3QgeworCQlzdHJ1Y3Qg
ZGVsYXllZF93b3JrIHdvcms7CisJCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnN5c3RvbGU7CisJfSBo
ZWFydGJlYXQ7CisKIAl1bnNpZ25lZCBsb25nIHNlcmlhbDsKIAogCXVuc2lnbmVkIGxvbmcgd2Fr
ZXJlZl9zZXJpYWw7CkBAIC00ODAsOCArNDc4LDYgQEAgc3RydWN0IGludGVsX2VuZ2luZV9jcyB7
CiAJLyogc3RhdHVzX25vdGlmaWVyOiBsaXN0IG9mIGNhbGxiYWNrcyBmb3IgY29udGV4dC1zd2l0
Y2ggY2hhbmdlcyAqLwogCXN0cnVjdCBhdG9taWNfbm90aWZpZXJfaGVhZCBjb250ZXh0X3N0YXR1
c19ub3RpZmllcjsKIAotCXN0cnVjdCBpbnRlbF9lbmdpbmVfaGFuZ2NoZWNrIGhhbmdjaGVjazsK
LQogI2RlZmluZSBJOTE1X0VOR0lORV9ORUVEU19DTURfUEFSU0VSIEJJVCgwKQogI2RlZmluZSBJ
OTE1X0VOR0lORV9TVVBQT1JUU19TVEFUUyAgIEJJVCgxKQogI2RlZmluZSBJOTE1X0VOR0lORV9I
QVNfUFJFRU1QVElPTiAgIEJJVCgyKQpAQCAtNTQ5LDYgKzU0NSw3IEBAIHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgewogCiAJc3RydWN0IHsKIAkJdW5zaWduZWQgbG9uZyBwcmVlbXB0X3RpbWVvdXQ7
CisJCXVuc2lnbmVkIGxvbmcgaGVhcnRiZWF0X2ludGVydmFsOwogCX0gcHJvcHM7CiB9OwogCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuYwppbmRleCBiMzYxOWEyYTVkMGUuLmYzZTE5MjU5ODdl
MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5jCkBAIC0yMiw3ICsyMiw2IEBAIHZvaWQg
aW50ZWxfZ3RfaW5pdF9lYXJseShzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKIAlJTklUX0xJU1RfSEVBRCgmZ3QtPmNsb3NlZF92bWEpOwogCXNwaW5f
bG9ja19pbml0KCZndC0+Y2xvc2VkX2xvY2spOwogCi0JaW50ZWxfZ3RfaW5pdF9oYW5nY2hlY2so
Z3QpOwogCWludGVsX2d0X2luaXRfcmVzZXQoZ3QpOwogCWludGVsX2d0X2luaXRfcmVxdWVzdHMo
Z3QpOwogCWludGVsX2d0X3BtX2luaXRfZWFybHkoZ3QpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2d0LmgKaW5kZXggZTZhYjBiZmYwZWZiLi41YjZlZmZlZDM3MTMgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZ3QuaApAQCAtNDYsOCArNDYsNiBAQCB2b2lkIGludGVsX2d0X2NsZWFyX2Vycm9y
X3JlZ2lzdGVycyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAogdm9pZCBpbnRlbF9ndF9mbHVzaF9nZ3R0
X3dyaXRlcyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIHZvaWQgaW50ZWxfZ3RfY2hpcHNldF9mbHVz
aChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIAotdm9pZCBpbnRlbF9ndF9pbml0X2hhbmdjaGVjayhz
dHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKLQogc3RhdGljIGlubGluZSB1MzIgaW50ZWxfZ3Rfc2NyYXRj
aF9vZmZzZXQoY29uc3Qgc3RydWN0IGludGVsX2d0ICpndCwKIAkJCQkJICBlbnVtIGludGVsX2d0
X3NjcmF0Y2hfZmllbGQgZmllbGQpCiB7CkBAIC01OSw2ICs1Nyw0IEBAIHN0YXRpYyBpbmxpbmUg
Ym9vbCBpbnRlbF9ndF9pc193ZWRnZWQoc3RydWN0IGludGVsX2d0ICpndCkKIAlyZXR1cm4gX19p
bnRlbF9yZXNldF9mYWlsZWQoJmd0LT5yZXNldCk7CiB9CiAKLXZvaWQgaW50ZWxfZ3RfcXVldWVf
aGFuZ2NoZWNrKHN0cnVjdCBpbnRlbF9ndCAqZ3QpOwotCiAjZW5kaWYgLyogX19JTlRFTF9HVF9I
X18gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3BtLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9wbS5jCmluZGV4IGJkMWJkM2UwMGE5
NC4uMTUxMWFmOTlkMzA5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9ndF9wbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3BtLmMKQEAg
LTUyLDcgKzUyLDYgQEAgc3RhdGljIGludCBfX2d0X3VucGFyayhzdHJ1Y3QgaW50ZWxfd2FrZXJl
ZiAqd2YpCiAKIAlpOTE1X3BtdV9ndF91bnBhcmtlZChpOTE1KTsKIAotCWludGVsX2d0X3F1ZXVl
X2hhbmdjaGVjayhndCk7CiAJaW50ZWxfZ3RfdW5wYXJrX3JlcXVlc3RzKGd0KTsKIAogCXBtX25v
dGlmeShndCwgSU5URUxfR1RfVU5QQVJLKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2d0X3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9n
dF90eXBlcy5oCmluZGV4IGJlNGIyNjM2MjFjOC4uYTJlOGM4YTk1MmU3IDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2d0X3R5cGVzLmgKQEAgLTI2LDE0ICsyNiw2IEBAIHN0cnVjdCBp
OTE1X2dndHQ7CiBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzOwogc3RydWN0IGludGVsX3VuY29yZTsK
IAotc3RydWN0IGludGVsX2hhbmdjaGVjayB7Ci0JLyogRm9yIGhhbmdjaGVjayB0aW1lciAqLwot
I2RlZmluZSBEUk1fSTkxNV9IQU5HQ0hFQ0tfUEVSSU9EIDE1MDAgLyogaW4gbXMgKi8KLSNkZWZp
bmUgRFJNX0k5MTVfSEFOR0NIRUNLX0pJRkZJRVMgbXNlY3NfdG9famlmZmllcyhEUk1fSTkxNV9I
QU5HQ0hFQ0tfUEVSSU9EKQotCi0Jc3RydWN0IGRlbGF5ZWRfd29yayB3b3JrOwotfTsKLQogc3Ry
dWN0IGludGVsX2d0IHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNTsKIAlzdHJ1Y3Qg
aW50ZWxfdW5jb3JlICp1bmNvcmU7CkBAIC02Nyw3ICs1OSw2IEBAIHN0cnVjdCBpbnRlbF9ndCB7
CiAJc3RydWN0IGxpc3RfaGVhZCBjbG9zZWRfdm1hOwogCXNwaW5sb2NrX3QgY2xvc2VkX2xvY2s7
IC8qIGd1YXJkcyB0aGUgbGlzdCBvZiBjbG9zZWRfdm1hICovCiAKLQlzdHJ1Y3QgaW50ZWxfaGFu
Z2NoZWNrIGhhbmdjaGVjazsKIAlzdHJ1Y3QgaW50ZWxfcmVzZXQgcmVzZXQ7CiAKIAkvKioKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2hhbmdjaGVjay5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfaGFuZ2NoZWNrLmMKZGVsZXRlZCBmaWxlIG1vZGUg
MTAwNjQ0CmluZGV4IGMxNGRiZWIzY2NjMy4uMDAwMDAwMDAwMDAwCi0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2hhbmdjaGVjay5jCisrKyAvZGV2L251bGwKQEAgLTEsMzYxICsw
LDAgQEAKLS8qCi0gKiBDb3B5cmlnaHQgwqkgMjAxNiBJbnRlbCBDb3Jwb3JhdGlvbgotICoKLSAq
IFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVy
c29uIG9idGFpbmluZyBhCi0gKiBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQg
ZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLAotICogdG8gZGVhbCBpbiB0aGUg
U29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlv
bgotICogdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRp
c3RyaWJ1dGUsIHN1YmxpY2Vuc2UsCi0gKiBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3
YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUKLSAqIFNvZnR3YXJlIGlzIGZ1
cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6Ci0g
KgotICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3Rp
Y2UgKGluY2x1ZGluZyB0aGUgbmV4dAotICogcGFyYWdyYXBoKSBzaGFsbCBiZSBpbmNsdWRlZCBp
biBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZQotICogU29mdHdhcmUu
Ci0gKgotICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFO
VFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKLSAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9U
IExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAotICogRklUTkVT
UyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVW
RU5UIFNIQUxMCi0gKiBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUg
Rk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUgotICogTElBQklMSVRZLCBXSEVUSEVSIElO
IEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcKLSAqIEZS
T00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0Ug
T1IgT1RIRVIgREVBTElOR1MKLSAqIElOIFRIRSBTT0ZUV0FSRS4KLSAqCi0gKi8KLQotI2luY2x1
ZGUgImk5MTVfZHJ2LmgiCi0jaW5jbHVkZSAiaW50ZWxfZW5naW5lLmgiCi0jaW5jbHVkZSAiaW50
ZWxfZ3QuaCIKLSNpbmNsdWRlICJpbnRlbF9yZXNldC5oIgotCi1zdHJ1Y3QgaGFuZ2NoZWNrIHsK
LQl1NjQgYWN0aGQ7Ci0JdTMyIHJpbmc7Ci0JdTMyIGhlYWQ7Ci0JZW51bSBpbnRlbF9lbmdpbmVf
aGFuZ2NoZWNrX2FjdGlvbiBhY3Rpb247Ci0JdW5zaWduZWQgbG9uZyBhY3Rpb25fdGltZXN0YW1w
OwotCWludCBkZWFkbG9jazsKLQlzdHJ1Y3QgaW50ZWxfaW5zdGRvbmUgaW5zdGRvbmU7Ci0JYm9v
bCB3ZWRnZWQ6MTsKLQlib29sIHN0YWxsZWQ6MTsKLX07Ci0KLXN0YXRpYyBib29sIGluc3Rkb25l
X3VuY2hhbmdlZCh1MzIgY3VycmVudF9pbnN0ZG9uZSwgdTMyICpvbGRfaW5zdGRvbmUpCi17Ci0J
dTMyIHRtcCA9IGN1cnJlbnRfaW5zdGRvbmUgfCAqb2xkX2luc3Rkb25lOwotCWJvb2wgdW5jaGFu
Z2VkOwotCi0JdW5jaGFuZ2VkID0gdG1wID09ICpvbGRfaW5zdGRvbmU7Ci0JKm9sZF9pbnN0ZG9u
ZSB8PSB0bXA7Ci0KLQlyZXR1cm4gdW5jaGFuZ2VkOwotfQotCi1zdGF0aWMgYm9vbCBzdWJ1bml0
c19zdHVjayhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCi17Ci0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZW5naW5lLT5pOTE1OwotCWNvbnN0IHN0cnVjdCBzc2V1
X2Rldl9pbmZvICpzc2V1ID0gJlJVTlRJTUVfSU5GTyhkZXZfcHJpdiktPnNzZXU7Ci0Jc3RydWN0
IGludGVsX2luc3Rkb25lIGluc3Rkb25lOwotCXN0cnVjdCBpbnRlbF9pbnN0ZG9uZSAqYWNjdV9p
bnN0ZG9uZSA9ICZlbmdpbmUtPmhhbmdjaGVjay5pbnN0ZG9uZTsKLQlib29sIHN0dWNrOwotCWlu
dCBzbGljZTsKLQlpbnQgc3Vic2xpY2U7Ci0KLQlpbnRlbF9lbmdpbmVfZ2V0X2luc3Rkb25lKGVu
Z2luZSwgJmluc3Rkb25lKTsKLQotCS8qIFRoZXJlIG1pZ2h0IGJlIHVuc3RhYmxlIHN1YnVuaXQg
c3RhdGVzIGV2ZW4gd2hlbgotCSAqIGFjdHVhbCBoZWFkIGlzIG5vdCBtb3ZpbmcuIEZpbHRlciBv
dXQgdGhlIHVuc3RhYmxlIG9uZXMgYnkKLQkgKiBhY2N1bXVsYXRpbmcgdGhlIHVuZG9uZSAtPiBk
b25lIHRyYW5zaXRpb25zIGFuZCBvbmx5Ci0JICogY29uc2lkZXIgdGhvc2UgYXMgcHJvZ3Jlc3Mu
Ci0JICovCi0Jc3R1Y2sgPSBpbnN0ZG9uZV91bmNoYW5nZWQoaW5zdGRvbmUuaW5zdGRvbmUsCi0J
CQkJICAgJmFjY3VfaW5zdGRvbmUtPmluc3Rkb25lKTsKLQlzdHVjayAmPSBpbnN0ZG9uZV91bmNo
YW5nZWQoaW5zdGRvbmUuc2xpY2VfY29tbW9uLAotCQkJCSAgICAmYWNjdV9pbnN0ZG9uZS0+c2xp
Y2VfY29tbW9uKTsKLQotCWZvcl9lYWNoX2luc3Rkb25lX3NsaWNlX3N1YnNsaWNlKGRldl9wcml2
LCBzc2V1LCBzbGljZSwgc3Vic2xpY2UpIHsKLQkJc3R1Y2sgJj0gaW5zdGRvbmVfdW5jaGFuZ2Vk
KGluc3Rkb25lLnNhbXBsZXJbc2xpY2VdW3N1YnNsaWNlXSwKLQkJCQkJICAgICZhY2N1X2luc3Rk
b25lLT5zYW1wbGVyW3NsaWNlXVtzdWJzbGljZV0pOwotCQlzdHVjayAmPSBpbnN0ZG9uZV91bmNo
YW5nZWQoaW5zdGRvbmUucm93W3NsaWNlXVtzdWJzbGljZV0sCi0JCQkJCSAgICAmYWNjdV9pbnN0
ZG9uZS0+cm93W3NsaWNlXVtzdWJzbGljZV0pOwotCX0KLQotCXJldHVybiBzdHVjazsKLX0KLQot
c3RhdGljIGVudW0gaW50ZWxfZW5naW5lX2hhbmdjaGVja19hY3Rpb24KLWhlYWRfc3R1Y2soc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1NjQgYWN0aGQpCi17Ci0JaWYgKGFjdGhkICE9
IGVuZ2luZS0+aGFuZ2NoZWNrLmFjdGhkKSB7Ci0KLQkJLyogQ2xlYXIgc3VidW5pdCBzdGF0ZXMg
b24gaGVhZCBtb3ZlbWVudCAqLwotCQltZW1zZXQoJmVuZ2luZS0+aGFuZ2NoZWNrLmluc3Rkb25l
LCAwLAotCQkgICAgICAgc2l6ZW9mKGVuZ2luZS0+aGFuZ2NoZWNrLmluc3Rkb25lKSk7Ci0KLQkJ
cmV0dXJuIEVOR0lORV9BQ1RJVkVfSEVBRDsKLQl9Ci0KLQlpZiAoIXN1YnVuaXRzX3N0dWNrKGVu
Z2luZSkpCi0JCXJldHVybiBFTkdJTkVfQUNUSVZFX1NVQlVOSVRTOwotCi0JcmV0dXJuIEVOR0lO
RV9ERUFEOwotfQotCi1zdGF0aWMgZW51bSBpbnRlbF9lbmdpbmVfaGFuZ2NoZWNrX2FjdGlvbgot
ZW5naW5lX3N0dWNrKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgdTY0IGFjdGhkKQot
ewotCWVudW0gaW50ZWxfZW5naW5lX2hhbmdjaGVja19hY3Rpb24gaGE7Ci0JdTMyIHRtcDsKLQot
CWhhID0gaGVhZF9zdHVjayhlbmdpbmUsIGFjdGhkKTsKLQlpZiAoaGEgIT0gRU5HSU5FX0RFQUQp
Ci0JCXJldHVybiBoYTsKLQotCWlmIChJU19HRU4oZW5naW5lLT5pOTE1LCAyKSkKLQkJcmV0dXJu
IEVOR0lORV9ERUFEOwotCi0JLyogSXMgdGhlIGNoaXAgaGFuZ2luZyBvbiBhIFdBSVRfRk9SX0VW
RU5UPwotCSAqIElmIHNvIHdlIGNhbiBzaW1wbHkgcG9rZSB0aGUgUkJfV0FJVCBiaXQKLQkgKiBh
bmQgYnJlYWsgdGhlIGhhbmcuIFRoaXMgc2hvdWxkIHdvcmsgb24KLQkgKiBhbGwgYnV0IHRoZSBz
ZWNvbmQgZ2VuZXJhdGlvbiBjaGlwc2V0cy4KLQkgKi8KLQl0bXAgPSBFTkdJTkVfUkVBRChlbmdp
bmUsIFJJTkdfQ1RMKTsKLQlpZiAodG1wICYgUklOR19XQUlUKSB7Ci0JCWludGVsX2d0X2hhbmRs
ZV9lcnJvcihlbmdpbmUtPmd0LCBlbmdpbmUtPm1hc2ssIDAsCi0JCQkJICAgICAgInN0dWNrIHdh
aXQgb24gJXMiLCBlbmdpbmUtPm5hbWUpOwotCQlFTkdJTkVfV1JJVEUoZW5naW5lLCBSSU5HX0NU
TCwgdG1wKTsKLQkJcmV0dXJuIEVOR0lORV9XQUlUX0tJQ0s7Ci0JfQotCi0JcmV0dXJuIEVOR0lO
RV9ERUFEOwotfQotCi1zdGF0aWMgdm9pZCBoYW5nY2hlY2tfbG9hZF9zYW1wbGUoc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lLAotCQkJCSAgc3RydWN0IGhhbmdjaGVjayAqaGMpCi17Ci0J
aGMtPmFjdGhkID0gaW50ZWxfZW5naW5lX2dldF9hY3RpdmVfaGVhZChlbmdpbmUpOwotCWhjLT5y
aW5nID0gRU5HSU5FX1JFQUQoZW5naW5lLCBSSU5HX1NUQVJUKTsKLQloYy0+aGVhZCA9IEVOR0lO
RV9SRUFEKGVuZ2luZSwgUklOR19IRUFEKTsKLX0KLQotc3RhdGljIHZvaWQgaGFuZ2NoZWNrX3N0
b3JlX3NhbXBsZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCi0JCQkJICAgY29uc3Qg
c3RydWN0IGhhbmdjaGVjayAqaGMpCi17Ci0JZW5naW5lLT5oYW5nY2hlY2suYWN0aGQgPSBoYy0+
YWN0aGQ7Ci0JZW5naW5lLT5oYW5nY2hlY2subGFzdF9yaW5nID0gaGMtPnJpbmc7Ci0JZW5naW5l
LT5oYW5nY2hlY2subGFzdF9oZWFkID0gaGMtPmhlYWQ7Ci19Ci0KLXN0YXRpYyBlbnVtIGludGVs
X2VuZ2luZV9oYW5nY2hlY2tfYWN0aW9uCi1oYW5nY2hlY2tfZ2V0X2FjdGlvbihzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUsCi0JCSAgICAgY29uc3Qgc3RydWN0IGhhbmdjaGVjayAqaGMp
Ci17Ci0JaWYgKGludGVsX2VuZ2luZV9pc19pZGxlKGVuZ2luZSkpCi0JCXJldHVybiBFTkdJTkVf
SURMRTsKLQotCWlmIChlbmdpbmUtPmhhbmdjaGVjay5sYXN0X3JpbmcgIT0gaGMtPnJpbmcpCi0J
CXJldHVybiBFTkdJTkVfQUNUSVZFX1NFUU5POwotCi0JaWYgKGVuZ2luZS0+aGFuZ2NoZWNrLmxh
c3RfaGVhZCAhPSBoYy0+aGVhZCkKLQkJcmV0dXJuIEVOR0lORV9BQ1RJVkVfU0VRTk87Ci0KLQly
ZXR1cm4gZW5naW5lX3N0dWNrKGVuZ2luZSwgaGMtPmFjdGhkKTsKLX0KLQotc3RhdGljIHZvaWQg
aGFuZ2NoZWNrX2FjY3VtdWxhdGVfc2FtcGxlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSwKLQkJCQkJc3RydWN0IGhhbmdjaGVjayAqaGMpCi17Ci0JdW5zaWduZWQgbG9uZyB0aW1lb3V0
ID0gSTkxNV9FTkdJTkVfREVBRF9USU1FT1VUOwotCi0JaGMtPmFjdGlvbiA9IGhhbmdjaGVja19n
ZXRfYWN0aW9uKGVuZ2luZSwgaGMpOwotCi0JLyogV2UgYWx3YXlzIGluY3JlbWVudCB0aGUgcHJv
Z3Jlc3MKLQkgKiBpZiB0aGUgZW5naW5lIGlzIGJ1c3kgYW5kIHN0aWxsIHByb2Nlc3NpbmcKLQkg
KiB0aGUgc2FtZSByZXF1ZXN0LCBzbyB0aGF0IG5vIHNpbmdsZSByZXF1ZXN0Ci0JICogY2FuIHJ1
biBpbmRlZmluaXRlbHkgKHN1Y2ggYXMgYSBjaGFpbiBvZgotCSAqIGJhdGNoZXMpLiBUaGUgb25s
eSB0aW1lIHdlIGRvIG5vdCBpbmNyZW1lbnQKLQkgKiB0aGUgaGFuZ2NoZWNrIHNjb3JlIG9uIHRo
aXMgcmluZywgaWYgdGhpcwotCSAqIGVuZ2luZSBpcyBpbiBhIGxlZ2l0aW1hdGUgd2FpdCBmb3Ig
YW5vdGhlcgotCSAqIGVuZ2luZS4gSW4gdGhhdCBjYXNlIHRoZSB3YWl0aW5nIGVuZ2luZSBpcyBh
Ci0JICogdmljdGltIGFuZCB3ZSB3YW50IHRvIGJlIHN1cmUgd2UgY2F0Y2ggdGhlCi0JICogcmln
aHQgY3VscHJpdC4gVGhlbiBldmVyeSB0aW1lIHdlIGRvIGtpY2sKLQkgKiB0aGUgcmluZywgbWFr
ZSBpdCBhcyBhIHByb2dyZXNzIGFzIHRoZSBzZXFubwotCSAqIGFkdmFuY2VtZW50IG1pZ2h0IGVu
c3VyZSBhbmQgaWYgbm90LCBpdAotCSAqIHdpbGwgY2F0Y2ggdGhlIGhhbmdpbmcgZW5naW5lLgot
CSAqLwotCi0Jc3dpdGNoIChoYy0+YWN0aW9uKSB7Ci0JY2FzZSBFTkdJTkVfSURMRToKLQljYXNl
IEVOR0lORV9BQ1RJVkVfU0VRTk86Ci0JCS8qIENsZWFyIGhlYWQgYW5kIHN1YnVuaXQgc3RhdGVz
IG9uIHNlcW5vIG1vdmVtZW50ICovCi0JCWhjLT5hY3RoZCA9IDA7Ci0KLQkJbWVtc2V0KCZlbmdp
bmUtPmhhbmdjaGVjay5pbnN0ZG9uZSwgMCwKLQkJICAgICAgIHNpemVvZihlbmdpbmUtPmhhbmdj
aGVjay5pbnN0ZG9uZSkpOwotCi0JCS8qIEludGVudGlvbmFsIGZhbGwgdGhyb3VnaCAqLwotCWNh
c2UgRU5HSU5FX1dBSVRfS0lDSzoKLQljYXNlIEVOR0lORV9XQUlUOgotCQllbmdpbmUtPmhhbmdj
aGVjay5hY3Rpb25fdGltZXN0YW1wID0gamlmZmllczsKLQkJYnJlYWs7Ci0KLQljYXNlIEVOR0lO
RV9BQ1RJVkVfSEVBRDoKLQljYXNlIEVOR0lORV9BQ1RJVkVfU1VCVU5JVFM6Ci0JCS8qCi0JCSAq
IFNlcW5vIHN0dWNrIHdpdGggc3RpbGwgYWN0aXZlIGVuZ2luZSBnZXRzIGxlZXdheSwKLQkJICog
aW4gaG9wZXMgdGhhdCBpdCBpcyBqdXN0IGEgbG9uZyBzaGFkZXIuCi0JCSAqLwotCQl0aW1lb3V0
ID0gSTkxNV9TRVFOT19ERUFEX1RJTUVPVVQ7Ci0JCWJyZWFrOwotCi0JY2FzZSBFTkdJTkVfREVB
RDoKLQkJYnJlYWs7Ci0KLQlkZWZhdWx0OgotCQlNSVNTSU5HX0NBU0UoaGMtPmFjdGlvbik7Ci0J
fQotCi0JaGMtPnN0YWxsZWQgPSB0aW1lX2FmdGVyKGppZmZpZXMsCi0JCQkJIGVuZ2luZS0+aGFu
Z2NoZWNrLmFjdGlvbl90aW1lc3RhbXAgKyB0aW1lb3V0KTsKLQloYy0+d2VkZ2VkID0gdGltZV9h
ZnRlcihqaWZmaWVzLAotCQkJCSBlbmdpbmUtPmhhbmdjaGVjay5hY3Rpb25fdGltZXN0YW1wICsK
LQkJCQkgSTkxNV9FTkdJTkVfV0VER0VEX1RJTUVPVVQpOwotfQotCi1zdGF0aWMgdm9pZCBoYW5n
Y2hlY2tfZGVjbGFyZV9oYW5nKHN0cnVjdCBpbnRlbF9ndCAqZ3QsCi0JCQkJICAgaW50ZWxfZW5n
aW5lX21hc2tfdCBodW5nLAotCQkJCSAgIGludGVsX2VuZ2luZV9tYXNrX3Qgc3R1Y2spCi17Ci0J
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCWludGVsX2VuZ2luZV9tYXNrX3QgdG1w
OwotCWNoYXIgbXNnWzgwXTsKLQlpbnQgbGVuOwotCi0JLyogSWYgc29tZSByaW5ncyBodW5nIGJ1
dCBvdGhlcnMgd2VyZSBzdGlsbCBidXN5LCBvbmx5Ci0JICogYmxhbWUgdGhlIGhhbmdpbmcgcmlu
Z3MgaW4gdGhlIHN5bm9wc2lzLgotCSAqLwotCWlmIChzdHVjayAhPSBodW5nKQotCQlodW5nICY9
IH5zdHVjazsKLQlsZW4gPSBzY25wcmludGYobXNnLCBzaXplb2YobXNnKSwKLQkJCSIlcyBvbiAi
LCBzdHVjayA9PSBodW5nID8gIm5vIHByb2dyZXNzIiA6ICJoYW5nIik7Ci0JZm9yX2VhY2hfZW5n
aW5lX21hc2tlZChlbmdpbmUsIGd0LT5pOTE1LCBodW5nLCB0bXApCi0JCWxlbiArPSBzY25wcmlu
dGYobXNnICsgbGVuLCBzaXplb2YobXNnKSAtIGxlbiwKLQkJCQkgIiVzLCAiLCBlbmdpbmUtPm5h
bWUpOwotCW1zZ1tsZW4tMl0gPSAnXDAnOwotCi0JcmV0dXJuIGludGVsX2d0X2hhbmRsZV9lcnJv
cihndCwgaHVuZywgSTkxNV9FUlJPUl9DQVBUVVJFLCAiJXMiLCBtc2cpOwotfQotCi0vKgotICog
VGhpcyBpcyBjYWxsZWQgd2hlbiB0aGUgY2hpcCBoYXNuJ3QgcmVwb3J0ZWQgYmFjayB3aXRoIGNv
bXBsZXRlZAotICogYmF0Y2hidWZmZXJzIGluIGEgbG9uZyB0aW1lLiBXZSBrZWVwIHRyYWNrIHBl
ciByaW5nIHNlcW5vIHByb2dyZXNzIGFuZAotICogaWYgdGhlcmUgYXJlIG5vIHByb2dyZXNzLCBo
YW5nY2hlY2sgc2NvcmUgZm9yIHRoYXQgcmluZyBpcyBpbmNyZWFzZWQuCi0gKiBGdXJ0aGVyLCBh
Y3RoZCBpcyBpbnNwZWN0ZWQgdG8gc2VlIGlmIHRoZSByaW5nIGlzIHN0dWNrLiBPbiBzdHVjayBj
YXNlCi0gKiB3ZSBraWNrIHRoZSByaW5nLiBJZiB3ZSBzZWUgbm8gcHJvZ3Jlc3Mgb24gdGhyZWUg
c3Vic2VxdWVudCBjYWxscwotICogd2UgYXNzdW1lIGNoaXAgaXMgd2VkZ2VkIGFuZCB0cnkgdG8g
Zml4IGl0IGJ5IHJlc2V0dGluZyB0aGUgY2hpcC4KLSAqLwotc3RhdGljIHZvaWQgaGFuZ2NoZWNr
X2VsYXBzZWQoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQotewotCXN0cnVjdCBpbnRlbF9ndCAq
Z3QgPQotCQljb250YWluZXJfb2Yod29yaywgdHlwZW9mKCpndCksIGhhbmdjaGVjay53b3JrLndv
cmspOwotCWludGVsX2VuZ2luZV9tYXNrX3QgaHVuZyA9IDAsIHN0dWNrID0gMCwgd2VkZ2VkID0g
MDsKLQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0JZW51bSBpbnRlbF9lbmdpbmVf
aWQgaWQ7Ci0JaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Ci0KLQlpZiAoIWk5MTVfbW9kcGFyYW1z
LmVuYWJsZV9oYW5nY2hlY2spCi0JCXJldHVybjsKLQotCWlmICghUkVBRF9PTkNFKGd0LT5hd2Fr
ZSkpCi0JCXJldHVybjsKLQotCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoZ3QpKQotCQlyZXR1cm47
Ci0KLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXRfaWZfaW5fdXNlKGd0LT51bmNvcmUt
PnJwbSk7Ci0JaWYgKCF3YWtlcmVmKQotCQlyZXR1cm47Ci0KLQkvKiBBcyBlbmFibGluZyB0aGUg
R1BVIHJlcXVpcmVzIGZhaXJseSBleHRlbnNpdmUgbW1pbyBhY2Nlc3MsCi0JICogcGVyaW9kaWNh
bGx5IGFybSB0aGUgbW1pbyBjaGVja2VyIHRvIHNlZSBpZiB3ZSBhcmUgdHJpZ2dlcmluZwotCSAq
IGFueSBpbnZhbGlkIGFjY2Vzcy4KLQkgKi8KLQlpbnRlbF91bmNvcmVfYXJtX3VuY2xhaW1lZF9t
bWlvX2RldGVjdGlvbihndC0+dW5jb3JlKTsKLQotCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0
LT5pOTE1LCBpZCkgewotCQlzdHJ1Y3QgaGFuZ2NoZWNrIGhjOwotCi0JCWludGVsX2VuZ2luZV9i
cmVhZGNydW1ic19pcnEoZW5naW5lKTsKLQotCQloYW5nY2hlY2tfbG9hZF9zYW1wbGUoZW5naW5l
LCAmaGMpOwotCQloYW5nY2hlY2tfYWNjdW11bGF0ZV9zYW1wbGUoZW5naW5lLCAmaGMpOwotCQlo
YW5nY2hlY2tfc3RvcmVfc2FtcGxlKGVuZ2luZSwgJmhjKTsKLQotCQlpZiAoaGMuc3RhbGxlZCkg
ewotCQkJaHVuZyB8PSBlbmdpbmUtPm1hc2s7Ci0JCQlpZiAoaGMuYWN0aW9uICE9IEVOR0lORV9E
RUFEKQotCQkJCXN0dWNrIHw9IGVuZ2luZS0+bWFzazsKLQkJfQotCi0JCWlmIChoYy53ZWRnZWQp
Ci0JCQl3ZWRnZWQgfD0gZW5naW5lLT5tYXNrOwotCX0KLQotCWlmIChHRU1fU0hPV19ERUJVRygp
ICYmIChodW5nIHwgc3R1Y2spKSB7Ci0JCXN0cnVjdCBkcm1fcHJpbnRlciBwID0gZHJtX2RlYnVn
X3ByaW50ZXIoImhhbmdjaGVjayIpOwotCi0JCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LT5p
OTE1LCBpZCkgewotCQkJaWYgKGludGVsX2VuZ2luZV9pc19pZGxlKGVuZ2luZSkpCi0JCQkJY29u
dGludWU7Ci0KLQkJCWludGVsX2VuZ2luZV9kdW1wKGVuZ2luZSwgJnAsICIlc1xuIiwgZW5naW5l
LT5uYW1lKTsKLQkJfQotCX0KLQotCWlmICh3ZWRnZWQpIHsKLQkJZGV2X2VycihndC0+aTkxNS0+
ZHJtLmRldiwKLQkJCSJHUFUgcmVjb3ZlcnkgdGltZWQgb3V0LCIKLQkJCSIgY2FuY2VsbGluZyBh
bGwgaW4tZmxpZ2h0IHJlbmRlcmluZy5cbiIpOwotCQlHRU1fVFJBQ0VfRFVNUCgpOwotCQlpbnRl
bF9ndF9zZXRfd2VkZ2VkKGd0KTsKLQl9Ci0KLQlpZiAoaHVuZykKLQkJaGFuZ2NoZWNrX2RlY2xh
cmVfaGFuZyhndCwgaHVuZywgc3R1Y2spOwotCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoZ3QtPnVu
Y29yZS0+cnBtLCB3YWtlcmVmKTsKLQotCS8qIFJlc2V0IHRpbWVyIGluIGNhc2UgR1BVIGhhbmdz
IHdpdGhvdXQgYW5vdGhlciByZXF1ZXN0IGJlaW5nIGFkZGVkICovCi0JaW50ZWxfZ3RfcXVldWVf
aGFuZ2NoZWNrKGd0KTsKLX0KLQotdm9pZCBpbnRlbF9ndF9xdWV1ZV9oYW5nY2hlY2soc3RydWN0
IGludGVsX2d0ICpndCkKLXsKLQl1bnNpZ25lZCBsb25nIGRlbGF5OwotCi0JaWYgKHVubGlrZWx5
KCFpOTE1X21vZHBhcmFtcy5lbmFibGVfaGFuZ2NoZWNrKSkKLQkJcmV0dXJuOwotCi0JLyoKLQkg
KiBEb24ndCBjb250aW51YWxseSBkZWZlciB0aGUgaGFuZ2NoZWNrIHNvIHRoYXQgaXQgaXMgYWx3
YXlzIHJ1biBhdAotCSAqIGxlYXN0IG9uY2UgYWZ0ZXIgd29yayBoYXMgYmVlbiBzY2hlZHVsZWQg
b24gYW55IHJpbmcuIE90aGVyd2lzZSwKLQkgKiB3ZSB3aWxsIGlnbm9yZSBhIGh1bmcgcmluZyBp
ZiBhIHNlY29uZCByaW5nIGlzIGtlcHQgYnVzeS4KLQkgKi8KLQotCWRlbGF5ID0gcm91bmRfamlm
Zmllc191cF9yZWxhdGl2ZShEUk1fSTkxNV9IQU5HQ0hFQ0tfSklGRklFUyk7Ci0JcXVldWVfZGVs
YXllZF93b3JrKHN5c3RlbV9sb25nX3dxLCAmZ3QtPmhhbmdjaGVjay53b3JrLCBkZWxheSk7Ci19
Ci0KLXZvaWQgaW50ZWxfZW5naW5lX2luaXRfaGFuZ2NoZWNrKHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSkKLXsKLQltZW1zZXQoJmVuZ2luZS0+aGFuZ2NoZWNrLCAwLCBzaXplb2YoZW5n
aW5lLT5oYW5nY2hlY2spKTsKLQllbmdpbmUtPmhhbmdjaGVjay5hY3Rpb25fdGltZXN0YW1wID0g
amlmZmllczsKLX0KLQotdm9pZCBpbnRlbF9ndF9pbml0X2hhbmdjaGVjayhzdHJ1Y3QgaW50ZWxf
Z3QgKmd0KQotewotCUlOSVRfREVMQVlFRF9XT1JLKCZndC0+aGFuZ2NoZWNrLndvcmssIGhhbmdj
aGVja19lbGFwc2VkKTsKLX0KLQotI2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X1NFTEZU
RVNUKQotI2luY2x1ZGUgInNlbGZ0ZXN0X2hhbmdjaGVjay5jIgotI2VuZGlmCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwppbmRleCA3NzQ0NWQxMDBjYTguLjlkNjQ1MWY5YTg1NSAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jCkBAIC0xMDI0LDggKzEwMjQsNiBA
QCB2b2lkIGludGVsX2d0X3Jlc2V0KHN0cnVjdCBpbnRlbF9ndCAqZ3QsCiAJaWYgKHJldCkKIAkJ
Z290byB0YWludDsKIAotCWludGVsX2d0X3F1ZXVlX2hhbmdjaGVjayhndCk7Ci0KIGZpbmlzaDoK
IAlyZXNldF9maW5pc2goZ3QsIGF3YWtlKTsKIHVubG9jazoKQEAgLTEzNTMsNCArMTM1MSw1IEBA
IHZvaWQgX19pbnRlbF9maW5pX3dlZGdlKHN0cnVjdCBpbnRlbF93ZWRnZV9tZSAqdykKIAogI2lm
IElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X1NFTEZURVNUKQogI2luY2x1ZGUgInNlbGZ0ZXN0
X3Jlc2V0LmMiCisjaW5jbHVkZSAic2VsZnRlc3RfaGFuZ2NoZWNrLmMiCiAjZW5kaWYKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfaGFuZ2NoZWNrLmMKaW5kZXggNTY5YTQxMDVk
NDllLi41NzA1NDZlZGE1ZTggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3Nl
bGZ0ZXN0X2hhbmdjaGVjay5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0
X2hhbmdjaGVjay5jCkBAIC0xNjg2LDcgKzE2ODYsNiBAQCBpbnQgaW50ZWxfaGFuZ2NoZWNrX2xp
dmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCX07CiAJc3RydWN0
IGludGVsX2d0ICpndCA9ICZpOTE1LT5ndDsKIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKLQli
b29sIHNhdmVkX2hhbmdjaGVjazsKIAlpbnQgZXJyOwogCiAJaWYgKCFpbnRlbF9oYXNfZ3B1X3Jl
c2V0KGd0KSkKQEAgLTE2OTYsMTIgKzE2OTUsOSBAQCBpbnQgaW50ZWxfaGFuZ2NoZWNrX2xpdmVf
c2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCQlyZXR1cm4gLUVJTzsg
Lyogd2UncmUgbG9uZyBwYXN0IGhvcGUgb2YgYSBzdWNjZXNzZnVsIHJlc2V0ICovCiAKIAl3YWtl
cmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZ3QtPnVuY29yZS0+cnBtKTsKLQlzYXZlZF9oYW5n
Y2hlY2sgPSBmZXRjaF9hbmRfemVybygmaTkxNV9tb2RwYXJhbXMuZW5hYmxlX2hhbmdjaGVjayk7
Ci0JZHJhaW5fZGVsYXllZF93b3JrKCZndC0+aGFuZ2NoZWNrLndvcmspOyAvKiBmbHVzaCBwYXJh
bSAqLwogCiAJZXJyID0gaW50ZWxfZ3RfbGl2ZV9zdWJ0ZXN0cyh0ZXN0cywgZ3QpOwogCi0JaTkx
NV9tb2RwYXJhbXMuZW5hYmxlX2hhbmdjaGVjayA9IHNhdmVkX2hhbmdjaGVjazsKIAlpbnRlbF9y
dW50aW1lX3BtX3B1dChndC0+dW5jb3JlLT5ycG0sIHdha2VyZWYpOwogCiAJcmV0dXJuIGVycjsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKaW5kZXggYTU0MWI2YWU1MzRmLi4yZmFlNmU1
OTJiMDkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCkBAIC0xMDExLDkyICsxMDEx
LDYgQEAgc3RhdGljIGludCBpOTE1X2ZyZXF1ZW5jeV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwg
dm9pZCAqdW51c2VkKQogCXJldHVybiByZXQ7CiB9CiAKLXN0YXRpYyB2b2lkIGk5MTVfaW5zdGRv
bmVfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0JCQkgICAgICAgc3Ry
dWN0IHNlcV9maWxlICptLAotCQkJICAgICAgIHN0cnVjdCBpbnRlbF9pbnN0ZG9uZSAqaW5zdGRv
bmUpCi17Ci0JY29uc3Qgc3RydWN0IHNzZXVfZGV2X2luZm8gKnNzZXUgPSAmUlVOVElNRV9JTkZP
KGRldl9wcml2KS0+c3NldTsKLQlpbnQgc2xpY2U7Ci0JaW50IHN1YnNsaWNlOwotCi0Jc2VxX3By
aW50ZihtLCAiXHRcdElOU1RET05FOiAweCUwOHhcbiIsCi0JCSAgIGluc3Rkb25lLT5pbnN0ZG9u
ZSk7Ci0KLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8PSAzKQotCQlyZXR1cm47Ci0KLQlzZXFf
cHJpbnRmKG0sICJcdFx0U0NfSU5TVERPTkU6IDB4JTA4eFxuIiwKLQkJICAgaW5zdGRvbmUtPnNs
aWNlX2NvbW1vbik7Ci0KLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8PSA2KQotCQlyZXR1cm47
Ci0KLQlmb3JfZWFjaF9pbnN0ZG9uZV9zbGljZV9zdWJzbGljZShkZXZfcHJpdiwgc3NldSwgc2xp
Y2UsIHN1YnNsaWNlKQotCQlzZXFfcHJpbnRmKG0sICJcdFx0U0FNUExFUl9JTlNURE9ORVslZF1b
JWRdOiAweCUwOHhcbiIsCi0JCQkgICBzbGljZSwgc3Vic2xpY2UsIGluc3Rkb25lLT5zYW1wbGVy
W3NsaWNlXVtzdWJzbGljZV0pOwotCi0JZm9yX2VhY2hfaW5zdGRvbmVfc2xpY2Vfc3Vic2xpY2Uo
ZGV2X3ByaXYsIHNzZXUsIHNsaWNlLCBzdWJzbGljZSkKLQkJc2VxX3ByaW50ZihtLCAiXHRcdFJP
V19JTlNURE9ORVslZF1bJWRdOiAweCUwOHhcbiIsCi0JCQkgICBzbGljZSwgc3Vic2xpY2UsIGlu
c3Rkb25lLT5yb3dbc2xpY2VdW3N1YnNsaWNlXSk7Ci19Ci0KLXN0YXRpYyBpbnQgaTkxNV9oYW5n
Y2hlY2tfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKLXsKLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKLQlzdHJ1
Y3QgaW50ZWxfZ3QgKmd0ID0gJmk5MTUtPmd0OwotCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZTsKLQlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKLQllbnVtIGludGVsX2VuZ2luZV9pZCBp
ZDsKLQotCXNlcV9wcmludGYobSwgIlJlc2V0IGZsYWdzOiAlbHhcbiIsIGd0LT5yZXNldC5mbGFn
cyk7Ci0JaWYgKHRlc3RfYml0KEk5MTVfV0VER0VELCAmZ3QtPnJlc2V0LmZsYWdzKSkKLQkJc2Vx
X3B1dHMobSwgIlx0V2VkZ2VkXG4iKTsKLQlpZiAodGVzdF9iaXQoSTkxNV9SRVNFVF9CQUNLT0ZG
LCAmZ3QtPnJlc2V0LmZsYWdzKSkKLQkJc2VxX3B1dHMobSwgIlx0RGV2aWNlIChnbG9iYWwpIHJl
c2V0IGluIHByb2dyZXNzXG4iKTsKLQotCWlmICghaTkxNV9tb2RwYXJhbXMuZW5hYmxlX2hhbmdj
aGVjaykgewotCQlzZXFfcHV0cyhtLCAiSGFuZ2NoZWNrIGRpc2FibGVkXG4iKTsKLQkJcmV0dXJu
IDA7Ci0JfQotCi0JaWYgKHRpbWVyX3BlbmRpbmcoJmd0LT5oYW5nY2hlY2sud29yay50aW1lcikp
Ci0JCXNlcV9wcmludGYobSwgIkhhbmdjaGVjayBhY3RpdmUsIHRpbWVyIGZpcmVzIGluICVkbXNc
biIsCi0JCQkgICBqaWZmaWVzX3RvX21zZWNzKGd0LT5oYW5nY2hlY2sud29yay50aW1lci5leHBp
cmVzIC0KLQkJCQkJICAgIGppZmZpZXMpKTsKLQllbHNlIGlmIChkZWxheWVkX3dvcmtfcGVuZGlu
ZygmZ3QtPmhhbmdjaGVjay53b3JrKSkKLQkJc2VxX3B1dHMobSwgIkhhbmdjaGVjayBhY3RpdmUs
IHdvcmsgcGVuZGluZ1xuIik7Ci0JZWxzZQotCQlzZXFfcHV0cyhtLCAiSGFuZ2NoZWNrIGluYWN0
aXZlXG4iKTsKLQotCXNlcV9wcmludGYobSwgIkdUIGFjdGl2ZT8gJXNcbiIsIHllc25vKGd0LT5h
d2FrZSkpOwotCi0Jd2l0aF9pbnRlbF9ydW50aW1lX3BtKCZpOTE1LT5ydW50aW1lX3BtLCB3YWtl
cmVmKSB7Ci0JCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKSB7Ci0JCQlzdHJ1Y3Qg
aW50ZWxfaW5zdGRvbmUgaW5zdGRvbmU7Ci0KLQkJCXNlcV9wcmludGYobSwgIiVzOiAlZCBtcyBh
Z29cbiIsCi0JCQkJICAgZW5naW5lLT5uYW1lLAotCQkJCSAgIGppZmZpZXNfdG9fbXNlY3Moamlm
ZmllcyAtCi0JCQkJCQkgICAgZW5naW5lLT5oYW5nY2hlY2suYWN0aW9uX3RpbWVzdGFtcCkpOwot
Ci0JCQlzZXFfcHJpbnRmKG0sICJcdEFDVEhEID0gMHglMDhsbHggW2N1cnJlbnQgMHglMDhsbHhd
XG4iLAotCQkJCSAgIChsb25nIGxvbmcpZW5naW5lLT5oYW5nY2hlY2suYWN0aGQsCi0JCQkJICAg
aW50ZWxfZW5naW5lX2dldF9hY3RpdmVfaGVhZChlbmdpbmUpKTsKLQotCQkJaW50ZWxfZW5naW5l
X2dldF9pbnN0ZG9uZShlbmdpbmUsICZpbnN0ZG9uZSk7Ci0KLQkJCXNlcV9wdXRzKG0sICJcdGlu
c3Rkb25lIHJlYWQgPVxuIik7Ci0JCQlpOTE1X2luc3Rkb25lX2luZm8oaTkxNSwgbSwgJmluc3Rk
b25lKTsKLQotCQkJc2VxX3B1dHMobSwgIlx0aW5zdGRvbmUgYWNjdSA9XG4iKTsKLQkJCWk5MTVf
aW5zdGRvbmVfaW5mbyhpOTE1LCBtLAotCQkJCQkgICAmZW5naW5lLT5oYW5nY2hlY2suaW5zdGRv
bmUpOwotCQl9Ci0JfQotCi0JcmV0dXJuIDA7Ci19Ci0KIHN0YXRpYyBpbnQgaXJvbmxha2VfZHJw
Y19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKQEAgLTQzMzksNyArNDI1Myw2IEBAIHN0
YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2luZm9fbGlzdCBpOTE1X2RlYnVnZnNfbGlzdFtdID0gewog
CXsiaTkxNV9ndWNfc3RhZ2VfcG9vbCIsIGk5MTVfZ3VjX3N0YWdlX3Bvb2wsIDB9LAogCXsiaTkx
NV9odWNfbG9hZF9zdGF0dXMiLCBpOTE1X2h1Y19sb2FkX3N0YXR1c19pbmZvLCAwfSwKIAl7Imk5
MTVfZnJlcXVlbmN5X2luZm8iLCBpOTE1X2ZyZXF1ZW5jeV9pbmZvLCAwfSwKLQl7Imk5MTVfaGFu
Z2NoZWNrX2luZm8iLCBpOTE1X2hhbmdjaGVja19pbmZvLCAwfSwKIAl7Imk5MTVfZHJwY19pbmZv
IiwgaTkxNV9kcnBjX2luZm8sIDB9LAogCXsiaTkxNV9yaW5nX2ZyZXFfdGFibGUiLCBpOTE1X3Jp
bmdfZnJlcV90YWJsZSwgMH0sCiAJeyJpOTE1X2Zyb250YnVmZmVyX3RyYWNraW5nIiwgaTkxNV9m
cm9udGJ1ZmZlcl90cmFja2luZywgMH0sCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2Rydi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYwppbmRleCBmMDJh
MzQ3MjIyMTcuLjFkYWU0M2VkNGM0OCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9kcnYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCkBAIC0xNTQ2
LDEwICsxNTQ2LDcgQEAgdm9pZCBpOTE1X2RyaXZlcl9yZW1vdmUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCiAKIAlpOTE1X2RyaXZlcl9tb2Rlc2V0X3JlbW92ZShpOTE1KTsKIAotCS8q
IEZyZWUgZXJyb3Igc3RhdGUgYWZ0ZXIgaW50ZXJydXB0cyBhcmUgZnVsbHkgZGlzYWJsZWQuICov
Ci0JY2FuY2VsX2RlbGF5ZWRfd29ya19zeW5jKCZpOTE1LT5ndC5oYW5nY2hlY2sud29yayk7CiAJ
aTkxNV9yZXNldF9lcnJvcl9zdGF0ZShpOTE1KTsKLQogCWk5MTVfZ2VtX2RyaXZlcl9yZW1vdmUo
aTkxNSk7CiAKIAlpbnRlbF9wb3dlcl9kb21haW5zX2RyaXZlcl9yZW1vdmUoaTkxNSk7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9kcnYuaAppbmRleCBjNDZiMzM5MDY0YzAuLjE5ZjViMDYwOGE1NiAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAorKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2Rydi5oCkBAIC0xODQ3LDcgKzE4NDcsNiBAQCB2b2lkIGk5MTVfZHJpdmVy
X3JlbW92ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7CiBpbnQgaTkxNV9yZXN1bWVf
c3dpdGNoZXJvbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7CiBpbnQgaTkxNV9zdXNw
ZW5kX3N3aXRjaGVyb28oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHBtX21lc3NhZ2Vf
dCBzdGF0ZSk7CiAKLXZvaWQgaW50ZWxfZW5naW5lX2luaXRfaGFuZ2NoZWNrKHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSk7CiBpbnQgdmx2X2ZvcmNlX2dmeF9jbG9jayhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGJvb2wgb24pOwogCiBzdGF0aWMgaW5saW5lIGJvb2wg
aW50ZWxfZ3Z0X2FjdGl2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuYwppbmRleCA1Y2Y0ZWVkNWFkZDguLjQ3MjM5ZGY2
NTNmMiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jCkBAIC01MzQsMTAgKzUz
NCw2IEBAIHN0YXRpYyB2b2lkIGVycm9yX3ByaW50X2VuZ2luZShzdHJ1Y3QgZHJtX2k5MTVfZXJy
b3Jfc3RhdGVfYnVmICptLAogCX0KIAllcnJfcHJpbnRmKG0sICIgIHJpbmctPmhlYWQ6IDB4JTA4
eFxuIiwgZWUtPmNwdV9yaW5nX2hlYWQpOwogCWVycl9wcmludGYobSwgIiAgcmluZy0+dGFpbDog
MHglMDh4XG4iLCBlZS0+Y3B1X3JpbmdfdGFpbCk7Ci0JZXJyX3ByaW50ZihtLCAiICBoYW5nY2hl
Y2sgdGltZXN0YW1wOiAlZG1zICglbHUlcylcbiIsCi0JCSAgIGppZmZpZXNfdG9fbXNlY3MoZWUt
PmhhbmdjaGVja190aW1lc3RhbXAgLSBlcG9jaCksCi0JCSAgIGVlLT5oYW5nY2hlY2tfdGltZXN0
YW1wLAotCQkgICBlZS0+aGFuZ2NoZWNrX3RpbWVzdGFtcCA9PSBlcG9jaCA/ICI7IGVwb2NoIiA6
ICIiKTsKIAllcnJfcHJpbnRmKG0sICIgIGVuZ2luZSByZXNldCBjb3VudDogJXVcbiIsIGVlLT5y
ZXNldF9jb3VudCk7CiAKIAlmb3IgKG4gPSAwOyBuIDwgZWUtPm51bV9wb3J0czsgbisrKSB7CkBA
IC02NzksMTEgKzY3NSw4IEBAIHN0YXRpYyB2b2lkIF9fZXJyX3ByaW50X3RvX3NnbChzdHJ1Y3Qg
ZHJtX2k5MTVfZXJyb3Jfc3RhdGVfYnVmICptLAogCXRzID0ga3RpbWVfdG9fdGltZXNwZWM2NChl
cnJvci0+dXB0aW1lKTsKIAllcnJfcHJpbnRmKG0sICJVcHRpbWU6ICVsbGQgcyAlbGQgdXNcbiIs
CiAJCSAgIChzNjQpdHMudHZfc2VjLCB0cy50dl9uc2VjIC8gTlNFQ19QRVJfVVNFQyk7Ci0JZXJy
X3ByaW50ZihtLCAiRXBvY2g6ICVsdSBqaWZmaWVzICgldSBIWilcbiIsIGVycm9yLT5lcG9jaCwg
SFopOwotCWVycl9wcmludGYobSwgIkNhcHR1cmU6ICVsdSBqaWZmaWVzOyAlZCBtcyBhZ28sICVk
IG1zIGFmdGVyIGVwb2NoXG4iLAotCQkgICBlcnJvci0+Y2FwdHVyZSwKLQkJICAgamlmZmllc190
b19tc2VjcyhqaWZmaWVzIC0gZXJyb3ItPmNhcHR1cmUpLAotCQkgICBqaWZmaWVzX3RvX21zZWNz
KGVycm9yLT5jYXB0dXJlIC0gZXJyb3ItPmVwb2NoKSk7CisJZXJyX3ByaW50ZihtLCAiQ2FwdHVy
ZTogJWx1IGppZmZpZXM7ICVkIG1zIGFnb1xuIiwKKwkJICAgZXJyb3ItPmNhcHR1cmUsIGppZmZp
ZXNfdG9fbXNlY3MoamlmZmllcyAtIGVycm9yLT5jYXB0dXJlKSk7CiAKIAlmb3IgKGVlID0gZXJy
b3ItPmVuZ2luZTsgZWU7IGVlID0gZWUtPm5leHQpCiAJCWVycl9wcmludGYobSwgIkFjdGl2ZSBw
cm9jZXNzIChvbiByaW5nICVzKTogJXMgWyVkXVxuIiwKQEAgLTc0Miw3ICs3MzUsNyBAQCBzdGF0
aWMgdm9pZCBfX2Vycl9wcmludF90b19zZ2woc3RydWN0IGRybV9pOTE1X2Vycm9yX3N0YXRlX2J1
ZiAqbSwKIAkJZXJyX3ByaW50ZihtLCAiR1RUX0NBQ0hFX0VOOiAweCUwOHhcbiIsIGVycm9yLT5n
dHRfY2FjaGUpOwogCiAJZm9yIChlZSA9IGVycm9yLT5lbmdpbmU7IGVlOyBlZSA9IGVlLT5uZXh0
KQotCQllcnJvcl9wcmludF9lbmdpbmUobSwgZWUsIGVycm9yLT5lcG9jaCk7CisJCWVycm9yX3By
aW50X2VuZ2luZShtLCBlZSwgZXJyb3ItPmNhcHR1cmUpOwogCiAJZm9yIChlZSA9IGVycm9yLT5l
bmdpbmU7IGVlOyBlZSA9IGVlLT5uZXh0KSB7CiAJCWNvbnN0IHN0cnVjdCBkcm1faTkxNV9lcnJv
cl9vYmplY3QgKm9iajsKQEAgLTc3MCw3ICs3NjMsNyBAQCBzdGF0aWMgdm9pZCBfX2Vycl9wcmlu
dF90b19zZ2woc3RydWN0IGRybV9pOTE1X2Vycm9yX3N0YXRlX2J1ZiAqbSwKIAkJCWZvciAoaiA9
IDA7IGogPCBlZS0+bnVtX3JlcXVlc3RzOyBqKyspCiAJCQkJZXJyb3JfcHJpbnRfcmVxdWVzdCht
LCAiICIsCiAJCQkJCQkgICAgJmVlLT5yZXF1ZXN0c1tqXSwKLQkJCQkJCSAgICBlcnJvci0+ZXBv
Y2gpOworCQkJCQkJICAgIGVycm9yLT5jYXB0dXJlKTsKIAkJfQogCiAJCXByaW50X2Vycm9yX29i
aihtLCBlZS0+ZW5naW5lLCAicmluZ2J1ZmZlciIsIGVlLT5yaW5nYnVmZmVyKTsKQEAgLTExNDQs
OCArMTEzNyw2IEBAIHN0YXRpYyB2b2lkIGVycm9yX3JlY29yZF9lbmdpbmVfcmVnaXN0ZXJzKHN0
cnVjdCBpOTE1X2dwdV9zdGF0ZSAqZXJyb3IsCiAJfQogCiAJZWUtPmlkbGUgPSBpbnRlbF9lbmdp
bmVfaXNfaWRsZShlbmdpbmUpOwotCWlmICghZWUtPmlkbGUpCi0JCWVlLT5oYW5nY2hlY2tfdGlt
ZXN0YW1wID0gZW5naW5lLT5oYW5nY2hlY2suYWN0aW9uX3RpbWVzdGFtcDsKIAllZS0+cmVzZXRf
Y291bnQgPSBpOTE1X3Jlc2V0X2VuZ2luZV9jb3VudCgmZGV2X3ByaXYtPmdwdV9lcnJvciwKIAkJ
CQkJCSAgZW5naW5lKTsKIApAQCAtMTY1NywyMCArMTY0OCw2IEBAIHN0YXRpYyB2b2lkIGNhcHR1
cmVfcGFyYW1zKHN0cnVjdCBpOTE1X2dwdV9zdGF0ZSAqZXJyb3IpCiAJaTkxNV9wYXJhbXNfY29w
eSgmZXJyb3ItPnBhcmFtcywgJmk5MTVfbW9kcGFyYW1zKTsKIH0KIAotc3RhdGljIHVuc2lnbmVk
IGxvbmcgY2FwdHVyZV9maW5kX2Vwb2NoKGNvbnN0IHN0cnVjdCBpOTE1X2dwdV9zdGF0ZSAqZXJy
b3IpCi17Ci0JY29uc3Qgc3RydWN0IGRybV9pOTE1X2Vycm9yX2VuZ2luZSAqZWU7Ci0JdW5zaWdu
ZWQgbG9uZyBlcG9jaCA9IGVycm9yLT5jYXB0dXJlOwotCi0JZm9yIChlZSA9IGVycm9yLT5lbmdp
bmU7IGVlOyBlZSA9IGVlLT5uZXh0KSB7Ci0JCWlmIChlZS0+aGFuZ2NoZWNrX3RpbWVzdGFtcCAm
JgotCQkgICAgdGltZV9iZWZvcmUoZWUtPmhhbmdjaGVja190aW1lc3RhbXAsIGVwb2NoKSkKLQkJ
CWVwb2NoID0gZWUtPmhhbmdjaGVja190aW1lc3RhbXA7Ci0JfQotCi0JcmV0dXJuIGVwb2NoOwot
fQotCiBzdGF0aWMgdm9pZCBjYXB0dXJlX2ZpbmlzaChzdHJ1Y3QgaTkxNV9ncHVfc3RhdGUgKmVy
cm9yKQogewogCXN0cnVjdCBpOTE1X2dndHQgKmdndHQgPSAmZXJyb3ItPmk5MTUtPmdndHQ7CkBA
IC0xNzIyLDggKzE2OTksNiBAQCBpOTE1X2NhcHR1cmVfZ3B1X3N0YXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQogCWVycm9yLT5vdmVybGF5ID0gaW50ZWxfb3ZlcmxheV9jYXB0dXJl
X2Vycm9yX3N0YXRlKGk5MTUpOwogCWVycm9yLT5kaXNwbGF5ID0gaW50ZWxfZGlzcGxheV9jYXB0
dXJlX2Vycm9yX3N0YXRlKGk5MTUpOwogCi0JZXJyb3ItPmVwb2NoID0gY2FwdHVyZV9maW5kX2Vw
b2NoKGVycm9yKTsKLQogCWNhcHR1cmVfZmluaXNoKGVycm9yKTsKIAljb21wcmVzc19maW5pKCZj
b21wcmVzcyk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vy
cm9yLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5oCmluZGV4IDdmMWNk
MGIxZmVmNy4uNGRjMzZkNmVlM2EyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2dwdV9lcnJvci5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9y
LmgKQEAgLTM0LDcgKzM0LDYgQEAgc3RydWN0IGk5MTVfZ3B1X3N0YXRlIHsKIAlrdGltZV90IGJv
b3R0aW1lOwogCWt0aW1lX3QgdXB0aW1lOwogCXVuc2lnbmVkIGxvbmcgY2FwdHVyZTsKLQl1bnNp
Z25lZCBsb25nIGVwb2NoOwogCiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTU7CiAKQEAg
LTg2LDcgKzg1LDYgQEAgc3RydWN0IGk5MTVfZ3B1X3N0YXRlIHsKIAogCQkvKiBTb2Z0d2FyZSB0
cmFja2VkIHN0YXRlICovCiAJCWJvb2wgaWRsZTsKLQkJdW5zaWduZWQgbG9uZyBoYW5nY2hlY2tf
dGltZXN0YW1wOwogCQlpbnQgbnVtX3JlcXVlc3RzOwogCQl1MzIgcmVzZXRfY291bnQ7CiAKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcHJpb2xpc3RfdHlwZXMuaCBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcHJpb2xpc3RfdHlwZXMuaAppbmRleCBhZThiYjNjYjYy
N2UuLjczMmFhZDE0ODg4MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9w
cmlvbGlzdF90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcHJpb2xpc3Rf
dHlwZXMuaApAQCAtMTYsNiArMTYsMTIgQEAgZW51bSB7CiAJSTkxNV9QUklPUklUWV9NSU4gPSBJ
OTE1X0NPTlRFWFRfTUlOX1VTRVJfUFJJT1JJVFkgLSAxLAogCUk5MTVfUFJJT1JJVFlfTk9STUFM
ID0gSTkxNV9DT05URVhUX0RFRkFVTFRfUFJJT1JJVFksCiAJSTkxNV9QUklPUklUWV9NQVggPSBJ
OTE1X0NPTlRFWFRfTUFYX1VTRVJfUFJJT1JJVFkgKyAxLAorCisJLyogQSBwcmVlbXB0aXZlIHB1
bHNlIHVzZWQgdG8gbW9uaXRvciB0aGUgaGVhbHRoIG9mIGVhY2ggZW5naW5lICovCisJSTkxNV9Q
UklPUklUWV9IRUFSVEJFQVQsCisKKwkvKiBJbnRlcmFjdGl2ZSB3b3JrbG9hZCwgc2NoZWR1bGVk
IGZvciBpbW1lZGlhdGUgcGFnZWZsaXBwaW5nICovCisJSTkxNV9QUklPUklUWV9ESVNQTEFZLAog
fTsKIAogI2RlZmluZSBJOTE1X1VTRVJfUFJJT1JJVFlfU0hJRlQgMgotLSAKMi4yMy4wCgpfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFp
bGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5m
cmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

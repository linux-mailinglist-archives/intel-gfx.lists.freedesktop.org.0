Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 40EF1112AD5
	for <lists+intel-gfx@lfdr.de>; Wed,  4 Dec 2019 13:00:40 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9DC236E0E9;
	Wed,  4 Dec 2019 12:00:38 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id D31E06E0E9
 for <intel-gfx@lists.freedesktop.org>; Wed,  4 Dec 2019 12:00:36 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19456010-1500050 
 for <intel-gfx@lists.freedesktop.org>; Wed, 04 Dec 2019 12:00:30 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed,  4 Dec 2019 12:00:32 +0000
Message-Id: <20191204120032.3682839-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0
MIME-Version: 1.0
Subject: [Intel-gfx] [CI] drm/i915: Introduce DRM_I915_GEM_MMAP_OFFSET
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogQWJkaWVsIEphbnVsZ3VlIDxhYmRpZWwuamFudWxndWVAbGludXguaW50ZWwuY29tPgoK
VGhpcyBpcyByZWFsbHkganVzdCBhbiBhbGlhcyBvZiBtbWFwX2d0dC4gVGhlICdtbWFwIG9mZnNl
dCcgbm9tZW5jbGF0dXJlCmNvbWVzIGZyb20gdGhlIHZhbHVlIHJldHVybmVkIGJ5IHRoaXMgaW9j
dGwgd2hpY2ggaXMgdGhlIG9mZnNldCBpbnRvIHRoZQpkZXZpY2UgZmQgd2hpY2ggdXNlcnBhY2Ug
dXNlcyB3aXRoIG1tYXAoMikuCgptbWFwX2d0dCB3YXMgb3VyIGluaXRpYWwgbW1hcF9vZmZzZXQg
aW1wbGVtZW50YXRpb24sIHRoaXMgZXh0ZW5kcwpvdXIgQ1BVIG1tYXAgc3VwcG9ydCB0byBhbGxv
dyBhZGRpdGlvbmFsIGZhdWx0IGhhbmRsZXJzIHRoYXQgZGVwZW5kcyBvbgp0aGUgb2JqZWN0J3Mg
YmFja2luZyBwYWdlcy4KCk5vdGUgdGhhdCB3ZSBtdWx0aXBsZXggbW1hcF9ndHQgYW5kIG1tYXBf
b2Zmc2V0IHRocm91Z2ggdGhlIHNhbWUgaW9jdGwsCmFuZCB1c2UgdGhlIHplcm8gZXh0ZW5kaW5n
IGJlaGF2aW91ciBvZiBkcm0gdG8gZGlmZmVyZW50aWF0ZSBiZXR3ZWVuCnRoZW0sIHdoZW4gd2Ug
aW5zcGVjdCB0aGUgZmxhZ3MuCgpUbyBzdXBwb3J0IG11bHRpcGxlIG1tYXAgdHlwZXMgb24gYW4g
b2JqZWN0IHdlIG5lZWQgdG8gc3VwcG9ydCBtdWx0aXBsZQptbWFwX29mZnNldHMgZm9yIGFuIG9i
amVjdCAoZWFjaCBvZmZzZXQgaW4gdGhlIGdsb2JhbCBkZXZpY2UgYWRkcmVzcwpzcGFjZSBjb3Jy
ZXNwb25kaW5nIHRvIGEgdW5pcXVlIGluc3RhbmNlIG9mIHRoZSBvYmplY3QgZm9yIGEgZmlsZSAr
IG1tYXAKdHlwZSkuIEFzIHdlIGRyb3AgdGhlIHNpbXBsaWZpZWQgZHJtIGNvcmUgaWRlYSBvZiBh
IHNpbmdsZSBtbWFwX29mZnNldCwKd2UgbmVlZCB0byBwcm92aWRlIHJlcGxhY2VtZW50IGhvb2tz
IGZvciB0aGUgZHVtYiBtbWFwIGludGVyZmFjZSBhcwp3ZWxsLgoKTGluazogaHR0cHM6Ly9naXRs
YWIuZnJlZWRlc2t0b3Aub3JnL21lc2EvbWVzYS9tZXJnZV9yZXF1ZXN0cy8xNjc1ClRlc3RjYXNl
OiBpZ3QvZ2VtX21tYXBfb2Zmc2V0ClNpZ25lZC1vZmYtYnk6IEFiZGllbCBKYW51bGd1ZSA8YWJk
aWVsLmphbnVsZ3VlQGxpbnV4LmludGVsLmNvbT4KU2lnbmVkLW9mZi1ieTogTWF0dGhldyBBdWxk
IDxtYXR0aGV3LmF1bGRAaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9kb21haW4uYyAgICB8ICAgMSArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1faW9jdGxzLmggICAgfCAgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV9tbWFuLmMgICAgICB8IDQ2MSArKysrKysrKysrKysrKy0tLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9tbWFuLmggICAgICB8ICAzMSArKwogZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5jICAgIHwgIDI3ICsKIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaCAgICB8ICAgNyArLQogLi4uL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fb2JqZWN0X3R5cGVzLmggIHwgIDIzICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9wYWdlcy5jICAgICB8ICAgMyArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fdGlsaW5nLmMgICAgfCAgIDEgKwogLi4uL2RybS9pOTE1L2dlbS9zZWxmdGVz
dHMvaTkxNV9nZW1fbW1hbi5jICAgIHwgIDg4ICsrKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX3Jlc2V0LmMgICAgICAgICB8ICAgNyArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kcnYuYyAgICAgICAgICAgICAgIHwgIDE1ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2Rydi5oICAgICAgICAgICAgICAgfCAgIDQgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9n
ZW0uYyAgICAgICAgICAgICAgIHwgICAzICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dl
dHBhcmFtLmMgICAgICAgICAgfCAgIDEgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEu
YyAgICAgICAgICAgICAgIHwgICA1ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5o
ICAgICAgICAgICAgICAgfCAgIDMgKwogaW5jbHVkZS91YXBpL2RybS9pOTE1X2RybS5oICAgICAg
ICAgICAgICAgICAgIHwgIDMyICsrCiAxOCBmaWxlcyBjaGFuZ2VkLCA1NzQgaW5zZXJ0aW9ucygr
KSwgMTQyIGRlbGV0aW9ucygtKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9tbWFuLmgKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fZG9tYWluLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fZG9tYWluLmMKaW5kZXggMzExOWY3YmU5YmMwLi5mMjA2NDk1MDYyMmIgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9kb21haW4uYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZG9tYWluLmMKQEAgLTEzLDYgKzEzLDcgQEAKICNp
bmNsdWRlICJpOTE1X2dlbV9vYmplY3QuaCIKICNpbmNsdWRlICJpOTE1X3ZtYS5oIgogI2luY2x1
ZGUgImk5MTVfZ2VtX2xtZW0uaCIKKyNpbmNsdWRlICJpOTE1X2dlbV9tbWFuLmgiCiAKIHN0YXRp
YyB2b2lkIF9faTkxNV9nZW1fb2JqZWN0X2ZsdXNoX2Zvcl9kaXNwbGF5KHN0cnVjdCBkcm1faTkx
NV9nZW1fb2JqZWN0ICpvYmopCiB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1faW9jdGxzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
aW9jdGxzLmgKaW5kZXggZGRjN2YyYTUyYjNlLi44N2Q4YjI3ZjQyNmQgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9pb2N0bHMuaAorKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1faW9jdGxzLmgKQEAgLTI4LDggKzI4LDggQEAgaW50IGk5
MTVfZ2VtX21hZHZpc2VfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwK
IAkJCSAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSk7CiBpbnQgaTkxNV9nZW1fbW1hcF9pb2N0bChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCQkJc3RydWN0IGRybV9maWxlICpm
aWxlKTsKLWludCBpOTE1X2dlbV9tbWFwX2d0dF9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
LCB2b2lkICpkYXRhLAotCQkJICAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSk7CitpbnQgaTkxNV9n
ZW1fbW1hcF9vZmZzZXRfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwK
KwkJCSAgICAgICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpOwogaW50IGk5MTVfZ2VtX3ByZWFkX2lv
Y3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAJCQkgc3RydWN0IGRybV9m
aWxlICpmaWxlKTsKIGludCBpOTE1X2dlbV9wd3JpdGVfaW9jdGwoc3RydWN0IGRybV9kZXZpY2Ug
KmRldiwgdm9pZCAqZGF0YSwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9tbWFuLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fbW1hbi5j
CmluZGV4IGQ2MDk3MzYwM2NjMS4uMzdhYWJiZmE4NjlhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fbW1hbi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9tbWFuLmMKQEAgLTUsNiArNSw3IEBACiAgKi8KIAogI2luY2x1ZGUgPGxp
bnV4L21tYW4uaD4KKyNpbmNsdWRlIDxsaW51eC9wZm5fdC5oPgogI2luY2x1ZGUgPGxpbnV4L3Np
emVzLmg+CiAKICNpbmNsdWRlICJndC9pbnRlbF9ndC5oIgpAQCAtMTQsNiArMTUsNyBAQAogI2lu
Y2x1ZGUgImk5MTVfZ2VtX2d0dC5oIgogI2luY2x1ZGUgImk5MTVfZ2VtX2lvY3Rscy5oIgogI2lu
Y2x1ZGUgImk5MTVfZ2VtX29iamVjdC5oIgorI2luY2x1ZGUgImk5MTVfZ2VtX21tYW4uaCIKICNp
bmNsdWRlICJpOTE1X3RyYWNlLmgiCiAjaW5jbHVkZSAiaTkxNV92bWEuaCIKIApAQCAtMTQ0LDYg
KzE0Niw5IEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQgdGlsZV9yb3dfcGFnZXMoY29uc3Qgc3RydWN0
IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKICAqIDMgLSBSZW1vdmUgaW1wbGljaXQgc2V0LWRv
bWFpbihHVFQpIGFuZCBzeW5jaHJvbmlzYXRpb24gb24gaW5pdGlhbAogICogICAgIHBhZ2VmYXVs
dDsgc3dhcGluIHJlbWFpbnMgdHJhbnNwYXJlbnQuCiAgKgorICogNCAtIFN1cHBvcnQgbXVsdGlw
bGUgZmF1bHQgaGFuZGxlcnMgcGVyIG9iamVjdCBkZXBlbmRpbmcgb24gb2JqZWN0J3MKKyAqICAg
ICBiYWNraW5nIHN0b3JhZ2UgKGEuay5hLiBNTUFQX09GRlNFVCkuCisgKgogICogUmVzdHJpY3Rp
b25zOgogICoKICAqICAqIHNub29wYWJsZSBvYmplY3RzIGNhbm5vdCBiZSBhY2Nlc3NlZCB2aWEg
dGhlIEdUVC4gSXQgY2FuIGNhdXNlIG1hY2hpbmUKQEAgLTE3MSw3ICsxNzYsNyBAQCBzdGF0aWMg
dW5zaWduZWQgaW50IHRpbGVfcm93X3BhZ2VzKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICpvYmopCiAgKi8KIGludCBpOTE1X2dlbV9tbWFwX2d0dF92ZXJzaW9uKHZvaWQpCiB7Ci0J
cmV0dXJuIDM7CisJcmV0dXJuIDQ7CiB9CiAKIHN0YXRpYyBpbmxpbmUgc3RydWN0IGk5MTVfZ2d0
dF92aWV3CkBAIC0xOTcsMjkgKzIwMiw4MyBAQCBjb21wdXRlX3BhcnRpYWxfdmlldyhjb25zdCBz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCXJldHVybiB2aWV3OwogfQogCi0vKioK
LSAqIGk5MTVfZ2VtX2ZhdWx0IC0gZmF1bHQgYSBwYWdlIGludG8gdGhlIEdUVAotICogQHZtZjog
ZmF1bHQgaW5mbwotICoKLSAqIFRoZSBmYXVsdCBoYW5kbGVyIGlzIHNldCB1cCBieSBkcm1fZ2Vt
X21tYXAoKSB3aGVuIGEgb2JqZWN0IGlzIEdUVCBtYXBwZWQKLSAqIGZyb20gdXNlcnNwYWNlLiAg
VGhlIGZhdWx0IGhhbmRsZXIgdGFrZXMgY2FyZSBvZiBiaW5kaW5nIHRoZSBvYmplY3QgdG8KLSAq
IHRoZSBHVFQgKGlmIG5lZWRlZCksIGFsbG9jYXRpbmcgYW5kIHByb2dyYW1taW5nIGEgZmVuY2Ug
cmVnaXN0ZXIgKGFnYWluLAotICogb25seSBpZiBuZWVkZWQgYmFzZWQgb24gd2hldGhlciB0aGUg
b2xkIHJlZyBpcyBzdGlsbCB2YWxpZCBvciB0aGUgb2JqZWN0Ci0gKiBpcyB0aWxlZCkgYW5kIGlu
c2VydGluZyBhIG5ldyBQVEUgaW50byB0aGUgZmF1bHRpbmcgcHJvY2Vzcy4KLSAqCi0gKiBOb3Rl
IHRoYXQgdGhlIGZhdWx0aW5nIHByb2Nlc3MgbWF5IGludm9sdmUgZXZpY3RpbmcgZXhpc3Rpbmcg
b2JqZWN0cwotICogZnJvbSB0aGUgR1RUIGFuZC9vciBmZW5jZSByZWdpc3RlcnMgdG8gbWFrZSBy
b29tLiAgU28gcGVyZm9ybWFuY2UgbWF5Ci0gKiBzdWZmZXIgaWYgdGhlIEdUVCB3b3JraW5nIHNl
dCBpcyBsYXJnZSBvciB0aGVyZSBhcmUgZmV3IGZlbmNlIHJlZ2lzdGVycwotICogbGVmdC4KLSAq
Ci0gKiBUaGUgY3VycmVudCBmZWF0dXJlIHNldCBzdXBwb3J0ZWQgYnkgaTkxNV9nZW1fZmF1bHQo
KSBhbmQgdGh1cyBHVFQgbW1hcHMKLSAqIGlzIGV4cG9zZWQgdmlhIEk5MTVfUEFSQU1fTU1BUF9H
VFRfVkVSU0lPTiAoc2VlIGk5MTVfZ2VtX21tYXBfZ3R0X3ZlcnNpb24pLgotICovCi12bV9mYXVs
dF90IGk5MTVfZ2VtX2ZhdWx0KHN0cnVjdCB2bV9mYXVsdCAqdm1mKQorc3RhdGljIHZtX2ZhdWx0
X3QgaTkxNV9lcnJvcl90b192bWZfZmF1bHQoaW50IGVycikKK3sKKwlzd2l0Y2ggKGVycikgewor
CWRlZmF1bHQ6CisJCVdBUk5fT05DRShlcnIsICJ1bmhhbmRsZWQgZXJyb3IgaW4gJXM6ICVpXG4i
LCBfX2Z1bmNfXywgZXJyKTsKKwkJLyogZmFsbHRocm91Z2ggKi8KKwljYXNlIC1FSU86IC8qIHNo
bWVtZnMgZmFpbHVyZSBmcm9tIHN3YXAgZGV2aWNlICovCisJY2FzZSAtRUZBVUxUOiAvKiBwdXJn
ZWQgb2JqZWN0ICovCisJY2FzZSAtRU5PREVWOiAvKiBiYWQgb2JqZWN0LCBob3cgZGlkIHlvdSBn
ZXQgaGVyZSEgKi8KKwkJcmV0dXJuIFZNX0ZBVUxUX1NJR0JVUzsKKworCWNhc2UgLUVOT1NQQzog
Lyogc2htZW1mcyBhbGxvY2F0aW9uIGZhaWx1cmUgKi8KKwljYXNlIC1FTk9NRU06IC8qIG91ciBh
bGxvY2F0aW9uIGZhaWx1cmUgKi8KKwkJcmV0dXJuIFZNX0ZBVUxUX09PTTsKKworCWNhc2UgMDoK
KwljYXNlIC1FQUdBSU46CisJY2FzZSAtRVJFU1RBUlRTWVM6CisJY2FzZSAtRUlOVFI6CisJY2Fz
ZSAtRUJVU1k6CisJCS8qCisJCSAqIEVCVVNZIGlzIG9rOiB0aGlzIGp1c3QgbWVhbnMgdGhhdCBh
bm90aGVyIHRocmVhZAorCQkgKiBhbHJlYWR5IGRpZCB0aGUgam9iLgorCQkgKi8KKwkJcmV0dXJu
IFZNX0ZBVUxUX05PUEFHRTsKKwl9Cit9CisKK3N0YXRpYyB2bV9mYXVsdF90IHZtX2ZhdWx0X2Nw
dShzdHJ1Y3Qgdm1fZmF1bHQgKnZtZikKK3sKKwlzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKmFyZWEg
PSB2bWYtPnZtYTsKKwlzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldCAqbW1vID0gYXJlYS0+dm1fcHJp
dmF0ZV9kYXRhOworCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPSBtbW8tPm9iajsK
Kwl1bnNpZ25lZCBsb25nIGksIHNpemUgPSBhcmVhLT52bV9lbmQgLSBhcmVhLT52bV9zdGFydDsK
Kwlib29sIHdyaXRlID0gYXJlYS0+dm1fZmxhZ3MgJiBWTV9XUklURTsKKwl2bV9mYXVsdF90IHJl
dCA9IFZNX0ZBVUxUX1NJR0JVUzsKKwlpbnQgZXJyOworCisJaWYgKCFpOTE1X2dlbV9vYmplY3Rf
aGFzX3N0cnVjdF9wYWdlKG9iaikpCisJCXJldHVybiByZXQ7CisKKwkvKiBTYW5pdHkgY2hlY2sg
dGhhdCB3ZSBhbGxvdyB3cml0aW5nIGludG8gdGhpcyBvYmplY3QgKi8KKwlpZiAoaTkxNV9nZW1f
b2JqZWN0X2lzX3JlYWRvbmx5KG9iaikgJiYgd3JpdGUpCisJCXJldHVybiByZXQ7CisKKwllcnIg
PSBpOTE1X2dlbV9vYmplY3RfcGluX3BhZ2VzKG9iaik7CisJaWYgKGVycikKKwkJcmV0dXJuIGk5
MTVfZXJyb3JfdG9fdm1mX2ZhdWx0KGVycik7CisKKwkvKiBQVEVzIGFyZSByZXZva2VkIGluIG9i
ai0+b3BzLT5wdXRfcGFnZXMoKSAqLworCWZvciAoaSA9IDA7IGkgPCBzaXplID4+IFBBR0VfU0hJ
RlQ7IGkrKykgeworCQlzdHJ1Y3QgcGFnZSAqcGFnZSA9IGk5MTVfZ2VtX29iamVjdF9nZXRfcGFn
ZShvYmosIGkpOworCisJCXJldCA9IHZtZl9pbnNlcnRfcGZuKGFyZWEsCisJCQkJICAgICAodW5z
aWduZWQgbG9uZylhcmVhLT52bV9zdGFydCArIGkgKiBQQUdFX1NJWkUsCisJCQkJICAgICBwYWdl
X3RvX3BmbihwYWdlKSk7CisJCWlmIChyZXQgIT0gVk1fRkFVTFRfTk9QQUdFKQorCQkJYnJlYWs7
CisJfQorCisJaWYgKHdyaXRlKSB7CisJCUdFTV9CVUdfT04oIWk5MTVfZ2VtX29iamVjdF9oYXNf
cGlubmVkX3BhZ2VzKG9iaikpOworCQlvYmotPmNhY2hlX2RpcnR5ID0gdHJ1ZTsgLyogWFhYIGZs
dXNoIGFmdGVyIFBBVCB1cGRhdGU/ICovCisJCW9iai0+bW0uZGlydHkgPSB0cnVlOworCX0KKwor
CWk5MTVfZ2VtX29iamVjdF91bnBpbl9wYWdlcyhvYmopOworCisJcmV0dXJuIHJldDsKK30KKwor
c3RhdGljIHZtX2ZhdWx0X3Qgdm1fZmF1bHRfZ3R0KHN0cnVjdCB2bV9mYXVsdCAqdm1mKQogewog
I2RlZmluZSBNSU5fQ0hVTktfUEFHRVMgKFNaXzFNID4+IFBBR0VfU0hJRlQpCiAJc3RydWN0IHZt
X2FyZWFfc3RydWN0ICphcmVhID0gdm1mLT52bWE7Ci0Jc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iaiA9IHRvX2ludGVsX2JvKGFyZWEtPnZtX3ByaXZhdGVfZGF0YSk7CisJc3RydWN0IGk5
MTVfbW1hcF9vZmZzZXQgKm1tbyA9IGFyZWEtPnZtX3ByaXZhdGVfZGF0YTsKKwlzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdCAqb2JqID0gbW1vLT5vYmo7CiAJc3RydWN0IGRybV9kZXZpY2UgKmRl
diA9IG9iai0+YmFzZS5kZXY7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGRldik7CiAJc3RydWN0IGludGVsX3J1bnRpbWVfcG0gKnJwbSA9ICZpOTE1LT5ydW50aW1l
X3BtOwpAQCAtMzEyLDYgKzM3MSw5IEBAIHZtX2ZhdWx0X3QgaTkxNV9nZW1fZmF1bHQoc3RydWN0
IHZtX2ZhdWx0ICp2bWYpCiAJCWxpc3RfYWRkKCZvYmotPnVzZXJmYXVsdF9saW5rLCAmaTkxNS0+
Z2d0dC51c2VyZmF1bHRfbGlzdCk7CiAJbXV0ZXhfdW5sb2NrKCZpOTE1LT5nZ3R0LnZtLm11dGV4
KTsKIAorCS8qIFRyYWNrIHRoZSBtbW8gYXNzb2NpYXRlZCB3aXRoIHRoZSBmZW5jZWQgdm1hICov
CisJdm1hLT5tbW8gPSBtbW87CisKIAlpZiAoSVNfQUNUSVZFKENPTkZJR19EUk1fSTkxNV9VU0VS
RkFVTFRfQVVUT1NVU1BFTkQpKQogCQlpbnRlbF93YWtlcmVmX2F1dG8oJmk5MTUtPmdndHQudXNl
cmZhdWx0X3dha2VyZWYsCiAJCQkJICAgbXNlY3NfdG9famlmZmllc190aW1lb3V0KENPTkZJR19E
Uk1fSTkxNV9VU0VSRkFVTFRfQVVUT1NVU1BFTkQpKTsKQEAgLTMzMiw2NyArMzk0LDM2IEBAIHZt
X2ZhdWx0X3QgaTkxNV9nZW1fZmF1bHQoc3RydWN0IHZtX2ZhdWx0ICp2bWYpCiAJaW50ZWxfcnVu
dGltZV9wbV9wdXQocnBtLCB3YWtlcmVmKTsKIAlpOTE1X2dlbV9vYmplY3RfdW5waW5fcGFnZXMo
b2JqKTsKIGVycjoKLQlzd2l0Y2ggKHJldCkgewotCWRlZmF1bHQ6Ci0JCVdBUk5fT05DRShyZXQs
ICJ1bmhhbmRsZWQgZXJyb3IgaW4gJXM6ICVpXG4iLCBfX2Z1bmNfXywgcmV0KTsKLQkJLyogZmFs
bHRocm91Z2ggKi8KLQljYXNlIC1FSU86IC8qIHNobWVtZnMgZmFpbHVyZSBmcm9tIHN3YXAgZGV2
aWNlICovCi0JY2FzZSAtRUZBVUxUOiAvKiBwdXJnZWQgb2JqZWN0ICovCi0JY2FzZSAtRU5PREVW
OiAvKiBiYWQgb2JqZWN0LCBob3cgZGlkIHlvdSBnZXQgaGVyZSEgKi8KLQkJcmV0dXJuIFZNX0ZB
VUxUX1NJR0JVUzsKLQotCWNhc2UgLUVOT1NQQzogLyogc2htZW1mcyBhbGxvY2F0aW9uIGZhaWx1
cmUgKi8KLQljYXNlIC1FTk9NRU06IC8qIG91ciBhbGxvY2F0aW9uIGZhaWx1cmUgKi8KLQkJcmV0
dXJuIFZNX0ZBVUxUX09PTTsKLQotCWNhc2UgMDoKLQljYXNlIC1FQUdBSU46Ci0JY2FzZSAtRVJF
U1RBUlRTWVM6Ci0JY2FzZSAtRUlOVFI6Ci0JY2FzZSAtRUJVU1k6Ci0JCS8qCi0JCSAqIEVCVVNZ
IGlzIG9rOiB0aGlzIGp1c3QgbWVhbnMgdGhhdCBhbm90aGVyIHRocmVhZAotCQkgKiBhbHJlYWR5
IGRpZCB0aGUgam9iLgotCQkgKi8KLQkJcmV0dXJuIFZNX0ZBVUxUX05PUEFHRTsKLQl9CisJcmV0
dXJuIGk5MTVfZXJyb3JfdG9fdm1mX2ZhdWx0KHJldCk7CiB9CiAKLXZvaWQgX19pOTE1X2dlbV9v
YmplY3RfcmVsZWFzZV9tbWFwKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCit2b2lk
IF9faTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcF9ndHQoc3RydWN0IGRybV9pOTE1X2dlbV9v
YmplY3QgKm9iaikKIHsKIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKIAogCUdFTV9CVUdfT04oIW9i
ai0+dXNlcmZhdWx0X2NvdW50KTsKIAotCW9iai0+dXNlcmZhdWx0X2NvdW50ID0gMDsKLQlsaXN0
X2RlbCgmb2JqLT51c2VyZmF1bHRfbGluayk7Ci0JZHJtX3ZtYV9ub2RlX3VubWFwKCZvYmotPmJh
c2Uudm1hX25vZGUsCi0JCQkgICBvYmotPmJhc2UuZGV2LT5hbm9uX2lub2RlLT5pX21hcHBpbmcp
OwotCiAJZm9yX2VhY2hfZ2d0dF92bWEodm1hLCBvYmopCi0JCWk5MTVfdm1hX3Vuc2V0X3VzZXJm
YXVsdCh2bWEpOworCQlpOTE1X3ZtYV9yZXZva2VfbW1hcCh2bWEpOworCisJR0VNX0JVR19PTihv
YmotPnVzZXJmYXVsdF9jb3VudCk7CiB9CiAKLS8qKgotICogaTkxNV9nZW1fb2JqZWN0X3JlbGVh
c2VfbW1hcCAtIHJlbW92ZSBwaHlzaWNhbCBwYWdlIG1hcHBpbmdzCi0gKiBAb2JqOiBvYmogaW4g
cXVlc3Rpb24KLSAqCi0gKiBQcmVzZXJ2ZSB0aGUgcmVzZXJ2YXRpb24gb2YgdGhlIG1tYXBwaW5n
IHdpdGggdGhlIERSTSBjb3JlIGNvZGUsIGJ1dAotICogcmVsaW5xdWlzaCBvd25lcnNoaXAgb2Yg
dGhlIHBhZ2VzIGJhY2sgdG8gdGhlIHN5c3RlbS4KLSAqCisvKgogICogSXQgaXMgdml0YWwgdGhh
dCB3ZSByZW1vdmUgdGhlIHBhZ2UgbWFwcGluZyBpZiB3ZSBoYXZlIG1hcHBlZCBhIHRpbGVkCiAg
KiBvYmplY3QgdGhyb3VnaCB0aGUgR1RUIGFuZCB0aGVuIGxvc2UgdGhlIGZlbmNlIHJlZ2lzdGVy
IGR1ZSB0bwogICogcmVzb3VyY2UgcHJlc3N1cmUuIFNpbWlsYXJseSBpZiB0aGUgb2JqZWN0IGhh
cyBiZWVuIG1vdmVkIG91dCBvZiB0aGUKICAqIGFwZXJ0dXJlLCB0aGFuIHBhZ2VzIG1hcHBlZCBp
bnRvIHVzZXJzcGFjZSBtdXN0IGJlIHJldm9rZWQuIFJlbW92aW5nIHRoZQogICogbWFwcGluZyB3
aWxsIHRoZW4gdHJpZ2dlciBhIHBhZ2UgZmF1bHQgb24gdGhlIG5leHQgdXNlciBhY2Nlc3MsIGFs
bG93aW5nCi0gKiBmaXh1cCBieSBpOTE1X2dlbV9mYXVsdCgpLgorICogZml4dXAgYnkgdm1fZmF1
bHRfZ3R0KCkuCiAgKi8KLXZvaWQgaTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcChzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQorc3RhdGljIHZvaWQgaTkxNV9nZW1fb2JqZWN0X3Jl
bGVhc2VfbW1hcF9ndHQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIHsKIAlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUob2JqLT5iYXNlLmRldik7CiAJaW50
ZWxfd2FrZXJlZl90IHdha2VyZWY7CiAKLQkvKiBTZXJpYWxpc2F0aW9uIGJldHdlZW4gdXNlciBH
VFQgYWNjZXNzIGFuZCBvdXIgY29kZSBkZXBlbmRzIHVwb24KKwkvKgorCSAqIFNlcmlhbGlzYXRp
b24gYmV0d2VlbiB1c2VyIEdUVCBhY2Nlc3MgYW5kIG91ciBjb2RlIGRlcGVuZHMgdXBvbgogCSAq
IHJldm9raW5nIHRoZSBDUFUncyBQVEUgd2hpbHN0IHRoZSBtdXRleCBpcyBoZWxkLiBUaGUgbmV4
dCB1c2VyCiAJICogcGFnZWZhdWx0IHRoZW4gaGFzIHRvIHdhaXQgdW50aWwgd2UgcmVsZWFzZSB0
aGUgbXV0ZXguCiAJICoKQEAgLTQwNiw5ICs0MzcsMTAgQEAgdm9pZCBpOTE1X2dlbV9vYmplY3Rf
cmVsZWFzZV9tbWFwKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiAJaWYgKCFvYmot
PnVzZXJmYXVsdF9jb3VudCkKIAkJZ290byBvdXQ7CiAKLQlfX2k5MTVfZ2VtX29iamVjdF9yZWxl
YXNlX21tYXAob2JqKTsKKwlfX2k5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXBfZ3R0KG9iaik7
CiAKLQkvKiBFbnN1cmUgdGhhdCB0aGUgQ1BVJ3MgUFRFIGFyZSByZXZva2VkIGFuZCB0aGVyZSBh
cmUgbm90IG91dHN0YW5kaW5nCisJLyoKKwkgKiBFbnN1cmUgdGhhdCB0aGUgQ1BVJ3MgUFRFIGFy
ZSByZXZva2VkIGFuZCB0aGVyZSBhcmUgbm90IG91dHN0YW5kaW5nCiAJICogbWVtb3J5IHRyYW5z
YWN0aW9ucyBmcm9tIHVzZXJzcGFjZSBiZWZvcmUgd2UgcmV0dXJuLiBUaGUgVExCCiAJICogZmx1
c2hpbmcgaW1wbGllZCBhYm92ZSBieSBjaGFuZ2luZyB0aGUgUFRFIGFib3ZlICpzaG91bGQqIGJl
CiAJICogc3VmZmljaWVudCwgYW4gZXh0cmEgYmFycmllciBoZXJlIGp1c3QgcHJvdmlkZXMgdXMg
d2l0aCBhIGJpdApAQCAtNDIyLDU3ICs0NTQsMTQ5IEBAIHZvaWQgaTkxNV9nZW1fb2JqZWN0X3Jl
bGVhc2VfbW1hcChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogCWludGVsX3J1bnRp
bWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIH0KIAotc3RhdGljIGludCBj
cmVhdGVfbW1hcF9vZmZzZXQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKK3ZvaWQg
aTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcF9vZmZzZXQoc3RydWN0IGRybV9pOTE1X2dlbV9v
YmplY3QgKm9iaikKK3sKKwlzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldCAqbW1vOworCisJc3Bpbl9s
b2NrKCZvYmotPm1tby5sb2NrKTsKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5KG1tbywgJm9iai0+bW1v
Lm9mZnNldHMsIG9mZnNldCkgeworCQkvKgorCQkgKiB2bWFfbm9kZV91bm1hcCBmb3IgR1RUIG1t
YXBzIGhhbmRsZWQgYWxyZWFkeSBpbgorCQkgKiBfX2k5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21t
YXBfZ3R0CisJCSAqLworCQlpZiAobW1vLT5tbWFwX3R5cGUgPT0gSTkxNV9NTUFQX1RZUEVfR1RU
KQorCQkJY29udGludWU7CisKKwkJc3Bpbl91bmxvY2soJm9iai0+bW1vLmxvY2spOworCQlkcm1f
dm1hX25vZGVfdW5tYXAoJm1tby0+dm1hX25vZGUsCisJCQkJICAgb2JqLT5iYXNlLmRldi0+YW5v
bl9pbm9kZS0+aV9tYXBwaW5nKTsKKwkJc3Bpbl9sb2NrKCZvYmotPm1tby5sb2NrKTsKKwl9CisJ
c3Bpbl91bmxvY2soJm9iai0+bW1vLmxvY2spOworfQorCisvKioKKyAqIGk5MTVfZ2VtX29iamVj
dF9yZWxlYXNlX21tYXAgLSByZW1vdmUgcGh5c2ljYWwgcGFnZSBtYXBwaW5ncworICogQG9iajog
b2JqIGluIHF1ZXN0aW9uCisgKgorICogUHJlc2VydmUgdGhlIHJlc2VydmF0aW9uIG9mIHRoZSBt
bWFwcGluZyB3aXRoIHRoZSBEUk0gY29yZSBjb2RlLCBidXQKKyAqIHJlbGlucXVpc2ggb3duZXJz
aGlwIG9mIHRoZSBwYWdlcyBiYWNrIHRvIHRoZSBzeXN0ZW0uCisgKi8KK3ZvaWQgaTkxNV9nZW1f
b2JqZWN0X3JlbGVhc2VfbW1hcChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQorewor
CWk5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXBfZ3R0KG9iaik7CisJaTkxNV9nZW1fb2JqZWN0
X3JlbGVhc2VfbW1hcF9vZmZzZXQob2JqKTsKK30KKworc3RhdGljIHN0cnVjdCBpOTE1X21tYXBf
b2Zmc2V0ICoKK21tYXBfb2Zmc2V0X2F0dGFjaChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAq
b2JqLAorCQkgICBlbnVtIGk5MTVfbW1hcF90eXBlIG1tYXBfdHlwZSwKKwkJICAgc3RydWN0IGRy
bV9maWxlICpmaWxlKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShvYmotPmJhc2UuZGV2KTsKLQlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gJmk5MTUtPmd0OworCXN0
cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICptbW87CiAJaW50IGVycjsKIAotCWVyciA9IGRybV9nZW1f
Y3JlYXRlX21tYXBfb2Zmc2V0KCZvYmotPmJhc2UpOworCW1tbyA9IGttYWxsb2Moc2l6ZW9mKCpt
bW8pLCBHRlBfS0VSTkVMKTsKKwlpZiAoIW1tbykKKwkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7
CisKKwltbW8tPm9iaiA9IG9iajsKKwltbW8tPmRldiA9IG9iai0+YmFzZS5kZXY7CisJbW1vLT5m
aWxlID0gZmlsZTsKKwltbW8tPm1tYXBfdHlwZSA9IG1tYXBfdHlwZTsKKwlkcm1fdm1hX25vZGVf
cmVzZXQoJm1tby0+dm1hX25vZGUpOworCisJZXJyID0gZHJtX3ZtYV9vZmZzZXRfYWRkKG1tby0+
ZGV2LT52bWFfb2Zmc2V0X21hbmFnZXIsICZtbW8tPnZtYV9ub2RlLAorCQkJCSBvYmotPmJhc2Uu
c2l6ZSAvIFBBR0VfU0laRSk7CiAJaWYgKGxpa2VseSghZXJyKSkKLQkJcmV0dXJuIDA7CisJCWdv
dG8gb3V0OwogCiAJLyogQXR0ZW1wdCB0byByZWFwIHNvbWUgbW1hcCBzcGFjZSBmcm9tIGRlYWQg
b2JqZWN0cyAqLwotCWVyciA9IGludGVsX2d0X3JldGlyZV9yZXF1ZXN0c190aW1lb3V0KGd0LCBN
QVhfU0NIRURVTEVfVElNRU9VVCk7CisJZXJyID0gaW50ZWxfZ3RfcmV0aXJlX3JlcXVlc3RzX3Rp
bWVvdXQoJmk5MTUtPmd0LCBNQVhfU0NIRURVTEVfVElNRU9VVCk7CiAJaWYgKGVycikKLQkJcmV0
dXJuIGVycjsKKwkJZ290byBlcnI7CiAKIAlpOTE1X2dlbV9kcmFpbl9mcmVlZF9vYmplY3RzKGk5
MTUpOwotCXJldHVybiBkcm1fZ2VtX2NyZWF0ZV9tbWFwX29mZnNldCgmb2JqLT5iYXNlKTsKKwll
cnIgPSBkcm1fdm1hX29mZnNldF9hZGQobW1vLT5kZXYtPnZtYV9vZmZzZXRfbWFuYWdlciwgJm1t
by0+dm1hX25vZGUsCisJCQkJIG9iai0+YmFzZS5zaXplIC8gUEFHRV9TSVpFKTsKKwlpZiAoZXJy
KQorCQlnb3RvIGVycjsKKworb3V0OgorCWlmIChmaWxlKQorCQlkcm1fdm1hX25vZGVfYWxsb3co
Jm1tby0+dm1hX25vZGUsIGZpbGUpOworCisJc3Bpbl9sb2NrKCZvYmotPm1tby5sb2NrKTsKKwls
aXN0X2FkZCgmbW1vLT5vZmZzZXQsICZvYmotPm1tby5vZmZzZXRzKTsKKwlzcGluX3VubG9jaygm
b2JqLT5tbW8ubG9jayk7CisKKwlyZXR1cm4gbW1vOworCitlcnI6CisJa2ZyZWUobW1vKTsKKwly
ZXR1cm4gRVJSX1BUUihlcnIpOwogfQogCi1pbnQKLWk5MTVfZ2VtX21tYXBfZ3R0KHN0cnVjdCBk
cm1fZmlsZSAqZmlsZSwKLQkJICBzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAotCQkgIHUzMiBoYW5k
bGUsCi0JCSAgdTY0ICpvZmZzZXQpCitzdGF0aWMgaW50CitfX2Fzc2lnbl9tbWFwX29mZnNldChz
dHJ1Y3QgZHJtX2ZpbGUgKmZpbGUsCisJCSAgICAgdTMyIGhhbmRsZSwKKwkJICAgICBlbnVtIGk5
MTVfbW1hcF90eXBlIG1tYXBfdHlwZSwKKwkJICAgICB1NjQgKm9mZnNldCkKIHsKIAlzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwotCWludCByZXQ7Ci0KLQlpZiAoIWk5MTVfZ2d0dF9o
YXNfYXBlcnR1cmUoJnRvX2k5MTUoZGV2KS0+Z2d0dCkpCi0JCXJldHVybiAtRU5PREVWOworCXN0
cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICptbW87CisJaW50IGVycjsKIAogCW9iaiA9IGk5MTVfZ2Vt
X29iamVjdF9sb29rdXAoZmlsZSwgaGFuZGxlKTsKIAlpZiAoIW9iaikKIAkJcmV0dXJuIC1FTk9F
TlQ7CiAKLQlpZiAoaTkxNV9nZW1fb2JqZWN0X25ldmVyX2JpbmRfZ2d0dChvYmopKSB7Ci0JCXJl
dCA9IC1FTk9ERVY7CisJaWYgKG1tYXBfdHlwZSA9PSBJOTE1X01NQVBfVFlQRV9HVFQgJiYKKwkg
ICAgaTkxNV9nZW1fb2JqZWN0X25ldmVyX2JpbmRfZ2d0dChvYmopKSB7CisJCWVyciA9IC1FTk9E
RVY7CiAJCWdvdG8gb3V0OwogCX0KIAotCXJldCA9IGNyZWF0ZV9tbWFwX29mZnNldChvYmopOwot
CWlmIChyZXQgPT0gMCkKLQkJKm9mZnNldCA9IGRybV92bWFfbm9kZV9vZmZzZXRfYWRkcigmb2Jq
LT5iYXNlLnZtYV9ub2RlKTsKKwlpZiAobW1hcF90eXBlICE9IEk5MTVfTU1BUF9UWVBFX0dUVCAm
JgorCSAgICAhaTkxNV9nZW1fb2JqZWN0X2hhc19zdHJ1Y3RfcGFnZShvYmopKSB7CisJCWVyciA9
IC1FTk9ERVY7CisJCWdvdG8gb3V0OworCX0KKworCW1tbyA9IG1tYXBfb2Zmc2V0X2F0dGFjaChv
YmosIG1tYXBfdHlwZSwgZmlsZSk7CisJaWYgKElTX0VSUihtbW8pKSB7CisJCWVyciA9IFBUUl9F
UlIobW1vKTsKKwkJZ290byBvdXQ7CisJfQogCisJKm9mZnNldCA9IGRybV92bWFfbm9kZV9vZmZz
ZXRfYWRkcigmbW1vLT52bWFfbm9kZSk7CisJZXJyID0gMDsKIG91dDoKIAlpOTE1X2dlbV9vYmpl
Y3RfcHV0KG9iaik7Ci0JcmV0dXJuIHJldDsKKwlyZXR1cm4gZXJyOworfQorCitpbnQKK2k5MTVf
Z2VtX2R1bWJfbW1hcF9vZmZzZXQoc3RydWN0IGRybV9maWxlICpmaWxlLAorCQkJICBzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2LAorCQkJICB1MzIgaGFuZGxlLAorCQkJICB1NjQgKm9mZnNldCkKK3sK
KwllbnVtIGk5MTVfbW1hcF90eXBlIG1tYXBfdHlwZTsKKworCWlmIChib290X2NwdV9oYXMoWDg2
X0ZFQVRVUkVfUEFUKSkKKwkJbW1hcF90eXBlID0gSTkxNV9NTUFQX1RZUEVfV0M7CisJZWxzZSBp
ZiAoIWk5MTVfZ2d0dF9oYXNfYXBlcnR1cmUoJnRvX2k5MTUoZGV2KS0+Z2d0dCkpCisJCXJldHVy
biAtRU5PREVWOworCWVsc2UKKwkJbW1hcF90eXBlID0gSTkxNV9NTUFQX1RZUEVfR1RUOworCisJ
cmV0dXJuIF9fYXNzaWduX21tYXBfb2Zmc2V0KGZpbGUsIGhhbmRsZSwgbW1hcF90eXBlLCBvZmZz
ZXQpOwogfQogCiAvKioKLSAqIGk5MTVfZ2VtX21tYXBfZ3R0X2lvY3RsIC0gcHJlcGFyZSBhbiBv
YmplY3QgZm9yIEdUVCBtbWFwJ2luZworICogaTkxNV9nZW1fbW1hcF9vZmZzZXRfaW9jdGwgLSBw
cmVwYXJlIGFuIG9iamVjdCBmb3IgR1RUIG1tYXAnaW5nCiAgKiBAZGV2OiBEUk0gZGV2aWNlCiAg
KiBAZGF0YTogR1RUIG1hcHBpbmcgaW9jdGwgZGF0YQogICogQGZpbGU6IEdFTSBvYmplY3QgaW5m
bwpAQCAtNDg3LDEyICs2MTEsMTY3IEBAIGk5MTVfZ2VtX21tYXBfZ3R0KHN0cnVjdCBkcm1fZmls
ZSAqZmlsZSwKICAqIHVzZXJzcGFjZS4KICAqLwogaW50Ci1pOTE1X2dlbV9tbWFwX2d0dF9pb2N0
bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAotCQkJc3RydWN0IGRybV9maWxl
ICpmaWxlKQoraTkxNV9nZW1fbW1hcF9vZmZzZXRfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRl
diwgdm9pZCAqZGF0YSwKKwkJCSAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkKIHsKLQlzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX21tYXBfZ3R0ICphcmdzID0gZGF0YTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX21tYXBfb2Zm
c2V0ICphcmdzID0gZGF0YTsKKwllbnVtIGk5MTVfbW1hcF90eXBlIHR5cGU7CisKKwlpZiAoYXJn
cy0+ZXh0ZW5zaW9ucykKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlzd2l0Y2ggKGFyZ3MtPmZsYWdz
KSB7CisJY2FzZSBJOTE1X01NQVBfT0ZGU0VUX0dUVDoKKwkJaWYgKCFpOTE1X2dndHRfaGFzX2Fw
ZXJ0dXJlKCZpOTE1LT5nZ3R0KSkKKwkJCXJldHVybiAtRU5PREVWOworCQl0eXBlID0gSTkxNV9N
TUFQX1RZUEVfR1RUOworCQlicmVhazsKKworCWNhc2UgSTkxNV9NTUFQX09GRlNFVF9XQzoKKwkJ
aWYgKCFib290X2NwdV9oYXMoWDg2X0ZFQVRVUkVfUEFUKSkKKwkJCXJldHVybiAtRU5PREVWOwor
CQl0eXBlID0gSTkxNV9NTUFQX1RZUEVfV0M7CisJCWJyZWFrOworCisJY2FzZSBJOTE1X01NQVBf
T0ZGU0VUX1dCOgorCQl0eXBlID0gSTkxNV9NTUFQX1RZUEVfV0I7CisJCWJyZWFrOworCisJY2Fz
ZSBJOTE1X01NQVBfT0ZGU0VUX1VDOgorCQlpZiAoIWJvb3RfY3B1X2hhcyhYODZfRkVBVFVSRV9Q
QVQpKQorCQkJcmV0dXJuIC1FTk9ERVY7CisJCXR5cGUgPSBJOTE1X01NQVBfVFlQRV9VQzsKKwkJ
YnJlYWs7CisKKwlkZWZhdWx0OgorCQlyZXR1cm4gLUVJTlZBTDsKKwl9CiAKLQlyZXR1cm4gaTkx
NV9nZW1fbW1hcF9ndHQoZmlsZSwgZGV2LCBhcmdzLT5oYW5kbGUsICZhcmdzLT5vZmZzZXQpOwor
CXJldHVybiBfX2Fzc2lnbl9tbWFwX29mZnNldChmaWxlLCBhcmdzLT5oYW5kbGUsIHR5cGUsICZh
cmdzLT5vZmZzZXQpOworfQorCitzdGF0aWMgdm9pZCB2bV9vcGVuKHN0cnVjdCB2bV9hcmVhX3N0
cnVjdCAqdm1hKQoreworCXN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICptbW8gPSB2bWEtPnZtX3By
aXZhdGVfZGF0YTsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gbW1vLT5vYmo7
CisKKwlHRU1fQlVHX09OKCFvYmopOworCWk5MTVfZ2VtX29iamVjdF9nZXQob2JqKTsKK30KKwor
c3RhdGljIHZvaWQgdm1fY2xvc2Uoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEpCit7CisJc3Ry
dWN0IGk5MTVfbW1hcF9vZmZzZXQgKm1tbyA9IHZtYS0+dm1fcHJpdmF0ZV9kYXRhOworCXN0cnVj
dCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPSBtbW8tPm9iajsKKworCUdFTV9CVUdfT04oIW9i
aik7CisJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0
IHZtX29wZXJhdGlvbnNfc3RydWN0IHZtX29wc19ndHQgPSB7CisJLmZhdWx0ID0gdm1fZmF1bHRf
Z3R0LAorCS5vcGVuID0gdm1fb3BlbiwKKwkuY2xvc2UgPSB2bV9jbG9zZSwKK307CisKK3N0YXRp
YyBjb25zdCBzdHJ1Y3Qgdm1fb3BlcmF0aW9uc19zdHJ1Y3Qgdm1fb3BzX2NwdSA9IHsKKwkuZmF1
bHQgPSB2bV9mYXVsdF9jcHUsCisJLm9wZW4gPSB2bV9vcGVuLAorCS5jbG9zZSA9IHZtX2Nsb3Nl
LAorfTsKKworLyoKKyAqIFRoaXMgb3ZlcmNvbWVzIHRoZSBsaW1pdGF0aW9uIGluIGRybV9nZW1f
bW1hcCdzIGFzc2lnbm1lbnQgb2YgYQorICogZHJtX2dlbV9vYmplY3QgYXMgdGhlIHZtYS0+dm1f
cHJpdmF0ZV9kYXRhLiBTaW5jZSB3ZSBuZWVkIHRvCisgKiBiZSBhYmxlIHRvIHJlc29sdmUgbXVs
dGlwbGUgbW1hcCBvZmZzZXRzIHdoaWNoIGNvdWxkIGJlIHRpZWQKKyAqIHRvIGEgc2luZ2xlIGdl
bSBvYmplY3QuCisgKi8KK2ludCBpOTE1X2dlbV9tbWFwKHN0cnVjdCBmaWxlICpmaWxwLCBzdHJ1
Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSkKK3sKKwlzdHJ1Y3QgZHJtX3ZtYV9vZmZzZXRfbm9kZSAq
bm9kZTsKKwlzdHJ1Y3QgZHJtX2ZpbGUgKnByaXYgPSBmaWxwLT5wcml2YXRlX2RhdGE7CisJc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiA9IHByaXYtPm1pbm9yLT5kZXY7CisJc3RydWN0IGk5MTVfbW1h
cF9vZmZzZXQgKm1tbyA9IE5VTEw7CisJc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmogPSBOVUxM
OworCisJaWYgKGRybV9kZXZfaXNfdW5wbHVnZ2VkKGRldikpCisJCXJldHVybiAtRU5PREVWOwor
CisJZHJtX3ZtYV9vZmZzZXRfbG9ja19sb29rdXAoZGV2LT52bWFfb2Zmc2V0X21hbmFnZXIpOwor
CW5vZGUgPSBkcm1fdm1hX29mZnNldF9leGFjdF9sb29rdXBfbG9ja2VkKGRldi0+dm1hX29mZnNl
dF9tYW5hZ2VyLAorCQkJCQkJICB2bWEtPnZtX3Bnb2ZmLAorCQkJCQkJICB2bWFfcGFnZXModm1h
KSk7CisJaWYgKGxpa2VseShub2RlKSkgeworCQltbW8gPSBjb250YWluZXJfb2Yobm9kZSwgc3Ry
dWN0IGk5MTVfbW1hcF9vZmZzZXQsCisJCQkJICAgdm1hX25vZGUpOworCQkvKgorCQkgKiBJbiBv
dXIgZGVwZW5kZW5jeSBjaGFpbiwgdGhlIGRybV92bWFfb2Zmc2V0X25vZGUKKwkJICogZGVwZW5k
cyBvbiB0aGUgdmFsaWRpdHkgb2YgdGhlIG1tbywgd2hpY2ggZGVwZW5kcyBvbgorCQkgKiB0aGUg
Z2VtIG9iamVjdC4gSG93ZXZlciB0aGUgb25seSByZWZlcmVuY2Ugd2UgaGF2ZQorCQkgKiBhdCB0
aGlzIHBvaW50IGlzIHRoZSBtbW8gKGFzIHRoZSBwYXJlbnQgb2YgdGhlIG5vZGUpLgorCQkgKiBU
cnkgdG8gY2hlY2sgaWYgdGhlIGdlbSBvYmplY3Qgd2FzIGF0IGxlYXN0IGNsZWFyZWQuCisJCSAq
LworCQlpZiAoIW1tbyB8fCAhbW1vLT5vYmopIHsKKwkJCWRybV92bWFfb2Zmc2V0X3VubG9ja19s
b29rdXAoZGV2LT52bWFfb2Zmc2V0X21hbmFnZXIpOworCQkJcmV0dXJuIC1FSU5WQUw7CisJCX0K
KwkJLyoKKwkJICogU2tpcCAwLXJlZmNudGVkIG9iamVjdHMgYXMgaXQgaXMgaW4gdGhlIHByb2Nl
c3Mgb2YgYmVpbmcKKwkJICogZGVzdHJveWVkIGFuZCB3aWxsIGJlIGludmFsaWQgd2hlbiB0aGUg
dm1hIG1hbmFnZXIgbG9jaworCQkgKiBpcyByZWxlYXNlZC4KKwkJICovCisJCW9iaiA9ICZtbW8t
Pm9iai0+YmFzZTsKKwkJaWYgKCFrcmVmX2dldF91bmxlc3NfemVybygmb2JqLT5yZWZjb3VudCkp
CisJCQlvYmogPSBOVUxMOworCX0KKwlkcm1fdm1hX29mZnNldF91bmxvY2tfbG9va3VwKGRldi0+
dm1hX29mZnNldF9tYW5hZ2VyKTsKKwlpZiAoIW9iaikKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlp
ZiAoIWRybV92bWFfbm9kZV9pc19hbGxvd2VkKG5vZGUsIHByaXYpKSB7CisJCWRybV9nZW1fb2Jq
ZWN0X3B1dF91bmxvY2tlZChvYmopOworCQlyZXR1cm4gLUVBQ0NFUzsKKwl9CisKKwlpZiAoaTkx
NV9nZW1fb2JqZWN0X2lzX3JlYWRvbmx5KHRvX2ludGVsX2JvKG9iaikpKSB7CisJCWlmICh2bWEt
PnZtX2ZsYWdzICYgVk1fV1JJVEUpIHsKKwkJCWRybV9nZW1fb2JqZWN0X3B1dF91bmxvY2tlZChv
YmopOworCQkJcmV0dXJuIC1FSU5WQUw7CisJCX0KKwkJdm1hLT52bV9mbGFncyAmPSB+Vk1fTUFZ
V1JJVEU7CisJfQorCisJdm1hLT52bV9mbGFncyB8PSBWTV9QRk5NQVAgfCBWTV9ET05URVhQQU5E
IHwgVk1fRE9OVERVTVA7CisJdm1hLT52bV9wcml2YXRlX2RhdGEgPSBtbW87CisKKwlzd2l0Y2gg
KG1tby0+bW1hcF90eXBlKSB7CisJY2FzZSBJOTE1X01NQVBfVFlQRV9XQzoKKwkJdm1hLT52bV9w
YWdlX3Byb3QgPQorCQkJcGdwcm90X3dyaXRlY29tYmluZSh2bV9nZXRfcGFnZV9wcm90KHZtYS0+
dm1fZmxhZ3MpKTsKKwkJdm1hLT52bV9vcHMgPSAmdm1fb3BzX2NwdTsKKwkJYnJlYWs7CisKKwlj
YXNlIEk5MTVfTU1BUF9UWVBFX1dCOgorCQl2bWEtPnZtX3BhZ2VfcHJvdCA9IHZtX2dldF9wYWdl
X3Byb3Qodm1hLT52bV9mbGFncyk7CisJCXZtYS0+dm1fb3BzID0gJnZtX29wc19jcHU7CisJCWJy
ZWFrOworCisJY2FzZSBJOTE1X01NQVBfVFlQRV9VQzoKKwkJdm1hLT52bV9wYWdlX3Byb3QgPQor
CQkJcGdwcm90X25vbmNhY2hlZCh2bV9nZXRfcGFnZV9wcm90KHZtYS0+dm1fZmxhZ3MpKTsKKwkJ
dm1hLT52bV9vcHMgPSAmdm1fb3BzX2NwdTsKKwkJYnJlYWs7CisKKwljYXNlIEk5MTVfTU1BUF9U
WVBFX0dUVDoKKwkJdm1hLT52bV9wYWdlX3Byb3QgPQorCQkJcGdwcm90X3dyaXRlY29tYmluZSh2
bV9nZXRfcGFnZV9wcm90KHZtYS0+dm1fZmxhZ3MpKTsKKwkJdm1hLT52bV9vcHMgPSAmdm1fb3Bz
X2d0dDsKKwkJYnJlYWs7CisJfQorCXZtYS0+dm1fcGFnZV9wcm90ID0gcGdwcm90X2RlY3J5cHRl
ZCh2bWEtPnZtX3BhZ2VfcHJvdCk7CisKKwlyZXR1cm4gMDsKIH0KIAogI2lmIElTX0VOQUJMRUQo
Q09ORklHX0RSTV9JOTE1X1NFTEZURVNUKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX21tYW4uaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9tbWFuLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi44NjJlMDFi
N2NiNjkKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fbW1hbi5oCkBAIC0wLDAgKzEsMzEgQEAKKy8qCisgKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmll
cjogTUlUCisgKgorICogQ29weXJpZ2h0IMKpIDIwMTkgSW50ZWwgQ29ycG9yYXRpb24KKyAqLwor
CisjaWZuZGVmIF9fSTkxNV9HRU1fTU1BTl9IX18KKyNkZWZpbmUgX19JOTE1X0dFTV9NTUFOX0hf
XworCisjaW5jbHVkZSA8bGludXgvbW1fdHlwZXMuaD4KKyNpbmNsdWRlIDxsaW51eC90eXBlcy5o
PgorCitzdHJ1Y3QgZHJtX2RldmljZTsKK3N0cnVjdCBkcm1fZmlsZTsKK3N0cnVjdCBkcm1faTkx
NV9nZW1fb2JqZWN0Oworc3RydWN0IGZpbGU7CitzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldDsKK3N0
cnVjdCBtdXRleDsKKworaW50IGk5MTVfZ2VtX21tYXBfZ3R0X3ZlcnNpb24odm9pZCk7CitpbnQg
aTkxNV9nZW1fbW1hcChzdHJ1Y3QgZmlsZSAqZmlscCwgc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2
bWEpOworCitpbnQgaTkxNV9nZW1fZHVtYl9tbWFwX29mZnNldChzdHJ1Y3QgZHJtX2ZpbGUgKmZp
bGVfcHJpdiwKKwkJCSAgICAgIHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCisJCQkgICAgICB1MzIg
aGFuZGxlLCB1NjQgKm9mZnNldCk7CisKK3ZvaWQgX19pOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9t
bWFwX2d0dChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKTsKK3ZvaWQgaTkxNV9nZW1f
b2JqZWN0X3JlbGVhc2VfbW1hcChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKTsKK3Zv
aWQgaTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcF9vZmZzZXQoc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKm9iaik7CisKKyNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX29iamVjdC5jCmluZGV4IDQ1ODk0NWUxODIzZS4uMTZkNjExZGI5Y2E2IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5jCkBAIC0yOSw2ICsyOSw3IEBACiAj
aW5jbHVkZSAiaTkxNV9kcnYuaCIKICNpbmNsdWRlICJpOTE1X2dlbV9jbGZsdXNoLmgiCiAjaW5j
bHVkZSAiaTkxNV9nZW1fY29udGV4dC5oIgorI2luY2x1ZGUgImk5MTVfZ2VtX21tYW4uaCIKICNp
bmNsdWRlICJpOTE1X2dlbV9vYmplY3QuaCIKICNpbmNsdWRlICJpOTE1X2dsb2JhbHMuaCIKICNp
bmNsdWRlICJpOTE1X3RyYWNlLmgiCkBAIC02MSw2ICs2Miw5IEBAIHZvaWQgaTkxNV9nZW1fb2Jq
ZWN0X2luaXQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAogCUlOSVRfTElTVF9I
RUFEKCZvYmotPmx1dF9saXN0KTsKIAorCXNwaW5fbG9ja19pbml0KCZvYmotPm1tby5sb2NrKTsK
KwlJTklUX0xJU1RfSEVBRCgmb2JqLT5tbW8ub2Zmc2V0cyk7CisKIAlpbml0X3JjdV9oZWFkKCZv
YmotPnJjdSk7CiAKIAlvYmotPm9wcyA9IG9wczsKQEAgLTk3LDYgKzEwMSw3IEBAIHZvaWQgaTkx
NV9nZW1fY2xvc2Vfb2JqZWN0KHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqZ2VtLCBzdHJ1Y3QgZHJt
X2ZpbGUgKmZpbGUpCiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IHRvX2ludGVs
X2JvKGdlbSk7CiAJc3RydWN0IGRybV9pOTE1X2ZpbGVfcHJpdmF0ZSAqZnByaXYgPSBmaWxlLT5k
cml2ZXJfcHJpdjsKIAlzdHJ1Y3QgaTkxNV9sdXRfaGFuZGxlICpsdXQsICpsbjsKKwlzdHJ1Y3Qg
aTkxNV9tbWFwX29mZnNldCAqbW1vOwogCUxJU1RfSEVBRChjbG9zZSk7CiAKIAlpOTE1X2dlbV9v
YmplY3RfbG9jayhvYmopOwpAQCAtMTExLDYgKzExNiwxNyBAQCB2b2lkIGk5MTVfZ2VtX2Nsb3Nl
X29iamVjdChzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdlbSwgc3RydWN0IGRybV9maWxlICpmaWxl
KQogCX0KIAlpOTE1X2dlbV9vYmplY3RfdW5sb2NrKG9iaik7CiAKKwlzcGluX2xvY2soJm9iai0+
bW1vLmxvY2spOworCWxpc3RfZm9yX2VhY2hfZW50cnkobW1vLCAmb2JqLT5tbW8ub2Zmc2V0cywg
b2Zmc2V0KSB7CisJCWlmIChtbW8tPmZpbGUgIT0gZmlsZSkKKwkJCWNvbnRpbnVlOworCisJCXNw
aW5fdW5sb2NrKCZvYmotPm1tby5sb2NrKTsKKwkJZHJtX3ZtYV9ub2RlX3Jldm9rZSgmbW1vLT52
bWFfbm9kZSwgZmlsZSk7CisJCXNwaW5fbG9jaygmb2JqLT5tbW8ubG9jayk7CisJfQorCXNwaW5f
dW5sb2NrKCZvYmotPm1tby5sb2NrKTsKKwogCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShsdXQs
IGxuLCAmY2xvc2UsIG9ial9saW5rKSB7CiAJCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgg
PSBsdXQtPmN0eDsKIAkJc3RydWN0IGk5MTVfdm1hICp2bWE7CkBAIC0xNTgsNiArMTc0LDggQEAg
c3RhdGljIHZvaWQgX19pOTE1X2dlbV9mcmVlX29iamVjdHMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCiAKIAl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRp
bWVfcG0pOwogCWxsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUob2JqLCBvbiwgZnJlZWQsIGZyZWVk
KSB7CisJCXN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICptbW8sICptbjsKKwogCQl0cmFjZV9pOTE1
X2dlbV9vYmplY3RfZGVzdHJveShvYmopOwogCiAJCWlmICghbGlzdF9lbXB0eSgmb2JqLT52bWEu
bGlzdCkpIHsKQEAgLTE4Myw2ICsyMDEsMTUgQEAgc3RhdGljIHZvaWQgX19pOTE1X2dlbV9mcmVl
X29iamVjdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCQlzcGluX3VubG9jaygm
b2JqLT52bWEubG9jayk7CiAJCX0KIAorCQlpOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwKG9i
aik7CisKKwkJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKG1tbywgbW4sICZvYmotPm1tby5vZmZz
ZXRzLCBvZmZzZXQpIHsKKwkJCWRybV92bWFfb2Zmc2V0X3JlbW92ZShvYmotPmJhc2UuZGV2LT52
bWFfb2Zmc2V0X21hbmFnZXIsCisJCQkJCSAgICAgICZtbW8tPnZtYV9ub2RlKTsKKwkJCWtmcmVl
KG1tbyk7CisJCX0KKwkJSU5JVF9MSVNUX0hFQUQoJm9iai0+bW1vLm9mZnNldHMpOworCiAJCUdF
TV9CVUdfT04oYXRvbWljX3JlYWQoJm9iai0+YmluZF9jb3VudCkpOwogCQlHRU1fQlVHX09OKG9i
ai0+dXNlcmZhdWx0X2NvdW50KTsKIAkJR0VNX0JVR19PTighbGlzdF9lbXB0eSgmb2JqLT5sdXRf
bGlzdCkpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29i
amVjdC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oCmluZGV4
IGU1NzUwZDUwNmNjOS4uYTFlYjdjMGIyM2FjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX29iamVjdC5oCkBAIC0xMzIsMTMgKzEzMiwxMyBAQCB2b2lkIGk5MTVfZ2VtX29i
amVjdF91bmxvY2tfZmVuY2Uoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIHN0YXRp
YyBpbmxpbmUgdm9pZAogaTkxNV9nZW1fb2JqZWN0X3NldF9yZWFkb25seShzdHJ1Y3QgZHJtX2k5
MTVfZ2VtX29iamVjdCAqb2JqKQogewotCW9iai0+YmFzZS52bWFfbm9kZS5yZWFkb25seSA9IHRy
dWU7CisJb2JqLT5mbGFncyB8PSBJOTE1X0JPX1JFQURPTkxZOwogfQogCiBzdGF0aWMgaW5saW5l
IGJvb2wKIGk5MTVfZ2VtX29iamVjdF9pc19yZWFkb25seShjb25zdCBzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqKQogewotCXJldHVybiBvYmotPmJhc2Uudm1hX25vZGUucmVhZG9ubHk7
CisJcmV0dXJuIG9iai0+ZmxhZ3MgJiBJOTE1X0JPX1JFQURPTkxZOwogfQogCiBzdGF0aWMgaW5s
aW5lIGJvb2wKQEAgLTM4Nyw5ICszODcsNiBAQCBzdGF0aWMgaW5saW5lIHZvaWQgaTkxNV9nZW1f
b2JqZWN0X3VucGluX21hcChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogCWk5MTVf
Z2VtX29iamVjdF91bnBpbl9wYWdlcyhvYmopOwogfQogCi12b2lkIF9faTkxNV9nZW1fb2JqZWN0
X3JlbGVhc2VfbW1hcChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKTsKLXZvaWQgaTkx
NV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2Jq
KTsKLQogdm9pZAogaTkxNV9nZW1fb2JqZWN0X2ZsdXNoX3dyaXRlX2RvbWFpbihzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCQkJCSAgIHVuc2lnbmVkIGludCBmbHVzaF9kb21haW5z
KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3Rf
dHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMu
aAppbmRleCAxNWY4Mjk3ZGMzNGUuLjJkNDA0ZTZmNjNkZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaApAQCAtNjMsNiArNjMsMjMgQEAg
c3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Rfb3BzIHsKIAl2b2lkICgqcmVsZWFzZSkoc3RydWN0
IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaik7CiB9OwogCitlbnVtIGk5MTVfbW1hcF90eXBlIHsK
KwlJOTE1X01NQVBfVFlQRV9HVFQgPSAwLAorCUk5MTVfTU1BUF9UWVBFX1dDLAorCUk5MTVfTU1B
UF9UWVBFX1dCLAorCUk5MTVfTU1BUF9UWVBFX1VDLAorfTsKKworc3RydWN0IGk5MTVfbW1hcF9v
ZmZzZXQgeworCXN0cnVjdCBkcm1fZGV2aWNlICpkZXY7CisJc3RydWN0IGRybV92bWFfb2Zmc2V0
X25vZGUgdm1hX25vZGU7CisJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKKwlzdHJ1
Y3QgZHJtX2ZpbGUgKmZpbGU7CisJZW51bSBpOTE1X21tYXBfdHlwZSBtbWFwX3R5cGU7CisKKwlz
dHJ1Y3QgbGlzdF9oZWFkIG9mZnNldDsKK307CisKIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0
IHsKIAlzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgYmFzZTsKIApAQCAtMTE4LDEyICsxMzUsMTggQEAg
c3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgewogCXVuc2lnbmVkIGludCB1c2VyZmF1bHRfY291
bnQ7CiAJc3RydWN0IGxpc3RfaGVhZCB1c2VyZmF1bHRfbGluazsKIAorCXN0cnVjdCB7CisJCXNw
aW5sb2NrX3QgbG9jazsgLyogUHJvdGVjdHMgYWNjZXNzIHRvIG1tbyBvZmZzZXRzICovCisJCXN0
cnVjdCBsaXN0X2hlYWQgb2Zmc2V0czsKKwl9IG1tbzsKKwogCUk5MTVfU0VMRlRFU1RfREVDTEFS
RShzdHJ1Y3QgbGlzdF9oZWFkIHN0X2xpbmspOwogCiAJdW5zaWduZWQgbG9uZyBmbGFnczsKICNk
ZWZpbmUgSTkxNV9CT19BTExPQ19DT05USUdVT1VTIEJJVCgwKQogI2RlZmluZSBJOTE1X0JPX0FM
TE9DX1ZPTEFUSUxFICAgQklUKDEpCiAjZGVmaW5lIEk5MTVfQk9fQUxMT0NfRkxBR1MgKEk5MTVf
Qk9fQUxMT0NfQ09OVElHVU9VUyB8IEk5MTVfQk9fQUxMT0NfVk9MQVRJTEUpCisjZGVmaW5lIEk5
MTVfQk9fUkVBRE9OTFkgICAgICAgICBCSVQoMikKIAogCS8qCiAJICogSXMgdGhlIG9iamVjdCB0
byBiZSBtYXBwZWQgYXMgcmVhZC1vbmx5IHRvIHRoZSBHUFUKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wYWdlcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX3BhZ2VzLmMKaW5kZXggZjQwMmMyYzQxNWMyLi43NTE5N2NhNjk2YTggMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wYWdlcy5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wYWdlcy5jCkBAIC04LDYgKzgsNyBA
QAogI2luY2x1ZGUgImk5MTVfZ2VtX29iamVjdC5oIgogI2luY2x1ZGUgImk5MTVfc2NhdHRlcmxp
c3QuaCIKICNpbmNsdWRlICJpOTE1X2dlbV9sbWVtLmgiCisjaW5jbHVkZSAiaTkxNV9nZW1fbW1h
bi5oIgogCiB2b2lkIF9faTkxNV9nZW1fb2JqZWN0X3NldF9wYWdlcyhzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqLAogCQkJCSBzdHJ1Y3Qgc2dfdGFibGUgKnBhZ2VzLApAQCAtMjA3LDYg
KzIwOCw4IEBAIGludCBfX2k5MTVfZ2VtX29iamVjdF9wdXRfcGFnZXMoc3RydWN0IGRybV9pOTE1
X2dlbV9vYmplY3QgKm9iaikKIAkJZ290byB1bmxvY2s7CiAJfQogCisJaTkxNV9nZW1fb2JqZWN0
X3JlbGVhc2VfbW1hcF9vZmZzZXQob2JqKTsKKwogCS8qCiAJICogLT5wdXRfcGFnZXMgbWlnaHQg
bmVlZCB0byBhbGxvY2F0ZSBtZW1vcnkgZm9yIHRoZSBiaXQxNyBzd2l6emxlCiAJICogYXJyYXks
IGhlbmNlIHByb3RlY3QgdGhlbSBmcm9tIGJlaW5nIHJlYXBlZCBieSByZW1vdmluZyB0aGVtIGZy
b20gZ3R0CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdGls
aW5nLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdGlsaW5nLmMKaW5kZXgg
MWZhNTkyZDgyYWY1Li42Yzc4MjVhMmRjMmEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV90aWxpbmcuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fdGlsaW5nLmMKQEAgLTExLDYgKzExLDcgQEAKICNpbmNsdWRlICJpOTE1X2Rydi5o
IgogI2luY2x1ZGUgImk5MTVfZ2VtLmgiCiAjaW5jbHVkZSAiaTkxNV9nZW1faW9jdGxzLmgiCisj
aW5jbHVkZSAiaTkxNV9nZW1fbW1hbi5oIgogI2luY2x1ZGUgImk5MTVfZ2VtX29iamVjdC5oIgog
CiAvKioKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkx
NV9nZW1fbW1hbi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dl
bV9tbWFuLmMKaW5kZXggNmNlOTE2N2Y4YzlmLi41OTE0MzVjNWYzNjggMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fbW1hbi5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fbW1hbi5jCkBAIC01NjUs
MTYgKzU2NSwxNiBAQCBzdGF0aWMgYm9vbCBhc3NlcnRfbW1hcF9vZmZzZXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCiAJCQkgICAgICAgaW50IGV4cGVjdGVkKQogewogCXN0cnVjdCBk
cm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7Ci0JaW50IGVycjsKKwlzdHJ1Y3QgaTkxNV9tbWFwX29m
ZnNldCAqbW1vOwogCiAJb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5hbChpOTE1
LCBzaXplKTsKIAlpZiAoSVNfRVJSKG9iaikpCiAJCXJldHVybiBQVFJfRVJSKG9iaik7CiAKLQll
cnIgPSBjcmVhdGVfbW1hcF9vZmZzZXQob2JqKTsKKwltbW8gPSBtbWFwX29mZnNldF9hdHRhY2go
b2JqLCBJOTE1X01NQVBfT0ZGU0VUX0dUVCwgTlVMTCk7CiAJaTkxNV9nZW1fb2JqZWN0X3B1dChv
YmopOwogCi0JcmV0dXJuIGVyciA9PSBleHBlY3RlZDsKKwlyZXR1cm4gUFRSX0VSUl9PUl9aRVJP
KG1tbykgPT0gZXhwZWN0ZWQ7CiB9CiAKIHN0YXRpYyB2b2lkIGRpc2FibGVfcmV0aXJlX3dvcmtl
cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKQEAgLTYwOSw3ICs2MDksOCBAQCBzdGF0
aWMgaW50IGlndF9tbWFwX29mZnNldF9leGhhdXN0aW9uKHZvaWQgKmFyZykKIAlzdHJ1Y3QgZHJt
X21tICptbSA9ICZpOTE1LT5kcm0udm1hX29mZnNldF9tYW5hZ2VyLT52bV9hZGRyX3NwYWNlX21t
OwogCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CiAJc3RydWN0IGRybV9tbV9ub2Rl
ICpob2xlLCAqbmV4dDsKLQlpbnQgbG9vcCwgZXJyOworCXN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0
ICptbW87CisJaW50IGxvb3AsIGVyciA9IDA7CiAKIAkvKiBEaXNhYmxlIGJhY2tncm91bmQgcmVh
cGVyICovCiAJZGlzYWJsZV9yZXRpcmVfd29ya2VyKGk5MTUpOwpAQCAtNjczLDkgKzY3NCwxMCBA
QCBzdGF0aWMgaW50IGlndF9tbWFwX29mZnNldF9leGhhdXN0aW9uKHZvaWQgKmFyZykKIAkJZ290
byBvdXQ7CiAJfQogCi0JZXJyID0gY3JlYXRlX21tYXBfb2Zmc2V0KG9iaik7Ci0JaWYgKGVycikg
eworCW1tbyA9IG1tYXBfb2Zmc2V0X2F0dGFjaChvYmosIEk5MTVfTU1BUF9PRkZTRVRfR1RULCBO
VUxMKTsKKwlpZiAoSVNfRVJSKG1tbykpIHsKIAkJcHJfZXJyKCJVbmFibGUgdG8gaW5zZXJ0IG9i
amVjdCBpbnRvIHJlY2xhaW1lZCBob2xlXG4iKTsKKwkJZXJyID0gUFRSX0VSUihtbW8pOwogCQln
b3RvIGVycl9vYmo7CiAJfQogCkBAIC03MjQsMTQgKzcyNiwxNSBAQCBzdGF0aWMgaW50IGlndF9t
bWFwX29mZnNldF9leGhhdXN0aW9uKHZvaWQgKmFyZykKIH0KIAogI2RlZmluZSBleHBhbmQzMih4
KSAoKCh4KSA8PCAwKSB8ICgoeCkgPDwgOCkgfCAoKHgpIDw8IDE2KSB8ICgoeCkgPDwgMjQpKQot
c3RhdGljIGludCBpZ3RfbW1hcF9ndHQodm9pZCAqYXJnKQorc3RhdGljIGludCBpZ3RfbW1hcCh2
b2lkICphcmcsIGVudW0gaTkxNV9tbWFwX3R5cGUgdHlwZSkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IGFyZzsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwor
CXN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICptbW87CiAJc3RydWN0IHZtX2FyZWFfc3RydWN0ICph
cmVhOwogCXVuc2lnbmVkIGxvbmcgYWRkcjsKIAl2b2lkICp2YWRkcjsKLQlpbnQgZXJyLCBpOwor
CWludCBlcnIgPSAwLCBpOwogCiAJaWYgKCFpOTE1X2dndHRfaGFzX2FwZXJ0dXJlKCZpOTE1LT5n
Z3R0KSkKIAkJcmV0dXJuIDA7CkBAIC03NDksMTggKzc1MiwxOSBAQCBzdGF0aWMgaW50IGlndF9t
bWFwX2d0dCh2b2lkICphcmcpCiAJaTkxNV9nZW1fb2JqZWN0X2ZsdXNoX21hcChvYmopOwogCWk5
MTVfZ2VtX29iamVjdF91bnBpbl9tYXAob2JqKTsKIAotCWVyciA9IGNyZWF0ZV9tbWFwX29mZnNl
dChvYmopOwotCWlmIChlcnIpCisJbW1vID0gbW1hcF9vZmZzZXRfYXR0YWNoKG9iaiwgdHlwZSwg
TlVMTCk7CisJaWYgKElTX0VSUihtbW8pKSB7CisJCWVyciA9IFBUUl9FUlIobW1vKTsKIAkJZ290
byBvdXQ7CisJfQogCi0JYWRkciA9IGlndF9tbWFwX25vZGUoaTkxNSwgJm9iai0+YmFzZS52bWFf
bm9kZSwKLQkJCSAgICAgMCwgUFJPVF9XUklURSwgTUFQX1NIQVJFRCk7CisJYWRkciA9IGlndF9t
bWFwX25vZGUoaTkxNSwgJm1tby0+dm1hX25vZGUsIDAsIFBST1RfV1JJVEUsIE1BUF9TSEFSRUQp
OwogCWlmIChJU19FUlJfVkFMVUUoYWRkcikpIHsKIAkJZXJyID0gYWRkcjsKIAkJZ290byBvdXQ7
CiAJfQogCi0JcHJfZGVidWcoImlndF9tbWFwKG9iajpndHQpIEAgJWx4XG4iLCBhZGRyKTsKKwlw
cl9kZWJ1ZygiaWd0X21tYXAoKSBAICVseFxuIiwgYWRkcik7CiAKIAlhcmVhID0gZmluZF92bWEo
Y3VycmVudC0+bW0sIGFkZHIpOwogCWlmICghYXJlYSkgewpAQCAtNzY5LDggKzc3Myw4IEBAIHN0
YXRpYyBpbnQgaWd0X21tYXBfZ3R0KHZvaWQgKmFyZykKIAkJZ290byBvdXRfdW5tYXA7CiAJfQog
Ci0JaWYgKGFyZWEtPnZtX3ByaXZhdGVfZGF0YSAhPSBvYmopIHsKLQkJcHJfZXJyKCJ2bV9hcmVh
X3N0cnVjdCBkaWQgbm90IHBvaW50IGJhY2sgdG8gb3VyIG9iamVjdCFcbiIpOworCWlmIChhcmVh
LT52bV9wcml2YXRlX2RhdGEgIT0gbW1vKSB7CisJCXByX2Vycigidm1fYXJlYV9zdHJ1Y3QgZGlk
IG5vdCBwb2ludCBiYWNrIHRvIG91ciBtbWFwX29mZnNldCBvYmplY3QhXG4iKTsKIAkJZXJyID0g
LUVJTlZBTDsKIAkJZ290byBvdXRfdW5tYXA7CiAJfQpAQCAtNzgwLDE0ICs3ODQsMTQgQEAgc3Rh
dGljIGludCBpZ3RfbW1hcF9ndHQodm9pZCAqYXJnKQogCQl1MzIgeDsKIAogCQlpZiAoZ2V0X3Vz
ZXIoeCwgdXgpKSB7Ci0JCQlwcl9lcnIoIlVuYWJsZSB0byByZWFkIGZyb20gR1RUIG1tYXAsIG9m
ZnNldDolemRcbiIsCisJCQlwcl9lcnIoIlVuYWJsZSB0byByZWFkIGZyb20gbW1hcCwgb2Zmc2V0
OiV6ZFxuIiwKIAkJCSAgICAgICBpICogc2l6ZW9mKHgpKTsKIAkJCWVyciA9IC1FRkFVTFQ7CiAJ
CQlicmVhazsKIAkJfQogCiAJCWlmICh4ICE9IGV4cGFuZDMyKFBPSVNPTl9JTlVTRSkpIHsKLQkJ
CXByX2VycigiUmVhZCBpbmNvcnJlY3QgdmFsdWUgZnJvbSBHVFQgbW1hcCwgb2Zmc2V0OiV6ZCwg
Zm91bmQ6JXgsIGV4cGVjdGVkOiV4XG4iLAorCQkJcHJfZXJyKCJSZWFkIGluY29ycmVjdCB2YWx1
ZSBmcm9tIG1tYXAsIG9mZnNldDolemQsIGZvdW5kOiV4LCBleHBlY3RlZDoleFxuIiwKIAkJCSAg
ICAgICBpICogc2l6ZW9mKHgpLCB4LCBleHBhbmQzMihQT0lTT05fSU5VU0UpKTsKIAkJCWVyciA9
IC1FSU5WQUw7CiAJCQlicmVhazsKQEAgLTc5NSw3ICs3OTksNyBAQCBzdGF0aWMgaW50IGlndF9t
bWFwX2d0dCh2b2lkICphcmcpCiAKIAkJeCA9IGV4cGFuZDMyKFBPSVNPTl9GUkVFKTsKIAkJaWYg
KHB1dF91c2VyKHgsIHV4KSkgewotCQkJcHJfZXJyKCJVbmFibGUgdG8gd3JpdGUgdG8gR1RUIG1t
YXAsIG9mZnNldDolemRcbiIsCisJCQlwcl9lcnIoIlVuYWJsZSB0byB3cml0ZSB0byBtbWFwLCBv
ZmZzZXQ6JXpkXG4iLAogCQkJICAgICAgIGkgKiBzaXplb2YoeCkpOwogCQkJZXJyID0gLUVGQVVM
VDsKIAkJCWJyZWFrOwpAQCAtODExLDcgKzgxNSw3IEBAIHN0YXRpYyBpbnQgaWd0X21tYXBfZ3R0
KHZvaWQgKmFyZykKIAkJZ290byBvdXQ7CiAJfQogCWlmIChlcnIgPT0gMCAmJiBtZW1jaHJfaW52
KHZhZGRyLCBQT0lTT05fRlJFRSwgUEFHRV9TSVpFKSkgewotCQlwcl9lcnIoIldyaXRlIHZpYSBH
R1RUIG1tYXAgZGlkIG5vdCBsYW5kIGluIGJhY2tpbmcgc3RvcmVcbiIpOworCQlwcl9lcnIoIldy
aXRlIHZpYSBtbWFwIGRpZCBub3QgbGFuZCBpbiBiYWNraW5nIHN0b3JlXG4iKTsKIAkJZXJyID0g
LUVJTlZBTDsKIAl9CiAJaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChvYmopOwpAQCAtODIxLDYg
KzgyNSwxNiBAQCBzdGF0aWMgaW50IGlndF9tbWFwX2d0dCh2b2lkICphcmcpCiAJcmV0dXJuIGVy
cjsKIH0KIAorc3RhdGljIGludCBpZ3RfbW1hcF9ndHQodm9pZCAqYXJnKQoreworCXJldHVybiBp
Z3RfbW1hcChhcmcsIEk5MTVfTU1BUF9UWVBFX0dUVCk7Cit9CisKK3N0YXRpYyBpbnQgaWd0X21t
YXBfY3B1KHZvaWQgKmFyZykKK3sKKwlyZXR1cm4gaWd0X21tYXAoYXJnLCBJOTE1X01NQVBfVFlQ
RV9XQyk7Cit9CisKIHN0YXRpYyBpbnQgY2hlY2tfcHJlc2VudF9wdGUocHRlX3QgKnB0ZSwgdW5z
aWduZWQgbG9uZyBhZGRyLCB2b2lkICpkYXRhKQogewogCWlmICghcHRlX3ByZXNlbnQoKnB0ZSkg
fHwgcHRlX25vbmUoKnB0ZSkpIHsKQEAgLTg3MywxMCArODg3LDExIEBAIHN0YXRpYyBpbnQgcHJl
ZmF1bHRfcmFuZ2UodTY0IHN0YXJ0LCB1NjQgbGVuKQogCXJldHVybiBfX2dldF91c2VyKGMsIGVu
ZCAtIDEpOwogfQogCi1zdGF0aWMgaW50IGlndF9tbWFwX2d0dF9yZXZva2Uodm9pZCAqYXJnKQor
c3RhdGljIGludCBpZ3RfbW1hcF9yZXZva2Uodm9pZCAqYXJnLCBlbnVtIGk5MTVfbW1hcF90eXBl
IHR5cGUpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBhcmc7CiAJc3RydWN0
IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKKwlzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldCAqbW1v
OwogCXVuc2lnbmVkIGxvbmcgYWRkcjsKIAlpbnQgZXJyOwogCkBAIC04ODcsMTIgKzkwMiwxMyBA
QCBzdGF0aWMgaW50IGlndF9tbWFwX2d0dF9yZXZva2Uodm9pZCAqYXJnKQogCWlmIChJU19FUlIo
b2JqKSkKIAkJcmV0dXJuIFBUUl9FUlIob2JqKTsKIAotCWVyciA9IGNyZWF0ZV9tbWFwX29mZnNl
dChvYmopOwotCWlmIChlcnIpCisJbW1vID0gbW1hcF9vZmZzZXRfYXR0YWNoKG9iaiwgdHlwZSwg
TlVMTCk7CisJaWYgKElTX0VSUihtbW8pKSB7CisJCWVyciA9IFBUUl9FUlIobW1vKTsKIAkJZ290
byBvdXQ7CisJfQogCi0JYWRkciA9IGlndF9tbWFwX25vZGUoaTkxNSwgJm9iai0+YmFzZS52bWFf
bm9kZSwKLQkJCSAgICAgMCwgUFJPVF9XUklURSwgTUFQX1NIQVJFRCk7CisJYWRkciA9IGlndF9t
bWFwX25vZGUoaTkxNSwgJm1tby0+dm1hX25vZGUsIDAsIFBST1RfV1JJVEUsIE1BUF9TSEFSRUQp
OwogCWlmIChJU19FUlJfVkFMVUUoYWRkcikpIHsKIAkJZXJyID0gYWRkcjsKIAkJZ290byBvdXQ7
CkBAIC05MDIsNyArOTE4LDggQEAgc3RhdGljIGludCBpZ3RfbW1hcF9ndHRfcmV2b2tlKHZvaWQg
KmFyZykKIAlpZiAoZXJyKQogCQlnb3RvIG91dF91bm1hcDsKIAotCUdFTV9CVUdfT04oIWF0b21p
Y19yZWFkKCZvYmotPmJpbmRfY291bnQpKTsKKwlHRU1fQlVHX09OKG1tby0+bW1hcF90eXBlID09
IEk5MTVfTU1BUF9UWVBFX0dUVCAmJgorCQkgICAhYXRvbWljX3JlYWQoJm9iai0+YmluZF9jb3Vu
dCkpOwogCiAJZXJyID0gY2hlY2tfcHJlc2VudChhZGRyLCBvYmotPmJhc2Uuc2l6ZSk7CiAJaWYg
KGVycikKQEAgLTkyMCw2ICs5MzcsMTUgQEAgc3RhdGljIGludCBpZ3RfbW1hcF9ndHRfcmV2b2tl
KHZvaWQgKmFyZykKIAl9CiAJR0VNX0JVR19PTihhdG9taWNfcmVhZCgmb2JqLT5iaW5kX2NvdW50
KSk7CiAKKwlpZiAodHlwZSAhPSBJOTE1X01NQVBfVFlQRV9HVFQpIHsKKwkJX19pOTE1X2dlbV9v
YmplY3RfcHV0X3BhZ2VzKG9iaik7CisJCWlmIChpOTE1X2dlbV9vYmplY3RfaGFzX3BhZ2VzKG9i
aikpIHsKKwkJCXByX2VycigiRmFpbGVkIHRvIHB1dC1wYWdlcyBvYmplY3QhXG4iKTsKKwkJCWVy
ciA9IC1FSU5WQUw7CisJCQlnb3RvIG91dF91bm1hcDsKKwkJfQorCX0KKwogCWVyciA9IGNoZWNr
X2Fic2VudChhZGRyLCBvYmotPmJhc2Uuc2l6ZSk7CiAJaWYgKGVycikKIAkJZ290byBvdXRfdW5t
YXA7CkBAIC05MzEsNiArOTU3LDE2IEBAIHN0YXRpYyBpbnQgaWd0X21tYXBfZ3R0X3Jldm9rZSh2
b2lkICphcmcpCiAJcmV0dXJuIGVycjsKIH0KIAorc3RhdGljIGludCBpZ3RfbW1hcF9ndHRfcmV2
b2tlKHZvaWQgKmFyZykKK3sKKwlyZXR1cm4gaWd0X21tYXBfcmV2b2tlKGFyZywgSTkxNV9NTUFQ
X1RZUEVfR1RUKTsKK30KKworc3RhdGljIGludCBpZ3RfbW1hcF9jcHVfcmV2b2tlKHZvaWQgKmFy
ZykKK3sKKwlyZXR1cm4gaWd0X21tYXBfcmV2b2tlKGFyZywgSTkxNV9NTUFQX1RZUEVfV0MpOwor
fQorCiBpbnQgaTkxNV9nZW1fbW1hbl9saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKIHsKIAlzdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVfc3VidGVzdCB0ZXN0c1td
ID0gewpAQCAtOTM4LDcgKzk3NCw5IEBAIGludCBpOTE1X2dlbV9tbWFuX2xpdmVfc2VsZnRlc3Rz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCQlTVUJURVNUKGlndF9zbW9rZV90aWxp
bmcpLAogCQlTVUJURVNUKGlndF9tbWFwX29mZnNldF9leGhhdXN0aW9uKSwKIAkJU1VCVEVTVChp
Z3RfbW1hcF9ndHQpLAorCQlTVUJURVNUKGlndF9tbWFwX2NwdSksCiAJCVNVQlRFU1QoaWd0X21t
YXBfZ3R0X3Jldm9rZSksCisJCVNVQlRFU1QoaWd0X21tYXBfY3B1X3Jldm9rZSksCiAJfTsKIAog
CXJldHVybiBpOTE1X3N1YnRlc3RzKHRlc3RzLCBpOTE1KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9yZXNldC5jCmluZGV4IDM2MTg5MjM4ZTEzYy4uMGU5NGI3MjBjOTkzIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMKQEAgLTY3OCw4ICs2NzgsMTMgQEAgc3RhdGljIHZv
aWQgcmV2b2tlX21tYXBzKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiAJCQljb250aW51ZTsKIAogCQlH
RU1fQlVHX09OKHZtYS0+ZmVuY2UgIT0gJmd0LT5nZ3R0LT5mZW5jZV9yZWdzW2ldKTsKLQkJbm9k
ZSA9ICZ2bWEtPm9iai0+YmFzZS52bWFfbm9kZTsKKworCQlpZiAoIXZtYS0+bW1vKQorCQkJY29u
dGludWU7CisKKwkJbm9kZSA9ICZ2bWEtPm1tby0+dm1hX25vZGU7CiAJCXZtYV9vZmZzZXQgPSB2
bWEtPmdndHRfdmlldy5wYXJ0aWFsLm9mZnNldCA8PCBQQUdFX1NISUZUOworCiAJCXVubWFwX21h
cHBpbmdfcmFuZ2UoZ3QtPmk5MTUtPmRybS5hbm9uX2lub2RlLT5pX21hcHBpbmcsCiAJCQkJICAg
IGRybV92bWFfbm9kZV9vZmZzZXRfYWRkcihub2RlKSArIHZtYV9vZmZzZXQsCiAJCQkJICAgIHZt
YS0+c2l6ZSwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCmluZGV4IDM0MzQ0YjYzMmUxZi4uNzNhMzg1
ZjgwOWQzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKQEAgLTYxLDYgKzYxLDcgQEAKIAogI2lu
Y2x1ZGUgImdlbS9pOTE1X2dlbV9jb250ZXh0LmgiCiAjaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX2lv
Y3Rscy5oIgorI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9tbWFuLmgiCiAjaW5jbHVkZSAiZ3QvaW50
ZWxfZ3QuaCIKICNpbmNsdWRlICJndC9pbnRlbF9ndF9wbS5oIgogI2luY2x1ZGUgImd0L2ludGVs
X3JjNi5oIgpAQCAtMjY2MCwxOCArMjY2MSwxMiBAQCBjb25zdCBzdHJ1Y3QgZGV2X3BtX29wcyBp
OTE1X3BtX29wcyA9IHsKIAkucnVudGltZV9yZXN1bWUgPSBpbnRlbF9ydW50aW1lX3Jlc3VtZSwK
IH07CiAKLXN0YXRpYyBjb25zdCBzdHJ1Y3Qgdm1fb3BlcmF0aW9uc19zdHJ1Y3QgaTkxNV9nZW1f
dm1fb3BzID0gewotCS5mYXVsdCA9IGk5MTVfZ2VtX2ZhdWx0LAotCS5vcGVuID0gZHJtX2dlbV92
bV9vcGVuLAotCS5jbG9zZSA9IGRybV9nZW1fdm1fY2xvc2UsCi19OwotCiBzdGF0aWMgY29uc3Qg
c3RydWN0IGZpbGVfb3BlcmF0aW9ucyBpOTE1X2RyaXZlcl9mb3BzID0gewogCS5vd25lciA9IFRI
SVNfTU9EVUxFLAogCS5vcGVuID0gZHJtX29wZW4sCiAJLnJlbGVhc2UgPSBkcm1fcmVsZWFzZSwK
IAkudW5sb2NrZWRfaW9jdGwgPSBkcm1faW9jdGwsCi0JLm1tYXAgPSBkcm1fZ2VtX21tYXAsCisJ
Lm1tYXAgPSBpOTE1X2dlbV9tbWFwLAogCS5wb2xsID0gZHJtX3BvbGwsCiAJLnJlYWQgPSBkcm1f
cmVhZCwKIAkuY29tcGF0X2lvY3RsID0gaTkxNV9jb21wYXRfaW9jdGwsCkBAIC0yNzE4LDcgKzI3
MTMsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9pb2N0bF9kZXNjIGk5MTVfaW9jdGxzW10g
PSB7CiAJRFJNX0lPQ1RMX0RFRl9EUlYoSTkxNV9HRU1fUFJFQUQsIGk5MTVfZ2VtX3ByZWFkX2lv
Y3RsLCBEUk1fUkVOREVSX0FMTE9XKSwKIAlEUk1fSU9DVExfREVGX0RSVihJOTE1X0dFTV9QV1JJ
VEUsIGk5MTVfZ2VtX3B3cml0ZV9pb2N0bCwgRFJNX1JFTkRFUl9BTExPVyksCiAJRFJNX0lPQ1RM
X0RFRl9EUlYoSTkxNV9HRU1fTU1BUCwgaTkxNV9nZW1fbW1hcF9pb2N0bCwgRFJNX1JFTkRFUl9B
TExPVyksCi0JRFJNX0lPQ1RMX0RFRl9EUlYoSTkxNV9HRU1fTU1BUF9HVFQsIGk5MTVfZ2VtX21t
YXBfZ3R0X2lvY3RsLCBEUk1fUkVOREVSX0FMTE9XKSwKKwlEUk1fSU9DVExfREVGX0RSVihJOTE1
X0dFTV9NTUFQX09GRlNFVCwgaTkxNV9nZW1fbW1hcF9vZmZzZXRfaW9jdGwsIERSTV9SRU5ERVJf
QUxMT1cpLAogCURSTV9JT0NUTF9ERUZfRFJWKEk5MTVfR0VNX1NFVF9ET01BSU4sIGk5MTVfZ2Vt
X3NldF9kb21haW5faW9jdGwsIERSTV9SRU5ERVJfQUxMT1cpLAogCURSTV9JT0NUTF9ERUZfRFJW
KEk5MTVfR0VNX1NXX0ZJTklTSCwgaTkxNV9nZW1fc3dfZmluaXNoX2lvY3RsLCBEUk1fUkVOREVS
X0FMTE9XKSwKIAlEUk1fSU9DVExfREVGX0RSVihJOTE1X0dFTV9TRVRfVElMSU5HLCBpOTE1X2dl
bV9zZXRfdGlsaW5nX2lvY3RsLCBEUk1fUkVOREVSX0FMTE9XKSwKQEAgLTI3NjAsNyArMjc1NSw2
IEBAIHN0YXRpYyBzdHJ1Y3QgZHJtX2RyaXZlciBkcml2ZXIgPSB7CiAKIAkuZ2VtX2Nsb3NlX29i
amVjdCA9IGk5MTVfZ2VtX2Nsb3NlX29iamVjdCwKIAkuZ2VtX2ZyZWVfb2JqZWN0X3VubG9ja2Vk
ID0gaTkxNV9nZW1fZnJlZV9vYmplY3QsCi0JLmdlbV92bV9vcHMgPSAmaTkxNV9nZW1fdm1fb3Bz
LAogCiAJLnByaW1lX2hhbmRsZV90b19mZCA9IGRybV9nZW1fcHJpbWVfaGFuZGxlX3RvX2ZkLAog
CS5wcmltZV9mZF90b19oYW5kbGUgPSBkcm1fZ2VtX3ByaW1lX2ZkX3RvX2hhbmRsZSwKQEAgLTI3
NzEsNyArMjc2NSw4IEBAIHN0YXRpYyBzdHJ1Y3QgZHJtX2RyaXZlciBkcml2ZXIgPSB7CiAJLmdl
dF9zY2Fub3V0X3Bvc2l0aW9uID0gaTkxNV9nZXRfY3J0Y19zY2Fub3V0cG9zLAogCiAJLmR1bWJf
Y3JlYXRlID0gaTkxNV9nZW1fZHVtYl9jcmVhdGUsCi0JLmR1bWJfbWFwX29mZnNldCA9IGk5MTVf
Z2VtX21tYXBfZ3R0LAorCS5kdW1iX21hcF9vZmZzZXQgPSBpOTE1X2dlbV9kdW1iX21tYXBfb2Zm
c2V0LAorCiAJLmlvY3RscyA9IGk5MTVfaW9jdGxzLAogCS5udW1faW9jdGxzID0gQVJSQVlfU0la
RShpOTE1X2lvY3RscyksCiAJLmZvcHMgPSAmaTkxNV9kcml2ZXJfZm9wcywKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2Rydi5oCmluZGV4IDE0NzQ0YzExNDQ3NS4uMGQ0YWQxOGUxMGRkIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZHJ2LmgKQEAgLTE4NTcsOSArMTg1Nyw2IEBAIGk5MTVfbXV0ZXhfbG9ja19pbnRlcnJ1
cHRpYmxlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCiBpbnQgaTkxNV9nZW1fZHVtYl9jcmVhdGUo
c3RydWN0IGRybV9maWxlICpmaWxlX3ByaXYsCiAJCQkgc3RydWN0IGRybV9kZXZpY2UgKmRldiwK
IAkJCSBzdHJ1Y3QgZHJtX21vZGVfY3JlYXRlX2R1bWIgKmFyZ3MpOwotaW50IGk5MTVfZ2VtX21t
YXBfZ3R0KHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wcml2LCBzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
LAotCQkgICAgICB1MzIgaGFuZGxlLCB1NjQgKm9mZnNldCk7Ci1pbnQgaTkxNV9nZW1fbW1hcF9n
dHRfdmVyc2lvbih2b2lkKTsKIAogaW50IF9fbXVzdF9jaGVjayBpOTE1X2dlbV9zZXRfZ2xvYmFs
X3NlcW5vKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHUzMiBzZXFubyk7CiAKQEAgLTE4ODIsNyAr
MTg3OSw2IEBAIHZvaWQgaTkxNV9nZW1fZHJpdmVyX3JlbGVhc2Uoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KTsKIHZvaWQgaTkxNV9nZW1fc3VzcGVuZChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpOwogdm9pZCBpOTE1X2dlbV9zdXNwZW5kX2xhdGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKIHZvaWQgaTkxNV9nZW1fcmVzdW1lKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Ci12bV9mYXVsdF90IGk5MTVfZ2VtX2ZhdWx0KHN0
cnVjdCB2bV9mYXVsdCAqdm1mKTsKIAogaW50IGk5MTVfZ2VtX29wZW4oc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSk7CiB2b2lkIGk5MTVfZ2VtX3Jl
bGVhc2Uoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgc3RydWN0IGRybV9maWxlICpmaWxlKTsKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2dlbS5jCmluZGV4IGViOWUyNjA5YzU2OS4uMDdiN2E4YTY3MWQwIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZ2VtLmMKQEAgLTQ0LDYgKzQ0LDcgQEAKICNpbmNsdWRlICJnZW0vaTkx
NV9nZW1fY2xmbHVzaC5oIgogI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9jb250ZXh0LmgiCiAjaW5j
bHVkZSAiZ2VtL2k5MTVfZ2VtX2lvY3Rscy5oIgorI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9tbWFu
LmgiCiAjaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX3BtLmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfY29u
dGV4dC5oIgogI2luY2x1ZGUgImd0L2ludGVsX2VuZ2luZV91c2VyLmgiCkBAIC04ODUsNyArODg2
LDcgQEAgdm9pZCBpOTE1X2dlbV9ydW50aW1lX3N1c3BlbmQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCiAKIAlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUob2JqLCBvbiwKIAkJCQkgJmk5
MTUtPmdndHQudXNlcmZhdWx0X2xpc3QsIHVzZXJmYXVsdF9saW5rKQotCQlfX2k5MTVfZ2VtX29i
amVjdF9yZWxlYXNlX21tYXAob2JqKTsKKwkJX19pOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFw
X2d0dChvYmopOwogCiAJLyoKIAkgKiBUaGUgZmVuY2Ugd2lsbCBiZSBsb3N0IHdoZW4gdGhlIGRl
dmljZSBwb3dlcnMgZG93bi4gSWYgYW55IHdlcmUKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZ2V0cGFyYW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2V0cGFy
YW0uYwppbmRleCBjZjhhOGMzZWYwNDcuLjU0ZmNlODFkNTcyNCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9nZXRwYXJhbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZ2V0cGFyYW0uYwpAQCAtMiw2ICsyLDcgQEAKICAqIFNQRFgtTGljZW5zZS1JZGVudGlm
aWVyOiBNSVQKICAqLwogCisjaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX21tYW4uaCIKICNpbmNsdWRl
ICJndC9pbnRlbF9lbmdpbmVfdXNlci5oIgogCiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3ZtYS5jCmluZGV4IGU1NTEyZjI2ZTIwYS4uNTY0ZmE5NzU1OGM1IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfdm1hLmMKQEAgLTEwNTQsMTcgKzEwNTQsMTYgQEAgc3RhdGljIHZvaWQgX19p
OTE1X3ZtYV9pb3VubWFwKHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQogCiB2b2lkIGk5MTVfdm1hX3Jl
dm9rZV9tbWFwKHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQogewotCXN0cnVjdCBkcm1fdm1hX29mZnNl
dF9ub2RlICpub2RlID0gJnZtYS0+b2JqLT5iYXNlLnZtYV9ub2RlOworCXN0cnVjdCBkcm1fdm1h
X29mZnNldF9ub2RlICpub2RlOwogCXU2NCB2bWFfb2Zmc2V0OwogCi0JbG9ja2RlcF9hc3NlcnRf
aGVsZCgmdm1hLT52bS0+bXV0ZXgpOwotCiAJaWYgKCFpOTE1X3ZtYV9oYXNfdXNlcmZhdWx0KHZt
YSkpCiAJCXJldHVybjsKIAogCUdFTV9CVUdfT04oIWk5MTVfdm1hX2lzX21hcF9hbmRfZmVuY2Vh
YmxlKHZtYSkpOwogCUdFTV9CVUdfT04oIXZtYS0+b2JqLT51c2VyZmF1bHRfY291bnQpOwogCisJ
bm9kZSA9ICZ2bWEtPm1tby0+dm1hX25vZGU7CiAJdm1hX29mZnNldCA9IHZtYS0+Z2d0dF92aWV3
LnBhcnRpYWwub2Zmc2V0IDw8IFBBR0VfU0hJRlQ7CiAJdW5tYXBfbWFwcGluZ19yYW5nZSh2bWEt
PnZtLT5pOTE1LT5kcm0uYW5vbl9pbm9kZS0+aV9tYXBwaW5nLAogCQkJICAgIGRybV92bWFfbm9k
ZV9vZmZzZXRfYWRkcihub2RlKSArIHZtYV9vZmZzZXQsCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3ZtYS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuaApp
bmRleCA0NjU5MzI4MTNiYzUuLmYwOWY0ZjUxM2M0MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV92bWEuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5o
CkBAIC02Myw2ICs2Myw5IEBAIHN0cnVjdCBpOTE1X3ZtYSB7CiAJdTY0IGRpc3BsYXlfYWxpZ25t
ZW50OwogCXN0cnVjdCBpOTE1X3BhZ2Vfc2l6ZXMgcGFnZV9zaXplczsKIAorCS8qIG1tYXAtb2Zm
c2V0IGFzc29jaWF0ZWQgd2l0aCBmZW5jaW5nIGZvciB0aGlzIHZtYSAqLworCXN0cnVjdCBpOTE1
X21tYXBfb2Zmc2V0CSptbW87CisKIAl1MzIgZmVuY2Vfc2l6ZTsKIAl1MzIgZmVuY2VfYWxpZ25t
ZW50OwogCmRpZmYgLS1naXQgYS9pbmNsdWRlL3VhcGkvZHJtL2k5MTVfZHJtLmggYi9pbmNsdWRl
L3VhcGkvZHJtL2k5MTVfZHJtLmgKaW5kZXggNTQwMGQ3ZTA1N2YxLi44MjljMGE0ODU3N2YgMTAw
NjQ0Ci0tLSBhL2luY2x1ZGUvdWFwaS9kcm0vaTkxNV9kcm0uaAorKysgYi9pbmNsdWRlL3VhcGkv
ZHJtL2k5MTVfZHJtLmgKQEAgLTM5NSw2ICszOTUsNyBAQCB0eXBlZGVmIHN0cnVjdCBfZHJtX2k5
MTVfc2FyZWEgewogI2RlZmluZSBEUk1fSU9DVExfSTkxNV9HRU1fUFdSSVRFCURSTV9JT1cgKERS
TV9DT01NQU5EX0JBU0UgKyBEUk1fSTkxNV9HRU1fUFdSSVRFLCBzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X3B3cml0ZSkKICNkZWZpbmUgRFJNX0lPQ1RMX0k5MTVfR0VNX01NQVAJCURSTV9JT1dSKERSTV9D
T01NQU5EX0JBU0UgKyBEUk1fSTkxNV9HRU1fTU1BUCwgc3RydWN0IGRybV9pOTE1X2dlbV9tbWFw
KQogI2RlZmluZSBEUk1fSU9DVExfSTkxNV9HRU1fTU1BUF9HVFQJRFJNX0lPV1IoRFJNX0NPTU1B
TkRfQkFTRSArIERSTV9JOTE1X0dFTV9NTUFQX0dUVCwgc3RydWN0IGRybV9pOTE1X2dlbV9tbWFw
X2d0dCkKKyNkZWZpbmUgRFJNX0lPQ1RMX0k5MTVfR0VNX01NQVBfT0ZGU0VUCURSTV9JT1dSKERS
TV9DT01NQU5EX0JBU0UgKyBEUk1fSTkxNV9HRU1fTU1BUF9HVFQsIHN0cnVjdCBkcm1faTkxNV9n
ZW1fbW1hcF9vZmZzZXQpCiAjZGVmaW5lIERSTV9JT0NUTF9JOTE1X0dFTV9TRVRfRE9NQUlOCURS
TV9JT1cgKERSTV9DT01NQU5EX0JBU0UgKyBEUk1fSTkxNV9HRU1fU0VUX0RPTUFJTiwgc3RydWN0
IGRybV9pOTE1X2dlbV9zZXRfZG9tYWluKQogI2RlZmluZSBEUk1fSU9DVExfSTkxNV9HRU1fU1df
RklOSVNICURSTV9JT1cgKERSTV9DT01NQU5EX0JBU0UgKyBEUk1fSTkxNV9HRU1fU1dfRklOSVNI
LCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX3N3X2ZpbmlzaCkKICNkZWZpbmUgRFJNX0lPQ1RMX0k5MTVf
R0VNX1NFVF9USUxJTkcJRFJNX0lPV1IgKERSTV9DT01NQU5EX0JBU0UgKyBEUk1fSTkxNV9HRU1f
U0VUX1RJTElORywgc3RydWN0IGRybV9pOTE1X2dlbV9zZXRfdGlsaW5nKQpAQCAtNzkzLDYgKzc5
NCwzNyBAQCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX21tYXBfZ3R0IHsKIAlfX3U2NCBvZmZzZXQ7CiB9
OwogCitzdHJ1Y3QgZHJtX2k5MTVfZ2VtX21tYXBfb2Zmc2V0IHsKKwkvKiogSGFuZGxlIGZvciB0
aGUgb2JqZWN0IGJlaW5nIG1hcHBlZC4gKi8KKwlfX3UzMiBoYW5kbGU7CisJX191MzIgcGFkOwor
CS8qKgorCSAqIEZha2Ugb2Zmc2V0IHRvIHVzZSBmb3Igc3Vic2VxdWVudCBtbWFwIGNhbGwKKwkg
KgorCSAqIFRoaXMgaXMgYSBmaXhlZC1zaXplIHR5cGUgZm9yIDMyLzY0IGNvbXBhdGliaWxpdHku
CisJICovCisJX191NjQgb2Zmc2V0OworCisJLyoqCisJICogRmxhZ3MgZm9yIGV4dGVuZGVkIGJl
aGF2aW91ci4KKwkgKgorCSAqIEl0IGlzIG1hbmRhdG9yeSB0aGF0IG9uZSBvZiB0aGUgTU1BUF9P
RkZTRVQgdHlwZXMKKwkgKiAoR1RULCBXQywgV0IsIFVDLCBldGMpIHNob3VsZCBiZSBpbmNsdWRl
ZC4KKwkgKi8KKwlfX3U2NCBmbGFnczsKKyNkZWZpbmUgSTkxNV9NTUFQX09GRlNFVF9HVFQgMAor
I2RlZmluZSBJOTE1X01NQVBfT0ZGU0VUX1dDICAxCisjZGVmaW5lIEk5MTVfTU1BUF9PRkZTRVRf
V0IgIDIKKyNkZWZpbmUgSTkxNV9NTUFQX09GRlNFVF9VQyAgMworCisJLyoKKwkgKiBaZXJvLXRl
cm1pbmF0ZWQgY2hhaW4gb2YgZXh0ZW5zaW9ucy4KKwkgKgorCSAqIE5vIGN1cnJlbnQgZXh0ZW5z
aW9ucyBkZWZpbmVkOyBtYnouCisJICovCisJX191NjQgZXh0ZW5zaW9uczsKK307CisKIHN0cnVj
dCBkcm1faTkxNV9nZW1fc2V0X2RvbWFpbiB7CiAJLyoqIEhhbmRsZSBmb3IgdGhlIG9iamVjdCAq
LwogCV9fdTMyIGhhbmRsZTsKLS0gCjIuMjQuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlz
dHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4v
bGlzdGluZm8vaW50ZWwtZ2Z4

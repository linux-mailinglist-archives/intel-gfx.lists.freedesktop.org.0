Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 5339D2D4DC3
	for <lists+intel-gfx@lfdr.de>; Wed,  9 Dec 2020 23:30:58 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D34846E0BA;
	Wed,  9 Dec 2020 22:30:55 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (unknown [77.68.26.236])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9B6836E060
 for <intel-gfx@lists.freedesktop.org>; Wed,  9 Dec 2020 22:30:51 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from build.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 23273063-1500050 
 for <intel-gfx@lists.freedesktop.org>; Wed, 09 Dec 2020 22:30:47 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed,  9 Dec 2020 22:30:47 +0000
Message-Id: <20201209223047.16626-3-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20201209223047.16626-1-chris@chris-wilson.co.uk>
References: <20201209223047.16626-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [CI 3/3] drm/i915: split gen8+ flush and bb_start
 emission functions to their own file
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogRGFuaWVsZSBDZXJhb2xvIFNwdXJpbyA8ZGFuaWVsZS5jZXJhb2xvc3B1cmlvQGludGVs
LmNvbT4KClRoZXNlIGZ1bmN0aW9ucyBhcmUgaW5kZXBlbmRlbnQgZnJvbSB0aGUgYmFja2VuZCB1
c2VkIGFuZCBjYW4gdGhlcmVmb3JlCmJlIHNwbGl0IG91dCBvZiB0aGUgZXhlbGlzdHMgc3VibWlz
c2lvbiBmaWxlLCBzbyB0aGV5IGNhbiBiZSByZS11c2VkIGJ5CnRoZSB1cGNvbWluZyBHdUMgc3Vi
bWlzc2lvbiBiYWNrZW5kLgoKQmFzZWQgb24gYSBwYXRjaCBieSBDaHJpcyBXaWxzb24uCgpTaWdu
ZWQtb2ZmLWJ5OiBEYW5pZWxlIENlcmFvbG8gU3B1cmlvIDxkYW5pZWxlLmNlcmFvbG9zcHVyaW9A
aW50ZWwuY29tPgpDYzogQ2hyaXMgUCBXaWxzb24gPGNocmlzLnAud2lsc29uQGludGVsLmNvbT4K
Q2M6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBsaW51eC5pbnRlbC5jb20+ClJldmll
d2VkLWJ5OiBKb2huIEhhcnJpc29uIDxKb2huLkMuSGFycmlzb25ASW50ZWwuY29tPgotLS0KIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlICAgICAgICAgICAgICAgICB8ICAgMSArCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9nZW44X2VuZ2luZV9jcy5jICAgICAgfCAzOTAgKysrKysrKysr
KysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2dlbjhfZW5naW5lX2NzLmggICAgICB8
ICAyNyArKwogLi4uL2RybS9pOTE1L2d0L2ludGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uLmMgIHwg
Mzk1ICstLS0tLS0tLS0tLS0tLS0tLQogNCBmaWxlcyBjaGFuZ2VkLCA0MjQgaW5zZXJ0aW9ucygr
KSwgMzg5IGRlbGV0aW9ucygtKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2dlbjhfZW5naW5lX2NzLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9nZW44X2VuZ2luZV9jcy5oCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQppbmRleCBhZWRi
ZDhmNTJiZTguLmY5ZWY1MTk5YjEyNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
TWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUKQEAgLTgyLDYgKzgy
LDcgQEAgZ3QteSArPSBcCiAJZ3QvZ2VuNl9lbmdpbmVfY3MubyBcCiAJZ3QvZ2VuNl9wcGd0dC5v
IFwKIAlndC9nZW43X3JlbmRlcmNsZWFyLm8gXAorCWd0L2dlbjhfZW5naW5lX2NzLm8gXAogCWd0
L2dlbjhfcHBndHQubyBcCiAJZ3QvaW50ZWxfYnJlYWRjcnVtYnMubyBcCiAJZ3QvaW50ZWxfY29u
dGV4dC5vIFwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2dlbjhfZW5naW5l
X2NzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9nZW44X2VuZ2luZV9jcy5jCm5ldyBmaWxl
IG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uODM0ZmI0MTY3NDEyCi0tLSAvZGV2L251
bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZ2VuOF9lbmdpbmVfY3MuYwpAQCAtMCww
ICsxLDM5MCBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAorLyoKKyAqIENvcHly
aWdodCDCqSAyMDE0IEludGVsIENvcnBvcmF0aW9uCisgKi8KKworI2luY2x1ZGUgImk5MTVfZHJ2
LmgiCisjaW5jbHVkZSAiaW50ZWxfZXhlY2xpc3RzX3N1Ym1pc3Npb24uaCIgLyogWFhYICovCisj
aW5jbHVkZSAiaW50ZWxfZ3B1X2NvbW1hbmRzLmgiCisjaW5jbHVkZSAiaW50ZWxfcmluZy5oIgor
CitpbnQgZ2VuOF9lbWl0X2ZsdXNoX3JjcyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0LCB1
MzIgbW9kZSkKK3sKKwlib29sIHZmX2ZsdXNoX3dhID0gZmFsc2UsIGRjX2ZsdXNoX3dhID0gZmFs
c2U7CisJdTMyICpjcywgZmxhZ3MgPSAwOworCWludCBsZW47CisKKwlmbGFncyB8PSBQSVBFX0NP
TlRST0xfQ1NfU1RBTEw7CisKKwlpZiAobW9kZSAmIEVNSVRfRkxVU0gpIHsKKwkJZmxhZ3MgfD0g
UElQRV9DT05UUk9MX1JFTkRFUl9UQVJHRVRfQ0FDSEVfRkxVU0g7CisJCWZsYWdzIHw9IFBJUEVf
Q09OVFJPTF9ERVBUSF9DQUNIRV9GTFVTSDsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0RDX0ZM
VVNIX0VOQUJMRTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0ZMVVNIX0VOQUJMRTsKKwl9CisK
KwlpZiAobW9kZSAmIEVNSVRfSU5WQUxJREFURSkgeworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xf
VExCX0lOVkFMSURBVEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9JTlNUUlVDVElPTl9DQUNI
RV9JTlZBTElEQVRFOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfVEVYVFVSRV9DQUNIRV9JTlZB
TElEQVRFOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfVkZfQ0FDSEVfSU5WQUxJREFURTsKKwkJ
ZmxhZ3MgfD0gUElQRV9DT05UUk9MX0NPTlNUX0NBQ0hFX0lOVkFMSURBVEU7CisJCWZsYWdzIHw9
IFBJUEVfQ09OVFJPTF9TVEFURV9DQUNIRV9JTlZBTElEQVRFOworCQlmbGFncyB8PSBQSVBFX0NP
TlRST0xfUVdfV1JJVEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9TVE9SRV9EQVRBX0lOREVY
OworCisJCS8qCisJCSAqIE9uIEdFTjk6IGJlZm9yZSBWRl9DQUNIRV9JTlZBTElEQVRFIHdlIG5l
ZWQgdG8gZW1pdCBhIE5VTEwKKwkJICogcGlwZSBjb250cm9sLgorCQkgKi8KKwkJaWYgKElTX0dF
TihyZXF1ZXN0LT5lbmdpbmUtPmk5MTUsIDkpKQorCQkJdmZfZmx1c2hfd2EgPSB0cnVlOworCisJ
CS8qIFdhRm9yR0FNSGFuZzprYmwgKi8KKwkJaWYgKElTX0tCTF9HVF9SRVZJRChyZXF1ZXN0LT5l
bmdpbmUtPmk5MTUsIDAsIEtCTF9SRVZJRF9CMCkpCisJCQlkY19mbHVzaF93YSA9IHRydWU7CisJ
fQorCisJbGVuID0gNjsKKworCWlmICh2Zl9mbHVzaF93YSkKKwkJbGVuICs9IDY7CisKKwlpZiAo
ZGNfZmx1c2hfd2EpCisJCWxlbiArPSAxMjsKKworCWNzID0gaW50ZWxfcmluZ19iZWdpbihyZXF1
ZXN0LCBsZW4pOworCWlmIChJU19FUlIoY3MpKQorCQlyZXR1cm4gUFRSX0VSUihjcyk7CisKKwlp
ZiAodmZfZmx1c2hfd2EpCisJCWNzID0gZ2VuOF9lbWl0X3BpcGVfY29udHJvbChjcywgMCwgMCk7
CisKKwlpZiAoZGNfZmx1c2hfd2EpCisJCWNzID0gZ2VuOF9lbWl0X3BpcGVfY29udHJvbChjcywg
UElQRV9DT05UUk9MX0RDX0ZMVVNIX0VOQUJMRSwKKwkJCQkJICAgIDApOworCisJY3MgPSBnZW44
X2VtaXRfcGlwZV9jb250cm9sKGNzLCBmbGFncywgTFJDX1BQSFdTUF9TQ1JBVENIX0FERFIpOwor
CisJaWYgKGRjX2ZsdXNoX3dhKQorCQljcyA9IGdlbjhfZW1pdF9waXBlX2NvbnRyb2woY3MsIFBJ
UEVfQ09OVFJPTF9DU19TVEFMTCwgMCk7CisKKwlpbnRlbF9yaW5nX2FkdmFuY2UocmVxdWVzdCwg
Y3MpOworCisJcmV0dXJuIDA7Cit9CisKK2ludCBnZW44X2VtaXRfZmx1c2hfeGNzKHN0cnVjdCBp
OTE1X3JlcXVlc3QgKnJlcXVlc3QsIHUzMiBtb2RlKQoreworCXUzMiBjbWQsICpjczsKKworCWNz
ID0gaW50ZWxfcmluZ19iZWdpbihyZXF1ZXN0LCA0KTsKKwlpZiAoSVNfRVJSKGNzKSkKKwkJcmV0
dXJuIFBUUl9FUlIoY3MpOworCisJY21kID0gTUlfRkxVU0hfRFcgKyAxOworCisJLyogV2UgYWx3
YXlzIHJlcXVpcmUgYSBjb21tYW5kIGJhcnJpZXIgc28gdGhhdCBzdWJzZXF1ZW50CisJICogY29t
bWFuZHMsIHN1Y2ggYXMgYnJlYWRjcnVtYiBpbnRlcnJ1cHRzLCBhcmUgc3RyaWN0bHkgb3JkZXJl
ZAorCSAqIHdydCB0aGUgY29udGVudHMgb2YgdGhlIHdyaXRlIGNhY2hlIGJlaW5nIGZsdXNoZWQg
dG8gbWVtb3J5CisJICogKGFuZCB0aHVzIGJlaW5nIGNvaGVyZW50IGZyb20gdGhlIENQVSkuCisJ
ICovCisJY21kIHw9IE1JX0ZMVVNIX0RXX1NUT1JFX0lOREVYIHwgTUlfRkxVU0hfRFdfT1BfU1RP
UkVEVzsKKworCWlmIChtb2RlICYgRU1JVF9JTlZBTElEQVRFKSB7CisJCWNtZCB8PSBNSV9JTlZB
TElEQVRFX1RMQjsKKwkJaWYgKHJlcXVlc3QtPmVuZ2luZS0+Y2xhc3MgPT0gVklERU9fREVDT0RF
X0NMQVNTKQorCQkJY21kIHw9IE1JX0lOVkFMSURBVEVfQlNEOworCX0KKworCSpjcysrID0gY21k
OworCSpjcysrID0gTFJDX1BQSFdTUF9TQ1JBVENIX0FERFI7CisJKmNzKysgPSAwOyAvKiB1cHBl
ciBhZGRyICovCisJKmNzKysgPSAwOyAvKiB2YWx1ZSAqLworCWludGVsX3JpbmdfYWR2YW5jZShy
ZXF1ZXN0LCBjcyk7CisKKwlyZXR1cm4gMDsKK30KKworaW50IGdlbjExX2VtaXRfZmx1c2hfcmNz
KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QsIHUzMiBtb2RlKQoreworCWlmIChtb2RlICYg
RU1JVF9GTFVTSCkgeworCQl1MzIgKmNzOworCQl1MzIgZmxhZ3MgPSAwOworCisJCWZsYWdzIHw9
IFBJUEVfQ09OVFJPTF9DU19TVEFMTDsKKworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfVElMRV9D
QUNIRV9GTFVTSDsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1JFTkRFUl9UQVJHRVRfQ0FDSEVf
RkxVU0g7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9ERVBUSF9DQUNIRV9GTFVTSDsKKwkJZmxh
Z3MgfD0gUElQRV9DT05UUk9MX0RDX0ZMVVNIX0VOQUJMRTsKKwkJZmxhZ3MgfD0gUElQRV9DT05U
Uk9MX0ZMVVNIX0VOQUJMRTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1FXX1dSSVRFOworCQlm
bGFncyB8PSBQSVBFX0NPTlRST0xfU1RPUkVfREFUQV9JTkRFWDsKKworCQljcyA9IGludGVsX3Jp
bmdfYmVnaW4ocmVxdWVzdCwgNik7CisJCWlmIChJU19FUlIoY3MpKQorCQkJcmV0dXJuIFBUUl9F
UlIoY3MpOworCisJCWNzID0gZ2VuOF9lbWl0X3BpcGVfY29udHJvbChjcywgZmxhZ3MsIExSQ19Q
UEhXU1BfU0NSQVRDSF9BRERSKTsKKwkJaW50ZWxfcmluZ19hZHZhbmNlKHJlcXVlc3QsIGNzKTsK
Kwl9CisKKwlpZiAobW9kZSAmIEVNSVRfSU5WQUxJREFURSkgeworCQl1MzIgKmNzOworCQl1MzIg
ZmxhZ3MgPSAwOworCisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9DU19TVEFMTDsKKworCQlmbGFn
cyB8PSBQSVBFX0NPTlRST0xfQ09NTUFORF9DQUNIRV9JTlZBTElEQVRFOworCQlmbGFncyB8PSBQ
SVBFX0NPTlRST0xfVExCX0lOVkFMSURBVEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9JTlNU
UlVDVElPTl9DQUNIRV9JTlZBTElEQVRFOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfVEVYVFVS
RV9DQUNIRV9JTlZBTElEQVRFOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfVkZfQ0FDSEVfSU5W
QUxJREFURTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0NPTlNUX0NBQ0hFX0lOVkFMSURBVEU7
CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9TVEFURV9DQUNIRV9JTlZBTElEQVRFOworCQlmbGFn
cyB8PSBQSVBFX0NPTlRST0xfUVdfV1JJVEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9TVE9S
RV9EQVRBX0lOREVYOworCisJCWNzID0gaW50ZWxfcmluZ19iZWdpbihyZXF1ZXN0LCA2KTsKKwkJ
aWYgKElTX0VSUihjcykpCisJCQlyZXR1cm4gUFRSX0VSUihjcyk7CisKKwkJY3MgPSBnZW44X2Vt
aXRfcGlwZV9jb250cm9sKGNzLCBmbGFncywgTFJDX1BQSFdTUF9TQ1JBVENIX0FERFIpOworCQlp
bnRlbF9yaW5nX2FkdmFuY2UocmVxdWVzdCwgY3MpOworCX0KKworCXJldHVybiAwOworfQorCitz
dGF0aWMgdTMyIHByZXBhcnNlcl9kaXNhYmxlKGJvb2wgc3RhdGUpCit7CisJcmV0dXJuIE1JX0FS
Ql9DSEVDSyB8IDEgPDwgOCB8IHN0YXRlOworfQorCitzdGF0aWMgaTkxNV9yZWdfdCBhdXhfaW52
X3JlZyhjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJc3RhdGljIGNv
bnN0IGk5MTVfcmVnX3QgdmRbXSA9IHsKKwkJR0VOMTJfVkQwX0FVWF9OViwKKwkJR0VOMTJfVkQx
X0FVWF9OViwKKwkJR0VOMTJfVkQyX0FVWF9OViwKKwkJR0VOMTJfVkQzX0FVWF9OViwKKwl9Owor
CisJc3RhdGljIGNvbnN0IGk5MTVfcmVnX3QgdmVbXSA9IHsKKwkJR0VOMTJfVkUwX0FVWF9OViwK
KwkJR0VOMTJfVkUxX0FVWF9OViwKKwl9OworCisJaWYgKGVuZ2luZS0+Y2xhc3MgPT0gVklERU9f
REVDT0RFX0NMQVNTKQorCQlyZXR1cm4gdmRbZW5naW5lLT5pbnN0YW5jZV07CisKKwlpZiAoZW5n
aW5lLT5jbGFzcyA9PSBWSURFT19FTkhBTkNFTUVOVF9DTEFTUykKKwkJcmV0dXJuIHZlW2VuZ2lu
ZS0+aW5zdGFuY2VdOworCisJR0VNX0JVR19PTigidW5rbm93biBhdXhfaW52X3JlZ1xuIik7CisK
KwlyZXR1cm4gSU5WQUxJRF9NTUlPX1JFRzsKK30KKworc3RhdGljIHUzMiAqZ2VuMTJfZW1pdF9h
dXhfdGFibGVfaW52KGNvbnN0IGk5MTVfcmVnX3QgaW52X3JlZywgdTMyICpjcykKK3sKKwkqY3Mr
KyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKDEpOworCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZz
ZXQoaW52X3JlZyk7CisJKmNzKysgPSBBVVhfSU5WOworCSpjcysrID0gTUlfTk9PUDsKKworCXJl
dHVybiBjczsKK30KKworaW50IGdlbjEyX2VtaXRfZmx1c2hfcmNzKHN0cnVjdCBpOTE1X3JlcXVl
c3QgKnJlcXVlc3QsIHUzMiBtb2RlKQoreworCWlmIChtb2RlICYgRU1JVF9GTFVTSCkgeworCQl1
MzIgZmxhZ3MgPSAwOworCQl1MzIgKmNzOworCisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9USUxF
X0NBQ0hFX0ZMVVNIOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfRkxVU0hfTDM7CisJCWZsYWdz
IHw9IFBJUEVfQ09OVFJPTF9SRU5ERVJfVEFSR0VUX0NBQ0hFX0ZMVVNIOworCQlmbGFncyB8PSBQ
SVBFX0NPTlRST0xfREVQVEhfQ0FDSEVfRkxVU0g7CisJCS8qIFdhXzE0MDk2MDA5MDc6dGdsICov
CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9ERVBUSF9TVEFMTDsKKwkJZmxhZ3MgfD0gUElQRV9D
T05UUk9MX0RDX0ZMVVNIX0VOQUJMRTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0ZMVVNIX0VO
QUJMRTsKKworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfU1RPUkVfREFUQV9JTkRFWDsKKwkJZmxh
Z3MgfD0gUElQRV9DT05UUk9MX1FXX1dSSVRFOworCisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9D
U19TVEFMTDsKKworCQljcyA9IGludGVsX3JpbmdfYmVnaW4ocmVxdWVzdCwgNik7CisJCWlmIChJ
U19FUlIoY3MpKQorCQkJcmV0dXJuIFBUUl9FUlIoY3MpOworCisJCWNzID0gZ2VuMTJfZW1pdF9w
aXBlX2NvbnRyb2woY3MsCisJCQkJCSAgICAgUElQRV9DT05UUk9MMF9IRENfUElQRUxJTkVfRkxV
U0gsCisJCQkJCSAgICAgZmxhZ3MsIExSQ19QUEhXU1BfU0NSQVRDSF9BRERSKTsKKwkJaW50ZWxf
cmluZ19hZHZhbmNlKHJlcXVlc3QsIGNzKTsKKwl9CisKKwlpZiAobW9kZSAmIEVNSVRfSU5WQUxJ
REFURSkgeworCQl1MzIgZmxhZ3MgPSAwOworCQl1MzIgKmNzOworCisJCWZsYWdzIHw9IFBJUEVf
Q09OVFJPTF9DT01NQU5EX0NBQ0hFX0lOVkFMSURBVEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJP
TF9UTEJfSU5WQUxJREFURTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0lOU1RSVUNUSU9OX0NB
Q0hFX0lOVkFMSURBVEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9URVhUVVJFX0NBQ0hFX0lO
VkFMSURBVEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9WRl9DQUNIRV9JTlZBTElEQVRFOwor
CQlmbGFncyB8PSBQSVBFX0NPTlRST0xfQ09OU1RfQ0FDSEVfSU5WQUxJREFURTsKKwkJZmxhZ3Mg
fD0gUElQRV9DT05UUk9MX1NUQVRFX0NBQ0hFX0lOVkFMSURBVEU7CisKKwkJZmxhZ3MgfD0gUElQ
RV9DT05UUk9MX1NUT1JFX0RBVEFfSU5ERVg7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9RV19X
UklURTsKKworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfQ1NfU1RBTEw7CisKKwkJY3MgPSBpbnRl
bF9yaW5nX2JlZ2luKHJlcXVlc3QsIDggKyA0KTsKKwkJaWYgKElTX0VSUihjcykpCisJCQlyZXR1
cm4gUFRSX0VSUihjcyk7CisKKwkJLyoKKwkJICogUHJldmVudCB0aGUgcHJlLXBhcnNlciBmcm9t
IHNraXBwaW5nIHBhc3QgdGhlIFRMQgorCQkgKiBpbnZhbGlkYXRlIGFuZCBsb2FkaW5nIGEgc3Rh
bGUgcGFnZSBmb3IgdGhlIGJhdGNoCisJCSAqIGJ1ZmZlciAvIHJlcXVlc3QgcGF5bG9hZC4KKwkJ
ICovCisJCSpjcysrID0gcHJlcGFyc2VyX2Rpc2FibGUodHJ1ZSk7CisKKwkJY3MgPSBnZW44X2Vt
aXRfcGlwZV9jb250cm9sKGNzLCBmbGFncywgTFJDX1BQSFdTUF9TQ1JBVENIX0FERFIpOworCisJ
CS8qIGhzZGVzOiAxODA5MTc1NzkwICovCisJCWNzID0gZ2VuMTJfZW1pdF9hdXhfdGFibGVfaW52
KEdFTjEyX0dGWF9DQ1NfQVVYX05WLCBjcyk7CisKKwkJKmNzKysgPSBwcmVwYXJzZXJfZGlzYWJs
ZShmYWxzZSk7CisJCWludGVsX3JpbmdfYWR2YW5jZShyZXF1ZXN0LCBjcyk7CisJfQorCisJcmV0
dXJuIDA7Cit9CisKK2ludCBnZW4xMl9lbWl0X2ZsdXNoX3hjcyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0
ICpyZXF1ZXN0LCB1MzIgbW9kZSkKK3sKKwlpbnRlbF9lbmdpbmVfbWFza190IGF1eF9pbnYgPSAw
OworCXUzMiBjbWQsICpjczsKKworCWNtZCA9IDQ7CisJaWYgKG1vZGUgJiBFTUlUX0lOVkFMSURB
VEUpCisJCWNtZCArPSAyOworCWlmIChtb2RlICYgRU1JVF9JTlZBTElEQVRFKQorCQlhdXhfaW52
ID0gcmVxdWVzdC0+ZW5naW5lLT5tYXNrICYgfkJJVChCQ1MwKTsKKwlpZiAoYXV4X2ludikKKwkJ
Y21kICs9IDIgKiBod2VpZ2h0OChhdXhfaW52KSArIDI7CisKKwljcyA9IGludGVsX3JpbmdfYmVn
aW4ocmVxdWVzdCwgY21kKTsKKwlpZiAoSVNfRVJSKGNzKSkKKwkJcmV0dXJuIFBUUl9FUlIoY3Mp
OworCisJaWYgKG1vZGUgJiBFTUlUX0lOVkFMSURBVEUpCisJCSpjcysrID0gcHJlcGFyc2VyX2Rp
c2FibGUodHJ1ZSk7CisKKwljbWQgPSBNSV9GTFVTSF9EVyArIDE7CisKKwkvKiBXZSBhbHdheXMg
cmVxdWlyZSBhIGNvbW1hbmQgYmFycmllciBzbyB0aGF0IHN1YnNlcXVlbnQKKwkgKiBjb21tYW5k
cywgc3VjaCBhcyBicmVhZGNydW1iIGludGVycnVwdHMsIGFyZSBzdHJpY3RseSBvcmRlcmVkCisJ
ICogd3J0IHRoZSBjb250ZW50cyBvZiB0aGUgd3JpdGUgY2FjaGUgYmVpbmcgZmx1c2hlZCB0byBt
ZW1vcnkKKwkgKiAoYW5kIHRodXMgYmVpbmcgY29oZXJlbnQgZnJvbSB0aGUgQ1BVKS4KKwkgKi8K
KwljbWQgfD0gTUlfRkxVU0hfRFdfU1RPUkVfSU5ERVggfCBNSV9GTFVTSF9EV19PUF9TVE9SRURX
OworCisJaWYgKG1vZGUgJiBFTUlUX0lOVkFMSURBVEUpIHsKKwkJY21kIHw9IE1JX0lOVkFMSURB
VEVfVExCOworCQlpZiAocmVxdWVzdC0+ZW5naW5lLT5jbGFzcyA9PSBWSURFT19ERUNPREVfQ0xB
U1MpCisJCQljbWQgfD0gTUlfSU5WQUxJREFURV9CU0Q7CisJfQorCisJKmNzKysgPSBjbWQ7CisJ
KmNzKysgPSBMUkNfUFBIV1NQX1NDUkFUQ0hfQUREUjsKKwkqY3MrKyA9IDA7IC8qIHVwcGVyIGFk
ZHIgKi8KKwkqY3MrKyA9IDA7IC8qIHZhbHVlICovCisKKwlpZiAoYXV4X2ludikgeyAvKiBoc2Rl
czogMTgwOTE3NTc5MCAqLworCQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CisJCXVu
c2lnbmVkIGludCB0bXA7CisKKwkJKmNzKysgPSBNSV9MT0FEX1JFR0lTVEVSX0lNTShod2VpZ2h0
OChhdXhfaW52KSk7CisJCWZvcl9lYWNoX2VuZ2luZV9tYXNrZWQoZW5naW5lLCByZXF1ZXN0LT5l
bmdpbmUtPmd0LAorCQkJCSAgICAgICBhdXhfaW52LCB0bXApIHsKKwkJCSpjcysrID0gaTkxNV9t
bWlvX3JlZ19vZmZzZXQoYXV4X2ludl9yZWcoZW5naW5lKSk7CisJCQkqY3MrKyA9IEFVWF9JTlY7
CisJCX0KKwkJKmNzKysgPSBNSV9OT09QOworCX0KKworCWlmIChtb2RlICYgRU1JVF9JTlZBTElE
QVRFKQorCQkqY3MrKyA9IHByZXBhcnNlcl9kaXNhYmxlKGZhbHNlKTsKKworCWludGVsX3Jpbmdf
YWR2YW5jZShyZXF1ZXN0LCBjcyk7CisKKwlyZXR1cm4gMDsKK30KKworaW50IGdlbjhfZW1pdF9i
Yl9zdGFydF9ub2FyYihzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKKwkJCSAgICAgdTY0IG9mZnNl
dCwgdTMyIGxlbiwKKwkJCSAgICAgY29uc3QgdW5zaWduZWQgaW50IGZsYWdzKQoreworCXUzMiAq
Y3M7CisKKwljcyA9IGludGVsX3JpbmdfYmVnaW4ocnEsIDQpOworCWlmIChJU19FUlIoY3MpKQor
CQlyZXR1cm4gUFRSX0VSUihjcyk7CisKKwkvKgorCSAqIFdhRGlzYWJsZUN0eFJlc3RvcmVBcmJp
dHJhdGlvbjpiZHcsY2h2CisJICoKKwkgKiBXZSBkb24ndCBuZWVkIHRvIHBlcmZvcm0gTUlfQVJC
X0VOQUJMRSBhcyBvZnRlbiBhcyB3ZSBkbyAoaW4KKwkgKiBwYXJ0aWN1bGFyIGFsbCB0aGUgZ2Vu
IHRoYXQgZG8gbm90IG5lZWQgdGhlIHcvYSBhdCBhbGwhKSwgaWYgd2UKKwkgKiB0b29rIGNhcmUg
dG8gbWFrZSBzdXJlIHRoYXQgb24gZXZlcnkgc3dpdGNoIGludG8gdGhpcyBjb250ZXh0CisJICog
KGJvdGggb3JkaW5hcnkgYW5kIGZvciBwcmVlbXB0aW9uKSB0aGF0IGFyYml0cmFydGlvbiB3YXMg
ZW5hYmxlZAorCSAqIHdlIHdvdWxkIGJlIGZpbmUuICBIb3dldmVyLCBmb3IgZ2VuOCB0aGVyZSBp
cyBhbm90aGVyIHcvYSB0aGF0CisJICogcmVxdWlyZXMgdXMgdG8gbm90IHByZWVtcHQgaW5zaWRl
IEdQR1BVIGV4ZWN1dGlvbiwgc28gd2Uga2VlcAorCSAqIGFyYml0cmF0aW9uIGRpc2FibGVkIGZv
ciBnZW44IGJhdGNoZXMuIEFyYml0cmF0aW9uIHdpbGwgYmUKKwkgKiByZS1lbmFibGVkIGJlZm9y
ZSB3ZSBjbG9zZSB0aGUgcmVxdWVzdAorCSAqIChlbmdpbmUtPmVtaXRfZmluaV9icmVhZGNydW1i
KS4KKwkgKi8KKwkqY3MrKyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJfRElTQUJMRTsKKworCS8q
IEZJWE1FKEJEVyspOiBBZGRyZXNzIHNwYWNlIGFuZCBzZWN1cml0eSBzZWxlY3RvcnMuICovCisJ
KmNzKysgPSBNSV9CQVRDSF9CVUZGRVJfU1RBUlRfR0VOOCB8CisJCShmbGFncyAmIEk5MTVfRElT
UEFUQ0hfU0VDVVJFID8gMCA6IEJJVCg4KSk7CisJKmNzKysgPSBsb3dlcl8zMl9iaXRzKG9mZnNl
dCk7CisJKmNzKysgPSB1cHBlcl8zMl9iaXRzKG9mZnNldCk7CisKKwlpbnRlbF9yaW5nX2FkdmFu
Y2UocnEsIGNzKTsKKworCXJldHVybiAwOworfQorCitpbnQgZ2VuOF9lbWl0X2JiX3N0YXJ0KHN0
cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAorCQkgICAgICAgdTY0IG9mZnNldCwgdTMyIGxlbiwKKwkJ
ICAgICAgIGNvbnN0IHVuc2lnbmVkIGludCBmbGFncykKK3sKKwl1MzIgKmNzOworCisJY3MgPSBp
bnRlbF9yaW5nX2JlZ2luKHJxLCA2KTsKKwlpZiAoSVNfRVJSKGNzKSkKKwkJcmV0dXJuIFBUUl9F
UlIoY3MpOworCisJKmNzKysgPSBNSV9BUkJfT05fT0ZGIHwgTUlfQVJCX0VOQUJMRTsKKworCSpj
cysrID0gTUlfQkFUQ0hfQlVGRkVSX1NUQVJUX0dFTjggfAorCQkoZmxhZ3MgJiBJOTE1X0RJU1BB
VENIX1NFQ1VSRSA/IDAgOiBCSVQoOCkpOworCSpjcysrID0gbG93ZXJfMzJfYml0cyhvZmZzZXQp
OworCSpjcysrID0gdXBwZXJfMzJfYml0cyhvZmZzZXQpOworCisJKmNzKysgPSBNSV9BUkJfT05f
T0ZGIHwgTUlfQVJCX0RJU0FCTEU7CisJKmNzKysgPSBNSV9OT09QOworCisJaW50ZWxfcmluZ19h
ZHZhbmNlKHJxLCBjcyk7CisKKwlyZXR1cm4gMDsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2dlbjhfZW5naW5lX2NzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9n
ZW44X2VuZ2luZV9jcy5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4u
OTI1OTYxYzNlNjQ2Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
Z2VuOF9lbmdpbmVfY3MuaApAQCAtMCwwICsxLDI3IEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRp
ZmllcjogTUlUICovCisvKgorICogQ29weXJpZ2h0IMKpIDIwMTQgSW50ZWwgQ29ycG9yYXRpb24K
KyAqLworCisjaWZuZGVmIF9fR0VOOF9FTkdJTkVfQ1NfSF9fCisjZGVmaW5lIF9fR0VOOF9FTkdJ
TkVfQ1NfSF9fCisKKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgorCitzdHJ1Y3QgaTkxNV9yZXF1
ZXN0OworCitpbnQgZ2VuOF9lbWl0X2ZsdXNoX3JjcyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1
ZXN0LCB1MzIgbW9kZSk7CitpbnQgZ2VuMTFfZW1pdF9mbHVzaF9yY3Moc3RydWN0IGk5MTVfcmVx
dWVzdCAqcmVxdWVzdCwgdTMyIG1vZGUpOworaW50IGdlbjEyX2VtaXRfZmx1c2hfcmNzKHN0cnVj
dCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QsIHUzMiBtb2RlKTsKKworaW50IGdlbjhfZW1pdF9mbHVz
aF94Y3Moc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCwgdTMyIG1vZGUpOworaW50IGdlbjEy
X2VtaXRfZmx1c2hfeGNzKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QsIHUzMiBtb2RlKTsK
KworaW50IGdlbjhfZW1pdF9iYl9zdGFydF9ub2FyYihzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwK
KwkJCSAgICAgdTY0IG9mZnNldCwgdTMyIGxlbiwKKwkJCSAgICAgY29uc3QgdW5zaWduZWQgaW50
IGZsYWdzKTsKK2ludCBnZW44X2VtaXRfYmJfc3RhcnQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEs
CisJCSAgICAgICB1NjQgb2Zmc2V0LCB1MzIgbGVuLAorCQkgICAgICAgY29uc3QgdW5zaWduZWQg
aW50IGZsYWdzKTsKKworI2VuZGlmIC8qIF9fR0VOOF9FTkdJTkVfQ1NfSF9fICovCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9leGVjbGlzdHNfc3VibWlzc2lvbi5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZXhlY2xpc3RzX3N1Ym1pc3Npb24uYwpp
bmRleCBlMWQzNWFiMTdlNmYuLjlkNzNlOTA1MmMwNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZXhlY2xpc3RzX3N1Ym1pc3Npb24uYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9leGVjbGlzdHNfc3VibWlzc2lvbi5jCkBAIC0xMTIsNiArMTEy
LDcgQEAKICNpbmNsdWRlICJpOTE1X3BlcmYuaCIKICNpbmNsdWRlICJpOTE1X3RyYWNlLmgiCiAj
aW5jbHVkZSAiaTkxNV92Z3B1LmgiCisjaW5jbHVkZSAiZ2VuOF9lbmdpbmVfY3MuaCIKICNpbmNs
dWRlICJpbnRlbF9icmVhZGNydW1icy5oIgogI2luY2x1ZGUgImludGVsX2NvbnRleHQuaCIKICNp
bmNsdWRlICJpbnRlbF9lbmdpbmVfcG0uaCIKQEAgLTQ0NzUsNjcgKzQ0NzYsNiBAQCBzdGF0aWMg
dm9pZCBleGVjbGlzdHNfcmVzZXRfZmluaXNoKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSkKIAkJICAgICBhdG9taWNfcmVhZCgmZXhlY2xpc3RzLT50YXNrbGV0LmNvdW50KSk7CiB9CiAK
LXN0YXRpYyBpbnQgZ2VuOF9lbWl0X2JiX3N0YXJ0X25vYXJiKHN0cnVjdCBpOTE1X3JlcXVlc3Qg
KnJxLAotCQkJCSAgICB1NjQgb2Zmc2V0LCB1MzIgbGVuLAotCQkJCSAgICBjb25zdCB1bnNpZ25l
ZCBpbnQgZmxhZ3MpCi17Ci0JdTMyICpjczsKLQotCWNzID0gaW50ZWxfcmluZ19iZWdpbihycSwg
NCk7Ci0JaWYgKElTX0VSUihjcykpCi0JCXJldHVybiBQVFJfRVJSKGNzKTsKLQotCS8qCi0JICog
V2FEaXNhYmxlQ3R4UmVzdG9yZUFyYml0cmF0aW9uOmJkdyxjaHYKLQkgKgotCSAqIFdlIGRvbid0
IG5lZWQgdG8gcGVyZm9ybSBNSV9BUkJfRU5BQkxFIGFzIG9mdGVuIGFzIHdlIGRvIChpbgotCSAq
IHBhcnRpY3VsYXIgYWxsIHRoZSBnZW4gdGhhdCBkbyBub3QgbmVlZCB0aGUgdy9hIGF0IGFsbCEp
LCBpZiB3ZQotCSAqIHRvb2sgY2FyZSB0byBtYWtlIHN1cmUgdGhhdCBvbiBldmVyeSBzd2l0Y2gg
aW50byB0aGlzIGNvbnRleHQKLQkgKiAoYm90aCBvcmRpbmFyeSBhbmQgZm9yIHByZWVtcHRpb24p
IHRoYXQgYXJiaXRyYXJ0aW9uIHdhcyBlbmFibGVkCi0JICogd2Ugd291bGQgYmUgZmluZS4gIEhv
d2V2ZXIsIGZvciBnZW44IHRoZXJlIGlzIGFub3RoZXIgdy9hIHRoYXQKLQkgKiByZXF1aXJlcyB1
cyB0byBub3QgcHJlZW1wdCBpbnNpZGUgR1BHUFUgZXhlY3V0aW9uLCBzbyB3ZSBrZWVwCi0JICog
YXJiaXRyYXRpb24gZGlzYWJsZWQgZm9yIGdlbjggYmF0Y2hlcy4gQXJiaXRyYXRpb24gd2lsbCBi
ZQotCSAqIHJlLWVuYWJsZWQgYmVmb3JlIHdlIGNsb3NlIHRoZSByZXF1ZXN0Ci0JICogKGVuZ2lu
ZS0+ZW1pdF9maW5pX2JyZWFkY3J1bWIpLgotCSAqLwotCSpjcysrID0gTUlfQVJCX09OX09GRiB8
IE1JX0FSQl9ESVNBQkxFOwotCi0JLyogRklYTUUoQkRXKyk6IEFkZHJlc3Mgc3BhY2UgYW5kIHNl
Y3VyaXR5IHNlbGVjdG9ycy4gKi8KLQkqY3MrKyA9IE1JX0JBVENIX0JVRkZFUl9TVEFSVF9HRU44
IHwKLQkJKGZsYWdzICYgSTkxNV9ESVNQQVRDSF9TRUNVUkUgPyAwIDogQklUKDgpKTsKLQkqY3Mr
KyA9IGxvd2VyXzMyX2JpdHMob2Zmc2V0KTsKLQkqY3MrKyA9IHVwcGVyXzMyX2JpdHMob2Zmc2V0
KTsKLQotCWludGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOwotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0
YXRpYyBpbnQgZ2VuOF9lbWl0X2JiX3N0YXJ0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAotCQkJ
ICAgICAgdTY0IG9mZnNldCwgdTMyIGxlbiwKLQkJCSAgICAgIGNvbnN0IHVuc2lnbmVkIGludCBm
bGFncykKLXsKLQl1MzIgKmNzOwotCi0JY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJxLCA2KTsKLQlp
ZiAoSVNfRVJSKGNzKSkKLQkJcmV0dXJuIFBUUl9FUlIoY3MpOwotCi0JKmNzKysgPSBNSV9BUkJf
T05fT0ZGIHwgTUlfQVJCX0VOQUJMRTsKLQotCSpjcysrID0gTUlfQkFUQ0hfQlVGRkVSX1NUQVJU
X0dFTjggfAotCQkoZmxhZ3MgJiBJOTE1X0RJU1BBVENIX1NFQ1VSRSA/IDAgOiBCSVQoOCkpOwot
CSpjcysrID0gbG93ZXJfMzJfYml0cyhvZmZzZXQpOwotCSpjcysrID0gdXBwZXJfMzJfYml0cyhv
ZmZzZXQpOwotCi0JKmNzKysgPSBNSV9BUkJfT05fT0ZGIHwgTUlfQVJCX0RJU0FCTEU7Ci0JKmNz
KysgPSBNSV9OT09QOwotCi0JaW50ZWxfcmluZ19hZHZhbmNlKHJxLCBjcyk7Ci0KLQlyZXR1cm4g
MDsKLX0KLQogc3RhdGljIHZvaWQgZ2VuOF9sb2dpY2FsX3JpbmdfZW5hYmxlX2lycShzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7CiAJRU5HSU5FX1dSSVRFKGVuZ2luZSwgUklOR19J
TVIsCkBAIC00NTQ4LDMyOSArNDQ4OCw2IEBAIHN0YXRpYyB2b2lkIGdlbjhfbG9naWNhbF9yaW5n
X2Rpc2FibGVfaXJxKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAlFTkdJTkVfV1JJ
VEUoZW5naW5lLCBSSU5HX0lNUiwgfmVuZ2luZS0+aXJxX2tlZXBfbWFzayk7CiB9CiAKLXN0YXRp
YyBpbnQgZ2VuOF9lbWl0X2ZsdXNoKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QsIHUzMiBt
b2RlKQotewotCXUzMiBjbWQsICpjczsKLQotCWNzID0gaW50ZWxfcmluZ19iZWdpbihyZXF1ZXN0
LCA0KTsKLQlpZiAoSVNfRVJSKGNzKSkKLQkJcmV0dXJuIFBUUl9FUlIoY3MpOwotCi0JY21kID0g
TUlfRkxVU0hfRFcgKyAxOwotCi0JLyogV2UgYWx3YXlzIHJlcXVpcmUgYSBjb21tYW5kIGJhcnJp
ZXIgc28gdGhhdCBzdWJzZXF1ZW50Ci0JICogY29tbWFuZHMsIHN1Y2ggYXMgYnJlYWRjcnVtYiBp
bnRlcnJ1cHRzLCBhcmUgc3RyaWN0bHkgb3JkZXJlZAotCSAqIHdydCB0aGUgY29udGVudHMgb2Yg
dGhlIHdyaXRlIGNhY2hlIGJlaW5nIGZsdXNoZWQgdG8gbWVtb3J5Ci0JICogKGFuZCB0aHVzIGJl
aW5nIGNvaGVyZW50IGZyb20gdGhlIENQVSkuCi0JICovCi0JY21kIHw9IE1JX0ZMVVNIX0RXX1NU
T1JFX0lOREVYIHwgTUlfRkxVU0hfRFdfT1BfU1RPUkVEVzsKLQotCWlmIChtb2RlICYgRU1JVF9J
TlZBTElEQVRFKSB7Ci0JCWNtZCB8PSBNSV9JTlZBTElEQVRFX1RMQjsKLQkJaWYgKHJlcXVlc3Qt
PmVuZ2luZS0+Y2xhc3MgPT0gVklERU9fREVDT0RFX0NMQVNTKQotCQkJY21kIHw9IE1JX0lOVkFM
SURBVEVfQlNEOwotCX0KLQotCSpjcysrID0gY21kOwotCSpjcysrID0gTFJDX1BQSFdTUF9TQ1JB
VENIX0FERFI7Ci0JKmNzKysgPSAwOyAvKiB1cHBlciBhZGRyICovCi0JKmNzKysgPSAwOyAvKiB2
YWx1ZSAqLwotCWludGVsX3JpbmdfYWR2YW5jZShyZXF1ZXN0LCBjcyk7Ci0KLQlyZXR1cm4gMDsK
LX0KLQotc3RhdGljIGludCBnZW44X2VtaXRfZmx1c2hfcmVuZGVyKHN0cnVjdCBpOTE1X3JlcXVl
c3QgKnJlcXVlc3QsCi0JCQkJICB1MzIgbW9kZSkKLXsKLQlib29sIHZmX2ZsdXNoX3dhID0gZmFs
c2UsIGRjX2ZsdXNoX3dhID0gZmFsc2U7Ci0JdTMyICpjcywgZmxhZ3MgPSAwOwotCWludCBsZW47
Ci0KLQlmbGFncyB8PSBQSVBFX0NPTlRST0xfQ1NfU1RBTEw7Ci0KLQlpZiAobW9kZSAmIEVNSVRf
RkxVU0gpIHsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1JFTkRFUl9UQVJHRVRfQ0FDSEVfRkxV
U0g7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9ERVBUSF9DQUNIRV9GTFVTSDsKLQkJZmxhZ3Mg
fD0gUElQRV9DT05UUk9MX0RDX0ZMVVNIX0VOQUJMRTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9M
X0ZMVVNIX0VOQUJMRTsKLQl9Ci0KLQlpZiAobW9kZSAmIEVNSVRfSU5WQUxJREFURSkgewotCQlm
bGFncyB8PSBQSVBFX0NPTlRST0xfVExCX0lOVkFMSURBVEU7Ci0JCWZsYWdzIHw9IFBJUEVfQ09O
VFJPTF9JTlNUUlVDVElPTl9DQUNIRV9JTlZBTElEQVRFOwotCQlmbGFncyB8PSBQSVBFX0NPTlRS
T0xfVEVYVFVSRV9DQUNIRV9JTlZBTElEQVRFOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfVkZf
Q0FDSEVfSU5WQUxJREFURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0NPTlNUX0NBQ0hFX0lO
VkFMSURBVEU7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9TVEFURV9DQUNIRV9JTlZBTElEQVRF
OwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfUVdfV1JJVEU7Ci0JCWZsYWdzIHw9IFBJUEVfQ09O
VFJPTF9TVE9SRV9EQVRBX0lOREVYOwotCi0JCS8qCi0JCSAqIE9uIEdFTjk6IGJlZm9yZSBWRl9D
QUNIRV9JTlZBTElEQVRFIHdlIG5lZWQgdG8gZW1pdCBhIE5VTEwKLQkJICogcGlwZSBjb250cm9s
LgotCQkgKi8KLQkJaWYgKElTX0dFTihyZXF1ZXN0LT5lbmdpbmUtPmk5MTUsIDkpKQotCQkJdmZf
Zmx1c2hfd2EgPSB0cnVlOwotCi0JCS8qIFdhRm9yR0FNSGFuZzprYmwgKi8KLQkJaWYgKElTX0tC
TF9HVF9SRVZJRChyZXF1ZXN0LT5lbmdpbmUtPmk5MTUsIDAsIEtCTF9SRVZJRF9CMCkpCi0JCQlk
Y19mbHVzaF93YSA9IHRydWU7Ci0JfQotCi0JbGVuID0gNjsKLQotCWlmICh2Zl9mbHVzaF93YSkK
LQkJbGVuICs9IDY7Ci0KLQlpZiAoZGNfZmx1c2hfd2EpCi0JCWxlbiArPSAxMjsKLQotCWNzID0g
aW50ZWxfcmluZ19iZWdpbihyZXF1ZXN0LCBsZW4pOwotCWlmIChJU19FUlIoY3MpKQotCQlyZXR1
cm4gUFRSX0VSUihjcyk7Ci0KLQlpZiAodmZfZmx1c2hfd2EpCi0JCWNzID0gZ2VuOF9lbWl0X3Bp
cGVfY29udHJvbChjcywgMCwgMCk7Ci0KLQlpZiAoZGNfZmx1c2hfd2EpCi0JCWNzID0gZ2VuOF9l
bWl0X3BpcGVfY29udHJvbChjcywgUElQRV9DT05UUk9MX0RDX0ZMVVNIX0VOQUJMRSwKLQkJCQkJ
ICAgIDApOwotCi0JY3MgPSBnZW44X2VtaXRfcGlwZV9jb250cm9sKGNzLCBmbGFncywgTFJDX1BQ
SFdTUF9TQ1JBVENIX0FERFIpOwotCi0JaWYgKGRjX2ZsdXNoX3dhKQotCQljcyA9IGdlbjhfZW1p
dF9waXBlX2NvbnRyb2woY3MsIFBJUEVfQ09OVFJPTF9DU19TVEFMTCwgMCk7Ci0KLQlpbnRlbF9y
aW5nX2FkdmFuY2UocmVxdWVzdCwgY3MpOwotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQg
Z2VuMTFfZW1pdF9mbHVzaF9yZW5kZXIoc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCwKLQkJ
CQkgICB1MzIgbW9kZSkKLXsKLQlpZiAobW9kZSAmIEVNSVRfRkxVU0gpIHsKLQkJdTMyICpjczsK
LQkJdTMyIGZsYWdzID0gMDsKLQotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfQ1NfU1RBTEw7Ci0K
LQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1RJTEVfQ0FDSEVfRkxVU0g7Ci0JCWZsYWdzIHw9IFBJ
UEVfQ09OVFJPTF9SRU5ERVJfVEFSR0VUX0NBQ0hFX0ZMVVNIOwotCQlmbGFncyB8PSBQSVBFX0NP
TlRST0xfREVQVEhfQ0FDSEVfRkxVU0g7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9EQ19GTFVT
SF9FTkFCTEU7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9GTFVTSF9FTkFCTEU7Ci0JCWZsYWdz
IHw9IFBJUEVfQ09OVFJPTF9RV19XUklURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1NUT1JF
X0RBVEFfSU5ERVg7Ci0KLQkJY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJlcXVlc3QsIDYpOwotCQlp
ZiAoSVNfRVJSKGNzKSkKLQkJCXJldHVybiBQVFJfRVJSKGNzKTsKLQotCQljcyA9IGdlbjhfZW1p
dF9waXBlX2NvbnRyb2woY3MsIGZsYWdzLCBMUkNfUFBIV1NQX1NDUkFUQ0hfQUREUik7Ci0JCWlu
dGVsX3JpbmdfYWR2YW5jZShyZXF1ZXN0LCBjcyk7Ci0JfQotCi0JaWYgKG1vZGUgJiBFTUlUX0lO
VkFMSURBVEUpIHsKLQkJdTMyICpjczsKLQkJdTMyIGZsYWdzID0gMDsKLQotCQlmbGFncyB8PSBQ
SVBFX0NPTlRST0xfQ1NfU1RBTEw7Ci0KLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0NPTU1BTkRf
Q0FDSEVfSU5WQUxJREFURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1RMQl9JTlZBTElEQVRF
OwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfSU5TVFJVQ1RJT05fQ0FDSEVfSU5WQUxJREFURTsK
LQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1RFWFRVUkVfQ0FDSEVfSU5WQUxJREFURTsKLQkJZmxh
Z3MgfD0gUElQRV9DT05UUk9MX1ZGX0NBQ0hFX0lOVkFMSURBVEU7Ci0JCWZsYWdzIHw9IFBJUEVf
Q09OVFJPTF9DT05TVF9DQUNIRV9JTlZBTElEQVRFOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xf
U1RBVEVfQ0FDSEVfSU5WQUxJREFURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1FXX1dSSVRF
OwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfU1RPUkVfREFUQV9JTkRFWDsKLQotCQljcyA9IGlu
dGVsX3JpbmdfYmVnaW4ocmVxdWVzdCwgNik7Ci0JCWlmIChJU19FUlIoY3MpKQotCQkJcmV0dXJu
IFBUUl9FUlIoY3MpOwotCi0JCWNzID0gZ2VuOF9lbWl0X3BpcGVfY29udHJvbChjcywgZmxhZ3Ms
IExSQ19QUEhXU1BfU0NSQVRDSF9BRERSKTsKLQkJaW50ZWxfcmluZ19hZHZhbmNlKHJlcXVlc3Qs
IGNzKTsKLQl9Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIHUzMiBwcmVwYXJzZXJfZGlzYWJs
ZShib29sIHN0YXRlKQotewotCXJldHVybiBNSV9BUkJfQ0hFQ0sgfCAxIDw8IDggfCBzdGF0ZTsK
LX0KLQotc3RhdGljIGk5MTVfcmVnX3QgYXV4X2ludl9yZWcoY29uc3Qgc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQotewotCXN0YXRpYyBjb25zdCBpOTE1X3JlZ190IHZkW10gPSB7Ci0J
CUdFTjEyX1ZEMF9BVVhfTlYsCi0JCUdFTjEyX1ZEMV9BVVhfTlYsCi0JCUdFTjEyX1ZEMl9BVVhf
TlYsCi0JCUdFTjEyX1ZEM19BVVhfTlYsCi0JfTsKLQotCXN0YXRpYyBjb25zdCBpOTE1X3JlZ190
IHZlW10gPSB7Ci0JCUdFTjEyX1ZFMF9BVVhfTlYsCi0JCUdFTjEyX1ZFMV9BVVhfTlYsCi0JfTsK
LQotCWlmIChlbmdpbmUtPmNsYXNzID09IFZJREVPX0RFQ09ERV9DTEFTUykKLQkJcmV0dXJuIHZk
W2VuZ2luZS0+aW5zdGFuY2VdOwotCi0JaWYgKGVuZ2luZS0+Y2xhc3MgPT0gVklERU9fRU5IQU5D
RU1FTlRfQ0xBU1MpCi0JCXJldHVybiB2ZVtlbmdpbmUtPmluc3RhbmNlXTsKLQotCUdFTV9CVUdf
T04oInVua25vd24gYXV4X2ludl9yZWdcbiIpOwotCi0JcmV0dXJuIElOVkFMSURfTU1JT19SRUc7
Ci19Ci0KLXN0YXRpYyB1MzIgKgotZ2VuMTJfZW1pdF9hdXhfdGFibGVfaW52KGNvbnN0IGk5MTVf
cmVnX3QgaW52X3JlZywgdTMyICpjcykKLXsKLQkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJfSU1N
KDEpOwotCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoaW52X3JlZyk7Ci0JKmNzKysgPSBB
VVhfSU5WOwotCSpjcysrID0gTUlfTk9PUDsKLQotCXJldHVybiBjczsKLX0KLQotc3RhdGljIGlu
dCBnZW4xMl9lbWl0X2ZsdXNoX3JlbmRlcihzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0LAot
CQkJCSAgIHUzMiBtb2RlKQotewotCWlmIChtb2RlICYgRU1JVF9GTFVTSCkgewotCQl1MzIgZmxh
Z3MgPSAwOwotCQl1MzIgKmNzOwotCi0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9USUxFX0NBQ0hF
X0ZMVVNIOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfRkxVU0hfTDM7Ci0JCWZsYWdzIHw9IFBJ
UEVfQ09OVFJPTF9SRU5ERVJfVEFSR0VUX0NBQ0hFX0ZMVVNIOwotCQlmbGFncyB8PSBQSVBFX0NP
TlRST0xfREVQVEhfQ0FDSEVfRkxVU0g7Ci0JCS8qIFdhXzE0MDk2MDA5MDc6dGdsICovCi0JCWZs
YWdzIHw9IFBJUEVfQ09OVFJPTF9ERVBUSF9TVEFMTDsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9M
X0RDX0ZMVVNIX0VOQUJMRTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0ZMVVNIX0VOQUJMRTsK
LQotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfU1RPUkVfREFUQV9JTkRFWDsKLQkJZmxhZ3MgfD0g
UElQRV9DT05UUk9MX1FXX1dSSVRFOwotCi0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9DU19TVEFM
TDsKLQotCQljcyA9IGludGVsX3JpbmdfYmVnaW4ocmVxdWVzdCwgNik7Ci0JCWlmIChJU19FUlIo
Y3MpKQotCQkJcmV0dXJuIFBUUl9FUlIoY3MpOwotCi0JCWNzID0gZ2VuMTJfZW1pdF9waXBlX2Nv
bnRyb2woY3MsCi0JCQkJCSAgICAgUElQRV9DT05UUk9MMF9IRENfUElQRUxJTkVfRkxVU0gsCi0J
CQkJCSAgICAgZmxhZ3MsIExSQ19QUEhXU1BfU0NSQVRDSF9BRERSKTsKLQkJaW50ZWxfcmluZ19h
ZHZhbmNlKHJlcXVlc3QsIGNzKTsKLQl9Ci0KLQlpZiAobW9kZSAmIEVNSVRfSU5WQUxJREFURSkg
ewotCQl1MzIgZmxhZ3MgPSAwOwotCQl1MzIgKmNzOwotCi0JCWZsYWdzIHw9IFBJUEVfQ09OVFJP
TF9DT01NQU5EX0NBQ0hFX0lOVkFMSURBVEU7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9UTEJf
SU5WQUxJREFURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0lOU1RSVUNUSU9OX0NBQ0hFX0lO
VkFMSURBVEU7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9URVhUVVJFX0NBQ0hFX0lOVkFMSURB
VEU7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9WRl9DQUNIRV9JTlZBTElEQVRFOwotCQlmbGFn
cyB8PSBQSVBFX0NPTlRST0xfQ09OU1RfQ0FDSEVfSU5WQUxJREFURTsKLQkJZmxhZ3MgfD0gUElQ
RV9DT05UUk9MX1NUQVRFX0NBQ0hFX0lOVkFMSURBVEU7Ci0KLQkJZmxhZ3MgfD0gUElQRV9DT05U
Uk9MX1NUT1JFX0RBVEFfSU5ERVg7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9RV19XUklURTsK
LQotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfQ1NfU1RBTEw7Ci0KLQkJY3MgPSBpbnRlbF9yaW5n
X2JlZ2luKHJlcXVlc3QsIDggKyA0KTsKLQkJaWYgKElTX0VSUihjcykpCi0JCQlyZXR1cm4gUFRS
X0VSUihjcyk7Ci0KLQkJLyoKLQkJICogUHJldmVudCB0aGUgcHJlLXBhcnNlciBmcm9tIHNraXBw
aW5nIHBhc3QgdGhlIFRMQgotCQkgKiBpbnZhbGlkYXRlIGFuZCBsb2FkaW5nIGEgc3RhbGUgcGFn
ZSBmb3IgdGhlIGJhdGNoCi0JCSAqIGJ1ZmZlciAvIHJlcXVlc3QgcGF5bG9hZC4KLQkJICovCi0J
CSpjcysrID0gcHJlcGFyc2VyX2Rpc2FibGUodHJ1ZSk7Ci0KLQkJY3MgPSBnZW44X2VtaXRfcGlw
ZV9jb250cm9sKGNzLCBmbGFncywgTFJDX1BQSFdTUF9TQ1JBVENIX0FERFIpOwotCi0JCS8qIGhz
ZGVzOiAxODA5MTc1NzkwICovCi0JCWNzID0gZ2VuMTJfZW1pdF9hdXhfdGFibGVfaW52KEdFTjEy
X0dGWF9DQ1NfQVVYX05WLCBjcyk7Ci0KLQkJKmNzKysgPSBwcmVwYXJzZXJfZGlzYWJsZShmYWxz
ZSk7Ci0JCWludGVsX3JpbmdfYWR2YW5jZShyZXF1ZXN0LCBjcyk7Ci0JfQotCi0JcmV0dXJuIDA7
Ci19Ci0KLXN0YXRpYyBpbnQgZ2VuMTJfZW1pdF9mbHVzaChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpy
ZXF1ZXN0LCB1MzIgbW9kZSkKLXsKLQlpbnRlbF9lbmdpbmVfbWFza190IGF1eF9pbnYgPSAwOwot
CXUzMiBjbWQsICpjczsKLQotCWNtZCA9IDQ7Ci0JaWYgKG1vZGUgJiBFTUlUX0lOVkFMSURBVEUp
Ci0JCWNtZCArPSAyOwotCWlmIChtb2RlICYgRU1JVF9JTlZBTElEQVRFKQotCQlhdXhfaW52ID0g
cmVxdWVzdC0+ZW5naW5lLT5tYXNrICYgfkJJVChCQ1MwKTsKLQlpZiAoYXV4X2ludikKLQkJY21k
ICs9IDIgKiBod2VpZ2h0OChhdXhfaW52KSArIDI7Ci0KLQljcyA9IGludGVsX3JpbmdfYmVnaW4o
cmVxdWVzdCwgY21kKTsKLQlpZiAoSVNfRVJSKGNzKSkKLQkJcmV0dXJuIFBUUl9FUlIoY3MpOwot
Ci0JaWYgKG1vZGUgJiBFTUlUX0lOVkFMSURBVEUpCi0JCSpjcysrID0gcHJlcGFyc2VyX2Rpc2Fi
bGUodHJ1ZSk7Ci0KLQljbWQgPSBNSV9GTFVTSF9EVyArIDE7Ci0KLQkvKiBXZSBhbHdheXMgcmVx
dWlyZSBhIGNvbW1hbmQgYmFycmllciBzbyB0aGF0IHN1YnNlcXVlbnQKLQkgKiBjb21tYW5kcywg
c3VjaCBhcyBicmVhZGNydW1iIGludGVycnVwdHMsIGFyZSBzdHJpY3RseSBvcmRlcmVkCi0JICog
d3J0IHRoZSBjb250ZW50cyBvZiB0aGUgd3JpdGUgY2FjaGUgYmVpbmcgZmx1c2hlZCB0byBtZW1v
cnkKLQkgKiAoYW5kIHRodXMgYmVpbmcgY29oZXJlbnQgZnJvbSB0aGUgQ1BVKS4KLQkgKi8KLQlj
bWQgfD0gTUlfRkxVU0hfRFdfU1RPUkVfSU5ERVggfCBNSV9GTFVTSF9EV19PUF9TVE9SRURXOwot
Ci0JaWYgKG1vZGUgJiBFTUlUX0lOVkFMSURBVEUpIHsKLQkJY21kIHw9IE1JX0lOVkFMSURBVEVf
VExCOwotCQlpZiAocmVxdWVzdC0+ZW5naW5lLT5jbGFzcyA9PSBWSURFT19ERUNPREVfQ0xBU1Mp
Ci0JCQljbWQgfD0gTUlfSU5WQUxJREFURV9CU0Q7Ci0JfQotCi0JKmNzKysgPSBjbWQ7Ci0JKmNz
KysgPSBMUkNfUFBIV1NQX1NDUkFUQ0hfQUREUjsKLQkqY3MrKyA9IDA7IC8qIHVwcGVyIGFkZHIg
Ki8KLQkqY3MrKyA9IDA7IC8qIHZhbHVlICovCi0KLQlpZiAoYXV4X2ludikgeyAvKiBoc2Rlczog
MTgwOTE3NTc5MCAqLwotCQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0JCXVuc2ln
bmVkIGludCB0bXA7Ci0KLQkJKmNzKysgPSBNSV9MT0FEX1JFR0lTVEVSX0lNTShod2VpZ2h0OChh
dXhfaW52KSk7Ci0JCWZvcl9lYWNoX2VuZ2luZV9tYXNrZWQoZW5naW5lLCByZXF1ZXN0LT5lbmdp
bmUtPmd0LAotCQkJCSAgICAgICBhdXhfaW52LCB0bXApIHsKLQkJCSpjcysrID0gaTkxNV9tbWlv
X3JlZ19vZmZzZXQoYXV4X2ludl9yZWcoZW5naW5lKSk7Ci0JCQkqY3MrKyA9IEFVWF9JTlY7Ci0J
CX0KLQkJKmNzKysgPSBNSV9OT09QOwotCX0KLQotCWlmIChtb2RlICYgRU1JVF9JTlZBTElEQVRF
KQotCQkqY3MrKyA9IHByZXBhcnNlcl9kaXNhYmxlKGZhbHNlKTsKLQotCWludGVsX3JpbmdfYWR2
YW5jZShyZXF1ZXN0LCBjcyk7Ci0KLQlyZXR1cm4gMDsKLX0KIAogc3RhdGljIHZvaWQgYXNzZXJ0
X3JlcXVlc3RfdmFsaWQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiB7CkBAIC01MTEzLDEyICs0
NzMwLDEyIEBAIGxvZ2ljYWxfcmluZ19kZWZhdWx0X3ZmdW5jcyhzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUpCiAJZW5naW5lLT5jb3BzID0gJmV4ZWNsaXN0c19jb250ZXh0X29wczsKIAll
bmdpbmUtPnJlcXVlc3RfYWxsb2MgPSBleGVjbGlzdHNfcmVxdWVzdF9hbGxvYzsKIAotCWVuZ2lu
ZS0+ZW1pdF9mbHVzaCA9IGdlbjhfZW1pdF9mbHVzaDsKKwllbmdpbmUtPmVtaXRfZmx1c2ggPSBn
ZW44X2VtaXRfZmx1c2hfeGNzOwogCWVuZ2luZS0+ZW1pdF9pbml0X2JyZWFkY3J1bWIgPSBnZW44
X2VtaXRfaW5pdF9icmVhZGNydW1iOwogCWVuZ2luZS0+ZW1pdF9maW5pX2JyZWFkY3J1bWIgPSBn
ZW44X2VtaXRfZmluaV9icmVhZGNydW1iOwogCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+
PSAxMikgewogCQllbmdpbmUtPmVtaXRfZmluaV9icmVhZGNydW1iID0gZ2VuMTJfZW1pdF9maW5p
X2JyZWFkY3J1bWI7Ci0JCWVuZ2luZS0+ZW1pdF9mbHVzaCA9IGdlbjEyX2VtaXRfZmx1c2g7CisJ
CWVuZ2luZS0+ZW1pdF9mbHVzaCA9IGdlbjEyX2VtaXRfZmx1c2hfeGNzOwogCX0KIAllbmdpbmUt
PnNldF9kZWZhdWx0X3N1Ym1pc3Npb24gPSBpbnRlbF9leGVjbGlzdHNfc2V0X2RlZmF1bHRfc3Vi
bWlzc2lvbjsKIApAQCAtNTE2MiwxNSArNDc3OSwxNSBAQCBzdGF0aWMgdm9pZCByY3Nfc3VibWlz
c2lvbl9vdmVycmlkZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7CiAJc3dpdGNo
IChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSkgewogCWNhc2UgMTI6Ci0JCWVuZ2luZS0+ZW1pdF9m
bHVzaCA9IGdlbjEyX2VtaXRfZmx1c2hfcmVuZGVyOworCQllbmdpbmUtPmVtaXRfZmx1c2ggPSBn
ZW4xMl9lbWl0X2ZsdXNoX3JjczsKIAkJZW5naW5lLT5lbWl0X2ZpbmlfYnJlYWRjcnVtYiA9IGdl
bjEyX2VtaXRfZmluaV9icmVhZGNydW1iX3JjczsKIAkJYnJlYWs7CiAJY2FzZSAxMToKLQkJZW5n
aW5lLT5lbWl0X2ZsdXNoID0gZ2VuMTFfZW1pdF9mbHVzaF9yZW5kZXI7CisJCWVuZ2luZS0+ZW1p
dF9mbHVzaCA9IGdlbjExX2VtaXRfZmx1c2hfcmNzOwogCQllbmdpbmUtPmVtaXRfZmluaV9icmVh
ZGNydW1iID0gZ2VuMTFfZW1pdF9maW5pX2JyZWFkY3J1bWJfcmNzOwogCQlicmVhazsKIAlkZWZh
dWx0OgotCQllbmdpbmUtPmVtaXRfZmx1c2ggPSBnZW44X2VtaXRfZmx1c2hfcmVuZGVyOworCQll
bmdpbmUtPmVtaXRfZmx1c2ggPSBnZW44X2VtaXRfZmx1c2hfcmNzOwogCQllbmdpbmUtPmVtaXRf
ZmluaV9icmVhZGNydW1iID0gZ2VuOF9lbWl0X2ZpbmlfYnJlYWRjcnVtYl9yY3M7CiAJCWJyZWFr
OwogCX0KLS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0
b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50
ZWwtZ2Z4Cg==

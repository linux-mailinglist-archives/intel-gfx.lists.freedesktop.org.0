Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id E4053AC51E
	for <lists+intel-gfx@lfdr.de>; Sat,  7 Sep 2019 09:21:33 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 972EE89E26;
	Sat,  7 Sep 2019 07:21:30 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga12.intel.com (mga12.intel.com [192.55.52.136])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 05B6689E26
 for <intel-gfx@lists.freedesktop.org>; Sat,  7 Sep 2019 07:21:29 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga007.jf.intel.com ([10.7.209.58])
 by fmsmga106.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 07 Sep 2019 00:21:28 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,477,1559545200"; d="scan'208";a="174498762"
Received: from dk-chv.jf.intel.com ([10.165.21.141])
 by orsmga007.jf.intel.com with ESMTP; 07 Sep 2019 00:21:28 -0700
From: Dhinakaran Pandiyan <dhinakaran.pandiyan@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Sat,  7 Sep 2019 00:21:11 -0700
Message-Id: <20190907072111.31132-2-dhinakaran.pandiyan@intel.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190907072111.31132-1-dhinakaran.pandiyan@intel.com>
References: <20190907072111.31132-1-dhinakaran.pandiyan@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 2/2] drm/i915/tgl: Gen-12 render decompression
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Nanley G Chery <nanley.g.chery@intel.com>,
 Lucas De Marchi <lucas.demarchi@intel.com>,
 Dhinakaran Pandiyan <dhinakaran.pandiyan@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

R2VuLTEyIGRpc3BsYXkgZGVjb21wcmVzc2lvbiBvcGVyYXRlcyBvbiBZLXRpbGVkIGNvbXByZXNz
ZWQgbWFpbiBzdXJmYWNlLgpUaGUgQ0NTIGlzIGxpbmVhciBhbmQgaGFzIDQgYml0cyBvZiBtZXRh
ZGF0YSBmb3IgZWFjaCBtYWluIHN1cmZhY2UgY2FjaGUKbGluZSBwYWlyLCBhIHNpemUgcmF0aW8g
b2YgMToyNTYuIEdlbi0xMiBkaXNwbGF5IGRlY29tcHJlc3Npb24gaXMKaW5jb21wYXRpYmxlIHdp
dGggYnVmZmVycyBjb21wcmVzc2VkIGJ5IGVhcmxpZXIgR1BVcywgc28gbWFrZSB1c2Ugb2YgYSBu
ZXcKbW9kaWZpZXIgdG8gaWRlbnRpZnkgZ2VuLTEyIGNvbXByZXNzaW9uLiBBbm90aGVyIG5vdGFi
bGUgY2hhbmdlIGlzIHRoYXQKcmVuZGVyIGRlY29tcHJlc3Npb24gaXMgc3VwcG9ydGVkIG9uIGFs
bCBwbGFuZXMgZXhjZXB0IGN1cnNvciBhbmQgb24gYWxsCnBpcGVzLiBTdGFydCBieSBhZGRpbmcg
cmVuZGVyIGRlY29tcHJlc3Npb24gc3VwcG9ydCBmb3IgW0EsWF1CR1I4ODggcGl4ZWwKZm9ybWF0
cy4KCnYyOiBGaXggY2hlY2twYXRjaCB3YXJuaW5ncyAoTHVjYXMpCgpDYzogVmlsbGUgU3lyasOk
bMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KQ2M6IE1hdHQgUm9wZXIgPG1hdHRo
ZXcuZC5yb3BlckBpbnRlbC5jb20+CkNjOiBOYW5sZXkgRyBDaGVyeSA8bmFubGV5LmcuY2hlcnlA
aW50ZWwuY29tPgpDYzogSmFzb24gRWtzdHJhbmQgPGphc29uQGpsZWtzdHJhbmQubmV0PgpTaWdu
ZWQtb2ZmLWJ5OiBEaGluYWthcmFuIFBhbmRpeWFuIDxkaGluYWthcmFuLnBhbmRpeWFuQGludGVs
LmNvbT4KU2lnbmVkLW9mZi1ieTogTHVjYXMgRGUgTWFyY2hpIDxsdWNhcy5kZW1hcmNoaUBpbnRl
bC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMg
fCA2MyArKysrKysrKysrKysrKysrKy0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9zcHJpdGUuYyAgfCAyMyArKysrLS0tCiAyIGZpbGVzIGNoYW5nZWQsIDcxIGluc2VydGlv
bnMoKyksIDE1IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kaXNwbGF5LmMKaW5kZXggM2I1Mjc1YWI2NmNmLi4zMDNlMWQyZTk3YTYgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCkBAIC0xOTExLDYgKzE5
MTEsMTAgQEAgaW50ZWxfdGlsZV93aWR0aF9ieXRlcyhjb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVm
ZmVyICpmYiwgaW50IGNvbG9yX3BsYW5lKQogCQlpZiAoY29sb3JfcGxhbmUgPT0gMSkKIAkJCXJl
dHVybiAxMjg7CiAJCS8qIGZhbGwgdGhyb3VnaCAqLworCWNhc2UgSTkxNV9GT1JNQVRfTU9EX1lf
VElMRURfR0VOMTJfUkNfQ0NTOgorCQlpZiAoY29sb3JfcGxhbmUgPT0gMSkKKwkJCXJldHVybiBj
cHA7CisJCS8qIGZhbGwgdGhyb3VnaCAqLwogCWNhc2UgSTkxNV9GT1JNQVRfTU9EX1lfVElMRUQ6
CiAJCWlmIChJU19HRU4oZGV2X3ByaXYsIDIpIHx8IEhBU18xMjhfQllURV9ZX1RJTElORyhkZXZf
cHJpdikpCiAJCQlyZXR1cm4gMTI4OwpAQCAtMjA0NCw2ICsyMDQ4LDggQEAgc3RhdGljIHVuc2ln
bmVkIGludCBpbnRlbF9zdXJmX2FsaWdubWVudChjb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVy
ICpmYiwKIAkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkKIAkJCXJldHVybiAyNTYgKiAx
MDI0OwogCQlyZXR1cm4gMDsKKwljYXNlIEk5MTVfRk9STUFUX01PRF9ZX1RJTEVEX0dFTjEyX1JD
X0NDUzoKKwkJcmV0dXJuIDQgKiA0ICogMTAyNDsKIAljYXNlIEk5MTVfRk9STUFUX01PRF9ZX1RJ
TEVEX0NDUzoKIAljYXNlIEk5MTVfRk9STUFUX01PRF9ZZl9USUxFRF9DQ1M6CiAJY2FzZSBJOTE1
X0ZPUk1BVF9NT0RfWV9USUxFRDoKQEAgLTIyNDMsNyArMjI0OSw4IEBAIHN0YXRpYyB1MzIgaW50
ZWxfYWRqdXN0X3RpbGVfb2Zmc2V0KGludCAqeCwgaW50ICp5LAogCiBzdGF0aWMgYm9vbCBpc19z
dXJmYWNlX2xpbmVhcih1NjQgbW9kaWZpZXIsIGludCBjb2xvcl9wbGFuZSkKIHsKLQlyZXR1cm4g
bW9kaWZpZXIgPT0gRFJNX0ZPUk1BVF9NT0RfTElORUFSOworCXJldHVybiBtb2RpZmllciA9PSBE
Uk1fRk9STUFUX01PRF9MSU5FQVIgfHwKKwkgICAgICAgKG1vZGlmaWVyID09IEk5MTVfRk9STUFU
X01PRF9ZX1RJTEVEX0dFTjEyX1JDX0NDUyAmJiBjb2xvcl9wbGFuZSA9PSAxKTsKIH0KIAogc3Rh
dGljIHUzMiBpbnRlbF9hZGp1c3RfYWxpZ25lZF9vZmZzZXQoaW50ICp4LCBpbnQgKnksCkBAIC0y
NDMwLDYgKzI0MzcsNyBAQCBzdGF0aWMgdW5zaWduZWQgaW50IGludGVsX2ZiX21vZGlmaWVyX3Rv
X3RpbGluZyh1NjQgZmJfbW9kaWZpZXIpCiAJCXJldHVybiBJOTE1X1RJTElOR19YOwogCWNhc2Ug
STkxNV9GT1JNQVRfTU9EX1lfVElMRUQ6CiAJY2FzZSBJOTE1X0ZPUk1BVF9NT0RfWV9USUxFRF9D
Q1M6CisJY2FzZSBJOTE1X0ZPUk1BVF9NT0RfWV9USUxFRF9HRU4xMl9SQ19DQ1M6CiAJCXJldHVy
biBJOTE1X1RJTElOR19ZOwogCWRlZmF1bHQ6CiAJCXJldHVybiBJOTE1X1RJTElOR19OT05FOwpA
QCAtMjQ1MCw3ICsyNDU4LDcgQEAgc3RhdGljIHVuc2lnbmVkIGludCBpbnRlbF9mYl9tb2RpZmll
cl90b190aWxpbmcodTY0IGZiX21vZGlmaWVyKQogICogdXMgYSByYXRpbyBvZiBvbmUgYnl0ZSBp
biB0aGUgQ0NTIGZvciBlYWNoIDh4MTYgcGl4ZWxzIGluIHRoZQogICogbWFpbiBzdXJmYWNlLgog
ICovCi1zdGF0aWMgY29uc3Qgc3RydWN0IGRybV9mb3JtYXRfaW5mbyBjY3NfZm9ybWF0c1tdID0g
eworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZm9ybWF0X2luZm8gc2tsX2Njc19mb3JtYXRzW10g
PSB7CiAJeyAuZm9ybWF0ID0gRFJNX0ZPUk1BVF9YUkdCODg4OCwgLmRlcHRoID0gMjQsIC5udW1f
cGxhbmVzID0gMiwKIAkgIC5jcHAgPSB7IDQsIDEsIH0sIC5oc3ViID0gOCwgLnZzdWIgPSAxNiwg
fSwKIAl7IC5mb3JtYXQgPSBEUk1fRk9STUFUX1hCR1I4ODg4LCAuZGVwdGggPSAyNCwgLm51bV9w
bGFuZXMgPSAyLApAQCAtMjQ2MSw2ICsyNDY5LDI0IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJt
X2Zvcm1hdF9pbmZvIGNjc19mb3JtYXRzW10gPSB7CiAJICAuY3BwID0geyA0LCAxLCB9LCAuaHN1
YiA9IDgsIC52c3ViID0gMTYsIC5oYXNfYWxwaGEgPSB0cnVlLCB9LAogfTsKIAorLyoKKyAqIEdl
bi0xMiBjb21wcmVzc2lvbiB1c2VzIDQgYml0cyBvZiBDQ1MgZGF0YSBmb3IgZWFjaCBjYWNoZSBs
aW5lIHBhaXIgaW4gdGhlCisgKiBtYWluIHN1cmZhY2UuIEFuZCBlYWNoIDY0QiBDQ1MgY2FjaGUg
bGluZSByZXByZXNlbnRzIGFuIGFyZWEgb2YgNHgxIFktdGlsZXMKKyAqIGluIHRoZSBtYWluIHN1
cmZhY2UuIFdpdGggNCBieXRlIHBpeGVscyBhbmQgZWFjaCBZLXRpbGUgaGF2aW5nIGRpbWVuc2lv
bnMgb2YKKyAqIDMyeDMyIHBpeGVscywgdGhlIHJhdGlvIHR1cm5zIG91dCB0byAxQiBpbiB0aGUg
Q0NTIGZvciBldmVyeSAyeDMyIHBpeGVscyBpbgorICogdGhlIG1haW4gc3VyZmFjZS4KKyAqLwor
c3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZm9ybWF0X2luZm8gZ2VuMTJfY2NzX2Zvcm1hdHNbXSA9
IHsKKwl7IC5mb3JtYXQgPSBEUk1fRk9STUFUX1hSR0I4ODg4LCAuZGVwdGggPSAyNCwgLm51bV9w
bGFuZXMgPSAyLAorCSAgLmNwcCA9IHsgNCwgMSwgfSwgLmhzdWIgPSAyLCAudnN1YiA9IDMyLCB9
LAorCXsgLmZvcm1hdCA9IERSTV9GT1JNQVRfWEJHUjg4ODgsIC5kZXB0aCA9IDI0LCAubnVtX3Bs
YW5lcyA9IDIsCisJICAuY3BwID0geyA0LCAxLCB9LCAuaHN1YiA9IDIsIC52c3ViID0gMzIsIH0s
CisJeyAuZm9ybWF0ID0gRFJNX0ZPUk1BVF9BUkdCODg4OCwgLmRlcHRoID0gMzIsIC5udW1fcGxh
bmVzID0gMiwKKwkgIC5jcHAgPSB7IDQsIDEsIH0sIC5oc3ViID0gMiwgLnZzdWIgPSAzMiwgLmhh
c19hbHBoYSA9IHRydWUgfSwKKwl7IC5mb3JtYXQgPSBEUk1fRk9STUFUX0FCR1I4ODg4LCAuZGVw
dGggPSAzMiwgLm51bV9wbGFuZXMgPSAyLAorCSAgLmNwcCA9IHsgNCwgMSwgfSwgLmhzdWIgPSAy
LCAudnN1YiA9IDMyLCAuaGFzX2FscGhhID0gdHJ1ZSB9LAorfTsKKwogc3RhdGljIGNvbnN0IHN0
cnVjdCBkcm1fZm9ybWF0X2luZm8gKgogbG9va3VwX2Zvcm1hdF9pbmZvKGNvbnN0IHN0cnVjdCBk
cm1fZm9ybWF0X2luZm8gZm9ybWF0c1tdLAogCQkgICBpbnQgbnVtX2Zvcm1hdHMsIHUzMiBmb3Jt
YXQpCkBAIC0yNDgxLDggKzI1MDcsMTIgQEAgaW50ZWxfZ2V0X2Zvcm1hdF9pbmZvKGNvbnN0IHN0
cnVjdCBkcm1fbW9kZV9mYl9jbWQyICpjbWQpCiAJc3dpdGNoIChjbWQtPm1vZGlmaWVyWzBdKSB7
CiAJY2FzZSBJOTE1X0ZPUk1BVF9NT0RfWV9USUxFRF9DQ1M6CiAJY2FzZSBJOTE1X0ZPUk1BVF9N
T0RfWWZfVElMRURfQ0NTOgotCQlyZXR1cm4gbG9va3VwX2Zvcm1hdF9pbmZvKGNjc19mb3JtYXRz
LAotCQkJCQkgIEFSUkFZX1NJWkUoY2NzX2Zvcm1hdHMpLAorCQlyZXR1cm4gbG9va3VwX2Zvcm1h
dF9pbmZvKHNrbF9jY3NfZm9ybWF0cywKKwkJCQkJICBBUlJBWV9TSVpFKHNrbF9jY3NfZm9ybWF0
cyksCisJCQkJCSAgY21kLT5waXhlbF9mb3JtYXQpOworCWNhc2UgSTkxNV9GT1JNQVRfTU9EX1lf
VElMRURfR0VOMTJfUkNfQ0NTOgorCQlyZXR1cm4gbG9va3VwX2Zvcm1hdF9pbmZvKGdlbjEyX2Nj
c19mb3JtYXRzLAorCQkJCQkgIEFSUkFZX1NJWkUoZ2VuMTJfY2NzX2Zvcm1hdHMpLAogCQkJCQkg
IGNtZC0+cGl4ZWxfZm9ybWF0KTsKIAlkZWZhdWx0OgogCQlyZXR1cm4gTlVMTDsKQEAgLTI0OTEs
NyArMjUyMSw4IEBAIGludGVsX2dldF9mb3JtYXRfaW5mbyhjb25zdCBzdHJ1Y3QgZHJtX21vZGVf
ZmJfY21kMiAqY21kKQogCiBib29sIGlzX2Njc19tb2RpZmllcih1NjQgbW9kaWZpZXIpCiB7Ci0J
cmV0dXJuIG1vZGlmaWVyID09IEk5MTVfRk9STUFUX01PRF9ZX1RJTEVEX0NDUyB8fAorCXJldHVy
biBtb2RpZmllciA9PSBJOTE1X0ZPUk1BVF9NT0RfWV9USUxFRF9HRU4xMl9SQ19DQ1MgfHwKKwkg
ICAgICAgbW9kaWZpZXIgPT0gSTkxNV9GT1JNQVRfTU9EX1lfVElMRURfQ0NTIHx8CiAJICAgICAg
IG1vZGlmaWVyID09IEk5MTVfRk9STUFUX01PRF9ZZl9USUxFRF9DQ1M7CiB9CiAKQEAgLTI2NjAs
NyArMjY5MSwxMyBAQCBpbnRlbF9maWxsX2ZiX2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAogCQkJaW50IG1haW5feCwgbWFpbl95OwogCQkJaW50IGNjc194LCBjY3NfeTsK
IAotCQkJaW50ZWxfdGlsZV9kaW1zKGZiLCBpLCAmdGlsZV93aWR0aCwgJnRpbGVfaGVpZ2h0KTsK
KwkJCWlmICghaXNfc3VyZmFjZV9saW5lYXIoZmItPm1vZGlmaWVyLCBpKSkgeworCQkJCWludGVs
X3RpbGVfZGltcyhmYiwgaSwgJnRpbGVfd2lkdGgsICZ0aWxlX2hlaWdodCk7CisJCQl9IGVsc2Ug
eworCQkJCXRpbGVfd2lkdGggPSA2NCAvIGNwcDsKKwkJCQl0aWxlX2hlaWdodCA9IDE7CisJCQl9
CisKIAkJCXRpbGVfd2lkdGggKj0gaHN1YjsKIAkJCXRpbGVfaGVpZ2h0ICo9IHZzdWI7CiAKQEAg
LTQwNTQsNiArNDA5MSw4IEBAIHN0YXRpYyB1MzIgc2tsX3BsYW5lX2N0bF90aWxpbmcodTY0IGZi
X21vZGlmaWVyKQogCWNhc2UgSTkxNV9GT1JNQVRfTU9EX1lfVElMRUQ6CiAJCXJldHVybiBQTEFO
RV9DVExfVElMRURfWTsKIAljYXNlIEk5MTVfRk9STUFUX01PRF9ZX1RJTEVEX0NDUzoKKwkJLyog
ZmFsbCB0aHJvdWdoICovCisJY2FzZSBJOTE1X0ZPUk1BVF9NT0RfWV9USUxFRF9HRU4xMl9SQ19D
Q1M6CiAJCXJldHVybiBQTEFORV9DVExfVElMRURfWSB8IFBMQU5FX0NUTF9SRU5ERVJfREVDT01Q
UkVTU0lPTl9FTkFCTEU7CiAJY2FzZSBJOTE1X0ZPUk1BVF9NT0RfWWZfVElMRUQ6CiAJCXJldHVy
biBQTEFORV9DVExfVElMRURfWUY7CkBAIC05ODI5LDcgKzk4NjgsOSBAQCBza3lsYWtlX2dldF9p
bml0aWFsX3BsYW5lX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKIAljYXNlIFBMQU5F
X0NUTF9USUxFRF9ZOgogCQlwbGFuZV9jb25maWctPnRpbGluZyA9IEk5MTVfVElMSU5HX1k7CiAJ
CWlmICh2YWwgJiBQTEFORV9DVExfUkVOREVSX0RFQ09NUFJFU1NJT05fRU5BQkxFKQotCQkJZmIt
Pm1vZGlmaWVyID0gSTkxNV9GT1JNQVRfTU9EX1lfVElMRURfQ0NTOworCQkJZmItPm1vZGlmaWVy
ID0gSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMiA/CisJCQkJSTkxNV9GT1JNQVRfTU9EX1lfVElM
RURfR0VOMTJfUkNfQ0NTIDoKKwkJCQlJOTE1X0ZPUk1BVF9NT0RfWV9USUxFRF9DQ1M7CiAJCWVs
c2UKIAkJCWZiLT5tb2RpZmllciA9IEk5MTVfRk9STUFUX01PRF9ZX1RJTEVEOwogCQlicmVhazsK
QEAgLTE1NzQ2LDYgKzE1Nzg3LDE0IEBAIHN0YXRpYyBpbnQgaW50ZWxfZnJhbWVidWZmZXJfaW5p
dChzdHJ1Y3QgaW50ZWxfZnJhbWVidWZmZXIgKmludGVsX2ZiLAogCQkgICAgaXNfY2NzX21vZGlm
aWVyKGZiLT5tb2RpZmllcikpCiAJCQlzdHJpZGVfYWxpZ25tZW50ICo9IDQ7CiAKKwkJLyoKKwkJ
ICogVGhlIG1haW4gc3VyZmFjZSBwaXRjaCBtdXN0IGJlIHBhZGRlZCB0byBhIG11bHRpcGxlIG9m
IGZvdXIKKwkJICogdGlsZSB3aWR0aHMuCisJCSAqLworCQlpZiAoZmItPm1vZGlmaWVyID09IEk5
MTVfRk9STUFUX01PRF9ZX1RJTEVEX0dFTjEyX1JDX0NDUyAmJgorCQkgICAgaSA9PSAwKQorCQkJ
c3RyaWRlX2FsaWdubWVudCAqPSA0OworCiAJCWlmIChmYi0+cGl0Y2hlc1tpXSAmIChzdHJpZGVf
YWxpZ25tZW50IC0gMSkpIHsKIAkJCURSTV9ERUJVR19LTVMoInBsYW5lICVkIHBpdGNoICglZCkg
bXVzdCBiZSBhdCBsZWFzdCAldSBieXRlIGFsaWduZWRcbiIsCiAJCQkJICAgICAgaSwgZmItPnBp
dGNoZXNbaV0sIHN0cmlkZV9hbGlnbm1lbnQpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9zcHJpdGUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfc3ByaXRlLmMKaW5kZXggZTQxNWIwYWQ0YTQyLi43YjEwODdmNzFkNmIgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3ByaXRlLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zcHJpdGUuYwpAQCAtNTQ3LDYgKzU0
Nyw3IEBAIHNrbF9wcm9ncmFtX3BsYW5lKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCiAJY29u
c3Qgc3RydWN0IGRybV9pbnRlbF9zcHJpdGVfY29sb3JrZXkgKmtleSA9ICZwbGFuZV9zdGF0ZS0+
Y2tleTsKIAl1MzIgc3VyZl9hZGRyID0gcGxhbmVfc3RhdGUtPmNvbG9yX3BsYW5lW2NvbG9yX3Bs
YW5lXS5vZmZzZXQ7CiAJdTMyIHN0cmlkZSA9IHNrbF9wbGFuZV9zdHJpZGUocGxhbmVfc3RhdGUs
IGNvbG9yX3BsYW5lKTsKKwl1MzIgYXV4X2Rpc3QgPSBwbGFuZV9zdGF0ZS0+Y29sb3JfcGxhbmVb
MV0ub2Zmc2V0IC0gc3VyZl9hZGRyOwogCXUzMiBhdXhfc3RyaWRlID0gc2tsX3BsYW5lX3N0cmlk
ZShwbGFuZV9zdGF0ZSwgMSk7CiAJaW50IGNydGNfeCA9IHBsYW5lX3N0YXRlLT5iYXNlLmRzdC54
MTsKIAlpbnQgY3J0Y195ID0gcGxhbmVfc3RhdGUtPmJhc2UuZHN0LnkxOwpAQCAtNTg4LDggKzU4
OSwxMCBAQCBza2xfcHJvZ3JhbV9wbGFuZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAogCUk5
MTVfV1JJVEVfRlcoUExBTkVfU1RSSURFKHBpcGUsIHBsYW5lX2lkKSwgc3RyaWRlKTsKIAlJOTE1
X1dSSVRFX0ZXKFBMQU5FX1BPUyhwaXBlLCBwbGFuZV9pZCksIChjcnRjX3kgPDwgMTYpIHwgY3J0
Y194KTsKIAlJOTE1X1dSSVRFX0ZXKFBMQU5FX1NJWkUocGlwZSwgcGxhbmVfaWQpLCAoc3JjX2gg
PDwgMTYpIHwgc3JjX3cpOwotCUk5MTVfV1JJVEVfRlcoUExBTkVfQVVYX0RJU1QocGlwZSwgcGxh
bmVfaWQpLAotCQkgICAgICAocGxhbmVfc3RhdGUtPmNvbG9yX3BsYW5lWzFdLm9mZnNldCAtIHN1
cmZfYWRkcikgfCBhdXhfc3RyaWRlKTsKKworCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgMTIp
CisJCWF1eF9kaXN0IHw9IGF1eF9zdHJpZGU7CisJSTkxNV9XUklURV9GVyhQTEFORV9BVVhfRElT
VChwaXBlLCBwbGFuZV9pZCksIGF1eF9kaXN0KTsKIAogCWlmIChpY2xfaXNfaGRyX3BsYW5lKGRl
dl9wcml2LCBwbGFuZV9pZCkpIHsKIAkJdTMyIGN1c19jdGwgPSAwOwpAQCAtMTc0NSw3ICsxNzQ4
LDggQEAgc3RhdGljIGludCBza2xfcGxhbmVfY2hlY2tfZmIoY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJICAgIChmYi0+bW9kaWZpZXIgPT0gSTkxNV9GT1JNQVRf
TU9EX1lfVElMRUQgfHwKIAkgICAgIGZiLT5tb2RpZmllciA9PSBJOTE1X0ZPUk1BVF9NT0RfWWZf
VElMRUQgfHwKIAkgICAgIGZiLT5tb2RpZmllciA9PSBJOTE1X0ZPUk1BVF9NT0RfWV9USUxFRF9D
Q1MgfHwKLQkgICAgIGZiLT5tb2RpZmllciA9PSBJOTE1X0ZPUk1BVF9NT0RfWWZfVElMRURfQ0NT
KSkgeworCSAgICAgZmItPm1vZGlmaWVyID09IEk5MTVfRk9STUFUX01PRF9ZZl9USUxFRF9DQ1Mg
fHwKKwkgICAgIGZiLT5tb2RpZmllciA9PSBJOTE1X0ZPUk1BVF9NT0RfWV9USUxFRF9HRU4xMl9S
Q19DQ1MpKSB7CiAJCURSTV9ERUJVR19LTVMoIlkvWWYgdGlsaW5nIG5vdCBzdXBwb3J0ZWQgaW4g
SUYtSUQgbW9kZVxuIik7CiAJCXJldHVybiAtRUlOVkFMOwogCX0KQEAgLTIxNTcsNyArMjE2MSw4
IEBAIHN0YXRpYyBjb25zdCB1NjQgc2tsX3BsYW5lX2Zvcm1hdF9tb2RpZmllcnNfY2NzW10gPSB7
CiAJRFJNX0ZPUk1BVF9NT0RfSU5WQUxJRAogfTsKIAotc3RhdGljIGNvbnN0IHU2NCBnZW4xMl9w
bGFuZV9mb3JtYXRfbW9kaWZpZXJzX25vY2NzW10gPSB7CitzdGF0aWMgY29uc3QgdTY0IGdlbjEy
X3BsYW5lX2Zvcm1hdF9tb2RpZmllcnNfY2NzW10gPSB7CisJSTkxNV9GT1JNQVRfTU9EX1lfVElM
RURfR0VOMTJfUkNfQ0NTLAogCUk5MTVfRk9STUFUX01PRF9ZX1RJTEVELAogCUk5MTVfRk9STUFU
X01PRF9YX1RJTEVELAogCURSTV9GT1JNQVRfTU9EX0xJTkVBUiwKQEAgLTIzMTksNiArMjMyNCw3
IEBAIHN0YXRpYyBib29sIGdlbjEyX3BsYW5lX2Zvcm1hdF9tb2Rfc3VwcG9ydGVkKHN0cnVjdCBk
cm1fcGxhbmUgKl9wbGFuZSwKIAljYXNlIERSTV9GT1JNQVRfTU9EX0xJTkVBUjoKIAljYXNlIEk5
MTVfRk9STUFUX01PRF9YX1RJTEVEOgogCWNhc2UgSTkxNV9GT1JNQVRfTU9EX1lfVElMRUQ6CisJ
Y2FzZSBJOTE1X0ZPUk1BVF9NT0RfWV9USUxFRF9HRU4xMl9SQ19DQ1M6CiAJCWJyZWFrOwogCWRl
ZmF1bHQ6CiAJCXJldHVybiBmYWxzZTsKQEAgLTIzMjksNiArMjMzNSw5IEBAIHN0YXRpYyBib29s
IGdlbjEyX3BsYW5lX2Zvcm1hdF9tb2Rfc3VwcG9ydGVkKHN0cnVjdCBkcm1fcGxhbmUgKl9wbGFu
ZSwKIAljYXNlIERSTV9GT1JNQVRfWEJHUjg4ODg6CiAJY2FzZSBEUk1fRk9STUFUX0FSR0I4ODg4
OgogCWNhc2UgRFJNX0ZPUk1BVF9BQkdSODg4ODoKKwkJaWYgKGlzX2Njc19tb2RpZmllcihtb2Rp
ZmllcikpCisJCQlyZXR1cm4gdHJ1ZTsKKwkJLyogZmFsbCB0aHJvdWdoICovCiAJY2FzZSBEUk1f
Rk9STUFUX1JHQjU2NToKIAljYXNlIERSTV9GT1JNQVRfWFJHQjIxMDEwMTA6CiAJY2FzZSBEUk1f
Rk9STUFUX1hCR1IyMTAxMDEwOgpAQCAtMjUzNywxMyArMjU0NiwxMSBAQCBza2xfdW5pdmVyc2Fs
X3BsYW5lX2NyZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJCWZvcm1h
dHMgPSBza2xfZ2V0X3BsYW5lX2Zvcm1hdHMoZGV2X3ByaXYsIHBpcGUsCiAJCQkJCQlwbGFuZV9p
ZCwgJm51bV9mb3JtYXRzKTsKIAorCXBsYW5lLT5oYXNfY2NzID0gc2tsX3BsYW5lX2hhc19jY3Mo
ZGV2X3ByaXYsIHBpcGUsIHBsYW5lX2lkKTsKIAlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAx
MikgewotCQkvKiBUT0RPOiBJbXBsZW1lbnQgc3VwcG9ydCBmb3IgZ2VuLTEyIENDUyBtb2RpZmll
cnMgKi8KLQkJcGxhbmUtPmhhc19jY3MgPSBmYWxzZTsKLQkJbW9kaWZpZXJzID0gZ2VuMTJfcGxh
bmVfZm9ybWF0X21vZGlmaWVyc19ub2NjczsKKwkJbW9kaWZpZXJzID0gZ2VuMTJfcGxhbmVfZm9y
bWF0X21vZGlmaWVyc19jY3M7CiAJCXBsYW5lX2Z1bmNzID0gJmdlbjEyX3BsYW5lX2Z1bmNzOwog
CX0gZWxzZSB7Ci0JCXBsYW5lLT5oYXNfY2NzID0gc2tsX3BsYW5lX2hhc19jY3MoZGV2X3ByaXYs
IHBpcGUsIHBsYW5lX2lkKTsKIAkJaWYgKHBsYW5lLT5oYXNfY2NzKQogCQkJbW9kaWZpZXJzID0g
c2tsX3BsYW5lX2Zvcm1hdF9tb2RpZmllcnNfY2NzOwogCQllbHNlCi0tIAoyLjE3LjEKCl9fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWls
aW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZy
ZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 804062DFB0A
	for <lists+intel-gfx@lfdr.de>; Mon, 21 Dec 2020 11:28:36 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1CEA76E486;
	Mon, 21 Dec 2020 10:28:34 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga05.intel.com (mga05.intel.com [192.55.52.43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 047B46E486
 for <intel-gfx@lists.freedesktop.org>; Mon, 21 Dec 2020 10:28:32 +0000 (UTC)
IronPort-SDR: hCkHaFMFUQANGfEBXSRn202PiMLhEwpXj2tMYsIOD7yP2tjMECgxbOGdKGdh4e2NNLP0aajpL/
 dhpsMAV2H/wQ==
X-IronPort-AV: E=McAfee;i="6000,8403,9841"; a="260436212"
X-IronPort-AV: E=Sophos;i="5.78,436,1599548400"; d="scan'208";a="260436212"
Received: from fmsmga006.fm.intel.com ([10.253.24.20])
 by fmsmga105.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 21 Dec 2020 02:28:32 -0800
IronPort-SDR: xeNH8mUF+V2OsV8Ezyvz4dfjGwsCBKIQAS5xOFZWp5l+mkOIMJ7RK3VDfnfVC+laeJYT0FDPRv
 yQoOO2Wqeixw==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.78,436,1599548400"; d="scan'208";a="560643188"
Received: from irsmsx604.ger.corp.intel.com ([163.33.146.137])
 by fmsmga006.fm.intel.com with ESMTP; 21 Dec 2020 02:28:31 -0800
Received: from irsmsx605.ger.corp.intel.com (163.33.146.138) by
 IRSMSX604.ger.corp.intel.com (163.33.146.137) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id
 15.1.1713.5; Mon, 21 Dec 2020 10:28:30 +0000
Received: from irsmsx605.ger.corp.intel.com ([163.33.146.138]) by
 IRSMSX605.ger.corp.intel.com ([163.33.146.138]) with mapi id 15.01.1713.004;
 Mon, 21 Dec 2020 10:28:30 +0000
From: "Mun, Gwan-gyeong" <gwan-gyeong.mun@intel.com>
To: "Gupta, Anshuman" <anshuman.gupta@intel.com>
Thread-Topic: [PATCH v7 1/2] drm/i915/display: Support PSR Multiple Transcoders
Thread-Index: AQHW07Db5iJlLzrnFU6dJ/HxSWk+UqoBYJKA
Date: Mon, 21 Dec 2020 10:28:30 +0000
Message-ID: <fcc2461cb31ab4357c20ec1111333acfd2754508.camel@intel.com>
References: <20201216124743.431148-1-gwan-gyeong.mun@intel.com>
 <20201216132600.GL9309@intel.com>
In-Reply-To: <20201216132600.GL9309@intel.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [163.33.253.164]
Content-ID: <45A7536124EB934B961BD24DF9692982@intel.com>
MIME-Version: 1.0
Subject: Re: [Intel-gfx] [PATCH v7 1/2] drm/i915/display: Support PSR
 Multiple Transcoders
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: "Nikula, Jani" <jani.nikula@intel.com>,
 "intel-gfx@lists.freedesktop.org" <intel-gfx@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T24gV2VkLCAyMDIwLTEyLTE2IGF0IDE4OjU2ICswNTMwLCBBbnNodW1hbiBHdXB0YSB3cm90ZToN
Cj4gT24gMjAyMC0xMi0xNiBhdCAxNDo0Nzo0MiArMDIwMCwgR3dhbi1neWVvbmcgTXVuIHdyb3Rl
Og0KPiA+IEl0IGlzIGEgcHJlbGltaW5hcnkgd29yayBmb3Igc3VwcG9ydGluZyBtdWx0aXBsZSBF
RFAgUFNSIGFuZA0KPiA+IERQIFBhbmVsUmVwbGF5LiBBbmQgaXQgcmVmYWN0b3JzIHNpbmdsZXRv
biBQU1IgdG8gTXVsdGkgVHJhbnNjb2Rlcg0KPiA+IHN1cHBvcnRhYmxlIFBTUi4NCj4gPiBBbmQg
dGhpcyBtb3ZlcyBhbmQgcmVuYW1lcyB0aGUgaTkxNV9wc3Igc3RydWN0dXJlIG9mDQo+ID4gZHJt
X2k5MTVfcHJpdmF0ZSdzIHRvDQo+ID4gaW50ZWxfZHAncyBpbnRlbF9wc3Igc3RydWN0dXJlLg0K
PiA+IEl0IGFsc28gY2F1c2VzIGNoYW5nZXMgaW4gUFNSIGludGVycnVwdCBoYW5kbGluZyByb3V0
aW5lIGZvcg0KPiA+IHN1cHBvcnRpbmcNCj4gPiBtdWx0aXBsZSB0cmFuc2NvZGVycy4gQnV0IGl0
IGRvZXMgbm90IGNoYW5nZSB0aGUgc2NlbmFyaW8gYW5kDQo+ID4gdGltaW5nIG9mDQo+ID4gZW5h
YmxpbmcgYW5kIGRpc2FibGluZyBQU1IuIEFuZCBpdCBub3Qgc3VwcG9ydCBtdWx0aXBsZSBwaXBl
cyB3aXRoDQo+ID4gYSBzaW5nbGUgdHJhbnNjb2RlciBQU1IgY2FzZSB5ZXQuDQo+ID4gDQo+ID4g
djI6IEZpeCBpbmRlbnRhdGlvbiBhbmQgYWRkIGNvbW1lbnRzDQo+ID4gdjM6IFJlbW92ZSBCbGFu
ayBsaW5lDQo+ID4gdjQ6IFJlYmFzZWQNCj4gPiB2NTogUmViYXNlZCBhbmQgQWRkcmVzc2VkIEFu
c2h1bWFuJ3MgcmV2aWV3IGNvbW1lbnQuDQo+ID4gICAgIC0gTW92ZSBjYWxsaW5nIG9mIGludGVs
X3Bzcl9pbml0KCkgdG8gaW50ZWxfZHBfaW5pdF9jb25uZWN0b3IoKQ0KPiA+IHY2OiBBZGRyZXNz
IEFuc2h1bWFuJ3MgcmV2aWV3IGNvbW1lbnRzDQo+ID4gICAgLSBSZW1vdmUgd3JvbmcgY29tbWVu
dHMgYW5kIGFkZCBjb21tZW50cyBmb3IgYSBsaW1pdCBvZg0KPiA+IHN1cHBvcnRpbmcgb2YNCj4g
PiAgICAgIGEgc2luZ2xlIHBpcGUgUFNSDQo+IFlvdSBtaXNzZWQgc29tZSBjb21tZW50IHRvIGFk
ZHJlc3MgcHJvdmlkZWQgb24gdjUuDQo+IElzIGRlYnVnZnMgcHJpbnQgaW4gZHJyc19zdGF0dXNf
cGVyX2NydGMgaXMgbm90IHJlcXVpcmVkIGFueW1vcmUgPw0KQ3VycmVudCBpbXBsZW1lbnRhdGlv
biBkb2VzIG5vdCBlbmFibGUgZHJycyB3aGVuIHRoZSBwaXBlIGhhcyBwc3IgYnkNCmludGVsX2Rw
X2RycnNfY29tcHV0ZV9jb25maWcoKS4NCnRoZXJlZm9yZSB0aGUgbG9nIG1lc3NhZ2UgaXMgbm90
IG5lZWRlZC4NCj4gQWxzbyBwbGVhc2UgdXNlIGRybV97ZGJnLHdhcm59IGF0IGV2ZXJ5IHBsYWNl
IGluIHRoaXMgcGF0Y2guDQpJJ2xsIGZsb2F0IGEgbmV3IHBhdGNoIHdoaWNoIGFkZHJlc3NlcyBp
dC4NCj4gPiB2NzogVXBkYXRlIGludGVsX3Bzcl9jb21wdXRlX2NvbmZpZygpIGZvciBzdXBwb3J0
aW5nIG11bHRpcGxlDQo+ID4gdHJhbnNjb2Rlcg0KPiA+ICAgICBQU1Igb24gQkRXKw0KPiBDb3Vs
ZCB5b3UgcGxlYXNlIHNlbmQgdGhpcyBpbiBhIHNlcGFyYXRlIHBhdGNoLCByZW1vdmUgdGhlIFBP
UlRfQSANCj4gcmVzdHJpY3Rpb24gc28gdGhhdCB3ZSBjYW4gc3VwcG9ydCBtdWx0aXBsZSBwc3Ig
aW5zdGFuY2VzLg0KPiANCklNSE8sIGluIG9yZGVyIHRvIGVuYWJsZSBQU1JzIG9uIG11bHRpcGxl
IHRyYW5zY29kZXJzLCB3ZSBoYXZlIHRvDQppbmNsdWRlIHRoaXMgZml4IGluIHRoaXMgcGF0Y2gu
DQo+IFRoYW5rcywNCj4gQW5zaHVtYW4gR3VwdGEuIA0KPiA+IFNpZ25lZC1vZmYtYnk6IEd3YW4t
Z3llb25nIE11biA8Z3dhbi1neWVvbmcubXVuQGludGVsLmNvbT4NCj4gPiBDYzogSm9zw6kgUm9i
ZXJ0byBkZSBTb3V6YSA8am9zZS5zb3V6YUBpbnRlbC5jb20+DQo+ID4gQ2M6IEp1aGEtUGVra2Eg
SGVpa2tpbGEgPGp1aGFwZWtrYS5oZWlra2lsYUBnbWFpbC5jb20+DQo+ID4gQ2M6IEFuc2h1bWFu
IEd1cHRhIDxhbnNodW1hbi5ndXB0YUBpbnRlbC5jb20+DQo+ID4gLS0tDQo+ID4gIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpLmMgICAgICB8ICAgMyArDQo+ID4gIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jICB8ICAgNCAtDQo+ID4gIC4u
Li9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfZGVidWdmcy5jICB8IDExMSArKy0tDQo+
ID4gIC4uLi9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaCAgICB8ICAzOCAr
Kw0KPiA+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwLmMgICAgICAgfCAg
MjMgKy0NCj4gPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9wc3IuYyAgICAg
IHwgNTg4ICsrKysrKysrKy0tLS0tDQo+ID4gLS0tLQ0KPiA+ICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX3Bzci5oICAgICAgfCAgMTQgKy0NCj4gPiAgZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9zcHJpdGUuYyAgIHwgICA2ICstDQo+ID4gIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZHJ2LmggICAgICAgICAgICAgICB8ICAzOCAtLQ0KPiA+ICBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2lycS5jICAgICAgICAgICAgICAgfCAgNDkgKy0NCj4gPiAgMTAg
ZmlsZXMgY2hhbmdlZCwgNDkwIGluc2VydGlvbnMoKyksIDM4NCBkZWxldGlvbnMoLSkNCj4gPiAN
Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGku
Yw0KPiA+IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGkuYw0KPiA+IGlu
ZGV4IDY4NjMyMzZkZjFkMC4uNGI4N2Y3MmNiOWMwIDEwMDY0NA0KPiA+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpLmMNCj4gPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2RkaS5jDQo+ID4gQEAgLTQzMjAsNyArNDMyMCwxMCBAQCBz
dGF0aWMgdm9pZCBpbnRlbF9kZGlfdXBkYXRlX3BpcGVfZHAoc3RydWN0DQo+ID4gaW50ZWxfYXRv
bWljX3N0YXRlICpzdGF0ZSwNCj4gPiAgDQo+ID4gIAlpbnRlbF9kZGlfc2V0X2RwX21zYShjcnRj
X3N0YXRlLCBjb25uX3N0YXRlKTsNCj4gPiAgDQo+ID4gKwkvL1RPRE86IG1vdmUgUFNSIHJlbGF0
ZWQgZnVuY3Rpb25zIGludG8gaW50ZWxfcHNyX3VwZGF0ZSgpDQo+ID4gKwlpbnRlbF9wc3IyX3By
b2dyYW1fdHJhbnNfbWFuX3Rya19jdGwoaW50ZWxfZHAsIGNydGNfc3RhdGUpOw0KPiA+ICAJaW50
ZWxfcHNyX3VwZGF0ZShpbnRlbF9kcCwgY3J0Y19zdGF0ZSwgY29ubl9zdGF0ZSk7DQo+ID4gKw0K
PiA+ICAJaW50ZWxfZHBfc2V0X2luZm9mcmFtZXMoZW5jb2RlciwgdHJ1ZSwgY3J0Y19zdGF0ZSwg
Y29ubl9zdGF0ZSk7DQo+ID4gIAlpbnRlbF9lZHBfZHJyc191cGRhdGUoaW50ZWxfZHAsIGNydGNf
c3RhdGUpOw0KPiA+ICANCj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kaXNwbGF5LmMNCj4gPiBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfZGlzcGxheS5jDQo+ID4gaW5kZXggNzg0NTJkZTVlMTJmLi5hNzUzNjQ3YjBiY2IgMTAw
NjQ0DQo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5
LmMNCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXku
Yw0KPiA+IEBAIC0xNTg2OSw4ICsxNTg2OSw2IEBAIHN0YXRpYyB2b2lkIGNvbW1pdF9waXBlX2Nv
bmZpZyhzdHJ1Y3QNCj4gPiBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLA0KPiA+ICANCj4gPiAg
CQlpZiAobmV3X2NydGNfc3RhdGUtPnVwZGF0ZV9waXBlKQ0KPiA+ICAJCQlpbnRlbF9waXBlX2Zh
c3RzZXQob2xkX2NydGNfc3RhdGUsDQo+ID4gbmV3X2NydGNfc3RhdGUpOw0KPiA+IC0NCj4gPiAt
CQlpbnRlbF9wc3IyX3Byb2dyYW1fdHJhbnNfbWFuX3Rya19jdGwobmV3X2NydGNfc3RhdGUpOw0K
PiA+ICAJfQ0KPiA+ICANCj4gPiAgCWlmIChkZXZfcHJpdi0+ZGlzcGxheS5hdG9taWNfdXBkYXRl
X3dhdGVybWFya3MpDQo+ID4gQEAgLTE3ODI5LDggKzE3ODI3LDYgQEAgc3RhdGljIHZvaWQgaW50
ZWxfc2V0dXBfb3V0cHV0cyhzdHJ1Y3QNCj4gPiBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikN
Cj4gPiAgCQlpbnRlbF9kdm9faW5pdChkZXZfcHJpdik7DQo+ID4gIAl9DQo+ID4gIA0KPiA+IC0J
aW50ZWxfcHNyX2luaXQoZGV2X3ByaXYpOw0KPiA+IC0NCj4gPiAgCWZvcl9lYWNoX2ludGVsX2Vu
Y29kZXIoJmRldl9wcml2LT5kcm0sIGVuY29kZXIpIHsNCj4gPiAgCQllbmNvZGVyLT5iYXNlLnBv
c3NpYmxlX2NydGNzID0NCj4gPiAgCQkJaW50ZWxfZW5jb2Rlcl9wb3NzaWJsZV9jcnRjcyhlbmNv
ZGVyKTsNCj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9kaXNwbGF5X2RlYnVnZnMuYw0KPiA+IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kaXNwbGF5X2RlYnVnZnMuYw0KPiA+IGluZGV4IGNkN2U1NTE5ZWU3ZC4uMDQxMDUzMTY3
ZDdmIDEwMDY0NA0KPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZGlzcGxheV9kZWJ1Z2ZzLmMNCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2Rpc3BsYXlfZGVidWdmcy5jDQo+ID4gQEAgLTI0OSwxOCArMjQ5LDE3IEBAIHN0YXRp
YyBpbnQgaTkxNV9wc3Jfc2lua19zdGF0dXNfc2hvdyhzdHJ1Y3QNCj4gPiBzZXFfZmlsZSAqbSwg
dm9pZCAqZGF0YSkNCj4gPiAgCQkic2luayBpbnRlcm5hbCBlcnJvciIsDQo+ID4gIAl9Ow0KPiA+
ICAJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciA9IG0tPnByaXZhdGU7DQo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2
KTsNCj4gPiAgCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPQ0KPiA+ICAJCWludGVsX2F0dGFj
aGVkX2RwKHRvX2ludGVsX2Nvbm5lY3Rvcihjb25uZWN0b3IpKTsNCj4gPiAgCWludCByZXQ7DQo+
ID4gIA0KPiA+IC0JaWYgKCFDQU5fUFNSKGRldl9wcml2KSkgew0KPiA+IC0JCXNlcV9wdXRzKG0s
ICJQU1IgVW5zdXBwb3J0ZWRcbiIpOw0KPiA+ICsJaWYgKGNvbm5lY3Rvci0+c3RhdHVzICE9IGNv
bm5lY3Rvcl9zdGF0dXNfY29ubmVjdGVkKQ0KPiA+ICAJCXJldHVybiAtRU5PREVWOw0KPiA+IC0J
fQ0KPiA+ICANCj4gPiAtCWlmIChjb25uZWN0b3ItPnN0YXR1cyAhPSBjb25uZWN0b3Jfc3RhdHVz
X2Nvbm5lY3RlZCkNCj4gPiArCWlmICghQ0FOX1BTUihpbnRlbF9kcCkpIHsNCj4gPiArCQlzZXFf
cHV0cyhtLCAiUFNSIFVuc3VwcG9ydGVkXG4iKTsNCj4gPiAgCQlyZXR1cm4gLUVOT0RFVjsNCj4g
PiArCX0NCj4gPiAgDQo+ID4gIAlyZXQgPSBkcm1fZHBfZHBjZF9yZWFkYigmaW50ZWxfZHAtPmF1
eCwgRFBfUFNSX1NUQVRVUywgJnZhbCk7DQo+ID4gIA0KPiA+IEBAIC0yODAsMTIgKzI3OSwxMyBA
QCBzdGF0aWMgaW50IGk5MTVfcHNyX3Npbmtfc3RhdHVzX3Nob3coc3RydWN0DQo+ID4gc2VxX2Zp
bGUgKm0sIHZvaWQgKmRhdGEpDQo+ID4gIERFRklORV9TSE9XX0FUVFJJQlVURShpOTE1X3Bzcl9z
aW5rX3N0YXR1cyk7DQo+ID4gIA0KPiA+ICBzdGF0aWMgdm9pZA0KPiA+IC1wc3Jfc291cmNlX3N0
YXR1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHN0cnVjdA0KPiA+IHNlcV9m
aWxlICptKQ0KPiA+ICtwc3Jfc291cmNlX3N0YXR1cyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2Rw
LCBzdHJ1Y3Qgc2VxX2ZpbGUgKm0pDQo+ID4gIHsNCj4gPiAgCXUzMiB2YWwsIHN0YXR1c192YWw7
DQo+ID4gIAljb25zdCBjaGFyICpzdGF0dXMgPSAidW5rbm93biI7DQo+ID4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsNCj4gPiAgDQo+
ID4gLQlpZiAoZGV2X3ByaXYtPnBzci5wc3IyX2VuYWJsZWQpIHsNCj4gPiArCWlmIChpbnRlbF9k
cC0+cHNyLnBzcjJfZW5hYmxlZCkgew0KPiA+ICAJCXN0YXRpYyBjb25zdCBjaGFyICogY29uc3Qg
bGl2ZV9zdGF0dXNbXSA9IHsNCj4gPiAgCQkJIklETEUiLA0KPiA+ICAJCQkiQ0FQVFVSRSIsDQo+
ID4gQEAgLTMwMCw3ICszMDAsNyBAQCBwc3Jfc291cmNlX3N0YXR1cyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZQ0KPiA+ICpkZXZfcHJpdiwgc3RydWN0IHNlcV9maWxlICptKQ0KPiA+ICAJCQkiVEdf
T04iDQo+ID4gIAkJfTsNCj4gPiAgCQl2YWwgPSBpbnRlbF9kZV9yZWFkKGRldl9wcml2LA0KPiA+
IC0JCQkJICAgIEVEUF9QU1IyX1NUQVRVUyhkZXZfcHJpdi0NCj4gPiA+cHNyLnRyYW5zY29kZXIp
KTsNCj4gPiArCQkJCSAgICBFRFBfUFNSMl9TVEFUVVMoaW50ZWxfZHAtDQo+ID4gPnBzci50cmFu
c2NvZGVyKSk7DQo+ID4gIAkJc3RhdHVzX3ZhbCA9ICh2YWwgJiBFRFBfUFNSMl9TVEFUVVNfU1RB
VEVfTUFTSykgPj4NCj4gPiAgCQkJICAgICAgRURQX1BTUjJfU1RBVFVTX1NUQVRFX1NISUZUOw0K
PiA+ICAJCWlmIChzdGF0dXNfdmFsIDwgQVJSQVlfU0laRShsaXZlX3N0YXR1cykpDQo+ID4gQEAg
LTMxNyw3ICszMTcsNyBAQCBwc3Jfc291cmNlX3N0YXR1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZQ0KPiA+ICpkZXZfcHJpdiwgc3RydWN0IHNlcV9maWxlICptKQ0KPiA+ICAJCQkiU1JERU5UX09O
IiwNCj4gPiAgCQl9Ow0KPiA+ICAJCXZhbCA9IGludGVsX2RlX3JlYWQoZGV2X3ByaXYsDQo+ID4g
LQkJCQkgICAgRURQX1BTUl9TVEFUVVMoZGV2X3ByaXYtDQo+ID4gPnBzci50cmFuc2NvZGVyKSk7
DQo+ID4gKwkJCQkgICAgRURQX1BTUl9TVEFUVVMoaW50ZWxfZHAtDQo+ID4gPnBzci50cmFuc2Nv
ZGVyKSk7DQo+ID4gIAkJc3RhdHVzX3ZhbCA9ICh2YWwgJiBFRFBfUFNSX1NUQVRVU19TVEFURV9N
QVNLKSA+Pg0KPiA+ICAJCQkgICAgICBFRFBfUFNSX1NUQVRVU19TVEFURV9TSElGVDsNCj4gPiAg
CQlpZiAoc3RhdHVzX3ZhbCA8IEFSUkFZX1NJWkUobGl2ZV9zdGF0dXMpKQ0KPiA+IEBAIC0zMjcs
MjEgKzMyNywxOCBAQCBwc3Jfc291cmNlX3N0YXR1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZQ0K
PiA+ICpkZXZfcHJpdiwgc3RydWN0IHNlcV9maWxlICptKQ0KPiA+ICAJc2VxX3ByaW50ZihtLCAi
U291cmNlIFBTUiBzdGF0dXM6ICVzIFsweCUwOHhdXG4iLCBzdGF0dXMsIHZhbCk7DQo+ID4gIH0N
Cj4gPiAgDQo+ID4gLXN0YXRpYyBpbnQgaTkxNV9lZHBfcHNyX3N0YXR1cyhzdHJ1Y3Qgc2VxX2Zp
bGUgKm0sIHZvaWQgKmRhdGEpDQo+ID4gK3N0YXRpYyBpbnQgaW50ZWxfcHNyX3N0YXR1cyhzdHJ1
Y3Qgc2VxX2ZpbGUgKm0sIHN0cnVjdCBpbnRlbF9kcA0KPiA+ICppbnRlbF9kcCkNCj4gPiAgew0K
PiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0t
PnByaXZhdGUpOw0KPiA+IC0Jc3RydWN0IGk5MTVfcHNyICpwc3IgPSAmZGV2X3ByaXYtPnBzcjsN
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50
ZWxfZHApOw0KPiA+ICsJc3RydWN0IGludGVsX3BzciAqcHNyID0gJmludGVsX2RwLT5wc3I7DQo+
ID4gIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsNCj4gPiAgCWNvbnN0IGNoYXIgKnN0YXR1czsN
Cj4gPiAgCWJvb2wgZW5hYmxlZDsNCj4gPiAgCXUzMiB2YWw7DQo+ID4gIA0KPiA+IC0JaWYgKCFI
QVNfUFNSKGRldl9wcml2KSkNCj4gPiAtCQlyZXR1cm4gLUVOT0RFVjsNCj4gPiAtDQo+ID4gIAlz
ZXFfcHJpbnRmKG0sICJTaW5rIHN1cHBvcnQ6ICVzIiwgeWVzbm8ocHNyLT5zaW5rX3N1cHBvcnQp
KTsNCj4gPiAtCWlmIChwc3ItPmRwKQ0KPiA+IC0JCXNlcV9wcmludGYobSwgIiBbMHglMDJ4XSIs
IHBzci0+ZHAtPnBzcl9kcGNkWzBdKTsNCj4gPiArCWlmIChwc3ItPnNpbmtfc3VwcG9ydCkNCj4g
PiArCQlzZXFfcHJpbnRmKG0sICIgWzB4JTAyeF0iLCBpbnRlbF9kcC0+cHNyX2RwY2RbMF0pOw0K
PiA+ICAJc2VxX3B1dHMobSwgIlxuIik7DQo+ID4gIA0KPiA+ICAJaWYgKCFwc3ItPnNpbmtfc3Vw
cG9ydCkNCj4gPiBAQCAtMzY1LDE2ICszNjIsMTYgQEAgc3RhdGljIGludCBpOTE1X2VkcF9wc3Jf
c3RhdHVzKHN0cnVjdA0KPiA+IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQ0KPiA+ICANCj4gPiAg
CWlmIChwc3ItPnBzcjJfZW5hYmxlZCkgew0KPiA+ICAJCXZhbCA9IGludGVsX2RlX3JlYWQoZGV2
X3ByaXYsDQo+ID4gLQkJCQkgICAgRURQX1BTUjJfQ1RMKGRldl9wcml2LQ0KPiA+ID5wc3IudHJh
bnNjb2RlcikpOw0KPiA+ICsJCQkJICAgIEVEUF9QU1IyX0NUTChpbnRlbF9kcC0NCj4gPiA+cHNy
LnRyYW5zY29kZXIpKTsNCj4gPiAgCQllbmFibGVkID0gdmFsICYgRURQX1BTUjJfRU5BQkxFOw0K
PiA+ICAJfSBlbHNlIHsNCj4gPiAgCQl2YWwgPSBpbnRlbF9kZV9yZWFkKGRldl9wcml2LA0KPiA+
IC0JCQkJICAgIEVEUF9QU1JfQ1RMKGRldl9wcml2LQ0KPiA+ID5wc3IudHJhbnNjb2RlcikpOw0K
PiA+ICsJCQkJICAgIEVEUF9QU1JfQ1RMKGludGVsX2RwLQ0KPiA+ID5wc3IudHJhbnNjb2Rlcikp
Ow0KPiA+ICAJCWVuYWJsZWQgPSB2YWwgJiBFRFBfUFNSX0VOQUJMRTsNCj4gPiAgCX0NCj4gPiAg
CXNlcV9wcmludGYobSwgIlNvdXJjZSBQU1IgY3RsOiAlcyBbMHglMDh4XVxuIiwNCj4gPiAgCQkg
ICBlbmFibGVkZGlzYWJsZWQoZW5hYmxlZCksIHZhbCk7DQo+ID4gLQlwc3Jfc291cmNlX3N0YXR1
cyhkZXZfcHJpdiwgbSk7DQo+ID4gKwlwc3Jfc291cmNlX3N0YXR1cyhpbnRlbF9kcCwgbSk7DQo+
ID4gIAlzZXFfcHJpbnRmKG0sICJCdXN5IGZyb250YnVmZmVyIGJpdHM6IDB4JTA4eFxuIiwNCj4g
PiAgCQkgICBwc3ItPmJ1c3lfZnJvbnRidWZmZXJfYml0cyk7DQo+ID4gIA0KPiA+IEBAIC0zODMs
NyArMzgwLDcgQEAgc3RhdGljIGludCBpOTE1X2VkcF9wc3Jfc3RhdHVzKHN0cnVjdCBzZXFfZmls
ZQ0KPiA+ICptLCB2b2lkICpkYXRhKQ0KPiA+ICAJICovDQo+ID4gIAlpZiAoSVNfSEFTV0VMTChk
ZXZfcHJpdikgfHwgSVNfQlJPQURXRUxMKGRldl9wcml2KSkgew0KPiA+ICAJCXZhbCA9IGludGVs
X2RlX3JlYWQoZGV2X3ByaXYsDQo+ID4gLQkJCQkgICAgRURQX1BTUl9QRVJGX0NOVChkZXZfcHJp
di0NCj4gPiA+cHNyLnRyYW5zY29kZXIpKTsNCj4gPiArCQkJCSAgICBFRFBfUFNSX1BFUkZfQ05U
KGludGVsX2RwLQ0KPiA+ID5wc3IudHJhbnNjb2RlcikpOw0KPiA+ICAJCXZhbCAmPSBFRFBfUFNS
X1BFUkZfQ05UX01BU0s7DQo+ID4gIAkJc2VxX3ByaW50ZihtLCAiUGVyZm9ybWFuY2UgY291bnRl
cjogJXVcbiIsIHZhbCk7DQo+ID4gIAl9DQo+ID4gQEAgLTQwNCw3ICs0MDEsNyBAQCBzdGF0aWMg
aW50IGk5MTVfZWRwX3Bzcl9zdGF0dXMoc3RydWN0IHNlcV9maWxlDQo+ID4gKm0sIHZvaWQgKmRh
dGEpDQo+ID4gIAkJICovDQo+ID4gIAkJZm9yIChmcmFtZSA9IDA7IGZyYW1lIDwgUFNSMl9TVV9T
VEFUVVNfRlJBTUVTOyBmcmFtZSArPQ0KPiA+IDMpIHsNCj4gPiAgCQkJdmFsID0gaW50ZWxfZGVf
cmVhZChkZXZfcHJpdiwNCj4gPiAtCQkJCQkgICAgUFNSMl9TVV9TVEFUVVMoZGV2X3ByaXYtDQo+
ID4gPnBzci50cmFuc2NvZGVyLCBmcmFtZSkpOw0KPiA+ICsJCQkJCSAgICBQU1IyX1NVX1NUQVRV
UyhpbnRlbF9kcC0NCj4gPiA+cHNyLnRyYW5zY29kZXIsIGZyYW1lKSk7DQo+ID4gIAkJCXN1X2Zy
YW1lc192YWxbZnJhbWUgLyAzXSA9IHZhbDsNCj4gPiAgCQl9DQo+ID4gIA0KPiA+IEBAIC00MzAs
MjMgKzQyNyw1NyBAQCBzdGF0aWMgaW50IGk5MTVfZWRwX3Bzcl9zdGF0dXMoc3RydWN0DQo+ID4g
c2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpDQo+ID4gIAlyZXR1cm4gMDsNCj4gPiAgfQ0KPiA+ICAN
Cj4gPiArc3RhdGljIGludCBpOTE1X2VkcF9wc3Jfc3RhdHVzKHN0cnVjdCBzZXFfZmlsZSAqbSwg
dm9pZCAqZGF0YSkNCj4gPiArew0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOw0KPiA+ICsJc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXI7DQo+ID4gKwlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gTlVMTDsNCj4g
PiArDQo+ID4gKwlpZiAoIUhBU19QU1IoZGV2X3ByaXYpKQ0KPiA+ICsJCXJldHVybiAtRU5PREVW
Ow0KPiA+ICsNCj4gPiArCS8qIEZpbmQgdGhlIGZpcnN0IEVEUCAqLw0KPiA+ICsJZm9yX2VhY2hf
aW50ZWxfZHAoJmRldl9wcml2LT5kcm0sIGVuY29kZXIpIHsNCj4gPiArCQlpZiAoZW5jb2Rlci0+
dHlwZSA9PSBJTlRFTF9PVVRQVVRfRURQKSB7DQo+ID4gKwkJCWludGVsX2RwID0gZW5jX3RvX2lu
dGVsX2RwKGVuY29kZXIpOw0KPiA+ICsJCQlicmVhazsNCj4gPiArCQl9DQo+ID4gKwl9DQo+ID4g
Kw0KPiA+ICsJaWYgKCFpbnRlbF9kcCkNCj4gPiArCQlyZXR1cm4gLUVOT0RFVjsNCj4gPiArDQo+
ID4gKwlyZXR1cm4gaW50ZWxfcHNyX3N0YXR1cyhtLCBpbnRlbF9kcCk7DQo+ID4gK30NCj4gPiAr
DQo+ID4gIHN0YXRpYyBpbnQNCj4gPiAgaTkxNV9lZHBfcHNyX2RlYnVnX3NldCh2b2lkICpkYXRh
LCB1NjQgdmFsKQ0KPiA+ICB7DQo+ID4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSBkYXRhOw0KPiA+ICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7DQo+ID4gLQlpbnQgcmV0
Ow0KPiA+ICsJaW50IHJldCA9IC1FTk9ERVY7DQo+ID4gKwlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlcjsNCj4gPiAgDQo+ID4gLQlpZiAoIUNBTl9QU1IoZGV2X3ByaXYpKQ0KPiA+IC0JCXJl
dHVybiAtRU5PREVWOw0KPiA+ICsJaWYgKCFIQVNfUFNSKGRldl9wcml2KSkNCj4gPiArCQlyZXR1
cm4gcmV0Ow0KPiA+ICANCj4gPiAtCWRybV9kYmdfa21zKCZkZXZfcHJpdi0+ZHJtLCAiU2V0dGlu
ZyBQU1IgZGVidWcgdG8gJWxseFxuIiwNCj4gPiB2YWwpOw0KPiA+ICsJZm9yX2VhY2hfaW50ZWxf
ZHAoJmRldl9wcml2LT5kcm0sIGVuY29kZXIpIHsNCj4gPiArCQlzdHJ1Y3QgaW50ZWxfZHAgKmlu
dGVsX2RwID0gZW5jX3RvX2ludGVsX2RwKGVuY29kZXIpOw0KPiA+ICANCj4gPiAtCXdha2VyZWYg
PSBpbnRlbF9ydW50aW1lX3BtX2dldCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOw0KPiA+ICsJCWlm
ICghQ0FOX1BTUihpbnRlbF9kcCkpDQo+ID4gKwkJCWNvbnRpbnVlOw0KPiA+ICANCj4gPiAtCXJl
dCA9IGludGVsX3Bzcl9kZWJ1Z19zZXQoZGV2X3ByaXYsIHZhbCk7DQo+ID4gKwkJaWYgKGVuY29k
ZXItPnR5cGUgPT0gSU5URUxfT1VUUFVUX0VEUCkgew0KPiA+ICsJCQlkcm1fZGJnX2ttcygmZGV2
X3ByaXYtPmRybSwgIlNldHRpbmcgUFNSIGRlYnVnDQo+ID4gdG8gJWxseFxuIiwgdmFsKTsNCj4g
PiAgDQo+ID4gLQlpbnRlbF9ydW50aW1lX3BtX3B1dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdh
a2VyZWYpOw0KPiA+ICsJCQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmRldl9wcml2
LQ0KPiA+ID5ydW50aW1lX3BtKTsNCj4gPiArDQo+ID4gKwkJCS8vIFRPRE86IHNwbGl0IHRvIGVh
Y2ggdHJhbnNjb2RlcidzIFBTUiBkZWJ1Zw0KPiA+IHN0YXRlDQo+ID4gKwkJCXJldCA9IGludGVs
X3Bzcl9kZWJ1Z19zZXQoaW50ZWxfZHAsIHZhbCk7DQo+ID4gKw0KPiA+ICsJCQlpbnRlbF9ydW50
aW1lX3BtX3B1dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sDQo+ID4gd2FrZXJlZik7DQo+ID4gKwkJ
fQ0KPiA+ICsJfQ0KPiA+ICANCj4gPiAgCXJldHVybiByZXQ7DQo+ID4gIH0NCj4gPiBAQCAtNDU1
LDEyICs0ODYsMjUgQEAgc3RhdGljIGludA0KPiA+ICBpOTE1X2VkcF9wc3JfZGVidWdfZ2V0KHZv
aWQgKmRhdGEsIHU2NCAqdmFsKQ0KPiA+ICB7DQo+ID4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSBkYXRhOw0KPiA+ICsJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXI7
DQo+ID4gIA0KPiA+IC0JaWYgKCFDQU5fUFNSKGRldl9wcml2KSkNCj4gPiArCWlmICghSEFTX1BT
UihkZXZfcHJpdikpDQo+ID4gIAkJcmV0dXJuIC1FTk9ERVY7DQo+ID4gIA0KPiA+IC0JKnZhbCA9
IFJFQURfT05DRShkZXZfcHJpdi0+cHNyLmRlYnVnKTsNCj4gPiAtCXJldHVybiAwOw0KPiA+ICsJ
Zm9yX2VhY2hfaW50ZWxfZHAoJmRldl9wcml2LT5kcm0sIGVuY29kZXIpIHsNCj4gPiArCQlzdHJ1
Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gZW5jX3RvX2ludGVsX2RwKGVuY29kZXIpOw0KPiA+ICsN
Cj4gPiArCQlpZiAoIUNBTl9QU1IoaW50ZWxfZHApKQ0KPiA+ICsJCQljb250aW51ZTsNCj4gPiAr
DQo+ID4gKwkJLy8gVE9ETzogc3BsaXQgdG8gZWFjaCB0cmFuc2NvZGVyJ3MgUFNSIGRlYnVnIHN0
YXRlDQo+ID4gKwkJaWYgKGVuY29kZXItPnR5cGUgPT0gSU5URUxfT1VUUFVUX0VEUCkgew0KPiA+
ICsJCQkqdmFsID0gUkVBRF9PTkNFKGludGVsX2RwLT5wc3IuZGVidWcpOw0KPiA+ICsJCQlyZXR1
cm4gMDsNCj4gPiArCQl9DQo+ID4gKwl9DQo+ID4gKw0KPiA+ICsJcmV0dXJuIC1FTk9ERVY7DQo+
ID4gIH0NCj4gPiAgDQo+ID4gIERFRklORV9TSU1QTEVfQVRUUklCVVRFKGk5MTVfZWRwX3Bzcl9k
ZWJ1Z19mb3BzLA0KPiA+IEBAIC0xMjM0LDkgKzEyNzgsNiBAQCBzdGF0aWMgdm9pZCBkcnJzX3N0
YXR1c19wZXJfY3J0YyhzdHJ1Y3QNCj4gPiBzZXFfZmlsZSAqbSwNCj4gPiAgCQkvKiBkaXNhYmxl
X2RycnMoKSB3aWxsIG1ha2UgZHJycy0+ZHAgTlVMTCAqLw0KPiA+ICAJCWlmICghZHJycy0+ZHAp
IHsNCj4gPiAgCQkJc2VxX3B1dHMobSwgIklkbGVuZXNzIERSUlM6IERpc2FibGVkXG4iKTsNCj4g
PiAtCQkJaWYgKGRldl9wcml2LT5wc3IuZW5hYmxlZCkNCj4gPiAtCQkJCXNlcV9wdXRzKG0sDQo+
ID4gLQkJCQkiXHRBcyBQU1IgaXMgZW5hYmxlZCwgRFJSUyBpcyBub3QNCj4gPiBlbmFibGVkXG4i
KTsNCj4gPiAgCQkJbXV0ZXhfdW5sb2NrKCZkcnJzLT5tdXRleCk7DQo+ID4gIAkJCXJldHVybjsN
Cj4gPiAgCQl9DQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfZGlzcGxheV90eXBlcy5oDQo+ID4gYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2Rpc3BsYXlfdHlwZXMuaA0KPiA+IGluZGV4IDViYzViZmJjNDU1MS4uOTg5OWZkZGY0
Yzk5IDEwMDY0NA0KPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZGlzcGxheV90eXBlcy5oDQo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kaXNwbGF5X3R5cGVzLmgNCj4gPiBAQCAtMTMzOSw2ICsxMzM5LDQyIEBAIHN0cnVjdCBp
bnRlbF9kcF9jb21wbGlhbmNlIHsNCj4gPiAgCXU4IHRlc3RfbGFuZV9jb3VudDsNCj4gPiAgfTsN
Cj4gPiAgDQo+ID4gK3N0cnVjdCBpbnRlbF9wc3Igew0KPiA+ICsJLyogTXV0ZXggZm9yIFBTUiBz
dGF0ZSBvZiB0aGUgdHJhbnNjb2RlciAqLw0KPiA+ICsJc3RydWN0IG11dGV4IGxvY2s7DQo+ID4g
Kw0KPiA+ICsjZGVmaW5lIEk5MTVfUFNSX0RFQlVHX01PREVfTUFTSwkweDBmDQo+ID4gKyNkZWZp
bmUgSTkxNV9QU1JfREVCVUdfREVGQVVMVAkJMHgwMA0KPiA+ICsjZGVmaW5lIEk5MTVfUFNSX0RF
QlVHX0RJU0FCTEUJCTB4MDENCj4gPiArI2RlZmluZSBJOTE1X1BTUl9ERUJVR19FTkFCTEUJCTB4
MDINCj4gPiArI2RlZmluZSBJOTE1X1BTUl9ERUJVR19GT1JDRV9QU1IxCTB4MDMNCj4gPiArI2Rl
ZmluZSBJOTE1X1BTUl9ERUJVR19JUlEJCTB4MTANCj4gPiArDQo+ID4gKwl1MzIgZGVidWc7DQo+
ID4gKwlib29sIHNpbmtfc3VwcG9ydDsNCj4gPiArCWJvb2wgZW5hYmxlZDsNCj4gPiArCWVudW0g
cGlwZSBwaXBlOw0KPiA+ICsJZW51bSB0cmFuc2NvZGVyIHRyYW5zY29kZXI7DQo+ID4gKwlib29s
IGFjdGl2ZTsNCj4gPiArCXN0cnVjdCB3b3JrX3N0cnVjdCB3b3JrOw0KPiA+ICsJdW5zaWduZWQg
aW50IGJ1c3lfZnJvbnRidWZmZXJfYml0czsNCj4gPiArCWJvb2wgc2lua19wc3IyX3N1cHBvcnQ7
DQo+ID4gKwlib29sIGxpbmtfc3RhbmRieTsNCj4gPiArCWJvb2wgY29sb3JpbWV0cnlfc3VwcG9y
dDsNCj4gPiArCWJvb2wgcHNyMl9lbmFibGVkOw0KPiA+ICsJYm9vbCBwc3IyX3NlbF9mZXRjaF9l
bmFibGVkOw0KPiA+ICsJdTggc2lua19zeW5jX2xhdGVuY3k7DQo+ID4gKwlrdGltZV90IGxhc3Rf
ZW50cnlfYXR0ZW1wdDsNCj4gPiArCWt0aW1lX3QgbGFzdF9leGl0Ow0KPiA+ICsJYm9vbCBzaW5r
X25vdF9yZWxpYWJsZTsNCj4gPiArCWJvb2wgaXJxX2F1eF9lcnJvcjsNCj4gPiArCXUxNiBzdV94
X2dyYW51bGFyaXR5Ow0KPiA+ICsJYm9vbCBkYzNjb19lbmFibGVkOw0KPiA+ICsJdTMyIGRjM2Nv
X2V4aXRfZGVsYXk7DQo+ID4gKwlzdHJ1Y3QgZGVsYXllZF93b3JrIGRjM2NvX3dvcms7DQo+ID4g
KwlzdHJ1Y3QgZHJtX2RwX3ZzY19zZHAgdnNjOw0KPiA+ICt9Ow0KPiA+ICsNCj4gPiAgc3RydWN0
IGludGVsX2RwIHsNCj4gPiAgCWk5MTVfcmVnX3Qgb3V0cHV0X3JlZzsNCj4gPiAgCXUzMiBEUDsN
Cj4gPiBAQCAtMTQ2MCw2ICsxNDk2LDggQEAgc3RydWN0IGludGVsX2RwIHsNCj4gPiAgDQo+ID4g
IAlib29sIGhvYmxfZmFpbGVkOw0KPiA+ICAJYm9vbCBob2JsX2FjdGl2ZTsNCj4gPiArDQo+ID4g
KwlzdHJ1Y3QgaW50ZWxfcHNyIHBzcjsNCj4gPiAgfTsNCj4gPiAgDQo+ID4gIGVudW0gbHNwY29u
X3ZlbmRvciB7DQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfZHAuYw0KPiA+IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5j
DQo+ID4gaW5kZXggYjJiYzBjOGMzOWM3Li41NzMwY2FkN2I2YWMgMTAwNjQ0DQo+ID4gLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jDQo+ID4gKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jDQo+ID4gQEAgLTI3MDIsMTIgKzI3MDIs
MTAgQEAgdm9pZCBpbnRlbF9kcF9jb21wdXRlX3Bzcl92c2Nfc2RwKHN0cnVjdA0KPiA+IGludGVs
X2RwICppbnRlbF9kcCwNCj4gPiAgCQkJCSAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3Rh
dGUNCj4gPiAqY29ubl9zdGF0ZSwNCj4gPiAgCQkJCSAgc3RydWN0IGRybV9kcF92c2Nfc2RwICp2
c2MpDQo+ID4gIHsNCj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRw
X3RvX2k5MTUoaW50ZWxfZHApOw0KPiA+IC0NCj4gPiAgCXZzYy0+c2RwX3R5cGUgPSBEUF9TRFBf
VlNDOw0KPiA+ICANCj4gPiAtCWlmIChkZXZfcHJpdi0+cHNyLnBzcjJfZW5hYmxlZCkgew0KPiA+
IC0JCWlmIChkZXZfcHJpdi0+cHNyLmNvbG9yaW1ldHJ5X3N1cHBvcnQgJiYNCj4gPiArCWlmIChp
bnRlbF9kcC0+cHNyLnBzcjJfZW5hYmxlZCkgew0KPiA+ICsJCWlmIChpbnRlbF9kcC0+cHNyLmNv
bG9yaW1ldHJ5X3N1cHBvcnQgJiYNCj4gPiAgCQkgICAgaW50ZWxfZHBfbmVlZHNfdnNjX3NkcChj
cnRjX3N0YXRlLCBjb25uX3N0YXRlKSkgew0KPiA+ICAJCQkvKiBbUFNSMiwgK0NvbG9yaW1ldHJ5
XSAqLw0KPiA+ICAJCQlpbnRlbF9kcF9jb21wdXRlX3ZzY19jb2xvcmltZXRyeShjcnRjX3N0YXRl
LA0KPiA+IGNvbm5fc3RhdGUsDQo+ID4gQEAgLTM4NDQsNyArMzg0Miw3IEBAIGJvb2wgaW50ZWxf
ZHBfaW5pdGlhbF9mYXN0c2V0X2NoZWNrKHN0cnVjdA0KPiA+IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsDQo+ID4gIAkJcmV0dXJuIGZhbHNlOw0KPiA+ICAJfQ0KPiA+ICANCj4gPiAtCWlmIChDQU5f
UFNSKGk5MTUpICYmIGludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkpIHsNCj4gPiArCWlmIChDQU5f
UFNSKGludGVsX2RwKSAmJiBpbnRlbF9kcF9pc19lZHAoaW50ZWxfZHApKSB7DQo+ID4gIAkJZHJt
X2RiZ19rbXMoJmk5MTUtPmRybSwgIkZvcmNpbmcgZnVsbCBtb2Rlc2V0IHRvDQo+ID4gY29tcHV0
ZSBQU1Igc3RhdGVcbiIpOw0KPiA+ICAJCWNydGNfc3RhdGUtPnVhcGkubW9kZV9jaGFuZ2VkID0g
dHJ1ZTsNCj4gPiAgCQlyZXR1cm4gZmFsc2U7DQo+ID4gQEAgLTgwNzAsNiArODA2OCwxNyBAQCBz
dGF0aWMgdm9pZA0KPiA+IGludGVsX2RwX21vZGVzZXRfcmV0cnlfd29ya19mbihzdHJ1Y3Qgd29y
a19zdHJ1Y3QgKndvcmspDQo+ID4gIAlkcm1fa21zX2hlbHBlcl9ob3RwbHVnX2V2ZW50KGNvbm5l
Y3Rvci0+ZGV2KTsNCj4gPiAgfQ0KPiA+ICANCj4gPiArc3RhdGljIHZvaWQgaW50ZWxfZHBfdXBk
YXRlX3BpcGUoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsDQo+ID4gKwkJCQkgc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsDQo+ID4gKwkJCQkgY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUNCj4gPiAqY3J0Y19zdGF0ZSwNCj4gPiArCQkJCSBjb25zdCBzdHJ1Y3QgZHJt
X2Nvbm5lY3Rvcl9zdGF0ZQ0KPiA+ICpjb25uX3N0YXRlKQ0KPiA+ICt7DQo+ID4gKwlzdHJ1Y3Qg
aW50ZWxfZHAgKmludGVsX2RwID0gZW5jX3RvX2ludGVsX2RwKGVuY29kZXIpOw0KPiA+ICsNCj4g
PiArCWludGVsX3BhbmVsX3VwZGF0ZV9iYWNrbGlnaHQoc3RhdGUsIGVuY29kZXIsIGNydGNfc3Rh
dGUsDQo+ID4gY29ubl9zdGF0ZSk7DQo+ID4gKwlpbnRlbF9wc3IyX3Byb2dyYW1fdHJhbnNfbWFu
X3Rya19jdGwoaW50ZWxfZHAsIGNydGNfc3RhdGUpOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICBib29s
DQo+ID4gIGludGVsX2RwX2luaXRfY29ubmVjdG9yKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQg
KmRpZ19wb3J0LA0KPiA+ICAJCQlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICppbnRlbF9jb25uZWN0
b3IpDQo+ID4gQEAgLTgxODQsNiArODE5Myw4IEBAIGludGVsX2RwX2luaXRfY29ubmVjdG9yKHN0
cnVjdA0KPiA+IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQsDQo+ID4gIAkJCSAgICAgICAo
dGVtcCAmIH4weGYpIHwgMHhkKTsNCj4gPiAgCX0NCj4gPiAgDQo+ID4gKwlpbnRlbF9wc3JfaW5p
dChpbnRlbF9kcCk7DQo+ID4gKw0KPiA+ICAJcmV0dXJuIHRydWU7DQo+ID4gIA0KPiA+ICBmYWls
Og0KPiA+IEBAIC04MjI1LDcgKzgyMzYsNyBAQCBib29sIGludGVsX2RwX2luaXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUNCj4gPiAqZGV2X3ByaXYsDQo+ID4gIAlpbnRlbF9lbmNvZGVyLT5nZXRf
Y29uZmlnID0gaW50ZWxfZHBfZ2V0X2NvbmZpZzsNCj4gPiAgCWludGVsX2VuY29kZXItPnN5bmNf
c3RhdGUgPSBpbnRlbF9kcF9zeW5jX3N0YXRlOw0KPiA+ICAJaW50ZWxfZW5jb2Rlci0+aW5pdGlh
bF9mYXN0c2V0X2NoZWNrID0NCj4gPiBpbnRlbF9kcF9pbml0aWFsX2Zhc3RzZXRfY2hlY2s7DQo+
ID4gLQlpbnRlbF9lbmNvZGVyLT51cGRhdGVfcGlwZSA9IGludGVsX3BhbmVsX3VwZGF0ZV9iYWNr
bGlnaHQ7DQo+ID4gKwlpbnRlbF9lbmNvZGVyLT51cGRhdGVfcGlwZSA9IGludGVsX2RwX3VwZGF0
ZV9waXBlOw0KPiA+ICAJaW50ZWxfZW5jb2Rlci0+c3VzcGVuZCA9IGludGVsX2RwX2VuY29kZXJf
c3VzcGVuZDsNCj4gPiAgCWludGVsX2VuY29kZXItPnNodXRkb3duID0gaW50ZWxfZHBfZW5jb2Rl
cl9zaHV0ZG93bjsNCj4gPiAgCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkgew0KPiA+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Bzci5jDQo+ID4g
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Bzci5jDQo+ID4gaW5kZXggZDlh
Mzk1YzQ4NmQzLi5lZWQ3NzU0YzJmNzQgMTAwNjQ0DQo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9wc3IuYw0KPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfcHNyLmMNCj4gPiBAQCAtNzksMTEgKzc5LDEzIEBADQo+ID4gICAqIHVz
ZSBwYWdlIGZsaXBzLg0KPiA+ICAgKi8NCj4gPiAgDQo+ID4gLXN0YXRpYyBib29sIHBzcl9nbG9i
YWxfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkNCj4gPiArc3RhdGljIGJv
b2wgcHNyX2dsb2JhbF9lbmFibGVkKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApDQo+ID4gIHsN
Cj4gPiAtCXN3aXRjaCAoaTkxNS0+cHNyLmRlYnVnICYgSTkxNV9QU1JfREVCVUdfTU9ERV9NQVNL
KSB7DQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1
KGludGVsX2RwKTsNCj4gPiArDQo+ID4gKwlzd2l0Y2ggKGludGVsX2RwLT5wc3IuZGVidWcgJiBJ
OTE1X1BTUl9ERUJVR19NT0RFX01BU0spIHsNCj4gPiAgCWNhc2UgSTkxNV9QU1JfREVCVUdfREVG
QVVMVDoNCj4gPiAtCQlyZXR1cm4gaTkxNS0+cGFyYW1zLmVuYWJsZV9wc3I7DQo+ID4gKwkJcmV0
dXJuIGRldl9wcml2LT5wYXJhbXMuZW5hYmxlX3BzcjsNCj4gPiAgCWNhc2UgSTkxNV9QU1JfREVC
VUdfRElTQUJMRToNCj4gPiAgCQlyZXR1cm4gZmFsc2U7DQo+ID4gIAlkZWZhdWx0Og0KPiA+IEBA
IC05MSw5ICs5Myw5IEBAIHN0YXRpYyBib29sIHBzcl9nbG9iYWxfZW5hYmxlZChzdHJ1Y3QNCj4g
PiBkcm1faTkxNV9wcml2YXRlICppOTE1KQ0KPiA+ICAJfQ0KPiA+ICB9DQo+ID4gIA0KPiA+IC1z
dGF0aWMgYm9vbCBwc3IyX2dsb2JhbF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikNCj4gPiArc3RhdGljIGJvb2wgcHNyMl9nbG9iYWxfZW5hYmxlZChzdHJ1Y3QgaW50
ZWxfZHAgKmludGVsX2RwKQ0KPiA+ICB7DQo+ID4gLQlzd2l0Y2ggKGRldl9wcml2LT5wc3IuZGVi
dWcgJiBJOTE1X1BTUl9ERUJVR19NT0RFX01BU0spIHsNCj4gPiArCXN3aXRjaCAoaW50ZWxfZHAt
PnBzci5kZWJ1ZyAmIEk5MTVfUFNSX0RFQlVHX01PREVfTUFTSykgew0KPiA+ICAJY2FzZSBJOTE1
X1BTUl9ERUJVR19ESVNBQkxFOg0KPiA+ICAJY2FzZSBJOTE1X1BTUl9ERUJVR19GT1JDRV9QU1Ix
Og0KPiA+ICAJCXJldHVybiBmYWxzZTsNCj4gPiBAQCAtMTAyLDExICsxMDQsMTIgQEAgc3RhdGlj
IGJvb2wgcHNyMl9nbG9iYWxfZW5hYmxlZChzdHJ1Y3QNCj4gPiBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikNCj4gPiAgCX0NCj4gPiAgfQ0KPiA+ICANCj4gPiAtc3RhdGljIHZvaWQgcHNyX2ly
cV9jb250cm9sKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikNCj4gPiArc3RhdGlj
IHZvaWQgcHNyX2lycV9jb250cm9sKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApDQo+ID4gIHsN
Cj4gPiAgCWVudW0gdHJhbnNjb2RlciB0cmFuc19zaGlmdDsNCj4gPiAgCXUzMiBtYXNrLCB2YWw7
DQo+ID4gIAlpOTE1X3JlZ190IGltcl9yZWc7DQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsNCj4gPiAgDQo+ID4gIAkvKg0KPiA+
ICAJICogZ2VuMTIrIGhhcyByZWdpc3RlcnMgcmVsYXRpdmUgdG8gdHJhbnNjb2RlciBhbmQgb25l
IHBlcg0KPiA+IHRyYW5zY29kZXINCj4gPiBAQCAtMTE1LDE0ICsxMTgsMTQgQEAgc3RhdGljIHZv
aWQgcHNyX2lycV9jb250cm9sKHN0cnVjdA0KPiA+IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQ0KPiA+ICAJICovDQo+ID4gIAlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMikgew0KPiA+
ICAJCXRyYW5zX3NoaWZ0ID0gMDsNCj4gPiAtCQlpbXJfcmVnID0gVFJBTlNfUFNSX0lNUihkZXZf
cHJpdi0+cHNyLnRyYW5zY29kZXIpOw0KPiA+ICsJCWltcl9yZWcgPSBUUkFOU19QU1JfSU1SKGlu
dGVsX2RwLT5wc3IudHJhbnNjb2Rlcik7DQo+ID4gIAl9IGVsc2Ugew0KPiA+IC0JCXRyYW5zX3No
aWZ0ID0gZGV2X3ByaXYtPnBzci50cmFuc2NvZGVyOw0KPiA+ICsJCXRyYW5zX3NoaWZ0ID0gaW50
ZWxfZHAtPnBzci50cmFuc2NvZGVyOw0KPiA+ICAJCWltcl9yZWcgPSBFRFBfUFNSX0lNUjsNCj4g
PiAgCX0NCj4gPiAgDQo+ID4gIAltYXNrID0gRURQX1BTUl9FUlJPUih0cmFuc19zaGlmdCk7DQo+
ID4gLQlpZiAoZGV2X3ByaXYtPnBzci5kZWJ1ZyAmIEk5MTVfUFNSX0RFQlVHX0lSUSkNCj4gPiAr
CWlmIChpbnRlbF9kcC0+cHNyLmRlYnVnICYgSTkxNV9QU1JfREVCVUdfSVJRKQ0KPiA+ICAJCW1h
c2sgfD0gRURQX1BTUl9QT1NUX0VYSVQodHJhbnNfc2hpZnQpIHwNCj4gPiAgCQkJRURQX1BTUl9Q
UkVfRU5UUlkodHJhbnNfc2hpZnQpOw0KPiA+ICANCj4gPiBAQCAtMTcxLDM4ICsxNzQsMzcgQEAg
c3RhdGljIHZvaWQgcHNyX2V2ZW50X3ByaW50KHN0cnVjdA0KPiA+IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsDQo+ID4gIAkJZHJtX2RiZ19rbXMoJmk5MTUtPmRybSwgIlx0UFNSIGRpc2FibGVkXG4i
KTsNCj4gPiAgfQ0KPiA+ICANCj4gPiAtdm9pZCBpbnRlbF9wc3JfaXJxX2hhbmRsZXIoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzINCj4gPiBwc3JfaWlyKQ0KPiA+ICt2b2lk
IGludGVsX3Bzcl9pcnFfaGFuZGxlcihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLCB1MzIgcHNy
X2lpcikNCj4gPiAgew0KPiA+IC0JZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0gZGV2
X3ByaXYtPnBzci50cmFuc2NvZGVyOw0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7DQo+ID4gKwllbnVtIHRyYW5zY29kZXIgY3B1
X3RyYW5zY29kZXIgPSBpbnRlbF9kcC0+cHNyLnRyYW5zY29kZXI7DQo+ID4gIAllbnVtIHRyYW5z
Y29kZXIgdHJhbnNfc2hpZnQ7DQo+ID4gIAlpOTE1X3JlZ190IGltcl9yZWc7DQo+ID4gIAlrdGlt
ZV90IHRpbWVfbnMgPSAga3RpbWVfZ2V0KCk7DQo+ID4gIA0KPiA+ICAJaWYgKElOVEVMX0dFTihk
ZXZfcHJpdikgPj0gMTIpIHsNCj4gPiAgCQl0cmFuc19zaGlmdCA9IDA7DQo+ID4gLQkJaW1yX3Jl
ZyA9IFRSQU5TX1BTUl9JTVIoZGV2X3ByaXYtPnBzci50cmFuc2NvZGVyKTsNCj4gPiArCQlpbXJf
cmVnID0gVFJBTlNfUFNSX0lNUihpbnRlbF9kcC0+cHNyLnRyYW5zY29kZXIpOw0KPiA+ICAJfSBl
bHNlIHsNCj4gPiAtCQl0cmFuc19zaGlmdCA9IGRldl9wcml2LT5wc3IudHJhbnNjb2RlcjsNCj4g
PiArCQl0cmFuc19zaGlmdCA9IGludGVsX2RwLT5wc3IudHJhbnNjb2RlcjsNCj4gPiAgCQlpbXJf
cmVnID0gRURQX1BTUl9JTVI7DQo+ID4gIAl9DQo+ID4gIA0KPiA+ICAJaWYgKHBzcl9paXIgJiBF
RFBfUFNSX1BSRV9FTlRSWSh0cmFuc19zaGlmdCkpIHsNCj4gPiAtCQlkZXZfcHJpdi0+cHNyLmxh
c3RfZW50cnlfYXR0ZW1wdCA9IHRpbWVfbnM7DQo+ID4gLQkJZHJtX2RiZ19rbXMoJmRldl9wcml2
LT5kcm0sDQo+ID4gLQkJCSAgICAiW3RyYW5zY29kZXIgJXNdIFBTUiBlbnRyeSBhdHRlbXB0IGlu
IDINCj4gPiB2YmxhbmtzXG4iLA0KPiA+IC0JCQkgICAgdHJhbnNjb2Rlcl9uYW1lKGNwdV90cmFu
c2NvZGVyKSk7DQo+ID4gKwkJaW50ZWxfZHAtPnBzci5sYXN0X2VudHJ5X2F0dGVtcHQgPSB0aW1l
X25zOw0KPiA+ICsJCURSTV9ERUJVR19LTVMoIlt0cmFuc2NvZGVyICVzXSBQU1IgZW50cnkgYXR0
ZW1wdCBpbiAyDQo+ID4gdmJsYW5rc1xuIiwNCj4gPiArCQkJICAgICAgdHJhbnNjb2Rlcl9uYW1l
KGNwdV90cmFuc2NvZGVyKSk7DQo+ID4gIAl9DQo+ID4gIA0KPiA+ICAJaWYgKHBzcl9paXIgJiBF
RFBfUFNSX1BPU1RfRVhJVCh0cmFuc19zaGlmdCkpIHsNCj4gPiAtCQlkZXZfcHJpdi0+cHNyLmxh
c3RfZXhpdCA9IHRpbWVfbnM7DQo+ID4gLQkJZHJtX2RiZ19rbXMoJmRldl9wcml2LT5kcm0sDQo+
ID4gLQkJCSAgICAiW3RyYW5zY29kZXIgJXNdIFBTUiBleGl0IGNvbXBsZXRlZFxuIiwNCj4gPiAt
CQkJICAgIHRyYW5zY29kZXJfbmFtZShjcHVfdHJhbnNjb2RlcikpOw0KPiA+ICsJCWludGVsX2Rw
LT5wc3IubGFzdF9leGl0ID0gdGltZV9uczsNCj4gPiArCQlEUk1fREVCVUdfS01TKCJbdHJhbnNj
b2RlciAlc10gUFNSIGV4aXQgY29tcGxldGVkXG4iLA0KPiA+ICsJCQkgICAgICB0cmFuc2NvZGVy
X25hbWUoY3B1X3RyYW5zY29kZXIpKTsNCj4gPiAgDQo+ID4gIAkJaWYgKElOVEVMX0dFTihkZXZf
cHJpdikgPj0gOSkgew0KPiA+ICAJCQl1MzIgdmFsID0gaW50ZWxfZGVfcmVhZChkZXZfcHJpdiwN
Cj4gPiAgCQkJCQkJUFNSX0VWRU5UKGNwdV90cmFuc2NvZGUNCj4gPiByKSk7DQo+ID4gLQkJCWJv
b2wgcHNyMl9lbmFibGVkID0gZGV2X3ByaXYtPnBzci5wc3IyX2VuYWJsZWQ7DQo+ID4gKwkJCWJv
b2wgcHNyMl9lbmFibGVkID0gaW50ZWxfZHAtPnBzci5wc3IyX2VuYWJsZWQ7DQo+ID4gIA0KPiA+
ICAJCQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwNCj4gPiBQU1JfRVZFTlQoY3B1X3RyYW5zY29k
ZXIpLA0KPiA+ICAJCQkJICAgICAgIHZhbCk7DQo+ID4gQEAgLTIxMywxMCArMjE1LDEwIEBAIHZv
aWQgaW50ZWxfcHNyX2lycV9oYW5kbGVyKHN0cnVjdA0KPiA+IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LCB1MzIgcHNyX2lpcikNCj4gPiAgCWlmIChwc3JfaWlyICYgRURQX1BTUl9FUlJPUih0
cmFuc19zaGlmdCkpIHsNCj4gPiAgCQl1MzIgdmFsOw0KPiA+ICANCj4gPiAtCQlkcm1fd2Fybigm
ZGV2X3ByaXYtPmRybSwgIlt0cmFuc2NvZGVyICVzXSBQU1IgYXV4DQo+ID4gZXJyb3JcbiIsDQo+
ID4gKwkJRFJNX1dBUk4oIlt0cmFuc2NvZGVyICVzXSBQU1IgYXV4IGVycm9yXG4iLA0KPiA+ICAJ
CQkgdHJhbnNjb2Rlcl9uYW1lKGNwdV90cmFuc2NvZGVyKSk7DQo+ID4gIA0KPiA+IC0JCWRldl9w
cml2LT5wc3IuaXJxX2F1eF9lcnJvciA9IHRydWU7DQo+ID4gKwkJaW50ZWxfZHAtPnBzci5pcnFf
YXV4X2Vycm9yID0gdHJ1ZTsNCj4gPiAgDQo+ID4gIAkJLyoNCj4gPiAgCQkgKiBJZiB0aGlzIGlu
dGVycnVwdGlvbiBpcyBub3QgbWFza2VkIGl0IHdpbGwga2VlcA0KPiA+IEBAIC0yMzAsNyArMjMy
LDcgQEAgdm9pZCBpbnRlbF9wc3JfaXJxX2hhbmRsZXIoc3RydWN0DQo+ID4gZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsIHUzMiBwc3JfaWlyKQ0KPiA+ICAJCXZhbCB8PSBFRFBfUFNSX0VSUk9S
KHRyYW5zX3NoaWZ0KTsNCj4gPiAgCQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgaW1yX3JlZywg
dmFsKTsNCj4gPiAgDQo+ID4gLQkJc2NoZWR1bGVfd29yaygmZGV2X3ByaXYtPnBzci53b3JrKTsN
Cj4gPiArCQlzY2hlZHVsZV93b3JrKCZpbnRlbF9kcC0+cHNyLndvcmspOw0KPiA+ICAJfQ0KPiA+
ICB9DQo+ID4gIA0KPiA+IEBAIC0yOTEsMTIgKzI5Myw2IEBAIHZvaWQgaW50ZWxfcHNyX2luaXRf
ZHBjZChzdHJ1Y3QgaW50ZWxfZHANCj4gPiAqaW50ZWxfZHApDQo+ID4gIAlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQ0KPiA+ICAJCXRvX2k5MTUoZHBfdG9fZGlnX3BvcnQoaW50
ZWxfZHApLT5iYXNlLmJhc2UuZGV2KTsNCj4gPiAgDQo+ID4gLQlpZiAoZGV2X3ByaXYtPnBzci5k
cCkgew0KPiA+IC0JCWRybV93YXJuKCZkZXZfcHJpdi0+ZHJtLA0KPiA+IC0JCQkgIk1vcmUgdGhh
biBvbmUgZURQIHBhbmVsIGZvdW5kLCBQU1Igc3VwcG9ydA0KPiA+IHNob3VsZCBiZSBleHRlbmRl
ZFxuIik7DQo+ID4gLQkJcmV0dXJuOw0KPiA+IC0JfQ0KPiA+IC0NCj4gPiAgCWRybV9kcF9kcGNk
X3JlYWQoJmludGVsX2RwLT5hdXgsIERQX1BTUl9TVVBQT1JULCBpbnRlbF9kcC0NCj4gPiA+cHNy
X2RwY2QsDQo+ID4gIAkJCSBzaXplb2YoaW50ZWxfZHAtPnBzcl9kcGNkKSk7DQo+ID4gIA0KPiA+
IEBAIC0zMTcsMTIgKzMxMywxMCBAQCB2b2lkIGludGVsX3Bzcl9pbml0X2RwY2Qoc3RydWN0IGlu
dGVsX2RwDQo+ID4gKmludGVsX2RwKQ0KPiA+ICAJCXJldHVybjsNCj4gPiAgCX0NCj4gPiAgDQo+
ID4gLQlkZXZfcHJpdi0+cHNyLnNpbmtfc3VwcG9ydCA9IHRydWU7DQo+ID4gLQlkZXZfcHJpdi0+
cHNyLnNpbmtfc3luY19sYXRlbmN5ID0NCj4gPiArCWludGVsX2RwLT5wc3Iuc2lua19zdXBwb3J0
ID0gdHJ1ZTsNCj4gPiArCWludGVsX2RwLT5wc3Iuc2lua19zeW5jX2xhdGVuY3kgPQ0KPiA+ICAJ
CWludGVsX2RwX2dldF9zaW5rX3N5bmNfbGF0ZW5jeShpbnRlbF9kcCk7DQo+ID4gIA0KPiA+IC0J
ZGV2X3ByaXYtPnBzci5kcCA9IGludGVsX2RwOw0KPiA+IC0NCj4gPiAgCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDkgJiYNCj4gPiAgCSAgICAoaW50ZWxfZHAtPnBzcl9kcGNkWzBdID09DQo+
ID4gRFBfUFNSMl9XSVRIX1lfQ09PUkRfSVNfU1VQUE9SVEVEKSkgew0KPiA+ICAJCWJvb2wgeV9y
ZXEgPSBpbnRlbF9kcC0+cHNyX2RwY2RbMV0gJg0KPiA+IEBAIC0zNDAsMTQgKzMzNCwxNCBAQCB2
b2lkIGludGVsX3Bzcl9pbml0X2RwY2Qoc3RydWN0IGludGVsX2RwDQo+ID4gKmludGVsX2RwKQ0K
PiA+ICAJCSAqIFktY29vcmRpbmF0ZSByZXF1aXJlbWVudCBwYW5lbHMgd2Ugd291bGQgbmVlZCB0
bw0KPiA+IGVuYWJsZQ0KPiA+ICAJCSAqIEdUQyBmaXJzdC4NCj4gPiAgCQkgKi8NCj4gPiAtCQlk
ZXZfcHJpdi0+cHNyLnNpbmtfcHNyMl9zdXBwb3J0ID0geV9yZXEgJiYgYWxwbTsNCj4gPiArCQlp
bnRlbF9kcC0+cHNyLnNpbmtfcHNyMl9zdXBwb3J0ID0geV9yZXEgJiYgYWxwbTsNCj4gPiAgCQlk
cm1fZGJnX2ttcygmZGV2X3ByaXYtPmRybSwgIlBTUjIgJXNzdXBwb3J0ZWRcbiIsDQo+ID4gLQkJ
CSAgICBkZXZfcHJpdi0+cHNyLnNpbmtfcHNyMl9zdXBwb3J0ID8gIiIgOiAibm90DQo+ID4gIik7
DQo+ID4gKwkJCSAgICBpbnRlbF9kcC0+cHNyLnNpbmtfcHNyMl9zdXBwb3J0ID8gIiIgOiAibm90
DQo+ID4gIik7DQo+ID4gIA0KPiA+IC0JCWlmIChkZXZfcHJpdi0+cHNyLnNpbmtfcHNyMl9zdXBw
b3J0KSB7DQo+ID4gLQkJCWRldl9wcml2LT5wc3IuY29sb3JpbWV0cnlfc3VwcG9ydCA9DQo+ID4g
KwkJaWYgKGludGVsX2RwLT5wc3Iuc2lua19wc3IyX3N1cHBvcnQpIHsNCj4gPiArCQkJaW50ZWxf
ZHAtPnBzci5jb2xvcmltZXRyeV9zdXBwb3J0ID0NCj4gPiAgCQkJCWludGVsX2RwX2dldF9jb2xv
cmltZXRyeV9zdGF0dXMoaW50ZWxfZA0KPiA+IHApOw0KPiA+IC0JCQlkZXZfcHJpdi0+cHNyLnN1
X3hfZ3JhbnVsYXJpdHkgPQ0KPiA+ICsJCQlpbnRlbF9kcC0+cHNyLnN1X3hfZ3JhbnVsYXJpdHkg
PQ0KPiA+ICAJCQkJaW50ZWxfZHBfZ2V0X3N1X3hfZ3JhbnVsYXJ0aXkoaW50ZWxfZHApDQo+ID4g
Ow0KPiA+ICAJCX0NCj4gPiAgCX0NCj4gPiBAQCAtMzczLDcgKzM2Nyw3IEBAIHN0YXRpYyB2b2lk
IGhzd19wc3Jfc2V0dXBfYXV4KHN0cnVjdCBpbnRlbF9kcA0KPiA+ICppbnRlbF9kcCkNCj4gPiAg
CUJVSUxEX0JVR19PTihzaXplb2YoYXV4X21zZykgPiAyMCk7DQo+ID4gIAlmb3IgKGkgPSAwOyBp
IDwgc2l6ZW9mKGF1eF9tc2cpOyBpICs9IDQpDQo+ID4gIAkJaW50ZWxfZGVfd3JpdGUoZGV2X3By
aXYsDQo+ID4gLQkJCSAgICAgICBFRFBfUFNSX0FVWF9EQVRBKGRldl9wcml2LQ0KPiA+ID5wc3Iu
dHJhbnNjb2RlciwgaSA+PiAyKSwNCj4gPiArCQkJICAgICAgIEVEUF9QU1JfQVVYX0RBVEEoaW50
ZWxfZHAtDQo+ID4gPnBzci50cmFuc2NvZGVyLCBpID4+IDIpLA0KPiA+ICAJCQkgICAgICAgaW50
ZWxfZHBfcGFja19hdXgoJmF1eF9tc2dbaV0sDQo+ID4gc2l6ZW9mKGF1eF9tc2cpIC0gaSkpOw0K
PiA+ICANCj4gPiAgCWF1eF9jbG9ja19kaXZpZGVyID0gaW50ZWxfZHAtPmdldF9hdXhfY2xvY2tf
ZGl2aWRlcihpbnRlbF9kcCwNCj4gPiAwKTsNCj4gPiBAQCAtMzg0LDcgKzM3OCw3IEBAIHN0YXRp
YyB2b2lkIGhzd19wc3Jfc2V0dXBfYXV4KHN0cnVjdCBpbnRlbF9kcA0KPiA+ICppbnRlbF9kcCkN
Cj4gPiAgDQo+ID4gIAkvKiBTZWxlY3Qgb25seSB2YWxpZCBiaXRzIGZvciBTUkRfQVVYX0NUTCAq
Lw0KPiA+ICAJYXV4X2N0bCAmPSBwc3JfYXV4X21hc2s7DQo+ID4gLQlpbnRlbF9kZV93cml0ZShk
ZXZfcHJpdiwgRURQX1BTUl9BVVhfQ1RMKGRldl9wcml2LQ0KPiA+ID5wc3IudHJhbnNjb2Rlciks
DQo+ID4gKwlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgRURQX1BTUl9BVVhfQ1RMKGludGVsX2Rw
LQ0KPiA+ID5wc3IudHJhbnNjb2RlciksDQo+ID4gIAkJICAgICAgIGF1eF9jdGwpOw0KPiA+ICB9
DQo+ID4gIA0KPiA+IEBAIC0zOTQsMTQgKzM4OCwxNCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wc3Jf
ZW5hYmxlX3Npbmsoc3RydWN0DQo+ID4gaW50ZWxfZHAgKmludGVsX2RwKQ0KPiA+ICAJdTggZHBj
ZF92YWwgPSBEUF9QU1JfRU5BQkxFOw0KPiA+ICANCj4gPiAgCS8qIEVuYWJsZSBBTFBNIGF0IHNp
bmsgZm9yIHBzcjIgKi8NCj4gPiAtCWlmIChkZXZfcHJpdi0+cHNyLnBzcjJfZW5hYmxlZCkgew0K
PiA+ICsJaWYgKGludGVsX2RwLT5wc3IucHNyMl9lbmFibGVkKSB7DQo+ID4gIAkJZHJtX2RwX2Rw
Y2Rfd3JpdGViKCZpbnRlbF9kcC0+YXV4LA0KPiA+IERQX1JFQ0VJVkVSX0FMUE1fQ09ORklHLA0K
PiA+ICAJCQkJICAgRFBfQUxQTV9FTkFCTEUgfA0KPiA+ICAJCQkJICAgRFBfQUxQTV9MT0NLX0VS
Uk9SX0lSUV9IUERfRU5BQkxFKTsNCj4gPiAgDQo+ID4gIAkJZHBjZF92YWwgfD0gRFBfUFNSX0VO
QUJMRV9QU1IyIHwNCj4gPiBEUF9QU1JfSVJRX0hQRF9XSVRIX0NSQ19FUlJPUlM7DQo+ID4gIAl9
IGVsc2Ugew0KPiA+IC0JCWlmIChkZXZfcHJpdi0+cHNyLmxpbmtfc3RhbmRieSkNCj4gPiArCQlp
ZiAoaW50ZWxfZHAtPnBzci5saW5rX3N0YW5kYnkpDQo+ID4gIAkJCWRwY2RfdmFsIHw9IERQX1BT
Ul9NQUlOX0xJTktfQUNUSVZFOw0KPiA+ICANCj4gPiAgCQlpZiAoSU5URUxfR0VOKGRldl9wcml2
KSA+PSA4KQ0KPiA+IEBAIC00NjQsNyArNDU4LDcgQEAgc3RhdGljIHU4IHBzcl9jb21wdXRlX2lk
bGVfZnJhbWVzKHN0cnVjdA0KPiA+IGludGVsX2RwICppbnRlbF9kcCkNCj4gPiAgCSAqIG9mZi1i
eS1vbmUgaXNzdWUgdGhhdCBIVyBoYXMgaW4gc29tZSBjYXNlcy4NCj4gPiAgCSAqLw0KPiA+ICAJ
aWRsZV9mcmFtZXMgPSBtYXgoNiwgZGV2X3ByaXYtPnZidC5wc3IuaWRsZV9mcmFtZXMpOw0KPiA+
IC0JaWRsZV9mcmFtZXMgPSBtYXgoaWRsZV9mcmFtZXMsIGRldl9wcml2LT5wc3Iuc2lua19zeW5j
X2xhdGVuY3kNCj4gPiArIDEpOw0KPiA+ICsJaWRsZV9mcmFtZXMgPSBtYXgoaWRsZV9mcmFtZXMs
IGludGVsX2RwLT5wc3Iuc2lua19zeW5jX2xhdGVuY3kNCj4gPiArIDEpOw0KPiA+ICANCj4gPiAg
CWlmIChkcm1fV0FSTl9PTigmZGV2X3ByaXYtPmRybSwgaWRsZV9mcmFtZXMgPiAweGYpKQ0KPiA+
ICAJCWlkbGVfZnJhbWVzID0gMHhmOw0KPiA+IEBAIC00ODQsNyArNDc4LDcgQEAgc3RhdGljIHZv
aWQgaHN3X2FjdGl2YXRlX3BzcjEoc3RydWN0IGludGVsX2RwDQo+ID4gKmludGVsX2RwKQ0KPiA+
ICAJaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpKQ0KPiA+ICAJCXZhbCB8PSBFRFBfUFNSX01JTl9M
SU5LX0VOVFJZX1RJTUVfOF9MSU5FUzsNCj4gPiAgDQo+ID4gLQlpZiAoZGV2X3ByaXYtPnBzci5s
aW5rX3N0YW5kYnkpDQo+ID4gKwlpZiAoaW50ZWxfZHAtPnBzci5saW5rX3N0YW5kYnkpDQo+ID4g
IAkJdmFsIHw9IEVEUF9QU1JfTElOS19TVEFOREJZOw0KPiA+ICANCj4gPiAgCXZhbCB8PSBpbnRl
bF9wc3IxX2dldF90cF90aW1lKGludGVsX2RwKTsNCj4gPiBAQCAtNDkyLDkgKzQ4Niw5IEBAIHN0
YXRpYyB2b2lkIGhzd19hY3RpdmF0ZV9wc3IxKHN0cnVjdCBpbnRlbF9kcA0KPiA+ICppbnRlbF9k
cCkNCj4gPiAgCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDgpDQo+ID4gIAkJdmFsIHw9IEVE
UF9QU1JfQ1JDX0VOQUJMRTsNCj4gPiAgDQo+ID4gLQl2YWwgfD0gKGludGVsX2RlX3JlYWQoZGV2
X3ByaXYsIEVEUF9QU1JfQ1RMKGRldl9wcml2LQ0KPiA+ID5wc3IudHJhbnNjb2RlcikpICYNCj4g
PiArCXZhbCB8PSAoaW50ZWxfZGVfcmVhZChkZXZfcHJpdiwgRURQX1BTUl9DVEwoaW50ZWxfZHAt
DQo+ID4gPnBzci50cmFuc2NvZGVyKSkgJg0KPiA+ICAJCUVEUF9QU1JfUkVTVE9SRV9QU1JfQUNU
SVZFX0NUWF9NQVNLKTsNCj4gPiAtCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBFRFBfUFNSX0NU
TChkZXZfcHJpdi0+cHNyLnRyYW5zY29kZXIpLCANCj4gPiB2YWwpOw0KPiA+ICsJaW50ZWxfZGVf
d3JpdGUoZGV2X3ByaXYsIEVEUF9QU1JfQ1RMKGludGVsX2RwLT5wc3IudHJhbnNjb2RlciksIA0K
PiA+IHZhbCk7DQo+ID4gIH0NCj4gPiAgDQo+ID4gIHN0YXRpYyB1MzIgaW50ZWxfcHNyMl9nZXRf
dHBfdGltZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQ0KPiA+IEBAIC01MjksNyArNTIzLDcg
QEAgc3RhdGljIHZvaWQgaHN3X2FjdGl2YXRlX3BzcjIoc3RydWN0IGludGVsX2RwDQo+ID4gKmlu
dGVsX2RwKQ0KPiA+ICAJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgfHwgSVNfR0VNSU5J
TEFLRShkZXZfcHJpdikpDQo+ID4gIAkJdmFsIHw9IEVEUF9ZX0NPT1JESU5BVEVfRU5BQkxFOw0K
PiA+ICANCj4gPiAtCXZhbCB8PSBFRFBfUFNSMl9GUkFNRV9CRUZPUkVfU1UoZGV2X3ByaXYtPnBz
ci5zaW5rX3N5bmNfbGF0ZW5jeSANCj4gPiArIDEpOw0KPiA+ICsJdmFsIHw9IEVEUF9QU1IyX0ZS
QU1FX0JFRk9SRV9TVShpbnRlbF9kcC0+cHNyLnNpbmtfc3luY19sYXRlbmN5IA0KPiA+ICsgMSk7
DQo+ID4gIAl2YWwgfD0gaW50ZWxfcHNyMl9nZXRfdHBfdGltZShpbnRlbF9kcCk7DQo+ID4gIA0K
PiA+ICAJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTIpIHsNCj4gPiBAQCAtNTQ4LDcgKzU0
Miw3IEBAIHN0YXRpYyB2b2lkIGhzd19hY3RpdmF0ZV9wc3IyKHN0cnVjdCBpbnRlbF9kcA0KPiA+
ICppbnRlbF9kcCkNCj4gPiAgCQl2YWwgfD0gRURQX1BTUjJfRkFTVF9XQUtFKDcpOw0KPiA+ICAJ
fQ0KPiA+ICANCj4gPiAtCWlmIChkZXZfcHJpdi0+cHNyLnBzcjJfc2VsX2ZldGNoX2VuYWJsZWQp
IHsNCj4gPiArCWlmIChpbnRlbF9kcC0+cHNyLnBzcjJfc2VsX2ZldGNoX2VuYWJsZWQpIHsNCj4g
PiAgCQkvKiBXQSAxNDA4MzMwODQ3ICovDQo+ID4gIAkJaWYgKElTX1RHTF9ESVNQX1JFVklEKGRl
dl9wcml2LCBUR0xfUkVWSURfQTAsDQo+ID4gVEdMX1JFVklEX0EwKSB8fA0KPiA+ICAJCSAgICBJ
U19SS0xfUkVWSUQoZGV2X3ByaXYsIFJLTF9SRVZJRF9BMCwgUktMX1JFVklEX0EwKSkNCj4gPiBA
QCAtNTU3LDIwICs1NTEsMjAgQEAgc3RhdGljIHZvaWQgaHN3X2FjdGl2YXRlX3BzcjIoc3RydWN0
IGludGVsX2RwDQo+ID4gKmludGVsX2RwKQ0KPiA+ICAJCQkJICAgICBESVNfUkFNX0JZUEFTU19Q
U1IyX01BTl9UUkFDSyk7DQo+ID4gIA0KPiA+ICAJCWludGVsX2RlX3dyaXRlKGRldl9wcml2LA0K
PiA+IC0JCQkgICAgICAgUFNSMl9NQU5fVFJLX0NUTChkZXZfcHJpdi0NCj4gPiA+cHNyLnRyYW5z
Y29kZXIpLA0KPiA+ICsJCQkgICAgICAgUFNSMl9NQU5fVFJLX0NUTChpbnRlbF9kcC0NCj4gPiA+
cHNyLnRyYW5zY29kZXIpLA0KPiA+ICAJCQkgICAgICAgUFNSMl9NQU5fVFJLX0NUTF9FTkFCTEUp
Ow0KPiA+ICAJfSBlbHNlIGlmIChIQVNfUFNSMl9TRUxfRkVUQ0goZGV2X3ByaXYpKSB7DQo+ID4g
IAkJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsDQo+ID4gLQkJCSAgICAgICBQU1IyX01BTl9UUktf
Q1RMKGRldl9wcml2LQ0KPiA+ID5wc3IudHJhbnNjb2RlciksIDApOw0KPiA+ICsJCQkgICAgICAg
UFNSMl9NQU5fVFJLX0NUTChpbnRlbF9kcC0NCj4gPiA+cHNyLnRyYW5zY29kZXIpLCAwKTsNCj4g
PiAgCX0NCj4gPiAgDQo+ID4gIAkvKg0KPiA+ICAJICogUFNSMiBIVyBpcyBpbmNvcnJlY3RseSB1
c2luZyBFRFBfUFNSX1RQMV9UUDNfU0VMIGFuZCBCU3BlYw0KPiA+IGlzDQo+ID4gIAkgKiByZWNv
bW1lbmRpbmcga2VlcCB0aGlzIGJpdCB1bnNldCB3aGlsZSBQU1IyIGlzIGVuYWJsZWQuDQo+ID4g
IAkgKi8NCj4gPiAtCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBFRFBfUFNSX0NUTChkZXZfcHJp
di0+cHNyLnRyYW5zY29kZXIpLCANCj4gPiAwKTsNCj4gPiArCWludGVsX2RlX3dyaXRlKGRldl9w
cml2LCBFRFBfUFNSX0NUTChpbnRlbF9kcC0+cHNyLnRyYW5zY29kZXIpLCANCj4gPiAwKTsNCj4g
PiAgDQo+ID4gLQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgRURQX1BTUjJfQ1RMKGRldl9wcml2
LQ0KPiA+ID5wc3IudHJhbnNjb2RlciksIHZhbCk7DQo+ID4gKwlpbnRlbF9kZV93cml0ZShkZXZf
cHJpdiwgRURQX1BTUjJfQ1RMKGludGVsX2RwLQ0KPiA+ID5wc3IudHJhbnNjb2RlciksIHZhbCk7
DQo+ID4gIH0NCj4gPiAgDQo+ID4gIHN0YXRpYyBib29sDQo+ID4gQEAgLTU5Myw1NSArNTg3LDU4
IEBAIHN0YXRpYyB1MzIgaW50ZWxfZ2V0X2ZyYW1lX3RpbWVfdXMoY29uc3QNCj4gPiBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlKQ0KPiA+ICAJCQkgICAgZHJtX21vZGVfdnJlZnJlc2go
JmNzdGF0ZS0NCj4gPiA+aHcuYWRqdXN0ZWRfbW9kZSkpOw0KPiA+ICB9DQo+ID4gIA0KPiA+IC1z
dGF0aWMgdm9pZCBwc3IyX3Byb2dyYW1faWRsZV9mcmFtZXMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUNCj4gPiAqZGV2X3ByaXYsDQo+ID4gK3N0YXRpYyB2b2lkIHBzcjJfcHJvZ3JhbV9pZGxlX2Zy
YW1lcyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLA0KPiA+ICAJCQkJICAgICB1MzIgaWRsZV9m
cmFtZXMpDQo+ID4gIHsNCj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IGRwX3RvX2k5MTUoaW50ZWxfZHApOw0KPiA+ICAJdTMyIHZhbDsNCj4gPiAgDQo+ID4gIAlpZGxl
X2ZyYW1lcyA8PD0gIEVEUF9QU1IyX0lETEVfRlJBTUVfU0hJRlQ7DQo+ID4gLQl2YWwgPSBpbnRl
bF9kZV9yZWFkKGRldl9wcml2LCBFRFBfUFNSMl9DVEwoZGV2X3ByaXYtDQo+ID4gPnBzci50cmFu
c2NvZGVyKSk7DQo+ID4gKwl2YWwgPSBpbnRlbF9kZV9yZWFkKGRldl9wcml2LCBFRFBfUFNSMl9D
VEwoaW50ZWxfZHAtDQo+ID4gPnBzci50cmFuc2NvZGVyKSk7DQo+ID4gIAl2YWwgJj0gfkVEUF9Q
U1IyX0lETEVfRlJBTUVfTUFTSzsNCj4gPiAgCXZhbCB8PSBpZGxlX2ZyYW1lczsNCj4gPiAtCWlu
dGVsX2RlX3dyaXRlKGRldl9wcml2LCBFRFBfUFNSMl9DVEwoZGV2X3ByaXYtDQo+ID4gPnBzci50
cmFuc2NvZGVyKSwgdmFsKTsNCj4gPiArCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBFRFBfUFNS
Ml9DVEwoaW50ZWxfZHAtDQo+ID4gPnBzci50cmFuc2NvZGVyKSwgdmFsKTsNCj4gPiAgfQ0KPiA+
ICANCj4gPiAtc3RhdGljIHZvaWQgdGdsX3BzcjJfZW5hYmxlX2RjM2NvKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlDQo+ID4gKmRldl9wcml2KQ0KPiA+ICtzdGF0aWMgdm9pZCB0Z2xfcHNyMl9lbmFi
bGVfZGMzY28oc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkNCj4gPiAgew0KPiA+IC0JcHNyMl9w
cm9ncmFtX2lkbGVfZnJhbWVzKGRldl9wcml2LCAwKTsNCj4gPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOw0KPiA+ICsNCj4gPiArCXBz
cjJfcHJvZ3JhbV9pZGxlX2ZyYW1lcyhpbnRlbF9kcCwgMCk7DQo+ID4gIAlpbnRlbF9kaXNwbGF5
X3Bvd2VyX3NldF90YXJnZXRfZGNfc3RhdGUoZGV2X3ByaXYsDQo+ID4gRENfU1RBVEVfRU5fREMz
Q08pOw0KPiA+ICB9DQo+ID4gIA0KPiA+IC1zdGF0aWMgdm9pZCB0Z2xfcHNyMl9kaXNhYmxlX2Rj
M2NvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlDQo+ID4gKmRldl9wcml2KQ0KPiA+ICtzdGF0aWMg
dm9pZCB0Z2xfcHNyMl9kaXNhYmxlX2RjM2NvKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApDQo+
ID4gIHsNCj4gPiAtCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSBkZXZfcHJpdi0+cHNyLmRw
Ow0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShp
bnRlbF9kcCk7DQo+ID4gIA0KPiA+ICAJaW50ZWxfZGlzcGxheV9wb3dlcl9zZXRfdGFyZ2V0X2Rj
X3N0YXRlKGRldl9wcml2LA0KPiA+IERDX1NUQVRFX0VOX1VQVE9fREM2KTsNCj4gPiAtCXBzcjJf
cHJvZ3JhbV9pZGxlX2ZyYW1lcyhkZXZfcHJpdiwNCj4gPiBwc3JfY29tcHV0ZV9pZGxlX2ZyYW1l
cyhpbnRlbF9kcCkpOw0KPiA+ICsJcHNyMl9wcm9ncmFtX2lkbGVfZnJhbWVzKGludGVsX2RwLA0K
PiA+IHBzcl9jb21wdXRlX2lkbGVfZnJhbWVzKGludGVsX2RwKSk7DQo+ID4gIH0NCj4gPiAgDQo+
ID4gIHN0YXRpYyB2b2lkIHRnbF9kYzNjb19kaXNhYmxlX3dvcmsoc3RydWN0IHdvcmtfc3RydWN0
ICp3b3JrKQ0KPiA+ICB7DQo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PQ0KPiA+IC0JCWNvbnRhaW5lcl9vZih3b3JrLCB0eXBlb2YoKmRldl9wcml2KSwNCj4gPiBwc3Iu
ZGMzY29fd29yay53b3JrKTsNCj4gPiArCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPQ0KPiA+
ICsJCWNvbnRhaW5lcl9vZih3b3JrLCB0eXBlb2YoKmludGVsX2RwKSwNCj4gPiBwc3IuZGMzY29f
d29yay53b3JrKTsNCj4gPiAgDQo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2sp
Ow0KPiA+ICsJbXV0ZXhfbG9jaygmaW50ZWxfZHAtPnBzci5sb2NrKTsNCj4gPiAgCS8qIElmIGRl
bGF5ZWQgd29yayBpcyBwZW5kaW5nLCBpdCBpcyBub3QgaWRsZSAqLw0KPiA+IC0JaWYgKGRlbGF5
ZWRfd29ya19wZW5kaW5nKCZkZXZfcHJpdi0+cHNyLmRjM2NvX3dvcmspKQ0KPiA+ICsJaWYgKGRl
bGF5ZWRfd29ya19wZW5kaW5nKCZpbnRlbF9kcC0+cHNyLmRjM2NvX3dvcmspKQ0KPiA+ICAJCWdv
dG8gdW5sb2NrOw0KPiA+ICANCj4gPiAtCXRnbF9wc3IyX2Rpc2FibGVfZGMzY28oZGV2X3ByaXYp
Ow0KPiA+ICsJdGdsX3BzcjJfZGlzYWJsZV9kYzNjbyhpbnRlbF9kcCk7DQo+ID4gIHVubG9jazoN
Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPnBzci5sb2NrKTsNCj4gPiArCW11dGV4X3Vu
bG9jaygmaW50ZWxfZHAtPnBzci5sb2NrKTsNCj4gPiAgfQ0KPiA+ICANCj4gPiAtc3RhdGljIHZv
aWQgdGdsX2Rpc2FsbG93X2RjM2NvX29uX3BzcjJfZXhpdChzdHJ1Y3QNCj4gPiBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikNCj4gPiArc3RhdGljIHZvaWQgdGdsX2Rpc2FsbG93X2RjM2NvX29u
X3BzcjJfZXhpdChzdHJ1Y3QgaW50ZWxfZHANCj4gPiAqaW50ZWxfZHApDQo+ID4gIHsNCj4gPiAt
CWlmICghZGV2X3ByaXYtPnBzci5kYzNjb19lbmFibGVkKQ0KPiA+ICsJaWYgKCFpbnRlbF9kcC0+
cHNyLmRjM2NvX2VuYWJsZWQpDQo+ID4gIAkJcmV0dXJuOw0KPiA+ICANCj4gPiAtCWNhbmNlbF9k
ZWxheWVkX3dvcmsoJmRldl9wcml2LT5wc3IuZGMzY29fd29yayk7DQo+ID4gKwljYW5jZWxfZGVs
YXllZF93b3JrKCZpbnRlbF9kcC0+cHNyLmRjM2NvX3dvcmspOw0KPiA+ICAJLyogQmVmb3JlIFBT
UjIgZXhpdCBkaXNhbGxvdyBkYzNjbyovDQo+ID4gLQl0Z2xfcHNyMl9kaXNhYmxlX2RjM2NvKGRl
dl9wcml2KTsNCj4gPiArCXRnbF9wc3IyX2Rpc2FibGVfZGMzY28oaW50ZWxfZHApOw0KPiA+ICB9
DQo+ID4gIA0KPiA+ICBzdGF0aWMgdm9pZA0KPiA+IEBAIC03MTQsNyArNzExLDcgQEAgc3RhdGlj
IGJvb2wgaW50ZWxfcHNyMl9jb25maWdfdmFsaWQoc3RydWN0DQo+ID4gaW50ZWxfZHAgKmludGVs
X2RwLA0KPiA+ICAJaW50IGNydGNfdmRpc3BsYXkgPSBjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9t
b2RlLmNydGNfdmRpc3BsYXk7DQo+ID4gIAlpbnQgcHNyX21heF9oID0gMCwgcHNyX21heF92ID0g
MCwgbWF4X2JwcCA9IDA7DQo+ID4gIA0KPiA+IC0JaWYgKCFkZXZfcHJpdi0+cHNyLnNpbmtfcHNy
Ml9zdXBwb3J0KQ0KPiA+ICsJaWYgKCFpbnRlbF9kcC0+cHNyLnNpbmtfcHNyMl9zdXBwb3J0KQ0K
PiA+ICAJCXJldHVybiBmYWxzZTsNCj4gPiAgDQo+ID4gIAlpZiAoIXRyYW5zY29kZXJfaGFzX3Bz
cjIoZGV2X3ByaXYsIGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyKSkgDQo+ID4gew0KPiA+IEBA
IC03MjQsNyArNzIxLDcgQEAgc3RhdGljIGJvb2wgaW50ZWxfcHNyMl9jb25maWdfdmFsaWQoc3Ry
dWN0DQo+ID4gaW50ZWxfZHAgKmludGVsX2RwLA0KPiA+ICAJCXJldHVybiBmYWxzZTsNCj4gPiAg
CX0NCj4gPiAgDQo+ID4gLQlpZiAoIXBzcjJfZ2xvYmFsX2VuYWJsZWQoZGV2X3ByaXYpKSB7DQo+
ID4gKwlpZiAoIXBzcjJfZ2xvYmFsX2VuYWJsZWQoaW50ZWxfZHApKSB7DQo+ID4gIAkJZHJtX2Ri
Z19rbXMoJmRldl9wcml2LT5kcm0sICJQU1IyIGRpc2FibGVkIGJ5IGZsYWdcbiIpOw0KPiA+ICAJ
CXJldHVybiBmYWxzZTsNCj4gPiAgCX0NCj4gPiBAQCAtNzczLDEwICs3NzAsMTAgQEAgc3RhdGlj
IGJvb2wgaW50ZWxfcHNyMl9jb25maWdfdmFsaWQoc3RydWN0DQo+ID4gaW50ZWxfZHAgKmludGVs
X2RwLA0KPiA+ICAJICogb25seSBuZWVkIHRvIHZhbGlkYXRlIHRoZSBTVSBibG9jayB3aWR0aCBp
cyBhIG11bHRpcGxlIG9mDQo+ID4gIAkgKiB4IGdyYW51bGFyaXR5Lg0KPiA+ICAJICovDQo+ID4g
LQlpZiAoY3J0Y19oZGlzcGxheSAlIGRldl9wcml2LT5wc3Iuc3VfeF9ncmFudWxhcml0eSkgew0K
PiA+ICsJaWYgKGNydGNfaGRpc3BsYXkgJSBpbnRlbF9kcC0+cHNyLnN1X3hfZ3JhbnVsYXJpdHkp
IHsNCj4gPiAgCQlkcm1fZGJnX2ttcygmZGV2X3ByaXYtPmRybSwNCj4gPiAgCQkJICAgICJQU1Iy
IG5vdCBlbmFibGVkLCBoZGlzcGxheSglZCkgbm90DQo+ID4gbXVsdGlwbGUgb2YgJWRcbiIsDQo+
ID4gLQkJCSAgICBjcnRjX2hkaXNwbGF5LCBkZXZfcHJpdi0NCj4gPiA+cHNyLnN1X3hfZ3JhbnVs
YXJpdHkpOw0KPiA+ICsJCQkgICAgY3J0Y19oZGlzcGxheSwgaW50ZWxfZHAtDQo+ID4gPnBzci5z
dV94X2dyYW51bGFyaXR5KTsNCj4gPiAgCQlyZXR1cm4gZmFsc2U7DQo+ID4gIAl9DQo+ID4gIA0K
PiA+IEBAIC04MTEsMzAgKzgwOCwyNSBAQCB2b2lkIGludGVsX3Bzcl9jb21wdXRlX2NvbmZpZyhz
dHJ1Y3QgaW50ZWxfZHANCj4gPiAqaW50ZWxfZHAsDQo+ID4gIAkJJmNydGNfc3RhdGUtPmh3LmFk
anVzdGVkX21vZGU7DQo+ID4gIAlpbnQgcHNyX3NldHVwX3RpbWU7DQo+ID4gIA0KPiA+IC0JaWYg
KCFDQU5fUFNSKGRldl9wcml2KSkNCj4gPiAtCQlyZXR1cm47DQo+ID4gLQ0KPiA+IC0JaWYgKGlu
dGVsX2RwICE9IGRldl9wcml2LT5wc3IuZHApDQo+ID4gKwlpZiAoIUNBTl9QU1IoaW50ZWxfZHAp
KQ0KPiA+ICAJCXJldHVybjsNCj4gPiAgDQo+ID4gLQlpZiAoIXBzcl9nbG9iYWxfZW5hYmxlZChk
ZXZfcHJpdikpIHsNCj4gPiArCWlmICghcHNyX2dsb2JhbF9lbmFibGVkKGludGVsX2RwKSkgew0K
PiA+ICAJCWRybV9kYmdfa21zKCZkZXZfcHJpdi0+ZHJtLCAiUFNSIGRpc2FibGVkIGJ5IGZsYWdc
biIpOw0KPiA+ICAJCXJldHVybjsNCj4gPiAgCX0NCj4gPiAgDQo+ID4gIAkvKg0KPiA+ICAJICog
SFNXIHNwZWMgZXhwbGljaXRseSBzYXlzIFBTUiBpcyB0aWVkIHRvIHBvcnQgQS4NCj4gPiAtCSAq
IEJEVysgcGxhdGZvcm1zIGhhdmUgYSBpbnN0YW5jZSBvZiBQU1IgcmVnaXN0ZXJzIHBlcg0KPiA+
IHRyYW5zY29kZXIgYnV0DQo+ID4gLQkgKiBmb3Igbm93IGl0IG9ubHkgc3VwcG9ydHMgb25lIGlu
c3RhbmNlIG9mIFBTUiwgc28gbGV0cyBrZWVwDQo+ID4gaXQNCj4gPiAtCSAqIGhhcmRjb2RlZCB0
byBQT1JUX0ENCj4gPiArCSAqIEJEVysgcGxhdGZvcm1zIGhhdmUgYSBpbnN0YW5jZSBvZiBQU1Ig
cmVnaXN0ZXJzIHBlcg0KPiA+IHRyYW5zY29kZXIuDQo+ID4gIAkgKi8NCj4gPiAtCWlmIChkaWdf
cG9ydC0+YmFzZS5wb3J0ICE9IFBPUlRfQSkgew0KPiA+ICsJaWYgKElTX0hBU1dFTEwoZGV2X3By
aXYpICYmIGRpZ19wb3J0LT5iYXNlLnBvcnQgIT0gUE9SVF9BKSB7DQo+ID4gIAkJZHJtX2RiZ19r
bXMoJmRldl9wcml2LT5kcm0sDQo+ID4gIAkJCSAgICAiUFNSIGNvbmRpdGlvbiBmYWlsZWQ6IFBv
cnQgbm90DQo+ID4gc3VwcG9ydGVkXG4iKTsNCj4gPiAgCQlyZXR1cm47DQo+ID4gIAl9DQo+ID4g
IA0KPiA+IC0JaWYgKGRldl9wcml2LT5wc3Iuc2lua19ub3RfcmVsaWFibGUpIHsNCj4gPiArCWlm
IChpbnRlbF9kcC0+cHNyLnNpbmtfbm90X3JlbGlhYmxlKSB7DQo+ID4gIAkJZHJtX2RiZ19rbXMo
JmRldl9wcml2LT5kcm0sDQo+ID4gIAkJCSAgICAiUFNSIHNpbmsgaW1wbGVtZW50YXRpb24gaXMg
bm90DQo+ID4gcmVsaWFibGVcbiIpOw0KPiA+ICAJCXJldHVybjsNCj4gPiBAQCAtODcwLDIzICs4
NjIsMjQgQEAgdm9pZCBpbnRlbF9wc3JfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2RwDQo+
ID4gKmludGVsX2RwLA0KPiA+ICBzdGF0aWMgdm9pZCBpbnRlbF9wc3JfYWN0aXZhdGUoc3RydWN0
IGludGVsX2RwICppbnRlbF9kcCkNCj4gPiAgew0KPiA+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7DQo+ID4gKwllbnVtIHRyYW5zY29k
ZXIgdHJhbnNjb2RlciA9IGludGVsX2RwLT5wc3IudHJhbnNjb2RlcjsNCj4gPiAgDQo+ID4gLQlp
ZiAodHJhbnNjb2Rlcl9oYXNfcHNyMihkZXZfcHJpdiwgZGV2X3ByaXYtPnBzci50cmFuc2NvZGVy
KSkNCj4gPiArCWlmICh0cmFuc2NvZGVyX2hhc19wc3IyKGRldl9wcml2LCB0cmFuc2NvZGVyKSkN
Cj4gPiAgCQlkcm1fV0FSTl9PTigmZGV2X3ByaXYtPmRybSwNCj4gPiAtCQkJICAgIGludGVsX2Rl
X3JlYWQoZGV2X3ByaXYsDQo+ID4gRURQX1BTUjJfQ1RMKGRldl9wcml2LT5wc3IudHJhbnNjb2Rl
cikpICYgRURQX1BTUjJfRU5BQkxFKTsNCj4gPiArCQkJICAgIGludGVsX2RlX3JlYWQoZGV2X3By
aXYsDQo+ID4gRURQX1BTUjJfQ1RMKHRyYW5zY29kZXIpKSAmIEVEUF9QU1IyX0VOQUJMRSk7DQo+
ID4gIA0KPiA+ICAJZHJtX1dBUk5fT04oJmRldl9wcml2LT5kcm0sDQo+ID4gLQkJICAgIGludGVs
X2RlX3JlYWQoZGV2X3ByaXYsIEVEUF9QU1JfQ1RMKGRldl9wcml2LQ0KPiA+ID5wc3IudHJhbnNj
b2RlcikpICYgRURQX1BTUl9FTkFCTEUpOw0KPiA+IC0JZHJtX1dBUk5fT04oJmRldl9wcml2LT5k
cm0sIGRldl9wcml2LT5wc3IuYWN0aXZlKTsNCj4gPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRl
dl9wcml2LT5wc3IubG9jayk7DQo+ID4gKwkJICAgIGludGVsX2RlX3JlYWQoZGV2X3ByaXYsIEVE
UF9QU1JfQ1RMKHRyYW5zY29kZXIpKSAmDQo+ID4gRURQX1BTUl9FTkFCTEUpOw0KPiA+ICsJZHJt
X1dBUk5fT04oJmRldl9wcml2LT5kcm0sIGludGVsX2RwLT5wc3IuYWN0aXZlKTsNCj4gPiArCWxv
Y2tkZXBfYXNzZXJ0X2hlbGQoJmludGVsX2RwLT5wc3IubG9jayk7DQo+ID4gIA0KPiA+ICAJLyog
cHNyMSBhbmQgcHNyMiBhcmUgbXV0dWFsbHkgZXhjbHVzaXZlLiovDQo+ID4gLQlpZiAoZGV2X3By
aXYtPnBzci5wc3IyX2VuYWJsZWQpDQo+ID4gKwlpZiAoaW50ZWxfZHAtPnBzci5wc3IyX2VuYWJs
ZWQpDQo+ID4gIAkJaHN3X2FjdGl2YXRlX3BzcjIoaW50ZWxfZHApOw0KPiA+ICAJZWxzZQ0KPiA+
ICAJCWhzd19hY3RpdmF0ZV9wc3IxKGludGVsX2RwKTsNCj4gPiAgDQo+ID4gLQlkZXZfcHJpdi0+
cHNyLmFjdGl2ZSA9IHRydWU7DQo+ID4gKwlpbnRlbF9kcC0+cHNyLmFjdGl2ZSA9IHRydWU7DQo+
ID4gIH0NCj4gPiAgDQo+ID4gIHN0YXRpYyB2b2lkIGludGVsX3Bzcl9lbmFibGVfc291cmNlKHN0
cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsDQo+ID4gQEAgLTkwMiw3ICs4OTUsNyBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9wc3JfZW5hYmxlX3NvdXJjZShzdHJ1Y3QNCj4gPiBpbnRlbF9kcCAqaW50ZWxf
ZHAsDQo+ID4gIAlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgfHwgSVNfQlJPQURXRUxMKGRldl9w
cml2KSkNCj4gPiAgCQloc3dfcHNyX3NldHVwX2F1eChpbnRlbF9kcCk7DQo+ID4gIA0KPiA+IC0J
aWYgKGRldl9wcml2LT5wc3IucHNyMl9lbmFibGVkICYmIChJU19HRU4oZGV2X3ByaXYsIDkpICYm
DQo+ID4gKwlpZiAoaW50ZWxfZHAtPnBzci5wc3IyX2VuYWJsZWQgJiYgKElTX0dFTihkZXZfcHJp
diwgOSkgJiYNCj4gPiAgCQkJCQkgICAhSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpKSB7DQo+ID4g
IAkJaTkxNV9yZWdfdCByZWcgPSBDSElDS0VOX1RSQU5TKGNwdV90cmFuc2NvZGVyKTsNCj4gPiAg
CQl1MzIgY2hpY2tlbiA9IGludGVsX2RlX3JlYWQoZGV2X3ByaXYsIHJlZyk7DQo+ID4gQEAgLTky
NiwxMCArOTE5LDEwIEBAIHN0YXRpYyB2b2lkIGludGVsX3Bzcl9lbmFibGVfc291cmNlKHN0cnVj
dA0KPiA+IGludGVsX2RwICppbnRlbF9kcCwNCj4gPiAgCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
IDwgMTEpDQo+ID4gIAkJbWFzayB8PSBFRFBfUFNSX0RFQlVHX01BU0tfRElTUF9SRUdfV1JJVEU7
DQo+ID4gIA0KPiA+IC0JaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIEVEUF9QU1JfREVCVUcoZGV2
X3ByaXYtDQo+ID4gPnBzci50cmFuc2NvZGVyKSwNCj4gPiArCWludGVsX2RlX3dyaXRlKGRldl9w
cml2LCBFRFBfUFNSX0RFQlVHKGludGVsX2RwLQ0KPiA+ID5wc3IudHJhbnNjb2RlciksDQo+ID4g
IAkJICAgICAgIG1hc2spOw0KPiA+ICANCj4gPiAtCXBzcl9pcnFfY29udHJvbChkZXZfcHJpdik7
DQo+ID4gKwlwc3JfaXJxX2NvbnRyb2woaW50ZWxfZHApOw0KPiA+ICANCj4gPiAgCWlmIChjcnRj
X3N0YXRlLT5kYzNjb19leGl0bGluZSkgew0KPiA+ICAJCXUzMiB2YWw7DQo+ID4gQEAgLTk0Nywz
MCArOTQwLDMwIEBAIHN0YXRpYyB2b2lkIGludGVsX3Bzcl9lbmFibGVfc291cmNlKHN0cnVjdA0K
PiA+IGludGVsX2RwICppbnRlbF9kcCwNCj4gPiAgDQo+ID4gIAlpZiAoSEFTX1BTUl9IV19UUkFD
S0lORyhkZXZfcHJpdikgJiYNCj4gPiBIQVNfUFNSMl9TRUxfRkVUQ0goZGV2X3ByaXYpKQ0KPiA+
ICAJCWludGVsX2RlX3JtdyhkZXZfcHJpdiwgQ0hJQ0tFTl9QQVIxXzEsDQo+ID4gSUdOT1JFX1BT
UjJfSFdfVFJBQ0tJTkcsDQo+ID4gLQkJCSAgICAgZGV2X3ByaXYtPnBzci5wc3IyX3NlbF9mZXRj
aF9lbmFibGVkID8NCj4gPiArCQkJICAgICBpbnRlbF9kcC0+cHNyLnBzcjJfc2VsX2ZldGNoX2Vu
YWJsZWQgPw0KPiA+ICAJCQkgICAgIElHTk9SRV9QU1IyX0hXX1RSQUNLSU5HIDogMCk7DQo+ID4g
IH0NCj4gPiAgDQo+ID4gLXN0YXRpYyB2b2lkIGludGVsX3Bzcl9lbmFibGVfbG9ja2VkKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlDQo+ID4gKmRldl9wcml2LA0KPiA+ICtzdGF0aWMgdm9pZCBpbnRl
bF9wc3JfZW5hYmxlX2xvY2tlZChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLA0KPiA+ICAJCQkJ
ICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlDQo+ID4gKmNydGNfc3RhdGUsDQo+ID4g
IAkJCQkgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUNCj4gPiAqY29ubl9zdGF0
ZSkNCj4gPiAgew0KPiA+IC0Jc3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9IGRldl9wcml2LT5w
c3IuZHA7DQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19p
OTE1KGludGVsX2RwKTsNCj4gPiAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0
ID0gZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApOw0KPiA+ICAJc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIgPSAmZGlnX3BvcnQtPmJhc2U7DQo+ID4gIAl1MzIgdmFsOw0KPiA+ICANCj4gPiAt
CWRybV9XQVJOX09OKCZkZXZfcHJpdi0+ZHJtLCBkZXZfcHJpdi0+cHNyLmVuYWJsZWQpOw0KPiA+
ICsJZHJtX1dBUk5fT04oJmRldl9wcml2LT5kcm0sIGludGVsX2RwLT5wc3IuZW5hYmxlZCk7DQo+
ID4gIA0KPiA+IC0JZGV2X3ByaXYtPnBzci5wc3IyX2VuYWJsZWQgPSBjcnRjX3N0YXRlLT5oYXNf
cHNyMjsNCj4gPiAtCWRldl9wcml2LT5wc3IuYnVzeV9mcm9udGJ1ZmZlcl9iaXRzID0gMDsNCj4g
PiAtCWRldl9wcml2LT5wc3IucGlwZSA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5j
cnRjKS0NCj4gPiA+cGlwZTsNCj4gPiAtCWRldl9wcml2LT5wc3IuZGMzY29fZW5hYmxlZCA9ICEh
Y3J0Y19zdGF0ZS0+ZGMzY29fZXhpdGxpbmU7DQo+ID4gLQlkZXZfcHJpdi0+cHNyLnRyYW5zY29k
ZXIgPSBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcjsNCj4gPiArCWludGVsX2RwLT5wc3IucHNy
Ml9lbmFibGVkID0gY3J0Y19zdGF0ZS0+aGFzX3BzcjI7DQo+ID4gKwlpbnRlbF9kcC0+cHNyLmJ1
c3lfZnJvbnRidWZmZXJfYml0cyA9IDA7DQo+ID4gKwlpbnRlbF9kcC0+cHNyLnBpcGUgPSB0b19p
bnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0YyktDQo+ID4gPnBpcGU7DQo+ID4gKwlpbnRl
bF9kcC0+cHNyLmRjM2NvX2VuYWJsZWQgPSAhIWNydGNfc3RhdGUtPmRjM2NvX2V4aXRsaW5lOw0K
PiA+ICsJaW50ZWxfZHAtPnBzci50cmFuc2NvZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29k
ZXI7DQo+ID4gIAkvKiBEQzUvREM2IHJlcXVpcmVzIGF0IGxlYXN0IDYgaWRsZSBmcmFtZXMgKi8N
Cj4gPiAgCXZhbCA9IHVzZWNzX3RvX2ppZmZpZXMoaW50ZWxfZ2V0X2ZyYW1lX3RpbWVfdXMoY3J0
Y19zdGF0ZSkgKg0KPiA+IDYpOw0KPiA+IC0JZGV2X3ByaXYtPnBzci5kYzNjb19leGl0X2RlbGF5
ID0gdmFsOw0KPiA+IC0JZGV2X3ByaXYtPnBzci5wc3IyX3NlbF9mZXRjaF9lbmFibGVkID0gY3J0
Y19zdGF0ZS0NCj4gPiA+ZW5hYmxlX3BzcjJfc2VsX2ZldGNoOw0KPiA+ICsJaW50ZWxfZHAtPnBz
ci5kYzNjb19leGl0X2RlbGF5ID0gdmFsOw0KPiA+ICsJaW50ZWxfZHAtPnBzci5wc3IyX3NlbF9m
ZXRjaF9lbmFibGVkID0gY3J0Y19zdGF0ZS0NCj4gPiA+ZW5hYmxlX3BzcjJfc2VsX2ZldGNoOw0K
PiA+ICANCj4gPiAgCS8qDQo+ID4gIAkgKiBJZiBhIFBTUiBlcnJvciBoYXBwZW5lZCBhbmQgdGhl
IGRyaXZlciBpcyByZWxvYWRlZCwgdGhlDQo+ID4gRURQX1BTUl9JSVINCj4gPiBAQCAtOTgyLDI3
ICs5NzUsMjcgQEAgc3RhdGljIHZvaWQgaW50ZWxfcHNyX2VuYWJsZV9sb2NrZWQoc3RydWN0DQo+
ID4gZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsDQo+ID4gIAkgKi8NCj4gPiAgCWlmIChJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDEyKSB7DQo+ID4gIAkJdmFsID0gaW50ZWxfZGVfcmVhZChkZXZf
cHJpdiwNCj4gPiAtCQkJCSAgICBUUkFOU19QU1JfSUlSKGRldl9wcml2LQ0KPiA+ID5wc3IudHJh
bnNjb2RlcikpOw0KPiA+ICsJCQkJICAgIFRSQU5TX1BTUl9JSVIoaW50ZWxfZHAtDQo+ID4gPnBz
ci50cmFuc2NvZGVyKSk7DQo+ID4gIAkJdmFsICY9IEVEUF9QU1JfRVJST1IoMCk7DQo+ID4gIAl9
IGVsc2Ugew0KPiA+ICAJCXZhbCA9IGludGVsX2RlX3JlYWQoZGV2X3ByaXYsIEVEUF9QU1JfSUlS
KTsNCj4gPiAtCQl2YWwgJj0gRURQX1BTUl9FUlJPUihkZXZfcHJpdi0+cHNyLnRyYW5zY29kZXIp
Ow0KPiA+ICsJCXZhbCAmPSBFRFBfUFNSX0VSUk9SKGludGVsX2RwLT5wc3IudHJhbnNjb2Rlcik7
DQo+ID4gIAl9DQo+ID4gIAlpZiAodmFsKSB7DQo+ID4gLQkJZGV2X3ByaXYtPnBzci5zaW5rX25v
dF9yZWxpYWJsZSA9IHRydWU7DQo+ID4gKwkJaW50ZWxfZHAtPnBzci5zaW5rX25vdF9yZWxpYWJs
ZSA9IHRydWU7DQo+ID4gIAkJZHJtX2RiZ19rbXMoJmRldl9wcml2LT5kcm0sDQo+ID4gIAkJCSAg
ICAiUFNSIGludGVycnVwdGlvbiBlcnJvciBzZXQsIG5vdCBlbmFibGluZw0KPiA+IFBTUlxuIik7
DQo+ID4gIAkJcmV0dXJuOw0KPiA+ICAJfQ0KPiA+ICANCj4gPiAgCWRybV9kYmdfa21zKCZkZXZf
cHJpdi0+ZHJtLCAiRW5hYmxpbmcgUFNSJXNcbiIsDQo+ID4gLQkJICAgIGRldl9wcml2LT5wc3Iu
cHNyMl9lbmFibGVkID8gIjIiIDogIjEiKTsNCj4gPiArCQkgICAgaW50ZWxfZHAtPnBzci5wc3Iy
X2VuYWJsZWQgPyAiMiIgOiAiMSIpOw0KPiA+ICAJaW50ZWxfZHBfY29tcHV0ZV9wc3JfdnNjX3Nk
cChpbnRlbF9kcCwgY3J0Y19zdGF0ZSwgY29ubl9zdGF0ZSwNCj4gPiAtCQkJCSAgICAgJmRldl9w
cml2LT5wc3IudnNjKTsNCj4gPiAtCWludGVsX3dyaXRlX2RwX3ZzY19zZHAoZW5jb2RlciwgY3J0
Y19zdGF0ZSwgJmRldl9wcml2LQ0KPiA+ID5wc3IudnNjKTsNCj4gPiArCQkJCSAgICAgJmludGVs
X2RwLT5wc3IudnNjKTsNCj4gPiArCWludGVsX3dyaXRlX2RwX3ZzY19zZHAoZW5jb2RlciwgY3J0
Y19zdGF0ZSwgJmludGVsX2RwLQ0KPiA+ID5wc3IudnNjKTsNCj4gPiAgCWludGVsX3Bzcl9lbmFi
bGVfc2luayhpbnRlbF9kcCk7DQo+ID4gIAlpbnRlbF9wc3JfZW5hYmxlX3NvdXJjZShpbnRlbF9k
cCwgY3J0Y19zdGF0ZSk7DQo+ID4gLQlkZXZfcHJpdi0+cHNyLmVuYWJsZWQgPSB0cnVlOw0KPiA+
ICsJaW50ZWxfZHAtPnBzci5lbmFibGVkID0gdHJ1ZTsNCj4gPiAgDQo+ID4gIAlpbnRlbF9wc3Jf
YWN0aXZhdGUoaW50ZWxfZHApOw0KPiA+ICB9DQo+ID4gQEAgLTEwMjEsNyArMTAxNCw3IEBAIHZv
aWQgaW50ZWxfcHNyX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZHANCj4gPiAqaW50ZWxfZHAsDQo+ID4g
IHsNCj4gPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUo
aW50ZWxfZHApOw0KPiA+ICANCj4gPiAtCWlmICghQ0FOX1BTUihkZXZfcHJpdikgfHwgZGV2X3By
aXYtPnBzci5kcCAhPSBpbnRlbF9kcCkNCj4gPiArCWlmICghQ0FOX1BTUihpbnRlbF9kcCkpDQo+
ID4gIAkJcmV0dXJuOw0KPiA+ICANCj4gPiAgCWlmICghY3J0Y19zdGF0ZS0+aGFzX3BzcikNCj4g
PiBAQCAtMTAyOSw0NiArMTAyMiw0NyBAQCB2b2lkIGludGVsX3Bzcl9lbmFibGUoc3RydWN0IGlu
dGVsX2RwDQo+ID4gKmludGVsX2RwLA0KPiA+ICANCj4gPiAgCWRybV9XQVJOX09OKCZkZXZfcHJp
di0+ZHJtLCBkZXZfcHJpdi0+ZHJycy5kcCk7DQo+ID4gIA0KPiA+IC0JbXV0ZXhfbG9jaygmZGV2
X3ByaXYtPnBzci5sb2NrKTsNCj4gPiAtCWludGVsX3Bzcl9lbmFibGVfbG9ja2VkKGRldl9wcml2
LCBjcnRjX3N0YXRlLCBjb25uX3N0YXRlKTsNCj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYt
PnBzci5sb2NrKTsNCj4gPiArCW11dGV4X2xvY2soJmludGVsX2RwLT5wc3IubG9jayk7DQo+ID4g
KwlpbnRlbF9wc3JfZW5hYmxlX2xvY2tlZChpbnRlbF9kcCwgY3J0Y19zdGF0ZSwgY29ubl9zdGF0
ZSk7DQo+ID4gKwltdXRleF91bmxvY2soJmludGVsX2RwLT5wc3IubG9jayk7DQo+ID4gIH0NCj4g
PiAgDQo+ID4gLXN0YXRpYyB2b2lkIGludGVsX3Bzcl9leGl0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikNCj4gPiArc3RhdGljIHZvaWQgaW50ZWxfcHNyX2V4aXQoc3RydWN0IGlu
dGVsX2RwICppbnRlbF9kcCkNCj4gPiAgew0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7DQo+ID4gIAl1MzIgdmFsOw0KPiA+ICAN
Cj4gPiAtCWlmICghZGV2X3ByaXYtPnBzci5hY3RpdmUpIHsNCj4gPiAtCQlpZiAodHJhbnNjb2Rl
cl9oYXNfcHNyMihkZXZfcHJpdiwgZGV2X3ByaXYtDQo+ID4gPnBzci50cmFuc2NvZGVyKSkgew0K
PiA+ICsJaWYgKCFpbnRlbF9kcC0+cHNyLmFjdGl2ZSkgew0KPiA+ICsJCWlmICh0cmFuc2NvZGVy
X2hhc19wc3IyKGRldl9wcml2LCBpbnRlbF9kcC0NCj4gPiA+cHNyLnRyYW5zY29kZXIpKSB7DQo+
ID4gIAkJCXZhbCA9IGludGVsX2RlX3JlYWQoZGV2X3ByaXYsDQo+ID4gLQkJCQkJICAgIEVEUF9Q
U1IyX0NUTChkZXZfcHJpdi0NCj4gPiA+cHNyLnRyYW5zY29kZXIpKTsNCj4gPiArCQkJCQkgICAg
RURQX1BTUjJfQ1RMKGludGVsX2RwLQ0KPiA+ID5wc3IudHJhbnNjb2RlcikpOw0KPiA+ICAJCQlk
cm1fV0FSTl9PTigmZGV2X3ByaXYtPmRybSwgdmFsICYNCj4gPiBFRFBfUFNSMl9FTkFCTEUpOw0K
PiA+ICAJCX0NCj4gPiAgDQo+ID4gIAkJdmFsID0gaW50ZWxfZGVfcmVhZChkZXZfcHJpdiwNCj4g
PiAtCQkJCSAgICBFRFBfUFNSX0NUTChkZXZfcHJpdi0NCj4gPiA+cHNyLnRyYW5zY29kZXIpKTsN
Cj4gPiArCQkJCSAgICBFRFBfUFNSX0NUTChpbnRlbF9kcC0NCj4gPiA+cHNyLnRyYW5zY29kZXIp
KTsNCj4gPiAgCQlkcm1fV0FSTl9PTigmZGV2X3ByaXYtPmRybSwgdmFsICYgRURQX1BTUl9FTkFC
TEUpOw0KPiA+ICANCj4gPiAgCQlyZXR1cm47DQo+ID4gIAl9DQo+ID4gIA0KPiA+IC0JaWYgKGRl
dl9wcml2LT5wc3IucHNyMl9lbmFibGVkKSB7DQo+ID4gLQkJdGdsX2Rpc2FsbG93X2RjM2NvX29u
X3BzcjJfZXhpdChkZXZfcHJpdik7DQo+ID4gKwlpZiAoaW50ZWxfZHAtPnBzci5wc3IyX2VuYWJs
ZWQpIHsNCj4gPiArCQl0Z2xfZGlzYWxsb3dfZGMzY29fb25fcHNyMl9leGl0KGludGVsX2RwKTsN
Cj4gPiAgCQl2YWwgPSBpbnRlbF9kZV9yZWFkKGRldl9wcml2LA0KPiA+IC0JCQkJICAgIEVEUF9Q
U1IyX0NUTChkZXZfcHJpdi0NCj4gPiA+cHNyLnRyYW5zY29kZXIpKTsNCj4gPiArCQkJCSAgICBF
RFBfUFNSMl9DVEwoaW50ZWxfZHAtDQo+ID4gPnBzci50cmFuc2NvZGVyKSk7DQo+ID4gIAkJZHJt
X1dBUk5fT04oJmRldl9wcml2LT5kcm0sICEodmFsICYgRURQX1BTUjJfRU5BQkxFKSk7DQo+ID4g
IAkJdmFsICY9IH5FRFBfUFNSMl9FTkFCTEU7DQo+ID4gIAkJaW50ZWxfZGVfd3JpdGUoZGV2X3By
aXYsDQo+ID4gLQkJCSAgICAgICBFRFBfUFNSMl9DVEwoZGV2X3ByaXYtPnBzci50cmFuc2NvZGVy
KSwNCj4gPiB2YWwpOw0KPiA+ICsJCQkgICAgICAgRURQX1BTUjJfQ1RMKGludGVsX2RwLT5wc3Iu
dHJhbnNjb2RlciksDQo+ID4gdmFsKTsNCj4gPiAgCX0gZWxzZSB7DQo+ID4gIAkJdmFsID0gaW50
ZWxfZGVfcmVhZChkZXZfcHJpdiwNCj4gPiAtCQkJCSAgICBFRFBfUFNSX0NUTChkZXZfcHJpdi0N
Cj4gPiA+cHNyLnRyYW5zY29kZXIpKTsNCj4gPiArCQkJCSAgICBFRFBfUFNSX0NUTChpbnRlbF9k
cC0NCj4gPiA+cHNyLnRyYW5zY29kZXIpKTsNCj4gPiAgCQlkcm1fV0FSTl9PTigmZGV2X3ByaXYt
PmRybSwgISh2YWwgJiBFRFBfUFNSX0VOQUJMRSkpOw0KPiA+ICAJCXZhbCAmPSB+RURQX1BTUl9F
TkFCTEU7DQo+ID4gIAkJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsDQo+ID4gLQkJCSAgICAgICBF
RFBfUFNSX0NUTChkZXZfcHJpdi0+cHNyLnRyYW5zY29kZXIpLA0KPiA+IHZhbCk7DQo+ID4gKwkJ
CSAgICAgICBFRFBfUFNSX0NUTChpbnRlbF9kcC0+cHNyLnRyYW5zY29kZXIpLA0KPiA+IHZhbCk7
DQo+ID4gIAl9DQo+ID4gLQlkZXZfcHJpdi0+cHNyLmFjdGl2ZSA9IGZhbHNlOw0KPiA+ICsJaW50
ZWxfZHAtPnBzci5hY3RpdmUgPSBmYWxzZTsNCj4gPiAgfQ0KPiA+ICANCj4gPiAgc3RhdGljIHZv
aWQgaW50ZWxfcHNyX2Rpc2FibGVfbG9ja2VkKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApDQo+
ID4gQEAgLTEwNzcsMjEgKzEwNzEsMjEgQEAgc3RhdGljIHZvaWQgaW50ZWxfcHNyX2Rpc2FibGVf
bG9ja2VkKHN0cnVjdA0KPiA+IGludGVsX2RwICppbnRlbF9kcCkNCj4gPiAgCWk5MTVfcmVnX3Qg
cHNyX3N0YXR1czsNCj4gPiAgCXUzMiBwc3Jfc3RhdHVzX21hc2s7DQo+ID4gIA0KPiA+IC0JbG9j
a2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPnBzci5sb2NrKTsNCj4gPiArCWxvY2tkZXBfYXNz
ZXJ0X2hlbGQoJmludGVsX2RwLT5wc3IubG9jayk7DQo+ID4gIA0KPiA+IC0JaWYgKCFkZXZfcHJp
di0+cHNyLmVuYWJsZWQpDQo+ID4gKwlpZiAoIWludGVsX2RwLT5wc3IuZW5hYmxlZCkNCj4gPiAg
CQlyZXR1cm47DQo+ID4gIA0KPiA+ICAJZHJtX2RiZ19rbXMoJmRldl9wcml2LT5kcm0sICJEaXNh
YmxpbmcgUFNSJXNcbiIsDQo+ID4gLQkJICAgIGRldl9wcml2LT5wc3IucHNyMl9lbmFibGVkID8g
IjIiIDogIjEiKTsNCj4gPiArCQkgICAgaW50ZWxfZHAtPnBzci5wc3IyX2VuYWJsZWQgPyAiMiIg
OiAiMSIpOw0KPiA+ICANCj4gPiAtCWludGVsX3Bzcl9leGl0KGRldl9wcml2KTsNCj4gPiArCWlu
dGVsX3Bzcl9leGl0KGludGVsX2RwKTsNCj4gPiAgDQo+ID4gLQlpZiAoZGV2X3ByaXYtPnBzci5w
c3IyX2VuYWJsZWQpIHsNCj4gPiAtCQlwc3Jfc3RhdHVzID0gRURQX1BTUjJfU1RBVFVTKGRldl9w
cml2LT5wc3IudHJhbnNjb2Rlcik7DQo+ID4gKwlpZiAoaW50ZWxfZHAtPnBzci5wc3IyX2VuYWJs
ZWQpIHsNCj4gPiArCQlwc3Jfc3RhdHVzID0gRURQX1BTUjJfU1RBVFVTKGludGVsX2RwLT5wc3Iu
dHJhbnNjb2Rlcik7DQo+ID4gIAkJcHNyX3N0YXR1c19tYXNrID0gRURQX1BTUjJfU1RBVFVTX1NU
QVRFX01BU0s7DQo+ID4gIAl9IGVsc2Ugew0KPiA+IC0JCXBzcl9zdGF0dXMgPSBFRFBfUFNSX1NU
QVRVUyhkZXZfcHJpdi0+cHNyLnRyYW5zY29kZXIpOw0KPiA+ICsJCXBzcl9zdGF0dXMgPSBFRFBf
UFNSX1NUQVRVUyhpbnRlbF9kcC0+cHNyLnRyYW5zY29kZXIpOw0KPiA+ICAJCXBzcl9zdGF0dXNf
bWFzayA9IEVEUF9QU1JfU1RBVFVTX1NUQVRFX01BU0s7DQo+ID4gIAl9DQo+ID4gIA0KPiA+IEBA
IC0xMTAxLDcgKzEwOTUsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wc3JfZGlzYWJsZV9sb2NrZWQo
c3RydWN0DQo+ID4gaW50ZWxfZHAgKmludGVsX2RwKQ0KPiA+ICAJCWRybV9lcnIoJmRldl9wcml2
LT5kcm0sICJUaW1lZCBvdXQgd2FpdGluZyBQU1IgaWRsZQ0KPiA+IHN0YXRlXG4iKTsNCj4gPiAg
DQo+ID4gIAkvKiBXQSAxNDA4MzMwODQ3ICovDQo+ID4gLQlpZiAoZGV2X3ByaXYtPnBzci5wc3Iy
X3NlbF9mZXRjaF9lbmFibGVkICYmDQo+ID4gKwlpZiAoaW50ZWxfZHAtPnBzci5wc3IyX3NlbF9m
ZXRjaF9lbmFibGVkICYmDQo+ID4gIAkgICAgKElTX1RHTF9ESVNQX1JFVklEKGRldl9wcml2LCBU
R0xfUkVWSURfQTAsIFRHTF9SRVZJRF9BMCkgfHwNCj4gPiAgCSAgICAgSVNfUktMX1JFVklEKGRl
dl9wcml2LCBSS0xfUkVWSURfQTAsIFJLTF9SRVZJRF9BMCkpKQ0KPiA+ICAJCWludGVsX2RlX3Jt
dyhkZXZfcHJpdiwgQ0hJQ0tFTl9QQVIxXzEsDQo+ID4gQEAgLTExMTAsMTAgKzExMDQsMTAgQEAg
c3RhdGljIHZvaWQgaW50ZWxfcHNyX2Rpc2FibGVfbG9ja2VkKHN0cnVjdA0KPiA+IGludGVsX2Rw
ICppbnRlbF9kcCkNCj4gPiAgCS8qIERpc2FibGUgUFNSIG9uIFNpbmsgKi8NCj4gPiAgCWRybV9k
cF9kcGNkX3dyaXRlYigmaW50ZWxfZHAtPmF1eCwgRFBfUFNSX0VOX0NGRywgMCk7DQo+ID4gIA0K
PiA+IC0JaWYgKGRldl9wcml2LT5wc3IucHNyMl9lbmFibGVkKQ0KPiA+ICsJaWYgKGludGVsX2Rw
LT5wc3IucHNyMl9lbmFibGVkKQ0KPiA+ICAJCWRybV9kcF9kcGNkX3dyaXRlYigmaW50ZWxfZHAt
PmF1eCwNCj4gPiBEUF9SRUNFSVZFUl9BTFBNX0NPTkZJRywgMCk7DQo+ID4gIA0KPiA+IC0JZGV2
X3ByaXYtPnBzci5lbmFibGVkID0gZmFsc2U7DQo+ID4gKwlpbnRlbF9kcC0+cHNyLmVuYWJsZWQg
PSBmYWxzZTsNCj4gPiAgfQ0KPiA+ICANCj4gPiAgLyoqDQo+ID4gQEAgLTExMzEsMjAgKzExMjUs
MjIgQEAgdm9pZCBpbnRlbF9wc3JfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZHANCj4gPiAqaW50ZWxf
ZHAsDQo+ID4gIAlpZiAoIW9sZF9jcnRjX3N0YXRlLT5oYXNfcHNyKQ0KPiA+ICAJCXJldHVybjsN
Cj4gPiAgDQo+ID4gLQlpZiAoZHJtX1dBUk5fT04oJmRldl9wcml2LT5kcm0sICFDQU5fUFNSKGRl
dl9wcml2KSkpDQo+ID4gKwlpZiAoZHJtX1dBUk5fT04oJmRldl9wcml2LT5kcm0sICFDQU5fUFNS
KGludGVsX2RwKSkpDQo+ID4gIAkJcmV0dXJuOw0KPiA+ICANCj4gPiAtCW11dGV4X2xvY2soJmRl
dl9wcml2LT5wc3IubG9jayk7DQo+ID4gKwltdXRleF9sb2NrKCZpbnRlbF9kcC0+cHNyLmxvY2sp
Ow0KPiA+ICANCj4gPiAgCWludGVsX3Bzcl9kaXNhYmxlX2xvY2tlZChpbnRlbF9kcCk7DQo+ID4g
IA0KPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2spOw0KPiA+IC0JY2FuY2Vs
X3dvcmtfc3luYygmZGV2X3ByaXYtPnBzci53b3JrKTsNCj4gPiAtCWNhbmNlbF9kZWxheWVkX3dv
cmtfc3luYygmZGV2X3ByaXYtPnBzci5kYzNjb193b3JrKTsNCj4gPiArCW11dGV4X3VubG9jaygm
aW50ZWxfZHAtPnBzci5sb2NrKTsNCj4gPiArCWNhbmNlbF93b3JrX3N5bmMoJmludGVsX2RwLT5w
c3Iud29yayk7DQo+ID4gKwljYW5jZWxfZGVsYXllZF93b3JrX3N5bmMoJmludGVsX2RwLT5wc3Iu
ZGMzY29fd29yayk7DQo+ID4gIH0NCj4gPiAgDQo+ID4gLXN0YXRpYyB2b2lkIHBzcl9mb3JjZV9o
d190cmFja2luZ19leGl0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlDQo+ID4gKmRldl9wcml2KQ0K
PiA+ICtzdGF0aWMgdm9pZCBwc3JfZm9yY2VfaHdfdHJhY2tpbmdfZXhpdChzdHJ1Y3QgaW50ZWxf
ZHAgKmludGVsX2RwKQ0KPiA+ICB7DQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsNCj4gPiArDQo+ID4gIAlpZiAoSVNfVElHRVJM
QUtFKGRldl9wcml2KSkNCj4gPiAgCQkvKg0KPiA+ICAJCSAqIFdyaXRlcyB0byBDVVJTVVJGTElW
RSBpbiBUR0wgYXJlIGNhdXNpbmcgSU9NTVUNCj4gPiBlcnJvcnMgYW5kDQo+ID4gQEAgLTExNTgs
NyArMTE1NCw3IEBAIHN0YXRpYyB2b2lkIHBzcl9mb3JjZV9od190cmFja2luZ19leGl0KHN0cnVj
dA0KPiA+IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQ0KPiA+ICAJCSAqIFNvIHVzaW5nIHRo
aXMgd29ya2Fyb3VuZCB1bnRpbCB0aGlzIGlzc3VlIGlzIHJvb3QNCj4gPiBjYXVzZWQNCj4gPiAg
CQkgKiBhbmQgYSBiZXR0ZXIgZml4IGlzIGZvdW5kLg0KPiA+ICAJCSAqLw0KPiA+IC0JCWludGVs
X3Bzcl9leGl0KGRldl9wcml2KTsNCj4gPiArCQlpbnRlbF9wc3JfZXhpdChpbnRlbF9kcCk7DQo+
ID4gIAllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpDQo+ID4gIAkJLyoNCj4gPiAg
CQkgKiBEaXNwbGF5IFdBICMwODg0OiBza2wrDQo+ID4gQEAgLTExNjksMTMgKzExNjUsMTMgQEAg
c3RhdGljIHZvaWQNCj4gPiBwc3JfZm9yY2VfaHdfdHJhY2tpbmdfZXhpdChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpDQo+ID4gIAkJICogYnV0IGl0IG1ha2VzIG1vcmUgc2Vuc2Ug
d3JpdGUgdG8gdGhlIGN1cnJlbnQgYWN0aXZlDQo+ID4gIAkJICogcGlwZS4NCj4gPiAgCQkgKi8N
Cj4gPiAtCQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgQ1VSU1VSRkxJVkUoZGV2X3ByaXYtDQo+
ID4gPnBzci5waXBlKSwgMCk7DQo+ID4gKwkJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIENVUlNV
UkZMSVZFKGludGVsX2RwLQ0KPiA+ID5wc3IucGlwZSksIDApOw0KPiA+ICAJZWxzZQ0KPiA+ICAJ
CS8qDQo+ID4gIAkJICogQSB3cml0ZSB0byBDVVJTVVJGTElWRSBkbyBub3QgY2F1c2UgSFcgdHJh
Y2tpbmcgdG8NCj4gPiBleGl0IFBTUg0KPiA+ICAJCSAqIG9uIG9sZGVyIGdlbnMgc28gZG9pbmcg
dGhlIG1hbnVhbCBleGl0IGluc3RlYWQuDQo+ID4gIAkJICovDQo+ID4gLQkJaW50ZWxfcHNyX2V4
aXQoZGV2X3ByaXYpOw0KPiA+ICsJCWludGVsX3Bzcl9leGl0KGludGVsX2RwKTsNCj4gPiAgfQ0K
PiA+ICANCj4gPiAgdm9pZCBpbnRlbF9wc3IyX3Byb2dyYW1fcGxhbmVfc2VsX2ZldGNoKHN0cnVj
dCBpbnRlbF9wbGFuZSAqcGxhbmUsDQo+ID4gQEAgLTEyMTUsMTEgKzEyMTEsMTEgQEAgdm9pZA0K
PiA+IGludGVsX3BzcjJfcHJvZ3JhbV9wbGFuZV9zZWxfZmV0Y2goc3RydWN0IGludGVsX3BsYW5l
ICpwbGFuZSwNCj4gPiAgCWludGVsX2RlX3dyaXRlX2Z3KGRldl9wcml2LCBQTEFORV9TRUxfRkVU
Q0hfU0laRShwaXBlLCBwbGFuZS0NCj4gPiA+aWQpLCB2YWwpOw0KPiA+ICB9DQo+ID4gIA0KPiA+
IC12b2lkIGludGVsX3BzcjJfcHJvZ3JhbV90cmFuc19tYW5fdHJrX2N0bChjb25zdCBzdHJ1Y3QN
Cj4gPiBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQ0KPiA+ICt2b2lkIGludGVsX3BzcjJf
cHJvZ3JhbV90cmFuc19tYW5fdHJrX2N0bChzdHJ1Y3QgaW50ZWxfZHANCj4gPiAqaW50ZWxfZHAs
DQo+ID4gKwkJCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZQ0KPiA+ICpjcnRjX3N0
YXRlKQ0KPiA+ICB7DQo+ID4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2Ny
dGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsNCj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOw0KPiA+IC0Jc3RydWN0IGk5MTVf
cHNyICpwc3IgPSAmZGV2X3ByaXYtPnBzcjsNCj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOw0KPiA+ICsJc3RydWN0IGludGVsX3Bz
ciAqcHNyID0gJmludGVsX2RwLT5wc3I7DQo+ID4gIA0KPiA+ICAJaWYgKCFIQVNfUFNSMl9TRUxf
RkVUQ0goZGV2X3ByaXYpIHx8DQo+ID4gIAkgICAgIWNydGNfc3RhdGUtPmVuYWJsZV9wc3IyX3Nl
bF9mZXRjaCkNCj4gPiBAQCAtMTMzNiwxMyArMTMzMiwxMyBAQCB2b2lkIGludGVsX3Bzcl91cGRh
dGUoc3RydWN0IGludGVsX2RwDQo+ID4gKmludGVsX2RwLA0KPiA+ICAJCSAgICAgIGNvbnN0IHN0
cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQ0KPiA+ICB7DQo+ID4gIAlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsNCj4g
PiAtCXN0cnVjdCBpOTE1X3BzciAqcHNyID0gJmRldl9wcml2LT5wc3I7DQo+ID4gKwlzdHJ1Y3Qg
aW50ZWxfcHNyICpwc3IgPSAmaW50ZWxfZHAtPnBzcjsNCj4gPiAgCWJvb2wgZW5hYmxlLCBwc3Iy
X2VuYWJsZTsNCj4gPiAgDQo+ID4gLQlpZiAoIUNBTl9QU1IoZGV2X3ByaXYpIHx8IFJFQURfT05D
RShwc3ItPmRwKSAhPSBpbnRlbF9kcCkNCj4gPiArCWlmICghQ0FOX1BTUihpbnRlbF9kcCkpDQo+
ID4gIAkJcmV0dXJuOw0KPiA+ICANCj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5wc3IubG9j
ayk7DQo+ID4gKwltdXRleF9sb2NrKCZpbnRlbF9kcC0+cHNyLmxvY2spOw0KPiA+ICANCj4gPiAg
CWVuYWJsZSA9IGNydGNfc3RhdGUtPmhhc19wc3I7DQo+ID4gIAlwc3IyX2VuYWJsZSA9IGNydGNf
c3RhdGUtPmhhc19wc3IyOw0KPiA+IEBAIC0xMzUwLDE1ICsxMzQ2LDE1IEBAIHZvaWQgaW50ZWxf
cHNyX3VwZGF0ZShzdHJ1Y3QgaW50ZWxfZHANCj4gPiAqaW50ZWxfZHAsDQo+ID4gIAlpZiAoZW5h
YmxlID09IHBzci0+ZW5hYmxlZCAmJiBwc3IyX2VuYWJsZSA9PSBwc3ItPnBzcjJfZW5hYmxlZCkg
DQo+ID4gew0KPiA+ICAJCS8qIEZvcmNlIGEgUFNSIGV4aXQgd2hlbiBlbmFibGluZyBDUkMgdG8g
YXZvaWQgQ1JDDQo+ID4gdGltZW91dHMgKi8NCj4gPiAgCQlpZiAoY3J0Y19zdGF0ZS0+Y3JjX2Vu
YWJsZWQgJiYgcHNyLT5lbmFibGVkKQ0KPiA+IC0JCQlwc3JfZm9yY2VfaHdfdHJhY2tpbmdfZXhp
dChkZXZfcHJpdik7DQo+ID4gKwkJCXBzcl9mb3JjZV9od190cmFja2luZ19leGl0KGludGVsX2Rw
KTsNCj4gPiAgCQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgOSAmJiBwc3ItPmVuYWJs
ZWQpIHsNCj4gPiAgCQkJLyoNCj4gPiAgCQkJICogQWN0aXZhdGUgUFNSIGFnYWluIGFmdGVyIGEg
Zm9yY2UgZXhpdCB3aGVuDQo+ID4gZW5hYmxpbmcNCj4gPiAgCQkJICogQ1JDIGluIG9sZGVyIGdl
bnMNCj4gPiAgCQkJICovDQo+ID4gLQkJCWlmICghZGV2X3ByaXYtPnBzci5hY3RpdmUgJiYNCj4g
PiAtCQkJICAgICFkZXZfcHJpdi0+cHNyLmJ1c3lfZnJvbnRidWZmZXJfYml0cykNCj4gPiAtCQkJ
CXNjaGVkdWxlX3dvcmsoJmRldl9wcml2LT5wc3Iud29yayk7DQo+ID4gKwkJCWlmICghaW50ZWxf
ZHAtPnBzci5hY3RpdmUgJiYNCj4gPiArCQkJICAgICFpbnRlbF9kcC0+cHNyLmJ1c3lfZnJvbnRi
dWZmZXJfYml0cykNCj4gPiArCQkJCXNjaGVkdWxlX3dvcmsoJmludGVsX2RwLT5wc3Iud29yayk7
DQo+ID4gIAkJfQ0KPiA+ICANCj4gPiAgCQlnb3RvIHVubG9jazsNCj4gPiBAQCAtMTM2OCwzNCAr
MTM2NCwyMyBAQCB2b2lkIGludGVsX3Bzcl91cGRhdGUoc3RydWN0IGludGVsX2RwDQo+ID4gKmlu
dGVsX2RwLA0KPiA+ICAJCWludGVsX3Bzcl9kaXNhYmxlX2xvY2tlZChpbnRlbF9kcCk7DQo+ID4g
IA0KPiA+ICAJaWYgKGVuYWJsZSkNCj4gPiAtCQlpbnRlbF9wc3JfZW5hYmxlX2xvY2tlZChkZXZf
cHJpdiwgY3J0Y19zdGF0ZSwNCj4gPiBjb25uX3N0YXRlKTsNCj4gPiArCQlpbnRlbF9wc3JfZW5h
YmxlX2xvY2tlZChpbnRlbF9kcCwgY3J0Y19zdGF0ZSwNCj4gPiBjb25uX3N0YXRlKTsNCj4gPiAg
DQo+ID4gIHVubG9jazoNCj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPnBzci5sb2NrKTsN
Cj4gPiArCW11dGV4X3VubG9jaygmaW50ZWxfZHAtPnBzci5sb2NrKTsNCj4gPiAgfQ0KPiA+ICAN
Cj4gPiAgLyoqDQo+ID4gLSAqIGludGVsX3Bzcl93YWl0X2Zvcl9pZGxlIC0gd2FpdCBmb3IgUFNS
MSB0byBpZGxlDQo+ID4gLSAqIEBuZXdfY3J0Y19zdGF0ZTogbmV3IENSVEMgc3RhdGUNCj4gPiAr
ICogcHNyX3dhaXRfZm9yX2lkbGUgLSB3YWl0IGZvciBQU1IxIHRvIGlkbGUNCj4gPiArICogQGlu
dGVsX2RwOiBJbnRlbCBEUA0KPiA+ICAgKiBAb3V0X3ZhbHVlOiBQU1Igc3RhdHVzIGluIGNhc2Ug
b2YgZmFpbHVyZQ0KPiA+ICAgKg0KPiA+IC0gKiBUaGlzIGZ1bmN0aW9uIGlzIGV4cGVjdGVkIHRv
IGJlIGNhbGxlZCBmcm9tIHBpcGVfdXBkYXRlX3N0YXJ0KCkNCj4gPiB3aGVyZSBpdCBpcw0KPiA+
IC0gKiBub3QgZXhwZWN0ZWQgdG8gcmFjZSB3aXRoIFBTUiBlbmFibGUgb3IgZGlzYWJsZS4NCj4g
PiAtICoNCj4gPiAgICogUmV0dXJuczogMCBvbiBzdWNjZXNzIG9yIC1FVElNRU9VVCBpZiBQU1Ig
c3RhdHVzIGRvZXMgbm90IGlkbGUuDQo+ID4gKyAqDQo+ID4gICAqLw0KPiA+IC1pbnQgaW50ZWxf
cHNyX3dhaXRfZm9yX2lkbGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUNCj4gPiAqbmV3
X2NydGNfc3RhdGUsDQo+ID4gLQkJCSAgICB1MzIgKm91dF92YWx1ZSkNCj4gPiArc3RhdGljIGlu
dCBwc3Jfd2FpdF9mb3JfaWRsZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLCB1MzINCj4gPiAq
b3V0X3ZhbHVlKQ0KPiA+ICB7DQo+ID4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMobmV3X2NydGNfc3RhdGUtDQo+ID4gPnVhcGkuY3J0Yyk7DQo+ID4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsNCj4g
PiAtDQo+ID4gLQlpZiAoIWRldl9wcml2LT5wc3IuZW5hYmxlZCB8fCAhbmV3X2NydGNfc3RhdGUt
Pmhhc19wc3IpDQo+ID4gLQkJcmV0dXJuIDA7DQo+ID4gLQ0KPiA+IC0JLyogRklYTUU6IFVwZGF0
ZSB0aGlzIGZvciBQU1IyIGlmIHdlIG5lZWQgdG8gd2FpdCBmb3IgaWRsZSAqLw0KPiA+IC0JaWYg
KFJFQURfT05DRShkZXZfcHJpdi0+cHNyLnBzcjJfZW5hYmxlZCkpDQo+ID4gLQkJcmV0dXJuIDA7
DQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGlu
dGVsX2RwKTsNCj4gPiAgDQo+ID4gIAkvKg0KPiA+ICAJICogRnJvbSBic3BlYzogUGFuZWwgU2Vs
ZiBSZWZyZXNoIChCRFcrKQ0KPiA+IEBAIC0xNDAzLDMyICsxMzg4LDY0IEBAIGludCBpbnRlbF9w
c3Jfd2FpdF9mb3JfaWRsZShjb25zdCBzdHJ1Y3QNCj4gPiBpbnRlbF9jcnRjX3N0YXRlICpuZXdf
Y3J0Y19zdGF0ZSwNCj4gPiAgCSAqIGV4aXQgdHJhaW5pbmcgdGltZSArIDEuNSBtcyBvZiBhdXgg
Y2hhbm5lbCBoYW5kc2hha2UuIDUwIG1zDQo+ID4gaXMNCj4gPiAgCSAqIGRlZmVuc2l2ZSBlbm91
Z2ggdG8gY292ZXIgZXZlcnl0aGluZy4NCj4gPiAgCSAqLw0KPiA+IC0NCj4gPiAgCXJldHVybiBf
X2ludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLA0KPiA+IC0JCQkJCSBF
RFBfUFNSX1NUQVRVUyhkZXZfcHJpdi0NCj4gPiA+cHNyLnRyYW5zY29kZXIpLA0KPiA+ICsJCQkJ
CSBFRFBfUFNSX1NUQVRVUyhpbnRlbF9kcC0NCj4gPiA+cHNyLnRyYW5zY29kZXIpLA0KPiA+ICAJ
CQkJCSBFRFBfUFNSX1NUQVRVU19TVEFURV9NQVNLLA0KPiA+ICAJCQkJCSBFRFBfUFNSX1NUQVRV
U19TVEFURV9JRExFLCAyLA0KPiA+IDUwLA0KPiA+ICAJCQkJCSBvdXRfdmFsdWUpOw0KPiA+ICB9
DQo+ID4gIA0KPiA+IC1zdGF0aWMgYm9vbCBfX3Bzcl93YWl0X2Zvcl9pZGxlX2xvY2tlZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZQ0KPiA+ICpkZXZfcHJpdikNCj4gPiArLyoqDQo+ID4gKyAqIGlu
dGVsX3Bzcl93YWl0X2Zvcl9pZGxlIC0gd2FpdCBmb3IgUFNSMSB0byBpZGxlDQo+ID4gKyAqIEBu
ZXdfY3J0Y19zdGF0ZTogbmV3IENSVEMgc3RhdGUNCj4gPiArICoNCj4gPiArICogVGhpcyBmdW5j
dGlvbiBpcyBleHBlY3RlZCB0byBiZSBjYWxsZWQgZnJvbSBwaXBlX3VwZGF0ZV9zdGFydCgpDQo+
ID4gd2hlcmUgaXQgaXMNCj4gPiArICogbm90IGV4cGVjdGVkIHRvIHJhY2Ugd2l0aCBQU1IgZW5h
YmxlIG9yIGRpc2FibGUuDQo+ID4gKyAqLw0KPiA+ICt2b2lkIGludGVsX3Bzcl93YWl0X2Zvcl9p
ZGxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlDQo+ID4gKm5ld19jcnRjX3N0YXRlKQ0K
PiA+ICt7DQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KG5ld19jcnRjX3N0YXRlLQ0KPiA+ID51YXBpLmNydGMtPmRldik7DQo+ID4gKwlzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlcjsNCj4gPiArCXUzMiBwc3Jfc3RhdHVzOw0KPiA+ICsNCj4gPiAr
CWlmICghbmV3X2NydGNfc3RhdGUtPmhhc19wc3IpDQo+ID4gKwkJcmV0dXJuOw0KPiA+ICsNCj4g
PiArCWZvcl9lYWNoX2ludGVsX2RwKCZkZXZfcHJpdi0+ZHJtLCBlbmNvZGVyKSB7DQo+ID4gKwkJ
c3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9IGVuY190b19pbnRlbF9kcChlbmNvZGVyKTsNCj4g
PiArDQo+ID4gKwkJaWYgKGVuY29kZXItPnR5cGUgIT0gSU5URUxfT1VUUFVUX0VEUCkNCj4gPiAr
CQkJY29udGludWU7DQo+ID4gKw0KPiA+ICsJCS8qIHdoZW4gdGhlIFBTUjEgaXMgZW5hYmxlZCAq
Lw0KPiA+ICsJCWlmIChpbnRlbF9kcC0+cHNyLmVuYWJsZWQgJiYgIWludGVsX2RwLQ0KPiA+ID5w
c3IucHNyMl9lbmFibGVkKSB7DQo+ID4gKwkJCWlmIChwc3Jfd2FpdF9mb3JfaWRsZShpbnRlbF9k
cCwgJnBzcl9zdGF0dXMpKQ0KPiA+ICsJCQkJZHJtX2VycigmZGV2X3ByaXYtPmRybSwNCj4gPiAr
CQkJCQkiUFNSIGlkbGUgdGltZWQgb3V0IDB4JXgsDQo+ID4gYXRvbWljIHVwZGF0ZSBtYXkgZmFp
bFxuIiwNCj4gPiArCQkJCQlwc3Jfc3RhdHVzKTsNCj4gPiArCQl9DQo+ID4gKwl9DQo+ID4gK30N
Cj4gPiArDQo+ID4gK3N0YXRpYyBib29sIF9fcHNyX3dhaXRfZm9yX2lkbGVfbG9ja2VkKHN0cnVj
dCBpbnRlbF9kcCAqaW50ZWxfZHApDQo+ID4gIHsNCj4gPiAgCWk5MTVfcmVnX3QgcmVnOw0KPiA+
ICAJdTMyIG1hc2s7DQo+ID4gIAlpbnQgZXJyOw0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7DQo+ID4gIA0KPiA+IC0JaWYgKCFk
ZXZfcHJpdi0+cHNyLmVuYWJsZWQpDQo+ID4gKwlpZiAoIWludGVsX2RwLT5wc3IuZW5hYmxlZCkN
Cj4gPiAgCQlyZXR1cm4gZmFsc2U7DQo+ID4gIA0KPiA+IC0JaWYgKGRldl9wcml2LT5wc3IucHNy
Ml9lbmFibGVkKSB7DQo+ID4gLQkJcmVnID0gRURQX1BTUjJfU1RBVFVTKGRldl9wcml2LT5wc3Iu
dHJhbnNjb2Rlcik7DQo+ID4gKwlpZiAoaW50ZWxfZHAtPnBzci5wc3IyX2VuYWJsZWQpIHsNCj4g
PiArCQlyZWcgPSBFRFBfUFNSMl9TVEFUVVMoaW50ZWxfZHAtPnBzci50cmFuc2NvZGVyKTsNCj4g
PiAgCQltYXNrID0gRURQX1BTUjJfU1RBVFVTX1NUQVRFX01BU0s7DQo+ID4gIAl9IGVsc2Ugew0K
PiA+IC0JCXJlZyA9IEVEUF9QU1JfU1RBVFVTKGRldl9wcml2LT5wc3IudHJhbnNjb2Rlcik7DQo+
ID4gKwkJcmVnID0gRURQX1BTUl9TVEFUVVMoaW50ZWxfZHAtPnBzci50cmFuc2NvZGVyKTsNCj4g
PiAgCQltYXNrID0gRURQX1BTUl9TVEFUVVNfU1RBVEVfTUFTSzsNCj4gPiAgCX0NCj4gPiAgDQo+
ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5wc3IubG9jayk7DQo+ID4gKwltdXRleF91bmxv
Y2soJmludGVsX2RwLT5wc3IubG9jayk7DQo+ID4gIA0KPiA+ICAJZXJyID0gaW50ZWxfZGVfd2Fp
dF9mb3JfY2xlYXIoZGV2X3ByaXYsIHJlZywgbWFzaywgNTApOw0KPiA+ICAJaWYgKGVycikNCj4g
PiBAQCAtMTQzNiw4ICsxNDUzLDggQEAgc3RhdGljIGJvb2wgX19wc3Jfd2FpdF9mb3JfaWRsZV9s
b2NrZWQoc3RydWN0DQo+ID4gZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpDQo+ID4gIAkJCSJU
aW1lZCBvdXQgd2FpdGluZyBmb3IgUFNSIElkbGUgZm9yIHJlLQ0KPiA+IGVuYWJsZVxuIik7DQo+
ID4gIA0KPiA+ICAJLyogQWZ0ZXIgdGhlIHVubG9ja2VkIHdhaXQsIHZlcmlmeSB0aGF0IFBTUiBp
cyBzdGlsbCB3YW50ZWQhICovDQo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2sp
Ow0KPiA+IC0JcmV0dXJuIGVyciA9PSAwICYmIGRldl9wcml2LT5wc3IuZW5hYmxlZDsNCj4gPiAr
CW11dGV4X2xvY2soJmludGVsX2RwLT5wc3IubG9jayk7DQo+ID4gKwlyZXR1cm4gZXJyID09IDAg
JiYgaW50ZWxfZHAtPnBzci5lbmFibGVkOw0KPiA+ICB9DQo+ID4gIA0KPiA+ICBzdGF0aWMgaW50
IGludGVsX3Bzcl9mYXN0c2V0X2ZvcmNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlDQo+ID4gKmRl
dl9wcml2KQ0KPiA+IEBAIC0xNTAzLDExICsxNTIwLDEyIEBAIHN0YXRpYyBpbnQgaW50ZWxfcHNy
X2Zhc3RzZXRfZm9yY2Uoc3RydWN0DQo+ID4gZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpDQo+
ID4gIAlyZXR1cm4gZXJyOw0KPiA+ICB9DQo+ID4gIA0KPiA+IC1pbnQgaW50ZWxfcHNyX2RlYnVn
X3NldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU2NA0KPiA+IHZhbCkNCj4g
PiAraW50IGludGVsX3Bzcl9kZWJ1Z19zZXQoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwgdTY0
IHZhbCkNCj4gPiAgew0KPiA+ICAJY29uc3QgdTMyIG1vZGUgPSB2YWwgJiBJOTE1X1BTUl9ERUJV
R19NT0RFX01BU0s7DQo+ID4gIAl1MzIgb2xkX21vZGU7DQo+ID4gIAlpbnQgcmV0Ow0KPiA+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7
DQo+ID4gIA0KPiA+ICAJaWYgKHZhbCAmIH4oSTkxNV9QU1JfREVCVUdfSVJRIHwgSTkxNV9QU1Jf
REVCVUdfTU9ERV9NQVNLKSB8fA0KPiA+ICAJICAgIG1vZGUgPiBJOTE1X1BTUl9ERUJVR19GT1JD
RV9QU1IxKSB7DQo+ID4gQEAgLTE1MTUsMjEgKzE1MzMsMjEgQEAgaW50IGludGVsX3Bzcl9kZWJ1
Z19zZXQoc3RydWN0DQo+ID4gZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU2NCB2YWwpDQo+
ID4gIAkJcmV0dXJuIC1FSU5WQUw7DQo+ID4gIAl9DQo+ID4gIA0KPiA+IC0JcmV0ID0gbXV0ZXhf
bG9ja19pbnRlcnJ1cHRpYmxlKCZkZXZfcHJpdi0+cHNyLmxvY2spOw0KPiA+ICsJcmV0ID0gbXV0
ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKCZpbnRlbF9kcC0+cHNyLmxvY2spOw0KPiA+ICAJaWYgKHJl
dCkNCj4gPiAgCQlyZXR1cm4gcmV0Ow0KPiA+ICANCj4gPiAtCW9sZF9tb2RlID0gZGV2X3ByaXYt
PnBzci5kZWJ1ZyAmIEk5MTVfUFNSX0RFQlVHX01PREVfTUFTSzsNCj4gPiAtCWRldl9wcml2LT5w
c3IuZGVidWcgPSB2YWw7DQo+ID4gKwlvbGRfbW9kZSA9IGludGVsX2RwLT5wc3IuZGVidWcgJiBJ
OTE1X1BTUl9ERUJVR19NT0RFX01BU0s7DQo+ID4gKwlpbnRlbF9kcC0+cHNyLmRlYnVnID0gdmFs
Ow0KPiA+ICANCj4gPiAgCS8qDQo+ID4gIAkgKiBEbyBpdCByaWdodCBhd2F5IGlmIGl0J3MgYWxy
ZWFkeSBlbmFibGVkLCBvdGhlcndpc2UgaXQgd2lsbA0KPiA+IGJlIGRvbmUNCj4gPiAgCSAqIHdo
ZW4gZW5hYmxpbmcgdGhlIHNvdXJjZS4NCj4gPiAgCSAqLw0KPiA+IC0JaWYgKGRldl9wcml2LT5w
c3IuZW5hYmxlZCkNCj4gPiAtCQlwc3JfaXJxX2NvbnRyb2woZGV2X3ByaXYpOw0KPiA+ICsJaWYg
KGludGVsX2RwLT5wc3IuZW5hYmxlZCkNCj4gPiArCQlwc3JfaXJxX2NvbnRyb2woaW50ZWxfZHAp
Ow0KPiA+ICANCj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPnBzci5sb2NrKTsNCj4gPiAr
CW11dGV4X3VubG9jaygmaW50ZWxfZHAtPnBzci5sb2NrKTsNCj4gPiAgDQo+ID4gIAlpZiAob2xk
X21vZGUgIT0gbW9kZSkNCj4gPiAgCQlyZXQgPSBpbnRlbF9wc3JfZmFzdHNldF9mb3JjZShkZXZf
cHJpdik7DQo+ID4gQEAgLTE1MzcsMjggKzE1NTUsMjggQEAgaW50IGludGVsX3Bzcl9kZWJ1Z19z
ZXQoc3RydWN0DQo+ID4gZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU2NCB2YWwpDQo+ID4g
IAlyZXR1cm4gcmV0Ow0KPiA+ICB9DQo+ID4gIA0KPiA+IC1zdGF0aWMgdm9pZCBpbnRlbF9wc3Jf
aGFuZGxlX2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZQ0KPiA+ICpkZXZfcHJpdikNCj4gPiAr
c3RhdGljIHZvaWQgaW50ZWxfcHNyX2hhbmRsZV9pcnEoc3RydWN0IGludGVsX2RwICppbnRlbF9k
cCkNCj4gPiAgew0KPiA+IC0Jc3RydWN0IGk5MTVfcHNyICpwc3IgPSAmZGV2X3ByaXYtPnBzcjsN
Cj4gPiArCXN0cnVjdCBpbnRlbF9wc3IgKnBzciA9ICZpbnRlbF9kcC0+cHNyOw0KPiA+ICANCj4g
PiAtCWludGVsX3Bzcl9kaXNhYmxlX2xvY2tlZChwc3ItPmRwKTsNCj4gPiArCWludGVsX3Bzcl9k
aXNhYmxlX2xvY2tlZChpbnRlbF9kcCk7DQo+ID4gIAlwc3ItPnNpbmtfbm90X3JlbGlhYmxlID0g
dHJ1ZTsNCj4gPiAgCS8qIGxldCdzIG1ha2Ugc3VyZSB0aGF0IHNpbmsgaXMgYXdha2VuICovDQo+
ID4gLQlkcm1fZHBfZHBjZF93cml0ZWIoJnBzci0+ZHAtPmF1eCwgRFBfU0VUX1BPV0VSLA0KPiA+
IERQX1NFVF9QT1dFUl9EMCk7DQo+ID4gKwlkcm1fZHBfZHBjZF93cml0ZWIoJmludGVsX2RwLT5h
dXgsIERQX1NFVF9QT1dFUiwNCj4gPiBEUF9TRVRfUE9XRVJfRDApOw0KPiA+ICB9DQo+ID4gIA0K
PiA+ICBzdGF0aWMgdm9pZCBpbnRlbF9wc3Jfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmsp
DQo+ID4gIHsNCj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9DQo+ID4g
LQkJY29udGFpbmVyX29mKHdvcmssIHR5cGVvZigqZGV2X3ByaXYpLCBwc3Iud29yayk7DQo+ID4g
KwlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0NCj4gPiArCQljb250YWluZXJfb2Yod29yaywg
dHlwZW9mKCppbnRlbF9kcCksIHBzci53b3JrKTsNCj4gPiAgDQo+ID4gLQltdXRleF9sb2NrKCZk
ZXZfcHJpdi0+cHNyLmxvY2spOw0KPiA+ICsJbXV0ZXhfbG9jaygmaW50ZWxfZHAtPnBzci5sb2Nr
KTsNCj4gPiAgDQo+ID4gLQlpZiAoIWRldl9wcml2LT5wc3IuZW5hYmxlZCkNCj4gPiArCWlmICgh
aW50ZWxfZHAtPnBzci5lbmFibGVkKQ0KPiA+ICAJCWdvdG8gdW5sb2NrOw0KPiA+ICANCj4gPiAt
CWlmIChSRUFEX09OQ0UoZGV2X3ByaXYtPnBzci5pcnFfYXV4X2Vycm9yKSkNCj4gPiAtCQlpbnRl
bF9wc3JfaGFuZGxlX2lycShkZXZfcHJpdik7DQo+ID4gKwlpZiAoUkVBRF9PTkNFKGludGVsX2Rw
LT5wc3IuaXJxX2F1eF9lcnJvcikpDQo+ID4gKwkJaW50ZWxfcHNyX2hhbmRsZV9pcnEoaW50ZWxf
ZHApOw0KPiA+ICANCj4gPiAgCS8qDQo+ID4gIAkgKiBXZSBoYXZlIHRvIG1ha2Ugc3VyZSBQU1Ig
aXMgcmVhZHkgZm9yIHJlLWVuYWJsZQ0KPiA+IEBAIC0xNTY2LDcgKzE1ODQsNyBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9wc3Jfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QNCj4gPiAqd29yaykNCj4gPiAg
CSAqIFBTUiBtaWdodCB0YWtlIHNvbWUgdGltZSB0byBnZXQgZnVsbHkgZGlzYWJsZWQNCj4gPiAg
CSAqIGFuZCBiZSByZWFkeSBmb3IgcmUtZW5hYmxlLg0KPiA+ICAJICovDQo+ID4gLQlpZiAoIV9f
cHNyX3dhaXRfZm9yX2lkbGVfbG9ja2VkKGRldl9wcml2KSkNCj4gPiArCWlmICghX19wc3Jfd2Fp
dF9mb3JfaWRsZV9sb2NrZWQoaW50ZWxfZHApKQ0KPiA+ICAJCWdvdG8gdW5sb2NrOw0KPiA+ICAN
Cj4gPiAgCS8qDQo+ID4gQEAgLTE1NzQsMTIgKzE1OTIsMTIgQEAgc3RhdGljIHZvaWQgaW50ZWxf
cHNyX3dvcmsoc3RydWN0DQo+ID4gd29ya19zdHJ1Y3QgKndvcmspDQo+ID4gIAkgKiByZWNoZWNr
LiBTaW5jZSBwc3JfZmx1c2ggZmlyc3QgY2xlYXJzIHRoaXMgYW5kIHRoZW4NCj4gPiByZXNjaGVk
dWxlcyB3ZQ0KPiA+ICAJICogd29uJ3QgZXZlciBtaXNzIGEgZmx1c2ggd2hlbiBiYWlsaW5nIG91
dCBoZXJlLg0KPiA+ICAJICovDQo+ID4gLQlpZiAoZGV2X3ByaXYtPnBzci5idXN5X2Zyb250YnVm
ZmVyX2JpdHMgfHwgZGV2X3ByaXYtDQo+ID4gPnBzci5hY3RpdmUpDQo+ID4gKwlpZiAoaW50ZWxf
ZHAtPnBzci5idXN5X2Zyb250YnVmZmVyX2JpdHMgfHwgaW50ZWxfZHAtDQo+ID4gPnBzci5hY3Rp
dmUpDQo+ID4gIAkJZ290byB1bmxvY2s7DQo+ID4gIA0KPiA+IC0JaW50ZWxfcHNyX2FjdGl2YXRl
KGRldl9wcml2LT5wc3IuZHApOw0KPiA+ICsJaW50ZWxfcHNyX2FjdGl2YXRlKGludGVsX2RwKTsN
Cj4gPiAgdW5sb2NrOg0KPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2spOw0K
PiA+ICsJbXV0ZXhfdW5sb2NrKCZpbnRlbF9kcC0+cHNyLmxvY2spOw0KPiA+ICB9DQo+ID4gIA0K
PiA+ICAvKioNCj4gPiBAQCAtMTU5OCwyNyArMTYxNiwzNSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9w
c3Jfd29yayhzdHJ1Y3QNCj4gPiB3b3JrX3N0cnVjdCAqd29yaykNCj4gPiAgdm9pZCBpbnRlbF9w
c3JfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsDQo+ID4gIAkJ
CSAgdW5zaWduZWQgZnJvbnRidWZmZXJfYml0cywgZW51bSBmYl9vcF9vcmlnaW4NCj4gPiBvcmln
aW4pDQo+ID4gIHsNCj4gPiAtCWlmICghQ0FOX1BTUihkZXZfcHJpdikpDQo+ID4gLQkJcmV0dXJu
Ow0KPiA+ICsJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXI7DQo+ID4gKwlzdHJ1Y3QgaW50
ZWxfZHAgKmludGVsX2RwOw0KPiA+ICANCj4gPiAtCWlmIChvcmlnaW4gPT0gT1JJR0lOX0ZMSVAp
DQo+ID4gLQkJcmV0dXJuOw0KPiA+ICsJZm9yX2VhY2hfaW50ZWxfZHAoJmRldl9wcml2LT5kcm0s
IGVuY29kZXIpIHsNCj4gPiAgDQo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2sp
Ow0KPiA+IC0JaWYgKCFkZXZfcHJpdi0+cHNyLmVuYWJsZWQpIHsNCj4gPiAtCQltdXRleF91bmxv
Y2soJmRldl9wcml2LT5wc3IubG9jayk7DQo+ID4gLQkJcmV0dXJuOw0KPiA+IC0JfQ0KPiA+ICsJ
CWludGVsX2RwID0gZW5jX3RvX2ludGVsX2RwKGVuY29kZXIpOw0KPiA+ICsJCWlmIChlbmNvZGVy
LT50eXBlICE9IElOVEVMX09VVFBVVF9FRFApDQo+ID4gKwkJCWNvbnRpbnVlOw0KPiA+ICsJCWlm
ICghQ0FOX1BTUihpbnRlbF9kcCkpDQo+ID4gKwkJCWNvbnRpbnVlOw0KPiA+ICANCj4gPiAtCWZy
b250YnVmZmVyX2JpdHMgJj0gSU5URUxfRlJPTlRCVUZGRVJfQUxMX01BU0soZGV2X3ByaXYtDQo+
ID4gPnBzci5waXBlKTsNCj4gPiAtCWRldl9wcml2LT5wc3IuYnVzeV9mcm9udGJ1ZmZlcl9iaXRz
IHw9IGZyb250YnVmZmVyX2JpdHM7DQo+ID4gKwkJaWYgKG9yaWdpbiA9PSBPUklHSU5fRkxJUCkN
Cj4gPiArCQkJY29udGludWU7DQo+ID4gKw0KPiA+ICsJCW11dGV4X2xvY2soJmludGVsX2RwLT5w
c3IubG9jayk7DQo+ID4gKwkJaWYgKCFpbnRlbF9kcC0+cHNyLmVuYWJsZWQpIHsNCj4gPiArCQkJ
bXV0ZXhfdW5sb2NrKCZpbnRlbF9kcC0+cHNyLmxvY2spOw0KPiA+ICsJCQljb250aW51ZTsNCj4g
PiArCQl9DQo+ID4gIA0KPiA+IC0JaWYgKGZyb250YnVmZmVyX2JpdHMpDQo+ID4gLQkJaW50ZWxf
cHNyX2V4aXQoZGV2X3ByaXYpOw0KPiA+ICsJCWZyb250YnVmZmVyX2JpdHMgJj0NCj4gPiBJTlRF
TF9GUk9OVEJVRkZFUl9BTExfTUFTSyhpbnRlbF9kcC0+cHNyLnBpcGUpOw0KPiA+ICsJCWludGVs
X2RwLT5wc3IuYnVzeV9mcm9udGJ1ZmZlcl9iaXRzIHw9DQo+ID4gZnJvbnRidWZmZXJfYml0czsN
Cj4gPiAgDQo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5wc3IubG9jayk7DQo+ID4gLX0N
Cj4gPiArCQlpZiAoZnJvbnRidWZmZXJfYml0cykNCj4gPiArCQkJaW50ZWxfcHNyX2V4aXQoaW50
ZWxfZHApOw0KPiA+ICANCj4gPiArCQltdXRleF91bmxvY2soJmludGVsX2RwLT5wc3IubG9jayk7
DQo+ID4gKwl9DQo+ID4gK30NCj4gPiAgLyoNCj4gPiAgICogV2hlbiB3ZSB3aWxsIGJlIGNvbXBs
ZXRlbHkgcmVseSBvbiBQU1IyIFMvVyB0cmFja2luZyBpbiBmdXR1cmUsDQo+ID4gICAqIGludGVs
X3Bzcl9mbHVzaCgpIHdpbGwgaW52YWxpZGF0ZSBhbmQgZmx1c2ggdGhlIFBTUiBmb3INCj4gPiBP
UklHSU5fRkxJUA0KPiA+IEBAIC0xNjI2LDE1ICsxNjUyLDE1IEBAIHZvaWQgaW50ZWxfcHNyX2lu
dmFsaWRhdGUoc3RydWN0DQo+ID4gZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsDQo+ID4gICAq
IGFjY29yZGluZ2x5IGluIGZ1dHVyZS4NCj4gPiAgICovDQo+ID4gIHN0YXRpYyB2b2lkDQo+ID4g
LXRnbF9kYzNjb19mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsDQo+ID4g
LQkJdW5zaWduZWQgaW50IGZyb250YnVmZmVyX2JpdHMsIGVudW0gZmJfb3Bfb3JpZ2luDQo+ID4g
b3JpZ2luKQ0KPiA+ICt0Z2xfZGMzY29fZmx1c2goc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwg
dW5zaWduZWQgaW50DQo+ID4gZnJvbnRidWZmZXJfYml0cywNCj4gPiArCQllbnVtIGZiX29wX29y
aWdpbiBvcmlnaW4pDQo+ID4gIHsNCj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5wc3IubG9j
ayk7DQo+ID4gKwltdXRleF9sb2NrKCZpbnRlbF9kcC0+cHNyLmxvY2spOw0KPiA+ICANCj4gPiAt
CWlmICghZGV2X3ByaXYtPnBzci5kYzNjb19lbmFibGVkKQ0KPiA+ICsJaWYgKCFpbnRlbF9kcC0+
cHNyLmRjM2NvX2VuYWJsZWQpDQo+ID4gIAkJZ290byB1bmxvY2s7DQo+ID4gIA0KPiA+IC0JaWYg
KCFkZXZfcHJpdi0+cHNyLnBzcjJfZW5hYmxlZCB8fCAhZGV2X3ByaXYtPnBzci5hY3RpdmUpDQo+
ID4gKwlpZiAoIWludGVsX2RwLT5wc3IucHNyMl9lbmFibGVkIHx8ICFpbnRlbF9kcC0+cHNyLmFj
dGl2ZSkNCj4gPiAgCQlnb3RvIHVubG9jazsNCj4gPiAgDQo+ID4gIAkvKg0KPiA+IEBAIC0xNjQy
LDE1ICsxNjY4LDE1IEBAIHRnbF9kYzNjb19mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZQ0K
PiA+ICpkZXZfcHJpdiwNCj4gPiAgCSAqIHdoZW4gZGVsYXllZCB3b3JrIHNjaGVkdWxlcyB0aGF0
IG1lYW5zIGRpc3BsYXkgaGFzIGJlZW4NCj4gPiBpZGxlLg0KPiA+ICAJICovDQo+ID4gIAlpZiAo
IShmcm9udGJ1ZmZlcl9iaXRzICYNCj4gPiAtCSAgICBJTlRFTF9GUk9OVEJVRkZFUl9BTExfTUFT
SyhkZXZfcHJpdi0+cHNyLnBpcGUpKSkNCj4gPiArCSAgICBJTlRFTF9GUk9OVEJVRkZFUl9BTExf
TUFTSyhpbnRlbF9kcC0+cHNyLnBpcGUpKSkNCj4gPiAgCQlnb3RvIHVubG9jazsNCj4gPiAgDQo+
ID4gLQl0Z2xfcHNyMl9lbmFibGVfZGMzY28oZGV2X3ByaXYpOw0KPiA+IC0JbW9kX2RlbGF5ZWRf
d29yayhzeXN0ZW1fd3EsICZkZXZfcHJpdi0+cHNyLmRjM2NvX3dvcmssDQo+ID4gLQkJCSBkZXZf
cHJpdi0+cHNyLmRjM2NvX2V4aXRfZGVsYXkpOw0KPiA+ICsJdGdsX3BzcjJfZW5hYmxlX2RjM2Nv
KGludGVsX2RwKTsNCj4gPiArCW1vZF9kZWxheWVkX3dvcmsoc3lzdGVtX3dxLCAmaW50ZWxfZHAt
PnBzci5kYzNjb193b3JrLA0KPiA+ICsJCQkgaW50ZWxfZHAtPnBzci5kYzNjb19leGl0X2RlbGF5
KTsNCj4gPiAgDQo+ID4gIHVubG9jazoNCj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPnBz
ci5sb2NrKTsNCj4gPiArCW11dGV4X3VubG9jaygmaW50ZWxfZHAtPnBzci5sb2NrKTsNCj4gPiAg
fQ0KPiA+ICANCj4gPiAgLyoqDQo+ID4gQEAgLTE2NjksNDUgKzE2OTUsNTQgQEAgdGdsX2RjM2Nv
X2ZsdXNoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlDQo+ID4gKmRldl9wcml2LA0KPiA+ICB2b2lk
IGludGVsX3Bzcl9mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsDQo+ID4g
IAkJICAgICB1bnNpZ25lZCBmcm9udGJ1ZmZlcl9iaXRzLCBlbnVtIGZiX29wX29yaWdpbg0KPiA+
IG9yaWdpbikNCj4gPiAgew0KPiA+IC0JaWYgKCFDQU5fUFNSKGRldl9wcml2KSkNCj4gPiAtCQly
ZXR1cm47DQo+ID4gLQ0KPiA+IC0JaWYgKG9yaWdpbiA9PSBPUklHSU5fRkxJUCkgew0KPiA+IC0J
CXRnbF9kYzNjb19mbHVzaChkZXZfcHJpdiwgZnJvbnRidWZmZXJfYml0cywgb3JpZ2luKTsNCj4g
PiAtCQlyZXR1cm47DQo+ID4gLQl9DQo+ID4gLQ0KPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYt
PnBzci5sb2NrKTsNCj4gPiAtCWlmICghZGV2X3ByaXYtPnBzci5lbmFibGVkKSB7DQo+ID4gLQkJ
bXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2spOw0KPiA+IC0JCXJldHVybjsNCj4gPiAr
CXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyOw0KPiA+ICsJc3RydWN0IGludGVsX2RwICpp
bnRlbF9kcDsNCj4gPiArDQo+ID4gKwlmb3JfZWFjaF9pbnRlbF9kcCgmZGV2X3ByaXYtPmRybSwg
ZW5jb2Rlcikgew0KPiA+ICsJCWludGVsX2RwID0gZW5jX3RvX2ludGVsX2RwKGVuY29kZXIpOw0K
PiA+ICsNCj4gPiArCQlpZiAoZW5jb2Rlci0+dHlwZSA9PSBJTlRFTF9PVVRQVVRfRURQICYmDQo+
ID4gQ0FOX1BTUihpbnRlbF9kcCkpIHsNCj4gPiArCQkJaWYgKG9yaWdpbiA9PSBPUklHSU5fRkxJ
UCkgew0KPiA+ICsJCQkJdGdsX2RjM2NvX2ZsdXNoKGludGVsX2RwLA0KPiA+IGZyb250YnVmZmVy
X2JpdHMsIG9yaWdpbik7DQo+ID4gKwkJCQljb250aW51ZTsNCj4gPiArCQkJfQ0KPiA+ICsNCj4g
PiArCQkJbXV0ZXhfbG9jaygmaW50ZWxfZHAtPnBzci5sb2NrKTsNCj4gPiArCQkJaWYgKCFpbnRl
bF9kcC0+cHNyLmVuYWJsZWQpIHsNCj4gPiArCQkJCW11dGV4X3VubG9jaygmaW50ZWxfZHAtPnBz
ci5sb2NrKTsNCj4gPiArCQkJCWNvbnRpbnVlOw0KPiA+ICsJCQl9DQo+ID4gKw0KPiA+ICsJCQlm
cm9udGJ1ZmZlcl9iaXRzICY9DQo+ID4gSU5URUxfRlJPTlRCVUZGRVJfQUxMX01BU0soaW50ZWxf
ZHAtPnBzci5waXBlKTsNCj4gPiArCQkJaW50ZWxfZHAtPnBzci5idXN5X2Zyb250YnVmZmVyX2Jp
dHMgJj0NCj4gPiB+ZnJvbnRidWZmZXJfYml0czsNCj4gPiArDQo+ID4gKwkJCS8qIEJ5IGRlZmlu
aXRpb24gZmx1c2ggPSBpbnZhbGlkYXRlICsgZmx1c2ggKi8NCj4gPiArCQkJaWYgKGZyb250YnVm
ZmVyX2JpdHMpDQo+ID4gKwkJCQlwc3JfZm9yY2VfaHdfdHJhY2tpbmdfZXhpdChpbnRlbF9kcCk7
DQo+ID4gKw0KPiA+ICsJCQlpZiAoIWludGVsX2RwLT5wc3IuYWN0aXZlICYmICFpbnRlbF9kcC0N
Cj4gPiA+cHNyLmJ1c3lfZnJvbnRidWZmZXJfYml0cykNCj4gPiArCQkJCXNjaGVkdWxlX3dvcmso
JmludGVsX2RwLT5wc3Iud29yayk7DQo+ID4gKwkJCW11dGV4X3VubG9jaygmaW50ZWxfZHAtPnBz
ci5sb2NrKTsNCj4gPiArCQl9DQo+ID4gIAl9DQo+ID4gLQ0KPiA+IC0JZnJvbnRidWZmZXJfYml0
cyAmPSBJTlRFTF9GUk9OVEJVRkZFUl9BTExfTUFTSyhkZXZfcHJpdi0NCj4gPiA+cHNyLnBpcGUp
Ow0KPiA+IC0JZGV2X3ByaXYtPnBzci5idXN5X2Zyb250YnVmZmVyX2JpdHMgJj0gfmZyb250YnVm
ZmVyX2JpdHM7DQo+ID4gLQ0KPiA+IC0JLyogQnkgZGVmaW5pdGlvbiBmbHVzaCA9IGludmFsaWRh
dGUgKyBmbHVzaCAqLw0KPiA+IC0JaWYgKGZyb250YnVmZmVyX2JpdHMpDQo+ID4gLQkJcHNyX2Zv
cmNlX2h3X3RyYWNraW5nX2V4aXQoZGV2X3ByaXYpOw0KPiA+IC0NCj4gPiAtCWlmICghZGV2X3By
aXYtPnBzci5hY3RpdmUgJiYgIWRldl9wcml2LQ0KPiA+ID5wc3IuYnVzeV9mcm9udGJ1ZmZlcl9i
aXRzKQ0KPiA+IC0JCXNjaGVkdWxlX3dvcmsoJmRldl9wcml2LT5wc3Iud29yayk7DQo+ID4gLQlt
dXRleF91bmxvY2soJmRldl9wcml2LT5wc3IubG9jayk7DQo+ID4gIH0NCj4gPiAgDQo+ID4gIC8q
Kg0KPiA+ICAgKiBpbnRlbF9wc3JfaW5pdCAtIEluaXQgYmFzaWMgUFNSIHdvcmsgYW5kIG11dGV4
Lg0KPiA+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIHByaXZhdGUNCj4gPiArICogQGludGVs
X2RwOiBJbnRlbCBEUA0KPiA+ICAgKg0KPiA+IC0gKiBUaGlzIGZ1bmN0aW9uIGlzICBjYWxsZWQg
b25seSBvbmNlIGF0IGRyaXZlciBsb2FkIHRvIGluaXRpYWxpemUNCj4gPiBiYXNpYw0KPiA+IC0g
KiBQU1Igc3R1ZmYuDQo+ID4gKyAqIFRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGFmdGVyIHRoZSBp
bml0aWFsaXppbmcgY29ubmVjdG9yLg0KPiA+ICsgKiAodGhlIGluaXRpYWxpemluZyBvZiBjb25u
ZWN0b3IgdHJlYXRzIHRoZSBoYW5kbGluZyBvZiBjb25uZWN0b3INCj4gPiBjYXBhYmlsaXRpZXMp
DQo+ID4gKyAqIEFuZCBpdCBpbml0aWFsaXplcyBiYXNpYyBQU1Igc3R1ZmYgZm9yIGVhY2ggRFAg
RW5jb2Rlci4NCj4gPiAgICovDQo+ID4gLXZvaWQgaW50ZWxfcHNyX2luaXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQ0KPiA+ICt2b2lkIGludGVsX3Bzcl9pbml0KHN0cnVjdCBp
bnRlbF9kcCAqaW50ZWxfZHApDQo+ID4gIHsNCj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOw0KPiA+ICsNCj4gPiAgCWlmICghSEFT
X1BTUihkZXZfcHJpdikpDQo+ID4gIAkJcmV0dXJuOw0KPiA+ICANCj4gPiAtCWlmICghZGV2X3By
aXYtPnBzci5zaW5rX3N1cHBvcnQpDQo+ID4gKwlpZiAoIWludGVsX2RwLT5wc3Iuc2lua19zdXBw
b3J0KQ0KPiA+ICAJCXJldHVybjsNCj4gPiAgDQo+ID4gIAlpZiAoSVNfSEFTV0VMTChkZXZfcHJp
dikpDQo+ID4gQEAgLTE3MjUsMTQgKzE3NjAsMTQgQEAgdm9pZCBpbnRlbF9wc3JfaW5pdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZQ0KPiA+ICpkZXZfcHJpdikNCj4gPiAgCS8qIFNldCBsaW5rX3N0
YW5kYnkgeCBsaW5rX29mZiBkZWZhdWx0cyAqLw0KPiA+ICAJaWYgKElTX0hBU1dFTEwoZGV2X3By
aXYpIHx8IElTX0JST0FEV0VMTChkZXZfcHJpdikpDQo+ID4gIAkJLyogSFNXIGFuZCBCRFcgcmVx
dWlyZSB3b3JrYXJvdW5kcyB0aGF0IHdlIGRvbid0DQo+ID4gaW1wbGVtZW50LiAqLw0KPiA+IC0J
CWRldl9wcml2LT5wc3IubGlua19zdGFuZGJ5ID0gZmFsc2U7DQo+ID4gKwkJaW50ZWxfZHAtPnBz
ci5saW5rX3N0YW5kYnkgPSBmYWxzZTsNCj4gPiAgCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJp
dikgPCAxMikNCj4gPiAgCQkvKiBGb3IgbmV3IHBsYXRmb3JtcyB1cCB0byBUR0wgbGV0J3MgcmVz
cGVjdCBWQlQgYmFjaw0KPiA+IGFnYWluICovDQo+ID4gLQkJZGV2X3ByaXYtPnBzci5saW5rX3N0
YW5kYnkgPSBkZXZfcHJpdi0NCj4gPiA+dmJ0LnBzci5mdWxsX2xpbms7DQo+ID4gKwkJaW50ZWxf
ZHAtPnBzci5saW5rX3N0YW5kYnkgPSBkZXZfcHJpdi0NCj4gPiA+dmJ0LnBzci5mdWxsX2xpbms7
DQo+ID4gIA0KPiA+IC0JSU5JVF9XT1JLKCZkZXZfcHJpdi0+cHNyLndvcmssIGludGVsX3Bzcl93
b3JrKTsNCj4gPiAtCUlOSVRfREVMQVlFRF9XT1JLKCZkZXZfcHJpdi0+cHNyLmRjM2NvX3dvcmss
DQo+ID4gdGdsX2RjM2NvX2Rpc2FibGVfd29yayk7DQo+ID4gLQltdXRleF9pbml0KCZkZXZfcHJp
di0+cHNyLmxvY2spOw0KPiA+ICsJSU5JVF9XT1JLKCZpbnRlbF9kcC0+cHNyLndvcmssIGludGVs
X3Bzcl93b3JrKTsNCj4gPiArCUlOSVRfREVMQVlFRF9XT1JLKCZpbnRlbF9kcC0+cHNyLmRjM2Nv
X3dvcmssDQo+ID4gdGdsX2RjM2NvX2Rpc2FibGVfd29yayk7DQo+ID4gKwltdXRleF9pbml0KCZp
bnRlbF9kcC0+cHNyLmxvY2spOw0KPiA+ICB9DQo+ID4gIA0KPiA+ICBzdGF0aWMgaW50IHBzcl9n
ZXRfc3RhdHVzX2FuZF9lcnJvcl9zdGF0dXMoc3RydWN0IGludGVsX2RwDQo+ID4gKmludGVsX2Rw
LA0KPiA+IEBAIC0xNzU4LDcgKzE3OTMsNyBAQCBzdGF0aWMgdm9pZCBwc3JfYWxwbV9jaGVjayhz
dHJ1Y3QgaW50ZWxfZHANCj4gPiAqaW50ZWxfZHApDQo+ID4gIHsNCj4gPiAgCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOw0KPiA+ICAJc3Ry
dWN0IGRybV9kcF9hdXggKmF1eCA9ICZpbnRlbF9kcC0+YXV4Ow0KPiA+IC0Jc3RydWN0IGk5MTVf
cHNyICpwc3IgPSAmZGV2X3ByaXYtPnBzcjsNCj4gPiArCXN0cnVjdCBpbnRlbF9wc3IgKnBzciA9
ICZpbnRlbF9kcC0+cHNyOw0KPiA+ICAJdTggdmFsOw0KPiA+ICAJaW50IHI7DQo+ID4gIA0KPiA+
IEBAIC0xNzg1LDcgKzE4MjAsNyBAQCBzdGF0aWMgdm9pZCBwc3JfYWxwbV9jaGVjayhzdHJ1Y3Qg
aW50ZWxfZHANCj4gPiAqaW50ZWxfZHApDQo+ID4gIHN0YXRpYyB2b2lkIHBzcl9jYXBhYmlsaXR5
X2NoYW5nZWRfY2hlY2soc3RydWN0IGludGVsX2RwDQo+ID4gKmludGVsX2RwKQ0KPiA+ICB7DQo+
ID4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVs
X2RwKTsNCj4gPiAtCXN0cnVjdCBpOTE1X3BzciAqcHNyID0gJmRldl9wcml2LT5wc3I7DQo+ID4g
KwlzdHJ1Y3QgaW50ZWxfcHNyICpwc3IgPSAmaW50ZWxfZHAtPnBzcjsNCj4gPiAgCXU4IHZhbDsN
Cj4gPiAgCWludCByOw0KPiA+ICANCj4gPiBAQCAtMTgwOSwxOCArMTg0NCwxOCBAQCBzdGF0aWMg
dm9pZA0KPiA+IHBzcl9jYXBhYmlsaXR5X2NoYW5nZWRfY2hlY2soc3RydWN0IGludGVsX2RwICpp
bnRlbF9kcCkNCj4gPiAgdm9pZCBpbnRlbF9wc3Jfc2hvcnRfcHVsc2Uoc3RydWN0IGludGVsX2Rw
ICppbnRlbF9kcCkNCj4gPiAgew0KPiA+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7DQo+ID4gLQlzdHJ1Y3QgaTkxNV9wc3IgKnBzciA9
ICZkZXZfcHJpdi0+cHNyOw0KPiA+ICsJc3RydWN0IGludGVsX3BzciAqcHNyID0gJmludGVsX2Rw
LT5wc3I7DQo+ID4gIAl1OCBzdGF0dXMsIGVycm9yX3N0YXR1czsNCj4gPiAgCWNvbnN0IHU4IGVy
cm9ycyA9IERQX1BTUl9SRkJfU1RPUkFHRV9FUlJPUiB8DQo+ID4gIAkJCSAgRFBfUFNSX1ZTQ19T
RFBfVU5DT1JSRUNUQUJMRV9FUlJPUiB8DQo+ID4gIAkJCSAgRFBfUFNSX0xJTktfQ1JDX0VSUk9S
Ow0KPiA+ICANCj4gPiAtCWlmICghQ0FOX1BTUihkZXZfcHJpdikgfHwgIWludGVsX2RwX2lzX2Vk
cChpbnRlbF9kcCkpDQo+ID4gKwlpZiAoIUNBTl9QU1IoaW50ZWxfZHApIHx8ICFpbnRlbF9kcF9p
c19lZHAoaW50ZWxfZHApKQ0KPiA+ICAJCXJldHVybjsNCj4gPiAgDQo+ID4gIAltdXRleF9sb2Nr
KCZwc3ItPmxvY2spOw0KPiA+ICANCj4gPiAtCWlmICghcHNyLT5lbmFibGVkIHx8IHBzci0+ZHAg
IT0gaW50ZWxfZHApDQo+ID4gKwlpZiAoIXBzci0+ZW5hYmxlZCkNCj4gPiAgCQlnb3RvIGV4aXQ7
DQo+ID4gIA0KPiA+ICAJaWYgKHBzcl9nZXRfc3RhdHVzX2FuZF9lcnJvcl9zdGF0dXMoaW50ZWxf
ZHAsICZzdGF0dXMsDQo+ID4gJmVycm9yX3N0YXR1cykpIHsNCj4gPiBAQCAtMTg2MywxNSArMTg5
OCwxNCBAQCB2b2lkIGludGVsX3Bzcl9zaG9ydF9wdWxzZShzdHJ1Y3QgaW50ZWxfZHANCj4gPiAq
aW50ZWxfZHApDQo+ID4gIA0KPiA+ICBib29sIGludGVsX3Bzcl9lbmFibGVkKHN0cnVjdCBpbnRl
bF9kcCAqaW50ZWxfZHApDQo+ID4gIHsNCj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOw0KPiA+ICAJYm9vbCByZXQ7DQo+ID4gIA0K
PiA+IC0JaWYgKCFDQU5fUFNSKGRldl9wcml2KSB8fCAhaW50ZWxfZHBfaXNfZWRwKGludGVsX2Rw
KSkNCj4gPiArCWlmICghQ0FOX1BTUihpbnRlbF9kcCkgfHwgIWludGVsX2RwX2lzX2VkcChpbnRl
bF9kcCkpDQo+ID4gIAkJcmV0dXJuIGZhbHNlOw0KPiA+ICANCj4gPiAtCW11dGV4X2xvY2soJmRl
dl9wcml2LT5wc3IubG9jayk7DQo+ID4gLQlyZXQgPSAoZGV2X3ByaXYtPnBzci5kcCA9PSBpbnRl
bF9kcCAmJiBkZXZfcHJpdi0+cHNyLmVuYWJsZWQpOw0KPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZf
cHJpdi0+cHNyLmxvY2spOw0KPiA+ICsJbXV0ZXhfbG9jaygmaW50ZWxfZHAtPnBzci5sb2NrKTsN
Cj4gPiArCXJldCA9IGludGVsX2RwLT5wc3IuZW5hYmxlZDsNCj4gPiArCW11dGV4X3VubG9jaygm
aW50ZWxfZHAtPnBzci5sb2NrKTsNCj4gPiAgDQo+ID4gIAlyZXR1cm4gcmV0Ow0KPiA+ICB9DQo+
ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcHNyLmgN
Cj4gPiBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcHNyLmgNCj4gPiBpbmRl
eCAwYTUxNzk3OGU4YWYuLjAzZWIxOTU0N2QwOSAxMDA2NDQNCj4gPiAtLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Bzci5oDQo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9wc3IuaA0KPiA+IEBAIC0xOCw3ICsxOCw3IEBAIHN0cnVjdCBp
bnRlbF9hdG9taWNfc3RhdGU7DQo+ID4gIHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZTsNCj4gPiAg
c3RydWN0IGludGVsX3BsYW5lOw0KPiA+ICANCj4gPiAtI2RlZmluZSBDQU5fUFNSKGRldl9wcml2
KSAoSEFTX1BTUihkZXZfcHJpdikgJiYgZGV2X3ByaXYtDQo+ID4gPnBzci5zaW5rX3N1cHBvcnQp
DQo+ID4gKyNkZWZpbmUgQ0FOX1BTUihpbnRlbF9kcCkgKEhBU19QU1IoZHBfdG9faTkxNShpbnRl
bF9kcCkpICYmDQo+ID4gaW50ZWxfZHAtPnBzci5zaW5rX3N1cHBvcnQpDQo+ID4gIHZvaWQgaW50
ZWxfcHNyX2luaXRfZHBjZChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKTsNCj4gPiAgdm9pZCBp
bnRlbF9wc3JfZW5hYmxlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsDQo+ID4gIAkJICAgICAg
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsDQo+ID4gQEAgLTI4LDI0
ICsyOCwyNCBAQCB2b2lkIGludGVsX3Bzcl9kaXNhYmxlKHN0cnVjdCBpbnRlbF9kcA0KPiA+ICpp
bnRlbF9kcCwNCj4gPiAgdm9pZCBpbnRlbF9wc3JfdXBkYXRlKHN0cnVjdCBpbnRlbF9kcCAqaW50
ZWxfZHAsDQo+ID4gIAkJICAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUsDQo+ID4gIAkJICAgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNv
bm5fc3RhdGUpOw0KPiA+IC1pbnQgaW50ZWxfcHNyX2RlYnVnX3NldChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsIHU2NA0KPiA+IHZhbHVlKTsNCj4gPiAraW50IGludGVsX3Bzcl9k
ZWJ1Z19zZXQoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwgdTY0IHZhbHVlKTsNCj4gPiAgdm9p
ZCBpbnRlbF9wc3JfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
DQo+ID4gIAkJCSAgdW5zaWduZWQgZnJvbnRidWZmZXJfYml0cywNCj4gPiAgCQkJICBlbnVtIGZi
X29wX29yaWdpbiBvcmlnaW4pOw0KPiA+ICB2b2lkIGludGVsX3Bzcl9mbHVzaChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsDQo+ID4gIAkJICAgICB1bnNpZ25lZCBmcm9udGJ1ZmZl
cl9iaXRzLA0KPiA+ICAJCSAgICAgZW51bSBmYl9vcF9vcmlnaW4gb3JpZ2luKTsNCj4gPiAtdm9p
ZCBpbnRlbF9wc3JfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOw0KPiA+
ICt2b2lkIGludGVsX3Bzcl9pbml0KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApOw0KPiA+ICB2
b2lkIGludGVsX3Bzcl9jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLA0K
PiA+ICAJCQkgICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7DQo+ID4g
LXZvaWQgaW50ZWxfcHNyX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwgdTMyDQo+ID4gcHNyX2lpcik7DQo+ID4gK3ZvaWQgaW50ZWxfcHNyX2lycV9oYW5kbGVy
KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsIHUzMg0KPiA+IHBzcl9paXIpOw0KPiA+ICB2b2lk
IGludGVsX3Bzcl9zaG9ydF9wdWxzZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKTsNCj4gPiAt
aW50IGludGVsX3Bzcl93YWl0X2Zvcl9pZGxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
DQo+ID4gKm5ld19jcnRjX3N0YXRlLA0KPiA+IC0JCQkgICAgdTMyICpvdXRfdmFsdWUpOw0KPiA+
ICt2b2lkIGludGVsX3Bzcl93YWl0X2Zvcl9pZGxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlDQo+ID4gKm5ld19jcnRjX3N0YXRlKTsNCj4gPiAgYm9vbCBpbnRlbF9wc3JfZW5hYmxlZChz
dHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKTsNCj4gPiAgaW50IGludGVsX3BzcjJfc2VsX2ZldGNo
X3VwZGF0ZShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwNCj4gPiAgCQkJCXN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjKTsNCj4gPiAtdm9pZCBpbnRlbF9wc3IyX3Byb2dyYW1fdHJhbnNf
bWFuX3Rya19jdGwoY29uc3Qgc3RydWN0DQo+ID4gaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSk7DQo+ID4gK3ZvaWQgaW50ZWxfcHNyMl9wcm9ncmFtX3RyYW5zX21hbl90cmtfY3RsKHN0cnVj
dCBpbnRlbF9kcA0KPiA+ICppbnRlbF9kcCwNCj4gPiArCQkJCQkgIGNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlDQo+ID4gKmNydGNfc3RhdGUpOw0KPiA+ICB2b2lkIGludGVsX3BzcjJfcHJv
Z3JhbV9wbGFuZV9zZWxfZmV0Y2goc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwNCj4gPiAgCQkJ
CQljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZQ0KPiA+ICpjcnRjX3N0YXRlLA0KPiA+ICAJ
CQkJCWNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZQ0KPiA+ICpwbGFuZV9zdGF0ZSwNCj4g
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zcHJpdGUu
Yw0KPiA+IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zcHJpdGUuYw0KPiA+
IGluZGV4IGI3ZTIwODgxNjA3NC4uOTQ4MjM0YzYwNjQ4IDEwMDY0NA0KPiA+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3ByaXRlLmMNCj4gPiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nwcml0ZS5jDQo+ID4gQEAgLTg0LDcgKzg0LDYg
QEAgdm9pZCBpbnRlbF9waXBlX3VwZGF0ZV9zdGFydChjb25zdCBzdHJ1Y3QNCj4gPiBpbnRlbF9j
cnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0ZSkNCj4gPiAgCWJvb2wgbmVlZF92bHZfZHNpX3dhID0g
KElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8DQo+ID4gSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikp
ICYmDQo+ID4gIAkJaW50ZWxfY3J0Y19oYXNfdHlwZShuZXdfY3J0Y19zdGF0ZSwgSU5URUxfT1VU
UFVUX0RTSSk7DQo+ID4gIAlERUZJTkVfV0FJVCh3YWl0KTsNCj4gPiAtCXUzMiBwc3Jfc3RhdHVz
Ow0KPiA+ICANCj4gPiAgCWlmIChuZXdfY3J0Y19zdGF0ZS0+dWFwaS5hc3luY19mbGlwKQ0KPiA+
ICAJCXJldHVybjsNCj4gPiBAQCAtMTA5LDEwICsxMDgsNyBAQCB2b2lkIGludGVsX3BpcGVfdXBk
YXRlX3N0YXJ0KGNvbnN0IHN0cnVjdA0KPiA+IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0
YXRlKQ0KPiA+ICAJICogVkJMIGludGVycnVwdHMgd2lsbCBzdGFydCB0aGUgUFNSIGV4aXQgYW5k
IHByZXZlbnQgYSBQU1INCj4gPiAgCSAqIHJlLWVudHJ5IGFzIHdlbGwuDQo+ID4gIAkgKi8NCj4g
PiAtCWlmIChpbnRlbF9wc3Jfd2FpdF9mb3JfaWRsZShuZXdfY3J0Y19zdGF0ZSwgJnBzcl9zdGF0
dXMpKQ0KPiA+IC0JCWRybV9lcnIoJmRldl9wcml2LT5kcm0sDQo+ID4gLQkJCSJQU1IgaWRsZSB0
aW1lZCBvdXQgMHgleCwgYXRvbWljIHVwZGF0ZSBtYXkNCj4gPiBmYWlsXG4iLA0KPiA+IC0JCQlw
c3Jfc3RhdHVzKTsNCj4gPiArCWludGVsX3Bzcl93YWl0X2Zvcl9pZGxlKG5ld19jcnRjX3N0YXRl
KTsNCj4gPiAgDQo+ID4gIAlsb2NhbF9pcnFfZGlzYWJsZSgpOw0KPiA+ICANCj4gPiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaA0KPiA+IGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9kcnYuaA0KPiA+IGluZGV4IDVkMDRiMjgyYzA2MC4uYTJlMzllOGFkY2Jl
IDEwMDY0NA0KPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgNCj4gPiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oDQo+ID4gQEAgLTQ3NSw0MiArNDc1
LDYgQEAgc3RydWN0IGk5MTVfZHJycyB7DQo+ID4gIAllbnVtIGRycnNfc3VwcG9ydF90eXBlIHR5
cGU7DQo+ID4gIH07DQo+ID4gIA0KPiA+IC1zdHJ1Y3QgaTkxNV9wc3Igew0KPiA+IC0Jc3RydWN0
IG11dGV4IGxvY2s7DQo+ID4gLQ0KPiA+IC0jZGVmaW5lIEk5MTVfUFNSX0RFQlVHX01PREVfTUFT
SwkweDBmDQo+ID4gLSNkZWZpbmUgSTkxNV9QU1JfREVCVUdfREVGQVVMVAkJMHgwMA0KPiA+IC0j
ZGVmaW5lIEk5MTVfUFNSX0RFQlVHX0RJU0FCTEUJCTB4MDENCj4gPiAtI2RlZmluZSBJOTE1X1BT
Ul9ERUJVR19FTkFCTEUJCTB4MDINCj4gPiAtI2RlZmluZSBJOTE1X1BTUl9ERUJVR19GT1JDRV9Q
U1IxCTB4MDMNCj4gPiAtI2RlZmluZSBJOTE1X1BTUl9ERUJVR19JUlEJCTB4MTANCj4gPiAtDQo+
ID4gLQl1MzIgZGVidWc7DQo+ID4gLQlib29sIHNpbmtfc3VwcG9ydDsNCj4gPiAtCWJvb2wgZW5h
YmxlZDsNCj4gPiAtCXN0cnVjdCBpbnRlbF9kcCAqZHA7DQo+ID4gLQllbnVtIHBpcGUgcGlwZTsN
Cj4gPiAtCWVudW0gdHJhbnNjb2RlciB0cmFuc2NvZGVyOw0KPiA+IC0JYm9vbCBhY3RpdmU7DQo+
ID4gLQlzdHJ1Y3Qgd29ya19zdHJ1Y3Qgd29yazsNCj4gPiAtCXVuc2lnbmVkIGJ1c3lfZnJvbnRi
dWZmZXJfYml0czsNCj4gPiAtCWJvb2wgc2lua19wc3IyX3N1cHBvcnQ7DQo+ID4gLQlib29sIGxp
bmtfc3RhbmRieTsNCj4gPiAtCWJvb2wgY29sb3JpbWV0cnlfc3VwcG9ydDsNCj4gPiAtCWJvb2wg
cHNyMl9lbmFibGVkOw0KPiA+IC0JYm9vbCBwc3IyX3NlbF9mZXRjaF9lbmFibGVkOw0KPiA+IC0J
dTggc2lua19zeW5jX2xhdGVuY3k7DQo+ID4gLQlrdGltZV90IGxhc3RfZW50cnlfYXR0ZW1wdDsN
Cj4gPiAtCWt0aW1lX3QgbGFzdF9leGl0Ow0KPiA+IC0JYm9vbCBzaW5rX25vdF9yZWxpYWJsZTsN
Cj4gPiAtCWJvb2wgaXJxX2F1eF9lcnJvcjsNCj4gPiAtCXUxNiBzdV94X2dyYW51bGFyaXR5Ow0K
PiA+IC0JYm9vbCBkYzNjb19lbmFibGVkOw0KPiA+IC0JdTMyIGRjM2NvX2V4aXRfZGVsYXk7DQo+
ID4gLQlzdHJ1Y3QgZGVsYXllZF93b3JrIGRjM2NvX3dvcms7DQo+ID4gLQlzdHJ1Y3QgZHJtX2Rw
X3ZzY19zZHAgdnNjOw0KPiA+IC19Ow0KPiA+IC0NCj4gPiAgI2RlZmluZSBRVUlSS19MVkRTX1NT
Q19ESVNBQkxFICgxPDwxKQ0KPiA+ICAjZGVmaW5lIFFVSVJLX0lOVkVSVF9CUklHSFRORVNTICgx
PDwyKQ0KPiA+ICAjZGVmaW5lIFFVSVJLX0JBQ0tMSUdIVF9QUkVTRU5UICgxPDwzKQ0KPiA+IEBA
IC0xMDQxLDggKzEwMDUsNiBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSB7DQo+ID4gIA0KPiA+
ICAJc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyBwb3dlcl9kb21haW5zOw0KPiA+ICANCj4gPiAt
CXN0cnVjdCBpOTE1X3BzciBwc3I7DQo+ID4gLQ0KPiA+ICAJc3RydWN0IGk5MTVfZ3B1X2Vycm9y
IGdwdV9lcnJvcjsNCj4gPiAgDQo+ID4gIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqdmx2
X3BjdHg7DQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmMN
Cj4gPiBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmMNCj4gPiBpbmRleCA0OTFmODI1
MDBkNjguLjg1NDY3ODY1MjFiNSAxMDA2NDQNCj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2lycS5jDQo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9pcnEuYw0K
PiA+IEBAIC0yMDQ0LDEwICsyMDQ0LDIyIEBAIHN0YXRpYyB2b2lkIGl2Yl9kaXNwbGF5X2lycV9o
YW5kbGVyKHN0cnVjdA0KPiA+IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LA0KPiA+ICAJCWl2
Yl9lcnJfaW50X2hhbmRsZXIoZGV2X3ByaXYpOw0KPiA+ICANCj4gPiAgCWlmIChkZV9paXIgJiBE
RV9FRFBfUFNSX0lOVF9IU1cpIHsNCj4gPiAtCQl1MzIgcHNyX2lpciA9IGludGVsX3VuY29yZV9y
ZWFkKCZkZXZfcHJpdi0+dW5jb3JlLA0KPiA+IEVEUF9QU1JfSUlSKTsNCj4gPiArCQlzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlcjsNCj4gPiAgDQo+ID4gLQkJaW50ZWxfcHNyX2lycV9oYW5k
bGVyKGRldl9wcml2LCBwc3JfaWlyKTsNCj4gPiAtCQlpbnRlbF91bmNvcmVfd3JpdGUoJmRldl9w
cml2LT51bmNvcmUsIEVEUF9QU1JfSUlSLA0KPiA+IHBzcl9paXIpOw0KPiA+ICsJCWZvcl9lYWNo
X2ludGVsX2RwKCZkZXZfcHJpdi0+ZHJtLCBlbmNvZGVyKSB7DQo+ID4gKwkJCXN0cnVjdCBpbnRl
bF9kcCAqaW50ZWxfZHAgPQ0KPiA+IGVuY190b19pbnRlbF9kcChlbmNvZGVyKTsNCj4gPiArDQo+
ID4gKwkJCWlmIChlbmNvZGVyLT50eXBlID09IElOVEVMX09VVFBVVF9FRFAgJiYNCj4gPiArCQkJ
ICAgIENBTl9QU1IoaW50ZWxfZHApKSB7DQo+ID4gKwkJCQl1MzIgcHNyX2lpciA9DQo+ID4gaW50
ZWxfdW5jb3JlX3JlYWQoJmRldl9wcml2LT51bmNvcmUsDQo+ID4gKwkJCQkJCQkJRURQX1BTUg0K
PiA+IF9JSVIpOw0KPiA+ICsNCj4gPiArCQkJCWludGVsX3Bzcl9pcnFfaGFuZGxlcihpbnRlbF9k
cCwNCj4gPiBwc3JfaWlyKTsNCj4gPiArCQkJCWludGVsX3VuY29yZV93cml0ZSgmZGV2X3ByaXYt
PnVuY29yZSwNCj4gPiArCQkJCQkJICAgRURQX1BTUl9JSVIsDQo+ID4gcHNyX2lpcik7DQo+ID4g
KwkJCQlicmVhazsNCj4gPiArCQkJfQ0KPiA+ICsJCX0NCj4gPiAgCX0NCj4gPiAgDQo+ID4gIAlp
ZiAoZGVfaWlyICYgREVfQVVYX0NIQU5ORUxfQV9JVkIpDQo+ID4gQEAgLTIyNTUsMjEgKzIyNjcs
MzQgQEAgZ2VuOF9kZV9taXNjX2lycV9oYW5kbGVyKHN0cnVjdA0KPiA+IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LCB1MzIgaWlyKQ0KPiA+ICAJfQ0KPiA+ICANCj4gPiAgCWlmIChpaXIgJiBH
RU44X0RFX0VEUF9QU1IpIHsNCj4gPiArCQlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcjsN
Cj4gPiAgCQl1MzIgcHNyX2lpcjsNCj4gPiAgCQlpOTE1X3JlZ190IGlpcl9yZWc7DQo+ID4gIA0K
PiA+IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEyKQ0KPiA+IC0JCQlpaXJfcmVnID0g
VFJBTlNfUFNSX0lJUihkZXZfcHJpdi0NCj4gPiA+cHNyLnRyYW5zY29kZXIpOw0KPiA+IC0JCWVs
c2UNCj4gPiAtCQkJaWlyX3JlZyA9IEVEUF9QU1JfSUlSOw0KPiA+ICsJCWZvcl9lYWNoX2ludGVs
X2RwKCZkZXZfcHJpdi0+ZHJtLCBlbmNvZGVyKSB7DQo+ID4gKwkJCXN0cnVjdCBpbnRlbF9kcCAq
aW50ZWxfZHAgPQ0KPiA+IGVuY190b19pbnRlbF9kcChlbmNvZGVyKTsNCj4gPiAgDQo+ID4gLQkJ
cHNyX2lpciA9IGludGVsX3VuY29yZV9yZWFkKCZkZXZfcHJpdi0+dW5jb3JlLA0KPiA+IGlpcl9y
ZWcpOw0KPiA+IC0JCWludGVsX3VuY29yZV93cml0ZSgmZGV2X3ByaXYtPnVuY29yZSwgaWlyX3Jl
ZywNCj4gPiBwc3JfaWlyKTsNCj4gPiArCQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTIg
JiYNCj4gPiBDQU5fUFNSKGludGVsX2RwKSkgew0KPiA+ICsJCQkJaWlyX3JlZyA9IFRSQU5TX1BT
Ul9JSVIoaW50ZWxfZHAtDQo+ID4gPnBzci50cmFuc2NvZGVyKTsNCj4gPiArCQkJfSBlbHNlIGlm
IChlbmNvZGVyLT50eXBlID09IElOVEVMX09VVFBVVF9FRFAgJiYNCj4gPiArCQkJCSAgIENBTl9Q
U1IoaW50ZWxfZHApKSB7DQo+ID4gKwkJCQlpaXJfcmVnID0gRURQX1BTUl9JSVI7DQo+ID4gKwkJ
CX0gZWxzZSB7DQo+ID4gKwkJCQljb250aW51ZTsNCj4gPiArCQkJfQ0KPiA+ICsNCj4gPiArCQkJ
cHNyX2lpciA9IGludGVsX3VuY29yZV9yZWFkKCZkZXZfcHJpdi0+dW5jb3JlLA0KPiA+IGlpcl9y
ZWcpOw0KPiA+ICsJCQlpbnRlbF91bmNvcmVfd3JpdGUoJmRldl9wcml2LT51bmNvcmUsIGlpcl9y
ZWcsDQo+ID4gcHNyX2lpcik7DQo+ID4gKw0KPiA+ICsJCQlpZiAocHNyX2lpcikNCj4gPiArCQkJ
CWZvdW5kID0gdHJ1ZTsNCj4gPiAgDQo+ID4gLQkJaWYgKHBzcl9paXIpDQo+ID4gLQkJCWZvdW5k
ID0gdHJ1ZTsNCj4gPiArCQkJaW50ZWxfcHNyX2lycV9oYW5kbGVyKGludGVsX2RwLCBwc3JfaWly
KTsNCj4gPiAgDQo+ID4gLQkJaW50ZWxfcHNyX2lycV9oYW5kbGVyKGRldl9wcml2LCBwc3JfaWly
KTsNCj4gPiArCQkJLyogcHJpb3IgR0VOMTIgb25seSBoYXZlIG9uZSBFRFAgUFNSICovDQo+ID4g
KwkJCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgMTIpDQo+ID4gKwkJCQlicmVhazsNCj4gPiAr
CQl9DQo+ID4gIAl9DQo+ID4gIA0KPiA+ICAJaWYgKCFmb3VuZCkNCj4gPiAtLSANCj4gPiAyLjI1
LjANCj4gPiANCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
CkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpo
dHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeAo=

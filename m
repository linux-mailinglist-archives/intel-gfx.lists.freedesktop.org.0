Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 972EC2D4ED5
	for <lists+intel-gfx@lfdr.de>; Thu, 10 Dec 2020 00:36:29 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id BA2156E2A3;
	Wed,  9 Dec 2020 23:36:26 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (unknown [77.68.26.236])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 099946E284
 for <intel-gfx@lists.freedesktop.org>; Wed,  9 Dec 2020 23:36:22 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from build.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 23273374-1500050 
 for <intel-gfx@lists.freedesktop.org>; Wed, 09 Dec 2020 23:36:18 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed,  9 Dec 2020 23:36:18 +0000
Message-Id: <20201209233618.4287-3-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20201209233618.4287-1-chris@chris-wilson.co.uk>
References: <20201209233618.4287-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [CI 3/3] drm/i915: split gen8+ flush and bb_start
 emission functions to their own file
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogRGFuaWVsZSBDZXJhb2xvIFNwdXJpbyA8ZGFuaWVsZS5jZXJhb2xvc3B1cmlvQGludGVs
LmNvbT4KClRoZXNlIGZ1bmN0aW9ucyBhcmUgaW5kZXBlbmRlbnQgZnJvbSB0aGUgYmFja2VuZCB1
c2VkIGFuZCBjYW4gdGhlcmVmb3JlCmJlIHNwbGl0IG91dCBvZiB0aGUgZXhlbGlzdHMgc3VibWlz
c2lvbiBmaWxlLCBzbyB0aGV5IGNhbiBiZSByZS11c2VkIGJ5CnRoZSB1cGNvbWluZyBHdUMgc3Vi
bWlzc2lvbiBiYWNrZW5kLgoKQmFzZWQgb24gYSBwYXRjaCBieSBDaHJpcyBXaWxzb24uCgpTaWdu
ZWQtb2ZmLWJ5OiBEYW5pZWxlIENlcmFvbG8gU3B1cmlvIDxkYW5pZWxlLmNlcmFvbG9zcHVyaW9A
aW50ZWwuY29tPgpDYzogQ2hyaXMgUCBXaWxzb24gPGNocmlzLnAud2lsc29uQGludGVsLmNvbT4K
Q2M6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBsaW51eC5pbnRlbC5jb20+ClJldmll
d2VkLWJ5OiBKb2huIEhhcnJpc29uIDxKb2huLkMuSGFycmlzb25ASW50ZWwuY29tPgotLS0KIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlICAgICAgICAgICAgICAgICB8ICAgMSArCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9nZW44X2VuZ2luZV9jcy5jICAgICAgfCA2MTcgKysrKysrKysr
KysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2dlbjhfZW5naW5lX2NzLmggICAgICB8
ICAzNiArCiAuLi4vZHJtL2k5MTUvZ3QvaW50ZWxfZXhlY2xpc3RzX3N1Ym1pc3Npb24uYyAgfCA2
MjkgKy0tLS0tLS0tLS0tLS0tLS0tCiA0IGZpbGVzIGNoYW5nZWQsIDY2MiBpbnNlcnRpb25zKCsp
LCA2MjEgZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvZ2VuOF9lbmdpbmVfY3MuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2dlbjhfZW5naW5lX2NzLmgKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCmluZGV4IGFlZGJk
OGY1MmJlOC4uZjllZjUxOTliMTI0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9N
YWtlZmlsZQorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQpAQCAtODIsNiArODIs
NyBAQCBndC15ICs9IFwKIAlndC9nZW42X2VuZ2luZV9jcy5vIFwKIAlndC9nZW42X3BwZ3R0Lm8g
XAogCWd0L2dlbjdfcmVuZGVyY2xlYXIubyBcCisJZ3QvZ2VuOF9lbmdpbmVfY3MubyBcCiAJZ3Qv
Z2VuOF9wcGd0dC5vIFwKIAlndC9pbnRlbF9icmVhZGNydW1icy5vIFwKIAlndC9pbnRlbF9jb250
ZXh0Lm8gXApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZ2VuOF9lbmdpbmVf
Y3MuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2dlbjhfZW5naW5lX2NzLmMKbmV3IGZpbGUg
bW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi43NjJjYjBmMzNiZmMKLS0tIC9kZXYvbnVs
bAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9nZW44X2VuZ2luZV9jcy5jCkBAIC0wLDAg
KzEsNjE3IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCisvKgorICogQ29weXJp
Z2h0IMKpIDIwMTQgSW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisjaW5jbHVkZSAiZ2VuOF9lbmdp
bmVfY3MuaCIgLyogWFhYICovCisjaW5jbHVkZSAiaTkxNV9kcnYuaCIKKyNpbmNsdWRlICJpbnRl
bF9leGVjbGlzdHNfc3VibWlzc2lvbi5oIiAvKiBYWFggKi8KKyNpbmNsdWRlICJpbnRlbF9ncHVf
Y29tbWFuZHMuaCIKKyNpbmNsdWRlICJpbnRlbF9yaW5nLmgiCisKK2ludCBnZW44X2VtaXRfZmx1
c2hfcmNzKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCB1MzIgbW9kZSkKK3sKKwlib29sIHZmX2Zs
dXNoX3dhID0gZmFsc2UsIGRjX2ZsdXNoX3dhID0gZmFsc2U7CisJdTMyICpjcywgZmxhZ3MgPSAw
OworCWludCBsZW47CisKKwlmbGFncyB8PSBQSVBFX0NPTlRST0xfQ1NfU1RBTEw7CisKKwlpZiAo
bW9kZSAmIEVNSVRfRkxVU0gpIHsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1JFTkRFUl9UQVJH
RVRfQ0FDSEVfRkxVU0g7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9ERVBUSF9DQUNIRV9GTFVT
SDsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0RDX0ZMVVNIX0VOQUJMRTsKKwkJZmxhZ3MgfD0g
UElQRV9DT05UUk9MX0ZMVVNIX0VOQUJMRTsKKwl9CisKKwlpZiAobW9kZSAmIEVNSVRfSU5WQUxJ
REFURSkgeworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfVExCX0lOVkFMSURBVEU7CisJCWZsYWdz
IHw9IFBJUEVfQ09OVFJPTF9JTlNUUlVDVElPTl9DQUNIRV9JTlZBTElEQVRFOworCQlmbGFncyB8
PSBQSVBFX0NPTlRST0xfVEVYVFVSRV9DQUNIRV9JTlZBTElEQVRFOworCQlmbGFncyB8PSBQSVBF
X0NPTlRST0xfVkZfQ0FDSEVfSU5WQUxJREFURTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0NP
TlNUX0NBQ0hFX0lOVkFMSURBVEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9TVEFURV9DQUNI
RV9JTlZBTElEQVRFOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfUVdfV1JJVEU7CisJCWZsYWdz
IHw9IFBJUEVfQ09OVFJPTF9TVE9SRV9EQVRBX0lOREVYOworCisJCS8qCisJCSAqIE9uIEdFTjk6
IGJlZm9yZSBWRl9DQUNIRV9JTlZBTElEQVRFIHdlIG5lZWQgdG8gZW1pdCBhIE5VTEwKKwkJICog
cGlwZSBjb250cm9sLgorCQkgKi8KKwkJaWYgKElTX0dFTihycS0+ZW5naW5lLT5pOTE1LCA5KSkK
KwkJCXZmX2ZsdXNoX3dhID0gdHJ1ZTsKKworCQkvKiBXYUZvckdBTUhhbmc6a2JsICovCisJCWlm
IChJU19LQkxfR1RfUkVWSUQocnEtPmVuZ2luZS0+aTkxNSwgMCwgS0JMX1JFVklEX0IwKSkKKwkJ
CWRjX2ZsdXNoX3dhID0gdHJ1ZTsKKwl9CisKKwlsZW4gPSA2OworCisJaWYgKHZmX2ZsdXNoX3dh
KQorCQlsZW4gKz0gNjsKKworCWlmIChkY19mbHVzaF93YSkKKwkJbGVuICs9IDEyOworCisJY3Mg
PSBpbnRlbF9yaW5nX2JlZ2luKHJxLCBsZW4pOworCWlmIChJU19FUlIoY3MpKQorCQlyZXR1cm4g
UFRSX0VSUihjcyk7CisKKwlpZiAodmZfZmx1c2hfd2EpCisJCWNzID0gZ2VuOF9lbWl0X3BpcGVf
Y29udHJvbChjcywgMCwgMCk7CisKKwlpZiAoZGNfZmx1c2hfd2EpCisJCWNzID0gZ2VuOF9lbWl0
X3BpcGVfY29udHJvbChjcywgUElQRV9DT05UUk9MX0RDX0ZMVVNIX0VOQUJMRSwKKwkJCQkJICAg
IDApOworCisJY3MgPSBnZW44X2VtaXRfcGlwZV9jb250cm9sKGNzLCBmbGFncywgTFJDX1BQSFdT
UF9TQ1JBVENIX0FERFIpOworCisJaWYgKGRjX2ZsdXNoX3dhKQorCQljcyA9IGdlbjhfZW1pdF9w
aXBlX2NvbnRyb2woY3MsIFBJUEVfQ09OVFJPTF9DU19TVEFMTCwgMCk7CisKKwlpbnRlbF9yaW5n
X2FkdmFuY2UocnEsIGNzKTsKKworCXJldHVybiAwOworfQorCitpbnQgZ2VuOF9lbWl0X2ZsdXNo
X3hjcyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgdTMyIG1vZGUpCit7CisJdTMyIGNtZCwgKmNz
OworCisJY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJxLCA0KTsKKwlpZiAoSVNfRVJSKGNzKSkKKwkJ
cmV0dXJuIFBUUl9FUlIoY3MpOworCisJY21kID0gTUlfRkxVU0hfRFcgKyAxOworCisJLyogV2Ug
YWx3YXlzIHJlcXVpcmUgYSBjb21tYW5kIGJhcnJpZXIgc28gdGhhdCBzdWJzZXF1ZW50CisJICog
Y29tbWFuZHMsIHN1Y2ggYXMgYnJlYWRjcnVtYiBpbnRlcnJ1cHRzLCBhcmUgc3RyaWN0bHkgb3Jk
ZXJlZAorCSAqIHdydCB0aGUgY29udGVudHMgb2YgdGhlIHdyaXRlIGNhY2hlIGJlaW5nIGZsdXNo
ZWQgdG8gbWVtb3J5CisJICogKGFuZCB0aHVzIGJlaW5nIGNvaGVyZW50IGZyb20gdGhlIENQVSku
CisJICovCisJY21kIHw9IE1JX0ZMVVNIX0RXX1NUT1JFX0lOREVYIHwgTUlfRkxVU0hfRFdfT1Bf
U1RPUkVEVzsKKworCWlmIChtb2RlICYgRU1JVF9JTlZBTElEQVRFKSB7CisJCWNtZCB8PSBNSV9J
TlZBTElEQVRFX1RMQjsKKwkJaWYgKHJxLT5lbmdpbmUtPmNsYXNzID09IFZJREVPX0RFQ09ERV9D
TEFTUykKKwkJCWNtZCB8PSBNSV9JTlZBTElEQVRFX0JTRDsKKwl9CisKKwkqY3MrKyA9IGNtZDsK
KwkqY3MrKyA9IExSQ19QUEhXU1BfU0NSQVRDSF9BRERSOworCSpjcysrID0gMDsgLyogdXBwZXIg
YWRkciAqLworCSpjcysrID0gMDsgLyogdmFsdWUgKi8KKwlpbnRlbF9yaW5nX2FkdmFuY2UocnEs
IGNzKTsKKworCXJldHVybiAwOworfQorCitpbnQgZ2VuMTFfZW1pdF9mbHVzaF9yY3Moc3RydWN0
IGk5MTVfcmVxdWVzdCAqcnEsIHUzMiBtb2RlKQoreworCWlmIChtb2RlICYgRU1JVF9GTFVTSCkg
eworCQl1MzIgKmNzOworCQl1MzIgZmxhZ3MgPSAwOworCisJCWZsYWdzIHw9IFBJUEVfQ09OVFJP
TF9DU19TVEFMTDsKKworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfVElMRV9DQUNIRV9GTFVTSDsK
KwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1JFTkRFUl9UQVJHRVRfQ0FDSEVfRkxVU0g7CisJCWZs
YWdzIHw9IFBJUEVfQ09OVFJPTF9ERVBUSF9DQUNIRV9GTFVTSDsKKwkJZmxhZ3MgfD0gUElQRV9D
T05UUk9MX0RDX0ZMVVNIX0VOQUJMRTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0ZMVVNIX0VO
QUJMRTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1FXX1dSSVRFOworCQlmbGFncyB8PSBQSVBF
X0NPTlRST0xfU1RPUkVfREFUQV9JTkRFWDsKKworCQljcyA9IGludGVsX3JpbmdfYmVnaW4ocnEs
IDYpOworCQlpZiAoSVNfRVJSKGNzKSkKKwkJCXJldHVybiBQVFJfRVJSKGNzKTsKKworCQljcyA9
IGdlbjhfZW1pdF9waXBlX2NvbnRyb2woY3MsIGZsYWdzLCBMUkNfUFBIV1NQX1NDUkFUQ0hfQURE
Uik7CisJCWludGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOworCX0KKworCWlmIChtb2RlICYgRU1J
VF9JTlZBTElEQVRFKSB7CisJCXUzMiAqY3M7CisJCXUzMiBmbGFncyA9IDA7CisKKwkJZmxhZ3Mg
fD0gUElQRV9DT05UUk9MX0NTX1NUQUxMOworCisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9DT01N
QU5EX0NBQ0hFX0lOVkFMSURBVEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9UTEJfSU5WQUxJ
REFURTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0lOU1RSVUNUSU9OX0NBQ0hFX0lOVkFMSURB
VEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9URVhUVVJFX0NBQ0hFX0lOVkFMSURBVEU7CisJ
CWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9WRl9DQUNIRV9JTlZBTElEQVRFOworCQlmbGFncyB8PSBQ
SVBFX0NPTlRST0xfQ09OU1RfQ0FDSEVfSU5WQUxJREFURTsKKwkJZmxhZ3MgfD0gUElQRV9DT05U
Uk9MX1NUQVRFX0NBQ0hFX0lOVkFMSURBVEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9RV19X
UklURTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1NUT1JFX0RBVEFfSU5ERVg7CisKKwkJY3Mg
PSBpbnRlbF9yaW5nX2JlZ2luKHJxLCA2KTsKKwkJaWYgKElTX0VSUihjcykpCisJCQlyZXR1cm4g
UFRSX0VSUihjcyk7CisKKwkJY3MgPSBnZW44X2VtaXRfcGlwZV9jb250cm9sKGNzLCBmbGFncywg
TFJDX1BQSFdTUF9TQ1JBVENIX0FERFIpOworCQlpbnRlbF9yaW5nX2FkdmFuY2UocnEsIGNzKTsK
Kwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHUzMiBwcmVwYXJzZXJfZGlzYWJsZShib29s
IHN0YXRlKQoreworCXJldHVybiBNSV9BUkJfQ0hFQ0sgfCAxIDw8IDggfCBzdGF0ZTsKK30KKwor
c3RhdGljIGk5MTVfcmVnX3QgYXV4X2ludl9yZWcoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lKQoreworCXN0YXRpYyBjb25zdCBpOTE1X3JlZ190IHZkW10gPSB7CisJCUdFTjEy
X1ZEMF9BVVhfTlYsCisJCUdFTjEyX1ZEMV9BVVhfTlYsCisJCUdFTjEyX1ZEMl9BVVhfTlYsCisJ
CUdFTjEyX1ZEM19BVVhfTlYsCisJfTsKKworCXN0YXRpYyBjb25zdCBpOTE1X3JlZ190IHZlW10g
PSB7CisJCUdFTjEyX1ZFMF9BVVhfTlYsCisJCUdFTjEyX1ZFMV9BVVhfTlYsCisJfTsKKworCWlm
IChlbmdpbmUtPmNsYXNzID09IFZJREVPX0RFQ09ERV9DTEFTUykKKwkJcmV0dXJuIHZkW2VuZ2lu
ZS0+aW5zdGFuY2VdOworCisJaWYgKGVuZ2luZS0+Y2xhc3MgPT0gVklERU9fRU5IQU5DRU1FTlRf
Q0xBU1MpCisJCXJldHVybiB2ZVtlbmdpbmUtPmluc3RhbmNlXTsKKworCUdFTV9CVUdfT04oInVu
a25vd24gYXV4X2ludiByZWdcbiIpOworCXJldHVybiBJTlZBTElEX01NSU9fUkVHOworfQorCitz
dGF0aWMgdTMyICpnZW4xMl9lbWl0X2F1eF90YWJsZV9pbnYoY29uc3QgaTkxNV9yZWdfdCBpbnZf
cmVnLCB1MzIgKmNzKQoreworCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oMSk7CisJKmNz
KysgPSBpOTE1X21taW9fcmVnX29mZnNldChpbnZfcmVnKTsKKwkqY3MrKyA9IEFVWF9JTlY7CisJ
KmNzKysgPSBNSV9OT09QOworCisJcmV0dXJuIGNzOworfQorCitpbnQgZ2VuMTJfZW1pdF9mbHVz
aF9yY3Moc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsIHUzMiBtb2RlKQoreworCWlmIChtb2RlICYg
RU1JVF9GTFVTSCkgeworCQl1MzIgZmxhZ3MgPSAwOworCQl1MzIgKmNzOworCisJCWZsYWdzIHw9
IFBJUEVfQ09OVFJPTF9USUxFX0NBQ0hFX0ZMVVNIOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xf
RkxVU0hfTDM7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9SRU5ERVJfVEFSR0VUX0NBQ0hFX0ZM
VVNIOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfREVQVEhfQ0FDSEVfRkxVU0g7CisJCS8qIFdh
XzE0MDk2MDA5MDc6dGdsICovCisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9ERVBUSF9TVEFMTDsK
KwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0RDX0ZMVVNIX0VOQUJMRTsKKwkJZmxhZ3MgfD0gUElQ
RV9DT05UUk9MX0ZMVVNIX0VOQUJMRTsKKworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfU1RPUkVf
REFUQV9JTkRFWDsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1FXX1dSSVRFOworCisJCWZsYWdz
IHw9IFBJUEVfQ09OVFJPTF9DU19TVEFMTDsKKworCQljcyA9IGludGVsX3JpbmdfYmVnaW4ocnEs
IDYpOworCQlpZiAoSVNfRVJSKGNzKSkKKwkJCXJldHVybiBQVFJfRVJSKGNzKTsKKworCQljcyA9
IGdlbjEyX2VtaXRfcGlwZV9jb250cm9sKGNzLAorCQkJCQkgICAgIFBJUEVfQ09OVFJPTDBfSERD
X1BJUEVMSU5FX0ZMVVNILAorCQkJCQkgICAgIGZsYWdzLCBMUkNfUFBIV1NQX1NDUkFUQ0hfQURE
Uik7CisJCWludGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOworCX0KKworCWlmIChtb2RlICYgRU1J
VF9JTlZBTElEQVRFKSB7CisJCXUzMiBmbGFncyA9IDA7CisJCXUzMiAqY3M7CisKKwkJZmxhZ3Mg
fD0gUElQRV9DT05UUk9MX0NPTU1BTkRfQ0FDSEVfSU5WQUxJREFURTsKKwkJZmxhZ3MgfD0gUElQ
RV9DT05UUk9MX1RMQl9JTlZBTElEQVRFOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfSU5TVFJV
Q1RJT05fQ0FDSEVfSU5WQUxJREFURTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1RFWFRVUkVf
Q0FDSEVfSU5WQUxJREFURTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1ZGX0NBQ0hFX0lOVkFM
SURBVEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9DT05TVF9DQUNIRV9JTlZBTElEQVRFOwor
CQlmbGFncyB8PSBQSVBFX0NPTlRST0xfU1RBVEVfQ0FDSEVfSU5WQUxJREFURTsKKworCQlmbGFn
cyB8PSBQSVBFX0NPTlRST0xfU1RPUkVfREFUQV9JTkRFWDsKKwkJZmxhZ3MgfD0gUElQRV9DT05U
Uk9MX1FXX1dSSVRFOworCisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9DU19TVEFMTDsKKworCQlj
cyA9IGludGVsX3JpbmdfYmVnaW4ocnEsIDggKyA0KTsKKwkJaWYgKElTX0VSUihjcykpCisJCQly
ZXR1cm4gUFRSX0VSUihjcyk7CisKKwkJLyoKKwkJICogUHJldmVudCB0aGUgcHJlLXBhcnNlciBm
cm9tIHNraXBwaW5nIHBhc3QgdGhlIFRMQgorCQkgKiBpbnZhbGlkYXRlIGFuZCBsb2FkaW5nIGEg
c3RhbGUgcGFnZSBmb3IgdGhlIGJhdGNoCisJCSAqIGJ1ZmZlciAvIHJlcXVlc3QgcGF5bG9hZC4K
KwkJICovCisJCSpjcysrID0gcHJlcGFyc2VyX2Rpc2FibGUodHJ1ZSk7CisKKwkJY3MgPSBnZW44
X2VtaXRfcGlwZV9jb250cm9sKGNzLCBmbGFncywgTFJDX1BQSFdTUF9TQ1JBVENIX0FERFIpOwor
CisJCS8qIGhzZGVzOiAxODA5MTc1NzkwICovCisJCWNzID0gZ2VuMTJfZW1pdF9hdXhfdGFibGVf
aW52KEdFTjEyX0dGWF9DQ1NfQVVYX05WLCBjcyk7CisKKwkJKmNzKysgPSBwcmVwYXJzZXJfZGlz
YWJsZShmYWxzZSk7CisJCWludGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOworCX0KKworCXJldHVy
biAwOworfQorCitpbnQgZ2VuMTJfZW1pdF9mbHVzaF94Y3Moc3RydWN0IGk5MTVfcmVxdWVzdCAq
cnEsIHUzMiBtb2RlKQoreworCWludGVsX2VuZ2luZV9tYXNrX3QgYXV4X2ludiA9IDA7CisJdTMy
IGNtZCwgKmNzOworCisJY21kID0gNDsKKwlpZiAobW9kZSAmIEVNSVRfSU5WQUxJREFURSkKKwkJ
Y21kICs9IDI7CisJaWYgKG1vZGUgJiBFTUlUX0lOVkFMSURBVEUpCisJCWF1eF9pbnYgPSBycS0+
ZW5naW5lLT5tYXNrICYgfkJJVChCQ1MwKTsKKwlpZiAoYXV4X2ludikKKwkJY21kICs9IDIgKiBo
d2VpZ2h0OChhdXhfaW52KSArIDI7CisKKwljcyA9IGludGVsX3JpbmdfYmVnaW4ocnEsIGNtZCk7
CisJaWYgKElTX0VSUihjcykpCisJCXJldHVybiBQVFJfRVJSKGNzKTsKKworCWlmIChtb2RlICYg
RU1JVF9JTlZBTElEQVRFKQorCQkqY3MrKyA9IHByZXBhcnNlcl9kaXNhYmxlKHRydWUpOworCisJ
Y21kID0gTUlfRkxVU0hfRFcgKyAxOworCisJLyogV2UgYWx3YXlzIHJlcXVpcmUgYSBjb21tYW5k
IGJhcnJpZXIgc28gdGhhdCBzdWJzZXF1ZW50CisJICogY29tbWFuZHMsIHN1Y2ggYXMgYnJlYWRj
cnVtYiBpbnRlcnJ1cHRzLCBhcmUgc3RyaWN0bHkgb3JkZXJlZAorCSAqIHdydCB0aGUgY29udGVu
dHMgb2YgdGhlIHdyaXRlIGNhY2hlIGJlaW5nIGZsdXNoZWQgdG8gbWVtb3J5CisJICogKGFuZCB0
aHVzIGJlaW5nIGNvaGVyZW50IGZyb20gdGhlIENQVSkuCisJICovCisJY21kIHw9IE1JX0ZMVVNI
X0RXX1NUT1JFX0lOREVYIHwgTUlfRkxVU0hfRFdfT1BfU1RPUkVEVzsKKworCWlmIChtb2RlICYg
RU1JVF9JTlZBTElEQVRFKSB7CisJCWNtZCB8PSBNSV9JTlZBTElEQVRFX1RMQjsKKwkJaWYgKHJx
LT5lbmdpbmUtPmNsYXNzID09IFZJREVPX0RFQ09ERV9DTEFTUykKKwkJCWNtZCB8PSBNSV9JTlZB
TElEQVRFX0JTRDsKKwl9CisKKwkqY3MrKyA9IGNtZDsKKwkqY3MrKyA9IExSQ19QUEhXU1BfU0NS
QVRDSF9BRERSOworCSpjcysrID0gMDsgLyogdXBwZXIgYWRkciAqLworCSpjcysrID0gMDsgLyog
dmFsdWUgKi8KKworCWlmIChhdXhfaW52KSB7IC8qIGhzZGVzOiAxODA5MTc1NzkwICovCisJCXN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKKwkJdW5zaWduZWQgaW50IHRtcDsKKworCQkq
Y3MrKyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKGh3ZWlnaHQ4KGF1eF9pbnYpKTsKKwkJZm9yX2Vh
Y2hfZW5naW5lX21hc2tlZChlbmdpbmUsIHJxLT5lbmdpbmUtPmd0LAorCQkJCSAgICAgICBhdXhf
aW52LCB0bXApIHsKKwkJCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoYXV4X2ludl9yZWco
ZW5naW5lKSk7CisJCQkqY3MrKyA9IEFVWF9JTlY7CisJCX0KKwkJKmNzKysgPSBNSV9OT09QOwor
CX0KKworCWlmIChtb2RlICYgRU1JVF9JTlZBTElEQVRFKQorCQkqY3MrKyA9IHByZXBhcnNlcl9k
aXNhYmxlKGZhbHNlKTsKKworCWludGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOworCisJcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyBpbmxpbmUgdTMyIHByZWVtcHRfYWRkcmVzcyhzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUpCit7CisJcmV0dXJuIChpOTE1X2dndHRfb2Zmc2V0KGVuZ2luZS0+
c3RhdHVzX3BhZ2Uudm1hKSArCisJCUk5MTVfR0VNX0hXU19QUkVFTVBUX0FERFIpOworfQorCitz
dGF0aWMgdTMyIGh3c3Bfb2Zmc2V0KGNvbnN0IHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQorewor
CWNvbnN0IHN0cnVjdCBpbnRlbF90aW1lbGluZV9jYWNoZWxpbmUgKmNsOworCisJLyogQmVmb3Jl
IHRoZSByZXF1ZXN0IGlzIGV4ZWN1dGVkLCB0aGUgdGltZWxpbmUvY2FjaGxpbmUgaXMgZml4ZWQg
Ki8KKworCWNsID0gcmN1X2RlcmVmZXJlbmNlX3Byb3RlY3RlZChycS0+aHdzcF9jYWNoZWxpbmUs
IDEpOworCWlmIChjbCkKKwkJcmV0dXJuIGNsLT5nZ3R0X29mZnNldDsKKworCXJldHVybiByY3Vf
ZGVyZWZlcmVuY2VfcHJvdGVjdGVkKHJxLT50aW1lbGluZSwgMSktPmh3c3Bfb2Zmc2V0OworfQor
CitpbnQgZ2VuOF9lbWl0X2luaXRfYnJlYWRjcnVtYihzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkK
K3sKKwl1MzIgKmNzOworCisJR0VNX0JVR19PTihpOTE1X3JlcXVlc3RfaGFzX2luaXRpYWxfYnJl
YWRjcnVtYihycSkpOworCWlmICghaTkxNV9yZXF1ZXN0X3RpbWVsaW5lKHJxKS0+aGFzX2luaXRp
YWxfYnJlYWRjcnVtYikKKwkJcmV0dXJuIDA7CisKKwljcyA9IGludGVsX3JpbmdfYmVnaW4ocnEs
IDYpOworCWlmIChJU19FUlIoY3MpKQorCQlyZXR1cm4gUFRSX0VSUihjcyk7CisKKwkvKgorCSAq
IENoZWNrIGlmIHdlIGhhdmUgYmVlbiBwcmVlbXB0ZWQgYmVmb3JlIHdlIGV2ZW4gZ2V0IHN0YXJ0
ZWQuCisJICoKKwkgKiBBZnRlciB0aGlzIHBvaW50IGk5MTVfcmVxdWVzdF9zdGFydGVkKCkgcmVw
b3J0cyB0cnVlLCBldmVuIGlmCisJICogd2UgZ2V0IHByZWVtcHRlZCBhbmQgc28gYXJlIG5vIGxv
bmdlciBydW5uaW5nLgorCSAqLworCSpjcysrID0gTUlfQVJCX0NIRUNLOworCSpjcysrID0gTUlf
Tk9PUDsKKworCSpjcysrID0gTUlfU1RPUkVfRFdPUkRfSU1NX0dFTjQgfCBNSV9VU0VfR0dUVDsK
KwkqY3MrKyA9IGh3c3Bfb2Zmc2V0KHJxKTsKKwkqY3MrKyA9IDA7CisJKmNzKysgPSBycS0+ZmVu
Y2Uuc2Vxbm8gLSAxOworCisJaW50ZWxfcmluZ19hZHZhbmNlKHJxLCBjcyk7CisKKwkvKiBSZWNv
cmQgdGhlIHVwZGF0ZWQgcG9zaXRpb24gb2YgdGhlIHJlcXVlc3QncyBwYXlsb2FkICovCisJcnEt
PmluZml4ID0gaW50ZWxfcmluZ19vZmZzZXQocnEsIGNzKTsKKworCV9fc2V0X2JpdChJOTE1X0ZF
TkNFX0ZMQUdfSU5JVElBTF9CUkVBRENSVU1CLCAmcnEtPmZlbmNlLmZsYWdzKTsKKworCXJldHVy
biAwOworfQorCitpbnQgZ2VuOF9lbWl0X2JiX3N0YXJ0X25vYXJiKHN0cnVjdCBpOTE1X3JlcXVl
c3QgKnJxLAorCQkJICAgICB1NjQgb2Zmc2V0LCB1MzIgbGVuLAorCQkJICAgICBjb25zdCB1bnNp
Z25lZCBpbnQgZmxhZ3MpCit7CisJdTMyICpjczsKKworCWNzID0gaW50ZWxfcmluZ19iZWdpbihy
cSwgNCk7CisJaWYgKElTX0VSUihjcykpCisJCXJldHVybiBQVFJfRVJSKGNzKTsKKworCS8qCisJ
ICogV2FEaXNhYmxlQ3R4UmVzdG9yZUFyYml0cmF0aW9uOmJkdyxjaHYKKwkgKgorCSAqIFdlIGRv
bid0IG5lZWQgdG8gcGVyZm9ybSBNSV9BUkJfRU5BQkxFIGFzIG9mdGVuIGFzIHdlIGRvIChpbgor
CSAqIHBhcnRpY3VsYXIgYWxsIHRoZSBnZW4gdGhhdCBkbyBub3QgbmVlZCB0aGUgdy9hIGF0IGFs
bCEpLCBpZiB3ZQorCSAqIHRvb2sgY2FyZSB0byBtYWtlIHN1cmUgdGhhdCBvbiBldmVyeSBzd2l0
Y2ggaW50byB0aGlzIGNvbnRleHQKKwkgKiAoYm90aCBvcmRpbmFyeSBhbmQgZm9yIHByZWVtcHRp
b24pIHRoYXQgYXJiaXRyYXJ0aW9uIHdhcyBlbmFibGVkCisJICogd2Ugd291bGQgYmUgZmluZS4g
IEhvd2V2ZXIsIGZvciBnZW44IHRoZXJlIGlzIGFub3RoZXIgdy9hIHRoYXQKKwkgKiByZXF1aXJl
cyB1cyB0byBub3QgcHJlZW1wdCBpbnNpZGUgR1BHUFUgZXhlY3V0aW9uLCBzbyB3ZSBrZWVwCisJ
ICogYXJiaXRyYXRpb24gZGlzYWJsZWQgZm9yIGdlbjggYmF0Y2hlcy4gQXJiaXRyYXRpb24gd2ls
bCBiZQorCSAqIHJlLWVuYWJsZWQgYmVmb3JlIHdlIGNsb3NlIHRoZSByZXF1ZXN0CisJICogKGVu
Z2luZS0+ZW1pdF9maW5pX2JyZWFkY3J1bWIpLgorCSAqLworCSpjcysrID0gTUlfQVJCX09OX09G
RiB8IE1JX0FSQl9ESVNBQkxFOworCisJLyogRklYTUUoQkRXKyk6IEFkZHJlc3Mgc3BhY2UgYW5k
IHNlY3VyaXR5IHNlbGVjdG9ycy4gKi8KKwkqY3MrKyA9IE1JX0JBVENIX0JVRkZFUl9TVEFSVF9H
RU44IHwKKwkJKGZsYWdzICYgSTkxNV9ESVNQQVRDSF9TRUNVUkUgPyAwIDogQklUKDgpKTsKKwkq
Y3MrKyA9IGxvd2VyXzMyX2JpdHMob2Zmc2V0KTsKKwkqY3MrKyA9IHVwcGVyXzMyX2JpdHMob2Zm
c2V0KTsKKworCWludGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOworCisJcmV0dXJuIDA7Cit9CisK
K2ludCBnZW44X2VtaXRfYmJfc3RhcnQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCisJCSAgICAg
ICB1NjQgb2Zmc2V0LCB1MzIgbGVuLAorCQkgICAgICAgY29uc3QgdW5zaWduZWQgaW50IGZsYWdz
KQoreworCXUzMiAqY3M7CisKKwljcyA9IGludGVsX3JpbmdfYmVnaW4ocnEsIDYpOworCWlmIChJ
U19FUlIoY3MpKQorCQlyZXR1cm4gUFRSX0VSUihjcyk7CisKKwkqY3MrKyA9IE1JX0FSQl9PTl9P
RkYgfCBNSV9BUkJfRU5BQkxFOworCisJKmNzKysgPSBNSV9CQVRDSF9CVUZGRVJfU1RBUlRfR0VO
OCB8CisJCShmbGFncyAmIEk5MTVfRElTUEFUQ0hfU0VDVVJFID8gMCA6IEJJVCg4KSk7CisJKmNz
KysgPSBsb3dlcl8zMl9iaXRzKG9mZnNldCk7CisJKmNzKysgPSB1cHBlcl8zMl9iaXRzKG9mZnNl
dCk7CisKKwkqY3MrKyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJfRElTQUJMRTsKKwkqY3MrKyA9
IE1JX05PT1A7CisKKwlpbnRlbF9yaW5nX2FkdmFuY2UocnEsIGNzKTsKKworCXJldHVybiAwOwor
fQorCitzdGF0aWMgdm9pZCBhc3NlcnRfcmVxdWVzdF92YWxpZChzdHJ1Y3QgaTkxNV9yZXF1ZXN0
ICpycSkKK3sKKwlzdHJ1Y3QgaW50ZWxfcmluZyAqcmluZyBfX21heWJlX3VudXNlZCA9IHJxLT5y
aW5nOworCisJLyogQ2FuIHdlIHVud2luZCB0aGlzIHJlcXVlc3Qgd2l0aG91dCBhcHBlYXJpbmcg
dG8gZ28gZm9yd2FyZHM/ICovCisJR0VNX0JVR19PTihpbnRlbF9yaW5nX2RpcmVjdGlvbihyaW5n
LCBycS0+d2FfdGFpbCwgcnEtPmhlYWQpIDw9IDApOworfQorCisvKgorICogUmVzZXJ2ZSBzcGFj
ZSBmb3IgMiBOT09QcyBhdCB0aGUgZW5kIG9mIGVhY2ggcmVxdWVzdCB0byBiZQorICogdXNlZCBh
cyBhIHdvcmthcm91bmQgZm9yIG5vdCBiZWluZyBhbGxvd2VkIHRvIGRvIGxpdGUKKyAqIHJlc3Rv
cmUgd2l0aCBIRUFEPT1UQUlMIChXYUlkbGVMaXRlUmVzdG9yZSkuCisgKi8KK3N0YXRpYyB1MzIg
KmdlbjhfZW1pdF93YV90YWlsKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCB1MzIgKmNzKQorewor
CS8qIEVuc3VyZSB0aGVyZSdzIGFsd2F5cyBhdCBsZWFzdCBvbmUgcHJlZW1wdGlvbiBwb2ludCBw
ZXItcmVxdWVzdC4gKi8KKwkqY3MrKyA9IE1JX0FSQl9DSEVDSzsKKwkqY3MrKyA9IE1JX05PT1A7
CisJcnEtPndhX3RhaWwgPSBpbnRlbF9yaW5nX29mZnNldChycSwgY3MpOworCisJLyogQ2hlY2sg
dGhhdCBlbnRpcmUgcmVxdWVzdCBpcyBsZXNzIHRoYW4gaGFsZiB0aGUgcmluZyAqLworCWFzc2Vy
dF9yZXF1ZXN0X3ZhbGlkKHJxKTsKKworCXJldHVybiBjczsKK30KKworc3RhdGljIHUzMiAqZW1p
dF9wcmVlbXB0X2J1c3l3YWl0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCB1MzIgKmNzKQorewor
CSpjcysrID0gTUlfU0VNQVBIT1JFX1dBSVQgfAorCQlNSV9TRU1BUEhPUkVfR0xPQkFMX0dUVCB8
CisJCU1JX1NFTUFQSE9SRV9QT0xMIHwKKwkJTUlfU0VNQVBIT1JFX1NBRF9FUV9TREQ7CisJKmNz
KysgPSAwOworCSpjcysrID0gcHJlZW1wdF9hZGRyZXNzKHJxLT5lbmdpbmUpOworCSpjcysrID0g
MDsKKworCXJldHVybiBjczsKK30KKworc3RhdGljIF9fYWx3YXlzX2lubGluZSB1MzIqCitnZW44
X2VtaXRfZmluaV9icmVhZGNydW1iX3RhaWwoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsIHUzMiAq
Y3MpCit7CisJKmNzKysgPSBNSV9VU0VSX0lOVEVSUlVQVDsKKworCSpjcysrID0gTUlfQVJCX09O
X09GRiB8IE1JX0FSQl9FTkFCTEU7CisJaWYgKGludGVsX2VuZ2luZV9oYXNfc2VtYXBob3Jlcyhy
cS0+ZW5naW5lKSkKKwkJY3MgPSBlbWl0X3ByZWVtcHRfYnVzeXdhaXQocnEsIGNzKTsKKworCXJx
LT50YWlsID0gaW50ZWxfcmluZ19vZmZzZXQocnEsIGNzKTsKKwlhc3NlcnRfcmluZ190YWlsX3Zh
bGlkKHJxLT5yaW5nLCBycS0+dGFpbCk7CisKKwlyZXR1cm4gZ2VuOF9lbWl0X3dhX3RhaWwocnEs
IGNzKTsKK30KKworc3RhdGljIHUzMiAqZW1pdF94Y3NfYnJlYWRjcnVtYihzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICpycSwgdTMyICpjcykKK3sKKwlyZXR1cm4gZ2VuOF9lbWl0X2dndHRfd3JpdGUoY3Ms
IHJxLT5mZW5jZS5zZXFubywgaHdzcF9vZmZzZXQocnEpLCAwKTsKK30KKwordTMyICpnZW44X2Vt
aXRfZmluaV9icmVhZGNydW1iX3hjcyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgdTMyICpjcykK
K3sKKwlyZXR1cm4gZ2VuOF9lbWl0X2ZpbmlfYnJlYWRjcnVtYl90YWlsKHJxLCBlbWl0X3hjc19i
cmVhZGNydW1iKHJxLCBjcykpOworfQorCit1MzIgKmdlbjhfZW1pdF9maW5pX2JyZWFkY3J1bWJf
cmNzKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCB1MzIgKmNzKQoreworCWNzID0gZ2VuOF9lbWl0
X3BpcGVfY29udHJvbChjcywKKwkJCQkgICAgUElQRV9DT05UUk9MX1JFTkRFUl9UQVJHRVRfQ0FD
SEVfRkxVU0ggfAorCQkJCSAgICBQSVBFX0NPTlRST0xfREVQVEhfQ0FDSEVfRkxVU0ggfAorCQkJ
CSAgICBQSVBFX0NPTlRST0xfRENfRkxVU0hfRU5BQkxFLAorCQkJCSAgICAwKTsKKworCS8qIFhY
WCBmbHVzaCt3cml0ZStDU19TVEFMTCBhbGwgaW4gb25lIHVwc2V0cyBnZW1fY29uY3VycmVudF9i
bHQ6a2JsICovCisJY3MgPSBnZW44X2VtaXRfZ2d0dF93cml0ZV9yY3MoY3MsCisJCQkJICAgICAg
cnEtPmZlbmNlLnNlcW5vLAorCQkJCSAgICAgIGh3c3Bfb2Zmc2V0KHJxKSwKKwkJCQkgICAgICBQ
SVBFX0NPTlRST0xfRkxVU0hfRU5BQkxFIHwKKwkJCQkgICAgICBQSVBFX0NPTlRST0xfQ1NfU1RB
TEwpOworCisJcmV0dXJuIGdlbjhfZW1pdF9maW5pX2JyZWFkY3J1bWJfdGFpbChycSwgY3MpOwor
fQorCit1MzIgKmdlbjExX2VtaXRfZmluaV9icmVhZGNydW1iX3JjcyhzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpycSwgdTMyICpjcykKK3sKKwljcyA9IGdlbjhfZW1pdF9nZ3R0X3dyaXRlX3JjcyhjcywK
KwkJCQkgICAgICBycS0+ZmVuY2Uuc2Vxbm8sCisJCQkJICAgICAgaHdzcF9vZmZzZXQocnEpLAor
CQkJCSAgICAgIFBJUEVfQ09OVFJPTF9DU19TVEFMTCB8CisJCQkJICAgICAgUElQRV9DT05UUk9M
X1RJTEVfQ0FDSEVfRkxVU0ggfAorCQkJCSAgICAgIFBJUEVfQ09OVFJPTF9SRU5ERVJfVEFSR0VU
X0NBQ0hFX0ZMVVNIIHwKKwkJCQkgICAgICBQSVBFX0NPTlRST0xfREVQVEhfQ0FDSEVfRkxVU0gg
fAorCQkJCSAgICAgIFBJUEVfQ09OVFJPTF9EQ19GTFVTSF9FTkFCTEUgfAorCQkJCSAgICAgIFBJ
UEVfQ09OVFJPTF9GTFVTSF9FTkFCTEUpOworCisJcmV0dXJuIGdlbjhfZW1pdF9maW5pX2JyZWFk
Y3J1bWJfdGFpbChycSwgY3MpOworfQorCisvKgorICogTm90ZSB0aGF0IHRoZSBDUyBpbnN0cnVj
dGlvbiBwcmUtcGFyc2VyIHdpbGwgbm90IHN0YWxsIG9uIHRoZSBicmVhZGNydW1iCisgKiBmbHVz
aCBhbmQgd2lsbCBjb250aW51ZSBwcmUtZmV0Y2hpbmcgdGhlIGluc3RydWN0aW9ucyBhZnRlciBp
dCBiZWZvcmUgdGhlCisgKiBtZW1vcnkgc3luYyBpcyBjb21wbGV0ZWQuIE9uIHByZS1nZW4xMiBI
VywgdGhlIHByZS1wYXJzZXIgd2lsbCBzdG9wIGF0CisgKiBCQl9TVEFSVC9FTkQgaW5zdHJ1Y3Rp
b25zLCBzbywgZXZlbiB0aG91Z2ggd2UgbWlnaHQgcHJlLWZldGNoIHRoZSBwcmUtYW1ibGUKKyAq
IG9mIHRoZSBuZXh0IHJlcXVlc3QgYmVmb3JlIHRoZSBtZW1vcnkgaGFzIGJlZW4gZmx1c2hlZCwg
d2UncmUgZ3VhcmFudGVlZCB0aGF0CisgKiB3ZSB3b24ndCBhY2Nlc3MgdGhlIGJhdGNoIGl0c2Vs
ZiB0b28gZWFybHkuCisgKiBIb3dldmVyLCBvbiBnZW4xMisgdGhlIHBhcnNlciBjYW4gcHJlLWZl
dGNoIGFjcm9zcyB0aGUgQkJfU1RBUlQvRU5EIGNvbW1hbmRzLAorICogc28sIGlmIHRoZSBjdXJy
ZW50IHJlcXVlc3QgaXMgbW9kaWZ5aW5nIGFuIGluc3RydWN0aW9uIGluIHRoZSBuZXh0IHJlcXVl
c3Qgb24KKyAqIHRoZSBzYW1lIGludGVsX2NvbnRleHQsIHdlIG1pZ2h0IHByZS1mZXRjaCBhbmQg
dGhlbiBleGVjdXRlIHRoZSBwcmUtdXBkYXRlCisgKiBpbnN0cnVjdGlvbi4gVG8gYXZvaWQgdGhp
cywgdGhlIHVzZXJzIG9mIHNlbGYtbW9kaWZ5aW5nIGNvZGUgc2hvdWxkIGVpdGhlcgorICogZGlz
YWJsZSB0aGUgcGFyc2VyIGFyb3VuZCB0aGUgY29kZSBlbWl0dGluZyB0aGUgbWVtb3J5IHdyaXRl
cywgdmlhIGEgbmV3IGZsYWcKKyAqIGFkZGVkIHRvIE1JX0FSQl9DSEVDSywgb3IgZW1pdCB0aGUg
d3JpdGVzIGZyb20gYSBkaWZmZXJlbnQgaW50ZWxfY29udGV4dC4gRm9yCisgKiB0aGUgaW4ta2Vy
bmVsIHVzZS1jYXNlcyB3ZSd2ZSBvcHRlZCB0byB1c2UgYSBzZXBhcmF0ZSBjb250ZXh0LCBzZWUK
KyAqIHJlbG9jX2dwdSgpIGFzIGFuIGV4YW1wbGUuCisgKiBBbGwgdGhlIGFib3ZlIGFwcGxpZXMg
b25seSB0byB0aGUgaW5zdHJ1Y3Rpb25zIHRoZW1zZWx2ZXMuIE5vbi1pbmxpbmUgZGF0YQorICog
dXNlZCBieSB0aGUgaW5zdHJ1Y3Rpb25zIGlzIG5vdCBwcmUtZmV0Y2hlZC4KKyAqLworCitzdGF0
aWMgdTMyICpnZW4xMl9lbWl0X3ByZWVtcHRfYnVzeXdhaXQoc3RydWN0IGk5MTVfcmVxdWVzdCAq
cnEsIHUzMiAqY3MpCit7CisJKmNzKysgPSBNSV9TRU1BUEhPUkVfV0FJVF9UT0tFTiB8CisJCU1J
X1NFTUFQSE9SRV9HTE9CQUxfR1RUIHwKKwkJTUlfU0VNQVBIT1JFX1BPTEwgfAorCQlNSV9TRU1B
UEhPUkVfU0FEX0VRX1NERDsKKwkqY3MrKyA9IDA7CisJKmNzKysgPSBwcmVlbXB0X2FkZHJlc3Mo
cnEtPmVuZ2luZSk7CisJKmNzKysgPSAwOworCSpjcysrID0gMDsKKwkqY3MrKyA9IE1JX05PT1A7
CisKKwlyZXR1cm4gY3M7Cit9CisKK3N0YXRpYyBfX2Fsd2F5c19pbmxpbmUgdTMyKgorZ2VuMTJf
ZW1pdF9maW5pX2JyZWFkY3J1bWJfdGFpbChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgdTMyICpj
cykKK3sKKwkqY3MrKyA9IE1JX1VTRVJfSU5URVJSVVBUOworCisJKmNzKysgPSBNSV9BUkJfT05f
T0ZGIHwgTUlfQVJCX0VOQUJMRTsKKwlpZiAoaW50ZWxfZW5naW5lX2hhc19zZW1hcGhvcmVzKHJx
LT5lbmdpbmUpKQorCQljcyA9IGdlbjEyX2VtaXRfcHJlZW1wdF9idXN5d2FpdChycSwgY3MpOwor
CisJcnEtPnRhaWwgPSBpbnRlbF9yaW5nX29mZnNldChycSwgY3MpOworCWFzc2VydF9yaW5nX3Rh
aWxfdmFsaWQocnEtPnJpbmcsIHJxLT50YWlsKTsKKworCXJldHVybiBnZW44X2VtaXRfd2FfdGFp
bChycSwgY3MpOworfQorCit1MzIgKmdlbjEyX2VtaXRfZmluaV9icmVhZGNydW1iX3hjcyhzdHJ1
Y3QgaTkxNV9yZXF1ZXN0ICpycSwgdTMyICpjcykKK3sKKwkvKiBYWFggU3RhbGxpbmcgZmx1c2gg
YmVmb3JlIHNlcW5vIHdyaXRlOyBwb3N0LXN5bmMgbm90ICovCisJY3MgPSBlbWl0X3hjc19icmVh
ZGNydW1iKHJxLCBfX2dlbjhfZW1pdF9mbHVzaF9kdyhjcywgMCwgMCwgMCkpOworCXJldHVybiBn
ZW4xMl9lbWl0X2ZpbmlfYnJlYWRjcnVtYl90YWlsKHJxLCBjcyk7Cit9CisKK3UzMiAqZ2VuMTJf
ZW1pdF9maW5pX2JyZWFkY3J1bWJfcmNzKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCB1MzIgKmNz
KQoreworCWNzID0gZ2VuMTJfZW1pdF9nZ3R0X3dyaXRlX3JjcyhjcywKKwkJCQkgICAgICAgcnEt
PmZlbmNlLnNlcW5vLAorCQkJCSAgICAgICBod3NwX29mZnNldChycSksCisJCQkJICAgICAgIFBJ
UEVfQ09OVFJPTDBfSERDX1BJUEVMSU5FX0ZMVVNILAorCQkJCSAgICAgICBQSVBFX0NPTlRST0xf
Q1NfU1RBTEwgfAorCQkJCSAgICAgICBQSVBFX0NPTlRST0xfVElMRV9DQUNIRV9GTFVTSCB8CisJ
CQkJICAgICAgIFBJUEVfQ09OVFJPTF9GTFVTSF9MMyB8CisJCQkJICAgICAgIFBJUEVfQ09OVFJP
TF9SRU5ERVJfVEFSR0VUX0NBQ0hFX0ZMVVNIIHwKKwkJCQkgICAgICAgUElQRV9DT05UUk9MX0RF
UFRIX0NBQ0hFX0ZMVVNIIHwKKwkJCQkgICAgICAgLyogV2FfMTQwOTYwMDkwNzp0Z2wgKi8KKwkJ
CQkgICAgICAgUElQRV9DT05UUk9MX0RFUFRIX1NUQUxMIHwKKwkJCQkgICAgICAgUElQRV9DT05U
Uk9MX0RDX0ZMVVNIX0VOQUJMRSB8CisJCQkJICAgICAgIFBJUEVfQ09OVFJPTF9GTFVTSF9FTkFC
TEUpOworCisJcmV0dXJuIGdlbjEyX2VtaXRfZmluaV9icmVhZGNydW1iX3RhaWwocnEsIGNzKTsK
K30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2dlbjhfZW5naW5lX2NzLmgg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9nZW44X2VuZ2luZV9jcy5oCm5ldyBmaWxlIG1vZGUg
MTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uM2M1NzcxZmVhMjM1Ci0tLSAvZGV2L251bGwKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZ2VuOF9lbmdpbmVfY3MuaApAQCAtMCwwICsxLDM2
IEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUICovCisvKgorICogQ29weXJpZ2h0
IMKpIDIwMTQgSW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisjaWZuZGVmIF9fR0VOOF9FTkdJTkVf
Q1NfSF9fCisjZGVmaW5lIF9fR0VOOF9FTkdJTkVfQ1NfSF9fCisKKyNpbmNsdWRlIDxsaW51eC90
eXBlcy5oPgorCitzdHJ1Y3QgaTkxNV9yZXF1ZXN0OworCitpbnQgZ2VuOF9lbWl0X2ZsdXNoX3Jj
cyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgdTMyIG1vZGUpOworaW50IGdlbjExX2VtaXRfZmx1
c2hfcmNzKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCB1MzIgbW9kZSk7CitpbnQgZ2VuMTJfZW1p
dF9mbHVzaF9yY3Moc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsIHUzMiBtb2RlKTsKKworaW50IGdl
bjhfZW1pdF9mbHVzaF94Y3Moc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsIHUzMiBtb2RlKTsKK2lu
dCBnZW4xMl9lbWl0X2ZsdXNoX3hjcyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgdTMyIG1vZGUp
OworCitpbnQgZ2VuOF9lbWl0X2luaXRfYnJlYWRjcnVtYihzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpy
cSk7CisKK2ludCBnZW44X2VtaXRfYmJfc3RhcnRfbm9hcmIoc3RydWN0IGk5MTVfcmVxdWVzdCAq
cnEsCisJCQkgICAgIHU2NCBvZmZzZXQsIHUzMiBsZW4sCisJCQkgICAgIGNvbnN0IHVuc2lnbmVk
IGludCBmbGFncyk7CitpbnQgZ2VuOF9lbWl0X2JiX3N0YXJ0KHN0cnVjdCBpOTE1X3JlcXVlc3Qg
KnJxLAorCQkgICAgICAgdTY0IG9mZnNldCwgdTMyIGxlbiwKKwkJICAgICAgIGNvbnN0IHVuc2ln
bmVkIGludCBmbGFncyk7CisKK3UzMiAqZ2VuOF9lbWl0X2ZpbmlfYnJlYWRjcnVtYl94Y3Moc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnEsIHUzMiAqY3MpOwordTMyICpnZW4xMl9lbWl0X2ZpbmlfYnJl
YWRjcnVtYl94Y3Moc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsIHUzMiAqY3MpOworCit1MzIgKmdl
bjhfZW1pdF9maW5pX2JyZWFkY3J1bWJfcmNzKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCB1MzIg
KmNzKTsKK3UzMiAqZ2VuMTFfZW1pdF9maW5pX2JyZWFkY3J1bWJfcmNzKHN0cnVjdCBpOTE1X3Jl
cXVlc3QgKnJxLCB1MzIgKmNzKTsKK3UzMiAqZ2VuMTJfZW1pdF9maW5pX2JyZWFkY3J1bWJfcmNz
KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCB1MzIgKmNzKTsKKworI2VuZGlmIC8qIF9fR0VOOF9F
TkdJTkVfQ1NfSF9fICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9leGVjbGlzdHNfc3VibWlzc2lvbi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
ZXhlY2xpc3RzX3N1Ym1pc3Npb24uYwppbmRleCBlMWQzNWFiMTdlNmYuLmRjZWNjMjg4Nzg5MSAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZXhlY2xpc3RzX3N1Ym1p
c3Npb24uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9leGVjbGlzdHNfc3Vi
bWlzc2lvbi5jCkBAIC0xMTIsNiArMTEyLDcgQEAKICNpbmNsdWRlICJpOTE1X3BlcmYuaCIKICNp
bmNsdWRlICJpOTE1X3RyYWNlLmgiCiAjaW5jbHVkZSAiaTkxNV92Z3B1LmgiCisjaW5jbHVkZSAi
Z2VuOF9lbmdpbmVfY3MuaCIKICNpbmNsdWRlICJpbnRlbF9icmVhZGNydW1icy5oIgogI2luY2x1
ZGUgImludGVsX2NvbnRleHQuaCIKICNpbmNsdWRlICJpbnRlbF9lbmdpbmVfcG0uaCIKQEAgLTM2
MiwxMiArMzYzLDYgQEAgYWN0aXZlX3JlcXVlc3QoY29uc3Qgc3RydWN0IGludGVsX3RpbWVsaW5l
ICogY29uc3QgdGwsIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogCXJldHVybiBhY3RpdmU7CiB9
CiAKLXN0YXRpYyBpbmxpbmUgdTMyIGludGVsX2h3c19wcmVlbXB0X2FkZHJlc3Moc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lKQotewotCXJldHVybiAoaTkxNV9nZ3R0X29mZnNldChlbmdp
bmUtPnN0YXR1c19wYWdlLnZtYSkgKwotCQlJOTE1X0dFTV9IV1NfUFJFRU1QVF9BRERSKTsKLX0K
LQogc3RhdGljIGlubGluZSB2b2lkCiByaW5nX3NldF9wYXVzZWQoY29uc3Qgc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lLCBpbnQgc3RhdGUpCiB7CkBAIC0zNTcxLDU1ICszNTY2LDYgQEAg
c3RhdGljIGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0X29wcyBleGVjbGlzdHNfY29udGV4dF9v
cHMgPSB7CiAJLmRlc3Ryb3kgPSBleGVjbGlzdHNfY29udGV4dF9kZXN0cm95LAogfTsKIAotc3Rh
dGljIHUzMiBod3NwX29mZnNldChjb25zdCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKLXsKLQlj
b25zdCBzdHJ1Y3QgaW50ZWxfdGltZWxpbmVfY2FjaGVsaW5lICpjbDsKLQotCS8qIEJlZm9yZSB0
aGUgcmVxdWVzdCBpcyBleGVjdXRlZCwgdGhlIHRpbWVsaW5lL2NhY2hsaW5lIGlzIGZpeGVkICov
Ci0KLQljbCA9IHJjdV9kZXJlZmVyZW5jZV9wcm90ZWN0ZWQocnEtPmh3c3BfY2FjaGVsaW5lLCAx
KTsKLQlpZiAoY2wpCi0JCXJldHVybiBjbC0+Z2d0dF9vZmZzZXQ7Ci0KLQlyZXR1cm4gcmN1X2Rl
cmVmZXJlbmNlX3Byb3RlY3RlZChycS0+dGltZWxpbmUsIDEpLT5od3NwX29mZnNldDsKLX0KLQot
c3RhdGljIGludCBnZW44X2VtaXRfaW5pdF9icmVhZGNydW1iKHN0cnVjdCBpOTE1X3JlcXVlc3Qg
KnJxKQotewotCXUzMiAqY3M7Ci0KLQlHRU1fQlVHX09OKGk5MTVfcmVxdWVzdF9oYXNfaW5pdGlh
bF9icmVhZGNydW1iKHJxKSk7Ci0JaWYgKCFpOTE1X3JlcXVlc3RfdGltZWxpbmUocnEpLT5oYXNf
aW5pdGlhbF9icmVhZGNydW1iKQotCQlyZXR1cm4gMDsKLQotCWNzID0gaW50ZWxfcmluZ19iZWdp
bihycSwgNik7Ci0JaWYgKElTX0VSUihjcykpCi0JCXJldHVybiBQVFJfRVJSKGNzKTsKLQotCS8q
Ci0JICogQ2hlY2sgaWYgd2UgaGF2ZSBiZWVuIHByZWVtcHRlZCBiZWZvcmUgd2UgZXZlbiBnZXQg
c3RhcnRlZC4KLQkgKgotCSAqIEFmdGVyIHRoaXMgcG9pbnQgaTkxNV9yZXF1ZXN0X3N0YXJ0ZWQo
KSByZXBvcnRzIHRydWUsIGV2ZW4gaWYKLQkgKiB3ZSBnZXQgcHJlZW1wdGVkIGFuZCBzbyBhcmUg
bm8gbG9uZ2VyIHJ1bm5pbmcuCi0JICovCi0JKmNzKysgPSBNSV9BUkJfQ0hFQ0s7Ci0JKmNzKysg
PSBNSV9OT09QOwotCi0JKmNzKysgPSBNSV9TVE9SRV9EV09SRF9JTU1fR0VONCB8IE1JX1VTRV9H
R1RUOwotCSpjcysrID0gaHdzcF9vZmZzZXQocnEpOwotCSpjcysrID0gMDsKLQkqY3MrKyA9IHJx
LT5mZW5jZS5zZXFubyAtIDE7Ci0KLQlpbnRlbF9yaW5nX2FkdmFuY2UocnEsIGNzKTsKLQotCS8q
IFJlY29yZCB0aGUgdXBkYXRlZCBwb3NpdGlvbiBvZiB0aGUgcmVxdWVzdCdzIHBheWxvYWQgKi8K
LQlycS0+aW5maXggPSBpbnRlbF9yaW5nX29mZnNldChycSwgY3MpOwotCi0JX19zZXRfYml0KEk5
MTVfRkVOQ0VfRkxBR19JTklUSUFMX0JSRUFEQ1JVTUIsICZycS0+ZmVuY2UuZmxhZ3MpOwotCi0J
cmV0dXJuIDA7Ci19Ci0KIHN0YXRpYyBpbnQgZW1pdF9wZHBzKHN0cnVjdCBpOTE1X3JlcXVlc3Qg
KnJxKQogewogCWNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKiBjb25zdCBlbmdpbmUgPSBy
cS0+ZW5naW5lOwpAQCAtNDQ3NSw2NyArNDQyMSw2IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19y
ZXNldF9maW5pc2goc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCQkgICAgIGF0b21p
Y19yZWFkKCZleGVjbGlzdHMtPnRhc2tsZXQuY291bnQpKTsKIH0KIAotc3RhdGljIGludCBnZW44
X2VtaXRfYmJfc3RhcnRfbm9hcmIoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCi0JCQkJICAgIHU2
NCBvZmZzZXQsIHUzMiBsZW4sCi0JCQkJICAgIGNvbnN0IHVuc2lnbmVkIGludCBmbGFncykKLXsK
LQl1MzIgKmNzOwotCi0JY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJxLCA0KTsKLQlpZiAoSVNfRVJS
KGNzKSkKLQkJcmV0dXJuIFBUUl9FUlIoY3MpOwotCi0JLyoKLQkgKiBXYURpc2FibGVDdHhSZXN0
b3JlQXJiaXRyYXRpb246YmR3LGNodgotCSAqCi0JICogV2UgZG9uJ3QgbmVlZCB0byBwZXJmb3Jt
IE1JX0FSQl9FTkFCTEUgYXMgb2Z0ZW4gYXMgd2UgZG8gKGluCi0JICogcGFydGljdWxhciBhbGwg
dGhlIGdlbiB0aGF0IGRvIG5vdCBuZWVkIHRoZSB3L2EgYXQgYWxsISksIGlmIHdlCi0JICogdG9v
ayBjYXJlIHRvIG1ha2Ugc3VyZSB0aGF0IG9uIGV2ZXJ5IHN3aXRjaCBpbnRvIHRoaXMgY29udGV4
dAotCSAqIChib3RoIG9yZGluYXJ5IGFuZCBmb3IgcHJlZW1wdGlvbikgdGhhdCBhcmJpdHJhcnRp
b24gd2FzIGVuYWJsZWQKLQkgKiB3ZSB3b3VsZCBiZSBmaW5lLiAgSG93ZXZlciwgZm9yIGdlbjgg
dGhlcmUgaXMgYW5vdGhlciB3L2EgdGhhdAotCSAqIHJlcXVpcmVzIHVzIHRvIG5vdCBwcmVlbXB0
IGluc2lkZSBHUEdQVSBleGVjdXRpb24sIHNvIHdlIGtlZXAKLQkgKiBhcmJpdHJhdGlvbiBkaXNh
YmxlZCBmb3IgZ2VuOCBiYXRjaGVzLiBBcmJpdHJhdGlvbiB3aWxsIGJlCi0JICogcmUtZW5hYmxl
ZCBiZWZvcmUgd2UgY2xvc2UgdGhlIHJlcXVlc3QKLQkgKiAoZW5naW5lLT5lbWl0X2ZpbmlfYnJl
YWRjcnVtYikuCi0JICovCi0JKmNzKysgPSBNSV9BUkJfT05fT0ZGIHwgTUlfQVJCX0RJU0FCTEU7
Ci0KLQkvKiBGSVhNRShCRFcrKTogQWRkcmVzcyBzcGFjZSBhbmQgc2VjdXJpdHkgc2VsZWN0b3Jz
LiAqLwotCSpjcysrID0gTUlfQkFUQ0hfQlVGRkVSX1NUQVJUX0dFTjggfAotCQkoZmxhZ3MgJiBJ
OTE1X0RJU1BBVENIX1NFQ1VSRSA/IDAgOiBCSVQoOCkpOwotCSpjcysrID0gbG93ZXJfMzJfYml0
cyhvZmZzZXQpOwotCSpjcysrID0gdXBwZXJfMzJfYml0cyhvZmZzZXQpOwotCi0JaW50ZWxfcmlu
Z19hZHZhbmNlKHJxLCBjcyk7Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCBnZW44X2Vt
aXRfYmJfc3RhcnQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCi0JCQkgICAgICB1NjQgb2Zmc2V0
LCB1MzIgbGVuLAotCQkJICAgICAgY29uc3QgdW5zaWduZWQgaW50IGZsYWdzKQotewotCXUzMiAq
Y3M7Ci0KLQljcyA9IGludGVsX3JpbmdfYmVnaW4ocnEsIDYpOwotCWlmIChJU19FUlIoY3MpKQot
CQlyZXR1cm4gUFRSX0VSUihjcyk7Ci0KLQkqY3MrKyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJf
RU5BQkxFOwotCi0JKmNzKysgPSBNSV9CQVRDSF9CVUZGRVJfU1RBUlRfR0VOOCB8Ci0JCShmbGFn
cyAmIEk5MTVfRElTUEFUQ0hfU0VDVVJFID8gMCA6IEJJVCg4KSk7Ci0JKmNzKysgPSBsb3dlcl8z
Ml9iaXRzKG9mZnNldCk7Ci0JKmNzKysgPSB1cHBlcl8zMl9iaXRzKG9mZnNldCk7Ci0KLQkqY3Mr
KyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJfRElTQUJMRTsKLQkqY3MrKyA9IE1JX05PT1A7Ci0K
LQlpbnRlbF9yaW5nX2FkdmFuY2UocnEsIGNzKTsKLQotCXJldHVybiAwOwotfQotCiBzdGF0aWMg
dm9pZCBnZW44X2xvZ2ljYWxfcmluZ19lbmFibGVfaXJxKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSkKIHsKIAlFTkdJTkVfV1JJVEUoZW5naW5lLCBSSU5HX0lNUiwKQEAgLTQ1NDgsNTA0
ICs0NDMzLDYgQEAgc3RhdGljIHZvaWQgZ2VuOF9sb2dpY2FsX3JpbmdfZGlzYWJsZV9pcnEoc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCUVOR0lORV9XUklURShlbmdpbmUsIFJJTkdf
SU1SLCB+ZW5naW5lLT5pcnFfa2VlcF9tYXNrKTsKIH0KIAotc3RhdGljIGludCBnZW44X2VtaXRf
Zmx1c2goc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCwgdTMyIG1vZGUpCi17Ci0JdTMyIGNt
ZCwgKmNzOwotCi0JY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJlcXVlc3QsIDQpOwotCWlmIChJU19F
UlIoY3MpKQotCQlyZXR1cm4gUFRSX0VSUihjcyk7Ci0KLQljbWQgPSBNSV9GTFVTSF9EVyArIDE7
Ci0KLQkvKiBXZSBhbHdheXMgcmVxdWlyZSBhIGNvbW1hbmQgYmFycmllciBzbyB0aGF0IHN1YnNl
cXVlbnQKLQkgKiBjb21tYW5kcywgc3VjaCBhcyBicmVhZGNydW1iIGludGVycnVwdHMsIGFyZSBz
dHJpY3RseSBvcmRlcmVkCi0JICogd3J0IHRoZSBjb250ZW50cyBvZiB0aGUgd3JpdGUgY2FjaGUg
YmVpbmcgZmx1c2hlZCB0byBtZW1vcnkKLQkgKiAoYW5kIHRodXMgYmVpbmcgY29oZXJlbnQgZnJv
bSB0aGUgQ1BVKS4KLQkgKi8KLQljbWQgfD0gTUlfRkxVU0hfRFdfU1RPUkVfSU5ERVggfCBNSV9G
TFVTSF9EV19PUF9TVE9SRURXOwotCi0JaWYgKG1vZGUgJiBFTUlUX0lOVkFMSURBVEUpIHsKLQkJ
Y21kIHw9IE1JX0lOVkFMSURBVEVfVExCOwotCQlpZiAocmVxdWVzdC0+ZW5naW5lLT5jbGFzcyA9
PSBWSURFT19ERUNPREVfQ0xBU1MpCi0JCQljbWQgfD0gTUlfSU5WQUxJREFURV9CU0Q7Ci0JfQot
Ci0JKmNzKysgPSBjbWQ7Ci0JKmNzKysgPSBMUkNfUFBIV1NQX1NDUkFUQ0hfQUREUjsKLQkqY3Mr
KyA9IDA7IC8qIHVwcGVyIGFkZHIgKi8KLQkqY3MrKyA9IDA7IC8qIHZhbHVlICovCi0JaW50ZWxf
cmluZ19hZHZhbmNlKHJlcXVlc3QsIGNzKTsKLQotCXJldHVybiAwOwotfQotCi1zdGF0aWMgaW50
IGdlbjhfZW1pdF9mbHVzaF9yZW5kZXIoc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCwKLQkJ
CQkgIHUzMiBtb2RlKQotewotCWJvb2wgdmZfZmx1c2hfd2EgPSBmYWxzZSwgZGNfZmx1c2hfd2Eg
PSBmYWxzZTsKLQl1MzIgKmNzLCBmbGFncyA9IDA7Ci0JaW50IGxlbjsKLQotCWZsYWdzIHw9IFBJ
UEVfQ09OVFJPTF9DU19TVEFMTDsKLQotCWlmIChtb2RlICYgRU1JVF9GTFVTSCkgewotCQlmbGFn
cyB8PSBQSVBFX0NPTlRST0xfUkVOREVSX1RBUkdFVF9DQUNIRV9GTFVTSDsKLQkJZmxhZ3MgfD0g
UElQRV9DT05UUk9MX0RFUFRIX0NBQ0hFX0ZMVVNIOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xf
RENfRkxVU0hfRU5BQkxFOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfRkxVU0hfRU5BQkxFOwot
CX0KLQotCWlmIChtb2RlICYgRU1JVF9JTlZBTElEQVRFKSB7Ci0JCWZsYWdzIHw9IFBJUEVfQ09O
VFJPTF9UTEJfSU5WQUxJREFURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0lOU1RSVUNUSU9O
X0NBQ0hFX0lOVkFMSURBVEU7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9URVhUVVJFX0NBQ0hF
X0lOVkFMSURBVEU7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9WRl9DQUNIRV9JTlZBTElEQVRF
OwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfQ09OU1RfQ0FDSEVfSU5WQUxJREFURTsKLQkJZmxh
Z3MgfD0gUElQRV9DT05UUk9MX1NUQVRFX0NBQ0hFX0lOVkFMSURBVEU7Ci0JCWZsYWdzIHw9IFBJ
UEVfQ09OVFJPTF9RV19XUklURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1NUT1JFX0RBVEFf
SU5ERVg7Ci0KLQkJLyoKLQkJICogT24gR0VOOTogYmVmb3JlIFZGX0NBQ0hFX0lOVkFMSURBVEUg
d2UgbmVlZCB0byBlbWl0IGEgTlVMTAotCQkgKiBwaXBlIGNvbnRyb2wuCi0JCSAqLwotCQlpZiAo
SVNfR0VOKHJlcXVlc3QtPmVuZ2luZS0+aTkxNSwgOSkpCi0JCQl2Zl9mbHVzaF93YSA9IHRydWU7
Ci0KLQkJLyogV2FGb3JHQU1IYW5nOmtibCAqLwotCQlpZiAoSVNfS0JMX0dUX1JFVklEKHJlcXVl
c3QtPmVuZ2luZS0+aTkxNSwgMCwgS0JMX1JFVklEX0IwKSkKLQkJCWRjX2ZsdXNoX3dhID0gdHJ1
ZTsKLQl9Ci0KLQlsZW4gPSA2OwotCi0JaWYgKHZmX2ZsdXNoX3dhKQotCQlsZW4gKz0gNjsKLQot
CWlmIChkY19mbHVzaF93YSkKLQkJbGVuICs9IDEyOwotCi0JY3MgPSBpbnRlbF9yaW5nX2JlZ2lu
KHJlcXVlc3QsIGxlbik7Ci0JaWYgKElTX0VSUihjcykpCi0JCXJldHVybiBQVFJfRVJSKGNzKTsK
LQotCWlmICh2Zl9mbHVzaF93YSkKLQkJY3MgPSBnZW44X2VtaXRfcGlwZV9jb250cm9sKGNzLCAw
LCAwKTsKLQotCWlmIChkY19mbHVzaF93YSkKLQkJY3MgPSBnZW44X2VtaXRfcGlwZV9jb250cm9s
KGNzLCBQSVBFX0NPTlRST0xfRENfRkxVU0hfRU5BQkxFLAotCQkJCQkgICAgMCk7Ci0KLQljcyA9
IGdlbjhfZW1pdF9waXBlX2NvbnRyb2woY3MsIGZsYWdzLCBMUkNfUFBIV1NQX1NDUkFUQ0hfQURE
Uik7Ci0KLQlpZiAoZGNfZmx1c2hfd2EpCi0JCWNzID0gZ2VuOF9lbWl0X3BpcGVfY29udHJvbChj
cywgUElQRV9DT05UUk9MX0NTX1NUQUxMLCAwKTsKLQotCWludGVsX3JpbmdfYWR2YW5jZShyZXF1
ZXN0LCBjcyk7Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCBnZW4xMV9lbWl0X2ZsdXNo
X3JlbmRlcihzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0LAotCQkJCSAgIHUzMiBtb2RlKQot
ewotCWlmIChtb2RlICYgRU1JVF9GTFVTSCkgewotCQl1MzIgKmNzOwotCQl1MzIgZmxhZ3MgPSAw
OwotCi0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9DU19TVEFMTDsKLQotCQlmbGFncyB8PSBQSVBF
X0NPTlRST0xfVElMRV9DQUNIRV9GTFVTSDsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1JFTkRF
Ul9UQVJHRVRfQ0FDSEVfRkxVU0g7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9ERVBUSF9DQUNI
RV9GTFVTSDsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0RDX0ZMVVNIX0VOQUJMRTsKLQkJZmxh
Z3MgfD0gUElQRV9DT05UUk9MX0ZMVVNIX0VOQUJMRTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9M
X1FXX1dSSVRFOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfU1RPUkVfREFUQV9JTkRFWDsKLQot
CQljcyA9IGludGVsX3JpbmdfYmVnaW4ocmVxdWVzdCwgNik7Ci0JCWlmIChJU19FUlIoY3MpKQot
CQkJcmV0dXJuIFBUUl9FUlIoY3MpOwotCi0JCWNzID0gZ2VuOF9lbWl0X3BpcGVfY29udHJvbChj
cywgZmxhZ3MsIExSQ19QUEhXU1BfU0NSQVRDSF9BRERSKTsKLQkJaW50ZWxfcmluZ19hZHZhbmNl
KHJlcXVlc3QsIGNzKTsKLQl9Ci0KLQlpZiAobW9kZSAmIEVNSVRfSU5WQUxJREFURSkgewotCQl1
MzIgKmNzOwotCQl1MzIgZmxhZ3MgPSAwOwotCi0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9DU19T
VEFMTDsKLQotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfQ09NTUFORF9DQUNIRV9JTlZBTElEQVRF
OwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfVExCX0lOVkFMSURBVEU7Ci0JCWZsYWdzIHw9IFBJ
UEVfQ09OVFJPTF9JTlNUUlVDVElPTl9DQUNIRV9JTlZBTElEQVRFOwotCQlmbGFncyB8PSBQSVBF
X0NPTlRST0xfVEVYVFVSRV9DQUNIRV9JTlZBTElEQVRFOwotCQlmbGFncyB8PSBQSVBFX0NPTlRS
T0xfVkZfQ0FDSEVfSU5WQUxJREFURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0NPTlNUX0NB
Q0hFX0lOVkFMSURBVEU7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9TVEFURV9DQUNIRV9JTlZB
TElEQVRFOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfUVdfV1JJVEU7Ci0JCWZsYWdzIHw9IFBJ
UEVfQ09OVFJPTF9TVE9SRV9EQVRBX0lOREVYOwotCi0JCWNzID0gaW50ZWxfcmluZ19iZWdpbihy
ZXF1ZXN0LCA2KTsKLQkJaWYgKElTX0VSUihjcykpCi0JCQlyZXR1cm4gUFRSX0VSUihjcyk7Ci0K
LQkJY3MgPSBnZW44X2VtaXRfcGlwZV9jb250cm9sKGNzLCBmbGFncywgTFJDX1BQSFdTUF9TQ1JB
VENIX0FERFIpOwotCQlpbnRlbF9yaW5nX2FkdmFuY2UocmVxdWVzdCwgY3MpOwotCX0KLQotCXJl
dHVybiAwOwotfQotCi1zdGF0aWMgdTMyIHByZXBhcnNlcl9kaXNhYmxlKGJvb2wgc3RhdGUpCi17
Ci0JcmV0dXJuIE1JX0FSQl9DSEVDSyB8IDEgPDwgOCB8IHN0YXRlOwotfQotCi1zdGF0aWMgaTkx
NV9yZWdfdCBhdXhfaW52X3JlZyhjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUp
Ci17Ci0Jc3RhdGljIGNvbnN0IGk5MTVfcmVnX3QgdmRbXSA9IHsKLQkJR0VOMTJfVkQwX0FVWF9O
ViwKLQkJR0VOMTJfVkQxX0FVWF9OViwKLQkJR0VOMTJfVkQyX0FVWF9OViwKLQkJR0VOMTJfVkQz
X0FVWF9OViwKLQl9OwotCi0Jc3RhdGljIGNvbnN0IGk5MTVfcmVnX3QgdmVbXSA9IHsKLQkJR0VO
MTJfVkUwX0FVWF9OViwKLQkJR0VOMTJfVkUxX0FVWF9OViwKLQl9OwotCi0JaWYgKGVuZ2luZS0+
Y2xhc3MgPT0gVklERU9fREVDT0RFX0NMQVNTKQotCQlyZXR1cm4gdmRbZW5naW5lLT5pbnN0YW5j
ZV07Ci0KLQlpZiAoZW5naW5lLT5jbGFzcyA9PSBWSURFT19FTkhBTkNFTUVOVF9DTEFTUykKLQkJ
cmV0dXJuIHZlW2VuZ2luZS0+aW5zdGFuY2VdOwotCi0JR0VNX0JVR19PTigidW5rbm93biBhdXhf
aW52X3JlZ1xuIik7Ci0KLQlyZXR1cm4gSU5WQUxJRF9NTUlPX1JFRzsKLX0KLQotc3RhdGljIHUz
MiAqCi1nZW4xMl9lbWl0X2F1eF90YWJsZV9pbnYoY29uc3QgaTkxNV9yZWdfdCBpbnZfcmVnLCB1
MzIgKmNzKQotewotCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oMSk7Ci0JKmNzKysgPSBp
OTE1X21taW9fcmVnX29mZnNldChpbnZfcmVnKTsKLQkqY3MrKyA9IEFVWF9JTlY7Ci0JKmNzKysg
PSBNSV9OT09QOwotCi0JcmV0dXJuIGNzOwotfQotCi1zdGF0aWMgaW50IGdlbjEyX2VtaXRfZmx1
c2hfcmVuZGVyKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QsCi0JCQkJICAgdTMyIG1vZGUp
Ci17Ci0JaWYgKG1vZGUgJiBFTUlUX0ZMVVNIKSB7Ci0JCXUzMiBmbGFncyA9IDA7Ci0JCXUzMiAq
Y3M7Ci0KLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1RJTEVfQ0FDSEVfRkxVU0g7Ci0JCWZsYWdz
IHw9IFBJUEVfQ09OVFJPTF9GTFVTSF9MMzsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1JFTkRF
Ul9UQVJHRVRfQ0FDSEVfRkxVU0g7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9ERVBUSF9DQUNI
RV9GTFVTSDsKLQkJLyogV2FfMTQwOTYwMDkwNzp0Z2wgKi8KLQkJZmxhZ3MgfD0gUElQRV9DT05U
Uk9MX0RFUFRIX1NUQUxMOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfRENfRkxVU0hfRU5BQkxF
OwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfRkxVU0hfRU5BQkxFOwotCi0JCWZsYWdzIHw9IFBJ
UEVfQ09OVFJPTF9TVE9SRV9EQVRBX0lOREVYOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfUVdf
V1JJVEU7Ci0KLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0NTX1NUQUxMOwotCi0JCWNzID0gaW50
ZWxfcmluZ19iZWdpbihyZXF1ZXN0LCA2KTsKLQkJaWYgKElTX0VSUihjcykpCi0JCQlyZXR1cm4g
UFRSX0VSUihjcyk7Ci0KLQkJY3MgPSBnZW4xMl9lbWl0X3BpcGVfY29udHJvbChjcywKLQkJCQkJ
ICAgICBQSVBFX0NPTlRST0wwX0hEQ19QSVBFTElORV9GTFVTSCwKLQkJCQkJICAgICBmbGFncywg
TFJDX1BQSFdTUF9TQ1JBVENIX0FERFIpOwotCQlpbnRlbF9yaW5nX2FkdmFuY2UocmVxdWVzdCwg
Y3MpOwotCX0KLQotCWlmIChtb2RlICYgRU1JVF9JTlZBTElEQVRFKSB7Ci0JCXUzMiBmbGFncyA9
IDA7Ci0JCXUzMiAqY3M7Ci0KLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0NPTU1BTkRfQ0FDSEVf
SU5WQUxJREFURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1RMQl9JTlZBTElEQVRFOwotCQlm
bGFncyB8PSBQSVBFX0NPTlRST0xfSU5TVFJVQ1RJT05fQ0FDSEVfSU5WQUxJREFURTsKLQkJZmxh
Z3MgfD0gUElQRV9DT05UUk9MX1RFWFRVUkVfQ0FDSEVfSU5WQUxJREFURTsKLQkJZmxhZ3MgfD0g
UElQRV9DT05UUk9MX1ZGX0NBQ0hFX0lOVkFMSURBVEU7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJP
TF9DT05TVF9DQUNIRV9JTlZBTElEQVRFOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfU1RBVEVf
Q0FDSEVfSU5WQUxJREFURTsKLQotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfU1RPUkVfREFUQV9J
TkRFWDsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1FXX1dSSVRFOwotCi0JCWZsYWdzIHw9IFBJ
UEVfQ09OVFJPTF9DU19TVEFMTDsKLQotCQljcyA9IGludGVsX3JpbmdfYmVnaW4ocmVxdWVzdCwg
OCArIDQpOwotCQlpZiAoSVNfRVJSKGNzKSkKLQkJCXJldHVybiBQVFJfRVJSKGNzKTsKLQotCQkv
KgotCQkgKiBQcmV2ZW50IHRoZSBwcmUtcGFyc2VyIGZyb20gc2tpcHBpbmcgcGFzdCB0aGUgVExC
Ci0JCSAqIGludmFsaWRhdGUgYW5kIGxvYWRpbmcgYSBzdGFsZSBwYWdlIGZvciB0aGUgYmF0Y2gK
LQkJICogYnVmZmVyIC8gcmVxdWVzdCBwYXlsb2FkLgotCQkgKi8KLQkJKmNzKysgPSBwcmVwYXJz
ZXJfZGlzYWJsZSh0cnVlKTsKLQotCQljcyA9IGdlbjhfZW1pdF9waXBlX2NvbnRyb2woY3MsIGZs
YWdzLCBMUkNfUFBIV1NQX1NDUkFUQ0hfQUREUik7Ci0KLQkJLyogaHNkZXM6IDE4MDkxNzU3OTAg
Ki8KLQkJY3MgPSBnZW4xMl9lbWl0X2F1eF90YWJsZV9pbnYoR0VOMTJfR0ZYX0NDU19BVVhfTlYs
IGNzKTsKLQotCQkqY3MrKyA9IHByZXBhcnNlcl9kaXNhYmxlKGZhbHNlKTsKLQkJaW50ZWxfcmlu
Z19hZHZhbmNlKHJlcXVlc3QsIGNzKTsKLQl9Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGlu
dCBnZW4xMl9lbWl0X2ZsdXNoKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QsIHUzMiBtb2Rl
KQotewotCWludGVsX2VuZ2luZV9tYXNrX3QgYXV4X2ludiA9IDA7Ci0JdTMyIGNtZCwgKmNzOwot
Ci0JY21kID0gNDsKLQlpZiAobW9kZSAmIEVNSVRfSU5WQUxJREFURSkKLQkJY21kICs9IDI7Ci0J
aWYgKG1vZGUgJiBFTUlUX0lOVkFMSURBVEUpCi0JCWF1eF9pbnYgPSByZXF1ZXN0LT5lbmdpbmUt
Pm1hc2sgJiB+QklUKEJDUzApOwotCWlmIChhdXhfaW52KQotCQljbWQgKz0gMiAqIGh3ZWlnaHQ4
KGF1eF9pbnYpICsgMjsKLQotCWNzID0gaW50ZWxfcmluZ19iZWdpbihyZXF1ZXN0LCBjbWQpOwot
CWlmIChJU19FUlIoY3MpKQotCQlyZXR1cm4gUFRSX0VSUihjcyk7Ci0KLQlpZiAobW9kZSAmIEVN
SVRfSU5WQUxJREFURSkKLQkJKmNzKysgPSBwcmVwYXJzZXJfZGlzYWJsZSh0cnVlKTsKLQotCWNt
ZCA9IE1JX0ZMVVNIX0RXICsgMTsKLQotCS8qIFdlIGFsd2F5cyByZXF1aXJlIGEgY29tbWFuZCBi
YXJyaWVyIHNvIHRoYXQgc3Vic2VxdWVudAotCSAqIGNvbW1hbmRzLCBzdWNoIGFzIGJyZWFkY3J1
bWIgaW50ZXJydXB0cywgYXJlIHN0cmljdGx5IG9yZGVyZWQKLQkgKiB3cnQgdGhlIGNvbnRlbnRz
IG9mIHRoZSB3cml0ZSBjYWNoZSBiZWluZyBmbHVzaGVkIHRvIG1lbW9yeQotCSAqIChhbmQgdGh1
cyBiZWluZyBjb2hlcmVudCBmcm9tIHRoZSBDUFUpLgotCSAqLwotCWNtZCB8PSBNSV9GTFVTSF9E
V19TVE9SRV9JTkRFWCB8IE1JX0ZMVVNIX0RXX09QX1NUT1JFRFc7Ci0KLQlpZiAobW9kZSAmIEVN
SVRfSU5WQUxJREFURSkgewotCQljbWQgfD0gTUlfSU5WQUxJREFURV9UTEI7Ci0JCWlmIChyZXF1
ZXN0LT5lbmdpbmUtPmNsYXNzID09IFZJREVPX0RFQ09ERV9DTEFTUykKLQkJCWNtZCB8PSBNSV9J
TlZBTElEQVRFX0JTRDsKLQl9Ci0KLQkqY3MrKyA9IGNtZDsKLQkqY3MrKyA9IExSQ19QUEhXU1Bf
U0NSQVRDSF9BRERSOwotCSpjcysrID0gMDsgLyogdXBwZXIgYWRkciAqLwotCSpjcysrID0gMDsg
LyogdmFsdWUgKi8KLQotCWlmIChhdXhfaW52KSB7IC8qIGhzZGVzOiAxODA5MTc1NzkwICovCi0J
CXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKLQkJdW5zaWduZWQgaW50IHRtcDsKLQot
CQkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKGh3ZWlnaHQ4KGF1eF9pbnYpKTsKLQkJZm9y
X2VhY2hfZW5naW5lX21hc2tlZChlbmdpbmUsIHJlcXVlc3QtPmVuZ2luZS0+Z3QsCi0JCQkJICAg
ICAgIGF1eF9pbnYsIHRtcCkgewotCQkJKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChhdXhf
aW52X3JlZyhlbmdpbmUpKTsKLQkJCSpjcysrID0gQVVYX0lOVjsKLQkJfQotCQkqY3MrKyA9IE1J
X05PT1A7Ci0JfQotCi0JaWYgKG1vZGUgJiBFTUlUX0lOVkFMSURBVEUpCi0JCSpjcysrID0gcHJl
cGFyc2VyX2Rpc2FibGUoZmFsc2UpOwotCi0JaW50ZWxfcmluZ19hZHZhbmNlKHJlcXVlc3QsIGNz
KTsKLQotCXJldHVybiAwOwotfQotCi1zdGF0aWMgdm9pZCBhc3NlcnRfcmVxdWVzdF92YWxpZChz
dHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKLXsKLQlzdHJ1Y3QgaW50ZWxfcmluZyAqcmluZyBfX21h
eWJlX3VudXNlZCA9IHJxLT5yaW5nOwotCi0JLyogQ2FuIHdlIHVud2luZCB0aGlzIHJlcXVlc3Qg
d2l0aG91dCBhcHBlYXJpbmcgdG8gZ28gZm9yd2FyZHM/ICovCi0JR0VNX0JVR19PTihpbnRlbF9y
aW5nX2RpcmVjdGlvbihyaW5nLCBycS0+d2FfdGFpbCwgcnEtPmhlYWQpIDw9IDApOwotfQotCi0v
KgotICogUmVzZXJ2ZSBzcGFjZSBmb3IgMiBOT09QcyBhdCB0aGUgZW5kIG9mIGVhY2ggcmVxdWVz
dCB0byBiZQotICogdXNlZCBhcyBhIHdvcmthcm91bmQgZm9yIG5vdCBiZWluZyBhbGxvd2VkIHRv
IGRvIGxpdGUKLSAqIHJlc3RvcmUgd2l0aCBIRUFEPT1UQUlMIChXYUlkbGVMaXRlUmVzdG9yZSku
Ci0gKi8KLXN0YXRpYyB1MzIgKmdlbjhfZW1pdF93YV90YWlsKHN0cnVjdCBpOTE1X3JlcXVlc3Qg
KnJlcXVlc3QsIHUzMiAqY3MpCi17Ci0JLyogRW5zdXJlIHRoZXJlJ3MgYWx3YXlzIGF0IGxlYXN0
IG9uZSBwcmVlbXB0aW9uIHBvaW50IHBlci1yZXF1ZXN0LiAqLwotCSpjcysrID0gTUlfQVJCX0NI
RUNLOwotCSpjcysrID0gTUlfTk9PUDsKLQlyZXF1ZXN0LT53YV90YWlsID0gaW50ZWxfcmluZ19v
ZmZzZXQocmVxdWVzdCwgY3MpOwotCi0JLyogQ2hlY2sgdGhhdCBlbnRpcmUgcmVxdWVzdCBpcyBs
ZXNzIHRoYW4gaGFsZiB0aGUgcmluZyAqLwotCWFzc2VydF9yZXF1ZXN0X3ZhbGlkKHJlcXVlc3Qp
OwotCi0JcmV0dXJuIGNzOwotfQotCi1zdGF0aWMgdTMyICplbWl0X3ByZWVtcHRfYnVzeXdhaXQo
c3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCwgdTMyICpjcykKLXsKLQkqY3MrKyA9IE1JX1NF
TUFQSE9SRV9XQUlUIHwKLQkJTUlfU0VNQVBIT1JFX0dMT0JBTF9HVFQgfAotCQlNSV9TRU1BUEhP
UkVfUE9MTCB8Ci0JCU1JX1NFTUFQSE9SRV9TQURfRVFfU0REOwotCSpjcysrID0gMDsKLQkqY3Mr
KyA9IGludGVsX2h3c19wcmVlbXB0X2FkZHJlc3MocmVxdWVzdC0+ZW5naW5lKTsKLQkqY3MrKyA9
IDA7Ci0KLQlyZXR1cm4gY3M7Ci19Ci0KLXN0YXRpYyBfX2Fsd2F5c19pbmxpbmUgdTMyKgotZ2Vu
OF9lbWl0X2ZpbmlfYnJlYWRjcnVtYl90YWlsKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3Qs
IHUzMiAqY3MpCi17Ci0JKmNzKysgPSBNSV9VU0VSX0lOVEVSUlVQVDsKLQotCSpjcysrID0gTUlf
QVJCX09OX09GRiB8IE1JX0FSQl9FTkFCTEU7Ci0JaWYgKGludGVsX2VuZ2luZV9oYXNfc2VtYXBo
b3JlcyhyZXF1ZXN0LT5lbmdpbmUpKQotCQljcyA9IGVtaXRfcHJlZW1wdF9idXN5d2FpdChyZXF1
ZXN0LCBjcyk7Ci0KLQlyZXF1ZXN0LT50YWlsID0gaW50ZWxfcmluZ19vZmZzZXQocmVxdWVzdCwg
Y3MpOwotCWFzc2VydF9yaW5nX3RhaWxfdmFsaWQocmVxdWVzdC0+cmluZywgcmVxdWVzdC0+dGFp
bCk7Ci0KLQlyZXR1cm4gZ2VuOF9lbWl0X3dhX3RhaWwocmVxdWVzdCwgY3MpOwotfQotCi1zdGF0
aWMgdTMyICplbWl0X3hjc19icmVhZGNydW1iKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCB1MzIg
KmNzKQotewotCXJldHVybiBnZW44X2VtaXRfZ2d0dF93cml0ZShjcywgcnEtPmZlbmNlLnNlcW5v
LCBod3NwX29mZnNldChycSksIDApOwotfQotCi1zdGF0aWMgdTMyICpnZW44X2VtaXRfZmluaV9i
cmVhZGNydW1iKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCB1MzIgKmNzKQotewotCXJldHVybiBn
ZW44X2VtaXRfZmluaV9icmVhZGNydW1iX3RhaWwocnEsIGVtaXRfeGNzX2JyZWFkY3J1bWIocnEs
IGNzKSk7Ci19Ci0KLXN0YXRpYyB1MzIgKmdlbjhfZW1pdF9maW5pX2JyZWFkY3J1bWJfcmNzKHN0
cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QsIHUzMiAqY3MpCi17Ci0JY3MgPSBnZW44X2VtaXRf
cGlwZV9jb250cm9sKGNzLAotCQkJCSAgICBQSVBFX0NPTlRST0xfUkVOREVSX1RBUkdFVF9DQUNI
RV9GTFVTSCB8Ci0JCQkJICAgIFBJUEVfQ09OVFJPTF9ERVBUSF9DQUNIRV9GTFVTSCB8Ci0JCQkJ
ICAgIFBJUEVfQ09OVFJPTF9EQ19GTFVTSF9FTkFCTEUsCi0JCQkJICAgIDApOwotCi0JLyogWFhY
IGZsdXNoK3dyaXRlK0NTX1NUQUxMIGFsbCBpbiBvbmUgdXBzZXRzIGdlbV9jb25jdXJyZW50X2Js
dDprYmwgKi8KLQljcyA9IGdlbjhfZW1pdF9nZ3R0X3dyaXRlX3JjcyhjcywKLQkJCQkgICAgICBy
ZXF1ZXN0LT5mZW5jZS5zZXFubywKLQkJCQkgICAgICBod3NwX29mZnNldChyZXF1ZXN0KSwKLQkJ
CQkgICAgICBQSVBFX0NPTlRST0xfRkxVU0hfRU5BQkxFIHwKLQkJCQkgICAgICBQSVBFX0NPTlRS
T0xfQ1NfU1RBTEwpOwotCi0JcmV0dXJuIGdlbjhfZW1pdF9maW5pX2JyZWFkY3J1bWJfdGFpbChy
ZXF1ZXN0LCBjcyk7Ci19Ci0KLXN0YXRpYyB1MzIgKgotZ2VuMTFfZW1pdF9maW5pX2JyZWFkY3J1
bWJfcmNzKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QsIHUzMiAqY3MpCi17Ci0JY3MgPSBn
ZW44X2VtaXRfZ2d0dF93cml0ZV9yY3MoY3MsCi0JCQkJICAgICAgcmVxdWVzdC0+ZmVuY2Uuc2Vx
bm8sCi0JCQkJICAgICAgaHdzcF9vZmZzZXQocmVxdWVzdCksCi0JCQkJICAgICAgUElQRV9DT05U
Uk9MX0NTX1NUQUxMIHwKLQkJCQkgICAgICBQSVBFX0NPTlRST0xfVElMRV9DQUNIRV9GTFVTSCB8
Ci0JCQkJICAgICAgUElQRV9DT05UUk9MX1JFTkRFUl9UQVJHRVRfQ0FDSEVfRkxVU0ggfAotCQkJ
CSAgICAgIFBJUEVfQ09OVFJPTF9ERVBUSF9DQUNIRV9GTFVTSCB8Ci0JCQkJICAgICAgUElQRV9D
T05UUk9MX0RDX0ZMVVNIX0VOQUJMRSB8Ci0JCQkJICAgICAgUElQRV9DT05UUk9MX0ZMVVNIX0VO
QUJMRSk7Ci0KLQlyZXR1cm4gZ2VuOF9lbWl0X2ZpbmlfYnJlYWRjcnVtYl90YWlsKHJlcXVlc3Qs
IGNzKTsKLX0KLQotLyoKLSAqIE5vdGUgdGhhdCB0aGUgQ1MgaW5zdHJ1Y3Rpb24gcHJlLXBhcnNl
ciB3aWxsIG5vdCBzdGFsbCBvbiB0aGUgYnJlYWRjcnVtYgotICogZmx1c2ggYW5kIHdpbGwgY29u
dGludWUgcHJlLWZldGNoaW5nIHRoZSBpbnN0cnVjdGlvbnMgYWZ0ZXIgaXQgYmVmb3JlIHRoZQot
ICogbWVtb3J5IHN5bmMgaXMgY29tcGxldGVkLiBPbiBwcmUtZ2VuMTIgSFcsIHRoZSBwcmUtcGFy
c2VyIHdpbGwgc3RvcCBhdAotICogQkJfU1RBUlQvRU5EIGluc3RydWN0aW9ucywgc28sIGV2ZW4g
dGhvdWdoIHdlIG1pZ2h0IHByZS1mZXRjaCB0aGUgcHJlLWFtYmxlCi0gKiBvZiB0aGUgbmV4dCBy
ZXF1ZXN0IGJlZm9yZSB0aGUgbWVtb3J5IGhhcyBiZWVuIGZsdXNoZWQsIHdlJ3JlIGd1YXJhbnRl
ZWQgdGhhdAotICogd2Ugd29uJ3QgYWNjZXNzIHRoZSBiYXRjaCBpdHNlbGYgdG9vIGVhcmx5Lgot
ICogSG93ZXZlciwgb24gZ2VuMTIrIHRoZSBwYXJzZXIgY2FuIHByZS1mZXRjaCBhY3Jvc3MgdGhl
IEJCX1NUQVJUL0VORCBjb21tYW5kcywKLSAqIHNvLCBpZiB0aGUgY3VycmVudCByZXF1ZXN0IGlz
IG1vZGlmeWluZyBhbiBpbnN0cnVjdGlvbiBpbiB0aGUgbmV4dCByZXF1ZXN0IG9uCi0gKiB0aGUg
c2FtZSBpbnRlbF9jb250ZXh0LCB3ZSBtaWdodCBwcmUtZmV0Y2ggYW5kIHRoZW4gZXhlY3V0ZSB0
aGUgcHJlLXVwZGF0ZQotICogaW5zdHJ1Y3Rpb24uIFRvIGF2b2lkIHRoaXMsIHRoZSB1c2VycyBv
ZiBzZWxmLW1vZGlmeWluZyBjb2RlIHNob3VsZCBlaXRoZXIKLSAqIGRpc2FibGUgdGhlIHBhcnNl
ciBhcm91bmQgdGhlIGNvZGUgZW1pdHRpbmcgdGhlIG1lbW9yeSB3cml0ZXMsIHZpYSBhIG5ldyBm
bGFnCi0gKiBhZGRlZCB0byBNSV9BUkJfQ0hFQ0ssIG9yIGVtaXQgdGhlIHdyaXRlcyBmcm9tIGEg
ZGlmZmVyZW50IGludGVsX2NvbnRleHQuIEZvcgotICogdGhlIGluLWtlcm5lbCB1c2UtY2FzZXMg
d2UndmUgb3B0ZWQgdG8gdXNlIGEgc2VwYXJhdGUgY29udGV4dCwgc2VlCi0gKiByZWxvY19ncHUo
KSBhcyBhbiBleGFtcGxlLgotICogQWxsIHRoZSBhYm92ZSBhcHBsaWVzIG9ubHkgdG8gdGhlIGlu
c3RydWN0aW9ucyB0aGVtc2VsdmVzLiBOb24taW5saW5lIGRhdGEKLSAqIHVzZWQgYnkgdGhlIGlu
c3RydWN0aW9ucyBpcyBub3QgcHJlLWZldGNoZWQuCi0gKi8KLQotc3RhdGljIHUzMiAqZ2VuMTJf
ZW1pdF9wcmVlbXB0X2J1c3l3YWl0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QsIHUzMiAq
Y3MpCi17Ci0JKmNzKysgPSBNSV9TRU1BUEhPUkVfV0FJVF9UT0tFTiB8Ci0JCU1JX1NFTUFQSE9S
RV9HTE9CQUxfR1RUIHwKLQkJTUlfU0VNQVBIT1JFX1BPTEwgfAotCQlNSV9TRU1BUEhPUkVfU0FE
X0VRX1NERDsKLQkqY3MrKyA9IDA7Ci0JKmNzKysgPSBpbnRlbF9od3NfcHJlZW1wdF9hZGRyZXNz
KHJlcXVlc3QtPmVuZ2luZSk7Ci0JKmNzKysgPSAwOwotCSpjcysrID0gMDsKLQkqY3MrKyA9IE1J
X05PT1A7Ci0KLQlyZXR1cm4gY3M7Ci19Ci0KLXN0YXRpYyBfX2Fsd2F5c19pbmxpbmUgdTMyKgot
Z2VuMTJfZW1pdF9maW5pX2JyZWFkY3J1bWJfdGFpbChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1
ZXN0LCB1MzIgKmNzKQotewotCSpjcysrID0gTUlfVVNFUl9JTlRFUlJVUFQ7Ci0KLQkqY3MrKyA9
IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJfRU5BQkxFOwotCWlmIChpbnRlbF9lbmdpbmVfaGFzX3Nl
bWFwaG9yZXMocmVxdWVzdC0+ZW5naW5lKSkKLQkJY3MgPSBnZW4xMl9lbWl0X3ByZWVtcHRfYnVz
eXdhaXQocmVxdWVzdCwgY3MpOwotCi0JcmVxdWVzdC0+dGFpbCA9IGludGVsX3Jpbmdfb2Zmc2V0
KHJlcXVlc3QsIGNzKTsKLQlhc3NlcnRfcmluZ190YWlsX3ZhbGlkKHJlcXVlc3QtPnJpbmcsIHJl
cXVlc3QtPnRhaWwpOwotCi0JcmV0dXJuIGdlbjhfZW1pdF93YV90YWlsKHJlcXVlc3QsIGNzKTsK
LX0KLQotc3RhdGljIHUzMiAqZ2VuMTJfZW1pdF9maW5pX2JyZWFkY3J1bWIoc3RydWN0IGk5MTVf
cmVxdWVzdCAqcnEsIHUzMiAqY3MpCi17Ci0JLyogWFhYIFN0YWxsaW5nIGZsdXNoIGJlZm9yZSBz
ZXFubyB3cml0ZTsgcG9zdC1zeW5jIG5vdCAqLwotCWNzID0gZW1pdF94Y3NfYnJlYWRjcnVtYihy
cSwgX19nZW44X2VtaXRfZmx1c2hfZHcoY3MsIDAsIDAsIDApKTsKLQlyZXR1cm4gZ2VuMTJfZW1p
dF9maW5pX2JyZWFkY3J1bWJfdGFpbChycSwgY3MpOwotfQotCi1zdGF0aWMgdTMyICoKLWdlbjEy
X2VtaXRfZmluaV9icmVhZGNydW1iX3JjcyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0LCB1
MzIgKmNzKQotewotCWNzID0gZ2VuMTJfZW1pdF9nZ3R0X3dyaXRlX3JjcyhjcywKLQkJCQkgICAg
ICAgcmVxdWVzdC0+ZmVuY2Uuc2Vxbm8sCi0JCQkJICAgICAgIGh3c3Bfb2Zmc2V0KHJlcXVlc3Qp
LAotCQkJCSAgICAgICBQSVBFX0NPTlRST0wwX0hEQ19QSVBFTElORV9GTFVTSCwKLQkJCQkgICAg
ICAgUElQRV9DT05UUk9MX0NTX1NUQUxMIHwKLQkJCQkgICAgICAgUElQRV9DT05UUk9MX1RJTEVf
Q0FDSEVfRkxVU0ggfAotCQkJCSAgICAgICBQSVBFX0NPTlRST0xfRkxVU0hfTDMgfAotCQkJCSAg
ICAgICBQSVBFX0NPTlRST0xfUkVOREVSX1RBUkdFVF9DQUNIRV9GTFVTSCB8Ci0JCQkJICAgICAg
IFBJUEVfQ09OVFJPTF9ERVBUSF9DQUNIRV9GTFVTSCB8Ci0JCQkJICAgICAgIC8qIFdhXzE0MDk2
MDA5MDc6dGdsICovCi0JCQkJICAgICAgIFBJUEVfQ09OVFJPTF9ERVBUSF9TVEFMTCB8Ci0JCQkJ
ICAgICAgIFBJUEVfQ09OVFJPTF9EQ19GTFVTSF9FTkFCTEUgfAotCQkJCSAgICAgICBQSVBFX0NP
TlRST0xfRkxVU0hfRU5BQkxFKTsKLQotCXJldHVybiBnZW4xMl9lbWl0X2ZpbmlfYnJlYWRjcnVt
Yl90YWlsKHJlcXVlc3QsIGNzKTsKLX0KLQogc3RhdGljIHZvaWQgZXhlY2xpc3RzX3Bhcmsoc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewogCWNhbmNlbF90aW1lcigmZW5naW5lLT5l
eGVjbGlzdHMudGltZXIpOwpAQCAtNTExMywxMiArNDUwMCwxMiBAQCBsb2dpY2FsX3JpbmdfZGVm
YXVsdF92ZnVuY3Moc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCWVuZ2luZS0+Y29w
cyA9ICZleGVjbGlzdHNfY29udGV4dF9vcHM7CiAJZW5naW5lLT5yZXF1ZXN0X2FsbG9jID0gZXhl
Y2xpc3RzX3JlcXVlc3RfYWxsb2M7CiAKLQllbmdpbmUtPmVtaXRfZmx1c2ggPSBnZW44X2VtaXRf
Zmx1c2g7CisJZW5naW5lLT5lbWl0X2ZsdXNoID0gZ2VuOF9lbWl0X2ZsdXNoX3hjczsKIAllbmdp
bmUtPmVtaXRfaW5pdF9icmVhZGNydW1iID0gZ2VuOF9lbWl0X2luaXRfYnJlYWRjcnVtYjsKLQll
bmdpbmUtPmVtaXRfZmluaV9icmVhZGNydW1iID0gZ2VuOF9lbWl0X2ZpbmlfYnJlYWRjcnVtYjsK
KwllbmdpbmUtPmVtaXRfZmluaV9icmVhZGNydW1iID0gZ2VuOF9lbWl0X2ZpbmlfYnJlYWRjcnVt
Yl94Y3M7CiAJaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDEyKSB7Ci0JCWVuZ2luZS0+
ZW1pdF9maW5pX2JyZWFkY3J1bWIgPSBnZW4xMl9lbWl0X2ZpbmlfYnJlYWRjcnVtYjsKLQkJZW5n
aW5lLT5lbWl0X2ZsdXNoID0gZ2VuMTJfZW1pdF9mbHVzaDsKKwkJZW5naW5lLT5lbWl0X2Zpbmlf
YnJlYWRjcnVtYiA9IGdlbjEyX2VtaXRfZmluaV9icmVhZGNydW1iX3hjczsKKwkJZW5naW5lLT5l
bWl0X2ZsdXNoID0gZ2VuMTJfZW1pdF9mbHVzaF94Y3M7CiAJfQogCWVuZ2luZS0+c2V0X2RlZmF1
bHRfc3VibWlzc2lvbiA9IGludGVsX2V4ZWNsaXN0c19zZXRfZGVmYXVsdF9zdWJtaXNzaW9uOwog
CkBAIC01MTYyLDE1ICs0NTQ5LDE1IEBAIHN0YXRpYyB2b2lkIHJjc19zdWJtaXNzaW9uX292ZXJy
aWRlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsKIAlzd2l0Y2ggKElOVEVMX0dF
TihlbmdpbmUtPmk5MTUpKSB7CiAJY2FzZSAxMjoKLQkJZW5naW5lLT5lbWl0X2ZsdXNoID0gZ2Vu
MTJfZW1pdF9mbHVzaF9yZW5kZXI7CisJCWVuZ2luZS0+ZW1pdF9mbHVzaCA9IGdlbjEyX2VtaXRf
Zmx1c2hfcmNzOwogCQllbmdpbmUtPmVtaXRfZmluaV9icmVhZGNydW1iID0gZ2VuMTJfZW1pdF9m
aW5pX2JyZWFkY3J1bWJfcmNzOwogCQlicmVhazsKIAljYXNlIDExOgotCQllbmdpbmUtPmVtaXRf
Zmx1c2ggPSBnZW4xMV9lbWl0X2ZsdXNoX3JlbmRlcjsKKwkJZW5naW5lLT5lbWl0X2ZsdXNoID0g
Z2VuMTFfZW1pdF9mbHVzaF9yY3M7CiAJCWVuZ2luZS0+ZW1pdF9maW5pX2JyZWFkY3J1bWIgPSBn
ZW4xMV9lbWl0X2ZpbmlfYnJlYWRjcnVtYl9yY3M7CiAJCWJyZWFrOwogCWRlZmF1bHQ6Ci0JCWVu
Z2luZS0+ZW1pdF9mbHVzaCA9IGdlbjhfZW1pdF9mbHVzaF9yZW5kZXI7CisJCWVuZ2luZS0+ZW1p
dF9mbHVzaCA9IGdlbjhfZW1pdF9mbHVzaF9yY3M7CiAJCWVuZ2luZS0+ZW1pdF9maW5pX2JyZWFk
Y3J1bWIgPSBnZW44X2VtaXRfZmluaV9icmVhZGNydW1iX3JjczsKIAkJYnJlYWs7CiAJfQotLSAK
Mi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJ
bnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0
cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZngK

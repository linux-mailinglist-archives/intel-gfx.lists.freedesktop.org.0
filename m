Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id B110730FD1E
	for <lists+intel-gfx@lfdr.de>; Thu,  4 Feb 2021 20:44:33 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 15BF66EE4F;
	Thu,  4 Feb 2021 19:44:32 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga11.intel.com (mga11.intel.com [192.55.52.93])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2BD556EE4F
 for <intel-gfx@lists.freedesktop.org>; Thu,  4 Feb 2021 19:44:30 +0000 (UTC)
IronPort-SDR: xyFF+e+qHt18QOa/cpxRL3NPdjUFwkIIdifsFcVW+cUGYLb7E/NtvFa1knr4EemQeJu3aezcX4
 94W0OVzi88wA==
X-IronPort-AV: E=McAfee;i="6000,8403,9885"; a="177812369"
X-IronPort-AV: E=Sophos;i="5.81,153,1610438400"; d="scan'208";a="177812369"
Received: from orsmga004.jf.intel.com ([10.7.209.38])
 by fmsmga102.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 04 Feb 2021 11:44:29 -0800
IronPort-SDR: /w2JwirOfJMaWZlhUVsjgA8zdv1B3SzEiUPv/nZ5ZhovbaQGbSWhs0OaH9DrB3i3scUYM06cO+
 OOfGDmQn0kQw==
X-IronPort-AV: E=Sophos;i="5.81,153,1610438400"; d="scan'208";a="508253588"
Received: from dbmayer-mobl.ger.corp.intel.com (HELO localhost) ([10.252.53.1])
 by orsmga004-auth.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 04 Feb 2021 11:44:26 -0800
From: Jani Nikula <jani.nikula@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Thu,  4 Feb 2021 21:43:24 +0200
Message-Id: <7524f18c2c37b933fd328e4e7fab5d6bd192f381.1612467466.git.jani.nikula@intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <cover.1612467466.git.jani.nikula@intel.com>
References: <cover.1612467466.git.jani.nikula@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v11 07/10] drm/i915: migrate pll enable/disable
 code to intel_dpll.[ch]
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: jani.nikula@intel.com, Dave Airlie <airlied@redhat.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogRGF2ZSBBaXJsaWUgPGFpcmxpZWRAcmVkaGF0LmNvbT4KClRoaXMgbW92ZXMgdGhlIG9s
ZGVyIGk5eHgvdmx2L2NodiBlbmFibGUvZGlzYWJsZSB0byBkcGxsIGZpbGUuCgpTaWduZWQtb2Zm
LWJ5OiBEYXZlIEFpcmxpZSA8YWlybGllZEByZWRoYXQuY29tPgpSZXZpZXdlZC1ieTogVmlsbGUg
U3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KU2lnbmVkLW9mZi1ieTog
SmFuaSBOaWt1bGEgPGphbmkubmlrdWxhQGludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyB8IDUxMiAtLS0tLS0tLS0tLS0tLS0tLS0tCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuaCB8ICAgMyAtCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwLmMgICAgICB8ICAgMSArCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwbGwuYyAgICB8IDUwOSArKysrKysrKysrKysr
KysrKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHBsbC5oICAgIHwgIDE4
ICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcHBzLmMgICAgIHwgICAxICsK
IDYgZmlsZXMgY2hhbmdlZCwgNTI5IGluc2VydGlvbnMoKyksIDUxNSBkZWxldGlvbnMoLSkKCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCmluZGV4IDM3NTg2
MjdmMGY3ZC4uMDA5ZjM4Y2JkM2M1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2Rpc3BsYXkuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2Rpc3BsYXkuYwpAQCAtMTEzLDEwICsxMTMsNiBAQCBzdGF0aWMgdm9pZCBpOXh4X3Nl
dF9waXBlY29uZihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7CiBz
dGF0aWMgdm9pZCBpbGtfc2V0X3BpcGVjb25mKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlKTsKIHN0YXRpYyB2b2lkIGhzd19zZXRfcGlwZWNvbmYoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpOwogc3RhdGljIHZvaWQgYmR3X3NldF9waXBl
bWlzYyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7Ci1zdGF0aWMg
dm9pZCB2bHZfcHJlcGFyZV9wbGwoc3RydWN0IGludGVsX2NydGMgKmNydGMsCi0JCQkgICAgY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKTsKLXN0YXRpYyB2b2lkIGNo
dl9wcmVwYXJlX3BsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKLQkJCSAgICBjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpOwogc3RhdGljIHZvaWQgaWxrX3BmaXRf
ZW5hYmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKTsKIHN0YXRp
YyB2b2lkIGludGVsX21vZGVzZXRfc2V0dXBfaHdfc3RhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRl
diwKIAkJCQkJIHN0cnVjdCBkcm1fbW9kZXNldF9hY3F1aXJlX2N0eCAqY3R4KTsKQEAgLTU2OSwy
MjQgKzU2NSw2IEBAIHN0YXRpYyB2b2lkIGFzc2VydF9wY2hfcG9ydHNfZGlzYWJsZWQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogCWFzc2VydF9wY2hfaGRtaV9kaXNhYmxlZChk
ZXZfcHJpdiwgcGlwZSwgUE9SVF9ELCBQQ0hfSERNSUQpOwogfQogCi1zdGF0aWMgdm9pZCBfdmx2
X2VuYWJsZV9wbGwoc3RydWN0IGludGVsX2NydGMgKmNydGMsCi0JCQkgICAgY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQotewotCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwotCWVudW0gcGlwZSBwaXBl
ID0gY3J0Yy0+cGlwZTsKLQotCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBEUExMKHBpcGUpLCBw
aXBlX2NvbmZpZy0+ZHBsbF9od19zdGF0ZS5kcGxsKTsKLQlpbnRlbF9kZV9wb3N0aW5nX3JlYWQo
ZGV2X3ByaXYsIERQTEwocGlwZSkpOwotCXVkZWxheSgxNTApOwotCi0JaWYgKGludGVsX2RlX3dh
aXRfZm9yX3NldChkZXZfcHJpdiwgRFBMTChwaXBlKSwgRFBMTF9MT0NLX1ZMViwgMSkpCi0JCWRy
bV9lcnIoJmRldl9wcml2LT5kcm0sICJEUExMICVkIGZhaWxlZCB0byBsb2NrXG4iLCBwaXBlKTsK
LX0KLQotc3RhdGljIHZvaWQgdmx2X2VuYWJsZV9wbGwoc3RydWN0IGludGVsX2NydGMgKmNydGMs
Ci0JCQkgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCi17Ci0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRl
dik7Ci0JZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwotCi0JYXNzZXJ0X3BpcGVfZGlzYWJs
ZWQoZGV2X3ByaXYsIHBpcGVfY29uZmlnLT5jcHVfdHJhbnNjb2Rlcik7Ci0KLQkvKiBQTEwgaXMg
cHJvdGVjdGVkIGJ5IHBhbmVsLCBtYWtlIHN1cmUgd2UgY2FuIHdyaXRlIGl0ICovCi0JYXNzZXJ0
X3BhbmVsX3VubG9ja2VkKGRldl9wcml2LCBwaXBlKTsKLQotCWlmIChwaXBlX2NvbmZpZy0+ZHBs
bF9od19zdGF0ZS5kcGxsICYgRFBMTF9WQ09fRU5BQkxFKQotCQlfdmx2X2VuYWJsZV9wbGwoY3J0
YywgcGlwZV9jb25maWcpOwotCi0JaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIERQTExfTUQocGlw
ZSksCi0JCSAgICAgICBwaXBlX2NvbmZpZy0+ZHBsbF9od19zdGF0ZS5kcGxsX21kKTsKLQlpbnRl
bF9kZV9wb3N0aW5nX3JlYWQoZGV2X3ByaXYsIERQTExfTUQocGlwZSkpOwotfQotCi0KLXN0YXRp
YyB2b2lkIF9jaHZfZW5hYmxlX3BsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKLQkJCSAgICBj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCi17Ci0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Ci0JZW51
bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwotCWVudW0gZHBpb19jaGFubmVsIHBvcnQgPSB2bHZf
cGlwZV90b19jaGFubmVsKHBpcGUpOwotCXUzMiB0bXA7Ci0KLQl2bHZfZHBpb19nZXQoZGV2X3By
aXYpOwotCi0JLyogRW5hYmxlIGJhY2sgdGhlIDEwYml0IGNsb2NrIHRvIGRpc3BsYXkgY29udHJv
bGxlciAqLwotCXRtcCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIENIVl9DTU5fRFcx
NChwb3J0KSk7Ci0JdG1wIHw9IERQSU9fRENMS1BfRU47Ci0Jdmx2X2RwaW9fd3JpdGUoZGV2X3By
aXYsIHBpcGUsIENIVl9DTU5fRFcxNChwb3J0KSwgdG1wKTsKLQotCXZsdl9kcGlvX3B1dChkZXZf
cHJpdik7Ci0KLQkvKgotCSAqIE5lZWQgdG8gd2FpdCA+IDEwMG5zIGJldHdlZW4gZGNsa3AgY2xv
Y2sgZW5hYmxlIGJpdCBhbmQgUExMIGVuYWJsZS4KLQkgKi8KLQl1ZGVsYXkoMSk7Ci0KLQkvKiBF
bmFibGUgUExMICovCi0JaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIERQTEwocGlwZSksIHBpcGVf
Y29uZmlnLT5kcGxsX2h3X3N0YXRlLmRwbGwpOwotCi0JLyogQ2hlY2sgUExMIGlzIGxvY2tlZCAq
LwotCWlmIChpbnRlbF9kZV93YWl0X2Zvcl9zZXQoZGV2X3ByaXYsIERQTEwocGlwZSksIERQTExf
TE9DS19WTFYsIDEpKQotCQlkcm1fZXJyKCZkZXZfcHJpdi0+ZHJtLCAiUExMICVkIGZhaWxlZCB0
byBsb2NrXG4iLCBwaXBlKTsKLX0KLQotc3RhdGljIHZvaWQgY2h2X2VuYWJsZV9wbGwoc3RydWN0
IGludGVsX2NydGMgKmNydGMsCi0JCQkgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
cGlwZV9jb25maWcpCi17Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShjcnRjLT5iYXNlLmRldik7Ci0JZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwotCi0J
YXNzZXJ0X3BpcGVfZGlzYWJsZWQoZGV2X3ByaXYsIHBpcGVfY29uZmlnLT5jcHVfdHJhbnNjb2Rl
cik7Ci0KLQkvKiBQTEwgaXMgcHJvdGVjdGVkIGJ5IHBhbmVsLCBtYWtlIHN1cmUgd2UgY2FuIHdy
aXRlIGl0ICovCi0JYXNzZXJ0X3BhbmVsX3VubG9ja2VkKGRldl9wcml2LCBwaXBlKTsKLQotCWlm
IChwaXBlX2NvbmZpZy0+ZHBsbF9od19zdGF0ZS5kcGxsICYgRFBMTF9WQ09fRU5BQkxFKQotCQlf
Y2h2X2VuYWJsZV9wbGwoY3J0YywgcGlwZV9jb25maWcpOwotCi0JaWYgKHBpcGUgIT0gUElQRV9B
KSB7Ci0JCS8qCi0JCSAqIFdhUGl4ZWxSZXBlYXRNb2RlRml4Rm9yQzA6Y2h2Ci0JCSAqCi0JCSAq
IERQTExDTUQgaXMgQVdPTC4gVXNlIGNoaWNrZW4gYml0cyB0byBwcm9wYWdhdGUKLQkJICogdGhl
IHZhbHVlIGZyb20gRFBMTEJNRCB0byBlaXRoZXIgcGlwZSBCIG9yIEMuCi0JCSAqLwotCQlpbnRl
bF9kZV93cml0ZShkZXZfcHJpdiwgQ0JSNF9WTFYsIENCUl9EUExMQk1EX1BJUEUocGlwZSkpOwot
CQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgRFBMTF9NRChQSVBFX0IpLAotCQkJICAgICAgIHBp
cGVfY29uZmlnLT5kcGxsX2h3X3N0YXRlLmRwbGxfbWQpOwotCQlpbnRlbF9kZV93cml0ZShkZXZf
cHJpdiwgQ0JSNF9WTFYsIDApOwotCQlkZXZfcHJpdi0+Y2h2X2RwbGxfbWRbcGlwZV0gPSBwaXBl
X2NvbmZpZy0+ZHBsbF9od19zdGF0ZS5kcGxsX21kOwotCi0JCS8qCi0JCSAqIERQTExCIFZHQSBt
b2RlIGFsc28gc2VlbXMgdG8gY2F1c2UgcHJvYmxlbXMuCi0JCSAqIFdlIHNob3VsZCBhbHdheXMg
aGF2ZSBpdCBkaXNhYmxlZC4KLQkJICovCi0JCWRybV9XQVJOX09OKCZkZXZfcHJpdi0+ZHJtLAot
CQkJICAgIChpbnRlbF9kZV9yZWFkKGRldl9wcml2LCBEUExMKFBJUEVfQikpICYKLQkJCSAgICAg
RFBMTF9WR0FfTU9ERV9ESVMpID09IDApOwotCX0gZWxzZSB7Ci0JCWludGVsX2RlX3dyaXRlKGRl
dl9wcml2LCBEUExMX01EKHBpcGUpLAotCQkJICAgICAgIHBpcGVfY29uZmlnLT5kcGxsX2h3X3N0
YXRlLmRwbGxfbWQpOwotCQlpbnRlbF9kZV9wb3N0aW5nX3JlYWQoZGV2X3ByaXYsIERQTExfTUQo
cGlwZSkpOwotCX0KLX0KLQotc3RhdGljIGJvb2wgaTl4eF9oYXNfcHBzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlpZiAoSVNfSTgzMChkZXZfcHJpdikpCi0JCXJldHVy
biBmYWxzZTsKLQotCXJldHVybiBJU19QSU5FVklFVyhkZXZfcHJpdikgfHwgSVNfTU9CSUxFKGRl
dl9wcml2KTsKLX0KLQotc3RhdGljIHZvaWQgaTl4eF9lbmFibGVfcGxsKHN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjLAotCQkJICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlKQotewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwotCWk5MTVfcmVnX3QgcmVnID0gRFBMTChjcnRjLT5waXBlKTsKLQl1MzIg
ZHBsbCA9IGNydGNfc3RhdGUtPmRwbGxfaHdfc3RhdGUuZHBsbDsKLQlpbnQgaTsKLQotCWFzc2Vy
dF9waXBlX2Rpc2FibGVkKGRldl9wcml2LCBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2Rlcik7Ci0K
LQkvKiBQTEwgaXMgcHJvdGVjdGVkIGJ5IHBhbmVsLCBtYWtlIHN1cmUgd2UgY2FuIHdyaXRlIGl0
ICovCi0JaWYgKGk5eHhfaGFzX3BwcyhkZXZfcHJpdikpCi0JCWFzc2VydF9wYW5lbF91bmxvY2tl
ZChkZXZfcHJpdiwgY3J0Yy0+cGlwZSk7Ci0KLQkvKgotCSAqIEFwcGFyZW50bHkgd2UgbmVlZCB0
byBoYXZlIFZHQSBtb2RlIGVuYWJsZWQgcHJpb3IgdG8gY2hhbmdpbmcKLQkgKiB0aGUgUDEvUDIg
ZGl2aWRlcnMuIE90aGVyd2lzZSB0aGUgRFBMTCB3aWxsIGtlZXAgdXNpbmcgdGhlIG9sZAotCSAq
IGRpdmlkZXJzLCBldmVuIHRob3VnaCB0aGUgcmVnaXN0ZXIgdmFsdWUgZG9lcyBjaGFuZ2UuCi0J
ICovCi0JaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIHJlZywgZHBsbCAmIH5EUExMX1ZHQV9NT0RF
X0RJUyk7Ci0JaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIHJlZywgZHBsbCk7Ci0KLQkvKiBXYWl0
IGZvciB0aGUgY2xvY2tzIHRvIHN0YWJpbGl6ZS4gKi8KLQlpbnRlbF9kZV9wb3N0aW5nX3JlYWQo
ZGV2X3ByaXYsIHJlZyk7Ci0JdWRlbGF5KDE1MCk7Ci0KLQlpZiAoSU5URUxfR0VOKGRldl9wcml2
KSA+PSA0KSB7Ci0JCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBEUExMX01EKGNydGMtPnBpcGUp
LAotCQkJICAgICAgIGNydGNfc3RhdGUtPmRwbGxfaHdfc3RhdGUuZHBsbF9tZCk7Ci0JfSBlbHNl
IHsKLQkJLyogVGhlIHBpeGVsIG11bHRpcGxpZXIgY2FuIG9ubHkgYmUgdXBkYXRlZCBvbmNlIHRo
ZQotCQkgKiBEUExMIGlzIGVuYWJsZWQgYW5kIHRoZSBjbG9ja3MgYXJlIHN0YWJsZS4KLQkJICoK
LQkJICogU28gd3JpdGUgaXQgYWdhaW4uCi0JCSAqLwotCQlpbnRlbF9kZV93cml0ZShkZXZfcHJp
diwgcmVnLCBkcGxsKTsKLQl9Ci0KLQkvKiBXZSBkbyB0aGlzIHRocmVlIHRpbWVzIGZvciBsdWNr
ICovCi0JZm9yIChpID0gMDsgaSA8IDM7IGkrKykgewotCQlpbnRlbF9kZV93cml0ZShkZXZfcHJp
diwgcmVnLCBkcGxsKTsKLQkJaW50ZWxfZGVfcG9zdGluZ19yZWFkKGRldl9wcml2LCByZWcpOwot
CQl1ZGVsYXkoMTUwKTsgLyogd2FpdCBmb3Igd2FybXVwICovCi0JfQotfQotCi1zdGF0aWMgdm9p
ZCBpOXh4X2Rpc2FibGVfcGxsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlKQotewotCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0
YXRlLT51YXBpLmNydGMpOwotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwotCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKLQot
CS8qIERvbid0IGRpc2FibGUgcGlwZSBvciBwaXBlIFBMTHMgaWYgbmVlZGVkICovCi0JaWYgKElT
X0k4MzAoZGV2X3ByaXYpKQotCQlyZXR1cm47Ci0KLQkvKiBNYWtlIHN1cmUgdGhlIHBpcGUgaXNu
J3Qgc3RpbGwgcmVseWluZyBvbiB1cyAqLwotCWFzc2VydF9waXBlX2Rpc2FibGVkKGRldl9wcml2
LCBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2Rlcik7Ci0KLQlpbnRlbF9kZV93cml0ZShkZXZfcHJp
diwgRFBMTChwaXBlKSwgRFBMTF9WR0FfTU9ERV9ESVMpOwotCWludGVsX2RlX3Bvc3RpbmdfcmVh
ZChkZXZfcHJpdiwgRFBMTChwaXBlKSk7Ci19Ci0KLXN0YXRpYyB2b2lkIHZsdl9kaXNhYmxlX3Bs
bChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlwZSBwaXBlKQotewot
CXUzMiB2YWw7Ci0KLQkvKiBNYWtlIHN1cmUgdGhlIHBpcGUgaXNuJ3Qgc3RpbGwgcmVseWluZyBv
biB1cyAqLwotCWFzc2VydF9waXBlX2Rpc2FibGVkKGRldl9wcml2LCAoZW51bSB0cmFuc2NvZGVy
KXBpcGUpOwotCi0JdmFsID0gRFBMTF9JTlRFR1JBVEVEX1JFRl9DTEtfVkxWIHwKLQkJRFBMTF9S
RUZfQ0xLX0VOQUJMRV9WTFYgfCBEUExMX1ZHQV9NT0RFX0RJUzsKLQlpZiAocGlwZSAhPSBQSVBF
X0EpCi0JCXZhbCB8PSBEUExMX0lOVEVHUkFURURfQ1JJX0NMS19WTFY7Ci0KLQlpbnRlbF9kZV93
cml0ZShkZXZfcHJpdiwgRFBMTChwaXBlKSwgdmFsKTsKLQlpbnRlbF9kZV9wb3N0aW5nX3JlYWQo
ZGV2X3ByaXYsIERQTEwocGlwZSkpOwotfQotCi1zdGF0aWMgdm9pZCBjaHZfZGlzYWJsZV9wbGwo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUgcGlwZSkKLXsKLQll
bnVtIGRwaW9fY2hhbm5lbCBwb3J0ID0gdmx2X3BpcGVfdG9fY2hhbm5lbChwaXBlKTsKLQl1MzIg
dmFsOwotCi0JLyogTWFrZSBzdXJlIHRoZSBwaXBlIGlzbid0IHN0aWxsIHJlbHlpbmcgb24gdXMg
Ki8KLQlhc3NlcnRfcGlwZV9kaXNhYmxlZChkZXZfcHJpdiwgKGVudW0gdHJhbnNjb2RlcilwaXBl
KTsKLQotCXZhbCA9IERQTExfU1NDX1JFRl9DTEtfQ0hWIHwKLQkJRFBMTF9SRUZfQ0xLX0VOQUJM
RV9WTFYgfCBEUExMX1ZHQV9NT0RFX0RJUzsKLQlpZiAocGlwZSAhPSBQSVBFX0EpCi0JCXZhbCB8
PSBEUExMX0lOVEVHUkFURURfQ1JJX0NMS19WTFY7Ci0KLQlpbnRlbF9kZV93cml0ZShkZXZfcHJp
diwgRFBMTChwaXBlKSwgdmFsKTsKLQlpbnRlbF9kZV9wb3N0aW5nX3JlYWQoZGV2X3ByaXYsIERQ
TEwocGlwZSkpOwotCi0Jdmx2X2RwaW9fZ2V0KGRldl9wcml2KTsKLQotCS8qIERpc2FibGUgMTBi
aXQgY2xvY2sgdG8gZGlzcGxheSBjb250cm9sbGVyICovCi0JdmFsID0gdmx2X2RwaW9fcmVhZChk
ZXZfcHJpdiwgcGlwZSwgQ0hWX0NNTl9EVzE0KHBvcnQpKTsKLQl2YWwgJj0gfkRQSU9fRENMS1Bf
RU47Ci0Jdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIENIVl9DTU5fRFcxNChwb3J0KSwg
dmFsKTsKLQotCXZsdl9kcGlvX3B1dChkZXZfcHJpdik7Ci19Ci0KIHZvaWQgdmx2X3dhaXRfcG9y
dF9yZWFkeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJCQkgc3RydWN0IGlu
dGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQsCiAJCQkgdW5zaWduZWQgaW50IGV4cGVjdGVkX21h
c2spCkBAIC01NzcxLDM1ICs1NTQ5LDYgQEAgc3RhdGljIHZvaWQgaW50ZWxfcGFuZWxfc2FuaXRp
emVfc3NjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAl9CiB9CiAKLXN0YXRp
YyB2b2lkIHZsdl9wbGxiX3JlY2FsX29wYW1wKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwgZW51bSBwaXBlCi0JCXBpcGUpCi17Ci0JdTMyIHJlZ192YWw7Ci0KLQkvKgotCSAqIFBM
TEIgb3BhbXAgYWx3YXlzIGNhbGlicmF0ZXMgdG8gbWF4IHZhbHVlIG9mIDB4M2YsIGZvcmNlIGVu
YWJsZSBpdAotCSAqIGFuZCBzZXQgaXQgdG8gYSByZWFzb25hYmxlIHZhbHVlIGluc3RlYWQuCi0J
ICovCi0JcmVnX3ZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIFZMVl9QTExfRFc5
KDEpKTsKLQlyZWdfdmFsICY9IDB4ZmZmZmZmMDA7Ci0JcmVnX3ZhbCB8PSAweDAwMDAwMDMwOwot
CXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUExMX0RXOSgxKSwgcmVnX3ZhbCk7
Ci0KLQlyZWdfdmFsID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgVkxWX1JFRl9EVzEz
KTsKLQlyZWdfdmFsICY9IDB4MDBmZmZmZmY7Ci0JcmVnX3ZhbCB8PSAweDhjMDAwMDAwOwotCXZs
dl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUkVGX0RXMTMsIHJlZ192YWwpOwotCi0J
cmVnX3ZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIFZMVl9QTExfRFc5KDEpKTsK
LQlyZWdfdmFsICY9IDB4ZmZmZmZmMDA7Ci0Jdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUs
IFZMVl9QTExfRFc5KDEpLCByZWdfdmFsKTsKLQotCXJlZ192YWwgPSB2bHZfZHBpb19yZWFkKGRl
dl9wcml2LCBwaXBlLCBWTFZfUkVGX0RXMTMpOwotCXJlZ192YWwgJj0gMHgwMGZmZmZmZjsKLQly
ZWdfdmFsIHw9IDB4YjAwMDAwMDA7Ci0Jdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZM
Vl9SRUZfRFcxMywgcmVnX3ZhbCk7Ci19Ci0KIHN0YXRpYyB2b2lkIGludGVsX3BjaF90cmFuc2Nv
ZGVyX3NldF9tX24oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJ
CQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfbGlua19tX24gKm1fbikKIHsKQEAgLTU4OTUsMjY3ICs1
NjQ0LDYgQEAgdm9pZCBpbnRlbF9kcF9zZXRfbV9uKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlLCBlbnVtIGxpbmtfbV9uX3MKIAkJaW50ZWxfY3B1X3RyYW5zY29kZXJf
c2V0X21fbihjcnRjX3N0YXRlLCBkcF9tX24sIGRwX20yX24yKTsKIH0KIAotc3RhdGljIHZvaWQg
dmx2X3ByZXBhcmVfcGxsKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAotCQkJICAgIGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKLXsKLQlzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShkZXYpOwotCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKLQl1MzIg
bWRpdjsKLQl1MzIgYmVzdG4sIGJlc3RtMSwgYmVzdG0yLCBiZXN0cDEsIGJlc3RwMjsKLQl1MzIg
Y29yZWNsaywgcmVnX3ZhbDsKLQotCS8qIEVuYWJsZSBSZWZjbGsgKi8KLQlpbnRlbF9kZV93cml0
ZShkZXZfcHJpdiwgRFBMTChwaXBlKSwKLQkJICAgICAgIHBpcGVfY29uZmlnLT5kcGxsX2h3X3N0
YXRlLmRwbGwgJiB+KERQTExfVkNPX0VOQUJMRSB8IERQTExfRVhUX0JVRkZFUl9FTkFCTEVfVkxW
KSk7Ci0KLQkvKiBObyBuZWVkIHRvIGFjdHVhbGx5IHNldCB1cCB0aGUgRFBMTCB3aXRoIERTSSAq
LwotCWlmICgocGlwZV9jb25maWctPmRwbGxfaHdfc3RhdGUuZHBsbCAmIERQTExfVkNPX0VOQUJM
RSkgPT0gMCkKLQkJcmV0dXJuOwotCi0Jdmx2X2RwaW9fZ2V0KGRldl9wcml2KTsKLQotCWJlc3Ru
ID0gcGlwZV9jb25maWctPmRwbGwubjsKLQliZXN0bTEgPSBwaXBlX2NvbmZpZy0+ZHBsbC5tMTsK
LQliZXN0bTIgPSBwaXBlX2NvbmZpZy0+ZHBsbC5tMjsKLQliZXN0cDEgPSBwaXBlX2NvbmZpZy0+
ZHBsbC5wMTsKLQliZXN0cDIgPSBwaXBlX2NvbmZpZy0+ZHBsbC5wMjsKLQotCS8qIFNlZSBlRFAg
SERNSSBEUElPIGRyaXZlciB2YmlvcyBub3RlcyBkb2MgKi8KLQotCS8qIFBMTCBCIG5lZWRzIHNw
ZWNpYWwgaGFuZGxpbmcgKi8KLQlpZiAocGlwZSA9PSBQSVBFX0IpCi0JCXZsdl9wbGxiX3JlY2Fs
X29wYW1wKGRldl9wcml2LCBwaXBlKTsKLQotCS8qIFNldCB1cCBUeCB0YXJnZXQgZm9yIHBlcmlv
ZGljIFJjb21wIHVwZGF0ZSAqLwotCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZf
UExMX0RXOV9CQ0FTVCwgMHgwMTAwMDAwZik7Ci0KLQkvKiBEaXNhYmxlIHRhcmdldCBJUmVmIG9u
IFBMTCAqLwotCXJlZ192YWwgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBWTFZfUExM
X0RXOChwaXBlKSk7Ci0JcmVnX3ZhbCAmPSAweDAwZmZmZmZmOwotCXZsdl9kcGlvX3dyaXRlKGRl
dl9wcml2LCBwaXBlLCBWTFZfUExMX0RXOChwaXBlKSwgcmVnX3ZhbCk7Ci0KLQkvKiBEaXNhYmxl
IGZhc3QgbG9jayAqLwotCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfQ01OX0RX
MCwgMHg2MTApOwotCi0JLyogU2V0IGlkdGFmY3JlY2FsIGJlZm9yZSBQTEwgaXMgZW5hYmxlZCAq
LwotCW1kaXYgPSAoKGJlc3RtMSA8PCBEUElPX00xRElWX1NISUZUKSB8IChiZXN0bTIgJiBEUElP
X00yRElWX01BU0spKTsKLQltZGl2IHw9ICgoYmVzdHAxIDw8IERQSU9fUDFfU0hJRlQpIHwgKGJl
c3RwMiA8PCBEUElPX1AyX1NISUZUKSk7Ci0JbWRpdiB8PSAoKGJlc3RuIDw8IERQSU9fTl9TSElG
VCkpOwotCW1kaXYgfD0gKDEgPDwgRFBJT19LX1NISUZUKTsKLQotCS8qCi0JICogUG9zdCBkaXZp
ZGVyIGRlcGVuZHMgb24gcGl4ZWwgY2xvY2sgcmF0ZSwgREFDIHZzIGRpZ2l0YWwgKGFuZCBMVkRT
LAotCSAqIGJ1dCB3ZSBkb24ndCBzdXBwb3J0IHRoYXQpLgotCSAqIE5vdGU6IGRvbid0IHVzZSB0
aGUgREFDIHBvc3QgZGl2aWRlciBhcyBpdCBzZWVtcyB1bnN0YWJsZS4KLQkgKi8KLQltZGl2IHw9
IChEUElPX1BPU1RfRElWX0hETUlEUCA8PCBEUElPX1BPU1RfRElWX1NISUZUKTsKLQl2bHZfZHBp
b193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1BMTF9EVzMocGlwZSksIG1kaXYpOwotCi0JbWRp
diB8PSBEUElPX0VOQUJMRV9DQUxJQlJBVElPTjsKLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwg
cGlwZSwgVkxWX1BMTF9EVzMocGlwZSksIG1kaXYpOwotCi0JLyogU2V0IEhCUiBhbmQgUkJSIExQ
RiBjb2VmZmljaWVudHMgKi8KLQlpZiAocGlwZV9jb25maWctPnBvcnRfY2xvY2sgPT0gMTYyMDAw
IHx8Ci0JICAgIGludGVsX2NydGNfaGFzX3R5cGUocGlwZV9jb25maWcsIElOVEVMX09VVFBVVF9B
TkFMT0cpIHx8Ci0JICAgIGludGVsX2NydGNfaGFzX3R5cGUocGlwZV9jb25maWcsIElOVEVMX09V
VFBVVF9IRE1JKSkKLQkJdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9QTExfRFcx
MChwaXBlKSwKLQkJCQkgMHgwMDlmMDAwMyk7Ci0JZWxzZQotCQl2bHZfZHBpb193cml0ZShkZXZf
cHJpdiwgcGlwZSwgVkxWX1BMTF9EVzEwKHBpcGUpLAotCQkJCSAweDAwZDAwMDBmKTsKLQotCWlm
IChpbnRlbF9jcnRjX2hhc19kcF9lbmNvZGVyKHBpcGVfY29uZmlnKSkgewotCQkvKiBVc2UgU1ND
IHNvdXJjZSAqLwotCQlpZiAocGlwZSA9PSBQSVBFX0EpCi0JCQl2bHZfZHBpb193cml0ZShkZXZf
cHJpdiwgcGlwZSwgVkxWX1BMTF9EVzUocGlwZSksCi0JCQkJCSAweDBkZjQwMDAwKTsKLQkJZWxz
ZQotCQkJdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9QTExfRFc1KHBpcGUpLAot
CQkJCQkgMHgwZGY3MDAwMCk7Ci0JfSBlbHNlIHsgLyogSERNSSBvciBWR0EgKi8KLQkJLyogVXNl
IGJlbmQgc291cmNlICovCi0JCWlmIChwaXBlID09IFBJUEVfQSkKLQkJCXZsdl9kcGlvX3dyaXRl
KGRldl9wcml2LCBwaXBlLCBWTFZfUExMX0RXNShwaXBlKSwKLQkJCQkJIDB4MGRmNzAwMDApOwot
CQllbHNlCi0JCQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1BMTF9EVzUocGlw
ZSksCi0JCQkJCSAweDBkZjQwMDAwKTsKLQl9Ci0KLQljb3JlY2xrID0gdmx2X2RwaW9fcmVhZChk
ZXZfcHJpdiwgcGlwZSwgVkxWX1BMTF9EVzcocGlwZSkpOwotCWNvcmVjbGsgPSAoY29yZWNsayAm
IDB4MDAwMGZmMDApIHwgMHgwMWMwMDAwMDsKLQlpZiAoaW50ZWxfY3J0Y19oYXNfZHBfZW5jb2Rl
cihwaXBlX2NvbmZpZykpCi0JCWNvcmVjbGsgfD0gMHgwMTAwMDAwMDsKLQl2bHZfZHBpb193cml0
ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1BMTF9EVzcocGlwZSksIGNvcmVjbGspOwotCi0Jdmx2X2Rw
aW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9QTExfRFcxMShwaXBlKSwgMHg4Nzg3MTAwMCk7
Ci0KLQl2bHZfZHBpb19wdXQoZGV2X3ByaXYpOwotfQotCi1zdGF0aWMgdm9pZCBjaHZfcHJlcGFy
ZV9wbGwoc3RydWN0IGludGVsX2NydGMgKmNydGMsCi0JCQkgICAgY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQotewotCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBj
cnRjLT5iYXNlLmRldjsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGRldik7Ci0JZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwotCWVudW0gZHBpb19jaGFu
bmVsIHBvcnQgPSB2bHZfcGlwZV90b19jaGFubmVsKHBpcGUpOwotCXUzMiBsb29wZmlsdGVyLCB0
cmlidWZfY2FsY250cjsKLQl1MzIgYmVzdG4sIGJlc3RtMSwgYmVzdG0yLCBiZXN0cDEsIGJlc3Rw
MiwgYmVzdG0yX2ZyYWM7Ci0JdTMyIGRwaW9fdmFsOwotCWludCB2Y287Ci0KLQkvKiBFbmFibGUg
UmVmY2xrIGFuZCBTU0MgKi8KLQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgRFBMTChwaXBlKSwK
LQkJICAgICAgIHBpcGVfY29uZmlnLT5kcGxsX2h3X3N0YXRlLmRwbGwgJiB+RFBMTF9WQ09fRU5B
QkxFKTsKLQotCS8qIE5vIG5lZWQgdG8gYWN0dWFsbHkgc2V0IHVwIHRoZSBEUExMIHdpdGggRFNJ
ICovCi0JaWYgKChwaXBlX2NvbmZpZy0+ZHBsbF9od19zdGF0ZS5kcGxsICYgRFBMTF9WQ09fRU5B
QkxFKSA9PSAwKQotCQlyZXR1cm47Ci0KLQliZXN0biA9IHBpcGVfY29uZmlnLT5kcGxsLm47Ci0J
YmVzdG0yX2ZyYWMgPSBwaXBlX2NvbmZpZy0+ZHBsbC5tMiAmIDB4M2ZmZmZmOwotCWJlc3RtMSA9
IHBpcGVfY29uZmlnLT5kcGxsLm0xOwotCWJlc3RtMiA9IHBpcGVfY29uZmlnLT5kcGxsLm0yID4+
IDIyOwotCWJlc3RwMSA9IHBpcGVfY29uZmlnLT5kcGxsLnAxOwotCWJlc3RwMiA9IHBpcGVfY29u
ZmlnLT5kcGxsLnAyOwotCXZjbyA9IHBpcGVfY29uZmlnLT5kcGxsLnZjbzsKLQlkcGlvX3ZhbCA9
IDA7Ci0JbG9vcGZpbHRlciA9IDA7Ci0KLQl2bHZfZHBpb19nZXQoZGV2X3ByaXYpOwotCi0JLyog
cDEgYW5kIHAyIGRpdmlkZXIgKi8KLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgQ0hW
X0NNTl9EVzEzKHBvcnQpLAotCQkJNSA8PCBEUElPX0NIVl9TMV9ESVZfU0hJRlQgfAotCQkJYmVz
dHAxIDw8IERQSU9fQ0hWX1AxX0RJVl9TSElGVCB8Ci0JCQliZXN0cDIgPDwgRFBJT19DSFZfUDJf
RElWX1NISUZUIHwKLQkJCTEgPDwgRFBJT19DSFZfS19ESVZfU0hJRlQpOwotCi0JLyogRmVlZGJh
Y2sgcG9zdC1kaXZpZGVyIC0gbTIgKi8KLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwg
Q0hWX1BMTF9EVzAocG9ydCksIGJlc3RtMik7Ci0KLQkvKiBGZWVkYmFjayByZWZjbGsgZGl2aWRl
ciAtIG4gYW5kIG0xICovCi0Jdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIENIVl9QTExf
RFcxKHBvcnQpLAotCQkJRFBJT19DSFZfTTFfRElWX0JZXzIgfAotCQkJMSA8PCBEUElPX0NIVl9O
X0RJVl9TSElGVCk7Ci0KLQkvKiBNMiBmcmFjdGlvbiBkaXZpc2lvbiAqLwotCXZsdl9kcGlvX3dy
aXRlKGRldl9wcml2LCBwaXBlLCBDSFZfUExMX0RXMihwb3J0KSwgYmVzdG0yX2ZyYWMpOwotCi0J
LyogTTIgZnJhY3Rpb24gZGl2aXNpb24gZW5hYmxlICovCi0JZHBpb192YWwgPSB2bHZfZHBpb19y
ZWFkKGRldl9wcml2LCBwaXBlLCBDSFZfUExMX0RXMyhwb3J0KSk7Ci0JZHBpb192YWwgJj0gfihE
UElPX0NIVl9GRUVERldEX0dBSU5fTUFTSyB8IERQSU9fQ0hWX0ZSQUNfRElWX0VOKTsKLQlkcGlv
X3ZhbCB8PSAoMiA8PCBEUElPX0NIVl9GRUVERldEX0dBSU5fU0hJRlQpOwotCWlmIChiZXN0bTJf
ZnJhYykKLQkJZHBpb192YWwgfD0gRFBJT19DSFZfRlJBQ19ESVZfRU47Ci0Jdmx2X2RwaW9fd3Jp
dGUoZGV2X3ByaXYsIHBpcGUsIENIVl9QTExfRFczKHBvcnQpLCBkcGlvX3ZhbCk7Ci0KLQkvKiBQ
cm9ncmFtIGRpZ2l0YWwgbG9jayBkZXRlY3QgdGhyZXNob2xkICovCi0JZHBpb192YWwgPSB2bHZf
ZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBDSFZfUExMX0RXOShwb3J0KSk7Ci0JZHBpb192YWwg
Jj0gfihEUElPX0NIVl9JTlRfTE9DS19USFJFU0hPTERfTUFTSyB8Ci0JCQkJCURQSU9fQ0hWX0lO
VF9MT0NLX1RIUkVTSE9MRF9TRUxfQ09BUlNFKTsKLQlkcGlvX3ZhbCB8PSAoMHg1IDw8IERQSU9f
Q0hWX0lOVF9MT0NLX1RIUkVTSE9MRF9TSElGVCk7Ci0JaWYgKCFiZXN0bTJfZnJhYykKLQkJZHBp
b192YWwgfD0gRFBJT19DSFZfSU5UX0xPQ0tfVEhSRVNIT0xEX1NFTF9DT0FSU0U7Ci0Jdmx2X2Rw
aW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIENIVl9QTExfRFc5KHBvcnQpLCBkcGlvX3ZhbCk7Ci0K
LQkvKiBMb29wIGZpbHRlciAqLwotCWlmICh2Y28gPT0gNTQwMDAwMCkgewotCQlsb29wZmlsdGVy
IHw9ICgweDMgPDwgRFBJT19DSFZfUFJPUF9DT0VGRl9TSElGVCk7Ci0JCWxvb3BmaWx0ZXIgfD0g
KDB4OCA8PCBEUElPX0NIVl9JTlRfQ09FRkZfU0hJRlQpOwotCQlsb29wZmlsdGVyIHw9ICgweDEg
PDwgRFBJT19DSFZfR0FJTl9DVFJMX1NISUZUKTsKLQkJdHJpYnVmX2NhbGNudHIgPSAweDk7Ci0J
fSBlbHNlIGlmICh2Y28gPD0gNjIwMDAwMCkgewotCQlsb29wZmlsdGVyIHw9ICgweDUgPDwgRFBJ
T19DSFZfUFJPUF9DT0VGRl9TSElGVCk7Ci0JCWxvb3BmaWx0ZXIgfD0gKDB4QiA8PCBEUElPX0NI
Vl9JTlRfQ09FRkZfU0hJRlQpOwotCQlsb29wZmlsdGVyIHw9ICgweDMgPDwgRFBJT19DSFZfR0FJ
Tl9DVFJMX1NISUZUKTsKLQkJdHJpYnVmX2NhbGNudHIgPSAweDk7Ci0JfSBlbHNlIGlmICh2Y28g
PD0gNjQ4MDAwMCkgewotCQlsb29wZmlsdGVyIHw9ICgweDQgPDwgRFBJT19DSFZfUFJPUF9DT0VG
Rl9TSElGVCk7Ci0JCWxvb3BmaWx0ZXIgfD0gKDB4OSA8PCBEUElPX0NIVl9JTlRfQ09FRkZfU0hJ
RlQpOwotCQlsb29wZmlsdGVyIHw9ICgweDMgPDwgRFBJT19DSFZfR0FJTl9DVFJMX1NISUZUKTsK
LQkJdHJpYnVmX2NhbGNudHIgPSAweDg7Ci0JfSBlbHNlIHsKLQkJLyogTm90IHN1cHBvcnRlZC4g
QXBwbHkgdGhlIHNhbWUgbGltaXRzIGFzIGluIHRoZSBtYXggY2FzZSAqLwotCQlsb29wZmlsdGVy
IHw9ICgweDQgPDwgRFBJT19DSFZfUFJPUF9DT0VGRl9TSElGVCk7Ci0JCWxvb3BmaWx0ZXIgfD0g
KDB4OSA8PCBEUElPX0NIVl9JTlRfQ09FRkZfU0hJRlQpOwotCQlsb29wZmlsdGVyIHw9ICgweDMg
PDwgRFBJT19DSFZfR0FJTl9DVFJMX1NISUZUKTsKLQkJdHJpYnVmX2NhbGNudHIgPSAwOwotCX0K
LQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgQ0hWX1BMTF9EVzYocG9ydCksIGxvb3Bm
aWx0ZXIpOwotCi0JZHBpb192YWwgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBDSFZf
UExMX0RXOChwb3J0KSk7Ci0JZHBpb192YWwgJj0gfkRQSU9fQ0hWX1REQ19UQVJHRVRfQ05UX01B
U0s7Ci0JZHBpb192YWwgfD0gKHRyaWJ1Zl9jYWxjbnRyIDw8IERQSU9fQ0hWX1REQ19UQVJHRVRf
Q05UX1NISUZUKTsKLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgQ0hWX1BMTF9EVzgo
cG9ydCksIGRwaW9fdmFsKTsKLQotCS8qIEFGQyBSZWNhbCAqLwotCXZsdl9kcGlvX3dyaXRlKGRl
dl9wcml2LCBwaXBlLCBDSFZfQ01OX0RXMTQocG9ydCksCi0JCQl2bHZfZHBpb19yZWFkKGRldl9w
cml2LCBwaXBlLCBDSFZfQ01OX0RXMTQocG9ydCkpIHwKLQkJCURQSU9fQUZDX1JFQ0FMKTsKLQot
CXZsdl9kcGlvX3B1dChkZXZfcHJpdik7Ci19Ci0KLS8qKgotICogdmx2X2ZvcmNlX3BsbF9vbiAt
IGZvcmNpYmx5IGVuYWJsZSBqdXN0IHRoZSBQTEwKLSAqIEBkZXZfcHJpdjogaTkxNSBwcml2YXRl
IHN0cnVjdHVyZQotICogQHBpcGU6IHBpcGUgUExMIHRvIGVuYWJsZQotICogQGRwbGw6IFBMTCBj
b25maWd1cmF0aW9uCi0gKgotICogRW5hYmxlIHRoZSBQTEwgZm9yIEBwaXBlIHVzaW5nIHRoZSBz
dXBwbGllZCBAZHBsbCBjb25maWcuIFRvIGJlIHVzZWQKLSAqIGluIGNhc2VzIHdoZXJlIHdlIG5l
ZWQgdGhlIFBMTCBlbmFibGVkIGV2ZW4gd2hlbiBAcGlwZSBpcyBub3QgZ29pbmcgdG8KLSAqIGJl
IGVuYWJsZWQuCi0gKi8KLWludCB2bHZfZm9yY2VfcGxsX29uKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUsCi0JCSAgICAgY29uc3Qgc3RydWN0IGRwbGwg
KmRwbGwpCi17Ci0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3Jf
cGlwZShkZXZfcHJpdiwgcGlwZSk7Ci0Jc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29u
ZmlnOwotCi0JcGlwZV9jb25maWcgPSBpbnRlbF9jcnRjX3N0YXRlX2FsbG9jKGNydGMpOwotCWlm
ICghcGlwZV9jb25maWcpCi0JCXJldHVybiAtRU5PTUVNOwotCi0JcGlwZV9jb25maWctPmNwdV90
cmFuc2NvZGVyID0gKGVudW0gdHJhbnNjb2RlcilwaXBlOwotCXBpcGVfY29uZmlnLT5waXhlbF9t
dWx0aXBsaWVyID0gMTsKLQlwaXBlX2NvbmZpZy0+ZHBsbCA9ICpkcGxsOwotCi0JaWYgKElTX0NI
RVJSWVZJRVcoZGV2X3ByaXYpKSB7Ci0JCWNodl9jb21wdXRlX2RwbGwoY3J0YywgcGlwZV9jb25m
aWcpOwotCQljaHZfcHJlcGFyZV9wbGwoY3J0YywgcGlwZV9jb25maWcpOwotCQljaHZfZW5hYmxl
X3BsbChjcnRjLCBwaXBlX2NvbmZpZyk7Ci0JfSBlbHNlIHsKLQkJdmx2X2NvbXB1dGVfZHBsbChj
cnRjLCBwaXBlX2NvbmZpZyk7Ci0JCXZsdl9wcmVwYXJlX3BsbChjcnRjLCBwaXBlX2NvbmZpZyk7
Ci0JCXZsdl9lbmFibGVfcGxsKGNydGMsIHBpcGVfY29uZmlnKTsKLQl9Ci0KLQlrZnJlZShwaXBl
X2NvbmZpZyk7Ci0KLQlyZXR1cm4gMDsKLX0KLQotLyoqCi0gKiB2bHZfZm9yY2VfcGxsX29mZiAt
IGZvcmNpYmx5IGRpc2FibGUganVzdCB0aGUgUExMCi0gKiBAZGV2X3ByaXY6IGk5MTUgcHJpdmF0
ZSBzdHJ1Y3R1cmUKLSAqIEBwaXBlOiBwaXBlIFBMTCB0byBkaXNhYmxlCi0gKgotICogRGlzYWJs
ZSB0aGUgUExMIGZvciBAcGlwZS4gVG8gYmUgdXNlZCBpbiBjYXNlcyB3aGVyZSB3ZSBuZWVkCi0g
KiB0aGUgUExMIGVuYWJsZWQgZXZlbiB3aGVuIEBwaXBlIGlzIG5vdCBnb2luZyB0byBiZSBlbmFi
bGVkLgotICovCi12b2lkIHZsdl9mb3JjZV9wbGxfb2ZmKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUpCi17Ci0JaWYgKElTX0NIRVJSWVZJRVcoZGV2X3By
aXYpKQotCQljaHZfZGlzYWJsZV9wbGwoZGV2X3ByaXYsIHBpcGUpOwotCWVsc2UKLQkJdmx2X2Rp
c2FibGVfcGxsKGRldl9wcml2LCBwaXBlKTsKLX0KLQotCi0KIHN0YXRpYyB2b2lkIGludGVsX3Nl
dF90cmFuc2NvZGVyX3RpbWluZ3MoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUpCiB7CiAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPnVhcGkuY3J0Yyk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2Rpc3BsYXkuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZGlzcGxheS5oCmluZGV4IGMxNzZjMzFjM2VjMi4uMWUwNTA4YmVjM2U1IDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuaAorKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuaApAQCAtNTg1LDkgKzU4NSw2IEBA
IHZvaWQgaW50ZWxfY2xlYW51cF9wbGFuZV9mYihzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKIHZv
aWQgYXNzZXJ0X3BjaF90cmFuc2NvZGVyX2Rpc2FibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKIAkJCQkgICAgZW51bSBwaXBlIHBpcGUpOwogCi1pbnQgdmx2X2ZvcmNlX3Bs
bF9vbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlwZSBwaXBlLAot
CQkgICAgIGNvbnN0IHN0cnVjdCBkcGxsICpkcGxsKTsKLXZvaWQgdmx2X2ZvcmNlX3BsbF9vZmYo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUgcGlwZSk7CiBpbnQg
bHB0X2dldF9pY2xraXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKIGJvb2wg
aW50ZWxfZnV6enlfY2xvY2tfY2hlY2soaW50IGNsb2NrMSwgaW50IGNsb2NrMik7CiAKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHAuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHAuYwppbmRleCBhMzM4NzIwY2VlMmUuLjE5NTg1
NzI4NTYwMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9k
cC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHAuYwpAQCAtNTAs
NiArNTAsNyBAQAogI2luY2x1ZGUgImludGVsX2RwX2F1eC5oIgogI2luY2x1ZGUgImludGVsX2Rw
X2xpbmtfdHJhaW5pbmcuaCIKICNpbmNsdWRlICJpbnRlbF9kcF9tc3QuaCIKKyNpbmNsdWRlICJp
bnRlbF9kcGxsLmgiCiAjaW5jbHVkZSAiaW50ZWxfZHBpb19waHkuaCIKICNpbmNsdWRlICJpbnRl
bF9maWZvX3VuZGVycnVuLmgiCiAjaW5jbHVkZSAiaW50ZWxfaGRjcC5oIgpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcGxsLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwbGwuYwppbmRleCA3YmE3ZjMxNWFhZWUuLjE2NmU5YTNh
OGMwOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcGxs
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcGxsLmMKQEAgLTMs
MTEgKzMsMTMgQEAKICAqIENvcHlyaWdodCDCqSAyMDIwIEludGVsIENvcnBvcmF0aW9uCiAgKi8K
ICNpbmNsdWRlIDxsaW51eC9rZXJuZWwuaD4KKyNpbmNsdWRlICJpbnRlbF9jcnRjLmgiCiAjaW5j
bHVkZSAiaW50ZWxfZGlzcGxheV90eXBlcy5oIgogI2luY2x1ZGUgImludGVsX2Rpc3BsYXkuaCIK
ICNpbmNsdWRlICJpbnRlbF9kcGxsLmgiCiAjaW5jbHVkZSAiaW50ZWxfbHZkcy5oIgogI2luY2x1
ZGUgImludGVsX3BhbmVsLmgiCisjaW5jbHVkZSAiaW50ZWxfc2lkZWJhbmQuaCIKIAogc3RydWN0
IGludGVsX2xpbWl0IHsKIAlzdHJ1Y3QgewpAQCAtMTM2MSwzICsxMzYzLDUxMCBAQCBpbnRlbF9k
cGxsX2luaXRfY2xvY2tfaG9vayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJ
ZWxzZQogCQlkZXZfcHJpdi0+ZGlzcGxheS5jcnRjX2NvbXB1dGVfY2xvY2sgPSBpOHh4X2NydGNf
Y29tcHV0ZV9jbG9jazsKIH0KKworc3RhdGljIGJvb2wgaTl4eF9oYXNfcHBzKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKK3sKKwlpZiAoSVNfSTgzMChkZXZfcHJpdikpCisJCXJl
dHVybiBmYWxzZTsKKworCXJldHVybiBJU19QSU5FVklFVyhkZXZfcHJpdikgfHwgSVNfTU9CSUxF
KGRldl9wcml2KTsKK30KKwordm9pZCBpOXh4X2VuYWJsZV9wbGwoc3RydWN0IGludGVsX2NydGMg
KmNydGMsCisJCSAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUp
Cit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5i
YXNlLmRldik7CisJaTkxNV9yZWdfdCByZWcgPSBEUExMKGNydGMtPnBpcGUpOworCXUzMiBkcGxs
ID0gY3J0Y19zdGF0ZS0+ZHBsbF9od19zdGF0ZS5kcGxsOworCWludCBpOworCisJYXNzZXJ0X3Bp
cGVfZGlzYWJsZWQoZGV2X3ByaXYsIGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyKTsKKworCS8q
IFBMTCBpcyBwcm90ZWN0ZWQgYnkgcGFuZWwsIG1ha2Ugc3VyZSB3ZSBjYW4gd3JpdGUgaXQgKi8K
KwlpZiAoaTl4eF9oYXNfcHBzKGRldl9wcml2KSkKKwkJYXNzZXJ0X3BhbmVsX3VubG9ja2VkKGRl
dl9wcml2LCBjcnRjLT5waXBlKTsKKworCS8qCisJICogQXBwYXJlbnRseSB3ZSBuZWVkIHRvIGhh
dmUgVkdBIG1vZGUgZW5hYmxlZCBwcmlvciB0byBjaGFuZ2luZworCSAqIHRoZSBQMS9QMiBkaXZp
ZGVycy4gT3RoZXJ3aXNlIHRoZSBEUExMIHdpbGwga2VlcCB1c2luZyB0aGUgb2xkCisJICogZGl2
aWRlcnMsIGV2ZW4gdGhvdWdoIHRoZSByZWdpc3RlciB2YWx1ZSBkb2VzIGNoYW5nZS4KKwkgKi8K
KwlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgcmVnLCBkcGxsICYgfkRQTExfVkdBX01PREVfRElT
KTsKKwlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgcmVnLCBkcGxsKTsKKworCS8qIFdhaXQgZm9y
IHRoZSBjbG9ja3MgdG8gc3RhYmlsaXplLiAqLworCWludGVsX2RlX3Bvc3RpbmdfcmVhZChkZXZf
cHJpdiwgcmVnKTsKKwl1ZGVsYXkoMTUwKTsKKworCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDQpIHsKKwkJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIERQTExfTUQoY3J0Yy0+cGlwZSksCisJ
CQkgICAgICAgY3J0Y19zdGF0ZS0+ZHBsbF9od19zdGF0ZS5kcGxsX21kKTsKKwl9IGVsc2Ugewor
CQkvKiBUaGUgcGl4ZWwgbXVsdGlwbGllciBjYW4gb25seSBiZSB1cGRhdGVkIG9uY2UgdGhlCisJ
CSAqIERQTEwgaXMgZW5hYmxlZCBhbmQgdGhlIGNsb2NrcyBhcmUgc3RhYmxlLgorCQkgKgorCQkg
KiBTbyB3cml0ZSBpdCBhZ2Fpbi4KKwkJICovCisJCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBy
ZWcsIGRwbGwpOworCX0KKworCS8qIFdlIGRvIHRoaXMgdGhyZWUgdGltZXMgZm9yIGx1Y2sgKi8K
Kwlmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKSB7CisJCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBy
ZWcsIGRwbGwpOworCQlpbnRlbF9kZV9wb3N0aW5nX3JlYWQoZGV2X3ByaXYsIHJlZyk7CisJCXVk
ZWxheSgxNTApOyAvKiB3YWl0IGZvciB3YXJtdXAgKi8KKwl9Cit9CisKK3N0YXRpYyB2b2lkIHZs
dl9wbGxiX3JlY2FsX29wYW1wKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKKwkJ
CQkgZW51bSBwaXBlIHBpcGUpCit7CisJdTMyIHJlZ192YWw7CisKKwkvKgorCSAqIFBMTEIgb3Bh
bXAgYWx3YXlzIGNhbGlicmF0ZXMgdG8gbWF4IHZhbHVlIG9mIDB4M2YsIGZvcmNlIGVuYWJsZSBp
dAorCSAqIGFuZCBzZXQgaXQgdG8gYSByZWFzb25hYmxlIHZhbHVlIGluc3RlYWQuCisJICovCisJ
cmVnX3ZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIFZMVl9QTExfRFc5KDEpKTsK
KwlyZWdfdmFsICY9IDB4ZmZmZmZmMDA7CisJcmVnX3ZhbCB8PSAweDAwMDAwMDMwOworCXZsdl9k
cGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUExMX0RXOSgxKSwgcmVnX3ZhbCk7CisKKwly
ZWdfdmFsID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgVkxWX1JFRl9EVzEzKTsKKwly
ZWdfdmFsICY9IDB4MDBmZmZmZmY7CisJcmVnX3ZhbCB8PSAweDhjMDAwMDAwOworCXZsdl9kcGlv
X3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUkVGX0RXMTMsIHJlZ192YWwpOworCisJcmVnX3Zh
bCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIFZMVl9QTExfRFc5KDEpKTsKKwlyZWdf
dmFsICY9IDB4ZmZmZmZmMDA7CisJdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9Q
TExfRFc5KDEpLCByZWdfdmFsKTsKKworCXJlZ192YWwgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2
LCBwaXBlLCBWTFZfUkVGX0RXMTMpOworCXJlZ192YWwgJj0gMHgwMGZmZmZmZjsKKwlyZWdfdmFs
IHw9IDB4YjAwMDAwMDA7CisJdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9SRUZf
RFcxMywgcmVnX3ZhbCk7Cit9CisKK3N0YXRpYyB2b2lkIF92bHZfZW5hYmxlX3BsbChzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YywKKwkJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
cGlwZV9jb25maWcpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShjcnRjLT5iYXNlLmRldik7CisJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOworCisJ
aW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIERQTEwocGlwZSksIHBpcGVfY29uZmlnLT5kcGxsX2h3
X3N0YXRlLmRwbGwpOworCWludGVsX2RlX3Bvc3RpbmdfcmVhZChkZXZfcHJpdiwgRFBMTChwaXBl
KSk7CisJdWRlbGF5KDE1MCk7CisKKwlpZiAoaW50ZWxfZGVfd2FpdF9mb3Jfc2V0KGRldl9wcml2
LCBEUExMKHBpcGUpLCBEUExMX0xPQ0tfVkxWLCAxKSkKKwkJZHJtX2VycigmZGV2X3ByaXYtPmRy
bSwgIkRQTEwgJWQgZmFpbGVkIHRvIGxvY2tcbiIsIHBpcGUpOworfQorCit2b2lkIHZsdl9lbmFi
bGVfcGxsKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAorCQkgICAgY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOworCWVudW0gcGlwZSBwaXBlID0gY3J0
Yy0+cGlwZTsKKworCWFzc2VydF9waXBlX2Rpc2FibGVkKGRldl9wcml2LCBwaXBlX2NvbmZpZy0+
Y3B1X3RyYW5zY29kZXIpOworCisJLyogUExMIGlzIHByb3RlY3RlZCBieSBwYW5lbCwgbWFrZSBz
dXJlIHdlIGNhbiB3cml0ZSBpdCAqLworCWFzc2VydF9wYW5lbF91bmxvY2tlZChkZXZfcHJpdiwg
cGlwZSk7CisKKwlpZiAocGlwZV9jb25maWctPmRwbGxfaHdfc3RhdGUuZHBsbCAmIERQTExfVkNP
X0VOQUJMRSkKKwkJX3Zsdl9lbmFibGVfcGxsKGNydGMsIHBpcGVfY29uZmlnKTsKKworCWludGVs
X2RlX3dyaXRlKGRldl9wcml2LCBEUExMX01EKHBpcGUpLAorCQkgICAgICAgcGlwZV9jb25maWct
PmRwbGxfaHdfc3RhdGUuZHBsbF9tZCk7CisJaW50ZWxfZGVfcG9zdGluZ19yZWFkKGRldl9wcml2
LCBEUExMX01EKHBpcGUpKTsKK30KKworCitzdGF0aWMgdm9pZCBfY2h2X2VuYWJsZV9wbGwoc3Ry
dWN0IGludGVsX2NydGMgKmNydGMsCisJCQkgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKnBpcGVfY29uZmlnKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOworCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsK
KwllbnVtIGRwaW9fY2hhbm5lbCBwb3J0ID0gdmx2X3BpcGVfdG9fY2hhbm5lbChwaXBlKTsKKwl1
MzIgdG1wOworCisJdmx2X2RwaW9fZ2V0KGRldl9wcml2KTsKKworCS8qIEVuYWJsZSBiYWNrIHRo
ZSAxMGJpdCBjbG9jayB0byBkaXNwbGF5IGNvbnRyb2xsZXIgKi8KKwl0bXAgPSB2bHZfZHBpb19y
ZWFkKGRldl9wcml2LCBwaXBlLCBDSFZfQ01OX0RXMTQocG9ydCkpOworCXRtcCB8PSBEUElPX0RD
TEtQX0VOOworCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBDSFZfQ01OX0RXMTQocG9y
dCksIHRtcCk7CisKKwl2bHZfZHBpb19wdXQoZGV2X3ByaXYpOworCisJLyoKKwkgKiBOZWVkIHRv
IHdhaXQgPiAxMDBucyBiZXR3ZWVuIGRjbGtwIGNsb2NrIGVuYWJsZSBiaXQgYW5kIFBMTCBlbmFi
bGUuCisJICovCisJdWRlbGF5KDEpOworCisJLyogRW5hYmxlIFBMTCAqLworCWludGVsX2RlX3dy
aXRlKGRldl9wcml2LCBEUExMKHBpcGUpLCBwaXBlX2NvbmZpZy0+ZHBsbF9od19zdGF0ZS5kcGxs
KTsKKworCS8qIENoZWNrIFBMTCBpcyBsb2NrZWQgKi8KKwlpZiAoaW50ZWxfZGVfd2FpdF9mb3Jf
c2V0KGRldl9wcml2LCBEUExMKHBpcGUpLCBEUExMX0xPQ0tfVkxWLCAxKSkKKwkJZHJtX2Vycigm
ZGV2X3ByaXYtPmRybSwgIlBMTCAlZCBmYWlsZWQgdG8gbG9ja1xuIiwgcGlwZSk7Cit9CisKK3Zv
aWQgY2h2X2VuYWJsZV9wbGwoc3RydWN0IGludGVsX2NydGMgKmNydGMsCisJCSAgICBjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCit7CisJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7CisJZW51bSBwaXBl
IHBpcGUgPSBjcnRjLT5waXBlOworCisJYXNzZXJ0X3BpcGVfZGlzYWJsZWQoZGV2X3ByaXYsIHBp
cGVfY29uZmlnLT5jcHVfdHJhbnNjb2Rlcik7CisKKwkvKiBQTEwgaXMgcHJvdGVjdGVkIGJ5IHBh
bmVsLCBtYWtlIHN1cmUgd2UgY2FuIHdyaXRlIGl0ICovCisJYXNzZXJ0X3BhbmVsX3VubG9ja2Vk
KGRldl9wcml2LCBwaXBlKTsKKworCWlmIChwaXBlX2NvbmZpZy0+ZHBsbF9od19zdGF0ZS5kcGxs
ICYgRFBMTF9WQ09fRU5BQkxFKQorCQlfY2h2X2VuYWJsZV9wbGwoY3J0YywgcGlwZV9jb25maWcp
OworCisJaWYgKHBpcGUgIT0gUElQRV9BKSB7CisJCS8qCisJCSAqIFdhUGl4ZWxSZXBlYXRNb2Rl
Rml4Rm9yQzA6Y2h2CisJCSAqCisJCSAqIERQTExDTUQgaXMgQVdPTC4gVXNlIGNoaWNrZW4gYml0
cyB0byBwcm9wYWdhdGUKKwkJICogdGhlIHZhbHVlIGZyb20gRFBMTEJNRCB0byBlaXRoZXIgcGlw
ZSBCIG9yIEMuCisJCSAqLworCQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgQ0JSNF9WTFYsIENC
Ul9EUExMQk1EX1BJUEUocGlwZSkpOworCQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgRFBMTF9N
RChQSVBFX0IpLAorCQkJICAgICAgIHBpcGVfY29uZmlnLT5kcGxsX2h3X3N0YXRlLmRwbGxfbWQp
OworCQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgQ0JSNF9WTFYsIDApOworCQlkZXZfcHJpdi0+
Y2h2X2RwbGxfbWRbcGlwZV0gPSBwaXBlX2NvbmZpZy0+ZHBsbF9od19zdGF0ZS5kcGxsX21kOwor
CisJCS8qCisJCSAqIERQTExCIFZHQSBtb2RlIGFsc28gc2VlbXMgdG8gY2F1c2UgcHJvYmxlbXMu
CisJCSAqIFdlIHNob3VsZCBhbHdheXMgaGF2ZSBpdCBkaXNhYmxlZC4KKwkJICovCisJCWRybV9X
QVJOX09OKCZkZXZfcHJpdi0+ZHJtLAorCQkJICAgIChpbnRlbF9kZV9yZWFkKGRldl9wcml2LCBE
UExMKFBJUEVfQikpICYKKwkJCSAgICAgRFBMTF9WR0FfTU9ERV9ESVMpID09IDApOworCX0gZWxz
ZSB7CisJCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBEUExMX01EKHBpcGUpLAorCQkJICAgICAg
IHBpcGVfY29uZmlnLT5kcGxsX2h3X3N0YXRlLmRwbGxfbWQpOworCQlpbnRlbF9kZV9wb3N0aW5n
X3JlYWQoZGV2X3ByaXYsIERQTExfTUQocGlwZSkpOworCX0KK30KKwordm9pZCB2bHZfcHJlcGFy
ZV9wbGwoc3RydWN0IGludGVsX2NydGMgKmNydGMsCisJCSAgICAgY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQoreworCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBj
cnRjLT5iYXNlLmRldjsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGRldik7CisJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOworCXUzMiBtZGl2OworCXUz
MiBiZXN0biwgYmVzdG0xLCBiZXN0bTIsIGJlc3RwMSwgYmVzdHAyOworCXUzMiBjb3JlY2xrLCBy
ZWdfdmFsOworCisJLyogRW5hYmxlIFJlZmNsayAqLworCWludGVsX2RlX3dyaXRlKGRldl9wcml2
LCBEUExMKHBpcGUpLAorCQkgICAgICAgcGlwZV9jb25maWctPmRwbGxfaHdfc3RhdGUuZHBsbCAm
IH4oRFBMTF9WQ09fRU5BQkxFIHwgRFBMTF9FWFRfQlVGRkVSX0VOQUJMRV9WTFYpKTsKKworCS8q
IE5vIG5lZWQgdG8gYWN0dWFsbHkgc2V0IHVwIHRoZSBEUExMIHdpdGggRFNJICovCisJaWYgKChw
aXBlX2NvbmZpZy0+ZHBsbF9od19zdGF0ZS5kcGxsICYgRFBMTF9WQ09fRU5BQkxFKSA9PSAwKQor
CQlyZXR1cm47CisKKwl2bHZfZHBpb19nZXQoZGV2X3ByaXYpOworCisJYmVzdG4gPSBwaXBlX2Nv
bmZpZy0+ZHBsbC5uOworCWJlc3RtMSA9IHBpcGVfY29uZmlnLT5kcGxsLm0xOworCWJlc3RtMiA9
IHBpcGVfY29uZmlnLT5kcGxsLm0yOworCWJlc3RwMSA9IHBpcGVfY29uZmlnLT5kcGxsLnAxOwor
CWJlc3RwMiA9IHBpcGVfY29uZmlnLT5kcGxsLnAyOworCisJLyogU2VlIGVEUCBIRE1JIERQSU8g
ZHJpdmVyIHZiaW9zIG5vdGVzIGRvYyAqLworCisJLyogUExMIEIgbmVlZHMgc3BlY2lhbCBoYW5k
bGluZyAqLworCWlmIChwaXBlID09IFBJUEVfQikKKwkJdmx2X3BsbGJfcmVjYWxfb3BhbXAoZGV2
X3ByaXYsIHBpcGUpOworCisJLyogU2V0IHVwIFR4IHRhcmdldCBmb3IgcGVyaW9kaWMgUmNvbXAg
dXBkYXRlICovCisJdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9QTExfRFc5X0JD
QVNULCAweDAxMDAwMDBmKTsKKworCS8qIERpc2FibGUgdGFyZ2V0IElSZWYgb24gUExMICovCisJ
cmVnX3ZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIFZMVl9QTExfRFc4KHBpcGUp
KTsKKwlyZWdfdmFsICY9IDB4MDBmZmZmZmY7CisJdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBp
cGUsIFZMVl9QTExfRFc4KHBpcGUpLCByZWdfdmFsKTsKKworCS8qIERpc2FibGUgZmFzdCBsb2Nr
ICovCisJdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9DTU5fRFcwLCAweDYxMCk7
CisKKwkvKiBTZXQgaWR0YWZjcmVjYWwgYmVmb3JlIFBMTCBpcyBlbmFibGVkICovCisJbWRpdiA9
ICgoYmVzdG0xIDw8IERQSU9fTTFESVZfU0hJRlQpIHwgKGJlc3RtMiAmIERQSU9fTTJESVZfTUFT
SykpOworCW1kaXYgfD0gKChiZXN0cDEgPDwgRFBJT19QMV9TSElGVCkgfCAoYmVzdHAyIDw8IERQ
SU9fUDJfU0hJRlQpKTsKKwltZGl2IHw9ICgoYmVzdG4gPDwgRFBJT19OX1NISUZUKSk7CisJbWRp
diB8PSAoMSA8PCBEUElPX0tfU0hJRlQpOworCisJLyoKKwkgKiBQb3N0IGRpdmlkZXIgZGVwZW5k
cyBvbiBwaXhlbCBjbG9jayByYXRlLCBEQUMgdnMgZGlnaXRhbCAoYW5kIExWRFMsCisJICogYnV0
IHdlIGRvbid0IHN1cHBvcnQgdGhhdCkuCisJICogTm90ZTogZG9uJ3QgdXNlIHRoZSBEQUMgcG9z
dCBkaXZpZGVyIGFzIGl0IHNlZW1zIHVuc3RhYmxlLgorCSAqLworCW1kaXYgfD0gKERQSU9fUE9T
VF9ESVZfSERNSURQIDw8IERQSU9fUE9TVF9ESVZfU0hJRlQpOworCXZsdl9kcGlvX3dyaXRlKGRl
dl9wcml2LCBwaXBlLCBWTFZfUExMX0RXMyhwaXBlKSwgbWRpdik7CisKKwltZGl2IHw9IERQSU9f
RU5BQkxFX0NBTElCUkFUSU9OOworCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZf
UExMX0RXMyhwaXBlKSwgbWRpdik7CisKKwkvKiBTZXQgSEJSIGFuZCBSQlIgTFBGIGNvZWZmaWNp
ZW50cyAqLworCWlmIChwaXBlX2NvbmZpZy0+cG9ydF9jbG9jayA9PSAxNjIwMDAgfHwKKwkgICAg
aW50ZWxfY3J0Y19oYXNfdHlwZShwaXBlX2NvbmZpZywgSU5URUxfT1VUUFVUX0FOQUxPRykgfHwK
KwkgICAgaW50ZWxfY3J0Y19oYXNfdHlwZShwaXBlX2NvbmZpZywgSU5URUxfT1VUUFVUX0hETUkp
KQorCQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1BMTF9EVzEwKHBpcGUpLAor
CQkJCSAweDAwOWYwMDAzKTsKKwllbHNlCisJCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBl
LCBWTFZfUExMX0RXMTAocGlwZSksCisJCQkJIDB4MDBkMDAwMGYpOworCisJaWYgKGludGVsX2Ny
dGNfaGFzX2RwX2VuY29kZXIocGlwZV9jb25maWcpKSB7CisJCS8qIFVzZSBTU0Mgc291cmNlICov
CisJCWlmIChwaXBlID09IFBJUEVfQSkKKwkJCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBl
LCBWTFZfUExMX0RXNShwaXBlKSwKKwkJCQkJIDB4MGRmNDAwMDApOworCQllbHNlCisJCQl2bHZf
ZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1BMTF9EVzUocGlwZSksCisJCQkJCSAweDBk
ZjcwMDAwKTsKKwl9IGVsc2UgeyAvKiBIRE1JIG9yIFZHQSAqLworCQkvKiBVc2UgYmVuZCBzb3Vy
Y2UgKi8KKwkJaWYgKHBpcGUgPT0gUElQRV9BKQorCQkJdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYs
IHBpcGUsIFZMVl9QTExfRFc1KHBpcGUpLAorCQkJCQkgMHgwZGY3MDAwMCk7CisJCWVsc2UKKwkJ
CXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUExMX0RXNShwaXBlKSwKKwkJCQkJ
IDB4MGRmNDAwMDApOworCX0KKworCWNvcmVjbGsgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBw
aXBlLCBWTFZfUExMX0RXNyhwaXBlKSk7CisJY29yZWNsayA9IChjb3JlY2xrICYgMHgwMDAwZmYw
MCkgfCAweDAxYzAwMDAwOworCWlmIChpbnRlbF9jcnRjX2hhc19kcF9lbmNvZGVyKHBpcGVfY29u
ZmlnKSkKKwkJY29yZWNsayB8PSAweDAxMDAwMDAwOworCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2
LCBwaXBlLCBWTFZfUExMX0RXNyhwaXBlKSwgY29yZWNsayk7CisKKwl2bHZfZHBpb193cml0ZShk
ZXZfcHJpdiwgcGlwZSwgVkxWX1BMTF9EVzExKHBpcGUpLCAweDg3ODcxMDAwKTsKKworCXZsdl9k
cGlvX3B1dChkZXZfcHJpdik7Cit9CisKK3ZvaWQgY2h2X3ByZXBhcmVfcGxsKHN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjLAorCQkgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBl
X2NvbmZpZykKK3sKKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7CisJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOworCWVudW0g
cGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKKwllbnVtIGRwaW9fY2hhbm5lbCBwb3J0ID0gdmx2X3Bp
cGVfdG9fY2hhbm5lbChwaXBlKTsKKwl1MzIgbG9vcGZpbHRlciwgdHJpYnVmX2NhbGNudHI7CisJ
dTMyIGJlc3RuLCBiZXN0bTEsIGJlc3RtMiwgYmVzdHAxLCBiZXN0cDIsIGJlc3RtMl9mcmFjOwor
CXUzMiBkcGlvX3ZhbDsKKwlpbnQgdmNvOworCisJLyogRW5hYmxlIFJlZmNsayBhbmQgU1NDICov
CisJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIERQTEwocGlwZSksCisJCSAgICAgICBwaXBlX2Nv
bmZpZy0+ZHBsbF9od19zdGF0ZS5kcGxsICYgfkRQTExfVkNPX0VOQUJMRSk7CisKKwkvKiBObyBu
ZWVkIHRvIGFjdHVhbGx5IHNldCB1cCB0aGUgRFBMTCB3aXRoIERTSSAqLworCWlmICgocGlwZV9j
b25maWctPmRwbGxfaHdfc3RhdGUuZHBsbCAmIERQTExfVkNPX0VOQUJMRSkgPT0gMCkKKwkJcmV0
dXJuOworCisJYmVzdG4gPSBwaXBlX2NvbmZpZy0+ZHBsbC5uOworCWJlc3RtMl9mcmFjID0gcGlw
ZV9jb25maWctPmRwbGwubTIgJiAweDNmZmZmZjsKKwliZXN0bTEgPSBwaXBlX2NvbmZpZy0+ZHBs
bC5tMTsKKwliZXN0bTIgPSBwaXBlX2NvbmZpZy0+ZHBsbC5tMiA+PiAyMjsKKwliZXN0cDEgPSBw
aXBlX2NvbmZpZy0+ZHBsbC5wMTsKKwliZXN0cDIgPSBwaXBlX2NvbmZpZy0+ZHBsbC5wMjsKKwl2
Y28gPSBwaXBlX2NvbmZpZy0+ZHBsbC52Y287CisJZHBpb192YWwgPSAwOworCWxvb3BmaWx0ZXIg
PSAwOworCisJdmx2X2RwaW9fZ2V0KGRldl9wcml2KTsKKworCS8qIHAxIGFuZCBwMiBkaXZpZGVy
ICovCisJdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIENIVl9DTU5fRFcxMyhwb3J0KSwK
KwkJCTUgPDwgRFBJT19DSFZfUzFfRElWX1NISUZUIHwKKwkJCWJlc3RwMSA8PCBEUElPX0NIVl9Q
MV9ESVZfU0hJRlQgfAorCQkJYmVzdHAyIDw8IERQSU9fQ0hWX1AyX0RJVl9TSElGVCB8CisJCQkx
IDw8IERQSU9fQ0hWX0tfRElWX1NISUZUKTsKKworCS8qIEZlZWRiYWNrIHBvc3QtZGl2aWRlciAt
IG0yICovCisJdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIENIVl9QTExfRFcwKHBvcnQp
LCBiZXN0bTIpOworCisJLyogRmVlZGJhY2sgcmVmY2xrIGRpdmlkZXIgLSBuIGFuZCBtMSAqLwor
CXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBDSFZfUExMX0RXMShwb3J0KSwKKwkJCURQ
SU9fQ0hWX00xX0RJVl9CWV8yIHwKKwkJCTEgPDwgRFBJT19DSFZfTl9ESVZfU0hJRlQpOworCisJ
LyogTTIgZnJhY3Rpb24gZGl2aXNpb24gKi8KKwl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlw
ZSwgQ0hWX1BMTF9EVzIocG9ydCksIGJlc3RtMl9mcmFjKTsKKworCS8qIE0yIGZyYWN0aW9uIGRp
dmlzaW9uIGVuYWJsZSAqLworCWRwaW9fdmFsID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlw
ZSwgQ0hWX1BMTF9EVzMocG9ydCkpOworCWRwaW9fdmFsICY9IH4oRFBJT19DSFZfRkVFREZXRF9H
QUlOX01BU0sgfCBEUElPX0NIVl9GUkFDX0RJVl9FTik7CisJZHBpb192YWwgfD0gKDIgPDwgRFBJ
T19DSFZfRkVFREZXRF9HQUlOX1NISUZUKTsKKwlpZiAoYmVzdG0yX2ZyYWMpCisJCWRwaW9fdmFs
IHw9IERQSU9fQ0hWX0ZSQUNfRElWX0VOOworCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBl
LCBDSFZfUExMX0RXMyhwb3J0KSwgZHBpb192YWwpOworCisJLyogUHJvZ3JhbSBkaWdpdGFsIGxv
Y2sgZGV0ZWN0IHRocmVzaG9sZCAqLworCWRwaW9fdmFsID0gdmx2X2RwaW9fcmVhZChkZXZfcHJp
diwgcGlwZSwgQ0hWX1BMTF9EVzkocG9ydCkpOworCWRwaW9fdmFsICY9IH4oRFBJT19DSFZfSU5U
X0xPQ0tfVEhSRVNIT0xEX01BU0sgfAorCQkJCQlEUElPX0NIVl9JTlRfTE9DS19USFJFU0hPTERf
U0VMX0NPQVJTRSk7CisJZHBpb192YWwgfD0gKDB4NSA8PCBEUElPX0NIVl9JTlRfTE9DS19USFJF
U0hPTERfU0hJRlQpOworCWlmICghYmVzdG0yX2ZyYWMpCisJCWRwaW9fdmFsIHw9IERQSU9fQ0hW
X0lOVF9MT0NLX1RIUkVTSE9MRF9TRUxfQ09BUlNFOworCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2
LCBwaXBlLCBDSFZfUExMX0RXOShwb3J0KSwgZHBpb192YWwpOworCisJLyogTG9vcCBmaWx0ZXIg
Ki8KKwlpZiAodmNvID09IDU0MDAwMDApIHsKKwkJbG9vcGZpbHRlciB8PSAoMHgzIDw8IERQSU9f
Q0hWX1BST1BfQ09FRkZfU0hJRlQpOworCQlsb29wZmlsdGVyIHw9ICgweDggPDwgRFBJT19DSFZf
SU5UX0NPRUZGX1NISUZUKTsKKwkJbG9vcGZpbHRlciB8PSAoMHgxIDw8IERQSU9fQ0hWX0dBSU5f
Q1RSTF9TSElGVCk7CisJCXRyaWJ1Zl9jYWxjbnRyID0gMHg5OworCX0gZWxzZSBpZiAodmNvIDw9
IDYyMDAwMDApIHsKKwkJbG9vcGZpbHRlciB8PSAoMHg1IDw8IERQSU9fQ0hWX1BST1BfQ09FRkZf
U0hJRlQpOworCQlsb29wZmlsdGVyIHw9ICgweEIgPDwgRFBJT19DSFZfSU5UX0NPRUZGX1NISUZU
KTsKKwkJbG9vcGZpbHRlciB8PSAoMHgzIDw8IERQSU9fQ0hWX0dBSU5fQ1RSTF9TSElGVCk7CisJ
CXRyaWJ1Zl9jYWxjbnRyID0gMHg5OworCX0gZWxzZSBpZiAodmNvIDw9IDY0ODAwMDApIHsKKwkJ
bG9vcGZpbHRlciB8PSAoMHg0IDw8IERQSU9fQ0hWX1BST1BfQ09FRkZfU0hJRlQpOworCQlsb29w
ZmlsdGVyIHw9ICgweDkgPDwgRFBJT19DSFZfSU5UX0NPRUZGX1NISUZUKTsKKwkJbG9vcGZpbHRl
ciB8PSAoMHgzIDw8IERQSU9fQ0hWX0dBSU5fQ1RSTF9TSElGVCk7CisJCXRyaWJ1Zl9jYWxjbnRy
ID0gMHg4OworCX0gZWxzZSB7CisJCS8qIE5vdCBzdXBwb3J0ZWQuIEFwcGx5IHRoZSBzYW1lIGxp
bWl0cyBhcyBpbiB0aGUgbWF4IGNhc2UgKi8KKwkJbG9vcGZpbHRlciB8PSAoMHg0IDw8IERQSU9f
Q0hWX1BST1BfQ09FRkZfU0hJRlQpOworCQlsb29wZmlsdGVyIHw9ICgweDkgPDwgRFBJT19DSFZf
SU5UX0NPRUZGX1NISUZUKTsKKwkJbG9vcGZpbHRlciB8PSAoMHgzIDw8IERQSU9fQ0hWX0dBSU5f
Q1RSTF9TSElGVCk7CisJCXRyaWJ1Zl9jYWxjbnRyID0gMDsKKwl9CisJdmx2X2RwaW9fd3JpdGUo
ZGV2X3ByaXYsIHBpcGUsIENIVl9QTExfRFc2KHBvcnQpLCBsb29wZmlsdGVyKTsKKworCWRwaW9f
dmFsID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgQ0hWX1BMTF9EVzgocG9ydCkpOwor
CWRwaW9fdmFsICY9IH5EUElPX0NIVl9URENfVEFSR0VUX0NOVF9NQVNLOworCWRwaW9fdmFsIHw9
ICh0cmlidWZfY2FsY250ciA8PCBEUElPX0NIVl9URENfVEFSR0VUX0NOVF9TSElGVCk7CisJdmx2
X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIENIVl9QTExfRFc4KHBvcnQpLCBkcGlvX3ZhbCk7
CisKKwkvKiBBRkMgUmVjYWwgKi8KKwl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgQ0hW
X0NNTl9EVzE0KHBvcnQpLAorCQkJdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgQ0hWX0NN
Tl9EVzE0KHBvcnQpKSB8CisJCQlEUElPX0FGQ19SRUNBTCk7CisKKwl2bHZfZHBpb19wdXQoZGV2
X3ByaXYpOworfQorCisvKioKKyAqIHZsdl9mb3JjZV9wbGxfb24gLSBmb3JjaWJseSBlbmFibGUg
anVzdCB0aGUgUExMCisgKiBAZGV2X3ByaXY6IGk5MTUgcHJpdmF0ZSBzdHJ1Y3R1cmUKKyAqIEBw
aXBlOiBwaXBlIFBMTCB0byBlbmFibGUKKyAqIEBkcGxsOiBQTEwgY29uZmlndXJhdGlvbgorICoK
KyAqIEVuYWJsZSB0aGUgUExMIGZvciBAcGlwZSB1c2luZyB0aGUgc3VwcGxpZWQgQGRwbGwgY29u
ZmlnLiBUbyBiZSB1c2VkCisgKiBpbiBjYXNlcyB3aGVyZSB3ZSBuZWVkIHRoZSBQTEwgZW5hYmxl
ZCBldmVuIHdoZW4gQHBpcGUgaXMgbm90IGdvaW5nIHRvCisgKiBiZSBlbmFibGVkLgorICovCitp
bnQgdmx2X2ZvcmNlX3BsbF9vbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVu
dW0gcGlwZSBwaXBlLAorCQkgICAgIGNvbnN0IHN0cnVjdCBkcGxsICpkcGxsKQoreworCXN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIHBp
cGUpOworCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZzsKKworCXBpcGVfY29u
ZmlnID0gaW50ZWxfY3J0Y19zdGF0ZV9hbGxvYyhjcnRjKTsKKwlpZiAoIXBpcGVfY29uZmlnKQor
CQlyZXR1cm4gLUVOT01FTTsKKworCXBpcGVfY29uZmlnLT5jcHVfdHJhbnNjb2RlciA9IChlbnVt
IHRyYW5zY29kZXIpcGlwZTsKKwlwaXBlX2NvbmZpZy0+cGl4ZWxfbXVsdGlwbGllciA9IDE7CisJ
cGlwZV9jb25maWctPmRwbGwgPSAqZHBsbDsKKworCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2
KSkgeworCQljaHZfY29tcHV0ZV9kcGxsKGNydGMsIHBpcGVfY29uZmlnKTsKKwkJY2h2X3ByZXBh
cmVfcGxsKGNydGMsIHBpcGVfY29uZmlnKTsKKwkJY2h2X2VuYWJsZV9wbGwoY3J0YywgcGlwZV9j
b25maWcpOworCX0gZWxzZSB7CisJCXZsdl9jb21wdXRlX2RwbGwoY3J0YywgcGlwZV9jb25maWcp
OworCQl2bHZfcHJlcGFyZV9wbGwoY3J0YywgcGlwZV9jb25maWcpOworCQl2bHZfZW5hYmxlX3Bs
bChjcnRjLCBwaXBlX2NvbmZpZyk7CisJfQorCisJa2ZyZWUocGlwZV9jb25maWcpOworCisJcmV0
dXJuIDA7Cit9CisKK3ZvaWQgdmx2X2Rpc2FibGVfcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUpCit7CisJdTMyIHZhbDsKKworCS8qIE1ha2Ugc3Vy
ZSB0aGUgcGlwZSBpc24ndCBzdGlsbCByZWx5aW5nIG9uIHVzICovCisJYXNzZXJ0X3BpcGVfZGlz
YWJsZWQoZGV2X3ByaXYsIChlbnVtIHRyYW5zY29kZXIpcGlwZSk7CisKKwl2YWwgPSBEUExMX0lO
VEVHUkFURURfUkVGX0NMS19WTFYgfAorCQlEUExMX1JFRl9DTEtfRU5BQkxFX1ZMViB8IERQTExf
VkdBX01PREVfRElTOworCWlmIChwaXBlICE9IFBJUEVfQSkKKwkJdmFsIHw9IERQTExfSU5URUdS
QVRFRF9DUklfQ0xLX1ZMVjsKKworCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBEUExMKHBpcGUp
LCB2YWwpOworCWludGVsX2RlX3Bvc3RpbmdfcmVhZChkZXZfcHJpdiwgRFBMTChwaXBlKSk7Cit9
CisKK3ZvaWQgY2h2X2Rpc2FibGVfcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwgZW51bSBwaXBlIHBpcGUpCit7CisJZW51bSBkcGlvX2NoYW5uZWwgcG9ydCA9IHZsdl9waXBl
X3RvX2NoYW5uZWwocGlwZSk7CisJdTMyIHZhbDsKKworCS8qIE1ha2Ugc3VyZSB0aGUgcGlwZSBp
c24ndCBzdGlsbCByZWx5aW5nIG9uIHVzICovCisJYXNzZXJ0X3BpcGVfZGlzYWJsZWQoZGV2X3By
aXYsIChlbnVtIHRyYW5zY29kZXIpcGlwZSk7CisKKwl2YWwgPSBEUExMX1NTQ19SRUZfQ0xLX0NI
ViB8CisJCURQTExfUkVGX0NMS19FTkFCTEVfVkxWIHwgRFBMTF9WR0FfTU9ERV9ESVM7CisJaWYg
KHBpcGUgIT0gUElQRV9BKQorCQl2YWwgfD0gRFBMTF9JTlRFR1JBVEVEX0NSSV9DTEtfVkxWOwor
CisJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIERQTEwocGlwZSksIHZhbCk7CisJaW50ZWxfZGVf
cG9zdGluZ19yZWFkKGRldl9wcml2LCBEUExMKHBpcGUpKTsKKworCXZsdl9kcGlvX2dldChkZXZf
cHJpdik7CisKKwkvKiBEaXNhYmxlIDEwYml0IGNsb2NrIHRvIGRpc3BsYXkgY29udHJvbGxlciAq
LworCXZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIENIVl9DTU5fRFcxNChwb3J0
KSk7CisJdmFsICY9IH5EUElPX0RDTEtQX0VOOworCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBw
aXBlLCBDSFZfQ01OX0RXMTQocG9ydCksIHZhbCk7CisKKwl2bHZfZHBpb19wdXQoZGV2X3ByaXYp
OworfQorCit2b2lkIGk5eHhfZGlzYWJsZV9wbGwoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUpCit7CisJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9j
cnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7CisJZW51bSBwaXBlIHBpcGUgPSBjcnRj
LT5waXBlOworCisJLyogRG9uJ3QgZGlzYWJsZSBwaXBlIG9yIHBpcGUgUExMcyBpZiBuZWVkZWQg
Ki8KKwlpZiAoSVNfSTgzMChkZXZfcHJpdikpCisJCXJldHVybjsKKworCS8qIE1ha2Ugc3VyZSB0
aGUgcGlwZSBpc24ndCBzdGlsbCByZWx5aW5nIG9uIHVzICovCisJYXNzZXJ0X3BpcGVfZGlzYWJs
ZWQoZGV2X3ByaXYsIGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyKTsKKworCWludGVsX2RlX3dy
aXRlKGRldl9wcml2LCBEUExMKHBpcGUpLCBEUExMX1ZHQV9NT0RFX0RJUyk7CisJaW50ZWxfZGVf
cG9zdGluZ19yZWFkKGRldl9wcml2LCBEUExMKHBpcGUpKTsKK30KKworCisvKioKKyAqIHZsdl9m
b3JjZV9wbGxfb2ZmIC0gZm9yY2libHkgZGlzYWJsZSBqdXN0IHRoZSBQTEwKKyAqIEBkZXZfcHJp
djogaTkxNSBwcml2YXRlIHN0cnVjdHVyZQorICogQHBpcGU6IHBpcGUgUExMIHRvIGRpc2FibGUK
KyAqCisgKiBEaXNhYmxlIHRoZSBQTEwgZm9yIEBwaXBlLiBUbyBiZSB1c2VkIGluIGNhc2VzIHdo
ZXJlIHdlIG5lZWQKKyAqIHRoZSBQTEwgZW5hYmxlZCBldmVuIHdoZW4gQHBpcGUgaXMgbm90IGdv
aW5nIHRvIGJlIGVuYWJsZWQuCisgKi8KK3ZvaWQgdmx2X2ZvcmNlX3BsbF9vZmYoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUgcGlwZSkKK3sKKwlpZiAoSVNfQ0hF
UlJZVklFVyhkZXZfcHJpdikpCisJCWNodl9kaXNhYmxlX3BsbChkZXZfcHJpdiwgcGlwZSk7CisJ
ZWxzZQorCQl2bHZfZGlzYWJsZV9wbGwoZGV2X3ByaXYsIHBpcGUpOworfQpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcGxsLmggYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwbGwuaAppbmRleCBjYWY0NjE1MDkyZTEuLjdmZjRiMGQy
OWVkMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcGxs
LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcGxsLmgKQEAgLTEw
LDYgKzEwLDcgQEAgc3RydWN0IGRwbGw7CiBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKIHN0cnVj
dCBpbnRlbF9jcnRjOwogc3RydWN0IGludGVsX2NydGNfc3RhdGU7CitlbnVtIHBpcGU7CiAKIHZv
aWQgaW50ZWxfZHBsbF9pbml0X2Nsb2NrX2hvb2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KTsKIGludCB2bHZfY2FsY19kcGxsX3BhcmFtcyhpbnQgcmVmY2xrLCBzdHJ1Y3QgZHBs
bCAqY2xvY2spOwpAQCAtMjAsNCArMjEsMjEgQEAgdm9pZCB2bHZfY29tcHV0ZV9kcGxsKHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjLAogdm9pZCBjaHZfY29tcHV0ZV9kcGxsKHN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjLAogCQkgICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcp
OwogCitpbnQgdmx2X2ZvcmNlX3BsbF9vbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsIGVudW0gcGlwZSBwaXBlLAorCQkgICAgIGNvbnN0IHN0cnVjdCBkcGxsICpkcGxsKTsKK3Zv
aWQgdmx2X2ZvcmNlX3BsbF9vZmYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBl
bnVtIHBpcGUgcGlwZSk7Cit2b2lkIGk5eHhfZW5hYmxlX3BsbChzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YywKKwkJICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7
Cit2b2lkIHZsdl9lbmFibGVfcGxsKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAorCQkgICAgY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKTsKK3ZvaWQgY2h2X2VuYWJs
ZV9wbGwoc3RydWN0IGludGVsX2NydGMgKmNydGMsCisJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpOwordm9pZCB2bHZfZGlzYWJsZV9wbGwoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUgcGlwZSk7Cit2b2lkIGNodl9kaXNh
YmxlX3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlwZSBwaXBl
KTsKK3ZvaWQgaTl4eF9kaXNhYmxlX3BsbChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSk7Cit2b2lkIHZsdl9wcmVwYXJlX3BsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YywKKwkJICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpOwor
dm9pZCBjaHZfcHJlcGFyZV9wbGwoc3RydWN0IGludGVsX2NydGMgKmNydGMsCisJCSAgICAgY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKTsKKwogI2VuZGlmCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Bwcy5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9wcHMuYwppbmRleCBjNDg2N2E4MDIwYTUuLmYy
MGJhNzFmNDMwNyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9wcHMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Bwcy5jCkBA
IC02LDYgKzYsNyBAQAogI2luY2x1ZGUgImk5MTVfZHJ2LmgiCiAjaW5jbHVkZSAiaW50ZWxfZGlz
cGxheV90eXBlcy5oIgogI2luY2x1ZGUgImludGVsX2RwLmgiCisjaW5jbHVkZSAiaW50ZWxfZHBs
bC5oIgogI2luY2x1ZGUgImludGVsX3Bwcy5oIgogCiBzdGF0aWMgdm9pZCB2bHZfc3RlYWxfcG93
ZXJfc2VxdWVuY2VyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLS0gCjIuMjAu
MQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwt
Z2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8v
bGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4Cg==

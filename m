Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id DEB4C1CA954
	for <lists+intel-gfx@lfdr.de>; Fri,  8 May 2020 13:14:12 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 39DEA6EB0F;
	Fri,  8 May 2020 11:14:11 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga07.intel.com (mga07.intel.com [134.134.136.100])
 by gabe.freedesktop.org (Postfix) with ESMTPS id EA1C36EB0F
 for <intel-gfx@lists.freedesktop.org>; Fri,  8 May 2020 11:14:09 +0000 (UTC)
IronPort-SDR: fe76EpnVPkPjhv75+Usc26ofXdueXlPd71Tab2lmTzSv3Q8aH0k3Xv5QML4qheQa1Fb+raDjxq
 yg9kpLPc0xJg==
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga003.jf.intel.com ([10.7.209.27])
 by orsmga105.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 08 May 2020 04:14:09 -0700
IronPort-SDR: LN/nnmp75uW4bFxjWaAkgh41bi+yt2XVgWdwdhVgJBy4g+AvrZpwIZ0GkGIVFxzCU9Sbr5iQN5
 dayYXk7eP5OQ==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.73,367,1583222400"; d="scan'208";a="260851699"
Received: from jlenoir-mobl.ger.corp.intel.com (HELO [10.252.58.54])
 ([10.252.58.54])
 by orsmga003.jf.intel.com with ESMTP; 08 May 2020 04:14:07 -0700
To: Animesh Manna <animesh.manna@intel.com>, intel-gfx@lists.freedesktop.org
References: <20200506131112.19581-1-animesh.manna@intel.com>
From: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
Message-ID: <22382e1c-e5e1-f8c8-74f3-83bd6b649978@linux.intel.com>
Date: Fri, 8 May 2020 13:14:06 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.7.0
MIME-Version: 1.0
In-Reply-To: <20200506131112.19581-1-animesh.manna@intel.com>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH v5] drm/i915/dsb: Pre allocate and late
 cleanup of cmd buffer
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Jani Nikula <jani.nikula@intel.com>, Daniel Vetter <daniel.vetter@ffwll.ch>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T3AgMDYtMDUtMjAyMCBvbSAxNToxMSBzY2hyZWVmIEFuaW1lc2ggTWFubmE6Cj4gUHJlLWFsbG9j
YXRlIGNvbW1hbmQgYnVmZmVyIGluIGF0b21pY19jb21taXQgdXNpbmcgaW50ZWxfZHNiX3ByZXBh
cmUKPiBmdW5jdGlvbiB3aGljaCBhbHNvIGluY2x1ZGVzIHBpbm5pbmcgYW5kIG1hcCBpbiBjcHUg
ZG9tYWluLgo+Cj4gTm8gY2hhbmdlIGlzIGRzYiB3cml0ZS9jb21taXQgZnVuY3Rpb25zLgo+Cj4g
Tm93IGRzYiBnZXQvcHV0IGZ1bmN0aW9uIGlzIHJlZmFjdG9yZWQgYW5kIGN1cnJlbnRseSB1c2Vk
IG9ubHkgZm9yCj4gcmVmZXJlbmNlIGNvdW50aW5nLiBCZWxvdyBkc2IgYXBpIGFkZGVkIHRvIGRv
IHJlc3BlY3RpdmUgam9iCj4gbWVudGlvbmVkIGJlbG93Lgo+Cj4gaW50ZWxfZHNiX3ByZXBhcmUg
LSBBbGxvY2F0ZSwgcGluIGFuZCBtYXAgdGhlIGJ1ZmZlci4KPiBpbnRlbF9kc2JfY2xlYW51cCAt
IFVucGluIGFuZCByZWxlYXNlIHRoZSBnZW0gb2JqZWN0Lgo+Cj4gUkZDOiBJbml0aWFsIHBhdGNo
IGZvciBkZXNpZ24gcmV2aWV3Lgo+IHYyOiBpbmNsdWRlZCBfaW5pdCgpIHBhcnQgaW4gX3ByZXBh
cmUoKS4gW0RhbmllbCwgVmlsbGVdCj4gdjM6IGRzYl9jbGVhbnVwIGNhbGxlZCBhZnRlciBjbGVh
bnVwX3BsYW5lcy4gW0RhbmllbF0KPiB2NDogZHNiIHN0cnVjdHVyZSBpcyBtb3ZlZCB0byBpbnRl
bF9jcnRjX3N0YXRlIGZyb20gaW50ZWxfY3J0Yy4gW01hYXJ0ZW5dCj4gdjU6IGRzYiBnZXQvcHV0
L3JlZi1jb3VudCBtZWNoYW5pc20gcmVtb3ZlZC4gW01hYXJ0ZW5dCj4KPiBDYzogTWFhcnRlbiBM
YW5raG9yc3QgPG1hYXJ0ZW4ubGFua2hvcnN0QGxpbnV4LmludGVsLmNvbT4KPiBDYzogVmlsbGUg
U3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KPiBDYzogSmFuaSBOaWt1
bGEgPGphbmkubmlrdWxhQGludGVsLmNvbT4KPiBDYzogRGFuaWVsIFZldHRlciA8ZGFuaWVsLnZl
dHRlckBmZndsbC5jaD4KPiBBY2tlZC1ieTogRGFuaWVsIFZldHRlciA8ZGFuaWVsLnZldHRlckBm
ZndsbC5jaD4KPiBTaWduZWQtb2ZmLWJ5OiBBbmltZXNoIE1hbm5hIDxhbmltZXNoLm1hbm5hQGlu
dGVsLmNvbT4KPiAtLS0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9jb2xv
ci5jICAgIHwgIDI3ICsrLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rp
c3BsYXkuYyAgfCAgNjAgKysrKy0KPiAgLi4uL2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxh
eV90eXBlcy5oICAgIHwgICA2ICstCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfZHNiLmMgICAgICB8IDIwNyArKysrKysrKystLS0tLS0tLS0KPiAgZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9kc2IuaCAgICAgIHwgICA4ICstCj4gIDUgZmlsZXMgY2hhbmdl
ZCwgMTc4IGluc2VydGlvbnMoKyksIDEzMCBkZWxldGlvbnMoLSkKPgo+IGRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2NvbG9yLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2NvbG9yLmMKPiBpbmRleCA5OGVjZTljZDdjZGQuLmRiYTgy
MDEzNjEwNiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2NvbG9yLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2NvbG9y
LmMKPiBAQCAtNzE3LDcgKzcxNyw4IEBAIHN0YXRpYyB2b2lkIGJkd19sb2FkX2x1dF8xMChzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgc3RhdGljIHZvaWQgaXZiX2xvYWRfbHV0X2V4dF9tYXgo
c3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gIHsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+IC0Jc3RydWN0IGludGVsX2Rz
YiAqZHNiID0gaW50ZWxfZHNiX2dldChjcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlID0gdG9faW50ZWxfY3J0Y19zdGF0ZShjcnRjLT5iYXNlLnN0YXRlKTsKPiAr
CXN0cnVjdCBpbnRlbF9kc2IgKmRzYiA9IChzdHJ1Y3QgaW50ZWxfZHNiICopJmNydGNfc3RhdGUt
PmRzYjsKPiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCj4gIAkvKiBQcm9ncmFt
IHRoZSBtYXggcmVnaXN0ZXIgdG8gY2xhbXAgdmFsdWVzID4gMS4wLiAqLwpQbGVhc2UgcGFzcyB0
aGUgY3J0Y19zdGF0ZSwgYXMgY3J0Yy0+c3RhdGUgc2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5
Lgo+IEBAIC03MzgsOCArNzM5LDYgQEAgc3RhdGljIHZvaWQgaXZiX2xvYWRfbHV0X2V4dF9tYXgo
c3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gIAkJaW50ZWxfZHNiX3JlZ193cml0ZShkc2IsIFBS
RUNfUEFMX0VYVDJfR0NfTUFYKHBpcGUsIDIpLAo+ICAJCQkJICAgIDEgPDwgMTYpOwo+ICAJfQo+
IC0KPiAtCWludGVsX2RzYl9wdXQoZHNiKTsKPiAgfQo+ICAKPiAgc3RhdGljIHZvaWQgaXZiX2xv
YWRfbHV0cyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiBAQCAt
OTAwLDE0ICs4OTksMTMgQEAgaWNsX2xvYWRfZ2NtYXgoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUsCj4gIAkgICAgICAgY29uc3Qgc3RydWN0IGRybV9jb2xvcl9sdXQg
KmNvbG9yKQo+ICB7Cj4gIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMo
Y3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAtCXN0cnVjdCBpbnRlbF9kc2IgKmRzYiA9IGludGVs
X2RzYl9nZXQoY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfZHNiICpkc2IgPSAoc3RydWN0IGludGVs
X2RzYiAqKSZjcnRjX3N0YXRlLT5kc2I7CgpXaHkgdGhlIGNhc3Q/IFVuY29uc3RpZnkgY3J0Y19z
dGF0ZSBhcyBpdCdzIG9idmlvdXNseSBub3QgY29uc3QgYW55IG1vcmUuCgo+ICAJZW51bSBwaXBl
IHBpcGUgPSBjcnRjLT5waXBlOwo+ICAKPiAgCS8qIEZJWE1FIExVVCBlbnRyaWVzIGFyZSAxNiBi
aXQgb25seSwgc28gd2UgY2FuIHByb2cgMHhGRkZGIG1heCAqLwo+ICAJaW50ZWxfZHNiX3JlZ193
cml0ZShkc2IsIFBSRUNfUEFMX0dDX01BWChwaXBlLCAwKSwgY29sb3ItPnJlZCk7Cj4gIAlpbnRl
bF9kc2JfcmVnX3dyaXRlKGRzYiwgUFJFQ19QQUxfR0NfTUFYKHBpcGUsIDEpLCBjb2xvci0+Z3Jl
ZW4pOwo+ICAJaW50ZWxfZHNiX3JlZ193cml0ZShkc2IsIFBSRUNfUEFMX0dDX01BWChwaXBlLCAy
KSwgY29sb3ItPmJsdWUpOwo+IC0JaW50ZWxfZHNiX3B1dChkc2IpOwo+ICB9Cj4gIAo+ICBzdGF0
aWMgdm9pZAo+IEBAIC05MTYsNyArOTE0LDcgQEAgaWNsX3Byb2dyYW1fZ2FtbWFfc3VwZXJmaW5l
X3NlZ21lbnQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIAlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5j
cnRjKTsKPiAgCWNvbnN0IHN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqYmxvYiA9IGNydGNfc3Rh
dGUtPmh3LmdhbW1hX2x1dDsKPiAgCWNvbnN0IHN0cnVjdCBkcm1fY29sb3JfbHV0ICpsdXQgPSBi
bG9iLT5kYXRhOwo+IC0Jc3RydWN0IGludGVsX2RzYiAqZHNiID0gaW50ZWxfZHNiX2dldChjcnRj
KTsKPiArCXN0cnVjdCBpbnRlbF9kc2IgKmRzYiA9IChzdHJ1Y3QgaW50ZWxfZHNiICopJmNydGNf
c3RhdGUtPmRzYjsKU2FtZS4KPiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCWlu
dCBpOwo+ICAKPiBAQCAtOTM4LDggKzkzNiw2IEBAIGljbF9wcm9ncmFtX2dhbW1hX3N1cGVyZmlu
ZV9zZWdtZW50KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAJ
CWludGVsX2RzYl9pbmRleGVkX3JlZ193cml0ZShkc2IsIFBSRUNfUEFMX01VTFRJX1NFR19EQVRB
KHBpcGUpLAo+ICAJCQkJCSAgICBpbGtfbHV0XzEycDRfdWR3KGVudHJ5KSk7Cj4gIAl9Cj4gLQo+
IC0JaW50ZWxfZHNiX3B1dChkc2IpOwo+ICB9Cj4gIAo+ICBzdGF0aWMgdm9pZAo+IEBAIC05NDks
NyArOTQ1LDcgQEAgaWNsX3Byb2dyYW1fZ2FtbWFfbXVsdGlfc2VnbWVudChjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgCWNvbnN0IHN0cnVjdCBkcm1fcHJvcGVy
dHlfYmxvYiAqYmxvYiA9IGNydGNfc3RhdGUtPmh3LmdhbW1hX2x1dDsKPiAgCWNvbnN0IHN0cnVj
dCBkcm1fY29sb3JfbHV0ICpsdXQgPSBibG9iLT5kYXRhOwo+ICAJY29uc3Qgc3RydWN0IGRybV9j
b2xvcl9sdXQgKmVudHJ5Owo+IC0Jc3RydWN0IGludGVsX2RzYiAqZHNiID0gaW50ZWxfZHNiX2dl
dChjcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9kc2IgKmRzYiA9IChzdHJ1Y3QgaW50ZWxfZHNiICop
JmNydGNfc3RhdGUtPmRzYjsKPiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCWlu
dCBpOwo+ICAKPiBAQCAtOTk2LDE0ICs5OTIsMjIgQEAgaWNsX3Byb2dyYW1fZ2FtbWFfbXVsdGlf
c2VnbWVudChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgCWVu
dHJ5ID0gJmx1dFsyNTYgKiA4ICogMTI4XTsKPiAgCWljbF9sb2FkX2djbWF4KGNydGNfc3RhdGUs
IGVudHJ5KTsKPiAgCWl2Yl9sb2FkX2x1dF9leHRfbWF4KGNydGMpOwo+IC0JaW50ZWxfZHNiX3B1
dChkc2IpOwo+ICB9Cj4gIAo+ICBzdGF0aWMgdm9pZCBpY2xfbG9hZF9sdXRzKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gIAljb25zdCBzdHJ1Y3QgZHJt
X3Byb3BlcnR5X2Jsb2IgKmdhbW1hX2x1dCA9IGNydGNfc3RhdGUtPmh3LmdhbW1hX2x1dDsKPiAg
CXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBp
LmNydGMpOwo+IC0Jc3RydWN0IGludGVsX2RzYiAqZHNiID0gaW50ZWxfZHNiX2dldChjcnRjKTsK
PiArCXN0cnVjdCBpbnRlbF9kc2IgKmRzYiA9IChzdHJ1Y3QgaW50ZWxfZHNiICopJmNydGNfc3Rh
dGUtPmRzYjsKPiArCj4gKwkvKgo+ICsJICogVE9ETzogQ3VycmVudGx5IGRzYiBidWZmZXIgZmls
bGluZyBpcyBkb25lIGluIGxvYWRfbHV0KCkgd2hpY2gKPiArCSAqIGNhbiBiZSBkb25lIG11Y2gg
ZWFybGllciwgbGlrZSBpbml0aWFsIHN0YWdlIG9mIGF0b21pY19jb21taXQoKS4KPiArCSAqIEFz
IGN1cnJlbnRseSByZXBsYWNpbmcgdGhlIG1taW8td3JpdGUgd2l0aCBkc2Itd3JpdGUgc28gdGhl
IHNhbWUKPiArCSAqIGxvYWRfbHV0KCkgYXBpIGlzIHVzZWQgZm9yIGRzYiBidWZmZXIgY3JlYXRp
b24gd2hpY2ggbWF5IG5vdAo+ICsJICogZml0IGluIGluaXRpYWwgc3RhZ2UuIE5lZWQgdG8gY3Jl
YXRlIGEgc2VwYXJhdGUgaW50ZXJmYWNlIGFuZAo+ICsJICogYSBkaWZmZXJlbnQgcGF0aCBpbiBj
b2xvciBmcmFtZXdvcmsgd2hpbGUgZGVhbGluZyB3aXRoIGRzYi4KPiArCSAqLwo+ICAKPiAgCWlm
IChjcnRjX3N0YXRlLT5ody5kZWdhbW1hX2x1dCkKPiAgCQlnbGtfbG9hZF9kZWdhbW1hX2x1dChj
cnRjX3N0YXRlKTsKPiBAQCAtMTAyMiw3ICsxMDI2LDYgQEAgc3RhdGljIHZvaWQgaWNsX2xvYWRf
bHV0cyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgCX0KPiAg
Cj4gIAlpbnRlbF9kc2JfY29tbWl0KGRzYik7Cj4gLQlpbnRlbF9kc2JfcHV0KGRzYik7Cj4gIH0K
PiAgCj4gIHN0YXRpYyB1MzIgY2h2X2NnbV9kZWdhbW1hX2xkdyhjb25zdCBzdHJ1Y3QgZHJtX2Nv
bG9yX2x1dCAqY29sb3IpCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfZGlzcGxheS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9k
aXNwbGF5LmMKPiBpbmRleCBmZDZkNjNiMDM0ODkuLjA3NjcwODkzYzFhZSAxMDA2NDQKPiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwo+ICsrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCj4gQEAgLTE0ODczLDgg
KzE0ODczLDI4IEBAIHN0YXRpYyBpbnQgaW50ZWxfYXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYsCj4gIAo+ICBzdGF0aWMgaW50IGludGVsX2F0b21pY19wcmVwYXJlX2NvbW1pdChz
dHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgewo+IC0JcmV0dXJuIGRybV9hdG9t
aWNfaGVscGVyX3ByZXBhcmVfcGxhbmVzKHN0YXRlLT5iYXNlLmRldiwKPiAtCQkJCQkJJnN0YXRl
LT5iYXNlKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlOwo+ICsJc3Ry
dWN0IGludGVsX2NydGMgKmNydGM7Cj4gKwlpbnQgaSwgcmV0Owo+ICsKPiArCXJldCA9IGRybV9h
dG9taWNfaGVscGVyX3ByZXBhcmVfcGxhbmVzKHN0YXRlLT5iYXNlLmRldiwgJnN0YXRlLT5iYXNl
KTsKPiArCWlmIChyZXQgPCAwKQo+ICsJCXJldHVybiByZXQ7Cj4gKwo+ICsJLyoKPiArCSAqIElu
IGNhc2Ugb2YgRFNCIGJ1ZmZlciBjcmVhdGlvbiBmYWlsdXJlIHJlZ2lzdGVyIHByb2dyYW1taW5n
IHdpbGwgYmUKPiArCSAqIGRvbmUgYnkgbW1pbyBhbmQgZXJyb25lb3VzIHBhdGggd2lsbCBiZSBo
YW5kbGVkIGJ5IGRzcC13cml0ZSBhcGkuCj4gKwkgKi8KPiArCWZvcl9lYWNoX25ld19pbnRlbF9j
cnRjX2luX3N0YXRlKHN0YXRlLCBjcnRjLCBjcnRjX3N0YXRlLCBpKSB7Cj4gKwkJYm9vbCBtb2Rl
X2NoYW5nZWQgPSBuZWVkc19tb2Rlc2V0KGNydGNfc3RhdGUpOwo+ICsKPiArCQlpZiAobW9kZV9j
aGFuZ2VkIHx8IGNydGNfc3RhdGUtPnVwZGF0ZV9waXBlIHx8Cj4gKwkJICAgIGNydGNfc3RhdGUt
PnVhcGkuY29sb3JfbWdtdF9jaGFuZ2VkKSB7Cj4gKwkJCWludGVsX2RzYl9wcmVwYXJlKGNydGNf
c3RhdGUpOwo+ICsJCX0KPiArCX0KPiArCj4gKwlyZXR1cm4gMDsKPiAgfQo+ICAKPiAgdTMyIGlu
dGVsX2NydGNfZ2V0X3ZibGFua19jb3VudGVyKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+IEBA
IC0xNTMyNywxNSArMTUzNDcsMzkgQEAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX2NvbW1pdF9m
ZW5jZV93YWl0KHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKmludGVsX3N0YXQKPiAgCQkgICAg
JndhaXRfcmVzZXQpOwo+ICB9Cj4gIAo+ICtzdGF0aWMgdm9pZCBpbnRlbF9jbGVhbnVwX2RzYnMo
c3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gK3sKPiArCXN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlLCAqb2xkX2NydGNfc3RhdGUsICpuZXdfY3J0Y19zdGF0ZTsK
PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOwo+ICsJaW50IGk7Cj4gKwo+ICsJZm9yX2VhY2hf
b2xkbmV3X2ludGVsX2NydGNfaW5fc3RhdGUoc3RhdGUsIGNydGMsIG9sZF9jcnRjX3N0YXRlLCBu
ZXdfY3J0Y19zdGF0ZSwgaSkgewo+ICsJCWJvb2wgbW9kZV9jaGFuZ2VkOwo+ICsKPiArCQlpZiAo
b2xkX2NydGNfc3RhdGUgPT0gY3J0Yy0+Y29uZmlnKQo+ICsJCQljcnRjX3N0YXRlID0gbmV3X2Ny
dGNfc3RhdGU7Cj4gKwkJZWxzZQo+ICsJCQljcnRjX3N0YXRlID0gb2xkX2NydGNfc3RhdGU7Cj4g
Kwo+ICsJCW1vZGVfY2hhbmdlZCA9IG5lZWRzX21vZGVzZXQoY3J0Y19zdGF0ZSk7Cj4gKwkJaWYg
KG1vZGVfY2hhbmdlZCB8fCBjcnRjX3N0YXRlLT51cGRhdGVfcGlwZSB8fAo+ICsJCSAgICBjcnRj
X3N0YXRlLT51YXBpLmNvbG9yX21nbXRfY2hhbmdlZCkgewo+ICsJCQlpbnRlbF9kc2JfY2xlYW51
cChjcnRjX3N0YXRlKTsKSnVzdCBjYWxsIHRoZSBjbGVhbnVwIGZ1bmN0aW9uIHVuY29uZGl0aW9u
YWxseSBoZXJlLCB0aGUgZHNiLT52bWEgPSBOVUxMIGNoZWNrIGlzIGVub3VnaC4KPiArCQl9Cj4g
Kwl9Cj4gK30KPiArCj4gIHN0YXRpYyB2b2lkIGludGVsX2F0b21pY19jbGVhbnVwX3dvcmsoc3Ry
dWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICB7Cj4gLQlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAq
c3RhdGUgPQo+IC0JCWNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSwg
Y29tbWl0X3dvcmspOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KHN0YXRlLT5kZXYpOwo+ICsJc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUgPQo+ICsJ
CWNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlLCBiYXNlLmNvbW1p
dF93b3JrKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShzdGF0
ZS0+YmFzZS5kZXYpOwo+ICAKPiAtCWRybV9hdG9taWNfaGVscGVyX2NsZWFudXBfcGxhbmVzKCZp
OTE1LT5kcm0sIHN0YXRlKTsKPiAtCWRybV9hdG9taWNfaGVscGVyX2NvbW1pdF9jbGVhbnVwX2Rv
bmUoc3RhdGUpOwo+IC0JZHJtX2F0b21pY19zdGF0ZV9wdXQoc3RhdGUpOwo+ICsJaWYgKEhBU19E
U0IoaTkxNSkpCj4gKwkJaW50ZWxfY2xlYW51cF9kc2JzKHN0YXRlKTsKPiArCWRybV9hdG9taWNf
aGVscGVyX2NsZWFudXBfcGxhbmVzKCZpOTE1LT5kcm0sICZzdGF0ZS0+YmFzZSk7Cj4gKwlkcm1f
YXRvbWljX2hlbHBlcl9jb21taXRfY2xlYW51cF9kb25lKCZzdGF0ZS0+YmFzZSk7Cj4gKwlkcm1f
YXRvbWljX3N0YXRlX3B1dCgmc3RhdGUtPmJhc2UpOwo+ICAKPiAgCWludGVsX2F0b21pY19oZWxw
ZXJfZnJlZV9zdGF0ZShpOTE1KTsKPiAgfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oCj4gaW5kZXggOTQ4ODQ0OWU0Yjk0Li44MDVj
YTc3NGUxNDYgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9kaXNwbGF5X3R5cGVzLmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX2Rpc3BsYXlfdHlwZXMuaAo+IEBAIC0xMDc4LDYgKzEwNzgsOSBAQCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSB7Cj4gIAo+ICAJLyogT25seSB2YWxpZCBvbiBUR0wrICovCj4gIAllbnVtIHRy
YW5zY29kZXIgbXN0X21hc3Rlcl90cmFuc2NvZGVyOwo+ICsKPiArCS8qIEZvciBEU0IgcmVsYXRl
ZCBpbmZvICovCj4gKwlzdHJ1Y3QgaW50ZWxfZHNiIGRzYjsKPiAgfTsKPiAgCj4gIGVudW0gaW50
ZWxfcGlwZV9jcmNfc291cmNlIHsKPiBAQCAtMTE0Nyw5ICsxMTUwLDYgQEAgc3RydWN0IGludGVs
X2NydGMgewo+ICAJLyogc2NhbGVycyBhdmFpbGFibGUgb24gdGhpcyBjcnRjICovCj4gIAlpbnQg
bnVtX3NjYWxlcnM7Cj4gIAo+IC0JLyogcGVyIHBpcGUgRFNCIHJlbGF0ZWQgaW5mbyAqLwo+IC0J
c3RydWN0IGludGVsX2RzYiBkc2I7Cj4gLQo+ICAjaWZkZWYgQ09ORklHX0RFQlVHX0ZTCj4gIAlz
dHJ1Y3QgaW50ZWxfcGlwZV9jcmMgcGlwZV9jcmM7Cj4gICNlbmRpZgo+IGRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RzYi5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9kc2IuYwo+IGluZGV4IDI5ZmVjNmE5MmQxNy4uMjQ3ZmQ1NjRk
Mzk0IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHNi
LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RzYi5jCj4gQEAg
LTM0LDE4ICszNCwyMiBAQAo+ICAjZGVmaW5lIERTQl9CWVRFX0VOX1NISUZUCQkyMAo+ICAjZGVm
aW5lIERTQl9SRUdfVkFMVUVfTUFTSwkJMHhmZmZmZgo+ICAKPiAtc3RhdGljIGJvb2wgaXNfZHNi
X2J1c3koc3RydWN0IGludGVsX2RzYiAqZHNiKQo+ICtzdGF0aWMgaW5saW5lIGJvb2wgaXNfZHNi
X2J1c3koc3RydWN0IGludGVsX2RzYiAqZHNiKQo+ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IGNvbnRhaW5lcl9vZihkc2IsIHR5cGVvZigqY3J0YyksIGRzYik7Cj4gKwlzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9Cj4gKwkJY29udGFpbmVyX29mKGRzYiwgdHlw
ZW9mKCpjcnRjX3N0YXRlKSwgZHNiKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9f
aW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gIAllbnVtIHBpcGUg
cGlwZSA9IGNydGMtPnBpcGU7Cj4gIAo+ICAJcmV0dXJuIERTQl9TVEFUVVMgJiBpbnRlbF9kZV9y
ZWFkKGRldl9wcml2LCBEU0JfQ1RSTChwaXBlLCBkc2ItPmlkKSk7Cj4gIH0KPiAgCj4gLXN0YXRp
YyBib29sIGludGVsX2RzYl9lbmFibGVfZW5naW5lKHN0cnVjdCBpbnRlbF9kc2IgKmRzYikKPiAr
c3RhdGljIGlubGluZSBib29sIGludGVsX2RzYl9lbmFibGVfZW5naW5lKHN0cnVjdCBpbnRlbF9k
c2IgKmRzYikKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSBjb250YWluZXJfb2Yo
ZHNiLCB0eXBlb2YoKmNydGMpLCBkc2IpOwo+ICsJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUgPQo+ICsJCWNvbnRhaW5lcl9vZihkc2IsIHR5cGVvZigqY3J0Y19zdGF0ZSksIGRz
Yik7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0
ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+
ICAJdTMyIGRzYl9jdHJsOwo+IEBAIC02Myw5ICs2NywxMSBAQCBzdGF0aWMgYm9vbCBpbnRlbF9k
c2JfZW5hYmxlX2VuZ2luZShzdHJ1Y3QgaW50ZWxfZHNiICpkc2IpCj4gIAlyZXR1cm4gdHJ1ZTsK
PiAgfQo+ICAKPiAtc3RhdGljIGJvb2wgaW50ZWxfZHNiX2Rpc2FibGVfZW5naW5lKHN0cnVjdCBp
bnRlbF9kc2IgKmRzYikKPiArc3RhdGljIGlubGluZSBib29sIGludGVsX2RzYl9kaXNhYmxlX2Vu
Z2luZShzdHJ1Y3QgaW50ZWxfZHNiICpkc2IpCj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjID0gY29udGFpbmVyX29mKGRzYiwgdHlwZW9mKCpjcnRjKSwgZHNiKTsKPiArCXN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlID0KPiArCQljb250YWluZXJfb2YoZHNiLCB0eXBl
b2YoKmNydGNfc3RhdGUpLCBkc2IpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19p
bnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCWVudW0gcGlwZSBw
aXBlID0gY3J0Yy0+cGlwZTsKPiAgCXUzMiBkc2JfY3RybDsKPiBAQCAtODMsOTkgKzg5LDYgQEAg
c3RhdGljIGJvb2wgaW50ZWxfZHNiX2Rpc2FibGVfZW5naW5lKHN0cnVjdCBpbnRlbF9kc2IgKmRz
YikKPiAgCXJldHVybiB0cnVlOwo+ICB9Cj4gIAo+IC0vKioKPiAtICogaW50ZWxfZHNiX2dldCgp
IC0gQWxsb2NhdGUgRFNCIGNvbnRleHQgYW5kIHJldHVybiBhIERTQiBpbnN0YW5jZS4KPiAtICog
QGNydGM6IGludGVsX2NydGMgc3RydWN0dXJlIHRvIGdldCBwaXBlIGluZm8uCj4gLSAqCj4gLSAq
IFRoaXMgZnVuY3Rpb24gcHJvdmlkZXMgaGFuZGxlIG9mIGEgRFNCIGluc3RhbmNlLCBmb3IgdGhl
IGZ1cnRoZXIgRFNCCj4gLSAqIG9wZXJhdGlvbnMuCj4gLSAqCj4gLSAqIFJldHVybnM6IGFkZHJl
c3Mgb2YgSW50ZWxfZHNiIGluc3RhbmNlIHJlcXVlc3RlZCBmb3IuCj4gLSAqIEZhaWx1cmU6IFJl
dHVybnMgdGhlIHNhbWUgRFNCIGluc3RhbmNlLCBidXQgd2l0aG91dCBhIGNvbW1hbmQgYnVmZmVy
Lgo+IC0gKi8KPiAtCj4gLXN0cnVjdCBpbnRlbF9kc2IgKgo+IC1pbnRlbF9kc2JfZ2V0KHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjKQo+IC17Cj4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0
Yy0+YmFzZS5kZXY7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
ZGV2KTsKPiAtCXN0cnVjdCBpbnRlbF9kc2IgKmRzYiA9ICZjcnRjLT5kc2I7Cj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwo+IC0Jc3RydWN0IGk5MTVfdm1hICp2bWE7Cj4gLQl1
MzIgKmJ1ZjsKPiAtCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+IC0KPiAtCWlmICghSEFTX0RT
QihpOTE1KSkKPiAtCQlyZXR1cm4gZHNiOwo+IC0KPiAtCWlmIChkc2ItPnJlZmNvdW50KysgIT0g
MCkKPiAtCQlyZXR1cm4gZHNiOwo+IC0KPiAtCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dl
dCgmaTkxNS0+cnVudGltZV9wbSk7Cj4gLQo+IC0Jb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0
ZV9pbnRlcm5hbChpOTE1LCBEU0JfQlVGX1NJWkUpOwo+IC0JaWYgKElTX0VSUihvYmopKSB7Cj4g
LQkJZHJtX2VycigmaTkxNS0+ZHJtLCAiR2VtIG9iamVjdCBjcmVhdGlvbiBmYWlsZWRcbiIpOwo+
IC0JCWdvdG8gb3V0Owo+IC0JfQo+IC0KPiAtCXZtYSA9IGk5MTVfZ2VtX29iamVjdF9nZ3R0X3Bp
bihvYmosIE5VTEwsIDAsIDAsIDApOwo+IC0JaWYgKElTX0VSUih2bWEpKSB7Cj4gLQkJZHJtX2Vy
cigmaTkxNS0+ZHJtLCAiVm1hIGNyZWF0aW9uIGZhaWxlZFxuIik7Cj4gLQkJaTkxNV9nZW1fb2Jq
ZWN0X3B1dChvYmopOwo+IC0JCWdvdG8gb3V0Owo+IC0JfQo+IC0KPiAtCWJ1ZiA9IGk5MTVfZ2Vt
X29iamVjdF9waW5fbWFwKHZtYS0+b2JqLCBJOTE1X01BUF9XQyk7Cj4gLQlpZiAoSVNfRVJSKGJ1
ZikpIHsKPiAtCQlkcm1fZXJyKCZpOTE1LT5kcm0sICJDb21tYW5kIGJ1ZmZlciBjcmVhdGlvbiBm
YWlsZWRcbiIpOwo+IC0JCWdvdG8gb3V0Owo+IC0JfQo+IC0KPiAtCWRzYi0+aWQgPSBEU0IxOwo+
IC0JZHNiLT52bWEgPSB2bWE7Cj4gLQlkc2ItPmNtZF9idWYgPSBidWY7Cj4gLQo+IC1vdXQ6Cj4g
LQkvKgo+IC0JICogT24gZXJyb3IgZHNiLT5jbWRfYnVmIHdpbGwgY29udGludWUgdG8gYmUgTlVM
TCwgbWFraW5nIHRoZSB3cml0ZXMKPiAtCSAqIHBhc3MtdGhyb3VnaC4gTGVhdmUgdGhlIGRhbmds
aW5nIHJlZiB0byBiZSByZW1vdmVkIGxhdGVyIGJ5IHRoZQo+IC0JICogY29ycmVzcG9uZGluZyBp
bnRlbF9kc2JfcHV0KCk6IHRoZSBpbXBvcnRhbnQgZXJyb3IgbWVzc2FnZSB3aWxsCj4gLQkgKiBh
bHJlYWR5IGJlIGxvZ2dlZCBhYm92ZS4KPiAtCSAqLwo+IC0KPiAtCWludGVsX3J1bnRpbWVfcG1f
cHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKPiAtCj4gLQlyZXR1cm4gZHNiOwo+IC19
Cj4gLQo+IC0vKioKPiAtICogaW50ZWxfZHNiX3B1dCgpIC0gVG8gZGVzdHJveSBEU0IgY29udGV4
dC4KPiAtICogQGRzYjogaW50ZWxfZHNiIHN0cnVjdHVyZS4KPiAtICoKPiAtICogVGhpcyBmdW5j
dGlvbiBkZXN0cm95cyB0aGUgRFNCIGNvbnRleHQgYWxsb2NhdGVkIGJ5IGEgZHNiX2dldCgpLCBi
eQo+IC0gKiB1bnBpbm5pbmcgYW5kIHJlbGVhc2luZyB0aGUgVk1BIG9iamVjdCBhc3NvY2lhdGVk
IHdpdGggaXQuCj4gLSAqLwo+IC0KPiAtdm9pZCBpbnRlbF9kc2JfcHV0KHN0cnVjdCBpbnRlbF9k
c2IgKmRzYikKPiAtewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSBjb250YWluZXJfb2Yo
ZHNiLCB0eXBlb2YoKmNydGMpLCBkc2IpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAtCj4gLQlpZiAoIUhBU19EU0IoaTkxNSkp
Cj4gLQkJcmV0dXJuOwo+IC0KPiAtCWlmIChkcm1fV0FSTl9PTigmaTkxNS0+ZHJtLCBkc2ItPnJl
ZmNvdW50ID09IDApKQo+IC0JCXJldHVybjsKPiAtCj4gLQlpZiAoLS1kc2ItPnJlZmNvdW50ID09
IDApIHsKPiAtCQlpOTE1X3ZtYV91bnBpbl9hbmRfcmVsZWFzZSgmZHNiLT52bWEsIEk5MTVfVk1B
X1JFTEVBU0VfTUFQKTsKPiAtCQlkc2ItPmNtZF9idWYgPSBOVUxMOwo+IC0JCWRzYi0+ZnJlZV9w
b3MgPSAwOwo+IC0JCWRzYi0+aW5zX3N0YXJ0X29mZnNldCA9IDA7Cj4gLQl9Cj4gLX0KPiAtCj4g
IC8qKgo+ICAgKiBpbnRlbF9kc2JfaW5kZXhlZF9yZWdfd3JpdGUoKSAtV3JpdGUgdG8gdGhlIERT
QiBjb250ZXh0IGZvciBhdXRvCj4gICAqIGluY3JlbWVudCByZWdpc3Rlci4KPiBAQCAtMTkyLDcg
KzEwNSw5IEBAIHZvaWQgaW50ZWxfZHNiX3B1dChzdHJ1Y3QgaW50ZWxfZHNiICpkc2IpCj4gIHZv
aWQgaW50ZWxfZHNiX2luZGV4ZWRfcmVnX3dyaXRlKHN0cnVjdCBpbnRlbF9kc2IgKmRzYiwgaTkx
NV9yZWdfdCByZWcsCj4gIAkJCQkgdTMyIHZhbCkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMg
KmNydGMgPSBjb250YWluZXJfb2YoZHNiLCB0eXBlb2YoKmNydGMpLCBkc2IpOwo+ICsJc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUgPQo+ICsJCWNvbnRhaW5lcl9vZihkc2IsIHR5
cGVvZigqY3J0Y19zdGF0ZSksIGRzYik7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRv
X2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAJdTMyICpidWYg
PSBkc2ItPmNtZF9idWY7Cj4gIAl1MzIgcmVnX3ZhbDsKPiBAQCAtMjY3LDcgKzE4Miw5IEBAIHZv
aWQgaW50ZWxfZHNiX2luZGV4ZWRfcmVnX3dyaXRlKHN0cnVjdCBpbnRlbF9kc2IgKmRzYiwgaTkx
NV9yZWdfdCByZWcsCj4gICAqLwo+ICB2b2lkIGludGVsX2RzYl9yZWdfd3JpdGUoc3RydWN0IGlu
dGVsX2RzYiAqZHNiLCBpOTE1X3JlZ190IHJlZywgdTMyIHZhbCkKPiAgewo+IC0Jc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSBjb250YWluZXJfb2YoZHNiLCB0eXBlb2YoKmNydGMpLCBkc2IpOwo+
ICsJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUgPQo+ICsJCWNvbnRhaW5lcl9v
Zihkc2IsIHR5cGVvZigqY3J0Y19zdGF0ZSksIGRzYik7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAJ
dTMyICpidWYgPSBkc2ItPmNtZF9idWY7Cj4gIAo+IEBAIC0yOTcsNyArMjE0LDkgQEAgdm9pZCBp
bnRlbF9kc2JfcmVnX3dyaXRlKHN0cnVjdCBpbnRlbF9kc2IgKmRzYiwgaTkxNV9yZWdfdCByZWcs
IHUzMiB2YWwpCj4gICAqLwo+ICB2b2lkIGludGVsX2RzYl9jb21taXQoc3RydWN0IGludGVsX2Rz
YiAqZHNiKQo+ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IGNvbnRhaW5lcl9vZihk
c2IsIHR5cGVvZigqY3J0YyksIGRzYik7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSA9Cj4gKwkJY29udGFpbmVyX29mKGRzYiwgdHlwZW9mKCpjcnRjX3N0YXRlKSwgZHNi
KTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRl
LT51YXBpLmNydGMpOwpQbGVhc2UgcGFzcyBjcnRjX3N0YXRlIGluc3RlYWQgdG8gYWxsIGZ1bmN0
aW9ucyBhYm92ZS4gOikKPiAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5iYXNlLmRl
djsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsK
PiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiBAQCAtMzQzLDMgKzI2Miw4NyBAQCB2
b2lkIGludGVsX2RzYl9jb21taXQoc3RydWN0IGludGVsX2RzYiAqZHNiKQo+ICAJZHNiLT5pbnNf
c3RhcnRfb2Zmc2V0ID0gMDsKPiAgCWludGVsX2RzYl9kaXNhYmxlX2VuZ2luZShkc2IpOwo+ICB9
Cj4gKwo+ICsvKioKPiArICogaW50ZWxfZHNiX3ByZXBhcmUoKSAtIEFsbG9jYXRlLCBwaW4gYW5k
IG1hcCB0aGUgRFNCIGNvbW1hbmQgYnVmZmVyLgo+ICsgKiBAY3J0Y19zdGF0ZTogaW50ZWxfY3J0
Y19zdGF0ZSBzdHJ1Y3R1cmUgdG8gcHJlcGFyZSBhc3NvY2lhdGVkIGRzYiBpbnN0YW5jZS4KPiAr
ICoKPiArICogVGhpcyBmdW5jdGlvbiBwcmVwYXJlIHRoZSBjb21tYW5kIGJ1ZmZlciB3aGljaCBp
cyB1c2VkIHRvIHN0b3JlIGRzYgo+ICsgKiBpbnN0cnVjdGlvbnMgd2l0aCBkYXRhLgo+ICsgKi8K
PiArCj4gK3ZvaWQgaW50ZWxfZHNiX3ByZXBhcmUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUpCj4gK3sKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0
YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXN0cnVjdCBpbnRlbF9kc2IgKmRzYiA9
ICZjcnRjX3N0YXRlLT5kc2I7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwo+
ICsJc3RydWN0IGk5MTVfdm1hICp2bWE7Cj4gKwl1MzIgKmJ1ZjsKPiArCWludGVsX3dha2VyZWZf
dCB3YWtlcmVmOwo+ICsKPiArCWlmICghSEFTX0RTQihpOTE1KSB8fCBkc2ItPmNtZF9idWYpCj4g
KwkJcmV0dXJuOwo+ICsKPiArCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+
cnVudGltZV9wbSk7Cj4gKwo+ICsJb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5h
bChpOTE1LCBEU0JfQlVGX1NJWkUpOwo+ICsJaWYgKElTX0VSUihvYmopKSB7Cj4gKwkJZHJtX2Vy
cigmaTkxNS0+ZHJtLCAiR2VtIG9iamVjdCBjcmVhdGlvbiBmYWlsZWRcbiIpOwo+ICsJCWdvdG8g
b3V0Owo+ICsJfQo+ICsKPiArCXZtYSA9IGk5MTVfZ2VtX29iamVjdF9nZ3R0X3BpbihvYmosIE5V
TEwsIDAsIDAsIDApOwo+ICsJaWYgKElTX0VSUih2bWEpKSB7Cj4gKwkJZHJtX2VycigmaTkxNS0+
ZHJtLCAiVm1hIGNyZWF0aW9uIGZhaWxlZFxuIik7Cj4gKwkJaTkxNV9nZW1fb2JqZWN0X3B1dChv
YmopOwo+ICsJCWdvdG8gb3V0Owo+ICsJfQo+ICsKPiArCWJ1ZiA9IGk5MTVfZ2VtX29iamVjdF9w
aW5fbWFwKHZtYS0+b2JqLCBJOTE1X01BUF9XQyk7Cj4gKwlpZiAoSVNfRVJSKGJ1ZikpIHsKPiAr
CQlkcm1fZXJyKCZpOTE1LT5kcm0sICJDb21tYW5kIGJ1ZmZlciBjcmVhdGlvbiBmYWlsZWRcbiIp
Owo+ICsJCWdvdG8gb3V0Owo+ICsJfQo+ICsKPiArCWRzYi0+aWQgPSBEU0IxOwo+ICsJZHNiLT52
bWEgPSB2bWE7Cj4gKwlkc2ItPmNtZF9idWYgPSBidWY7Cj4gKwo+ICtvdXQ6Cj4gKwkvKgo+ICsJ
ICogT24gZXJyb3IgZHNiLT5jbWRfYnVmIHdpbGwgY29udGludWUgdG8gYmUgTlVMTCwgbWFraW5n
IHRoZSB3cml0ZXMKPiArCSAqIHBhc3MtdGhyb3VnaC4gTGVhdmUgdGhlIGRhbmdsaW5nIHJlZiB0
byBiZSByZW1vdmVkIGxhdGVyIGJ5IHRoZQo+ICsJICogY29ycmVzcG9uZGluZyBpbnRlbF9kc2Jf
cHV0KCk6IHRoZSBpbXBvcnRhbnQgZXJyb3IgbWVzc2FnZSB3aWxsCj4gKwkgKiBhbHJlYWR5IGJl
IGxvZ2dlZCBhYm92ZS4KPiArCSAqLwo+ICsKPiArCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1
LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKPiArfQo+ICsKPiArLyoqCj4gKyAqIGludGVsX2RzYl9j
bGVhbnVwKCkgLSBUbyBjbGVhbnVwIERTQiBjb250ZXh0Lgo+ICsgKiBAY3J0Y19zdGF0ZTogaW50
ZWxfY3J0Y19zdGF0ZSBzdHJ1Y3R1cmUgdG8gY2xlYW51cCBhc3NvY2lhdGVkIGRzYiBpbnN0YW5j
ZS4KPiArICoKPiArICogVGhpcyBmdW5jdGlvbiBjbGVhbnVwIHRoZSBEU0IgY29udGV4dCBieSB1
bnBpbm5pbmcgYW5kIHJlbGVhc2luZwo+ICsgKiB0aGUgVk1BIG9iamVjdCBhc3NvY2lhdGVkIHdp
dGggaXQuCj4gKyAqLwo+ICsKPiArdm9pZCBpbnRlbF9kc2JfY2xlYW51cChzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiArewo+ICsJc3RydWN0IGludGVsX2RzYiAqZHNiID0g
JmNydGNfc3RhdGUtPmRzYjsKPiArCXN0cnVjdCBpOTE1X3ZtYSAqcF92bWE7Cj4gKwo+ICsJaWYg
KGRzYi0+dm1hKSB7Cj4gKwkJcF92bWEgPSBmZXRjaF9hbmRfemVybygmZHNiLT52bWEpOwo+ICsJ
CWlmIChwX3ZtYSkgewo+ICsJCQlpOTE1X3ZtYV91bnBpbihwX3ZtYSk7Cj4gKwkJCWk5MTVfZ2Vt
X29iamVjdF91bnBpbl9tYXAocF92bWEtPm9iaik7Cj4gKwkJCWk5MTVfZ2VtX29iamVjdF9wdXQo
cF92bWEtPm9iaik7Cj4gKwkJfQo+ICsJCWRzYi0+dm1hID0gTlVMTDsKPiArCQlkc2ItPmNtZF9i
dWYgPSBOVUxMOwo+ICsJCWRzYi0+ZnJlZV9wb3MgPSAwOwo+ICsJCWRzYi0+aW5zX3N0YXJ0X29m
ZnNldCA9IDA7Cj4gKwl9Cj4gK30KCkkgd291bGQgc2ltcGxpZnkgY2xlYW51cCB0byB2bWEgPSBm
ZXRjaF9hbmRfemVybygmZHNiLT52bWEpOyBpZiAoIXZtYSkgcmV0dXJuOyBhbmQgdGhlbiBvbmx5
IGNhbGwgdGhlIHZtYS9nZW0gZnVuY3Rpb25zIHRvIGNsZWFuIHVwLiBObyBuZWVkIHRvIGZpeCB0
aGUgb3RoZXIgc3R1ZmYgaGVyZSBhcyB0aGUgc3RydWN0IGlzIGJlaW5nIGZyZWVkLgoKQ291bGQg
cHJvYmFibHkgZHJvcCB0aGUgZmV0Y2hfYW5kX3plcm8gYXMgd2VsbCwgYnV0IHdvdWxkbid0IGh1
cnQgZm9yIHBhcmFub2lhLiA6KQoKT3RoZXJ3aXNlIGxvb2tzIGdvb2Qgbm93LCBvbmx5IGZldyB0
d2Vha3MgYXJlIG5lZWRlZCBmb3IgdGhlIHBhdGNoIHRvIGJlIHJlYWR5IQoKfk1hYXJ0ZW4KCgo+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RzYi5oIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kc2IuaAo+IGluZGV4IDM5NWVmOWNl
NTU4ZS4uM2EyMGE0Mzg4YjlhIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfZHNiLmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX2RzYi5oCj4gQEAgLTEwLDcgKzEwLDcgQEAKPiAgCj4gICNpbmNsdWRlICJpOTE1X3JlZy5o
Igo+ICAKPiAtc3RydWN0IGludGVsX2NydGM7Cj4gK3N0cnVjdCBpbnRlbF9jcnRjX3N0YXRlOwo+
ICBzdHJ1Y3QgaTkxNV92bWE7Cj4gIAo+ICBlbnVtIGRzYl9pZCB7Cj4gQEAgLTIyLDcgKzIyLDYg
QEAgZW51bSBkc2JfaWQgewo+ICB9Owo+ICAKPiAgc3RydWN0IGludGVsX2RzYiB7Cj4gLQlsb25n
IHJlZmNvdW50Owo+ICAJZW51bSBkc2JfaWQgaWQ7Cj4gIAl1MzIgKmNtZF9idWY7Cj4gIAlzdHJ1
Y3QgaTkxNV92bWEgKnZtYTsKPiBAQCAtNDEsOSArNDAsOCBAQCBzdHJ1Y3QgaW50ZWxfZHNiIHsK
PiAgCXUzMiBpbnNfc3RhcnRfb2Zmc2V0Owo+ICB9Owo+ICAKPiAtc3RydWN0IGludGVsX2RzYiAq
Cj4gLWludGVsX2RzYl9nZXQoc3RydWN0IGludGVsX2NydGMgKmNydGMpOwo+IC12b2lkIGludGVs
X2RzYl9wdXQoc3RydWN0IGludGVsX2RzYiAqZHNiKTsKPiArdm9pZCBpbnRlbF9kc2JfcHJlcGFy
ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7Cj4gK3ZvaWQgaW50ZWxfZHNi
X2NsZWFudXAoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpOwo+ICB2b2lkIGlu
dGVsX2RzYl9yZWdfd3JpdGUoc3RydWN0IGludGVsX2RzYiAqZHNiLCBpOTE1X3JlZ190IHJlZywg
dTMyIHZhbCk7Cj4gIHZvaWQgaW50ZWxfZHNiX2luZGV4ZWRfcmVnX3dyaXRlKHN0cnVjdCBpbnRl
bF9kc2IgKmRzYiwgaTkxNV9yZWdfdCByZWcsCj4gIAkJCQkgdTMyIHZhbCk7CgoKX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcg
bGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRl
c2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4Cg==

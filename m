Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 6C45E4C4B2
	for <lists+intel-gfx@lfdr.de>; Thu, 20 Jun 2019 03:00:48 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 685AB6E4A2;
	Thu, 20 Jun 2019 01:00:45 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga01.intel.com (mga01.intel.com [192.55.52.88])
 by gabe.freedesktop.org (Postfix) with ESMTPS id BD5736E4A1
 for <intel-gfx@lists.freedesktop.org>; Thu, 20 Jun 2019 01:00:42 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga007.jf.intel.com ([10.7.209.58])
 by fmsmga101.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 19 Jun 2019 18:00:42 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,394,1557212400"; d="scan'208";a="150774353"
Received: from dceraolo-linux.fm.intel.com ([10.1.27.145])
 by orsmga007.jf.intel.com with ESMTP; 19 Jun 2019 18:00:42 -0700
From: Daniele Ceraolo Spurio <daniele.ceraolospurio@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 19 Jun 2019 18:00:16 -0700
Message-Id: <20190620010021.20637-2-daniele.ceraolospurio@intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190620010021.20637-1-daniele.ceraolospurio@intel.com>
References: <20190620010021.20637-1-daniele.ceraolospurio@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v2 1/6] drm/i915: use vfuncs for
 reg_read/write_fw_domains
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

SW5zdGVhZCBvZiBnb2luZyB0aHJvdWdoIHRoZSBpZi1lbHNlIGNoYWluIGV2ZXJ5IHRpbWUsIGxl
dCdzIHNhdmUgdGhlCmZ1bmN0aW9uIGluIHRoZSB1bmNvcmUgc3RydWN0dXJlLiBOb3RlIHRoYXQg
dGhlIG5ldyBmdW5jdGlvbnMgYXJlCnB1cnBvc2VseSBub3QgdXNlZCBmcm9tIHRoZSByZWcgcmVh
ZC93cml0ZSBmdW5jdGlvbnMgdG8ga2VlcCB0aGUKaW5saW5pbmcgdGhlcmUuCgpXaGlsZSBhdCBp
dCwgdXNlIHRoZSBuZXcgbWFjcm8gdG8gY2FsbCB0aGUgb2xkIG9uZXMgdG8gY2xlYW4gdGhlIGNv
ZGUgYQpiaXQuCgp2MjogUmVuYW1lIG1hY3JvcyBmb3Igbm8tZm9yY2V3YWtlIGZ1bmN0aW9uIGFz
c2lnbm1lbnQgKFR2cnRrbykKClNpZ25lZC1vZmYtYnk6IERhbmllbGUgQ2VyYW9sbyBTcHVyaW8g
PGRhbmllbGUuY2VyYW9sb3NwdXJpb0BpbnRlbC5jb20+CkNjOiBUdnJ0a28gVXJzdWxpbiA8dHZy
dGtvLnVyc3VsaW5AbGludXguaW50ZWwuY29tPgpSZXZpZXdlZC1ieTogVHZydGtvIFVyc3VsaW4g
PHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF91bmNvcmUuYyAgICAgICAgICB8IDE3MiArKysrKysrKy0tLS0tLS0tLS0tCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF91bmNvcmUuaCAgICAgICAgICB8ICAgNSArCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9zZWxmdGVzdHMvbW9ja191bmNvcmUuYyB8ICAgNCArLQogMyBmaWxlcyBjaGFuZ2Vk
LCA3NSBpbnNlcnRpb25zKCspLCAxMDYgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfdW5jb3JlLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF91bmNvcmUuYwppbmRleCBkYTMzYWE2NzJjM2QuLjhlNTcxNmJjNTNlMiAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdW5jb3JlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfdW5jb3JlLmMKQEAgLTkwMSw2ICs5MDEsMTIgQEAgc3RhdGljIGJvb2wgaXNf
Z2VuIyN4IyNfc2hhZG93ZWQodTMyIG9mZnNldCkgXAogX19pc19nZW5YX3NoYWRvd2VkKDgpCiBf
X2lzX2dlblhfc2hhZG93ZWQoMTEpCiAKK3N0YXRpYyBlbnVtIGZvcmNld2FrZV9kb21haW5zCitn
ZW42X3JlZ193cml0ZV9md19kb21haW5zKHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSwgaTkx
NV9yZWdfdCByZWcpCit7CisJcmV0dXJuIEZPUkNFV0FLRV9SRU5ERVI7Cit9CisKICNkZWZpbmUg
X19nZW44X3JlZ193cml0ZV9md19kb21haW5zKHVuY29yZSwgb2Zmc2V0KSBcCiAoeyBcCiAJZW51
bSBmb3JjZXdha2VfZG9tYWlucyBfX2Z3ZDsgXApAQCAtMTE0NSwyNiArMTE1MSwyMyBAQCBmdW5j
IyNfcmVhZCMjeChzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUsIGk5MTVfcmVnX3QgcmVnLCBi
b29sIHRyYWNlKSB7IFwKIAl2YWwgPSBfX3Jhd191bmNvcmVfcmVhZCMjeCh1bmNvcmUsIHJlZyk7
IFwKIAlHRU42X1JFQURfRk9PVEVSOyBcCiB9Ci0jZGVmaW5lIF9fZ2VuNl9yZWFkKHgpIF9fZ2Vu
X3JlYWQoZ2VuNiwgeCkKLSNkZWZpbmUgX19md3RhYmxlX3JlYWQoeCkgX19nZW5fcmVhZChmd3Rh
YmxlLCB4KQotI2RlZmluZSBfX2dlbjExX2Z3dGFibGVfcmVhZCh4KSBfX2dlbl9yZWFkKGdlbjEx
X2Z3dGFibGUsIHgpCi0KLV9fZ2VuMTFfZnd0YWJsZV9yZWFkKDgpCi1fX2dlbjExX2Z3dGFibGVf
cmVhZCgxNikKLV9fZ2VuMTFfZnd0YWJsZV9yZWFkKDMyKQotX19nZW4xMV9md3RhYmxlX3JlYWQo
NjQpCi1fX2Z3dGFibGVfcmVhZCg4KQotX19md3RhYmxlX3JlYWQoMTYpCi1fX2Z3dGFibGVfcmVh
ZCgzMikKLV9fZnd0YWJsZV9yZWFkKDY0KQotX19nZW42X3JlYWQoOCkKLV9fZ2VuNl9yZWFkKDE2
KQotX19nZW42X3JlYWQoMzIpCi1fX2dlbjZfcmVhZCg2NCkKLQotI3VuZGVmIF9fZ2VuMTFfZnd0
YWJsZV9yZWFkCi0jdW5kZWYgX19md3RhYmxlX3JlYWQKLSN1bmRlZiBfX2dlbjZfcmVhZAorCisj
ZGVmaW5lIF9fZ2VuX3JlZ19yZWFkX2Z1bmNzKGZ1bmMpIFwKK3N0YXRpYyBlbnVtIGZvcmNld2Fr
ZV9kb21haW5zIFwKK2Z1bmMjI19yZWdfcmVhZF9md19kb21haW5zKHN0cnVjdCBpbnRlbF91bmNv
cmUgKnVuY29yZSwgaTkxNV9yZWdfdCByZWcpIHsgXAorCXJldHVybiBfXyMjZnVuYyMjX3JlZ19y
ZWFkX2Z3X2RvbWFpbnModW5jb3JlLCBpOTE1X21taW9fcmVnX29mZnNldChyZWcpKTsgXAorfSBc
CitcCitfX2dlbl9yZWFkKGZ1bmMsIDgpIFwKK19fZ2VuX3JlYWQoZnVuYywgMTYpIFwKK19fZ2Vu
X3JlYWQoZnVuYywgMzIpIFwKK19fZ2VuX3JlYWQoZnVuYywgNjQpCisKK19fZ2VuX3JlZ19yZWFk
X2Z1bmNzKGdlbjExX2Z3dGFibGUpOworX19nZW5fcmVnX3JlYWRfZnVuY3MoZnd0YWJsZSk7Citf
X2dlbl9yZWdfcmVhZF9mdW5jcyhnZW42KTsKKworI3VuZGVmIF9fZ2VuX3JlZ19yZWFkX2Z1bmNz
CiAjdW5kZWYgR0VONl9SRUFEX0ZPT1RFUgogI3VuZGVmIEdFTjZfUkVBRF9IRUFERVIKIApAQCAt
MTIyNSw2ICsxMjI4LDkgQEAgZ2VuNl93cml0ZSMjeChzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNv
cmUsIGk5MTVfcmVnX3QgcmVnLCB1IyN4IHZhbCwgYm9vbCB0cmFjZSkKIAlfX3Jhd191bmNvcmVf
d3JpdGUjI3godW5jb3JlLCByZWcsIHZhbCk7IFwKIAlHRU42X1dSSVRFX0ZPT1RFUjsgXAogfQor
X19nZW42X3dyaXRlKDgpCitfX2dlbjZfd3JpdGUoMTYpCitfX2dlbjZfd3JpdGUoMzIpCiAKICNk
ZWZpbmUgX19nZW5fd3JpdGUoZnVuYywgeCkgXAogc3RhdGljIHZvaWQgXApAQCAtMTIzNywzOCAr
MTI0MywzMyBAQCBmdW5jIyNfd3JpdGUjI3goc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlLCBp
OTE1X3JlZ190IHJlZywgdSMjeCB2YWwsIGJvb2wgdHJhYwogCV9fcmF3X3VuY29yZV93cml0ZSMj
eCh1bmNvcmUsIHJlZywgdmFsKTsgXAogCUdFTjZfV1JJVEVfRk9PVEVSOyBcCiB9Ci0jZGVmaW5l
IF9fZ2VuOF93cml0ZSh4KSBfX2dlbl93cml0ZShnZW44LCB4KQotI2RlZmluZSBfX2Z3dGFibGVf
d3JpdGUoeCkgX19nZW5fd3JpdGUoZnd0YWJsZSwgeCkKLSNkZWZpbmUgX19nZW4xMV9md3RhYmxl
X3dyaXRlKHgpIF9fZ2VuX3dyaXRlKGdlbjExX2Z3dGFibGUsIHgpCi0KLV9fZ2VuMTFfZnd0YWJs
ZV93cml0ZSg4KQotX19nZW4xMV9md3RhYmxlX3dyaXRlKDE2KQotX19nZW4xMV9md3RhYmxlX3dy
aXRlKDMyKQotX19md3RhYmxlX3dyaXRlKDgpCi1fX2Z3dGFibGVfd3JpdGUoMTYpCi1fX2Z3dGFi
bGVfd3JpdGUoMzIpCi1fX2dlbjhfd3JpdGUoOCkKLV9fZ2VuOF93cml0ZSgxNikKLV9fZ2VuOF93
cml0ZSgzMikKLV9fZ2VuNl93cml0ZSg4KQotX19nZW42X3dyaXRlKDE2KQotX19nZW42X3dyaXRl
KDMyKQogCi0jdW5kZWYgX19nZW4xMV9md3RhYmxlX3dyaXRlCi0jdW5kZWYgX19md3RhYmxlX3dy
aXRlCi0jdW5kZWYgX19nZW44X3dyaXRlCi0jdW5kZWYgX19nZW42X3dyaXRlCisjZGVmaW5lIF9f
Z2VuX3JlZ193cml0ZV9mdW5jcyhmdW5jKSBcCitzdGF0aWMgZW51bSBmb3JjZXdha2VfZG9tYWlu
cyBcCitmdW5jIyNfcmVnX3dyaXRlX2Z3X2RvbWFpbnMoc3RydWN0IGludGVsX3VuY29yZSAqdW5j
b3JlLCBpOTE1X3JlZ190IHJlZykgeyBcCisJcmV0dXJuIF9fIyNmdW5jIyNfcmVnX3dyaXRlX2Z3
X2RvbWFpbnModW5jb3JlLCBpOTE1X21taW9fcmVnX29mZnNldChyZWcpKTsgXAorfSBcCitcCitf
X2dlbl93cml0ZShmdW5jLCA4KSBcCitfX2dlbl93cml0ZShmdW5jLCAxNikgXAorX19nZW5fd3Jp
dGUoZnVuYywgMzIpCisKK19fZ2VuX3JlZ193cml0ZV9mdW5jcyhnZW4xMV9md3RhYmxlKTsKK19f
Z2VuX3JlZ193cml0ZV9mdW5jcyhmd3RhYmxlKTsKK19fZ2VuX3JlZ193cml0ZV9mdW5jcyhnZW44
KTsKKworI3VuZGVmIF9fZ2VuX3JlZ193cml0ZV9mdW5jcwogI3VuZGVmIEdFTjZfV1JJVEVfRk9P
VEVSCiAjdW5kZWYgR0VONl9XUklURV9IRUFERVIKIAotI2RlZmluZSBBU1NJR05fV1JJVEVfTU1J
T19WRlVOQ1ModW5jb3JlLCB4KSBcCisjZGVmaW5lIEFTU0lHTl9SQVdfV1JJVEVfTU1JT19WRlVO
Q1ModW5jb3JlLCB4KSBcCiBkbyB7IFwKIAkodW5jb3JlKS0+ZnVuY3MubW1pb193cml0ZWIgPSB4
IyNfd3JpdGU4OyBcCiAJKHVuY29yZSktPmZ1bmNzLm1taW9fd3JpdGV3ID0geCMjX3dyaXRlMTY7
IFwKIAkodW5jb3JlKS0+ZnVuY3MubW1pb193cml0ZWwgPSB4IyNfd3JpdGUzMjsgXAogfSB3aGls
ZSAoMCkKIAotI2RlZmluZSBBU1NJR05fUkVBRF9NTUlPX1ZGVU5DUyh1bmNvcmUsIHgpIFwKKyNk
ZWZpbmUgQVNTSUdOX1JBV19SRUFEX01NSU9fVkZVTkNTKHVuY29yZSwgeCkgXAogZG8geyBcCiAJ
KHVuY29yZSktPmZ1bmNzLm1taW9fcmVhZGIgPSB4IyNfcmVhZDg7IFwKIAkodW5jb3JlKS0+ZnVu
Y3MubW1pb19yZWFkdyA9IHgjI19yZWFkMTY7IFwKQEAgLTEyNzYsNiArMTI3NywxNyBAQCBkbyB7
IFwKIAkodW5jb3JlKS0+ZnVuY3MubW1pb19yZWFkcSA9IHgjI19yZWFkNjQ7IFwKIH0gd2hpbGUg
KDApCiAKKyNkZWZpbmUgQVNTSUdOX1dSSVRFX01NSU9fVkZVTkNTKHVuY29yZSwgeCkgXAorZG8g
eyBcCisJQVNTSUdOX1JBV19XUklURV9NTUlPX1ZGVU5DUygodW5jb3JlKSwgeCk7IFwKKwkodW5j
b3JlKS0+ZnVuY3Mud3JpdGVfZndfZG9tYWlucyA9IHgjI19yZWdfd3JpdGVfZndfZG9tYWluczsg
XAorfSB3aGlsZSAoMCkKKworI2RlZmluZSBBU1NJR05fUkVBRF9NTUlPX1ZGVU5DUyh1bmNvcmUs
IHgpIFwKK2RvIHsgXAorCUFTU0lHTl9SQVdfUkVBRF9NTUlPX1ZGVU5DUyh1bmNvcmUsIHgpOyBc
CisJKHVuY29yZSktPmZ1bmNzLnJlYWRfZndfZG9tYWlucyA9IHgjI19yZWdfcmVhZF9md19kb21h
aW5zOyBcCit9IHdoaWxlICgwKQogCiBzdGF0aWMgdm9pZCBmd19kb21haW5faW5pdChzdHJ1Y3Qg
aW50ZWxfdW5jb3JlICp1bmNvcmUsCiAJCQkgICBlbnVtIGZvcmNld2FrZV9kb21haW5faWQgZG9t
YWluX2lkLApAQCAtMTU1OSwxMSArMTU3MSwxMSBAQCBpbnQgaW50ZWxfdW5jb3JlX2luaXRfbW1p
byhzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUpCiAKIAlpZiAoIWludGVsX3VuY29yZV9oYXNf
Zm9yY2V3YWtlKHVuY29yZSkpIHsKIAkJaWYgKElTX0dFTihpOTE1LCA1KSkgewotCQkJQVNTSUdO
X1dSSVRFX01NSU9fVkZVTkNTKHVuY29yZSwgZ2VuNSk7Ci0JCQlBU1NJR05fUkVBRF9NTUlPX1ZG
VU5DUyh1bmNvcmUsIGdlbjUpOworCQkJQVNTSUdOX1JBV19XUklURV9NTUlPX1ZGVU5DUyh1bmNv
cmUsIGdlbjUpOworCQkJQVNTSUdOX1JBV19SRUFEX01NSU9fVkZVTkNTKHVuY29yZSwgZ2VuNSk7
CiAJCX0gZWxzZSB7Ci0JCQlBU1NJR05fV1JJVEVfTU1JT19WRlVOQ1ModW5jb3JlLCBnZW4yKTsK
LQkJCUFTU0lHTl9SRUFEX01NSU9fVkZVTkNTKHVuY29yZSwgZ2VuMik7CisJCQlBU1NJR05fUkFX
X1dSSVRFX01NSU9fVkZVTkNTKHVuY29yZSwgZ2VuMik7CisJCQlBU1NJR05fUkFXX1JFQURfTU1J
T19WRlVOQ1ModW5jb3JlLCBnZW4yKTsKIAkJfQogCX0gZWxzZSBpZiAoSVNfR0VOX1JBTkdFKGk5
MTUsIDYsIDcpKSB7CiAJCUFTU0lHTl9XUklURV9NTUlPX1ZGVU5DUyh1bmNvcmUsIGdlbjYpOwpA
QCAtMTU5NCw2ICsxNjA2LDEyIEBAIGludCBpbnRlbF91bmNvcmVfaW5pdF9tbWlvKHN0cnVjdCBp
bnRlbF91bmNvcmUgKnVuY29yZSkKIAkJQVNTSUdOX1JFQURfTU1JT19WRlVOQ1ModW5jb3JlLCBn
ZW4xMV9md3RhYmxlKTsKIAl9CiAKKwkvKiBtYWtlIHN1cmUgZncgZnVuY3MgYXJlIHNldCBpZiBh
bmQgb25seSBpZiB3ZSBoYXZlIGZ3Ki8KKwlHRU1fQlVHX09OKGludGVsX3VuY29yZV9oYXNfZm9y
Y2V3YWtlKHVuY29yZSkgIT0gISF1bmNvcmUtPmZ1bmNzLmZvcmNlX3dha2VfZ2V0KTsKKwlHRU1f
QlVHX09OKGludGVsX3VuY29yZV9oYXNfZm9yY2V3YWtlKHVuY29yZSkgIT0gISF1bmNvcmUtPmZ1
bmNzLmZvcmNlX3dha2VfcHV0KTsKKwlHRU1fQlVHX09OKGludGVsX3VuY29yZV9oYXNfZm9yY2V3
YWtlKHVuY29yZSkgIT0gISF1bmNvcmUtPmZ1bmNzLnJlYWRfZndfZG9tYWlucyk7CisJR0VNX0JV
R19PTihpbnRlbF91bmNvcmVfaGFzX2ZvcmNld2FrZSh1bmNvcmUpICE9ICEhdW5jb3JlLT5mdW5j
cy53cml0ZV9md19kb21haW5zKTsKKwogCWlmIChIQVNfRlBHQV9EQkdfVU5DTEFJTUVEKGk5MTUp
KQogCQl1bmNvcmUtPmZsYWdzIHw9IFVOQ09SRV9IQVNfRlBHQV9EQkdfVU5DTEFJTUVEOwogCkBA
IC0xODcxLDYyICsxODg5LDYgQEAgaW50ZWxfdW5jb3JlX2FybV91bmNsYWltZWRfbW1pb19kZXRl
Y3Rpb24oc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlKQogCXJldHVybiByZXQ7CiB9CiAKLXN0
YXRpYyBlbnVtIGZvcmNld2FrZV9kb21haW5zCi1pbnRlbF91bmNvcmVfZm9yY2V3YWtlX2Zvcl9y
ZWFkKHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSwKLQkJCQlpOTE1X3JlZ190IHJlZykKLXsK
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHVuY29yZV90b19pOTE1KHVuY29yZSk7
Ci0JdTMyIG9mZnNldCA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KHJlZyk7Ci0JZW51bSBmb3JjZXdh
a2VfZG9tYWlucyBmd19kb21haW5zOwotCi0JaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkgewot
CQlmd19kb21haW5zID0gX19nZW4xMV9md3RhYmxlX3JlZ19yZWFkX2Z3X2RvbWFpbnModW5jb3Jl
LCBvZmZzZXQpOwotCX0gZWxzZSBpZiAoSEFTX0ZXVEFCTEUoaTkxNSkpIHsKLQkJZndfZG9tYWlu
cyA9IF9fZnd0YWJsZV9yZWdfcmVhZF9md19kb21haW5zKHVuY29yZSwgb2Zmc2V0KTsKLQl9IGVs
c2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA2KSB7Ci0JCWZ3X2RvbWFpbnMgPSBfX2dlbjZfcmVn
X3JlYWRfZndfZG9tYWlucyh1bmNvcmUsIG9mZnNldCk7Ci0JfSBlbHNlIHsKLQkJLyogb24gZGV2
aWNlcyB3aXRoIEZXIHdlIGV4cGVjdCB0byBoaXQgb25lIG9mIHRoZSBhYm92ZSBjYXNlcyAqLwot
CQlpZiAoaW50ZWxfdW5jb3JlX2hhc19mb3JjZXdha2UodW5jb3JlKSkKLQkJCU1JU1NJTkdfQ0FT
RShJTlRFTF9HRU4oaTkxNSkpOwotCi0JCWZ3X2RvbWFpbnMgPSAwOwotCX0KLQotCVdBUk5fT04o
ZndfZG9tYWlucyAmIH51bmNvcmUtPmZ3X2RvbWFpbnMpOwotCi0JcmV0dXJuIGZ3X2RvbWFpbnM7
Ci19Ci0KLXN0YXRpYyBlbnVtIGZvcmNld2FrZV9kb21haW5zCi1pbnRlbF91bmNvcmVfZm9yY2V3
YWtlX2Zvcl93cml0ZShzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUsCi0JCQkJIGk5MTVfcmVn
X3QgcmVnKQotewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdW5jb3JlX3RvX2k5
MTUodW5jb3JlKTsKLQl1MzIgb2Zmc2V0ID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQocmVnKTsKLQll
bnVtIGZvcmNld2FrZV9kb21haW5zIGZ3X2RvbWFpbnM7Ci0KLQlpZiAoSU5URUxfR0VOKGk5MTUp
ID49IDExKSB7Ci0JCWZ3X2RvbWFpbnMgPSBfX2dlbjExX2Z3dGFibGVfcmVnX3dyaXRlX2Z3X2Rv
bWFpbnModW5jb3JlLCBvZmZzZXQpOwotCX0gZWxzZSBpZiAoSEFTX0ZXVEFCTEUoaTkxNSkgJiYg
IUlTX1ZBTExFWVZJRVcoaTkxNSkpIHsKLQkJZndfZG9tYWlucyA9IF9fZnd0YWJsZV9yZWdfd3Jp
dGVfZndfZG9tYWlucyh1bmNvcmUsIG9mZnNldCk7Ci0JfSBlbHNlIGlmIChJU19HRU4oaTkxNSwg
OCkpIHsKLQkJZndfZG9tYWlucyA9IF9fZ2VuOF9yZWdfd3JpdGVfZndfZG9tYWlucyh1bmNvcmUs
IG9mZnNldCk7Ci0JfSBlbHNlIGlmIChJU19HRU5fUkFOR0UoaTkxNSwgNiwgNykpIHsKLQkJZndf
ZG9tYWlucyA9IEZPUkNFV0FLRV9SRU5ERVI7Ci0JfSBlbHNlIHsKLQkJLyogb24gZGV2aWNlcyB3
aXRoIEZXIHdlIGV4cGVjdCB0byBoaXQgb25lIG9mIHRoZSBhYm92ZSBjYXNlcyAqLwotCQlpZiAo
aW50ZWxfdW5jb3JlX2hhc19mb3JjZXdha2UodW5jb3JlKSkKLQkJCU1JU1NJTkdfQ0FTRShJTlRF
TF9HRU4oaTkxNSkpOwotCi0JCWZ3X2RvbWFpbnMgPSAwOwotCX0KLQotCVdBUk5fT04oZndfZG9t
YWlucyAmIH51bmNvcmUtPmZ3X2RvbWFpbnMpOwotCi0JcmV0dXJuIGZ3X2RvbWFpbnM7Ci19Ci0K
IC8qKgogICogaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9mb3JfcmVnIC0gd2hpY2ggZm9yY2V3YWtl
IGRvbWFpbnMgYXJlIG5lZWRlZCB0byBhY2Nlc3MKICAqIAkJCQkgICAgYSByZWdpc3RlcgpAQCAt
MTk1MywxMCArMTkxNSwxMiBAQCBpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2Zvcl9yZWcoc3RydWN0
IGludGVsX3VuY29yZSAqdW5jb3JlLAogCQlyZXR1cm4gMDsKIAogCWlmIChvcCAmIEZXX1JFR19S
RUFEKQotCQlmd19kb21haW5zID0gaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9mb3JfcmVhZCh1bmNv
cmUsIHJlZyk7CisJCWZ3X2RvbWFpbnMgPSB1bmNvcmUtPmZ1bmNzLnJlYWRfZndfZG9tYWlucyh1
bmNvcmUsIHJlZyk7CiAKIAlpZiAob3AgJiBGV19SRUdfV1JJVEUpCi0JCWZ3X2RvbWFpbnMgfD0g
aW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9mb3Jfd3JpdGUodW5jb3JlLCByZWcpOworCQlmd19kb21h
aW5zIHw9IHVuY29yZS0+ZnVuY3Mud3JpdGVfZndfZG9tYWlucyh1bmNvcmUsIHJlZyk7CisKKwlX
QVJOX09OKGZ3X2RvbWFpbnMgJiB+dW5jb3JlLT5md19kb21haW5zKTsKIAogCXJldHVybiBmd19k
b21haW5zOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdW5jb3Jl
LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91bmNvcmUuaAppbmRleCA4MDRhMGZhYWNj
OTEuLjRhZmRlMGM0NGZmZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
dW5jb3JlLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdW5jb3JlLmgKQEAgLTcw
LDYgKzcwLDExIEBAIHN0cnVjdCBpbnRlbF91bmNvcmVfZnVuY3MgewogCXZvaWQgKCpmb3JjZV93
YWtlX3B1dCkoc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlLAogCQkJICAgICAgIGVudW0gZm9y
Y2V3YWtlX2RvbWFpbnMgZG9tYWlucyk7CiAKKwllbnVtIGZvcmNld2FrZV9kb21haW5zICgqcmVh
ZF9md19kb21haW5zKShzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUsCisJCQkJCQkgIGk5MTVf
cmVnX3Qgcik7CisJZW51bSBmb3JjZXdha2VfZG9tYWlucyAoKndyaXRlX2Z3X2RvbWFpbnMpKHN0
cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSwKKwkJCQkJCSAgIGk5MTVfcmVnX3Qgcik7CisKIAl1
OCAoKm1taW9fcmVhZGIpKHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSwKIAkJCSBpOTE1X3Jl
Z190IHIsIGJvb2wgdHJhY2UpOwogCXUxNiAoKm1taW9fcmVhZHcpKHN0cnVjdCBpbnRlbF91bmNv
cmUgKnVuY29yZSwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9t
b2NrX3VuY29yZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfdW5jb3Jl
LmMKaW5kZXggZmY4OTk5YzYzYTEyLi40OTU4NWYxNmQ0YTIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX3VuY29yZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX3VuY29yZS5jCkBAIC00MSw2ICs0MSw2IEBAIF9fbm9wX3Jl
YWQoNjQpCiAKIHZvaWQgbW9ja191bmNvcmVfaW5pdChzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNv
cmUpCiB7Ci0JQVNTSUdOX1dSSVRFX01NSU9fVkZVTkNTKHVuY29yZSwgbm9wKTsKLQlBU1NJR05f
UkVBRF9NTUlPX1ZGVU5DUyh1bmNvcmUsIG5vcCk7CisJQVNTSUdOX1JBV19XUklURV9NTUlPX1ZG
VU5DUyh1bmNvcmUsIG5vcCk7CisJQVNTSUdOX1JBV19SRUFEX01NSU9fVkZVTkNTKHVuY29yZSwg
bm9wKTsKIH0KLS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRl
c2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8v
aW50ZWwtZ2Z4

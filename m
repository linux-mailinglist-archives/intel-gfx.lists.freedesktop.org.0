Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 3B9642A0BB1
	for <lists+intel-gfx@lfdr.de>; Fri, 30 Oct 2020 17:50:58 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8FAE26E9D6;
	Fri, 30 Oct 2020 16:50:56 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga05.intel.com (mga05.intel.com [192.55.52.43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2FD516E9D6
 for <intel-gfx@lists.freedesktop.org>; Fri, 30 Oct 2020 16:50:55 +0000 (UTC)
IronPort-SDR: j8YXSNjFHmadxomqCOb6ZmbjuIqvKqwXRiwLeK3Xl602nG85oj3XQPA+2RogzK1JnWeE4FxEw7
 OaBHhBnir1oQ==
X-IronPort-AV: E=McAfee;i="6000,8403,9790"; a="253342079"
X-IronPort-AV: E=Sophos;i="5.77,434,1596524400"; d="scan'208";a="253342079"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga002.jf.intel.com ([10.7.209.21])
 by fmsmga105.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 30 Oct 2020 09:50:54 -0700
IronPort-SDR: 3gkTfJORMaaaug8l1E17wU/9C0UGzVE+T4D2P3LBaa2bFUAG1Py9f04pUwE8xzsFAAS8tK6dKL
 eyd3VD2UiC3w==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.77,434,1596524400"; d="scan'208";a="335475567"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.174])
 by orsmga002.jf.intel.com with SMTP; 30 Oct 2020 09:50:52 -0700
Received: by stinkbox (sSMTP sendmail emulation);
 Fri, 30 Oct 2020 18:50:51 +0200
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 30 Oct 2020 18:50:37 +0200
Message-Id: <20201030165045.5000-3-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.26.2
In-Reply-To: <20201030165045.5000-1-ville.syrjala@linux.intel.com>
References: <20201030165045.5000-1-ville.syrjala@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 02/10] drm/i915: Shrink ilk-bdw wm storage by
 using u16
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KClRo
ZSBtYXhpbXVtIHdhdGVybWFyayB2YWx1ZSB3ZSBjYW4gZXZlciBoYXZlIG9uIGlsay1iZHcgaXMK
MTEgYml0cy4gVGh1cyB3ZSBjYW4gc2FmZWx5IHN0b3JlIGFsbCBvZiB0aGVzZSB2YWx1ZXMgaW4K
dTE2LgoKU2lnbmVkLW9mZi1ieTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4
LmludGVsLmNvbT4KLS0tCiAuLi4vZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVz
LmggICAgfCAgOCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYyAgICAgICAgICAg
ICAgIHwgNzQgKysrKysrKysrLS0tLS0tLS0tLQogMiBmaWxlcyBjaGFuZ2VkLCA0MCBpbnNlcnRp
b25zKCspLCA0MiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oCmluZGV4IGY2ZjA2MjY2NDllMC4uNGMyNWUyZTRm
NGVlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3Bs
YXlfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3Bs
YXlfdHlwZXMuaApAQCAtNjY2LDEwICs2NjYsMTAgQEAgc3RydWN0IGludGVsX2NydGNfc2NhbGVy
X3N0YXRlIHsKIAogc3RydWN0IGludGVsX3dtX2xldmVsIHsKIAlib29sIGVuYWJsZTsKLQl1MzIg
cHJpX3ZhbDsKLQl1MzIgc3ByX3ZhbDsKLQl1MzIgY3VyX3ZhbDsKLQl1MzIgZmJjX3ZhbDsKKwl1
MTYgcHJpX3ZhbDsKKwl1MTYgc3ByX3ZhbDsKKwl1MTYgY3VyX3ZhbDsKKwl1MTYgZmJjX3ZhbDsK
IH07CiAKIHN0cnVjdCBpbnRlbF9waXBlX3dtIHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5jCmluZGV4
IDc1ZDIzMjJjZDQ1Ni4uYTgyZmI4MTJiOGM3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9wbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMKQEAg
LTEyMjUsOSArMTIyNSw5IEBAIHN0YXRpYyBib29sIGc0eF9yYXdfZmJjX3dtX3NldChzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAlyZXR1cm4gZGlydHk7CiB9CiAKLXN0YXRp
YyB1MzIgaWxrX2NvbXB1dGVfZmJjX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLAorc3RhdGljIHUxNiBpbGtfY29tcHV0ZV9mYmNfd20oY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxf
cGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlLAotCQkJICAgICAgdTMyIHByaV92YWwpOworCQkJICAg
ICAgdTE2IHByaV92YWwpOwogCiBzdGF0aWMgYm9vbCBnNHhfcmF3X3BsYW5lX3dtX2NvbXB1dGUo
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCQkJICAgICBjb25zdCBzdHJ1
Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQpAQCAtMjUwNiw3ICsyNTA2LDcgQEAg
c3RhdGljIHVuc2lnbmVkIGludCBpbGtfd21fbWV0aG9kMSh1bnNpZ25lZCBpbnQgcGl4ZWxfcmF0
ZSwKIAlyZXQgPSBpbnRlbF93bV9tZXRob2QxKHBpeGVsX3JhdGUsIGNwcCwgbGF0ZW5jeSk7CiAJ
cmV0ID0gRElWX1JPVU5EX1VQKHJldCwgNjQpICsgMjsKIAotCXJldHVybiByZXQ7CisJcmV0dXJu
IG1pbl90KHVuc2lnbmVkIGludCwgcmV0LCBVMTZfTUFYKTsKIH0KIAogLyogbGF0ZW5jeSBtdXN0
IGJlIGluIDAuMXVzIHVuaXRzLiAqLwpAQCAtMjUyMiwxMCArMjUyMiwxMSBAQCBzdGF0aWMgdW5z
aWduZWQgaW50IGlsa193bV9tZXRob2QyKHVuc2lnbmVkIGludCBwaXhlbF9yYXRlLAogCQkJICAg
ICAgIHdpZHRoLCBjcHAsIGxhdGVuY3kpOwogCXJldCA9IERJVl9ST1VORF9VUChyZXQsIDY0KSAr
IDI7CiAKLQlyZXR1cm4gcmV0OworCXJldHVybiBtaW5fdCh1bnNpZ25lZCBpbnQsIHJldCwgVTE2
X01BWCk7CiB9CiAKLXN0YXRpYyB1MzIgaWxrX3dtX2ZiYyh1MzIgcHJpX3ZhbCwgdTMyIGhvcml6
X3BpeGVscywgdTggY3BwKQorc3RhdGljIHUxNiBpbGtfd21fZmJjKHUxNiBwcmlfdmFsLCB1bnNp
Z25lZCBpbnQgaG9yaXpfcGl4ZWxzLAorCQkgICAgICB1bnNpZ25lZCBpbnQgY3BwKQogewogCS8q
CiAJICogTmVpdGhlciBvZiB0aGVzZSBzaG91bGQgYmUgcG9zc2libGUgc2luY2UgdGhpcyBmdW5j
dGlvbiBzaG91bGRuJ3QgYmUKQEAgLTI1NTIsMTUgKzI1NTMsMTUgQEAgc3RydWN0IGlsa193bV9t
YXhpbXVtcyB7CiAgKiBGb3IgYm90aCBXTV9QSVBFIGFuZCBXTV9MUC4KICAqIG1lbV92YWx1ZSBt
dXN0IGJlIGluIDAuMXVzIHVuaXRzLgogICovCi1zdGF0aWMgdTMyIGlsa19jb21wdXRlX3ByaV93
bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKK3N0YXRpYyB1MTYg
aWxrX2NvbXB1dGVfcHJpX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlLAogCQkJICAgICAgY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0
ZSwKLQkJCSAgICAgIHUzMiBtZW1fdmFsdWUsIGJvb2wgaXNfbHApCisJCQkgICAgICB1bnNpZ25l
ZCBpbnQgbWVtX3ZhbHVlLCBib29sIGlzX2xwKQogewotCXUzMiBtZXRob2QxLCBtZXRob2QyOwor
CXUxNiBtZXRob2QxLCBtZXRob2QyOwogCWludCBjcHA7CiAKIAlpZiAobWVtX3ZhbHVlID09IDAp
Ci0JCXJldHVybiBVMzJfTUFYOworCQlyZXR1cm4gVTE2X01BWDsKIAogCWlmICghaW50ZWxfd21f
cGxhbmVfdmlzaWJsZShjcnRjX3N0YXRlLCBwbGFuZV9zdGF0ZSkpCiAJCXJldHVybiAwOwpAQCAt
MjU4NCwxNSArMjU4NSwxNSBAQCBzdGF0aWMgdTMyIGlsa19jb21wdXRlX3ByaV93bShjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKICAqIEZvciBib3RoIFdNX1BJUEUg
YW5kIFdNX0xQLgogICogbWVtX3ZhbHVlIG11c3QgYmUgaW4gMC4xdXMgdW5pdHMuCiAgKi8KLXN0
YXRpYyB1MzIgaWxrX2NvbXB1dGVfc3ByX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlLAorc3RhdGljIHUxNiBpbGtfY29tcHV0ZV9zcHJfd20oY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50
ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlLAotCQkJICAgICAgdTMyIG1lbV92YWx1ZSkKKwkJ
CSAgICAgIHVuc2lnbmVkIGludCBtZW1fdmFsdWUpCiB7Ci0JdTMyIG1ldGhvZDEsIG1ldGhvZDI7
CisJdTE2IG1ldGhvZDEsIG1ldGhvZDI7CiAJaW50IGNwcDsKIAogCWlmIChtZW1fdmFsdWUgPT0g
MCkKLQkJcmV0dXJuIFUzMl9NQVg7CisJCXJldHVybiBVMTZfTUFYOwogCiAJaWYgKCFpbnRlbF93
bV9wbGFuZV92aXNpYmxlKGNydGNfc3RhdGUsIHBsYW5lX3N0YXRlKSkKIAkJcmV0dXJuIDA7CkBA
IC0yNjExLDE0ICsyNjEyLDE0IEBAIHN0YXRpYyB1MzIgaWxrX2NvbXB1dGVfc3ByX3dtKGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogICogRm9yIGJvdGggV01fUElQ
RSBhbmQgV01fTFAuCiAgKiBtZW1fdmFsdWUgbXVzdCBiZSBpbiAwLjF1cyB1bml0cy4KICAqLwot
c3RhdGljIHUzMiBpbGtfY29tcHV0ZV9jdXJfd20oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUsCitzdGF0aWMgdTE2IGlsa19jb21wdXRlX2N1cl93bShjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBp
bnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUsCi0JCQkgICAgICB1MzIgbWVtX3ZhbHVlKQor
CQkJICAgICAgdW5zaWduZWQgaW50IG1lbV92YWx1ZSkKIHsKIAlpbnQgY3BwOwogCiAJaWYgKG1l
bV92YWx1ZSA9PSAwKQotCQlyZXR1cm4gVTMyX01BWDsKKwkJcmV0dXJuIFUxNl9NQVg7CiAKIAlp
ZiAoIWludGVsX3dtX3BsYW5lX3Zpc2libGUoY3J0Y19zdGF0ZSwgcGxhbmVfc3RhdGUpKQogCQly
ZXR1cm4gMDsKQEAgLTI2MzIsOSArMjYzMyw5IEBAIHN0YXRpYyB1MzIgaWxrX2NvbXB1dGVfY3Vy
X3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogfQogCiAvKiBP
bmx5IGZvciBXTV9MUC4gKi8KLXN0YXRpYyB1MzIgaWxrX2NvbXB1dGVfZmJjX3dtKGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAorc3RhdGljIHUxNiBpbGtfY29tcHV0
ZV9mYmNfd20oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCQkg
ICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlLAotCQkJICAg
ICAgdTMyIHByaV92YWwpCisJCQkgICAgICB1MTYgcHJpX3ZhbCkKIHsKIAlpbnQgY3BwOwogCkBA
IC0yNjQ3LDggKzI2NDgsNyBAQCBzdGF0aWMgdTMyIGlsa19jb21wdXRlX2ZiY193bShjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCSAgY3BwKTsKIH0KIAotc3Rh
dGljIHVuc2lnbmVkIGludAotaWxrX2Rpc3BsYXlfZmlmb19zaXplKGNvbnN0IHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKK3N0YXRpYyB1MTYgaWxrX2Rpc3BsYXlfZmlmb19zaXpl
KGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKIAlpZiAoSU5URUxf
R0VOKGRldl9wcml2KSA+PSA4KQogCQlyZXR1cm4gMzA3MjsKQEAgLTI2NTgsOSArMjY1OCw4IEBA
IGlsa19kaXNwbGF5X2ZpZm9fc2l6ZShjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCiAJCXJldHVybiA1MTI7CiB9CiAKLXN0YXRpYyB1bnNpZ25lZCBpbnQKLWlsa19wbGFu
ZV93bV9yZWdfbWF4KGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJ
ICAgICBpbnQgbGV2ZWwsIGJvb2wgaXNfc3ByaXRlKQorc3RhdGljIHUxNiBpbGtfcGxhbmVfd21f
cmVnX21heChjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkJaW50
IGxldmVsLCBib29sIGlzX3Nwcml0ZSkKIHsKIAlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA4
KQogCQkvKiBCRFcgcHJpbWFyeS9zcHJpdGUgcGxhbmUgd2F0ZXJtYXJrcyAqLwpAQCAtMjY3Niw4
ICsyNjc1LDcgQEAgaWxrX3BsYW5lX3dtX3JlZ19tYXgoY29uc3Qgc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAogCQlyZXR1cm4gbGV2ZWwgPT0gMCA/IDYzIDogMjU1OwogfQogCi1z
dGF0aWMgdW5zaWduZWQgaW50Ci1pbGtfY3Vyc29yX3dtX3JlZ19tYXgoY29uc3Qgc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgbGV2ZWwpCitzdGF0aWMgdTE2IGlsa19jdXJz
b3Jfd21fcmVnX21heChjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGlu
dCBsZXZlbCkKIHsKIAlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA3KQogCQlyZXR1cm4gbGV2
ZWwgPT0gMCA/IDYzIDogMjU1OwpAQCAtMjY4NSw3ICsyNjgzLDcgQEAgaWxrX2N1cnNvcl93bV9y
ZWdfbWF4KGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50IGxldmVs
KQogCQlyZXR1cm4gbGV2ZWwgPT0gMCA/IDMxIDogNjM7CiB9CiAKLXN0YXRpYyB1bnNpZ25lZCBp
bnQgaWxrX2ZiY193bV9yZWdfbWF4KGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKK3N0YXRpYyB1MTYgaWxrX2ZiY193bV9yZWdfbWF4KGNvbnN0IHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKIHsKIAlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA4KQog
CQlyZXR1cm4gMzE7CkBAIC0yNjk0LDEzICsyNjkyLDEzIEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQg
aWxrX2ZiY193bV9yZWdfbWF4KGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKIH0KIAogLyogQ2FsY3VsYXRlIHRoZSBtYXhpbXVtIHByaW1hcnkvc3ByaXRlIHBsYW5lIHdh
dGVybWFyayAqLwotc3RhdGljIHVuc2lnbmVkIGludCBpbGtfcGxhbmVfd21fbWF4KGNvbnN0IHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkgICAgIGludCBsZXZlbCwKLQkJ
CQkgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF93bV9jb25maWcgKmNvbmZpZywKLQkJCQkgICAgIGVu
dW0gaW50ZWxfZGRiX3BhcnRpdGlvbmluZyBkZGJfcGFydGl0aW9uaW5nLAotCQkJCSAgICAgYm9v
bCBpc19zcHJpdGUpCitzdGF0aWMgdTE2IGlsa19wbGFuZV93bV9tYXgoY29uc3Qgc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJICAgIGludCBsZXZlbCwKKwkJCSAgICBjb25z
dCBzdHJ1Y3QgaW50ZWxfd21fY29uZmlnICpjb25maWcsCisJCQkgICAgZW51bSBpbnRlbF9kZGJf
cGFydGl0aW9uaW5nIGRkYl9wYXJ0aXRpb25pbmcsCisJCQkgICAgYm9vbCBpc19zcHJpdGUpCiB7
Ci0JdW5zaWduZWQgaW50IGZpZm9fc2l6ZSA9IGlsa19kaXNwbGF5X2ZpZm9fc2l6ZShkZXZfcHJp
dik7CisJdTE2IGZpZm9fc2l6ZSA9IGlsa19kaXNwbGF5X2ZpZm9fc2l6ZShkZXZfcHJpdik7CiAK
IAkvKiBpZiBzcHJpdGVzIGFyZW4ndCBlbmFibGVkLCBzcHJpdGVzIGdldCBub3RoaW5nICovCiAJ
aWYgKGlzX3Nwcml0ZSAmJiAhY29uZmlnLT5zcHJpdGVzX2VuYWJsZWQpCkBAIC0yNzM1LDkgKzI3
MzMsOSBAQCBzdGF0aWMgdW5zaWduZWQgaW50IGlsa19wbGFuZV93bV9tYXgoY29uc3Qgc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogfQogCiAvKiBDYWxjdWxhdGUgdGhlIG1heGlt
dW0gY3Vyc29yIHBsYW5lIHdhdGVybWFyayAqLwotc3RhdGljIHVuc2lnbmVkIGludCBpbGtfY3Vy
c29yX3dtX21heChjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0JCQkJ
ICAgICAgaW50IGxldmVsLAotCQkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF93bV9jb25maWcg
KmNvbmZpZykKK3N0YXRpYyB1MTYgaWxrX2N1cnNvcl93bV9tYXgoY29uc3Qgc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJICAgICBpbnQgbGV2ZWwsCisJCQkgICAgIGNvbnN0
IHN0cnVjdCBpbnRlbF93bV9jb25maWcgKmNvbmZpZykKIHsKIAkvKiBIU1cgTFAxKyB3YXRlcm1h
cmtzIHcvIG11bHRpcGxlIHBpcGVzICovCiAJaWYgKGxldmVsID4gMCAmJiBjb25maWctPm51bV9w
aXBlc19hY3RpdmUgPiAxKQpAQCAtMjgwMSw5ICsyNzk5LDkgQEAgc3RhdGljIGJvb2wgaWxrX3Zh
bGlkYXRlX3dtX2xldmVsKGludCBsZXZlbCwKIAkJCURSTV9ERUJVR19LTVMoIkN1cnNvciBXTSVk
IHRvbyBsYXJnZSAldSAobWF4ICV1KVxuIiwKIAkJCQkgICAgICBsZXZlbCwgcmVzdWx0LT5jdXJf
dmFsLCBtYXgtPmN1cik7CiAKLQkJcmVzdWx0LT5wcmlfdmFsID0gbWluX3QodTMyLCByZXN1bHQt
PnByaV92YWwsIG1heC0+cHJpKTsKLQkJcmVzdWx0LT5zcHJfdmFsID0gbWluX3QodTMyLCByZXN1
bHQtPnNwcl92YWwsIG1heC0+c3ByKTsKLQkJcmVzdWx0LT5jdXJfdmFsID0gbWluX3QodTMyLCBy
ZXN1bHQtPmN1cl92YWwsIG1heC0+Y3VyKTsKKwkJcmVzdWx0LT5wcmlfdmFsID0gbWluKHJlc3Vs
dC0+cHJpX3ZhbCwgbWF4LT5wcmkpOworCQlyZXN1bHQtPnNwcl92YWwgPSBtaW4ocmVzdWx0LT5z
cHJfdmFsLCBtYXgtPnNwcik7CisJCXJlc3VsdC0+Y3VyX3ZhbCA9IG1pbihyZXN1bHQtPmN1cl92
YWwsIG1heC0+Y3VyKTsKIAkJcmVzdWx0LT5lbmFibGUgPSB0cnVlOwogCX0KIAotLSAKMi4yNi4y
CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1n
ZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9s
aXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZngK

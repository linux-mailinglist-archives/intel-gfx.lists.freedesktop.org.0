Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 7C9EF28DC9
	for <lists+intel-gfx@lfdr.de>; Fri, 24 May 2019 01:31:52 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E76D76E093;
	Thu, 23 May 2019 23:31:47 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga07.intel.com (mga07.intel.com [134.134.136.100])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B1B556E086
 for <intel-gfx@lists.freedesktop.org>; Thu, 23 May 2019 23:31:37 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga004.fm.intel.com ([10.253.24.48])
 by orsmga105.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 23 May 2019 16:31:36 -0700
X-ExtLoop1: 1
Received: from irvmail001.ir.intel.com ([163.33.26.43])
 by fmsmga004.fm.intel.com with ESMTP; 23 May 2019 16:31:35 -0700
Received: from mwajdecz-MOBL1.ger.corp.intel.com
 (mwajdecz-mobl1.ger.corp.intel.com [10.249.139.89])
 by irvmail001.ir.intel.com (8.14.3/8.13.6/MailSET/Hub) with ESMTP id
 x4NNVN0g023503; Fri, 24 May 2019 00:31:34 +0100
From: Michal Wajdeczko <michal.wajdeczko@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 23 May 2019 23:30:36 +0000
Message-Id: <20190523233049.28020-10-michal.wajdeczko@intel.com>
X-Mailer: git-send-email 2.21.0.windows.1
In-Reply-To: <20190523233049.28020-1-michal.wajdeczko@intel.com>
References: <20190523233049.28020-1-michal.wajdeczko@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v4 09/22] drm/i915/guc: Reset GuC ADS during
 sanitize
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

R3VDIHN0b3JlcyBzb21lIGRhdGEgaW4gdGhlcmUsIHdoaWNoIG1pZ2h0IGJlIHN0YWxlIGFmdGVy
IGEgcmVzZXQuClJlaW5pdGlhbGl6ZSB3aG9sZSBBRFMgaW4gY2FzZSBhbnkgcGFydCBvZiBpdCB3
YXMgY29ycnVwdGVkIGR1cmluZwpwcmV2aW91cyBHdUMgcnVuLgoKdjI6IHMvcmVpbml0L2luaXQs
IHVwZGF0ZSBmdW5jdGlvbnMgZGVzY3JpcHRpb25zIChUb21lay9NaWNoYWwpCnYzOiByZXNldCBB
RFMgcmlnaHQgYmVmb3JlIGZ3IHVwbG9hZAoKU2lnbmVkLW9mZi1ieTogTWljaGFsIFdhamRlY3pr
byA8bWljaGFsLndhamRlY3prb0BpbnRlbC5jb20+CkNjOiBEYW5pZWxlIENlcmFvbG8gU3B1cmlv
IDxkYW5pZWxlLmNlcmFvbG9zcHVyaW9AaW50ZWwuY29tPgpDYzogTWljaGHEuSBXaW5pYXJza2kg
PG1pY2hhbC53aW5pYXJza2lAaW50ZWwuY29tPgpDYzogVG9tYXN6IExpcyA8dG9tYXN6Lmxpc0Bp
bnRlbC5jb20+ClJldmlld2VkLWJ5OiBUb21hc3ogTGlzIDx0b21hc3oubGlzQGludGVsLmNvbT4g
I3YyClJldmlld2VkLWJ5OiBNaWNoYcS5IFdpbmlhcnNraSA8bWljaGFsLndpbmlhcnNraUBpbnRl
bC5jb20+ICN2MgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Y19hZHMuYyB8IDkw
ICsrKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X2d1Y19hZHMuaCB8ICAxICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3VjLmMgICAgICB8
ICA0ICstCiAzIGZpbGVzIGNoYW5nZWQsIDYzIGluc2VydGlvbnMoKyksIDMyIGRlbGV0aW9ucygt
KQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Y19hZHMuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Y19hZHMuYwppbmRleCAxYWExZWMwZmY0YTEuLmVj
YjY5ZmM5NDIxOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2Fk
cy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Y19hZHMuYwpAQCAtNzIsNDMg
KzcyLDI4IEBAIHN0YXRpYyB2b2lkIGd1Y19jdF9wb29sX2VudHJpZXNfaW5pdChzdHJ1Y3QgZ3Vj
X2N0X3Bvb2xfZW50cnkgKnBvb2wsIHUzMiBudW0pCiAgKi8KICNkZWZpbmUgTFJfSFdfQ09OVEVY
VF9TSVpFCSg4MCAqIHNpemVvZih1MzIpKQogCi0vKioKLSAqIGludGVsX2d1Y19hZHNfY3JlYXRl
KCkgLSBjcmVhdGVzIEd1QyBBRFMKLSAqIEBndWM6IGludGVsX2d1YyBzdHJ1Y3QKLSAqCi0gKi8K
LWludCBpbnRlbF9ndWNfYWRzX2NyZWF0ZShzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCisvKiBUaGUg
YWRzIG9iaiBpbmNsdWRlcyB0aGUgc3RydWN0IGl0c2VsZiBhbmQgYnVmZmVycyBwYXNzZWQgdG8g
R3VDICovCitzdHJ1Y3QgX19ndWNfYWRzX2Jsb2IgeworCXN0cnVjdCBndWNfYWRzIGFkczsKKwlz
dHJ1Y3QgZ3VjX3BvbGljaWVzIHBvbGljaWVzOworCXN0cnVjdCBndWNfbW1pb19yZWdfc3RhdGUg
cmVnX3N0YXRlOworCXN0cnVjdCBndWNfZ3Rfc3lzdGVtX2luZm8gc3lzdGVtX2luZm87CisJc3Ry
dWN0IGd1Y19jbGllbnRzX2luZm8gY2xpZW50c19pbmZvOworCXN0cnVjdCBndWNfY3RfcG9vbF9l
bnRyeSBjdF9wb29sW0dVQ19DVF9QT09MX1NJWkVdOworCXU4IHJlZ19zdGF0ZV9idWZmZXJbR1VD
X1MzX1NBVkVfU1BBQ0VfUEFHRVMgKiBQQUdFX1NJWkVdOworfSBfX3BhY2tlZDsKKworc3RhdGlj
IGludCBfX2d1Y19hZHNfaW5pdChzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCiB7CiAJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKLQlzdHJ1Y3QgaTkx
NV92bWEgKnZtYTsKLQkvKiBUaGUgYWRzIG9iaiBpbmNsdWRlcyB0aGUgc3RydWN0IGl0c2VsZiBh
bmQgYnVmZmVycyBwYXNzZWQgdG8gR3VDICovCi0Jc3RydWN0IHsKLQkJc3RydWN0IGd1Y19hZHMg
YWRzOwotCQlzdHJ1Y3QgZ3VjX3BvbGljaWVzIHBvbGljaWVzOwotCQlzdHJ1Y3QgZ3VjX21taW9f
cmVnX3N0YXRlIHJlZ19zdGF0ZTsKLQkJc3RydWN0IGd1Y19ndF9zeXN0ZW1faW5mbyBzeXN0ZW1f
aW5mbzsKLQkJc3RydWN0IGd1Y19jbGllbnRzX2luZm8gY2xpZW50c19pbmZvOwotCQlzdHJ1Y3Qg
Z3VjX2N0X3Bvb2xfZW50cnkgY3RfcG9vbFtHVUNfQ1RfUE9PTF9TSVpFXTsKLQkJdTggcmVnX3N0
YXRlX2J1ZmZlcltHVUNfUzNfU0FWRV9TUEFDRV9QQUdFUyAqIFBBR0VfU0laRV07Ci0JfSBfX3Bh
Y2tlZCAqYmxvYjsKKwlzdHJ1Y3QgX19ndWNfYWRzX2Jsb2IgKmJsb2I7CiAJY29uc3QgdTMyIHNr
aXBwZWRfc2l6ZSA9IExSQ19QUEhXU1BfU1ogKiBQQUdFX1NJWkUgKyBMUl9IV19DT05URVhUX1NJ
WkU7CiAJdTMyIGJhc2U7CiAJdTggZW5naW5lX2NsYXNzOwotCWludCByZXQ7Ci0KLQlHRU1fQlVH
X09OKGd1Yy0+YWRzX3ZtYSk7Ci0KLQl2bWEgPSBpbnRlbF9ndWNfYWxsb2NhdGVfdm1hKGd1Yywg
UEFHRV9BTElHTihzaXplb2YoKmJsb2IpKSk7Ci0JaWYgKElTX0VSUih2bWEpKQotCQlyZXR1cm4g
UFRSX0VSUih2bWEpOwotCi0JZ3VjLT5hZHNfdm1hID0gdm1hOwogCiAJYmxvYiA9IGk5MTVfZ2Vt
X29iamVjdF9waW5fbWFwKGd1Yy0+YWRzX3ZtYS0+b2JqLCBJOTE1X01BUF9XQik7Ci0JaWYgKElT
X0VSUihibG9iKSkgewotCQlyZXQgPSBQVFJfRVJSKGJsb2IpOwotCQlnb3RvIGVycl92bWE7Ci0J
fQorCWlmIChJU19FUlIoYmxvYikpCisJCXJldHVybiBQVFJfRVJSKGJsb2IpOwogCiAJLyogR3VD
IHNjaGVkdWxpbmcgcG9saWNpZXMgKi8KIAlndWNfcG9saWNpZXNfaW5pdCgmYmxvYi0+cG9saWNp
ZXMpOwpAQCAtMTQzLDcgKzEyOCw3IEBAIGludCBpbnRlbF9ndWNfYWRzX2NyZWF0ZShzdHJ1Y3Qg
aW50ZWxfZ3VjICpndWMpCiAJYmxvYi0+c3lzdGVtX2luZm8udmVib3hfZW5hYmxlX21hc2sgPSBW
RUJPWF9NQVNLKGRldl9wcml2KTsKIAlibG9iLT5zeXN0ZW1faW5mby52ZGJveF9zZmNfc3VwcG9y
dF9tYXNrID0gUlVOVElNRV9JTkZPKGRldl9wcml2KS0+dmRib3hfc2ZjX2FjY2VzczsKIAotCWJh
c2UgPSBpbnRlbF9ndWNfZ2d0dF9vZmZzZXQoZ3VjLCB2bWEpOworCWJhc2UgPSBpbnRlbF9ndWNf
Z2d0dF9vZmZzZXQoZ3VjLCBndWMtPmFkc192bWEpOwogCiAJLyogQ2xpZW50cyBpbmZvICAqLwog
CWd1Y19jdF9wb29sX2VudHJpZXNfaW5pdChibG9iLT5jdF9wb29sLCBBUlJBWV9TSVpFKGJsb2It
PmN0X3Bvb2wpKTsKQEAgLTE2Miw2ICsxNDcsMzQgQEAgaW50IGludGVsX2d1Y19hZHNfY3JlYXRl
KHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKIAlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKGd1Yy0+
YWRzX3ZtYS0+b2JqKTsKIAogCXJldHVybiAwOworfQorCisvKioKKyAqIGludGVsX2d1Y19hZHNf
Y3JlYXRlKCkgLSBhbGxvY2F0ZXMgYW5kIGluaXRpYWxpemVzIEd1QyBBRFMuCisgKiBAZ3VjOiBp
bnRlbF9ndWMgc3RydWN0CisgKgorICogR3VDIG5lZWRzIG1lbW9yeSBibG9jayAoQWRkaXRpb25h
bCBEYXRhIFN0cnVjdCksIHdoZXJlIGl0IHdpbGwgc3RvcmUKKyAqIHNvbWUgZGF0YS4gQWxsb2Nh
dGUgYW5kIGluaXRpYWxpemUgc3VjaCBtZW1vcnkgYmxvY2sgZm9yIEd1QyB1c2UuCisgKi8KK2lu
dCBpbnRlbF9ndWNfYWRzX2NyZWF0ZShzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCit7CisJY29uc3Qg
dTMyIHNpemUgPSBQQUdFX0FMSUdOKHNpemVvZihzdHJ1Y3QgX19ndWNfYWRzX2Jsb2IpKTsKKwlz
dHJ1Y3QgaTkxNV92bWEgKnZtYTsKKwlpbnQgcmV0OworCisJR0VNX0JVR19PTihndWMtPmFkc192
bWEpOworCisJdm1hID0gaW50ZWxfZ3VjX2FsbG9jYXRlX3ZtYShndWMsIHNpemUpOworCWlmIChJ
U19FUlIodm1hKSkKKwkJcmV0dXJuIFBUUl9FUlIodm1hKTsKKworCWd1Yy0+YWRzX3ZtYSA9IHZt
YTsKKworCXJldCA9IF9fZ3VjX2Fkc19pbml0KGd1Yyk7CisJaWYgKHJldCkKKwkJZ290byBlcnJf
dm1hOworCisJcmV0dXJuIDA7CiAKIGVycl92bWE6CiAJaTkxNV92bWFfdW5waW5fYW5kX3JlbGVh
c2UoJmd1Yy0+YWRzX3ZtYSwgMCk7CkBAIC0xNzIsMyArMTg1LDE4IEBAIHZvaWQgaW50ZWxfZ3Vj
X2Fkc19kZXN0cm95KHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKIHsKIAlpOTE1X3ZtYV91bnBpbl9h
bmRfcmVsZWFzZSgmZ3VjLT5hZHNfdm1hLCAwKTsKIH0KKworLyoqCisgKiBpbnRlbF9ndWNfYWRz
X3Jlc2V0KCkgLSBwcmVwYXJlcyBHdUMgQWRkaXRpb25hbCBEYXRhIFN0cnVjdCBmb3IgcmV1c2UK
KyAqIEBndWM6IGludGVsX2d1YyBzdHJ1Y3QKKyAqCisgKiBHdUMgc3RvcmVzIHNvbWUgZGF0YSBp
biBBRFMsIHdoaWNoIG1pZ2h0IGJlIHN0YWxlIGFmdGVyIGEgcmVzZXQuCisgKiBSZWluaXRpYWxp
emUgd2hvbGUgQURTIGluIGNhc2UgYW55IHBhcnQgb2YgaXQgd2FzIGNvcnJ1cHRlZCBkdXJpbmcK
KyAqIHByZXZpb3VzIEd1QyBydW4uCisgKi8KK3ZvaWQgaW50ZWxfZ3VjX2Fkc19yZXNldChzdHJ1
Y3QgaW50ZWxfZ3VjICpndWMpCit7CisJaWYgKCFndWMtPmFkc192bWEpCisJCXJldHVybjsKKwlf
X2d1Y19hZHNfaW5pdChndWMpOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfZ3VjX2Fkcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2Fkcy5oCmlu
ZGV4IGM0NzM1NzQyYzU2NC4uN2Y0MGY5Y2Q1ZmI5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9ndWNfYWRzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
Z3VjX2Fkcy5oCkBAIC0yOSw1ICsyOSw2IEBAIHN0cnVjdCBpbnRlbF9ndWM7CiAKIGludCBpbnRl
bF9ndWNfYWRzX2NyZWF0ZShzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpOwogdm9pZCBpbnRlbF9ndWNf
YWRzX2Rlc3Ryb3koc3RydWN0IGludGVsX2d1YyAqZ3VjKTsKK3ZvaWQgaW50ZWxfZ3VjX2Fkc19y
ZXNldChzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpOwogCiAjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX3VjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91
Yy5jCmluZGV4IGY2NjEwNWQ3NTZkZi4uMmRlOWQ1MzYwZjAyIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF91Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X3VjLmMKQEAgLTI0LDggKzI0LDkgQEAKIAogI2luY2x1ZGUgImd0L2ludGVsX3Jlc2V0LmgiCiAj
aW5jbHVkZSAiaW50ZWxfdWMuaCIKLSNpbmNsdWRlICJpbnRlbF9ndWNfc3VibWlzc2lvbi5oIgog
I2luY2x1ZGUgImludGVsX2d1Yy5oIgorI2luY2x1ZGUgImludGVsX2d1Y19hZHMuaCIKKyNpbmNs
dWRlICJpbnRlbF9ndWNfc3VibWlzc2lvbi5oIgogI2luY2x1ZGUgImk5MTVfZHJ2LmgiCiAKIHN0
YXRpYyB2b2lkIGd1Y19mcmVlX2xvYWRfZXJyX2xvZyhzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpOwpA
QCAtNDE1LDYgKzQxNiw3IEBAIGludCBpbnRlbF91Y19pbml0X2h3KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQogCQkJCWdvdG8gZXJyX291dDsKIAkJfQogCisJCWludGVsX2d1Y19hZHNf
cmVzZXQoZ3VjKTsKIAkJaW50ZWxfZ3VjX2luaXRfcGFyYW1zKGd1Yyk7CiAJCXJldCA9IGludGVs
X2d1Y19md191cGxvYWQoZ3VjKTsKIAkJaWYgKHJldCA9PSAwKQotLSAKMi4xOS4yCgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGlu
ZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVl
ZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

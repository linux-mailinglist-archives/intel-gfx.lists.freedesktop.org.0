Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 5A0CDBD586
	for <lists+intel-gfx@lfdr.de>; Wed, 25 Sep 2019 01:40:43 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1F2D76EB0B;
	Tue, 24 Sep 2019 23:40:41 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga12.intel.com (mga12.intel.com [192.55.52.136])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7BD956EB0B
 for <intel-gfx@lists.freedesktop.org>; Tue, 24 Sep 2019 23:40:39 +0000 (UTC)
X-Amp-Result: UNKNOWN
X-Amp-Original-Verdict: FILE UNKNOWN
X-Amp-File-Uploaded: False
Received: from fmsmga001.fm.intel.com ([10.253.24.23])
 by fmsmga106.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 24 Sep 2019 16:40:38 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,545,1559545200"; d="scan'208";a="203488347"
Received: from mdroper-desk1.fm.intel.com (HELO
 mdroper-desk1.amr.corp.intel.com) ([10.1.27.135])
 by fmsmga001.fm.intel.com with ESMTP; 24 Sep 2019 16:40:38 -0700
Date: Tue, 24 Sep 2019 16:40:48 -0700
From: Matt Roper <matthew.d.roper@intel.com>
To: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
Message-ID: <20190924234048.GH1869@mdroper-desk1.amr.corp.intel.com>
References: <20190920114235.22411-1-maarten.lankhorst@linux.intel.com>
 <20190920114235.22411-3-maarten.lankhorst@linux.intel.com>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <20190920114235.22411-3-maarten.lankhorst@linux.intel.com>
User-Agent: Mutt/1.12.1 (2019-06-15)
Subject: Re: [Intel-gfx] [PATCH 03/23] drm/i915: Prepare to split crtc state
 in uapi and hw state
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: intel-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T24gRnJpLCBTZXAgMjAsIDIwMTkgYXQgMDE6NDI6MTVQTSArMDIwMCwgTWFhcnRlbiBMYW5raG9y
c3Qgd3JvdGU6Cj4gV2Ugd2FudCB0byBzcGxpdCBkcm1fY3J0Y19zdGF0ZSBpbnRvIHRoZSB1c2Vy
IHZpc2libGUgc3RhdGUKPiBhbmQgYWN0dWFsIGhhcmR3YXJlIHN0YXRlLiBUbyBwcmVwYXJlIGZv
ciB0aGlzLCB3ZSBuZWVkIHNvbWUKPiBncm91bmQgcnVsZXMgd2hhdCBzaG91bGQgYmUgaW4gZWFj
aCBzdGF0ZToKPiAKPiBJbiB1YXBpIHdlIHVzZToKPiAtIGNydGMsICpfY2hhbmdlZCBmbGFncywg
ZXZlbnQsIGNvbW1pdCwgc3RhdGUsIG1vZGVfYmxvYiwgKHBsYW5lL2Nvbm5lY3Rvci9lbmNvZGVy
KV9tYXNrLgo+IAo+IEluIGh3IHN0YXRlIHdlIHVzZSB3aGF0J3MgZGlzcGxheWVkIGluIGhhcmR3
YXJlOgo+IC0gZW5hYmxlLCBhY3RpdmUsIChhZGp1c3RlZCkgbW9kZSwgY29sb3IgcHJvcGVydHkg
YmxvYnMuCgpJJ2Qgc3VnZ2VzdCBlbGFib3JhdGluZyBhIGJpdCB0aGF0IHRoZSB1bmlvbiB3ZSBh
ZGQgaW4gdGhpcyBwYXRjaCBpcwpqdXN0IGFuIGludGVybWVkaWF0ZSBzdGVwIGFuZCB0aGF0IHRo
ZSBlbmQgZ29hbCBpcyB0aGF0IHdlJ2xsIGV2ZW50dWFsbHkKYmUgbWFpbnRhaW5pbmcgdHdvIHNl
cGFyYXRlIGNvcGllcyBvZiBzb21lIG9mIHRoZSBkYXRhLgoKPiAKPiBjbGVhcl9pbnRlbF9jcnRj
X3N0YXRlIGFuZCBodyByZWFkb3V0IG5lZWQgdG8gYmUgdXBkYXRlZCBmb3IgdGhlc2UgcnVsZXMs
Cj4gd2hpY2ggd2lsbCBhbGxvdyB1cyB0byBlbmFibGUgMiBqb2luZWQgcGlwZXMuCj4gCj4gU2ln
bmVkLW9mZi1ieTogTWFhcnRlbiBMYW5raG9yc3QgPG1hYXJ0ZW4ubGFua2hvcnN0QGxpbnV4Lmlu
dGVsLmNvbT4KCkl0IG1pZ2h0IGJlIHdvcnRoIHByb3ZpZGluZyBzb21lIENvY2NpbmVsbGUgcnVs
ZXMgdG8gYXBwbHkgdGhlc2UgY2hhbmdlcwppbiBhIHNlbWktYXV0b21hdGVkIG1hbm5lcjsgb3Ro
ZXJ3aXNlIGl0J3MgZ29pbmcgdG8gYmUgYSBoYXNzbGUgdG8KY29uc3RhbnRseSByZXNvbHZlIGNv
bmZsaWN0cyB3aXRoIHByZXR0eSBtdWNoIGFueSBvdGhlciBkaXNwbGF5IHBhdGNoZXMKdGhhdCBs
YW5kIHVwc3RyZWFtLgoKT3RoZXJ3aXNlLAoKUmV2aWV3ZWQtYnk6IE1hdHQgUm9wZXIgPG1hdHRo
ZXcuZC5yb3BlckBpbnRlbC5jb20+Cgo+IC0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ljbF9kc2kuYyAgICAgICAgfCAgMTggKy0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9hdG9taWMuYyAgIHwgIDE0ICstCj4gIC4uLi9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9hdG9taWNfcGxhbmUuYyB8ICAgNiArLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2F1ZGlvLmMgICAgfCAgMTIgKy0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF9idy5jICAgICAgIHwgICA0ICstCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfY2RjbGsuYyAgICB8ICAxNiArLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2NvbG9yLmMgICAgfCAxODAgKysrLS0tCj4gIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfY3J0LmMgICAgICB8ICAyNCArLQo+ICBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2RkaS5jICAgICAgfCAgMzQgKy0KPiAgZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMgIHwgNTQwICsrKysrKysrKy0tLS0tLS0t
LQo+ICAuLi4vZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmggICAgfCAgMjgg
Ky0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jICAgICAgIHwgIDQy
ICstCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHBfbXN0LmMgICB8ICAg
NiArLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwaW9fcGh5LmMgfCAg
MTQgKy0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcGxsX21nci5jIHwg
IDIwICstCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHZvLmMgICAgICB8
ICAxNCArLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2ZiYy5jICAgICAg
fCAgIDIgKy0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9oZG1pLmMgICAg
IHwgIDYyICstCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfbHNwY29uLmMg
ICB8ICAgNCArLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2x2ZHMuYyAg
ICAgfCAgMTIgKy0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9wYW5lbC5j
ICAgIHwgIDE0ICstCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcGlwZV9j
cmMuYyB8ICAgNiArLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Bzci5j
ICAgICAgfCAgMTAgKy0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zZHZv
LmMgICAgIHwgIDIyICstCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3By
aXRlLmMgICB8ICAyNSArLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3R2
LmMgICAgICAgfCAgIDggKy0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF92
ZHNjLmMgICAgIHwgIDEyICstCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvdmx2X2Rz
aS5jICAgICAgICB8ICAyMCArLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMu
YyAgICAgICAgICAgfCAgMTQgKy0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYyAg
ICAgICAgICAgICAgIHwgMTgwICsrKy0tLQo+ICAzMCBmaWxlcyBjaGFuZ2VkLCA2OTkgaW5zZXJ0
aW9ucygrKSwgNjY0IGRlbGV0aW9ucygtKQo+IAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ljbF9kc2kuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aWNsX2RzaS5jCj4gaW5kZXggNmUzOThjMzNhNTI0Li4wZTI0YjhlMjU3ZTUgMTAwNjQ0Cj4gLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pY2xfZHNpLmMKPiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ljbF9kc2kuYwo+IEBAIC0yNzYsNyArMjc2LDcgQEAgc3Rh
dGljIHZvaWQgY29uZmlndXJlX2R1YWxfbGlua19tb2RlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAo+ICAKPiAgCWlmIChpbnRlbF9kc2ktPmR1YWxfbGluayA9PSBEU0lfRFVBTF9MSU5L
X0ZST05UX0JBQ0spIHsKPiAgCQljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0
ZWRfbW9kZSA9Cj4gLQkJCQkJJnBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gKwkJ
CQkJJnBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlOwo+ICAJCXUzMiBkc3NfY3RsMjsKPiAg
CQl1MTYgaGFjdGl2ZSA9IGFkanVzdGVkX21vZGUtPmNydGNfaGRpc3BsYXk7Cj4gIAkJdTE2IGRs
X2J1ZmZlcl9kZXB0aDsKPiBAQCAtNjI1LDcgKzYyNSw3IEBAIGdlbjExX2RzaV9jb25maWd1cmVf
dHJhbnNjb2RlcihzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgewo+ICAJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7
Cj4gIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBlbmNfdG9faW50ZWxfZHNpKCZlbmNv
ZGVyLT5iYXNlKTsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxf
Y3J0YyhwaXBlX2NvbmZpZy0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICppbnRl
bF9jcnRjID0gdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+dWFwaS5jcnRjKTsKPiAgCWVudW0g
cGlwZSBwaXBlID0gaW50ZWxfY3J0Yy0+cGlwZTsKPiAgCXUzMiB0bXA7Cj4gIAllbnVtIHBvcnQg
cG9ydDsKPiBAQCAtNzY4LDcgKzc2OCw3IEBAIGdlbjExX2RzaV9zZXRfdHJhbnNjb2Rlcl90aW1p
bmdzKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gIAlzdHJ1Y3Qg
aW50ZWxfZHNpICppbnRlbF9kc2kgPSBlbmNfdG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsK
PiAgCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0KPiAtCQkJ
CQkmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPiArCQkJCQkmcGlwZV9jb25maWct
Pmh3LmFkanVzdGVkX21vZGU7Cj4gIAllbnVtIHBvcnQgcG9ydDsKPiAgCWVudW0gdHJhbnNjb2Rl
ciBkc2lfdHJhbnM7Cj4gIAkvKiBob3Jpem9udGFsIHRpbWluZ3MgKi8KPiBAQCAtMTIxNiw3ICsx
MjE2LDcgQEAgc3RhdGljIHZvaWQgZ2VuMTFfZHNpX2dldF90aW1pbmdzKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+ICB7Cj4gIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBl
bmNfdG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiAgCXN0cnVjdCBkcm1fZGlzcGxheV9t
b2RlICphZGp1c3RlZF9tb2RlID0KPiAtCQkJCQkmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRf
bW9kZTsKPiArCQkJCQkmcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGU7Cj4gIAo+ICAJaWYg
KGludGVsX2RzaS0+ZHVhbF9saW5rKSB7Cj4gIAkJYWRqdXN0ZWRfbW9kZS0+Y3J0Y19oZGlzcGxh
eSAqPSAyOwo+IEBAIC0xMjQyLDE2ICsxMjQyLDE2IEBAIHN0YXRpYyB2b2lkIGdlbjExX2RzaV9n
ZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAJCQkJIHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiAgewo+ICAJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gLQlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0Yyk7
Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWct
PnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBlbmNfdG9faW50
ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiAgCj4gIAkvKiBGSVhNRTogYWRhcHQgaWNsX2RkaV9j
bG9ja19nZXQoKSBmb3IgRFNJIGFuZCB1c2UgdGhhdD8gKi8KPiAgCXBpcGVfY29uZmlnLT5wb3J0
X2Nsb2NrID0KPiAgCQljbmxfY2FsY193cnBsbF9saW5rKGRldl9wcml2LCAmcGlwZV9jb25maWct
PmRwbGxfaHdfc3RhdGUpOwo+ICAKPiAtCXBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUu
Y3J0Y19jbG9jayA9IGludGVsX2RzaS0+cGNsazsKPiArCXBpcGVfY29uZmlnLT5ody5hZGp1c3Rl
ZF9tb2RlLmNydGNfY2xvY2sgPSBpbnRlbF9kc2ktPnBjbGs7Cj4gIAlpZiAoaW50ZWxfZHNpLT5k
dWFsX2xpbmspCj4gLQkJcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2Nr
ICo9IDI7Cj4gKwkJcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUuY3J0Y19jbG9jayAqPSAy
Owo+ICAKPiAgCWdlbjExX2RzaV9nZXRfdGltaW5ncyhlbmNvZGVyLCBwaXBlX2NvbmZpZyk7Cj4g
IAlwaXBlX2NvbmZpZy0+b3V0cHV0X3R5cGVzIHw9IEJJVChJTlRFTF9PVVRQVVRfRFNJKTsKPiBA
QCAtMTI2NSwxMSArMTI2NSwxMSBAQCBzdGF0aWMgaW50IGdlbjExX2RzaV9jb21wdXRlX2NvbmZp
ZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgCXN0cnVjdCBpbnRlbF9kc2kgKmlu
dGVsX2RzaSA9IGNvbnRhaW5lcl9vZihlbmNvZGVyLCBzdHJ1Y3QgaW50ZWxfZHNpLAo+ICAJCQkJ
CQkgICBiYXNlKTsKPiAgCXN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmludGVsX2Nvbm5lY3RvciA9
IGludGVsX2RzaS0+YXR0YWNoZWRfY29ubmVjdG9yOwo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNy
dGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT51YXBpLmNydGMpOwo+
ICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmZpeGVkX21vZGUgPQo+ICAJCQkJCWlu
dGVsX2Nvbm5lY3Rvci0+cGFuZWwuZml4ZWRfbW9kZTsKPiAgCXN0cnVjdCBkcm1fZGlzcGxheV9t
b2RlICphZGp1c3RlZF9tb2RlID0KPiAtCQkJCQkmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRf
bW9kZTsKPiArCQkJCQkmcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGU7Cj4gIAo+ICAJcGlw
ZV9jb25maWctPm91dHB1dF9mb3JtYXQgPSBJTlRFTF9PVVRQVVRfRk9STUFUX1JHQjsKPiAgCWlu
dGVsX2ZpeGVkX3BhbmVsX21vZGUoZml4ZWRfbW9kZSwgYWRqdXN0ZWRfbW9kZSk7Cj4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWljLmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0b21pYy5jCj4gaW5kZXggNjk4ODAyZGEw
N2I3Li5mNDQ0MGVkZTk1YzUgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9hdG9taWMuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfYXRvbWljLmMKPiBAQCAtMTg2LDEzICsxODYsMTQgQEAgaW50ZWxfZGlnaXRhbF9jb25u
ZWN0b3JfZHVwbGljYXRlX3N0YXRlKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCj4g
IHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqCj4gIGludGVsX2NydGNfZHVwbGljYXRlX3N0YXRlKHN0
cnVjdCBkcm1fY3J0YyAqY3J0YykKPiAgewo+ICsJY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKm9sZF9jcnRjX3N0YXRlID0gdG9faW50ZWxfY3J0Y19zdGF0ZShjcnRjLT5zdGF0ZSk7Cj4g
IAlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZTsKPiAgCj4gLQljcnRjX3N0YXRl
ID0ga21lbWR1cChjcnRjLT5zdGF0ZSwgc2l6ZW9mKCpjcnRjX3N0YXRlKSwgR0ZQX0tFUk5FTCk7
Cj4gKwljcnRjX3N0YXRlID0ga21lbWR1cChvbGRfY3J0Y19zdGF0ZSwgc2l6ZW9mKCpjcnRjX3N0
YXRlKSwgR0ZQX0tFUk5FTCk7Cj4gIAlpZiAoIWNydGNfc3RhdGUpCj4gIAkJcmV0dXJuIE5VTEw7
Cj4gIAo+IC0JX19kcm1fYXRvbWljX2hlbHBlcl9jcnRjX2R1cGxpY2F0ZV9zdGF0ZShjcnRjLCAm
Y3J0Y19zdGF0ZS0+YmFzZSk7Cj4gKwlfX2RybV9hdG9taWNfaGVscGVyX2NydGNfZHVwbGljYXRl
X3N0YXRlKGNydGMsICZjcnRjX3N0YXRlLT51YXBpKTsKPiAgCj4gIAljcnRjX3N0YXRlLT51cGRh
dGVfcGlwZSA9IGZhbHNlOwo+ICAJY3J0Y19zdGF0ZS0+ZGlzYWJsZV9scF93bSA9IGZhbHNlOwo+
IEBAIC0yMDUsNyArMjA2LDcgQEAgaW50ZWxfY3J0Y19kdXBsaWNhdGVfc3RhdGUoc3RydWN0IGRy
bV9jcnRjICpjcnRjKQo+ICAJY3J0Y19zdGF0ZS0+ZmJfYml0cyA9IDA7Cj4gIAljcnRjX3N0YXRl
LT51cGRhdGVfcGxhbmVzID0gMDsKPiAgCj4gLQlyZXR1cm4gJmNydGNfc3RhdGUtPmJhc2U7Cj4g
KwlyZXR1cm4gJmNydGNfc3RhdGUtPnVhcGk7Cj4gIH0KPiAgCj4gIC8qKgo+IEBAIC0yMjAsNyAr
MjIxLDEwIEBAIHZvaWQKPiAgaW50ZWxfY3J0Y19kZXN0cm95X3N0YXRlKHN0cnVjdCBkcm1fY3J0
YyAqY3J0YywKPiAgCQkJIHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqc3RhdGUpCj4gIHsKPiAtCWRy
bV9hdG9taWNfaGVscGVyX2NydGNfZGVzdHJveV9zdGF0ZShjcnRjLCBzdGF0ZSk7Cj4gKwlzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9IHRvX2ludGVsX2NydGNfc3RhdGUoc3Rh
dGUpOwo+ICsKPiArCV9fZHJtX2F0b21pY19oZWxwZXJfY3J0Y19kZXN0cm95X3N0YXRlKCZjcnRj
X3N0YXRlLT51YXBpKTsKPiArCWtmcmVlKGNydGNfc3RhdGUpOwo+ICB9Cj4gIAo+ICBzdGF0aWMg
dm9pZCBpbnRlbF9hdG9taWNfc2V0dXBfc2NhbGVyKHN0cnVjdCBpbnRlbF9jcnRjX3NjYWxlcl9z
dGF0ZSAqc2NhbGVyX3N0YXRlLAo+IEBAIC0zMTYsNyArMzIwLDcgQEAgaW50IGludGVsX2F0b21p
Y19zZXR1cF9zY2FsZXJzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgCXN0
cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUgPSBOVUxMOwo+ICAJc3RydWN0IGlu
dGVsX2NydGNfc2NhbGVyX3N0YXRlICpzY2FsZXJfc3RhdGUgPQo+ICAJCSZjcnRjX3N0YXRlLT5z
Y2FsZXJfc3RhdGU7Cj4gLQlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqZHJtX3N0YXRlID0gY3J0
Y19zdGF0ZS0+YmFzZS5zdGF0ZTsKPiArCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpkcm1fc3Rh
dGUgPSBjcnRjX3N0YXRlLT51YXBpLnN0YXRlOwo+ICAJc3RydWN0IGludGVsX2F0b21pY19zdGF0
ZSAqaW50ZWxfc3RhdGUgPSB0b19pbnRlbF9hdG9taWNfc3RhdGUoZHJtX3N0YXRlKTsKPiAgCWlu
dCBudW1fc2NhbGVyc19uZWVkOwo+ICAJaW50IGk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWljX3BsYW5lLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2F0b21pY19wbGFuZS5jCj4gaW5kZXggNDc2ZWYwOTA2YmEwLi4x
ZjUwYjE1ZWM3MDQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9hdG9taWNfcGxhbmUuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfYXRvbWljX3BsYW5lLmMKPiBAQCAtMjcxLDcgKzI3MSw3IEBAIHZvaWQgaW50ZWxfdXBk
YXRlX3BsYW5lKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gIAkJCWNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAJCQljb25zdCBzdHJ1Y3QgaW50ZWxfcGxh
bmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9
IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAKPiAg
CXRyYWNlX2ludGVsX3VwZGF0ZV9wbGFuZSgmcGxhbmUtPmJhc2UsIGNydGMpOwo+ICAJcGxhbmUt
PnVwZGF0ZV9wbGFuZShwbGFuZSwgY3J0Y19zdGF0ZSwgcGxhbmVfc3RhdGUpOwo+IEBAIC0yODEs
NyArMjgxLDcgQEAgdm9pZCBpbnRlbF91cGRhdGVfc2xhdmUoc3RydWN0IGludGVsX3BsYW5lICpw
bGFuZSwKPiAgCQkJY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4g
IAkJCWNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gIHsKPiAt
CXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNl
LmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAo+ICAJdHJhY2VfaW50ZWxfdXBkYXRlX3BsYW5lKCZwbGFu
ZS0+YmFzZSwgY3J0Yyk7Cj4gIAlwbGFuZS0+dXBkYXRlX3NsYXZlKHBsYW5lLCBjcnRjX3N0YXRl
LCBwbGFuZV9zdGF0ZSk7Cj4gQEAgLTI5MCw3ICsyOTAsNyBAQCB2b2lkIGludGVsX3VwZGF0ZV9z
bGF2ZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ICB2b2lkIGludGVsX2Rpc2FibGVfcGxh
bmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiAgCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9
IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAKPiAg
CXRyYWNlX2ludGVsX2Rpc2FibGVfcGxhbmUoJnBsYW5lLT5iYXNlLCBjcnRjKTsKPiAgCXBsYW5l
LT5kaXNhYmxlX3BsYW5lKHBsYW5lLCBjcnRjX3N0YXRlKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdWRpby5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9hdWRpby5jCj4gaW5kZXggYWFjMDg5Yzc5Y2ViLi4yZWNmMWRmMGVl
ZGEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdWRp
by5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdWRpby5jCj4g
QEAgLTIzMyw3ICsyMzMsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGhkbWlfYXVkX25jdHMgaGRt
aV9hdWRfbmN0c18zNmJwcFtdID0gewo+ICBzdGF0aWMgdTMyIGF1ZGlvX2NvbmZpZ19oZG1pX3Bp
eGVsX2Nsb2NrKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7
Cj4gIAljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9Cj4gLQkJ
JmNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPiArCQkmY3J0Y19zdGF0ZS0+aHcuYWRq
dXN0ZWRfbW9kZTsKPiAgCWludCBpOwo+ICAKPiAgCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpF
KGhkbWlfYXVkaW9fY2xvY2spOyBpKyspIHsKPiBAQCAtNTU0LDcgKzU1NCw3IEBAIHN0YXRpYyB2
b2lkIGlsa19hdWRpb19jb2RlY19kaXNhYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ICAJCQkJICAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9z
dGF0ZSkKPiAgewo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShlbmNvZGVyLT5iYXNlLmRldik7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMob2xkX2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YyA9IHRvX2ludGVsX2NydGMob2xkX2NydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAll
bnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXIt
PnBvcnQ7Cj4gIAl1MzIgdG1wLCBlbGR2Owo+IEBAIC02MDEsNyArNjAxLDcgQEAgc3RhdGljIHZv
aWQgaWxrX2F1ZGlvX2NvZGVjX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwK
PiAgCQkJCSAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+
ICB7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29k
ZXItPmJhc2UuZGV2KTsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0
YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0
b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2Nvbm5l
Y3RvciAqY29ubmVjdG9yID0gY29ubl9zdGF0ZS0+Y29ubmVjdG9yOwo+ICAJZW51bSBwaXBlIHBp
cGUgPSBjcnRjLT5waXBlOwo+ICAJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+IEBA
IC02OTEsMTAgKzY5MSwxMCBAQCB2b2lkIGludGVsX2F1ZGlvX2NvZGVjX2VuYWJsZShzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgewo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gIAlzdHJ1Y3QgaTkxNV9h
dWRpb19jb21wb25lbnQgKmFjb21wID0gZGV2X3ByaXYtPmF1ZGlvX2NvbXBvbmVudDsKPiAtCXN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNy
dGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3Rh
dGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gY29u
bl9zdGF0ZS0+Y29ubmVjdG9yOwo+ICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFk
anVzdGVkX21vZGUgPQo+IC0JCSZjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gKwkJ
JmNydGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGU7Cj4gIAllbnVtIHBvcnQgcG9ydCA9IGVuY29k
ZXItPnBvcnQ7Cj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gIAo+IEBAIC03NTIs
NyArNzUyLDcgQEAgdm9pZCBpbnRlbF9hdWRpb19jb2RlY19kaXNhYmxlKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+ICB7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgCXN0cnVjdCBpOTE1X2F1ZGlvX2Nv
bXBvbmVudCAqYWNvbXAgPSBkZXZfcHJpdi0+YXVkaW9fY29tcG9uZW50Owo+IC0Jc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT5iYXNlLmNydGMp
Owo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0
YXRlLT51YXBpLmNydGMpOwo+ICAJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+ICAJ
ZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9idy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9idy5jCj4gaW5kZXggNjg4ODU4ZWJlNGQwLi5hODNhMjk3YmU5YTQgMTAwNjQ0
Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9idy5jCj4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9idy5jCj4gQEAgLTI2NCw3ICsyNjQs
NyBAQCBzdGF0aWMgdW5zaWduZWQgaW50IGludGVsX2J3X2NydGNfbnVtX2FjdGl2ZV9wbGFuZXMo
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdAo+ICAKPiAgc3RhdGljIHVuc2lnbmVkIGludCBp
bnRlbF9id19jcnRjX2RhdGFfcmF0ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRj
KGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRv
X2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXVuc2lnbmVkIGludCBkYXRh
X3JhdGUgPSAwOwo+ICAJZW51bSBwbGFuZV9pZCBwbGFuZV9pZDsKPiAgCj4gQEAgLTI4NSw3ICsy
ODUsNyBAQCBzdGF0aWMgdW5zaWduZWQgaW50IGludGVsX2J3X2NydGNfZGF0YV9yYXRlKGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjXwo+ICB2b2lkIGludGVsX2J3X2NydGNfdXBk
YXRlKHN0cnVjdCBpbnRlbF9id19zdGF0ZSAqYndfc3RhdGUsCj4gIAkJCSAgY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0
IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7
Cj4gIAo+ICAJYndfc3RhdGUtPmRhdGFfcmF0ZVtjcnRjLT5waXBlXSA9Cj4gIAkJaW50ZWxfYndf
Y3J0Y19kYXRhX3JhdGUoY3J0Y19zdGF0ZSk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfY2RjbGsuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfY2RjbGsuYwo+IGluZGV4IDQzNTY0Mjk1Yjg2NC4uMTdmZmU3ZmJhYTIxIDEwMDY0
NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfY2RjbGsuYwo+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfY2RjbGsuYwo+IEBAIC0xOTE3
LDEwICsxOTE3LDEwIEBAIHN0YXRpYyBpbnQgaW50ZWxfcGl4ZWxfcmF0ZV90b19jZGNsayhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gIGludCBpbnRlbF9jcnRjX2NvbXB1dGVf
bWluX2NkY2xrKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7
Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+IC0JCXRvX2k5MTUoY3J0
Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICsJCXRvX2k5MTUoY3J0Y19zdGF0ZS0+dWFwaS5j
cnRjLT5kZXYpOwo+ICAJaW50IG1pbl9jZGNsazsKPiAgCj4gLQlpZiAoIWNydGNfc3RhdGUtPmJh
c2UuZW5hYmxlKQo+ICsJaWYgKCFjcnRjX3N0YXRlLT5ody5lbmFibGUpCj4gIAkJcmV0dXJuIDA7
Cj4gIAo+ICAJbWluX2NkY2xrID0gaW50ZWxfcGl4ZWxfcmF0ZV90b19jZGNsayhkZXZfcHJpdiwg
Y3J0Y19zdGF0ZS0+cGl4ZWxfcmF0ZSk7Cj4gQEAgLTIwNDMsNyArMjA0Myw3IEBAIHN0YXRpYyB1
OCBieHRfY29tcHV0ZV9taW5fdm9sdGFnZV9sZXZlbChzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRl
ICpzdGF0ZSkKPiAgCSAgICAgICBzaXplb2Yoc3RhdGUtPm1pbl92b2x0YWdlX2xldmVsKSk7Cj4g
IAo+ICAJZm9yX2VhY2hfbmV3X2ludGVsX2NydGNfaW5fc3RhdGUoc3RhdGUsIGNydGMsIGNydGNf
c3RhdGUsIGkpIHsKPiAtCQlpZiAoY3J0Y19zdGF0ZS0+YmFzZS5lbmFibGUpCj4gKwkJaWYgKGNy
dGNfc3RhdGUtPmh3LmVuYWJsZSkKPiAgCQkJc3RhdGUtPm1pbl92b2x0YWdlX2xldmVsW2ldID0K
PiAgCQkJCWNydGNfc3RhdGUtPm1pbl92b2x0YWdlX2xldmVsOwo+ICAJCWVsc2UKPiBAQCAtMjEy
OSw3ICsyMTI5LDcgQEAgc3RhdGljIGludCBza2xfZHBsbDBfdmNvKHN0cnVjdCBpbnRlbF9hdG9t
aWNfc3RhdGUgKnN0YXRlKQo+ICAJCXZjbyA9IGRldl9wcml2LT5za2xfcHJlZmVycmVkX3Zjb19m
cmVxOwo+ICAKPiAgCWZvcl9lYWNoX25ld19pbnRlbF9jcnRjX2luX3N0YXRlKHN0YXRlLCBjcnRj
LCBjcnRjX3N0YXRlLCBpKSB7Cj4gLQkJaWYgKCFjcnRjX3N0YXRlLT5iYXNlLmVuYWJsZSkKPiAr
CQlpZiAoIWNydGNfc3RhdGUtPmh3LmVuYWJsZSkKPiAgCQkJY29udGludWU7Cj4gIAo+ICAJCWlm
ICghaW50ZWxfY3J0Y19oYXNfdHlwZShjcnRjX3N0YXRlLCBJTlRFTF9PVVRQVVRfRURQKSkKPiBA
QCAtMjI1NSwxMSArMjI1NSwxMSBAQCBzdGF0aWMgaW50IGludGVsX21vZGVzZXRfYWxsX3BpcGVz
KHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAJCWlmIChJU19FUlIoY3J0Y19z
dGF0ZSkpCj4gIAkJCXJldHVybiBQVFJfRVJSKGNydGNfc3RhdGUpOwo+ICAKPiAtCQlpZiAoIWNy
dGNfc3RhdGUtPmJhc2UuYWN0aXZlIHx8Cj4gLQkJICAgIGRybV9hdG9taWNfY3J0Y19uZWVkc19t
b2Rlc2V0KCZjcnRjX3N0YXRlLT5iYXNlKSkKPiArCQlpZiAoIWNydGNfc3RhdGUtPmh3LmFjdGl2
ZSB8fAo+ICsJCSAgICBkcm1fYXRvbWljX2NydGNfbmVlZHNfbW9kZXNldCgmY3J0Y19zdGF0ZS0+
dWFwaSkpCj4gIAkJCWNvbnRpbnVlOwo+ICAKPiAtCQljcnRjX3N0YXRlLT5iYXNlLm1vZGVfY2hh
bmdlZCA9IHRydWU7Cj4gKwkJY3J0Y19zdGF0ZS0+dWFwaS5tb2RlX2NoYW5nZWQgPSB0cnVlOwo+
ICAKPiAgCQlyZXQgPSBkcm1fYXRvbWljX2FkZF9hZmZlY3RlZF9jb25uZWN0b3JzKCZzdGF0ZS0+
YmFzZSwKPiAgCQkJCQkJCSAmY3J0Yy0+YmFzZSk7Cj4gQEAgLTIzMTAsNyArMjMxMCw3IEBAIGlu
dCBpbnRlbF9tb2Rlc2V0X2NhbGNfY2RjbGsoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3Rh
dGUpCj4gIAkJY3J0YyA9IGludGVsX2dldF9jcnRjX2Zvcl9waXBlKGRldl9wcml2LCBwaXBlKTsK
PiAgCQljcnRjX3N0YXRlID0gaW50ZWxfYXRvbWljX2dldF9uZXdfY3J0Y19zdGF0ZShzdGF0ZSwg
Y3J0Yyk7Cj4gIAkJaWYgKGNydGNfc3RhdGUgJiYKPiAtCQkgICAgZHJtX2F0b21pY19jcnRjX25l
ZWRzX21vZGVzZXQoJmNydGNfc3RhdGUtPmJhc2UpKQo+ICsJCSAgICBkcm1fYXRvbWljX2NydGNf
bmVlZHNfbW9kZXNldCgmY3J0Y19zdGF0ZS0+dWFwaSkpCj4gIAkJCXBpcGUgPSBJTlZBTElEX1BJ
UEU7Cj4gIAl9IGVsc2Ugewo+ICAJCXBpcGUgPSBJTlZBTElEX1BJUEU7Cj4gZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfY29sb3IuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfY29sb3IuYwo+IGluZGV4IDMxODMwOGRjMTM2Yy4uOWIw
NTg5MDdlZjRlIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfY29sb3IuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfY29s
b3IuYwo+IEBAIC0xMDEsMTAgKzEwMSwxMCBAQCBzdGF0aWMgYm9vbCBsdXRfaXNfbGVnYWN5KGNv
bnN0IHN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqbHV0KQo+ICAKPiAgc3RhdGljIGJvb2wgY3J0
Y19zdGF0ZV9pc19sZWdhY3lfZ2FtbWEoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUpCj4gIHsKPiAtCXJldHVybiAhY3J0Y19zdGF0ZS0+YmFzZS5kZWdhbW1hX2x1dCAm
Jgo+IC0JCSFjcnRjX3N0YXRlLT5iYXNlLmN0bSAmJgo+IC0JCWNydGNfc3RhdGUtPmJhc2UuZ2Ft
bWFfbHV0ICYmCj4gLQkJbHV0X2lzX2xlZ2FjeShjcnRjX3N0YXRlLT5iYXNlLmdhbW1hX2x1dCk7
Cj4gKwlyZXR1cm4gIWNydGNfc3RhdGUtPmh3LmRlZ2FtbWFfbHV0ICYmCj4gKwkJIWNydGNfc3Rh
dGUtPmh3LmN0bSAmJgo+ICsJCWNydGNfc3RhdGUtPmh3LmdhbW1hX2x1dCAmJgo+ICsJCWx1dF9p
c19sZWdhY3koY3J0Y19zdGF0ZS0+aHcuZ2FtbWFfbHV0KTsKPiAgfQo+ICAKPiAgLyoKPiBAQCAt
MTg5LDcgKzE4OSw3IEBAIHN0YXRpYyB2b2lkIGljbF91cGRhdGVfb3V0cHV0X2NzYyhzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YywKPiAgCj4gIHN0YXRpYyBib29sIGlsa19jc2NfbGltaXRlZF9yYW5n
ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNl
LmNydGMtPmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsKPiAgCj4gIAkvKgo+ICAJICogRklYTUUg
aWYgdGhlcmUncyBhIGdhbW1hIExVVCBhZnRlciB0aGUgQ1NDLCB3ZSBzaG91bGQKPiBAQCAtMjAz
LDcgKzIwMyw3IEBAIHN0YXRpYyBib29sIGlsa19jc2NfbGltaXRlZF9yYW5nZShjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgc3RhdGljIHZvaWQgaWxrX2NzY19j
b252ZXJ0X2N0bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAg
CQkJCXUxNiBjb2VmZnNbOV0pCj4gIHsKPiAtCWNvbnN0IHN0cnVjdCBkcm1fY29sb3JfY3RtICpj
dG0gPSBjcnRjX3N0YXRlLT5iYXNlLmN0bS0+ZGF0YTsKPiArCWNvbnN0IHN0cnVjdCBkcm1fY29s
b3JfY3RtICpjdG0gPSBjcnRjX3N0YXRlLT5ody5jdG0tPmRhdGE7Cj4gIAljb25zdCB1NjQgKmlu
cHV0Owo+ICAJdTY0IHRlbXBbOV07Cj4gIAlpbnQgaTsKPiBAQCAtMjU0LDExICsyNTQsMTEgQEAg
c3RhdGljIHZvaWQgaWxrX2NzY19jb252ZXJ0X2N0bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSwKPiAgCj4gIHN0YXRpYyB2b2lkIGlsa19sb2FkX2NzY19tYXRyaXgo
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHsKPiAtCXN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMp
Owo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUt
PnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCWJvb2wgbGltaXRlZF9jb2xvcl9yYW5nZSA9IGlsa19j
c2NfbGltaXRlZF9yYW5nZShjcnRjX3N0YXRlKTsKPiAgCj4gLQlpZiAoY3J0Y19zdGF0ZS0+YmFz
ZS5jdG0pIHsKPiArCWlmIChjcnRjX3N0YXRlLT5ody5jdG0pIHsKPiAgCQl1MTYgY29lZmZbOV07
Cj4gIAo+ICAJCWlsa19jc2NfY29udmVydF9jdG0oY3J0Y19zdGF0ZSwgY29lZmYpOwo+IEBAIC0y
OTMsMTAgKzI5MywxMCBAQCBzdGF0aWMgdm9pZCBpbGtfbG9hZF9jc2NfbWF0cml4KGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAKPiAgc3RhdGljIHZvaWQgaWNs
X2xvYWRfY3NjX21hdHJpeChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVs
X2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAKPiAtCWlmIChjcnRjX3N0
YXRlLT5iYXNlLmN0bSkgewo+ICsJaWYgKGNydGNfc3RhdGUtPmh3LmN0bSkgewo+ICAJCXUxNiBj
b2VmZls5XTsKPiAgCj4gIAkJaWxrX2NzY19jb252ZXJ0X2N0bShjcnRjX3N0YXRlLCBjb2VmZik7
Cj4gQEAgLTMyMiwxMiArMzIyLDEyIEBAIHN0YXRpYyB2b2lkIGljbF9sb2FkX2NzY19tYXRyaXgo
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gICAqLwo+ICBzdGF0
aWMgdm9pZCBjaGVycnl2aWV3X2xvYWRfY3NjX21hdHJpeChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0
b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+
ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAKPiAtCWlmIChjcnRjX3N0YXRlLT5i
YXNlLmN0bSkgewo+IC0JCWNvbnN0IHN0cnVjdCBkcm1fY29sb3JfY3RtICpjdG0gPSBjcnRjX3N0
YXRlLT5iYXNlLmN0bS0+ZGF0YTsKPiArCWlmIChjcnRjX3N0YXRlLT5ody5jdG0pIHsKPiArCQlj
b25zdCBzdHJ1Y3QgZHJtX2NvbG9yX2N0bSAqY3RtID0gY3J0Y19zdGF0ZS0+aHcuY3RtLT5kYXRh
Owo+ICAJCXUxNiBjb2VmZnNbOV0gPSB7fTsKPiAgCQlpbnQgaTsKPiAgCj4gQEAgLTM4OCw3ICsz
ODgsNyBAQCBzdGF0aWMgdTMyIGlsa19sdXRfMTAoY29uc3Qgc3RydWN0IGRybV9jb2xvcl9sdXQg
KmNvbG9yKQo+ICBzdGF0aWMgdm9pZCBpOXh4X2xvYWRfbHV0c19pbnRlcm5hbChjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgCQkJCSAgICBjb25zdCBzdHJ1Y3Qg
ZHJtX3Byb3BlcnR5X2Jsb2IgKmJsb2IpCj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
ID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVs
X2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2
KTsKPiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCWludCBpOwo+IEBAIC00MTks
MTIgKzQxOSwxMiBAQCBzdGF0aWMgdm9pZCBpOXh4X2xvYWRfbHV0c19pbnRlcm5hbChjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgCj4gIHN0YXRpYyB2b2lkIGk5
eHhfbG9hZF9sdXRzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+
ICB7Cj4gLQlpOXh4X2xvYWRfbHV0c19pbnRlcm5hbChjcnRjX3N0YXRlLCBjcnRjX3N0YXRlLT5i
YXNlLmdhbW1hX2x1dCk7Cj4gKwlpOXh4X2xvYWRfbHV0c19pbnRlcm5hbChjcnRjX3N0YXRlLCBj
cnRjX3N0YXRlLT5ody5nYW1tYV9sdXQpOwo+ICB9Cj4gIAo+ICBzdGF0aWMgdm9pZCBpOXh4X2Nv
bG9yX2NvbW1pdChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAg
ewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUt
PmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMo
Y3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRj
LT5waXBlOwo+ICAJdTMyIHZhbDsKPiBAQCAtNDM3LDcgKzQzNyw3IEBAIHN0YXRpYyB2b2lkIGk5
eHhfY29sb3JfY29tbWl0KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
KQo+ICAKPiAgc3RhdGljIHZvaWQgaWxrX2NvbG9yX2NvbW1pdChjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMg
PSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYp
Owo+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAJdTMyIHZhbDsKPiBAQCAtNDUy
LDcgKzQ1Miw3IEBAIHN0YXRpYyB2b2lkIGlsa19jb2xvcl9jb21taXQoY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIAo+ICBzdGF0aWMgdm9pZCBoc3dfY29sb3Jf
Y29tbWl0KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4g
LQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFz
ZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRj
X3N0YXRlLT51YXBpLmNydGMpOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gIAo+ICAJSTkxNV9XUklURShHQU1NQV9NT0RF
KGNydGMtPnBpcGUpLCBjcnRjX3N0YXRlLT5nYW1tYV9tb2RlKTsKPiBAQCAtNDYyLDcgKzQ2Miw3
IEBAIHN0YXRpYyB2b2lkIGhzd19jb2xvcl9jb21taXQoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCj4gIAo+ICBzdGF0aWMgdm9pZCBza2xfY29sb3JfY29tbWl0KGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsK
PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51
YXBpLmNydGMpOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjcnRjLT5iYXNlLmRldik7Cj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gIAl1
MzIgdmFsID0gMDsKPiBAQCAtNTA4LDggKzUwOCw4IEBAIHN0YXRpYyB2b2lkIGk5NjVfbG9hZF9s
dXRfMTBwNihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgCj4gIHN0YXRpYyB2b2lkIGk5NjVf
bG9hZF9sdXRzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7
Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+
YmFzZS5jcnRjKTsKPiAtCWNvbnN0IHN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqZ2FtbWFfbHV0
ID0gY3J0Y19zdGF0ZS0+YmFzZS5nYW1tYV9sdXQ7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiArCWNvbnN0IHN0cnVj
dCBkcm1fcHJvcGVydHlfYmxvYiAqZ2FtbWFfbHV0ID0gY3J0Y19zdGF0ZS0+aHcuZ2FtbWFfbHV0
Owo+ICAKPiAgCWlmIChjcnRjX3N0YXRlLT5nYW1tYV9tb2RlID09IEdBTU1BX01PREVfTU9ERV84
QklUKQo+ICAJCWk5eHhfbG9hZF9sdXRzKGNydGNfc3RhdGUpOwo+IEBAIC01MzEsOCArNTMxLDgg
QEAgc3RhdGljIHZvaWQgaWxrX2xvYWRfbHV0XzEwKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+
ICAKPiAgc3RhdGljIHZvaWQgaWxrX2xvYWRfbHV0cyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19p
bnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gLQljb25zdCBzdHJ1Y3QgZHJtX3By
b3BlcnR5X2Jsb2IgKmdhbW1hX2x1dCA9IGNydGNfc3RhdGUtPmJhc2UuZ2FtbWFfbHV0Owo+ICsJ
c3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGku
Y3J0Yyk7Cj4gKwljb25zdCBzdHJ1Y3QgZHJtX3Byb3BlcnR5X2Jsb2IgKmdhbW1hX2x1dCA9IGNy
dGNfc3RhdGUtPmh3LmdhbW1hX2x1dDsKPiAgCj4gIAlpZiAoY3J0Y19zdGF0ZS0+Z2FtbWFfbW9k
ZSA9PSBHQU1NQV9NT0RFX01PREVfOEJJVCkKPiAgCQlpOXh4X2xvYWRfbHV0cyhjcnRjX3N0YXRl
KTsKPiBAQCAtNjMyLDkgKzYzMiw5IEBAIHN0YXRpYyB2b2lkIGl2Yl9sb2FkX2x1dF9leHRfbWF4
KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+ICAKPiAgc3RhdGljIHZvaWQgaXZiX2xvYWRfbHV0
cyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0
Yyk7Cj4gLQljb25zdCBzdHJ1Y3QgZHJtX3Byb3BlcnR5X2Jsb2IgKmdhbW1hX2x1dCA9IGNydGNf
c3RhdGUtPmJhc2UuZ2FtbWFfbHV0Owo+IC0JY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9i
ICpkZWdhbW1hX2x1dCA9IGNydGNfc3RhdGUtPmJhc2UuZGVnYW1tYV9sdXQ7Cj4gKwlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsK
PiArCWNvbnN0IHN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqZ2FtbWFfbHV0ID0gY3J0Y19zdGF0
ZS0+aHcuZ2FtbWFfbHV0Owo+ICsJY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpkZWdh
bW1hX2x1dCA9IGNydGNfc3RhdGUtPmh3LmRlZ2FtbWFfbHV0Owo+ICAKPiAgCWlmIChjcnRjX3N0
YXRlLT5nYW1tYV9tb2RlID09IEdBTU1BX01PREVfTU9ERV84QklUKSB7Cj4gIAkJaTl4eF9sb2Fk
X2x1dHMoY3J0Y19zdGF0ZSk7Cj4gQEAgLTY1NSw5ICs2NTUsOSBAQCBzdGF0aWMgdm9pZCBpdmJf
bG9hZF9sdXRzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAK
PiAgc3RhdGljIHZvaWQgYmR3X2xvYWRfbHV0cyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gLQljb25zdCBzdHJ1Y3QgZHJtX3Byb3Bl
cnR5X2Jsb2IgKmdhbW1hX2x1dCA9IGNydGNfc3RhdGUtPmJhc2UuZ2FtbWFfbHV0Owo+IC0JY29u
c3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpkZWdhbW1hX2x1dCA9IGNydGNfc3RhdGUtPmJh
c2UuZGVnYW1tYV9sdXQ7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2Ny
dGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiArCWNvbnN0IHN0cnVjdCBkcm1fcHJvcGVydHlf
YmxvYiAqZ2FtbWFfbHV0ID0gY3J0Y19zdGF0ZS0+aHcuZ2FtbWFfbHV0Owo+ICsJY29uc3Qgc3Ry
dWN0IGRybV9wcm9wZXJ0eV9ibG9iICpkZWdhbW1hX2x1dCA9IGNydGNfc3RhdGUtPmh3LmRlZ2Ft
bWFfbHV0Owo+ICAKPiAgCWlmIChjcnRjX3N0YXRlLT5nYW1tYV9tb2RlID09IEdBTU1BX01PREVf
TU9ERV84QklUKSB7Cj4gIAkJaTl4eF9sb2FkX2x1dHMoY3J0Y19zdGF0ZSk7Cj4gQEAgLTY3OCwx
MSArNjc4LDExIEBAIHN0YXRpYyB2b2lkIGJkd19sb2FkX2x1dHMoY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIAo+ICBzdGF0aWMgdm9pZCBnbGtfbG9hZF9kZWdh
bW1hX2x1dChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+
IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJh
c2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0
Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5w
aXBlOwo+ICAJY29uc3QgdTMyIGx1dF9zaXplID0gSU5URUxfSU5GTyhkZXZfcHJpdiktPmNvbG9y
LmRlZ2FtbWFfbHV0X3NpemU7Cj4gLQljb25zdCBzdHJ1Y3QgZHJtX2NvbG9yX2x1dCAqbHV0ID0g
Y3J0Y19zdGF0ZS0+YmFzZS5kZWdhbW1hX2x1dC0+ZGF0YTsKPiArCWNvbnN0IHN0cnVjdCBkcm1f
Y29sb3JfbHV0ICpsdXQgPSBjcnRjX3N0YXRlLT5ody5kZWdhbW1hX2x1dC0+ZGF0YTsKPiAgCXUz
MiBpOwo+ICAKPiAgCS8qCj4gQEAgLTcxNyw3ICs3MTcsNyBAQCBzdGF0aWMgdm9pZCBnbGtfbG9h
ZF9kZWdhbW1hX2x1dChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkK
PiAgCj4gIHN0YXRpYyB2b2lkIGdsa19sb2FkX2RlZ2FtbWFfbHV0X2xpbmVhcihjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2Ny
dGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRj
KTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+
YmFzZS5kZXYpOwo+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAJY29uc3QgdTMy
IGx1dF9zaXplID0gSU5URUxfSU5GTyhkZXZfcHJpdiktPmNvbG9yLmRlZ2FtbWFfbHV0X3NpemU7
Cj4gQEAgLTc0NCw4ICs3NDQsOCBAQCBzdGF0aWMgdm9pZCBnbGtfbG9hZF9kZWdhbW1hX2x1dF9s
aW5lYXIoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdAo+ICAKPiAgc3Rh
dGljIHZvaWQgZ2xrX2xvYWRfbHV0cyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSkKPiAgewo+IC0JY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpnYW1tYV9s
dXQgPSBjcnRjX3N0YXRlLT5iYXNlLmdhbW1hX2x1dDsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJY29uc3Qgc3Ry
dWN0IGRybV9wcm9wZXJ0eV9ibG9iICpnYW1tYV9sdXQgPSBjcnRjX3N0YXRlLT5ody5nYW1tYV9s
dXQ7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0
ZS0+dWFwaS5jcnRjKTsKPiAgCj4gIAkvKgo+ICAJICogT24gR0xLKyBib3RoIHBpcGUgQ1NDIGFu
ZCBkZWdhbW1hIExVVCBhcmUgY29udHJvbGxlZAo+IEBAIC03NTUsNyArNzU1LDcgQEAgc3RhdGlj
IHZvaWQgZ2xrX2xvYWRfbHV0cyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSkKPiAgCSAqIHRoZSBkZWdhbWEgTFVUIHNvIHRoYXQgd2UgZG9uJ3QgaGF2ZSB0byByZWxv
YWQKPiAgCSAqIGl0IGV2ZXJ5IHRpbWUgdGhlIHBpcGUgQ1NDIGlzIGJlaW5nIGVuYWJsZWQuCj4g
IAkgKi8KPiAtCWlmIChjcnRjX3N0YXRlLT5iYXNlLmRlZ2FtbWFfbHV0KQo+ICsJaWYgKGNydGNf
c3RhdGUtPmh3LmRlZ2FtbWFfbHV0KQo+ICAJCWdsa19sb2FkX2RlZ2FtbWFfbHV0KGNydGNfc3Rh
dGUpOwo+ICAJZWxzZQo+ICAJCWdsa19sb2FkX2RlZ2FtbWFfbHV0X2xpbmVhcihjcnRjX3N0YXRl
KTsKPiBAQCAtNzg2LDcgKzc4Niw3IEBAIHN0YXRpYyB2b2lkCj4gIGljbF9sb2FkX2djbWF4KGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAJICAgICAgIGNvbnN0
IHN0cnVjdCBkcm1fY29sb3JfbHV0ICpjb2xvcikKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMg
KmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsK
PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFz
ZS5kZXYpOwo+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAKPiBAQCAtNzk5LDkg
Kzc5OSw5IEBAIGljbF9sb2FkX2djbWF4KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLAo+ICBzdGF0aWMgdm9pZAo+ICBpY2xfcHJvZ3JhbV9nYW1tYV9zdXBlcmZpbmVf
c2VnbWVudChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+
IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJh
c2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0
Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+IC0JY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0
eV9ibG9iICpibG9iID0gY3J0Y19zdGF0ZS0+YmFzZS5nYW1tYV9sdXQ7Cj4gKwljb25zdCBzdHJ1
Y3QgZHJtX3Byb3BlcnR5X2Jsb2IgKmJsb2IgPSBjcnRjX3N0YXRlLT5ody5nYW1tYV9sdXQ7Cj4g
IAljb25zdCBzdHJ1Y3QgZHJtX2NvbG9yX2x1dCAqbHV0ID0gYmxvYi0+ZGF0YTsKPiAgCWVudW0g
cGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCXUzMiBpOwo+IEBAIC04MjgsOSArODI4LDkgQEAg
aWNsX3Byb2dyYW1fZ2FtbWFfc3VwZXJmaW5lX3NlZ21lbnQoY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHN0YXRpYyB2b2lkCj4gIGljbF9wcm9ncmFtX2dhbW1h
X211bHRpX3NlZ21lbnQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUp
Cj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0
YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9j
cnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAtCWNvbnN0IHN0cnVjdCBkcm1f
cHJvcGVydHlfYmxvYiAqYmxvYiA9IGNydGNfc3RhdGUtPmJhc2UuZ2FtbWFfbHV0Owo+ICsJY29u
c3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpibG9iID0gY3J0Y19zdGF0ZS0+aHcuZ2FtbWFf
bHV0Owo+ICAJY29uc3Qgc3RydWN0IGRybV9jb2xvcl9sdXQgKmx1dCA9IGJsb2ItPmRhdGE7Cj4g
IAljb25zdCBzdHJ1Y3QgZHJtX2NvbG9yX2x1dCAqZW50cnk7Cj4gIAllbnVtIHBpcGUgcGlwZSA9
IGNydGMtPnBpcGU7Cj4gQEAgLTg4MCwxMCArODgwLDEwIEBAIGljbF9wcm9ncmFtX2dhbW1hX211
bHRpX3NlZ21lbnQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4g
IAo+ICBzdGF0aWMgdm9pZCBpY2xfbG9hZF9sdXRzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gLQljb25zdCBzdHJ1Y3QgZHJtX3Byb3BlcnR5X2Jsb2Ig
KmdhbW1hX2x1dCA9IGNydGNfc3RhdGUtPmJhc2UuZ2FtbWFfbHV0Owo+IC0Jc3RydWN0IGludGVs
X2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlj
b25zdCBzdHJ1Y3QgZHJtX3Byb3BlcnR5X2Jsb2IgKmdhbW1hX2x1dCA9IGNydGNfc3RhdGUtPmh3
LmdhbW1hX2x1dDsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0Yyhj
cnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAKPiAtCWlmIChjcnRjX3N0YXRlLT5iYXNlLmRlZ2Ft
bWFfbHV0KQo+ICsJaWYgKGNydGNfc3RhdGUtPmh3LmRlZ2FtbWFfbHV0KQo+ICAJCWdsa19sb2Fk
X2RlZ2FtbWFfbHV0KGNydGNfc3RhdGUpOwo+ICAKPiAgCXN3aXRjaCAoY3J0Y19zdGF0ZS0+Z2Ft
bWFfbW9kZSAmIEdBTU1BX01PREVfTU9ERV9NQVNLKSB7Cj4gQEAgLTk1OCw5ICs5NTgsOSBAQCBz
dGF0aWMgdm9pZCBjaHZfbG9hZF9jZ21fZ2FtbWEoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4g
IAo+ICBzdGF0aWMgdm9pZCBjaHZfbG9hZF9sdXRzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAtCWNvbnN0IHN0cnVjdCBkcm1fcHJv
cGVydHlfYmxvYiAqZ2FtbWFfbHV0ID0gY3J0Y19zdGF0ZS0+YmFzZS5nYW1tYV9sdXQ7Cj4gLQlj
b25zdCBzdHJ1Y3QgZHJtX3Byb3BlcnR5X2Jsb2IgKmRlZ2FtbWFfbHV0ID0gY3J0Y19zdGF0ZS0+
YmFzZS5kZWdhbW1hX2x1dDsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxf
Y3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICsJY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0
eV9ibG9iICpnYW1tYV9sdXQgPSBjcnRjX3N0YXRlLT5ody5nYW1tYV9sdXQ7Cj4gKwljb25zdCBz
dHJ1Y3QgZHJtX3Byb3BlcnR5X2Jsb2IgKmRlZ2FtbWFfbHV0ID0gY3J0Y19zdGF0ZS0+aHcuZGVn
YW1tYV9sdXQ7Cj4gIAo+ICAJY2hlcnJ5dmlld19sb2FkX2NzY19tYXRyaXgoY3J0Y19zdGF0ZSk7
Cj4gIAo+IEBAIC05NzgsMjggKzk3OCwyOCBAQCBzdGF0aWMgdm9pZCBjaHZfbG9hZF9sdXRzKGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAKPiAgdm9pZCBpbnRl
bF9jb2xvcl9sb2FkX2x1dHMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUpCj4gIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
Y3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT51YXBpLmNydGMtPmRldik7Cj4gIAo+ICAJ
ZGV2X3ByaXYtPmRpc3BsYXkubG9hZF9sdXRzKGNydGNfc3RhdGUpOwo+ICB9Cj4gIAo+ICB2b2lk
IGludGVsX2NvbG9yX2NvbW1pdChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSkKPiAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsKPiAgCj4g
IAlkZXZfcHJpdi0+ZGlzcGxheS5jb2xvcl9jb21taXQoY3J0Y19zdGF0ZSk7Cj4gIH0KPiAgCj4g
IGludCBpbnRlbF9jb2xvcl9jaGVjayhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSkKPiAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShj
cnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsKPiAgCj4gIAly
ZXR1cm4gZGV2X3ByaXYtPmRpc3BsYXkuY29sb3JfY2hlY2soY3J0Y19zdGF0ZSk7Cj4gIH0KPiAg
Cj4gIHZvaWQgaW50ZWxfY29sb3JfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsK
PiAgCj4gIAlpZiAoZGV2X3ByaXYtPmRpc3BsYXkucmVhZF9sdXRzKQo+ICAJCWRldl9wcml2LT5k
aXNwbGF5LnJlYWRfbHV0cyhjcnRjX3N0YXRlKTsKPiBAQCAtMTAyMywxNiArMTAyMywxNiBAQCBz
dGF0aWMgYm9vbCBuZWVkX3BsYW5lX3VwZGF0ZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+
ICBzdGF0aWMgaW50Cj4gIGludGVsX2NvbG9yX2FkZF9hZmZlY3RlZF9wbGFuZXMoc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YyA9IHRvX2ludGVsX2NydGMobmV3X2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMobmV3X2NydGNfc3RhdGUtPnVh
cGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGNydGMtPmJhc2UuZGV2KTsKPiAgCXN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlID0K
PiAtCQl0b19pbnRlbF9hdG9taWNfc3RhdGUobmV3X2NydGNfc3RhdGUtPmJhc2Uuc3RhdGUpOwo+
ICsJCXRvX2ludGVsX2F0b21pY19zdGF0ZShuZXdfY3J0Y19zdGF0ZS0+dWFwaS5zdGF0ZSk7Cj4g
IAljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUgPQo+ICAJCWlu
dGVsX2F0b21pY19nZXRfb2xkX2NydGNfc3RhdGUoc3RhdGUsIGNydGMpOwo+ICAJc3RydWN0IGlu
dGVsX3BsYW5lICpwbGFuZTsKPiAgCj4gLQlpZiAoIW5ld19jcnRjX3N0YXRlLT5iYXNlLmFjdGl2
ZSB8fAo+IC0JICAgIGRybV9hdG9taWNfY3J0Y19uZWVkc19tb2Rlc2V0KCZuZXdfY3J0Y19zdGF0
ZS0+YmFzZSkpCj4gKwlpZiAoIW5ld19jcnRjX3N0YXRlLT5ody5hY3RpdmUgfHwKPiArCSAgICBk
cm1fYXRvbWljX2NydGNfbmVlZHNfbW9kZXNldCgmbmV3X2NydGNfc3RhdGUtPnVhcGkpKQo+ICAJ
CXJldHVybiAwOwo+ICAKPiAgCWlmIChuZXdfY3J0Y19zdGF0ZS0+Z2FtbWFfZW5hYmxlID09IG9s
ZF9jcnRjX3N0YXRlLT5nYW1tYV9lbmFibGUgJiYKPiBAQCAtMTA3NCw5ICsxMDc0LDkgQEAgc3Rh
dGljIGludCBjaGVja19sdXRfc2l6ZShjb25zdCBzdHJ1Y3QgZHJtX3Byb3BlcnR5X2Jsb2IgKmx1
dCwgaW50IGV4cGVjdGVkKQo+ICAKPiAgc3RhdGljIGludCBjaGVja19sdXRzKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsK
PiAtCWNvbnN0IHN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqZ2FtbWFfbHV0ID0gY3J0Y19zdGF0
ZS0+YmFzZS5nYW1tYV9sdXQ7Cj4gLQljb25zdCBzdHJ1Y3QgZHJtX3Byb3BlcnR5X2Jsb2IgKmRl
Z2FtbWFfbHV0ID0gY3J0Y19zdGF0ZS0+YmFzZS5kZWdhbW1hX2x1dDsKPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjLT5k
ZXYpOwo+ICsJY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpnYW1tYV9sdXQgPSBjcnRj
X3N0YXRlLT5ody5nYW1tYV9sdXQ7Cj4gKwljb25zdCBzdHJ1Y3QgZHJtX3Byb3BlcnR5X2Jsb2Ig
KmRlZ2FtbWFfbHV0ID0gY3J0Y19zdGF0ZS0+aHcuZGVnYW1tYV9sdXQ7Cj4gIAlpbnQgZ2FtbWFf
bGVuZ3RoLCBkZWdhbW1hX2xlbmd0aDsKPiAgCXUzMiBnYW1tYV90ZXN0cywgZGVnYW1tYV90ZXN0
czsKPiAgCj4gQEAgLTExMjQsNyArMTEyNCw3IEBAIHN0YXRpYyBpbnQgaTl4eF9jb2xvcl9jaGVj
ayhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgCQlyZXR1cm4gcmV0Owo+
ICAKPiAgCWNydGNfc3RhdGUtPmdhbW1hX2VuYWJsZSA9Cj4gLQkJY3J0Y19zdGF0ZS0+YmFzZS5n
YW1tYV9sdXQgJiYKPiArCQljcnRjX3N0YXRlLT5ody5nYW1tYV9sdXQgJiYKPiAgCQkhY3J0Y19z
dGF0ZS0+YzhfcGxhbmVzOwo+ICAKPiAgCWNydGNfc3RhdGUtPmdhbW1hX21vZGUgPSBpOXh4X2dh
bW1hX21vZGUoY3J0Y19zdGF0ZSk7Cj4gQEAgLTExNDMsMTEgKzExNDMsMTEgQEAgc3RhdGljIHUz
MiBjaHZfY2dtX21vZGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUp
Cj4gIAlpZiAoY3J0Y19zdGF0ZV9pc19sZWdhY3lfZ2FtbWEoY3J0Y19zdGF0ZSkpCj4gIAkJcmV0
dXJuIDA7Cj4gIAo+IC0JaWYgKGNydGNfc3RhdGUtPmJhc2UuZGVnYW1tYV9sdXQpCj4gKwlpZiAo
Y3J0Y19zdGF0ZS0+aHcuZGVnYW1tYV9sdXQpCj4gIAkJY2dtX21vZGUgfD0gQ0dNX1BJUEVfTU9E
RV9ERUdBTU1BOwo+IC0JaWYgKGNydGNfc3RhdGUtPmJhc2UuY3RtKQo+ICsJaWYgKGNydGNfc3Rh
dGUtPmh3LmN0bSkKPiAgCQljZ21fbW9kZSB8PSBDR01fUElQRV9NT0RFX0NTQzsKPiAtCWlmIChj
cnRjX3N0YXRlLT5iYXNlLmdhbW1hX2x1dCkKPiArCWlmIChjcnRjX3N0YXRlLT5ody5nYW1tYV9s
dXQpCj4gIAkJY2dtX21vZGUgfD0gQ0dNX1BJUEVfTU9ERV9HQU1NQTsKPiAgCj4gIAlyZXR1cm4g
Y2dtX21vZGU7Cj4gQEAgLTEyMDYsNyArMTIwNiw3IEBAIHN0YXRpYyBpbnQgaWxrX2NvbG9yX2No
ZWNrKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAJCXJldHVybiByZXQ7
Cj4gIAo+ICAJY3J0Y19zdGF0ZS0+Z2FtbWFfZW5hYmxlID0KPiAtCQljcnRjX3N0YXRlLT5iYXNl
LmdhbW1hX2x1dCAmJgo+ICsJCWNydGNfc3RhdGUtPmh3LmdhbW1hX2x1dCAmJgo+ICAJCSFjcnRj
X3N0YXRlLT5jOF9wbGFuZXM7Cj4gIAo+ICAJLyoKPiBAQCAtMTIzMiw4ICsxMjMyLDggQEAgc3Rh
dGljIHUzMiBpdmJfZ2FtbWFfbW9kZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSkKPiAgCWlmICghY3J0Y19zdGF0ZS0+Z2FtbWFfZW5hYmxlIHx8Cj4gIAkgICAgY3J0
Y19zdGF0ZV9pc19sZWdhY3lfZ2FtbWEoY3J0Y19zdGF0ZSkpCj4gIAkJcmV0dXJuIEdBTU1BX01P
REVfTU9ERV84QklUOwo+IC0JZWxzZSBpZiAoY3J0Y19zdGF0ZS0+YmFzZS5nYW1tYV9sdXQgJiYK
PiAtCQkgY3J0Y19zdGF0ZS0+YmFzZS5kZWdhbW1hX2x1dCkKPiArCWVsc2UgaWYgKGNydGNfc3Rh
dGUtPmh3LmdhbW1hX2x1dCAmJgo+ICsJCSBjcnRjX3N0YXRlLT5ody5kZWdhbW1hX2x1dCkKPiAg
CQlyZXR1cm4gR0FNTUFfTU9ERV9NT0RFX1NQTElUOwo+ICAJZWxzZQo+ICAJCXJldHVybiBHQU1N
QV9NT0RFX01PREVfMTBCSVQ7Cj4gQEAgLTEyNDcsNyArMTI0Nyw3IEBAIHN0YXRpYyB1MzIgaXZi
X2NzY19tb2RlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAJ
ICogQ1NDIGNvbWVzIGFmdGVyIHRoZSBMVVQgaW4gZGVnYW1tYSwgUkdCLT5ZQ2JDciwKPiAgCSAq
IGFuZCBSR0IgZnVsbC0+bGltaXRlZCByYW5nZSBtb2RlLgo+ICAJICovCj4gLQlpZiAoY3J0Y19z
dGF0ZS0+YmFzZS5kZWdhbW1hX2x1dCB8fAo+ICsJaWYgKGNydGNfc3RhdGUtPmh3LmRlZ2FtbWFf
bHV0IHx8Cj4gIAkgICAgY3J0Y19zdGF0ZS0+b3V0cHV0X2Zvcm1hdCAhPSBJTlRFTF9PVVRQVVRf
Rk9STUFUX1JHQiB8fAo+ICAJICAgIGxpbWl0ZWRfY29sb3JfcmFuZ2UpCj4gIAkJcmV0dXJuIDA7
Cj4gQEAgLTEyNjUsMTMgKzEyNjUsMTMgQEAgc3RhdGljIGludCBpdmJfY29sb3JfY2hlY2soc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIAkJcmV0dXJuIHJldDsKPiAgCj4g
IAljcnRjX3N0YXRlLT5nYW1tYV9lbmFibGUgPQo+IC0JCShjcnRjX3N0YXRlLT5iYXNlLmdhbW1h
X2x1dCB8fAo+IC0JCSBjcnRjX3N0YXRlLT5iYXNlLmRlZ2FtbWFfbHV0KSAmJgo+ICsJCShjcnRj
X3N0YXRlLT5ody5nYW1tYV9sdXQgfHwKPiArCQkgY3J0Y19zdGF0ZS0+aHcuZGVnYW1tYV9sdXQp
ICYmCj4gIAkJIWNydGNfc3RhdGUtPmM4X3BsYW5lczsKPiAgCj4gIAljcnRjX3N0YXRlLT5jc2Nf
ZW5hYmxlID0KPiAgCQljcnRjX3N0YXRlLT5vdXRwdXRfZm9ybWF0ICE9IElOVEVMX09VVFBVVF9G
T1JNQVRfUkdCIHx8Cj4gLQkJY3J0Y19zdGF0ZS0+YmFzZS5jdG0gfHwgbGltaXRlZF9jb2xvcl9y
YW5nZTsKPiArCQljcnRjX3N0YXRlLT5ody5jdG0gfHwgbGltaXRlZF9jb2xvcl9yYW5nZTsKPiAg
Cj4gIAljcnRjX3N0YXRlLT5nYW1tYV9tb2RlID0gaXZiX2dhbW1hX21vZGUoY3J0Y19zdGF0ZSk7
Cj4gIAo+IEBAIC0xMzAyLDE0ICsxMzAyLDE0IEBAIHN0YXRpYyBpbnQgZ2xrX2NvbG9yX2NoZWNr
KHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAJCXJldHVybiByZXQ7Cj4g
IAo+ICAJY3J0Y19zdGF0ZS0+Z2FtbWFfZW5hYmxlID0KPiAtCQljcnRjX3N0YXRlLT5iYXNlLmdh
bW1hX2x1dCAmJgo+ICsJCWNydGNfc3RhdGUtPmh3LmdhbW1hX2x1dCAmJgo+ICAJCSFjcnRjX3N0
YXRlLT5jOF9wbGFuZXM7Cj4gIAo+ICAJLyogT24gR0xLKyBkZWdhbW1hIExVVCBpcyBjb250cm9s
bGVkIGJ5IGNzY19lbmFibGUgKi8KPiAgCWNydGNfc3RhdGUtPmNzY19lbmFibGUgPQo+IC0JCWNy
dGNfc3RhdGUtPmJhc2UuZGVnYW1tYV9sdXQgfHwKPiArCQljcnRjX3N0YXRlLT5ody5kZWdhbW1h
X2x1dCB8fAo+ICAJCWNydGNfc3RhdGUtPm91dHB1dF9mb3JtYXQgIT0gSU5URUxfT1VUUFVUX0ZP
Uk1BVF9SR0IgfHwKPiAtCQljcnRjX3N0YXRlLT5iYXNlLmN0bSB8fCBjcnRjX3N0YXRlLT5saW1p
dGVkX2NvbG9yX3JhbmdlOwo+ICsJCWNydGNfc3RhdGUtPmh3LmN0bSB8fCBjcnRjX3N0YXRlLT5s
aW1pdGVkX2NvbG9yX3JhbmdlOwo+ICAKPiAgCWNydGNfc3RhdGUtPmdhbW1hX21vZGUgPSBnbGtf
Z2FtbWFfbW9kZShjcnRjX3N0YXRlKTsKPiAgCj4gQEAgLTEzMjYsMTQgKzEzMjYsMTQgQEAgc3Rh
dGljIHUzMiBpY2xfZ2FtbWFfbW9kZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSkKPiAgewo+ICAJdTMyIGdhbW1hX21vZGUgPSAwOwo+ICAKPiAtCWlmIChjcnRjX3N0
YXRlLT5iYXNlLmRlZ2FtbWFfbHV0KQo+ICsJaWYgKGNydGNfc3RhdGUtPmh3LmRlZ2FtbWFfbHV0
KQo+ICAJCWdhbW1hX21vZGUgfD0gUFJFX0NTQ19HQU1NQV9FTkFCTEU7Cj4gIAo+IC0JaWYgKGNy
dGNfc3RhdGUtPmJhc2UuZ2FtbWFfbHV0ICYmCj4gKwlpZiAoY3J0Y19zdGF0ZS0+aHcuZ2FtbWFf
bHV0ICYmCj4gIAkgICAgIWNydGNfc3RhdGUtPmM4X3BsYW5lcykKPiAgCQlnYW1tYV9tb2RlIHw9
IFBPU1RfQ1NDX0dBTU1BX0VOQUJMRTsKPiAgCj4gLQlpZiAoIWNydGNfc3RhdGUtPmJhc2UuZ2Ft
bWFfbHV0IHx8Cj4gKwlpZiAoIWNydGNfc3RhdGUtPmh3LmdhbW1hX2x1dCB8fAo+ICAJICAgIGNy
dGNfc3RhdGVfaXNfbGVnYWN5X2dhbW1hKGNydGNfc3RhdGUpKQo+ICAJCWdhbW1hX21vZGUgfD0g
R0FNTUFfTU9ERV9NT0RFXzhCSVQ7Cj4gIAllbHNlCj4gQEAgLTEzNDYsNyArMTM0Niw3IEBAIHN0
YXRpYyB1MzIgaWNsX2NzY19tb2RlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlKQo+ICB7Cj4gIAl1MzIgY3NjX21vZGUgPSAwOwo+ICAKPiAtCWlmIChjcnRjX3N0YXRl
LT5iYXNlLmN0bSkKPiArCWlmIChjcnRjX3N0YXRlLT5ody5jdG0pCj4gIAkJY3NjX21vZGUgfD0g
SUNMX0NTQ19FTkFCTEU7Cj4gIAo+ICAJaWYgKGNydGNfc3RhdGUtPm91dHB1dF9mb3JtYXQgIT0g
SU5URUxfT1VUUFVUX0ZPUk1BVF9SR0IgfHwKPiBAQCAtMTQyMyw3ICsxNDIzLDcgQEAgc3RhdGlj
IGludCBnbGtfZ2FtbWFfcHJlY2lzaW9uKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlKQo+ICAKPiAgaW50IGludGVsX2NvbG9yX2dldF9nYW1tYV9iaXRfcHJlY2lzaW9u
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRj
KTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRl
LT51YXBpLmNydGMpOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShjcnRjLT5iYXNlLmRldik7Cj4gIAo+ICAJaWYgKCFjcnRjX3N0YXRlLT5nYW1tYV9lbmFi
bGUpCj4gQEAgLTE1MzIsNyArMTUzMiw3IEBAIHN0YXRpYyB1MzIgaW50ZWxfY29sb3JfbHV0X3Bh
Y2sodTMyIHZhbCwgdTMyIGJpdF9wcmVjaXNpb24pCj4gIHN0YXRpYyBzdHJ1Y3QgZHJtX3Byb3Bl
cnR5X2Jsb2IgKgo+ICBpOXh4X3JlYWRfbHV0XzgoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50
ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNy
dGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCWVu
dW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCXN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAq
YmxvYjsKPiBAQCAtMTU2NiwxMyArMTU2NiwxMyBAQCBpOXh4X3JlYWRfbHV0XzgoY29uc3Qgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIAo+ICBzdGF0aWMgdm9pZCBpOXh4
X3JlYWRfbHV0cyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0J
Y3J0Y19zdGF0ZS0+YmFzZS5nYW1tYV9sdXQgPSBpOXh4X3JlYWRfbHV0XzgoY3J0Y19zdGF0ZSk7
Cj4gKwljcnRjX3N0YXRlLT51YXBpLmdhbW1hX2x1dCA9IGk5eHhfcmVhZF9sdXRfOChjcnRjX3N0
YXRlKTsKPiAgfQo+ICAKPiAgc3RhdGljIHN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqCj4gIGk5
NjVfcmVhZF9sdXRfMTBwNihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVs
X2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAJdTMyIGx1dF9zaXplID0g
SU5URUxfSU5GTyhkZXZfcHJpdiktPmNvbG9yLmdhbW1hX2x1dF9zaXplOwo+ICAJZW51bSBwaXBl
IHBpcGUgPSBjcnRjLT5waXBlOwo+IEBAIC0xNjEzLDE1ICsxNjEzLDE1IEBAIGk5NjVfcmVhZF9s
dXRfMTBwNihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgc3Rh
dGljIHZvaWQgaTk2NV9yZWFkX2x1dHMoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUpCj4gIHsKPiAgCWlmIChjcnRjX3N0YXRlLT5nYW1tYV9tb2RlID09IEdBTU1BX01PREVfTU9E
RV84QklUKQo+IC0JCWNydGNfc3RhdGUtPmJhc2UuZ2FtbWFfbHV0ID0gaTl4eF9yZWFkX2x1dF84
KGNydGNfc3RhdGUpOwo+ICsJCWNydGNfc3RhdGUtPnVhcGkuZ2FtbWFfbHV0ID0gaTl4eF9yZWFk
X2x1dF84KGNydGNfc3RhdGUpOwo+ICAJZWxzZQo+IC0JCWNydGNfc3RhdGUtPmJhc2UuZ2FtbWFf
bHV0ID0gaTk2NV9yZWFkX2x1dF8xMHA2KGNydGNfc3RhdGUpOwo+ICsJCWNydGNfc3RhdGUtPnVh
cGkuZ2FtbWFfbHV0ID0gaTk2NV9yZWFkX2x1dF8xMHA2KGNydGNfc3RhdGUpOwo+ICB9Cj4gIAo+
ICBzdGF0aWMgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICoKPiAgY2h2X3JlYWRfY2dtX2x1dChj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0
IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7
Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+
dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAJdTMyIGx1dF9zaXplID0gSU5URUxfSU5GTyhkZXZfcHJp
diktPmNvbG9yLmdhbW1hX2x1dF9zaXplOwo+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBl
Owo+IEBAIC0xNjU1LDE1ICsxNjU1LDE1IEBAIGNodl9yZWFkX2NnbV9sdXQoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHN0YXRpYyB2b2lkIGNodl9yZWFkX2x1
dHMoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHsKPiAgCWlmIChjcnRj
X3N0YXRlLT5nYW1tYV9tb2RlID09IEdBTU1BX01PREVfTU9ERV84QklUKQo+IC0JCWNydGNfc3Rh
dGUtPmJhc2UuZ2FtbWFfbHV0ID0gaTl4eF9yZWFkX2x1dF84KGNydGNfc3RhdGUpOwo+ICsJCWNy
dGNfc3RhdGUtPnVhcGkuZ2FtbWFfbHV0ID0gaTl4eF9yZWFkX2x1dF84KGNydGNfc3RhdGUpOwo+
ICAJZWxzZQo+IC0JCWNydGNfc3RhdGUtPmJhc2UuZ2FtbWFfbHV0ID0gY2h2X3JlYWRfY2dtX2x1
dChjcnRjX3N0YXRlKTsKPiArCQljcnRjX3N0YXRlLT51YXBpLmdhbW1hX2x1dCA9IGNodl9yZWFk
X2NnbV9sdXQoY3J0Y19zdGF0ZSk7Cj4gIH0KPiAgCj4gIHN0YXRpYyBzdHJ1Y3QgZHJtX3Byb3Bl
cnR5X2Jsb2IgKgo+ICBpbGtfcmVhZF9sdXRfMTAoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50
ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNy
dGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCXUz
MiBsdXRfc2l6ZSA9IElOVEVMX0lORk8oZGV2X3ByaXYpLT5jb2xvci5nYW1tYV9sdXRfc2l6ZTsK
PiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiBAQCAtMTY5NiwxNSArMTY5NiwxNSBA
QCBpbGtfcmVhZF9sdXRfMTAoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUpCj4gIHN0YXRpYyB2b2lkIGlsa19yZWFkX2x1dHMoc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUpCj4gIHsKPiAgCWlmIChjcnRjX3N0YXRlLT5nYW1tYV9tb2RlID09IEdBTU1B
X01PREVfTU9ERV84QklUKQo+IC0JCWNydGNfc3RhdGUtPmJhc2UuZ2FtbWFfbHV0ID0gaTl4eF9y
ZWFkX2x1dF84KGNydGNfc3RhdGUpOwo+ICsJCWNydGNfc3RhdGUtPnVhcGkuZ2FtbWFfbHV0ID0g
aTl4eF9yZWFkX2x1dF84KGNydGNfc3RhdGUpOwo+ICAJZWxzZQo+IC0JCWNydGNfc3RhdGUtPmJh
c2UuZ2FtbWFfbHV0ID0gaWxrX3JlYWRfbHV0XzEwKGNydGNfc3RhdGUpOwo+ICsJCWNydGNfc3Rh
dGUtPnVhcGkuZ2FtbWFfbHV0ID0gaWxrX3JlYWRfbHV0XzEwKGNydGNfc3RhdGUpOwo+ICB9Cj4g
IAo+ICBzdGF0aWMgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICoKPiAgZ2xrX3JlYWRfbHV0XzEw
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLCB1MzIgcHJlY19pbmRl
eCkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVs
X2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAJaW50IGh3X2x1dF9zaXpl
ID0gaXZiX2x1dF8xMF9zaXplKHByZWNfaW5kZXgpOwo+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRj
LT5waXBlOwo+IEBAIC0xNzQyLDkgKzE3NDIsOSBAQCBnbGtfcmVhZF9sdXRfMTAoY29uc3Qgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsIHUzMiBwcmVjX2luZGV4KQo+ICBzdGF0
aWMgdm9pZCBnbGtfcmVhZF9sdXRzKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
KQo+ICB7Cj4gIAlpZiAoY3J0Y19zdGF0ZS0+Z2FtbWFfbW9kZSA9PSBHQU1NQV9NT0RFX01PREVf
OEJJVCkKPiAtCQljcnRjX3N0YXRlLT5iYXNlLmdhbW1hX2x1dCA9IGk5eHhfcmVhZF9sdXRfOChj
cnRjX3N0YXRlKTsKPiArCQljcnRjX3N0YXRlLT51YXBpLmdhbW1hX2x1dCA9IGk5eHhfcmVhZF9s
dXRfOChjcnRjX3N0YXRlKTsKPiAgCWVsc2UKPiAtCQljcnRjX3N0YXRlLT5iYXNlLmdhbW1hX2x1
dCA9IGdsa19yZWFkX2x1dF8xMChjcnRjX3N0YXRlLCBQQUxfUFJFQ19JTkRFWF9WQUxVRSgwKSk7
Cj4gKwkJY3J0Y19zdGF0ZS0+dWFwaS5nYW1tYV9sdXQgPSBnbGtfcmVhZF9sdXRfMTAoY3J0Y19z
dGF0ZSwgUEFMX1BSRUNfSU5ERVhfVkFMVUUoMCkpOwo+ICB9Cj4gIAo+ICB2b2lkIGludGVsX2Nv
bG9yX2luaXQoc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfY3J0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2NydC5jCj4gaW5kZXggZTZlOGQ0YTgyMDQ0Li4zNWEyNTE3MmIyNjkgMTAw
NjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9jcnQuYwo+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfY3J0LmMKPiBAQCAtMTMyLDkg
KzEzMiw5IEBAIHN0YXRpYyB2b2lkIGludGVsX2NydF9nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+ICB7Cj4gIAlwaXBlX2NvbmZpZy0+b3V0cHV0X3R5cGVzIHw9IEJJ
VChJTlRFTF9PVVRQVVRfQU5BTE9HKTsKPiAgCj4gLQlwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3Rl
ZF9tb2RlLmZsYWdzIHw9IGludGVsX2NydF9nZXRfZmxhZ3MoZW5jb2Rlcik7Cj4gKwlwaXBlX2Nv
bmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5mbGFncyB8PSBpbnRlbF9jcnRfZ2V0X2ZsYWdzKGVuY29k
ZXIpOwo+ICAKPiAtCXBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19jbG9jayA9
IHBpcGVfY29uZmlnLT5wb3J0X2Nsb2NrOwo+ICsJcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21v
ZGUuY3J0Y19jbG9jayA9IHBpcGVfY29uZmlnLT5wb3J0X2Nsb2NrOwo+ICB9Cj4gIAo+ICBzdGF0
aWMgdm9pZCBoc3dfY3J0X2dldF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
Cj4gQEAgLTE0NCwxMyArMTQ0LDEzIEBAIHN0YXRpYyB2b2lkIGhzd19jcnRfZ2V0X2NvbmZpZyhz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgCj4gIAlpbnRlbF9kZGlfZ2V0X2NvbmZp
ZyhlbmNvZGVyLCBwaXBlX2NvbmZpZyk7Cj4gIAo+IC0JcGlwZV9jb25maWctPmJhc2UuYWRqdXN0
ZWRfbW9kZS5mbGFncyAmPSB+KERSTV9NT0RFX0ZMQUdfUEhTWU5DIHwKPiArCXBpcGVfY29uZmln
LT5ody5hZGp1c3RlZF9tb2RlLmZsYWdzICY9IH4oRFJNX01PREVfRkxBR19QSFNZTkMgfAo+ICAJ
CQkJCSAgICAgIERSTV9NT0RFX0ZMQUdfTkhTWU5DIHwKPiAgCQkJCQkgICAgICBEUk1fTU9ERV9G
TEFHX1BWU1lOQyB8Cj4gIAkJCQkJICAgICAgRFJNX01PREVfRkxBR19OVlNZTkMpOwo+IC0JcGlw
ZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5mbGFncyB8PSBpbnRlbF9jcnRfZ2V0X2ZsYWdz
KGVuY29kZXIpOwo+ICsJcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUuZmxhZ3MgfD0gaW50
ZWxfY3J0X2dldF9mbGFncyhlbmNvZGVyKTsKPiAgCj4gLQlwaXBlX2NvbmZpZy0+YmFzZS5hZGp1
c3RlZF9tb2RlLmNydGNfY2xvY2sgPSBscHRfZ2V0X2ljbGtpcChkZXZfcHJpdik7Cj4gKwlwaXBl
X2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrID0gbHB0X2dldF9pY2xraXAoZGV2
X3ByaXYpOwo+ICB9Cj4gIAo+ICAvKiBOb3RlOiBUaGUgY2FsbGVyIGlzIHJlcXVpcmVkIHRvIGZp
bHRlciBvdXQgZHBtcyBtb2RlcyBub3Qgc3VwcG9ydGVkIGJ5IHRoZQo+IEBAIC0xNjEsOCArMTYx
LDggQEAgc3RhdGljIHZvaWQgaW50ZWxfY3J0X3NldF9kcG1zKHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLAo+ICB7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgCXN0cnVjdCBpbnRlbF9jcnQgKmNydCA9IGlu
dGVsX2VuY29kZXJfdG9fY3J0KGVuY29kZXIpOwo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMg
PSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gLQljb25zdCBzdHJ1Y3Qg
ZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZjcnRjX3N0YXRlLT5iYXNlLmFkanVz
dGVkX21vZGU7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0
Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiArCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICph
ZGp1c3RlZF9tb2RlID0gJmNydGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGU7Cj4gIAl1MzIgYWRw
YTsKPiAgCj4gIAlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA1KQo+IEBAIC0yNzEsNyArMjcx
LDcgQEAgc3RhdGljIHZvaWQgaHN3X3ByZV9lbmFibGVfY3J0KHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLAo+ICAJCQkgICAgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUg
KmNvbm5fc3RhdGUpCj4gIHsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMg
PSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCWVu
dW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCj4gIAlXQVJOX09OKCFjcnRjX3N0YXRlLT5o
YXNfcGNoX2VuY29kZXIpOwo+IEBAIC0yODgsNyArMjg4LDcgQEAgc3RhdGljIHZvaWQgaHN3X2Vu
YWJsZV9jcnQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIAkJCSAgIGNvbnN0IHN0
cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ICB7Cj4gIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAt
CXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNl
LmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gIAo+
ICAJV0FSTl9PTighY3J0Y19zdGF0ZS0+aGFzX3BjaF9lbmNvZGVyKTsKPiBAQCAtMzU4LDcgKzM1
OCw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfY3J0X2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+ICAJCQkJICAgIHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpj
b25uX3N0YXRlKQo+ICB7Cj4gIAlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9k
ZSA9Cj4gLQkJJnBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gKwkJJnBpcGVfY29u
ZmlnLT5ody5hZGp1c3RlZF9tb2RlOwo+ICAKPiAgCWlmIChhZGp1c3RlZF9tb2RlLT5mbGFncyAm
IERSTV9NT0RFX0ZMQUdfREJMU0NBTikKPiAgCQlyZXR1cm4gLUVJTlZBTDsKPiBAQCAtMzczLDcg
KzM3Myw3IEBAIHN0YXRpYyBpbnQgcGNoX2NydF9jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKPiAgCQkJCSAgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNv
bm5fc3RhdGUpCj4gIHsKPiAgCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2Rl
ID0KPiAtCQkmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPiArCQkmcGlwZV9jb25m
aWctPmh3LmFkanVzdGVkX21vZGU7Cj4gIAo+ICAJaWYgKGFkanVzdGVkX21vZGUtPmZsYWdzICYg
RFJNX01PREVfRkxBR19EQkxTQ0FOKQo+ICAJCXJldHVybiAtRUlOVkFMOwo+IEBAIC0zOTAsNyAr
MzkwLDcgQEAgc3RhdGljIGludCBoc3dfY3J0X2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+ICB7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgCXN0cnVjdCBkcm1fZGlzcGxheV9t
b2RlICphZGp1c3RlZF9tb2RlID0KPiAtCQkmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9k
ZTsKPiArCQkmcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGU7Cj4gIAo+ICAJaWYgKGFkanVz
dGVkX21vZGUtPmZsYWdzICYgRFJNX01PREVfRkxBR19EQkxTQ0FOKQo+ICAJCXJldHVybiAtRUlO
VkFMOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rk
aS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGkuYwo+IGluZGV4IDFi
NTliODUyODc0Yi4uYzc3NWZkMjA1OTE1IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfZGRpLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2RkaS5jCj4gQEAgLTE0ODMsNyArMTQ4Myw3IEBAIHN0YXRpYyB2b2lkIGRkaV9k
b3RjbG9ja19nZXQoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ICAJaWYg
KHBpcGVfY29uZmlnLT5mZWNfZW5hYmxlKQo+ICAJCWRvdGNsb2NrID0gaW50ZWxfZHBfZmVjX3Rv
X21vZGVfY2xvY2soZG90Y2xvY2spOwo+ICAKPiAtCXBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVk
X21vZGUuY3J0Y19jbG9jayA9IGRvdGNsb2NrOwo+ICsJcGlwZV9jb25maWctPmh3LmFkanVzdGVk
X21vZGUuY3J0Y19jbG9jayA9IGRvdGNsb2NrOwo+ICB9Cj4gIAo+ICBzdGF0aWMgdm9pZCBpY2xf
ZGRpX2Nsb2NrX2dldChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiBAQCAtMTY5OCw3
ICsxNjk4LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZGRpX2Nsb2NrX2dldChzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKPiAgCj4gIHZvaWQgaW50ZWxfZGRpX3NldF9waXBlX3NldHRpbmdz
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRj
KTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRl
LT51YXBpLmNydGMpOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShjcnRjLT5iYXNlLmRldik7Cj4gIAllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIg
PSBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcjsKPiAgCXUzMiB0ZW1wOwo+IEBAIC0xNzUyLDcg
KzE3NTIsNyBAQCB2b2lkIGludGVsX2RkaV9zZXRfcGlwZV9zZXR0aW5ncyhjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgdm9pZCBpbnRlbF9kZGlfc2V0X3ZjX3Bh
eWxvYWRfYWxsb2MoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4g
IAkJCQkgICAgYm9vbCBzdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0
b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+
ICAJZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3RyYW5z
Y29kZXI7Cj4gIAl1MzIgdGVtcDsKPiBAQCAtMTc3NCw3ICsxNzc0LDcgQEAgdm9pZCBpbnRlbF9k
ZGlfc2V0X3ZjX3BheWxvYWRfYWxsb2MoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUsCj4gIHN0YXRpYyB1MzIKPiAgaW50ZWxfZGRpX3RyYW5zY29kZXJfZnVuY19yZWdf
dmFsX2dldChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+
IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJh
c2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0
Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyID0g
aW50ZWxfZGRpX2dldF9jcnRjX2VuY29kZXIoY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCWVudW0gcGlwZSBw
aXBlID0gY3J0Yy0+cGlwZTsKPiBAQCAtMTgwNiw5ICsxODA2LDkgQEAgaW50ZWxfZGRpX3RyYW5z
Y29kZXJfZnVuY19yZWdfdmFsX2dldChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSkKPiAgCQlCVUcoKTsKPiAgCX0KPiAgCj4gLQlpZiAoY3J0Y19zdGF0ZS0+YmFzZS5h
ZGp1c3RlZF9tb2RlLmZsYWdzICYgRFJNX01PREVfRkxBR19QVlNZTkMpCj4gKwlpZiAoY3J0Y19z
dGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZS5mbGFncyAmIERSTV9NT0RFX0ZMQUdfUFZTWU5DKQo+ICAJ
CXRlbXAgfD0gVFJBTlNfRERJX1BWU1lOQzsKPiAtCWlmIChjcnRjX3N0YXRlLT5iYXNlLmFkanVz
dGVkX21vZGUuZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX1BIU1lOQykKPiArCWlmIChjcnRjX3N0YXRl
LT5ody5hZGp1c3RlZF9tb2RlLmZsYWdzICYgRFJNX01PREVfRkxBR19QSFNZTkMpCj4gIAkJdGVt
cCB8PSBUUkFOU19ERElfUEhTWU5DOwo+ICAKPiAgCWlmIChjcHVfdHJhbnNjb2RlciA9PSBUUkFO
U0NPREVSX0VEUCkgewo+IEBAIC0xODYxLDcgKzE4NjEsNyBAQCBpbnRlbF9kZGlfdHJhbnNjb2Rl
cl9mdW5jX3JlZ192YWxfZ2V0KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlKQo+ICAKPiAgdm9pZCBpbnRlbF9kZGlfZW5hYmxlX3RyYW5zY29kZXJfZnVuYyhjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVs
X2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5j
cnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwo+ICAJZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0gY3J0Y19z
dGF0ZS0+Y3B1X3RyYW5zY29kZXI7Cj4gIAl1MzIgdGVtcDsKPiBAQCAtMTg3Nyw3ICsxODc3LDcg
QEAgdm9pZCBpbnRlbF9kZGlfZW5hYmxlX3RyYW5zY29kZXJfZnVuYyhjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgc3RhdGljIHZvaWQKPiAgaW50ZWxfZGRpX2Nv
bmZpZ190cmFuc2NvZGVyX2Z1bmMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0Yyhj
cnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19p
bnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCWVudW0gdHJhbnNj
b2RlciBjcHVfdHJhbnNjb2RlciA9IGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyOwo+ICAJdTMy
IHRlbXA7Cj4gQEAgLTE4ODksNyArMTg4OSw3IEBAIGludGVsX2RkaV9jb25maWdfdHJhbnNjb2Rl
cl9mdW5jKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAKPiAg
dm9pZCBpbnRlbF9kZGlfZGlzYWJsZV90cmFuc2NvZGVyX2Z1bmMoY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
ID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVs
X2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2
KTsKPiAgCWVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNjb2RlciA9IGNydGNfc3RhdGUtPmNwdV90
cmFuc2NvZGVyOwo+ICAJaTkxNV9yZWdfdCByZWcgPSBUUkFOU19ERElfRlVOQ19DVEwoY3B1X3Ry
YW5zY29kZXIpOwo+IEBAIC0yMTg3LDcgKzIxODcsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlf
Z2V0X3Bvd2VyX2RvbWFpbnMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIAo+ICB2
b2lkIGludGVsX2RkaV9lbmFibGVfcGlwZV9jbG9jayhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19p
bnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAJ
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIgPSBpbnRlbF9kZGlfZ2V0X2NydGNfZW5jb2Rl
cihjcnRjKTsKPiAgCWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKPiBAQCAtMjIwNSw3
ICsyMjA1LDcgQEAgdm9pZCBpbnRlbF9kZGlfZW5hYmxlX3BpcGVfY2xvY2soY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIAo+ICB2b2lkIGludGVsX2RkaV9kaXNh
YmxlX3BpcGVfY2xvY2soY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUp
Cj4gIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0
Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT51YXBpLmNydGMtPmRldik7Cj4gIAllbnVtIHRy
YW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcjsKPiAg
Cj4gIAlpZiAoY3B1X3RyYW5zY29kZXIgIT0gVFJBTlNDT0RFUl9FRFApIHsKPiBAQCAtMzQyMSw3
ICszNDIxLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZGRpX3ByZV9lbmFibGUoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsCj4gIAkJCQkgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUsCj4gIAkJCQkgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNv
bm5fc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0
YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0
b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCWVudW0gcGlw
ZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCj4gQEAgLTM4NDYsNyArMzg0Niw3IEBAIGludGVsX2Rk
aV91cGRhdGVfcHJlcGFyZShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKPiAgCVdB
Uk5fT04oY3J0YyAmJiBjcnRjLT5hY3RpdmUpOwo+ICAKPiAgCWludGVsX3RjX3BvcnRfZ2V0X2xp
bmsoZW5jX3RvX2RpZ19wb3J0KCZlbmNvZGVyLT5iYXNlKSwgcmVxdWlyZWRfbGFuZXMpOwo+IC0J
aWYgKGNydGNfc3RhdGUgJiYgY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUpCj4gKwlpZiAoY3J0Y19z
dGF0ZSAmJiBjcnRjX3N0YXRlLT5ody5hY3RpdmUpCj4gIAkJaW50ZWxfdXBkYXRlX2FjdGl2ZV9k
cGxsKHN0YXRlLCBjcnRjLCBlbmNvZGVyKTsKPiAgfQo+ICAKPiBAQCAtMzk3Niw3ICszOTc2LDcg
QEAgdm9pZCBpbnRlbF9kZGlfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKPiAgCQkJICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gIHsKPiAg
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFz
ZS5kZXYpOwo+IC0Jc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRj
KHBpcGVfY29uZmlnLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmludGVsX2Ny
dGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT51YXBpLmNydGMpOwo+ICAJZW51bSB0cmFu
c2NvZGVyIGNwdV90cmFuc2NvZGVyID0gcGlwZV9jb25maWctPmNwdV90cmFuc2NvZGVyOwo+ICAJ
dTMyIHRlbXAsIGZsYWdzID0gMDsKPiAgCj4gQEAgLTM5OTQsNyArMzk5NCw3IEBAIHZvaWQgaW50
ZWxfZGRpX2dldF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIAllbHNl
Cj4gIAkJZmxhZ3MgfD0gRFJNX01PREVfRkxBR19OVlNZTkM7Cj4gIAo+IC0JcGlwZV9jb25maWct
PmJhc2UuYWRqdXN0ZWRfbW9kZS5mbGFncyB8PSBmbGFnczsKPiArCXBpcGVfY29uZmlnLT5ody5h
ZGp1c3RlZF9tb2RlLmZsYWdzIHw9IGZsYWdzOwo+ICAKPiAgCXN3aXRjaCAodGVtcCAmIFRSQU5T
X0RESV9CUENfTUFTSykgewo+ICAJY2FzZSBUUkFOU19ERElfQlBDXzY6Cj4gQEAgLTQxMzYsNyAr
NDEzNiw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfZGRpX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+ICAJCQkJICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpw
aXBlX2NvbmZpZywKPiAgCQkJCSAgICBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9z
dGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKHBp
cGVfY29uZmlnLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19p
bnRlbF9jcnRjKHBpcGVfY29uZmlnLT51YXBpLmNydGMpOwo+ICAJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gIAllbnVtIHBv
cnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4gIAlpbnQgcmV0Owo+IEBAIC00MjY3LDcgKzQyNjcs
NyBAQCBzdGF0aWMgaW50IGludGVsX2hkbWlfcmVzZXRfbGluayhzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiAgCj4gIAlXQVJOX09OKCFpbnRlbF9jcnRjX2hhc190eXBlKGNydGNfc3Rh
dGUsIElOVEVMX09VVFBVVF9IRE1JKSk7Cj4gIAo+IC0JaWYgKCFjcnRjX3N0YXRlLT5iYXNlLmFj
dGl2ZSkKPiArCWlmICghY3J0Y19zdGF0ZS0+aHcuYWN0aXZlKQo+ICAJCXJldHVybiAwOwo+ICAK
PiAgCWlmICghY3J0Y19zdGF0ZS0+aGRtaV9oaWdoX3RtZHNfY2xvY2tfcmF0aW8gJiYKPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwo+IGluZGV4IDc5OTY4
NjRlNmY3Yy4uNjgxOGNiZDAwYWMyIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kaXNwbGF5LmMKPiBAQCAtNTE4LDcgKzUxOCw3IEBAIGljbF93YV9zY2FsZXJj
bGtnYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUgcGlw
ZSwKPiAgc3RhdGljIGJvb2wKPiAgbmVlZHNfbW9kZXNldChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqc3RhdGUpCj4gIHsKPiAtCXJldHVybiBkcm1fYXRvbWljX2NydGNfbmVlZHNfbW9k
ZXNldCgmc3RhdGUtPmJhc2UpOwo+ICsJcmV0dXJuIGRybV9hdG9taWNfY3J0Y19uZWVkc19tb2Rl
c2V0KCZzdGF0ZS0+dWFwaSk7Cj4gIH0KPiAgCj4gIC8qCj4gQEAgLTYzMiw3ICs2MzIsNyBAQCBp
OXh4X3NlbGVjdF9wMl9kaXYoY29uc3Qgc3RydWN0IGludGVsX2xpbWl0ICpsaW1pdCwKPiAgCQkg
ICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgCQkgICBpbnQg
dGFyZ2V0KQo+ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjLT5kZXYpOwo+ICAK
PiAgCWlmIChpbnRlbF9jcnRjX2hhc190eXBlKGNydGNfc3RhdGUsIElOVEVMX09VVFBVVF9MVkRT
KSkgewo+ICAJCS8qCj4gQEAgLTY2OCw3ICs2NjgsNyBAQCBpOXh4X2ZpbmRfYmVzdF9kcGxsKGNv
bnN0IHN0cnVjdCBpbnRlbF9saW1pdCAqbGltaXQsCj4gIAkJICAgIGludCB0YXJnZXQsIGludCBy
ZWZjbGssIHN0cnVjdCBkcGxsICptYXRjaF9jbG9jaywKPiAgCQkgICAgc3RydWN0IGRwbGwgKmJl
c3RfY2xvY2spCj4gIHsKPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjX3N0YXRlLT5i
YXNlLmNydGMtPmRldjsKPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjX3N0YXRlLT51
YXBpLmNydGMtPmRldjsKPiAgCXN0cnVjdCBkcGxsIGNsb2NrOwo+ICAJaW50IGVyciA9IHRhcmdl
dDsKPiAgCj4gQEAgLTcyNiw3ICs3MjYsNyBAQCBwbnZfZmluZF9iZXN0X2RwbGwoY29uc3Qgc3Ry
dWN0IGludGVsX2xpbWl0ICpsaW1pdCwKPiAgCQkgICBpbnQgdGFyZ2V0LCBpbnQgcmVmY2xrLCBz
dHJ1Y3QgZHBsbCAqbWF0Y2hfY2xvY2ssCj4gIAkJICAgc3RydWN0IGRwbGwgKmJlc3RfY2xvY2sp
Cj4gIHsKPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjX3N0YXRlLT5iYXNlLmNydGMt
PmRldjsKPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjX3N0YXRlLT51YXBpLmNydGMt
PmRldjsKPiAgCXN0cnVjdCBkcGxsIGNsb2NrOwo+ICAJaW50IGVyciA9IHRhcmdldDsKPiAgCj4g
QEAgLTc4Miw3ICs3ODIsNyBAQCBnNHhfZmluZF9iZXN0X2RwbGwoY29uc3Qgc3RydWN0IGludGVs
X2xpbWl0ICpsaW1pdCwKPiAgCQkgICBpbnQgdGFyZ2V0LCBpbnQgcmVmY2xrLCBzdHJ1Y3QgZHBs
bCAqbWF0Y2hfY2xvY2ssCj4gIAkJICAgc3RydWN0IGRwbGwgKmJlc3RfY2xvY2spCj4gIHsKPiAt
CXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldjsKPiAr
CXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjX3N0YXRlLT51YXBpLmNydGMtPmRldjsKPiAg
CXN0cnVjdCBkcGxsIGNsb2NrOwo+ICAJaW50IG1heF9uOwo+ICAJYm9vbCBmb3VuZCA9IGZhbHNl
Owo+IEBAIC04NzYsNyArODc2LDcgQEAgdmx2X2ZpbmRfYmVzdF9kcGxsKGNvbnN0IHN0cnVjdCBp
bnRlbF9saW1pdCAqbGltaXQsCj4gIAkJICAgaW50IHRhcmdldCwgaW50IHJlZmNsaywgc3RydWN0
IGRwbGwgKm1hdGNoX2Nsb2NrLAo+ICAJCSAgIHN0cnVjdCBkcGxsICpiZXN0X2Nsb2NrKQo+ICB7
Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+
YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0Yyhj
cnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMt
PmJhc2UuZGV2Owo+ICAJc3RydWN0IGRwbGwgY2xvY2s7Cj4gIAl1bnNpZ25lZCBpbnQgYmVzdHBw
bSA9IDEwMDAwMDA7Cj4gQEAgLTkzNiw3ICs5MzYsNyBAQCBjaHZfZmluZF9iZXN0X2RwbGwoY29u
c3Qgc3RydWN0IGludGVsX2xpbWl0ICpsaW1pdCwKPiAgCQkgICBpbnQgdGFyZ2V0LCBpbnQgcmVm
Y2xrLCBzdHJ1Y3QgZHBsbCAqbWF0Y2hfY2xvY2ssCj4gIAkJICAgc3RydWN0IGRwbGwgKmJlc3Rf
Y2xvY2spCj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0Yyhj
cnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19p
bnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2ID0gY3J0Yy0+YmFzZS5kZXY7Cj4gIAl1bnNpZ25lZCBpbnQgYmVzdF9lcnJvcl9wcG07Cj4g
IAlzdHJ1Y3QgZHBsbCBjbG9jazsKPiBAQCAtMTAxNSw3ICsxMDE1LDcgQEAgYm9vbCBpbnRlbF9j
cnRjX2FjdGl2ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiAgCSAqIGZvciBhdG9taWMuCj4g
IAkgKi8KPiAgCXJldHVybiBjcnRjLT5hY3RpdmUgJiYgY3J0Yy0+YmFzZS5wcmltYXJ5LT5zdGF0
ZS0+ZmIgJiYKPiAtCQljcnRjLT5jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2Nr
Owo+ICsJCWNydGMtPmNvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrOwo+ICB9Cj4g
IAo+ICBlbnVtIHRyYW5zY29kZXIgaW50ZWxfcGlwZV90b19jcHVfdHJhbnNjb2RlcihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gQEAgLTEwNjksNyArMTA2OSw3IEBAIHN0YXRp
YyB2b2lkIGludGVsX3dhaXRfZm9yX3BpcGVfc2NhbmxpbmVfbW92aW5nKHN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjKQo+ICBzdGF0aWMgdm9pZAo+ICBpbnRlbF93YWl0X2Zvcl9waXBlX29mZihjb25z
dCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUpCj4gIHsKPiAtCXN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhvbGRfY3J0Y19zdGF0ZS0+YmFzZS5j
cnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhvbGRfY3J0
Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAKPiAgCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDQpIHsKPiBAQCAtMTUyOCw3ICsxNTI4LDcgQEAgc3RhdGljIHZvaWQgaTl4eF9lbmFi
bGVfcGxsKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAKPiAgc3RhdGljIHZvaWQgaTl4eF9k
aXNhYmxlX3BsbChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAg
ewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUt
PmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMo
Y3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRj
LT5waXBlOwo+ICAKPiBAQCAtMTYxOSw3ICsxNjE5LDcgQEAgdm9pZCB2bHZfd2FpdF9wb3J0X3Jl
YWR5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgCj4gIHN0YXRpYyB2b2lk
IGlyb25sYWtlX2VuYWJsZV9wY2hfdHJhbnNjb2Rlcihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19p
bnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAJ
ZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAJaTkxNV9yZWdfdCByZWc7Cj4gQEAgLTE3
NjMsNyArMTc2Myw3IEBAIGVudW0gcGlwZSBpbnRlbF9jcnRjX3BjaF90cmFuc2NvZGVyKHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjKQo+ICAKPiAgc3RhdGljIHUzMiBpbnRlbF9jcnRjX21heF92Ymxh
bmtfY291bnQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0
ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShjcnRjX3N0YXRlLT51YXBpLmNydGMtPmRldik7Cj4gIAo+ICAJLyoKPiAgCSAq
IE9uIGk5NjVnbSB0aGUgaGFyZHdhcmUgZnJhbWUgY291bnRlciByZWFkcwo+IEBAIC0xNzgzLDcg
KzE3ODMsNyBAQCBzdGF0aWMgdTMyIGludGVsX2NydGNfbWF4X3ZibGFua19jb3VudChjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZQo+ICAKPiAgc3RhdGljIHZvaWQgaW50
ZWxfY3J0Y192Ymxhbmtfb24oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUpCj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRj
X3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAo+ICAJZHJtX2NydGNfc2V0X21heF92
YmxhbmtfY291bnQoJmNydGMtPmJhc2UsCj4gIAkJCQkgICAgICBpbnRlbF9jcnRjX21heF92Ymxh
bmtfY291bnQoY3J0Y19zdGF0ZSkpOwo+IEBAIC0xNzkyLDcgKzE3OTIsNyBAQCBzdGF0aWMgdm9p
ZCBpbnRlbF9jcnRjX3ZibGFua19vbihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSkKPiAgCj4gIHN0YXRpYyB2b2lkIGludGVsX2VuYWJsZV9waXBlKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVs
X2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG5ld19jcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+
ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG5ld19jcnRjX3N0YXRl
LT51YXBpLmNydGMpOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShjcnRjLT5iYXNlLmRldik7Cj4gIAllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIg
PSBuZXdfY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXI7Cj4gIAllbnVtIHBpcGUgcGlwZSA9IGNy
dGMtPnBpcGU7Cj4gQEAgLTE4NTAsNyArMTg1MCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2VuYWJs
ZV9waXBlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0ZSkKPiAg
Cj4gIHN0YXRpYyB2b2lkIGludGVsX2Rpc2FibGVfcGlwZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
ID0gdG9faW50ZWxfY3J0YyhvbGRfY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBp
bnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhvbGRfY3J0Y19zdGF0ZS0+dWFwaS5jcnRj
KTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+
YmFzZS5kZXYpOwo+ICAJZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0gb2xkX2NydGNf
c3RhdGUtPmNwdV90cmFuc2NvZGVyOwo+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+
IEBAIC0zMTE2LDE0ICszMTE2LDE0IEBAIGludGVsX3NldF9wbGFuZV92aXNpYmxlKHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAJcGxhbmVfc3RhdGUtPmJhc2UudmlzaWJs
ZSA9IHZpc2libGU7Cj4gIAo+ICAJaWYgKHZpc2libGUpCj4gLQkJY3J0Y19zdGF0ZS0+YmFzZS5w
bGFuZV9tYXNrIHw9IGRybV9wbGFuZV9tYXNrKCZwbGFuZS0+YmFzZSk7Cj4gKwkJY3J0Y19zdGF0
ZS0+dWFwaS5wbGFuZV9tYXNrIHw9IGRybV9wbGFuZV9tYXNrKCZwbGFuZS0+YmFzZSk7Cj4gIAll
bHNlCj4gLQkJY3J0Y19zdGF0ZS0+YmFzZS5wbGFuZV9tYXNrICY9IH5kcm1fcGxhbmVfbWFzaygm
cGxhbmUtPmJhc2UpOwo+ICsJCWNydGNfc3RhdGUtPnVhcGkucGxhbmVfbWFzayAmPSB+ZHJtX3Bs
YW5lX21hc2soJnBsYW5lLT5iYXNlKTsKPiAgfQo+ICAKPiAgc3RhdGljIHZvaWQgZml4dXBfYWN0
aXZlX3BsYW5lcyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT5i
YXNlLmNydGMtPmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsKPiAgCXN0cnVjdCBkcm1fcGxhbmUg
KnBsYW5lOwo+ICAKPiAgCS8qCj4gQEAgLTMxMzQsNyArMzEzNCw3IEBAIHN0YXRpYyB2b2lkIGZp
eHVwX2FjdGl2ZV9wbGFuZXMoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4g
IAljcnRjX3N0YXRlLT5hY3RpdmVfcGxhbmVzID0gMDsKPiAgCj4gIAlkcm1fZm9yX2VhY2hfcGxh
bmVfbWFzayhwbGFuZSwgJmRldl9wcml2LT5kcm0sCj4gLQkJCQljcnRjX3N0YXRlLT5iYXNlLnBs
YW5lX21hc2spCj4gKwkJCQljcnRjX3N0YXRlLT51YXBpLnBsYW5lX21hc2spCj4gIAkJY3J0Y19z
dGF0ZS0+YWN0aXZlX3BsYW5lcyB8PSBCSVQodG9faW50ZWxfcGxhbmUocGxhbmUpLT5pZCk7Cj4g
IH0KPiAgCj4gQEAgLTM2MDgsNyArMzYwOCw3IEBAIGk5eHhfcGxhbmVfbWF4X3N0cmlkZShzdHJ1
Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ICAKPiAgc3RhdGljIHUzMiBpOXh4X3BsYW5lX2N0bF9j
cnRjKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gLQlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5j
cnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0
YXRlLT51YXBpLmNydGMpOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gIAl1MzIgZHNwY250ciA9IDA7Cj4gIAo+IEBAIC0z
NzYyLDcgKzM3NjIsNyBAQCBpOXh4X3BsYW5lX2NoZWNrKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlLAo+ICAJCXJldHVybiByZXQ7Cj4gIAo+ICAJcmV0ID0gZHJtX2F0b21pY19o
ZWxwZXJfY2hlY2tfcGxhbmVfc3RhdGUoJnBsYW5lX3N0YXRlLT5iYXNlLAo+IC0JCQkJCQkgICZj
cnRjX3N0YXRlLT5iYXNlLAo+ICsJCQkJCQkgICZjcnRjX3N0YXRlLT51YXBpLAo+ICAJCQkJCQkg
IERSTV9QTEFORV9IRUxQRVJfTk9fU0NBTElORywKPiAgCQkJCQkJICBEUk1fUExBTkVfSEVMUEVS
X05PX1NDQUxJTkcsCj4gIAkJCQkJCSAgaTl4eF9wbGFuZV9oYXNfd2luZG93aW5nKHBsYW5lKSwK
PiBAQCAtMzkzOCw3ICszOTM4LDcgQEAgc3RhdGljIHZvaWQgc2tsX2RldGFjaF9zY2FsZXIoc3Ry
dWN0IGludGVsX2NydGMgKmludGVsX2NydGMsIGludCBpZCkKPiAgICovCj4gIHN0YXRpYyB2b2lk
IHNrbF9kZXRhY2hfc2NhbGVycyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9j
cnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxf
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCWNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3NjYWxlcl9zdGF0ZSAqc2NhbGVyX3N0YXRlID0KPiAgCQkmY3J0Y19z
dGF0ZS0+c2NhbGVyX3N0YXRlOwo+ICAJaW50IGk7Cj4gQEAgLTQxMzMsNyArNDEzMyw3IEBAIHN0
YXRpYyB1MzIgY25sX3BsYW5lX2N0bF9mbGlwKHVuc2lnbmVkIGludCByZWZsZWN0KQo+ICAKPiAg
dTMyIHNrbF9wbGFuZV9jdGxfY3J0Yyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsKPiAg
CXUzMiBwbGFuZV9jdGwgPSAwOwo+ICAKPiAgCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEw
IHx8IElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKQo+IEBAIC00MTg5LDcgKzQxODksNyBAQCB1MzIg
c2tsX3BsYW5lX2N0bChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwK
PiAgCj4gIHUzMiBnbGtfcGxhbmVfY29sb3JfY3RsX2NydGMoY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT51YXBpLmNy
dGMtPmRldik7Cj4gIAl1MzIgcGxhbmVfY29sb3JfY3RsID0gMDsKPiAgCj4gIAlpZiAoSU5URUxf
R0VOKGRldl9wcml2KSA+PSAxMSkKPiBAQCAtNDQxMSwxMSArNDQxMSwxMSBAQCBzdGF0aWMgdm9p
ZCBpY2xfc2V0X3BpcGVfY2hpY2tlbihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiAgc3RhdGlj
IHZvaWQgaW50ZWxfdXBkYXRlX3BpcGVfY29uZmlnKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpvbGRfY3J0Y19zdGF0ZSwKPiAgCQkJCSAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9
IHRvX2ludGVsX2NydGMobmV3X2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMobmV3X2NydGNfc3RhdGUtPnVhcGkuY3J0Yyk7
Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJh
c2UuZGV2KTsKPiAgCj4gIAkvKiBkcm1fYXRvbWljX2hlbHBlcl91cGRhdGVfbGVnYWN5X21vZGVz
ZXRfc3RhdGUgbWlnaHQgbm90IGJlIGNhbGxlZC4gKi8KPiAtCWNydGMtPmJhc2UubW9kZSA9IG5l
d19jcnRjX3N0YXRlLT5iYXNlLm1vZGU7Cj4gKwljcnRjLT5iYXNlLm1vZGUgPSBuZXdfY3J0Y19z
dGF0ZS0+dWFwaS5tb2RlOwo+ICAKPiAgCS8qCj4gIAkgKiBVcGRhdGUgcGlwZSBzaXplIGFuZCBh
ZGp1c3QgZml0dGVyIGlmIG5lZWRlZDogdGhlIHJlYXNvbiBmb3IgdGhpcyBpcwo+IEBAIC00ODQ0
LDcgKzQ4NDQsNyBAQCBzdGF0aWMgdm9pZCBpdmJfbWFudWFsX2ZkaV9saW5rX3RyYWluKHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjLAo+ICAKPiAgc3RhdGljIHZvaWQgaXJvbmxha2VfZmRpX3BsbF9l
bmFibGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHsKPiAt
CXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRl
LT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGludGVsX2NydGMtPmJhc2UuZGV2KTsKPiAgCWVudW0gcGlw
ZSBwaXBlID0gaW50ZWxfY3J0Yy0+cGlwZTsKPiAgCWk5MTVfcmVnX3QgcmVnOwo+IEBAIC01MDA1
LDkgKzUwMDUsOSBAQCB2b2lkIGxwdF9kaXNhYmxlX2ljbGtpcChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gIC8qIFByb2dyYW0gaUNMS0lQIGNsb2NrIHRvIHRoZSBkZXNpcmVk
IGZyZXF1ZW5jeSAqLwo+ICBzdGF0aWMgdm9pZCBscHRfcHJvZ3JhbV9pY2xraXAoY29uc3Qgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0
Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMt
PmJhc2UuZGV2KTsKPiAtCWludCBjbG9jayA9IGNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9k
ZS5jcnRjX2Nsb2NrOwo+ICsJaW50IGNsb2NrID0gY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9k
ZS5jcnRjX2Nsb2NrOwo+ICAJdTMyIGRpdnNlbCwgcGhhc2VpbmMsIGF1eGRpdiwgcGhhc2VkaXIg
PSAwOwo+ICAJdTMyIHRlbXA7Cj4gIAo+IEBAIC01MTIxLDcgKzUxMjEsNyBAQCBpbnQgbHB0X2dl
dF9pY2xraXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICBzdGF0aWMgdm9p
ZCBpcm9ubGFrZV9wY2hfdHJhbnNjb2Rlcl9zZXRfdGltaW5ncyhjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgCQkJCQkJZW51bSBwaXBlIHBjaF90cmFuc2NvZGVy
KQo+ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19z
dGF0ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxf
Y3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gIAllbnVtIHRyYW5zY29kZXIg
Y3B1X3RyYW5zY29kZXIgPSBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcjsKPiAgCj4gQEAgLTUx
NjQsNyArNTE2NCw3IEBAIHN0YXRpYyB2b2lkIGNwdF9zZXRfZmRpX2JjX2JpZnVyY2F0aW9uKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgYm9vbCBlCj4gIAo+ICBzdGF0aWMgdm9p
ZCBpdnlicmlkZ2VfdXBkYXRlX2ZkaV9iY19iaWZ1cmNhdGlvbihjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMg
PSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYp
Owo+ICAKPiAgCXN3aXRjaCAoY3J0Yy0+cGlwZSkgewo+IEBAIC01MTk0LDcgKzUxOTQsNyBAQCBz
dGF0aWMgc3RydWN0IGludGVsX2VuY29kZXIgKgo+ICBpbnRlbF9nZXRfY3J0Y19uZXdfZW5jb2Rl
cihjb25zdCBzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKPiAgCQkJICAgY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJ
c3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGku
Y3J0Yyk7Cj4gIAljb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubmVjdG9yX3N0
YXRlOwo+ICAJY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcjsKPiAgCXN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyID0gTlVMTDsKPiBAQCAtNTIyNiw3ICs1MjI2LDcgQEAg
aW50ZWxfZ2V0X2NydGNfbmV3X2VuY29kZXIoY29uc3Qgc3RydWN0IGludGVsX2F0b21pY19zdGF0
ZSAqc3RhdGUsCj4gIHN0YXRpYyB2b2lkIGlyb25sYWtlX3BjaF9lbmFibGUoY29uc3Qgc3RydWN0
IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4gIAkJCQljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0
b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVj
dCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5iYXNlLmRldjsKPiAgCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiAgCWVudW0gcGlwZSBwaXBlID0gY3J0
Yy0+cGlwZTsKPiBAQCAtNTI4MCw3ICs1MjgwLDcgQEAgc3RhdGljIHZvaWQgaXJvbmxha2VfcGNo
X2VuYWJsZShjb25zdCBzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKPiAgCWlmIChI
QVNfUENIX0NQVChkZXZfcHJpdikgJiYKPiAgCSAgICBpbnRlbF9jcnRjX2hhc19kcF9lbmNvZGVy
KGNydGNfc3RhdGUpKSB7Cj4gIAkJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVz
dGVkX21vZGUgPQo+IC0JCQkmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICsJCQkm
Y3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZTsKPiAgCQl1MzIgYnBjID0gKEk5MTVfUkVBRChQ
SVBFQ09ORihwaXBlKSkgJiBQSVBFQ09ORl9CUENfTUFTSykgPj4gNTsKPiAgCQlpOTE1X3JlZ190
IHJlZyA9IFRSQU5TX0RQX0NUTChwaXBlKTsKPiAgCQllbnVtIHBvcnQgcG9ydDsKPiBAQCAtNTMx
MCw3ICs1MzEwLDcgQEAgc3RhdGljIHZvaWQgaXJvbmxha2VfcGNoX2VuYWJsZShjb25zdCBzdHJ1
Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKPiAgc3RhdGljIHZvaWQgbHB0X3BjaF9lbmFi
bGUoY29uc3Qgc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4gIAkJCSAgIGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAr
CXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBp
LmNydGMpOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShj
cnRjLT5iYXNlLmRldik7Cj4gIAllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBjcnRj
X3N0YXRlLT5jcHVfdHJhbnNjb2RlcjsKPiAgCj4gQEAgLTU0MjcsMTAgKzU0MjcsMTAgQEAgc2ts
X3VwZGF0ZV9zY2FsZXIoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsIGJvb2wg
Zm9yY2VfZGV0YWNoLAo+ICAJc3RydWN0IGludGVsX2NydGNfc2NhbGVyX3N0YXRlICpzY2FsZXJf
c3RhdGUgPQo+ICAJCSZjcnRjX3N0YXRlLT5zY2FsZXJfc3RhdGU7Cj4gIAlzdHJ1Y3QgaW50ZWxf
Y3J0YyAqaW50ZWxfY3J0YyA9Cj4gLQkJdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNy
dGMpOwo+ICsJCXRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoaW50ZWxfY3J0Yy0+YmFzZS5k
ZXYpOwo+ICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+
IC0JCSZjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gKwkJJmNydGNfc3RhdGUtPmh3
LmFkanVzdGVkX21vZGU7Cj4gIAo+ICAJLyoKPiAgCSAqIFNyYyBjb29yZGluYXRlcyBhcmUgYWxy
ZWFkeSByb3RhdGVkIGJ5IDI3MCBkZWdyZWVzIGZvcgo+IEBAIC01NDQ2LDcgKzU0NDYsNyBAQCBz
a2xfdXBkYXRlX3NjYWxlcihzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwgYm9v
bCBmb3JjZV9kZXRhY2gsCj4gIAkgKiBPbmNlIE5WMTIgaXMgZW5hYmxlZCwgaGFuZGxlIGl0IGhl
cmUgd2hpbGUgYWxsb2NhdGluZyBzY2FsZXIKPiAgCSAqIGZvciBOVjEyLgo+ICAJICovCj4gLQlp
ZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5ICYmIGNydGNfc3RhdGUtPmJhc2UuZW5hYmxlICYm
Cj4gKwlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5ICYmIGNydGNfc3RhdGUtPmh3LmVuYWJs
ZSAmJgo+ICAJICAgIG5lZWRfc2NhbGVyICYmIGFkanVzdGVkX21vZGUtPmZsYWdzICYgRFJNX01P
REVfRkxBR19JTlRFUkxBQ0UpIHsKPiAgCQlEUk1fREVCVUdfS01TKCJQaXBlL1BsYW5lIHNjYWxp
bmcgbm90IHN1cHBvcnRlZCB3aXRoIElGLUlEIG1vZGVcbiIpOwo+ICAJCXJldHVybiAtRUlOVkFM
Owo+IEBAIC01NTE4LDEzICs1NTE4LDEzIEBAIHNrbF91cGRhdGVfc2NhbGVyKHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLCBib29sIGZvcmNlX2RldGFjaCwKPiAgICovCj4gIGlu
dCBza2xfdXBkYXRlX3NjYWxlcl9jcnRjKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpzdGF0ZSkK
PiAgewo+IC0JY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAm
c3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPiArCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9t
b2RlICphZGp1c3RlZF9tb2RlID0gJnN0YXRlLT5ody5hZGp1c3RlZF9tb2RlOwo+ICAJYm9vbCBu
ZWVkX3NjYWxlciA9IGZhbHNlOwo+ICAKPiAgCWlmIChzdGF0ZS0+b3V0cHV0X2Zvcm1hdCA9PSBJ
TlRFTF9PVVRQVVRfRk9STUFUX1lDQkNSNDIwKQo+ICAJCW5lZWRfc2NhbGVyID0gdHJ1ZTsKPiAg
Cj4gLQlyZXR1cm4gc2tsX3VwZGF0ZV9zY2FsZXIoc3RhdGUsICFzdGF0ZS0+YmFzZS5hY3RpdmUs
IFNLTF9DUlRDX0lOREVYLAo+ICsJcmV0dXJuIHNrbF91cGRhdGVfc2NhbGVyKHN0YXRlLCAhc3Rh
dGUtPmh3LmFjdGl2ZSwgU0tMX0NSVENfSU5ERVgsCj4gIAkJCQkgJnN0YXRlLT5zY2FsZXJfc3Rh
dGUuc2NhbGVyX2lkLAo+ICAJCQkJIHN0YXRlLT5waXBlX3NyY193LCBzdGF0ZS0+cGlwZV9zcmNf
aCwKPiAgCQkJCSBhZGp1c3RlZF9tb2RlLT5jcnRjX2hkaXNwbGF5LAo+IEBAIC01NjI0LDcgKzU2
MjQsNyBAQCBzdGF0aWMgdm9pZCBza3lsYWtlX3NjYWxlcl9kaXNhYmxlKHN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjKQo+ICAKPiAgc3RhdGljIHZvaWQgc2t5bGFrZV9wZml0X2VuYWJsZShjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVs
X2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5j
cnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwo+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAJY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc2NhbGVyX3N0YXRlICpzY2FsZXJfc3RhdGUgPQo+IEBAIC01NjYx
LDcgKzU2NjEsNyBAQCBzdGF0aWMgdm9pZCBza3lsYWtlX3BmaXRfZW5hYmxlKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAKPiAgc3RhdGljIHZvaWQgaXJvbmxh
a2VfcGZpdF9lbmFibGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUp
Cj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0
YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9j
cnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCWVudW0gcGlwZSBwaXBlID0g
Y3J0Yy0+cGlwZTsKPiAgCj4gQEAgLTU2ODIsNyArNTY4Miw3IEBAIHN0YXRpYyB2b2lkIGlyb25s
YWtlX3BmaXRfZW5hYmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
KQo+ICAKPiAgdm9pZCBoc3dfZW5hYmxlX2lwcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYgPSBjcnRjLT5iYXNlLmRldjsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiAgCj4gQEAgLTU3MTgsNyArNTcxOCw3IEBAIHZv
aWQgaHN3X2VuYWJsZV9pcHMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUpCj4gIAo+ICB2b2lkIGhzd19kaXNhYmxlX2lwcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19p
bnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBk
cm1fZGV2aWNlICpkZXYgPSBjcnRjLT5iYXNlLmRldjsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiAgCj4gQEAgLTU4MjgsNyArNTgyOCw3IEBA
IGludGVsX3ByZV9kaXNhYmxlX3ByaW1hcnlfbm9hdG9taWMoc3RydWN0IGRybV9jcnRjICpjcnRj
KQo+ICBzdGF0aWMgYm9vbCBoc3dfcHJlX3VwZGF0ZV9kaXNhYmxlX2lwcyhjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCj4gIAkJCQkgICAgICAgY29uc3Qgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMobmV3X2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7
Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMobmV3X2NydGNfc3Rh
dGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCj4gIAlpZiAoIW9sZF9jcnRjX3N0YXRlLT5pcHNf
ZW5hYmxlZCkKPiBAQCAtNTg0NCw3ICs1ODQ0LDcgQEAgc3RhdGljIGJvb2wgaHN3X3ByZV91cGRh
dGVfZGlzYWJsZV9pcHMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3MK
PiAgCSAqIERpc2FibGUgSVBTIGJlZm9yZSB3ZSBwcm9ncmFtIHRoZSBMVVQuCj4gIAkgKi8KPiAg
CWlmIChJU19IQVNXRUxMKGRldl9wcml2KSAmJgo+IC0JICAgIChuZXdfY3J0Y19zdGF0ZS0+YmFz
ZS5jb2xvcl9tZ210X2NoYW5nZWQgfHwKPiArCSAgICAobmV3X2NydGNfc3RhdGUtPnVhcGkuY29s
b3JfbWdtdF9jaGFuZ2VkIHx8Cj4gIAkgICAgIG5ld19jcnRjX3N0YXRlLT51cGRhdGVfcGlwZSkg
JiYKPiAgCSAgICBuZXdfY3J0Y19zdGF0ZS0+Z2FtbWFfbW9kZSA9PSBHQU1NQV9NT0RFX01PREVf
U1BMSVQpCj4gIAkJcmV0dXJuIHRydWU7Cj4gQEAgLTU4NTUsNyArNTg1NSw3IEBAIHN0YXRpYyBi
b29sIGhzd19wcmVfdXBkYXRlX2Rpc2FibGVfaXBzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpvbGRfY3J0Y19zCj4gIHN0YXRpYyBib29sIGhzd19wb3N0X3VwZGF0ZV9lbmFibGVfaXBz
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKPiAgCQkJCSAg
ICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUpCj4gIHsK
PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhuZXdfY3J0Y19zdGF0
ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0
YyhuZXdfY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAKPiAgCWlmICghbmV3X2Ny
dGNfc3RhdGUtPmlwc19lbmFibGVkKQo+IEBAIC01ODcxLDcgKzU4NzEsNyBAQCBzdGF0aWMgYm9v
bCBoc3dfcG9zdF91cGRhdGVfZW5hYmxlX2lwcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqb2xkX2NydGNfcwo+ICAJICogUmUtZW5hYmxlIElQUyBhZnRlciB0aGUgTFVUIGhhcyBiZWVu
IHByb2dyYW1tZWQuCj4gIAkgKi8KPiAgCWlmIChJU19IQVNXRUxMKGRldl9wcml2KSAmJgo+IC0J
ICAgIChuZXdfY3J0Y19zdGF0ZS0+YmFzZS5jb2xvcl9tZ210X2NoYW5nZWQgfHwKPiArCSAgICAo
bmV3X2NydGNfc3RhdGUtPnVhcGkuY29sb3JfbWdtdF9jaGFuZ2VkIHx8Cj4gIAkgICAgIG5ld19j
cnRjX3N0YXRlLT51cGRhdGVfcGlwZSkgJiYKPiAgCSAgICBuZXdfY3J0Y19zdGF0ZS0+Z2FtbWFf
bW9kZSA9PSBHQU1NQV9NT0RFX01PREVfU1BMSVQpCj4gIAkJcmV0dXJuIHRydWU7Cj4gQEAgLTU4
ODEsNyArNTg4MSw3IEBAIHN0YXRpYyBib29sIGhzd19wb3N0X3VwZGF0ZV9lbmFibGVfaXBzKGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zCj4gIAkgKiBmb3JjaWJseSBl
bmFibGUgSVBTIG9uIHRoZSBmaXJzdCBmYXN0c2V0Lgo+ICAJICovCj4gIAlpZiAobmV3X2NydGNf
c3RhdGUtPnVwZGF0ZV9waXBlICYmCj4gLQkgICAgb2xkX2NydGNfc3RhdGUtPmJhc2UuYWRqdXN0
ZWRfbW9kZS5wcml2YXRlX2ZsYWdzICYgSTkxNV9NT0RFX0ZMQUdfSU5IRVJJVEVEKQo+ICsJICAg
IG9sZF9jcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlLnByaXZhdGVfZmxhZ3MgJiBJOTE1X01P
REVfRkxBR19JTkhFUklURUQpCj4gIAkJcmV0dXJuIHRydWU7Cj4gIAo+ICAJcmV0dXJuICFvbGRf
Y3J0Y19zdGF0ZS0+aXBzX2VuYWJsZWQ7Cj4gQEAgLTU5MTIsMTAgKzU5MTIsMTAgQEAgc3RhdGlj
IGJvb2wgbmVlZHNfc2NhbGVyY2xrX3dhKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiAgCj4gIHN0YXRpYyB2b2lkIGludGVsX3Bvc3RfcGxhbmVfdXBkYXRlKHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMg
KmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT51YXBp
LmNydGMpOwo+ICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmJhc2UuZGV2Owo+ICAJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+IC0Jc3Ry
dWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0gb2xkX2NydGNfc3RhdGUtPmJhc2Uuc3RhdGU7
Cj4gKwlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUgPSBvbGRfY3J0Y19zdGF0ZS0+dWFw
aS5zdGF0ZTsKPiAgCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZyA9Cj4gIAkJ
aW50ZWxfYXRvbWljX2dldF9uZXdfY3J0Y19zdGF0ZSh0b19pbnRlbF9hdG9taWNfc3RhdGUoc3Rh
dGUpLAo+ICAJCQkJCQljcnRjKTsKPiBAQCAtNTkyNSw3ICs1OTI1LDcgQEAgc3RhdGljIHZvaWQg
aW50ZWxfcG9zdF9wbGFuZV91cGRhdGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRj
X3N0YXRlKQo+ICAKPiAgCWludGVsX2Zyb250YnVmZmVyX2ZsaXAodG9faTkxNShjcnRjLT5iYXNl
LmRldiksIHBpcGVfY29uZmlnLT5mYl9iaXRzKTsKPiAgCj4gLQlpZiAocGlwZV9jb25maWctPnVw
ZGF0ZV93bV9wb3N0ICYmIHBpcGVfY29uZmlnLT5iYXNlLmFjdGl2ZSkKPiArCWlmIChwaXBlX2Nv
bmZpZy0+dXBkYXRlX3dtX3Bvc3QgJiYgcGlwZV9jb25maWctPmh3LmFjdGl2ZSkKPiAgCQlpbnRl
bF91cGRhdGVfd2F0ZXJtYXJrcyhjcnRjKTsKPiAgCj4gIAlpZiAoaHN3X3Bvc3RfdXBkYXRlX2Vu
YWJsZV9pcHMob2xkX2NydGNfc3RhdGUsIHBpcGVfY29uZmlnKSkKPiBAQCAtNTk1NSwxMCArNTk1
NSwxMCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wb3N0X3BsYW5lX3VwZGF0ZShzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUpCj4gIHN0YXRpYyB2b2lkIGludGVsX3ByZV9wbGFu
ZV91cGRhdGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+ICAJCQkJ
ICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ICB7Cj4gLQlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMob2xkX2NydGNfc3RhdGUtPmJhc2UuY3J0
Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMob2xkX2NydGNf
c3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+YmFz
ZS5kZXY7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRl
dik7Cj4gLQlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUgPSBvbGRfY3J0Y19zdGF0ZS0+
YmFzZS5zdGF0ZTsKPiArCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSA9IG9sZF9jcnRj
X3N0YXRlLT51YXBpLnN0YXRlOwo+ICAJc3RydWN0IGRybV9wbGFuZSAqcHJpbWFyeSA9IGNydGMt
PmJhc2UucHJpbWFyeTsKPiAgCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm9sZF9wcmltYXJ5X3N0
YXRlID0KPiAgCQlkcm1fYXRvbWljX2dldF9vbGRfcGxhbmVfc3RhdGUoc3RhdGUsIHByaW1hcnkp
Owo+IEBAIC02MDAzLDcgKzYwMDMsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wcmVfcGxhbmVfdXBk
YXRlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKPiAgCSAqIGV2ZW50
IHdoaWNoIGlzIGFmdGVyIHRoZSB2Ymxhbmsgc3RhcnQgZXZlbnQsIHNvIHdlIG5lZWQgdG8gaGF2
ZSBhCj4gIAkgKiB3YWl0LWZvci12YmxhbmsgYmV0d2VlbiBkaXNhYmxpbmcgdGhlIHBsYW5lIGFu
ZCB0aGUgcGlwZS4KPiAgCSAqLwo+IC0JaWYgKEhBU19HTUNIKGRldl9wcml2KSAmJiBvbGRfY3J0
Y19zdGF0ZS0+YmFzZS5hY3RpdmUgJiYKPiArCWlmIChIQVNfR01DSChkZXZfcHJpdikgJiYgb2xk
X2NydGNfc3RhdGUtPmh3LmFjdGl2ZSAmJgo+ICAJICAgIHBpcGVfY29uZmlnLT5kaXNhYmxlX2N4
c3IgJiYgaW50ZWxfc2V0X21lbW9yeV9jeHNyKGRldl9wcml2LCBmYWxzZSkpCj4gIAkJaW50ZWxf
d2FpdF9mb3JfdmJsYW5rKGRldl9wcml2LCBjcnRjLT5waXBlKTsKPiAgCj4gQEAgLTYwMTUsNyAr
NjAxNSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3ByZV9wbGFuZV91cGRhdGUoc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+ICAJICogV2FDeFNSRGlzYWJsZWRGb3JTcHJp
dGVTY2FsaW5nOml2Ygo+ICAJICovCj4gIAlpZiAocGlwZV9jb25maWctPmRpc2FibGVfbHBfd20g
JiYgaWxrX2Rpc2FibGVfbHBfd20oZGV2KSAmJgo+IC0JICAgIG9sZF9jcnRjX3N0YXRlLT5iYXNl
LmFjdGl2ZSkKPiArCSAgICBvbGRfY3J0Y19zdGF0ZS0+aHcuYWN0aXZlKQo+ICAJCWludGVsX3dh
aXRfZm9yX3ZibGFuayhkZXZfcHJpdiwgY3J0Yy0+cGlwZSk7Cj4gIAo+ICAJLyoKPiBAQCAtNjMx
MCw3ICs2MzEwLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZW5jb2RlcnNfdXBkYXRlX3BpcGUoc3Ry
dWN0IGludGVsX2NydGMgKmNydGMsCj4gIAo+ICBzdGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxlX3By
aW1hcnlfcGxhbmUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4g
IHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRl
LT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRj
KGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lID0g
dG9faW50ZWxfcGxhbmUoY3J0Yy0+YmFzZS5wcmltYXJ5KTsKPiAgCj4gIAlwbGFuZS0+ZGlzYWJs
ZV9wbGFuZShwbGFuZSwgY3J0Y19zdGF0ZSk7Cj4gQEAgLTYzMTksNyArNjMxOSw3IEBAIHN0YXRp
YyB2b2lkIGludGVsX2Rpc2FibGVfcHJpbWFyeV9wbGFuZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0Cj4gIHN0YXRpYyB2b2lkIGlyb25sYWtlX2NydGNfZW5hYmxlKHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKPiAgCQkJCSBzdHJ1Y3QgaW50ZWxf
YXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGRybV9jcnRjICpjcnRjID0gcGlw
ZV9jb25maWctPmJhc2UuY3J0YzsKPiArCXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9IHBpcGVfY29u
ZmlnLT51YXBpLmNydGM7Cj4gIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+ZGV2Owo+
ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICAJ
c3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGMpOwo+IEBA
IC02NDUzLDcgKzY0NTMsNyBAQCBzdGF0aWMgdm9pZCBpY2xfcGlwZV9tYnVzX2VuYWJsZShzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiAgc3RhdGljIHZvaWQgaGFzd2VsbF9jcnRjX2VuYWJsZShz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4gIAkJCQlzdHJ1Y3QgaW50ZWxf
YXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGRybV9jcnRjICpjcnRjID0gcGlw
ZV9jb25maWctPmJhc2UuY3J0YzsKPiArCXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9IHBpcGVfY29u
ZmlnLT51YXBpLmNydGM7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGNydGMtPmRldik7Cj4gIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRv
X2ludGVsX2NydGMoY3J0Yyk7Cj4gIAllbnVtIHBpcGUgcGlwZSA9IGludGVsX2NydGMtPnBpcGUs
IGhzd193b3JrYXJvdW5kX3BpcGU7Cj4gQEAgLTY1NjIsNyArNjU2Miw3IEBAIHN0YXRpYyB2b2lk
IGhhc3dlbGxfY3J0Y19lbmFibGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmln
LAo+ICAKPiAgc3RhdGljIHZvaWQgaXJvbmxha2VfcGZpdF9kaXNhYmxlKGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2Ny
dGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJ
c3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT51
YXBpLmNydGMpOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjcnRjLT5iYXNlLmRldik7Cj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gIAo+
IEBAIC02NTc4LDcgKzY1NzgsNyBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9wZml0X2Rpc2FibGUo
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlKQo+ICBzdGF0aWMg
dm9pZCBpcm9ubGFrZV9jcnRjX2Rpc2FibGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9j
cnRjX3N0YXRlLAo+ICAJCQkJICBzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAg
ewo+IC0Jc3RydWN0IGRybV9jcnRjICpjcnRjID0gb2xkX2NydGNfc3RhdGUtPmJhc2UuY3J0YzsK
PiArCXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9IG9sZF9jcnRjX3N0YXRlLT51YXBpLmNydGM7Cj4g
IAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+ZGV2Owo+ICAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICAJc3RydWN0IGludGVsX2NydGMg
KmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGMpOwo+IEBAIC02NjM3LDcgKzY2MzcsNyBA
QCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9jcnRjX2Rpc2FibGUoc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKm9sZF9jcnRjX3N0YXRlLAo+ICBzdGF0aWMgdm9pZCBoYXN3ZWxsX2NydGNfZGlzYWJsZShz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCj4gIAkJCQkgc3RydWN0IGlu
dGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9
IG9sZF9jcnRjX3N0YXRlLT5iYXNlLmNydGM7Cj4gKwlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSBv
bGRfY3J0Y19zdGF0ZS0+dWFwaS5jcnRjOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShjcnRjLT5kZXYpOwo+ICAJc3RydWN0IGludGVsX2NydGMgKmludGVs
X2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGMpOwo+ICAJZW51bSB0cmFuc2NvZGVyIGNwdV90cmFu
c2NvZGVyID0gb2xkX2NydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyOwo+IEBAIC02NjcxLDcgKzY2
NzEsNyBAQCBzdGF0aWMgdm9pZCBoYXN3ZWxsX2NydGNfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCj4gIAo+ICBzdGF0aWMgdm9pZCBpOXh4X3BmaXRfZW5h
YmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gLQlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5j
cnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0
YXRlLT51YXBpLmNydGMpOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gIAo+ICAJaWYgKCFjcnRjX3N0YXRlLT5nbWNoX3Bm
aXQuY29udHJvbCkKPiBAQCAtNjgwMSwxNCArNjgwMSwxNCBAQCBpbnRlbF9hdXhfcG93ZXJfZG9t
YWluKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KQo+ICAKPiAgc3RhdGljIHU2
NCBnZXRfY3J0Y19wb3dlcl9kb21haW5zKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0
Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50
ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gIAlzdHJ1Y3QgZHJtX2Vu
Y29kZXIgKmVuY29kZXI7Cj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gIAl1NjQg
bWFzazsKPiAgCWVudW0gdHJhbnNjb2RlciB0cmFuc2NvZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3Ry
YW5zY29kZXI7Cj4gIAo+IC0JaWYgKCFjcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSkKPiArCWlmICgh
Y3J0Y19zdGF0ZS0+aHcuYWN0aXZlKQo+ICAJCXJldHVybiAwOwo+ICAKPiAgCW1hc2sgPSBCSVRf
VUxMKFBPV0VSX0RPTUFJTl9QSVBFKHBpcGUpKTsKPiBAQCAtNjgxOCw3ICs2ODE4LDcgQEAgc3Rh
dGljIHU2NCBnZXRfY3J0Y19wb3dlcl9kb21haW5zKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlKQo+ICAJCW1hc2sgfD0gQklUX1VMTChQT1dFUl9ET01BSU5fUElQRV9QQU5FTF9G
SVRURVIocGlwZSkpOwo+ICAKPiAgCWRybV9mb3JfZWFjaF9lbmNvZGVyX21hc2soZW5jb2Rlciwg
JmRldl9wcml2LT5kcm0sCj4gLQkJCQkgIGNydGNfc3RhdGUtPmJhc2UuZW5jb2Rlcl9tYXNrKSB7
Cj4gKwkJCQkgIGNydGNfc3RhdGUtPnVhcGkuZW5jb2Rlcl9tYXNrKSB7Cj4gIAkJc3RydWN0IGlu
dGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIgPSB0b19pbnRlbF9lbmNvZGVyKGVuY29kZXIpOwo+
ICAKPiAgCQltYXNrIHw9IEJJVF9VTEwoaW50ZWxfZW5jb2Rlci0+cG93ZXJfZG9tYWluKTsKPiBA
QCAtNjgzNiw3ICs2ODM2LDcgQEAgc3RhdGljIHU2NCBnZXRfY3J0Y19wb3dlcl9kb21haW5zKHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICBzdGF0aWMgdTY0Cj4gIG1vZGVz
ZXRfZ2V0X2NydGNfcG93ZXJfZG9tYWlucyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNy
dGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAJZW51bSBpbnRlbF9k
aXNwbGF5X3Bvd2VyX2RvbWFpbiBkb21haW47Cj4gIAl1NjQgZG9tYWlucywgbmV3X2RvbWFpbnMs
IG9sZF9kb21haW5zOwo+IEBAIC02ODY1LDcgKzY4NjUsNyBAQCBzdGF0aWMgdm9pZCBtb2Rlc2V0
X3B1dF9wb3dlcl9kb21haW5zKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAg
c3RhdGljIHZvaWQgdmFsbGV5dmlld19jcnRjX2VuYWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqcGlwZV9jb25maWcsCj4gIAkJCQkgICBzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0
ZSkKPiAgewo+IC0Jc3RydWN0IGRybV9jcnRjICpjcnRjID0gcGlwZV9jb25maWctPmJhc2UuY3J0
YzsKPiArCXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9IHBpcGVfY29uZmlnLT51YXBpLmNydGM7Cj4g
IAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+ZGV2Owo+ICAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICAJc3RydWN0IGludGVsX2NydGMg
KmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGMpOwo+IEBAIC02OTIxLDcgKzY5MjEsNyBA
QCBzdGF0aWMgdm9pZCB2YWxsZXl2aWV3X2NydGNfZW5hYmxlKHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpwaXBlX2NvbmZpZywKPiAgCj4gIHN0YXRpYyB2b2lkIGk5eHhfc2V0X3BsbF9kaXZpZGVy
cyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0
Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0
ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAKPiAgCUk5MTVfV1JJVEUoRlAwKGNydGMtPnBpcGUp
LCBjcnRjX3N0YXRlLT5kcGxsX2h3X3N0YXRlLmZwMCk7Cj4gQEAgLTY5MzEsNyArNjkzMSw3IEBA
IHN0YXRpYyB2b2lkIGk5eHhfc2V0X3BsbF9kaXZpZGVycyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgc3RhdGljIHZvaWQgaTl4eF9jcnRjX2VuYWJsZShzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4gIAkJCSAgICAgc3RydWN0IGludGVs
X2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9IHBp
cGVfY29uZmlnLT5iYXNlLmNydGM7Cj4gKwlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSBwaXBlX2Nv
bmZpZy0+dWFwaS5jcnRjOwo+ICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmRldjsK
PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiAg
CXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjKTsKPiBA
QCAtNjk4MSw3ICs2OTgxLDcgQEAgc3RhdGljIHZvaWQgaTl4eF9jcnRjX2VuYWJsZShzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4gIAo+ICBzdGF0aWMgdm9pZCBpOXh4X3Bm
aXRfZGlzYWJsZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUp
Cj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhvbGRfY3J0
Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50
ZWxfY3J0YyhvbGRfY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAKPiAgCWlmICgh
b2xkX2NydGNfc3RhdGUtPmdtY2hfcGZpdC5jb250cm9sKQo+IEBAIC02OTk3LDcgKzY5OTcsNyBA
QCBzdGF0aWMgdm9pZCBpOXh4X3BmaXRfZGlzYWJsZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqb2xkX2NydGNfc3RhdGUpCj4gIHN0YXRpYyB2b2lkIGk5eHhfY3J0Y19kaXNhYmxlKHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKPiAgCQkJICAgICAgc3RydWN0
IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBkcm1fY3J0YyAqY3J0
YyA9IG9sZF9jcnRjX3N0YXRlLT5iYXNlLmNydGM7Cj4gKwlzdHJ1Y3QgZHJtX2NydGMgKmNydGMg
PSBvbGRfY3J0Y19zdGF0ZS0+dWFwaS5jcnRjOwo+ICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9
IGNydGMtPmRldjsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoZGV2KTsKPiAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0
YyhjcnRjKTsKPiBAQCAtNzE2NSw4ICs3MTY1LDggQEAgc3RhdGljIHZvaWQgaW50ZWxfY29ubmVj
dG9yX3ZlcmlmeV9zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAg
CQlpZiAoIWNydGNfc3RhdGUpCj4gIAkJCXJldHVybjsKPiAgCj4gLQkJSTkxNV9TVEFURV9XQVJO
KCFjcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSwKPiAtCQkgICAgICAiY29ubmVjdG9yIGlzIGFjdGl2
ZSwgYnV0IGF0dGFjaGVkIGNydGMgaXNuJ3RcbiIpOwo+ICsJCUk5MTVfU1RBVEVfV0FSTighY3J0
Y19zdGF0ZS0+aHcuYWN0aXZlLAo+ICsJCQkJImNvbm5lY3RvciBpcyBhY3RpdmUsIGJ1dCBhdHRh
Y2hlZCBjcnRjIGlzbid0XG4iKTsKPiAgCj4gIAkJaWYgKCFlbmNvZGVyIHx8IGVuY29kZXItPnR5
cGUgPT0gSU5URUxfT1VUUFVUX0RQX01TVCkKPiAgCQkJcmV0dXJuOwo+IEBAIC03MTc3LDggKzcx
NzcsOCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9jb25uZWN0b3JfdmVyaWZ5X3N0YXRlKHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAJCUk5MTVfU1RBVEVfV0FSTihjb25uX3N0
YXRlLT5jcnRjICE9IGVuY29kZXItPmJhc2UuY3J0YywKPiAgCQkJImF0dGFjaGVkIGVuY29kZXIg
Y3J0YyBkaWZmZXJzIGZyb20gY29ubmVjdG9yIGNydGNcbiIpOwo+ICAJfSBlbHNlIHsKPiAtCQlJ
OTE1X1NUQVRFX1dBUk4oY3J0Y19zdGF0ZSAmJiBjcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSwKPiAt
CQkJImF0dGFjaGVkIGNydGMgaXMgYWN0aXZlLCBidXQgY29ubmVjdG9yIGlzbid0XG4iKTsKPiAr
CQlJOTE1X1NUQVRFX1dBUk4oY3J0Y19zdGF0ZSAmJiBjcnRjX3N0YXRlLT5ody5hY3RpdmUsCj4g
KwkJCQkiYXR0YWNoZWQgY3J0YyBpcyBhY3RpdmUsIGJ1dCBjb25uZWN0b3IgaXNuJ3RcbiIpOwo+
ICAJCUk5MTVfU1RBVEVfV0FSTighY3J0Y19zdGF0ZSAmJiBjb25uX3N0YXRlLT5iZXN0X2VuY29k
ZXIsCj4gIAkJCSJiZXN0IGVuY29kZXIgc2V0IHdpdGhvdXQgY3J0YyFcbiIpOwo+ICAJfQo+IEBA
IC03MTg2LDcgKzcxODYsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9jb25uZWN0b3JfdmVyaWZ5X3N0
YXRlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAKPiAgc3RhdGljIGlu
dCBwaXBlX3JlcXVpcmVkX2ZkaV9sYW5lcyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSkKPiAgewo+IC0JaWYgKGNydGNfc3RhdGUtPmJhc2UuZW5hYmxlICYmIGNydGNfc3RhdGUt
Pmhhc19wY2hfZW5jb2RlcikKPiArCWlmIChjcnRjX3N0YXRlLT5ody5lbmFibGUgJiYgY3J0Y19z
dGF0ZS0+aGFzX3BjaF9lbmNvZGVyKQo+ICAJCXJldHVybiBjcnRjX3N0YXRlLT5mZGlfbGFuZXM7
Cj4gIAo+ICAJcmV0dXJuIDA7Cj4gQEAgLTcxOTYsNyArNzE5Niw3IEBAIHN0YXRpYyBpbnQgaXJv
bmxha2VfY2hlY2tfZmRpX2xhbmVzKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIGVudW0gcGlwZSBw
aXBlLAo+ICAJCQkJICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4g
IHsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsK
PiAtCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSA9IHBpcGVfY29uZmlnLT5iYXNlLnN0
YXRlOwo+ICsJc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0gcGlwZV9jb25maWctPnVh
cGkuc3RhdGU7Cj4gIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqb3RoZXJfY3J0YzsKPiAgCXN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpvdGhlcl9jcnRjX3N0YXRlOwo+ICAKPiBAQCAtNzI2OSw3ICs3MjY5
LDcgQEAgc3RhdGljIGludCBpcm9ubGFrZV9mZGlfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVs
X2NydGMgKmludGVsX2NydGMsCj4gIAkJCQkgICAgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KnBpcGVfY29uZmlnKQo+ICB7Cj4gIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gaW50ZWxfY3J0
Yy0+YmFzZS5kZXY7Cj4gLQljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRf
bW9kZSA9ICZwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICsJY29uc3Qgc3RydWN0
IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmcGlwZV9jb25maWctPmh3LmFkanVz
dGVkX21vZGU7Cj4gIAlpbnQgbGFuZSwgbGlua19idywgZmRpX2RvdGNsb2NrLCByZXQ7Cj4gIAli
b29sIG5lZWRzX3JlY29tcHV0ZSA9IGZhbHNlOwo+ICAKPiBAQCAtNzMxNSw3ICs3MzE1LDcgQEAg
c3RhdGljIGludCBpcm9ubGFrZV9mZGlfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2NydGMg
KmludGVsX2NydGMsCj4gIAo+ICBib29sIGhzd19jcnRjX3N0YXRlX2lwc19jYXBhYmxlKGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiAr
CXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBp
LmNydGMpOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShj
cnRjLT5iYXNlLmRldik7Cj4gIAo+ICAJLyogSVBTIG9ubHkgZXhpc3RzIG9uIFVMVCBtYWNoaW5l
cyBhbmQgaXMgdGllZCB0byBwaXBlIEEuICovCj4gQEAgLTczNDUsOSArNzM0NSw5IEBAIGJvb2wg
aHN3X2NydGNfc3RhdGVfaXBzX2NhcGFibGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUpCj4gIHN0YXRpYyBib29sIGhzd19jb21wdXRlX2lwc19jb25maWcoc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHsKPiAgCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9Cj4gLQkJdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRl
dik7Cj4gKwkJdG9faTkxNShjcnRjX3N0YXRlLT51YXBpLmNydGMtPmRldik7Cj4gIAlzdHJ1Y3Qg
aW50ZWxfYXRvbWljX3N0YXRlICppbnRlbF9zdGF0ZSA9Cj4gLQkJdG9faW50ZWxfYXRvbWljX3N0
YXRlKGNydGNfc3RhdGUtPmJhc2Uuc3RhdGUpOwo+ICsJCXRvX2ludGVsX2F0b21pY19zdGF0ZShj
cnRjX3N0YXRlLT51YXBpLnN0YXRlKTsKPiAgCj4gIAlpZiAoIWhzd19jcnRjX3N0YXRlX2lwc19j
YXBhYmxlKGNydGNfc3RhdGUpKQo+ICAJCXJldHVybiBmYWxzZTsKPiBAQCAtNzM4Niw3ICs3Mzg2
LDcgQEAgc3RhdGljIHUzMiBpbGtfcGlwZV9waXhlbF9yYXRlKGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiAgewo+ICAJdTMyIHBpeGVsX3JhdGU7Cj4gIAo+IC0J
cGl4ZWxfcmF0ZSA9IHBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19jbG9jazsK
PiArCXBpeGVsX3JhdGUgPSBwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2Nr
Owo+ICAKPiAgCS8qCj4gIAkgKiBXZSBvbmx5IHVzZSBJRi1JRCBpbnRlcmxhY2luZy4gSWYgd2Ug
ZXZlciB1c2UKPiBAQCAtNzQxOSwxMiArNzQxOSwxMiBAQCBzdGF0aWMgdTMyIGlsa19waXBlX3Bp
eGVsX3JhdGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ICAK
PiAgc3RhdGljIHZvaWQgaW50ZWxfY3J0Y19jb21wdXRlX3BpeGVsX3JhdGUoc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT51YXBp
LmNydGMtPmRldik7Cj4gIAo+ICAJaWYgKEhBU19HTUNIKGRldl9wcml2KSkKPiAgCQkvKiBGSVhN
RSBjYWxjdWxhdGUgcHJvcGVyIHBpcGUgcGl4ZWwgcmF0ZSBmb3IgR01DSCBwZml0ICovCj4gIAkJ
Y3J0Y19zdGF0ZS0+cGl4ZWxfcmF0ZSA9Cj4gLQkJCWNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRf
bW9kZS5jcnRjX2Nsb2NrOwo+ICsJCQljcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlLmNydGNf
Y2xvY2s7Cj4gIAllbHNlCj4gIAkJY3J0Y19zdGF0ZS0+cGl4ZWxfcmF0ZSA9Cj4gIAkJCWlsa19w
aXBlX3BpeGVsX3JhdGUoY3J0Y19zdGF0ZSk7Cj4gQEAgLTc0MzQsNyArNzQzNCw3IEBAIHN0YXRp
YyBpbnQgaW50ZWxfY3J0Y19jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywK
PiAgCQkJCSAgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ICB7Cj4g
IAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2Uu
ZGV2KTsKPiAtCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0g
JnBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gKwljb25zdCBzdHJ1Y3QgZHJtX2Rp
c3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9k
ZTsKPiAgCWludCBjbG9ja19saW1pdCA9IGRldl9wcml2LT5tYXhfZG90Y2xrX2ZyZXE7Cj4gIAo+
ICAJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA0KSB7Cj4gQEAgLTc0NjAsNyArNzQ2MCw3IEBA
IHN0YXRpYyBpbnQgaW50ZWxfY3J0Y19jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YywKPiAgCj4gIAlpZiAoKHBpcGVfY29uZmlnLT5vdXRwdXRfZm9ybWF0ID09IElOVEVMX09V
VFBVVF9GT1JNQVRfWUNCQ1I0MjAgfHwKPiAgCSAgICAgcGlwZV9jb25maWctPm91dHB1dF9mb3Jt
YXQgPT0gSU5URUxfT1VUUFVUX0ZPUk1BVF9ZQ0JDUjQ0NCkgJiYKPiAtCSAgICAgcGlwZV9jb25m
aWctPmJhc2UuY3RtKSB7Cj4gKwkgICAgIHBpcGVfY29uZmlnLT5ody5jdG0pIHsKPiAgCQkvKgo+
ICAJCSAqIFRoZXJlIGlzIG9ubHkgb25lIHBpcGUgQ1NDIHVuaXQgcGVyIHBpcGUsIGFuZCB3ZSBu
ZWVkIHRoYXQKPiAgCQkgKiBmb3Igb3V0cHV0IGNvbnZlcnNpb24gZnJvbSBSR0ItPllDQkNSLiBT
byBpZiBDVE0gaXMgYWxyZWFkeQo+IEBAIC03NjI5LDcgKzc2MjksNyBAQCBzdGF0aWMgdm9pZCB2
bHZfcGxsYl9yZWNhbF9vcGFtcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVu
dW0gcGlwZQo+ICBzdGF0aWMgdm9pZCBpbnRlbF9wY2hfdHJhbnNjb2Rlcl9zZXRfbV9uKGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAJCQkJCSBjb25zdCBzdHJ1
Y3QgaW50ZWxfbGlua19tX24gKm1fbikKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMg
PSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYp
Owo+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAKPiBAQCAtNzY1Niw3ICs3NjU2
LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfY3B1X3RyYW5zY29kZXJfc2V0X21fbihjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGEKPiAgCQkJCQkgY29uc3Qgc3RydWN0IGludGVs
X2xpbmtfbV9uICptX24sCj4gIAkJCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9saW5rX21fbiAqbTJf
bjIpCj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRj
X3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCWVudW0gcGlwZSBwaXBl
ID0gY3J0Yy0+cGlwZTsKPiAgCWVudW0gdHJhbnNjb2RlciB0cmFuc2NvZGVyID0gY3J0Y19zdGF0
ZS0+Y3B1X3RyYW5zY29kZXI7Cj4gQEAgLTc5NjksNyArNzk2OSw3IEBAIGludCB2bHZfZm9yY2Vf
cGxsX29uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUs
Cj4gIAlpZiAoIXBpcGVfY29uZmlnKQo+ICAJCXJldHVybiAtRU5PTUVNOwo+ICAKPiAtCXBpcGVf
Y29uZmlnLT5iYXNlLmNydGMgPSAmY3J0Yy0+YmFzZTsKPiArCXBpcGVfY29uZmlnLT51YXBpLmNy
dGMgPSAmY3J0Yy0+YmFzZTsKPiAgCXBpcGVfY29uZmlnLT5waXhlbF9tdWx0aXBsaWVyID0gMTsK
PiAgCXBpcGVfY29uZmlnLT5kcGxsID0gKmRwbGw7Cj4gIAo+IEBAIC04MTI5LDExICs4MTI5LDEx
IEBAIHN0YXRpYyB2b2lkIGk4eHhfY29tcHV0ZV9kcGxsKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
LAo+ICAKPiAgc3RhdGljIHZvaWQgaW50ZWxfc2V0X3BpcGVfdGltaW5ncyhjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMg
KmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsK
PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFz
ZS5kZXYpOwo+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAJZW51bSB0cmFuc2Nv
ZGVyIGNwdV90cmFuc2NvZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXI7Cj4gLQljb25z
dCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZjcnRjX3N0YXRlLT5i
YXNlLmFkanVzdGVkX21vZGU7Cj4gKwljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRq
dXN0ZWRfbW9kZSA9ICZjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlOwo+ICAJdTMyIGNydGNf
dnRvdGFsLCBjcnRjX3ZibGFua19lbmQ7Cj4gIAlpbnQgdnN5bmNzaGlmdCA9IDA7Cj4gIAo+IEBA
IC04MTkxLDcgKzgxOTEsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9zZXRfcGlwZV90aW1pbmdzKGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAKPiAgc3RhdGljIHZv
aWQgaW50ZWxfc2V0X3BpcGVfc3JjX3NpemUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxf
Y3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMg
PSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCWVudW0g
cGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCj4gQEAgLTgyMTIsMzkgKzgyMTIsMzkgQEAgc3Rh
dGljIHZvaWQgaW50ZWxfZ2V0X3BpcGVfdGltaW5ncyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywK
PiAgCXUzMiB0bXA7Cj4gIAo+ICAJdG1wID0gSTkxNV9SRUFEKEhUT1RBTChjcHVfdHJhbnNjb2Rl
cikpOwo+IC0JcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2hkaXNwbGF5ID0g
KHRtcCAmIDB4ZmZmZikgKyAxOwo+IC0JcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5j
cnRjX2h0b3RhbCA9ICgodG1wID4+IDE2KSAmIDB4ZmZmZikgKyAxOwo+ICsJcGlwZV9jb25maWct
Pmh3LmFkanVzdGVkX21vZGUuY3J0Y19oZGlzcGxheSA9ICh0bXAgJiAweGZmZmYpICsgMTsKPiAr
CXBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfaHRvdGFsID0gKCh0bXAgPj4gMTYp
ICYgMHhmZmZmKSArIDE7Cj4gIAo+ICAJaWYgKCF0cmFuc2NvZGVyX2lzX2RzaShjcHVfdHJhbnNj
b2RlcikpIHsKPiAgCQl0bXAgPSBJOTE1X1JFQUQoSEJMQU5LKGNwdV90cmFuc2NvZGVyKSk7Cj4g
LQkJcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2hibGFua19zdGFydCA9Cj4g
KwkJcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUuY3J0Y19oYmxhbmtfc3RhcnQgPQo+ICAJ
CQkJCQkJKHRtcCAmIDB4ZmZmZikgKyAxOwo+IC0JCXBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVk
X21vZGUuY3J0Y19oYmxhbmtfZW5kID0KPiArCQlwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9k
ZS5jcnRjX2hibGFua19lbmQgPQo+ICAJCQkJCQkoKHRtcCA+PiAxNikgJiAweGZmZmYpICsgMTsK
PiAgCX0KPiAgCXRtcCA9IEk5MTVfUkVBRChIU1lOQyhjcHVfdHJhbnNjb2RlcikpOwo+IC0JcGlw
ZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2hzeW5jX3N0YXJ0ID0gKHRtcCAmIDB4
ZmZmZikgKyAxOwo+IC0JcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2hzeW5j
X2VuZCA9ICgodG1wID4+IDE2KSAmIDB4ZmZmZikgKyAxOwo+ICsJcGlwZV9jb25maWctPmh3LmFk
anVzdGVkX21vZGUuY3J0Y19oc3luY19zdGFydCA9ICh0bXAgJiAweGZmZmYpICsgMTsKPiArCXBp
cGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfaHN5bmNfZW5kID0gKCh0bXAgPj4gMTYp
ICYgMHhmZmZmKSArIDE7Cj4gIAo+ICAJdG1wID0gSTkxNV9SRUFEKFZUT1RBTChjcHVfdHJhbnNj
b2RlcikpOwo+IC0JcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX3ZkaXNwbGF5
ID0gKHRtcCAmIDB4ZmZmZikgKyAxOwo+IC0JcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9k
ZS5jcnRjX3Z0b3RhbCA9ICgodG1wID4+IDE2KSAmIDB4ZmZmZikgKyAxOwo+ICsJcGlwZV9jb25m
aWctPmh3LmFkanVzdGVkX21vZGUuY3J0Y192ZGlzcGxheSA9ICh0bXAgJiAweGZmZmYpICsgMTsK
PiArCXBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfdnRvdGFsID0gKCh0bXAgPj4g
MTYpICYgMHhmZmZmKSArIDE7Cj4gIAo+ICAJaWYgKCF0cmFuc2NvZGVyX2lzX2RzaShjcHVfdHJh
bnNjb2RlcikpIHsKPiAgCQl0bXAgPSBJOTE1X1JFQUQoVkJMQU5LKGNwdV90cmFuc2NvZGVyKSk7
Cj4gLQkJcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX3ZibGFua19zdGFydCA9
Cj4gKwkJcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUuY3J0Y192Ymxhbmtfc3RhcnQgPQo+
ICAJCQkJCQkJKHRtcCAmIDB4ZmZmZikgKyAxOwo+IC0JCXBpcGVfY29uZmlnLT5iYXNlLmFkanVz
dGVkX21vZGUuY3J0Y192YmxhbmtfZW5kID0KPiArCQlwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRf
bW9kZS5jcnRjX3ZibGFua19lbmQgPQo+ICAJCQkJCQkoKHRtcCA+PiAxNikgJiAweGZmZmYpICsg
MTsKPiAgCX0KPiAgCXRtcCA9IEk5MTVfUkVBRChWU1lOQyhjcHVfdHJhbnNjb2RlcikpOwo+IC0J
cGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX3ZzeW5jX3N0YXJ0ID0gKHRtcCAm
IDB4ZmZmZikgKyAxOwo+IC0JcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX3Zz
eW5jX2VuZCA9ICgodG1wID4+IDE2KSAmIDB4ZmZmZikgKyAxOwo+ICsJcGlwZV9jb25maWctPmh3
LmFkanVzdGVkX21vZGUuY3J0Y192c3luY19zdGFydCA9ICh0bXAgJiAweGZmZmYpICsgMTsKPiAr
CXBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfdnN5bmNfZW5kID0gKCh0bXAgPj4g
MTYpICYgMHhmZmZmKSArIDE7Cj4gIAo+ICAJaWYgKEk5MTVfUkVBRChQSVBFQ09ORihjcHVfdHJh
bnNjb2RlcikpICYgUElQRUNPTkZfSU5URVJMQUNFX01BU0spIHsKPiAtCQlwaXBlX2NvbmZpZy0+
YmFzZS5hZGp1c3RlZF9tb2RlLmZsYWdzIHw9IERSTV9NT0RFX0ZMQUdfSU5URVJMQUNFOwo+IC0J
CXBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y192dG90YWwgKz0gMTsKPiAtCQlw
aXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfdmJsYW5rX2VuZCArPSAxOwo+ICsJ
CXBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmZsYWdzIHw9IERSTV9NT0RFX0ZMQUdfSU5U
RVJMQUNFOwo+ICsJCXBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfdnRvdGFsICs9
IDE7Cj4gKwkJcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUuY3J0Y192YmxhbmtfZW5kICs9
IDE7Cj4gIAl9Cj4gIH0KPiAgCj4gQEAgLTgyNTksMjcgKzgyNTksMjcgQEAgc3RhdGljIHZvaWQg
aW50ZWxfZ2V0X3BpcGVfc3JjX3NpemUoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gIAlwaXBl
X2NvbmZpZy0+cGlwZV9zcmNfaCA9ICh0bXAgJiAweGZmZmYpICsgMTsKPiAgCXBpcGVfY29uZmln
LT5waXBlX3NyY193ID0gKCh0bXAgPj4gMTYpICYgMHhmZmZmKSArIDE7Cj4gIAo+IC0JcGlwZV9j
b25maWctPmJhc2UubW9kZS52ZGlzcGxheSA9IHBpcGVfY29uZmlnLT5waXBlX3NyY19oOwo+IC0J
cGlwZV9jb25maWctPmJhc2UubW9kZS5oZGlzcGxheSA9IHBpcGVfY29uZmlnLT5waXBlX3NyY193
Owo+ICsJcGlwZV9jb25maWctPmh3Lm1vZGUudmRpc3BsYXkgPSBwaXBlX2NvbmZpZy0+cGlwZV9z
cmNfaDsKPiArCXBpcGVfY29uZmlnLT5ody5tb2RlLmhkaXNwbGF5ID0gcGlwZV9jb25maWctPnBp
cGVfc3JjX3c7Cj4gIH0KPiAgCj4gIHZvaWQgaW50ZWxfbW9kZV9mcm9tX3BpcGVfY29uZmlnKHN0
cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlLAo+ICAJCQkJIHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpwaXBlX2NvbmZpZykKPiAgewo+IC0JbW9kZS0+aGRpc3BsYXkgPSBwaXBlX2NvbmZpZy0+
YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfaGRpc3BsYXk7Cj4gLQltb2RlLT5odG90YWwgPSBwaXBl
X2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfaHRvdGFsOwo+IC0JbW9kZS0+aHN5bmNf
c3RhcnQgPSBwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfaHN5bmNfc3RhcnQ7
Cj4gLQltb2RlLT5oc3luY19lbmQgPSBwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNy
dGNfaHN5bmNfZW5kOwo+ICsJbW9kZS0+aGRpc3BsYXkgPSBwaXBlX2NvbmZpZy0+aHcuYWRqdXN0
ZWRfbW9kZS5jcnRjX2hkaXNwbGF5Owo+ICsJbW9kZS0+aHRvdGFsID0gcGlwZV9jb25maWctPmh3
LmFkanVzdGVkX21vZGUuY3J0Y19odG90YWw7Cj4gKwltb2RlLT5oc3luY19zdGFydCA9IHBpcGVf
Y29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfaHN5bmNfc3RhcnQ7Cj4gKwltb2RlLT5oc3lu
Y19lbmQgPSBwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2hzeW5jX2VuZDsKPiAg
Cj4gLQltb2RlLT52ZGlzcGxheSA9IHBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0
Y192ZGlzcGxheTsKPiAtCW1vZGUtPnZ0b3RhbCA9IHBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVk
X21vZGUuY3J0Y192dG90YWw7Cj4gLQltb2RlLT52c3luY19zdGFydCA9IHBpcGVfY29uZmlnLT5i
YXNlLmFkanVzdGVkX21vZGUuY3J0Y192c3luY19zdGFydDsKPiAtCW1vZGUtPnZzeW5jX2VuZCA9
IHBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y192c3luY19lbmQ7Cj4gKwltb2Rl
LT52ZGlzcGxheSA9IHBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfdmRpc3BsYXk7
Cj4gKwltb2RlLT52dG90YWwgPSBwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX3Z0
b3RhbDsKPiArCW1vZGUtPnZzeW5jX3N0YXJ0ID0gcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21v
ZGUuY3J0Y192c3luY19zdGFydDsKPiArCW1vZGUtPnZzeW5jX2VuZCA9IHBpcGVfY29uZmlnLT5o
dy5hZGp1c3RlZF9tb2RlLmNydGNfdnN5bmNfZW5kOwo+ICAKPiAtCW1vZGUtPmZsYWdzID0gcGlw
ZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5mbGFnczsKPiArCW1vZGUtPmZsYWdzID0gcGlw
ZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUuZmxhZ3M7Cj4gIAltb2RlLT50eXBlID0gRFJNX01P
REVfVFlQRV9EUklWRVI7Cj4gIAo+IC0JbW9kZS0+Y2xvY2sgPSBwaXBlX2NvbmZpZy0+YmFzZS5h
ZGp1c3RlZF9tb2RlLmNydGNfY2xvY2s7Cj4gKwltb2RlLT5jbG9jayA9IHBpcGVfY29uZmlnLT5o
dy5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2s7Cj4gIAo+ICAJbW9kZS0+aHN5bmMgPSBkcm1fbW9k
ZV9oc3luYyhtb2RlKTsKPiAgCW1vZGUtPnZyZWZyZXNoID0gZHJtX21vZGVfdnJlZnJlc2gobW9k
ZSk7Cj4gQEAgLTgyODgsNyArODI4OCw3IEBAIHZvaWQgaW50ZWxfbW9kZV9mcm9tX3BpcGVfY29u
ZmlnKHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlLAo+ICAKPiAgc3RhdGljIHZvaWQgaTl4
eF9zZXRfcGlwZWNvbmYoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUp
Cj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0
YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9j
cnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCXUzMiBwaXBlY29uZjsKPiAg
Cj4gQEAgLTgzMjUsNyArODMyNSw3IEBAIHN0YXRpYyB2b2lkIGk5eHhfc2V0X3BpcGVjb25mKGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAJCX0KPiAgCX0KPiAg
Cj4gLQlpZiAoY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlLmZsYWdzICYgRFJNX01PREVf
RkxBR19JTlRFUkxBQ0UpIHsKPiArCWlmIChjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlLmZs
YWdzICYgRFJNX01PREVfRkxBR19JTlRFUkxBQ0UpIHsKPiAgCQlpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA8IDQgfHwKPiAgCQkgICAgaW50ZWxfY3J0Y19oYXNfdHlwZShjcnRjX3N0YXRlLCBJTlRF
TF9PVVRQVVRfU0RWTykpCj4gIAkJCXBpcGVjb25mIHw9IFBJUEVDT05GX0lOVEVSTEFDRV9XX0ZJ
RUxEX0lORElDQVRJT047Cj4gQEAgLTg3NTcsNyArODc1Nyw3IEBAIHN0YXRpYyB2b2lkIGludGVs
X2dldF9jcnRjX3ljYmNyX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgCj4gIHN0
YXRpYyB2b2lkIGk5eHhfZ2V0X3BpcGVfY29sb3JfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAJc3RydWN0IGlu
dGVsX3BsYW5lICpwbGFuZSA9IHRvX2ludGVsX3BsYW5lKGNydGMtPmJhc2UucHJpbWFyeSk7Cj4g
IAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2Uu
ZGV2KTsKPiAgCWVudW0gaTl4eF9wbGFuZV9pZCBpOXh4X3BsYW5lID0gcGxhbmUtPmk5eHhfcGxh
bmU7Cj4gQEAgLTg4ODAsNyArODg4MCw3IEBAIHN0YXRpYyBib29sIGk5eHhfZ2V0X3BpcGVfY29u
ZmlnKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAJICogYnV0IGluIGNhc2UgdGhlIHBpcGUg
aXMgZW5hYmxlZCB3L28gYW55IHBvcnRzIHdlIG5lZWQgYSBzYW5lCj4gIAkgKiBkZWZhdWx0Lgo+
ICAJICovCj4gLQlwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2sgPQo+
ICsJcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUuY3J0Y19jbG9jayA9Cj4gIAkJcGlwZV9j
b25maWctPnBvcnRfY2xvY2sgLyBwaXBlX2NvbmZpZy0+cGl4ZWxfbXVsdGlwbGllcjsKPiAgCj4g
IAlyZXQgPSB0cnVlOwo+IEBAIC05Mzk1LDcgKzkzOTUsNyBAQCB2b2lkIGludGVsX2luaXRfcGNo
X3JlZmNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gIAo+ICBzdGF0aWMg
dm9pZCBpcm9ubGFrZV9zZXRfcGlwZWNvbmYoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxf
Y3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMg
PSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCWVudW0g
cGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCXUzMiB2YWw7Cj4gQEAgLTk0MjMsNyArOTQyMyw3
IEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX3NldF9waXBlY29uZihjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgCWlmIChjcnRjX3N0YXRlLT5kaXRoZXIpCj4gIAkJ
dmFsIHw9IChQSVBFQ09ORl9ESVRIRVJfRU4gfCBQSVBFQ09ORl9ESVRIRVJfVFlQRV9TUCk7Cj4g
IAo+IC0JaWYgKGNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZS5mbGFncyAmIERSTV9NT0RF
X0ZMQUdfSU5URVJMQUNFKQo+ICsJaWYgKGNydGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGUuZmxh
Z3MgJiBEUk1fTU9ERV9GTEFHX0lOVEVSTEFDRSkKPiAgCQl2YWwgfD0gUElQRUNPTkZfSU5URVJM
QUNFRF9JTEs7Cj4gIAllbHNlCj4gIAkJdmFsIHw9IFBJUEVDT05GX1BST0dSRVNTSVZFOwo+IEBA
IC05NDM5LDcgKzk0MzksNyBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9zZXRfcGlwZWNvbmYoY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIAo+ICBzdGF0aWMgdm9p
ZCBoYXN3ZWxsX3NldF9waXBlY29uZihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRj
KGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRv
X2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAJZW51bSB0cmFu
c2NvZGVyIGNwdV90cmFuc2NvZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXI7Cj4gIAl1
MzIgdmFsID0gMDsKPiBAQCAtOTQ0Nyw3ICs5NDQ3LDcgQEAgc3RhdGljIHZvaWQgaGFzd2VsbF9z
ZXRfcGlwZWNvbmYoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4g
IAlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgJiYgY3J0Y19zdGF0ZS0+ZGl0aGVyKQo+ICAJCXZh
bCB8PSAoUElQRUNPTkZfRElUSEVSX0VOIHwgUElQRUNPTkZfRElUSEVSX1RZUEVfU1ApOwo+ICAK
PiAtCWlmIChjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGUuZmxhZ3MgJiBEUk1fTU9ERV9G
TEFHX0lOVEVSTEFDRSkKPiArCWlmIChjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlLmZsYWdz
ICYgRFJNX01PREVfRkxBR19JTlRFUkxBQ0UpCj4gIAkJdmFsIHw9IFBJUEVDT05GX0lOVEVSTEFD
RURfSUxLOwo+ICAJZWxzZQo+ICAJCXZhbCB8PSBQSVBFQ09ORl9QUk9HUkVTU0lWRTsKPiBAQCAt
OTQ1OCw3ICs5NDU4LDcgQEAgc3RhdGljIHZvaWQgaGFzd2VsbF9zZXRfcGlwZWNvbmYoY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIAo+ICBzdGF0aWMgdm9pZCBi
ZHdfc2V0X3BpcGVtaXNjKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
KQo+ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19z
dGF0ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxf
Y3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gIAl1MzIgdmFsID0gMDsKPiAg
Cj4gQEAgLTk2NDQsNyArOTY0NCw3IEBAIHN0YXRpYyBpbnQgaXJvbmxha2VfY3J0Y19jb21wdXRl
X2Nsb2NrKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICB7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCXN0cnVjdCBp
bnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlID0KPiAtCQl0b19pbnRlbF9hdG9taWNfc3RhdGUoY3J0
Y19zdGF0ZS0+YmFzZS5zdGF0ZSk7Cj4gKwkJdG9faW50ZWxfYXRvbWljX3N0YXRlKGNydGNfc3Rh
dGUtPnVhcGkuc3RhdGUpOwo+ICAJY29uc3Qgc3RydWN0IGludGVsX2xpbWl0ICpsaW1pdDsKPiAg
CWludCByZWZjbGsgPSAxMjAwMDA7Cj4gIAo+IEBAIC0xMDA2MCw3ICsxMDA2MCw3IEBAIHN0YXRp
YyBpbnQgaGFzd2VsbF9jcnRjX2NvbXB1dGVfY2xvY2soc3RydWN0IGludGVsX2NydGMgKmNydGMs
Cj4gIHsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwo+ICAJc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUgPQo+IC0J
CXRvX2ludGVsX2F0b21pY19zdGF0ZShjcnRjX3N0YXRlLT5iYXNlLnN0YXRlKTsKPiArCQl0b19p
bnRlbF9hdG9taWNfc3RhdGUoY3J0Y19zdGF0ZS0+dWFwaS5zdGF0ZSk7Cj4gIAo+ICAJaWYgKCFp
bnRlbF9jcnRjX2hhc190eXBlKGNydGNfc3RhdGUsIElOVEVMX09VVFBVVF9EU0kpIHx8Cj4gIAkg
ICAgSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkgewo+IEBAIC0xMDYwOCw3ICsxMDYwOCw3IEBA
IHN0YXRpYyBpbnQgaW50ZWxfY2hlY2tfY3Vyc29yKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLAo+ICAJfQo+ICAKPiAgCXJldCA9IGRybV9hdG9taWNfaGVscGVyX2NoZWNrX3Bs
YW5lX3N0YXRlKCZwbGFuZV9zdGF0ZS0+YmFzZSwKPiAtCQkJCQkJICAmY3J0Y19zdGF0ZS0+YmFz
ZSwKPiArCQkJCQkJICAmY3J0Y19zdGF0ZS0+dWFwaSwKPiAgCQkJCQkJICBEUk1fUExBTkVfSEVM
UEVSX05PX1NDQUxJTkcsCj4gIAkJCQkJCSAgRFJNX1BMQU5FX0hFTFBFUl9OT19TQ0FMSU5HLAo+
ICAJCQkJCQkgIHRydWUsIHRydWUpOwo+IEBAIC0xMDc5MSw3ICsxMDc5MSw3IEBAIGk5eHhfY3Vy
c29yX21heF9zdHJpZGUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiAgCj4gIHN0YXRpYyB1
MzIgaTl4eF9jdXJzb3JfY3RsX2NydGMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0
YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0
b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCXUzMiBjbnRs
ID0gMDsKPiAgCj4gQEAgLTExMTk4LDEyICsxMTE5OCwxMiBAQCBpbnQgaW50ZWxfZ2V0X2xvYWRf
ZGV0ZWN0X3BpcGUoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwKPiAgCQlnb3RvIGZh
aWw7Cj4gIAl9Cj4gIAo+IC0JY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUgPSBjcnRjX3N0YXRlLT5i
YXNlLmVuYWJsZSA9IHRydWU7Cj4gKwljcnRjX3N0YXRlLT51YXBpLmFjdGl2ZSA9IGNydGNfc3Rh
dGUtPnVhcGkuZW5hYmxlID0gdHJ1ZTsKPiAgCj4gIAlpZiAoIW1vZGUpCj4gIAkJbW9kZSA9ICZs
b2FkX2RldGVjdF9tb2RlOwo+ICAKPiAtCXJldCA9IGRybV9hdG9taWNfc2V0X21vZGVfZm9yX2Ny
dGMoJmNydGNfc3RhdGUtPmJhc2UsIG1vZGUpOwo+ICsJcmV0ID0gZHJtX2F0b21pY19zZXRfbW9k
ZV9mb3JfY3J0YygmY3J0Y19zdGF0ZS0+dWFwaSwgbW9kZSk7Cj4gIAlpZiAocmV0KQo+ICAJCWdv
dG8gZmFpbDsKPiAgCj4gQEAgLTExNDExLDcgKzExNDExLDcgQEAgc3RhdGljIHZvaWQgaXJvbmxh
a2VfcGNoX2Nsb2NrX2dldChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgCSAqIHdlIG1heSBu
ZWVkIHNvbWUgaWRlYSBmb3IgdGhlIGRvdGNsb2NrIGFueXdheS4KPiAgCSAqIENhbGN1bGF0ZSBv
bmUgYmFzZWQgb24gdGhlIEZESSBjb25maWd1cmF0aW9uLgo+ICAJICovCj4gLQlwaXBlX2NvbmZp
Zy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2sgPQo+ICsJcGlwZV9jb25maWctPmh3LmFk
anVzdGVkX21vZGUuY3J0Y19jbG9jayA9Cj4gIAkJaW50ZWxfZG90Y2xvY2tfY2FsY3VsYXRlKGlu
dGVsX2ZkaV9saW5rX2ZyZXEoZGV2X3ByaXYsIHBpcGVfY29uZmlnKSwKPiAgCQkJCQkgJnBpcGVf
Y29uZmlnLT5mZGlfbV9uKTsKPiAgfQo+IEBAIC0xMTQ0MSw3ICsxMTQ0MSw3IEBAIGludGVsX2Vu
Y29kZXJfY3VycmVudF9tb2RlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ICAJCXJl
dHVybiBOVUxMOwo+ICAJfQo+ICAKPiAtCWNydGNfc3RhdGUtPmJhc2UuY3J0YyA9ICZjcnRjLT5i
YXNlOwo+ICsJY3J0Y19zdGF0ZS0+dWFwaS5jcnRjID0gJmNydGMtPmJhc2U7Cj4gIAo+ICAJaWYg
KCFkZXZfcHJpdi0+ZGlzcGxheS5nZXRfcGlwZV9jb25maWcoY3J0YywgY3J0Y19zdGF0ZSkpIHsK
PiAgCQlrZnJlZShjcnRjX3N0YXRlKTsKPiBAQCAtMTE1MTIsMTIgKzExNTEyLDEyIEBAIGludCBp
bnRlbF9wbGFuZV9hdG9taWNfY2FsY19jaGFuZ2VzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpvbGRfY3J0Y19zdGF0Cj4gIAkJCQkgICAgY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0
YXRlICpvbGRfcGxhbmVfc3RhdGUsCj4gIAkJCQkgICAgc3RydWN0IGludGVsX3BsYW5lX3N0YXRl
ICpwbGFuZV9zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBpbnRl
bF9wbGFuZSAqcGxhbmUgPSB0b19pbnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZSk7
Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJh
c2UuZGV2KTsKPiAgCWJvb2wgbW9kZV9jaGFuZ2VkID0gbmVlZHNfbW9kZXNldChjcnRjX3N0YXRl
KTsKPiAtCWJvb2wgd2FzX2NydGNfZW5hYmxlZCA9IG9sZF9jcnRjX3N0YXRlLT5iYXNlLmFjdGl2
ZTsKPiAtCWJvb2wgaXNfY3J0Y19lbmFibGVkID0gY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmU7Cj4g
Kwlib29sIHdhc19jcnRjX2VuYWJsZWQgPSBvbGRfY3J0Y19zdGF0ZS0+aHcuYWN0aXZlOwo+ICsJ
Ym9vbCBpc19jcnRjX2VuYWJsZWQgPSBjcnRjX3N0YXRlLT5ody5hY3RpdmU7Cj4gIAlib29sIHR1
cm5fb2ZmLCB0dXJuX29uLCB2aXNpYmxlLCB3YXNfdmlzaWJsZTsKPiAgCXN0cnVjdCBkcm1fZnJh
bWVidWZmZXIgKmZiID0gcGxhbmVfc3RhdGUtPmJhc2UuZmI7Cj4gIAlpbnQgcmV0Owo+IEBAIC0x
MTY5Miw5ICsxMTY5Miw5IEBAIHN0YXRpYyBpbnQgaWNsX2FkZF9saW5rZWRfcGxhbmVzKHN0cnVj
dCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAKPiAgc3RhdGljIGludCBpY2xfY2hlY2tf
bnYxMl9wbGFuZXMoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHsKPiAt
CXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNl
LmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAtCXN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUg
KnN0YXRlID0gdG9faW50ZWxfYXRvbWljX3N0YXRlKGNydGNfc3RhdGUtPmJhc2Uuc3RhdGUpOwo+
ICsJc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUgPSB0b19pbnRlbF9hdG9taWNfc3Rh
dGUoY3J0Y19zdGF0ZS0+dWFwaS5zdGF0ZSk7Cj4gIAlzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5l
LCAqbGlua2VkOwo+ICAJc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZTsKPiAg
CWludCBpOwo+IEBAIC0xMTc2NCw5ICsxMTc2NCw5IEBAIHN0YXRpYyBpbnQgaWNsX2NoZWNrX252
MTJfcGxhbmVzKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAKPiAgc3Rh
dGljIGJvb2wgYzhfcGxhbmVzX2NoYW5nZWQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
Km5ld19jcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMobmV3X2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YyA9IHRvX2ludGVsX2NydGMobmV3X2NydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlz
dHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSA9Cj4gLQkJdG9faW50ZWxfYXRvbWljX3N0
YXRlKG5ld19jcnRjX3N0YXRlLT5iYXNlLnN0YXRlKTsKPiArCQl0b19pbnRlbF9hdG9taWNfc3Rh
dGUobmV3X2NydGNfc3RhdGUtPnVhcGkuc3RhdGUpOwo+ICAJY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlID0KPiAgCQlpbnRlbF9hdG9taWNfZ2V0X29sZF9jcnRj
X3N0YXRlKHN0YXRlLCBjcnRjKTsKPiAgCj4gQEAgLTExNzg0LDEwICsxMTc4NCwxMCBAQCBzdGF0
aWMgaW50IGludGVsX2NydGNfYXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fY3J0YyAqX2NydGMsCj4g
IAlib29sIG1vZGVfY2hhbmdlZCA9IG5lZWRzX21vZGVzZXQoY3J0Y19zdGF0ZSk7Cj4gIAo+ICAJ
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA1ICYmICFJU19HNFgoZGV2X3ByaXYpICYmCj4gLQkg
ICAgbW9kZV9jaGFuZ2VkICYmICFjcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSkKPiArCSAgICBtb2Rl
X2NoYW5nZWQgJiYgIWNydGNfc3RhdGUtPmh3LmFjdGl2ZSkKPiAgCQljcnRjX3N0YXRlLT51cGRh
dGVfd21fcG9zdCA9IHRydWU7Cj4gIAo+IC0JaWYgKG1vZGVfY2hhbmdlZCAmJiBjcnRjX3N0YXRl
LT5iYXNlLmVuYWJsZSAmJgo+ICsJaWYgKG1vZGVfY2hhbmdlZCAmJiBjcnRjX3N0YXRlLT5ody5l
bmFibGUgJiYKPiAgCSAgICBkZXZfcHJpdi0+ZGlzcGxheS5jcnRjX2NvbXB1dGVfY2xvY2sgJiYK
PiAgCSAgICAhV0FSTl9PTihjcnRjX3N0YXRlLT5zaGFyZWRfZHBsbCkpIHsKPiAgCQlyZXQgPSBk
ZXZfcHJpdi0+ZGlzcGxheS5jcnRjX2NvbXB1dGVfY2xvY2soY3J0YywgY3J0Y19zdGF0ZSk7Cj4g
QEAgLTExODAwLDEwICsxMTgwMCwxMCBAQCBzdGF0aWMgaW50IGludGVsX2NydGNfYXRvbWljX2No
ZWNrKHN0cnVjdCBkcm1fY3J0YyAqX2NydGMsCj4gIAkgKiB3aGVuIEM4IHBsYW5lcyBhcmUgZ2V0
dGluZyBlbmFibGVkL2Rpc2FibGVkLgo+ICAJICovCj4gIAlpZiAoYzhfcGxhbmVzX2NoYW5nZWQo
Y3J0Y19zdGF0ZSkpCj4gLQkJY3J0Y19zdGF0ZS0+YmFzZS5jb2xvcl9tZ210X2NoYW5nZWQgPSB0
cnVlOwo+ICsJCWNydGNfc3RhdGUtPnVhcGkuY29sb3JfbWdtdF9jaGFuZ2VkID0gdHJ1ZTsKPiAg
Cj4gIAlpZiAobW9kZV9jaGFuZ2VkIHx8IGNydGNfc3RhdGUtPnVwZGF0ZV9waXBlIHx8Cj4gLQkg
ICAgY3J0Y19zdGF0ZS0+YmFzZS5jb2xvcl9tZ210X2NoYW5nZWQpIHsKPiArCSAgICBjcnRjX3N0
YXRlLT51YXBpLmNvbG9yX21nbXRfY2hhbmdlZCkgewo+ICAJCXJldCA9IGludGVsX2NvbG9yX2No
ZWNrKGNydGNfc3RhdGUpOwo+ICAJCWlmIChyZXQpCj4gIAkJCXJldHVybiByZXQ7Cj4gQEAgLTEx
OTI1LDcgKzExOTI1LDcgQEAgY29tcHV0ZV9iYXNlbGluZV9waXBlX2JwcChzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YywKPiAgCQkJICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcp
Cj4gIHsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwo+IC0Jc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0gcGlwZV9j
b25maWctPmJhc2Uuc3RhdGU7Cj4gKwlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUgPSBw
aXBlX2NvbmZpZy0+dWFwaS5zdGF0ZTsKPiAgCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0
b3I7Cj4gIAlzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubmVjdG9yX3N0YXRlOwo+ICAJ
aW50IGJwcCwgaTsKPiBAQCAtMTIwNzgsNyArMTIwNzgsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9k
dW1wX3BpcGVfY29uZmlnKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZp
ZywKPiAgCQkJCSAgIHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+ICAJCQkJICAg
Y29uc3QgY2hhciAqY29udGV4dCkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0
b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2Ny
dGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT51YXBpLmNydGMpOwo+ICAJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7
Cj4gIAljb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlOwo+ICAJc3Ry
dWN0IGludGVsX3BsYW5lICpwbGFuZTsKPiBAQCAtMTIwODcsMTQgKzEyMDg3LDE0IEBAIHN0YXRp
YyB2b2lkIGludGVsX2R1bXBfcGlwZV9jb25maWcoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKnBpcGVfY29uZmlnLAo+ICAKPiAgCURSTV9ERUJVR19LTVMoIltDUlRDOiVkOiVzXSBlbmFi
bGU6ICVzICVzXG4iLAo+ICAJCSAgICAgIGNydGMtPmJhc2UuYmFzZS5pZCwgY3J0Yy0+YmFzZS5u
YW1lLAo+IC0JCSAgICAgIHllc25vKHBpcGVfY29uZmlnLT5iYXNlLmVuYWJsZSksIGNvbnRleHQp
Owo+ICsJCSAgICAgIHllc25vKHBpcGVfY29uZmlnLT5ody5lbmFibGUpLCBjb250ZXh0KTsKPiAg
Cj4gLQlpZiAoIXBpcGVfY29uZmlnLT5iYXNlLmVuYWJsZSkKPiArCWlmICghcGlwZV9jb25maWct
Pmh3LmVuYWJsZSkKPiAgCQlnb3RvIGR1bXBfcGxhbmVzOwo+ICAKPiAgCXNucHJpbnRmX291dHB1
dF90eXBlcyhidWYsIHNpemVvZihidWYpLCBwaXBlX2NvbmZpZy0+b3V0cHV0X3R5cGVzKTsKPiAg
CURSTV9ERUJVR19LTVMoImFjdGl2ZTogJXMsIG91dHB1dF90eXBlczogJXMgKDB4JXgpLCBvdXRw
dXQgZm9ybWF0OiAlc1xuIiwKPiAtCQkgICAgICB5ZXNubyhwaXBlX2NvbmZpZy0+YmFzZS5hY3Rp
dmUpLAo+ICsJCSAgICAgIHllc25vKHBpcGVfY29uZmlnLT5ody5hY3RpdmUpLAo+ICAJCSAgICAg
IGJ1ZiwgcGlwZV9jb25maWctPm91dHB1dF90eXBlcywKPiAgCQkgICAgICBvdXRwdXRfZm9ybWF0
cyhwaXBlX2NvbmZpZy0+b3V0cHV0X2Zvcm1hdCkpOwo+ICAKPiBAQCAtMTIxMzQsMTAgKzEyMTM0
LDEwIEBAIHN0YXRpYyB2b2lkIGludGVsX2R1bXBfcGlwZV9jb25maWcoY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ICAJCWludGVsX2R1bXBfaW5mb2ZyYW1lKGRl
dl9wcml2LCAmcGlwZV9jb25maWctPmluZm9mcmFtZXMuaGRtaSk7Cj4gIAo+ICAJRFJNX0RFQlVH
X0tNUygicmVxdWVzdGVkIG1vZGU6XG4iKTsKPiAtCWRybV9tb2RlX2RlYnVnX3ByaW50bW9kZWxp
bmUoJnBpcGVfY29uZmlnLT5iYXNlLm1vZGUpOwo+ICsJZHJtX21vZGVfZGVidWdfcHJpbnRtb2Rl
bGluZSgmcGlwZV9jb25maWctPmh3Lm1vZGUpOwo+ICAJRFJNX0RFQlVHX0tNUygiYWRqdXN0ZWQg
bW9kZTpcbiIpOwo+IC0JZHJtX21vZGVfZGVidWdfcHJpbnRtb2RlbGluZSgmcGlwZV9jb25maWct
PmJhc2UuYWRqdXN0ZWRfbW9kZSk7Cj4gLQlpbnRlbF9kdW1wX2NydGNfdGltaW5ncygmcGlwZV9j
b25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZSk7Cj4gKwlkcm1fbW9kZV9kZWJ1Z19wcmludG1vZGVs
aW5lKCZwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZSk7Cj4gKwlpbnRlbF9kdW1wX2NydGNf
dGltaW5ncygmcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUpOwo+ICAJRFJNX0RFQlVHX0tN
UygicG9ydCBjbG9jazogJWQsIHBpcGUgc3JjIHNpemU6ICVkeCVkLCBwaXhlbCByYXRlICVkXG4i
LAo+ICAJCSAgICAgIHBpcGVfY29uZmlnLT5wb3J0X2Nsb2NrLAo+ICAJCSAgICAgIHBpcGVfY29u
ZmlnLT5waXBlX3NyY193LCBwaXBlX2NvbmZpZy0+cGlwZV9zcmNfaCwKPiBAQCAtMTIyNTUsNyAr
MTIyNTUsNyBAQCBzdGF0aWMgaW50Cj4gIGNsZWFyX2ludGVsX2NydGNfc3RhdGUoc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9Cj4gLQkJdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7
Cj4gKwkJdG9faTkxNShjcnRjX3N0YXRlLT51YXBpLmNydGMtPmRldik7Cj4gIAlzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqc2F2ZWRfc3RhdGU7Cj4gIAo+ICAJc2F2ZWRfc3RhdGUgPSBremFsbG9j
KHNpemVvZigqc2F2ZWRfc3RhdGUpLCBHRlBfS0VSTkVMKTsKPiBAQCAtMTIyNzgsOSArMTIyNzgs
MTAgQEAgY2xlYXJfaW50ZWxfY3J0Y19zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSkKPiAgCQlzYXZlZF9zdGF0ZS0+d20gPSBjcnRjX3N0YXRlLT53bTsKPiAgCj4gIAkv
KiBLZWVwIGJhc2UgZHJtX2NydGNfc3RhdGUgaW50YWN0LCBvbmx5IGNsZWFyIG91ciBleHRlbmRl
ZCBzdHJ1Y3QgKi8KPiAtCUJVSUxEX0JVR19PTihvZmZzZXRvZihzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSwgYmFzZSkpOwo+IC0JbWVtY3B5KCZjcnRjX3N0YXRlLT5iYXNlICsgMSwgJnNhdmVkX3N0
YXRlLT5iYXNlICsgMSwKPiAtCSAgICAgICBzaXplb2YoKmNydGNfc3RhdGUpIC0gc2l6ZW9mKGNy
dGNfc3RhdGUtPmJhc2UpKTsKPiArCUJVSUxEX0JVR19PTihvZmZzZXRvZihzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSwgdWFwaSkpOwo+ICsJQlVJTERfQlVHX09OKG9mZnNldG9mKHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlLCBodykpOwo+ICsJbWVtY3B5KCZjcnRjX3N0YXRlLT51YXBpICsgMSwgJnNh
dmVkX3N0YXRlLT51YXBpICsgMSwKPiArCSAgICAgICBzaXplb2YoKmNydGNfc3RhdGUpIC0gc2l6
ZW9mKGNydGNfc3RhdGUtPnVhcGkpKTsKPiAgCj4gIAlrZnJlZShzYXZlZF9zdGF0ZSk7Cj4gIAly
ZXR1cm4gMDsKPiBAQCAtMTIyODksOCArMTIyOTAsOCBAQCBjbGVhcl9pbnRlbF9jcnRjX3N0YXRl
KHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICBzdGF0aWMgaW50Cj4gIGlu
dGVsX21vZGVzZXRfcGlwZV9jb25maWcoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29u
ZmlnKQo+ICB7Cj4gLQlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSBwaXBlX2NvbmZpZy0+YmFzZS5j
cnRjOwo+IC0Jc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0gcGlwZV9jb25maWctPmJh
c2Uuc3RhdGU7Cj4gKwlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSBwaXBlX2NvbmZpZy0+dWFwaS5j
cnRjOwo+ICsJc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0gcGlwZV9jb25maWctPnVh
cGkuc3RhdGU7Cj4gIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcjsKPiAgCXN0cnVjdCBk
cm1fY29ubmVjdG9yICpjb25uZWN0b3I7Cj4gIAlzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAq
Y29ubmVjdG9yX3N0YXRlOwo+IEBAIC0xMjMxMCwxMyArMTIzMTEsMTMgQEAgaW50ZWxfbW9kZXNl
dF9waXBlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gIAkg
KiBwb3NpdGl2ZSBvciBuZWdhdGl2ZSBwb2xhcml0eSBpcyByZXF1ZXN0ZWQsIHRyZWF0IHRoaXMg
YXMgbWVhbmluZwo+ICAJICogbmVnYXRpdmUgcG9sYXJpdHkuCj4gIAkgKi8KPiAtCWlmICghKHBp
cGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuZmxhZ3MgJgo+ICsJaWYgKCEocGlwZV9jb25m
aWctPmh3LmFkanVzdGVkX21vZGUuZmxhZ3MgJgo+ICAJICAgICAgKERSTV9NT0RFX0ZMQUdfUEhT
WU5DIHwgRFJNX01PREVfRkxBR19OSFNZTkMpKSkKPiAtCQlwaXBlX2NvbmZpZy0+YmFzZS5hZGp1
c3RlZF9tb2RlLmZsYWdzIHw9IERSTV9NT0RFX0ZMQUdfTkhTWU5DOwo+ICsJCXBpcGVfY29uZmln
LT5ody5hZGp1c3RlZF9tb2RlLmZsYWdzIHw9IERSTV9NT0RFX0ZMQUdfTkhTWU5DOwo+ICAKPiAt
CWlmICghKHBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuZmxhZ3MgJgo+ICsJaWYgKCEo
cGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUuZmxhZ3MgJgo+ICAJICAgICAgKERSTV9NT0RF
X0ZMQUdfUFZTWU5DIHwgRFJNX01PREVfRkxBR19OVlNZTkMpKSkKPiAtCQlwaXBlX2NvbmZpZy0+
YmFzZS5hZGp1c3RlZF9tb2RlLmZsYWdzIHw9IERSTV9NT0RFX0ZMQUdfTlZTWU5DOwo+ICsJCXBp
cGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmZsYWdzIHw9IERSTV9NT0RFX0ZMQUdfTlZTWU5D
Owo+ICAKPiAgCXJldCA9IGNvbXB1dGVfYmFzZWxpbmVfcGlwZV9icHAodG9faW50ZWxfY3J0Yyhj
cnRjKSwKPiAgCQkJCQlwaXBlX2NvbmZpZyk7Cj4gQEAgLTEyMzMzLDcgKzEyMzM0LDcgQEAgaW50
ZWxfbW9kZXNldF9waXBlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25m
aWcpCj4gIAkgKiBjb21wdXRhdGlvbiB0byBjbGVhcmx5IGRpc3Rpbmd1aXNoIGl0IGZyb20gdGhl
IGFkanVzdGVkIG1vZGUsIHdoaWNoCj4gIAkgKiBjYW4gYmUgY2hhbmdlZCBieSB0aGUgY29ubmVj
dG9ycyBpbiB0aGUgYmVsb3cgcmV0cnkgbG9vcC4KPiAgCSAqLwo+IC0JZHJtX21vZGVfZ2V0X2h2
X3RpbWluZygmcGlwZV9jb25maWctPmJhc2UubW9kZSwKPiArCWRybV9tb2RlX2dldF9odl90aW1p
bmcoJnBpcGVfY29uZmlnLT5ody5tb2RlLAo+ICAJCQkgICAgICAgJnBpcGVfY29uZmlnLT5waXBl
X3NyY193LAo+ICAJCQkgICAgICAgJnBpcGVfY29uZmlnLT5waXBlX3NyY19oKTsKPiAgCj4gQEAg
LTEyMzY2LDcgKzEyMzY3LDcgQEAgaW50ZWxfbW9kZXNldF9waXBlX2NvbmZpZyhzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gIAlwaXBlX2NvbmZpZy0+cGl4ZWxfbXVsdGlw
bGllciA9IDE7Cj4gIAo+ICAJLyogRmlsbCBpbiBkZWZhdWx0IGNydGMgdGltaW5ncywgYWxsb3cg
ZW5jb2RlcnMgdG8gb3ZlcndyaXRlIHRoZW0uICovCj4gLQlkcm1fbW9kZV9zZXRfY3J0Y2luZm8o
JnBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUsCj4gKwlkcm1fbW9kZV9zZXRfY3J0Y2lu
Zm8oJnBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLAo+ICAJCQkgICAgICBDUlRDX1NURVJF
T19ET1VCTEUpOwo+ICAKPiAgCS8qIFBhc3Mgb3VyIG1vZGUgdG8gdGhlIGNvbm5lY3RvcnMgYW5k
IHRoZSBDUlRDIHRvIGdpdmUgdGhlbSBhIGNoYW5jZSB0bwo+IEBAIC0xMjM5MSw3ICsxMjM5Miw3
IEBAIGludGVsX21vZGVzZXRfcGlwZV9jb25maWcoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBp
cGVfY29uZmlnKQo+ICAJLyogU2V0IGRlZmF1bHQgcG9ydCBjbG9jayBpZiBub3Qgb3ZlcndyaXR0
ZW4gYnkgdGhlIGVuY29kZXIuIE5lZWRzIHRvIGJlCj4gIAkgKiBkb25lIGFmdGVyd2FyZHMgaW4g
Y2FzZSB0aGUgZW5jb2RlciBhZGp1c3RzIHRoZSBtb2RlLiAqLwo+ICAJaWYgKCFwaXBlX2NvbmZp
Zy0+cG9ydF9jbG9jaykKPiAtCQlwaXBlX2NvbmZpZy0+cG9ydF9jbG9jayA9IHBpcGVfY29uZmln
LT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19jbG9jawo+ICsJCXBpcGVfY29uZmlnLT5wb3J0X2Ns
b2NrID0gcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUuY3J0Y19jbG9jawo+ICAJCQkqIHBp
cGVfY29uZmlnLT5waXhlbF9tdWx0aXBsaWVyOwo+ICAKPiAgCXJldCA9IGludGVsX2NydGNfY29t
cHV0ZV9jb25maWcodG9faW50ZWxfY3J0YyhjcnRjKSwgcGlwZV9jb25maWcpOwo+IEBAIC0xMjU1
NSwxMiArMTI1NTYsMTIgQEAgaW50ZWxfcGlwZV9jb25maWdfY29tcGFyZShjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3VycmVudF9jb25maWcsCj4gIAkJCSAgY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ICAJCQkgIGJvb2wgZmFzdHNldCkKPiAgewo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjdXJyZW50X2Nv
bmZpZy0+YmFzZS5jcnRjLT5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShjdXJyZW50X2NvbmZpZy0+dWFwaS5jcnRjLT5kZXYpOwo+ICAJYm9vbCBy
ZXQgPSB0cnVlOwo+ICAJdTMyIGJwX2dhbW1hID0gMDsKPiAgCWJvb2wgZml4dXBfaW5oZXJpdGVk
ID0gZmFzdHNldCAmJgo+IC0JCShjdXJyZW50X2NvbmZpZy0+YmFzZS5tb2RlLnByaXZhdGVfZmxh
Z3MgJiBJOTE1X01PREVfRkxBR19JTkhFUklURUQpICYmCj4gLQkJIShwaXBlX2NvbmZpZy0+YmFz
ZS5tb2RlLnByaXZhdGVfZmxhZ3MgJiBJOTE1X01PREVfRkxBR19JTkhFUklURUQpOwo+ICsJCShj
dXJyZW50X2NvbmZpZy0+aHcubW9kZS5wcml2YXRlX2ZsYWdzICYgSTkxNV9NT0RFX0ZMQUdfSU5I
RVJJVEVEKSAmJgo+ICsJCSEocGlwZV9jb25maWctPmh3Lm1vZGUucHJpdmF0ZV9mbGFncyAmIEk5
MTVfTU9ERV9GTEFHX0lOSEVSSVRFRCk7Cj4gIAo+ICAJaWYgKGZpeHVwX2luaGVyaXRlZCAmJiAh
ZmFzdGJvb3RfZW5hYmxlZChkZXZfcHJpdikpIHsKPiAgCQlEUk1fREVCVUdfS01TKCJpbml0aWFs
IG1vZGVzZXQgYW5kIGZhc3Rib290IG5vdCBzZXRcbiIpOwo+IEBAIC0xMjc0OSwxOSArMTI3NTAs
MTkgQEAgaW50ZWxfcGlwZV9jb25maWdfY29tcGFyZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3VycmVudF9jb25maWcsCj4gIAo+ICAJUElQRV9DT05GX0NIRUNLX1gob3V0cHV0X3R5
cGVzKTsKPiAgCj4gLQlQSVBFX0NPTkZfQ0hFQ0tfSShiYXNlLmFkanVzdGVkX21vZGUuY3J0Y19o
ZGlzcGxheSk7Cj4gLQlQSVBFX0NPTkZfQ0hFQ0tfSShiYXNlLmFkanVzdGVkX21vZGUuY3J0Y19o
dG90YWwpOwo+IC0JUElQRV9DT05GX0NIRUNLX0koYmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfaGJs
YW5rX3N0YXJ0KTsKPiAtCVBJUEVfQ09ORl9DSEVDS19JKGJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRj
X2hibGFua19lbmQpOwo+IC0JUElQRV9DT05GX0NIRUNLX0koYmFzZS5hZGp1c3RlZF9tb2RlLmNy
dGNfaHN5bmNfc3RhcnQpOwo+IC0JUElQRV9DT05GX0NIRUNLX0koYmFzZS5hZGp1c3RlZF9tb2Rl
LmNydGNfaHN5bmNfZW5kKTsKPiArCVBJUEVfQ09ORl9DSEVDS19JKGh3LmFkanVzdGVkX21vZGUu
Y3J0Y19oZGlzcGxheSk7Cj4gKwlQSVBFX0NPTkZfQ0hFQ0tfSShody5hZGp1c3RlZF9tb2RlLmNy
dGNfaHRvdGFsKTsKPiArCVBJUEVfQ09ORl9DSEVDS19JKGh3LmFkanVzdGVkX21vZGUuY3J0Y19o
Ymxhbmtfc3RhcnQpOwo+ICsJUElQRV9DT05GX0NIRUNLX0koaHcuYWRqdXN0ZWRfbW9kZS5jcnRj
X2hibGFua19lbmQpOwo+ICsJUElQRV9DT05GX0NIRUNLX0koaHcuYWRqdXN0ZWRfbW9kZS5jcnRj
X2hzeW5jX3N0YXJ0KTsKPiArCVBJUEVfQ09ORl9DSEVDS19JKGh3LmFkanVzdGVkX21vZGUuY3J0
Y19oc3luY19lbmQpOwo+ICAKPiAtCVBJUEVfQ09ORl9DSEVDS19JKGJhc2UuYWRqdXN0ZWRfbW9k
ZS5jcnRjX3ZkaXNwbGF5KTsKPiAtCVBJUEVfQ09ORl9DSEVDS19JKGJhc2UuYWRqdXN0ZWRfbW9k
ZS5jcnRjX3Z0b3RhbCk7Cj4gLQlQSVBFX0NPTkZfQ0hFQ0tfSShiYXNlLmFkanVzdGVkX21vZGUu
Y3J0Y192Ymxhbmtfc3RhcnQpOwo+IC0JUElQRV9DT05GX0NIRUNLX0koYmFzZS5hZGp1c3RlZF9t
b2RlLmNydGNfdmJsYW5rX2VuZCk7Cj4gLQlQSVBFX0NPTkZfQ0hFQ0tfSShiYXNlLmFkanVzdGVk
X21vZGUuY3J0Y192c3luY19zdGFydCk7Cj4gLQlQSVBFX0NPTkZfQ0hFQ0tfSShiYXNlLmFkanVz
dGVkX21vZGUuY3J0Y192c3luY19lbmQpOwo+ICsJUElQRV9DT05GX0NIRUNLX0koaHcuYWRqdXN0
ZWRfbW9kZS5jcnRjX3ZkaXNwbGF5KTsKPiArCVBJUEVfQ09ORl9DSEVDS19JKGh3LmFkanVzdGVk
X21vZGUuY3J0Y192dG90YWwpOwo+ICsJUElQRV9DT05GX0NIRUNLX0koaHcuYWRqdXN0ZWRfbW9k
ZS5jcnRjX3ZibGFua19zdGFydCk7Cj4gKwlQSVBFX0NPTkZfQ0hFQ0tfSShody5hZGp1c3RlZF9t
b2RlLmNydGNfdmJsYW5rX2VuZCk7Cj4gKwlQSVBFX0NPTkZfQ0hFQ0tfSShody5hZGp1c3RlZF9t
b2RlLmNydGNfdnN5bmNfc3RhcnQpOwo+ICsJUElQRV9DT05GX0NIRUNLX0koaHcuYWRqdXN0ZWRf
bW9kZS5jcnRjX3ZzeW5jX2VuZCk7Cj4gIAo+ICAJUElQRV9DT05GX0NIRUNLX0kocGl4ZWxfbXVs
dGlwbGllcik7Cj4gIAlQSVBFX0NPTkZfQ0hFQ0tfSShvdXRwdXRfZm9ybWF0KTsKPiBAQCAtMTI3
NzcsMTcgKzEyNzc4LDE3IEBAIGludGVsX3BpcGVfY29uZmlnX2NvbXBhcmUoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmN1cnJlbnRfY29uZmlnLAo+ICAKPiAgCVBJUEVfQ09ORl9DSEVD
S19CT09MX0lOQ09NUExFVEUoaGFzX2F1ZGlvKTsKPiAgCj4gLQlQSVBFX0NPTkZfQ0hFQ0tfRkxB
R1MoYmFzZS5hZGp1c3RlZF9tb2RlLmZsYWdzLAo+ICsJUElQRV9DT05GX0NIRUNLX0ZMQUdTKGh3
LmFkanVzdGVkX21vZGUuZmxhZ3MsCj4gIAkJCSAgICAgIERSTV9NT0RFX0ZMQUdfSU5URVJMQUNF
KTsKPiAgCj4gIAlpZiAoIVBJUEVfQ09ORl9RVUlSSyhQSVBFX0NPTkZJR19RVUlSS19NT0RFX1NZ
TkNfRkxBR1MpKSB7Cj4gLQkJUElQRV9DT05GX0NIRUNLX0ZMQUdTKGJhc2UuYWRqdXN0ZWRfbW9k
ZS5mbGFncywKPiArCQlQSVBFX0NPTkZfQ0hFQ0tfRkxBR1MoaHcuYWRqdXN0ZWRfbW9kZS5mbGFn
cywKPiAgCQkJCSAgICAgIERSTV9NT0RFX0ZMQUdfUEhTWU5DKTsKPiAtCQlQSVBFX0NPTkZfQ0hF
Q0tfRkxBR1MoYmFzZS5hZGp1c3RlZF9tb2RlLmZsYWdzLAo+ICsJCVBJUEVfQ09ORl9DSEVDS19G
TEFHUyhody5hZGp1c3RlZF9tb2RlLmZsYWdzLAo+ICAJCQkJICAgICAgRFJNX01PREVfRkxBR19O
SFNZTkMpOwo+IC0JCVBJUEVfQ09ORl9DSEVDS19GTEFHUyhiYXNlLmFkanVzdGVkX21vZGUuZmxh
Z3MsCj4gKwkJUElQRV9DT05GX0NIRUNLX0ZMQUdTKGh3LmFkanVzdGVkX21vZGUuZmxhZ3MsCj4g
IAkJCQkgICAgICBEUk1fTU9ERV9GTEFHX1BWU1lOQyk7Cj4gLQkJUElQRV9DT05GX0NIRUNLX0ZM
QUdTKGJhc2UuYWRqdXN0ZWRfbW9kZS5mbGFncywKPiArCQlQSVBFX0NPTkZfQ0hFQ0tfRkxBR1Mo
aHcuYWRqdXN0ZWRfbW9kZS5mbGFncywKPiAgCQkJCSAgICAgIERSTV9NT0RFX0ZMQUdfTlZTWU5D
KTsKPiAgCX0KPiAgCj4gQEAgLTEyODI2LDcgKzEyODI3LDcgQEAgaW50ZWxfcGlwZV9jb25maWdf
Y29tcGFyZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3VycmVudF9jb25maWcsCj4g
IAo+ICAJCWJwX2dhbW1hID0gaW50ZWxfY29sb3JfZ2V0X2dhbW1hX2JpdF9wcmVjaXNpb24ocGlw
ZV9jb25maWcpOwo+ICAJCWlmIChicF9nYW1tYSkKPiAtCQkJUElQRV9DT05GX0NIRUNLX0NPTE9S
X0xVVChnYW1tYV9tb2RlLCBiYXNlLmdhbW1hX2x1dCwgYnBfZ2FtbWEpOwo+ICsJCQlQSVBFX0NP
TkZfQ0hFQ0tfQ09MT1JfTFVUKGdhbW1hX21vZGUsIHVhcGkuZ2FtbWFfbHV0LCBicF9nYW1tYSk7
Cj4gIAo+ICAJfQo+ICAKPiBAQCAtMTI4NzEsNyArMTI4NzIsNyBAQCBpbnRlbF9waXBlX2NvbmZp
Z19jb21wYXJlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjdXJyZW50X2NvbmZpZywK
PiAgCWlmIChJU19HNFgoZGV2X3ByaXYpIHx8IElOVEVMX0dFTihkZXZfcHJpdikgPj0gNSkKPiAg
CQlQSVBFX0NPTkZfQ0hFQ0tfSShwaXBlX2JwcCk7Cj4gIAo+IC0JUElQRV9DT05GX0NIRUNLX0NM
T0NLX0ZVWlpZKGJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrKTsKPiArCVBJUEVfQ09ORl9D
SEVDS19DTE9DS19GVVpaWShody5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2spOwo+ICAJUElQRV9D
T05GX0NIRUNLX0NMT0NLX0ZVWlpZKHBvcnRfY2xvY2spOwo+ICAKPiAgCVBJUEVfQ09ORl9DSEVD
S19JKG1pbl92b2x0YWdlX2xldmVsKTsKPiBAQCAtMTI5MDIsNyArMTI5MDMsNyBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9waXBlX2NvbmZpZ19zYW5pdHlfY2hlY2soc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ICAJaWYgKHBpcGVfY29uZmlnLT5oYXNfcGNoX2VuY29kZXIpIHsKPiAg
CQlpbnQgZmRpX2RvdGNsb2NrID0gaW50ZWxfZG90Y2xvY2tfY2FsY3VsYXRlKGludGVsX2ZkaV9s
aW5rX2ZyZXEoZGV2X3ByaXYsIHBpcGVfY29uZmlnKSwKPiAgCQkJCQkJCSAgICAmcGlwZV9jb25m
aWctPmZkaV9tX24pOwo+IC0JCWludCBkb3RjbG9jayA9IHBpcGVfY29uZmlnLT5iYXNlLmFkanVz
dGVkX21vZGUuY3J0Y19jbG9jazsKPiArCQlpbnQgZG90Y2xvY2sgPSBwaXBlX2NvbmZpZy0+aHcu
YWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrOwo+ICAKPiAgCQkvKgo+ICAJCSAqIEZESSBhbHJlYWR5
IHByb3ZpZGVkIG9uZSBpZGVhIGZvciB0aGUgZG90Y2xvY2suCj4gQEAgLTEyOTMwLDcgKzEyOTMx
LDcgQEAgc3RhdGljIHZvaWQgdmVyaWZ5X3dtX3N0YXRlKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
LAo+ICAJY29uc3QgZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAJaW50IHBsYW5lLCBs
ZXZlbCwgbWF4X2xldmVsID0gaWxrX3dtX21heF9sZXZlbChkZXZfcHJpdik7Cj4gIAo+IC0JaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPCA5IHx8ICFuZXdfY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUp
Cj4gKwlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDkgfHwgIW5ld19jcnRjX3N0YXRlLT5ody5h
Y3RpdmUpCj4gIAkJcmV0dXJuOwo+ICAKPiAgCWh3ID0ga3phbGxvYyhzaXplb2YoKmh3KSwgR0ZQ
X0tFUk5FTCk7Cj4gQEAgLTEzMTM5LDEyICsxMzE0MCwxMiBAQCB2ZXJpZnlfY3J0Y19zdGF0ZShz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0
ZTsKPiAgCWJvb2wgYWN0aXZlOwo+ICAKPiAtCXN0YXRlID0gb2xkX2NydGNfc3RhdGUtPmJhc2Uu
c3RhdGU7Cj4gLQlfX2RybV9hdG9taWNfaGVscGVyX2NydGNfZGVzdHJveV9zdGF0ZSgmb2xkX2Ny
dGNfc3RhdGUtPmJhc2UpOwo+ICsJc3RhdGUgPSBvbGRfY3J0Y19zdGF0ZS0+dWFwaS5zdGF0ZTsK
PiArCV9fZHJtX2F0b21pY19oZWxwZXJfY3J0Y19kZXN0cm95X3N0YXRlKCZvbGRfY3J0Y19zdGF0
ZS0+dWFwaSk7Cj4gIAlwaXBlX2NvbmZpZyA9IG9sZF9jcnRjX3N0YXRlOwo+ICAJbWVtc2V0KHBp
cGVfY29uZmlnLCAwLCBzaXplb2YoKnBpcGVfY29uZmlnKSk7Cj4gLQlwaXBlX2NvbmZpZy0+YmFz
ZS5jcnRjID0gJmNydGMtPmJhc2U7Cj4gLQlwaXBlX2NvbmZpZy0+YmFzZS5zdGF0ZSA9IHN0YXRl
Owo+ICsJcGlwZV9jb25maWctPnVhcGkuY3J0YyA9ICZjcnRjLT5iYXNlOwo+ICsJcGlwZV9jb25m
aWctPnVhcGkuc3RhdGUgPSBzdGF0ZTsKPiAgCj4gIAlEUk1fREVCVUdfS01TKCJbQ1JUQzolZDol
c11cbiIsIGNydGMtPmJhc2UuYmFzZS5pZCwgY3J0Yy0+YmFzZS5uYW1lKTsKPiAgCj4gQEAgLTEz
MTUyLDIzICsxMzE1MywyNiBAQCB2ZXJpZnlfY3J0Y19zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YywKPiAgCj4gIAkvKiB3ZSBrZWVwIGJvdGggcGlwZXMgZW5hYmxlZCBvbiA4MzAgKi8KPiAg
CWlmIChJU19JODMwKGRldl9wcml2KSkKPiAtCQlhY3RpdmUgPSBuZXdfY3J0Y19zdGF0ZS0+YmFz
ZS5hY3RpdmU7Cj4gKwkJYWN0aXZlID0gbmV3X2NydGNfc3RhdGUtPmh3LmFjdGl2ZTsKPiAgCj4g
LQlJOTE1X1NUQVRFX1dBUk4obmV3X2NydGNfc3RhdGUtPmJhc2UuYWN0aXZlICE9IGFjdGl2ZSwK
PiAtCSAgICAgImNydGMgYWN0aXZlIHN0YXRlIGRvZXNuJ3QgbWF0Y2ggd2l0aCBodyBzdGF0ZSAi
Cj4gLQkgICAgICIoZXhwZWN0ZWQgJWksIGZvdW5kICVpKVxuIiwgbmV3X2NydGNfc3RhdGUtPmJh
c2UuYWN0aXZlLCBhY3RpdmUpOwo+ICsJSTkxNV9TVEFURV9XQVJOKG5ld19jcnRjX3N0YXRlLT5o
dy5hY3RpdmUgIT0gYWN0aXZlLAo+ICsJCQkiY3J0YyBhY3RpdmUgc3RhdGUgZG9lc24ndCBtYXRj
aCB3aXRoIGh3IHN0YXRlICIKPiArCQkJIihleHBlY3RlZCAlaSwgZm91bmQgJWkpXG4iLAo+ICsJ
CQluZXdfY3J0Y19zdGF0ZS0+aHcuYWN0aXZlLCBhY3RpdmUpOwo+ICAKPiAtCUk5MTVfU1RBVEVf
V0FSTihjcnRjLT5hY3RpdmUgIT0gbmV3X2NydGNfc3RhdGUtPmJhc2UuYWN0aXZlLAo+IC0JICAg
ICAidHJhbnNpdGlvbmFsIGFjdGl2ZSBzdGF0ZSBkb2VzIG5vdCBtYXRjaCBhdG9taWMgaHcgc3Rh
dGUgIgo+IC0JICAgICAiKGV4cGVjdGVkICVpLCBmb3VuZCAlaSlcbiIsIG5ld19jcnRjX3N0YXRl
LT5iYXNlLmFjdGl2ZSwgY3J0Yy0+YWN0aXZlKTsKPiArCUk5MTVfU1RBVEVfV0FSTihjcnRjLT5h
Y3RpdmUgIT0gbmV3X2NydGNfc3RhdGUtPmh3LmFjdGl2ZSwKPiArCQkJInRyYW5zaXRpb25hbCBh
Y3RpdmUgc3RhdGUgZG9lcyBub3QgbWF0Y2ggYXRvbWljIGh3IHN0YXRlICIKPiArCQkJIihleHBl
Y3RlZCAlaSwgZm91bmQgJWkpXG4iLAo+ICsJCQluZXdfY3J0Y19zdGF0ZS0+aHcuYWN0aXZlLCBj
cnRjLT5hY3RpdmUpOwo+ICAKPiAgCWZvcl9lYWNoX2VuY29kZXJfb25fY3J0YyhkZXYsICZjcnRj
LT5iYXNlLCBlbmNvZGVyKSB7Cj4gIAkJZW51bSBwaXBlIHBpcGU7Cj4gIAo+ICAJCWFjdGl2ZSA9
IGVuY29kZXItPmdldF9od19zdGF0ZShlbmNvZGVyLCAmcGlwZSk7Cj4gLQkJSTkxNV9TVEFURV9X
QVJOKGFjdGl2ZSAhPSBuZXdfY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUsCj4gLQkJCSJbRU5DT0RF
UjolaV0gYWN0aXZlICVpIHdpdGggY3J0YyBhY3RpdmUgJWlcbiIsCj4gLQkJCWVuY29kZXItPmJh
c2UuYmFzZS5pZCwgYWN0aXZlLCBuZXdfY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUpOwo+ICsJCUk5
MTVfU1RBVEVfV0FSTihhY3RpdmUgIT0gbmV3X2NydGNfc3RhdGUtPmh3LmFjdGl2ZSwKPiArCQkJ
CSJbRU5DT0RFUjolaV0gYWN0aXZlICVpIHdpdGggY3J0YyBhY3RpdmUgJWlcbiIsCj4gKwkJCQll
bmNvZGVyLT5iYXNlLmJhc2UuaWQsIGFjdGl2ZSwKPiArCQkJCW5ld19jcnRjX3N0YXRlLT5ody5h
Y3RpdmUpOwo+ICAKPiAgCQlJOTE1X1NUQVRFX1dBUk4oYWN0aXZlICYmIGNydGMtPnBpcGUgIT0g
cGlwZSwKPiAgCQkJCSJFbmNvZGVyIGNvbm5lY3RlZCB0byB3cm9uZyBwaXBlICVjXG4iLAo+IEBA
IC0xMzE4MCw3ICsxMzE4NCw3IEBAIHZlcmlmeV9jcnRjX3N0YXRlKHN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjLAo+ICAKPiAgCWludGVsX2NydGNfY29tcHV0ZV9waXhlbF9yYXRlKHBpcGVfY29uZmln
KTsKPiAgCj4gLQlpZiAoIW5ld19jcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSkKPiArCWlmICghbmV3
X2NydGNfc3RhdGUtPmh3LmFjdGl2ZSkKPiAgCQlyZXR1cm47Cj4gIAo+ICAJaW50ZWxfcGlwZV9j
b25maWdfc2FuaXR5X2NoZWNrKGRldl9wcml2LCBwaXBlX2NvbmZpZyk7Cj4gQEAgLTEzMjQyLDcg
KzEzMjQ2LDcgQEAgdmVyaWZ5X3NpbmdsZV9kcGxsX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiAgCj4gIAljcnRjX21hc2sgPSBkcm1fY3J0Y19tYXNrKCZjcnRjLT5i
YXNlKTsKPiAgCj4gLQlpZiAobmV3X2NydGNfc3RhdGUtPmJhc2UuYWN0aXZlKQo+ICsJaWYgKG5l
d19jcnRjX3N0YXRlLT5ody5hY3RpdmUpCj4gIAkJSTkxNV9TVEFURV9XQVJOKCEocGxsLT5hY3Rp
dmVfbWFzayAmIGNydGNfbWFzayksCj4gIAkJCQkicGxsIGFjdGl2ZSBtaXNtYXRjaCAoZXhwZWN0
ZWQgcGlwZSAlYyBpbiBhY3RpdmUgbWFzayAweCUwMngpXG4iLAo+ICAJCQkJcGlwZV9uYW1lKGRy
bV9jcnRjX2luZGV4KCZjcnRjLT5iYXNlKSksIHBsbC0+YWN0aXZlX21hc2spOwo+IEBAIC0xMzMy
MCw3ICsxMzMyNCw3IEBAIGludGVsX21vZGVzZXRfdmVyaWZ5X2Rpc2FibGVkKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgCj4gIHN0YXRpYyB2b2lkIHVwZGF0ZV9zY2FubGlu
ZV9vZmZzZXQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHsK
PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5i
YXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNy
dGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCj4gIAkvKgo+IEBAIC0xMzM1MSw3ICsx
MzM1NSw3IEBAIHN0YXRpYyB2b2lkIHVwZGF0ZV9zY2FubGluZV9vZmZzZXQoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIAkgKiBhbnN3ZXIgdGhhdCdzIHNsaWdo
dGx5IGluIHRoZSBmdXR1cmUuCj4gIAkgKi8KPiAgCWlmIChJU19HRU4oZGV2X3ByaXYsIDIpKSB7
Cj4gLQkJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmY3J0
Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICsJCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxh
eV9tb2RlICphZGp1c3RlZF9tb2RlID0gJmNydGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGU7Cj4g
IAkJaW50IHZ0b3RhbDsKPiAgCj4gIAkJdnRvdGFsID0gYWRqdXN0ZWRfbW9kZS0+Y3J0Y192dG90
YWw7Cj4gQEAgLTEzNDAxLDcgKzEzNDA1LDcgQEAgc3RhdGljIGludCBoYXN3ZWxsX21vZGVfc2V0
X3BsYW5lc193b3JrYXJvdW5kKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAK
PiAgCS8qIGxvb2sgYXQgYWxsIGNydGMncyB0aGF0IGFyZSBnb2luZyB0byBiZSBlbmFibGVkIGlu
IGR1cmluZyBtb2Rlc2V0ICovCj4gIAlmb3JfZWFjaF9uZXdfaW50ZWxfY3J0Y19pbl9zdGF0ZShz
dGF0ZSwgY3J0YywgY3J0Y19zdGF0ZSwgaSkgewo+IC0JCWlmICghY3J0Y19zdGF0ZS0+YmFzZS5h
Y3RpdmUgfHwKPiArCQlpZiAoIWNydGNfc3RhdGUtPmh3LmFjdGl2ZSB8fAo+ICAJCSAgICAhbmVl
ZHNfbW9kZXNldChjcnRjX3N0YXRlKSkKPiAgCQkJY29udGludWU7Cj4gIAo+IEBAIC0xMzQyNiw3
ICsxMzQzMCw3IEBAIHN0YXRpYyBpbnQgaGFzd2VsbF9tb2RlX3NldF9wbGFuZXNfd29ya2Fyb3Vu
ZChzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgCj4gIAkJY3J0Y19zdGF0ZS0+
aHN3X3dvcmthcm91bmRfcGlwZSA9IElOVkFMSURfUElQRTsKPiAgCj4gLQkJaWYgKCFjcnRjX3N0
YXRlLT5iYXNlLmFjdGl2ZSB8fAo+ICsJCWlmICghY3J0Y19zdGF0ZS0+aHcuYWN0aXZlIHx8Cj4g
IAkJICAgIG5lZWRzX21vZGVzZXQoY3J0Y19zdGF0ZSkpCj4gIAkJCWNvbnRpbnVlOwo+ICAKPiBA
QCAtMTM0NjksMTIgKzEzNDczLDEyIEBAIHN0YXRpYyBpbnQgaW50ZWxfbW9kZXNldF9jaGVja3Mo
c3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gIAo+ICAJZm9yX2VhY2hfb2xkbmV3
X2ludGVsX2NydGNfaW5fc3RhdGUoc3RhdGUsIGNydGMsIG9sZF9jcnRjX3N0YXRlLAo+ICAJCQkJ
CSAgICBuZXdfY3J0Y19zdGF0ZSwgaSkgewo+IC0JCWlmIChuZXdfY3J0Y19zdGF0ZS0+YmFzZS5h
Y3RpdmUpCj4gKwkJaWYgKG5ld19jcnRjX3N0YXRlLT5ody5hY3RpdmUpCj4gIAkJCXN0YXRlLT5h
Y3RpdmVfcGlwZXMgfD0gQklUKGNydGMtPnBpcGUpOwo+ICAJCWVsc2UKPiAgCQkJc3RhdGUtPmFj
dGl2ZV9waXBlcyAmPSB+QklUKGNydGMtPnBpcGUpOwo+ICAKPiAtCQlpZiAob2xkX2NydGNfc3Rh
dGUtPmJhc2UuYWN0aXZlICE9IG5ld19jcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSkKPiArCQlpZiAo
b2xkX2NydGNfc3RhdGUtPmh3LmFjdGl2ZSAhPSBuZXdfY3J0Y19zdGF0ZS0+aHcuYWN0aXZlKQo+
ICAJCQlzdGF0ZS0+YWN0aXZlX3BpcGVfY2hhbmdlcyB8PSBCSVQoY3J0Yy0+cGlwZSk7Cj4gIAl9
Cj4gIAo+IEBAIC0xMzUxMyw3ICsxMzUxNyw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2NydGNfY2hl
Y2tfZmFzdHNldChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhCj4g
IAlpZiAoIWludGVsX3BpcGVfY29uZmlnX2NvbXBhcmUob2xkX2NydGNfc3RhdGUsIG5ld19jcnRj
X3N0YXRlLCB0cnVlKSkKPiAgCQlyZXR1cm47Cj4gIAo+IC0JbmV3X2NydGNfc3RhdGUtPmJhc2Uu
bW9kZV9jaGFuZ2VkID0gZmFsc2U7Cj4gKwluZXdfY3J0Y19zdGF0ZS0+dWFwaS5tb2RlX2NoYW5n
ZWQgPSBmYWxzZTsKPiAgCW5ld19jcnRjX3N0YXRlLT51cGRhdGVfcGlwZSA9IHRydWU7Cj4gIAo+
ICAJLyoKPiBAQCAtMTM1NDgsOSArMTM1NTIsOSBAQCBzdGF0aWMgaW50IGludGVsX2F0b21pY19j
aGVjayhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ICAJLyogQ2F0Y2ggSTkxNV9NT0RFX0ZMQUdf
SU5IRVJJVEVEICovCj4gIAlmb3JfZWFjaF9vbGRuZXdfaW50ZWxfY3J0Y19pbl9zdGF0ZShzdGF0
ZSwgY3J0Yywgb2xkX2NydGNfc3RhdGUsCj4gIAkJCQkJICAgIG5ld19jcnRjX3N0YXRlLCBpKSB7
Cj4gLQkJaWYgKG5ld19jcnRjX3N0YXRlLT5iYXNlLm1vZGUucHJpdmF0ZV9mbGFncyAhPQo+IC0J
CSAgICBvbGRfY3J0Y19zdGF0ZS0+YmFzZS5tb2RlLnByaXZhdGVfZmxhZ3MpCj4gLQkJCW5ld19j
cnRjX3N0YXRlLT5iYXNlLm1vZGVfY2hhbmdlZCA9IHRydWU7Cj4gKwkJaWYgKG5ld19jcnRjX3N0
YXRlLT5ody5tb2RlLnByaXZhdGVfZmxhZ3MgIT0KPiArCQkgICAgb2xkX2NydGNfc3RhdGUtPmh3
Lm1vZGUucHJpdmF0ZV9mbGFncykKPiArCQkJbmV3X2NydGNfc3RhdGUtPnVhcGkubW9kZV9jaGFu
Z2VkID0gdHJ1ZTsKPiAgCX0KPiAgCj4gIAlyZXQgPSBkcm1fYXRvbWljX2hlbHBlcl9jaGVja19t
b2Rlc2V0KGRldiwgJnN0YXRlLT5iYXNlKTsKPiBAQCAtMTM1NjIsNyArMTM1NjYsNyBAQCBzdGF0
aWMgaW50IGludGVsX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ICAJCWlm
ICghbmVlZHNfbW9kZXNldChuZXdfY3J0Y19zdGF0ZSkpCj4gIAkJCWNvbnRpbnVlOwo+ICAKPiAt
CQlpZiAoIW5ld19jcnRjX3N0YXRlLT5iYXNlLmVuYWJsZSkgewo+ICsJCWlmICghbmV3X2NydGNf
c3RhdGUtPnVhcGkuZW5hYmxlKSB7Cj4gIAkJCWFueV9tcyA9IHRydWU7Cj4gIAkJCWNvbnRpbnVl
Owo+ICAJCX0KPiBAQCAtMTM3MTksMTEgKzEzNzIzLDEwIEBAIHN0YXRpYyB2b2lkIGludGVsX29s
ZF9jcnRjX3N0YXRlX2Rpc2FibGVzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+
ICAJaW50ZWxfY2hlY2tfcGNoX2ZpZm9fdW5kZXJydW5zKGRldl9wcml2KTsKPiAgCj4gIAkvKiBG
SVhNRSB1bmlmeSB0aGlzIGZvciBhbGwgcGxhdGZvcm1zICovCj4gLQlpZiAoIW5ld19jcnRjX3N0
YXRlLT5iYXNlLmFjdGl2ZSAmJgo+ICsJaWYgKCFuZXdfY3J0Y19zdGF0ZS0+aHcuYWN0aXZlICYm
Cj4gIAkgICAgIUhBU19HTUNIKGRldl9wcml2KSAmJgo+ICAJICAgIGRldl9wcml2LT5kaXNwbGF5
LmluaXRpYWxfd2F0ZXJtYXJrcykKPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5pbml0aWFsX3dhdGVy
bWFya3Moc3RhdGUsCj4gLQkJCQkJCSAgICAgbmV3X2NydGNfc3RhdGUpOwo+ICsJCWRldl9wcml2
LT5kaXNwbGF5LmluaXRpYWxfd2F0ZXJtYXJrcyhzdGF0ZSwgbmV3X2NydGNfc3RhdGUpOwo+ICB9
Cj4gIAo+ICBzdGF0aWMgdm9pZCBpbnRlbF9jb21taXRfbW9kZXNldF9kaXNhYmxlcyhzdHJ1Y3Qg
aW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiBAQCAtMTM3NDYsNyArMTM3NDksNyBAQCBzdGF0
aWMgdm9pZCBpbnRlbF9jb21taXRfbW9kZXNldF9kaXNhYmxlcyhzdHJ1Y3QgaW50ZWxfYXRvbWlj
X3N0YXRlICpzdGF0ZSkKPiAgCj4gIAkJaW50ZWxfcHJlX3BsYW5lX3VwZGF0ZShvbGRfY3J0Y19z
dGF0ZSwgbmV3X2NydGNfc3RhdGUpOwo+ICAKPiAtCQlpZiAob2xkX2NydGNfc3RhdGUtPmJhc2Uu
YWN0aXZlKQo+ICsJCWlmIChvbGRfY3J0Y19zdGF0ZS0+aHcuYWN0aXZlKQo+ICAJCQlpbnRlbF9v
bGRfY3J0Y19zdGF0ZV9kaXNhYmxlcyhzdGF0ZSwKPiAgCQkJCQkJICAgICAgb2xkX2NydGNfc3Rh
dGUsCj4gIAkJCQkJCSAgICAgIG5ld19jcnRjX3N0YXRlLAo+IEBAIC0xMzc2MSw3ICsxMzc2NCw3
IEBAIHN0YXRpYyB2b2lkIGludGVsX2NvbW1pdF9tb2Rlc2V0X2VuYWJsZXMoc3RydWN0IGludGVs
X2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gIAlpbnQgaTsKPiAgCj4gIAlmb3JfZWFjaF9vbGRuZXdf
aW50ZWxfY3J0Y19pbl9zdGF0ZShzdGF0ZSwgY3J0Yywgb2xkX2NydGNfc3RhdGUsIG5ld19jcnRj
X3N0YXRlLCBpKSB7Cj4gLQkJaWYgKCFuZXdfY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUpCj4gKwkJ
aWYgKCFuZXdfY3J0Y19zdGF0ZS0+aHcuYWN0aXZlKQo+ICAJCQljb250aW51ZTsKPiAgCj4gIAkJ
aW50ZWxfdXBkYXRlX2NydGMoY3J0Yywgc3RhdGUsIG9sZF9jcnRjX3N0YXRlLAo+IEBAIC0xMzc4
NCw3ICsxMzc4Nyw3IEBAIHN0YXRpYyB2b2lkIHNrbF9jb21taXRfbW9kZXNldF9lbmFibGVzKHN0
cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAKPiAgCWZvcl9lYWNoX29sZG5ld19p
bnRlbF9jcnRjX2luX3N0YXRlKHN0YXRlLCBjcnRjLCBvbGRfY3J0Y19zdGF0ZSwgbmV3X2NydGNf
c3RhdGUsIGkpCj4gIAkJLyogaWdub3JlIGFsbG9jYXRpb25zIGZvciBjcnRjJ3MgdGhhdCBoYXZl
IGJlZW4gdHVybmVkIG9mZi4gKi8KPiAtCQlpZiAobmV3X2NydGNfc3RhdGUtPmJhc2UuYWN0aXZl
KQo+ICsJCWlmIChuZXdfY3J0Y19zdGF0ZS0+aHcuYWN0aXZlKQo+ICAJCQllbnRyaWVzW2ldID0g
b2xkX2NydGNfc3RhdGUtPndtLnNrbC5kZGI7Cj4gIAo+ICAJLyogSWYgMm5kIERCdWYgc2xpY2Ug
cmVxdWlyZWQsIGVuYWJsZSBpdCBoZXJlICovCj4gQEAgLTEzODA2LDcgKzEzODA5LDcgQEAgc3Rh
dGljIHZvaWQgc2tsX2NvbW1pdF9tb2Rlc2V0X2VuYWJsZXMoc3RydWN0IGludGVsX2F0b21pY19z
dGF0ZSAqc3RhdGUpCj4gIAo+ICAJCQlwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCj4gLQkJCWlmICh1
cGRhdGVkICYgY21hc2sgfHwgIW5ld19jcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSkKPiArCQkJaWYg
KHVwZGF0ZWQgJiBjbWFzayB8fCAhbmV3X2NydGNfc3RhdGUtPmh3LmFjdGl2ZSkKPiAgCQkJCWNv
bnRpbnVlOwo+ICAKPiAgCQkJaWYgKHNrbF9kZGJfYWxsb2NhdGlvbl9vdmVybGFwcygmbmV3X2Ny
dGNfc3RhdGUtPndtLnNrbC5kZGIsCj4gQEAgLTEzODI1LDcgKzEzODI4LDcgQEAgc3RhdGljIHZv
aWQgc2tsX2NvbW1pdF9tb2Rlc2V0X2VuYWJsZXMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAq
c3RhdGUpCj4gIAkJCSAqLwo+ICAJCQlpZiAoIXNrbF9kZGJfZW50cnlfZXF1YWwoJm5ld19jcnRj
X3N0YXRlLT53bS5za2wuZGRiLAo+ICAJCQkJCQkgJm9sZF9jcnRjX3N0YXRlLT53bS5za2wuZGRi
KSAmJgo+IC0JCQkgICAgIW5ld19jcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZV9jaGFuZ2VkICYmCj4g
KwkJCSAgICAhbmV3X2NydGNfc3RhdGUtPnVhcGkuYWN0aXZlX2NoYW5nZWQgJiYKPiAgCQkJICAg
IHN0YXRlLT53bV9yZXN1bHRzLmRpcnR5X3BpcGVzICE9IHVwZGF0ZWQpCj4gIAkJCQl2Ymxfd2Fp
dCA9IHRydWU7Cj4gIAo+IEBAIC0xMzk1OCwxMiArMTM5NjEsMTMgQEAgc3RhdGljIHZvaWQgaW50
ZWxfYXRvbWljX2NvbW1pdF90YWlsKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+
ICAJCWJvb2wgbW9kZXNldCA9IG5lZWRzX21vZGVzZXQobmV3X2NydGNfc3RhdGUpOwo+ICAKPiAg
CQkvKiBDb21wbGV0ZSBldmVudHMgZm9yIG5vdyBkaXNhYmxlIHBpcGVzIGhlcmUuICovCj4gLQkJ
aWYgKG1vZGVzZXQgJiYgIW5ld19jcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSAmJiBuZXdfY3J0Y19z
dGF0ZS0+YmFzZS5ldmVudCkgewo+ICsJCWlmIChtb2Rlc2V0ICYmICFuZXdfY3J0Y19zdGF0ZS0+
aHcuYWN0aXZlICYmIG5ld19jcnRjX3N0YXRlLT51YXBpLmV2ZW50KSB7Cj4gIAkJCXNwaW5fbG9j
a19pcnEoJmRldi0+ZXZlbnRfbG9jayk7Cj4gLQkJCWRybV9jcnRjX3NlbmRfdmJsYW5rX2V2ZW50
KCZjcnRjLT5iYXNlLCBuZXdfY3J0Y19zdGF0ZS0+YmFzZS5ldmVudCk7Cj4gKwkJCWRybV9jcnRj
X3NlbmRfdmJsYW5rX2V2ZW50KCZjcnRjLT5iYXNlLAo+ICsJCQkJCQkgICBuZXdfY3J0Y19zdGF0
ZS0+dWFwaS5ldmVudCk7Cj4gIAkJCXNwaW5fdW5sb2NrX2lycSgmZGV2LT5ldmVudF9sb2NrKTsK
PiAgCj4gLQkJCW5ld19jcnRjX3N0YXRlLT5iYXNlLmV2ZW50ID0gTlVMTDsKPiArCQkJbmV3X2Ny
dGNfc3RhdGUtPnVhcGkuZXZlbnQgPSBOVUxMOwo+ICAJCX0KPiAgCX0KPiAgCj4gQEAgLTEzOTk0
LDkgKzEzOTk4LDkgQEAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX2NvbW1pdF90YWlsKHN0cnVj
dCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAJZHJtX2F0b21pY19oZWxwZXJfd2FpdF9m
b3JfZmxpcF9kb25lKGRldiwgJnN0YXRlLT5iYXNlKTsKPiAgCj4gIAlmb3JfZWFjaF9uZXdfaW50
ZWxfY3J0Y19pbl9zdGF0ZShzdGF0ZSwgY3J0YywgbmV3X2NydGNfc3RhdGUsIGkpIHsKPiAtCQlp
ZiAobmV3X2NydGNfc3RhdGUtPmJhc2UuYWN0aXZlICYmCj4gKwkJaWYgKG5ld19jcnRjX3N0YXRl
LT5ody5hY3RpdmUgJiYKPiAgCQkgICAgIW5lZWRzX21vZGVzZXQobmV3X2NydGNfc3RhdGUpICYm
Cj4gLQkJICAgIChuZXdfY3J0Y19zdGF0ZS0+YmFzZS5jb2xvcl9tZ210X2NoYW5nZWQgfHwKPiAr
CQkgICAgKG5ld19jcnRjX3N0YXRlLT51YXBpLmNvbG9yX21nbXRfY2hhbmdlZCB8fAo+ICAJCSAg
ICAgbmV3X2NydGNfc3RhdGUtPnVwZGF0ZV9waXBlKSkKPiAgCQkJaW50ZWxfY29sb3JfbG9hZF9s
dXRzKG5ld19jcnRjX3N0YXRlKTsKPiAgCX0KPiBAQCAtMTQ0NTEsMTYgKzE0NDU1LDE2IEBAIGlu
dAo+ICBza2xfbWF4X3NjYWxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlLAo+ICAJICAgICAgY29uc3Qgc3RydWN0IGRybV9mb3JtYXRfaW5mbyAqZm9ybWF0KQo+ICB7
Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+
YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0Yyhj
cnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gIAlpbnQgbWF4X3NjYWxlOwo+ICAJaW50
IGNydGNfY2xvY2ssIG1heF9kb3RjbGssIHRtcGNsazEsIHRtcGNsazI7Cj4gIAo+IC0JaWYgKCFj
cnRjX3N0YXRlLT5iYXNlLmVuYWJsZSkKPiArCWlmICghY3J0Y19zdGF0ZS0+aHcuZW5hYmxlKQo+
ICAJCXJldHVybiBEUk1fUExBTkVfSEVMUEVSX05PX1NDQUxJTkc7Cj4gIAo+IC0JY3J0Y19jbG9j
ayA9IGNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrOwo+IC0JbWF4X2Rv
dGNsayA9IHRvX2ludGVsX2F0b21pY19zdGF0ZShjcnRjX3N0YXRlLT5iYXNlLnN0YXRlKS0+Y2Rj
bGsubG9naWNhbC5jZGNsazsKPiArCWNydGNfY2xvY2sgPSBjcnRjX3N0YXRlLT5ody5hZGp1c3Rl
ZF9tb2RlLmNydGNfY2xvY2s7Cj4gKwltYXhfZG90Y2xrID0gdG9faW50ZWxfYXRvbWljX3N0YXRl
KGNydGNfc3RhdGUtPnVhcGkuc3RhdGUpLT5jZGNsay5sb2dpY2FsLmNkY2xrOwo+ICAKPiAgCWlm
IChJU19HRU1JTklMQUtFKGRldl9wcml2KSB8fCBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwKQo+
ICAJCW1heF9kb3RjbGsgKj0gMjsKPiBAQCAtMTQ1MDEsNyArMTQ1MDUsNyBAQCBzdGF0aWMgdm9p
ZCBpbnRlbF9iZWdpbl9jcnRjX2NvbW1pdChzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0
ZSwKPiAgCWlmIChtb2Rlc2V0KQo+ICAJCWdvdG8gb3V0Owo+ICAKPiAtCWlmIChuZXdfY3J0Y19z
dGF0ZS0+YmFzZS5jb2xvcl9tZ210X2NoYW5nZWQgfHwKPiArCWlmIChuZXdfY3J0Y19zdGF0ZS0+
dWFwaS5jb2xvcl9tZ210X2NoYW5nZWQgfHwKPiAgCSAgICBuZXdfY3J0Y19zdGF0ZS0+dXBkYXRl
X3BpcGUpCj4gIAkJaW50ZWxfY29sb3JfY29tbWl0KG5ld19jcnRjX3N0YXRlKTsKPiAgCj4gQEAg
LTE0NTQ3LDcgKzE0NTUxLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZmluaXNoX2NydGNfY29tbWl0
KHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+ICAKPiAgCWlmIChuZXdfY3J0Y19z
dGF0ZS0+dXBkYXRlX3BpcGUgJiYKPiAgCSAgICAhbmVlZHNfbW9kZXNldChuZXdfY3J0Y19zdGF0
ZSkgJiYKPiAtCSAgICBvbGRfY3J0Y19zdGF0ZS0+YmFzZS5tb2RlLnByaXZhdGVfZmxhZ3MgJiBJ
OTE1X01PREVfRkxBR19JTkhFUklURUQpCj4gKwkgICAgb2xkX2NydGNfc3RhdGUtPmh3Lm1vZGUu
cHJpdmF0ZV9mbGFncyAmIEk5MTVfTU9ERV9GTEFHX0lOSEVSSVRFRCkKPiAgCQlpbnRlbF9jcnRj
X2FybV9maWZvX3VuZGVycnVuKGNydGMsIG5ld19jcnRjX3N0YXRlKTsKPiAgfQo+ICAKPiBAQCAt
MTQ2NTksNyArMTQ2NjMsNyBAQCBpbnRlbF9sZWdhY3lfY3Vyc29yX3VwZGF0ZShzdHJ1Y3QgZHJt
X3BsYW5lICpwbGFuZSwKPiAgCSAqIFdoZW4gY3J0YyBpcyBpbmFjdGl2ZSBvciB0aGVyZSBpcyBh
IG1vZGVzZXQgcGVuZGluZywKPiAgCSAqIHdhaXQgZm9yIGl0IHRvIGNvbXBsZXRlIGluIHRoZSBz
bG93cGF0aAo+ICAJICovCj4gLQlpZiAoIWNydGNfc3RhdGUtPmJhc2UuYWN0aXZlIHx8IG5lZWRz
X21vZGVzZXQoY3J0Y19zdGF0ZSkgfHwKPiArCWlmICghY3J0Y19zdGF0ZS0+aHcuYWN0aXZlIHx8
IG5lZWRzX21vZGVzZXQoY3J0Y19zdGF0ZSkgfHwKPiAgCSAgICBjcnRjX3N0YXRlLT51cGRhdGVf
cGlwZSkKPiAgCQlnb3RvIHNsb3c7Cj4gIAo+IEBAIC0xNDc1Myw3ICsxNDc1Nyw3IEBAIGludGVs
X2xlZ2FjeV9jdXJzb3JfdXBkYXRlKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLAo+ICAJbXV0ZXhf
dW5sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gIG91dF9mcmVlOgo+ICAJaWYg
KG5ld19jcnRjX3N0YXRlKQo+IC0JCWludGVsX2NydGNfZGVzdHJveV9zdGF0ZShjcnRjLCAmbmV3
X2NydGNfc3RhdGUtPmJhc2UpOwo+ICsJCWludGVsX2NydGNfZGVzdHJveV9zdGF0ZShjcnRjLCAm
bmV3X2NydGNfc3RhdGUtPnVhcGkpOwo+ICAJaWYgKHJldCkKPiAgCQlpbnRlbF9wbGFuZV9kZXN0
cm95X3N0YXRlKHBsYW5lLCBuZXdfcGxhbmVfc3RhdGUpOwo+ICAJZWxzZQo+IEBAIC0xNTA3OSw3
ICsxNTA4Myw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfY3J0Y19pbml0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUpCj4gIAkJcmV0ID0gLUVOT01FTTsKPiAg
CQlnb3RvIGZhaWw7Cj4gIAl9Cj4gLQlfX2RybV9hdG9taWNfaGVscGVyX2NydGNfcmVzZXQoJmlu
dGVsX2NydGMtPmJhc2UsICZjcnRjX3N0YXRlLT5iYXNlKTsKPiArCV9fZHJtX2F0b21pY19oZWxw
ZXJfY3J0Y19yZXNldCgmaW50ZWxfY3J0Yy0+YmFzZSwgJmNydGNfc3RhdGUtPnVhcGkpOwo+ICAJ
aW50ZWxfY3J0Yy0+Y29uZmlnID0gY3J0Y19zdGF0ZTsKPiAgCj4gIAlwcmltYXJ5ID0gaW50ZWxf
cHJpbWFyeV9wbGFuZV9jcmVhdGUoZGV2X3ByaXYsIHBpcGUpOwo+IEBAIC0xNjQ1NSw3ICsxNjQ1
OSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3Nhbml0aXplX2NydGMoc3RydWN0IGludGVsX2NydGMg
KmNydGMsCj4gIAkJCSAgIEk5MTVfUkVBRChyZWcpICYgflBJUEVDT05GX0ZSQU1FX1NUQVJUX0RF
TEFZX01BU0spOwo+ICAJfQo+ICAKPiAtCWlmIChjcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSkgewo+
ICsJaWYgKGNydGNfc3RhdGUtPmh3LmFjdGl2ZSkgewo+ICAJCXN0cnVjdCBpbnRlbF9wbGFuZSAq
cGxhbmU7Cj4gIAo+ICAJCS8qIERpc2FibGUgZXZlcnl0aGluZyBidXQgdGhlIHByaW1hcnkgcGxh
bmUgKi8KPiBAQCAtMTY0ODAsMTAgKzE2NDg0LDEwIEBAIHN0YXRpYyB2b2lkIGludGVsX3Nhbml0
aXplX2NydGMoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gIAo+ICAJLyogQWRqdXN0IHRoZSBz
dGF0ZSBvZiB0aGUgb3V0cHV0IHBpcGUgYWNjb3JkaW5nIHRvIHdoZXRoZXIgd2UKPiAgCSAqIGhh
dmUgYWN0aXZlIGNvbm5lY3RvcnMvZW5jb2RlcnMuICovCj4gLQlpZiAoY3J0Y19zdGF0ZS0+YmFz
ZS5hY3RpdmUgJiYgIWludGVsX2NydGNfaGFzX2VuY29kZXJzKGNydGMpKQo+ICsJaWYgKGNydGNf
c3RhdGUtPmh3LmFjdGl2ZSAmJiAhaW50ZWxfY3J0Y19oYXNfZW5jb2RlcnMoY3J0YykpCj4gIAkJ
aW50ZWxfY3J0Y19kaXNhYmxlX25vYXRvbWljKCZjcnRjLT5iYXNlLCBjdHgpOwo+ICAKPiAtCWlm
IChjcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSB8fCBIQVNfR01DSChkZXZfcHJpdikpIHsKPiArCWlm
IChjcnRjX3N0YXRlLT5ody5hY3RpdmUgfHwgSEFTX0dNQ0goZGV2X3ByaXYpKSB7Cj4gIAkJLyoK
PiAgCQkgKiBXZSBzdGFydCBvdXQgd2l0aCB1bmRlcnJ1biByZXBvcnRpbmcgZGlzYWJsZWQgdG8g
YXZvaWQgcmFjZXMuCj4gIAkJICogRm9yIGNvcnJlY3QgYm9va2tlZXBpbmcgbWFyayB0aGlzIG9u
IGFjdGl2ZSBjcnRjcy4KPiBAQCAtMTY1MTQsNyArMTY1MTgsNyBAQCBzdGF0aWMgdm9pZCBpbnRl
bF9zYW5pdGl6ZV9jcnRjKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAKPiAgc3RhdGljIGJv
b2wgaGFzX2JvZ3VzX2RwbGxfY29uZmlnKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjLT5kZXYpOwo+
ICAKPiAgCS8qCj4gIAkgKiBTb21lIFNOQiBCSU9TZW4gKGVnLiBBU1VTIEs1M1NWKSBhcmUga25v
d24gdG8gbWlzcHJvZ3JhbQo+IEBAIC0xNjUyNyw3ICsxNjUzMSw3IEBAIHN0YXRpYyBib29sIGhh
c19ib2d1c19kcGxsX2NvbmZpZyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSkKPiAgCSAqIHJvYWQuCj4gIAkgKi8KPiAgCXJldHVybiBJU19HRU4oZGV2X3ByaXYsIDYp
ICYmCj4gLQkJY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUgJiYKPiArCQljcnRjX3N0YXRlLT5ody5h
Y3RpdmUgJiYKPiAgCQljcnRjX3N0YXRlLT5zaGFyZWRfZHBsbCAmJgo+ICAJCWNydGNfc3RhdGUt
PnBvcnRfY2xvY2sgPT0gMDsKPiAgfQo+IEBAIC0xNjU0NCw3ICsxNjU0OCw3IEBAIHN0YXRpYyB2
b2lkIGludGVsX3Nhbml0aXplX2VuY29kZXIoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIp
Cj4gIAkgKiBlbmNvZGVyIGlzIGFjdGl2ZSBhbmQgdHJ5aW5nIHRvIHJlYWQgZnJvbSBhIHBpcGUp
IGFuZCB0aGUKPiAgCSAqIHBpcGUgaXRzZWxmIGJlaW5nIGFjdGl2ZS4gKi8KPiAgCWJvb2wgaGFz
X2FjdGl2ZV9jcnRjID0gY3J0Y19zdGF0ZSAmJgo+IC0JCWNydGNfc3RhdGUtPmJhc2UuYWN0aXZl
Owo+ICsJCWNydGNfc3RhdGUtPmh3LmFjdGl2ZTsKPiAgCj4gIAlpZiAoY3J0Y19zdGF0ZSAmJiBo
YXNfYm9ndXNfZHBsbF9jb25maWcoY3J0Y19zdGF0ZSkpIHsKPiAgCQlEUk1fREVCVUdfS01TKCJC
SU9TIGhhcyBtaXNwcm9ncmFtbWVkIHRoZSBoYXJkd2FyZS4gRGlzYWJsaW5nIHBpcGUgJWNcbiIs
Cj4gQEAgLTE2NjgxLDIyICsxNjY4NSwyMiBAQCBzdGF0aWMgdm9pZCBpbnRlbF9tb2Rlc2V0X3Jl
YWRvdXRfaHdfc3RhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgCQlzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9Cj4gIAkJCXRvX2ludGVsX2NydGNfc3RhdGUoY3J0Yy0+
YmFzZS5zdGF0ZSk7Cj4gIAo+IC0JCV9fZHJtX2F0b21pY19oZWxwZXJfY3J0Y19kZXN0cm95X3N0
YXRlKCZjcnRjX3N0YXRlLT5iYXNlKTsKPiArCQlfX2RybV9hdG9taWNfaGVscGVyX2NydGNfZGVz
dHJveV9zdGF0ZSgmY3J0Y19zdGF0ZS0+dWFwaSk7Cj4gIAkJbWVtc2V0KGNydGNfc3RhdGUsIDAs
IHNpemVvZigqY3J0Y19zdGF0ZSkpOwo+IC0JCV9fZHJtX2F0b21pY19oZWxwZXJfY3J0Y19yZXNl
dCgmY3J0Yy0+YmFzZSwgJmNydGNfc3RhdGUtPmJhc2UpOwo+ICsJCV9fZHJtX2F0b21pY19oZWxw
ZXJfY3J0Y19yZXNldCgmY3J0Yy0+YmFzZSwgJmNydGNfc3RhdGUtPnVhcGkpOwo+ICAKPiAtCQlj
cnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSA9IGNydGNfc3RhdGUtPmJhc2UuZW5hYmxlID0KPiArCQlj
cnRjX3N0YXRlLT5ody5hY3RpdmUgPSBjcnRjX3N0YXRlLT5ody5lbmFibGUgPQo+ICAJCQlkZXZf
cHJpdi0+ZGlzcGxheS5nZXRfcGlwZV9jb25maWcoY3J0YywgY3J0Y19zdGF0ZSk7Cj4gIAo+IC0J
CWNydGMtPmJhc2UuZW5hYmxlZCA9IGNydGNfc3RhdGUtPmJhc2UuZW5hYmxlOwo+IC0JCWNydGMt
PmFjdGl2ZSA9IGNydGNfc3RhdGUtPmJhc2UuYWN0aXZlOwo+ICsJCWNydGMtPmJhc2UuZW5hYmxl
ZCA9IGNydGNfc3RhdGUtPmh3LmVuYWJsZTsKPiArCQljcnRjLT5hY3RpdmUgPSBjcnRjX3N0YXRl
LT5ody5hY3RpdmU7Cj4gIAo+IC0JCWlmIChjcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSkKPiArCQlp
ZiAoY3J0Y19zdGF0ZS0+aHcuYWN0aXZlKQo+ICAJCQlkZXZfcHJpdi0+YWN0aXZlX3BpcGVzIHw9
IEJJVChjcnRjLT5waXBlKTsKPiAgCj4gIAkJRFJNX0RFQlVHX0tNUygiW0NSVEM6JWQ6JXNdIGh3
IHN0YXRlIHJlYWRvdXQ6ICVzXG4iLAo+ICAJCQkgICAgICBjcnRjLT5iYXNlLmJhc2UuaWQsIGNy
dGMtPmJhc2UubmFtZSwKPiAtCQkJICAgICAgZW5hYmxlZGRpc2FibGVkKGNydGNfc3RhdGUtPmJh
c2UuYWN0aXZlKSk7Cj4gKwkJCSAgICAgIGVuYWJsZWRkaXNhYmxlZChjcnRjX3N0YXRlLT5ody5h
Y3RpdmUpKTsKPiAgCX0KPiAgCj4gIAlyZWFkb3V0X3BsYW5lX3N0YXRlKGRldl9wcml2KTsKPiBA
QCAtMTY3MTgsNyArMTY3MjIsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9tb2Rlc2V0X3JlYWRvdXRf
aHdfc3RhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgCQkJc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUgPQo+ICAJCQkJdG9faW50ZWxfY3J0Y19zdGF0ZShjcnRjLT5iYXNl
LnN0YXRlKTsKPiAgCj4gLQkJCWlmIChjcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSAmJgo+ICsJCQlp
ZiAoY3J0Y19zdGF0ZS0+aHcuYWN0aXZlICYmCj4gIAkJCSAgICBjcnRjX3N0YXRlLT5zaGFyZWRf
ZHBsbCA9PSBwbGwpCj4gIAkJCQlwbGwtPnN0YXRlLmNydGNfbWFzayB8PSAxIDw8IGNydGMtPnBp
cGU7Cj4gIAkJfQo+IEBAIC0xNjc1MiwyMSArMTY3NTYsMjQgQEAgc3RhdGljIHZvaWQgaW50ZWxf
bW9kZXNldF9yZWFkb3V0X2h3X3N0YXRlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gIAlkcm1f
Y29ubmVjdG9yX2xpc3RfaXRlcl9iZWdpbihkZXYsICZjb25uX2l0ZXIpOwo+ICAJZm9yX2VhY2hf
aW50ZWxfY29ubmVjdG9yX2l0ZXIoY29ubmVjdG9yLCAmY29ubl9pdGVyKSB7Cj4gIAkJaWYgKGNv
bm5lY3Rvci0+Z2V0X2h3X3N0YXRlKGNvbm5lY3RvcikpIHsKPiAtCQkJY29ubmVjdG9yLT5iYXNl
LmRwbXMgPSBEUk1fTU9ERV9EUE1TX09OOwo+ICsJCQlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSA9IE5VTEw7Cj4gIAo+ICsJCQljb25uZWN0b3ItPmJhc2UuZHBtcyA9IERSTV9N
T0RFX0RQTVNfT047Cj4gIAkJCWVuY29kZXIgPSBjb25uZWN0b3ItPmVuY29kZXI7Cj4gIAkJCWNv
bm5lY3Rvci0+YmFzZS5lbmNvZGVyID0gJmVuY29kZXItPmJhc2U7Cj4gIAo+IC0JCQlpZiAoZW5j
b2Rlci0+YmFzZS5jcnRjICYmCj4gLQkJCSAgICBlbmNvZGVyLT5iYXNlLmNydGMtPnN0YXRlLT5h
Y3RpdmUpIHsKPiArCQkJaWYgKGVuY29kZXItPmJhc2UuY3J0YykKPiArCQkJCWNydGNfc3RhdGUg
PSB0b19pbnRlbF9jcnRjX3N0YXRlKGVuY29kZXItPmJhc2UuY3J0Yy0+c3RhdGUpOwo+ICsKPiAr
CQkJaWYgKGNydGNfc3RhdGUgJiYgY3J0Y19zdGF0ZS0+aHcuYWN0aXZlKSB7Cj4gIAkJCQkvKgo+
ICAJCQkJICogVGhpcyBoYXMgdG8gYmUgZG9uZSBkdXJpbmcgaGFyZHdhcmUgcmVhZG91dAo+ICAJ
CQkJICogYmVjYXVzZSBhbnl0aGluZyBjYWxsaW5nIC5jcnRjX2Rpc2FibGUgbWF5Cj4gIAkJCQkg
KiByZWx5IG9uIHRoZSBjb25uZWN0b3JfbWFzayBiZWluZyBhY2N1cmF0ZS4KPiAgCQkJCSAqLwo+
IC0JCQkJZW5jb2Rlci0+YmFzZS5jcnRjLT5zdGF0ZS0+Y29ubmVjdG9yX21hc2sgfD0KPiArCQkJ
CWNydGNfc3RhdGUtPnVhcGkuY29ubmVjdG9yX21hc2sgfD0KPiAgCQkJCQlkcm1fY29ubmVjdG9y
X21hc2soJmNvbm5lY3Rvci0+YmFzZSk7Cj4gLQkJCQllbmNvZGVyLT5iYXNlLmNydGMtPnN0YXRl
LT5lbmNvZGVyX21hc2sgfD0KPiArCQkJCWNydGNfc3RhdGUtPnVhcGkuZW5jb2Rlcl9tYXNrIHw9
Cj4gIAkJCQkJZHJtX2VuY29kZXJfbWFzaygmZW5jb2Rlci0+YmFzZSk7Cj4gIAkJCX0KPiAgCj4g
QEAgLTE2Nzg5LDExICsxNjc5NiwxMiBAQCBzdGF0aWMgdm9pZCBpbnRlbF9tb2Rlc2V0X3JlYWRv
dXRfaHdfc3RhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgCQlpbnQgbWluX2NkY2xrID0g
MDsKPiAgCj4gIAkJbWVtc2V0KCZjcnRjLT5iYXNlLm1vZGUsIDAsIHNpemVvZihjcnRjLT5iYXNl
Lm1vZGUpKTsKPiAtCQlpZiAoY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUpIHsKPiArCQlpZiAoY3J0
Y19zdGF0ZS0+aHcuYWN0aXZlKSB7Cj4gIAkJCWludGVsX21vZGVfZnJvbV9waXBlX2NvbmZpZygm
Y3J0Yy0+YmFzZS5tb2RlLCBjcnRjX3N0YXRlKTsKPiAgCQkJY3J0Yy0+YmFzZS5tb2RlLmhkaXNw
bGF5ID0gY3J0Y19zdGF0ZS0+cGlwZV9zcmNfdzsKPiAgCQkJY3J0Yy0+YmFzZS5tb2RlLnZkaXNw
bGF5ID0gY3J0Y19zdGF0ZS0+cGlwZV9zcmNfaDsKPiAtCQkJaW50ZWxfbW9kZV9mcm9tX3BpcGVf
Y29uZmlnKCZjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGUsIGNydGNfc3RhdGUpOwo+ICsJ
CQlpbnRlbF9tb2RlX2Zyb21fcGlwZV9jb25maWcoJmNydGNfc3RhdGUtPmh3LmFkanVzdGVkX21v
ZGUsCj4gKwkJCQkJCSAgICBjcnRjX3N0YXRlKTsKPiAgCQkJV0FSTl9PTihkcm1fYXRvbWljX3Nl
dF9tb2RlX2Zvcl9jcnRjKGNydGMtPmJhc2Uuc3RhdGUsICZjcnRjLT5iYXNlLm1vZGUpKTsKPiAg
Cj4gIAkJCS8qCj4gQEAgLTE2ODA1LDcgKzE2ODEzLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfbW9k
ZXNldF9yZWFkb3V0X2h3X3N0YXRlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gIAkJCSAqIHNl
dCBhIGZsYWcgdG8gaW5kaWNhdGUgdGhhdCBhIGZ1bGwgcmVjYWxjdWxhdGlvbiBpcwo+ICAJCQkg
KiBuZWVkZWQgb24gdGhlIG5leHQgY29tbWl0Lgo+ICAJCQkgKi8KPiAtCQkJY3J0Y19zdGF0ZS0+
YmFzZS5tb2RlLnByaXZhdGVfZmxhZ3MgPSBJOTE1X01PREVfRkxBR19JTkhFUklURUQ7Cj4gKwkJ
CWNydGNfc3RhdGUtPmh3Lm1vZGUucHJpdmF0ZV9mbGFncyA9IEk5MTVfTU9ERV9GTEFHX0lOSEVS
SVRFRDsKPiAgCj4gIAkJCWludGVsX2NydGNfY29tcHV0ZV9waXhlbF9yYXRlKGNydGNfc3RhdGUp
Owo+ICAKPiBAQCAtMTY4MTYsNyArMTY4MjQsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9tb2Rlc2V0
X3JlYWRvdXRfaHdfc3RhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgCQkJfQo+ICAKPiAg
CQkJZHJtX2NhbGNfdGltZXN0YW1waW5nX2NvbnN0YW50cygmY3J0Yy0+YmFzZSwKPiAtCQkJCQkJ
CSZjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGUpOwo+ICsJCQkJCQkJJmNydGNfc3RhdGUt
Pmh3LmFkanVzdGVkX21vZGUpOwo+ICAJCQl1cGRhdGVfc2NhbmxpbmVfb2Zmc2V0KGNydGNfc3Rh
dGUpOwo+ICAJCX0KPiAgCj4gQEAgLTE2OTg3LDcgKzE2OTk1LDcgQEAgaW50ZWxfbW9kZXNldF9z
ZXR1cF9od19zdGF0ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ICAKPiAgCQlkcm1fY3J0Y192
YmxhbmtfcmVzZXQoJmNydGMtPmJhc2UpOwo+ICAKPiAtCQlpZiAoY3J0Y19zdGF0ZS0+YmFzZS5h
Y3RpdmUpCj4gKwkJaWYgKGNydGNfc3RhdGUtPmh3LmFjdGl2ZSkKPiAgCQkJaW50ZWxfY3J0Y192
Ymxhbmtfb24oY3J0Y19zdGF0ZSk7Cj4gIAl9Cj4gIAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oCj4gaW5kZXggZDVjYzRiODEwZDll
Li4yYzM1NjcwODFlMTYgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaAo+IEBAIC03NDksNyArNzQ5LDMxIEBAIGVudW0gaW50
ZWxfb3V0cHV0X2Zvcm1hdCB7Cj4gIH07Cj4gIAo+ICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSB7
Cj4gLQlzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgYmFzZTsKPiArCXVuaW9uIHsKPiArCS8qCj4gKwkg
KiB1YXBpIChkcm0pIHN0YXRlLiBUaGlzIGlzIHRoZSBzb2Z0d2FyZSBzdGF0ZSBzaG93biB0byB1
c2Vyc3BhY2UuCj4gKwkgKiBJbiBwYXJ0aWN1bGFyLCB0aGUgZm9sbG93aW5nIG1lbWJlcnMgYXJl
IHVzZWQgZm9yIGJvb2trZWVwaW5nOgo+ICsJICogLSBjcnRjCj4gKwkgKiAtIHN0YXRlCj4gKwkg
KiAtICpfY2hhbmdlZAo+ICsJICogLSBldmVudAo+ICsJICogLSBjb21taXQKPiArCSAqIC0gbW9k
ZV9ibG9iCj4gKwkgKi8KPiArCXN0cnVjdCBkcm1fY3J0Y19zdGF0ZSB1YXBpOwo+ICsKPiArCS8q
Cj4gKwkgKiBhY3R1YWwgaGFyZHdhcmUgc3RhdGUsIHRoZSBzdGF0ZSB3ZSBwcm9ncmFtIHRvIHRo
ZSBoYXJkd2FyZS4KPiArCSAqIFRoZSBmb2xsb3dpbmcgbWVtYmVycyBhcmUgdXNlZCB0byB2ZXJp
ZnkgdGhlIGhhcmR3YXJlIHN0YXRlOgo+ICsJICogLSBlbmFibGUKPiArCSAqIC0gYWN0aXZlCj4g
KwkgKiAtIG1vZGUgLyBhZGp1c3RlZF9tb2RlCj4gKwkgKiAtIGNvbG9yIHByb3BlcnR5IGJsb2Jz
Lgo+ICsJICoKPiArCSAqIER1cmluZyBpbml0aWFsIGh3IHJlYWRvdXQsIHRoZXkgbmVlZCB0byBi
ZSBjb3BpZWQgdG8gdWFwaS4KPiArCSAqLwo+ICsJc3RydWN0IGRybV9jcnRjX3N0YXRlIGh3Owo+
ICsJfTsKPiAgCj4gIAkvKioKPiAgCSAqIHF1aXJrcyAtIGJpdGZpZWxkIHdpdGggaHcgc3RhdGUg
cmVhZG91dCBxdWlya3MKPiBAQCAtMTA5MSw3ICsxMTE1LDcgQEAgc3RydWN0IGN4c3JfbGF0ZW5j
eSB7Cj4gIAo+ICAjZGVmaW5lIHRvX2ludGVsX2F0b21pY19zdGF0ZSh4KSBjb250YWluZXJfb2Yo
eCwgc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSwgYmFzZSkKPiAgI2RlZmluZSB0b19pbnRlbF9j
cnRjKHgpIGNvbnRhaW5lcl9vZih4LCBzdHJ1Y3QgaW50ZWxfY3J0YywgYmFzZSkKPiAtI2RlZmlu
ZSB0b19pbnRlbF9jcnRjX3N0YXRlKHgpIGNvbnRhaW5lcl9vZih4LCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSwgYmFzZSkKPiArI2RlZmluZSB0b19pbnRlbF9jcnRjX3N0YXRlKHgpIGNvbnRhaW5l
cl9vZih4LCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSwgdWFwaSkKPiAgI2RlZmluZSB0b19pbnRl
bF9jb25uZWN0b3IoeCkgY29udGFpbmVyX29mKHgsIHN0cnVjdCBpbnRlbF9jb25uZWN0b3IsIGJh
c2UpCj4gICNkZWZpbmUgdG9faW50ZWxfZW5jb2Rlcih4KSBjb250YWluZXJfb2YoeCwgc3RydWN0
IGludGVsX2VuY29kZXIsIGJhc2UpCj4gICNkZWZpbmUgdG9faW50ZWxfZnJhbWVidWZmZXIoeCkg
Y29udGFpbmVyX29mKHgsIHN0cnVjdCBpbnRlbF9mcmFtZWJ1ZmZlciwgYmFzZSkKPiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jCj4gaW5kZXggMDIyNDJhMTY2NDBiLi4yZmNl
YjcxZjdmNzAgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9kcC5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jCj4g
QEAgLTE5NjYsNyArMTk2Niw3IEBAIGludGVsX2RwX2NvbXB1dGVfbGlua19jb25maWdfd2lkZShz
dHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ICAJCQkJICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqcGlwZV9jb25maWcsCj4gIAkJCQkgIGNvbnN0IHN0cnVjdCBsaW5rX2NvbmZpZ19saW1pdHMg
KmxpbWl0cykKPiAgewo+IC0Jc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUg
PSAmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPiArCXN0cnVjdCBkcm1fZGlzcGxh
eV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlOwo+
ICAJaW50IGJwcCwgY2xvY2ssIGxhbmVfY291bnQ7Cj4gIAlpbnQgbW9kZV9yYXRlLCBsaW5rX2Ns
b2NrLCBsaW5rX2F2YWlsOwo+ICAKPiBAQCAtMjAyMCw3ICsyMDIwLDcgQEAgc3RhdGljIGludCBp
bnRlbF9kcF9kc2NfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiAg
ewo+ICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQgPSBkcF90b19kaWdfcG9y
dChpbnRlbF9kcCk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsKPiAtCXN0cnVjdCBkcm1fZGlzcGxheV9tb2Rl
ICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gKwlz
dHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+aHcu
YWRqdXN0ZWRfbW9kZTsKPiAgCXU4IGRzY19tYXhfYnBjOwo+ICAJaW50IHBpcGVfYnBwOwo+ICAJ
aW50IHJldDsKPiBAQCAtMjEzMSw3ICsyMTMxLDcgQEAgaW50ZWxfZHBfY29tcHV0ZV9saW5rX2Nv
bmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgCQkJICAgICBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4gIAkJCSAgICAgc3RydWN0IGRybV9jb25uZWN0
b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICph
ZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gKwlzdHJ1
Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+aHcuYWRq
dXN0ZWRfbW9kZTsKPiAgCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSBlbmNfdG9faW50ZWxf
ZHAoJmVuY29kZXItPmJhc2UpOwo+ICAJc3RydWN0IGxpbmtfY29uZmlnX2xpbWl0cyBsaW1pdHM7
Cj4gIAlpbnQgY29tbW9uX2xlbjsKPiBAQCAtMjIxOSw4ICsyMjE5LDggQEAgaW50ZWxfZHBfeWNi
Y3I0MjBfY29uZmlnKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gIHsKPiAgCWNvbnN0IHN0
cnVjdCBkcm1fZGlzcGxheV9pbmZvICppbmZvID0gJmNvbm5lY3Rvci0+ZGlzcGxheV9pbmZvOwo+
ICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+IC0JCSZj
cnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiArCQkmY3J0Y19zdGF0
ZS0+aHcuYWRqdXN0ZWRfbW9kZTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50
ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAJaW50IHJldDsKPiAgCj4gIAlpZiAo
IWRybV9tb2RlX2lzXzQyMF9vbmx5KGluZm8sIGFkanVzdGVkX21vZGUpIHx8Cj4gQEAgLTIyNDgs
NyArMjI0OCw3IEBAIGJvb2wgaW50ZWxfZHBfbGltaXRlZF9jb2xvcl9yYW5nZShjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgCWNvbnN0IHN0cnVjdCBpbnRlbF9k
aWdpdGFsX2Nvbm5lY3Rvcl9zdGF0ZSAqaW50ZWxfY29ubl9zdGF0ZSA9Cj4gIAkJdG9faW50ZWxf
ZGlnaXRhbF9jb25uZWN0b3Jfc3RhdGUoY29ubl9zdGF0ZSk7Cj4gIAljb25zdCBzdHJ1Y3QgZHJt
X2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9Cj4gLQkJJmNydGNfc3RhdGUtPmJhc2UuYWRq
dXN0ZWRfbW9kZTsKPiArCQkmY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZTsKPiAgCj4gIAlp
ZiAoaW50ZWxfY29ubl9zdGF0ZS0+YnJvYWRjYXN0X3JnYiA9PSBJTlRFTF9CUk9BRENBU1RfUkdC
X0FVVE8pIHsKPiAgCQkvKgo+IEBAIC0yMjcxLDExICsyMjcxLDExIEBAIGludGVsX2RwX2NvbXB1
dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAJCQlzdHJ1Y3QgZHJt
X2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiAgewo+ICAJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gLQlzdHJ1Y3Qg
ZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+YmFzZS5hZGp1
c3RlZF9tb2RlOwo+ICsJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAm
cGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGU7Cj4gIAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVs
X2RwID0gZW5jX3RvX2ludGVsX2RwKCZlbmNvZGVyLT5iYXNlKTsKPiAgCXN0cnVjdCBpbnRlbF9s
c3Bjb24gKmxzcGNvbiA9IGVuY190b19pbnRlbF9sc3Bjb24oJmVuY29kZXItPmJhc2UpOwo+ICAJ
ZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+IC0Jc3RydWN0IGludGVsX2NydGMgKmlu
dGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT5iYXNlLmNydGMpOwo+ICsJc3Ry
dWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT51
YXBpLmNydGMpOwo+ICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqaW50ZWxfY29ubmVjdG9yID0g
aW50ZWxfZHAtPmF0dGFjaGVkX2Nvbm5lY3RvcjsKPiAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX2Nv
bm5lY3Rvcl9zdGF0ZSAqaW50ZWxfY29ubl9zdGF0ZSA9Cj4gIAkJdG9faW50ZWxfZGlnaXRhbF9j
b25uZWN0b3Jfc3RhdGUoY29ubl9zdGF0ZSk7Cj4gQEAgLTIzOTUsOCArMjM5NSw4IEBAIHN0YXRp
YyB2b2lkIGludGVsX2RwX3ByZXBhcmUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4g
IAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiAgCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSBlbmNfdG9faW50ZWxfZHAo
JmVuY29kZXItPmJhc2UpOwo+ICAJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+IC0J
c3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT5iYXNl
LmNydGMpOwo+IC0JY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUg
PSAmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPiArCXN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjID0gdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+dWFwaS5jcnRjKTsKPiArCWNvbnN0
IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmlnLT5o
dy5hZGp1c3RlZF9tb2RlOwo+ICAKPiAgCWludGVsX2RwX3NldF9saW5rX3BhcmFtcyhpbnRlbF9k
cCwgcGlwZV9jb25maWctPnBvcnRfY2xvY2ssCj4gIAkJCQkgcGlwZV9jb25maWctPmxhbmVfY291
bnQsCj4gQEAgLTI5OTMsNyArMjk5Myw3IEBAIHN0YXRpYyB2b2lkIGFzc2VydF9lZHBfcGxsKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgYm9vbCBzdGF0ZSkKPiAgc3RhdGljIHZv
aWQgaXJvbmxha2VfZWRwX3BsbF9vbihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ICAJCQkJ
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ICB7Cj4gLQlzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0
Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25m
aWctPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCj4gIAlhc3NlcnRfcGlwZV9kaXNhYmxlZChkZXZf
cHJpdiwgY3J0Yy0+cGlwZSk7Cj4gQEAgLTMwMzMsNyArMzAzMyw3IEBAIHN0YXRpYyB2b2lkIGly
b25sYWtlX2VkcF9wbGxfb24oc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiAgc3RhdGljIHZv
aWQgaXJvbmxha2VfZWRwX3BsbF9vZmYoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiAgCQkJ
CSBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUpCj4gIHsKPiAt
CXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhvbGRfY3J0Y19zdGF0ZS0+
YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0Yyhv
bGRfY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAKPiAgCWFzc2VydF9waXBlX2Rp
c2FibGVkKGRldl9wcml2LCBjcnRjLT5waXBlKTsKPiBAQCAtMzE5Myw3ICszMTkzLDcgQEAgc3Rh
dGljIHZvaWQgaW50ZWxfZHBfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKPiAgCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSBlbmNfdG9faW50ZWxfZHAoJmVuY29k
ZXItPmJhc2UpOwo+ICAJdTMyIHRtcCwgZmxhZ3MgPSAwOwo+ICAJZW51bSBwb3J0IHBvcnQgPSBl
bmNvZGVyLT5wb3J0Owo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRj
KHBpcGVfY29uZmlnLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0
b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT51YXBpLmNydGMpOwo+ICAKPiAgCWlmIChlbmNvZGVy
LT50eXBlID09IElOVEVMX09VVFBVVF9FRFApCj4gIAkJcGlwZV9jb25maWctPm91dHB1dF90eXBl
cyB8PSBCSVQoSU5URUxfT1VUUFVUX0VEUCk7Cj4gQEAgLTMyMjgsNyArMzIyOCw3IEBAIHN0YXRp
YyB2b2lkIGludGVsX2RwX2dldF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
Cj4gIAkJCWZsYWdzIHw9IERSTV9NT0RFX0ZMQUdfTlZTWU5DOwo+ICAJfQo+ICAKPiAtCXBpcGVf
Y29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuZmxhZ3MgfD0gZmxhZ3M7Cj4gKwlwaXBlX2NvbmZp
Zy0+aHcuYWRqdXN0ZWRfbW9kZS5mbGFncyB8PSBmbGFnczsKPiAgCj4gIAlpZiAoSVNfRzRYKGRl
dl9wcml2KSAmJiB0bXAgJiBEUF9DT0xPUl9SQU5HRV8xNl8yMzUpCj4gIAkJcGlwZV9jb25maWct
PmxpbWl0ZWRfY29sb3JfcmFuZ2UgPSB0cnVlOwo+IEBAIC0zMjQ1LDcgKzMyNDUsNyBAQCBzdGF0
aWMgdm9pZCBpbnRlbF9kcF9nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ICAJCQlwaXBlX2NvbmZpZy0+cG9ydF9jbG9jayA9IDI3MDAwMDsKPiAgCX0KPiAgCj4gLQlw
aXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2sgPQo+ICsJcGlwZV9jb25m
aWctPmh3LmFkanVzdGVkX21vZGUuY3J0Y19jbG9jayA9Cj4gIAkJaW50ZWxfZG90Y2xvY2tfY2Fs
Y3VsYXRlKHBpcGVfY29uZmlnLT5wb3J0X2Nsb2NrLAo+ICAJCQkJCSAmcGlwZV9jb25maWctPmRw
X21fbik7Cj4gIAo+IEBAIC0zNDYwLDcgKzM0NjAsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9lbmFi
bGVfZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIHsKPiAgCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAJ
c3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9IGVuY190b19pbnRlbF9kcCgmZW5jb2Rlci0+YmFz
ZSk7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25m
aWctPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2Ny
dGMocGlwZV9jb25maWctPnVhcGkuY3J0Yyk7Cj4gIAl1MzIgZHBfcmVnID0gSTkxNV9SRUFEKGlu
dGVsX2RwLT5vdXRwdXRfcmVnKTsKPiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAg
CWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+IEBAIC0zNTkzLDcgKzM1OTMsNyBAQCBzdGF0aWMg
dm9pZCB2bHZfaW5pdF9wYW5lbF9wb3dlcl9zZXF1ZW5jZXIoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4gIHsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAJc3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9
IGVuY190b19pbnRlbF9kcCgmZW5jb2Rlci0+YmFzZSk7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBp
bnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+
ICAKPiAgCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5wcHNfbXV0ZXgpOwo+ICAKPiBA
QCAtNDExNSw3ICs0MTE1LDcgQEAgaW50ZWxfZHBfbGlua19kb3duKHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyLAo+ICB7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAgCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxf
ZHAgPSBlbmNfdG9faW50ZWxfZHAoJmVuY29kZXItPmJhc2UpOwo+IC0Jc3RydWN0IGludGVsX2Ny
dGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJ
c3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT51
YXBpLmNydGMpOwo+ICAJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+ICAJdTMyIERQ
ID0gaW50ZWxfZHAtPkRQOwo+ICAKPiBAQCAtNDg3Niw3ICs0ODc2LDcgQEAgaW50IGludGVsX2Rw
X3JldHJhaW5fbGluayhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgCj4gIAlXQVJO
X09OKCFpbnRlbF9jcnRjX2hhc19kcF9lbmNvZGVyKGNydGNfc3RhdGUpKTsKPiAgCj4gLQlpZiAo
IWNydGNfc3RhdGUtPmJhc2UuYWN0aXZlKQo+ICsJaWYgKCFjcnRjX3N0YXRlLT5ody5hY3RpdmUp
Cj4gIAkJcmV0dXJuIDA7Cj4gIAo+ICAJaWYgKGNvbm5fc3RhdGUtPmNvbW1pdCAmJgo+IEBAIC02
Njk1LDcgKzY2OTUsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kcF9zZXRfZHJyc19zdGF0ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gIAkJCQkgICAgaW50IHJlZnJlc2hfcmF0
ZSkKPiAgewo+ICAJc3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9IGRldl9wcml2LT5kcnJzLmRw
Owo+IC0Jc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRv
X2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCWVudW0gZHJyc19yZWZyZXNo
X3JhdGVfdHlwZSBpbmRleCA9IERSUlNfSElHSF9SUjsKPiAgCj4gIAlpZiAocmVmcmVzaF9yYXRl
IDw9IDApIHsKPiBAQCAtNjcyOCw3ICs2NzI4LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHBfc2V0
X2RycnNfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAJCXJldHVy
bjsKPiAgCX0KPiAgCj4gLQlpZiAoIWNydGNfc3RhdGUtPmJhc2UuYWN0aXZlKSB7Cj4gKwlpZiAo
IWNydGNfc3RhdGUtPmh3LmFjdGl2ZSkgewo+ICAJCURSTV9ERUJVR19LTVMoImVEUCBlbmNvZGVy
IGRpc2FibGVkLiBDUlRDIG5vdCBBY3RpdmVcbiIpOwo+ICAJCXJldHVybjsKPiAgCX0KPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcF9tc3QuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHBfbXN0LmMKPiBpbmRleCBlZWViM2Y5
MzNhYTQuLjc2ZjA2NmIxZGZlNSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2RwX21zdC5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9kcF9tc3QuYwo+IEBAIC00MiwxMyArNDIsMTMgQEAgc3RhdGljIGludCBpbnRlbF9k
cF9tc3RfY29tcHV0ZV9saW5rX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwK
PiAgCQkJCQkgICAgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUsCj4gIAkJ
CQkJICAgIHN0cnVjdCBsaW5rX2NvbmZpZ19saW1pdHMgKmxpbWl0cykKPiAgewo+IC0Jc3RydWN0
IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0gY3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZTsKPiArCXN0
cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSA9IGNydGNfc3RhdGUtPnVhcGkuc3RhdGU7Cj4g
IAlzdHJ1Y3QgaW50ZWxfZHBfbXN0X2VuY29kZXIgKmludGVsX21zdCA9IGVuY190b19tc3QoJmVu
Y29kZXItPmJhc2UpOwo+ICAJc3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9ICZpbnRlbF9tc3Qt
PnByaW1hcnktPmRwOwo+ICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yID0KPiAg
CQl0b19pbnRlbF9jb25uZWN0b3IoY29ubl9zdGF0ZS0+Y29ubmVjdG9yKTsKPiAgCWNvbnN0IHN0
cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0KPiAtCQkmY3J0Y19zdGF0ZS0+
YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICsJCSZjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlOwo+
ICAJdm9pZCAqcG9ydCA9IGNvbm5lY3Rvci0+cG9ydDsKPiAgCWJvb2wgY29uc3RhbnRfbiA9IGRy
bV9kcF9oYXNfcXVpcmsoJmludGVsX2RwLT5kZXNjLAo+ICAJCQkJCSAgIERQX0RQQ0RfUVVJUktf
Q09OU1RBTlRfTik7Cj4gQEAgLTk5LDcgKzk5LDcgQEAgc3RhdGljIGludCBpbnRlbF9kcF9tc3Rf
Y29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIAlzdHJ1Y3Qg
aW50ZWxfZGlnaXRhbF9jb25uZWN0b3Jfc3RhdGUgKmludGVsX2Nvbm5fc3RhdGUgPQo+ICAJCXRv
X2ludGVsX2RpZ2l0YWxfY29ubmVjdG9yX3N0YXRlKGNvbm5fc3RhdGUpOwo+ICAJY29uc3Qgc3Ry
dWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+IC0JCSZwaXBlX2NvbmZpZy0+
YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICsJCSZwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZTsK
PiAgCXZvaWQgKnBvcnQgPSBjb25uZWN0b3ItPnBvcnQ7Cj4gIAlzdHJ1Y3QgbGlua19jb25maWdf
bGltaXRzIGxpbWl0czsKPiAgCWludCByZXQ7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHBpb19waHkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfZHBpb19waHkuYwo+IGluZGV4IDU1NmQxYjMwZjA2YS4uNzA0ZjM4NjgxYzRi
IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHBpb19w
aHkuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHBpb19waHku
Ywo+IEBAIC03MzksNyArNzM5LDcgQEAgdm9pZCBjaHZfZGF0YV9sYW5lX3NvZnRfcmVzZXQoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIHsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ICAJZW51bSBkcGlv
X2NoYW5uZWwgY2ggPSB2bHZfZHBvcnRfdG9fY2hhbm5lbChlbmNfdG9fZGlnX3BvcnQoJmVuY29k
ZXItPmJhc2UpKTsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0Yyhj
cnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19p
bnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAllbnVtIHBpcGUgcGlwZSA9IGNy
dGMtPnBpcGU7Cj4gIAl1MzIgdmFsOwo+ICAKPiBAQCAtNzgzLDcgKzc4Myw3IEBAIHZvaWQgY2h2
X3BoeV9wcmVfcGxsX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgewo+
ICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZHBvcnQgPSBlbmNfdG9fZGlnX3BvcnQoJmVu
Y29kZXItPmJhc2UpOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRv
X2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAJZW51bSBk
cGlvX2NoYW5uZWwgY2ggPSB2bHZfZHBvcnRfdG9fY2hhbm5lbChkcG9ydCk7Cj4gIAllbnVtIHBp
cGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gIAl1bnNpZ25lZCBpbnQgbGFuZV9tYXNrID0KPiBAQCAt
ODY0LDcgKzg2NCw3IEBAIHZvaWQgY2h2X3BoeV9wcmVfZW5jb2Rlcl9lbmFibGUoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gZW5j
X3RvX2ludGVsX2RwKCZlbmNvZGVyLT5iYXNlKTsKPiAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3Bv
cnQgKmRwb3J0ID0gZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApOwo+ICAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gLQlzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRj
KTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRl
LT51YXBpLmNydGMpOwo+ICAJZW51bSBkcGlvX2NoYW5uZWwgY2ggPSB2bHZfZHBvcnRfdG9fY2hh
bm5lbChkcG9ydCk7Cj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gIAlpbnQgZGF0
YSwgaSwgc3RhZ2dlcjsKPiBAQCAtOTUzLDcgKzk1Myw3IEBAIHZvaWQgY2h2X3BoeV9wb3N0X3Bs
bF9kaXNhYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAJCQkgICAgICBjb25z
dCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUpCj4gIHsKPiAgCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYp
Owo+IC0JZW51bSBwaXBlIHBpcGUgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT5iYXNl
LmNydGMpLT5waXBlOwo+ICsJZW51bSBwaXBlIHBpcGUgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRj
X3N0YXRlLT51YXBpLmNydGMpLT5waXBlOwo+ICAJdTMyIHZhbDsKPiAgCj4gIAl2bHZfZHBpb19n
ZXQoZGV2X3ByaXYpOwo+IEBAIC0xMDE2LDcgKzEwMTYsNyBAQCB2b2lkIHZsdl9waHlfcHJlX3Bs
bF9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIHsKPiAgCXN0cnVjdCBp
bnRlbF9kaWdpdGFsX3BvcnQgKmRwb3J0ID0gZW5jX3RvX2RpZ19wb3J0KCZlbmNvZGVyLT5iYXNl
KTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rl
ci0+YmFzZS5kZXYpOwo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRj
KGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRv
X2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCWVudW0gZHBpb19jaGFubmVs
IHBvcnQgPSB2bHZfZHBvcnRfdG9fY2hhbm5lbChkcG9ydCk7Cj4gIAllbnVtIHBpcGUgcGlwZSA9
IGNydGMtPnBpcGU7Cj4gIAo+IEBAIC0xMDQ2LDcgKzEwNDYsNyBAQCB2b2lkIHZsdl9waHlfcHJl
X2VuY29kZXJfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAJc3RydWN0
IGludGVsX2RwICppbnRlbF9kcCA9IGVuY190b19pbnRlbF9kcCgmZW5jb2Rlci0+YmFzZSk7Cj4g
IAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkcG9ydCA9IGRwX3RvX2RpZ19wb3J0KGludGVs
X2RwKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5j
b2Rlci0+YmFzZS5kZXYpOwo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9j
cnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9
IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCWVudW0gZHBpb19jaGFu
bmVsIHBvcnQgPSB2bHZfZHBvcnRfdG9fY2hhbm5lbChkcG9ydCk7Cj4gIAllbnVtIHBpcGUgcGlw
ZSA9IGNydGMtPnBpcGU7Cj4gIAl1MzIgdmFsOwo+IEBAIC0xMDc1LDcgKzEwNzUsNyBAQCB2b2lk
IHZsdl9waHlfcmVzZXRfbGFuZXMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIHsK
PiAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRwb3J0ID0gZW5jX3RvX2RpZ19wb3J0KCZl
bmNvZGVyLT5iYXNlKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0
b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVs
X2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+
ICAJZW51bSBkcGlvX2NoYW5uZWwgcG9ydCA9IHZsdl9kcG9ydF90b19jaGFubmVsKGRwb3J0KTsK
PiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCj4gZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHBsbF9tZ3IuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHBsbF9tZ3IuYwo+IGluZGV4IDk4Mjg4ZWRmODhmMC4uNDNj
MTJiY2ZlM2IyIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfZHBsbF9tZ3IuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZHBsbF9tZ3IuYwo+IEBAIC0xMzYsNyArMTM2LDcgQEAgdm9pZCBhc3NlcnRfc2hhcmVkX2RwbGwo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgKi8KPiAgdm9pZCBpbnRlbF9w
cmVwYXJlX3NoYXJlZF9kcGxsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0
Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50
ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gIAlzdHJ1Y3QgaW50ZWxf
c2hhcmVkX2RwbGwgKnBsbCA9IGNydGNfc3RhdGUtPnNoYXJlZF9kcGxsOwo+ICAKPiBAQCAtMTYz
LDcgKzE2Myw3IEBAIHZvaWQgaW50ZWxfcHJlcGFyZV9zaGFyZWRfZHBsbChjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgICovCj4gIHZvaWQgaW50ZWxfZW5hYmxl
X3NoYXJlZF9kcGxsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+
ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0
ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0
YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gIAlzdHJ1Y3QgaW50ZWxfc2hhcmVk
X2RwbGwgKnBsbCA9IGNydGNfc3RhdGUtPnNoYXJlZF9kcGxsOwo+ICAJdW5zaWduZWQgaW50IGNy
dGNfbWFzayA9IGRybV9jcnRjX21hc2soJmNydGMtPmJhc2UpOwo+IEBAIC0yMDgsNyArMjA4LDcg
QEAgdm9pZCBpbnRlbF9lbmFibGVfc2hhcmVkX2RwbGwoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCj4gICAqLwo+ICB2b2lkIGludGVsX2Rpc2FibGVfc2hhcmVkX2Rw
bGwoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHsKPiAtCXN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNy
dGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3Rh
dGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCXN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxs
ID0gY3J0Y19zdGF0ZS0+c2hhcmVkX2RwbGw7Cj4gIAl1bnNpZ25lZCBpbnQgY3J0Y19tYXNrID0g
ZHJtX2NydGNfbWFzaygmY3J0Yy0+YmFzZSk7Cj4gQEAgLTgyNSw3ICs4MjUsNyBAQCBoc3dfZGRp
X2hkbWlfZ2V0X2RwbGwoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4gIHN0YXRp
YyBzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKgo+ICBoc3dfZGRpX2RwX2dldF9kcGxsKHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsK
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0
ZS0+dWFwaS5jcnRjLT5kZXYpOwo+ICAJc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGw7Cj4g
IAllbnVtIGludGVsX2RwbGxfaWQgcGxsX2lkOwo+ICAJaW50IGNsb2NrID0gY3J0Y19zdGF0ZS0+
cG9ydF9jbG9jazsKPiBAQCAtMTczNCw3ICsxNzM0LDcgQEAgc3RhdGljIGJvb2wKPiAgYnh0X2Rk
aV9oZG1pX3BsbF9kaXZpZGVycyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwK
PiAgCQkJICBzdHJ1Y3QgYnh0X2Nsa19kaXYgKmNsa19kaXYpCj4gIHsKPiAtCXN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJ
c3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGku
Y3J0Yyk7Cj4gIAlzdHJ1Y3QgZHBsbCBiZXN0X2Nsb2NrOwo+ICAKPiAgCS8qIENhbGN1bGF0ZSBI
RE1JIGRpdiAqLwo+IEBAIC0yMjU3LDcgKzIyNTcsNyBAQCBzdGF0aWMgYm9vbAo+ICBjbmxfZGRp
X2NhbGN1bGF0ZV93cnBsbChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAg
CQkJc3RydWN0IHNrbF93cnBsbF9wYXJhbXMgKndycGxsX3BhcmFtcykKPiAgewo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNy
dGMtPmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsKPiAgCXUzMiBhZmVfY2xvY2sgPSBjcnRjX3N0
YXRlLT5wb3J0X2Nsb2NrICogNTsKPiAgCXUzMiByZWZfY2xvY2s7Cj4gIAl1MzIgZGNvX21pbiA9
IDc5OTgwMDA7Cj4gQEAgLTI1MjMsNyArMjUyMyw3IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3Qgc2ts
X3dycGxsX3BhcmFtcyBpY2xfdGJ0X3BsbF8xOV8yTUh6X3ZhbHVlcyA9IHsKPiAgc3RhdGljIGJv
b2wgaWNsX2NhbGNfZHBfY29tYm9fcGxsKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlLAo+ICAJCQkJICBzdHJ1Y3Qgc2tsX3dycGxsX3BhcmFtcyAqcGxsX3BhcmFtcykKPiAgewo+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRl
LT5iYXNlLmNydGMtPmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsKPiAgCWNvbnN0IHN0cnVjdCBp
Y2xfY29tYm9fcGxsX3BhcmFtcyAqcGFyYW1zID0KPiAgCQlkZXZfcHJpdi0+Y2RjbGsuaHcucmVm
ID09IDI0MDAwID8KPiAgCQlpY2xfZHBfY29tYm9fcGxsXzI0TUh6X3ZhbHVlcyA6Cj4gQEAgLTI1
NDUsNyArMjU0NSw3IEBAIHN0YXRpYyBib29sIGljbF9jYWxjX2RwX2NvbWJvX3BsbChzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgc3RhdGljIGJvb2wgaWNsX2NhbGNfdGJ0
X3BsbChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgCQkJICAgICBzdHJ1
Y3Qgc2tsX3dycGxsX3BhcmFtcyAqcGxsX3BhcmFtcykKPiAgewo+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3Rh
dGUtPnVhcGkuY3J0Yy0+ZGV2KTsKPiAgCj4gIAkqcGxsX3BhcmFtcyA9IGRldl9wcml2LT5jZGNs
ay5ody5yZWYgPT0gMjQwMDAgPwo+ICAJCQlpY2xfdGJ0X3BsbF8yNE1Iel92YWx1ZXMgOiBpY2xf
dGJ0X3BsbF8xOV8yTUh6X3ZhbHVlczsKPiBAQCAtMjU1Niw3ICsyNTU2LDcgQEAgc3RhdGljIGJv
b2wgaWNsX2NhbGNfZHBsbF9zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSwKPiAgCQkJCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAJCQkJc3RydWN0IGlu
dGVsX2RwbGxfaHdfc3RhdGUgKnBsbF9zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUt
PnVhcGkuY3J0Yy0+ZGV2KTsKPiAgCXUzMiBjZmdjcjAsIGNmZ2NyMTsKPiAgCXN0cnVjdCBza2xf
d3JwbGxfcGFyYW1zIHBsbF9wYXJhbXMgPSB7IDAgfTsKPiAgCWJvb2wgcmV0Owo+IEBAIC0yNjgy
LDcgKzI2ODIsNyBAQCBzdGF0aWMgYm9vbCBpY2xfbWdfcGxsX2ZpbmRfZGl2aXNvcnMoaW50IGNs
b2NrX2toeiwgYm9vbCBpc19kcCwgYm9vbCB1c2Vfc3NjLAo+ICBzdGF0aWMgYm9vbCBpY2xfY2Fs
Y19tZ19wbGxfc3RhdGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gIAkJ
CQkgIHN0cnVjdCBpbnRlbF9kcGxsX2h3X3N0YXRlICpwbGxfc3RhdGUpCj4gIHsKPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5j
cnRjLT5kZXYpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjcnRjX3N0YXRlLT51YXBpLmNydGMtPmRldik7Cj4gIAlpbnQgcmVmY2xrX2toeiA9IGRldl9w
cml2LT5jZGNsay5ody5yZWY7Cj4gIAlpbnQgY2xvY2sgPSBjcnRjX3N0YXRlLT5wb3J0X2Nsb2Nr
Owo+ICAJdTMyIGRjb19raHosIG0xZGl2LCBtMmRpdl9pbnQsIG0yZGl2X3JlbSwgbTJkaXZfZnJh
YzsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kdm8u
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHZvLmMKPiBpbmRleCAzNDE5
M2QwNDU5N2EuLmFmMDE0OWUzMmJmNCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2R2by5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9kdm8uYwo+IEBAIC0xNzgsOSArMTc4LDkgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHZv
X2dldF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIAllbHNlCj4gIAkJ
ZmxhZ3MgfD0gRFJNX01PREVfRkxBR19OVlNZTkM7Cj4gIAo+IC0JcGlwZV9jb25maWctPmJhc2Uu
YWRqdXN0ZWRfbW9kZS5mbGFncyB8PSBmbGFnczsKPiArCXBpcGVfY29uZmlnLT5ody5hZGp1c3Rl
ZF9tb2RlLmZsYWdzIHw9IGZsYWdzOwo+ICAKPiAtCXBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVk
X21vZGUuY3J0Y19jbG9jayA9IHBpcGVfY29uZmlnLT5wb3J0X2Nsb2NrOwo+ICsJcGlwZV9jb25m
aWctPmh3LmFkanVzdGVkX21vZGUuY3J0Y19jbG9jayA9IHBpcGVfY29uZmlnLT5wb3J0X2Nsb2Nr
Owo+ICB9Cj4gIAo+ICBzdGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxlX2R2byhzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKPiBAQCAtMjA3LDggKzIwNyw4IEBAIHN0YXRpYyB2b2lkIGludGVs
X2VuYWJsZV9kdm8oc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIAl1MzIgdGVtcCA9
IEk5MTVfUkVBRChkdm9fcmVnKTsKPiAgCj4gIAlpbnRlbF9kdm8tPmRldi5kZXZfb3BzLT5tb2Rl
X3NldCgmaW50ZWxfZHZvLT5kZXYsCj4gLQkJCQkJICZwaXBlX2NvbmZpZy0+YmFzZS5tb2RlLAo+
IC0JCQkJCSAmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZSk7Cj4gKwkJCQkJICZwaXBl
X2NvbmZpZy0+aHcubW9kZSwKPiArCQkJCQkgJnBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2Rl
KTsKPiAgCj4gIAlJOTE1X1dSSVRFKGR2b19yZWcsIHRlbXAgfCBEVk9fRU5BQkxFKTsKPiAgCUk5
MTVfUkVBRChkdm9fcmVnKTsKPiBAQCAtMjUzLDcgKzI1Myw3IEBAIHN0YXRpYyBpbnQgaW50ZWxf
ZHZvX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAJc3Ry
dWN0IGludGVsX2R2byAqaW50ZWxfZHZvID0gZW5jX3RvX2R2byhlbmNvZGVyKTsKPiAgCWNvbnN0
IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICpmaXhlZF9tb2RlID0KPiAgCQlpbnRlbF9kdm8tPmF0
dGFjaGVkX2Nvbm5lY3Rvci0+cGFuZWwuZml4ZWRfbW9kZTsKPiAtCXN0cnVjdCBkcm1fZGlzcGxh
eV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7
Cj4gKwlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZp
Zy0+aHcuYWRqdXN0ZWRfbW9kZTsKPiAgCj4gIAkvKgo+ICAJICogSWYgd2UgaGF2ZSB0aW1pbmdz
IGZyb20gdGhlIEJJT1MgZm9yIHRoZSBwYW5lbCwgcHV0IHRoZW0gaW4KPiBAQCAtMjc3LDggKzI3
Nyw4IEBAIHN0YXRpYyB2b2lkIGludGVsX2R2b19wcmVfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyLAo+ICAJCQkJIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpj
b25uX3N0YXRlKQo+ICB7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0g
dG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+YmFzZS5jcnRjKTsKPiAtCWNvbnN0IHN0cnVjdCBk
cm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmlnLT5iYXNlLmFkanVz
dGVkX21vZGU7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMocGlw
ZV9jb25maWctPnVhcGkuY3J0Yyk7Cj4gKwljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAq
YWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZTsKPiAgCXN0cnVj
dCBpbnRlbF9kdm8gKmludGVsX2R2byA9IGVuY190b19kdm8oZW5jb2Rlcik7Cj4gIAllbnVtIHBp
cGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gIAl1MzIgZHZvX3ZhbDsKPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mYmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfZmJjLmMKPiBpbmRleCAzMTExZWNhZWFiZDAuLmM2Y2MzNzc1ZjNi
OCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2ZiYy5j
Cj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mYmMuYwo+IEBAIC02
NjcsNyArNjY3LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZmJjX3VwZGF0ZV9zdGF0ZV9jYWNoZShz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgCWNhY2hlLT52bWEgPSBOVUxMOwo+ICAJY2FjaGUt
PmZsYWdzID0gMDsKPiAgCj4gLQljYWNoZS0+Y3J0Yy5tb2RlX2ZsYWdzID0gY3J0Y19zdGF0ZS0+
YmFzZS5hZGp1c3RlZF9tb2RlLmZsYWdzOwo+ICsJY2FjaGUtPmNydGMubW9kZV9mbGFncyA9IGNy
dGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGUuZmxhZ3M7Cj4gIAlpZiAoSVNfSEFTV0VMTChkZXZf
cHJpdikgfHwgSVNfQlJPQURXRUxMKGRldl9wcml2KSkKPiAgCQljYWNoZS0+Y3J0Yy5oc3dfYmR3
X3BpeGVsX3JhdGUgPSBjcnRjX3N0YXRlLT5waXhlbF9yYXRlOwo+ICAKPiBkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9oZG1pLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2hkbWkuYwo+IGluZGV4IDE0ZTM1MGY1ZWNjOC4uZTFkYmY2
NDFiZTc5IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
aGRtaS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9oZG1pLmMK
PiBAQCAtMjc5LDcgKzI3OSw3IEBAIHN0YXRpYyB2b2lkIGlieF93cml0ZV9pbmZvZnJhbWUoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIHsKPiAgCWNvbnN0IHUzMiAqZGF0YSA9IGZy
YW1lOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNv
ZGVyLT5iYXNlLmRldik7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2lu
dGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpp
bnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAJaTkx
NV9yZWdfdCByZWcgPSBUVklERU9fRElQX0NUTChpbnRlbF9jcnRjLT5waXBlKTsKPiAgCXUzMiB2
YWwgPSBJOTE1X1JFQUQocmVnKTsKPiAgCWludCBpOwo+IEBAIC0zMTUsNyArMzE1LDcgQEAgc3Rh
dGljIHZvaWQgaWJ4X3JlYWRfaW5mb2ZyYW1lKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ICAJCQkgICAgICAgdm9pZCAqZnJhbWUsIHNzaXplX3QgbGVuKQo+ICB7Cj4gIAlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsK
PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5i
YXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNy
dGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAl1MzIgdmFsLCAqZGF0YSA9IGZyYW1lOwo+ICAJaW50
IGk7Cj4gIAo+IEBAIC0zMzQsNyArMzM0LDcgQEAgc3RhdGljIHUzMiBpYnhfaW5mb2ZyYW1lc19l
bmFibGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAJCQkJICBjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gIHsKPiAgCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+IC0JZW51
bSBwaXBlIHBpcGUgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT5iYXNlLmNydGMpLT5waXBl
Owo+ICsJZW51bSBwaXBlIHBpcGUgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT51YXBpLmNy
dGMpLT5waXBlOwo+ICAJaTkxNV9yZWdfdCByZWcgPSBUVklERU9fRElQX0NUTChwaXBlKTsKPiAg
CXUzMiB2YWwgPSBJOTE1X1JFQUQocmVnKTsKPiAgCj4gQEAgLTM1Niw3ICszNTYsNyBAQCBzdGF0
aWMgdm9pZCBjcHRfd3JpdGVfaW5mb2ZyYW1lKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ICB7Cj4gIAljb25zdCB1MzIgKmRhdGEgPSBmcmFtZTsKPiAgCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+IC0Jc3RydWN0
IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2Uu
Y3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMo
Y3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCWk5MTVfcmVnX3QgcmVnID0gVFZJREVPX0RJUF9D
VEwoaW50ZWxfY3J0Yy0+cGlwZSk7Cj4gIAl1MzIgdmFsID0gSTkxNV9SRUFEKHJlZyk7Cj4gIAlp
bnQgaTsKPiBAQCAtMzk1LDcgKzM5NSw3IEBAIHN0YXRpYyB2b2lkIGNwdF9yZWFkX2luZm9mcmFt
ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgCQkJICAgICAgIHZvaWQgKmZyYW1l
LCBzc2l6ZV90IGxlbikKPiAgewo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAJ
dTMyIHZhbCwgKmRhdGEgPSBmcmFtZTsKPiAgCWludCBpOwo+ICAKPiBAQCAtNDE0LDcgKzQxNCw3
IEBAIHN0YXRpYyB1MzIgY3B0X2luZm9mcmFtZXNfZW5hYmxlZChzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiAgCQkJCSAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVf
Y29uZmlnKQo+ICB7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAtCWVudW0gcGlwZSBwaXBlID0gdG9faW50ZWxfY3J0
YyhwaXBlX2NvbmZpZy0+YmFzZS5jcnRjKS0+cGlwZTsKPiArCWVudW0gcGlwZSBwaXBlID0gdG9f
aW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+dWFwaS5jcnRjKS0+cGlwZTsKPiAgCXUzMiB2YWwgPSBJ
OTE1X1JFQUQoVFZJREVPX0RJUF9DVEwocGlwZSkpOwo+ICAKPiAgCWlmICgodmFsICYgVklERU9f
RElQX0VOQUJMRSkgPT0gMCkKPiBAQCAtNDMyLDcgKzQzMiw3IEBAIHN0YXRpYyB2b2lkIHZsdl93
cml0ZV9pbmZvZnJhbWUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIHsKPiAgCWNv
bnN0IHUzMiAqZGF0YSA9IGZyYW1lOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAq
aW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiArCXN0
cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51
YXBpLmNydGMpOwo+ICAJaTkxNV9yZWdfdCByZWcgPSBWTFZfVFZJREVPX0RJUF9DVEwoaW50ZWxf
Y3J0Yy0+cGlwZSk7Cj4gIAl1MzIgdmFsID0gSTkxNV9SRUFEKHJlZyk7Cj4gIAlpbnQgaTsKPiBA
QCAtNDY4LDcgKzQ2OCw3IEBAIHN0YXRpYyB2b2lkIHZsdl9yZWFkX2luZm9mcmFtZShzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgCQkJICAgICAgIHZvaWQgKmZyYW1lLCBzc2l6ZV90
IGxlbikKPiAgewo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShlbmNvZGVyLT5iYXNlLmRldik7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAJdTMyIHZhbCwg
KmRhdGEgPSBmcmFtZTsKPiAgCWludCBpOwo+ICAKPiBAQCAtNDg3LDcgKzQ4Nyw3IEBAIHN0YXRp
YyB1MzIgdmx2X2luZm9mcmFtZXNfZW5hYmxlZChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKPiAgCQkJCSAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+
ICB7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29k
ZXItPmJhc2UuZGV2KTsKPiAtCWVudW0gcGlwZSBwaXBlID0gdG9faW50ZWxfY3J0YyhwaXBlX2Nv
bmZpZy0+YmFzZS5jcnRjKS0+cGlwZTsKPiArCWVudW0gcGlwZSBwaXBlID0gdG9faW50ZWxfY3J0
YyhwaXBlX2NvbmZpZy0+dWFwaS5jcnRjKS0+cGlwZTsKPiAgCXUzMiB2YWwgPSBJOTE1X1JFQUQo
VkxWX1RWSURFT19ESVBfQ1RMKHBpcGUpKTsKPiAgCj4gIAlpZiAoKHZhbCAmIFZJREVPX0RJUF9F
TkFCTEUpID09IDApCj4gQEAgLTcwMCw3ICs3MDAsNyBAQCBpbnRlbF9oZG1pX2NvbXB1dGVfYXZp
X2luZm9mcmFtZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgewo+ICAJc3RydWN0
IGhkbWlfYXZpX2luZm9mcmFtZSAqZnJhbWUgPSAmY3J0Y19zdGF0ZS0+aW5mb2ZyYW1lcy5hdmku
YXZpOwo+ICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+
IC0JCSZjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gKwkJJmNydGNfc3RhdGUtPmh3
LmFkanVzdGVkX21vZGU7Cj4gIAlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gY29u
bl9zdGF0ZS0+Y29ubmVjdG9yOwo+ICAJaW50IHJldDsKPiAgCj4gQEAgLTc4Nyw3ICs3ODcsNyBA
QCBpbnRlbF9oZG1pX2NvbXB1dGVfaGRtaV9pbmZvZnJhbWUoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4gIAo+ICAJcmV0ID0gZHJtX2hkbWlfdmVuZG9yX2luZm9mcmFtZV9mcm9tX2Rp
c3BsYXlfbW9kZShmcmFtZSwKPiAgCQkJCQkJCSAgY29ubl9zdGF0ZS0+Y29ubmVjdG9yLAo+IC0J
CQkJCQkJICAmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlKTsKPiArCQkJCQkJCSAgJmNy
dGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGUpOwo+ICAJaWYgKFdBUk5fT04ocmV0KSkKPiAgCQly
ZXR1cm4gZmFsc2U7Cj4gIAo+IEBAIC05NDgsNyArOTQ4LDcgQEAgc3RhdGljIGJvb2wgaW50ZWxf
aGRtaV9zZXRfZ2NwX2luZm9mcmFtZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAg
CQkJCQkgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4gIHsK
PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+
YmFzZS5kZXYpOwo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNy
dGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCWk5MTVfcmVnX3QgcmVnOwo+ICAK
PiAgCWlmICgoY3J0Y19zdGF0ZS0+aW5mb2ZyYW1lcy5lbmFibGUgJgo+IEBAIC05NzMsNyArOTcz
LDcgQEAgdm9pZCBpbnRlbF9oZG1pX3JlYWRfZ2NwX2luZm9mcmFtZShzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKPiAgCQkJCSAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlKQo+ICB7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50
ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNy
dGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlpOTE1X3JlZ190
IHJlZzsKPiAgCj4gIAlpZiAoKGNydGNfc3RhdGUtPmluZm9mcmFtZXMuZW5hYmxlICYKPiBAQCAt
MTAxMCw3ICsxMDEwLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfaGRtaV9jb21wdXRlX2djcF9pbmZv
ZnJhbWUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIAo+ICAJLyogRW5hYmxlIGRl
ZmF1bHRfcGhhc2Ugd2hlbmV2ZXIgdGhlIGRpc3BsYXkgbW9kZSBpcyBzdWl0YWJseSBhbGlnbmVk
ICovCj4gIAlpZiAoZ2NwX2RlZmF1bHRfcGhhc2VfcG9zc2libGUoY3J0Y19zdGF0ZS0+cGlwZV9i
cHAsCj4gLQkJCQkgICAgICAgJmNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZSkpCj4gKwkJ
CQkgICAgICAgJmNydGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGUpKQo+ICAJCWNydGNfc3RhdGUt
PmluZm9mcmFtZXMuZ2NwIHw9IEdDUF9ERUZBVUxUX1BIQVNFX0VOQUJMRTsKPiAgfQo+ICAKPiBA
QCAtMTAyMCw3ICsxMDIwLDcgQEAgc3RhdGljIHZvaWQgaWJ4X3NldF9pbmZvZnJhbWVzKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAJCQkgICAgICAgY29uc3Qgc3RydWN0IGRybV9j
b25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4gIHsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+IC0Jc3RydWN0IGlu
dGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0
Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0
Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVs
X2RpZ19wb3J0ID0gZW5jX3RvX2RpZ19wb3J0KCZlbmNvZGVyLT5iYXNlKTsKPiAgCXN0cnVjdCBp
bnRlbF9oZG1pICppbnRlbF9oZG1pID0gJmludGVsX2RpZ19wb3J0LT5oZG1pOwo+ICAJaTkxNV9y
ZWdfdCByZWcgPSBUVklERU9fRElQX0NUTChpbnRlbF9jcnRjLT5waXBlKTsKPiBAQCAtMTA3OSw3
ICsxMDc5LDcgQEAgc3RhdGljIHZvaWQgY3B0X3NldF9pbmZvZnJhbWVzKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+ICAJCQkgICAgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jf
c3RhdGUgKmNvbm5fc3RhdGUpCj4gIHsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+IC0Jc3RydWN0IGludGVsX2NydGMg
KmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlz
dHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+
dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBpbnRlbF9oZG1pICppbnRlbF9oZG1pID0gZW5jX3RvX2lu
dGVsX2hkbWkoJmVuY29kZXItPmJhc2UpOwo+ICAJaTkxNV9yZWdfdCByZWcgPSBUVklERU9fRElQ
X0NUTChpbnRlbF9jcnRjLT5waXBlKTsKPiAgCXUzMiB2YWwgPSBJOTE1X1JFQUQocmVnKTsKPiBA
QCAtMTEyOCw3ICsxMTI4LDcgQEAgc3RhdGljIHZvaWQgdmx2X3NldF9pbmZvZnJhbWVzKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAJCQkgICAgICAgY29uc3Qgc3RydWN0IGRybV9j
b25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4gIHsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+IC0Jc3RydWN0IGlu
dGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0
Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0
Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBpbnRlbF9oZG1pICppbnRlbF9oZG1pID0g
ZW5jX3RvX2ludGVsX2hkbWkoJmVuY29kZXItPmJhc2UpOwo+ICAJaTkxNV9yZWdfdCByZWcgPSBW
TFZfVFZJREVPX0RJUF9DVEwoaW50ZWxfY3J0Yy0+cGlwZSk7Cj4gIAl1MzIgdmFsID0gSTkxNV9S
RUFEKHJlZyk7Cj4gQEAgLTE3MjQsOSArMTcyNCw5IEBAIHN0YXRpYyB2b2lkIGludGVsX2hkbWlf
cHJlcGFyZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgewo+ICAJc3RydWN0IGRy
bV9kZXZpY2UgKmRldiA9IGVuY29kZXItPmJhc2UuZGV2Owo+ICAJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNy
dGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAg
CXN0cnVjdCBpbnRlbF9oZG1pICppbnRlbF9oZG1pID0gZW5jX3RvX2ludGVsX2hkbWkoJmVuY29k
ZXItPmJhc2UpOwo+IC0JY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21v
ZGUgPSAmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICsJY29uc3Qgc3RydWN0IGRy
bV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRf
bW9kZTsKPiAgCXUzMiBoZG1pX3ZhbDsKPiAgCj4gIAlpbnRlbF9kcF9kdWFsX21vZGVfc2V0X3Rt
ZHNfb3V0cHV0KGludGVsX2hkbWksIHRydWUpOwo+IEBAIC0xODE3LDcgKzE4MTcsNyBAQCBzdGF0
aWMgdm9pZCBpbnRlbF9oZG1pX2dldF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsCj4gIAkgICAgdG1wICYgSERNSV9DT0xPUl9SQU5HRV8xNl8yMzUpCj4gIAkJcGlwZV9jb25m
aWctPmxpbWl0ZWRfY29sb3JfcmFuZ2UgPSB0cnVlOwo+ICAKPiAtCXBpcGVfY29uZmlnLT5iYXNl
LmFkanVzdGVkX21vZGUuZmxhZ3MgfD0gZmxhZ3M7Cj4gKwlwaXBlX2NvbmZpZy0+aHcuYWRqdXN0
ZWRfbW9kZS5mbGFncyB8PSBmbGFnczsKPiAgCj4gIAlpZiAoKHRtcCAmIFNEVk9fQ09MT1JfRk9S
TUFUX01BU0spID09IEhETUlfQ09MT1JfRk9STUFUXzEyYnBjKQo+ICAJCWRvdGNsb2NrID0gcGlw
ZV9jb25maWctPnBvcnRfY2xvY2sgKiAyIC8gMzsKPiBAQCAtMTgyNyw3ICsxODI3LDcgQEAgc3Rh
dGljIHZvaWQgaW50ZWxfaGRtaV9nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyLAo+ICAJaWYgKHBpcGVfY29uZmlnLT5waXhlbF9tdWx0aXBsaWVyKQo+ICAJCWRvdGNsb2Nr
IC89IHBpcGVfY29uZmlnLT5waXhlbF9tdWx0aXBsaWVyOwo+ICAKPiAtCXBpcGVfY29uZmlnLT5i
YXNlLmFkanVzdGVkX21vZGUuY3J0Y19jbG9jayA9IGRvdGNsb2NrOwo+ICsJcGlwZV9jb25maWct
Pmh3LmFkanVzdGVkX21vZGUuY3J0Y19jbG9jayA9IGRvdGNsb2NrOwo+ICAKPiAgCXBpcGVfY29u
ZmlnLT5sYW5lX2NvdW50ID0gNDsKPiAgCj4gQEAgLTE4NDgsNyArMTg0OCw3IEBAIHN0YXRpYyB2
b2lkIGludGVsX2VuYWJsZV9oZG1pX2F1ZGlvKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ICAJCQkJICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywK
PiAgCQkJCSAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkK
PiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29u
ZmlnLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9j
cnRjKHBpcGVfY29uZmlnLT51YXBpLmNydGMpOwo+ICAKPiAgCVdBUk5fT04oIXBpcGVfY29uZmln
LT5oYXNfaGRtaV9zaW5rKTsKPiAgCURSTV9ERUJVR19EUklWRVIoIkVuYWJsaW5nIEhETUkgYXVk
aW8gb24gcGlwZSAlY1xuIiwKPiBAQCAtMTkzNCw3ICsxOTM0LDcgQEAgc3RhdGljIHZvaWQgY3B0
X2VuYWJsZV9oZG1pKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICB7Cj4gIAlzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2ID0gZW5jb2Rlci0+YmFzZS5kZXY7Cj4gIAlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPnVhcGkuY3J0
Yyk7Cj4gIAlzdHJ1Y3QgaW50ZWxfaGRtaSAqaW50ZWxfaGRtaSA9IGVuY190b19pbnRlbF9oZG1p
KCZlbmNvZGVyLT5iYXNlKTsKPiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCXUz
MiB0ZW1wOwo+IEBAIC0xOTk4LDcgKzE5OTgsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxl
X2hkbWkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIAlzdHJ1Y3QgaW50ZWxfaGRt
aSAqaW50ZWxfaGRtaSA9IGVuY190b19pbnRlbF9oZG1pKCZlbmNvZGVyLT5iYXNlKTsKPiAgCXN0
cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0ID0KPiAgCQloZG1pX3RvX2Rp
Z19wb3J0KGludGVsX2hkbWkpOwo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRl
bF9jcnRjKG9sZF9jcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMg
KmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAJdTMy
IHRlbXA7Cj4gIAo+ICAJdGVtcCA9IEk5MTVfUkVBRChpbnRlbF9oZG1pLT5oZG1pX3JlZyk7Cj4g
QEAgLTIxOTgsMTIgKzIxOTgsMTIgQEAgc3RhdGljIGJvb2wgaGRtaV9kZWVwX2NvbG9yX3Bvc3Np
YmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAJCQkJICAg
ICBpbnQgYnBjKQo+ICB7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+
IC0JCXRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+IC0Jc3RydWN0IGRybV9h
dG9taWNfc3RhdGUgKnN0YXRlID0gY3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZTsKPiArCQl0b19pOTE1
KGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsKPiArCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRl
ICpzdGF0ZSA9IGNydGNfc3RhdGUtPnVhcGkuc3RhdGU7Cj4gIAlzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
cl9zdGF0ZSAqY29ubmVjdG9yX3N0YXRlOwo+ICAJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5l
Y3RvcjsKPiAgCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0K
PiAtCQkmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICsJCSZjcnRjX3N0YXRlLT5o
dy5hZGp1c3RlZF9tb2RlOwo+ICAJaW50IGk7Cj4gIAo+ICAJaWYgKEhBU19HTUNIKGRldl9wcml2
KSkKPiBAQCAtMjIyOCw3ICsyMjI4LDcgQEAgc3RhdGljIGJvb2wgaGRtaV9kZWVwX2NvbG9yX3Bv
c3NpYmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAJZm9y
X2VhY2hfbmV3X2Nvbm5lY3Rvcl9pbl9zdGF0ZShzdGF0ZSwgY29ubmVjdG9yLCBjb25uZWN0b3Jf
c3RhdGUsIGkpIHsKPiAgCQljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfaW5mbyAqaW5mbyA9ICZj
b25uZWN0b3ItPmRpc3BsYXlfaW5mbzsKPiAgCj4gLQkJaWYgKGNvbm5lY3Rvcl9zdGF0ZS0+Y3J0
YyAhPSBjcnRjX3N0YXRlLT5iYXNlLmNydGMpCj4gKwkJaWYgKGNvbm5lY3Rvcl9zdGF0ZS0+Y3J0
YyAhPSBjcnRjX3N0YXRlLT51YXBpLmNydGMpCj4gIAkJCWNvbnRpbnVlOwo+ICAKPiAgCQlpZiAo
Y3J0Y19zdGF0ZS0+b3V0cHV0X2Zvcm1hdCA9PSBJTlRFTF9PVVRQVVRfRk9STUFUX1lDQkNSNDIw
KSB7Cj4gQEAgLTIyNjksNyArMjI2OSw3IEBAIHN0YXRpYyBib29sCj4gIGludGVsX2hkbWlfeWNi
Y3I0MjBfY29uZmlnKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCj4gIAkJCSAgIHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjb25maWcpCj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRj
ICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0Yyhjb25maWctPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1
Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY29uZmlnLT51YXBpLmNy
dGMpOwo+ICAKPiAgCWlmICghY29ubmVjdG9yLT55Y2Jjcl80MjBfYWxsb3dlZCkgewo+ICAJCURS
TV9FUlJPUigiUGxhdGZvcm0gZG9lc24ndCBzdXBwb3J0IFlDQkNSNDIwIG91dHB1dFxuIik7Cj4g
QEAgLTIzMjQsNyArMjMyNCw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfaGRtaV9jb21wdXRlX2Nsb2Nr
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICB7Cj4gIAlzdHJ1Y3QgaW50ZWxfaGRt
aSAqaW50ZWxfaGRtaSA9IGVuY190b19pbnRlbF9oZG1pKCZlbmNvZGVyLT5iYXNlKTsKPiAgCWNv
bnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0KPiAtCQkmY3J0Y19z
dGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICsJCSZjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9t
b2RlOwo+ICAJaW50IGJwYywgY2xvY2sgPSBhZGp1c3RlZF9tb2RlLT5jcnRjX2Nsb2NrOwo+ICAK
PiAgCWlmIChhZGp1c3RlZF9tb2RlLT5mbGFncyAmIERSTV9NT0RFX0ZMQUdfREJMQ0xLKQo+IEBA
IC0yMzY2LDcgKzIzNjYsNyBAQCBpbnQgaW50ZWxfaGRtaV9jb21wdXRlX2NvbmZpZyhzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgewo+ICAJc3RydWN0IGludGVsX2hkbWkgKmludGVs
X2hkbWkgPSBlbmNfdG9faW50ZWxfaGRtaSgmZW5jb2Rlci0+YmFzZSk7Cj4gIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAt
CXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmlnLT5i
YXNlLmFkanVzdGVkX21vZGU7Cj4gKwlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRf
bW9kZSA9ICZwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZTsKPiAgCXN0cnVjdCBkcm1fY29u
bmVjdG9yICpjb25uZWN0b3IgPSBjb25uX3N0YXRlLT5jb25uZWN0b3I7Cj4gIAlzdHJ1Y3QgZHJt
X3NjZGMgKnNjZGMgPSAmY29ubmVjdG9yLT5kaXNwbGF5X2luZm8uaGRtaS5zY2RjOwo+ICAJc3Ry
dWN0IGludGVsX2RpZ2l0YWxfY29ubmVjdG9yX3N0YXRlICppbnRlbF9jb25uX3N0YXRlID0KPiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9sc3Bjb24uYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfbHNwY29uLmMKPiBpbmRleCBmOGYx
MzA4NjQzYTkuLjUxNDVmZjhiOTYyYiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2xzcGNvbi5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9sc3Bjb24uYwo+IEBAIC0xODksNyArMTg5LDcgQEAgdm9pZCBsc3Bjb25feWNi
Y3I0MjBfY29uZmlnKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCj4gIHsKPiAgCWNv
bnN0IHN0cnVjdCBkcm1fZGlzcGxheV9pbmZvICppbmZvID0gJmNvbm5lY3Rvci0+ZGlzcGxheV9p
bmZvOwo+ICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+
IC0JCQkJCSZjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gKwkJCQkJJmNydGNfc3Rh
dGUtPmh3LmFkanVzdGVkX21vZGU7Cj4gIAo+ICAJaWYgKGRybV9tb2RlX2lzXzQyMF9vbmx5KGlu
Zm8sIGFkanVzdGVkX21vZGUpICYmCj4gIAkgICAgY29ubmVjdG9yLT55Y2Jjcl80MjBfYWxsb3dl
ZCkgewo+IEBAIC00NzUsNyArNDc1LDcgQEAgdm9pZCBsc3Bjb25fc2V0X2luZm9mcmFtZXMoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0
ICpkaWdfcG9ydCA9IGVuY190b19kaWdfcG9ydCgmZW5jb2Rlci0+YmFzZSk7Cj4gIAlzdHJ1Y3Qg
aW50ZWxfbHNwY29uICpsc3Bjb24gPSAmZGlnX3BvcnQtPmxzcGNvbjsKPiAgCWNvbnN0IHN0cnVj
dCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0KPiAtCQkmY3J0Y19zdGF0ZS0+YmFz
ZS5hZGp1c3RlZF9tb2RlOwo+ICsJCSZjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlOwo+ICAK
PiAgCWlmICghbHNwY29uLT5hY3RpdmUpIHsKPiAgCQlEUk1fRVJST1IoIldyaXRpbmcgaW5mb2Zy
YW1lcyB3aGlsZSBMU1BDT04gZGlzYWJsZWQgP1xuIik7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfbHZkcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF9sdmRzLmMKPiBpbmRleCBjNzg2YWJkYzMzMzYuLjBmNzdlNWE4YjdmZiAx
MDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2x2ZHMuYwo+
ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfbHZkcy5jCj4gQEAgLTEz
NSw3ICsxMzUsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9sdmRzX2dldF9jb25maWcoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIAllbHNlCj4gIAkJZmxhZ3MgfD0gRFJNX01PREVfRkxB
R19QVlNZTkM7Cj4gIAo+IC0JcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5mbGFncyB8
PSBmbGFnczsKPiArCXBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmZsYWdzIHw9IGZsYWdz
Owo+ICAKPiAgCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNSkKPiAgCQlwaXBlX2NvbmZpZy0+
Z21jaF9wZml0Lmx2ZHNfYm9yZGVyX2JpdHMgPQo+IEBAIC0xNDgsNyArMTQ4LDcgQEAgc3RhdGlj
IHZvaWQgaW50ZWxfbHZkc19nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ICAJCXBpcGVfY29uZmlnLT5nbWNoX3BmaXQuY29udHJvbCB8PSB0bXAgJiBQQU5FTF84VE82
X0RJVEhFUl9FTkFCTEU7Cj4gIAl9Cj4gIAo+IC0JcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRf
bW9kZS5jcnRjX2Nsb2NrID0gcGlwZV9jb25maWctPnBvcnRfY2xvY2s7Cj4gKwlwaXBlX2NvbmZp
Zy0+aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrID0gcGlwZV9jb25maWctPnBvcnRfY2xvY2s7
Cj4gIH0KPiAgCj4gIHN0YXRpYyB2b2lkIGludGVsX2x2ZHNfcHBzX2dldF9od19zdGF0ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gQEAgLTIzMCw4ICsyMzAsOCBAQCBzdGF0
aWMgdm9pZCBpbnRlbF9wcmVfZW5hYmxlX2x2ZHMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsCj4gIHsKPiAgCXN0cnVjdCBpbnRlbF9sdmRzX2VuY29kZXIgKmx2ZHNfZW5jb2RlciA9IHRv
X2x2ZHNfZW5jb2RlcigmZW5jb2Rlci0+YmFzZSk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAtCXN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+YmFzZS5jcnRjKTsKPiAt
CWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29u
ZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRv
X2ludGVsX2NydGMocGlwZV9jb25maWctPnVhcGkuY3J0Yyk7Cj4gKwljb25zdCBzdHJ1Y3QgZHJt
X2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRf
bW9kZTsKPiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCXUzMiB0ZW1wOwo+ICAK
PiBAQCAtMzkyLDggKzM5Miw4IEBAIHN0YXRpYyBpbnQgaW50ZWxfbHZkc19jb21wdXRlX2NvbmZp
ZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqaW50ZWxfZW5jb2RlciwKPiAgCQl0b19sdmRzX2VuY29k
ZXIoJmludGVsX2VuY29kZXItPmJhc2UpOwo+ICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqaW50
ZWxfY29ubmVjdG9yID0KPiAgCQlsdmRzX2VuY29kZXItPmF0dGFjaGVkX2Nvbm5lY3RvcjsKPiAt
CXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmlnLT5i
YXNlLmFkanVzdGVkX21vZGU7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRv
X2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgZHJtX2Rpc3Bs
YXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZTsK
PiArCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhwaXBlX2Nv
bmZpZy0+dWFwaS5jcnRjKTsKPiAgCXVuc2lnbmVkIGludCBsdmRzX2JwcDsKPiAgCj4gIAkvKiBT
aG91bGQgbmV2ZXIgaGFwcGVuISEgKi8KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9wYW5lbC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9wYW5lbC5jCj4gaW5kZXggYmMxNGU5YzAyODVhLi42ZjNlYWFlMzc2MWYgMTAwNjQ0Cj4g
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9wYW5lbC5jCj4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9wYW5lbC5jCj4gQEAgLTE3OCw3ICsx
NzgsNyBAQCBpbnRlbF9wY2hfcGFuZWxfZml0dGluZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxf
Y3J0YywKPiAgCQkJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ICAJCQlp
bnQgZml0dGluZ19tb2RlKQo+ICB7Cj4gLQljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAq
YWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICsJY29u
c3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmcGlwZV9jb25maWct
Pmh3LmFkanVzdGVkX21vZGU7Cj4gIAlpbnQgeCA9IDAsIHkgPSAwLCB3aWR0aCA9IDAsIGhlaWdo
dCA9IDA7Cj4gIAo+ICAJLyogTmF0aXZlIG1vZGVzIGRvbid0IG5lZWQgZml0dGluZyAqLwo+IEBA
IC0zMDAsNyArMzAwLDcgQEAgc3RhdGljIGlubGluZSB1MzIgcGFuZWxfZml0dGVyX3NjYWxpbmco
dTMyIHNvdXJjZSwgdTMyIHRhcmdldCkKPiAgc3RhdGljIHZvaWQgaTk2NV9zY2FsZV9hc3BlY3Qo
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ICAJCQkgICAgICB1MzIgKnBm
aXRfY29udHJvbCkKPiAgewo+IC0JY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVz
dGVkX21vZGUgPSAmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPiArCWNvbnN0IHN0
cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmlnLT5ody5h
ZGp1c3RlZF9tb2RlOwo+ICAJdTMyIHNjYWxlZF93aWR0aCA9IGFkanVzdGVkX21vZGUtPmNydGNf
aGRpc3BsYXkgKgo+ICAJCXBpcGVfY29uZmlnLT5waXBlX3NyY19oOwo+ICAJdTMyIHNjYWxlZF9o
ZWlnaHQgPSBwaXBlX2NvbmZpZy0+cGlwZV9zcmNfdyAqCj4gQEAgLTMyMSw3ICszMjEsNyBAQCBz
dGF0aWMgdm9pZCBpOXh4X3NjYWxlX2FzcGVjdChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlw
ZV9jb25maWcsCj4gIAkJCSAgICAgIHUzMiAqcGZpdF9jb250cm9sLCB1MzIgKnBmaXRfcGdtX3Jh
dGlvcywKPiAgCQkJICAgICAgdTMyICpib3JkZXIpCj4gIHsKPiAtCXN0cnVjdCBkcm1fZGlzcGxh
eV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7
Cj4gKwlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZp
Zy0+aHcuYWRqdXN0ZWRfbW9kZTsKPiAgCXUzMiBzY2FsZWRfd2lkdGggPSBhZGp1c3RlZF9tb2Rl
LT5jcnRjX2hkaXNwbGF5ICoKPiAgCQlwaXBlX2NvbmZpZy0+cGlwZV9zcmNfaDsKPiAgCXUzMiBz
Y2FsZWRfaGVpZ2h0ID0gcGlwZV9jb25maWctPnBpcGVfc3JjX3cgKgo+IEBAIC0zODAsNyArMzgw
LDcgQEAgdm9pZCBpbnRlbF9nbWNoX3BhbmVsX2ZpdHRpbmcoc3RydWN0IGludGVsX2NydGMgKmlu
dGVsX2NydGMsCj4gIHsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoaW50ZWxfY3J0Yy0+YmFzZS5kZXYpOwo+ICAJdTMyIHBmaXRfY29udHJvbCA9IDAsIHBm
aXRfcGdtX3JhdGlvcyA9IDAsIGJvcmRlciA9IDA7Cj4gLQlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9k
ZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICsJ
c3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmcGlwZV9jb25maWctPmh3
LmFkanVzdGVkX21vZGU7Cj4gIAo+ICAJLyogTmF0aXZlIG1vZGVzIGRvbid0IG5lZWQgZml0dGlu
ZyAqLwo+ICAJaWYgKGFkanVzdGVkX21vZGUtPmNydGNfaGRpc3BsYXkgPT0gcGlwZV9jb25maWct
PnBpcGVfc3JjX3cgJiYKPiBAQCAtMTA0Nyw3ICsxMDQ3LDcgQEAgc3RhdGljIHZvaWQgdmx2X2Vu
YWJsZV9iYWNrbGlnaHQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
Cj4gIAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IgPSB0b19pbnRlbF9jb25uZWN0
b3IoY29ubl9zdGF0ZS0+Y29ubmVjdG9yKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gIAlzdHJ1Y3QgaW50ZWxf
cGFuZWwgKnBhbmVsID0gJmNvbm5lY3Rvci0+cGFuZWw7Cj4gLQllbnVtIHBpcGUgcGlwZSA9IHRv
X2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKS0+cGlwZTsKPiArCWVudW0gcGlwZSBw
aXBlID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpLT5waXBlOwo+ICAJdTMy
IGN0bCwgY3RsMjsKPiAgCj4gIAljdGwyID0gSTkxNV9SRUFEKFZMVl9CTENfUFdNX0NUTDIocGlw
ZSkpOwo+IEBAIC0xMDc3LDcgKzEwNzcsNyBAQCBzdGF0aWMgdm9pZCBieHRfZW5hYmxlX2JhY2ts
aWdodChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgCXN0cnVj
dCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciA9IHRvX2ludGVsX2Nvbm5lY3Rvcihjb25uX3N0
YXRlLT5jb25uZWN0b3IpOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiAgCXN0cnVjdCBpbnRlbF9wYW5lbCAqcGFu
ZWwgPSAmY29ubmVjdG9yLT5wYW5lbDsKPiAtCWVudW0gcGlwZSBwaXBlID0gdG9faW50ZWxfY3J0
YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpLT5waXBlOwo+ICsJZW51bSBwaXBlIHBpcGUgPSB0b19p
bnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0YyktPnBpcGU7Cj4gIAl1MzIgcHdtX2N0bCwg
dmFsOwo+ICAKPiAgCS8qIENvbnRyb2xsZXIgMSB1c2VzIHRoZSB1dGlsaXR5IHBpbi4gKi8KPiBA
QCAtMTE4OSw3ICsxMTg5LDcgQEAgdm9pZCBpbnRlbF9wYW5lbF9lbmFibGVfYmFja2xpZ2h0KGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAJc3RydWN0IGludGVs
X2Nvbm5lY3RvciAqY29ubmVjdG9yID0gdG9faW50ZWxfY29ubmVjdG9yKGNvbm5fc3RhdGUtPmNv
bm5lY3Rvcik7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ICAJc3RydWN0IGludGVsX3BhbmVsICpwYW5lbCA9ICZj
b25uZWN0b3ItPnBhbmVsOwo+IC0JZW51bSBwaXBlIHBpcGUgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPmJhc2UuY3J0YyktPnBpcGU7Cj4gKwllbnVtIHBpcGUgcGlwZSA9IHRvX2ludGVsX2Ny
dGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKS0+cGlwZTsKPiAgCj4gIAlpZiAoIXBhbmVsLT5iYWNr
bGlnaHQucHJlc2VudCkKPiAgCQlyZXR1cm47Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfcGlwZV9jcmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfcGlwZV9jcmMuYwo+IGluZGV4IDYyNjBhMjA4MjcxOS4uMjc0NjUxMmY0NDY2
IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcGlwZV9j
cmMuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcGlwZV9jcmMu
Ywo+IEBAIC0zMDksMTMgKzMwOSwxMyBAQCBpbnRlbF9jcnRjX2NyY19zZXR1cF93b3JrYXJvdW5k
cyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywgYm9vbCBlbmFibGUpCj4gIAkJZ290byBwdXRfc3Rh
dGU7Cj4gIAl9Cj4gIAo+IC0JcGlwZV9jb25maWctPmJhc2UubW9kZV9jaGFuZ2VkID0gcGlwZV9j
b25maWctPmhhc19wc3I7Cj4gKwlwaXBlX2NvbmZpZy0+dWFwaS5tb2RlX2NoYW5nZWQgPSBwaXBl
X2NvbmZpZy0+aGFzX3BzcjsKPiAgCXBpcGVfY29uZmlnLT5jcmNfZW5hYmxlZCA9IGVuYWJsZTsK
PiAgCj4gIAlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgJiYKPiAtCSAgICBwaXBlX2NvbmZpZy0+
YmFzZS5hY3RpdmUgJiYgY3J0Yy0+cGlwZSA9PSBQSVBFX0EgJiYKPiArCSAgICBwaXBlX2NvbmZp
Zy0+aHcuYWN0aXZlICYmIGNydGMtPnBpcGUgPT0gUElQRV9BICYmCj4gIAkgICAgcGlwZV9jb25m
aWctPmNwdV90cmFuc2NvZGVyID09IFRSQU5TQ09ERVJfRURQKQo+IC0JCXBpcGVfY29uZmlnLT5i
YXNlLm1vZGVfY2hhbmdlZCA9IHRydWU7Cj4gKwkJcGlwZV9jb25maWctPnVhcGkubW9kZV9jaGFu
Z2VkID0gdHJ1ZTsKPiAgCj4gIAlyZXQgPSBkcm1fYXRvbWljX2NvbW1pdChzdGF0ZSk7Cj4gIAo+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Bzci5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9wc3IuYwo+IGluZGV4IGIzYzdlZWY1
M2JmMy4uODk4OGRiZThjMTllIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfcHNyLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX3Bzci5jCj4gQEAgLTUzOCw4ICs1MzgsOCBAQCBzdGF0aWMgYm9vbCBpbnRlbF9wc3IyX2Nv
bmZpZ192YWxpZChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ICAJCQkJICAgIHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiAtCWludCBjcnRjX2hkaXNw
bGF5ID0gY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfaGRpc3BsYXk7Cj4gLQlp
bnQgY3J0Y192ZGlzcGxheSA9IGNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX3Zk
aXNwbGF5Owo+ICsJaW50IGNydGNfaGRpc3BsYXkgPSBjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9t
b2RlLmNydGNfaGRpc3BsYXk7Cj4gKwlpbnQgY3J0Y192ZGlzcGxheSA9IGNydGNfc3RhdGUtPmh3
LmFkanVzdGVkX21vZGUuY3J0Y192ZGlzcGxheTsKPiAgCWludCBwc3JfbWF4X2ggPSAwLCBwc3Jf
bWF4X3YgPSAwOwo+ICAKPiAgCWlmICghZGV2X3ByaXYtPnBzci5zaW5rX3BzcjJfc3VwcG9ydCkK
PiBAQCAtNjA1LDcgKzYwNSw3IEBAIHZvaWQgaW50ZWxfcHNyX2NvbXB1dGVfY29uZmlnKHN0cnVj
dCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdf
cG9ydCA9IGRwX3RvX2RpZ19wb3J0KGludGVsX2RwKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ICAJY29uc3Qgc3RydWN0IGRy
bV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+IC0JCSZjcnRjX3N0YXRlLT5iYXNlLmFk
anVzdGVkX21vZGU7Cj4gKwkJJmNydGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGU7Cj4gIAlpbnQg
cHNyX3NldHVwX3RpbWU7Cj4gIAo+ICAJaWYgKCFDQU5fUFNSKGRldl9wcml2KSkKPiBAQCAtNzQ1
LDcgKzc0NSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3Bzcl9lbmFibGVfbG9ja2VkKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgCj4gIAlkZXZfcHJpdi0+cHNyLnBzcjJfZW5h
YmxlZCA9IGludGVsX3BzcjJfZW5hYmxlZChkZXZfcHJpdiwgY3J0Y19zdGF0ZSk7Cj4gIAlkZXZf
cHJpdi0+cHNyLmJ1c3lfZnJvbnRidWZmZXJfYml0cyA9IDA7Cj4gLQlkZXZfcHJpdi0+cHNyLnBp
cGUgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0YyktPnBpcGU7Cj4gKwlkZXZf
cHJpdi0+cHNyLnBpcGUgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0YyktPnBp
cGU7Cj4gIAlkZXZfcHJpdi0+cHNyLnRyYW5zY29kZXIgPSBjcnRjX3N0YXRlLT5jcHVfdHJhbnNj
b2RlcjsKPiAgCj4gIAkvKgo+IEBAIC05ODgsNyArOTg4LDcgQEAgdm9pZCBpbnRlbF9wc3JfdXBk
YXRlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gIGludCBpbnRlbF9wc3Jfd2FpdF9mb3Jf
aWRsZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUsCj4gIAkJ
CSAgICB1MzIgKm91dF92YWx1ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0
b19pbnRlbF9jcnRjKG5ld19jcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVs
X2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG5ld19jcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+
ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNl
LmRldik7Cj4gIAo+ICAJaWYgKCFkZXZfcHJpdi0+cHNyLmVuYWJsZWQgfHwgIW5ld19jcnRjX3N0
YXRlLT5oYXNfcHNyKQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX3Nkdm8uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc2R2by5j
Cj4gaW5kZXggYWRlYjFjODQwOTc2Li5mNzRjNTI4ZDVkNjggMTAwNjQ0Cj4gLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zZHZvLmMKPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nkdm8uYwo+IEBAIC0xMDg3LDcgKzEwODcsNyBAQCBzdGF0
aWMgYm9vbCBpbnRlbF9zZHZvX2NvbXB1dGVfYXZpX2luZm9mcmFtZShzdHJ1Y3QgaW50ZWxfc2R2
byAqaW50ZWxfc2R2bywKPiAgewo+ICAJc3RydWN0IGhkbWlfYXZpX2luZm9mcmFtZSAqZnJhbWUg
PSAmY3J0Y19zdGF0ZS0+aW5mb2ZyYW1lcy5hdmkuYXZpOwo+ICAJY29uc3Qgc3RydWN0IGRybV9k
aXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+IC0JCSZjcnRjX3N0YXRlLT5iYXNlLmFkanVz
dGVkX21vZGU7Cj4gKwkJJmNydGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGU7Cj4gIAlpbnQgcmV0
Owo+ICAKPiAgCWlmICghY3J0Y19zdGF0ZS0+aGFzX2hkbWlfc2luaykKPiBAQCAtMTI3Niw4ICsx
Mjc2LDggQEAgc3RhdGljIGludCBpbnRlbF9zZHZvX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+ICAJCXRvX2ludGVsX3Nkdm9fY29ubmVjdG9yX3N0YXRlKGNv
bm5fc3RhdGUpOwo+ICAJc3RydWN0IGludGVsX3Nkdm9fY29ubmVjdG9yICppbnRlbF9zZHZvX2Nv
bm5lY3RvciA9Cj4gIAkJdG9faW50ZWxfc2R2b19jb25uZWN0b3IoY29ubl9zdGF0ZS0+Y29ubmVj
dG9yKTsKPiAtCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVf
Y29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gLQlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAq
bW9kZSA9ICZwaXBlX2NvbmZpZy0+YmFzZS5tb2RlOwo+ICsJc3RydWN0IGRybV9kaXNwbGF5X21v
ZGUgKmFkanVzdGVkX21vZGUgPSAmcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGU7Cj4gKwlz
dHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSA9ICZwaXBlX2NvbmZpZy0+aHcubW9kZTsKPiAg
Cj4gIAlEUk1fREVCVUdfS01TKCJmb3JjaW5nIGJwYyB0byA4IGZvciBTRFZPXG4iKTsKPiAgCXBp
cGVfY29uZmlnLT5waXBlX2JwcCA9IDgqMzsKPiBAQCAtMTQyOSwxMyArMTQyOSwxMyBAQCBzdGF0
aWMgdm9pZCBpbnRlbF9zZHZvX3ByZV9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmludGVs
X2VuY29kZXIsCj4gIAkJCQkgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25u
X3N0YXRlKQo+ICB7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGludGVsX2VuY29kZXItPmJhc2UuZGV2KTsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
ID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+IC0JY29uc3Qgc3RydWN0
IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1
c3RlZF9tb2RlOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNy
dGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gKwljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAq
YWRqdXN0ZWRfbW9kZSA9ICZjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlOwo+ICAJY29uc3Qg
c3RydWN0IGludGVsX3Nkdm9fY29ubmVjdG9yX3N0YXRlICpzZHZvX3N0YXRlID0KPiAgCQl0b19p
bnRlbF9zZHZvX2Nvbm5lY3Rvcl9zdGF0ZShjb25uX3N0YXRlKTsKPiAgCWNvbnN0IHN0cnVjdCBp
bnRlbF9zZHZvX2Nvbm5lY3RvciAqaW50ZWxfc2R2b19jb25uZWN0b3IgPQo+ICAJCXRvX2ludGVs
X3Nkdm9fY29ubmVjdG9yKGNvbm5fc3RhdGUtPmNvbm5lY3Rvcik7Cj4gLQljb25zdCBzdHJ1Y3Qg
ZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSA9ICZjcnRjX3N0YXRlLT5iYXNlLm1vZGU7Cj4gKwljb25z
dCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSA9ICZjcnRjX3N0YXRlLT5ody5tb2RlOwo+
ICAJc3RydWN0IGludGVsX3Nkdm8gKmludGVsX3Nkdm8gPSB0b19zZHZvKGludGVsX2VuY29kZXIp
Owo+ICAJdTMyIHNkdm94Owo+ICAJc3RydWN0IGludGVsX3Nkdm9faW5fb3V0X21hcCBpbl9vdXQ7
Cj4gQEAgLTE2MjksNyArMTYyOSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3Nkdm9fZ2V0X2NvbmZp
ZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgCQkJZmxhZ3MgfD0gRFJNX01PREVf
RkxBR19OVlNZTkM7Cj4gIAl9Cj4gIAo+IC0JcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9k
ZS5mbGFncyB8PSBmbGFnczsKPiArCXBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmZsYWdz
IHw9IGZsYWdzOwo+ICAKPiAgCS8qCj4gIAkgKiBwaXhlbCBtdWx0aXBsaWVyIHJlYWRvdXQgaXMg
dHJpY2t5OiBPbmx5IG9uIGk5MTVnL2dtIGl0IGlzIHN0b3JlZCBpbgo+IEBAIC0xNjQ5LDcgKzE2
NDksNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9zZHZvX2dldF9jb25maWcoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmVuY29kZXIsCj4gIAlpZiAocGlwZV9jb25maWctPnBpeGVsX211bHRpcGxpZXIpCj4g
IAkJZG90Y2xvY2sgLz0gcGlwZV9jb25maWctPnBpeGVsX211bHRpcGxpZXI7Cj4gIAo+IC0JcGlw
ZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrID0gZG90Y2xvY2s7Cj4gKwlw
aXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrID0gZG90Y2xvY2s7Cj4gIAo+
ICAJLyogQ3Jvc3MgY2hlY2sgdGhlIHBvcnQgcGl4ZWwgbXVsdGlwbGllciB3aXRoIHRoZSBzZHZv
IGVuY29kZXIgc3RhdGUuICovCj4gIAlpZiAoaW50ZWxfc2R2b19nZXRfdmFsdWUoaW50ZWxfc2R2
bywgU0RWT19DTURfR0VUX0NMT0NLX1JBVEVfTVVMVCwKPiBAQCAtMTcwMSw3ICsxNzAxLDcgQEAg
c3RhdGljIHZvaWQgaW50ZWxfc2R2b19lbmFibGVfYXVkaW8oc3RydWN0IGludGVsX3Nkdm8gKmlu
dGVsX3Nkdm8sCj4gIAkJCQkgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNv
bm5fc3RhdGUpCj4gIHsKPiAgCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3Rl
ZF9tb2RlID0KPiAtCQkmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICsJCSZjcnRj
X3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlOwo+ICAJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5l
Y3RvciA9IGNvbm5fc3RhdGUtPmNvbm5lY3RvcjsKPiAgCXU4ICplbGQgPSBjb25uZWN0b3ItPmVs
ZDsKPiAgCj4gQEAgLTE3MjMsNyArMTcyMyw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2Rpc2FibGVf
c2R2byhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgewo+ICAJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gIAlz
dHJ1Y3QgaW50ZWxfc2R2byAqaW50ZWxfc2R2byA9IHRvX3Nkdm8oZW5jb2Rlcik7Cj4gLQlzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMob2xkX2NydGNfc3RhdGUtPmJhc2Uu
Y3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMob2xkX2Ny
dGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAl1MzIgdGVtcDsKPiAgCj4gIAlpZiAob2xkX2NydGNf
c3RhdGUtPmhhc19hdWRpbykKPiBAQCAtMTc4NSw3ICsxNzg1LDcgQEAgc3RhdGljIHZvaWQgaW50
ZWxfZW5hYmxlX3Nkdm8oc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIAlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2ID0gZW5jb2Rlci0+YmFzZS5kZXY7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gIAlzdHJ1Y3QgaW50ZWxfc2R2byAq
aW50ZWxfc2R2byA9IHRvX3Nkdm8oZW5jb2Rlcik7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50
ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1
Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPnVh
cGkuY3J0Yyk7Cj4gIAl1MzIgdGVtcDsKPiAgCWJvb2wgaW5wdXQxLCBpbnB1dDI7Cj4gIAlpbnQg
aTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zcHJp
dGUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3ByaXRlLmMKPiBpbmRl
eCA3YTcwNzhkMGJhMjMuLmE2MDJlMjFjNWZkNSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nwcml0ZS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9zcHJpdGUuYwo+IEBAIC04MSw5ICs4MSw5IEBAIGludCBpbnRlbF91
c2Vjc190b19zY2FubGluZXMoY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVk
X21vZGUsCj4gICAqLwo+ICB2b2lkIGludGVsX3BpcGVfdXBkYXRlX3N0YXJ0KGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVs
X2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG5ld19jcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+
ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG5ld19jcnRjX3N0YXRl
LT51YXBpLmNydGMpOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShjcnRjLT5iYXNlLmRldik7Cj4gLQljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAq
YWRqdXN0ZWRfbW9kZSA9ICZuZXdfY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICsJ
Y29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmbmV3X2NydGNf
c3RhdGUtPmh3LmFkanVzdGVkX21vZGU7Cj4gIAlsb25nIHRpbWVvdXQgPSBtc2Vjc190b19qaWZm
aWVzX3RpbWVvdXQoMSk7Cj4gIAlpbnQgc2NhbmxpbmUsIG1pbiwgbWF4LCB2Ymxhbmtfc3RhcnQ7
Cj4gIAl3YWl0X3F1ZXVlX2hlYWRfdCAqd3EgPSBkcm1fY3J0Y192Ymxhbmtfd2FpdHF1ZXVlKCZj
cnRjLT5iYXNlKTsKPiBAQCAtMTkwLDcgKzE5MCw3IEBAIHZvaWQgaW50ZWxfcGlwZV91cGRhdGVf
c3RhcnQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+ICAg
Ki8KPiAgdm9pZCBpbnRlbF9waXBlX3VwZGF0ZV9lbmQoc3RydWN0IGludGVsX2NydGNfc3RhdGUg
Km5ld19jcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMobmV3X2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YyA9IHRvX2ludGVsX2NydGMobmV3X2NydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAll
bnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gIAlpbnQgc2NhbmxpbmVfZW5kID0gaW50ZWxf
Z2V0X2NydGNfc2NhbmxpbmUoY3J0Yyk7Cj4gIAl1MzIgZW5kX3ZibF9jb3VudCA9IGludGVsX2Ny
dGNfZ2V0X3ZibGFua19jb3VudGVyKGNydGMpOwo+IEBAIC0yMDMsMTQgKzIwMywxNSBAQCB2b2lk
IGludGVsX3BpcGVfdXBkYXRlX2VuZChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNf
c3RhdGUpCj4gIAkgKiBXb3VsZCBiZSBzbGlnaHRseSBuaWNlIHRvIGp1c3QgZ3JhYiB0aGUgdmJs
YW5rIGNvdW50IGFuZCBhcm0gdGhlCj4gIAkgKiBldmVudCBvdXRzaWRlIG9mIHRoZSBjcml0aWNh
bCBzZWN0aW9uIC0gdGhlIHNwaW5sb2NrIG1pZ2h0IHNwaW4gZm9yIGEKPiAgCSAqIHdoaWxlIC4u
LiAqLwo+IC0JaWYgKG5ld19jcnRjX3N0YXRlLT5iYXNlLmV2ZW50KSB7Cj4gKwlpZiAobmV3X2Ny
dGNfc3RhdGUtPnVhcGkuZXZlbnQpIHsKPiAgCQlXQVJOX09OKGRybV9jcnRjX3ZibGFua19nZXQo
JmNydGMtPmJhc2UpICE9IDApOwo+ICAKPiAgCQlzcGluX2xvY2soJmNydGMtPmJhc2UuZGV2LT5l
dmVudF9sb2NrKTsKPiAtCQlkcm1fY3J0Y19hcm1fdmJsYW5rX2V2ZW50KCZjcnRjLT5iYXNlLCBu
ZXdfY3J0Y19zdGF0ZS0+YmFzZS5ldmVudCk7Cj4gKwkJZHJtX2NydGNfYXJtX3ZibGFua19ldmVu
dCgmY3J0Yy0+YmFzZSwKPiArCQkJCSAgICAgICAgICBuZXdfY3J0Y19zdGF0ZS0+dWFwaS5ldmVu
dCk7Cj4gIAkJc3Bpbl91bmxvY2soJmNydGMtPmJhc2UuZGV2LT5ldmVudF9sb2NrKTsKPiAgCj4g
LQkJbmV3X2NydGNfc3RhdGUtPmJhc2UuZXZlbnQgPSBOVUxMOwo+ICsJCW5ld19jcnRjX3N0YXRl
LT51YXBpLmV2ZW50ID0gTlVMTDsKPiAgCX0KPiAgCj4gIAlsb2NhbF9pcnFfZW5hYmxlKCk7Cj4g
QEAgLTE1MTUsNyArMTUxNiw3IEBAIGc0eF9zcHJpdGVfY2hlY2tfc2NhbGluZyhzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgCWNvbnN0IHN0cnVjdCBkcm1fcmVjdCAqZHN0
ID0gJnBsYW5lX3N0YXRlLT5iYXNlLmRzdDsKPiAgCWludCBzcmNfeCwgc3JjX3csIHNyY19oLCBj
cnRjX3csIGNydGNfaDsKPiAgCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3Rl
ZF9tb2RlID0KPiAtCQkmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICsJCSZjcnRj
X3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlOwo+ICAJdW5zaWduZWQgaW50IGNwcCA9IGZiLT5mb3Jt
YXQtPmNwcFswXTsKPiAgCXVuc2lnbmVkIGludCB3aWR0aF9ieXRlczsKPiAgCWludCBtaW5fd2lk
dGgsIG1pbl9oZWlnaHQ7Cj4gQEAgLTE1ODcsNyArMTU4OCw3IEBAIGc0eF9zcHJpdGVfY2hlY2so
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gIAl9Cj4gIAo+ICAJcmV0ID0g
ZHJtX2F0b21pY19oZWxwZXJfY2hlY2tfcGxhbmVfc3RhdGUoJnBsYW5lX3N0YXRlLT5iYXNlLAo+
IC0JCQkJCQkgICZjcnRjX3N0YXRlLT5iYXNlLAo+ICsJCQkJCQkgICZjcnRjX3N0YXRlLT51YXBp
LAo+ICAJCQkJCQkgIG1pbl9zY2FsZSwgbWF4X3NjYWxlLAo+ICAJCQkJCQkgIHRydWUsIHRydWUp
Owo+ICAJaWYgKHJldCkKPiBAQCAtMTY0NCw3ICsxNjQ1LDcgQEAgdmx2X3Nwcml0ZV9jaGVjayhz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgCQlyZXR1cm4gcmV0Owo+ICAK
PiAgCXJldCA9IGRybV9hdG9taWNfaGVscGVyX2NoZWNrX3BsYW5lX3N0YXRlKCZwbGFuZV9zdGF0
ZS0+YmFzZSwKPiAtCQkJCQkJICAmY3J0Y19zdGF0ZS0+YmFzZSwKPiArCQkJCQkJICAmY3J0Y19z
dGF0ZS0+dWFwaSwKPiAgCQkJCQkJICBEUk1fUExBTkVfSEVMUEVSX05PX1NDQUxJTkcsCj4gIAkJ
CQkJCSAgRFJNX1BMQU5FX0hFTFBFUl9OT19TQ0FMSU5HLAo+ICAJCQkJCQkgIHRydWUsIHRydWUp
Owo+IEBAIC0xNzI4LDggKzE3MjksOCBAQCBzdGF0aWMgaW50IHNrbF9wbGFuZV9jaGVja19mYihj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgCX0KPiAgCj4gIAkv
KiBZLXRpbGluZyBpcyBub3Qgc3VwcG9ydGVkIGluIElGLUlEIEludGVybGFjZSBtb2RlICovCj4g
LQlpZiAoY3J0Y19zdGF0ZS0+YmFzZS5lbmFibGUgJiYKPiAtCSAgICBjcnRjX3N0YXRlLT5iYXNl
LmFkanVzdGVkX21vZGUuZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX0lOVEVSTEFDRSAmJgo+ICsJaWYg
KGNydGNfc3RhdGUtPmh3LmVuYWJsZSAmJgo+ICsJICAgIGNydGNfc3RhdGUtPmh3LmFkanVzdGVk
X21vZGUuZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX0lOVEVSTEFDRSAmJgo+ICAJICAgIChmYi0+bW9k
aWZpZXIgPT0gSTkxNV9GT1JNQVRfTU9EX1lfVElMRUQgfHwKPiAgCSAgICAgZmItPm1vZGlmaWVy
ID09IEk5MTVfRk9STUFUX01PRF9ZZl9USUxFRCB8fAo+ICAJICAgICBmYi0+bW9kaWZpZXIgPT0g
STkxNV9GT1JNQVRfTU9EX1lfVElMRURfQ0NTIHx8Cj4gQEAgLTE4MDksNyArMTgxMCw3IEBAIHN0
YXRpYyBpbnQgc2tsX3BsYW5lX2NoZWNrKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlLAo+ICAJfQo+ICAKPiAgCXJldCA9IGRybV9hdG9taWNfaGVscGVyX2NoZWNrX3BsYW5lX3N0
YXRlKCZwbGFuZV9zdGF0ZS0+YmFzZSwKPiAtCQkJCQkJICAmY3J0Y19zdGF0ZS0+YmFzZSwKPiAr
CQkJCQkJICAmY3J0Y19zdGF0ZS0+dWFwaSwKPiAgCQkJCQkJICBtaW5fc2NhbGUsIG1heF9zY2Fs
ZSwKPiAgCQkJCQkJICB0cnVlLCB0cnVlKTsKPiAgCWlmIChyZXQpCj4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfdHYuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfdHYuYwo+IGluZGV4IGI3MDIyMWY1MTEyYS4uOTZhM2Q5MzQ4NDcx
IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfdHYuYwo+
ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfdHYuYwo+IEBAIC05MjQs
NyArOTI0LDcgQEAgaW50ZWxfZW5hYmxlX3R2KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ICAKPiAgCS8qIFByZXZlbnRzIHZibGFuayB3YWl0cyBmcm9tIHRpbWluZyBvdXQgaW4gaW50
ZWxfdHZfZGV0ZWN0X3R5cGUoKSAqLwo+ICAJaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGRldl9wcml2
LAo+IC0JCQkgICAgICB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT5iYXNlLmNydGMpLT5waXBl
KTsKPiArCQkJICAgICAgdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+dWFwaS5jcnRjKS0+cGlw
ZSk7Cj4gIAo+ICAJSTkxNV9XUklURShUVl9DVEwsIEk5MTVfUkVBRChUVl9DVEwpIHwgVFZfRU5D
X0VOQUJMRSk7Cj4gIH0KPiBAQCAtMTA4Niw3ICsxMDg2LDcgQEAgaW50ZWxfdHZfZ2V0X2NvbmZp
ZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgewo+ICAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gIAlzdHJ1
Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9Cj4gLQkJJnBpcGVfY29uZmlnLT5i
YXNlLmFkanVzdGVkX21vZGU7Cj4gKwkJJnBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlOwo+
ICAJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgbW9kZSA9IHt9Owo+ICAJdTMyIHR2X2N0bCwgaGN0
bDEsIGhjdGwzLCB2Y3RsMSwgdmN0bDIsIHRtcDsKPiAgCXN0cnVjdCB0dl9tb2RlIHR2X21vZGUg
PSB7fTsKPiBAQCAtMTE4OSw3ICsxMTg5LDcgQEAgaW50ZWxfdHZfY29tcHV0ZV9jb25maWcoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIAkJdG9faW50ZWxfdHZfY29ubmVjdG9yX3N0
YXRlKGNvbm5fc3RhdGUpOwo+ICAJY29uc3Qgc3RydWN0IHR2X21vZGUgKnR2X21vZGUgPSBpbnRl
bF90dl9tb2RlX2ZpbmQoY29ubl9zdGF0ZSk7Cj4gIAlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAq
YWRqdXN0ZWRfbW9kZSA9Cj4gLQkJJnBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4g
KwkJJnBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlOwo+ICAJaW50IGhkaXNwbGF5ID0gYWRq
dXN0ZWRfbW9kZS0+Y3J0Y19oZGlzcGxheTsKPiAgCWludCB2ZGlzcGxheSA9IGFkanVzdGVkX21v
ZGUtPmNydGNfdmRpc3BsYXk7Cj4gIAo+IEBAIC0xNDE4LDcgKzE0MTgsNyBAQCBzdGF0aWMgdm9p
ZCBpbnRlbF90dl9wcmVfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAJ
CQkJY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4gIHsKPiAg
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFz
ZS5kZXYpOwo+IC0Jc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRj
KHBpcGVfY29uZmlnLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmludGVsX2Ny
dGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT51YXBpLmNydGMpOwo+ICAJc3RydWN0IGlu
dGVsX3R2ICppbnRlbF90diA9IGVuY190b190dihlbmNvZGVyKTsKPiAgCWNvbnN0IHN0cnVjdCBp
bnRlbF90dl9jb25uZWN0b3Jfc3RhdGUgKnR2X2Nvbm5fc3RhdGUgPQo+ICAJCXRvX2ludGVsX3R2
X2Nvbm5lY3Rvcl9zdGF0ZShjb25uX3N0YXRlKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF92ZHNjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX3Zkc2MuYwo+IGluZGV4IGQ0ZmI3ZjE2ZjlmNi4uMzhjMTgxNDk5NTA1IDEwMDY0
NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfdmRzYy5jCj4gKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF92ZHNjLmMKPiBAQCAtMzI5LDgg
KzMyOSw4IEBAIGludCBpbnRlbF9kcF9jb21wdXRlX2RzY19wYXJhbXMoc3RydWN0IGludGVsX2Rw
ICppbnRlbF9kcCwKPiAgCWludCBjb2x1bW5faW5kZXggPSAwOwo+ICAJdTggbGluZV9idWZfZGVw
dGggPSAwOwo+ICAKPiAtCXZkc2NfY2ZnLT5waWNfd2lkdGggPSBwaXBlX2NvbmZpZy0+YmFzZS5h
ZGp1c3RlZF9tb2RlLmNydGNfaGRpc3BsYXk7Cj4gLQl2ZHNjX2NmZy0+cGljX2hlaWdodCA9IHBp
cGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y192ZGlzcGxheTsKPiArCXZkc2NfY2Zn
LT5waWNfd2lkdGggPSBwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2hkaXNwbGF5
Owo+ICsJdmRzY19jZmctPnBpY19oZWlnaHQgPSBwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9k
ZS5jcnRjX3ZkaXNwbGF5Owo+ICAJdmRzY19jZmctPnNsaWNlX3dpZHRoID0gRElWX1JPVU5EX1VQ
KHZkc2NfY2ZnLT5waWNfd2lkdGgsCj4gIAkJCQkJICAgICBwaXBlX2NvbmZpZy0+ZHNjX3BhcmFt
cy5zbGljZV9jb3VudCk7Cj4gIAkvKgo+IEBAIC00NTksNyArNDU5LDcgQEAgaW50IGludGVsX2Rw
X2NvbXB1dGVfZHNjX3BhcmFtcyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ICBlbnVtIGlu
dGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluCj4gIGludGVsX2RzY19wb3dlcl9kb21haW4oY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+
dWFwaS5jcnRjLT5kZXYpOwo+ICAJZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0gY3J0
Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXI7Cj4gIAo+ICAJLyoKPiBAQCAtNDgzLDcgKzQ4Myw3IEBA
IGludGVsX2RzY19wb3dlcl9kb21haW4oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUpCj4gIHN0YXRpYyB2b2lkIGludGVsX2NvbmZpZ3VyZV9wcHNfZm9yX2RzY19lbmNv
ZGVyKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAJCQkJCQljb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMg
KmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsK
PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+
YmFzZS5kZXYpOwo+ICAJY29uc3Qgc3RydWN0IGRybV9kc2NfY29uZmlnICp2ZHNjX2NmZyA9ICZj
cnRjX3N0YXRlLT5kcF9kc2NfY2ZnOwo+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+
IEBAIC05MDIsNyArOTAyLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHBfd3JpdGVfZHNjX3Bwc19z
ZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIHZvaWQgaW50ZWxfZHNjX2VuYWJs
ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgCQkgICAgICBjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMg
KmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsK
PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+
YmFzZS5kZXYpOwo+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAJaTkxNV9yZWdf
dCBkc3NfY3RsMV9yZWcsIGRzc19jdGwyX3JlZzsKPiBAQCAtOTM4LDcgKzkzOCw3IEBAIHZvaWQg
aW50ZWxfZHNjX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgCj4gIHZv
aWQgaW50ZWxfZHNjX2Rpc2FibGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9j
cnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2Ny
dGMob2xkX2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YyA9IHRvX2ludGVsX2NydGMob2xkX2NydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAg
CWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCWk5MTVfcmVnX3QgZHNzX2N0bDFfcmVn
LCBkc3NfY3RsMl9yZWc7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvdmx2X2RzaS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS92bHZfZHNpLmMKPiBp
bmRleCA1MDA2NGNkZTA3MjQuLjE2ZjkzZDFlNzFlNSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L3Zsdl9kc2kuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvdmx2X2RzaS5jCj4gQEAgLTI2MSw5ICsyNjEsOSBAQCBzdGF0aWMgaW50IGludGVs
X2RzaV9jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgCXN0
cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGNvbnRhaW5lcl9vZihlbmNvZGVyLCBzdHJ1Y3Qg
aW50ZWxfZHNpLAo+ICAJCQkJCQkgICBiYXNlKTsKPiAgCXN0cnVjdCBpbnRlbF9jb25uZWN0b3Ig
KmludGVsX2Nvbm5lY3RvciA9IGludGVsX2RzaS0+YXR0YWNoZWRfY29ubmVjdG9yOwo+IC0Jc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT5iYXNlLmNy
dGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29u
ZmlnLT51YXBpLmNydGMpOwo+ICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmZpeGVk
X21vZGUgPSBpbnRlbF9jb25uZWN0b3ItPnBhbmVsLmZpeGVkX21vZGU7Cj4gLQlzdHJ1Y3QgZHJt
X2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3Rl
ZF9tb2RlOwo+ICsJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmcGlw
ZV9jb25maWctPmh3LmFkanVzdGVkX21vZGU7Cj4gIAlpbnQgcmV0Owo+ICAKPiAgCURSTV9ERUJV
R19LTVMoIlxuIik7Cj4gQEAgLTYyNCw3ICs2MjQsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kc2lf
cG9ydF9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIAkJCQkgIGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiAt
CXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNl
LmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBlbmNf
dG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiAgCWVudW0gcG9ydCBwb3J0Owo+ICAKPiBA
QCAtNzQ2LDcgKzc0Niw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RzaV9wcmVfZW5hYmxlKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICAJCQkJIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVj
dG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ICB7Cj4gIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9k
c2kgPSBlbmNfdG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiAtCXN0cnVjdCBkcm1fY3J0
YyAqY3J0YyA9IHBpcGVfY29uZmlnLT5iYXNlLmNydGM7Cj4gKwlzdHJ1Y3QgZHJtX2NydGMgKmNy
dGMgPSBwaXBlX2NvbmZpZy0+dWFwaS5jcnRjOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5kZXYpOwo+ICAJc3RydWN0IGludGVsX2NydGMgKmlu
dGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGMpOwo+ICAJZW51bSBwaXBlIHBpcGUgPSBpbnRl
bF9jcnRjLT5waXBlOwo+IEBAIC0xMDMyLDkgKzEwMzIsOSBAQCBzdGF0aWMgdm9pZCBieHRfZHNp
X2dldF9waXBlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgCXN0cnVj
dCBkcm1fZGV2aWNlICpkZXYgPSBlbmNvZGVyLT5iYXNlLmRldjsKPiAgCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiAgCXN0cnVjdCBkcm1fZGlzcGxh
eV9tb2RlICphZGp1c3RlZF9tb2RlID0KPiAtCQkJCQkmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0
ZWRfbW9kZTsKPiArCQkJCQkmcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGU7Cj4gIAlzdHJ1
Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZV9zdzsKPiAtCXN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+YmFzZS5jcnRjKTsKPiArCXN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+dWFwaS5j
cnRjKTsKPiAgCXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGVuY190b19pbnRlbF9kc2ko
JmVuY29kZXItPmJhc2UpOwo+ICAJdW5zaWduZWQgaW50IGxhbmVfY291bnQgPSBpbnRlbF9kc2kt
PmxhbmVfY291bnQ7Cj4gIAl1bnNpZ25lZCBpbnQgYnBwLCBmbXQ7Cj4gQEAgLTEwNDUsNyArMTA0
NSw3IEBAIHN0YXRpYyB2b2lkIGJ4dF9kc2lfZ2V0X3BpcGVfY29uZmlnKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+ICAJCQkJY3J0Y19oYmxhbmtfc3RhcnRfc3csIGNydGNfaGJsYW5r
X2VuZF9zdzsKPiAgCj4gIAkvKiBGSVhNRTogaHcgcmVhZG91dCBzaG91bGQgbm90IGRlcGVuZCBv
biBTVyBzdGF0ZSAqLwo+IC0JYWRqdXN0ZWRfbW9kZV9zdyA9ICZjcnRjLT5jb25maWctPmJhc2Uu
YWRqdXN0ZWRfbW9kZTsKPiArCWFkanVzdGVkX21vZGVfc3cgPSAmY3J0Yy0+Y29uZmlnLT5ody5h
ZGp1c3RlZF9tb2RlOwo+ICAKPiAgCS8qCj4gIAkgKiBBdGxlYXN0IG9uZSBwb3J0IGlzIGFjdGl2
ZSBhcyBlbmNvZGVyLT5nZXRfY29uZmlnIGNhbGxlZCBvbmx5IGlmCj4gQEAgLTEyMDQsNyArMTIw
NCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RzaV9nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyLAo+ICAJfQo+ICAKPiAgCWlmIChwY2xrKSB7Cj4gLQkJcGlwZV9jb25maWct
PmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrID0gcGNsazsKPiArCQlwaXBlX2NvbmZpZy0+
aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrID0gcGNsazsKPiAgCQlwaXBlX2NvbmZpZy0+cG9y
dF9jbG9jayA9IHBjbGs7Cj4gIAl9Cj4gIH0KPiBAQCAtMTMxNSw5ICsxMzE1LDkgQEAgc3RhdGlj
IHZvaWQgaW50ZWxfZHNpX3ByZXBhcmUoc3RydWN0IGludGVsX2VuY29kZXIgKmludGVsX2VuY29k
ZXIsCj4gIAlzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIgPSAmaW50ZWxfZW5jb2Rlci0+YmFz
ZTsKPiAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBlbmNvZGVyLT5kZXY7Cj4gIAlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gLQlzdHJ1Y3QgaW50
ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0
Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMocGlw
ZV9jb25maWctPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBl
bmNfdG9faW50ZWxfZHNpKGVuY29kZXIpOwo+IC0JY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21v
ZGUgKmFkanVzdGVkX21vZGUgPSAmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPiAr
CWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29u
ZmlnLT5ody5hZGp1c3RlZF9tb2RlOwo+ICAJZW51bSBwb3J0IHBvcnQ7Cj4gIAl1bnNpZ25lZCBp
bnQgYnBwID0gbWlwaV9kc2lfcGl4ZWxfZm9ybWF0X3RvX2JwcChpbnRlbF9kc2ktPnBpeGVsX2Zv
cm1hdCk7Cj4gIAl1MzIgdmFsLCB0bXA7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZGVidWdmcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMK
PiBpbmRleCA0M2RiNTAwOTUyNTcuLjFjNGMzOTcyZmQyMyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZGVidWdmcy5jCj4gQEAgLTI3NDksMTEgKzI3NDksMTEgQEAgc3RhdGljIGludCBpOTE1
X2Rpc3BsYXlfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKPiAgCj4gIAkJ
c2VxX3ByaW50ZihtLCAiQ1JUQyAlZDogcGlwZTogJWMsIGFjdGl2ZT0lcywgKHNpemU9JWR4JWQp
LCBkaXRoZXI9JXMsIGJwcD0lZFxuIiwKPiAgCQkJICAgY3J0Yy0+YmFzZS5iYXNlLmlkLCBwaXBl
X25hbWUoY3J0Yy0+cGlwZSksCj4gLQkJCSAgIHllc25vKHBpcGVfY29uZmlnLT5iYXNlLmFjdGl2
ZSksCj4gKwkJCSAgIHllc25vKHBpcGVfY29uZmlnLT5ody5hY3RpdmUpLAo+ICAJCQkgICBwaXBl
X2NvbmZpZy0+cGlwZV9zcmNfdywgcGlwZV9jb25maWctPnBpcGVfc3JjX2gsCj4gIAkJCSAgIHll
c25vKHBpcGVfY29uZmlnLT5kaXRoZXIpLCBwaXBlX2NvbmZpZy0+cGlwZV9icHApOwo+ICAKPiAt
CQlpZiAocGlwZV9jb25maWctPmJhc2UuYWN0aXZlKSB7Cj4gKwkJaWYgKHBpcGVfY29uZmlnLT5o
dy5hY3RpdmUpIHsKPiAgCQkJc3RydWN0IGludGVsX3BsYW5lICpjdXJzb3IgPQo+ICAJCQkJdG9f
aW50ZWxfcGxhbmUoY3J0Yy0+YmFzZS5jdXJzb3IpOwo+ICAKPiBAQCAtNDIwNCwxMSArNDIwNCwx
MSBAQCBzdGF0aWMgaW50IGk5MTVfZHJyc19jdGxfc2V0KHZvaWQgKmRhdGEsIHU2NCB2YWwpCj4g
IAo+ICAJCWNydGNfc3RhdGUgPSB0b19pbnRlbF9jcnRjX3N0YXRlKGNydGMtPmJhc2Uuc3RhdGUp
Owo+ICAKPiAtCQlpZiAoIWNydGNfc3RhdGUtPmJhc2UuYWN0aXZlIHx8Cj4gKwkJaWYgKCFjcnRj
X3N0YXRlLT5ody5hY3RpdmUgfHwKPiAgCQkgICAgIWNydGNfc3RhdGUtPmhhc19kcnJzKQo+ICAJ
CQlnb3RvIG91dDsKPiAgCj4gLQkJY29tbWl0ID0gY3J0Y19zdGF0ZS0+YmFzZS5jb21taXQ7Cj4g
KwkJY29tbWl0ID0gY3J0Y19zdGF0ZS0+dWFwaS5jb21taXQ7Cj4gIAkJaWYgKGNvbW1pdCkgewo+
ICAJCQlyZXQgPSB3YWl0X2Zvcl9jb21wbGV0aW9uX2ludGVycnVwdGlibGUoJmNvbW1pdC0+aHdf
ZG9uZSk7Cj4gIAkJCWlmIChyZXQpCj4gQEAgLTQyMjAsNyArNDIyMCw3IEBAIHN0YXRpYyBpbnQg
aTkxNV9kcnJzX2N0bF9zZXQodm9pZCAqZGF0YSwgdTY0IHZhbCkKPiAgCQkJc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXI7Cj4gIAkJCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHA7Cj4gIAo+
IC0JCQlpZiAoIShjcnRjX3N0YXRlLT5iYXNlLmNvbm5lY3Rvcl9tYXNrICYKPiArCQkJaWYgKCEo
Y3J0Y19zdGF0ZS0+dWFwaS5jb25uZWN0b3JfbWFzayAmCj4gIAkJCSAgICAgIGRybV9jb25uZWN0
b3JfbWFzayhjb25uZWN0b3IpKSkKPiAgCQkJCWNvbnRpbnVlOwo+ICAKPiBAQCAtNDI3OSwxNCAr
NDI3OSwxNCBAQCBpOTE1X2ZpZm9fdW5kZXJydW5fcmVzZXRfd3JpdGUoc3RydWN0IGZpbGUgKmZp
bHAsCj4gIAkJCXJldHVybiByZXQ7Cj4gIAo+ICAJCWNydGNfc3RhdGUgPSB0b19pbnRlbF9jcnRj
X3N0YXRlKGludGVsX2NydGMtPmJhc2Uuc3RhdGUpOwo+IC0JCWNvbW1pdCA9IGNydGNfc3RhdGUt
PmJhc2UuY29tbWl0Owo+ICsJCWNvbW1pdCA9IGNydGNfc3RhdGUtPnVhcGkuY29tbWl0Owo+ICAJ
CWlmIChjb21taXQpIHsKPiAgCQkJcmV0ID0gd2FpdF9mb3JfY29tcGxldGlvbl9pbnRlcnJ1cHRp
YmxlKCZjb21taXQtPmh3X2RvbmUpOwo+ICAJCQlpZiAoIXJldCkKPiAgCQkJCXJldCA9IHdhaXRf
Zm9yX2NvbXBsZXRpb25faW50ZXJydXB0aWJsZSgmY29tbWl0LT5mbGlwX2RvbmUpOwo+ICAJCX0K
PiAgCj4gLQkJaWYgKCFyZXQgJiYgY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUpIHsKPiArCQlpZiAo
IXJldCAmJiBjcnRjX3N0YXRlLT5ody5hY3RpdmUpIHsKPiAgCQkJRFJNX0RFQlVHX0tNUygiUmUt
YXJtaW5nIEZJRk8gdW5kZXJydW5zIG9uIHBpcGUgJWNcbiIsCj4gIAkJCQkgICAgICBwaXBlX25h
bWUoaW50ZWxfY3J0Yy0+cGlwZSkpOwo+ICAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfcG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMKPiBpbmRl
eCA2YWE0MGY1NDYyMjYuLmVkYWJmMmNmNDQ0MCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9wbS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0u
Ywo+IEBAIC00ODQsNyArNDg0LDcgQEAgc3RhdGljIGNvbnN0IGludCBwZXNzaW1hbF9sYXRlbmN5
X25zID0gNTAwMDsKPiAgCj4gIHN0YXRpYyB2b2lkIHZsdl9nZXRfZmlmb19zaXplKHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBp
bnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+
ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNl
LmRldik7Cj4gIAlzdHJ1Y3Qgdmx2X2ZpZm9fc3RhdGUgKmZpZm9fc3RhdGUgPSAmY3J0Y19zdGF0
ZS0+d20udmx2LmZpZm9fc3RhdGU7Cj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4g
QEAgLTgxOCw3ICs4MTgsNyBAQCBzdGF0aWMgYm9vbCBpbnRlbF93bV9wbGFuZV92aXNpYmxlKGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAJc3RydWN0IGludGVs
X3BsYW5lICpwbGFuZSA9IHRvX2ludGVsX3BsYW5lKHBsYW5lX3N0YXRlLT5iYXNlLnBsYW5lKTsK
PiAgCj4gIAkvKiBGSVhNRSBjaGVjayB0aGUgJ2VuYWJsZScgaW5zdGVhZCAqLwo+IC0JaWYgKCFj
cnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSkKPiArCWlmICghY3J0Y19zdGF0ZS0+aHcuYWN0aXZlKQo+
ICAJCXJldHVybiBmYWxzZTsKPiAgCj4gIAkvKgo+IEBAIC04NzEsNyArODcxLDcgQEAgc3RhdGlj
IHZvaWQgcGluZXZpZXdfdXBkYXRlX3dtKHN0cnVjdCBpbnRlbF9jcnRjICp1bnVzZWRfY3J0YykK
PiAgCWNydGMgPSBzaW5nbGVfZW5hYmxlZF9jcnRjKGRldl9wcml2KTsKPiAgCWlmIChjcnRjKSB7
Cj4gIAkJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+IC0J
CQkmY3J0Yy0+Y29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gKwkJCSZjcnRjLT5jb25maWct
Pmh3LmFkanVzdGVkX21vZGU7Cj4gIAkJY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIg
PQo+ICAJCQljcnRjLT5iYXNlLnByaW1hcnktPnN0YXRlLT5mYjsKPiAgCQlpbnQgY3BwID0gZmIt
PmZvcm1hdC0+Y3BwWzBdOwo+IEBAIC0xMTA3LDcgKzExMDcsNyBAQCBzdGF0aWMgdTE2IGc0eF9j
b21wdXRlX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAJ
c3RydWN0IGludGVsX3BsYW5lICpwbGFuZSA9IHRvX2ludGVsX3BsYW5lKHBsYW5lX3N0YXRlLT5i
YXNlLnBsYW5lKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUocGxhbmUtPmJhc2UuZGV2KTsKPiAgCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICph
ZGp1c3RlZF9tb2RlID0KPiAtCQkmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICsJ
CSZjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlOwo+ICAJdW5zaWduZWQgaW50IGxhdGVuY3kg
PSBkZXZfcHJpdi0+d20ucHJpX2xhdGVuY3lbbGV2ZWxdICogMTA7Cj4gIAl1bnNpZ25lZCBpbnQg
Y2xvY2ssIGh0b3RhbCwgY3BwLCB3aWR0aCwgd207Cj4gIAo+IEBAIC0xMTY3LDcgKzExNjcsNyBA
QCBzdGF0aWMgdTE2IGc0eF9jb21wdXRlX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlLAo+ICBzdGF0aWMgYm9vbCBnNHhfcmF3X3BsYW5lX3dtX3NldChzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgCQkJCSBpbnQgbGV2ZWwsIGVudW0gcGxh
bmVfaWQgcGxhbmVfaWQsIHUxNiB2YWx1ZSkKPiAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPnVh
cGkuY3J0Yy0+ZGV2KTsKPiAgCWJvb2wgZGlydHkgPSBmYWxzZTsKPiAgCj4gIAlmb3IgKDsgbGV2
ZWwgPCBpbnRlbF93bV9udW1fbGV2ZWxzKGRldl9wcml2KTsgbGV2ZWwrKykgewo+IEBAIC0xMTgz
LDcgKzExODMsNyBAQCBzdGF0aWMgYm9vbCBnNHhfcmF3X3BsYW5lX3dtX3NldChzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgc3RhdGljIGJvb2wgZzR4X3Jhd19mYmNfd21f
c2V0KHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAJCQkgICAgICAgaW50
IGxldmVsLCB1MTYgdmFsdWUpCj4gIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT51YXBpLmNydGMt
PmRldik7Cj4gIAlib29sIGRpcnR5ID0gZmFsc2U7Cj4gIAo+ICAJLyogTk9STUFMIGxldmVsIGRv
ZXNuJ3QgaGF2ZSBhbiBGQkMgd2F0ZXJtYXJrICovCj4gQEAgLTEyODUsNyArMTI4NSw3IEBAIHN0
YXRpYyBib29sIGc0eF9yYXdfcGxhbmVfd21faXNfdmFsaWQoY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gIHN0YXRpYyBib29sIGc0eF9yYXdfY3J0Y193bV9pc192
YWxpZChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgCQkJCSAg
ICAgaW50IGxldmVsKQo+ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjLT5kZXYp
Owo+ICAKPiAgCWlmIChsZXZlbCA+IGRldl9wcml2LT53bS5tYXhfbGV2ZWwpCj4gIAkJcmV0dXJu
IGZhbHNlOwo+IEBAIC0xMzIzLDkgKzEzMjMsOSBAQCBzdGF0aWMgdm9pZCBnNHhfaW52YWxpZGF0
ZV93bXMoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gIAo+ICBzdGF0aWMgaW50IGc0eF9jb21w
dXRlX3BpcGVfd20oc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHsKPiAt
CXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNl
LmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSA9
Cj4gLQkJdG9faW50ZWxfYXRvbWljX3N0YXRlKGNydGNfc3RhdGUtPmJhc2Uuc3RhdGUpOwo+ICsJ
CXRvX2ludGVsX2F0b21pY19zdGF0ZShjcnRjX3N0YXRlLT51YXBpLnN0YXRlKTsKPiAgCXN0cnVj
dCBnNHhfd21fc3RhdGUgKndtX3N0YXRlID0gJmNydGNfc3RhdGUtPndtLmc0eC5vcHRpbWFsOwo+
ICAJaW50IG51bV9hY3RpdmVfcGxhbmVzID0gaHdlaWdodDgoY3J0Y19zdGF0ZS0+YWN0aXZlX3Bs
YW5lcyAmCj4gIAkJCQkJIH5CSVQoUExBTkVfQ1VSU09SKSk7Cj4gQEAgLTE0MTIsMTcgKzE0MTIs
MTcgQEAgc3RhdGljIGludCBnNHhfY29tcHV0ZV9waXBlX3dtKHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlKQo+ICAKPiAgc3RhdGljIGludCBnNHhfY29tcHV0ZV9pbnRlcm1lZGlh
dGVfd20oc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+ICB7Cj4gLQlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMobmV3X2NydGNfc3RhdGUtPmJh
c2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMobmV3
X2NydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZzR4X3dtX3N0YXRlICppbnRlcm1l
ZGlhdGUgPSAmbmV3X2NydGNfc3RhdGUtPndtLmc0eC5pbnRlcm1lZGlhdGU7Cj4gIAljb25zdCBz
dHJ1Y3QgZzR4X3dtX3N0YXRlICpvcHRpbWFsID0gJm5ld19jcnRjX3N0YXRlLT53bS5nNHgub3B0
aW1hbDsKPiAgCXN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKmludGVsX3N0YXRlID0KPiAtCQl0
b19pbnRlbF9hdG9taWNfc3RhdGUobmV3X2NydGNfc3RhdGUtPmJhc2Uuc3RhdGUpOwo+ICsJCXRv
X2ludGVsX2F0b21pY19zdGF0ZShuZXdfY3J0Y19zdGF0ZS0+dWFwaS5zdGF0ZSk7Cj4gIAljb25z
dCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUgPQo+ICAJCWludGVsX2F0
b21pY19nZXRfb2xkX2NydGNfc3RhdGUoaW50ZWxfc3RhdGUsIGNydGMpOwo+ICAJY29uc3Qgc3Ry
dWN0IGc0eF93bV9zdGF0ZSAqYWN0aXZlID0gJm9sZF9jcnRjX3N0YXRlLT53bS5nNHgub3B0aW1h
bDsKPiAgCWVudW0gcGxhbmVfaWQgcGxhbmVfaWQ7Cj4gIAo+IC0JaWYgKCFuZXdfY3J0Y19zdGF0
ZS0+YmFzZS5hY3RpdmUgfHwgZHJtX2F0b21pY19jcnRjX25lZWRzX21vZGVzZXQoJm5ld19jcnRj
X3N0YXRlLT5iYXNlKSkgewo+ICsJaWYgKCFuZXdfY3J0Y19zdGF0ZS0+aHcuYWN0aXZlIHx8IGRy
bV9hdG9taWNfY3J0Y19uZWVkc19tb2Rlc2V0KCZuZXdfY3J0Y19zdGF0ZS0+dWFwaSkpIHsKPiAg
CQkqaW50ZXJtZWRpYXRlID0gKm9wdGltYWw7Cj4gIAo+ICAJCWludGVybWVkaWF0ZS0+Y3hzciA9
IGZhbHNlOwo+IEBAIC0xNTU0LDggKzE1NTQsOCBAQCBzdGF0aWMgdm9pZCBnNHhfcHJvZ3JhbV93
YXRlcm1hcmtzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgc3RhdGljIHZv
aWQgZzR4X2luaXRpYWxfd2F0ZXJtYXJrcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0
ZSwKPiAgCQkJCSAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUt
PmJhc2UuY3J0Yy0+ZGV2KTsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxf
Y3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT51YXBpLmNydGMtPmRldik7Cj4gKwlzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRj
KTsKPiAgCj4gIAltdXRleF9sb2NrKCZkZXZfcHJpdi0+d20ud21fbXV0ZXgpOwo+ICAJY3J0Yy0+
d20uYWN0aXZlLmc0eCA9IGNydGNfc3RhdGUtPndtLmc0eC5pbnRlcm1lZGlhdGU7Cj4gQEAgLTE1
NjYsOCArMTU2Niw4IEBAIHN0YXRpYyB2b2lkIGc0eF9pbml0aWFsX3dhdGVybWFya3Moc3RydWN0
IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4gIHN0YXRpYyB2b2lkIGc0eF9vcHRpbWl6ZV93
YXRlcm1hcmtzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+ICAJCQkJICAgIHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2
KTsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRl
LT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShjcnRjX3N0YXRlLT51YXBpLmNydGMtPmRldik7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCj4gIAlpZiAo
IWNydGNfc3RhdGUtPndtLm5lZWRfcG9zdHZibF91cGRhdGUpCj4gIAkJcmV0dXJuOwo+IEBAIC0x
NjE2LDcgKzE2MTYsNyBAQCBzdGF0aWMgdTE2IHZsdl9jb21wdXRlX3dtX2xldmVsKGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAJc3RydWN0IGludGVsX3BsYW5l
ICpwbGFuZSA9IHRvX2ludGVsX3BsYW5lKHBsYW5lX3N0YXRlLT5iYXNlLnBsYW5lKTsKPiAgCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2
KTsKPiAgCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0KPiAt
CQkmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICsJCSZjcnRjX3N0YXRlLT5ody5h
ZGp1c3RlZF9tb2RlOwo+ICAJdW5zaWduZWQgaW50IGNsb2NrLCBodG90YWwsIGNwcCwgd2lkdGgs
IHdtOwo+ICAKPiAgCWlmIChkZXZfcHJpdi0+d20ucHJpX2xhdGVuY3lbbGV2ZWxdID09IDApCj4g
QEAgLTE2NTQsNyArMTY1NCw3IEBAIHN0YXRpYyBib29sIHZsdl9uZWVkX3Nwcml0ZTBfZmlmb193
b3JrYXJvdW5kKHVuc2lnbmVkIGludCBhY3RpdmVfcGxhbmVzKQo+ICAKPiAgc3RhdGljIGludCB2
bHZfY29tcHV0ZV9maWZvKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7
Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+
YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0Yyhj
cnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAJY29uc3Qgc3RydWN0IGc0eF9waXBlX3dtICpyYXcg
PQo+ICAJCSZjcnRjX3N0YXRlLT53bS52bHYucmF3W1ZMVl9XTV9MRVZFTF9QTTJdOwo+ICAJc3Ry
dWN0IHZsdl9maWZvX3N0YXRlICpmaWZvX3N0YXRlID0gJmNydGNfc3RhdGUtPndtLnZsdi5maWZv
X3N0YXRlOwo+IEBAIC0xNzY2LDcgKzE3NjYsNyBAQCBzdGF0aWMgdTE2IHZsdl9pbnZlcnRfd21f
dmFsdWUodTE2IHdtLCB1MTYgZmlmb19zaXplKQo+ICBzdGF0aWMgYm9vbCB2bHZfcmF3X3BsYW5l
X3dtX3NldChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgCQkJCSBpbnQg
bGV2ZWwsIGVudW0gcGxhbmVfaWQgcGxhbmVfaWQsIHUxNiB2YWx1ZSkKPiAgewo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNy
dGMtPmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsKPiAgCWludCBudW1fbGV2ZWxzID0gaW50ZWxf
d21fbnVtX2xldmVscyhkZXZfcHJpdik7Cj4gIAlib29sIGRpcnR5ID0gZmFsc2U7Cj4gIAo+IEBA
IC0xODQxLDE2ICsxODQxLDE2IEBAIHN0YXRpYyBib29sIHZsdl9yYXdfY3J0Y193bV9pc192YWxp
ZChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgCj4gIHN0YXRp
YyBpbnQgdmx2X2NvbXB1dGVfcGlwZV93bShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNy
dGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAJc3RydWN0IGludGVs
X2F0b21pY19zdGF0ZSAqc3RhdGUgPQo+IC0JCXRvX2ludGVsX2F0b21pY19zdGF0ZShjcnRjX3N0
YXRlLT5iYXNlLnN0YXRlKTsKPiArCQl0b19pbnRlbF9hdG9taWNfc3RhdGUoY3J0Y19zdGF0ZS0+
dWFwaS5zdGF0ZSk7Cj4gIAlzdHJ1Y3Qgdmx2X3dtX3N0YXRlICp3bV9zdGF0ZSA9ICZjcnRjX3N0
YXRlLT53bS52bHYub3B0aW1hbDsKPiAgCWNvbnN0IHN0cnVjdCB2bHZfZmlmb19zdGF0ZSAqZmlm
b19zdGF0ZSA9Cj4gIAkJJmNydGNfc3RhdGUtPndtLnZsdi5maWZvX3N0YXRlOwo+ICAJaW50IG51
bV9hY3RpdmVfcGxhbmVzID0gaHdlaWdodDgoY3J0Y19zdGF0ZS0+YWN0aXZlX3BsYW5lcyAmCj4g
IAkJCQkJIH5CSVQoUExBTkVfQ1VSU09SKSk7Cj4gLQlib29sIG5lZWRzX21vZGVzZXQgPSBkcm1f
YXRvbWljX2NydGNfbmVlZHNfbW9kZXNldCgmY3J0Y19zdGF0ZS0+YmFzZSk7Cj4gKwlib29sIG5l
ZWRzX21vZGVzZXQgPSBkcm1fYXRvbWljX2NydGNfbmVlZHNfbW9kZXNldCgmY3J0Y19zdGF0ZS0+
dWFwaSk7Cj4gIAljb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKm9sZF9wbGFuZV9zdGF0
ZTsKPiAgCWNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqbmV3X3BsYW5lX3N0YXRlOwo+
ICAJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZTsKPiBAQCAtMTk0OSw3ICsxOTQ5LDcgQEAgc3Rh
dGljIGludCB2bHZfY29tcHV0ZV9waXBlX3dtKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlKQo+ICBzdGF0aWMgdm9pZCB2bHZfYXRvbWljX3VwZGF0ZV9maWZvKHN0cnVjdCBpbnRl
bF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+ICAJCQkJICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxf
Y3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMg
PSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCXN0cnVj
dCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwo+ICAJY29uc3Qgc3Ry
dWN0IHZsdl9maWZvX3N0YXRlICpmaWZvX3N0YXRlID0KPiBAQCAtMjA0NSwxNyArMjA0NSwxNyBA
QCBzdGF0aWMgdm9pZCB2bHZfYXRvbWljX3VwZGF0ZV9maWZvKHN0cnVjdCBpbnRlbF9hdG9taWNf
c3RhdGUgKnN0YXRlLAo+ICAKPiAgc3RhdGljIGludCB2bHZfY29tcHV0ZV9pbnRlcm1lZGlhdGVf
d20oc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMobmV3X2NydGNfc3RhdGUtPmJhc2Uu
Y3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMobmV3X2Ny
dGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3Qgdmx2X3dtX3N0YXRlICppbnRlcm1lZGlh
dGUgPSAmbmV3X2NydGNfc3RhdGUtPndtLnZsdi5pbnRlcm1lZGlhdGU7Cj4gIAljb25zdCBzdHJ1
Y3Qgdmx2X3dtX3N0YXRlICpvcHRpbWFsID0gJm5ld19jcnRjX3N0YXRlLT53bS52bHYub3B0aW1h
bDsKPiAgCXN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKmludGVsX3N0YXRlID0KPiAtCQl0b19p
bnRlbF9hdG9taWNfc3RhdGUobmV3X2NydGNfc3RhdGUtPmJhc2Uuc3RhdGUpOwo+ICsJCXRvX2lu
dGVsX2F0b21pY19zdGF0ZShuZXdfY3J0Y19zdGF0ZS0+dWFwaS5zdGF0ZSk7Cj4gIAljb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUgPQo+ICAJCWludGVsX2F0b21p
Y19nZXRfb2xkX2NydGNfc3RhdGUoaW50ZWxfc3RhdGUsIGNydGMpOwo+ICAJY29uc3Qgc3RydWN0
IHZsdl93bV9zdGF0ZSAqYWN0aXZlID0gJm9sZF9jcnRjX3N0YXRlLT53bS52bHYub3B0aW1hbDsK
PiAgCWludCBsZXZlbDsKPiAgCj4gLQlpZiAoIW5ld19jcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSB8
fCBkcm1fYXRvbWljX2NydGNfbmVlZHNfbW9kZXNldCgmbmV3X2NydGNfc3RhdGUtPmJhc2UpKSB7
Cj4gKwlpZiAoIW5ld19jcnRjX3N0YXRlLT5ody5hY3RpdmUgfHwgZHJtX2F0b21pY19jcnRjX25l
ZWRzX21vZGVzZXQoJm5ld19jcnRjX3N0YXRlLT51YXBpKSkgewo+ICAJCSppbnRlcm1lZGlhdGUg
PSAqb3B0aW1hbDsKPiAgCj4gIAkJaW50ZXJtZWRpYXRlLT5jeHNyID0gZmFsc2U7Cj4gQEAgLTIx
NzMsOCArMjE3Myw4IEBAIHN0YXRpYyB2b2lkIHZsdl9wcm9ncmFtX3dhdGVybWFya3Moc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICBzdGF0aWMgdm9pZCB2bHZfaW5pdGlhbF93
YXRlcm1hcmtzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+ICAJCQkJICAgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYp
Owo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUt
PmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAKPiAgCW11dGV4
X2xvY2soJmRldl9wcml2LT53bS53bV9tdXRleCk7Cj4gIAljcnRjLT53bS5hY3RpdmUudmx2ID0g
Y3J0Y19zdGF0ZS0+d20udmx2LmludGVybWVkaWF0ZTsKPiBAQCAtMjE4NSw4ICsyMTg1LDggQEAg
c3RhdGljIHZvaWQgdmx2X2luaXRpYWxfd2F0ZXJtYXJrcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0
YXRlICpzdGF0ZSwKPiAgc3RhdGljIHZvaWQgdmx2X29wdGltaXplX3dhdGVybWFya3Moc3RydWN0
IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4gIAkJCQkgICAgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+IC0Jc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUt
PnVhcGkuY3J0Yy0+ZGV2KTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxf
Y3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAKPiAgCWlmICghY3J0Y19zdGF0ZS0+d20u
bmVlZF9wb3N0dmJsX3VwZGF0ZSkKPiAgCQlyZXR1cm47Cj4gQEAgLTIyMTEsNyArMjIxMSw3IEBA
IHN0YXRpYyB2b2lkIGk5NjVfdXBkYXRlX3dtKHN0cnVjdCBpbnRlbF9jcnRjICp1bnVzZWRfY3J0
YykKPiAgCQkvKiBzZWxmLXJlZnJlc2ggaGFzIG11Y2ggaGlnaGVyIGxhdGVuY3kgKi8KPiAgCQlz
dGF0aWMgY29uc3QgaW50IHNyX2xhdGVuY3lfbnMgPSAxMjAwMDsKPiAgCQljb25zdCBzdHJ1Y3Qg
ZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9Cj4gLQkJCSZjcnRjLT5jb25maWctPmJh
c2UuYWRqdXN0ZWRfbW9kZTsKPiArCQkJJmNydGMtPmNvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZTsK
PiAgCQljb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9Cj4gIAkJCWNydGMtPmJhc2Uu
cHJpbWFyeS0+c3RhdGUtPmZiOwo+ICAJCWludCBjbG9jayA9IGFkanVzdGVkX21vZGUtPmNydGNf
Y2xvY2s7Cj4gQEAgLTIyOTIsNyArMjI5Miw3IEBAIHN0YXRpYyB2b2lkIGk5eHhfdXBkYXRlX3dt
KHN0cnVjdCBpbnRlbF9jcnRjICp1bnVzZWRfY3J0YykKPiAgCWNydGMgPSBpbnRlbF9nZXRfY3J0
Y19mb3JfcGxhbmUoZGV2X3ByaXYsIFBMQU5FX0EpOwo+ICAJaWYgKGludGVsX2NydGNfYWN0aXZl
KGNydGMpKSB7Cj4gIAkJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21v
ZGUgPQo+IC0JCQkmY3J0Yy0+Y29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gKwkJCSZjcnRj
LT5jb25maWctPmh3LmFkanVzdGVkX21vZGU7Cj4gIAkJY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1
ZmZlciAqZmIgPQo+ICAJCQljcnRjLT5iYXNlLnByaW1hcnktPnN0YXRlLT5mYjsKPiAgCQlpbnQg
Y3BwOwo+IEBAIC0yMzE5LDcgKzIzMTksNyBAQCBzdGF0aWMgdm9pZCBpOXh4X3VwZGF0ZV93bShz
dHJ1Y3QgaW50ZWxfY3J0YyAqdW51c2VkX2NydGMpCj4gIAljcnRjID0gaW50ZWxfZ2V0X2NydGNf
Zm9yX3BsYW5lKGRldl9wcml2LCBQTEFORV9CKTsKPiAgCWlmIChpbnRlbF9jcnRjX2FjdGl2ZShj
cnRjKSkgewo+ICAJCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2Rl
ID0KPiAtCQkJJmNydGMtPmNvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICsJCQkmY3J0Yy0+
Y29uZmlnLT5ody5hZGp1c3RlZF9tb2RlOwo+ICAJCWNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZm
ZXIgKmZiID0KPiAgCQkJY3J0Yy0+YmFzZS5wcmltYXJ5LT5zdGF0ZS0+ZmI7Cj4gIAkJaW50IGNw
cDsKPiBAQCAtMjM2Nyw3ICsyMzY3LDcgQEAgc3RhdGljIHZvaWQgaTl4eF91cGRhdGVfd20oc3Ry
dWN0IGludGVsX2NydGMgKnVudXNlZF9jcnRjKQo+ICAJCS8qIHNlbGYtcmVmcmVzaCBoYXMgbXVj
aCBoaWdoZXIgbGF0ZW5jeSAqLwo+ICAJCXN0YXRpYyBjb25zdCBpbnQgc3JfbGF0ZW5jeV9ucyA9
IDYwMDA7Cj4gIAkJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUg
PQo+IC0JCQkmZW5hYmxlZC0+Y29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gKwkJCSZlbmFi
bGVkLT5jb25maWctPmh3LmFkanVzdGVkX21vZGU7Cj4gIAkJY29uc3Qgc3RydWN0IGRybV9mcmFt
ZWJ1ZmZlciAqZmIgPQo+ICAJCQllbmFibGVkLT5iYXNlLnByaW1hcnktPnN0YXRlLT5mYjsKPiAg
CQlpbnQgY2xvY2sgPSBhZGp1c3RlZF9tb2RlLT5jcnRjX2Nsb2NrOwo+IEBAIC0yNDI1LDcgKzI0
MjUsNyBAQCBzdGF0aWMgdm9pZCBpODQ1X3VwZGF0ZV93bShzdHJ1Y3QgaW50ZWxfY3J0YyAqdW51
c2VkX2NydGMpCj4gIAlpZiAoY3J0YyA9PSBOVUxMKQo+ICAJCXJldHVybjsKPiAgCj4gLQlhZGp1
c3RlZF9tb2RlID0gJmNydGMtPmNvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICsJYWRqdXN0
ZWRfbW9kZSA9ICZjcnRjLT5jb25maWctPmh3LmFkanVzdGVkX21vZGU7Cj4gIAlwbGFuZWFfd20g
PSBpbnRlbF9jYWxjdWxhdGVfd20oYWRqdXN0ZWRfbW9kZS0+Y3J0Y19jbG9jaywKPiAgCQkJCSAg
ICAgICAmaTg0NV93bV9pbmZvLAo+ICAJCQkJICAgICAgIGRldl9wcml2LT5kaXNwbGF5LmdldF9m
aWZvX3NpemUoZGV2X3ByaXYsIFBMQU5FX0EpLAo+IEBAIC0yNTE1LDcgKzI1MTUsNyBAQCBzdGF0
aWMgdTMyIGlsa19jb21wdXRlX3ByaV93bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSwKPiAgCQlyZXR1cm4gbWV0aG9kMTsKPiAgCj4gIAltZXRob2QyID0gaWxrX3dt
X21ldGhvZDIoY3J0Y19zdGF0ZS0+cGl4ZWxfcmF0ZSwKPiAtCQkJCSBjcnRjX3N0YXRlLT5iYXNl
LmFkanVzdGVkX21vZGUuY3J0Y19odG90YWwsCj4gKwkJCQkgY3J0Y19zdGF0ZS0+aHcuYWRqdXN0
ZWRfbW9kZS5jcnRjX2h0b3RhbCwKPiAgCQkJCSBkcm1fcmVjdF93aWR0aCgmcGxhbmVfc3RhdGUt
PmJhc2UuZHN0KSwKPiAgCQkJCSBjcHAsIG1lbV92YWx1ZSk7Cj4gIAo+IEBAIC0yNTQzLDcgKzI1
NDMsNyBAQCBzdGF0aWMgdTMyIGlsa19jb21wdXRlX3Nwcl93bShjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgCj4gIAltZXRob2QxID0gaWxrX3dtX21ldGhvZDEo
Y3J0Y19zdGF0ZS0+cGl4ZWxfcmF0ZSwgY3BwLCBtZW1fdmFsdWUpOwo+ICAJbWV0aG9kMiA9IGls
a193bV9tZXRob2QyKGNydGNfc3RhdGUtPnBpeGVsX3JhdGUsCj4gLQkJCQkgY3J0Y19zdGF0ZS0+
YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfaHRvdGFsLAo+ICsJCQkJIGNydGNfc3RhdGUtPmh3LmFk
anVzdGVkX21vZGUuY3J0Y19odG90YWwsCj4gIAkJCQkgZHJtX3JlY3Rfd2lkdGgoJnBsYW5lX3N0
YXRlLT5iYXNlLmRzdCksCj4gIAkJCQkgY3BwLCBtZW1fdmFsdWUpOwo+ICAJcmV0dXJuIG1pbiht
ZXRob2QxLCBtZXRob2QyKTsKPiBAQCAtMjU2OCw3ICsyNTY4LDcgQEAgc3RhdGljIHUzMiBpbGtf
Y29tcHV0ZV9jdXJfd20oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
Cj4gIAljcHAgPSBwbGFuZV9zdGF0ZS0+YmFzZS5mYi0+Zm9ybWF0LT5jcHBbMF07Cj4gIAo+ICAJ
cmV0dXJuIGlsa193bV9tZXRob2QyKGNydGNfc3RhdGUtPnBpeGVsX3JhdGUsCj4gLQkJCSAgICAg
IGNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2h0b3RhbCwKPiArCQkJICAgICAg
Y3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2h0b3RhbCwKPiAgCQkJICAgICAgcGxh
bmVfc3RhdGUtPmJhc2UuY3J0Y193LCBjcHAsIG1lbV92YWx1ZSk7Cj4gIH0KPiAgCj4gQEAgLTI3
ODksMTIgKzI3ODksMTIgQEAgc3RhdGljIHUzMgo+ICBoc3dfY29tcHV0ZV9saW5ldGltZV93bShj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+ICAJY29uc3Qg
c3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqaW50ZWxfc3RhdGUgPQo+IC0JCXRvX2ludGVsX2F0
b21pY19zdGF0ZShjcnRjX3N0YXRlLT5iYXNlLnN0YXRlKTsKPiArCQl0b19pbnRlbF9hdG9taWNf
c3RhdGUoY3J0Y19zdGF0ZS0+dWFwaS5zdGF0ZSk7Cj4gIAljb25zdCBzdHJ1Y3QgZHJtX2Rpc3Bs
YXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9Cj4gLQkJJmNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRf
bW9kZTsKPiArCQkmY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZTsKPiAgCXUzMiBsaW5ldGlt
ZSwgaXBzX2xpbmV0aW1lOwo+ICAKPiAtCWlmICghY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUpCj4g
KwlpZiAoIWNydGNfc3RhdGUtPmh3LmFjdGl2ZSkKPiAgCQlyZXR1cm4gMDsKPiAgCWlmIChXQVJO
X09OKGFkanVzdGVkX21vZGUtPmNydGNfY2xvY2sgPT0gMCkpCj4gIAkJcmV0dXJuIDA7Cj4gQEAg
LTMxMDQsMTEgKzMxMDQsOSBAQCBzdGF0aWMgYm9vbCBpbGtfdmFsaWRhdGVfcGlwZV93bShjb25z
dCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gIC8qIENvbXB1dGUgbmV3IHdh
dGVybWFya3MgZm9yIHRoZSBwaXBlICovCj4gIHN0YXRpYyBpbnQgaWxrX2NvbXB1dGVfcGlwZV93
bShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGRy
bV9hdG9taWNfc3RhdGUgKnN0YXRlID0gY3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZTsKPiAtCXN0cnVj
dCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNl
LmNydGMpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShj
cnRjX3N0YXRlLT51YXBpLmNydGMtPmRldik7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxf
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBp
bnRlbF9waXBlX3dtICpwaXBlX3dtOwo+IC0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IHN0YXRl
LT5kZXY7Cj4gLQljb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGRldik7Cj4gIAlzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZTsKPiAgCWNvbnN0IHN0cnVjdCBk
cm1fcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlOwo+ICAJY29uc3Qgc3RydWN0IGludGVsX3BsYW5l
X3N0YXRlICpwcmlzdGF0ZSA9IE5VTEw7Cj4gQEAgLTMxMTksNyArMzExNyw3IEBAIHN0YXRpYyBp
bnQgaWxrX2NvbXB1dGVfcGlwZV93bShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSkKPiAgCj4gIAlwaXBlX3dtID0gJmNydGNfc3RhdGUtPndtLmlsay5vcHRpbWFsOwo+ICAKPiAt
CWRybV9hdG9taWNfY3J0Y19zdGF0ZV9mb3JfZWFjaF9wbGFuZV9zdGF0ZShwbGFuZSwgcGxhbmVf
c3RhdGUsICZjcnRjX3N0YXRlLT5iYXNlKSB7Cj4gKwlkcm1fYXRvbWljX2NydGNfc3RhdGVfZm9y
X2VhY2hfcGxhbmVfc3RhdGUocGxhbmUsIHBsYW5lX3N0YXRlLCAmY3J0Y19zdGF0ZS0+dWFwaSkg
ewo+ICAJCWNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcHMgPSB0b19pbnRlbF9wbGFu
ZV9zdGF0ZShwbGFuZV9zdGF0ZSk7Cj4gIAo+ICAJCWlmIChwbGFuZS0+dHlwZSA9PSBEUk1fUExB
TkVfVFlQRV9QUklNQVJZKQo+IEBAIC0zMTMwLDcgKzMxMjgsNyBAQCBzdGF0aWMgaW50IGlsa19j
b21wdXRlX3BpcGVfd20oc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIAkJ
CWN1cnN0YXRlID0gcHM7Cj4gIAl9Cj4gIAo+IC0JcGlwZV93bS0+cGlwZV9lbmFibGVkID0gY3J0
Y19zdGF0ZS0+YmFzZS5hY3RpdmU7Cj4gKwlwaXBlX3dtLT5waXBlX2VuYWJsZWQgPSBjcnRjX3N0
YXRlLT5ody5hY3RpdmU7Cj4gIAlpZiAoc3Byc3RhdGUpIHsKPiAgCQlwaXBlX3dtLT5zcHJpdGVz
X2VuYWJsZWQgPSBzcHJzdGF0ZS0+YmFzZS52aXNpYmxlOwo+ICAJCXBpcGVfd20tPnNwcml0ZXNf
c2NhbGVkID0gc3Byc3RhdGUtPmJhc2UudmlzaWJsZSAmJgo+IEBAIC0zMTg3LDExICszMTg1LDEx
IEBAIHN0YXRpYyBpbnQgaWxrX2NvbXB1dGVfcGlwZV93bShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSkKPiAgICovCj4gIHN0YXRpYyBpbnQgaWxrX2NvbXB1dGVfaW50ZXJtZWRp
YXRlX3dtKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpuZXdzdGF0ZSkKPiAgewo+IC0Jc3RydWN0
IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKG5ld3N0YXRlLT5iYXNlLmNy
dGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKG5l
d3N0YXRlLT51YXBpLmNydGMpOwo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShpbnRlbF9jcnRjLT5iYXNlLmRldik7Cj4gIAlzdHJ1Y3QgaW50ZWxfcGlwZV93
bSAqYSA9ICZuZXdzdGF0ZS0+d20uaWxrLmludGVybWVkaWF0ZTsKPiAgCXN0cnVjdCBpbnRlbF9h
dG9taWNfc3RhdGUgKmludGVsX3N0YXRlID0KPiAtCQl0b19pbnRlbF9hdG9taWNfc3RhdGUobmV3
c3RhdGUtPmJhc2Uuc3RhdGUpOwo+ICsJCXRvX2ludGVsX2F0b21pY19zdGF0ZShuZXdzdGF0ZS0+
dWFwaS5zdGF0ZSk7Cj4gIAljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkc3RhdGUg
PQo+ICAJCWludGVsX2F0b21pY19nZXRfb2xkX2NydGNfc3RhdGUoaW50ZWxfc3RhdGUsIGludGVs
X2NydGMpOwo+ICAJY29uc3Qgc3RydWN0IGludGVsX3BpcGVfd20gKmIgPSAmb2xkc3RhdGUtPndt
Lmlsay5vcHRpbWFsOwo+IEBAIC0zMjAzLDcgKzMyMDEsNyBAQCBzdGF0aWMgaW50IGlsa19jb21w
dXRlX2ludGVybWVkaWF0ZV93bShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3c3RhdGUpCj4g
IAkgKiBhbmQgYWZ0ZXIgdGhlIHZibGFuay4KPiAgCSAqLwo+ICAJKmEgPSBuZXdzdGF0ZS0+d20u
aWxrLm9wdGltYWw7Cj4gLQlpZiAoIW5ld3N0YXRlLT5iYXNlLmFjdGl2ZSB8fCBkcm1fYXRvbWlj
X2NydGNfbmVlZHNfbW9kZXNldCgmbmV3c3RhdGUtPmJhc2UpIHx8Cj4gKwlpZiAoIW5ld3N0YXRl
LT5ody5hY3RpdmUgfHwgZHJtX2F0b21pY19jcnRjX25lZWRzX21vZGVzZXQoJm5ld3N0YXRlLT51
YXBpKSB8fAo+ICAJICAgIGludGVsX3N0YXRlLT5za2lwX2ludGVybWVkaWF0ZV93bSkKPiAgCQly
ZXR1cm4gMDsKPiAgCj4gQEAgLTM3ODAsNyArMzc3OCw3IEBAIGJvb2wgaW50ZWxfY2FuX2VuYWJs
ZV9zYWd2KHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICAJY3J0YyA9IGludGVs
X2dldF9jcnRjX2Zvcl9waXBlKGRldl9wcml2LCBwaXBlKTsKPiAgCWNydGNfc3RhdGUgPSB0b19p
bnRlbF9jcnRjX3N0YXRlKGNydGMtPmJhc2Uuc3RhdGUpOwo+ICAKPiAtCWlmIChjcnRjLT5iYXNl
LnN0YXRlLT5hZGp1c3RlZF9tb2RlLmZsYWdzICYgRFJNX01PREVfRkxBR19JTlRFUkxBQ0UpCj4g
KwlpZiAoY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZS5mbGFncyAmIERSTV9NT0RFX0ZMQUdf
SU5URVJMQUNFKQo+ICAJCXJldHVybiBmYWxzZTsKPiAgCj4gIAlmb3JfZWFjaF9pbnRlbF9wbGFu
ZV9vbl9jcnRjKGRldiwgY3J0YywgcGxhbmUpIHsKPiBAQCAtMzgzMCw3ICszODI4LDcgQEAgc3Rh
dGljIHUxNiBpbnRlbF9nZXRfZGRiX3NpemUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ICAJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCAxMSkKPiAgCQlyZXR1cm4gZGRiX3Np
emUgLSA0OyAvKiA0IGJsb2NrcyBmb3IgYnlwYXNzIHBhdGggYWxsb2NhdGlvbiAqLwo+ICAKPiAt
CWFkanVzdGVkX21vZGUgPSAmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ICsJYWRq
dXN0ZWRfbW9kZSA9ICZjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlOwo+ICAJdG90YWxfZGF0
YV9idyA9IHRvdGFsX2RhdGFfcmF0ZSAqIGRybV9tb2RlX3ZyZWZyZXNoKGFkanVzdGVkX21vZGUp
Owo+ICAKPiAgCS8qCj4gQEAgLTM4NTksMTYgKzM4NTcsMTYgQEAgc2tsX2RkYl9nZXRfcGlwZV9h
bGxvY2F0aW9uX2xpbWl0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gIAkJ
CQkgICBzdHJ1Y3Qgc2tsX2RkYl9lbnRyeSAqYWxsb2MsIC8qIG91dCAqLwo+ICAJCQkJICAgaW50
ICpudW1fYWN0aXZlIC8qIG91dCAqLykKPiAgewo+IC0Jc3RydWN0IGRybV9hdG9taWNfc3RhdGUg
KnN0YXRlID0gY3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZTsKPiArCXN0cnVjdCBkcm1fYXRvbWljX3N0
YXRlICpzdGF0ZSA9IGNydGNfc3RhdGUtPnVhcGkuc3RhdGU7Cj4gIAlzdHJ1Y3QgaW50ZWxfYXRv
bWljX3N0YXRlICppbnRlbF9zdGF0ZSA9IHRvX2ludGVsX2F0b21pY19zdGF0ZShzdGF0ZSk7Cj4g
LQlzdHJ1Y3QgZHJtX2NydGMgKmZvcl9jcnRjID0gY3J0Y19zdGF0ZS0+YmFzZS5jcnRjOwo+ICsJ
c3RydWN0IGRybV9jcnRjICpmb3JfY3J0YyA9IGNydGNfc3RhdGUtPnVhcGkuY3J0YzsKPiAgCWNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOwo+ICAJdTMyIHBpcGVfd2lkdGggPSAwLCB0b3Rh
bF93aWR0aCA9IDAsIHdpZHRoX2JlZm9yZV9waXBlID0gMDsKPiAgCWVudW0gcGlwZSBmb3JfcGlw
ZSA9IHRvX2ludGVsX2NydGMoZm9yX2NydGMpLT5waXBlOwo+ICAJdTE2IGRkYl9zaXplOwo+ICAJ
dTMyIGk7Cj4gIAo+IC0JaWYgKFdBUk5fT04oIXN0YXRlKSB8fCAhY3J0Y19zdGF0ZS0+YmFzZS5h
Y3RpdmUpIHsKPiArCWlmIChXQVJOX09OKCFzdGF0ZSkgfHwgIWNydGNfc3RhdGUtPmh3LmFjdGl2
ZSkgewo+ICAJCWFsbG9jLT5zdGFydCA9IDA7Cj4gIAkJYWxsb2MtPmVuZCA9IDA7Cj4gIAkJKm51
bV9hY3RpdmUgPSBod2VpZ2h0OChkZXZfcHJpdi0+YWN0aXZlX3BpcGVzKTsKPiBAQCAtMzkwNywx
MSArMzkwNSwxMSBAQCBza2xfZGRiX2dldF9waXBlX2FsbG9jYXRpb25fbGltaXRzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgCSAqLwo+ICAJZm9yX2VhY2hfbmV3X2ludGVs
X2NydGNfaW5fc3RhdGUoaW50ZWxfc3RhdGUsIGNydGMsIGNydGNfc3RhdGUsIGkpIHsKPiAgCQlj
b25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9Cj4gLQkJCSZjcnRj
X3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gKwkJCSZjcnRjX3N0YXRlLT5ody5hZGp1c3Rl
ZF9tb2RlOwo+ICAJCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCQlpbnQgaGRpc3Bs
YXksIHZkaXNwbGF5Owo+ICAKPiAtCQlpZiAoIWNydGNfc3RhdGUtPmJhc2UuZW5hYmxlKQo+ICsJ
CWlmICghY3J0Y19zdGF0ZS0+aHcuZW5hYmxlKQo+ICAJCQljb250aW51ZTsKPiAgCj4gIAkJZHJt
X21vZGVfZ2V0X2h2X3RpbWluZyhhZGp1c3RlZF9tb2RlLCAmaGRpc3BsYXksICZ2ZGlzcGxheSk7
Cj4gQEAgLTM5NDIsNyArMzk0MCw3IEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQKPiAgc2tsX2N1cnNv
cl9hbGxvY2F0aW9uKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+
ICAJCSAgICAgIGludCBudW1fYWN0aXZlKQo+ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+dWFw
aS5jcnRjLT5kZXYpOwo+ICAJaW50IGxldmVsLCBtYXhfbGV2ZWwgPSBpbGtfd21fbWF4X2xldmVs
KGRldl9wcml2KTsKPiAgCXN0cnVjdCBza2xfd21fbGV2ZWwgd20gPSB7fTsKPiAgCWludCByZXQs
IG1pbl9kZGJfYWxsb2MgPSAwOwo+IEBAIC00MTExLDcgKzQxMDksNyBAQCBza2xfcGlwZV9kb3du
c2NhbGVfYW1vdW50KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+
ICB7Cj4gIAl1aW50X2ZpeGVkXzE2XzE2X3QgcGlwZV9kb3duc2NhbGUgPSB1MzJfdG9fZml4ZWQx
NigxKTsKPiAgCj4gLQlpZiAoIWNydGNfc3RhdGUtPmJhc2UuZW5hYmxlKQo+ICsJaWYgKCFjcnRj
X3N0YXRlLT5ody5lbmFibGUpCj4gIAkJcmV0dXJuIHBpcGVfZG93bnNjYWxlOwo+ICAKPiAgCWlm
IChjcnRjX3N0YXRlLT5wY2hfcGZpdC5lbmFibGVkKSB7Cj4gQEAgLTQxNDMsNyArNDE0MSw3IEBA
IGludCBza2xfY2hlY2tfcGlwZV9tYXhfcGl4ZWxfcmF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50
ZWxfY3J0YywKPiAgCQkJCSAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4g
IHsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoaW50ZWxf
Y3J0Yy0+YmFzZS5kZXYpOwo+IC0Jc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0gY3J0
Y19zdGF0ZS0+YmFzZS5zdGF0ZTsKPiArCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSA9
IGNydGNfc3RhdGUtPnVhcGkuc3RhdGU7Cj4gIAlzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZTsKPiAg
CWNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKmRybV9wbGFuZV9zdGF0ZTsKPiAgCWludCBj
cnRjX2Nsb2NrLCBkb3RjbGs7Cj4gQEAgLTQxNTEsMTAgKzQxNDksMTAgQEAgaW50IHNrbF9jaGVj
a19waXBlX21heF9waXhlbF9yYXRlKHN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjLAo+ICAJ
dWludF9maXhlZF8xNl8xNl90IHBpcGVfZG93bnNjYWxlOwo+ICAJdWludF9maXhlZF8xNl8xNl90
IG1heF9kb3duc2NhbGUgPSB1MzJfdG9fZml4ZWQxNigxKTsKPiAgCj4gLQlpZiAoIWNydGNfc3Rh
dGUtPmJhc2UuZW5hYmxlKQo+ICsJaWYgKCFjcnRjX3N0YXRlLT5ody5lbmFibGUpCj4gIAkJcmV0
dXJuIDA7Cj4gIAo+IC0JZHJtX2F0b21pY19jcnRjX3N0YXRlX2Zvcl9lYWNoX3BsYW5lX3N0YXRl
KHBsYW5lLCBkcm1fcGxhbmVfc3RhdGUsICZjcnRjX3N0YXRlLT5iYXNlKSB7Cj4gKwlkcm1fYXRv
bWljX2NydGNfc3RhdGVfZm9yX2VhY2hfcGxhbmVfc3RhdGUocGxhbmUsIGRybV9wbGFuZV9zdGF0
ZSwgJmNydGNfc3RhdGUtPnVhcGkpIHsKPiAgCQl1aW50X2ZpeGVkXzE2XzE2X3QgcGxhbmVfZG93
bnNjYWxlOwo+ICAJCXVpbnRfZml4ZWRfMTZfMTZfdCBmcF85X2Rpdl84ID0gZGl2X2ZpeGVkMTYo
OSwgOCk7Cj4gIAkJaW50IGJwcDsKPiBAQCAtNDE3OSw3ICs0MTc3LDcgQEAgaW50IHNrbF9jaGVj
a19waXBlX21heF9waXhlbF9yYXRlKHN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjLAo+ICAK
PiAgCXBpcGVfZG93bnNjYWxlID0gbXVsX2ZpeGVkMTYocGlwZV9kb3duc2NhbGUsIG1heF9kb3du
c2NhbGUpOwo+ICAKPiAtCWNydGNfY2xvY2sgPSBjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21v
ZGUuY3J0Y19jbG9jazsKPiArCWNydGNfY2xvY2sgPSBjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9t
b2RlLmNydGNfY2xvY2s7Cj4gIAlkb3RjbGsgPSB0b19pbnRlbF9hdG9taWNfc3RhdGUoc3RhdGUp
LT5jZGNsay5sb2dpY2FsLmNkY2xrOwo+ICAKPiAgCWlmIChJU19HRU1JTklMQUtFKGRldl9wcml2
KSB8fCBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwKQo+IEBAIC00MjQ2LDcgKzQyNDQsNyBAQCBz
a2xfZ2V0X3RvdGFsX3JlbGF0aXZlX2RhdGFfcmF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSwKPiAgCQkJCSB1NjQgKnBsYW5lX2RhdGFfcmF0ZSwKPiAgCQkJCSB1NjQgKnV2
X3BsYW5lX2RhdGFfcmF0ZSkKPiAgewo+IC0Jc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRl
ID0gY3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZTsKPiArCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpz
dGF0ZSA9IGNydGNfc3RhdGUtPnVhcGkuc3RhdGU7Cj4gIAlzdHJ1Y3QgZHJtX3BsYW5lICpwbGFu
ZTsKPiAgCWNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKmRybV9wbGFuZV9zdGF0ZTsKPiAg
CXU2NCB0b3RhbF9kYXRhX3JhdGUgPSAwOwo+IEBAIC00MjU1LDcgKzQyNTMsNyBAQCBza2xfZ2V0
X3RvdGFsX3JlbGF0aXZlX2RhdGFfcmF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSwKPiAgCQlyZXR1cm4gMDsKPiAgCj4gIAkvKiBDYWxjdWxhdGUgYW5kIGNhY2hlIGRhdGEg
cmF0ZSBmb3IgZWFjaCBwbGFuZSAqLwo+IC0JZHJtX2F0b21pY19jcnRjX3N0YXRlX2Zvcl9lYWNo
X3BsYW5lX3N0YXRlKHBsYW5lLCBkcm1fcGxhbmVfc3RhdGUsICZjcnRjX3N0YXRlLT5iYXNlKSB7
Cj4gKwlkcm1fYXRvbWljX2NydGNfc3RhdGVfZm9yX2VhY2hfcGxhbmVfc3RhdGUocGxhbmUsIGRy
bV9wbGFuZV9zdGF0ZSwgJmNydGNfc3RhdGUtPnVhcGkpIHsKPiAgCQllbnVtIHBsYW5lX2lkIHBs
YW5lX2lkID0gdG9faW50ZWxfcGxhbmUocGxhbmUpLT5pZDsKPiAgCQljb25zdCBzdHJ1Y3QgaW50
ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlID0KPiAgCQkJdG9faW50ZWxfcGxhbmVfc3RhdGUo
ZHJtX3BsYW5lX3N0YXRlKTsKPiBAQCAtNDI4MywxMSArNDI4MSwxMSBAQCBpY2xfZ2V0X3RvdGFs
X3JlbGF0aXZlX2RhdGFfcmF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwK
PiAgCWNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKmRybV9wbGFuZV9zdGF0ZTsKPiAgCXU2
NCB0b3RhbF9kYXRhX3JhdGUgPSAwOwo+ICAKPiAtCWlmIChXQVJOX09OKCFjcnRjX3N0YXRlLT5i
YXNlLnN0YXRlKSkKPiArCWlmIChXQVJOX09OKCFjcnRjX3N0YXRlLT51YXBpLnN0YXRlKSkKPiAg
CQlyZXR1cm4gMDsKPiAgCj4gIAkvKiBDYWxjdWxhdGUgYW5kIGNhY2hlIGRhdGEgcmF0ZSBmb3Ig
ZWFjaCBwbGFuZSAqLwo+IC0JZHJtX2F0b21pY19jcnRjX3N0YXRlX2Zvcl9lYWNoX3BsYW5lX3N0
YXRlKHBsYW5lLCBkcm1fcGxhbmVfc3RhdGUsICZjcnRjX3N0YXRlLT5iYXNlKSB7Cj4gKwlkcm1f
YXRvbWljX2NydGNfc3RhdGVfZm9yX2VhY2hfcGxhbmVfc3RhdGUocGxhbmUsIGRybV9wbGFuZV9z
dGF0ZSwgJmNydGNfc3RhdGUtPnVhcGkpIHsKPiAgCQljb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVf
c3RhdGUgKnBsYW5lX3N0YXRlID0KPiAgCQkJdG9faW50ZWxfcGxhbmVfc3RhdGUoZHJtX3BsYW5l
X3N0YXRlKTsKPiAgCQllbnVtIHBsYW5lX2lkIHBsYW5lX2lkID0gdG9faW50ZWxfcGxhbmUocGxh
bmUpLT5pZDsKPiBAQCAtNDMyOSw4ICs0MzI3LDggQEAgc3RhdGljIGludAo+ICBza2xfYWxsb2Nh
dGVfcGlwZV9kZGIoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gIAkJICAg
ICAgc3RydWN0IHNrbF9kZGJfYWxsb2NhdGlvbiAqZGRiIC8qIG91dCAqLykKPiAgewo+IC0Jc3Ry
dWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0gY3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZTsKPiAt
CXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9IGNydGNfc3RhdGUtPmJhc2UuY3J0YzsKPiArCXN0cnVj
dCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSA9IGNydGNfc3RhdGUtPnVhcGkuc3RhdGU7Cj4gKwlz
dHJ1Y3QgZHJtX2NydGMgKmNydGMgPSBjcnRjX3N0YXRlLT51YXBpLmNydGM7Cj4gIAlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmRldik7Cj4gIAlzdHJ1
Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Yyk7Cj4gIAlzdHJ1
Y3Qgc2tsX2RkYl9lbnRyeSAqYWxsb2MgPSAmY3J0Y19zdGF0ZS0+d20uc2tsLmRkYjsKPiBAQCAt
NDM1Miw3ICs0MzUwLDcgQEAgc2tsX2FsbG9jYXRlX3BpcGVfZGRiKHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlLAo+ICAJaWYgKFdBUk5fT04oIXN0YXRlKSkKPiAgCQlyZXR1cm4g
MDsKPiAgCj4gLQlpZiAoIWNydGNfc3RhdGUtPmJhc2UuYWN0aXZlKSB7Cj4gKwlpZiAoIWNydGNf
c3RhdGUtPmh3LmFjdGl2ZSkgewo+ICAJCWFsbG9jLT5zdGFydCA9IGFsbG9jLT5lbmQgPSAwOwo+
ICAJCXJldHVybiAwOwo+ICAJfQo+IEBAIC00NTk0LDcgKzQ1OTIsNyBAQCBpbnRlbF9nZXRfbGlu
ZXRpbWVfdXMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIAl1
MzIgY3J0Y19odG90YWw7Cj4gIAl1aW50X2ZpeGVkXzE2XzE2X3QgbGluZXRpbWVfdXM7Cj4gIAo+
IC0JaWYgKCFjcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSkKPiArCWlmICghY3J0Y19zdGF0ZS0+aHcu
YWN0aXZlKQo+ICAJCXJldHVybiB1MzJfdG9fZml4ZWQxNigwKTsKPiAgCj4gIAlwaXhlbF9yYXRl
ID0gY3J0Y19zdGF0ZS0+cGl4ZWxfcmF0ZTsKPiBAQCAtNDYwMiw3ICs0NjAwLDcgQEAgaW50ZWxf
Z2V0X2xpbmV0aW1lX3VzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
KQo+ICAJaWYgKFdBUk5fT04ocGl4ZWxfcmF0ZSA9PSAwKSkKPiAgCQlyZXR1cm4gdTMyX3RvX2Zp
eGVkMTYoMCk7Cj4gIAo+IC0JY3J0Y19odG90YWwgPSBjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVk
X21vZGUuY3J0Y19odG90YWw7Cj4gKwljcnRjX2h0b3RhbCA9IGNydGNfc3RhdGUtPmh3LmFkanVz
dGVkX21vZGUuY3J0Y19odG90YWw7Cj4gIAlsaW5ldGltZV91cyA9IGRpdl9maXhlZDE2KGNydGNf
aHRvdGFsICogMTAwMCwgcGl4ZWxfcmF0ZSk7Cj4gIAo+ICAJcmV0dXJuIGxpbmV0aW1lX3VzOwo+
IEBAIC00NjM3LDcgKzQ2MzUsNyBAQCBza2xfY29tcHV0ZV93bV9wYXJhbXMoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gIAkJICAgICAgdTMyIHBsYW5lX3BpeGVs
X3JhdGUsIHN0cnVjdCBza2xfd21fcGFyYW1zICp3cCwKPiAgCQkgICAgICBpbnQgY29sb3JfcGxh
bmUpCj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRj
X3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCXUzMiBpbnRlcm1fcGJw
bDsKPiAgCj4gQEAgLTQ3NjMsNyArNDc2MSw3IEBAIHN0YXRpYyB2b2lkIHNrbF9jb21wdXRlX3Bs
YW5lX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAJCQkJ
IGNvbnN0IHN0cnVjdCBza2xfd21fbGV2ZWwgKnJlc3VsdF9wcmV2LAo+ICAJCQkJIHN0cnVjdCBz
a2xfd21fbGV2ZWwgKnJlc3VsdCAvKiBvdXQgKi8pCj4gIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRl
LT51YXBpLmNydGMtPmRldik7Cj4gIAl1MzIgbGF0ZW5jeSA9IGRldl9wcml2LT53bS5za2xfbGF0
ZW5jeVtsZXZlbF07Cj4gIAl1aW50X2ZpeGVkXzE2XzE2X3QgbWV0aG9kMSwgbWV0aG9kMjsKPiAg
CXVpbnRfZml4ZWRfMTZfMTZfdCBzZWxlY3RlZF9yZXN1bHQ7Cj4gQEAgLTQ3ODksMTQgKzQ3ODcs
MTQgQEAgc3RhdGljIHZvaWQgc2tsX2NvbXB1dGVfcGxhbmVfd20oY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gIAltZXRob2QxID0gc2tsX3dtX21ldGhvZDEoZGV2
X3ByaXYsIHdwLT5wbGFuZV9waXhlbF9yYXRlLAo+ICAJCQkJIHdwLT5jcHAsIGxhdGVuY3ksIHdw
LT5kYnVmX2Jsb2NrX3NpemUpOwo+ICAJbWV0aG9kMiA9IHNrbF93bV9tZXRob2QyKHdwLT5wbGFu
ZV9waXhlbF9yYXRlLAo+IC0JCQkJIGNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRj
X2h0b3RhbCwKPiArCQkJCSBjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfaHRvdGFs
LAo+ICAJCQkJIGxhdGVuY3ksCj4gIAkJCQkgd3AtPnBsYW5lX2Jsb2Nrc19wZXJfbGluZSk7Cj4g
IAo+ICAJaWYgKHdwLT55X3RpbGVkKSB7Cj4gIAkJc2VsZWN0ZWRfcmVzdWx0ID0gbWF4X2ZpeGVk
MTYobWV0aG9kMiwgd3AtPnlfdGlsZV9taW5pbXVtKTsKPiAgCX0gZWxzZSB7Cj4gLQkJaWYgKCh3
cC0+Y3BwICogY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfaHRvdGFsIC8KPiAr
CQlpZiAoKHdwLT5jcHAgKiBjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfaHRvdGFs
IC8KPiAgCQkgICAgIHdwLT5kYnVmX2Jsb2NrX3NpemUgPCAxKSAmJgo+ICAJCSAgICAgKHdwLT5w
bGFuZV9ieXRlc19wZXJfbGluZSAvIHdwLT5kYnVmX2Jsb2NrX3NpemUgPCAxKSkgewo+ICAJCQlz
ZWxlY3RlZF9yZXN1bHQgPSBtZXRob2QyOwo+IEBAIC00ODg3LDcgKzQ4ODUsNyBAQCBza2xfY29t
cHV0ZV93bV9sZXZlbHMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
Cj4gIAkJICAgICAgY29uc3Qgc3RydWN0IHNrbF93bV9wYXJhbXMgKndtX3BhcmFtcywKPiAgCQkg
ICAgICBzdHJ1Y3Qgc2tsX3dtX2xldmVsICpsZXZlbHMpCj4gIHsKPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0
YXRlLT51YXBpLmNydGMtPmRldik7Cj4gIAlpbnQgbGV2ZWwsIG1heF9sZXZlbCA9IGlsa193bV9t
YXhfbGV2ZWwoZGV2X3ByaXYpOwo+ICAJc3RydWN0IHNrbF93bV9sZXZlbCAqcmVzdWx0X3ByZXYg
PSAmbGV2ZWxzWzBdOwo+ICAKPiBAQCAtNDkwNCw3ICs0OTAyLDcgQEAgc2tsX2NvbXB1dGVfd21f
bGV2ZWxzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICBzdGF0
aWMgdTMyCj4gIHNrbF9jb21wdXRlX2xpbmV0aW1lX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3Rh
dGUgPSBjcnRjX3N0YXRlLT5iYXNlLnN0YXRlOwo+ICsJc3RydWN0IGRybV9hdG9taWNfc3RhdGUg
KnN0YXRlID0gY3J0Y19zdGF0ZS0+dWFwaS5zdGF0ZTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoc3RhdGUtPmRldik7Cj4gIAl1aW50X2ZpeGVkXzE2XzE2
X3QgbGluZXRpbWVfdXM7Cj4gIAl1MzIgbGluZXRpbWVfd207Cj4gQEAgLTQ5MjMsNyArNDkyMSw3
IEBAIHN0YXRpYyB2b2lkIHNrbF9jb21wdXRlX3RyYW5zaXRpb25fd20oY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gIAkJCQkgICAgICBjb25zdCBzdHJ1Y3Qgc2ts
X3dtX3BhcmFtcyAqd3AsCj4gIAkJCQkgICAgICBzdHJ1Y3Qgc2tsX3BsYW5lX3dtICp3bSkKPiAg
ewo+IC0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2
Owo+ICsJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2
Owo+ICAJY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShk
ZXYpOwo+ICAJdTE2IHRyYW5zX21pbiwgdHJhbnNfeV90aWxlX21pbjsKPiAgCWNvbnN0IHUxNiB0
cmFuc19hbW91bnQgPSAxMDsgLyogVGhpcyBpcyBjb25maWd1cmFibGUgYW1vdW50ICovCj4gQEAg
LTUwODMsNyArNTA4MSw3IEBAIHN0YXRpYyBpbnQgaWNsX2J1aWxkX3BsYW5lX3dtKHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAKPiAgc3RhdGljIGludCBza2xfYnVpbGRf
cGlwZV93bShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNl
LmNydGMtPmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsKPiAgCXN0cnVjdCBza2xfcGlwZV93bSAq
cGlwZV93bSA9ICZjcnRjX3N0YXRlLT53bS5za2wub3B0aW1hbDsKPiAgCXN0cnVjdCBkcm1fcGxh
bmUgKnBsYW5lOwo+ICAJY29uc3Qgc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqZHJtX3BsYW5lX3N0
YXRlOwo+IEBAIC01MDk2LDcgKzUwOTQsNyBAQCBzdGF0aWMgaW50IHNrbF9idWlsZF9waXBlX3dt
KHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAJbWVtc2V0KHBpcGVfd20t
PnBsYW5lcywgMCwgc2l6ZW9mKHBpcGVfd20tPnBsYW5lcykpOwo+ICAKPiAgCWRybV9hdG9taWNf
Y3J0Y19zdGF0ZV9mb3JfZWFjaF9wbGFuZV9zdGF0ZShwbGFuZSwgZHJtX3BsYW5lX3N0YXRlLAo+
IC0JCQkJCQkgICAmY3J0Y19zdGF0ZS0+YmFzZSkgewo+ICsJCQkJCQkgICAmY3J0Y19zdGF0ZS0+
dWFwaSkgewo+ICAJCWNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUg
PQo+ICAJCQl0b19pbnRlbF9wbGFuZV9zdGF0ZShkcm1fcGxhbmVfc3RhdGUpOwo+ICAKPiBAQCAt
NTI3NSw4ICs1MjczLDggQEAgc3RhdGljIGludAo+ICBza2xfZGRiX2FkZF9hZmZlY3RlZF9wbGFu
ZXMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+ICAJCQkg
ICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1
Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSA9IHRvX2ludGVsX2F0b21pY19zdGF0ZShuZXdf
Y3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZSk7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRv
X2ludGVsX2NydGMobmV3X2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxf
YXRvbWljX3N0YXRlICpzdGF0ZSA9IHRvX2ludGVsX2F0b21pY19zdGF0ZShuZXdfY3J0Y19zdGF0
ZS0+dWFwaS5zdGF0ZSk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2Ny
dGMobmV3X2NydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCXN0cnVjdCBpbnRlbF9w
bGFuZSAqcGxhbmU7Cj4gIAo+IEBAIC01NTc2LDcgKzU1NzQsNyBAQCBzdGF0aWMgaW50IHNrbF93
bV9hZGRfYWZmZWN0ZWRfcGxhbmVzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+
ICAJCSAqIHBvd2VyIHdlbGwgdGhlIGhhcmR3YXJlIHN0YXRlIHdpbGwgZ28gb3V0IG9mIHN5bmMK
PiAgCQkgKiB3aXRoIHRoZSBzb2Z0d2FyZSBzdGF0ZS4KPiAgCQkgKi8KPiAtCQlpZiAoIWRybV9h
dG9taWNfY3J0Y19uZWVkc19tb2Rlc2V0KCZuZXdfY3J0Y19zdGF0ZS0+YmFzZSkgJiYKPiArCQlp
ZiAoIWRybV9hdG9taWNfY3J0Y19uZWVkc19tb2Rlc2V0KCZuZXdfY3J0Y19zdGF0ZS0+dWFwaSkg
JiYKPiAgCQkgICAgc2tsX3BsYW5lX3dtX2VxdWFscyhkZXZfcHJpdiwKPiAgCQkJCQkmb2xkX2Ny
dGNfc3RhdGUtPndtLnNrbC5vcHRpbWFsLnBsYW5lc1twbGFuZV9pZF0sCj4gIAkJCQkJJm5ld19j
cnRjX3N0YXRlLT53bS5za2wub3B0aW1hbC5wbGFuZXNbcGxhbmVfaWRdKSkKPiBAQCAtNTY0Myw3
ICs1NjQxLDcgQEAgc2tsX2NvbXB1dGVfd20oc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3Rh
dGUpCj4gIHN0YXRpYyB2b2lkIHNrbF9hdG9taWNfdXBkYXRlX2NydGNfd20oc3RydWN0IGludGVs
X2F0b21pY19zdGF0ZSAqc3RhdGUsCj4gIAkJCQkgICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoc3RhdGUtPmJhc2UuZGV2KTsKPiAgCXN0
cnVjdCBza2xfcGlwZV93bSAqcGlwZV93bSA9ICZjcnRjX3N0YXRlLT53bS5za2wub3B0aW1hbDsK
PiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiBAQCAtNTY1Nyw3ICs1NjU1LDcgQEAg
c3RhdGljIHZvaWQgc2tsX2F0b21pY191cGRhdGVfY3J0Y193bShzdHJ1Y3QgaW50ZWxfYXRvbWlj
X3N0YXRlICpzdGF0ZSwKPiAgc3RhdGljIHZvaWQgc2tsX2luaXRpYWxfd20oc3RydWN0IGludGVs
X2F0b21pY19zdGF0ZSAqc3RhdGUsCj4gIAkJCSAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2lu
dGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpp
bnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAJc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiA9IGludGVsX2NydGMtPmJhc2UuZGV2Owo+ICAJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ICAJc3RydWN0IHNrbF9k
ZGJfdmFsdWVzICpyZXN1bHRzID0gJnN0YXRlLT53bV9yZXN1bHRzOwo+IEBAIC01NjY3LDcgKzU2
NjUsNyBAQCBzdGF0aWMgdm9pZCBza2xfaW5pdGlhbF93bShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0
YXRlICpzdGF0ZSwKPiAgCj4gIAltdXRleF9sb2NrKCZkZXZfcHJpdi0+d20ud21fbXV0ZXgpOwo+
ICAKPiAtCWlmIChjcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZV9jaGFuZ2VkKQo+ICsJaWYgKGNydGNf
c3RhdGUtPnVhcGkuYWN0aXZlX2NoYW5nZWQpCj4gIAkJc2tsX2F0b21pY191cGRhdGVfY3J0Y193
bShzdGF0ZSwgY3J0Y19zdGF0ZSk7Cj4gIAo+ICAJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+d20u
d21fbXV0ZXgpOwo+IEBAIC01NzI2LDggKzU3MjQsOCBAQCBzdGF0aWMgdm9pZCBpbGtfcHJvZ3Jh
bV93YXRlcm1hcmtzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgc3RhdGlj
IHZvaWQgaWxrX2luaXRpYWxfd2F0ZXJtYXJrcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpz
dGF0ZSwKPiAgCQkJCSAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3Rh
dGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50
ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT51YXBpLmNydGMtPmRldik7Cj4gKwlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5j
cnRjKTsKPiAgCj4gIAltdXRleF9sb2NrKCZkZXZfcHJpdi0+d20ud21fbXV0ZXgpOwo+ICAJY3J0
Yy0+d20uYWN0aXZlLmlsayA9IGNydGNfc3RhdGUtPndtLmlsay5pbnRlcm1lZGlhdGU7Cj4gQEAg
LTU3MzgsOCArNTczNiw4IEBAIHN0YXRpYyB2b2lkIGlsa19pbml0aWFsX3dhdGVybWFya3Moc3Ry
dWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4gIHN0YXRpYyB2b2lkIGlsa19vcHRpbWl6
ZV93YXRlcm1hcmtzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+ICAJCQkJICAg
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+
ZGV2KTsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0
YXRlLT5iYXNlLmNydGMpOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShjcnRjX3N0YXRlLT51YXBpLmNydGMtPmRldik7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCj4gIAlp
ZiAoIWNydGNfc3RhdGUtPndtLm5lZWRfcG9zdHZibF91cGRhdGUpCj4gIAkJcmV0dXJuOwo+IC0t
IAo+IDIuMjAuMQo+IAo+IF9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fCj4gSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdAo+IEludGVsLWdmeEBsaXN0cy5mcmVlZGVz
a3RvcC5vcmcKPiBodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZv
L2ludGVsLWdmeAoKLS0gCk1hdHQgUm9wZXIKR3JhcGhpY3MgU29mdHdhcmUgRW5naW5lZXIKVlRU
LU9TR0MgUGxhdGZvcm0gRW5hYmxlbWVudApJbnRlbCBDb3Jwb3JhdGlvbgooOTE2KSAzNTYtMjc5
NQpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1n
ZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9s
aXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 84B5258EBA
	for <lists+intel-gfx@lfdr.de>; Fri, 28 Jun 2019 01:46:35 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 5A53C6E858;
	Thu, 27 Jun 2019 23:46:33 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7C4B96E853
 for <intel-gfx@lists.freedesktop.org>; Thu, 27 Jun 2019 23:46:32 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 17050789-1500050 for multiple; Fri, 28 Jun 2019 00:46:30 +0100
MIME-Version: 1.0
From: Chris Wilson <chris@chris-wilson.co.uk>
User-Agent: alot/0.6
To: Matthew Auld <matthew.auld@intel.com>, intel-gfx@lists.freedesktop.org
References: <20190627205633.1143-1-matthew.auld@intel.com>
 <20190627205633.1143-16-matthew.auld@intel.com>
In-Reply-To: <20190627205633.1143-16-matthew.auld@intel.com>
Message-ID: <156167918788.21955.11460031588209770309@skylake-alporthouse-com>
Date: Fri, 28 Jun 2019 00:46:27 +0100
Subject: Re: [Intel-gfx] [PATCH v2 15/37] drm/i915/lmem: support CPU
 relocations
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVvdGluZyBNYXR0aGV3IEF1bGQgKDIwMTktMDYtMjcgMjE6NTY6MTEpCj4gQEAgLTEwMjAsMTYg
KzEwMjIsMjMgQEAgc3RhdGljIHZvaWQgcmVsb2NfY2FjaGVfcmVzZXQoc3RydWN0IHJlbG9jX2Nh
Y2hlICpjYWNoZSkKPiAgICAgICAgICAgICAgICAgaTkxNV9nZW1fb2JqZWN0X2ZpbmlzaF9hY2Nl
c3MoKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICopY2FjaGUtPm5vZGUubW0pOwo+ICAgICAg
ICAgfSBlbHNlIHsKPiAgICAgICAgICAgICAgICAgd21iKCk7Cj4gLSAgICAgICAgICAgICAgIGlv
X21hcHBpbmdfdW5tYXBfYXRvbWljKCh2b2lkIF9faW9tZW0gKil2YWRkcik7Cj4gLSAgICAgICAg
ICAgICAgIGlmIChjYWNoZS0+bm9kZS5hbGxvY2F0ZWQpIHsKPiAtICAgICAgICAgICAgICAgICAg
ICAgICBzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0ID0gY2FjaGVfdG9fZ2d0dChjYWNoZSk7Cj4gLQo+
IC0gICAgICAgICAgICAgICAgICAgICAgIGdndHQtPnZtLmNsZWFyX3JhbmdlKCZnZ3R0LT52bSwK
PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWNoZS0+bm9k
ZS5zdGFydCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBj
YWNoZS0+bm9kZS5zaXplKTsKPiAtICAgICAgICAgICAgICAgICAgICAgICBkcm1fbW1fcmVtb3Zl
X25vZGUoJmNhY2hlLT5ub2RlKTsKPiArCj4gKyAgICAgICAgICAgICAgIGlmIChjYWNoZS0+aXNf
bG1lbSkgewo+ICsgICAgICAgICAgICAgICAgICAgICAgIGlvX21hcHBpbmdfdW5tYXBfYXRvbWlj
KCh2b2lkIF9faW9tZW0gKil2YWRkcik7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgaTkxNV9n
ZW1fb2JqZWN0X3VucGluX3BhZ2VzKChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqKWNhY2hl
LT5ub2RlLm1tKTsKPiArICAgICAgICAgICAgICAgICAgICAgICBjYWNoZS0+aXNfbG1lbSA9IGZh
bHNlOwo+ICAgICAgICAgICAgICAgICB9IGVsc2Ugewo+IC0gICAgICAgICAgICAgICAgICAgICAg
IGk5MTVfdm1hX3VucGluKChzdHJ1Y3QgaTkxNV92bWEgKiljYWNoZS0+bm9kZS5tbSk7Cj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgaW9fbWFwcGluZ191bm1hcF9hdG9taWMoKHZvaWQgX19pb21l
bSAqKXZhZGRyKTsKClRoZSBmaXJzdCBzdGVwIG9mIGVhY2ggYnJhbmNoIGlzIHRoZSBzYW1lLiBX
aGF0IGFtIEkgbWlzc2luZz8KCgo+ICsgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYWNoZS0+
bm9kZS5hbGxvY2F0ZWQpIHsKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVj
dCBpOTE1X2dndHQgKmdndHQgPSBjYWNoZV90b19nZ3R0KGNhY2hlKTsKPiArCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBnZ3R0LT52bS5jbGVhcl9yYW5nZSgmZ2d0dC0+dm0sCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWNo
ZS0+bm9kZS5zdGFydCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGNhY2hlLT5ub2RlLnNpemUpOwo+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgZHJtX21tX3JlbW92ZV9ub2RlKCZjYWNoZS0+bm9kZSk7Cj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgfSBlbHNlIHsKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGk5
MTVfdm1hX3VucGluKChzdHJ1Y3QgaTkxNV92bWEgKiljYWNoZS0+bm9kZS5tbSk7Cj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgfQo+ICAgICAgICAgICAgICAgICB9Cj4gICAgICAgICB9Cj4gIAo+
IEBAIC0xMDY5LDYgKzEwNzgsNDAgQEAgc3RhdGljIHZvaWQgKnJlbG9jX2ttYXAoc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKPiAgICAgICAgIHJldHVybiB2YWRkcjsKPiAgfQo+ICAK
PiArc3RhdGljIHZvaWQgKnJlbG9jX2xtZW0oc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
aiwKPiArICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgcmVsb2NfY2FjaGUgKmNhY2hlLAo+
ICsgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgcGFnZSkKPiArewo+ICsgICAg
ICAgdm9pZCAqdmFkZHI7Cj4gKyAgICAgICBpbnQgZXJyOwo+ICsKPiArICAgICAgIEdFTV9CVUdf
T04odXNlX2NwdV9yZWxvYyhjYWNoZSwgb2JqKSk7Cj4gKwo+ICsgICAgICAgaWYgKGNhY2hlLT52
YWRkcikgewo+ICsgICAgICAgICAgICAgICBpb19tYXBwaW5nX3VubWFwX2F0b21pYygodm9pZCBf
X2ZvcmNlIF9faW9tZW0gKikgdW5tYXNrX3BhZ2UoY2FjaGUtPnZhZGRyKSk7Cj4gKyAgICAgICB9
IGVsc2Ugewo+ICsgICAgICAgICAgICAgICBpOTE1X2dlbV9vYmplY3RfbG9jayhvYmopOwo+ICsg
ICAgICAgICAgICAgICBlcnIgPSBpOTE1X2dlbV9vYmplY3Rfc2V0X3RvX3djX2RvbWFpbihvYmos
IHRydWUpOwo+ICsgICAgICAgICAgICAgICBpOTE1X2dlbV9vYmplY3RfdW5sb2NrKG9iaik7Cj4g
KyAgICAgICAgICAgICAgIGlmIChlcnIpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJu
IEVSUl9QVFIoZXJyKTsKPiArCj4gKyAgICAgICAgICAgICAgIGVyciA9IGk5MTVfZ2VtX29iamVj
dF9waW5fcGFnZXMob2JqKTsKPiArICAgICAgICAgICAgICAgaWYgKGVycikKPiArICAgICAgICAg
ICAgICAgICAgICAgICByZXR1cm4gRVJSX1BUUihlcnIpOwo+ICsKPiArICAgICAgICAgICAgICAg
Y2FjaGUtPm5vZGUubW0gPSAodm9pZCAqKW9iajsKPiArICAgICAgICAgICAgICAgY2FjaGUtPmlz
X2xtZW0gPSB0cnVlOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIHZhZGRyID0gaTkxNV9nZW1f
b2JqZWN0X2xtZW1faW9fbWFwX3BhZ2Uob2JqLCBwYWdlKTsKClNlY3JldCBhdG9taWMuIE5vdGlj
ZSB0aGUgYXN5bW1ldHJpYyByZWxlYXNlLgoKPiArICAgICAgIGNhY2hlLT52YWRkciA9ICh1bnNp
Z25lZCBsb25nKXZhZGRyOwo+ICsgICAgICAgY2FjaGUtPnBhZ2UgPSBwYWdlOwo+ICsKPiArICAg
ICAgIHJldHVybiB2YWRkcjsKPiArfQo+ICsKPiAgc3RhdGljIHZvaWQgKnJlbG9jX2lvbWFwKHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCj4gICAgICAgICAgICAgICAgICAgICAgICAg
IHN0cnVjdCByZWxvY19jYWNoZSAqY2FjaGUsCj4gICAgICAgICAgICAgICAgICAgICAgICAgIHVu
c2lnbmVkIGxvbmcgcGFnZSkKPiBAQCAtMTE0NSw4ICsxMTg4LDEyIEBAIHN0YXRpYyB2b2lkICpy
ZWxvY192YWRkcihzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAo+ICAgICAgICAgICAg
ICAgICB2YWRkciA9IHVubWFza19wYWdlKGNhY2hlLT52YWRkcik7Cj4gICAgICAgICB9IGVsc2Ug
ewo+ICAgICAgICAgICAgICAgICB2YWRkciA9IE5VTEw7Cj4gLSAgICAgICAgICAgICAgIGlmICgo
Y2FjaGUtPnZhZGRyICYgS01BUCkgPT0gMCkKPiAtICAgICAgICAgICAgICAgICAgICAgICB2YWRk
ciA9IHJlbG9jX2lvbWFwKG9iaiwgY2FjaGUsIHBhZ2UpOwo+ICsgICAgICAgICAgICAgICBpZiAo
KGNhY2hlLT52YWRkciAmIEtNQVApID09IDApIHsKPiArICAgICAgICAgICAgICAgICAgICAgICBp
ZiAoaTkxNV9nZW1fb2JqZWN0X2lzX2xtZW0ob2JqKSkKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHZhZGRyID0gcmVsb2NfbG1lbShvYmosIGNhY2hlLCBwYWdlKTsKPiArICAgICAg
ICAgICAgICAgICAgICAgICBlbHNlCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2
YWRkciA9IHJlbG9jX2lvbWFwKG9iaiwgY2FjaGUsIHBhZ2UpOwo+ICsgICAgICAgICAgICAgICB9
Cj4gICAgICAgICAgICAgICAgIGlmICghdmFkZHIpCj4gICAgICAgICAgICAgICAgICAgICAgICAg
dmFkZHIgPSByZWxvY19rbWFwKG9iaiwgY2FjaGUsIHBhZ2UpOwo+ICAgICAgICAgfQo+IC0tIAo+
IDIuMjAuMQo+IAo+IF9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fCj4gSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdAo+IEludGVsLWdmeEBsaXN0cy5mcmVlZGVza3Rv
cC5vcmcKPiBodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2lu
dGVsLWdmeApfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJ
bnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0
cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id EAEA9105386
	for <lists+intel-gfx@lfdr.de>; Thu, 21 Nov 2019 14:51:46 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 24E366E10D;
	Thu, 21 Nov 2019 13:51:45 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9D6B86E10D
 for <intel-gfx@lists.freedesktop.org>; Thu, 21 Nov 2019 13:51:41 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19286325-1500050 
 for multiple; Thu, 21 Nov 2019 13:51:35 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 21 Nov 2019 13:51:30 +0000
Message-Id: <20191121135131.338984-4-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191121135131.338984-1-chris@chris-wilson.co.uk>
References: <20191121135131.338984-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 4/5] drm/i915/gt: Adopt engine_park
 synchronisation rules for engine_retire
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

SW4gdGhlIG5leHQgcGF0Y2gsIHdlIHdpbGwgaW50cm9kdWNlIGEgbmV3IGFzeW5jaHJvbm91cyBy
ZXRpcmVtZW50CndvcmtlciwgZmVkIGJ5IGV4ZWNsaXN0cyBDUyBldmVudHMuIEhlcmUgd2UgbWF5
IHF1ZXVlIGEgcmV0aXJlbWVudCBhcwpzb29uIGFzIGEgcmVxdWVzdCBpcyBzdWJtaXR0ZWQgdG8g
SFcgKGFuZCBjb21wbGV0ZXMgaW5zdGFudGx5KSwgYW5kIHdlCmFsc28gd2FudCB0byBwcm9jZXNz
IHRoYXQgcmV0aXJlbWVudCBhcyBlYXJseSBhcyBwb3NzaWJsZSBhbmQgY2Fubm90CmFmZm9yZCB0
byBwb3N0cG9uZSAoYXMgdGhlcmUgbWF5IG5vdCBiZSBhbm90aGVyIG9wcG9ydHVuaXR5IHRvIHJl
dGlyZSBpdApmb3IgYSBmZXcgc2Vjb25kcykuIFRvIGFsbG93IHRoZSBuZXcgYXN5bmMgcmV0aXJl
ciB0byBydW4gaW4gcGFyYWxsZWwKd2l0aCBvdXIgc3VibWlzc2lvbiwgcHVsbCB0aGUgX19pOTE1
X3JlcXVlc3RfcXVldWUgKHRoYXQgcGFzc2VzIHRoZQpyZXF1ZXN0IHRvIEhXKSBpbnNpZGUgdGhl
IHRpbWVsaW5lcyBzcGlubG9jayBzbyB0aGF0IHRoZSByZXRpcmVtZW50CmNhbm5vdCByZWxlYXNl
IHRoZSB0aW1lbGluZSBiZWZvcmUgd2UgaGF2ZSBjb21wbGV0ZWQgdGhlIHN1Ym1pc3Npb24uCgpT
aWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KQ2M6
IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBpbnRlbC5jb20+Ci0tLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMgfCAyOSArKysrKysrKysrKysrKysrLS0t
LS0tLQogMSBmaWxlIGNoYW5nZWQsIDIxIGluc2VydGlvbnMoKyksIDggZGVsZXRpb25zKC0pCgpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uYwppbmRleCAzNzNhNGI5ZjE1
OWMuLmJkMGFmMDJiZWExNiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZW5naW5lX3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5l
X3BtLmMKQEAgLTc0LDE4ICs3NCwzMyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgX190aW1lbGluZV9t
YXJrX3VubG9jayhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCiAjZW5kaWYgLyogIUlTX0VOQUJM
RUQoQ09ORklHX0xPQ0tERVApICovCiAKIHN0YXRpYyB2b2lkCi1fX2ludGVsX3RpbWVsaW5lX2Vu
dGVyX2FuZF9yZWxlYXNlX3BtKHN0cnVjdCBpbnRlbF90aW1lbGluZSAqdGwsCi0JCQkJICAgICAg
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQorX19xdWV1ZV9hbmRfcmVsZWFzZV9wbShz
dHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKKwkJICAgICAgIHN0cnVjdCBpbnRlbF90aW1lbGluZSAq
dGwsCisJCSAgICAgICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7CiAJc3RydWN0
IGludGVsX2d0X3RpbWVsaW5lcyAqdGltZWxpbmVzID0gJmVuZ2luZS0+Z3QtPnRpbWVsaW5lczsK
IAorCS8qCisJICogV2UgaGF2ZSB0byBzZXJpYWxpc2UgYWxsIHBvdGVudGlhbCByZXRpcmVtZW50
IHBhdGhzIHdpdGggb3VyCisJICogc3VibWlzc2lvbiwgYXMgd2UgZG9uJ3Qgd2FudCB0byB1bmRl
cmZsb3cgZWl0aGVyIHRoZQorCSAqIGVuZ2luZS0+d2FrZXJlZi5jb3VudGVyIG9yIG91ciB0aW1l
bGluZS0+YWN0aXZlX2NvdW50LgorCSAqCisJICogRXF1YWxseSwgd2UgY2Fubm90IGFsbG93IGEg
bmV3IHN1Ym1pc3Npb24gdG8gc3RhcnQgdW50aWwKKwkgKiBhZnRlciB3ZSBmaW5pc2ggcXVldWVp
bmcsIG5vciBjb3VsZCB3ZSBhbGxvdyB0aGF0IHN1Ym1pdHRlcgorCSAqIHRvIHJldGlyZSB1cyBi
ZWZvcmUgd2UgYXJlIHJlYWR5IQorCSAqLwogCXNwaW5fbG9jaygmdGltZWxpbmVzLT5sb2NrKTsK
IAotCWlmICghYXRvbWljX2ZldGNoX2luYygmdGwtPmFjdGl2ZV9jb3VudCkpCi0JCWxpc3RfYWRk
X3RhaWwoJnRsLT5saW5rLCAmdGltZWxpbmVzLT5hY3RpdmVfbGlzdCk7CisJLyogSGFuZCB0aGUg
cmVxdWVzdCBvdmVyIHRvIEhXIGFuZCBzbyBlbmdpbmVfcmV0aXJlKCkgKi8KKwlfX2k5MTVfcmVx
dWVzdF9xdWV1ZShycSwgTlVMTCk7CiAKKwkvKiBMZXQgbmV3IHN1Ym1pc3Npb25zIGNvbW1lbmNl
IChhbmQgbWF5YmUgcmV0aXJlIHRoaXMgdGltZWxpbmUpICovCiAJX19pbnRlbF93YWtlcmVmX2Rl
ZmVyX3BhcmsoJmVuZ2luZS0+d2FrZXJlZik7CiAKKwkvKiBMZXQgaW50ZWxfZ3RfcmV0aXJlX3Jl
cXVlc3RzKCkgcmV0aXJlIHVzICovCisJaWYgKCFhdG9taWNfZmV0Y2hfaW5jKCZ0bC0+YWN0aXZl
X2NvdW50KSkKKwkJbGlzdF9hZGRfdGFpbCgmdGwtPmxpbmssICZ0aW1lbGluZXMtPmFjdGl2ZV9s
aXN0KTsKKwogCXNwaW5fdW5sb2NrKCZ0aW1lbGluZXMtPmxvY2spOwogfQogCkBAIC0xNDgsMTAg
KzE2Myw4IEBAIHN0YXRpYyBib29sIHN3aXRjaF90b19rZXJuZWxfY29udGV4dChzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJcnEtPnNjaGVkLmF0dHIucHJpb3JpdHkgPSBJOTE1X1BS
SU9SSVRZX0JBUlJJRVI7CiAJX19pOTE1X3JlcXVlc3RfY29tbWl0KHJxKTsKIAotCV9faTkxNV9y
ZXF1ZXN0X3F1ZXVlKHJxLCBOVUxMKTsKLQotCS8qIEV4cG9zZSBvdXJzZWx2ZXMgdG8gaW50ZWxf
Z3RfcmV0aXJlX3JlcXVlc3RzKCkgYW5kIG5ldyBzdWJtaXNzaW9uICovCi0JX19pbnRlbF90aW1l
bGluZV9lbnRlcl9hbmRfcmVsZWFzZV9wbShjZS0+dGltZWxpbmUsIGVuZ2luZSk7CisJLyogRXhw
b3NlIG91cnNlbHZlcyB0byB0aGUgd29ybGQgKi8KKwlfX3F1ZXVlX2FuZF9yZWxlYXNlX3BtKHJx
LCBjZS0+dGltZWxpbmUsIGVuZ2luZSk7CiAKIAlyZXN1bHQgPSBmYWxzZTsKIG91dF91bmxvY2s6
Ci0tIAoyLjI0LjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9y
ZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdm
eA==

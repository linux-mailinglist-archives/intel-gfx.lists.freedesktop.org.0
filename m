Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id D29EF2B2073
	for <lists+intel-gfx@lfdr.de>; Fri, 13 Nov 2020 17:28:34 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 356AF6E566;
	Fri, 13 Nov 2020 16:28:33 +0000 (UTC)
X-Original-To: Intel-gfx@lists.freedesktop.org
Delivered-To: Intel-gfx@lists.freedesktop.org
Received: from mga06.intel.com (mga06.intel.com [134.134.136.31])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0A7A56E56A;
 Fri, 13 Nov 2020 16:28:32 +0000 (UTC)
IronPort-SDR: x3OCaorTCdG8oa/PyBEx8sOt1AFHNMXpYP8zehS659hsRgkppbPJmij30ebIOmqjFRUosCmqmu
 EAz76DL91dew==
X-IronPort-AV: E=McAfee;i="6000,8403,9804"; a="232113225"
X-IronPort-AV: E=Sophos;i="5.77,476,1596524400"; d="scan'208";a="232113225"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga004.jf.intel.com ([10.7.209.38])
 by orsmga104.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 13 Nov 2020 08:28:31 -0800
IronPort-SDR: 9u4KmjZPJQCFYimTi0j2jfNtl9VjPiJt50nvDt923XWXHEgVJJCKPZTZqLx3w92K2khXUs+JYT
 r/ISnMXeWvZA==
X-IronPort-AV: E=Sophos;i="5.77,476,1596524400"; d="scan'208";a="474721229"
Received: from shalomzo-mobl1.ger.corp.intel.com (HELO localhost.localdomain)
 ([10.251.180.188])
 by orsmga004-auth.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 13 Nov 2020 08:28:29 -0800
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
To: igt-dev@lists.freedesktop.org
Date: Fri, 13 Nov 2020 16:27:32 +0000
Message-Id: <20201113162736.2434791-2-tvrtko.ursulin@linux.intel.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20201113162736.2434791-1-tvrtko.ursulin@linux.intel.com>
References: <20201113162736.2434791-1-tvrtko.ursulin@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [RFC i-g-t 1/5] intel_gpu_top: User friendly device
 listing
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Intel-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KCkFkZGluZyBh
IG5ldyBkZXZpY2Ugc2VsZWN0aW9uIHByaW50IHR5cGUgc3VpdGFibGUgZm9yIHVzZXItZmFjaW5n
CnVzZSBjYXNlcyBsaWtlIGludGVsX2dwdV90b3AgLUwgYW5kIGxhdGVyIGxzZ3B1LgoKSW5zdGVh
ZCBvZjoKCnN5czovc3lzL2RldmljZXMvcGNpMDAwMDowMC8wMDAwOjAwOjAyLjAvZHJtL2NhcmQw
CiAgICBzdWJzeXN0ZW0gICAgICAgOiBkcm0KICAgIGRybSBjYXJkICAgICAgICA6IC9kZXYvZHJp
L2NhcmQwCiAgICBwYXJlbnQgICAgICAgICAgOiBzeXM6L3N5cy9kZXZpY2VzL3BjaTAwMDA6MDAv
MDAwMDowMDowMi4wCgpzeXM6L3N5cy9kZXZpY2VzL3BjaTAwMDA6MDAvMDAwMDowMDowMi4wL2Ry
bS9yZW5kZXJEMTI4CiAgICBzdWJzeXN0ZW0gICAgICAgOiBkcm0KICAgIGRybSByZW5kZXIgICAg
ICA6IC9kZXYvZHJpL3JlbmRlckQxMjgKICAgIHBhcmVudCAgICAgICAgICA6IHN5czovc3lzL2Rl
dmljZXMvcGNpMDAwMDowMC8wMDAwOjAwOjAyLjAKCnN5czovc3lzL2RldmljZXMvcGNpMDAwMDow
MC8wMDAwOjAwOjAyLjAKICAgIHN1YnN5c3RlbSAgICAgICA6IHBjaQogICAgZHJtIGNhcmQgICAg
ICAgIDogL2Rldi9kcmkvY2FyZDAKICAgIGRybSByZW5kZXIgICAgICA6IC9kZXYvZHJpL3JlbmRl
ckQxMjgKICAgIHZlbmRvciAgICAgICAgICA6IDgwODYKICAgIGRldmljZSAgICAgICAgICA6IDE5
M0IKCk5ldyBmb3JtYXQgbG9va3MgbGlrZToKCmNhcmQwICAgICAgICAgICAgICAgICAgIDgwODY6
MTkzQiAgICBkcm06L2Rldi9kcmkvY2FyZDAK4pSU4pSAcmVuZGVyRDEyOCAgICAgICAgICAgICAg
ICAgICAgICAgICBkcm06L2Rldi9kcmkvcmVuZGVyRDEyOAoKQWR2YW50YWdlcyBhcmUgbW9yZSBj
b21wYWN0LCBtb3JlIHJlYWRhYmxlLCBvbmUgZW50cnkgcGVyIEdQVSwgc2hvcnRlcgpzdHJpbmcg
dG8gY29weSBhbmQgcGFzdGUgdG8gaW50ZWxfZ3B1X3RvcCAtZCwgb3IgcmVzcGVjdGl2ZSB1c2Fn
ZS4KCnYyOgogKiBJbmNyZWFzZSBzdGFjayBmaWx0ZXIgc2l6ZS4gKFpiaWduaWV3KQoKU2lnbmVk
LW9mZi1ieTogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KQ2M6IFBl
dHJpIExhdHZhbGEgPHBldHJpLmxhdHZhbGFAaW50ZWwuY29tPgpDYzogWmJpZ25pZXcgS2VtcGN6
ecWEc2tpIDx6Ymlnbmlldy5rZW1wY3p5bnNraUBpbnRlbC5jb20+ClJldmlld2VkLWJ5OiBaYmln
bmlldyBLZW1wY3p5xYRza2kgPHpiaWduaWV3LmtlbXBjenluc2tpQGludGVsLmNvbT4KLS0tCiBs
aWIvaWd0X2RldmljZV9zY2FuLmMgfCAxMDkgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKy0tLS0tCiBsaWIvaWd0X2RldmljZV9zY2FuLmggfCAgIDEgKwogdG9vbHMvaW50ZWxf
Z3B1X3RvcC5jIHwgICAzICstCiAzIGZpbGVzIGNoYW5nZWQsIDEwMCBpbnNlcnRpb25zKCspLCAx
MyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9saWIvaWd0X2RldmljZV9zY2FuLmMgYi9saWIv
aWd0X2RldmljZV9zY2FuLmMKaW5kZXggYzU4MWEzMWFlNTVlLi5jMGNkNjc1N2ZjMjcgMTAwNjQ0
Ci0tLSBhL2xpYi9pZ3RfZGV2aWNlX3NjYW4uYworKysgYi9saWIvaWd0X2RldmljZV9zY2FuLmMK
QEAgLTczNSwxOCArNzM1LDI2IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBfcHJfc2ltcGxlMihjb25z
dCBjaGFyICprLCBjb25zdCBjaGFyICp2MSwgY29uc3QgY2hhciAqdjIpCiAJcHJpbnRmKCIgICAg
JS0xNnM6ICVzOiVzXG4iLCBrLCB2MSwgdjIpOwogfQogCi1zdGF0aWMgdm9pZCBpZ3RfZGV2c19w
cmludF9zaW1wbGUoc3RydWN0IGlndF9saXN0X2hlYWQgKnZpZXcpCitzdGF0aWMgYm9vbCBfX2No
ZWNrX2VtcHR5KHN0cnVjdCBpZ3RfbGlzdF9oZWFkICp2aWV3KQogewotCXN0cnVjdCBpZ3RfZGV2
aWNlICpkZXY7Ci0KIAlpZiAoIXZpZXcpCi0JCXJldHVybjsKKwkJcmV0dXJuIHRydWU7CiAKIAlp
ZiAoaWd0X2xpc3RfZW1wdHkodmlldykpIHsKIAkJcHJpbnRmKCJObyBHUFUgZGV2aWNlcyBmb3Vu
ZFxuIik7Ci0JCXJldHVybjsKKwkJcmV0dXJuIHRydWU7CiAJfQogCisJcmV0dXJuIGZhbHNlOwor
fQorCitzdGF0aWMgdm9pZCBpZ3RfZGV2c19wcmludF9zaW1wbGUoc3RydWN0IGlndF9saXN0X2hl
YWQgKnZpZXcpCit7CisJc3RydWN0IGlndF9kZXZpY2UgKmRldjsKKworCWlmIChfX2NoZWNrX2Vt
cHR5KHZpZXcpKQorCQlyZXR1cm47CisKIAlpZ3RfbGlzdF9mb3JfZWFjaF9lbnRyeShkZXYsIHZp
ZXcsIGxpbmspIHsKIAkJcHJpbnRmKCJzeXM6JXNcbiIsIGRldi0+c3lzcGF0aCk7CiAJCWlmIChk
ZXYtPnN1YnN5c3RlbSkKQEAgLTc2OCw2ICs3NzYsODkgQEAgc3RhdGljIHZvaWQgaWd0X2RldnNf
cHJpbnRfc2ltcGxlKHN0cnVjdCBpZ3RfbGlzdF9oZWFkICp2aWV3KQogCX0KIH0KIAorc3RhdGlj
IHN0cnVjdCBpZ3RfZGV2aWNlICoKK19fZmluZF9wY2koc3RydWN0IGlndF9saXN0X2hlYWQgKnZp
ZXcsIGNvbnN0IGNoYXIgKmRybSkKK3sKKwlzdHJ1Y3QgaWd0X2RldmljZSAqZGV2OworCisJaWd0
X2xpc3RfZm9yX2VhY2hfZW50cnkoZGV2LCB2aWV3LCBsaW5rKSB7CisJCWlmICghaXNfcGNpX3N1
YnN5c3RlbShkZXYpIHx8ICFkZXYtPmRybV9jYXJkKQorCQkJY29udGludWU7CisKKwkJaWYgKCFz
dHJjbXAoZGV2LT5kcm1fY2FyZCwgZHJtKSkKKwkJCXJldHVybiBkZXY7CisJfQorCisJcmV0dXJu
IE5VTEw7Cit9CisKK3N0YXRpYyB2b2lkIGlndF9kZXZzX3ByaW50X3VzZXIoc3RydWN0IGlndF9s
aXN0X2hlYWQgKnZpZXcpCit7CisJc3RydWN0IGlndF9kZXZpY2UgKmRldjsKKworCWlmIChfX2No
ZWNrX2VtcHR5KHZpZXcpKQorCQlyZXR1cm47CisKKwlpZ3RfbGlzdF9mb3JfZWFjaF9lbnRyeShk
ZXYsIHZpZXcsIGxpbmspIHsKKwkJdW5zaWduZWQgaW50IGksIG51bV9jaGlsZHJlbjsKKwkJc3Ry
dWN0IGlndF9kZXZpY2UgKnBjaV9kZXY7CisJCXN0cnVjdCBpZ3RfZGV2aWNlICpkZXYyOworCQlj
aGFyIGZpbHRlclsyNTZdOworCQljaGFyICpkcm1fbmFtZTsKKwkJaW50IHJldDsKKworCQlpZiAo
IWlzX2RybV9zdWJzeXN0ZW0oZGV2KSkKKwkJCWNvbnRpbnVlOworCQlpZiAoIWRldi0+ZHJtX2Nh
cmQgfHwgZGV2LT5kcm1fcmVuZGVyKQorCQkJY29udGludWU7CisKKwkJZHJtX25hbWUgPSByaW5k
ZXgoZGV2LT5kcm1fY2FyZCwgJy8nKTsKKwkJaWYgKCFkcm1fbmFtZSB8fCAhKisrZHJtX25hbWUp
CisJCQljb250aW51ZTsKKworCQlyZXQgPSBzbnByaW50ZihmaWx0ZXIsIHNpemVvZihmaWx0ZXIp
LCAiZHJtOiVzIiwgZGV2LT5kcm1fY2FyZCk7CisJCWlndF9hc3NlcnQocmV0IDwgc2l6ZW9mKGZp
bHRlcikpOworCisJCXBjaV9kZXYgPSBfX2ZpbmRfcGNpKHZpZXcsIGRldi0+ZHJtX2NhcmQpOwor
CQlpZiAocGNpX2RldikKKwkJCXByaW50ZigiJS0yNHMlNHM6JTRzICAgICVzXG4iLAorCQkJICAg
ICAgIGRybV9uYW1lLCBwY2lfZGV2LT52ZW5kb3IsIHBjaV9kZXYtPmRldmljZSwKKwkJCSAgICAg
ICBmaWx0ZXIpOworCQllbHNlCisJCQlwcmludGYoIiUtMjRzICAgICAgICAgICAgICVzXG4iLCBk
cm1fbmFtZSwgZmlsdGVyKTsKKworCQludW1fY2hpbGRyZW4gPSAwOworCQlpZ3RfbGlzdF9mb3Jf
ZWFjaF9lbnRyeShkZXYyLCB2aWV3LCBsaW5rKSB7CisJCQlpZiAoIWlzX2RybV9zdWJzeXN0ZW0o
ZGV2MikgfHwgIWRldjItPmRybV9yZW5kZXIpCisJCQkJY29udGludWU7CisJCQlpZiAoc3RyY21w
KGRldjItPnBhcmVudC0+c3lzcGF0aCwgZGV2LT5wYXJlbnQtPnN5c3BhdGgpKQorCQkJCWNvbnRp
bnVlOworCisJCQludW1fY2hpbGRyZW4rKzsKKwkJfQorCisJCWkgPSAwOworCQlpZ3RfbGlzdF9m
b3JfZWFjaF9lbnRyeShkZXYyLCB2aWV3LCBsaW5rKSB7CisJCQlpZiAoIWlzX2RybV9zdWJzeXN0
ZW0oZGV2MikgfHwgIWRldjItPmRybV9yZW5kZXIpCisJCQkJY29udGludWU7CisJCQlpZiAoc3Ry
Y21wKGRldjItPnBhcmVudC0+c3lzcGF0aCwgZGV2LT5wYXJlbnQtPnN5c3BhdGgpKQorCQkJCWNv
bnRpbnVlOworCisJCQlkcm1fbmFtZSA9IHJpbmRleChkZXYyLT5kcm1fcmVuZGVyLCAnLycpOwor
CQkJaWYgKCFkcm1fbmFtZSB8fCAhKisrZHJtX25hbWUpCisJCQkJY29udGludWU7CisKKwkJCXJl
dCA9IHNucHJpbnRmKGZpbHRlciwgc2l6ZW9mKGZpbHRlciksICJkcm06JXMiLAorCQkJCSAgICAg
ICBkZXYyLT5kcm1fcmVuZGVyKTsKKwkJCWlndF9hc3NlcnQocmV0IDwgc2l6ZW9mKGZpbHRlcikp
OworCisJCQlwcmludGYoIiVzJS0yMnMgICAgICAgICAgICAgJXNcbiIsCisJCQkgICAgICAgKCsr
aSA9PSBudW1fY2hpbGRyZW4pID8gIuKUlOKUgCIgOiAi4pSc4pSAIiwKKwkJCSAgICAgICBkcm1f
bmFtZSwgZmlsdGVyKTsKKwkJfQorCX0KK30KKwogc3RhdGljIGlubGluZSB2b2lkIF9wcmludF9r
ZXlfdmFsdWUoY29uc3QgY2hhciogaywgY29uc3QgY2hhciAqdikKIHsKIAlwcmludGYoIiUtMzJz
OiAlc1xuIiwgaywgdik7CkBAIC03OTIsMTQgKzg4Myw5IEBAIHN0YXRpYyB2b2lkIGlndF9kZXZz
X3ByaW50X2RldGFpbChzdHJ1Y3QgaWd0X2xpc3RfaGVhZCAqdmlldykKIHsKIAlzdHJ1Y3QgaWd0
X2RldmljZSAqZGV2OwogCi0JaWYgKCF2aWV3KQorCWlmIChfX2NoZWNrX2VtcHR5KHZpZXcpKQog
CQlyZXR1cm47CiAKLQlpZiAoaWd0X2xpc3RfZW1wdHkodmlldykpIHsKLQkJcHJpbnRmKCJObyBH
UFUgZGV2aWNlcyBmb3VuZFxuIik7Ci0JCXJldHVybjsKLQl9Ci0KIAlpZ3RfbGlzdF9mb3JfZWFj
aF9lbnRyeShkZXYsIHZpZXcsIGxpbmspIHsKIAkJcHJpbnRmKCI9PT09PT09PT09ICVzOiVzID09
PT09PT09PT1cbiIsCiAJCSAgICAgICBkZXYtPnN1YnN5c3RlbSwgZGV2LT5zeXNwYXRoKTsKQEAg
LTgyMSw2ICs5MDcsNyBAQCBzdGF0aWMgc3RydWN0IHByaW50X2Z1bmMgewogfSBwcmludF9mdW5j
dGlvbnNbXSA9IHsKIAlbSUdUX1BSSU5UX1NJTVBMRV0gPSB7IC5wcm4gPSBpZ3RfZGV2c19wcmlu
dF9zaW1wbGUgfSwKIAlbSUdUX1BSSU5UX0RFVEFJTF0gPSB7IC5wcm4gPSBpZ3RfZGV2c19wcmlu
dF9kZXRhaWwgfSwKKwlbSUdUX1BSSU5UX1VTRVJdID0geyAucHJuID0gaWd0X2RldnNfcHJpbnRf
dXNlciB9LAogfTsKIAogLyoqCmRpZmYgLS1naXQgYS9saWIvaWd0X2RldmljZV9zY2FuLmggYi9s
aWIvaWd0X2RldmljZV9zY2FuLmgKaW5kZXggOTlkYWVlMGM1MmQ2Li45ODIyYzIyY2I2OWMgMTAw
NjQ0Ci0tLSBhL2xpYi9pZ3RfZGV2aWNlX3NjYW4uaAorKysgYi9saWIvaWd0X2RldmljZV9zY2Fu
LmgKQEAgLTM3LDYgKzM3LDcgQEAKIGVudW0gaWd0X2RldmljZXNfcHJpbnRfdHlwZSB7CiAJSUdU
X1BSSU5UX1NJTVBMRSwKIAlJR1RfUFJJTlRfREVUQUlMLAorCUlHVF9QUklOVF9VU0VSLCAvKiBF
bmQgdXNlciBmcmllbmRseS4gKi8KIH07CiAKICNkZWZpbmUgSU5URUdSQVRFRF9JOTE1X0dQVV9Q
Q0lfSUQgIjAwMDA6MDA6MDIuMCIKZGlmZiAtLWdpdCBhL3Rvb2xzL2ludGVsX2dwdV90b3AuYyBi
L3Rvb2xzL2ludGVsX2dwdV90b3AuYwppbmRleCAyOThkZWZhNGU2ZWQuLjUyMzA0NzJkMmFmNCAx
MDA2NDQKLS0tIGEvdG9vbHMvaW50ZWxfZ3B1X3RvcC5jCisrKyBiL3Rvb2xzL2ludGVsX2dwdV90
b3AuYwpAQCAtMTMxMyw3ICsxMzEzLDYgQEAgaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKiphcmd2
KQogCXVuc2lnbmVkIGludCBpOwogCWludCByZXQgPSAwLCBjaDsKIAlib29sIGxpc3RfZGV2aWNl
ID0gZmFsc2U7Ci0JZW51bSBpZ3RfZGV2aWNlc19wcmludF90eXBlIHByaW50dHlwZSA9IElHVF9Q
UklOVF9TSU1QTEU7CiAJY2hhciAqcG11X2RldmljZSwgKm9wdF9kZXZpY2UgPSBOVUxMOwogCXN0
cnVjdCBpZ3RfZGV2aWNlX2NhcmQgY2FyZDsKIApAQCAtMTM4OCw3ICsxMzg3LDcgQEAgaW50IG1h
aW4oaW50IGFyZ2MsIGNoYXIgKiphcmd2KQogCWlndF9kZXZpY2VzX3NjYW4oZmFsc2UpOwogCiAJ
aWYgKGxpc3RfZGV2aWNlKSB7Ci0JCWlndF9kZXZpY2VzX3ByaW50KHByaW50dHlwZSk7CisJCWln
dF9kZXZpY2VzX3ByaW50KElHVF9QUklOVF9VU0VSKTsKIAkJZ290byBleGl0OwogCX0KIAotLSAK
Mi4yNS4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJ
bnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0
cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZngK

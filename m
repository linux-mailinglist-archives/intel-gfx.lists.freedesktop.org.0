Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 28FFC76130
	for <lists+intel-gfx@lfdr.de>; Fri, 26 Jul 2019 10:46:52 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C79F46E8B8;
	Fri, 26 Jul 2019 08:46:48 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 919A56E8AD
 for <intel-gfx@lists.freedesktop.org>; Fri, 26 Jul 2019 08:46:29 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17621086-1500050 
 for multiple; Fri, 26 Jul 2019 09:46:16 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 26 Jul 2019 09:45:59 +0100
Message-Id: <20190726084613.22129-13-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20190726084613.22129-1-chris@chris-wilson.co.uk>
References: <20190726084613.22129-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 13/27] drm/i915: Introduce for_each_user_engine()
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Tm93IHRoYXQgd2UgaGF2ZSBhIGNvbXBhY3QgdHJlZSByZXByZXNlbnRhdGlvbiBmb3IgdWFiaSBl
bmdpbmVzLCBtYWtlCnVzZSBvZiBpdCBmb3Igd2Fsa2luZyBhbGwgdXNlciBlbmdpbmVzIGZyb20g
Y2F0Y2hhbGwgdXNlciBpbnRlcmZhY2VzCmxpa2UgZGVidWdmcyBhbmQgY2FwYWJpbGl0aWVzLgoK
U2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Ci0t
LQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMgICAgIHwgIDYgKyst
LS0KIC4uLi9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYyB8ICAyICst
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2NtZF9wYXJzZXIuYyAgICAgICAgfCAgMyArLS0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jICAgICAgICAgICB8IDIzICsrKysr
KystLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggICAgICAgICAg
ICAgICB8ICA4ICsrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcXVlcnkuYyAgICAg
ICAgICAgICB8ICAzICstLQogNiBmaWxlcyBjaGFuZ2VkLCAyMSBpbnNlcnRpb25zKCspLCAyNCBk
ZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9l
bmdpbmVfY3MuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jCmlu
ZGV4IDU5MzU3MDI0NzhjYS4uMDk1ZGRjYmQ3NWJmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9lbmdpbmVfY3MuYwpAQCAtNjk0LDEyICs2OTQsMTEgQEAgdm9pZCBpbnRlbF9lbmdp
bmVzX3NldF9zY2hlZHVsZXJfY2FwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKICN1
bmRlZiBNQVAKIAl9OwogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKLQllbnVtIGlu
dGVsX2VuZ2luZV9pZCBpZDsKIAl1MzIgZW5hYmxlZCwgZGlzYWJsZWQ7CiAKIAllbmFibGVkID0g
MDsKIAlkaXNhYmxlZCA9IDA7Ci0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsg
LyogYWxsIGVuZ2luZXMgbXVzdCBhZ3JlZSEgKi8KKwlmb3JfZWFjaF91c2VyX2VuZ2luZShlbmdp
bmUsIGk5MTUpIHsgLyogYWxsIGVuZ2luZXMgbXVzdCBhZ3JlZSEgKi8KIAkJaW50IGk7CiAKIAkJ
aWYgKGVuZ2luZS0+c2NoZWR1bGUpCkBAIC0xMTk0LDExICsxMTkzLDEwIEBAIGJvb2wgaW50ZWxf
ZW5naW5lX2Nhbl9zdG9yZV9kd29yZChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB1
bnNpZ25lZCBpbnQgaW50ZWxfZW5naW5lc19oYXNfY29udGV4dF9pc29sYXRpb24oc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
OwotCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwogCXVuc2lnbmVkIGludCB3aGljaDsKIAogCXdo
aWNoID0gMDsKLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkKKwlmb3JfZWFjaF91
c2VyX2VuZ2luZShlbmdpbmUsIGk5MTUpCiAJCWlmIChlbmdpbmUtPmRlZmF1bHRfc3RhdGUpCiAJ
CQl3aGljaCB8PSBCSVQoZW5naW5lLT51YWJpX2NsYXNzKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9uLmMKaW5kZXggYjQyMzhmZTE2YTAz
Li5kOTFlNDk2NzIxN2UgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2lu
dGVsX2d1Y19zdWJtaXNzaW9uLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50
ZWxfZ3VjX3N1Ym1pc3Npb24uYwpAQCAtNDg4LDcgKzQ4OCw3IEBAIHN0YXRpYyB2b2lkIGd1Y19h
ZGRfcmVxdWVzdChzdHJ1Y3QgaW50ZWxfZ3VjICpndWMsIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJx
KQogCQkJICAgcmluZ190YWlsLCBycS0+ZmVuY2Uuc2Vxbm8pOwogCWd1Y19yaW5nX2Rvb3JiZWxs
KGNsaWVudCk7CiAKLQljbGllbnQtPnN1Ym1pc3Npb25zW2VuZ2luZS0+aWRdICs9IDE7CisJY2xp
ZW50LT5zdWJtaXNzaW9uc1tlbmdpbmUtPmd1Y19pZF0gKz0gMTsKIH0KIAogLyoKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfY21kX3BhcnNlci5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9jbWRfcGFyc2VyLmMKaW5kZXggYTI4YmNkMmQ3YzA5Li43MzBjMWVkNmQy
YTcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfY21kX3BhcnNlci5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfY21kX3BhcnNlci5jCkBAIC0xMzUyLDExICsx
MzUyLDEwIEBAIGludCBpbnRlbF9lbmdpbmVfY21kX3BhcnNlcihzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUsCiBpbnQgaTkxNV9jbWRfcGFyc2VyX2dldF92ZXJzaW9uKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmU7Ci0JZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CiAJYm9vbCBhY3RpdmUgPSBmYWxzZTsKIAog
CS8qIElmIHRoZSBjb21tYW5kIHBhcnNlciBpcyBub3QgZW5hYmxlZCwgcmVwb3J0IDAgLSB1bnN1
cHBvcnRlZCAqLwotCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGRldl9wcml2LCBpZCkgeworCWZv
cl9lYWNoX3VzZXJfZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYpIHsKIAkJaWYgKGludGVsX2VuZ2lu
ZV9uZWVkc19jbWRfcGFyc2VyKGVuZ2luZSkpIHsKIAkJCWFjdGl2ZSA9IHRydWU7CiAJCQlicmVh
azsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKaW5kZXggMjIzMzczODg1MjAxLi5hNTFh
MGM4ZThhODMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCkBAIC0zMDEsMTAgKzMw
MSw5IEBAIHN0YXRpYyB2b2lkIHByaW50X2JhdGNoX3Bvb2xfc3RhdHMoc3RydWN0IHNlcV9maWxl
ICptLAogCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CiAJc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lOwogCXN0cnVjdCBmaWxlX3N0YXRzIHN0YXRzID0ge307Ci0JZW51bSBp
bnRlbF9lbmdpbmVfaWQgaWQ7CiAJaW50IGo7CiAKLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBk
ZXZfcHJpdiwgaWQpIHsKKwlmb3JfZWFjaF91c2VyX2VuZ2luZShlbmdpbmUsIGRldl9wcml2KSB7
CiAJCWZvciAoaiA9IDA7IGogPCBBUlJBWV9TSVpFKGVuZ2luZS0+YmF0Y2hfcG9vbC5jYWNoZV9s
aXN0KTsgaisrKSB7CiAJCQlsaXN0X2Zvcl9lYWNoX2VudHJ5KG9iaiwKIAkJCQkJICAgICZlbmdp
bmUtPmJhdGNoX3Bvb2wuY2FjaGVfbGlzdFtqXSwKQEAgLTM5MSw3ICszOTAsNiBAQCBzdGF0aWMg
aW50IGk5MTVfZ2VtX2JhdGNoX3Bvb2xfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRh
dGEpCiAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZkZXZfcHJpdi0+ZHJtOwogCXN0cnVjdCBk
cm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
OwotCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwogCWludCB0b3RhbCA9IDA7CiAJaW50IHJldCwg
ajsKIApAQCAtMzk5LDcgKzM5Nyw3IEBAIHN0YXRpYyBpbnQgaTkxNV9nZW1fYmF0Y2hfcG9vbF9p
bmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKIAlpZiAocmV0KQogCQlyZXR1cm4g
cmV0OwogCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYsIGlkKSB7CisJZm9yX2Vh
Y2hfdXNlcl9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdikgewogCQlmb3IgKGogPSAwOyBqIDwgQVJS
QVlfU0laRShlbmdpbmUtPmJhdGNoX3Bvb2wuY2FjaGVfbGlzdCk7IGorKykgewogCQkJaW50IGNv
dW50OwogCkBAIC00ODYsNyArNDg0LDYgQEAgc3RhdGljIGludCBpOTE1X2ludGVycnVwdF9pbmZv
KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7CiAJc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lOwotCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwogCWludGVsX3dh
a2VyZWZfdCB3YWtlcmVmOwogCWludCBpLCBwaXBlOwogCkBAIC02ODksNyArNjg2LDcgQEAgc3Rh
dGljIGludCBpOTE1X2ludGVycnVwdF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0
YSkKIAkJCSAgIEk5MTVfUkVBRChHRU4xMV9HVU5JVF9DU01FX0lOVFJfTUFTSykpOwogCiAJfSBl
bHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDYpIHsKLQkJZm9yX2VhY2hfZW5naW5lKGVu
Z2luZSwgZGV2X3ByaXYsIGlkKSB7CisJCWZvcl9lYWNoX3VzZXJfZW5naW5lKGVuZ2luZSwgZGV2
X3ByaXYpIHsKIAkJCXNlcV9wcmludGYobSwKIAkJCQkgICAiR3JhcGhpY3MgSW50ZXJydXB0IG1h
c2sgKCVzKToJJTA4eFxuIiwKIAkJCQkgICBlbmdpbmUtPm5hbWUsIEVOR0lORV9SRUFEKGVuZ2lu
ZSwgUklOR19JTVIpKTsKQEAgLTE4NzksNyArMTg3Niw2IEBAIHN0YXRpYyB2b2lkIGk5MTVfZ3Vj
X2NsaWVudF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwKIAkJCQkgc3RydWN0IGludGVsX2d1Y19j
bGllbnQgKmNsaWVudCkKIHsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0JZW51
bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CiAJdTY0IHRvdCA9IDA7CiAKIAlzZXFfcHJpbnRmKG0sICJc
dFByaW9yaXR5ICVkLCBHdUMgc3RhZ2UgaW5kZXg6ICV1LCBQRCBvZmZzZXQgMHgleFxuIiwKQEAg
LTE4ODcsOCArMTg4Myw4IEBAIHN0YXRpYyB2b2lkIGk5MTVfZ3VjX2NsaWVudF9pbmZvKHN0cnVj
dCBzZXFfZmlsZSAqbSwKIAlzZXFfcHJpbnRmKG0sICJcdERvb3JiZWxsIGlkICVkLCBvZmZzZXQ6
IDB4JWx4XG4iLAogCQljbGllbnQtPmRvb3JiZWxsX2lkLCBjbGllbnQtPmRvb3JiZWxsX29mZnNl
dCk7CiAKLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpIHsKLQkJdTY0IHN1
Ym1pc3Npb25zID0gY2xpZW50LT5zdWJtaXNzaW9uc1tpZF07CisJZm9yX2VhY2hfdXNlcl9lbmdp
bmUoZW5naW5lLCBkZXZfcHJpdikgeworCQl1NjQgc3VibWlzc2lvbnMgPSBjbGllbnQtPnN1Ym1p
c3Npb25zW2VuZ2luZS0+Z3VjX2lkXTsKIAkJdG90ICs9IHN1Ym1pc3Npb25zOwogCQlzZXFfcHJp
bnRmKG0sICJcdFN1Ym1pc3Npb25zOiAlbGx1ICVzXG4iLAogCQkJCXN1Ym1pc3Npb25zLCBlbmdp
bmUtPm5hbWUpOwpAQCAtMTkyOCw3ICsxOTI0LDYgQEAgc3RhdGljIGludCBpOTE1X2d1Y19zdGFn
ZV9wb29sKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKIAlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7CiAJY29uc3Qgc3Ry
dWN0IGludGVsX2d1YyAqZ3VjID0gJmRldl9wcml2LT5ndC51Yy5ndWM7CiAJc3RydWN0IGd1Y19z
dGFnZV9kZXNjICpkZXNjID0gZ3VjLT5zdGFnZV9kZXNjX3Bvb2xfdmFkZHI7Ci0JaW50ZWxfZW5n
aW5lX21hc2tfdCB0bXA7CiAJaW50IGluZGV4OwogCiAJaWYgKCFVU0VTX0dVQ19TVUJNSVNTSU9O
KGRldl9wcml2KSkKQEAgLTE5NTcsNyArMTk1Miw3IEBAIHN0YXRpYyBpbnQgaTkxNV9ndWNfc3Rh
Z2VfcG9vbChzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCiAJCQkgICBkZXNjLT53cV9h
ZGRyLCBkZXNjLT53cV9zaXplKTsKIAkJc2VxX3B1dGMobSwgJ1xuJyk7CiAKLQkJZm9yX2VhY2hf
ZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYsIHRtcCkgeworCQlmb3JfZWFjaF91c2VyX2VuZ2luZShl
bmdpbmUsIGRldl9wcml2KSB7CiAJCQl1MzIgZ3VjX2VuZ2luZV9pZCA9IGVuZ2luZS0+Z3VjX2lk
OwogCQkJc3RydWN0IGd1Y19leGVjbGlzdF9jb250ZXh0ICpscmMgPQogCQkJCQkJJmRlc2MtPmxy
Y1tndWNfZW5naW5lX2lkXTsKQEAgLTI3OTAsNyArMjc4NSw2IEBAIHN0YXRpYyBpbnQgaTkxNV9l
bmdpbmVfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7CiAJc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwogCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwot
CWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwogCXN0cnVjdCBkcm1fcHJpbnRlciBwOwogCiAJd2Fr
ZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0+cnVudGltZV9wbSk7CkBAIC0y
ODAyLDcgKzI3OTYsNyBAQCBzdGF0aWMgaW50IGk5MTVfZW5naW5lX2luZm8oc3RydWN0IHNlcV9m
aWxlICptLCB2b2lkICp1bnVzZWQpCiAJCSAgIFJVTlRJTUVfSU5GTyhkZXZfcHJpdiktPmNzX3Rp
bWVzdGFtcF9mcmVxdWVuY3lfa2h6KTsKIAogCXAgPSBkcm1fc2VxX2ZpbGVfcHJpbnRlcihtKTsK
LQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpCisJZm9yX2VhY2hfdXNlcl9l
bmdpbmUoZW5naW5lLCBkZXZfcHJpdikKIAkJaW50ZWxfZW5naW5lX2R1bXAoZW5naW5lLCAmcCwg
IiVzXG4iLCBlbmdpbmUtPm5hbWUpOwogCiAJaW50ZWxfcnVudGltZV9wbV9wdXQoJmRldl9wcml2
LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKQEAgLTI4ODMsOSArMjg3Nyw4IEBAIHN0YXRpYyBpbnQg
aTkxNV93YV9yZWdpc3RlcnMoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCiB7CiAJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7
CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCWVudW0gaW50ZWxfZW5naW5lX2lk
IGlkOwogCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKKwlmb3JfZWFjaF91
c2VyX2VuZ2luZShlbmdpbmUsIGk5MTUpIHsKIAkJY29uc3Qgc3RydWN0IGk5MTVfd2FfbGlzdCAq
d2FsID0gJmVuZ2luZS0+Y3R4X3dhX2xpc3Q7CiAJCWNvbnN0IHN0cnVjdCBpOTE1X3dhICp3YTsK
IAkJdW5zaWduZWQgaW50IGNvdW50OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKaW5kZXggNThiMWVm
NWYyY2UwLi43NmI5MGQ3YmUyMzEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaApAQCAtMTkxNSw2
ICsxOTE1LDE0IEBAIHN0YXRpYyBpbmxpbmUgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKndvcGNt
X3RvX2k5MTUoc3RydWN0IGludGVsX3dvcGNtICp3b3BjbSkKIAkgICAgICgoZW5naW5lX18pID0g
KGRldl9wcml2X18pLT5lbmdpbmVbX19tYXNrX25leHRfYml0KHRtcF9fKV0pLCAxIDogXAogCSAg
ICAgMDspCiAKKyNkZWZpbmUgcmJfdG9fdWFiaV9lbmdpbmUocmIpIFwKKwlyYl9lbnRyeV9zYWZl
KHJiLCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzLCB1YWJpX25vZGUpCisKKyNkZWZpbmUgZm9yX2Vh
Y2hfdXNlcl9lbmdpbmUoZW5naW5lX18sIGk5MTVfXykgXAorCWZvciAoKGVuZ2luZV9fKSA9IHJi
X3RvX3VhYmlfZW5naW5lKHJiX2ZpcnN0KCYoaTkxNV9fKS0+dWFiaV9lbmdpbmVzKSk7XAorCSAg
ICAgKGVuZ2luZV9fKTsgXAorCSAgICAgKGVuZ2luZV9fKSA9IHJiX3RvX3VhYmlfZW5naW5lKHJi
X25leHQoJihlbmdpbmVfXyktPnVhYmlfbm9kZSkpKQorCiBlbnVtIGhkbWlfZm9yY2VfYXVkaW8g
ewogCUhETUlfQVVESU9fT0ZGX0RWSSA9IC0yLAkvKiBubyBhdXggZGF0YSBmb3IgSERNSS1EVkkg
Y29udmVydGVyICovCiAJSERNSV9BVURJT19PRkYsCQkJLyogZm9yY2UgdHVybiBvZmYgSERNSSBh
dWRpbyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9xdWVyeS5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9xdWVyeS5jCmluZGV4IDcwYjFhZDM4ZTYxNS4uOGFi
YmEzYTMxNzY3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3F1ZXJ5LmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9xdWVyeS5jCkBAIC0xMDUsNyArMTA1LDYg
QEAgcXVlcnlfZW5naW5lX2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJc3Ry
dWN0IGRybV9pOTE1X3F1ZXJ5X2VuZ2luZV9pbmZvIHF1ZXJ5OwogCXN0cnVjdCBkcm1faTkxNV9l
bmdpbmVfaW5mbyBpbmZvID0geyB9OwogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsK
LQllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKIAlpbnQgbGVuLCByZXQ7CiAKIAlpZiAocXVlcnlf
aXRlbS0+ZmxhZ3MpCkBAIC0xMjUsNyArMTI0LDcgQEAgcXVlcnlfZW5naW5lX2luZm8oc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAKIAlpbmZvX3B0ciA9ICZxdWVyeV9wdHItPmVuZ2lu
ZXNbMF07CiAKLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgeworCWZvcl9lYWNo
X3VzZXJfZW5naW5lKGVuZ2luZSwgaTkxNSkgewogCQlpbmZvLmVuZ2luZS5lbmdpbmVfY2xhc3Mg
PSBlbmdpbmUtPnVhYmlfY2xhc3M7CiAJCWluZm8uZW5naW5lLmVuZ2luZV9pbnN0YW5jZSA9IGVu
Z2luZS0+dWFiaV9pbnN0YW5jZTsKIAkJaW5mby5jYXBhYmlsaXRpZXMgPSBlbmdpbmUtPnVhYmlf
Y2FwYWJpbGl0aWVzOwotLSAKMi4yMi4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5m
cmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0
aW5mby9pbnRlbC1nZng=

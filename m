Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id A4841E5034
	for <lists+intel-gfx@lfdr.de>; Fri, 25 Oct 2019 17:33:50 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 698126EA8D;
	Fri, 25 Oct 2019 15:33:48 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id DC1526EA8D;
 Fri, 25 Oct 2019 15:33:45 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18964782-1500050 
 for multiple; Fri, 25 Oct 2019 16:33:31 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 25 Oct 2019 16:33:29 +0100
Message-Id: <20191025153329.9935-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0.rc1
In-Reply-To: <20191025142333.11806-1-chris@chris-wilson.co.uk>
References: <20191025142333.11806-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t] lib/i915: Use explicit iterator names in
 for_each_engine()
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: igt-dev@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UHJvdmlkZSB0aGUgaXRlcmF0b3IgbmFtZSBhcyBhbiBleHBsaWNpdCBtYWNybyBwYXJhbWV0ZXIg
c28gdGhhdCBpdCBpcwprbm93biB0byB0aGUgY2FsbGVyLCBhbmQgYWxsb3dzIGZvciB0aGVtIHRv
IHByb3Blcmx5IG5lc3QgbG9vcHMgb3ZlciBhbGwKZW5naW5lcy4KCkZpeGVzOgouLi90ZXN0cy9p
OTE1L2dlbV9leGVjX3NjaGVkdWxlLmM6IEluIGZ1bmN0aW9uIOKAmHNlbWFwaG9yZV9ub3NraXDi
gJk6Ci4uL2xpYi9pZ3RfZ3QuaDo4NDo0NDogd2FybmluZzogZGVjbGFyYXRpb24gb2Yg4oCYZV9f
4oCZIHNoYWRvd3MgYSBwcmV2aW91cyBsb2NhbCBbLVdzaGFkb3ddCiAgZm9yIChjb25zdCBzdHJ1
Y3QgaW50ZWxfZXhlY3V0aW9uX2VuZ2luZSAqZV9fID0gaW50ZWxfZXhlY3V0aW9uX2VuZ2luZXM7
XAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF5+fgouLi90ZXN0
cy9pOTE1L2dlbV9leGVjX3NjaGVkdWxlLmM6NjUzOjI6IG5vdGU6IGluIGV4cGFuc2lvbiBvZiBt
YWNybyDigJhmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmXigJkKICBmb3JfZWFjaF9waHlzaWNhbF9l
bmdpbmUoaTkxNSwgb3RoZXIpIHsKICBefn5+fn5+fn5+fn5+fn5+fn5+fn5+fn4KLi4vbGliL2ln
dF9ndC5oOjg0OjQ0OiBub3RlOiBzaGFkb3dlZCBkZWNsYXJhdGlvbiBpcyBoZXJlCiAgZm9yIChj
b25zdCBzdHJ1Y3QgaW50ZWxfZXhlY3V0aW9uX2VuZ2luZSAqZV9fID0gaW50ZWxfZXhlY3V0aW9u
X2VuZ2luZXM7XAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF5+
fgouLi90ZXN0cy9pOTE1L2dlbV9leGVjX3NjaGVkdWxlLmM6NjUyOjI6IG5vdGU6IGluIGV4cGFu
c2lvbiBvZiBtYWNybyDigJhmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmXigJkKICBmb3JfZWFjaF9w
aHlzaWNhbF9lbmdpbmUoaTkxNSwgZW5naW5lKSB7CiAgXn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+
Ci4uL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfc2NoZWR1bGUuYzogSW4gZnVuY3Rpb24g4oCYbWVhc3Vy
ZV9zZW1hcGhvcmVfcG93ZXLigJk6Ci4uL2xpYi9pZ3RfZ3QuaDo4NDo0NDogd2FybmluZzogZGVj
bGFyYXRpb24gb2Yg4oCYZV9f4oCZIHNoYWRvd3MgYSBwcmV2aW91cyBsb2NhbCBbLVdzaGFkb3dd
CiAgZm9yIChjb25zdCBzdHJ1Y3QgaW50ZWxfZXhlY3V0aW9uX2VuZ2luZSAqZV9fID0gaW50ZWxf
ZXhlY3V0aW9uX2VuZ2luZXM7XAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIF5+fgouLi90ZXN0cy9pOTE1L2dlbV9leGVjX3NjaGVkdWxlLmM6MTc0MDozOiBub3Rl
OiBpbiBleHBhbnNpb24gb2YgbWFjcm8g4oCYZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5l4oCZCiAg
IGZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShpOTE1LCBlbmdpbmUpIHsKICAgXn5+fn5+fn5+fn5+
fn5+fn5+fn5+fn5+Ci4uL2xpYi9pZ3RfZ3QuaDo4NDo0NDogbm90ZTogc2hhZG93ZWQgZGVjbGFy
YXRpb24gaXMgaGVyZQogIGZvciAoY29uc3Qgc3RydWN0IGludGVsX2V4ZWN1dGlvbl9lbmdpbmUg
KmVfXyA9IGludGVsX2V4ZWN1dGlvbl9lbmdpbmVzO1wKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBefn4KLi4vdGVzdHMvaTkxNS9nZW1fZXhlY19zY2hlZHVsZS5j
OjE3MTk6Mjogbm90ZTogaW4gZXhwYW5zaW9uIG9mIG1hY3JvIOKAmGZvcl9lYWNoX3BoeXNpY2Fs
X2VuZ2luZeKAmQogIGZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShpOTE1LCBzaWduYWxlcikgewog
IF5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fgoKU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxj
aHJpc0BjaHJpcy13aWxzb24uY28udWs+CkNjOiBUdnJ0a28gVXJzdWxpbiA8dHZydGtvLnVyc3Vs
aW5AaW50ZWwuY29tPgpDYzogQW5kaSBTaHl0aSA8YW5kaS5zaHl0aUBpbnRlbC5jb20+Ci0tLQog
YmVuY2htYXJrcy9nZW1fc3lzbGF0ZW5jeS5jICAgICB8ICAxNiArLS0KIGxpYi9pOTE1L2dlbV9y
aW5nLmMgICAgICAgICAgICAgfCAgIDQgKy0KIGxpYi9pZ3RfZ3QuaCAgICAgICAgICAgICAgICAg
ICAgfCAgMjQgKysrLS0KIHRlc3RzL2FtZGdwdS9hbWRfcHJpbWUuYyAgICAgICAgfCAgIDYgKy0K
IHRlc3RzL2k5MTUvZ2VtX2JhZF9yZWxvYy5jICAgICAgfCAgIDQgKy0KIHRlc3RzL2k5MTUvZ2Vt
X2J1c3kuYyAgICAgICAgICAgfCAgIDQgKy0KIHRlc3RzL2k5MTUvZ2VtX2NvbmN1cnJlbnRfYWxs
LmMgfCAgIDcgKy0KIHRlc3RzL2k5MTUvZ2VtX2NzX3ByZWZldGNoLmMgICAgfCAgIDIgKy0KIHRl
c3RzL2k5MTUvZ2VtX2N0eF9jcmVhdGUuYyAgICAgfCAgMTIgKy0tCiB0ZXN0cy9pOTE1L2dlbV9j
dHhfc2hhcmVkLmMgICAgIHwgIDQzICsrKystLS0tCiB0ZXN0cy9pOTE1L2dlbV9jdHhfc3dpdGNo
LmMgICAgIHwgICAyICstCiB0ZXN0cy9pOTE1L2dlbV9jdHhfdGhyYXNoLmMgICAgIHwgIDE0ICsr
LQogdGVzdHMvaTkxNS9nZW1fZWlvLmMgICAgICAgICAgICB8ICAyOSArKystLS0KIHRlc3RzL2k5
MTUvZ2VtX2V4ZWNfYXN5bmMuYyAgICAgfCAgMTMgKystCiB0ZXN0cy9pOTE1L2dlbV9leGVjX2F3
YWl0LmMgICAgIHwgICA3ICstCiB0ZXN0cy9pOTE1L2dlbV9leGVjX2NhcHR1cmUuYyAgIHwgICA2
ICstCiB0ZXN0cy9pOTE1L2dlbV9leGVjX2NyZWF0ZS5jICAgIHwgICA4ICstCiB0ZXN0cy9pOTE1
L2dlbV9leGVjX2ZlbmNlLmMgICAgIHwgIDYxICsrKysrKy0tLS0tCiB0ZXN0cy9pOTE1L2dlbV9l
eGVjX2ZsdXNoLmMgICAgIHwgICAyICstCiB0ZXN0cy9pOTE1L2dlbV9leGVjX2d0dGZpbGwuYyAg
IHwgIDExICstCiB0ZXN0cy9pOTE1L2dlbV9leGVjX2xhdGVuY3kuYyAgIHwgIDMzICsrKy0tLQog
dGVzdHMvaTkxNS9nZW1fZXhlY19ub3AuYyAgICAgICB8ICA0NCArKysrLS0tLQogdGVzdHMvaTkx
NS9nZW1fZXhlY19wYXJhbXMuYyAgICB8ICAxNCArLS0KIHRlc3RzL2k5MTUvZ2VtX2V4ZWNfcmVs
b2MuYyAgICAgfCAgIDggKy0KIHRlc3RzL2k5MTUvZ2VtX2V4ZWNfcmV1c2UuYyAgICAgfCAgIDYg
Ky0KIHRlc3RzL2k5MTUvZ2VtX2V4ZWNfc2NoZWR1bGUuYyAgfCAxNzIgKysrKysrKysrKysrKysr
LS0tLS0tLS0tLS0tLS0tLS0KIHRlc3RzL2k5MTUvZ2VtX2V4ZWNfc3VzcGVuZC5jICAgfCAgMjAg
KystLQogdGVzdHMvaTkxNS9nZW1fZXhlY193aGlzcGVyLmMgICB8ICAgOCArLQogdGVzdHMvaTkx
NS9nZW1fbW9jc19zZXR0aW5ncy5jICB8ICAgNiArLQogdGVzdHMvaTkxNS9nZW1fcmVzZXRfc3Rh
dHMuYyAgICB8ICAxMCArLQogdGVzdHMvaTkxNS9nZW1fcmluZ19zeW5jX2xvb3AuYyB8ICAgNSAr
LQogdGVzdHMvaTkxNS9nZW1fcmluZ2ZpbGwuYyAgICAgICB8ICAgMyArLQogdGVzdHMvaTkxNS9n
ZW1fc2hyaW5rLmMgICAgICAgICB8ICAgNSArLQogdGVzdHMvaTkxNS9nZW1fc3Bpbl9iYXRjaC5j
ICAgICB8ICAgMiArLQogdGVzdHMvaTkxNS9nZW1fc3RvcmVkd19sb29wLmMgICB8ICAgMiArLQog
dGVzdHMvaTkxNS9nZW1fc3luYy5jICAgICAgICAgICB8ICA5OSArKysrKysrKystLS0tLS0tLS0K
IHRlc3RzL2k5MTUvZ2VtX3VzZXJwdHJfYmxpdHMuYyAgfCAgIDcgKy0KIHRlc3RzL2k5MTUvaTkx
NV9tb2R1bGVfbG9hZC5jICAgfCAgMTYgKy0tCiB0ZXN0cy9rbXNfYnVzeS5jICAgICAgICAgICAg
ICAgIHwgIDMwICsrKy0tLQogdGVzdHMvcHJpbWVfYnVzeS5jICAgICAgICAgICAgICB8ICAgOCAr
LQogdGVzdHMvcHJpbWVfdmdlbS5jICAgICAgICAgICAgICB8ICAxNiArLS0KIDQxIGZpbGVzIGNo
YW5nZWQsIDM2NiBpbnNlcnRpb25zKCspLCA0MjMgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEv
YmVuY2htYXJrcy9nZW1fc3lzbGF0ZW5jeS5jIGIvYmVuY2htYXJrcy9nZW1fc3lzbGF0ZW5jeS5j
CmluZGV4IGQ3Y2YwZWQ0OS4uNDAyMzA2MzAwIDEwMDY0NAotLS0gYS9iZW5jaG1hcmtzL2dlbV9z
eXNsYXRlbmN5LmMKKysrIGIvYmVuY2htYXJrcy9nZW1fc3lzbGF0ZW5jeS5jCkBAIC03OSwxNyAr
NzksNiBAQCBzdGF0aWMgdm9pZCBmb3JjZV9sb3dfbGF0ZW5jeSh2b2lkKQogCiAjZGVmaW5lIEVO
R0lORV9GTEFHUyAgKEk5MTVfRVhFQ19SSU5HX01BU0sgfCBMT0NBTF9JOTE1X0VYRUNfQlNEX01B
U0spCiAKLXN0YXRpYyBib29sIGlnbm9yZV9lbmdpbmUoaW50IGZkLCB1bnNpZ25lZCBlbmdpbmUp
Ci17Ci0JaWYgKGVuZ2luZSA9PSAwKQotCQlyZXR1cm4gdHJ1ZTsKLQotCWlmIChnZW1faGFzX2Jz
ZDIoZmQpICYmIGVuZ2luZSA9PSBJOTE1X0VYRUNfQlNEKQotCQlyZXR1cm4gdHJ1ZTsKLQotCXJl
dHVybiBmYWxzZTsKLX0KLQogc3RhdGljIHZvaWQgKmdlbV9idXN5c3Bpbih2b2lkICphcmcpCiB7
CiAJY29uc3QgdWludDMyX3QgYmJlID0gTUlfQkFUQ0hfQlVGRkVSX0VORDsKQEAgLTEwMCwxNCAr
ODksMTMgQEAgc3RhdGljIHZvaWQgKmdlbV9idXN5c3Bpbih2b2lkICphcmcpCiAJCWJzLT5zeiA/
IGJzLT5zeiArIHNpemVvZihiYmUpIDogYnMtPmxlYWsgPyAxNiA8PCAyMCA6IDQgPDwgMTA7CiAJ
dW5zaWduZWQgZW5naW5lc1sxNl07CiAJdW5zaWduZWQgbmVuZ2luZTsKLQl1bnNpZ25lZCBlbmdp
bmU7CiAJaW50IGZkOwogCiAJZmQgPSBkcm1fb3Blbl9kcml2ZXIoRFJJVkVSX0lOVEVMKTsKIAog
CW5lbmdpbmUgPSAwOwotCWZvcl9lYWNoX2VuZ2luZShmZCwgZW5naW5lKQotCQlpZiAoIWlnbm9y
ZV9lbmdpbmUoZmQsIGVuZ2luZSkpIGVuZ2luZXNbbmVuZ2luZSsrXSA9IGVuZ2luZTsKKwlmb3Jf
ZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQpCisJCWVuZ2luZXNbbmVuZ2luZSsrXSA9IGViX3Jp
bmcoZSk7CiAKIAltZW1zZXQob2JqLCAwLCBzaXplb2Yob2JqKSk7CiAJb2JqWzBdLmhhbmRsZSA9
IGdlbV9jcmVhdGUoZmQsIDQwOTYpOwpkaWZmIC0tZ2l0IGEvbGliL2k5MTUvZ2VtX3JpbmcuYyBi
L2xpYi9pOTE1L2dlbV9yaW5nLmMKaW5kZXggNWNhMmE3MjhiLi45OWY0NzQxY2IgMTAwNjQ0Ci0t
LSBhL2xpYi9pOTE1L2dlbV9yaW5nLmMKKysrIGIvbGliL2k5MTUvZ2VtX3JpbmcuYwpAQCAtMTUz
LDkgKzE1Myw5IEBAIGdlbV9tZWFzdXJlX3JpbmdfaW5mbGlnaHQoaW50IGZkLCB1bnNpZ25lZCBp
bnQgZW5naW5lLCBlbnVtIG1lYXN1cmVfcmluZ19mbGFncyBmCiAJZmNudGwoZmQsIEZfU0VURkQs
IGZjbnRsKGZkLCBGX0dFVEZEKSB8IE9fTk9OQkxPQ0spOwogCiAJaWYgKGVuZ2luZSA9PSBBTExf
RU5HSU5FUykgewotCQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZmQsIGVuZ2luZSkgeworCQlm
b3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQpIHsKIAkJCXVuc2lnbmVkIGludCBjb3VudCA9
Ci0JCQkJX19nZW1fbWVhc3VyZV9yaW5nX2luZmxpZ2h0KGZkLCBlbmdpbmUsIGZsYWdzKTsKKwkJ
CQlfX2dlbV9tZWFzdXJlX3JpbmdfaW5mbGlnaHQoZmQsIGViX3JpbmcoZSksIGZsYWdzKTsKIAog
CQkJaWYgKGNvdW50IDwgbWluKQogCQkJCW1pbiA9IGNvdW50OwpkaWZmIC0tZ2l0IGEvbGliL2ln
dF9ndC5oIGIvbGliL2lndF9ndC5oCmluZGV4IDczYjUwMDJhMC4uNjYwODhkMzkxIDEwMDY0NAot
LS0gYS9saWIvaWd0X2d0LmgKKysrIGIvbGliL2lndF9ndC5oCkBAIC03MiwxOSArNzIsMjEgQEAg
ZXh0ZXJuIGNvbnN0IHN0cnVjdCBpbnRlbF9leGVjdXRpb25fZW5naW5lIHsKIAl1bnNpZ25lZCBm
bGFnczsKIH0gaW50ZWxfZXhlY3V0aW9uX2VuZ2luZXNbXTsKIAorI2RlZmluZSBlYl9yaW5nKGUp
ICgoZSktPmV4ZWNfaWQgfCAoZSktPmZsYWdzKQorCiAjZGVmaW5lIGZvcl9pZihleHByX18pIGlm
ICghKGV4cHJfXykpIHt9IGVsc2UKIAotI2RlZmluZSBmb3JfZWFjaF9lbmdpbmUoZmRfXywgZmxh
Z3NfXykgXAotCWZvciAoY29uc3Qgc3RydWN0IGludGVsX2V4ZWN1dGlvbl9lbmdpbmUgKmVfXyA9
IGludGVsX2V4ZWN1dGlvbl9lbmdpbmVzO1wKLQkgICAgIGVfXy0+bmFtZTsgXAotCSAgICAgZV9f
KyspIFwKLQkJZm9yX2lmIChnZW1faGFzX3JpbmcoZmRfXywgZmxhZ3NfXyA9IGVfXy0+ZXhlY19p
ZCB8IGVfXy0+ZmxhZ3MpKQotCi0jZGVmaW5lIGZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShmZF9f
LCBmbGFnc19fKSBcCi0JZm9yIChjb25zdCBzdHJ1Y3QgaW50ZWxfZXhlY3V0aW9uX2VuZ2luZSAq
ZV9fID0gaW50ZWxfZXhlY3V0aW9uX2VuZ2luZXM7XAotCSAgICAgZV9fLT5uYW1lOyBcCi0JICAg
ICBlX18rKykgXAotCQlmb3JfaWYgKGdlbV9yaW5nX2hhc19waHlzaWNhbF9lbmdpbmUoZmRfXywg
ZmxhZ3NfXyA9IGVfXy0+ZXhlY19pZCB8IGVfXy0+ZmxhZ3MpKQorI2RlZmluZSBmb3JfZWFjaF9l
bmdpbmUoaXRfXywgZmRfXykgXAorCWZvciAoY29uc3Qgc3RydWN0IGludGVsX2V4ZWN1dGlvbl9l
bmdpbmUgKml0X18gPSBpbnRlbF9leGVjdXRpb25fZW5naW5lcztcCisJICAgICBpdF9fLT5uYW1l
OyBcCisJICAgICBpdF9fKyspIFwKKwkJZm9yX2lmIChnZW1faGFzX3JpbmcoZmRfXywgZWJfcmlu
ZyhpdF9fKSkpCisKKyNkZWZpbmUgZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGl0X18sIGZkX18p
IFwKKwlmb3IgKGNvbnN0IHN0cnVjdCBpbnRlbF9leGVjdXRpb25fZW5naW5lICppdF9fID0gaW50
ZWxfZXhlY3V0aW9uX2VuZ2luZXM7XAorCSAgICAgaXRfXy0+bmFtZTsgXAorCSAgICAgaXRfXysr
KSBcCisJCWZvcl9pZiAoZ2VtX3JpbmdfaGFzX3BoeXNpY2FsX2VuZ2luZShmZF9fLCBlYl9yaW5n
KGl0X18pKSkKIAogYm9vbCBnZW1fcmluZ19pc19waHlzaWNhbF9lbmdpbmUoaW50IGZkLCB1bnNp
Z25lZCBpbnQgcmluZyk7CiBib29sIGdlbV9yaW5nX2hhc19waHlzaWNhbF9lbmdpbmUoaW50IGZk
LCB1bnNpZ25lZCBpbnQgcmluZyk7CmRpZmYgLS1naXQgYS90ZXN0cy9hbWRncHUvYW1kX3ByaW1l
LmMgYi90ZXN0cy9hbWRncHUvYW1kX3ByaW1lLmMKaW5kZXggZGM3MWFjNzBjLi5mZGI4YTAyODMg
MTAwNjQ0Ci0tLSBhL3Rlc3RzL2FtZGdwdS9hbWRfcHJpbWUuYworKysgYi90ZXN0cy9hbWRncHUv
YW1kX3ByaW1lLmMKQEAgLTE3MywxNCArMTczLDE0IEBAIHN0YXRpYyB2b2lkIGk5MTVfdG9fYW1k
KGludCBpOTE1LCBpbnQgYW1kLCBhbWRncHVfZGV2aWNlX2hhbmRsZSBkZXZpY2UpCiAJY29uc3Qg
dWludDMyX3QgYmJlID0gTUlfQkFUQ0hfQlVGRkVSX0VORDsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X2V4ZWNfb2JqZWN0MiBvYmpbMl07CiAJc3RydWN0IGRybV9pOTE1X2dlbV9leGVjYnVmZmVyMiBl
eGVjYnVmOwotCXVuc2lnbmVkIGludCBlbmdpbmVzWzE2XSwgZW5naW5lOworCXVuc2lnbmVkIGlu
dCBlbmdpbmVzWzE2XTsKIAl1bnNpZ25lZCBpbnQgbmVuZ2luZTsKIAl1bnNpZ25lZCBsb25nIGNv
dW50OwogCXN0cnVjdCBjb3JrIGM7CiAKIAluZW5naW5lID0gMDsKLQlmb3JfZWFjaF9waHlzaWNh
bF9lbmdpbmUoaTkxNSwgZW5naW5lKQotCQllbmdpbmVzW25lbmdpbmUrK10gPSBlbmdpbmU7CisJ
Zm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGk5MTUpCisJCWVuZ2luZXNbbmVuZ2luZSsrXSA9
IGViX3JpbmcoZSk7CiAJaWd0X3JlcXVpcmUobmVuZ2luZSk7CiAKIAltZW1zZXQob2JqLCAwLCBz
aXplb2Yob2JqKSk7CmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1L2dlbV9iYWRfcmVsb2MuYyBiL3Rl
c3RzL2k5MTUvZ2VtX2JhZF9yZWxvYy5jCmluZGV4IGMwM2U1YmViMy4uOTZjOWJhYmU2IDEwMDY0
NAotLS0gYS90ZXN0cy9pOTE1L2dlbV9iYWRfcmVsb2MuYworKysgYi90ZXN0cy9pOTE1L2dlbV9i
YWRfcmVsb2MuYwpAQCAtMTk2LDEwICsxOTYsMTAgQEAgaWd0X21haW4KIAogCWZvciAoZSA9IGlu
dGVsX2V4ZWN1dGlvbl9lbmdpbmVzOyBlLT5uYW1lOyBlKyspIHsKIAkJaWd0X3N1YnRlc3RfZigi
bmVnYXRpdmUtcmVsb2MtJXMiLCBlLT5uYW1lKQotCQkJbmVnYXRpdmVfcmVsb2MoZmQsIGUtPmV4
ZWNfaWQgfCBlLT5mbGFncywgMCk7CisJCQluZWdhdGl2ZV9yZWxvYyhmZCwgZWJfcmluZyhlKSwg
MCk7CiAKIAkJaWd0X3N1YnRlc3RfZigibmVnYXRpdmUtcmVsb2MtbHV0LSVzIiwgZS0+bmFtZSkK
LQkJCW5lZ2F0aXZlX3JlbG9jKGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIFVTRV9MVVQpOwor
CQkJbmVnYXRpdmVfcmVsb2MoZmQsIGViX3JpbmcoZSksIFVTRV9MVVQpOwogCX0KIAogCWlndF9z
dWJ0ZXN0KCJuZWdhdGl2ZS1yZWxvYy1ibHRjb3B5IikKZGlmZiAtLWdpdCBhL3Rlc3RzL2k5MTUv
Z2VtX2J1c3kuYyBiL3Rlc3RzL2k5MTUvZ2VtX2J1c3kuYwppbmRleCBhNTUzNTg3MDguLmE4Mzg4
MTQ5YiAxMDA2NDQKLS0tIGEvdGVzdHMvaTkxNS9nZW1fYnVzeS5jCisrKyBiL3Rlc3RzL2k5MTUv
Z2VtX2J1c3kuYwpAQCAtMzE5LDggKzMxOSw4IEBAIHN0YXRpYyB2b2lkIGNsb3NlX3JhY2UoaW50
IGZkKQogCSAqLwogCiAJbmVuZ2luZSA9IDA7Ci0JZm9yX2VhY2hfZW5naW5lKGZkLCBpKQotCQll
bmdpbmVzW25lbmdpbmUrK10gPSBpOworCWZvcl9lYWNoX2VuZ2luZShlLCBmZCkKKwkJZW5naW5l
c1tuZW5naW5lKytdID0gZWJfcmluZyhlKTsKIAlpZ3RfcmVxdWlyZShuZW5naW5lKTsKIAogCWNv
bnRyb2wgPSBtbWFwKE5VTEwsIDQwOTYsIFBST1RfV1JJVEUsIE1BUF9TSEFSRUQgfCBNQVBfQU5P
TiwgLTEsIDApOwpkaWZmIC0tZ2l0IGEvdGVzdHMvaTkxNS9nZW1fY29uY3VycmVudF9hbGwuYyBi
L3Rlc3RzL2k5MTUvZ2VtX2NvbmN1cnJlbnRfYWxsLmMKaW5kZXggMjY2OTk1ZDE0Li45OTJiZWE2
MmUgMTAwNjQ0Ci0tLSBhL3Rlc3RzL2k5MTUvZ2VtX2NvbmN1cnJlbnRfYWxsLmMKKysrIGIvdGVz
dHMvaTkxNS9nZW1fY29uY3VycmVudF9hbGwuYwpAQCAtOTQ5LDE1ICs5NDksMTQgQEAgc3RhdGlj
IGlndF9oYW5nX3QgcmNzX2hhbmcodm9pZCkKIHN0YXRpYyBpZ3RfaGFuZ190IGFsbF9oYW5nKHZv
aWQpCiB7CiAJaWd0X2hhbmdfdCBoYW5nID0gaWd0X2hhbmdfcmluZyhmZCwgSTkxNV9FWEVDX1JF
TkRFUik7Ci0JdW5zaWduZWQgZW5naW5lOwogCi0JZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGZk
LCBlbmdpbmUpIHsKKwlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQpIHsKIAkJc3RydWN0
IGRybV9pOTE1X2dlbV9leGVjYnVmZmVyMiBlYiA9IGhhbmcuc3Bpbi0+ZXhlY2J1ZjsKIAotCQlp
ZiAoZW5naW5lID09IEk5MTVfRVhFQ19SRU5ERVIpCisJCWViLmZsYWdzID0gZWJfcmluZyhlKTsK
KwkJaWYgKGViLmZsYWdzID09IEk5MTVfRVhFQ19SRU5ERVIpCiAJCQljb250aW51ZTsKIAotCQll
Yi5mbGFncyA9IGVuZ2luZTsKIAkJX19nZW1fZXhlY2J1ZihmZCwgJmViKTsKIAl9CiAKZGlmZiAt
LWdpdCBhL3Rlc3RzL2k5MTUvZ2VtX2NzX3ByZWZldGNoLmMgYi90ZXN0cy9pOTE1L2dlbV9jc19w
cmVmZXRjaC5jCmluZGV4IDJiODY1MzY4Ny4uMTcxOTA4NTc2IDEwMDY0NAotLS0gYS90ZXN0cy9p
OTE1L2dlbV9jc19wcmVmZXRjaC5jCisrKyBiL3Rlc3RzL2k5MTUvZ2VtX2NzX3ByZWZldGNoLmMK
QEAgLTE0NSw1ICsxNDUsNSBAQCBpZ3RfbWFpbgogCiAJZm9yIChlID0gaW50ZWxfZXhlY3V0aW9u
X2VuZ2luZXM7IGUtPm5hbWU7IGUrKykKIAkJaWd0X3N1YnRlc3RfZigiJXMiLCBlLT5uYW1lKQot
CQkJdGVzdF9yaW5nKGUtPmV4ZWNfaWQgfCBlLT5mbGFncyk7CisJCQl0ZXN0X3JpbmcoZWJfcmlu
ZyhlKSk7CiB9CmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1L2dlbV9jdHhfY3JlYXRlLmMgYi90ZXN0
cy9pOTE1L2dlbV9jdHhfY3JlYXRlLmMKaW5kZXggMWUyYzQwYzRmLi44M2RhMDU2OTAgMTAwNjQ0
Ci0tLSBhL3Rlc3RzL2k5MTUvZ2VtX2N0eF9jcmVhdGUuYworKysgYi90ZXN0cy9pOTE1L2dlbV9j
dHhfY3JlYXRlLmMKQEAgLTUyNywxNCArNTI3LDEyIEBAIGlndF9tYWluCiAJaW50IGZkID0gLTE7
CiAKIAlpZ3RfZml4dHVyZSB7Ci0JCXVuc2lnbmVkIGVuZ2luZTsKLQogCQlmZCA9IGRybV9vcGVu
X2RyaXZlcihEUklWRVJfSU5URUwpOwogCQlpZ3RfcmVxdWlyZV9nZW0oZmQpOwogCQlnZW1fcmVx
dWlyZV9jb250ZXh0cyhmZCk7CiAKLQkJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGZkLCBlbmdp
bmUpCi0JCQlhbGxfZW5naW5lc1thbGxfbmVuZ2luZSsrXSA9IGVuZ2luZTsKKwkJZm9yX2VhY2hf
cGh5c2ljYWxfZW5naW5lKGUsIGZkKQorCQkJYWxsX2VuZ2luZXNbYWxsX25lbmdpbmUrK10gPSBl
Yl9yaW5nKGUpOwogCQlpZ3RfcmVxdWlyZShhbGxfbmVuZ2luZSk7CiAKIAkJaWYgKGdlbV91c2Vz
X2Z1bGxfcHBndHQoZmQpKSB7CkBAIC01ODIsMTIgKzU4MCwxMiBAQCBpZ3RfbWFpbgogCWZvciAo
Y29uc3Qgc3RydWN0IGludGVsX2V4ZWN1dGlvbl9lbmdpbmUgKmUgPSBpbnRlbF9leGVjdXRpb25f
ZW5naW5lczsKIAkgICAgIGUtPm5hbWU7IGUrKykgewogCQlpZ3Rfc3VidGVzdF9mKCJhY3RpdmUt
JXMiLCBlLT5uYW1lKQotCQkJYWN0aXZlKGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIDIwLCAx
KTsKKwkJCWFjdGl2ZShmZCwgZWJfcmluZyhlKSwgMjAsIDEpOwogCQlpZ3Rfc3VidGVzdF9mKCJm
b3JrZWQtYWN0aXZlLSVzIiwgZS0+bmFtZSkKLQkJCWFjdGl2ZShmZCwgZS0+ZXhlY19pZCB8IGUt
PmZsYWdzLCAyMCwgbmNwdXMpOworCQkJYWN0aXZlKGZkLCBlYl9yaW5nKGUpLCAyMCwgbmNwdXMp
OwogCQlpZiAoZS0+ZXhlY19pZCkgewogCQkJaWd0X3N1YnRlc3RfZigiaG9nLSVzIiwgZS0+bmFt
ZSkKLQkJCQlhY3RpdmUoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgMjAsIC0xKTsKKwkJCQlh
Y3RpdmUoZmQsIGViX3JpbmcoZSksIDIwLCAtMSk7CiAJCX0KIAl9CiAKZGlmZiAtLWdpdCBhL3Rl
c3RzL2k5MTUvZ2VtX2N0eF9zaGFyZWQuYyBiL3Rlc3RzL2k5MTUvZ2VtX2N0eF9zaGFyZWQuYwpp
bmRleCBmNzg1MjQ4MjIuLjZkOGNiY2NlMiAxMDA2NDQKLS0tIGEvdGVzdHMvaTkxNS9nZW1fY3R4
X3NoYXJlZC5jCisrKyBiL3Rlc3RzL2k5MTUvZ2VtX2N0eF9zaGFyZWQuYwpAQCAtMzI2LDcgKzMy
Niw2IEBAIHN0YXRpYyB2b2lkIHNpbmdsZV90aW1lbGluZShpbnQgaTkxNSkKIAlzdHJ1Y3Qgc3lu
Y19maWxlX2luZm8gc3luY19maWxlX2luZm8gPSB7CiAJCS5udW1fZmVuY2VzID0gMSwKIAl9Owot
CXVuc2lnbmVkIGludCBlbmdpbmU7CiAJaW50IG47CiAKIAlpZ3RfcmVxdWlyZShoYXNfc2luZ2xl
X3RpbWVsaW5lKGk5MTUpKTsKQEAgLTM0Nyw3ICszNDYsNyBAQCBzdGF0aWMgdm9pZCBzaW5nbGVf
dGltZWxpbmUoaW50IGk5MTUpCiAJCQkJICBJOTE1X0NPTlRFWFRfQ1JFQVRFX0ZMQUdTX1NJTkdM
RV9USU1FTElORSk7CiAJZXhlY2J1Zi5mbGFncyA9IEk5MTVfRVhFQ19GRU5DRV9PVVQ7CiAJbiA9
IDA7Ci0JZm9yX2VhY2hfZW5naW5lKGk5MTUsIGVuZ2luZSkgeworCWZvcl9lYWNoX2VuZ2luZShl
LCBpOTE1KSB7CiAJCWdlbV9leGVjYnVmX3dyKGk5MTUsICZleGVjYnVmKTsKIAkJc3luY19maWxl
X2luZm8uc3luY19mZW5jZV9pbmZvID0gdG9fdXNlcl9wb2ludGVyKCZyaW5nc1tuXSk7CiAJCWRv
X2lvY3RsKGV4ZWNidWYucnN2ZDIgPj4gMzIsIFNZTkNfSU9DX0ZJTEVfSU5GTywgJnN5bmNfZmls
ZV9pbmZvKTsKQEAgLTM2OCw3ICszNjcsNiBAQCBzdGF0aWMgdm9pZCBzaW5nbGVfdGltZWxpbmUo
aW50IGk5MTUpCiAKIHN0YXRpYyB2b2lkIGV4ZWNfc2luZ2xlX3RpbWVsaW5lKGludCBpOTE1LCB1
bnNpZ25lZCBpbnQgZW5naW5lKQogewotCXVuc2lnbmVkIGludCBvdGhlcjsKIAlpZ3Rfc3Bpbl90
ICpzcGluOwogCXVpbnQzMl90IGN0eDsKIApAQCAtMzgxLDE3ICszNzksMTcgQEAgc3RhdGljIHZv
aWQgZXhlY19zaW5nbGVfdGltZWxpbmUoaW50IGk5MTUsIHVuc2lnbmVkIGludCBlbmdpbmUpCiAJ
ICovCiAJY3R4ID0gMDsKIAlzcGluID0gTlVMTDsKLQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUo
aTkxNSwgb3RoZXIpIHsKLQkJaWYgKG90aGVyID09IGVuZ2luZSkKKwlmb3JfZWFjaF9waHlzaWNh
bF9lbmdpbmUoZSwgaTkxNSkgeworCQlpZiAoZWJfcmluZyhlKSA9PSBlbmdpbmUpCiAJCQljb250
aW51ZTsKIAogCQlpZiAoc3BpbiA9PSBOVUxMKSB7Ci0JCQlzcGluID0gX19pZ3Rfc3Bpbl9uZXco
aTkxNSwgLmN0eCA9IGN0eCwgLmVuZ2luZSA9IG90aGVyKTsKKwkJCXNwaW4gPSBfX2lndF9zcGlu
X25ldyhpOTE1LCAuY3R4ID0gY3R4LCAuZW5naW5lID0gZWJfcmluZyhlKSk7CiAJCX0gZWxzZSB7
CiAJCQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNidWZmZXIyIGV4ZWNidWYgPSB7CiAJCQkJLmJ1
ZmZlcnNfcHRyID0gc3Bpbi0+ZXhlY2J1Zi5idWZmZXJzX3B0ciwKIAkJCQkuYnVmZmVyX2NvdW50
ID0gc3Bpbi0+ZXhlY2J1Zi5idWZmZXJfY291bnQsCi0JCQkJLmZsYWdzID0gb3RoZXIsCisJCQkJ
LmZsYWdzID0gZWJfcmluZyhlKSwKIAkJCQkucnN2ZDEgPSBjdHgsCiAJCQl9OwogCQkJZ2VtX2V4
ZWNidWYoaTkxNSwgJmV4ZWNidWYpOwpAQCAtNDA5LDE3ICs0MDcsMTcgQEAgc3RhdGljIHZvaWQg
ZXhlY19zaW5nbGVfdGltZWxpbmUoaW50IGk5MTUsIHVuc2lnbmVkIGludCBlbmdpbmUpCiAJY3R4
ID0gZ2VtX2NvbnRleHRfY2xvbmUoaTkxNSwgMCwgMCwKIAkJCQlJOTE1X0NPTlRFWFRfQ1JFQVRF
X0ZMQUdTX1NJTkdMRV9USU1FTElORSk7CiAJc3BpbiA9IE5VTEw7Ci0JZm9yX2VhY2hfcGh5c2lj
YWxfZW5naW5lKGk5MTUsIG90aGVyKSB7Ci0JCWlmIChvdGhlciA9PSBlbmdpbmUpCisJZm9yX2Vh
Y2hfcGh5c2ljYWxfZW5naW5lKGUsIGk5MTUpIHsKKwkJaWYgKGViX3JpbmcoZSkgPT0gZW5naW5l
KQogCQkJY29udGludWU7CiAKIAkJaWYgKHNwaW4gPT0gTlVMTCkgewotCQkJc3BpbiA9IF9faWd0
X3NwaW5fbmV3KGk5MTUsIC5jdHggPSBjdHgsIC5lbmdpbmUgPSBvdGhlcik7CisJCQlzcGluID0g
X19pZ3Rfc3Bpbl9uZXcoaTkxNSwgLmN0eCA9IGN0eCwgLmVuZ2luZSA9IGViX3JpbmcoZSkpOwog
CQl9IGVsc2UgewogCQkJc3RydWN0IGRybV9pOTE1X2dlbV9leGVjYnVmZmVyMiBleGVjYnVmID0g
ewogCQkJCS5idWZmZXJzX3B0ciA9IHNwaW4tPmV4ZWNidWYuYnVmZmVyc19wdHIsCiAJCQkJLmJ1
ZmZlcl9jb3VudCA9IHNwaW4tPmV4ZWNidWYuYnVmZmVyX2NvdW50LAotCQkJCS5mbGFncyA9IG90
aGVyLAorCQkJCS5mbGFncyA9IGViX3JpbmcoZSksCiAJCQkJLnJzdmQxID0gY3R4LAogCQkJfTsK
IAkJCWdlbV9leGVjYnVmKGk5MTUsICZleGVjYnVmKTsKQEAgLTc0Miw4ICs3NDAsOCBAQCBzdGF0
aWMgdm9pZCBzbW9rZXRlc3QoaW50IGk5MTUsIHVuc2lnbmVkIHJpbmcsIHVuc2lnbmVkIHRpbWVv
dXQpCiAJdWludDMyX3QgKnB0cjsKIAogCW5lbmdpbmUgPSAwOwotCWZvcl9lYWNoX3BoeXNpY2Fs
X2VuZ2luZShpOTE1LCBlbmdpbmUpCi0JCWVuZ2luZXNbbmVuZ2luZSsrXSA9IGVuZ2luZTsKKwlm
b3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgaTkxNSkKKwkJZW5naW5lc1tuZW5naW5lKytdID0g
ZWJfcmluZyhlKTsKIAlpZ3RfcmVxdWlyZShuZW5naW5lKTsKIAogCXNjcmF0Y2ggPSBnZW1fY3Jl
YXRlKGk5MTUsIDQwOTYpOwpAQCAtODI3LDExICs4MjUsMTAgQEAgaWd0X21haW4KIAogCQlmb3Ig
KGUgPSBpbnRlbF9leGVjdXRpb25fZW5naW5lczsgZS0+bmFtZTsgZSsrKSB7CiAJCQlpZ3Rfc3Vi
dGVzdF9mKCJleGVjLXNoYXJlZC1ndHQtJXMiLCBlLT5uYW1lKQotCQkJCWV4ZWNfc2hhcmVkX2d0
dChpOTE1LCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MpOworCQkJCWV4ZWNfc2hhcmVkX2d0dChpOTE1
LCBlYl9yaW5nKGUpKTsKIAogCQkJaWd0X3N1YnRlc3RfZigiZXhlYy1zaW5nbGUtdGltZWxpbmUt
JXMiLCBlLT5uYW1lKQotCQkJCWV4ZWNfc2luZ2xlX3RpbWVsaW5lKGk5MTUsCi0JCQkJCQkgICAg
IGUtPmV4ZWNfaWQgfCBlLT5mbGFncyk7CisJCQkJZXhlY19zaW5nbGVfdGltZWxpbmUoaTkxNSwg
ZWJfcmluZyhlKSk7CiAKIAkJCS8qCiAJCQkgKiBDaGVjayB0aGF0IHRoZSBzaGFyZWQgY29udGV4
dHMgb3BlcmF0ZSBpbmRlcGVuZGVudGx5LApAQCAtODQyLDI2ICs4MzksMjYgQEAgaWd0X21haW4K
IAkJCSAqLwogCQkJaWd0X3N1YnRlc3RfZ3JvdXAgewogCQkJCWlndF9maXh0dXJlIHsKLQkJCQkJ
Z2VtX3JlcXVpcmVfcmluZyhpOTE1LCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MpOwotCQkJCQlpZ3Rf
cmVxdWlyZShnZW1fY2FuX3N0b3JlX2R3b3JkKGk5MTUsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncykp
OworCQkJCQlnZW1fcmVxdWlyZV9yaW5nKGk5MTUsIGViX3JpbmcoZSkpOworCQkJCQlpZ3RfcmVx
dWlyZShnZW1fY2FuX3N0b3JlX2R3b3JkKGk5MTUsIGViX3JpbmcoZSkpKTsKIAkJCQkJaWd0X3Jl
cXVpcmUoZ2VtX3NjaGVkdWxlcl9lbmFibGVkKGk5MTUpKTsKIAkJCQkJaWd0X3JlcXVpcmUoZ2Vt
X3NjaGVkdWxlcl9oYXNfY3R4X3ByaW9yaXR5KGk5MTUpKTsKIAkJCQl9CiAKIAkJCQlpZ3Rfc3Vi
dGVzdF9mKCJRLWluZGVwZW5kZW50LSVzIiwgZS0+bmFtZSkKLQkJCQkJaW5kZXBlbmRlbnQoaTkx
NSwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCAwKTsKKwkJCQkJaW5kZXBlbmRlbnQoaTkxNSwgZWJf
cmluZyhlKSwgMCk7CiAKIAkJCQlpZ3Rfc3VidGVzdF9mKCJRLWluLW9yZGVyLSVzIiwgZS0+bmFt
ZSkKLQkJCQkJcmVvcmRlcihpOTE1LCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIEVRVUFMKTsKKwkJ
CQkJcmVvcmRlcihpOTE1LCBlYl9yaW5nKGUpLCBFUVVBTCk7CiAKIAkJCQlpZ3Rfc3VidGVzdF9m
KCJRLW91dC1vcmRlci0lcyIsIGUtPm5hbWUpCi0JCQkJCXJlb3JkZXIoaTkxNSwgZS0+ZXhlY19p
ZCB8IGUtPmZsYWdzLCAwKTsKKwkJCQkJcmVvcmRlcihpOTE1LCBlYl9yaW5nKGUpLCAwKTsKIAog
CQkJCWlndF9zdWJ0ZXN0X2YoIlEtcHJvbW90aW9uLSVzIiwgZS0+bmFtZSkKLQkJCQkJcHJvbW90
aW9uKGk5MTUsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncyk7CisJCQkJCXByb21vdGlvbihpOTE1LCBl
Yl9yaW5nKGUpKTsKIAogCQkJCWlndF9zdWJ0ZXN0X2YoIlEtc21va2V0ZXN0LSVzIiwgZS0+bmFt
ZSkKLQkJCQkJc21va2V0ZXN0KGk5MTUsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgNSk7CisJCQkJ
CXNtb2tldGVzdChpOTE1LCBlYl9yaW5nKGUpLCA1KTsKIAkJCX0KIAkJfQogCmRpZmYgLS1naXQg
YS90ZXN0cy9pOTE1L2dlbV9jdHhfc3dpdGNoLmMgYi90ZXN0cy9pOTE1L2dlbV9jdHhfc3dpdGNo
LmMKaW5kZXggYzA3MWRlZjc4Li4zNmVjZDUzNzYgMTAwNjQ0Ci0tLSBhL3Rlc3RzL2k5MTUvZ2Vt
X2N0eF9zd2l0Y2guYworKysgYi90ZXN0cy9pOTE1L2dlbV9jdHhfc3dpdGNoLmMKQEAgLTM0OSw3
ICszNDksNyBAQCBpZ3RfbWFpbgogCWZvciAoZSA9IGludGVsX2V4ZWN1dGlvbl9lbmdpbmVzOyBl
LT5uYW1lOyBlKyspIHsKIAkJc3RydWN0IGludGVsX2V4ZWN1dGlvbl9lbmdpbmUyIGUyX187CiAK
LQkJZTJfXyA9IGdlbV9lYl9mbGFnc190b19lbmdpbmUoZS0+ZXhlY19pZCB8IGUtPmZsYWdzKTsK
KwkJZTJfXyA9IGdlbV9lYl9mbGFnc190b19lbmdpbmUoZWJfcmluZyhlKSk7CiAJCWlmIChlMl9f
LmZsYWdzID09IC0xKQogCQkJY29udGludWU7IC8qIEk5MTVfRVhFQ19CU0Qgd2l0aCBubyByaW5n
IHNlbGVjdG9ycyAqLwogCmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1L2dlbV9jdHhfdGhyYXNoLmMg
Yi90ZXN0cy9pOTE1L2dlbV9jdHhfdGhyYXNoLmMKaW5kZXggYjI1Zjk1ZjEzLi42MmMyNmU5YTAg
MTAwNjQ0Ci0tLSBhL3Rlc3RzL2k5MTUvZ2VtX2N0eF90aHJhc2guYworKysgYi90ZXN0cy9pOTE1
L2dlbV9jdHhfdGhyYXNoLmMKQEAgLTEwMywxMyArMTAzLDExIEBAIHN0YXRpYyB2b2lkIHNpbmds
ZShjb25zdCBjaGFyICpuYW1lLCBib29sIGFsbF9lbmdpbmVzKQogCiAJbnVtX2VuZ2luZXMgPSAw
OwogCWlmIChhbGxfZW5naW5lcykgewotCQl1bnNpZ25lZCBlbmdpbmU7Ci0KLQkJZm9yX2VhY2hf
cGh5c2ljYWxfZW5naW5lKGZkLCBlbmdpbmUpIHsKLQkJCWlmICghZ2VtX2Nhbl9zdG9yZV9kd29y
ZChmZCwgZW5naW5lKSkKKwkJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGZkKSB7CisJCQlp
ZiAoIWdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGViX3JpbmcoZSkpKQogCQkJCWNvbnRpbnVlOwog
Ci0JCQllbmdpbmVzW251bV9lbmdpbmVzKytdID0gZW5naW5lOworCQkJZW5naW5lc1tudW1fZW5n
aW5lcysrXSA9IGViX3JpbmcoZSk7CiAJCQlpZiAobnVtX2VuZ2luZXMgPT0gQVJSQVlfU0laRShl
bmdpbmVzKSkKIAkJCQlicmVhazsKIAkJfQpAQCAtMjIwLDcgKzIxOCw3IEBAIHN0YXRpYyB2b2lk
IHNpbmdsZShjb25zdCBjaGFyICpuYW1lLCBib29sIGFsbF9lbmdpbmVzKQogCiBzdGF0aWMgdm9p
ZCBwcm9jZXNzZXModm9pZCkKIHsKLQl1bnNpZ25lZCBlbmdpbmVzWzE2XSwgZW5naW5lOworCXVu
c2lnbmVkIGVuZ2luZXNbMTZdOwogCWludCBudW1fZW5naW5lczsKIAlzdHJ1Y3QgcmxpbWl0IHJs
aW07CiAJdW5zaWduZWQgbnVtX2N0eDsKQEAgLTIzMCw4ICsyMjgsOCBAQCBzdGF0aWMgdm9pZCBw
cm9jZXNzZXModm9pZCkKIAlmZCA9IGRybV9vcGVuX2RyaXZlcihEUklWRVJfSU5URUwpOwogCiAJ
bnVtX2VuZ2luZXMgPSAwOwotCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShmZCwgZW5naW5lKSB7
Ci0JCWVuZ2luZXNbbnVtX2VuZ2luZXMrK10gPSBlbmdpbmU7CisJZm9yX2VhY2hfcGh5c2ljYWxf
ZW5naW5lKGUsIGZkKSB7CisJCWVuZ2luZXNbbnVtX2VuZ2luZXMrK10gPSBlYl9yaW5nKGUpOwog
CQlpZiAobnVtX2VuZ2luZXMgPT0gQVJSQVlfU0laRShlbmdpbmVzKSkKIAkJCWJyZWFrOwogCX0K
ZGlmZiAtLWdpdCBhL3Rlc3RzL2k5MTUvZ2VtX2Vpby5jIGIvdGVzdHMvaTkxNS9nZW1fZWlvLmMK
aW5kZXggODkyZjM2NTdjLi44ZDZjYjk3NjAgMTAwNjQ0Ci0tLSBhL3Rlc3RzL2k5MTUvZ2VtX2Vp
by5jCisrKyBiL3Rlc3RzL2k5MTUvZ2VtX2Vpby5jCkBAIC00MjcsNyArNDI3LDYgQEAgc3RhdGlj
IHZvaWQgdGVzdF9zdXNwZW5kKGludCBmZCwgaW50IHN0YXRlKQogc3RhdGljIHZvaWQgdGVzdF9p
bmZsaWdodChpbnQgZmQsIHVuc2lnbmVkIGludCB3YWl0KQogewogCWludCBwYXJlbnRfZmQgPSBm
ZDsKLQl1bnNpZ25lZCBpbnQgZW5naW5lOwogCWludCBmZW5jZVs2NF07IC8qIG1vc3RseSBjb25z
ZXJ2YXRpdmUgZXN0aW1hdGUgb2YgcmluZyBzaXplICovCiAJaW50IG1heDsKIApAQCAtNDM5LDcg
KzQzOCw3IEBAIHN0YXRpYyB2b2lkIHRlc3RfaW5mbGlnaHQoaW50IGZkLCB1bnNpZ25lZCBpbnQg
d2FpdCkKIAltYXggPSBtaW4obWF4IC0gMSwgQVJSQVlfU0laRShmZW5jZSkpOwogCWlndF9kZWJ1
ZygiVXNpbmcgJWQgaW5mbGlnaHQgYmF0Y2hlc1xuIiwgbWF4KTsKIAotCWZvcl9lYWNoX2VuZ2lu
ZShwYXJlbnRfZmQsIGVuZ2luZSkgeworCWZvcl9lYWNoX2VuZ2luZShlLCBwYXJlbnRfZmQpIHsK
IAkJY29uc3QgdWludDMyX3QgYmJlID0gTUlfQkFUQ0hfQlVGRkVSX0VORDsKIAkJc3RydWN0IGRy
bV9pOTE1X2dlbV9leGVjX29iamVjdDIgb2JqWzJdOwogCQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4
ZWNidWZmZXIyIGV4ZWNidWY7CkBAIC00NTQsMTYgKzQ1MywxNiBAQCBzdGF0aWMgdm9pZCB0ZXN0
X2luZmxpZ2h0KGludCBmZCwgdW5zaWduZWQgaW50IHdhaXQpCiAJCWdlbV93cml0ZShmZCwgb2Jq
WzFdLmhhbmRsZSwgMCwgJmJiZSwgc2l6ZW9mKGJiZSkpOwogCiAJCWdlbV9xdWllc2NlbnRfZ3B1
KGZkKTsKLQkJaWd0X2RlYnVnKCJTdGFydGluZyAlcyBvbiBlbmdpbmUgJyVzJ1xuIiwgX19mdW5j
X18sIGVfXy0+bmFtZSk7CisJCWlndF9kZWJ1ZygiU3RhcnRpbmcgJXMgb24gZW5naW5lICclcydc
biIsIF9fZnVuY19fLCBlLT5uYW1lKTsKIAkJaWd0X3JlcXVpcmUoaTkxNV9yZXNldF9jb250cm9s
KGZhbHNlKSk7CiAKLQkJaGFuZyA9IHNwaW5fc3luYyhmZCwgMCwgZW5naW5lKTsKKwkJaGFuZyA9
IHNwaW5fc3luYyhmZCwgMCwgZWJfcmluZyhlKSk7CiAJCW9ialswXS5oYW5kbGUgPSBoYW5nLT5o
YW5kbGU7CiAKIAkJbWVtc2V0KCZleGVjYnVmLCAwLCBzaXplb2YoZXhlY2J1ZikpOwogCQlleGVj
YnVmLmJ1ZmZlcnNfcHRyID0gdG9fdXNlcl9wb2ludGVyKG9iaik7CiAJCWV4ZWNidWYuYnVmZmVy
X2NvdW50ID0gMjsKLQkJZXhlY2J1Zi5mbGFncyA9IGVuZ2luZSB8IEk5MTVfRVhFQ19GRU5DRV9P
VVQ7CisJCWV4ZWNidWYuZmxhZ3MgPSBlYl9yaW5nKGUpIHwgSTkxNV9FWEVDX0ZFTkNFX09VVDsK
IAogCQlmb3IgKHVuc2lnbmVkIGludCBuID0gMDsgbiA8IG1heDsgbisrKSB7CiAJCQlnZW1fZXhl
Y2J1Zl93cihmZCwgJmV4ZWNidWYpOwpAQCAtNTYzLDEzICs1NjIsMTIgQEAgc3RhdGljIHVpbnQz
Ml90IGNvbnRleHRfY3JlYXRlX3NhZmUoaW50IGk5MTUpCiBzdGF0aWMgdm9pZCB0ZXN0X2luZmxp
Z2h0X2NvbnRleHRzKGludCBmZCwgdW5zaWduZWQgaW50IHdhaXQpCiB7CiAJaW50IHBhcmVudF9m
ZCA9IGZkOwotCXVuc2lnbmVkIGludCBlbmdpbmU7CiAKIAlpZ3RfcmVxdWlyZV9nZW0oZmQpOwog
CWlndF9yZXF1aXJlKGdlbV9oYXNfZXhlY19mZW5jZShmZCkpOwogCWdlbV9yZXF1aXJlX2NvbnRl
eHRzKGZkKTsKIAotCWZvcl9lYWNoX2VuZ2luZShwYXJlbnRfZmQsIGVuZ2luZSkgeworCWZvcl9l
YWNoX2VuZ2luZShlLCBwYXJlbnRfZmQpIHsKIAkJY29uc3QgdWludDMyX3QgYmJlID0gTUlfQkFU
Q0hfQlVGRkVSX0VORDsKIAkJc3RydWN0IGRybV9pOTE1X2dlbV9leGVjX29iamVjdDIgb2JqWzJd
OwogCQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNidWZmZXIyIGV4ZWNidWY7CkBAIC01ODYsNyAr
NTg0LDcgQEAgc3RhdGljIHZvaWQgdGVzdF9pbmZsaWdodF9jb250ZXh0cyhpbnQgZmQsIHVuc2ln
bmVkIGludCB3YWl0KQogCiAJCWdlbV9xdWllc2NlbnRfZ3B1KGZkKTsKIAotCQlpZ3RfZGVidWco
IlN0YXJ0aW5nICVzIG9uIGVuZ2luZSAnJXMnXG4iLCBfX2Z1bmNfXywgZV9fLT5uYW1lKTsKKwkJ
aWd0X2RlYnVnKCJTdGFydGluZyAlcyBvbiBlbmdpbmUgJyVzJ1xuIiwgX19mdW5jX18sIGUtPm5h
bWUpOwogCQlpZ3RfcmVxdWlyZShpOTE1X3Jlc2V0X2NvbnRyb2woZmFsc2UpKTsKIAogCQltZW1z
ZXQob2JqLCAwLCBzaXplb2Yob2JqKSk7CkBAIC01OTQsMTMgKzU5MiwxMyBAQCBzdGF0aWMgdm9p
ZCB0ZXN0X2luZmxpZ2h0X2NvbnRleHRzKGludCBmZCwgdW5zaWduZWQgaW50IHdhaXQpCiAJCW9i
alsxXS5oYW5kbGUgPSBnZW1fY3JlYXRlKGZkLCA0MDk2KTsKIAkJZ2VtX3dyaXRlKGZkLCBvYmpb
MV0uaGFuZGxlLCAwLCAmYmJlLCBzaXplb2YoYmJlKSk7CiAKLQkJaGFuZyA9IHNwaW5fc3luYyhm
ZCwgMCwgZW5naW5lKTsKKwkJaGFuZyA9IHNwaW5fc3luYyhmZCwgMCwgZWJfcmluZyhlKSk7CiAJ
CW9ialswXS5oYW5kbGUgPSBoYW5nLT5oYW5kbGU7CiAKIAkJbWVtc2V0KCZleGVjYnVmLCAwLCBz
aXplb2YoZXhlY2J1ZikpOwogCQlleGVjYnVmLmJ1ZmZlcnNfcHRyID0gdG9fdXNlcl9wb2ludGVy
KG9iaik7CiAJCWV4ZWNidWYuYnVmZmVyX2NvdW50ID0gMjsKLQkJZXhlY2J1Zi5mbGFncyA9IGVu
Z2luZSB8IEk5MTVfRVhFQ19GRU5DRV9PVVQ7CisJCWV4ZWNidWYuZmxhZ3MgPSBlYl9yaW5nKGUp
IHwgSTkxNV9FWEVDX0ZFTkNFX09VVDsKIAogCQljb3VudCA9IDA7CiAJCWZvciAodW5zaWduZWQg
aW50IG4gPSAwOyBuIDwgQVJSQVlfU0laRShmZW5jZSk7IG4rKykgewpAQCAtNjkxLDcgKzY4OSw3
IEBAIHN0YXRpYyB2b2lkIHRlc3RfaW5mbGlnaHRfaW50ZXJuYWwoaW50IGZkLCB1bnNpZ25lZCBp
bnQgd2FpdCkKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNidWZmZXIyIGV4ZWNidWY7CiAJc3Ry
dWN0IGRybV9pOTE1X2dlbV9leGVjX29iamVjdDIgb2JqWzJdOwogCXVpbnQzMl90IGJiZSA9IE1J
X0JBVENIX0JVRkZFUl9FTkQ7Ci0JdW5zaWduZWQgZW5naW5lLCBuZmVuY2UgPSAwOworCXVuc2ln
bmVkIG5mZW5jZSA9IDA7CiAJaW50IGZlbmNlc1sxNl07CiAJaWd0X3NwaW5fdCAqaGFuZzsKIApA
QCAtNzEyLDggKzcxMCw4IEBAIHN0YXRpYyB2b2lkIHRlc3RfaW5mbGlnaHRfaW50ZXJuYWwoaW50
IGZkLCB1bnNpZ25lZCBpbnQgd2FpdCkKIAltZW1zZXQoJmV4ZWNidWYsIDAsIHNpemVvZihleGVj
YnVmKSk7CiAJZXhlY2J1Zi5idWZmZXJzX3B0ciA9IHRvX3VzZXJfcG9pbnRlcihvYmopOwogCWV4
ZWNidWYuYnVmZmVyX2NvdW50ID0gMjsKLQlmb3JfZWFjaF9lbmdpbmUoZmQsIGVuZ2luZSkgewot
CQlleGVjYnVmLmZsYWdzID0gZW5naW5lIHwgSTkxNV9FWEVDX0ZFTkNFX09VVDsKKwlmb3JfZWFj
aF9lbmdpbmUoZSwgZmQpIHsKKwkJZXhlY2J1Zi5mbGFncyA9IGViX3JpbmcoZSkgfCBJOTE1X0VY
RUNfRkVOQ0VfT1VUOwogCiAJCWdlbV9leGVjYnVmX3dyKGZkLCAmZXhlY2J1Zik7CiAKQEAgLTgy
MiwxMCArODIwLDkgQEAgc3RhdGljIHZvaWQgcmVzZXRfc3RyZXNzKGludCBmZCwgdWludDMyX3Qg
Y3R4MCwKIHN0YXRpYyB2b2lkIHRlc3RfcmVzZXRfc3RyZXNzKGludCBmZCwgdW5zaWduZWQgaW50
IGZsYWdzKQogewogCXVpbnQzMl90IGN0eDAgPSBjb250ZXh0X2NyZWF0ZV9zYWZlKGZkKTsKLQl1
bnNpZ25lZCBpbnQgZW5naW5lOwogCi0JZm9yX2VhY2hfZW5naW5lKGZkLCBlbmdpbmUpCi0JCXJl
c2V0X3N0cmVzcyhmZCwgY3R4MCwgZV9fLT5uYW1lLCBlbmdpbmUsIGZsYWdzKTsKKwlmb3JfZWFj
aF9lbmdpbmUoZSwgZmQpCisJCXJlc2V0X3N0cmVzcyhmZCwgY3R4MCwgZS0+bmFtZSwgZWJfcmlu
ZyhlKSwgZmxhZ3MpOwogCiAJZ2VtX2NvbnRleHRfZGVzdHJveShmZCwgY3R4MCk7CiB9CmRpZmYg
LS1naXQgYS90ZXN0cy9pOTE1L2dlbV9leGVjX2FzeW5jLmMgYi90ZXN0cy9pOTE1L2dlbV9leGVj
X2FzeW5jLmMKaW5kZXggOWEwNmFmN2UyLi5kODNlOWY2ZGIgMTAwNjQ0Ci0tLSBhL3Rlc3RzL2k5
MTUvZ2VtX2V4ZWNfYXN5bmMuYworKysgYi90ZXN0cy9pOTE1L2dlbV9leGVjX2FzeW5jLmMKQEAg
LTg4LDcgKzg4LDYgQEAgc3RhdGljIHZvaWQgb25lKGludCBmZCwgdW5zaWduZWQgcmluZywgdWlu
dDMyX3QgZmxhZ3MpCiAjZGVmaW5lIEJBVENIIDEKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX3JlbG9j
YXRpb25fZW50cnkgcmVsb2M7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9leGVjYnVmZmVyMiBleGVj
YnVmOwotCXVuc2lnbmVkIGludCBvdGhlcjsKIAl1aW50MzJfdCAqYmF0Y2g7CiAJaW50IGk7CiAK
QEAgLTE0MywxNCArMTQyLDE0IEBAIHN0YXRpYyB2b2lkIG9uZShpbnQgZmQsIHVuc2lnbmVkIHJp
bmcsIHVpbnQzMl90IGZsYWdzKQogCWdlbV9jbG9zZShmZCwgb2JqW0JBVENIXS5oYW5kbGUpOwog
CiAJaSA9IDA7Ci0JZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGZkLCBvdGhlcikgewotCQlpZiAo
b3RoZXIgPT0gcmluZykKKwlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQpIHsKKwkJaWYg
KGViX3JpbmcoZSkgPT0gcmluZykKIAkJCWNvbnRpbnVlOwogCi0JCWlmICghZ2VtX2Nhbl9zdG9y
ZV9kd29yZChmZCwgb3RoZXIpKQorCQlpZiAoIWdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGViX3Jp
bmcoZSkpKQogCQkJY29udGludWU7CiAKLQkJc3RvcmVfZHdvcmQoZmQsIG90aGVyLCBvYmpbU0NS
QVRDSF0uaGFuZGxlLCA0KmksIGkpOworCQlzdG9yZV9kd29yZChmZCwgZWJfcmluZyhlKSwgb2Jq
W1NDUkFUQ0hdLmhhbmRsZSwgNCppLCBpKTsKIAkJaSsrOwogCX0KIApAQCAtMjA1LDggKzIwNCw4
IEBAIGlndF9tYWluCiAJCQljb250aW51ZTsKIAogCQlpZ3Rfc3VidGVzdF9mKCJjb25jdXJyZW50
LXdyaXRlcy0lcyIsIGUtPm5hbWUpIHsKLQkJCWlndF9yZXF1aXJlKGdlbV9yaW5nX2hhc19waHlz
aWNhbF9lbmdpbmUoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncykpOwotCQkJaWd0X3JlcXVpcmUo
Z2VtX2Nhbl9zdG9yZV9kd29yZChmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzKSk7CisJCQlpZ3Rf
cmVxdWlyZShnZW1fcmluZ19oYXNfcGh5c2ljYWxfZW5naW5lKGZkLCBlYl9yaW5nKGUpKSk7CisJ
CQlpZ3RfcmVxdWlyZShnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlYl9yaW5nKGUpKSk7CiAJCQlv
bmUoZmQsIGUtPmV4ZWNfaWQsIGUtPmZsYWdzKTsKIAkJfQogCX0KZGlmZiAtLWdpdCBhL3Rlc3Rz
L2k5MTUvZ2VtX2V4ZWNfYXdhaXQuYyBiL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfYXdhaXQuYwppbmRl
eCA1Y2ZlYjhlYzguLjMzZTJlZTQ1ZSAxMDA2NDQKLS0tIGEvdGVzdHMvaTkxNS9nZW1fZXhlY19h
d2FpdC5jCisrKyBiL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfYXdhaXQuYwpAQCAtNzMsMTQgKzczLDEz
IEBAIHN0YXRpYyB2b2lkIHdpZGUoaW50IGZkLCBpbnQgcmluZ19zaXplLCBpbnQgdGltZW91dCwg
dW5zaWduZWQgaW50IGZsYWdzKQogCX0gKmV4ZWM7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9leGVj
X29iamVjdDIgKm9iajsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNidWZmZXIyIGV4ZWNidWY7
Ci0JdW5zaWduZWQgZW5naW5lc1sxNl07Ci0JdW5zaWduZWQgbmVuZ2luZSwgZW5naW5lOworCXVu
c2lnbmVkIGVuZ2luZXNbMTZdLCBuZW5naW5lOwogCXVuc2lnbmVkIGxvbmcgY291bnQ7CiAJZG91
YmxlIHRpbWU7CiAKIAluZW5naW5lID0gMDsKLQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZmQs
IGVuZ2luZSkKLQkJZW5naW5lc1tuZW5naW5lKytdID0gZW5naW5lOworCWZvcl9lYWNoX3BoeXNp
Y2FsX2VuZ2luZShlLCBmZCkKKwkJZW5naW5lc1tuZW5naW5lKytdID0gZWJfcmluZyhlKTsKIAlp
Z3RfcmVxdWlyZShuZW5naW5lKTsKIAogCWV4ZWMgPSBjYWxsb2MobmVuZ2luZSwgc2l6ZW9mKCpl
eGVjKSk7CmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1L2dlbV9leGVjX2NhcHR1cmUuYyBiL3Rlc3Rz
L2k5MTUvZ2VtX2V4ZWNfY2FwdHVyZS5jCmluZGV4IDQ0NTc0OTZkNi4uNTRkYTU3YWNhIDEwMDY0
NAotLS0gYS90ZXN0cy9pOTE1L2dlbV9leGVjX2NhcHR1cmUuYworKysgYi90ZXN0cy9pOTE1L2dl
bV9leGVjX2NhcHR1cmUuYwpAQCAtNTU4LDkgKzU1OCw5IEBAIGlndF9tYWluCiAJCQljb250aW51
ZTsKIAogCQlpZ3Rfc3VidGVzdF9mKCJjYXB0dXJlLSVzIiwgZS0+bmFtZSkgewotCQkJaWd0X3Jl
cXVpcmUoZ2VtX3JpbmdfaGFzX3BoeXNpY2FsX2VuZ2luZShmZCwgZS0+ZXhlY19pZCB8IGUtPmZs
YWdzKSk7Ci0JCQlpZ3RfcmVxdWlyZShnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlLT5leGVjX2lk
IHwgZS0+ZmxhZ3MpKTsKLQkJCWNhcHR1cmUoZmQsIGRpciwgZS0+ZXhlY19pZCB8IGUtPmZsYWdz
KTsKKwkJCWlndF9yZXF1aXJlKGdlbV9yaW5nX2hhc19waHlzaWNhbF9lbmdpbmUoZmQsIGViX3Jp
bmcoZSkpKTsKKwkJCWlndF9yZXF1aXJlKGdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGViX3Jpbmco
ZSkpKTsKKwkJCWNhcHR1cmUoZmQsIGRpciwgZWJfcmluZyhlKSk7CiAJCX0KIAl9CiAKZGlmZiAt
LWdpdCBhL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfY3JlYXRlLmMgYi90ZXN0cy9pOTE1L2dlbV9leGVj
X2NyZWF0ZS5jCmluZGV4IDU0YTI0MjllNC4uODhjNWRkZmQ5IDEwMDY0NAotLS0gYS90ZXN0cy9p
OTE1L2dlbV9leGVjX2NyZWF0ZS5jCisrKyBiL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfY3JlYXRlLmMK
QEAgLTYxLDEzICs2MSwxMSBAQCBzdGF0aWMgdm9pZCBhbGwoaW50IGZkLCB1bnNpZ25lZCBmbGFn
cywgaW50IHRpbWVvdXQsIGludCBuY3B1cykKIAljb25zdCB1aW50MzJfdCBiYmUgPSBNSV9CQVRD
SF9CVUZGRVJfRU5EOwogCXN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY2J1ZmZlcjIgZXhlY2J1ZjsK
IAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNfb2JqZWN0MiBvYmo7Ci0JdW5zaWduZWQgZW5naW5l
c1sxNl07Ci0JdW5zaWduZWQgbmVuZ2luZTsKLQl1bnNpZ25lZCBlbmdpbmU7CisJdW5zaWduZWQg
ZW5naW5lc1sxNl0sIG5lbmdpbmU7CiAKIAluZW5naW5lID0gMDsKLQlmb3JfZWFjaF9waHlzaWNh
bF9lbmdpbmUoZmQsIGVuZ2luZSkKLQkJZW5naW5lc1tuZW5naW5lKytdID0gZW5naW5lOworCWZv
cl9lYWNoX3BoeXNpY2FsX2VuZ2luZShlLCBmZCkKKwkJZW5naW5lc1tuZW5naW5lKytdID0gZWJf
cmluZyhlKTsKIAlpZ3RfcmVxdWlyZShuZW5naW5lKTsKIAogCW1lbXNldCgmb2JqLCAwLCBzaXpl
b2Yob2JqKSk7CmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1L2dlbV9leGVjX2ZlbmNlLmMgYi90ZXN0
cy9pOTE1L2dlbV9leGVjX2ZlbmNlLmMKaW5kZXggMmYwNGQ3YWY0Li4zNjU3YzRiMjcgMTAwNjQ0
Ci0tLSBhL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfZmVuY2UuYworKysgYi90ZXN0cy9pOTE1L2dlbV9l
eGVjX2ZlbmNlLmMKQEAgLTIxNiw3ICsyMTYsNiBAQCBzdGF0aWMgdm9pZCB0ZXN0X2ZlbmNlX2J1
c3lfYWxsKGludCBmZCwgdW5zaWduZWQgZmxhZ3MpCiAJc3RydWN0IGRybV9pOTE1X2dlbV9leGVj
YnVmZmVyMiBleGVjYnVmOwogCXN0cnVjdCB0aW1lc3BlYyB0djsKIAl1aW50MzJfdCAqYmF0Y2g7
Ci0JdW5zaWduZWQgaW50IGVuZ2luZTsKIAlpbnQgYWxsLCBpLCB0aW1lb3V0OwogCiAJZ2VtX3F1
aWVzY2VudF9ncHUoZmQpOwpAQCAtMjYzLDEwICsyNjIsMTAgQEAgc3RhdGljIHZvaWQgdGVzdF9m
ZW5jZV9idXN5X2FsbChpbnQgZmQsIHVuc2lnbmVkIGZsYWdzKQogCWkrKzsKIAogCWFsbCA9IC0x
OwotCWZvcl9lYWNoX2VuZ2luZShmZCwgZW5naW5lKSB7CisJZm9yX2VhY2hfZW5naW5lKGUsIGZk
KSB7CiAJCWludCBmZW5jZSwgbmV3OwogCi0JCWV4ZWNidWYuZmxhZ3MgPSBlbmdpbmUgfCBMT0NB
TF9FWEVDX0ZFTkNFX09VVDsKKwkJZXhlY2J1Zi5mbGFncyA9IGViX3JpbmcoZSkgfCBMT0NBTF9F
WEVDX0ZFTkNFX09VVDsKIAkJZXhlY2J1Zi5yc3ZkMiA9IC0xOwogCQlnZW1fZXhlY2J1Zl93cihm
ZCwgJmV4ZWNidWYpOwogCQlmZW5jZSA9IGV4ZWNidWYucnN2ZDIgPj4gMzI7CkBAIC0zMTksNyAr
MzE4LDYgQEAgc3RhdGljIHZvaWQgdGVzdF9mZW5jZV9hd2FpdChpbnQgZmQsIHVuc2lnbmVkIHJp
bmcsIHVuc2lnbmVkIGZsYWdzKQogewogCXVpbnQzMl90IHNjcmF0Y2ggPSBnZW1fY3JlYXRlKGZk
LCA0MDk2KTsKIAlpZ3Rfc3Bpbl90ICpzcGluOwotCXVuc2lnbmVkIGVuZ2luZTsKIAl1aW50MzJf
dCAqb3V0OwogCWludCBpOwogCkBAIC0zMzYsMTUgKzMzNCwxNSBAQCBzdGF0aWMgdm9pZCB0ZXN0
X2ZlbmNlX2F3YWl0KGludCBmZCwgdW5zaWduZWQgcmluZywgdW5zaWduZWQgZmxhZ3MpCiAJaWd0
X2Fzc2VydChzcGluLT5vdXRfZmVuY2UgIT0gLTEpOwogCiAJaSA9IDA7Ci0JZm9yX2VhY2hfcGh5
c2ljYWxfZW5naW5lKGZkLCBlbmdpbmUpIHsKLQkJaWYgKCFnZW1fY2FuX3N0b3JlX2R3b3JkKGZk
LCBlbmdpbmUpKQorCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShlLCBmZCkgeworCQlpZiAoIWdl
bV9jYW5fc3RvcmVfZHdvcmQoZmQsIGViX3JpbmcoZSkpKQogCQkJY29udGludWU7CiAKIAkJaWYg
KGZsYWdzICYgTk9OQkxPQ0spIHsKLQkJCXN0b3JlKGZkLCBlbmdpbmUsIHNwaW4tPm91dF9mZW5j
ZSwgc2NyYXRjaCwgaSk7CisJCQlzdG9yZShmZCwgZWJfcmluZyhlKSwgc3Bpbi0+b3V0X2ZlbmNl
LCBzY3JhdGNoLCBpKTsKIAkJfSBlbHNlIHsKIAkJCWlndF9mb3JrKGNoaWxkLCAxKQotCQkJCXN0
b3JlKGZkLCBlbmdpbmUsIHNwaW4tPm91dF9mZW5jZSwgc2NyYXRjaCwgaSk7CisJCQkJc3RvcmUo
ZmQsIGViX3JpbmcoZSksIHNwaW4tPm91dF9mZW5jZSwgc2NyYXRjaCwgaSk7CiAJCX0KIAogCQlp
Kys7CkBAIC00MTIsNyArNDEwLDYgQEAgc3RhdGljIHZvaWQgdGVzdF9wYXJhbGxlbChpbnQgZmQs
IHVuc2lnbmVkIGludCBtYXN0ZXIpCiAJdWludDMyX3QgaGFuZGxlWzE2XTsKIAl1aW50MzJfdCBi
YXRjaFsxNl07CiAJaWd0X3NwaW5fdCAqc3BpbjsKLQl1bnNpZ25lZCBlbmdpbmU7CiAJSUdUX0NP
UktfSEFORExFKGMpOwogCXVpbnQzMl90IHBsdWc7CiAJaW50IGksIHggPSAwOwpAQCAtNDk4LDEx
ICs0OTUsMTEgQEAgc3RhdGljIHZvaWQgdGVzdF9wYXJhbGxlbChpbnQgZmQsIHVuc2lnbmVkIGlu
dCBtYXN0ZXIpCiAJb2JqW0JBVENIXS5yZWxvY2F0aW9uX2NvdW50ID0gMTsKIAogCS8qIFF1ZXVl
IGFsbCBzZWNvbmRhcmllcyAqLwotCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShmZCwgZW5naW5l
KSB7Ci0JCWlmIChlbmdpbmUgPT0gbWFzdGVyKQorCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShl
LCBmZCkgeworCQlpZiAoZWJfcmluZyhlKSA9PSBtYXN0ZXIpCiAJCQljb250aW51ZTsKIAotCQll
eGVjYnVmLmZsYWdzID0gZW5naW5lIHwgTE9DQUxfRVhFQ19GRU5DRV9TVUJNSVQ7CisJCWV4ZWNi
dWYuZmxhZ3MgPSBlYl9yaW5nKGUpIHwgTE9DQUxfRVhFQ19GRU5DRV9TVUJNSVQ7CiAJCWlmIChn
ZW4gPCA2KQogCQkJZXhlY2J1Zi5mbGFncyB8PSBJOTE1X0VYRUNfU0VDVVJFOwogCkBAIC02NjMs
OCArNjYwLDcgQEAgc3RhdGljIHZvaWQgdGVzdF9sb25nX2hpc3RvcnkoaW50IGZkLCBsb25nIHJp
bmdfc2l6ZSwgdW5zaWduZWQgZmxhZ3MpCiAJY29uc3QgdWludDMyX3QgYmJlID0gTUlfQkFUQ0hf
QlVGRkVSX0VORDsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNfb2JqZWN0MiBvYmpbMl07CiAJ
c3RydWN0IGRybV9pOTE1X2dlbV9leGVjYnVmZmVyMiBleGVjYnVmOwotCXVuc2lnbmVkIGludCBl
bmdpbmVzWzE2XSwgZW5naW5lOwotCXVuc2lnbmVkIGludCBuZW5naW5lLCBuLCBzOworCXVuc2ln
bmVkIGludCBlbmdpbmVzWzE2XSwgbmVuZ2luZSwgbiwgczsKIAl1bnNpZ25lZCBsb25nIGxpbWl0
OwogCWludCBhbGxfZmVuY2VzOwogCUlHVF9DT1JLX0hBTkRMRShjKTsKQEAgLTY3NCw4ICs2NzAs
OCBAQCBzdGF0aWMgdm9pZCB0ZXN0X2xvbmdfaGlzdG9yeShpbnQgZmQsIGxvbmcgcmluZ19zaXpl
LCB1bnNpZ25lZCBmbGFncykKIAkJbGltaXQgPSByaW5nX3NpemUgLyAzOwogCiAJbmVuZ2luZSA9
IDA7Ci0JZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGZkLCBlbmdpbmUpCi0JCWVuZ2luZXNbbmVu
Z2luZSsrXSA9IGVuZ2luZTsKKwlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQpCisJCWVu
Z2luZXNbbmVuZ2luZSsrXSA9IGViX3JpbmcoZSk7CiAJaWd0X3JlcXVpcmUobmVuZ2luZSk7CiAK
IAlnZW1fcXVpZXNjZW50X2dwdShmZCk7CkBAIC0xMTU2LDcgKzExNTIsNiBAQCBzdGF0aWMgdm9p
ZCB0ZXN0X3N5bmNvYmpfd2FpdChpbnQgZmQpCiAJCS5oYW5kbGUgPSBzeW5jb2JqX2NyZWF0ZShm
ZCksCiAJfTsKIAlpZ3Rfc3Bpbl90ICpzcGluOwotCXVuc2lnbmVkIGVuZ2luZTsKIAl1bnNpZ25l
ZCBoYW5kbGVbMTZdOwogCWludCBuOwogCkBAIC0xMTg5LDEzICsxMTg0LDEzIEBAIHN0YXRpYyB2
b2lkIHRlc3Rfc3luY29ial93YWl0KGludCBmZCkKIAlnZW1fd3JpdGUoZmQsIG9iai5oYW5kbGUs
IDAsICZiYmUsIHNpemVvZihiYmUpKTsKIAogCW4gPSAwOwotCWZvcl9lYWNoX2VuZ2luZShmZCwg
ZW5naW5lKSB7CisJZm9yX2VhY2hfZW5naW5lKGUsIGZkKSB7CiAJCW9iai5oYW5kbGUgPSBnZW1f
Y3JlYXRlKGZkLCA0MDk2KTsKIAkJZ2VtX3dyaXRlKGZkLCBvYmouaGFuZGxlLCAwLCAmYmJlLCBz
aXplb2YoYmJlKSk7CiAKIAkJLyogTm8gaW50ZXItZW5naW5lIHN5bmNocm9uaXNhdGlvbiwgd2ls
bCBjb21wbGV0ZSAqLwotCQlpZiAoZW5naW5lID09IEk5MTVfRVhFQ19CTFQpIHsKLQkJCWV4ZWNi
dWYuZmxhZ3MgPSBlbmdpbmU7CisJCWlmIChlYl9yaW5nKGUpID09IEk5MTVfRVhFQ19CTFQpIHsK
KwkJCWV4ZWNidWYuZmxhZ3MgPSBlYl9yaW5nKGUpOwogCQkJZXhlY2J1Zi5jbGlwcmVjdHNfcHRy
ID0gMDsKIAkJCWV4ZWNidWYubnVtX2NsaXByZWN0cyA9IDA7CiAJCQlnZW1fZXhlY2J1ZihmZCwg
JmV4ZWNidWYpOwpAQCAtMTIwNSw3ICsxMjAwLDcgQEAgc3RhdGljIHZvaWQgdGVzdF9zeW5jb2Jq
X3dhaXQoaW50IGZkKQogCQlpZ3RfYXNzZXJ0KGdlbV9ib19idXN5KGZkLCBzcGluLT5oYW5kbGUp
KTsKIAogCQkvKiBOb3cgd2FpdCB1cG9uIHRoZSBibG9ja2VkIGVuZ2luZSAqLwotCQlleGVjYnVm
LmZsYWdzID0gTE9DQUxfRVhFQ19GRU5DRV9BUlJBWSB8IGVuZ2luZTsKKwkJZXhlY2J1Zi5mbGFn
cyA9IExPQ0FMX0VYRUNfRkVOQ0VfQVJSQVkgfCBlYl9yaW5nKGUpOwogCQlleGVjYnVmLmNsaXBy
ZWN0c19wdHIgPSB0b191c2VyX3BvaW50ZXIoJmZlbmNlKTsKIAkJZXhlY2J1Zi5udW1fY2xpcHJl
Y3RzID0gMTsKIAkJZmVuY2UuZmxhZ3MgPSBMT0NBTF9FWEVDX0ZFTkNFX1dBSVQ7CkBAIC0xNTQ5
LDggKzE1NDQsOCBAQCBpZ3RfbWFpbgogCWZvciAoZSA9IGludGVsX2V4ZWN1dGlvbl9lbmdpbmVz
OyBlLT5uYW1lOyBlKyspIHsKIAkJaWd0X3N1YnRlc3RfZ3JvdXAgewogCQkJaWd0X2ZpeHR1cmUg
ewotCQkJCWlndF9yZXF1aXJlKGdlbV9oYXNfcmluZyhpOTE1LCBlLT5leGVjX2lkIHwgZS0+Zmxh
Z3MpKTsKLQkJCQlpZ3RfcmVxdWlyZShnZW1fY2FuX3N0b3JlX2R3b3JkKGk5MTUsIGUtPmV4ZWNf
aWQgfCBlLT5mbGFncykpOworCQkJCWlndF9yZXF1aXJlKGdlbV9oYXNfcmluZyhpOTE1LCBlYl9y
aW5nKGUpKSk7CisJCQkJaWd0X3JlcXVpcmUoZ2VtX2Nhbl9zdG9yZV9kd29yZChpOTE1LCBlYl9y
aW5nKGUpKSk7CiAJCQl9CiAKIAkJCWlndF9zdWJ0ZXN0X2dyb3VwIHsKQEAgLTE1NjEsMjcgKzE1
NTYsMjcgQEAgaWd0X21haW4KIAkJCQlpZ3Rfc3VidGVzdF9mKCIlc2J1c3ktJXMiLAogCQkJCQkJ
ZS0+ZXhlY19pZCA9PSAwID8gImJhc2ljLSIgOiAiIiwKIAkJCQkJCWUtPm5hbWUpCi0JCQkJCXRl
c3RfZmVuY2VfYnVzeShpOTE1LCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIDApOworCQkJCQl0ZXN0
X2ZlbmNlX2J1c3koaTkxNSwgZWJfcmluZyhlKSwgMCk7CiAJCQkJaWd0X3N1YnRlc3RfZigiJXN3
YWl0LSVzIiwKIAkJCQkJCWUtPmV4ZWNfaWQgPT0gMCA/ICJiYXNpYy0iIDogIiIsCiAJCQkJCQll
LT5uYW1lKQotCQkJCQl0ZXN0X2ZlbmNlX2J1c3koaTkxNSwgZS0+ZXhlY19pZCB8IGUtPmZsYWdz
LCBXQUlUKTsKKwkJCQkJdGVzdF9mZW5jZV9idXN5KGk5MTUsIGViX3JpbmcoZSksIFdBSVQpOwog
CQkJCWlndF9zdWJ0ZXN0X2YoIiVzYXdhaXQtJXMiLAogCQkJCQkJZS0+ZXhlY19pZCA9PSAwID8g
ImJhc2ljLSIgOiAiIiwKIAkJCQkJCWUtPm5hbWUpCi0JCQkJCXRlc3RfZmVuY2VfYXdhaXQoaTkx
NSwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCAwKTsKKwkJCQkJdGVzdF9mZW5jZV9hd2FpdChpOTE1
LCBlYl9yaW5nKGUpLCAwKTsKIAkJCQlpZ3Rfc3VidGVzdF9mKCJuYi1hd2FpdC0lcyIsIGUtPm5h
bWUpCi0JCQkJCXRlc3RfZmVuY2VfYXdhaXQoaTkxNSwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCBO
T05CTE9DSyk7CisJCQkJCXRlc3RfZmVuY2VfYXdhaXQoaTkxNSwgZWJfcmluZyhlKSwgTk9OQkxP
Q0spOwogCiAJCQkJaWd0X3N1YnRlc3RfZigia2VlcC1pbi1mZW5jZS0lcyIsIGUtPm5hbWUpCi0J
CQkJCXRlc3Rfa2VlcF9pbl9mZW5jZShpOTE1LCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIDApOwor
CQkJCQl0ZXN0X2tlZXBfaW5fZmVuY2UoaTkxNSwgZWJfcmluZyhlKSwgMCk7CiAKIAkJCQlpZiAo
ZS0+ZXhlY19pZCAmJgogCQkJCSAgICAhKGUtPmV4ZWNfaWQgPT0gSTkxNV9FWEVDX0JTRCAmJiAh
ZS0+ZmxhZ3MpKSB7CiAJCQkJCWlndF9zdWJ0ZXN0X2YoInBhcmFsbGVsLSVzIiwgZS0+bmFtZSkg
ewogCQkJCQkJaWd0X3JlcXVpcmUoaGFzX3N1Ym1pdF9mZW5jZShpOTE1KSk7CiAJCQkJCQlpZ3Rf
dW50aWxfdGltZW91dCgyKQotCQkJCQkJCXRlc3RfcGFyYWxsZWwoaTkxNSwgZS0+ZXhlY19pZCB8
IGUtPmZsYWdzKTsKKwkJCQkJCQl0ZXN0X3BhcmFsbGVsKGk5MTUsIGViX3JpbmcoZSkpOwogCQkJ
CQl9CiAJCQkJfQogCkBAIC0xNjAwLDEzICsxNTk1LDEzIEBAIGlndF9tYWluCiAJCQkJfQogCiAJ
CQkJaWd0X3N1YnRlc3RfZigiYnVzeS1oYW5nLSVzIiwgZS0+bmFtZSkKLQkJCQkJdGVzdF9mZW5j
ZV9idXN5KGk5MTUsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgSEFORyk7CisJCQkJCXRlc3RfZmVu
Y2VfYnVzeShpOTE1LCBlYl9yaW5nKGUpLCBIQU5HKTsKIAkJCQlpZ3Rfc3VidGVzdF9mKCJ3YWl0
LWhhbmctJXMiLCBlLT5uYW1lKQotCQkJCQl0ZXN0X2ZlbmNlX2J1c3koaTkxNSwgZS0+ZXhlY19p
ZCB8IGUtPmZsYWdzLCBIQU5HIHwgV0FJVCk7CisJCQkJCXRlc3RfZmVuY2VfYnVzeShpOTE1LCBl
Yl9yaW5nKGUpLCBIQU5HIHwgV0FJVCk7CiAJCQkJaWd0X3N1YnRlc3RfZigiYXdhaXQtaGFuZy0l
cyIsIGUtPm5hbWUpCi0JCQkJCXRlc3RfZmVuY2VfYXdhaXQoaTkxNSwgZS0+ZXhlY19pZCB8IGUt
PmZsYWdzLCBIQU5HKTsKKwkJCQkJdGVzdF9mZW5jZV9hd2FpdChpOTE1LCBlYl9yaW5nKGUpLCBI
QU5HKTsKIAkJCQlpZ3Rfc3VidGVzdF9mKCJuYi1hd2FpdC1oYW5nLSVzIiwgZS0+bmFtZSkKLQkJ
CQkJdGVzdF9mZW5jZV9hd2FpdChpOTE1LCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIE5PTkJMT0NL
IHwgSEFORyk7CisJCQkJCXRlc3RfZmVuY2VfYXdhaXQoaTkxNSwgZWJfcmluZyhlKSwgTk9OQkxP
Q0sgfCBIQU5HKTsKIAkJCQlpZ3RfZml4dHVyZSB7CiAJCQkJCWlndF9kaXNhbGxvd19oYW5nKGk5
MTUsIGhhbmcpOwogCQkJCX0KZGlmZiAtLWdpdCBhL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfZmx1c2gu
YyBiL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfZmx1c2guYwppbmRleCBmODIwYjJhOGQuLjI4NzA4NDYw
YiAxMDA2NDQKLS0tIGEvdGVzdHMvaTkxNS9nZW1fZXhlY19mbHVzaC5jCisrKyBiL3Rlc3RzL2k5
MTUvZ2VtX2V4ZWNfZmx1c2guYwpAQCAtNjAwLDcgKzYwMCw3IEBAIGlndF9tYWluCiAJfQogCiAJ
Zm9yIChlID0gaW50ZWxfZXhlY3V0aW9uX2VuZ2luZXM7IGUtPm5hbWU7IGUrKykgaWd0X3N1YnRl
c3RfZ3JvdXAgewotCQl1bnNpZ25lZCByaW5nID0gZS0+ZXhlY19pZCB8IGUtPmZsYWdzOworCQl1
bnNpZ25lZCByaW5nID0gZWJfcmluZyhlKTsKIAkJdW5zaWduZWQgdGltZW91dCA9IDUgKyAxMjAq
ISFlLT5leGVjX2lkOwogCiAJCWlndF9maXh0dXJlIHsKZGlmZiAtLWdpdCBhL3Rlc3RzL2k5MTUv
Z2VtX2V4ZWNfZ3R0ZmlsbC5jIGIvdGVzdHMvaTkxNS9nZW1fZXhlY19ndHRmaWxsLmMKaW5kZXgg
ZWZkNjEyYmI2Li5mYTkxNjFiNGUgMTAwNjQ0Ci0tLSBhL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfZ3R0
ZmlsbC5jCisrKyBiL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfZ3R0ZmlsbC5jCkBAIC0xMTMsMjAgKzEx
MywxOSBAQCBzdGF0aWMgdm9pZCBmaWxsZ3R0KGludCBmZCwgdW5zaWduZWQgcmluZywgaW50IHRp
bWVvdXQpCiAJc3RydWN0IGJhdGNoICpiYXRjaGVzOwogCXVuc2lnbmVkIGVuZ2luZXNbMTZdOwog
CXVuc2lnbmVkIG5lbmdpbmU7Ci0JdW5zaWduZWQgZW5naW5lOwotCXVpbnQ2NF90IHNpemU7CiAJ
dW5zaWduZWQgY291bnQ7CisJdWludDY0X3Qgc2l6ZTsKIAogCXNoYXJlZCA9IG1tYXAoTlVMTCwg
NDA5NiwgUFJPVF9XUklURSwgTUFQX1NIQVJFRCB8IE1BUF9BTk9OLCAtMSwgMCk7CiAJaWd0X2Fz
c2VydChzaGFyZWQgIT0gTUFQX0ZBSUxFRCk7CiAKIAluZW5naW5lID0gMDsKIAlpZiAocmluZyA9
PSAwKSB7Ci0JCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShmZCwgZW5naW5lKSB7Ci0JCQlpZiAo
IWdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGVuZ2luZSkpCisJCWZvcl9lYWNoX3BoeXNpY2FsX2Vu
Z2luZShlLCBmZCkgeworCQkJaWYgKCFnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlYl9yaW5nKGUp
KSkKIAkJCQljb250aW51ZTsKIAotCQkJZW5naW5lc1tuZW5naW5lKytdID0gZW5naW5lOworCQkJ
ZW5naW5lc1tuZW5naW5lKytdID0gZWJfcmluZyhlKTsKIAkJfQogCX0gZWxzZSB7CiAJCWdlbV9y
ZXF1aXJlX3JpbmcoZmQsIHJpbmcpOwpAQCAtMjI0LDcgKzIyMyw3IEBAIGlndF9tYWluCiAKIAlm
b3IgKGUgPSBpbnRlbF9leGVjdXRpb25fZW5naW5lczsgZS0+bmFtZTsgZSsrKQogCQlpZ3Rfc3Vi
dGVzdF9mKCIlcyIsIGUtPm5hbWUpCi0JCQlmaWxsZ3R0KGRldmljZSwgZS0+ZXhlY19pZCB8IGUt
PmZsYWdzLCAyMCk7CisJCQlmaWxsZ3R0KGRldmljZSwgZWJfcmluZyhlKSwgMjApOwogCiAJaWd0
X3N1YnRlc3QoImFsbCIpCiAJCWZpbGxndHQoZGV2aWNlLCAwLCAxNTApOwpkaWZmIC0tZ2l0IGEv
dGVzdHMvaTkxNS9nZW1fZXhlY19sYXRlbmN5LmMgYi90ZXN0cy9pOTE1L2dlbV9leGVjX2xhdGVu
Y3kuYwppbmRleCA5ZGRiMzQ4YzAuLjNkOTkxODJhMCAxMDA2NDQKLS0tIGEvdGVzdHMvaTkxNS9n
ZW1fZXhlY19sYXRlbmN5LmMKKysrIGIvdGVzdHMvaTkxNS9nZW1fZXhlY19sYXRlbmN5LmMKQEAg
LTI2Nyw3ICsyNjcsNiBAQCBzdGF0aWMgdm9pZCBsYXRlbmN5X2Zyb21fcmluZyhpbnQgZmQsCiAJ
c3RydWN0IGRybV9pOTE1X2dlbV9yZWxvY2F0aW9uX2VudHJ5IHJlbG9jOwogCXN0cnVjdCBkcm1f
aTkxNV9nZW1fZXhlY2J1ZmZlcjIgZXhlY2J1ZjsKIAljb25zdCB1bnNpZ25lZCBpbnQgcmVwZWF0
cyA9IHJpbmdfc2l6ZSAvIDI7Ci0JdW5zaWduZWQgaW50IG90aGVyOwogCXVpbnQzMl90ICptYXAs
ICpyZXN1bHRzOwogCXVpbnQzMl90IGN0eFsyXSA9IHt9OwogCWludCBpLCBqOwpAQCAtMzEzLDcg
KzMxMiw3IEBAIHN0YXRpYyB2b2lkIGxhdGVuY3lfZnJvbV9yaW5nKGludCBmZCwKIAlyZWxvYy5w
cmVzdW1lZF9vZmZzZXQgPSBvYmpbMV0ub2Zmc2V0OwogCXJlbG9jLnRhcmdldF9oYW5kbGUgPSBm
bGFncyAmIENPUksgPyAxIDogMDsKIAotCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShmZCwgb3Ro
ZXIpIHsKKwlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQpIHsKIAkJaWd0X3NwaW5fdCAq
c3BpbiA9IE5VTEw7CiAJCUlHVF9DT1JLX0hBTkRMRShjKTsKIApAQCAtMzYxLDcgKzM2MCw3IEBA
IHN0YXRpYyB2b2lkIGxhdGVuY3lfZnJvbV9yaW5nKGludCBmZCwKIAkJCWdlbV9leGVjYnVmKGZk
LCAmZXhlY2J1Zik7CiAKIAkJCWV4ZWNidWYuZmxhZ3MgJj0gfkVOR0lORV9GTEFHUzsKLQkJCWV4
ZWNidWYuZmxhZ3MgfD0gb3RoZXI7CisJCQlleGVjYnVmLmZsYWdzIHw9IGViX3JpbmcoZSk7CiAK
IAkJCWV4ZWNidWYuYmF0Y2hfc3RhcnRfb2Zmc2V0ID0gNjQgKiAoaiArIHJlcGVhdHMpOwogCQkJ
cmVsb2Mub2Zmc2V0ID0KQEAgLTM5NCw3ICszOTMsNyBAQCBzdGF0aWMgdm9pZCBsYXRlbmN5X2Zy
b21fcmluZyhpbnQgZmQsCiAJCWlndF9zcGluX2ZyZWUoZmQsIHNwaW4pOwogCiAJCWlndF9pbmZv
KCIlcy0lcyBkZWxheTogJS4yZm5zXG4iLAotCQkJIG5hbWUsIGVfXy0+bmFtZSwKKwkJCSBuYW1l
LCBlLT5uYW1lLAogCQkJIChyZXN1bHRzWzIqcmVwZWF0cy0xXSAtIHJlc3VsdHNbMF0pIC8gKGRv
dWJsZSlyZXBlYXRzICogcmNzX2Nsb2NrKTsKIAl9CiAKQEAgLTQ3NSwxMiArNDc0LDEyIEBAIHJ0
aG9nX2xhdGVuY3lfb25fcmluZyhpbnQgZmQsIHVuc2lnbmVkIGludCBlbmdpbmUsIGNvbnN0IGNo
YXIgKm5hbWUsIHVuc2lnbmVkIGluCiAKIAluZW5naW5lID0gMDsKIAlpZiAoZW5naW5lID09IEFM
TF9FTkdJTkVTKSB7Ci0JCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShmZCwgZW5naW5lKSB7Ci0J
CQlpZiAoIWdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGVuZ2luZSkpCisJCWZvcl9lYWNoX3BoeXNp
Y2FsX2VuZ2luZShlLCBmZCkgeworCQkJaWYgKCFnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlYl9y
aW5nKGUpKSkKIAkJCQljb250aW51ZTsKIAotCQkJZW5naW5lc1tuZW5naW5lXSA9IGVuZ2luZTsK
LQkJCW5hbWVzW25lbmdpbmVdID0gZV9fLT5uYW1lOworCQkJZW5naW5lc1tuZW5naW5lXSA9IGVi
X3JpbmcoZSk7CisJCQluYW1lc1tuZW5naW5lXSA9IGUtPm5hbWU7CiAJCQluZW5naW5lKys7CiAJ
CX0KIAkJaWd0X3JlcXVpcmUobmVuZ2luZSA+IDEpOwpAQCAtNjkyLDIyICs2OTEsMjIgQEAgaWd0
X21haW4KIAogCQkJaWd0X3N1YnRlc3RfZ3JvdXAgewogCQkJCWlndF9maXh0dXJlIHsKLQkJCQkJ
aWd0X3JlcXVpcmUoZ2VtX3JpbmdfaGFzX3BoeXNpY2FsX2VuZ2luZShkZXZpY2UsIGUtPmV4ZWNf
aWQgfCBlLT5mbGFncykpOworCQkJCQlpZ3RfcmVxdWlyZShnZW1fcmluZ19oYXNfcGh5c2ljYWxf
ZW5naW5lKGRldmljZSwgZWJfcmluZyhlKSkpOwogCQkJCX0KIAogCQkJCWlndF9zdWJ0ZXN0X2Yo
IiVzLWRpc3BhdGNoIiwgZS0+bmFtZSkKIAkJCQkJbGF0ZW5jeV9vbl9yaW5nKGRldmljZSwKLQkJ
CQkJCQllLT5leGVjX2lkIHwgZS0+ZmxhZ3MsCisJCQkJCQkJZWJfcmluZyhlKSwKIAkJCQkJCQll
LT5uYW1lLCAwKTsKIAogCQkJCWlndF9zdWJ0ZXN0X2YoIiVzLWxpdmUtZGlzcGF0Y2giLCBlLT5u
YW1lKQogCQkJCQlsYXRlbmN5X29uX3JpbmcoZGV2aWNlLAotCQkJCQkJCWUtPmV4ZWNfaWQgfCBl
LT5mbGFncywKKwkJCQkJCQllYl9yaW5nKGUpLAogCQkJCQkJCWUtPm5hbWUsIExJVkUpOwogCiAJ
CQkJaWd0X3N1YnRlc3RfZigiJXMtcG9sbCIsIGUtPm5hbWUpCiAJCQkJCXBvbGxfcmluZyhkZXZp
Y2UsCi0JCQkJCQkgIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywKKwkJCQkJCSAgZWJfcmluZyhlKSwK
IAkJCQkJCSAgZS0+bmFtZSk7CiAKIAkJCQlpZ3Rfc3VidGVzdF9mKCIlcy1ydGlkbGUtc3VibWl0
IiwgZS0+bmFtZSkKQEAgLTcyNiwyMSArNzI1LDIxIEBAIGlndF9tYWluCiAKIAkJCQlpZ3Rfc3Vi
dGVzdF9mKCIlcy1saXZlLWRpc3BhdGNoLXF1ZXVlZCIsIGUtPm5hbWUpCiAJCQkJCWxhdGVuY3lf
b25fcmluZyhkZXZpY2UsCi0JCQkJCQkJZS0+ZXhlY19pZCB8IGUtPmZsYWdzLAorCQkJCQkJCWVi
X3JpbmcoZSksCiAJCQkJCQkJZS0+bmFtZSwgTElWRSB8IENPUkspOwogCQkJCWlndF9zdWJ0ZXN0
X2YoIiVzLWRpc3BhdGNoLXF1ZXVlZCIsIGUtPm5hbWUpCiAJCQkJCWxhdGVuY3lfb25fcmluZyhk
ZXZpY2UsCi0JCQkJCQkJZS0+ZXhlY19pZCB8IGUtPmZsYWdzLAorCQkJCQkJCWViX3JpbmcoZSks
CiAJCQkJCQkJZS0+bmFtZSwgQ09SSyk7CiAKIAkJCQlpZ3Rfc3VidGVzdF9mKCIlcy1zeW5jaHJv
bmlzYXRpb24iLCBlLT5uYW1lKQogCQkJCQlsYXRlbmN5X2Zyb21fcmluZyhkZXZpY2UsCi0JCQkJ
CQkJICBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsCisJCQkJCQkJICBlYl9yaW5nKGUpLAogCQkJCQkJ
CSAgZS0+bmFtZSwgMCk7CiAKIAkJCQlpZ3Rfc3VidGVzdF9mKCIlcy1zeW5jaHJvbmlzYXRpb24t
cXVldWVkIiwgZS0+bmFtZSkKIAkJCQkJbGF0ZW5jeV9mcm9tX3JpbmcoZGV2aWNlLAotCQkJCQkJ
CSAgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLAorCQkJCQkJCSAgZWJfcmluZyhlKSwKIAkJCQkJCQkg
IGUtPm5hbWUsIENPUkspOwogCiAJCQkJaWd0X3N1YnRlc3RfZ3JvdXAgewpAQCAtNzUxLDcgKzc1
MCw3IEBAIGlndF9tYWluCiAKIAkJCQkJaWd0X3N1YnRlc3RfZigiJXMtcHJlZW1wdGlvbiIsIGUt
Pm5hbWUpCiAJCQkJCQlsYXRlbmN5X2Zyb21fcmluZyhkZXZpY2UsCi0JCQkJCQkJCSAgZS0+ZXhl
Y19pZCB8IGUtPmZsYWdzLAorCQkJCQkJCQkgIGViX3JpbmcoZSksCiAJCQkJCQkJCSAgZS0+bmFt
ZSwgUFJFRU1QVCk7CiAJCQkJfQogCQkJfQpkaWZmIC0tZ2l0IGEvdGVzdHMvaTkxNS9nZW1fZXhl
Y19ub3AuYyBiL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfbm9wLmMKaW5kZXggODkyMjY4NWFmLi4xYTY5
MDZmMzAgMTAwNjQ0Ci0tLSBhL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfbm9wLmMKKysrIGIvdGVzdHMv
aTkxNS9nZW1fZXhlY19ub3AuYwpAQCAtMjIyLDcgKzIyMiw3IEBAIHN0YXRpYyB2b2lkIHBvbGxf
c2VxdWVudGlhbChpbnQgZmQsIGNvbnN0IGNoYXIgKm5hbWUsIGludCB0aW1lb3V0KQogCXN0cnVj
dCBkcm1faTkxNV9nZW1fZXhlY19vYmplY3QyIG9ialsyXTsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X3JlbG9jYXRpb25fZW50cnkgcmVsb2NbNF0sICpyOwogCXVpbnQzMl90ICpiYmVbMl0sICpzdGF0
ZSwgKmJhdGNoOwotCXVuc2lnbmVkIGVuZ2luZXNbMTZdLCBuZW5naW5lLCBlbmdpbmUsIGZsYWdz
OworCXVuc2lnbmVkIGVuZ2luZXNbMTZdLCBuZW5naW5lLCBmbGFnczsKIAlzdHJ1Y3QgdGltZXNw
ZWMgdHYgPSB7fTsKIAl1bnNpZ25lZCBsb25nIGN5Y2xlczsKIAl1aW50NjRfdCBlbGFwc2VkOwpA
QCAtMjMzLDExICsyMzMsMTEgQEAgc3RhdGljIHZvaWQgcG9sbF9zZXF1ZW50aWFsKGludCBmZCwg
Y29uc3QgY2hhciAqbmFtZSwgaW50IHRpbWVvdXQpCiAJCWZsYWdzIHw9IEk5MTVfRVhFQ19TRUNV
UkU7CiAKIAluZW5naW5lID0gMDsKLQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZmQsIGVuZ2lu
ZSkgewotCQlpZiAoIWdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGVuZ2luZSkpCisJZm9yX2VhY2hf
cGh5c2ljYWxfZW5naW5lKGUsIGZkKSB7CisJCWlmICghZ2VtX2Nhbl9zdG9yZV9kd29yZChmZCwg
ZWJfcmluZyhlKSkpCiAJCQljb250aW51ZTsKIAotCQllbmdpbmVzW25lbmdpbmUrK10gPSBlbmdp
bmU7CisJCWVuZ2luZXNbbmVuZ2luZSsrXSA9IGViX3JpbmcoZSk7CiAJfQogCWlndF9yZXF1aXJl
KG5lbmdpbmUpOwogCkBAIC00MzgsMTQgKzQzOCwxNCBAQCBzdGF0aWMgdm9pZCBwYXJhbGxlbChp
bnQgZmQsIHVpbnQzMl90IGhhbmRsZSwgaW50IHRpbWVvdXQpCiAKIAlzdW0gPSAwOwogCW5lbmdp
bmUgPSAwOwotCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShmZCwgZW5naW5lKSB7Ci0JCWVuZ2lu
ZXNbbmVuZ2luZV0gPSBlbmdpbmU7Ci0JCW5hbWVzW25lbmdpbmVdID0gZV9fLT5uYW1lOworCWZv
cl9lYWNoX3BoeXNpY2FsX2VuZ2luZShlLCBmZCkgeworCQllbmdpbmVzW25lbmdpbmVdID0gZWJf
cmluZyhlKTsKKwkJbmFtZXNbbmVuZ2luZV0gPSBlLT5uYW1lOwogCQluZW5naW5lKys7CiAKIAkJ
dGltZSA9IG5vcF9vbl9yaW5nKGZkLCBoYW5kbGUsIGVuZ2luZSwgMSwgJmNvdW50KSAvIGNvdW50
OwogCQlzdW0gKz0gdGltZTsKLQkJaWd0X2RlYnVnKCIlczogJS4zZnVzXG4iLCBlX18tPm5hbWUs
IDFlNip0aW1lKTsKKwkJaWd0X2RlYnVnKCIlczogJS4zZnVzXG4iLCBlLT5uYW1lLCAxZTYqdGlt
ZSk7CiAJfQogCWlndF9yZXF1aXJlKG5lbmdpbmUpOwogCWlndF9pbmZvKCJhdmVyYWdlIChpbmRp
dmlkdWFsbHkpOiAlLjNmdXNcbiIsIHN1bS9uZW5naW5lKjFlNik7CkBAIC00OTQsMjIgKzQ5NCwy
MSBAQCBzdGF0aWMgdm9pZCBzZXJpZXMoaW50IGZkLCB1aW50MzJfdCBoYW5kbGUsIGludCB0aW1l
b3V0KQogCXN0cnVjdCB0aW1lc3BlYyBzdGFydCwgbm93LCBzeW5jOwogCXVuc2lnbmVkIGVuZ2lu
ZXNbMTZdOwogCXVuc2lnbmVkIG5lbmdpbmU7Ci0JdW5zaWduZWQgZW5naW5lOwogCXVuc2lnbmVk
IGxvbmcgY291bnQ7CiAJZG91YmxlIHRpbWUsIG1heCA9IDAsIG1pbiA9IEhVR0VfVkFMLCBzdW0g
PSAwOwogCWNvbnN0IGNoYXIgKm5hbWU7CiAKIAluZW5naW5lID0gMDsKLQlmb3JfZWFjaF9waHlz
aWNhbF9lbmdpbmUoZmQsIGVuZ2luZSkgewotCQl0aW1lID0gbm9wX29uX3JpbmcoZmQsIGhhbmRs
ZSwgZW5naW5lLCAxLCAmY291bnQpIC8gY291bnQ7CisJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5l
KGUsIGZkKSB7CisJCXRpbWUgPSBub3Bfb25fcmluZyhmZCwgaGFuZGxlLCBlYl9yaW5nKGUpLCAx
LCAmY291bnQpIC8gY291bnQ7CiAJCWlmICh0aW1lID4gbWF4KSB7Ci0JCQluYW1lID0gZV9fLT5u
YW1lOworCQkJbmFtZSA9IGUtPm5hbWU7CiAJCQltYXggPSB0aW1lOwogCQl9CiAJCWlmICh0aW1l
IDwgbWluKQogCQkJbWluID0gdGltZTsKIAkJc3VtICs9IHRpbWU7Ci0JCWVuZ2luZXNbbmVuZ2lu
ZSsrXSA9IGVuZ2luZTsKKwkJZW5naW5lc1tuZW5naW5lKytdID0gZWJfcmluZyhlKTsKIAl9CiAJ
aWd0X3JlcXVpcmUobmVuZ2luZSk7CiAJaWd0X2luZm8oIk1heGltdW0gZXhlY3V0aW9uIGxhdGVu
Y3kgb24gJXMsICUuM2Z1cywgbWluICUuM2Z1cywgdG90YWwgJS4zZnVzIHBlciBjeWNsZSwgYXZl
cmFnZSAlLjNmdXNcbiIsCkBAIC01OTUsMTQgKzU5NCwxNCBAQCBzdGF0aWMgdm9pZCBzZXF1ZW50
aWFsKGludCBmZCwgdWludDMyX3QgaGFuZGxlLCB1bnNpZ25lZCBmbGFncywgaW50IHRpbWVvdXQp
CiAKIAluZW5naW5lID0gMDsKIAlzdW0gPSAwOwotCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShm
ZCwgbikgeworCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShlLCBmZCkgewogCQl1bnNpZ25lZCBs
b25nIGNvdW50OwogCiAJCXRpbWUgPSBub3Bfb25fcmluZyhmZCwgaGFuZGxlLCBuLCAxLCAmY291
bnQpIC8gY291bnQ7CiAJCXN1bSArPSB0aW1lOwotCQlpZ3RfZGVidWcoIiVzOiAlLjNmdXNcbiIs
IGVfXy0+bmFtZSwgMWU2KnRpbWUpOworCQlpZ3RfZGVidWcoIiVzOiAlLjNmdXNcbiIsIGUtPm5h
bWUsIDFlNip0aW1lKTsKIAotCQllbmdpbmVzW25lbmdpbmUrK10gPSBuOworCQllbmdpbmVzW25l
bmdpbmUrK10gPSBlYl9yaW5nKGUpOwogCX0KIAlpZ3RfcmVxdWlyZShuZW5naW5lKTsKIAlpZ3Rf
aW5mbygiVG90YWwgKGluZGl2aWR1YWwpIGV4ZWN1dGlvbiBsYXRlbmN5ICUuM2Z1cyBwZXIgY3lj
bGVcbiIsCkBAIC03MjYsOCArNzI1LDggQEAgc3RhdGljIHZvaWQgZmVuY2Vfc2lnbmFsKGludCBm
ZCwgdWludDMyX3QgaGFuZGxlLAogCiAJbmVuZ2luZSA9IDA7CiAJaWYgKHJpbmdfaWQgPT0gQUxM
X0VOR0lORVMpIHsKLQkJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGZkLCBuKQotCQkJZW5naW5l
c1tuZW5naW5lKytdID0gbjsKKwkJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGZkKQorCQkJ
ZW5naW5lc1tuZW5naW5lKytdID0gZWJfcmluZyhlKTsKIAl9IGVsc2UgewogCQlnZW1fcmVxdWly
ZV9yaW5nKGZkLCByaW5nX2lkKTsKIAkJZW5naW5lc1tuZW5naW5lKytdID0gcmluZ19pZDsKQEAg
LTg3NSw5ICs4NzQsOSBAQCBpZ3RfbWFpbgogCiAJZm9yIChlID0gaW50ZWxfZXhlY3V0aW9uX2Vu
Z2luZXM7IGUtPm5hbWU7IGUrKykgewogCQlpZ3Rfc3VidGVzdF9mKCIlcyIsIGUtPm5hbWUpCi0J
CQlzaW5nbGUoZGV2aWNlLCBoYW5kbGUsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgZS0+bmFtZSk7
CisJCQlzaW5nbGUoZGV2aWNlLCBoYW5kbGUsIGViX3JpbmcoZSksIGUtPm5hbWUpOwogCQlpZ3Rf
c3VidGVzdF9mKCJzaWduYWwtJXMiLCBlLT5uYW1lKQotCQkJZmVuY2Vfc2lnbmFsKGRldmljZSwg
aGFuZGxlLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIGUtPm5hbWUsIDUpOworCQkJZmVuY2Vfc2ln
bmFsKGRldmljZSwgaGFuZGxlLCBlYl9yaW5nKGUpLCBlLT5uYW1lLCA1KTsKIAl9CiAKIAlpZ3Rf
c3VidGVzdCgic2lnbmFsLWFsbCIpCkBAIC05MTAsNyArOTA5LDcgQEAgaWd0X21haW4KIAogCQlm
b3IgKGUgPSBpbnRlbF9leGVjdXRpb25fZW5naW5lczsgZS0+bmFtZTsgZSsrKSB7CiAJCQlpZ3Rf
c3VidGVzdF9mKCJwcmVlbXB0LSVzIiwgZS0+bmFtZSkKLQkJCQlwcmVlbXB0KGRldmljZSwgaGFu
ZGxlLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIGUtPm5hbWUpOworCQkJCXByZWVtcHQoZGV2aWNl
LCBoYW5kbGUsIGViX3JpbmcoZSksIGUtPm5hbWUpOwogCQl9CiAJfQogCkBAIC05MjIsOCArOTIx
LDcgQEAgaWd0X21haW4KIAkJZm9yIChlID0gaW50ZWxfZXhlY3V0aW9uX2VuZ2luZXM7IGUtPm5h
bWU7IGUrKykgewogCQkJLyogUmVxdWlyZXMgbWFzdGVyIGZvciBTVE9SRV9EV09SRCBvbiBnZW40
LzUgKi8KIAkJCWlndF9zdWJ0ZXN0X2YoInBvbGwtJXMiLCBlLT5uYW1lKQotCQkJCXBvbGxfcmlu
ZyhkZXZpY2UsCi0JCQkJCSAgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCBlLT5uYW1lLCAyMCk7CisJ
CQkJcG9sbF9yaW5nKGRldmljZSwgZWJfcmluZyhlKSwgZS0+bmFtZSwgMjApOwogCQl9CiAKIAkJ
aWd0X3N1YnRlc3QoInBvbGwtc2VxdWVudGlhbCIpCmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1L2dl
bV9leGVjX3BhcmFtcy5jIGIvdGVzdHMvaTkxNS9nZW1fZXhlY19wYXJhbXMuYwppbmRleCA0OWM1
NmE4ZDcuLjhmMTVlNjQ1NCAxMDA2NDQKLS0tIGEvdGVzdHMvaTkxNS9nZW1fZXhlY19wYXJhbXMu
YworKysgYi90ZXN0cy9pOTE1L2dlbV9leGVjX3BhcmFtcy5jCkBAIC0yMzYsOCArMjM2LDggQEAg
aWd0X21haW4KIAogCWlndF9zdWJ0ZXN0KCJjb250cm9sIikgewogCQlmb3IgKGUgPSBpbnRlbF9l
eGVjdXRpb25fZW5naW5lczsgZS0+bmFtZTsgZSsrKSB7Ci0JCQlpZiAoaGFzX3JpbmcoZmQsIGUt
PmV4ZWNfaWQgfCBlLT5mbGFncykpIHsKLQkJCQlleGVjYnVmLmZsYWdzID0gZS0+ZXhlY19pZCB8
IGUtPmZsYWdzOworCQkJaWYgKGhhc19yaW5nKGZkLCBlYl9yaW5nKGUpKSkgeworCQkJCWV4ZWNi
dWYuZmxhZ3MgPSBlYl9yaW5nKGUpOwogCQkJCWdlbV9leGVjYnVmKGZkLCAmZXhlY2J1Zik7CiAJ
CQl9CiAJCX0KQEAgLTM4NywxNCArMzg3LDE2IEBAIGlndF9tYWluCiAKIAlpZ3Rfc3VidGVzdCgi
cnMtaW52YWxpZCIpIHsKIAkJYm9vbCBoYXNfcnMgPSBoYXNfcmVzb3VyY2Vfc3RyZWFtZXIoZmQp
OwotCQl1bnNpZ25lZCBpbnQgZW5naW5lOwogCi0JCWZvcl9lYWNoX2VuZ2luZShmZCwgZW5naW5l
KSB7CisJCWZvcl9lYWNoX2VuZ2luZShpdCwgZmQpIHsKIAkJCWludCBleHBlY3QgPSAtRUlOVkFM
OwotCQkJaWYgKGhhc19ycyAmJiAoZW5naW5lID09IDAgfHwgZW5naW5lID09IEk5MTVfRVhFQ19S
RU5ERVIpKQorCQkJaWYgKGhhc19ycyAmJgorCQkJICAgIChlYl9yaW5nKGl0KSA9PSAwIHx8CisJ
CQkgICAgIGViX3JpbmcoaXQpID09IEk5MTVfRVhFQ19SRU5ERVIpKQogCQkJCWV4cGVjdCA9IDA7
CiAKLQkJCWV4ZWNidWYuZmxhZ3MgPSBlbmdpbmUgfCBMT0NBTF9JOTE1X0VYRUNfUkVTT1VSQ0Vf
U1RSRUFNRVI7CisJCQlleGVjYnVmLmZsYWdzID0KKwkJCQllYl9yaW5nKGl0KSB8IExPQ0FMX0k5
MTVfRVhFQ19SRVNPVVJDRV9TVFJFQU1FUjsKIAkJCWlndF9hc3NlcnRfZXEoX19nZW1fZXhlY2J1
ZihmZCwgJmV4ZWNidWYpLCBleHBlY3QpOwogCQl9CiAJfQpkaWZmIC0tZ2l0IGEvdGVzdHMvaTkx
NS9nZW1fZXhlY19yZWxvYy5jIGIvdGVzdHMvaTkxNS9nZW1fZXhlY19yZWxvYy5jCmluZGV4IGZk
ZDk2NjFkMS4uNWY1OWZlOTlmIDEwMDY0NAotLS0gYS90ZXN0cy9pOTE1L2dlbV9leGVjX3JlbG9j
LmMKKysrIGIvdGVzdHMvaTkxNS9nZW1fZXhlY19yZWxvYy5jCkBAIC0yNTgsOSArMjU4LDkgQEAg
c3RhdGljIHZvaWQgYWN0aXZlKGludCBmZCwgdW5zaWduZWQgZW5naW5lKQogCiAJbmVuZ2luZSA9
IDA7CiAJaWYgKGVuZ2luZSA9PSBBTExfRU5HSU5FUykgewotCQlmb3JfZWFjaF9waHlzaWNhbF9l
bmdpbmUoZmQsIGVuZ2luZSkgewotCQkJaWYgKGdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGVuZ2lu
ZSkpCi0JCQkJZW5naW5lc1tuZW5naW5lKytdID0gZW5naW5lOworCQlmb3JfZWFjaF9waHlzaWNh
bF9lbmdpbmUoZSwgZmQpIHsKKwkJCWlmIChnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlYl9yaW5n
KGUpKSkKKwkJCQllbmdpbmVzW25lbmdpbmUrK10gPSBlYl9yaW5nKGUpOwogCQl9CiAJfSBlbHNl
IHsKIAkJaWd0X3JlcXVpcmUoZ2VtX2hhc19yaW5nKGZkLCBlbmdpbmUpKTsKQEAgLTc1NCw3ICs3
NTQsNyBAQCBpZ3RfbWFpbgogCWZvciAoY29uc3Qgc3RydWN0IGludGVsX2V4ZWN1dGlvbl9lbmdp
bmUgKmUgPSBpbnRlbF9leGVjdXRpb25fZW5naW5lczsKIAkgICAgIGUtPm5hbWU7IGUrKykgewog
CQlpZ3Rfc3VidGVzdF9mKCJhY3RpdmUtJXMiLCBlLT5uYW1lKQotCQkJYWN0aXZlKGZkLCBlLT5l
eGVjX2lkIHwgZS0+ZmxhZ3MpOworCQkJYWN0aXZlKGZkLCBlYl9yaW5nKGUpKTsKIAl9CiAJaWd0
X2ZpeHR1cmUKIAkJY2xvc2UoZmQpOwpkaWZmIC0tZ2l0IGEvdGVzdHMvaTkxNS9nZW1fZXhlY19y
ZXVzZS5jIGIvdGVzdHMvaTkxNS9nZW1fZXhlY19yZXVzZS5jCmluZGV4IDkzNWJmYTlhYy4uOTcx
ZWI0MTM3IDEwMDY0NAotLS0gYS90ZXN0cy9pOTE1L2dlbV9leGVjX3JldXNlLmMKKysrIGIvdGVz
dHMvaTkxNS9nZW1fZXhlY19yZXVzZS5jCkBAIC04OSw3ICs4OSw2IEBAIGlndF9tYWluCiAJaWd0
X2ZpeHR1cmUgewogCQl1aW50NjRfdCBndHRfc2l6ZSwgbWF4OwogCQl1aW50MzJfdCBiYmUgPSBN
SV9CQVRDSF9CVUZGRVJfRU5EOwotCQl1bnNpZ25lZCBlbmdpbmU7CiAKIAkJaWd0X2FsbG93X3Vu
bGltaXRlZF9maWxlcygpOwogCkBAIC0xMTgsOSArMTE3LDggQEAgaWd0X21haW4KIAkJbm8ub2Jq
ID0gbWFsbG9jKHNpemVvZihzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNfb2JqZWN0MikgKiAobm8u
bWF4X2FnZSArIDEpKTsKIAogCQluZW5naW5lID0gMDsKLQkJZm9yX2VhY2hfZW5naW5lKG5vLmZk
LCBlbmdpbmUpCi0JCQlpZiAoZW5naW5lKQotCQkJCWVuZ2luZXNbbmVuZ2luZSsrXSA9IGVuZ2lu
ZTsKKwkJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIG5vLmZkKQorCQkJZW5naW5lc1tuZW5n
aW5lKytdID0gZWJfcmluZyhlKTsKIAkJaWd0X3JlcXVpcmUobmVuZ2luZSk7CiAKIAkJbm8uYmF0
Y2ggPSBnZW1fY3JlYXRlKG5vLmZkLCA0MDk2KTsKZGlmZiAtLWdpdCBhL3Rlc3RzL2k5MTUvZ2Vt
X2V4ZWNfc2NoZWR1bGUuYyBiL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfc2NoZWR1bGUuYwppbmRleCA4
Njk1Y2JlOWQuLjQ3ZjYxNGVlYyAxMDA2NDQKLS0tIGEvdGVzdHMvaTkxNS9nZW1fZXhlY19zY2hl
ZHVsZS5jCisrKyBiL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfc2NoZWR1bGUuYwpAQCAtMjQwLDcgKzI0
MCw2IEBAIHN0YXRpYyB2b2lkIGluZGVwZW5kZW50KGludCBmZCwgdW5zaWduZWQgaW50IGVuZ2lu
ZSkKIAlJR1RfQ09SS19GRU5DRShjb3JrKTsKIAlpZ3Rfc3Bpbl90ICpzcGluID0gTlVMTDsKIAl1
aW50MzJfdCBzY3JhdGNoLCBiYXRjaDsKLQl1bnNpZ25lZCBpbnQgb3RoZXI7CiAJdWludDMyX3Qg
KnB0cjsKIAlpbnQgZmVuY2U7CiAKQEAgLTI1MywyNSArMjUyLDI1IEBAIHN0YXRpYyB2b2lkIGlu
ZGVwZW5kZW50KGludCBmZCwgdW5zaWduZWQgaW50IGVuZ2luZSkKIAlmZW5jZSA9IGlndF9jb3Jr
X3BsdWcoJmNvcmssIGZkKTsKIAogCS8qIENoZWNrIHRoYXQgd2UgY2FuIHN1Ym1pdCB0byBlbmdp
bmUgd2hpbGUgYWxsIG90aGVycyBhcmUgYmxvY2tlZCAqLwotCWZvcl9lYWNoX3BoeXNpY2FsX2Vu
Z2luZShmZCwgb3RoZXIpIHsKLQkJaWYgKG90aGVyID09IGVuZ2luZSkKKwlmb3JfZWFjaF9waHlz
aWNhbF9lbmdpbmUoZSwgZmQpIHsKKwkJaWYgKGViX3JpbmcoZSkgPT0gZW5naW5lKQogCQkJY29u
dGludWU7CiAKLQkJaWYgKCFnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBvdGhlcikpCisJCWlmICgh
Z2VtX2Nhbl9zdG9yZV9kd29yZChmZCwgZWJfcmluZyhlKSkpCiAJCQljb250aW51ZTsKIAogCQlp
ZiAoc3BpbiA9PSBOVUxMKSB7Ci0JCQlzcGluID0gX19pZ3Rfc3Bpbl9uZXcoZmQsIC5lbmdpbmUg
PSBvdGhlcik7CisJCQlzcGluID0gX19pZ3Rfc3Bpbl9uZXcoZmQsIC5lbmdpbmUgPSBlYl9yaW5n
KGUpKTsKIAkJfSBlbHNlIHsKIAkJCXN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY2J1ZmZlcjIgZWIg
PSB7CiAJCQkJLmJ1ZmZlcl9jb3VudCA9IDEsCiAJCQkJLmJ1ZmZlcnNfcHRyID0gdG9fdXNlcl9w
b2ludGVyKCZzcGluLT5vYmpbSUdUX1NQSU5fQkFUQ0hdKSwKLQkJCQkuZmxhZ3MgPSBvdGhlciwK
KwkJCQkuZmxhZ3MgPSBlYl9yaW5nKGUpLAogCQkJfTsKIAkJCWdlbV9leGVjYnVmKGZkLCAmZWIp
OwogCQl9CiAKLQkJc3RvcmVfZHdvcmRfZmVuY2VkKGZkLCAwLCBvdGhlciwgc2NyYXRjaCwgMCwg
b3RoZXIsIGZlbmNlLCAwKTsKKwkJc3RvcmVfZHdvcmRfZmVuY2VkKGZkLCAwLCBlYl9yaW5nKGUp
LCBzY3JhdGNoLCAwLCBlYl9yaW5nKGUpLCBmZW5jZSwgMCk7CiAJfQogCWlndF9yZXF1aXJlKHNw
aW4pOwogCkBAIC0zMTIsOSArMzExLDkgQEAgc3RhdGljIHZvaWQgc21va2V0ZXN0KGludCBmZCwg
dW5zaWduZWQgcmluZywgdW5zaWduZWQgdGltZW91dCkKIAogCW5lbmdpbmUgPSAwOwogCWlmIChy
aW5nID09IEFMTF9FTkdJTkVTKSB7Ci0JCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShmZCwgZW5n
aW5lKQotCQkJaWYgKGdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGVuZ2luZSkpCi0JCQkJZW5naW5l
c1tuZW5naW5lKytdID0gZW5naW5lOworCQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQp
CisJCQlpZiAoZ2VtX2Nhbl9zdG9yZV9kd29yZChmZCwgZWJfcmluZyhlKSkpCisJCQkJZW5naW5l
c1tuZW5naW5lKytdID0gZWJfcmluZyhlKTsKIAl9IGVsc2UgewogCQlpZiAoZ2VtX2Nhbl9zdG9y
ZV9kd29yZChmZCwgcmluZykpCiAJCQllbmdpbmVzW25lbmdpbmUrK10gPSByaW5nOwpAQCAtMzg1
LDcgKzM4NCw2IEBAIHN0YXRpYyB2b2lkIHNlbWFwaG9yZV91c2VybG9jayhpbnQgaTkxNSkKIAkJ
LmhhbmRsZSA9IGJhdGNoX2NyZWF0ZShpOTE1KSwKIAl9OwogCWlndF9zcGluX3QgKnNwaW4gPSBO
VUxMOwotCXVuc2lnbmVkIGludCBlbmdpbmU7CiAJdWludDMyX3Qgc2NyYXRjaDsKIAogCWlndF9y
ZXF1aXJlKGdlbV9zY2hlZHVsZXJfaGFzX3NlbWFwaG9yZXMoaTkxNSkpOwpAQCAtMzk4LDE2ICsz
OTYsMTYgQEAgc3RhdGljIHZvaWQgc2VtYXBob3JlX3VzZXJsb2NrKGludCBpOTE1KQogCSAqLwog
CiAJc2NyYXRjaCA9IGdlbV9jcmVhdGUoaTkxNSwgNDA5Nik7Ci0JZm9yX2VhY2hfcGh5c2ljYWxf
ZW5naW5lKGk5MTUsIGVuZ2luZSkgeworCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShlLCBpOTE1
KSB7CiAJCWlmICghc3BpbikgewogCQkJc3BpbiA9IGlndF9zcGluX25ldyhpOTE1LAogCQkJCQkg
ICAgLmRlcGVuZGVuY3kgPSBzY3JhdGNoLAotCQkJCQkgICAgLmVuZ2luZSA9IGVuZ2luZSk7CisJ
CQkJCSAgICAuZW5naW5lID0gZWJfcmluZyhlKSk7CiAJCX0gZWxzZSB7CiAJCQl1aW50NjRfdCBz
YXZlZCA9IHNwaW4tPmV4ZWNidWYuZmxhZ3M7CiAKIAkJCXNwaW4tPmV4ZWNidWYuZmxhZ3MgJj0g
fkVOR0lORV9NQVNLOwotCQkJc3Bpbi0+ZXhlY2J1Zi5mbGFncyB8PSBlbmdpbmU7CisJCQlzcGlu
LT5leGVjYnVmLmZsYWdzIHw9IGViX3JpbmcoZSk7CiAKIAkJCWdlbV9leGVjYnVmKGk5MTUsICZz
cGluLT5leGVjYnVmKTsKIApAQCAtNDIzLDE1ICs0MjEsMTUgQEAgc3RhdGljIHZvaWQgc2VtYXBo
b3JlX3VzZXJsb2NrKGludCBpOTE1KQogCSAqIHRha2luZyBwcmVjZWRlbmNlLgogCSAqLwogCXNj
cmF0Y2ggPSBnZW1fY29udGV4dF9jcmVhdGUoaTkxNSk7Ci0JZm9yX2VhY2hfcGh5c2ljYWxfZW5n
aW5lKGk5MTUsIGVuZ2luZSkgeworCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShlLCBpOTE1KSB7
CiAJCXN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY2J1ZmZlcjIgZXhlY2J1ZiA9IHsKIAkJCS5idWZm
ZXJzX3B0ciA9IHRvX3VzZXJfcG9pbnRlcigmb2JqKSwKIAkJCS5idWZmZXJfY291bnQgPSAxLAot
CQkJLmZsYWdzID0gZW5naW5lLAorCQkJLmZsYWdzID0gZWJfcmluZyhlKSwKIAkJCS5yc3ZkMSA9
IHNjcmF0Y2gsCiAJCX07CiAKLQkJaWYgKGVuZ2luZSA9PSAoc3Bpbi0+ZXhlY2J1Zi5mbGFncyAm
IEVOR0lORV9NQVNLKSkKKwkJaWYgKGViX3JpbmcoZSkgPT0gKHNwaW4tPmV4ZWNidWYuZmxhZ3Mg
JiBFTkdJTkVfTUFTSykpCiAJCQljb250aW51ZTsKIAogCQlnZW1fZXhlY2J1ZihpOTE1LCAmZXhl
Y2J1Zik7CkBAIC00NDgsNyArNDQ2LDYgQEAgc3RhdGljIHZvaWQgc2VtYXBob3JlX2NvZGVwZW5k
ZW5jeShpbnQgaTkxNSkKIAlzdHJ1Y3QgewogCQlpZ3Rfc3Bpbl90ICp4Y3MsICpyY3M7CiAJfSB0
YXNrWzJdOwotCXVuc2lnbmVkIGludCBlbmdpbmU7CiAJaW50IGk7CiAKIAkvKgpAQCAtNDYyLDEz
ICs0NTksMTMgQEAgc3RhdGljIHZvaWQgc2VtYXBob3JlX2NvZGVwZW5kZW5jeShpbnQgaTkxNSkK
IAkgKi8KIAogCWkgPSAwOwotCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShpOTE1LCBlbmdpbmUp
IHsKKwlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgaTkxNSkgewogCQl1aW50MzJfdCBjdHg7
CiAKLQkJaWYgKGVuZ2luZSA9PSBJOTE1X0VYRUNfUkVOREVSKQorCQlpZiAoZWJfcmluZyhlKSA9
PSBJOTE1X0VYRUNfUkVOREVSKQogCQkJY29udGludWU7CiAKLQkJaWYgKCFnZW1fY2FuX3N0b3Jl
X2R3b3JkKGk5MTUsIGVuZ2luZSkpCisJCWlmICghZ2VtX2Nhbl9zdG9yZV9kd29yZChpOTE1LCBl
Yl9yaW5nKGUpKSkKIAkJCWNvbnRpbnVlOwogCiAJCWN0eCA9IGdlbV9jb250ZXh0X2NyZWF0ZShp
OTE1KTsKQEAgLTQ3Niw3ICs0NzMsNyBAQCBzdGF0aWMgdm9pZCBzZW1hcGhvcmVfY29kZXBlbmRl
bmN5KGludCBpOTE1KQogCQl0YXNrW2ldLnhjcyA9CiAJCQlfX2lndF9zcGluX25ldyhpOTE1LAog
CQkJCSAgICAgICAuY3R4ID0gY3R4LAotCQkJCSAgICAgICAuZW5naW5lID0gZW5naW5lLAorCQkJ
CSAgICAgICAuZW5naW5lID0gZWJfcmluZyhlKSwKIAkJCQkgICAgICAgLmZsYWdzID0gSUdUX1NQ
SU5fUE9MTF9SVU4pOwogCQlpZ3Rfc3Bpbl9idXN5d2FpdF91bnRpbF9zdGFydGVkKHRhc2tbaV0u
eGNzKTsKIApAQCAtNTE0LDcgKzUxMSw2IEBAIHN0YXRpYyB2b2lkIHNlbWFwaG9yZV9yZXNvbHZl
KGludCBpOTE1KQogewogCWNvbnN0IHVpbnQzMl90IFNFTUFQSE9SRV9BRERSID0gNjQgPDwgMTA7
CiAJdWludDMyX3Qgc2VtYXBob3JlLCBvdXRlciwgaW5uZXIsICpzZW1hOwotCXVuc2lnbmVkIGlu
dCBlbmdpbmU7CiAKIAkvKgogCSAqIFVzZXJzcGFjZSBtYXkgc3VibWl0IGJhdGNoZXMgdGhhdCB3
YWl0IHVwb24gdW5yZXNvbHZlZApAQCAtNTM0LDcgKzUzMCw3IEBAIHN0YXRpYyB2b2lkIHNlbWFw
aG9yZV9yZXNvbHZlKGludCBpOTE1KQogCXNlbWFwaG9yZSA9IGdlbV9jcmVhdGUoaTkxNSwgNDA5
Nik7CiAJc2VtYSA9IGdlbV9tbWFwX193YyhpOTE1LCBzZW1hcGhvcmUsIDAsIDQwOTYsIFBST1Rf
V1JJVEUpOwogCi0JZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGk5MTUsIGVuZ2luZSkgeworCWZv
cl9lYWNoX3BoeXNpY2FsX2VuZ2luZShlLCBpOTE1KSB7CiAJCXN0cnVjdCBkcm1faTkxNV9nZW1f
ZXhlY19vYmplY3QyIG9ialszXTsKIAkJc3RydWN0IGRybV9pOTE1X2dlbV9leGVjYnVmZmVyMiBl
YjsKIAkJdWludDMyX3QgaGFuZGxlLCBjYW5jZWw7CkBAIC01NDIsMTAgKzUzOCwxMCBAQCBzdGF0
aWMgdm9pZCBzZW1hcGhvcmVfcmVzb2x2ZShpbnQgaTkxNSkKIAkJaWd0X3NwaW5fdCAqc3BpbjsK
IAkJaW50NjRfdCBwb2tlID0gMTsKIAotCQlpZiAoIWdlbV9jYW5fc3RvcmVfZHdvcmQoaTkxNSwg
ZW5naW5lKSkKKwkJaWYgKCFnZW1fY2FuX3N0b3JlX2R3b3JkKGk5MTUsIGViX3JpbmcoZSkpKQog
CQkJY29udGludWU7CiAKLQkJc3BpbiA9IF9faWd0X3NwaW5fbmV3KGk5MTUsIC5lbmdpbmUgPSBl
bmdpbmUpOworCQlzcGluID0gX19pZ3Rfc3Bpbl9uZXcoaTkxNSwgLmVuZ2luZSA9IGViX3Jpbmco
ZSkpOwogCQlpZ3Rfc3Bpbl9lbmQoc3Bpbik7IC8qIHdlIGp1c3Qgd2FudCBpdHMgYWRkcmVzcyBm
b3IgbGF0ZXIgKi8KIAkJZ2VtX3N5bmMoaTkxNSwgc3Bpbi0+aGFuZGxlKTsKIAkJaWd0X3NwaW5f
cmVzZXQoc3Bpbik7CkBAIC02NDIsMjYgKzYzOCwyNyBAQCBzdGF0aWMgdm9pZCBzZW1hcGhvcmVf
cmVzb2x2ZShpbnQgaTkxNSkKIHN0YXRpYyB2b2lkIHNlbWFwaG9yZV9ub3NraXAoaW50IGk5MTUp
CiB7CiAJY29uc3QgaW50IGdlbiA9IGludGVsX2dlbihpbnRlbF9nZXRfZHJtX2RldmlkKGk5MTUp
KTsKLQl1bnNpZ25lZCBpbnQgZW5naW5lLCBvdGhlcjsKKwl1bnNpZ25lZCBpbnQgb3RoZXI7CiAJ
dWludDMyX3QgY3R4OwogCiAJaWd0X3JlcXVpcmUoZ2VuID49IDYpOyAvKiBNSV9TVE9SRV9EV09S
RF9JTU0gY29udmVuaWVuY2UgKi8KIAogCWN0eCA9IGdlbV9jb250ZXh0X2NyZWF0ZShpOTE1KTsK
IAotCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShpOTE1LCBlbmdpbmUpIHsKLQlmb3JfZWFjaF9w
aHlzaWNhbF9lbmdpbmUoaTkxNSwgb3RoZXIpIHsKKwlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUo
b3V0ZXIsIGk5MTUpIHsKKwlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoaW5uZXIsIGk5MTUpIHsK
IAkJc3RydWN0IGRybV9pOTE1X2dlbV9leGVjX29iamVjdDIgb2JqWzNdOwogCQlzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX2V4ZWNidWZmZXIyIGViOwogCQl1aW50MzJfdCBoYW5kbGUsICpjcywgKm1hcDsK
IAkJaWd0X3NwaW5fdCAqY2hhaW4sICpzcGluOwogCi0JCWlmIChvdGhlciA9PSBlbmdpbmUgfHwg
IWdlbV9jYW5fc3RvcmVfZHdvcmQoaTkxNSwgb3RoZXIpKQorCQlpZiAoZWJfcmluZyhpbm5lcikg
PT0gZWJfcmluZyhvdXRlcikgfHwKKwkJICAgICFnZW1fY2FuX3N0b3JlX2R3b3JkKGk5MTUsIGVi
X3JpbmcoaW5uZXIpKSkKIAkJCWNvbnRpbnVlOwogCi0JCWNoYWluID0gX19pZ3Rfc3Bpbl9uZXco
aTkxNSwgLmVuZ2luZSA9IGVuZ2luZSk7CisJCWNoYWluID0gX19pZ3Rfc3Bpbl9uZXcoaTkxNSwg
LmVuZ2luZSA9IGViX3Jpbmcob3V0ZXIpKTsKIAotCQlzcGluID0gX19pZ3Rfc3Bpbl9uZXcoaTkx
NSwgLmVuZ2luZSA9IG90aGVyKTsKKwkJc3BpbiA9IF9faWd0X3NwaW5fbmV3KGk5MTUsIC5lbmdp
bmUgPSBlYl9yaW5nKGlubmVyKSk7CiAJCWlndF9zcGluX2VuZChzcGluKTsgLyogd2UganVzdCB3
YW50IGl0cyBhZGRyZXNzIGZvciBsYXRlciAqLwogCQlnZW1fc3luYyhpOTE1LCBzcGluLT5oYW5k
bGUpOwogCQlpZ3Rfc3Bpbl9yZXNldChzcGluKTsKQEAgLTg2NywyMSArODY0LDE5IEBAIHN0YXRp
YyB2b2lkIHByZWVtcHQoaW50IGZkLCB1bnNpZ25lZCByaW5nLCB1bnNpZ25lZCBmbGFncykKIAog
c3RhdGljIGlndF9zcGluX3QgKl9fbm9pc2UoaW50IGZkLCB1aW50MzJfdCBjdHgsIGludCBwcmlv
LCBpZ3Rfc3Bpbl90ICpzcGluKQogewotCXVuc2lnbmVkIG90aGVyOwotCiAJZ2VtX2NvbnRleHRf
c2V0X3ByaW9yaXR5KGZkLCBjdHgsIHByaW8pOwogCi0JZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5l
KGZkLCBvdGhlcikgeworCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShlLCBmZCkgewogCQlpZiAo
c3BpbiA9PSBOVUxMKSB7CiAJCQlzcGluID0gX19pZ3Rfc3Bpbl9uZXcoZmQsCiAJCQkJCSAgICAg
IC5jdHggPSBjdHgsCi0JCQkJCSAgICAgIC5lbmdpbmUgPSBvdGhlcik7CisJCQkJCSAgICAgIC5l
bmdpbmUgPSBlYl9yaW5nKGUpKTsKIAkJfSBlbHNlIHsKIAkJCXN0cnVjdCBkcm1faTkxNV9nZW1f
ZXhlY2J1ZmZlcjIgZWIgPSB7CiAJCQkJLmJ1ZmZlcl9jb3VudCA9IDEsCiAJCQkJLmJ1ZmZlcnNf
cHRyID0gdG9fdXNlcl9wb2ludGVyKCZzcGluLT5vYmpbSUdUX1NQSU5fQkFUQ0hdKSwKIAkJCQku
cnN2ZDEgPSBjdHgsCi0JCQkJLmZsYWdzID0gb3RoZXIsCisJCQkJLmZsYWdzID0gZWJfcmluZyhl
KSwKIAkJCX07CiAJCQlnZW1fZXhlY2J1ZihmZCwgJmViKTsKIAkJfQpAQCAtODk3LDcgKzg5Miw3
IEBAIHN0YXRpYyB2b2lkIF9fcHJlZW1wdF9vdGhlcihpbnQgZmQsCiB7CiAJdWludDMyX3QgcmVz
dWx0ID0gZ2VtX2NyZWF0ZShmZCwgNDA5Nik7CiAJdWludDMyX3QgcmVzdWx0X3JlYWRbNDA5NiAv
IHNpemVvZih1aW50MzJfdCldOwotCXVuc2lnbmVkIGludCBuLCBpLCBvdGhlcjsKKwl1bnNpZ25l
ZCBpbnQgbiwgaTsKIAogCW4gPSAwOwogCXN0b3JlX2R3b3JkKGZkLCBjdHhbTE9dLCBwcmltYXJ5
LApAQCAtOTA2LDggKzkwMSw4IEBAIHN0YXRpYyB2b2lkIF9fcHJlZW1wdF9vdGhlcihpbnQgZmQs
CiAJbisrOwogCiAJaWYgKGZsYWdzICYgQ0hBSU4pIHsKLQkJZm9yX2VhY2hfcGh5c2ljYWxfZW5n
aW5lKGZkLCBvdGhlcikgewotCQkJc3RvcmVfZHdvcmQoZmQsIGN0eFtMT10sIG90aGVyLAorCQlm
b3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQpIHsKKwkJCXN0b3JlX2R3b3JkKGZkLCBjdHhb
TE9dLCBlYl9yaW5nKGUpLAogCQkJCSAgICByZXN1bHQsIChuICsgMSkqc2l6ZW9mKHVpbnQzMl90
KSwgbiArIDEsCiAJCQkJICAgIEk5MTVfR0VNX0RPTUFJTl9SRU5ERVIpOwogCQkJbisrOwpAQCAt
OTMyLDcgKzkyNyw2IEBAIHN0YXRpYyB2b2lkIF9fcHJlZW1wdF9vdGhlcihpbnQgZmQsCiAKIHN0
YXRpYyB2b2lkIHByZWVtcHRfb3RoZXIoaW50IGZkLCB1bnNpZ25lZCByaW5nLCB1bnNpZ25lZCBp
bnQgZmxhZ3MpCiB7Ci0JdW5zaWduZWQgaW50IHByaW1hcnk7CiAJaWd0X3NwaW5fdCAqc3BpbiA9
IE5VTEw7CiAJdWludDMyX3QgY3R4WzNdOwogCkBAIC05NTUsOSArOTQ5LDkgQEAgc3RhdGljIHZv
aWQgcHJlZW1wdF9vdGhlcihpbnQgZmQsIHVuc2lnbmVkIHJpbmcsIHVuc2lnbmVkIGludCBmbGFn
cykKIAljdHhbSEldID0gZ2VtX2NvbnRleHRfY3JlYXRlKGZkKTsKIAlnZW1fY29udGV4dF9zZXRf
cHJpb3JpdHkoZmQsIGN0eFtISV0sIE1BWF9QUklPKTsKIAotCWZvcl9lYWNoX3BoeXNpY2FsX2Vu
Z2luZShmZCwgcHJpbWFyeSkgewotCQlpZ3RfZGVidWcoIlByaW1hcnkgZW5naW5lOiAlc1xuIiwg
ZV9fLT5uYW1lKTsKLQkJX19wcmVlbXB0X290aGVyKGZkLCBjdHgsIHJpbmcsIHByaW1hcnksIGZs
YWdzKTsKKwlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQpIHsKKwkJaWd0X2RlYnVnKCJQ
cmltYXJ5IGVuZ2luZTogJXNcbiIsIGUtPm5hbWUpOworCQlfX3ByZWVtcHRfb3RoZXIoZmQsIGN0
eCwgcmluZywgZWJfcmluZyhlKSwgZmxhZ3MpOwogCiAJfQogCkBAIC05NzYsMTMgKzk3MCwxMyBA
QCBzdGF0aWMgdm9pZCBfX3ByZWVtcHRfcXVldWUoaW50IGZkLAogCXVpbnQzMl90IHJlc3VsdCA9
IGdlbV9jcmVhdGUoZmQsIDQwOTYpOwogCXVpbnQzMl90IHJlc3VsdF9yZWFkWzQwOTYgLyBzaXpl
b2YodWludDMyX3QpXTsKIAlpZ3Rfc3Bpbl90ICphYm92ZSA9IE5VTEwsICpiZWxvdyA9IE5VTEw7
Ci0JdW5zaWduZWQgaW50IG90aGVyLCBuLCBpOwotCWludCBwcmlvID0gTUFYX1BSSU87CiAJdWlu
dDMyX3QgY3R4WzNdID0gewogCQlnZW1fY29udGV4dF9jcmVhdGUoZmQpLAogCQlnZW1fY29udGV4
dF9jcmVhdGUoZmQpLAogCQlnZW1fY29udGV4dF9jcmVhdGUoZmQpLAogCX07CisJaW50IHByaW8g
PSBNQVhfUFJJTzsKKwl1bnNpZ25lZCBpbnQgbiwgaTsKIAogCWZvciAobiA9IDA7IG4gPCBkZXB0
aDsgbisrKSB7CiAJCWlmIChmbGFncyAmIENPTlRFWFRTKSB7CkBAIC0xMDExLDggKzEwMDUsOCBA
QCBzdGF0aWMgdm9pZCBfX3ByZWVtcHRfcXVldWUoaW50IGZkLAogCW4rKzsKIAogCWlmIChmbGFn
cyAmIENIQUlOKSB7Ci0JCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShmZCwgb3RoZXIpIHsKLQkJ
CXN0b3JlX2R3b3JkKGZkLCBjdHhbTE9dLCBvdGhlciwKKwkJZm9yX2VhY2hfcGh5c2ljYWxfZW5n
aW5lKGUsIGZkKSB7CisJCQlzdG9yZV9kd29yZChmZCwgY3R4W0xPXSwgZWJfcmluZyhlKSwKIAkJ
CQkgICAgcmVzdWx0LCAobiArIDEpKnNpemVvZih1aW50MzJfdCksIG4gKyAxLAogCQkJCSAgICBJ
OTE1X0dFTV9ET01BSU5fUkVOREVSKTsKIAkJCW4rKzsKQEAgLTEwNTIsMTEgKzEwNDYsOSBAQCBz
dGF0aWMgdm9pZCBfX3ByZWVtcHRfcXVldWUoaW50IGZkLAogCiBzdGF0aWMgdm9pZCBwcmVlbXB0
X3F1ZXVlKGludCBmZCwgdW5zaWduZWQgcmluZywgdW5zaWduZWQgaW50IGZsYWdzKQogewotCXVu
c2lnbmVkIG90aGVyOwotCi0JZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGZkLCBvdGhlcikgewor
CWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShlLCBmZCkgewogCQlmb3IgKHVuc2lnbmVkIGRlcHRo
ID0gMDsgZGVwdGggPD0gTUFYX0VMU1BfUUxFTjsgZGVwdGgrKykKLQkJCV9fcHJlZW1wdF9xdWV1
ZShmZCwgcmluZywgb3RoZXIsIGRlcHRoLCBmbGFncyk7CisJCQlfX3ByZWVtcHRfcXVldWUoZmQs
IHJpbmcsIGViX3JpbmcoZSksIGRlcHRoLCBmbGFncyk7CiAJfQogfQogCkBAIC0xMDY1LDcgKzEw
NTcsNiBAQCBzdGF0aWMgdm9pZCBwcmVlbXB0X3NlbGYoaW50IGZkLCB1bnNpZ25lZCByaW5nKQog
CXVpbnQzMl90IHJlc3VsdCA9IGdlbV9jcmVhdGUoZmQsIDQwOTYpOwogCXVpbnQzMl90IHJlc3Vs
dF9yZWFkWzQwOTYgLyBzaXplb2YodWludDMyX3QpXTsKIAlpZ3Rfc3Bpbl90ICpzcGluW01BWF9F
TFNQX1FMRU5dOwotCXVuc2lnbmVkIGludCBvdGhlcjsKIAl1bnNpZ25lZCBpbnQgbiwgaTsKIAl1
aW50MzJfdCBjdHhbM107CiAKQEAgLTEwODMsMTEgKzEwNzQsMTEgQEAgc3RhdGljIHZvaWQgcHJl
ZW1wdF9zZWxmKGludCBmZCwgdW5zaWduZWQgcmluZykKIAogCW4gPSAwOwogCWdlbV9jb250ZXh0
X3NldF9wcmlvcml0eShmZCwgY3R4W0hJXSwgTUlOX1BSSU8pOwotCWZvcl9lYWNoX3BoeXNpY2Fs
X2VuZ2luZShmZCwgb3RoZXIpIHsKKwlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQpIHsK
IAkJc3BpbltuXSA9IF9faWd0X3NwaW5fbmV3KGZkLAogCQkJCQkgLmN0eCA9IGN0eFtOT0lTRV0s
Ci0JCQkJCSAuZW5naW5lID0gb3RoZXIpOwotCQlzdG9yZV9kd29yZChmZCwgY3R4W0hJXSwgb3Ro
ZXIsCisJCQkJCSAuZW5naW5lID0gZWJfcmluZyhlKSk7CisJCXN0b3JlX2R3b3JkKGZkLCBjdHhb
SEldLCBlYl9yaW5nKGUpLAogCQkJICAgIHJlc3VsdCwgKG4gKyAxKSpzaXplb2YodWludDMyX3Qp
LCBuICsgMSwKIAkJCSAgICBJOTE1X0dFTV9ET01BSU5fUkVOREVSKTsKIAkJbisrOwpAQCAtMTYw
OCwxMyArMTU5OSwxMiBAQCBzdGF0aWMgdm9pZCB0ZXN0X3BpX3JpbmdmdWxsKGludCBmZCwgdW5z
aWduZWQgaW50IGVuZ2luZSkKIAogc3RhdGljIHZvaWQgbWVhc3VyZV9zZW1hcGhvcmVfcG93ZXIo
aW50IGk5MTUpCiB7Ci0JdW5zaWduZWQgaW50IGVuZ2luZSwgc2lnbmFsZXI7CiAJc3RydWN0IHJh
cGwgZ3B1LCBwa2c7CiAKIAlpZ3RfcmVxdWlyZShncHVfcG93ZXJfb3BlbigmZ3B1KSA9PSAwKTsK
IAlwa2dfcG93ZXJfb3BlbigmcGtnKTsKIAotCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShpOTE1
LCBzaWduYWxlcikgeworCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShzaWduYWxlciwgaTkxNSkg
ewogCQlzdHJ1Y3QgewogCQkJc3RydWN0IHBvd2VyX3NhbXBsZSBwa2csIGdwdTsKIAkJfSBzX3Nw
aW5bMl0sIHNfc2VtYVsyXTsKQEAgLTE2MjMsNyArMTYxMyw3IEBAIHN0YXRpYyB2b2lkIG1lYXN1
cmVfc2VtYXBob3JlX3Bvd2VyKGludCBpOTE1KQogCQlpZ3Rfc3Bpbl90ICpzcGluOwogCiAJCXNw
aW4gPSBfX2lndF9zcGluX25ldyhpOTE1LAotCQkJCSAgICAgIC5lbmdpbmUgPSBzaWduYWxlciwK
KwkJCQkgICAgICAuZW5naW5lID0gZWJfcmluZyhzaWduYWxlciksCiAJCQkJICAgICAgLmZsYWdz
ID0gSUdUX1NQSU5fUE9MTF9SVU4pOwogCQlnZW1fd2FpdChpOTE1LCBzcGluLT5oYW5kbGUsICZq
aWZmaWUpOyAvKiB3YWl0Ym9vc3QgKi8KIAkJaWd0X3NwaW5fYnVzeXdhaXRfdW50aWxfc3RhcnRl
ZChzcGluKTsKQEAgLTE2MzUsMTQgKzE2MjUsMTQgQEAgc3RhdGljIHZvaWQgbWVhc3VyZV9zZW1h
cGhvcmVfcG93ZXIoaW50IGk5MTUpCiAJCXJhcGxfcmVhZCgmcGtnLCAmc19zcGluWzFdLnBrZyk7
CiAKIAkJLyogQWRkIGEgd2FpdGVyIHRvIGVhY2ggZW5naW5lICovCi0JCWZvcl9lYWNoX3BoeXNp
Y2FsX2VuZ2luZShpOTE1LCBlbmdpbmUpIHsKKwkJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGUs
IGk5MTUpIHsKIAkJCWlndF9zcGluX3QgKnNlbWE7CiAKLQkJCWlmIChlbmdpbmUgPT0gc2lnbmFs
ZXIpCisJCQlpZiAoZWJfcmluZyhlKSA9PSBlYl9yaW5nKHNpZ25hbGVyKSkKIAkJCQljb250aW51
ZTsKIAogCQkJc2VtYSA9IF9faWd0X3NwaW5fbmV3KGk5MTUsCi0JCQkJCSAgICAgIC5lbmdpbmUg
PSBlbmdpbmUsCisJCQkJCSAgICAgIC5lbmdpbmUgPSBlYl9yaW5nKGUpLAogCQkJCQkgICAgICAu
ZGVwZW5kZW5jeSA9IHNwaW4tPmhhbmRsZSk7CiAKIAkJCWlndF9zcGluX2ZyZWUoaTkxNSwgc2Vt
YSk7CkBAIC0xNjYwLDcgKzE2NTAsNyBAQCBzdGF0aWMgdm9pZCBtZWFzdXJlX3NlbWFwaG9yZV9w
b3dlcihpbnQgaTkxNSkKIAkJYmFzZWxpbmUgPSBwb3dlcl9XKCZncHUsICZzX3NwaW5bMF0uZ3B1
LCAmc19zcGluWzFdLmdwdSk7CiAJCXRvdGFsID0gcG93ZXJfVygmZ3B1LCAmc19zZW1hWzBdLmdw
dSwgJnNfc2VtYVsxXS5ncHUpOwogCQlpZ3RfaW5mbygiJXM6ICUuMWZtVyArICUuMWZtVyAodG90
YWwgJTEuZm1XKVxuIiwKLQkJCSBlX18tPm5hbWUsCisJCQkgc2lnbmFsZXItPm5hbWUsCiAJCQkg
MWUzICogYmFzZWxpbmUsCiAJCQkgMWUzICogKHRvdGFsIC0gYmFzZWxpbmUpLAogCQkJIDFlMyAq
IHRvdGFsKTsKQEAgLTE3MDcsMTUgKzE2OTcsMTUgQEAgaWd0X21haW4KIAkJCQljb250aW51ZTsK
IAogCQkJaWd0X3N1YnRlc3RfZigiZmlmby0lcyIsIGUtPm5hbWUpIHsKLQkJCQlpZ3RfcmVxdWly
ZShnZW1fcmluZ19oYXNfcGh5c2ljYWxfZW5naW5lKGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3Mp
KTsKLQkJCQlpZ3RfcmVxdWlyZShnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlLT5leGVjX2lkIHwg
ZS0+ZmxhZ3MpKTsKLQkJCQlmaWZvKGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MpOworCQkJCWln
dF9yZXF1aXJlKGdlbV9yaW5nX2hhc19waHlzaWNhbF9lbmdpbmUoZmQsIGViX3JpbmcoZSkpKTsK
KwkJCQlpZ3RfcmVxdWlyZShnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlYl9yaW5nKGUpKSk7CisJ
CQkJZmlmbyhmZCwgZWJfcmluZyhlKSk7CiAJCQl9CiAKIAkJCWlndF9zdWJ0ZXN0X2YoImluZGVw
ZW5kZW50LSVzIiwgZS0+bmFtZSkgewotCQkJCWlndF9yZXF1aXJlKGdlbV9yaW5nX2hhc19waHlz
aWNhbF9lbmdpbmUoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncykpOwotCQkJCWlndF9yZXF1aXJl
KGdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncykpOwotCQkJCWlu
ZGVwZW5kZW50KGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MpOworCQkJCWlndF9yZXF1aXJlKGdl
bV9yaW5nX2hhc19waHlzaWNhbF9lbmdpbmUoZmQsIGViX3JpbmcoZSkpKTsKKwkJCQlpZ3RfcmVx
dWlyZShnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlYl9yaW5nKGUpKSk7CisJCQkJaW5kZXBlbmRl
bnQoZmQsIGViX3JpbmcoZSkpOwogCQkJfQogCQl9CiAJfQpAQCAtMTc0NCwxOCArMTczNCwxOCBA
QCBpZ3RfbWFpbgogCiAJCQlpZ3Rfc3VidGVzdF9ncm91cCB7CiAJCQkJaWd0X2ZpeHR1cmUgewot
CQkJCQlpZ3RfcmVxdWlyZShnZW1fcmluZ19oYXNfcGh5c2ljYWxfZW5naW5lKGZkLCBlLT5leGVj
X2lkIHwgZS0+ZmxhZ3MpKTsKLQkJCQkJaWd0X3JlcXVpcmUoZ2VtX2Nhbl9zdG9yZV9kd29yZChm
ZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzKSk7CisJCQkJCWlndF9yZXF1aXJlKGdlbV9yaW5nX2hh
c19waHlzaWNhbF9lbmdpbmUoZmQsIGViX3JpbmcoZSkpKTsKKwkJCQkJaWd0X3JlcXVpcmUoZ2Vt
X2Nhbl9zdG9yZV9kd29yZChmZCwgZWJfcmluZyhlKSkpOwogCQkJCX0KIAogCQkJCWlndF9zdWJ0
ZXN0X2YoImluLW9yZGVyLSVzIiwgZS0+bmFtZSkKLQkJCQkJcmVvcmRlcihmZCwgZS0+ZXhlY19p
ZCB8IGUtPmZsYWdzLCBFUVVBTCk7CisJCQkJCXJlb3JkZXIoZmQsIGViX3JpbmcoZSksIEVRVUFM
KTsKIAogCQkJCWlndF9zdWJ0ZXN0X2YoIm91dC1vcmRlci0lcyIsIGUtPm5hbWUpCi0JCQkJCXJl
b3JkZXIoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgMCk7CisJCQkJCXJlb3JkZXIoZmQsIGVi
X3JpbmcoZSksIDApOwogCiAJCQkJaWd0X3N1YnRlc3RfZigicHJvbW90aW9uLSVzIiwgZS0+bmFt
ZSkKLQkJCQkJcHJvbW90aW9uKGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MpOworCQkJCQlwcm9t
b3Rpb24oZmQsIGViX3JpbmcoZSkpOwogCiAJCQkJaWd0X3N1YnRlc3RfZ3JvdXAgewogCQkJCQlp
Z3RfZml4dHVyZSB7CkBAIC0xNzYzLDMwICsxNzUzLDMwIEBAIGlndF9tYWluCiAJCQkJCX0KIAog
CQkJCQlpZ3Rfc3VidGVzdF9mKCJwcmVlbXB0LSVzIiwgZS0+bmFtZSkKLQkJCQkJCXByZWVtcHQo
ZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgMCk7CisJCQkJCQlwcmVlbXB0KGZkLCBlYl9yaW5n
KGUpLCAwKTsKIAogCQkJCQlpZ3Rfc3VidGVzdF9mKCJwcmVlbXB0LWNvbnRleHRzLSVzIiwgZS0+
bmFtZSkKLQkJCQkJCXByZWVtcHQoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgTkVXX0NUWCk7
CisJCQkJCQlwcmVlbXB0KGZkLCBlYl9yaW5nKGUpLCBORVdfQ1RYKTsKIAogCQkJCQlpZ3Rfc3Vi
dGVzdF9mKCJwcmVlbXB0LXNlbGYtJXMiLCBlLT5uYW1lKQotCQkJCQkJcHJlZW1wdF9zZWxmKGZk
LCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MpOworCQkJCQkJcHJlZW1wdF9zZWxmKGZkLCBlYl9yaW5n
KGUpKTsKIAogCQkJCQlpZ3Rfc3VidGVzdF9mKCJwcmVlbXB0LW90aGVyLSVzIiwgZS0+bmFtZSkK
LQkJCQkJCXByZWVtcHRfb3RoZXIoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgMCk7CisJCQkJ
CQlwcmVlbXB0X290aGVyKGZkLCBlYl9yaW5nKGUpLCAwKTsKIAogCQkJCQlpZ3Rfc3VidGVzdF9m
KCJwcmVlbXB0LW90aGVyLWNoYWluLSVzIiwgZS0+bmFtZSkKLQkJCQkJCXByZWVtcHRfb3RoZXIo
ZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgQ0hBSU4pOworCQkJCQkJcHJlZW1wdF9vdGhlcihm
ZCwgZWJfcmluZyhlKSwgQ0hBSU4pOwogCiAJCQkJCWlndF9zdWJ0ZXN0X2YoInByZWVtcHQtcXVl
dWUtJXMiLCBlLT5uYW1lKQotCQkJCQkJcHJlZW1wdF9xdWV1ZShmZCwgZS0+ZXhlY19pZCB8IGUt
PmZsYWdzLCAwKTsKKwkJCQkJCXByZWVtcHRfcXVldWUoZmQsIGViX3JpbmcoZSksIDApOwogCiAJ
CQkJCWlndF9zdWJ0ZXN0X2YoInByZWVtcHQtcXVldWUtY2hhaW4tJXMiLCBlLT5uYW1lKQotCQkJ
CQkJcHJlZW1wdF9xdWV1ZShmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCBDSEFJTik7CisJCQkJ
CQlwcmVlbXB0X3F1ZXVlKGZkLCBlYl9yaW5nKGUpLCBDSEFJTik7CiAJCQkJCWlndF9zdWJ0ZXN0
X2YoInByZWVtcHQtcXVldWUtY29udGV4dHMtJXMiLCBlLT5uYW1lKQotCQkJCQkJcHJlZW1wdF9x
dWV1ZShmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCBDT05URVhUUyk7CisJCQkJCQlwcmVlbXB0
X3F1ZXVlKGZkLCBlYl9yaW5nKGUpLCBDT05URVhUUyk7CiAKIAkJCQkJaWd0X3N1YnRlc3RfZigi
cHJlZW1wdC1xdWV1ZS1jb250ZXh0cy1jaGFpbi0lcyIsIGUtPm5hbWUpCi0JCQkJCQlwcmVlbXB0
X3F1ZXVlKGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIENPTlRFWFRTIHwgQ0hBSU4pOworCQkJ
CQkJcHJlZW1wdF9xdWV1ZShmZCwgZWJfcmluZyhlKSwgQ09OVEVYVFMgfCBDSEFJTik7CiAKIAkJ
CQkJaWd0X3N1YnRlc3RfZ3JvdXAgewogCQkJCQkJaWd0X2hhbmdfdCBoYW5nOwpAQCAtMTc5Nywx
MSArMTc4NywxMSBAQCBpZ3RfbWFpbgogCQkJCQkJfQogCiAJCQkJCQlpZ3Rfc3VidGVzdF9mKCJw
cmVlbXB0LWhhbmctJXMiLCBlLT5uYW1lKSB7Ci0JCQkJCQkJcHJlZW1wdChmZCwgZS0+ZXhlY19p
ZCB8IGUtPmZsYWdzLCBORVdfQ1RYIHwgSEFOR19MUCk7CisJCQkJCQkJcHJlZW1wdChmZCwgZWJf
cmluZyhlKSwgTkVXX0NUWCB8IEhBTkdfTFApOwogCQkJCQkJfQogCiAJCQkJCQlpZ3Rfc3VidGVz
dF9mKCJwcmVlbXB0aXZlLWhhbmctJXMiLCBlLT5uYW1lKQotCQkJCQkJCXByZWVtcHRpdmVfaGFu
ZyhmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzKTsKKwkJCQkJCQlwcmVlbXB0aXZlX2hhbmcoZmQs
IGViX3JpbmcoZSkpOwogCiAJCQkJCQlpZ3RfZml4dHVyZSB7CiAJCQkJCQkJaWd0X2Rpc2FsbG93
X2hhbmcoZmQsIGhhbmcpOwpAQCAtMTgxMSwxNiArMTgwMSwxNiBAQCBpZ3RfbWFpbgogCQkJCX0K
IAogCQkJCWlndF9zdWJ0ZXN0X2YoImRlZXAtJXMiLCBlLT5uYW1lKQotCQkJCQlkZWVwKGZkLCBl
LT5leGVjX2lkIHwgZS0+ZmxhZ3MpOworCQkJCQlkZWVwKGZkLCBlYl9yaW5nKGUpKTsKIAogCQkJ
CWlndF9zdWJ0ZXN0X2YoIndpZGUtJXMiLCBlLT5uYW1lKQotCQkJCQl3aWRlKGZkLCBlLT5leGVj
X2lkIHwgZS0+ZmxhZ3MpOworCQkJCQl3aWRlKGZkLCBlYl9yaW5nKGUpKTsKIAogCQkJCWlndF9z
dWJ0ZXN0X2YoInJlb3JkZXItd2lkZS0lcyIsIGUtPm5hbWUpCi0JCQkJCXJlb3JkZXJfd2lkZShm
ZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzKTsKKwkJCQkJcmVvcmRlcl93aWRlKGZkLCBlYl9yaW5n
KGUpKTsKIAogCQkJCWlndF9zdWJ0ZXN0X2YoInNtb2tldGVzdC0lcyIsIGUtPm5hbWUpCi0JCQkJ
CXNtb2tldGVzdChmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCA1KTsKKwkJCQkJc21va2V0ZXN0
KGZkLCBlYl9yaW5nKGUpLCA1KTsKIAkJCX0KIAkJfQogCX0KQEAgLTE4MzcsMTIgKzE4MjcsMTIg
QEAgaWd0X21haW4KIAogCQkJaWd0X3N1YnRlc3RfZ3JvdXAgewogCQkJCWlndF9maXh0dXJlIHsK
LQkJCQkJaWd0X3JlcXVpcmUoZ2VtX3JpbmdfaGFzX3BoeXNpY2FsX2VuZ2luZShmZCwgZS0+ZXhl
Y19pZCB8IGUtPmZsYWdzKSk7CisJCQkJCWlndF9yZXF1aXJlKGdlbV9yaW5nX2hhc19waHlzaWNh
bF9lbmdpbmUoZmQsIGViX3JpbmcoZSkpKTsKIAkJCQkJaWd0X3JlcXVpcmUoZ2VtX3NjaGVkdWxl
cl9oYXNfcHJlZW1wdGlvbihmZCkpOwogCQkJCX0KIAogCQkJCWlndF9zdWJ0ZXN0X2YoInBpLXJp
bmdmdWxsLSVzIiwgZS0+bmFtZSkKLQkJCQkJdGVzdF9waV9yaW5nZnVsbChmZCwgZS0+ZXhlY19p
ZCB8IGUtPmZsYWdzKTsKKwkJCQkJdGVzdF9waV9yaW5nZnVsbChmZCwgZWJfcmluZyhlKSk7CiAJ
CQl9CiAJCX0KIAl9CmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1L2dlbV9leGVjX3N1c3BlbmQuYyBi
L3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfc3VzcGVuZC5jCmluZGV4IGU0M2ExNmU5ZS4uNTYxYTEwYTRi
IDEwMDY0NAotLS0gYS90ZXN0cy9pOTE1L2dlbV9leGVjX3N1c3BlbmQuYworKysgYi90ZXN0cy9p
OTE1L2dlbV9leGVjX3N1c3BlbmQuYwpAQCAtNjQsMTEgKzY0LDkgQEAgc3RhdGljIHZvaWQgY2hl
Y2tfYm8oaW50IGZkLCB1aW50MzJfdCBoYW5kbGUpCiAKIHN0YXRpYyB2b2lkIHRlc3RfYWxsKGlu
dCBmZCwgdW5zaWduZWQgZmxhZ3MpCiB7Ci0JdW5zaWduZWQgZW5naW5lOwotCi0JZm9yX2VhY2hf
cGh5c2ljYWxfZW5naW5lKGZkLCBlbmdpbmUpCi0JCWlmIChnZW1fY2FuX3N0b3JlX2R3b3JkKGZk
LCBlbmdpbmUpKQotCQkJcnVuX3Rlc3QoZmQsIGVuZ2luZSwgZmxhZ3MgJiB+MHhmZik7CisJZm9y
X2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGZkKQorCQlpZiAoZ2VtX2Nhbl9zdG9yZV9kd29yZChm
ZCwgZWJfcmluZyhlKSkpCisJCQlydW5fdGVzdChmZCwgZWJfcmluZyhlKSwgZmxhZ3MgJiB+MHhm
Zik7CiB9CiAKIHN0YXRpYyBib29sIGhhc19zZW1hcGhvcmVzKGludCBmZCkKQEAgLTEwNiw5ICsx
MDQsOSBAQCBzdGF0aWMgdm9pZCBydW5fdGVzdChpbnQgZmQsIHVuc2lnbmVkIGVuZ2luZSwgdW5z
aWduZWQgZmxhZ3MpCiAJCSAqIEdQVSBpcyB0aGVuIHVubGlrZWx5IHRvIGJlIGFjdGl2ZSEpCiAJ
CSAqLwogCQlpZiAoaGFzX3NlbWFwaG9yZXMoZmQpKSB7Ci0JCQlmb3JfZWFjaF9waHlzaWNhbF9l
bmdpbmUoZmQsIGVuZ2luZSkgewotCQkJCWlmIChnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlbmdp
bmUpKQotCQkJCQllbmdpbmVzW25lbmdpbmUrK10gPSBlbmdpbmU7CisJCQlmb3JfZWFjaF9waHlz
aWNhbF9lbmdpbmUoZSwgZmQpIHsKKwkJCQlpZiAoZ2VtX2Nhbl9zdG9yZV9kd29yZChmZCwgZWJf
cmluZyhlKSkpCisJCQkJCWVuZ2luZXNbbmVuZ2luZSsrXSA9IGViX3JpbmcoZSk7CiAJCQl9CiAJ
CX0gZWxzZSB7CiAJCQlpZ3RfcmVxdWlyZShnZW1faGFzX3JpbmcoZmQsIDApKTsKQEAgLTI2Nywx
MSArMjY1LDkgQEAgaWd0X21haW4KIAlmb3IgKGUgPSBpbnRlbF9leGVjdXRpb25fZW5naW5lczsg
ZS0+bmFtZTsgZSsrKSB7CiAJCWZvciAobSA9IG1vZGVzOyBtLT5zdWZmaXg7IG0rKykgewogCQkJ
aWd0X3N1YnRlc3RfZigiJXMtdW5jYWNoZWQlcyIsIGUtPm5hbWUsIG0tPnN1ZmZpeCkKLQkJCQly
dW5fdGVzdChmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLAotCQkJCQkgbS0+bW9kZSB8IFVOQ0FD
SEVEKTsKKwkJCQlydW5fdGVzdChmZCwgZWJfcmluZyhlKSwgbS0+bW9kZSB8IFVOQ0FDSEVEKTsK
IAkJCWlndF9zdWJ0ZXN0X2YoIiVzLWNhY2hlZCVzIiwgZS0+bmFtZSwgbS0+c3VmZml4KQotCQkJ
CXJ1bl90ZXN0KGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsCi0JCQkJCSBtLT5tb2RlIHwgQ0FD
SEVEKTsKKwkJCQlydW5fdGVzdChmZCwgZWJfcmluZyhlKSwgbS0+bW9kZSB8IENBQ0hFRCk7CiAJ
CX0KIAl9CiAKZGlmZiAtLWdpdCBhL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfd2hpc3Blci5jIGIvdGVz
dHMvaTkxNS9nZW1fZXhlY193aGlzcGVyLmMKaW5kZXggMTEzNWM2NDk3Li5hMzM4NDc2MDggMTAw
NjQ0Ci0tLSBhL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfd2hpc3Blci5jCisrKyBiL3Rlc3RzL2k5MTUv
Z2VtX2V4ZWNfd2hpc3Blci5jCkBAIC0yMDMsOSArMjAzLDkgQEAgc3RhdGljIHZvaWQgd2hpc3Bl
cihpbnQgZmQsIHVuc2lnbmVkIGVuZ2luZSwgdW5zaWduZWQgZmxhZ3MpCiAKIAluZW5naW5lID0g
MDsKIAlpZiAoZW5naW5lID09IEFMTF9FTkdJTkVTKSB7Ci0JCWZvcl9lYWNoX3BoeXNpY2FsX2Vu
Z2luZShmZCwgZW5naW5lKSB7Ci0JCQlpZiAoZ2VtX2Nhbl9zdG9yZV9kd29yZChmZCwgZW5naW5l
KSkKLQkJCQllbmdpbmVzW25lbmdpbmUrK10gPSBlbmdpbmU7CisJCWZvcl9lYWNoX3BoeXNpY2Fs
X2VuZ2luZShlLCBmZCkgeworCQkJaWYgKGdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGViX3Jpbmco
ZSkpKQorCQkJCWVuZ2luZXNbbmVuZ2luZSsrXSA9IGViX3JpbmcoZSk7CiAJCX0KIAl9IGVsc2Ug
ewogCQlpZ3RfYXNzZXJ0KCEoZmxhZ3MgJiBBTEwpKTsKQEAgLTU3OCw3ICs1NzgsNyBAQCBpZ3Rf
bWFpbgogCQkJCWNvbnRpbnVlOwogCiAJCQlpZ3Rfc3VidGVzdF9mKCIlcy0lcyIsIGUtPm5hbWUs
IG0tPm5hbWUpCi0JCQkJd2hpc3BlcihmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCBtLT5mbGFn
cyk7CisJCQkJd2hpc3BlcihmZCwgZWJfcmluZyhlKSwgbS0+ZmxhZ3MpOwogCQl9CiAJfQogCmRp
ZmYgLS1naXQgYS90ZXN0cy9pOTE1L2dlbV9tb2NzX3NldHRpbmdzLmMgYi90ZXN0cy9pOTE1L2dl
bV9tb2NzX3NldHRpbmdzLmMKaW5kZXggM2FkOTQxNDkxLi5mYzJjY2IyMTYgMTAwNjQ0Ci0tLSBh
L3Rlc3RzL2k5MTUvZ2VtX21vY3Nfc2V0dGluZ3MuYworKysgYi90ZXN0cy9pOTE1L2dlbV9tb2Nz
X3NldHRpbmdzLmMKQEAgLTYwNSw3ICs2MDUsNyBAQCBpZ3RfbWFpbgogCQkJCQkJaWYgKGZsYWdz
ICYgKE1PQ1NfTk9OX0RFRkFVTFRfQ1RYIHwgTU9DU19ESVJUWV9WQUxVRVMpKQogCQkJCQkJCWdl
bV9yZXF1aXJlX2NvbnRleHRzKGZkKTsKIAotCQkJCQkJcnVuX3Rlc3QoZmQsIGUtPmV4ZWNfaWQg
fCBlLT5mbGFncywgZmxhZ3MsIG1vZGUpOworCQkJCQkJcnVuX3Rlc3QoZmQsIGViX3JpbmcoZSks
IGZsYWdzLCBtb2RlKTsKIAkJCQkJfQogCQkJCX0KIApAQCAtNjE3LDEwICs2MTcsMTAgQEAgaWd0
X21haW4KIAkJfQogCiAJCWlndF9zdWJ0ZXN0X2YoIm1vY3MtaXNvbGF0aW9uLSVzIiwgZS0+bmFt
ZSkgewotCQkJZ2VtX3JlcXVpcmVfcmluZyhmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzKTsKKwkJ
CWdlbV9yZXF1aXJlX3JpbmcoZmQsIGViX3JpbmcoZSkpOwogCQkJZ2VtX3JlcXVpcmVfY29udGV4
dHMoZmQpOwogCi0JCQlpc29sYXRpb25fdGVzdChmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzKTsK
KwkJCWlzb2xhdGlvbl90ZXN0KGZkLCBlYl9yaW5nKGUpKTsKIAkJfQogCX0KIApkaWZmIC0tZ2l0
IGEvdGVzdHMvaTkxNS9nZW1fcmVzZXRfc3RhdHMuYyBiL3Rlc3RzL2k5MTUvZ2VtX3Jlc2V0X3N0
YXRzLmMKaW5kZXggYWM5YWYyM2YyLi4wOTMxNjQxYTcgMTAwNjQ0Ci0tLSBhL3Rlc3RzL2k5MTUv
Z2VtX3Jlc2V0X3N0YXRzLmMKKysrIGIvdGVzdHMvaTkxNS9nZW1fcmVzZXRfc3RhdHMuYwpAQCAt
ODgsNyArODgsNyBAQCBzdGF0aWMgaW50IG5vb3AoaW50IGZkLCB1aW50MzJfdCBjdHgsIGNvbnN0
IHN0cnVjdCBpbnRlbF9leGVjdXRpb25fZW5naW5lICplKQogCW1lbXNldCgmZWIsIDAsIHNpemVv
ZihlYikpOwogCWViLmJ1ZmZlcnNfcHRyID0gdG9fdXNlcl9wb2ludGVyKCZleGVjKTsKIAllYi5i
dWZmZXJfY291bnQgPSAxOwotCWViLmZsYWdzID0gZS0+ZXhlY19pZCB8IGUtPmZsYWdzOworCWVi
LmZsYWdzID0gZWJfcmluZyhlKTsKIAlpOTE1X2V4ZWNidWZmZXIyX3NldF9jb250ZXh0X2lkKGVi
LCBjdHgpOwogCiAJcmV0ID0gX19nZW1fZXhlY2J1ZihmZCwgJmViKTsKQEAgLTE2NCw3ICsxNjQs
NyBAQCBzdGF0aWMgdm9pZCBpbmplY3RfaGFuZyhpbnQgZmQsIHVpbnQzMl90IGN0eCwKIAogCWNs
b2NrX2dldHRpbWUoQ0xPQ0tfTU9OT1RPTklDLCAmdHNfaW5qZWN0ZWQpOwogCi0JaGFuZyA9IGln
dF9oYW5nX2N0eChmZCwgY3R4LCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIGZsYWdzICYgQkFOKTsK
KwloYW5nID0gaWd0X2hhbmdfY3R4KGZkLCBjdHgsIGViX3JpbmcoZSksIGZsYWdzICYgQkFOKTsK
IAlpZiAoKGZsYWdzICYgQVNZTkMpID09IDApCiAJCWlndF9wb3N0X2hhbmdfcmluZyhmZCwgaGFu
Zyk7CiB9CkBAIC01MjMsMTIgKzUyMywxMiBAQCBzdGF0aWMgdm9pZCBub29wX29uX2VhY2hfcmlu
ZyhpbnQgZmQsIGNvbnN0IGJvb2wgcmV2ZXJzZSkKIAkJZm9yIChlID0gaW50ZWxfZXhlY3V0aW9u
X2VuZ2luZXM7IGUtPm5hbWU7IGUrKykKIAkJCTsKIAkJd2hpbGUgKC0tZSA+PSBpbnRlbF9leGVj
dXRpb25fZW5naW5lcykgewotCQkJZWIuZmxhZ3MgPSBlLT5leGVjX2lkIHwgZS0+ZmxhZ3M7CisJ
CQllYi5mbGFncyA9IGViX3JpbmcoZSk7CiAJCQlfX2dlbV9leGVjYnVmKGZkLCAmZWIpOwogCQl9
CiAJfSBlbHNlIHsKIAkJZm9yIChlID0gaW50ZWxfZXhlY3V0aW9uX2VuZ2luZXM7IGUtPm5hbWU7
IGUrKykgewotCQkJZWIuZmxhZ3MgPSBlLT5leGVjX2lkIHwgZS0+ZmxhZ3M7CisJCQllYi5mbGFn
cyA9IGViX3JpbmcoZSk7CiAJCQlfX2dlbV9leGVjYnVmKGZkLCAmZWIpOwogCQl9CiAJfQpAQCAt
NTQ2LDcgKzU0Niw3IEBAIHN0YXRpYyB2b2lkIHRlc3RfY2xvc2VfcGVuZGluZ19mb3JrKGNvbnN0
IHN0cnVjdCBpbnRlbF9leGVjdXRpb25fZW5naW5lICplLAogCiAJYXNzZXJ0X3Jlc2V0X3N0YXR1
cyhmZCwgZmQsIDAsIFJTX05PX0VSUk9SKTsKIAotCWhhbmcgPSBpZ3RfaGFuZ19jdHgoZmQsIDAs
IGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgMCk7CisJaGFuZyA9IGlndF9oYW5nX2N0eChmZCwgMCwg
ZWJfcmluZyhlKSwgMCk7CiAJc2xlZXAoMSk7CiAKIAkvKiBBdm9pZCBoZWxwZXJzIGFzIHdlIG5l
ZWQgdG8ga2lsbCB0aGUgY2hpbGQKZGlmZiAtLWdpdCBhL3Rlc3RzL2k5MTUvZ2VtX3Jpbmdfc3lu
Y19sb29wLmMgYi90ZXN0cy9pOTE1L2dlbV9yaW5nX3N5bmNfbG9vcC5jCmluZGV4IDExOGYzNjM4
YS4uMzJiOTM2MzczIDEwMDY0NAotLS0gYS90ZXN0cy9pOTE1L2dlbV9yaW5nX3N5bmNfbG9vcC5j
CisrKyBiL3Rlc3RzL2k5MTUvZ2VtX3Jpbmdfc3luY19sb29wLmMKQEAgLTQ0LDEyICs0NCwxMSBA
QCBzeW5jX2xvb3AoaW50IGZkKQogCXN0cnVjdCBkcm1faTkxNV9nZW1fcmVsb2NhdGlvbl9lbnRy
eSByZWxvY1sxXTsKIAl1bnNpZ25lZCBlbmdpbmVzWzE2XTsKIAl1bnNpZ25lZCBuZW5naW5lOwot
CXVuc2lnbmVkIGVuZ2luZTsKIAlpbnQgaTsKIAogCW5lbmdpbmUgPSAwOwotCWZvcl9lYWNoX3Bo
eXNpY2FsX2VuZ2luZShmZCwgZW5naW5lKQotCQllbmdpbmVzW25lbmdpbmUrK10gPSBlbmdpbmU7
CisJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGZkKQorCQllbmdpbmVzW25lbmdpbmUrK10g
PSBlYl9yaW5nKGUpOwogCWlndF9yZXF1aXJlKG5lbmdpbmUpOwogCiAJbWVtc2V0KG9iamVjdCwg
MCwgc2l6ZW9mKG9iamVjdCkpOwpkaWZmIC0tZ2l0IGEvdGVzdHMvaTkxNS9nZW1fcmluZ2ZpbGwu
YyBiL3Rlc3RzL2k5MTUvZ2VtX3JpbmdmaWxsLmMKaW5kZXggYzcyOGUxY2QzLi5hZjY2ZDAwMTIg
MTAwNjQ0Ci0tLSBhL3Rlc3RzL2k5MTUvZ2VtX3JpbmdmaWxsLmMKKysrIGIvdGVzdHMvaTkxNS9n
ZW1fcmluZ2ZpbGwuYwpAQCAtMjg4LDggKzI4OCw3IEBAIGlndF9tYWluCiAJCQkJaWd0X3NraXBf
b24obS0+ZmxhZ3MgJiBORVdGRCAmJiBtYXN0ZXIpOwogCQkJCWlmIChtLT5mbGFncyAmIChIQU5H
fFNVU1BFTkR8SElCRVJOQVRFKSkKIAkJCQkJaWd0X3NraXBfb25fc2ltdWxhdGlvbigpOwotCQkJ
CXJ1bl90ZXN0KGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsCi0JCQkJCSBtLT5mbGFncywgbS0+
dGltZW91dCk7CisJCQkJcnVuX3Rlc3QoZmQsIGViX3JpbmcoZSksIG0tPmZsYWdzLCBtLT50aW1l
b3V0KTsKIAkJCX0KIAkJfQogCX0KZGlmZiAtLWdpdCBhL3Rlc3RzL2k5MTUvZ2VtX3Nocmluay5j
IGIvdGVzdHMvaTkxNS9nZW1fc2hyaW5rLmMKaW5kZXggM2RiNzU0ZjU1Li5kMmVhMmVkODQgMTAw
NjQ0Ci0tLSBhL3Rlc3RzL2k5MTUvZ2VtX3Nocmluay5jCisrKyBiL3Rlc3RzL2k5MTUvZ2VtX3No
cmluay5jCkBAIC00MjgsNyArNDI4LDYgQEAgaWd0X21haW4KIAogCWlndF9maXh0dXJlIHsKIAkJ
dWludDY0X3QgbWVtX3NpemUgPSBpbnRlbF9nZXRfdG90YWxfcmFtX21iKCk7Ci0JCXVuc2lnbmVk
IGludCBlbmdpbmU7CiAJCWludCBmZDsKIAogCQlmZCA9IGRybV9vcGVuX2RyaXZlcihEUklWRVJf
SU5URUwpOwpAQCAtNDUxLDggKzQ1MCw4IEBAIGlndF9tYWluCiAJCQkJICAgICBDSEVDS19TV0FQ
IHwgQ0hFQ0tfUkFNKTsKIAogCQluZW5naW5lID0gMDsKLQkJZm9yX2VhY2hfZW5naW5lKGZkLCBl
bmdpbmUpCi0JCQllbmdpbmVzW25lbmdpbmUrK10gPSBlbmdpbmU7CisJCWZvcl9lYWNoX2VuZ2lu
ZShlLCBmZCkKKwkJCWVuZ2luZXNbbmVuZ2luZSsrXSA9IGViX3JpbmcoZSk7CiAJCWlndF9yZXF1
aXJlKG5lbmdpbmUpOwogCiAJCWNsb3NlKGZkKTsKZGlmZiAtLWdpdCBhL3Rlc3RzL2k5MTUvZ2Vt
X3NwaW5fYmF0Y2guYyBiL3Rlc3RzL2k5MTUvZ2VtX3NwaW5fYmF0Y2guYwppbmRleCBlMDYyM2Y0
YzkuLmRmNTk1MTJhNSAxMDA2NDQKLS0tIGEvdGVzdHMvaTkxNS9nZW1fc3Bpbl9iYXRjaC5jCisr
KyBiL3Rlc3RzL2k5MTUvZ2VtX3NwaW5fYmF0Y2guYwpAQCAtMTUyLDcgKzE1Miw3IEBAIGlndF9t
YWluCiAJfQogCiAJZm9yIChlID0gaW50ZWxfZXhlY3V0aW9uX2VuZ2luZXM7IGUtPm5hbWU7IGUr
KykgewotCQllMl9fID0gZ2VtX2ViX2ZsYWdzX3RvX2VuZ2luZShlLT5leGVjX2lkIHwgZS0+Zmxh
Z3MpOworCQllMl9fID0gZ2VtX2ViX2ZsYWdzX3RvX2VuZ2luZShlYl9yaW5nKGUpKTsKIAkJaWYg
KGUyX18uZmxhZ3MgPT0gLTEpCiAJCQljb250aW51ZTsKIAkJZTIgPSAmZTJfXzsKZGlmZiAtLWdp
dCBhL3Rlc3RzL2k5MTUvZ2VtX3N0b3JlZHdfbG9vcC5jIGIvdGVzdHMvaTkxNS9nZW1fc3RvcmVk
d19sb29wLmMKaW5kZXggYjAwNTU1ZTBjLi5iYmQ2NDA0MzEgMTAwNjQ0Ci0tLSBhL3Rlc3RzL2k5
MTUvZ2VtX3N0b3JlZHdfbG9vcC5jCisrKyBiL3Rlc3RzL2k5MTUvZ2VtX3N0b3JlZHdfbG9vcC5j
CkBAIC0xODYsNyArMTg2LDcgQEAgaWd0X21haW4KIAlmb3IgKGUgPSBpbnRlbF9leGVjdXRpb25f
ZW5naW5lczsgZS0+bmFtZTsgZSsrKSB7CiAJCWlndF9zdWJ0ZXN0X2YoInN0b3JlLSVzIiwgZS0+
bmFtZSkgewogCQkJY2hlY2tfdGVzdF9yZXF1aXJlbWVudHMoZmQsIGUtPmV4ZWNfaWQpOwotCQkJ
c3RvcmVfdGVzdChmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzKTsKKwkJCXN0b3JlX3Rlc3QoZmQs
IGViX3JpbmcoZSkpOwogCQl9CiAJfQogCmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1L2dlbV9zeW5j
LmMgYi90ZXN0cy9pOTE1L2dlbV9zeW5jLmMKaW5kZXggOGM1YWFhMTQ0Li45ZmZjYTQxNTUgMTAw
NjQ0Ci0tLSBhL3Rlc3RzL2k5MTUvZ2VtX3N5bmMuYworKysgYi90ZXN0cy9pOTE1L2dlbV9zeW5j
LmMKQEAgLTg2LDkgKzg2LDkgQEAgc3luY19yaW5nKGludCBmZCwgdW5zaWduZWQgcmluZywgaW50
IG51bV9jaGlsZHJlbiwgaW50IHRpbWVvdXQpCiAJaW50IG51bV9lbmdpbmVzID0gMDsKIAogCWlm
IChyaW5nID09IEFMTF9FTkdJTkVTKSB7Ci0JCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShmZCwg
cmluZykgewotCQkJbmFtZXNbbnVtX2VuZ2luZXNdID0gZV9fLT5uYW1lOwotCQkJZW5naW5lc1tu
dW1fZW5naW5lcysrXSA9IHJpbmc7CisJCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShlLCBmZCkg
eworCQkJbmFtZXNbbnVtX2VuZ2luZXNdID0gZS0+bmFtZTsKKwkJCWVuZ2luZXNbbnVtX2VuZ2lu
ZXMrK10gPSBlYl9yaW5nKGUpOwogCQkJaWYgKG51bV9lbmdpbmVzID09IEFSUkFZX1NJWkUoZW5n
aW5lcykpCiAJCQkJYnJlYWs7CiAJCX0KQEAgLTE4NSwxMiArMTg1LDEyIEBAIHdha2V1cF9yaW5n
KGludCBmZCwgdW5zaWduZWQgcmluZywgaW50IHRpbWVvdXQsIGludCB3bGVuKQogCWludCBudW1f
ZW5naW5lcyA9IDA7CiAKIAlpZiAocmluZyA9PSBBTExfRU5HSU5FUykgewotCQlmb3JfZWFjaF9w
aHlzaWNhbF9lbmdpbmUoZmQsIHJpbmcpIHsKLQkJCWlmICghZ2VtX2Nhbl9zdG9yZV9kd29yZChm
ZCwgcmluZykpCisJCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShlLCBmZCkgeworCQkJaWYgKCFn
ZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlYl9yaW5nKGUpKSkKIAkJCQljb250aW51ZTsKIAotCQkJ
bmFtZXNbbnVtX2VuZ2luZXNdID0gZV9fLT5uYW1lOwotCQkJZW5naW5lc1tudW1fZW5naW5lcysr
XSA9IHJpbmc7CisJCQluYW1lc1tudW1fZW5naW5lc10gPSBlLT5uYW1lOworCQkJZW5naW5lc1tu
dW1fZW5naW5lcysrXSA9IGViX3JpbmcoZSk7CiAJCQlpZiAobnVtX2VuZ2luZXMgPT0gQVJSQVlf
U0laRShlbmdpbmVzKSkKIAkJCQlicmVhazsKIAkJfQpAQCAtMjk3LDEyICsyOTcsMTIgQEAgc3Rh
dGljIHZvaWQgYWN0aXZlX3JpbmcoaW50IGZkLCB1bnNpZ25lZCByaW5nLCBpbnQgdGltZW91dCkK
IAlpbnQgbnVtX2VuZ2luZXMgPSAwOwogCiAJaWYgKHJpbmcgPT0gQUxMX0VOR0lORVMpIHsKLQkJ
Zm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGZkLCByaW5nKSB7Ci0JCQlpZiAoIWdlbV9jYW5fc3Rv
cmVfZHdvcmQoZmQsIHJpbmcpKQorCQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQpIHsK
KwkJCWlmICghZ2VtX2Nhbl9zdG9yZV9kd29yZChmZCwgZWJfcmluZyhlKSkpCiAJCQkJY29udGlu
dWU7CiAKLQkJCW5hbWVzW251bV9lbmdpbmVzXSA9IGVfXy0+bmFtZTsKLQkJCWVuZ2luZXNbbnVt
X2VuZ2luZXMrK10gPSByaW5nOworCQkJbmFtZXNbbnVtX2VuZ2luZXNdID0gZS0+bmFtZTsKKwkJ
CWVuZ2luZXNbbnVtX2VuZ2luZXMrK10gPSBlYl9yaW5nKGUpOwogCQkJaWYgKG51bV9lbmdpbmVz
ID09IEFSUkFZX1NJWkUoZW5naW5lcykpCiAJCQkJYnJlYWs7CiAJCX0KQEAgLTM2NCwxMiArMzY0
LDEyIEBAIGFjdGl2ZV93YWtldXBfcmluZyhpbnQgZmQsIHVuc2lnbmVkIHJpbmcsIGludCB0aW1l
b3V0LCBpbnQgd2xlbikKIAlpbnQgbnVtX2VuZ2luZXMgPSAwOwogCiAJaWYgKHJpbmcgPT0gQUxM
X0VOR0lORVMpIHsKLQkJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGZkLCByaW5nKSB7Ci0JCQlp
ZiAoIWdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIHJpbmcpKQorCQlmb3JfZWFjaF9waHlzaWNhbF9l
bmdpbmUoZSwgZmQpIHsKKwkJCWlmICghZ2VtX2Nhbl9zdG9yZV9kd29yZChmZCwgZWJfcmluZyhl
KSkpCiAJCQkJY29udGludWU7CiAKLQkJCW5hbWVzW251bV9lbmdpbmVzXSA9IGVfXy0+bmFtZTsK
LQkJCWVuZ2luZXNbbnVtX2VuZ2luZXMrK10gPSByaW5nOworCQkJbmFtZXNbbnVtX2VuZ2luZXNd
ID0gZS0+bmFtZTsKKwkJCWVuZ2luZXNbbnVtX2VuZ2luZXMrK10gPSBlYl9yaW5nKGUpOwogCQkJ
aWYgKG51bV9lbmdpbmVzID09IEFSUkFZX1NJWkUoZW5naW5lcykpCiAJCQkJYnJlYWs7CiAJCX0K
QEAgLTQ5OSwxMiArNDk5LDEyIEBAIHN0b3JlX3JpbmcoaW50IGZkLCB1bnNpZ25lZCByaW5nLCBp
bnQgbnVtX2NoaWxkcmVuLCBpbnQgdGltZW91dCkKIAlpbnQgbnVtX2VuZ2luZXMgPSAwOwogCiAJ
aWYgKHJpbmcgPT0gQUxMX0VOR0lORVMpIHsKLQkJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGZk
LCByaW5nKSB7Ci0JCQlpZiAoIWdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIHJpbmcpKQorCQlmb3Jf
ZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQpIHsKKwkJCWlmICghZ2VtX2Nhbl9zdG9yZV9kd29y
ZChmZCwgZWJfcmluZyhlKSkpCiAJCQkJY29udGludWU7CiAKLQkJCW5hbWVzW251bV9lbmdpbmVz
XSA9IGVfXy0+bmFtZTsKLQkJCWVuZ2luZXNbbnVtX2VuZ2luZXMrK10gPSByaW5nOworCQkJbmFt
ZXNbbnVtX2VuZ2luZXNdID0gZS0+bmFtZTsKKwkJCWVuZ2luZXNbbnVtX2VuZ2luZXMrK10gPSBl
Yl9yaW5nKGUpOwogCQkJaWYgKG51bV9lbmdpbmVzID09IEFSUkFZX1NJWkUoZW5naW5lcykpCiAJ
CQkJYnJlYWs7CiAJCX0KQEAgLTYxNiwxMiArNjE2LDEyIEBAIHN3aXRjaF9yaW5nKGludCBmZCwg
dW5zaWduZWQgcmluZywgaW50IG51bV9jaGlsZHJlbiwgaW50IHRpbWVvdXQpCiAJZ2VtX3JlcXVp
cmVfY29udGV4dHMoZmQpOwogCiAJaWYgKHJpbmcgPT0gQUxMX0VOR0lORVMpIHsKLQkJZm9yX2Vh
Y2hfcGh5c2ljYWxfZW5naW5lKGZkLCByaW5nKSB7Ci0JCQlpZiAoIWdlbV9jYW5fc3RvcmVfZHdv
cmQoZmQsIHJpbmcpKQorCQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQpIHsKKwkJCWlm
ICghZ2VtX2Nhbl9zdG9yZV9kd29yZChmZCwgZWJfcmluZyhlKSkpCiAJCQkJY29udGludWU7CiAK
LQkJCW5hbWVzW251bV9lbmdpbmVzXSA9IGVfXy0+bmFtZTsKLQkJCWVuZ2luZXNbbnVtX2VuZ2lu
ZXMrK10gPSByaW5nOworCQkJbmFtZXNbbnVtX2VuZ2luZXNdID0gZS0+bmFtZTsKKwkJCWVuZ2lu
ZXNbbnVtX2VuZ2luZXMrK10gPSBlYl9yaW5nKGUpOwogCQkJaWYgKG51bV9lbmdpbmVzID09IEFS
UkFZX1NJWkUoZW5naW5lcykpCiAJCQkJYnJlYWs7CiAJCX0KQEAgLTk0MywxNyArOTQzLDE3IEBA
IHN0b3JlX21hbnkoaW50IGZkLCB1bnNpZ25lZCByaW5nLCBpbnQgdGltZW91dCkKIAlpbnRlbF9k
ZXRlY3RfYW5kX2NsZWFyX21pc3NlZF9pbnRlcnJ1cHRzKGZkKTsKIAogCWlmIChyaW5nID09IEFM
TF9FTkdJTkVTKSB7Ci0JCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShmZCwgcmluZykgewotCQkJ
aWYgKCFnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCByaW5nKSkKKwkJZm9yX2VhY2hfcGh5c2ljYWxf
ZW5naW5lKGUsIGZkKSB7CisJCQlpZiAoIWdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGViX3Jpbmco
ZSkpKQogCQkJCWNvbnRpbnVlOwogCiAJCQlpZ3RfZm9yayhjaGlsZCwgMSkKIAkJCQlfX3N0b3Jl
X21hbnkoZmQsCi0JCQkJCSAgICAgcmluZywKKwkJCQkJICAgICBlYl9yaW5nKGUpLAogCQkJCQkg
ICAgIHRpbWVvdXQsCiAJCQkJCSAgICAgJnNoYXJlZFtuXSk7CiAKLQkJCW5hbWVzW24rK10gPSBl
X18tPm5hbWU7CisJCQluYW1lc1tuKytdID0gZS0+bmFtZTsKIAkJfQogCQlpZ3Rfd2FpdGNoaWxk
cmVuKCk7CiAJfSBlbHNlIHsKQEAgLTk3NCwxMSArOTc0LDExIEBAIHN0b3JlX21hbnkoaW50IGZk
LCB1bnNpZ25lZCByaW5nLCBpbnQgdGltZW91dCkKIHN0YXRpYyB2b2lkCiBzeW5jX2FsbChpbnQg
ZmQsIGludCBudW1fY2hpbGRyZW4sIGludCB0aW1lb3V0KQogewotCXVuc2lnbmVkIGVuZ2luZXNb
MTZdLCBlbmdpbmU7CisJdW5zaWduZWQgZW5naW5lc1sxNl07CiAJaW50IG51bV9lbmdpbmVzID0g
MDsKIAotCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShmZCwgZW5naW5lKSB7Ci0JCWVuZ2luZXNb
bnVtX2VuZ2luZXMrK10gPSBlbmdpbmU7CisJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGZk
KSB7CisJCWVuZ2luZXNbbnVtX2VuZ2luZXMrK10gPSBlYl9yaW5nKGUpOwogCQlpZiAobnVtX2Vu
Z2luZXMgPT0gQVJSQVlfU0laRShlbmdpbmVzKSkKIAkJCWJyZWFrOwogCX0KQEAgLTEwMjgsMTMg
KzEwMjgsMTIgQEAgc3RvcmVfYWxsKGludCBmZCwgaW50IG51bV9jaGlsZHJlbiwgaW50IHRpbWVv
dXQpCiAJY29uc3QgaW50IGdlbiA9IGludGVsX2dlbihpbnRlbF9nZXRfZHJtX2RldmlkKGZkKSk7
CiAJdW5zaWduZWQgZW5naW5lc1sxNl07CiAJaW50IG51bV9lbmdpbmVzID0gMDsKLQl1bnNpZ25l
ZCBpbnQgcmluZzsKIAotCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShmZCwgcmluZykgewotCQlp
ZiAoIWdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIHJpbmcpKQorCWZvcl9lYWNoX3BoeXNpY2FsX2Vu
Z2luZShlLCBmZCkgeworCQlpZiAoIWdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGViX3JpbmcoZSkp
KQogCQkJY29udGludWU7CiAKLQkJZW5naW5lc1tudW1fZW5naW5lcysrXSA9IHJpbmc7CisJCWVu
Z2luZXNbbnVtX2VuZ2luZXMrK10gPSBlYl9yaW5nKGUpOwogCQlpZiAobnVtX2VuZ2luZXMgPT0g
QVJSQVlfU0laRShlbmdpbmVzKSkKIAkJCWJyZWFrOwogCX0KQEAgLTExMzksOSArMTEzOCw5IEBA
IHByZWVtcHQoaW50IGZkLCB1bnNpZ25lZCByaW5nLCBpbnQgbnVtX2NoaWxkcmVuLCBpbnQgdGlt
ZW91dCkKIAl1aW50MzJfdCBjdHhbMl07CiAKIAlpZiAocmluZyA9PSBBTExfRU5HSU5FUykgewot
CQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZmQsIHJpbmcpIHsKLQkJCW5hbWVzW251bV9lbmdp
bmVzXSA9IGVfXy0+bmFtZTsKLQkJCWVuZ2luZXNbbnVtX2VuZ2luZXMrK10gPSByaW5nOworCQlm
b3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQpIHsKKwkJCW5hbWVzW251bV9lbmdpbmVzXSA9
IGUtPm5hbWU7CisJCQllbmdpbmVzW251bV9lbmdpbmVzKytdID0gZWJfcmluZyhlKTsKIAkJCWlm
IChudW1fZW5naW5lcyA9PSBBUlJBWV9TSVpFKGVuZ2luZXMpKQogCQkJCWJyZWFrOwogCQl9CkBA
IC0xMjI3LDI5ICsxMjI2LDI5IEBAIGlndF9tYWluCiAKIAlmb3IgKGUgPSBpbnRlbF9leGVjdXRp
b25fZW5naW5lczsgZS0+bmFtZTsgZSsrKSB7CiAJCWlndF9zdWJ0ZXN0X2YoIiVzIiwgZS0+bmFt
ZSkKLQkJCXN5bmNfcmluZyhmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCAxLCAxNTApOworCQkJ
c3luY19yaW5nKGZkLCBlYl9yaW5nKGUpLCAxLCAxNTApOwogCQlpZ3Rfc3VidGVzdF9mKCJpZGxl
LSVzIiwgZS0+bmFtZSkKLQkJCWlkbGVfcmluZyhmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCAx
NTApOworCQkJaWRsZV9yaW5nKGZkLCBlYl9yaW5nKGUpLCAxNTApOwogCQlpZ3Rfc3VidGVzdF9m
KCJhY3RpdmUtJXMiLCBlLT5uYW1lKQotCQkJYWN0aXZlX3JpbmcoZmQsIGUtPmV4ZWNfaWQgfCBl
LT5mbGFncywgMTUwKTsKKwkJCWFjdGl2ZV9yaW5nKGZkLCBlYl9yaW5nKGUpLCAxNTApOwogCQlp
Z3Rfc3VidGVzdF9mKCJ3YWtldXAtJXMiLCBlLT5uYW1lKQotCQkJd2FrZXVwX3JpbmcoZmQsIGUt
PmV4ZWNfaWQgfCBlLT5mbGFncywgMTUwLCAxKTsKKwkJCXdha2V1cF9yaW5nKGZkLCBlYl9yaW5n
KGUpLCAxNTAsIDEpOwogCQlpZ3Rfc3VidGVzdF9mKCJhY3RpdmUtd2FrZXVwLSVzIiwgZS0+bmFt
ZSkKLQkJCWFjdGl2ZV93YWtldXBfcmluZyhmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCAxNTAs
IDEpOworCQkJYWN0aXZlX3dha2V1cF9yaW5nKGZkLCBlYl9yaW5nKGUpLCAxNTAsIDEpOwogCQlp
Z3Rfc3VidGVzdF9mKCJkb3VibGUtd2FrZXVwLSVzIiwgZS0+bmFtZSkKLQkJCXdha2V1cF9yaW5n
KGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIDE1MCwgMik7CisJCQl3YWtldXBfcmluZyhmZCwg
ZWJfcmluZyhlKSwgMTUwLCAyKTsKIAkJaWd0X3N1YnRlc3RfZigic3RvcmUtJXMiLCBlLT5uYW1l
KQotCQkJc3RvcmVfcmluZyhmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCAxLCAxNTApOworCQkJ
c3RvcmVfcmluZyhmZCwgZWJfcmluZyhlKSwgMSwgMTUwKTsKIAkJaWd0X3N1YnRlc3RfZigic3dp
dGNoLSVzIiwgZS0+bmFtZSkKLQkJCXN3aXRjaF9yaW5nKGZkLCBlLT5leGVjX2lkIHwgZS0+Zmxh
Z3MsIDEsIDE1MCk7CisJCQlzd2l0Y2hfcmluZyhmZCwgZWJfcmluZyhlKSwgMSwgMTUwKTsKIAkJ
aWd0X3N1YnRlc3RfZigiZm9ya2VkLXN3aXRjaC0lcyIsIGUtPm5hbWUpCi0JCQlzd2l0Y2hfcmlu
ZyhmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCBuY3B1cywgMTUwKTsKKwkJCXN3aXRjaF9yaW5n
KGZkLCBlYl9yaW5nKGUpLCBuY3B1cywgMTUwKTsKIAkJaWd0X3N1YnRlc3RfZigibWFueS0lcyIs
IGUtPm5hbWUpCi0JCQlzdG9yZV9tYW55KGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIDE1MCk7
CisJCQlzdG9yZV9tYW55KGZkLCBlYl9yaW5nKGUpLCAxNTApOwogCQlpZ3Rfc3VidGVzdF9mKCJm
b3JrZWQtJXMiLCBlLT5uYW1lKQotCQkJc3luY19yaW5nKGZkLCBlLT5leGVjX2lkIHwgZS0+Zmxh
Z3MsIG5jcHVzLCAxNTApOworCQkJc3luY19yaW5nKGZkLCBlYl9yaW5nKGUpLCBuY3B1cywgMTUw
KTsKIAkJaWd0X3N1YnRlc3RfZigiZm9ya2VkLXN0b3JlLSVzIiwgZS0+bmFtZSkKLQkJCXN0b3Jl
X3JpbmcoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgbmNwdXMsIDE1MCk7CisJCQlzdG9yZV9y
aW5nKGZkLCBlYl9yaW5nKGUpLCBuY3B1cywgMTUwKTsKIAl9CiAKIAlpZ3Rfc3VidGVzdCgiYmFz
aWMtZWFjaCIpCkBAIC0xMzAxLDcgKzEzMDAsNyBAQCBpZ3RfbWFpbgogCiAJCWZvciAoZSA9IGlu
dGVsX2V4ZWN1dGlvbl9lbmdpbmVzOyBlLT5uYW1lOyBlKyspIHsKIAkJCWlndF9zdWJ0ZXN0X2Yo
InByZWVtcHQtJXMiLCBlLT5uYW1lKQotCQkJCXByZWVtcHQoZmQsIGUtPmV4ZWNfaWQgfCBlLT5m
bGFncywgbmNwdXMsIDE1MCk7CisJCQkJcHJlZW1wdChmZCwgZWJfcmluZyhlKSwgbmNwdXMsIDE1
MCk7CiAJCX0KIAl9CiAKZGlmZiAtLWdpdCBhL3Rlc3RzL2k5MTUvZ2VtX3VzZXJwdHJfYmxpdHMu
YyBiL3Rlc3RzL2k5MTUvZ2VtX3VzZXJwdHJfYmxpdHMuYwppbmRleCAxOGU4MDZmZWQuLjExZDZm
NGExYyAxMDA2NDQKLS0tIGEvdGVzdHMvaTkxNS9nZW1fdXNlcnB0cl9ibGl0cy5jCisrKyBiL3Rl
c3RzL2k5MTUvZ2VtX3VzZXJwdHJfYmxpdHMuYwpAQCAtMTE2NSwxOCArMTE2NSwxNyBAQCBzdGF0
aWMgdm9pZCB0ZXN0X3JlYWRvbmx5KGludCBpOTE1KQogCWlndF9hc3NlcnQobXByb3RlY3Qoc3Bh
Y2UsIHRvdGFsLCBQUk9UX1JFQUQpID09IDApOwogCiAJaWd0X2ZvcmsoY2hpbGQsIDEpIHsKLQkJ
dW5zaWduZWQgaW50IGVuZ2luZTsKIAkJY2hhciAqb3JpZzsKIAogCQlvcmlnID0gZ19jb21wdXRl
X2NoZWNrc3VtX2Zvcl9kYXRhKEdfQ0hFQ0tTVU1fU0hBMSwgcGFnZXMsIHN6KTsKIAogCQlnZW1f
dXNlcnB0cihpOTE1LCBzcGFjZSwgdG90YWwsIHRydWUsIHVzZXJwdHJfZmxhZ3MsICZyaGFuZGxl
KTsKIAotCQlmb3JfZWFjaF9lbmdpbmUoaTkxNSwgZW5naW5lKSB7CisJCWZvcl9lYWNoX2VuZ2lu
ZShlLCBpOTE1KSB7CiAJCQljaGFyICpyZWYsICpyZXN1bHQ7CiAKIAkJCS8qIEZpcnN0IHR3ZWFr
IHRoZSBiYWNraW5nIHN0b3JlIHRocm91Z2ggdGhlIHdyaXRlICovCi0JCQlzdG9yZV9kd29yZF9y
YW5kKGk5MTUsIGVuZ2luZSwgd2hhbmRsZSwgc3osIDEwMjQpOworCQkJc3RvcmVfZHdvcmRfcmFu
ZChpOTE1LCBlYl9yaW5nKGUpLCB3aGFuZGxlLCBzeiwgMTAyNCk7CiAJCQlnZW1fc3luYyhpOTE1
LCB3aGFuZGxlKTsKIAkJCXJlZiA9IGdfY29tcHV0ZV9jaGVja3N1bV9mb3JfZGF0YShHX0NIRUNL
U1VNX1NIQTEsCiAJCQkJCQkJICBwYWdlcywgc3opOwpAQCAtMTE4NSw3ICsxMTg0LDcgQEAgc3Rh
dGljIHZvaWQgdGVzdF9yZWFkb25seShpbnQgaTkxNSkKIAkJCWlndF9hc3NlcnQoc3RyY21wKHJl
Ziwgb3JpZykpOwogCiAJCQkvKiBOb3cgdHJ5IHRoZSBzYW1lIHRocm91Z2ggdGhlIHJlYWQtb25s
eSBoYW5kbGUgKi8KLQkJCXN0b3JlX2R3b3JkX3JhbmQoaTkxNSwgZW5naW5lLCByaGFuZGxlLCB0
b3RhbCwgMTAyNCk7CisJCQlzdG9yZV9kd29yZF9yYW5kKGk5MTUsIGViX3JpbmcoZSksIHJoYW5k
bGUsIHRvdGFsLCAxMDI0KTsKIAkJCWdlbV9zeW5jKGk5MTUsIHJoYW5kbGUpOwogCQkJcmVzdWx0
ID0gZ19jb21wdXRlX2NoZWNrc3VtX2Zvcl9kYXRhKEdfQ0hFQ0tTVU1fU0hBMSwKIAkJCQkJCQkg
ICAgIHBhZ2VzLCBzeik7CmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1L2k5MTVfbW9kdWxlX2xvYWQu
YyBiL3Rlc3RzL2k5MTUvaTkxNV9tb2R1bGVfbG9hZC5jCmluZGV4IDdmZTgzNTIwNy4uZjkwNzVm
N2Q4IDEwMDY0NAotLS0gYS90ZXN0cy9pOTE1L2k5MTVfbW9kdWxlX2xvYWQuYworKysgYi90ZXN0
cy9pOTE1L2k5MTVfbW9kdWxlX2xvYWQuYwpAQCAtMTEzLDcgKzExMyw3IEBAIHN0YXRpYyB2b2lk
IHN0b3JlX2FsbChpbnQgZmQpCiAJdW5zaWduZWQgZW5naW5lc1sxNl0sIHBlcm11dGVkWzE2XTsK
IAl1aW50MzJfdCBiYXRjaFsxNl07CiAJdWludDY0X3Qgb2Zmc2V0OwotCXVuc2lnbmVkIGVuZ2lu
ZSwgbmVuZ2luZTsKKwl1bnNpZ25lZCBuZW5naW5lOwogCWludCB2YWx1ZTsKIAlpbnQgaSwgajsK
IApAQCAtMTUxLDE0ICsxNTEsMTQgQEAgc3RhdGljIHZvaWQgc3RvcmVfYWxsKGludCBmZCkKIAog
CW5lbmdpbmUgPSAwOwogCWludGVsX2RldGVjdF9hbmRfY2xlYXJfbWlzc2VkX2ludGVycnVwdHMo
ZmQpOwotCWZvcl9lYWNoX2VuZ2luZShmZCwgZW5naW5lKSB7Ci0JCWlmICghZ2VtX2Nhbl9zdG9y
ZV9kd29yZChmZCwgZW5naW5lKSkKKwlmb3JfZWFjaF9lbmdpbmUoZSwgZmQpIHsKKwkJaWYgKCFn
ZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlYl9yaW5nKGUpKSkKIAkJCWNvbnRpbnVlOwogCi0JCWln
dF9hc3NlcnQoMioobmVuZ2luZSsxKSpzaXplb2YoYmF0Y2gpIDw9IDQwOTYpOworCQlpZ3RfYXNz
ZXJ0KDIgKiAoZWJfcmluZyhlKSArIDEpICogc2l6ZW9mKGJhdGNoKSA8PSA0MDk2KTsKIAogCQll
eGVjYnVmLmZsYWdzICY9IH5FTkdJTkVfTUFTSzsKLQkJZXhlY2J1Zi5mbGFncyB8PSBlbmdpbmU7
CisJCWV4ZWNidWYuZmxhZ3MgfD0gZWJfcmluZyhlKTsKIAogCQlqID0gMipuZW5naW5lOwogCQly
ZWxvY1tqXS50YXJnZXRfaGFuZGxlID0gb2JqWzBdLmhhbmRsZTsKQEAgLTE5MCw3ICsxOTAsNyBA
QCBzdGF0aWMgdm9pZCBzdG9yZV9hbGwoaW50IGZkKQogCQlleGVjYnVmLmJhdGNoX3N0YXJ0X29m
ZnNldCA9IGoqc2l6ZW9mKGJhdGNoKTsKIAkJZ2VtX2V4ZWNidWYoZmQsICZleGVjYnVmKTsKIAot
CQllbmdpbmVzW25lbmdpbmUrK10gPSBlbmdpbmU7CisJCWVuZ2luZXNbbmVuZ2luZSsrXSA9IGVi
X3JpbmcoZSk7CiAJfQogCWdlbV9zeW5jKGZkLCBvYmpbMV0uaGFuZGxlKTsKIApAQCAtMjg3LDgg
KzI4Nyw4IEBAIGdlbV9leGVjX3N0b3JlKHZvaWQpCiAJaWd0X2ZvcmtfaGFuZ19kZXRlY3Rvcihm
ZCk7CiAKIAlmb3IgKGUgPSBpbnRlbF9leGVjdXRpb25fZW5naW5lczsgZS0+bmFtZTsgZSsrKSB7
Ci0JCWlmIChnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MpKQot
CQkJc3RvcmVfZHdvcmQoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncyk7CisJCWlmIChnZW1fY2Fu
X3N0b3JlX2R3b3JkKGZkLCBlYl9yaW5nKGUpKSkKKwkJCXN0b3JlX2R3b3JkKGZkLCBlYl9yaW5n
KGUpKTsKIAl9CiAKIAlzdG9yZV9hbGwoZmQpOwpkaWZmIC0tZ2l0IGEvdGVzdHMva21zX2J1c3ku
YyBiL3Rlc3RzL2ttc19idXN5LmMKaW5kZXggNWZmMmI4NDYwLi5mYWFkNzMwOTIgMTAwNjQ0Ci0t
LSBhL3Rlc3RzL2ttc19idXN5LmMKKysrIGIvdGVzdHMva21zX2J1c3kuYwpAQCAtMzE1LDMyICsz
MTUsMjggQEAgaWd0X21haW4KIAogCQlpZ3Rfc3VidGVzdF9mKCJiYXNpYy1mbGlwLSVzIiwKIAkJ
CWttc3Rlc3RfcGlwZV9uYW1lKG4pKSB7Ci0JCQlpZ3RfcmVxdWlyZShnZW1faGFzX3JpbmcoZGlz
cGxheS5kcm1fZmQsCi0JCQkJCQllLT5leGVjX2lkIHwgZS0+ZmxhZ3MpKTsKKwkJCWlndF9yZXF1
aXJlKGdlbV9oYXNfcmluZyhkaXNwbGF5LmRybV9mZCwgZWJfcmluZyhlKSkpOwogCi0JCQl0ZXN0
X2ZsaXAoJmRpc3BsYXksIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgbiwgZmFsc2UpOworCQkJdGVz
dF9mbGlwKCZkaXNwbGF5LCBlYl9yaW5nKGUpLCBuLCBmYWxzZSk7CiAJCX0KIAkJaWd0X3N1YnRl
c3RfZigiYmFzaWMtbW9kZXNldC0lcyIsCiAJCQlrbXN0ZXN0X3BpcGVfbmFtZShuKSkgewotCQkJ
aWd0X3JlcXVpcmUoZ2VtX2hhc19yaW5nKGRpc3BsYXkuZHJtX2ZkLAotCQkJCQkJZS0+ZXhlY19p
ZCB8IGUtPmZsYWdzKSk7CisJCQlpZ3RfcmVxdWlyZShnZW1faGFzX3JpbmcoZGlzcGxheS5kcm1f
ZmQsIGViX3JpbmcoZSkpKTsKIAotCQkJdGVzdF9mbGlwKCZkaXNwbGF5LCBlLT5leGVjX2lkIHwg
ZS0+ZmxhZ3MsIG4sIHRydWUpOworCQkJdGVzdF9mbGlwKCZkaXNwbGF5LCBlYl9yaW5nKGUpLCBu
LCB0cnVlKTsKIAkJfQogCiAJCWlndF9maXh0dXJlIHsKLQkJCWlndF9yZXF1aXJlKGdlbV9oYXNf
cmluZyhkaXNwbGF5LmRybV9mZCwKLQkJCQkJCWUtPmV4ZWNfaWQgfCBlLT5mbGFncykpOworCQkJ
aWd0X3JlcXVpcmUoZ2VtX2hhc19yaW5nKGRpc3BsYXkuZHJtX2ZkLCBlYl9yaW5nKGUpKSk7CiAK
IAkJCWhhbmcgPSBpZ3RfYWxsb3dfaGFuZyhkaXNwbGF5LmRybV9mZCwgMCwgMCk7CiAJCX0KIAog
CQlpZ3Rfc3VidGVzdF9mKCJleHRlbmRlZC1wYWdlZmxpcC1tb2Rlc2V0LWhhbmctb2xkZmItJXMt
JXMiLAogCQkJCWUtPm5hbWUsIGttc3Rlc3RfcGlwZV9uYW1lKG4pKSB7Ci0JCQlpZ3RfcmVxdWly
ZShnZW1faGFzX3JpbmcoZGlzcGxheS5kcm1fZmQsCi0JCQkJCQllLT5leGVjX2lkIHwgZS0+Zmxh
Z3MpKTsKKwkJCWlndF9yZXF1aXJlKGdlbV9oYXNfcmluZyhkaXNwbGF5LmRybV9mZCwgZWJfcmlu
ZyhlKSkpOwogCi0JCQl0ZXN0X3BhZ2VmbGlwX21vZGVzZXRfaGFuZygmZGlzcGxheSwgZS0+ZXhl
Y19pZCB8IGUtPmZsYWdzLCBuKTsKKwkJCXRlc3RfcGFnZWZsaXBfbW9kZXNldF9oYW5nKCZkaXNw
bGF5LCBlYl9yaW5nKGUpLCBuKTsKIAkJfQogCiAJCWlndF9maXh0dXJlCkBAIC0zNDgsMjUgKzM0
NCwyNSBAQCBpZ3RfbWFpbgogCiAJCWlndF9zdWJ0ZXN0X2YoImV4dGVuZGVkLXBhZ2VmbGlwLWhh
bmctb2xkZmItJXMtJXMiLAogCQkJCWUtPm5hbWUsIGttc3Rlc3RfcGlwZV9uYW1lKG4pKQotCQkJ
dGVzdF9oYW5nKCZkaXNwbGF5LCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIG4sIGZhbHNlLCBmYWxz
ZSk7CisJCQl0ZXN0X2hhbmcoJmRpc3BsYXksIGViX3JpbmcoZSksIG4sIGZhbHNlLCBmYWxzZSk7
CiAKIAkJaWd0X3N1YnRlc3RfZigiZXh0ZW5kZWQtcGFnZWZsaXAtaGFuZy1uZXdmYi0lcy0lcyIs
CiAJCQkJZS0+bmFtZSwga21zdGVzdF9waXBlX25hbWUobikpCi0JCQl0ZXN0X2hhbmcoJmRpc3Bs
YXksIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgbiwgZmFsc2UsIHRydWUpOworCQkJdGVzdF9oYW5n
KCZkaXNwbGF5LCBlYl9yaW5nKGUpLCBuLCBmYWxzZSwgdHJ1ZSk7CiAKIAkJaWd0X3N1YnRlc3Rf
ZigiZXh0ZW5kZWQtbW9kZXNldC1oYW5nLW9sZGZiLSVzLSVzIiwKIAkJCQllLT5uYW1lLCBrbXN0
ZXN0X3BpcGVfbmFtZShuKSkKLQkJCXRlc3RfaGFuZygmZGlzcGxheSwgZS0+ZXhlY19pZCB8IGUt
PmZsYWdzLCBuLCB0cnVlLCBmYWxzZSk7CisJCQl0ZXN0X2hhbmcoJmRpc3BsYXksIGViX3Jpbmco
ZSksIG4sIHRydWUsIGZhbHNlKTsKIAogCQlpZ3Rfc3VidGVzdF9mKCJleHRlbmRlZC1tb2Rlc2V0
LWhhbmctbmV3ZmItJXMtJXMiLAogCQkJCWUtPm5hbWUsIGttc3Rlc3RfcGlwZV9uYW1lKG4pKQot
CQkJdGVzdF9oYW5nKCZkaXNwbGF5LCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIG4sIHRydWUsIHRy
dWUpOworCQkJdGVzdF9oYW5nKCZkaXNwbGF5LCBlYl9yaW5nKGUpLCBuLCB0cnVlLCB0cnVlKTsK
IAogCQlpZ3Rfc3VidGVzdF9mKCJleHRlbmRlZC1tb2Rlc2V0LWhhbmctb2xkZmItd2l0aC1yZXNl
dC0lcy0lcyIsCiAJCQkJZS0+bmFtZSwga21zdGVzdF9waXBlX25hbWUobikpIHsKIAkJCWlndF9z
ZXRfbW9kdWxlX3BhcmFtX2ludCgiZm9yY2VfcmVzZXRfbW9kZXNldF90ZXN0IiwgMSk7CiAKLQkJ
CXRlc3RfaGFuZygmZGlzcGxheSwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCBuLCB0cnVlLCBmYWxz
ZSk7CisJCQl0ZXN0X2hhbmcoJmRpc3BsYXksIGViX3JpbmcoZSksIG4sIHRydWUsIGZhbHNlKTsK
IAogCQkJaWd0X3NldF9tb2R1bGVfcGFyYW1faW50KCJmb3JjZV9yZXNldF9tb2Rlc2V0X3Rlc3Qi
LCAwKTsKIAkJfQpAQCAtMzc1LDcgKzM3MSw3IEBAIGlndF9tYWluCiAJCQkJZS0+bmFtZSwga21z
dGVzdF9waXBlX25hbWUobikpIHsKIAkJCWlndF9zZXRfbW9kdWxlX3BhcmFtX2ludCgiZm9yY2Vf
cmVzZXRfbW9kZXNldF90ZXN0IiwgMSk7CiAKLQkJCXRlc3RfaGFuZygmZGlzcGxheSwgZS0+ZXhl
Y19pZCB8IGUtPmZsYWdzLCBuLCB0cnVlLCB0cnVlKTsKKwkJCXRlc3RfaGFuZygmZGlzcGxheSwg
ZWJfcmluZyhlKSwgbiwgdHJ1ZSwgdHJ1ZSk7CiAKIAkJCWlndF9zZXRfbW9kdWxlX3BhcmFtX2lu
dCgiZm9yY2VfcmVzZXRfbW9kZXNldF90ZXN0IiwgMCk7CiAJCX0KZGlmZiAtLWdpdCBhL3Rlc3Rz
L3ByaW1lX2J1c3kuYyBiL3Rlc3RzL3ByaW1lX2J1c3kuYwppbmRleCA0ZjIzN2Y2OGYuLjhlZTIz
YmIzZiAxMDA2NDQKLS0tIGEvdGVzdHMvcHJpbWVfYnVzeS5jCisrKyBiL3Rlc3RzL3ByaW1lX2J1
c3kuYwpAQCAtMTkyLDggKzE5Miw4IEBAIHN0YXRpYyB2b2lkIHRlc3RfZW5naW5lX21vZGUoaW50
IGZkLAogCiAJaWd0X3N1YnRlc3RfZ3JvdXAgewogCQlpZ3RfZml4dHVyZSB7Ci0JCQlnZW1fcmVx
dWlyZV9yaW5nKGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MpOwotCQkJaWd0X3JlcXVpcmUoZ2Vt
X2Nhbl9zdG9yZV9kd29yZChmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzKSk7CisJCQlnZW1fcmVx
dWlyZV9yaW5nKGZkLCBlYl9yaW5nKGUpKTsKKwkJCWlndF9yZXF1aXJlKGdlbV9jYW5fc3RvcmVf
ZHdvcmQoZmQsIGViX3JpbmcoZSkpKTsKIAogCQkJaWYgKChmbGFncyAmIEhBTkcpID09IDApCiAJ
CQl7CkBAIC0yMDksMTIgKzIwOSwxMiBAQCBzdGF0aWMgdm9pZCB0ZXN0X2VuZ2luZV9tb2RlKGlu
dCBmZCwKIAkJaWd0X3N1YnRlc3RfZigiJXMlcy0lcyIsCiAJCQkgICAgICAhZS0+ZXhlY19pZCAm
JiAhKGZsYWdzICYgSEFORykgPyAiYmFzaWMtIiA6ICIiLAogCQkJICAgICAgbmFtZSwgZS0+bmFt
ZSkKLQkJCWJ1c3koZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgZmxhZ3MpOworCQkJYnVzeShm
ZCwgZWJfcmluZyhlKSwgZmxhZ3MpOwogCiAJCWlndF9zdWJ0ZXN0X2YoIiVzd2FpdC0lcy0lcyIs
CiAJCQkgICAgICAhZS0+ZXhlY19pZCAmJiAhKGZsYWdzICYgSEFORykgPyAiYmFzaWMtIiA6ICIi
LAogCQkJICAgICAgbmFtZSwgZS0+bmFtZSkKLQkJCWJ1c3koZmQsIGUtPmV4ZWNfaWQgfCBlLT5m
bGFncywgZmxhZ3MgfCBQT0xMKTsKKwkJCWJ1c3koZmQsIGViX3JpbmcoZSksIGZsYWdzIHwgUE9M
TCk7CiAKIAkJaWd0X2ZpeHR1cmUgewogCQkJaWYgKChmbGFncyAmIEhBTkcpID09IDApCmRpZmYg
LS1naXQgYS90ZXN0cy9wcmltZV92Z2VtLmMgYi90ZXN0cy9wcmltZV92Z2VtLmMKaW5kZXggYmVi
ZjllZGM2Li4yYjIxZmY0MTQgMTAwNjQ0Ci0tLSBhL3Rlc3RzL3ByaW1lX3ZnZW0uYworKysgYi90
ZXN0cy9wcmltZV92Z2VtLmMKQEAgLTg0OCw4ICs4NDgsOCBAQCBpZ3RfbWFpbgogCQlpZ3Rfc3Vi
dGVzdF9mKCIlc3N5bmMtJXMiLAogCQkJICAgICAgZS0+ZXhlY19pZCA9PSAwID8gImJhc2ljLSIg
OiAiIiwKIAkJCSAgICAgIGUtPm5hbWUpIHsKLQkJCWdlbV9yZXF1aXJlX3JpbmcoaTkxNSwgZS0+
ZXhlY19pZCB8IGUtPmZsYWdzKTsKLQkJCWlndF9yZXF1aXJlKGdlbV9jYW5fc3RvcmVfZHdvcmQo
aTkxNSwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzKSk7CisJCQlnZW1fcmVxdWlyZV9yaW5nKGk5MTUs
IGViX3JpbmcoZSkpOworCQkJaWd0X3JlcXVpcmUoZ2VtX2Nhbl9zdG9yZV9kd29yZChpOTE1LCBl
Yl9yaW5nKGUpKSk7CiAKIAkJCWdlbV9xdWllc2NlbnRfZ3B1KGk5MTUpOwogCQkJdGVzdF9zeW5j
KGk5MTUsIHZnZW0sIGUtPmV4ZWNfaWQsIGUtPmZsYWdzKTsKQEAgLTg2MCw4ICs4NjAsOCBAQCBp
Z3RfbWFpbgogCQlpZ3Rfc3VidGVzdF9mKCIlc2J1c3ktJXMiLAogCQkJICAgICAgZS0+ZXhlY19p
ZCA9PSAwID8gImJhc2ljLSIgOiAiIiwKIAkJCSAgICAgIGUtPm5hbWUpIHsKLQkJCWdlbV9yZXF1
aXJlX3JpbmcoaTkxNSwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzKTsKLQkJCWlndF9yZXF1aXJlKGdl
bV9jYW5fc3RvcmVfZHdvcmQoaTkxNSwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzKSk7CisJCQlnZW1f
cmVxdWlyZV9yaW5nKGk5MTUsIGViX3JpbmcoZSkpOworCQkJaWd0X3JlcXVpcmUoZ2VtX2Nhbl9z
dG9yZV9kd29yZChpOTE1LCBlYl9yaW5nKGUpKSk7CiAKIAkJCWdlbV9xdWllc2NlbnRfZ3B1KGk5
MTUpOwogCQkJdGVzdF9idXN5KGk5MTUsIHZnZW0sIGUtPmV4ZWNfaWQsIGUtPmZsYWdzKTsKQEAg
LTg3Miw4ICs4NzIsOCBAQCBpZ3RfbWFpbgogCQlpZ3Rfc3VidGVzdF9mKCIlc3dhaXQtJXMiLAog
CQkJICAgICAgZS0+ZXhlY19pZCA9PSAwID8gImJhc2ljLSIgOiAiIiwKIAkJCSAgICAgIGUtPm5h
bWUpIHsKLQkJCWdlbV9yZXF1aXJlX3JpbmcoaTkxNSwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzKTsK
LQkJCWlndF9yZXF1aXJlKGdlbV9jYW5fc3RvcmVfZHdvcmQoaTkxNSwgZS0+ZXhlY19pZCB8IGUt
PmZsYWdzKSk7CisJCQlnZW1fcmVxdWlyZV9yaW5nKGk5MTUsIGViX3JpbmcoZSkpOworCQkJaWd0
X3JlcXVpcmUoZ2VtX2Nhbl9zdG9yZV9kd29yZChpOTE1LCBlYl9yaW5nKGUpKSk7CiAKIAkJCWdl
bV9xdWllc2NlbnRfZ3B1KGk5MTUpOwogCQkJdGVzdF93YWl0KGk5MTUsIHZnZW0sIGUtPmV4ZWNf
aWQsIGUtPmZsYWdzKTsKQEAgLTg5NSw4ICs4OTUsOCBAQCBpZ3RfbWFpbgogCQkJaWd0X3N1YnRl
c3RfZigiJXNmZW5jZS13YWl0LSVzIiwKIAkJCQkJZS0+ZXhlY19pZCA9PSAwID8gImJhc2ljLSIg
OiAiIiwKIAkJCQkJZS0+bmFtZSkgewotCQkJCWdlbV9yZXF1aXJlX3JpbmcoaTkxNSwgZS0+ZXhl
Y19pZCB8IGUtPmZsYWdzKTsKLQkJCQlpZ3RfcmVxdWlyZShnZW1fY2FuX3N0b3JlX2R3b3JkKGk5
MTUsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncykpOworCQkJCWdlbV9yZXF1aXJlX3JpbmcoaTkxNSwg
ZWJfcmluZyhlKSk7CisJCQkJaWd0X3JlcXVpcmUoZ2VtX2Nhbl9zdG9yZV9kd29yZChpOTE1LCBl
Yl9yaW5nKGUpKSk7CiAKIAkJCQlnZW1fcXVpZXNjZW50X2dwdShpOTE1KTsKIAkJCQl0ZXN0X2Zl
bmNlX3dhaXQoaTkxNSwgdmdlbSwgZS0+ZXhlY19pZCwgZS0+ZmxhZ3MpOwotLSAKMi4yNC4wLnJj
MQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwt
Z2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8v
bGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

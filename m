Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 4E61A11EA89
	for <lists+intel-gfx@lfdr.de>; Fri, 13 Dec 2019 19:38:39 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9C8236EC17;
	Fri, 13 Dec 2019 18:38:37 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from 2.mo179.mail-out.ovh.net (2.mo179.mail-out.ovh.net
 [178.33.250.45])
 by gabe.freedesktop.org (Postfix) with ESMTPS id CC73C6EC17
 for <intel-gfx@lists.freedesktop.org>; Fri, 13 Dec 2019 18:38:35 +0000 (UTC)
Received: from player735.ha.ovh.net (unknown [10.108.35.90])
 by mo179.mail-out.ovh.net (Postfix) with ESMTP id 64AE81529AF
 for <intel-gfx@lists.freedesktop.org>; Fri, 13 Dec 2019 19:38:34 +0100 (CET)
Received: from etezian.org (net-37-116-49-191.cust.vodafonedsl.it
 [37.116.49.191]) (Authenticated sender: andi@etezian.org)
 by player735.ha.ovh.net (Postfix) with ESMTPSA id 4D82DD337194;
 Fri, 13 Dec 2019 18:38:29 +0000 (UTC)
From: Andi Shyti <andi@etezian.org>
To: Intel GFX <intel-gfx@lists.freedesktop.org>
Date: Fri, 13 Dec 2019 20:37:36 +0200
Message-Id: <20191213183736.31992-3-andi@etezian.org>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191213183736.31992-1-andi@etezian.org>
References: <20191213183736.31992-1-andi@etezian.org>
MIME-Version: 1.0
X-Ovh-Tracer-Id: 15756406248115126877
X-VR-SPAMSTATE: OK
X-VR-SPAMSCORE: -100
X-VR-SPAMCAUSE: gggruggvucftvghtrhhoucdtuddrgedufedrudelledgudduhecutefuodetggdotefrodftvfcurfhrohhfihhlvgemucfqggfjpdevjffgvefmvefgnecuuegrihhlohhuthemucehtddtnecusecvtfgvtghiphhivghnthhsucdlqddutddtmdenucfjughrpefhvffufffkofgjfhggtgfgsehtkeertdertdejnecuhfhrohhmpeetnhguihcuufhhhihtihcuoegrnhguihesvghtvgiiihgrnhdrohhrgheqnecukfhppedtrddtrddtrddtpdefjedrudduiedrgeelrdduledunecurfgrrhgrmhepmhhouggvpehsmhhtphdqohhuthdphhgvlhhopehplhgrhigvrhejfeehrdhhrgdrohhvhhdrnhgvthdpihhnvghtpedtrddtrddtrddtpdhmrghilhhfrhhomheprghnughisegvthgviihirghnrdhorhhgpdhrtghpthhtohepihhnthgvlhdqghhfgieslhhishhtshdrfhhrvggvuggvshhkthhophdrohhrghenucevlhhushhtvghrufhiiigvpedt
Subject: [Intel-gfx] [PATCH v4 2/2] drm/i915/gt: Move power management debug
 files into a gt aware debugfs
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogQW5kaSBTaHl0aSA8YW5kaS5zaHl0aUBpbnRlbC5jb20+CgpUaGUgR1Qgc3lzdGVtIGlz
IGJlY29taW5nIG1vcmUgYW5kIG1vcmUgYSBzdGFuZC1hbG9uZSBzeXN0ZW0gaW4KaTkxNSBhbmQg
aXQncyBmYWlyIHRvIGFzc2lnbiBpdCBpdHMgb3duIGRlYnVnZnMgZGlyZWN0b3J5LgoKcmM2LCBy
cHMgYW5kIGxsYyBkZWJ1Z2ZzIGZpbGVzIGFyZSBndCByZWxhdGVkLCBtb3ZlIHRoZW0gaW50byB0
aGUKZ3QgZGVidWdmcyBkaXJlY3RvcnkuCgpTaWduZWQtb2ZmLWJ5OiBBbmRpIFNoeXRpIDxhbmRp
LnNoeXRpQGludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZSAgICAg
ICAgfCAgIDIgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19ndC5jIHwgIDIyICsK
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2RlYnVnZnNfZ3QuaCB8ICAyNiArKwogZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvZGVidWdmc19wbS5jIHwgNjIzICsrKysrKysrKysrKysrKysrKysrKysr
KysrKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19wbS5oIHwgIDE2ICsKIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jICB8IDU3OSArLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tCiA2IGZpbGVzIGNoYW5nZWQsIDY5OCBpbnNlcnRpb25zKCspLCA1NzAgZGVsZXRpb25z
KC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19n
dC5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19n
dC5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19w
bS5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19w
bS5oCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9NYWtlZmlsZQppbmRleCBlMGZkMTBjMGNmYjguLjhmNmNkZmQwOGFjOCAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvTWFrZWZpbGUKQEAgLTc1LDYgKzc1LDggQEAgaTkxNS0kKENPTkZJR19QRVJG
X0VWRU5UUykgKz0gaTkxNV9wbXUubwogIyAiR3JhcGhpY3MgVGVjaG5vbG9neSIgKGFrYSB3ZSB0
YWxrIHRvIHRoZSBncHUpCiBvYmoteSArPSBndC8KIGd0LXkgKz0gXAorCWd0L2RlYnVnZnNfZ3Qu
byBcCisJZ3QvZGVidWdmc19wbS5vIFwKIAlndC9pbnRlbF9icmVhZGNydW1icy5vIFwKIAlndC9p
bnRlbF9jb250ZXh0Lm8gXAogCWd0L2ludGVsX2VuZ2luZV9jcy5vIFwKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2RlYnVnZnNfZ3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2RlYnVnZnNfZ3QuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAu
LjNjOWRjZTFjYzIxMgotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2RlYnVnZnNfZ3QuYwpAQCAtMCwwICsxLDIyIEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmll
cjogTUlUICovCisvKgorICogQ29weXJpZ2h0IMKpIDIwMTkgSW50ZWwgQ29ycG9yYXRpb24KKyAq
LworCisjaW5jbHVkZSAiZGVidWdmc19wbS5oIgorI2luY2x1ZGUgImk5MTVfdHJhY2UuaCIKKwor
aW50IGRlYnVnZnNfZ3RfaW5pdChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQoreworCXN0cnVjdCBkZW50
cnkgKmRlYnVnZnNfcm9vdCA9IGd0LT5pOTE1LT5kcm0ucHJpbWFyeS0+ZGVidWdmc19yb290Owor
CXN0cnVjdCBkZW50cnkgKmd0X3Jvb3Q7CisKKwlpZiAoIWRlYnVnZnNfcm9vdCkKKwkJcmV0dXJu
IC1FTk9ERVY7CisKKwlndF9yb290ID0gZGVidWdmc19jcmVhdGVfZGlyKCJndCIsIGRlYnVnZnNf
cm9vdCk7CisJaWYgKElTX0VSUihndF9yb290KSkKKwkJcmV0dXJuIFBUUl9FUlIoZ3Rfcm9vdCk7
CisKKwlyZXR1cm4gaW50ZWxfZ3RfcG1fZGVidWdmc19yZWdpc3RlcihndCwgZ3Rfcm9vdCk7Cit9
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX2d0LmggYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX2d0LmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5k
ZXggMDAwMDAwMDAwMDAwLi5jYWM1YTM1MDM0NTkKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX2d0LmgKQEAgLTAsMCArMSwyNiBAQAorLyogU1BEWC1M
aWNlbnNlLUlkZW50aWZpZXI6IE1JVCAqLworLyoKKyAqIENvcHlyaWdodCDCqSAyMDE5IEludGVs
IENvcnBvcmF0aW9uCisgKi8KKworI2lmbmRlZiBERUJVR0ZTX0dUCisjZGVmaW5lIERFQlVHRlNf
R1QKKworI2luY2x1ZGUgImludGVsX2d0X3R5cGVzLmgiCisKKyNkZWZpbmUgREVGSU5FX0dUX0RF
QlVHRlNfQVRUUklCVVRFKF9fbmFtZSkJCQkJXAorc3RhdGljIGludCBfX25hbWUgIyMgX29wZW4o
c3RydWN0IGlub2RlICppbm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpCVwKK3sJCQkJCQkJCQlcCisJ
cmV0dXJuIHNpbmdsZV9vcGVuKGZpbGUsIF9fbmFtZSAjIyBfc2hvdywgaW5vZGUtPmlfcHJpdmF0
ZSk7CVwKK30JCQkJCQkJCQlcCitzdGF0aWMgY29uc3Qgc3RydWN0IGZpbGVfb3BlcmF0aW9ucyBf
X25hbWUgIyMgX2ZvcHMgPSB7CQkJXAorCS5vd25lciA9IFRISVNfTU9EVUxFLAkJCQkJCVwKKwku
b3BlbiA9IF9fbmFtZSAjIyBfb3BlbiwJCQkJCVwKKwkucmVhZCA9IHNlcV9yZWFkLAkJCQkJCVwK
KwkubGxzZWVrID0gc2VxX2xzZWVrLAkJCQkJCVwKKwkucmVsZWFzZSA9IHNpbmdsZV9yZWxlYXNl
LAkJCQkJXAorfQorCitpbnQgZGVidWdmc19ndF9pbml0KHN0cnVjdCBpbnRlbF9ndCAqZ3QpOwor
CisjZW5kaWYgLyogREVCVUdGU19HVCAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvZGVidWdmc19wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19wbS5j
Cm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uYWNjZjgyMzQzODVjCi0t
LSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19wbS5jCkBA
IC0wLDAgKzEsNjIzIEBACisvKgorICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAorICoK
KyAqIENvcHlyaWdodCDCqSAyMDE5IEludGVsIENvcnBvcmF0aW9uCisgKi8KKworI2luY2x1ZGUg
ImRlYnVnZnNfcG0uaCIKKyNpbmNsdWRlICJkZWJ1Z2ZzX2d0LmgiCisjaW5jbHVkZSAiaTkxNV9k
ZWJ1Z2ZzLmgiCisjaW5jbHVkZSAiaTkxNV90cmFjZS5oIgorI2luY2x1ZGUgImludGVsX3JjNi5o
IgorI2luY2x1ZGUgImludGVsX3Jwcy5oIgorI2luY2x1ZGUgImludGVsX3NpZGViYW5kLmgiCisK
K3N0YXRpYyBpbnQgZm9yY2V3YWtlX2RvbWFpbnNfc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZv
aWQgKmRhdGEpCit7CisJc3RydWN0IGludGVsX2d0ICpndCA9IG0tPnByaXZhdGU7CisJc3RydWN0
IGludGVsX3VuY29yZSAqdW5jb3JlID0gZ3QtPnVuY29yZTsKKwlzdHJ1Y3QgaW50ZWxfdW5jb3Jl
X2ZvcmNld2FrZV9kb21haW4gKmZ3X2RvbWFpbjsKKwl1bnNpZ25lZCBpbnQgdG1wOworCisJc2Vx
X3ByaW50ZihtLCAidXNlci5ieXBhc3NfY291bnQgPSAldVxuIiwKKwkJICAgdW5jb3JlLT51c2Vy
X2ZvcmNld2FrZV9jb3VudCk7CisKKwlmb3JfZWFjaF9md19kb21haW4oZndfZG9tYWluLCB1bmNv
cmUsIHRtcCkKKwkJc2VxX3ByaW50ZihtLCAiJXMud2FrZV9jb3VudCA9ICV1XG4iLAorCQkJICAg
aW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9kb21haW5fdG9fc3RyKGZ3X2RvbWFpbi0+aWQpLAorCQkJ
ICAgUkVBRF9PTkNFKGZ3X2RvbWFpbi0+d2FrZV9jb3VudCkpOworCisJcmV0dXJuIDA7Cit9CitE
RUZJTkVfR1RfREVCVUdGU19BVFRSSUJVVEUoZm9yY2V3YWtlX2RvbWFpbnMpOworCitzdGF0aWMg
dm9pZCBwcmludF9yYzZfcmVzKHN0cnVjdCBzZXFfZmlsZSAqbSwKKwkJCSAgY29uc3QgY2hhciAq
dGl0bGUsCisJCQkgIGNvbnN0IGk5MTVfcmVnX3QgcmVnKQoreworCXN0cnVjdCBpbnRlbF9ndCAq
Z3QgPSBtLT5wcml2YXRlOworCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOworCisJd2l0aF9pbnRl
bF9ydW50aW1lX3BtKGd0LT51bmNvcmUtPnJwbSwgd2FrZXJlZikKKwkJc2VxX3ByaW50ZihtLCAi
JXMgJXUgKCVsbHUgdXMpXG4iLCB0aXRsZSwKKwkJCSAgIGludGVsX3VuY29yZV9yZWFkKGd0LT51
bmNvcmUsIHJlZyksCisJCQkgICBpbnRlbF9yYzZfcmVzaWRlbmN5X3VzKCZndC0+cmM2LCByZWcp
KTsKK30KKworc3RhdGljIGludCB2bHZfZHJwY19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSkKK3sK
KwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gbS0+cHJpdmF0ZTsKKwlzdHJ1Y3QgaW50ZWxfdW5jb3Jl
ICp1bmNvcmUgPSBndC0+dW5jb3JlOworCXUzMiByY2N0bDEsIHB3X3N0YXR1czsKKworCXB3X3N0
YXR1cyA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgVkxWX0dUTENfUFdfU1RBVFVTKTsKKwly
Y2N0bDEgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUkNfQ09OVFJPTCk7CisKKwlz
ZXFfcHJpbnRmKG0sICJSQzYgRW5hYmxlZDogJXNcbiIsCisJCSAgIHllc25vKHJjY3RsMSAmIChH
RU43X1JDX0NUTF9UT19NT0RFIHwKKwkJCQkJR0VONl9SQ19DVExfRUlfTU9ERSgxKSkpKTsKKwlz
ZXFfcHJpbnRmKG0sICJSZW5kZXIgUG93ZXIgV2VsbDogJXNcbiIsCisJCSAgIChwd19zdGF0dXMg
JiBWTFZfR1RMQ19QV19SRU5ERVJfU1RBVFVTX01BU0spID8gIlVwIiA6ICJEb3duIik7CisJc2Vx
X3ByaW50ZihtLCAiTWVkaWEgUG93ZXIgV2VsbDogJXNcbiIsCisJCSAgIChwd19zdGF0dXMgJiBW
TFZfR1RMQ19QV19NRURJQV9TVEFUVVNfTUFTSykgPyAiVXAiIDogIkRvd24iKTsKKworCXByaW50
X3JjNl9yZXMobSwgIlJlbmRlciBSQzYgcmVzaWRlbmN5IHNpbmNlIGJvb3Q6IiwgVkxWX0dUX1JF
TkRFUl9SQzYpOworCXByaW50X3JjNl9yZXMobSwgIk1lZGlhIFJDNiByZXNpZGVuY3kgc2luY2Ug
Ym9vdDoiLCBWTFZfR1RfTUVESUFfUkM2KTsKKworCXJldHVybiBmb3JjZXdha2VfZG9tYWluc19z
aG93KG0sIE5VTEwpOworfQorCitzdGF0aWMgaW50IGdlbjZfZHJwY19pbmZvKHN0cnVjdCBzZXFf
ZmlsZSAqbSkKK3sKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gbS0+cHJpdmF0ZTsKKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd0LT5pOTE1OworCXN0cnVjdCBpbnRlbF91bmNvcmUg
KnVuY29yZSA9IGd0LT51bmNvcmU7CisJdTMyIGd0X2NvcmVfc3RhdHVzLCByY2N0bDEsIHJjNnZp
ZHMgPSAwOworCXUzMiBnZW45X3Bvd2VyZ2F0ZV9lbmFibGUgPSAwLCBnZW45X3Bvd2VyZ2F0ZV9z
dGF0dXMgPSAwOworCisJZ3RfY29yZV9zdGF0dXMgPSBpbnRlbF91bmNvcmVfcmVhZF9mdyh1bmNv
cmUsIEdFTjZfR1RfQ09SRV9TVEFUVVMpOworCXRyYWNlX2k5MTVfcmVnX3J3KGZhbHNlLCBHRU42
X0dUX0NPUkVfU1RBVFVTLCBndF9jb3JlX3N0YXR1cywgNCwgdHJ1ZSk7CisKKwlyY2N0bDEgPSBp
bnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUkNfQ09OVFJPTCk7CisJaWYgKElOVEVMX0dF
TihpOTE1KSA+PSA5KSB7CisJCWdlbjlfcG93ZXJnYXRlX2VuYWJsZSA9IGludGVsX3VuY29yZV9y
ZWFkKHVuY29yZSwKKwkJCQkJCUdFTjlfUEdfRU5BQkxFKTsKKwkJZ2VuOV9wb3dlcmdhdGVfc3Rh
dHVzID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLAorCQkJCQkJR0VOOV9QV1JHVF9ET01BSU5f
U1RBVFVTKTsKKwl9CisKKwlpZiAoSU5URUxfR0VOKGk5MTUpIDw9IDcpCisJCXNhbmR5YnJpZGdl
X3Bjb2RlX3JlYWQoaTkxNSwgR0VONl9QQ09ERV9SRUFEX1JDNlZJRFMsCisJCQkJICAgICAgICZy
YzZ2aWRzLCBOVUxMKTsKKworCXNlcV9wcmludGYobSwgIlJDMWUgRW5hYmxlZDogJXNcbiIsCisJ
CSAgIHllc25vKHJjY3RsMSAmIEdFTjZfUkNfQ1RMX1JDMWVfRU5BQkxFKSk7CisJc2VxX3ByaW50
ZihtLCAiUkM2IEVuYWJsZWQ6ICVzXG4iLAorCQkgICB5ZXNubyhyY2N0bDEgJiBHRU42X1JDX0NU
TF9SQzZfRU5BQkxFKSk7CisJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KSB7CisJCXNlcV9wcmlu
dGYobSwgIlJlbmRlciBXZWxsIEdhdGluZyBFbmFibGVkOiAlc1xuIiwKKwkJCXllc25vKGdlbjlf
cG93ZXJnYXRlX2VuYWJsZSAmIEdFTjlfUkVOREVSX1BHX0VOQUJMRSkpOworCQlzZXFfcHJpbnRm
KG0sICJNZWRpYSBXZWxsIEdhdGluZyBFbmFibGVkOiAlc1xuIiwKKwkJCXllc25vKGdlbjlfcG93
ZXJnYXRlX2VuYWJsZSAmIEdFTjlfTUVESUFfUEdfRU5BQkxFKSk7CisJfQorCXNlcV9wcmludGYo
bSwgIkRlZXAgUkM2IEVuYWJsZWQ6ICVzXG4iLAorCQkgICB5ZXNubyhyY2N0bDEgJiBHRU42X1JD
X0NUTF9SQzZwX0VOQUJMRSkpOworCXNlcV9wcmludGYobSwgIkRlZXBlc3QgUkM2IEVuYWJsZWQ6
ICVzXG4iLAorCQkgICB5ZXNubyhyY2N0bDEgJiBHRU42X1JDX0NUTF9SQzZwcF9FTkFCTEUpKTsK
KwlzZXFfcHV0cyhtLCAiQ3VycmVudCBSQyBzdGF0ZTogIik7CisJc3dpdGNoIChndF9jb3JlX3N0
YXR1cyAmIEdFTjZfUkNuX01BU0spIHsKKwljYXNlIEdFTjZfUkMwOgorCQlpZiAoZ3RfY29yZV9z
dGF0dXMgJiBHRU42X0NPUkVfQ1BEX1NUQVRFX01BU0spCisJCQlzZXFfcHV0cyhtLCAiQ29yZSBQ
b3dlciBEb3duXG4iKTsKKwkJZWxzZQorCQkJc2VxX3B1dHMobSwgIm9uXG4iKTsKKwkJYnJlYWs7
CisJY2FzZSBHRU42X1JDMzoKKwkJc2VxX3B1dHMobSwgIlJDM1xuIik7CisJCWJyZWFrOworCWNh
c2UgR0VONl9SQzY6CisJCXNlcV9wdXRzKG0sICJSQzZcbiIpOworCQlicmVhazsKKwljYXNlIEdF
TjZfUkM3OgorCQlzZXFfcHV0cyhtLCAiUkM3XG4iKTsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJ
c2VxX3B1dHMobSwgIlVua25vd25cbiIpOworCQlicmVhazsKKwl9CisKKwlzZXFfcHJpbnRmKG0s
ICJDb3JlIFBvd2VyIERvd246ICVzXG4iLAorCQkgICB5ZXNubyhndF9jb3JlX3N0YXR1cyAmIEdF
TjZfQ09SRV9DUERfU1RBVEVfTUFTSykpOworCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkgewor
CQlzZXFfcHJpbnRmKG0sICJSZW5kZXIgUG93ZXIgV2VsbDogJXNcbiIsCisJCQkoZ2VuOV9wb3dl
cmdhdGVfc3RhdHVzICYKKwkJCSBHRU45X1BXUkdUX1JFTkRFUl9TVEFUVVNfTUFTSykgPyAiVXAi
IDogIkRvd24iKTsKKwkJc2VxX3ByaW50ZihtLCAiTWVkaWEgUG93ZXIgV2VsbDogJXNcbiIsCisJ
CQkoZ2VuOV9wb3dlcmdhdGVfc3RhdHVzICYKKwkJCSBHRU45X1BXUkdUX01FRElBX1NUQVRVU19N
QVNLKSA/ICJVcCIgOiAiRG93biIpOworCX0KKworCS8qIE5vdCBleGFjdGx5IHN1cmUgd2hhdCB0
aGlzIGlzICovCisJcHJpbnRfcmM2X3JlcyhtLCAiUkM2IFwiTG9ja2VkIHRvIFJQblwiIHJlc2lk
ZW5jeSBzaW5jZSBib290OiIsCisJCSAgICAgIEdFTjZfR1RfR0ZYX1JDNl9MT0NLRUQpOworCXBy
aW50X3JjNl9yZXMobSwgIlJDNiByZXNpZGVuY3kgc2luY2UgYm9vdDoiLCBHRU42X0dUX0dGWF9S
QzYpOworCXByaW50X3JjNl9yZXMobSwgIlJDNisgcmVzaWRlbmN5IHNpbmNlIGJvb3Q6IiwgR0VO
Nl9HVF9HRlhfUkM2cCk7CisJcHJpbnRfcmM2X3JlcyhtLCAiUkM2KysgcmVzaWRlbmN5IHNpbmNl
IGJvb3Q6IiwgR0VONl9HVF9HRlhfUkM2cHApOworCisJaWYgKElOVEVMX0dFTihpOTE1KSA8PSA3
KSB7CisJCXNlcV9wcmludGYobSwgIlJDNiAgIHZvbHRhZ2U6ICVkbVZcbiIsCisJCQkgICBHRU42
X0RFQ09ERV9SQzZfVklEKCgocmM2dmlkcyA+PiAwKSAmIDB4ZmYpKSk7CisJCXNlcV9wcmludGYo
bSwgIlJDNisgIHZvbHRhZ2U6ICVkbVZcbiIsCisJCQkgICBHRU42X0RFQ09ERV9SQzZfVklEKCgo
cmM2dmlkcyA+PiA4KSAmIDB4ZmYpKSk7CisJCXNlcV9wcmludGYobSwgIlJDNisrIHZvbHRhZ2U6
ICVkbVZcbiIsCisJCQkgICBHRU42X0RFQ09ERV9SQzZfVklEKCgocmM2dmlkcyA+PiAxNikgJiAw
eGZmKSkpOworCX0KKworCXJldHVybiBmb3JjZXdha2VfZG9tYWluc19zaG93KG0sIE5VTEwpOwor
fQorCitzdGF0aWMgaW50IGlyb25sYWtlX2RycGNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0pCit7
CisJc3RydWN0IGludGVsX2d0ICpndCA9IG0tPnByaXZhdGU7CisJc3RydWN0IGludGVsX3VuY29y
ZSAqdW5jb3JlID0gZ3QtPnVuY29yZTsKKwl1MzIgcmd2bW9kZWN0bCwgcnN0ZGJ5Y3RsOworCXUx
NiBjcnN0YW5kdmlkOworCisJcmd2bW9kZWN0bCA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwg
TUVNTU9ERUNUTCk7CisJcnN0ZGJ5Y3RsID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBSU1RE
QllDVEwpOworCWNyc3RhbmR2aWQgPSBpbnRlbF91bmNvcmVfcmVhZDE2KHVuY29yZSwgQ1JTVEFO
RFZJRCk7CisKKwlzZXFfcHJpbnRmKG0sICJIRCBib29zdDogJXNcbiIsIHllc25vKHJndm1vZGVj
dGwgJiBNRU1NT0RFX0JPT1NUX0VOKSk7CisJc2VxX3ByaW50ZihtLCAiQm9vc3QgZnJlcTogJWRc
biIsCisJCSAgIChyZ3Ztb2RlY3RsICYgTUVNTU9ERV9CT09TVF9GUkVRX01BU0spID4+CisJCSAg
IE1FTU1PREVfQk9PU1RfRlJFUV9TSElGVCk7CisJc2VxX3ByaW50ZihtLCAiSFcgY29udHJvbCBl
bmFibGVkOiAlc1xuIiwKKwkJICAgeWVzbm8ocmd2bW9kZWN0bCAmIE1FTU1PREVfSFdJRExFX0VO
KSk7CisJc2VxX3ByaW50ZihtLCAiU1cgY29udHJvbCBlbmFibGVkOiAlc1xuIiwKKwkJICAgeWVz
bm8ocmd2bW9kZWN0bCAmIE1FTU1PREVfU1dNT0RFX0VOKSk7CisJc2VxX3ByaW50ZihtLCAiR2F0
ZWQgdm9sdGFnZSBjaGFuZ2U6ICVzXG4iLAorCQkgICB5ZXNubyhyZ3Ztb2RlY3RsICYgTUVNTU9E
RV9SQ0xLX0dBVEUpKTsKKwlzZXFfcHJpbnRmKG0sICJTdGFydGluZyBmcmVxdWVuY3k6IFAlZFxu
IiwKKwkJICAgKHJndm1vZGVjdGwgJiBNRU1NT0RFX0ZTVEFSVF9NQVNLKSA+PiBNRU1NT0RFX0ZT
VEFSVF9TSElGVCk7CisJc2VxX3ByaW50ZihtLCAiTWF4IFAtc3RhdGU6IFAlZFxuIiwKKwkJICAg
KHJndm1vZGVjdGwgJiBNRU1NT0RFX0ZNQVhfTUFTSykgPj4gTUVNTU9ERV9GTUFYX1NISUZUKTsK
KwlzZXFfcHJpbnRmKG0sICJNaW4gUC1zdGF0ZTogUCVkXG4iLCAocmd2bW9kZWN0bCAmIE1FTU1P
REVfRk1JTl9NQVNLKSk7CisJc2VxX3ByaW50ZihtLCAiUlMxIFZJRDogJWRcbiIsIChjcnN0YW5k
dmlkICYgMHgzZikpOworCXNlcV9wcmludGYobSwgIlJTMiBWSUQ6ICVkXG4iLCAoKGNyc3RhbmR2
aWQgPj4gOCkgJiAweDNmKSk7CisJc2VxX3ByaW50ZihtLCAiUmVuZGVyIHN0YW5kYnkgZW5hYmxl
ZDogJXNcbiIsCisJCSAgIHllc25vKCEocnN0ZGJ5Y3RsICYgUkNYX1NXX0VYSVQpKSk7CisJc2Vx
X3B1dHMobSwgIkN1cnJlbnQgUlMgc3RhdGU6ICIpOworCXN3aXRjaCAocnN0ZGJ5Y3RsICYgUlNY
X1NUQVRVU19NQVNLKSB7CisJY2FzZSBSU1hfU1RBVFVTX09OOgorCQlzZXFfcHV0cyhtLCAib25c
biIpOworCQlicmVhazsKKwljYXNlIFJTWF9TVEFUVVNfUkMxOgorCQlzZXFfcHV0cyhtLCAiUkMx
XG4iKTsKKwkJYnJlYWs7CisJY2FzZSBSU1hfU1RBVFVTX1JDMUU6CisJCXNlcV9wdXRzKG0sICJS
QzFFXG4iKTsKKwkJYnJlYWs7CisJY2FzZSBSU1hfU1RBVFVTX1JTMToKKwkJc2VxX3B1dHMobSwg
IlJTMVxuIik7CisJCWJyZWFrOworCWNhc2UgUlNYX1NUQVRVU19SUzI6CisJCXNlcV9wdXRzKG0s
ICJSUzIgKFJDNilcbiIpOworCQlicmVhazsKKwljYXNlIFJTWF9TVEFUVVNfUlMzOgorCQlzZXFf
cHV0cyhtLCAiUkMzIChSQzYrKVxuIik7CisJCWJyZWFrOworCWRlZmF1bHQ6CisJCXNlcV9wdXRz
KG0sICJ1bmtub3duXG4iKTsKKwkJYnJlYWs7CisJfQorCisJcmV0dXJuIDA7Cit9CisKK3N0YXRp
YyBpbnQgZHJwY19pbmZvX3Nob3coc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCit7
CisJc3RydWN0IGludGVsX2d0ICpndCA9IG0tPnByaXZhdGU7CisJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSBndC0+aTkxNTsKKwlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKKwlpbnQg
ZXJyID0gLUVOT0RFVjsKKworCXdpdGhfaW50ZWxfcnVudGltZV9wbShndC0+dW5jb3JlLT5ycG0s
IHdha2VyZWYpIHsKKwkJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhp
OTE1KSkKKwkJCWVyciA9IHZsdl9kcnBjX2luZm8obSk7CisJCWVsc2UgaWYgKElOVEVMX0dFTihp
OTE1KSA+PSA2KQorCQkJZXJyID0gZ2VuNl9kcnBjX2luZm8obSk7CisJCWVsc2UKKwkJCWVyciA9
IGlyb25sYWtlX2RycGNfaW5mbyhtKTsKKwl9CisKKwlyZXR1cm4gZXJyOworfQorREVGSU5FX0dU
X0RFQlVHRlNfQVRUUklCVVRFKGRycGNfaW5mbyk7CisKK3N0YXRpYyBpbnQgZnJlcXVlbmN5X2lu
Zm9fc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKK3sKKwlzdHJ1Y3QgaW50
ZWxfZ3QgKmd0ID0gbS0+cHJpdmF0ZTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IGd0LT5pOTE1OworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IGd0LT51bmNvcmU7CisJ
c3RydWN0IGludGVsX3JwcyAqcnBzID0gJmd0LT5ycHM7CisJaW50ZWxfd2FrZXJlZl90IHdha2Vy
ZWY7CisKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQodW5jb3JlLT5ycG0pOworCisJ
aWYgKElTX0dFTihpOTE1LCA1KSkgeworCQl1MTYgcmd2c3djdGwgPSBpbnRlbF91bmNvcmVfcmVh
ZDE2KHVuY29yZSwgTUVNU1dDVEwpOworCQl1MTYgcmd2c3RhdCA9IGludGVsX3VuY29yZV9yZWFk
MTYodW5jb3JlLCBNRU1TVEFUX0lMSyk7CisKKwkJc2VxX3ByaW50ZihtLCAiUmVxdWVzdGVkIFAt
c3RhdGU6ICVkXG4iLCAocmd2c3djdGwgPj4gOCkgJiAweGYpOworCQlzZXFfcHJpbnRmKG0sICJS
ZXF1ZXN0ZWQgVklEOiAlZFxuIiwgcmd2c3djdGwgJiAweDNmKTsKKwkJc2VxX3ByaW50ZihtLCAi
Q3VycmVudCBWSUQ6ICVkXG4iLCAocmd2c3RhdCAmIE1FTVNUQVRfVklEX01BU0spID4+CisJCQkg
ICBNRU1TVEFUX1ZJRF9TSElGVCk7CisJCXNlcV9wcmludGYobSwgIkN1cnJlbnQgUC1zdGF0ZTog
JWRcbiIsCisJCQkgICAocmd2c3RhdCAmIE1FTVNUQVRfUFNUQVRFX01BU0spID4+IE1FTVNUQVRf
UFNUQVRFX1NISUZUKTsKKwl9IGVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hF
UlJZVklFVyhpOTE1KSkgeworCQl1MzIgcnBtb2RlY3RsLCBmcmVxX3N0czsKKworCQlycG1vZGVj
dGwgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUlBfQ09OVFJPTCk7CisJCXNlcV9w
cmludGYobSwgIlZpZGVvIFR1cmJvIE1vZGU6ICVzXG4iLAorCQkJICAgeWVzbm8ocnBtb2RlY3Rs
ICYgR0VONl9SUF9NRURJQV9UVVJCTykpOworCQlzZXFfcHJpbnRmKG0sICJIVyBjb250cm9sIGVu
YWJsZWQ6ICVzXG4iLAorCQkJICAgeWVzbm8ocnBtb2RlY3RsICYgR0VONl9SUF9FTkFCTEUpKTsK
KwkJc2VxX3ByaW50ZihtLCAiU1cgY29udHJvbCBlbmFibGVkOiAlc1xuIiwKKwkJCSAgIHllc25v
KChycG1vZGVjdGwgJiBHRU42X1JQX01FRElBX01PREVfTUFTSykgPT0KKwkJCQkgIEdFTjZfUlBf
TUVESUFfU1dfTU9ERSkpOworCisJCXZsdl9wdW5pdF9nZXQoaTkxNSk7CisJCWZyZXFfc3RzID0g
dmx2X3B1bml0X3JlYWQoaTkxNSwgUFVOSVRfUkVHX0dQVV9GUkVRX1NUUyk7CisJCXZsdl9wdW5p
dF9wdXQoaTkxNSk7CisKKwkJc2VxX3ByaW50ZihtLCAiUFVOSVRfUkVHX0dQVV9GUkVRX1NUUzog
MHglMDh4XG4iLCBmcmVxX3N0cyk7CisJCXNlcV9wcmludGYobSwgIkREUiBmcmVxOiAlZCBNSHpc
biIsIGk5MTUtPm1lbV9mcmVxKTsKKworCQlzZXFfcHJpbnRmKG0sICJhY3R1YWwgR1BVIGZyZXE6
ICVkIE1IelxuIiwKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgKGZyZXFfc3RzID4+IDgpICYg
MHhmZikpOworCisJCXNlcV9wcmludGYobSwgImN1cnJlbnQgR1BVIGZyZXE6ICVkIE1IelxuIiwK
KwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5jdXJfZnJlcSkpOworCisJCXNlcV9wcmlu
dGYobSwgIm1heCBHUFUgZnJlcTogJWQgTUh6XG4iLAorCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBz
LCBycHMtPm1heF9mcmVxKSk7CisKKwkJc2VxX3ByaW50ZihtLCAibWluIEdQVSBmcmVxOiAlZCBN
SHpcbiIsCisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWluX2ZyZXEpKTsKKworCQlz
ZXFfcHJpbnRmKG0sICJpZGxlIEdQVSBmcmVxOiAlZCBNSHpcbiIsCisJCQkgICBpbnRlbF9ncHVf
ZnJlcShycHMsIHJwcy0+aWRsZV9mcmVxKSk7CisKKwkJc2VxX3ByaW50ZihtLCAiZWZmaWNpZW50
IChSUGUpIGZyZXF1ZW5jeTogJWQgTUh6XG4iLAorCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBy
cHMtPmVmZmljaWVudF9mcmVxKSk7CisJfSBlbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNikg
eworCQl1MzIgcnBfc3RhdGVfbGltaXRzOworCQl1MzIgZ3RfcGVyZl9zdGF0dXM7CisJCXUzMiBy
cF9zdGF0ZV9jYXA7CisJCXUzMiBycG1vZGVjdGwsIHJwaW5jbGltaXQsIHJwZGVjbGltaXQ7CisJ
CXUzMiBycHN0YXQsIGNhZ2YsIHJlcWY7CisJCXUzMiBycHVwZWksIHJwY3VydXAsIHJwcHJldnVw
OworCQl1MzIgcnBkb3duZWksIHJwY3VyZG93biwgcnBwcmV2ZG93bjsKKwkJdTMyIHBtX2llciwg
cG1faW1yLCBwbV9pc3IsIHBtX2lpciwgcG1fbWFzazsKKwkJaW50IG1heF9mcmVxOworCisJCXJw
X3N0YXRlX2xpbWl0cyA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VONl9SUF9TVEFURV9M
SU1JVFMpOworCQlpZiAoSVNfR0VOOV9MUChpOTE1KSkgeworCQkJcnBfc3RhdGVfY2FwID0gaW50
ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBCWFRfUlBfU1RBVEVfQ0FQKTsKKwkJCWd0X3BlcmZfc3Rh
dHVzID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBCWFRfR1RfUEVSRl9TVEFUVVMpOworCQl9
IGVsc2UgeworCQkJcnBfc3RhdGVfY2FwID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU42
X1JQX1NUQVRFX0NBUCk7CisJCQlndF9wZXJmX3N0YXR1cyA9IGludGVsX3VuY29yZV9yZWFkKHVu
Y29yZSwgR0VONl9HVF9QRVJGX1NUQVRVUyk7CisJCX0KKworCQkvKiBSUFNUQVQxIGlzIGluIHRo
ZSBHVCBwb3dlciB3ZWxsICovCisJCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KHVuY29yZSwg
Rk9SQ0VXQUtFX0FMTCk7CisKKwkJcmVxZiA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VO
Nl9SUE5TV1JFUSk7CisJCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkKKwkJCXJlcWYgPj49IDIz
OworCQllbHNlIHsKKwkJCXJlcWYgJj0gfkdFTjZfVFVSQk9fRElTQUJMRTsKKwkJCWlmIChJU19I
QVNXRUxMKGk5MTUpIHx8IElTX0JST0FEV0VMTChpOTE1KSkKKwkJCQlyZXFmID4+PSAyNDsKKwkJ
CWVsc2UKKwkJCQlyZXFmID4+PSAyNTsKKwkJfQorCQlyZXFmID0gaW50ZWxfZ3B1X2ZyZXEocnBz
LCByZXFmKTsKKworCQlycG1vZGVjdGwgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZf
UlBfQ09OVFJPTCk7CisJCXJwaW5jbGltaXQgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdF
TjZfUlBfVVBfVEhSRVNIT0xEKTsKKwkJcnBkZWNsaW1pdCA9IGludGVsX3VuY29yZV9yZWFkKHVu
Y29yZSwgR0VONl9SUF9ET1dOX1RIUkVTSE9MRCk7CisKKwkJcnBzdGF0ID0gaW50ZWxfdW5jb3Jl
X3JlYWQodW5jb3JlLCBHRU42X1JQU1RBVDEpOworCQlycHVwZWkgPSBpbnRlbF91bmNvcmVfcmVh
ZCh1bmNvcmUsIEdFTjZfUlBfQ1VSX1VQX0VJKSAmIEdFTjZfQ1VSSUNPTlRfTUFTSzsKKwkJcnBj
dXJ1cCA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VONl9SUF9DVVJfVVApICYgR0VONl9D
VVJCU1lUQVZHX01BU0s7CisJCXJwcHJldnVwID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBH
RU42X1JQX1BSRVZfVVApICYgR0VONl9DVVJCU1lUQVZHX01BU0s7CisJCXJwZG93bmVpID0gaW50
ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU42X1JQX0NVUl9ET1dOX0VJKSAmIEdFTjZfQ1VSSUFW
R19NQVNLOworCQlycGN1cmRvd24gPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUlBf
Q1VSX0RPV04pICYgR0VONl9DVVJCU1lUQVZHX01BU0s7CisJCXJwcHJldmRvd24gPSBpbnRlbF91
bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUlBfUFJFVl9ET1dOKSAmIEdFTjZfQ1VSQlNZVEFWR19N
QVNLOworCQljYWdmID0gaW50ZWxfcnBzX3JlYWRfYWN0dWFsX2ZyZXF1ZW5jeShycHMpOworCisJ
CWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KHVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7CisKKwkJ
aWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkgeworCQkJcG1faWVyID0gaW50ZWxfdW5jb3JlX3Jl
YWQodW5jb3JlLCBHRU4xMV9HUE1fV0dCT1hQRVJGX0lOVFJfRU5BQkxFKTsKKwkJCXBtX2ltciA9
IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VOMTFfR1BNX1dHQk9YUEVSRl9JTlRSX01BU0sp
OworCQkJLyoKKwkJCSAqIFRoZSBlcXVpdmFsZW50IHRvIHRoZSBQTSBJU1IgJiBJSVIgY2Fubm90
IGJlIHJlYWQKKwkJCSAqIHdpdGhvdXQgYWZmZWN0aW5nIHRoZSBjdXJyZW50IHN0YXRlIG9mIHRo
ZSBzeXN0ZW0KKwkJCSAqLworCQkJcG1faXNyID0gMDsKKwkJCXBtX2lpciA9IDA7CisJCX0gZWxz
ZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDgpIHsKKwkJCXBtX2llciA9IGludGVsX3VuY29yZV9y
ZWFkKHVuY29yZSwgR0VOOF9HVF9JRVIoMikpOworCQkJcG1faW1yID0gaW50ZWxfdW5jb3JlX3Jl
YWQodW5jb3JlLCBHRU44X0dUX0lNUigyKSk7CisJCQlwbV9pc3IgPSBpbnRlbF91bmNvcmVfcmVh
ZCh1bmNvcmUsIEdFTjhfR1RfSVNSKDIpKTsKKwkJCXBtX2lpciA9IGludGVsX3VuY29yZV9yZWFk
KHVuY29yZSwgR0VOOF9HVF9JSVIoMikpOworCQl9IGVsc2UgeworCQkJcG1faWVyID0gaW50ZWxf
dW5jb3JlX3JlYWQodW5jb3JlLCBHRU42X1BNSUVSKTsKKwkJCXBtX2ltciA9IGludGVsX3VuY29y
ZV9yZWFkKHVuY29yZSwgR0VONl9QTUlNUik7CisJCQlwbV9pc3IgPSBpbnRlbF91bmNvcmVfcmVh
ZCh1bmNvcmUsIEdFTjZfUE1JU1IpOworCQkJcG1faWlyID0gaW50ZWxfdW5jb3JlX3JlYWQodW5j
b3JlLCBHRU42X1BNSUlSKTsKKwkJfQorCQlwbV9tYXNrID0gaW50ZWxfdW5jb3JlX3JlYWQodW5j
b3JlLCBHRU42X1BNSU5UUk1TSyk7CisKKwkJc2VxX3ByaW50ZihtLCAiVmlkZW8gVHVyYm8gTW9k
ZTogJXNcbiIsCisJCQkgICB5ZXNubyhycG1vZGVjdGwgJiBHRU42X1JQX01FRElBX1RVUkJPKSk7
CisJCXNlcV9wcmludGYobSwgIkhXIGNvbnRyb2wgZW5hYmxlZDogJXNcbiIsCisJCQkgICB5ZXNu
byhycG1vZGVjdGwgJiBHRU42X1JQX0VOQUJMRSkpOworCQlzZXFfcHJpbnRmKG0sICJTVyBjb250
cm9sIGVuYWJsZWQ6ICVzXG4iLAorCQkJICAgeWVzbm8oKHJwbW9kZWN0bCAmIEdFTjZfUlBfTUVE
SUFfTU9ERV9NQVNLKSA9PQorCQkJCSAgR0VONl9SUF9NRURJQV9TV19NT0RFKSk7CisKKwkJc2Vx
X3ByaW50ZihtLCAiUE0gSUVSPTB4JTA4eCBJTVI9MHglMDh4LCBNQVNLPTB4JTA4eFxuIiwKKwkJ
CSAgIHBtX2llciwgcG1faW1yLCBwbV9tYXNrKTsKKwkJaWYgKElOVEVMX0dFTihpOTE1KSA8PSAx
MCkKKwkJCXNlcV9wcmludGYobSwgIlBNIElTUj0weCUwOHggSUlSPTB4JTA4eFxuIiwKKwkJCQkg
ICBwbV9pc3IsIHBtX2lpcik7CisJCXNlcV9wcmludGYobSwgInBtX2ludHJtc2tfbWJ6OiAweCUw
OHhcbiIsCisJCQkgICBycHMtPnBtX2ludHJtc2tfbWJ6KTsKKwkJc2VxX3ByaW50ZihtLCAiR1Rf
UEVSRl9TVEFUVVM6IDB4JTA4eFxuIiwgZ3RfcGVyZl9zdGF0dXMpOworCQlzZXFfcHJpbnRmKG0s
ICJSZW5kZXIgcC1zdGF0ZSByYXRpbzogJWRcbiIsCisJCQkgICAoZ3RfcGVyZl9zdGF0dXMgJiAo
SU5URUxfR0VOKGk5MTUpID49IDkgPyAweDFmZjAwIDogMHhmZjAwKSkgPj4gOCk7CisJCXNlcV9w
cmludGYobSwgIlJlbmRlciBwLXN0YXRlIFZJRDogJWRcbiIsCisJCQkgICBndF9wZXJmX3N0YXR1
cyAmIDB4ZmYpOworCQlzZXFfcHJpbnRmKG0sICJSZW5kZXIgcC1zdGF0ZSBsaW1pdDogJWRcbiIs
CisJCQkgICBycF9zdGF0ZV9saW1pdHMgJiAweGZmKTsKKwkJc2VxX3ByaW50ZihtLCAiUlBTVEFU
MTogMHglMDh4XG4iLCBycHN0YXQpOworCQlzZXFfcHJpbnRmKG0sICJSUE1PREVDVEw6IDB4JTA4
eFxuIiwgcnBtb2RlY3RsKTsKKwkJc2VxX3ByaW50ZihtLCAiUlBJTkNMSU1JVDogMHglMDh4XG4i
LCBycGluY2xpbWl0KTsKKwkJc2VxX3ByaW50ZihtLCAiUlBERUNMSU1JVDogMHglMDh4XG4iLCBy
cGRlY2xpbWl0KTsKKwkJc2VxX3ByaW50ZihtLCAiUlBOU1dSRVE6ICVkTUh6XG4iLCByZXFmKTsK
KwkJc2VxX3ByaW50ZihtLCAiQ0FHRjogJWRNSHpcbiIsIGNhZ2YpOworCQlzZXFfcHJpbnRmKG0s
ICJSUCBDVVIgVVAgRUk6ICVkICglZHVzKVxuIiwKKwkJCSAgIHJwdXBlaSwgR1RfUE1fSU5URVJW
QUxfVE9fVVMoaTkxNSwgcnB1cGVpKSk7CisJCXNlcV9wcmludGYobSwgIlJQIENVUiBVUDogJWQg
KCVkdXMpXG4iLAorCQkJICAgcnBjdXJ1cCwgR1RfUE1fSU5URVJWQUxfVE9fVVMoaTkxNSwgcnBj
dXJ1cCkpOworCQlzZXFfcHJpbnRmKG0sICJSUCBQUkVWIFVQOiAlZCAoJWR1cylcbiIsCisJCQkg
ICBycHByZXZ1cCwgR1RfUE1fSU5URVJWQUxfVE9fVVMoaTkxNSwgcnBwcmV2dXApKTsKKwkJc2Vx
X3ByaW50ZihtLCAiVXAgdGhyZXNob2xkOiAlZCUlXG4iLAorCQkJICAgcnBzLT5wb3dlci51cF90
aHJlc2hvbGQpOworCisJCXNlcV9wcmludGYobSwgIlJQIENVUiBET1dOIEVJOiAlZCAoJWR1cylc
biIsCisJCQkgICBycGRvd25laSwgR1RfUE1fSU5URVJWQUxfVE9fVVMoaTkxNSwgcnBkb3duZWkp
KTsKKwkJc2VxX3ByaW50ZihtLCAiUlAgQ1VSIERPV046ICVkICglZHVzKVxuIiwKKwkJCSAgIHJw
Y3VyZG93biwgR1RfUE1fSU5URVJWQUxfVE9fVVMoaTkxNSwgcnBjdXJkb3duKSk7CisJCXNlcV9w
cmludGYobSwgIlJQIFBSRVYgRE9XTjogJWQgKCVkdXMpXG4iLAorCQkJICAgcnBwcmV2ZG93biwg
R1RfUE1fSU5URVJWQUxfVE9fVVMoaTkxNSwgcnBwcmV2ZG93bikpOworCQlzZXFfcHJpbnRmKG0s
ICJEb3duIHRocmVzaG9sZDogJWQlJVxuIiwKKwkJCSAgIHJwcy0+cG93ZXIuZG93bl90aHJlc2hv
bGQpOworCisJCW1heF9mcmVxID0gKElTX0dFTjlfTFAoaTkxNSkgPyBycF9zdGF0ZV9jYXAgPj4g
MCA6CisJCQkgICAgcnBfc3RhdGVfY2FwID4+IDE2KSAmIDB4ZmY7CisJCW1heF9mcmVxICo9IChJ
U19HRU45X0JDKGk5MTUpIHx8CisJCQkgICAgIElOVEVMX0dFTihpOTE1KSA+PSAxMCA/IEdFTjlf
RlJFUV9TQ0FMRVIgOiAxKTsKKwkJc2VxX3ByaW50ZihtLCAiTG93ZXN0IChSUE4pIGZyZXF1ZW5j
eTogJWRNSHpcbiIsCisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIG1heF9mcmVxKSk7CisKKwkJ
bWF4X2ZyZXEgPSAocnBfc3RhdGVfY2FwICYgMHhmZjAwKSA+PiA4OworCQltYXhfZnJlcSAqPSAo
SVNfR0VOOV9CQyhpOTE1KSB8fAorCQkJICAgICBJTlRFTF9HRU4oaTkxNSkgPj0gMTAgPyBHRU45
X0ZSRVFfU0NBTEVSIDogMSk7CisJCXNlcV9wcmludGYobSwgIk5vbWluYWwgKFJQMSkgZnJlcXVl
bmN5OiAlZE1IelxuIiwKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgbWF4X2ZyZXEpKTsKKwor
CQltYXhfZnJlcSA9IChJU19HRU45X0xQKGk5MTUpID8gcnBfc3RhdGVfY2FwID4+IDE2IDoKKwkJ
CSAgICBycF9zdGF0ZV9jYXAgPj4gMCkgJiAweGZmOworCQltYXhfZnJlcSAqPSAoSVNfR0VOOV9C
QyhpOTE1KSB8fAorCQkJICAgICBJTlRFTF9HRU4oaTkxNSkgPj0gMTAgPyBHRU45X0ZSRVFfU0NB
TEVSIDogMSk7CisJCXNlcV9wcmludGYobSwgIk1heCBub24tb3ZlcmNsb2NrZWQgKFJQMCkgZnJl
cXVlbmN5OiAlZE1IelxuIiwKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgbWF4X2ZyZXEpKTsK
KwkJc2VxX3ByaW50ZihtLCAiTWF4IG92ZXJjbG9ja2VkIGZyZXF1ZW5jeTogJWRNSHpcbiIsCisJ
CQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWF4X2ZyZXEpKTsKKworCQlzZXFfcHJpbnRm
KG0sICJDdXJyZW50IGZyZXE6ICVkIE1IelxuIiwKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywg
cnBzLT5jdXJfZnJlcSkpOworCQlzZXFfcHJpbnRmKG0sICJBY3R1YWwgZnJlcTogJWQgTUh6XG4i
LCBjYWdmKTsKKwkJc2VxX3ByaW50ZihtLCAiSWRsZSBmcmVxOiAlZCBNSHpcbiIsCisJCQkgICBp
bnRlbF9ncHVfZnJlcShycHMsIHJwcy0+aWRsZV9mcmVxKSk7CisJCXNlcV9wcmludGYobSwgIk1p
biBmcmVxOiAlZCBNSHpcbiIsCisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWluX2Zy
ZXEpKTsKKwkJc2VxX3ByaW50ZihtLCAiQm9vc3QgZnJlcTogJWQgTUh6XG4iLAorCQkJICAgaW50
ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmJvb3N0X2ZyZXEpKTsKKwkJc2VxX3ByaW50ZihtLCAiTWF4
IGZyZXE6ICVkIE1IelxuIiwKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5tYXhfZnJl
cSkpOworCQlzZXFfcHJpbnRmKG0sCisJCQkgICAiZWZmaWNpZW50IChSUGUpIGZyZXF1ZW5jeTog
JWQgTUh6XG4iLAorCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmVmZmljaWVudF9mcmVx
KSk7CisJfSBlbHNlIHsKKwkJc2VxX3B1dHMobSwgIm5vIFAtc3RhdGUgaW5mbyBhdmFpbGFibGVc
biIpOworCX0KKworCXNlcV9wcmludGYobSwgIkN1cnJlbnQgQ0QgY2xvY2sgZnJlcXVlbmN5OiAl
ZCBrSHpcbiIsIGk5MTUtPmNkY2xrLmh3LmNkY2xrKTsKKwlzZXFfcHJpbnRmKG0sICJNYXggQ0Qg
Y2xvY2sgZnJlcXVlbmN5OiAlZCBrSHpcbiIsIGk5MTUtPm1heF9jZGNsa19mcmVxKTsKKwlzZXFf
cHJpbnRmKG0sICJNYXggcGl4ZWwgY2xvY2sgZnJlcXVlbmN5OiAlZCBrSHpcbiIsIGk5MTUtPm1h
eF9kb3RjbGtfZnJlcSk7CisKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCh1bmNvcmUtPnJwbSwgd2Fr
ZXJlZik7CisKKwlyZXR1cm4gMDsKK30KK0RFRklORV9HVF9ERUJVR0ZTX0FUVFJJQlVURShmcmVx
dWVuY3lfaW5mbyk7CisKK3N0YXRpYyBpbnQgbGxjX2luZm9fc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUg
Km0sIHZvaWQgKmRhdGEpCit7CisJc3RydWN0IGludGVsX2d0ICpndCA9IG0tPnByaXZhdGU7CisJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndC0+aTkxNTsKKwljb25zdCBib29sIGVk
cmFtID0gSU5URUxfR0VOKGk5MTUpID4gODsKKworCXNlcV9wcmludGYobSwgIkxMQzogJXNcbiIs
IHllc25vKEhBU19MTEMoaTkxNSkpKTsKKwlzZXFfcHJpbnRmKG0sICIlczogJXVNQlxuIiwgZWRy
YW0gPyAiZURSQU0iIDogImVMTEMiLAorCQkgICBpOTE1LT5lZHJhbV9zaXplX21iKTsKKworCXJl
dHVybiAwOworfQorREVGSU5FX0dUX0RFQlVHRlNfQVRUUklCVVRFKGxsY19pbmZvKTsKKworc3Rh
dGljIGludCByaW5nX2ZyZXFfdGFibGVfc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVu
dXNlZCkKK3sKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gbS0+cHJpdmF0ZTsKKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd0LT5pOTE1OworCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9
ICZndC0+cnBzOworCXVuc2lnbmVkIGludCBtYXhfZ3B1X2ZyZXEsIG1pbl9ncHVfZnJlcTsKKwlp
bnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKKwlpbnQgZ3B1X2ZyZXEsIGlhX2ZyZXE7CisKKwltaW5f
Z3B1X2ZyZXEgPSBycHMtPm1pbl9mcmVxOworCW1heF9ncHVfZnJlcSA9IHJwcy0+bWF4X2ZyZXE7
CisJaWYgKElTX0dFTjlfQkMoaTkxNSkgfHwgSU5URUxfR0VOKGk5MTUpID49IDEwKSB7CisJCS8q
IENvbnZlcnQgR1QgZnJlcXVlbmN5IHRvIDUwIEhaIHVuaXRzICovCisJCW1pbl9ncHVfZnJlcSAv
PSBHRU45X0ZSRVFfU0NBTEVSOworCQltYXhfZ3B1X2ZyZXEgLz0gR0VOOV9GUkVRX1NDQUxFUjsK
Kwl9CisKKwlzZXFfcHV0cyhtLCAiR1BVIGZyZXEgKE1IeilcdEVmZmVjdGl2ZSBDUFUgZnJlcSAo
TUh6KVx0RWZmZWN0aXZlIFJpbmcgZnJlcSAoTUh6KVxuIik7CisKKwl3YWtlcmVmID0gaW50ZWxf
cnVudGltZV9wbV9nZXQoZ3QtPnVuY29yZS0+cnBtKTsKKwlmb3IgKGdwdV9mcmVxID0gbWluX2dw
dV9mcmVxOyBncHVfZnJlcSA8PSBtYXhfZ3B1X2ZyZXE7IGdwdV9mcmVxKyspIHsKKwkJaWFfZnJl
cSA9IGdwdV9mcmVxOworCQlzYW5keWJyaWRnZV9wY29kZV9yZWFkKGk5MTUsCisJCQkJICAgICAg
IEdFTjZfUENPREVfUkVBRF9NSU5fRlJFUV9UQUJMRSwKKwkJCQkgICAgICAgJmlhX2ZyZXEsIE5V
TEwpOworCQlzZXFfcHJpbnRmKG0sICIlZFx0XHQlZFx0XHRcdFx0JWRcbiIsCisJCQkgICBpbnRl
bF9ncHVfZnJlcShycHMsCisJCQkJCSAgKGdwdV9mcmVxICoKKwkJCQkJICAgKElTX0dFTjlfQkMo
aTkxNSkgfHwKKwkJCQkJICAgIElOVEVMX0dFTihpOTE1KSA+PSAxMCA/CisJCQkJCSAgICBHRU45
X0ZSRVFfU0NBTEVSIDogMSkpKSwKKwkJCSAgICgoaWFfZnJlcSA+PiAwKSAmIDB4ZmYpICogMTAw
LAorCQkJICAgKChpYV9mcmVxID4+IDgpICYgMHhmZikgKiAxMDApOworCX0KKwlpbnRlbF9ydW50
aW1lX3BtX3B1dChndC0+dW5jb3JlLT5ycG0sIHdha2VyZWYpOworCisJcmV0dXJuIDA7Cit9CisK
K3N0YXRpYyBib29sIHJpbmdfZnJlcV90YWJsZV9ldmFsKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCit7
CisJcmV0dXJuIEhBU19MTEMoZ3QtPmk5MTUpID8gdHJ1ZSA6IGZhbHNlOworfQorCitERUZJTkVf
R1RfREVCVUdGU19BVFRSSUJVVEUocmluZ19mcmVxX3RhYmxlKTsKKworc3RhdGljIGNvbnN0IGNo
YXIgKnJwc19wb3dlcl90b19zdHIodW5zaWduZWQgaW50IHBvd2VyKQoreworCXN0YXRpYyBjb25z
dCBjaGFyICogY29uc3Qgc3RyaW5nc1tdID0geworCQlbTE9XX1BPV0VSXSA9ICJsb3cgcG93ZXIi
LAorCQlbQkVUV0VFTl0gPSAibWl4ZWQiLAorCQlbSElHSF9QT1dFUl0gPSAiaGlnaCBwb3dlciIs
CisJfTsKKworCWlmIChwb3dlciA+PSBBUlJBWV9TSVpFKHN0cmluZ3MpIHx8ICFzdHJpbmdzW3Bv
d2VyXSkKKwkJcmV0dXJuICJ1bmtub3duIjsKKworCXJldHVybiBzdHJpbmdzW3Bvd2VyXTsKK30K
Kworc3RhdGljIGludCBycHNfYm9vc3RfaW5mb19zaG93KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9p
ZCAqZGF0YSkKK3sKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gbS0+cHJpdmF0ZTsKKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd0LT5pOTE1OworCXN0cnVjdCBpbnRlbF91bmNvcmUg
KnVuY29yZSA9IGd0LT51bmNvcmU7CisJc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmd0LT5ycHM7
CisJdTMyIGFjdF9mcmVxOworCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOworCisJd2l0aF9pbnRl
bF9ydW50aW1lX3BtX2lmX2luX3VzZSh1bmNvcmUtPnJwbSwgd2FrZXJlZikKKwkJYWN0X2ZyZXEg
PSBpbnRlbF9ycHNfcmVhZF9hY3R1YWxfZnJlcXVlbmN5KHJwcyk7CisKKwlzZXFfcHJpbnRmKG0s
ICJSUFMgZW5hYmxlZD8gJWRcbiIsIHJwcy0+ZW5hYmxlZCk7CisJc2VxX3ByaW50ZihtLCAiR1BV
IGJ1c3k/ICVzXG4iLCB5ZXNubyhndC0+YXdha2UpKTsKKwlzZXFfcHJpbnRmKG0sICJCb29zdHMg
b3V0c3RhbmRpbmc/ICVkXG4iLAorCQkgICBhdG9taWNfcmVhZCgmcnBzLT5udW1fd2FpdGVycykp
OworCXNlcV9wcmludGYobSwgIkludGVyYWN0aXZlPyAlZFxuIiwgUkVBRF9PTkNFKHJwcy0+cG93
ZXIuaW50ZXJhY3RpdmUpKTsKKwlzZXFfcHJpbnRmKG0sICJGcmVxdWVuY3kgcmVxdWVzdGVkICVk
LCBhY3R1YWwgJWRcbiIsCisJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5jdXJfZnJlcSks
IGFjdF9mcmVxKTsKKwlzZXFfcHJpbnRmKG0sICIgIG1pbiBoYXJkOiVkLCBzb2Z0OiVkOyBtYXgg
c29mdDolZCwgaGFyZDolZFxuIiwKKwkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPm1pbl9m
cmVxKSwKKwkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPm1pbl9mcmVxX3NvZnRsaW1pdCks
CisJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5tYXhfZnJlcV9zb2Z0bGltaXQpLAorCQkg
ICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWF4X2ZyZXEpKTsKKwlzZXFfcHJpbnRmKG0sICIg
IGlkbGU6JWQsIGVmZmljaWVudDolZCwgYm9vc3Q6JWRcbiIsCisJCSAgIGludGVsX2dwdV9mcmVx
KHJwcywgcnBzLT5pZGxlX2ZyZXEpLAorCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+ZWZm
aWNpZW50X2ZyZXEpLAorCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+Ym9vc3RfZnJlcSkp
OworCisJc2VxX3ByaW50ZihtLCAiV2FpdCBib29zdHM6ICVkXG4iLCBhdG9taWNfcmVhZCgmcnBz
LT5ib29zdHMpKTsKKworCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNiAmJiBycHMtPmVuYWJsZWQg
JiYgZ3QtPmF3YWtlKSB7CisJCXUzMiBycHVwLCBycHVwZWk7CisJCXUzMiBycGRvd24sIHJwZG93
bmVpOworCisJCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KHVuY29yZSwgRk9SQ0VXQUtFX0FM
TCk7CisJCXJwdXAgPSBpbnRlbF91bmNvcmVfcmVhZF9mdyh1bmNvcmUsIEdFTjZfUlBfQ1VSX1VQ
KSAmIEdFTjZfUlBfRUlfTUFTSzsKKwkJcnB1cGVpID0gaW50ZWxfdW5jb3JlX3JlYWRfZncodW5j
b3JlLCBHRU42X1JQX0NVUl9VUF9FSSkgJiBHRU42X1JQX0VJX01BU0s7CisJCXJwZG93biA9IGlu
dGVsX3VuY29yZV9yZWFkX2Z3KHVuY29yZSwgR0VONl9SUF9DVVJfRE9XTikgJiBHRU42X1JQX0VJ
X01BU0s7CisJCXJwZG93bmVpID0gaW50ZWxfdW5jb3JlX3JlYWRfZncodW5jb3JlLCBHRU42X1JQ
X0NVUl9ET1dOX0VJKSAmIEdFTjZfUlBfRUlfTUFTSzsKKwkJaW50ZWxfdW5jb3JlX2ZvcmNld2Fr
ZV9wdXQodW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKKworCQlzZXFfcHJpbnRmKG0sICJcblJQUyBB
dXRvdHVuaW5nIChjdXJyZW50IFwiJXNcIiB3aW5kb3cpOlxuIiwKKwkJCSAgIHJwc19wb3dlcl90
b19zdHIocnBzLT5wb3dlci5tb2RlKSk7CisJCXNlcV9wcmludGYobSwgIiAgQXZnLiB1cDogJWQl
JSBbYWJvdmUgdGhyZXNob2xkPyAlZCUlXVxuIiwKKwkJCSAgIHJwdXAgJiYgcnB1cGVpID8gMTAw
ICogcnB1cCAvIHJwdXBlaSA6IDAsCisJCQkgICBycHMtPnBvd2VyLnVwX3RocmVzaG9sZCk7CisJ
CXNlcV9wcmludGYobSwgIiAgQXZnLiBkb3duOiAlZCUlIFtiZWxvdyB0aHJlc2hvbGQ/ICVkJSVd
XG4iLAorCQkJICAgcnBkb3duICYmIHJwZG93bmVpID8gMTAwICogcnBkb3duIC8gcnBkb3duZWkg
OiAwLAorCQkJICAgcnBzLT5wb3dlci5kb3duX3RocmVzaG9sZCk7CisJfSBlbHNlIHsKKwkJc2Vx
X3B1dHMobSwgIlxuUlBTIEF1dG90dW5pbmcgaW5hY3RpdmVcbiIpOworCX0KKworCXJldHVybiAw
OworfQorREVGSU5FX0dUX0RFQlVHRlNfQVRUUklCVVRFKHJwc19ib29zdF9pbmZvKTsKKworc3Rh
dGljIGNvbnN0IHN0cnVjdCBndF9wbV9kZWJ1Z2ZzX2ZpbGVzIHsKKwljb25zdCBjaGFyICpuYW1l
OworCWNvbnN0IHN0cnVjdCBmaWxlX29wZXJhdGlvbnMgKmZvcHM7CisJYm9vbCAoKmV2YWwpKHN0
cnVjdCBpbnRlbF9ndCAqZ3QpOworfSBndF9wbV9kZWJ1Z2ZzX2ZpbGVzW10gPSB7CisJeyAiZHJw
Y19pbmZvIiwgJmRycGNfaW5mb19mb3BzLCBOVUxMIH0sCisJeyAiZnJlcXVlbmN5X2luZm8iLCAm
ZnJlcXVlbmN5X2luZm9fZm9wcywgTlVMTCB9LAorCXsgImZvcmNld2FrZV9kb21haW5zIiwgJmZv
cmNld2FrZV9kb21haW5zX2ZvcHMsIE5VTEwgfSwKKwl7ICJsbGNfaW5mbyIsICZsbGNfaW5mb19m
b3BzLCBOVUxMIH0sCisJeyAicmluZ19mcmVxX3RhYmxlIiwgJnJpbmdfZnJlcV90YWJsZV9mb3Bz
LCByaW5nX2ZyZXFfdGFibGVfZXZhbCB9LAorCXsgInJwc19ib29zdF9pbmZvIiwgJnJwc19ib29z
dF9pbmZvX2ZvcHMsIE5VTEwgfSwKK307CisKK2ludCBpbnRlbF9ndF9wbV9kZWJ1Z2ZzX3JlZ2lz
dGVyKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIHN0cnVjdCBkZW50cnkgKnJvb3QpCit7CisJaW50IGk7
CisKKwlpZiAodW5saWtlbHkoIXJvb3QpKQorCQlyZXR1cm4gLUVOT0RFVjsKKworCWZvciAoaSA9
IDA7IGkgPCBBUlJBWV9TSVpFKGd0X3BtX2RlYnVnZnNfZmlsZXMpOyBpKyspIHsKKwkJY29uc3Qg
c3RydWN0IGd0X3BtX2RlYnVnZnNfZmlsZXMgKmYgPSAmZ3RfcG1fZGVidWdmc19maWxlc1tpXTsK
KworCQlpZiAoZi0+ZXZhbCAmJiAhZi0+ZXZhbChndCkpCisJCQljb250aW51ZTsKKworCQlkZWJ1
Z2ZzX2NyZWF0ZV9maWxlKGYtPm5hbWUsIDA0NDQsIHJvb3QsIGd0LCBmLT5mb3BzKTsKKwl9CisK
KwlyZXR1cm4gMDsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2RlYnVn
ZnNfcG0uaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2RlYnVnZnNfcG0uaApuZXcgZmlsZSBt
b2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjBjNTk4N2I2YmUxOAotLS0gL2Rldi9udWxs
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2RlYnVnZnNfcG0uaApAQCAtMCwwICsxLDE2
IEBACisvKgorICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAorICoKKyAqIENvcHlyaWdo
dCDCqSAyMDE5IEludGVsIENvcnBvcmF0aW9uCisgKi8KKworI2lmbmRlZiBERUJVR0ZTX1BNCisj
ZGVmaW5lIERFQlVHRlNfUE0KKworI2luY2x1ZGUgPGxpbnV4L3NlcV9maWxlLmg+CisKKyNpbmNs
dWRlICJpbnRlbF9ndF90eXBlcy5oIgorCitpbnQgaW50ZWxfZ3RfcG1fZGVidWdmc19yZWdpc3Rl
cihzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBzdHJ1Y3QgZGVudHJ5ICpyb290KTsKKworI2VuZGlmIC8q
IERFQlVHRlNfUE0gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVi
dWdmcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKaW5kZXggM2VjMjZi
NmE0OGMxLi5jZmUzZGQzMDhjNjcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfZGVidWdmcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCkBA
IC00MCwxMSArNDAsMTAgQEAKICNpbmNsdWRlICJkaXNwbGF5L2ludGVsX3Bzci5oIgogCiAjaW5j
bHVkZSAiZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaCIKKyNpbmNsdWRlICJndC9kZWJ1Z2ZzX2d0Lmgi
CiAjaW5jbHVkZSAiZ3QvaW50ZWxfZ3RfcG0uaCIKICNpbmNsdWRlICJndC9pbnRlbF9ndF9yZXF1
ZXN0cy5oIgogI2luY2x1ZGUgImd0L2ludGVsX3Jlc2V0LmgiCi0jaW5jbHVkZSAiZ3QvaW50ZWxf
cmM2LmgiCi0jaW5jbHVkZSAiZ3QvaW50ZWxfcnBzLmgiCiAjaW5jbHVkZSAiZ3QvdWMvaW50ZWxf
Z3VjX3N1Ym1pc3Npb24uaCIKIAogI2luY2x1ZGUgImk5MTVfZGVidWdmcy5oIgpAQCAtNzc4LDQ0
MyArNzc3LDYgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBmaWxlX29wZXJhdGlvbnMgaTkxNV9lcnJv
cl9zdGF0ZV9mb3BzID0gewogfTsKICNlbmRpZgogCi1zdGF0aWMgaW50IGk5MTVfZnJlcXVlbmN5
X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCi17Ci0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwotCXN0cnVj
dCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwotCXN0cnVjdCBpbnRl
bF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3QucnBzOwotCWludGVsX3dha2VyZWZfdCB3YWtlcmVm
OwotCWludCByZXQgPSAwOwotCi0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZf
cHJpdi0+cnVudGltZV9wbSk7Ci0KLQlpZiAoSVNfR0VOKGRldl9wcml2LCA1KSkgewotCQl1MTYg
cmd2c3djdGwgPSBpbnRlbF91bmNvcmVfcmVhZDE2KHVuY29yZSwgTUVNU1dDVEwpOwotCQl1MTYg
cmd2c3RhdCA9IGludGVsX3VuY29yZV9yZWFkMTYodW5jb3JlLCBNRU1TVEFUX0lMSyk7Ci0KLQkJ
c2VxX3ByaW50ZihtLCAiUmVxdWVzdGVkIFAtc3RhdGU6ICVkXG4iLCAocmd2c3djdGwgPj4gOCkg
JiAweGYpOwotCQlzZXFfcHJpbnRmKG0sICJSZXF1ZXN0ZWQgVklEOiAlZFxuIiwgcmd2c3djdGwg
JiAweDNmKTsKLQkJc2VxX3ByaW50ZihtLCAiQ3VycmVudCBWSUQ6ICVkXG4iLCAocmd2c3RhdCAm
IE1FTVNUQVRfVklEX01BU0spID4+Ci0JCQkgICBNRU1TVEFUX1ZJRF9TSElGVCk7Ci0JCXNlcV9w
cmludGYobSwgIkN1cnJlbnQgUC1zdGF0ZTogJWRcbiIsCi0JCQkgICAocmd2c3RhdCAmIE1FTVNU
QVRfUFNUQVRFX01BU0spID4+IE1FTVNUQVRfUFNUQVRFX1NISUZUKTsKLQl9IGVsc2UgaWYgKElT
X1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Ci0JCXUz
MiBycG1vZGVjdGwsIGZyZXFfc3RzOwotCi0JCXJwbW9kZWN0bCA9IEk5MTVfUkVBRChHRU42X1JQ
X0NPTlRST0wpOwotCQlzZXFfcHJpbnRmKG0sICJWaWRlbyBUdXJibyBNb2RlOiAlc1xuIiwKLQkJ
CSAgIHllc25vKHJwbW9kZWN0bCAmIEdFTjZfUlBfTUVESUFfVFVSQk8pKTsKLQkJc2VxX3ByaW50
ZihtLCAiSFcgY29udHJvbCBlbmFibGVkOiAlc1xuIiwKLQkJCSAgIHllc25vKHJwbW9kZWN0bCAm
IEdFTjZfUlBfRU5BQkxFKSk7Ci0JCXNlcV9wcmludGYobSwgIlNXIGNvbnRyb2wgZW5hYmxlZDog
JXNcbiIsCi0JCQkgICB5ZXNubygocnBtb2RlY3RsICYgR0VONl9SUF9NRURJQV9NT0RFX01BU0sp
ID09Ci0JCQkJICBHRU42X1JQX01FRElBX1NXX01PREUpKTsKLQotCQl2bHZfcHVuaXRfZ2V0KGRl
dl9wcml2KTsKLQkJZnJlcV9zdHMgPSB2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgUFVOSVRfUkVH
X0dQVV9GUkVRX1NUUyk7Ci0JCXZsdl9wdW5pdF9wdXQoZGV2X3ByaXYpOwotCi0JCXNlcV9wcmlu
dGYobSwgIlBVTklUX1JFR19HUFVfRlJFUV9TVFM6IDB4JTA4eFxuIiwgZnJlcV9zdHMpOwotCQlz
ZXFfcHJpbnRmKG0sICJERFIgZnJlcTogJWQgTUh6XG4iLCBkZXZfcHJpdi0+bWVtX2ZyZXEpOwot
Ci0JCXNlcV9wcmludGYobSwgImFjdHVhbCBHUFUgZnJlcTogJWQgTUh6XG4iLAotCQkJICAgaW50
ZWxfZ3B1X2ZyZXEocnBzLCAoZnJlcV9zdHMgPj4gOCkgJiAweGZmKSk7Ci0KLQkJc2VxX3ByaW50
ZihtLCAiY3VycmVudCBHUFUgZnJlcTogJWQgTUh6XG4iLAotCQkJICAgaW50ZWxfZ3B1X2ZyZXEo
cnBzLCBycHMtPmN1cl9mcmVxKSk7Ci0KLQkJc2VxX3ByaW50ZihtLCAibWF4IEdQVSBmcmVxOiAl
ZCBNSHpcbiIsCi0JCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWF4X2ZyZXEpKTsKLQot
CQlzZXFfcHJpbnRmKG0sICJtaW4gR1BVIGZyZXE6ICVkIE1IelxuIiwKLQkJCSAgIGludGVsX2dw
dV9mcmVxKHJwcywgcnBzLT5taW5fZnJlcSkpOwotCi0JCXNlcV9wcmludGYobSwgImlkbGUgR1BV
IGZyZXE6ICVkIE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5pZGxlX2Zy
ZXEpKTsKLQotCQlzZXFfcHJpbnRmKG0sCi0JCQkgICAiZWZmaWNpZW50IChSUGUpIGZyZXF1ZW5j
eTogJWQgTUh6XG4iLAotCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmVmZmljaWVudF9m
cmVxKSk7Ci0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDYpIHsKLQkJdTMyIHJw
X3N0YXRlX2xpbWl0czsKLQkJdTMyIGd0X3BlcmZfc3RhdHVzOwotCQl1MzIgcnBfc3RhdGVfY2Fw
OwotCQl1MzIgcnBtb2RlY3RsLCBycGluY2xpbWl0LCBycGRlY2xpbWl0OwotCQl1MzIgcnBzdGF0
LCBjYWdmLCByZXFmOwotCQl1MzIgcnB1cGVpLCBycGN1cnVwLCBycHByZXZ1cDsKLQkJdTMyIHJw
ZG93bmVpLCBycGN1cmRvd24sIHJwcHJldmRvd247Ci0JCXUzMiBwbV9pZXIsIHBtX2ltciwgcG1f
aXNyLCBwbV9paXIsIHBtX21hc2s7Ci0JCWludCBtYXhfZnJlcTsKLQotCQlycF9zdGF0ZV9saW1p
dHMgPSBJOTE1X1JFQUQoR0VONl9SUF9TVEFURV9MSU1JVFMpOwotCQlpZiAoSVNfR0VOOV9MUChk
ZXZfcHJpdikpIHsKLQkJCXJwX3N0YXRlX2NhcCA9IEk5MTVfUkVBRChCWFRfUlBfU1RBVEVfQ0FQ
KTsKLQkJCWd0X3BlcmZfc3RhdHVzID0gSTkxNV9SRUFEKEJYVF9HVF9QRVJGX1NUQVRVUyk7Ci0J
CX0gZWxzZSB7Ci0JCQlycF9zdGF0ZV9jYXAgPSBJOTE1X1JFQUQoR0VONl9SUF9TVEFURV9DQVAp
OwotCQkJZ3RfcGVyZl9zdGF0dXMgPSBJOTE1X1JFQUQoR0VONl9HVF9QRVJGX1NUQVRVUyk7Ci0J
CX0KLQotCQkvKiBSUFNUQVQxIGlzIGluIHRoZSBHVCBwb3dlciB3ZWxsICovCi0JCWludGVsX3Vu
Y29yZV9mb3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKLQot
CQlyZXFmID0gSTkxNV9SRUFEKEdFTjZfUlBOU1dSRVEpOwotCQlpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA+PSA5KQotCQkJcmVxZiA+Pj0gMjM7Ci0JCWVsc2UgewotCQkJcmVxZiAmPSB+R0VONl9U
VVJCT19ESVNBQkxFOwotCQkJaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElTX0JST0FEV0VM
TChkZXZfcHJpdikpCi0JCQkJcmVxZiA+Pj0gMjQ7Ci0JCQllbHNlCi0JCQkJcmVxZiA+Pj0gMjU7
Ci0JCX0KLQkJcmVxZiA9IGludGVsX2dwdV9mcmVxKHJwcywgcmVxZik7Ci0KLQkJcnBtb2RlY3Rs
ID0gSTkxNV9SRUFEKEdFTjZfUlBfQ09OVFJPTCk7Ci0JCXJwaW5jbGltaXQgPSBJOTE1X1JFQUQo
R0VONl9SUF9VUF9USFJFU0hPTEQpOwotCQlycGRlY2xpbWl0ID0gSTkxNV9SRUFEKEdFTjZfUlBf
RE9XTl9USFJFU0hPTEQpOwotCi0JCXJwc3RhdCA9IEk5MTVfUkVBRChHRU42X1JQU1RBVDEpOwot
CQlycHVwZWkgPSBJOTE1X1JFQUQoR0VONl9SUF9DVVJfVVBfRUkpICYgR0VONl9DVVJJQ09OVF9N
QVNLOwotCQlycGN1cnVwID0gSTkxNV9SRUFEKEdFTjZfUlBfQ1VSX1VQKSAmIEdFTjZfQ1VSQlNZ
VEFWR19NQVNLOwotCQlycHByZXZ1cCA9IEk5MTVfUkVBRChHRU42X1JQX1BSRVZfVVApICYgR0VO
Nl9DVVJCU1lUQVZHX01BU0s7Ci0JCXJwZG93bmVpID0gSTkxNV9SRUFEKEdFTjZfUlBfQ1VSX0RP
V05fRUkpICYgR0VONl9DVVJJQVZHX01BU0s7Ci0JCXJwY3VyZG93biA9IEk5MTVfUkVBRChHRU42
X1JQX0NVUl9ET1dOKSAmIEdFTjZfQ1VSQlNZVEFWR19NQVNLOwotCQlycHByZXZkb3duID0gSTkx
NV9SRUFEKEdFTjZfUlBfUFJFVl9ET1dOKSAmIEdFTjZfQ1VSQlNZVEFWR19NQVNLOwotCQljYWdm
ID0gaW50ZWxfcnBzX3JlYWRfYWN0dWFsX2ZyZXF1ZW5jeShycHMpOwotCi0JCWludGVsX3VuY29y
ZV9mb3JjZXdha2VfcHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKLQotCQlp
ZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkgewotCQkJcG1faWVyID0gSTkxNV9SRUFEKEdF
TjExX0dQTV9XR0JPWFBFUkZfSU5UUl9FTkFCTEUpOwotCQkJcG1faW1yID0gSTkxNV9SRUFEKEdF
TjExX0dQTV9XR0JPWFBFUkZfSU5UUl9NQVNLKTsKLQkJCS8qCi0JCQkgKiBUaGUgZXF1aXZhbGVu
dCB0byB0aGUgUE0gSVNSICYgSUlSIGNhbm5vdCBiZSByZWFkCi0JCQkgKiB3aXRob3V0IGFmZmVj
dGluZyB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgc3lzdGVtCi0JCQkgKi8KLQkJCXBtX2lzciA9
IDA7Ci0JCQlwbV9paXIgPSAwOwotCQl9IGVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0g
OCkgewotCQkJcG1faWVyID0gSTkxNV9SRUFEKEdFTjhfR1RfSUVSKDIpKTsKLQkJCXBtX2ltciA9
IEk5MTVfUkVBRChHRU44X0dUX0lNUigyKSk7Ci0JCQlwbV9pc3IgPSBJOTE1X1JFQUQoR0VOOF9H
VF9JU1IoMikpOwotCQkJcG1faWlyID0gSTkxNV9SRUFEKEdFTjhfR1RfSUlSKDIpKTsKLQkJfSBl
bHNlIHsKLQkJCXBtX2llciA9IEk5MTVfUkVBRChHRU42X1BNSUVSKTsKLQkJCXBtX2ltciA9IEk5
MTVfUkVBRChHRU42X1BNSU1SKTsKLQkJCXBtX2lzciA9IEk5MTVfUkVBRChHRU42X1BNSVNSKTsK
LQkJCXBtX2lpciA9IEk5MTVfUkVBRChHRU42X1BNSUlSKTsKLQkJfQotCQlwbV9tYXNrID0gSTkx
NV9SRUFEKEdFTjZfUE1JTlRSTVNLKTsKLQotCQlzZXFfcHJpbnRmKG0sICJWaWRlbyBUdXJibyBN
b2RlOiAlc1xuIiwKLQkJCSAgIHllc25vKHJwbW9kZWN0bCAmIEdFTjZfUlBfTUVESUFfVFVSQk8p
KTsKLQkJc2VxX3ByaW50ZihtLCAiSFcgY29udHJvbCBlbmFibGVkOiAlc1xuIiwKLQkJCSAgIHll
c25vKHJwbW9kZWN0bCAmIEdFTjZfUlBfRU5BQkxFKSk7Ci0JCXNlcV9wcmludGYobSwgIlNXIGNv
bnRyb2wgZW5hYmxlZDogJXNcbiIsCi0JCQkgICB5ZXNubygocnBtb2RlY3RsICYgR0VONl9SUF9N
RURJQV9NT0RFX01BU0spID09Ci0JCQkJICBHRU42X1JQX01FRElBX1NXX01PREUpKTsKLQotCQlz
ZXFfcHJpbnRmKG0sICJQTSBJRVI9MHglMDh4IElNUj0weCUwOHgsIE1BU0s9MHglMDh4XG4iLAot
CQkJICAgcG1faWVyLCBwbV9pbXIsIHBtX21hc2spOwotCQlpZiAoSU5URUxfR0VOKGRldl9wcml2
KSA8PSAxMCkKLQkJCXNlcV9wcmludGYobSwgIlBNIElTUj0weCUwOHggSUlSPTB4JTA4eFxuIiwK
LQkJCQkgICBwbV9pc3IsIHBtX2lpcik7Ci0JCXNlcV9wcmludGYobSwgInBtX2ludHJtc2tfbWJ6
OiAweCUwOHhcbiIsCi0JCQkgICBycHMtPnBtX2ludHJtc2tfbWJ6KTsKLQkJc2VxX3ByaW50Ziht
LCAiR1RfUEVSRl9TVEFUVVM6IDB4JTA4eFxuIiwgZ3RfcGVyZl9zdGF0dXMpOwotCQlzZXFfcHJp
bnRmKG0sICJSZW5kZXIgcC1zdGF0ZSByYXRpbzogJWRcbiIsCi0JCQkgICAoZ3RfcGVyZl9zdGF0
dXMgJiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5ID8gMHgxZmYwMCA6IDB4ZmYwMCkpID4+IDgp
OwotCQlzZXFfcHJpbnRmKG0sICJSZW5kZXIgcC1zdGF0ZSBWSUQ6ICVkXG4iLAotCQkJICAgZ3Rf
cGVyZl9zdGF0dXMgJiAweGZmKTsKLQkJc2VxX3ByaW50ZihtLCAiUmVuZGVyIHAtc3RhdGUgbGlt
aXQ6ICVkXG4iLAotCQkJICAgcnBfc3RhdGVfbGltaXRzICYgMHhmZik7Ci0JCXNlcV9wcmludGYo
bSwgIlJQU1RBVDE6IDB4JTA4eFxuIiwgcnBzdGF0KTsKLQkJc2VxX3ByaW50ZihtLCAiUlBNT0RF
Q1RMOiAweCUwOHhcbiIsIHJwbW9kZWN0bCk7Ci0JCXNlcV9wcmludGYobSwgIlJQSU5DTElNSVQ6
IDB4JTA4eFxuIiwgcnBpbmNsaW1pdCk7Ci0JCXNlcV9wcmludGYobSwgIlJQREVDTElNSVQ6IDB4
JTA4eFxuIiwgcnBkZWNsaW1pdCk7Ci0JCXNlcV9wcmludGYobSwgIlJQTlNXUkVROiAlZE1Ielxu
IiwgcmVxZik7Ci0JCXNlcV9wcmludGYobSwgIkNBR0Y6ICVkTUh6XG4iLCBjYWdmKTsKLQkJc2Vx
X3ByaW50ZihtLCAiUlAgQ1VSIFVQIEVJOiAlZCAoJWR1cylcbiIsCi0JCQkgICBycHVwZWksIEdU
X1BNX0lOVEVSVkFMX1RPX1VTKGRldl9wcml2LCBycHVwZWkpKTsKLQkJc2VxX3ByaW50ZihtLCAi
UlAgQ1VSIFVQOiAlZCAoJWR1cylcbiIsCi0JCQkgICBycGN1cnVwLCBHVF9QTV9JTlRFUlZBTF9U
T19VUyhkZXZfcHJpdiwgcnBjdXJ1cCkpOwotCQlzZXFfcHJpbnRmKG0sICJSUCBQUkVWIFVQOiAl
ZCAoJWR1cylcbiIsCi0JCQkgICBycHByZXZ1cCwgR1RfUE1fSU5URVJWQUxfVE9fVVMoZGV2X3By
aXYsIHJwcHJldnVwKSk7Ci0JCXNlcV9wcmludGYobSwgIlVwIHRocmVzaG9sZDogJWQlJVxuIiwK
LQkJCSAgIHJwcy0+cG93ZXIudXBfdGhyZXNob2xkKTsKLQotCQlzZXFfcHJpbnRmKG0sICJSUCBD
VVIgRE9XTiBFSTogJWQgKCVkdXMpXG4iLAotCQkJICAgcnBkb3duZWksIEdUX1BNX0lOVEVSVkFM
X1RPX1VTKGRldl9wcml2LCBycGRvd25laSkpOwotCQlzZXFfcHJpbnRmKG0sICJSUCBDVVIgRE9X
TjogJWQgKCVkdXMpXG4iLAotCQkJICAgcnBjdXJkb3duLCBHVF9QTV9JTlRFUlZBTF9UT19VUyhk
ZXZfcHJpdiwgcnBjdXJkb3duKSk7Ci0JCXNlcV9wcmludGYobSwgIlJQIFBSRVYgRE9XTjogJWQg
KCVkdXMpXG4iLAotCQkJICAgcnBwcmV2ZG93biwgR1RfUE1fSU5URVJWQUxfVE9fVVMoZGV2X3By
aXYsIHJwcHJldmRvd24pKTsKLQkJc2VxX3ByaW50ZihtLCAiRG93biB0aHJlc2hvbGQ6ICVkJSVc
biIsCi0JCQkgICBycHMtPnBvd2VyLmRvd25fdGhyZXNob2xkKTsKLQotCQltYXhfZnJlcSA9IChJ
U19HRU45X0xQKGRldl9wcml2KSA/IHJwX3N0YXRlX2NhcCA+PiAwIDoKLQkJCSAgICBycF9zdGF0
ZV9jYXAgPj4gMTYpICYgMHhmZjsKLQkJbWF4X2ZyZXEgKj0gKElTX0dFTjlfQkMoZGV2X3ByaXYp
IHx8Ci0JCQkgICAgIElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgPyBHRU45X0ZSRVFfU0NBTEVS
IDogMSk7Ci0JCXNlcV9wcmludGYobSwgIkxvd2VzdCAoUlBOKSBmcmVxdWVuY3k6ICVkTUh6XG4i
LAotCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBtYXhfZnJlcSkpOwotCi0JCW1heF9mcmVxID0g
KHJwX3N0YXRlX2NhcCAmIDB4ZmYwMCkgPj4gODsKLQkJbWF4X2ZyZXEgKj0gKElTX0dFTjlfQkMo
ZGV2X3ByaXYpIHx8Ci0JCQkgICAgIElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgPyBHRU45X0ZS
RVFfU0NBTEVSIDogMSk7Ci0JCXNlcV9wcmludGYobSwgIk5vbWluYWwgKFJQMSkgZnJlcXVlbmN5
OiAlZE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgbWF4X2ZyZXEpKTsKLQotCQlt
YXhfZnJlcSA9IChJU19HRU45X0xQKGRldl9wcml2KSA/IHJwX3N0YXRlX2NhcCA+PiAxNiA6Ci0J
CQkgICAgcnBfc3RhdGVfY2FwID4+IDApICYgMHhmZjsKLQkJbWF4X2ZyZXEgKj0gKElTX0dFTjlf
QkMoZGV2X3ByaXYpIHx8Ci0JCQkgICAgIElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgPyBHRU45
X0ZSRVFfU0NBTEVSIDogMSk7Ci0JCXNlcV9wcmludGYobSwgIk1heCBub24tb3ZlcmNsb2NrZWQg
KFJQMCkgZnJlcXVlbmN5OiAlZE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgbWF4
X2ZyZXEpKTsKLQkJc2VxX3ByaW50ZihtLCAiTWF4IG92ZXJjbG9ja2VkIGZyZXF1ZW5jeTogJWRN
SHpcbiIsCi0JCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWF4X2ZyZXEpKTsKLQotCQlz
ZXFfcHJpbnRmKG0sICJDdXJyZW50IGZyZXE6ICVkIE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9m
cmVxKHJwcywgcnBzLT5jdXJfZnJlcSkpOwotCQlzZXFfcHJpbnRmKG0sICJBY3R1YWwgZnJlcTog
JWQgTUh6XG4iLCBjYWdmKTsKLQkJc2VxX3ByaW50ZihtLCAiSWRsZSBmcmVxOiAlZCBNSHpcbiIs
Ci0JCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+aWRsZV9mcmVxKSk7Ci0JCXNlcV9wcmlu
dGYobSwgIk1pbiBmcmVxOiAlZCBNSHpcbiIsCi0JCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJw
cy0+bWluX2ZyZXEpKTsKLQkJc2VxX3ByaW50ZihtLCAiQm9vc3QgZnJlcTogJWQgTUh6XG4iLAot
CQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmJvb3N0X2ZyZXEpKTsKLQkJc2VxX3ByaW50
ZihtLCAiTWF4IGZyZXE6ICVkIE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBz
LT5tYXhfZnJlcSkpOwotCQlzZXFfcHJpbnRmKG0sCi0JCQkgICAiZWZmaWNpZW50IChSUGUpIGZy
ZXF1ZW5jeTogJWQgTUh6XG4iLAotCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmVmZmlj
aWVudF9mcmVxKSk7Ci0JfSBlbHNlIHsKLQkJc2VxX3B1dHMobSwgIm5vIFAtc3RhdGUgaW5mbyBh
dmFpbGFibGVcbiIpOwotCX0KLQotCXNlcV9wcmludGYobSwgIkN1cnJlbnQgQ0QgY2xvY2sgZnJl
cXVlbmN5OiAlZCBrSHpcbiIsIGRldl9wcml2LT5jZGNsay5ody5jZGNsayk7Ci0Jc2VxX3ByaW50
ZihtLCAiTWF4IENEIGNsb2NrIGZyZXF1ZW5jeTogJWQga0h6XG4iLCBkZXZfcHJpdi0+bWF4X2Nk
Y2xrX2ZyZXEpOwotCXNlcV9wcmludGYobSwgIk1heCBwaXhlbCBjbG9jayBmcmVxdWVuY3k6ICVk
IGtIelxuIiwgZGV2X3ByaXYtPm1heF9kb3RjbGtfZnJlcSk7Ci0KLQlpbnRlbF9ydW50aW1lX3Bt
X3B1dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwotCXJldHVybiByZXQ7Ci19Ci0K
LXN0YXRpYyBpbnQgaXJvbmxha2VfZHJwY19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSkKLXsKLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsK
LQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwotCXUzMiByZ3Zt
b2RlY3RsLCByc3RkYnljdGw7Ci0JdTE2IGNyc3RhbmR2aWQ7Ci0KLQlyZ3Ztb2RlY3RsID0gaW50
ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBNRU1NT0RFQ1RMKTsKLQlyc3RkYnljdGwgPSBpbnRlbF91
bmNvcmVfcmVhZCh1bmNvcmUsIFJTVERCWUNUTCk7Ci0JY3JzdGFuZHZpZCA9IGludGVsX3VuY29y
ZV9yZWFkMTYodW5jb3JlLCBDUlNUQU5EVklEKTsKLQotCXNlcV9wcmludGYobSwgIkhEIGJvb3N0
OiAlc1xuIiwgeWVzbm8ocmd2bW9kZWN0bCAmIE1FTU1PREVfQk9PU1RfRU4pKTsKLQlzZXFfcHJp
bnRmKG0sICJCb29zdCBmcmVxOiAlZFxuIiwKLQkJICAgKHJndm1vZGVjdGwgJiBNRU1NT0RFX0JP
T1NUX0ZSRVFfTUFTSykgPj4KLQkJICAgTUVNTU9ERV9CT09TVF9GUkVRX1NISUZUKTsKLQlzZXFf
cHJpbnRmKG0sICJIVyBjb250cm9sIGVuYWJsZWQ6ICVzXG4iLAotCQkgICB5ZXNubyhyZ3Ztb2Rl
Y3RsICYgTUVNTU9ERV9IV0lETEVfRU4pKTsKLQlzZXFfcHJpbnRmKG0sICJTVyBjb250cm9sIGVu
YWJsZWQ6ICVzXG4iLAotCQkgICB5ZXNubyhyZ3Ztb2RlY3RsICYgTUVNTU9ERV9TV01PREVfRU4p
KTsKLQlzZXFfcHJpbnRmKG0sICJHYXRlZCB2b2x0YWdlIGNoYW5nZTogJXNcbiIsCi0JCSAgIHll
c25vKHJndm1vZGVjdGwgJiBNRU1NT0RFX1JDTEtfR0FURSkpOwotCXNlcV9wcmludGYobSwgIlN0
YXJ0aW5nIGZyZXF1ZW5jeTogUCVkXG4iLAotCQkgICAocmd2bW9kZWN0bCAmIE1FTU1PREVfRlNU
QVJUX01BU0spID4+IE1FTU1PREVfRlNUQVJUX1NISUZUKTsKLQlzZXFfcHJpbnRmKG0sICJNYXgg
UC1zdGF0ZTogUCVkXG4iLAotCQkgICAocmd2bW9kZWN0bCAmIE1FTU1PREVfRk1BWF9NQVNLKSA+
PiBNRU1NT0RFX0ZNQVhfU0hJRlQpOwotCXNlcV9wcmludGYobSwgIk1pbiBQLXN0YXRlOiBQJWRc
biIsIChyZ3Ztb2RlY3RsICYgTUVNTU9ERV9GTUlOX01BU0spKTsKLQlzZXFfcHJpbnRmKG0sICJS
UzEgVklEOiAlZFxuIiwgKGNyc3RhbmR2aWQgJiAweDNmKSk7Ci0Jc2VxX3ByaW50ZihtLCAiUlMy
IFZJRDogJWRcbiIsICgoY3JzdGFuZHZpZCA+PiA4KSAmIDB4M2YpKTsKLQlzZXFfcHJpbnRmKG0s
ICJSZW5kZXIgc3RhbmRieSBlbmFibGVkOiAlc1xuIiwKLQkJICAgeWVzbm8oIShyc3RkYnljdGwg
JiBSQ1hfU1dfRVhJVCkpKTsKLQlzZXFfcHV0cyhtLCAiQ3VycmVudCBSUyBzdGF0ZTogIik7Ci0J
c3dpdGNoIChyc3RkYnljdGwgJiBSU1hfU1RBVFVTX01BU0spIHsKLQljYXNlIFJTWF9TVEFUVVNf
T046Ci0JCXNlcV9wdXRzKG0sICJvblxuIik7Ci0JCWJyZWFrOwotCWNhc2UgUlNYX1NUQVRVU19S
QzE6Ci0JCXNlcV9wdXRzKG0sICJSQzFcbiIpOwotCQlicmVhazsKLQljYXNlIFJTWF9TVEFUVVNf
UkMxRToKLQkJc2VxX3B1dHMobSwgIlJDMUVcbiIpOwotCQlicmVhazsKLQljYXNlIFJTWF9TVEFU
VVNfUlMxOgotCQlzZXFfcHV0cyhtLCAiUlMxXG4iKTsKLQkJYnJlYWs7Ci0JY2FzZSBSU1hfU1RB
VFVTX1JTMjoKLQkJc2VxX3B1dHMobSwgIlJTMiAoUkM2KVxuIik7Ci0JCWJyZWFrOwotCWNhc2Ug
UlNYX1NUQVRVU19SUzM6Ci0JCXNlcV9wdXRzKG0sICJSQzMgKFJDNispXG4iKTsKLQkJYnJlYWs7
Ci0JZGVmYXVsdDoKLQkJc2VxX3B1dHMobSwgInVua25vd25cbiIpOwotCQlicmVhazsKLQl9Ci0K
LQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCBpOTE1X2ZvcmNld2FrZV9kb21haW5zKHN0cnVj
dCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1
bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwotCXN0cnVjdCBpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2Rv
bWFpbiAqZndfZG9tYWluOwotCXVuc2lnbmVkIGludCB0bXA7Ci0KLQlzZXFfcHJpbnRmKG0sICJ1
c2VyLmJ5cGFzc19jb3VudCA9ICV1XG4iLAotCQkgICB1bmNvcmUtPnVzZXJfZm9yY2V3YWtlX2Nv
dW50KTsKLQotCWZvcl9lYWNoX2Z3X2RvbWFpbihmd19kb21haW4sIHVuY29yZSwgdG1wKQotCQlz
ZXFfcHJpbnRmKG0sICIlcy53YWtlX2NvdW50ID0gJXVcbiIsCi0JCQkgICBpbnRlbF91bmNvcmVf
Zm9yY2V3YWtlX2RvbWFpbl90b19zdHIoZndfZG9tYWluLT5pZCksCi0JCQkgICBSRUFEX09OQ0Uo
ZndfZG9tYWluLT53YWtlX2NvdW50KSk7Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIHZvaWQg
cHJpbnRfcmM2X3JlcyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sCi0JCQkgIGNvbnN0IGNoYXIgKnRpdGxl
LAotCQkJICBjb25zdCBpOTE1X3JlZ190IHJlZykKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKLQlpbnRlbF93YWtlcmVmX3Qgd2Fr
ZXJlZjsKLQotCXdpdGhfaW50ZWxfcnVudGltZV9wbSgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJl
ZikKLQkJc2VxX3ByaW50ZihtLCAiJXMgJXUgKCVsbHUgdXMpXG4iLCB0aXRsZSwKLQkJCSAgIGlu
dGVsX3VuY29yZV9yZWFkKCZpOTE1LT51bmNvcmUsIHJlZyksCi0JCQkgICBpbnRlbF9yYzZfcmVz
aWRlbmN5X3VzKCZpOTE1LT5ndC5yYzYsIHJlZykpOwotfQotCi1zdGF0aWMgaW50IHZsdl9kcnBj
X2luZm8oc3RydWN0IHNlcV9maWxlICptKQotewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKLQl1MzIgcmNjdGwxLCBwd19zdGF0
dXM7Ci0KLQlwd19zdGF0dXMgPSBJOTE1X1JFQUQoVkxWX0dUTENfUFdfU1RBVFVTKTsKLQlyY2N0
bDEgPSBJOTE1X1JFQUQoR0VONl9SQ19DT05UUk9MKTsKLQotCXNlcV9wcmludGYobSwgIlJDNiBF
bmFibGVkOiAlc1xuIiwKLQkJICAgeWVzbm8ocmNjdGwxICYgKEdFTjdfUkNfQ1RMX1RPX01PREUg
fAotCQkJCQlHRU42X1JDX0NUTF9FSV9NT0RFKDEpKSkpOwotCXNlcV9wcmludGYobSwgIlJlbmRl
ciBQb3dlciBXZWxsOiAlc1xuIiwKLQkJICAgKHB3X3N0YXR1cyAmIFZMVl9HVExDX1BXX1JFTkRF
Ul9TVEFUVVNfTUFTSykgPyAiVXAiIDogIkRvd24iKTsKLQlzZXFfcHJpbnRmKG0sICJNZWRpYSBQ
b3dlciBXZWxsOiAlc1xuIiwKLQkJICAgKHB3X3N0YXR1cyAmIFZMVl9HVExDX1BXX01FRElBX1NU
QVRVU19NQVNLKSA/ICJVcCIgOiAiRG93biIpOwotCi0JcHJpbnRfcmM2X3JlcyhtLCAiUmVuZGVy
IFJDNiByZXNpZGVuY3kgc2luY2UgYm9vdDoiLCBWTFZfR1RfUkVOREVSX1JDNik7Ci0JcHJpbnRf
cmM2X3JlcyhtLCAiTWVkaWEgUkM2IHJlc2lkZW5jeSBzaW5jZSBib290OiIsIFZMVl9HVF9NRURJ
QV9SQzYpOwotCi0JcmV0dXJuIGk5MTVfZm9yY2V3YWtlX2RvbWFpbnMobSwgTlVMTCk7Ci19Ci0K
LXN0YXRpYyBpbnQgZ2VuNl9kcnBjX2luZm8oc3RydWN0IHNlcV9maWxlICptKQotewotCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsK
LQl1MzIgZ3RfY29yZV9zdGF0dXMsIHJjY3RsMSwgcmM2dmlkcyA9IDA7Ci0JdTMyIGdlbjlfcG93
ZXJnYXRlX2VuYWJsZSA9IDAsIGdlbjlfcG93ZXJnYXRlX3N0YXR1cyA9IDA7Ci0KLQlndF9jb3Jl
X3N0YXR1cyA9IEk5MTVfUkVBRF9GVyhHRU42X0dUX0NPUkVfU1RBVFVTKTsKLQl0cmFjZV9pOTE1
X3JlZ19ydyhmYWxzZSwgR0VONl9HVF9DT1JFX1NUQVRVUywgZ3RfY29yZV9zdGF0dXMsIDQsIHRy
dWUpOwotCi0JcmNjdGwxID0gSTkxNV9SRUFEKEdFTjZfUkNfQ09OVFJPTCk7Ci0JaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPj0gOSkgewotCQlnZW45X3Bvd2VyZ2F0ZV9lbmFibGUgPSBJOTE1X1JF
QUQoR0VOOV9QR19FTkFCTEUpOwotCQlnZW45X3Bvd2VyZ2F0ZV9zdGF0dXMgPSBJOTE1X1JFQUQo
R0VOOV9QV1JHVF9ET01BSU5fU1RBVFVTKTsKLQl9Ci0KLQlpZiAoSU5URUxfR0VOKGRldl9wcml2
KSA8PSA3KQotCQlzYW5keWJyaWRnZV9wY29kZV9yZWFkKGRldl9wcml2LCBHRU42X1BDT0RFX1JF
QURfUkM2VklEUywKLQkJCQkgICAgICAgJnJjNnZpZHMsIE5VTEwpOwotCi0Jc2VxX3ByaW50Ziht
LCAiUkMxZSBFbmFibGVkOiAlc1xuIiwKLQkJICAgeWVzbm8ocmNjdGwxICYgR0VONl9SQ19DVExf
UkMxZV9FTkFCTEUpKTsKLQlzZXFfcHJpbnRmKG0sICJSQzYgRW5hYmxlZDogJXNcbiIsCi0JCSAg
IHllc25vKHJjY3RsMSAmIEdFTjZfUkNfQ1RMX1JDNl9FTkFCTEUpKTsKLQlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSA5KSB7Ci0JCXNlcV9wcmludGYobSwgIlJlbmRlciBXZWxsIEdhdGluZyBF
bmFibGVkOiAlc1xuIiwKLQkJCXllc25vKGdlbjlfcG93ZXJnYXRlX2VuYWJsZSAmIEdFTjlfUkVO
REVSX1BHX0VOQUJMRSkpOwotCQlzZXFfcHJpbnRmKG0sICJNZWRpYSBXZWxsIEdhdGluZyBFbmFi
bGVkOiAlc1xuIiwKLQkJCXllc25vKGdlbjlfcG93ZXJnYXRlX2VuYWJsZSAmIEdFTjlfTUVESUFf
UEdfRU5BQkxFKSk7Ci0JfQotCXNlcV9wcmludGYobSwgIkRlZXAgUkM2IEVuYWJsZWQ6ICVzXG4i
LAotCQkgICB5ZXNubyhyY2N0bDEgJiBHRU42X1JDX0NUTF9SQzZwX0VOQUJMRSkpOwotCXNlcV9w
cmludGYobSwgIkRlZXBlc3QgUkM2IEVuYWJsZWQ6ICVzXG4iLAotCQkgICB5ZXNubyhyY2N0bDEg
JiBHRU42X1JDX0NUTF9SQzZwcF9FTkFCTEUpKTsKLQlzZXFfcHV0cyhtLCAiQ3VycmVudCBSQyBz
dGF0ZTogIik7Ci0Jc3dpdGNoIChndF9jb3JlX3N0YXR1cyAmIEdFTjZfUkNuX01BU0spIHsKLQlj
YXNlIEdFTjZfUkMwOgotCQlpZiAoZ3RfY29yZV9zdGF0dXMgJiBHRU42X0NPUkVfQ1BEX1NUQVRF
X01BU0spCi0JCQlzZXFfcHV0cyhtLCAiQ29yZSBQb3dlciBEb3duXG4iKTsKLQkJZWxzZQotCQkJ
c2VxX3B1dHMobSwgIm9uXG4iKTsKLQkJYnJlYWs7Ci0JY2FzZSBHRU42X1JDMzoKLQkJc2VxX3B1
dHMobSwgIlJDM1xuIik7Ci0JCWJyZWFrOwotCWNhc2UgR0VONl9SQzY6Ci0JCXNlcV9wdXRzKG0s
ICJSQzZcbiIpOwotCQlicmVhazsKLQljYXNlIEdFTjZfUkM3OgotCQlzZXFfcHV0cyhtLCAiUkM3
XG4iKTsKLQkJYnJlYWs7Ci0JZGVmYXVsdDoKLQkJc2VxX3B1dHMobSwgIlVua25vd25cbiIpOwot
CQlicmVhazsKLQl9Ci0KLQlzZXFfcHJpbnRmKG0sICJDb3JlIFBvd2VyIERvd246ICVzXG4iLAot
CQkgICB5ZXNubyhndF9jb3JlX3N0YXR1cyAmIEdFTjZfQ09SRV9DUERfU1RBVEVfTUFTSykpOwot
CWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpIHsKLQkJc2VxX3ByaW50ZihtLCAiUmVuZGVy
IFBvd2VyIFdlbGw6ICVzXG4iLAotCQkJKGdlbjlfcG93ZXJnYXRlX3N0YXR1cyAmCi0JCQkgR0VO
OV9QV1JHVF9SRU5ERVJfU1RBVFVTX01BU0spID8gIlVwIiA6ICJEb3duIik7Ci0JCXNlcV9wcmlu
dGYobSwgIk1lZGlhIFBvd2VyIFdlbGw6ICVzXG4iLAotCQkJKGdlbjlfcG93ZXJnYXRlX3N0YXR1
cyAmCi0JCQkgR0VOOV9QV1JHVF9NRURJQV9TVEFUVVNfTUFTSykgPyAiVXAiIDogIkRvd24iKTsK
LQl9Ci0KLQkvKiBOb3QgZXhhY3RseSBzdXJlIHdoYXQgdGhpcyBpcyAqLwotCXByaW50X3JjNl9y
ZXMobSwgIlJDNiBcIkxvY2tlZCB0byBSUG5cIiByZXNpZGVuY3kgc2luY2UgYm9vdDoiLAotCQkg
ICAgICBHRU42X0dUX0dGWF9SQzZfTE9DS0VEKTsKLQlwcmludF9yYzZfcmVzKG0sICJSQzYgcmVz
aWRlbmN5IHNpbmNlIGJvb3Q6IiwgR0VONl9HVF9HRlhfUkM2KTsKLQlwcmludF9yYzZfcmVzKG0s
ICJSQzYrIHJlc2lkZW5jeSBzaW5jZSBib290OiIsIEdFTjZfR1RfR0ZYX1JDNnApOwotCXByaW50
X3JjNl9yZXMobSwgIlJDNisrIHJlc2lkZW5jeSBzaW5jZSBib290OiIsIEdFTjZfR1RfR0ZYX1JD
NnBwKTsKLQotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDcpIHsKLQkJc2VxX3ByaW50Ziht
LCAiUkM2ICAgdm9sdGFnZTogJWRtVlxuIiwKLQkJCSAgIEdFTjZfREVDT0RFX1JDNl9WSUQoKChy
YzZ2aWRzID4+IDApICYgMHhmZikpKTsKLQkJc2VxX3ByaW50ZihtLCAiUkM2KyAgdm9sdGFnZTog
JWRtVlxuIiwKLQkJCSAgIEdFTjZfREVDT0RFX1JDNl9WSUQoKChyYzZ2aWRzID4+IDgpICYgMHhm
ZikpKTsKLQkJc2VxX3ByaW50ZihtLCAiUkM2Kysgdm9sdGFnZTogJWRtVlxuIiwKLQkJCSAgIEdF
TjZfREVDT0RFX1JDNl9WSUQoKChyYzZ2aWRzID4+IDE2KSAmIDB4ZmYpKSk7Ci0JfQotCi0JcmV0
dXJuIGk5MTVfZm9yY2V3YWtlX2RvbWFpbnMobSwgTlVMTCk7Ci19Ci0KLXN0YXRpYyBpbnQgaTkx
NV9kcnBjX2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCi17Ci0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwot
CWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwotCWludCBlcnIgPSAtRU5PREVWOwotCi0Jd2l0aF9p
bnRlbF9ydW50aW1lX3BtKCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZikgewotCQlpZiAo
SVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCi0JCQll
cnIgPSB2bHZfZHJwY19pbmZvKG0pOwotCQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDYpCi0JCQllcnIgPSBnZW42X2RycGNfaW5mbyhtKTsKLQkJZWxzZQotCQkJZXJyID0gaXJvbmxh
a2VfZHJwY19pbmZvKG0pOwotCX0KLQotCXJldHVybiBlcnI7Ci19Ci0KIHN0YXRpYyBpbnQgaTkx
NV9mcm9udGJ1ZmZlcl90cmFja2luZyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkK
IHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+
cHJpdmF0ZSk7CkBAIC0xMzYyLDQ3ICs5MjQsNiBAQCBzdGF0aWMgaW50IGk5MTVfc3Jfc3RhdHVz
KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogCXJldHVybiAwOwogfQogCi1zdGF0
aWMgaW50IGk5MTVfcmluZ19mcmVxX3RhYmxlKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51
c2VkKQotewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkx
NShtLT5wcml2YXRlKTsKLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0LnJw
czsKLQl1bnNpZ25lZCBpbnQgbWF4X2dwdV9mcmVxLCBtaW5fZ3B1X2ZyZXE7Ci0JaW50ZWxfd2Fr
ZXJlZl90IHdha2VyZWY7Ci0JaW50IGdwdV9mcmVxLCBpYV9mcmVxOwotCi0JaWYgKCFIQVNfTExD
KGRldl9wcml2KSkKLQkJcmV0dXJuIC1FTk9ERVY7Ci0KLQltaW5fZ3B1X2ZyZXEgPSBycHMtPm1p
bl9mcmVxOwotCW1heF9ncHVfZnJlcSA9IHJwcy0+bWF4X2ZyZXE7Ci0JaWYgKElTX0dFTjlfQkMo
ZGV2X3ByaXYpIHx8IElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTApIHsKLQkJLyogQ29udmVydCBH
VCBmcmVxdWVuY3kgdG8gNTAgSFogdW5pdHMgKi8KLQkJbWluX2dwdV9mcmVxIC89IEdFTjlfRlJF
UV9TQ0FMRVI7Ci0JCW1heF9ncHVfZnJlcSAvPSBHRU45X0ZSRVFfU0NBTEVSOwotCX0KLQotCXNl
cV9wdXRzKG0sICJHUFUgZnJlcSAoTUh6KVx0RWZmZWN0aXZlIENQVSBmcmVxIChNSHopXHRFZmZl
Y3RpdmUgUmluZyBmcmVxIChNSHopXG4iKTsKLQotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3Bt
X2dldCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOwotCWZvciAoZ3B1X2ZyZXEgPSBtaW5fZ3B1X2Zy
ZXE7IGdwdV9mcmVxIDw9IG1heF9ncHVfZnJlcTsgZ3B1X2ZyZXErKykgewotCQlpYV9mcmVxID0g
Z3B1X2ZyZXE7Ci0JCXNhbmR5YnJpZGdlX3Bjb2RlX3JlYWQoZGV2X3ByaXYsCi0JCQkJICAgICAg
IEdFTjZfUENPREVfUkVBRF9NSU5fRlJFUV9UQUJMRSwKLQkJCQkgICAgICAgJmlhX2ZyZXEsIE5V
TEwpOwotCQlzZXFfcHJpbnRmKG0sICIlZFx0XHQlZFx0XHRcdFx0JWRcbiIsCi0JCQkgICBpbnRl
bF9ncHVfZnJlcShycHMsCi0JCQkJCSAgKGdwdV9mcmVxICoKLQkJCQkJICAgKElTX0dFTjlfQkMo
ZGV2X3ByaXYpIHx8Ci0JCQkJCSAgICBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwID8KLQkJCQkJ
ICAgIEdFTjlfRlJFUV9TQ0FMRVIgOiAxKSkpLAotCQkJICAgKChpYV9mcmVxID4+IDApICYgMHhm
ZikgKiAxMDAsCi0JCQkgICAoKGlhX2ZyZXEgPj4gOCkgJiAweGZmKSAqIDEwMCk7Ci0JfQotCWlu
dGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7Ci0KLQly
ZXR1cm4gMDsKLX0KLQogc3RhdGljIGludCBpOTE1X29wcmVnaW9uKHN0cnVjdCBzZXFfZmlsZSAq
bSwgdm9pZCAqdW51c2VkKQogewogCXN0cnVjdCBpbnRlbF9vcHJlZ2lvbiAqb3ByZWdpb24gPSAm
bm9kZV90b19pOTE1KG0tPnByaXZhdGUpLT5vcHJlZ2lvbjsKQEAgLTE2MDUsODcgKzExMjYsNiBA
QCBzdGF0aWMgaW50IGk5MTVfc3dpenpsZV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAq
ZGF0YSkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGNvbnN0IGNoYXIgKnJwc19wb3dlcl90b19z
dHIodW5zaWduZWQgaW50IHBvd2VyKQotewotCXN0YXRpYyBjb25zdCBjaGFyICogY29uc3Qgc3Ry
aW5nc1tdID0gewotCQlbTE9XX1BPV0VSXSA9ICJsb3cgcG93ZXIiLAotCQlbQkVUV0VFTl0gPSAi
bWl4ZWQiLAotCQlbSElHSF9QT1dFUl0gPSAiaGlnaCBwb3dlciIsCi0JfTsKLQotCWlmIChwb3dl
ciA+PSBBUlJBWV9TSVpFKHN0cmluZ3MpIHx8ICFzdHJpbmdzW3Bvd2VyXSkKLQkJcmV0dXJuICJ1
bmtub3duIjsKLQotCXJldHVybiBzdHJpbmdzW3Bvd2VyXTsKLX0KLQotc3RhdGljIGludCBpOTE1
X3Jwc19ib29zdF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKLXsKLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7
Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndC5ycHM7Ci0JdTMyIGFjdF9m
cmVxOwotCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwotCi0Jd2l0aF9pbnRlbF9ydW50aW1lX3Bt
X2lmX2luX3VzZSgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpCi0JCWFjdF9mcmVxID0g
aW50ZWxfcnBzX3JlYWRfYWN0dWFsX2ZyZXF1ZW5jeShycHMpOwotCi0Jc2VxX3ByaW50ZihtLCAi
UlBTIGVuYWJsZWQ/ICVkXG4iLCBycHMtPmVuYWJsZWQpOwotCXNlcV9wcmludGYobSwgIkdQVSBi
dXN5PyAlc1xuIiwgeWVzbm8oZGV2X3ByaXYtPmd0LmF3YWtlKSk7Ci0Jc2VxX3ByaW50ZihtLCAi
Qm9vc3RzIG91dHN0YW5kaW5nPyAlZFxuIiwKLQkJICAgYXRvbWljX3JlYWQoJnJwcy0+bnVtX3dh
aXRlcnMpKTsKLQlzZXFfcHJpbnRmKG0sICJJbnRlcmFjdGl2ZT8gJWRcbiIsIFJFQURfT05DRShy
cHMtPnBvd2VyLmludGVyYWN0aXZlKSk7Ci0Jc2VxX3ByaW50ZihtLCAiRnJlcXVlbmN5IHJlcXVl
c3RlZCAlZCwgYWN0dWFsICVkXG4iLAotCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+Y3Vy
X2ZyZXEpLCBhY3RfZnJlcSk7Ci0Jc2VxX3ByaW50ZihtLCAiICBtaW4gaGFyZDolZCwgc29mdDol
ZDsgbWF4IHNvZnQ6JWQsIGhhcmQ6JWRcbiIsCi0JCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBz
LT5taW5fZnJlcSksCi0JCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5taW5fZnJlcV9zb2Z0
bGltaXQpLAotCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWF4X2ZyZXFfc29mdGxpbWl0
KSwKLQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPm1heF9mcmVxKSk7Ci0Jc2VxX3ByaW50
ZihtLCAiICBpZGxlOiVkLCBlZmZpY2llbnQ6JWQsIGJvb3N0OiVkXG4iLAotCQkgICBpbnRlbF9n
cHVfZnJlcShycHMsIHJwcy0+aWRsZV9mcmVxKSwKLQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBy
cHMtPmVmZmljaWVudF9mcmVxKSwKLQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmJvb3N0
X2ZyZXEpKTsKLQotCXNlcV9wcmludGYobSwgIldhaXQgYm9vc3RzOiAlZFxuIiwgYXRvbWljX3Jl
YWQoJnJwcy0+Ym9vc3RzKSk7Ci0KLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA2ICYmIHJw
cy0+ZW5hYmxlZCAmJiBkZXZfcHJpdi0+Z3QuYXdha2UpIHsKLQkJdTMyIHJwdXAsIHJwdXBlaTsK
LQkJdTMyIHJwZG93biwgcnBkb3duZWk7Ci0KLQkJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQo
JmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotCQlycHVwID0gSTkxNV9SRUFEX0ZX
KEdFTjZfUlBfQ1VSX1VQKSAmIEdFTjZfUlBfRUlfTUFTSzsKLQkJcnB1cGVpID0gSTkxNV9SRUFE
X0ZXKEdFTjZfUlBfQ1VSX1VQX0VJKSAmIEdFTjZfUlBfRUlfTUFTSzsKLQkJcnBkb3duID0gSTkx
NV9SRUFEX0ZXKEdFTjZfUlBfQ1VSX0RPV04pICYgR0VONl9SUF9FSV9NQVNLOwotCQlycGRvd25l
aSA9IEk5MTVfUkVBRF9GVyhHRU42X1JQX0NVUl9ET1dOX0VJKSAmIEdFTjZfUlBfRUlfTUFTSzsK
LQkJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FL
RV9BTEwpOwotCi0JCXNlcV9wcmludGYobSwgIlxuUlBTIEF1dG90dW5pbmcgKGN1cnJlbnQgXCIl
c1wiIHdpbmRvdyk6XG4iLAotCQkJICAgcnBzX3Bvd2VyX3RvX3N0cihycHMtPnBvd2VyLm1vZGUp
KTsKLQkJc2VxX3ByaW50ZihtLCAiICBBdmcuIHVwOiAlZCUlIFthYm92ZSB0aHJlc2hvbGQ/ICVk
JSVdXG4iLAotCQkJICAgcnB1cCAmJiBycHVwZWkgPyAxMDAgKiBycHVwIC8gcnB1cGVpIDogMCwK
LQkJCSAgIHJwcy0+cG93ZXIudXBfdGhyZXNob2xkKTsKLQkJc2VxX3ByaW50ZihtLCAiICBBdmcu
IGRvd246ICVkJSUgW2JlbG93IHRocmVzaG9sZD8gJWQlJV1cbiIsCi0JCQkgICBycGRvd24gJiYg
cnBkb3duZWkgPyAxMDAgKiBycGRvd24gLyBycGRvd25laSA6IDAsCi0JCQkgICBycHMtPnBvd2Vy
LmRvd25fdGhyZXNob2xkKTsKLQl9IGVsc2UgewotCQlzZXFfcHV0cyhtLCAiXG5SUFMgQXV0b3R1
bmluZyBpbmFjdGl2ZVxuIik7Ci0JfQotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQgaTkx
NV9sbGMoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQotewotCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKLQljb25zdCBi
b29sIGVkcmFtID0gSU5URUxfR0VOKGRldl9wcml2KSA+IDg7Ci0KLQlzZXFfcHJpbnRmKG0sICJM
TEM6ICVzXG4iLCB5ZXNubyhIQVNfTExDKGRldl9wcml2KSkpOwotCXNlcV9wcmludGYobSwgIiVz
OiAldU1CXG4iLCBlZHJhbSA/ICJlRFJBTSIgOiAiZUxMQyIsCi0JCSAgIGRldl9wcml2LT5lZHJh
bV9zaXplX21iKTsKLQotCXJldHVybiAwOwotfQotCiBzdGF0aWMgaW50IGk5MTVfaHVjX2xvYWRf
c3RhdHVzX2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQogewogCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKQEAg
LTQyNDYsOSArMzY4Niw2IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2luZm9fbGlzdCBpOTE1
X2RlYnVnZnNfbGlzdFtdID0gewogCXsiaTkxNV9ndWNfbG9hZF9lcnJfbG9nX2R1bXAiLCBpOTE1
X2d1Y19sb2dfZHVtcCwgMCwgKHZvaWQgKikxfSwKIAl7Imk5MTVfZ3VjX3N0YWdlX3Bvb2wiLCBp
OTE1X2d1Y19zdGFnZV9wb29sLCAwfSwKIAl7Imk5MTVfaHVjX2xvYWRfc3RhdHVzIiwgaTkxNV9o
dWNfbG9hZF9zdGF0dXNfaW5mbywgMH0sCi0JeyJpOTE1X2ZyZXF1ZW5jeV9pbmZvIiwgaTkxNV9m
cmVxdWVuY3lfaW5mbywgMH0sCi0JeyJpOTE1X2RycGNfaW5mbyIsIGk5MTVfZHJwY19pbmZvLCAw
fSwKLQl7Imk5MTVfcmluZ19mcmVxX3RhYmxlIiwgaTkxNV9yaW5nX2ZyZXFfdGFibGUsIDB9LAog
CXsiaTkxNV9mcm9udGJ1ZmZlcl90cmFja2luZyIsIGk5MTVfZnJvbnRidWZmZXJfdHJhY2tpbmcs
IDB9LAogCXsiaTkxNV9mYmNfc3RhdHVzIiwgaTkxNV9mYmNfc3RhdHVzLCAwfSwKIAl7Imk5MTVf
aXBzX3N0YXR1cyIsIGk5MTVfaXBzX3N0YXR1cywgMH0sCkBAIC00MjU3LDkgKzM2OTQsNyBAQCBz
dGF0aWMgY29uc3Qgc3RydWN0IGRybV9pbmZvX2xpc3QgaTkxNV9kZWJ1Z2ZzX2xpc3RbXSA9IHsK
IAl7Imk5MTVfdmJ0IiwgaTkxNV92YnQsIDB9LAogCXsiaTkxNV9nZW1fZnJhbWVidWZmZXIiLCBp
OTE1X2dlbV9mcmFtZWJ1ZmZlcl9pbmZvLCAwfSwKIAl7Imk5MTVfY29udGV4dF9zdGF0dXMiLCBp
OTE1X2NvbnRleHRfc3RhdHVzLCAwfSwKLQl7Imk5MTVfZm9yY2V3YWtlX2RvbWFpbnMiLCBpOTE1
X2ZvcmNld2FrZV9kb21haW5zLCAwfSwKIAl7Imk5MTVfc3dpenpsZV9pbmZvIiwgaTkxNV9zd2l6
emxlX2luZm8sIDB9LAotCXsiaTkxNV9sbGMiLCBpOTE1X2xsYywgMH0sCiAJeyJpOTE1X2VkcF9w
c3Jfc3RhdHVzIiwgaTkxNV9lZHBfcHNyX3N0YXR1cywgMH0sCiAJeyJpOTE1X2VuZXJneV91SiIs
IGk5MTVfZW5lcmd5X3VKLCAwfSwKIAl7Imk5MTVfcnVudGltZV9wbV9zdGF0dXMiLCBpOTE1X3J1
bnRpbWVfcG1fc3RhdHVzLCAwfSwKQEAgLTQyNzUsNyArMzcxMCw2IEBAIHN0YXRpYyBjb25zdCBz
dHJ1Y3QgZHJtX2luZm9fbGlzdCBpOTE1X2RlYnVnZnNfbGlzdFtdID0gewogCXsiaTkxNV9kZGJf
aW5mbyIsIGk5MTVfZGRiX2luZm8sIDB9LAogCXsiaTkxNV9zc2V1X3N0YXR1cyIsIGk5MTVfc3Nl
dV9zdGF0dXMsIDB9LAogCXsiaTkxNV9kcnJzX3N0YXR1cyIsIGk5MTVfZHJyc19zdGF0dXMsIDB9
LAotCXsiaTkxNV9ycHNfYm9vc3RfaW5mbyIsIGk5MTVfcnBzX2Jvb3N0X2luZm8sIDB9LAogfTsK
ICNkZWZpbmUgSTkxNV9ERUJVR0ZTX0VOVFJJRVMgQVJSQVlfU0laRShpOTE1X2RlYnVnZnNfbGlz
dCkKIApAQCAtNDMxMSw2ICszNzQ1LDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X2RlYnVn
ZnNfZmlsZXMgewogaW50IGk5MTVfZGVidWdmc19yZWdpc3RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCiB7CiAJc3RydWN0IGRybV9taW5vciAqbWlub3IgPSBkZXZfcHJpdi0+
ZHJtLnByaW1hcnk7CisJaW50IGVycjsKIAlpbnQgaTsKIAogCWRlYnVnZnNfY3JlYXRlX2ZpbGUo
Imk5MTVfZm9yY2V3YWtlX3VzZXIiLCBTX0lSVVNSLCBtaW5vci0+ZGVidWdmc19yb290LApAQCAt
NDMyNCw5ICszNzU5LDEzIEBAIGludCBpOTE1X2RlYnVnZnNfcmVnaXN0ZXIoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQogCQkJCSAgICBpOTE1X2RlYnVnZnNfZmlsZXNbaV0uZm9w
cyk7CiAJfQogCi0JcmV0dXJuIGRybV9kZWJ1Z2ZzX2NyZWF0ZV9maWxlcyhpOTE1X2RlYnVnZnNf
bGlzdCwKLQkJCQkJSTkxNV9ERUJVR0ZTX0VOVFJJRVMsCi0JCQkJCW1pbm9yLT5kZWJ1Z2ZzX3Jv
b3QsIG1pbm9yKTsKKwllcnIgPSBkcm1fZGVidWdmc19jcmVhdGVfZmlsZXMoaTkxNV9kZWJ1Z2Zz
X2xpc3QsCisJCQkJICAgICAgIEk5MTVfREVCVUdGU19FTlRSSUVTLAorCQkJCSAgICAgICBtaW5v
ci0+ZGVidWdmc19yb290LCBtaW5vcik7CisJaWYgKGVycikKKwkJcmV0dXJuIGVycjsKKworCXJl
dHVybiBkZWJ1Z2ZzX2d0X2luaXQoJmRldl9wcml2LT5ndCk7CiB9CiAKIHN0cnVjdCBkcGNkX2Js
b2NrIHsKLS0gCjIuMjQuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0
b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50
ZWwtZ2Z4Cg==

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 78E6918BCBD
	for <lists+intel-gfx@lfdr.de>; Thu, 19 Mar 2020 17:38:55 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 62E6289DBD;
	Thu, 19 Mar 2020 16:38:53 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga06.intel.com (mga06.intel.com [134.134.136.31])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6D9D689DBD
 for <intel-gfx@lists.freedesktop.org>; Thu, 19 Mar 2020 16:38:51 +0000 (UTC)
IronPort-SDR: Gg7PClKr8VezIFJ9mmphkTL29L6UsGTeP6pKCMijDdqT7mlOcEyuYiVSGd445v9OpWR6svNVyz
 biQCLm/tde9Q==
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga006.jf.intel.com ([10.7.209.51])
 by orsmga104.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 19 Mar 2020 09:38:50 -0700
IronPort-SDR: Vm0JmMnocVKKQyVh/3QgRGDFuehYJrHu65LKdwMHhtkYnbwkyuQ6gV84oOQZ3vgnzLWo/4jvYW
 ZyAVAQBv71sQ==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.70,572,1574150400"; d="scan'208";a="248592377"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.174])
 by orsmga006.jf.intel.com with SMTP; 19 Mar 2020 09:38:48 -0700
Received: by stinkbox (sSMTP sendmail emulation);
 Thu, 19 Mar 2020 18:38:48 +0200
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 19 Mar 2020 18:38:43 +0200
Message-Id: <20200319163844.22783-2-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.24.1
In-Reply-To: <20200319163844.22783-1-ville.syrjala@linux.intel.com>
References: <20200319163844.22783-1-ville.syrjala@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 2/3] drm: Refactor
 intel_dp_compute_link_config_*()
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KClB1
bGwgdGhlIGNvbW1vbiBwYXJ0cyBvZiBpbnRlbF9kcF9jb21wdXRlX2xpbmtfY29uZmlnX3dpZGUo
KQphbmQgaW50ZWxfZHBfY29tcHV0ZV9saW5rX2NvbmZpZ19mYXN0KCkgaW50byBhIHNoYXJlZCBo
ZWxwZXIKdG8gYXZvaWQgZHVwbGljYXRlZCBjb2RlLgoKU2lnbmVkLW9mZi1ieTogVmlsbGUgU3ly
asOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwLmMgfCA3NiArKysrKysrKysrKysrKy0tLS0tLS0tLS0t
CiAxIGZpbGUgY2hhbmdlZCwgNDQgaW5zZXJ0aW9ucygrKSwgMzIgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jCmluZGV4IDg1YWJjY2U0OTJjYS4uODQ5
MWNlOGI4YzE1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2RwLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jCkBAIC0y
MDE0LDM0ICsyMDE0LDQ3IEBAIHN0YXRpYyBpbnQgaW50ZWxfZHBfb3V0cHV0X2JwcChjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwgaW50IGJwCiAJcmV0dXJuIGJwcDsK
IH0KIAorc3RhdGljIGJvb2wKK2ludGVsX2RwX2xpbmtfY29uZmlnX3ZhbGlkKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAorCQkJICAgaW50IGJwcCwgaW50IGxpbmtf
Y2xvY2ssIGludCBsYW5lX2NvdW50KQoreworCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2Rl
ICphZGp1c3RlZF9tb2RlID0KKwkJJmNydGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGU7CisJaW50
IG91dHB1dF9icHAgPSBpbnRlbF9kcF9vdXRwdXRfYnBwKGNydGNfc3RhdGUsIGJwcCk7CisJaW50
IG1vZGVfcmF0ZSA9IGludGVsX2RwX2xpbmtfcmVxdWlyZWQoYWRqdXN0ZWRfbW9kZS0+Y3J0Y19j
bG9jaywKKwkJCQkJICAgICAgIG91dHB1dF9icHApOworCWludCBsaW5rX2F2YWlsID0gaW50ZWxf
ZHBfbWF4X2RhdGFfcmF0ZShsaW5rX2Nsb2NrLCBsYW5lX2NvdW50KTsKKworCXJldHVybiBtb2Rl
X3JhdGUgPD0gbGlua19hdmFpbDsKK30KKwogLyogT3B0aW1pemUgbGluayBjb25maWcgaW4gb3Jk
ZXI6IG1heCBicHAsIG1pbiBjbG9jaywgbWluIGxhbmVzICovCiBzdGF0aWMgaW50CiBpbnRlbF9k
cF9jb21wdXRlX2xpbmtfY29uZmlnX3dpZGUoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKLQkJ
CQkgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKKwkJCQkgIHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCQkJCSAgY29uc3Qgc3RydWN0IGxpbmtfY29u
ZmlnX2xpbWl0cyAqbGltaXRzKQogewotCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3Rl
ZF9tb2RlID0gJnBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlOwotCWludCBicHAsIGNsb2Nr
LCBsYW5lX2NvdW50OwotCWludCBtb2RlX3JhdGUsIGxpbmtfY2xvY2ssIGxpbmtfYXZhaWw7CisJ
aW50IGJwcDsKIAogCWZvciAoYnBwID0gbGltaXRzLT5tYXhfYnBwOyBicHAgPj0gbGltaXRzLT5t
aW5fYnBwOyBicHAgLT0gMiAqIDMpIHsKLQkJaW50IG91dHB1dF9icHAgPSBpbnRlbF9kcF9vdXRw
dXRfYnBwKHBpcGVfY29uZmlnLCBicHApOworCQlpbnQgY2xvY2s7CiAKLQkJbW9kZV9yYXRlID0g
aW50ZWxfZHBfbGlua19yZXF1aXJlZChhZGp1c3RlZF9tb2RlLT5jcnRjX2Nsb2NrLAotCQkJCQkJ
ICAgb3V0cHV0X2JwcCk7CisJCWZvciAoY2xvY2sgPSBsaW1pdHMtPm1pbl9jbG9jazsKKwkJICAg
ICBjbG9jayA8PSBsaW1pdHMtPm1heF9jbG9jazsKKwkJICAgICBjbG9jaysrKSB7CisJCQlpbnQg
bGFuZV9jb3VudDsKIAotCQlmb3IgKGNsb2NrID0gbGltaXRzLT5taW5fY2xvY2s7IGNsb2NrIDw9
IGxpbWl0cy0+bWF4X2Nsb2NrOyBjbG9jaysrKSB7CiAJCQlmb3IgKGxhbmVfY291bnQgPSBsaW1p
dHMtPm1pbl9sYW5lX2NvdW50OwogCQkJICAgICBsYW5lX2NvdW50IDw9IGxpbWl0cy0+bWF4X2xh
bmVfY291bnQ7CiAJCQkgICAgIGxhbmVfY291bnQgPDw9IDEpIHsKLQkJCQlsaW5rX2Nsb2NrID0g
aW50ZWxfZHAtPmNvbW1vbl9yYXRlc1tjbG9ja107Ci0JCQkJbGlua19hdmFpbCA9IGludGVsX2Rw
X21heF9kYXRhX3JhdGUobGlua19jbG9jaywKLQkJCQkJCQkJICAgIGxhbmVfY291bnQpOworCQkJ
CWludCBsaW5rX2Nsb2NrID0gaW50ZWxfZHAtPmNvbW1vbl9yYXRlc1tjbG9ja107CiAKLQkJCQlp
ZiAobW9kZV9yYXRlIDw9IGxpbmtfYXZhaWwpIHsKLQkJCQkJcGlwZV9jb25maWctPmxhbmVfY291
bnQgPSBsYW5lX2NvdW50OwotCQkJCQlwaXBlX2NvbmZpZy0+cGlwZV9icHAgPSBicHA7Ci0JCQkJ
CXBpcGVfY29uZmlnLT5wb3J0X2Nsb2NrID0gbGlua19jbG9jazsKKwkJCQlpZiAoaW50ZWxfZHBf
bGlua19jb25maWdfdmFsaWQoY3J0Y19zdGF0ZSwgYnBwLAorCQkJCQkJCSAgICAgICBsaW5rX2Ns
b2NrLAorCQkJCQkJCSAgICAgICBsYW5lX2NvdW50KSkgeworCQkJCQljcnRjX3N0YXRlLT5waXBl
X2JwcCA9IGJwcDsKKwkJCQkJY3J0Y19zdGF0ZS0+cG9ydF9jbG9jayA9IGxpbmtfY2xvY2s7CisJ
CQkJCWNydGNfc3RhdGUtPmxhbmVfY291bnQgPSBsYW5lX2NvdW50OwogCiAJCQkJCXJldHVybiAw
OwogCQkJCX0KQEAgLTIwNTUsMzEgKzIwNjgsMzAgQEAgaW50ZWxfZHBfY29tcHV0ZV9saW5rX2Nv
bmZpZ193aWRlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCiAvKiBPcHRpbWl6ZSBsaW5rIGNv
bmZpZyBpbiBvcmRlcjogbWF4IGJwcCwgbWluIGxhbmVzLCBtaW4gY2xvY2sgKi8KIHN0YXRpYyBp
bnQKIGludGVsX2RwX2NvbXB1dGVfbGlua19jb25maWdfZmFzdChzdHJ1Y3QgaW50ZWxfZHAgKmlu
dGVsX2RwLAotCQkJCSAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAorCQkJ
CSAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCQkJICBjb25zdCBzdHJ1
Y3QgbGlua19jb25maWdfbGltaXRzICpsaW1pdHMpCiB7Ci0JY29uc3Qgc3RydWN0IGRybV9kaXNw
bGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGU7
Ci0JaW50IGJwcCwgY2xvY2ssIGxhbmVfY291bnQ7Ci0JaW50IG1vZGVfcmF0ZSwgbGlua19jbG9j
aywgbGlua19hdmFpbDsKKwlpbnQgYnBwOwogCiAJZm9yIChicHAgPSBsaW1pdHMtPm1heF9icHA7
IGJwcCA+PSBsaW1pdHMtPm1pbl9icHA7IGJwcCAtPSAyICogMykgewotCQlpbnQgb3V0cHV0X2Jw
cCA9IGludGVsX2RwX291dHB1dF9icHAocGlwZV9jb25maWcsIGJwcCk7Ci0KLQkJbW9kZV9yYXRl
ID0gaW50ZWxfZHBfbGlua19yZXF1aXJlZChhZGp1c3RlZF9tb2RlLT5jcnRjX2Nsb2NrLAotCQkJ
CQkJICAgb3V0cHV0X2JwcCk7CisJCWludCBsYW5lX2NvdW50OwogCiAJCWZvciAobGFuZV9jb3Vu
dCA9IGxpbWl0cy0+bWluX2xhbmVfY291bnQ7CiAJCSAgICAgbGFuZV9jb3VudCA8PSBsaW1pdHMt
Pm1heF9sYW5lX2NvdW50OwogCQkgICAgIGxhbmVfY291bnQgPDw9IDEpIHsKLQkJCWZvciAoY2xv
Y2sgPSBsaW1pdHMtPm1pbl9jbG9jazsgY2xvY2sgPD0gbGltaXRzLT5tYXhfY2xvY2s7IGNsb2Nr
KyspIHsKLQkJCQlsaW5rX2Nsb2NrID0gaW50ZWxfZHAtPmNvbW1vbl9yYXRlc1tjbG9ja107Ci0J
CQkJbGlua19hdmFpbCA9IGludGVsX2RwX21heF9kYXRhX3JhdGUobGlua19jbG9jaywKLQkJCQkJ
CQkJICAgIGxhbmVfY291bnQpOwotCi0JCQkJaWYgKG1vZGVfcmF0ZSA8PSBsaW5rX2F2YWlsKSB7
Ci0JCQkJCXBpcGVfY29uZmlnLT5sYW5lX2NvdW50ID0gbGFuZV9jb3VudDsKLQkJCQkJcGlwZV9j
b25maWctPnBpcGVfYnBwID0gYnBwOwotCQkJCQlwaXBlX2NvbmZpZy0+cG9ydF9jbG9jayA9IGxp
bmtfY2xvY2s7CisJCQlpbnQgY2xvY2s7CisKKwkJCWZvciAoY2xvY2sgPSBsaW1pdHMtPm1pbl9j
bG9jazsKKwkJCSAgICAgY2xvY2sgPD0gbGltaXRzLT5tYXhfY2xvY2s7CisJCQkgICAgIGNsb2Nr
KyspIHsKKwkJCQlpbnQgbGlua19jbG9jayA9IGludGVsX2RwLT5jb21tb25fcmF0ZXNbY2xvY2td
OworCisJCQkJaWYgKGludGVsX2RwX2xpbmtfY29uZmlnX3ZhbGlkKGNydGNfc3RhdGUsIGJwcCwK
KwkJCQkJCQkgICAgICAgbGlua19jbG9jaywKKwkJCQkJCQkgICAgICAgbGFuZV9jb3VudCkpIHsK
KwkJCQkJY3J0Y19zdGF0ZS0+cGlwZV9icHAgPSBicHA7CisJCQkJCWNydGNfc3RhdGUtPnBvcnRf
Y2xvY2sgPSBsaW5rX2Nsb2NrOworCQkJCQljcnRjX3N0YXRlLT5sYW5lX2NvdW50ID0gbGFuZV9j
b3VudDsKIAogCQkJCQlyZXR1cm4gMDsKIAkJCQl9Ci0tIAoyLjI0LjEKCl9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QK
SW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9w
Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeAo=

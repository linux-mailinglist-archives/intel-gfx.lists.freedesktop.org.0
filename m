Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 3A01FFC269
	for <lists+intel-gfx@lfdr.de>; Thu, 14 Nov 2019 10:15:47 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 812DD6E503;
	Thu, 14 Nov 2019 09:15:45 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A85FC6E503
 for <intel-gfx@lists.freedesktop.org>; Thu, 14 Nov 2019 09:15:43 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19197364-1500050 
 for multiple; Thu, 14 Nov 2019 09:15:12 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 14 Nov 2019 09:15:12 +0000
Message-Id: <20191114091512.11137-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191114083436.2261-1-chris@chris-wilson.co.uk>
References: <20191114083436.2261-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915/selftests: Exercise rc6 handling
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UmVhZGluZyBmcm9tIENUWF9JTkZPIHVwc2V0cyByYzYsIHJlcXVpcmluZyB1cyB0byBkZXRlY3Qg
YW5kIHByZXZlbnQKcG9zc2libGUgcmM2IGNvbnRleHQgY29ycnVwdGlvbi4gUG9rZSBhdCB0aGUg
YmVhciEKClNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNv
LnVrPgpDYzogSW1yZSBEZWFrIDxpbXJlLmRlYWtAaW50ZWwuY29tPgpDYzogTWlrYSBLdW9wcGFs
YSA8bWlrYS5rdW9wcGFsYUBsaW51eC5pbnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfcmM2LmMgICAgICAgICAgIHwgICA0ICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L3NlbGZ0ZXN0X2d0X3BtLmMgICAgICB8ICAxMyArKwogZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3Qvc2VsZnRlc3RfcmM2LmMgICAgICAgIHwgMTM0ICsrKysrKysrKysrKysrKysrKwogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfcmM2LmggICAgICAgIHwgIDEyICsrCiAuLi4vZHJt
L2k5MTUvc2VsZnRlc3RzL2k5MTVfbGl2ZV9zZWxmdGVzdHMuaCAgfCAgIDEgKwogNSBmaWxlcyBj
aGFuZ2VkLCAxNjQgaW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3JjNi5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfcmM2LmgKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9yYzYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jj
Ni5jCmluZGV4IGY3YzBiYWViMzc5My4uMGRlMzVkMThhMmIyIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yYzYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9yYzYuYwpAQCAtNzc3LDMgKzc3Nyw3IEBAIHU2NCBpbnRlbF9yYzZfcmVzaWRlbmN5
X3VzKHN0cnVjdCBpbnRlbF9yYzYgKnJjNiwgaTkxNV9yZWdfdCByZWcpCiB7CiAJcmV0dXJuIERJ
Vl9ST1VORF9VUF9VTEwoaW50ZWxfcmM2X3Jlc2lkZW5jeV9ucyhyYzYsIHJlZyksIDEwMDApOwog
fQorCisjaWYgSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfU0VMRlRFU1QpCisjaW5jbHVkZSAi
c2VsZnRlc3RfcmM2LmMiCisjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L3NlbGZ0ZXN0X2d0X3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9n
dF9wbS5jCmluZGV4IGQxNzUyZjE1NzAyYS4uMWQ1YmY5M2QxMjU4IDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9ndF9wbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3NlbGZ0ZXN0X2d0X3BtLmMKQEAgLTYsNiArNiw3IEBACiAgKi8KIAogI2luY2x1
ZGUgInNlbGZ0ZXN0X2xsYy5oIgorI2luY2x1ZGUgInNlbGZ0ZXN0X3JjNi5oIgogCiBzdGF0aWMg
aW50IGxpdmVfZ3RfcmVzdW1lKHZvaWQgKmFyZykKIHsKQEAgLTU4LDMgKzU5LDE1IEBAIGludCBp
bnRlbF9ndF9wbV9saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
IAogCXJldHVybiBpbnRlbF9ndF9saXZlX3N1YnRlc3RzKHRlc3RzLCAmaTkxNS0+Z3QpOwogfQor
CitpbnQgaW50ZWxfZ3RfcG1fbGF0ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCit7CisJc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3N1YnRlc3QgdGVzdHNbXSA9IHsK
KwkJU1VCVEVTVChsaXZlX3JjNl9jdHgpLAorCX07CisKKwlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2Vk
KCZpOTE1LT5ndCkpCisJCXJldHVybiAwOworCisJcmV0dXJuIGludGVsX2d0X2xpdmVfc3VidGVz
dHModGVzdHMsICZpOTE1LT5ndCk7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9zZWxmdGVzdF9yYzYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3Jj
Ni5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMDAyYWY3NmFiOGQ0
Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfcmM2
LmMKQEAgLTAsMCArMSwxMzQgQEAKKy8qCisgKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlU
CisgKgorICogQ29weXJpZ2h0IMKpIDIwMTkgSW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisjaW5j
bHVkZSAiaW50ZWxfY29udGV4dC5oIgorI2luY2x1ZGUgImludGVsX2VuZ2luZV9wbS5oIgorI2lu
Y2x1ZGUgImludGVsX2d0X3JlcXVlc3RzLmgiCisjaW5jbHVkZSAiaW50ZWxfcmluZy5oIgorI2lu
Y2x1ZGUgInNlbGZ0ZXN0X3JjNi5oIgorCisjaW5jbHVkZSAic2VsZnRlc3RzL2k5MTVfcmFuZG9t
LmgiCisKK3N0YXRpYyBjb25zdCB1MzIgKl9fbGl2ZV9yYzZfY3R4KHN0cnVjdCBpbnRlbF9jb250
ZXh0ICpjZSkKK3sKKwlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKKwl1MzIgY29uc3QgKnJlc3Vs
dDsKKwl1MzIgKmNzOworCisJcnEgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZV9yZXF1ZXN0KGNlKTsK
KwlpZiAoSVNfRVJSKHJxKSkKKwkJcmV0dXJuIEVSUl9DQVNUKHJxKTsKKworCWNzID0gaW50ZWxf
cmluZ19iZWdpbihycSwgNCk7CisJaWYgKElTX0VSUihjcykpIHsKKwkJaTkxNV9yZXF1ZXN0X2Fk
ZChycSk7CisJCXJldHVybiBjczsKKwl9CisKKwkqY3MrKyA9IE1JX1NUT1JFX1JFR0lTVEVSX01F
TV9HRU44IHwgTUlfVVNFX0dHVFQ7CisJKmNzKysgPSAweEEzMDA7IC8qIENUWF9JTkZPICovCisJ
KmNzKysgPSBjZS0+dGltZWxpbmUtPmh3c3Bfb2Zmc2V0ICsgODsKKwkqY3MrKyA9IDA7CisJaW50
ZWxfcmluZ19hZHZhbmNlKHJxLCBjcyk7CisKKwlyZXN1bHQgPSBycS0+aHdzcF9zZXFubyArIDI7
CisJaTkxNV9yZXF1ZXN0X2FkZChycSk7CisKKwlyZXR1cm4gcmVzdWx0OworfQorCitzdGF0aWMg
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqKgorcmFuZG9taXNlZF9lbmdpbmVzKHN0cnVjdCBpbnRl
bF9ndCAqZ3QsCisJCSAgIHN0cnVjdCBybmRfc3RhdGUgKnBybmcsCisJCSAgIHVuc2lnbmVkIGlu
dCAqY291bnQpCit7CisJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCAqKmVuZ2luZXM7
CisJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CisJaW50IG47CisKKwluID0gMDsKKwlmb3JfZWFj
aF9lbmdpbmUoZW5naW5lLCBndCwgaWQpCisJCW4rKzsKKwlpZiAoIW4pCisJCXJldHVybiBOVUxM
OworCisJZW5naW5lcyA9IGttYWxsb2NfYXJyYXkobiwgc2l6ZW9mKCplbmdpbmVzKSwgR0ZQX0tF
Uk5FTCk7CisJaWYgKCFlbmdpbmVzKQorCQlyZXR1cm4gTlVMTDsKKworCW4gPSAwOworCWZvcl9l
YWNoX2VuZ2luZShlbmdpbmUsIGd0LCBpZCkKKwkJZW5naW5lc1tuKytdID0gZW5naW5lOworCisJ
aTkxNV9wcmFuZG9tX3NodWZmbGUoZW5naW5lcywgc2l6ZW9mKCplbmdpbmVzKSwgbiwgcHJuZyk7
CisKKwkqY291bnQgPSBuOworCXJldHVybiBlbmdpbmVzOworfQorCitpbnQgbGl2ZV9yYzZfY3R4
KHZvaWQgKmFyZykKK3sKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOworCXN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKiplbmdpbmVzOworCXVuc2lnbmVkIGludCBuLCBjb3VudDsKKwlJOTE1X1JO
RF9TVEFURShwcm5nKTsKKwlpbnQgZXJyID0gMDsKKworCS8qIEEgcmVhZCBvZiBDVFhfSU5GTyB1
cHNldHMgcmM2LiBQb2tlIHRoZSBiZWFyISAqLworCisJZW5naW5lcyA9IHJhbmRvbWlzZWRfZW5n
aW5lcyhndCwgJnBybmcsICZjb3VudCk7CisJaWYgKCFlbmdpbmVzKQorCQlyZXR1cm4gMDsKKwor
CWZvciAobiA9IDA7IG4gPCBjb3VudDsgbisrKSB7CisJCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSA9IGVuZ2luZXNbbl07CisJCWludCBwYXNzOworCisJCWZvciAocGFzcyA9IDA7IHBh
c3MgPCAyOyBwYXNzKyspIHsKKwkJCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsKKwkJCXVuc2ln
bmVkIGludCByZXNldHMgPQorCQkJCWk5MTVfcmVzZXRfZW5naW5lX2NvdW50KCZndC0+aTkxNS0+
Z3B1X2Vycm9yLAorCQkJCQkJCWVuZ2luZSk7CisJCQljb25zdCB1MzIgKnJlczsKKworCQkJLyog
VXNlIGEgc2FjcmlmaWNhbCBjb250ZXh0ICovCisJCQljZSA9IGludGVsX2NvbnRleHRfY3JlYXRl
KGVuZ2luZS0+a2VybmVsX2NvbnRleHQtPmdlbV9jb250ZXh0LAorCQkJCQkJICBlbmdpbmUpOwor
CQkJaWYgKElTX0VSUihjZSkpIHsKKwkJCQllcnIgPSBQVFJfRVJSKGNlKTsKKwkJCQlnb3RvIG91
dDsKKwkJCX0KKworCQkJaW50ZWxfZW5naW5lX3BtX2dldChlbmdpbmUpOworCQkJcmVzID0gX19s
aXZlX3JjNl9jdHgoY2UpOworCQkJaW50ZWxfZW5naW5lX3BtX3B1dChlbmdpbmUpOworCQkJaW50
ZWxfY29udGV4dF9wdXQoY2UpOworCQkJaWYgKElTX0VSUihyZXMpKSB7CisJCQkJZXJyID0gUFRS
X0VSUihyZXMpOworCQkJCWdvdG8gb3V0OworCQkJfQorCisJCQlpbnRlbF9ndF9yZXRpcmVfcmVx
dWVzdHMoZ3QpOworCQkJaW50ZWxfZ3RfcG1fd2FpdF9mb3JfaWRsZShndCk7CisKKwkJCXByX2Rl
YnVnKCIlczogQ1RYX0lORk89JTB4XG4iLAorCQkJCSBlbmdpbmUtPm5hbWUsIFJFQURfT05DRSgq
cmVzKSk7CisJCQlpZiAocmVzZXRzICE9CisJCQkgICAgaTkxNV9yZXNldF9lbmdpbmVfY291bnQo
Jmd0LT5pOTE1LT5ncHVfZXJyb3IsCisJCQkJCQkgICAgZW5naW5lKSkgeworCQkJCXByX2Vycigi
JXM6IEdQVSByZXNldCByZXF1aXJlZFxuIiwKKwkJCQkgICAgICAgZW5naW5lLT5uYW1lKTsKKwkJ
CQlhZGRfdGFpbnRfZm9yX0NJKFRBSU5UX1dBUk4pOworCQkJCWVyciA9IC1FSU87CisJCQkJZ290
byBvdXQ7CisJCQl9CisJCX0KKwl9CisKK291dDoKKwlrZnJlZShlbmdpbmVzKTsKKwlyZXR1cm4g
ZXJyOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfcmM2
LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9yYzYuaApuZXcgZmlsZSBtb2Rl
IDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjIzMGM2YjRjN2RjMAotLS0gL2Rldi9udWxsCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3JjNi5oCkBAIC0wLDAgKzEsMTIg
QEAKKy8qCisgKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCisgKgorICogQ29weXJpZ2h0
IMKpIDIwMTkgSW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisjaWZuZGVmIFNFTEZURVNUX1JDNl9I
CisjZGVmaW5lIFNFTEZURVNUX1JDNl9ICisKK2ludCBsaXZlX3JjNl9jdHgodm9pZCAqYXJnKTsK
KworI2VuZGlmIC8qIFNFTEZURVNUX1JDNl9IICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9saXZlX3NlbGZ0ZXN0cy5oIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvc2VsZnRlc3RzL2k5MTVfbGl2ZV9zZWxmdGVzdHMuaAppbmRleCA0YjNjYWM3M2UyOTEu
LmRiNTU2NTY3OTA0NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3Rz
L2k5MTVfbGl2ZV9zZWxmdGVzdHMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVz
dHMvaTkxNV9saXZlX3NlbGZ0ZXN0cy5oCkBAIC0zOCwzICszOCw0IEBAIHNlbGZ0ZXN0KGhhbmdj
aGVjaywgaW50ZWxfaGFuZ2NoZWNrX2xpdmVfc2VsZnRlc3RzKQogc2VsZnRlc3QoZXhlY2xpc3Rz
LCBpbnRlbF9leGVjbGlzdHNfbGl2ZV9zZWxmdGVzdHMpCiBzZWxmdGVzdChndWMsIGludGVsX2d1
Y19saXZlX3NlbGZ0ZXN0KQogc2VsZnRlc3QocGVyZiwgaTkxNV9wZXJmX2xpdmVfc2VsZnRlc3Rz
KQorc2VsZnRlc3QobGF0ZV9ndF9wbSwgaW50ZWxfZ3RfcG1fbGF0ZV9zZWxmdGVzdHMpCi0tIAoy
LjI0LjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCklu
dGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRw
czovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

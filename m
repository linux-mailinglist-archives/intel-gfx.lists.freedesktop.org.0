Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 0B0792C0E2E
	for <lists+intel-gfx@lfdr.de>; Mon, 23 Nov 2020 15:56:07 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1719C8990D;
	Mon, 23 Nov 2020 14:56:05 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (unknown [77.68.26.236])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 556068990D
 for <intel-gfx@lists.freedesktop.org>; Mon, 23 Nov 2020 14:56:03 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from build.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 23079856-1500050 
 for multiple; Mon, 23 Nov 2020 14:55:51 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Mon, 23 Nov 2020 14:55:51 +0000
Message-Id: <20201123145551.13222-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915/display: Record the plane update times
 for debugging
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Chris Wilson <chris@chris-wilson.co.uk>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

U2luY2Ugd2UgdHJ5IGFuZCBlc3RpbWF0ZSBob3cgbG9uZyB3ZSByZXF1aXJlIHRvIHVwZGF0ZSB0
aGUgcmVnaXN0ZXJzIHRvCnBlcmZvcm0gYSBwbGFuZSB1cGRhdGUsIGl0IGlzIG9mIHZpdGFsIGlt
cG9ydGFuY2UgdGhhdCB3ZSBtZWFzdXJlIHRoZQpkaXN0cmlidXRpb24gb2YgcGxhbmUgdXBkYXRl
cyB0byBiZXR0ZXIgZ3VpZGUgb3VyIGVzdGltYXRlLiBJZiB3ZQp1bmRlcmVzdGltYXRlIGhvdyBs
b25nIGl0IHRha2VzIHRvIHBlcmZvcm0gdGhlIHBsYW5lIHVwZGF0ZSwgd2UgbWF5CnNsaXAgaW50
byB0aGUgbmV4dCBzY2Fub3V0IGZyYW1lIGNhdXNpbmcgYSB0ZWFyLiBJZiB3ZSBvdmVyZXN0aW1h
dGUsIHdlCm1heSB1bm5lY2Vzc2FyaWx5IGRlbGF5IHRoZSB1cGRhdGUgdG8gdGhlIG5leHQgZnJh
bWUsIGNhdXNpbmcgdmlzaWJsZQpqaXR0ZXIuCgpSZXBsYWNlIHRoZSB3YXJuaW5nIHRoYXQgd2Ug
ZXhjZWVkIHNvbWUgYXJiaXRyYXJ5IHRocmVzaG9sZCBmb3IgdGhlCnZibGFuayB1cGRhdGUgd2l0
aCBhIGhpc3RvZ3JhbSBmb3IgZGVidWdmcy4KClNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8
Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgpDYzogSmFuaSBOaWt1bGEgPGphbmkubmlrdWxhQGxp
bnV4LmludGVsLmNvbT4KQ2M6IFZpbGxlIFN5cmrDpGzDpCA8dmlsbGUuc3lyamFsYUBsaW51eC5p
bnRlbC5jb20+Ci0tLQogLi4uL2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV9kZWJ1Z2Zz
LmMgIHwgNDYgKysrKysrKysrKysrKysrKysrKwogLi4uL2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZGlzcGxheV90eXBlcy5oICAgIHwgIDYgKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX3Nwcml0ZS5jICAgfCAyNiArKysrKysrKy0tLQogMyBmaWxlcyBjaGFuZ2VkLCA3MSBp
bnNlcnRpb25zKCspLCA3IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV9kZWJ1Z2ZzLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfZGVidWdmcy5jCmluZGV4IGNhNDFlOGMwMGFkNy4u
YWE3YTJhNjc5MTM4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX2Rpc3BsYXlfZGVidWdmcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfZGlzcGxheV9kZWJ1Z2ZzLmMKQEAgLTg2NSw2ICs4NjUsNTAgQEAgc3RhdGljIHZvaWQg
aW50ZWxfc2NhbGVyX2luZm8oc3RydWN0IHNlcV9maWxlICptLCBzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YykKIAl9CiB9CiAKKyNpZmRlZiBDT05GSUdfRFJNX0k5MTVfREVCVUdfVkJMQU5LX0VWQURF
CitzdGF0aWMgdm9pZCBjcnRjX3ZibGFua19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgc3RydWN0
IGludGVsX2NydGMgKmNydGMpCit7CisJY2hhciBidWZbQVJSQVlfU0laRShjcnRjLT5kZWJ1Zy52
YmxfdGltZXMpICsgMV0gPSB7fTsKKwlpbnQgaCwgcm93LCBtYXg7CisJdTY0IGNvdW50OworCisJ
bWF4ID0gMDsKKwljb3VudCA9IDA7CisJZm9yIChoID0gMDsgaCA8IEFSUkFZX1NJWkUoY3J0Yy0+
ZGVidWcudmJsX3RpbWVzKTsgaCsrKSB7CisJCWlmIChjcnRjLT5kZWJ1Zy52YmxfdGltZXNbaF0g
PiBtYXgpCisJCQltYXggPSBjcnRjLT5kZWJ1Zy52YmxfdGltZXNbaF07CisJCWNvdW50ICs9IGNy
dGMtPmRlYnVnLnZibF90aW1lc1toXTsKKwl9CisJc2VxX3ByaW50ZihtLCAiXHRVcGRhdGVzOiAl
bGx1XG4iLCBjb3VudCk7CisJaWYgKCFjb3VudCkKKwkJcmV0dXJuOworCisJbWVtc2V0KGJ1Ziwg
Jy0nLCBzaXplb2YoYnVmKSAtIDEpOworCXNlcV9wcmludGYobSwgIlx0ICB8JXN8XG4iLCBidWYp
OworCisJbWF4ID0gaWxvZzIobWF4KTsKKwlmb3IgKHJvdyA9IG1heCAtIDE7IHJvdy0tOyApIHsK
KwkJbWVtc2V0KGJ1ZiwgJyAnLCBzaXplb2YoYnVmKSAtIDEpOworCQlmb3IgKGggPSAwOyBoIDwg
QVJSQVlfU0laRShjcnRjLT5kZWJ1Zy52YmxfdGltZXMpOyBoKyspIHsKKwkJCWlmIChpbG9nMihj
cnRjLT5kZWJ1Zy52YmxfdGltZXNbaF0pID49IHJvdykKKwkJCQlidWZbaF0gPSAnKic7CisJCX0K
KwkJc2VxX3ByaW50ZihtLCAiXHQgIHwlc3xcbiIsIGJ1Zik7CisJfQorCisJbWVtc2V0KGJ1Ziwg
Jy0nLCBzaXplb2YoYnVmKSAtIDEpOworCXNlcV9wcmludGYobSwgIlx0ICB8JXN8XG4iLCBidWYp
OworCXNlcV9wcmludGYobSwgIlx0ICAgIDF1cyAgICAgKGxvZykgICAgIDFtc1xuIik7CisKKwlz
ZXFfcHJpbnRmKG0sICJcdE1pbiB1cGRhdGU6ICVsbHVuc1xuIiwgY3J0Yy0+ZGVidWcubWluX3Zi
bF90aW1lKTsKKwlzZXFfcHJpbnRmKG0sICJcdE1heCB1cGRhdGU6ICVsbHVuc1xuIiwgY3J0Yy0+
ZGVidWcubWF4X3ZibF90aW1lKTsKKwlzZXFfcHJpbnRmKG0sICJcdEF2ZXJhZ2UgdXBkYXRlOiAl
bGx1bnNcbiIsCisJCSAgIGRpdjY0X3U2NChjcnRjLT5kZWJ1Zy5zdW1fdmJsX3RpbWUsICBjb3Vu
dCkpOworfQorI2Vsc2UKK3N0YXRpYyB2b2lkIGNydGNfdmJsYW5rX2luZm8oc3RydWN0IHNlcV9m
aWxlICptLCBzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0Yykge30KKyNlbmRpZgorCiBzdGF0aWMgdm9p
ZCBpbnRlbF9jcnRjX2luZm8oc3RydWN0IHNlcV9maWxlICptLCBzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YykKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5
MTUobS0+cHJpdmF0ZSk7CkBAIC05MDcsNiArOTUxLDggQEAgc3RhdGljIHZvaWQgaW50ZWxfY3J0
Y19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgc3RydWN0IGludGVsX2NydGMgKmNydGMpCiAJc2Vx
X3ByaW50ZihtLCAiXHR1bmRlcnJ1biByZXBvcnRpbmc6IGNwdT0lcyBwY2g9JXNcbiIsCiAJCSAg
IHllc25vKCFjcnRjLT5jcHVfZmlmb191bmRlcnJ1bl9kaXNhYmxlZCksCiAJCSAgIHllc25vKCFj
cnRjLT5wY2hfZmlmb191bmRlcnJ1bl9kaXNhYmxlZCkpOworCisJY3J0Y192YmxhbmtfaW5mbyht
LCBjcnRjKTsKIH0KIAogc3RhdGljIGludCBpOTE1X2Rpc3BsYXlfaW5mbyhzdHJ1Y3Qgc2VxX2Zp
bGUgKm0sIHZvaWQgKnVudXNlZCkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgKaW5kZXggY2U4MmQ2NTRkMGYyLi4wMTIxNDYzNmJlNTYg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90
eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90
eXBlcy5oCkBAIC0xMTg2LDYgKzExODYsMTIgQEAgc3RydWN0IGludGVsX2NydGMgewogCQlrdGlt
ZV90IHN0YXJ0X3ZibF90aW1lOwogCQlpbnQgbWluX3ZibCwgbWF4X3ZibDsKIAkJaW50IHNjYW5s
aW5lX3N0YXJ0OworI2lmZGVmIENPTkZJR19EUk1fSTkxNV9ERUJVR19WQkxBTktfRVZBREUKKwkJ
dTY0IG1pbl92YmxfdGltZTsKKwkJdTY0IG1heF92YmxfdGltZTsKKwkJdTY0IHN1bV92YmxfdGlt
ZTsKKwkJdW5zaWduZWQgaW50IHZibF90aW1lc1syMF07IC8qIFsxdXMsIDFtc10gKi8KKyNlbmRp
ZgogCX0gZGVidWc7CiAKIAkvKiBzY2FsZXJzIGF2YWlsYWJsZSBvbiB0aGlzIGNydGMgKi8KZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3ByaXRlLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nwcml0ZS5jCmluZGV4IDAxOWEyZDZk
ODA3YS4uZmRiNTRhNTY5MjI0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX3Nwcml0ZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfc3ByaXRlLmMKQEAgLTI1MCwxMyArMjUwLDI1IEBAIHZvaWQgaW50ZWxfcGlwZV91cGRhdGVf
ZW5kKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0ZSkKIAkJCWNydGMtPmRl
YnVnLnNjYW5saW5lX3N0YXJ0LCBzY2FubGluZV9lbmQpOwogCX0KICNpZmRlZiBDT05GSUdfRFJN
X0k5MTVfREVCVUdfVkJMQU5LX0VWQURFCi0JZWxzZSBpZiAoa3RpbWVfdXNfZGVsdGEoZW5kX3Zi
bF90aW1lLCBjcnRjLT5kZWJ1Zy5zdGFydF92YmxfdGltZSkgPgotCQkgVkJMQU5LX0VWQVNJT05f
VElNRV9VUykKLQkJZHJtX3dhcm4oJmRldl9wcml2LT5kcm0sCi0JCQkgIkF0b21pYyB1cGRhdGUg
b24gcGlwZSAoJWMpIHRvb2sgJWxsZCB1cywgbWF4IHRpbWUgdW5kZXIgZXZhc2lvbiBpcyAldSB1
c1xuIiwKLQkJCSBwaXBlX25hbWUocGlwZSksCi0JCQkga3RpbWVfdXNfZGVsdGEoZW5kX3ZibF90
aW1lLCBjcnRjLT5kZWJ1Zy5zdGFydF92YmxfdGltZSksCi0JCQkgVkJMQU5LX0VWQVNJT05fVElN
RV9VUyk7CisJeworCQl1bnNpZ25lZCBpbnQgaDsKKwkJdTY0IGRlbHRhOworCisJCWRlbHRhID0g
a3RpbWVfdG9fbnMoa3RpbWVfc3ViKGVuZF92YmxfdGltZSwKKwkJCQkJICAgICAgY3J0Yy0+ZGVi
dWcuc3RhcnRfdmJsX3RpbWUpKTsKKworCQloID0gaWxvZzIoZGVsdGEgPj4gOSk7CisJCWlmICho
ID49IEFSUkFZX1NJWkUoY3J0Yy0+ZGVidWcudmJsX3RpbWVzKSkKKwkJCWggPSBBUlJBWV9TSVpF
KGNydGMtPmRlYnVnLnZibF90aW1lcykgLSAxOworCQljcnRjLT5kZWJ1Zy52YmxfdGltZXNbaF0r
KzsKKworCQljcnRjLT5kZWJ1Zy5zdW1fdmJsX3RpbWUgKz0gZGVsdGE7CisJCWlmICghY3J0Yy0+
ZGVidWcubWluX3ZibF90aW1lIHx8CisJCSAgICBkZWx0YSA8IGNydGMtPmRlYnVnLm1pbl92Ymxf
dGltZSkKKwkJCWNydGMtPmRlYnVnLm1pbl92YmxfdGltZSA9IGRlbHRhOworCQlpZiAoZGVsdGEg
PiBjcnRjLT5kZWJ1Zy5tYXhfdmJsX3RpbWUpCisJCQljcnRjLT5kZWJ1Zy5tYXhfdmJsX3RpbWUg
PSBkZWx0YTsKKwl9CiAjZW5kaWYKIH0KIAotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVs
LWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcv
bWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZngK

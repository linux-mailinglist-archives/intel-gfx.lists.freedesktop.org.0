Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 3D113601B7
	for <lists+intel-gfx@lfdr.de>; Fri,  5 Jul 2019 09:47:56 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8F49D6E421;
	Fri,  5 Jul 2019 07:47:54 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8AE266E422
 for <intel-gfx@lists.freedesktop.org>; Fri,  5 Jul 2019 07:47:52 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17137017-1500050 
 for multiple; Fri, 05 Jul 2019 08:46:09 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri,  5 Jul 2019 08:46:04 +0100
Message-Id: <20190705074604.16496-8-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190705074604.16496-1-chris@chris-wilson.co.uk>
References: <20190705074604.16496-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 8/8] drm/i915/gt: Use intel_gt as the primary
 object for handling resets
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

SGF2aW5nIHRha2VuIHRoZSBmaXJzdCBzdGVwIGluIGVuY2Fwc3VsYXRpbmcgdGhlIGZ1bmN0aW9u
YWxpdHkgYnkgbW92aW5nCnRoZSByZWxhdGVkIGZpbGVzIHVuZGVyIGd0LywgdGhlIG5leHQgc3Rl
cCBpcyB0byBzdGFydCBlbmNhcHN1bGF0aW5nIGJ5CnBhc3NpbmcgYXJvdW5kIHRoZSByZWxldmFu
dCBzdHJ1Y3RzIHJhdGhlciB0aGFuIHRoZSBnbG9iYWwKZHJtX2k5MTVfcHJpdmF0ZS4gSW4gdGhp
cyBzdGVwLCB3ZSBwYXNzIGludGVsX2d0IHRvIGludGVsX3Jlc2V0LmMKClNpZ25lZC1vZmYtYnk6
IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgpDYzogVHZydGtvIFVyc3Vs
aW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KQ2M6IERhbmllbGUgQ2VyYW9sbyBTcHVyaW8g
PGRhbmllbGUuY2VyYW9sb3NwdXJpb0BpbnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMgIHwgIDIxICstCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fY29udGV4dC5jICAgfCAgIDIgKy0KIC4uLi9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX2V4ZWNidWZmZXIuYyAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX21tYW4uYyAgICAgIHwgICA4ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fcG0uYyAgICAgICAgfCAgMjUgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV90aHJvdHRsZS5jICB8ICAgMiArLQogLi4uL2dwdS9kcm0vaTkxNS9nZW0vc2Vs
ZnRlc3RzL2h1Z2VfcGFnZXMuYyAgIHwgIDIwICstCiAuLi4vaTkxNS9nZW0vc2VsZnRlc3RzL2k5
MTVfZ2VtX2NsaWVudF9ibHQuYyAgfCAgIDQgKy0KIC4uLi9pOTE1L2dlbS9zZWxmdGVzdHMvaTkx
NV9nZW1fY29oZXJlbmN5LmMgICB8ICAgNiArLQogLi4uL2RybS9pOTE1L2dlbS9zZWxmdGVzdHMv
aTkxNV9nZW1fY29udGV4dC5jIHwgIDE3ICstCiAuLi4vZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9p
OTE1X2dlbV9tbWFuLmMgICAgfCAgIDIgKy0KIC4uLi9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9n
ZW1fb2JqZWN0X2JsdC5jICB8ICAgNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
ZW5naW5lLmggICAgICAgIHwgICA4ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9l
bmdpbmVfY3MuYyAgICAgfCAgMTYgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2Vu
Z2luZV9wbS5jICAgICB8ICAgMyArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3Qu
YyAgICAgICAgICAgIHwgICA3ICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0Lmgg
ICAgICAgICAgICB8ICAxMiArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9wbS5j
ICAgICAgICAgfCAgMTkgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3R5cGVz
LmggICAgICB8ICAxMiArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5nY2hlY2su
YyAgICAgfCAgNjcgKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyAgICAg
ICAgICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMgICAg
ICAgICB8IDQzNSArKysrKysrKystLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX3Jlc2V0LmggICAgICAgICB8ICA3MyArLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX3Jlc2V0X3R5cGVzLmggICB8ICA1MCArKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfcmluZ2J1ZmZlci5jICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxm
dGVzdF9oYW5nY2hlY2suYyAgfCAxMDcgKysrLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3Nl
bGZ0ZXN0X2xyYy5jICAgICAgICB8ICAzNiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2Vs
ZnRlc3RfcmVzZXQuYyAgICAgIHwgIDUwICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxm
dGVzdF90aW1lbGluZS5jICAgfCAgIDMgKy0KIC4uLi9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rf
d29ya2Fyb3VuZHMuYyAgICB8ICAzMyArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1
Z2ZzLmMgICAgICAgICAgIHwgIDYzICstLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYu
YyAgICAgICAgICAgICAgIHwgICA1ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5o
ICAgICAgICAgICAgICAgfCAgMzUgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMg
ICAgICAgICAgICAgICB8ICAzMSArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJy
b3IuaCAgICAgICAgIHwgIDUyICstLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0
LmMgICAgICAgICAgIHwgICA1ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfc3Vi
bWlzc2lvbi5jICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3VjLmMgICAg
ICAgICAgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVf
YWN0aXZlLmMgIHwgICAzICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9n
ZW0uYyAgICAgfCAgIDMgKy0KIC4uLi9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2V2
aWN0LmMgICB8ICAgMyArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfcmVx
dWVzdC5jIHwgICA0ICstCiAuLi4vZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3NlbGZ0ZXN0
LmMgICAgfCAgIDIgKy0KIC4uLi9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2lndF9mbHVzaF90ZXN0
LmMgICB8ICAgNSArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2lndF9yZXNldC5j
ICAgIHwgIDM4ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaWd0X3Jlc2V0Lmgg
ICAgfCAgMTAgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pZ3Rfd2VkZ2VfbWUu
aCB8ICA1OCAtLS0KIC4uLi9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfZ2VtX2RldmljZS5j
ICB8ICAgNSAtCiA0OCBmaWxlcyBjaGFuZ2VkLCA2NjUgaW5zZXJ0aW9ucygrKSwgNzA5IGRlbGV0
aW9ucygtKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X3Jlc2V0X3R5cGVzLmgKIGRlbGV0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9z
ZWxmdGVzdHMvaWd0X3dlZGdlX21lLmgKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfZGlzcGxheS5jCmluZGV4IDkxOWY1YWM4NDRjOC4uNGRkNjg1NmJmNzIyIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwpAQCAtNDI0OSwxMiAr
NDI0OSwxMiBAQCB2b2lkIGludGVsX3ByZXBhcmVfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQogCQlyZXR1cm47CiAKIAkvKiBXZSBoYXZlIGEgbW9kZXNldCB2cyByZXNl
dCBkZWFkbG9jaywgZGVmZW5zaXZlbHkgdW5icmVhayBpdC4gKi8KLQlzZXRfYml0KEk5MTVfUkVT
RVRfTU9ERVNFVCwgJmRldl9wcml2LT5ncHVfZXJyb3IuZmxhZ3MpOwotCXdha2VfdXBfYWxsKCZk
ZXZfcHJpdi0+Z3B1X2Vycm9yLndhaXRfcXVldWUpOworCXNldF9iaXQoSTkxNV9SRVNFVF9NT0RF
U0VULCAmZGV2X3ByaXYtPmd0LnJlc2V0LmZsYWdzKTsKKwl3YWtlX3VwX2JpdCgmZGV2X3ByaXYt
Pmd0LnJlc2V0LmZsYWdzLCBJOTE1X1JFU0VUX01PREVTRVQpOwogCiAJaWYgKGF0b21pY19yZWFk
KCZkZXZfcHJpdi0+Z3B1X2Vycm9yLnBlbmRpbmdfZmJfcGluKSkgewogCQlEUk1fREVCVUdfS01T
KCJNb2Rlc2V0IHBvdGVudGlhbGx5IHN0dWNrLCB1bmJyZWFraW5nIHRocm91Z2ggd2VkZ2luZ1xu
Iik7Ci0JCWk5MTVfZ2VtX3NldF93ZWRnZWQoZGV2X3ByaXYpOworCQlpbnRlbF9ndF9zZXRfd2Vk
Z2VkKCZkZXZfcHJpdi0+Z3QpOwogCX0KIAogCS8qCkBAIC00MzAwLDcgKzQzMDAsNyBAQCB2b2lk
IGludGVsX2ZpbmlzaF9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJ
aW50IHJldDsKIAogCS8qIHJlc2V0IGRvZXNuJ3QgdG91Y2ggdGhlIGRpc3BsYXkgKi8KLQlpZiAo
IXRlc3RfYml0KEk5MTVfUkVTRVRfTU9ERVNFVCwgJmRldl9wcml2LT5ncHVfZXJyb3IuZmxhZ3Mp
KQorCWlmICghdGVzdF9iaXQoSTkxNV9SRVNFVF9NT0RFU0VULCAmZGV2X3ByaXYtPmd0LnJlc2V0
LmZsYWdzKSkKIAkJcmV0dXJuOwogCiAJc3RhdGUgPSBmZXRjaF9hbmRfemVybygmZGV2X3ByaXYt
Pm1vZGVzZXRfcmVzdG9yZV9zdGF0ZSk7CkBAIC00MzQwLDcgKzQzNDAsNyBAQCB2b2lkIGludGVs
X2ZpbmlzaF9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJZHJtX21v
ZGVzZXRfYWNxdWlyZV9maW5pKGN0eCk7CiAJbXV0ZXhfdW5sb2NrKCZkZXYtPm1vZGVfY29uZmln
Lm11dGV4KTsKIAotCWNsZWFyX2JpdChJOTE1X1JFU0VUX01PREVTRVQsICZkZXZfcHJpdi0+Z3B1
X2Vycm9yLmZsYWdzKTsKKwljbGVhcl9iaXRfdW5sb2NrKEk5MTVfUkVTRVRfTU9ERVNFVCwgJmRl
dl9wcml2LT5ndC5yZXNldC5mbGFncyk7CiB9CiAKIHN0YXRpYyB2b2lkIGljbF9zZXRfcGlwZV9j
aGlja2VuKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQpAQCAtMTM4MjcsMTggKzEzODI3LDIxIEBA
IHN0YXRpYyB2b2lkIGludGVsX2F0b21pY19jb21taXRfZmVuY2Vfd2FpdChzdHJ1Y3QgaW50ZWxf
YXRvbWljX3N0YXRlICppbnRlbF9zdGF0CiAJZm9yICg7OykgewogCQlwcmVwYXJlX3RvX3dhaXQo
JmludGVsX3N0YXRlLT5jb21taXRfcmVhZHkud2FpdCwKIAkJCQkmd2FpdF9mZW5jZSwgVEFTS19V
TklOVEVSUlVQVElCTEUpOwotCQlwcmVwYXJlX3RvX3dhaXQoJmRldl9wcml2LT5ncHVfZXJyb3Iu
d2FpdF9xdWV1ZSwKKwkJcHJlcGFyZV90b193YWl0KGJpdF93YWl0cXVldWUoJmRldl9wcml2LT5n
dC5yZXNldC5mbGFncywKKwkJCQkJICAgICAgSTkxNV9SRVNFVF9NT0RFU0VUKSwKIAkJCQkmd2Fp
dF9yZXNldCwgVEFTS19VTklOVEVSUlVQVElCTEUpOwogCiAKLQkJaWYgKGk5MTVfc3dfZmVuY2Vf
ZG9uZSgmaW50ZWxfc3RhdGUtPmNvbW1pdF9yZWFkeSkKLQkJICAgIHx8IHRlc3RfYml0KEk5MTVf
UkVTRVRfTU9ERVNFVCwgJmRldl9wcml2LT5ncHVfZXJyb3IuZmxhZ3MpKQorCQlpZiAoaTkxNV9z
d19mZW5jZV9kb25lKCZpbnRlbF9zdGF0ZS0+Y29tbWl0X3JlYWR5KSB8fAorCQkgICAgdGVzdF9i
aXQoSTkxNV9SRVNFVF9NT0RFU0VULCAmZGV2X3ByaXYtPmd0LnJlc2V0LmZsYWdzKSkKIAkJCWJy
ZWFrOwogCiAJCXNjaGVkdWxlKCk7CiAJfQogCWZpbmlzaF93YWl0KCZpbnRlbF9zdGF0ZS0+Y29t
bWl0X3JlYWR5LndhaXQsICZ3YWl0X2ZlbmNlKTsKLQlmaW5pc2hfd2FpdCgmZGV2X3ByaXYtPmdw
dV9lcnJvci53YWl0X3F1ZXVlLCAmd2FpdF9yZXNldCk7CisJZmluaXNoX3dhaXQoYml0X3dhaXRx
dWV1ZSgmZGV2X3ByaXYtPmd0LnJlc2V0LmZsYWdzLAorCQkJCSAgSTkxNV9SRVNFVF9NT0RFU0VU
KSwKKwkJICAgICZ3YWl0X3Jlc2V0KTsKIH0KIAogc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX2Ns
ZWFudXBfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYwppbmRleCBlMzY3ZGNlMmE2OTYuLmRhYzg2ODg0YzQ1
ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCkBAIC0y
MTQ0LDcgKzIxNDQsNyBAQCBpbnQgaTkxNV9nZW1fY29udGV4dF9jcmVhdGVfaW9jdGwoc3RydWN0
IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIAlpZiAoYXJncy0+ZmxhZ3MgJiBJOTE1X0NP
TlRFWFRfQ1JFQVRFX0ZMQUdTX1VOS05PV04pCiAJCXJldHVybiAtRUlOVkFMOwogCi0JcmV0ID0g
aTkxNV90ZXJtaW5hbGx5X3dlZGdlZChpOTE1KTsKKwlyZXQgPSBpbnRlbF9ndF90ZXJtaW5hbGx5
X3dlZGdlZCgmaTkxNS0+Z3QpOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jCmluZGV4IDBlYTJkNDli
YzhiOS4uMzUwNmFhZmFkYTZjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fZXhlY2J1ZmZlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV9leGVjYnVmZmVyLmMKQEAgLTIxNDgsNyArMjE0OCw3IEBAIHN0YXRpYyBpbnQgX19lYl9w
aW5fZW5naW5lKHN0cnVjdCBpOTE1X2V4ZWNidWZmZXIgKmViLCBzdHJ1Y3QgaW50ZWxfY29udGV4
dCAqY2UpCiAJICogQUJJOiBCZWZvcmUgdXNlcnNwYWNlIGFjY2Vzc2VzIHRoZSBHUFUgKGUuZy4g
ZXhlY2J1ZmZlciksIHJlcG9ydAogCSAqIEVJTyBpZiB0aGUgR1BVIGlzIGFscmVhZHkgd2VkZ2Vk
LgogCSAqLwotCWVyciA9IGk5MTVfdGVybWluYWxseV93ZWRnZWQoZWItPmk5MTUpOworCWVyciA9
IGludGVsX2d0X3Rlcm1pbmFsbHlfd2VkZ2VkKGNlLT5lbmdpbmUtPmd0KTsKIAlpZiAoZXJyKQog
CQlyZXR1cm4gZXJyOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fbW1hbi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21tYW4uYwpp
bmRleCAzOTE2MjFlZTNjYmIuLmE1NjRjMWU0MjMxYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21tYW4uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fbW1hbi5jCkBAIC03LDYgKzcsOCBAQAogI2luY2x1ZGUgPGxpbnV4L21tYW4u
aD4KICNpbmNsdWRlIDxsaW51eC9zaXplcy5oPgogCisjaW5jbHVkZSAiZ3QvaW50ZWxfZ3QuaCIK
KwogI2luY2x1ZGUgImk5MTVfZHJ2LmgiCiAjaW5jbHVkZSAiaTkxNV9nZW1fZ3R0LmgiCiAjaW5j
bHVkZSAiaTkxNV9nZW1faW9jdGxzLmgiCkBAIC0yNDYsNyArMjQ4LDcgQEAgdm1fZmF1bHRfdCBp
OTE1X2dlbV9mYXVsdChzdHJ1Y3Qgdm1fZmF1bHQgKnZtZikKIAogCXdha2VyZWYgPSBpbnRlbF9y
dW50aW1lX3BtX2dldChycG0pOwogCi0Jc3JjdSA9IGk5MTVfcmVzZXRfdHJ5bG9jayhpOTE1KTsK
KwlzcmN1ID0gaW50ZWxfZ3RfcmVzZXRfdHJ5bG9jayhnZ3R0LT52bS5ndCk7CiAJaWYgKHNyY3Ug
PCAwKSB7CiAJCXJldCA9IHNyY3U7CiAJCWdvdG8gZXJyX3JwbTsKQEAgLTMyNiw3ICszMjgsNyBA
QCB2bV9mYXVsdF90IGk5MTVfZ2VtX2ZhdWx0KHN0cnVjdCB2bV9mYXVsdCAqdm1mKQogZXJyX3Vu
bG9jazoKIAltdXRleF91bmxvY2soJmRldi0+c3RydWN0X211dGV4KTsKIGVycl9yZXNldDoKLQlp
OTE1X3Jlc2V0X3VubG9jayhpOTE1LCBzcmN1KTsKKwlpbnRlbF9ndF9yZXNldF91bmxvY2soZ2d0
dC0+dm0uZ3QsIHNyY3UpOwogZXJyX3JwbToKIAlpbnRlbF9ydW50aW1lX3BtX3B1dChycG0sIHdh
a2VyZWYpOwogCWk5MTVfZ2VtX29iamVjdF91bnBpbl9wYWdlcyhvYmopOwpAQCAtMzM5LDcgKzM0
MSw3IEBAIHZtX2ZhdWx0X3QgaTkxNV9nZW1fZmF1bHQoc3RydWN0IHZtX2ZhdWx0ICp2bWYpCiAJ
CSAqIGZhaWwpLiBCdXQgYW55IG90aGVyIC1FSU8gaXNuJ3Qgb3VycyAoZS5nLiBzd2FwIGluIGZh
aWx1cmUpCiAJCSAqIGFuZCBzbyBuZWVkcyB0byBiZSByZXBvcnRlZC4KIAkJICovCi0JCWlmICgh
aTkxNV90ZXJtaW5hbGx5X3dlZGdlZChpOTE1KSkKKwkJaWYgKCFpbnRlbF9ndF9pc193ZWRnZWQo
Z2d0dC0+dm0uZ3QpKQogCQkJcmV0dXJuIFZNX0ZBVUxUX1NJR0JVUzsKIAkJLyogZWxzZTogZmFs
bCB0aHJvdWdoICovCiAJY2FzZSAtRUFHQUlOOgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fcG0uYwppbmRleCBiZjA4NWIwY2I3YzYuLjhlMmVlYWVjMDZjYiAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKQEAgLTUsNiArNSw3IEBACiAgKi8KIAogI2luY2x1ZGUg
ImdlbS9pOTE1X2dlbV9wbS5oIgorI2luY2x1ZGUgImd0L2ludGVsX2d0LmgiCiAjaW5jbHVkZSAi
Z3QvaW50ZWxfZ3RfcG0uaCIKIAogI2luY2x1ZGUgImk5MTVfZHJ2LmgiCkBAIC0xMDMsMTggKzEw
NCwxOCBAQCBzdGF0aWMgaW50IHBtX25vdGlmaWVyKHN0cnVjdCBub3RpZmllcl9ibG9jayAqbmIs
CiAJcmV0dXJuIE5PVElGWV9PSzsKIH0KIAotc3RhdGljIGJvb2wgc3dpdGNoX3RvX2tlcm5lbF9j
b250ZXh0X3N5bmMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCitzdGF0aWMgYm9vbCBz
d2l0Y2hfdG9fa2VybmVsX2NvbnRleHRfc3luYyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewotCWJv
b2wgcmVzdWx0ID0gIWk5MTVfdGVybWluYWxseV93ZWRnZWQoaTkxNSk7CisJYm9vbCByZXN1bHQg
PSAhaW50ZWxfZ3RfaXNfd2VkZ2VkKGd0KTsKIAogCWRvIHsKLQkJaWYgKGk5MTVfZ2VtX3dhaXRf
Zm9yX2lkbGUoaTkxNSwKKwkJaWYgKGk5MTVfZ2VtX3dhaXRfZm9yX2lkbGUoZ3QtPmk5MTUsCiAJ
CQkJCSAgIEk5MTVfV0FJVF9MT0NLRUQgfAogCQkJCQkgICBJOTE1X1dBSVRfRk9SX0lETEVfQk9P
U1QsCiAJCQkJCSAgIEk5MTVfR0VNX0lETEVfVElNRU9VVCkgPT0gLUVUSU1FKSB7CiAJCQkvKiBY
WFggaGlkZSB3YXJuaW5nIGZyb20gZ2VtX2VpbyAqLwogCQkJaWYgKGk5MTVfbW9kcGFyYW1zLnJl
c2V0KSB7Ci0JCQkJZGV2X2VycihpOTE1LT5kcm0uZGV2LAorCQkJCWRldl9lcnIoZ3QtPmk5MTUt
PmRybS5kZXYsCiAJCQkJCSJGYWlsZWQgdG8gaWRsZSBlbmdpbmVzLCBkZWNsYXJpbmcgd2VkZ2Vk
IVxuIik7CiAJCQkJR0VNX1RSQUNFX0RVTVAoKTsKIAkJCX0KQEAgLTEyMywxOCArMTI0LDE4IEBA
IHN0YXRpYyBib29sIHN3aXRjaF90b19rZXJuZWxfY29udGV4dF9zeW5jKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQogCQkJICogRm9yY2libHkgY2FuY2VsIG91dHN0YW5kaW5nIHdvcmsg
YW5kIGxlYXZlCiAJCQkgKiB0aGUgZ3B1IHF1aWV0LgogCQkJICovCi0JCQlpOTE1X2dlbV9zZXRf
d2VkZ2VkKGk5MTUpOworCQkJaW50ZWxfZ3Rfc2V0X3dlZGdlZChndCk7CiAJCQlyZXN1bHQgPSBm
YWxzZTsKIAkJfQotCX0gd2hpbGUgKGk5MTVfcmV0aXJlX3JlcXVlc3RzKGk5MTUpICYmIHJlc3Vs
dCk7CisJfSB3aGlsZSAoaTkxNV9yZXRpcmVfcmVxdWVzdHMoZ3QtPmk5MTUpICYmIHJlc3VsdCk7
CiAKLQlHRU1fQlVHX09OKGk5MTUtPmd0LmF3YWtlKTsKKwlHRU1fQlVHX09OKGd0LT5hd2FrZSk7
CiAJcmV0dXJuIHJlc3VsdDsKIH0KIAogYm9vbCBpOTE1X2dlbV9sb2FkX3Bvd2VyX2NvbnRleHQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7Ci0JcmV0dXJuIHN3aXRjaF90b19rZXJu
ZWxfY29udGV4dF9zeW5jKGk5MTUpOworCXJldHVybiBzd2l0Y2hfdG9fa2VybmVsX2NvbnRleHRf
c3luYygmaTkxNS0+Z3QpOwogfQogCiB2b2lkIGk5MTVfZ2VtX3N1c3BlbmQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCkBAIC0xNTUsNyArMTU2LDcgQEAgdm9pZCBpOTE1X2dlbV9zdXNw
ZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCSAqIHN0YXRlLiBGb3J0dW5hdGVs
eSwgdGhlIGtlcm5lbF9jb250ZXh0IGlzIGRpc3Bvc2FibGUgYW5kIHdlIGRvCiAJICogbm90IHJl
bHkgb24gaXRzIHN0YXRlLgogCSAqLwotCXN3aXRjaF90b19rZXJuZWxfY29udGV4dF9zeW5jKGk5
MTUpOworCXN3aXRjaF90b19rZXJuZWxfY29udGV4dF9zeW5jKCZpOTE1LT5ndCk7CiAKIAltdXRl
eF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCkBAIC0xNjYsNyArMTY3LDcgQEAg
dm9pZCBpOTE1X2dlbV9zdXNwZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCUdF
TV9CVUdfT04oaTkxNS0+Z3QuYXdha2UpOwogCWZsdXNoX3dvcmsoJmk5MTUtPmdlbS5pZGxlX3dv
cmspOwogCi0JY2FuY2VsX2RlbGF5ZWRfd29ya19zeW5jKCZpOTE1LT5ncHVfZXJyb3IuaGFuZ2No
ZWNrX3dvcmspOworCWNhbmNlbF9kZWxheWVkX3dvcmtfc3luYygmaTkxNS0+Z3QuaGFuZ2NoZWNr
LndvcmspOwogCiAJaTkxNV9nZW1fZHJhaW5fZnJlZWRfb2JqZWN0cyhpOTE1KTsKIApAQCAtMjc0
LDEwICsyNzUsMTAgQEAgdm9pZCBpOTE1X2dlbV9yZXN1bWUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCiAJcmV0dXJuOwogCiBlcnJfd2VkZ2VkOgotCWlmICghaTkxNV9yZXNldF9mYWls
ZWQoaTkxNSkpIHsKKwlpZiAoIWludGVsX2d0X2lzX3dlZGdlZCgmaTkxNS0+Z3QpKSB7CiAJCWRl
dl9lcnIoaTkxNS0+ZHJtLmRldiwKIAkJCSJGYWlsZWQgdG8gcmUtaW5pdGlhbGl6ZSBHUFUsIGRl
Y2xhcmluZyBpdCB3ZWRnZWQhXG4iKTsKLQkJaTkxNV9nZW1fc2V0X3dlZGdlZChpOTE1KTsKKwkJ
aW50ZWxfZ3Rfc2V0X3dlZGdlZCgmaTkxNS0+Z3QpOwogCX0KIAlnb3RvIG91dF91bmxvY2s7CiB9
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdGhyb3R0bGUu
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV90aHJvdHRsZS5jCmluZGV4IGFk
YjMwNzRkOWNlMi4uMWUzNzI0MjA3NzFiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fdGhyb3R0bGUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fdGhyb3R0bGUuYwpAQCAtNDEsNyArNDEsNyBAQCBpOTE1X2dlbV90aHJvdHRsZV9p
b2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCWxvbmcgcmV0OwogCiAJ
LyogQUJJOiByZXR1cm4gLUVJTyBpZiBhbHJlYWR5IHdlZGdlZCAqLwotCXJldCA9IGk5MTVfdGVy
bWluYWxseV93ZWRnZWQodG9faTkxNShkZXYpKTsKKwlyZXQgPSBpbnRlbF9ndF90ZXJtaW5hbGx5
X3dlZGdlZCgmdG9faTkxNShkZXYpLT5ndCk7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIApk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2Vz
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2h1Z2VfcGFnZXMuYwppbmRl
eCA4NmVlZDRjM2FlMmIuLjZjYmQ0YTY2OGM5YSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2VzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2VzLmMKQEAgLTE3NTMsNyArMTc1Myw3IEBAIGludCBp
OTE1X2dlbV9odWdlX3BhZ2VfbW9ja19zZWxmdGVzdHModm9pZCkKIAlyZXR1cm4gZXJyOwogfQog
Ci1pbnQgaTkxNV9nZW1faHVnZV9wYWdlX2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKK2ludCBpOTE1X2dlbV9odWdlX3BhZ2VfbGl2ZV9zZWxmdGVzdHMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7CiAJc3RhdGljIGNvbnN0IHN0cnVjdCBp
OTE1X3N1YnRlc3QgdGVzdHNbXSA9IHsKIAkJU1VCVEVTVChpZ3Rfc2hyaW5rX3RocCksCkBAIC0x
NzY4LDIyICsxNzY4LDIyIEBAIGludCBpOTE1X2dlbV9odWdlX3BhZ2VfbGl2ZV9zZWxmdGVzdHMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCWludGVsX3dha2VyZWZfdCB3YWtl
cmVmOwogCWludCBlcnI7CiAKLQlpZiAoIUhBU19QUEdUVChkZXZfcHJpdikpIHsKKwlpZiAoIUhB
U19QUEdUVChpOTE1KSkgewogCQlwcl9pbmZvKCJQUEdUVCBub3Qgc3VwcG9ydGVkLCBza2lwcGlu
ZyBsaXZlLXNlbGZ0ZXN0c1xuIik7CiAJCXJldHVybiAwOwogCX0KIAotCWlmIChpOTE1X3Rlcm1p
bmFsbHlfd2VkZ2VkKGRldl9wcml2KSkKKwlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKCZpOTE1LT5n
dCkpCiAJCXJldHVybiAwOwogCi0JZmlsZSA9IG1vY2tfZmlsZShkZXZfcHJpdik7CisJZmlsZSA9
IG1vY2tfZmlsZShpOTE1KTsKIAlpZiAoSVNfRVJSKGZpbGUpKQogCQlyZXR1cm4gUFRSX0VSUihm
aWxlKTsKIAotCW11dGV4X2xvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKLQl3YWtl
cmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmRldl9wcml2LT5ydW50aW1lX3BtKTsKKwltdXRl
eF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVudGlt
ZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCi0JY3R4ID0gbGl2ZV9jb250ZXh0KGRldl9w
cml2LCBmaWxlKTsKKwljdHggPSBsaXZlX2NvbnRleHQoaTkxNSwgZmlsZSk7CiAJaWYgKElTX0VS
UihjdHgpKSB7CiAJCWVyciA9IFBUUl9FUlIoY3R4KTsKIAkJZ290byBvdXRfdW5sb2NrOwpAQCAt
MTc5NSwxMCArMTc5NSwxMCBAQCBpbnQgaTkxNV9nZW1faHVnZV9wYWdlX2xpdmVfc2VsZnRlc3Rz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAllcnIgPSBpOTE1X3N1YnRlc3Rz
KHRlc3RzLCBjdHgpOwogCiBvdXRfdW5sb2NrOgotCWludGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZf
cHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7Ci0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJt
LnN0cnVjdF9tdXRleCk7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0s
IHdha2VyZWYpOworCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAKLQlt
b2NrX2ZpbGVfZnJlZShkZXZfcHJpdiwgZmlsZSk7CisJbW9ja19maWxlX2ZyZWUoaTkxNSwgZmls
ZSk7CiAKIAlyZXR1cm4gZXJyOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jbGllbnRfYmx0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NsaWVudF9ibHQuYwppbmRleCBmYTc5MjMzMDkzZWIu
LjI3NWMyODkyNjA2NyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0
ZXN0cy9pOTE1X2dlbV9jbGllbnRfYmx0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L3NlbGZ0ZXN0cy9pOTE1X2dlbV9jbGllbnRfYmx0LmMKQEAgLTUsNiArNSw4IEBACiAKICNpbmNs
dWRlICJpOTE1X3NlbGZ0ZXN0LmgiCiAKKyNpbmNsdWRlICJndC9pbnRlbF9ndC5oIgorCiAjaW5j
bHVkZSAic2VsZnRlc3RzL2lndF9mbHVzaF90ZXN0LmgiCiAjaW5jbHVkZSAic2VsZnRlc3RzL21v
Y2tfZHJtLmgiCiAjaW5jbHVkZSAibW9ja19jb250ZXh0LmgiCkBAIC0xMDEsNyArMTAzLDcgQEAg
aW50IGk5MTVfZ2VtX2NsaWVudF9ibHRfbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCiAJCVNVQlRFU1QoaWd0X2NsaWVudF9maWxsKSwKIAl9OwogCi0JaWYgKGk5
MTVfdGVybWluYWxseV93ZWRnZWQoaTkxNSkpCisJaWYgKGludGVsX2d0X2lzX3dlZGdlZCgmaTkx
NS0+Z3QpKQogCQlyZXR1cm4gMDsKIAogCWlmICghSEFTX0VOR0lORShpOTE1LCBCQ1MwKSkKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fY29o
ZXJlbmN5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2Nv
aGVyZW5jeS5jCmluZGV4IDg2MWYzMmJlN2Q0Ni4uYTFhNGI1M2NkYzRhIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvaGVyZW5jeS5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fY29oZXJlbmN5
LmMKQEAgLTYsNiArNiw4IEBACiAKICNpbmNsdWRlIDxsaW51eC9wcmltZV9udW1iZXJzLmg+CiAK
KyNpbmNsdWRlICJndC9pbnRlbF9ndC5oIgorCiAjaW5jbHVkZSAiaTkxNV9zZWxmdGVzdC5oIgog
I2luY2x1ZGUgInNlbGZ0ZXN0cy9pOTE1X3JhbmRvbS5oIgogCkBAIC0yNDIsMTIgKzI0NCwxMiBA
QCBzdGF0aWMgYm9vbCBhbHdheXNfdmFsaWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
CiAKIHN0YXRpYyBib29sIG5lZWRzX2ZlbmNlX3JlZ2lzdGVycyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKIHsKLQlyZXR1cm4gIWk5MTVfdGVybWluYWxseV93ZWRnZWQoaTkxNSk7CisJ
cmV0dXJuICFpbnRlbF9ndF9pc193ZWRnZWQoJmk5MTUtPmd0KTsKIH0KIAogc3RhdGljIGJvb2wg
bmVlZHNfbWlfc3RvcmVfZHdvcmQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7Ci0J
aWYgKGk5MTVfdGVybWluYWxseV93ZWRnZWQoaTkxNSkpCisJaWYgKGludGVsX2d0X2lzX3dlZGdl
ZCgmaTkxNS0+Z3QpKQogCQlyZXR1cm4gZmFsc2U7CiAKIAlpZiAoIUhBU19FTkdJTkUoaTkxNSwg
UkNTMCkpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5
MTVfZ2VtX2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkx
NV9nZW1fY29udGV4dC5jCmluZGV4IDNhYmUxNWEwOGI2ZC4uMmU5MjdmNDU2NmQzIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRl
eHQuYwpAQCAtNyw2ICs3LDcgQEAKICNpbmNsdWRlIDxsaW51eC9wcmltZV9udW1iZXJzLmg+CiAK
ICNpbmNsdWRlICJnZW0vaTkxNV9nZW1fcG0uaCIKKyNpbmNsdWRlICJndC9pbnRlbF9ndC5oIgog
I2luY2x1ZGUgImd0L2ludGVsX3Jlc2V0LmgiCiAjaW5jbHVkZSAiaTkxNV9zZWxmdGVzdC5oIgog
CkBAIC04Myw3ICs4NCw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9ub3Bfc3dpdGNoKHZvaWQgKmFyZykK
IAkJfQogCQlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQocnEsIDAsIEhaIC8gNSkgPCAwKSB7CiAJCQlw
cl9lcnIoIkZhaWxlZCB0byBwb3B1bGF0ZWQgJWQgY29udGV4dHNcbiIsIG5jdHgpOwotCQkJaTkx
NV9nZW1fc2V0X3dlZGdlZChpOTE1KTsKKwkJCWludGVsX2d0X3NldF93ZWRnZWQoJmk5MTUtPmd0
KTsKIAkJCWVyciA9IC1FSU87CiAJCQlnb3RvIG91dF91bmxvY2s7CiAJCX0KQEAgLTEyNyw3ICsx
MjgsNyBAQCBzdGF0aWMgaW50IGxpdmVfbm9wX3N3aXRjaCh2b2lkICphcmcpCiAJCQlpZiAoaTkx
NV9yZXF1ZXN0X3dhaXQocnEsIDAsIEhaIC8gNSkgPCAwKSB7CiAJCQkJcHJfZXJyKCJTd2l0Y2hp
bmcgYmV0d2VlbiAlbGQgY29udGV4dHMgdGltZWQgb3V0XG4iLAogCQkJCSAgICAgICBwcmltZSk7
Ci0JCQkJaTkxNV9nZW1fc2V0X3dlZGdlZChpOTE1KTsKKwkJCQlpbnRlbF9ndF9zZXRfd2VkZ2Vk
KCZpOTE1LT5ndCk7CiAJCQkJYnJlYWs7CiAJCQl9CiAKQEAgLTk1Niw3ICs5NTcsNyBAQCBfX3Nz
ZXVfZmluaXNoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCWludCByZXQgPSAwOwog
CiAJaWYgKGZsYWdzICYgVEVTVF9SRVNFVCkgewotCQlyZXQgPSBpOTE1X3Jlc2V0X2VuZ2luZShj
ZS0+ZW5naW5lLCAic3NldSIpOworCQlyZXQgPSBpbnRlbF9lbmdpbmVfcmVzZXQoY2UtPmVuZ2lu
ZSwgInNzZXUiKTsKIAkJaWYgKHJldCkKIAkJCWdvdG8gb3V0OwogCX0KQEAgLTEwNTksNyArMTA2
MCw3IEBAIF9faWd0X2N0eF9zc2V1KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCQly
ZXR1cm4gUFRSX0VSUihmaWxlKTsKIAogCWlmIChmbGFncyAmIFRFU1RfUkVTRVQpCi0JCWlndF9n
bG9iYWxfcmVzZXRfbG9jayhpOTE1KTsKKwkJaWd0X2dsb2JhbF9yZXNldF9sb2NrKCZpOTE1LT5n
dCk7CiAKIAltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIApAQCAtMTEyMCw3
ICsxMTIxLDcgQEAgX19pZ3RfY3R4X3NzZXUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
CiAJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAogCWlmIChmbGFncyAm
IFRFU1RfUkVTRVQpCi0JCWlndF9nbG9iYWxfcmVzZXRfdW5sb2NrKGk5MTUpOworCQlpZ3RfZ2xv
YmFsX3Jlc2V0X3VubG9jaygmaTkxNS0+Z3QpOwogCiAJbW9ja19maWxlX2ZyZWUoaTkxNSwgZmls
ZSk7CiAKQEAgLTE3MjIsNyArMTcyMyw3IEBAIGludCBpOTE1X2dlbV9jb250ZXh0X21vY2tfc2Vs
ZnRlc3RzKHZvaWQpCiAJcmV0dXJuIGVycjsKIH0KIAotaW50IGk5MTVfZ2VtX2NvbnRleHRfbGl2
ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQoraW50IGk5MTVf
Z2VtX2NvbnRleHRfbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
CiB7CiAJc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3N1YnRlc3QgdGVzdHNbXSA9IHsKIAkJU1VC
VEVTVChsaXZlX25vcF9zd2l0Y2gpLApAQCAtMTczMyw4ICsxNzM0LDggQEAgaW50IGk5MTVfZ2Vt
X2NvbnRleHRfbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQogCQlTVUJURVNUKGlndF92bV9pc29sYXRpb24pLAogCX07CiAKLQlpZiAoaTkxNV90ZXJtaW5h
bGx5X3dlZGdlZChkZXZfcHJpdikpCisJaWYgKGludGVsX2d0X2lzX3dlZGdlZCgmaTkxNS0+Z3Qp
KQogCQlyZXR1cm4gMDsKIAotCXJldHVybiBpOTE1X2xpdmVfc3VidGVzdHModGVzdHMsIGRldl9w
cml2KTsKKwlyZXR1cm4gaTkxNV9saXZlX3N1YnRlc3RzKHRlc3RzLCBpOTE1KTsKIH0KZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fbW1hbi5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9tbWFuLmMKaW5k
ZXggYjk1ZmRjMmI2YmZjLi4wOTcxODFjNTU5NDcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fbW1hbi5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fbW1hbi5jCkBAIC00NjYsNyArNDY2LDcgQEAg
c3RhdGljIGludCBpZ3RfbW1hcF9vZmZzZXRfZXhoYXVzdGlvbih2b2lkICphcmcpCiAKIAkvKiBO
b3cgZmlsbCB3aXRoIGJ1c3kgZGVhZCBvYmplY3RzIHRoYXQgd2UgZXhwZWN0IHRvIHJlYXAgKi8K
IAlmb3IgKGxvb3AgPSAwOyBsb29wIDwgMzsgbG9vcCsrKSB7Ci0JCWlmIChpOTE1X3Rlcm1pbmFs
bHlfd2VkZ2VkKGk5MTUpKQorCQlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKCZpOTE1LT5ndCkpCiAJ
CQlicmVhazsKIAogCQlvYmogPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX2ludGVybmFsKGk5MTUs
IFBBR0VfU0laRSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRl
c3RzL2k5MTVfZ2VtX29iamVjdF9ibHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxm
dGVzdHMvaTkxNV9nZW1fb2JqZWN0X2JsdC5jCmluZGV4IDExZDM3MjM4YzYyYy4uMTk4NDNhY2M4
NGQzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVf
Z2VtX29iamVjdF9ibHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3Rz
L2k5MTVfZ2VtX29iamVjdF9ibHQuYwpAQCAtMyw2ICszLDggQEAKICAqIENvcHlyaWdodCDCqSAy
MDE5IEludGVsIENvcnBvcmF0aW9uCiAgKi8KIAorI2luY2x1ZGUgImd0L2ludGVsX2d0LmgiCisK
ICNpbmNsdWRlICJpOTE1X3NlbGZ0ZXN0LmgiCiAKICNpbmNsdWRlICJzZWxmdGVzdHMvaWd0X2Zs
dXNoX3Rlc3QuaCIKQEAgLTk1LDcgKzk3LDcgQEAgaW50IGk5MTVfZ2VtX29iamVjdF9ibHRfbGl2
ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJCVNVQlRFU1QoaWd0
X2ZpbGxfYmx0KSwKIAl9OwogCi0JaWYgKGk5MTVfdGVybWluYWxseV93ZWRnZWQoaTkxNSkpCisJ
aWYgKGludGVsX2d0X2lzX3dlZGdlZCgmaTkxNS0+Z3QpKQogCQlyZXR1cm4gMDsKIAogCWlmICgh
SEFTX0VOR0lORShpOTE1LCBCQ1MwKSkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2VuZ2luZS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5l
LmgKaW5kZXggZmFhYTE2NDI2N2Y0Li5hNGRiNGRkMjJiNGYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2VuZ2luZS5oCkBAIC00MTAsOCArNDEwLDggQEAgZ2VuOF9lbWl0X2dndHRfd3Jp
dGUodTMyICpjcywgdTMyIHZhbHVlLCB1MzIgZ3R0X29mZnNldCwgdTMyIGZsYWdzKQogCXJldHVy
biBjczsKIH0KIAotc3RhdGljIGlubGluZSB2b2lkIGludGVsX2VuZ2luZV9yZXNldChzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUsCi0JCQkJICAgICAgYm9vbCBzdGFsbGVkKQorc3RhdGlj
IGlubGluZSB2b2lkIF9faW50ZWxfZW5naW5lX3Jlc2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSwKKwkJCQkJYm9vbCBzdGFsbGVkKQogewogCWlmIChlbmdpbmUtPnJlc2V0LnJlc2V0
KQogCQllbmdpbmUtPnJlc2V0LnJlc2V0KGVuZ2luZSwgc3RhbGxlZCk7CkBAIC00MTksOSArNDE5
LDkgQEAgc3RhdGljIGlubGluZSB2b2lkIGludGVsX2VuZ2luZV9yZXNldChzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUsCiB9CiAKIGJvb2wgaW50ZWxfZW5naW5lX2lzX2lkbGUoc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKLWJvb2wgaW50ZWxfZW5naW5lc19hcmVfaWRsZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOworYm9vbCBpbnRlbF9lbmdpbmVzX2Fy
ZV9pZGxlKHN0cnVjdCBpbnRlbF9ndCAqZ3QpOwogCi12b2lkIGludGVsX2VuZ2luZXNfcmVzZXRf
ZGVmYXVsdF9zdWJtaXNzaW9uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKK3ZvaWQg
aW50ZWxfZW5naW5lc19yZXNldF9kZWZhdWx0X3N1Ym1pc3Npb24oc3RydWN0IGludGVsX2d0ICpn
dCk7CiB1bnNpZ25lZCBpbnQgaW50ZWxfZW5naW5lc19oYXNfY29udGV4dF9pc29sYXRpb24oc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwogCiBib29sIGludGVsX2VuZ2luZV9jYW5fc3Rv
cmVfZHdvcmQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKaW5kZXggYThmNWVkMWQ3NWJlLi44ZjMzNjViZmEw
YzEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jCkBAIC0xMTUz
LDcgKzExNTMsNyBAQCBzdGF0aWMgYm9vbCByaW5nX2lzX2lkbGUoc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lKQogYm9vbCBpbnRlbF9lbmdpbmVfaXNfaWRsZShzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmUpCiB7CiAJLyogTW9yZSB3aGl0ZSBsaWVzLCBpZiB3ZWRnZWQsIGh3IHN0
YXRlIGlzIGluY29uc2lzdGVudCAqLwotCWlmIChpOTE1X3Jlc2V0X2ZhaWxlZChlbmdpbmUtPmk5
MTUpKQorCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoZW5naW5lLT5ndCkpCiAJCXJldHVybiB0cnVl
OwogCiAJaWYgKCFpbnRlbF9lbmdpbmVfcG1faXNfYXdha2UoZW5naW5lKSkKQEAgLTExODksNyAr
MTE4OSw3IEBAIGJvb2wgaW50ZWxfZW5naW5lX2lzX2lkbGUoc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lKQogCXJldHVybiByaW5nX2lzX2lkbGUoZW5naW5lKTsKIH0KIAotYm9vbCBpbnRl
bF9lbmdpbmVzX2FyZV9pZGxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQorYm9vbCBp
bnRlbF9lbmdpbmVzX2FyZV9pZGxlKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7CiAJc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lOwogCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwpAQCAtMTE5
OCwxNCArMTE5OCwxNCBAQCBib29sIGludGVsX2VuZ2luZXNfYXJlX2lkbGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCiAJICogSWYgdGhlIGRyaXZlciBpcyB3ZWRnZWQsIEhXIHN0YXRl
IG1heSBiZSB2ZXJ5IGluY29uc2lzdGVudCBhbmQKIAkgKiByZXBvcnQgdGhhdCBpdCBpcyBzdGls
bCBidXN5LCBldmVuIHRob3VnaCB3ZSBoYXZlIHN0b3BwZWQgdXNpbmcgaXQuCiAJICovCi0JaWYg
KGk5MTVfcmVzZXRfZmFpbGVkKGk5MTUpKQorCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoZ3QpKQog
CQlyZXR1cm4gdHJ1ZTsKIAogCS8qIEFscmVhZHkgcGFya2VkIChhbmQgcGFzc2VkIGFuIGlkbGVu
ZXNzIHRlc3QpOyBtdXN0IHN0aWxsIGJlIGlkbGUgKi8KLQlpZiAoIVJFQURfT05DRShpOTE1LT5n
dC5hd2FrZSkpCisJaWYgKCFSRUFEX09OQ0UoZ3QtPmF3YWtlKSkKIAkJcmV0dXJuIHRydWU7CiAK
LQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgeworCWZvcl9lYWNoX2VuZ2luZShl
bmdpbmUsIGd0LT5pOTE1LCBpZCkgewogCQlpZiAoIWludGVsX2VuZ2luZV9pc19pZGxlKGVuZ2lu
ZSkpCiAJCQlyZXR1cm4gZmFsc2U7CiAJfQpAQCAtMTIxMywxMiArMTIxMywxMiBAQCBib29sIGlu
dGVsX2VuZ2luZXNfYXJlX2lkbGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJcmV0
dXJuIHRydWU7CiB9CiAKLXZvaWQgaW50ZWxfZW5naW5lc19yZXNldF9kZWZhdWx0X3N1Ym1pc3Np
b24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCit2b2lkIGludGVsX2VuZ2luZXNfcmVz
ZXRfZGVmYXVsdF9zdWJtaXNzaW9uKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7CiAJc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lOwogCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwogCi0JZm9y
X2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpCisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwg
Z3QtPmk5MTUsIGlkKQogCQllbmdpbmUtPnNldF9kZWZhdWx0X3N1Ym1pc3Npb24oZW5naW5lKTsK
IH0KIApAQCAtMTQ5NSw3ICsxNDk1LDcgQEAgdm9pZCBpbnRlbF9lbmdpbmVfZHVtcChzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUsCiAJCXZhX2VuZChhcCk7CiAJfQogCi0JaWYgKGk5MTVf
cmVzZXRfZmFpbGVkKGVuZ2luZS0+aTkxNSkpCisJaWYgKGludGVsX2d0X2lzX3dlZGdlZChlbmdp
bmUtPmd0KSkKIAkJZHJtX3ByaW50ZihtLCAiKioqIFdFREdFRCAqKipcbiIpOwogCiAJZHJtX3By
aW50ZihtLCAiXHRBd2FrZT8gJWRcbiIsIGF0b21pY19yZWFkKCZlbmdpbmUtPndha2VyZWYuY291
bnQpKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9w
bS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMKaW5kZXggZmU5
ZjllYWZmZTg4Li43NmM4MjhkMTFiMDUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2VuZ2luZV9wbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2VuZ2luZV9wbS5jCkBAIC05LDYgKzksNyBAQAogI2luY2x1ZGUgImludGVsX2VuZ2luZS5oIgog
I2luY2x1ZGUgImludGVsX2VuZ2luZV9wb29sLmgiCiAjaW5jbHVkZSAiaW50ZWxfZW5naW5lX3Bt
LmgiCisjaW5jbHVkZSAiaW50ZWxfZ3QuaCIKICNpbmNsdWRlICJpbnRlbF9ndF9wbS5oIgogCiBz
dGF0aWMgaW50IF9fZW5naW5lX3VucGFyayhzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2YpCkBAIC02
Nyw3ICs2OCw3IEBAIHN0YXRpYyBib29sIHN3aXRjaF90b19rZXJuZWxfY29udGV4dChzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJCXJldHVybiB0cnVlOwogCiAJLyogR1BVIGlzIHBv
aW50aW5nIHRvIHRoZSB2b2lkLCBhcyBnb29kIGFzIGluIHRoZSBrZXJuZWwgY29udGV4dC4gKi8K
LQlpZiAoaTkxNV9yZXNldF9mYWlsZWQoZW5naW5lLT5pOTE1KSkKKwlpZiAoaW50ZWxfZ3RfaXNf
d2VkZ2VkKGVuZ2luZS0+Z3QpKQogCQlyZXR1cm4gdHJ1ZTsKIAogCS8qCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZ3QuYwppbmRleCA0NmQyNGQ5ZDYyYWMuLjkwZWQ3OTI4NWZmOCAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9ndC5jCkBAIC0xOCw2ICsxOCw4IEBAIHZvaWQgaW50ZWxfZ3RfaW5p
dF9lYXJseShzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKIAogCXNwaW5fbG9ja19pbml0KCZndC0+Y2xvc2VkX2xvY2spOwogCisJaW50ZWxfZ3RfaW5p
dF9oYW5nY2hlY2soZ3QpOworCWludGVsX2d0X2luaXRfcmVzZXQoZ3QpOwogCWludGVsX2d0X3Bt
X2luaXRfZWFybHkoZ3QpOwogfQogCkBAIC0yNDAsMyArMjQyLDggQEAgdm9pZCBpbnRlbF9ndF9m
aW5pX3NjcmF0Y2goc3RydWN0IGludGVsX2d0ICpndCkKIHsKIAlpOTE1X3ZtYV91bnBpbl9hbmRf
cmVsZWFzZSgmZ3QtPnNjcmF0Y2gsIDApOwogfQorCit2b2lkIGludGVsX2d0X2NsZWFudXBfZWFy
bHkoc3RydWN0IGludGVsX2d0ICpndCkKK3sKKwlpbnRlbF9ndF9maW5pX3Jlc2V0KGd0KTsKK30K
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmggYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5oCmluZGV4IGNmM2M2Y2VjYzhlZS4uZjMwZDA0ZWNl
YjFhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5oCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmgKQEAgLTgsMTIgKzgsMTUgQEAKIAog
I2luY2x1ZGUgImludGVsX2VuZ2luZV90eXBlcy5oIgogI2luY2x1ZGUgImludGVsX2d0X3R5cGVz
LmgiCisjaW5jbHVkZSAiaW50ZWxfcmVzZXQuaCIKIAogc3RydWN0IGRybV9pOTE1X3ByaXZhdGU7
CiAKIHZvaWQgaW50ZWxfZ3RfaW5pdF9lYXJseShzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7CiB2b2lkIGludGVsX2d0X2luaXRfaHcoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpOwogCit2b2lkIGludGVsX2d0X2NsZWFudXBfZWFybHkoc3Ry
dWN0IGludGVsX2d0ICpndCk7CisKIHZvaWQgaW50ZWxfZ3RfY2hlY2tfYW5kX2NsZWFyX2ZhdWx0
cyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIHZvaWQgaW50ZWxfZ3RfY2xlYXJfZXJyb3JfcmVnaXN0
ZXJzKHN0cnVjdCBpbnRlbF9ndCAqZ3QsCiAJCQkJICAgIGludGVsX2VuZ2luZV9tYXNrX3QgZW5n
aW5lX21hc2spOwpAQCAtMjEsNiArMjQsOCBAQCB2b2lkIGludGVsX2d0X2NsZWFyX2Vycm9yX3Jl
Z2lzdGVycyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAogdm9pZCBpbnRlbF9ndF9mbHVzaF9nZ3R0X3dy
aXRlcyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIHZvaWQgaW50ZWxfZ3RfY2hpcHNldF9mbHVzaChz
dHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIAordm9pZCBpbnRlbF9ndF9pbml0X2hhbmdjaGVjayhzdHJ1
Y3QgaW50ZWxfZ3QgKmd0KTsKKwogaW50IGludGVsX2d0X2luaXRfc2NyYXRjaChzdHJ1Y3QgaW50
ZWxfZ3QgKmd0LCB1bnNpZ25lZCBpbnQgc2l6ZSk7CiB2b2lkIGludGVsX2d0X2Zpbmlfc2NyYXRj
aChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIApAQCAtMjksNCArMzQsMTEgQEAgc3RhdGljIGlubGlu
ZSB1MzIgaW50ZWxfZ3Rfc2NyYXRjaF9vZmZzZXQoY29uc3Qgc3RydWN0IGludGVsX2d0ICpndCkK
IAlyZXR1cm4gaTkxNV9nZ3R0X29mZnNldChndC0+c2NyYXRjaCk7CiB9CiAKK3N0YXRpYyBpbmxp
bmUgYm9vbCBpbnRlbF9ndF9pc193ZWRnZWQoc3RydWN0IGludGVsX2d0ICpndCkKK3sKKwlyZXR1
cm4gX19pbnRlbF9yZXNldF9mYWlsZWQoJmd0LT5yZXNldCk7Cit9CisKK3ZvaWQgaW50ZWxfZ3Rf
cXVldWVfaGFuZ2NoZWNrKHN0cnVjdCBpbnRlbF9ndCAqZ3QpOworCiAjZW5kaWYgLyogX19JTlRF
TF9HVF9IX18gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0
X3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9wbS5jCmluZGV4IDM2YmE4
MGU2YTBiNy4uOTA0N2UyOGU3NWFlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9ndF9wbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3Bt
LmMKQEAgLTUsNyArNSw5IEBACiAgKi8KIAogI2luY2x1ZGUgImk5MTVfZHJ2LmgiCisjaW5jbHVk
ZSAiaTkxNV9wYXJhbXMuaCIKICNpbmNsdWRlICJpbnRlbF9lbmdpbmVfcG0uaCIKKyNpbmNsdWRl
ICJpbnRlbF9ndC5oIgogI2luY2x1ZGUgImludGVsX2d0X3BtLmgiCiAjaW5jbHVkZSAiaW50ZWxf
cG0uaCIKICNpbmNsdWRlICJpbnRlbF93YWtlcmVmLmgiCkBAIC0xNyw2ICsxOSw3IEBAIHN0YXRp
YyB2b2lkIHBtX25vdGlmeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50IHN0YXRl
KQogCiBzdGF0aWMgaW50IGludGVsX2d0X3VucGFyayhzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2Yp
CiB7CisJc3RydWN0IGludGVsX2d0ICpndCA9IGNvbnRhaW5lcl9vZih3ZiwgdHlwZW9mKCpndCks
IHdha2VyZWYpOwogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0KIAkJY29udGFpbmVy
X29mKHdmLCB0eXBlb2YoKmk5MTUpLCBndC53YWtlcmVmKTsKIApAQCAtMzMsOCArMzYsOCBAQCBz
dGF0aWMgaW50IGludGVsX2d0X3VucGFyayhzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2YpCiAJICog
V29yayBhcm91bmQgaXQgYnkgZ3JhYmJpbmcgYSBHVCBJUlEgcG93ZXIgZG9tYWluIHdoaWxzdCB0
aGVyZSBpcyBhbnkKIAkgKiBHVCBhY3Rpdml0eSwgcHJldmVudGluZyBhbnkgREMgc3RhdGUgdHJh
bnNpdGlvbnMuCiAJICovCi0JaTkxNS0+Z3QuYXdha2UgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dl
dChpOTE1LCBQT1dFUl9ET01BSU5fR1RfSVJRKTsKLQlHRU1fQlVHX09OKCFpOTE1LT5ndC5hd2Fr
ZSk7CisJZ3QtPmF3YWtlID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoaTkxNSwgUE9XRVJfRE9N
QUlOX0dUX0lSUSk7CisJR0VNX0JVR19PTighZ3QtPmF3YWtlKTsKIAogCWludGVsX2VuYWJsZV9n
dF9wb3dlcnNhdmUoaTkxNSk7CiAKQEAgLTQ0LDcgKzQ3LDcgQEAgc3RhdGljIGludCBpbnRlbF9n
dF91bnBhcmsoc3RydWN0IGludGVsX3dha2VyZWYgKndmKQogCiAJaTkxNV9wbXVfZ3RfdW5wYXJr
ZWQoaTkxNSk7CiAKLQlpOTE1X3F1ZXVlX2hhbmdjaGVjayhpOTE1KTsKKwlpbnRlbF9ndF9xdWV1
ZV9oYW5nY2hlY2soZ3QpOwogCiAJcG1fbm90aWZ5KGk5MTUsIElOVEVMX0dUX1VOUEFSSyk7CiAK
QEAgLTkxLDEyICs5NCwxMiBAQCB2b2lkIGludGVsX2d0X3BtX2luaXRfZWFybHkoc3RydWN0IGlu
dGVsX2d0ICpndCkKIAlCTE9DS0lOR19JTklUX05PVElGSUVSX0hFQUQoJmd0LT5wbV9ub3RpZmlj
YXRpb25zKTsKIH0KIAotc3RhdGljIGJvb2wgcmVzZXRfZW5naW5lcyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKK3N0YXRpYyBib29sIHJlc2V0X2VuZ2luZXMoc3RydWN0IGludGVsX2d0
ICpndCkKIHsKLQlpZiAoSU5URUxfSU5GTyhpOTE1KS0+Z3B1X3Jlc2V0X2Nsb2JiZXJzX2Rpc3Bs
YXkpCisJaWYgKElOVEVMX0lORk8oZ3QtPmk5MTUpLT5ncHVfcmVzZXRfY2xvYmJlcnNfZGlzcGxh
eSkKIAkJcmV0dXJuIGZhbHNlOwogCi0JcmV0dXJuIGludGVsX2dwdV9yZXNldChpOTE1LCBBTExf
RU5HSU5FUykgPT0gMDsKKwlyZXR1cm4gaW50ZWxfZ3B1X3Jlc2V0KGd0LCBBTExfRU5HSU5FUykg
PT0gMDsKIH0KIAogLyoqCkBAIC0xMTYsMTEgKzExOSwxMSBAQCB2b2lkIGludGVsX2d0X3Nhbml0
aXplKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGJvb2wgZm9yY2UpCiAKIAlHRU1fVFJBQ0UoIlxuIik7
CiAKLQlpZiAoIXJlc2V0X2VuZ2luZXMoZ3QtPmk5MTUpICYmICFmb3JjZSkKKwlpZiAoIXJlc2V0
X2VuZ2luZXMoZ3QpICYmICFmb3JjZSkKIAkJcmV0dXJuOwogCiAJZm9yX2VhY2hfZW5naW5lKGVu
Z2luZSwgZ3QtPmk5MTUsIGlkKQotCQlpbnRlbF9lbmdpbmVfcmVzZXQoZW5naW5lLCBmYWxzZSk7
CisJCV9faW50ZWxfZW5naW5lX3Jlc2V0KGVuZ2luZSwgZmFsc2UpOwogfQogCiBpbnQgaW50ZWxf
Z3RfcmVzdW1lKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9ndF90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZ3RfdHlwZXMuaAppbmRleCBmNDNlYTgzMGIxZTguLjcwZDcyM2U4MDFiZiAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfdHlwZXMuaAorKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF90eXBlcy5oCkBAIC0xNCwxMiArMTQsMjEgQEAKICNp
bmNsdWRlIDxsaW51eC90eXBlcy5oPgogCiAjaW5jbHVkZSAiaTkxNV92bWEuaCIKKyNpbmNsdWRl
ICJpbnRlbF9yZXNldF90eXBlcy5oIgogI2luY2x1ZGUgImludGVsX3dha2VyZWYuaCIKIAogc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGU7CiBzdHJ1Y3QgaTkxNV9nZ3R0Owogc3RydWN0IGludGVsX3Vu
Y29yZTsKIAorc3RydWN0IGludGVsX2hhbmdjaGVjayB7CisJLyogRm9yIGhhbmdjaGVjayB0aW1l
ciAqLworI2RlZmluZSBEUk1fSTkxNV9IQU5HQ0hFQ0tfUEVSSU9EIDE1MDAgLyogaW4gbXMgKi8K
KyNkZWZpbmUgRFJNX0k5MTVfSEFOR0NIRUNLX0pJRkZJRVMgbXNlY3NfdG9famlmZmllcyhEUk1f
STkxNV9IQU5HQ0hFQ0tfUEVSSU9EKQorCisJc3RydWN0IGRlbGF5ZWRfd29yayB3b3JrOworfTsK
Kwogc3RydWN0IGludGVsX2d0IHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNTsKIAlz
dHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmU7CkBAIC0zOSw2ICs0OCw5IEBAIHN0cnVjdCBpbnRl
bF9ndCB7CiAJc3RydWN0IGxpc3RfaGVhZCBjbG9zZWRfdm1hOwogCXNwaW5sb2NrX3QgY2xvc2Vk
X2xvY2s7IC8qIGd1YXJkcyB0aGUgbGlzdCBvZiBjbG9zZWRfdm1hICovCiAKKwlzdHJ1Y3QgaW50
ZWxfaGFuZ2NoZWNrIGhhbmdjaGVjazsKKwlzdHJ1Y3QgaW50ZWxfcmVzZXQgcmVzZXQ7CisKIAkv
KioKIAkgKiBJcyB0aGUgR1BVIGN1cnJlbnRseSBjb25zaWRlcmVkIGlkbGUsIG9yIGJ1c3kgZXhl
Y3V0aW5nCiAJICogdXNlcnNwYWNlIHJlcXVlc3RzPyBXaGlsc3QgaWRsZSwgd2UgYWxsb3cgcnVu
dGltZSBwb3dlcgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfaGFu
Z2NoZWNrLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5nY2hlY2suYwppbmRl
eCA3OTdkOGVmMDk2OWMuLjg4MTc3ZjQ3YjRkOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfaGFuZ2NoZWNrLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfaGFuZ2NoZWNrLmMKQEAgLTIyLDggKzIyLDEwIEBACiAgKgogICovCiAKLSNpbmNsdWRl
ICJpbnRlbF9yZXNldC5oIgogI2luY2x1ZGUgImk5MTVfZHJ2LmgiCisjaW5jbHVkZSAiaW50ZWxf
ZW5naW5lLmgiCisjaW5jbHVkZSAiaW50ZWxfZ3QuaCIKKyNpbmNsdWRlICJpbnRlbF9yZXNldC5o
IgogCiBzdHJ1Y3QgaGFuZ2NoZWNrIHsKIAl1NjQgYWN0aGQ7CkBAIC0xMDAsNyArMTAyLDYgQEAg
aGVhZF9zdHVjayhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHU2NCBhY3RoZCkKIHN0
YXRpYyBlbnVtIGludGVsX2VuZ2luZV9oYW5nY2hlY2tfYWN0aW9uCiBlbmdpbmVfc3R1Y2soc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1NjQgYWN0aGQpCiB7Ci0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZW5naW5lLT5pOTE1OwogCWVudW0gaW50ZWxfZW5naW5l
X2hhbmdjaGVja19hY3Rpb24gaGE7CiAJdTMyIHRtcDsKIApAQCAtMTA4LDcgKzEwOSw3IEBAIGVu
Z2luZV9zdHVjayhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHU2NCBhY3RoZCkKIAlp
ZiAoaGEgIT0gRU5HSU5FX0RFQUQpCiAJCXJldHVybiBoYTsKIAotCWlmIChJU19HRU4oZGV2X3By
aXYsIDIpKQorCWlmIChJU19HRU4oZW5naW5lLT5pOTE1LCAyKSkKIAkJcmV0dXJuIEVOR0lORV9E
RUFEOwogCiAJLyogSXMgdGhlIGNoaXAgaGFuZ2luZyBvbiBhIFdBSVRfRk9SX0VWRU5UPwpAQCAt
MTE4LDggKzExOSw4IEBAIGVuZ2luZV9zdHVjayhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUsIHU2NCBhY3RoZCkKIAkgKi8KIAl0bXAgPSBFTkdJTkVfUkVBRChlbmdpbmUsIFJJTkdfQ1RM
KTsKIAlpZiAodG1wICYgUklOR19XQUlUKSB7Ci0JCWk5MTVfaGFuZGxlX2Vycm9yKGRldl9wcml2
LCBlbmdpbmUtPm1hc2ssIDAsCi0JCQkJICAic3R1Y2sgd2FpdCBvbiAlcyIsIGVuZ2luZS0+bmFt
ZSk7CisJCWludGVsX2d0X2hhbmRsZV9lcnJvcihlbmdpbmUtPmd0LCBlbmdpbmUtPm1hc2ssIDAs
CisJCQkJICAgICAgInN0dWNrIHdhaXQgb24gJXMiLCBlbmdpbmUtPm5hbWUpOwogCQlFTkdJTkVf
V1JJVEUoZW5naW5lLCBSSU5HX0NUTCwgdG1wKTsKIAkJcmV0dXJuIEVOR0lORV9XQUlUX0tJQ0s7
CiAJfQpAQCAtMjE5LDcgKzIyMCw3IEBAIHN0YXRpYyB2b2lkIGhhbmdjaGVja19hY2N1bXVsYXRl
X3NhbXBsZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCiAJCQkJIEk5MTVfRU5HSU5F
X1dFREdFRF9USU1FT1VUKTsKIH0KIAotc3RhdGljIHZvaWQgaGFuZ2NoZWNrX2RlY2xhcmVfaGFu
ZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKK3N0YXRpYyB2b2lkIGhhbmdjaGVja19k
ZWNsYXJlX2hhbmcoc3RydWN0IGludGVsX2d0ICpndCwKIAkJCQkgICBpbnRlbF9lbmdpbmVfbWFz
a190IGh1bmcsCiAJCQkJICAgaW50ZWxfZW5naW5lX21hc2tfdCBzdHVjaykKIHsKQEAgLTIzNSwx
MiArMjM2LDEyIEBAIHN0YXRpYyB2b2lkIGhhbmdjaGVja19kZWNsYXJlX2hhbmcoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCWh1bmcgJj0gfnN0dWNrOwogCWxlbiA9IHNjbnByaW50
Zihtc2csIHNpemVvZihtc2cpLAogCQkJIiVzIG9uICIsIHN0dWNrID09IGh1bmcgPyAibm8gcHJv
Z3Jlc3MiIDogImhhbmciKTsKLQlmb3JfZWFjaF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgaTkxNSwg
aHVuZywgdG1wKQorCWZvcl9lYWNoX2VuZ2luZV9tYXNrZWQoZW5naW5lLCBndC0+aTkxNSwgaHVu
ZywgdG1wKQogCQlsZW4gKz0gc2NucHJpbnRmKG1zZyArIGxlbiwgc2l6ZW9mKG1zZykgLSBsZW4s
CiAJCQkJICIlcywgIiwgZW5naW5lLT5uYW1lKTsKIAltc2dbbGVuLTJdID0gJ1wwJzsKIAotCXJl
dHVybiBpOTE1X2hhbmRsZV9lcnJvcihpOTE1LCBodW5nLCBJOTE1X0VSUk9SX0NBUFRVUkUsICIl
cyIsIG1zZyk7CisJcmV0dXJuIGludGVsX2d0X2hhbmRsZV9lcnJvcihndCwgaHVuZywgSTkxNV9F
UlJPUl9DQVBUVVJFLCAiJXMiLCBtc2cpOwogfQogCiAvKgpAQCAtMjUxLDExICsyNTIsMTAgQEAg
c3RhdGljIHZvaWQgaGFuZ2NoZWNrX2RlY2xhcmVfaGFuZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwKICAqIHdlIGtpY2sgdGhlIHJpbmcuIElmIHdlIHNlZSBubyBwcm9ncmVzcyBvbiB0
aHJlZSBzdWJzZXF1ZW50IGNhbGxzCiAgKiB3ZSBhc3N1bWUgY2hpcCBpcyB3ZWRnZWQgYW5kIHRy
eSB0byBmaXggaXQgYnkgcmVzZXR0aW5nIHRoZSBjaGlwLgogICovCi1zdGF0aWMgdm9pZCBpOTE1
X2hhbmdjaGVja19lbGFwc2VkKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKK3N0YXRpYyB2b2lk
IGhhbmdjaGVja19lbGFwc2VkKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKIHsKLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQotCQljb250YWluZXJfb2Yod29yaywgdHlwZW9m
KCpkZXZfcHJpdiksCi0JCQkgICAgIGdwdV9lcnJvci5oYW5nY2hlY2tfd29yay53b3JrKTsKKwlz
dHJ1Y3QgaW50ZWxfZ3QgKmd0ID0KKwkJY29udGFpbmVyX29mKHdvcmssIHR5cGVvZigqZ3QpLCBo
YW5nY2hlY2sud29yay53b3JrKTsKIAlpbnRlbF9lbmdpbmVfbWFza190IGh1bmcgPSAwLCBzdHVj
ayA9IDAsIHdlZGdlZCA9IDA7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwogCWVu
dW0gaW50ZWxfZW5naW5lX2lkIGlkOwpAQCAtMjY0LDEzICsyNjQsMTMgQEAgc3RhdGljIHZvaWQg
aTkxNV9oYW5nY2hlY2tfZWxhcHNlZChzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCiAJaWYgKCFp
OTE1X21vZHBhcmFtcy5lbmFibGVfaGFuZ2NoZWNrKQogCQlyZXR1cm47CiAKLQlpZiAoIVJFQURf
T05DRShkZXZfcHJpdi0+Z3QuYXdha2UpKQorCWlmICghUkVBRF9PTkNFKGd0LT5hd2FrZSkpCiAJ
CXJldHVybjsKIAotCWlmIChpOTE1X3Rlcm1pbmFsbHlfd2VkZ2VkKGRldl9wcml2KSkKKwlpZiAo
aW50ZWxfZ3RfaXNfd2VkZ2VkKGd0KSkKIAkJcmV0dXJuOwogCi0Jd2FrZXJlZiA9IGludGVsX3J1
bnRpbWVfcG1fZ2V0X2lmX2luX3VzZSgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOworCXdha2VyZWYg
PSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UoJmd0LT5pOTE1LT5ydW50aW1lX3BtKTsK
IAlpZiAoIXdha2VyZWYpCiAJCXJldHVybjsKIApAQCAtMjc4LDkgKzI3OCw5IEBAIHN0YXRpYyB2
b2lkIGk5MTVfaGFuZ2NoZWNrX2VsYXBzZWQoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQogCSAq
IHBlcmlvZGljYWxseSBhcm0gdGhlIG1taW8gY2hlY2tlciB0byBzZWUgaWYgd2UgYXJlIHRyaWdn
ZXJpbmcKIAkgKiBhbnkgaW52YWxpZCBhY2Nlc3MuCiAJICovCi0JaW50ZWxfdW5jb3JlX2FybV91
bmNsYWltZWRfbW1pb19kZXRlY3Rpb24oJmRldl9wcml2LT51bmNvcmUpOworCWludGVsX3VuY29y
ZV9hcm1fdW5jbGFpbWVkX21taW9fZGV0ZWN0aW9uKGd0LT51bmNvcmUpOwogCi0JZm9yX2VhY2hf
ZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYsIGlkKSB7CisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwg
Z3QtPmk5MTUsIGlkKSB7CiAJCXN0cnVjdCBoYW5nY2hlY2sgaGM7CiAKIAkJaW50ZWxfZW5naW5l
X3NpZ25hbF9icmVhZGNydW1icyhlbmdpbmUpOwpAQCAtMzAyLDcgKzMwMiw3IEBAIHN0YXRpYyB2
b2lkIGk5MTVfaGFuZ2NoZWNrX2VsYXBzZWQoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQogCWlm
IChHRU1fU0hPV19ERUJVRygpICYmIChodW5nIHwgc3R1Y2spKSB7CiAJCXN0cnVjdCBkcm1fcHJp
bnRlciBwID0gZHJtX2RlYnVnX3ByaW50ZXIoImhhbmdjaGVjayIpOwogCi0JCWZvcl9lYWNoX2Vu
Z2luZShlbmdpbmUsIGRldl9wcml2LCBpZCkgeworCQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBn
dC0+aTkxNSwgaWQpIHsKIAkJCWlmIChpbnRlbF9lbmdpbmVfaXNfaWRsZShlbmdpbmUpKQogCQkJ
CWNvbnRpbnVlOwogCkBAIC0zMTEsMjAgKzMxMSwzNiBAQCBzdGF0aWMgdm9pZCBpOTE1X2hhbmdj
aGVja19lbGFwc2VkKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKIAl9CiAKIAlpZiAod2VkZ2Vk
KSB7Ci0JCWRldl9lcnIoZGV2X3ByaXYtPmRybS5kZXYsCisJCWRldl9lcnIoZ3QtPmk5MTUtPmRy
bS5kZXYsCiAJCQkiR1BVIHJlY292ZXJ5IHRpbWVkIG91dCwiCiAJCQkiIGNhbmNlbGxpbmcgYWxs
IGluLWZsaWdodCByZW5kZXJpbmcuXG4iKTsKIAkJR0VNX1RSQUNFX0RVTVAoKTsKLQkJaTkxNV9n
ZW1fc2V0X3dlZGdlZChkZXZfcHJpdik7CisJCWludGVsX2d0X3NldF93ZWRnZWQoZ3QpOwogCX0K
IAogCWlmIChodW5nKQotCQloYW5nY2hlY2tfZGVjbGFyZV9oYW5nKGRldl9wcml2LCBodW5nLCBz
dHVjayk7CisJCWhhbmdjaGVja19kZWNsYXJlX2hhbmcoZ3QsIGh1bmcsIHN0dWNrKTsKIAotCWlu
dGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7CisJaW50
ZWxfcnVudGltZV9wbV9wdXQoJmd0LT5pOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAogCS8q
IFJlc2V0IHRpbWVyIGluIGNhc2UgR1BVIGhhbmdzIHdpdGhvdXQgYW5vdGhlciByZXF1ZXN0IGJl
aW5nIGFkZGVkICovCi0JaTkxNV9xdWV1ZV9oYW5nY2hlY2soZGV2X3ByaXYpOworCWludGVsX2d0
X3F1ZXVlX2hhbmdjaGVjayhndCk7Cit9CisKK3ZvaWQgaW50ZWxfZ3RfcXVldWVfaGFuZ2NoZWNr
KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCit7CisJdW5zaWduZWQgbG9uZyBkZWxheTsKKworCWlmICh1
bmxpa2VseSghaTkxNV9tb2RwYXJhbXMuZW5hYmxlX2hhbmdjaGVjaykpCisJCXJldHVybjsKKwor
CS8qIERvbid0IGNvbnRpbnVhbGx5IGRlZmVyIHRoZSBoYW5nY2hlY2sgc28gdGhhdCBpdCBpcyBh
bHdheXMgcnVuIGF0CisJICogbGVhc3Qgb25jZSBhZnRlciB3b3JrIGhhcyBiZWVuIHNjaGVkdWxl
ZCBvbiBhbnkgcmluZy4gT3RoZXJ3aXNlLAorCSAqIHdlIHdpbGwgaWdub3JlIGEgaHVuZyByaW5n
IGlmIGEgc2Vjb25kIHJpbmcgaXMga2VwdCBidXN5LgorCSAqLworCisJZGVsYXkgPSByb3VuZF9q
aWZmaWVzX3VwX3JlbGF0aXZlKERSTV9JOTE1X0hBTkdDSEVDS19KSUZGSUVTKTsKKwlxdWV1ZV9k
ZWxheWVkX3dvcmsoc3lzdGVtX2xvbmdfd3EsICZndC0+aGFuZ2NoZWNrLndvcmssIGRlbGF5KTsK
IH0KIAogdm9pZCBpbnRlbF9lbmdpbmVfaW5pdF9oYW5nY2hlY2soc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lKQpAQCAtMzMzLDEwICszNDksOSBAQCB2b2lkIGludGVsX2VuZ2luZV9pbml0
X2hhbmdjaGVjayhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJZW5naW5lLT5oYW5n
Y2hlY2suYWN0aW9uX3RpbWVzdGFtcCA9IGppZmZpZXM7CiB9CiAKLXZvaWQgaW50ZWxfaGFuZ2No
ZWNrX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCit2b2lkIGludGVsX2d0X2lu
aXRfaGFuZ2NoZWNrKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7Ci0JSU5JVF9ERUxBWUVEX1dPUkso
Jmk5MTUtPmdwdV9lcnJvci5oYW5nY2hlY2tfd29yaywKLQkJCSAgaTkxNV9oYW5nY2hlY2tfZWxh
cHNlZCk7CisJSU5JVF9ERUxBWUVEX1dPUksoJmd0LT5oYW5nY2hlY2sud29yaywgaGFuZ2NoZWNr
X2VsYXBzZWQpOwogfQogCiAjaWYgSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfU0VMRlRFU1Qp
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCmluZGV4IDRmNTE5NWQxYmM4Yi4uYTNhZmY1
NWE3ZGI2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwpAQCAtMjI2OSw3ICsyMjY5
LDcgQEAgc3RhdGljIHZvaWQgX19leGVjbGlzdHNfcmVzZXQoc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lLCBib29sIHN0YWxsZWQpCiAJICogYW5kIGhhdmUgdG8gYXQgbGVhc3QgcmVzdG9y
ZSB0aGUgUklORyByZWdpc3RlciBpbiB0aGUgY29udGV4dAogCSAqIGltYWdlIGJhY2sgdG8gdGhl
IGV4cGVjdGVkIHZhbHVlcyB0byBza2lwIG92ZXIgdGhlIGd1aWx0eSByZXF1ZXN0LgogCSAqLwot
CWk5MTVfcmVzZXRfcmVxdWVzdChycSwgc3RhbGxlZCk7CisJX19pOTE1X3JlcXVlc3RfcmVzZXQo
cnEsIHN0YWxsZWQpOwogCWlmICghc3RhbGxlZCkKIAkJZ290byBvdXRfcmVwbGF5OwogCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwppbmRleCA3MjAwMmMwZjk2OTguLjY3YzA2MjMx
YjAwNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jCkBAIC0xMTQsNyArMTE0
LDcgQEAgc3RhdGljIHZvaWQgY29udGV4dF9tYXJrX2lubm9jZW50KHN0cnVjdCBpOTE1X2dlbV9j
b250ZXh0ICpjdHgpCiAJYXRvbWljX2luYygmY3R4LT5hY3RpdmVfY291bnQpOwogfQogCi12b2lk
IGk5MTVfcmVzZXRfcmVxdWVzdChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgYm9vbCBndWlsdHkp
Cit2b2lkIF9faTkxNV9yZXF1ZXN0X3Jlc2V0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCBib29s
IGd1aWx0eSkKIHsKIAlHRU1fVFJBQ0UoIiVzIHJxPSVsbHg6JWxsZCwgZ3VpbHR5PyAlc1xuIiwK
IAkJICBycS0+ZW5naW5lLT5uYW1lLApAQCAtMTY0LDE2ICsxNjQsMTUgQEAgc3RhdGljIHZvaWQg
Z2VuM19zdG9wX2VuZ2luZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJCQkgIGlu
dGVsX3VuY29yZV9yZWFkX2Z3KHVuY29yZSwgUklOR19IRUFEKGJhc2UpKSk7CiB9CiAKLXN0YXRp
YyB2b2lkIGk5MTVfc3RvcF9lbmdpbmVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAot
CQkJICAgICAgaW50ZWxfZW5naW5lX21hc2tfdCBlbmdpbmVfbWFzaykKK3N0YXRpYyB2b2lkIHN0
b3BfZW5naW5lcyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBpbnRlbF9lbmdpbmVfbWFza190IGVuZ2lu
ZV9tYXNrKQogewogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKIAlpbnRlbF9lbmdp
bmVfbWFza190IHRtcDsKIAotCWlmIChJTlRFTF9HRU4oaTkxNSkgPCAzKQorCWlmIChJTlRFTF9H
RU4oZ3QtPmk5MTUpIDwgMykKIAkJcmV0dXJuOwogCi0JZm9yX2VhY2hfZW5naW5lX21hc2tlZChl
bmdpbmUsIGk5MTUsIGVuZ2luZV9tYXNrLCB0bXApCisJZm9yX2VhY2hfZW5naW5lX21hc2tlZChl
bmdpbmUsIGd0LT5pOTE1LCBlbmdpbmVfbWFzaywgdG1wKQogCQlnZW4zX3N0b3BfZW5naW5lKGVu
Z2luZSk7CiB9CiAKQEAgLTE4NSwxMSArMTg0LDExIEBAIHN0YXRpYyBib29sIGk5MTVfaW5fcmVz
ZXQoc3RydWN0IHBjaV9kZXYgKnBkZXYpCiAJcmV0dXJuIGdkcnN0ICYgR1JET01fUkVTRVRfU1RB
VFVTOwogfQogCi1zdGF0aWMgaW50IGk5MTVfZG9fcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCitzdGF0aWMgaW50IGk5MTVfZG9fcmVzZXQoc3RydWN0IGludGVsX2d0ICpndCwK
IAkJCSBpbnRlbF9lbmdpbmVfbWFza190IGVuZ2luZV9tYXNrLAogCQkJIHVuc2lnbmVkIGludCBy
ZXRyeSkKIHsKLQlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGk5MTUtPmRybS5wZGV2OworCXN0cnVj
dCBwY2lfZGV2ICpwZGV2ID0gZ3QtPmk5MTUtPmRybS5wZGV2OwogCWludCBlcnI7CiAKIAkvKiBB
c3NlcnQgcmVzZXQgZm9yIGF0IGxlYXN0IDIwIHVzZWMsIGFuZCB3YWl0IGZvciBhY2tub3dsZWRn
ZW1lbnQuICovCkBAIC0yMTQsMjIgKzIxMywyMiBAQCBzdGF0aWMgYm9vbCBnNHhfcmVzZXRfY29t
cGxldGUoc3RydWN0IHBjaV9kZXYgKnBkZXYpCiAJcmV0dXJuIChnZHJzdCAmIEdSRE9NX1JFU0VU
X0VOQUJMRSkgPT0gMDsKIH0KIAotc3RhdGljIGludCBnMzNfZG9fcmVzZXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCitzdGF0aWMgaW50IGczM19kb19yZXNldChzdHJ1Y3QgaW50ZWxf
Z3QgKmd0LAogCQkJaW50ZWxfZW5naW5lX21hc2tfdCBlbmdpbmVfbWFzaywKIAkJCXVuc2lnbmVk
IGludCByZXRyeSkKIHsKLQlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGk5MTUtPmRybS5wZGV2Owor
CXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gZ3QtPmk5MTUtPmRybS5wZGV2OwogCiAJcGNpX3dyaXRl
X2NvbmZpZ19ieXRlKHBkZXYsIEk5MTVfR0RSU1QsIEdSRE9NX1JFU0VUX0VOQUJMRSk7CiAJcmV0
dXJuIHdhaXRfZm9yX2F0b21pYyhnNHhfcmVzZXRfY29tcGxldGUocGRldiksIDUwKTsKIH0KIAot
c3RhdGljIGludCBnNHhfZG9fcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCitz
dGF0aWMgaW50IGc0eF9kb19yZXNldChzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAogCQkJaW50ZWxfZW5n
aW5lX21hc2tfdCBlbmdpbmVfbWFzaywKIAkJCXVuc2lnbmVkIGludCByZXRyeSkKIHsKLQlzdHJ1
Y3QgcGNpX2RldiAqcGRldiA9IGk5MTUtPmRybS5wZGV2OwotCXN0cnVjdCBpbnRlbF91bmNvcmUg
KnVuY29yZSA9ICZpOTE1LT51bmNvcmU7CisJc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBndC0+aTkx
NS0+ZHJtLnBkZXY7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gZ3QtPnVuY29yZTsK
IAlpbnQgcmV0OwogCiAJLyogV2FWY3BDbGtHYXRlRGlzYWJsZUZvck1lZGlhUmVzZXQ6Y3RnLGVs
ayAqLwpAQCAtMjYxLDExICsyNjAsMTEgQEAgc3RhdGljIGludCBnNHhfZG9fcmVzZXQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIGludCBp
cm9ubGFrZV9kb19yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKK3N0YXRpYyBp
bnQgaXJvbmxha2VfZG9fcmVzZXQoc3RydWN0IGludGVsX2d0ICpndCwKIAkJCSAgICAgaW50ZWxf
ZW5naW5lX21hc2tfdCBlbmdpbmVfbWFzaywKIAkJCSAgICAgdW5zaWduZWQgaW50IHJldHJ5KQog
ewotCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZpOTE1LT51bmNvcmU7CisJc3RydWN0
IGludGVsX3VuY29yZSAqdW5jb3JlID0gZ3QtPnVuY29yZTsKIAlpbnQgcmV0OwogCiAJaW50ZWxf
dW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgSUxLX0dEU1IsCkBAIC0yOTcsMTAgKzI5Niw5IEBAIHN0
YXRpYyBpbnQgaXJvbmxha2VfZG9fcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
CiB9CiAKIC8qIFJlc2V0IHRoZSBoYXJkd2FyZSBkb21haW5zIChHRU5YX0dSRE9NXyopIHNwZWNp
ZmllZCBieSBtYXNrICovCi1zdGF0aWMgaW50IGdlbjZfaHdfZG9tYWluX3Jlc2V0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAotCQkJCXUzMiBod19kb21haW5fbWFzaykKK3N0YXRpYyBp
bnQgZ2VuNl9od19kb21haW5fcmVzZXQoc3RydWN0IGludGVsX2d0ICpndCwgdTMyIGh3X2RvbWFp
bl9tYXNrKQogewotCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZpOTE1LT51bmNvcmU7
CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gZ3QtPnVuY29yZTsKIAlpbnQgZXJyOwog
CiAJLyoKQEAgLTMyMiw3ICszMjAsNyBAQCBzdGF0aWMgaW50IGdlbjZfaHdfZG9tYWluX3Jlc2V0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCXJldHVybiBlcnI7CiB9CiAKLXN0YXRp
YyBpbnQgZ2VuNl9yZXNldF9lbmdpbmVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAor
c3RhdGljIGludCBnZW42X3Jlc2V0X2VuZ2luZXMoc3RydWN0IGludGVsX2d0ICpndCwKIAkJCSAg
ICAgIGludGVsX2VuZ2luZV9tYXNrX3QgZW5naW5lX21hc2ssCiAJCQkgICAgICB1bnNpZ25lZCBp
bnQgcmV0cnkpCiB7CkBAIC0zNDIsMTMgKzM0MCwxMyBAQCBzdGF0aWMgaW50IGdlbjZfcmVzZXRf
ZW5naW5lcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJaW50ZWxfZW5naW5lX21h
c2tfdCB0bXA7CiAKIAkJaHdfbWFzayA9IDA7Ci0JCWZvcl9lYWNoX2VuZ2luZV9tYXNrZWQoZW5n
aW5lLCBpOTE1LCBlbmdpbmVfbWFzaywgdG1wKSB7CisJCWZvcl9lYWNoX2VuZ2luZV9tYXNrZWQo
ZW5naW5lLCBndC0+aTkxNSwgZW5naW5lX21hc2ssIHRtcCkgewogCQkJR0VNX0JVR19PTihlbmdp
bmUtPmlkID49IEFSUkFZX1NJWkUoaHdfZW5naW5lX21hc2spKTsKIAkJCWh3X21hc2sgfD0gaHdf
ZW5naW5lX21hc2tbZW5naW5lLT5pZF07CiAJCX0KIAl9CiAKLQlyZXR1cm4gZ2VuNl9od19kb21h
aW5fcmVzZXQoaTkxNSwgaHdfbWFzayk7CisJcmV0dXJuIGdlbjZfaHdfZG9tYWluX3Jlc2V0KGd0
LCBod19tYXNrKTsKIH0KIAogc3RhdGljIHUzMiBnZW4xMV9sb2NrX3NmYyhzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUpCkBAIC00NDYsNyArNDQ0LDcgQEAgc3RhdGljIHZvaWQgZ2VuMTFf
dW5sb2NrX3NmYyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJcm13X2NsZWFyX2Z3
KHVuY29yZSwgc2ZjX2ZvcmNlZF9sb2NrLCBzZmNfZm9yY2VkX2xvY2tfYml0KTsKIH0KIAotc3Rh
dGljIGludCBnZW4xMV9yZXNldF9lbmdpbmVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAorc3RhdGljIGludCBnZW4xMV9yZXNldF9lbmdpbmVzKHN0cnVjdCBpbnRlbF9ndCAqZ3QsCiAJ
CQkgICAgICAgaW50ZWxfZW5naW5lX21hc2tfdCBlbmdpbmVfbWFzaywKIAkJCSAgICAgICB1bnNp
Z25lZCBpbnQgcmV0cnkpCiB7CkBAIC00NjksMTcgKzQ2NywxNyBAQCBzdGF0aWMgaW50IGdlbjEx
X3Jlc2V0X2VuZ2luZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCWh3X21hc2sg
PSBHRU4xMV9HUkRPTV9GVUxMOwogCX0gZWxzZSB7CiAJCWh3X21hc2sgPSAwOwotCQlmb3JfZWFj
aF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgaTkxNSwgZW5naW5lX21hc2ssIHRtcCkgeworCQlmb3Jf
ZWFjaF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgZ3QtPmk5MTUsIGVuZ2luZV9tYXNrLCB0bXApIHsK
IAkJCUdFTV9CVUdfT04oZW5naW5lLT5pZCA+PSBBUlJBWV9TSVpFKGh3X2VuZ2luZV9tYXNrKSk7
CiAJCQlod19tYXNrIHw9IGh3X2VuZ2luZV9tYXNrW2VuZ2luZS0+aWRdOwogCQkJaHdfbWFzayB8
PSBnZW4xMV9sb2NrX3NmYyhlbmdpbmUpOwogCQl9CiAJfQogCi0JcmV0ID0gZ2VuNl9od19kb21h
aW5fcmVzZXQoaTkxNSwgaHdfbWFzayk7CisJcmV0ID0gZ2VuNl9od19kb21haW5fcmVzZXQoZ3Qs
IGh3X21hc2spOwogCiAJaWYgKGVuZ2luZV9tYXNrICE9IEFMTF9FTkdJTkVTKQotCQlmb3JfZWFj
aF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgaTkxNSwgZW5naW5lX21hc2ssIHRtcCkKKwkJZm9yX2Vh
Y2hfZW5naW5lX21hc2tlZChlbmdpbmUsIGd0LT5pOTE1LCBlbmdpbmVfbWFzaywgdG1wKQogCQkJ
Z2VuMTFfdW5sb2NrX3NmYyhlbmdpbmUpOwogCiAJcmV0dXJuIHJldDsKQEAgLTUyOSw3ICs1Mjcs
NyBAQCBzdGF0aWMgdm9pZCBnZW44X2VuZ2luZV9yZXNldF9jYW5jZWwoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQogCQkJICAgICAgX01BU0tFRF9CSVRfRElTQUJMRShSRVNFVF9DVExf
UkVRVUVTVF9SRVNFVCkpOwogfQogCi1zdGF0aWMgaW50IGdlbjhfcmVzZXRfZW5naW5lcyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKK3N0YXRpYyBpbnQgZ2VuOF9yZXNldF9lbmdpbmVz
KHN0cnVjdCBpbnRlbF9ndCAqZ3QsCiAJCQkgICAgICBpbnRlbF9lbmdpbmVfbWFza190IGVuZ2lu
ZV9tYXNrLAogCQkJICAgICAgdW5zaWduZWQgaW50IHJldHJ5KQogewpAQCAtNTM4LDcgKzUzNiw3
IEBAIHN0YXRpYyBpbnQgZ2VuOF9yZXNldF9lbmdpbmVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAogCWludGVsX2VuZ2luZV9tYXNrX3QgdG1wOwogCWludCByZXQ7CiAKLQlmb3JfZWFj
aF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgaTkxNSwgZW5naW5lX21hc2ssIHRtcCkgeworCWZvcl9l
YWNoX2VuZ2luZV9tYXNrZWQoZW5naW5lLCBndC0+aTkxNSwgZW5naW5lX21hc2ssIHRtcCkgewog
CQlyZXQgPSBnZW44X2VuZ2luZV9yZXNldF9wcmVwYXJlKGVuZ2luZSk7CiAJCWlmIChyZXQgJiYg
IXJlc2V0X25vbl9yZWFkeSkKIAkJCWdvdG8gc2tpcF9yZXNldDsKQEAgLTU1NCwyMyArNTUyLDIz
IEBAIHN0YXRpYyBpbnQgZ2VuOF9yZXNldF9lbmdpbmVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAogCQkgKiBXZSByYXRoZXIgdGFrZSBjb250ZXh0IGNvcnJ1cHRpb24gaW5zdGVhZCBv
ZgogCQkgKiBmYWlsZWQgcmVzZXQgd2l0aCBhIHdlZGdlZCBkcml2ZXIvZ3B1LiBBbmQKIAkJICog
YWN0aXZlIGJiIGV4ZWN1dGlvbiBjYXNlIHNob3VsZCBiZSBjb3ZlcmVkIGJ5Ci0JCSAqIGk5MTVf
c3RvcF9lbmdpbmVzIHdlIGhhdmUgYmVmb3JlIHRoZSByZXNldC4KKwkJICogc3RvcF9lbmdpbmVz
KCkgd2UgaGF2ZSBiZWZvcmUgdGhlIHJlc2V0LgogCQkgKi8KIAl9CiAKLQlpZiAoSU5URUxfR0VO
KGk5MTUpID49IDExKQotCQlyZXQgPSBnZW4xMV9yZXNldF9lbmdpbmVzKGk5MTUsIGVuZ2luZV9t
YXNrLCByZXRyeSk7CisJaWYgKElOVEVMX0dFTihndC0+aTkxNSkgPj0gMTEpCisJCXJldCA9IGdl
bjExX3Jlc2V0X2VuZ2luZXMoZ3QsIGVuZ2luZV9tYXNrLCByZXRyeSk7CiAJZWxzZQotCQlyZXQg
PSBnZW42X3Jlc2V0X2VuZ2luZXMoaTkxNSwgZW5naW5lX21hc2ssIHJldHJ5KTsKKwkJcmV0ID0g
Z2VuNl9yZXNldF9lbmdpbmVzKGd0LCBlbmdpbmVfbWFzaywgcmV0cnkpOwogCiBza2lwX3Jlc2V0
OgotCWZvcl9lYWNoX2VuZ2luZV9tYXNrZWQoZW5naW5lLCBpOTE1LCBlbmdpbmVfbWFzaywgdG1w
KQorCWZvcl9lYWNoX2VuZ2luZV9tYXNrZWQoZW5naW5lLCBndC0+aTkxNSwgZW5naW5lX21hc2ss
IHRtcCkKIAkJZ2VuOF9lbmdpbmVfcmVzZXRfY2FuY2VsKGVuZ2luZSk7CiAKIAlyZXR1cm4gcmV0
OwogfQogCi10eXBlZGVmIGludCAoKnJlc2V0X2Z1bmMpKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICosCit0eXBlZGVmIGludCAoKnJlc2V0X2Z1bmMpKHN0cnVjdCBpbnRlbF9ndCAqLAogCQkJICBp
bnRlbF9lbmdpbmVfbWFza190IGVuZ2luZV9tYXNrLAogCQkJICB1bnNpZ25lZCBpbnQgcmV0cnkp
OwogCkBAIC01OTIsMTUgKzU5MCwxNCBAQCBzdGF0aWMgcmVzZXRfZnVuYyBpbnRlbF9nZXRfZ3B1
X3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCQlyZXR1cm4gTlVMTDsKIH0K
IAotaW50IGludGVsX2dwdV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKLQkJ
ICAgIGludGVsX2VuZ2luZV9tYXNrX3QgZW5naW5lX21hc2spCitpbnQgaW50ZWxfZ3B1X3Jlc2V0
KHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGludGVsX2VuZ2luZV9tYXNrX3QgZW5naW5lX21hc2spCiB7
CiAJY29uc3QgaW50IHJldHJpZXMgPSBlbmdpbmVfbWFzayA9PSBBTExfRU5HSU5FUyA/IFJFU0VU
X01BWF9SRVRSSUVTIDogMTsKIAlyZXNldF9mdW5jIHJlc2V0OwogCWludCByZXQgPSAtRVRJTUVE
T1VUOwogCWludCByZXRyeTsKIAotCXJlc2V0ID0gaW50ZWxfZ2V0X2dwdV9yZXNldChpOTE1KTsK
KwlyZXNldCA9IGludGVsX2dldF9ncHVfcmVzZXQoZ3QtPmk5MTUpOwogCWlmICghcmVzZXQpCiAJ
CXJldHVybiAtRU5PREVWOwogCkBAIC02MDgsNyArNjA1LDcgQEAgaW50IGludGVsX2dwdV9yZXNl
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkgKiBJZiB0aGUgcG93ZXIgd2VsbCBz
bGVlcHMgZHVyaW5nIHRoZSByZXNldCwgdGhlIHJlc2V0CiAJICogcmVxdWVzdCBtYXkgYmUgZHJv
cHBlZCBhbmQgbmV2ZXIgY29tcGxldGVzIChjYXVzaW5nIC1FSU8pLgogCSAqLwotCWludGVsX3Vu
Y29yZV9mb3JjZXdha2VfZ2V0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOworCWludGVs
X3VuY29yZV9mb3JjZXdha2VfZ2V0KGd0LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwogCWZvciAo
cmV0cnkgPSAwOyByZXQgPT0gLUVUSU1FRE9VVCAmJiByZXRyeSA8IHJldHJpZXM7IHJldHJ5Kysp
IHsKIAkJLyoKIAkJICogV2Ugc3RvcCBlbmdpbmVzLCBvdGhlcndpc2Ugd2UgbWlnaHQgZ2V0IGZh
aWxlZCByZXNldCBhbmQgYQpAQCAtNjI1LDE0ICs2MjIsMTQgQEAgaW50IGludGVsX2dwdV9yZXNl
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJICogRklYTUU6IFdhIGZvciBtb3Jl
IG1vZGVybiBnZW5zIG5lZWRzIHRvIGJlIHZhbGlkYXRlZAogCQkgKi8KIAkJaWYgKHJldHJ5KQot
CQkJaTkxNV9zdG9wX2VuZ2luZXMoaTkxNSwgZW5naW5lX21hc2spOworCQkJc3RvcF9lbmdpbmVz
KGd0LCBlbmdpbmVfbWFzayk7CiAKIAkJR0VNX1RSQUNFKCJlbmdpbmVfbWFzaz0leFxuIiwgZW5n
aW5lX21hc2spOwogCQlwcmVlbXB0X2Rpc2FibGUoKTsKLQkJcmV0ID0gcmVzZXQoaTkxNSwgZW5n
aW5lX21hc2ssIHJldHJ5KTsKKwkJcmV0ID0gcmVzZXQoZ3QsIGVuZ2luZV9tYXNrLCByZXRyeSk7
CiAJCXByZWVtcHRfZW5hYmxlKCk7CiAJfQotCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZp
OTE1LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOworCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0
KGd0LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwogCiAJcmV0dXJuIHJldDsKIH0KQEAgLTY1MCwx
NyArNjQ3LDE3IEBAIGJvb2wgaW50ZWxfaGFzX3Jlc2V0X2VuZ2luZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKIAlyZXR1cm4gSU5URUxfSU5GTyhpOTE1KS0+aGFzX3Jlc2V0X2VuZ2lu
ZSAmJiBpOTE1X21vZHBhcmFtcy5yZXNldCA+PSAyOwogfQogCi1pbnQgaW50ZWxfcmVzZXRfZ3Vj
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQoraW50IGludGVsX3Jlc2V0X2d1YyhzdHJ1
Y3QgaW50ZWxfZ3QgKmd0KQogewogCXUzMiBndWNfZG9tYWluID0KLQkJSU5URUxfR0VOKGk5MTUp
ID49IDExID8gR0VOMTFfR1JET01fR1VDIDogR0VOOV9HUkRPTV9HVUM7CisJCUlOVEVMX0dFTihn
dC0+aTkxNSkgPj0gMTEgPyBHRU4xMV9HUkRPTV9HVUMgOiBHRU45X0dSRE9NX0dVQzsKIAlpbnQg
cmV0OwogCi0JR0VNX0JVR19PTighSEFTX0dVQyhpOTE1KSk7CisJR0VNX0JVR19PTighSEFTX0dV
QyhndC0+aTkxNSkpOwogCi0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmk5MTUtPnVuY29y
ZSwgRk9SQ0VXQUtFX0FMTCk7Ci0JcmV0ID0gZ2VuNl9od19kb21haW5fcmVzZXQoaTkxNSwgZ3Vj
X2RvbWFpbik7Ci0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmk5MTUtPnVuY29yZSwgRk9S
Q0VXQUtFX0FMTCk7CisJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoZ3QtPnVuY29yZSwgRk9S
Q0VXQUtFX0FMTCk7CisJcmV0ID0gZ2VuNl9od19kb21haW5fcmVzZXQoZ3QsIGd1Y19kb21haW4p
OworCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KGd0LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwp
OwogCiAJcmV0dXJuIHJldDsKIH0KQEAgLTY4Miw1NiArNjc5LDU1IEBAIHN0YXRpYyB2b2lkIHJl
c2V0X3ByZXBhcmVfZW5naW5lKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAllbmdp
bmUtPnJlc2V0LnByZXBhcmUoZW5naW5lKTsKIH0KIAotc3RhdGljIHZvaWQgcmV2b2tlX21tYXBz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQorc3RhdGljIHZvaWQgcmV2b2tlX21tYXBz
KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7CiAJaW50IGk7CiAKLQlmb3IgKGkgPSAwOyBpIDwgaTkx
NS0+Z2d0dC5udW1fZmVuY2VzOyBpKyspIHsKKwlmb3IgKGkgPSAwOyBpIDwgZ3QtPmdndHQtPm51
bV9mZW5jZXM7IGkrKykgewogCQlzdHJ1Y3QgZHJtX3ZtYV9vZmZzZXRfbm9kZSAqbm9kZTsKIAkJ
c3RydWN0IGk5MTVfdm1hICp2bWE7CiAJCXU2NCB2bWFfb2Zmc2V0OwogCi0JCXZtYSA9IFJFQURf
T05DRShpOTE1LT5nZ3R0LmZlbmNlX3JlZ3NbaV0udm1hKTsKKwkJdm1hID0gUkVBRF9PTkNFKGd0
LT5nZ3R0LT5mZW5jZV9yZWdzW2ldLnZtYSk7CiAJCWlmICghdm1hKQogCQkJY29udGludWU7CiAK
IAkJaWYgKCFpOTE1X3ZtYV9oYXNfdXNlcmZhdWx0KHZtYSkpCiAJCQljb250aW51ZTsKIAotCQlH
RU1fQlVHX09OKHZtYS0+ZmVuY2UgIT0gJmk5MTUtPmdndHQuZmVuY2VfcmVnc1tpXSk7CisJCUdF
TV9CVUdfT04odm1hLT5mZW5jZSAhPSAmZ3QtPmdndHQtPmZlbmNlX3JlZ3NbaV0pOwogCQlub2Rl
ID0gJnZtYS0+b2JqLT5iYXNlLnZtYV9ub2RlOwogCQl2bWFfb2Zmc2V0ID0gdm1hLT5nZ3R0X3Zp
ZXcucGFydGlhbC5vZmZzZXQgPDwgUEFHRV9TSElGVDsKLQkJdW5tYXBfbWFwcGluZ19yYW5nZShp
OTE1LT5kcm0uYW5vbl9pbm9kZS0+aV9tYXBwaW5nLAorCQl1bm1hcF9tYXBwaW5nX3JhbmdlKGd0
LT5pOTE1LT5kcm0uYW5vbl9pbm9kZS0+aV9tYXBwaW5nLAogCQkJCSAgICBkcm1fdm1hX25vZGVf
b2Zmc2V0X2FkZHIobm9kZSkgKyB2bWFfb2Zmc2V0LAogCQkJCSAgICB2bWEtPnNpemUsCiAJCQkJ
ICAgIDEpOwogCX0KIH0KIAotc3RhdGljIGludGVsX2VuZ2luZV9tYXNrX3QgcmVzZXRfcHJlcGFy
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKK3N0YXRpYyBpbnRlbF9lbmdpbmVfbWFz
a190IHJlc2V0X3ByZXBhcmUoc3RydWN0IGludGVsX2d0ICpndCkKIHsKIAlzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmU7CiAJaW50ZWxfZW5naW5lX21hc2tfdCBhd2FrZSA9IDA7CiAJZW51
bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CiAKLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBp
ZCkgeworCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LT5pOTE1LCBpZCkgewogCQlpZiAoaW50
ZWxfZW5naW5lX3BtX2dldF9pZl9hd2FrZShlbmdpbmUpKQogCQkJYXdha2UgfD0gZW5naW5lLT5t
YXNrOwogCQlyZXNldF9wcmVwYXJlX2VuZ2luZShlbmdpbmUpOwogCX0KIAotCWludGVsX3VjX3Jl
c2V0X3ByZXBhcmUoaTkxNSk7CisJaW50ZWxfdWNfcmVzZXRfcHJlcGFyZShndC0+aTkxNSk7CiAK
IAlyZXR1cm4gYXdha2U7CiB9CiAKLXN0YXRpYyB2b2lkIGd0X3Jldm9rZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSkKK3N0YXRpYyB2b2lkIGd0X3Jldm9rZShzdHJ1Y3QgaW50ZWxfZ3Qg
Kmd0KQogewotCXJldm9rZV9tbWFwcyhpOTE1KTsKKwlyZXZva2VfbW1hcHMoZ3QpOwogfQogCi1z
dGF0aWMgaW50IGd0X3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAotCQkgICAg
aW50ZWxfZW5naW5lX21hc2tfdCBzdGFsbGVkX21hc2spCitzdGF0aWMgaW50IGd0X3Jlc2V0KHN0
cnVjdCBpbnRlbF9ndCAqZ3QsIGludGVsX2VuZ2luZV9tYXNrX3Qgc3RhbGxlZF9tYXNrKQogewog
CXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKIAllbnVtIGludGVsX2VuZ2luZV9pZCBp
ZDsKQEAgLTc0MSwxNCArNzM3LDE0IEBAIHN0YXRpYyBpbnQgZ3RfcmVzZXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCiAJICogRXZlcnl0aGluZyBkZXBlbmRzIG9uIGhhdmluZyB0aGUg
R1RUIHJ1bm5pbmcsIHNvIHdlIG5lZWQgdG8gc3RhcnQKIAkgKiB0aGVyZS4KIAkgKi8KLQllcnIg
PSBpOTE1X2dndHRfZW5hYmxlX2h3KGk5MTUpOworCWVyciA9IGk5MTVfZ2d0dF9lbmFibGVfaHco
Z3QtPmk5MTUpOwogCWlmIChlcnIpCiAJCXJldHVybiBlcnI7CiAKLQlmb3JfZWFjaF9lbmdpbmUo
ZW5naW5lLCBpOTE1LCBpZCkKLQkJaW50ZWxfZW5naW5lX3Jlc2V0KGVuZ2luZSwgc3RhbGxlZF9t
YXNrICYgZW5naW5lLT5tYXNrKTsKKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndC0+aTkxNSwg
aWQpCisJCV9faW50ZWxfZW5naW5lX3Jlc2V0KGVuZ2luZSwgc3RhbGxlZF9tYXNrICYgZW5naW5l
LT5tYXNrKTsKIAotCWk5MTVfZ2VtX3Jlc3RvcmVfZmVuY2VzKGk5MTUpOworCWk5MTVfZ2VtX3Jl
c3RvcmVfZmVuY2VzKGd0LT5pOTE1KTsKIAogCXJldHVybiBlcnI7CiB9CkBAIC03NjEsMTMgKzc1
NywxMiBAQCBzdGF0aWMgdm9pZCByZXNldF9maW5pc2hfZW5naW5lKHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSkKIAlpbnRlbF9lbmdpbmVfc2lnbmFsX2JyZWFkY3J1bWJzKGVuZ2luZSk7
CiB9CiAKLXN0YXRpYyB2b2lkIHJlc2V0X2ZpbmlzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKLQkJCSBpbnRlbF9lbmdpbmVfbWFza190IGF3YWtlKQorc3RhdGljIHZvaWQgcmVzZXRf
ZmluaXNoKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGludGVsX2VuZ2luZV9tYXNrX3QgYXdha2UpCiB7
CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwogCWVudW0gaW50ZWxfZW5naW5lX2lk
IGlkOwogCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKKwlmb3JfZWFjaF9l
bmdpbmUoZW5naW5lLCBndC0+aTkxNSwgaWQpIHsKIAkJcmVzZXRfZmluaXNoX2VuZ2luZShlbmdp
bmUpOwogCQlpZiAoYXdha2UgJiBlbmdpbmUtPm1hc2spCiAJCQlpbnRlbF9lbmdpbmVfcG1fcHV0
KGVuZ2luZSk7CkBAIC03OTEsMjAgKzc4NiwxOSBAQCBzdGF0aWMgdm9pZCBub3Bfc3VibWl0X3Jl
cXVlc3Qoc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCkKIAlpbnRlbF9lbmdpbmVfcXVldWVf
YnJlYWRjcnVtYnMoZW5naW5lKTsKIH0KIAotc3RhdGljIHZvaWQgX19pOTE1X2dlbV9zZXRfd2Vk
Z2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQorc3RhdGljIHZvaWQgX19pbnRlbF9n
dF9zZXRfd2VkZ2VkKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7Ci0Jc3RydWN0IGk5MTVfZ3B1X2Vy
cm9yICplcnJvciA9ICZpOTE1LT5ncHVfZXJyb3I7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lOwogCWludGVsX2VuZ2luZV9tYXNrX3QgYXdha2U7CiAJZW51bSBpbnRlbF9lbmdpbmVf
aWQgaWQ7CiAKLQlpZiAodGVzdF9iaXQoSTkxNV9XRURHRUQsICZlcnJvci0+ZmxhZ3MpKQorCWlm
ICh0ZXN0X2JpdChJOTE1X1dFREdFRCwgJmd0LT5yZXNldC5mbGFncykpCiAJCXJldHVybjsKIAot
CWlmIChHRU1fU0hPV19ERUJVRygpICYmICFpbnRlbF9lbmdpbmVzX2FyZV9pZGxlKGk5MTUpKSB7
CisJaWYgKEdFTV9TSE9XX0RFQlVHKCkgJiYgIWludGVsX2VuZ2luZXNfYXJlX2lkbGUoZ3QpKSB7
CiAJCXN0cnVjdCBkcm1fcHJpbnRlciBwID0gZHJtX2RlYnVnX3ByaW50ZXIoX19mdW5jX18pOwog
Ci0JCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKQorCQlmb3JfZWFjaF9lbmdpbmUo
ZW5naW5lLCBndC0+aTkxNSwgaWQpCiAJCQlpbnRlbF9lbmdpbmVfZHVtcChlbmdpbmUsICZwLCAi
JXNcbiIsIGVuZ2luZS0+bmFtZSk7CiAJfQogCkBAIC04MTUsMTcgKzgwOSwxNyBAQCBzdGF0aWMg
dm9pZCBfX2k5MTVfZ2VtX3NldF93ZWRnZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
CiAJICogcm9sbGluZyB0aGUgZ2xvYmFsIHNlcW5vIGZvcndhcmQgKHNpbmNlIHRoaXMgd291bGQg
Y29tcGxldGUgcmVxdWVzdHMKIAkgKiBmb3Igd2hpY2ggd2UgaGF2ZW4ndCBzZXQgdGhlIGZlbmNl
IGVycm9yIHRvIEVJTyB5ZXQpLgogCSAqLwotCWF3YWtlID0gcmVzZXRfcHJlcGFyZShpOTE1KTsK
Kwlhd2FrZSA9IHJlc2V0X3ByZXBhcmUoZ3QpOwogCiAJLyogRXZlbiBpZiB0aGUgR1BVIHJlc2V0
IGZhaWxzLCBpdCBzaG91bGQgc3RpbGwgc3RvcCB0aGUgZW5naW5lcyAqLwotCWlmICghSU5URUxf
SU5GTyhpOTE1KS0+Z3B1X3Jlc2V0X2Nsb2JiZXJzX2Rpc3BsYXkpCi0JCWludGVsX2dwdV9yZXNl
dChpOTE1LCBBTExfRU5HSU5FUyk7CisJaWYgKCFJTlRFTF9JTkZPKGd0LT5pOTE1KS0+Z3B1X3Jl
c2V0X2Nsb2JiZXJzX2Rpc3BsYXkpCisJCWludGVsX2dwdV9yZXNldChndCwgQUxMX0VOR0lORVMp
OwogCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKKwlmb3JfZWFjaF9lbmdp
bmUoZW5naW5lLCBndC0+aTkxNSwgaWQpIHsKIAkJZW5naW5lLT5zdWJtaXRfcmVxdWVzdCA9IG5v
cF9zdWJtaXRfcmVxdWVzdDsKIAkJZW5naW5lLT5zY2hlZHVsZSA9IE5VTEw7CiAJfQotCWk5MTUt
PmNhcHMuc2NoZWR1bGVyID0gMDsKKwlndC0+aTkxNS0+Y2Fwcy5zY2hlZHVsZXIgPSAwOwogCiAJ
LyoKIAkgKiBNYWtlIHN1cmUgbm8gcmVxdWVzdCBjYW4gc2xpcCB0aHJvdWdoIHdpdGhvdXQgZ2V0
dGluZyBjb21wbGV0ZWQgYnkKQEAgLTgzMywzOCArODI3LDM2IEBAIHN0YXRpYyB2b2lkIF9faTkx
NV9nZW1fc2V0X3dlZGdlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkgKiBpbiBu
b3Bfc3VibWl0X3JlcXVlc3QuCiAJICovCiAJc3luY2hyb25pemVfcmN1X2V4cGVkaXRlZCgpOwot
CXNldF9iaXQoSTkxNV9XRURHRUQsICZlcnJvci0+ZmxhZ3MpOworCXNldF9iaXQoSTkxNV9XRURH
RUQsICZndC0+cmVzZXQuZmxhZ3MpOwogCiAJLyogTWFyayBhbGwgZXhlY3V0aW5nIHJlcXVlc3Rz
IGFzIHNraXBwZWQgKi8KLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkKKwlmb3Jf
ZWFjaF9lbmdpbmUoZW5naW5lLCBndC0+aTkxNSwgaWQpCiAJCWVuZ2luZS0+Y2FuY2VsX3JlcXVl
c3RzKGVuZ2luZSk7CiAKLQlyZXNldF9maW5pc2goaTkxNSwgYXdha2UpOworCXJlc2V0X2Zpbmlz
aChndCwgYXdha2UpOwogCiAJR0VNX1RSQUNFKCJlbmRcbiIpOwogfQogCi12b2lkIGk5MTVfZ2Vt
X3NldF93ZWRnZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCit2b2lkIGludGVsX2d0
X3NldF93ZWRnZWQoc3RydWN0IGludGVsX2d0ICpndCkKIHsKLQlzdHJ1Y3QgaTkxNV9ncHVfZXJy
b3IgKmVycm9yID0gJmk5MTUtPmdwdV9lcnJvcjsKIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsK
IAotCW11dGV4X2xvY2soJmVycm9yLT53ZWRnZV9tdXRleCk7Ci0Jd2l0aF9pbnRlbF9ydW50aW1l
X3BtKCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKQotCQlfX2k5MTVfZ2VtX3NldF93ZWRnZWQo
aTkxNSk7Ci0JbXV0ZXhfdW5sb2NrKCZlcnJvci0+d2VkZ2VfbXV0ZXgpOworCW11dGV4X2xvY2so
Jmd0LT5yZXNldC5tdXRleCk7CisJd2l0aF9pbnRlbF9ydW50aW1lX3BtKCZndC0+aTkxNS0+cnVu
dGltZV9wbSwgd2FrZXJlZikKKwkJX19pbnRlbF9ndF9zZXRfd2VkZ2VkKGd0KTsKKwltdXRleF91
bmxvY2soJmd0LT5yZXNldC5tdXRleCk7CiB9CiAKLXN0YXRpYyBib29sIF9faTkxNV9nZW1fdW5z
ZXRfd2VkZ2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQorc3RhdGljIGJvb2wgX19p
bnRlbF9ndF91bnNldF93ZWRnZWQoc3RydWN0IGludGVsX2d0ICpndCkKIHsKLQlzdHJ1Y3QgaTkx
NV9ncHVfZXJyb3IgKmVycm9yID0gJmk5MTUtPmdwdV9lcnJvcjsKLQlzdHJ1Y3QgaW50ZWxfZ3Rf
dGltZWxpbmVzICp0aW1lbGluZXMgPSAmaTkxNS0+Z3QudGltZWxpbmVzOworCXN0cnVjdCBpbnRl
bF9ndF90aW1lbGluZXMgKnRpbWVsaW5lcyA9ICZndC0+dGltZWxpbmVzOwogCXN0cnVjdCBpbnRl
bF90aW1lbGluZSAqdGw7CiAKLQlpZiAoIXRlc3RfYml0KEk5MTVfV0VER0VELCAmZXJyb3ItPmZs
YWdzKSkKKwlpZiAoIXRlc3RfYml0KEk5MTVfV0VER0VELCAmZ3QtPnJlc2V0LmZsYWdzKSkKIAkJ
cmV0dXJuIHRydWU7CiAKLQlpZiAoIWk5MTUtPmd0LnNjcmF0Y2gpIC8qIE5ldmVyIGZ1bGwgaW5p
dGlhbGlzZWQsIHJlY292ZXJ5IGltcG9zc2libGUgKi8KKwlpZiAoIWd0LT5zY3JhdGNoKSAvKiBO
ZXZlciBmdWxsIGluaXRpYWxpc2VkLCByZWNvdmVyeSBpbXBvc3NpYmxlICovCiAJCXJldHVybiBm
YWxzZTsKIAogCUdFTV9UUkFDRSgic3RhcnRcbiIpOwpAQCAtOTA1LDcgKzg5Nyw3IEBAIHN0YXRp
YyBib29sIF9faTkxNV9nZW1fdW5zZXRfd2VkZ2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQogCX0KIAlzcGluX3VubG9jaygmdGltZWxpbmVzLT5sb2NrKTsKIAotCWludGVsX2d0X3Nh
bml0aXplKCZpOTE1LT5ndCwgZmFsc2UpOworCWludGVsX2d0X3Nhbml0aXplKGd0LCBmYWxzZSk7
CiAKIAkvKgogCSAqIFVuZG8gbm9wX3N1Ym1pdF9yZXF1ZXN0LiBXZSBwcmV2ZW50IGFsbCBuZXcg
aTkxNSByZXF1ZXN0cyBmcm9tCkBAIC05MTYsNTMgKzkwOCw1MSBAQCBzdGF0aWMgYm9vbCBfX2k5
MTVfZ2VtX3Vuc2V0X3dlZGdlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkgKiB0
aGUgbm9wX3N1Ym1pdF9yZXF1ZXN0IG9uIHJlc2V0LCB3ZSBjYW4gZG8gdGhpcyBmcm9tIG5vcm1h
bAogCSAqIGNvbnRleHQgYW5kIGRvIG5vdCByZXF1aXJlIHN0b3BfbWFjaGluZSgpLgogCSAqLwot
CWludGVsX2VuZ2luZXNfcmVzZXRfZGVmYXVsdF9zdWJtaXNzaW9uKGk5MTUpOworCWludGVsX2Vu
Z2luZXNfcmVzZXRfZGVmYXVsdF9zdWJtaXNzaW9uKGd0KTsKIAogCUdFTV9UUkFDRSgiZW5kXG4i
KTsKIAogCXNtcF9tYl9fYmVmb3JlX2F0b21pYygpOyAvKiBjb21wbGV0ZSB0YWtlb3ZlciBiZWZv
cmUgZW5hYmxpbmcgZXhlY2J1ZiAqLwotCWNsZWFyX2JpdChJOTE1X1dFREdFRCwgJmk5MTUtPmdw
dV9lcnJvci5mbGFncyk7CisJY2xlYXJfYml0KEk5MTVfV0VER0VELCAmZ3QtPnJlc2V0LmZsYWdz
KTsKIAogCXJldHVybiB0cnVlOwogfQogCi1ib29sIGk5MTVfZ2VtX3Vuc2V0X3dlZGdlZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKK2Jvb2wgaW50ZWxfZ3RfdW5zZXRfd2VkZ2VkKHN0
cnVjdCBpbnRlbF9ndCAqZ3QpCiB7Ci0Jc3RydWN0IGk5MTVfZ3B1X2Vycm9yICplcnJvciA9ICZp
OTE1LT5ncHVfZXJyb3I7CiAJYm9vbCByZXN1bHQ7CiAKLQltdXRleF9sb2NrKCZlcnJvci0+d2Vk
Z2VfbXV0ZXgpOwotCXJlc3VsdCA9IF9faTkxNV9nZW1fdW5zZXRfd2VkZ2VkKGk5MTUpOwotCW11
dGV4X3VubG9jaygmZXJyb3ItPndlZGdlX211dGV4KTsKKwltdXRleF9sb2NrKCZndC0+cmVzZXQu
bXV0ZXgpOworCXJlc3VsdCA9IF9faW50ZWxfZ3RfdW5zZXRfd2VkZ2VkKGd0KTsKKwltdXRleF91
bmxvY2soJmd0LT5yZXNldC5tdXRleCk7CiAKIAlyZXR1cm4gcmVzdWx0OwogfQogCi1zdGF0aWMg
aW50IGRvX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAotCQkgICAgaW50ZWxf
ZW5naW5lX21hc2tfdCBzdGFsbGVkX21hc2spCitzdGF0aWMgaW50IGRvX3Jlc2V0KHN0cnVjdCBp
bnRlbF9ndCAqZ3QsIGludGVsX2VuZ2luZV9tYXNrX3Qgc3RhbGxlZF9tYXNrKQogewogCWludCBl
cnIsIGk7CiAKLQlndF9yZXZva2UoaTkxNSk7CisJZ3RfcmV2b2tlKGd0KTsKIAotCWVyciA9IGlu
dGVsX2dwdV9yZXNldChpOTE1LCBBTExfRU5HSU5FUyk7CisJZXJyID0gaW50ZWxfZ3B1X3Jlc2V0
KGd0LCBBTExfRU5HSU5FUyk7CiAJZm9yIChpID0gMDsgZXJyICYmIGkgPCBSRVNFVF9NQVhfUkVU
UklFUzsgaSsrKSB7CiAJCW1zbGVlcCgxMCAqIChpICsgMSkpOwotCQllcnIgPSBpbnRlbF9ncHVf
cmVzZXQoaTkxNSwgQUxMX0VOR0lORVMpOworCQllcnIgPSBpbnRlbF9ncHVfcmVzZXQoZ3QsIEFM
TF9FTkdJTkVTKTsKIAl9CiAJaWYgKGVycikKIAkJcmV0dXJuIGVycjsKIAotCXJldHVybiBndF9y
ZXNldChpOTE1LCBzdGFsbGVkX21hc2spOworCXJldHVybiBndF9yZXNldChndCwgc3RhbGxlZF9t
YXNrKTsKIH0KIAotc3RhdGljIGludCByZXN1bWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCitzdGF0aWMgaW50IHJlc3VtZShzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewogCXN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKIAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKIAlpbnQg
cmV0OwogCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKKwlmb3JfZWFjaF9l
bmdpbmUoZW5naW5lLCBndC0+aTkxNSwgaWQpIHsKIAkJcmV0ID0gZW5naW5lLT5yZXN1bWUoZW5n
aW5lKTsKIAkJaWYgKHJldCkKIAkJCXJldHVybiByZXQ7CkBAIC05NzIsOCArOTYyLDggQEAgc3Rh
dGljIGludCByZXN1bWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB9CiAKIC8qKgot
ICogaTkxNV9yZXNldCAtIHJlc2V0IGNoaXAgYWZ0ZXIgYSBoYW5nCi0gKiBAaTkxNTogI2RybV9p
OTE1X3ByaXZhdGUgdG8gcmVzZXQKKyAqIGludGVsX2d0X3Jlc2V0IC0gcmVzZXQgY2hpcCBhZnRl
ciBhIGhhbmcKKyAqIEBndDogI2ludGVsX2d0IHRvIHJlc2V0CiAgKiBAc3RhbGxlZF9tYXNrOiBt
YXNrIG9mIHRoZSBzdGFsbGVkIGVuZ2luZXMgd2l0aCB0aGUgZ3VpbHR5IHJlcXVlc3RzCiAgKiBA
cmVhc29uOiB1c2VyIGVycm9yIG1lc3NhZ2UgZm9yIHdoeSB3ZSBhcmUgcmVzZXR0aW5nCiAgKgpA
QCAtOTg4LDUwICs5NzgsNTAgQEAgc3RhdGljIGludCByZXN1bWUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCiAgKiAgIC0gcmUtaW5pdCBpbnRlcnJ1cHQgc3RhdGUKICAqICAgLSByZS1p
bml0IGRpc3BsYXkKICAqLwotdm9pZCBpOTE1X3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAotCQlpbnRlbF9lbmdpbmVfbWFza190IHN0YWxsZWRfbWFzaywKLQkJY29uc3QgY2hh
ciAqcmVhc29uKQordm9pZCBpbnRlbF9ndF9yZXNldChzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAorCQkg
ICAgaW50ZWxfZW5naW5lX21hc2tfdCBzdGFsbGVkX21hc2ssCisJCSAgICBjb25zdCBjaGFyICpy
ZWFzb24pCiB7Ci0Jc3RydWN0IGk5MTVfZ3B1X2Vycm9yICplcnJvciA9ICZpOTE1LT5ncHVfZXJy
b3I7CiAJaW50ZWxfZW5naW5lX21hc2tfdCBhd2FrZTsKIAlpbnQgcmV0OwogCi0JR0VNX1RSQUNF
KCJmbGFncz0lbHhcbiIsIGVycm9yLT5mbGFncyk7CisJR0VNX1RSQUNFKCJmbGFncz0lbHhcbiIs
IGd0LT5yZXNldC5mbGFncyk7CiAKIAltaWdodF9zbGVlcCgpOwotCUdFTV9CVUdfT04oIXRlc3Rf
Yml0KEk5MTVfUkVTRVRfQkFDS09GRiwgJmVycm9yLT5mbGFncykpOwotCW11dGV4X2xvY2soJmVy
cm9yLT53ZWRnZV9tdXRleCk7CisJR0VNX0JVR19PTighdGVzdF9iaXQoSTkxNV9SRVNFVF9CQUNL
T0ZGLCAmZ3QtPnJlc2V0LmZsYWdzKSk7CisJbXV0ZXhfbG9jaygmZ3QtPnJlc2V0Lm11dGV4KTsK
IAogCS8qIENsZWFyIGFueSBwcmV2aW91cyBmYWlsZWQgYXR0ZW1wdHMgYXQgcmVjb3ZlcnkuIFRp
bWUgdG8gdHJ5IGFnYWluLiAqLwotCWlmICghX19pOTE1X2dlbV91bnNldF93ZWRnZWQoaTkxNSkp
CisJaWYgKCFfX2ludGVsX2d0X3Vuc2V0X3dlZGdlZChndCkpCiAJCWdvdG8gdW5sb2NrOwogCiAJ
aWYgKHJlYXNvbikKLQkJZGV2X25vdGljZShpOTE1LT5kcm0uZGV2LCAiUmVzZXR0aW5nIGNoaXAg
Zm9yICVzXG4iLCByZWFzb24pOwotCWVycm9yLT5yZXNldF9jb3VudCsrOworCQlkZXZfbm90aWNl
KGd0LT5pOTE1LT5kcm0uZGV2LAorCQkJICAgIlJlc2V0dGluZyBjaGlwIGZvciAlc1xuIiwgcmVh
c29uKTsKKwlhdG9taWNfaW5jKCZndC0+aTkxNS0+Z3B1X2Vycm9yLnJlc2V0X2NvdW50KTsKIAot
CWF3YWtlID0gcmVzZXRfcHJlcGFyZShpOTE1KTsKKwlhd2FrZSA9IHJlc2V0X3ByZXBhcmUoZ3Qp
OwogCi0JaWYgKCFpbnRlbF9oYXNfZ3B1X3Jlc2V0KGk5MTUpKSB7CisJaWYgKCFpbnRlbF9oYXNf
Z3B1X3Jlc2V0KGd0LT5pOTE1KSkgewogCQlpZiAoaTkxNV9tb2RwYXJhbXMucmVzZXQpCi0JCQlk
ZXZfZXJyKGk5MTUtPmRybS5kZXYsICJHUFUgcmVzZXQgbm90IHN1cHBvcnRlZFxuIik7CisJCQlk
ZXZfZXJyKGd0LT5pOTE1LT5kcm0uZGV2LCAiR1BVIHJlc2V0IG5vdCBzdXBwb3J0ZWRcbiIpOwog
CQllbHNlCiAJCQlEUk1fREVCVUdfRFJJVkVSKCJHUFUgcmVzZXQgZGlzYWJsZWRcbiIpOwogCQln
b3RvIGVycm9yOwogCX0KIAotCWlmIChJTlRFTF9JTkZPKGk5MTUpLT5ncHVfcmVzZXRfY2xvYmJl
cnNfZGlzcGxheSkKLQkJaW50ZWxfcnVudGltZV9wbV9kaXNhYmxlX2ludGVycnVwdHMoaTkxNSk7
CisJaWYgKElOVEVMX0lORk8oZ3QtPmk5MTUpLT5ncHVfcmVzZXRfY2xvYmJlcnNfZGlzcGxheSkK
KwkJaW50ZWxfcnVudGltZV9wbV9kaXNhYmxlX2ludGVycnVwdHMoZ3QtPmk5MTUpOwogCi0JaWYg
KGRvX3Jlc2V0KGk5MTUsIHN0YWxsZWRfbWFzaykpIHsKLQkJZGV2X2VycihpOTE1LT5kcm0uZGV2
LCAiRmFpbGVkIHRvIHJlc2V0IGNoaXBcbiIpOworCWlmIChkb19yZXNldChndCwgc3RhbGxlZF9t
YXNrKSkgeworCQlkZXZfZXJyKGd0LT5pOTE1LT5kcm0uZGV2LCAiRmFpbGVkIHRvIHJlc2V0IGNo
aXBcbiIpOwogCQlnb3RvIHRhaW50OwogCX0KIAotCWlmIChJTlRFTF9JTkZPKGk5MTUpLT5ncHVf
cmVzZXRfY2xvYmJlcnNfZGlzcGxheSkKLQkJaW50ZWxfcnVudGltZV9wbV9lbmFibGVfaW50ZXJy
dXB0cyhpOTE1KTsKKwlpZiAoSU5URUxfSU5GTyhndC0+aTkxNSktPmdwdV9yZXNldF9jbG9iYmVy
c19kaXNwbGF5KQorCQlpbnRlbF9ydW50aW1lX3BtX2VuYWJsZV9pbnRlcnJ1cHRzKGd0LT5pOTE1
KTsKIAotCWludGVsX292ZXJsYXlfcmVzZXQoaTkxNSk7CisJaW50ZWxfb3ZlcmxheV9yZXNldChn
dC0+aTkxNSk7CiAKIAkvKgogCSAqIE5leHQgd2UgbmVlZCB0byByZXN0b3JlIHRoZSBjb250ZXh0
LCBidXQgd2UgZG9uJ3QgdXNlIHRob3NlCkBAIC0xMDQxLDIzICsxMDMxLDIzIEBAIHZvaWQgaTkx
NV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkgKiB3YXMgcnVubmluZyBh
dCB0aGUgdGltZSBvZiB0aGUgcmVzZXQgKGkuZS4gd2Ugd2VyZW4ndCBWVAogCSAqIHN3aXRjaGVk
IGF3YXkpLgogCSAqLwotCXJldCA9IGk5MTVfZ2VtX2luaXRfaHcoaTkxNSk7CisJcmV0ID0gaTkx
NV9nZW1faW5pdF9odyhndC0+aTkxNSk7CiAJaWYgKHJldCkgewogCQlEUk1fRVJST1IoIkZhaWxl
ZCB0byBpbml0aWFsaXNlIEhXIGZvbGxvd2luZyByZXNldCAoJWQpXG4iLAogCQkJICByZXQpOwog
CQlnb3RvIHRhaW50OwogCX0KIAotCXJldCA9IHJlc3VtZShpOTE1KTsKKwlyZXQgPSByZXN1bWUo
Z3QpOwogCWlmIChyZXQpCiAJCWdvdG8gdGFpbnQ7CiAKLQlpOTE1X3F1ZXVlX2hhbmdjaGVjayhp
OTE1KTsKKwlpbnRlbF9ndF9xdWV1ZV9oYW5nY2hlY2soZ3QpOwogCiBmaW5pc2g6Ci0JcmVzZXRf
ZmluaXNoKGk5MTUsIGF3YWtlKTsKKwlyZXNldF9maW5pc2goZ3QsIGF3YWtlKTsKIHVubG9jazoK
LQltdXRleF91bmxvY2soJmVycm9yLT53ZWRnZV9tdXRleCk7CisJbXV0ZXhfdW5sb2NrKCZndC0+
cmVzZXQubXV0ZXgpOwogCXJldHVybjsKIAogdGFpbnQ6CkBAIC0xMDc1LDE4ICsxMDY1LDE3IEBA
IHZvaWQgaTkxNV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkgKi8KIAlh
ZGRfdGFpbnRfZm9yX0NJKFRBSU5UX1dBUk4pOwogZXJyb3I6Ci0JX19pOTE1X2dlbV9zZXRfd2Vk
Z2VkKGk5MTUpOworCV9faW50ZWxfZ3Rfc2V0X3dlZGdlZChndCk7CiAJZ290byBmaW5pc2g7CiB9
CiAKLXN0YXRpYyBpbmxpbmUgaW50IGludGVsX2d0X3Jlc2V0X2VuZ2luZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKLQkJCQkJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQor
c3RhdGljIGlubGluZSBpbnQgaW50ZWxfZ3RfcmVzZXRfZW5naW5lKHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSkKIHsKLQlyZXR1cm4gaW50ZWxfZ3B1X3Jlc2V0KGk5MTUsIGVuZ2luZS0+
bWFzayk7CisJcmV0dXJuIGludGVsX2dwdV9yZXNldChlbmdpbmUtPmd0LCBlbmdpbmUtPm1hc2sp
OwogfQogCiAvKioKLSAqIGk5MTVfcmVzZXRfZW5naW5lIC0gcmVzZXQgR1BVIGVuZ2luZSB0byBy
ZWNvdmVyIGZyb20gYSBoYW5nCisgKiBpbnRlbF9lbmdpbmVfcmVzZXQgLSByZXNldCBHUFUgZW5n
aW5lIHRvIHJlY292ZXIgZnJvbSBhIGhhbmcKICAqIEBlbmdpbmU6IGVuZ2luZSB0byByZXNldAog
ICogQG1zZzogcmVhc29uIGZvciBHUFUgcmVzZXQ7IG9yIE5VTEwgZm9yIG5vIGRldl9ub3RpY2Uo
KQogICoKQEAgLTEwOTgsMTMgKzEwODcsMTMgQEAgc3RhdGljIGlubGluZSBpbnQgaW50ZWxfZ3Rf
cmVzZXRfZW5naW5lKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogICogIC0gcmVzZXQg
ZW5naW5lICh3aGljaCB3aWxsIGZvcmNlIHRoZSBlbmdpbmUgdG8gaWRsZSkKICAqICAtIHJlLWlu
aXQvY29uZmlndXJlIGVuZ2luZQogICovCi1pbnQgaTkxNV9yZXNldF9lbmdpbmUoc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lLCBjb25zdCBjaGFyICptc2cpCitpbnQgaW50ZWxfZW5naW5l
X3Jlc2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgY29uc3QgY2hhciAqbXNnKQog
ewotCXN0cnVjdCBpOTE1X2dwdV9lcnJvciAqZXJyb3IgPSAmZW5naW5lLT5pOTE1LT5ncHVfZXJy
b3I7CisJc3RydWN0IGludGVsX2d0ICpndCA9IGVuZ2luZS0+Z3Q7CiAJaW50IHJldDsKIAotCUdF
TV9UUkFDRSgiJXMgZmxhZ3M9JWx4XG4iLCBlbmdpbmUtPm5hbWUsIGVycm9yLT5mbGFncyk7Ci0J
R0VNX0JVR19PTighdGVzdF9iaXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBlbmdpbmUtPmlkLCAmZXJy
b3ItPmZsYWdzKSk7CisJR0VNX1RSQUNFKCIlcyBmbGFncz0lbHhcbiIsIGVuZ2luZS0+bmFtZSwg
Z3QtPnJlc2V0LmZsYWdzKTsKKwlHRU1fQlVHX09OKCF0ZXN0X2JpdChJOTE1X1JFU0VUX0VOR0lO
RSArIGVuZ2luZS0+aWQsICZndC0+cmVzZXQuZmxhZ3MpKTsKIAogCWlmICghaW50ZWxfZW5naW5l
X3BtX2dldF9pZl9hd2FrZShlbmdpbmUpKQogCQlyZXR1cm4gMDsKQEAgLTExMTQsMTAgKzExMDMs
MTAgQEAgaW50IGk5MTVfcmVzZXRfZW5naW5lKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSwgY29uc3QgY2hhciAqbXNnKQogCWlmIChtc2cpCiAJCWRldl9ub3RpY2UoZW5naW5lLT5pOTE1
LT5kcm0uZGV2LAogCQkJICAgIlJlc2V0dGluZyAlcyBmb3IgJXNcbiIsIGVuZ2luZS0+bmFtZSwg
bXNnKTsKLQllcnJvci0+cmVzZXRfZW5naW5lX2NvdW50W2VuZ2luZS0+aWRdKys7CisJYXRvbWlj
X2luYygmZW5naW5lLT5pOTE1LT5ncHVfZXJyb3IucmVzZXRfZW5naW5lX2NvdW50W2VuZ2luZS0+
dWFiaV9jbGFzc10pOwogCiAJaWYgKCFlbmdpbmUtPmk5MTUtPmd1Yy5leGVjYnVmX2NsaWVudCkK
LQkJcmV0ID0gaW50ZWxfZ3RfcmVzZXRfZW5naW5lKGVuZ2luZS0+aTkxNSwgZW5naW5lKTsKKwkJ
cmV0ID0gaW50ZWxfZ3RfcmVzZXRfZW5naW5lKGVuZ2luZSk7CiAJZWxzZQogCQlyZXQgPSBpbnRl
bF9ndWNfcmVzZXRfZW5naW5lKCZlbmdpbmUtPmk5MTUtPmd1YywgZW5naW5lKTsKIAlpZiAocmV0
KSB7CkBAIC0xMTMzLDcgKzExMjIsNyBAQCBpbnQgaTkxNV9yZXNldF9lbmdpbmUoc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lLCBjb25zdCBjaGFyICptc2cpCiAJICogYWN0aXZlIHJlcXVl
c3QgYW5kIGNhbiBkcm9wIGl0LCBhZGp1c3QgaGVhZCB0byBza2lwIHRoZSBvZmZlbmRpbmcKIAkg
KiByZXF1ZXN0IHRvIHJlc3VtZSBleGVjdXRpbmcgcmVtYWluaW5nIHJlcXVlc3RzIGluIHRoZSBx
dWV1ZS4KIAkgKi8KLQlpbnRlbF9lbmdpbmVfcmVzZXQoZW5naW5lLCB0cnVlKTsKKwlfX2ludGVs
X2VuZ2luZV9yZXNldChlbmdpbmUsIHRydWUpOwogCiAJLyoKIAkgKiBUaGUgZW5naW5lIGFuZCBp
dHMgcmVnaXN0ZXJzIChhbmQgd29ya2Fyb3VuZHMgaW4gY2FzZSBvZiByZW5kZXIpCkBAIC0xMTQ5
LDE2ICsxMTM4LDE1IEBAIGludCBpOTE1X3Jlc2V0X2VuZ2luZShzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUsIGNvbnN0IGNoYXIgKm1zZykKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMg
dm9pZCBpOTE1X3Jlc2V0X2RldmljZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKLQkJ
CSAgICAgIHUzMiBlbmdpbmVfbWFzaywKLQkJCSAgICAgIGNvbnN0IGNoYXIgKnJlYXNvbikKK3N0
YXRpYyB2b2lkIGludGVsX2d0X3Jlc2V0X2dsb2JhbChzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAorCQkJ
CSAgdTMyIGVuZ2luZV9tYXNrLAorCQkJCSAgY29uc3QgY2hhciAqcmVhc29uKQogewotCXN0cnVj
dCBpOTE1X2dwdV9lcnJvciAqZXJyb3IgPSAmaTkxNS0+Z3B1X2Vycm9yOwotCXN0cnVjdCBrb2Jq
ZWN0ICprb2JqID0gJmk5MTUtPmRybS5wcmltYXJ5LT5rZGV2LT5rb2JqOworCXN0cnVjdCBrb2Jq
ZWN0ICprb2JqID0gJmd0LT5pOTE1LT5kcm0ucHJpbWFyeS0+a2Rldi0+a29iajsKIAljaGFyICpl
cnJvcl9ldmVudFtdID0geyBJOTE1X0VSUk9SX1VFVkVOVCAiPTEiLCBOVUxMIH07CiAJY2hhciAq
cmVzZXRfZXZlbnRbXSA9IHsgSTkxNV9SRVNFVF9VRVZFTlQgIj0xIiwgTlVMTCB9OwogCWNoYXIg
KnJlc2V0X2RvbmVfZXZlbnRbXSA9IHsgSTkxNV9FUlJPUl9VRVZFTlQgIj0wIiwgTlVMTCB9Owot
CXN0cnVjdCBpOTE1X3dlZGdlX21lIHc7CisJc3RydWN0IGludGVsX3dlZGdlX21lIHc7CiAKIAlr
b2JqZWN0X3VldmVudF9lbnYoa29iaiwgS09CSl9DSEFOR0UsIGVycm9yX2V2ZW50KTsKIApAQCAt
MTE2NiwyNCArMTE1NCwyNCBAQCBzdGF0aWMgdm9pZCBpOTE1X3Jlc2V0X2RldmljZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAlrb2JqZWN0X3VldmVudF9lbnYoa29iaiwgS09CSl9D
SEFOR0UsIHJlc2V0X2V2ZW50KTsKIAogCS8qIFVzZSBhIHdhdGNoZG9nIHRvIGVuc3VyZSB0aGF0
IG91ciByZXNldCBjb21wbGV0ZXMgKi8KLQlpOTE1X3dlZGdlX29uX3RpbWVvdXQoJncsIGk5MTUs
IDUgKiBIWikgewotCQlpbnRlbF9wcmVwYXJlX3Jlc2V0KGk5MTUpOworCWludGVsX3dlZGdlX29u
X3RpbWVvdXQoJncsIGd0LCA1ICogSFopIHsKKwkJaW50ZWxfcHJlcGFyZV9yZXNldChndC0+aTkx
NSk7CiAKIAkJLyogRmx1c2ggZXZlcnlvbmUgdXNpbmcgYSByZXNvdXJjZSBhYm91dCB0byBiZSBj
bG9iYmVyZWQgKi8KLQkJc3luY2hyb25pemVfc3JjdV9leHBlZGl0ZWQoJmVycm9yLT5yZXNldF9i
YWNrb2ZmX3NyY3UpOworCQlzeW5jaHJvbml6ZV9zcmN1X2V4cGVkaXRlZCgmZ3QtPnJlc2V0LmJh
Y2tvZmZfc3JjdSk7CiAKLQkJaTkxNV9yZXNldChpOTE1LCBlbmdpbmVfbWFzaywgcmVhc29uKTsK
KwkJaW50ZWxfZ3RfcmVzZXQoZ3QsIGVuZ2luZV9tYXNrLCByZWFzb24pOwogCi0JCWludGVsX2Zp
bmlzaF9yZXNldChpOTE1KTsKKwkJaW50ZWxfZmluaXNoX3Jlc2V0KGd0LT5pOTE1KTsKIAl9CiAK
LQlpZiAoIXRlc3RfYml0KEk5MTVfV0VER0VELCAmZXJyb3ItPmZsYWdzKSkKKwlpZiAoIXRlc3Rf
Yml0KEk5MTVfV0VER0VELCAmZ3QtPnJlc2V0LmZsYWdzKSkKIAkJa29iamVjdF91ZXZlbnRfZW52
KGtvYmosIEtPQkpfQ0hBTkdFLCByZXNldF9kb25lX2V2ZW50KTsKIH0KIAogLyoqCi0gKiBpOTE1
X2hhbmRsZV9lcnJvciAtIGhhbmRsZSBhIGdwdSBlcnJvcgotICogQGk5MTU6IGk5MTUgZGV2aWNl
IHByaXZhdGUKKyAqIGludGVsX2d0X2hhbmRsZV9lcnJvciAtIGhhbmRsZSBhIGdwdSBlcnJvcgor
ICogQGd0OiB0aGUgaW50ZWxfZ3QKICAqIEBlbmdpbmVfbWFzazogbWFzayByZXByZXNlbnRpbmcg
ZW5naW5lcyB0aGF0IGFyZSBodW5nCiAgKiBAZmxhZ3M6IGNvbnRyb2wgZmxhZ3MKICAqIEBmbXQ6
IEVycm9yIG1lc3NhZ2UgZm9ybWF0IHN0cmluZwpAQCAtMTE5NCwxMiArMTE4MiwxMSBAQCBzdGF0
aWMgdm9pZCBpOTE1X3Jlc2V0X2RldmljZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
ICAqIHNvIHVzZXJzcGFjZSBrbm93cyBzb21ldGhpbmcgYmFkIGhhcHBlbmVkIChzaG91bGQgdHJp
Z2dlciBjb2xsZWN0aW9uCiAgKiBvZiBhIHJpbmcgZHVtcCBldGMuKS4KICAqLwotdm9pZCBpOTE1
X2hhbmRsZV9lcnJvcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKLQkJICAgICAgIGlu
dGVsX2VuZ2luZV9tYXNrX3QgZW5naW5lX21hc2ssCi0JCSAgICAgICB1bnNpZ25lZCBsb25nIGZs
YWdzLAotCQkgICAgICAgY29uc3QgY2hhciAqZm10LCAuLi4pCit2b2lkIGludGVsX2d0X2hhbmRs
ZV9lcnJvcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAorCQkJICAgaW50ZWxfZW5naW5lX21hc2tfdCBl
bmdpbmVfbWFzaywKKwkJCSAgIHVuc2lnbmVkIGxvbmcgZmxhZ3MsCisJCQkgICBjb25zdCBjaGFy
ICpmbXQsIC4uLikKIHsKLQlzdHJ1Y3QgaTkxNV9ncHVfZXJyb3IgKmVycm9yID0gJmk5MTUtPmdw
dV9lcnJvcjsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CiAJaW50ZWxfd2FrZXJl
Zl90IHdha2VyZWY7CiAJaW50ZWxfZW5naW5lX21hc2tfdCB0bXA7CkBAIC0xMjIzLDMzICsxMjEw
LDMxIEBAIHZvaWQgaTkxNV9oYW5kbGVfZXJyb3Ioc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCiAJICogaXNuJ3QgdGhlIGNhc2UgYXQgbGVhc3Qgd2hlbiB3ZSBnZXQgaGVyZSBieSBkb2lu
ZyBhCiAJICogc2ltdWxhdGVkIHJlc2V0IHZpYSBkZWJ1Z2ZzLCBzbyBnZXQgYW4gUlBNIHJlZmVy
ZW5jZS4KIAkgKi8KLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRp
bWVfcG0pOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmZ3QtPmk5MTUtPnJ1bnRp
bWVfcG0pOwogCi0JZW5naW5lX21hc2sgJj0gSU5URUxfSU5GTyhpOTE1KS0+ZW5naW5lX21hc2s7
CisJZW5naW5lX21hc2sgJj0gSU5URUxfSU5GTyhndC0+aTkxNSktPmVuZ2luZV9tYXNrOwogCiAJ
aWYgKGZsYWdzICYgSTkxNV9FUlJPUl9DQVBUVVJFKSB7Ci0JCWk5MTVfY2FwdHVyZV9lcnJvcl9z
dGF0ZShpOTE1LCBlbmdpbmVfbWFzaywgbXNnKTsKLQkJaW50ZWxfZ3RfY2xlYXJfZXJyb3JfcmVn
aXN0ZXJzKCZpOTE1LT5ndCwgZW5naW5lX21hc2spOworCQlpOTE1X2NhcHR1cmVfZXJyb3Jfc3Rh
dGUoZ3QtPmk5MTUsIGVuZ2luZV9tYXNrLCBtc2cpOworCQlpbnRlbF9ndF9jbGVhcl9lcnJvcl9y
ZWdpc3RlcnMoZ3QsIGVuZ2luZV9tYXNrKTsKIAl9CiAKIAkvKgogCSAqIFRyeSBlbmdpbmUgcmVz
ZXQgd2hlbiBhdmFpbGFibGUuIFdlIGZhbGwgYmFjayB0byBmdWxsIHJlc2V0IGlmCiAJICogc2lu
Z2xlIHJlc2V0IGZhaWxzLgogCSAqLwotCWlmIChpbnRlbF9oYXNfcmVzZXRfZW5naW5lKGk5MTUp
ICYmICFfX2k5MTVfd2VkZ2VkKGVycm9yKSkgewotCQlmb3JfZWFjaF9lbmdpbmVfbWFza2VkKGVu
Z2luZSwgaTkxNSwgZW5naW5lX21hc2ssIHRtcCkgeworCWlmIChpbnRlbF9oYXNfcmVzZXRfZW5n
aW5lKGd0LT5pOTE1KSAmJiAhaW50ZWxfZ3RfaXNfd2VkZ2VkKGd0KSkgeworCQlmb3JfZWFjaF9l
bmdpbmVfbWFza2VkKGVuZ2luZSwgZ3QtPmk5MTUsIGVuZ2luZV9tYXNrLCB0bXApIHsKIAkJCUJV
SUxEX0JVR19PTihJOTE1X1JFU0VUX01PREVTRVQgPj0gSTkxNV9SRVNFVF9FTkdJTkUpOwogCQkJ
aWYgKHRlc3RfYW5kX3NldF9iaXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBlbmdpbmUtPmlkLAotCQkJ
CQkgICAgICZlcnJvci0+ZmxhZ3MpKQorCQkJCQkgICAgICZndC0+cmVzZXQuZmxhZ3MpKQogCQkJ
CWNvbnRpbnVlOwogCi0JCQlpZiAoaTkxNV9yZXNldF9lbmdpbmUoZW5naW5lLCBtc2cpID09IDAp
CisJCQlpZiAoaW50ZWxfZW5naW5lX3Jlc2V0KGVuZ2luZSwgbXNnKSA9PSAwKQogCQkJCWVuZ2lu
ZV9tYXNrICY9IH5lbmdpbmUtPm1hc2s7CiAKLQkJCWNsZWFyX2JpdChJOTE1X1JFU0VUX0VOR0lO
RSArIGVuZ2luZS0+aWQsCi0JCQkJICAmZXJyb3ItPmZsYWdzKTsKLQkJCXdha2VfdXBfYml0KCZl
cnJvci0+ZmxhZ3MsCi0JCQkJICAgIEk5MTVfUkVTRVRfRU5HSU5FICsgZW5naW5lLT5pZCk7CisJ
CQljbGVhcl9hbmRfd2FrZV91cF9iaXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBlbmdpbmUtPmlkLAor
CQkJCQkgICAgICAmZ3QtPnJlc2V0LmZsYWdzKTsKIAkJfQogCX0KIApAQCAtMTI1Nyw5ICsxMjQy
LDkgQEAgdm9pZCBpOTE1X2hhbmRsZV9lcnJvcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKIAkJZ290byBvdXQ7CiAKIAkvKiBGdWxsIHJlc2V0IG5lZWRzIHRoZSBtdXRleCwgc3RvcCBh
bnkgb3RoZXIgdXNlciB0cnlpbmcgdG8gZG8gc28uICovCi0JaWYgKHRlc3RfYW5kX3NldF9iaXQo
STkxNV9SRVNFVF9CQUNLT0ZGLCAmZXJyb3ItPmZsYWdzKSkgewotCQl3YWl0X2V2ZW50KGVycm9y
LT5yZXNldF9xdWV1ZSwKLQkJCSAgICF0ZXN0X2JpdChJOTE1X1JFU0VUX0JBQ0tPRkYsICZlcnJv
ci0+ZmxhZ3MpKTsKKwlpZiAodGVzdF9hbmRfc2V0X2JpdChJOTE1X1JFU0VUX0JBQ0tPRkYsICZn
dC0+cmVzZXQuZmxhZ3MpKSB7CisJCXdhaXRfZXZlbnQoZ3QtPnJlc2V0LnF1ZXVlLAorCQkJICAg
IXRlc3RfYml0KEk5MTVfUkVTRVRfQkFDS09GRiwgJmd0LT5yZXNldC5mbGFncykpOwogCQlnb3Rv
IG91dDsgLyogcGlnZ3ktYmFjayBvbiB0aGUgb3RoZXIgcmVzZXQgKi8KIAl9CiAKQEAgLTEyNjcs
MTEzICsxMjUyLDExOSBAQCB2b2lkIGk5MTVfaGFuZGxlX2Vycm9yKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAogCXN5bmNocm9uaXplX3JjdV9leHBlZGl0ZWQoKTsKIAogCS8qIFByZXZl
bnQgYW55IG90aGVyIHJlc2V0LWVuZ2luZSBhdHRlbXB0LiAqLwotCWZvcl9lYWNoX2VuZ2luZShl
bmdpbmUsIGk5MTUsIHRtcCkgeworCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LT5pOTE1LCB0
bXApIHsKIAkJd2hpbGUgKHRlc3RfYW5kX3NldF9iaXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBlbmdp
bmUtPmlkLAotCQkJCQkmZXJyb3ItPmZsYWdzKSkKLQkJCXdhaXRfb25fYml0KCZlcnJvci0+Zmxh
Z3MsCisJCQkJCSZndC0+cmVzZXQuZmxhZ3MpKQorCQkJd2FpdF9vbl9iaXQoJmd0LT5yZXNldC5m
bGFncywKIAkJCQkgICAgSTkxNV9SRVNFVF9FTkdJTkUgKyBlbmdpbmUtPmlkLAogCQkJCSAgICBU
QVNLX1VOSU5URVJSVVBUSUJMRSk7CiAJfQogCi0JaTkxNV9yZXNldF9kZXZpY2UoaTkxNSwgZW5n
aW5lX21hc2ssIG1zZyk7CisJaW50ZWxfZ3RfcmVzZXRfZ2xvYmFsKGd0LCBlbmdpbmVfbWFzaywg
bXNnKTsKIAotCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIHRtcCkgewotCQljbGVhcl9i
aXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBlbmdpbmUtPmlkLAotCQkJICAmZXJyb3ItPmZsYWdzKTsK
LQl9Ci0KLQljbGVhcl9iaXQoSTkxNV9SRVNFVF9CQUNLT0ZGLCAmZXJyb3ItPmZsYWdzKTsKLQl3
YWtlX3VwX2FsbCgmZXJyb3ItPnJlc2V0X3F1ZXVlKTsKKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5l
LCBndC0+aTkxNSwgdG1wKQorCQljbGVhcl9iaXRfdW5sb2NrKEk5MTVfUkVTRVRfRU5HSU5FICsg
ZW5naW5lLT5pZCwKKwkJCQkgJmd0LT5yZXNldC5mbGFncyk7CisJY2xlYXJfYml0X3VubG9jayhJ
OTE1X1JFU0VUX0JBQ0tPRkYsICZndC0+cmVzZXQuZmxhZ3MpOworCXNtcF9tYl9fYWZ0ZXJfYXRv
bWljKCk7CisJd2FrZV91cF9hbGwoJmd0LT5yZXNldC5xdWV1ZSk7CiAKIG91dDoKLQlpbnRlbF9y
dW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CisJaW50ZWxfcnVudGlt
ZV9wbV9wdXQoJmd0LT5pOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIH0KIAotaW50IGk5MTVf
cmVzZXRfdHJ5bG9jayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKK2ludCBpbnRlbF9n
dF9yZXNldF90cnlsb2NrKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7Ci0Jc3RydWN0IGk5MTVfZ3B1
X2Vycm9yICplcnJvciA9ICZpOTE1LT5ncHVfZXJyb3I7CiAJaW50IHNyY3U7CiAKLQltaWdodF9s
b2NrKCZlcnJvci0+cmVzZXRfYmFja29mZl9zcmN1KTsKKwltaWdodF9sb2NrKCZndC0+cmVzZXQu
YmFja29mZl9zcmN1KTsKIAltaWdodF9zbGVlcCgpOwogCiAJcmN1X3JlYWRfbG9jaygpOwotCXdo
aWxlICh0ZXN0X2JpdChJOTE1X1JFU0VUX0JBQ0tPRkYsICZlcnJvci0+ZmxhZ3MpKSB7CisJd2hp
bGUgKHRlc3RfYml0KEk5MTVfUkVTRVRfQkFDS09GRiwgJmd0LT5yZXNldC5mbGFncykpIHsKIAkJ
cmN1X3JlYWRfdW5sb2NrKCk7CiAKLQkJaWYgKHdhaXRfZXZlbnRfaW50ZXJydXB0aWJsZShlcnJv
ci0+cmVzZXRfcXVldWUsCisJCWlmICh3YWl0X2V2ZW50X2ludGVycnVwdGlibGUoZ3QtPnJlc2V0
LnF1ZXVlLAogCQkJCQkgICAgICF0ZXN0X2JpdChJOTE1X1JFU0VUX0JBQ0tPRkYsCi0JCQkJCQkg
ICAgICAgJmVycm9yLT5mbGFncykpKQorCQkJCQkJICAgICAgICZndC0+cmVzZXQuZmxhZ3MpKSkK
IAkJCXJldHVybiAtRUlOVFI7CiAKIAkJcmN1X3JlYWRfbG9jaygpOwogCX0KLQlzcmN1ID0gc3Jj
dV9yZWFkX2xvY2soJmVycm9yLT5yZXNldF9iYWNrb2ZmX3NyY3UpOworCXNyY3UgPSBzcmN1X3Jl
YWRfbG9jaygmZ3QtPnJlc2V0LmJhY2tvZmZfc3JjdSk7CiAJcmN1X3JlYWRfdW5sb2NrKCk7CiAK
IAlyZXR1cm4gc3JjdTsKIH0KIAotdm9pZCBpOTE1X3Jlc2V0X3VubG9jayhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwgaW50IHRhZykKLV9fcmVsZWFzZXMoJmk5MTUtPmdwdV9lcnJvci5y
ZXNldF9iYWNrb2ZmX3NyY3UpCit2b2lkIGludGVsX2d0X3Jlc2V0X3VubG9jayhzdHJ1Y3QgaW50
ZWxfZ3QgKmd0LCBpbnQgdGFnKQorX19yZWxlYXNlcygmZ3QtPnJlc2V0LmJhY2tvZmZfc3JjdSkK
IHsKLQlzdHJ1Y3QgaTkxNV9ncHVfZXJyb3IgKmVycm9yID0gJmk5MTUtPmdwdV9lcnJvcjsKLQot
CXNyY3VfcmVhZF91bmxvY2soJmVycm9yLT5yZXNldF9iYWNrb2ZmX3NyY3UsIHRhZyk7CisJc3Jj
dV9yZWFkX3VubG9jaygmZ3QtPnJlc2V0LmJhY2tvZmZfc3JjdSwgdGFnKTsKIH0KIAotaW50IGk5
MTVfdGVybWluYWxseV93ZWRnZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCitpbnQg
aW50ZWxfZ3RfdGVybWluYWxseV93ZWRnZWQoc3RydWN0IGludGVsX2d0ICpndCkKIHsKLQlzdHJ1
Y3QgaTkxNV9ncHVfZXJyb3IgKmVycm9yID0gJmk5MTUtPmdwdV9lcnJvcjsKLQogCW1pZ2h0X3Ns
ZWVwKCk7CiAKLQlpZiAoIV9faTkxNV93ZWRnZWQoZXJyb3IpKQorCWlmICghaW50ZWxfZ3RfaXNf
d2VkZ2VkKGd0KSkKIAkJcmV0dXJuIDA7CiAKIAkvKiBSZXNldCBzdGlsbCBpbiBwcm9ncmVzcz8g
TWF5YmUgd2Ugd2lsbCByZWNvdmVyPyAqLwotCWlmICghdGVzdF9iaXQoSTkxNV9SRVNFVF9CQUNL
T0ZGLCAmZXJyb3ItPmZsYWdzKSkKKwlpZiAoIXRlc3RfYml0KEk5MTVfUkVTRVRfQkFDS09GRiwg
Jmd0LT5yZXNldC5mbGFncykpCiAJCXJldHVybiAtRUlPOwogCiAJLyogWFhYIGludGVsX3Jlc2V0
X2ZpbmlzaCgpIHN0aWxsIHRha2VzIHN0cnVjdF9tdXRleCEhISAqLwotCWlmIChtdXRleF9pc19s
b2NrZWQoJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpKQorCWlmIChtdXRleF9pc19sb2NrZWQoJmd0
LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KSkKIAkJcmV0dXJuIC1FQUdBSU47CiAKLQlpZiAod2Fp
dF9ldmVudF9pbnRlcnJ1cHRpYmxlKGVycm9yLT5yZXNldF9xdWV1ZSwKKwlpZiAod2FpdF9ldmVu
dF9pbnRlcnJ1cHRpYmxlKGd0LT5yZXNldC5xdWV1ZSwKIAkJCQkgICAgICF0ZXN0X2JpdChJOTE1
X1JFU0VUX0JBQ0tPRkYsCi0JCQkJCSAgICAgICAmZXJyb3ItPmZsYWdzKSkpCisJCQkJCSAgICAg
ICAmZ3QtPnJlc2V0LmZsYWdzKSkpCiAJCXJldHVybiAtRUlOVFI7CiAKLQlyZXR1cm4gX19pOTE1
X3dlZGdlZChlcnJvcikgPyAtRUlPIDogMDsKKwlyZXR1cm4gaW50ZWxfZ3RfaXNfd2VkZ2VkKGd0
KSA/IC1FSU8gOiAwOworfQorCit2b2lkIGludGVsX2d0X2luaXRfcmVzZXQoc3RydWN0IGludGVs
X2d0ICpndCkKK3sKKwlpbml0X3dhaXRxdWV1ZV9oZWFkKCZndC0+cmVzZXQucXVldWUpOworCW11
dGV4X2luaXQoJmd0LT5yZXNldC5tdXRleCk7CisJaW5pdF9zcmN1X3N0cnVjdCgmZ3QtPnJlc2V0
LmJhY2tvZmZfc3JjdSk7Cit9CisKK3ZvaWQgaW50ZWxfZ3RfZmluaV9yZXNldChzdHJ1Y3QgaW50
ZWxfZ3QgKmd0KQoreworCWNsZWFudXBfc3JjdV9zdHJ1Y3QoJmd0LT5yZXNldC5iYWNrb2ZmX3Ny
Y3UpOwogfQogCi1zdGF0aWMgdm9pZCBpOTE1X3dlZGdlX21lKHN0cnVjdCB3b3JrX3N0cnVjdCAq
d29yaykKK3N0YXRpYyB2b2lkIGludGVsX3dlZGdlX21lKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29y
aykKIHsKLQlzdHJ1Y3QgaTkxNV93ZWRnZV9tZSAqdyA9IGNvbnRhaW5lcl9vZih3b3JrLCB0eXBl
b2YoKncpLCB3b3JrLndvcmspOworCXN0cnVjdCBpbnRlbF93ZWRnZV9tZSAqdyA9IGNvbnRhaW5l
cl9vZih3b3JrLCB0eXBlb2YoKncpLCB3b3JrLndvcmspOwogCi0JZGV2X2Vycih3LT5pOTE1LT5k
cm0uZGV2LAorCWRldl9lcnIody0+Z3QtPmk5MTUtPmRybS5kZXYsCiAJCSIlcyB0aW1lZCBvdXQs
IGNhbmNlbGxpbmcgYWxsIGluLWZsaWdodCByZW5kZXJpbmcuXG4iLAogCQl3LT5uYW1lKTsKLQlp
OTE1X2dlbV9zZXRfd2VkZ2VkKHctPmk5MTUpOworCWludGVsX2d0X3NldF93ZWRnZWQody0+Z3Qp
OwogfQogCi12b2lkIF9faTkxNV9pbml0X3dlZGdlKHN0cnVjdCBpOTE1X3dlZGdlX21lICp3LAot
CQkgICAgICAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCi0JCSAgICAgICBsb25nIHRp
bWVvdXQsCi0JCSAgICAgICBjb25zdCBjaGFyICpuYW1lKQordm9pZCBfX2ludGVsX2luaXRfd2Vk
Z2Uoc3RydWN0IGludGVsX3dlZGdlX21lICp3LAorCQkJc3RydWN0IGludGVsX2d0ICpndCwKKwkJ
CWxvbmcgdGltZW91dCwKKwkJCWNvbnN0IGNoYXIgKm5hbWUpCiB7Ci0Jdy0+aTkxNSA9IGk5MTU7
CisJdy0+Z3QgPSBndDsKIAl3LT5uYW1lID0gbmFtZTsKIAotCUlOSVRfREVMQVlFRF9XT1JLX09O
U1RBQ0soJnctPndvcmssIGk5MTVfd2VkZ2VfbWUpOworCUlOSVRfREVMQVlFRF9XT1JLX09OU1RB
Q0soJnctPndvcmssIGludGVsX3dlZGdlX21lKTsKIAlzY2hlZHVsZV9kZWxheWVkX3dvcmsoJnct
PndvcmssIHRpbWVvdXQpOwogfQogCi12b2lkIF9faTkxNV9maW5pX3dlZGdlKHN0cnVjdCBpOTE1
X3dlZGdlX21lICp3KQordm9pZCBfX2ludGVsX2Zpbmlfd2VkZ2Uoc3RydWN0IGludGVsX3dlZGdl
X21lICp3KQogewogCWNhbmNlbF9kZWxheWVkX3dvcmtfc3luYygmdy0+d29yayk7CiAJZGVzdHJv
eV9kZWxheWVkX3dvcmtfb25fc3RhY2soJnctPndvcmspOwotCXctPmk5MTUgPSBOVUxMOworCXct
Pmd0ID0gTlVMTDsKIH0KIAogI2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X1NFTEZURVNU
KQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuaCBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmgKaW5kZXggMDNmYmEwYWIzODY4Li42
MmY2Y2I1MjBmOTYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jl
c2V0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuaApAQCAtMTEs
NTYgKzExLDY3IEBACiAjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KICNpbmNsdWRlIDxsaW51eC9z
cmN1Lmg+CiAKLSNpbmNsdWRlICJndC9pbnRlbF9lbmdpbmVfdHlwZXMuaCIKKyNpbmNsdWRlICJp
bnRlbF9lbmdpbmVfdHlwZXMuaCIKKyNpbmNsdWRlICJpbnRlbF9yZXNldF90eXBlcy5oIgogCiBz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKIHN0cnVjdCBpOTE1X3JlcXVlc3Q7CiBzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzOworc3RydWN0IGludGVsX2d0Owogc3RydWN0IGludGVsX2d1YzsKIAordm9p
ZCBpbnRlbF9ndF9pbml0X3Jlc2V0KHN0cnVjdCBpbnRlbF9ndCAqZ3QpOwordm9pZCBpbnRlbF9n
dF9maW5pX3Jlc2V0KHN0cnVjdCBpbnRlbF9ndCAqZ3QpOworCiBfX3ByaW50Zig0LCA1KQotdm9p
ZCBpOTE1X2hhbmRsZV9lcnJvcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKLQkJICAg
ICAgIGludGVsX2VuZ2luZV9tYXNrX3QgZW5naW5lX21hc2ssCi0JCSAgICAgICB1bnNpZ25lZCBs
b25nIGZsYWdzLAotCQkgICAgICAgY29uc3QgY2hhciAqZm10LCAuLi4pOwordm9pZCBpbnRlbF9n
dF9oYW5kbGVfZXJyb3Ioc3RydWN0IGludGVsX2d0ICpndCwKKwkJCSAgIGludGVsX2VuZ2luZV9t
YXNrX3QgZW5naW5lX21hc2ssCisJCQkgICB1bnNpZ25lZCBsb25nIGZsYWdzLAorCQkJICAgY29u
c3QgY2hhciAqZm10LCAuLi4pOwogI2RlZmluZSBJOTE1X0VSUk9SX0NBUFRVUkUgQklUKDApCiAK
LXZvaWQgaTkxNV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKLQkJaW50ZWxf
ZW5naW5lX21hc2tfdCBzdGFsbGVkX21hc2ssCi0JCWNvbnN0IGNoYXIgKnJlYXNvbik7Ci1pbnQg
aTkxNV9yZXNldF9lbmdpbmUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAotCQkgICAg
ICBjb25zdCBjaGFyICpyZWFzb24pOwotCi12b2lkIGk5MTVfcmVzZXRfcmVxdWVzdChzdHJ1Y3Qg
aTkxNV9yZXF1ZXN0ICpycSwgYm9vbCBndWlsdHkpOwordm9pZCBpbnRlbF9ndF9yZXNldChzdHJ1
Y3QgaW50ZWxfZ3QgKmd0LAorCQkgICAgaW50ZWxfZW5naW5lX21hc2tfdCBzdGFsbGVkX21hc2ss
CisJCSAgICBjb25zdCBjaGFyICpyZWFzb24pOworaW50IGludGVsX2VuZ2luZV9yZXNldChzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCisJCSAgICAgICBjb25zdCBjaGFyICpyZWFzb24p
OwogCi1pbnQgX19tdXN0X2NoZWNrIGk5MTVfcmVzZXRfdHJ5bG9jayhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSk7Ci12b2lkIGk5MTVfcmVzZXRfdW5sb2NrKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LCBpbnQgdGFnKTsKK3ZvaWQgX19pOTE1X3JlcXVlc3RfcmVzZXQoc3RydWN0
IGk5MTVfcmVxdWVzdCAqcnEsIGJvb2wgZ3VpbHR5KTsKIAotaW50IGk5MTVfdGVybWluYWxseV93
ZWRnZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOworaW50IF9fbXVzdF9jaGVjayBp
bnRlbF9ndF9yZXNldF90cnlsb2NrKHN0cnVjdCBpbnRlbF9ndCAqZ3QpOwordm9pZCBpbnRlbF9n
dF9yZXNldF91bmxvY2soc3RydWN0IGludGVsX2d0ICpndCwgaW50IHRhZyk7CiAKLWJvb2wgaW50
ZWxfaGFzX2dwdV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Ci1ib29sIGlu
dGVsX2hhc19yZXNldF9lbmdpbmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwordm9p
ZCBpbnRlbF9ndF9zZXRfd2VkZ2VkKHN0cnVjdCBpbnRlbF9ndCAqZ3QpOworYm9vbCBpbnRlbF9n
dF91bnNldF93ZWRnZWQoc3RydWN0IGludGVsX2d0ICpndCk7CitpbnQgaW50ZWxfZ3RfdGVybWlu
YWxseV93ZWRnZWQoc3RydWN0IGludGVsX2d0ICpndCk7CiAKLWludCBpbnRlbF9ncHVfcmVzZXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCi0JCSAgICBpbnRlbF9lbmdpbmVfbWFza190
IGVuZ2luZV9tYXNrKTsKK2ludCBpbnRlbF9ncHVfcmVzZXQoc3RydWN0IGludGVsX2d0ICpndCwg
aW50ZWxfZW5naW5lX21hc2tfdCBlbmdpbmVfbWFzayk7CiAKLWludCBpbnRlbF9yZXNldF9ndWMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOworaW50IGludGVsX3Jlc2V0X2d1YyhzdHJ1
Y3QgaW50ZWxfZ3QgKmd0KTsKIAotc3RydWN0IGk5MTVfd2VkZ2VfbWUgeworc3RydWN0IGludGVs
X3dlZGdlX21lIHsKIAlzdHJ1Y3QgZGVsYXllZF93b3JrIHdvcms7Ci0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTU7CisJc3RydWN0IGludGVsX2d0ICpndDsKIAljb25zdCBjaGFyICpuYW1l
OwogfTsKIAotdm9pZCBfX2k5MTVfaW5pdF93ZWRnZShzdHJ1Y3QgaTkxNV93ZWRnZV9tZSAqdywK
LQkJICAgICAgIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAotCQkgICAgICAgbG9uZyB0
aW1lb3V0LAotCQkgICAgICAgY29uc3QgY2hhciAqbmFtZSk7Ci12b2lkIF9faTkxNV9maW5pX3dl
ZGdlKHN0cnVjdCBpOTE1X3dlZGdlX21lICp3KTsKK3ZvaWQgX19pbnRlbF9pbml0X3dlZGdlKHN0
cnVjdCBpbnRlbF93ZWRnZV9tZSAqdywKKwkJCXN0cnVjdCBpbnRlbF9ndCAqZ3QsCisJCQlsb25n
IHRpbWVvdXQsCisJCQljb25zdCBjaGFyICpuYW1lKTsKK3ZvaWQgX19pbnRlbF9maW5pX3dlZGdl
KHN0cnVjdCBpbnRlbF93ZWRnZV9tZSAqdyk7CiAKLSNkZWZpbmUgaTkxNV93ZWRnZV9vbl90aW1l
b3V0KFcsIERFViwgVElNRU9VVCkJCQkJXAotCWZvciAoX19pOTE1X2luaXRfd2VkZ2UoKFcpLCAo
REVWKSwgKFRJTUVPVVQpLCBfX2Z1bmNfXyk7CVwKLQkgICAgIChXKS0+aTkxNTsJCQkJCQkJXAot
CSAgICAgX19pOTE1X2Zpbmlfd2VkZ2UoKFcpKSkKKyNkZWZpbmUgaW50ZWxfd2VkZ2Vfb25fdGlt
ZW91dChXLCBHVCwgVElNRU9VVCkJCQkJXAorCWZvciAoX19pbnRlbF9pbml0X3dlZGdlKChXKSwg
KEdUKSwgKFRJTUVPVVQpLCBfX2Z1bmNfXyk7CVwKKwkgICAgIChXKS0+Z3Q7CQkJCQkJCVwKKwkg
ICAgIF9faW50ZWxfZmluaV93ZWRnZSgoVykpKQorCitzdGF0aWMgaW5saW5lIGJvb2wgX19pbnRl
bF9yZXNldF9mYWlsZWQoY29uc3Qgc3RydWN0IGludGVsX3Jlc2V0ICpyZXNldCkKK3sKKwlyZXR1
cm4gdW5saWtlbHkodGVzdF9iaXQoSTkxNV9XRURHRUQsICZyZXNldC0+ZmxhZ3MpKTsKK30KKwor
Ym9vbCBpbnRlbF9oYXNfZ3B1X3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsK
K2Jvb2wgaW50ZWxfaGFzX3Jlc2V0X2VuZ2luZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSk7CiAKICNlbmRpZiAvKiBJOTE1X1JFU0VUX0ggKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0X3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9yZXNldF90eXBlcy5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAw
MDAwMC4uMzE5NjgzNTZlMGMwCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfcmVzZXRfdHlwZXMuaApAQCAtMCwwICsxLDUwIEBACisvKiBTUERYLUxpY2Vu
c2UtSWRlbnRpZmllcjogTUlUICovCisvKgorICogQ29weXJpZ2h0IMKpIDIwMTkgSW50ZWwgQ29y
cG9yYXRpb24KKyAqLworCisjaWZuZGVmIF9fSU5URUxfUkVTRVRfVFlQRVNfSF8KKyNkZWZpbmUg
X19JTlRFTF9SRVNFVF9UWVBFU19IXworCisjaW5jbHVkZSA8bGludXgvbXV0ZXguaD4KKyNpbmNs
dWRlIDxsaW51eC93YWl0Lmg+CisjaW5jbHVkZSA8bGludXgvc3JjdS5oPgorCitzdHJ1Y3QgaW50
ZWxfcmVzZXQgeworCS8qKgorCSAqIGZsYWdzOiBDb250cm9sIHZhcmlvdXMgc3RhZ2VzIG9mIHRo
ZSBHUFUgcmVzZXQKKwkgKgorCSAqICNJOTE1X1JFU0VUX0JBQ0tPRkYgLSBXaGVuIHdlIHN0YXJ0
IGEgZ2xvYmFsIHJlc2V0LCB3ZSBuZWVkIHRvCisJICogc2VyaWFsaXNlIHdpdGggYW55IG90aGVy
IHVzZXJzIGF0dGVtcHRpbmcgdG8gZG8gdGhlIHNhbWUsIGFuZAorCSAqIGFueSBnbG9iYWwgcmVz
b3VyY2VzIHRoYXQgbWF5IGJlIGNsb2JiZXIgYnkgdGhlIHJlc2V0IChzdWNoIGFzCisJICogRkVO
Q0UgcmVnaXN0ZXJzKS4KKwkgKgorCSAqICNJOTE1X1JFU0VUX0VOR0lORVtudW1fZW5naW5lc10g
LSBTaW5jZSB0aGUgZHJpdmVyIGRvZXNuJ3QgbmVlZCB0bworCSAqIGFjcXVpcmUgdGhlIHN0cnVj
dF9tdXRleCB0byByZXNldCBhbiBlbmdpbmUsIHdlIG5lZWQgYW4gZXhwbGljaXQKKwkgKiBmbGFn
IHRvIHByZXZlbnQgdHdvIGNvbmN1cnJlbnQgcmVzZXQgYXR0ZW1wdHMgaW4gdGhlIHNhbWUgZW5n
aW5lLgorCSAqIEFzIHRoZSBudW1iZXIgb2YgZW5naW5lcyBjb250aW51ZXMgdG8gZ3JvdywgYWxs
b2NhdGUgdGhlIGZsYWdzIGZyb20KKwkgKiB0aGUgbW9zdCBzaWduaWZpY2FudCBiaXRzLgorCSAq
CisJICogI0k5MTVfV0VER0VEIC0gSWYgcmVzZXQgZmFpbHMgYW5kIHdlIGNhbiBubyBsb25nZXIg
dXNlIHRoZSBHUFUsCisJICogd2Ugc2V0IHRoZSAjSTkxNV9XRURHRUQgYml0LiBQcmlvciB0byBj
b21tYW5kIHN1Ym1pc3Npb24sIGUuZy4KKwkgKiBpOTE1X3JlcXVlc3RfYWxsb2MoKSwgdGhpcyBi
aXQgaXMgY2hlY2tlZCBhbmQgdGhlIHNlcXVlbmNlCisJICogYWJvcnRlZCAod2l0aCAtRUlPIHJl
cG9ydGVkIHRvIHVzZXJzcGFjZSkgaWYgc2V0LgorCSAqLworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7
CisjZGVmaW5lIEk5MTVfUkVTRVRfQkFDS09GRgkwCisjZGVmaW5lIEk5MTVfUkVTRVRfTU9ERVNF
VAkxCisjZGVmaW5lIEk5MTVfUkVTRVRfRU5HSU5FCTIKKyNkZWZpbmUgSTkxNV9XRURHRUQJCShC
SVRTX1BFUl9MT05HIC0gMSkKKworCXN0cnVjdCBtdXRleCBtdXRleDsgLyogc2VyaWFsaXNlcyB3
ZWRnaW5nL3Vud2VkZ2luZyAqLworCisJLyoqCisJICogV2FpdHF1ZXVlIHRvIHNpZ25hbCB3aGVu
IHRoZSByZXNldCBoYXMgY29tcGxldGVkLiBVc2VkIGJ5IGNsaWVudHMKKwkgKiB0aGF0IHdhaXQg
Zm9yIGRldl9wcml2LT5tbS53ZWRnZWQgdG8gc2V0dGxlLgorCSAqLworCXdhaXRfcXVldWVfaGVh
ZF90IHF1ZXVlOworCisJc3RydWN0IHNyY3Vfc3RydWN0IGJhY2tvZmZfc3JjdTsKK307CisKKyNl
bmRpZiAvKiBfSU5URUxfUkVTRVRfVFlQRVNfSF8gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX3JpbmdidWZmZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX3JpbmdidWZmZXIuYwppbmRleCBjNDZjZTY3NmQyOGYuLjdjZjQyYjQ3NzIyNyAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JpbmdidWZmZXIuYwpAQCAtNzg4LDcgKzc4
OCw3IEBAIHN0YXRpYyB2b2lkIHJlc2V0X3Jpbmcoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lLCBib29sIHN0YWxsZWQpCiAJCSAqIElmIHRoZSByZXF1ZXN0IHdhcyBpbm5vY2VudCwgd2Ug
dHJ5IHRvIHJlcGxheSB0aGUgcmVxdWVzdAogCQkgKiB3aXRoIHRoZSByZXN0b3JlZCBjb250ZXh0
LgogCQkgKi8KLQkJaTkxNV9yZXNldF9yZXF1ZXN0KHJxLCBzdGFsbGVkKTsKKwkJX19pOTE1X3Jl
cXVlc3RfcmVzZXQocnEsIHN0YWxsZWQpOwogCiAJCUdFTV9CVUdfT04ocnEtPnJpbmcgIT0gZW5n
aW5lLT5idWZmZXIpOwogCQloZWFkID0gcnEtPmhlYWQ7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hlY2suYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jCmluZGV4IDJkOWNjM2NkMWYyNy4uOGNhYWQxOTY4M2Ex
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hlY2su
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hlY2suYwpAQCAt
MzIsNyArMzIsNiBAQAogI2luY2x1ZGUgInNlbGZ0ZXN0cy9pOTE1X3JhbmRvbS5oIgogI2luY2x1
ZGUgInNlbGZ0ZXN0cy9pZ3RfZmx1c2hfdGVzdC5oIgogI2luY2x1ZGUgInNlbGZ0ZXN0cy9pZ3Rf
cmVzZXQuaCIKLSNpbmNsdWRlICJzZWxmdGVzdHMvaWd0X3dlZGdlX21lLmgiCiAjaW5jbHVkZSAi
c2VsZnRlc3RzL2lndF9hdG9taWMuaCIKIAogI2luY2x1ZGUgInNlbGZ0ZXN0cy9tb2NrX2RybS5o
IgpAQCAtMzE2LDcgKzMxNSw3IEBAIHN0YXRpYyBpbnQgaWd0X2hhbmdfc2FuaXR5Y2hlY2sodm9p
ZCAqYXJnKQogCQlnb3RvIHVubG9jazsKIAogCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUs
IGlkKSB7Ci0JCXN0cnVjdCBpZ3Rfd2VkZ2VfbWUgdzsKKwkJc3RydWN0IGludGVsX3dlZGdlX21l
IHc7CiAJCWxvbmcgdGltZW91dDsKIAogCQlpZiAoIWludGVsX2VuZ2luZV9jYW5fc3RvcmVfZHdv
cmQoZW5naW5lKSkKQEAgLTMzOCwxMCArMzM3LDEwIEBAIHN0YXRpYyBpbnQgaWd0X2hhbmdfc2Fu
aXR5Y2hlY2sodm9pZCAqYXJnKQogCQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKIAogCQl0aW1lb3V0
ID0gMDsKLQkJaWd0X3dlZGdlX29uX3RpbWVvdXQoJncsIGk5MTUsIEhaIC8gMTAgLyogMTAwbXMg
dGltZW91dCovKQorCQlpbnRlbF93ZWRnZV9vbl90aW1lb3V0KCZ3LCAmaTkxNS0+Z3QsIEhaIC8g
MTAgLyogMTAwbXMgKi8pCiAJCQl0aW1lb3V0ID0gaTkxNV9yZXF1ZXN0X3dhaXQocnEsIDAsCiAJ
CQkJCQkgICAgTUFYX1NDSEVEVUxFX1RJTUVPVVQpOwotCQlpZiAoaTkxNV9yZXNldF9mYWlsZWQo
aTkxNSkpCisJCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoJmk5MTUtPmd0KSkKIAkJCXRpbWVvdXQg
PSAtRUlPOwogCiAJCWk5MTVfcmVxdWVzdF9wdXQocnEpOwpAQCAtNDEzLDEyICs0MTIsMTIgQEAg
c3RhdGljIGludCBpZ3RfcmVzZXRfbm9wKHZvaWQgKmFyZykKIAkJCX0KIAkJfQogCi0JCWlndF9n
bG9iYWxfcmVzZXRfbG9jayhpOTE1KTsKLQkJaTkxNV9yZXNldChpOTE1LCBBTExfRU5HSU5FUywg
TlVMTCk7Ci0JCWlndF9nbG9iYWxfcmVzZXRfdW5sb2NrKGk5MTUpOworCQlpZ3RfZ2xvYmFsX3Jl
c2V0X2xvY2soJmk5MTUtPmd0KTsKKwkJaW50ZWxfZ3RfcmVzZXQoJmk5MTUtPmd0LCBBTExfRU5H
SU5FUywgTlVMTCk7CisJCWlndF9nbG9iYWxfcmVzZXRfdW5sb2NrKCZpOTE1LT5ndCk7CiAKIAkJ
bXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQkJaWYgKGk5MTVfcmVzZXRf
ZmFpbGVkKGk5MTUpKSB7CisJCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoJmk5MTUtPmd0KSkgewog
CQkJZXJyID0gLUVJTzsKIAkJCWJyZWFrOwogCQl9CkBAIC00NDIsNyArNDQxLDcgQEAgc3RhdGlj
IGludCBpZ3RfcmVzZXRfbm9wKHZvaWQgKmFyZykKIAogb3V0OgogCW1vY2tfZmlsZV9mcmVlKGk5
MTUsIGZpbGUpOwotCWlmIChpOTE1X3Jlc2V0X2ZhaWxlZChpOTE1KSkKKwlpZiAoaW50ZWxfZ3Rf
aXNfd2VkZ2VkKCZpOTE1LT5ndCkpCiAJCWVyciA9IC1FSU87CiAJcmV0dXJuIGVycjsKIH0KQEAg
LTQ4NCw3ICs0ODMsNyBAQCBzdGF0aWMgaW50IGlndF9yZXNldF9ub3BfZW5naW5lKHZvaWQgKmFy
ZykKIAkJCQkJCQkgICAgIGVuZ2luZSk7CiAJCWNvdW50ID0gMDsKIAotCQlzZXRfYml0KEk5MTVf
UkVTRVRfRU5HSU5FICsgaWQsICZpOTE1LT5ncHVfZXJyb3IuZmxhZ3MpOworCQlzZXRfYml0KEk5
MTVfUkVTRVRfRU5HSU5FICsgaWQsICZpOTE1LT5ndC5yZXNldC5mbGFncyk7CiAJCWRvIHsKIAkJ
CWludCBpOwogCkBAIC01MDcsNyArNTA2LDcgQEAgc3RhdGljIGludCBpZ3RfcmVzZXRfbm9wX2Vu
Z2luZSh2b2lkICphcmcpCiAKIAkJCQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKIAkJCX0KLQkJCWVy
ciA9IGk5MTVfcmVzZXRfZW5naW5lKGVuZ2luZSwgTlVMTCk7CisJCQllcnIgPSBpbnRlbF9lbmdp
bmVfcmVzZXQoZW5naW5lLCBOVUxMKTsKIAkJCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVj
dF9tdXRleCk7CiAJCQlpZiAoZXJyKSB7CiAJCQkJcHJfZXJyKCJpOTE1X3Jlc2V0X2VuZ2luZSBm
YWlsZWRcbiIpOwpAQCAtNTI4LDcgKzUyNyw3IEBAIHN0YXRpYyBpbnQgaWd0X3Jlc2V0X25vcF9l
bmdpbmUodm9pZCAqYXJnKQogCQkJCWJyZWFrOwogCQkJfQogCQl9IHdoaWxlICh0aW1lX2JlZm9y
ZShqaWZmaWVzLCBlbmRfdGltZSkpOwotCQljbGVhcl9iaXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBp
ZCwgJmk5MTUtPmdwdV9lcnJvci5mbGFncyk7CisJCWNsZWFyX2JpdChJOTE1X1JFU0VUX0VOR0lO
RSArIGlkLCAmaTkxNS0+Z3QucmVzZXQuZmxhZ3MpOwogCQlwcl9pbmZvKCIlcyglcyk6ICVkIHJl
c2V0c1xuIiwgX19mdW5jX18sIGVuZ2luZS0+bmFtZSwgY291bnQpOwogCiAJCWlmIChlcnIpCkBA
IC01NDUsNyArNTQ0LDcgQEAgc3RhdGljIGludCBpZ3RfcmVzZXRfbm9wX2VuZ2luZSh2b2lkICph
cmcpCiAKIG91dDoKIAltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKLQlpZiAoaTkxNV9yZXNl
dF9mYWlsZWQoaTkxNSkpCisJaWYgKGludGVsX2d0X2lzX3dlZGdlZCgmaTkxNS0+Z3QpKQogCQll
cnIgPSAtRUlPOwogCXJldHVybiBlcnI7CiB9CkBAIC01ODksNyArNTg4LDcgQEAgc3RhdGljIGlu
dCBfX2lndF9yZXNldF9lbmdpbmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGJvb2wg
YWN0aXZlKQogCQkJCQkJCSAgICAgZW5naW5lKTsKIAogCQlpbnRlbF9lbmdpbmVfcG1fZ2V0KGVu
Z2luZSk7Ci0JCXNldF9iaXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBpZCwgJmk5MTUtPmdwdV9lcnJv
ci5mbGFncyk7CisJCXNldF9iaXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBpZCwgJmk5MTUtPmd0LnJl
c2V0LmZsYWdzKTsKIAkJZG8gewogCQkJaWYgKGFjdGl2ZSkgewogCQkJCXN0cnVjdCBpOTE1X3Jl
cXVlc3QgKnJxOwpAQCAtNjIyLDcgKzYyMSw3IEBAIHN0YXRpYyBpbnQgX19pZ3RfcmVzZXRfZW5n
aW5lKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBib29sIGFjdGl2ZSkKIAkJCQlpOTE1
X3JlcXVlc3RfcHV0KHJxKTsKIAkJCX0KIAotCQkJZXJyID0gaTkxNV9yZXNldF9lbmdpbmUoZW5n
aW5lLCBOVUxMKTsKKwkJCWVyciA9IGludGVsX2VuZ2luZV9yZXNldChlbmdpbmUsIE5VTEwpOwog
CQkJaWYgKGVycikgewogCQkJCXByX2VycigiaTkxNV9yZXNldF9lbmdpbmUgZmFpbGVkXG4iKTsK
IAkJCQlicmVhazsKQEAgLTY0Miw3ICs2NDEsNyBAQCBzdGF0aWMgaW50IF9faWd0X3Jlc2V0X2Vu
Z2luZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgYm9vbCBhY3RpdmUpCiAJCQkJYnJl
YWs7CiAJCQl9CiAJCX0gd2hpbGUgKHRpbWVfYmVmb3JlKGppZmZpZXMsIGVuZF90aW1lKSk7Ci0J
CWNsZWFyX2JpdChJOTE1X1JFU0VUX0VOR0lORSArIGlkLCAmaTkxNS0+Z3B1X2Vycm9yLmZsYWdz
KTsKKwkJY2xlYXJfYml0KEk5MTVfUkVTRVRfRU5HSU5FICsgaWQsICZpOTE1LT5ndC5yZXNldC5m
bGFncyk7CiAJCWludGVsX2VuZ2luZV9wbV9wdXQoZW5naW5lKTsKIAogCQlpZiAoZXJyKQpAQCAt
NjUzLDcgKzY1Miw3IEBAIHN0YXRpYyBpbnQgX19pZ3RfcmVzZXRfZW5naW5lKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LCBib29sIGFjdGl2ZSkKIAkJCWJyZWFrOwogCX0KIAotCWlmIChp
OTE1X3Jlc2V0X2ZhaWxlZChpOTE1KSkKKwlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKCZpOTE1LT5n
dCkpCiAJCWVyciA9IC1FSU87CiAKIAlpZiAoYWN0aXZlKSB7CkBAIC03MDEsNyArNzAwLDcgQEAg
c3RhdGljIGludCBhY3RpdmVfcmVxdWVzdF9wdXQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJ
CQkgIHJxLT5mZW5jZS5zZXFubyk7CiAJCUdFTV9UUkFDRV9EVU1QKCk7CiAKLQkJaTkxNV9nZW1f
c2V0X3dlZGdlZChycS0+aTkxNSk7CisJCWludGVsX2d0X3NldF93ZWRnZWQocnEtPmVuZ2luZS0+
Z3QpOwogCQllcnIgPSAtRUlPOwogCX0KIApAQCAtODUxLDcgKzg1MCw3IEBAIHN0YXRpYyBpbnQg
X19pZ3RfcmVzZXRfZW5naW5lcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJfQog
CiAJCWludGVsX2VuZ2luZV9wbV9nZXQoZW5naW5lKTsKLQkJc2V0X2JpdChJOTE1X1JFU0VUX0VO
R0lORSArIGlkLCAmaTkxNS0+Z3B1X2Vycm9yLmZsYWdzKTsKKwkJc2V0X2JpdChJOTE1X1JFU0VU
X0VOR0lORSArIGlkLCAmaTkxNS0+Z3QucmVzZXQuZmxhZ3MpOwogCQlkbyB7CiAJCQlzdHJ1Y3Qg
aTkxNV9yZXF1ZXN0ICpycSA9IE5VTEw7CiAKQEAgLTg4Miw3ICs4ODEsNyBAQCBzdGF0aWMgaW50
IF9faWd0X3Jlc2V0X2VuZ2luZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCQkJ
fQogCQkJfQogCi0JCQllcnIgPSBpOTE1X3Jlc2V0X2VuZ2luZShlbmdpbmUsIE5VTEwpOworCQkJ
ZXJyID0gaW50ZWxfZW5naW5lX3Jlc2V0KGVuZ2luZSwgTlVMTCk7CiAJCQlpZiAoZXJyKSB7CiAJ
CQkJcHJfZXJyKCJpOTE1X3Jlc2V0X2VuZ2luZSglczolcyk6IGZhaWxlZCwgZXJyPSVkXG4iLAog
CQkJCSAgICAgICBlbmdpbmUtPm5hbWUsIHRlc3RfbmFtZSwgZXJyKTsKQEAgLTkwNCw3ICs5MDMs
NyBAQCBzdGF0aWMgaW50IF9faWd0X3Jlc2V0X2VuZ2luZXMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCiAJCQkJCWk5MTVfcmVxdWVzdF9wdXQocnEpOwogCiAJCQkJCUdFTV9UUkFDRV9E
VU1QKCk7Ci0JCQkJCWk5MTVfZ2VtX3NldF93ZWRnZWQoaTkxNSk7CisJCQkJCWludGVsX2d0X3Nl
dF93ZWRnZWQoJmk5MTUtPmd0KTsKIAkJCQkJZXJyID0gLUVJTzsKIAkJCQkJYnJlYWs7CiAJCQkJ
fQpAQCAtOTI2LDcgKzkyNSw3IEBAIHN0YXRpYyBpbnQgX19pZ3RfcmVzZXRfZW5naW5lcyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJCQlicmVhazsKIAkJCX0KIAkJfSB3aGlsZSAo
dGltZV9iZWZvcmUoamlmZmllcywgZW5kX3RpbWUpKTsKLQkJY2xlYXJfYml0KEk5MTVfUkVTRVRf
RU5HSU5FICsgaWQsICZpOTE1LT5ncHVfZXJyb3IuZmxhZ3MpOworCQljbGVhcl9iaXQoSTkxNV9S
RVNFVF9FTkdJTkUgKyBpZCwgJmk5MTUtPmd0LnJlc2V0LmZsYWdzKTsKIAkJaW50ZWxfZW5naW5l
X3BtX3B1dChlbmdpbmUpOwogCQlwcl9pbmZvKCJpOTE1X3Jlc2V0X2VuZ2luZSglczolcyk6ICVs
dSByZXNldHNcbiIsCiAJCQllbmdpbmUtPm5hbWUsIHRlc3RfbmFtZSwgY291bnQpOwpAQCAtOTU2
LDcgKzk1NSw3IEBAIHN0YXRpYyBpbnQgX19pZ3RfcmVzZXRfZW5naW5lcyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKIAkJCX0KIAkJCXB1dF90YXNrX3N0cnVjdCh0aHJlYWRzW3RtcF0u
dGFzayk7CiAKLQkJCWlmIChvdGhlciAhPSBlbmdpbmUgJiYKKwkJCWlmIChvdGhlci0+dWFiaV9j
bGFzcyAhPSBlbmdpbmUtPnVhYmlfY2xhc3MgJiYKIAkJCSAgICB0aHJlYWRzW3RtcF0ucmVzZXRz
ICE9CiAJCQkgICAgaTkxNV9yZXNldF9lbmdpbmVfY291bnQoJmk5MTUtPmdwdV9lcnJvciwgb3Ro
ZXIpKSB7CiAJCQkJcHJfZXJyKCJJbm5vY2VudCBlbmdpbmUgJXMgd2FzIHJlc2V0IChjb3VudD0l
bGQpXG4iLApAQCAtOTg2LDcgKzk4NSw3IEBAIHN0YXRpYyBpbnQgX19pZ3RfcmVzZXRfZW5naW5l
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJCWJyZWFrOwogCX0KIAotCWlmIChp
OTE1X3Jlc2V0X2ZhaWxlZChpOTE1KSkKKwlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKCZpOTE1LT5n
dCkpCiAJCWVyciA9IC1FSU87CiAKIAlpZiAoZmxhZ3MgJiBURVNUX0FDVElWRSkgewpAQCAtMTA0
MSw3ICsxMDQwLDcgQEAgc3RhdGljIHUzMiBmYWtlX2hhbmdjaGVjayhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKIHsKIAl1MzIgY291bnQgPSBpOTE1X3Jlc2V0X2NvdW50KCZpOTE1LT5n
cHVfZXJyb3IpOwogCi0JaTkxNV9yZXNldChpOTE1LCBtYXNrLCBOVUxMKTsKKwlpbnRlbF9ndF9y
ZXNldCgmaTkxNS0+Z3QsIG1hc2ssIE5VTEwpOwogCiAJcmV0dXJuIGNvdW50OwogfQpAQCAtMTA2
MCw3ICsxMDU5LDcgQEAgc3RhdGljIGludCBpZ3RfcmVzZXRfd2FpdCh2b2lkICphcmcpCiAKIAkv
KiBDaGVjayB0aGF0IHdlIGRldGVjdCBhIHN0dWNrIHdhaXRlciBhbmQgaXNzdWUgYSByZXNldCAq
LwogCi0JaWd0X2dsb2JhbF9yZXNldF9sb2NrKGk5MTUpOworCWlndF9nbG9iYWxfcmVzZXRfbG9j
aygmaTkxNS0+Z3QpOwogCiAJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJ
ZXJyID0gaGFuZ19pbml0KCZoLCBpOTE1KTsKQEAgLTEwODMsNyArMTA4Miw3IEBAIHN0YXRpYyBp
bnQgaWd0X3Jlc2V0X3dhaXQodm9pZCAqYXJnKQogCQkgICAgICAgX19mdW5jX18sIHJxLT5mZW5j
ZS5zZXFubywgaHdzX3NlcW5vKCZoLCBycSkpOwogCQlpbnRlbF9lbmdpbmVfZHVtcChycS0+ZW5n
aW5lLCAmcCwgIiVzXG4iLCBycS0+ZW5naW5lLT5uYW1lKTsKIAotCQlpOTE1X2dlbV9zZXRfd2Vk
Z2VkKGk5MTUpOworCQlpbnRlbF9ndF9zZXRfd2VkZ2VkKCZpOTE1LT5ndCk7CiAKIAkJZXJyID0g
LUVJTzsKIAkJZ290byBvdXRfcnE7CkBAIC0xMTExLDkgKzExMTAsOSBAQCBzdGF0aWMgaW50IGln
dF9yZXNldF93YWl0KHZvaWQgKmFyZykKIAloYW5nX2ZpbmkoJmgpOwogdW5sb2NrOgogCW11dGV4
X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0JaWd0X2dsb2JhbF9yZXNldF91bmxv
Y2soaTkxNSk7CisJaWd0X2dsb2JhbF9yZXNldF91bmxvY2soJmk5MTUtPmd0KTsKIAotCWlmIChp
OTE1X3Jlc2V0X2ZhaWxlZChpOTE1KSkKKwlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKCZpOTE1LT5n
dCkpCiAJCXJldHVybiAtRUlPOwogCiAJcmV0dXJuIGVycjsKQEAgLTEyNjEsNyArMTI2MCw3IEBA
IHN0YXRpYyBpbnQgX19pZ3RfcmVzZXRfZXZpY3Rfdm1hKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAogCQkgICAgICAgX19mdW5jX18sIHJxLT5mZW5jZS5zZXFubywgaHdzX3NlcW5vKCZo
LCBycSkpOwogCQlpbnRlbF9lbmdpbmVfZHVtcChycS0+ZW5naW5lLCAmcCwgIiVzXG4iLCBycS0+
ZW5naW5lLT5uYW1lKTsKIAotCQlpOTE1X2dlbV9zZXRfd2VkZ2VkKGk5MTUpOworCQlpbnRlbF9n
dF9zZXRfd2VkZ2VkKCZpOTE1LT5ndCk7CiAJCWdvdG8gb3V0X3Jlc2V0OwogCX0KIApAQCAtMTI4
MywyMCArMTI4MiwyMCBAQCBzdGF0aWMgaW50IF9faWd0X3Jlc2V0X2V2aWN0X3ZtYShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJcHJfZXJyKCJpZ3QvZXZpY3Rfdm1hIGt0aHJlYWQg
ZGlkIG5vdCB3YWl0XG4iKTsKIAkJaW50ZWxfZW5naW5lX2R1bXAocnEtPmVuZ2luZSwgJnAsICIl
c1xuIiwgcnEtPmVuZ2luZS0+bmFtZSk7CiAKLQkJaTkxNV9nZW1fc2V0X3dlZGdlZChpOTE1KTsK
KwkJaW50ZWxfZ3Rfc2V0X3dlZGdlZCgmaTkxNS0+Z3QpOwogCQlnb3RvIG91dF9yZXNldDsKIAl9
CiAKIG91dF9yZXNldDoKLQlpZ3RfZ2xvYmFsX3Jlc2V0X2xvY2soaTkxNSk7CisJaWd0X2dsb2Jh
bF9yZXNldF9sb2NrKCZpOTE1LT5ndCk7CiAJZmFrZV9oYW5nY2hlY2socnEtPmk5MTUsIHJxLT5l
bmdpbmUtPm1hc2spOwotCWlndF9nbG9iYWxfcmVzZXRfdW5sb2NrKGk5MTUpOworCWlndF9nbG9i
YWxfcmVzZXRfdW5sb2NrKCZpOTE1LT5ndCk7CiAKIAlpZiAodHNrKSB7Ci0JCXN0cnVjdCBpZ3Rf
d2VkZ2VfbWUgdzsKKwkJc3RydWN0IGludGVsX3dlZGdlX21lIHc7CiAKIAkJLyogVGhlIHJlc2V0
LCBldmVuIGluZGlyZWN0bHksIHNob3VsZCB0YWtlIGxlc3MgdGhhbiAxMG1zLiAqLwotCQlpZ3Rf
d2VkZ2Vfb25fdGltZW91dCgmdywgaTkxNSwgSFogLyAxMCAvKiAxMDBtcyB0aW1lb3V0Ki8pCisJ
CWludGVsX3dlZGdlX29uX3RpbWVvdXQoJncsICZpOTE1LT5ndCwgSFogLyAxMCAvKiAxMDBtcyAq
LykKIAkJCWVyciA9IGt0aHJlYWRfc3RvcCh0c2spOwogCiAJCXB1dF90YXNrX3N0cnVjdCh0c2sp
OwpAQCAtMTMxMiw3ICsxMzExLDcgQEAgc3RhdGljIGludCBfX2lndF9yZXNldF9ldmljdF92bWEo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiB1bmxvY2s6CiAJbXV0ZXhfdW5sb2NrKCZp
OTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAotCWlmIChpOTE1X3Jlc2V0X2ZhaWxlZChpOTE1KSkK
KwlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKCZpOTE1LT5ndCkpCiAJCXJldHVybiAtRUlPOwogCiAJ
cmV0dXJuIGVycjsKQEAgLTEzOTAsNyArMTM4OSw3IEBAIHN0YXRpYyBpbnQgaWd0X3Jlc2V0X3F1
ZXVlKHZvaWQgKmFyZykKIAogCS8qIENoZWNrIHRoYXQgd2UgcmVwbGF5IHBlbmRpbmcgcmVxdWVz
dHMgZm9sbG93aW5nIGEgaGFuZyAqLwogCi0JaWd0X2dsb2JhbF9yZXNldF9sb2NrKGk5MTUpOwor
CWlndF9nbG9iYWxfcmVzZXRfbG9jaygmaTkxNS0+Z3QpOwogCiAJbXV0ZXhfbG9jaygmaTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7CiAJZXJyID0gaGFuZ19pbml0KCZoLCBpOTE1KTsKQEAgLTE0NDYs
NyArMTQ0NSw3IEBAIHN0YXRpYyBpbnQgaWd0X3Jlc2V0X3F1ZXVlKHZvaWQgKmFyZykKIAkJCQlp
OTE1X3JlcXVlc3RfcHV0KHByZXYpOwogCiAJCQkJR0VNX1RSQUNFX0RVTVAoKTsKLQkJCQlpOTE1
X2dlbV9zZXRfd2VkZ2VkKGk5MTUpOworCQkJCWludGVsX2d0X3NldF93ZWRnZWQoJmk5MTUtPmd0
KTsKIAkJCQlnb3RvIGZpbmk7CiAJCQl9CiAKQEAgLTE0NjIsNyArMTQ2MSw3IEBAIHN0YXRpYyBp
bnQgaWd0X3Jlc2V0X3F1ZXVlKHZvaWQgKmFyZykKIAkJCQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsK
IAkJCQlpOTE1X3JlcXVlc3RfcHV0KHByZXYpOwogCi0JCQkJaTkxNV9nZW1fc2V0X3dlZGdlZChp
OTE1KTsKKwkJCQlpbnRlbF9ndF9zZXRfd2VkZ2VkKCZpOTE1LT5ndCk7CiAKIAkJCQllcnIgPSAt
RUlPOwogCQkJCWdvdG8gZmluaTsKQEAgLTE1MTYsOSArMTUxNSw5IEBAIHN0YXRpYyBpbnQgaWd0
X3Jlc2V0X3F1ZXVlKHZvaWQgKmFyZykKIAloYW5nX2ZpbmkoJmgpOwogdW5sb2NrOgogCW11dGV4
X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0JaWd0X2dsb2JhbF9yZXNldF91bmxv
Y2soaTkxNSk7CisJaWd0X2dsb2JhbF9yZXNldF91bmxvY2soJmk5MTUtPmd0KTsKIAotCWlmIChp
OTE1X3Jlc2V0X2ZhaWxlZChpOTE1KSkKKwlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKCZpOTE1LT5n
dCkpCiAJCXJldHVybiAtRUlPOwogCiAJcmV0dXJuIGVycjsKQEAgLTE1NjMsNyArMTU2Miw3IEBA
IHN0YXRpYyBpbnQgaWd0X2hhbmRsZV9lcnJvcih2b2lkICphcmcpCiAJCSAgICAgICBfX2Z1bmNf
XywgcnEtPmZlbmNlLnNlcW5vLCBod3Nfc2Vxbm8oJmgsIHJxKSk7CiAJCWludGVsX2VuZ2luZV9k
dW1wKHJxLT5lbmdpbmUsICZwLCAiJXNcbiIsIHJxLT5lbmdpbmUtPm5hbWUpOwogCi0JCWk5MTVf
Z2VtX3NldF93ZWRnZWQoaTkxNSk7CisJCWludGVsX2d0X3NldF93ZWRnZWQoJmk5MTUtPmd0KTsK
IAogCQllcnIgPSAtRUlPOwogCQlnb3RvIGVycl9yZXF1ZXN0OwpAQCAtMTU3NCw3ICsxNTczLDcg
QEAgc3RhdGljIGludCBpZ3RfaGFuZGxlX2Vycm9yKHZvaWQgKmFyZykKIAkvKiBUZW1wb3Jhcmls
eSBkaXNhYmxlIGVycm9yIGNhcHR1cmUgKi8KIAllcnJvciA9IHhjaGcoJmk5MTUtPmdwdV9lcnJv
ci5maXJzdF9lcnJvciwgKHZvaWQgKiktMSk7CiAKLQlpOTE1X2hhbmRsZV9lcnJvcihpOTE1LCBl
bmdpbmUtPm1hc2ssIDAsIE5VTEwpOworCWludGVsX2d0X2hhbmRsZV9lcnJvcigmaTkxNS0+Z3Qs
IGVuZ2luZS0+bWFzaywgMCwgTlVMTCk7CiAKIAl4Y2hnKCZpOTE1LT5ncHVfZXJyb3IuZmlyc3Rf
ZXJyb3IsIGVycm9yKTsKIApAQCAtMTYwOCw3ICsxNjA3LDcgQEAgc3RhdGljIGludCBfX2lndF9h
dG9taWNfcmVzZXRfZW5naW5lKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAl0YXNr
bGV0X2Rpc2FibGVfbm9zeW5jKHQpOwogCXAtPmNyaXRpY2FsX3NlY3Rpb25fYmVnaW4oKTsKIAot
CWVyciA9IGk5MTVfcmVzZXRfZW5naW5lKGVuZ2luZSwgTlVMTCk7CisJZXJyID0gaW50ZWxfZW5n
aW5lX3Jlc2V0KGVuZ2luZSwgTlVMTCk7CiAKIAlwLT5jcml0aWNhbF9zZWN0aW9uX2VuZCgpOwog
CXRhc2tsZXRfZW5hYmxlKHQpOwpAQCAtMTY1MSwxNiArMTY1MCwxNiBAQCBzdGF0aWMgaW50IGln
dF9hdG9taWNfcmVzZXRfZW5naW5lKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAkJ
cHJfZXJyKCIlcyglcyk6IEZhaWxlZCB0byBzdGFydCByZXF1ZXN0ICVsbHgsIGF0ICV4XG4iLAog
CQkgICAgICAgX19mdW5jX18sIGVuZ2luZS0+bmFtZSwKIAkJICAgICAgIHJxLT5mZW5jZS5zZXFu
bywgaHdzX3NlcW5vKCZoLCBycSkpOwotCQlpOTE1X2dlbV9zZXRfd2VkZ2VkKGk5MTUpOworCQlp
bnRlbF9ndF9zZXRfd2VkZ2VkKCZpOTE1LT5ndCk7CiAJCWVyciA9IC1FSU87CiAJfQogCiAJaWYg
KGVyciA9PSAwKSB7Ci0JCXN0cnVjdCBpZ3Rfd2VkZ2VfbWUgdzsKKwkJc3RydWN0IGludGVsX3dl
ZGdlX21lIHc7CiAKLQkJaWd0X3dlZGdlX29uX3RpbWVvdXQoJncsIGk5MTUsIEhaIC8gMjAgLyog
NTBtcyB0aW1lb3V0Ki8pCisJCWludGVsX3dlZGdlX29uX3RpbWVvdXQoJncsICZpOTE1LT5ndCwg
SFogLyAyMCAvKiA1MG1zIHRpbWVvdXQqLykKIAkJCWk5MTVfcmVxdWVzdF93YWl0KHJxLCAwLCBN
QVhfU0NIRURVTEVfVElNRU9VVCk7Ci0JCWlmIChpOTE1X3Jlc2V0X2ZhaWxlZChpOTE1KSkKKwkJ
aWYgKGludGVsX2d0X2lzX3dlZGdlZCgmaTkxNS0+Z3QpKQogCQkJZXJyID0gLUVJTzsKIAl9CiAK
QEAgLTE2ODQsMTEgKzE2ODMsMTEgQEAgc3RhdGljIGludCBpZ3RfcmVzZXRfZW5naW5lc19hdG9t
aWModm9pZCAqYXJnKQogCWlmIChVU0VTX0dVQ19TVUJNSVNTSU9OKGk5MTUpKQogCQlyZXR1cm4g
MDsKIAotCWlndF9nbG9iYWxfcmVzZXRfbG9jayhpOTE1KTsKKwlpZ3RfZ2xvYmFsX3Jlc2V0X2xv
Y2soJmk5MTUtPmd0KTsKIAltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAog
CS8qIEZsdXNoIGFueSByZXF1ZXN0cyBiZWZvcmUgd2UgZ2V0IHN0YXJ0ZWQgYW5kIGNoZWNrIGJh
c2ljcyAqLwotCWlmICghaWd0X2ZvcmNlX3Jlc2V0KGk5MTUpKQorCWlmICghaWd0X2ZvcmNlX3Jl
c2V0KCZpOTE1LT5ndCkpCiAJCWdvdG8gdW5sb2NrOwogCiAJZm9yIChwID0gaWd0X2F0b21pY19w
aGFzZXM7IHAtPm5hbWU7IHArKykgewpAQCAtMTcwNCwxMSArMTcwMywxMSBAQCBzdGF0aWMgaW50
IGlndF9yZXNldF9lbmdpbmVzX2F0b21pYyh2b2lkICphcmcpCiAKIG91dDoKIAkvKiBBcyB3ZSBw
b2tlIGFyb3VuZCB0aGUgZ3V0cywgZG8gYSBmdWxsIHJlc2V0IGJlZm9yZSBjb250aW51aW5nLiAq
LwotCWlndF9mb3JjZV9yZXNldChpOTE1KTsKKwlpZ3RfZm9yY2VfcmVzZXQoJmk5MTUtPmd0KTsK
IAogdW5sb2NrOgogCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0JaWd0
X2dsb2JhbF9yZXNldF91bmxvY2soaTkxNSk7CisJaWd0X2dsb2JhbF9yZXNldF91bmxvY2soJmk5
MTUtPmd0KTsKIAogCXJldHVybiBlcnI7CiB9CkBAIC0xNzM3LDEyICsxNzM2LDEyIEBAIGludCBp
bnRlbF9oYW5nY2hlY2tfbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCiAJaWYgKCFpbnRlbF9oYXNfZ3B1X3Jlc2V0KGk5MTUpKQogCQlyZXR1cm4gMDsKIAotCWlm
IChpOTE1X3Rlcm1pbmFsbHlfd2VkZ2VkKGk5MTUpKQorCWlmIChpbnRlbF9ndF9pc193ZWRnZWQo
Jmk5MTUtPmd0KSkKIAkJcmV0dXJuIC1FSU87IC8qIHdlJ3JlIGxvbmcgcGFzdCBob3BlIG9mIGEg
c3VjY2Vzc2Z1bCByZXNldCAqLwogCiAJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZp
OTE1LT5ydW50aW1lX3BtKTsKIAlzYXZlZF9oYW5nY2hlY2sgPSBmZXRjaF9hbmRfemVybygmaTkx
NV9tb2RwYXJhbXMuZW5hYmxlX2hhbmdjaGVjayk7Ci0JZHJhaW5fZGVsYXllZF93b3JrKCZpOTE1
LT5ncHVfZXJyb3IuaGFuZ2NoZWNrX3dvcmspOyAvKiBmbHVzaCBwYXJhbSAqLworCWRyYWluX2Rl
bGF5ZWRfd29yaygmaTkxNS0+Z3QuaGFuZ2NoZWNrLndvcmspOyAvKiBmbHVzaCBwYXJhbSAqLwog
CiAJZXJyID0gaTkxNV9saXZlX3N1YnRlc3RzKHRlc3RzLCBpOTE1KTsKIApkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9zZWxmdGVzdF9scmMuYwppbmRleCAxMWY0OTA1MDJjYTYuLjcyMGFhMTNkZDJmMCAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKQEAgLTU1LDcgKzU1LDcgQEAg
c3RhdGljIGludCBsaXZlX3Nhbml0eWNoZWNrKHZvaWQgKmFyZykKIAkJaWYgKCFpZ3Rfd2FpdF9m
b3Jfc3Bpbm5lcigmc3BpbiwgcnEpKSB7CiAJCQlHRU1fVFJBQ0UoInNwaW5uZXIgZmFpbGVkIHRv
IHN0YXJ0XG4iKTsKIAkJCUdFTV9UUkFDRV9EVU1QKCk7Ci0JCQlpOTE1X2dlbV9zZXRfd2VkZ2Vk
KGk5MTUpOworCQkJaW50ZWxfZ3Rfc2V0X3dlZGdlZCgmaTkxNS0+Z3QpOwogCQkJZXJyID0gLUVJ
TzsKIAkJCWdvdG8gZXJyX2N0eDsKIAkJfQpAQCAtMjExLDcgKzIxMSw3IEBAIHNsaWNlX3NlbWFw
aG9yZV9xdWV1ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpvdXRlciwKIAkJcHJfZXJyKCJGYWls
ZWQgdG8gc2xpY2UgYWxvbmcgc2VtYXBob3JlIGNoYWluIG9mIGxlbmd0aCAoJWQsICVkKSFcbiIs
CiAJCSAgICAgICBjb3VudCwgbik7CiAJCUdFTV9UUkFDRV9EVU1QKCk7Ci0JCWk5MTVfZ2VtX3Nl
dF93ZWRnZWQob3V0ZXItPmk5MTUpOworCQlpbnRlbF9ndF9zZXRfd2VkZ2VkKG91dGVyLT5ndCk7
CiAJCWVyciA9IC1FSU87CiAJfQogCkBAIC00NDUsNyArNDQ1LDcgQEAgc3RhdGljIGludCBsaXZl
X2J1c3l3YWl0X3ByZWVtcHQodm9pZCAqYXJnKQogCQkJaW50ZWxfZW5naW5lX2R1bXAoZW5naW5l
LCAmcCwgIiVzXG4iLCBlbmdpbmUtPm5hbWUpOwogCQkJR0VNX1RSQUNFX0RVTVAoKTsKIAotCQkJ
aTkxNV9nZW1fc2V0X3dlZGdlZChpOTE1KTsKKwkJCWludGVsX2d0X3NldF93ZWRnZWQoJmk5MTUt
Pmd0KTsKIAkJCWVyciA9IC1FSU87CiAJCQlnb3RvIGVycl92bWE7CiAJCX0KQEAgLTUzNCw3ICs1
MzQsNyBAQCBzdGF0aWMgaW50IGxpdmVfcHJlZW1wdCh2b2lkICphcmcpCiAJCWlmICghaWd0X3dh
aXRfZm9yX3NwaW5uZXIoJnNwaW5fbG8sIHJxKSkgewogCQkJR0VNX1RSQUNFKCJsbyBzcGlubmVy
IGZhaWxlZCB0byBzdGFydFxuIik7CiAJCQlHRU1fVFJBQ0VfRFVNUCgpOwotCQkJaTkxNV9nZW1f
c2V0X3dlZGdlZChpOTE1KTsKKwkJCWludGVsX2d0X3NldF93ZWRnZWQoJmk5MTUtPmd0KTsKIAkJ
CWVyciA9IC1FSU87CiAJCQlnb3RvIGVycl9jdHhfbG87CiAJCX0KQEAgLTU1MSw3ICs1NTEsNyBA
QCBzdGF0aWMgaW50IGxpdmVfcHJlZW1wdCh2b2lkICphcmcpCiAJCWlmICghaWd0X3dhaXRfZm9y
X3NwaW5uZXIoJnNwaW5faGksIHJxKSkgewogCQkJR0VNX1RSQUNFKCJoaSBzcGlubmVyIGZhaWxl
ZCB0byBzdGFydFxuIik7CiAJCQlHRU1fVFJBQ0VfRFVNUCgpOwotCQkJaTkxNV9nZW1fc2V0X3dl
ZGdlZChpOTE1KTsKKwkJCWludGVsX2d0X3NldF93ZWRnZWQoJmk5MTUtPmd0KTsKIAkJCWVyciA9
IC1FSU87CiAJCQlnb3RvIGVycl9jdHhfbG87CiAJCX0KQEAgLTY4OCw3ICs2ODgsNyBAQCBzdGF0
aWMgaW50IGxpdmVfbGF0ZV9wcmVlbXB0KHZvaWQgKmFyZykKIGVycl93ZWRnZWQ6CiAJaWd0X3Nw
aW5uZXJfZW5kKCZzcGluX2hpKTsKIAlpZ3Rfc3Bpbm5lcl9lbmQoJnNwaW5fbG8pOwotCWk5MTVf
Z2VtX3NldF93ZWRnZWQoaTkxNSk7CisJaW50ZWxfZ3Rfc2V0X3dlZGdlZCgmaTkxNS0+Z3QpOwog
CWVyciA9IC1FSU87CiAJZ290byBlcnJfY3R4X2xvOwogfQpAQCAtODI2LDcgKzgyNiw3IEBAIHN0
YXRpYyBpbnQgbGl2ZV9zdXBwcmVzc19zZWxmX3ByZWVtcHQodm9pZCAqYXJnKQogZXJyX3dlZGdl
ZDoKIAlpZ3Rfc3Bpbm5lcl9lbmQoJmIuc3Bpbik7CiAJaWd0X3NwaW5uZXJfZW5kKCZhLnNwaW4p
OwotCWk5MTVfZ2VtX3NldF93ZWRnZWQoaTkxNSk7CisJaW50ZWxfZ3Rfc2V0X3dlZGdlZCgmaTkx
NS0+Z3QpOwogCWVyciA9IC1FSU87CiAJZ290byBlcnJfY2xpZW50X2I7CiB9CkBAIC05OTMsNyAr
OTkzLDcgQEAgc3RhdGljIGludCBsaXZlX3N1cHByZXNzX3dhaXRfcHJlZW1wdCh2b2lkICphcmcp
CiBlcnJfd2VkZ2VkOgogCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGNsaWVudCk7IGkrKykK
IAkJaWd0X3NwaW5uZXJfZW5kKCZjbGllbnRbaV0uc3Bpbik7Ci0JaTkxNV9nZW1fc2V0X3dlZGdl
ZChpOTE1KTsKKwlpbnRlbF9ndF9zZXRfd2VkZ2VkKCZpOTE1LT5ndCk7CiAJZXJyID0gLUVJTzsK
IAlnb3RvIGVycl9jbGllbnRfMzsKIH0KQEAgLTExMzksNyArMTEzOSw3IEBAIHN0YXRpYyBpbnQg
bGl2ZV9jaGFpbl9wcmVlbXB0KHZvaWQgKmFyZykKIGVycl93ZWRnZWQ6CiAJaWd0X3NwaW5uZXJf
ZW5kKCZoaS5zcGluKTsKIAlpZ3Rfc3Bpbm5lcl9lbmQoJmxvLnNwaW4pOwotCWk5MTVfZ2VtX3Nl
dF93ZWRnZWQoaTkxNSk7CisJaW50ZWxfZ3Rfc2V0X3dlZGdlZCgmaTkxNS0+Z3QpOwogCWVyciA9
IC1FSU87CiAJZ290byBlcnJfY2xpZW50X2xvOwogfQpAQCAtMTE5OCw3ICsxMTk4LDcgQEAgc3Rh
dGljIGludCBsaXZlX3ByZWVtcHRfaGFuZyh2b2lkICphcmcpCiAJCWlmICghaWd0X3dhaXRfZm9y
X3NwaW5uZXIoJnNwaW5fbG8sIHJxKSkgewogCQkJR0VNX1RSQUNFKCJsbyBzcGlubmVyIGZhaWxl
ZCB0byBzdGFydFxuIik7CiAJCQlHRU1fVFJBQ0VfRFVNUCgpOwotCQkJaTkxNV9nZW1fc2V0X3dl
ZGdlZChpOTE1KTsKKwkJCWludGVsX2d0X3NldF93ZWRnZWQoJmk5MTUtPmd0KTsKIAkJCWVyciA9
IC1FSU87CiAJCQlnb3RvIGVycl9jdHhfbG87CiAJCX0KQEAgLTEyMjAsMjEgKzEyMjAsMjEgQEAg
c3RhdGljIGludCBsaXZlX3ByZWVtcHRfaGFuZyh2b2lkICphcmcpCiAJCQkJCQkgSFogLyAxMCkp
IHsKIAkJCXByX2VycigiUHJlZW1wdGlvbiBkaWQgbm90IG9jY3VyIHdpdGhpbiB0aW1lb3V0ISIp
OwogCQkJR0VNX1RSQUNFX0RVTVAoKTsKLQkJCWk5MTVfZ2VtX3NldF93ZWRnZWQoaTkxNSk7CisJ
CQlpbnRlbF9ndF9zZXRfd2VkZ2VkKCZpOTE1LT5ndCk7CiAJCQllcnIgPSAtRUlPOwogCQkJZ290
byBlcnJfY3R4X2xvOwogCQl9CiAKLQkJc2V0X2JpdChJOTE1X1JFU0VUX0VOR0lORSArIGlkLCAm
aTkxNS0+Z3B1X2Vycm9yLmZsYWdzKTsKLQkJaTkxNV9yZXNldF9lbmdpbmUoZW5naW5lLCBOVUxM
KTsKLQkJY2xlYXJfYml0KEk5MTVfUkVTRVRfRU5HSU5FICsgaWQsICZpOTE1LT5ncHVfZXJyb3Iu
ZmxhZ3MpOworCQlzZXRfYml0KEk5MTVfUkVTRVRfRU5HSU5FICsgaWQsICZpOTE1LT5ndC5yZXNl
dC5mbGFncyk7CisJCWludGVsX2VuZ2luZV9yZXNldChlbmdpbmUsIE5VTEwpOworCQljbGVhcl9i
aXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBpZCwgJmk5MTUtPmd0LnJlc2V0LmZsYWdzKTsKIAogCQll
bmdpbmUtPmV4ZWNsaXN0cy5wcmVlbXB0X2hhbmcuaW5qZWN0X2hhbmcgPSBmYWxzZTsKIAogCQlp
ZiAoIWlndF93YWl0X2Zvcl9zcGlubmVyKCZzcGluX2hpLCBycSkpIHsKIAkJCUdFTV9UUkFDRSgi
aGkgc3Bpbm5lciBmYWlsZWQgdG8gc3RhcnRcbiIpOwogCQkJR0VNX1RSQUNFX0RVTVAoKTsKLQkJ
CWk5MTVfZ2VtX3NldF93ZWRnZWQoaTkxNSk7CisJCQlpbnRlbF9ndF9zZXRfd2VkZ2VkKCZpOTE1
LT5ndCk7CiAJCQllcnIgPSAtRUlPOwogCQkJZ290byBlcnJfY3R4X2xvOwogCQl9CkBAIC0xNjE0
LDcgKzE2MTQsNyBAQCBzdGF0aWMgaW50IG5vcF92aXJ0dWFsX2VuZ2luZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKIAkJCQkJICByZXF1ZXN0W25jXS0+ZmVuY2UuY29udGV4dCwKIAkJ
CQkJICByZXF1ZXN0W25jXS0+ZmVuY2Uuc2Vxbm8pOwogCQkJCUdFTV9UUkFDRV9EVU1QKCk7Ci0J
CQkJaTkxNV9nZW1fc2V0X3dlZGdlZChpOTE1KTsKKwkJCQlpbnRlbF9ndF9zZXRfd2VkZ2VkKCZp
OTE1LT5ndCk7CiAJCQkJYnJlYWs7CiAJCQl9CiAJCX0KQEAgLTE3NjEsNyArMTc2MSw3IEBAIHN0
YXRpYyBpbnQgbWFza192aXJ0dWFsX2VuZ2luZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKIAkJCQkgIHJlcXVlc3Rbbl0tPmZlbmNlLmNvbnRleHQsCiAJCQkJICByZXF1ZXN0W25dLT5m
ZW5jZS5zZXFubyk7CiAJCQlHRU1fVFJBQ0VfRFVNUCgpOwotCQkJaTkxNV9nZW1fc2V0X3dlZGdl
ZChpOTE1KTsKKwkJCWludGVsX2d0X3NldF93ZWRnZWQoJmk5MTUtPmd0KTsKIAkJCWVyciA9IC1F
SU87CiAJCQlnb3RvIG91dDsKIAkJfQpAQCAtMjAzNyw3ICsyMDM3LDcgQEAgaW50IGludGVsX2V4
ZWNsaXN0c19saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAlp
ZiAoIUhBU19FWEVDTElTVFMoaTkxNSkpCiAJCXJldHVybiAwOwogCi0JaWYgKGk5MTVfdGVybWlu
YWxseV93ZWRnZWQoaTkxNSkpCisJaWYgKGludGVsX2d0X2lzX3dlZGdlZCgmaTkxNS0+Z3QpKQog
CQlyZXR1cm4gMDsKIAogCXJldHVybiBpOTE1X2xpdmVfc3VidGVzdHModGVzdHMsIGk5MTUpOwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfcmVzZXQuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3Jlc2V0LmMKaW5kZXggNjcyZTMyZTFlZjk1
Li5lOTFjMWNjNTQ3OWIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0
ZXN0X3Jlc2V0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfcmVzZXQu
YwpAQCAtMTUsMjAgKzE1LDIwIEBAIHN0YXRpYyBpbnQgaWd0X2dsb2JhbF9yZXNldCh2b2lkICph
cmcpCiAKIAkvKiBDaGVjayB0aGF0IHdlIGNhbiBpc3N1ZSBhIGdsb2JhbCBHUFUgcmVzZXQgKi8K
IAotCWlndF9nbG9iYWxfcmVzZXRfbG9jayhpOTE1KTsKKwlpZ3RfZ2xvYmFsX3Jlc2V0X2xvY2so
Jmk5MTUtPmd0KTsKIAogCXJlc2V0X2NvdW50ID0gaTkxNV9yZXNldF9jb3VudCgmaTkxNS0+Z3B1
X2Vycm9yKTsKIAotCWk5MTVfcmVzZXQoaTkxNSwgQUxMX0VOR0lORVMsIE5VTEwpOworCWludGVs
X2d0X3Jlc2V0KCZpOTE1LT5ndCwgQUxMX0VOR0lORVMsIE5VTEwpOwogCiAJaWYgKGk5MTVfcmVz
ZXRfY291bnQoJmk5MTUtPmdwdV9lcnJvcikgPT0gcmVzZXRfY291bnQpIHsKIAkJcHJfZXJyKCJO
byBHUFUgcmVzZXQgcmVjb3JkZWQhXG4iKTsKIAkJZXJyID0gLUVJTlZBTDsKIAl9CiAKLQlpZ3Rf
Z2xvYmFsX3Jlc2V0X3VubG9jayhpOTE1KTsKKwlpZ3RfZ2xvYmFsX3Jlc2V0X3VubG9jaygmaTkx
NS0+Z3QpOwogCi0JaWYgKGk5MTVfcmVzZXRfZmFpbGVkKGk5MTUpKQorCWlmIChpbnRlbF9ndF9p
c193ZWRnZWQoJmk5MTUtPmd0KSkKIAkJZXJyID0gLUVJTzsKIAogCXJldHVybiBlcnI7CkBAIC00
MSwxOCArNDEsMTggQEAgc3RhdGljIGludCBpZ3Rfd2VkZ2VkX3Jlc2V0KHZvaWQgKmFyZykKIAog
CS8qIENoZWNrIHRoYXQgd2UgY2FuIHJlY292ZXIgYSB3ZWRnZWQgZGV2aWNlIHdpdGggYSBHUFUg
cmVzZXQgKi8KIAotCWlndF9nbG9iYWxfcmVzZXRfbG9jayhpOTE1KTsKKwlpZ3RfZ2xvYmFsX3Jl
c2V0X2xvY2soJmk5MTUtPmd0KTsKIAl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5
MTUtPnJ1bnRpbWVfcG0pOwogCi0JaTkxNV9nZW1fc2V0X3dlZGdlZChpOTE1KTsKKwlpbnRlbF9n
dF9zZXRfd2VkZ2VkKCZpOTE1LT5ndCk7CiAKLQlHRU1fQlVHX09OKCFpOTE1X3Jlc2V0X2ZhaWxl
ZChpOTE1KSk7Ci0JaTkxNV9yZXNldChpOTE1LCBBTExfRU5HSU5FUywgTlVMTCk7CisJR0VNX0JV
R19PTighaW50ZWxfZ3RfaXNfd2VkZ2VkKCZpOTE1LT5ndCkpOworCWludGVsX2d0X3Jlc2V0KCZp
OTE1LT5ndCwgQUxMX0VOR0lORVMsIE5VTEwpOwogCiAJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5
MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwotCWlndF9nbG9iYWxfcmVzZXRfdW5sb2NrKGk5MTUp
OworCWlndF9nbG9iYWxfcmVzZXRfdW5sb2NrKCZpOTE1LT5ndCk7CiAKLQlyZXR1cm4gaTkxNV9y
ZXNldF9mYWlsZWQoaTkxNSkgPyAtRUlPIDogMDsKKwlyZXR1cm4gaW50ZWxfZ3RfaXNfd2VkZ2Vk
KCZpOTE1LT5ndCkgPyAtRUlPIDogMDsKIH0KIAogc3RhdGljIGludCBpZ3RfYXRvbWljX3Jlc2V0
KHZvaWQgKmFyZykKQEAgLTY0LDEwICs2NCwxMCBAQCBzdGF0aWMgaW50IGlndF9hdG9taWNfcmVz
ZXQodm9pZCAqYXJnKQogCS8qIENoZWNrIHRoYXQgdGhlIHJlc2V0cyBhcmUgdXNhYmxlIGZyb20g
YXRvbWljIGNvbnRleHQgKi8KIAogCWludGVsX2d0X3BtX2dldCgmaTkxNS0+Z3QpOwotCWlndF9n
bG9iYWxfcmVzZXRfbG9jayhpOTE1KTsKKwlpZ3RfZ2xvYmFsX3Jlc2V0X2xvY2soJmk5MTUtPmd0
KTsKIAogCS8qIEZsdXNoIGFueSByZXF1ZXN0cyBiZWZvcmUgd2UgZ2V0IHN0YXJ0ZWQgYW5kIGNo
ZWNrIGJhc2ljcyAqLwotCWlmICghaWd0X2ZvcmNlX3Jlc2V0KGk5MTUpKQorCWlmICghaWd0X2Zv
cmNlX3Jlc2V0KCZpOTE1LT5ndCkpCiAJCWdvdG8gdW5sb2NrOwogCiAJZm9yIChwID0gaWd0X2F0
b21pY19waGFzZXM7IHAtPm5hbWU7IHArKykgewpAQCAtNzUsMTMgKzc1LDEzIEBAIHN0YXRpYyBp
bnQgaWd0X2F0b21pY19yZXNldCh2b2lkICphcmcpCiAKIAkJR0VNX1RSQUNFKCJpbnRlbF9ncHVf
cmVzZXQgdW5kZXIgJXNcbiIsIHAtPm5hbWUpOwogCi0JCWF3YWtlID0gcmVzZXRfcHJlcGFyZShp
OTE1KTsKKwkJYXdha2UgPSByZXNldF9wcmVwYXJlKCZpOTE1LT5ndCk7CiAJCXAtPmNyaXRpY2Fs
X3NlY3Rpb25fYmVnaW4oKTsKIAotCQllcnIgPSBpbnRlbF9ncHVfcmVzZXQoaTkxNSwgQUxMX0VO
R0lORVMpOworCQllcnIgPSBpbnRlbF9ncHVfcmVzZXQoJmk5MTUtPmd0LCBBTExfRU5HSU5FUyk7
CiAKIAkJcC0+Y3JpdGljYWxfc2VjdGlvbl9lbmQoKTsKLQkJcmVzZXRfZmluaXNoKGk5MTUsIGF3
YWtlKTsKKwkJcmVzZXRfZmluaXNoKCZpOTE1LT5ndCwgYXdha2UpOwogCiAJCWlmIChlcnIpIHsK
IAkJCXByX2VycigiaW50ZWxfZ3B1X3Jlc2V0IGZhaWxlZCB1bmRlciAlc1xuIiwgcC0+bmFtZSk7
CkBAIC05MCwxMCArOTAsMTAgQEAgc3RhdGljIGludCBpZ3RfYXRvbWljX3Jlc2V0KHZvaWQgKmFy
ZykKIAl9CiAKIAkvKiBBcyB3ZSBwb2tlIGFyb3VuZCB0aGUgZ3V0cywgZG8gYSBmdWxsIHJlc2V0
IGJlZm9yZSBjb250aW51aW5nLiAqLwotCWlndF9mb3JjZV9yZXNldChpOTE1KTsKKwlpZ3RfZm9y
Y2VfcmVzZXQoJmk5MTUtPmd0KTsKIAogdW5sb2NrOgotCWlndF9nbG9iYWxfcmVzZXRfdW5sb2Nr
KGk5MTUpOworCWlndF9nbG9iYWxfcmVzZXRfdW5sb2NrKCZpOTE1LT5ndCk7CiAJaW50ZWxfZ3Rf
cG1fcHV0KCZpOTE1LT5ndCk7CiAKIAlyZXR1cm4gZXJyOwpAQCAtMTE2LDEwICsxMTYsMTAgQEAg
c3RhdGljIGludCBpZ3RfYXRvbWljX2VuZ2luZV9yZXNldCh2b2lkICphcmcpCiAJCXJldHVybiAw
OwogCiAJaW50ZWxfZ3RfcG1fZ2V0KCZpOTE1LT5ndCk7Ci0JaWd0X2dsb2JhbF9yZXNldF9sb2Nr
KGk5MTUpOworCWlndF9nbG9iYWxfcmVzZXRfbG9jaygmaTkxNS0+Z3QpOwogCiAJLyogRmx1c2gg
YW55IHJlcXVlc3RzIGJlZm9yZSB3ZSBnZXQgc3RhcnRlZCBhbmQgY2hlY2sgYmFzaWNzICovCi0J
aWYgKCFpZ3RfZm9yY2VfcmVzZXQoaTkxNSkpCisJaWYgKCFpZ3RfZm9yY2VfcmVzZXQoJmk5MTUt
Pmd0KSkKIAkJZ290byBvdXRfdW5sb2NrOwogCiAJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkx
NSwgaWQpIHsKQEAgLTEyNywxNSArMTI3LDE1IEBAIHN0YXRpYyBpbnQgaWd0X2F0b21pY19lbmdp
bmVfcmVzZXQodm9pZCAqYXJnKQogCQlpbnRlbF9lbmdpbmVfcG1fZ2V0KGVuZ2luZSk7CiAKIAkJ
Zm9yIChwID0gaWd0X2F0b21pY19waGFzZXM7IHAtPm5hbWU7IHArKykgewotCQkJR0VNX1RSQUNF
KCJpOTE1X3Jlc2V0X2VuZ2luZSglcykgdW5kZXIgJXNcbiIsCisJCQlHRU1fVFJBQ0UoImludGVs
X2VuZ2luZV9yZXNldCglcykgdW5kZXIgJXNcbiIsCiAJCQkJICBlbmdpbmUtPm5hbWUsIHAtPm5h
bWUpOwogCiAJCQlwLT5jcml0aWNhbF9zZWN0aW9uX2JlZ2luKCk7Ci0JCQllcnIgPSBpOTE1X3Jl
c2V0X2VuZ2luZShlbmdpbmUsIE5VTEwpOworCQkJZXJyID0gaW50ZWxfZW5naW5lX3Jlc2V0KGVu
Z2luZSwgTlVMTCk7CiAJCQlwLT5jcml0aWNhbF9zZWN0aW9uX2VuZCgpOwogCiAJCQlpZiAoZXJy
KSB7Ci0JCQkJcHJfZXJyKCJpOTE1X3Jlc2V0X2VuZ2luZSglcykgZmFpbGVkIHVuZGVyICVzXG4i
LAorCQkJCXByX2VycigiaW50ZWxfZW5naW5lX3Jlc2V0KCVzKSBmYWlsZWQgdW5kZXIgJXNcbiIs
CiAJCQkJICAgICAgIGVuZ2luZS0+bmFtZSwgcC0+bmFtZSk7CiAJCQkJYnJlYWs7CiAJCQl9CkBA
IC0xNDgsMTAgKzE0OCwxMCBAQCBzdGF0aWMgaW50IGlndF9hdG9taWNfZW5naW5lX3Jlc2V0KHZv
aWQgKmFyZykKIAl9CiAKIAkvKiBBcyB3ZSBwb2tlIGFyb3VuZCB0aGUgZ3V0cywgZG8gYSBmdWxs
IHJlc2V0IGJlZm9yZSBjb250aW51aW5nLiAqLwotCWlndF9mb3JjZV9yZXNldChpOTE1KTsKKwlp
Z3RfZm9yY2VfcmVzZXQoJmk5MTUtPmd0KTsKIAogb3V0X3VubG9jazoKLQlpZ3RfZ2xvYmFsX3Jl
c2V0X3VubG9jayhpOTE1KTsKKwlpZ3RfZ2xvYmFsX3Jlc2V0X3VubG9jaygmaTkxNS0+Z3QpOwog
CWludGVsX2d0X3BtX3B1dCgmaTkxNS0+Z3QpOwogCiAJcmV0dXJuIGVycjsKQEAgLTE3MSw3ICsx
NzEsNyBAQCBpbnQgaW50ZWxfcmVzZXRfbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCiAJaWYgKCFpbnRlbF9oYXNfZ3B1X3Jlc2V0KGk5MTUpKQogCQlyZXR1cm4g
MDsKIAotCWlmIChpOTE1X3Rlcm1pbmFsbHlfd2VkZ2VkKGk5MTUpKQorCWlmIChpbnRlbF9ndF9p
c193ZWRnZWQoJmk5MTUtPmd0KSkKIAkJcmV0dXJuIC1FSU87IC8qIHdlJ3JlIGxvbmcgcGFzdCBo
b3BlIG9mIGEgc3VjY2Vzc2Z1bCByZXNldCAqLwogCiAJd2l0aF9pbnRlbF9ydW50aW1lX3BtKCZp
OTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Qvc2VsZnRlc3RfdGltZWxpbmUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0
ZXN0X3RpbWVsaW5lLmMKaW5kZXggOWYzMTAwMTM1NTkwLi5kNTQxMTM2OTc3NDUgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3RpbWVsaW5lLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfdGltZWxpbmUuYwpAQCAtNyw2ICs3LDcgQEAK
ICNpbmNsdWRlIDxsaW51eC9wcmltZV9udW1iZXJzLmg+CiAKICNpbmNsdWRlICJnZW0vaTkxNV9n
ZW1fcG0uaCIKKyNpbmNsdWRlICJpbnRlbF9ndC5oIgogCiAjaW5jbHVkZSAiLi4vc2VsZnRlc3Rz
L2k5MTVfcmFuZG9tLmgiCiAjaW5jbHVkZSAiLi4vaTkxNV9zZWxmdGVzdC5oIgpAQCAtODM0LDcg
KzgzNSw3IEBAIGludCBpbnRlbF90aW1lbGluZV9saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSkKIAkJU1VCVEVTVChsaXZlX2h3c3Bfd3JhcCksCiAJfTsKIAotCWlm
IChpOTE1X3Rlcm1pbmFsbHlfd2VkZ2VkKGk5MTUpKQorCWlmIChpbnRlbF9ndF9pc193ZWRnZWQo
Jmk5MTUtPmd0KSkKIAkJcmV0dXJuIDA7CiAKIAlyZXR1cm4gaTkxNV9saXZlX3N1YnRlc3RzKHRl
c3RzLCBpOTE1KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0
X3dvcmthcm91bmRzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF93b3JrYXJv
dW5kcy5jCmluZGV4IGI5MzNkODMxZWViMS4uYjIyMzEwOTRmYjJkIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF93b3JrYXJvdW5kcy5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMKQEAgLTEyLDcgKzEyLDYgQEAK
ICNpbmNsdWRlICJzZWxmdGVzdHMvaWd0X2ZsdXNoX3Rlc3QuaCIKICNpbmNsdWRlICJzZWxmdGVz
dHMvaWd0X3Jlc2V0LmgiCiAjaW5jbHVkZSAic2VsZnRlc3RzL2lndF9zcGlubmVyLmgiCi0jaW5j
bHVkZSAic2VsZnRlc3RzL2lndF93ZWRnZV9tZS5oIgogI2luY2x1ZGUgInNlbGZ0ZXN0cy9tb2Nr
X2RybS5oIgogCiAjaW5jbHVkZSAiZ2VtL3NlbGZ0ZXN0cy9pZ3RfZ2VtX3V0aWxzLmgiCkBAIC0x
ODUsNyArMTg0LDcgQEAgc3RhdGljIGludCBjaGVja193aGl0ZWxpc3Qoc3RydWN0IGk5MTVfZ2Vt
X2NvbnRleHQgKmN0eCwKIAkJCSAgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsK
IAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqcmVzdWx0czsKLQlzdHJ1Y3QgaWd0X3dlZGdl
X21lIHdlZGdlOworCXN0cnVjdCBpbnRlbF93ZWRnZV9tZSB3ZWRnZTsKIAl1MzIgKnZhZGRyOwog
CWludCBlcnI7CiAJaW50IGk7CkBAIC0xOTYsMTAgKzE5NSwxMCBAQCBzdGF0aWMgaW50IGNoZWNr
X3doaXRlbGlzdChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAogCiAJZXJyID0gMDsKIAlp
OTE1X2dlbV9vYmplY3RfbG9jayhyZXN1bHRzKTsKLQlpZ3Rfd2VkZ2Vfb25fdGltZW91dCgmd2Vk
Z2UsIGN0eC0+aTkxNSwgSFogLyA1KSAvKiBhIHNhZmV0eSBuZXQhICovCisJaW50ZWxfd2VkZ2Vf
b25fdGltZW91dCgmd2VkZ2UsICZjdHgtPmk5MTUtPmd0LCBIWiAvIDUpIC8qIHNhZmV0eSBuZXQh
ICovCiAJCWVyciA9IGk5MTVfZ2VtX29iamVjdF9zZXRfdG9fY3B1X2RvbWFpbihyZXN1bHRzLCBm
YWxzZSk7CiAJaTkxNV9nZW1fb2JqZWN0X3VubG9jayhyZXN1bHRzKTsKLQlpZiAoaTkxNV90ZXJt
aW5hbGx5X3dlZGdlZChjdHgtPmk5MTUpKQorCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoJmN0eC0+
aTkxNS0+Z3QpKQogCQllcnIgPSAtRUlPOwogCWlmIChlcnIpCiAJCWdvdG8gb3V0X3B1dDsKQEAg
LTIzMiwxMyArMjMxLDEzIEBAIHN0YXRpYyBpbnQgY2hlY2tfd2hpdGVsaXN0KHN0cnVjdCBpOTE1
X2dlbV9jb250ZXh0ICpjdHgsCiAKIHN0YXRpYyBpbnQgZG9fZGV2aWNlX3Jlc2V0KHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsKLQlpOTE1X3Jlc2V0KGVuZ2luZS0+aTkxNSwgZW5n
aW5lLT5tYXNrLCAibGl2ZV93b3JrYXJvdW5kcyIpOworCWludGVsX2d0X3Jlc2V0KGVuZ2luZS0+
Z3QsIGVuZ2luZS0+bWFzaywgImxpdmVfd29ya2Fyb3VuZHMiKTsKIAlyZXR1cm4gMDsKIH0KIAog
c3RhdGljIGludCBkb19lbmdpbmVfcmVzZXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KQogewotCXJldHVybiBpOTE1X3Jlc2V0X2VuZ2luZShlbmdpbmUsICJsaXZlX3dvcmthcm91bmRz
Iik7CisJcmV0dXJuIGludGVsX2VuZ2luZV9yZXNldChlbmdpbmUsICJsaXZlX3dvcmthcm91bmRz
Iik7CiB9CiAKIHN0YXRpYyBpbnQKQEAgLTU3MSw3ICs1NzAsNyBAQCBzdGF0aWMgaW50IGNoZWNr
X2RpcnR5X3doaXRlbGlzdChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAogCQlpZiAoaTkx
NV9yZXF1ZXN0X3dhaXQocnEsIDAsIEhaIC8gNSkgPCAwKSB7CiAJCQlwcl9lcnIoIiVzOiBGdXR6
aW5nICV4IHRpbWVkb3V0OyBjYW5jZWxsaW5nIHRlc3RcbiIsCiAJCQkgICAgICAgZW5naW5lLT5u
YW1lLCByZWcpOwotCQkJaTkxNV9nZW1fc2V0X3dlZGdlZChjdHgtPmk5MTUpOworCQkJaW50ZWxf
Z3Rfc2V0X3dlZGdlZCgmY3R4LT5pOTE1LT5ndCk7CiAJCQllcnIgPSAtRUlPOwogCQkJZ290byBv
dXRfYmF0Y2g7CiAJCX0KQEAgLTcwOCw3ICs3MDcsNyBAQCBzdGF0aWMgaW50IGxpdmVfcmVzZXRf
d2hpdGVsaXN0KHZvaWQgKmFyZykKIAlpZiAoIWVuZ2luZSB8fCBlbmdpbmUtPndoaXRlbGlzdC5j
b3VudCA9PSAwKQogCQlyZXR1cm4gMDsKIAotCWlndF9nbG9iYWxfcmVzZXRfbG9jayhpOTE1KTsK
KwlpZ3RfZ2xvYmFsX3Jlc2V0X2xvY2soJmk5MTUtPmd0KTsKIAogCWlmIChpbnRlbF9oYXNfcmVz
ZXRfZW5naW5lKGk5MTUpKSB7CiAJCWVyciA9IGNoZWNrX3doaXRlbGlzdF9hY3Jvc3NfcmVzZXQo
ZW5naW5lLApAQCAtNzI3LDcgKzcyNiw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9yZXNldF93aGl0ZWxp
c3Qodm9pZCAqYXJnKQogCX0KIAogb3V0OgotCWlndF9nbG9iYWxfcmVzZXRfdW5sb2NrKGk5MTUp
OworCWlndF9nbG9iYWxfcmVzZXRfdW5sb2NrKCZpOTE1LT5ndCk7CiAJcmV0dXJuIGVycjsKIH0K
IApAQCAtMTA5NSw3ICsxMDk0LDcgQEAgbGl2ZV9ncHVfcmVzZXRfd29ya2Fyb3VuZHModm9pZCAq
YXJnKQogCiAJcHJfaW5mbygiVmVyaWZ5aW5nIGFmdGVyIEdQVSByZXNldC4uLlxuIik7CiAKLQlp
Z3RfZ2xvYmFsX3Jlc2V0X2xvY2soaTkxNSk7CisJaWd0X2dsb2JhbF9yZXNldF9sb2NrKCZpOTE1
LT5ndCk7CiAJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3Bt
KTsKIAogCXJlZmVyZW5jZV9saXN0c19pbml0KGk5MTUsICZsaXN0cyk7CkBAIC0xMTA0LDcgKzEx
MDMsNyBAQCBsaXZlX2dwdV9yZXNldF93b3JrYXJvdW5kcyh2b2lkICphcmcpCiAJaWYgKCFvaykK
IAkJZ290byBvdXQ7CiAKLQlpOTE1X3Jlc2V0KGk5MTUsIEFMTF9FTkdJTkVTLCAibGl2ZV93b3Jr
YXJvdW5kcyIpOworCWludGVsX2d0X3Jlc2V0KCZpOTE1LT5ndCwgQUxMX0VOR0lORVMsICJsaXZl
X3dvcmthcm91bmRzIik7CiAKIAlvayA9IHZlcmlmeV93YV9saXN0cyhjdHgsICZsaXN0cywgImFm
dGVyIHJlc2V0Iik7CiAKQEAgLTExMTIsNyArMTExMSw3IEBAIGxpdmVfZ3B1X3Jlc2V0X3dvcmth
cm91bmRzKHZvaWQgKmFyZykKIAlrZXJuZWxfY29udGV4dF9jbG9zZShjdHgpOwogCXJlZmVyZW5j
ZV9saXN0c19maW5pKGk5MTUsICZsaXN0cyk7CiAJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUt
PnJ1bnRpbWVfcG0sIHdha2VyZWYpOwotCWlndF9nbG9iYWxfcmVzZXRfdW5sb2NrKGk5MTUpOwor
CWlndF9nbG9iYWxfcmVzZXRfdW5sb2NrKCZpOTE1LT5ndCk7CiAKIAlyZXR1cm4gb2sgPyAwIDog
LUVTUkNIOwogfQpAQCAtMTEzNyw3ICsxMTM2LDcgQEAgbGl2ZV9lbmdpbmVfcmVzZXRfd29ya2Fy
b3VuZHModm9pZCAqYXJnKQogCWlmIChJU19FUlIoY3R4KSkKIAkJcmV0dXJuIFBUUl9FUlIoY3R4
KTsKIAotCWlndF9nbG9iYWxfcmVzZXRfbG9jayhpOTE1KTsKKwlpZ3RfZ2xvYmFsX3Jlc2V0X2xv
Y2soJmk5MTUtPmd0KTsKIAl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1
bnRpbWVfcG0pOwogCiAJcmVmZXJlbmNlX2xpc3RzX2luaXQoaTkxNSwgJmxpc3RzKTsKQEAgLTEx
NTMsNyArMTE1Miw3IEBAIGxpdmVfZW5naW5lX3Jlc2V0X3dvcmthcm91bmRzKHZvaWQgKmFyZykK
IAkJCWdvdG8gZXJyOwogCQl9CiAKLQkJaTkxNV9yZXNldF9lbmdpbmUoZW5naW5lLCAibGl2ZV93
b3JrYXJvdW5kcyIpOworCQlpbnRlbF9lbmdpbmVfcmVzZXQoZW5naW5lLCAibGl2ZV93b3JrYXJv
dW5kcyIpOwogCiAJCW9rID0gdmVyaWZ5X3dhX2xpc3RzKGN0eCwgJmxpc3RzLCAiYWZ0ZXIgaWRs
ZSByZXNldCIpOwogCQlpZiAoIW9rKSB7CkBAIC0xMTgxLDcgKzExODAsNyBAQCBsaXZlX2VuZ2lu
ZV9yZXNldF93b3JrYXJvdW5kcyh2b2lkICphcmcpCiAJCQlnb3RvIGVycjsKIAkJfQogCi0JCWk5
MTVfcmVzZXRfZW5naW5lKGVuZ2luZSwgImxpdmVfd29ya2Fyb3VuZHMiKTsKKwkJaW50ZWxfZW5n
aW5lX3Jlc2V0KGVuZ2luZSwgImxpdmVfd29ya2Fyb3VuZHMiKTsKIAogCQlpZ3Rfc3Bpbm5lcl9l
bmQoJnNwaW4pOwogCQlpZ3Rfc3Bpbm5lcl9maW5pKCZzcGluKTsKQEAgLTExOTYsNyArMTE5NSw3
IEBAIGxpdmVfZW5naW5lX3Jlc2V0X3dvcmthcm91bmRzKHZvaWQgKmFyZykKIGVycjoKIAlyZWZl
cmVuY2VfbGlzdHNfZmluaShpOTE1LCAmbGlzdHMpOwogCWludGVsX3J1bnRpbWVfcG1fcHV0KCZp
OTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKLQlpZ3RfZ2xvYmFsX3Jlc2V0X3VubG9jayhpOTE1
KTsKKwlpZ3RfZ2xvYmFsX3Jlc2V0X3VubG9jaygmaTkxNS0+Z3QpOwogCWtlcm5lbF9jb250ZXh0
X2Nsb3NlKGN0eCk7CiAKIAlpZ3RfZmx1c2hfdGVzdChpOTE1LCBJOTE1X1dBSVRfTE9DS0VEKTsK
QEAgLTEyMTUsNyArMTIxNCw3IEBAIGludCBpbnRlbF93b3JrYXJvdW5kc19saXZlX3NlbGZ0ZXN0
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAl9OwogCWludCBlcnI7CiAKLQlpZiAo
aTkxNV90ZXJtaW5hbGx5X3dlZGdlZChpOTE1KSkKKwlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKCZp
OTE1LT5ndCkpCiAJCXJldHVybiAwOwogCiAJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9t
dXRleCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCmluZGV4IGNlMWI2NTY4NTE1ZS4u
Y2Y1MTU1NjQ2OTI3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVn
ZnMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwpAQCAtMTAwNywx
NSArMTAwNywxNiBAQCBzdGF0aWMgdm9pZCBpOTE1X2luc3Rkb25lX2luZm8oc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAogCiBzdGF0aWMgaW50IGk5MTVfaGFuZ2NoZWNrX2luZm8o
c3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOworCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOworCXN0cnVjdCBp
bnRlbF9ndCAqZ3QgPSAmaTkxNS0+Z3Q7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
OwogCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwogCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwog
Ci0Jc2VxX3ByaW50ZihtLCAiUmVzZXQgZmxhZ3M6ICVseFxuIiwgZGV2X3ByaXYtPmdwdV9lcnJv
ci5mbGFncyk7Ci0JaWYgKHRlc3RfYml0KEk5MTVfV0VER0VELCAmZGV2X3ByaXYtPmdwdV9lcnJv
ci5mbGFncykpCisJc2VxX3ByaW50ZihtLCAiUmVzZXQgZmxhZ3M6ICVseFxuIiwgZ3QtPnJlc2V0
LmZsYWdzKTsKKwlpZiAodGVzdF9iaXQoSTkxNV9XRURHRUQsICZndC0+cmVzZXQuZmxhZ3MpKQog
CQlzZXFfcHV0cyhtLCAiXHRXZWRnZWRcbiIpOwotCWlmICh0ZXN0X2JpdChJOTE1X1JFU0VUX0JB
Q0tPRkYsICZkZXZfcHJpdi0+Z3B1X2Vycm9yLmZsYWdzKSkKKwlpZiAodGVzdF9iaXQoSTkxNV9S
RVNFVF9CQUNLT0ZGLCAmZ3QtPnJlc2V0LmZsYWdzKSkKIAkJc2VxX3B1dHMobSwgIlx0RGV2aWNl
IChnbG9iYWwpIHJlc2V0IGluIHByb2dyZXNzXG4iKTsKIAogCWlmICghaTkxNV9tb2RwYXJhbXMu
ZW5hYmxlX2hhbmdjaGVjaykgewpAQCAtMTAyMywxOSArMTAyNCwxOSBAQCBzdGF0aWMgaW50IGk5
MTVfaGFuZ2NoZWNrX2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCiAJCXJl
dHVybiAwOwogCX0KIAotCWlmICh0aW1lcl9wZW5kaW5nKCZkZXZfcHJpdi0+Z3B1X2Vycm9yLmhh
bmdjaGVja193b3JrLnRpbWVyKSkKKwlpZiAodGltZXJfcGVuZGluZygmZ3QtPmhhbmdjaGVjay53
b3JrLnRpbWVyKSkKIAkJc2VxX3ByaW50ZihtLCAiSGFuZ2NoZWNrIGFjdGl2ZSwgdGltZXIgZmly
ZXMgaW4gJWRtc1xuIiwKLQkJCSAgIGppZmZpZXNfdG9fbXNlY3MoZGV2X3ByaXYtPmdwdV9lcnJv
ci5oYW5nY2hlY2tfd29yay50aW1lci5leHBpcmVzIC0KKwkJCSAgIGppZmZpZXNfdG9fbXNlY3Mo
Z3QtPmhhbmdjaGVjay53b3JrLnRpbWVyLmV4cGlyZXMgLQogCQkJCQkgICAgamlmZmllcykpOwot
CWVsc2UgaWYgKGRlbGF5ZWRfd29ya19wZW5kaW5nKCZkZXZfcHJpdi0+Z3B1X2Vycm9yLmhhbmdj
aGVja193b3JrKSkKKwllbHNlIGlmIChkZWxheWVkX3dvcmtfcGVuZGluZygmZ3QtPmhhbmdjaGVj
ay53b3JrKSkKIAkJc2VxX3B1dHMobSwgIkhhbmdjaGVjayBhY3RpdmUsIHdvcmsgcGVuZGluZ1xu
Iik7CiAJZWxzZQogCQlzZXFfcHV0cyhtLCAiSGFuZ2NoZWNrIGluYWN0aXZlXG4iKTsKIAotCXNl
cV9wcmludGYobSwgIkdUIGFjdGl2ZT8gJXNcbiIsIHllc25vKGRldl9wcml2LT5ndC5hd2FrZSkp
OworCXNlcV9wcmludGYobSwgIkdUIGFjdGl2ZT8gJXNcbiIsIHllc25vKGd0LT5hd2FrZSkpOwog
Ci0Jd2l0aF9pbnRlbF9ydW50aW1lX3BtKCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZikg
ewotCQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpIHsKKwl3aXRoX2ludGVs
X3J1bnRpbWVfcG0oJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpIHsKKwkJZm9yX2VhY2hfZW5n
aW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKIAkJCXN0cnVjdCBpbnRlbF9pbnN0ZG9uZSBpbnN0ZG9u
ZTsKIAogCQkJc2VxX3ByaW50ZihtLCAiJXM6ICVkIG1zIGFnb1xuIiwKQEAgLTEwNTAsMTAgKzEw
NTEsMTAgQEAgc3RhdGljIGludCBpOTE1X2hhbmdjaGVja19pbmZvKHN0cnVjdCBzZXFfZmlsZSAq
bSwgdm9pZCAqdW51c2VkKQogCQkJaW50ZWxfZW5naW5lX2dldF9pbnN0ZG9uZShlbmdpbmUsICZp
bnN0ZG9uZSk7CiAKIAkJCXNlcV9wdXRzKG0sICJcdGluc3Rkb25lIHJlYWQgPVxuIik7Ci0JCQlp
OTE1X2luc3Rkb25lX2luZm8oZGV2X3ByaXYsIG0sICZpbnN0ZG9uZSk7CisJCQlpOTE1X2luc3Rk
b25lX2luZm8oaTkxNSwgbSwgJmluc3Rkb25lKTsKIAogCQkJc2VxX3B1dHMobSwgIlx0aW5zdGRv
bmUgYWNjdSA9XG4iKTsKLQkJCWk5MTVfaW5zdGRvbmVfaW5mbyhkZXZfcHJpdiwgbSwKKwkJCWk5
MTVfaW5zdGRvbmVfaW5mbyhpOTE1LCBtLAogCQkJCQkgICAmZW5naW5lLT5oYW5nY2hlY2suaW5z
dGRvbmUpOwogCQl9CiAJfQpAQCAtMTA2MSwyMyArMTA2Miw2IEBAIHN0YXRpYyBpbnQgaTkxNV9o
YW5nY2hlY2tfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCBpOTE1X3Jlc2V0X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2
b2lkICp1bnVzZWQpCi17Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9k
ZV90b19pOTE1KG0tPnByaXZhdGUpOwotCXN0cnVjdCBpOTE1X2dwdV9lcnJvciAqZXJyb3IgPSAm
ZGV2X3ByaXYtPmdwdV9lcnJvcjsKLQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0J
ZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Ci0KLQlzZXFfcHJpbnRmKG0sICJmdWxsIGdwdSByZXNl
dCA9ICV1XG4iLCBpOTE1X3Jlc2V0X2NvdW50KGVycm9yKSk7Ci0KLQlmb3JfZWFjaF9lbmdpbmUo
ZW5naW5lLCBkZXZfcHJpdiwgaWQpIHsKLQkJc2VxX3ByaW50ZihtLCAiJXMgPSAldVxuIiwgZW5n
aW5lLT5uYW1lLAotCQkJICAgaTkxNV9yZXNldF9lbmdpbmVfY291bnQoZXJyb3IsIGVuZ2luZSkp
OwotCX0KLQotCXJldHVybiAwOwotfQotCiBzdGF0aWMgaW50IGlyb25sYWtlX2RycGNfaW5mbyhz
dHJ1Y3Qgc2VxX2ZpbGUgKm0pCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBu
b2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7CkBAIC0zNTU0LDcgKzM1MzgsOCBAQCBzdGF0aWMgY29u
c3Qgc3RydWN0IGZpbGVfb3BlcmF0aW9ucyBpOTE1X2N1cl93bV9sYXRlbmN5X2ZvcHMgPSB7CiBz
dGF0aWMgaW50CiBpOTE1X3dlZGdlZF9nZXQodm9pZCAqZGF0YSwgdTY0ICp2YWwpCiB7Ci0JaW50
IHJldCA9IGk5MTVfdGVybWluYWxseV93ZWRnZWQoZGF0YSk7CisJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSBkYXRhOworCWludCByZXQgPSBpbnRlbF9ndF90ZXJtaW5hbGx5X3dlZGdl
ZCgmaTkxNS0+Z3QpOwogCiAJc3dpdGNoIChyZXQpIHsKIAljYXNlIC1FSU86CkBAIC0zNTc0LDEx
ICszNTU5LDExIEBAIGk5MTVfd2VkZ2VkX3NldCh2b2lkICpkYXRhLCB1NjQgdmFsKQogCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZGF0YTsKIAogCS8qIEZsdXNoIGFueSBwcmV2aW91
cyByZXNldCBiZWZvcmUgYXBwbHlpbmcgZm9yIGEgbmV3IG9uZSAqLwotCXdhaXRfZXZlbnQoaTkx
NS0+Z3B1X2Vycm9yLnJlc2V0X3F1ZXVlLAotCQkgICAhdGVzdF9iaXQoSTkxNV9SRVNFVF9CQUNL
T0ZGLCAmaTkxNS0+Z3B1X2Vycm9yLmZsYWdzKSk7CisJd2FpdF9ldmVudChpOTE1LT5ndC5yZXNl
dC5xdWV1ZSwKKwkJICAgIXRlc3RfYml0KEk5MTVfUkVTRVRfQkFDS09GRiwgJmk5MTUtPmd0LnJl
c2V0LmZsYWdzKSk7CiAKLQlpOTE1X2hhbmRsZV9lcnJvcihpOTE1LCB2YWwsIEk5MTVfRVJST1Jf
Q0FQVFVSRSwKLQkJCSAgIk1hbnVhbGx5IHNldCB3ZWRnZWQgZW5naW5lIG1hc2sgPSAlbGx4Iiwg
dmFsKTsKKwlpbnRlbF9ndF9oYW5kbGVfZXJyb3IoJmk5MTUtPmd0LCB2YWwsIEk5MTVfRVJST1Jf
Q0FQVFVSRSwKKwkJCSAgICAgICJNYW51YWxseSBzZXQgd2VkZ2VkIGVuZ2luZSBtYXNrID0gJWxs
eCIsIHZhbCk7CiAJcmV0dXJuIDA7CiB9CiAKQEAgLTM2MjEsOCArMzYwNiw5IEBAIGk5MTVfZHJv
cF9jYWNoZXNfc2V0KHZvaWQgKmRhdGEsIHU2NCB2YWwpCiAJCSAgdmFsLCB2YWwgJiBEUk9QX0FM
TCk7CiAKIAlpZiAodmFsICYgRFJPUF9SRVNFVF9BQ1RJVkUgJiYKLQkgICAgd2FpdF9mb3IoaW50
ZWxfZW5naW5lc19hcmVfaWRsZShpOTE1KSwgSTkxNV9JRExFX0VOR0lORVNfVElNRU9VVCkpCi0J
CWk5MTVfZ2VtX3NldF93ZWRnZWQoaTkxNSk7CisJICAgIHdhaXRfZm9yKGludGVsX2VuZ2luZXNf
YXJlX2lkbGUoJmk5MTUtPmd0KSwKKwkJICAgICBJOTE1X0lETEVfRU5HSU5FU19USU1FT1VUKSkK
KwkJaW50ZWxfZ3Rfc2V0X3dlZGdlZCgmaTkxNS0+Z3QpOwogCiAJLyogTm8gbmVlZCB0byBjaGVj
ayBhbmQgd2FpdCBmb3IgZ3B1IHJlc2V0cywgb25seSBsaWJkcm0gYXV0by1yZXN0YXJ0cwogCSAq
IG9uIGlvY3RscyBvbiAtRUFHQUlOLiAqLwpAQCAtMzY1Nyw4ICszNjQzLDggQEAgaTkxNV9kcm9w
X2NhY2hlc19zZXQodm9pZCAqZGF0YSwgdTY0IHZhbCkKIAkJbXV0ZXhfdW5sb2NrKCZpOTE1LT5k
cm0uc3RydWN0X211dGV4KTsKIAl9CiAKLQlpZiAodmFsICYgRFJPUF9SRVNFVF9BQ1RJVkUgJiYg
aTkxNV90ZXJtaW5hbGx5X3dlZGdlZChpOTE1KSkKLQkJaTkxNV9oYW5kbGVfZXJyb3IoaTkxNSwg
QUxMX0VOR0lORVMsIDAsIE5VTEwpOworCWlmICh2YWwgJiBEUk9QX1JFU0VUX0FDVElWRSAmJiBp
bnRlbF9ndF90ZXJtaW5hbGx5X3dlZGdlZCgmaTkxNS0+Z3QpKQorCQlpbnRlbF9ndF9oYW5kbGVf
ZXJyb3IoJmk5MTUtPmd0LCBBTExfRU5HSU5FUywgMCwgTlVMTCk7CiAKIAlmc19yZWNsYWltX2Fj
cXVpcmUoR0ZQX0tFUk5FTCk7CiAJaWYgKHZhbCAmIERST1BfQk9VTkQpCkBAIC00MzEyLDcgKzQy
OTgsNiBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9pbmZvX2xpc3QgaTkxNV9kZWJ1Z2ZzX2xp
c3RbXSA9IHsKIAl7Imk5MTVfaHVjX2xvYWRfc3RhdHVzIiwgaTkxNV9odWNfbG9hZF9zdGF0dXNf
aW5mbywgMH0sCiAJeyJpOTE1X2ZyZXF1ZW5jeV9pbmZvIiwgaTkxNV9mcmVxdWVuY3lfaW5mbywg
MH0sCiAJeyJpOTE1X2hhbmdjaGVja19pbmZvIiwgaTkxNV9oYW5nY2hlY2tfaW5mbywgMH0sCi0J
eyJpOTE1X3Jlc2V0X2luZm8iLCBpOTE1X3Jlc2V0X2luZm8sIDB9LAogCXsiaTkxNV9kcnBjX2lu
Zm8iLCBpOTE1X2RycGNfaW5mbywgMH0sCiAJeyJpOTE1X2Vtb25fc3RhdHVzIiwgaTkxNV9lbW9u
X3N0YXR1cywgMH0sCiAJeyJpOTE1X3JpbmdfZnJlcV90YWJsZSIsIGk5MTVfcmluZ19mcmVxX3Rh
YmxlLCAwfSwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCmluZGV4IDc5NGM2ODE0YTZkMC4uNGI5ODYw
OTg2YTkzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKQEAgLTk0MSw3ICs5NDEsNiBAQCBzdGF0
aWMgaW50IGk5MTVfZHJpdmVyX2luaXRfZWFybHkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQogCWlmIChyZXQgPCAwKQogCQlnb3RvIGVycl91YzsKIAlpbnRlbF9pcnFfaW5pdChk
ZXZfcHJpdik7Ci0JaW50ZWxfaGFuZ2NoZWNrX2luaXQoZGV2X3ByaXYpOwogCWludGVsX2luaXRf
ZGlzcGxheV9ob29rcyhkZXZfcHJpdik7CiAJaW50ZWxfaW5pdF9jbG9ja19nYXRpbmdfaG9va3Mo
ZGV2X3ByaXYpOwogCWludGVsX2luaXRfYXVkaW9faG9va3MoZGV2X3ByaXYpOwpAQCAtMTk2MCw3
ICsxOTU5LDcgQEAgdm9pZCBpOTE1X2RyaXZlcl91bmxvYWQoc3RydWN0IGRybV9kZXZpY2UgKmRl
dikKIAkgKiBhbGwgaW4tZmxpZ2h0IHJlcXVlc3RzIHNvIHRoYXQgd2UgY2FuIHF1aWNrbHkgdW5i
aW5kIHRoZSBhY3RpdmUKIAkgKiByZXNvdXJjZXMuCiAJICovCi0JaTkxNV9nZW1fc2V0X3dlZGdl
ZChkZXZfcHJpdik7CisJaW50ZWxfZ3Rfc2V0X3dlZGdlZCgmZGV2X3ByaXYtPmd0KTsKIAogCS8q
IEZsdXNoIGFueSBleHRlcm5hbCBjb2RlIHRoYXQgc3RpbGwgbWF5IGJlIHVuZGVyIHRoZSBSQ1Ug
bG9jayAqLwogCXN5bmNocm9uaXplX3JjdSgpOwpAQCAtMTk4MSw3ICsxOTgwLDcgQEAgdm9pZCBp
OTE1X2RyaXZlcl91bmxvYWQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKIAlpbnRlbF9jc3JfdWNv
ZGVfZmluaShkZXZfcHJpdik7CiAKIAkvKiBGcmVlIGVycm9yIHN0YXRlIGFmdGVyIGludGVycnVw
dHMgYXJlIGZ1bGx5IGRpc2FibGVkLiAqLwotCWNhbmNlbF9kZWxheWVkX3dvcmtfc3luYygmZGV2
X3ByaXYtPmdwdV9lcnJvci5oYW5nY2hlY2tfd29yayk7CisJY2FuY2VsX2RlbGF5ZWRfd29ya19z
eW5jKCZkZXZfcHJpdi0+Z3QuaGFuZ2NoZWNrLndvcmspOwogCWk5MTVfcmVzZXRfZXJyb3Jfc3Rh
dGUoZGV2X3ByaXYpOwogCiAJaTkxNV9nZW1fZmluaV9odyhkZXZfcHJpdik7CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9kcnYuaAppbmRleCAzZTFiNTY1Y2IxYjYuLjc5ZDhhNzkzYTIyOCAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2Rydi5oCkBAIC0yNDAyLDI4ICsyNDAyLDEwIEBAIGV4dGVybiBpbnQgaTkxNV9kcml2
ZXJfbG9hZChzdHJ1Y3QgcGNpX2RldiAqcGRldiwKIGV4dGVybiB2b2lkIGk5MTVfZHJpdmVyX3Vu
bG9hZChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KTsKIAogZXh0ZXJuIHZvaWQgaW50ZWxfZW5naW5l
X2luaXRfaGFuZ2NoZWNrKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7Ci1leHRlcm4g
dm9pZCBpbnRlbF9oYW5nY2hlY2tfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpOwogaW50IHZsdl9mb3JjZV9nZnhfY2xvY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LCBib29sIG9uKTsKIAogdTMyIGludGVsX2NhbGN1bGF0ZV9tY3Jfc19zc19zZWxlY3Qo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKIAotc3RhdGljIGlubGluZSB2b2lk
IGk5MTVfcXVldWVfaGFuZ2NoZWNrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
LXsKLQl1bnNpZ25lZCBsb25nIGRlbGF5OwotCi0JaWYgKHVubGlrZWx5KCFpOTE1X21vZHBhcmFt
cy5lbmFibGVfaGFuZ2NoZWNrKSkKLQkJcmV0dXJuOwotCi0JLyogRG9uJ3QgY29udGludWFsbHkg
ZGVmZXIgdGhlIGhhbmdjaGVjayBzbyB0aGF0IGl0IGlzIGFsd2F5cyBydW4gYXQKLQkgKiBsZWFz
dCBvbmNlIGFmdGVyIHdvcmsgaGFzIGJlZW4gc2NoZWR1bGVkIG9uIGFueSByaW5nLiBPdGhlcndp
c2UsCi0JICogd2Ugd2lsbCBpZ25vcmUgYSBodW5nIHJpbmcgaWYgYSBzZWNvbmQgcmluZyBpcyBr
ZXB0IGJ1c3kuCi0JICovCi0KLQlkZWxheSA9IHJvdW5kX2ppZmZpZXNfdXBfcmVsYXRpdmUoRFJN
X0k5MTVfSEFOR0NIRUNLX0pJRkZJRVMpOwotCXF1ZXVlX2RlbGF5ZWRfd29yayhzeXN0ZW1fbG9u
Z193cSwKLQkJCSAgICZkZXZfcHJpdi0+Z3B1X2Vycm9yLmhhbmdjaGVja193b3JrLCBkZWxheSk7
Ci19Ci0KIHN0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF9ndnRfYWN0aXZlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKIHsKIAlyZXR1cm4gZGV2X3ByaXYtPmd2dDsKQEAgLTI1MTIs
MzAgKzI0OTQsMTcgQEAgdm9pZCBpOTE1X2dlbV90cmFja19mYihzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdCAqb2xkLAogCiBpbnQgX19tdXN0X2NoZWNrIGk5MTVfZ2VtX3NldF9nbG9iYWxfc2Vx
bm8oc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdTMyIHNlcW5vKTsKIAotc3RhdGljIGlubGluZSBi
b29sIF9faTkxNV93ZWRnZWQoc3RydWN0IGk5MTVfZ3B1X2Vycm9yICplcnJvcikKLXsKLQlyZXR1
cm4gdW5saWtlbHkodGVzdF9iaXQoSTkxNV9XRURHRUQsICZlcnJvci0+ZmxhZ3MpKTsKLX0KLQot
c3RhdGljIGlubGluZSBib29sIGk5MTVfcmVzZXRfZmFpbGVkKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQotewotCXJldHVybiBfX2k5MTVfd2VkZ2VkKCZpOTE1LT5ncHVfZXJyb3IpOwot
fQotCiBzdGF0aWMgaW5saW5lIHUzMiBpOTE1X3Jlc2V0X2NvdW50KHN0cnVjdCBpOTE1X2dwdV9l
cnJvciAqZXJyb3IpCiB7Ci0JcmV0dXJuIFJFQURfT05DRShlcnJvci0+cmVzZXRfY291bnQpOwor
CXJldHVybiBhdG9taWNfcmVhZCgmZXJyb3ItPnJlc2V0X2NvdW50KTsKIH0KIAogc3RhdGljIGlu
bGluZSB1MzIgaTkxNV9yZXNldF9lbmdpbmVfY291bnQoc3RydWN0IGk5MTVfZ3B1X2Vycm9yICpl
cnJvciwKIAkJCQkJICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7Ci0JcmV0dXJu
IFJFQURfT05DRShlcnJvci0+cmVzZXRfZW5naW5lX2NvdW50W2VuZ2luZS0+aWRdKTsKKwlyZXR1
cm4gYXRvbWljX3JlYWQoJmVycm9yLT5yZXNldF9lbmdpbmVfY291bnRbZW5naW5lLT51YWJpX2Ns
YXNzXSk7CiB9CiAKLXZvaWQgaTkxNV9nZW1fc2V0X3dlZGdlZChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpOwotYm9vbCBpOTE1X2dlbV91bnNldF93ZWRnZWQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KTsKLQogdm9pZCBpOTE1X2dlbV9pbml0X21taW8oc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwogaW50IF9fbXVzdF9jaGVjayBpOTE1X2dlbV9pbml0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiBpbnQgX19tdXN0X2NoZWNrIGk5
MTVfZ2VtX2luaXRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2dlbS5jCmluZGV4IGI2ZjNiYWE3NGRhNC4uY2VjM2NlYTdkODZmIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZ2VtLmMKQEAgLTg5NCwxMyArODk0LDEzIEBAIHZvaWQgaTkxNV9nZW1fcnVu
dGltZV9zdXNwZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCX0KIH0KIAotc3Rh
dGljIGludCB3YWl0X2Zvcl9lbmdpbmVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQor
c3RhdGljIGludCB3YWl0X2Zvcl9lbmdpbmVzKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7Ci0JaWYg
KHdhaXRfZm9yKGludGVsX2VuZ2luZXNfYXJlX2lkbGUoaTkxNSksIEk5MTVfSURMRV9FTkdJTkVT
X1RJTUVPVVQpKSB7Ci0JCWRldl9lcnIoaTkxNS0+ZHJtLmRldiwKKwlpZiAod2FpdF9mb3IoaW50
ZWxfZW5naW5lc19hcmVfaWRsZShndCksIEk5MTVfSURMRV9FTkdJTkVTX1RJTUVPVVQpKSB7CisJ
CWRldl9lcnIoZ3QtPmk5MTUtPmRybS5kZXYsCiAJCQkiRmFpbGVkIHRvIGlkbGUgZW5naW5lcywg
ZGVjbGFyaW5nIHdlZGdlZCFcbiIpOwogCQlHRU1fVFJBQ0VfRFVNUCgpOwotCQlpOTE1X2dlbV9z
ZXRfd2VkZ2VkKGk5MTUpOworCQlpbnRlbF9ndF9zZXRfd2VkZ2VkKGd0KTsKIAkJcmV0dXJuIC1F
SU87CiAJfQogCkBAIC05NzEsNyArOTcxLDcgQEAgaW50IGk5MTVfZ2VtX3dhaXRfZm9yX2lkbGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAKIAkJbG9ja2RlcF9hc3NlcnRfaGVsZCgm
aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAKLQkJZXJyID0gd2FpdF9mb3JfZW5naW5lcyhpOTE1
KTsKKwkJZXJyID0gd2FpdF9mb3JfZW5naW5lcygmaTkxNS0+Z3QpOwogCQlpZiAoZXJyKQogCQkJ
cmV0dXJuIGVycjsKIApAQCAtMTE0OSw4ICsxMTQ5LDggQEAgdm9pZCBpOTE1X2dlbV9zYW5pdGl6
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkgKiBiYWNrIHRvIGRlZmF1bHRzLCBy
ZWNvdmVyaW5nIGZyb20gd2hhdGV2ZXIgd2VkZ2VkIHN0YXRlIHdlIGxlZnQgaXQKIAkgKiBpbiBh
bmQgc28gd29ydGggdHJ5aW5nIHRvIHVzZSB0aGUgZGV2aWNlIG9uY2UgbW9yZS4KIAkgKi8KLQlp
ZiAoaTkxNV90ZXJtaW5hbGx5X3dlZGdlZChpOTE1KSkKLQkJaTkxNV9nZW1fdW5zZXRfd2VkZ2Vk
KGk5MTUpOworCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoJmk5MTUtPmd0KSkKKwkJaW50ZWxfZ3Rf
dW5zZXRfd2VkZ2VkKCZpOTE1LT5ndCk7CiAKIAkvKgogCSAqIElmIHdlIGluaGVyaXQgY29udGV4
dCBzdGF0ZSBmcm9tIHRoZSBCSU9TIG9yIGVhcmxpZXIgb2NjdXBhbnRzCkBAIC0xMjAyLDcgKzEy
MDIsNyBAQCBpbnQgaTkxNV9nZW1faW5pdF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKIAlpbnQgcmV0OwogCiAJQlVHX09OKCFpOTE1LT5rZXJuZWxfY29udGV4dCk7Ci0JcmV0ID0g
aTkxNV90ZXJtaW5hbGx5X3dlZGdlZChpOTE1KTsKKwlyZXQgPSBpbnRlbF9ndF90ZXJtaW5hbGx5
X3dlZGdlZChndCk7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIApAQCAtMTM4NCw3ICsxMzg0
LDcgQEAgc3RhdGljIGludCBfX2ludGVsX2VuZ2luZXNfcmVjb3JkX2RlZmF1bHRzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQogCSAqIGFuZCByZWFkeSB0byBiZSB0b3JuLWRvd24uIFRo
ZSBxdWlja2VzdCB3YXkgd2UgY2FuIGFjY29tcGxpc2gKIAkgKiB0aGlzIGlzIGJ5IGRlY2xhcmlu
ZyBvdXJzZWx2ZXMgd2VkZ2VkLgogCSAqLwotCWk5MTVfZ2VtX3NldF93ZWRnZWQoaTkxNSk7CisJ
aW50ZWxfZ3Rfc2V0X3dlZGdlZCgmaTkxNS0+Z3QpOwogCWdvdG8gb3V0X2N0eDsKIH0KIApAQCAt
MTUzOSw3ICsxNTM5LDcgQEAgaW50IGk5MTVfZ2VtX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQogZXJyX2d0OgogCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1
Y3RfbXV0ZXgpOwogCi0JaTkxNV9nZW1fc2V0X3dlZGdlZChkZXZfcHJpdik7CisJaW50ZWxfZ3Rf
c2V0X3dlZGdlZCgmZGV2X3ByaXYtPmd0KTsKIAlpOTE1X2dlbV9zdXNwZW5kKGRldl9wcml2KTsK
IAlpOTE1X2dlbV9zdXNwZW5kX2xhdGUoZGV2X3ByaXYpOwogCkBAIC0xNTgxLDEwICsxNTgxLDEw
IEBAIGludCBpOTE1X2dlbV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
IAkJICogd2VkZ2VkLiBCdXQgd2Ugb25seSB3YW50IHRvIGRvIHRoaXMgd2hlcmUgdGhlIEdQVSBp
cyBhbmdyeSwKIAkJICogZm9yIGFsbCBvdGhlciBmYWlsdXJlLCBzdWNoIGFzIGFuIGFsbG9jYXRp
b24gZmFpbHVyZSwgYmFpbC4KIAkJICovCi0JCWlmICghaTkxNV9yZXNldF9mYWlsZWQoZGV2X3By
aXYpKSB7CisJCWlmICghaW50ZWxfZ3RfaXNfd2VkZ2VkKCZkZXZfcHJpdi0+Z3QpKSB7CiAJCQlp
OTE1X2xvYWRfZXJyb3IoZGV2X3ByaXYsCiAJCQkJCSJGYWlsZWQgdG8gaW5pdGlhbGl6ZSBHUFUs
IGRlY2xhcmluZyBpdCB3ZWRnZWQhXG4iKTsKLQkJCWk5MTVfZ2VtX3NldF93ZWRnZWQoZGV2X3By
aXYpOworCQkJaW50ZWxfZ3Rfc2V0X3dlZGdlZCgmZGV2X3ByaXYtPmd0KTsKIAkJfQogCiAJCS8q
IE1pbmltYWwgYmFzaWMgcmVjb3ZlcnkgZm9yIEtNUyAqLwpAQCAtMTY2NiwxMSArMTY2Niw2IEBA
IGludCBpOTE1X2dlbV9pbml0X2Vhcmx5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKIAlpOTE1X2dlbV9pbml0X19tbShkZXZfcHJpdik7CiAJaTkxNV9nZW1faW5pdF9fcG0oZGV2
X3ByaXYpOwogCi0JaW5pdF93YWl0cXVldWVfaGVhZCgmZGV2X3ByaXYtPmdwdV9lcnJvci53YWl0
X3F1ZXVlKTsKLQlpbml0X3dhaXRxdWV1ZV9oZWFkKCZkZXZfcHJpdi0+Z3B1X2Vycm9yLnJlc2V0
X3F1ZXVlKTsKLQltdXRleF9pbml0KCZkZXZfcHJpdi0+Z3B1X2Vycm9yLndlZGdlX211dGV4KTsK
LQlpbml0X3NyY3Vfc3RydWN0KCZkZXZfcHJpdi0+Z3B1X2Vycm9yLnJlc2V0X2JhY2tvZmZfc3Jj
dSk7Ci0KIAlhdG9taWNfc2V0KCZkZXZfcHJpdi0+bW0uYnNkX2VuZ2luZV9kaXNwYXRjaF9pbmRl
eCwgMCk7CiAKIAlzcGluX2xvY2tfaW5pdCgmZGV2X3ByaXYtPmZiX3RyYWNraW5nLmxvY2spOwpA
QCAtMTY4OSw3ICsxNjg0LDcgQEAgdm9pZCBpOTE1X2dlbV9jbGVhbnVwX2Vhcmx5KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlHRU1fQlVHX09OKGF0b21pY19yZWFkKCZkZXZf
cHJpdi0+bW0uZnJlZV9jb3VudCkpOwogCVdBUk5fT04oZGV2X3ByaXYtPm1tLnNocmlua19jb3Vu
dCk7CiAKLQljbGVhbnVwX3NyY3Vfc3RydWN0KCZkZXZfcHJpdi0+Z3B1X2Vycm9yLnJlc2V0X2Jh
Y2tvZmZfc3JjdSk7CisJaW50ZWxfZ3RfY2xlYW51cF9lYXJseSgmZGV2X3ByaXYtPmd0KTsKIAog
CWk5MTVfZ2VtZnNfZmluaShkZXZfcHJpdik7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2dwdV9lcnJvci5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVf
ZXJyb3IuaAppbmRleCAyZWNkMGM2YTFjOTQuLjdkZmJmZGE0ODczMyAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2dwdV9lcnJvci5oCkBAIC03LDYgKzcsNyBAQAogI2lmbmRlZiBfSTkxNV9HUFVf
RVJST1JfSF8KICNkZWZpbmUgX0k5MTVfR1BVX0VSUk9SX0hfCiAKKyNpbmNsdWRlIDxsaW51eC9h
dG9taWMuaD4KICNpbmNsdWRlIDxsaW51eC9rcmVmLmg+CiAjaW5jbHVkZSA8bGludXgva3RpbWUu
aD4KICNpbmNsdWRlIDxsaW51eC9zY2hlZC5oPgpAQCAtMTgwLDEyICsxODEsNiBAQCBzdHJ1Y3Qg
aTkxNV9ncHVfc3RhdGUgewogfTsKIAogc3RydWN0IGk5MTVfZ3B1X2Vycm9yIHsKLQkvKiBGb3Ig
aGFuZ2NoZWNrIHRpbWVyICovCi0jZGVmaW5lIERSTV9JOTE1X0hBTkdDSEVDS19QRVJJT0QgMTUw
MCAvKiBpbiBtcyAqLwotI2RlZmluZSBEUk1fSTkxNV9IQU5HQ0hFQ0tfSklGRklFUyBtc2Vjc190
b19qaWZmaWVzKERSTV9JOTE1X0hBTkdDSEVDS19QRVJJT0QpCi0KLQlzdHJ1Y3QgZGVsYXllZF93
b3JrIGhhbmdjaGVja193b3JrOwotCiAJLyogRm9yIHJlc2V0IGFuZCBlcnJvcl9zdGF0ZSBoYW5k
bGluZy4gKi8KIAlzcGlubG9ja190IGxvY2s7CiAJLyogUHJvdGVjdGVkIGJ5IHRoZSBhYm92ZSBk
ZXYtPmdwdV9lcnJvci5sb2NrLiAqLwpAQCAtMTkzLDUyICsxODgsMTEgQEAgc3RydWN0IGk5MTVf
Z3B1X2Vycm9yIHsKIAogCWF0b21pY190IHBlbmRpbmdfZmJfcGluOwogCi0JLyoqCi0JICogZmxh
Z3M6IENvbnRyb2wgdmFyaW91cyBzdGFnZXMgb2YgdGhlIEdQVSByZXNldAotCSAqCi0JICogI0k5
MTVfUkVTRVRfQkFDS09GRiAtIFdoZW4gd2Ugc3RhcnQgYSBnbG9iYWwgcmVzZXQsIHdlIG5lZWQg
dG8KLQkgKiBzZXJpYWxpc2Ugd2l0aCBhbnkgb3RoZXIgdXNlcnMgYXR0ZW1wdGluZyB0byBkbyB0
aGUgc2FtZSwgYW5kCi0JICogYW55IGdsb2JhbCByZXNvdXJjZXMgdGhhdCBtYXkgYmUgY2xvYmJl
ciBieSB0aGUgcmVzZXQgKHN1Y2ggYXMKLQkgKiBGRU5DRSByZWdpc3RlcnMpLgotCSAqCi0JICog
I0k5MTVfUkVTRVRfRU5HSU5FW251bV9lbmdpbmVzXSAtIFNpbmNlIHRoZSBkcml2ZXIgZG9lc24n
dCBuZWVkIHRvCi0JICogYWNxdWlyZSB0aGUgc3RydWN0X211dGV4IHRvIHJlc2V0IGFuIGVuZ2lu
ZSwgd2UgbmVlZCBhbiBleHBsaWNpdAotCSAqIGZsYWcgdG8gcHJldmVudCB0d28gY29uY3VycmVu
dCByZXNldCBhdHRlbXB0cyBpbiB0aGUgc2FtZSBlbmdpbmUuCi0JICogQXMgdGhlIG51bWJlciBv
ZiBlbmdpbmVzIGNvbnRpbnVlcyB0byBncm93LCBhbGxvY2F0ZSB0aGUgZmxhZ3MgZnJvbQotCSAq
IHRoZSBtb3N0IHNpZ25pZmljYW50IGJpdHMuCi0JICoKLQkgKiAjSTkxNV9XRURHRUQgLSBJZiBy
ZXNldCBmYWlscyBhbmQgd2UgY2FuIG5vIGxvbmdlciB1c2UgdGhlIEdQVSwKLQkgKiB3ZSBzZXQg
dGhlICNJOTE1X1dFREdFRCBiaXQuIFByaW9yIHRvIGNvbW1hbmQgc3VibWlzc2lvbiwgZS5nLgot
CSAqIGk5MTVfcmVxdWVzdF9hbGxvYygpLCB0aGlzIGJpdCBpcyBjaGVja2VkIGFuZCB0aGUgc2Vx
dWVuY2UKLQkgKiBhYm9ydGVkICh3aXRoIC1FSU8gcmVwb3J0ZWQgdG8gdXNlcnNwYWNlKSBpZiBz
ZXQuCi0JICovCi0JdW5zaWduZWQgbG9uZyBmbGFnczsKLSNkZWZpbmUgSTkxNV9SRVNFVF9CQUNL
T0ZGCTAKLSNkZWZpbmUgSTkxNV9SRVNFVF9NT0RFU0VUCTEKLSNkZWZpbmUgSTkxNV9SRVNFVF9F
TkdJTkUJMgotI2RlZmluZSBJOTE1X1dFREdFRAkJKEJJVFNfUEVSX0xPTkcgLSAxKQotCiAJLyoq
IE51bWJlciBvZiB0aW1lcyB0aGUgZGV2aWNlIGhhcyBiZWVuIHJlc2V0IChnbG9iYWwpICovCi0J
dTMyIHJlc2V0X2NvdW50OworCWF0b21pY190IHJlc2V0X2NvdW50OwogCiAJLyoqIE51bWJlciBv
ZiB0aW1lcyBhbiBlbmdpbmUgaGFzIGJlZW4gcmVzZXQgKi8KLQl1MzIgcmVzZXRfZW5naW5lX2Nv
dW50W0k5MTVfTlVNX0VOR0lORVNdOwotCi0Jc3RydWN0IG11dGV4IHdlZGdlX211dGV4OyAvKiBz
ZXJpYWxpc2VzIHdlZGdpbmcvdW53ZWRnaW5nICovCi0KLQkvKioKLQkgKiBXYWl0cXVldWUgdG8g
c2lnbmFsIHdoZW4gYSBoYW5nIGlzIGRldGVjdGVkLiBVc2VkIHRvIGZvciB3YWl0ZXJzCi0JICog
dG8gcmVsZWFzZSB0aGUgc3RydWN0X211dGV4IGZvciB0aGUgcmVzZXQgdG8gcHJvY2VkZS4KLQkg
Ki8KLQl3YWl0X3F1ZXVlX2hlYWRfdCB3YWl0X3F1ZXVlOwotCi0JLyoqCi0JICogV2FpdHF1ZXVl
IHRvIHNpZ25hbCB3aGVuIHRoZSByZXNldCBoYXMgY29tcGxldGVkLiBVc2VkIGJ5IGNsaWVudHMK
LQkgKiB0aGF0IHdhaXQgZm9yIGRldl9wcml2LT5tbS53ZWRnZWQgdG8gc2V0dGxlLgotCSAqLwot
CXdhaXRfcXVldWVfaGVhZF90IHJlc2V0X3F1ZXVlOwotCi0Jc3RydWN0IHNyY3Vfc3RydWN0IHJl
c2V0X2JhY2tvZmZfc3JjdTsKKwlhdG9taWNfdCByZXNldF9lbmdpbmVfY291bnRbSTkxNV9OVU1f
RU5HSU5FU107CiB9OwogCiBzdHJ1Y3QgZHJtX2k5MTVfZXJyb3Jfc3RhdGVfYnVmIHsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMKaW5kZXggMmFhYmVkOGVkNTk0Li5kOThmM2QyNGVmM2Mg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jCkBAIC0xMzY5LDggKzEzNjksNyBAQCBs
b25nIGk5MTVfcmVxdWVzdF93YWl0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAogCSAqIHNlcmlh
bGlzZSB3YWl0L3Jlc2V0IHdpdGggYW4gZXhwbGljaXQgbG9jaywgd2UgZG8gd2FudAogCSAqIGxv
Y2tkZXAgdG8gZGV0ZWN0IHBvdGVudGlhbCBkZXBlbmRlbmN5IGN5Y2xlcy4KIAkgKi8KLQltdXRl
eF9hY3F1aXJlKCZycS0+aTkxNS0+Z3B1X2Vycm9yLndlZGdlX211dGV4LmRlcF9tYXAsCi0JCSAg
ICAgIDAsIDAsIF9USElTX0lQXyk7CisJbXV0ZXhfYWNxdWlyZSgmcnEtPmVuZ2luZS0+Z3QtPnJl
c2V0Lm11dGV4LmRlcF9tYXAsIDAsIDAsIF9USElTX0lQXyk7CiAKIAkvKgogCSAqIE9wdGltaXN0
aWMgc3BpbiBiZWZvcmUgdG91Y2hpbmcgSVJRcy4KQEAgLTE0NDgsNyArMTQ0Nyw3IEBAIGxvbmcg
aTkxNV9yZXF1ZXN0X3dhaXQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCiAJZG1hX2ZlbmNlX3Jl
bW92ZV9jYWxsYmFjaygmcnEtPmZlbmNlLCAmd2FpdC5jYik7CiAKIG91dDoKLQltdXRleF9yZWxl
YXNlKCZycS0+aTkxNS0+Z3B1X2Vycm9yLndlZGdlX211dGV4LmRlcF9tYXAsIDAsIF9USElTX0lQ
Xyk7CisJbXV0ZXhfcmVsZWFzZSgmcnEtPmVuZ2luZS0+Z3QtPnJlc2V0Lm11dGV4LmRlcF9tYXAs
IDAsIF9USElTX0lQXyk7CiAJdHJhY2VfaTkxNV9yZXF1ZXN0X3dhaXRfZW5kKHJxKTsKIAlyZXR1
cm4gdGltZW91dDsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1
Y19zdWJtaXNzaW9uLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfc3VibWlzc2lv
bi5jCmluZGV4IDEyYzIyMzU5ZmRhYy4uYWUyOWY3M2QyYTBmIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfc3VibWlzc2lvbi5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX2d1Y19zdWJtaXNzaW9uLmMKQEAgLTg3Niw3ICs4NzYsNyBAQCBzdGF0aWMg
dm9pZCBndWNfcmVzZXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBib29sIHN0YWxs
ZWQpCiAJaWYgKCFpOTE1X3JlcXVlc3Rfc3RhcnRlZChycSkpCiAJCXN0YWxsZWQgPSBmYWxzZTsK
IAotCWk5MTVfcmVzZXRfcmVxdWVzdChycSwgc3RhbGxlZCk7CisJX19pOTE1X3JlcXVlc3RfcmVz
ZXQocnEsIHN0YWxsZWQpOwogCWludGVsX2xyX2NvbnRleHRfcmVzZXQoZW5naW5lLCBycS0+aHdf
Y29udGV4dCwgcnEtPmhlYWQsIHN0YWxsZWQpOwogCiBvdXRfdW5sb2NrOgpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdWMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX3VjLmMKaW5kZXggZmRmMDBmMWViYjU3Li5iMGU4M2U5MWVhNmYgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3VjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfdWMuYwpAQCAtMzgsNyArMzgsNyBAQCBzdGF0aWMgaW50IF9faW50ZWxfdWNfcmVzZXRf
aHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCWludCByZXQ7CiAJdTMyIGd1
Y19zdGF0dXM7CiAKLQlyZXQgPSBpbnRlbF9yZXNldF9ndWMoZGV2X3ByaXYpOworCXJldCA9IGlu
dGVsX3Jlc2V0X2d1YygmZGV2X3ByaXYtPmd0KTsKIAlpZiAocmV0KSB7CiAJCURSTV9FUlJPUigi
RmFpbGVkIHRvIHJlc2V0IEd1QywgcmV0ID0gJWRcbiIsIHJldCk7CiAJCXJldHVybiByZXQ7CmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9hY3RpdmUuYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2FjdGl2ZS5jCmluZGV4IDg0ZmNl
Mzc5YzBkZS4uZTVjZDVkNDdlMzgwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9z
ZWxmdGVzdHMvaTkxNV9hY3RpdmUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVz
dHMvaTkxNV9hY3RpdmUuYwpAQCAtNyw2ICs3LDcgQEAKICNpbmNsdWRlIDxsaW51eC9rcmVmLmg+
CiAKICNpbmNsdWRlICJnZW0vaTkxNV9nZW1fcG0uaCIKKyNpbmNsdWRlICJndC9pbnRlbF9ndC5o
IgogCiAjaW5jbHVkZSAiaTkxNV9zZWxmdGVzdC5oIgogCkBAIC0yMjEsNyArMjIyLDcgQEAgaW50
IGk5MTVfYWN0aXZlX2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQogCQlTVUJURVNUKGxpdmVfYWN0aXZlX3JldGlyZSksCiAJfTsKIAotCWlmIChpOTE1X3Rlcm1p
bmFsbHlfd2VkZ2VkKGk5MTUpKQorCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoJmk5MTUtPmd0KSkK
IAkJcmV0dXJuIDA7CiAKIAlyZXR1cm4gaTkxNV9zdWJ0ZXN0cyh0ZXN0cywgaTkxNSk7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW0uYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbS5jCmluZGV4IGI4ZmZhZTQ4MTczMC4u
YmI2ZGQ1NGE2ZmYzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMv
aTkxNV9nZW0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW0u
YwpAQCAtOCw2ICs4LDcgQEAKIAogI2luY2x1ZGUgImdlbS9zZWxmdGVzdHMvaWd0X2dlbV91dGls
cy5oIgogI2luY2x1ZGUgImdlbS9zZWxmdGVzdHMvbW9ja19jb250ZXh0LmgiCisjaW5jbHVkZSAi
Z3QvaW50ZWxfZ3QuaCIKIAogI2luY2x1ZGUgImk5MTVfc2VsZnRlc3QuaCIKIApAQCAtMjA2LDcg
KzIwNyw3IEBAIGludCBpOTE1X2dlbV9saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKIAkJU1VCVEVTVChpZ3RfZ2VtX2hpYmVybmF0ZSksCiAJfTsKIAotCWlmIChp
OTE1X3Rlcm1pbmFsbHlfd2VkZ2VkKGk5MTUpKQorCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoJmk5
MTUtPmd0KSkKIAkJcmV0dXJuIDA7CiAKIAlyZXR1cm4gaTkxNV9saXZlX3N1YnRlc3RzKHRlc3Rz
LCBpOTE1KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1
X2dlbV9ldmljdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2V2
aWN0LmMKaW5kZXggYTNjYjBhYWRlNmYxLi5iNjQ0OWQwYThjMTcgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ldmljdC5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ldmljdC5jCkBAIC0yNSw2ICsyNSw3IEBA
CiAjaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX3BtLmgiCiAjaW5jbHVkZSAiZ2VtL3NlbGZ0ZXN0cy9p
Z3RfZ2VtX3V0aWxzLmgiCiAjaW5jbHVkZSAiZ2VtL3NlbGZ0ZXN0cy9tb2NrX2NvbnRleHQuaCIK
KyNpbmNsdWRlICJndC9pbnRlbF9ndC5oIgogCiAjaW5jbHVkZSAiaTkxNV9zZWxmdGVzdC5oIgog
CkBAIC01NTcsNyArNTU4LDcgQEAgaW50IGk5MTVfZ2VtX2V2aWN0X2xpdmVfc2VsZnRlc3RzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCQlTVUJURVNUKGlndF9ldmljdF9jb250ZXh0
cyksCiAJfTsKIAotCWlmIChpOTE1X3Rlcm1pbmFsbHlfd2VkZ2VkKGk5MTUpKQorCWlmIChpbnRl
bF9ndF9pc193ZWRnZWQoJmk5MTUtPmd0KSkKIAkJcmV0dXJuIDA7CiAKIAlyZXR1cm4gaTkxNV9z
dWJ0ZXN0cyh0ZXN0cywgaTkxNSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9z
ZWxmdGVzdHMvaTkxNV9yZXF1ZXN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMv
aTkxNV9yZXF1ZXN0LmMKaW5kZXggMWJiZmM0M2Q0YTllLi44NmMyOTk2NjM5MzQgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3JlcXVlc3QuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9yZXF1ZXN0LmMKQEAgLTM4MCw3ICsz
ODAsNyBAQCBzdGF0aWMgaW50IF9faWd0X2JyZWFkY3J1bWJzX3Ntb2tldGVzdCh2b2lkICphcmcp
CiAJCQkgICAgICAgdC0+ZW5naW5lLT5uYW1lKTsKIAkJCUdFTV9UUkFDRV9EVU1QKCk7CiAKLQkJ
CWk5MTVfZ2VtX3NldF93ZWRnZWQodC0+ZW5naW5lLT5pOTE1KTsKKwkJCWludGVsX2d0X3NldF93
ZWRnZWQodC0+ZW5naW5lLT5ndCk7CiAJCQlHRU1fQlVHX09OKCFpOTE1X3JlcXVlc3RfY29tcGxl
dGVkKHJxKSk7CiAJCQlpOTE1X3N3X2ZlbmNlX3dhaXQod2FpdCk7CiAJCQllcnIgPSAtRUlPOwpA
QCAtMTIzNCw3ICsxMjM0LDcgQEAgaW50IGk5MTVfcmVxdWVzdF9saXZlX3NlbGZ0ZXN0cyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkJU1VCVEVTVChsaXZlX2JyZWFkY3J1bWJzX3Nt
b2tldGVzdCksCiAJfTsKIAotCWlmIChpOTE1X3Rlcm1pbmFsbHlfd2VkZ2VkKGk5MTUpKQorCWlm
IChpbnRlbF9ndF9pc193ZWRnZWQoJmk5MTUtPmd0KSkKIAkJcmV0dXJuIDA7CiAKIAlyZXR1cm4g
aTkxNV9zdWJ0ZXN0cyh0ZXN0cywgaTkxNSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9zZWxmdGVzdHMvaTkxNV9zZWxmdGVzdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2Vs
ZnRlc3RzL2k5MTVfc2VsZnRlc3QuYwppbmRleCBmNDZjY2Y4MTdhZDUuLjViODdmZjczYjQ5YSAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfc2VsZnRlc3Qu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9zZWxmdGVzdC5jCkBA
IC0yNTYsNyArMjU2LDcgQEAgaW50IF9faTkxNV9saXZlX3NldHVwKHZvaWQgKmRhdGEpCiB7CiAJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkYXRhOwogCi0JcmV0dXJuIGk5MTVfdGVy
bWluYWxseV93ZWRnZWQoaTkxNSk7CisJcmV0dXJuIGludGVsX2d0X3Rlcm1pbmFsbHlfd2VkZ2Vk
KCZpOTE1LT5ndCk7CiB9CiAKIGludCBfX2k5MTVfbGl2ZV90ZWFyZG93bihpbnQgZXJyLCB2b2lk
ICpkYXRhKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2lndF9m
bHVzaF90ZXN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaWd0X2ZsdXNoX3Rl
c3QuYwppbmRleCA1YmZkMWIyNjI2YTIuLmQzYjVlYjQwMmQzMyAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2lndF9mbHVzaF90ZXN0LmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvc2VsZnRlc3RzL2lndF9mbHVzaF90ZXN0LmMKQEAgLTUsNiArNSw3IEBACiAg
Ki8KIAogI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9jb250ZXh0LmgiCisjaW5jbHVkZSAiZ3QvaW50
ZWxfZ3QuaCIKIAogI2luY2x1ZGUgImk5MTVfZHJ2LmgiCiAjaW5jbHVkZSAiaTkxNV9zZWxmdGVz
dC5oIgpAQCAtMTMsNyArMTQsNyBAQAogCiBpbnQgaWd0X2ZsdXNoX3Rlc3Qoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsIHVuc2lnbmVkIGludCBmbGFncykKIHsKLQlpbnQgcmV0ID0gaTkx
NV90ZXJtaW5hbGx5X3dlZGdlZChpOTE1KSA/IC1FSU8gOiAwOworCWludCByZXQgPSBpbnRlbF9n
dF9pc193ZWRnZWQoJmk5MTUtPmd0KSA/IC1FSU8gOiAwOwogCWludCByZXBlYXQgPSAhIShmbGFn
cyAmIEk5MTVfV0FJVF9MT0NLRUQpOwogCiAJY29uZF9yZXNjaGVkKCk7CkBAIC0yNyw3ICsyOCw3
IEBAIGludCBpZ3RfZmx1c2hfdGVzdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdW5z
aWduZWQgaW50IGZsYWdzKQogCQkJCSAgX19idWlsdGluX3JldHVybl9hZGRyZXNzKDApKTsKIAkJ
CUdFTV9UUkFDRV9EVU1QKCk7CiAKLQkJCWk5MTVfZ2VtX3NldF93ZWRnZWQoaTkxNSk7CisJCQlp
bnRlbF9ndF9zZXRfd2VkZ2VkKCZpOTE1LT5ndCk7CiAJCQlyZXBlYXQgPSAwOwogCQkJcmV0ID0g
LUVJTzsKIAkJfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2ln
dF9yZXNldC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2lndF9yZXNldC5jCmlu
ZGV4IDU4N2RmNmZkNGZmZS4uN2VjOGY4YjA0OWM2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9zZWxmdGVzdHMvaWd0X3Jlc2V0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
c2VsZnRlc3RzL2lndF9yZXNldC5jCkBAIC03LDQ3ICs3LDQ1IEBACiAjaW5jbHVkZSAiaWd0X3Jl
c2V0LmgiCiAKICNpbmNsdWRlICJndC9pbnRlbF9lbmdpbmUuaCIKKyNpbmNsdWRlICJndC9pbnRl
bF9ndC5oIgogCiAjaW5jbHVkZSAiLi4vaTkxNV9kcnYuaCIKIAotdm9pZCBpZ3RfZ2xvYmFsX3Jl
c2V0X2xvY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCit2b2lkIGlndF9nbG9iYWxf
cmVzZXRfbG9jayhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewogCXN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZTsKIAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKIAotCXByX2RlYnVnKCIlczog
Y3VycmVudCBncHVfZXJyb3I9JTA4bHhcbiIsCi0JCSBfX2Z1bmNfXywgaTkxNS0+Z3B1X2Vycm9y
LmZsYWdzKTsKKwlwcl9kZWJ1ZygiJXM6IGN1cnJlbnQgZ3B1X2Vycm9yPSUwOGx4XG4iLCBfX2Z1
bmNfXywgZ3QtPnJlc2V0LmZsYWdzKTsKIAotCXdoaWxlICh0ZXN0X2FuZF9zZXRfYml0KEk5MTVf
UkVTRVRfQkFDS09GRiwgJmk5MTUtPmdwdV9lcnJvci5mbGFncykpCi0JCXdhaXRfZXZlbnQoaTkx
NS0+Z3B1X2Vycm9yLnJlc2V0X3F1ZXVlLAotCQkJICAgIXRlc3RfYml0KEk5MTVfUkVTRVRfQkFD
S09GRiwKLQkJCQkgICAgICZpOTE1LT5ncHVfZXJyb3IuZmxhZ3MpKTsKKwl3aGlsZSAodGVzdF9h
bmRfc2V0X2JpdChJOTE1X1JFU0VUX0JBQ0tPRkYsICZndC0+cmVzZXQuZmxhZ3MpKQorCQl3YWl0
X2V2ZW50KGd0LT5yZXNldC5xdWV1ZSwKKwkJCSAgICF0ZXN0X2JpdChJOTE1X1JFU0VUX0JBQ0tP
RkYsICZndC0+cmVzZXQuZmxhZ3MpKTsKIAotCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUs
IGlkKSB7CisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QtPmk5MTUsIGlkKSB7CiAJCXdoaWxl
ICh0ZXN0X2FuZF9zZXRfYml0KEk5MTVfUkVTRVRfRU5HSU5FICsgaWQsCi0JCQkJCSZpOTE1LT5n
cHVfZXJyb3IuZmxhZ3MpKQotCQkJd2FpdF9vbl9iaXQoJmk5MTUtPmdwdV9lcnJvci5mbGFncywK
LQkJCQkgICAgSTkxNV9SRVNFVF9FTkdJTkUgKyBpZCwKKwkJCQkJJmd0LT5yZXNldC5mbGFncykp
CisJCQl3YWl0X29uX2JpdCgmZ3QtPnJlc2V0LmZsYWdzLCBJOTE1X1JFU0VUX0VOR0lORSArIGlk
LAogCQkJCSAgICBUQVNLX1VOSU5URVJSVVBUSUJMRSk7CiAJfQogfQogCi12b2lkIGlndF9nbG9i
YWxfcmVzZXRfdW5sb2NrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQordm9pZCBpZ3Rf
Z2xvYmFsX3Jlc2V0X3VubG9jayhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewogCXN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZTsKIAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKIAotCWZvcl9l
YWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKQotCQljbGVhcl9iaXQoSTkxNV9SRVNFVF9FTkdJ
TkUgKyBpZCwgJmk5MTUtPmdwdV9lcnJvci5mbGFncyk7CisJZm9yX2VhY2hfZW5naW5lKGVuZ2lu
ZSwgZ3QtPmk5MTUsIGlkKQorCQljbGVhcl9iaXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBpZCwgJmd0
LT5yZXNldC5mbGFncyk7CiAKLQljbGVhcl9iaXQoSTkxNV9SRVNFVF9CQUNLT0ZGLCAmaTkxNS0+
Z3B1X2Vycm9yLmZsYWdzKTsKLQl3YWtlX3VwX2FsbCgmaTkxNS0+Z3B1X2Vycm9yLnJlc2V0X3F1
ZXVlKTsKKwljbGVhcl9iaXQoSTkxNV9SRVNFVF9CQUNLT0ZGLCAmZ3QtPnJlc2V0LmZsYWdzKTsK
Kwl3YWtlX3VwX2FsbCgmZ3QtPnJlc2V0LnF1ZXVlKTsKIH0KIAotYm9vbCBpZ3RfZm9yY2VfcmVz
ZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCitib29sIGlndF9mb3JjZV9yZXNldChz
dHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewotCWk5MTVfZ2VtX3NldF93ZWRnZWQoaTkxNSk7Ci0JaTkx
NV9yZXNldChpOTE1LCAwLCBOVUxMKTsKKwlpbnRlbF9ndF9zZXRfd2VkZ2VkKGd0KTsKKwlpbnRl
bF9ndF9yZXNldChndCwgMCwgTlVMTCk7CiAKLQlyZXR1cm4gIWk5MTVfcmVzZXRfZmFpbGVkKGk5
MTUpOworCXJldHVybiAhaW50ZWxfZ3RfaXNfd2VkZ2VkKGd0KTsKIH0KZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pZ3RfcmVzZXQuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L3NlbGZ0ZXN0cy9pZ3RfcmVzZXQuaAppbmRleCAzNjNiZDg1M2U1MGYuLjg1MTg3M2I2
N2FiMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2lndF9yZXNl
dC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pZ3RfcmVzZXQuaApAQCAt
NywxMCArNywxMiBAQAogI2lmbmRlZiBfX0k5MTVfU0VMRlRFU1RTX0lHVF9SRVNFVF9IX18KICNk
ZWZpbmUgX19JOTE1X1NFTEZURVNUU19JR1RfUkVTRVRfSF9fCiAKLSNpbmNsdWRlICIuLi9pOTE1
X2Rydi5oIgorI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CiAKLXZvaWQgaWd0X2dsb2JhbF9yZXNl
dF9sb2NrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKLXZvaWQgaWd0X2dsb2JhbF9y
ZXNldF91bmxvY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwotYm9vbCBpZ3RfZm9y
Y2VfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOworc3RydWN0IGludGVsX2d0
OworCit2b2lkIGlndF9nbG9iYWxfcmVzZXRfbG9jayhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKK3Zv
aWQgaWd0X2dsb2JhbF9yZXNldF91bmxvY2soc3RydWN0IGludGVsX2d0ICpndCk7Citib29sIGln
dF9mb3JjZV9yZXNldChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIAogI2VuZGlmCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaWd0X3dlZGdlX21lLmggYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaWd0X3dlZGdlX21lLmgKZGVsZXRlZCBmaWxlIG1vZGUg
MTAwNjQ0CmluZGV4IDA4ZTVmZjExYmJkOS4uMDAwMDAwMDAwMDAwCi0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L3NlbGZ0ZXN0cy9pZ3Rfd2VkZ2VfbWUuaAorKysgL2Rldi9udWxsCkBAIC0xLDU4
ICswLDAgQEAKLS8qCi0gKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCi0gKgotICogQ29w
eXJpZ2h0IMKpIDIwMTggSW50ZWwgQ29ycG9yYXRpb24KLSAqLwotCi0jaWZuZGVmIElHVF9XRURH
RV9NRV9ICi0jZGVmaW5lIElHVF9XRURHRV9NRV9ICi0KLSNpbmNsdWRlIDxsaW51eC93b3JrcXVl
dWUuaD4KLQotI2luY2x1ZGUgIi4uL2k5MTVfZ2VtLmgiCi0KLXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlOwotCi1zdHJ1Y3QgaWd0X3dlZGdlX21lIHsKLQlzdHJ1Y3QgZGVsYXllZF93b3JrIHdvcms7
Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTU7Ci0JY29uc3QgY2hhciAqbmFtZTsKLX07
Ci0KLXN0YXRpYyB2b2lkIF9faWd0X3dlZGdlX21lKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykK
LXsKLQlzdHJ1Y3QgaWd0X3dlZGdlX21lICp3ID0gY29udGFpbmVyX29mKHdvcmssIHR5cGVvZigq
dyksIHdvcmsud29yayk7Ci0KLQlwcl9lcnIoIiVzIHRpbWVkIG91dCwgY2FuY2VsbGluZyB0ZXN0
LlxuIiwgdy0+bmFtZSk7Ci0KLQlHRU1fVFJBQ0UoIiVzIHRpbWVkIG91dC5cbiIsIHctPm5hbWUp
OwotCUdFTV9UUkFDRV9EVU1QKCk7Ci0KLQlpOTE1X2dlbV9zZXRfd2VkZ2VkKHctPmk5MTUpOwot
fQotCi1zdGF0aWMgdm9pZCBfX2lndF9pbml0X3dlZGdlKHN0cnVjdCBpZ3Rfd2VkZ2VfbWUgKncs
Ci0JCQkgICAgIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAotCQkJICAgICBsb25nIHRp
bWVvdXQsCi0JCQkgICAgIGNvbnN0IGNoYXIgKm5hbWUpCi17Ci0Jdy0+aTkxNSA9IGk5MTU7Ci0J
dy0+bmFtZSA9IG5hbWU7Ci0KLQlJTklUX0RFTEFZRURfV09SS19PTlNUQUNLKCZ3LT53b3JrLCBf
X2lndF93ZWRnZV9tZSk7Ci0Jc2NoZWR1bGVfZGVsYXllZF93b3JrKCZ3LT53b3JrLCB0aW1lb3V0
KTsKLX0KLQotc3RhdGljIHZvaWQgX19pZ3RfZmluaV93ZWRnZShzdHJ1Y3QgaWd0X3dlZGdlX21l
ICp3KQotewotCWNhbmNlbF9kZWxheWVkX3dvcmtfc3luYygmdy0+d29yayk7Ci0JZGVzdHJveV9k
ZWxheWVkX3dvcmtfb25fc3RhY2soJnctPndvcmspOwotCXctPmk5MTUgPSBOVUxMOwotfQotCi0j
ZGVmaW5lIGlndF93ZWRnZV9vbl90aW1lb3V0KFcsIERFViwgVElNRU9VVCkJCQkJXAotCWZvciAo
X19pZ3RfaW5pdF93ZWRnZSgoVyksIChERVYpLCAoVElNRU9VVCksIF9fZnVuY19fKTsJCVwKLQkg
ICAgIChXKS0+aTkxNTsJCQkJCQkJXAotCSAgICAgX19pZ3RfZmluaV93ZWRnZSgoVykpKQotCi0j
ZW5kaWYgLyogSUdUX1dFREdFX01FX0ggKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L3NlbGZ0ZXN0cy9tb2NrX2dlbV9kZXZpY2UuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3Nl
bGZ0ZXN0cy9tb2NrX2dlbV9kZXZpY2UuYwppbmRleCAyNzQxODA1YjU2YzIuLmZkNGNjNDgwOWVi
OCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfZ2VtX2Rl
dmljZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2dlbV9kZXZp
Y2UuYwpAQCAtMTgzLDExICsxODMsNiBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqbW9ja19n
ZW1fZGV2aWNlKHZvaWQpCiAJaW50ZWxfZ3RfaW5pdF9lYXJseSgmaTkxNS0+Z3QsIGk5MTUpOwog
CWF0b21pY19pbmMoJmk5MTUtPmd0Lndha2VyZWYuY291bnQpOyAvKiBkaXNhYmxlOyBubyBodyBz
dXBwb3J0ICovCiAKLQlpbml0X3dhaXRxdWV1ZV9oZWFkKCZpOTE1LT5ncHVfZXJyb3Iud2FpdF9x
dWV1ZSk7Ci0JaW5pdF93YWl0cXVldWVfaGVhZCgmaTkxNS0+Z3B1X2Vycm9yLnJlc2V0X3F1ZXVl
KTsKLQlpbml0X3NyY3Vfc3RydWN0KCZpOTE1LT5ncHVfZXJyb3IucmVzZXRfYmFja29mZl9zcmN1
KTsKLQltdXRleF9pbml0KCZpOTE1LT5ncHVfZXJyb3Iud2VkZ2VfbXV0ZXgpOwotCiAJaTkxNS0+
d3EgPSBhbGxvY19vcmRlcmVkX3dvcmtxdWV1ZSgibW9jayIsIDApOwogCWlmICghaTkxNS0+d3Ep
CiAJCWdvdG8gZXJyX2RydjsKLS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlz
dHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4v
bGlzdGluZm8vaW50ZWwtZ2Z4

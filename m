Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 4623E80B00
	for <lists+intel-gfx@lfdr.de>; Sun,  4 Aug 2019 14:48:36 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 5417989F85;
	Sun,  4 Aug 2019 12:48:34 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 07FEA89F85
 for <intel-gfx@lists.freedesktop.org>; Sun,  4 Aug 2019 12:48:31 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17865824-1500050 
 for <intel-gfx@lists.freedesktop.org>; Sun, 04 Aug 2019 13:48:26 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Sun,  4 Aug 2019 13:48:26 +0100
Message-Id: <20190804124826.30272-2-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0.rc1
In-Reply-To: <20190804124826.30272-1-chris@chris-wilson.co.uk>
References: <20190804124826.30272-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [CI 2/2] drm/i915: Replace struct_mutex for batch pool
 serialisation
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

U3dpdGNoIHRvIHRyYWNraW5nIGFjdGl2aXR5IHZpYSBpOTE1X2FjdGl2ZSBvbiBpbmRpdmlkdWFs
IG5vZGVzLCBvbmx5CmtlZXBpbmcgYSBsaXN0IG9mIHJldGlyZWQgb2JqZWN0cyBpbiB0aGUgY2Fj
aGUsIGFuZCByZWFwaW5nIHRoZSBjYWNoZQp3aGVuIHRoZSBlbmdpbmUgaXRzZWxmIGlkbGVzLgoK
U2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+ClJl
dmlld2VkLWJ5OiBNYXR0aGV3IEF1bGQgPG1hdHRoZXcuYXVsZEBpbnRlbC5jb20+Ci0tLQogZHJp
dmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUgICAgICAgICAgICAgICAgIHwgICAyICstCiAuLi4v
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMgICAgfCAgNTggKysrLS0tCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMgICAgfCAgIDEgLQogLi4u
L2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0X3R5cGVzLmggIHwgICAxIC0KIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5jICAgICAgICB8ICAgNCArLQogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lLmggICAgICAgIHwgICAxIC0KIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jICAgICB8ICAxMSArLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMgICAgIHwgICAyICsKIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wb29sLmMgICB8IDE3NyArKysrKysrKysrKysrKysr
KysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wb29sLmggICB8ICAzNCAr
KysrCiAuLi4vZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wb29sX3R5cGVzLmggfCAgMjkg
KysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaCAgfCAgIDYg
Ky0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L21vY2tfZW5naW5lLmMgICAgICAgICB8ICAgMiAr
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYyAgICAgICAgICAgfCAgNjggLS0t
LS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fYmF0Y2hfcG9vbC5jICAgIHwgMTMy
IC0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2JhdGNoX3Bvb2wu
aCAgICB8ICAyNiAtLS0KIDE2IGZpbGVzIGNoYW5nZWQsIDI4OSBpbnNlcnRpb25zKCspLCAyNjUg
ZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfZW5naW5lX3Bvb2wuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2VuZ2luZV9wb29sLmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG9vbF90eXBlcy5oCiBkZWxldGUgbW9kZSAxMDA2
NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fYmF0Y2hfcG9vbC5jCiBkZWxldGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fYmF0Y2hfcG9vbC5oCgpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9NYWtlZmlsZQppbmRleCAzMzFiMTljYzgyNDcuLmExMDE2ODU4ZDAxNCAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvTWFrZWZpbGUKQEAgLTcxLDYgKzcxLDcgQEAgb2JqLXkgKz0gZ3QvCiBndC15ICs9IFwKIAln
dC9pbnRlbF9icmVhZGNydW1icy5vIFwKIAlndC9pbnRlbF9jb250ZXh0Lm8gXAorCWd0L2ludGVs
X2VuZ2luZV9wb29sLm8gXAogCWd0L2ludGVsX2VuZ2luZV9jcy5vIFwKIAlndC9pbnRlbF9lbmdp
bmVfcG0ubyBcCiAJZ3QvaW50ZWxfZ3QubyBcCkBAIC0xMjQsNyArMTI1LDYgQEAgaTkxNS15ICs9
IFwKIAkgICQoZ2VtLXkpIFwKIAkgIGk5MTVfYWN0aXZlLm8gXAogCSAgaTkxNV9jbWRfcGFyc2Vy
Lm8gXAotCSAgaTkxNV9nZW1fYmF0Y2hfcG9vbC5vIFwKIAkgIGk5MTVfZ2VtX2V2aWN0Lm8gXAog
CSAgaTkxNV9nZW1fZmVuY2VfcmVnLm8gXAogCSAgaTkxNV9nZW1fZ3R0Lm8gXApkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKaW5kZXggOGQ5MDQ5OGVh
ZjQ2Li4wYzhjOTA5NzQzZjEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9leGVjYnVmZmVyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX2V4ZWNidWZmZXIuYwpAQCAtMTYsNiArMTYsNyBAQAogCiAjaW5jbHVkZSAiZ2VtL2k5MTVf
Z2VtX2lvY3Rscy5oIgogI2luY2x1ZGUgImd0L2ludGVsX2NvbnRleHQuaCIKKyNpbmNsdWRlICJn
dC9pbnRlbF9lbmdpbmVfcG9vbC5oIgogI2luY2x1ZGUgImd0L2ludGVsX2d0LmgiCiAjaW5jbHVk
ZSAiZ3QvaW50ZWxfZ3RfcG0uaCIKIApAQCAtMTE5OCwyNSArMTE5OSwyNiBAQCBzdGF0aWMgaW50
IF9fcmVsb2NfZ3B1X2FsbG9jKHN0cnVjdCBpOTE1X2V4ZWNidWZmZXIgKmViLAogCQkJICAgICB1
bnNpZ25lZCBpbnQgbGVuKQogewogCXN0cnVjdCByZWxvY19jYWNoZSAqY2FjaGUgPSAmZWItPnJl
bG9jX2NhY2hlOwotCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CisJc3RydWN0IGlu
dGVsX2VuZ2luZV9wb29sX25vZGUgKnBvb2w7CiAJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7CiAJ
c3RydWN0IGk5MTVfdm1hICpiYXRjaDsKIAl1MzIgKmNtZDsKIAlpbnQgZXJyOwogCi0Jb2JqID0g
aTkxNV9nZW1fYmF0Y2hfcG9vbF9nZXQoJmViLT5lbmdpbmUtPmJhdGNoX3Bvb2wsIFBBR0VfU0la
RSk7Ci0JaWYgKElTX0VSUihvYmopKQotCQlyZXR1cm4gUFRSX0VSUihvYmopOworCXBvb2wgPSBp
bnRlbF9lbmdpbmVfcG9vbF9nZXQoJmViLT5lbmdpbmUtPnBvb2wsIFBBR0VfU0laRSk7CisJaWYg
KElTX0VSUihwb29sKSkKKwkJcmV0dXJuIFBUUl9FUlIocG9vbCk7CiAKLQljbWQgPSBpOTE1X2dl
bV9vYmplY3RfcGluX21hcChvYmosCisJY21kID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAocG9v
bC0+b2JqLAogCQkJCSAgICAgIGNhY2hlLT5oYXNfbGxjID8KIAkJCQkgICAgICBJOTE1X01BUF9G
T1JDRV9XQiA6CiAJCQkJICAgICAgSTkxNV9NQVBfRk9SQ0VfV0MpOwotCWk5MTVfZ2VtX29iamVj
dF91bnBpbl9wYWdlcyhvYmopOwotCWlmIChJU19FUlIoY21kKSkKLQkJcmV0dXJuIFBUUl9FUlIo
Y21kKTsKKwlpZiAoSVNfRVJSKGNtZCkpIHsKKwkJZXJyID0gUFRSX0VSUihjbWQpOworCQlnb3Rv
IG91dF9wb29sOworCX0KIAotCWJhdGNoID0gaTkxNV92bWFfaW5zdGFuY2Uob2JqLCB2bWEtPnZt
LCBOVUxMKTsKKwliYXRjaCA9IGk5MTVfdm1hX2luc3RhbmNlKHBvb2wtPm9iaiwgdm1hLT52bSwg
TlVMTCk7CiAJaWYgKElTX0VSUihiYXRjaCkpIHsKIAkJZXJyID0gUFRSX0VSUihiYXRjaCk7CiAJ
CWdvdG8gZXJyX3VubWFwOwpAQCAtMTIzMiw2ICsxMjM0LDEwIEBAIHN0YXRpYyBpbnQgX19yZWxv
Y19ncHVfYWxsb2Moc3RydWN0IGk5MTVfZXhlY2J1ZmZlciAqZWIsCiAJCWdvdG8gZXJyX3VucGlu
OwogCX0KIAorCWVyciA9IGludGVsX2VuZ2luZV9wb29sX21hcmtfYWN0aXZlKHBvb2wsIHJxKTsK
KwlpZiAoZXJyKQorCQlnb3RvIGVycl9yZXF1ZXN0OworCiAJZXJyID0gcmVsb2NfbW92ZV90b19n
cHUocnEsIHZtYSk7CiAJaWYgKGVycikKIAkJZ290byBlcnJfcmVxdWVzdDsKQEAgLTEyNTcsNyAr
MTI2Myw3IEBAIHN0YXRpYyBpbnQgX19yZWxvY19ncHVfYWxsb2Moc3RydWN0IGk5MTVfZXhlY2J1
ZmZlciAqZWIsCiAJY2FjaGUtPnJxX3NpemUgPSAwOwogCiAJLyogUmV0dXJuIHdpdGggYmF0Y2gg
bWFwcGluZyAoY21kKSBzdGlsbCBwaW5uZWQgKi8KLQlyZXR1cm4gMDsKKwlnb3RvIG91dF9wb29s
OwogCiBza2lwX3JlcXVlc3Q6CiAJaTkxNV9yZXF1ZXN0X3NraXAocnEsIGVycik7CkBAIC0xMjY2
LDcgKzEyNzIsOSBAQCBzdGF0aWMgaW50IF9fcmVsb2NfZ3B1X2FsbG9jKHN0cnVjdCBpOTE1X2V4
ZWNidWZmZXIgKmViLAogZXJyX3VucGluOgogCWk5MTVfdm1hX3VucGluKGJhdGNoKTsKIGVycl91
bm1hcDoKLQlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKG9iaik7CisJaTkxNV9nZW1fb2JqZWN0
X3VucGluX21hcChwb29sLT5vYmopOworb3V0X3Bvb2w6CisJaW50ZWxfZW5naW5lX3Bvb2xfcHV0
KHBvb2wpOwogCXJldHVybiBlcnI7CiB9CiAKQEAgLTIwMTAsMTggKzIwMTgsMTcgQEAgc3RhdGlj
IGludCBpOTE1X3Jlc2V0X2dlbjdfc29sX29mZnNldHMoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEp
CiAKIHN0YXRpYyBzdHJ1Y3QgaTkxNV92bWEgKmViX3BhcnNlKHN0cnVjdCBpOTE1X2V4ZWNidWZm
ZXIgKmViLCBib29sIGlzX21hc3RlcikKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAq
c2hhZG93X2JhdGNoX29iajsKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2xfbm9kZSAqcG9vbDsK
IAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKIAlpbnQgZXJyOwogCi0Jc2hhZG93X2JhdGNoX29iaiA9
IGk5MTVfZ2VtX2JhdGNoX3Bvb2xfZ2V0KCZlYi0+ZW5naW5lLT5iYXRjaF9wb29sLAotCQkJCQkJ
ICAgUEFHRV9BTElHTihlYi0+YmF0Y2hfbGVuKSk7Ci0JaWYgKElTX0VSUihzaGFkb3dfYmF0Y2hf
b2JqKSkKLQkJcmV0dXJuIEVSUl9DQVNUKHNoYWRvd19iYXRjaF9vYmopOworCXBvb2wgPSBpbnRl
bF9lbmdpbmVfcG9vbF9nZXQoJmViLT5lbmdpbmUtPnBvb2wsIGViLT5iYXRjaF9sZW4pOworCWlm
IChJU19FUlIocG9vbCkpCisJCXJldHVybiBFUlJfQ0FTVChwb29sKTsKIAogCWVyciA9IGludGVs
X2VuZ2luZV9jbWRfcGFyc2VyKGViLT5lbmdpbmUsCiAJCQkJICAgICAgZWItPmJhdGNoLT5vYmos
Ci0JCQkJICAgICAgc2hhZG93X2JhdGNoX29iaiwKKwkJCQkgICAgICBwb29sLT5vYmosCiAJCQkJ
ICAgICAgZWItPmJhdGNoX3N0YXJ0X29mZnNldCwKIAkJCQkgICAgICBlYi0+YmF0Y2hfbGVuLAog
CQkJCSAgICAgIGlzX21hc3Rlcik7CkBAIC0yMDMwLDEyICsyMDM3LDEyIEBAIHN0YXRpYyBzdHJ1
Y3QgaTkxNV92bWEgKmViX3BhcnNlKHN0cnVjdCBpOTE1X2V4ZWNidWZmZXIgKmViLCBib29sIGlz
X21hc3RlcikKIAkJCXZtYSA9IE5VTEw7CiAJCWVsc2UKIAkJCXZtYSA9IEVSUl9QVFIoZXJyKTsK
LQkJZ290byBvdXQ7CisJCWdvdG8gZXJyOwogCX0KIAotCXZtYSA9IGk5MTVfZ2VtX29iamVjdF9n
Z3R0X3BpbihzaGFkb3dfYmF0Y2hfb2JqLCBOVUxMLCAwLCAwLCAwKTsKKwl2bWEgPSBpOTE1X2dl
bV9vYmplY3RfZ2d0dF9waW4ocG9vbC0+b2JqLCBOVUxMLCAwLCAwLCAwKTsKIAlpZiAoSVNfRVJS
KHZtYSkpCi0JCWdvdG8gb3V0OworCQlnb3RvIGVycjsKIAogCWViLT52bWFbZWItPmJ1ZmZlcl9j
b3VudF0gPSBpOTE1X3ZtYV9nZXQodm1hKTsKIAllYi0+ZmxhZ3NbZWItPmJ1ZmZlcl9jb3VudF0g
PQpAQCAtMjA0Myw4ICsyMDUwLDExIEBAIHN0YXRpYyBzdHJ1Y3QgaTkxNV92bWEgKmViX3BhcnNl
KHN0cnVjdCBpOTE1X2V4ZWNidWZmZXIgKmViLCBib29sIGlzX21hc3RlcikKIAl2bWEtPmV4ZWNf
ZmxhZ3MgPSAmZWItPmZsYWdzW2ViLT5idWZmZXJfY291bnRdOwogCWViLT5idWZmZXJfY291bnQr
KzsKIAotb3V0OgotCWk5MTVfZ2VtX29iamVjdF91bnBpbl9wYWdlcyhzaGFkb3dfYmF0Y2hfb2Jq
KTsKKwl2bWEtPnByaXZhdGUgPSBwb29sOworCXJldHVybiB2bWE7CisKK2VycjoKKwlpbnRlbF9l
bmdpbmVfcG9vbF9wdXQocG9vbCk7CiAJcmV0dXJuIHZtYTsKIH0KIApAQCAtMjU4OCw2ICsyNTk4
LDggQEAgaTkxNV9nZW1fZG9fZXhlY2J1ZmZlcihzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAogCSAq
IHRvIGV4cGxpY2l0bHkgaG9sZCBhbm90aGVyIHJlZmVyZW5jZSBoZXJlLgogCSAqLwogCWViLnJl
cXVlc3QtPmJhdGNoID0gZWIuYmF0Y2g7CisJaWYgKGViLmJhdGNoLT5wcml2YXRlKQorCQlpbnRl
bF9lbmdpbmVfcG9vbF9tYXJrX2FjdGl2ZShlYi5iYXRjaC0+cHJpdmF0ZSwgZWIucmVxdWVzdCk7
CiAKIAl0cmFjZV9pOTE1X3JlcXVlc3RfcXVldWUoZWIucmVxdWVzdCwgZWIuYmF0Y2hfZmxhZ3Mp
OwogCWVyciA9IGViX3N1Ym1pdCgmZWIpOwpAQCAtMjYxMiw2ICsyNjI0LDggQEAgaTkxNV9nZW1f
ZG9fZXhlY2J1ZmZlcihzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAogZXJyX2JhdGNoX3VucGluOgog
CWlmIChlYi5iYXRjaF9mbGFncyAmIEk5MTVfRElTUEFUQ0hfU0VDVVJFKQogCQlpOTE1X3ZtYV91
bnBpbihlYi5iYXRjaCk7CisJaWYgKGViLmJhdGNoLT5wcml2YXRlKQorCQlpbnRlbF9lbmdpbmVf
cG9vbF9wdXQoZWIuYmF0Y2gtPnByaXZhdGUpOwogZXJyX3ZtYToKIAlpZiAoZWIuZXhlYykKIAkJ
ZWJfcmVsZWFzZV92bWFzKCZlYik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fb2JqZWN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
b2JqZWN0LmMKaW5kZXggMTlkNTUxMTU3NDdjLi4wOWYxODQzZjkyNzQgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMKQEAgLTY2LDcgKzY2LDYgQEAgdm9pZCBp
OTE1X2dlbV9vYmplY3RfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCUlO
SVRfTElTVF9IRUFEKCZvYmotPm1tLmxpbmspOwogCiAJSU5JVF9MSVNUX0hFQUQoJm9iai0+bHV0
X2xpc3QpOwotCUlOSVRfTElTVF9IRUFEKCZvYmotPmJhdGNoX3Bvb2xfbGluayk7CiAKIAlpbml0
X3JjdV9oZWFkKCZvYmotPnJjdSk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9vYmplY3RfdHlwZXMuaAppbmRleCAzNGI1MWZhZDAyZGUuLmQ0NzRjNmFjNDEwMCAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBl
cy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMu
aApAQCAtMTE0LDcgKzExNCw2IEBAIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0IHsKIAl1bnNp
Z25lZCBpbnQgdXNlcmZhdWx0X2NvdW50OwogCXN0cnVjdCBsaXN0X2hlYWQgdXNlcmZhdWx0X2xp
bms7CiAKLQlzdHJ1Y3QgbGlzdF9oZWFkIGJhdGNoX3Bvb2xfbGluazsKIAlJOTE1X1NFTEZURVNU
X0RFQ0xBUkUoc3RydWN0IGxpc3RfaGVhZCBzdF9saW5rKTsKIAogCS8qCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9wbS5jCmluZGV4IGI1NTYxY2JkYzVlYS4uNzI5MjI3MDNhZjQ5IDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYwpAQCAtMzQsMTAgKzM0LDggQEAg
c3RhdGljIHZvaWQgaTkxNV9nZW1fcGFyayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
IAogCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCi0JZm9y
X2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5l
LCBpOTE1LCBpZCkKIAkJY2FsbF9pZGxlX2JhcnJpZXJzKGVuZ2luZSk7IC8qIGNsZWFudXAgYWZ0
ZXIgd2VkZ2luZyAqLwotCQlpOTE1X2dlbV9iYXRjaF9wb29sX2ZpbmkoJmVuZ2luZS0+YmF0Y2hf
cG9vbCk7Ci0JfQogCiAJaW50ZWxfdGltZWxpbmVzX3BhcmsoaTkxNSk7CiAJaTkxNV92bWFfcGFy
a2VkKGk5MTUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5n
aW5lLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaAppbmRleCBkYjVj
NzNjZTg2ZWUuLmE0ZGI0ZGQyMmI0ZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZW5naW5lLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5n
aW5lLmgKQEAgLTksNyArOSw2IEBACiAjaW5jbHVkZSA8bGludXgvcmFuZG9tLmg+CiAjaW5jbHVk
ZSA8bGludXgvc2VxbG9jay5oPgogCi0jaW5jbHVkZSAiaTkxNV9nZW1fYmF0Y2hfcG9vbC5oIgog
I2luY2x1ZGUgImk5MTVfcG11LmgiCiAjaW5jbHVkZSAiaTkxNV9yZWcuaCIKICNpbmNsdWRlICJp
OTE1X3JlcXVlc3QuaCIKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2VuZ2luZV9jcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMK
aW5kZXggOGJkOWE5YWRmNGE1Li5hOTFmMTU3MTdjYzEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2VuZ2luZV9jcy5jCkBAIC0zMiw2ICszMiw3IEBACiAKICNpbmNsdWRlICJpbnRl
bF9lbmdpbmUuaCIKICNpbmNsdWRlICJpbnRlbF9lbmdpbmVfcG0uaCIKKyNpbmNsdWRlICJpbnRl
bF9lbmdpbmVfcG9vbC5oIgogI2luY2x1ZGUgImludGVsX2NvbnRleHQuaCIKICNpbmNsdWRlICJp
bnRlbF9scmMuaCIKICNpbmNsdWRlICJpbnRlbF9yZXNldC5oIgpAQCAtNDkyLDExICs0OTMsNiBA
QCBpbnQgaW50ZWxfZW5naW5lc19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQog
CXJldHVybiBlcnI7CiB9CiAKLXN0YXRpYyB2b2lkIGludGVsX2VuZ2luZV9pbml0X2JhdGNoX3Bv
b2woc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQotewotCWk5MTVfZ2VtX2JhdGNoX3Bv
b2xfaW5pdCgmZW5naW5lLT5iYXRjaF9wb29sLCBlbmdpbmUpOwotfQotCiB2b2lkIGludGVsX2Vu
Z2luZV9pbml0X2V4ZWNsaXN0cyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7CiAJ
c3RydWN0IGludGVsX2VuZ2luZV9leGVjbGlzdHMgKiBjb25zdCBleGVjbGlzdHMgPSAmZW5naW5l
LT5leGVjbGlzdHM7CkBAIC02MjIsMTAgKzYxOCwxMSBAQCBzdGF0aWMgaW50IGludGVsX2VuZ2lu
ZV9zZXR1cF9jb21tb24oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCWludGVsX2Vu
Z2luZV9pbml0X2JyZWFkY3J1bWJzKGVuZ2luZSk7CiAJaW50ZWxfZW5naW5lX2luaXRfZXhlY2xp
c3RzKGVuZ2luZSk7CiAJaW50ZWxfZW5naW5lX2luaXRfaGFuZ2NoZWNrKGVuZ2luZSk7Ci0JaW50
ZWxfZW5naW5lX2luaXRfYmF0Y2hfcG9vbChlbmdpbmUpOwogCWludGVsX2VuZ2luZV9pbml0X2Nt
ZF9wYXJzZXIoZW5naW5lKTsKIAlpbnRlbF9lbmdpbmVfaW5pdF9fcG0oZW5naW5lKTsKIAorCWlu
dGVsX2VuZ2luZV9wb29sX2luaXQoJmVuZ2luZS0+cG9vbCk7CisKIAkvKiBVc2UgdGhlIHdob2xl
IGRldmljZSBieSBkZWZhdWx0ICovCiAJZW5naW5lLT5zc2V1ID0KIAkJaW50ZWxfc3NldV9mcm9t
X2RldmljZV9pbmZvKCZSVU5USU1FX0lORk8oZW5naW5lLT5pOTE1KS0+c3NldSk7CkBAIC04Njks
OSArODY2LDkgQEAgdm9pZCBpbnRlbF9lbmdpbmVfY2xlYW51cF9jb21tb24oc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lKQogCiAJY2xlYW51cF9zdGF0dXNfcGFnZShlbmdpbmUpOwogCisJ
aW50ZWxfZW5naW5lX3Bvb2xfZmluaSgmZW5naW5lLT5wb29sKTsKIAlpbnRlbF9lbmdpbmVfZmlu
aV9icmVhZGNydW1icyhlbmdpbmUpOwogCWludGVsX2VuZ2luZV9jbGVhbnVwX2NtZF9wYXJzZXIo
ZW5naW5lKTsKLQlpOTE1X2dlbV9iYXRjaF9wb29sX2ZpbmkoJmVuZ2luZS0+YmF0Y2hfcG9vbCk7
CiAKIAlpZiAoZW5naW5lLT5kZWZhdWx0X3N0YXRlKQogCQlpOTE1X2dlbV9vYmplY3RfcHV0KGVu
Z2luZS0+ZGVmYXVsdF9zdGF0ZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9lbmdpbmVfcG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2lu
ZV9wbS5jCmluZGV4IGNlNTQwOTI0NzVkYS4uMDMzNjIwNDk4OGQ2IDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uYwpAQCAtOCw2ICs4LDcgQEAKIAogI2luY2x1ZGUg
ImludGVsX2VuZ2luZS5oIgogI2luY2x1ZGUgImludGVsX2VuZ2luZV9wbS5oIgorI2luY2x1ZGUg
ImludGVsX2VuZ2luZV9wb29sLmgiCiAjaW5jbHVkZSAiaW50ZWxfZ3QuaCIKICNpbmNsdWRlICJp
bnRlbF9ndF9wbS5oIgogCkBAIC0xMTYsNiArMTE3LDcgQEAgc3RhdGljIGludCBfX2VuZ2luZV9w
YXJrKHN0cnVjdCBpbnRlbF93YWtlcmVmICp3ZikKIAlHRU1fVFJBQ0UoIiVzXG4iLCBlbmdpbmUt
Pm5hbWUpOwogCiAJaW50ZWxfZW5naW5lX2Rpc2FybV9icmVhZGNydW1icyhlbmdpbmUpOworCWlu
dGVsX2VuZ2luZV9wb29sX3BhcmsoJmVuZ2luZS0+cG9vbCk7CiAKIAkvKiBNdXN0IGJlIHJlc2V0
IHVwb24gaWRsaW5nLCBvciB3ZSBtYXkgbWlzcyB0aGUgYnVzeSB3YWtldXAuICovCiAJR0VNX0JV
R19PTihlbmdpbmUtPmV4ZWNsaXN0cy5xdWV1ZV9wcmlvcml0eV9oaW50ICE9IElOVF9NSU4pOwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bvb2wuYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wb29sLmMKbmV3IGZpbGUgbW9k
ZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi4wM2Q5MGI0OTU4NGEKLS0tIC9kZXYvbnVsbAor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG9vbC5jCkBAIC0wLDAg
KzEsMTc3IEBACisvKgorICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAorICoKKyAqIENv
cHlyaWdodCDCqSAyMDE0LTIwMTggSW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisjaW5jbHVkZSAi
Z2VtL2k5MTVfZ2VtX29iamVjdC5oIgorCisjaW5jbHVkZSAiaTkxNV9kcnYuaCIKKyNpbmNsdWRl
ICJpbnRlbF9lbmdpbmVfcG0uaCIKKyNpbmNsdWRlICJpbnRlbF9lbmdpbmVfcG9vbC5oIgorCitz
dGF0aWMgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqdG9fZW5naW5lKHN0cnVjdCBpbnRlbF9lbmdp
bmVfcG9vbCAqcG9vbCkKK3sKKwlyZXR1cm4gY29udGFpbmVyX29mKHBvb2wsIHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MsIHBvb2wpOworfQorCitzdGF0aWMgc3RydWN0IGxpc3RfaGVhZCAqCitidWNr
ZXRfZm9yX3NpemUoc3RydWN0IGludGVsX2VuZ2luZV9wb29sICpwb29sLCBzaXplX3Qgc3opCit7
CisJaW50IG47CisKKwkvKgorCSAqIENvbXB1dGUgYSBwb3dlci1vZi10d28gYnVja2V0LCBidXQg
dGhyb3cgZXZlcnl0aGluZyBncmVhdGVyIHRoYW4KKwkgKiAxNktpQiBpbnRvIHRoZSBzYW1lIGJ1
Y2tldDogaS5lLiB0aGUgYnVja2V0cyBob2xkIG9iamVjdHMgb2YKKwkgKiAoMSBwYWdlLCAyIHBh
Z2VzLCA0IHBhZ2VzLCA4KyBwYWdlcykuCisJICovCisJbiA9IGZscyhzeiA+PiBQQUdFX1NISUZU
KSAtIDE7CisJaWYgKG4gPj0gQVJSQVlfU0laRShwb29sLT5jYWNoZV9saXN0KSkKKwkJbiA9IEFS
UkFZX1NJWkUocG9vbC0+Y2FjaGVfbGlzdCkgLSAxOworCisJcmV0dXJuICZwb29sLT5jYWNoZV9s
aXN0W25dOworfQorCitzdGF0aWMgdm9pZCBub2RlX2ZyZWUoc3RydWN0IGludGVsX2VuZ2luZV9w
b29sX25vZGUgKm5vZGUpCit7CisJaTkxNV9nZW1fb2JqZWN0X3B1dChub2RlLT5vYmopOworCWk5
MTVfYWN0aXZlX2ZpbmkoJm5vZGUtPmFjdGl2ZSk7CisJa2ZyZWUobm9kZSk7Cit9CisKK3N0YXRp
YyBpbnQgcG9vbF9hY3RpdmUoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCit7CisJc3RydWN0IGlu
dGVsX2VuZ2luZV9wb29sX25vZGUgKm5vZGUgPQorCQljb250YWluZXJfb2YocmVmLCB0eXBlb2Yo
Km5vZGUpLCBhY3RpdmUpOworCXN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKnJlc3YgPSBub2Rl
LT5vYmotPmJhc2UucmVzdjsKKwlpbnQgZXJyOworCisJaWYgKHJlc2VydmF0aW9uX29iamVjdF90
cnlsb2NrKHJlc3YpKSB7CisJCXJlc2VydmF0aW9uX29iamVjdF9hZGRfZXhjbF9mZW5jZShyZXN2
LCBOVUxMKTsKKwkJcmVzZXJ2YXRpb25fb2JqZWN0X3VubG9jayhyZXN2KTsKKwl9CisKKwllcnIg
PSBpOTE1X2dlbV9vYmplY3RfcGluX3BhZ2VzKG5vZGUtPm9iaik7CisJaWYgKGVycikKKwkJcmV0
dXJuIGVycjsKKworCS8qIEhpZGUgdGhpcyBwaW5uZWQgb2JqZWN0IGZyb20gdGhlIHNocmlua2Vy
IHVudGlsIHJldGlyZWQgKi8KKwlpOTE1X2dlbV9vYmplY3RfbWFrZV91bnNocmlua2FibGUobm9k
ZS0+b2JqKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBwb29sX3JldGlyZShzdHJ1
Y3QgaTkxNV9hY3RpdmUgKnJlZikKK3sKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2xfbm9kZSAq
bm9kZSA9CisJCWNvbnRhaW5lcl9vZihyZWYsIHR5cGVvZigqbm9kZSksIGFjdGl2ZSk7CisJc3Ry
dWN0IGludGVsX2VuZ2luZV9wb29sICpwb29sID0gbm9kZS0+cG9vbDsKKwlzdHJ1Y3QgbGlzdF9o
ZWFkICpsaXN0ID0gYnVja2V0X2Zvcl9zaXplKHBvb2wsIG5vZGUtPm9iai0+YmFzZS5zaXplKTsK
Kwl1bnNpZ25lZCBsb25nIGZsYWdzOworCisJR0VNX0JVR19PTighaW50ZWxfZW5naW5lX3BtX2lz
X2F3YWtlKHRvX2VuZ2luZShwb29sKSkpOworCisJaTkxNV9nZW1fb2JqZWN0X3VucGluX3BhZ2Vz
KG5vZGUtPm9iaik7CisKKwkvKiBSZXR1cm4gdGhpcyBvYmplY3QgdG8gdGhlIHNocmlua2VyIHBv
b2wgKi8KKwlpOTE1X2dlbV9vYmplY3RfbWFrZV9wdXJnZWFibGUobm9kZS0+b2JqKTsKKworCXNw
aW5fbG9ja19pcnFzYXZlKCZwb29sLT5sb2NrLCBmbGFncyk7CisJbGlzdF9hZGQoJm5vZGUtPmxp
bmssIGxpc3QpOworCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnBvb2wtPmxvY2ssIGZsYWdzKTsK
K30KKworc3RhdGljIHN0cnVjdCBpbnRlbF9lbmdpbmVfcG9vbF9ub2RlICoKK25vZGVfY3JlYXRl
KHN0cnVjdCBpbnRlbF9lbmdpbmVfcG9vbCAqcG9vbCwgc2l6ZV90IHN6KQoreworCXN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSA9IHRvX2VuZ2luZShwb29sKTsKKwlzdHJ1Y3QgaW50ZWxf
ZW5naW5lX3Bvb2xfbm9kZSAqbm9kZTsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2Jq
OworCisJbm9kZSA9IGttYWxsb2Moc2l6ZW9mKCpub2RlKSwKKwkJICAgICAgIEdGUF9LRVJORUwg
fCBfX0dGUF9SRVRSWV9NQVlGQUlMIHwgX19HRlBfTk9XQVJOKTsKKwlpZiAoIW5vZGUpCisJCXJl
dHVybiBFUlJfUFRSKC1FTk9NRU0pOworCisJbm9kZS0+cG9vbCA9IHBvb2w7CisJaTkxNV9hY3Rp
dmVfaW5pdChlbmdpbmUtPmk5MTUsICZub2RlLT5hY3RpdmUsIHBvb2xfYWN0aXZlLCBwb29sX3Jl
dGlyZSk7CisKKwlvYmogPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX2ludGVybmFsKGVuZ2luZS0+
aTkxNSwgc3opOworCWlmIChJU19FUlIob2JqKSkgeworCQlpOTE1X2FjdGl2ZV9maW5pKCZub2Rl
LT5hY3RpdmUpOworCQlrZnJlZShub2RlKTsKKwkJcmV0dXJuIEVSUl9DQVNUKG9iaik7CisJfQor
CisJbm9kZS0+b2JqID0gb2JqOworCXJldHVybiBub2RlOworfQorCitzdHJ1Y3QgaW50ZWxfZW5n
aW5lX3Bvb2xfbm9kZSAqCitpbnRlbF9lbmdpbmVfcG9vbF9nZXQoc3RydWN0IGludGVsX2VuZ2lu
ZV9wb29sICpwb29sLCBzaXplX3Qgc2l6ZSkKK3sKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2xf
bm9kZSAqbm9kZTsKKwlzdHJ1Y3QgbGlzdF9oZWFkICpsaXN0OworCXVuc2lnbmVkIGxvbmcgZmxh
Z3M7CisJaW50IHJldDsKKworCUdFTV9CVUdfT04oIWludGVsX2VuZ2luZV9wbV9pc19hd2FrZSh0
b19lbmdpbmUocG9vbCkpKTsKKworCXNpemUgPSBQQUdFX0FMSUdOKHNpemUpOworCWxpc3QgPSBi
dWNrZXRfZm9yX3NpemUocG9vbCwgc2l6ZSk7CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmcG9vbC0+
bG9jaywgZmxhZ3MpOworCWxpc3RfZm9yX2VhY2hfZW50cnkobm9kZSwgbGlzdCwgbGluaykgewor
CQlpZiAobm9kZS0+b2JqLT5iYXNlLnNpemUgPCBzaXplKQorCQkJY29udGludWU7CisJCWxpc3Rf
ZGVsKCZub2RlLT5saW5rKTsKKwkJYnJlYWs7CisJfQorCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUo
JnBvb2wtPmxvY2ssIGZsYWdzKTsKKworCWlmICgmbm9kZS0+bGluayA9PSBsaXN0KSB7CisJCW5v
ZGUgPSBub2RlX2NyZWF0ZShwb29sLCBzaXplKTsKKwkJaWYgKElTX0VSUihub2RlKSkKKwkJCXJl
dHVybiBub2RlOworCX0KKworCXJldCA9IGk5MTVfYWN0aXZlX2FjcXVpcmUoJm5vZGUtPmFjdGl2
ZSk7CisJaWYgKHJldCkgeworCQlub2RlX2ZyZWUobm9kZSk7CisJCXJldHVybiBFUlJfUFRSKHJl
dCk7CisJfQorCisJcmV0dXJuIG5vZGU7Cit9CisKK3ZvaWQgaW50ZWxfZW5naW5lX3Bvb2xfaW5p
dChzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2wgKnBvb2wpCit7CisJaW50IG47CisKKwlzcGluX2xv
Y2tfaW5pdCgmcG9vbC0+bG9jayk7CisJZm9yIChuID0gMDsgbiA8IEFSUkFZX1NJWkUocG9vbC0+
Y2FjaGVfbGlzdCk7IG4rKykKKwkJSU5JVF9MSVNUX0hFQUQoJnBvb2wtPmNhY2hlX2xpc3Rbbl0p
OworfQorCit2b2lkIGludGVsX2VuZ2luZV9wb29sX3Bhcmsoc3RydWN0IGludGVsX2VuZ2luZV9w
b29sICpwb29sKQoreworCWludCBuOworCisJZm9yIChuID0gMDsgbiA8IEFSUkFZX1NJWkUocG9v
bC0+Y2FjaGVfbGlzdCk7IG4rKykgeworCQlzdHJ1Y3QgbGlzdF9oZWFkICpsaXN0ID0gJnBvb2wt
PmNhY2hlX2xpc3Rbbl07CisJCXN0cnVjdCBpbnRlbF9lbmdpbmVfcG9vbF9ub2RlICpub2RlLCAq
bm47CisKKwkJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKG5vZGUsIG5uLCBsaXN0LCBsaW5rKQor
CQkJbm9kZV9mcmVlKG5vZGUpOworCisJCUlOSVRfTElTVF9IRUFEKGxpc3QpOworCX0KK30KKwor
dm9pZCBpbnRlbF9lbmdpbmVfcG9vbF9maW5pKHN0cnVjdCBpbnRlbF9lbmdpbmVfcG9vbCAqcG9v
bCkKK3sKKwlpbnQgbjsKKworCWZvciAobiA9IDA7IG4gPCBBUlJBWV9TSVpFKHBvb2wtPmNhY2hl
X2xpc3QpOyBuKyspCisJCUdFTV9CVUdfT04oIWxpc3RfZW1wdHkoJnBvb2wtPmNhY2hlX2xpc3Rb
bl0pKTsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2lu
ZV9wb29sLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG9vbC5oCm5l
dyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uZjdhMGE2NjBjMWM5Ci0tLSAv
ZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bvb2wu
aApAQCAtMCwwICsxLDM0IEBACisvKgorICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAor
ICoKKyAqIENvcHlyaWdodCDCqSAyMDE0LTIwMTggSW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisj
aWZuZGVmIElOVEVMX0VOR0lORV9QT09MX0gKKyNkZWZpbmUgSU5URUxfRU5HSU5FX1BPT0xfSAor
CisjaW5jbHVkZSAiaW50ZWxfZW5naW5lX3Bvb2xfdHlwZXMuaCIKKyNpbmNsdWRlICJpOTE1X2Fj
dGl2ZS5oIgorI2luY2x1ZGUgImk5MTVfcmVxdWVzdC5oIgorCitzdHJ1Y3QgaW50ZWxfZW5naW5l
X3Bvb2xfbm9kZSAqCitpbnRlbF9lbmdpbmVfcG9vbF9nZXQoc3RydWN0IGludGVsX2VuZ2luZV9w
b29sICpwb29sLCBzaXplX3Qgc2l6ZSk7CisKK3N0YXRpYyBpbmxpbmUgaW50CitpbnRlbF9lbmdp
bmVfcG9vbF9tYXJrX2FjdGl2ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2xfbm9kZSAqbm9kZSwK
KwkJCSAgICAgIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQoreworCXJldHVybiBpOTE1X2FjdGl2
ZV9yZWYoJm5vZGUtPmFjdGl2ZSwgcnEtPmZlbmNlLmNvbnRleHQsIHJxKTsKK30KKworc3RhdGlj
IGlubGluZSB2b2lkCitpbnRlbF9lbmdpbmVfcG9vbF9wdXQoc3RydWN0IGludGVsX2VuZ2luZV9w
b29sX25vZGUgKm5vZGUpCit7CisJaTkxNV9hY3RpdmVfcmVsZWFzZSgmbm9kZS0+YWN0aXZlKTsK
K30KKwordm9pZCBpbnRlbF9lbmdpbmVfcG9vbF9pbml0KHN0cnVjdCBpbnRlbF9lbmdpbmVfcG9v
bCAqcG9vbCk7Cit2b2lkIGludGVsX2VuZ2luZV9wb29sX3Bhcmsoc3RydWN0IGludGVsX2VuZ2lu
ZV9wb29sICpwb29sKTsKK3ZvaWQgaW50ZWxfZW5naW5lX3Bvb2xfZmluaShzdHJ1Y3QgaW50ZWxf
ZW5naW5lX3Bvb2wgKnBvb2wpOworCisjZW5kaWYgLyogSU5URUxfRU5HSU5FX1BPT0xfSCAqLwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bvb2xfdHlw
ZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wb29sX3R5cGVzLmgK
bmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5lMzFlZTM2MWI3NmYKLS0t
IC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG9v
bF90eXBlcy5oCkBAIC0wLDAgKzEsMjkgQEAKKy8qCisgKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmll
cjogTUlUCisgKgorICogQ29weXJpZ2h0IMKpIDIwMTQtMjAxOCBJbnRlbCBDb3Jwb3JhdGlvbgor
ICovCisKKyNpZm5kZWYgSU5URUxfRU5HSU5FX1BPT0xfVFlQRVNfSAorI2RlZmluZSBJTlRFTF9F
TkdJTkVfUE9PTF9UWVBFU19ICisKKyNpbmNsdWRlIDxsaW51eC9saXN0Lmg+CisjaW5jbHVkZSA8
bGludXgvc3BpbmxvY2suaD4KKworI2luY2x1ZGUgImk5MTVfYWN0aXZlX3R5cGVzLmgiCisKK3N0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0OworCitzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2wgewor
CXNwaW5sb2NrX3QgbG9jazsKKwlzdHJ1Y3QgbGlzdF9oZWFkIGNhY2hlX2xpc3RbNF07Cit9Owor
CitzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2xfbm9kZSB7CisJc3RydWN0IGk5MTVfYWN0aXZlIGFj
dGl2ZTsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOworCXN0cnVjdCBsaXN0X2hl
YWQgbGluazsKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2wgKnBvb2w7Cit9OworCisjZW5kaWYg
LyogSU5URUxfRU5HSU5FX1BPT0xfVFlQRVNfSCAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9lbmdpbmVfdHlwZXMuaAppbmRleCBkYTYxZGQzMjkyMTAuLjJlMjczZThmNTA2NCAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmgK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmgKQEAgLTE2
LDEyICsxNiwxMiBAQAogI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CiAKICNpbmNsdWRlICJpOTE1
X2dlbS5oIgotI2luY2x1ZGUgImk5MTVfZ2VtX2JhdGNoX3Bvb2wuaCIKICNpbmNsdWRlICJpOTE1
X3BtdS5oIgogI2luY2x1ZGUgImk5MTVfcHJpb2xpc3RfdHlwZXMuaCIKICNpbmNsdWRlICJpOTE1
X3NlbGZ0ZXN0LmgiCi0jaW5jbHVkZSAiZ3QvaW50ZWxfdGltZWxpbmVfdHlwZXMuaCIKKyNpbmNs
dWRlICJpbnRlbF9lbmdpbmVfcG9vbF90eXBlcy5oIgogI2luY2x1ZGUgImludGVsX3NzZXUuaCIK
KyNpbmNsdWRlICJpbnRlbF90aW1lbGluZV90eXBlcy5oIgogI2luY2x1ZGUgImludGVsX3dha2Vy
ZWYuaCIKICNpbmNsdWRlICJpbnRlbF93b3JrYXJvdW5kc190eXBlcy5oIgogCkBAIC0zNTQsNyAr
MzU0LDcgQEAgc3RydWN0IGludGVsX2VuZ2luZV9jcyB7CiAJICogd2hlbiB0aGUgY29tbWFuZCBw
YXJzZXIgaXMgZW5hYmxlZC4gUHJldmVudHMgdGhlIGNsaWVudCBmcm9tCiAJICogbW9kaWZ5aW5n
IHRoZSBiYXRjaCBjb250ZW50cyBhZnRlciBzb2Z0d2FyZSBwYXJzaW5nLgogCSAqLwotCXN0cnVj
dCBpOTE1X2dlbV9iYXRjaF9wb29sIGJhdGNoX3Bvb2w7CisJc3RydWN0IGludGVsX2VuZ2luZV9w
b29sIHBvb2w7CiAKIAlzdHJ1Y3QgaW50ZWxfaHdfc3RhdHVzX3BhZ2Ugc3RhdHVzX3BhZ2U7CiAJ
c3RydWN0IGk5MTVfY3R4X3dvcmthcm91bmRzIHdhX2N0eDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L21vY2tfZW5naW5lLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9t
b2NrX2VuZ2luZS5jCmluZGV4IDEwY2IzMTI0NjJlNS4uOGE1ZjA3OTM1Yjg0IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9tb2NrX2VuZ2luZS5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L21vY2tfZW5naW5lLmMKQEAgLTI3LDYgKzI3LDcgQEAKICNpbmNsdWRlICJp
OTE1X2Rydi5oIgogI2luY2x1ZGUgImludGVsX2NvbnRleHQuaCIKICNpbmNsdWRlICJpbnRlbF9l
bmdpbmVfcG0uaCIKKyNpbmNsdWRlICJpbnRlbF9lbmdpbmVfcG9vbC5oIgogCiAjaW5jbHVkZSAi
bW9ja19lbmdpbmUuaCIKICNpbmNsdWRlICJzZWxmdGVzdHMvbW9ja19yZXF1ZXN0LmgiCkBAIC0y
OTIsNiArMjkzLDcgQEAgaW50IG1vY2tfZW5naW5lX2luaXQoc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lKQogCWludGVsX2VuZ2luZV9pbml0X2JyZWFkY3J1bWJzKGVuZ2luZSk7CiAJaW50
ZWxfZW5naW5lX2luaXRfZXhlY2xpc3RzKGVuZ2luZSk7CiAJaW50ZWxfZW5naW5lX2luaXRfX3Bt
KGVuZ2luZSk7CisJaW50ZWxfZW5naW5lX3Bvb2xfaW5pdCgmZW5naW5lLT5wb29sKTsKIAogCWVu
Z2luZS0+a2VybmVsX2NvbnRleHQgPQogCQlpOTE1X2dlbV9jb250ZXh0X2dldF9lbmdpbmUoaTkx
NS0+a2VybmVsX2NvbnRleHQsIGVuZ2luZS0+aWQpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVn
ZnMuYwppbmRleCAxOWYxNTZhN2Y1MDEuLjg5NTMzMzZmMmFlNSAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9kZWJ1Z2ZzLmMKQEAgLTI5NSwyNyArMjk1LDYgQEAgc3RhdGljIGludCBwZXJfZmlsZV9z
dGF0cyhpbnQgaWQsIHZvaWQgKnB0ciwgdm9pZCAqZGF0YSkKIAkJCSAgIHN0YXRzLmNsb3NlZCk7
IFwKIH0gd2hpbGUgKDApCiAKLXN0YXRpYyB2b2lkIHByaW50X2JhdGNoX3Bvb2xfc3RhdHMoc3Ry
dWN0IHNlcV9maWxlICptLAotCQkJCSAgIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwotCXN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZTsKLQlzdHJ1Y3QgZmlsZV9zdGF0cyBzdGF0cyA9IHt9OwotCWVudW0g
aW50ZWxfZW5naW5lX2lkIGlkOwotCWludCBqOwotCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwg
ZGV2X3ByaXYsIGlkKSB7Ci0JCWZvciAoaiA9IDA7IGogPCBBUlJBWV9TSVpFKGVuZ2luZS0+YmF0
Y2hfcG9vbC5jYWNoZV9saXN0KTsgaisrKSB7Ci0JCQlsaXN0X2Zvcl9lYWNoX2VudHJ5KG9iaiwK
LQkJCQkJICAgICZlbmdpbmUtPmJhdGNoX3Bvb2wuY2FjaGVfbGlzdFtqXSwKLQkJCQkJICAgIGJh
dGNoX3Bvb2xfbGluaykKLQkJCQlwZXJfZmlsZV9zdGF0cygwLCBvYmosICZzdGF0cyk7Ci0JCX0K
LQl9Ci0KLQlwcmludF9maWxlX3N0YXRzKG0sICJba11iYXRjaCBwb29sIiwgc3RhdHMpOwotfQot
CiBzdGF0aWMgdm9pZCBwcmludF9jb250ZXh0X3N0YXRzKHN0cnVjdCBzZXFfZmlsZSAqbSwKIAkJ
CQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIHsKQEAgLTM3NCw1OCArMzUzLDEyIEBA
IHN0YXRpYyBpbnQgaTkxNV9nZW1fb2JqZWN0X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lk
ICpkYXRhKQogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKLQlwcmludF9iYXRjaF9wb29sX3N0
YXRzKG0sIGk5MTUpOwogCXByaW50X2NvbnRleHRfc3RhdHMobSwgaTkxNSk7CiAJbXV0ZXhfdW5s
b2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IGk5MTVfZ2VtX2JhdGNoX3Bvb2xfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRh
dGEpCi17Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1
KG0tPnByaXZhdGUpOwotCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsK
LQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwotCXN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZTsKLQllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKLQlpbnQgdG90YWwgPSAwOwot
CWludCByZXQsIGo7Ci0KLQlyZXQgPSBtdXRleF9sb2NrX2ludGVycnVwdGlibGUoJmRldi0+c3Ry
dWN0X211dGV4KTsKLQlpZiAocmV0KQotCQlyZXR1cm4gcmV0OwotCi0JZm9yX2VhY2hfZW5naW5l
KGVuZ2luZSwgZGV2X3ByaXYsIGlkKSB7Ci0JCWZvciAoaiA9IDA7IGogPCBBUlJBWV9TSVpFKGVu
Z2luZS0+YmF0Y2hfcG9vbC5jYWNoZV9saXN0KTsgaisrKSB7Ci0JCQlpbnQgY291bnQ7Ci0KLQkJ
CWNvdW50ID0gMDsKLQkJCWxpc3RfZm9yX2VhY2hfZW50cnkob2JqLAotCQkJCQkgICAgJmVuZ2lu
ZS0+YmF0Y2hfcG9vbC5jYWNoZV9saXN0W2pdLAotCQkJCQkgICAgYmF0Y2hfcG9vbF9saW5rKQot
CQkJCWNvdW50Kys7Ci0JCQlzZXFfcHJpbnRmKG0sICIlcyBjYWNoZVslZF06ICVkIG9iamVjdHNc
biIsCi0JCQkJICAgZW5naW5lLT5uYW1lLCBqLCBjb3VudCk7Ci0KLQkJCWxpc3RfZm9yX2VhY2hf
ZW50cnkob2JqLAotCQkJCQkgICAgJmVuZ2luZS0+YmF0Y2hfcG9vbC5jYWNoZV9saXN0W2pdLAot
CQkJCQkgICAgYmF0Y2hfcG9vbF9saW5rKSB7Ci0JCQkJc2VxX3B1dHMobSwgIiAgICIpOwotCQkJ
CWRlc2NyaWJlX29iaihtLCBvYmopOwotCQkJCXNlcV9wdXRjKG0sICdcbicpOwotCQkJfQotCi0J
CQl0b3RhbCArPSBjb3VudDsKLQkJfQotCX0KLQotCXNlcV9wcmludGYobSwgInRvdGFsOiAlZFxu
IiwgdG90YWwpOwotCi0JbXV0ZXhfdW5sb2NrKCZkZXYtPnN0cnVjdF9tdXRleCk7Ci0KLQlyZXR1
cm4gMDsKLX0KLQogc3RhdGljIHZvaWQgZ2VuOF9kaXNwbGF5X2ludGVycnVwdF9pbmZvKHN0cnVj
dCBzZXFfZmlsZSAqbSkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBu
b2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7CkBAIC00Mzg1LDcgKzQzMTgsNiBAQCBzdGF0aWMgY29u
c3Qgc3RydWN0IGRybV9pbmZvX2xpc3QgaTkxNV9kZWJ1Z2ZzX2xpc3RbXSA9IHsKIAl7Imk5MTVf
Z2VtX29iamVjdHMiLCBpOTE1X2dlbV9vYmplY3RfaW5mbywgMH0sCiAJeyJpOTE1X2dlbV9mZW5j
ZV9yZWdzIiwgaTkxNV9nZW1fZmVuY2VfcmVnc19pbmZvLCAwfSwKIAl7Imk5MTVfZ2VtX2ludGVy
cnVwdCIsIGk5MTVfaW50ZXJydXB0X2luZm8sIDB9LAotCXsiaTkxNV9nZW1fYmF0Y2hfcG9vbCIs
IGk5MTVfZ2VtX2JhdGNoX3Bvb2xfaW5mbywgMH0sCiAJeyJpOTE1X2d1Y19pbmZvIiwgaTkxNV9n
dWNfaW5mbywgMH0sCiAJeyJpOTE1X2d1Y19sb2FkX3N0YXR1cyIsIGk5MTVfZ3VjX2xvYWRfc3Rh
dHVzX2luZm8sIDB9LAogCXsiaTkxNV9ndWNfbG9nX2R1bXAiLCBpOTE1X2d1Y19sb2dfZHVtcCwg
MH0sCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9iYXRjaF9wb29s
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9iYXRjaF9wb29sLmMKZGVsZXRlZCBm
aWxlIG1vZGUgMTAwNjQ0CmluZGV4IGIxN2YyMzk5MTI1My4uMDAwMDAwMDAwMDAwCi0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2JhdGNoX3Bvb2wuYworKysgL2Rldi9udWxsCkBA
IC0xLDEzMiArMCwwIEBACi0vKgotICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAotICoK
LSAqIENvcHlyaWdodCDCqSAyMDE0LTIwMTggSW50ZWwgQ29ycG9yYXRpb24KLSAqLwotCi0jaW5j
bHVkZSAiaTkxNV9nZW1fYmF0Y2hfcG9vbC5oIgotI2luY2x1ZGUgImk5MTVfZHJ2LmgiCi0KLS8q
KgotICogRE9DOiBiYXRjaCBwb29sCi0gKgotICogSW4gb3JkZXIgdG8gc3VibWl0IGJhdGNoIGJ1
ZmZlcnMgYXMgJ3NlY3VyZScsIHRoZSBzb2Z0d2FyZSBjb21tYW5kIHBhcnNlcgotICogbXVzdCBl
bnN1cmUgdGhhdCBhIGJhdGNoIGJ1ZmZlciBjYW5ub3QgYmUgbW9kaWZpZWQgYWZ0ZXIgcGFyc2lu
Zy4gSXQgZG9lcwotICogdGhpcyBieSBjb3B5aW5nIHRoZSB1c2VyIHByb3ZpZGVkIGJhdGNoIGJ1
ZmZlciBjb250ZW50cyB0byBhIGtlcm5lbCBvd25lZAotICogYnVmZmVyIGZyb20gd2hpY2ggdGhl
IGhhcmR3YXJlIHdpbGwgYWN0dWFsbHkgZXhlY3V0ZSwgYW5kIGJ5IGNhcmVmdWxseQotICogbWFu
YWdpbmcgdGhlIGFkZHJlc3Mgc3BhY2UgYmluZGluZ3MgZm9yIHN1Y2ggYnVmZmVycy4KLSAqCi0g
KiBUaGUgYmF0Y2ggcG9vbCBmcmFtZXdvcmsgcHJvdmlkZXMgYSBtZWNoYW5pc20gZm9yIHRoZSBk
cml2ZXIgdG8gbWFuYWdlIGEKLSAqIHNldCBvZiBzY3JhdGNoIGJ1ZmZlcnMgdG8gdXNlIGZvciB0
aGlzIHB1cnBvc2UuIFRoZSBmcmFtZXdvcmsgY2FuIGJlCi0gKiBleHRlbmRlZCB0byBzdXBwb3J0
IG90aGVyIHVzZXMgY2FzZXMgc2hvdWxkIHRoZXkgYXJpc2UuCi0gKi8KLQotLyoqCi0gKiBpOTE1
X2dlbV9iYXRjaF9wb29sX2luaXQoKSAtIGluaXRpYWxpemUgYSBiYXRjaCBidWZmZXIgcG9vbAot
ICogQHBvb2w6IHRoZSBiYXRjaCBidWZmZXIgcG9vbAotICogQGVuZ2luZTogdGhlIGFzc29jaWF0
ZWQgcmVxdWVzdCBzdWJtaXNzaW9uIGVuZ2luZQotICovCi12b2lkIGk5MTVfZ2VtX2JhdGNoX3Bv
b2xfaW5pdChzdHJ1Y3QgaTkxNV9nZW1fYmF0Y2hfcG9vbCAqcG9vbCwKLQkJCSAgICAgIHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKLXsKLQlpbnQgbjsKLQotCXBvb2wtPmVuZ2luZSA9
IGVuZ2luZTsKLQotCWZvciAobiA9IDA7IG4gPCBBUlJBWV9TSVpFKHBvb2wtPmNhY2hlX2xpc3Qp
OyBuKyspCi0JCUlOSVRfTElTVF9IRUFEKCZwb29sLT5jYWNoZV9saXN0W25dKTsKLX0KLQotLyoq
Ci0gKiBpOTE1X2dlbV9iYXRjaF9wb29sX2ZpbmkoKSAtIGNsZWFuIHVwIGEgYmF0Y2ggYnVmZmVy
IHBvb2wKLSAqIEBwb29sOiB0aGUgcG9vbCB0byBjbGVhbiB1cAotICoKLSAqIE5vdGU6IENhbGxl
cnMgbXVzdCBob2xkIHRoZSBzdHJ1Y3RfbXV0ZXguCi0gKi8KLXZvaWQgaTkxNV9nZW1fYmF0Y2hf
cG9vbF9maW5pKHN0cnVjdCBpOTE1X2dlbV9iYXRjaF9wb29sICpwb29sKQotewotCWludCBuOwot
Ci0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmcG9vbC0+ZW5naW5lLT5pOTE1LT5kcm0uc3RydWN0X211
dGV4KTsKLQotCWZvciAobiA9IDA7IG4gPCBBUlJBWV9TSVpFKHBvb2wtPmNhY2hlX2xpc3QpOyBu
KyspIHsKLQkJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwgKm5leHQ7Ci0KLQkJbGlz
dF9mb3JfZWFjaF9lbnRyeV9zYWZlKG9iaiwgbmV4dCwKLQkJCQkJICZwb29sLT5jYWNoZV9saXN0
W25dLAotCQkJCQkgYmF0Y2hfcG9vbF9saW5rKQotCQkJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmop
OwotCi0JCUlOSVRfTElTVF9IRUFEKCZwb29sLT5jYWNoZV9saXN0W25dKTsKLQl9Ci19Ci0KLS8q
KgotICogaTkxNV9nZW1fYmF0Y2hfcG9vbF9nZXQoKSAtIGFsbG9jYXRlIGEgYnVmZmVyIGZyb20g
dGhlIHBvb2wKLSAqIEBwb29sOiB0aGUgYmF0Y2ggYnVmZmVyIHBvb2wKLSAqIEBzaXplOiB0aGUg
bWluaW11bSBkZXNpcmVkIHNpemUgb2YgdGhlIHJldHVybmVkIGJ1ZmZlcgotICoKLSAqIFJldHVy
bnMgYW4gaW5hY3RpdmUgYnVmZmVyIGZyb20gQHBvb2wgd2l0aCBhdCBsZWFzdCBAc2l6ZSBieXRl
cywKLSAqIHdpdGggdGhlIHBhZ2VzIHBpbm5lZC4gVGhlIGNhbGxlciBtdXN0IGk5MTVfZ2VtX29i
amVjdF91bnBpbl9wYWdlcygpCi0gKiBvbiB0aGUgcmV0dXJuZWQgb2JqZWN0LgotICoKLSAqIE5v
dGU6IENhbGxlcnMgbXVzdCBob2xkIHRoZSBzdHJ1Y3RfbXV0ZXgKLSAqCi0gKiBSZXR1cm46IHRo
ZSBidWZmZXIgb2JqZWN0IG9yIGFuIGVycm9yIHBvaW50ZXIKLSAqLwotc3RydWN0IGRybV9pOTE1
X2dlbV9vYmplY3QgKgotaTkxNV9nZW1fYmF0Y2hfcG9vbF9nZXQoc3RydWN0IGk5MTVfZ2VtX2Jh
dGNoX3Bvb2wgKnBvb2wsCi0JCQlzaXplX3Qgc2l6ZSkKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdCAqb2JqOwotCXN0cnVjdCBsaXN0X2hlYWQgKmxpc3Q7Ci0JaW50IG4sIHJldDsKLQot
CWxvY2tkZXBfYXNzZXJ0X2hlbGQoJnBvb2wtPmVuZ2luZS0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRl
eCk7Ci0KLQkvKiBDb21wdXRlIGEgcG93ZXItb2YtdHdvIGJ1Y2tldCwgYnV0IHRocm93IGV2ZXJ5
dGhpbmcgZ3JlYXRlciB0aGFuCi0JICogMTZLaUIgaW50byB0aGUgc2FtZSBidWNrZXQ6IGkuZS4g
dGhlIHRoZSBidWNrZXRzIGhvbGQgb2JqZWN0cyBvZgotCSAqICgxIHBhZ2UsIDIgcGFnZXMsIDQg
cGFnZXMsIDgrIHBhZ2VzKS4KLQkgKi8KLQluID0gZmxzKHNpemUgPj4gUEFHRV9TSElGVCkgLSAx
OwotCWlmIChuID49IEFSUkFZX1NJWkUocG9vbC0+Y2FjaGVfbGlzdCkpCi0JCW4gPSBBUlJBWV9T
SVpFKHBvb2wtPmNhY2hlX2xpc3QpIC0gMTsKLQlsaXN0ID0gJnBvb2wtPmNhY2hlX2xpc3Rbbl07
Ci0KLQlsaXN0X2Zvcl9lYWNoX2VudHJ5KG9iaiwgbGlzdCwgYmF0Y2hfcG9vbF9saW5rKSB7Ci0J
CXN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKnJlc3YgPSBvYmotPmJhc2UucmVzdjsKLQotCQkv
KiBUaGUgYmF0Y2hlcyBhcmUgc3RyaWN0bHkgTFJVIG9yZGVyZWQgKi8KLQkJaWYgKCFyZXNlcnZh
dGlvbl9vYmplY3RfdGVzdF9zaWduYWxlZF9yY3UocmVzdiwgdHJ1ZSkpCi0JCQlicmVhazsKLQot
CQkvKgotCQkgKiBUaGUgb2JqZWN0IGlzIG5vdyBpZGxlLCBjbGVhciB0aGUgYXJyYXkgb2Ygc2hh
cmVkCi0JCSAqIGZlbmNlcyBiZWZvcmUgd2UgYWRkIGEgbmV3IHJlcXVlc3QuIEFsdGhvdWdoLCB3
ZQotCQkgKiByZW1haW4gb24gdGhlIHNhbWUgZW5naW5lLCB3ZSBtYXkgYmUgb24gYSBkaWZmZXJl
bnQKLQkJICogdGltZWxpbmUgYW5kIHNvIG1heSBjb250aW51YWxseSBncm93IHRoZSBhcnJheSwK
LQkJICogdHJhcHBpbmcgYSByZWZlcmVuY2UgdG8gYWxsIHRoZSBvbGQgZmVuY2VzLCByYXRoZXIK
LQkJICogdGhhbiByZXBsYWNlIHRoZSBleGlzdGluZyBmZW5jZS4KLQkJICovCi0JCWlmIChyY3Vf
YWNjZXNzX3BvaW50ZXIocmVzdi0+ZmVuY2UpKSB7Ci0JCQlyZXNlcnZhdGlvbl9vYmplY3RfbG9j
ayhyZXN2LCBOVUxMKTsKLQkJCXJlc2VydmF0aW9uX29iamVjdF9hZGRfZXhjbF9mZW5jZShyZXN2
LCBOVUxMKTsKLQkJCXJlc2VydmF0aW9uX29iamVjdF91bmxvY2socmVzdik7Ci0JCX0KLQotCQlp
ZiAob2JqLT5iYXNlLnNpemUgPj0gc2l6ZSkKLQkJCWdvdG8gZm91bmQ7Ci0JfQotCi0Jb2JqID0g
aTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5hbChwb29sLT5lbmdpbmUtPmk5MTUsIHNpemUp
OwotCWlmIChJU19FUlIob2JqKSkKLQkJcmV0dXJuIG9iajsKLQotZm91bmQ6Ci0JcmV0ID0gaTkx
NV9nZW1fb2JqZWN0X3Bpbl9wYWdlcyhvYmopOwotCWlmIChyZXQpCi0JCXJldHVybiBFUlJfUFRS
KHJldCk7Ci0KLQlsaXN0X21vdmVfdGFpbCgmb2JqLT5iYXRjaF9wb29sX2xpbmssIGxpc3QpOwot
CXJldHVybiBvYmo7Ci19CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dl
bV9iYXRjaF9wb29sLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9iYXRjaF9wb29s
LmgKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IGZlZWVlZWFhNTRkOC4uMDAwMDAwMDAw
MDAwCi0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2JhdGNoX3Bvb2wuaAorKysg
L2Rldi9udWxsCkBAIC0xLDI2ICswLDAgQEAKLS8qCi0gKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmll
cjogTUlUCi0gKgotICogQ29weXJpZ2h0IMKpIDIwMTQtMjAxOCBJbnRlbCBDb3Jwb3JhdGlvbgot
ICovCi0KLSNpZm5kZWYgSTkxNV9HRU1fQkFUQ0hfUE9PTF9ICi0jZGVmaW5lIEk5MTVfR0VNX0JB
VENIX1BPT0xfSAotCi0jaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KLQotc3RydWN0IGRybV9pOTE1
X2dlbV9vYmplY3Q7Ci1zdHJ1Y3QgaW50ZWxfZW5naW5lX2NzOwotCi1zdHJ1Y3QgaTkxNV9nZW1f
YmF0Y2hfcG9vbCB7Ci0Jc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCXN0cnVjdCBs
aXN0X2hlYWQgY2FjaGVfbGlzdFs0XTsKLX07Ci0KLXZvaWQgaTkxNV9nZW1fYmF0Y2hfcG9vbF9p
bml0KHN0cnVjdCBpOTE1X2dlbV9iYXRjaF9wb29sICpwb29sLAotCQkJICAgICAgc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKLXZvaWQgaTkxNV9nZW1fYmF0Y2hfcG9vbF9maW5pKHN0
cnVjdCBpOTE1X2dlbV9iYXRjaF9wb29sICpwb29sKTsKLXN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICoKLWk5MTVfZ2VtX2JhdGNoX3Bvb2xfZ2V0KHN0cnVjdCBpOTE1X2dlbV9iYXRjaF9wb29s
ICpwb29sLCBzaXplX3Qgc2l6ZSk7Ci0KLSNlbmRpZiAvKiBJOTE1X0dFTV9CQVRDSF9QT09MX0gg
Ki8KLS0gCjIuMjMuMC5yYzEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNr
dG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2lu
dGVsLWdmeA==

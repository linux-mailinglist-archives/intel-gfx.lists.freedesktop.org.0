Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 24647E2EB8
	for <lists+intel-gfx@lfdr.de>; Thu, 24 Oct 2019 12:24:20 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3891F6E1E9;
	Thu, 24 Oct 2019 10:24:18 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga04.intel.com (mga04.intel.com [192.55.52.120])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A01196E1E9
 for <intel-gfx@lists.freedesktop.org>; Thu, 24 Oct 2019 10:24:16 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga008.jf.intel.com ([10.7.209.65])
 by fmsmga104.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 24 Oct 2019 03:24:16 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.68,224,1569308400"; d="scan'208";a="192142135"
Received: from irsmsx105.ger.corp.intel.com ([163.33.3.28])
 by orsmga008.jf.intel.com with ESMTP; 24 Oct 2019 03:24:14 -0700
Received: from irsmsx106.ger.corp.intel.com ([169.254.8.185]) by
 irsmsx105.ger.corp.intel.com ([169.254.7.210]) with mapi id 14.03.0439.000;
 Thu, 24 Oct 2019 11:24:13 +0100
From: "Lisovskiy, Stanislav" <stanislav.lisovskiy@intel.com>
To: "ville.syrjala@linux.intel.com" <ville.syrjala@linux.intel.com>,
 "intel-gfx@lists.freedesktop.org" <intel-gfx@lists.freedesktop.org>
Thread-Topic: [Intel-gfx] [PATCH v2 02/13] drm/i915: Rework global state
 locking
Thread-Index: AQHVg48aWOzJCA2KIEahrZqdieIslKdpkc0A
Date: Thu, 24 Oct 2019 10:24:12 +0000
Message-ID: <d0f2588d17deed6f2efbb4237ec7c98dffa86b3d.camel@intel.com>
References: <20191015193035.25982-1-ville.syrjala@linux.intel.com>
 <20191015193035.25982-3-ville.syrjala@linux.intel.com>
In-Reply-To: <20191015193035.25982-3-ville.syrjala@linux.intel.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [10.237.72.89]
Content-ID: <BAEFD0C4A59EDA489239CAE3D5737092@intel.com>
MIME-Version: 1.0
Subject: Re: [Intel-gfx] [PATCH v2 02/13] drm/i915: Rework global state
 locking
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T24gVHVlLCAyMDE5LTEwLTE1IGF0IDIyOjMwICswMzAwLCBWaWxsZSBTeXJqYWxhIHdyb3RlOg0K
PiBGcm9tOiBWaWxsZSBTeXJqw6Rsw6QgPHZpbGxlLnN5cmphbGFAbGludXguaW50ZWwuY29tPg0K
PiANCj4gU28gZmFyIHdlJ3ZlIHNvcnQgb2YgcHJvdGVjdGVkIHRoZSBnbG9iYWwgc3RhdGUgdW5k
ZXIgZGV2X3ByaXYgd2l0aA0KPiB0aGUgY29ubmVjdGlvbl9tdXRleC4gSSB3YW4gdG8gY2hhbmdl
IHRoYXQgc28gdGhhdCB3ZSBjYW4gY2hhbmdlIHRoZQ0KPiBjZGNsayBldmVuIGZvciBwdXJlIHBs
YW5lIHVwZGF0ZXMuIFRvIHRoYXQgZW5kIGxldCdzIGZvcm1hbGl6ZSB0aGUNCj4gcHJvdGVjdGlv
biBvZiB0aGUgZ2xvYmFsIHN0YXRlIHRvIGZvbGxvdyB3aGF0IEkgc3RhcnRlZCB3aXRoIHRoZQ0K
PiBjZGNsaw0KPiBjb2RlIGFscmVhZHkgKHRob3VnaCBub3QgZW50aXJlbHkgcHJvcGVybHkpIHN1
Y2ggdGhhdCBhbnkgY3J0YyBtdXRleA0KPiB3aWxsIHN1ZmZpY2UgYXMgYSByZWFkIGxvY2ssIGFu
ZCBhbGwgY3J0Y3MgbXV0ZXhlcyBhY3QgYXMgdGhlIHdyaXRlDQo+IGxvY2suDQo+IA0KPiBXZSds
bCBhbHNvIHBpbXAgaW50ZWxfYXRvbWljX3N0YXRlX2NsZWFyKCkgdG8gY2xlYXIgdGhlIGVudGly
ZSBnbG9iYWwNCj4gc3RhdGUsIHNvIHRoYXQgd2UgZG9uJ3QgYWNjaWRlbnRhbGx5IGxlYWsgc3Rh
bGUgaW5mb3JtYXRpb24gYmV0d2Vlbg0KPiB0aGUgbG9ja2luZyByZXRyaWVzLg0KPiANCj4gQXMg
YSBzbGlnaHQgb3B0aW1pemF0aW9uIHdlJ2xsIG9ubHkgbG9jayB0aGUgY3J0YyBtdXRleGVzIHRv
IHByb3RlY3QNCj4gdGhlIGdsb2JhbCBzdGF0ZSwgaG93ZXZlciBpZiBhbmQgd2hlbiB3ZSBhY3R1
YWxseSBoYXZlIHRvIHBva2UgdGhlDQo+IGh3IChlZy4gaWYgdGhlIGFjdHVhbCBjZGNsayBjaGFu
Z2VzKSB3ZSBtdXN0IHNlcmlhbGl6ZSBjb21taXRzDQo+IGFjcm9zcyBhbGwgY3J0Y3Mgc28gdGhh
dCBhIHBhcmFsbGVsIG5vbmJsb2NraW5nIGNvbW1pdCBjYW4ndCBnZXQNCj4gYWhlYWQgb2YgdGhl
IGNkY2xrIHJlcHJvZ2FtbWluZy4gV2UgZG8gdGhhdCBieSBhZGRpbmcgYWxsIGNydGNzIHRvDQo+
IHRoZSBzdGF0ZS4NCj4gDQo+IFRPRE86IHRoZSBvbGQgZ2xvYmFsIHN0YXRlIGV4YW1pbmVkIGR1
cmluZyBjb21taXQgbWF5IHN0aWxsDQo+IGJlIGEgcHJvYmxlbSBzaW5jZSBpdCBhbHdheXMgbG9v
a3MgYXQgdGhlIF9sYXRlc3RfIHN3YXBwZWQgc3RhdGUNCj4gaW4gZGV2X3ByaXYuIE5lZWQgdG8g
YWRkIHByb3BlciBvbGQvbmV3IHN0YXRlIGZvciB0aGF0IHRvbyBJIHRoaW5rLg0KPiANCj4gdjI6
IFJlbWViZXIgdG8gc2VyaWFsaXplIHRoZSBjb21taXRzIGlmIG5lY2Vzc2FyeQ0KPiANCj4gU2ln
bmVkLW9mZi1ieTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNv
bT4NCg0KUmV2aWV3ZWQtYnk6IFN0YW5pc2xhdiBMaXNvdnNraXkgPHN0YW5pc2xhdi5saXNvdnNr
aXlAaW50ZWwuY29tPg0KDQo+IC0tLQ0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9hdG9taWMuYyAgIHwgIDQ0ICsrKysrKysrDQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2F0b21pYy5oICAgfCAgIDUgKw0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF9hdWRpby5jICAgIHwgIDEwICstDQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2NkY2xrLmMgICAgfCAxMDIgKysrKysrKysrKy0tLS0NCj4gLS0tLQ0K
PiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMgIHwgIDI5ICsr
KystDQo+ICAuLi4vZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmggICAgfCAg
IDggKysNCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggICAgICAgICAgICAgICB8
ICAxMSArLQ0KPiAgNyBmaWxlcyBjaGFuZ2VkLCAxNTMgaW5zZXJ0aW9ucygrKSwgNTYgZGVsZXRp
b25zKC0pDQo+IA0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9hdG9taWMuYw0KPiBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRv
bWljLmMNCj4gaW5kZXggYzVhNTUyYTY5NzUyLi45Y2Q2ZDIzNDhhMWUgMTAwNjQ0DQo+IC0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWljLmMNCj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9taWMuYw0KPiBAQCAtNDI5LDYgKzQy
OSwxMyBAQCB2b2lkIGludGVsX2F0b21pY19zdGF0ZV9jbGVhcihzdHJ1Y3QNCj4gZHJtX2F0b21p
Y19zdGF0ZSAqcykNCj4gIAlzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSA9IHRvX2lu
dGVsX2F0b21pY19zdGF0ZShzKTsNCj4gIAlkcm1fYXRvbWljX3N0YXRlX2RlZmF1bHRfY2xlYXIo
JnN0YXRlLT5iYXNlKTsNCj4gIAlzdGF0ZS0+ZHBsbF9zZXQgPSBzdGF0ZS0+bW9kZXNldCA9IGZh
bHNlOw0KPiArCXN0YXRlLT5nbG9iYWxfc3RhdGVfY2hhbmdlZCA9IGZhbHNlOw0KPiArCXN0YXRl
LT5hY3RpdmVfcGlwZXMgPSAwOw0KPiArCW1lbXNldCgmc3RhdGUtPm1pbl9jZGNsaywgMCwgc2l6
ZW9mKHN0YXRlLT5taW5fY2RjbGspKTsNCj4gKwltZW1zZXQoJnN0YXRlLT5taW5fdm9sdGFnZV9s
ZXZlbCwgMCwgc2l6ZW9mKHN0YXRlLQ0KPiA+bWluX3ZvbHRhZ2VfbGV2ZWwpKTsNCj4gKwltZW1z
ZXQoJnN0YXRlLT5jZGNsay5sb2dpY2FsLCAwLCBzaXplb2Yoc3RhdGUtPmNkY2xrLmxvZ2ljYWwp
KTsNCj4gKwltZW1zZXQoJnN0YXRlLT5jZGNsay5hY3R1YWwsIDAsIHNpemVvZihzdGF0ZS0+Y2Rj
bGsuYWN0dWFsKSk7DQo+ICsJc3RhdGUtPmNkY2xrLnBpcGUgPSBJTlZBTElEX1BJUEU7DQo+ICB9
DQo+ICANCj4gIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICoNCj4gQEAgLTQ0MiwzICs0NDksNDAg
QEAgaW50ZWxfYXRvbWljX2dldF9jcnRjX3N0YXRlKHN0cnVjdA0KPiBkcm1fYXRvbWljX3N0YXRl
ICpzdGF0ZSwNCj4gIA0KPiAgCXJldHVybiB0b19pbnRlbF9jcnRjX3N0YXRlKGNydGNfc3RhdGUp
Ow0KPiAgfQ0KPiArDQo+ICtpbnQgaW50ZWxfYXRvbWljX2xvY2tfZ2xvYmFsX3N0YXRlKHN0cnVj
dCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQ0KPiArew0KPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoc3RhdGUtPmJhc2UuZGV2KTsNCj4gKwlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YzsNCj4gKw0KPiArCXN0YXRlLT5nbG9iYWxfc3RhdGVfY2hhbmdlZCA9
IHRydWU7DQo+ICsNCj4gKwlmb3JfZWFjaF9pbnRlbF9jcnRjKCZkZXZfcHJpdi0+ZHJtLCBjcnRj
KSB7DQo+ICsJCWludCByZXQ7DQo+ICsNCj4gKwkJcmV0ID0gZHJtX21vZGVzZXRfbG9jaygmY3J0
Yy0+YmFzZS5tdXRleCwNCj4gKwkJCQkgICAgICAgc3RhdGUtPmJhc2UuYWNxdWlyZV9jdHgpOw0K
PiArCQlpZiAocmV0KQ0KPiArCQkJcmV0dXJuIHJldDsNCj4gKwl9DQo+ICsNCj4gKwlyZXR1cm4g
MDsNCj4gK30NCj4gKw0KPiAraW50IGludGVsX2F0b21pY19zZXJpYWxpemVfZ2xvYmFsX3N0YXRl
KHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUNCj4gKnN0YXRlKQ0KPiArew0KPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoc3RhdGUtPmJhc2UuZGV2KTsNCj4g
KwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsNCj4gKw0KPiArCXN0YXRlLT5nbG9iYWxfc3RhdGVf
Y2hhbmdlZCA9IHRydWU7DQo+ICsNCj4gKwlmb3JfZWFjaF9pbnRlbF9jcnRjKCZkZXZfcHJpdi0+
ZHJtLCBjcnRjKSB7DQo+ICsJCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlOw0K
PiArDQo+ICsJCWNydGNfc3RhdGUgPSBpbnRlbF9hdG9taWNfZ2V0X2NydGNfc3RhdGUoJnN0YXRl
LT5iYXNlLA0KPiBjcnRjKTsNCj4gKwkJaWYgKElTX0VSUihjcnRjX3N0YXRlKSkNCj4gKwkJCXJl
dHVybiBQVFJfRVJSKGNydGNfc3RhdGUpOw0KPiArCX0NCj4gKw0KPiArCXJldHVybiAwOw0KPiAr
fQ0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9t
aWMuaA0KPiBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWljLmgNCj4g
aW5kZXggNTgwNjVkMzE2MWEzLi40OWQ1Y2IxYjllMGEgMTAwNjQ0DQo+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWljLmgNCj4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9taWMuaA0KPiBAQCAtMTYsNiArMTYsNyBAQCBzdHJ1
Y3QgZHJtX2NydGNfc3RhdGU7DQo+ICBzdHJ1Y3QgZHJtX2RldmljZTsNCj4gIHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlOw0KPiAgc3RydWN0IGRybV9wcm9wZXJ0eTsNCj4gK3N0cnVjdCBpbnRlbF9h
dG9taWNfc3RhdGU7DQo+ICBzdHJ1Y3QgaW50ZWxfY3J0YzsNCj4gIHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlOw0KPiAgDQo+IEBAIC00Niw0ICs0Nyw4IEBAIGludCBpbnRlbF9hdG9taWNfc2V0dXBf
c2NhbGVycyhzdHJ1Y3QNCj4gZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsDQo+ICAJCQkgICAg
ICAgc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMsDQo+ICAJCQkgICAgICAgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpOw0KPiAgDQo+ICtpbnQgaW50ZWxfYXRvbWljX2xv
Y2tfZ2xvYmFsX3N0YXRlKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUNCj4gKnN0YXRlKTsNCj4g
Kw0KPiAraW50IGludGVsX2F0b21pY19zZXJpYWxpemVfZ2xvYmFsX3N0YXRlKHN0cnVjdCBpbnRl
bF9hdG9taWNfc3RhdGUNCj4gKnN0YXRlKTsNCj4gKw0KPiAgI2VuZGlmIC8qIF9fSU5URUxfQVRP
TUlDX0hfXyAqLw0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9hdWRpby5jDQo+IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdWRp
by5jDQo+IGluZGV4IGVkMTg1MTFiZWZhMy4uODVlNmIyYmJiMzRmIDEwMDY0NA0KPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F1ZGlvLmMNCj4gKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdWRpby5jDQo+IEBAIC0yOCw2ICsyOCw3IEBA
DQo+ICAjaW5jbHVkZSA8ZHJtL2k5MTVfY29tcG9uZW50Lmg+DQo+ICANCj4gICNpbmNsdWRlICJp
OTE1X2Rydi5oIg0KPiArI2luY2x1ZGUgImludGVsX2F0b21pYy5oIg0KPiAgI2luY2x1ZGUgImlu
dGVsX2F1ZGlvLmgiDQo+ICAjaW5jbHVkZSAiaW50ZWxfZGlzcGxheV90eXBlcy5oIg0KPiAgI2lu
Y2x1ZGUgImludGVsX2xwZV9hdWRpby5oIg0KPiBAQCAtODE4LDEzICs4MTksOCBAQCBzdGF0aWMg
dm9pZCBnbGtfZm9yY2VfYXVkaW9fY2RjbGsoc3RydWN0DQo+IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LA0KPiAgCXRvX2ludGVsX2F0b21pY19zdGF0ZShzdGF0ZSktPmNkY2xrLmZvcmNlX21p
bl9jZGNsayA9DQo+ICAJCWVuYWJsZSA/IDIgKiA5NjAwMCA6IDA7DQo+ICANCj4gLQkvKg0KPiAt
CSAqIFByb3RlY3RzIGRldl9wcml2LT5jZGNsay5mb3JjZV9taW5fY2RjbGsNCj4gLQkgKiBOZWVk
IHRvIGxvY2sgdGhpcyBoZXJlIGluIGNhc2Ugd2UgaGF2ZSBubyBhY3RpdmUgcGlwZXMNCj4gLQkg
KiBhbmQgdGh1cyB3b3VsZG4ndCBsb2NrIGl0IGR1cmluZyB0aGUgY29tbWl0IG90aGVyd2lzZS4N
Cj4gLQkgKi8NCj4gLQlyZXQgPSBkcm1fbW9kZXNldF9sb2NrKCZkZXZfcHJpdi0NCj4gPmRybS5t
b2RlX2NvbmZpZy5jb25uZWN0aW9uX211dGV4LA0KPiAtCQkJICAgICAgICZjdHgpOw0KPiArCS8q
IFByb3RlY3RzIGRldl9wcml2LT5jZGNsay5mb3JjZV9taW5fY2RjbGsgKi8NCj4gKwlyZXQgPQ0K
PiBpbnRlbF9hdG9taWNfbG9ja19nbG9iYWxfc3RhdGUodG9faW50ZWxfYXRvbWljX3N0YXRlKHN0
YXRlKSk7DQo+ICAJaWYgKCFyZXQpDQo+ICAJCXJldCA9IGRybV9hdG9taWNfY29tbWl0KHN0YXRl
KTsNCj4gIA0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9jZGNsay5jDQo+IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9jZGNsay5j
DQo+IGluZGV4IDZlYWViYzM4ZWUwMS4uNmMxN2EzYmJmODY2IDEwMDY0NA0KPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2NkY2xrLmMNCj4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9jZGNsay5jDQo+IEBAIC0yMDA3LDExICsyMDA3LDIw
IEBAIHN0YXRpYyBpbnQgaW50ZWxfY29tcHV0ZV9taW5fY2RjbGsoc3RydWN0DQo+IGludGVsX2F0
b21pY19zdGF0ZSAqc3RhdGUpDQo+ICAJICAgICAgIHNpemVvZihzdGF0ZS0+bWluX2NkY2xrKSk7
DQo+ICANCj4gIAlmb3JfZWFjaF9uZXdfaW50ZWxfY3J0Y19pbl9zdGF0ZShzdGF0ZSwgY3J0Yywg
Y3J0Y19zdGF0ZSwgaSkgew0KPiArCQlpbnQgcmV0Ow0KPiArDQo+ICAJCW1pbl9jZGNsayA9IGlu
dGVsX2NydGNfY29tcHV0ZV9taW5fY2RjbGsoY3J0Y19zdGF0ZSk7DQo+ICAJCWlmIChtaW5fY2Rj
bGsgPCAwKQ0KPiAgCQkJcmV0dXJuIG1pbl9jZGNsazsNCj4gIA0KPiArCQlpZiAoc3RhdGUtPm1p
bl9jZGNsa1tpXSA9PSBtaW5fY2RjbGspDQo+ICsJCQljb250aW51ZTsNCj4gKw0KPiAgCQlzdGF0
ZS0+bWluX2NkY2xrW2ldID0gbWluX2NkY2xrOw0KPiArDQo+ICsJCXJldCA9IGludGVsX2F0b21p
Y19sb2NrX2dsb2JhbF9zdGF0ZShzdGF0ZSk7DQo+ICsJCWlmIChyZXQpDQo+ICsJCQlyZXR1cm4g
cmV0Ow0KPiAgCX0NCj4gIA0KPiAgCW1pbl9jZGNsayA9IHN0YXRlLT5jZGNsay5mb3JjZV9taW5f
Y2RjbGs7DQo+IEBAIC0yMDM0LDcgKzIwNDMsNyBAQCBzdGF0aWMgaW50IGludGVsX2NvbXB1dGVf
bWluX2NkY2xrKHN0cnVjdA0KPiBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQ0KPiAgICogZnV0
dXJlIHBsYXRmb3JtcyB0aGlzIGNvZGUgd2lsbCBuZWVkIHRvIGJlDQo+ICAgKiBhZGp1c3RlZC4N
Cj4gICAqLw0KPiAtc3RhdGljIHU4IGJ4dF9jb21wdXRlX21pbl92b2x0YWdlX2xldmVsKHN0cnVj
dCBpbnRlbF9hdG9taWNfc3RhdGUNCj4gKnN0YXRlKQ0KPiArc3RhdGljIGludCBieHRfY29tcHV0
ZV9taW5fdm9sdGFnZV9sZXZlbChzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlDQo+ICpzdGF0ZSkN
Cj4gIHsNCj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHN0
YXRlLT5iYXNlLmRldik7DQo+ICAJc3RydWN0IGludGVsX2NydGMgKmNydGM7DQo+IEBAIC0yMDQ3
LDExICsyMDU2LDIxIEBAIHN0YXRpYyB1OA0KPiBieHRfY29tcHV0ZV9taW5fdm9sdGFnZV9sZXZl
bChzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkNCj4gIAkgICAgICAgc2l6ZW9mKHN0
YXRlLT5taW5fdm9sdGFnZV9sZXZlbCkpOw0KPiAgDQo+ICAJZm9yX2VhY2hfbmV3X2ludGVsX2Ny
dGNfaW5fc3RhdGUoc3RhdGUsIGNydGMsIGNydGNfc3RhdGUsIGkpIHsNCj4gKwkJaW50IHJldDsN
Cj4gKw0KPiAgCQlpZiAoY3J0Y19zdGF0ZS0+YmFzZS5lbmFibGUpDQo+IC0JCQlzdGF0ZS0+bWlu
X3ZvbHRhZ2VfbGV2ZWxbaV0gPQ0KPiAtCQkJCWNydGNfc3RhdGUtPm1pbl92b2x0YWdlX2xldmVs
Ow0KPiArCQkJbWluX3ZvbHRhZ2VfbGV2ZWwgPSBjcnRjX3N0YXRlLQ0KPiA+bWluX3ZvbHRhZ2Vf
bGV2ZWw7DQo+ICAJCWVsc2UNCj4gLQkJCXN0YXRlLT5taW5fdm9sdGFnZV9sZXZlbFtpXSA9IDA7
DQo+ICsJCQltaW5fdm9sdGFnZV9sZXZlbCA9IDA7DQo+ICsNCj4gKwkJaWYgKHN0YXRlLT5taW5f
dm9sdGFnZV9sZXZlbFtpXSA9PSBtaW5fdm9sdGFnZV9sZXZlbCkNCj4gKwkJCWNvbnRpbnVlOw0K
PiArDQo+ICsJCXN0YXRlLT5taW5fdm9sdGFnZV9sZXZlbFtpXSA9IG1pbl92b2x0YWdlX2xldmVs
Ow0KPiArDQo+ICsJCXJldCA9IGludGVsX2F0b21pY19sb2NrX2dsb2JhbF9zdGF0ZShzdGF0ZSk7
DQo+ICsJCWlmIChyZXQpDQo+ICsJCQlyZXR1cm4gcmV0Ow0KPiAgCX0NCj4gIA0KPiAgCW1pbl92
b2x0YWdlX2xldmVsID0gMDsNCj4gQEAgLTIxOTUsMjAgKzIyMTQsMjQgQEAgc3RhdGljIGludCBz
a2xfbW9kZXNldF9jYWxjX2NkY2xrKHN0cnVjdA0KPiBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRl
KQ0KPiAgc3RhdGljIGludCBieHRfbW9kZXNldF9jYWxjX2NkY2xrKHN0cnVjdCBpbnRlbF9hdG9t
aWNfc3RhdGUgKnN0YXRlKQ0KPiAgew0KPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoc3RhdGUtPmJhc2UuZGV2KTsNCj4gLQlpbnQgbWluX2NkY2xrLCBjZGNs
aywgdmNvOw0KPiArCWludCBtaW5fY2RjbGssIG1pbl92b2x0YWdlX2xldmVsLCBjZGNsaywgdmNv
Ow0KPiAgDQo+ICAJbWluX2NkY2xrID0gaW50ZWxfY29tcHV0ZV9taW5fY2RjbGsoc3RhdGUpOw0K
PiAgCWlmIChtaW5fY2RjbGsgPCAwKQ0KPiAgCQlyZXR1cm4gbWluX2NkY2xrOw0KPiAgDQo+ICsJ
bWluX3ZvbHRhZ2VfbGV2ZWwgPSBieHRfY29tcHV0ZV9taW5fdm9sdGFnZV9sZXZlbChzdGF0ZSk7
DQo+ICsJaWYgKG1pbl92b2x0YWdlX2xldmVsIDwgMCkNCj4gKwkJcmV0dXJuIG1pbl92b2x0YWdl
X2xldmVsOw0KPiArDQo+ICAJY2RjbGsgPSBieHRfY2FsY19jZGNsayhkZXZfcHJpdiwgbWluX2Nk
Y2xrKTsNCj4gIAl2Y28gPSBieHRfY2FsY19jZGNsa19wbGxfdmNvKGRldl9wcml2LCBjZGNsayk7
DQo+ICANCj4gIAlzdGF0ZS0+Y2RjbGsubG9naWNhbC52Y28gPSB2Y287DQo+ICAJc3RhdGUtPmNk
Y2xrLmxvZ2ljYWwuY2RjbGsgPSBjZGNsazsNCj4gIAlzdGF0ZS0+Y2RjbGsubG9naWNhbC52b2x0
YWdlX2xldmVsID0NCj4gLQkJbWF4KGRldl9wcml2LT5kaXNwbGF5LmNhbGNfdm9sdGFnZV9sZXZl
bChjZGNsayksDQo+IC0JCSAgICBieHRfY29tcHV0ZV9taW5fdm9sdGFnZV9sZXZlbChzdGF0ZSkp
Ow0KPiArCQltYXhfdChpbnQsIG1pbl92b2x0YWdlX2xldmVsLA0KPiArCQkgICAgICBkZXZfcHJp
di0+ZGlzcGxheS5jYWxjX3ZvbHRhZ2VfbGV2ZWwoY2RjbGspKTsNCj4gIA0KPiAgCWlmICghc3Rh
dGUtPmFjdGl2ZV9waXBlcykgew0KPiAgCQljZGNsayA9IGJ4dF9jYWxjX2NkY2xrKGRldl9wcml2
LCBzdGF0ZS0NCj4gPmNkY2xrLmZvcmNlX21pbl9jZGNsayk7DQo+IEBAIC0yMjI1LDIzICsyMjQ4
LDYgQEAgc3RhdGljIGludCBieHRfbW9kZXNldF9jYWxjX2NkY2xrKHN0cnVjdA0KPiBpbnRlbF9h
dG9taWNfc3RhdGUgKnN0YXRlKQ0KPiAgCXJldHVybiAwOw0KPiAgfQ0KPiAgDQo+IC1zdGF0aWMg
aW50IGludGVsX2xvY2tfYWxsX3BpcGVzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRl
KQ0KPiAtew0KPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
c3RhdGUtPmJhc2UuZGV2KTsNCj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsNCj4gLQ0KPiAt
CS8qIEFkZCBhbGwgcGlwZXMgdG8gdGhlIHN0YXRlICovDQo+IC0JZm9yX2VhY2hfaW50ZWxfY3J0
YygmZGV2X3ByaXYtPmRybSwgY3J0Yykgew0KPiAtCQlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZTsNCj4gLQ0KPiAtCQljcnRjX3N0YXRlID0gaW50ZWxfYXRvbWljX2dldF9jcnRj
X3N0YXRlKCZzdGF0ZS0+YmFzZSwNCj4gY3J0Yyk7DQo+IC0JCWlmIChJU19FUlIoY3J0Y19zdGF0
ZSkpDQo+IC0JCQlyZXR1cm4gUFRSX0VSUihjcnRjX3N0YXRlKTsNCj4gLQl9DQo+IC0NCj4gLQly
ZXR1cm4gMDsNCj4gLX0NCj4gLQ0KPiAgc3RhdGljIGludCBpbnRlbF9tb2Rlc2V0X2FsbF9waXBl
cyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkNCj4gIHsNCj4gIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHN0YXRlLT5iYXNlLmRldik7DQo+IEBA
IC0yMzA4LDQ2ICsyMzE0LDU2IEBAIGludCBpbnRlbF9tb2Rlc2V0X2NhbGNfY2RjbGsoc3RydWN0
DQo+IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpDQo+ICAJCXJldHVybiByZXQ7DQo+ICANCj4g
IAkvKg0KPiAtCSAqIFdyaXRlcyB0byBkZXZfcHJpdi0+Y2RjbGsubG9naWNhbCBtdXN0IHByb3Rl
Y3RlZCBieQ0KPiAtCSAqIGhvbGRpbmcgYWxsIHRoZSBjcnRjIGxvY2tzLCBldmVuIGlmIHdlIGRv
bid0IGVuZCB1cA0KPiArCSAqIFdyaXRlcyB0byBkZXZfcHJpdi0+Y2RjbGsue2FjdHVhbCxsb2dp
Y2FsfSBtdXN0IHByb3RlY3RlZA0KPiArCSAqIGJ5IGhvbGRpbmcgYWxsIHRoZSBjcnRjIG11dGV4
ZXMgZXZlbiBpZiB3ZSBkb24ndCBlbmQgdXANCj4gIAkgKiB0b3VjaGluZyB0aGUgaGFyZHdhcmUN
Cj4gIAkgKi8NCj4gLQlpZiAoaW50ZWxfY2RjbGtfY2hhbmdlZCgmZGV2X3ByaXYtPmNkY2xrLmxv
Z2ljYWwsDQo+IC0JCQkJJnN0YXRlLT5jZGNsay5sb2dpY2FsKSkgew0KPiAtCQlyZXQgPSBpbnRl
bF9sb2NrX2FsbF9waXBlcyhzdGF0ZSk7DQo+IC0JCWlmIChyZXQgPCAwKQ0KPiArCWlmIChpbnRl
bF9jZGNsa19jaGFuZ2VkKCZkZXZfcHJpdi0+Y2RjbGsuYWN0dWFsLA0KPiArCQkJCSZzdGF0ZS0+
Y2RjbGsuYWN0dWFsKSkgew0KPiArCQkvKg0KPiArCQkgKiBBbHNvIHNlcmlhbGl6ZSBjb21taXRz
IGFjcm9zcyBhbGwgY3J0Y3MNCj4gKwkJICogaWYgdGhlIGFjdHVhbCBodyBuZWVkcyB0byBiZSBw
b2tlZC4NCj4gKwkJICovDQo+ICsJCXJldCA9IGludGVsX2F0b21pY19zZXJpYWxpemVfZ2xvYmFs
X3N0YXRlKHN0YXRlKTsNCj4gKwkJaWYgKHJldCkNCj4gKwkJCXJldHVybiByZXQ7DQo+ICsJfSBl
bHNlIGlmIChpbnRlbF9jZGNsa19jaGFuZ2VkKCZkZXZfcHJpdi0+Y2RjbGsubG9naWNhbCwNCj4g
KwkJCQkgICAgICAgJnN0YXRlLT5jZGNsay5sb2dpY2FsKSkgew0KPiArCQlyZXQgPSBpbnRlbF9h
dG9taWNfbG9ja19nbG9iYWxfc3RhdGUoc3RhdGUpOw0KPiArCQlpZiAocmV0KQ0KPiAgCQkJcmV0
dXJuIHJldDsNCj4gKwl9IGVsc2Ugew0KPiArCQlyZXR1cm4gMDsNCj4gIAl9DQo+ICANCj4gLQlp
ZiAoaXNfcG93ZXJfb2ZfMihzdGF0ZS0+YWN0aXZlX3BpcGVzKSkgew0KPiArCWlmIChpc19wb3dl
cl9vZl8yKHN0YXRlLT5hY3RpdmVfcGlwZXMpICYmDQo+ICsJICAgIGludGVsX2NkY2xrX25lZWRz
X2NkMnhfdXBkYXRlKGRldl9wcml2LA0KPiArCQkJCQkgICZkZXZfcHJpdi0+Y2RjbGsuYWN0dWFs
LA0KPiArCQkJCQkgICZzdGF0ZS0+Y2RjbGsuYWN0dWFsKSkgew0KPiAgCQlzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YzsNCj4gIAkJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGU7DQo+
ICANCj4gIAkJcGlwZSA9IGlsb2cyKHN0YXRlLT5hY3RpdmVfcGlwZXMpOw0KPiAgCQljcnRjID0g
aW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIHBpcGUpOw0KPiAtCQljcnRjX3N0YXRl
ID0gaW50ZWxfYXRvbWljX2dldF9uZXdfY3J0Y19zdGF0ZShzdGF0ZSwNCj4gY3J0Yyk7DQo+IC0J
CWlmIChjcnRjX3N0YXRlICYmDQo+IC0JCSAgICBkcm1fYXRvbWljX2NydGNfbmVlZHNfbW9kZXNl
dCgmY3J0Y19zdGF0ZS0+YmFzZSkpDQo+ICsNCj4gKwkJY3J0Y19zdGF0ZSA9IGludGVsX2F0b21p
Y19nZXRfY3J0Y19zdGF0ZSgmc3RhdGUtPmJhc2UsDQo+IGNydGMpOw0KPiArCQlpZiAoSVNfRVJS
KGNydGNfc3RhdGUpKQ0KPiArCQkJcmV0dXJuIFBUUl9FUlIoY3J0Y19zdGF0ZSk7DQo+ICsNCj4g
KwkJaWYgKGRybV9hdG9taWNfY3J0Y19uZWVkc19tb2Rlc2V0KCZjcnRjX3N0YXRlLT5iYXNlKSkN
Cj4gIAkJCXBpcGUgPSBJTlZBTElEX1BJUEU7DQo+ICAJfSBlbHNlIHsNCj4gIAkJcGlwZSA9IElO
VkFMSURfUElQRTsNCj4gIAl9DQo+ICANCj4gLQkvKiBBbGwgcGlwZXMgbXVzdCBiZSBzd2l0Y2hl
ZCBvZmYgd2hpbGUgd2UgY2hhbmdlIHRoZSBjZGNsay4gKi8NCj4gLQlpZiAocGlwZSAhPSBJTlZB
TElEX1BJUEUgJiYNCj4gLQkgICAgaW50ZWxfY2RjbGtfbmVlZHNfY2QyeF91cGRhdGUoZGV2X3By
aXYsDQo+IC0JCQkJCSAgJmRldl9wcml2LT5jZGNsay5hY3R1YWwsDQo+IC0JCQkJCSAgJnN0YXRl
LT5jZGNsay5hY3R1YWwpKSB7DQo+IC0JCXJldCA9IGludGVsX2xvY2tfYWxsX3BpcGVzKHN0YXRl
KTsNCj4gLQkJaWYgKHJldCkNCj4gLQkJCXJldHVybiByZXQ7DQo+IC0NCj4gKwlpZiAocGlwZSAh
PSBJTlZBTElEX1BJUEUpIHsNCj4gIAkJc3RhdGUtPmNkY2xrLnBpcGUgPSBwaXBlOw0KPiAgDQo+
ICAJCURSTV9ERUJVR19LTVMoIkNhbiBjaGFuZ2UgY2RjbGsgd2l0aCBwaXBlICVjIGFjdGl2ZVxu
IiwNCj4gIAkJCSAgICAgIHBpcGVfbmFtZShwaXBlKSk7DQo+ICAJfSBlbHNlIGlmIChpbnRlbF9j
ZGNsa19uZWVkc19tb2Rlc2V0KCZkZXZfcHJpdi0+Y2RjbGsuYWN0dWFsLA0KPiAgCQkJCQkgICAg
ICZzdGF0ZS0+Y2RjbGsuYWN0dWFsKSkgew0KPiArCQkvKiBBbGwgcGlwZXMgbXVzdCBiZSBzd2l0
Y2hlZCBvZmYgd2hpbGUgd2UgY2hhbmdlIHRoZQ0KPiBjZGNsay4gKi8NCj4gIAkJcmV0ID0gaW50
ZWxfbW9kZXNldF9hbGxfcGlwZXMoc3RhdGUpOw0KPiAgCQlpZiAocmV0KQ0KPiAgCQkJcmV0dXJu
IHJldDsNCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZGlzcGxheS5jDQo+IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5
LmMNCj4gaW5kZXggN2Q3ZDE4NTk3NzVhLi5hODQ0NGQ5ODQxYzEgMTAwNjQ0DQo+IC0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jDQo+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jDQo+IEBAIC0xMjE5MSw2ICsx
MjE5MSwxMiBAQCBzdGF0aWMgYm9vbA0KPiBjaGVja19kaWdpdGFsX3BvcnRfY29uZmxpY3RzKHN0
cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQ0KPiAgCXVuc2lnbmVkIGludCB1c2VkX21z
dF9wb3J0cyA9IDA7DQo+ICAJYm9vbCByZXQgPSB0cnVlOw0KPiAgDQo+ICsJLyoNCj4gKwkgKiBX
ZSdyZSBnb2luZyB0byBwZWVrIGludG8gY29ubmVjdG9yLT5zdGF0ZSwNCj4gKwkgKiBoZW5jZSBj
b25uZWN0aW9uX211dGV4IG11c3QgYmUgaGVsZC4NCj4gKwkgKi8NCj4gKwlkcm1fbW9kZXNldF9s
b2NrX2Fzc2VydF9oZWxkKCZkZXYtDQo+ID5tb2RlX2NvbmZpZy5jb25uZWN0aW9uX211dGV4KTsN
Cj4gKw0KPiAgCS8qDQo+ICAJICogV2FsayB0aGUgY29ubmVjdG9yIGxpc3QgaW5zdGVhZCBvZiB0
aGUgZW5jb2Rlcg0KPiAgCSAqIGxpc3QgdG8gZGV0ZWN0IHRoZSBwcm9ibGVtIG9uIGRkaSBwbGF0
Zm9ybXMNCj4gQEAgLTEzNDYzLDcgKzEzNDY5LDYgQEAgc3RhdGljIGludCBpbnRlbF9tb2Rlc2V0
X2NoZWNrcyhzdHJ1Y3QNCj4gaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkNCj4gIAlzdGF0ZS0+
YWN0aXZlX3BpcGVzID0gZGV2X3ByaXYtPmFjdGl2ZV9waXBlczsNCj4gIAlzdGF0ZS0+Y2RjbGsu
bG9naWNhbCA9IGRldl9wcml2LT5jZGNsay5sb2dpY2FsOw0KPiAgCXN0YXRlLT5jZGNsay5hY3R1
YWwgPSBkZXZfcHJpdi0+Y2RjbGsuYWN0dWFsOw0KPiAtCXN0YXRlLT5jZGNsay5waXBlID0gSU5W
QUxJRF9QSVBFOw0KPiAgDQo+ICAJZm9yX2VhY2hfb2xkbmV3X2ludGVsX2NydGNfaW5fc3RhdGUo
c3RhdGUsIGNydGMsDQo+IG9sZF9jcnRjX3N0YXRlLA0KPiAgCQkJCQkgICAgbmV3X2NydGNfc3Rh
dGUsIGkpIHsNCj4gQEAgLTEzNDc2LDYgKzEzNDgxLDEyIEBAIHN0YXRpYyBpbnQgaW50ZWxfbW9k
ZXNldF9jaGVja3Moc3RydWN0DQo+IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpDQo+ICAJCQlz
dGF0ZS0+YWN0aXZlX3BpcGVfY2hhbmdlcyB8PSBCSVQoY3J0Yy0+cGlwZSk7DQo+ICAJfQ0KPiAg
DQo+ICsJaWYgKHN0YXRlLT5hY3RpdmVfcGlwZV9jaGFuZ2VzKSB7DQo+ICsJCXJldCA9IGludGVs
X2F0b21pY19sb2NrX2dsb2JhbF9zdGF0ZShzdGF0ZSk7DQo+ICsJCWlmIChyZXQpDQo+ICsJCQly
ZXR1cm4gcmV0Ow0KPiArCX0NCj4gKw0KPiAgCXJldCA9IGludGVsX21vZGVzZXRfY2FsY19jZGNs
ayhzdGF0ZSk7DQo+ICAJaWYgKHJldCkNCj4gIAkJcmV0dXJuIHJldDsNCj4gQEAgLTEzNTc3LDcg
KzEzNTg4LDcgQEAgc3RhdGljIGludCBpbnRlbF9hdG9taWNfY2hlY2soc3RydWN0DQo+IGRybV9k
ZXZpY2UgKmRldiwNCj4gIAlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUs
ICpuZXdfY3J0Y19zdGF0ZTsNCj4gIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsNCj4gIAlpbnQg
cmV0LCBpOw0KPiAtCWJvb2wgYW55X21zID0gc3RhdGUtPmNkY2xrLmZvcmNlX21pbl9jZGNsa19j
aGFuZ2VkOw0KPiArCWJvb2wgYW55X21zID0gZmFsc2U7DQo+ICANCj4gIAkvKiBDYXRjaCBJOTE1
X01PREVfRkxBR19JTkhFUklURUQgKi8NCj4gIAlmb3JfZWFjaF9vbGRuZXdfaW50ZWxfY3J0Y19p
bl9zdGF0ZShzdGF0ZSwgY3J0YywNCj4gb2xkX2NydGNfc3RhdGUsDQo+IEBAIC0xMzYxNSw2ICsx
MzYyNiw4IEBAIHN0YXRpYyBpbnQgaW50ZWxfYXRvbWljX2NoZWNrKHN0cnVjdA0KPiBkcm1fZGV2
aWNlICpkZXYsDQo+ICAJaWYgKHJldCkNCj4gIAkJZ290byBmYWlsOw0KPiAgDQo+ICsJYW55X21z
IHw9IHN0YXRlLT5jZGNsay5mb3JjZV9taW5fY2RjbGtfY2hhbmdlZDsNCj4gKw0KPiAgCWlmIChh
bnlfbXMpIHsNCj4gIAkJcmV0ID0gaW50ZWxfbW9kZXNldF9jaGVja3Moc3RhdGUpOw0KPiAgCQlp
ZiAocmV0KQ0KPiBAQCAtMTQyMzQsNiArMTQyNDcsMTQgQEAgc3RhdGljIHZvaWQgaW50ZWxfYXRv
bWljX3RyYWNrX2ZicyhzdHJ1Y3QNCj4gaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkNCj4gIAkJ
CQkJcGxhbmUtPmZyb250YnVmZmVyX2JpdCk7DQo+ICB9DQo+ICANCj4gK3N0YXRpYyB2b2lkIGFz
c2VydF9nbG9iYWxfc3RhdGVfbG9ja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlDQo+ICpkZXZf
cHJpdikNCj4gK3sNCj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsNCj4gKw0KPiArCWZvcl9l
YWNoX2ludGVsX2NydGMoJmRldl9wcml2LT5kcm0sIGNydGMpDQo+ICsJCWRybV9tb2Rlc2V0X2xv
Y2tfYXNzZXJ0X2hlbGQoJmNydGMtPmJhc2UubXV0ZXgpOw0KPiArfQ0KPiArDQo+ICBzdGF0aWMg
aW50IGludGVsX2F0b21pY19jb21taXQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwNCj4gIAkJCSAg
ICAgICBzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqX3N0YXRlLA0KPiAgCQkJICAgICAgIGJvb2wg
bm9uYmxvY2spDQo+IEBAIC0xNDI5OSw3ICsxNDMyMCw5IEBAIHN0YXRpYyBpbnQgaW50ZWxfYXRv
bWljX2NvbW1pdChzdHJ1Y3QNCj4gZHJtX2RldmljZSAqZGV2LA0KPiAgCWludGVsX3NoYXJlZF9k
cGxsX3N3YXBfc3RhdGUoc3RhdGUpOw0KPiAgCWludGVsX2F0b21pY190cmFja19mYnMoc3RhdGUp
Ow0KPiAgDQo+IC0JaWYgKHN0YXRlLT5tb2Rlc2V0KSB7DQo+ICsJaWYgKHN0YXRlLT5nbG9iYWxf
c3RhdGVfY2hhbmdlZCkgew0KPiArCQlhc3NlcnRfZ2xvYmFsX3N0YXRlX2xvY2tlZChkZXZfcHJp
dik7DQo+ICsNCj4gIAkJbWVtY3B5KGRldl9wcml2LT5taW5fY2RjbGssIHN0YXRlLT5taW5fY2Rj
bGssDQo+ICAJCSAgICAgICBzaXplb2Yoc3RhdGUtPm1pbl9jZGNsaykpOw0KPiAgCQltZW1jcHko
ZGV2X3ByaXYtPm1pbl92b2x0YWdlX2xldmVsLCBzdGF0ZS0NCj4gPm1pbl92b2x0YWdlX2xldmVs
LA0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNw
bGF5X3R5cGVzLmgNCj4gYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3Bs
YXlfdHlwZXMuaA0KPiBpbmRleCA0MDM5MGQ4NTU4MTUuLjAxZmVkODk1N2FkZSAxMDA2NDQNCj4g
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgN
Cj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVz
LmgNCj4gQEAgLTUwNiw2ICs1MDYsMTQgQEAgc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSB7DQo+
ICANCj4gIAlib29sIHJwc19pbnRlcmFjdGl2ZTsNCj4gIA0KPiArCS8qDQo+ICsJICogYWN0aXZl
X3BpcGVzDQo+ICsJICogbWluX2NkY2xrW10NCj4gKwkgKiBtaW5fdm9sdGFnZV9sZXZlbFtdDQo+
ICsJICogY2RjbGsuKg0KPiArCSAqLw0KPiArCWJvb2wgZ2xvYmFsX3N0YXRlX2NoYW5nZWQ7DQo+
ICsNCj4gIAkvKiBHZW45KyBvbmx5ICovDQo+ICAJc3RydWN0IHNrbF9kZGJfdmFsdWVzIHdtX3Jl
c3VsdHM7DQo+ICANCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2
LmgNCj4gYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oDQo+IGluZGV4IGM0NmIzMzkw
NjRjMC4uZDNlNjExNTJkOTI0IDEwMDY0NA0KPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2Rydi5oDQo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgNCj4gQEAg
LTExMDUsMTMgKzExMDUsMTQgQEAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgew0KPiAgCXVuc2ln
bmVkIGludCBmZGlfcGxsX2ZyZXE7DQo+ICAJdW5zaWduZWQgaW50IGN6Y2xrX2ZyZXE7DQo+ICAN
Cj4gKwkvKg0KPiArCSAqIEZvciByZWFkaW5nIGhvbGRpbmcgYW55IGNydGMgbG9jayBpcyBzdWZm
aWNpZW50LA0KPiArCSAqIGZvciB3cml0aW5nIG11c3QgaG9sZCBhbGwgb2YgdGhlbS4NCj4gKwkg
Ki8NCj4gIAlzdHJ1Y3Qgew0KPiAgCQkvKg0KPiAgCQkgKiBUaGUgY3VycmVudCBsb2dpY2FsIGNk
Y2xrIHN0YXRlLg0KPiAgCQkgKiBTZWUgaW50ZWxfYXRvbWljX3N0YXRlLmNkY2xrLmxvZ2ljYWwN
Cj4gLQkJICoNCj4gLQkJICogRm9yIHJlYWRpbmcgaG9sZGluZyBhbnkgY3J0YyBsb2NrIGlzIHN1
ZmZpY2llbnQsDQo+IC0JCSAqIGZvciB3cml0aW5nIG11c3QgaG9sZCBhbGwgb2YgdGhlbS4NCj4g
IAkJICovDQo+ICAJCXN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSBsb2dpY2FsOw0KPiAgCQkvKg0K
PiBAQCAtMTE4MSw2ICsxMTgyLDEwIEBAIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlIHsNCj4gIAkg
Ki8NCj4gIAlzdHJ1Y3QgbXV0ZXggZHBsbF9sb2NrOw0KPiAgDQo+ICsJLyoNCj4gKwkgKiBGb3Ig
cmVhZGluZyBhY3RpdmVfcGlwZXMsIG1pbl9jZGNsaywgbWluX3ZvbHRhZ2VfbGV2ZWwNCj4gaG9s
ZGluZw0KPiArCSAqIGFueSBjcnRjIGxvY2sgaXMgc3VmZmljaWVudCwgZm9yIHdyaXRpbmcgbXVz
dCBob2xkIGFsbCBvZg0KPiB0aGVtLg0KPiArCSAqLw0KPiAgCXU4IGFjdGl2ZV9waXBlczsNCj4g
IAkvKiBtaW5pbXVtIGFjY2VwdGFibGUgY2RjbGsgZm9yIGVhY2ggcGlwZSAqLw0KPiAgCWludCBt
aW5fY2RjbGtbSTkxNV9NQVhfUElQRVNdOw0KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlz
dGluZm8vaW50ZWwtZ2Z4

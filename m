Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 936ED57F61
	for <lists+intel-gfx@lfdr.de>; Thu, 27 Jun 2019 11:32:45 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 27AD46E84B;
	Thu, 27 Jun 2019 09:32:43 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 22CAE6E84A
 for <intel-gfx@lists.freedesktop.org>; Thu, 27 Jun 2019 09:32:40 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 17040751-1500050 for multiple; Thu, 27 Jun 2019 10:15:53 +0100
MIME-Version: 1.0
From: Chris Wilson <chris@chris-wilson.co.uk>
User-Agent: alot/0.6
To: Lionel Landwerlin <lionel.g.landwerlin@intel.com>,
 intel-gfx@lists.freedesktop.org
References: <20190627080045.8814-1-lionel.g.landwerlin@intel.com>
 <20190627080045.8814-7-lionel.g.landwerlin@intel.com>
In-Reply-To: <20190627080045.8814-7-lionel.g.landwerlin@intel.com>
Message-ID: <156162694988.20851.13994445934808199507@skylake-alporthouse-com>
Date: Thu, 27 Jun 2019 10:15:49 +0100
Subject: Re: [Intel-gfx] [PATCH v5 06/10] drm/i915: add syncobj timeline
 support
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVvdGluZyBMaW9uZWwgTGFuZHdlcmxpbiAoMjAxOS0wNi0yNyAwOTowMDo0MSkKPiBJbnRyb2R1
Y2VzIGEgbmV3IHBhcmFtZXRlcnMgdG8gZXhlY2J1ZiBzbyB0aGF0IHdlIGNhbiBzcGVjaWZ5IHN5
bmNvYmoKPiBoYW5kbGVzIGFzIHdlbGwgYXMgdGltZWxpbmUgcG9pbnRzLgo+IAo+IHYyOiBSZXVz
ZSBpOTE1X3VzZXJfZXh0ZW5zaW9uX2ZuCj4gCj4gU2lnbmVkLW9mZi1ieTogTGlvbmVsIExhbmR3
ZXJsaW4gPGxpb25lbC5nLmxhbmR3ZXJsaW5AaW50ZWwuY29tPgo+IC0tLQo+ICAuLi4vZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMgICAgfCAyODAgKysrKysrKysrKysrKyst
LS0tCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgICAgICAgICAgICAgICB8ICAg
MiArCj4gIGluY2x1ZGUvdWFwaS9kcm0vaTkxNV9kcm0uaCAgICAgICAgICAgICAgICAgICB8ICAz
NyArKysKPiAgMyBmaWxlcyBjaGFuZ2VkLCAyNjMgaW5zZXJ0aW9ucygrKSwgNTYgZGVsZXRpb25z
KC0pCj4gCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9l
eGVjYnVmZmVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZl
ci5jCj4gaW5kZXggMTk3MGRkOGNiYWMzLi40NzZmYWRlNmZjYWIgMTAwNjQ0Cj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYwo+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKPiBAQCAtMjEzLDYgKzIx
MywxMyBAQCBlbnVtIHsKPiAgICogdGhlIGJhdGNoYnVmZmVyIGluIHRydXN0ZWQgbW9kZSwgb3Ro
ZXJ3aXNlIHRoZSBpb2N0bCBpcyByZWplY3RlZC4KPiAgICovCj4gIAo+ICtzdHJ1Y3QgaTkxNV9k
cm1fZG1hX2ZlbmNlcyB7CgppOTE1X2V4ZWNidWZmZXJfZmVuY2VzIG9yIGViX2ZlbmNlcyBhcyBp
dCBpcyBwcml2YXRlIHRvIHRoZSBpbXBsLgoKPiArICAgICAgIHN0cnVjdCBkcm1fc3luY29iaiAq
c3luY29iajsgLyogVXNlIHdpdGggcHRyX21hc2tfYml0cygpICovCj4gKyAgICAgICBzdHJ1Y3Qg
ZG1hX2ZlbmNlICpkbWFfZmVuY2U7Cj4gKyAgICAgICB1NjQgdmFsdWU7Cj4gKyAgICAgICBzdHJ1
Y3QgZG1hX2ZlbmNlX2NoYWluICpjaGFpbl9mZW5jZTsKPiArfTsKPiArCj4gIHN0cnVjdCBpOTE1
X2V4ZWNidWZmZXIgewo+ICAgICAgICAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTU7IC8q
KiBpOTE1IGJhY2twb2ludGVyICovCj4gICAgICAgICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGU7IC8q
KiBwZXItZmlsZSBsb29rdXAgdGFibGVzIGFuZCBsaW1pdHMgKi8KPiBAQCAtMjc1LDYgKzI4Miw3
IEBAIHN0cnVjdCBpOTE1X2V4ZWNidWZmZXIgewo+ICAKPiAgICAgICAgIHN0cnVjdCB7Cj4gICAg
ICAgICAgICAgICAgIHU2NCBmbGFnczsgLyoqIEF2YWlsYWJsZSBleHRlbnNpb25zIHBhcmFtZXRl
cnMgKi8KPiArICAgICAgICAgICAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9leGVjYnVmZmVyX2V4
dF90aW1lbGluZV9mZW5jZXMgdGltZWxpbmVfZmVuY2VzOwoKQW5vdGhlciA0MGIgb24gc3RhY2su
IEdldHRpbmcgY2xvc2VyIHRvIHRob3NlIHdhcm5pbmcgYmVsbHMgYmVpbmcgc2V0IG9mZi4KCj4g
ICAgICAgICB9IGV4dGVuc2lvbnM7Cj4gIH07Cj4gIAo+IEBAIC0yMjI0LDY3ICsyMjMyLDE5MyBA
QCBlYl9zZWxlY3RfZW5naW5lKHN0cnVjdCBpOTE1X2V4ZWNidWZmZXIgKmViLAo+ICB9Cj4gIAo+
ICBzdGF0aWMgdm9pZAo+IC1fX2ZyZWVfZmVuY2VfYXJyYXkoc3RydWN0IGRybV9zeW5jb2JqICoq
ZmVuY2VzLCB1bnNpZ25lZCBpbnQgbikKPiArX19mcmVlX2ZlbmNlX2FycmF5KHN0cnVjdCBpOTE1
X2RybV9kbWFfZmVuY2VzICpmZW5jZXMsIHVuc2lnbmVkIGludCBuKQo+ICB7Cj4gLSAgICAgICB3
aGlsZSAobi0tKQo+IC0gICAgICAgICAgICAgICBkcm1fc3luY29ial9wdXQocHRyX21hc2tfYml0
cyhmZW5jZXNbbl0sIDIpKTsKPiArICAgICAgIHdoaWxlIChuLS0pIHsKPiArICAgICAgICAgICAg
ICAgZHJtX3N5bmNvYmpfcHV0KHB0cl9tYXNrX2JpdHMoZmVuY2VzW25dLnN5bmNvYmosIDIpKTsK
PiArICAgICAgICAgICAgICAgZG1hX2ZlbmNlX3B1dChmZW5jZXNbbl0uZG1hX2ZlbmNlKTsKPiAr
ICAgICAgICAgICAgICAga2ZyZWUoZmVuY2VzW25dLmNoYWluX2ZlbmNlKTsKPiArICAgICAgIH0K
PiAgICAgICAgIGt2ZnJlZShmZW5jZXMpOwo+ICB9Cj4gIAo+IC1zdGF0aWMgc3RydWN0IGRybV9z
eW5jb2JqICoqCj4gLWdldF9mZW5jZV9hcnJheShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNidWZm
ZXIyICphcmdzLAo+IC0gICAgICAgICAgICAgICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpCj4gK3N0
YXRpYyBzdHJ1Y3QgaTkxNV9kcm1fZG1hX2ZlbmNlcyAqCj4gK2dldF90aW1lbGluZV9mZW5jZV9h
cnJheShzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYiwgaW50ICpvdXRfbl9mZW5jZXMpCj4gIHsK
PiAtICAgICAgIGNvbnN0IHVuc2lnbmVkIGxvbmcgbmZlbmNlcyA9IGFyZ3MtPm51bV9jbGlwcmVj
dHM7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNidWZmZXJfZXh0X3RpbWVsaW5l
X2ZlbmNlcyAqdGltZWxpbmVfZmVuY2VzID0KPiArICAgICAgICAgICAgICAgJmViLT5leHRlbnNp
b25zLnRpbWVsaW5lX2ZlbmNlczsKPiArICAgICAgIHN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY19m
ZW5jZSBfX3VzZXIgKnVzZXJfZmVuY2VzOwo+ICsgICAgICAgc3RydWN0IGk5MTVfZHJtX2RtYV9m
ZW5jZXMgKmZlbmNlczsKPiArICAgICAgIHU2NCBfX3VzZXIgKnVzZXJfdmFsdWVzOwo+ICsgICAg
ICAgdW5zaWduZWQgbG9uZyBuOwo+ICsgICAgICAgaW50IGVycjsKPiArCj4gKyAgICAgICAqb3V0
X25fZmVuY2VzID0gdGltZWxpbmVfZmVuY2VzLT5oYW5kbGVfY291bnQ7CgpJJ2QgZW5jb3VyYWdl
IHVzaW5nIGEgY29uc3QgbnVtX2ZlbmNlcyA9IHRpbWVsaW5lX2ZlbmNlcy0+aGFuZGxlX2NvdW50
CmZvciByZWFkYWJpbGl0eSB3aXRoaW4gdGhlIGZ1bmN0aW9uIGFuZCB0aGVuIGFzc2lnbmluZwoJ
Km91dF9uX2ZlbmNlcyA9IG51bV9mZW5jZXM7CnJpZ2h0IGJlZm9yZSB0aGUgc3VjY2Vzc2Z1bCBy
ZXR1cm4gZmVuY2VzOwoKPiArICAgICAgIC8qIENoZWNrIG11bHRpcGxpY2F0aW9uIG92ZXJmbG93
IGZvciBhY2Nlc3Nfb2soKSBhbmQga3ZtYWxsb2NfYXJyYXkoKSAqLwo+ICsgICAgICAgQlVJTERf
QlVHX09OKHNpemVvZihzaXplX3QpID4gc2l6ZW9mKHVuc2lnbmVkIGxvbmcpKTsKPiArICAgICAg
IGlmICgqb3V0X25fZmVuY2VzID4gbWluX3QodW5zaWduZWQgbG9uZywKPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgVUxPTkdfTUFYIC8gc2l6ZW9mKCp1c2VyX2ZlbmNlcyksCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNJWkVfTUFYIC8gc2l6ZW9mKCpmZW5j
ZXMpKSkKPiArICAgICAgICAgICAgICAgcmV0dXJuIEVSUl9QVFIoLUVJTlZBTCk7Cj4gKwo+ICsg
ICAgICAgdXNlcl9mZW5jZXMgPSB1NjRfdG9fdXNlcl9wdHIodGltZWxpbmVfZmVuY2VzLT5oYW5k
bGVzX3B0cik7Cj4gKyAgICAgICBpZiAoIWFjY2Vzc19vayh1c2VyX2ZlbmNlcywgKm91dF9uX2Zl
bmNlcyAqIHNpemVvZigqdXNlcl9mZW5jZXMpKSkKPiArICAgICAgICAgICAgICAgcmV0dXJuIEVS
Ul9QVFIoLUVGQVVMVCk7Cj4gKwo+ICsgICAgICAgdXNlcl92YWx1ZXMgPSB1NjRfdG9fdXNlcl9w
dHIodGltZWxpbmVfZmVuY2VzLT52YWx1ZXNfcHRyKTsKPiArICAgICAgIGlmICghYWNjZXNzX29r
KHVzZXJfdmFsdWVzLCAqb3V0X25fZmVuY2VzICogc2l6ZW9mKCp1c2VyX3ZhbHVlcykpKQo+ICsg
ICAgICAgICAgICAgICByZXR1cm4gRVJSX1BUUigtRUZBVUxUKTsKCj4gKyAgICAgICBmZW5jZXMg
PSBrdm1hbGxvY19hcnJheSgqb3V0X25fZmVuY2VzLCBzaXplb2YoKmZlbmNlcyksCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBfX0dGUF9OT1dBUk4gfCBHRlBfS0VSTkVMKTsKPiAr
ICAgICAgIGlmICghZmVuY2VzKQo+ICsgICAgICAgICAgICAgICByZXR1cm4gRVJSX1BUUigtRU5P
TUVNKTsKPiArCj4gKyAgICAgICBCVUlMRF9CVUdfT04ofihBUkNIX0tNQUxMT0NfTUlOQUxJR04g
LSAxKSAmCj4gKyAgICAgICAgICAgICAgICAgICAgfl9fSTkxNV9FWEVDX0ZFTkNFX1VOS05PV05f
RkxBR1MpOwo+ICsKPiArICAgICAgIGZvciAobiA9IDA7IG4gPCAqb3V0X25fZmVuY2VzOyBuKysp
IHsKPiArICAgICAgICAgICAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9leGVjX2ZlbmNlIHVzZXJf
ZmVuY2U7Cj4gKyAgICAgICAgICAgICAgIHN0cnVjdCBkcm1fc3luY29iaiAqc3luY29iajsKPiAr
ICAgICAgICAgICAgICAgc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UgPSBOVUxMOwo+ICsgICAgICAg
ICAgICAgICB1NjQgcG9pbnQ7Cj4gKwo+ICsgICAgICAgICAgICAgICBpZiAoX19jb3B5X2Zyb21f
dXNlcigmdXNlcl9mZW5jZSwgdXNlcl9mZW5jZXMrKywgc2l6ZW9mKHVzZXJfZmVuY2UpKSkgewo+
ICsgICAgICAgICAgICAgICAgICAgICAgIGVyciA9IC1FRkFVTFQ7Cj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgZ290byBlcnI7Cj4gKyAgICAgICAgICAgICAgIH0KPiArCj4gKyAgICAgICAgICAg
ICAgIGlmICh1c2VyX2ZlbmNlLmZsYWdzICYgX19JOTE1X0VYRUNfRkVOQ0VfVU5LTk9XTl9GTEFH
Uykgewo+ICsgICAgICAgICAgICAgICAgICAgICAgIGVyciA9IC1FSU5WQUw7Cj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgZ290byBlcnI7Cj4gKyAgICAgICAgICAgICAgIH0KPiArCj4gKyAgICAg
ICAgICAgICAgIGlmIChfX2dldF91c2VyKHBvaW50LCB1c2VyX3ZhbHVlcysrKSkgewo+ICsgICAg
ICAgICAgICAgICAgICAgICAgIGVyciA9IC1FRkFVTFQ7Cj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgZ290byBlcnI7Cj4gKyAgICAgICAgICAgICAgIH0KPiArCj4gKyAgICAgICAgICAgICAgIHN5
bmNvYmogPSBkcm1fc3luY29ial9maW5kKGViLT5maWxlLCB1c2VyX2ZlbmNlLmhhbmRsZSk7Cj4g
KyAgICAgICAgICAgICAgIGlmICghc3luY29iaikgewo+ICsgICAgICAgICAgICAgICAgICAgICAg
IERSTV9ERUJVRygiSW52YWxpZCBzeW5jb2JqIGhhbmRsZSBwcm92aWRlZFxuIik7Cj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgZXJyID0gLUVJTlZBTDsKPiArICAgICAgICAgICAgICAgICAgICAg
ICBnb3RvIGVycjsKPiArICAgICAgICAgICAgICAgfQo+ICsKPiArICAgICAgICAgICAgICAgaWYg
KHVzZXJfZmVuY2UuZmxhZ3MgJiBJOTE1X0VYRUNfRkVOQ0VfV0FJVCkgewo+ICsgICAgICAgICAg
ICAgICAgICAgICAgIGZlbmNlID0gZHJtX3N5bmNvYmpfZmVuY2VfZ2V0KHN5bmNvYmopOwo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIGlmICghZmVuY2UpIHsKPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIERSTV9ERUJVRygiU3luY29iaiBoYW5kbGUgaGFzIG5vIGZlbmNlXG4iKTsK
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRybV9zeW5jb2JqX3B1dChzeW5jb2Jq
KTsKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyciA9IC1FSU5WQUw7Cj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGVycjsKPiArICAgICAgICAgICAgICAg
ICAgICAgICB9Cj4gKwo+ICsgICAgICAgICAgICAgICAgICAgICAgIGVyciA9IGRtYV9mZW5jZV9j
aGFpbl9maW5kX3NlcW5vKCZmZW5jZSwgcG9pbnQpOwoKSXMgYW4gaW1wb3J0ZWQgc3luY29iaiBh
bHdheXMgYSBmZW5jZS1jaGFpbj8KCmRybV9zeW5jb2JqX2ltcG9ydF9zeW5jX2ZpbGVfZmVuY2Uo
KSBzYXlzIG5vLgoKU2ltaWxhcmx5LCB3ZSBwdXQgb3JkaW5hcnkgZmVuY2VzIGludG8gdGhlIHN5
bmNvYmogb3Vyc2VsdmVzIGlmCnBvaW50PT0wLCBvciB0aGUgdXNlciB1c2VzIHRoZSBvbGQgcGF0
aC4KCkkgdGhpbmsgeW91IG5lZWQgc29tZXRoaW5nIGxpa2UKCmlmIChkbWFfZmVuY2VfaXNfY2hh
aW4oKSB8fCBwb2ludCkgewoJZXJyID0gZG1hX2ZlbmNlX2NoYWluX2ZpbmRfc2Vxbm8oJmZlbmNl
LCBwb2ludCk7CglpZiAoZXJyKSB7Cgl9Cn0KCj4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYg
KGVycikgewo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRFJNX0RFQlVHKCJTeW5j
b2JqIGhhbmRsZSBtaXNzaW5nIHJlcXVlc3RlZCBwb2ludFxuIik7Cj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBnb3RvIGVycjsKPiArICAgICAgICAgICAgICAgICAgICAgICB9Cj4g
KyAgICAgICAgICAgICAgIH0KPiArCj4gKyAgICAgICAgICAgICAgIC8qCj4gKyAgICAgICAgICAg
ICAgICAqIEZvciB0aW1lbGluZSBzeW5jb2JqcyB3ZSBuZWVkIHRvIGNyZWF0ZSBhIGNoYWluLgoK
Im5lZWQgdG8gcHJlYWxsb2NhdGUgY2hhaW5zIGZvciBsYXRlciBzaWduYWxpbmcKCj4gKyAgICAg
ICAgICAgICAgICAqLwo+ICsgICAgICAgICAgICAgICBpZiAocG9pbnQgIT0gMCAmJiB1c2VyX2Zl
bmNlLmZsYWdzICYgSTkxNV9FWEVDX0ZFTkNFX1NJR05BTCkgewo+ICsgICAgICAgICAgICAgICAg
ICAgICAgIGZlbmNlc1tuXS5jaGFpbl9mZW5jZSA9Cj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBrbWFsbG9jKHNpemVvZigqZmVuY2VzW25dLmNoYWluX2ZlbmNlKSwKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR0ZQX0tFUk5FTCk7Cj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgaWYgKCFmZW5jZXNbbl0uY2hhaW5fZmVuY2UpIHsKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGRtYV9mZW5jZV9wdXQoZmVuY2UpOwo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgZHJtX3N5bmNvYmpfcHV0KHN5bmNvYmopOwo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgZXJyID0gLUVOT01FTTsKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIERSTV9ERUJVRygiVW5hYmxlIHRvIGFsbG9jIGNoYWluX2ZlbmNlXG4i
KTsKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gZXJyOwo+ICsgICAgICAg
ICAgICAgICAgICAgICAgIH0KPiArICAgICAgICAgICAgICAgfSBlbHNlIHsKPiArICAgICAgICAg
ICAgICAgICAgICAgICBmZW5jZXNbbl0uY2hhaW5fZmVuY2UgPSBOVUxMOwo+ICsgICAgICAgICAg
ICAgICB9Cj4gKwo+ICsgICAgICAgICAgICAgICBmZW5jZXNbbl0uc3luY29iaiA9IHB0cl9wYWNr
X2JpdHMoc3luY29iaiwgdXNlcl9mZW5jZS5mbGFncywgMik7Cj4gKyAgICAgICAgICAgICAgIGZl
bmNlc1tuXS5kbWFfZmVuY2UgPSBmZW5jZTsKPiArICAgICAgICAgICAgICAgZmVuY2VzW25dLnZh
bHVlID0gcG9pbnQ7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgcmV0dXJuIGZlbmNlczsKPiAr
Cj4gK2VycjoKPiArICAgICAgIF9fZnJlZV9mZW5jZV9hcnJheShmZW5jZXMsIG4pOwo+ICsgICAg
ICAgcmV0dXJuIEVSUl9QVFIoZXJyKTsKPiArfQo+ICsKPiArc3RhdGljIHN0cnVjdCBpOTE1X2Ry
bV9kbWFfZmVuY2VzICoKPiArZ2V0X2xlZ2FjeV9mZW5jZV9hcnJheShzdHJ1Y3QgaTkxNV9leGVj
YnVmZmVyICplYiwKPiArICAgICAgICAgICAgICAgICAgICAgIGludCAqb3V0X25fZmVuY2VzKQo+
ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNidWZmZXIyICphcmdzID0gZWIt
PmFyZ3M7Cj4gICAgICAgICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNfZmVuY2UgX191c2VyICp1
c2VyOwo+IC0gICAgICAgc3RydWN0IGRybV9zeW5jb2JqICoqZmVuY2VzOwo+ICsgICAgICAgc3Ry
dWN0IGk5MTVfZHJtX2RtYV9mZW5jZXMgKmZlbmNlczsKPiAgICAgICAgIHVuc2lnbmVkIGxvbmcg
bjsKPiAgICAgICAgIGludCBlcnI7Cj4gIAo+IC0gICAgICAgaWYgKCEoYXJncy0+ZmxhZ3MgJiBJ
OTE1X0VYRUNfRkVOQ0VfQVJSQVkpKQo+IC0gICAgICAgICAgICAgICByZXR1cm4gTlVMTDsKPiAr
ICAgICAgICpvdXRfbl9mZW5jZXMgPSBhcmdzLT5udW1fY2xpcHJlY3RzOwoKU2FtZSBzdWdnZXN0
aW9uIGFzIGVhcmxpZXIgZm9yIGEgbG9jYWwgbnVtX2ZlbmNlcy4KCj4gK3N0YXRpYyBzdHJ1Y3Qg
aTkxNV9kcm1fZG1hX2ZlbmNlcyAqCj4gK2dldF9mZW5jZV9hcnJheShzdHJ1Y3QgaTkxNV9leGVj
YnVmZmVyICplYiwgaW50ICpvdXRfbl9mZW5jZXMpCj4gK3sKPiArICAgICAgIGlmIChlYi0+YXJn
cy0+ZmxhZ3MgJiBJOTE1X0VYRUNfRkVOQ0VfQVJSQVkpCj4gKyAgICAgICAgICAgICAgIHJldHVy
biBnZXRfbGVnYWN5X2ZlbmNlX2FycmF5KGViLCBvdXRfbl9mZW5jZXMpOwoKQmxhbmsgbGluZS4K
Cj4gKyAgICAgICBpZiAoZWItPmV4dGVuc2lvbnMuZmxhZ3MgJiBCSVQoRFJNX0k5MTVfR0VNX0VY
RUNCVUZGRVJfRVhUX1RJTUVMSU5FX0ZFTkNFUykpCj4gKyAgICAgICAgICAgICAgIHJldHVybiBn
ZXRfdGltZWxpbmVfZmVuY2VfYXJyYXkoZWIsIG91dF9uX2ZlbmNlcyk7Cj4gKwo+ICsgICAgICAg
Km91dF9uX2ZlbmNlcyA9IDA7Cj4gKwpObyBibGFuayBsaW5lLCBteSBhcmd1bWVudCBpcyB0aGF0
IGJvdGggYXJlIHBhcnQgb2YgdGhlIHJldHVybiB2YWx1ZSBmb3IKdGhlIGZ1bmN0aW9uLgo+ICsg
ICAgICAgcmV0dXJuIE5VTEw7Cj4gK30KPiArCj4gIHN0YXRpYyB2b2lkCj4gLXB1dF9mZW5jZV9h
cnJheShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNidWZmZXIyICphcmdzLAo+IC0gICAgICAgICAg
ICAgICBzdHJ1Y3QgZHJtX3N5bmNvYmogKipmZW5jZXMpCj4gK3B1dF9mZW5jZV9hcnJheShzdHJ1
Y3QgaTkxNV9kcm1fZG1hX2ZlbmNlcyAqZmVuY2VzLCBpbnQgbmZlbmNlcykKPiAgewo+ICAgICAg
ICAgaWYgKGZlbmNlcykKPiAtICAgICAgICAgICAgICAgX19mcmVlX2ZlbmNlX2FycmF5KGZlbmNl
cywgYXJncy0+bnVtX2NsaXByZWN0cyk7Cj4gKyAgICAgICAgICAgICAgIF9fZnJlZV9mZW5jZV9h
cnJheShmZW5jZXMsIG5mZW5jZXMpOwo+ICB9Cj4gIAo+ICBzdGF0aWMgaW50Cj4gIGF3YWl0X2Zl
bmNlX2FycmF5KHN0cnVjdCBpOTE1X2V4ZWNidWZmZXIgKmViLAo+IC0gICAgICAgICAgICAgICAg
IHN0cnVjdCBkcm1fc3luY29iaiAqKmZlbmNlcykKPiArICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
aTkxNV9kcm1fZG1hX2ZlbmNlcyAqZmVuY2VzLAo+ICsgICAgICAgICAgICAgICAgIGludCBuZmVu
Y2VzKQo+ICB7Cj4gLSAgICAgICBjb25zdCB1bnNpZ25lZCBpbnQgbmZlbmNlcyA9IGViLT5hcmdz
LT5udW1fY2xpcHJlY3RzOwo+ICAgICAgICAgdW5zaWduZWQgaW50IG47Cj4gICAgICAgICBpbnQg
ZXJyOwo+ICAKPiAgICAgICAgIGZvciAobiA9IDA7IG4gPCBuZmVuY2VzOyBuKyspIHsKPiAgICAg
ICAgICAgICAgICAgc3RydWN0IGRybV9zeW5jb2JqICpzeW5jb2JqOwo+IC0gICAgICAgICAgICAg
ICBzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZTsKPiAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50
IGZsYWdzOwo+ICAKPiAtICAgICAgICAgICAgICAgc3luY29iaiA9IHB0cl91bnBhY2tfYml0cyhm
ZW5jZXNbbl0sICZmbGFncywgMik7Cj4gKyAgICAgICAgICAgICAgIHN5bmNvYmogPSBwdHJfdW5w
YWNrX2JpdHMoZmVuY2VzW25dLnN5bmNvYmosICZmbGFncywgMik7Cj4gICAgICAgICAgICAgICAg
IGlmICghKGZsYWdzICYgSTkxNV9FWEVDX0ZFTkNFX1dBSVQpKQo+ICAgICAgICAgICAgICAgICAg
ICAgICAgIGNvbnRpbnVlOwo+ICAKPiAtICAgICAgICAgICAgICAgZmVuY2UgPSBkcm1fc3luY29i
al9mZW5jZV9nZXQoc3luY29iaik7Cj4gLSAgICAgICAgICAgICAgIGlmICghZmVuY2UpCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4gLQo+IC0gICAgICAgICAgICAg
ICBlcnIgPSBpOTE1X3JlcXVlc3RfYXdhaXRfZG1hX2ZlbmNlKGViLT5yZXF1ZXN0LCBmZW5jZSk7
Cj4gLSAgICAgICAgICAgICAgIGRtYV9mZW5jZV9wdXQoZmVuY2UpOwo+ICsgICAgICAgICAgICAg
ICBlcnIgPSBpOTE1X3JlcXVlc3RfYXdhaXRfZG1hX2ZlbmNlKGViLT5yZXF1ZXN0LAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZlbmNlc1tuXS5k
bWFfZmVuY2UpOwo+ICAgICAgICAgICAgICAgICBpZiAoZXJyIDwgMCkKPiAgICAgICAgICAgICAg
ICAgICAgICAgICByZXR1cm4gZXJyOwo+ICAgICAgICAgfQo+IEBAIC0yMzM0LDkgKzI0NzUsOSBA
QCBhd2FpdF9mZW5jZV9hcnJheShzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYiwKPiAgCj4gIHN0
YXRpYyB2b2lkCj4gIHNpZ25hbF9mZW5jZV9hcnJheShzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICpl
YiwKPiAtICAgICAgICAgICAgICAgICAgc3RydWN0IGRybV9zeW5jb2JqICoqZmVuY2VzKQo+ICsg
ICAgICAgICAgICAgICAgICBzdHJ1Y3QgaTkxNV9kcm1fZG1hX2ZlbmNlcyAqZmVuY2VzLAo+ICsg
ICAgICAgICAgICAgICAgICBpbnQgbmZlbmNlcykKPiAgewo+IC0gICAgICAgY29uc3QgdW5zaWdu
ZWQgaW50IG5mZW5jZXMgPSBlYi0+YXJncy0+bnVtX2NsaXByZWN0czsKPiAgICAgICAgIHN0cnVj
dCBkbWFfZmVuY2UgKiBjb25zdCBmZW5jZSA9ICZlYi0+cmVxdWVzdC0+ZmVuY2U7Cj4gICAgICAg
ICB1bnNpZ25lZCBpbnQgbjsKPiAgCj4gQEAgLTIzNDQsMTUgKzI0ODUsNDMgQEAgc2lnbmFsX2Zl
bmNlX2FycmF5KHN0cnVjdCBpOTE1X2V4ZWNidWZmZXIgKmViLAo+ICAgICAgICAgICAgICAgICBz
dHJ1Y3QgZHJtX3N5bmNvYmogKnN5bmNvYmo7Cj4gICAgICAgICAgICAgICAgIHVuc2lnbmVkIGlu
dCBmbGFnczsKPiAgCj4gLSAgICAgICAgICAgICAgIHN5bmNvYmogPSBwdHJfdW5wYWNrX2JpdHMo
ZmVuY2VzW25dLCAmZmxhZ3MsIDIpOwo+ICsgICAgICAgICAgICAgICBzeW5jb2JqID0gcHRyX3Vu
cGFja19iaXRzKGZlbmNlc1tuXS5zeW5jb2JqLCAmZmxhZ3MsIDIpOwo+ICAgICAgICAgICAgICAg
ICBpZiAoIShmbGFncyAmIEk5MTVfRVhFQ19GRU5DRV9TSUdOQUwpKQo+ICAgICAgICAgICAgICAg
ICAgICAgICAgIGNvbnRpbnVlOwo+ICAKPiAtICAgICAgICAgICAgICAgZHJtX3N5bmNvYmpfcmVw
bGFjZV9mZW5jZShzeW5jb2JqLCBmZW5jZSk7Cj4gKyAgICAgICAgICAgICAgIGlmIChmZW5jZXNb
bl0uY2hhaW5fZmVuY2UpIHsKPiArICAgICAgICAgICAgICAgICAgICAgICBkcm1fc3luY29ial9h
ZGRfcG9pbnQoc3luY29iaiwgZmVuY2VzW25dLmNoYWluX2ZlbmNlLAo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmZW5jZSwgZmVuY2VzW25dLnZhbHVlKTsK
PiArICAgICAgICAgICAgICAgICAgICAgICAvKgo+ICsgICAgICAgICAgICAgICAgICAgICAgICAq
IFRoZSBjaGFpbidzIG93bmVyc2hpcCBpcyB0cmFuc2ZlcmVkIHRvIHRoZQo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAqIHRpbWVsaW5lLgo+ICsgICAgICAgICAgICAgICAgICAgICAgICAqLwo+
ICsgICAgICAgICAgICAgICAgICAgICAgIGZlbmNlc1tuXS5jaGFpbl9mZW5jZSA9IE5VTEw7Cj4g
KyAgICAgICAgICAgICAgIH0gZWxzZSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgZHJtX3N5
bmNvYmpfcmVwbGFjZV9mZW5jZShzeW5jb2JqLCBmZW5jZSk7Cj4gKyAgICAgICAgICAgICAgIH0K
PiAgICAgICAgIH0KPiAgfQo+ICAKPiArc3RhdGljIGludCBwYXJzZV90aW1lbGluZV9mZW5jZXMo
c3RydWN0IGk5MTVfdXNlcl9leHRlbnNpb24gX191c2VyICpleHQsIHZvaWQgKmRhdGEpCj4gK3sK
PiArICAgICAgIHN0cnVjdCBpOTE1X2V4ZWNidWZmZXIgKmViID0gZGF0YTsKPiArCj4gKyAgICAg
ICAvKiBUaW1lbGluZSBmZW5jZXMgYXJlIGluY29tcGF0aWJsZSB3aXRoIHRoZSBmZW5jZSBhcnJh
eSBmbGFnLiAqLwo+ICsgICAgICAgaWYgKGViLT5hcmdzLT5mbGFncyAmIEk5MTVfRVhFQ19GRU5D
RV9BUlJBWSkKPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CgpBbHNvIHlvdSBvbmx5
IGFsbG93IG9uZSB0aW1lbGluZV9mZW5jZSBleHRlbnNpb24gc3RydWN0LgoKPiArCj4gKyAgICAg
ICBpZiAoY29weV9mcm9tX3VzZXIoJmViLT5leHRlbnNpb25zLnRpbWVsaW5lX2ZlbmNlcywgZXh0
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVvZihlYi0+ZXh0ZW5zaW9ucy50aW1l
bGluZV9mZW5jZXMpKSkKPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FRkFVTFQ7Cj4gKwo+ICsg
ICAgICAgZWItPmV4dGVuc2lvbnMuZmxhZ3MgfD0gQklUKERSTV9JOTE1X0dFTV9FWEVDQlVGRkVS
X0VYVF9USU1FTElORV9GRU5DRVMpOwo+ICsKPiArICAgICAgIHJldHVybiAwOwo+ICt9Cj4gKwo+
ICBzdGF0aWMgY29uc3QgaTkxNV91c2VyX2V4dGVuc2lvbl9mbiBleGVjYnVmX2V4dGVuc2lvbnNb
XSA9IHsKPiArICAgICAgICBbRFJNX0k5MTVfR0VNX0VYRUNCVUZGRVJfRVhUX1RJTUVMSU5FX0ZF
TkNFU10gPSBwYXJzZV90aW1lbGluZV9mZW5jZXMsCj4gIH07Cj4gIAo+ICBzdGF0aWMgaW50Cj4g
QEAgLTIzNzIsMTQgKzI1NDEsMTUgQEAgc3RhdGljIGludAo+ICBpOTE1X2dlbV9kb19leGVjYnVm
ZmVyKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gICAgICAgICAgICAgICAgICAgICAgICBzdHJ1
Y3QgZHJtX2ZpbGUgKmZpbGUsCj4gICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgZHJtX2k5
MTVfZ2VtX2V4ZWNidWZmZXIyICphcmdzLAo+IC0gICAgICAgICAgICAgICAgICAgICAgc3RydWN0
IGRybV9pOTE1X2dlbV9leGVjX29iamVjdDIgKmV4ZWMsCj4gLSAgICAgICAgICAgICAgICAgICAg
ICBzdHJ1Y3QgZHJtX3N5bmNvYmogKipmZW5jZXMpCj4gKyAgICAgICAgICAgICAgICAgICAgICBz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNfb2JqZWN0MiAqZXhlYykKPiAgewo+ICAgICAgICAgc3Ry
dWN0IGk5MTVfZXhlY2J1ZmZlciBlYjsKPiAgICAgICAgIHN0cnVjdCBkbWFfZmVuY2UgKmluX2Zl
bmNlID0gTlVMTDsKPiAgICAgICAgIHN0cnVjdCBkbWFfZmVuY2UgKmV4ZWNfZmVuY2UgPSBOVUxM
Owo+ICAgICAgICAgc3RydWN0IHN5bmNfZmlsZSAqb3V0X2ZlbmNlID0gTlVMTDsKPiArICAgICAg
IHN0cnVjdCBpOTE1X2RybV9kbWFfZmVuY2VzICpmZW5jZXMgPSBOVUxMOwo+ICAgICAgICAgaW50
IG91dF9mZW5jZV9mZCA9IC0xOwo+ICsgICAgICAgaW50IG5mZW5jZXMgPSAwOwo+ICAgICAgICAg
aW50IGVycjsKPiAgCj4gICAgICAgICBCVUlMRF9CVUdfT04oX19FWEVDX0lOVEVSTkFMX0ZMQUdT
ICYgfl9fSTkxNV9FWEVDX0lMTEVHQUxfRkxBR1MpOwo+IEBAIC0yNDIxLDEwICsyNTkxLDE2IEBA
IGk5MTVfZ2VtX2RvX2V4ZWNidWZmZXIoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiAgICAgICAg
ICAgICAgICAgICAgICAgICByZXR1cm4gZXJyOwo+ICAgICAgICAgfQo+ICAKPiArICAgICAgIGZl
bmNlcyA9IGdldF9mZW5jZV9hcnJheSgmZWIsICZuZmVuY2VzKTsKPiArICAgICAgIGlmIChJU19F
UlIoZmVuY2VzKSkKPiArICAgICAgICAgICAgICAgcmV0dXJuIFBUUl9FUlIoZmVuY2VzKTsKPiAr
Cj4gICAgICAgICBpZiAoYXJncy0+ZmxhZ3MgJiBJOTE1X0VYRUNfRkVOQ0VfSU4pIHsKPiAgICAg
ICAgICAgICAgICAgaW5fZmVuY2UgPSBzeW5jX2ZpbGVfZ2V0X2ZlbmNlKGxvd2VyXzMyX2JpdHMo
YXJncy0+cnN2ZDIpKTsKPiAtICAgICAgICAgICAgICAgaWYgKCFpbl9mZW5jZSkKPiAtICAgICAg
ICAgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKPiArICAgICAgICAgICAgICAgaWYgKCFp
bl9mZW5jZSkgewo+ICsgICAgICAgICAgICAgICAgICAgICAgIGVyciA9IC1FSU5WQUw7Cj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgZ290byBlcnJfZmVuY2VzOwo+ICsgICAgICAgICAgICAgICB9
Cj4gICAgICAgICB9Cj4gIAo+ICAgICAgICAgaWYgKGFyZ3MtPmZsYWdzICYgSTkxNV9FWEVDX0ZF
TkNFX1NVQk1JVCkgewo+IEBAIC0yNTgyLDcgKzI3NTgsNyBAQCBpOTE1X2dlbV9kb19leGVjYnVm
ZmVyKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gICAgICAgICB9Cj4gIAo+ICAgICAgICAgaWYg
KGZlbmNlcykgewo+IC0gICAgICAgICAgICAgICBlcnIgPSBhd2FpdF9mZW5jZV9hcnJheSgmZWIs
IGZlbmNlcyk7Cj4gKyAgICAgICAgICAgICAgIGVyciA9IGF3YWl0X2ZlbmNlX2FycmF5KCZlYiwg
ZmVuY2VzLCBuZmVuY2VzKTsKPiAgICAgICAgICAgICAgICAgaWYgKGVycikKPiAgICAgICAgICAg
ICAgICAgICAgICAgICBnb3RvIGVycl9yZXF1ZXN0Owo+ICAgICAgICAgfQo+IEBAIC0yNjExLDcg
KzI3ODcsNyBAQCBpOTE1X2dlbV9kb19leGVjYnVmZmVyKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYs
Cj4gICAgICAgICBpOTE1X3JlcXVlc3RfYWRkKGViLnJlcXVlc3QpOwo+ICAKPiAgICAgICAgIGlm
IChmZW5jZXMpCj4gLSAgICAgICAgICAgICAgIHNpZ25hbF9mZW5jZV9hcnJheSgmZWIsIGZlbmNl
cyk7Cj4gKyAgICAgICAgICAgICAgIHNpZ25hbF9mZW5jZV9hcnJheSgmZWIsIGZlbmNlcywgbmZl
bmNlcyk7Cj4gIAo+ICAgICAgICAgaWYgKG91dF9mZW5jZSkgewo+ICAgICAgICAgICAgICAgICBp
ZiAoZXJyID09IDApIHsKPiBAQCAtMjY0Niw2ICsyODIyLDggQEAgaTkxNV9nZW1fZG9fZXhlY2J1
ZmZlcihzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ICAgICAgICAgZG1hX2ZlbmNlX3B1dChleGVj
X2ZlbmNlKTsKPiAgZXJyX2luX2ZlbmNlOgo+ICAgICAgICAgZG1hX2ZlbmNlX3B1dChpbl9mZW5j
ZSk7Cj4gK2Vycl9mZW5jZXM6Cj4gKyAgICAgICBwdXRfZmVuY2VfYXJyYXkoZmVuY2VzLCBuZmVu
Y2VzKTsKPiAgICAgICAgIHJldHVybiBlcnI7Cj4gIH0KPiAgCj4gQEAgLTI3MzksNyArMjkxNyw3
IEBAIGk5MTVfZ2VtX2V4ZWNidWZmZXJfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9p
ZCAqZGF0YSwKPiAgICAgICAgICAgICAgICAgICAgICAgICBleGVjMl9saXN0W2ldLmZsYWdzID0g
MDsKPiAgICAgICAgIH0KPiAgCj4gLSAgICAgICBlcnIgPSBpOTE1X2dlbV9kb19leGVjYnVmZmVy
KGRldiwgZmlsZSwgJmV4ZWMyLCBleGVjMl9saXN0LCBOVUxMKTsKPiArICAgICAgIGVyciA9IGk5
MTVfZ2VtX2RvX2V4ZWNidWZmZXIoZGV2LCBmaWxlLCAmZXhlYzIsIGV4ZWMyX2xpc3QpOwo+ICAg
ICAgICAgaWYgKGV4ZWMyLmZsYWdzICYgX19FWEVDX0hBU19SRUxPQykgewo+ICAgICAgICAgICAg
ICAgICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNfb2JqZWN0IF9fdXNlciAqdXNlcl9leGVjX2xp
c3QgPQo+ICAgICAgICAgICAgICAgICAgICAgICAgIHU2NF90b191c2VyX3B0cihhcmdzLT5idWZm
ZXJzX3B0cik7Cj4gQEAgLTI3NzAsNyArMjk0OCw2IEBAIGk5MTVfZ2VtX2V4ZWNidWZmZXIyX2lv
Y3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gIHsKPiAgICAgICAgIHN0
cnVjdCBkcm1faTkxNV9nZW1fZXhlY2J1ZmZlcjIgKmFyZ3MgPSBkYXRhOwo+ICAgICAgICAgc3Ry
dWN0IGRybV9pOTE1X2dlbV9leGVjX29iamVjdDIgKmV4ZWMyX2xpc3Q7Cj4gLSAgICAgICBzdHJ1
Y3QgZHJtX3N5bmNvYmogKipmZW5jZXMgPSBOVUxMOwo+ICAgICAgICAgY29uc3Qgc2l6ZV90IGNv
dW50ID0gYXJncy0+YnVmZmVyX2NvdW50Owo+ICAgICAgICAgaW50IGVycjsKPiAgCj4gQEAgLTI3
OTgsMTUgKzI5NzUsNyBAQCBpOTE1X2dlbV9leGVjYnVmZmVyMl9pb2N0bChzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ICAgICAgICAgICAgICAgICByZXR1cm4gLUVGQVVMVDsK
PiAgICAgICAgIH0KPiAgCj4gLSAgICAgICBpZiAoYXJncy0+ZmxhZ3MgJiBJOTE1X0VYRUNfRkVO
Q0VfQVJSQVkpIHsKPiAtICAgICAgICAgICAgICAgZmVuY2VzID0gZ2V0X2ZlbmNlX2FycmF5KGFy
Z3MsIGZpbGUpOwo+IC0gICAgICAgICAgICAgICBpZiAoSVNfRVJSKGZlbmNlcykpIHsKPiAtICAg
ICAgICAgICAgICAgICAgICAgICBrdmZyZWUoZXhlYzJfbGlzdCk7Cj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgcmV0dXJuIFBUUl9FUlIoZmVuY2VzKTsKPiAtICAgICAgICAgICAgICAgfQo+IC0g
ICAgICAgfQo+IC0KPiAtICAgICAgIGVyciA9IGk5MTVfZ2VtX2RvX2V4ZWNidWZmZXIoZGV2LCBm
aWxlLCBhcmdzLCBleGVjMl9saXN0LCBmZW5jZXMpOwo+ICsgICAgICAgZXJyID0gaTkxNV9nZW1f
ZG9fZXhlY2J1ZmZlcihkZXYsIGZpbGUsIGFyZ3MsIGV4ZWMyX2xpc3QpOwo+ICAKPiAgICAgICAg
IC8qCj4gICAgICAgICAgKiBOb3cgdGhhdCB3ZSBoYXZlIGJlZ3VuIGV4ZWN1dGlvbiBvZiB0aGUg
YmF0Y2hidWZmZXIsIHdlIGlnbm9yZQo+IEBAIC0yODQ2LDcgKzMwMTUsNiBAQCBlbmQ6Owo+ICAg
ICAgICAgfQo+ICAKPiAgICAgICAgIGFyZ3MtPmZsYWdzICY9IH5fX0k5MTVfRVhFQ19VTktOT1dO
X0ZMQUdTOwo+IC0gICAgICAgcHV0X2ZlbmNlX2FycmF5KGFyZ3MsIGZlbmNlcyk7Cj4gICAgICAg
ICBrdmZyZWUoZXhlYzJfbGlzdCk7Cj4gICAgICAgICByZXR1cm4gZXJyOwo+ICB9Cj4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2Rydi5jCj4gaW5kZXggN2MzYzNiOGFiMzM5Li40OGY5MDA5YTYzMTggMTAwNjQ0
Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYwo+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKPiBAQCAtNDU2LDYgKzQ1Niw3IEBAIHN0YXRpYyBpbnQg
aTkxNV9nZXRwYXJhbV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+
ICAgICAgICAgY2FzZSBJOTE1X1BBUkFNX0hBU19FWEVDX0JBVENIX0ZJUlNUOgo+ICAgICAgICAg
Y2FzZSBJOTE1X1BBUkFNX0hBU19FWEVDX0ZFTkNFX0FSUkFZOgo+ICAgICAgICAgY2FzZSBJOTE1
X1BBUkFNX0hBU19FWEVDX1NVQk1JVF9GRU5DRToKPiArICAgICAgIGNhc2UgSTkxNV9QQVJBTV9I
QVNfRVhFQ19USU1FTElORV9GRU5DRVM6Cj4gICAgICAgICAgICAgICAgIC8qIEZvciB0aGUgdGlt
ZSBiZWluZyBhbGwgb2YgdGhlc2UgYXJlIGFsd2F5cyB0cnVlOwo+ICAgICAgICAgICAgICAgICAg
KiBpZiBzb21lIHN1cHBvcnRlZCBoYXJkd2FyZSBkb2VzIG5vdCBoYXZlIG9uZSBvZiB0aGVzZQo+
ICAgICAgICAgICAgICAgICAgKiBmZWF0dXJlcyB0aGlzIHZhbHVlIG5lZWRzIHRvIGJlIHByb3Zp
ZGVkIGZyb20KPiBAQCAtMzIyMCw2ICszMjIxLDcgQEAgc3RhdGljIHN0cnVjdCBkcm1fZHJpdmVy
IGRyaXZlciA9IHsKPiAgICAgICAgIC5kcml2ZXJfZmVhdHVyZXMgPQo+ICAgICAgICAgICAgIERS
SVZFUl9HRU0gfAo+ICAgICAgICAgICAgIERSSVZFUl9SRU5ERVIgfCBEUklWRVJfTU9ERVNFVCB8
IERSSVZFUl9BVE9NSUMgfCBEUklWRVJfU1lOQ09CSiwKPiArICAgICAgICAgICBEUklWRVJfU1lO
Q09CSl9USU1FTElORSwKCldpdGggYSBjb21tYSA/IGkuZS4gLmlvY3RscyA9IERSSVZFUl9TWU5D
T0JKX1RJTUVMSU5FCgo+ICAgICAgICAgLnJlbGVhc2UgPSBpOTE1X2RyaXZlcl9yZWxlYXNlLAo+
ICAgICAgICAgLm9wZW4gPSBpOTE1X2RyaXZlcl9vcGVuLAo+ICAgICAgICAgLmxhc3RjbG9zZSA9
IGk5MTVfZHJpdmVyX2xhc3RjbG9zZSwKPiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2RybS9p
OTE1X2RybS5oIGIvaW5jbHVkZS91YXBpL2RybS9pOTE1X2RybS5oCj4gaW5kZXggZWZhMTk1ZDY5
OTRlLi5iN2ZlMTkxNWUzNGQgMTAwNjQ0Cj4gLS0tIGEvaW5jbHVkZS91YXBpL2RybS9pOTE1X2Ry
bS5oCj4gKysrIGIvaW5jbHVkZS91YXBpL2RybS9pOTE1X2RybS5oCj4gQEAgLTYxNyw2ICs2MTcs
MTIgQEAgdHlwZWRlZiBzdHJ1Y3QgZHJtX2k5MTVfaXJxX3dhaXQgewo+ICAgKi8KPiAgI2RlZmlu
ZSBJOTE1X1BBUkFNX1BFUkZfUkVWSVNJT04gICAgICAgNTQKPiAgCj4gKy8qIFF1ZXJ5IHdoZXRo
ZXIgRFJNX0k5MTVfR0VNX0VYRUNCVUZGRVIyIHN1cHBvcnRzIHN1cHBseWluZyBhbiBhcnJheSBv
Zgo+ICsgKiB0aW1lbGluZSBzeW5jb2JqIHRocm91Z2ggZHJtX2k5MTVfZ2VtX2V4ZWNidWZfZXh0
X3RpbWVsaW5lX2ZlbmNlcy4gU2VlCj4gKyAqIEk5MTVfRVhFQ19FWFQuCj4gKyAqLwo+ICsjZGVm
aW5lIEk5MTVfUEFSQU1fSEFTX0VYRUNfVElNRUxJTkVfRkVOQ0VTIDU1Cj4gKwo+ICAvKiBNdXN0
IGJlIGtlcHQgY29tcGFjdCAtLSBubyBob2xlcyBhbmQgd2VsbCBkb2N1bWVudGVkICovCj4gIAo+
ICB0eXBlZGVmIHN0cnVjdCBkcm1faTkxNV9nZXRwYXJhbSB7Cj4gQEAgLTEwMTQsOSArMTAyMCw0
MCBAQCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNfZmVuY2Ugewo+ICB9Owo+ICAKPiAgZW51bSBk
cm1faTkxNV9nZW1fZXhlY2J1ZmZlcl9leHQgewo+ICsgICAgICAgLyoqCj4gKyAgICAgICAgKiBU
aGlzIGlkZW50aWZpZXIgaXMgYXNzb2NpYXRlZCB3aXRoCj4gKyAgICAgICAgKiBkcm1faTkxNV9n
ZW1fZXhlY2J1Zl9leHRfdGltZWxpbmVfZmVuY2VzLgoKT3IganVzdCAiU2VlIGRybV9pOTE1X2dl
bV9leGVjYnVmX2V4dF90aW1lbGluZV9mZW5jZXMKPiArICAgICAgICAqLwo+ICsgICAgICAgRFJN
X0k5MTVfR0VNX0VYRUNCVUZGRVJfRVhUX1RJTUVMSU5FX0ZFTkNFUywKID0gMApkb24ndCBsZWF2
ZSBpdCB1cCB0byB0aGUgY29tcGlsZXIuCj4gKwo+ICAgICAgICAgRFJNX0k5MTVfR0VNX0VYRUNC
VUZGRVJfRVhUX01BWCAvKiBub24tQUJJICovCj4gIH07Cj4gIAo+ICsvKioKPiArICogVGhpcyBz
dHJ1Y3R1cmUgZGVzY3JpYmVzIGFuIGFycmF5IG9mIGRybV9zeW5jb2JqIGFuZCBhc3NvY2lhdGVk
IHBvaW50cyBmb3IKPiArICogdGltZWxpbmUgdmFyaWFudHMgb2YgZHJtX3N5bmNvYmouIEl0IGlz
IGludmFsaWQgdG8gYXBwZW5kIHRoaXMgc3RydWN0dXJlIHRvCj4gKyAqIHRoZSBleGVjYnVmIGlm
IEk5MTVfRVhFQ19GRU5DRV9BUlJBWSBpcyBzZXQuCj4gKyAqLwo+ICtzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX2V4ZWNidWZmZXJfZXh0X3RpbWVsaW5lX2ZlbmNlcyB7Cj4gKyAgICAgICBzdHJ1Y3QgaTkx
NV91c2VyX2V4dGVuc2lvbiBiYXNlOwo+ICsKPiArICAgICAgIC8qKgo+ICsgICAgICAgICogTnVt
YmVyIG9mIGVsZW1lbnQgaW4gdGhlIGhhbmRsZXNfcHRyICYgdmFsdWVfcHRyIGFycmF5cy4KPiAr
ICAgICAgICAqLwo+ICsgICAgICAgX191NjQgaGFuZGxlX2NvdW50OwoKU2luY2UgaXQgaXMgdXNl
ZCBmb3IgYm90aCwgSSB3b3VsZCB1c2Ugc29tZXRoaW5nIGxpa2UgZmVuY2VfY291bnQsIG9yCm51
bV9mZW5jZXMgKGFsdGhvdWdoIF9jb3VudCBpcyBpbiB0aGUgbWFqb3JpdHkpLgoKPiArICAgICAg
IC8qKgo+ICsgICAgICAgICogUG9pbnRlciB0byBhbiBhcnJheSBvZiBzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX2V4ZWNfZmVuY2Ugb2Ygc2l6ZSBoYW5kbGVfY291bnQuCgpzL3NpemUvbGVuZ3RoLwoKSSB0
aGluayB3ZSB0eXBpY2FsbHkgdXNlIHNpemUgZm9yIGJ5dGUgc2l6ZXMgYXJvdW5kIHRoZSB1QVBJ
LgoKPiArICAgICAgICAqLwo+ICsgICAgICAgX191NjQgaGFuZGxlc19wdHI7Cj4gKwo+ICsgICAg
ICAgLyoqCj4gKyAgICAgICAgKiBQb2ludGVyIHRvIGFuIGFycmF5IG9mIHU2NCB2YWx1ZXMgb2Yg
c2l6ZSBoYW5kbGVfY291bnQuIFZhbHVlcyBtdXN0Cj4gKyAgICAgICAgKiBiZSAwIGZvciBhIGJp
bmFyeSBkcm1fc3luY29iai4KPiArICAgICAgICAqLwo+ICsgICAgICAgX191NjQgdmFsdWVzX3B0
cjsKPiArfTsKPiArCj4gIHN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY2J1ZmZlcjIgewo+ICAgICAg
ICAgLyoqCj4gICAgICAgICAgKiBMaXN0IG9mIGdlbV9leGVjX29iamVjdDIgc3RydWN0cwo+IC0t
IAo+IDIuMjEuMC4zOTIuZ2Y4ZjY3ODcxNTllCj4gCj4gX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KPiBJbnRlbC1nZnggbWFpbGluZyBsaXN0Cj4gSW50ZWwt
Z2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwo+IGh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
L21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3Rz
LmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xp
c3RpbmZvL2ludGVsLWdmeA==

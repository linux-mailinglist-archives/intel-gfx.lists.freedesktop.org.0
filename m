Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 6AA702DEA28
	for <lists+intel-gfx@lfdr.de>; Fri, 18 Dec 2020 21:25:48 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id ABF8189B65;
	Fri, 18 Dec 2020 20:25:46 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (unknown [77.68.26.236])
 by gabe.freedesktop.org (Postfix) with ESMTPS id EE11E89B65
 for <intel-gfx@lists.freedesktop.org>; Fri, 18 Dec 2020 20:25:44 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from build.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 23371364-1500050 
 for <intel-gfx@lists.freedesktop.org>; Fri, 18 Dec 2020 20:25:41 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 18 Dec 2020 20:25:40 +0000
Message-Id: <20201218202541.28692-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
MIME-Version: 1.0
Subject: [Intel-gfx] [CI 1/2] drm/i915/gt: Split logical ring contexts from
 execlist submission
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

U3BsaXQgdGhlIGRlZmluaXRpb24sIGNvbnN0cnVjdGlvbiBhbmQgdXBkYXRpbmcgb2YgdGhlIExv
Z2ljYWwgUmluZwpDb250ZXh0IGZyb20gdGhlIGV4ZWNsaXN0IHN1Ym1pc3Npb24gaW50ZXJmYWNl
LiBUaGUgTFJDIGlzIHVzZWQgYnkgdGhlCkhXLCBpcnJlc3BlY3RpdmUgb2Ygb3VyIGRpZmZlcmVu
dCBzdWJtaXNzaW9uIGJhY2tlbmRzLgoKU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJp
c0BjaHJpcy13aWxzb24uY28udWs+ClJldmlld2VkLWJ5OiBEYW5pZWxlIENlcmFvbG8gU3B1cmlv
IDxkYW5pZWxlLmNlcmFvbG9zcHVyaW9AaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L01ha2VmaWxlICAgICAgICAgICAgICAgICB8ICAgIDEgKwogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvZ2VuOF9lbmdpbmVfY3MuYyAgICAgIHwgICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfY29udGV4dF9zc2V1LmMgIHwgICAgMyArLQogLi4uL2RybS9pOTE1L2d0L2lu
dGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uLmMgIHwgMTY4MyArLS0tLS0tLS0tLS0tLS0KIC4uLi9k
cm0vaTkxNS9ndC9pbnRlbF9leGVjbGlzdHNfc3VibWlzc2lvbi5oICB8ICAgMTcgLQogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMgICAgICAgICAgIHwgMTU3OSArKysrKysrKysr
KysrKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmggICAgICAgICAgIHwgICA4
NSArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmNfcmVnLmggICAgICAgfCAgICAy
ICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2V4ZWNsaXN0cy5jICB8IDE3NzYg
Ky0tLS0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMg
ICAgICAgIHwgMTg2MSArKysrKysrKysrKysrKysrKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
dWMvaW50ZWxfZ3VjX2Fkcy5jICAgIHwgICAgMiArLQogLi4uL2dwdS9kcm0vaTkxNS9ndC91Yy9p
bnRlbF9ndWNfc3VibWlzc2lvbi5jIHwgICAyNiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0
L3NjaGVkdWxlci5jICAgICAgICAgIHwgICAgMSArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3BlcmYuYyAgICAgICAgICAgICAgfCAgICAyICstCiAxNCBmaWxlcyBjaGFuZ2VkLCAzNjE4IGlu
c2VydGlvbnMoKyksIDM0MjIgZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQppbmRleCBm
OWVmNTE5OWIxMjQuLjg0OWM3YjNmYzk0MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUKQEAgLTEwNCw2
ICsxMDQsNyBAQCBndC15ICs9IFwKIAlndC9pbnRlbF9ndF9yZXF1ZXN0cy5vIFwKIAlndC9pbnRl
bF9ndHQubyBcCiAJZ3QvaW50ZWxfbGxjLm8gXAorCWd0L2ludGVsX2xyYy5vIFwKIAlndC9pbnRl
bF9tb2NzLm8gXAogCWd0L2ludGVsX3BwZ3R0Lm8gXAogCWd0L2ludGVsX3JjNi5vIFwKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2dlbjhfZW5naW5lX2NzLmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9nZW44X2VuZ2luZV9jcy5jCmluZGV4IDljNmYwZWJmYTNjZi4uMTk3
MmRkNWRjYTAwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9nZW44X2VuZ2lu
ZV9jcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2dlbjhfZW5naW5lX2NzLmMKQEAg
LTUsNyArNSw3IEBACiAKICNpbmNsdWRlICJnZW44X2VuZ2luZV9jcy5oIgogI2luY2x1ZGUgImk5
MTVfZHJ2LmgiCi0jaW5jbHVkZSAiaW50ZWxfZXhlY2xpc3RzX3N1Ym1pc3Npb24uaCIgLyogWFhY
ICovCisjaW5jbHVkZSAiaW50ZWxfbHJjLmgiCiAjaW5jbHVkZSAiaW50ZWxfZ3B1X2NvbW1hbmRz
LmgiCiAjaW5jbHVkZSAiaW50ZWxfcmluZy5oIgogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0X3NzZXUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2NvbnRleHRfc3NldS5jCmluZGV4IDVmOTRiNDQwMjJkYy4uOGRmZDhmNjU2YWFhIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0X3NzZXUuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0X3NzZXUuYwpAQCAtOCw4
ICs4LDcgQEAKICNpbmNsdWRlICJpbnRlbF9jb250ZXh0LmgiCiAjaW5jbHVkZSAiaW50ZWxfZW5n
aW5lX3BtLmgiCiAjaW5jbHVkZSAiaW50ZWxfZ3B1X2NvbW1hbmRzLmgiCi0jaW5jbHVkZSAiaW50
ZWxfZXhlY2xpc3RzX3N1Ym1pc3Npb24uaCIKLSNpbmNsdWRlICJpbnRlbF9scmNfcmVnLmgiCisj
aW5jbHVkZSAiaW50ZWxfbHJjLmgiCiAjaW5jbHVkZSAiaW50ZWxfcmluZy5oIgogI2luY2x1ZGUg
ImludGVsX3NzZXUuaCIKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZXhlY2xpc3RzX3N1Ym1pc3Npb24uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2V4ZWNsaXN0c19zdWJtaXNzaW9uLmMKaW5kZXggZGNlY2MyODg3ODkxLi43YTYzYmU1MjU1Yjkg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2V4ZWNsaXN0c19zdWJt
aXNzaW9uLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZXhlY2xpc3RzX3N1
Ym1pc3Npb24uYwpAQCAtMTA5LDcgKzEwOSw2IEBACiAjaW5jbHVkZSA8bGludXgvaW50ZXJydXB0
Lmg+CiAKICNpbmNsdWRlICJpOTE1X2Rydi5oIgotI2luY2x1ZGUgImk5MTVfcGVyZi5oIgogI2lu
Y2x1ZGUgImk5MTVfdHJhY2UuaCIKICNpbmNsdWRlICJpOTE1X3ZncHUuaCIKICNpbmNsdWRlICJn
ZW44X2VuZ2luZV9jcy5oIgpAQCAtMTIwLDYgKzExOSw3IEBACiAjaW5jbHVkZSAiaW50ZWxfZ3Qu
aCIKICNpbmNsdWRlICJpbnRlbF9ndF9wbS5oIgogI2luY2x1ZGUgImludGVsX2d0X3JlcXVlc3Rz
LmgiCisjaW5jbHVkZSAiaW50ZWxfbHJjLmgiCiAjaW5jbHVkZSAiaW50ZWxfbHJjX3JlZy5oIgog
I2luY2x1ZGUgImludGVsX21vY3MuaCIKICNpbmNsdWRlICJpbnRlbF9yZXNldC5oIgpAQCAtMTQ0
LDggKzE0NCw2IEBACiAjZGVmaW5lIEdFTjhfQ1RYX1NUQVRVU19DT01QTEVURURfTUFTSyBcCiAJ
IChHRU44X0NUWF9TVEFUVVNfQ09NUExFVEUgfCBHRU44X0NUWF9TVEFUVVNfUFJFRU1QVEVEKQog
Ci0jZGVmaW5lIENUWF9ERVNDX0ZPUkNFX1JFU1RPUkUgQklUX1VMTCgyKQotCiAjZGVmaW5lIEdF
TjEyX0NUWF9TVEFUVVNfU1dJVENIRURfVE9fTkVXX1FVRVVFCSgweDEpIC8qIGxvd2VyIGNzYiBk
d29yZCAqLwogI2RlZmluZSBHRU4xMl9DVFhfU1dJVENIX0RFVEFJTChjc2JfZHcpCSgoY3NiX2R3
KSAmIDB4RikgLyogdXBwZXIgY3NiIGR3b3JkICovCiAjZGVmaW5lIEdFTjEyX0NTQl9TV19DVFhf
SURfTUFTSwkJR0VOTUFTSygyNSwgMTUpCkBAIC0yMDUsMTM2ICsyMDMsNiBAQCBzdGF0aWMgc3Ry
dWN0IHZpcnR1YWxfZW5naW5lICp0b192aXJ0dWFsX2VuZ2luZShzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUpCiAJcmV0dXJuIGNvbnRhaW5lcl9vZihlbmdpbmUsIHN0cnVjdCB2aXJ0dWFs
X2VuZ2luZSwgYmFzZSk7CiB9CiAKLXN0YXRpYyBpbnQgX19leGVjbGlzdHNfY29udGV4dF9hbGxv
YyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCi0JCQkJICAgICBzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUpOwotCi1zdGF0aWMgdm9pZCBleGVjbGlzdHNfaW5pdF9yZWdfc3RhdGUodTMy
ICpyZWdfc3RhdGUsCi0JCQkJICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCi0J
CQkJICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCi0JCQkJICAgICBj
b25zdCBzdHJ1Y3QgaW50ZWxfcmluZyAqcmluZywKLQkJCQkgICAgIGJvb2wgY2xvc2UpOwotc3Rh
dGljIHZvaWQKLV9fZXhlY2xpc3RzX3VwZGF0ZV9yZWdfc3RhdGUoY29uc3Qgc3RydWN0IGludGVs
X2NvbnRleHQgKmNlLAotCQkJICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUsCi0JCQkgICAgIHUzMiBoZWFkKTsKLQotc3RhdGljIGludCBscmNfcmluZ19taV9tb2RlKGNv
bnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKLXsKLQlpZiAoSU5URUxfR0VOKGVu
Z2luZS0+aTkxNSkgPj0gMTIpCi0JCXJldHVybiAweDYwOwotCWVsc2UgaWYgKElOVEVMX0dFTihl
bmdpbmUtPmk5MTUpID49IDkpCi0JCXJldHVybiAweDU0OwotCWVsc2UgaWYgKGVuZ2luZS0+Y2xh
c3MgPT0gUkVOREVSX0NMQVNTKQotCQlyZXR1cm4gMHg1ODsKLQllbHNlCi0JCXJldHVybiAtMTsK
LX0KLQotc3RhdGljIGludCBscmNfcmluZ19ncHIwKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSkKLXsKLQlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTIpCi0JCXJl
dHVybiAweDc0OwotCWVsc2UgaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDkpCi0JCXJl
dHVybiAweDY4OwotCWVsc2UgaWYgKGVuZ2luZS0+Y2xhc3MgPT0gUkVOREVSX0NMQVNTKQotCQly
ZXR1cm4gMHhkODsKLQllbHNlCi0JCXJldHVybiAtMTsKLX0KLQotc3RhdGljIGludCBscmNfcmlu
Z193YV9iYl9wZXJfY3R4KGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKLXsK
LQlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTIpCi0JCXJldHVybiAweDEyOwotCWVs
c2UgaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDkgfHwgZW5naW5lLT5jbGFzcyA9PSBS
RU5ERVJfQ0xBU1MpCi0JCXJldHVybiAweDE4OwotCWVsc2UKLQkJcmV0dXJuIC0xOwotfQotCi1z
dGF0aWMgaW50IGxyY19yaW5nX2luZGlyZWN0X3B0cihjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUpCi17Ci0JaW50IHg7Ci0KLQl4ID0gbHJjX3Jpbmdfd2FfYmJfcGVyX2N0eChl
bmdpbmUpOwotCWlmICh4IDwgMCkKLQkJcmV0dXJuIHg7Ci0KLQlyZXR1cm4geCArIDI7Ci19Ci0K
LXN0YXRpYyBpbnQgbHJjX3JpbmdfaW5kaXJlY3Rfb2Zmc2V0KGNvbnN0IHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSkKLXsKLQlpbnQgeDsKLQotCXggPSBscmNfcmluZ19pbmRpcmVjdF9w
dHIoZW5naW5lKTsKLQlpZiAoeCA8IDApCi0JCXJldHVybiB4OwotCi0JcmV0dXJuIHggKyAyOwot
fQotCi1zdGF0aWMgaW50IGxyY19yaW5nX2NtZF9idWZfY2N0bChjb25zdCBzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUpCi17Ci0JaWYgKGVuZ2luZS0+Y2xhc3MgIT0gUkVOREVSX0NMQVNT
KQotCQlyZXR1cm4gLTE7Ci0KLQlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTIpCi0J
CXJldHVybiAweGI2OwotCWVsc2UgaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDExKQot
CQlyZXR1cm4gMHhhYTsKLQllbHNlCi0JCXJldHVybiAtMTsKLX0KLQotc3RhdGljIHUzMgotbHJj
X3JpbmdfaW5kaXJlY3Rfb2Zmc2V0X2RlZmF1bHQoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lKQotewotCXN3aXRjaCAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkpIHsKLQlkZWZh
dWx0OgotCQlNSVNTSU5HX0NBU0UoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkpOwotCQlmYWxsdGhy
b3VnaDsKLQljYXNlIDEyOgotCQlyZXR1cm4gR0VOMTJfQ1RYX1JDU19JTkRJUkVDVF9DVFhfT0ZG
U0VUX0RFRkFVTFQ7Ci0JY2FzZSAxMToKLQkJcmV0dXJuIEdFTjExX0NUWF9SQ1NfSU5ESVJFQ1Rf
Q1RYX09GRlNFVF9ERUZBVUxUOwotCWNhc2UgMTA6Ci0JCXJldHVybiBHRU4xMF9DVFhfUkNTX0lO
RElSRUNUX0NUWF9PRkZTRVRfREVGQVVMVDsKLQljYXNlIDk6Ci0JCXJldHVybiBHRU45X0NUWF9S
Q1NfSU5ESVJFQ1RfQ1RYX09GRlNFVF9ERUZBVUxUOwotCWNhc2UgODoKLQkJcmV0dXJuIEdFTjhf
Q1RYX1JDU19JTkRJUkVDVF9DVFhfT0ZGU0VUX0RFRkFVTFQ7Ci0JfQotfQotCi1zdGF0aWMgdm9p
ZAotbHJjX3Jpbmdfc2V0dXBfaW5kaXJlY3RfY3R4KHUzMiAqcmVncywKLQkJCSAgICBjb25zdCBz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCi0JCQkgICAgdTMyIGN0eF9iYl9nZ3R0X2Fk
ZHIsCi0JCQkgICAgdTMyIHNpemUpCi17Ci0JR0VNX0JVR19PTighc2l6ZSk7Ci0JR0VNX0JVR19P
TighSVNfQUxJR05FRChzaXplLCBDQUNIRUxJTkVfQllURVMpKTsKLQlHRU1fQlVHX09OKGxyY19y
aW5nX2luZGlyZWN0X3B0cihlbmdpbmUpID09IC0xKTsKLQlyZWdzW2xyY19yaW5nX2luZGlyZWN0
X3B0cihlbmdpbmUpICsgMV0gPQotCQljdHhfYmJfZ2d0dF9hZGRyIHwgKHNpemUgLyBDQUNIRUxJ
TkVfQllURVMpOwotCi0JR0VNX0JVR19PTihscmNfcmluZ19pbmRpcmVjdF9vZmZzZXQoZW5naW5l
KSA9PSAtMSk7Ci0JcmVnc1tscmNfcmluZ19pbmRpcmVjdF9vZmZzZXQoZW5naW5lKSArIDFdID0K
LQkJbHJjX3JpbmdfaW5kaXJlY3Rfb2Zmc2V0X2RlZmF1bHQoZW5naW5lKSA8PCA2OwotfQotCi1z
dGF0aWMgdTMyIGludGVsX2NvbnRleHRfZ2V0X3J1bnRpbWUoY29uc3Qgc3RydWN0IGludGVsX2Nv
bnRleHQgKmNlKQotewotCS8qCi0JICogV2UgY2FuIHVzZSBlaXRoZXIgcHBIV1NQWzE2XSB3aGlj
aCBpcyByZWNvcmRlZCBiZWZvcmUgdGhlIGNvbnRleHQKLQkgKiBzd2l0Y2ggKGFuZCBzbyBleGNs
dWRlcyB0aGUgY29zdCBvZiBjb250ZXh0IHN3aXRjaGVzKSBvciB1c2UgdGhlCi0JICogdmFsdWUg
ZnJvbSB0aGUgY29udGV4dCBpbWFnZSBpdHNlbGYsIHdoaWNoIGlzIHNhdmVkL3Jlc3RvcmVkIGVh
cmxpZXIKLQkgKiBhbmQgc28gaW5jbHVkZXMgdGhlIGNvc3Qgb2YgdGhlIHNhdmUuCi0JICovCi0J
cmV0dXJuIFJFQURfT05DRShjZS0+bHJjX3JlZ19zdGF0ZVtDVFhfVElNRVNUQU1QXSk7Ci19Ci0K
IHN0YXRpYyB2b2lkIG1hcmtfZWlvKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogewogCWlmIChp
OTE1X3JlcXVlc3RfY29tcGxldGVkKHJxKSkKQEAgLTUxMyw1NjggKzM4MSw2IEBAIGFzc2VydF9w
cmlvcml0eV9xdWV1ZShjb25zdCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpwcmV2LAogCXJldHVybiBy
cV9wcmlvKHByZXYpID49IHJxX3ByaW8obmV4dCk7CiB9CiAKLS8qCi0gKiBUaGUgY29udGV4dCBk
ZXNjcmlwdG9yIGVuY29kZXMgdmFyaW91cyBhdHRyaWJ1dGVzIG9mIGEgY29udGV4dCwKLSAqIGlu
Y2x1ZGluZyBpdHMgR1RUIGFkZHJlc3MgYW5kIHNvbWUgZmxhZ3MuIEJlY2F1c2UgaXQncyBmYWly
bHkKLSAqIGV4cGVuc2l2ZSB0byBjYWxjdWxhdGUsIHdlJ2xsIGp1c3QgZG8gaXQgb25jZSBhbmQg
Y2FjaGUgdGhlIHJlc3VsdCwKLSAqIHdoaWNoIHJlbWFpbnMgdmFsaWQgdW50aWwgdGhlIGNvbnRl
eHQgaXMgdW5waW5uZWQuCi0gKgotICogVGhpcyBpcyB3aGF0IGEgZGVzY3JpcHRvciBsb29rcyBs
aWtlLCBmcm9tIExTQiB0byBNU0I6OgotICoKLSAqICAgICAgYml0cyAgMC0xMTogICAgZmxhZ3Ms
IEdFTjhfQ1RYXyogKGNhY2hlZCBpbiBjdHgtPmRlc2NfdGVtcGxhdGUpCi0gKiAgICAgIGJpdHMg
MTItMzE6ICAgIExSQ0EsIEdUVCBhZGRyZXNzIG9mICh0aGUgSFdTUCBvZikgdGhpcyBjb250ZXh0
Ci0gKiAgICAgIGJpdHMgMzItNTI6ICAgIGN0eCBJRCwgYSBnbG9iYWxseSB1bmlxdWUgdGFnICho
aWdoZXN0IGJpdCB1c2VkIGJ5IEd1QykKLSAqICAgICAgYml0cyA1My01NDogICAgbWJ6LCByZXNl
cnZlZCBmb3IgdXNlIGJ5IGhhcmR3YXJlCi0gKiAgICAgIGJpdHMgNTUtNjM6ICAgIGdyb3VwIElE
LCBjdXJyZW50bHkgdW51c2VkIGFuZCBzZXQgdG8gMAotICoKLSAqIFN0YXJ0aW5nIGZyb20gR2Vu
MTEsIHRoZSB1cHBlciBkd29yZCBvZiB0aGUgZGVzY3JpcHRvciBoYXMgYSBuZXcgZm9ybWF0Ogot
ICoKLSAqICAgICAgYml0cyAzMi0zNjogICAgcmVzZXJ2ZWQKLSAqICAgICAgYml0cyAzNy00Nzog
ICAgU1cgY29udGV4dCBJRAotICogICAgICBiaXRzIDQ4OjUzOiAgICBlbmdpbmUgaW5zdGFuY2UK
LSAqICAgICAgYml0IDU0OiAgICAgICAgbWJ6LCByZXNlcnZlZCBmb3IgdXNlIGJ5IGhhcmR3YXJl
Ci0gKiAgICAgIGJpdHMgNTUtNjA6ICAgIFNXIGNvdW50ZXIKLSAqICAgICAgYml0cyA2MS02Mzog
ICAgZW5naW5lIGNsYXNzCi0gKgotICogZW5naW5lIGluZm8sIFNXIGNvbnRleHQgSUQgYW5kIFNX
IGNvdW50ZXIgbmVlZCB0byBmb3JtIGEgdW5pcXVlIG51bWJlcgotICogKENvbnRleHQgSUQpIHBl
ciBscmMuCi0gKi8KLXN0YXRpYyB1MzIKLWxyY19kZXNjcmlwdG9yKHN0cnVjdCBpbnRlbF9jb250
ZXh0ICpjZSwgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQotewotCXUzMiBkZXNjOwot
Ci0JZGVzYyA9IElOVEVMX0xFR0FDWV8zMkJfQ09OVEVYVDsKLQlpZiAoaTkxNV92bV9pc180bHZs
KGNlLT52bSkpCi0JCWRlc2MgPSBJTlRFTF9MRUdBQ1lfNjRCX0NPTlRFWFQ7Ci0JZGVzYyA8PD0g
R0VOOF9DVFhfQUREUkVTU0lOR19NT0RFX1NISUZUOwotCi0JZGVzYyB8PSBHRU44X0NUWF9WQUxJ
RCB8IEdFTjhfQ1RYX1BSSVZJTEVHRTsKLQlpZiAoSVNfR0VOKGVuZ2luZS0+aTkxNSwgOCkpCi0J
CWRlc2MgfD0gR0VOOF9DVFhfTDNMTENfQ09IRVJFTlQ7Ci0KLQlyZXR1cm4gaTkxNV9nZ3R0X29m
ZnNldChjZS0+c3RhdGUpIHwgZGVzYzsKLX0KLQotc3RhdGljIGlubGluZSB1bnNpZ25lZCBpbnQg
ZHdvcmRfaW5fcGFnZSh2b2lkICphZGRyKQotewotCXJldHVybiBvZmZzZXRfaW5fcGFnZShhZGRy
KSAvIHNpemVvZih1MzIpOwotfQotCi1zdGF0aWMgdm9pZCBzZXRfb2Zmc2V0cyh1MzIgKnJlZ3Ms
Ci0JCQljb25zdCB1OCAqZGF0YSwKLQkJCWNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSwKLQkJCWJvb2wgY2xlYXIpCi0jZGVmaW5lIE5PUCh4KSAoQklUKDcpIHwgKHgpKQotI2Rl
ZmluZSBMUkkoY291bnQsIGZsYWdzKSAoKGZsYWdzKSA8PCA2IHwgKGNvdW50KSB8IEJVSUxEX0JV
R19PTl9aRVJPKGNvdW50ID49IEJJVCg2KSkpCi0jZGVmaW5lIFBPU1RFRCBCSVQoMCkKLSNkZWZp
bmUgUkVHKHgpICgoKHgpID4+IDIpIHwgQlVJTERfQlVHX09OX1pFUk8oeCA+PSAweDIwMCkpCi0j
ZGVmaW5lIFJFRzE2KHgpIFwKLQkoKCh4KSA+PiA5KSB8IEJJVCg3KSB8IEJVSUxEX0JVR19PTl9a
RVJPKHggPj0gMHgxMDAwMCkpLCBcCi0JKCgoeCkgPj4gMikgJiAweDdmKQotI2RlZmluZSBFTkQo
dG90YWxfc3RhdGVfc2l6ZSkgMCwgKHRvdGFsX3N0YXRlX3NpemUpCi17Ci0JY29uc3QgdTMyIGJh
c2UgPSBlbmdpbmUtPm1taW9fYmFzZTsKLQotCXdoaWxlICgqZGF0YSkgewotCQl1OCBjb3VudCwg
ZmxhZ3M7Ci0KLQkJaWYgKCpkYXRhICYgQklUKDcpKSB7IC8qIHNraXAgKi8KLQkJCWNvdW50ID0g
KmRhdGErKyAmIH5CSVQoNyk7Ci0JCQlpZiAoY2xlYXIpCi0JCQkJbWVtc2V0MzIocmVncywgTUlf
Tk9PUCwgY291bnQpOwotCQkJcmVncyArPSBjb3VudDsKLQkJCWNvbnRpbnVlOwotCQl9Ci0KLQkJ
Y291bnQgPSAqZGF0YSAmIDB4M2Y7Ci0JCWZsYWdzID0gKmRhdGEgPj4gNjsKLQkJZGF0YSsrOwot
Ci0JCSpyZWdzID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oY291bnQpOwotCQlpZiAoZmxhZ3MgJiBQ
T1NURUQpCi0JCQkqcmVncyB8PSBNSV9MUklfRk9SQ0VfUE9TVEVEOwotCQlpZiAoSU5URUxfR0VO
KGVuZ2luZS0+aTkxNSkgPj0gMTEpCi0JCQkqcmVncyB8PSBNSV9MUklfTFJNX0NTX01NSU87Ci0J
CXJlZ3MrKzsKLQotCQlHRU1fQlVHX09OKCFjb3VudCk7Ci0JCWRvIHsKLQkJCXUzMiBvZmZzZXQg
PSAwOwotCQkJdTggdjsKLQotCQkJZG8gewotCQkJCXYgPSAqZGF0YSsrOwotCQkJCW9mZnNldCA8
PD0gNzsKLQkJCQlvZmZzZXQgfD0gdiAmIH5CSVQoNyk7Ci0JCQl9IHdoaWxlICh2ICYgQklUKDcp
KTsKLQotCQkJcmVnc1swXSA9IGJhc2UgKyAob2Zmc2V0IDw8IDIpOwotCQkJaWYgKGNsZWFyKQot
CQkJCXJlZ3NbMV0gPSAwOwotCQkJcmVncyArPSAyOwotCQl9IHdoaWxlICgtLWNvdW50KTsKLQl9
Ci0KLQlpZiAoY2xlYXIpIHsKLQkJdTggY291bnQgPSAqKytkYXRhOwotCi0JCS8qIENsZWFyIHBh
c3QgdGhlIHRhaWwgZm9yIEhXIGFjY2VzcyAqLwotCQlHRU1fQlVHX09OKGR3b3JkX2luX3BhZ2Uo
cmVncykgPiBjb3VudCk7Ci0JCW1lbXNldDMyKHJlZ3MsIE1JX05PT1AsIGNvdW50IC0gZHdvcmRf
aW5fcGFnZShyZWdzKSk7Ci0KLQkJLyogQ2xvc2UgdGhlIGJhdGNoOyB1c2VkIG1haW5seSBieSBs
aXZlX2xyY19sYXlvdXQoKSAqLwotCQkqcmVncyA9IE1JX0JBVENIX0JVRkZFUl9FTkQ7Ci0JCWlm
IChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMCkKLQkJCSpyZWdzIHw9IEJJVCgwKTsKLQl9
Ci19Ci0KLXN0YXRpYyBjb25zdCB1OCBnZW44X3hjc19vZmZzZXRzW10gPSB7Ci0JTk9QKDEpLAot
CUxSSSgxMSwgMCksCi0JUkVHMTYoMHgyNDQpLAotCVJFRygweDAzNCksCi0JUkVHKDB4MDMwKSwK
LQlSRUcoMHgwMzgpLAotCVJFRygweDAzYyksCi0JUkVHKDB4MTY4KSwKLQlSRUcoMHgxNDApLAot
CVJFRygweDExMCksCi0JUkVHKDB4MTFjKSwKLQlSRUcoMHgxMTQpLAotCVJFRygweDExOCksCi0K
LQlOT1AoOSksCi0JTFJJKDksIDApLAotCVJFRzE2KDB4M2E4KSwKLQlSRUcxNigweDI4YyksCi0J
UkVHMTYoMHgyODgpLAotCVJFRzE2KDB4Mjg0KSwKLQlSRUcxNigweDI4MCksCi0JUkVHMTYoMHgy
N2MpLAotCVJFRzE2KDB4Mjc4KSwKLQlSRUcxNigweDI3NCksCi0JUkVHMTYoMHgyNzApLAotCi0J
Tk9QKDEzKSwKLQlMUkkoMiwgMCksCi0JUkVHMTYoMHgyMDApLAotCVJFRygweDAyOCksCi0KLQlF
TkQoODApCi19OwotCi1zdGF0aWMgY29uc3QgdTggZ2VuOV94Y3Nfb2Zmc2V0c1tdID0gewotCU5P
UCgxKSwKLQlMUkkoMTQsIFBPU1RFRCksCi0JUkVHMTYoMHgyNDQpLAotCVJFRygweDAzNCksCi0J
UkVHKDB4MDMwKSwKLQlSRUcoMHgwMzgpLAotCVJFRygweDAzYyksCi0JUkVHKDB4MTY4KSwKLQlS
RUcoMHgxNDApLAotCVJFRygweDExMCksCi0JUkVHKDB4MTFjKSwKLQlSRUcoMHgxMTQpLAotCVJF
RygweDExOCksCi0JUkVHKDB4MWMwKSwKLQlSRUcoMHgxYzQpLAotCVJFRygweDFjOCksCi0KLQlO
T1AoMyksCi0JTFJJKDksIFBPU1RFRCksCi0JUkVHMTYoMHgzYTgpLAotCVJFRzE2KDB4MjhjKSwK
LQlSRUcxNigweDI4OCksCi0JUkVHMTYoMHgyODQpLAotCVJFRzE2KDB4MjgwKSwKLQlSRUcxNigw
eDI3YyksCi0JUkVHMTYoMHgyNzgpLAotCVJFRzE2KDB4Mjc0KSwKLQlSRUcxNigweDI3MCksCi0K
LQlOT1AoMTMpLAotCUxSSSgxLCBQT1NURUQpLAotCVJFRzE2KDB4MjAwKSwKLQotCU5PUCgxMyks
Ci0JTFJJKDQ0LCBQT1NURUQpLAotCVJFRygweDAyOCksCi0JUkVHKDB4MDljKSwKLQlSRUcoMHgw
YzApLAotCVJFRygweDE3OCksCi0JUkVHKDB4MTdjKSwKLQlSRUcxNigweDM1OCksCi0JUkVHKDB4
MTcwKSwKLQlSRUcoMHgxNTApLAotCVJFRygweDE1NCksCi0JUkVHKDB4MTU4KSwKLQlSRUcxNigw
eDQxYyksCi0JUkVHMTYoMHg2MDApLAotCVJFRzE2KDB4NjA0KSwKLQlSRUcxNigweDYwOCksCi0J
UkVHMTYoMHg2MGMpLAotCVJFRzE2KDB4NjEwKSwKLQlSRUcxNigweDYxNCksCi0JUkVHMTYoMHg2
MTgpLAotCVJFRzE2KDB4NjFjKSwKLQlSRUcxNigweDYyMCksCi0JUkVHMTYoMHg2MjQpLAotCVJF
RzE2KDB4NjI4KSwKLQlSRUcxNigweDYyYyksCi0JUkVHMTYoMHg2MzApLAotCVJFRzE2KDB4NjM0
KSwKLQlSRUcxNigweDYzOCksCi0JUkVHMTYoMHg2M2MpLAotCVJFRzE2KDB4NjQwKSwKLQlSRUcx
NigweDY0NCksCi0JUkVHMTYoMHg2NDgpLAotCVJFRzE2KDB4NjRjKSwKLQlSRUcxNigweDY1MCks
Ci0JUkVHMTYoMHg2NTQpLAotCVJFRzE2KDB4NjU4KSwKLQlSRUcxNigweDY1YyksCi0JUkVHMTYo
MHg2NjApLAotCVJFRzE2KDB4NjY0KSwKLQlSRUcxNigweDY2OCksCi0JUkVHMTYoMHg2NmMpLAot
CVJFRzE2KDB4NjcwKSwKLQlSRUcxNigweDY3NCksCi0JUkVHMTYoMHg2NzgpLAotCVJFRzE2KDB4
NjdjKSwKLQlSRUcoMHgwNjgpLAotCi0JRU5EKDE3NikKLX07Ci0KLXN0YXRpYyBjb25zdCB1OCBn
ZW4xMl94Y3Nfb2Zmc2V0c1tdID0gewotCU5PUCgxKSwKLQlMUkkoMTMsIFBPU1RFRCksCi0JUkVH
MTYoMHgyNDQpLAotCVJFRygweDAzNCksCi0JUkVHKDB4MDMwKSwKLQlSRUcoMHgwMzgpLAotCVJF
RygweDAzYyksCi0JUkVHKDB4MTY4KSwKLQlSRUcoMHgxNDApLAotCVJFRygweDExMCksCi0JUkVH
KDB4MWMwKSwKLQlSRUcoMHgxYzQpLAotCVJFRygweDFjOCksCi0JUkVHKDB4MTgwKSwKLQlSRUcx
NigweDJiNCksCi0KLQlOT1AoNSksCi0JTFJJKDksIFBPU1RFRCksCi0JUkVHMTYoMHgzYTgpLAot
CVJFRzE2KDB4MjhjKSwKLQlSRUcxNigweDI4OCksCi0JUkVHMTYoMHgyODQpLAotCVJFRzE2KDB4
MjgwKSwKLQlSRUcxNigweDI3YyksCi0JUkVHMTYoMHgyNzgpLAotCVJFRzE2KDB4Mjc0KSwKLQlS
RUcxNigweDI3MCksCi0KLQlFTkQoODApCi19OwotCi1zdGF0aWMgY29uc3QgdTggZ2VuOF9yY3Nf
b2Zmc2V0c1tdID0gewotCU5PUCgxKSwKLQlMUkkoMTQsIFBPU1RFRCksCi0JUkVHMTYoMHgyNDQp
LAotCVJFRygweDAzNCksCi0JUkVHKDB4MDMwKSwKLQlSRUcoMHgwMzgpLAotCVJFRygweDAzYyks
Ci0JUkVHKDB4MTY4KSwKLQlSRUcoMHgxNDApLAotCVJFRygweDExMCksCi0JUkVHKDB4MTFjKSwK
LQlSRUcoMHgxMTQpLAotCVJFRygweDExOCksCi0JUkVHKDB4MWMwKSwKLQlSRUcoMHgxYzQpLAot
CVJFRygweDFjOCksCi0KLQlOT1AoMyksCi0JTFJJKDksIFBPU1RFRCksCi0JUkVHMTYoMHgzYTgp
LAotCVJFRzE2KDB4MjhjKSwKLQlSRUcxNigweDI4OCksCi0JUkVHMTYoMHgyODQpLAotCVJFRzE2
KDB4MjgwKSwKLQlSRUcxNigweDI3YyksCi0JUkVHMTYoMHgyNzgpLAotCVJFRzE2KDB4Mjc0KSwK
LQlSRUcxNigweDI3MCksCi0KLQlOT1AoMTMpLAotCUxSSSgxLCAwKSwKLQlSRUcoMHgwYzgpLAot
Ci0JRU5EKDgwKQotfTsKLQotc3RhdGljIGNvbnN0IHU4IGdlbjlfcmNzX29mZnNldHNbXSA9IHsK
LQlOT1AoMSksCi0JTFJJKDE0LCBQT1NURUQpLAotCVJFRzE2KDB4MjQ0KSwKLQlSRUcoMHgzNCks
Ci0JUkVHKDB4MzApLAotCVJFRygweDM4KSwKLQlSRUcoMHgzYyksCi0JUkVHKDB4MTY4KSwKLQlS
RUcoMHgxNDApLAotCVJFRygweDExMCksCi0JUkVHKDB4MTFjKSwKLQlSRUcoMHgxMTQpLAotCVJF
RygweDExOCksCi0JUkVHKDB4MWMwKSwKLQlSRUcoMHgxYzQpLAotCVJFRygweDFjOCksCi0KLQlO
T1AoMyksCi0JTFJJKDksIFBPU1RFRCksCi0JUkVHMTYoMHgzYTgpLAotCVJFRzE2KDB4MjhjKSwK
LQlSRUcxNigweDI4OCksCi0JUkVHMTYoMHgyODQpLAotCVJFRzE2KDB4MjgwKSwKLQlSRUcxNigw
eDI3YyksCi0JUkVHMTYoMHgyNzgpLAotCVJFRzE2KDB4Mjc0KSwKLQlSRUcxNigweDI3MCksCi0K
LQlOT1AoMTMpLAotCUxSSSgxLCAwKSwKLQlSRUcoMHhjOCksCi0KLQlOT1AoMTMpLAotCUxSSSg0
NCwgUE9TVEVEKSwKLQlSRUcoMHgyOCksCi0JUkVHKDB4OWMpLAotCVJFRygweGMwKSwKLQlSRUco
MHgxNzgpLAotCVJFRygweDE3YyksCi0JUkVHMTYoMHgzNTgpLAotCVJFRygweDE3MCksCi0JUkVH
KDB4MTUwKSwKLQlSRUcoMHgxNTQpLAotCVJFRygweDE1OCksCi0JUkVHMTYoMHg0MWMpLAotCVJF
RzE2KDB4NjAwKSwKLQlSRUcxNigweDYwNCksCi0JUkVHMTYoMHg2MDgpLAotCVJFRzE2KDB4NjBj
KSwKLQlSRUcxNigweDYxMCksCi0JUkVHMTYoMHg2MTQpLAotCVJFRzE2KDB4NjE4KSwKLQlSRUcx
NigweDYxYyksCi0JUkVHMTYoMHg2MjApLAotCVJFRzE2KDB4NjI0KSwKLQlSRUcxNigweDYyOCks
Ci0JUkVHMTYoMHg2MmMpLAotCVJFRzE2KDB4NjMwKSwKLQlSRUcxNigweDYzNCksCi0JUkVHMTYo
MHg2MzgpLAotCVJFRzE2KDB4NjNjKSwKLQlSRUcxNigweDY0MCksCi0JUkVHMTYoMHg2NDQpLAot
CVJFRzE2KDB4NjQ4KSwKLQlSRUcxNigweDY0YyksCi0JUkVHMTYoMHg2NTApLAotCVJFRzE2KDB4
NjU0KSwKLQlSRUcxNigweDY1OCksCi0JUkVHMTYoMHg2NWMpLAotCVJFRzE2KDB4NjYwKSwKLQlS
RUcxNigweDY2NCksCi0JUkVHMTYoMHg2NjgpLAotCVJFRzE2KDB4NjZjKSwKLQlSRUcxNigweDY3
MCksCi0JUkVHMTYoMHg2NzQpLAotCVJFRzE2KDB4Njc4KSwKLQlSRUcxNigweDY3YyksCi0JUkVH
KDB4NjgpLAotCi0JRU5EKDE3NikKLX07Ci0KLXN0YXRpYyBjb25zdCB1OCBnZW4xMV9yY3Nfb2Zm
c2V0c1tdID0gewotCU5PUCgxKSwKLQlMUkkoMTUsIFBPU1RFRCksCi0JUkVHMTYoMHgyNDQpLAot
CVJFRygweDAzNCksCi0JUkVHKDB4MDMwKSwKLQlSRUcoMHgwMzgpLAotCVJFRygweDAzYyksCi0J
UkVHKDB4MTY4KSwKLQlSRUcoMHgxNDApLAotCVJFRygweDExMCksCi0JUkVHKDB4MTFjKSwKLQlS
RUcoMHgxMTQpLAotCVJFRygweDExOCksCi0JUkVHKDB4MWMwKSwKLQlSRUcoMHgxYzQpLAotCVJF
RygweDFjOCksCi0JUkVHKDB4MTgwKSwKLQotCU5PUCgxKSwKLQlMUkkoOSwgUE9TVEVEKSwKLQlS
RUcxNigweDNhOCksCi0JUkVHMTYoMHgyOGMpLAotCVJFRzE2KDB4Mjg4KSwKLQlSRUcxNigweDI4
NCksCi0JUkVHMTYoMHgyODApLAotCVJFRzE2KDB4MjdjKSwKLQlSRUcxNigweDI3OCksCi0JUkVH
MTYoMHgyNzQpLAotCVJFRzE2KDB4MjcwKSwKLQotCUxSSSgxLCBQT1NURUQpLAotCVJFRygweDFi
MCksCi0KLQlOT1AoMTApLAotCUxSSSgxLCAwKSwKLQlSRUcoMHgwYzgpLAotCi0JRU5EKDgwKQot
fTsKLQotc3RhdGljIGNvbnN0IHU4IGdlbjEyX3Jjc19vZmZzZXRzW10gPSB7Ci0JTk9QKDEpLAot
CUxSSSgxMywgUE9TVEVEKSwKLQlSRUcxNigweDI0NCksCi0JUkVHKDB4MDM0KSwKLQlSRUcoMHgw
MzApLAotCVJFRygweDAzOCksCi0JUkVHKDB4MDNjKSwKLQlSRUcoMHgxNjgpLAotCVJFRygweDE0
MCksCi0JUkVHKDB4MTEwKSwKLQlSRUcoMHgxYzApLAotCVJFRygweDFjNCksCi0JUkVHKDB4MWM4
KSwKLQlSRUcoMHgxODApLAotCVJFRzE2KDB4MmI0KSwKLQotCU5PUCg1KSwKLQlMUkkoOSwgUE9T
VEVEKSwKLQlSRUcxNigweDNhOCksCi0JUkVHMTYoMHgyOGMpLAotCVJFRzE2KDB4Mjg4KSwKLQlS
RUcxNigweDI4NCksCi0JUkVHMTYoMHgyODApLAotCVJFRzE2KDB4MjdjKSwKLQlSRUcxNigweDI3
OCksCi0JUkVHMTYoMHgyNzQpLAotCVJFRzE2KDB4MjcwKSwKLQotCUxSSSgzLCBQT1NURUQpLAot
CVJFRygweDFiMCksCi0JUkVHMTYoMHg1YTgpLAotCVJFRzE2KDB4NWFjKSwKLQotCU5PUCg2KSwK
LQlMUkkoMSwgMCksCi0JUkVHKDB4MGM4KSwKLQlOT1AoMyArIDkgKyAxKSwKLQotCUxSSSg1MSwg
UE9TVEVEKSwKLQlSRUcxNigweDU4OCksCi0JUkVHMTYoMHg1ODgpLAotCVJFRzE2KDB4NTg4KSwK
LQlSRUcxNigweDU4OCksCi0JUkVHMTYoMHg1ODgpLAotCVJFRzE2KDB4NTg4KSwKLQlSRUcoMHgw
MjgpLAotCVJFRygweDA5YyksCi0JUkVHKDB4MGMwKSwKLQlSRUcoMHgxNzgpLAotCVJFRygweDE3
YyksCi0JUkVHMTYoMHgzNTgpLAotCVJFRygweDE3MCksCi0JUkVHKDB4MTUwKSwKLQlSRUcoMHgx
NTQpLAotCVJFRygweDE1OCksCi0JUkVHMTYoMHg0MWMpLAotCVJFRzE2KDB4NjAwKSwKLQlSRUcx
NigweDYwNCksCi0JUkVHMTYoMHg2MDgpLAotCVJFRzE2KDB4NjBjKSwKLQlSRUcxNigweDYxMCks
Ci0JUkVHMTYoMHg2MTQpLAotCVJFRzE2KDB4NjE4KSwKLQlSRUcxNigweDYxYyksCi0JUkVHMTYo
MHg2MjApLAotCVJFRzE2KDB4NjI0KSwKLQlSRUcxNigweDYyOCksCi0JUkVHMTYoMHg2MmMpLAot
CVJFRzE2KDB4NjMwKSwKLQlSRUcxNigweDYzNCksCi0JUkVHMTYoMHg2MzgpLAotCVJFRzE2KDB4
NjNjKSwKLQlSRUcxNigweDY0MCksCi0JUkVHMTYoMHg2NDQpLAotCVJFRzE2KDB4NjQ4KSwKLQlS
RUcxNigweDY0YyksCi0JUkVHMTYoMHg2NTApLAotCVJFRzE2KDB4NjU0KSwKLQlSRUcxNigweDY1
OCksCi0JUkVHMTYoMHg2NWMpLAotCVJFRzE2KDB4NjYwKSwKLQlSRUcxNigweDY2NCksCi0JUkVH
MTYoMHg2NjgpLAotCVJFRzE2KDB4NjZjKSwKLQlSRUcxNigweDY3MCksCi0JUkVHMTYoMHg2NzQp
LAotCVJFRzE2KDB4Njc4KSwKLQlSRUcxNigweDY3YyksCi0JUkVHKDB4MDY4KSwKLQlSRUcoMHgw
ODQpLAotCU5PUCgxKSwKLQotCUVORCgxOTIpCi19OwotCi0jdW5kZWYgRU5ECi0jdW5kZWYgUkVH
MTYKLSN1bmRlZiBSRUcKLSN1bmRlZiBMUkkKLSN1bmRlZiBOT1AKLQotc3RhdGljIGNvbnN0IHU4
ICpyZWdfb2Zmc2V0cyhjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCi17Ci0J
LyoKLQkgKiBUaGUgZ2VuMTIrIGxpc3RzIG9ubHkgaGF2ZSB0aGUgcmVnaXN0ZXJzIHdlIHByb2dy
YW0gaW4gdGhlIGJhc2ljCi0JICogZGVmYXVsdCBzdGF0ZS4gV2UgcmVseSBvbiB0aGUgY29udGV4
dCBpbWFnZSB1c2luZyByZWxhdGl2ZQotCSAqIGFkZHJlc3NpbmcgdG8gYXV0b21hdGljIGZpeHVw
IHRoZSByZWdpc3RlciBzdGF0ZSBiZXR3ZWVuIHRoZQotCSAqIHBoeXNpY2FsIGVuZ2luZXMgZm9y
IHZpcnR1YWwgZW5naW5lLgotCSAqLwotCUdFTV9CVUdfT04oSU5URUxfR0VOKGVuZ2luZS0+aTkx
NSkgPj0gMTIgJiYKLQkJICAgIWludGVsX2VuZ2luZV9oYXNfcmVsYXRpdmVfbW1pbyhlbmdpbmUp
KTsKLQotCWlmIChlbmdpbmUtPmNsYXNzID09IFJFTkRFUl9DTEFTUykgewotCQlpZiAoSU5URUxf
R0VOKGVuZ2luZS0+aTkxNSkgPj0gMTIpCi0JCQlyZXR1cm4gZ2VuMTJfcmNzX29mZnNldHM7Ci0J
CWVsc2UgaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDExKQotCQkJcmV0dXJuIGdlbjEx
X3Jjc19vZmZzZXRzOwotCQllbHNlIGlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSA5KQot
CQkJcmV0dXJuIGdlbjlfcmNzX29mZnNldHM7Ci0JCWVsc2UKLQkJCXJldHVybiBnZW44X3Jjc19v
ZmZzZXRzOwotCX0gZWxzZSB7Ci0JCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMikK
LQkJCXJldHVybiBnZW4xMl94Y3Nfb2Zmc2V0czsKLQkJZWxzZSBpZiAoSU5URUxfR0VOKGVuZ2lu
ZS0+aTkxNSkgPj0gOSkKLQkJCXJldHVybiBnZW45X3hjc19vZmZzZXRzOwotCQllbHNlCi0JCQly
ZXR1cm4gZ2VuOF94Y3Nfb2Zmc2V0czsKLQl9Ci19Ci0KIHN0YXRpYyBzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICoKIF9fdW53aW5kX2luY29tcGxldGVfcmVxdWVzdHMoc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lKQogewpAQCAtMTE4Nyw1OCArNDkzLDYgQEAgc3RhdGljIHZvaWQgaW50ZWxfZW5n
aW5lX2NvbnRleHRfb3V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAl3cml0ZV9z
ZXF1bmxvY2tfaXJxcmVzdG9yZSgmZW5naW5lLT5zdGF0cy5sb2NrLCBmbGFncyk7CiB9CiAKLXN0
YXRpYyB2b2lkCi1leGVjbGlzdHNfY2hlY2tfY29udGV4dChjb25zdCBzdHJ1Y3QgaW50ZWxfY29u
dGV4dCAqY2UsCi0JCQljb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCi0JCQlj
b25zdCBjaGFyICp3aGVuKQotewotCWNvbnN0IHN0cnVjdCBpbnRlbF9yaW5nICpyaW5nID0gY2Ut
PnJpbmc7Ci0JdTMyICpyZWdzID0gY2UtPmxyY19yZWdfc3RhdGU7Ci0JYm9vbCB2YWxpZCA9IHRy
dWU7Ci0JaW50IHg7Ci0KLQlpZiAocmVnc1tDVFhfUklOR19TVEFSVF0gIT0gaTkxNV9nZ3R0X29m
ZnNldChyaW5nLT52bWEpKSB7Ci0JCXByX2VycigiJXM6IGNvbnRleHQgc3VibWl0dGVkIHdpdGgg
aW5jb3JyZWN0IFJJTkdfU1RBUlQgWyUwOHhdLCBleHBlY3RlZCAlMDh4XG4iLAotCQkgICAgICAg
ZW5naW5lLT5uYW1lLAotCQkgICAgICAgcmVnc1tDVFhfUklOR19TVEFSVF0sCi0JCSAgICAgICBp
OTE1X2dndHRfb2Zmc2V0KHJpbmctPnZtYSkpOwotCQlyZWdzW0NUWF9SSU5HX1NUQVJUXSA9IGk5
MTVfZ2d0dF9vZmZzZXQocmluZy0+dm1hKTsKLQkJdmFsaWQgPSBmYWxzZTsKLQl9Ci0KLQlpZiAo
KHJlZ3NbQ1RYX1JJTkdfQ1RMXSAmIH4oUklOR19XQUlUIHwgUklOR19XQUlUX1NFTUFQSE9SRSkp
ICE9Ci0JICAgIChSSU5HX0NUTF9TSVpFKHJpbmctPnNpemUpIHwgUklOR19WQUxJRCkpIHsKLQkJ
cHJfZXJyKCIlczogY29udGV4dCBzdWJtaXR0ZWQgd2l0aCBpbmNvcnJlY3QgUklOR19DVEwgWyUw
OHhdLCBleHBlY3RlZCAlMDh4XG4iLAotCQkgICAgICAgZW5naW5lLT5uYW1lLAotCQkgICAgICAg
cmVnc1tDVFhfUklOR19DVExdLAotCQkgICAgICAgKHUzMikoUklOR19DVExfU0laRShyaW5nLT5z
aXplKSB8IFJJTkdfVkFMSUQpKTsKLQkJcmVnc1tDVFhfUklOR19DVExdID0gUklOR19DVExfU0la
RShyaW5nLT5zaXplKSB8IFJJTkdfVkFMSUQ7Ci0JCXZhbGlkID0gZmFsc2U7Ci0JfQotCi0JeCA9
IGxyY19yaW5nX21pX21vZGUoZW5naW5lKTsKLQlpZiAoeCAhPSAtMSAmJiByZWdzW3ggKyAxXSAm
IChyZWdzW3ggKyAxXSA+PiAxNikgJiBTVE9QX1JJTkcpIHsKLQkJcHJfZXJyKCIlczogY29udGV4
dCBzdWJtaXR0ZWQgd2l0aCBTVE9QX1JJTkcgWyUwOHhdIGluIFJJTkdfTUlfTU9ERVxuIiwKLQkJ
ICAgICAgIGVuZ2luZS0+bmFtZSwgcmVnc1t4ICsgMV0pOwotCQlyZWdzW3ggKyAxXSAmPSB+U1RP
UF9SSU5HOwotCQlyZWdzW3ggKyAxXSB8PSBTVE9QX1JJTkcgPDwgMTY7Ci0JCXZhbGlkID0gZmFs
c2U7Ci0JfQotCi0JV0FSTl9PTkNFKCF2YWxpZCwgIkludmFsaWQgbHJjIHN0YXRlIGZvdW5kICVz
IHN1Ym1pc3Npb25cbiIsIHdoZW4pOwotfQotCi1zdGF0aWMgdm9pZCByZXN0b3JlX2RlZmF1bHRf
c3RhdGUoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAotCQkJCSAgc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lKQotewotCXUzMiAqcmVnczsKLQotCXJlZ3MgPSBtZW1zZXQoY2UtPmxyY19y
ZWdfc3RhdGUsIDAsIGVuZ2luZS0+Y29udGV4dF9zaXplIC0gUEFHRV9TSVpFKTsKLQlleGVjbGlz
dHNfaW5pdF9yZWdfc3RhdGUocmVncywgY2UsIGVuZ2luZSwgY2UtPnJpbmcsIHRydWUpOwotCi0J
Y2UtPnJ1bnRpbWUubGFzdCA9IGludGVsX2NvbnRleHRfZ2V0X3J1bnRpbWUoY2UpOwotfQotCiBz
dGF0aWMgdm9pZCByZXNldF9hY3RpdmUoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCiAJCQkgc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewpAQCAtMTI3MSw0MiArNTI1LDEwIEBAIHN0
YXRpYyB2b2lkIHJlc2V0X2FjdGl2ZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKIAloZWFkID0g
aW50ZWxfcmluZ193cmFwKGNlLT5yaW5nLCBoZWFkKTsKIAogCS8qIFNjcnViIHRoZSBjb250ZXh0
IGltYWdlIHRvIHByZXZlbnQgcmVwbGF5aW5nIHRoZSBwcmV2aW91cyBiYXRjaCAqLwotCXJlc3Rv
cmVfZGVmYXVsdF9zdGF0ZShjZSwgZW5naW5lKTsKLQlfX2V4ZWNsaXN0c191cGRhdGVfcmVnX3N0
YXRlKGNlLCBlbmdpbmUsIGhlYWQpOworCWxyY19yZXN0b3JlX2RlZmF1bHRzKGNlLCBlbmdpbmUp
OwogCiAJLyogV2UndmUgc3dpdGNoZWQgYXdheSwgc28gdGhpcyBzaG91bGQgYmUgYSBuby1vcCwg
YnV0IGludGVudCBtYXR0ZXJzICovCi0JY2UtPmxyYy5kZXNjIHw9IENUWF9ERVNDX0ZPUkNFX1JF
U1RPUkU7Ci19Ci0KLXN0YXRpYyB2b2lkIHN0X3VwZGF0ZV9ydW50aW1lX3VuZGVyZmxvdyhzdHJ1
Y3QgaW50ZWxfY29udGV4dCAqY2UsIHMzMiBkdCkKLXsKLSNpZiBJU19FTkFCTEVEKENPTkZJR19E
Uk1fSTkxNV9TRUxGVEVTVCkKLQljZS0+cnVudGltZS5udW1fdW5kZXJmbG93Kys7Ci0JY2UtPnJ1
bnRpbWUubWF4X3VuZGVyZmxvdyA9IG1heF90KHUzMiwgY2UtPnJ1bnRpbWUubWF4X3VuZGVyZmxv
dywgLWR0KTsKLSNlbmRpZgotfQotCi1zdGF0aWMgdm9pZCBpbnRlbF9jb250ZXh0X3VwZGF0ZV9y
dW50aW1lKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKLXsKLQl1MzIgb2xkOwotCXMzMiBkdDsK
LQotCWlmIChpbnRlbF9jb250ZXh0X2lzX2JhcnJpZXIoY2UpKQotCQlyZXR1cm47Ci0KLQlvbGQg
PSBjZS0+cnVudGltZS5sYXN0OwotCWNlLT5ydW50aW1lLmxhc3QgPSBpbnRlbF9jb250ZXh0X2dl
dF9ydW50aW1lKGNlKTsKLQlkdCA9IGNlLT5ydW50aW1lLmxhc3QgLSBvbGQ7Ci0KLQlpZiAodW5s
aWtlbHkoZHQgPCAwKSkgewotCQlDRV9UUkFDRShjZSwgInJ1bnRpbWUgdW5kZXJmbG93OiBsYXN0
PSV1LCBuZXc9JXUsIGRlbHRhPSVkXG4iLAotCQkJIG9sZCwgY2UtPnJ1bnRpbWUubGFzdCwgZHQp
OwotCQlzdF91cGRhdGVfcnVudGltZV91bmRlcmZsb3coY2UsIGR0KTsKLQkJcmV0dXJuOwotCX0K
LQotCWV3bWFfcnVudGltZV9hZGQoJmNlLT5ydW50aW1lLmF2ZywgZHQpOwotCWNlLT5ydW50aW1l
LnRvdGFsICs9IGR0OworCWNlLT5scmMubHJjYSA9IGxyY191cGRhdGVfcmVncyhjZSwgZW5naW5l
LCBoZWFkKTsKIH0KIAogc3RhdGljIGlubGluZSBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICoKQEAg
LTEzMjEsNyArNTQzLDcgQEAgX19leGVjbGlzdHNfc2NoZWR1bGVfaW4oc3RydWN0IGk5MTVfcmVx
dWVzdCAqcnEpCiAJCXJlc2V0X2FjdGl2ZShycSwgZW5naW5lKTsKIAogCWlmIChJU19FTkFCTEVE
KENPTkZJR19EUk1fSTkxNV9ERUJVR19HRU0pKQotCQlleGVjbGlzdHNfY2hlY2tfY29udGV4dChj
ZSwgZW5naW5lLCAiYmVmb3JlIik7CisJCWxyY19jaGVja19yZWdzKGNlLCBlbmdpbmUsICJiZWZv
cmUiKTsKIAogCWlmIChjZS0+dGFnKSB7CiAJCS8qIFVzZSBhIGZpeGVkIHRhZyBmb3IgT0EgYW5k
IGZyaWVuZHMgKi8KQEAgLTEzOTMsNyArNjE1LDcgQEAgX19leGVjbGlzdHNfc2NoZWR1bGVfb3V0
KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAogCSAqLwogCiAJaWYgKElTX0VOQUJMRUQoQ09ORklH
X0RSTV9JOTE1X0RFQlVHX0dFTSkpCi0JCWV4ZWNsaXN0c19jaGVja19jb250ZXh0KGNlLCBlbmdp
bmUsICJhZnRlciIpOworCQlscmNfY2hlY2tfcmVncyhjZSwgZW5naW5lLCAiYWZ0ZXIiKTsKIAog
CS8qCiAJICogSWYgd2UgaGF2ZSBqdXN0IGNvbXBsZXRlZCB0aGlzIGNvbnRleHQsIHRoZSBlbmdp
bmUgbWF5IG5vdyBiZQpAQCAtMTQxMSw3ICs2MzMsNyBAQCBfX2V4ZWNsaXN0c19zY2hlZHVsZV9v
dXQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCiAJCXNldF9iaXQoY2NpZCAtIDEsICZlbmdpbmUt
PmNvbnRleHRfdGFnKTsKIAl9CiAKLQlpbnRlbF9jb250ZXh0X3VwZGF0ZV9ydW50aW1lKGNlKTsK
KwlscmNfdXBkYXRlX3J1bnRpbWUoY2UpOwogCWludGVsX2VuZ2luZV9jb250ZXh0X291dChlbmdp
bmUpOwogCWV4ZWNsaXN0c19jb250ZXh0X3N0YXR1c19jaGFuZ2UocnEsIElOVEVMX0NPTlRFWFRf
U0NIRURVTEVfT1VUKTsKIAlpZiAoZW5naW5lLT5md19kb21haW4gJiYgIWF0b21pY19kZWNfcmV0
dXJuKCZlbmdpbmUtPmZ3X2FjdGl2ZSkpCkBAIC0xNzUyLDEyICs5NzQsNiBAQCBzdGF0aWMgYm9v
bCBjYW5fbWVyZ2VfcnEoY29uc3Qgc3RydWN0IGk5MTVfcmVxdWVzdCAqcHJldiwKIAlyZXR1cm4g
dHJ1ZTsKIH0KIAotc3RhdGljIHZvaWQgdmlydHVhbF91cGRhdGVfcmVnaXN0ZXJfb2Zmc2V0cyh1
MzIgKnJlZ3MsCi0JCQkJCSAgICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCi17Ci0J
c2V0X29mZnNldHMocmVncywgcmVnX29mZnNldHMoZW5naW5lKSwgZW5naW5lLCBmYWxzZSk7Ci19
Ci0KIHN0YXRpYyBib29sIHZpcnR1YWxfbWF0Y2hlcyhjb25zdCBzdHJ1Y3QgdmlydHVhbF9lbmdp
bmUgKnZlLAogCQkJICAgIGNvbnN0IHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAogCQkJICAgIGNv
bnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKQEAgLTE3OTMsOCArMTAwOSw3IEBA
IHN0YXRpYyB2b2lkIHZpcnR1YWxfeGZlcl9jb250ZXh0KHN0cnVjdCB2aXJ0dWFsX2VuZ2luZSAq
dmUsCiAKIAlHRU1fQlVHX09OKFJFQURfT05DRSh2ZS0+Y29udGV4dC5pbmZsaWdodCkpOwogCWlm
ICghaW50ZWxfZW5naW5lX2hhc19yZWxhdGl2ZV9tbWlvKGVuZ2luZSkpCi0JCXZpcnR1YWxfdXBk
YXRlX3JlZ2lzdGVyX29mZnNldHModmUtPmNvbnRleHQubHJjX3JlZ19zdGF0ZSwKLQkJCQkJCWVu
Z2luZSk7CisJCWxyY191cGRhdGVfb2Zmc2V0cygmdmUtPmNvbnRleHQsIGVuZ2luZSk7CiAKIAkv
KgogCSAqIE1vdmUgdGhlIGJvdW5kIGVuZ2luZSB0byB0aGUgdG9wIG9mIHRoZSBsaXN0IGZvcgpA
QCAtMzI4NywyNDggKzI1MDIsNTUgQEAgc3RhdGljIHZvaWQgZXhlY2xpc3RzX3N1Ym1pdF9yZXF1
ZXN0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QpCiAJc3Bpbl91bmxvY2tfaXJxcmVzdG9y
ZSgmZW5naW5lLT5hY3RpdmUubG9jaywgZmxhZ3MpOwogfQogCi1zdGF0aWMgdm9pZCBfX2V4ZWNs
aXN0c19jb250ZXh0X2Zpbmkoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQotewotCWludGVsX3Jp
bmdfcHV0KGNlLT5yaW5nKTsKLQlpOTE1X3ZtYV9wdXQoY2UtPnN0YXRlKTsKLX0KLQotc3RhdGlj
IHZvaWQgZXhlY2xpc3RzX2NvbnRleHRfZGVzdHJveShzdHJ1Y3Qga3JlZiAqa3JlZikKK3N0YXRp
YyBpbnQgZXhlY2xpc3RzX2NvbnRleHRfcHJlX3BpbihzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2Us
CisJCQkJICAgICBzdHJ1Y3QgaTkxNV9nZW1fd3dfY3R4ICp3dywKKwkJCQkgICAgIHZvaWQgKip2
YWRkcikKIHsKLQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UgPSBjb250YWluZXJfb2Yoa3JlZiwg
dHlwZW9mKCpjZSksIHJlZik7Ci0KLQlHRU1fQlVHX09OKCFpOTE1X2FjdGl2ZV9pc19pZGxlKCZj
ZS0+YWN0aXZlKSk7Ci0JR0VNX0JVR19PTihpbnRlbF9jb250ZXh0X2lzX3Bpbm5lZChjZSkpOwot
Ci0JaWYgKGNlLT5zdGF0ZSkKLQkJX19leGVjbGlzdHNfY29udGV4dF9maW5pKGNlKTsKLQotCWlu
dGVsX2NvbnRleHRfZmluaShjZSk7Ci0JaW50ZWxfY29udGV4dF9mcmVlKGNlKTsKLX0KLQotc3Rh
dGljIHZvaWQKLXNldF9yZWR6b25lKHZvaWQgKnZhZGRyLCBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmUpCi17Ci0JaWYgKCFJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9ERUJV
R19HRU0pKQotCQlyZXR1cm47Ci0KLQl2YWRkciArPSBlbmdpbmUtPmNvbnRleHRfc2l6ZTsKLQot
CW1lbXNldCh2YWRkciwgQ09OVEVYVF9SRURaT05FLCBJOTE1X0dUVF9QQUdFX1NJWkUpOwotfQot
Ci1zdGF0aWMgdm9pZAotY2hlY2tfcmVkem9uZShjb25zdCB2b2lkICp2YWRkciwgY29uc3Qgc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQotewotCWlmICghSVNfRU5BQkxFRChDT05GSUdf
RFJNX0k5MTVfREVCVUdfR0VNKSkKLQkJcmV0dXJuOwotCi0JdmFkZHIgKz0gZW5naW5lLT5jb250
ZXh0X3NpemU7Ci0KLQlpZiAobWVtY2hyX2ludih2YWRkciwgQ09OVEVYVF9SRURaT05FLCBJOTE1
X0dUVF9QQUdFX1NJWkUpKQotCQlkcm1fZXJyX29uY2UoJmVuZ2luZS0+aTkxNS0+ZHJtLAotCQkJ
ICAgICAiJXMgY29udGV4dCByZWR6b25lIG92ZXJ3cml0dGVuIVxuIiwKLQkJCSAgICAgZW5naW5l
LT5uYW1lKTsKLX0KLQotc3RhdGljIHZvaWQgZXhlY2xpc3RzX2NvbnRleHRfdW5waW4oc3RydWN0
IGludGVsX2NvbnRleHQgKmNlKQotewotCWNoZWNrX3JlZHpvbmUoKHZvaWQgKiljZS0+bHJjX3Jl
Z19zdGF0ZSAtIExSQ19TVEFURV9PRkZTRVQsCi0JCSAgICAgIGNlLT5lbmdpbmUpOwotfQotCi1z
dGF0aWMgdm9pZCBleGVjbGlzdHNfY29udGV4dF9wb3N0X3VucGluKHN0cnVjdCBpbnRlbF9jb250
ZXh0ICpjZSkKLXsKLQlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKGNlLT5zdGF0ZS0+b2JqKTsK
LX0KLQotc3RhdGljIHUzMiAqCi1nZW4xMl9lbWl0X3RpbWVzdGFtcF93YShjb25zdCBzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqY2UsIHUzMiAqY3MpCi17Ci0JKmNzKysgPSBNSV9MT0FEX1JFR0lTVEVS
X01FTV9HRU44IHwKLQkJTUlfU1JNX0xSTV9HTE9CQUxfR1RUIHwKLQkJTUlfTFJJX0xSTV9DU19N
TUlPOwotCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9SSU5HX0NTX0dQUigwLCAw
KSk7Ci0JKmNzKysgPSBpOTE1X2dndHRfb2Zmc2V0KGNlLT5zdGF0ZSkgKyBMUkNfU1RBVEVfT0ZG
U0VUICsKLQkJQ1RYX1RJTUVTVEFNUCAqIHNpemVvZih1MzIpOwotCSpjcysrID0gMDsKLQotCSpj
cysrID0gTUlfTE9BRF9SRUdJU1RFUl9SRUcgfAotCQlNSV9MUlJfU09VUkNFX0NTX01NSU8gfAot
CQlNSV9MUklfTFJNX0NTX01NSU87Ci0JKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44
X1JJTkdfQ1NfR1BSKDAsIDApKTsKLQkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdf
Q1RYX1RJTUVTVEFNUCgwKSk7Ci0KLQkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJfUkVHIHwKLQkJ
TUlfTFJSX1NPVVJDRV9DU19NTUlPIHwKLQkJTUlfTFJJX0xSTV9DU19NTUlPOwotCSpjcysrID0g
aTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9SSU5HX0NTX0dQUigwLCAwKSk7Ci0JKmNzKysgPSBp
OTE1X21taW9fcmVnX29mZnNldChSSU5HX0NUWF9USU1FU1RBTVAoMCkpOwotCi0JcmV0dXJuIGNz
OworCXJldHVybiBscmNfcHJlX3BpbihjZSwgY2UtPmVuZ2luZSwgd3csIHZhZGRyKTsKIH0KIAot
c3RhdGljIHUzMiAqCi1nZW4xMl9lbWl0X3Jlc3RvcmVfc2NyYXRjaChjb25zdCBzdHJ1Y3QgaW50
ZWxfY29udGV4dCAqY2UsIHUzMiAqY3MpCi17Ci0JR0VNX0JVR19PTihscmNfcmluZ19ncHIwKGNl
LT5lbmdpbmUpID09IC0xKTsKLQotCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9NRU1fR0VOOCB8
Ci0JCU1JX1NSTV9MUk1fR0xPQkFMX0dUVCB8Ci0JCU1JX0xSSV9MUk1fQ1NfTU1JTzsKLQkqY3Mr
KyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEdFTjhfUklOR19DU19HUFIoMCwgMCkpOwotCSpjcysr
ID0gaTkxNV9nZ3R0X29mZnNldChjZS0+c3RhdGUpICsgTFJDX1NUQVRFX09GRlNFVCArCi0JCShs
cmNfcmluZ19ncHIwKGNlLT5lbmdpbmUpICsgMSkgKiBzaXplb2YodTMyKTsKLQkqY3MrKyA9IDA7
Ci0KLQlyZXR1cm4gY3M7Ci19Ci0KLXN0YXRpYyB1MzIgKgotZ2VuMTJfZW1pdF9jbWRfYnVmX3dh
KGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgdTMyICpjcykKLXsKLQlHRU1fQlVHX09O
KGxyY19yaW5nX2NtZF9idWZfY2N0bChjZS0+ZW5naW5lKSA9PSAtMSk7Ci0KLQkqY3MrKyA9IE1J
X0xPQURfUkVHSVNURVJfTUVNX0dFTjggfAotCQlNSV9TUk1fTFJNX0dMT0JBTF9HVFQgfAotCQlN
SV9MUklfTFJNX0NTX01NSU87Ci0JKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X1JJ
TkdfQ1NfR1BSKDAsIDApKTsKLQkqY3MrKyA9IGk5MTVfZ2d0dF9vZmZzZXQoY2UtPnN0YXRlKSAr
IExSQ19TVEFURV9PRkZTRVQgKwotCQkobHJjX3JpbmdfY21kX2J1Zl9jY3RsKGNlLT5lbmdpbmUp
ICsgMSkgKiBzaXplb2YodTMyKTsKLQkqY3MrKyA9IDA7Ci0KLQkqY3MrKyA9IE1JX0xPQURfUkVH
SVNURVJfUkVHIHwKLQkJTUlfTFJSX1NPVVJDRV9DU19NTUlPIHwKLQkJTUlfTFJJX0xSTV9DU19N
TUlPOwotCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9SSU5HX0NTX0dQUigwLCAw
KSk7Ci0JKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChSSU5HX0NNRF9CVUZfQ0NUTCgwKSk7
Ci0KLQlyZXR1cm4gY3M7Ci19Ci0KLXN0YXRpYyB1MzIgKgotZ2VuMTJfZW1pdF9pbmRpcmVjdF9j
dHhfcmNzKGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgdTMyICpjcykKLXsKLQljcyA9
IGdlbjEyX2VtaXRfdGltZXN0YW1wX3dhKGNlLCBjcyk7Ci0JY3MgPSBnZW4xMl9lbWl0X2NtZF9i
dWZfd2EoY2UsIGNzKTsKLQljcyA9IGdlbjEyX2VtaXRfcmVzdG9yZV9zY3JhdGNoKGNlLCBjcyk7
Ci0KLQlyZXR1cm4gY3M7Ci19Ci0KLXN0YXRpYyB1MzIgKgotZ2VuMTJfZW1pdF9pbmRpcmVjdF9j
dHhfeGNzKGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgdTMyICpjcykKLXsKLQljcyA9
IGdlbjEyX2VtaXRfdGltZXN0YW1wX3dhKGNlLCBjcyk7Ci0JY3MgPSBnZW4xMl9lbWl0X3Jlc3Rv
cmVfc2NyYXRjaChjZSwgY3MpOwotCi0JcmV0dXJuIGNzOwotfQotCi1zdGF0aWMgaW5saW5lIHUz
MiBjb250ZXh0X3dhX2JiX29mZnNldChjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCi17
Ci0JcmV0dXJuIFBBR0VfU0laRSAqIGNlLT53YV9iYl9wYWdlOwotfQotCi1zdGF0aWMgdTMyICpj
b250ZXh0X2luZGlyZWN0X2JiKGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKLXsKLQl2
b2lkICpwdHI7Ci0KLQlHRU1fQlVHX09OKCFjZS0+d2FfYmJfcGFnZSk7Ci0KLQlwdHIgPSBjZS0+
bHJjX3JlZ19zdGF0ZTsKLQlwdHIgLT0gTFJDX1NUQVRFX09GRlNFVDsgLyogYmFjayB0byBzdGFy
dCBvZiBjb250ZXh0IGltYWdlICovCi0JcHRyICs9IGNvbnRleHRfd2FfYmJfb2Zmc2V0KGNlKTsK
LQotCXJldHVybiBwdHI7Ci19Ci0KLXN0YXRpYyB2b2lkCi1zZXR1cF9pbmRpcmVjdF9jdHhfYmIo
Y29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAotCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUsCi0JCSAgICAgIHUzMiAqKCplbWl0KShjb25zdCBzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqLCB1MzIgKikpCitzdGF0aWMgaW50IGV4ZWNsaXN0c19jb250ZXh0X3Bp
bihzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHZvaWQgKnZhZGRyKQogewotCXUzMiAqIGNvbnN0
IHN0YXJ0ID0gY29udGV4dF9pbmRpcmVjdF9iYihjZSk7Ci0JdTMyICpjczsKLQotCWNzID0gZW1p
dChjZSwgc3RhcnQpOwotCUdFTV9CVUdfT04oY3MgLSBzdGFydCA+IEk5MTVfR1RUX1BBR0VfU0la
RSAvIHNpemVvZigqY3MpKTsKLQl3aGlsZSAoKHVuc2lnbmVkIGxvbmcpY3MgJSBDQUNIRUxJTkVf
QllURVMpCi0JCSpjcysrID0gTUlfTk9PUDsKLQotCWxyY19yaW5nX3NldHVwX2luZGlyZWN0X2N0
eChjZS0+bHJjX3JlZ19zdGF0ZSwgZW5naW5lLAotCQkJCSAgICBpOTE1X2dndHRfb2Zmc2V0KGNl
LT5zdGF0ZSkgKwotCQkJCSAgICBjb250ZXh0X3dhX2JiX29mZnNldChjZSksCi0JCQkJICAgIChj
cyAtIHN0YXJ0KSAqIHNpemVvZigqY3MpKTsKKwlyZXR1cm4gbHJjX3BpbihjZSwgY2UtPmVuZ2lu
ZSwgdmFkZHIpOwogfQogCi1zdGF0aWMgdm9pZAotX19leGVjbGlzdHNfdXBkYXRlX3JlZ19zdGF0
ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCi0JCQkgICAgIGNvbnN0IHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCSAgICAgdTMyIGhlYWQpCitzdGF0aWMgaW50IF9f
bHJjX3NldHVwKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJICAgICAgIHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsKLQlzdHJ1Y3QgaW50ZWxfcmluZyAqcmluZyA9IGNlLT5y
aW5nOwotCXUzMiAqcmVncyA9IGNlLT5scmNfcmVnX3N0YXRlOwotCi0JR0VNX0JVR19PTighaW50
ZWxfcmluZ19vZmZzZXRfdmFsaWQocmluZywgaGVhZCkpOwotCUdFTV9CVUdfT04oIWludGVsX3Jp
bmdfb2Zmc2V0X3ZhbGlkKHJpbmcsIHJpbmctPnRhaWwpKTsKLQotCXJlZ3NbQ1RYX1JJTkdfU1RB
UlRdID0gaTkxNV9nZ3R0X29mZnNldChyaW5nLT52bWEpOwotCXJlZ3NbQ1RYX1JJTkdfSEVBRF0g
PSBoZWFkOwotCXJlZ3NbQ1RYX1JJTkdfVEFJTF0gPSByaW5nLT50YWlsOwotCXJlZ3NbQ1RYX1JJ
TkdfQ1RMXSA9IFJJTkdfQ1RMX1NJWkUocmluZy0+c2l6ZSkgfCBSSU5HX1ZBTElEOwotCi0JLyog
UlBDUyAqLwotCWlmIChlbmdpbmUtPmNsYXNzID09IFJFTkRFUl9DTEFTUykgewotCQlyZWdzW0NU
WF9SX1BXUl9DTEtfU1RBVEVdID0KLQkJCWludGVsX3NzZXVfbWFrZV9ycGNzKGVuZ2luZS0+Z3Qs
ICZjZS0+c3NldSk7CisJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IGNlLT5zdGF0
ZS0+b2JqOworCXZvaWQgKnZhZGRyOwogCi0JCWk5MTVfb2FfaW5pdF9yZWdfc3RhdGUoY2UsIGVu
Z2luZSk7CisJdmFkZHIgPSBpOTE1X2dlbV9vYmplY3RfcGluX21hcChvYmosIEk5MTVfTUFQX1dC
KTsKKwlpZiAoSVNfRVJSKHZhZGRyKSkgeworCQlkcm1fZGJnKCZlbmdpbmUtPmk5MTUtPmRybSwg
IkNvdWxkIG5vdCBtYXAgb2JqZWN0IHBhZ2VzIVxuIik7CisJCXJldHVybiBQVFJfRVJSKHZhZGRy
KTsKIAl9CiAKLQlpZiAoY2UtPndhX2JiX3BhZ2UpIHsKLQkJdTMyICooKmZuKShjb25zdCBzdHJ1
Y3QgaW50ZWxfY29udGV4dCAqY2UsIHUzMiAqY3MpOwotCi0JCWZuID0gZ2VuMTJfZW1pdF9pbmRp
cmVjdF9jdHhfeGNzOwotCQlpZiAoY2UtPmVuZ2luZS0+Y2xhc3MgPT0gUkVOREVSX0NMQVNTKQot
CQkJZm4gPSBnZW4xMl9lbWl0X2luZGlyZWN0X2N0eF9yY3M7CisJbHJjX2luaXRfc3RhdGUoY2Us
IGVuZ2luZSwgdmFkZHIpOwogCi0JCS8qIE11dHVhbGx5IGV4Y2x1c2l2ZSB3cnQgdG8gZ2xvYmFs
IGluZGlyZWN0IGJiICovCi0JCUdFTV9CVUdfT04oZW5naW5lLT53YV9jdHguaW5kaXJlY3RfY3R4
LnNpemUpOwotCQlzZXR1cF9pbmRpcmVjdF9jdHhfYmIoY2UsIGVuZ2luZSwgZm4pOwotCX0KKwlf
X2k5MTVfZ2VtX29iamVjdF9mbHVzaF9tYXAob2JqLCAwLCBlbmdpbmUtPmNvbnRleHRfc2l6ZSk7
CisJaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChvYmopOworCXJldHVybiAwOwogfQogCi1zdGF0
aWMgaW50Ci1leGVjbGlzdHNfY29udGV4dF9wcmVfcGluKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpj
ZSwKLQkJCSAgc3RydWN0IGk5MTVfZ2VtX3d3X2N0eCAqd3csIHZvaWQgKip2YWRkcikKK3N0YXRp
YyBpbnQgX19leGVjbGlzdHNfY29udGV4dF9hbGxvYyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2Us
CisJCQkJICAgICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7Ci0JR0VNX0JVR19P
TighY2UtPnN0YXRlKTsKLQlHRU1fQlVHX09OKCFpOTE1X3ZtYV9pc19waW5uZWQoY2UtPnN0YXRl
KSk7Ci0KLQkqdmFkZHIgPSBpOTE1X2dlbV9vYmplY3RfcGluX21hcChjZS0+c3RhdGUtPm9iaiwK
LQkJCQkJaTkxNV9jb2hlcmVudF9tYXBfdHlwZShjZS0+ZW5naW5lLT5pOTE1KSB8Ci0JCQkJCUk5
MTVfTUFQX09WRVJSSURFKTsKKwlpbnQgZXJyOwogCi0JcmV0dXJuIFBUUl9FUlJfT1JfWkVSTygq
dmFkZHIpOwotfQorCWVyciA9IGxyY19hbGxvYyhjZSwgZW5naW5lKTsKKwlpZiAoZXJyKQorCQly
ZXR1cm4gZXJyOwogCi1zdGF0aWMgaW50Ci1fX2V4ZWNsaXN0c19jb250ZXh0X3BpbihzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqY2UsCi0JCQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCi0J
CQl2b2lkICp2YWRkcikKLXsKLQljZS0+bHJjLmxyY2EgPSBscmNfZGVzY3JpcHRvcihjZSwgZW5n
aW5lKSB8IENUWF9ERVNDX0ZPUkNFX1JFU1RPUkU7Ci0JY2UtPmxyY19yZWdfc3RhdGUgPSB2YWRk
ciArIExSQ19TVEFURV9PRkZTRVQ7Ci0JX19leGVjbGlzdHNfdXBkYXRlX3JlZ19zdGF0ZShjZSwg
ZW5naW5lLCBjZS0+cmluZy0+dGFpbCk7CisJZXJyID0gX19scmNfc2V0dXAoY2UsIGVuZ2luZSk7
CisJaWYgKGVycikKKwkJZ290byBlcnJfbHJjOwogCiAJcmV0dXJuIDA7Ci19CiAKLXN0YXRpYyBp
bnQgZXhlY2xpc3RzX2NvbnRleHRfcGluKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgdm9pZCAq
dmFkZHIpCi17Ci0JcmV0dXJuIF9fZXhlY2xpc3RzX2NvbnRleHRfcGluKGNlLCBjZS0+ZW5naW5l
LCB2YWRkcik7CitlcnJfbHJjOgorCWxyY19maW5pKGNlKTsKKwlyZXR1cm4gZXJyOwogfQogCiBz
dGF0aWMgaW50IGV4ZWNsaXN0c19jb250ZXh0X2FsbG9jKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpj
ZSkKQEAgLTM1MzYsMzQgKzI1NTgsMTkgQEAgc3RhdGljIGludCBleGVjbGlzdHNfY29udGV4dF9h
bGxvYyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCiAJcmV0dXJuIF9fZXhlY2xpc3RzX2NvbnRl
eHRfYWxsb2MoY2UsIGNlLT5lbmdpbmUpOwogfQogCi1zdGF0aWMgdm9pZCBleGVjbGlzdHNfY29u
dGV4dF9yZXNldChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCi17Ci0JQ0VfVFJBQ0UoY2UsICJy
ZXNldFxuIik7Ci0JR0VNX0JVR19PTighaW50ZWxfY29udGV4dF9pc19waW5uZWQoY2UpKTsKLQot
CWludGVsX3JpbmdfcmVzZXQoY2UtPnJpbmcsIGNlLT5yaW5nLT5lbWl0KTsKLQotCS8qIFNjcnVi
IGF3YXkgdGhlIGdhcmJhZ2UgKi8KLQlleGVjbGlzdHNfaW5pdF9yZWdfc3RhdGUoY2UtPmxyY19y
ZWdfc3RhdGUsCi0JCQkJIGNlLCBjZS0+ZW5naW5lLCBjZS0+cmluZywgdHJ1ZSk7Ci0JX19leGVj
bGlzdHNfdXBkYXRlX3JlZ19zdGF0ZShjZSwgY2UtPmVuZ2luZSwgY2UtPnJpbmctPnRhaWwpOwot
Ci0JY2UtPmxyYy5kZXNjIHw9IENUWF9ERVNDX0ZPUkNFX1JFU1RPUkU7Ci19Ci0KIHN0YXRpYyBj
b25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dF9vcHMgZXhlY2xpc3RzX2NvbnRleHRfb3BzID0gewog
CS5hbGxvYyA9IGV4ZWNsaXN0c19jb250ZXh0X2FsbG9jLAogCiAJLnByZV9waW4gPSBleGVjbGlz
dHNfY29udGV4dF9wcmVfcGluLAogCS5waW4gPSBleGVjbGlzdHNfY29udGV4dF9waW4sCi0JLnVu
cGluID0gZXhlY2xpc3RzX2NvbnRleHRfdW5waW4sCi0JLnBvc3RfdW5waW4gPSBleGVjbGlzdHNf
Y29udGV4dF9wb3N0X3VucGluLAorCS51bnBpbiA9IGxyY191bnBpbiwKKwkucG9zdF91bnBpbiA9
IGxyY19wb3N0X3VucGluLAogCiAJLmVudGVyID0gaW50ZWxfY29udGV4dF9lbnRlcl9lbmdpbmUs
CiAJLmV4aXQgPSBpbnRlbF9jb250ZXh0X2V4aXRfZW5naW5lLAogCi0JLnJlc2V0ID0gZXhlY2xp
c3RzX2NvbnRleHRfcmVzZXQsCi0JLmRlc3Ryb3kgPSBleGVjbGlzdHNfY29udGV4dF9kZXN0cm95
LAorCS5yZXNldCA9IGxyY19yZXNldCwKKwkuZGVzdHJveSA9IGxyY19kZXN0cm95LAogfTsKIAog
c3RhdGljIGludCBlbWl0X3BkcHMoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCkBAIC0zNjUwLDMz
MCArMjY1Nyw2IEBAIHN0YXRpYyBpbnQgZXhlY2xpc3RzX3JlcXVlc3RfYWxsb2Moc3RydWN0IGk5
MTVfcmVxdWVzdCAqcmVxdWVzdCkKIAlyZXR1cm4gMDsKIH0KIAotLyoKLSAqIEluIHRoaXMgV0Eg
d2UgbmVlZCB0byBzZXQgR0VOOF9MM1NRQ1JFRzRbMjE6MjFdIGFuZCByZXNldCBpdCBhZnRlcgot
ICogUElQRV9DT05UUk9MIGluc3RydWN0aW9uLiBUaGlzIGlzIHJlcXVpcmVkIGZvciB0aGUgZmx1
c2ggdG8gaGFwcGVuIGNvcnJlY3RseQotICogYnV0IHRoZXJlIGlzIGEgc2xpZ2h0IGNvbXBsaWNh
dGlvbiBhcyB0aGlzIGlzIGFwcGxpZWQgaW4gV0EgYmF0Y2ggd2hlcmUgdGhlCi0gKiB2YWx1ZXMg
YXJlIG9ubHkgaW5pdGlhbGl6ZWQgb25jZSBzbyB3ZSBjYW5ub3QgdGFrZSByZWdpc3RlciB2YWx1
ZSBhdCB0aGUKLSAqIGJlZ2lubmluZyBhbmQgcmV1c2UgaXQgZnVydGhlcjsgaGVuY2Ugd2Ugc2F2
ZSBpdHMgdmFsdWUgdG8gbWVtb3J5LCB1cGxvYWQgYQotICogY29uc3RhbnQgdmFsdWUgd2l0aCBi
aXQyMSBzZXQgYW5kIHRoZW4gd2UgcmVzdG9yZSBpdCBiYWNrIHdpdGggdGhlIHNhdmVkIHZhbHVl
LgotICogVG8gc2ltcGxpZnkgdGhlIFdBLCBhIGNvbnN0YW50IHZhbHVlIGlzIGZvcm1lZCBieSB1
c2luZyB0aGUgZGVmYXVsdCB2YWx1ZQotICogb2YgdGhpcyByZWdpc3Rlci4gVGhpcyBzaG91bGRu
J3QgYmUgYSBwcm9ibGVtIGJlY2F1c2Ugd2UgYXJlIG9ubHkgbW9kaWZ5aW5nCi0gKiBpdCBmb3Ig
YSBzaG9ydCBwZXJpb2QgYW5kIHRoaXMgYmF0Y2ggaW4gbm9uLXByZW1wdGlibGUuIFdlIGNhbiBv
ZmNvdXJzZQotICogdXNlIGFkZGl0aW9uYWwgaW5zdHJ1Y3Rpb25zIHRoYXQgcmVhZCB0aGUgYWN0
dWFsIHZhbHVlIG9mIHRoZSByZWdpc3RlcgotICogYXQgdGhhdCB0aW1lIGFuZCBzZXQgb3VyIGJp
dCBvZiBpbnRlcmVzdCBidXQgaXQgbWFrZXMgdGhlIFdBIGNvbXBsaWNhdGVkLgotICoKLSAqIFRo
aXMgV0EgaXMgYWxzbyByZXF1aXJlZCBmb3IgR2VuOSBzbyBleHRyYWN0aW5nIGFzIGEgZnVuY3Rp
b24gYXZvaWRzCi0gKiBjb2RlIGR1cGxpY2F0aW9uLgotICovCi1zdGF0aWMgdTMyICoKLWdlbjhf
ZW1pdF9mbHVzaF9jb2hlcmVudGwzX3dhKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwg
dTMyICpiYXRjaCkKLXsKLQkvKiBOQiBubyBvbmUgZWxzZSBpcyBhbGxvd2VkIHRvIHNjcmliYmxl
IG92ZXIgc2NyYXRjaCArIDI1NiEgKi8KLQkqYmF0Y2grKyA9IE1JX1NUT1JFX1JFR0lTVEVSX01F
TV9HRU44IHwgTUlfU1JNX0xSTV9HTE9CQUxfR1RUOwotCSpiYXRjaCsrID0gaTkxNV9tbWlvX3Jl
Z19vZmZzZXQoR0VOOF9MM1NRQ1JFRzQpOwotCSpiYXRjaCsrID0gaW50ZWxfZ3Rfc2NyYXRjaF9v
ZmZzZXQoZW5naW5lLT5ndCwKLQkJCQkJICAgSU5URUxfR1RfU0NSQVRDSF9GSUVMRF9DT0hFUkVO
VEwzX1dBKTsKLQkqYmF0Y2grKyA9IDA7Ci0KLQkqYmF0Y2grKyA9IE1JX0xPQURfUkVHSVNURVJf
SU1NKDEpOwotCSpiYXRjaCsrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9MM1NRQ1JFRzQp
OwotCSpiYXRjaCsrID0gMHg0MDQwMDAwMCB8IEdFTjhfTFFTQ19GTFVTSF9DT0hFUkVOVF9MSU5F
UzsKLQotCWJhdGNoID0gZ2VuOF9lbWl0X3BpcGVfY29udHJvbChiYXRjaCwKLQkJCQkgICAgICAg
UElQRV9DT05UUk9MX0NTX1NUQUxMIHwKLQkJCQkgICAgICAgUElQRV9DT05UUk9MX0RDX0ZMVVNI
X0VOQUJMRSwKLQkJCQkgICAgICAgMCk7Ci0KLQkqYmF0Y2grKyA9IE1JX0xPQURfUkVHSVNURVJf
TUVNX0dFTjggfCBNSV9TUk1fTFJNX0dMT0JBTF9HVFQ7Ci0JKmJhdGNoKysgPSBpOTE1X21taW9f
cmVnX29mZnNldChHRU44X0wzU1FDUkVHNCk7Ci0JKmJhdGNoKysgPSBpbnRlbF9ndF9zY3JhdGNo
X29mZnNldChlbmdpbmUtPmd0LAotCQkJCQkgICBJTlRFTF9HVF9TQ1JBVENIX0ZJRUxEX0NPSEVS
RU5UTDNfV0EpOwotCSpiYXRjaCsrID0gMDsKLQotCXJldHVybiBiYXRjaDsKLX0KLQotLyoKLSAq
IFR5cGljYWxseSB3ZSBvbmx5IGhhdmUgb25lIGluZGlyZWN0X2N0eCBhbmQgcGVyX2N0eCBiYXRj
aCBidWZmZXIgd2hpY2ggYXJlCi0gKiBpbml0aWFsaXplZCBhdCB0aGUgYmVnaW5uaW5nIGFuZCBz
aGFyZWQgYWNyb3NzIGFsbCBjb250ZXh0cyBidXQgdGhpcyBmaWVsZAotICogaGVscHMgdXMgdG8g
aGF2ZSBtdWx0aXBsZSBiYXRjaGVzIGF0IGRpZmZlcmVudCBvZmZzZXRzIGFuZCBzZWxlY3QgdGhl
bSBiYXNlZAotICogb24gYSBjcml0ZXJpYS4gQXQgdGhlIG1vbWVudCB0aGlzIGJhdGNoIGFsd2F5
cyBzdGFydCBhdCB0aGUgYmVnaW5uaW5nIG9mIHRoZSBwYWdlCi0gKiBhbmQgYXQgdGhpcyBwb2lu
dCB3ZSBkb24ndCBoYXZlIG11bHRpcGxlIHdhX2N0eCBiYXRjaCBidWZmZXJzLgotICoKLSAqIFRo
ZSBudW1iZXIgb2YgV0EgYXBwbGllZCBhcmUgbm90IGtub3duIGF0IHRoZSBiZWdpbm5pbmc7IHdl
IHVzZSB0aGlzIGZpZWxkCi0gKiB0byByZXR1cm4gdGhlIG5vIG9mIERXT1JEUyB3cml0dGVuLgot
ICoKLSAqIEl0IGlzIHRvIGJlIG5vdGVkIHRoYXQgdGhpcyBiYXRjaCBkb2VzIG5vdCBjb250YWlu
IE1JX0JBVENIX0JVRkZFUl9FTkQKLSAqIHNvIGl0IGFkZHMgTk9PUHMgYXMgcGFkZGluZyB0byBt
YWtlIGl0IGNhY2hlbGluZSBhbGlnbmVkLgotICogTUlfQkFUQ0hfQlVGRkVSX0VORCB3aWxsIGJl
IGFkZGVkIHRvIHBlcmN0eCBiYXRjaCBhbmQgYm90aCBvZiB0aGVtIHRvZ2V0aGVyCi0gKiBtYWtl
cyBhIGNvbXBsZXRlIGJhdGNoIGJ1ZmZlci4KLSAqLwotc3RhdGljIHUzMiAqZ2VuOF9pbml0X2lu
ZGlyZWN0Y3R4X2JiKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgdTMyICpiYXRjaCkK
LXsKLQkvKiBXYURpc2FibGVDdHhSZXN0b3JlQXJiaXRyYXRpb246YmR3LGNodiAqLwotCSpiYXRj
aCsrID0gTUlfQVJCX09OX09GRiB8IE1JX0FSQl9ESVNBQkxFOwotCi0JLyogV2FGbHVzaENvaGVy
ZW50TDNDYWNoZUxpbmVzQXRDb250ZXh0U3dpdGNoOmJkdyAqLwotCWlmIChJU19CUk9BRFdFTEwo
ZW5naW5lLT5pOTE1KSkKLQkJYmF0Y2ggPSBnZW44X2VtaXRfZmx1c2hfY29oZXJlbnRsM193YShl
bmdpbmUsIGJhdGNoKTsKLQotCS8qIFdhQ2xlYXJTbG1TcGFjZUF0Q29udGV4dFN3aXRjaDpiZHcs
Y2h2ICovCi0JLyogQWN0dWFsIHNjcmF0Y2ggbG9jYXRpb24gaXMgYXQgMTI4IGJ5dGVzIG9mZnNl
dCAqLwotCWJhdGNoID0gZ2VuOF9lbWl0X3BpcGVfY29udHJvbChiYXRjaCwKLQkJCQkgICAgICAg
UElQRV9DT05UUk9MX0ZMVVNIX0wzIHwKLQkJCQkgICAgICAgUElQRV9DT05UUk9MX1NUT1JFX0RB
VEFfSU5ERVggfAotCQkJCSAgICAgICBQSVBFX0NPTlRST0xfQ1NfU1RBTEwgfAotCQkJCSAgICAg
ICBQSVBFX0NPTlRST0xfUVdfV1JJVEUsCi0JCQkJICAgICAgIExSQ19QUEhXU1BfU0NSQVRDSF9B
RERSKTsKLQotCSpiYXRjaCsrID0gTUlfQVJCX09OX09GRiB8IE1JX0FSQl9FTkFCTEU7Ci0KLQkv
KiBQYWQgdG8gZW5kIG9mIGNhY2hlbGluZSAqLwotCXdoaWxlICgodW5zaWduZWQgbG9uZyliYXRj
aCAlIENBQ0hFTElORV9CWVRFUykKLQkJKmJhdGNoKysgPSBNSV9OT09QOwotCi0JLyoKLQkgKiBN
SV9CQVRDSF9CVUZGRVJfRU5EIGlzIG5vdCByZXF1aXJlZCBpbiBJbmRpcmVjdCBjdHggQkIgYmVj
YXVzZQotCSAqIGV4ZWN1dGlvbiBkZXBlbmRzIG9uIHRoZSBsZW5ndGggc3BlY2lmaWVkIGluIHRl
cm1zIG9mIGNhY2hlIGxpbmVzCi0JICogaW4gdGhlIHJlZ2lzdGVyIENUWF9SQ1NfSU5ESVJFQ1Rf
Q1RYCi0JICovCi0KLQlyZXR1cm4gYmF0Y2g7Ci19Ci0KLXN0cnVjdCBscmkgewotCWk5MTVfcmVn
X3QgcmVnOwotCXUzMiB2YWx1ZTsKLX07Ci0KLXN0YXRpYyB1MzIgKmVtaXRfbHJpKHUzMiAqYmF0
Y2gsIGNvbnN0IHN0cnVjdCBscmkgKmxyaSwgdW5zaWduZWQgaW50IGNvdW50KQotewotCUdFTV9C
VUdfT04oIWNvdW50IHx8IGNvdW50ID4gNjMpOwotCi0JKmJhdGNoKysgPSBNSV9MT0FEX1JFR0lT
VEVSX0lNTShjb3VudCk7Ci0JZG8gewotCQkqYmF0Y2grKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0
KGxyaS0+cmVnKTsKLQkJKmJhdGNoKysgPSBscmktPnZhbHVlOwotCX0gd2hpbGUgKGxyaSsrLCAt
LWNvdW50KTsKLQkqYmF0Y2grKyA9IE1JX05PT1A7Ci0KLQlyZXR1cm4gYmF0Y2g7Ci19Ci0KLXN0
YXRpYyB1MzIgKmdlbjlfaW5pdF9pbmRpcmVjdGN0eF9iYihzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmUsIHUzMiAqYmF0Y2gpCi17Ci0Jc3RhdGljIGNvbnN0IHN0cnVjdCBscmkgbHJpW10g
PSB7Ci0JCS8qIFdhRGlzYWJsZUdhdGhlckF0U2V0U2hhZGVyQ29tbW9uU2xpY2U6c2tsLGJ4dCxr
YmwsZ2xrICovCi0JCXsKLQkJCUNPTU1PTl9TTElDRV9DSElDS0VOMiwKLQkJCV9fTUFTS0VEX0ZJ
RUxEKEdFTjlfRElTQUJMRV9HQVRIRVJfQVRfU0VUX1NIQURFUl9DT01NT05fU0xJQ0UsCi0JCQkJ
ICAgICAgIDApLAotCQl9LAotCi0JCS8qIEJTcGVjOiAxMTM5MSAqLwotCQl7Ci0JCQlGRl9TTElD
RV9DSElDS0VOLAotCQkJX19NQVNLRURfRklFTEQoRkZfU0xJQ0VfQ0hJQ0tFTl9DTF9QUk9WT0tJ
TkdfVkVSVEVYX0ZJWCwKLQkJCQkgICAgICAgRkZfU0xJQ0VfQ0hJQ0tFTl9DTF9QUk9WT0tJTkdf
VkVSVEVYX0ZJWCksCi0JCX0sCi0KLQkJLyogQlNwZWM6IDExMjk5ICovCi0JCXsKLQkJCV8zRF9D
SElDS0VOMywKLQkJCV9fTUFTS0VEX0ZJRUxEKF8zRF9DSElDS0VOX1NGX1BST1ZPS0lOR19WRVJU
RVhfRklYLAotCQkJCSAgICAgICBfM0RfQ0hJQ0tFTl9TRl9QUk9WT0tJTkdfVkVSVEVYX0ZJWCks
Ci0JCX0KLQl9OwotCi0JKmJhdGNoKysgPSBNSV9BUkJfT05fT0ZGIHwgTUlfQVJCX0RJU0FCTEU7
Ci0KLQkvKiBXYUZsdXNoQ29oZXJlbnRMM0NhY2hlTGluZXNBdENvbnRleHRTd2l0Y2g6c2tsLGJ4
dCxnbGsgKi8KLQliYXRjaCA9IGdlbjhfZW1pdF9mbHVzaF9jb2hlcmVudGwzX3dhKGVuZ2luZSwg
YmF0Y2gpOwotCi0JLyogV2FDbGVhclNsbVNwYWNlQXRDb250ZXh0U3dpdGNoOnNrbCxieHQsa2Js
LGdsayxjZmwgKi8KLQliYXRjaCA9IGdlbjhfZW1pdF9waXBlX2NvbnRyb2woYmF0Y2gsCi0JCQkJ
ICAgICAgIFBJUEVfQ09OVFJPTF9GTFVTSF9MMyB8Ci0JCQkJICAgICAgIFBJUEVfQ09OVFJPTF9T
VE9SRV9EQVRBX0lOREVYIHwKLQkJCQkgICAgICAgUElQRV9DT05UUk9MX0NTX1NUQUxMIHwKLQkJ
CQkgICAgICAgUElQRV9DT05UUk9MX1FXX1dSSVRFLAotCQkJCSAgICAgICBMUkNfUFBIV1NQX1ND
UkFUQ0hfQUREUik7Ci0KLQliYXRjaCA9IGVtaXRfbHJpKGJhdGNoLCBscmksIEFSUkFZX1NJWkUo
bHJpKSk7Ci0KLQkvKiBXYU1lZGlhUG9vbFN0YXRlQ21kSW5XQUJCOmJ4dCxnbGsgKi8KLQlpZiAo
SEFTX1BPT0xFRF9FVShlbmdpbmUtPmk5MTUpKSB7Ci0JCS8qCi0JCSAqIEVVIHBvb2wgY29uZmln
dXJhdGlvbiBpcyBzZXR1cCBhbG9uZyB3aXRoIGdvbGRlbiBjb250ZXh0Ci0JCSAqIGR1cmluZyBj
b250ZXh0IGluaXRpYWxpemF0aW9uLiBUaGlzIHZhbHVlIGRlcGVuZHMgb24KLQkJICogZGV2aWNl
IHR5cGUgKDJ4NiBvciAzeDYpIGFuZCBuZWVkcyB0byBiZSB1cGRhdGVkIGJhc2VkCi0JCSAqIG9u
IHdoaWNoIHN1YnNsaWNlIGlzIGRpc2FibGVkIGVzcGVjaWFsbHkgZm9yIDJ4NgotCQkgKiBkZXZp
Y2VzLCBob3dldmVyIGl0IGlzIHNhZmUgdG8gbG9hZCBkZWZhdWx0Ci0JCSAqIGNvbmZpZ3VyYXRp
b24gb2YgM3g2IGRldmljZSBpbnN0ZWFkIG9mIG1hc2tpbmcgb2ZmCi0JCSAqIGNvcnJlc3BvbmRp
bmcgYml0cyBiZWNhdXNlIEhXIGlnbm9yZXMgYml0cyBvZiBhIGRpc2FibGVkCi0JCSAqIHN1YnNs
aWNlIGFuZCBkcm9wcyBkb3duIHRvIGFwcHJvcHJpYXRlIGNvbmZpZy4gUGxlYXNlCi0JCSAqIHNl
ZSByZW5kZXJfc3RhdGVfc2V0dXAoKSBpbiBpOTE1X2dlbV9yZW5kZXJfc3RhdGUuYyBmb3IKLQkJ
ICogcG9zc2libGUgY29uZmlndXJhdGlvbnMsIHRvIGF2b2lkIGR1cGxpY2F0aW9uIHRoZXkgYXJl
Ci0JCSAqIG5vdCBzaG93biBoZXJlIGFnYWluLgotCQkgKi8KLQkJKmJhdGNoKysgPSBHRU45X01F
RElBX1BPT0xfU1RBVEU7Ci0JCSpiYXRjaCsrID0gR0VOOV9NRURJQV9QT09MX0VOQUJMRTsKLQkJ
KmJhdGNoKysgPSAweDAwNzc3MDAwOwotCQkqYmF0Y2grKyA9IDA7Ci0JCSpiYXRjaCsrID0gMDsK
LQkJKmJhdGNoKysgPSAwOwotCX0KLQotCSpiYXRjaCsrID0gTUlfQVJCX09OX09GRiB8IE1JX0FS
Ql9FTkFCTEU7Ci0KLQkvKiBQYWQgdG8gZW5kIG9mIGNhY2hlbGluZSAqLwotCXdoaWxlICgodW5z
aWduZWQgbG9uZyliYXRjaCAlIENBQ0hFTElORV9CWVRFUykKLQkJKmJhdGNoKysgPSBNSV9OT09Q
OwotCi0JcmV0dXJuIGJhdGNoOwotfQotCi1zdGF0aWMgdTMyICoKLWdlbjEwX2luaXRfaW5kaXJl
Y3RjdHhfYmIoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1MzIgKmJhdGNoKQotewot
CWludCBpOwotCi0JLyoKLQkgKiBXYVBpcGVDb250cm9sQmVmb3JlM0RTdGF0ZVNhbXBsZVBhdHRl
cm46IGNubAotCSAqCi0JICogRW5zdXJlIHRoZSBlbmdpbmUgaXMgaWRsZSBwcmlvciB0byBwcm9n
cmFtbWluZyBhCi0JICogM0RTVEFURV9TQU1QTEVfUEFUVEVSTiBkdXJpbmcgYSBjb250ZXh0IHJl
c3RvcmUuCi0JICovCi0JYmF0Y2ggPSBnZW44X2VtaXRfcGlwZV9jb250cm9sKGJhdGNoLAotCQkJ
CSAgICAgICBQSVBFX0NPTlRST0xfQ1NfU1RBTEwsCi0JCQkJICAgICAgIDApOwotCS8qCi0JICog
V2FQaXBlQ29udHJvbEJlZm9yZTNEU3RhdGVTYW1wbGVQYXR0ZXJuIHNheXMgd2UgbmVlZCA0IGR3
b3JkcyBmb3IKLQkgKiB0aGUgUElQRV9DT05UUk9MIGZvbGxvd2VkIGJ5IDEyIGR3b3JkcyBvZiAw
eDAsIHNvIDE2IGR3b3JkcyBpbgotCSAqIHRvdGFsLiBIb3dldmVyLCBhIFBJUEVfQ09OVFJPTCBp
cyA2IGR3b3JkcyBsb25nLCBub3QgNCwgd2hpY2ggaXMKLQkgKiBjb25mdXNpbmcuIFNpbmNlIGdl
bjhfZW1pdF9waXBlX2NvbnRyb2woKSBhbHJlYWR5IGFkdmFuY2VzIHRoZQotCSAqIGJhdGNoIGJ5
IDYgZHdvcmRzLCB3ZSBhZHZhbmNlIHRoZSBvdGhlciAxMCBoZXJlLCBjb21wbGV0aW5nIGEKLQkg
KiBjYWNoZWxpbmUuIEl0J3Mgbm90IGNsZWFyIGlmIHRoZSB3b3JrYXJvdW5kIHJlcXVpcmVzIHRo
aXMgcGFkZGluZwotCSAqIGJlZm9yZSBvdGhlciBjb21tYW5kcywgb3IgaWYgaXQncyBqdXN0IHRo
ZSByZWd1bGFyIHBhZGRpbmcgd2Ugd291bGQKLQkgKiBhbHJlYWR5IGhhdmUgZm9yIHRoZSB3b3Jr
YXJvdW5kIGJiLCBzbyBsZWF2ZSBpdCBoZXJlIGZvciBub3cuCi0JICovCi0JZm9yIChpID0gMDsg
aSA8IDEwOyBpKyspCi0JCSpiYXRjaCsrID0gTUlfTk9PUDsKLQotCS8qIFBhZCB0byBlbmQgb2Yg
Y2FjaGVsaW5lICovCi0Jd2hpbGUgKCh1bnNpZ25lZCBsb25nKWJhdGNoICUgQ0FDSEVMSU5FX0JZ
VEVTKQotCQkqYmF0Y2grKyA9IE1JX05PT1A7Ci0KLQlyZXR1cm4gYmF0Y2g7Ci19Ci0KLSNkZWZp
bmUgQ1RYX1dBX0JCX09CSl9TSVpFIChQQUdFX1NJWkUpCi0KLXN0YXRpYyBpbnQgbHJjX3NldHVw
X3dhX2N0eChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCi17Ci0Jc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3QgKm9iajsKLQlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKLQlpbnQgZXJyOwot
Ci0Jb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zaG1lbShlbmdpbmUtPmk5MTUsIENUWF9X
QV9CQl9PQkpfU0laRSk7Ci0JaWYgKElTX0VSUihvYmopKQotCQlyZXR1cm4gUFRSX0VSUihvYmop
OwotCi0Jdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uob2JqLCAmZW5naW5lLT5ndC0+Z2d0dC0+dm0s
IE5VTEwpOwotCWlmIChJU19FUlIodm1hKSkgewotCQllcnIgPSBQVFJfRVJSKHZtYSk7Ci0JCWdv
dG8gZXJyOwotCX0KLQotCWVyciA9IGk5MTVfZ2d0dF9waW4odm1hLCBOVUxMLCAwLCBQSU5fSElH
SCk7Ci0JaWYgKGVycikKLQkJZ290byBlcnI7Ci0KLQllbmdpbmUtPndhX2N0eC52bWEgPSB2bWE7
Ci0JcmV0dXJuIDA7Ci0KLWVycjoKLQlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7Ci0JcmV0dXJu
IGVycjsKLX0KLQotc3RhdGljIHZvaWQgbHJjX2Rlc3Ryb3lfd2FfY3R4KHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSkKLXsKLQlpOTE1X3ZtYV91bnBpbl9hbmRfcmVsZWFzZSgmZW5naW5l
LT53YV9jdHgudm1hLCAwKTsKLX0KLQotdHlwZWRlZiB1MzIgKigqd2FfYmJfZnVuY190KShzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHUzMiAqYmF0Y2gpOwotCi1zdGF0aWMgaW50IGlu
dGVsX2luaXRfd29ya2Fyb3VuZF9iYihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCi17
Ci0Jc3RydWN0IGk5MTVfY3R4X3dvcmthcm91bmRzICp3YV9jdHggPSAmZW5naW5lLT53YV9jdHg7
Ci0Jc3RydWN0IGk5MTVfd2FfY3R4X2JiICp3YV9iYlsyXSA9IHsgJndhX2N0eC0+aW5kaXJlY3Rf
Y3R4LAotCQkJCQkgICAgJndhX2N0eC0+cGVyX2N0eCB9OwotCXdhX2JiX2Z1bmNfdCB3YV9iYl9m
blsyXTsKLQl2b2lkICpiYXRjaCwgKmJhdGNoX3B0cjsKLQl1bnNpZ25lZCBpbnQgaTsKLQlpbnQg
cmV0OwotCi0JaWYgKGVuZ2luZS0+Y2xhc3MgIT0gUkVOREVSX0NMQVNTKQotCQlyZXR1cm4gMDsK
LQotCXN3aXRjaCAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkpIHsKLQljYXNlIDEyOgotCWNhc2Ug
MTE6Ci0JCXJldHVybiAwOwotCWNhc2UgMTA6Ci0JCXdhX2JiX2ZuWzBdID0gZ2VuMTBfaW5pdF9p
bmRpcmVjdGN0eF9iYjsKLQkJd2FfYmJfZm5bMV0gPSBOVUxMOwotCQlicmVhazsKLQljYXNlIDk6
Ci0JCXdhX2JiX2ZuWzBdID0gZ2VuOV9pbml0X2luZGlyZWN0Y3R4X2JiOwotCQl3YV9iYl9mblsx
XSA9IE5VTEw7Ci0JCWJyZWFrOwotCWNhc2UgODoKLQkJd2FfYmJfZm5bMF0gPSBnZW44X2luaXRf
aW5kaXJlY3RjdHhfYmI7Ci0JCXdhX2JiX2ZuWzFdID0gTlVMTDsKLQkJYnJlYWs7Ci0JZGVmYXVs
dDoKLQkJTUlTU0lOR19DQVNFKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpKTsKLQkJcmV0dXJuIDA7
Ci0JfQotCi0JcmV0ID0gbHJjX3NldHVwX3dhX2N0eChlbmdpbmUpOwotCWlmIChyZXQpIHsKLQkJ
ZHJtX2RiZygmZW5naW5lLT5pOTE1LT5kcm0sCi0JCQkiRmFpbGVkIHRvIHNldHVwIGNvbnRleHQg
V0EgcGFnZTogJWRcbiIsIHJldCk7Ci0JCXJldHVybiByZXQ7Ci0JfQotCi0JYmF0Y2ggPSBpOTE1
X2dlbV9vYmplY3RfcGluX21hcCh3YV9jdHgtPnZtYS0+b2JqLCBJOTE1X01BUF9XQik7Ci0KLQkv
KgotCSAqIEVtaXQgdGhlIHR3byB3b3JrYXJvdW5kIGJhdGNoIGJ1ZmZlcnMsIHJlY29yZGluZyB0
aGUgb2Zmc2V0IGZyb20gdGhlCi0JICogc3RhcnQgb2YgdGhlIHdvcmthcm91bmQgYmF0Y2ggYnVm
ZmVyIG9iamVjdCBmb3IgZWFjaCBhbmQgdGhlaXIKLQkgKiByZXNwZWN0aXZlIHNpemVzLgotCSAq
LwotCWJhdGNoX3B0ciA9IGJhdGNoOwotCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKHdhX2Ji
X2ZuKTsgaSsrKSB7Ci0JCXdhX2JiW2ldLT5vZmZzZXQgPSBiYXRjaF9wdHIgLSBiYXRjaDsKLQkJ
aWYgKEdFTV9ERUJVR19XQVJOX09OKCFJU19BTElHTkVEKHdhX2JiW2ldLT5vZmZzZXQsCi0JCQkJ
CQkgIENBQ0hFTElORV9CWVRFUykpKSB7Ci0JCQlyZXQgPSAtRUlOVkFMOwotCQkJYnJlYWs7Ci0J
CX0KLQkJaWYgKHdhX2JiX2ZuW2ldKQotCQkJYmF0Y2hfcHRyID0gd2FfYmJfZm5baV0oZW5naW5l
LCBiYXRjaF9wdHIpOwotCQl3YV9iYltpXS0+c2l6ZSA9IGJhdGNoX3B0ciAtIChiYXRjaCArIHdh
X2JiW2ldLT5vZmZzZXQpOwotCX0KLQlHRU1fQlVHX09OKGJhdGNoX3B0ciAtIGJhdGNoID4gQ1RY
X1dBX0JCX09CSl9TSVpFKTsKLQotCV9faTkxNV9nZW1fb2JqZWN0X2ZsdXNoX21hcCh3YV9jdHgt
PnZtYS0+b2JqLCAwLCBiYXRjaF9wdHIgLSBiYXRjaCk7Ci0JX19pOTE1X2dlbV9vYmplY3RfcmVs
ZWFzZV9tYXAod2FfY3R4LT52bWEtPm9iaik7Ci0JaWYgKHJldCkKLQkJbHJjX2Rlc3Ryb3lfd2Ff
Y3R4KGVuZ2luZSk7Ci0KLQlyZXR1cm4gcmV0OwotfQotCiBzdGF0aWMgdm9pZCByZXNldF9jc2Jf
cG9pbnRlcnMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewogCXN0cnVjdCBpbnRl
bF9lbmdpbmVfZXhlY2xpc3RzICogY29uc3QgZXhlY2xpc3RzID0gJmVuZ2luZS0+ZXhlY2xpc3Rz
OwpAQCAtNDE4NSwyNSArMjg2OCw2IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19yZXNldF9wcmVw
YXJlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAllbmdpbmUtPmV4ZWNsaXN0cy5y
ZXNldF9jY2lkID0gYWN0aXZlX2NjaWQoZW5naW5lKTsKIH0KIAotc3RhdGljIHZvaWQgX19yZXNl
dF9zdG9wX3JpbmcodTMyICpyZWdzLCBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpCi17Ci0JaW50IHg7Ci0KLQl4ID0gbHJjX3JpbmdfbWlfbW9kZShlbmdpbmUpOwotCWlmICh4
ICE9IC0xKSB7Ci0JCXJlZ3NbeCArIDFdICY9IH5TVE9QX1JJTkc7Ci0JCXJlZ3NbeCArIDFdIHw9
IFNUT1BfUklORyA8PCAxNjsKLQl9Ci19Ci0KLXN0YXRpYyB2b2lkIF9fZXhlY2xpc3RzX3Jlc2V0
X3JlZ19zdGF0ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCi0JCQkJCWNvbnN0IHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKLXsKLQl1MzIgKnJlZ3MgPSBjZS0+bHJjX3Jl
Z19zdGF0ZTsKLQotCV9fcmVzZXRfc3RvcF9yaW5nKHJlZ3MsIGVuZ2luZSk7Ci19Ci0KIHN0YXRp
YyB2b2lkIF9fZXhlY2xpc3RzX3Jlc2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwg
Ym9vbCBzdGFsbGVkKQogewogCXN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3RzICogY29uc3Qg
ZXhlY2xpc3RzID0gJmVuZ2luZS0+ZXhlY2xpc3RzOwpAQCAtNDI4Nyw5ICsyOTUxLDggQEAgc3Rh
dGljIHZvaWQgX19leGVjbGlzdHNfcmVzZXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
LCBib29sIHN0YWxsZWQpCiBvdXRfcmVwbGF5OgogCUVOR0lORV9UUkFDRShlbmdpbmUsICJyZXBs
YXkge2hlYWQ6JTA0eCwgdGFpbDolMDR4fVxuIiwKIAkJICAgICBoZWFkLCBjZS0+cmluZy0+dGFp
bCk7Ci0JX19leGVjbGlzdHNfcmVzZXRfcmVnX3N0YXRlKGNlLCBlbmdpbmUpOwotCV9fZXhlY2xp
c3RzX3VwZGF0ZV9yZWdfc3RhdGUoY2UsIGVuZ2luZSwgaGVhZCk7Ci0JY2UtPmxyYy5kZXNjIHw9
IENUWF9ERVNDX0ZPUkNFX1JFU1RPUkU7IC8qIHBhcmFub2lkOiBHUFUgd2FzIHJlc2V0ISAqLwor
CWxyY19yZXNldF9yZWdzKGNlLCBlbmdpbmUpOworCWNlLT5scmMubHJjYSA9IGxyY191cGRhdGVf
cmVncyhjZSwgZW5naW5lLCBoZWFkKTsKIAogdW53aW5kOgogCS8qIFB1c2ggYmFjayBhbnkgaW5j
b21wbGV0ZSByZXF1ZXN0cyBmb3IgcmVwbGF5IGFmdGVyIHRoZSByZXNldC4gKi8KQEAgLTQ0ODcs
NyArMzE1MCw3IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19yZWxlYXNlKHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSkKIAlleGVjbGlzdHNfc2h1dGRvd24oZW5naW5lKTsKIAogCWludGVs
X2VuZ2luZV9jbGVhbnVwX2NvbW1vbihlbmdpbmUpOwotCWxyY19kZXN0cm95X3dhX2N0eChlbmdp
bmUpOworCWxyY19maW5pX3dhX2N0eChlbmdpbmUpOwogfQogCiBzdGF0aWMgdm9pZApAQCAtNDU4
MSw3ICszMjQ0LDcgQEAgaW50IGludGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uX3NldHVwKHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAlpZiAoZW5naW5lLT5jbGFzcyA9PSBSRU5ERVJf
Q0xBU1MpCiAJCXJjc19zdWJtaXNzaW9uX292ZXJyaWRlKGVuZ2luZSk7CiAKLQlpZiAoaW50ZWxf
aW5pdF93b3JrYXJvdW5kX2JiKGVuZ2luZSkpCisJaWYgKGxyY19pbml0X3dhX2N0eChlbmdpbmUp
KQogCQkvKgogCQkgKiBXZSBjb250aW51ZSBldmVuIGlmIHdlIGZhaWwgdG8gaW5pdGlhbGl6ZSBX
QSBiYXRjaAogCQkgKiBiZWNhdXNlIHdlIG9ubHkgZXhwZWN0IHJhcmUgZ2xpdGNoZXMgYnV0IG5v
dGhpbmcKQEAgLTQ2MjIsMjE4ICszMjg1LDYgQEAgaW50IGludGVsX2V4ZWNsaXN0c19zdWJtaXNz
aW9uX3NldHVwKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIHZvaWQgaW5pdF9jb21tb25fcmVnX3N0YXRlKHUzMiAqIGNvbnN0IHJlZ3MsCi0J
CQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCi0JCQkJICBjb25zdCBz
dHJ1Y3QgaW50ZWxfcmluZyAqcmluZywKLQkJCQkgIGJvb2wgaW5oaWJpdCkKLXsKLQl1MzIgY3Rs
OwotCi0JY3RsID0gX01BU0tFRF9CSVRfRU5BQkxFKENUWF9DVFJMX0lOSElCSVRfU1lOX0NUWF9T
V0lUQ0gpOwotCWN0bCB8PSBfTUFTS0VEX0JJVF9ESVNBQkxFKENUWF9DVFJMX0VOR0lORV9DVFhf
UkVTVE9SRV9JTkhJQklUKTsKLQlpZiAoaW5oaWJpdCkKLQkJY3RsIHw9IENUWF9DVFJMX0VOR0lO
RV9DVFhfUkVTVE9SRV9JTkhJQklUOwotCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA8IDEx
KQotCQljdGwgfD0gX01BU0tFRF9CSVRfRElTQUJMRShDVFhfQ1RSTF9FTkdJTkVfQ1RYX1NBVkVf
SU5ISUJJVCB8Ci0JCQkJCSAgIENUWF9DVFJMX1JTX0NUWF9FTkFCTEUpOwotCXJlZ3NbQ1RYX0NP
TlRFWFRfQ09OVFJPTF0gPSBjdGw7Ci0KLQlyZWdzW0NUWF9SSU5HX0NUTF0gPSBSSU5HX0NUTF9T
SVpFKHJpbmctPnNpemUpIHwgUklOR19WQUxJRDsKLQlyZWdzW0NUWF9USU1FU1RBTVBdID0gMDsK
LX0KLQotc3RhdGljIHZvaWQgaW5pdF93YV9iYl9yZWdfc3RhdGUodTMyICogY29uc3QgcmVncywK
LQkJCQkgY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQotewotCWNvbnN0IHN0
cnVjdCBpOTE1X2N0eF93b3JrYXJvdW5kcyAqIGNvbnN0IHdhX2N0eCA9ICZlbmdpbmUtPndhX2N0
eDsKLQotCWlmICh3YV9jdHgtPnBlcl9jdHguc2l6ZSkgewotCQljb25zdCB1MzIgZ2d0dF9vZmZz
ZXQgPSBpOTE1X2dndHRfb2Zmc2V0KHdhX2N0eC0+dm1hKTsKLQotCQlHRU1fQlVHX09OKGxyY19y
aW5nX3dhX2JiX3Blcl9jdHgoZW5naW5lKSA9PSAtMSk7Ci0JCXJlZ3NbbHJjX3Jpbmdfd2FfYmJf
cGVyX2N0eChlbmdpbmUpICsgMV0gPQotCQkJKGdndHRfb2Zmc2V0ICsgd2FfY3R4LT5wZXJfY3R4
Lm9mZnNldCkgfCAweDAxOwotCX0KLQotCWlmICh3YV9jdHgtPmluZGlyZWN0X2N0eC5zaXplKSB7
Ci0JCWxyY19yaW5nX3NldHVwX2luZGlyZWN0X2N0eChyZWdzLCBlbmdpbmUsCi0JCQkJCSAgICBp
OTE1X2dndHRfb2Zmc2V0KHdhX2N0eC0+dm1hKSArCi0JCQkJCSAgICB3YV9jdHgtPmluZGlyZWN0
X2N0eC5vZmZzZXQsCi0JCQkJCSAgICB3YV9jdHgtPmluZGlyZWN0X2N0eC5zaXplKTsKLQl9Ci19
Ci0KLXN0YXRpYyB2b2lkIGluaXRfcHBndHRfcmVnX3N0YXRlKHUzMiAqcmVncywgY29uc3Qgc3Ry
dWN0IGk5MTVfcHBndHQgKnBwZ3R0KQotewotCWlmIChpOTE1X3ZtX2lzXzRsdmwoJnBwZ3R0LT52
bSkpIHsKLQkJLyogNjRiIFBQR1RUICg0OGJpdCBjYW5vbmljYWwpCi0JCSAqIFBEUDBfREVTQ1JJ
UFRPUiBjb250YWlucyB0aGUgYmFzZSBhZGRyZXNzIHRvIFBNTDQgYW5kCi0JCSAqIG90aGVyIFBE
UCBEZXNjcmlwdG9ycyBhcmUgaWdub3JlZC4KLQkJICovCi0JCUFTU0lHTl9DVFhfUE1MNChwcGd0
dCwgcmVncyk7Ci0JfSBlbHNlIHsKLQkJQVNTSUdOX0NUWF9QRFAocHBndHQsIHJlZ3MsIDMpOwot
CQlBU1NJR05fQ1RYX1BEUChwcGd0dCwgcmVncywgMik7Ci0JCUFTU0lHTl9DVFhfUERQKHBwZ3R0
LCByZWdzLCAxKTsKLQkJQVNTSUdOX0NUWF9QRFAocHBndHQsIHJlZ3MsIDApOwotCX0KLX0KLQot
c3RhdGljIHN0cnVjdCBpOTE1X3BwZ3R0ICp2bV9hbGlhcyhzdHJ1Y3QgaTkxNV9hZGRyZXNzX3Nw
YWNlICp2bSkKLXsKLQlpZiAoaTkxNV9pc19nZ3R0KHZtKSkKLQkJcmV0dXJuIGk5MTVfdm1fdG9f
Z2d0dCh2bSktPmFsaWFzOwotCWVsc2UKLQkJcmV0dXJuIGk5MTVfdm1fdG9fcHBndHQodm0pOwot
fQotCi1zdGF0aWMgdm9pZCBleGVjbGlzdHNfaW5pdF9yZWdfc3RhdGUodTMyICpyZWdzLAotCQkJ
CSAgICAgY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAotCQkJCSAgICAgY29uc3Qgc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAotCQkJCSAgICAgY29uc3Qgc3RydWN0IGludGVs
X3JpbmcgKnJpbmcsCi0JCQkJICAgICBib29sIGluaGliaXQpCi17Ci0JLyoKLQkgKiBBIGNvbnRl
eHQgaXMgYWN0dWFsbHkgYSBiaWcgYmF0Y2ggYnVmZmVyIHdpdGggc2V2ZXJhbAotCSAqIE1JX0xP
QURfUkVHSVNURVJfSU1NIGNvbW1hbmRzIGZvbGxvd2VkIGJ5IChyZWcsIHZhbHVlKSBwYWlycy4g
VGhlCi0JICogdmFsdWVzIHdlIGFyZSBzZXR0aW5nIGhlcmUgYXJlIG9ubHkgZm9yIHRoZSBmaXJz
dCBjb250ZXh0IHJlc3RvcmU6Ci0JICogb24gYSBzdWJzZXF1ZW50IHNhdmUsIHRoZSBHUFUgd2ls
bCByZWNyZWF0ZSB0aGlzIGJhdGNoYnVmZmVyIHdpdGggbmV3Ci0JICogdmFsdWVzIChpbmNsdWRp
bmcgYWxsIHRoZSBtaXNzaW5nIE1JX0xPQURfUkVHSVNURVJfSU1NIGNvbW1hbmRzIHRoYXQKLQkg
KiB3ZSBhcmUgbm90IGluaXRpYWxpemluZyBoZXJlKS4KLQkgKgotCSAqIE11c3Qga2VlcCBjb25z
aXN0ZW50IHdpdGggdmlydHVhbF91cGRhdGVfcmVnaXN0ZXJfb2Zmc2V0cygpLgotCSAqLwotCXNl
dF9vZmZzZXRzKHJlZ3MsIHJlZ19vZmZzZXRzKGVuZ2luZSksIGVuZ2luZSwgaW5oaWJpdCk7Ci0K
LQlpbml0X2NvbW1vbl9yZWdfc3RhdGUocmVncywgZW5naW5lLCByaW5nLCBpbmhpYml0KTsKLQlp
bml0X3BwZ3R0X3JlZ19zdGF0ZShyZWdzLCB2bV9hbGlhcyhjZS0+dm0pKTsKLQotCWluaXRfd2Ff
YmJfcmVnX3N0YXRlKHJlZ3MsIGVuZ2luZSk7Ci0KLQlfX3Jlc2V0X3N0b3BfcmluZyhyZWdzLCBl
bmdpbmUpOwotfQotCi1zdGF0aWMgaW50Ci1wb3B1bGF0ZV9scl9jb250ZXh0KHN0cnVjdCBpbnRl
bF9jb250ZXh0ICpjZSwKLQkJICAgIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpjdHhfb2Jq
LAotCQkgICAgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAotCQkgICAgc3RydWN0IGlu
dGVsX3JpbmcgKnJpbmcpCi17Ci0JYm9vbCBpbmhpYml0ID0gdHJ1ZTsKLQl2b2lkICp2YWRkcjsK
LQotCXZhZGRyID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAoY3R4X29iaiwgSTkxNV9NQVBfV0Ip
OwotCWlmIChJU19FUlIodmFkZHIpKSB7Ci0JCWRybV9kYmcoJmVuZ2luZS0+aTkxNS0+ZHJtLCAi
Q291bGQgbm90IG1hcCBvYmplY3QgcGFnZXMhXG4iKTsKLQkJcmV0dXJuIFBUUl9FUlIodmFkZHIp
OwotCX0KLQotCXNldF9yZWR6b25lKHZhZGRyLCBlbmdpbmUpOwotCi0JaWYgKGVuZ2luZS0+ZGVm
YXVsdF9zdGF0ZSkgewotCQlzaG1lbV9yZWFkKGVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSwgMCwKLQkJ
CSAgIHZhZGRyLCBlbmdpbmUtPmNvbnRleHRfc2l6ZSk7Ci0JCV9fc2V0X2JpdChDT05URVhUX1ZB
TElEX0JJVCwgJmNlLT5mbGFncyk7Ci0JCWluaGliaXQgPSBmYWxzZTsKLQl9Ci0KLQkvKiBDbGVh
ciB0aGUgcHBIV1NQIChpbmMuIHBlci1jb250ZXh0IGNvdW50ZXJzKSAqLwotCW1lbXNldCh2YWRk
ciwgMCwgUEFHRV9TSVpFKTsKLQotCS8qCi0JICogVGhlIHNlY29uZCBwYWdlIG9mIHRoZSBjb250
ZXh0IG9iamVjdCBjb250YWlucyBzb21lIHJlZ2lzdGVycyB3aGljaAotCSAqIG11c3QgYmUgc2V0
IHVwIHByaW9yIHRvIHRoZSBmaXJzdCBleGVjdXRpb24uCi0JICovCi0JZXhlY2xpc3RzX2luaXRf
cmVnX3N0YXRlKHZhZGRyICsgTFJDX1NUQVRFX09GRlNFVCwKLQkJCQkgY2UsIGVuZ2luZSwgcmlu
ZywgaW5oaWJpdCk7Ci0KLQlfX2k5MTVfZ2VtX29iamVjdF9mbHVzaF9tYXAoY3R4X29iaiwgMCwg
ZW5naW5lLT5jb250ZXh0X3NpemUpOwotCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAoY3R4X29i
aik7Ci0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnBpbm5l
ZF90aW1lbGluZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCi17Ci0Jc3RydWN0IGludGVsX3Rp
bWVsaW5lICp0bCA9IGZldGNoX2FuZF96ZXJvKCZjZS0+dGltZWxpbmUpOwotCi0JcmV0dXJuIGlu
dGVsX3RpbWVsaW5lX2NyZWF0ZV9mcm9tX2VuZ2luZShjZS0+ZW5naW5lLAotCQkJCQkJIHBhZ2Vf
dW5tYXNrX2JpdHModGwpKTsKLX0KLQotc3RhdGljIGludCBfX2V4ZWNsaXN0c19jb250ZXh0X2Fs
bG9jKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKLQkJCQkgICAgIHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSkKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqY3R4X29iajsK
LQlzdHJ1Y3QgaW50ZWxfcmluZyAqcmluZzsKLQlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKLQl1MzIg
Y29udGV4dF9zaXplOwotCWludCByZXQ7Ci0KLQlHRU1fQlVHX09OKGNlLT5zdGF0ZSk7Ci0JY29u
dGV4dF9zaXplID0gcm91bmRfdXAoZW5naW5lLT5jb250ZXh0X3NpemUsIEk5MTVfR1RUX1BBR0Vf
U0laRSk7Ci0KLQlpZiAoSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfREVCVUdfR0VNKSkKLQkJ
Y29udGV4dF9zaXplICs9IEk5MTVfR1RUX1BBR0VfU0laRTsgLyogZm9yIHJlZHpvbmUgKi8KLQot
CWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA9PSAxMikgewotCQljZS0+d2FfYmJfcGFnZSA9
IGNvbnRleHRfc2l6ZSAvIFBBR0VfU0laRTsKLQkJY29udGV4dF9zaXplICs9IFBBR0VfU0laRTsK
LQl9Ci0KLQljdHhfb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zaG1lbShlbmdpbmUtPmk5
MTUsIGNvbnRleHRfc2l6ZSk7Ci0JaWYgKElTX0VSUihjdHhfb2JqKSkKLQkJcmV0dXJuIFBUUl9F
UlIoY3R4X29iaik7Ci0KLQl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShjdHhfb2JqLCAmZW5naW5l
LT5ndC0+Z2d0dC0+dm0sIE5VTEwpOwotCWlmIChJU19FUlIodm1hKSkgewotCQlyZXQgPSBQVFJf
RVJSKHZtYSk7Ci0JCWdvdG8gZXJyb3JfZGVyZWZfb2JqOwotCX0KLQotCWlmICghcGFnZV9tYXNr
X2JpdHMoY2UtPnRpbWVsaW5lKSkgewotCQlzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRsOwotCi0J
CS8qCi0JCSAqIFVzZSB0aGUgc3RhdGljIGdsb2JhbCBIV1NQIGZvciB0aGUga2VybmVsIGNvbnRl
eHQsIGFuZAotCQkgKiBhIGR5bmFtaWNhbGx5IGFsbG9jYXRlZCBjYWNoZWxpbmUgZm9yIGV2ZXJ5
b25lIGVsc2UuCi0JCSAqLwotCQlpZiAodW5saWtlbHkoY2UtPnRpbWVsaW5lKSkKLQkJCXRsID0g
cGlubmVkX3RpbWVsaW5lKGNlKTsKLQkJZWxzZQotCQkJdGwgPSBpbnRlbF90aW1lbGluZV9jcmVh
dGUoZW5naW5lLT5ndCk7Ci0JCWlmIChJU19FUlIodGwpKSB7Ci0JCQlyZXQgPSBQVFJfRVJSKHRs
KTsKLQkJCWdvdG8gZXJyb3JfZGVyZWZfb2JqOwotCQl9Ci0KLQkJY2UtPnRpbWVsaW5lID0gdGw7
Ci0JfQotCi0JcmluZyA9IGludGVsX2VuZ2luZV9jcmVhdGVfcmluZyhlbmdpbmUsICh1bnNpZ25l
ZCBsb25nKWNlLT5yaW5nKTsKLQlpZiAoSVNfRVJSKHJpbmcpKSB7Ci0JCXJldCA9IFBUUl9FUlIo
cmluZyk7Ci0JCWdvdG8gZXJyb3JfZGVyZWZfb2JqOwotCX0KLQotCXJldCA9IHBvcHVsYXRlX2xy
X2NvbnRleHQoY2UsIGN0eF9vYmosIGVuZ2luZSwgcmluZyk7Ci0JaWYgKHJldCkgewotCQlkcm1f
ZGJnKCZlbmdpbmUtPmk5MTUtPmRybSwKLQkJCSJGYWlsZWQgdG8gcG9wdWxhdGUgTFJDOiAlZFxu
IiwgcmV0KTsKLQkJZ290byBlcnJvcl9yaW5nX2ZyZWU7Ci0JfQotCi0JY2UtPnJpbmcgPSByaW5n
OwotCWNlLT5zdGF0ZSA9IHZtYTsKLQotCXJldHVybiAwOwotCi1lcnJvcl9yaW5nX2ZyZWU6Ci0J
aW50ZWxfcmluZ19wdXQocmluZyk7Ci1lcnJvcl9kZXJlZl9vYmo6Ci0JaTkxNV9nZW1fb2JqZWN0
X3B1dChjdHhfb2JqKTsKLQlyZXR1cm4gcmV0OwotfQotCiBzdGF0aWMgc3RydWN0IGxpc3RfaGVh
ZCAqdmlydHVhbF9xdWV1ZShzdHJ1Y3QgdmlydHVhbF9lbmdpbmUgKnZlKQogewogCXJldHVybiAm
dmUtPmJhc2UuZXhlY2xpc3RzLmRlZmF1bHRfcHJpb2xpc3QucmVxdWVzdHNbMF07CkBAIC00ODkx
LDggKzMzNDIsNyBAQCBzdGF0aWMgdm9pZCByY3VfdmlydHVhbF9jb250ZXh0X2Rlc3Ryb3koc3Ry
dWN0IHdvcmtfc3RydWN0ICp3cmspCiAJR0VNX0JVR19PTihfX3Rhc2tsZXRfaXNfc2NoZWR1bGVk
KCZ2ZS0+YmFzZS5leGVjbGlzdHMudGFza2xldCkpOwogCUdFTV9CVUdfT04oIWxpc3RfZW1wdHko
dmlydHVhbF9xdWV1ZSh2ZSkpKTsKIAotCWlmICh2ZS0+Y29udGV4dC5zdGF0ZSkKLQkJX19leGVj
bGlzdHNfY29udGV4dF9maW5pKCZ2ZS0+Y29udGV4dCk7CisJbHJjX2ZpbmkoJnZlLT5jb250ZXh0
KTsKIAlpbnRlbF9jb250ZXh0X2ZpbmkoJnZlLT5jb250ZXh0KTsKIAogCWludGVsX2JyZWFkY3J1
bWJzX2ZyZWUodmUtPmJhc2UuYnJlYWRjcnVtYnMpOwpAQCAtNDk1MiwxMiArMzQwMiwyMSBAQCBz
dGF0aWMgaW50IHZpcnR1YWxfY29udGV4dF9hbGxvYyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2Up
CiAJcmV0dXJuIF9fZXhlY2xpc3RzX2NvbnRleHRfYWxsb2MoY2UsIHZlLT5zaWJsaW5nc1swXSk7
CiB9CiAKLXN0YXRpYyBpbnQgdmlydHVhbF9jb250ZXh0X3BpbihzdHJ1Y3QgaW50ZWxfY29udGV4
dCAqY2UsIHZvaWQgKnZhZGRyKQorc3RhdGljIGludCB2aXJ0dWFsX2NvbnRleHRfcHJlX3Bpbihz
dHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCisJCQkJICAgICBzdHJ1Y3QgaTkxNV9nZW1fd3dfY3R4
ICp3dywKKwkJCQkgICAgIHZvaWQgKip2YWRkcikKIHsKIAlzdHJ1Y3QgdmlydHVhbF9lbmdpbmUg
KnZlID0gY29udGFpbmVyX29mKGNlLCB0eXBlb2YoKnZlKSwgY29udGV4dCk7CiAKIAkvKiBOb3Rl
OiB3ZSBtdXN0IHVzZSBhIHJlYWwgZW5naW5lIGNsYXNzIGZvciBzZXR0aW5nIHVwIHJlZyBzdGF0
ZSAqLwotCXJldHVybiBfX2V4ZWNsaXN0c19jb250ZXh0X3BpbihjZSwgdmUtPnNpYmxpbmdzWzBd
LCB2YWRkcik7CisJcmV0dXJuIGxyY19wcmVfcGluKGNlLCB2ZS0+c2libGluZ3NbMF0sIHd3LCB2
YWRkcik7Cit9CisKK3N0YXRpYyBpbnQgdmlydHVhbF9jb250ZXh0X3BpbihzdHJ1Y3QgaW50ZWxf
Y29udGV4dCAqY2UsIHZvaWQgKnZhZGRyKQoreworCXN0cnVjdCB2aXJ0dWFsX2VuZ2luZSAqdmUg
PSBjb250YWluZXJfb2YoY2UsIHR5cGVvZigqdmUpLCBjb250ZXh0KTsKKworCXJldHVybiBscmNf
cGluKGNlLCB2ZS0+c2libGluZ3NbMF0sIHZhZGRyKTsKIH0KIAogc3RhdGljIHZvaWQgdmlydHVh
bF9jb250ZXh0X2VudGVyKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKQEAgLTQ5ODUsMTAgKzM0
NDQsMTAgQEAgc3RhdGljIHZvaWQgdmlydHVhbF9jb250ZXh0X2V4aXQoc3RydWN0IGludGVsX2Nv
bnRleHQgKmNlKQogc3RhdGljIGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0X29wcyB2aXJ0dWFs
X2NvbnRleHRfb3BzID0gewogCS5hbGxvYyA9IHZpcnR1YWxfY29udGV4dF9hbGxvYywKIAotCS5w
cmVfcGluID0gZXhlY2xpc3RzX2NvbnRleHRfcHJlX3BpbiwKKwkucHJlX3BpbiA9IHZpcnR1YWxf
Y29udGV4dF9wcmVfcGluLAogCS5waW4gPSB2aXJ0dWFsX2NvbnRleHRfcGluLAotCS51bnBpbiA9
IGV4ZWNsaXN0c19jb250ZXh0X3VucGluLAotCS5wb3N0X3VucGluID0gZXhlY2xpc3RzX2NvbnRl
eHRfcG9zdF91bnBpbiwKKwkudW5waW4gPSBscmNfdW5waW4sCisJLnBvc3RfdW5waW4gPSBscmNf
cG9zdF91bnBpbiwKIAogCS5lbnRlciA9IHZpcnR1YWxfY29udGV4dF9lbnRlciwKIAkuZXhpdCA9
IHZpcnR1YWxfY29udGV4dF9leGl0LApAQCAtNTQ3MCwyOCArMzkyOSw2IEBAIHZvaWQgaW50ZWxf
ZXhlY2xpc3RzX3Nob3dfcmVxdWVzdHMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAog
CXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmVuZ2luZS0+YWN0aXZlLmxvY2ssIGZsYWdzKTsKIH0K
IAotdm9pZCBpbnRlbF9scl9jb250ZXh0X3Jlc2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSwKLQkJCSAgICBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCi0JCQkgICAgdTMyIGhlYWQs
Ci0JCQkgICAgYm9vbCBzY3J1YikKLXsKLQlHRU1fQlVHX09OKCFpbnRlbF9jb250ZXh0X2lzX3Bp
bm5lZChjZSkpOwotCi0JLyoKLQkgKiBXZSB3YW50IGEgc2ltcGxlIGNvbnRleHQgKyByaW5nIHRv
IGV4ZWN1dGUgdGhlIGJyZWFkY3J1bWIgdXBkYXRlLgotCSAqIFdlIGNhbm5vdCByZWx5IG9uIHRo
ZSBjb250ZXh0IGJlaW5nIGludGFjdCBhY3Jvc3MgdGhlIEdQVSBoYW5nLAotCSAqIHNvIGNsZWFy
IGl0IGFuZCByZWJ1aWxkIGp1c3Qgd2hhdCB3ZSBuZWVkIGZvciB0aGUgYnJlYWRjcnVtYi4KLQkg
KiBBbGwgcGVuZGluZyByZXF1ZXN0cyBmb3IgdGhpcyBjb250ZXh0IHdpbGwgYmUgemFwcGVkLCBh
bmQgYW55Ci0JICogZnV0dXJlIHJlcXVlc3Qgd2lsbCBiZSBhZnRlciB1c2Vyc3BhY2UgaGFzIGhh
ZCB0aGUgb3Bwb3J0dW5pdHkKLQkgKiB0byByZWNyZWF0ZSBpdHMgb3duIHN0YXRlLgotCSAqLwot
CWlmIChzY3J1YikKLQkJcmVzdG9yZV9kZWZhdWx0X3N0YXRlKGNlLCBlbmdpbmUpOwotCi0JLyog
UmVydW4gdGhlIHJlcXVlc3Q7IGl0cyBwYXlsb2FkIGhhcyBiZWVuIG5ldXRlcmVkIChpZiBndWls
dHkpLiAqLwotCV9fZXhlY2xpc3RzX3VwZGF0ZV9yZWdfc3RhdGUoY2UsIGVuZ2luZSwgaGVhZCk7
Ci19Ci0KIGJvb2wKIGludGVsX2VuZ2luZV9pbl9leGVjbGlzdHNfc3VibWlzc2lvbl9tb2RlKGNv
bnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uLmggYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9leGVjbGlzdHNfc3VibWlzc2lvbi5oCmluZGV4IDJjOWQ3
MzU0YjQyZi4uMGM2NzViYmZmMzUxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9leGVjbGlzdHNfc3VibWlzc2lvbi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uLmgKQEAgLTIyLDI1ICsyMiw4IEBAIGVudW0g
ewogCiBpbnQgaW50ZWxfZXhlY2xpc3RzX3N1Ym1pc3Npb25fc2V0dXAoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKTsKIAotLyogTG9naWNhbCBSaW5nIENvbnRleHRzICovCi0vKiBBdCB0
aGUgc3RhcnQgb2YgdGhlIGNvbnRleHQgaW1hZ2UgaXMgaXRzIHBlci1wcm9jZXNzIEhXUyBwYWdl
ICovCi0jZGVmaW5lIExSQ19QUEhXU1BfUE4JKDApCi0jZGVmaW5lIExSQ19QUEhXU1BfU1oJKDEp
Ci0vKiBBZnRlciB0aGUgUFBIV1NQIHdlIGhhdmUgdGhlIGxvZ2ljYWwgc3RhdGUgZm9yIHRoZSBj
b250ZXh0ICovCi0jZGVmaW5lIExSQ19TVEFURV9QTgkoTFJDX1BQSFdTUF9QTiArIExSQ19QUEhX
U1BfU1opCi0jZGVmaW5lIExSQ19TVEFURV9PRkZTRVQgKExSQ19TVEFURV9QTiAqIFBBR0VfU0la
RSkKLQotLyogU3BhY2Ugd2l0aGluIFBQSFdTUCByZXNlcnZlZCB0byBiZSB1c2VkIGFzIHNjcmF0
Y2ggKi8KLSNkZWZpbmUgTFJDX1BQSFdTUF9TQ1JBVENICQkweDM0Ci0jZGVmaW5lIExSQ19QUEhX
U1BfU0NSQVRDSF9BRERSCQkoTFJDX1BQSFdTUF9TQ1JBVENIICogc2l6ZW9mKHUzMikpCi0KIHZv
aWQgaW50ZWxfZXhlY2xpc3RzX3NldF9kZWZhdWx0X3N1Ym1pc3Npb24oc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKTsKIAotdm9pZCBpbnRlbF9scl9jb250ZXh0X3Jlc2V0KHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCSAgICBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2Us
Ci0JCQkgICAgdTMyIGhlYWQsCi0JCQkgICAgYm9vbCBzY3J1Yik7Ci0KIHZvaWQgaW50ZWxfZXhl
Y2xpc3RzX3Nob3dfcmVxdWVzdHMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAogCQkJ
CSAgIHN0cnVjdCBkcm1fcHJpbnRlciAqbSwKIAkJCQkgICB2b2lkICgqc2hvd19yZXF1ZXN0KShz
dHJ1Y3QgZHJtX3ByaW50ZXIgKm0sCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9scmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCm5ldyBm
aWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uZjE4OGY1MWE0ZGYyCi0tLSAvZGV2
L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKQEAgLTAsMCAr
MSwxNTc5IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCisvKgorICogQ29weXJp
Z2h0IMKpIDIwMTQgSW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisjaW5jbHVkZSAiZ2VuOF9lbmdp
bmVfY3MuaCIKKyNpbmNsdWRlICJpOTE1X2Rydi5oIgorI2luY2x1ZGUgImk5MTVfcGVyZi5oIgor
I2luY2x1ZGUgImludGVsX2VuZ2luZS5oIgorI2luY2x1ZGUgImludGVsX2dwdV9jb21tYW5kcy5o
IgorI2luY2x1ZGUgImludGVsX2d0LmgiCisjaW5jbHVkZSAiaW50ZWxfbHJjLmgiCisjaW5jbHVk
ZSAiaW50ZWxfbHJjX3JlZy5oIgorI2luY2x1ZGUgImludGVsX3JpbmcuaCIKKyNpbmNsdWRlICJz
aG1lbV91dGlscy5oIgorCitzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGludCBkd29yZF9pbl9wYWdl
KHZvaWQgKmFkZHIpCit7CisJcmV0dXJuIG9mZnNldF9pbl9wYWdlKGFkZHIpIC8gc2l6ZW9mKHUz
Mik7Cit9CisKK3N0YXRpYyB2b2lkIHNldF9vZmZzZXRzKHUzMiAqcmVncywKKwkJCWNvbnN0IHU4
ICpkYXRhLAorCQkJY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAorCQkJYm9v
bCBjbGVhcikKKyNkZWZpbmUgTk9QKHgpIChCSVQoNykgfCAoeCkpCisjZGVmaW5lIExSSShjb3Vu
dCwgZmxhZ3MpICgoZmxhZ3MpIDw8IDYgfCAoY291bnQpIHwgQlVJTERfQlVHX09OX1pFUk8oY291
bnQgPj0gQklUKDYpKSkKKyNkZWZpbmUgUE9TVEVEIEJJVCgwKQorI2RlZmluZSBSRUcoeCkgKCgo
eCkgPj4gMikgfCBCVUlMRF9CVUdfT05fWkVSTyh4ID49IDB4MjAwKSkKKyNkZWZpbmUgUkVHMTYo
eCkgXAorCSgoKHgpID4+IDkpIHwgQklUKDcpIHwgQlVJTERfQlVHX09OX1pFUk8oeCA+PSAweDEw
MDAwKSksIFwKKwkoKCh4KSA+PiAyKSAmIDB4N2YpCisjZGVmaW5lIEVORCh0b3RhbF9zdGF0ZV9z
aXplKSAwLCAodG90YWxfc3RhdGVfc2l6ZSkKK3sKKwljb25zdCB1MzIgYmFzZSA9IGVuZ2luZS0+
bW1pb19iYXNlOworCisJd2hpbGUgKCpkYXRhKSB7CisJCXU4IGNvdW50LCBmbGFnczsKKworCQlp
ZiAoKmRhdGEgJiBCSVQoNykpIHsgLyogc2tpcCAqLworCQkJY291bnQgPSAqZGF0YSsrICYgfkJJ
VCg3KTsKKwkJCWlmIChjbGVhcikKKwkJCQltZW1zZXQzMihyZWdzLCBNSV9OT09QLCBjb3VudCk7
CisJCQlyZWdzICs9IGNvdW50OworCQkJY29udGludWU7CisJCX0KKworCQljb3VudCA9ICpkYXRh
ICYgMHgzZjsKKwkJZmxhZ3MgPSAqZGF0YSA+PiA2OworCQlkYXRhKys7CisKKwkJKnJlZ3MgPSBN
SV9MT0FEX1JFR0lTVEVSX0lNTShjb3VudCk7CisJCWlmIChmbGFncyAmIFBPU1RFRCkKKwkJCSpy
ZWdzIHw9IE1JX0xSSV9GT1JDRV9QT1NURUQ7CisJCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1
KSA+PSAxMSkKKwkJCSpyZWdzIHw9IE1JX0xSSV9MUk1fQ1NfTU1JTzsKKwkJcmVncysrOworCisJ
CUdFTV9CVUdfT04oIWNvdW50KTsKKwkJZG8geworCQkJdTMyIG9mZnNldCA9IDA7CisJCQl1OCB2
OworCisJCQlkbyB7CisJCQkJdiA9ICpkYXRhKys7CisJCQkJb2Zmc2V0IDw8PSA3OworCQkJCW9m
ZnNldCB8PSB2ICYgfkJJVCg3KTsKKwkJCX0gd2hpbGUgKHYgJiBCSVQoNykpOworCisJCQlyZWdz
WzBdID0gYmFzZSArIChvZmZzZXQgPDwgMik7CisJCQlpZiAoY2xlYXIpCisJCQkJcmVnc1sxXSA9
IDA7CisJCQlyZWdzICs9IDI7CisJCX0gd2hpbGUgKC0tY291bnQpOworCX0KKworCWlmIChjbGVh
cikgeworCQl1OCBjb3VudCA9ICorK2RhdGE7CisKKwkJLyogQ2xlYXIgcGFzdCB0aGUgdGFpbCBm
b3IgSFcgYWNjZXNzICovCisJCUdFTV9CVUdfT04oZHdvcmRfaW5fcGFnZShyZWdzKSA+IGNvdW50
KTsKKwkJbWVtc2V0MzIocmVncywgTUlfTk9PUCwgY291bnQgLSBkd29yZF9pbl9wYWdlKHJlZ3Mp
KTsKKworCQkvKiBDbG9zZSB0aGUgYmF0Y2g7IHVzZWQgbWFpbmx5IGJ5IGxpdmVfbHJjX2xheW91
dCgpICovCisJCSpyZWdzID0gTUlfQkFUQ0hfQlVGRkVSX0VORDsKKwkJaWYgKElOVEVMX0dFTihl
bmdpbmUtPmk5MTUpID49IDEwKQorCQkJKnJlZ3MgfD0gQklUKDApOworCX0KK30KKworc3RhdGlj
IGNvbnN0IHU4IGdlbjhfeGNzX29mZnNldHNbXSA9IHsKKwlOT1AoMSksCisJTFJJKDExLCAwKSwK
KwlSRUcxNigweDI0NCksCisJUkVHKDB4MDM0KSwKKwlSRUcoMHgwMzApLAorCVJFRygweDAzOCks
CisJUkVHKDB4MDNjKSwKKwlSRUcoMHgxNjgpLAorCVJFRygweDE0MCksCisJUkVHKDB4MTEwKSwK
KwlSRUcoMHgxMWMpLAorCVJFRygweDExNCksCisJUkVHKDB4MTE4KSwKKworCU5PUCg5KSwKKwlM
UkkoOSwgMCksCisJUkVHMTYoMHgzYTgpLAorCVJFRzE2KDB4MjhjKSwKKwlSRUcxNigweDI4OCks
CisJUkVHMTYoMHgyODQpLAorCVJFRzE2KDB4MjgwKSwKKwlSRUcxNigweDI3YyksCisJUkVHMTYo
MHgyNzgpLAorCVJFRzE2KDB4Mjc0KSwKKwlSRUcxNigweDI3MCksCisKKwlOT1AoMTMpLAorCUxS
SSgyLCAwKSwKKwlSRUcxNigweDIwMCksCisJUkVHKDB4MDI4KSwKKworCUVORCg4MCkKK307CisK
K3N0YXRpYyBjb25zdCB1OCBnZW45X3hjc19vZmZzZXRzW10gPSB7CisJTk9QKDEpLAorCUxSSSgx
NCwgUE9TVEVEKSwKKwlSRUcxNigweDI0NCksCisJUkVHKDB4MDM0KSwKKwlSRUcoMHgwMzApLAor
CVJFRygweDAzOCksCisJUkVHKDB4MDNjKSwKKwlSRUcoMHgxNjgpLAorCVJFRygweDE0MCksCisJ
UkVHKDB4MTEwKSwKKwlSRUcoMHgxMWMpLAorCVJFRygweDExNCksCisJUkVHKDB4MTE4KSwKKwlS
RUcoMHgxYzApLAorCVJFRygweDFjNCksCisJUkVHKDB4MWM4KSwKKworCU5PUCgzKSwKKwlMUkko
OSwgUE9TVEVEKSwKKwlSRUcxNigweDNhOCksCisJUkVHMTYoMHgyOGMpLAorCVJFRzE2KDB4Mjg4
KSwKKwlSRUcxNigweDI4NCksCisJUkVHMTYoMHgyODApLAorCVJFRzE2KDB4MjdjKSwKKwlSRUcx
NigweDI3OCksCisJUkVHMTYoMHgyNzQpLAorCVJFRzE2KDB4MjcwKSwKKworCU5PUCgxMyksCisJ
TFJJKDEsIFBPU1RFRCksCisJUkVHMTYoMHgyMDApLAorCisJTk9QKDEzKSwKKwlMUkkoNDQsIFBP
U1RFRCksCisJUkVHKDB4MDI4KSwKKwlSRUcoMHgwOWMpLAorCVJFRygweDBjMCksCisJUkVHKDB4
MTc4KSwKKwlSRUcoMHgxN2MpLAorCVJFRzE2KDB4MzU4KSwKKwlSRUcoMHgxNzApLAorCVJFRygw
eDE1MCksCisJUkVHKDB4MTU0KSwKKwlSRUcoMHgxNTgpLAorCVJFRzE2KDB4NDFjKSwKKwlSRUcx
NigweDYwMCksCisJUkVHMTYoMHg2MDQpLAorCVJFRzE2KDB4NjA4KSwKKwlSRUcxNigweDYwYyks
CisJUkVHMTYoMHg2MTApLAorCVJFRzE2KDB4NjE0KSwKKwlSRUcxNigweDYxOCksCisJUkVHMTYo
MHg2MWMpLAorCVJFRzE2KDB4NjIwKSwKKwlSRUcxNigweDYyNCksCisJUkVHMTYoMHg2MjgpLAor
CVJFRzE2KDB4NjJjKSwKKwlSRUcxNigweDYzMCksCisJUkVHMTYoMHg2MzQpLAorCVJFRzE2KDB4
NjM4KSwKKwlSRUcxNigweDYzYyksCisJUkVHMTYoMHg2NDApLAorCVJFRzE2KDB4NjQ0KSwKKwlS
RUcxNigweDY0OCksCisJUkVHMTYoMHg2NGMpLAorCVJFRzE2KDB4NjUwKSwKKwlSRUcxNigweDY1
NCksCisJUkVHMTYoMHg2NTgpLAorCVJFRzE2KDB4NjVjKSwKKwlSRUcxNigweDY2MCksCisJUkVH
MTYoMHg2NjQpLAorCVJFRzE2KDB4NjY4KSwKKwlSRUcxNigweDY2YyksCisJUkVHMTYoMHg2NzAp
LAorCVJFRzE2KDB4Njc0KSwKKwlSRUcxNigweDY3OCksCisJUkVHMTYoMHg2N2MpLAorCVJFRygw
eDA2OCksCisKKwlFTkQoMTc2KQorfTsKKworc3RhdGljIGNvbnN0IHU4IGdlbjEyX3hjc19vZmZz
ZXRzW10gPSB7CisJTk9QKDEpLAorCUxSSSgxMywgUE9TVEVEKSwKKwlSRUcxNigweDI0NCksCisJ
UkVHKDB4MDM0KSwKKwlSRUcoMHgwMzApLAorCVJFRygweDAzOCksCisJUkVHKDB4MDNjKSwKKwlS
RUcoMHgxNjgpLAorCVJFRygweDE0MCksCisJUkVHKDB4MTEwKSwKKwlSRUcoMHgxYzApLAorCVJF
RygweDFjNCksCisJUkVHKDB4MWM4KSwKKwlSRUcoMHgxODApLAorCVJFRzE2KDB4MmI0KSwKKwor
CU5PUCg1KSwKKwlMUkkoOSwgUE9TVEVEKSwKKwlSRUcxNigweDNhOCksCisJUkVHMTYoMHgyOGMp
LAorCVJFRzE2KDB4Mjg4KSwKKwlSRUcxNigweDI4NCksCisJUkVHMTYoMHgyODApLAorCVJFRzE2
KDB4MjdjKSwKKwlSRUcxNigweDI3OCksCisJUkVHMTYoMHgyNzQpLAorCVJFRzE2KDB4MjcwKSwK
KworCUVORCg4MCkKK307CisKK3N0YXRpYyBjb25zdCB1OCBnZW44X3Jjc19vZmZzZXRzW10gPSB7
CisJTk9QKDEpLAorCUxSSSgxNCwgUE9TVEVEKSwKKwlSRUcxNigweDI0NCksCisJUkVHKDB4MDM0
KSwKKwlSRUcoMHgwMzApLAorCVJFRygweDAzOCksCisJUkVHKDB4MDNjKSwKKwlSRUcoMHgxNjgp
LAorCVJFRygweDE0MCksCisJUkVHKDB4MTEwKSwKKwlSRUcoMHgxMWMpLAorCVJFRygweDExNCks
CisJUkVHKDB4MTE4KSwKKwlSRUcoMHgxYzApLAorCVJFRygweDFjNCksCisJUkVHKDB4MWM4KSwK
KworCU5PUCgzKSwKKwlMUkkoOSwgUE9TVEVEKSwKKwlSRUcxNigweDNhOCksCisJUkVHMTYoMHgy
OGMpLAorCVJFRzE2KDB4Mjg4KSwKKwlSRUcxNigweDI4NCksCisJUkVHMTYoMHgyODApLAorCVJF
RzE2KDB4MjdjKSwKKwlSRUcxNigweDI3OCksCisJUkVHMTYoMHgyNzQpLAorCVJFRzE2KDB4Mjcw
KSwKKworCU5PUCgxMyksCisJTFJJKDEsIDApLAorCVJFRygweDBjOCksCisKKwlFTkQoODApCit9
OworCitzdGF0aWMgY29uc3QgdTggZ2VuOV9yY3Nfb2Zmc2V0c1tdID0geworCU5PUCgxKSwKKwlM
UkkoMTQsIFBPU1RFRCksCisJUkVHMTYoMHgyNDQpLAorCVJFRygweDM0KSwKKwlSRUcoMHgzMCks
CisJUkVHKDB4MzgpLAorCVJFRygweDNjKSwKKwlSRUcoMHgxNjgpLAorCVJFRygweDE0MCksCisJ
UkVHKDB4MTEwKSwKKwlSRUcoMHgxMWMpLAorCVJFRygweDExNCksCisJUkVHKDB4MTE4KSwKKwlS
RUcoMHgxYzApLAorCVJFRygweDFjNCksCisJUkVHKDB4MWM4KSwKKworCU5PUCgzKSwKKwlMUkko
OSwgUE9TVEVEKSwKKwlSRUcxNigweDNhOCksCisJUkVHMTYoMHgyOGMpLAorCVJFRzE2KDB4Mjg4
KSwKKwlSRUcxNigweDI4NCksCisJUkVHMTYoMHgyODApLAorCVJFRzE2KDB4MjdjKSwKKwlSRUcx
NigweDI3OCksCisJUkVHMTYoMHgyNzQpLAorCVJFRzE2KDB4MjcwKSwKKworCU5PUCgxMyksCisJ
TFJJKDEsIDApLAorCVJFRygweGM4KSwKKworCU5PUCgxMyksCisJTFJJKDQ0LCBQT1NURUQpLAor
CVJFRygweDI4KSwKKwlSRUcoMHg5YyksCisJUkVHKDB4YzApLAorCVJFRygweDE3OCksCisJUkVH
KDB4MTdjKSwKKwlSRUcxNigweDM1OCksCisJUkVHKDB4MTcwKSwKKwlSRUcoMHgxNTApLAorCVJF
RygweDE1NCksCisJUkVHKDB4MTU4KSwKKwlSRUcxNigweDQxYyksCisJUkVHMTYoMHg2MDApLAor
CVJFRzE2KDB4NjA0KSwKKwlSRUcxNigweDYwOCksCisJUkVHMTYoMHg2MGMpLAorCVJFRzE2KDB4
NjEwKSwKKwlSRUcxNigweDYxNCksCisJUkVHMTYoMHg2MTgpLAorCVJFRzE2KDB4NjFjKSwKKwlS
RUcxNigweDYyMCksCisJUkVHMTYoMHg2MjQpLAorCVJFRzE2KDB4NjI4KSwKKwlSRUcxNigweDYy
YyksCisJUkVHMTYoMHg2MzApLAorCVJFRzE2KDB4NjM0KSwKKwlSRUcxNigweDYzOCksCisJUkVH
MTYoMHg2M2MpLAorCVJFRzE2KDB4NjQwKSwKKwlSRUcxNigweDY0NCksCisJUkVHMTYoMHg2NDgp
LAorCVJFRzE2KDB4NjRjKSwKKwlSRUcxNigweDY1MCksCisJUkVHMTYoMHg2NTQpLAorCVJFRzE2
KDB4NjU4KSwKKwlSRUcxNigweDY1YyksCisJUkVHMTYoMHg2NjApLAorCVJFRzE2KDB4NjY0KSwK
KwlSRUcxNigweDY2OCksCisJUkVHMTYoMHg2NmMpLAorCVJFRzE2KDB4NjcwKSwKKwlSRUcxNigw
eDY3NCksCisJUkVHMTYoMHg2NzgpLAorCVJFRzE2KDB4NjdjKSwKKwlSRUcoMHg2OCksCisKKwlF
TkQoMTc2KQorfTsKKworc3RhdGljIGNvbnN0IHU4IGdlbjExX3Jjc19vZmZzZXRzW10gPSB7CisJ
Tk9QKDEpLAorCUxSSSgxNSwgUE9TVEVEKSwKKwlSRUcxNigweDI0NCksCisJUkVHKDB4MDM0KSwK
KwlSRUcoMHgwMzApLAorCVJFRygweDAzOCksCisJUkVHKDB4MDNjKSwKKwlSRUcoMHgxNjgpLAor
CVJFRygweDE0MCksCisJUkVHKDB4MTEwKSwKKwlSRUcoMHgxMWMpLAorCVJFRygweDExNCksCisJ
UkVHKDB4MTE4KSwKKwlSRUcoMHgxYzApLAorCVJFRygweDFjNCksCisJUkVHKDB4MWM4KSwKKwlS
RUcoMHgxODApLAorCisJTk9QKDEpLAorCUxSSSg5LCBQT1NURUQpLAorCVJFRzE2KDB4M2E4KSwK
KwlSRUcxNigweDI4YyksCisJUkVHMTYoMHgyODgpLAorCVJFRzE2KDB4Mjg0KSwKKwlSRUcxNigw
eDI4MCksCisJUkVHMTYoMHgyN2MpLAorCVJFRzE2KDB4Mjc4KSwKKwlSRUcxNigweDI3NCksCisJ
UkVHMTYoMHgyNzApLAorCisJTFJJKDEsIFBPU1RFRCksCisJUkVHKDB4MWIwKSwKKworCU5PUCgx
MCksCisJTFJJKDEsIDApLAorCVJFRygweDBjOCksCisKKwlFTkQoODApCit9OworCitzdGF0aWMg
Y29uc3QgdTggZ2VuMTJfcmNzX29mZnNldHNbXSA9IHsKKwlOT1AoMSksCisJTFJJKDEzLCBQT1NU
RUQpLAorCVJFRzE2KDB4MjQ0KSwKKwlSRUcoMHgwMzQpLAorCVJFRygweDAzMCksCisJUkVHKDB4
MDM4KSwKKwlSRUcoMHgwM2MpLAorCVJFRygweDE2OCksCisJUkVHKDB4MTQwKSwKKwlSRUcoMHgx
MTApLAorCVJFRygweDFjMCksCisJUkVHKDB4MWM0KSwKKwlSRUcoMHgxYzgpLAorCVJFRygweDE4
MCksCisJUkVHMTYoMHgyYjQpLAorCisJTk9QKDUpLAorCUxSSSg5LCBQT1NURUQpLAorCVJFRzE2
KDB4M2E4KSwKKwlSRUcxNigweDI4YyksCisJUkVHMTYoMHgyODgpLAorCVJFRzE2KDB4Mjg0KSwK
KwlSRUcxNigweDI4MCksCisJUkVHMTYoMHgyN2MpLAorCVJFRzE2KDB4Mjc4KSwKKwlSRUcxNigw
eDI3NCksCisJUkVHMTYoMHgyNzApLAorCisJTFJJKDMsIFBPU1RFRCksCisJUkVHKDB4MWIwKSwK
KwlSRUcxNigweDVhOCksCisJUkVHMTYoMHg1YWMpLAorCisJTk9QKDYpLAorCUxSSSgxLCAwKSwK
KwlSRUcoMHgwYzgpLAorCU5PUCgzICsgOSArIDEpLAorCisJTFJJKDUxLCBQT1NURUQpLAorCVJF
RzE2KDB4NTg4KSwKKwlSRUcxNigweDU4OCksCisJUkVHMTYoMHg1ODgpLAorCVJFRzE2KDB4NTg4
KSwKKwlSRUcxNigweDU4OCksCisJUkVHMTYoMHg1ODgpLAorCVJFRygweDAyOCksCisJUkVHKDB4
MDljKSwKKwlSRUcoMHgwYzApLAorCVJFRygweDE3OCksCisJUkVHKDB4MTdjKSwKKwlSRUcxNigw
eDM1OCksCisJUkVHKDB4MTcwKSwKKwlSRUcoMHgxNTApLAorCVJFRygweDE1NCksCisJUkVHKDB4
MTU4KSwKKwlSRUcxNigweDQxYyksCisJUkVHMTYoMHg2MDApLAorCVJFRzE2KDB4NjA0KSwKKwlS
RUcxNigweDYwOCksCisJUkVHMTYoMHg2MGMpLAorCVJFRzE2KDB4NjEwKSwKKwlSRUcxNigweDYx
NCksCisJUkVHMTYoMHg2MTgpLAorCVJFRzE2KDB4NjFjKSwKKwlSRUcxNigweDYyMCksCisJUkVH
MTYoMHg2MjQpLAorCVJFRzE2KDB4NjI4KSwKKwlSRUcxNigweDYyYyksCisJUkVHMTYoMHg2MzAp
LAorCVJFRzE2KDB4NjM0KSwKKwlSRUcxNigweDYzOCksCisJUkVHMTYoMHg2M2MpLAorCVJFRzE2
KDB4NjQwKSwKKwlSRUcxNigweDY0NCksCisJUkVHMTYoMHg2NDgpLAorCVJFRzE2KDB4NjRjKSwK
KwlSRUcxNigweDY1MCksCisJUkVHMTYoMHg2NTQpLAorCVJFRzE2KDB4NjU4KSwKKwlSRUcxNigw
eDY1YyksCisJUkVHMTYoMHg2NjApLAorCVJFRzE2KDB4NjY0KSwKKwlSRUcxNigweDY2OCksCisJ
UkVHMTYoMHg2NmMpLAorCVJFRzE2KDB4NjcwKSwKKwlSRUcxNigweDY3NCksCisJUkVHMTYoMHg2
NzgpLAorCVJFRzE2KDB4NjdjKSwKKwlSRUcoMHgwNjgpLAorCVJFRygweDA4NCksCisJTk9QKDEp
LAorCisJRU5EKDE5MikKK307CisKKyN1bmRlZiBFTkQKKyN1bmRlZiBSRUcxNgorI3VuZGVmIFJF
RworI3VuZGVmIExSSQorI3VuZGVmIE5PUAorCitzdGF0aWMgY29uc3QgdTggKnJlZ19vZmZzZXRz
KGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwkvKgorCSAqIFRoZSBn
ZW4xMisgbGlzdHMgb25seSBoYXZlIHRoZSByZWdpc3RlcnMgd2UgcHJvZ3JhbSBpbiB0aGUgYmFz
aWMKKwkgKiBkZWZhdWx0IHN0YXRlLiBXZSByZWx5IG9uIHRoZSBjb250ZXh0IGltYWdlIHVzaW5n
IHJlbGF0aXZlCisJICogYWRkcmVzc2luZyB0byBhdXRvbWF0aWMgZml4dXAgdGhlIHJlZ2lzdGVy
IHN0YXRlIGJldHdlZW4gdGhlCisJICogcGh5c2ljYWwgZW5naW5lcyBmb3IgdmlydHVhbCBlbmdp
bmUuCisJICovCisJR0VNX0JVR19PTihJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMiAmJgor
CQkgICAhaW50ZWxfZW5naW5lX2hhc19yZWxhdGl2ZV9tbWlvKGVuZ2luZSkpOworCisJaWYgKGVu
Z2luZS0+Y2xhc3MgPT0gUkVOREVSX0NMQVNTKSB7CisJCWlmIChJTlRFTF9HRU4oZW5naW5lLT5p
OTE1KSA+PSAxMikKKwkJCXJldHVybiBnZW4xMl9yY3Nfb2Zmc2V0czsKKwkJZWxzZSBpZiAoSU5U
RUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTEpCisJCQlyZXR1cm4gZ2VuMTFfcmNzX29mZnNldHM7
CisJCWVsc2UgaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDkpCisJCQlyZXR1cm4gZ2Vu
OV9yY3Nfb2Zmc2V0czsKKwkJZWxzZQorCQkJcmV0dXJuIGdlbjhfcmNzX29mZnNldHM7CisJfSBl
bHNlIHsKKwkJaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDEyKQorCQkJcmV0dXJuIGdl
bjEyX3hjc19vZmZzZXRzOworCQllbHNlIGlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSA5
KQorCQkJcmV0dXJuIGdlbjlfeGNzX29mZnNldHM7CisJCWVsc2UKKwkJCXJldHVybiBnZW44X3hj
c19vZmZzZXRzOworCX0KK30KKworc3RhdGljIGludCBscmNfcmluZ19taV9tb2RlKGNvbnN0IHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlpZiAoSU5URUxfR0VOKGVuZ2luZS0+
aTkxNSkgPj0gMTIpCisJCXJldHVybiAweDYwOworCWVsc2UgaWYgKElOVEVMX0dFTihlbmdpbmUt
Pmk5MTUpID49IDkpCisJCXJldHVybiAweDU0OworCWVsc2UgaWYgKGVuZ2luZS0+Y2xhc3MgPT0g
UkVOREVSX0NMQVNTKQorCQlyZXR1cm4gMHg1ODsKKwllbHNlCisJCXJldHVybiAtMTsKK30KKwor
c3RhdGljIGludCBscmNfcmluZ19ncHIwKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSkKK3sKKwlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTIpCisJCXJldHVybiAw
eDc0OworCWVsc2UgaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDkpCisJCXJldHVybiAw
eDY4OworCWVsc2UgaWYgKGVuZ2luZS0+Y2xhc3MgPT0gUkVOREVSX0NMQVNTKQorCQlyZXR1cm4g
MHhkODsKKwllbHNlCisJCXJldHVybiAtMTsKK30KKworc3RhdGljIGludCBscmNfcmluZ193YV9i
Yl9wZXJfY3R4KGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlpZiAo
SU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTIpCisJCXJldHVybiAweDEyOworCWVsc2UgaWYg
KElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDkgfHwgZW5naW5lLT5jbGFzcyA9PSBSRU5ERVJf
Q0xBU1MpCisJCXJldHVybiAweDE4OworCWVsc2UKKwkJcmV0dXJuIC0xOworfQorCitzdGF0aWMg
aW50IGxyY19yaW5nX2luZGlyZWN0X3B0cihjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUpCit7CisJaW50IHg7CisKKwl4ID0gbHJjX3Jpbmdfd2FfYmJfcGVyX2N0eChlbmdpbmUp
OworCWlmICh4IDwgMCkKKwkJcmV0dXJuIHg7CisKKwlyZXR1cm4geCArIDI7Cit9CisKK3N0YXRp
YyBpbnQgbHJjX3JpbmdfaW5kaXJlY3Rfb2Zmc2V0KGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSkKK3sKKwlpbnQgeDsKKworCXggPSBscmNfcmluZ19pbmRpcmVjdF9wdHIoZW5n
aW5lKTsKKwlpZiAoeCA8IDApCisJCXJldHVybiB4OworCisJcmV0dXJuIHggKyAyOworfQorCitz
dGF0aWMgaW50IGxyY19yaW5nX2NtZF9idWZfY2N0bChjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUpCit7CisJaWYgKGVuZ2luZS0+Y2xhc3MgIT0gUkVOREVSX0NMQVNTKQorCQly
ZXR1cm4gLTE7CisKKwlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTIpCisJCXJldHVy
biAweGI2OworCWVsc2UgaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDExKQorCQlyZXR1
cm4gMHhhYTsKKwllbHNlCisJCXJldHVybiAtMTsKK30KKworc3RhdGljIHUzMgorbHJjX3Jpbmdf
aW5kaXJlY3Rfb2Zmc2V0X2RlZmF1bHQoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lKQoreworCXN3aXRjaCAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkpIHsKKwlkZWZhdWx0Ogor
CQlNSVNTSU5HX0NBU0UoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkpOworCQlmYWxsdGhyb3VnaDsK
KwljYXNlIDEyOgorCQlyZXR1cm4gR0VOMTJfQ1RYX1JDU19JTkRJUkVDVF9DVFhfT0ZGU0VUX0RF
RkFVTFQ7CisJY2FzZSAxMToKKwkJcmV0dXJuIEdFTjExX0NUWF9SQ1NfSU5ESVJFQ1RfQ1RYX09G
RlNFVF9ERUZBVUxUOworCWNhc2UgMTA6CisJCXJldHVybiBHRU4xMF9DVFhfUkNTX0lORElSRUNU
X0NUWF9PRkZTRVRfREVGQVVMVDsKKwljYXNlIDk6CisJCXJldHVybiBHRU45X0NUWF9SQ1NfSU5E
SVJFQ1RfQ1RYX09GRlNFVF9ERUZBVUxUOworCWNhc2UgODoKKwkJcmV0dXJuIEdFTjhfQ1RYX1JD
U19JTkRJUkVDVF9DVFhfT0ZGU0VUX0RFRkFVTFQ7CisJfQorfQorCitzdGF0aWMgdm9pZAorbHJj
X3NldHVwX2luZGlyZWN0X2N0eCh1MzIgKnJlZ3MsCisJCSAgICAgICBjb25zdCBzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUsCisJCSAgICAgICB1MzIgY3R4X2JiX2dndHRfYWRkciwKKwkJ
ICAgICAgIHUzMiBzaXplKQoreworCUdFTV9CVUdfT04oIXNpemUpOworCUdFTV9CVUdfT04oIUlT
X0FMSUdORUQoc2l6ZSwgQ0FDSEVMSU5FX0JZVEVTKSk7CisJR0VNX0JVR19PTihscmNfcmluZ19p
bmRpcmVjdF9wdHIoZW5naW5lKSA9PSAtMSk7CisJcmVnc1tscmNfcmluZ19pbmRpcmVjdF9wdHIo
ZW5naW5lKSArIDFdID0KKwkJY3R4X2JiX2dndHRfYWRkciB8IChzaXplIC8gQ0FDSEVMSU5FX0JZ
VEVTKTsKKworCUdFTV9CVUdfT04obHJjX3JpbmdfaW5kaXJlY3Rfb2Zmc2V0KGVuZ2luZSkgPT0g
LTEpOworCXJlZ3NbbHJjX3JpbmdfaW5kaXJlY3Rfb2Zmc2V0KGVuZ2luZSkgKyAxXSA9CisJCWxy
Y19yaW5nX2luZGlyZWN0X29mZnNldF9kZWZhdWx0KGVuZ2luZSkgPDwgNjsKK30KKworc3RhdGlj
IHZvaWQgaW5pdF9jb21tb25fcmVncyh1MzIgKiBjb25zdCByZWdzLAorCQkJICAgICBjb25zdCBz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCisJCQkgICAgIGNvbnN0IHN0cnVjdCBpbnRl
bF9yaW5nICpyaW5nLAorCQkJICAgICBib29sIGluaGliaXQpCit7CisJdTMyIGN0bDsKKworCWN0
bCA9IF9NQVNLRURfQklUX0VOQUJMRShDVFhfQ1RSTF9JTkhJQklUX1NZTl9DVFhfU1dJVENIKTsK
KwljdGwgfD0gX01BU0tFRF9CSVRfRElTQUJMRShDVFhfQ1RSTF9FTkdJTkVfQ1RYX1JFU1RPUkVf
SU5ISUJJVCk7CisJaWYgKGluaGliaXQpCisJCWN0bCB8PSBDVFhfQ1RSTF9FTkdJTkVfQ1RYX1JF
U1RPUkVfSU5ISUJJVDsKKwlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPCAxMSkKKwkJY3Rs
IHw9IF9NQVNLRURfQklUX0RJU0FCTEUoQ1RYX0NUUkxfRU5HSU5FX0NUWF9TQVZFX0lOSElCSVQg
fAorCQkJCQkgICBDVFhfQ1RSTF9SU19DVFhfRU5BQkxFKTsKKwlyZWdzW0NUWF9DT05URVhUX0NP
TlRST0xdID0gY3RsOworCisJcmVnc1tDVFhfUklOR19DVExdID0gUklOR19DVExfU0laRShyaW5n
LT5zaXplKSB8IFJJTkdfVkFMSUQ7CisJcmVnc1tDVFhfVElNRVNUQU1QXSA9IDA7Cit9CisKK3N0
YXRpYyB2b2lkIGluaXRfd2FfYmJfcmVncyh1MzIgKiBjb25zdCByZWdzLAorCQkJICAgIGNvbnN0
IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwljb25zdCBzdHJ1Y3QgaTkxNV9j
dHhfd29ya2Fyb3VuZHMgKiBjb25zdCB3YV9jdHggPSAmZW5naW5lLT53YV9jdHg7CisKKwlpZiAo
d2FfY3R4LT5wZXJfY3R4LnNpemUpIHsKKwkJY29uc3QgdTMyIGdndHRfb2Zmc2V0ID0gaTkxNV9n
Z3R0X29mZnNldCh3YV9jdHgtPnZtYSk7CisKKwkJR0VNX0JVR19PTihscmNfcmluZ193YV9iYl9w
ZXJfY3R4KGVuZ2luZSkgPT0gLTEpOworCQlyZWdzW2xyY19yaW5nX3dhX2JiX3Blcl9jdHgoZW5n
aW5lKSArIDFdID0KKwkJCShnZ3R0X29mZnNldCArIHdhX2N0eC0+cGVyX2N0eC5vZmZzZXQpIHwg
MHgwMTsKKwl9CisKKwlpZiAod2FfY3R4LT5pbmRpcmVjdF9jdHguc2l6ZSkgeworCQlscmNfc2V0
dXBfaW5kaXJlY3RfY3R4KHJlZ3MsIGVuZ2luZSwKKwkJCQkgICAgICAgaTkxNV9nZ3R0X29mZnNl
dCh3YV9jdHgtPnZtYSkgKworCQkJCSAgICAgICB3YV9jdHgtPmluZGlyZWN0X2N0eC5vZmZzZXQs
CisJCQkJICAgICAgIHdhX2N0eC0+aW5kaXJlY3RfY3R4LnNpemUpOworCX0KK30KKworc3RhdGlj
IHZvaWQgaW5pdF9wcGd0dF9yZWdzKHUzMiAqcmVncywgY29uc3Qgc3RydWN0IGk5MTVfcHBndHQg
KnBwZ3R0KQoreworCWlmIChpOTE1X3ZtX2lzXzRsdmwoJnBwZ3R0LT52bSkpIHsKKwkJLyogNjRi
IFBQR1RUICg0OGJpdCBjYW5vbmljYWwpCisJCSAqIFBEUDBfREVTQ1JJUFRPUiBjb250YWlucyB0
aGUgYmFzZSBhZGRyZXNzIHRvIFBNTDQgYW5kCisJCSAqIG90aGVyIFBEUCBEZXNjcmlwdG9ycyBh
cmUgaWdub3JlZC4KKwkJICovCisJCUFTU0lHTl9DVFhfUE1MNChwcGd0dCwgcmVncyk7CisJfSBl
bHNlIHsKKwkJQVNTSUdOX0NUWF9QRFAocHBndHQsIHJlZ3MsIDMpOworCQlBU1NJR05fQ1RYX1BE
UChwcGd0dCwgcmVncywgMik7CisJCUFTU0lHTl9DVFhfUERQKHBwZ3R0LCByZWdzLCAxKTsKKwkJ
QVNTSUdOX0NUWF9QRFAocHBndHQsIHJlZ3MsIDApOworCX0KK30KKworc3RhdGljIHN0cnVjdCBp
OTE1X3BwZ3R0ICp2bV9hbGlhcyhzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSkKK3sKKwlp
ZiAoaTkxNV9pc19nZ3R0KHZtKSkKKwkJcmV0dXJuIGk5MTVfdm1fdG9fZ2d0dCh2bSktPmFsaWFz
OworCWVsc2UKKwkJcmV0dXJuIGk5MTVfdm1fdG9fcHBndHQodm0pOworfQorCitzdGF0aWMgdm9p
ZCBfX3Jlc2V0X3N0b3BfcmluZyh1MzIgKnJlZ3MsIGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSkKK3sKKwlpbnQgeDsKKworCXggPSBscmNfcmluZ19taV9tb2RlKGVuZ2luZSk7
CisJaWYgKHggIT0gLTEpIHsKKwkJcmVnc1t4ICsgMV0gJj0gflNUT1BfUklORzsKKwkJcmVnc1t4
ICsgMV0gfD0gU1RPUF9SSU5HIDw8IDE2OworCX0KK30KKworc3RhdGljIHZvaWQgX19scmNfaW5p
dF9yZWdzKHUzMiAqcmVncywKKwkJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2Us
CisJCQkgICAgY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAorCQkJICAgIGJv
b2wgaW5oaWJpdCkKK3sKKwkvKgorCSAqIEEgY29udGV4dCBpcyBhY3R1YWxseSBhIGJpZyBiYXRj
aCBidWZmZXIgd2l0aCBzZXZlcmFsCisJICogTUlfTE9BRF9SRUdJU1RFUl9JTU0gY29tbWFuZHMg
Zm9sbG93ZWQgYnkgKHJlZywgdmFsdWUpIHBhaXJzLiBUaGUKKwkgKiB2YWx1ZXMgd2UgYXJlIHNl
dHRpbmcgaGVyZSBhcmUgb25seSBmb3IgdGhlIGZpcnN0IGNvbnRleHQgcmVzdG9yZToKKwkgKiBv
biBhIHN1YnNlcXVlbnQgc2F2ZSwgdGhlIEdQVSB3aWxsIHJlY3JlYXRlIHRoaXMgYmF0Y2hidWZm
ZXIgd2l0aCBuZXcKKwkgKiB2YWx1ZXMgKGluY2x1ZGluZyBhbGwgdGhlIG1pc3NpbmcgTUlfTE9B
RF9SRUdJU1RFUl9JTU0gY29tbWFuZHMgdGhhdAorCSAqIHdlIGFyZSBub3QgaW5pdGlhbGl6aW5n
IGhlcmUpLgorCSAqCisJICogTXVzdCBrZWVwIGNvbnNpc3RlbnQgd2l0aCB2aXJ0dWFsX3VwZGF0
ZV9yZWdpc3Rlcl9vZmZzZXRzKCkuCisJICovCisJc2V0X29mZnNldHMocmVncywgcmVnX29mZnNl
dHMoZW5naW5lKSwgZW5naW5lLCBpbmhpYml0KTsKKworCWluaXRfY29tbW9uX3JlZ3MocmVncywg
ZW5naW5lLCBjZS0+cmluZywgaW5oaWJpdCk7CisJaW5pdF9wcGd0dF9yZWdzKHJlZ3MsIHZtX2Fs
aWFzKGNlLT52bSkpOworCisJaW5pdF93YV9iYl9yZWdzKHJlZ3MsIGVuZ2luZSk7CisKKwlfX3Jl
c2V0X3N0b3BfcmluZyhyZWdzLCBlbmdpbmUpOworfQorCit2b2lkIGxyY19pbml0X3JlZ3MoY29u
c3Qgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAorCQkgICBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmUsCisJCSAgIGJvb2wgaW5oaWJpdCkKK3sKKwlfX2xyY19pbml0X3JlZ3Mo
Y2UtPmxyY19yZWdfc3RhdGUsIGNlLCBlbmdpbmUsIGluaGliaXQpOworfQorCit2b2lkIGxyY19y
ZXNldF9yZWdzKGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJICAgIGNvbnN0IHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlfX3Jlc2V0X3N0b3BfcmluZyhjZS0+
bHJjX3JlZ19zdGF0ZSwgZW5naW5lKTsKK30KKwordm9pZCBscmNfcmVzdG9yZV9kZWZhdWx0cyhz
dHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCisJCQkgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSkKK3sKKwl1MzIgKnJlZ3M7CisKKwlyZWdzID0gbWVtc2V0KGNlLT5scmNfcmVnX3N0YXRl
LCAwLCBlbmdpbmUtPmNvbnRleHRfc2l6ZSAtIFBBR0VfU0laRSk7CisJX19scmNfaW5pdF9yZWdz
KHJlZ3MsIGNlLCBlbmdpbmUsIHRydWUpOworCisJY2UtPnJ1bnRpbWUubGFzdCA9IGxyY19nZXRf
cnVudGltZShjZSk7Cit9CisKK3N0YXRpYyB2b2lkCitzZXRfcmVkem9uZSh2b2lkICp2YWRkciwg
Y29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCWlmICghSVNfRU5BQkxF
RChDT05GSUdfRFJNX0k5MTVfREVCVUdfR0VNKSkKKwkJcmV0dXJuOworCisJdmFkZHIgKz0gZW5n
aW5lLT5jb250ZXh0X3NpemU7CisKKwltZW1zZXQodmFkZHIsIENPTlRFWFRfUkVEWk9ORSwgSTkx
NV9HVFRfUEFHRV9TSVpFKTsKK30KKworc3RhdGljIHZvaWQKK2NoZWNrX3JlZHpvbmUoY29uc3Qg
dm9pZCAqdmFkZHIsIGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlp
ZiAoIUlTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X0RFQlVHX0dFTSkpCisJCXJldHVybjsKKwor
CXZhZGRyICs9IGVuZ2luZS0+Y29udGV4dF9zaXplOworCisJaWYgKG1lbWNocl9pbnYodmFkZHIs
IENPTlRFWFRfUkVEWk9ORSwgSTkxNV9HVFRfUEFHRV9TSVpFKSkKKwkJZHJtX2Vycl9vbmNlKCZl
bmdpbmUtPmk5MTUtPmRybSwKKwkJCSAgICAgIiVzIGNvbnRleHQgcmVkem9uZSBvdmVyd3JpdHRl
biFcbiIsCisJCQkgICAgIGVuZ2luZS0+bmFtZSk7Cit9CisKK3ZvaWQgbHJjX2luaXRfc3RhdGUo
c3RydWN0IGludGVsX2NvbnRleHQgKmNlLAorCQkgICAgc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lLAorCQkgICAgdm9pZCAqc3RhdGUpCit7CisJYm9vbCBpbmhpYml0ID0gdHJ1ZTsKKwor
CXNldF9yZWR6b25lKHN0YXRlLCBlbmdpbmUpOworCisJaWYgKGVuZ2luZS0+ZGVmYXVsdF9zdGF0
ZSkgeworCQlzaG1lbV9yZWFkKGVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSwgMCwKKwkJCSAgIHN0YXRl
LCBlbmdpbmUtPmNvbnRleHRfc2l6ZSk7CisJCV9fc2V0X2JpdChDT05URVhUX1ZBTElEX0JJVCwg
JmNlLT5mbGFncyk7CisJCWluaGliaXQgPSBmYWxzZTsKKwl9CisKKwkvKiBDbGVhciB0aGUgcHBI
V1NQIChpbmMuIHBlci1jb250ZXh0IGNvdW50ZXJzKSAqLworCW1lbXNldChzdGF0ZSwgMCwgUEFH
RV9TSVpFKTsKKworCS8qCisJICogVGhlIHNlY29uZCBwYWdlIG9mIHRoZSBjb250ZXh0IG9iamVj
dCBjb250YWlucyBzb21lIHJlZ2lzdGVycyB3aGljaAorCSAqIG11c3QgYmUgc2V0IHVwIHByaW9y
IHRvIHRoZSBmaXJzdCBleGVjdXRpb24uCisJICovCisJX19scmNfaW5pdF9yZWdzKHN0YXRlICsg
TFJDX1NUQVRFX09GRlNFVCwgY2UsIGVuZ2luZSwgaW5oaWJpdCk7Cit9CisKK3N0YXRpYyBzdHJ1
Y3QgaTkxNV92bWEgKgorX19scmNfYWxsb2Nfc3RhdGUoc3RydWN0IGludGVsX2NvbnRleHQgKmNl
LCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKm9iajsKKwlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKKwl1MzIgY29udGV4dF9zaXpl
OworCisJY29udGV4dF9zaXplID0gcm91bmRfdXAoZW5naW5lLT5jb250ZXh0X3NpemUsIEk5MTVf
R1RUX1BBR0VfU0laRSk7CisKKwlpZiAoSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfREVCVUdf
R0VNKSkKKwkJY29udGV4dF9zaXplICs9IEk5MTVfR1RUX1BBR0VfU0laRTsgLyogZm9yIHJlZHpv
bmUgKi8KKworCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA9PSAxMikgeworCQljZS0+d2Ff
YmJfcGFnZSA9IGNvbnRleHRfc2l6ZSAvIFBBR0VfU0laRTsKKwkJY29udGV4dF9zaXplICs9IFBB
R0VfU0laRTsKKwl9CisKKwlvYmogPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3NobWVtKGVuZ2lu
ZS0+aTkxNSwgY29udGV4dF9zaXplKTsKKwlpZiAoSVNfRVJSKG9iaikpCisJCXJldHVybiBFUlJf
Q0FTVChvYmopOworCisJdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uob2JqLCAmZW5naW5lLT5ndC0+
Z2d0dC0+dm0sIE5VTEwpOworCWlmIChJU19FUlIodm1hKSkgeworCQlpOTE1X2dlbV9vYmplY3Rf
cHV0KG9iaik7CisJCXJldHVybiB2bWE7CisJfQorCisJcmV0dXJuIHZtYTsKK30KKworc3RhdGlj
IHN0cnVjdCBpbnRlbF90aW1lbGluZSAqCitwaW5uZWRfdGltZWxpbmUoc3RydWN0IGludGVsX2Nv
bnRleHQgKmNlLCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJc3RydWN0IGlu
dGVsX3RpbWVsaW5lICp0bCA9IGZldGNoX2FuZF96ZXJvKCZjZS0+dGltZWxpbmUpOworCisJcmV0
dXJuIGludGVsX3RpbWVsaW5lX2NyZWF0ZV9mcm9tX2VuZ2luZShlbmdpbmUsIHBhZ2VfdW5tYXNr
X2JpdHModGwpKTsKK30KKworaW50IGxyY19hbGxvYyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2Us
IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlzdHJ1Y3QgaW50ZWxfcmluZyAq
cmluZzsKKwlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKKwlpbnQgZXJyOworCisJR0VNX0JVR19PTihj
ZS0+c3RhdGUpOworCisJdm1hID0gX19scmNfYWxsb2Nfc3RhdGUoY2UsIGVuZ2luZSk7CisJaWYg
KElTX0VSUih2bWEpKQorCQlyZXR1cm4gUFRSX0VSUih2bWEpOworCisJcmluZyA9IGludGVsX2Vu
Z2luZV9jcmVhdGVfcmluZyhlbmdpbmUsICh1bnNpZ25lZCBsb25nKWNlLT5yaW5nKTsKKwlpZiAo
SVNfRVJSKHJpbmcpKSB7CisJCWVyciA9IFBUUl9FUlIocmluZyk7CisJCWdvdG8gZXJyX3ZtYTsK
Kwl9CisKKwlpZiAoIXBhZ2VfbWFza19iaXRzKGNlLT50aW1lbGluZSkpIHsKKwkJc3RydWN0IGlu
dGVsX3RpbWVsaW5lICp0bDsKKworCQkvKgorCQkgKiBVc2UgdGhlIHN0YXRpYyBnbG9iYWwgSFdT
UCBmb3IgdGhlIGtlcm5lbCBjb250ZXh0LCBhbmQKKwkJICogYSBkeW5hbWljYWxseSBhbGxvY2F0
ZWQgY2FjaGVsaW5lIGZvciBldmVyeW9uZSBlbHNlLgorCQkgKi8KKwkJaWYgKHVubGlrZWx5KGNl
LT50aW1lbGluZSkpCisJCQl0bCA9IHBpbm5lZF90aW1lbGluZShjZSwgZW5naW5lKTsKKwkJZWxz
ZQorCQkJdGwgPSBpbnRlbF90aW1lbGluZV9jcmVhdGUoZW5naW5lLT5ndCk7CisJCWlmIChJU19F
UlIodGwpKSB7CisJCQllcnIgPSBQVFJfRVJSKHRsKTsKKwkJCWdvdG8gZXJyX3Jpbmc7CisJCX0K
KworCQljZS0+dGltZWxpbmUgPSB0bDsKKwl9CisKKwljZS0+cmluZyA9IHJpbmc7CisJY2UtPnN0
YXRlID0gdm1hOworCisJcmV0dXJuIDA7CisKK2Vycl9yaW5nOgorCWludGVsX3JpbmdfcHV0KHJp
bmcpOworZXJyX3ZtYToKKwlpOTE1X3ZtYV9wdXQodm1hKTsKKwlyZXR1cm4gZXJyOworfQorCit2
b2lkIGxyY19yZXNldChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCit7CisJQ0VfVFJBQ0UoY2Us
ICJyZXNldFxuIik7CisJR0VNX0JVR19PTighaW50ZWxfY29udGV4dF9pc19waW5uZWQoY2UpKTsK
KworCWludGVsX3JpbmdfcmVzZXQoY2UtPnJpbmcsIGNlLT5yaW5nLT5lbWl0KTsKKworCS8qIFNj
cnViIGF3YXkgdGhlIGdhcmJhZ2UgKi8KKwlscmNfaW5pdF9yZWdzKGNlLCBjZS0+ZW5naW5lLCB0
cnVlKTsKKwljZS0+bHJjLmxyY2EgPSBscmNfdXBkYXRlX3JlZ3MoY2UsIGNlLT5lbmdpbmUsIGNl
LT5yaW5nLT50YWlsKTsKK30KKworaW50CitscmNfcHJlX3BpbihzdHJ1Y3QgaW50ZWxfY29udGV4
dCAqY2UsCisJICAgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKKwkgICAgc3RydWN0
IGk5MTVfZ2VtX3d3X2N0eCAqd3csCisJICAgIHZvaWQgKip2YWRkcikKK3sKKwlHRU1fQlVHX09O
KCFjZS0+c3RhdGUpOworCUdFTV9CVUdfT04oIWk5MTVfdm1hX2lzX3Bpbm5lZChjZS0+c3RhdGUp
KTsKKworCSp2YWRkciA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKGNlLT5zdGF0ZS0+b2JqLAor
CQkJCQkgaTkxNV9jb2hlcmVudF9tYXBfdHlwZShjZS0+ZW5naW5lLT5pOTE1KSB8CisJCQkJCSBJ
OTE1X01BUF9PVkVSUklERSk7CisKKwlyZXR1cm4gUFRSX0VSUl9PUl9aRVJPKCp2YWRkcik7Cit9
CisKK2ludAorbHJjX3BpbihzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCisJc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lLAorCXZvaWQgKnZhZGRyKQoreworCWNlLT5scmNfcmVnX3N0YXRl
ID0gdmFkZHIgKyBMUkNfU1RBVEVfT0ZGU0VUOworCWNlLT5scmMubHJjYSA9IGxyY191cGRhdGVf
cmVncyhjZSwgZW5naW5lLCBjZS0+cmluZy0+dGFpbCk7CisJcmV0dXJuIDA7Cit9CisKK3ZvaWQg
bHJjX3VucGluKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKK3sKKwljaGVja19yZWR6b25lKCh2
b2lkICopY2UtPmxyY19yZWdfc3RhdGUgLSBMUkNfU1RBVEVfT0ZGU0VULAorCQkgICAgICBjZS0+
ZW5naW5lKTsKK30KKwordm9pZCBscmNfcG9zdF91bnBpbihzdHJ1Y3QgaW50ZWxfY29udGV4dCAq
Y2UpCit7CisJaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChjZS0+c3RhdGUtPm9iaik7Cit9CisK
K3ZvaWQgbHJjX2Zpbmkoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQoreworCWlmICghY2UtPnN0
YXRlKQorCQlyZXR1cm47CisKKwlpbnRlbF9yaW5nX3B1dChmZXRjaF9hbmRfemVybygmY2UtPnJp
bmcpKTsKKwlpOTE1X3ZtYV9wdXQoZmV0Y2hfYW5kX3plcm8oJmNlLT5zdGF0ZSkpOworfQorCit2
b2lkIGxyY19kZXN0cm95KHN0cnVjdCBrcmVmICprcmVmKQoreworCXN0cnVjdCBpbnRlbF9jb250
ZXh0ICpjZSA9IGNvbnRhaW5lcl9vZihrcmVmLCB0eXBlb2YoKmNlKSwgcmVmKTsKKworCUdFTV9C
VUdfT04oIWk5MTVfYWN0aXZlX2lzX2lkbGUoJmNlLT5hY3RpdmUpKTsKKwlHRU1fQlVHX09OKGlu
dGVsX2NvbnRleHRfaXNfcGlubmVkKGNlKSk7CisKKwlscmNfZmluaShjZSk7CisKKwlpbnRlbF9j
b250ZXh0X2ZpbmkoY2UpOworCWludGVsX2NvbnRleHRfZnJlZShjZSk7Cit9CisKK3N0YXRpYyB1
MzIgKgorZ2VuMTJfZW1pdF90aW1lc3RhbXBfd2EoY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQg
KmNlLCB1MzIgKmNzKQoreworCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9NRU1fR0VOOCB8CisJ
CU1JX1NSTV9MUk1fR0xPQkFMX0dUVCB8CisJCU1JX0xSSV9MUk1fQ1NfTU1JTzsKKwkqY3MrKyA9
IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEdFTjhfUklOR19DU19HUFIoMCwgMCkpOworCSpjcysrID0g
aTkxNV9nZ3R0X29mZnNldChjZS0+c3RhdGUpICsgTFJDX1NUQVRFX09GRlNFVCArCisJCUNUWF9U
SU1FU1RBTVAgKiBzaXplb2YodTMyKTsKKwkqY3MrKyA9IDA7CisKKwkqY3MrKyA9IE1JX0xPQURf
UkVHSVNURVJfUkVHIHwKKwkJTUlfTFJSX1NPVVJDRV9DU19NTUlPIHwKKwkJTUlfTFJJX0xSTV9D
U19NTUlPOworCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9SSU5HX0NTX0dQUigw
LCAwKSk7CisJKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChSSU5HX0NUWF9USU1FU1RBTVAo
MCkpOworCisJKmNzKysgPSBNSV9MT0FEX1JFR0lTVEVSX1JFRyB8CisJCU1JX0xSUl9TT1VSQ0Vf
Q1NfTU1JTyB8CisJCU1JX0xSSV9MUk1fQ1NfTU1JTzsKKwkqY3MrKyA9IGk5MTVfbW1pb19yZWdf
b2Zmc2V0KEdFTjhfUklOR19DU19HUFIoMCwgMCkpOworCSpjcysrID0gaTkxNV9tbWlvX3JlZ19v
ZmZzZXQoUklOR19DVFhfVElNRVNUQU1QKDApKTsKKworCXJldHVybiBjczsKK30KKworc3RhdGlj
IHUzMiAqCitnZW4xMl9lbWl0X3Jlc3RvcmVfc2NyYXRjaChjb25zdCBzdHJ1Y3QgaW50ZWxfY29u
dGV4dCAqY2UsIHUzMiAqY3MpCit7CisJR0VNX0JVR19PTihscmNfcmluZ19ncHIwKGNlLT5lbmdp
bmUpID09IC0xKTsKKworCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9NRU1fR0VOOCB8CisJCU1J
X1NSTV9MUk1fR0xPQkFMX0dUVCB8CisJCU1JX0xSSV9MUk1fQ1NfTU1JTzsKKwkqY3MrKyA9IGk5
MTVfbW1pb19yZWdfb2Zmc2V0KEdFTjhfUklOR19DU19HUFIoMCwgMCkpOworCSpjcysrID0gaTkx
NV9nZ3R0X29mZnNldChjZS0+c3RhdGUpICsgTFJDX1NUQVRFX09GRlNFVCArCisJCShscmNfcmlu
Z19ncHIwKGNlLT5lbmdpbmUpICsgMSkgKiBzaXplb2YodTMyKTsKKwkqY3MrKyA9IDA7CisKKwly
ZXR1cm4gY3M7Cit9CisKK3N0YXRpYyB1MzIgKgorZ2VuMTJfZW1pdF9jbWRfYnVmX3dhKGNvbnN0
IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgdTMyICpjcykKK3sKKwlHRU1fQlVHX09OKGxyY19y
aW5nX2NtZF9idWZfY2N0bChjZS0+ZW5naW5lKSA9PSAtMSk7CisKKwkqY3MrKyA9IE1JX0xPQURf
UkVHSVNURVJfTUVNX0dFTjggfAorCQlNSV9TUk1fTFJNX0dMT0JBTF9HVFQgfAorCQlNSV9MUklf
TFJNX0NTX01NSU87CisJKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X1JJTkdfQ1Nf
R1BSKDAsIDApKTsKKwkqY3MrKyA9IGk5MTVfZ2d0dF9vZmZzZXQoY2UtPnN0YXRlKSArIExSQ19T
VEFURV9PRkZTRVQgKworCQkobHJjX3JpbmdfY21kX2J1Zl9jY3RsKGNlLT5lbmdpbmUpICsgMSkg
KiBzaXplb2YodTMyKTsKKwkqY3MrKyA9IDA7CisKKwkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJf
UkVHIHwKKwkJTUlfTFJSX1NPVVJDRV9DU19NTUlPIHwKKwkJTUlfTFJJX0xSTV9DU19NTUlPOwor
CSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9SSU5HX0NTX0dQUigwLCAwKSk7CisJ
KmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChSSU5HX0NNRF9CVUZfQ0NUTCgwKSk7CisKKwly
ZXR1cm4gY3M7Cit9CisKK3N0YXRpYyB1MzIgKgorZ2VuMTJfZW1pdF9pbmRpcmVjdF9jdHhfcmNz
KGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgdTMyICpjcykKK3sKKwljcyA9IGdlbjEy
X2VtaXRfdGltZXN0YW1wX3dhKGNlLCBjcyk7CisJY3MgPSBnZW4xMl9lbWl0X2NtZF9idWZfd2Eo
Y2UsIGNzKTsKKwljcyA9IGdlbjEyX2VtaXRfcmVzdG9yZV9zY3JhdGNoKGNlLCBjcyk7CisKKwly
ZXR1cm4gY3M7Cit9CisKK3N0YXRpYyB1MzIgKgorZ2VuMTJfZW1pdF9pbmRpcmVjdF9jdHhfeGNz
KGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgdTMyICpjcykKK3sKKwljcyA9IGdlbjEy
X2VtaXRfdGltZXN0YW1wX3dhKGNlLCBjcyk7CisJY3MgPSBnZW4xMl9lbWl0X3Jlc3RvcmVfc2Ny
YXRjaChjZSwgY3MpOworCisJcmV0dXJuIGNzOworfQorCitzdGF0aWMgaW5saW5lIHUzMiBjb250
ZXh0X3dhX2JiX29mZnNldChjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCit7CisJcmV0
dXJuIFBBR0VfU0laRSAqIGNlLT53YV9iYl9wYWdlOworfQorCitzdGF0aWMgdTMyICpjb250ZXh0
X2luZGlyZWN0X2JiKGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKK3sKKwl2b2lkICpw
dHI7CisKKwlHRU1fQlVHX09OKCFjZS0+d2FfYmJfcGFnZSk7CisKKwlwdHIgPSBjZS0+bHJjX3Jl
Z19zdGF0ZTsKKwlwdHIgLT0gTFJDX1NUQVRFX09GRlNFVDsgLyogYmFjayB0byBzdGFydCBvZiBj
b250ZXh0IGltYWdlICovCisJcHRyICs9IGNvbnRleHRfd2FfYmJfb2Zmc2V0KGNlKTsKKworCXJl
dHVybiBwdHI7Cit9CisKK3N0YXRpYyB2b2lkCitzZXR1cF9pbmRpcmVjdF9jdHhfYmIoY29uc3Qg
c3RydWN0IGludGVsX2NvbnRleHQgKmNlLAorCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmUsCisJCSAgICAgIHUzMiAqKCplbWl0KShjb25zdCBzdHJ1Y3QgaW50ZWxf
Y29udGV4dCAqLCB1MzIgKikpCit7CisJdTMyICogY29uc3Qgc3RhcnQgPSBjb250ZXh0X2luZGly
ZWN0X2JiKGNlKTsKKwl1MzIgKmNzOworCisJY3MgPSBlbWl0KGNlLCBzdGFydCk7CisJR0VNX0JV
R19PTihjcyAtIHN0YXJ0ID4gSTkxNV9HVFRfUEFHRV9TSVpFIC8gc2l6ZW9mKCpjcykpOworCXdo
aWxlICgodW5zaWduZWQgbG9uZyljcyAlIENBQ0hFTElORV9CWVRFUykKKwkJKmNzKysgPSBNSV9O
T09QOworCisJbHJjX3NldHVwX2luZGlyZWN0X2N0eChjZS0+bHJjX3JlZ19zdGF0ZSwgZW5naW5l
LAorCQkJICAgICAgIGk5MTVfZ2d0dF9vZmZzZXQoY2UtPnN0YXRlKSArCisJCQkgICAgICAgY29u
dGV4dF93YV9iYl9vZmZzZXQoY2UpLAorCQkJICAgICAgIChjcyAtIHN0YXJ0KSAqIHNpemVvZigq
Y3MpKTsKK30KKworLyoKKyAqIFRoZSBjb250ZXh0IGRlc2NyaXB0b3IgZW5jb2RlcyB2YXJpb3Vz
IGF0dHJpYnV0ZXMgb2YgYSBjb250ZXh0LAorICogaW5jbHVkaW5nIGl0cyBHVFQgYWRkcmVzcyBh
bmQgc29tZSBmbGFncy4gQmVjYXVzZSBpdCdzIGZhaXJseQorICogZXhwZW5zaXZlIHRvIGNhbGN1
bGF0ZSwgd2UnbGwganVzdCBkbyBpdCBvbmNlIGFuZCBjYWNoZSB0aGUgcmVzdWx0LAorICogd2hp
Y2ggcmVtYWlucyB2YWxpZCB1bnRpbCB0aGUgY29udGV4dCBpcyB1bnBpbm5lZC4KKyAqCisgKiBU
aGlzIGlzIHdoYXQgYSBkZXNjcmlwdG9yIGxvb2tzIGxpa2UsIGZyb20gTFNCIHRvIE1TQjo6Cisg
KgorICogICAgICBiaXRzICAwLTExOiAgICBmbGFncywgR0VOOF9DVFhfKiAoY2FjaGVkIGluIGN0
eC0+ZGVzY190ZW1wbGF0ZSkKKyAqICAgICAgYml0cyAxMi0zMTogICAgTFJDQSwgR1RUIGFkZHJl
c3Mgb2YgKHRoZSBIV1NQIG9mKSB0aGlzIGNvbnRleHQKKyAqICAgICAgYml0cyAzMi01MjogICAg
Y3R4IElELCBhIGdsb2JhbGx5IHVuaXF1ZSB0YWcgKGhpZ2hlc3QgYml0IHVzZWQgYnkgR3VDKQor
ICogICAgICBiaXRzIDUzLTU0OiAgICBtYnosIHJlc2VydmVkIGZvciB1c2UgYnkgaGFyZHdhcmUK
KyAqICAgICAgYml0cyA1NS02MzogICAgZ3JvdXAgSUQsIGN1cnJlbnRseSB1bnVzZWQgYW5kIHNl
dCB0byAwCisgKgorICogU3RhcnRpbmcgZnJvbSBHZW4xMSwgdGhlIHVwcGVyIGR3b3JkIG9mIHRo
ZSBkZXNjcmlwdG9yIGhhcyBhIG5ldyBmb3JtYXQ6CisgKgorICogICAgICBiaXRzIDMyLTM2OiAg
ICByZXNlcnZlZAorICogICAgICBiaXRzIDM3LTQ3OiAgICBTVyBjb250ZXh0IElECisgKiAgICAg
IGJpdHMgNDg6NTM6ICAgIGVuZ2luZSBpbnN0YW5jZQorICogICAgICBiaXQgNTQ6ICAgICAgICBt
YnosIHJlc2VydmVkIGZvciB1c2UgYnkgaGFyZHdhcmUKKyAqICAgICAgYml0cyA1NS02MDogICAg
U1cgY291bnRlcgorICogICAgICBiaXRzIDYxLTYzOiAgICBlbmdpbmUgY2xhc3MKKyAqCisgKiBl
bmdpbmUgaW5mbywgU1cgY29udGV4dCBJRCBhbmQgU1cgY291bnRlciBuZWVkIHRvIGZvcm0gYSB1
bmlxdWUgbnVtYmVyCisgKiAoQ29udGV4dCBJRCkgcGVyIGxyYy4KKyAqLworc3RhdGljIGlubGlu
ZSB1MzIgbHJjX2Rlc2NyaXB0b3IoY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQorewor
CXUzMiBkZXNjOworCisJZGVzYyA9IElOVEVMX0xFR0FDWV8zMkJfQ09OVEVYVDsKKwlpZiAoaTkx
NV92bV9pc180bHZsKGNlLT52bSkpCisJCWRlc2MgPSBJTlRFTF9MRUdBQ1lfNjRCX0NPTlRFWFQ7
CisJZGVzYyA8PD0gR0VOOF9DVFhfQUREUkVTU0lOR19NT0RFX1NISUZUOworCisJZGVzYyB8PSBH
RU44X0NUWF9WQUxJRCB8IEdFTjhfQ1RYX1BSSVZJTEVHRTsKKwlpZiAoSVNfR0VOKGNlLT52bS0+
aTkxNSwgOCkpCisJCWRlc2MgfD0gR0VOOF9DVFhfTDNMTENfQ09IRVJFTlQ7CisKKwlyZXR1cm4g
aTkxNV9nZ3R0X29mZnNldChjZS0+c3RhdGUpIHwgZGVzYzsKK30KKwordTMyIGxyY191cGRhdGVf
cmVncyhjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCisJCSAgICBjb25zdCBzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUsCisJCSAgICB1MzIgaGVhZCkKK3sKKwlzdHJ1Y3QgaW50
ZWxfcmluZyAqcmluZyA9IGNlLT5yaW5nOworCXUzMiAqcmVncyA9IGNlLT5scmNfcmVnX3N0YXRl
OworCisJR0VNX0JVR19PTighaW50ZWxfcmluZ19vZmZzZXRfdmFsaWQocmluZywgaGVhZCkpOwor
CUdFTV9CVUdfT04oIWludGVsX3Jpbmdfb2Zmc2V0X3ZhbGlkKHJpbmcsIHJpbmctPnRhaWwpKTsK
KworCXJlZ3NbQ1RYX1JJTkdfU1RBUlRdID0gaTkxNV9nZ3R0X29mZnNldChyaW5nLT52bWEpOwor
CXJlZ3NbQ1RYX1JJTkdfSEVBRF0gPSBoZWFkOworCXJlZ3NbQ1RYX1JJTkdfVEFJTF0gPSByaW5n
LT50YWlsOworCXJlZ3NbQ1RYX1JJTkdfQ1RMXSA9IFJJTkdfQ1RMX1NJWkUocmluZy0+c2l6ZSkg
fCBSSU5HX1ZBTElEOworCisJLyogUlBDUyAqLworCWlmIChlbmdpbmUtPmNsYXNzID09IFJFTkRF
Ul9DTEFTUykgeworCQlyZWdzW0NUWF9SX1BXUl9DTEtfU1RBVEVdID0KKwkJCWludGVsX3NzZXVf
bWFrZV9ycGNzKGVuZ2luZS0+Z3QsICZjZS0+c3NldSk7CisKKwkJaTkxNV9vYV9pbml0X3JlZ19z
dGF0ZShjZSwgZW5naW5lKTsKKwl9CisKKwlpZiAoY2UtPndhX2JiX3BhZ2UpIHsKKwkJdTMyICoo
KmZuKShjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHUzMiAqY3MpOworCisJCWZuID0g
Z2VuMTJfZW1pdF9pbmRpcmVjdF9jdHhfeGNzOworCQlpZiAoY2UtPmVuZ2luZS0+Y2xhc3MgPT0g
UkVOREVSX0NMQVNTKQorCQkJZm4gPSBnZW4xMl9lbWl0X2luZGlyZWN0X2N0eF9yY3M7CisKKwkJ
LyogTXV0dWFsbHkgZXhjbHVzaXZlIHdydCB0byBnbG9iYWwgaW5kaXJlY3QgYmIgKi8KKwkJR0VN
X0JVR19PTihlbmdpbmUtPndhX2N0eC5pbmRpcmVjdF9jdHguc2l6ZSk7CisJCXNldHVwX2luZGly
ZWN0X2N0eF9iYihjZSwgZW5naW5lLCBmbik7CisJfQorCisJcmV0dXJuIGxyY19kZXNjcmlwdG9y
KGNlKSB8IENUWF9ERVNDX0ZPUkNFX1JFU1RPUkU7Cit9CisKK3ZvaWQgbHJjX3VwZGF0ZV9vZmZz
ZXRzKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSkKK3sKKwlzZXRfb2Zmc2V0cyhjZS0+bHJjX3JlZ19zdGF0ZSwgcmVnX29mZnNldHMo
ZW5naW5lKSwgZW5naW5lLCBmYWxzZSk7Cit9CisKK3ZvaWQgbHJjX2NoZWNrX3JlZ3MoY29uc3Qg
c3RydWN0IGludGVsX2NvbnRleHQgKmNlLAorCQkgICAgY29uc3Qgc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lLAorCQkgICAgY29uc3QgY2hhciAqd2hlbikKK3sKKwljb25zdCBzdHJ1Y3Qg
aW50ZWxfcmluZyAqcmluZyA9IGNlLT5yaW5nOworCXUzMiAqcmVncyA9IGNlLT5scmNfcmVnX3N0
YXRlOworCWJvb2wgdmFsaWQgPSB0cnVlOworCWludCB4OworCisJaWYgKHJlZ3NbQ1RYX1JJTkdf
U1RBUlRdICE9IGk5MTVfZ2d0dF9vZmZzZXQocmluZy0+dm1hKSkgeworCQlwcl9lcnIoIiVzOiBj
b250ZXh0IHN1Ym1pdHRlZCB3aXRoIGluY29ycmVjdCBSSU5HX1NUQVJUIFslMDh4XSwgZXhwZWN0
ZWQgJTA4eFxuIiwKKwkJICAgICAgIGVuZ2luZS0+bmFtZSwKKwkJICAgICAgIHJlZ3NbQ1RYX1JJ
TkdfU1RBUlRdLAorCQkgICAgICAgaTkxNV9nZ3R0X29mZnNldChyaW5nLT52bWEpKTsKKwkJcmVn
c1tDVFhfUklOR19TVEFSVF0gPSBpOTE1X2dndHRfb2Zmc2V0KHJpbmctPnZtYSk7CisJCXZhbGlk
ID0gZmFsc2U7CisJfQorCisJaWYgKChyZWdzW0NUWF9SSU5HX0NUTF0gJiB+KFJJTkdfV0FJVCB8
IFJJTkdfV0FJVF9TRU1BUEhPUkUpKSAhPQorCSAgICAoUklOR19DVExfU0laRShyaW5nLT5zaXpl
KSB8IFJJTkdfVkFMSUQpKSB7CisJCXByX2VycigiJXM6IGNvbnRleHQgc3VibWl0dGVkIHdpdGgg
aW5jb3JyZWN0IFJJTkdfQ1RMIFslMDh4XSwgZXhwZWN0ZWQgJTA4eFxuIiwKKwkJICAgICAgIGVu
Z2luZS0+bmFtZSwKKwkJICAgICAgIHJlZ3NbQ1RYX1JJTkdfQ1RMXSwKKwkJICAgICAgICh1MzIp
KFJJTkdfQ1RMX1NJWkUocmluZy0+c2l6ZSkgfCBSSU5HX1ZBTElEKSk7CisJCXJlZ3NbQ1RYX1JJ
TkdfQ1RMXSA9IFJJTkdfQ1RMX1NJWkUocmluZy0+c2l6ZSkgfCBSSU5HX1ZBTElEOworCQl2YWxp
ZCA9IGZhbHNlOworCX0KKworCXggPSBscmNfcmluZ19taV9tb2RlKGVuZ2luZSk7CisJaWYgKHgg
IT0gLTEgJiYgcmVnc1t4ICsgMV0gJiAocmVnc1t4ICsgMV0gPj4gMTYpICYgU1RPUF9SSU5HKSB7
CisJCXByX2VycigiJXM6IGNvbnRleHQgc3VibWl0dGVkIHdpdGggU1RPUF9SSU5HIFslMDh4XSBp
biBSSU5HX01JX01PREVcbiIsCisJCSAgICAgICBlbmdpbmUtPm5hbWUsIHJlZ3NbeCArIDFdKTsK
KwkJcmVnc1t4ICsgMV0gJj0gflNUT1BfUklORzsKKwkJcmVnc1t4ICsgMV0gfD0gU1RPUF9SSU5H
IDw8IDE2OworCQl2YWxpZCA9IGZhbHNlOworCX0KKworCVdBUk5fT05DRSghdmFsaWQsICJJbnZh
bGlkIGxyYyBzdGF0ZSBmb3VuZCAlcyBzdWJtaXNzaW9uXG4iLCB3aGVuKTsKK30KKworLyoKKyAq
IEluIHRoaXMgV0Egd2UgbmVlZCB0byBzZXQgR0VOOF9MM1NRQ1JFRzRbMjE6MjFdIGFuZCByZXNl
dCBpdCBhZnRlcgorICogUElQRV9DT05UUk9MIGluc3RydWN0aW9uLiBUaGlzIGlzIHJlcXVpcmVk
IGZvciB0aGUgZmx1c2ggdG8gaGFwcGVuIGNvcnJlY3RseQorICogYnV0IHRoZXJlIGlzIGEgc2xp
Z2h0IGNvbXBsaWNhdGlvbiBhcyB0aGlzIGlzIGFwcGxpZWQgaW4gV0EgYmF0Y2ggd2hlcmUgdGhl
CisgKiB2YWx1ZXMgYXJlIG9ubHkgaW5pdGlhbGl6ZWQgb25jZSBzbyB3ZSBjYW5ub3QgdGFrZSBy
ZWdpc3RlciB2YWx1ZSBhdCB0aGUKKyAqIGJlZ2lubmluZyBhbmQgcmV1c2UgaXQgZnVydGhlcjsg
aGVuY2Ugd2Ugc2F2ZSBpdHMgdmFsdWUgdG8gbWVtb3J5LCB1cGxvYWQgYQorICogY29uc3RhbnQg
dmFsdWUgd2l0aCBiaXQyMSBzZXQgYW5kIHRoZW4gd2UgcmVzdG9yZSBpdCBiYWNrIHdpdGggdGhl
IHNhdmVkIHZhbHVlLgorICogVG8gc2ltcGxpZnkgdGhlIFdBLCBhIGNvbnN0YW50IHZhbHVlIGlz
IGZvcm1lZCBieSB1c2luZyB0aGUgZGVmYXVsdCB2YWx1ZQorICogb2YgdGhpcyByZWdpc3Rlci4g
VGhpcyBzaG91bGRuJ3QgYmUgYSBwcm9ibGVtIGJlY2F1c2Ugd2UgYXJlIG9ubHkgbW9kaWZ5aW5n
CisgKiBpdCBmb3IgYSBzaG9ydCBwZXJpb2QgYW5kIHRoaXMgYmF0Y2ggaW4gbm9uLXByZW1wdGli
bGUuIFdlIGNhbiBvZmNvdXJzZQorICogdXNlIGFkZGl0aW9uYWwgaW5zdHJ1Y3Rpb25zIHRoYXQg
cmVhZCB0aGUgYWN0dWFsIHZhbHVlIG9mIHRoZSByZWdpc3RlcgorICogYXQgdGhhdCB0aW1lIGFu
ZCBzZXQgb3VyIGJpdCBvZiBpbnRlcmVzdCBidXQgaXQgbWFrZXMgdGhlIFdBIGNvbXBsaWNhdGVk
LgorICoKKyAqIFRoaXMgV0EgaXMgYWxzbyByZXF1aXJlZCBmb3IgR2VuOSBzbyBleHRyYWN0aW5n
IGFzIGEgZnVuY3Rpb24gYXZvaWRzCisgKiBjb2RlIGR1cGxpY2F0aW9uLgorICovCitzdGF0aWMg
dTMyICoKK2dlbjhfZW1pdF9mbHVzaF9jb2hlcmVudGwzX3dhKHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSwgdTMyICpiYXRjaCkKK3sKKwkvKiBOQiBubyBvbmUgZWxzZSBpcyBhbGxvd2Vk
IHRvIHNjcmliYmxlIG92ZXIgc2NyYXRjaCArIDI1NiEgKi8KKwkqYmF0Y2grKyA9IE1JX1NUT1JF
X1JFR0lTVEVSX01FTV9HRU44IHwgTUlfU1JNX0xSTV9HTE9CQUxfR1RUOworCSpiYXRjaCsrID0g
aTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9MM1NRQ1JFRzQpOworCSpiYXRjaCsrID0gaW50ZWxf
Z3Rfc2NyYXRjaF9vZmZzZXQoZW5naW5lLT5ndCwKKwkJCQkJICAgSU5URUxfR1RfU0NSQVRDSF9G
SUVMRF9DT0hFUkVOVEwzX1dBKTsKKwkqYmF0Y2grKyA9IDA7CisKKwkqYmF0Y2grKyA9IE1JX0xP
QURfUkVHSVNURVJfSU1NKDEpOworCSpiYXRjaCsrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VO
OF9MM1NRQ1JFRzQpOworCSpiYXRjaCsrID0gMHg0MDQwMDAwMCB8IEdFTjhfTFFTQ19GTFVTSF9D
T0hFUkVOVF9MSU5FUzsKKworCWJhdGNoID0gZ2VuOF9lbWl0X3BpcGVfY29udHJvbChiYXRjaCwK
KwkJCQkgICAgICAgUElQRV9DT05UUk9MX0NTX1NUQUxMIHwKKwkJCQkgICAgICAgUElQRV9DT05U
Uk9MX0RDX0ZMVVNIX0VOQUJMRSwKKwkJCQkgICAgICAgMCk7CisKKwkqYmF0Y2grKyA9IE1JX0xP
QURfUkVHSVNURVJfTUVNX0dFTjggfCBNSV9TUk1fTFJNX0dMT0JBTF9HVFQ7CisJKmJhdGNoKysg
PSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X0wzU1FDUkVHNCk7CisJKmJhdGNoKysgPSBpbnRl
bF9ndF9zY3JhdGNoX29mZnNldChlbmdpbmUtPmd0LAorCQkJCQkgICBJTlRFTF9HVF9TQ1JBVENI
X0ZJRUxEX0NPSEVSRU5UTDNfV0EpOworCSpiYXRjaCsrID0gMDsKKworCXJldHVybiBiYXRjaDsK
K30KKworLyoKKyAqIFR5cGljYWxseSB3ZSBvbmx5IGhhdmUgb25lIGluZGlyZWN0X2N0eCBhbmQg
cGVyX2N0eCBiYXRjaCBidWZmZXIgd2hpY2ggYXJlCisgKiBpbml0aWFsaXplZCBhdCB0aGUgYmVn
aW5uaW5nIGFuZCBzaGFyZWQgYWNyb3NzIGFsbCBjb250ZXh0cyBidXQgdGhpcyBmaWVsZAorICog
aGVscHMgdXMgdG8gaGF2ZSBtdWx0aXBsZSBiYXRjaGVzIGF0IGRpZmZlcmVudCBvZmZzZXRzIGFu
ZCBzZWxlY3QgdGhlbSBiYXNlZAorICogb24gYSBjcml0ZXJpYS4gQXQgdGhlIG1vbWVudCB0aGlz
IGJhdGNoIGFsd2F5cyBzdGFydCBhdCB0aGUgYmVnaW5uaW5nIG9mIHRoZSBwYWdlCisgKiBhbmQg
YXQgdGhpcyBwb2ludCB3ZSBkb24ndCBoYXZlIG11bHRpcGxlIHdhX2N0eCBiYXRjaCBidWZmZXJz
LgorICoKKyAqIFRoZSBudW1iZXIgb2YgV0EgYXBwbGllZCBhcmUgbm90IGtub3duIGF0IHRoZSBi
ZWdpbm5pbmc7IHdlIHVzZSB0aGlzIGZpZWxkCisgKiB0byByZXR1cm4gdGhlIG5vIG9mIERXT1JE
UyB3cml0dGVuLgorICoKKyAqIEl0IGlzIHRvIGJlIG5vdGVkIHRoYXQgdGhpcyBiYXRjaCBkb2Vz
IG5vdCBjb250YWluIE1JX0JBVENIX0JVRkZFUl9FTkQKKyAqIHNvIGl0IGFkZHMgTk9PUHMgYXMg
cGFkZGluZyB0byBtYWtlIGl0IGNhY2hlbGluZSBhbGlnbmVkLgorICogTUlfQkFUQ0hfQlVGRkVS
X0VORCB3aWxsIGJlIGFkZGVkIHRvIHBlcmN0eCBiYXRjaCBhbmQgYm90aCBvZiB0aGVtIHRvZ2V0
aGVyCisgKiBtYWtlcyBhIGNvbXBsZXRlIGJhdGNoIGJ1ZmZlci4KKyAqLworc3RhdGljIHUzMiAq
Z2VuOF9pbml0X2luZGlyZWN0Y3R4X2JiKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwg
dTMyICpiYXRjaCkKK3sKKwkvKiBXYURpc2FibGVDdHhSZXN0b3JlQXJiaXRyYXRpb246YmR3LGNo
diAqLworCSpiYXRjaCsrID0gTUlfQVJCX09OX09GRiB8IE1JX0FSQl9ESVNBQkxFOworCisJLyog
V2FGbHVzaENvaGVyZW50TDNDYWNoZUxpbmVzQXRDb250ZXh0U3dpdGNoOmJkdyAqLworCWlmIChJ
U19CUk9BRFdFTEwoZW5naW5lLT5pOTE1KSkKKwkJYmF0Y2ggPSBnZW44X2VtaXRfZmx1c2hfY29o
ZXJlbnRsM193YShlbmdpbmUsIGJhdGNoKTsKKworCS8qIFdhQ2xlYXJTbG1TcGFjZUF0Q29udGV4
dFN3aXRjaDpiZHcsY2h2ICovCisJLyogQWN0dWFsIHNjcmF0Y2ggbG9jYXRpb24gaXMgYXQgMTI4
IGJ5dGVzIG9mZnNldCAqLworCWJhdGNoID0gZ2VuOF9lbWl0X3BpcGVfY29udHJvbChiYXRjaCwK
KwkJCQkgICAgICAgUElQRV9DT05UUk9MX0ZMVVNIX0wzIHwKKwkJCQkgICAgICAgUElQRV9DT05U
Uk9MX1NUT1JFX0RBVEFfSU5ERVggfAorCQkJCSAgICAgICBQSVBFX0NPTlRST0xfQ1NfU1RBTEwg
fAorCQkJCSAgICAgICBQSVBFX0NPTlRST0xfUVdfV1JJVEUsCisJCQkJICAgICAgIExSQ19QUEhX
U1BfU0NSQVRDSF9BRERSKTsKKworCSpiYXRjaCsrID0gTUlfQVJCX09OX09GRiB8IE1JX0FSQl9F
TkFCTEU7CisKKwkvKiBQYWQgdG8gZW5kIG9mIGNhY2hlbGluZSAqLworCXdoaWxlICgodW5zaWdu
ZWQgbG9uZyliYXRjaCAlIENBQ0hFTElORV9CWVRFUykKKwkJKmJhdGNoKysgPSBNSV9OT09QOwor
CisJLyoKKwkgKiBNSV9CQVRDSF9CVUZGRVJfRU5EIGlzIG5vdCByZXF1aXJlZCBpbiBJbmRpcmVj
dCBjdHggQkIgYmVjYXVzZQorCSAqIGV4ZWN1dGlvbiBkZXBlbmRzIG9uIHRoZSBsZW5ndGggc3Bl
Y2lmaWVkIGluIHRlcm1zIG9mIGNhY2hlIGxpbmVzCisJICogaW4gdGhlIHJlZ2lzdGVyIENUWF9S
Q1NfSU5ESVJFQ1RfQ1RYCisJICovCisKKwlyZXR1cm4gYmF0Y2g7Cit9CisKK3N0cnVjdCBscmkg
eworCWk5MTVfcmVnX3QgcmVnOworCXUzMiB2YWx1ZTsKK307CisKK3N0YXRpYyB1MzIgKmVtaXRf
bHJpKHUzMiAqYmF0Y2gsIGNvbnN0IHN0cnVjdCBscmkgKmxyaSwgdW5zaWduZWQgaW50IGNvdW50
KQoreworCUdFTV9CVUdfT04oIWNvdW50IHx8IGNvdW50ID4gNjMpOworCisJKmJhdGNoKysgPSBN
SV9MT0FEX1JFR0lTVEVSX0lNTShjb3VudCk7CisJZG8geworCQkqYmF0Y2grKyA9IGk5MTVfbW1p
b19yZWdfb2Zmc2V0KGxyaS0+cmVnKTsKKwkJKmJhdGNoKysgPSBscmktPnZhbHVlOworCX0gd2hp
bGUgKGxyaSsrLCAtLWNvdW50KTsKKwkqYmF0Y2grKyA9IE1JX05PT1A7CisKKwlyZXR1cm4gYmF0
Y2g7Cit9CisKK3N0YXRpYyB1MzIgKmdlbjlfaW5pdF9pbmRpcmVjdGN0eF9iYihzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUsIHUzMiAqYmF0Y2gpCit7CisJc3RhdGljIGNvbnN0IHN0cnVj
dCBscmkgbHJpW10gPSB7CisJCS8qIFdhRGlzYWJsZUdhdGhlckF0U2V0U2hhZGVyQ29tbW9uU2xp
Y2U6c2tsLGJ4dCxrYmwsZ2xrICovCisJCXsKKwkJCUNPTU1PTl9TTElDRV9DSElDS0VOMiwKKwkJ
CV9fTUFTS0VEX0ZJRUxEKEdFTjlfRElTQUJMRV9HQVRIRVJfQVRfU0VUX1NIQURFUl9DT01NT05f
U0xJQ0UsCisJCQkJICAgICAgIDApLAorCQl9LAorCisJCS8qIEJTcGVjOiAxMTM5MSAqLworCQl7
CisJCQlGRl9TTElDRV9DSElDS0VOLAorCQkJX19NQVNLRURfRklFTEQoRkZfU0xJQ0VfQ0hJQ0tF
Tl9DTF9QUk9WT0tJTkdfVkVSVEVYX0ZJWCwKKwkJCQkgICAgICAgRkZfU0xJQ0VfQ0hJQ0tFTl9D
TF9QUk9WT0tJTkdfVkVSVEVYX0ZJWCksCisJCX0sCisKKwkJLyogQlNwZWM6IDExMjk5ICovCisJ
CXsKKwkJCV8zRF9DSElDS0VOMywKKwkJCV9fTUFTS0VEX0ZJRUxEKF8zRF9DSElDS0VOX1NGX1BS
T1ZPS0lOR19WRVJURVhfRklYLAorCQkJCSAgICAgICBfM0RfQ0hJQ0tFTl9TRl9QUk9WT0tJTkdf
VkVSVEVYX0ZJWCksCisJCX0KKwl9OworCisJKmJhdGNoKysgPSBNSV9BUkJfT05fT0ZGIHwgTUlf
QVJCX0RJU0FCTEU7CisKKwkvKiBXYUZsdXNoQ29oZXJlbnRMM0NhY2hlTGluZXNBdENvbnRleHRT
d2l0Y2g6c2tsLGJ4dCxnbGsgKi8KKwliYXRjaCA9IGdlbjhfZW1pdF9mbHVzaF9jb2hlcmVudGwz
X3dhKGVuZ2luZSwgYmF0Y2gpOworCisJLyogV2FDbGVhclNsbVNwYWNlQXRDb250ZXh0U3dpdGNo
OnNrbCxieHQsa2JsLGdsayxjZmwgKi8KKwliYXRjaCA9IGdlbjhfZW1pdF9waXBlX2NvbnRyb2wo
YmF0Y2gsCisJCQkJICAgICAgIFBJUEVfQ09OVFJPTF9GTFVTSF9MMyB8CisJCQkJICAgICAgIFBJ
UEVfQ09OVFJPTF9TVE9SRV9EQVRBX0lOREVYIHwKKwkJCQkgICAgICAgUElQRV9DT05UUk9MX0NT
X1NUQUxMIHwKKwkJCQkgICAgICAgUElQRV9DT05UUk9MX1FXX1dSSVRFLAorCQkJCSAgICAgICBM
UkNfUFBIV1NQX1NDUkFUQ0hfQUREUik7CisKKwliYXRjaCA9IGVtaXRfbHJpKGJhdGNoLCBscmks
IEFSUkFZX1NJWkUobHJpKSk7CisKKwkvKiBXYU1lZGlhUG9vbFN0YXRlQ21kSW5XQUJCOmJ4dCxn
bGsgKi8KKwlpZiAoSEFTX1BPT0xFRF9FVShlbmdpbmUtPmk5MTUpKSB7CisJCS8qCisJCSAqIEVV
IHBvb2wgY29uZmlndXJhdGlvbiBpcyBzZXR1cCBhbG9uZyB3aXRoIGdvbGRlbiBjb250ZXh0CisJ
CSAqIGR1cmluZyBjb250ZXh0IGluaXRpYWxpemF0aW9uLiBUaGlzIHZhbHVlIGRlcGVuZHMgb24K
KwkJICogZGV2aWNlIHR5cGUgKDJ4NiBvciAzeDYpIGFuZCBuZWVkcyB0byBiZSB1cGRhdGVkIGJh
c2VkCisJCSAqIG9uIHdoaWNoIHN1YnNsaWNlIGlzIGRpc2FibGVkIGVzcGVjaWFsbHkgZm9yIDJ4
NgorCQkgKiBkZXZpY2VzLCBob3dldmVyIGl0IGlzIHNhZmUgdG8gbG9hZCBkZWZhdWx0CisJCSAq
IGNvbmZpZ3VyYXRpb24gb2YgM3g2IGRldmljZSBpbnN0ZWFkIG9mIG1hc2tpbmcgb2ZmCisJCSAq
IGNvcnJlc3BvbmRpbmcgYml0cyBiZWNhdXNlIEhXIGlnbm9yZXMgYml0cyBvZiBhIGRpc2FibGVk
CisJCSAqIHN1YnNsaWNlIGFuZCBkcm9wcyBkb3duIHRvIGFwcHJvcHJpYXRlIGNvbmZpZy4gUGxl
YXNlCisJCSAqIHNlZSByZW5kZXJfc3RhdGVfc2V0dXAoKSBpbiBpOTE1X2dlbV9yZW5kZXJfc3Rh
dGUuYyBmb3IKKwkJICogcG9zc2libGUgY29uZmlndXJhdGlvbnMsIHRvIGF2b2lkIGR1cGxpY2F0
aW9uIHRoZXkgYXJlCisJCSAqIG5vdCBzaG93biBoZXJlIGFnYWluLgorCQkgKi8KKwkJKmJhdGNo
KysgPSBHRU45X01FRElBX1BPT0xfU1RBVEU7CisJCSpiYXRjaCsrID0gR0VOOV9NRURJQV9QT09M
X0VOQUJMRTsKKwkJKmJhdGNoKysgPSAweDAwNzc3MDAwOworCQkqYmF0Y2grKyA9IDA7CisJCSpi
YXRjaCsrID0gMDsKKwkJKmJhdGNoKysgPSAwOworCX0KKworCSpiYXRjaCsrID0gTUlfQVJCX09O
X09GRiB8IE1JX0FSQl9FTkFCTEU7CisKKwkvKiBQYWQgdG8gZW5kIG9mIGNhY2hlbGluZSAqLwor
CXdoaWxlICgodW5zaWduZWQgbG9uZyliYXRjaCAlIENBQ0hFTElORV9CWVRFUykKKwkJKmJhdGNo
KysgPSBNSV9OT09QOworCisJcmV0dXJuIGJhdGNoOworfQorCitzdGF0aWMgdTMyICoKK2dlbjEw
X2luaXRfaW5kaXJlY3RjdHhfYmIoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1MzIg
KmJhdGNoKQoreworCWludCBpOworCisJLyoKKwkgKiBXYVBpcGVDb250cm9sQmVmb3JlM0RTdGF0
ZVNhbXBsZVBhdHRlcm46IGNubAorCSAqCisJICogRW5zdXJlIHRoZSBlbmdpbmUgaXMgaWRsZSBw
cmlvciB0byBwcm9ncmFtbWluZyBhCisJICogM0RTVEFURV9TQU1QTEVfUEFUVEVSTiBkdXJpbmcg
YSBjb250ZXh0IHJlc3RvcmUuCisJICovCisJYmF0Y2ggPSBnZW44X2VtaXRfcGlwZV9jb250cm9s
KGJhdGNoLAorCQkJCSAgICAgICBQSVBFX0NPTlRST0xfQ1NfU1RBTEwsCisJCQkJICAgICAgIDAp
OworCS8qCisJICogV2FQaXBlQ29udHJvbEJlZm9yZTNEU3RhdGVTYW1wbGVQYXR0ZXJuIHNheXMg
d2UgbmVlZCA0IGR3b3JkcyBmb3IKKwkgKiB0aGUgUElQRV9DT05UUk9MIGZvbGxvd2VkIGJ5IDEy
IGR3b3JkcyBvZiAweDAsIHNvIDE2IGR3b3JkcyBpbgorCSAqIHRvdGFsLiBIb3dldmVyLCBhIFBJ
UEVfQ09OVFJPTCBpcyA2IGR3b3JkcyBsb25nLCBub3QgNCwgd2hpY2ggaXMKKwkgKiBjb25mdXNp
bmcuIFNpbmNlIGdlbjhfZW1pdF9waXBlX2NvbnRyb2woKSBhbHJlYWR5IGFkdmFuY2VzIHRoZQor
CSAqIGJhdGNoIGJ5IDYgZHdvcmRzLCB3ZSBhZHZhbmNlIHRoZSBvdGhlciAxMCBoZXJlLCBjb21w
bGV0aW5nIGEKKwkgKiBjYWNoZWxpbmUuIEl0J3Mgbm90IGNsZWFyIGlmIHRoZSB3b3JrYXJvdW5k
IHJlcXVpcmVzIHRoaXMgcGFkZGluZworCSAqIGJlZm9yZSBvdGhlciBjb21tYW5kcywgb3IgaWYg
aXQncyBqdXN0IHRoZSByZWd1bGFyIHBhZGRpbmcgd2Ugd291bGQKKwkgKiBhbHJlYWR5IGhhdmUg
Zm9yIHRoZSB3b3JrYXJvdW5kIGJiLCBzbyBsZWF2ZSBpdCBoZXJlIGZvciBub3cuCisJICovCisJ
Zm9yIChpID0gMDsgaSA8IDEwOyBpKyspCisJCSpiYXRjaCsrID0gTUlfTk9PUDsKKworCS8qIFBh
ZCB0byBlbmQgb2YgY2FjaGVsaW5lICovCisJd2hpbGUgKCh1bnNpZ25lZCBsb25nKWJhdGNoICUg
Q0FDSEVMSU5FX0JZVEVTKQorCQkqYmF0Y2grKyA9IE1JX05PT1A7CisKKwlyZXR1cm4gYmF0Y2g7
Cit9CisKKyNkZWZpbmUgQ1RYX1dBX0JCX1NJWkUgKFBBR0VfU0laRSkKKworc3RhdGljIGludCBs
cmNfc2V0dXBfd2FfY3R4KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOworCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOworCWlu
dCBlcnI7CisKKwlvYmogPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3NobWVtKGVuZ2luZS0+aTkx
NSwgQ1RYX1dBX0JCX1NJWkUpOworCWlmIChJU19FUlIob2JqKSkKKwkJcmV0dXJuIFBUUl9FUlIo
b2JqKTsKKworCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9iaiwgJmVuZ2luZS0+Z3QtPmdndHQt
PnZtLCBOVUxMKTsKKwlpZiAoSVNfRVJSKHZtYSkpIHsKKwkJZXJyID0gUFRSX0VSUih2bWEpOwor
CQlnb3RvIGVycjsKKwl9CisKKwllcnIgPSBpOTE1X2dndHRfcGluKHZtYSwgTlVMTCwgMCwgUElO
X0hJR0gpOworCWlmIChlcnIpCisJCWdvdG8gZXJyOworCisJZW5naW5lLT53YV9jdHgudm1hID0g
dm1hOworCXJldHVybiAwOworCitlcnI6CisJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOworCXJl
dHVybiBlcnI7Cit9CisKK3ZvaWQgbHJjX2Zpbmlfd2FfY3R4KHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSkKK3sKKwlpOTE1X3ZtYV91bnBpbl9hbmRfcmVsZWFzZSgmZW5naW5lLT53YV9j
dHgudm1hLCAwKTsKK30KKwordHlwZWRlZiB1MzIgKigqd2FfYmJfZnVuY190KShzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUsIHUzMiAqYmF0Y2gpOworCitpbnQgbHJjX2luaXRfd2FfY3R4
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlzdHJ1Y3QgaTkxNV9jdHhfd29y
a2Fyb3VuZHMgKndhX2N0eCA9ICZlbmdpbmUtPndhX2N0eDsKKwlzdHJ1Y3QgaTkxNV93YV9jdHhf
YmIgKndhX2JiW10gPSB7CisJCSZ3YV9jdHgtPmluZGlyZWN0X2N0eCwgJndhX2N0eC0+cGVyX2N0
eAorCX07CisJd2FfYmJfZnVuY190IHdhX2JiX2ZuW0FSUkFZX1NJWkUod2FfYmIpXTsKKwl2b2lk
ICpiYXRjaCwgKmJhdGNoX3B0cjsKKwl1bnNpZ25lZCBpbnQgaTsKKwlpbnQgcmV0OworCisJaWYg
KGVuZ2luZS0+Y2xhc3MgIT0gUkVOREVSX0NMQVNTKQorCQlyZXR1cm4gMDsKKworCXN3aXRjaCAo
SU5URUxfR0VOKGVuZ2luZS0+aTkxNSkpIHsKKwljYXNlIDEyOgorCWNhc2UgMTE6CisJCXJldHVy
biAwOworCWNhc2UgMTA6CisJCXdhX2JiX2ZuWzBdID0gZ2VuMTBfaW5pdF9pbmRpcmVjdGN0eF9i
YjsKKwkJd2FfYmJfZm5bMV0gPSBOVUxMOworCQlicmVhazsKKwljYXNlIDk6CisJCXdhX2JiX2Zu
WzBdID0gZ2VuOV9pbml0X2luZGlyZWN0Y3R4X2JiOworCQl3YV9iYl9mblsxXSA9IE5VTEw7CisJ
CWJyZWFrOworCWNhc2UgODoKKwkJd2FfYmJfZm5bMF0gPSBnZW44X2luaXRfaW5kaXJlY3RjdHhf
YmI7CisJCXdhX2JiX2ZuWzFdID0gTlVMTDsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJTUlTU0lO
R19DQVNFKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpKTsKKwkJcmV0dXJuIDA7CisJfQorCisJcmV0
ID0gbHJjX3NldHVwX3dhX2N0eChlbmdpbmUpOworCWlmIChyZXQpIHsKKwkJZHJtX2RiZygmZW5n
aW5lLT5pOTE1LT5kcm0sCisJCQkiRmFpbGVkIHRvIHNldHVwIGNvbnRleHQgV0EgcGFnZTogJWRc
biIsIHJldCk7CisJCXJldHVybiByZXQ7CisJfQorCisJYmF0Y2ggPSBpOTE1X2dlbV9vYmplY3Rf
cGluX21hcCh3YV9jdHgtPnZtYS0+b2JqLCBJOTE1X01BUF9XQik7CisKKwkvKgorCSAqIEVtaXQg
dGhlIHR3byB3b3JrYXJvdW5kIGJhdGNoIGJ1ZmZlcnMsIHJlY29yZGluZyB0aGUgb2Zmc2V0IGZy
b20gdGhlCisJICogc3RhcnQgb2YgdGhlIHdvcmthcm91bmQgYmF0Y2ggYnVmZmVyIG9iamVjdCBm
b3IgZWFjaCBhbmQgdGhlaXIKKwkgKiByZXNwZWN0aXZlIHNpemVzLgorCSAqLworCWJhdGNoX3B0
ciA9IGJhdGNoOworCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKHdhX2JiX2ZuKTsgaSsrKSB7
CisJCXdhX2JiW2ldLT5vZmZzZXQgPSBiYXRjaF9wdHIgLSBiYXRjaDsKKwkJaWYgKEdFTV9ERUJV
R19XQVJOX09OKCFJU19BTElHTkVEKHdhX2JiW2ldLT5vZmZzZXQsCisJCQkJCQkgIENBQ0hFTElO
RV9CWVRFUykpKSB7CisJCQlyZXQgPSAtRUlOVkFMOworCQkJYnJlYWs7CisJCX0KKwkJaWYgKHdh
X2JiX2ZuW2ldKQorCQkJYmF0Y2hfcHRyID0gd2FfYmJfZm5baV0oZW5naW5lLCBiYXRjaF9wdHIp
OworCQl3YV9iYltpXS0+c2l6ZSA9IGJhdGNoX3B0ciAtIChiYXRjaCArIHdhX2JiW2ldLT5vZmZz
ZXQpOworCX0KKwlHRU1fQlVHX09OKGJhdGNoX3B0ciAtIGJhdGNoID4gQ1RYX1dBX0JCX1NJWkUp
OworCisJX19pOTE1X2dlbV9vYmplY3RfZmx1c2hfbWFwKHdhX2N0eC0+dm1hLT5vYmosIDAsIGJh
dGNoX3B0ciAtIGJhdGNoKTsKKwlfX2k5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21hcCh3YV9jdHgt
PnZtYS0+b2JqKTsKKwlpZiAocmV0KQorCQlscmNfZmluaV93YV9jdHgoZW5naW5lKTsKKworCXJl
dHVybiByZXQ7Cit9CisKK3N0YXRpYyB2b2lkIHN0X3VwZGF0ZV9ydW50aW1lX3VuZGVyZmxvdyhz
dHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHMzMiBkdCkKK3sKKyNpZiBJU19FTkFCTEVEKENPTkZJ
R19EUk1fSTkxNV9TRUxGVEVTVCkKKwljZS0+cnVudGltZS5udW1fdW5kZXJmbG93Kys7CisJY2Ut
PnJ1bnRpbWUubWF4X3VuZGVyZmxvdyA9IG1heF90KHUzMiwgY2UtPnJ1bnRpbWUubWF4X3VuZGVy
ZmxvdywgLWR0KTsKKyNlbmRpZgorfQorCit2b2lkIGxyY191cGRhdGVfcnVudGltZShzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqY2UpCit7CisJdTMyIG9sZDsKKwlzMzIgZHQ7CisKKwlpZiAoaW50ZWxf
Y29udGV4dF9pc19iYXJyaWVyKGNlKSkKKwkJcmV0dXJuOworCisJb2xkID0gY2UtPnJ1bnRpbWUu
bGFzdDsKKwljZS0+cnVudGltZS5sYXN0ID0gbHJjX2dldF9ydW50aW1lKGNlKTsKKwlkdCA9IGNl
LT5ydW50aW1lLmxhc3QgLSBvbGQ7CisKKwlpZiAodW5saWtlbHkoZHQgPCAwKSkgeworCQlDRV9U
UkFDRShjZSwgInJ1bnRpbWUgdW5kZXJmbG93OiBsYXN0PSV1LCBuZXc9JXUsIGRlbHRhPSVkXG4i
LAorCQkJIG9sZCwgY2UtPnJ1bnRpbWUubGFzdCwgZHQpOworCQlzdF91cGRhdGVfcnVudGltZV91
bmRlcmZsb3coY2UsIGR0KTsKKwkJcmV0dXJuOworCX0KKworCWV3bWFfcnVudGltZV9hZGQoJmNl
LT5ydW50aW1lLmF2ZywgZHQpOworCWNlLT5ydW50aW1lLnRvdGFsICs9IGR0OworfQorCisjaWYg
SVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfU0VMRlRFU1QpCisjaW5jbHVkZSAic2VsZnRlc3Rf
bHJjLmMiCisjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2xyYy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmgKbmV3IGZpbGUgbW9k
ZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi44YjM3ZjM3ZGUzY2EKLS0tIC9kZXYvbnVsbAor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuaApAQCAtMCwwICsxLDg1IEBA
CisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUICovCisvKgorICogQ29weXJpZ2h0IMKp
IDIwMTQgSW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisjaWZuZGVmIF9fSU5URUxfTFJDX0hfXwor
I2RlZmluZSBfX0lOVEVMX0xSQ19IX18KKworI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CisKKyNp
bmNsdWRlICJpbnRlbF9jb250ZXh0LmgiCisjaW5jbHVkZSAiaW50ZWxfbHJjX3JlZy5oIgorCitz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdDsKK3N0cnVjdCBpbnRlbF9lbmdpbmVfY3M7CitzdHJ1
Y3QgaW50ZWxfcmluZzsKKworLyogQXQgdGhlIHN0YXJ0IG9mIHRoZSBjb250ZXh0IGltYWdlIGlz
IGl0cyBwZXItcHJvY2VzcyBIV1MgcGFnZSAqLworI2RlZmluZSBMUkNfUFBIV1NQX1BOCSgwKQor
I2RlZmluZSBMUkNfUFBIV1NQX1NaCSgxKQorLyogQWZ0ZXIgdGhlIFBQSFdTUCB3ZSBoYXZlIHRo
ZSBsb2dpY2FsIHN0YXRlIGZvciB0aGUgY29udGV4dCAqLworI2RlZmluZSBMUkNfU1RBVEVfUE4J
KExSQ19QUEhXU1BfUE4gKyBMUkNfUFBIV1NQX1NaKQorI2RlZmluZSBMUkNfU1RBVEVfT0ZGU0VU
IChMUkNfU1RBVEVfUE4gKiBQQUdFX1NJWkUpCisKKy8qIFNwYWNlIHdpdGhpbiBQUEhXU1AgcmVz
ZXJ2ZWQgdG8gYmUgdXNlZCBhcyBzY3JhdGNoICovCisjZGVmaW5lIExSQ19QUEhXU1BfU0NSQVRD
SAkJMHgzNAorI2RlZmluZSBMUkNfUFBIV1NQX1NDUkFUQ0hfQUREUgkJKExSQ19QUEhXU1BfU0NS
QVRDSCAqIHNpemVvZih1MzIpKQorCitpbnQgbHJjX2luaXRfd2FfY3R4KHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSk7Cit2b2lkIGxyY19maW5pX3dhX2N0eChzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmUpOworCitpbnQgbHJjX2FsbG9jKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpj
ZSwKKwkgICAgICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpOwordm9pZCBscmNfcmVz
ZXQoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKTsKK3ZvaWQgbHJjX2Zpbmkoc3RydWN0IGludGVs
X2NvbnRleHQgKmNlKTsKK3ZvaWQgbHJjX2Rlc3Ryb3koc3RydWN0IGtyZWYgKmtyZWYpOworCitp
bnQKK2xyY19wcmVfcGluKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKKwkgICAgc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lLAorCSAgICBzdHJ1Y3QgaTkxNV9nZW1fd3dfY3R4ICp3dywK
KwkgICAgdm9pZCAqKnZhZGRyKTsKK2ludAorbHJjX3BpbihzdHJ1Y3QgaW50ZWxfY29udGV4dCAq
Y2UsCisJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAorCXZvaWQgKnZhZGRyKTsKK3Zv
aWQgbHJjX3VucGluKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSk7Cit2b2lkIGxyY19wb3N0X3Vu
cGluKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSk7CisKK3ZvaWQgbHJjX2luaXRfc3RhdGUoc3Ry
dWN0IGludGVsX2NvbnRleHQgKmNlLAorCQkgICAgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lLAorCQkgICAgdm9pZCAqc3RhdGUpOworCit2b2lkIGxyY19yZXN0b3JlX2RlZmF1bHRzKHN0
cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJCSAgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lKTsKKwordm9pZCBscmNfaW5pdF9yZWdzKGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpj
ZSwKKwkJICAgY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAorCQkgICBib29s
IGNsb3NlKTsKK3ZvaWQgbHJjX3Jlc2V0X3JlZ3MoY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQg
KmNlLAorCQkgICAgY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKKwordTMy
IGxyY191cGRhdGVfcmVncyhjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCisJCSAgICBj
b25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCisJCSAgICB1MzIgaGVhZCk7Cit2
b2lkIGxyY191cGRhdGVfb2Zmc2V0cyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCisJCQlzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpOworCit2b2lkIGxyY19jaGVja19yZWdzKGNvbnN0
IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSwKKwkJICAgIGNvbnN0IGNoYXIgKndoZW4pOworCit2b2lkIGxyY191cGRh
dGVfcnVudGltZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpOworc3RhdGljIGlubGluZSB1MzIg
bHJjX2dldF9ydW50aW1lKGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKK3sKKwkvKgor
CSAqIFdlIGNhbiB1c2UgZWl0aGVyIHBwSFdTUFsxNl0gd2hpY2ggaXMgcmVjb3JkZWQgYmVmb3Jl
IHRoZSBjb250ZXh0CisJICogc3dpdGNoIChhbmQgc28gZXhjbHVkZXMgdGhlIGNvc3Qgb2YgY29u
dGV4dCBzd2l0Y2hlcykgb3IgdXNlIHRoZQorCSAqIHZhbHVlIGZyb20gdGhlIGNvbnRleHQgaW1h
Z2UgaXRzZWxmLCB3aGljaCBpcyBzYXZlZC9yZXN0b3JlZCBlYXJsaWVyCisJICogYW5kIHNvIGlu
Y2x1ZGVzIHRoZSBjb3N0IG9mIHRoZSBzYXZlLgorCSAqLworCXJldHVybiBSRUFEX09OQ0UoY2Ut
PmxyY19yZWdfc3RhdGVbQ1RYX1RJTUVTVEFNUF0pOworfQorCisjZW5kaWYgLyogX19JTlRFTF9M
UkNfSF9fICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmNf
cmVnLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmNfcmVnLmgKaW5kZXggYjJl
MDNjZTM1NTk5Li42NWZlNzY3MzgzMzUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2xyY19yZWcuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9s
cmNfcmVnLmgKQEAgLTksNiArOSw4IEBACiAKICNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgogCisj
ZGVmaW5lIENUWF9ERVNDX0ZPUkNFX1JFU1RPUkUgQklUX1VMTCgyKQorCiAvKiBHRU44IHRvIEdF
TjEyIFJlZyBTdGF0ZSBDb250ZXh0ICovCiAjZGVmaW5lIENUWF9DT05URVhUX0NPTlRST0wJCSgw
eDAyICsgMSkKICNkZWZpbmUgQ1RYX1JJTkdfSEVBRAkJCSgweDA0ICsgMSkKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2V4ZWNsaXN0cy5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfZXhlY2xpc3RzLmMKaW5kZXggOTVkNDFjMDFkMGUwLi4z
NGMyYmI4MzEzZWIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0
X2V4ZWNsaXN0cy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2V4ZWNs
aXN0cy5jCkBAIC0yNDksNyArMjQ5LDcgQEAgc3RhdGljIGludCBsaXZlX3VubGl0ZV9yZXN0b3Jl
KHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGludCBwcmlvKQogCQl9CiAJCUdFTV9CVUdfT04oIWNlWzFd
LT5yaW5nLT5zaXplKTsKIAkJaW50ZWxfcmluZ19yZXNldChjZVsxXS0+cmluZywgY2VbMV0tPnJp
bmctPnNpemUgLyAyKTsKLQkJX19leGVjbGlzdHNfdXBkYXRlX3JlZ19zdGF0ZShjZVsxXSwgZW5n
aW5lLCBjZVsxXS0+cmluZy0+aGVhZCk7CisJCWxyY191cGRhdGVfcmVncyhjZVsxXSwgZW5naW5l
LCBjZVsxXS0+cmluZy0+aGVhZCk7CiAKIAkJcnFbMF0gPSBpZ3Rfc3Bpbm5lcl9jcmVhdGVfcmVx
dWVzdCgmc3BpbiwgY2VbMF0sIE1JX0FSQl9DSEVDSyk7CiAJCWlmIChJU19FUlIocnFbMF0pKSB7
CkBAIC00NzA1LDE3NzcgKzQ3MDUsMyBAQCBpbnQgaW50ZWxfZXhlY2xpc3RzX2xpdmVfc2VsZnRl
c3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCiAJcmV0dXJuIGludGVsX2d0X2xp
dmVfc3VidGVzdHModGVzdHMsICZpOTE1LT5ndCk7CiB9Ci0KLXN0YXRpYyBpbnQgZW1pdF9zZW1h
cGhvcmVfc2lnbmFsKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgdm9pZCAqc2xvdCkKLXsKLQlj
b25zdCB1MzIgb2Zmc2V0ID0KLQkJaTkxNV9nZ3R0X29mZnNldChjZS0+ZW5naW5lLT5zdGF0dXNf
cGFnZS52bWEpICsKLQkJb2Zmc2V0X2luX3BhZ2Uoc2xvdCk7Ci0Jc3RydWN0IGk5MTVfcmVxdWVz
dCAqcnE7Ci0JdTMyICpjczsKLQotCXJxID0gaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVzdChj
ZSk7Ci0JaWYgKElTX0VSUihycSkpCi0JCXJldHVybiBQVFJfRVJSKHJxKTsKLQotCWNzID0gaW50
ZWxfcmluZ19iZWdpbihycSwgNCk7Ci0JaWYgKElTX0VSUihjcykpIHsKLQkJaTkxNV9yZXF1ZXN0
X2FkZChycSk7Ci0JCXJldHVybiBQVFJfRVJSKGNzKTsKLQl9Ci0KLQkqY3MrKyA9IE1JX1NUT1JF
X0RXT1JEX0lNTV9HRU40IHwgTUlfVVNFX0dHVFQ7Ci0JKmNzKysgPSBvZmZzZXQ7Ci0JKmNzKysg
PSAwOwotCSpjcysrID0gMTsKLQotCWludGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOwotCi0JcnEt
PnNjaGVkLmF0dHIucHJpb3JpdHkgPSBJOTE1X1BSSU9SSVRZX0JBUlJJRVI7Ci0JaTkxNV9yZXF1
ZXN0X2FkZChycSk7Ci0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQgY29udGV4dF9mbHVzaChz
dHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIGxvbmcgdGltZW91dCkKLXsKLQlzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICpycTsKLQlzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZTsKLQlpbnQgZXJyID0gMDsKLQot
CXJxID0gaW50ZWxfZW5naW5lX2NyZWF0ZV9rZXJuZWxfcmVxdWVzdChjZS0+ZW5naW5lKTsKLQlp
ZiAoSVNfRVJSKHJxKSkKLQkJcmV0dXJuIFBUUl9FUlIocnEpOwotCi0JZmVuY2UgPSBpOTE1X2Fj
dGl2ZV9mZW5jZV9nZXQoJmNlLT50aW1lbGluZS0+bGFzdF9yZXF1ZXN0KTsKLQlpZiAoZmVuY2Up
IHsKLQkJaTkxNV9yZXF1ZXN0X2F3YWl0X2RtYV9mZW5jZShycSwgZmVuY2UpOwotCQlkbWFfZmVu
Y2VfcHV0KGZlbmNlKTsKLQl9Ci0KLQlycSA9IGk5MTVfcmVxdWVzdF9nZXQocnEpOwotCWk5MTVf
cmVxdWVzdF9hZGQocnEpOwotCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgdGltZW91dCkg
PCAwKQotCQllcnIgPSAtRVRJTUU7Ci0JaTkxNV9yZXF1ZXN0X3B1dChycSk7Ci0KLQlybWIoKTsg
LyogV2Uga25vdyB0aGUgcmVxdWVzdCBpcyB3cml0dGVuLCBtYWtlIHN1cmUgYWxsIHN0YXRlIGlz
IHRvbyEgKi8KLQlyZXR1cm4gZXJyOwotfQotCi1zdGF0aWMgaW50IGxpdmVfbHJjX2xheW91dCh2
b2lkICphcmcpCi17Ci0Jc3RydWN0IGludGVsX2d0ICpndCA9IGFyZzsKLQlzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmU7Ci0JZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Ci0JdTMyICpscmM7
Ci0JaW50IGVycjsKLQotCS8qCi0JICogQ2hlY2sgdGhlIHJlZ2lzdGVycyBvZmZzZXRzIHdlIHVz
ZSB0byBjcmVhdGUgdGhlIGluaXRpYWwgcmVnIHN0YXRlCi0JICogbWF0Y2ggdGhlIGxheW91dCBz
YXZlZCBieSBIVy4KLQkgKi8KLQotCWxyYyA9IGttYWxsb2MoUEFHRV9TSVpFLCBHRlBfS0VSTkVM
KTsKLQlpZiAoIWxyYykKLQkJcmV0dXJuIC1FTk9NRU07Ci0KLQllcnIgPSAwOwotCWZvcl9lYWNo
X2VuZ2luZShlbmdpbmUsIGd0LCBpZCkgewotCQl1MzIgKmh3OwotCQlpbnQgZHc7Ci0KLQkJaWYg
KCFlbmdpbmUtPmRlZmF1bHRfc3RhdGUpCi0JCQljb250aW51ZTsKLQotCQlodyA9IHNobWVtX3Bp
bl9tYXAoZW5naW5lLT5kZWZhdWx0X3N0YXRlKTsKLQkJaWYgKElTX0VSUihodykpIHsKLQkJCWVy
ciA9IFBUUl9FUlIoaHcpOwotCQkJYnJlYWs7Ci0JCX0KLQkJaHcgKz0gTFJDX1NUQVRFX09GRlNF
VCAvIHNpemVvZigqaHcpOwotCi0JCWV4ZWNsaXN0c19pbml0X3JlZ19zdGF0ZShtZW1zZXQobHJj
LCBQT0lTT05fSU5VU0UsIFBBR0VfU0laRSksCi0JCQkJCSBlbmdpbmUtPmtlcm5lbF9jb250ZXh0
LAotCQkJCQkgZW5naW5lLAotCQkJCQkgZW5naW5lLT5rZXJuZWxfY29udGV4dC0+cmluZywKLQkJ
CQkJIHRydWUpOwotCi0JCWR3ID0gMDsKLQkJZG8gewotCQkJdTMyIGxyaSA9IGh3W2R3XTsKLQot
CQkJaWYgKGxyaSA9PSAwKSB7Ci0JCQkJZHcrKzsKLQkJCQljb250aW51ZTsKLQkJCX0KLQotCQkJ
aWYgKGxyY1tkd10gPT0gMCkgewotCQkJCXByX2RlYnVnKCIlczogc2tpcHBlZCBpbnN0cnVjdGlv
biAleCBhdCBkd29yZCAlZFxuIiwKLQkJCQkJIGVuZ2luZS0+bmFtZSwgbHJpLCBkdyk7Ci0JCQkJ
ZHcrKzsKLQkJCQljb250aW51ZTsKLQkJCX0KLQotCQkJaWYgKChscmkgJiBHRU5NQVNLKDMxLCAy
MykpICE9IE1JX0lOU1RSKDB4MjIsIDApKSB7Ci0JCQkJcHJfZXJyKCIlczogRXhwZWN0ZWQgTFJJ
IGNvbW1hbmQgYXQgZHdvcmQgJWQsIGZvdW5kICUwOHhcbiIsCi0JCQkJICAgICAgIGVuZ2luZS0+
bmFtZSwgZHcsIGxyaSk7Ci0JCQkJZXJyID0gLUVJTlZBTDsKLQkJCQlicmVhazsKLQkJCX0KLQot
CQkJaWYgKGxyY1tkd10gIT0gbHJpKSB7Ci0JCQkJcHJfZXJyKCIlczogTFJJIGNvbW1hbmQgbWlz
bWF0Y2ggYXQgZHdvcmQgJWQsIGV4cGVjdGVkICUwOHggZm91bmQgJTA4eFxuIiwKLQkJCQkgICAg
ICAgZW5naW5lLT5uYW1lLCBkdywgbHJpLCBscmNbZHddKTsKLQkJCQllcnIgPSAtRUlOVkFMOwot
CQkJCWJyZWFrOwotCQkJfQotCi0JCQlscmkgJj0gMHg3ZjsKLQkJCWxyaSsrOwotCQkJZHcrKzsK
LQotCQkJd2hpbGUgKGxyaSkgewotCQkJCWlmIChod1tkd10gIT0gbHJjW2R3XSkgewotCQkJCQlw
cl9lcnIoIiVzOiBEaWZmZXJlbnQgcmVnaXN0ZXJzIGZvdW5kIGF0IGR3b3JkICVkLCBleHBlY3Rl
ZCAleCwgZm91bmQgJXhcbiIsCi0JCQkJCSAgICAgICBlbmdpbmUtPm5hbWUsIGR3LCBod1tkd10s
IGxyY1tkd10pOwotCQkJCQllcnIgPSAtRUlOVkFMOwotCQkJCQlicmVhazsKLQkJCQl9Ci0KLQkJ
CQkvKgotCQkJCSAqIFNraXAgb3ZlciB0aGUgYWN0dWFsIHJlZ2lzdGVyIHZhbHVlIGFzIHdlCi0J
CQkJICogZXhwZWN0IHRoYXQgdG8gZGlmZmVyLgotCQkJCSAqLwotCQkJCWR3ICs9IDI7Ci0JCQkJ
bHJpIC09IDI7Ci0JCQl9Ci0JCX0gd2hpbGUgKChscmNbZHddICYgfkJJVCgwKSkgIT0gTUlfQkFU
Q0hfQlVGRkVSX0VORCk7Ci0KLQkJaWYgKGVycikgewotCQkJcHJfaW5mbygiJXM6IEhXIHJlZ2lz
dGVyIGltYWdlOlxuIiwgZW5naW5lLT5uYW1lKTsKLQkJCWlndF9oZXhkdW1wKGh3LCBQQUdFX1NJ
WkUpOwotCi0JCQlwcl9pbmZvKCIlczogU1cgcmVnaXN0ZXIgaW1hZ2U6XG4iLCBlbmdpbmUtPm5h
bWUpOwotCQkJaWd0X2hleGR1bXAobHJjLCBQQUdFX1NJWkUpOwotCQl9Ci0KLQkJc2htZW1fdW5w
aW5fbWFwKGVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSwgaHcpOwotCQlpZiAoZXJyKQotCQkJYnJlYWs7
Ci0JfQotCi0Ja2ZyZWUobHJjKTsKLQlyZXR1cm4gZXJyOwotfQotCi1zdGF0aWMgaW50IGZpbmRf
b2Zmc2V0KGNvbnN0IHUzMiAqbHJpLCB1MzIgb2Zmc2V0KQotewotCWludCBpOwotCi0JZm9yIChp
ID0gMDsgaSA8IFBBR0VfU0laRSAvIHNpemVvZih1MzIpOyBpKyspCi0JCWlmIChscmlbaV0gPT0g
b2Zmc2V0KQotCQkJcmV0dXJuIGk7Ci0KLQlyZXR1cm4gLTE7Ci19Ci0KLXN0YXRpYyBpbnQgbGl2
ZV9scmNfZml4ZWQodm9pZCAqYXJnKQotewotCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7Ci0J
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCWVudW0gaW50ZWxfZW5naW5lX2lkIGlk
OwotCWludCBlcnIgPSAwOwotCi0JLyoKLQkgKiBDaGVjayB0aGUgYXNzdW1lZCByZWdpc3RlciBv
ZmZzZXRzIG1hdGNoIHRoZSBhY3R1YWwgbG9jYXRpb25zIGluCi0JICogdGhlIGNvbnRleHQgaW1h
Z2UuCi0JICovCi0KLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndCwgaWQpIHsKLQkJY29uc3Qg
c3RydWN0IHsKLQkJCXUzMiByZWc7Ci0JCQl1MzIgb2Zmc2V0OwotCQkJY29uc3QgY2hhciAqbmFt
ZTsKLQkJfSB0YmxbXSA9IHsKLQkJCXsKLQkJCQlpOTE1X21taW9fcmVnX29mZnNldChSSU5HX1NU
QVJUKGVuZ2luZS0+bW1pb19iYXNlKSksCi0JCQkJQ1RYX1JJTkdfU1RBUlQgLSAxLAotCQkJCSJS
SU5HX1NUQVJUIgotCQkJfSwKLQkJCXsKLQkJCQlpOTE1X21taW9fcmVnX29mZnNldChSSU5HX0NU
TChlbmdpbmUtPm1taW9fYmFzZSkpLAotCQkJCUNUWF9SSU5HX0NUTCAtIDEsCi0JCQkJIlJJTkdf
Q1RMIgotCQkJfSwKLQkJCXsKLQkJCQlpOTE1X21taW9fcmVnX29mZnNldChSSU5HX0hFQUQoZW5n
aW5lLT5tbWlvX2Jhc2UpKSwKLQkJCQlDVFhfUklOR19IRUFEIC0gMSwKLQkJCQkiUklOR19IRUFE
IgotCQkJfSwKLQkJCXsKLQkJCQlpOTE1X21taW9fcmVnX29mZnNldChSSU5HX1RBSUwoZW5naW5l
LT5tbWlvX2Jhc2UpKSwKLQkJCQlDVFhfUklOR19UQUlMIC0gMSwKLQkJCQkiUklOR19UQUlMIgot
CQkJfSwKLQkJCXsKLQkJCQlpOTE1X21taW9fcmVnX29mZnNldChSSU5HX01JX01PREUoZW5naW5l
LT5tbWlvX2Jhc2UpKSwKLQkJCQlscmNfcmluZ19taV9tb2RlKGVuZ2luZSksCi0JCQkJIlJJTkdf
TUlfTU9ERSIKLQkJCX0sCi0JCQl7Ci0JCQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19CQlNU
QVRFKGVuZ2luZS0+bW1pb19iYXNlKSksCi0JCQkJQ1RYX0JCX1NUQVRFIC0gMSwKLQkJCQkiQkJf
U1RBVEUiCi0JCQl9LAotCQkJewotCQkJCWk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfQkJfUEVS
X0NUWF9QVFIoZW5naW5lLT5tbWlvX2Jhc2UpKSwKLQkJCQlscmNfcmluZ193YV9iYl9wZXJfY3R4
KGVuZ2luZSksCi0JCQkJIlJJTkdfQkJfUEVSX0NUWF9QVFIiCi0JCQl9LAotCQkJewotCQkJCWk5
MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfSU5ESVJFQ1RfQ1RYKGVuZ2luZS0+bW1pb19iYXNlKSks
Ci0JCQkJbHJjX3JpbmdfaW5kaXJlY3RfcHRyKGVuZ2luZSksCi0JCQkJIlJJTkdfSU5ESVJFQ1Rf
Q1RYX1BUUiIKLQkJCX0sCi0JCQl7Ci0JCQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19JTkRJ
UkVDVF9DVFhfT0ZGU0VUKGVuZ2luZS0+bW1pb19iYXNlKSksCi0JCQkJbHJjX3JpbmdfaW5kaXJl
Y3Rfb2Zmc2V0KGVuZ2luZSksCi0JCQkJIlJJTkdfSU5ESVJFQ1RfQ1RYX09GRlNFVCIKLQkJCX0s
Ci0JCQl7Ci0JCQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19DVFhfVElNRVNUQU1QKGVuZ2lu
ZS0+bW1pb19iYXNlKSksCi0JCQkJQ1RYX1RJTUVTVEFNUCAtIDEsCi0JCQkJIlJJTkdfQ1RYX1RJ
TUVTVEFNUCIKLQkJCX0sCi0JCQl7Ci0JCQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9SSU5H
X0NTX0dQUihlbmdpbmUtPm1taW9fYmFzZSwgMCkpLAotCQkJCWxyY19yaW5nX2dwcjAoZW5naW5l
KSwKLQkJCQkiUklOR19DU19HUFIwIgotCQkJfSwKLQkJCXsKLQkJCQlpOTE1X21taW9fcmVnX29m
ZnNldChSSU5HX0NNRF9CVUZfQ0NUTChlbmdpbmUtPm1taW9fYmFzZSkpLAotCQkJCWxyY19yaW5n
X2NtZF9idWZfY2N0bChlbmdpbmUpLAotCQkJCSJSSU5HX0NNRF9CVUZfQ0NUTCIKLQkJCX0sCi0J
CQl7IH0sCi0JCX0sICp0OwotCQl1MzIgKmh3OwotCi0JCWlmICghZW5naW5lLT5kZWZhdWx0X3N0
YXRlKQotCQkJY29udGludWU7Ci0KLQkJaHcgPSBzaG1lbV9waW5fbWFwKGVuZ2luZS0+ZGVmYXVs
dF9zdGF0ZSk7Ci0JCWlmIChJU19FUlIoaHcpKSB7Ci0JCQllcnIgPSBQVFJfRVJSKGh3KTsKLQkJ
CWJyZWFrOwotCQl9Ci0JCWh3ICs9IExSQ19TVEFURV9PRkZTRVQgLyBzaXplb2YoKmh3KTsKLQot
CQlmb3IgKHQgPSB0Ymw7IHQtPm5hbWU7IHQrKykgewotCQkJaW50IGR3ID0gZmluZF9vZmZzZXQo
aHcsIHQtPnJlZyk7Ci0KLQkJCWlmIChkdyAhPSB0LT5vZmZzZXQpIHsKLQkJCQlwcl9lcnIoIiVz
OiBPZmZzZXQgZm9yICVzIFsweCV4XSBtaXNtYXRjaCwgZm91bmQgJXgsIGV4cGVjdGVkICV4XG4i
LAotCQkJCSAgICAgICBlbmdpbmUtPm5hbWUsCi0JCQkJICAgICAgIHQtPm5hbWUsCi0JCQkJICAg
ICAgIHQtPnJlZywKLQkJCQkgICAgICAgZHcsCi0JCQkJICAgICAgIHQtPm9mZnNldCk7Ci0JCQkJ
ZXJyID0gLUVJTlZBTDsKLQkJCX0KLQkJfQotCi0JCXNobWVtX3VucGluX21hcChlbmdpbmUtPmRl
ZmF1bHRfc3RhdGUsIGh3KTsKLQl9Ci0KLQlyZXR1cm4gZXJyOwotfQotCi1zdGF0aWMgaW50IF9f
bGl2ZV9scmNfc3RhdGUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAotCQkJICAgIHN0
cnVjdCBpOTE1X3ZtYSAqc2NyYXRjaCkKLXsKLQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7Ci0J
c3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7Ci0Jc3RydWN0IGk5MTVfZ2VtX3d3X2N0eCB3dzsKLQll
bnVtIHsKLQkJUklOR19TVEFSVF9JRFggPSAwLAotCQlSSU5HX1RBSUxfSURYLAotCQlNQVhfSURY
Ci0JfTsKLQl1MzIgZXhwZWN0ZWRbTUFYX0lEWF07Ci0JdTMyICpjczsKLQlpbnQgZXJyOwotCWlu
dCBuOwotCi0JY2UgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZShlbmdpbmUpOwotCWlmIChJU19FUlIo
Y2UpKQotCQlyZXR1cm4gUFRSX0VSUihjZSk7Ci0KLQlpOTE1X2dlbV93d19jdHhfaW5pdCgmd3cs
IGZhbHNlKTsKLXJldHJ5OgotCWVyciA9IGk5MTVfZ2VtX29iamVjdF9sb2NrKHNjcmF0Y2gtPm9i
aiwgJnd3KTsKLQlpZiAoIWVycikKLQkJZXJyID0gaW50ZWxfY29udGV4dF9waW5fd3coY2UsICZ3
dyk7Ci0JaWYgKGVycikKLQkJZ290byBlcnJfcHV0OwotCi0JcnEgPSBpOTE1X3JlcXVlc3RfY3Jl
YXRlKGNlKTsKLQlpZiAoSVNfRVJSKHJxKSkgewotCQllcnIgPSBQVFJfRVJSKHJxKTsKLQkJZ290
byBlcnJfdW5waW47Ci0JfQotCi0JY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJxLCA0ICogTUFYX0lE
WCk7Ci0JaWYgKElTX0VSUihjcykpIHsKLQkJZXJyID0gUFRSX0VSUihjcyk7Ci0JCWk5MTVfcmVx
dWVzdF9hZGQocnEpOwotCQlnb3RvIGVycl91bnBpbjsKLQl9Ci0KLQkqY3MrKyA9IE1JX1NUT1JF
X1JFR0lTVEVSX01FTV9HRU44IHwgTUlfVVNFX0dHVFQ7Ci0JKmNzKysgPSBpOTE1X21taW9fcmVn
X29mZnNldChSSU5HX1NUQVJUKGVuZ2luZS0+bW1pb19iYXNlKSk7Ci0JKmNzKysgPSBpOTE1X2dn
dHRfb2Zmc2V0KHNjcmF0Y2gpICsgUklOR19TVEFSVF9JRFggKiBzaXplb2YodTMyKTsKLQkqY3Mr
KyA9IDA7Ci0KLQlleHBlY3RlZFtSSU5HX1NUQVJUX0lEWF0gPSBpOTE1X2dndHRfb2Zmc2V0KGNl
LT5yaW5nLT52bWEpOwotCi0JKmNzKysgPSBNSV9TVE9SRV9SRUdJU1RFUl9NRU1fR0VOOCB8IE1J
X1VTRV9HR1RUOwotCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19UQUlMKGVuZ2lu
ZS0+bW1pb19iYXNlKSk7Ci0JKmNzKysgPSBpOTE1X2dndHRfb2Zmc2V0KHNjcmF0Y2gpICsgUklO
R19UQUlMX0lEWCAqIHNpemVvZih1MzIpOwotCSpjcysrID0gMDsKLQotCWVyciA9IGk5MTVfcmVx
dWVzdF9hd2FpdF9vYmplY3QocnEsIHNjcmF0Y2gtPm9iaiwgdHJ1ZSk7Ci0JaWYgKCFlcnIpCi0J
CWVyciA9IGk5MTVfdm1hX21vdmVfdG9fYWN0aXZlKHNjcmF0Y2gsIHJxLCBFWEVDX09CSkVDVF9X
UklURSk7Ci0KLQlpOTE1X3JlcXVlc3RfZ2V0KHJxKTsKLQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsK
LQlpZiAoZXJyKQotCQlnb3RvIGVycl9ycTsKLQotCWludGVsX2VuZ2luZV9mbHVzaF9zdWJtaXNz
aW9uKGVuZ2luZSk7Ci0JZXhwZWN0ZWRbUklOR19UQUlMX0lEWF0gPSBjZS0+cmluZy0+dGFpbDsK
LQotCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgSFogLyA1KSA8IDApIHsKLQkJZXJyID0g
LUVUSU1FOwotCQlnb3RvIGVycl9ycTsKLQl9Ci0KLQljcyA9IGk5MTVfZ2VtX29iamVjdF9waW5f
bWFwKHNjcmF0Y2gtPm9iaiwgSTkxNV9NQVBfV0IpOwotCWlmIChJU19FUlIoY3MpKSB7Ci0JCWVy
ciA9IFBUUl9FUlIoY3MpOwotCQlnb3RvIGVycl9ycTsKLQl9Ci0KLQlmb3IgKG4gPSAwOyBuIDwg
TUFYX0lEWDsgbisrKSB7Ci0JCWlmIChjc1tuXSAhPSBleHBlY3RlZFtuXSkgewotCQkJcHJfZXJy
KCIlczogU3RvcmVkIHJlZ2lzdGVyWyVkXSB2YWx1ZVsweCV4XSBkaWQgbm90IG1hdGNoIGV4cGVj
dGVkWzB4JXhdXG4iLAotCQkJICAgICAgIGVuZ2luZS0+bmFtZSwgbiwgY3Nbbl0sIGV4cGVjdGVk
W25dKTsKLQkJCWVyciA9IC1FSU5WQUw7Ci0JCQlicmVhazsKLQkJfQotCX0KLQotCWk5MTVfZ2Vt
X29iamVjdF91bnBpbl9tYXAoc2NyYXRjaC0+b2JqKTsKLQotZXJyX3JxOgotCWk5MTVfcmVxdWVz
dF9wdXQocnEpOwotZXJyX3VucGluOgotCWludGVsX2NvbnRleHRfdW5waW4oY2UpOwotZXJyX3B1
dDoKLQlpZiAoZXJyID09IC1FREVBRExLKSB7Ci0JCWVyciA9IGk5MTVfZ2VtX3d3X2N0eF9iYWNr
b2ZmKCZ3dyk7Ci0JCWlmICghZXJyKQotCQkJZ290byByZXRyeTsKLQl9Ci0JaTkxNV9nZW1fd3df
Y3R4X2ZpbmkoJnd3KTsKLQlpbnRlbF9jb250ZXh0X3B1dChjZSk7Ci0JcmV0dXJuIGVycjsKLX0K
LQotc3RhdGljIGludCBsaXZlX2xyY19zdGF0ZSh2b2lkICphcmcpCi17Ci0Jc3RydWN0IGludGVs
X2d0ICpndCA9IGFyZzsKLQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0Jc3RydWN0
IGk5MTVfdm1hICpzY3JhdGNoOwotCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwotCWludCBlcnIg
PSAwOwotCi0JLyoKLQkgKiBDaGVjayB0aGUgbGl2ZSByZWdpc3RlciBzdGF0ZSBtYXRjaGVzIHdo
YXQgd2UgZXhwZWN0IGZvciB0aGlzCi0JICogaW50ZWxfY29udGV4dC4KLQkgKi8KLQotCXNjcmF0
Y2ggPSBjcmVhdGVfc2NyYXRjaChndCk7Ci0JaWYgKElTX0VSUihzY3JhdGNoKSkKLQkJcmV0dXJu
IFBUUl9FUlIoc2NyYXRjaCk7Ci0KLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndCwgaWQpIHsK
LQkJZXJyID0gX19saXZlX2xyY19zdGF0ZShlbmdpbmUsIHNjcmF0Y2gpOwotCQlpZiAoZXJyKQot
CQkJYnJlYWs7Ci0JfQotCi0JaWYgKGlndF9mbHVzaF90ZXN0KGd0LT5pOTE1KSkKLQkJZXJyID0g
LUVJTzsKLQotCWk5MTVfdm1hX3VucGluX2FuZF9yZWxlYXNlKCZzY3JhdGNoLCAwKTsKLQlyZXR1
cm4gZXJyOwotfQotCi1zdGF0aWMgaW50IGdwcl9tYWtlX2RpcnR5KHN0cnVjdCBpbnRlbF9jb250
ZXh0ICpjZSkKLXsKLQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKLQl1MzIgKmNzOwotCWludCBu
OwotCi0JcnEgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZV9yZXF1ZXN0KGNlKTsKLQlpZiAoSVNfRVJS
KHJxKSkKLQkJcmV0dXJuIFBUUl9FUlIocnEpOwotCi0JY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJx
LCAyICogTlVNX0dQUl9EVyArIDIpOwotCWlmIChJU19FUlIoY3MpKSB7Ci0JCWk5MTVfcmVxdWVz
dF9hZGQocnEpOwotCQlyZXR1cm4gUFRSX0VSUihjcyk7Ci0JfQotCi0JKmNzKysgPSBNSV9MT0FE
X1JFR0lTVEVSX0lNTShOVU1fR1BSX0RXKTsKLQlmb3IgKG4gPSAwOyBuIDwgTlVNX0dQUl9EVzsg
bisrKSB7Ci0JCSpjcysrID0gQ1NfR1BSKGNlLT5lbmdpbmUsIG4pOwotCQkqY3MrKyA9IFNUQUNL
X01BR0lDOwotCX0KLQkqY3MrKyA9IE1JX05PT1A7Ci0KLQlpbnRlbF9yaW5nX2FkdmFuY2UocnEs
IGNzKTsKLQotCXJxLT5zY2hlZC5hdHRyLnByaW9yaXR5ID0gSTkxNV9QUklPUklUWV9CQVJSSUVS
OwotCWk5MTVfcmVxdWVzdF9hZGQocnEpOwotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBzdHJ1
Y3QgaTkxNV9yZXF1ZXN0ICoKLV9fZ3ByX3JlYWQoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCBz
dHJ1Y3QgaTkxNV92bWEgKnNjcmF0Y2gsIHUzMiAqc2xvdCkKLXsKLQljb25zdCB1MzIgb2Zmc2V0
ID0KLQkJaTkxNV9nZ3R0X29mZnNldChjZS0+ZW5naW5lLT5zdGF0dXNfcGFnZS52bWEpICsKLQkJ
b2Zmc2V0X2luX3BhZ2Uoc2xvdCk7Ci0Jc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7Ci0JdTMyICpj
czsKLQlpbnQgZXJyOwotCWludCBuOwotCi0JcnEgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZV9yZXF1
ZXN0KGNlKTsKLQlpZiAoSVNfRVJSKHJxKSkKLQkJcmV0dXJuIHJxOwotCi0JY3MgPSBpbnRlbF9y
aW5nX2JlZ2luKHJxLCA2ICsgNCAqIE5VTV9HUFJfRFcpOwotCWlmIChJU19FUlIoY3MpKSB7Ci0J
CWk5MTVfcmVxdWVzdF9hZGQocnEpOwotCQlyZXR1cm4gRVJSX0NBU1QoY3MpOwotCX0KLQotCSpj
cysrID0gTUlfQVJCX09OX09GRiB8IE1JX0FSQl9FTkFCTEU7Ci0JKmNzKysgPSBNSV9OT09QOwot
Ci0JKmNzKysgPSBNSV9TRU1BUEhPUkVfV0FJVCB8Ci0JCU1JX1NFTUFQSE9SRV9HTE9CQUxfR1RU
IHwKLQkJTUlfU0VNQVBIT1JFX1BPTEwgfAotCQlNSV9TRU1BUEhPUkVfU0FEX05FUV9TREQ7Ci0J
KmNzKysgPSAwOwotCSpjcysrID0gb2Zmc2V0OwotCSpjcysrID0gMDsKLQotCWZvciAobiA9IDA7
IG4gPCBOVU1fR1BSX0RXOyBuKyspIHsKLQkJKmNzKysgPSBNSV9TVE9SRV9SRUdJU1RFUl9NRU1f
R0VOOCB8IE1JX1VTRV9HR1RUOwotCQkqY3MrKyA9IENTX0dQUihjZS0+ZW5naW5lLCBuKTsKLQkJ
KmNzKysgPSBpOTE1X2dndHRfb2Zmc2V0KHNjcmF0Y2gpICsgbiAqIHNpemVvZih1MzIpOwotCQkq
Y3MrKyA9IDA7Ci0JfQotCi0JaTkxNV92bWFfbG9jayhzY3JhdGNoKTsKLQllcnIgPSBpOTE1X3Jl
cXVlc3RfYXdhaXRfb2JqZWN0KHJxLCBzY3JhdGNoLT5vYmosIHRydWUpOwotCWlmICghZXJyKQot
CQllcnIgPSBpOTE1X3ZtYV9tb3ZlX3RvX2FjdGl2ZShzY3JhdGNoLCBycSwgRVhFQ19PQkpFQ1Rf
V1JJVEUpOwotCWk5MTVfdm1hX3VubG9jayhzY3JhdGNoKTsKLQotCWk5MTVfcmVxdWVzdF9nZXQo
cnEpOwotCWk5MTVfcmVxdWVzdF9hZGQocnEpOwotCWlmIChlcnIpIHsKLQkJaTkxNV9yZXF1ZXN0
X3B1dChycSk7Ci0JCXJxID0gRVJSX1BUUihlcnIpOwotCX0KLQotCXJldHVybiBycTsKLX0KLQot
c3RhdGljIGludCBfX2xpdmVfbHJjX2dwcihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUs
Ci0JCQkgIHN0cnVjdCBpOTE1X3ZtYSAqc2NyYXRjaCwKLQkJCSAgYm9vbCBwcmVlbXB0KQotewot
CXUzMiAqc2xvdCA9IG1lbXNldDMyKGVuZ2luZS0+c3RhdHVzX3BhZ2UuYWRkciArIDEwMDAsIDAs
IDQpOwotCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsKLQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpy
cTsKLQl1MzIgKmNzOwotCWludCBlcnI7Ci0JaW50IG47Ci0KLQlpZiAoSU5URUxfR0VOKGVuZ2lu
ZS0+aTkxNSkgPCA5ICYmIGVuZ2luZS0+Y2xhc3MgIT0gUkVOREVSX0NMQVNTKQotCQlyZXR1cm4g
MDsgLyogR1BSIG9ubHkgb24gcmNzMCBmb3IgZ2VuOCAqLwotCi0JZXJyID0gZ3ByX21ha2VfZGly
dHkoZW5naW5lLT5rZXJuZWxfY29udGV4dCk7Ci0JaWYgKGVycikKLQkJcmV0dXJuIGVycjsKLQot
CWNlID0gaW50ZWxfY29udGV4dF9jcmVhdGUoZW5naW5lKTsKLQlpZiAoSVNfRVJSKGNlKSkKLQkJ
cmV0dXJuIFBUUl9FUlIoY2UpOwotCi0JcnEgPSBfX2dwcl9yZWFkKGNlLCBzY3JhdGNoLCBzbG90
KTsKLQlpZiAoSVNfRVJSKHJxKSkgewotCQllcnIgPSBQVFJfRVJSKHJxKTsKLQkJZ290byBlcnJf
cHV0OwotCX0KLQotCWVyciA9IHdhaXRfZm9yX3N1Ym1pdChlbmdpbmUsIHJxLCBIWiAvIDIpOwot
CWlmIChlcnIpCi0JCWdvdG8gZXJyX3JxOwotCi0JaWYgKHByZWVtcHQpIHsKLQkJZXJyID0gZ3By
X21ha2VfZGlydHkoZW5naW5lLT5rZXJuZWxfY29udGV4dCk7Ci0JCWlmIChlcnIpCi0JCQlnb3Rv
IGVycl9ycTsKLQotCQllcnIgPSBlbWl0X3NlbWFwaG9yZV9zaWduYWwoZW5naW5lLT5rZXJuZWxf
Y29udGV4dCwgc2xvdCk7Ci0JCWlmIChlcnIpCi0JCQlnb3RvIGVycl9ycTsKLQl9IGVsc2Ugewot
CQlzbG90WzBdID0gMTsKLQkJd21iKCk7Ci0JfQotCi0JaWYgKGk5MTVfcmVxdWVzdF93YWl0KHJx
LCAwLCBIWiAvIDUpIDwgMCkgewotCQllcnIgPSAtRVRJTUU7Ci0JCWdvdG8gZXJyX3JxOwotCX0K
LQotCWNzID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAoc2NyYXRjaC0+b2JqLCBJOTE1X01BUF9X
Qik7Ci0JaWYgKElTX0VSUihjcykpIHsKLQkJZXJyID0gUFRSX0VSUihjcyk7Ci0JCWdvdG8gZXJy
X3JxOwotCX0KLQotCWZvciAobiA9IDA7IG4gPCBOVU1fR1BSX0RXOyBuKyspIHsKLQkJaWYgKGNz
W25dKSB7Ci0JCQlwcl9lcnIoIiVzOiBHUFJbJWRdLiVzIHdhcyBub3QgemVybywgZm91bmQgMHgl
MDh4IVxuIiwKLQkJCSAgICAgICBlbmdpbmUtPm5hbWUsCi0JCQkgICAgICAgbiAvIDIsIG4gJiAx
ID8gInVkdyIgOiAibGR3IiwKLQkJCSAgICAgICBjc1tuXSk7Ci0JCQllcnIgPSAtRUlOVkFMOwot
CQkJYnJlYWs7Ci0JCX0KLQl9Ci0KLQlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHNjcmF0Y2gt
Pm9iaik7Ci0KLWVycl9ycToKLQltZW1zZXQzMigmc2xvdFswXSwgLTEsIDQpOwotCXdtYigpOwot
CWk5MTVfcmVxdWVzdF9wdXQocnEpOwotZXJyX3B1dDoKLQlpbnRlbF9jb250ZXh0X3B1dChjZSk7
Ci0JcmV0dXJuIGVycjsKLX0KLQotc3RhdGljIGludCBsaXZlX2xyY19ncHIodm9pZCAqYXJnKQot
ewotCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7Ci0Jc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lOwotCXN0cnVjdCBpOTE1X3ZtYSAqc2NyYXRjaDsKLQllbnVtIGludGVsX2VuZ2luZV9p
ZCBpZDsKLQlpbnQgZXJyID0gMDsKLQotCS8qCi0JICogQ2hlY2sgdGhhdCBHUFIgcmVnaXN0ZXJz
IGFyZSBjbGVhcmVkIGluIG5ldyBjb250ZXh0cyBhcyB3ZSBuZWVkCi0JICogdG8gYXZvaWQgbGVh
a2luZyBhbnkgaW5mb3JtYXRpb24gZnJvbSBwcmV2aW91cyBjb250ZXh0cy4KLQkgKi8KLQotCXNj
cmF0Y2ggPSBjcmVhdGVfc2NyYXRjaChndCk7Ci0JaWYgKElTX0VSUihzY3JhdGNoKSkKLQkJcmV0
dXJuIFBUUl9FUlIoc2NyYXRjaCk7Ci0KLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndCwgaWQp
IHsKLQkJc3RfZW5naW5lX2hlYXJ0YmVhdF9kaXNhYmxlKGVuZ2luZSk7Ci0KLQkJZXJyID0gX19s
aXZlX2xyY19ncHIoZW5naW5lLCBzY3JhdGNoLCBmYWxzZSk7Ci0JCWlmIChlcnIpCi0JCQlnb3Rv
IGVycjsKLQotCQllcnIgPSBfX2xpdmVfbHJjX2dwcihlbmdpbmUsIHNjcmF0Y2gsIHRydWUpOwot
CQlpZiAoZXJyKQotCQkJZ290byBlcnI7Ci0KLWVycjoKLQkJc3RfZW5naW5lX2hlYXJ0YmVhdF9l
bmFibGUoZW5naW5lKTsKLQkJaWYgKGlndF9mbHVzaF90ZXN0KGd0LT5pOTE1KSkKLQkJCWVyciA9
IC1FSU87Ci0JCWlmIChlcnIpCi0JCQlicmVhazsKLQl9Ci0KLQlpOTE1X3ZtYV91bnBpbl9hbmRf
cmVsZWFzZSgmc2NyYXRjaCwgMCk7Ci0JcmV0dXJuIGVycjsKLX0KLQotc3RhdGljIHN0cnVjdCBp
OTE1X3JlcXVlc3QgKgotY3JlYXRlX3RpbWVzdGFtcChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2Us
IHZvaWQgKnNsb3QsIGludCBpZHgpCi17Ci0JY29uc3QgdTMyIG9mZnNldCA9Ci0JCWk5MTVfZ2d0
dF9vZmZzZXQoY2UtPmVuZ2luZS0+c3RhdHVzX3BhZ2Uudm1hKSArCi0JCW9mZnNldF9pbl9wYWdl
KHNsb3QpOwotCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOwotCXUzMiAqY3M7Ci0JaW50IGVycjsK
LQotCXJxID0gaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVzdChjZSk7Ci0JaWYgKElTX0VSUihy
cSkpCi0JCXJldHVybiBycTsKLQotCWNzID0gaW50ZWxfcmluZ19iZWdpbihycSwgMTApOwotCWlm
IChJU19FUlIoY3MpKSB7Ci0JCWVyciA9IFBUUl9FUlIoY3MpOwotCQlnb3RvIGVycjsKLQl9Ci0K
LQkqY3MrKyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJfRU5BQkxFOwotCSpjcysrID0gTUlfTk9P
UDsKLQotCSpjcysrID0gTUlfU0VNQVBIT1JFX1dBSVQgfAotCQlNSV9TRU1BUEhPUkVfR0xPQkFM
X0dUVCB8Ci0JCU1JX1NFTUFQSE9SRV9QT0xMIHwKLQkJTUlfU0VNQVBIT1JFX1NBRF9ORVFfU0RE
OwotCSpjcysrID0gMDsKLQkqY3MrKyA9IG9mZnNldDsKLQkqY3MrKyA9IDA7Ci0KLQkqY3MrKyA9
IE1JX1NUT1JFX1JFR0lTVEVSX01FTV9HRU44IHwgTUlfVVNFX0dHVFQ7Ci0JKmNzKysgPSBpOTE1
X21taW9fcmVnX29mZnNldChSSU5HX0NUWF9USU1FU1RBTVAocnEtPmVuZ2luZS0+bW1pb19iYXNl
KSk7Ci0JKmNzKysgPSBvZmZzZXQgKyBpZHggKiBzaXplb2YodTMyKTsKLQkqY3MrKyA9IDA7Ci0K
LQlpbnRlbF9yaW5nX2FkdmFuY2UocnEsIGNzKTsKLQotCXJxLT5zY2hlZC5hdHRyLnByaW9yaXR5
ID0gSTkxNV9QUklPUklUWV9NQVNLOwotCWVyciA9IDA7Ci1lcnI6Ci0JaTkxNV9yZXF1ZXN0X2dl
dChycSk7Ci0JaTkxNV9yZXF1ZXN0X2FkZChycSk7Ci0JaWYgKGVycikgewotCQlpOTE1X3JlcXVl
c3RfcHV0KHJxKTsKLQkJcmV0dXJuIEVSUl9QVFIoZXJyKTsKLQl9Ci0KLQlyZXR1cm4gcnE7Ci19
Ci0KLXN0cnVjdCBscmNfdGltZXN0YW1wIHsKLQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmU7Ci0Jc3RydWN0IGludGVsX2NvbnRleHQgKmNlWzJdOwotCXUzMiBwb2lzb247Ci19OwotCi1z
dGF0aWMgYm9vbCB0aW1lc3RhbXBfYWR2YW5jZWQodTMyIHN0YXJ0LCB1MzIgZW5kKQotewotCXJl
dHVybiAoczMyKShlbmQgLSBzdGFydCkgPiAwOwotfQotCi1zdGF0aWMgaW50IF9fbHJjX3RpbWVz
dGFtcChjb25zdCBzdHJ1Y3QgbHJjX3RpbWVzdGFtcCAqYXJnLCBib29sIHByZWVtcHQpCi17Ci0J
dTMyICpzbG90ID0gbWVtc2V0MzIoYXJnLT5lbmdpbmUtPnN0YXR1c19wYWdlLmFkZHIgKyAxMDAw
LCAwLCA0KTsKLQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKLQl1MzIgdGltZXN0YW1wOwotCWlu
dCBlcnIgPSAwOwotCi0JYXJnLT5jZVswXS0+bHJjX3JlZ19zdGF0ZVtDVFhfVElNRVNUQU1QXSA9
IGFyZy0+cG9pc29uOwotCXJxID0gY3JlYXRlX3RpbWVzdGFtcChhcmctPmNlWzBdLCBzbG90LCAx
KTsKLQlpZiAoSVNfRVJSKHJxKSkKLQkJcmV0dXJuIFBUUl9FUlIocnEpOwotCi0JZXJyID0gd2Fp
dF9mb3Jfc3VibWl0KHJxLT5lbmdpbmUsIHJxLCBIWiAvIDIpOwotCWlmIChlcnIpCi0JCWdvdG8g
ZXJyOwotCi0JaWYgKHByZWVtcHQpIHsKLQkJYXJnLT5jZVsxXS0+bHJjX3JlZ19zdGF0ZVtDVFhf
VElNRVNUQU1QXSA9IDB4ZGVhZGJlZWY7Ci0JCWVyciA9IGVtaXRfc2VtYXBob3JlX3NpZ25hbChh
cmctPmNlWzFdLCBzbG90KTsKLQkJaWYgKGVycikKLQkJCWdvdG8gZXJyOwotCX0gZWxzZSB7Ci0J
CXNsb3RbMF0gPSAxOwotCQl3bWIoKTsKLQl9Ci0KLQkvKiBBbmQgd2FpdCBmb3Igc3dpdGNoIHRv
IGtlcm5lbCAodG8gc2F2ZSBvdXIgY29udGV4dCB0byBtZW1vcnkpICovCi0JZXJyID0gY29udGV4
dF9mbHVzaChhcmctPmNlWzBdLCBIWiAvIDIpOwotCWlmIChlcnIpCi0JCWdvdG8gZXJyOwotCi0J
aWYgKCF0aW1lc3RhbXBfYWR2YW5jZWQoYXJnLT5wb2lzb24sIHNsb3RbMV0pKSB7Ci0JCXByX2Vy
cigiJXMoJXMpOiBpbnZhbGlkIHRpbWVzdGFtcCBvbiByZXN0b3JlLCBjb250ZXh0OiV4LCByZXF1
ZXN0OiV4XG4iLAotCQkgICAgICAgYXJnLT5lbmdpbmUtPm5hbWUsIHByZWVtcHQgPyAicHJlZW1w
dCIgOiAic2ltcGxlIiwKLQkJICAgICAgIGFyZy0+cG9pc29uLCBzbG90WzFdKTsKLQkJZXJyID0g
LUVJTlZBTDsKLQl9Ci0KLQl0aW1lc3RhbXAgPSBSRUFEX09OQ0UoYXJnLT5jZVswXS0+bHJjX3Jl
Z19zdGF0ZVtDVFhfVElNRVNUQU1QXSk7Ci0JaWYgKCF0aW1lc3RhbXBfYWR2YW5jZWQoc2xvdFsx
XSwgdGltZXN0YW1wKSkgewotCQlwcl9lcnIoIiVzKCVzKTogaW52YWxpZCB0aW1lc3RhbXAgb24g
c2F2ZSwgcmVxdWVzdDoleCwgY29udGV4dDoleFxuIiwKLQkJICAgICAgIGFyZy0+ZW5naW5lLT5u
YW1lLCBwcmVlbXB0ID8gInByZWVtcHQiIDogInNpbXBsZSIsCi0JCSAgICAgICBzbG90WzFdLCB0
aW1lc3RhbXApOwotCQllcnIgPSAtRUlOVkFMOwotCX0KLQotZXJyOgotCW1lbXNldDMyKHNsb3Qs
IC0xLCA0KTsKLQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKLQlyZXR1cm4gZXJyOwotfQotCi1zdGF0
aWMgaW50IGxpdmVfbHJjX3RpbWVzdGFtcCh2b2lkICphcmcpCi17Ci0Jc3RydWN0IGxyY190aW1l
c3RhbXAgZGF0YSA9IHt9OwotCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7Ci0JZW51bSBpbnRl
bF9lbmdpbmVfaWQgaWQ7Ci0JY29uc3QgdTMyIHBvaXNvbltdID0gewotCQkwLAotCQlTMzJfTUFY
LAotCQkodTMyKVMzMl9NQVggKyAxLAotCQlVMzJfTUFYLAotCX07Ci0KLQkvKgotCSAqIFdlIHdh
bnQgdG8gdmVyaWZ5IHRoYXQgdGhlIHRpbWVzdGFtcCBpcyBzYXZlZCBhbmQgcmVzdG9yZSBhY3Jv
c3MKLQkgKiBjb250ZXh0IHN3aXRjaGVzIGFuZCBpcyBtb25vdG9uaWMuCi0JICoKLQkgKiBTbyB3
ZSBkbyB0aGlzIHdpdGggYSBsaXR0bGUgYml0IG9mIExSQyBwb2lzb25pbmcgdG8gY2hlY2sgdmFy
aW91cwotCSAqIGJvdW5kYXJ5IGNvbmRpdGlvbnMsIGFuZCBzZWUgd2hhdCBoYXBwZW5zIGlmIHdl
IHByZWVtcHQgdGhlIGNvbnRleHQKLQkgKiB3aXRoIGEgc2Vjb25kIHJlcXVlc3QgKGNhcnJ5aW5n
IG1vcmUgcG9pc29uIGludG8gdGhlIHRpbWVzdGFtcCkuCi0JICovCi0KLQlmb3JfZWFjaF9lbmdp
bmUoZGF0YS5lbmdpbmUsIGd0LCBpZCkgewotCQlpbnQgaSwgZXJyID0gMDsKLQotCQlzdF9lbmdp
bmVfaGVhcnRiZWF0X2Rpc2FibGUoZGF0YS5lbmdpbmUpOwotCi0JCWZvciAoaSA9IDA7IGkgPCBB
UlJBWV9TSVpFKGRhdGEuY2UpOyBpKyspIHsKLQkJCXN0cnVjdCBpbnRlbF9jb250ZXh0ICp0bXA7
Ci0KLQkJCXRtcCA9IGludGVsX2NvbnRleHRfY3JlYXRlKGRhdGEuZW5naW5lKTsKLQkJCWlmIChJ
U19FUlIodG1wKSkgewotCQkJCWVyciA9IFBUUl9FUlIodG1wKTsKLQkJCQlnb3RvIGVycjsKLQkJ
CX0KLQotCQkJZXJyID0gaW50ZWxfY29udGV4dF9waW4odG1wKTsKLQkJCWlmIChlcnIpIHsKLQkJ
CQlpbnRlbF9jb250ZXh0X3B1dCh0bXApOwotCQkJCWdvdG8gZXJyOwotCQkJfQotCi0JCQlkYXRh
LmNlW2ldID0gdG1wOwotCQl9Ci0KLQkJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUocG9pc29u
KTsgaSsrKSB7Ci0JCQlkYXRhLnBvaXNvbiA9IHBvaXNvbltpXTsKLQotCQkJZXJyID0gX19scmNf
dGltZXN0YW1wKCZkYXRhLCBmYWxzZSk7Ci0JCQlpZiAoZXJyKQotCQkJCWJyZWFrOwotCi0JCQll
cnIgPSBfX2xyY190aW1lc3RhbXAoJmRhdGEsIHRydWUpOwotCQkJaWYgKGVycikKLQkJCQlicmVh
azsKLQkJfQotCi1lcnI6Ci0JCXN0X2VuZ2luZV9oZWFydGJlYXRfZW5hYmxlKGRhdGEuZW5naW5l
KTsKLQkJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoZGF0YS5jZSk7IGkrKykgewotCQkJaWYg
KCFkYXRhLmNlW2ldKQotCQkJCWJyZWFrOwotCi0JCQlpbnRlbF9jb250ZXh0X3VucGluKGRhdGEu
Y2VbaV0pOwotCQkJaW50ZWxfY29udGV4dF9wdXQoZGF0YS5jZVtpXSk7Ci0JCX0KLQotCQlpZiAo
aWd0X2ZsdXNoX3Rlc3QoZ3QtPmk5MTUpKQotCQkJZXJyID0gLUVJTzsKLQkJaWYgKGVycikKLQkJ
CXJldHVybiBlcnI7Ci0JfQotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBzdHJ1Y3QgaTkxNV92
bWEgKgotY3JlYXRlX3VzZXJfdm1hKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtLCB1bnNp
Z25lZCBsb25nIHNpemUpCi17Ci0Jc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKLQlz
dHJ1Y3QgaTkxNV92bWEgKnZtYTsKLQlpbnQgZXJyOwotCi0Jb2JqID0gaTkxNV9nZW1fb2JqZWN0
X2NyZWF0ZV9pbnRlcm5hbCh2bS0+aTkxNSwgc2l6ZSk7Ci0JaWYgKElTX0VSUihvYmopKQotCQly
ZXR1cm4gRVJSX0NBU1Qob2JqKTsKLQotCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9iaiwgdm0s
IE5VTEwpOwotCWlmIChJU19FUlIodm1hKSkgewotCQlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7
Ci0JCXJldHVybiB2bWE7Ci0JfQotCi0JZXJyID0gaTkxNV92bWFfcGluKHZtYSwgMCwgMCwgUElO
X1VTRVIpOwotCWlmIChlcnIpIHsKLQkJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOwotCQlyZXR1
cm4gRVJSX1BUUihlcnIpOwotCX0KLQotCXJldHVybiB2bWE7Ci19Ci0KLXN0YXRpYyBzdHJ1Y3Qg
aTkxNV92bWEgKgotc3RvcmVfY29udGV4dChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHN0cnVj
dCBpOTE1X3ZtYSAqc2NyYXRjaCkKLXsKLQlzdHJ1Y3QgaTkxNV92bWEgKmJhdGNoOwotCXUzMiBk
dywgeCwgKmNzLCAqaHc7Ci0JdTMyICpkZWZhdWx0czsKLQotCWJhdGNoID0gY3JlYXRlX3VzZXJf
dm1hKGNlLT52bSwgU1pfNjRLKTsKLQlpZiAoSVNfRVJSKGJhdGNoKSkKLQkJcmV0dXJuIGJhdGNo
OwotCi0JY3MgPSBpOTE1X2dlbV9vYmplY3RfcGluX21hcChiYXRjaC0+b2JqLCBJOTE1X01BUF9X
Qyk7Ci0JaWYgKElTX0VSUihjcykpIHsKLQkJaTkxNV92bWFfcHV0KGJhdGNoKTsKLQkJcmV0dXJu
IEVSUl9DQVNUKGNzKTsKLQl9Ci0KLQlkZWZhdWx0cyA9IHNobWVtX3Bpbl9tYXAoY2UtPmVuZ2lu
ZS0+ZGVmYXVsdF9zdGF0ZSk7Ci0JaWYgKCFkZWZhdWx0cykgewotCQlpOTE1X2dlbV9vYmplY3Rf
dW5waW5fbWFwKGJhdGNoLT5vYmopOwotCQlpOTE1X3ZtYV9wdXQoYmF0Y2gpOwotCQlyZXR1cm4g
RVJSX1BUUigtRU5PTUVNKTsKLQl9Ci0KLQl4ID0gMDsKLQlkdyA9IDA7Ci0JaHcgPSBkZWZhdWx0
czsKLQlodyArPSBMUkNfU1RBVEVfT0ZGU0VUIC8gc2l6ZW9mKCpodyk7Ci0JZG8gewotCQl1MzIg
bGVuID0gaHdbZHddICYgMHg3ZjsKLQotCQlpZiAoaHdbZHddID09IDApIHsKLQkJCWR3Kys7Ci0J
CQljb250aW51ZTsKLQkJfQotCi0JCWlmICgoaHdbZHddICYgR0VOTUFTSygzMSwgMjMpKSAhPSBN
SV9JTlNUUigweDIyLCAwKSkgewotCQkJZHcgKz0gbGVuICsgMjsKLQkJCWNvbnRpbnVlOwotCQl9
Ci0KLQkJZHcrKzsKLQkJbGVuID0gKGxlbiArIDEpIC8gMjsKLQkJd2hpbGUgKGxlbi0tKSB7Ci0J
CQkqY3MrKyA9IE1JX1NUT1JFX1JFR0lTVEVSX01FTV9HRU44OwotCQkJKmNzKysgPSBod1tkd107
Ci0JCQkqY3MrKyA9IGxvd2VyXzMyX2JpdHMoc2NyYXRjaC0+bm9kZS5zdGFydCArIHgpOwotCQkJ
KmNzKysgPSB1cHBlcl8zMl9iaXRzKHNjcmF0Y2gtPm5vZGUuc3RhcnQgKyB4KTsKLQotCQkJZHcg
Kz0gMjsKLQkJCXggKz0gNDsKLQkJfQotCX0gd2hpbGUgKGR3IDwgUEFHRV9TSVpFIC8gc2l6ZW9m
KHUzMikgJiYKLQkJIChod1tkd10gJiB+QklUKDApKSAhPSBNSV9CQVRDSF9CVUZGRVJfRU5EKTsK
LQotCSpjcysrID0gTUlfQkFUQ0hfQlVGRkVSX0VORDsKLQotCXNobWVtX3VucGluX21hcChjZS0+
ZW5naW5lLT5kZWZhdWx0X3N0YXRlLCBkZWZhdWx0cyk7Ci0KLQlpOTE1X2dlbV9vYmplY3RfZmx1
c2hfbWFwKGJhdGNoLT5vYmopOwotCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAoYmF0Y2gtPm9i
aik7Ci0KLQlyZXR1cm4gYmF0Y2g7Ci19Ci0KLXN0YXRpYyBpbnQgbW92ZV90b19hY3RpdmUoc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnEsCi0JCQkgIHN0cnVjdCBpOTE1X3ZtYSAqdm1hLAotCQkJICB1
bnNpZ25lZCBpbnQgZmxhZ3MpCi17Ci0JaW50IGVycjsKLQotCWk5MTVfdm1hX2xvY2sodm1hKTsK
LQllcnIgPSBpOTE1X3JlcXVlc3RfYXdhaXRfb2JqZWN0KHJxLCB2bWEtPm9iaiwgZmxhZ3MpOwot
CWlmICghZXJyKQotCQllcnIgPSBpOTE1X3ZtYV9tb3ZlX3RvX2FjdGl2ZSh2bWEsIHJxLCBmbGFn
cyk7Ci0JaTkxNV92bWFfdW5sb2NrKHZtYSk7Ci0KLQlyZXR1cm4gZXJyOwotfQotCi1zdGF0aWMg
c3RydWN0IGk5MTVfcmVxdWVzdCAqCi1yZWNvcmRfcmVnaXN0ZXJzKHN0cnVjdCBpbnRlbF9jb250
ZXh0ICpjZSwKLQkJIHN0cnVjdCBpOTE1X3ZtYSAqYmVmb3JlLAotCQkgc3RydWN0IGk5MTVfdm1h
ICphZnRlciwKLQkJIHUzMiAqc2VtYSkKLXsKLQlzdHJ1Y3QgaTkxNV92bWEgKmJfYmVmb3JlLCAq
Yl9hZnRlcjsKLQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKLQl1MzIgKmNzOwotCWludCBlcnI7
Ci0KLQliX2JlZm9yZSA9IHN0b3JlX2NvbnRleHQoY2UsIGJlZm9yZSk7Ci0JaWYgKElTX0VSUihi
X2JlZm9yZSkpCi0JCXJldHVybiBFUlJfQ0FTVChiX2JlZm9yZSk7Ci0KLQliX2FmdGVyID0gc3Rv
cmVfY29udGV4dChjZSwgYWZ0ZXIpOwotCWlmIChJU19FUlIoYl9hZnRlcikpIHsKLQkJcnEgPSBF
UlJfQ0FTVChiX2FmdGVyKTsKLQkJZ290byBlcnJfYmVmb3JlOwotCX0KLQotCXJxID0gaW50ZWxf
Y29udGV4dF9jcmVhdGVfcmVxdWVzdChjZSk7Ci0JaWYgKElTX0VSUihycSkpCi0JCWdvdG8gZXJy
X2FmdGVyOwotCi0JZXJyID0gbW92ZV90b19hY3RpdmUocnEsIGJlZm9yZSwgRVhFQ19PQkpFQ1Rf
V1JJVEUpOwotCWlmIChlcnIpCi0JCWdvdG8gZXJyX3JxOwotCi0JZXJyID0gbW92ZV90b19hY3Rp
dmUocnEsIGJfYmVmb3JlLCAwKTsKLQlpZiAoZXJyKQotCQlnb3RvIGVycl9ycTsKLQotCWVyciA9
IG1vdmVfdG9fYWN0aXZlKHJxLCBhZnRlciwgRVhFQ19PQkpFQ1RfV1JJVEUpOwotCWlmIChlcnIp
Ci0JCWdvdG8gZXJyX3JxOwotCi0JZXJyID0gbW92ZV90b19hY3RpdmUocnEsIGJfYWZ0ZXIsIDAp
OwotCWlmIChlcnIpCi0JCWdvdG8gZXJyX3JxOwotCi0JY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJx
LCAxNCk7Ci0JaWYgKElTX0VSUihjcykpIHsKLQkJZXJyID0gUFRSX0VSUihjcyk7Ci0JCWdvdG8g
ZXJyX3JxOwotCX0KLQotCSpjcysrID0gTUlfQVJCX09OX09GRiB8IE1JX0FSQl9ESVNBQkxFOwot
CSpjcysrID0gTUlfQkFUQ0hfQlVGRkVSX1NUQVJUX0dFTjggfCBCSVQoOCk7Ci0JKmNzKysgPSBs
b3dlcl8zMl9iaXRzKGJfYmVmb3JlLT5ub2RlLnN0YXJ0KTsKLQkqY3MrKyA9IHVwcGVyXzMyX2Jp
dHMoYl9iZWZvcmUtPm5vZGUuc3RhcnQpOwotCi0JKmNzKysgPSBNSV9BUkJfT05fT0ZGIHwgTUlf
QVJCX0VOQUJMRTsKLQkqY3MrKyA9IE1JX1NFTUFQSE9SRV9XQUlUIHwKLQkJTUlfU0VNQVBIT1JF
X0dMT0JBTF9HVFQgfAotCQlNSV9TRU1BUEhPUkVfUE9MTCB8Ci0JCU1JX1NFTUFQSE9SRV9TQURf
TkVRX1NERDsKLQkqY3MrKyA9IDA7Ci0JKmNzKysgPSBpOTE1X2dndHRfb2Zmc2V0KGNlLT5lbmdp
bmUtPnN0YXR1c19wYWdlLnZtYSkgKwotCQlvZmZzZXRfaW5fcGFnZShzZW1hKTsKLQkqY3MrKyA9
IDA7Ci0JKmNzKysgPSBNSV9OT09QOwotCi0JKmNzKysgPSBNSV9BUkJfT05fT0ZGIHwgTUlfQVJC
X0RJU0FCTEU7Ci0JKmNzKysgPSBNSV9CQVRDSF9CVUZGRVJfU1RBUlRfR0VOOCB8IEJJVCg4KTsK
LQkqY3MrKyA9IGxvd2VyXzMyX2JpdHMoYl9hZnRlci0+bm9kZS5zdGFydCk7Ci0JKmNzKysgPSB1
cHBlcl8zMl9iaXRzKGJfYWZ0ZXItPm5vZGUuc3RhcnQpOwotCi0JaW50ZWxfcmluZ19hZHZhbmNl
KHJxLCBjcyk7Ci0KLQlXUklURV9PTkNFKCpzZW1hLCAwKTsKLQlpOTE1X3JlcXVlc3RfZ2V0KHJx
KTsKLQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKLWVycl9hZnRlcjoKLQlpOTE1X3ZtYV9wdXQoYl9h
ZnRlcik7Ci1lcnJfYmVmb3JlOgotCWk5MTVfdm1hX3B1dChiX2JlZm9yZSk7Ci0JcmV0dXJuIHJx
OwotCi1lcnJfcnE6Ci0JaTkxNV9yZXF1ZXN0X2FkZChycSk7Ci0JcnEgPSBFUlJfUFRSKGVycik7
Ci0JZ290byBlcnJfYWZ0ZXI7Ci19Ci0KLXN0YXRpYyBzdHJ1Y3QgaTkxNV92bWEgKmxvYWRfY29u
dGV4dChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHUzMiBwb2lzb24pCi17Ci0Jc3RydWN0IGk5
MTVfdm1hICpiYXRjaDsKLQl1MzIgZHcsICpjcywgKmh3OwotCXUzMiAqZGVmYXVsdHM7Ci0KLQli
YXRjaCA9IGNyZWF0ZV91c2VyX3ZtYShjZS0+dm0sIFNaXzY0Syk7Ci0JaWYgKElTX0VSUihiYXRj
aCkpCi0JCXJldHVybiBiYXRjaDsKLQotCWNzID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAoYmF0
Y2gtPm9iaiwgSTkxNV9NQVBfV0MpOwotCWlmIChJU19FUlIoY3MpKSB7Ci0JCWk5MTVfdm1hX3B1
dChiYXRjaCk7Ci0JCXJldHVybiBFUlJfQ0FTVChjcyk7Ci0JfQotCi0JZGVmYXVsdHMgPSBzaG1l
bV9waW5fbWFwKGNlLT5lbmdpbmUtPmRlZmF1bHRfc3RhdGUpOwotCWlmICghZGVmYXVsdHMpIHsK
LQkJaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChiYXRjaC0+b2JqKTsKLQkJaTkxNV92bWFfcHV0
KGJhdGNoKTsKLQkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7Ci0JfQotCi0JZHcgPSAwOwotCWh3
ID0gZGVmYXVsdHM7Ci0JaHcgKz0gTFJDX1NUQVRFX09GRlNFVCAvIHNpemVvZigqaHcpOwotCWRv
IHsKLQkJdTMyIGxlbiA9IGh3W2R3XSAmIDB4N2Y7Ci0KLQkJaWYgKGh3W2R3XSA9PSAwKSB7Ci0J
CQlkdysrOwotCQkJY29udGludWU7Ci0JCX0KLQotCQlpZiAoKGh3W2R3XSAmIEdFTk1BU0soMzEs
IDIzKSkgIT0gTUlfSU5TVFIoMHgyMiwgMCkpIHsKLQkJCWR3ICs9IGxlbiArIDI7Ci0JCQljb250
aW51ZTsKLQkJfQotCi0JCWR3Kys7Ci0JCWxlbiA9IChsZW4gKyAxKSAvIDI7Ci0JCSpjcysrID0g
TUlfTE9BRF9SRUdJU1RFUl9JTU0obGVuKTsKLQkJd2hpbGUgKGxlbi0tKSB7Ci0JCQkqY3MrKyA9
IGh3W2R3XTsKLQkJCSpjcysrID0gcG9pc29uOwotCQkJZHcgKz0gMjsKLQkJfQotCX0gd2hpbGUg
KGR3IDwgUEFHRV9TSVpFIC8gc2l6ZW9mKHUzMikgJiYKLQkJIChod1tkd10gJiB+QklUKDApKSAh
PSBNSV9CQVRDSF9CVUZGRVJfRU5EKTsKLQotCSpjcysrID0gTUlfQkFUQ0hfQlVGRkVSX0VORDsK
LQotCXNobWVtX3VucGluX21hcChjZS0+ZW5naW5lLT5kZWZhdWx0X3N0YXRlLCBkZWZhdWx0cyk7
Ci0KLQlpOTE1X2dlbV9vYmplY3RfZmx1c2hfbWFwKGJhdGNoLT5vYmopOwotCWk5MTVfZ2VtX29i
amVjdF91bnBpbl9tYXAoYmF0Y2gtPm9iaik7Ci0KLQlyZXR1cm4gYmF0Y2g7Ci19Ci0KLXN0YXRp
YyBpbnQgcG9pc29uX3JlZ2lzdGVycyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHUzMiBwb2lz
b24sIHUzMiAqc2VtYSkKLXsKLQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKLQlzdHJ1Y3QgaTkx
NV92bWEgKmJhdGNoOwotCXUzMiAqY3M7Ci0JaW50IGVycjsKLQotCWJhdGNoID0gbG9hZF9jb250
ZXh0KGNlLCBwb2lzb24pOwotCWlmIChJU19FUlIoYmF0Y2gpKQotCQlyZXR1cm4gUFRSX0VSUihi
YXRjaCk7Ci0KLQlycSA9IGludGVsX2NvbnRleHRfY3JlYXRlX3JlcXVlc3QoY2UpOwotCWlmIChJ
U19FUlIocnEpKSB7Ci0JCWVyciA9IFBUUl9FUlIocnEpOwotCQlnb3RvIGVycl9iYXRjaDsKLQl9
Ci0KLQllcnIgPSBtb3ZlX3RvX2FjdGl2ZShycSwgYmF0Y2gsIDApOwotCWlmIChlcnIpCi0JCWdv
dG8gZXJyX3JxOwotCi0JY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJxLCA4KTsKLQlpZiAoSVNfRVJS
KGNzKSkgewotCQllcnIgPSBQVFJfRVJSKGNzKTsKLQkJZ290byBlcnJfcnE7Ci0JfQotCi0JKmNz
KysgPSBNSV9BUkJfT05fT0ZGIHwgTUlfQVJCX0RJU0FCTEU7Ci0JKmNzKysgPSBNSV9CQVRDSF9C
VUZGRVJfU1RBUlRfR0VOOCB8IEJJVCg4KTsKLQkqY3MrKyA9IGxvd2VyXzMyX2JpdHMoYmF0Y2gt
Pm5vZGUuc3RhcnQpOwotCSpjcysrID0gdXBwZXJfMzJfYml0cyhiYXRjaC0+bm9kZS5zdGFydCk7
Ci0KLQkqY3MrKyA9IE1JX1NUT1JFX0RXT1JEX0lNTV9HRU40IHwgTUlfVVNFX0dHVFQ7Ci0JKmNz
KysgPSBpOTE1X2dndHRfb2Zmc2V0KGNlLT5lbmdpbmUtPnN0YXR1c19wYWdlLnZtYSkgKwotCQlv
ZmZzZXRfaW5fcGFnZShzZW1hKTsKLQkqY3MrKyA9IDA7Ci0JKmNzKysgPSAxOwotCi0JaW50ZWxf
cmluZ19hZHZhbmNlKHJxLCBjcyk7Ci0KLQlycS0+c2NoZWQuYXR0ci5wcmlvcml0eSA9IEk5MTVf
UFJJT1JJVFlfQkFSUklFUjsKLWVycl9ycToKLQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKLWVycl9i
YXRjaDoKLQlpOTE1X3ZtYV9wdXQoYmF0Y2gpOwotCXJldHVybiBlcnI7Ci19Ci0KLXN0YXRpYyBi
b29sIGlzX21vdmluZyh1MzIgYSwgdTMyIGIpCi17Ci0JcmV0dXJuIGEgIT0gYjsKLX0KLQotc3Rh
dGljIGludCBjb21wYXJlX2lzb2xhdGlvbihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUs
Ci0JCQkgICAgIHN0cnVjdCBpOTE1X3ZtYSAqcmVmWzJdLAotCQkJICAgICBzdHJ1Y3QgaTkxNV92
bWEgKnJlc3VsdFsyXSwKLQkJCSAgICAgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAotCQkJICAg
ICB1MzIgcG9pc29uKQotewotCXUzMiB4LCBkdywgKmh3LCAqbHJjOwotCXUzMiAqQVsyXSwgKkJb
Ml07Ci0JdTMyICpkZWZhdWx0czsKLQlpbnQgZXJyID0gMDsKLQotCUFbMF0gPSBpOTE1X2dlbV9v
YmplY3RfcGluX21hcChyZWZbMF0tPm9iaiwgSTkxNV9NQVBfV0MpOwotCWlmIChJU19FUlIoQVsw
XSkpCi0JCXJldHVybiBQVFJfRVJSKEFbMF0pOwotCi0JQVsxXSA9IGk5MTVfZ2VtX29iamVjdF9w
aW5fbWFwKHJlZlsxXS0+b2JqLCBJOTE1X01BUF9XQyk7Ci0JaWYgKElTX0VSUihBWzFdKSkgewot
CQllcnIgPSBQVFJfRVJSKEFbMV0pOwotCQlnb3RvIGVycl9BMDsKLQl9Ci0KLQlCWzBdID0gaTkx
NV9nZW1fb2JqZWN0X3Bpbl9tYXAocmVzdWx0WzBdLT5vYmosIEk5MTVfTUFQX1dDKTsKLQlpZiAo
SVNfRVJSKEJbMF0pKSB7Ci0JCWVyciA9IFBUUl9FUlIoQlswXSk7Ci0JCWdvdG8gZXJyX0ExOwot
CX0KLQotCUJbMV0gPSBpOTE1X2dlbV9vYmplY3RfcGluX21hcChyZXN1bHRbMV0tPm9iaiwgSTkx
NV9NQVBfV0MpOwotCWlmIChJU19FUlIoQlsxXSkpIHsKLQkJZXJyID0gUFRSX0VSUihCWzFdKTsK
LQkJZ290byBlcnJfQjA7Ci0JfQotCi0JbHJjID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAoY2Ut
PnN0YXRlLT5vYmosCi0JCQkJICAgICAgaTkxNV9jb2hlcmVudF9tYXBfdHlwZShlbmdpbmUtPmk5
MTUpKTsKLQlpZiAoSVNfRVJSKGxyYykpIHsKLQkJZXJyID0gUFRSX0VSUihscmMpOwotCQlnb3Rv
IGVycl9CMTsKLQl9Ci0JbHJjICs9IExSQ19TVEFURV9PRkZTRVQgLyBzaXplb2YoKmh3KTsKLQot
CWRlZmF1bHRzID0gc2htZW1fcGluX21hcChjZS0+ZW5naW5lLT5kZWZhdWx0X3N0YXRlKTsKLQlp
ZiAoIWRlZmF1bHRzKSB7Ci0JCWVyciA9IC1FTk9NRU07Ci0JCWdvdG8gZXJyX2xyYzsKLQl9Ci0K
LQl4ID0gMDsKLQlkdyA9IDA7Ci0JaHcgPSBkZWZhdWx0czsKLQlodyArPSBMUkNfU1RBVEVfT0ZG
U0VUIC8gc2l6ZW9mKCpodyk7Ci0JZG8gewotCQl1MzIgbGVuID0gaHdbZHddICYgMHg3ZjsKLQot
CQlpZiAoaHdbZHddID09IDApIHsKLQkJCWR3Kys7Ci0JCQljb250aW51ZTsKLQkJfQotCi0JCWlm
ICgoaHdbZHddICYgR0VOTUFTSygzMSwgMjMpKSAhPSBNSV9JTlNUUigweDIyLCAwKSkgewotCQkJ
ZHcgKz0gbGVuICsgMjsKLQkJCWNvbnRpbnVlOwotCQl9Ci0KLQkJZHcrKzsKLQkJbGVuID0gKGxl
biArIDEpIC8gMjsKLQkJd2hpbGUgKGxlbi0tKSB7Ci0JCQlpZiAoIWlzX21vdmluZyhBWzBdW3hd
LCBBWzFdW3hdKSAmJgotCQkJICAgIChBWzBdW3hdICE9IEJbMF1beF0gfHwgQVsxXVt4XSAhPSBC
WzFdW3hdKSkgewotCQkJCXN3aXRjaCAoaHdbZHddICYgNDA5NSkgewotCQkJCWNhc2UgMHgzMDog
LyogUklOR19IRUFEICovCi0JCQkJY2FzZSAweDM0OiAvKiBSSU5HX1RBSUwgKi8KLQkJCQkJYnJl
YWs7Ci0KLQkJCQlkZWZhdWx0OgotCQkJCQlwcl9lcnIoIiVzWyVkXTogTWlzbWF0Y2ggZm9yIHJl
Z2lzdGVyICU0eCwgZGVmYXVsdCAlMDh4LCByZWZlcmVuY2UgJTA4eCwgcmVzdWx0ICglMDh4LCAl
MDh4KSwgcG9pc29uICUwOHgsIGNvbnRleHQgJTA4eFxuIiwKLQkJCQkJICAgICAgIGVuZ2luZS0+
bmFtZSwgZHcsCi0JCQkJCSAgICAgICBod1tkd10sIGh3W2R3ICsgMV0sCi0JCQkJCSAgICAgICBB
WzBdW3hdLCBCWzBdW3hdLCBCWzFdW3hdLAotCQkJCQkgICAgICAgcG9pc29uLCBscmNbZHcgKyAx
XSk7Ci0JCQkJCWVyciA9IC1FSU5WQUw7Ci0JCQkJfQotCQkJfQotCQkJZHcgKz0gMjsKLQkJCXgr
KzsKLQkJfQotCX0gd2hpbGUgKGR3IDwgUEFHRV9TSVpFIC8gc2l6ZW9mKHUzMikgJiYKLQkJICho
d1tkd10gJiB+QklUKDApKSAhPSBNSV9CQVRDSF9CVUZGRVJfRU5EKTsKLQotCXNobWVtX3VucGlu
X21hcChjZS0+ZW5naW5lLT5kZWZhdWx0X3N0YXRlLCBkZWZhdWx0cyk7Ci1lcnJfbHJjOgotCWk5
MTVfZ2VtX29iamVjdF91bnBpbl9tYXAoY2UtPnN0YXRlLT5vYmopOwotZXJyX0IxOgotCWk5MTVf
Z2VtX29iamVjdF91bnBpbl9tYXAocmVzdWx0WzFdLT5vYmopOwotZXJyX0IwOgotCWk5MTVfZ2Vt
X29iamVjdF91bnBpbl9tYXAocmVzdWx0WzBdLT5vYmopOwotZXJyX0ExOgotCWk5MTVfZ2VtX29i
amVjdF91bnBpbl9tYXAocmVmWzFdLT5vYmopOwotZXJyX0EwOgotCWk5MTVfZ2VtX29iamVjdF91
bnBpbl9tYXAocmVmWzBdLT5vYmopOwotCXJldHVybiBlcnI7Ci19Ci0KLXN0YXRpYyBpbnQgX19s
cmNfaXNvbGF0aW9uKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgdTMyIHBvaXNvbikK
LXsKLQl1MzIgKnNlbWEgPSBtZW1zZXQzMihlbmdpbmUtPnN0YXR1c19wYWdlLmFkZHIgKyAxMDAw
LCAwLCAxKTsKLQlzdHJ1Y3QgaTkxNV92bWEgKnJlZlsyXSwgKnJlc3VsdFsyXTsKLQlzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqQSwgKkI7Ci0Jc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7Ci0JaW50IGVy
cjsKLQotCUEgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZShlbmdpbmUpOwotCWlmIChJU19FUlIoQSkp
Ci0JCXJldHVybiBQVFJfRVJSKEEpOwotCi0JQiA9IGludGVsX2NvbnRleHRfY3JlYXRlKGVuZ2lu
ZSk7Ci0JaWYgKElTX0VSUihCKSkgewotCQllcnIgPSBQVFJfRVJSKEIpOwotCQlnb3RvIGVycl9B
OwotCX0KLQotCXJlZlswXSA9IGNyZWF0ZV91c2VyX3ZtYShBLT52bSwgU1pfNjRLKTsKLQlpZiAo
SVNfRVJSKHJlZlswXSkpIHsKLQkJZXJyID0gUFRSX0VSUihyZWZbMF0pOwotCQlnb3RvIGVycl9C
OwotCX0KLQotCXJlZlsxXSA9IGNyZWF0ZV91c2VyX3ZtYShBLT52bSwgU1pfNjRLKTsKLQlpZiAo
SVNfRVJSKHJlZlsxXSkpIHsKLQkJZXJyID0gUFRSX0VSUihyZWZbMV0pOwotCQlnb3RvIGVycl9y
ZWYwOwotCX0KLQotCXJxID0gcmVjb3JkX3JlZ2lzdGVycyhBLCByZWZbMF0sIHJlZlsxXSwgc2Vt
YSk7Ci0JaWYgKElTX0VSUihycSkpIHsKLQkJZXJyID0gUFRSX0VSUihycSk7Ci0JCWdvdG8gZXJy
X3JlZjE7Ci0JfQotCi0JV1JJVEVfT05DRSgqc2VtYSwgMSk7Ci0Jd21iKCk7Ci0KLQlpZiAoaTkx
NV9yZXF1ZXN0X3dhaXQocnEsIDAsIEhaIC8gMikgPCAwKSB7Ci0JCWk5MTVfcmVxdWVzdF9wdXQo
cnEpOwotCQllcnIgPSAtRVRJTUU7Ci0JCWdvdG8gZXJyX3JlZjE7Ci0JfQotCWk5MTVfcmVxdWVz
dF9wdXQocnEpOwotCi0JcmVzdWx0WzBdID0gY3JlYXRlX3VzZXJfdm1hKEEtPnZtLCBTWl82NEsp
OwotCWlmIChJU19FUlIocmVzdWx0WzBdKSkgewotCQllcnIgPSBQVFJfRVJSKHJlc3VsdFswXSk7
Ci0JCWdvdG8gZXJyX3JlZjE7Ci0JfQotCi0JcmVzdWx0WzFdID0gY3JlYXRlX3VzZXJfdm1hKEEt
PnZtLCBTWl82NEspOwotCWlmIChJU19FUlIocmVzdWx0WzFdKSkgewotCQllcnIgPSBQVFJfRVJS
KHJlc3VsdFsxXSk7Ci0JCWdvdG8gZXJyX3Jlc3VsdDA7Ci0JfQotCi0JcnEgPSByZWNvcmRfcmVn
aXN0ZXJzKEEsIHJlc3VsdFswXSwgcmVzdWx0WzFdLCBzZW1hKTsKLQlpZiAoSVNfRVJSKHJxKSkg
ewotCQllcnIgPSBQVFJfRVJSKHJxKTsKLQkJZ290byBlcnJfcmVzdWx0MTsKLQl9Ci0KLQllcnIg
PSBwb2lzb25fcmVnaXN0ZXJzKEIsIHBvaXNvbiwgc2VtYSk7Ci0JaWYgKGVycikgewotCQlXUklU
RV9PTkNFKCpzZW1hLCAtMSk7Ci0JCWk5MTVfcmVxdWVzdF9wdXQocnEpOwotCQlnb3RvIGVycl9y
ZXN1bHQxOwotCX0KLQotCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgSFogLyAyKSA8IDAp
IHsKLQkJaTkxNV9yZXF1ZXN0X3B1dChycSk7Ci0JCWVyciA9IC1FVElNRTsKLQkJZ290byBlcnJf
cmVzdWx0MTsKLQl9Ci0JaTkxNV9yZXF1ZXN0X3B1dChycSk7Ci0KLQllcnIgPSBjb21wYXJlX2lz
b2xhdGlvbihlbmdpbmUsIHJlZiwgcmVzdWx0LCBBLCBwb2lzb24pOwotCi1lcnJfcmVzdWx0MToK
LQlpOTE1X3ZtYV9wdXQocmVzdWx0WzFdKTsKLWVycl9yZXN1bHQwOgotCWk5MTVfdm1hX3B1dChy
ZXN1bHRbMF0pOwotZXJyX3JlZjE6Ci0JaTkxNV92bWFfcHV0KHJlZlsxXSk7Ci1lcnJfcmVmMDoK
LQlpOTE1X3ZtYV9wdXQocmVmWzBdKTsKLWVycl9COgotCWludGVsX2NvbnRleHRfcHV0KEIpOwot
ZXJyX0E6Ci0JaW50ZWxfY29udGV4dF9wdXQoQSk7Ci0JcmV0dXJuIGVycjsKLX0KLQotc3RhdGlj
IGJvb2wgc2tpcF9pc29sYXRpb24oY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KQotewotCWlmIChlbmdpbmUtPmNsYXNzID09IENPUFlfRU5HSU5FX0NMQVNTICYmIElOVEVMX0dF
TihlbmdpbmUtPmk5MTUpID09IDkpCi0JCXJldHVybiB0cnVlOwotCi0JaWYgKGVuZ2luZS0+Y2xh
c3MgPT0gUkVOREVSX0NMQVNTICYmIElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID09IDExKQotCQly
ZXR1cm4gdHJ1ZTsKLQotCXJldHVybiBmYWxzZTsKLX0KLQotc3RhdGljIGludCBsaXZlX2xyY19p
c29sYXRpb24odm9pZCAqYXJnKQotewotCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7Ci0Jc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwot
CWNvbnN0IHUzMiBwb2lzb25bXSA9IHsKLQkJU1RBQ0tfTUFHSUMsCi0JCTB4M2EzYTNhM2EsCi0J
CTB4NWM1YzVjNWMsCi0JCTB4ZmZmZmZmZmYsCi0JCTB4ZmZmZjAwMDAsCi0JfTsKLQlpbnQgZXJy
ID0gMDsKLQotCS8qCi0JICogT3VyIGdvYWwgaXMgdHJ5IGFuZCB2ZXJpZnkgdGhhdCBwZXItY29u
dGV4dCBzdGF0ZSBjYW5ub3QgYmUKLQkgKiB0YW1wZXJlZCB3aXRoIGJ5IGFub3RoZXIgbm9uLXBy
aXZpbGVnZWQgY2xpZW50LgotCSAqCi0JICogV2UgdGFrZSB0aGUgbGlzdCBvZiBjb250ZXh0IHJl
Z2lzdGVycyBmcm9tIHRoZSBMUkkgaW4gdGhlIGRlZmF1bHQKLQkgKiBjb250ZXh0IGltYWdlIGFu
ZCBhdHRlbXB0IHRvIG1vZGlmeSB0aGF0IGxpc3QgZnJvbSBhIHJlbW90ZSBjb250ZXh0LgotCSAq
LwotCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7Ci0JCWludCBpOwotCi0JCS8q
IEp1c3QgZG9uJ3QgZXZlbiBhc2sgKi8KLQkJaWYgKCFJU19FTkFCTEVEKENPTkZJR19EUk1fSTkx
NV9TRUxGVEVTVF9CUk9LRU4pICYmCi0JCSAgICBza2lwX2lzb2xhdGlvbihlbmdpbmUpKQotCQkJ
Y29udGludWU7Ci0KLQkJaW50ZWxfZW5naW5lX3BtX2dldChlbmdpbmUpOwotCQlmb3IgKGkgPSAw
OyBpIDwgQVJSQVlfU0laRShwb2lzb24pOyBpKyspIHsKLQkJCWludCByZXN1bHQ7Ci0KLQkJCXJl
c3VsdCA9IF9fbHJjX2lzb2xhdGlvbihlbmdpbmUsIHBvaXNvbltpXSk7Ci0JCQlpZiAocmVzdWx0
ICYmICFlcnIpCi0JCQkJZXJyID0gcmVzdWx0OwotCi0JCQlyZXN1bHQgPSBfX2xyY19pc29sYXRp
b24oZW5naW5lLCB+cG9pc29uW2ldKTsKLQkJCWlmIChyZXN1bHQgJiYgIWVycikKLQkJCQllcnIg
PSByZXN1bHQ7Ci0JCX0KLQkJaW50ZWxfZW5naW5lX3BtX3B1dChlbmdpbmUpOwotCQlpZiAoaWd0
X2ZsdXNoX3Rlc3QoZ3QtPmk5MTUpKSB7Ci0JCQllcnIgPSAtRUlPOwotCQkJYnJlYWs7Ci0JCX0K
LQl9Ci0KLQlyZXR1cm4gZXJyOwotfQotCi1zdGF0aWMgaW50IGluZGlyZWN0X2N0eF9zdWJtaXRf
cmVxKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKLXsKLQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpy
cTsKLQlpbnQgZXJyID0gMDsKLQotCXJxID0gaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVzdChj
ZSk7Ci0JaWYgKElTX0VSUihycSkpCi0JCXJldHVybiBQVFJfRVJSKHJxKTsKLQotCWk5MTVfcmVx
dWVzdF9nZXQocnEpOwotCWk5MTVfcmVxdWVzdF9hZGQocnEpOwotCi0JaWYgKGk5MTVfcmVxdWVz
dF93YWl0KHJxLCAwLCBIWiAvIDUpIDwgMCkKLQkJZXJyID0gLUVUSU1FOwotCi0JaTkxNV9yZXF1
ZXN0X3B1dChycSk7Ci0KLQlyZXR1cm4gZXJyOwotfQotCi0jZGVmaW5lIENUWF9CQl9DQU5BUllf
T0ZGU0VUICgzICogMTAyNCkKLSNkZWZpbmUgQ1RYX0JCX0NBTkFSWV9JTkRFWCAgKENUWF9CQl9D
QU5BUllfT0ZGU0VUIC8gc2l6ZW9mKHUzMikpCi0KLXN0YXRpYyB1MzIgKgotZW1pdF9pbmRpcmVj
dF9jdHhfYmJfY2FuYXJ5KGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgdTMyICpjcykK
LXsKLQkqY3MrKyA9IE1JX1NUT1JFX1JFR0lTVEVSX01FTV9HRU44IHwKLQkJTUlfU1JNX0xSTV9H
TE9CQUxfR1RUIHwKLQkJTUlfTFJJX0xSTV9DU19NTUlPOwotCSpjcysrID0gaTkxNV9tbWlvX3Jl
Z19vZmZzZXQoUklOR19TVEFSVCgwKSk7Ci0JKmNzKysgPSBpOTE1X2dndHRfb2Zmc2V0KGNlLT5z
dGF0ZSkgKwotCQljb250ZXh0X3dhX2JiX29mZnNldChjZSkgKwotCQlDVFhfQkJfQ0FOQVJZX09G
RlNFVDsKLQkqY3MrKyA9IDA7Ci0KLQlyZXR1cm4gY3M7Ci19Ci0KLXN0YXRpYyB2b2lkCi1pbmRp
cmVjdF9jdHhfYmJfc2V0dXAoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQotewotCXUzMiAqY3Mg
PSBjb250ZXh0X2luZGlyZWN0X2JiKGNlKTsKLQotCWNzW0NUWF9CQl9DQU5BUllfSU5ERVhdID0g
MHhkZWFkZjAwZDsKLQotCXNldHVwX2luZGlyZWN0X2N0eF9iYihjZSwgY2UtPmVuZ2luZSwgZW1p
dF9pbmRpcmVjdF9jdHhfYmJfY2FuYXJ5KTsKLX0KLQotc3RhdGljIGJvb2wgY2hlY2tfcmluZ19z
dGFydChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCi17Ci0JY29uc3QgdTMyICogY29uc3QgY3R4
X2JiID0gKHZvaWQgKikoY2UtPmxyY19yZWdfc3RhdGUpIC0KLQkJTFJDX1NUQVRFX09GRlNFVCAr
IGNvbnRleHRfd2FfYmJfb2Zmc2V0KGNlKTsKLQotCWlmIChjdHhfYmJbQ1RYX0JCX0NBTkFSWV9J
TkRFWF0gPT0gY2UtPmxyY19yZWdfc3RhdGVbQ1RYX1JJTkdfU1RBUlRdKQotCQlyZXR1cm4gdHJ1
ZTsKLQotCXByX2VycigicmluZyBzdGFydCBtaXNtYXRjaDogY2FuYXJ5IDB4JTA4eCB2cyBzdGF0
ZSAweCUwOHhcbiIsCi0JICAgICAgIGN0eF9iYltDVFhfQkJfQ0FOQVJZX0lOREVYXSwKLQkgICAg
ICAgY2UtPmxyY19yZWdfc3RhdGVbQ1RYX1JJTkdfU1RBUlRdKTsKLQotCXJldHVybiBmYWxzZTsK
LX0KLQotc3RhdGljIGludCBpbmRpcmVjdF9jdHhfYmJfY2hlY2soc3RydWN0IGludGVsX2NvbnRl
eHQgKmNlKQotewotCWludCBlcnI7Ci0KLQllcnIgPSBpbmRpcmVjdF9jdHhfc3VibWl0X3JlcShj
ZSk7Ci0JaWYgKGVycikKLQkJcmV0dXJuIGVycjsKLQotCWlmICghY2hlY2tfcmluZ19zdGFydChj
ZSkpCi0JCXJldHVybiAtRUlOVkFMOwotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQgX19s
aXZlX2xyY19pbmRpcmVjdF9jdHhfYmIoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQot
ewotCXN0cnVjdCBpbnRlbF9jb250ZXh0ICphLCAqYjsKLQlpbnQgZXJyOwotCi0JYSA9IGludGVs
X2NvbnRleHRfY3JlYXRlKGVuZ2luZSk7Ci0JaWYgKElTX0VSUihhKSkKLQkJcmV0dXJuIFBUUl9F
UlIoYSk7Ci0JZXJyID0gaW50ZWxfY29udGV4dF9waW4oYSk7Ci0JaWYgKGVycikKLQkJZ290byBw
dXRfYTsKLQotCWIgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZShlbmdpbmUpOwotCWlmIChJU19FUlIo
YikpIHsKLQkJZXJyID0gUFRSX0VSUihiKTsKLQkJZ290byB1bnBpbl9hOwotCX0KLQllcnIgPSBp
bnRlbF9jb250ZXh0X3BpbihiKTsKLQlpZiAoZXJyKQotCQlnb3RvIHB1dF9iOwotCi0JLyogV2Ug
dXNlIHRoZSBhbHJlYWR5IHJlc2VydmVkIGV4dHJhIHBhZ2UgaW4gY29udGV4dCBzdGF0ZSAqLwot
CWlmICghYS0+d2FfYmJfcGFnZSkgewotCQlHRU1fQlVHX09OKGItPndhX2JiX3BhZ2UpOwotCQlH
RU1fQlVHX09OKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID09IDEyKTsKLQkJZ290byB1bnBpbl9i
OwotCX0KLQotCS8qCi0JICogSW4gb3JkZXIgdG8gdGVzdCB0aGF0IG91ciBwZXIgY29udGV4dCBi
YiBpcyB0cnVseSBwZXIgY29udGV4dCwKLQkgKiBhbmQgZXhlY3V0ZXMgYXQgdGhlIGludGVuZGVk
IHNwb3Qgb24gY29udGV4dCByZXN0b3JpbmcgcHJvY2VzcywKLQkgKiBtYWtlIHRoZSBiYXRjaCBz
dG9yZSB0aGUgcmluZyBzdGFydCB2YWx1ZSB0byBtZW1vcnkuCi0JICogQXMgcmluZyBzdGFydCBp
cyByZXN0b3JlZCBhcHJpb3JpIG9mIHN0YXJ0aW5nIHRoZSBpbmRpcmVjdCBjdHggYmIgYW5kCi0J
ICogYXMgaXQgd2lsbCBiZSBkaWZmZXJlbnQgZm9yIGVhY2ggY29udGV4dCwgaXQgZml0cyB0byB0
aGlzIHB1cnBvc2UuCi0JICovCi0JaW5kaXJlY3RfY3R4X2JiX3NldHVwKGEpOwotCWluZGlyZWN0
X2N0eF9iYl9zZXR1cChiKTsKLQotCWVyciA9IGluZGlyZWN0X2N0eF9iYl9jaGVjayhhKTsKLQlp
ZiAoZXJyKQotCQlnb3RvIHVucGluX2I7Ci0KLQllcnIgPSBpbmRpcmVjdF9jdHhfYmJfY2hlY2so
Yik7Ci0KLXVucGluX2I6Ci0JaW50ZWxfY29udGV4dF91bnBpbihiKTsKLXB1dF9iOgotCWludGVs
X2NvbnRleHRfcHV0KGIpOwotdW5waW5fYToKLQlpbnRlbF9jb250ZXh0X3VucGluKGEpOwotcHV0
X2E6Ci0JaW50ZWxfY29udGV4dF9wdXQoYSk7Ci0KLQlyZXR1cm4gZXJyOwotfQotCi1zdGF0aWMg
aW50IGxpdmVfbHJjX2luZGlyZWN0X2N0eF9iYih2b2lkICphcmcpCi17Ci0Jc3RydWN0IGludGVs
X2d0ICpndCA9IGFyZzsKLQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0JZW51bSBp
bnRlbF9lbmdpbmVfaWQgaWQ7Ci0JaW50IGVyciA9IDA7Ci0KLQlmb3JfZWFjaF9lbmdpbmUoZW5n
aW5lLCBndCwgaWQpIHsKLQkJaW50ZWxfZW5naW5lX3BtX2dldChlbmdpbmUpOwotCQllcnIgPSBf
X2xpdmVfbHJjX2luZGlyZWN0X2N0eF9iYihlbmdpbmUpOwotCQlpbnRlbF9lbmdpbmVfcG1fcHV0
KGVuZ2luZSk7Ci0KLQkJaWYgKGlndF9mbHVzaF90ZXN0KGd0LT5pOTE1KSkKLQkJCWVyciA9IC1F
SU87Ci0KLQkJaWYgKGVycikKLQkJCWJyZWFrOwotCX0KLQotCXJldHVybiBlcnI7Ci19Ci0KLXN0
YXRpYyB2b2lkIGdhcmJhZ2VfcmVzZXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAot
CQkJICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKLXsKLQljb25zdCB1bnNpZ25lZCBpbnQgYml0
ID0gSTkxNV9SRVNFVF9FTkdJTkUgKyBlbmdpbmUtPmlkOwotCXVuc2lnbmVkIGxvbmcgKmxvY2sg
PSAmZW5naW5lLT5ndC0+cmVzZXQuZmxhZ3M7Ci0KLQlpZiAodGVzdF9hbmRfc2V0X2JpdChiaXQs
IGxvY2spKQotCQlyZXR1cm47Ci0KLQl0YXNrbGV0X2Rpc2FibGUoJmVuZ2luZS0+ZXhlY2xpc3Rz
LnRhc2tsZXQpOwotCi0JaWYgKCFycS0+ZmVuY2UuZXJyb3IpCi0JCWludGVsX2VuZ2luZV9yZXNl
dChlbmdpbmUsIE5VTEwpOwotCi0JdGFza2xldF9lbmFibGUoJmVuZ2luZS0+ZXhlY2xpc3RzLnRh
c2tsZXQpOwotCWNsZWFyX2FuZF93YWtlX3VwX2JpdChiaXQsIGxvY2spOwotfQotCi1zdGF0aWMg
c3RydWN0IGk5MTVfcmVxdWVzdCAqZ2FyYmFnZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCi0J
CQkJICAgIHN0cnVjdCBybmRfc3RhdGUgKnBybmcpCi17Ci0Jc3RydWN0IGk5MTVfcmVxdWVzdCAq
cnE7Ci0JaW50IGVycjsKLQotCWVyciA9IGludGVsX2NvbnRleHRfcGluKGNlKTsKLQlpZiAoZXJy
KQotCQlyZXR1cm4gRVJSX1BUUihlcnIpOwotCi0JcHJhbmRvbV9ieXRlc19zdGF0ZShwcm5nLAot
CQkJICAgIGNlLT5scmNfcmVnX3N0YXRlLAotCQkJICAgIGNlLT5lbmdpbmUtPmNvbnRleHRfc2l6
ZSAtCi0JCQkgICAgTFJDX1NUQVRFX09GRlNFVCk7Ci0KLQlycSA9IGludGVsX2NvbnRleHRfY3Jl
YXRlX3JlcXVlc3QoY2UpOwotCWlmIChJU19FUlIocnEpKSB7Ci0JCWVyciA9IFBUUl9FUlIocnEp
OwotCQlnb3RvIGVycl91bnBpbjsKLQl9Ci0KLQlpOTE1X3JlcXVlc3RfZ2V0KHJxKTsKLQlpOTE1
X3JlcXVlc3RfYWRkKHJxKTsKLQlyZXR1cm4gcnE7Ci0KLWVycl91bnBpbjoKLQlpbnRlbF9jb250
ZXh0X3VucGluKGNlKTsKLQlyZXR1cm4gRVJSX1BUUihlcnIpOwotfQotCi1zdGF0aWMgaW50IF9f
bHJjX2dhcmJhZ2Uoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBzdHJ1Y3Qgcm5kX3N0
YXRlICpwcm5nKQotewotCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsKLQlzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICpoYW5nOwotCWludCBlcnIgPSAwOwotCi0JY2UgPSBpbnRlbF9jb250ZXh0X2NyZWF0
ZShlbmdpbmUpOwotCWlmIChJU19FUlIoY2UpKQotCQlyZXR1cm4gUFRSX0VSUihjZSk7Ci0KLQlo
YW5nID0gZ2FyYmFnZShjZSwgcHJuZyk7Ci0JaWYgKElTX0VSUihoYW5nKSkgewotCQllcnIgPSBQ
VFJfRVJSKGhhbmcpOwotCQlnb3RvIGVycl9jZTsKLQl9Ci0KLQlpZiAod2FpdF9mb3Jfc3VibWl0
KGVuZ2luZSwgaGFuZywgSFogLyAyKSkgewotCQlpOTE1X3JlcXVlc3RfcHV0KGhhbmcpOwotCQll
cnIgPSAtRVRJTUU7Ci0JCWdvdG8gZXJyX2NlOwotCX0KLQotCWludGVsX2NvbnRleHRfc2V0X2Jh
bm5lZChjZSk7Ci0JZ2FyYmFnZV9yZXNldChlbmdpbmUsIGhhbmcpOwotCi0JaW50ZWxfZW5naW5l
X2ZsdXNoX3N1Ym1pc3Npb24oZW5naW5lKTsKLQlpZiAoIWhhbmctPmZlbmNlLmVycm9yKSB7Ci0J
CWk5MTVfcmVxdWVzdF9wdXQoaGFuZyk7Ci0JCXByX2VycigiJXM6IGNvcnJ1cHRlZCBjb250ZXh0
IHdhcyBub3QgcmVzZXRcbiIsCi0JCSAgICAgICBlbmdpbmUtPm5hbWUpOwotCQllcnIgPSAtRUlO
VkFMOwotCQlnb3RvIGVycl9jZTsKLQl9Ci0KLQlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQoaGFuZywg
MCwgSFogLyAyKSA8IDApIHsKLQkJcHJfZXJyKCIlczogY29ycnVwdGVkIGNvbnRleHQgZGlkIG5v
dCByZWNvdmVyXG4iLAotCQkgICAgICAgZW5naW5lLT5uYW1lKTsKLQkJaTkxNV9yZXF1ZXN0X3B1
dChoYW5nKTsKLQkJZXJyID0gLUVJTzsKLQkJZ290byBlcnJfY2U7Ci0JfQotCWk5MTVfcmVxdWVz
dF9wdXQoaGFuZyk7Ci0KLWVycl9jZToKLQlpbnRlbF9jb250ZXh0X3B1dChjZSk7Ci0JcmV0dXJu
IGVycjsKLX0KLQotc3RhdGljIGludCBsaXZlX2xyY19nYXJiYWdlKHZvaWQgKmFyZykKLXsKLQlz
dHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOwotCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZTsKLQllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKLQotCS8qCi0JICogVmVyaWZ5IHRoYXQgd2Ug
Y2FuIHJlY292ZXIgaWYgb25lIGNvbnRleHQgc3RhdGUgaXMgY29tcGxldGVseQotCSAqIGNvcnJ1
cHRlZC4KLQkgKi8KLQotCWlmICghSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfU0VMRlRFU1Rf
QlJPS0VOKSkKLQkJcmV0dXJuIDA7Ci0KLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndCwgaWQp
IHsKLQkJSTkxNV9STkRfU1RBVEUocHJuZyk7Ci0JCWludCBlcnIgPSAwLCBpOwotCi0JCWlmICgh
aW50ZWxfaGFzX3Jlc2V0X2VuZ2luZShlbmdpbmUtPmd0KSkKLQkJCWNvbnRpbnVlOwotCi0JCWlu
dGVsX2VuZ2luZV9wbV9nZXQoZW5naW5lKTsKLQkJZm9yIChpID0gMDsgaSA8IDM7IGkrKykgewot
CQkJZXJyID0gX19scmNfZ2FyYmFnZShlbmdpbmUsICZwcm5nKTsKLQkJCWlmIChlcnIpCi0JCQkJ
YnJlYWs7Ci0JCX0KLQkJaW50ZWxfZW5naW5lX3BtX3B1dChlbmdpbmUpOwotCi0JCWlmIChpZ3Rf
Zmx1c2hfdGVzdChndC0+aTkxNSkpCi0JCQllcnIgPSAtRUlPOwotCQlpZiAoZXJyKQotCQkJcmV0
dXJuIGVycjsKLQl9Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCBfX2xpdmVfcHBod3Nw
X3J1bnRpbWUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQotewotCXN0cnVjdCBpbnRl
bF9jb250ZXh0ICpjZTsKLQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKLQlJR1RfVElNRU9VVChl
bmRfdGltZSk7Ci0JaW50IGVycjsKLQotCWNlID0gaW50ZWxfY29udGV4dF9jcmVhdGUoZW5naW5l
KTsKLQlpZiAoSVNfRVJSKGNlKSkKLQkJcmV0dXJuIFBUUl9FUlIoY2UpOwotCi0JY2UtPnJ1bnRp
bWUubnVtX3VuZGVyZmxvdyA9IDA7Ci0JY2UtPnJ1bnRpbWUubWF4X3VuZGVyZmxvdyA9IDA7Ci0K
LQlkbyB7Ci0JCXVuc2lnbmVkIGludCBsb29wID0gMTAyNDsKLQotCQl3aGlsZSAobG9vcCkgewot
CQkJcnEgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZV9yZXF1ZXN0KGNlKTsKLQkJCWlmIChJU19FUlIo
cnEpKSB7Ci0JCQkJZXJyID0gUFRSX0VSUihycSk7Ci0JCQkJZ290byBlcnJfcnE7Ci0JCQl9Ci0K
LQkJCWlmICgtLWxvb3AgPT0gMCkKLQkJCQlpOTE1X3JlcXVlc3RfZ2V0KHJxKTsKLQotCQkJaTkx
NV9yZXF1ZXN0X2FkZChycSk7Ci0JCX0KLQotCQlpZiAoX19pZ3RfdGltZW91dChlbmRfdGltZSwg
TlVMTCkpCi0JCQlicmVhazsKLQotCQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKLQl9IHdoaWxlICgx
KTsKLQotCWVyciA9IGk5MTVfcmVxdWVzdF93YWl0KHJxLCAwLCBIWiAvIDUpOwotCWlmIChlcnIg
PCAwKSB7Ci0JCXByX2VycigiJXM6IHJlcXVlc3Qgbm90IGNvbXBsZXRlZCFcbiIsIGVuZ2luZS0+
bmFtZSk7Ci0JCWdvdG8gZXJyX3dhaXQ7Ci0JfQotCi0JaWd0X2ZsdXNoX3Rlc3QoZW5naW5lLT5p
OTE1KTsKLQotCXByX2luZm8oIiVzOiBwcGh3c3AgcnVudGltZSAlbGx1bnMsIGF2ZXJhZ2UgJWxs
dW5zXG4iLAotCQllbmdpbmUtPm5hbWUsCi0JCWludGVsX2NvbnRleHRfZ2V0X3RvdGFsX3J1bnRp
bWVfbnMoY2UpLAotCQlpbnRlbF9jb250ZXh0X2dldF9hdmdfcnVudGltZV9ucyhjZSkpOwotCi0J
ZXJyID0gMDsKLQlpZiAoY2UtPnJ1bnRpbWUubnVtX3VuZGVyZmxvdykgewotCQlwcl9lcnIoIiVz
OiBwcGh3c3AgdW5kZXJmbG93ICV1IHRpbWUocyksIG1heCAldSBjeWNsZXMhXG4iLAotCQkgICAg
ICAgZW5naW5lLT5uYW1lLAotCQkgICAgICAgY2UtPnJ1bnRpbWUubnVtX3VuZGVyZmxvdywKLQkJ
ICAgICAgIGNlLT5ydW50aW1lLm1heF91bmRlcmZsb3cpOwotCQlHRU1fVFJBQ0VfRFVNUCgpOwot
CQllcnIgPSAtRU9WRVJGTE9XOwotCX0KLQotZXJyX3dhaXQ6Ci0JaTkxNV9yZXF1ZXN0X3B1dChy
cSk7Ci1lcnJfcnE6Ci0JaW50ZWxfY29udGV4dF9wdXQoY2UpOwotCXJldHVybiBlcnI7Ci19Ci0K
LXN0YXRpYyBpbnQgbGl2ZV9wcGh3c3BfcnVudGltZSh2b2lkICphcmcpCi17Ci0Jc3RydWN0IGlu
dGVsX2d0ICpndCA9IGFyZzsKLQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0JZW51
bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Ci0JaW50IGVyciA9IDA7Ci0KLQkvKgotCSAqIENoZWNrIHRo
YXQgY3VtdWxhdGl2ZSBjb250ZXh0IHJ1bnRpbWUgYXMgc3RvcmVkIGluIHRoZSBwcGh3c3BbMTZd
Ci0JICogaXMgbW9ub3RvbmljLgotCSAqLwotCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3Qs
IGlkKSB7Ci0JCWVyciA9IF9fbGl2ZV9wcGh3c3BfcnVudGltZShlbmdpbmUpOwotCQlpZiAoZXJy
KQotCQkJYnJlYWs7Ci0JfQotCi0JaWYgKGlndF9mbHVzaF90ZXN0KGd0LT5pOTE1KSkKLQkJZXJy
ID0gLUVJTzsKLQotCXJldHVybiBlcnI7Ci19Ci0KLWludCBpbnRlbF9scmNfbGl2ZV9zZWxmdGVz
dHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCi17Ci0Jc3RhdGljIGNvbnN0IHN0cnVj
dCBpOTE1X3N1YnRlc3QgdGVzdHNbXSA9IHsKLQkJU1VCVEVTVChsaXZlX2xyY19sYXlvdXQpLAot
CQlTVUJURVNUKGxpdmVfbHJjX2ZpeGVkKSwKLQkJU1VCVEVTVChsaXZlX2xyY19zdGF0ZSksCi0J
CVNVQlRFU1QobGl2ZV9scmNfZ3ByKSwKLQkJU1VCVEVTVChsaXZlX2xyY19pc29sYXRpb24pLAot
CQlTVUJURVNUKGxpdmVfbHJjX3RpbWVzdGFtcCksCi0JCVNVQlRFU1QobGl2ZV9scmNfZ2FyYmFn
ZSksCi0JCVNVQlRFU1QobGl2ZV9wcGh3c3BfcnVudGltZSksCi0JCVNVQlRFU1QobGl2ZV9scmNf
aW5kaXJlY3RfY3R4X2JiKSwKLQl9OwotCi0JaWYgKCFIQVNfTE9HSUNBTF9SSU5HX0NPTlRFWFRT
KGk5MTUpKQotCQlyZXR1cm4gMDsKLQotCXJldHVybiBpbnRlbF9ndF9saXZlX3N1YnRlc3RzKHRl
c3RzLCAmaTkxNS0+Z3QpOwotfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
c2VsZnRlc3RfbHJjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwpu
ZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmI3NjE3NzMxZDJjZAotLS0g
L2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCkBA
IC0wLDAgKzEsMTg2MSBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAorLyoKKyAq
IENvcHlyaWdodCDCqSAyMDE4IEludGVsIENvcnBvcmF0aW9uCisgKi8KKworI2luY2x1ZGUgPGxp
bnV4L3ByaW1lX251bWJlcnMuaD4KKworI2luY2x1ZGUgImk5MTVfc2VsZnRlc3QuaCIKKyNpbmNs
dWRlICJpbnRlbF9lbmdpbmVfaGVhcnRiZWF0LmgiCisjaW5jbHVkZSAiaW50ZWxfZW5naW5lX3Bt
LmgiCisjaW5jbHVkZSAiaW50ZWxfcmVzZXQuaCIKKyNpbmNsdWRlICJpbnRlbF9yaW5nLmgiCisj
aW5jbHVkZSAic2VsZnRlc3RfZW5naW5lX2hlYXJ0YmVhdC5oIgorI2luY2x1ZGUgInNlbGZ0ZXN0
cy9pOTE1X3JhbmRvbS5oIgorI2luY2x1ZGUgInNlbGZ0ZXN0cy9pZ3RfZmx1c2hfdGVzdC5oIgor
I2luY2x1ZGUgInNlbGZ0ZXN0cy9pZ3RfbGl2ZV90ZXN0LmgiCisjaW5jbHVkZSAic2VsZnRlc3Rz
L2lndF9zcGlubmVyLmgiCisjaW5jbHVkZSAic2VsZnRlc3RzL2xpYl9zd19mZW5jZS5oIgorI2lu
Y2x1ZGUgInNobWVtX3V0aWxzLmgiCisKKyNpbmNsdWRlICJnZW0vc2VsZnRlc3RzL2lndF9nZW1f
dXRpbHMuaCIKKyNpbmNsdWRlICJnZW0vc2VsZnRlc3RzL21vY2tfY29udGV4dC5oIgorCisjZGVm
aW5lIENTX0dQUihlbmdpbmUsIG4pICgoZW5naW5lKS0+bW1pb19iYXNlICsgMHg2MDAgKyAobikg
KiA0KQorI2RlZmluZSBOVU1fR1BSIDE2CisjZGVmaW5lIE5VTV9HUFJfRFcgKE5VTV9HUFIgKiAy
KSAvKiBlYWNoIEdQUiBpcyAyIGR3b3JkcyAqLworCitzdGF0aWMgc3RydWN0IGk5MTVfdm1hICpj
cmVhdGVfc2NyYXRjaChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQoreworCXN0cnVjdCBkcm1faTkxNV9n
ZW1fb2JqZWN0ICpvYmo7CisJc3RydWN0IGk5MTVfdm1hICp2bWE7CisJaW50IGVycjsKKworCW9i
aiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfaW50ZXJuYWwoZ3QtPmk5MTUsIFBBR0VfU0laRSk7
CisJaWYgKElTX0VSUihvYmopKQorCQlyZXR1cm4gRVJSX0NBU1Qob2JqKTsKKworCWk5MTVfZ2Vt
X29iamVjdF9zZXRfY2FjaGVfY29oZXJlbmN5KG9iaiwgSTkxNV9DQUNISU5HX0NBQ0hFRCk7CisK
Kwl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosICZndC0+Z2d0dC0+dm0sIE5VTEwpOworCWlm
IChJU19FUlIodm1hKSkgeworCQlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CisJCXJldHVybiB2
bWE7CisJfQorCisJZXJyID0gaTkxNV92bWFfcGluKHZtYSwgMCwgMCwgUElOX0dMT0JBTCk7CisJ
aWYgKGVycikgeworCQlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CisJCXJldHVybiBFUlJfUFRS
KGVycik7CisJfQorCisJcmV0dXJuIHZtYTsKK30KKworc3RhdGljIGJvb2wgaXNfYWN0aXZlKHN0
cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQoreworCWlmIChpOTE1X3JlcXVlc3RfaXNfYWN0aXZlKHJx
KSkKKwkJcmV0dXJuIHRydWU7CisKKwlpZiAoaTkxNV9yZXF1ZXN0X29uX2hvbGQocnEpKQorCQly
ZXR1cm4gdHJ1ZTsKKworCWlmIChpOTE1X3JlcXVlc3RfaGFzX2luaXRpYWxfYnJlYWRjcnVtYihy
cSkgJiYgaTkxNV9yZXF1ZXN0X3N0YXJ0ZWQocnEpKQorCQlyZXR1cm4gdHJ1ZTsKKworCXJldHVy
biBmYWxzZTsKK30KKworc3RhdGljIGludCB3YWl0X2Zvcl9zdWJtaXQoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lLAorCQkJICAgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCisJCQkgICB1
bnNpZ25lZCBsb25nIHRpbWVvdXQpCit7CisJdGltZW91dCArPSBqaWZmaWVzOworCWRvIHsKKwkJ
Ym9vbCBkb25lID0gdGltZV9hZnRlcihqaWZmaWVzLCB0aW1lb3V0KTsKKworCQlpZiAoaTkxNV9y
ZXF1ZXN0X2NvbXBsZXRlZChycSkpIC8qIHRoYXQgd2FzIHF1aWNrISAqLworCQkJcmV0dXJuIDA7
CisKKwkJLyogV2FpdCB1bnRpbCB0aGUgSFcgaGFzIGFja25vd2xlZ2VkIHRoZSBzdWJtaXNzaW9u
IChvciBlcnIpICovCisJCWludGVsX2VuZ2luZV9mbHVzaF9zdWJtaXNzaW9uKGVuZ2luZSk7CisJ
CWlmICghUkVBRF9PTkNFKGVuZ2luZS0+ZXhlY2xpc3RzLnBlbmRpbmdbMF0pICYmIGlzX2FjdGl2
ZShycSkpCisJCQlyZXR1cm4gMDsKKworCQlpZiAoZG9uZSkKKwkJCXJldHVybiAtRVRJTUU7CisK
KwkJY29uZF9yZXNjaGVkKCk7CisJfSB3aGlsZSAoMSk7Cit9CisKK3N0YXRpYyBpbnQgZW1pdF9z
ZW1hcGhvcmVfc2lnbmFsKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgdm9pZCAqc2xvdCkKK3sK
Kwljb25zdCB1MzIgb2Zmc2V0ID0KKwkJaTkxNV9nZ3R0X29mZnNldChjZS0+ZW5naW5lLT5zdGF0
dXNfcGFnZS52bWEpICsKKwkJb2Zmc2V0X2luX3BhZ2Uoc2xvdCk7CisJc3RydWN0IGk5MTVfcmVx
dWVzdCAqcnE7CisJdTMyICpjczsKKworCXJxID0gaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVz
dChjZSk7CisJaWYgKElTX0VSUihycSkpCisJCXJldHVybiBQVFJfRVJSKHJxKTsKKworCWNzID0g
aW50ZWxfcmluZ19iZWdpbihycSwgNCk7CisJaWYgKElTX0VSUihjcykpIHsKKwkJaTkxNV9yZXF1
ZXN0X2FkZChycSk7CisJCXJldHVybiBQVFJfRVJSKGNzKTsKKwl9CisKKwkqY3MrKyA9IE1JX1NU
T1JFX0RXT1JEX0lNTV9HRU40IHwgTUlfVVNFX0dHVFQ7CisJKmNzKysgPSBvZmZzZXQ7CisJKmNz
KysgPSAwOworCSpjcysrID0gMTsKKworCWludGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOworCisJ
cnEtPnNjaGVkLmF0dHIucHJpb3JpdHkgPSBJOTE1X1BSSU9SSVRZX0JBUlJJRVI7CisJaTkxNV9y
ZXF1ZXN0X2FkZChycSk7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgY29udGV4dF9mbHVz
aChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIGxvbmcgdGltZW91dCkKK3sKKwlzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpycTsKKwlzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZTsKKwlpbnQgZXJyID0gMDsK
KworCXJxID0gaW50ZWxfZW5naW5lX2NyZWF0ZV9rZXJuZWxfcmVxdWVzdChjZS0+ZW5naW5lKTsK
KwlpZiAoSVNfRVJSKHJxKSkKKwkJcmV0dXJuIFBUUl9FUlIocnEpOworCisJZmVuY2UgPSBpOTE1
X2FjdGl2ZV9mZW5jZV9nZXQoJmNlLT50aW1lbGluZS0+bGFzdF9yZXF1ZXN0KTsKKwlpZiAoZmVu
Y2UpIHsKKwkJaTkxNV9yZXF1ZXN0X2F3YWl0X2RtYV9mZW5jZShycSwgZmVuY2UpOworCQlkbWFf
ZmVuY2VfcHV0KGZlbmNlKTsKKwl9CisKKwlycSA9IGk5MTVfcmVxdWVzdF9nZXQocnEpOworCWk5
MTVfcmVxdWVzdF9hZGQocnEpOworCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgdGltZW91
dCkgPCAwKQorCQllcnIgPSAtRVRJTUU7CisJaTkxNV9yZXF1ZXN0X3B1dChycSk7CisKKwlybWIo
KTsgLyogV2Uga25vdyB0aGUgcmVxdWVzdCBpcyB3cml0dGVuLCBtYWtlIHN1cmUgYWxsIHN0YXRl
IGlzIHRvbyEgKi8KKwlyZXR1cm4gZXJyOworfQorCitzdGF0aWMgaW50IGxpdmVfbHJjX2xheW91
dCh2b2lkICphcmcpCit7CisJc3RydWN0IGludGVsX2d0ICpndCA9IGFyZzsKKwlzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmU7CisJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CisJdTMyICps
cmM7CisJaW50IGVycjsKKworCS8qCisJICogQ2hlY2sgdGhlIHJlZ2lzdGVycyBvZmZzZXRzIHdl
IHVzZSB0byBjcmVhdGUgdGhlIGluaXRpYWwgcmVnIHN0YXRlCisJICogbWF0Y2ggdGhlIGxheW91
dCBzYXZlZCBieSBIVy4KKwkgKi8KKworCWxyYyA9IGttYWxsb2MoUEFHRV9TSVpFLCBHRlBfS0VS
TkVMKTsKKwlpZiAoIWxyYykKKwkJcmV0dXJuIC1FTk9NRU07CisKKwllcnIgPSAwOworCWZvcl9l
YWNoX2VuZ2luZShlbmdpbmUsIGd0LCBpZCkgeworCQl1MzIgKmh3OworCQlpbnQgZHc7CisKKwkJ
aWYgKCFlbmdpbmUtPmRlZmF1bHRfc3RhdGUpCisJCQljb250aW51ZTsKKworCQlodyA9IHNobWVt
X3Bpbl9tYXAoZW5naW5lLT5kZWZhdWx0X3N0YXRlKTsKKwkJaWYgKElTX0VSUihodykpIHsKKwkJ
CWVyciA9IFBUUl9FUlIoaHcpOworCQkJYnJlYWs7CisJCX0KKwkJaHcgKz0gTFJDX1NUQVRFX09G
RlNFVCAvIHNpemVvZigqaHcpOworCisJCV9fbHJjX2luaXRfcmVncyhtZW1zZXQobHJjLCBQT0lT
T05fSU5VU0UsIFBBR0VfU0laRSksCisJCQkJZW5naW5lLT5rZXJuZWxfY29udGV4dCwgZW5naW5l
LCB0cnVlKTsKKworCQlkdyA9IDA7CisJCWRvIHsKKwkJCXUzMiBscmkgPSBod1tkd107CisKKwkJ
CWlmIChscmkgPT0gMCkgeworCQkJCWR3Kys7CisJCQkJY29udGludWU7CisJCQl9CisKKwkJCWlm
IChscmNbZHddID09IDApIHsKKwkJCQlwcl9kZWJ1ZygiJXM6IHNraXBwZWQgaW5zdHJ1Y3Rpb24g
JXggYXQgZHdvcmQgJWRcbiIsCisJCQkJCSBlbmdpbmUtPm5hbWUsIGxyaSwgZHcpOworCQkJCWR3
Kys7CisJCQkJY29udGludWU7CisJCQl9CisKKwkJCWlmICgobHJpICYgR0VOTUFTSygzMSwgMjMp
KSAhPSBNSV9JTlNUUigweDIyLCAwKSkgeworCQkJCXByX2VycigiJXM6IEV4cGVjdGVkIExSSSBj
b21tYW5kIGF0IGR3b3JkICVkLCBmb3VuZCAlMDh4XG4iLAorCQkJCSAgICAgICBlbmdpbmUtPm5h
bWUsIGR3LCBscmkpOworCQkJCWVyciA9IC1FSU5WQUw7CisJCQkJYnJlYWs7CisJCQl9CisKKwkJ
CWlmIChscmNbZHddICE9IGxyaSkgeworCQkJCXByX2VycigiJXM6IExSSSBjb21tYW5kIG1pc21h
dGNoIGF0IGR3b3JkICVkLCBleHBlY3RlZCAlMDh4IGZvdW5kICUwOHhcbiIsCisJCQkJICAgICAg
IGVuZ2luZS0+bmFtZSwgZHcsIGxyaSwgbHJjW2R3XSk7CisJCQkJZXJyID0gLUVJTlZBTDsKKwkJ
CQlicmVhazsKKwkJCX0KKworCQkJbHJpICY9IDB4N2Y7CisJCQlscmkrKzsKKwkJCWR3Kys7CisK
KwkJCXdoaWxlIChscmkpIHsKKwkJCQlpZiAoaHdbZHddICE9IGxyY1tkd10pIHsKKwkJCQkJcHJf
ZXJyKCIlczogRGlmZmVyZW50IHJlZ2lzdGVycyBmb3VuZCBhdCBkd29yZCAlZCwgZXhwZWN0ZWQg
JXgsIGZvdW5kICV4XG4iLAorCQkJCQkgICAgICAgZW5naW5lLT5uYW1lLCBkdywgaHdbZHddLCBs
cmNbZHddKTsKKwkJCQkJZXJyID0gLUVJTlZBTDsKKwkJCQkJYnJlYWs7CisJCQkJfQorCisJCQkJ
LyoKKwkJCQkgKiBTa2lwIG92ZXIgdGhlIGFjdHVhbCByZWdpc3RlciB2YWx1ZSBhcyB3ZQorCQkJ
CSAqIGV4cGVjdCB0aGF0IHRvIGRpZmZlci4KKwkJCQkgKi8KKwkJCQlkdyArPSAyOworCQkJCWxy
aSAtPSAyOworCQkJfQorCQl9IHdoaWxlICgobHJjW2R3XSAmIH5CSVQoMCkpICE9IE1JX0JBVENI
X0JVRkZFUl9FTkQpOworCisJCWlmIChlcnIpIHsKKwkJCXByX2luZm8oIiVzOiBIVyByZWdpc3Rl
ciBpbWFnZTpcbiIsIGVuZ2luZS0+bmFtZSk7CisJCQlpZ3RfaGV4ZHVtcChodywgUEFHRV9TSVpF
KTsKKworCQkJcHJfaW5mbygiJXM6IFNXIHJlZ2lzdGVyIGltYWdlOlxuIiwgZW5naW5lLT5uYW1l
KTsKKwkJCWlndF9oZXhkdW1wKGxyYywgUEFHRV9TSVpFKTsKKwkJfQorCisJCXNobWVtX3VucGlu
X21hcChlbmdpbmUtPmRlZmF1bHRfc3RhdGUsIGh3KTsKKwkJaWYgKGVycikKKwkJCWJyZWFrOwor
CX0KKworCWtmcmVlKGxyYyk7CisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIGludCBmaW5kX29m
ZnNldChjb25zdCB1MzIgKmxyaSwgdTMyIG9mZnNldCkKK3sKKwlpbnQgaTsKKworCWZvciAoaSA9
IDA7IGkgPCBQQUdFX1NJWkUgLyBzaXplb2YodTMyKTsgaSsrKQorCQlpZiAobHJpW2ldID09IG9m
ZnNldCkKKwkJCXJldHVybiBpOworCisJcmV0dXJuIC0xOworfQorCitzdGF0aWMgaW50IGxpdmVf
bHJjX2ZpeGVkKHZvaWQgKmFyZykKK3sKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOworCXN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKKwllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsK
KwlpbnQgZXJyID0gMDsKKworCS8qCisJICogQ2hlY2sgdGhlIGFzc3VtZWQgcmVnaXN0ZXIgb2Zm
c2V0cyBtYXRjaCB0aGUgYWN0dWFsIGxvY2F0aW9ucyBpbgorCSAqIHRoZSBjb250ZXh0IGltYWdl
LgorCSAqLworCisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7CisJCWNvbnN0IHN0
cnVjdCB7CisJCQl1MzIgcmVnOworCQkJdTMyIG9mZnNldDsKKwkJCWNvbnN0IGNoYXIgKm5hbWU7
CisJCX0gdGJsW10gPSB7CisJCQl7CisJCQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19TVEFS
VChlbmdpbmUtPm1taW9fYmFzZSkpLAorCQkJCUNUWF9SSU5HX1NUQVJUIC0gMSwKKwkJCQkiUklO
R19TVEFSVCIKKwkJCX0sCisJCQl7CisJCQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19DVEwo
ZW5naW5lLT5tbWlvX2Jhc2UpKSwKKwkJCQlDVFhfUklOR19DVEwgLSAxLAorCQkJCSJSSU5HX0NU
TCIKKwkJCX0sCisJCQl7CisJCQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19IRUFEKGVuZ2lu
ZS0+bW1pb19iYXNlKSksCisJCQkJQ1RYX1JJTkdfSEVBRCAtIDEsCisJCQkJIlJJTkdfSEVBRCIK
KwkJCX0sCisJCQl7CisJCQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19UQUlMKGVuZ2luZS0+
bW1pb19iYXNlKSksCisJCQkJQ1RYX1JJTkdfVEFJTCAtIDEsCisJCQkJIlJJTkdfVEFJTCIKKwkJ
CX0sCisJCQl7CisJCQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19NSV9NT0RFKGVuZ2luZS0+
bW1pb19iYXNlKSksCisJCQkJbHJjX3JpbmdfbWlfbW9kZShlbmdpbmUpLAorCQkJCSJSSU5HX01J
X01PREUiCisJCQl9LAorCQkJeworCQkJCWk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfQkJTVEFU
RShlbmdpbmUtPm1taW9fYmFzZSkpLAorCQkJCUNUWF9CQl9TVEFURSAtIDEsCisJCQkJIkJCX1NU
QVRFIgorCQkJfSwKKwkJCXsKKwkJCQlpOTE1X21taW9fcmVnX29mZnNldChSSU5HX0JCX1BFUl9D
VFhfUFRSKGVuZ2luZS0+bW1pb19iYXNlKSksCisJCQkJbHJjX3Jpbmdfd2FfYmJfcGVyX2N0eChl
bmdpbmUpLAorCQkJCSJSSU5HX0JCX1BFUl9DVFhfUFRSIgorCQkJfSwKKwkJCXsKKwkJCQlpOTE1
X21taW9fcmVnX29mZnNldChSSU5HX0lORElSRUNUX0NUWChlbmdpbmUtPm1taW9fYmFzZSkpLAor
CQkJCWxyY19yaW5nX2luZGlyZWN0X3B0cihlbmdpbmUpLAorCQkJCSJSSU5HX0lORElSRUNUX0NU
WF9QVFIiCisJCQl9LAorCQkJeworCQkJCWk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfSU5ESVJF
Q1RfQ1RYX09GRlNFVChlbmdpbmUtPm1taW9fYmFzZSkpLAorCQkJCWxyY19yaW5nX2luZGlyZWN0
X29mZnNldChlbmdpbmUpLAorCQkJCSJSSU5HX0lORElSRUNUX0NUWF9PRkZTRVQiCisJCQl9LAor
CQkJeworCQkJCWk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfQ1RYX1RJTUVTVEFNUChlbmdpbmUt
Pm1taW9fYmFzZSkpLAorCQkJCUNUWF9USU1FU1RBTVAgLSAxLAorCQkJCSJSSU5HX0NUWF9USU1F
U1RBTVAiCisJCQl9LAorCQkJeworCQkJCWk5MTVfbW1pb19yZWdfb2Zmc2V0KEdFTjhfUklOR19D
U19HUFIoZW5naW5lLT5tbWlvX2Jhc2UsIDApKSwKKwkJCQlscmNfcmluZ19ncHIwKGVuZ2luZSks
CisJCQkJIlJJTkdfQ1NfR1BSMCIKKwkJCX0sCisJCQl7CisJCQkJaTkxNV9tbWlvX3JlZ19vZmZz
ZXQoUklOR19DTURfQlVGX0NDVEwoZW5naW5lLT5tbWlvX2Jhc2UpKSwKKwkJCQlscmNfcmluZ19j
bWRfYnVmX2NjdGwoZW5naW5lKSwKKwkJCQkiUklOR19DTURfQlVGX0NDVEwiCisJCQl9LAorCQkJ
eyB9LAorCQl9LCAqdDsKKwkJdTMyICpodzsKKworCQlpZiAoIWVuZ2luZS0+ZGVmYXVsdF9zdGF0
ZSkKKwkJCWNvbnRpbnVlOworCisJCWh3ID0gc2htZW1fcGluX21hcChlbmdpbmUtPmRlZmF1bHRf
c3RhdGUpOworCQlpZiAoSVNfRVJSKGh3KSkgeworCQkJZXJyID0gUFRSX0VSUihodyk7CisJCQli
cmVhazsKKwkJfQorCQlodyArPSBMUkNfU1RBVEVfT0ZGU0VUIC8gc2l6ZW9mKCpodyk7CisKKwkJ
Zm9yICh0ID0gdGJsOyB0LT5uYW1lOyB0KyspIHsKKwkJCWludCBkdyA9IGZpbmRfb2Zmc2V0KGh3
LCB0LT5yZWcpOworCisJCQlpZiAoZHcgIT0gdC0+b2Zmc2V0KSB7CisJCQkJcHJfZXJyKCIlczog
T2Zmc2V0IGZvciAlcyBbMHgleF0gbWlzbWF0Y2gsIGZvdW5kICV4LCBleHBlY3RlZCAleFxuIiwK
KwkJCQkgICAgICAgZW5naW5lLT5uYW1lLAorCQkJCSAgICAgICB0LT5uYW1lLAorCQkJCSAgICAg
ICB0LT5yZWcsCisJCQkJICAgICAgIGR3LAorCQkJCSAgICAgICB0LT5vZmZzZXQpOworCQkJCWVy
ciA9IC1FSU5WQUw7CisJCQl9CisJCX0KKworCQlzaG1lbV91bnBpbl9tYXAoZW5naW5lLT5kZWZh
dWx0X3N0YXRlLCBodyk7CisJfQorCisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIGludCBfX2xp
dmVfbHJjX3N0YXRlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKKwkJCSAgICBzdHJ1
Y3QgaTkxNV92bWEgKnNjcmF0Y2gpCit7CisJc3RydWN0IGludGVsX2NvbnRleHQgKmNlOworCXN0
cnVjdCBpOTE1X3JlcXVlc3QgKnJxOworCXN0cnVjdCBpOTE1X2dlbV93d19jdHggd3c7CisJZW51
bSB7CisJCVJJTkdfU1RBUlRfSURYID0gMCwKKwkJUklOR19UQUlMX0lEWCwKKwkJTUFYX0lEWAor
CX07CisJdTMyIGV4cGVjdGVkW01BWF9JRFhdOworCXUzMiAqY3M7CisJaW50IGVycjsKKwlpbnQg
bjsKKworCWNlID0gaW50ZWxfY29udGV4dF9jcmVhdGUoZW5naW5lKTsKKwlpZiAoSVNfRVJSKGNl
KSkKKwkJcmV0dXJuIFBUUl9FUlIoY2UpOworCisJaTkxNV9nZW1fd3dfY3R4X2luaXQoJnd3LCBm
YWxzZSk7CityZXRyeToKKwllcnIgPSBpOTE1X2dlbV9vYmplY3RfbG9jayhzY3JhdGNoLT5vYmos
ICZ3dyk7CisJaWYgKCFlcnIpCisJCWVyciA9IGludGVsX2NvbnRleHRfcGluX3d3KGNlLCAmd3cp
OworCWlmIChlcnIpCisJCWdvdG8gZXJyX3B1dDsKKworCXJxID0gaTkxNV9yZXF1ZXN0X2NyZWF0
ZShjZSk7CisJaWYgKElTX0VSUihycSkpIHsKKwkJZXJyID0gUFRSX0VSUihycSk7CisJCWdvdG8g
ZXJyX3VucGluOworCX0KKworCWNzID0gaW50ZWxfcmluZ19iZWdpbihycSwgNCAqIE1BWF9JRFgp
OworCWlmIChJU19FUlIoY3MpKSB7CisJCWVyciA9IFBUUl9FUlIoY3MpOworCQlpOTE1X3JlcXVl
c3RfYWRkKHJxKTsKKwkJZ290byBlcnJfdW5waW47CisJfQorCisJKmNzKysgPSBNSV9TVE9SRV9S
RUdJU1RFUl9NRU1fR0VOOCB8IE1JX1VTRV9HR1RUOworCSpjcysrID0gaTkxNV9tbWlvX3JlZ19v
ZmZzZXQoUklOR19TVEFSVChlbmdpbmUtPm1taW9fYmFzZSkpOworCSpjcysrID0gaTkxNV9nZ3R0
X29mZnNldChzY3JhdGNoKSArIFJJTkdfU1RBUlRfSURYICogc2l6ZW9mKHUzMik7CisJKmNzKysg
PSAwOworCisJZXhwZWN0ZWRbUklOR19TVEFSVF9JRFhdID0gaTkxNV9nZ3R0X29mZnNldChjZS0+
cmluZy0+dm1hKTsKKworCSpjcysrID0gTUlfU1RPUkVfUkVHSVNURVJfTUVNX0dFTjggfCBNSV9V
U0VfR0dUVDsKKwkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfVEFJTChlbmdpbmUt
Pm1taW9fYmFzZSkpOworCSpjcysrID0gaTkxNV9nZ3R0X29mZnNldChzY3JhdGNoKSArIFJJTkdf
VEFJTF9JRFggKiBzaXplb2YodTMyKTsKKwkqY3MrKyA9IDA7CisKKwllcnIgPSBpOTE1X3JlcXVl
c3RfYXdhaXRfb2JqZWN0KHJxLCBzY3JhdGNoLT5vYmosIHRydWUpOworCWlmICghZXJyKQorCQll
cnIgPSBpOTE1X3ZtYV9tb3ZlX3RvX2FjdGl2ZShzY3JhdGNoLCBycSwgRVhFQ19PQkpFQ1RfV1JJ
VEUpOworCisJaTkxNV9yZXF1ZXN0X2dldChycSk7CisJaTkxNV9yZXF1ZXN0X2FkZChycSk7CisJ
aWYgKGVycikKKwkJZ290byBlcnJfcnE7CisKKwlpbnRlbF9lbmdpbmVfZmx1c2hfc3VibWlzc2lv
bihlbmdpbmUpOworCWV4cGVjdGVkW1JJTkdfVEFJTF9JRFhdID0gY2UtPnJpbmctPnRhaWw7CisK
KwlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQocnEsIDAsIEhaIC8gNSkgPCAwKSB7CisJCWVyciA9IC1F
VElNRTsKKwkJZ290byBlcnJfcnE7CisJfQorCisJY3MgPSBpOTE1X2dlbV9vYmplY3RfcGluX21h
cChzY3JhdGNoLT5vYmosIEk5MTVfTUFQX1dCKTsKKwlpZiAoSVNfRVJSKGNzKSkgeworCQllcnIg
PSBQVFJfRVJSKGNzKTsKKwkJZ290byBlcnJfcnE7CisJfQorCisJZm9yIChuID0gMDsgbiA8IE1B
WF9JRFg7IG4rKykgeworCQlpZiAoY3Nbbl0gIT0gZXhwZWN0ZWRbbl0pIHsKKwkJCXByX2Vycigi
JXM6IFN0b3JlZCByZWdpc3RlclslZF0gdmFsdWVbMHgleF0gZGlkIG5vdCBtYXRjaCBleHBlY3Rl
ZFsweCV4XVxuIiwKKwkJCSAgICAgICBlbmdpbmUtPm5hbWUsIG4sIGNzW25dLCBleHBlY3RlZFtu
XSk7CisJCQllcnIgPSAtRUlOVkFMOworCQkJYnJlYWs7CisJCX0KKwl9CisKKwlpOTE1X2dlbV9v
YmplY3RfdW5waW5fbWFwKHNjcmF0Y2gtPm9iaik7CisKK2Vycl9ycToKKwlpOTE1X3JlcXVlc3Rf
cHV0KHJxKTsKK2Vycl91bnBpbjoKKwlpbnRlbF9jb250ZXh0X3VucGluKGNlKTsKK2Vycl9wdXQ6
CisJaWYgKGVyciA9PSAtRURFQURMSykgeworCQllcnIgPSBpOTE1X2dlbV93d19jdHhfYmFja29m
Zigmd3cpOworCQlpZiAoIWVycikKKwkJCWdvdG8gcmV0cnk7CisJfQorCWk5MTVfZ2VtX3d3X2N0
eF9maW5pKCZ3dyk7CisJaW50ZWxfY29udGV4dF9wdXQoY2UpOworCXJldHVybiBlcnI7Cit9CisK
K3N0YXRpYyBpbnQgbGl2ZV9scmNfc3RhdGUodm9pZCAqYXJnKQoreworCXN0cnVjdCBpbnRlbF9n
dCAqZ3QgPSBhcmc7CisJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOworCXN0cnVjdCBp
OTE1X3ZtYSAqc2NyYXRjaDsKKwllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKKwlpbnQgZXJyID0g
MDsKKworCS8qCisJICogQ2hlY2sgdGhlIGxpdmUgcmVnaXN0ZXIgc3RhdGUgbWF0Y2hlcyB3aGF0
IHdlIGV4cGVjdCBmb3IgdGhpcworCSAqIGludGVsX2NvbnRleHQuCisJICovCisKKwlzY3JhdGNo
ID0gY3JlYXRlX3NjcmF0Y2goZ3QpOworCWlmIChJU19FUlIoc2NyYXRjaCkpCisJCXJldHVybiBQ
VFJfRVJSKHNjcmF0Y2gpOworCisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7CisJ
CWVyciA9IF9fbGl2ZV9scmNfc3RhdGUoZW5naW5lLCBzY3JhdGNoKTsKKwkJaWYgKGVycikKKwkJ
CWJyZWFrOworCX0KKworCWlmIChpZ3RfZmx1c2hfdGVzdChndC0+aTkxNSkpCisJCWVyciA9IC1F
SU87CisKKwlpOTE1X3ZtYV91bnBpbl9hbmRfcmVsZWFzZSgmc2NyYXRjaCwgMCk7CisJcmV0dXJu
IGVycjsKK30KKworc3RhdGljIGludCBncHJfbWFrZV9kaXJ0eShzdHJ1Y3QgaW50ZWxfY29udGV4
dCAqY2UpCit7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7CisJdTMyICpjczsKKwlpbnQgbjsK
KworCXJxID0gaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVzdChjZSk7CisJaWYgKElTX0VSUihy
cSkpCisJCXJldHVybiBQVFJfRVJSKHJxKTsKKworCWNzID0gaW50ZWxfcmluZ19iZWdpbihycSwg
MiAqIE5VTV9HUFJfRFcgKyAyKTsKKwlpZiAoSVNfRVJSKGNzKSkgeworCQlpOTE1X3JlcXVlc3Rf
YWRkKHJxKTsKKwkJcmV0dXJuIFBUUl9FUlIoY3MpOworCX0KKworCSpjcysrID0gTUlfTE9BRF9S
RUdJU1RFUl9JTU0oTlVNX0dQUl9EVyk7CisJZm9yIChuID0gMDsgbiA8IE5VTV9HUFJfRFc7IG4r
KykgeworCQkqY3MrKyA9IENTX0dQUihjZS0+ZW5naW5lLCBuKTsKKwkJKmNzKysgPSBTVEFDS19N
QUdJQzsKKwl9CisJKmNzKysgPSBNSV9OT09QOworCisJaW50ZWxfcmluZ19hZHZhbmNlKHJxLCBj
cyk7CisKKwlycS0+c2NoZWQuYXR0ci5wcmlvcml0eSA9IEk5MTVfUFJJT1JJVFlfQkFSUklFUjsK
KwlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgc3RydWN0
IGk5MTVfcmVxdWVzdCAqCitfX2dwcl9yZWFkKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgc3Ry
dWN0IGk5MTVfdm1hICpzY3JhdGNoLCB1MzIgKnNsb3QpCit7CisJY29uc3QgdTMyIG9mZnNldCA9
CisJCWk5MTVfZ2d0dF9vZmZzZXQoY2UtPmVuZ2luZS0+c3RhdHVzX3BhZ2Uudm1hKSArCisJCW9m
ZnNldF9pbl9wYWdlKHNsb3QpOworCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOworCXUzMiAqY3M7
CisJaW50IGVycjsKKwlpbnQgbjsKKworCXJxID0gaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVz
dChjZSk7CisJaWYgKElTX0VSUihycSkpCisJCXJldHVybiBycTsKKworCWNzID0gaW50ZWxfcmlu
Z19iZWdpbihycSwgNiArIDQgKiBOVU1fR1BSX0RXKTsKKwlpZiAoSVNfRVJSKGNzKSkgeworCQlp
OTE1X3JlcXVlc3RfYWRkKHJxKTsKKwkJcmV0dXJuIEVSUl9DQVNUKGNzKTsKKwl9CisKKwkqY3Mr
KyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJfRU5BQkxFOworCSpjcysrID0gTUlfTk9PUDsKKwor
CSpjcysrID0gTUlfU0VNQVBIT1JFX1dBSVQgfAorCQlNSV9TRU1BUEhPUkVfR0xPQkFMX0dUVCB8
CisJCU1JX1NFTUFQSE9SRV9QT0xMIHwKKwkJTUlfU0VNQVBIT1JFX1NBRF9ORVFfU0REOworCSpj
cysrID0gMDsKKwkqY3MrKyA9IG9mZnNldDsKKwkqY3MrKyA9IDA7CisKKwlmb3IgKG4gPSAwOyBu
IDwgTlVNX0dQUl9EVzsgbisrKSB7CisJCSpjcysrID0gTUlfU1RPUkVfUkVHSVNURVJfTUVNX0dF
TjggfCBNSV9VU0VfR0dUVDsKKwkJKmNzKysgPSBDU19HUFIoY2UtPmVuZ2luZSwgbik7CisJCSpj
cysrID0gaTkxNV9nZ3R0X29mZnNldChzY3JhdGNoKSArIG4gKiBzaXplb2YodTMyKTsKKwkJKmNz
KysgPSAwOworCX0KKworCWk5MTVfdm1hX2xvY2soc2NyYXRjaCk7CisJZXJyID0gaTkxNV9yZXF1
ZXN0X2F3YWl0X29iamVjdChycSwgc2NyYXRjaC0+b2JqLCB0cnVlKTsKKwlpZiAoIWVycikKKwkJ
ZXJyID0gaTkxNV92bWFfbW92ZV90b19hY3RpdmUoc2NyYXRjaCwgcnEsIEVYRUNfT0JKRUNUX1dS
SVRFKTsKKwlpOTE1X3ZtYV91bmxvY2soc2NyYXRjaCk7CisKKwlpOTE1X3JlcXVlc3RfZ2V0KHJx
KTsKKwlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKKwlpZiAoZXJyKSB7CisJCWk5MTVfcmVxdWVzdF9w
dXQocnEpOworCQlycSA9IEVSUl9QVFIoZXJyKTsKKwl9CisKKwlyZXR1cm4gcnE7Cit9CisKK3N0
YXRpYyBpbnQgX19saXZlX2xyY19ncHIoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAor
CQkJICBzdHJ1Y3QgaTkxNV92bWEgKnNjcmF0Y2gsCisJCQkgIGJvb2wgcHJlZW1wdCkKK3sKKwl1
MzIgKnNsb3QgPSBtZW1zZXQzMihlbmdpbmUtPnN0YXR1c19wYWdlLmFkZHIgKyAxMDAwLCAwLCA0
KTsKKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7
CisJdTMyICpjczsKKwlpbnQgZXJyOworCWludCBuOworCisJaWYgKElOVEVMX0dFTihlbmdpbmUt
Pmk5MTUpIDwgOSAmJiBlbmdpbmUtPmNsYXNzICE9IFJFTkRFUl9DTEFTUykKKwkJcmV0dXJuIDA7
IC8qIEdQUiBvbmx5IG9uIHJjczAgZm9yIGdlbjggKi8KKworCWVyciA9IGdwcl9tYWtlX2RpcnR5
KGVuZ2luZS0+a2VybmVsX2NvbnRleHQpOworCWlmIChlcnIpCisJCXJldHVybiBlcnI7CisKKwlj
ZSA9IGludGVsX2NvbnRleHRfY3JlYXRlKGVuZ2luZSk7CisJaWYgKElTX0VSUihjZSkpCisJCXJl
dHVybiBQVFJfRVJSKGNlKTsKKworCXJxID0gX19ncHJfcmVhZChjZSwgc2NyYXRjaCwgc2xvdCk7
CisJaWYgKElTX0VSUihycSkpIHsKKwkJZXJyID0gUFRSX0VSUihycSk7CisJCWdvdG8gZXJyX3B1
dDsKKwl9CisKKwllcnIgPSB3YWl0X2Zvcl9zdWJtaXQoZW5naW5lLCBycSwgSFogLyAyKTsKKwlp
ZiAoZXJyKQorCQlnb3RvIGVycl9ycTsKKworCWlmIChwcmVlbXB0KSB7CisJCWVyciA9IGdwcl9t
YWtlX2RpcnR5KGVuZ2luZS0+a2VybmVsX2NvbnRleHQpOworCQlpZiAoZXJyKQorCQkJZ290byBl
cnJfcnE7CisKKwkJZXJyID0gZW1pdF9zZW1hcGhvcmVfc2lnbmFsKGVuZ2luZS0+a2VybmVsX2Nv
bnRleHQsIHNsb3QpOworCQlpZiAoZXJyKQorCQkJZ290byBlcnJfcnE7CisJfSBlbHNlIHsKKwkJ
c2xvdFswXSA9IDE7CisJCXdtYigpOworCX0KKworCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwg
MCwgSFogLyA1KSA8IDApIHsKKwkJZXJyID0gLUVUSU1FOworCQlnb3RvIGVycl9ycTsKKwl9CisK
KwljcyA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKHNjcmF0Y2gtPm9iaiwgSTkxNV9NQVBfV0Ip
OworCWlmIChJU19FUlIoY3MpKSB7CisJCWVyciA9IFBUUl9FUlIoY3MpOworCQlnb3RvIGVycl9y
cTsKKwl9CisKKwlmb3IgKG4gPSAwOyBuIDwgTlVNX0dQUl9EVzsgbisrKSB7CisJCWlmIChjc1tu
XSkgeworCQkJcHJfZXJyKCIlczogR1BSWyVkXS4lcyB3YXMgbm90IHplcm8sIGZvdW5kIDB4JTA4
eCFcbiIsCisJCQkgICAgICAgZW5naW5lLT5uYW1lLAorCQkJICAgICAgIG4gLyAyLCBuICYgMSA/
ICJ1ZHciIDogImxkdyIsCisJCQkgICAgICAgY3Nbbl0pOworCQkJZXJyID0gLUVJTlZBTDsKKwkJ
CWJyZWFrOworCQl9CisJfQorCisJaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChzY3JhdGNoLT5v
YmopOworCitlcnJfcnE6CisJbWVtc2V0MzIoJnNsb3RbMF0sIC0xLCA0KTsKKwl3bWIoKTsKKwlp
OTE1X3JlcXVlc3RfcHV0KHJxKTsKK2Vycl9wdXQ6CisJaW50ZWxfY29udGV4dF9wdXQoY2UpOwor
CXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBpbnQgbGl2ZV9scmNfZ3ByKHZvaWQgKmFyZykKK3sK
KwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOworCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZTsKKwlzdHJ1Y3QgaTkxNV92bWEgKnNjcmF0Y2g7CisJZW51bSBpbnRlbF9lbmdpbmVfaWQg
aWQ7CisJaW50IGVyciA9IDA7CisKKwkvKgorCSAqIENoZWNrIHRoYXQgR1BSIHJlZ2lzdGVycyBh
cmUgY2xlYXJlZCBpbiBuZXcgY29udGV4dHMgYXMgd2UgbmVlZAorCSAqIHRvIGF2b2lkIGxlYWtp
bmcgYW55IGluZm9ybWF0aW9uIGZyb20gcHJldmlvdXMgY29udGV4dHMuCisJICovCisKKwlzY3Jh
dGNoID0gY3JlYXRlX3NjcmF0Y2goZ3QpOworCWlmIChJU19FUlIoc2NyYXRjaCkpCisJCXJldHVy
biBQVFJfRVJSKHNjcmF0Y2gpOworCisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7
CisJCXN0X2VuZ2luZV9oZWFydGJlYXRfZGlzYWJsZShlbmdpbmUpOworCisJCWVyciA9IF9fbGl2
ZV9scmNfZ3ByKGVuZ2luZSwgc2NyYXRjaCwgZmFsc2UpOworCQlpZiAoZXJyKQorCQkJZ290byBl
cnI7CisKKwkJZXJyID0gX19saXZlX2xyY19ncHIoZW5naW5lLCBzY3JhdGNoLCB0cnVlKTsKKwkJ
aWYgKGVycikKKwkJCWdvdG8gZXJyOworCitlcnI6CisJCXN0X2VuZ2luZV9oZWFydGJlYXRfZW5h
YmxlKGVuZ2luZSk7CisJCWlmIChpZ3RfZmx1c2hfdGVzdChndC0+aTkxNSkpCisJCQllcnIgPSAt
RUlPOworCQlpZiAoZXJyKQorCQkJYnJlYWs7CisJfQorCisJaTkxNV92bWFfdW5waW5fYW5kX3Jl
bGVhc2UoJnNjcmF0Y2gsIDApOworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICoKK2NyZWF0ZV90aW1lc3RhbXAoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCB2
b2lkICpzbG90LCBpbnQgaWR4KQoreworCWNvbnN0IHUzMiBvZmZzZXQgPQorCQlpOTE1X2dndHRf
b2Zmc2V0KGNlLT5lbmdpbmUtPnN0YXR1c19wYWdlLnZtYSkgKworCQlvZmZzZXRfaW5fcGFnZShz
bG90KTsKKwlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKKwl1MzIgKmNzOworCWludCBlcnI7CisK
KwlycSA9IGludGVsX2NvbnRleHRfY3JlYXRlX3JlcXVlc3QoY2UpOworCWlmIChJU19FUlIocnEp
KQorCQlyZXR1cm4gcnE7CisKKwljcyA9IGludGVsX3JpbmdfYmVnaW4ocnEsIDEwKTsKKwlpZiAo
SVNfRVJSKGNzKSkgeworCQllcnIgPSBQVFJfRVJSKGNzKTsKKwkJZ290byBlcnI7CisJfQorCisJ
KmNzKysgPSBNSV9BUkJfT05fT0ZGIHwgTUlfQVJCX0VOQUJMRTsKKwkqY3MrKyA9IE1JX05PT1A7
CisKKwkqY3MrKyA9IE1JX1NFTUFQSE9SRV9XQUlUIHwKKwkJTUlfU0VNQVBIT1JFX0dMT0JBTF9H
VFQgfAorCQlNSV9TRU1BUEhPUkVfUE9MTCB8CisJCU1JX1NFTUFQSE9SRV9TQURfTkVRX1NERDsK
KwkqY3MrKyA9IDA7CisJKmNzKysgPSBvZmZzZXQ7CisJKmNzKysgPSAwOworCisJKmNzKysgPSBN
SV9TVE9SRV9SRUdJU1RFUl9NRU1fR0VOOCB8IE1JX1VTRV9HR1RUOworCSpjcysrID0gaTkxNV9t
bWlvX3JlZ19vZmZzZXQoUklOR19DVFhfVElNRVNUQU1QKHJxLT5lbmdpbmUtPm1taW9fYmFzZSkp
OworCSpjcysrID0gb2Zmc2V0ICsgaWR4ICogc2l6ZW9mKHUzMik7CisJKmNzKysgPSAwOworCisJ
aW50ZWxfcmluZ19hZHZhbmNlKHJxLCBjcyk7CisKKwlycS0+c2NoZWQuYXR0ci5wcmlvcml0eSA9
IEk5MTVfUFJJT1JJVFlfTUFTSzsKKwllcnIgPSAwOworZXJyOgorCWk5MTVfcmVxdWVzdF9nZXQo
cnEpOworCWk5MTVfcmVxdWVzdF9hZGQocnEpOworCWlmIChlcnIpIHsKKwkJaTkxNV9yZXF1ZXN0
X3B1dChycSk7CisJCXJldHVybiBFUlJfUFRSKGVycik7CisJfQorCisJcmV0dXJuIHJxOworfQor
CitzdHJ1Y3QgbHJjX3RpbWVzdGFtcCB7CisJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
OworCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZVsyXTsKKwl1MzIgcG9pc29uOworfTsKKworc3Rh
dGljIGJvb2wgdGltZXN0YW1wX2FkdmFuY2VkKHUzMiBzdGFydCwgdTMyIGVuZCkKK3sKKwlyZXR1
cm4gKHMzMikoZW5kIC0gc3RhcnQpID4gMDsKK30KKworc3RhdGljIGludCBfX2xyY190aW1lc3Rh
bXAoY29uc3Qgc3RydWN0IGxyY190aW1lc3RhbXAgKmFyZywgYm9vbCBwcmVlbXB0KQoreworCXUz
MiAqc2xvdCA9IG1lbXNldDMyKGFyZy0+ZW5naW5lLT5zdGF0dXNfcGFnZS5hZGRyICsgMTAwMCwg
MCwgNCk7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7CisJdTMyIHRpbWVzdGFtcDsKKwlpbnQg
ZXJyID0gMDsKKworCWFyZy0+Y2VbMF0tPmxyY19yZWdfc3RhdGVbQ1RYX1RJTUVTVEFNUF0gPSBh
cmctPnBvaXNvbjsKKwlycSA9IGNyZWF0ZV90aW1lc3RhbXAoYXJnLT5jZVswXSwgc2xvdCwgMSk7
CisJaWYgKElTX0VSUihycSkpCisJCXJldHVybiBQVFJfRVJSKHJxKTsKKworCWVyciA9IHdhaXRf
Zm9yX3N1Ym1pdChycS0+ZW5naW5lLCBycSwgSFogLyAyKTsKKwlpZiAoZXJyKQorCQlnb3RvIGVy
cjsKKworCWlmIChwcmVlbXB0KSB7CisJCWFyZy0+Y2VbMV0tPmxyY19yZWdfc3RhdGVbQ1RYX1RJ
TUVTVEFNUF0gPSAweGRlYWRiZWVmOworCQllcnIgPSBlbWl0X3NlbWFwaG9yZV9zaWduYWwoYXJn
LT5jZVsxXSwgc2xvdCk7CisJCWlmIChlcnIpCisJCQlnb3RvIGVycjsKKwl9IGVsc2UgeworCQlz
bG90WzBdID0gMTsKKwkJd21iKCk7CisJfQorCisJLyogQW5kIHdhaXQgZm9yIHN3aXRjaCB0byBr
ZXJuZWwgKHRvIHNhdmUgb3VyIGNvbnRleHQgdG8gbWVtb3J5KSAqLworCWVyciA9IGNvbnRleHRf
Zmx1c2goYXJnLT5jZVswXSwgSFogLyAyKTsKKwlpZiAoZXJyKQorCQlnb3RvIGVycjsKKworCWlm
ICghdGltZXN0YW1wX2FkdmFuY2VkKGFyZy0+cG9pc29uLCBzbG90WzFdKSkgeworCQlwcl9lcnIo
IiVzKCVzKTogaW52YWxpZCB0aW1lc3RhbXAgb24gcmVzdG9yZSwgY29udGV4dDoleCwgcmVxdWVz
dDoleFxuIiwKKwkJICAgICAgIGFyZy0+ZW5naW5lLT5uYW1lLCBwcmVlbXB0ID8gInByZWVtcHQi
IDogInNpbXBsZSIsCisJCSAgICAgICBhcmctPnBvaXNvbiwgc2xvdFsxXSk7CisJCWVyciA9IC1F
SU5WQUw7CisJfQorCisJdGltZXN0YW1wID0gUkVBRF9PTkNFKGFyZy0+Y2VbMF0tPmxyY19yZWdf
c3RhdGVbQ1RYX1RJTUVTVEFNUF0pOworCWlmICghdGltZXN0YW1wX2FkdmFuY2VkKHNsb3RbMV0s
IHRpbWVzdGFtcCkpIHsKKwkJcHJfZXJyKCIlcyglcyk6IGludmFsaWQgdGltZXN0YW1wIG9uIHNh
dmUsIHJlcXVlc3Q6JXgsIGNvbnRleHQ6JXhcbiIsCisJCSAgICAgICBhcmctPmVuZ2luZS0+bmFt
ZSwgcHJlZW1wdCA/ICJwcmVlbXB0IiA6ICJzaW1wbGUiLAorCQkgICAgICAgc2xvdFsxXSwgdGlt
ZXN0YW1wKTsKKwkJZXJyID0gLUVJTlZBTDsKKwl9CisKK2VycjoKKwltZW1zZXQzMihzbG90LCAt
MSwgNCk7CisJaTkxNV9yZXF1ZXN0X3B1dChycSk7CisJcmV0dXJuIGVycjsKK30KKworc3RhdGlj
IGludCBsaXZlX2xyY190aW1lc3RhbXAodm9pZCAqYXJnKQoreworCXN0cnVjdCBscmNfdGltZXN0
YW1wIGRhdGEgPSB7fTsKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOworCWVudW0gaW50ZWxf
ZW5naW5lX2lkIGlkOworCWNvbnN0IHUzMiBwb2lzb25bXSA9IHsKKwkJMCwKKwkJUzMyX01BWCwK
KwkJKHUzMilTMzJfTUFYICsgMSwKKwkJVTMyX01BWCwKKwl9OworCisJLyoKKwkgKiBXZSB3YW50
IHRvIHZlcmlmeSB0aGF0IHRoZSB0aW1lc3RhbXAgaXMgc2F2ZWQgYW5kIHJlc3RvcmUgYWNyb3Nz
CisJICogY29udGV4dCBzd2l0Y2hlcyBhbmQgaXMgbW9ub3RvbmljLgorCSAqCisJICogU28gd2Ug
ZG8gdGhpcyB3aXRoIGEgbGl0dGxlIGJpdCBvZiBMUkMgcG9pc29uaW5nIHRvIGNoZWNrIHZhcmlv
dXMKKwkgKiBib3VuZGFyeSBjb25kaXRpb25zLCBhbmQgc2VlIHdoYXQgaGFwcGVucyBpZiB3ZSBw
cmVlbXB0IHRoZSBjb250ZXh0CisJICogd2l0aCBhIHNlY29uZCByZXF1ZXN0IChjYXJyeWluZyBt
b3JlIHBvaXNvbiBpbnRvIHRoZSB0aW1lc3RhbXApLgorCSAqLworCisJZm9yX2VhY2hfZW5naW5l
KGRhdGEuZW5naW5lLCBndCwgaWQpIHsKKwkJaW50IGksIGVyciA9IDA7CisKKwkJc3RfZW5naW5l
X2hlYXJ0YmVhdF9kaXNhYmxlKGRhdGEuZW5naW5lKTsKKworCQlmb3IgKGkgPSAwOyBpIDwgQVJS
QVlfU0laRShkYXRhLmNlKTsgaSsrKSB7CisJCQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqdG1wOwor
CisJCQl0bXAgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZShkYXRhLmVuZ2luZSk7CisJCQlpZiAoSVNf
RVJSKHRtcCkpIHsKKwkJCQllcnIgPSBQVFJfRVJSKHRtcCk7CisJCQkJZ290byBlcnI7CisJCQl9
CisKKwkJCWVyciA9IGludGVsX2NvbnRleHRfcGluKHRtcCk7CisJCQlpZiAoZXJyKSB7CisJCQkJ
aW50ZWxfY29udGV4dF9wdXQodG1wKTsKKwkJCQlnb3RvIGVycjsKKwkJCX0KKworCQkJZGF0YS5j
ZVtpXSA9IHRtcDsKKwkJfQorCisJCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKHBvaXNvbik7
IGkrKykgeworCQkJZGF0YS5wb2lzb24gPSBwb2lzb25baV07CisKKwkJCWVyciA9IF9fbHJjX3Rp
bWVzdGFtcCgmZGF0YSwgZmFsc2UpOworCQkJaWYgKGVycikKKwkJCQlicmVhazsKKworCQkJZXJy
ID0gX19scmNfdGltZXN0YW1wKCZkYXRhLCB0cnVlKTsKKwkJCWlmIChlcnIpCisJCQkJYnJlYWs7
CisJCX0KKworZXJyOgorCQlzdF9lbmdpbmVfaGVhcnRiZWF0X2VuYWJsZShkYXRhLmVuZ2luZSk7
CisJCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGRhdGEuY2UpOyBpKyspIHsKKwkJCWlmICgh
ZGF0YS5jZVtpXSkKKwkJCQlicmVhazsKKworCQkJaW50ZWxfY29udGV4dF91bnBpbihkYXRhLmNl
W2ldKTsKKwkJCWludGVsX2NvbnRleHRfcHV0KGRhdGEuY2VbaV0pOworCQl9CisKKwkJaWYgKGln
dF9mbHVzaF90ZXN0KGd0LT5pOTE1KSkKKwkJCWVyciA9IC1FSU87CisJCWlmIChlcnIpCisJCQly
ZXR1cm4gZXJyOworCX0KKworCXJldHVybiAwOworfQorCitzdGF0aWMgc3RydWN0IGk5MTVfdm1h
ICoKK2NyZWF0ZV91c2VyX3ZtYShzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSwgdW5zaWdu
ZWQgbG9uZyBzaXplKQoreworCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CisJc3Ry
dWN0IGk5MTVfdm1hICp2bWE7CisJaW50IGVycjsKKworCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9j
cmVhdGVfaW50ZXJuYWwodm0tPmk5MTUsIHNpemUpOworCWlmIChJU19FUlIob2JqKSkKKwkJcmV0
dXJuIEVSUl9DQVNUKG9iaik7CisKKwl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosIHZtLCBO
VUxMKTsKKwlpZiAoSVNfRVJSKHZtYSkpIHsKKwkJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOwor
CQlyZXR1cm4gdm1hOworCX0KKworCWVyciA9IGk5MTVfdm1hX3Bpbih2bWEsIDAsIDAsIFBJTl9V
U0VSKTsKKwlpZiAoZXJyKSB7CisJCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKKwkJcmV0dXJu
IEVSUl9QVFIoZXJyKTsKKwl9CisKKwlyZXR1cm4gdm1hOworfQorCitzdGF0aWMgc3RydWN0IGk5
MTVfdm1hICoKK3N0b3JlX2NvbnRleHQoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCBzdHJ1Y3Qg
aTkxNV92bWEgKnNjcmF0Y2gpCit7CisJc3RydWN0IGk5MTVfdm1hICpiYXRjaDsKKwl1MzIgZHcs
IHgsICpjcywgKmh3OworCXUzMiAqZGVmYXVsdHM7CisKKwliYXRjaCA9IGNyZWF0ZV91c2VyX3Zt
YShjZS0+dm0sIFNaXzY0Syk7CisJaWYgKElTX0VSUihiYXRjaCkpCisJCXJldHVybiBiYXRjaDsK
KworCWNzID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAoYmF0Y2gtPm9iaiwgSTkxNV9NQVBfV0Mp
OworCWlmIChJU19FUlIoY3MpKSB7CisJCWk5MTVfdm1hX3B1dChiYXRjaCk7CisJCXJldHVybiBF
UlJfQ0FTVChjcyk7CisJfQorCisJZGVmYXVsdHMgPSBzaG1lbV9waW5fbWFwKGNlLT5lbmdpbmUt
PmRlZmF1bHRfc3RhdGUpOworCWlmICghZGVmYXVsdHMpIHsKKwkJaTkxNV9nZW1fb2JqZWN0X3Vu
cGluX21hcChiYXRjaC0+b2JqKTsKKwkJaTkxNV92bWFfcHV0KGJhdGNoKTsKKwkJcmV0dXJuIEVS
Ul9QVFIoLUVOT01FTSk7CisJfQorCisJeCA9IDA7CisJZHcgPSAwOworCWh3ID0gZGVmYXVsdHM7
CisJaHcgKz0gTFJDX1NUQVRFX09GRlNFVCAvIHNpemVvZigqaHcpOworCWRvIHsKKwkJdTMyIGxl
biA9IGh3W2R3XSAmIDB4N2Y7CisKKwkJaWYgKGh3W2R3XSA9PSAwKSB7CisJCQlkdysrOworCQkJ
Y29udGludWU7CisJCX0KKworCQlpZiAoKGh3W2R3XSAmIEdFTk1BU0soMzEsIDIzKSkgIT0gTUlf
SU5TVFIoMHgyMiwgMCkpIHsKKwkJCWR3ICs9IGxlbiArIDI7CisJCQljb250aW51ZTsKKwkJfQor
CisJCWR3Kys7CisJCWxlbiA9IChsZW4gKyAxKSAvIDI7CisJCXdoaWxlIChsZW4tLSkgeworCQkJ
KmNzKysgPSBNSV9TVE9SRV9SRUdJU1RFUl9NRU1fR0VOODsKKwkJCSpjcysrID0gaHdbZHddOwor
CQkJKmNzKysgPSBsb3dlcl8zMl9iaXRzKHNjcmF0Y2gtPm5vZGUuc3RhcnQgKyB4KTsKKwkJCSpj
cysrID0gdXBwZXJfMzJfYml0cyhzY3JhdGNoLT5ub2RlLnN0YXJ0ICsgeCk7CisKKwkJCWR3ICs9
IDI7CisJCQl4ICs9IDQ7CisJCX0KKwl9IHdoaWxlIChkdyA8IFBBR0VfU0laRSAvIHNpemVvZih1
MzIpICYmCisJCSAoaHdbZHddICYgfkJJVCgwKSkgIT0gTUlfQkFUQ0hfQlVGRkVSX0VORCk7CisK
KwkqY3MrKyA9IE1JX0JBVENIX0JVRkZFUl9FTkQ7CisKKwlzaG1lbV91bnBpbl9tYXAoY2UtPmVu
Z2luZS0+ZGVmYXVsdF9zdGF0ZSwgZGVmYXVsdHMpOworCisJaTkxNV9nZW1fb2JqZWN0X2ZsdXNo
X21hcChiYXRjaC0+b2JqKTsKKwlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKGJhdGNoLT5vYmop
OworCisJcmV0dXJuIGJhdGNoOworfQorCitzdGF0aWMgaW50IG1vdmVfdG9fYWN0aXZlKHN0cnVj
dCBpOTE1X3JlcXVlc3QgKnJxLAorCQkJICBzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKKwkJCSAgdW5z
aWduZWQgaW50IGZsYWdzKQoreworCWludCBlcnI7CisKKwlpOTE1X3ZtYV9sb2NrKHZtYSk7CisJ
ZXJyID0gaTkxNV9yZXF1ZXN0X2F3YWl0X29iamVjdChycSwgdm1hLT5vYmosIGZsYWdzKTsKKwlp
ZiAoIWVycikKKwkJZXJyID0gaTkxNV92bWFfbW92ZV90b19hY3RpdmUodm1hLCBycSwgZmxhZ3Mp
OworCWk5MTVfdm1hX3VubG9jayh2bWEpOworCisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIHN0
cnVjdCBpOTE1X3JlcXVlc3QgKgorcmVjb3JkX3JlZ2lzdGVycyhzdHJ1Y3QgaW50ZWxfY29udGV4
dCAqY2UsCisJCSBzdHJ1Y3QgaTkxNV92bWEgKmJlZm9yZSwKKwkJIHN0cnVjdCBpOTE1X3ZtYSAq
YWZ0ZXIsCisJCSB1MzIgKnNlbWEpCit7CisJc3RydWN0IGk5MTVfdm1hICpiX2JlZm9yZSwgKmJf
YWZ0ZXI7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7CisJdTMyICpjczsKKwlpbnQgZXJyOwor
CisJYl9iZWZvcmUgPSBzdG9yZV9jb250ZXh0KGNlLCBiZWZvcmUpOworCWlmIChJU19FUlIoYl9i
ZWZvcmUpKQorCQlyZXR1cm4gRVJSX0NBU1QoYl9iZWZvcmUpOworCisJYl9hZnRlciA9IHN0b3Jl
X2NvbnRleHQoY2UsIGFmdGVyKTsKKwlpZiAoSVNfRVJSKGJfYWZ0ZXIpKSB7CisJCXJxID0gRVJS
X0NBU1QoYl9hZnRlcik7CisJCWdvdG8gZXJyX2JlZm9yZTsKKwl9CisKKwlycSA9IGludGVsX2Nv
bnRleHRfY3JlYXRlX3JlcXVlc3QoY2UpOworCWlmIChJU19FUlIocnEpKQorCQlnb3RvIGVycl9h
ZnRlcjsKKworCWVyciA9IG1vdmVfdG9fYWN0aXZlKHJxLCBiZWZvcmUsIEVYRUNfT0JKRUNUX1dS
SVRFKTsKKwlpZiAoZXJyKQorCQlnb3RvIGVycl9ycTsKKworCWVyciA9IG1vdmVfdG9fYWN0aXZl
KHJxLCBiX2JlZm9yZSwgMCk7CisJaWYgKGVycikKKwkJZ290byBlcnJfcnE7CisKKwllcnIgPSBt
b3ZlX3RvX2FjdGl2ZShycSwgYWZ0ZXIsIEVYRUNfT0JKRUNUX1dSSVRFKTsKKwlpZiAoZXJyKQor
CQlnb3RvIGVycl9ycTsKKworCWVyciA9IG1vdmVfdG9fYWN0aXZlKHJxLCBiX2FmdGVyLCAwKTsK
KwlpZiAoZXJyKQorCQlnb3RvIGVycl9ycTsKKworCWNzID0gaW50ZWxfcmluZ19iZWdpbihycSwg
MTQpOworCWlmIChJU19FUlIoY3MpKSB7CisJCWVyciA9IFBUUl9FUlIoY3MpOworCQlnb3RvIGVy
cl9ycTsKKwl9CisKKwkqY3MrKyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJfRElTQUJMRTsKKwkq
Y3MrKyA9IE1JX0JBVENIX0JVRkZFUl9TVEFSVF9HRU44IHwgQklUKDgpOworCSpjcysrID0gbG93
ZXJfMzJfYml0cyhiX2JlZm9yZS0+bm9kZS5zdGFydCk7CisJKmNzKysgPSB1cHBlcl8zMl9iaXRz
KGJfYmVmb3JlLT5ub2RlLnN0YXJ0KTsKKworCSpjcysrID0gTUlfQVJCX09OX09GRiB8IE1JX0FS
Ql9FTkFCTEU7CisJKmNzKysgPSBNSV9TRU1BUEhPUkVfV0FJVCB8CisJCU1JX1NFTUFQSE9SRV9H
TE9CQUxfR1RUIHwKKwkJTUlfU0VNQVBIT1JFX1BPTEwgfAorCQlNSV9TRU1BUEhPUkVfU0FEX05F
UV9TREQ7CisJKmNzKysgPSAwOworCSpjcysrID0gaTkxNV9nZ3R0X29mZnNldChjZS0+ZW5naW5l
LT5zdGF0dXNfcGFnZS52bWEpICsKKwkJb2Zmc2V0X2luX3BhZ2Uoc2VtYSk7CisJKmNzKysgPSAw
OworCSpjcysrID0gTUlfTk9PUDsKKworCSpjcysrID0gTUlfQVJCX09OX09GRiB8IE1JX0FSQl9E
SVNBQkxFOworCSpjcysrID0gTUlfQkFUQ0hfQlVGRkVSX1NUQVJUX0dFTjggfCBCSVQoOCk7CisJ
KmNzKysgPSBsb3dlcl8zMl9iaXRzKGJfYWZ0ZXItPm5vZGUuc3RhcnQpOworCSpjcysrID0gdXBw
ZXJfMzJfYml0cyhiX2FmdGVyLT5ub2RlLnN0YXJ0KTsKKworCWludGVsX3JpbmdfYWR2YW5jZShy
cSwgY3MpOworCisJV1JJVEVfT05DRSgqc2VtYSwgMCk7CisJaTkxNV9yZXF1ZXN0X2dldChycSk7
CisJaTkxNV9yZXF1ZXN0X2FkZChycSk7CitlcnJfYWZ0ZXI6CisJaTkxNV92bWFfcHV0KGJfYWZ0
ZXIpOworZXJyX2JlZm9yZToKKwlpOTE1X3ZtYV9wdXQoYl9iZWZvcmUpOworCXJldHVybiBycTsK
KworZXJyX3JxOgorCWk5MTVfcmVxdWVzdF9hZGQocnEpOworCXJxID0gRVJSX1BUUihlcnIpOwor
CWdvdG8gZXJyX2FmdGVyOworfQorCitzdGF0aWMgc3RydWN0IGk5MTVfdm1hICpsb2FkX2NvbnRl
eHQoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCB1MzIgcG9pc29uKQoreworCXN0cnVjdCBpOTE1
X3ZtYSAqYmF0Y2g7CisJdTMyIGR3LCAqY3MsICpodzsKKwl1MzIgKmRlZmF1bHRzOworCisJYmF0
Y2ggPSBjcmVhdGVfdXNlcl92bWEoY2UtPnZtLCBTWl82NEspOworCWlmIChJU19FUlIoYmF0Y2gp
KQorCQlyZXR1cm4gYmF0Y2g7CisKKwljcyA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKGJhdGNo
LT5vYmosIEk5MTVfTUFQX1dDKTsKKwlpZiAoSVNfRVJSKGNzKSkgeworCQlpOTE1X3ZtYV9wdXQo
YmF0Y2gpOworCQlyZXR1cm4gRVJSX0NBU1QoY3MpOworCX0KKworCWRlZmF1bHRzID0gc2htZW1f
cGluX21hcChjZS0+ZW5naW5lLT5kZWZhdWx0X3N0YXRlKTsKKwlpZiAoIWRlZmF1bHRzKSB7CisJ
CWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAoYmF0Y2gtPm9iaik7CisJCWk5MTVfdm1hX3B1dChi
YXRjaCk7CisJCXJldHVybiBFUlJfUFRSKC1FTk9NRU0pOworCX0KKworCWR3ID0gMDsKKwlodyA9
IGRlZmF1bHRzOworCWh3ICs9IExSQ19TVEFURV9PRkZTRVQgLyBzaXplb2YoKmh3KTsKKwlkbyB7
CisJCXUzMiBsZW4gPSBod1tkd10gJiAweDdmOworCisJCWlmIChod1tkd10gPT0gMCkgeworCQkJ
ZHcrKzsKKwkJCWNvbnRpbnVlOworCQl9CisKKwkJaWYgKChod1tkd10gJiBHRU5NQVNLKDMxLCAy
MykpICE9IE1JX0lOU1RSKDB4MjIsIDApKSB7CisJCQlkdyArPSBsZW4gKyAyOworCQkJY29udGlu
dWU7CisJCX0KKworCQlkdysrOworCQlsZW4gPSAobGVuICsgMSkgLyAyOworCQkqY3MrKyA9IE1J
X0xPQURfUkVHSVNURVJfSU1NKGxlbik7CisJCXdoaWxlIChsZW4tLSkgeworCQkJKmNzKysgPSBo
d1tkd107CisJCQkqY3MrKyA9IHBvaXNvbjsKKwkJCWR3ICs9IDI7CisJCX0KKwl9IHdoaWxlIChk
dyA8IFBBR0VfU0laRSAvIHNpemVvZih1MzIpICYmCisJCSAoaHdbZHddICYgfkJJVCgwKSkgIT0g
TUlfQkFUQ0hfQlVGRkVSX0VORCk7CisKKwkqY3MrKyA9IE1JX0JBVENIX0JVRkZFUl9FTkQ7CisK
KwlzaG1lbV91bnBpbl9tYXAoY2UtPmVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSwgZGVmYXVsdHMpOwor
CisJaTkxNV9nZW1fb2JqZWN0X2ZsdXNoX21hcChiYXRjaC0+b2JqKTsKKwlpOTE1X2dlbV9vYmpl
Y3RfdW5waW5fbWFwKGJhdGNoLT5vYmopOworCisJcmV0dXJuIGJhdGNoOworfQorCitzdGF0aWMg
aW50IHBvaXNvbl9yZWdpc3RlcnMoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCB1MzIgcG9pc29u
LCB1MzIgKnNlbWEpCit7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7CisJc3RydWN0IGk5MTVf
dm1hICpiYXRjaDsKKwl1MzIgKmNzOworCWludCBlcnI7CisKKwliYXRjaCA9IGxvYWRfY29udGV4
dChjZSwgcG9pc29uKTsKKwlpZiAoSVNfRVJSKGJhdGNoKSkKKwkJcmV0dXJuIFBUUl9FUlIoYmF0
Y2gpOworCisJcnEgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZV9yZXF1ZXN0KGNlKTsKKwlpZiAoSVNf
RVJSKHJxKSkgeworCQllcnIgPSBQVFJfRVJSKHJxKTsKKwkJZ290byBlcnJfYmF0Y2g7CisJfQor
CisJZXJyID0gbW92ZV90b19hY3RpdmUocnEsIGJhdGNoLCAwKTsKKwlpZiAoZXJyKQorCQlnb3Rv
IGVycl9ycTsKKworCWNzID0gaW50ZWxfcmluZ19iZWdpbihycSwgOCk7CisJaWYgKElTX0VSUihj
cykpIHsKKwkJZXJyID0gUFRSX0VSUihjcyk7CisJCWdvdG8gZXJyX3JxOworCX0KKworCSpjcysr
ID0gTUlfQVJCX09OX09GRiB8IE1JX0FSQl9ESVNBQkxFOworCSpjcysrID0gTUlfQkFUQ0hfQlVG
RkVSX1NUQVJUX0dFTjggfCBCSVQoOCk7CisJKmNzKysgPSBsb3dlcl8zMl9iaXRzKGJhdGNoLT5u
b2RlLnN0YXJ0KTsKKwkqY3MrKyA9IHVwcGVyXzMyX2JpdHMoYmF0Y2gtPm5vZGUuc3RhcnQpOwor
CisJKmNzKysgPSBNSV9TVE9SRV9EV09SRF9JTU1fR0VONCB8IE1JX1VTRV9HR1RUOworCSpjcysr
ID0gaTkxNV9nZ3R0X29mZnNldChjZS0+ZW5naW5lLT5zdGF0dXNfcGFnZS52bWEpICsKKwkJb2Zm
c2V0X2luX3BhZ2Uoc2VtYSk7CisJKmNzKysgPSAwOworCSpjcysrID0gMTsKKworCWludGVsX3Jp
bmdfYWR2YW5jZShycSwgY3MpOworCisJcnEtPnNjaGVkLmF0dHIucHJpb3JpdHkgPSBJOTE1X1BS
SU9SSVRZX0JBUlJJRVI7CitlcnJfcnE6CisJaTkxNV9yZXF1ZXN0X2FkZChycSk7CitlcnJfYmF0
Y2g6CisJaTkxNV92bWFfcHV0KGJhdGNoKTsKKwlyZXR1cm4gZXJyOworfQorCitzdGF0aWMgYm9v
bCBpc19tb3ZpbmcodTMyIGEsIHUzMiBiKQoreworCXJldHVybiBhICE9IGI7Cit9CisKK3N0YXRp
YyBpbnQgY29tcGFyZV9pc29sYXRpb24oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAor
CQkJICAgICBzdHJ1Y3QgaTkxNV92bWEgKnJlZlsyXSwKKwkJCSAgICAgc3RydWN0IGk5MTVfdm1h
ICpyZXN1bHRbMl0sCisJCQkgICAgIHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJCSAgICAg
dTMyIHBvaXNvbikKK3sKKwl1MzIgeCwgZHcsICpodywgKmxyYzsKKwl1MzIgKkFbMl0sICpCWzJd
OworCXUzMiAqZGVmYXVsdHM7CisJaW50IGVyciA9IDA7CisKKwlBWzBdID0gaTkxNV9nZW1fb2Jq
ZWN0X3Bpbl9tYXAocmVmWzBdLT5vYmosIEk5MTVfTUFQX1dDKTsKKwlpZiAoSVNfRVJSKEFbMF0p
KQorCQlyZXR1cm4gUFRSX0VSUihBWzBdKTsKKworCUFbMV0gPSBpOTE1X2dlbV9vYmplY3RfcGlu
X21hcChyZWZbMV0tPm9iaiwgSTkxNV9NQVBfV0MpOworCWlmIChJU19FUlIoQVsxXSkpIHsKKwkJ
ZXJyID0gUFRSX0VSUihBWzFdKTsKKwkJZ290byBlcnJfQTA7CisJfQorCisJQlswXSA9IGk5MTVf
Z2VtX29iamVjdF9waW5fbWFwKHJlc3VsdFswXS0+b2JqLCBJOTE1X01BUF9XQyk7CisJaWYgKElT
X0VSUihCWzBdKSkgeworCQllcnIgPSBQVFJfRVJSKEJbMF0pOworCQlnb3RvIGVycl9BMTsKKwl9
CisKKwlCWzFdID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAocmVzdWx0WzFdLT5vYmosIEk5MTVf
TUFQX1dDKTsKKwlpZiAoSVNfRVJSKEJbMV0pKSB7CisJCWVyciA9IFBUUl9FUlIoQlsxXSk7CisJ
CWdvdG8gZXJyX0IwOworCX0KKworCWxyYyA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKGNlLT5z
dGF0ZS0+b2JqLAorCQkJCSAgICAgIGk5MTVfY29oZXJlbnRfbWFwX3R5cGUoZW5naW5lLT5pOTE1
KSk7CisJaWYgKElTX0VSUihscmMpKSB7CisJCWVyciA9IFBUUl9FUlIobHJjKTsKKwkJZ290byBl
cnJfQjE7CisJfQorCWxyYyArPSBMUkNfU1RBVEVfT0ZGU0VUIC8gc2l6ZW9mKCpodyk7CisKKwlk
ZWZhdWx0cyA9IHNobWVtX3Bpbl9tYXAoY2UtPmVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSk7CisJaWYg
KCFkZWZhdWx0cykgeworCQllcnIgPSAtRU5PTUVNOworCQlnb3RvIGVycl9scmM7CisJfQorCisJ
eCA9IDA7CisJZHcgPSAwOworCWh3ID0gZGVmYXVsdHM7CisJaHcgKz0gTFJDX1NUQVRFX09GRlNF
VCAvIHNpemVvZigqaHcpOworCWRvIHsKKwkJdTMyIGxlbiA9IGh3W2R3XSAmIDB4N2Y7CisKKwkJ
aWYgKGh3W2R3XSA9PSAwKSB7CisJCQlkdysrOworCQkJY29udGludWU7CisJCX0KKworCQlpZiAo
KGh3W2R3XSAmIEdFTk1BU0soMzEsIDIzKSkgIT0gTUlfSU5TVFIoMHgyMiwgMCkpIHsKKwkJCWR3
ICs9IGxlbiArIDI7CisJCQljb250aW51ZTsKKwkJfQorCisJCWR3Kys7CisJCWxlbiA9IChsZW4g
KyAxKSAvIDI7CisJCXdoaWxlIChsZW4tLSkgeworCQkJaWYgKCFpc19tb3ZpbmcoQVswXVt4XSwg
QVsxXVt4XSkgJiYKKwkJCSAgICAoQVswXVt4XSAhPSBCWzBdW3hdIHx8IEFbMV1beF0gIT0gQlsx
XVt4XSkpIHsKKwkJCQlzd2l0Y2ggKGh3W2R3XSAmIDQwOTUpIHsKKwkJCQljYXNlIDB4MzA6IC8q
IFJJTkdfSEVBRCAqLworCQkJCWNhc2UgMHgzNDogLyogUklOR19UQUlMICovCisJCQkJCWJyZWFr
OworCisJCQkJZGVmYXVsdDoKKwkJCQkJcHJfZXJyKCIlc1slZF06IE1pc21hdGNoIGZvciByZWdp
c3RlciAlNHgsIGRlZmF1bHQgJTA4eCwgcmVmZXJlbmNlICUwOHgsIHJlc3VsdCAoJTA4eCwgJTA4
eCksIHBvaXNvbiAlMDh4LCBjb250ZXh0ICUwOHhcbiIsCisJCQkJCSAgICAgICBlbmdpbmUtPm5h
bWUsIGR3LAorCQkJCQkgICAgICAgaHdbZHddLCBod1tkdyArIDFdLAorCQkJCQkgICAgICAgQVsw
XVt4XSwgQlswXVt4XSwgQlsxXVt4XSwKKwkJCQkJICAgICAgIHBvaXNvbiwgbHJjW2R3ICsgMV0p
OworCQkJCQllcnIgPSAtRUlOVkFMOworCQkJCX0KKwkJCX0KKwkJCWR3ICs9IDI7CisJCQl4Kys7
CisJCX0KKwl9IHdoaWxlIChkdyA8IFBBR0VfU0laRSAvIHNpemVvZih1MzIpICYmCisJCSAoaHdb
ZHddICYgfkJJVCgwKSkgIT0gTUlfQkFUQ0hfQlVGRkVSX0VORCk7CisKKwlzaG1lbV91bnBpbl9t
YXAoY2UtPmVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSwgZGVmYXVsdHMpOworZXJyX2xyYzoKKwlpOTE1
X2dlbV9vYmplY3RfdW5waW5fbWFwKGNlLT5zdGF0ZS0+b2JqKTsKK2Vycl9CMToKKwlpOTE1X2dl
bV9vYmplY3RfdW5waW5fbWFwKHJlc3VsdFsxXS0+b2JqKTsKK2Vycl9CMDoKKwlpOTE1X2dlbV9v
YmplY3RfdW5waW5fbWFwKHJlc3VsdFswXS0+b2JqKTsKK2Vycl9BMToKKwlpOTE1X2dlbV9vYmpl
Y3RfdW5waW5fbWFwKHJlZlsxXS0+b2JqKTsKK2Vycl9BMDoKKwlpOTE1X2dlbV9vYmplY3RfdW5w
aW5fbWFwKHJlZlswXS0+b2JqKTsKKwlyZXR1cm4gZXJyOworfQorCitzdGF0aWMgaW50IF9fbHJj
X2lzb2xhdGlvbihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHUzMiBwb2lzb24pCit7
CisJdTMyICpzZW1hID0gbWVtc2V0MzIoZW5naW5lLT5zdGF0dXNfcGFnZS5hZGRyICsgMTAwMCwg
MCwgMSk7CisJc3RydWN0IGk5MTVfdm1hICpyZWZbMl0sICpyZXN1bHRbMl07CisJc3RydWN0IGlu
dGVsX2NvbnRleHQgKkEsICpCOworCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOworCWludCBlcnI7
CisKKwlBID0gaW50ZWxfY29udGV4dF9jcmVhdGUoZW5naW5lKTsKKwlpZiAoSVNfRVJSKEEpKQor
CQlyZXR1cm4gUFRSX0VSUihBKTsKKworCUIgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZShlbmdpbmUp
OworCWlmIChJU19FUlIoQikpIHsKKwkJZXJyID0gUFRSX0VSUihCKTsKKwkJZ290byBlcnJfQTsK
Kwl9CisKKwlyZWZbMF0gPSBjcmVhdGVfdXNlcl92bWEoQS0+dm0sIFNaXzY0Syk7CisJaWYgKElT
X0VSUihyZWZbMF0pKSB7CisJCWVyciA9IFBUUl9FUlIocmVmWzBdKTsKKwkJZ290byBlcnJfQjsK
Kwl9CisKKwlyZWZbMV0gPSBjcmVhdGVfdXNlcl92bWEoQS0+dm0sIFNaXzY0Syk7CisJaWYgKElT
X0VSUihyZWZbMV0pKSB7CisJCWVyciA9IFBUUl9FUlIocmVmWzFdKTsKKwkJZ290byBlcnJfcmVm
MDsKKwl9CisKKwlycSA9IHJlY29yZF9yZWdpc3RlcnMoQSwgcmVmWzBdLCByZWZbMV0sIHNlbWEp
OworCWlmIChJU19FUlIocnEpKSB7CisJCWVyciA9IFBUUl9FUlIocnEpOworCQlnb3RvIGVycl9y
ZWYxOworCX0KKworCVdSSVRFX09OQ0UoKnNlbWEsIDEpOworCXdtYigpOworCisJaWYgKGk5MTVf
cmVxdWVzdF93YWl0KHJxLCAwLCBIWiAvIDIpIDwgMCkgeworCQlpOTE1X3JlcXVlc3RfcHV0KHJx
KTsKKwkJZXJyID0gLUVUSU1FOworCQlnb3RvIGVycl9yZWYxOworCX0KKwlpOTE1X3JlcXVlc3Rf
cHV0KHJxKTsKKworCXJlc3VsdFswXSA9IGNyZWF0ZV91c2VyX3ZtYShBLT52bSwgU1pfNjRLKTsK
KwlpZiAoSVNfRVJSKHJlc3VsdFswXSkpIHsKKwkJZXJyID0gUFRSX0VSUihyZXN1bHRbMF0pOwor
CQlnb3RvIGVycl9yZWYxOworCX0KKworCXJlc3VsdFsxXSA9IGNyZWF0ZV91c2VyX3ZtYShBLT52
bSwgU1pfNjRLKTsKKwlpZiAoSVNfRVJSKHJlc3VsdFsxXSkpIHsKKwkJZXJyID0gUFRSX0VSUihy
ZXN1bHRbMV0pOworCQlnb3RvIGVycl9yZXN1bHQwOworCX0KKworCXJxID0gcmVjb3JkX3JlZ2lz
dGVycyhBLCByZXN1bHRbMF0sIHJlc3VsdFsxXSwgc2VtYSk7CisJaWYgKElTX0VSUihycSkpIHsK
KwkJZXJyID0gUFRSX0VSUihycSk7CisJCWdvdG8gZXJyX3Jlc3VsdDE7CisJfQorCisJZXJyID0g
cG9pc29uX3JlZ2lzdGVycyhCLCBwb2lzb24sIHNlbWEpOworCWlmIChlcnIpIHsKKwkJV1JJVEVf
T05DRSgqc2VtYSwgLTEpOworCQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKKwkJZ290byBlcnJfcmVz
dWx0MTsKKwl9CisKKwlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQocnEsIDAsIEhaIC8gMikgPCAwKSB7
CisJCWk5MTVfcmVxdWVzdF9wdXQocnEpOworCQllcnIgPSAtRVRJTUU7CisJCWdvdG8gZXJyX3Jl
c3VsdDE7CisJfQorCWk5MTVfcmVxdWVzdF9wdXQocnEpOworCisJZXJyID0gY29tcGFyZV9pc29s
YXRpb24oZW5naW5lLCByZWYsIHJlc3VsdCwgQSwgcG9pc29uKTsKKworZXJyX3Jlc3VsdDE6CisJ
aTkxNV92bWFfcHV0KHJlc3VsdFsxXSk7CitlcnJfcmVzdWx0MDoKKwlpOTE1X3ZtYV9wdXQocmVz
dWx0WzBdKTsKK2Vycl9yZWYxOgorCWk5MTVfdm1hX3B1dChyZWZbMV0pOworZXJyX3JlZjA6CisJ
aTkxNV92bWFfcHV0KHJlZlswXSk7CitlcnJfQjoKKwlpbnRlbF9jb250ZXh0X3B1dChCKTsKK2Vy
cl9BOgorCWludGVsX2NvbnRleHRfcHV0KEEpOworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBi
b29sIHNraXBfaXNvbGF0aW9uKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkK
K3sKKwlpZiAoZW5naW5lLT5jbGFzcyA9PSBDT1BZX0VOR0lORV9DTEFTUyAmJiBJTlRFTF9HRU4o
ZW5naW5lLT5pOTE1KSA9PSA5KQorCQlyZXR1cm4gdHJ1ZTsKKworCWlmIChlbmdpbmUtPmNsYXNz
ID09IFJFTkRFUl9DTEFTUyAmJiBJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA9PSAxMSkKKwkJcmV0
dXJuIHRydWU7CisKKwlyZXR1cm4gZmFsc2U7Cit9CisKK3N0YXRpYyBpbnQgbGl2ZV9scmNfaXNv
bGF0aW9uKHZvaWQgKmFyZykKK3sKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOworCXN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKKwllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKKwlj
b25zdCB1MzIgcG9pc29uW10gPSB7CisJCVNUQUNLX01BR0lDLAorCQkweDNhM2EzYTNhLAorCQkw
eDVjNWM1YzVjLAorCQkweGZmZmZmZmZmLAorCQkweGZmZmYwMDAwLAorCX07CisJaW50IGVyciA9
IDA7CisKKwkvKgorCSAqIE91ciBnb2FsIGlzIHRyeSBhbmQgdmVyaWZ5IHRoYXQgcGVyLWNvbnRl
eHQgc3RhdGUgY2Fubm90IGJlCisJICogdGFtcGVyZWQgd2l0aCBieSBhbm90aGVyIG5vbi1wcml2
aWxlZ2VkIGNsaWVudC4KKwkgKgorCSAqIFdlIHRha2UgdGhlIGxpc3Qgb2YgY29udGV4dCByZWdp
c3RlcnMgZnJvbSB0aGUgTFJJIGluIHRoZSBkZWZhdWx0CisJICogY29udGV4dCBpbWFnZSBhbmQg
YXR0ZW1wdCB0byBtb2RpZnkgdGhhdCBsaXN0IGZyb20gYSByZW1vdGUgY29udGV4dC4KKwkgKi8K
KworCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LCBpZCkgeworCQlpbnQgaTsKKworCQkvKiBK
dXN0IGRvbid0IGV2ZW4gYXNrICovCisJCWlmICghSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVf
U0VMRlRFU1RfQlJPS0VOKSAmJgorCQkgICAgc2tpcF9pc29sYXRpb24oZW5naW5lKSkKKwkJCWNv
bnRpbnVlOworCisJCWludGVsX2VuZ2luZV9wbV9nZXQoZW5naW5lKTsKKwkJZm9yIChpID0gMDsg
aSA8IEFSUkFZX1NJWkUocG9pc29uKTsgaSsrKSB7CisJCQlpbnQgcmVzdWx0OworCisJCQlyZXN1
bHQgPSBfX2xyY19pc29sYXRpb24oZW5naW5lLCBwb2lzb25baV0pOworCQkJaWYgKHJlc3VsdCAm
JiAhZXJyKQorCQkJCWVyciA9IHJlc3VsdDsKKworCQkJcmVzdWx0ID0gX19scmNfaXNvbGF0aW9u
KGVuZ2luZSwgfnBvaXNvbltpXSk7CisJCQlpZiAocmVzdWx0ICYmICFlcnIpCisJCQkJZXJyID0g
cmVzdWx0OworCQl9CisJCWludGVsX2VuZ2luZV9wbV9wdXQoZW5naW5lKTsKKwkJaWYgKGlndF9m
bHVzaF90ZXN0KGd0LT5pOTE1KSkgeworCQkJZXJyID0gLUVJTzsKKwkJCWJyZWFrOworCQl9CisJ
fQorCisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIGludCBpbmRpcmVjdF9jdHhfc3VibWl0X3Jl
cShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCit7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7
CisJaW50IGVyciA9IDA7CisKKwlycSA9IGludGVsX2NvbnRleHRfY3JlYXRlX3JlcXVlc3QoY2Up
OworCWlmIChJU19FUlIocnEpKQorCQlyZXR1cm4gUFRSX0VSUihycSk7CisKKwlpOTE1X3JlcXVl
c3RfZ2V0KHJxKTsKKwlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKKworCWlmIChpOTE1X3JlcXVlc3Rf
d2FpdChycSwgMCwgSFogLyA1KSA8IDApCisJCWVyciA9IC1FVElNRTsKKworCWk5MTVfcmVxdWVz
dF9wdXQocnEpOworCisJcmV0dXJuIGVycjsKK30KKworI2RlZmluZSBDVFhfQkJfQ0FOQVJZX09G
RlNFVCAoMyAqIDEwMjQpCisjZGVmaW5lIENUWF9CQl9DQU5BUllfSU5ERVggIChDVFhfQkJfQ0FO
QVJZX09GRlNFVCAvIHNpemVvZih1MzIpKQorCitzdGF0aWMgdTMyICoKK2VtaXRfaW5kaXJlY3Rf
Y3R4X2JiX2NhbmFyeShjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHUzMiAqY3MpCit7
CisJKmNzKysgPSBNSV9TVE9SRV9SRUdJU1RFUl9NRU1fR0VOOCB8CisJCU1JX1NSTV9MUk1fR0xP
QkFMX0dUVCB8CisJCU1JX0xSSV9MUk1fQ1NfTU1JTzsKKwkqY3MrKyA9IGk5MTVfbW1pb19yZWdf
b2Zmc2V0KFJJTkdfU1RBUlQoMCkpOworCSpjcysrID0gaTkxNV9nZ3R0X29mZnNldChjZS0+c3Rh
dGUpICsKKwkJY29udGV4dF93YV9iYl9vZmZzZXQoY2UpICsKKwkJQ1RYX0JCX0NBTkFSWV9PRkZT
RVQ7CisJKmNzKysgPSAwOworCisJcmV0dXJuIGNzOworfQorCitzdGF0aWMgdm9pZAoraW5kaXJl
Y3RfY3R4X2JiX3NldHVwKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKK3sKKwl1MzIgKmNzID0g
Y29udGV4dF9pbmRpcmVjdF9iYihjZSk7CisKKwljc1tDVFhfQkJfQ0FOQVJZX0lOREVYXSA9IDB4
ZGVhZGYwMGQ7CisKKwlzZXR1cF9pbmRpcmVjdF9jdHhfYmIoY2UsIGNlLT5lbmdpbmUsIGVtaXRf
aW5kaXJlY3RfY3R4X2JiX2NhbmFyeSk7Cit9CisKK3N0YXRpYyBib29sIGNoZWNrX3Jpbmdfc3Rh
cnQoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQoreworCWNvbnN0IHUzMiAqIGNvbnN0IGN0eF9i
YiA9ICh2b2lkICopKGNlLT5scmNfcmVnX3N0YXRlKSAtCisJCUxSQ19TVEFURV9PRkZTRVQgKyBj
b250ZXh0X3dhX2JiX29mZnNldChjZSk7CisKKwlpZiAoY3R4X2JiW0NUWF9CQl9DQU5BUllfSU5E
RVhdID09IGNlLT5scmNfcmVnX3N0YXRlW0NUWF9SSU5HX1NUQVJUXSkKKwkJcmV0dXJuIHRydWU7
CisKKwlwcl9lcnIoInJpbmcgc3RhcnQgbWlzbWF0Y2g6IGNhbmFyeSAweCUwOHggdnMgc3RhdGUg
MHglMDh4XG4iLAorCSAgICAgICBjdHhfYmJbQ1RYX0JCX0NBTkFSWV9JTkRFWF0sCisJICAgICAg
IGNlLT5scmNfcmVnX3N0YXRlW0NUWF9SSU5HX1NUQVJUXSk7CisKKwlyZXR1cm4gZmFsc2U7Cit9
CisKK3N0YXRpYyBpbnQgaW5kaXJlY3RfY3R4X2JiX2NoZWNrKHN0cnVjdCBpbnRlbF9jb250ZXh0
ICpjZSkKK3sKKwlpbnQgZXJyOworCisJZXJyID0gaW5kaXJlY3RfY3R4X3N1Ym1pdF9yZXEoY2Up
OworCWlmIChlcnIpCisJCXJldHVybiBlcnI7CisKKwlpZiAoIWNoZWNrX3Jpbmdfc3RhcnQoY2Up
KQorCQlyZXR1cm4gLUVJTlZBTDsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IF9fbGl2
ZV9scmNfaW5kaXJlY3RfY3R4X2JiKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sK
KwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqYSwgKmI7CisJaW50IGVycjsKKworCWEgPSBpbnRlbF9j
b250ZXh0X2NyZWF0ZShlbmdpbmUpOworCWlmIChJU19FUlIoYSkpCisJCXJldHVybiBQVFJfRVJS
KGEpOworCWVyciA9IGludGVsX2NvbnRleHRfcGluKGEpOworCWlmIChlcnIpCisJCWdvdG8gcHV0
X2E7CisKKwliID0gaW50ZWxfY29udGV4dF9jcmVhdGUoZW5naW5lKTsKKwlpZiAoSVNfRVJSKGIp
KSB7CisJCWVyciA9IFBUUl9FUlIoYik7CisJCWdvdG8gdW5waW5fYTsKKwl9CisJZXJyID0gaW50
ZWxfY29udGV4dF9waW4oYik7CisJaWYgKGVycikKKwkJZ290byBwdXRfYjsKKworCS8qIFdlIHVz
ZSB0aGUgYWxyZWFkeSByZXNlcnZlZCBleHRyYSBwYWdlIGluIGNvbnRleHQgc3RhdGUgKi8KKwlp
ZiAoIWEtPndhX2JiX3BhZ2UpIHsKKwkJR0VNX0JVR19PTihiLT53YV9iYl9wYWdlKTsKKwkJR0VN
X0JVR19PTihJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA9PSAxMik7CisJCWdvdG8gdW5waW5fYjsK
Kwl9CisKKwkvKgorCSAqIEluIG9yZGVyIHRvIHRlc3QgdGhhdCBvdXIgcGVyIGNvbnRleHQgYmIg
aXMgdHJ1bHkgcGVyIGNvbnRleHQsCisJICogYW5kIGV4ZWN1dGVzIGF0IHRoZSBpbnRlbmRlZCBz
cG90IG9uIGNvbnRleHQgcmVzdG9yaW5nIHByb2Nlc3MsCisJICogbWFrZSB0aGUgYmF0Y2ggc3Rv
cmUgdGhlIHJpbmcgc3RhcnQgdmFsdWUgdG8gbWVtb3J5LgorCSAqIEFzIHJpbmcgc3RhcnQgaXMg
cmVzdG9yZWQgYXByaW9yaSBvZiBzdGFydGluZyB0aGUgaW5kaXJlY3QgY3R4IGJiIGFuZAorCSAq
IGFzIGl0IHdpbGwgYmUgZGlmZmVyZW50IGZvciBlYWNoIGNvbnRleHQsIGl0IGZpdHMgdG8gdGhp
cyBwdXJwb3NlLgorCSAqLworCWluZGlyZWN0X2N0eF9iYl9zZXR1cChhKTsKKwlpbmRpcmVjdF9j
dHhfYmJfc2V0dXAoYik7CisKKwllcnIgPSBpbmRpcmVjdF9jdHhfYmJfY2hlY2soYSk7CisJaWYg
KGVycikKKwkJZ290byB1bnBpbl9iOworCisJZXJyID0gaW5kaXJlY3RfY3R4X2JiX2NoZWNrKGIp
OworCit1bnBpbl9iOgorCWludGVsX2NvbnRleHRfdW5waW4oYik7CitwdXRfYjoKKwlpbnRlbF9j
b250ZXh0X3B1dChiKTsKK3VucGluX2E6CisJaW50ZWxfY29udGV4dF91bnBpbihhKTsKK3B1dF9h
OgorCWludGVsX2NvbnRleHRfcHV0KGEpOworCisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIGlu
dCBsaXZlX2xyY19pbmRpcmVjdF9jdHhfYmIodm9pZCAqYXJnKQoreworCXN0cnVjdCBpbnRlbF9n
dCAqZ3QgPSBhcmc7CisJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOworCWVudW0gaW50
ZWxfZW5naW5lX2lkIGlkOworCWludCBlcnIgPSAwOworCisJZm9yX2VhY2hfZW5naW5lKGVuZ2lu
ZSwgZ3QsIGlkKSB7CisJCWludGVsX2VuZ2luZV9wbV9nZXQoZW5naW5lKTsKKwkJZXJyID0gX19s
aXZlX2xyY19pbmRpcmVjdF9jdHhfYmIoZW5naW5lKTsKKwkJaW50ZWxfZW5naW5lX3BtX3B1dChl
bmdpbmUpOworCisJCWlmIChpZ3RfZmx1c2hfdGVzdChndC0+aTkxNSkpCisJCQllcnIgPSAtRUlP
OworCisJCWlmIChlcnIpCisJCQlicmVhazsKKwl9CisKKwlyZXR1cm4gZXJyOworfQorCitzdGF0
aWMgdm9pZCBnYXJiYWdlX3Jlc2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKKwkJ
CSAgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCit7CisJY29uc3QgdW5zaWduZWQgaW50IGJpdCA9
IEk5MTVfUkVTRVRfRU5HSU5FICsgZW5naW5lLT5pZDsKKwl1bnNpZ25lZCBsb25nICpsb2NrID0g
JmVuZ2luZS0+Z3QtPnJlc2V0LmZsYWdzOworCisJaWYgKHRlc3RfYW5kX3NldF9iaXQoYml0LCBs
b2NrKSkKKwkJcmV0dXJuOworCisJdGFza2xldF9kaXNhYmxlKCZlbmdpbmUtPmV4ZWNsaXN0cy50
YXNrbGV0KTsKKworCWlmICghcnEtPmZlbmNlLmVycm9yKQorCQlpbnRlbF9lbmdpbmVfcmVzZXQo
ZW5naW5lLCBOVUxMKTsKKworCXRhc2tsZXRfZW5hYmxlKCZlbmdpbmUtPmV4ZWNsaXN0cy50YXNr
bGV0KTsKKwljbGVhcl9hbmRfd2FrZV91cF9iaXQoYml0LCBsb2NrKTsKK30KKworc3RhdGljIHN0
cnVjdCBpOTE1X3JlcXVlc3QgKmdhcmJhZ2Uoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAorCQkJ
CSAgICBzdHJ1Y3Qgcm5kX3N0YXRlICpwcm5nKQoreworCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJx
OworCWludCBlcnI7CisKKwllcnIgPSBpbnRlbF9jb250ZXh0X3BpbihjZSk7CisJaWYgKGVycikK
KwkJcmV0dXJuIEVSUl9QVFIoZXJyKTsKKworCXByYW5kb21fYnl0ZXNfc3RhdGUocHJuZywKKwkJ
CSAgICBjZS0+bHJjX3JlZ19zdGF0ZSwKKwkJCSAgICBjZS0+ZW5naW5lLT5jb250ZXh0X3NpemUg
LQorCQkJICAgIExSQ19TVEFURV9PRkZTRVQpOworCisJcnEgPSBpbnRlbF9jb250ZXh0X2NyZWF0
ZV9yZXF1ZXN0KGNlKTsKKwlpZiAoSVNfRVJSKHJxKSkgeworCQllcnIgPSBQVFJfRVJSKHJxKTsK
KwkJZ290byBlcnJfdW5waW47CisJfQorCisJaTkxNV9yZXF1ZXN0X2dldChycSk7CisJaTkxNV9y
ZXF1ZXN0X2FkZChycSk7CisJcmV0dXJuIHJxOworCitlcnJfdW5waW46CisJaW50ZWxfY29udGV4
dF91bnBpbihjZSk7CisJcmV0dXJuIEVSUl9QVFIoZXJyKTsKK30KKworc3RhdGljIGludCBfX2xy
Y19nYXJiYWdlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgc3RydWN0IHJuZF9zdGF0
ZSAqcHJuZykKK3sKKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7CisJc3RydWN0IGk5MTVfcmVx
dWVzdCAqaGFuZzsKKwlpbnQgZXJyID0gMDsKKworCWNlID0gaW50ZWxfY29udGV4dF9jcmVhdGUo
ZW5naW5lKTsKKwlpZiAoSVNfRVJSKGNlKSkKKwkJcmV0dXJuIFBUUl9FUlIoY2UpOworCisJaGFu
ZyA9IGdhcmJhZ2UoY2UsIHBybmcpOworCWlmIChJU19FUlIoaGFuZykpIHsKKwkJZXJyID0gUFRS
X0VSUihoYW5nKTsKKwkJZ290byBlcnJfY2U7CisJfQorCisJaWYgKHdhaXRfZm9yX3N1Ym1pdChl
bmdpbmUsIGhhbmcsIEhaIC8gMikpIHsKKwkJaTkxNV9yZXF1ZXN0X3B1dChoYW5nKTsKKwkJZXJy
ID0gLUVUSU1FOworCQlnb3RvIGVycl9jZTsKKwl9CisKKwlpbnRlbF9jb250ZXh0X3NldF9iYW5u
ZWQoY2UpOworCWdhcmJhZ2VfcmVzZXQoZW5naW5lLCBoYW5nKTsKKworCWludGVsX2VuZ2luZV9m
bHVzaF9zdWJtaXNzaW9uKGVuZ2luZSk7CisJaWYgKCFoYW5nLT5mZW5jZS5lcnJvcikgeworCQlp
OTE1X3JlcXVlc3RfcHV0KGhhbmcpOworCQlwcl9lcnIoIiVzOiBjb3JydXB0ZWQgY29udGV4dCB3
YXMgbm90IHJlc2V0XG4iLAorCQkgICAgICAgZW5naW5lLT5uYW1lKTsKKwkJZXJyID0gLUVJTlZB
TDsKKwkJZ290byBlcnJfY2U7CisJfQorCisJaWYgKGk5MTVfcmVxdWVzdF93YWl0KGhhbmcsIDAs
IEhaIC8gMikgPCAwKSB7CisJCXByX2VycigiJXM6IGNvcnJ1cHRlZCBjb250ZXh0IGRpZCBub3Qg
cmVjb3ZlclxuIiwKKwkJICAgICAgIGVuZ2luZS0+bmFtZSk7CisJCWk5MTVfcmVxdWVzdF9wdXQo
aGFuZyk7CisJCWVyciA9IC1FSU87CisJCWdvdG8gZXJyX2NlOworCX0KKwlpOTE1X3JlcXVlc3Rf
cHV0KGhhbmcpOworCitlcnJfY2U6CisJaW50ZWxfY29udGV4dF9wdXQoY2UpOworCXJldHVybiBl
cnI7Cit9CisKK3N0YXRpYyBpbnQgbGl2ZV9scmNfZ2FyYmFnZSh2b2lkICphcmcpCit7CisJc3Ry
dWN0IGludGVsX2d0ICpndCA9IGFyZzsKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7
CisJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CisKKwkvKgorCSAqIFZlcmlmeSB0aGF0IHdlIGNh
biByZWNvdmVyIGlmIG9uZSBjb250ZXh0IHN0YXRlIGlzIGNvbXBsZXRlbHkKKwkgKiBjb3JydXB0
ZWQuCisJICovCisKKwlpZiAoIUlTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X1NFTEZURVNUX0JS
T0tFTikpCisJCXJldHVybiAwOworCisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7
CisJCUk5MTVfUk5EX1NUQVRFKHBybmcpOworCQlpbnQgZXJyID0gMCwgaTsKKworCQlpZiAoIWlu
dGVsX2hhc19yZXNldF9lbmdpbmUoZW5naW5lLT5ndCkpCisJCQljb250aW51ZTsKKworCQlpbnRl
bF9lbmdpbmVfcG1fZ2V0KGVuZ2luZSk7CisJCWZvciAoaSA9IDA7IGkgPCAzOyBpKyspIHsKKwkJ
CWVyciA9IF9fbHJjX2dhcmJhZ2UoZW5naW5lLCAmcHJuZyk7CisJCQlpZiAoZXJyKQorCQkJCWJy
ZWFrOworCQl9CisJCWludGVsX2VuZ2luZV9wbV9wdXQoZW5naW5lKTsKKworCQlpZiAoaWd0X2Zs
dXNoX3Rlc3QoZ3QtPmk5MTUpKQorCQkJZXJyID0gLUVJTzsKKwkJaWYgKGVycikKKwkJCXJldHVy
biBlcnI7CisJfQorCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgX19saXZlX3BwaHdzcF9y
dW50aW1lKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlzdHJ1Y3QgaW50ZWxf
Y29udGV4dCAqY2U7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7CisJSUdUX1RJTUVPVVQoZW5k
X3RpbWUpOworCWludCBlcnI7CisKKwljZSA9IGludGVsX2NvbnRleHRfY3JlYXRlKGVuZ2luZSk7
CisJaWYgKElTX0VSUihjZSkpCisJCXJldHVybiBQVFJfRVJSKGNlKTsKKworCWNlLT5ydW50aW1l
Lm51bV91bmRlcmZsb3cgPSAwOworCWNlLT5ydW50aW1lLm1heF91bmRlcmZsb3cgPSAwOworCisJ
ZG8geworCQl1bnNpZ25lZCBpbnQgbG9vcCA9IDEwMjQ7CisKKwkJd2hpbGUgKGxvb3ApIHsKKwkJ
CXJxID0gaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVzdChjZSk7CisJCQlpZiAoSVNfRVJSKHJx
KSkgeworCQkJCWVyciA9IFBUUl9FUlIocnEpOworCQkJCWdvdG8gZXJyX3JxOworCQkJfQorCisJ
CQlpZiAoLS1sb29wID09IDApCisJCQkJaTkxNV9yZXF1ZXN0X2dldChycSk7CisKKwkJCWk5MTVf
cmVxdWVzdF9hZGQocnEpOworCQl9CisKKwkJaWYgKF9faWd0X3RpbWVvdXQoZW5kX3RpbWUsIE5V
TEwpKQorCQkJYnJlYWs7CisKKwkJaTkxNV9yZXF1ZXN0X3B1dChycSk7CisJfSB3aGlsZSAoMSk7
CisKKwllcnIgPSBpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgSFogLyA1KTsKKwlpZiAoZXJyIDwg
MCkgeworCQlwcl9lcnIoIiVzOiByZXF1ZXN0IG5vdCBjb21wbGV0ZWQhXG4iLCBlbmdpbmUtPm5h
bWUpOworCQlnb3RvIGVycl93YWl0OworCX0KKworCWlndF9mbHVzaF90ZXN0KGVuZ2luZS0+aTkx
NSk7CisKKwlwcl9pbmZvKCIlczogcHBod3NwIHJ1bnRpbWUgJWxsdW5zLCBhdmVyYWdlICVsbHVu
c1xuIiwKKwkJZW5naW5lLT5uYW1lLAorCQlpbnRlbF9jb250ZXh0X2dldF90b3RhbF9ydW50aW1l
X25zKGNlKSwKKwkJaW50ZWxfY29udGV4dF9nZXRfYXZnX3J1bnRpbWVfbnMoY2UpKTsKKworCWVy
ciA9IDA7CisJaWYgKGNlLT5ydW50aW1lLm51bV91bmRlcmZsb3cpIHsKKwkJcHJfZXJyKCIlczog
cHBod3NwIHVuZGVyZmxvdyAldSB0aW1lKHMpLCBtYXggJXUgY3ljbGVzIVxuIiwKKwkJICAgICAg
IGVuZ2luZS0+bmFtZSwKKwkJICAgICAgIGNlLT5ydW50aW1lLm51bV91bmRlcmZsb3csCisJCSAg
ICAgICBjZS0+cnVudGltZS5tYXhfdW5kZXJmbG93KTsKKwkJR0VNX1RSQUNFX0RVTVAoKTsKKwkJ
ZXJyID0gLUVPVkVSRkxPVzsKKwl9CisKK2Vycl93YWl0OgorCWk5MTVfcmVxdWVzdF9wdXQocnEp
OworZXJyX3JxOgorCWludGVsX2NvbnRleHRfcHV0KGNlKTsKKwlyZXR1cm4gZXJyOworfQorCitz
dGF0aWMgaW50IGxpdmVfcHBod3NwX3J1bnRpbWUodm9pZCAqYXJnKQoreworCXN0cnVjdCBpbnRl
bF9ndCAqZ3QgPSBhcmc7CisJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOworCWVudW0g
aW50ZWxfZW5naW5lX2lkIGlkOworCWludCBlcnIgPSAwOworCisJLyoKKwkgKiBDaGVjayB0aGF0
IGN1bXVsYXRpdmUgY29udGV4dCBydW50aW1lIGFzIHN0b3JlZCBpbiB0aGUgcHBod3NwWzE2XQor
CSAqIGlzIG1vbm90b25pYy4KKwkgKi8KKworCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LCBp
ZCkgeworCQllcnIgPSBfX2xpdmVfcHBod3NwX3J1bnRpbWUoZW5naW5lKTsKKwkJaWYgKGVycikK
KwkJCWJyZWFrOworCX0KKworCWlmIChpZ3RfZmx1c2hfdGVzdChndC0+aTkxNSkpCisJCWVyciA9
IC1FSU87CisKKwlyZXR1cm4gZXJyOworfQorCitpbnQgaW50ZWxfbHJjX2xpdmVfc2VsZnRlc3Rz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQoreworCXN0YXRpYyBjb25zdCBzdHJ1Y3Qg
aTkxNV9zdWJ0ZXN0IHRlc3RzW10gPSB7CisJCVNVQlRFU1QobGl2ZV9scmNfbGF5b3V0KSwKKwkJ
U1VCVEVTVChsaXZlX2xyY19maXhlZCksCisJCVNVQlRFU1QobGl2ZV9scmNfc3RhdGUpLAorCQlT
VUJURVNUKGxpdmVfbHJjX2dwciksCisJCVNVQlRFU1QobGl2ZV9scmNfaXNvbGF0aW9uKSwKKwkJ
U1VCVEVTVChsaXZlX2xyY190aW1lc3RhbXApLAorCQlTVUJURVNUKGxpdmVfbHJjX2dhcmJhZ2Up
LAorCQlTVUJURVNUKGxpdmVfcHBod3NwX3J1bnRpbWUpLAorCQlTVUJURVNUKGxpdmVfbHJjX2lu
ZGlyZWN0X2N0eF9iYiksCisJfTsKKworCWlmICghSEFTX0xPR0lDQUxfUklOR19DT05URVhUUyhp
OTE1KSkKKwkJcmV0dXJuIDA7CisKKwlyZXR1cm4gaW50ZWxfZ3RfbGl2ZV9zdWJ0ZXN0cyh0ZXN0
cywgJmk5MTUtPmd0KTsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3Vj
L2ludGVsX2d1Y19hZHMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19h
ZHMuYwppbmRleCAxYTJlNGY2MzE3NjMuLjE3NTI2NzE3MzY4YyAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX2Fkcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3VjL2ludGVsX2d1Y19hZHMuYwpAQCAtMyw4ICszLDggQEAKICAqIENvcHlyaWdo
dCDCqSAyMDE0LTIwMTkgSW50ZWwgQ29ycG9yYXRpb24KICAqLwogCi0jaW5jbHVkZSAiZ3QvaW50
ZWxfZXhlY2xpc3RzX3N1Ym1pc3Npb24uaCIgLyogbHJjIGxheW91dCAqLwogI2luY2x1ZGUgImd0
L2ludGVsX2d0LmgiCisjaW5jbHVkZSAiZ3QvaW50ZWxfbHJjLmgiCiAjaW5jbHVkZSAiaW50ZWxf
Z3VjX2Fkcy5oIgogI2luY2x1ZGUgImludGVsX3VjLmgiCiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNz
aW9uLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfc3VibWlzc2lvbi5j
CmluZGV4IDg1MjhhYjU3NGRiZS4uMzE3MjFhYzBiZjVkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfc3VibWlzc2lvbi5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9uLmMKQEAgLTExLDcgKzExLDcgQEAK
ICNpbmNsdWRlICJndC9pbnRlbF9leGVjbGlzdHNfc3VibWlzc2lvbi5oIiAvKiBYWFggKi8KICNp
bmNsdWRlICJndC9pbnRlbF9ndC5oIgogI2luY2x1ZGUgImd0L2ludGVsX2d0X3BtLmgiCi0jaW5j
bHVkZSAiZ3QvaW50ZWxfbHJjX3JlZy5oIgorI2luY2x1ZGUgImd0L2ludGVsX2xyYy5oIgogI2lu
Y2x1ZGUgImd0L2ludGVsX3JpbmcuaCIKIAogI2luY2x1ZGUgImludGVsX2d1Y19zdWJtaXNzaW9u
LmgiCkBAIC00MDIsNiArNDAyLDI4IEBAIGNhbmNlbF9wb3J0X3JlcXVlc3RzKHN0cnVjdCBpbnRl
bF9lbmdpbmVfZXhlY2xpc3RzICogY29uc3QgZXhlY2xpc3RzKQogCQltZW1zZXQoZXhlY2xpc3Rz
LT5pbmZsaWdodCwgMCwgc2l6ZW9mKGV4ZWNsaXN0cy0+aW5mbGlnaHQpKTsKIH0KIAorc3RhdGlj
IHZvaWQgZ3VjX3Jlc2V0X3N0YXRlKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJCSAgICBz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCisJCQkgICAgdTMyIGhlYWQsCisJCQkgICAg
Ym9vbCBzY3J1YikKK3sKKwlHRU1fQlVHX09OKCFpbnRlbF9jb250ZXh0X2lzX3Bpbm5lZChjZSkp
OworCisJLyoKKwkgKiBXZSB3YW50IGEgc2ltcGxlIGNvbnRleHQgKyByaW5nIHRvIGV4ZWN1dGUg
dGhlIGJyZWFkY3J1bWIgdXBkYXRlLgorCSAqIFdlIGNhbm5vdCByZWx5IG9uIHRoZSBjb250ZXh0
IGJlaW5nIGludGFjdCBhY3Jvc3MgdGhlIEdQVSBoYW5nLAorCSAqIHNvIGNsZWFyIGl0IGFuZCBy
ZWJ1aWxkIGp1c3Qgd2hhdCB3ZSBuZWVkIGZvciB0aGUgYnJlYWRjcnVtYi4KKwkgKiBBbGwgcGVu
ZGluZyByZXF1ZXN0cyBmb3IgdGhpcyBjb250ZXh0IHdpbGwgYmUgemFwcGVkLCBhbmQgYW55CisJ
ICogZnV0dXJlIHJlcXVlc3Qgd2lsbCBiZSBhZnRlciB1c2Vyc3BhY2UgaGFzIGhhZCB0aGUgb3Bw
b3J0dW5pdHkKKwkgKiB0byByZWNyZWF0ZSBpdHMgb3duIHN0YXRlLgorCSAqLworCWlmIChzY3J1
YikKKwkJbHJjX3Jlc3RvcmVfZGVmYXVsdHMoY2UsIGVuZ2luZSk7CisKKwkvKiBSZXJ1biB0aGUg
cmVxdWVzdDsgaXRzIHBheWxvYWQgaGFzIGJlZW4gbmV1dGVyZWQgKGlmIGd1aWx0eSkuICovCisJ
bHJjX3VwZGF0ZV9yZWdzKGNlLCBlbmdpbmUsIGhlYWQpOworfQorCiBzdGF0aWMgdm9pZCBndWNf
cmVzZXRfcmV3aW5kKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgYm9vbCBzdGFsbGVk
KQogewogCXN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3RzICogY29uc3QgZXhlY2xpc3RzID0g
JmVuZ2luZS0+ZXhlY2xpc3RzOwpAQCAtNDIxLDcgKzQ0Myw3IEBAIHN0YXRpYyB2b2lkIGd1Y19y
ZXNldF9yZXdpbmQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBib29sIHN0YWxsZWQp
CiAJCXN0YWxsZWQgPSBmYWxzZTsKIAogCV9faTkxNV9yZXF1ZXN0X3Jlc2V0KHJxLCBzdGFsbGVk
KTsKLQlpbnRlbF9scl9jb250ZXh0X3Jlc2V0KGVuZ2luZSwgcnEtPmNvbnRleHQsIHJxLT5oZWFk
LCBzdGFsbGVkKTsKKwlndWNfcmVzZXRfc3RhdGUocnEtPmNvbnRleHQsIGVuZ2luZSwgcnEtPmhl
YWQsIHN0YWxsZWQpOwogCiBvdXRfdW5sb2NrOgogCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmVu
Z2luZS0+YWN0aXZlLmxvY2ssIGZsYWdzKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d2dC9zY2hlZHVsZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIu
YwppbmRleCBlZDMwZmRkZTQxMTQuLjZhZjVjMDZjYWVlMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2
dC9zY2hlZHVsZXIuYwpAQCAtMzgsNiArMzgsNyBAQAogI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9w
bS5oIgogI2luY2x1ZGUgImd0L2ludGVsX2NvbnRleHQuaCIKICNpbmNsdWRlICJndC9pbnRlbF9l
eGVjbGlzdHNfc3VibWlzc2lvbi5oIgorI2luY2x1ZGUgImd0L2ludGVsX2xyYy5oIgogI2luY2x1
ZGUgImd0L2ludGVsX3JpbmcuaCIKIAogI2luY2x1ZGUgImk5MTVfZHJ2LmgiCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfcGVyZi5jCmluZGV4IDU4Y2FhM2YxYTM4Yi4uZjY1YzMyYmQ5NzBlIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3BlcmYuYwpAQCAtMjAxLDcgKzIwMSw3IEBACiAjaW5jbHVkZSAiZ3QvaW50ZWxf
ZXhlY2xpc3RzX3N1Ym1pc3Npb24uaCIKICNpbmNsdWRlICJndC9pbnRlbF9ncHVfY29tbWFuZHMu
aCIKICNpbmNsdWRlICJndC9pbnRlbF9ndC5oIgotI2luY2x1ZGUgImd0L2ludGVsX2xyY19yZWcu
aCIKKyNpbmNsdWRlICJndC9pbnRlbF9scmMuaCIKICNpbmNsdWRlICJndC9pbnRlbF9yaW5nLmgi
CiAKICNpbmNsdWRlICJpOTE1X2Rydi5oIgotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVs
LWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcv
bWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZngK

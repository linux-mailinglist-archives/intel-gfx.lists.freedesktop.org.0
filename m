Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1DD1A63EBA
	for <lists+intel-gfx@lfdr.de>; Wed, 10 Jul 2019 02:55:13 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8B4138992E;
	Wed, 10 Jul 2019 00:55:11 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga03.intel.com (mga03.intel.com [134.134.136.65])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B010C8992E
 for <intel-gfx@lists.freedesktop.org>; Wed, 10 Jul 2019 00:55:09 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga005.jf.intel.com ([10.7.209.41])
 by orsmga103.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 09 Jul 2019 17:55:09 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,472,1557212400"; d="scan'208";a="340915100"
Received: from dceraolo-linux.fm.intel.com ([10.1.27.145])
 by orsmga005.jf.intel.com with ESMTP; 09 Jul 2019 17:55:09 -0700
From: Daniele Ceraolo Spurio <daniele.ceraolospurio@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Tue,  9 Jul 2019 17:54:31 -0700
Message-Id: <20190710005437.3496-7-daniele.ceraolospurio@intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190710005437.3496-1-daniele.ceraolospurio@intel.com>
References: <20190710005437.3496-1-daniele.ceraolospurio@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 06/12] drm/i915/guc: unify guc irq handling
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VGhlIDE2LWJpdCBndWMgaXJxIHZlY3RvciBpcyB1bmNoYW5nZWQgYWNyb3NzIGdlbnMsIHRoZSBv
bmx5IHRoaW5nIHRoYXQKbW92ZWQgaXMgaXRzIHBvc2l0aW9uIChmcm9tIHRoZSB1cHBlciAxNiBi
aXRzIG9mIHRoZSBQTSByZWdzIHRvIGl0cyBvd24KcmVnaXN0ZXIpLiBJbnN0ZWFkIG9mIGR1cGxp
Y2F0aW5nIGFsbCBkZWZpbmVzIGFuZCBmdW5jdGlvbnMgdG8gaGFuZGxlCnRoZSAyIGRpZmZlcmVu
dCBwb3NpdGlvbnMsIHdlIGNhbiB3b3JrIG9uIHRoZSB2ZWN0b3IgYW5kIHNoaWZ0IGl0IGFzCmFw
cHJvcHJpYXRlLiBXaGlsZSBhdCBpdCwgdXBkYXRlIHRoZSBoYW5kbGVyIHRvIHdvcmsgb24gaW50
ZWxfZ3VjLgoKU2lnbmVkLW9mZi1ieTogRGFuaWVsZSBDZXJhb2xvIFNwdXJpbyA8ZGFuaWVsZS5j
ZXJhb2xvc3B1cmlvQGludGVsLmNvbT4KQ2M6IE1pY2hhbCBXYWpkZWN6a28gPG1pY2hhbC53YWpk
ZWN6a29AaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmMgICAg
ICB8IDI0ICsrKysrKysrLS0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9y
ZWcuaCAgICAgIHwgMTAgLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNf
cmVnLmggfCAzMiArKysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0tCiAzIGZpbGVzIGNoYW5nZWQs
IDI1IGluc2VydGlvbnMoKyksIDQxIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfaXJxLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2lycS5j
CmluZGV4IDgzMWQxODVjMDdkMi4uNDJkNmQ4YmZhYzcwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2lycS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJx
LmMKQEAgLTI2NCw3ICsyNjQsNyBAQCBzdGF0aWMgdm9pZCBnZW4yX2lycV9pbml0KHN0cnVjdCBp
bnRlbF91bmNvcmUgKnVuY29yZSwKIAlnZW4yX2lycV9pbml0KCh1bmNvcmUpLCBpbXJfdmFsLCBp
ZXJfdmFsKQogCiBzdGF0aWMgdm9pZCBnZW42X3Jwc19pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBwbV9paXIpOwotc3RhdGljIHZvaWQgZ2VuOV9ndWNf
aXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgcG1faWly
KTsKK3N0YXRpYyB2b2lkIGd1Y19pcnFfaGFuZGxlcihzdHJ1Y3QgaW50ZWxfZ3VjICpndWMsIHUx
NiBndWNfaWlyKTsKIAogLyogRm9yIGRpc3BsYXkgaG90cGx1ZyBpbnRlcnJ1cHQgKi8KIHN0YXRp
YyBpbmxpbmUgdm9pZApAQCAtNjU4LDggKzY1OCw3IEBAIHZvaWQgZ2VuMTFfZW5hYmxlX2d1Y19p
bnRlcnJ1cHRzKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKIAogCXNwaW5fbG9ja19pcnEoJmRldl9w
cml2LT5pcnFfbG9jayk7CiAJaWYgKCFndWMtPmludGVycnVwdHMuZW5hYmxlZCkgewotCQl1MzIg
ZXZlbnRzID0gUkVHX0ZJRUxEX1BSRVAoRU5HSU5FMV9NQVNLLAotCQkJCQkgICAgR0VOMTFfR1VD
X0lOVFJfR1VDMkhPU1QpOworCQl1MzIgZXZlbnRzID0gUkVHX0ZJRUxEX1BSRVAoRU5HSU5FMV9N
QVNLLCBHVUNfSU5UUl9HVUMySE9TVCk7CiAKIAkJV0FSTl9PTl9PTkNFKGdlbjExX3Jlc2V0X29u
ZV9paXIoJmRldl9wcml2LT5ndCwgMCwgR0VOMTFfR1VDKSk7CiAJCUk5MTVfV1JJVEUoR0VOMTFf
R1VDX1NHX0lOVFJfRU5BQkxFLCBldmVudHMpOwpAQCAtMTY1Niw3ICsxNjU1LDcgQEAgc3RhdGlj
IHZvaWQgZ2VuOF9ndF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
IAogCWlmIChtYXN0ZXJfY3RsICYgKEdFTjhfR1RfUE1fSVJRIHwgR0VOOF9HVF9HVUNfSVJRKSkg
ewogCQlnZW42X3Jwc19pcnFfaGFuZGxlcihpOTE1LCBndF9paXJbMl0pOwotCQlnZW45X2d1Y19p
cnFfaGFuZGxlcihpOTE1LCBndF9paXJbMl0pOworCQlndWNfaXJxX2hhbmRsZXIoJmk5MTUtPmd1
YywgZ3RfaWlyWzJdID4+IDE2KTsKIAl9CiB9CiAKQEAgLTE5NTUsMTYgKzE5NTQsMTAgQEAgc3Rh
dGljIHZvaWQgZ2VuNl9ycHNfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LCB1MzIgcG1faWlyKQogCQlEUk1fREVCVUcoIkNvbW1hbmQgcGFyc2VyIGVycm9yLCBw
bV9paXIgMHglMDh4XG4iLCBwbV9paXIpOwogfQogCi1zdGF0aWMgdm9pZCBnZW45X2d1Y19pcnFf
aGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBndF9paXIpCitz
dGF0aWMgdm9pZCBndWNfaXJxX2hhbmRsZXIoc3RydWN0IGludGVsX2d1YyAqZ3VjLCB1MTYgaWly
KQogewotCWlmIChndF9paXIgJiBHRU45X0dVQ19UT19IT1NUX0lOVF9FVkVOVCkKLQkJaW50ZWxf
Z3VjX3RvX2hvc3RfZXZlbnRfaGFuZGxlcigmZGV2X3ByaXYtPmd1Yyk7Ci19Ci0KLXN0YXRpYyB2
b2lkIGdlbjExX2d1Y19pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwg
dTE2IGlpcikKLXsKLQlpZiAoaWlyICYgR0VOMTFfR1VDX0lOVFJfR1VDMkhPU1QpCi0JCWludGVs
X2d1Y190b19ob3N0X2V2ZW50X2hhbmRsZXIoJmk5MTUtPmd1Yyk7CisJaWYgKGlpciAmIEdVQ19J
TlRSX0dVQzJIT1NUKQorCQlpbnRlbF9ndWNfdG9faG9zdF9ldmVudF9oYW5kbGVyKGd1Yyk7CiB9
CiAKIHN0YXRpYyB2b2lkIGk5eHhfcGlwZXN0YXRfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKQEAgLTMwOTIsNyArMzA4NSw3IEBAIGdlbjExX290aGVyX2lycV9o
YW5kbGVyKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGNvbnN0IHU4IGluc3RhbmNlLAogCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3QtPmk5MTU7CiAKIAlpZiAoaW5zdGFuY2UgPT0gT1RI
RVJfR1VDX0lOU1RBTkNFKQotCQlyZXR1cm4gZ2VuMTFfZ3VjX2lycV9oYW5kbGVyKGk5MTUsIGlp
cik7CisJCXJldHVybiBndWNfaXJxX2hhbmRsZXIoJmk5MTUtPmd1YywgaWlyKTsKIAogCWlmIChp
bnN0YW5jZSA9PSBPVEhFUl9HVFBNX0lOU1RBTkNFKQogCQlyZXR1cm4gZ2VuMTFfcnBzX2lycV9o
YW5kbGVyKGd0LCBpaXIpOwpAQCAtNDc2NCw4ICs0NzU3LDkgQEAgdm9pZCBpbnRlbF9pcnFfaW5p
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJZm9yIChpID0gMDsgaSA8IE1B
WF9MM19TTElDRVM7ICsraSkKIAkJZGV2X3ByaXYtPmwzX3Bhcml0eS5yZW1hcF9pbmZvW2ldID0g
TlVMTDsKIAorCS8qIHByZS1nZW4xMSB0aGUgZ3VjIGlycXMgYml0cyBhcmUgaW4gdGhlIHVwcGVy
IDE2IGJpdHMgb2YgdGhlIHBtIHJlZyAqLwogCWlmIChIQVNfR1VDX1NDSEVEKGRldl9wcml2KSAm
JiBJTlRFTF9HRU4oZGV2X3ByaXYpIDwgMTEpCi0JCWRldl9wcml2LT5wbV9ndWNfZXZlbnRzID0g
R0VOOV9HVUNfVE9fSE9TVF9JTlRfRVZFTlQ7CisJCWRldl9wcml2LT5wbV9ndWNfZXZlbnRzID0g
R1VDX0lOVFJfR1VDMkhPU1QgPDwgMTY7CiAKIAkvKiBMZXQncyB0cmFjayB0aGUgZW5hYmxlZCBy
cHMgZXZlbnRzICovCiAJaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpKQpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZWcuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfcmVnLmgKaW5kZXggNTg5OGY1OWUzZGQ3Li40ZGMzMWU0ODhiODAgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVnLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9yZWcuaApAQCAtNzM0MiwxNiArNzM0Miw2IEBAIGVudW0gewogI2RlZmluZSBHRU44X0dU
X0lJUih3aGljaCkgX01NSU8oMHg0NDMwOCArICgweDEwICogKHdoaWNoKSkpCiAjZGVmaW5lIEdF
TjhfR1RfSUVSKHdoaWNoKSBfTU1JTygweDQ0MzBjICsgKDB4MTAgKiAod2hpY2gpKSkKIAotI2Rl
ZmluZSBHRU45X0dVQ19UT19IT1NUX0lOVF9FVkVOVAkoMSA8PCAzMSkKLSNkZWZpbmUgR0VOOV9H
VUNfRVhFQ19FUlJPUl9FVkVOVAkoMSA8PCAzMCkKLSNkZWZpbmUgR0VOOV9HVUNfRElTUExBWV9F
VkVOVAkJKDEgPDwgMjkpCi0jZGVmaW5lIEdFTjlfR1VDX1NFTUFfU0lHTkFMX0VWRU5UCSgxIDw8
IDI4KQotI2RlZmluZSBHRU45X0dVQ19JT01NVV9NU0dfRVZFTlQJKDEgPDwgMjcpCi0jZGVmaW5l
IEdFTjlfR1VDX0RCX1JJTkdfRVZFTlQJCSgxIDw8IDI2KQotI2RlZmluZSBHRU45X0dVQ19ETUFf
RE9ORV9FVkVOVAkJKDEgPDwgMjUpCi0jZGVmaW5lIEdFTjlfR1VDX0ZBVEFMX0VSUk9SX0VWRU5U
CSgxIDw8IDI0KQotI2RlZmluZSBHRU45X0dVQ19OT1RJRklDQVRJT05fRVZFTlQJKDEgPDwgMjMp
Ci0KICNkZWZpbmUgR0VOOF9SQ1NfSVJRX1NISUZUIDAKICNkZWZpbmUgR0VOOF9CQ1NfSVJRX1NI
SUZUIDE2CiAjZGVmaW5lIEdFTjhfVkNTMF9JUlFfU0hJRlQgMCAgLyogTkI6IFZDUzEgaW4gYnNw
ZWMhICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfcmVnLmgg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfcmVnLmgKaW5kZXggYTVhYjdiYzU1MDRj
Li5lM2NiYjIzMjk5Y2UgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1
Y19yZWcuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfcmVnLmgKQEAgLTE0
MSwyMSArMTQxLDIxIEBAIHN0cnVjdCBndWNfZG9vcmJlbGxfaW5mbyB7CiAjZGVmaW5lIEdVQ19Q
TV9QMjRDX0lFUgkJCV9NTUlPKDB4QzU1QykKIAogLyogR3VDIEludGVycnVwdCBWZWN0b3IgKi8K
LSNkZWZpbmUgR0VOMTFfR1VDX0lOVFJfR1VDMkhPU1QJCSgxIDw8IDE1KQotI2RlZmluZSBHRU4x
MV9HVUNfSU5UUl9FWEVDX0VSUk9SCSgxIDw8IDE0KQotI2RlZmluZSBHRU4xMV9HVUNfSU5UUl9E
SVNQTEFZX0VWRU5UCSgxIDw8IDEzKQotI2RlZmluZSBHRU4xMV9HVUNfSU5UUl9TRU1fU0lHCQko
MSA8PCAxMikKLSNkZWZpbmUgR0VOMTFfR1VDX0lOVFJfSU9NTVUyR1VDCSgxIDw8IDExKQotI2Rl
ZmluZSBHRU4xMV9HVUNfSU5UUl9ET09SQkVMTF9SQU5HCSgxIDw8IDEwKQotI2RlZmluZSBHRU4x
MV9HVUNfSU5UUl9ETUFfRE9ORQkJKDEgPDwgIDkpCi0jZGVmaW5lIEdFTjExX0dVQ19JTlRSX0ZB
VEFMX0VSUk9SCSgxIDw8ICA4KQotI2RlZmluZSBHRU4xMV9HVUNfSU5UUl9OT1RJRl9FUlJPUgko
MSA8PCAgNykKLSNkZWZpbmUgR0VOMTFfR1VDX0lOVFJfU1dfSU5UXzYJCSgxIDw8ICA2KQotI2Rl
ZmluZSBHRU4xMV9HVUNfSU5UUl9TV19JTlRfNQkJKDEgPDwgIDUpCi0jZGVmaW5lIEdFTjExX0dV
Q19JTlRSX1NXX0lOVF80CQkoMSA8PCAgNCkKLSNkZWZpbmUgR0VOMTFfR1VDX0lOVFJfU1dfSU5U
XzMJCSgxIDw8ICAzKQotI2RlZmluZSBHRU4xMV9HVUNfSU5UUl9TV19JTlRfMgkJKDEgPDwgIDIp
Ci0jZGVmaW5lIEdFTjExX0dVQ19JTlRSX1NXX0lOVF8xCQkoMSA8PCAgMSkKLSNkZWZpbmUgR0VO
MTFfR1VDX0lOVFJfU1dfSU5UXzAJCSgxIDw8ICAwKQorI2RlZmluZSBHVUNfSU5UUl9HVUMySE9T
VAkJQklUKDE1KQorI2RlZmluZSBHVUNfSU5UUl9FWEVDX0VSUk9SCQlCSVQoMTQpCisjZGVmaW5l
IEdVQ19JTlRSX0RJU1BMQVlfRVZFTlQJCUJJVCgxMykKKyNkZWZpbmUgR1VDX0lOVFJfU0VNX1NJ
RwkJQklUKDEyKQorI2RlZmluZSBHVUNfSU5UUl9JT01NVTJHVUMJCUJJVCgxMSkKKyNkZWZpbmUg
R1VDX0lOVFJfRE9PUkJFTExfUkFORwkJQklUKDEwKQorI2RlZmluZSBHVUNfSU5UUl9ETUFfRE9O
RQkJQklUKDkpCisjZGVmaW5lIEdVQ19JTlRSX0ZBVEFMX0VSUk9SCQlCSVQoOCkKKyNkZWZpbmUg
R1VDX0lOVFJfTk9USUZfRVJST1IJCUJJVCg3KQorI2RlZmluZSBHVUNfSU5UUl9TV19JTlRfNgkJ
QklUKDYpCisjZGVmaW5lIEdVQ19JTlRSX1NXX0lOVF81CQlCSVQoNSkKKyNkZWZpbmUgR1VDX0lO
VFJfU1dfSU5UXzQJCUJJVCg0KQorI2RlZmluZSBHVUNfSU5UUl9TV19JTlRfMwkJQklUKDMpCisj
ZGVmaW5lIEdVQ19JTlRSX1NXX0lOVF8yCQlCSVQoMikKKyNkZWZpbmUgR1VDX0lOVFJfU1dfSU5U
XzEJCUJJVCgxKQorI2RlZmluZSBHVUNfSU5UUl9TV19JTlRfMAkJQklUKDApCiAKICNlbmRpZgot
LSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
XwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcK
aHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

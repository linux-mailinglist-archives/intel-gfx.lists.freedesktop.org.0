Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 47D11D9182
	for <lists+intel-gfx@lfdr.de>; Wed, 16 Oct 2019 14:50:40 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1805B6E969;
	Wed, 16 Oct 2019 12:50:38 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga11.intel.com (mga11.intel.com [192.55.52.93])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 474BA6E3FB
 for <intel-gfx@lists.freedesktop.org>; Wed, 16 Oct 2019 12:50:36 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga007.jf.intel.com ([10.7.209.58])
 by fmsmga102.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 16 Oct 2019 05:50:28 -0700
X-IronPort-AV: E=Sophos;i="5.67,303,1566889200"; d="scan'208";a="186138762"
Received: from dwiesing-mobl.ger.corp.intel.com (HELO [10.252.31.172])
 ([10.252.31.172])
 by orsmga007-auth.jf.intel.com with ESMTP/TLS/AES256-SHA;
 16 Oct 2019 05:50:27 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20191016113240.6468-1-chris@chris-wilson.co.uk>
 <20191016120249.22714-1-chris@chris-wilson.co.uk>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <0d271f51-ff02-d097-d91d-9376f26df95f@linux.intel.com>
Date: Wed, 16 Oct 2019 13:50:22 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <20191016120249.22714-1-chris@chris-wilson.co.uk>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH v2] drm/i915/selftests: Teach execlists to
 take intel_gt as its argument
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDE2LzEwLzIwMTkgMTM6MDIsIENocmlzIFdpbHNvbiB3cm90ZToKPiBUaGUgZXhlY2xpc3Rz
IHNlbGZ0ZXN0cyBhcmUgaGFyZHdhcmUgY2VudHJpYyBhbmQgc28gd2FudCB0byB1c2UgdGhlIGd0
Cj4gYXMgaXRzIHRhcmdldC4KPiAKPiBTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlz
QGNocmlzLXdpbHNvbi5jby51az4KPiBDYzogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGlu
QGludGVsLmNvbT4KPiAtLS0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xy
Yy5jIHwgMjkwICsrKysrKysrKysrKy0tLS0tLS0tLS0tLS0KPiAgIDEgZmlsZSBjaGFuZ2VkLCAx
NDMgaW5zZXJ0aW9ucygrKSwgMTQ3IGRlbGV0aW9ucygtKQo+IAo+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L3NlbGZ0ZXN0X2xyYy5jCj4gaW5kZXggOWMxZjM0ZmI1ODgyLi4yODY4MzcxYzYwOWUgMTAw
NjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKPiArKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwo+IEBAIC01MSwyMCArNTEs
MjAgQEAgc3RhdGljIHN0cnVjdCBpOTE1X3ZtYSAqY3JlYXRlX3NjcmF0Y2goc3RydWN0IGludGVs
X2d0ICpndCkKPiAgIAo+ICAgc3RhdGljIGludCBsaXZlX3Nhbml0eWNoZWNrKHZvaWQgKmFyZykK
PiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYXJnOwo+ICsJc3RydWN0
IGludGVsX2d0ICpndCA9IGFyZzsKPiAgIAlzdHJ1Y3QgaTkxNV9nZW1fZW5naW5lc19pdGVyIGl0
Owo+ICAgCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7Cj4gICAJc3RydWN0IGludGVsX2Nv
bnRleHQgKmNlOwo+ICAgCXN0cnVjdCBpZ3Rfc3Bpbm5lciBzcGluOwo+ICAgCWludCBlcnIgPSAt
RU5PTUVNOwo+ICAgCj4gLQlpZiAoIUhBU19MT0dJQ0FMX1JJTkdfQ09OVEVYVFMoaTkxNSkpCj4g
KwlpZiAoIUhBU19MT0dJQ0FMX1JJTkdfQ09OVEVYVFMoZ3QtPmk5MTUpKQo+ICAgCQlyZXR1cm4g
MDsKPiAgIAo+IC0JaWYgKGlndF9zcGlubmVyX2luaXQoJnNwaW4sICZpOTE1LT5ndCkpCj4gKwlp
ZiAoaWd0X3NwaW5uZXJfaW5pdCgmc3BpbiwgZ3QpKQo+ICAgCQlyZXR1cm4gLUVOT01FTTsKPiAg
IAo+IC0JY3R4ID0ga2VybmVsX2NvbnRleHQoaTkxNSk7Cj4gKwljdHggPSBrZXJuZWxfY29udGV4
dChndC0+aTkxNSk7Cj4gICAJaWYgKCFjdHgpCj4gICAJCWdvdG8gZXJyX3NwaW47Cj4gICAKPiBA
QCAtODEsMTMgKzgxLDEzIEBAIHN0YXRpYyBpbnQgbGl2ZV9zYW5pdHljaGVjayh2b2lkICphcmcp
Cj4gICAJCWlmICghaWd0X3dhaXRfZm9yX3NwaW5uZXIoJnNwaW4sIHJxKSkgewo+ICAgCQkJR0VN
X1RSQUNFKCJzcGlubmVyIGZhaWxlZCB0byBzdGFydFxuIik7Cj4gICAJCQlHRU1fVFJBQ0VfRFVN
UCgpOwo+IC0JCQlpbnRlbF9ndF9zZXRfd2VkZ2VkKCZpOTE1LT5ndCk7Cj4gKwkJCWludGVsX2d0
X3NldF93ZWRnZWQoZ3QpOwo+ICAgCQkJZXJyID0gLUVJTzsKPiAgIAkJCWdvdG8gZXJyX2N0eDsK
PiAgIAkJfQo+ICAgCj4gICAJCWlndF9zcGlubmVyX2VuZCgmc3Bpbik7Cj4gLQkJaWYgKGlndF9m
bHVzaF90ZXN0KGk5MTUpKSB7Cj4gKwkJaWYgKGlndF9mbHVzaF90ZXN0KGd0LT5pOTE1KSkgewo+
ICAgCQkJZXJyID0gLUVJTzsKPiAgIAkJCWdvdG8gZXJyX2N0eDsKPiAgIAkJfQo+IEBAIC0xMDIs
NyArMTAyLDcgQEAgc3RhdGljIGludCBsaXZlX3Nhbml0eWNoZWNrKHZvaWQgKmFyZykKPiAgIAly
ZXR1cm4gZXJyOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBpbnQgbGl2ZV91bmxpdGVfcmVzdG9yZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50IHByaW8pCj4gK3N0YXRpYyBpbnQgbGl2
ZV91bmxpdGVfcmVzdG9yZShzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBpbnQgcHJpbykKPiAgIHsKPiAg
IAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4gICAJc3RydWN0IGk5MTVfZ2VtX2Nv
bnRleHQgKmN0eDsKPiBAQCAtMTE1LDE1ICsxMTUsMTUgQEAgc3RhdGljIGludCBsaXZlX3VubGl0
ZV9yZXN0b3JlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBpbnQgcHJpbykKPiAgIAkg
KiBvbiB0aGUgc2FtZSBlbmdpbmUgZnJvbSB0aGUgc2FtZSBwYXJlbnQgY29udGV4dC4KPiAgIAkg
Ki8KPiAgIAo+IC0JaWYgKGlndF9zcGlubmVyX2luaXQoJnNwaW4sICZpOTE1LT5ndCkpCj4gKwlp
ZiAoaWd0X3NwaW5uZXJfaW5pdCgmc3BpbiwgZ3QpKQo+ICAgCQlyZXR1cm4gZXJyOwo+ICAgCj4g
LQljdHggPSBrZXJuZWxfY29udGV4dChpOTE1KTsKPiArCWN0eCA9IGtlcm5lbF9jb250ZXh0KGd0
LT5pOTE1KTsKPiAgIAlpZiAoIWN0eCkKPiAgIAkJZ290byBlcnJfc3BpbjsKPiAgIAo+ICAgCWVy
ciA9IDA7Cj4gLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgewo+ICsJZm9yX2Vh
Y2hfZW5naW5lKGVuZ2luZSwgZ3QtPmk5MTUsIGlkKSB7CgpeXl4KCj4gICAJCXN0cnVjdCBpbnRl
bF9jb250ZXh0ICpjZVsyXSA9IHt9Owo+ICAgCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycVsyXTsK
PiAgIAkJc3RydWN0IGlndF9saXZlX3Rlc3QgdDsKPiBAQCAtMTM1LDcgKzEzNSw3IEBAIHN0YXRp
YyBpbnQgbGl2ZV91bmxpdGVfcmVzdG9yZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwg
aW50IHByaW8pCj4gICAJCWlmICghaW50ZWxfZW5naW5lX2Nhbl9zdG9yZV9kd29yZChlbmdpbmUp
KQo+ICAgCQkJY29udGludWU7Cj4gICAKPiAtCQlpZiAoaWd0X2xpdmVfdGVzdF9iZWdpbigmdCwg
aTkxNSwgX19mdW5jX18sIGVuZ2luZS0+bmFtZSkpIHsKPiArCQlpZiAoaWd0X2xpdmVfdGVzdF9i
ZWdpbigmdCwgZ3QtPmk5MTUsIF9fZnVuY19fLCBlbmdpbmUtPm5hbWUpKSB7Cj4gICAJCQllcnIg
PSAtRUlPOwo+ICAgCQkJYnJlYWs7Cj4gICAJCX0KPiBAQCAtNDE2LDcgKzQxNiw3IEBAIHNsaWNl
X3NlbWFwaG9yZV9xdWV1ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpvdXRlciwKPiAgIAo+ICAg
c3RhdGljIGludCBsaXZlX3RpbWVzbGljZV9wcmVlbXB0KHZvaWQgKmFyZykKPiAgIHsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYXJnOwo+ICsJc3RydWN0IGludGVsX2d0ICpn
dCA9IGFyZzsKPiAgIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwo+ICAgCXN0cnVj
dCBpOTE1X3ZtYSAqdm1hOwo+ICAgCXZvaWQgKnZhZGRyOwo+IEBAIC00MzIsMTEgKzQzMiwxMSBA
QCBzdGF0aWMgaW50IGxpdmVfdGltZXNsaWNlX3ByZWVtcHQodm9pZCAqYXJnKQo+ICAgCSAqIHJl
YWR5IHRhc2suCj4gICAJICovCj4gICAKPiAtCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVf
aW50ZXJuYWwoaTkxNSwgUEFHRV9TSVpFKTsKPiArCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVh
dGVfaW50ZXJuYWwoZ3QtPmk5MTUsIFBBR0VfU0laRSk7Cj4gICAJaWYgKElTX0VSUihvYmopKQo+
ICAgCQlyZXR1cm4gUFRSX0VSUihvYmopOwo+ICAgCj4gLQl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5j
ZShvYmosICZpOTE1LT5nZ3R0LnZtLCBOVUxMKTsKPiArCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNl
KG9iaiwgJmd0LT5nZ3R0LT52bSwgTlVMTCk7Cj4gICAJaWYgKElTX0VSUih2bWEpKSB7Cj4gICAJ
CWVyciA9IFBUUl9FUlIodm1hKTsKPiAgIAkJZ290byBlcnJfb2JqOwo+IEBAIC00NTYsNyArNDU2
LDcgQEAgc3RhdGljIGludCBsaXZlX3RpbWVzbGljZV9wcmVlbXB0KHZvaWQgKmFyZykKPiAgIAkJ
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwo+ICAgCQllbnVtIGludGVsX2VuZ2luZV9p
ZCBpZDsKPiAgIAo+IC0JCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKSB7Cj4gKwkJ
Zm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QtPmk5MTUsIGlkKSB7CgpeXl4KCj4gICAJCQlpZiAo
IWludGVsX2VuZ2luZV9oYXNfcHJlZW1wdGlvbihlbmdpbmUpKQo+ICAgCQkJCWNvbnRpbnVlOwo+
ICAgCj4gQEAgLTQ2Niw3ICs0NjYsNyBAQCBzdGF0aWMgaW50IGxpdmVfdGltZXNsaWNlX3ByZWVt
cHQodm9pZCAqYXJnKQo+ICAgCQkJaWYgKGVycikKPiAgIAkJCQlnb3RvIGVycl9waW47Cj4gICAK
PiAtCQkJaWYgKGlndF9mbHVzaF90ZXN0KGk5MTUpKSB7Cj4gKwkJCWlmIChpZ3RfZmx1c2hfdGVz
dChndC0+aTkxNSkpIHsKPiAgIAkJCQllcnIgPSAtRUlPOwo+ICAgCQkJCWdvdG8gZXJyX3BpbjsK
PiAgIAkJCX0KPiBAQCAtNDg0LDcgKzQ4NCw3IEBAIHN0YXRpYyBpbnQgbGl2ZV90aW1lc2xpY2Vf
cHJlZW1wdCh2b2lkICphcmcpCj4gICAKPiAgIHN0YXRpYyBpbnQgbGl2ZV9idXN5d2FpdF9wcmVl
bXB0KHZvaWQgKmFyZykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
YXJnOwo+ICsJc3RydWN0IGludGVsX2d0ICpndCA9IGFyZzsKPiAgIAlzdHJ1Y3QgaTkxNV9nZW1f
Y29udGV4dCAqY3R4X2hpLCAqY3R4X2xvOwo+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZTsKPiAgIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwo+IEBAIC00OTgsMTkg
KzQ5OCwxOSBAQCBzdGF0aWMgaW50IGxpdmVfYnVzeXdhaXRfcHJlZW1wdCh2b2lkICphcmcpCj4g
ICAJICogcHJlZW1wdCB0aGUgYnVzeXdhaXRzIHVzZWQgdG8gc3luY2hyb25pc2UgYmV0d2VlbiBy
aW5ncy4KPiAgIAkgKi8KPiAgIAo+IC0JY3R4X2hpID0ga2VybmVsX2NvbnRleHQoaTkxNSk7Cj4g
KwljdHhfaGkgPSBrZXJuZWxfY29udGV4dChndC0+aTkxNSk7Cj4gICAJaWYgKCFjdHhfaGkpCj4g
ICAJCXJldHVybiAtRU5PTUVNOwo+ICAgCWN0eF9oaS0+c2NoZWQucHJpb3JpdHkgPQo+ICAgCQlJ
OTE1X1VTRVJfUFJJT1JJVFkoSTkxNV9DT05URVhUX01BWF9VU0VSX1BSSU9SSVRZKTsKPiAgIAo+
IC0JY3R4X2xvID0ga2VybmVsX2NvbnRleHQoaTkxNSk7Cj4gKwljdHhfbG8gPSBrZXJuZWxfY29u
dGV4dChndC0+aTkxNSk7Cj4gICAJaWYgKCFjdHhfbG8pCj4gICAJCWdvdG8gZXJyX2N0eF9oaTsK
PiAgIAljdHhfbG8tPnNjaGVkLnByaW9yaXR5ID0KPiAgIAkJSTkxNV9VU0VSX1BSSU9SSVRZKEk5
MTVfQ09OVEVYVF9NSU5fVVNFUl9QUklPUklUWSk7Cj4gICAKPiAtCW9iaiA9IGk5MTVfZ2VtX29i
amVjdF9jcmVhdGVfaW50ZXJuYWwoaTkxNSwgUEFHRV9TSVpFKTsKPiArCW9iaiA9IGk5MTVfZ2Vt
X29iamVjdF9jcmVhdGVfaW50ZXJuYWwoZ3QtPmk5MTUsIFBBR0VfU0laRSk7Cj4gICAJaWYgKElT
X0VSUihvYmopKSB7Cj4gICAJCWVyciA9IFBUUl9FUlIob2JqKTsKPiAgIAkJZ290byBlcnJfY3R4
X2xvOwo+IEBAIC01MjIsNyArNTIyLDcgQEAgc3RhdGljIGludCBsaXZlX2J1c3l3YWl0X3ByZWVt
cHQodm9pZCAqYXJnKQo+ICAgCQlnb3RvIGVycl9vYmo7Cj4gICAJfQo+ICAgCj4gLQl2bWEgPSBp
OTE1X3ZtYV9pbnN0YW5jZShvYmosICZpOTE1LT5nZ3R0LnZtLCBOVUxMKTsKPiArCXZtYSA9IGk5
MTVfdm1hX2luc3RhbmNlKG9iaiwgJmd0LT5nZ3R0LT52bSwgTlVMTCk7Cj4gICAJaWYgKElTX0VS
Uih2bWEpKSB7Cj4gICAJCWVyciA9IFBUUl9FUlIodm1hKTsKPiAgIAkJZ290byBlcnJfbWFwOwo+
IEBAIC01MzIsNyArNTMyLDcgQEAgc3RhdGljIGludCBsaXZlX2J1c3l3YWl0X3ByZWVtcHQodm9p
ZCAqYXJnKQo+ICAgCWlmIChlcnIpCj4gICAJCWdvdG8gZXJyX21hcDsKPiAgIAo+IC0JZm9yX2Vh
Y2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKPiArCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUs
IGd0LT5pOTE1LCBpZCkgewoKXl5eCgo+ICAgCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpsbywgKmhp
Owo+ICAgCQlzdHJ1Y3QgaWd0X2xpdmVfdGVzdCB0Owo+ICAgCQl1MzIgKmNzOwo+IEBAIC01NDMs
NyArNTQzLDcgQEAgc3RhdGljIGludCBsaXZlX2J1c3l3YWl0X3ByZWVtcHQodm9pZCAqYXJnKQo+
ICAgCQlpZiAoIWludGVsX2VuZ2luZV9jYW5fc3RvcmVfZHdvcmQoZW5naW5lKSkKPiAgIAkJCWNv
bnRpbnVlOwo+ICAgCj4gLQkJaWYgKGlndF9saXZlX3Rlc3RfYmVnaW4oJnQsIGk5MTUsIF9fZnVu
Y19fLCBlbmdpbmUtPm5hbWUpKSB7Cj4gKwkJaWYgKGlndF9saXZlX3Rlc3RfYmVnaW4oJnQsIGd0
LT5pOTE1LCBfX2Z1bmNfXywgZW5naW5lLT5uYW1lKSkgewo+ICAgCQkJZXJyID0gLUVJTzsKPiAg
IAkJCWdvdG8gZXJyX3ZtYTsKPiAgIAkJfQo+IEBAIC02MjMsNyArNjIzLDcgQEAgc3RhdGljIGlu
dCBsaXZlX2J1c3l3YWl0X3ByZWVtcHQodm9pZCAqYXJnKQo+ICAgCQlpOTE1X3JlcXVlc3RfYWRk
KGhpKTsKPiAgIAo+ICAgCQlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQobG8sIDAsIEhaIC8gNSkgPCAw
KSB7Cj4gLQkJCXN0cnVjdCBkcm1fcHJpbnRlciBwID0gZHJtX2luZm9fcHJpbnRlcihpOTE1LT5k
cm0uZGV2KTsKPiArCQkJc3RydWN0IGRybV9wcmludGVyIHAgPSBkcm1faW5mb19wcmludGVyKGd0
LT5pOTE1LT5kcm0uZGV2KTsKPiAgIAo+ICAgCQkJcHJfZXJyKCIlczogRmFpbGVkIHRvIHByZWVt
cHQgc2VtYXBob3JlIGJ1c3l3YWl0IVxuIiwKPiAgIAkJCSAgICAgICBlbmdpbmUtPm5hbWUpOwo+
IEBAIC02MzEsNyArNjMxLDcgQEAgc3RhdGljIGludCBsaXZlX2J1c3l3YWl0X3ByZWVtcHQodm9p
ZCAqYXJnKQo+ICAgCQkJaW50ZWxfZW5naW5lX2R1bXAoZW5naW5lLCAmcCwgIiVzXG4iLCBlbmdp
bmUtPm5hbWUpOwo+ICAgCQkJR0VNX1RSQUNFX0RVTVAoKTsKPiAgIAo+IC0JCQlpbnRlbF9ndF9z
ZXRfd2VkZ2VkKCZpOTE1LT5ndCk7Cj4gKwkJCWludGVsX2d0X3NldF93ZWRnZWQoZ3QpOwo+ICAg
CQkJZXJyID0gLUVJTzsKPiAgIAkJCWdvdG8gZXJyX3ZtYTsKPiAgIAkJfQo+IEBAIC02NzcsNDUg
KzY3Nyw0NSBAQCBzcGlubmVyX2NyZWF0ZV9yZXF1ZXN0KHN0cnVjdCBpZ3Rfc3Bpbm5lciAqc3Bp
biwKPiAgIAo+ICAgc3RhdGljIGludCBsaXZlX3ByZWVtcHQodm9pZCAqYXJnKQo+ICAgewo+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBhcmc7Cj4gKwlzdHJ1Y3QgaW50ZWxfZ3Qg
Kmd0ID0gYXJnOwo+ICAgCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHhfaGksICpjdHhfbG87
Cj4gICAJc3RydWN0IGlndF9zcGlubmVyIHNwaW5faGksIHNwaW5fbG87Cj4gICAJc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lOwo+ICAgCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwo+ICAg
CWludCBlcnIgPSAtRU5PTUVNOwo+ICAgCj4gLQlpZiAoIUhBU19MT0dJQ0FMX1JJTkdfUFJFRU1Q
VElPTihpOTE1KSkKPiArCWlmICghSEFTX0xPR0lDQUxfUklOR19QUkVFTVBUSU9OKGd0LT5pOTE1
KSkKPiAgIAkJcmV0dXJuIDA7Cj4gICAKPiAtCWlmICghKGk5MTUtPmNhcHMuc2NoZWR1bGVyICYg
STkxNV9TQ0hFRFVMRVJfQ0FQX1BSRUVNUFRJT04pKQo+ICsJaWYgKCEoZ3QtPmk5MTUtPmNhcHMu
c2NoZWR1bGVyICYgSTkxNV9TQ0hFRFVMRVJfQ0FQX1BSRUVNUFRJT04pKQo+ICAgCQlwcl9lcnIo
IkxvZ2ljYWwgcHJlZW1wdGlvbiBzdXBwb3J0ZWQsIGJ1dCBub3QgZXhwb3NlZFxuIik7Cj4gICAK
PiAtCWlmIChpZ3Rfc3Bpbm5lcl9pbml0KCZzcGluX2hpLCAmaTkxNS0+Z3QpKQo+ICsJaWYgKGln
dF9zcGlubmVyX2luaXQoJnNwaW5faGksIGd0KSkKPiAgIAkJcmV0dXJuIC1FTk9NRU07Cj4gICAK
PiAtCWlmIChpZ3Rfc3Bpbm5lcl9pbml0KCZzcGluX2xvLCAmaTkxNS0+Z3QpKQo+ICsJaWYgKGln
dF9zcGlubmVyX2luaXQoJnNwaW5fbG8sIGd0KSkKPiAgIAkJZ290byBlcnJfc3Bpbl9oaTsKPiAg
IAo+IC0JY3R4X2hpID0ga2VybmVsX2NvbnRleHQoaTkxNSk7Cj4gKwljdHhfaGkgPSBrZXJuZWxf
Y29udGV4dChndC0+aTkxNSk7Cj4gICAJaWYgKCFjdHhfaGkpCj4gICAJCWdvdG8gZXJyX3NwaW5f
bG87Cj4gICAJY3R4X2hpLT5zY2hlZC5wcmlvcml0eSA9Cj4gICAJCUk5MTVfVVNFUl9QUklPUklU
WShJOTE1X0NPTlRFWFRfTUFYX1VTRVJfUFJJT1JJVFkpOwo+ICAgCj4gLQljdHhfbG8gPSBrZXJu
ZWxfY29udGV4dChpOTE1KTsKPiArCWN0eF9sbyA9IGtlcm5lbF9jb250ZXh0KGd0LT5pOTE1KTsK
PiAgIAlpZiAoIWN0eF9sbykKPiAgIAkJZ290byBlcnJfY3R4X2hpOwo+ICAgCWN0eF9sby0+c2No
ZWQucHJpb3JpdHkgPQo+ICAgCQlJOTE1X1VTRVJfUFJJT1JJVFkoSTkxNV9DT05URVhUX01JTl9V
U0VSX1BSSU9SSVRZKTsKPiAgIAo+IC0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQp
IHsKPiArCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LT5pOTE1LCBpZCkgewoKXl5eCgpBbHNv
LCBpOTE1IGxvY2FsIGluIHRoaXMgZnVuY3Rpb24gbWlnaHQgbWFrZSBzZW5zZSBpZiB5b3UgZmVl
bCBsaWtlIGl0LgoKPiAgIAkJc3RydWN0IGlndF9saXZlX3Rlc3QgdDsKPiAgIAkJc3RydWN0IGk5
MTVfcmVxdWVzdCAqcnE7Cj4gICAKPiAgIAkJaWYgKCFpbnRlbF9lbmdpbmVfaGFzX3ByZWVtcHRp
b24oZW5naW5lKSkKPiAgIAkJCWNvbnRpbnVlOwo+ICAgCj4gLQkJaWYgKGlndF9saXZlX3Rlc3Rf
YmVnaW4oJnQsIGk5MTUsIF9fZnVuY19fLCBlbmdpbmUtPm5hbWUpKSB7Cj4gKwkJaWYgKGlndF9s
aXZlX3Rlc3RfYmVnaW4oJnQsIGd0LT5pOTE1LCBfX2Z1bmNfXywgZW5naW5lLT5uYW1lKSkgewo+
ICAgCQkJZXJyID0gLUVJTzsKPiAgIAkJCWdvdG8gZXJyX2N0eF9sbzsKPiAgIAkJfQo+IEBAIC03
MzEsNyArNzMxLDcgQEAgc3RhdGljIGludCBsaXZlX3ByZWVtcHQodm9pZCAqYXJnKQo+ICAgCQlp
ZiAoIWlndF93YWl0X2Zvcl9zcGlubmVyKCZzcGluX2xvLCBycSkpIHsKPiAgIAkJCUdFTV9UUkFD
RSgibG8gc3Bpbm5lciBmYWlsZWQgdG8gc3RhcnRcbiIpOwo+ICAgCQkJR0VNX1RSQUNFX0RVTVAo
KTsKPiAtCQkJaW50ZWxfZ3Rfc2V0X3dlZGdlZCgmaTkxNS0+Z3QpOwo+ICsJCQlpbnRlbF9ndF9z
ZXRfd2VkZ2VkKGd0KTsKPiAgIAkJCWVyciA9IC1FSU87Cj4gICAJCQlnb3RvIGVycl9jdHhfbG87
Cj4gICAJCX0KPiBAQCAtNzQ4LDcgKzc0OCw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9wcmVlbXB0KHZv
aWQgKmFyZykKPiAgIAkJaWYgKCFpZ3Rfd2FpdF9mb3Jfc3Bpbm5lcigmc3Bpbl9oaSwgcnEpKSB7
Cj4gICAJCQlHRU1fVFJBQ0UoImhpIHNwaW5uZXIgZmFpbGVkIHRvIHN0YXJ0XG4iKTsKPiAgIAkJ
CUdFTV9UUkFDRV9EVU1QKCk7Cj4gLQkJCWludGVsX2d0X3NldF93ZWRnZWQoJmk5MTUtPmd0KTsK
PiArCQkJaW50ZWxfZ3Rfc2V0X3dlZGdlZChndCk7Cj4gICAJCQllcnIgPSAtRUlPOwo+ICAgCQkJ
Z290byBlcnJfY3R4X2xvOwo+ICAgCQl9Cj4gQEAgLTc3Niw3ICs3NzYsNyBAQCBzdGF0aWMgaW50
IGxpdmVfcHJlZW1wdCh2b2lkICphcmcpCj4gICAKPiAgIHN0YXRpYyBpbnQgbGl2ZV9sYXRlX3By
ZWVtcHQodm9pZCAqYXJnKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSBhcmc7Cj4gKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOwo+ICAgCXN0cnVjdCBpOTE1X2dl
bV9jb250ZXh0ICpjdHhfaGksICpjdHhfbG87Cj4gICAJc3RydWN0IGlndF9zcGlubmVyIHNwaW5f
aGksIHNwaW5fbG87Cj4gICAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwo+IEBAIC03
ODQsMzQgKzc4NCwzNCBAQCBzdGF0aWMgaW50IGxpdmVfbGF0ZV9wcmVlbXB0KHZvaWQgKmFyZykK
PiAgIAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKPiAgIAlpbnQgZXJyID0gLUVOT01FTTsKPiAg
IAo+IC0JaWYgKCFIQVNfTE9HSUNBTF9SSU5HX1BSRUVNUFRJT04oaTkxNSkpCj4gKwlpZiAoIUhB
U19MT0dJQ0FMX1JJTkdfUFJFRU1QVElPTihndC0+aTkxNSkpCj4gICAJCXJldHVybiAwOwo+ICAg
Cj4gLQlpZiAoaWd0X3NwaW5uZXJfaW5pdCgmc3Bpbl9oaSwgJmk5MTUtPmd0KSkKPiArCWlmIChp
Z3Rfc3Bpbm5lcl9pbml0KCZzcGluX2hpLCBndCkpCj4gICAJCXJldHVybiAtRU5PTUVNOwo+ICAg
Cj4gLQlpZiAoaWd0X3NwaW5uZXJfaW5pdCgmc3Bpbl9sbywgJmk5MTUtPmd0KSkKPiArCWlmIChp
Z3Rfc3Bpbm5lcl9pbml0KCZzcGluX2xvLCBndCkpCj4gICAJCWdvdG8gZXJyX3NwaW5faGk7Cj4g
ICAKPiAtCWN0eF9oaSA9IGtlcm5lbF9jb250ZXh0KGk5MTUpOwo+ICsJY3R4X2hpID0ga2VybmVs
X2NvbnRleHQoZ3QtPmk5MTUpOwo+ICAgCWlmICghY3R4X2hpKQo+ICAgCQlnb3RvIGVycl9zcGlu
X2xvOwo+ICAgCj4gLQljdHhfbG8gPSBrZXJuZWxfY29udGV4dChpOTE1KTsKPiArCWN0eF9sbyA9
IGtlcm5lbF9jb250ZXh0KGd0LT5pOTE1KTsKPiAgIAlpZiAoIWN0eF9sbykKPiAgIAkJZ290byBl
cnJfY3R4X2hpOwo+ICAgCj4gICAJLyogTWFrZSBzdXJlIGN0eF9sbyBzdGF5cyBiZWZvcmUgY3R4
X2hpIHVudGlsIHdlIHRyaWdnZXIgcHJlZW1wdGlvbi4gKi8KPiAgIAljdHhfbG8tPnNjaGVkLnBy
aW9yaXR5ID0gSTkxNV9VU0VSX1BSSU9SSVRZKDEpOwo+ICAgCj4gLQlmb3JfZWFjaF9lbmdpbmUo
ZW5naW5lLCBpOTE1LCBpZCkgewo+ICsJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QtPmk5MTUs
IGlkKSB7CgpeXl4KCj4gICAJCXN0cnVjdCBpZ3RfbGl2ZV90ZXN0IHQ7Cj4gICAJCXN0cnVjdCBp
OTE1X3JlcXVlc3QgKnJxOwo+ICAgCj4gICAJCWlmICghaW50ZWxfZW5naW5lX2hhc19wcmVlbXB0
aW9uKGVuZ2luZSkpCj4gICAJCQljb250aW51ZTsKPiAgIAo+IC0JCWlmIChpZ3RfbGl2ZV90ZXN0
X2JlZ2luKCZ0LCBpOTE1LCBfX2Z1bmNfXywgZW5naW5lLT5uYW1lKSkgewo+ICsJCWlmIChpZ3Rf
bGl2ZV90ZXN0X2JlZ2luKCZ0LCBndC0+aTkxNSwgX19mdW5jX18sIGVuZ2luZS0+bmFtZSkpIHsK
PiAgIAkJCWVyciA9IC1FSU87Cj4gICAJCQlnb3RvIGVycl9jdHhfbG87Cj4gICAJCX0KPiBAQCAt
ODc1LDcgKzg3NSw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9sYXRlX3ByZWVtcHQodm9pZCAqYXJnKQo+
ICAgZXJyX3dlZGdlZDoKPiAgIAlpZ3Rfc3Bpbm5lcl9lbmQoJnNwaW5faGkpOwo+ICAgCWlndF9z
cGlubmVyX2VuZCgmc3Bpbl9sbyk7Cj4gLQlpbnRlbF9ndF9zZXRfd2VkZ2VkKCZpOTE1LT5ndCk7
Cj4gKwlpbnRlbF9ndF9zZXRfd2VkZ2VkKGd0KTsKPiAgIAllcnIgPSAtRUlPOwo+ICAgCWdvdG8g
ZXJyX2N0eF9sbzsKPiAgIH0KPiBAQCAtODg1LDE0ICs4ODUsMTMgQEAgc3RydWN0IHByZWVtcHRf
Y2xpZW50IHsKPiAgIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4Owo+ICAgfTsKPiAgIAo+
IC1zdGF0aWMgaW50IHByZWVtcHRfY2xpZW50X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCj4gLQkJCSAgICAgICBzdHJ1Y3QgcHJlZW1wdF9jbGllbnQgKmMpCj4gK3N0YXRpYyBp
bnQgcHJlZW1wdF9jbGllbnRfaW5pdChzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBzdHJ1Y3QgcHJlZW1w
dF9jbGllbnQgKmMpCj4gICB7Cj4gLQljLT5jdHggPSBrZXJuZWxfY29udGV4dChpOTE1KTsKPiAr
CWMtPmN0eCA9IGtlcm5lbF9jb250ZXh0KGd0LT5pOTE1KTsKPiAgIAlpZiAoIWMtPmN0eCkKPiAg
IAkJcmV0dXJuIC1FTk9NRU07Cj4gICAKPiAtCWlmIChpZ3Rfc3Bpbm5lcl9pbml0KCZjLT5zcGlu
LCAmaTkxNS0+Z3QpKQo+ICsJaWYgKGlndF9zcGlubmVyX2luaXQoJmMtPnNwaW4sIGd0KSkKPiAg
IAkJZ290byBlcnJfY3R4Owo+ICAgCj4gICAJcmV0dXJuIDA7Cj4gQEAgLTkxMCw3ICs5MDksNyBA
QCBzdGF0aWMgdm9pZCBwcmVlbXB0X2NsaWVudF9maW5pKHN0cnVjdCBwcmVlbXB0X2NsaWVudCAq
YykKPiAgIAo+ICAgc3RhdGljIGludCBsaXZlX25vcHJlZW1wdCh2b2lkICphcmcpCj4gICB7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGFyZzsKPiArCXN0cnVjdCBpbnRlbF9n
dCAqZ3QgPSBhcmc7Cj4gICAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwo+ICAgCXN0
cnVjdCBwcmVlbXB0X2NsaWVudCBhLCBiOwo+ICAgCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwo+
IEBAIC05MjEsMTYgKzkyMCwxNiBAQCBzdGF0aWMgaW50IGxpdmVfbm9wcmVlbXB0KHZvaWQgKmFy
ZykKPiAgIAkgKiB0aGF0IG1heSBiZSBiZWluZyBvYnNlcnZlZCBhbmQgbm90IHdhbnQgdG8gYmUg
aW50ZXJydXB0ZWQuCj4gICAJICovCj4gICAKPiAtCWlmICghSEFTX0xPR0lDQUxfUklOR19QUkVF
TVBUSU9OKGk5MTUpKQo+ICsJaWYgKCFIQVNfTE9HSUNBTF9SSU5HX1BSRUVNUFRJT04oZ3QtPmk5
MTUpKQo+ICAgCQlyZXR1cm4gMDsKPiAgIAo+IC0JaWYgKHByZWVtcHRfY2xpZW50X2luaXQoaTkx
NSwgJmEpKQo+ICsJaWYgKHByZWVtcHRfY2xpZW50X2luaXQoZ3QsICZhKSkKPiAgIAkJcmV0dXJu
IC1FTk9NRU07Cj4gLQlpZiAocHJlZW1wdF9jbGllbnRfaW5pdChpOTE1LCAmYikpCj4gKwlpZiAo
cHJlZW1wdF9jbGllbnRfaW5pdChndCwgJmIpKQo+ICAgCQlnb3RvIGVycl9jbGllbnRfYTsKPiAg
IAliLmN0eC0+c2NoZWQucHJpb3JpdHkgPSBJOTE1X1VTRVJfUFJJT1JJVFkoSTkxNV9QUklPUklU
WV9NQVgpOwo+ICAgCj4gLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgewo+ICsJ
Zm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QtPmk5MTUsIGlkKSB7CgpeXl4KCj4gICAJCXN0cnVj
dCBpOTE1X3JlcXVlc3QgKnJxX2EsICpycV9iOwo+ICAgCj4gICAJCWlmICghaW50ZWxfZW5naW5l
X2hhc19wcmVlbXB0aW9uKGVuZ2luZSkpCj4gQEAgLTk5MCw3ICs5ODksNyBAQCBzdGF0aWMgaW50
IGxpdmVfbm9wcmVlbXB0KHZvaWQgKmFyZykKPiAgIAkJCWdvdG8gZXJyX3dlZGdlZDsKPiAgIAkJ
fQo+ICAgCj4gLQkJaWYgKGlndF9mbHVzaF90ZXN0KGk5MTUpKQo+ICsJCWlmIChpZ3RfZmx1c2hf
dGVzdChndC0+aTkxNSkpCj4gICAJCQlnb3RvIGVycl93ZWRnZWQ7Cj4gICAJfQo+ICAgCj4gQEAg
LTEwMDQsMTQgKzEwMDMsMTQgQEAgc3RhdGljIGludCBsaXZlX25vcHJlZW1wdCh2b2lkICphcmcp
Cj4gICBlcnJfd2VkZ2VkOgo+ICAgCWlndF9zcGlubmVyX2VuZCgmYi5zcGluKTsKPiAgIAlpZ3Rf
c3Bpbm5lcl9lbmQoJmEuc3Bpbik7Cj4gLQlpbnRlbF9ndF9zZXRfd2VkZ2VkKCZpOTE1LT5ndCk7
Cj4gKwlpbnRlbF9ndF9zZXRfd2VkZ2VkKGd0KTsKPiAgIAllcnIgPSAtRUlPOwo+ICAgCWdvdG8g
ZXJyX2NsaWVudF9iOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgaW50IGxpdmVfc3VwcHJlc3Nfc2Vs
Zl9wcmVlbXB0KHZvaWQgKmFyZykKPiAgIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gYXJnOwo+ICsJc3RydWN0IGludGVsX2d0ICpndCA9IGFyZzsKPiAgIAlzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4gICAJc3RydWN0IGk5MTVfc2NoZWRfYXR0ciBhdHRyID0g
ewo+ICAgCQkucHJpb3JpdHkgPSBJOTE1X1VTRVJfUFJJT1JJVFkoSTkxNV9QUklPUklUWV9NQVgp
Cj4gQEAgLTEwMjcsMjggKzEwMjYsMjggQEAgc3RhdGljIGludCBsaXZlX3N1cHByZXNzX3NlbGZf
cHJlZW1wdCh2b2lkICphcmcpCj4gICAJICogY29tcGxldGlvbiBldmVudC4KPiAgIAkgKi8KPiAg
IAo+IC0JaWYgKCFIQVNfTE9HSUNBTF9SSU5HX1BSRUVNUFRJT04oaTkxNSkpCj4gKwlpZiAoIUhB
U19MT0dJQ0FMX1JJTkdfUFJFRU1QVElPTihndC0+aTkxNSkpCj4gICAJCXJldHVybiAwOwo+ICAg
Cj4gLQlpZiAoVVNFU19HVUNfU1VCTUlTU0lPTihpOTE1KSkKPiArCWlmIChVU0VTX0dVQ19TVUJN
SVNTSU9OKGd0LT5pOTE1KSkKPiAgIAkJcmV0dXJuIDA7IC8qIHByZXN1bWUgYmxhY2sgYmxveCAq
Lwo+ICAgCj4gLQlpZiAoaW50ZWxfdmdwdV9hY3RpdmUoaTkxNSkpCj4gKwlpZiAoaW50ZWxfdmdw
dV9hY3RpdmUoZ3QtPmk5MTUpKQo+ICAgCQlyZXR1cm4gMDsgLyogR1ZUIGZvcmNlcyBzaW5nbGUg
cG9ydCAmIHJlcXVlc3Qgc3VibWlzc2lvbiAqLwo+ICAgCj4gLQlpZiAocHJlZW1wdF9jbGllbnRf
aW5pdChpOTE1LCAmYSkpCj4gKwlpZiAocHJlZW1wdF9jbGllbnRfaW5pdChndCwgJmEpKQo+ICAg
CQlyZXR1cm4gLUVOT01FTTsKPiAtCWlmIChwcmVlbXB0X2NsaWVudF9pbml0KGk5MTUsICZiKSkK
PiArCWlmIChwcmVlbXB0X2NsaWVudF9pbml0KGd0LCAmYikpCj4gICAJCWdvdG8gZXJyX2NsaWVu
dF9hOwo+ICAgCj4gLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgewo+ICsJZm9y
X2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QtPmk5MTUsIGlkKSB7CgpeXl4KCj4gICAJCXN0cnVjdCBp
OTE1X3JlcXVlc3QgKnJxX2EsICpycV9iOwo+ICAgCQlpbnQgZGVwdGg7Cj4gICAKPiAgIAkJaWYg
KCFpbnRlbF9lbmdpbmVfaGFzX3ByZWVtcHRpb24oZW5naW5lKSkKPiAgIAkJCWNvbnRpbnVlOwo+
ICAgCj4gLQkJaWYgKGlndF9mbHVzaF90ZXN0KGk5MTUpKQo+ICsJCWlmIChpZ3RfZmx1c2hfdGVz
dChndC0+aTkxNSkpCj4gICAJCQlnb3RvIGVycl93ZWRnZWQ7Cj4gICAKPiAgIAkJaW50ZWxfZW5n
aW5lX3BtX2dldChlbmdpbmUpOwo+IEBAIC0xMTA5LDcgKzExMDgsNyBAQCBzdGF0aWMgaW50IGxp
dmVfc3VwcHJlc3Nfc2VsZl9wcmVlbXB0KHZvaWQgKmFyZykKPiAgIAkJfQo+ICAgCj4gICAJCWlu
dGVsX2VuZ2luZV9wbV9wdXQoZW5naW5lKTsKPiAtCQlpZiAoaWd0X2ZsdXNoX3Rlc3QoaTkxNSkp
Cj4gKwkJaWYgKGlndF9mbHVzaF90ZXN0KGd0LT5pOTE1KSkKPiAgIAkJCWdvdG8gZXJyX3dlZGdl
ZDsKPiAgIAl9Cj4gICAKPiBAQCAtMTEyMyw3ICsxMTIyLDcgQEAgc3RhdGljIGludCBsaXZlX3N1
cHByZXNzX3NlbGZfcHJlZW1wdCh2b2lkICphcmcpCj4gICBlcnJfd2VkZ2VkOgo+ICAgCWlndF9z
cGlubmVyX2VuZCgmYi5zcGluKTsKPiAgIAlpZ3Rfc3Bpbm5lcl9lbmQoJmEuc3Bpbik7Cj4gLQlp
bnRlbF9ndF9zZXRfd2VkZ2VkKCZpOTE1LT5ndCk7Cj4gKwlpbnRlbF9ndF9zZXRfd2VkZ2VkKGd0
KTsKPiAgIAllcnIgPSAtRUlPOwo+ICAgCWdvdG8gZXJyX2NsaWVudF9iOwo+ICAgfQo+IEBAIC0x
MTgzLDcgKzExODIsNyBAQCBzdGF0aWMgdm9pZCBkdW1teV9yZXF1ZXN0X2ZyZWUoc3RydWN0IGk5
MTVfcmVxdWVzdCAqZHVtbXkpCj4gICAKPiAgIHN0YXRpYyBpbnQgbGl2ZV9zdXBwcmVzc193YWl0
X3ByZWVtcHQodm9pZCAqYXJnKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSBhcmc7Cj4gKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOwo+ICAgCXN0cnVjdCBwcmVl
bXB0X2NsaWVudCBjbGllbnRbNF07Cj4gICAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
Owo+ICAgCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwo+IEBAIC0xMTk2LDE5ICsxMTk1LDE5IEBA
IHN0YXRpYyBpbnQgbGl2ZV9zdXBwcmVzc193YWl0X3ByZWVtcHQodm9pZCAqYXJnKQo+ICAgCSAq
IG5vdCBuZWVkbGVzc2x5IGdlbmVyYXRlIHByZWVtcHQtdG8taWRsZSBjeWNsZXMuCj4gICAJICov
Cj4gICAKPiAtCWlmICghSEFTX0xPR0lDQUxfUklOR19QUkVFTVBUSU9OKGk5MTUpKQo+ICsJaWYg
KCFIQVNfTE9HSUNBTF9SSU5HX1BSRUVNUFRJT04oZ3QtPmk5MTUpKQo+ICAgCQlyZXR1cm4gMDsK
PiAgIAo+IC0JaWYgKHByZWVtcHRfY2xpZW50X2luaXQoaTkxNSwgJmNsaWVudFswXSkpIC8qIEVM
U1BbMF0gKi8KPiArCWlmIChwcmVlbXB0X2NsaWVudF9pbml0KGd0LCAmY2xpZW50WzBdKSkgLyog
RUxTUFswXSAqLwo+ICAgCQlyZXR1cm4gLUVOT01FTTsKPiAtCWlmIChwcmVlbXB0X2NsaWVudF9p
bml0KGk5MTUsICZjbGllbnRbMV0pKSAvKiBFTFNQWzFdICovCj4gKwlpZiAocHJlZW1wdF9jbGll
bnRfaW5pdChndCwgJmNsaWVudFsxXSkpIC8qIEVMU1BbMV0gKi8KPiAgIAkJZ290byBlcnJfY2xp
ZW50XzA7Cj4gLQlpZiAocHJlZW1wdF9jbGllbnRfaW5pdChpOTE1LCAmY2xpZW50WzJdKSkgLyog
aGVhZCBvZiBxdWV1ZSAqLwo+ICsJaWYgKHByZWVtcHRfY2xpZW50X2luaXQoZ3QsICZjbGllbnRb
Ml0pKSAvKiBoZWFkIG9mIHF1ZXVlICovCj4gICAJCWdvdG8gZXJyX2NsaWVudF8xOwo+IC0JaWYg
KHByZWVtcHRfY2xpZW50X2luaXQoaTkxNSwgJmNsaWVudFszXSkpIC8qIGJ5c3RhbmRlciAqLwo+
ICsJaWYgKHByZWVtcHRfY2xpZW50X2luaXQoZ3QsICZjbGllbnRbM10pKSAvKiBieXN0YW5kZXIg
Ki8KPiAgIAkJZ290byBlcnJfY2xpZW50XzI7Cj4gICAKPiAtCWZvcl9lYWNoX2VuZ2luZShlbmdp
bmUsIGk5MTUsIGlkKSB7Cj4gKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndC0+aTkxNSwgaWQp
IHsKCl5eXgoKPiAgIAkJaW50IGRlcHRoOwo+ICAgCj4gICAJCWlmICghaW50ZWxfZW5naW5lX2hh
c19wcmVlbXB0aW9uKGVuZ2luZSkpCj4gQEAgLTEyNjMsNyArMTI2Miw3IEBAIHN0YXRpYyBpbnQg
bGl2ZV9zdXBwcmVzc193YWl0X3ByZWVtcHQodm9pZCAqYXJnKQo+ICAgCQkJZm9yIChpID0gMDsg
aSA8IEFSUkFZX1NJWkUoY2xpZW50KTsgaSsrKQo+ICAgCQkJCWlndF9zcGlubmVyX2VuZCgmY2xp
ZW50W2ldLnNwaW4pOwo+ICAgCj4gLQkJCWlmIChpZ3RfZmx1c2hfdGVzdChpOTE1KSkKPiArCQkJ
aWYgKGlndF9mbHVzaF90ZXN0KGd0LT5pOTE1KSkKPiAgIAkJCQlnb3RvIGVycl93ZWRnZWQ7Cj4g
ICAKPiAgIAkJCWlmIChlbmdpbmUtPmV4ZWNsaXN0cy5wcmVlbXB0X2hhbmcuY291bnQpIHsKPiBA
QCAtMTI5MSwxNCArMTI5MCwxNCBAQCBzdGF0aWMgaW50IGxpdmVfc3VwcHJlc3Nfd2FpdF9wcmVl
bXB0KHZvaWQgKmFyZykKPiAgIGVycl93ZWRnZWQ6Cj4gICAJZm9yIChpID0gMDsgaSA8IEFSUkFZ
X1NJWkUoY2xpZW50KTsgaSsrKQo+ICAgCQlpZ3Rfc3Bpbm5lcl9lbmQoJmNsaWVudFtpXS5zcGlu
KTsKPiAtCWludGVsX2d0X3NldF93ZWRnZWQoJmk5MTUtPmd0KTsKPiArCWludGVsX2d0X3NldF93
ZWRnZWQoZ3QpOwo+ICAgCWVyciA9IC1FSU87Cj4gICAJZ290byBlcnJfY2xpZW50XzM7Cj4gICB9
Cj4gICAKPiAgIHN0YXRpYyBpbnQgbGl2ZV9jaGFpbl9wcmVlbXB0KHZvaWQgKmFyZykKPiAgIHsK
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYXJnOwo+ICsJc3RydWN0IGludGVs
X2d0ICpndCA9IGFyZzsKPiAgIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4gICAJ
c3RydWN0IHByZWVtcHRfY2xpZW50IGhpLCBsbzsKPiAgIAllbnVtIGludGVsX2VuZ2luZV9pZCBp
ZDsKPiBAQCAtMTMxMCwxNiArMTMwOSwxNiBAQCBzdGF0aWMgaW50IGxpdmVfY2hhaW5fcHJlZW1w
dCh2b2lkICphcmcpCj4gICAJICogdGhlIHByZXZpb3VzbHkgc3VibWl0dGVkIHNwaW5uZXIgaW4g
Qi4KPiAgIAkgKi8KPiAgIAo+IC0JaWYgKCFIQVNfTE9HSUNBTF9SSU5HX1BSRUVNUFRJT04oaTkx
NSkpCj4gKwlpZiAoIUhBU19MT0dJQ0FMX1JJTkdfUFJFRU1QVElPTihndC0+aTkxNSkpCj4gICAJ
CXJldHVybiAwOwo+ICAgCj4gLQlpZiAocHJlZW1wdF9jbGllbnRfaW5pdChpOTE1LCAmaGkpKQo+
ICsJaWYgKHByZWVtcHRfY2xpZW50X2luaXQoZ3QsICZoaSkpCj4gICAJCXJldHVybiAtRU5PTUVN
Owo+ICAgCj4gLQlpZiAocHJlZW1wdF9jbGllbnRfaW5pdChpOTE1LCAmbG8pKQo+ICsJaWYgKHBy
ZWVtcHRfY2xpZW50X2luaXQoZ3QsICZsbykpCj4gICAJCWdvdG8gZXJyX2NsaWVudF9oaTsKPiAg
IAo+IC0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKPiArCWZvcl9lYWNoX2Vu
Z2luZShlbmdpbmUsIGd0LT5pOTE1LCBpZCkgewoKXl5eCgo+ICAgCQlzdHJ1Y3QgaTkxNV9zY2hl
ZF9hdHRyIGF0dHIgPSB7Cj4gICAJCQkucHJpb3JpdHkgPSBJOTE1X1VTRVJfUFJJT1JJVFkoSTkx
NV9QUklPUklUWV9NQVgpLAo+ICAgCQl9Owo+IEBAIC0xMzUwLDcgKzEzNDksNyBAQCBzdGF0aWMg
aW50IGxpdmVfY2hhaW5fcHJlZW1wdCh2b2lkICphcmcpCj4gICAJCQlnb3RvIGVycl93ZWRnZWQ7
Cj4gICAJCX0KPiAgIAo+IC0JCWlmIChpZ3RfbGl2ZV90ZXN0X2JlZ2luKCZ0LCBpOTE1LCBfX2Z1
bmNfXywgZW5naW5lLT5uYW1lKSkgewo+ICsJCWlmIChpZ3RfbGl2ZV90ZXN0X2JlZ2luKCZ0LCBn
dC0+aTkxNSwgX19mdW5jX18sIGVuZ2luZS0+bmFtZSkpIHsKPiAgIAkJCWVyciA9IC1FSU87Cj4g
ICAJCQlnb3RvIGVycl93ZWRnZWQ7Cj4gICAJCX0KPiBAQCAtMTM4OCw3ICsxMzg3LDcgQEAgc3Rh
dGljIGludCBsaXZlX2NoYWluX3ByZWVtcHQodm9pZCAqYXJnKQo+ICAgCQkJaWd0X3NwaW5uZXJf
ZW5kKCZoaS5zcGluKTsKPiAgIAkJCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgSFogLyA1
KSA8IDApIHsKPiAgIAkJCQlzdHJ1Y3QgZHJtX3ByaW50ZXIgcCA9Cj4gLQkJCQkJZHJtX2luZm9f
cHJpbnRlcihpOTE1LT5kcm0uZGV2KTsKPiArCQkJCQlkcm1faW5mb19wcmludGVyKGd0LT5pOTE1
LT5kcm0uZGV2KTsKPiAgIAo+ICAgCQkJCXByX2VycigiRmFpbGVkIHRvIHByZWVtcHQgb3ZlciBj
aGFpbiBvZiAlZFxuIiwKPiAgIAkJCQkgICAgICAgY291bnQpOwo+IEBAIC0xNDA0LDcgKzE0MDMs
NyBAQCBzdGF0aWMgaW50IGxpdmVfY2hhaW5fcHJlZW1wdCh2b2lkICphcmcpCj4gICAJCQlpOTE1
X3JlcXVlc3RfYWRkKHJxKTsKPiAgIAkJCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgSFog
LyA1KSA8IDApIHsKPiAgIAkJCQlzdHJ1Y3QgZHJtX3ByaW50ZXIgcCA9Cj4gLQkJCQkJZHJtX2lu
Zm9fcHJpbnRlcihpOTE1LT5kcm0uZGV2KTsKPiArCQkJCQlkcm1faW5mb19wcmludGVyKGd0LT5p
OTE1LT5kcm0uZGV2KTsKPiAgIAo+ICAgCQkJCXByX2VycigiRmFpbGVkIHRvIGZsdXNoIGxvdyBw
cmlvcml0eSBjaGFpbiBvZiAlZCByZXF1ZXN0c1xuIiwKPiAgIAkJCQkgICAgICAgY291bnQpOwo+
IEBAIC0xNDMwLDQ1ICsxNDI5LDQ1IEBAIHN0YXRpYyBpbnQgbGl2ZV9jaGFpbl9wcmVlbXB0KHZv
aWQgKmFyZykKPiAgIGVycl93ZWRnZWQ6Cj4gICAJaWd0X3NwaW5uZXJfZW5kKCZoaS5zcGluKTsK
PiAgIAlpZ3Rfc3Bpbm5lcl9lbmQoJmxvLnNwaW4pOwo+IC0JaW50ZWxfZ3Rfc2V0X3dlZGdlZCgm
aTkxNS0+Z3QpOwo+ICsJaW50ZWxfZ3Rfc2V0X3dlZGdlZChndCk7Cj4gICAJZXJyID0gLUVJTzsK
PiAgIAlnb3RvIGVycl9jbGllbnRfbG87Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQgbGl2ZV9w
cmVlbXB0X2hhbmcodm9pZCAqYXJnKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBhcmc7Cj4gKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOwo+ICAgCXN0cnVjdCBp
OTE1X2dlbV9jb250ZXh0ICpjdHhfaGksICpjdHhfbG87Cj4gICAJc3RydWN0IGlndF9zcGlubmVy
IHNwaW5faGksIHNwaW5fbG87Cj4gICAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwo+
ICAgCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwo+ICAgCWludCBlcnIgPSAtRU5PTUVNOwo+ICAg
Cj4gLQlpZiAoIUhBU19MT0dJQ0FMX1JJTkdfUFJFRU1QVElPTihpOTE1KSkKPiArCWlmICghSEFT
X0xPR0lDQUxfUklOR19QUkVFTVBUSU9OKGd0LT5pOTE1KSkKPiAgIAkJcmV0dXJuIDA7Cj4gICAK
PiAtCWlmICghaW50ZWxfaGFzX3Jlc2V0X2VuZ2luZSgmaTkxNS0+Z3QpKQo+ICsJaWYgKCFpbnRl
bF9oYXNfcmVzZXRfZW5naW5lKGd0KSkKPiAgIAkJcmV0dXJuIDA7Cj4gICAKPiAtCWlmIChpZ3Rf
c3Bpbm5lcl9pbml0KCZzcGluX2hpLCAmaTkxNS0+Z3QpKQo+ICsJaWYgKGlndF9zcGlubmVyX2lu
aXQoJnNwaW5faGksIGd0KSkKPiAgIAkJcmV0dXJuIC1FTk9NRU07Cj4gICAKPiAtCWlmIChpZ3Rf
c3Bpbm5lcl9pbml0KCZzcGluX2xvLCAmaTkxNS0+Z3QpKQo+ICsJaWYgKGlndF9zcGlubmVyX2lu
aXQoJnNwaW5fbG8sIGd0KSkKPiAgIAkJZ290byBlcnJfc3Bpbl9oaTsKPiAgIAo+IC0JY3R4X2hp
ID0ga2VybmVsX2NvbnRleHQoaTkxNSk7Cj4gKwljdHhfaGkgPSBrZXJuZWxfY29udGV4dChndC0+
aTkxNSk7Cj4gICAJaWYgKCFjdHhfaGkpCj4gICAJCWdvdG8gZXJyX3NwaW5fbG87Cj4gICAJY3R4
X2hpLT5zY2hlZC5wcmlvcml0eSA9Cj4gICAJCUk5MTVfVVNFUl9QUklPUklUWShJOTE1X0NPTlRF
WFRfTUFYX1VTRVJfUFJJT1JJVFkpOwo+ICAgCj4gLQljdHhfbG8gPSBrZXJuZWxfY29udGV4dChp
OTE1KTsKPiArCWN0eF9sbyA9IGtlcm5lbF9jb250ZXh0KGd0LT5pOTE1KTsKPiAgIAlpZiAoIWN0
eF9sbykKPiAgIAkJZ290byBlcnJfY3R4X2hpOwo+ICAgCWN0eF9sby0+c2NoZWQucHJpb3JpdHkg
PQo+ICAgCQlJOTE1X1VTRVJfUFJJT1JJVFkoSTkxNV9DT05URVhUX01JTl9VU0VSX1BSSU9SSVRZ
KTsKPiAgIAo+IC0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKPiArCWZvcl9l
YWNoX2VuZ2luZShlbmdpbmUsIGd0LT5pOTE1LCBpZCkgewoKXl5eCgo+ICAgCQlzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpycTsKPiAgIAo+ICAgCQlpZiAoIWludGVsX2VuZ2luZV9oYXNfcHJlZW1wdGlv
bihlbmdpbmUpKQo+IEBAIC0xNDg1LDcgKzE0ODQsNyBAQCBzdGF0aWMgaW50IGxpdmVfcHJlZW1w
dF9oYW5nKHZvaWQgKmFyZykKPiAgIAkJaWYgKCFpZ3Rfd2FpdF9mb3Jfc3Bpbm5lcigmc3Bpbl9s
bywgcnEpKSB7Cj4gICAJCQlHRU1fVFJBQ0UoImxvIHNwaW5uZXIgZmFpbGVkIHRvIHN0YXJ0XG4i
KTsKPiAgIAkJCUdFTV9UUkFDRV9EVU1QKCk7Cj4gLQkJCWludGVsX2d0X3NldF93ZWRnZWQoJmk5
MTUtPmd0KTsKPiArCQkJaW50ZWxfZ3Rfc2V0X3dlZGdlZChndCk7Cj4gICAJCQllcnIgPSAtRUlP
Owo+ICAgCQkJZ290byBlcnJfY3R4X2xvOwo+ICAgCQl9Cj4gQEAgLTE1MDcsMjggKzE1MDYsMjgg
QEAgc3RhdGljIGludCBsaXZlX3ByZWVtcHRfaGFuZyh2b2lkICphcmcpCj4gICAJCQkJCQkgSFog
LyAxMCkpIHsKPiAgIAkJCXByX2VycigiUHJlZW1wdGlvbiBkaWQgbm90IG9jY3VyIHdpdGhpbiB0
aW1lb3V0ISIpOwo+ICAgCQkJR0VNX1RSQUNFX0RVTVAoKTsKPiAtCQkJaW50ZWxfZ3Rfc2V0X3dl
ZGdlZCgmaTkxNS0+Z3QpOwo+ICsJCQlpbnRlbF9ndF9zZXRfd2VkZ2VkKGd0KTsKPiAgIAkJCWVy
ciA9IC1FSU87Cj4gICAJCQlnb3RvIGVycl9jdHhfbG87Cj4gICAJCX0KPiAgIAo+IC0JCXNldF9i
aXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBpZCwgJmk5MTUtPmd0LnJlc2V0LmZsYWdzKTsKPiArCQlz
ZXRfYml0KEk5MTVfUkVTRVRfRU5HSU5FICsgaWQsICZndC0+cmVzZXQuZmxhZ3MpOwo+ICAgCQlp
bnRlbF9lbmdpbmVfcmVzZXQoZW5naW5lLCBOVUxMKTsKPiAtCQljbGVhcl9iaXQoSTkxNV9SRVNF
VF9FTkdJTkUgKyBpZCwgJmk5MTUtPmd0LnJlc2V0LmZsYWdzKTsKPiArCQljbGVhcl9iaXQoSTkx
NV9SRVNFVF9FTkdJTkUgKyBpZCwgJmd0LT5yZXNldC5mbGFncyk7Cj4gICAKPiAgIAkJZW5naW5l
LT5leGVjbGlzdHMucHJlZW1wdF9oYW5nLmluamVjdF9oYW5nID0gZmFsc2U7Cj4gICAKPiAgIAkJ
aWYgKCFpZ3Rfd2FpdF9mb3Jfc3Bpbm5lcigmc3Bpbl9oaSwgcnEpKSB7Cj4gICAJCQlHRU1fVFJB
Q0UoImhpIHNwaW5uZXIgZmFpbGVkIHRvIHN0YXJ0XG4iKTsKPiAgIAkJCUdFTV9UUkFDRV9EVU1Q
KCk7Cj4gLQkJCWludGVsX2d0X3NldF93ZWRnZWQoJmk5MTUtPmd0KTsKPiArCQkJaW50ZWxfZ3Rf
c2V0X3dlZGdlZChndCk7Cj4gICAJCQllcnIgPSAtRUlPOwo+ICAgCQkJZ290byBlcnJfY3R4X2xv
Owo+ICAgCQl9Cj4gICAKPiAgIAkJaWd0X3NwaW5uZXJfZW5kKCZzcGluX2hpKTsKPiAgIAkJaWd0
X3NwaW5uZXJfZW5kKCZzcGluX2xvKTsKPiAtCQlpZiAoaWd0X2ZsdXNoX3Rlc3QoaTkxNSkpIHsK
PiArCQlpZiAoaWd0X2ZsdXNoX3Rlc3QoZ3QtPmk5MTUpKSB7Cj4gICAJCQllcnIgPSAtRUlPOwo+
ICAgCQkJZ290byBlcnJfY3R4X2xvOwo+ICAgCQl9Cj4gQEAgLTE1NTcsNyArMTU1Niw3IEBAIHN0
YXRpYyBpbnQgcmFuZG9tX3ByaW9yaXR5KHN0cnVjdCBybmRfc3RhdGUgKnJuZCkKPiAgIH0KPiAg
IAo+ICAgc3RydWN0IHByZWVtcHRfc21va2Ugewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTU7Cj4gKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0Owo+ICAgCXN0cnVjdCBpOTE1X2dlbV9jb250
ZXh0ICoqY29udGV4dHM7Cj4gICAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwo+ICAg
CXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpiYXRjaDsKPiBAQCAtMTY1Nyw3ICsxNjU2LDcg
QEAgc3RhdGljIGludCBzbW9rZV9jcmVzY2VuZG8oc3RydWN0IHByZWVtcHRfc21va2UgKnNtb2tl
LCB1bnNpZ25lZCBpbnQgZmxhZ3MpCj4gICAJdW5zaWduZWQgbG9uZyBjb3VudDsKPiAgIAlpbnQg
ZXJyID0gMDsKPiAgIAo+IC0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgc21va2UtPmk5MTUsIGlk
KSB7Cj4gKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBzbW9rZS0+Z3QtPmk5MTUsIGlkKSB7Cgpe
Xl4KCj4gICAJCWFyZ1tpZF0gPSAqc21va2U7Cj4gICAJCWFyZ1tpZF0uZW5naW5lID0gZW5naW5l
Owo+ICAgCQlpZiAoIShmbGFncyAmIEJBVENIKSkKPiBAQCAtMTY3NCw3ICsxNjczLDcgQEAgc3Rh
dGljIGludCBzbW9rZV9jcmVzY2VuZG8oc3RydWN0IHByZWVtcHRfc21va2UgKnNtb2tlLCB1bnNp
Z25lZCBpbnQgZmxhZ3MpCj4gICAJfQo+ICAgCj4gICAJY291bnQgPSAwOwo+IC0JZm9yX2VhY2hf
ZW5naW5lKGVuZ2luZSwgc21va2UtPmk5MTUsIGlkKSB7Cj4gKwlmb3JfZWFjaF9lbmdpbmUoZW5n
aW5lLCBzbW9rZS0+Z3QtPmk5MTUsIGlkKSB7CgpeXl4KCj4gICAJCWludCBzdGF0dXM7Cj4gICAK
PiAgIAkJaWYgKElTX0VSUl9PUl9OVUxMKHRza1tpZF0pKQo+IEBAIC0xNjkxLDcgKzE2OTAsNyBA
QCBzdGF0aWMgaW50IHNtb2tlX2NyZXNjZW5kbyhzdHJ1Y3QgcHJlZW1wdF9zbW9rZSAqc21va2Us
IHVuc2lnbmVkIGludCBmbGFncykKPiAgIAo+ICAgCXByX2luZm8oIlN1Ym1pdHRlZCAlbHUgY3Jl
c2NlbmRvOiV4IHJlcXVlc3RzIGFjcm9zcyAlZCBlbmdpbmVzIGFuZCAlZCBjb250ZXh0c1xuIiwK
PiAgIAkJY291bnQsIGZsYWdzLAo+IC0JCVJVTlRJTUVfSU5GTyhzbW9rZS0+aTkxNSktPm51bV9l
bmdpbmVzLCBzbW9rZS0+bmNvbnRleHQpOwo+ICsJCVJVTlRJTUVfSU5GTyhzbW9rZS0+Z3QtPmk5
MTUpLT5udW1fZW5naW5lcywgc21va2UtPm5jb250ZXh0KTsKPiAgIAlyZXR1cm4gMDsKPiAgIH0K
PiAgIAo+IEBAIC0xNzAzLDcgKzE3MDIsNyBAQCBzdGF0aWMgaW50IHNtb2tlX3JhbmRvbShzdHJ1
Y3QgcHJlZW1wdF9zbW9rZSAqc21va2UsIHVuc2lnbmVkIGludCBmbGFncykKPiAgIAo+ICAgCWNv
dW50ID0gMDsKPiAgIAlkbyB7Cj4gLQkJZm9yX2VhY2hfZW5naW5lKHNtb2tlLT5lbmdpbmUsIHNt
b2tlLT5pOTE1LCBpZCkgewo+ICsJCWZvcl9lYWNoX2VuZ2luZShzbW9rZS0+ZW5naW5lLCBzbW9r
ZS0+Z3QtPmk5MTUsIGlkKSB7CgpeXl4KCj4gICAJCQlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAq
Y3R4ID0gc21va2VfY29udGV4dChzbW9rZSk7Cj4gICAJCQlpbnQgZXJyOwo+ICAgCj4gQEAgLTE3
MTksMTQgKzE3MTgsMTQgQEAgc3RhdGljIGludCBzbW9rZV9yYW5kb20oc3RydWN0IHByZWVtcHRf
c21va2UgKnNtb2tlLCB1bnNpZ25lZCBpbnQgZmxhZ3MpCj4gICAKPiAgIAlwcl9pbmZvKCJTdWJt
aXR0ZWQgJWx1IHJhbmRvbToleCByZXF1ZXN0cyBhY3Jvc3MgJWQgZW5naW5lcyBhbmQgJWQgY29u
dGV4dHNcbiIsCj4gICAJCWNvdW50LCBmbGFncywKPiAtCQlSVU5USU1FX0lORk8oc21va2UtPmk5
MTUpLT5udW1fZW5naW5lcywgc21va2UtPm5jb250ZXh0KTsKPiArCQlSVU5USU1FX0lORk8oc21v
a2UtPmd0LT5pOTE1KS0+bnVtX2VuZ2luZXMsIHNtb2tlLT5uY29udGV4dCk7Cj4gICAJcmV0dXJu
IDA7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQgbGl2ZV9wcmVlbXB0X3Ntb2tlKHZvaWQgKmFy
ZykKPiAgIHsKPiAgIAlzdHJ1Y3QgcHJlZW1wdF9zbW9rZSBzbW9rZSA9IHsKPiAtCQkuaTkxNSA9
IGFyZywKPiArCQkuZ3QgPSBhcmcsCj4gICAJCS5wcm5nID0gSTkxNV9STkRfU1RBVEVfSU5JVElB
TElaRVIoaTkxNV9zZWxmdGVzdC5yYW5kb21fc2VlZCksCj4gICAJCS5uY29udGV4dCA9IDEwMjQs
Cj4gICAJfTsKPiBAQCAtMTczNiw3ICsxNzM1LDcgQEAgc3RhdGljIGludCBsaXZlX3ByZWVtcHRf
c21va2Uodm9pZCAqYXJnKQo+ICAgCXUzMiAqY3M7Cj4gICAJaW50IG47Cj4gICAKPiAtCWlmICgh
SEFTX0xPR0lDQUxfUklOR19QUkVFTVBUSU9OKHNtb2tlLmk5MTUpKQo+ICsJaWYgKCFIQVNfTE9H
SUNBTF9SSU5HX1BSRUVNUFRJT04oc21va2UuZ3QtPmk5MTUpKQo+ICAgCQlyZXR1cm4gMDsKPiAg
IAo+ICAgCXNtb2tlLmNvbnRleHRzID0ga21hbGxvY19hcnJheShzbW9rZS5uY29udGV4dCwKPiBA
QCAtMTc0NSw3ICsxNzQ0LDggQEAgc3RhdGljIGludCBsaXZlX3ByZWVtcHRfc21va2Uodm9pZCAq
YXJnKQo+ICAgCWlmICghc21va2UuY29udGV4dHMpCj4gICAJCXJldHVybiAtRU5PTUVNOwo+ICAg
Cj4gLQlzbW9rZS5iYXRjaCA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfaW50ZXJuYWwoc21va2Uu
aTkxNSwgUEFHRV9TSVpFKTsKPiArCXNtb2tlLmJhdGNoID0KPiArCQlpOTE1X2dlbV9vYmplY3Rf
Y3JlYXRlX2ludGVybmFsKHNtb2tlLmd0LT5pOTE1LCBQQUdFX1NJWkUpOwo+ICAgCWlmIChJU19F
UlIoc21va2UuYmF0Y2gpKSB7Cj4gICAJCWVyciA9IFBUUl9FUlIoc21va2UuYmF0Y2gpOwo+ICAg
CQlnb3RvIGVycl9mcmVlOwo+IEBAIC0xNzYyLDEzICsxNzYyLDEzIEBAIHN0YXRpYyBpbnQgbGl2
ZV9wcmVlbXB0X3Ntb2tlKHZvaWQgKmFyZykKPiAgIAlpOTE1X2dlbV9vYmplY3RfZmx1c2hfbWFw
KHNtb2tlLmJhdGNoKTsKPiAgIAlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHNtb2tlLmJhdGNo
KTsKPiAgIAo+IC0JaWYgKGlndF9saXZlX3Rlc3RfYmVnaW4oJnQsIHNtb2tlLmk5MTUsIF9fZnVu
Y19fLCAiYWxsIikpIHsKPiArCWlmIChpZ3RfbGl2ZV90ZXN0X2JlZ2luKCZ0LCBzbW9rZS5ndC0+
aTkxNSwgX19mdW5jX18sICJhbGwiKSkgewo+ICAgCQllcnIgPSAtRUlPOwo+ICAgCQlnb3RvIGVy
cl9iYXRjaDsKPiAgIAl9Cj4gICAKPiAgIAlmb3IgKG4gPSAwOyBuIDwgc21va2UubmNvbnRleHQ7
IG4rKykgewo+IC0JCXNtb2tlLmNvbnRleHRzW25dID0ga2VybmVsX2NvbnRleHQoc21va2UuaTkx
NSk7Cj4gKwkJc21va2UuY29udGV4dHNbbl0gPSBrZXJuZWxfY29udGV4dChzbW9rZS5ndC0+aTkx
NSk7Cj4gICAJCWlmICghc21va2UuY29udGV4dHNbbl0pCj4gICAJCQlnb3RvIGVycl9jdHg7Cj4g
ICAJfQo+IEBAIC0xODAxLDcgKzE4MDEsNyBAQCBzdGF0aWMgaW50IGxpdmVfcHJlZW1wdF9zbW9r
ZSh2b2lkICphcmcpCj4gICAJcmV0dXJuIGVycjsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgaW50IG5v
cF92aXJ0dWFsX2VuZ2luZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiArc3RhdGlj
IGludCBub3BfdmlydHVhbF9lbmdpbmUoc3RydWN0IGludGVsX2d0ICpndCwKPiAgIAkJCSAgICAg
IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKipzaWJsaW5ncywKPiAgIAkJCSAgICAgIHVuc2lnbmVk
IGludCBuc2libGluZywKPiAgIAkJCSAgICAgIHVuc2lnbmVkIGludCBuY3R4LAo+IEBAIC0xODIw
LDcgKzE4MjAsNyBAQCBzdGF0aWMgaW50IG5vcF92aXJ0dWFsX2VuZ2luZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAlHRU1fQlVHX09OKCFuY3R4IHx8IG5jdHggPiBBUlJBWV9T
SVpFKGN0eCkpOwo+ICAgCj4gICAJZm9yIChuID0gMDsgbiA8IG5jdHg7IG4rKykgewo+IC0JCWN0
eFtuXSA9IGtlcm5lbF9jb250ZXh0KGk5MTUpOwo+ICsJCWN0eFtuXSA9IGtlcm5lbF9jb250ZXh0
KGd0LT5pOTE1KTsKPiAgIAkJaWYgKCFjdHhbbl0pIHsKPiAgIAkJCWVyciA9IC1FTk9NRU07Cj4g
ICAJCQluY3R4ID0gbjsKPiBAQCAtMTg0NSw3ICsxODQ1LDcgQEAgc3RhdGljIGludCBub3Bfdmly
dHVhbF9lbmdpbmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCX0KPiAgIAl9
Cj4gICAKPiAtCWVyciA9IGlndF9saXZlX3Rlc3RfYmVnaW4oJnQsIGk5MTUsIF9fZnVuY19fLCB2
ZVswXS0+ZW5naW5lLT5uYW1lKTsKPiArCWVyciA9IGlndF9saXZlX3Rlc3RfYmVnaW4oJnQsIGd0
LT5pOTE1LCBfX2Z1bmNfXywgdmVbMF0tPmVuZ2luZS0+bmFtZSk7Cj4gICAJaWYgKGVycikKPiAg
IAkJZ290byBvdXQ7Cj4gICAKPiBAQCAtMTg5Miw3ICsxODkyLDcgQEAgc3RhdGljIGludCBub3Bf
dmlydHVhbF9lbmdpbmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJCQkJCSAg
cmVxdWVzdFtuY10tPmZlbmNlLmNvbnRleHQsCj4gICAJCQkJCSAgcmVxdWVzdFtuY10tPmZlbmNl
LnNlcW5vKTsKPiAgIAkJCQlHRU1fVFJBQ0VfRFVNUCgpOwo+IC0JCQkJaW50ZWxfZ3Rfc2V0X3dl
ZGdlZCgmaTkxNS0+Z3QpOwo+ICsJCQkJaW50ZWxfZ3Rfc2V0X3dlZGdlZChndCk7Cj4gICAJCQkJ
YnJlYWs7Cj4gICAJCQl9Cj4gICAJCX0KPiBAQCAtMTkxNCw3ICsxOTE0LDcgQEAgc3RhdGljIGlu
dCBub3BfdmlydHVhbF9lbmdpbmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gICAJ
CXByaW1lLCBkaXY2NF91NjQoa3RpbWVfdG9fbnModGltZXNbMV0pLCBwcmltZSkpOwo+ICAgCj4g
ICBvdXQ6Cj4gLQlpZiAoaWd0X2ZsdXNoX3Rlc3QoaTkxNSkpCj4gKwlpZiAoaWd0X2ZsdXNoX3Rl
c3QoZ3QtPmk5MTUpKQo+ICAgCQllcnIgPSAtRUlPOwo+ICAgCj4gICAJZm9yIChuYyA9IDA7IG5j
IDwgbmN0eDsgbmMrKykgewo+IEBAIC0xOTI3LDE5ICsxOTI3LDE4IEBAIHN0YXRpYyBpbnQgbm9w
X3ZpcnR1YWxfZW5naW5lKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCj4gICBz
dGF0aWMgaW50IGxpdmVfdmlydHVhbF9lbmdpbmUodm9pZCAqYXJnKQo+ICAgewo+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBhcmc7Cj4gKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0g
YXJnOwo+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKnNpYmxpbmdzW01BWF9FTkdJTkVfSU5T
VEFOQ0UgKyAxXTsKPiAgIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4gLQlzdHJ1
Y3QgaW50ZWxfZ3QgKmd0ID0gJmk5MTUtPmd0Owo+ICAgCWVudW0gaW50ZWxfZW5naW5lX2lkIGlk
Owo+ICAgCXVuc2lnbmVkIGludCBjbGFzcywgaW5zdDsKPiAgIAlpbnQgZXJyOwo+ICAgCj4gLQlp
ZiAoVVNFU19HVUNfU1VCTUlTU0lPTihpOTE1KSkKPiArCWlmIChVU0VTX0dVQ19TVUJNSVNTSU9O
KGd0LT5pOTE1KSkKPiAgIAkJcmV0dXJuIDA7Cj4gICAKPiAtCWZvcl9lYWNoX2VuZ2luZShlbmdp
bmUsIGk5MTUsIGlkKSB7Cj4gLQkJZXJyID0gbm9wX3ZpcnR1YWxfZW5naW5lKGk5MTUsICZlbmdp
bmUsIDEsIDEsIDApOwo+ICsJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QtPmk5MTUsIGlkKSB7
CgpeXl4KCj4gKwkJZXJyID0gbm9wX3ZpcnR1YWxfZW5naW5lKGd0LCAmZW5naW5lLCAxLCAxLCAw
KTsKPiAgIAkJaWYgKGVycikgewo+ICAgCQkJcHJfZXJyKCJGYWlsZWQgdG8gd3JhcCBlbmdpbmUg
JXM6IGVycj0lZFxuIiwKPiAgIAkJCSAgICAgICBlbmdpbmUtPm5hbWUsIGVycik7Cj4gQEAgLTE5
NjEsMTMgKzE5NjAsMTMgQEAgc3RhdGljIGludCBsaXZlX3ZpcnR1YWxfZW5naW5lKHZvaWQgKmFy
ZykKPiAgIAkJCWNvbnRpbnVlOwo+ICAgCj4gICAJCWZvciAobiA9IDE7IG4gPD0gbnNpYmxpbmcg
KyAxOyBuKyspIHsKPiAtCQkJZXJyID0gbm9wX3ZpcnR1YWxfZW5naW5lKGk5MTUsIHNpYmxpbmdz
LCBuc2libGluZywKPiArCQkJZXJyID0gbm9wX3ZpcnR1YWxfZW5naW5lKGd0LCBzaWJsaW5ncywg
bnNpYmxpbmcsCj4gICAJCQkJCQkgbiwgMCk7Cj4gICAJCQlpZiAoZXJyKQo+ICAgCQkJCXJldHVy
biBlcnI7Cj4gICAJCX0KPiAgIAo+IC0JCWVyciA9IG5vcF92aXJ0dWFsX2VuZ2luZShpOTE1LCBz
aWJsaW5ncywgbnNpYmxpbmcsIG4sIENIQUlOKTsKPiArCQllcnIgPSBub3BfdmlydHVhbF9lbmdp
bmUoZ3QsIHNpYmxpbmdzLCBuc2libGluZywgbiwgQ0hBSU4pOwo+ICAgCQlpZiAoZXJyKQo+ICAg
CQkJcmV0dXJuIGVycjsKPiAgIAl9Cj4gQEAgLTE5NzUsNyArMTk3NCw3IEBAIHN0YXRpYyBpbnQg
bGl2ZV92aXJ0dWFsX2VuZ2luZSh2b2lkICphcmcpCj4gICAJcmV0dXJuIDA7Cj4gICB9Cj4gICAK
PiAtc3RhdGljIGludCBtYXNrX3ZpcnR1YWxfZW5naW5lKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAo+ICtzdGF0aWMgaW50IG1hc2tfdmlydHVhbF9lbmdpbmUoc3RydWN0IGludGVsX2d0
ICpndCwKPiAgIAkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICoqc2libGluZ3MsCj4g
ICAJCQkgICAgICAgdW5zaWduZWQgaW50IG5zaWJsaW5nKQo+ICAgewo+IEBAIC0xOTkxLDcgKzE5
OTAsNyBAQCBzdGF0aWMgaW50IG1hc2tfdmlydHVhbF9lbmdpbmUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gICAJICogcmVzdHJpY3QgaXQgdG8gb3VyIGRlc2lyZWQgZW5naW5lIHdp
dGhpbiB0aGUgdmlydHVhbCBlbmdpbmUuCj4gICAJICovCj4gICAKPiAtCWN0eCA9IGtlcm5lbF9j
b250ZXh0KGk5MTUpOwo+ICsJY3R4ID0ga2VybmVsX2NvbnRleHQoZ3QtPmk5MTUpOwo+ICAgCWlm
ICghY3R4KQo+ICAgCQlyZXR1cm4gLUVOT01FTTsKPiAgIAo+IEBAIC0yMDA1LDcgKzIwMDQsNyBA
QCBzdGF0aWMgaW50IG1hc2tfdmlydHVhbF9lbmdpbmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCj4gICAJaWYgKGVycikKPiAgIAkJZ290byBvdXRfcHV0Owo+ICAgCj4gLQllcnIgPSBp
Z3RfbGl2ZV90ZXN0X2JlZ2luKCZ0LCBpOTE1LCBfX2Z1bmNfXywgdmUtPmVuZ2luZS0+bmFtZSk7
Cj4gKwllcnIgPSBpZ3RfbGl2ZV90ZXN0X2JlZ2luKCZ0LCBndC0+aTkxNSwgX19mdW5jX18sIHZl
LT5lbmdpbmUtPm5hbWUpOwo+ICAgCWlmIChlcnIpCj4gICAJCWdvdG8gb3V0X3VucGluOwo+ICAg
Cj4gQEAgLTIwMzYsNyArMjAzNSw3IEBAIHN0YXRpYyBpbnQgbWFza192aXJ0dWFsX2VuZ2luZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAkJCQkgIHJlcXVlc3Rbbl0tPmZlbmNl
LmNvbnRleHQsCj4gICAJCQkJICByZXF1ZXN0W25dLT5mZW5jZS5zZXFubyk7Cj4gICAJCQlHRU1f
VFJBQ0VfRFVNUCgpOwo+IC0JCQlpbnRlbF9ndF9zZXRfd2VkZ2VkKCZpOTE1LT5ndCk7Cj4gKwkJ
CWludGVsX2d0X3NldF93ZWRnZWQoZ3QpOwo+ICAgCQkJZXJyID0gLUVJTzsKPiAgIAkJCWdvdG8g
b3V0Owo+ICAgCQl9Cj4gQEAgLTIwNTIsNyArMjA1MSw3IEBAIHN0YXRpYyBpbnQgbWFza192aXJ0
dWFsX2VuZ2luZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAo+ICAgCWVyciA9
IGlndF9saXZlX3Rlc3RfZW5kKCZ0KTsKPiAgIG91dDoKPiAtCWlmIChpZ3RfZmx1c2hfdGVzdChp
OTE1KSkKPiArCWlmIChpZ3RfZmx1c2hfdGVzdChndC0+aTkxNSkpCj4gICAJCWVyciA9IC1FSU87
Cj4gICAKPiAgIAlmb3IgKG4gPSAwOyBuIDwgbnNpYmxpbmc7IG4rKykKPiBAQCAtMjA2OSwxMyAr
MjA2OCwxMiBAQCBzdGF0aWMgaW50IG1hc2tfdmlydHVhbF9lbmdpbmUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gICAKPiAgIHN0YXRpYyBpbnQgbGl2ZV92aXJ0dWFsX21hc2sodm9p
ZCAqYXJnKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBhcmc7Cj4g
KwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOwo+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KnNpYmxpbmdzW01BWF9FTkdJTkVfSU5TVEFOQ0UgKyAxXTsKPiAtCXN0cnVjdCBpbnRlbF9ndCAq
Z3QgPSAmaTkxNS0+Z3Q7Cj4gICAJdW5zaWduZWQgaW50IGNsYXNzLCBpbnN0Owo+ICAgCWludCBl
cnI7Cj4gICAKPiAtCWlmIChVU0VTX0dVQ19TVUJNSVNTSU9OKGk5MTUpKQo+ICsJaWYgKFVTRVNf
R1VDX1NVQk1JU1NJT04oZ3QtPmk5MTUpKQo+ICAgCQlyZXR1cm4gMDsKPiAgIAo+ICAgCWZvciAo
Y2xhc3MgPSAwOyBjbGFzcyA8PSBNQVhfRU5HSU5FX0NMQVNTOyBjbGFzcysrKSB7Cj4gQEAgLTIw
OTEsNyArMjA4OSw3IEBAIHN0YXRpYyBpbnQgbGl2ZV92aXJ0dWFsX21hc2sodm9pZCAqYXJnKQo+
ICAgCQlpZiAobnNpYmxpbmcgPCAyKQo+ICAgCQkJY29udGludWU7Cj4gICAKPiAtCQllcnIgPSBt
YXNrX3ZpcnR1YWxfZW5naW5lKGk5MTUsIHNpYmxpbmdzLCBuc2libGluZyk7Cj4gKwkJZXJyID0g
bWFza192aXJ0dWFsX2VuZ2luZShndCwgc2libGluZ3MsIG5zaWJsaW5nKTsKPiAgIAkJaWYgKGVy
cikKPiAgIAkJCXJldHVybiBlcnI7Cj4gICAJfQo+IEBAIC0yMDk5LDcgKzIwOTcsNyBAQCBzdGF0
aWMgaW50IGxpdmVfdmlydHVhbF9tYXNrKHZvaWQgKmFyZykKPiAgIAlyZXR1cm4gMDsKPiAgIH0K
PiAgIAo+IC1zdGF0aWMgaW50IHByZXNlcnZlZF92aXJ0dWFsX2VuZ2luZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiArc3RhdGljIGludCBwcmVzZXJ2ZWRfdmlydHVhbF9lbmdpbmUo
c3RydWN0IGludGVsX2d0ICpndCwKPiAgIAkJCQkgICAgc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
KnNpYmxpbmdzLAo+ICAgCQkJCSAgICB1bnNpZ25lZCBpbnQgbnNpYmxpbmcpCj4gICB7Cj4gQEAg
LTIxMTIsNyArMjExMCw3IEBAIHN0YXRpYyBpbnQgcHJlc2VydmVkX3ZpcnR1YWxfZW5naW5lKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCWludCBlcnIgPSAwOwo+ICAgCXUzMiAq
Y3M7Cj4gICAKPiAtCWN0eCA9IGtlcm5lbF9jb250ZXh0KGk5MTUpOwo+ICsJY3R4ID0ga2VybmVs
X2NvbnRleHQoZ3QtPmk5MTUpOwo+ICAgCWlmICghY3R4KQo+ICAgCQlyZXR1cm4gLUVOT01FTTsK
PiAgIAo+IEBAIC0yMTMyLDcgKzIxMzAsNyBAQCBzdGF0aWMgaW50IHByZXNlcnZlZF92aXJ0dWFs
X2VuZ2luZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAlpZiAoZXJyKQo+ICAg
CQlnb3RvIG91dF9wdXQ7Cj4gICAKPiAtCWVyciA9IGlndF9saXZlX3Rlc3RfYmVnaW4oJnQsIGk5
MTUsIF9fZnVuY19fLCB2ZS0+ZW5naW5lLT5uYW1lKTsKPiArCWVyciA9IGlndF9saXZlX3Rlc3Rf
YmVnaW4oJnQsIGd0LT5pOTE1LCBfX2Z1bmNfXywgdmUtPmVuZ2luZS0+bmFtZSk7Cj4gICAJaWYg
KGVycikKPiAgIAkJZ290byBvdXRfdW5waW47Cj4gICAKPiBAQCAtMjIxMiw5ICsyMjEwLDggQEAg
c3RhdGljIGludCBwcmVzZXJ2ZWRfdmlydHVhbF9lbmdpbmUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gICAKPiAgIHN0YXRpYyBpbnQgbGl2ZV92aXJ0dWFsX3ByZXNlcnZlZCh2b2lk
ICphcmcpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGFyZzsKPiAr
CXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7Cj4gICAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
c2libGluZ3NbTUFYX0VOR0lORV9JTlNUQU5DRSArIDFdOwo+IC0Jc3RydWN0IGludGVsX2d0ICpn
dCA9ICZpOTE1LT5ndDsKPiAgIAl1bnNpZ25lZCBpbnQgY2xhc3MsIGluc3Q7Cj4gICAKPiAgIAkv
Kgo+IEBAIC0yMjIzLDExICsyMjIwLDExIEBAIHN0YXRpYyBpbnQgbGl2ZV92aXJ0dWFsX3ByZXNl
cnZlZCh2b2lkICphcmcpCj4gICAJICogYXJlIHByZXNlcnZlZC4KPiAgIAkgKi8KPiAgIAo+IC0J
aWYgKFVTRVNfR1VDX1NVQk1JU1NJT04oaTkxNSkpCj4gKwlpZiAoVVNFU19HVUNfU1VCTUlTU0lP
TihndC0+aTkxNSkpCj4gICAJCXJldHVybiAwOwo+ICAgCj4gICAJLyogQXMgd2UgdXNlIENTX0dQ
UiB3ZSBjYW5ub3QgcnVuIGJlZm9yZSB0aGV5IGV4aXN0ZWQgb24gYWxsIGVuZ2luZXMuICovCj4g
LQlpZiAoSU5URUxfR0VOKGk5MTUpIDwgOSkKPiArCWlmIChJTlRFTF9HRU4oZ3QtPmk5MTUpIDwg
OSkKPiAgIAkJcmV0dXJuIDA7Cj4gICAKPiAgIAlmb3IgKGNsYXNzID0gMDsgY2xhc3MgPD0gTUFY
X0VOR0lORV9DTEFTUzsgY2xhc3MrKykgewo+IEBAIC0yMjQzLDcgKzIyNDAsNyBAQCBzdGF0aWMg
aW50IGxpdmVfdmlydHVhbF9wcmVzZXJ2ZWQodm9pZCAqYXJnKQo+ICAgCQlpZiAobnNpYmxpbmcg
PCAyKQo+ICAgCQkJY29udGludWU7Cj4gICAKPiAtCQllcnIgPSBwcmVzZXJ2ZWRfdmlydHVhbF9l
bmdpbmUoaTkxNSwgc2libGluZ3MsIG5zaWJsaW5nKTsKPiArCQllcnIgPSBwcmVzZXJ2ZWRfdmly
dHVhbF9lbmdpbmUoZ3QsIHNpYmxpbmdzLCBuc2libGluZyk7Cj4gICAJCWlmIChlcnIpCj4gICAJ
CQlyZXR1cm4gZXJyOwo+ICAgCX0KPiBAQCAtMjI1MSw3ICsyMjQ4LDcgQEAgc3RhdGljIGludCBs
aXZlX3ZpcnR1YWxfcHJlc2VydmVkKHZvaWQgKmFyZykKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAg
IAo+IC1zdGF0aWMgaW50IGJvbmRfdmlydHVhbF9lbmdpbmUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gK3N0YXRpYyBpbnQgYm9uZF92aXJ0dWFsX2VuZ2luZShzdHJ1Y3QgaW50ZWxf
Z3QgKmd0LAo+ICAgCQkJICAgICAgIHVuc2lnbmVkIGludCBjbGFzcywKPiAgIAkJCSAgICAgICBz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICoqc2libGluZ3MsCj4gICAJCQkgICAgICAgdW5zaWduZWQg
aW50IG5zaWJsaW5nLAo+IEBAIC0yMjY3LDEzICsyMjY0LDEzIEBAIHN0YXRpYyBpbnQgYm9uZF92
aXJ0dWFsX2VuZ2luZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAo+ICAgCUdF
TV9CVUdfT04obnNpYmxpbmcgPj0gQVJSQVlfU0laRShycSkgLSAxKTsKPiAgIAo+IC0JY3R4ID0g
a2VybmVsX2NvbnRleHQoaTkxNSk7Cj4gKwljdHggPSBrZXJuZWxfY29udGV4dChndC0+aTkxNSk7
Cj4gICAJaWYgKCFjdHgpCj4gICAJCXJldHVybiAtRU5PTUVNOwo+ICAgCj4gICAJZXJyID0gMDsK
PiAgIAlycVswXSA9IEVSUl9QVFIoLUVOT01FTSk7Cj4gLQlmb3JfZWFjaF9lbmdpbmUobWFzdGVy
LCBpOTE1LCBpZCkgewo+ICsJZm9yX2VhY2hfZW5naW5lKG1hc3RlciwgZ3QtPmk5MTUsIGlkKSB7
CgpeXl4KCj4gICAJCXN0cnVjdCBpOTE1X3N3X2ZlbmNlIGZlbmNlID0ge307Cj4gICAKPiAgIAkJ
aWYgKG1hc3Rlci0+Y2xhc3MgPT0gY2xhc3MpCj4gQEAgLTIzNzgsNyArMjM3NSw3IEBAIHN0YXRp
YyBpbnQgYm9uZF92aXJ0dWFsX2VuZ2luZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
PiAgIG91dDoKPiAgIAlmb3IgKG4gPSAwOyAhSVNfRVJSKHJxW25dKTsgbisrKQo+ICAgCQlpOTE1
X3JlcXVlc3RfcHV0KHJxW25dKTsKPiAtCWlmIChpZ3RfZmx1c2hfdGVzdChpOTE1KSkKPiArCWlm
IChpZ3RfZmx1c2hfdGVzdChndC0+aTkxNSkpCj4gICAJCWVyciA9IC1FSU87Cj4gICAKPiAgIAlr
ZXJuZWxfY29udGV4dF9jbG9zZShjdHgpOwo+IEBAIC0yMzk1LDEzICsyMzkyLDEyIEBAIHN0YXRp
YyBpbnQgbGl2ZV92aXJ0dWFsX2JvbmQodm9pZCAqYXJnKQo+ICAgCQl7ICJzY2hlZHVsZSIsIEJP
TkRfU0NIRURVTEUgfSwKPiAgIAkJeyB9LAo+ICAgCX07Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IGFyZzsKPiArCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7Cj4gICAJc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqc2libGluZ3NbTUFYX0VOR0lORV9JTlNUQU5DRSArIDFdOwo+
IC0Jc3RydWN0IGludGVsX2d0ICpndCA9ICZpOTE1LT5ndDsKPiAgIAl1bnNpZ25lZCBpbnQgY2xh
c3MsIGluc3Q7Cj4gICAJaW50IGVycjsKPiAgIAo+IC0JaWYgKFVTRVNfR1VDX1NVQk1JU1NJT04o
aTkxNSkpCj4gKwlpZiAoVVNFU19HVUNfU1VCTUlTU0lPTihndC0+aTkxNSkpCj4gICAJCXJldHVy
biAwOwo+ICAgCj4gICAJZm9yIChjbGFzcyA9IDA7IGNsYXNzIDw9IE1BWF9FTkdJTkVfQ0xBU1M7
IGNsYXNzKyspIHsKPiBAQCAtMjQyMCw3ICsyNDE2LDcgQEAgc3RhdGljIGludCBsaXZlX3ZpcnR1
YWxfYm9uZCh2b2lkICphcmcpCj4gICAJCQljb250aW51ZTsKPiAgIAo+ICAgCQlmb3IgKHAgPSBw
aGFzZXM7IHAtPm5hbWU7IHArKykgewo+IC0JCQllcnIgPSBib25kX3ZpcnR1YWxfZW5naW5lKGk5
MTUsCj4gKwkJCWVyciA9IGJvbmRfdmlydHVhbF9lbmdpbmUoZ3QsCj4gICAJCQkJCQkgIGNsYXNz
LCBzaWJsaW5ncywgbnNpYmxpbmcsCj4gICAJCQkJCQkgIHAtPmZsYWdzKTsKPiAgIAkJCWlmIChl
cnIpIHsKPiBAQCAtMjQ2Miw3ICsyNDU4LDcgQEAgaW50IGludGVsX2V4ZWNsaXN0c19saXZlX3Nl
bGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIAlpZiAoaW50ZWxfZ3Rf
aXNfd2VkZ2VkKCZpOTE1LT5ndCkpCj4gICAJCXJldHVybiAwOwo+ICAgCj4gLQlyZXR1cm4gaTkx
NV9saXZlX3N1YnRlc3RzKHRlc3RzLCBpOTE1KTsKPiArCXJldHVybiBpbnRlbF9ndF9saXZlX3N1
YnRlc3RzKHRlc3RzLCAmaTkxNS0+Z3QpOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZCBoZXhk
dW1wKGNvbnN0IHZvaWQgKmJ1Ziwgc2l6ZV90IGxlbikKPiAKCk5vdCBzdXJlIGlmIG15IG1hcmtl
cnMgYXJlIGF0IGFsbCB1c2VmdWwsIGJ1dCBzYW1lIGNvbmRpdGlvbiBhcyBwcmV2aW91cyAKcGF0
Y2hlczoKClJldmlld2VkLWJ5OiBUdnJ0a28gVXJzdWxpbiA8dHZydGtvLnVyc3VsaW5AaW50ZWwu
Y29tPgoKUmVnYXJkcywKClR2cnRrbwpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVl
ZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5m
by9pbnRlbC1nZng=

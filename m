Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id EE08F3DAE86
	for <lists+intel-gfx@lfdr.de>; Thu, 29 Jul 2021 23:51:34 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D47D26EE7F;
	Thu, 29 Jul 2021 21:51:30 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga12.intel.com (mga12.intel.com [192.55.52.136])
 by gabe.freedesktop.org (Postfix) with ESMTPS id D31666EE7B
 for <intel-gfx@lists.freedesktop.org>; Thu, 29 Jul 2021 21:51:23 +0000 (UTC)
X-IronPort-AV: E=McAfee;i="6200,9189,10060"; a="192578348"
X-IronPort-AV: E=Sophos;i="5.84,279,1620716400"; d="scan'208";a="192578348"
Received: from fmsmga006.fm.intel.com ([10.253.24.20])
 by fmsmga106.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 29 Jul 2021 14:51:23 -0700
X-IronPort-AV: E=Sophos;i="5.84,279,1620716400"; d="scan'208";a="664570768"
Received: from josouza-mobl2.jf.intel.com (HELO josouza-mobl2.intel.com)
 ([10.24.14.59])
 by fmsmga006-auth.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 29 Jul 2021 14:51:23 -0700
From: =?UTF-8?q?Jos=C3=A9=20Roberto=20de=20Souza?= <jose.souza@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 29 Jul 2021 14:55:41 -0700
Message-Id: <20210729215545.192606-6-jose.souza@intel.com>
X-Mailer: git-send-email 2.32.0
In-Reply-To: <20210729215545.192606-1-jose.souza@intel.com>
References: <20210729215545.192606-1-jose.souza@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH CI 06/10] drm/i915/bios: Enable parse of two
 integrated panels PSR data
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Jani Nikula <jani.nikula@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Q29udGludWluZyB0aGUgY29udmVyc2lvbiBmcm9tIHNpbmdsZSBpbnRlZ3JhdGVkIFZCVCBkYXRh
IHRvIHR3bywgbm93CmhhbmRsaW5nIFBTUiBkYXRhLgoKUmV2aWV3ZWQtYnk6IE1hdHQgQXR3b29k
IDxtYXR0aGV3LnMuYXR3b29kQGludGVsLmNvbT4KQ2M6IFZpbGxlIFN5cmrDpGzDpCA8dmlsbGUu
c3lyamFsYUBsaW51eC5pbnRlbC5jb20+CkNjOiBKYW5pIE5pa3VsYSA8amFuaS5uaWt1bGFAaW50
ZWwuY29tPgpTaWduZWQtb2ZmLWJ5OiBKb3PDqSBSb2JlcnRvIGRlIFNvdXphIDxqb3NlLnNvdXph
QGludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Jpb3Mu
YyB8IDczICsrKysrKysrKysrKystLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2Jpb3MuaCB8ICAyICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfcHNyLmMgIHwgMzAgKysrKysrLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYu
aCAgICAgICAgICAgfCAzNCArKysrKy0tLS0tLQogNCBmaWxlcyBjaGFuZ2VkLCA3NyBpbnNlcnRp
b25zKCspLCA2MiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2Jpb3MuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfYmlvcy5jCmluZGV4IGRhYzgxYTVlYmRhYTAuLjQwZmE2MzMzNmNkOWQgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYmlvcy5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYmlvcy5jCkBAIC03MjksMTUgKzcyOSwxMiBAQCBw
YXJzZV9kcml2ZXJfZmVhdHVyZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCSAg
ICBkcml2ZXItPmx2ZHNfY29uZmlnICE9IEJEQl9EUklWRVJfRkVBVFVSRV9JTlRfU0RWT19MVkRT
KQogCQkJaTkxNS0+dmJ0LmludF9sdmRzX3N1cHBvcnQgPSAwOwogCX0KLQotCWlmIChiZGItPnZl
cnNpb24gPCAyMjgpCi0JCWk5MTUtPnZidC5wc3IuZW5hYmxlID0gZHJpdmVyLT5wc3JfZW5hYmxl
ZDsKIH0KIAogc3RhdGljIHZvaWQKLXBhcnNlX2RyaXZlcl9mZWF0dXJlc19kcnJzX29ubHkoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCi0JCQkJY29uc3Qgc3RydWN0IGJkYl9oZWFkZXIg
KmJkYiwKLQkJCQlzdHJ1Y3QgZGRpX3ZidF9wb3J0X2luZm8gKmluZm8pCitwYXJzZV9kcml2ZXJf
ZmVhdHVyZXNfZHJyc19wc3Jfb25seShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKKwkJ
CQkgICAgY29uc3Qgc3RydWN0IGJkYl9oZWFkZXIgKmJkYiwKKwkJCQkgICAgc3RydWN0IGRkaV92
YnRfcG9ydF9pbmZvICppbmZvKQogewogCWNvbnN0IHN0cnVjdCBiZGJfZHJpdmVyX2ZlYXR1cmVz
ICpkcml2ZXI7CiAKQEAgLTc1Nyw2ICs3NTQsOCBAQCBwYXJzZV9kcml2ZXJfZmVhdHVyZXNfZHJy
c19vbmx5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCSAqLwogCWlmICghZHJpdmVy
LT5kcnJzX2VuYWJsZWQpCiAJCWluZm8tPmRycnNfdHlwZSA9IERSUlNfTk9UX1NVUFBPUlRFRDsK
KworCWluZm8tPnBzci5lbmFibGUgPSBkcml2ZXItPnBzcl9lbmFibGVkOwogfQogCiBzdGF0aWMg
dm9pZApAQCAtNzc0LDcgKzc3Myw3IEBAIHBhcnNlX3Bvd2VyX2NvbnNlcnZhdGlvbl9mZWF0dXJl
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAlpZiAoIXBvd2VyKQogCQlyZXR1cm47
CiAKLQlpOTE1LT52YnQucHNyLmVuYWJsZSA9IHBvd2VyLT5wc3IgJiBCSVQocGFuZWxfaW5kZXgp
OworCWluZm8tPnBzci5lbmFibGUgPSBwb3dlci0+cHNyICYgQklUKHBhbmVsX2luZGV4KTsKIAog
CS8qCiAJICogSWYgRFJSUyBpcyBub3Qgc3VwcG9ydGVkLCBkcnJzX3R5cGUgaGFzIHRvIGJlIHNl
dCB0byAwLgpAQCAtOTA1LDExICs5MDQsMTEgQEAgcGFyc2VfZWRwKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LCBjb25zdCBzdHJ1Y3QgYmRiX2hlYWRlciAqYmRiLAogfQogCiBzdGF0aWMg
dm9pZAotcGFyc2VfcHNyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBjb25zdCBzdHJ1
Y3QgYmRiX2hlYWRlciAqYmRiKQorcGFyc2VfcHNyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LCBjb25zdCBzdHJ1Y3QgYmRiX2hlYWRlciAqYmRiLAorCSAgc3RydWN0IGRkaV92YnRfcG9y
dF9pbmZvICppbmZvLCBpbnQgcGFuZWxfaW5kZXgpCiB7CiAJY29uc3Qgc3RydWN0IGJkYl9wc3Ig
KnBzcjsKIAljb25zdCBzdHJ1Y3QgcHNyX3RhYmxlICpwc3JfdGFibGU7Ci0JaW50IHBhbmVsX3R5
cGUgPSBpOTE1LT52YnQucGFuZWxfdHlwZTsKIAogCXBzciA9IGZpbmRfc2VjdGlvbihiZGIsIEJE
Ql9QU1IpOwogCWlmICghcHNyKSB7CkBAIC05MTcsMjcgKzkxNiwyNyBAQCBwYXJzZV9wc3Ioc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGNvbnN0IHN0cnVjdCBiZGJfaGVhZGVyICpiZGIp
CiAJCXJldHVybjsKIAl9CiAKLQlwc3JfdGFibGUgPSAmcHNyLT5wc3JfdGFibGVbcGFuZWxfdHlw
ZV07CisJcHNyX3RhYmxlID0gJnBzci0+cHNyX3RhYmxlW3BhbmVsX2luZGV4XTsKIAotCWk5MTUt
PnZidC5wc3IuZnVsbF9saW5rID0gcHNyX3RhYmxlLT5mdWxsX2xpbms7Ci0JaTkxNS0+dmJ0LnBz
ci5yZXF1aXJlX2F1eF93YWtldXAgPSBwc3JfdGFibGUtPnJlcXVpcmVfYXV4X3RvX3dha2V1cDsK
KwlpbmZvLT5wc3IuZnVsbF9saW5rID0gcHNyX3RhYmxlLT5mdWxsX2xpbms7CisJaW5mby0+cHNy
LnJlcXVpcmVfYXV4X3dha2V1cCA9IHBzcl90YWJsZS0+cmVxdWlyZV9hdXhfdG9fd2FrZXVwOwog
CiAJLyogQWxsb3dlZCBWQlQgdmFsdWVzIGdvZXMgZnJvbSAwIHRvIDE1ICovCi0JaTkxNS0+dmJ0
LnBzci5pZGxlX2ZyYW1lcyA9IHBzcl90YWJsZS0+aWRsZV9mcmFtZXMgPCAwID8gMCA6CisJaW5m
by0+cHNyLmlkbGVfZnJhbWVzID0gcHNyX3RhYmxlLT5pZGxlX2ZyYW1lcyA8IDAgPyAwIDoKIAkJ
cHNyX3RhYmxlLT5pZGxlX2ZyYW1lcyA+IDE1ID8gMTUgOiBwc3JfdGFibGUtPmlkbGVfZnJhbWVz
OwogCiAJc3dpdGNoIChwc3JfdGFibGUtPmxpbmVzX3RvX3dhaXQpIHsKIAljYXNlIDA6Ci0JCWk5
MTUtPnZidC5wc3IubGluZXNfdG9fd2FpdCA9IFBTUl8wX0xJTkVTX1RPX1dBSVQ7CisJCWluZm8t
PnBzci5saW5lc190b193YWl0ID0gUFNSXzBfTElORVNfVE9fV0FJVDsKIAkJYnJlYWs7CiAJY2Fz
ZSAxOgotCQlpOTE1LT52YnQucHNyLmxpbmVzX3RvX3dhaXQgPSBQU1JfMV9MSU5FX1RPX1dBSVQ7
CisJCWluZm8tPnBzci5saW5lc190b193YWl0ID0gUFNSXzFfTElORV9UT19XQUlUOwogCQlicmVh
azsKIAljYXNlIDI6Ci0JCWk5MTUtPnZidC5wc3IubGluZXNfdG9fd2FpdCA9IFBTUl80X0xJTkVT
X1RPX1dBSVQ7CisJCWluZm8tPnBzci5saW5lc190b193YWl0ID0gUFNSXzRfTElORVNfVE9fV0FJ
VDsKIAkJYnJlYWs7CiAJY2FzZSAzOgotCQlpOTE1LT52YnQucHNyLmxpbmVzX3RvX3dhaXQgPSBQ
U1JfOF9MSU5FU19UT19XQUlUOworCQlpbmZvLT5wc3IubGluZXNfdG9fd2FpdCA9IFBTUl84X0xJ
TkVTX1RPX1dBSVQ7CiAJCWJyZWFrOwogCWRlZmF1bHQ6CiAJCWRybV9kYmdfa21zKCZpOTE1LT5k
cm0sCkBAIC05NTQsMTMgKzk1MywxMyBAQCBwYXJzZV9wc3Ioc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsIGNvbnN0IHN0cnVjdCBiZGJfaGVhZGVyICpiZGIpCiAJICAgIChESVNQTEFZX1ZF
UihpOTE1KSA+PSA5ICYmICFJU19CUk9YVE9OKGk5MTUpKSkgewogCQlzd2l0Y2ggKHBzcl90YWJs
ZS0+dHAxX3dha2V1cF90aW1lKSB7CiAJCWNhc2UgMDoKLQkJCWk5MTUtPnZidC5wc3IudHAxX3dh
a2V1cF90aW1lX3VzID0gNTAwOworCQkJaW5mby0+cHNyLnRwMV93YWtldXBfdGltZV91cyA9IDUw
MDsKIAkJCWJyZWFrOwogCQljYXNlIDE6Ci0JCQlpOTE1LT52YnQucHNyLnRwMV93YWtldXBfdGlt
ZV91cyA9IDEwMDsKKwkJCWluZm8tPnBzci50cDFfd2FrZXVwX3RpbWVfdXMgPSAxMDA7CiAJCQli
cmVhazsKIAkJY2FzZSAzOgotCQkJaTkxNS0+dmJ0LnBzci50cDFfd2FrZXVwX3RpbWVfdXMgPSAw
OworCQkJaW5mby0+cHNyLnRwMV93YWtldXBfdGltZV91cyA9IDA7CiAJCQlicmVhazsKIAkJZGVm
YXVsdDoKIAkJCWRybV9kYmdfa21zKCZpOTE1LT5kcm0sCkBAIC05NjgsMTkgKzk2NywxOSBAQCBw
YXJzZV9wc3Ioc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGNvbnN0IHN0cnVjdCBiZGJf
aGVhZGVyICpiZGIpCiAJCQkJICAgIHBzcl90YWJsZS0+dHAxX3dha2V1cF90aW1lKTsKIAkJCWZh
bGx0aHJvdWdoOwogCQljYXNlIDI6Ci0JCQlpOTE1LT52YnQucHNyLnRwMV93YWtldXBfdGltZV91
cyA9IDI1MDA7CisJCQlpbmZvLT5wc3IudHAxX3dha2V1cF90aW1lX3VzID0gMjUwMDsKIAkJCWJy
ZWFrOwogCQl9CiAKIAkJc3dpdGNoIChwc3JfdGFibGUtPnRwMl90cDNfd2FrZXVwX3RpbWUpIHsK
IAkJY2FzZSAwOgotCQkJaTkxNS0+dmJ0LnBzci50cDJfdHAzX3dha2V1cF90aW1lX3VzID0gNTAw
OworCQkJaW5mby0+cHNyLnRwMl90cDNfd2FrZXVwX3RpbWVfdXMgPSA1MDA7CiAJCQlicmVhazsK
IAkJY2FzZSAxOgotCQkJaTkxNS0+dmJ0LnBzci50cDJfdHAzX3dha2V1cF90aW1lX3VzID0gMTAw
OworCQkJaW5mby0+cHNyLnRwMl90cDNfd2FrZXVwX3RpbWVfdXMgPSAxMDA7CiAJCQlicmVhazsK
IAkJY2FzZSAzOgotCQkJaTkxNS0+dmJ0LnBzci50cDJfdHAzX3dha2V1cF90aW1lX3VzID0gMDsK
KwkJCWluZm8tPnBzci50cDJfdHAzX3dha2V1cF90aW1lX3VzID0gMDsKIAkJCWJyZWFrOwogCQlk
ZWZhdWx0OgogCQkJZHJtX2RiZ19rbXMoJmk5MTUtPmRybSwKQEAgLTk4OCwxOCArOTg3LDE4IEBA
IHBhcnNlX3BzcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgY29uc3Qgc3RydWN0IGJk
Yl9oZWFkZXIgKmJkYikKIAkJCQkgICAgcHNyX3RhYmxlLT50cDJfdHAzX3dha2V1cF90aW1lKTsK
IAkJCWZhbGx0aHJvdWdoOwogCQljYXNlIDI6Ci0JCQlpOTE1LT52YnQucHNyLnRwMl90cDNfd2Fr
ZXVwX3RpbWVfdXMgPSAyNTAwOworCQkJaW5mby0+cHNyLnRwMl90cDNfd2FrZXVwX3RpbWVfdXMg
PSAyNTAwOwogCQlicmVhazsKIAkJfQogCX0gZWxzZSB7Ci0JCWk5MTUtPnZidC5wc3IudHAxX3dh
a2V1cF90aW1lX3VzID0gcHNyX3RhYmxlLT50cDFfd2FrZXVwX3RpbWUgKiAxMDA7Ci0JCWk5MTUt
PnZidC5wc3IudHAyX3RwM193YWtldXBfdGltZV91cyA9IHBzcl90YWJsZS0+dHAyX3RwM193YWtl
dXBfdGltZSAqIDEwMDsKKwkJaW5mby0+cHNyLnRwMV93YWtldXBfdGltZV91cyA9IHBzcl90YWJs
ZS0+dHAxX3dha2V1cF90aW1lICogMTAwOworCQlpbmZvLT5wc3IudHAyX3RwM193YWtldXBfdGlt
ZV91cyA9IHBzcl90YWJsZS0+dHAyX3RwM193YWtldXBfdGltZSAqIDEwMDsKIAl9CiAKIAlpZiAo
YmRiLT52ZXJzaW9uID49IDIyNikgewogCQl1MzIgd2FrZXVwX3RpbWUgPSBwc3ItPnBzcjJfdHAy
X3RwM193YWtldXBfdGltZTsKIAotCQl3YWtldXBfdGltZSA9ICh3YWtldXBfdGltZSA+PiAoMiAq
IHBhbmVsX3R5cGUpKSAmIDB4MzsKKwkJd2FrZXVwX3RpbWUgPSAod2FrZXVwX3RpbWUgPj4gKDIg
KiBwYW5lbF9pbmRleCkpICYgMHgzOwogCQlzd2l0Y2ggKHdha2V1cF90aW1lKSB7CiAJCWNhc2Ug
MDoKIAkJCXdha2V1cF90aW1lID0gNTAwOwpAQCAtMTAxNSwxMCArMTAxNCwxMCBAQCBwYXJzZV9w
c3Ioc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGNvbnN0IHN0cnVjdCBiZGJfaGVhZGVy
ICpiZGIpCiAJCQl3YWtldXBfdGltZSA9IDI1MDA7CiAJCQlicmVhazsKIAkJfQotCQlpOTE1LT52
YnQucHNyLnBzcjJfdHAyX3RwM193YWtldXBfdGltZV91cyA9IHdha2V1cF90aW1lOworCQlpbmZv
LT5wc3IucHNyMl90cDJfdHAzX3dha2V1cF90aW1lX3VzID0gd2FrZXVwX3RpbWU7CiAJfSBlbHNl
IHsKIAkJLyogUmV1c2luZyBQU1IxIHdha2V1cCB0aW1lIGZvciBQU1IyIGluIG9sZGVyIFZCVHMg
Ki8KLQkJaTkxNS0+dmJ0LnBzci5wc3IyX3RwMl90cDNfd2FrZXVwX3RpbWVfdXMgPSBpOTE1LT52
YnQucHNyLnRwMl90cDNfd2FrZXVwX3RpbWVfdXM7CisJCWluZm8tPnBzci5wc3IyX3RwMl90cDNf
d2FrZXVwX3RpbWVfdXMgPSBpbmZvLT5wc3IudHAyX3RwM193YWtldXBfdGltZV91czsKIAl9CiB9
CiAKQEAgLTE5ODYsMTAgKzE5ODUsMTEgQEAgc3RhdGljIHZvaWQgcGFyc2VfaW50ZWdyYXRlZF9w
YW5lbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAogCXBhcnNlX3BhbmVsX29wdGlv
bnMoaTkxNSwgYmRiLCBpbmZvLCBwYW5lbF9pbmRleCk7CiAJcGFyc2VfcG93ZXJfY29uc2VydmF0
aW9uX2ZlYXR1cmVzKGk5MTUsIGJkYiwgaW5mbywgcGFuZWxfaW5kZXgpOwotCXBhcnNlX2RyaXZl
cl9mZWF0dXJlc19kcnJzX29ubHkoaTkxNSwgYmRiLCBpbmZvKTsKKwlwYXJzZV9kcml2ZXJfZmVh
dHVyZXNfZHJyc19wc3Jfb25seShpOTE1LCBiZGIsIGluZm8pOwogCXBhcnNlX3BhbmVsX2R0ZChp
OTE1LCBiZGIsIGluZm8sIHBhbmVsX2luZGV4KTsKIAlwYXJzZV9sZnBfYmFja2xpZ2h0KGk5MTUs
IGJkYiwgaW5mbywgcGFuZWxfaW5kZXgpOwogCXBhcnNlX2VkcChpOTE1LCBiZGIsIGluZm8sIHBh
bmVsX2luZGV4KTsKKwlwYXJzZV9wc3IoaTkxNSwgYmRiLCBpbmZvLCBwYW5lbF9pbmRleCk7CiB9
CiAKIHN0YXRpYyB2b2lkIHBhcnNlX2RkaV9wb3J0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LApAQCAtMjQ4Nyw3ICsyNDg3LDYgQEAgdm9pZCBpbnRlbF9iaW9zX2luaXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJcGFyc2VfcGFuZWxfdHlwZShpOTE1LCBiZGIpOwogCXBh
cnNlX3Nkdm9fcGFuZWxfZGF0YShpOTE1LCBiZGIpOwogCXBhcnNlX2RyaXZlcl9mZWF0dXJlcyhp
OTE1LCBiZGIpOwotCXBhcnNlX3BzcihpOTE1LCBiZGIpOwogCXBhcnNlX21pcGlfY29uZmlnKGk5
MTUsIGJkYik7CiAJcGFyc2VfbWlwaV9zZXF1ZW5jZShpOTE1LCBiZGIpOwogCkBAIC0zMTQxLDMg
KzMxNDAsMTMgQEAgaW50ZWxfYmlvc19lZHBfaW5mbyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlcikKIAogCXJldHVybiAmaTkxNS0+dmJ0LmRkaV9wb3J0X2luZm9bZW5jb2Rlci0+cG9ydF0u
ZWRwOwogfQorCitjb25zdCBzdHJ1Y3QgdmJ0X3Bzcl9pbmZvICoKK2ludGVsX2Jpb3NfcHNyX2lu
Zm8oc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOworCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3Bv
cnQgKmRpZ19wb3J0ID0gZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApOworCXN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyID0gJmRpZ19wb3J0LT5iYXNlOworCisJcmV0dXJuICZpOTE1LT52YnQu
ZGRpX3BvcnRfaW5mb1tlbmNvZGVyLT5wb3J0XS5wc3I7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Jpb3MuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfYmlvcy5oCmluZGV4IDhmZDliNTJmOTIxZjcuLmM3MDE4NzFkOWE3NGQg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYmlvcy5oCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYmlvcy5oCkBAIC0zNSw2ICsz
NSw3IEBACiBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKIHN0cnVjdCBpbnRlbF9iaW9zX2VuY29k
ZXJfZGF0YTsKIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlOworc3RydWN0IGludGVsX2RwOwogc3Ry
dWN0IGludGVsX2VuY29kZXI7CiBlbnVtIHBvcnQ7CiAKQEAgLTI3MCw1ICsyNzEsNiBAQCBlbnVt
IGRycnNfc3VwcG9ydF90eXBlIGludGVsX2Jpb3NfZHJyc190eXBlKHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyKTsKIGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICppbnRlbF9iaW9z
X2xmcF9sdmRzX2luZm8oc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpOwogY29uc3Qgc3Ry
dWN0IHZidF9iYWNrbGlnaHRfaW5mbyAqaW50ZWxfYmlvc19iYWNrbGlnaHRfaW5mbyhzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2Rlcik7CiBzdHJ1Y3QgdmJ0X2VkcF9pbmZvICppbnRlbF9iaW9z
X2VkcF9pbmZvKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKTsKK2NvbnN0IHN0cnVjdCB2
YnRfcHNyX2luZm8gKmludGVsX2Jpb3NfcHNyX2luZm8oc3RydWN0IGludGVsX2RwICppbnRlbF9k
cCk7CiAKICNlbmRpZiAvKiBfSU5URUxfQklPU19IXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9wc3IuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfcHNyLmMKaW5kZXggMWIwZGFmNjQ5ZTgyMy4uZDg2MTYxZjgyYWIwOCAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9wc3IuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Bzci5jCkBAIC00MjksNiArNDI5LDcg
QEAgc3RhdGljIHZvaWQgaW50ZWxfcHNyX2VuYWJsZV9zaW5rKHN0cnVjdCBpbnRlbF9kcCAqaW50
ZWxfZHApCiAKIHN0YXRpYyB1MzIgaW50ZWxfcHNyMV9nZXRfdHBfdGltZShzdHJ1Y3QgaW50ZWxf
ZHAgKmludGVsX2RwKQogeworCWNvbnN0IHN0cnVjdCB2YnRfcHNyX2luZm8gKnZidF9wc3JfaW5m
byA9IGludGVsX2Jpb3NfcHNyX2luZm8oaW50ZWxfZHApOwogCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwogCXUzMiB2YWwgPSAwOwogCkBA
IC00NDEsMjAgKzQ0MiwyMCBAQCBzdGF0aWMgdTMyIGludGVsX3BzcjFfZ2V0X3RwX3RpbWUoc3Ry
dWN0IGludGVsX2RwICppbnRlbF9kcCkKIAkJZ290byBjaGVja190cDNfc2VsOwogCX0KIAotCWlm
IChkZXZfcHJpdi0+dmJ0LnBzci50cDFfd2FrZXVwX3RpbWVfdXMgPT0gMCkKKwlpZiAodmJ0X3Bz
cl9pbmZvLT50cDFfd2FrZXVwX3RpbWVfdXMgPT0gMCkKIAkJdmFsIHw9IEVEUF9QU1JfVFAxX1RJ
TUVfMHVzOwotCWVsc2UgaWYgKGRldl9wcml2LT52YnQucHNyLnRwMV93YWtldXBfdGltZV91cyA8
PSAxMDApCisJZWxzZSBpZiAodmJ0X3Bzcl9pbmZvLT50cDFfd2FrZXVwX3RpbWVfdXMgPD0gMTAw
KQogCQl2YWwgfD0gRURQX1BTUl9UUDFfVElNRV8xMDB1czsKLQllbHNlIGlmIChkZXZfcHJpdi0+
dmJ0LnBzci50cDFfd2FrZXVwX3RpbWVfdXMgPD0gNTAwKQorCWVsc2UgaWYgKHZidF9wc3JfaW5m
by0+dHAxX3dha2V1cF90aW1lX3VzIDw9IDUwMCkKIAkJdmFsIHw9IEVEUF9QU1JfVFAxX1RJTUVf
NTAwdXM7CiAJZWxzZQogCQl2YWwgfD0gRURQX1BTUl9UUDFfVElNRV8yNTAwdXM7CiAKLQlpZiAo
ZGV2X3ByaXYtPnZidC5wc3IudHAyX3RwM193YWtldXBfdGltZV91cyA9PSAwKQorCWlmICh2YnRf
cHNyX2luZm8tPnRwMl90cDNfd2FrZXVwX3RpbWVfdXMgPT0gMCkKIAkJdmFsIHw9IEVEUF9QU1Jf
VFAyX1RQM19USU1FXzB1czsKLQllbHNlIGlmIChkZXZfcHJpdi0+dmJ0LnBzci50cDJfdHAzX3dh
a2V1cF90aW1lX3VzIDw9IDEwMCkKKwllbHNlIGlmICh2YnRfcHNyX2luZm8tPnRwMl90cDNfd2Fr
ZXVwX3RpbWVfdXMgPD0gMTAwKQogCQl2YWwgfD0gRURQX1BTUl9UUDJfVFAzX1RJTUVfMTAwdXM7
Ci0JZWxzZSBpZiAoZGV2X3ByaXYtPnZidC5wc3IudHAyX3RwM193YWtldXBfdGltZV91cyA8PSA1
MDApCisJZWxzZSBpZiAodmJ0X3Bzcl9pbmZvLT50cDJfdHAzX3dha2V1cF90aW1lX3VzIDw9IDUw
MCkKIAkJdmFsIHw9IEVEUF9QU1JfVFAyX1RQM19USU1FXzUwMHVzOwogCWVsc2UKIAkJdmFsIHw9
IEVEUF9QU1JfVFAyX1RQM19USU1FXzI1MDB1czsKQEAgLTQ3MSwxMyArNDcyLDE0IEBAIHN0YXRp
YyB1MzIgaW50ZWxfcHNyMV9nZXRfdHBfdGltZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQog
CiBzdGF0aWMgdTggcHNyX2NvbXB1dGVfaWRsZV9mcmFtZXMoc3RydWN0IGludGVsX2RwICppbnRl
bF9kcCkKIHsKKwljb25zdCBzdHJ1Y3QgdmJ0X3Bzcl9pbmZvICp2YnRfcHNyX2luZm8gPSBpbnRl
bF9iaW9zX3Bzcl9pbmZvKGludGVsX2RwKTsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKIAlpbnQgaWRsZV9mcmFtZXM7CiAKIAkvKiBM
ZXQncyB1c2UgNiBhcyB0aGUgbWluaW11bSB0byBjb3ZlciBhbGwga25vd24gY2FzZXMgaW5jbHVk
aW5nIHRoZQogCSAqIG9mZi1ieS1vbmUgaXNzdWUgdGhhdCBIVyBoYXMgaW4gc29tZSBjYXNlcy4K
IAkgKi8KLQlpZGxlX2ZyYW1lcyA9IG1heCg2LCBkZXZfcHJpdi0+dmJ0LnBzci5pZGxlX2ZyYW1l
cyk7CisJaWRsZV9mcmFtZXMgPSBtYXgoNiwgdmJ0X3Bzcl9pbmZvLT5pZGxlX2ZyYW1lcyk7CiAJ
aWRsZV9mcmFtZXMgPSBtYXgoaWRsZV9mcmFtZXMsIGludGVsX2RwLT5wc3Iuc2lua19zeW5jX2xh
dGVuY3kgKyAxKTsKIAogCWlmIChkcm1fV0FSTl9PTigmZGV2X3ByaXYtPmRybSwgaWRsZV9mcmFt
ZXMgPiAweGYpKQpAQCAtNTEzLDE4ICs1MTUsMTkgQEAgc3RhdGljIHZvaWQgaHN3X2FjdGl2YXRl
X3BzcjEoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKIAogc3RhdGljIHUzMiBpbnRlbF9wc3Iy
X2dldF90cF90aW1lKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCiB7CisJY29uc3Qgc3RydWN0
IHZidF9wc3JfaW5mbyAqdmJ0X3Bzcl9pbmZvID0gaW50ZWxfYmlvc19wc3JfaW5mbyhpbnRlbF9k
cCk7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRl
bF9kcCk7CiAJdTMyIHZhbCA9IDA7CiAKIAlpZiAoZGV2X3ByaXYtPnBhcmFtcy5wc3Jfc2FmZXN0
X3BhcmFtcykKIAkJcmV0dXJuIEVEUF9QU1IyX1RQMl9USU1FXzI1MDB1czsKIAotCWlmIChkZXZf
cHJpdi0+dmJ0LnBzci5wc3IyX3RwMl90cDNfd2FrZXVwX3RpbWVfdXMgPj0gMCAmJgotCSAgICBk
ZXZfcHJpdi0+dmJ0LnBzci5wc3IyX3RwMl90cDNfd2FrZXVwX3RpbWVfdXMgPD0gNTApCisJaWYg
KHZidF9wc3JfaW5mby0+cHNyMl90cDJfdHAzX3dha2V1cF90aW1lX3VzID49IDAgJiYKKwkgICAg
dmJ0X3Bzcl9pbmZvLT5wc3IyX3RwMl90cDNfd2FrZXVwX3RpbWVfdXMgPD0gNTApCiAJCXZhbCB8
PSBFRFBfUFNSMl9UUDJfVElNRV81MHVzOwotCWVsc2UgaWYgKGRldl9wcml2LT52YnQucHNyLnBz
cjJfdHAyX3RwM193YWtldXBfdGltZV91cyA8PSAxMDApCisJZWxzZSBpZiAodmJ0X3Bzcl9pbmZv
LT5wc3IyX3RwMl90cDNfd2FrZXVwX3RpbWVfdXMgPD0gMTAwKQogCQl2YWwgfD0gRURQX1BTUjJf
VFAyX1RJTUVfMTAwdXM7Ci0JZWxzZSBpZiAoZGV2X3ByaXYtPnZidC5wc3IucHNyMl90cDJfdHAz
X3dha2V1cF90aW1lX3VzIDw9IDUwMCkKKwllbHNlIGlmICh2YnRfcHNyX2luZm8tPnBzcjJfdHAy
X3RwM193YWtldXBfdGltZV91cyA8PSA1MDApCiAJCXZhbCB8PSBFRFBfUFNSMl9UUDJfVElNRV81
MDB1czsKIAllbHNlCiAJCXZhbCB8PSBFRFBfUFNSMl9UUDJfVElNRV8yNTAwdXM7CkBAIC0yMTYz
LDYgKzIxNjYsNyBAQCB2b2lkIGludGVsX3Bzcl9mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCiAgKi8KIHZvaWQgaW50ZWxfcHNyX2luaXQoc3RydWN0IGludGVsX2RwICpp
bnRlbF9kcCkKIHsKKwljb25zdCBzdHJ1Y3QgdmJ0X3Bzcl9pbmZvICp2YnRfcHNyX2luZm8gPSBp
bnRlbF9iaW9zX3Bzcl9pbmZvKGludGVsX2RwKTsKIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0
ICpkaWdfcG9ydCA9IGRwX3RvX2RpZ19wb3J0KGludGVsX2RwKTsKIAlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKIApAQCAtMjE5NSw3ICsy
MTk5LDcgQEAgdm9pZCBpbnRlbF9wc3JfaW5pdChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQog
CQlkZXZfcHJpdi0+aHN3X3Bzcl9tbWlvX2FkanVzdCA9IF9TUkRfQ1RMX0VEUCAtIF9IU1dfRURQ
X1BTUl9CQVNFOwogCiAJaWYgKGRldl9wcml2LT5wYXJhbXMuZW5hYmxlX3BzciA9PSAtMSkKLQkJ
aWYgKERJU1BMQVlfVkVSKGRldl9wcml2KSA8IDkgfHwgIWRldl9wcml2LT52YnQucHNyLmVuYWJs
ZSkKKwkJaWYgKERJU1BMQVlfVkVSKGRldl9wcml2KSA8IDkgfHwgIXZidF9wc3JfaW5mby0+ZW5h
YmxlKQogCQkJZGV2X3ByaXYtPnBhcmFtcy5lbmFibGVfcHNyID0gMDsKIAogCS8qIFNldCBsaW5r
X3N0YW5kYnkgeCBsaW5rX29mZiBkZWZhdWx0cyAqLwpAQCAtMjIwNCw3ICsyMjA4LDcgQEAgdm9p
ZCBpbnRlbF9wc3JfaW5pdChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQogCQlpbnRlbF9kcC0+
cHNyLmxpbmtfc3RhbmRieSA9IGZhbHNlOwogCWVsc2UgaWYgKERJU1BMQVlfVkVSKGRldl9wcml2
KSA8IDEyKQogCQkvKiBGb3IgbmV3IHBsYXRmb3JtcyB1cCB0byBUR0wgbGV0J3MgcmVzcGVjdCBW
QlQgYmFjayBhZ2FpbiAqLwotCQlpbnRlbF9kcC0+cHNyLmxpbmtfc3RhbmRieSA9IGRldl9wcml2
LT52YnQucHNyLmZ1bGxfbGluazsKKwkJaW50ZWxfZHAtPnBzci5saW5rX3N0YW5kYnkgPSB2YnRf
cHNyX2luZm8tPmZ1bGxfbGluazsKIAogCUlOSVRfV09SSygmaW50ZWxfZHAtPnBzci53b3JrLCBp
bnRlbF9wc3Jfd29yayk7CiAJSU5JVF9ERUxBWUVEX1dPUksoJmludGVsX2RwLT5wc3IuZGMzY29f
d29yaywgdGdsX2RjM2NvX2Rpc2FibGVfd29yayk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2Rydi5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAppbmRl
eCA1Yjg0ZjIxMjljMmJmLi4yZGI2YzQ0NjFiMzllIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2Rydi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgK
QEAgLTYzNiw2ICs2MzYsMTMgQEAgaTkxNV9mZW5jZV90aW1lb3V0KGNvbnN0IHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQogLyogQW1vdW50IG9mIFBTRiBHViBwb2ludHMsIEJTcGVjIHBy
ZWNpc2VseSBkZWZpbmVzIHRoaXMgKi8KICNkZWZpbmUgSTkxNV9OVU1fUFNGX0dWX1BPSU5UUyAz
CiAKK2VudW0gcHNyX2xpbmVzX3RvX3dhaXQgeworCVBTUl8wX0xJTkVTX1RPX1dBSVQgPSAwLAor
CVBTUl8xX0xJTkVfVE9fV0FJVCwKKwlQU1JfNF9MSU5FU19UT19XQUlULAorCVBTUl84X0xJTkVT
X1RPX1dBSVQKK307CisKIHN0cnVjdCBkZGlfdmJ0X3BvcnRfaW5mbyB7CiAJLyogTm9uLU5VTEwg
aWYgcG9ydCBwcmVzZW50LiAqLwogCXN0cnVjdCBpbnRlbF9iaW9zX2VuY29kZXJfZGF0YSAqZGV2
ZGF0YTsKQEAgLTY3NSwxMyArNjgyLDE3IEBAIHN0cnVjdCBkZGlfdmJ0X3BvcnRfaW5mbyB7CiAJ
CXN0cnVjdCBlZHBfcG93ZXJfc2VxIHBwczsKIAkJYm9vbCBob2JsOwogCX0gZWRwOwotfTsKIAot
ZW51bSBwc3JfbGluZXNfdG9fd2FpdCB7Ci0JUFNSXzBfTElORVNfVE9fV0FJVCA9IDAsCi0JUFNS
XzFfTElORV9UT19XQUlULAotCVBTUl80X0xJTkVTX1RPX1dBSVQsCi0JUFNSXzhfTElORVNfVE9f
V0FJVAorCXN0cnVjdCB2YnRfcHNyX2luZm8geworCQlib29sIGVuYWJsZTsKKwkJYm9vbCBmdWxs
X2xpbms7CisJCWJvb2wgcmVxdWlyZV9hdXhfd2FrZXVwOworCQlpbnQgaWRsZV9mcmFtZXM7CisJ
CWVudW0gcHNyX2xpbmVzX3RvX3dhaXQgbGluZXNfdG9fd2FpdDsKKwkJaW50IHRwMV93YWtldXBf
dGltZV91czsKKwkJaW50IHRwMl90cDNfd2FrZXVwX3RpbWVfdXM7CisJCWludCBwc3IyX3RwMl90
cDNfd2FrZXVwX3RpbWVfdXM7CisJfSBwc3I7CiB9OwogCiBzdHJ1Y3QgaW50ZWxfdmJ0X2RhdGEg
ewpAQCAtNzAyLDE3ICs3MTMsNiBAQCBzdHJ1Y3QgaW50ZWxfdmJ0X2RhdGEgewogCXVuc2lnbmVk
IGludCBiaW9zX2x2ZHNfdmFsOyAvKiBpbml0aWFsIFtQQ0hfXUxWRFMgcmVnIHZhbCBpbiBWQklP
UyAqLwogCWVudW0gZHJtX3BhbmVsX29yaWVudGF0aW9uIG9yaWVudGF0aW9uOwogCi0Jc3RydWN0
IHsKLQkJYm9vbCBlbmFibGU7Ci0JCWJvb2wgZnVsbF9saW5rOwotCQlib29sIHJlcXVpcmVfYXV4
X3dha2V1cDsKLQkJaW50IGlkbGVfZnJhbWVzOwotCQllbnVtIHBzcl9saW5lc190b193YWl0IGxp
bmVzX3RvX3dhaXQ7Ci0JCWludCB0cDFfd2FrZXVwX3RpbWVfdXM7Ci0JCWludCB0cDJfdHAzX3dh
a2V1cF90aW1lX3VzOwotCQlpbnQgcHNyMl90cDJfdHAzX3dha2V1cF90aW1lX3VzOwotCX0gcHNy
OwotCiAJLyogTUlQSSBEU0kgKi8KIAlzdHJ1Y3QgewogCQl1MTYgcGFuZWxfaWQ7Ci0tIAoyLjMy
LjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVs
LWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczov
L2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeAo=

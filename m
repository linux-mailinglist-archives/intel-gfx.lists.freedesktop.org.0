Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 155071A17A2
	for <lists+intel-gfx@lfdr.de>; Wed,  8 Apr 2020 00:01:48 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 304576E912;
	Tue,  7 Apr 2020 22:01:45 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
X-Greylist: delayed 984 seconds by postgrey-1.36 at gabe;
 Tue, 07 Apr 2020 22:01:43 UTC
Received: from 5.mo69.mail-out.ovh.net (5.mo69.mail-out.ovh.net
 [46.105.43.105])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1804C6E911
 for <intel-gfx@lists.freedesktop.org>; Tue,  7 Apr 2020 22:01:43 +0000 (UTC)
Received: from player774.ha.ovh.net (unknown [10.108.42.75])
 by mo69.mail-out.ovh.net (Postfix) with ESMTP id BDD6D89DE2
 for <intel-gfx@lists.freedesktop.org>; Tue,  7 Apr 2020 23:44:03 +0200 (CEST)
Received: from etezian.org (213-243-141-64.bb.dnainternet.fi [213.243.141.64])
 (Authenticated sender: andi@etezian.org)
 by player774.ha.ovh.net (Postfix) with ESMTPSA id 54AF51148744B;
 Tue,  7 Apr 2020 21:43:57 +0000 (UTC)
From: Andi Shyti <andi@etezian.org>
To: Intel GFX <intel-gfx@lists.freedesktop.org>
Date: Wed,  8 Apr 2020 00:43:50 +0300
Message-Id: <20200407214350.217495-1-andi@etezian.org>
X-Mailer: git-send-email 2.26.0
MIME-Version: 1.0
X-Ovh-Tracer-Id: 17591904571477901917
X-VR-SPAMSTATE: OK
X-VR-SPAMSCORE: -100
X-VR-SPAMCAUSE: gggruggvucftvghtrhhoucdtuddrgeduhedrudehgdduheehucetufdoteggodetrfdotffvucfrrhhofhhilhgvmecuqfggjfdpvefjgfevmfevgfenuceurghilhhouhhtmecuhedttdenucesvcftvggtihhpihgvnhhtshculddquddttddmnecujfgurhephffvufffkffogggtgfesthekredtredtjeenucfhrhhomheptehnughiucfuhhihthhiuceorghnughisegvthgviihirghnrdhorhhgqeenucfkpheptddrtddrtddrtddpvddufedrvdegfedrudeguddrieegnecuvehluhhsthgvrhfuihiivgeptdenucfrrghrrghmpehmohguvgepshhmthhpqdhouhhtpdhhvghlohepphhlrgihvghrjeejgedrhhgrrdhovhhhrdhnvghtpdhinhgvtheptddrtddrtddrtddpmhgrihhlfhhrohhmpegrnhguihesvghtvgiiihgrnhdrohhrghdprhgtphhtthhopehinhhtvghlqdhgfhigsehlihhsthhsrdhfrhgvvgguvghskhhtohhprdhorhhg
Subject: [Intel-gfx] [PATCH v6] drm/i915/gt: move remaining debugfs
 interfaces into gt
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Lucas De Marchi <lucas.demarchi@intel.com>,
 Chris Wilson <chris@chris-wilson.co.uk>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogQW5kaSBTaHl0aSA8YW5kaS5zaHl0aUBpbnRlbC5jb20+CgpUaGUgZm9sbG93aW5nIGlu
dGVyZmFjZXM6CgogIGk5MTVfd2VkZ2VkCiAgaTkxNV9mb3JjZXdha2VfdXNlcgogIGk5MTVfZ2Vt
X2ludGVycnVwdAogIGk5MTVfcmNzX3RvcG9sb2d5CiAgaTkxNV9zc2V1X3N0YXR1cwoKYXJlIGRl
cGVuZGVudCBvbiBndCB2YWx1ZXMuIFB1dCB0aGVtIGluc2lkZSBndC8gYW5kIGRyb3AgdGhlCiJp
OTE1XyIgcHJlZml4IG5hbWUuIFRoaXMgd291bGQgYmUgdGhlIG5ldyBzdHJ1Y3R1cmU6CgogIGRy
aS8wL2d0CiAgfAogICstLSBmb3JjZXdha2VfdXNlcgogIHwKICArLS0gaW50ZXJydXB0X2luZm8K
ICB8CiAgKy0tIHJlc2V0CiAgfAogICstLSByY3NfdG9wb2xvZ3kKICB8CiAgXC0tIHNzZXVfc3Rh
dHVzCgpGb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkgd2l0aCBleGlzdGluZyBpZ3QgKGFuZCB0
aGUgc2xpZ2h0CnNlbWFudGljIGRpZmZlcmVuY2UgYmV0d2VlbiBvcGVyYXRpbmcgb24gdGhlIGk5
MTUgYWJpIGVudHJ5CnBvaW50cyBhbmQgdGhlIGRlZXAgZ3QgaW5mbyk6CgogIGRyaS8wCiAgfAog
ICstLSBpOTE1X3dlZGdlZAogIHwKICBcLS0gaTkxNV9mb3JjZXdha2VfdXNlcgoKcmVtYWluIGF0
IHRoZSB0b3AgbGV2ZWwuCgpTaWduZWQtb2ZmLWJ5OiBBbmRpIFNoeXRpIDxhbmRpLnNoeXRpQGlu
dGVsLmNvbT4KUmV2aWV3ZWQtYnk6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBpbnRl
bC5jb20+ClJldmlld2VkLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51
az4KLS0tCkhpLAoKdGhpcyBwYXRjaCBpcyB0aGUgZmlyc3Qgb2YgYSBzZXJpZXMgdGhhdCBhaW1z
IHRvIHJlZmFjdG9yIHRoZQpkZWJ1Z2ZzIHN0cnVjdHVyZSBpbiB0aGUgaTkxNS4gU29tZSBjaGFu
Z2VzIHdpbGwgYWZmZWN0IHRoZQpkZWJ1Z2ZzIGZyYW1ld29yayBhcyB3ZWxsLgoKSXQgaGFzIGdv
bmUgdGhyb3VnaCBhIHNlcmllcyBvZiBvZmZsaW5lIHJldmlld3MgbWFpbmx5IGZyb20KVHZydGtv
LiBFdmVuIHRob3VnaCBpdCBoYXNuJ3QgYmVlbiBkb25lIHB1YmxpY2x5LCBJIHRvb2sgdGhlCmZy
ZWVkb20gdG8gYWRkIFR2cnRrbydzIHJldmlldy4KClRoYW5rcyBUdnJ0a28gYW5kIENocmlzIGZv
ciB0aGUgcmV2aWV3LApBbmRpCgpDaGFuZ2Vsb2cKPT09PT09PT09CnY2OgogLSBpOTE1X2ZvcmNl
d2FrZV91c2VyIGxlZnQgaW50YWN0IGluIGluIHRoZSB0b3AgbGV2ZWwgZGlyZWN0b3J5CiAtIGlt
cHJvdmVkIGNvbW1pdCBsb2cKdjU6CiAtIHJlbmFtZWQgZnJvbSBkZWJ1Z2ZzX2d0X3NzZXUuW2No
XSB0byBkZWJ1Z2ZzX3NzZXUuW2NoXQogLSBtb3ZlZCBpOTE1X3Jjc190b3BvbG9neSBmcm9tIGk5
MTVfZGVidWdmcy5jIHRvCiAgIGd0L2RlYnVnZnNfc3NldS5jCiAtIGFkZGVkIFR2cnRrbydzIGFu
ZCBDaHJpcyByLWIuCnY0OgogLSBpbnRlcnJ1cHQgYW5kIHNzZXUgZGVidWdmcyBpbnRlcmZhY2Ug
YXJlIG1vdmVkIHRvIHRoZWlyIG93bgogICAiZGVidWdmc19ndF9pcnEiIGFuZCAiZGVidWdmc19n
dF9zc2V1IiBmaWxlcwogLSByZXNldCBmdW5jdGlvbnMgYXJlIHJlbmFtZWQgdG8gcmVzZXRfc2hv
dy9zdG9yZQp2MzoKIC0gYmV0dGVyIGFycmFuZ2VtZW50IG9mIHdoYXQgc2hvdWxkIHN0YXkgaW4g
aTkxNV9kZWJ1Z2ZzIGFuZAogICB3aGF0IG5lZWRzIHRvIGJlIG1vdmVkIHVuZGVyIGd0LwogLSBt
b3JlIHVzZSBvZiB0aGUgbG9jYWwgInVuY29yZSIgYW5kICJpOTE1IiB2YXJpYWJsZXMgdG8gaW1w
cm92ZQogICByZWFkYWJpbGl0eQp2MjoKIC0gZHJvcHBlZCBjaGFuZ2VzIG9uICJkcm9wX2NhY2hl
cyIsIHRoZXkgd2VyZSBpbmRlZWQgaXJyZWxldmFudAogLSBpbXByb3ZlZCBpbnRlcnJ1cHQgaW5m
byBmdW5jdGlvbgoKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlICAgICAgICAgICAgfCAg
IDIgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19ndC5jICAgICB8ICA1MCArKyst
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX2d0X2lycS5jIHwgMTYyICsrKysrKysr
KysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX2d0X2lycS5oIHwgIDE1ICsKIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2RlYnVnZnNfZ3RfcG0uYyAgfCAgMzIgKysrCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX3NzZXUuYyAgIHwgMjk0ICsrKysrKysrKysrKysrKysr
KysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2RlYnVnZnNfc3NldS5oICAgfCAgMTYgKysKIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jICAgICAgfCAzNTAgKy0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0KIDggZmlsZXMgY2hhbmdlZCwgNTcxIGluc2VydGlvbnMoKyksIDM1MCBkZWxl
dGlvbnMoLSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1
Z2ZzX2d0X2lycS5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
ZGVidWdmc19ndF9pcnEuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2RlYnVnZnNfc3NldS5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvZGVidWdmc19zc2V1LmgKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9N
YWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCmluZGV4IDJmY2U4YjAwNDBm
MzkuLjUxOTI5ZDY2NDhlMmMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2Vm
aWxlCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCkBAIC03OSw2ICs3OSw4IEBA
IGd0LXkgKz0gXAogCWd0L2RlYnVnZnNfZW5naW5lcy5vIFwKIAlndC9kZWJ1Z2ZzX2d0Lm8gXAog
CWd0L2RlYnVnZnNfZ3RfcG0ubyBcCisJZ3QvZGVidWdmc19ndF9pcnEubyBcCisJZ3QvZGVidWdm
c19zc2V1Lm8gXAogCWd0L2dlbjZfcHBndHQubyBcCiAJZ3QvZ2VuN19yZW5kZXJjbGVhci5vIFwK
IAlndC9nZW44X3BwZ3R0Lm8gXApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
ZGVidWdmc19ndC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19ndC5jCmluZGV4
IDFkZTVmYmFhMWNmOWMuLjUwN2ZlNWRjYjM2MGUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2RlYnVnZnNfZ3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1
Z2ZzX2d0LmMKQEAgLTgsOSArOCw1MyBAQAogCiAjaW5jbHVkZSAiZGVidWdmc19lbmdpbmVzLmgi
CiAjaW5jbHVkZSAiZGVidWdmc19ndC5oIgorI2luY2x1ZGUgImRlYnVnZnNfZ3RfaXJxLmgiCiAj
aW5jbHVkZSAiZGVidWdmc19ndF9wbS5oIgotI2luY2x1ZGUgInVjL2ludGVsX3VjX2RlYnVnZnMu
aCIKKyNpbmNsdWRlICJkZWJ1Z2ZzX3NzZXUuaCIKICNpbmNsdWRlICJpOTE1X2Rydi5oIgorI2lu
Y2x1ZGUgImludGVsX2d0X3BtLmgiCisjaW5jbHVkZSAiaW50ZWxfZ3RfcmVxdWVzdHMuaCIKKyNp
bmNsdWRlICJ1Yy9pbnRlbF91Y19kZWJ1Z2ZzLmgiCisKK3N0YXRpYyBpbnQgcmVzZXRfc2hvdyh2
b2lkICpkYXRhLCB1NjQgKnZhbCkKK3sKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gZGF0YTsKKwlp
bnQgcmV0ID0gaW50ZWxfZ3RfdGVybWluYWxseV93ZWRnZWQoZ3QpOworCisJc3dpdGNoIChyZXQp
IHsKKwljYXNlIC1FSU86CisJCSp2YWwgPSAxOworCQlyZXR1cm4gMDsKKwljYXNlIDA6CisJCSp2
YWwgPSAwOworCQlyZXR1cm4gMDsKKwlkZWZhdWx0OgorCQlyZXR1cm4gcmV0OworCX0KK30KKwor
c3RhdGljIGludCByZXNldF9zdG9yZSh2b2lkICpkYXRhLCB1NjQgdmFsKQoreworCXN0cnVjdCBp
bnRlbF9ndCAqZ3QgPSBkYXRhOworCisJLyogRmx1c2ggYW55IHByZXZpb3VzIHJlc2V0IGJlZm9y
ZSBhcHBseWluZyBmb3IgYSBuZXcgb25lICovCisJd2FpdF9ldmVudChndC0+cmVzZXQucXVldWUs
CisJCSAgICF0ZXN0X2JpdChJOTE1X1JFU0VUX0JBQ0tPRkYsICZndC0+cmVzZXQuZmxhZ3MpKTsK
KworCWludGVsX2d0X2hhbmRsZV9lcnJvcihndCwgdmFsLCBJOTE1X0VSUk9SX0NBUFRVUkUsCisJ
CQkgICAgICAiTWFudWFsbHkgcmVzZXQgZW5naW5lIG1hc2sgdG8gJWxseCIsIHZhbCk7CisJcmV0
dXJuIDA7Cit9CitERUZJTkVfU0lNUExFX0FUVFJJQlVURShyZXNldF9mb3BzLCByZXNldF9zaG93
LCByZXNldF9zdG9yZSwgIiVsbHVcbiIpOworCitzdGF0aWMgdm9pZCBfX2RlYnVnZnNfZ3RfcmVn
aXN0ZXIoc3RydWN0IGludGVsX2d0ICpndCwgc3RydWN0IGRlbnRyeSAqcm9vdCkKK3sKKwlzdGF0
aWMgY29uc3Qgc3RydWN0IGRlYnVnZnNfZ3RfZmlsZSBmaWxlc1tdID0geworCQl7ICJyZXNldCIs
ICZyZXNldF9mb3BzLCBOVUxMIH0sCisJfTsKKworCWludGVsX2d0X2RlYnVnZnNfcmVnaXN0ZXJf
ZmlsZXMocm9vdCwgZmlsZXMsIEFSUkFZX1NJWkUoZmlsZXMpLCBndCk7Cit9CiAKIHZvaWQgZGVi
dWdmc19ndF9yZWdpc3RlcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewpAQCAtMjMsOCArNjcsMTIg
QEAgdm9pZCBkZWJ1Z2ZzX2d0X3JlZ2lzdGVyKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiAJaWYgKElT
X0VSUihyb290KSkKIAkJcmV0dXJuOwogCisJX19kZWJ1Z2ZzX2d0X3JlZ2lzdGVyKGd0LCByb290
KTsKKwogCWRlYnVnZnNfZW5naW5lc19yZWdpc3RlcihndCwgcm9vdCk7CiAJZGVidWdmc19ndF9w
bV9yZWdpc3RlcihndCwgcm9vdCk7CisJZGVidWdmc19ndF9yZWdpc3Rlcl9zc2V1KGd0LCByb290
KTsKKwlkZWJ1Z2ZzX2d0X3JlZ2lzdGVyX2lycShndCwgcm9vdCk7CiAKIAlpbnRlbF91Y19kZWJ1
Z2ZzX3JlZ2lzdGVyKCZndC0+dWMsIHJvb3QpOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvZGVidWdmc19ndF9pcnEuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2Rl
YnVnZnNfZ3RfaXJxLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwMC4u
OGFhZjc2ZGZjNTczOQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2RlYnVnZnNfZ3RfaXJxLmMKQEAgLTAsMCArMSwxNjIgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVu
dGlmaWVyOiBNSVQKKworLyoKKyAqIENvcHlyaWdodCDCqSAyMDIwIEludGVsIENvcnBvcmF0aW9u
CisgKi8KKworI2luY2x1ZGUgImRlYnVnZnNfZ3QuaCIKKyNpbmNsdWRlICJkZWJ1Z2ZzX2d0X2ly
cS5oIgorI2luY2x1ZGUgImk5MTVfZHJ2LmgiCisKK3N0YXRpYyBpbnQgaW50ZXJydXB0X2luZm9f
c2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCit7CisJc3RydWN0IGludGVsX2d0
ICpndCA9IG0tPnByaXZhdGU7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndC0+
aTkxNTsKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBndC0+dW5jb3JlOworCXN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKKwllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKKwlp
bnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKKwlpbnQgaTsKKworCXdha2VyZWYgPSBpbnRlbF9ydW50
aW1lX3BtX2dldCh1bmNvcmUtPnJwbSk7CisKKwlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkgewor
CQlzZXFfcHJpbnRmKG0sICJNYXN0ZXIgSW50ZXJydXB0IENvbnRyb2w6XHQlMDh4XG4iLAorCQkJ
ICAgaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU44X01BU1RFUl9JUlEpKTsKKworCQlmb3Ig
KGkgPSAwOyBpIDwgNDsgaSsrKSB7CisJCQlzZXFfcHJpbnRmKG0sICJHVCBJbnRlcnJ1cHQgSU1S
ICVkOlx0JTA4eFxuIiwKKwkJCQkgICBpLCBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsCisJCQkJ
CQkJR0VOOF9HVF9JTVIoaSkpKTsKKwkJCXNlcV9wcmludGYobSwgIkdUIEludGVycnVwdCBJSVIg
JWQ6XHQlMDh4XG4iLAorCQkJCSAgIGksIGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwKKwkJCQkJ
CQlHRU44X0dUX0lJUihpKSkpOworCQkJc2VxX3ByaW50ZihtLCAiR1QgSW50ZXJydXB0IElFUiAl
ZDpcdCUwOHhcbiIsCisJCQkJICAgaSwgaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLAorCQkJCQkJ
CUdFTjhfR1RfSUVSKGkpKSk7CisJCX0KKworCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49
IDExKSB7CisJCXNlcV9wcmludGYobSwgIk1hc3RlciBJbnRlcnJ1cHQgQ29udHJvbDogICUwOHhc
biIsCisJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjExX0dGWF9NU1RSX0lSUSkp
OworCisJCXNlcV9wcmludGYobSwgIlJlbmRlci9Db3B5IEludHIgRW5hYmxlOiAgICUwOHhcbiIs
CisJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsCisJCQkJCSAgICAgR0VOMTFfUkVOREVS
X0NPUFlfSU5UUl9FTkFCTEUpKTsKKwkJc2VxX3ByaW50ZihtLCAiVkNTL1ZFQ1MgSW50ciBFbmFi
bGU6ICAgICAgJTA4eFxuIiwKKwkJCSAgIGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwKKwkJCQkJ
ICAgICBHRU4xMV9WQ1NfVkVDU19JTlRSX0VOQUJMRSkpOworCQlzZXFfcHJpbnRmKG0sICJHVUMv
U0cgSW50ciBFbmFibGU6XHQgICAlMDh4XG4iLAorCQkJICAgaW50ZWxfdW5jb3JlX3JlYWQodW5j
b3JlLAorCQkJCQkgICAgIEdFTjExX0dVQ19TR19JTlRSX0VOQUJMRSkpOworCQlzZXFfcHJpbnRm
KG0sICJHUE0vV0dCT1hQRVJGIEludHIgRW5hYmxlOiAlMDh4XG4iLAorCQkJICAgaW50ZWxfdW5j
b3JlX3JlYWQodW5jb3JlLAorCQkJCQkgICAgIEdFTjExX0dQTV9XR0JPWFBFUkZfSU5UUl9FTkFC
TEUpKTsKKwkJc2VxX3ByaW50ZihtLCAiQ3J5cHRvIEludHIgRW5hYmxlOlx0ICAgJTA4eFxuIiwK
KwkJCSAgIGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwKKwkJCQkJICAgICBHRU4xMV9DUllQVE9f
UlNWRF9JTlRSX0VOQUJMRSkpOworCQlzZXFfcHJpbnRmKG0sICJHVW5pdC9DU01FIEludHIgRW5h
YmxlOlx0ICAgJTA4eFxuIiwKKwkJCSAgIGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwKKwkJCQkJ
ICAgICBHRU4xMV9HVU5JVF9DU01FX0lOVFJfRU5BQkxFKSk7CisKKwl9IGVsc2UgaWYgKElOVEVM
X0dFTihpOTE1KSA+PSA4KSB7CisJCXNlcV9wcmludGYobSwgIk1hc3RlciBJbnRlcnJ1cHQgQ29u
dHJvbDpcdCUwOHhcbiIsCisJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjhfTUFT
VEVSX0lSUSkpOworCisJCWZvciAoaSA9IDA7IGkgPCA0OyBpKyspIHsKKwkJCXNlcV9wcmludGYo
bSwgIkdUIEludGVycnVwdCBJTVIgJWQ6XHQlMDh4XG4iLAorCQkJCSAgIGksIGludGVsX3VuY29y
ZV9yZWFkKHVuY29yZSwKKwkJCQkJCQlHRU44X0dUX0lNUihpKSkpOworCQkJc2VxX3ByaW50Ziht
LCAiR1QgSW50ZXJydXB0IElJUiAlZDpcdCUwOHhcbiIsCisJCQkJICAgaSwgaW50ZWxfdW5jb3Jl
X3JlYWQodW5jb3JlLAorCQkJCQkJCUdFTjhfR1RfSUlSKGkpKSk7CisJCQlzZXFfcHJpbnRmKG0s
ICJHVCBJbnRlcnJ1cHQgSUVSICVkOlx0JTA4eFxuIiwKKwkJCQkgICBpLCBpbnRlbF91bmNvcmVf
cmVhZCh1bmNvcmUsCisJCQkJCQkJR0VOOF9HVF9JRVIoaSkpKTsKKwkJfQorCisJfSBlbHNlIGlm
IChJU19WQUxMRVlWSUVXKGk5MTUpKSB7CisJCXNlcV9wcmludGYobSwgIk1hc3RlciBJRVI6XHQl
MDh4XG4iLAorCQkJICAgaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBWTFZfTUFTVEVSX0lFUikp
OworCisJCXNlcV9wcmludGYobSwgIlJlbmRlciBJRVI6XHQlMDh4XG4iLAorCQkJICAgaW50ZWxf
dW5jb3JlX3JlYWQodW5jb3JlLCBHVElFUikpOworCQlzZXFfcHJpbnRmKG0sICJSZW5kZXIgSUlS
Olx0JTA4eFxuIiwKKwkJCSAgIGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR1RJSVIpKTsKKwkJ
c2VxX3ByaW50ZihtLCAiUmVuZGVyIElNUjpcdCUwOHhcbiIsCisJCQkgICBpbnRlbF91bmNvcmVf
cmVhZCh1bmNvcmUsIEdUSU1SKSk7CisKKwkJc2VxX3ByaW50ZihtLCAiUE0gSUVSOlx0XHQlMDh4
XG4iLAorCQkJICAgaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU42X1BNSUVSKSk7CisJCXNl
cV9wcmludGYobSwgIlBNIElJUjpcdFx0JTA4eFxuIiwKKwkJCSAgIGludGVsX3VuY29yZV9yZWFk
KHVuY29yZSwgR0VONl9QTUlJUikpOworCQlzZXFfcHJpbnRmKG0sICJQTSBJTVI6XHRcdCUwOHhc
biIsCisJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUE1JTVIpKTsKKworCX0g
ZWxzZSBpZiAoIUhBU19QQ0hfU1BMSVQoaTkxNSkpIHsKKwkJc2VxX3ByaW50ZihtLCAiSW50ZXJy
dXB0IGVuYWJsZTogICAgJTA4eFxuIiwKKwkJCSAgIGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwg
R0VOMl9JRVIpKTsKKwkJc2VxX3ByaW50ZihtLCAiSW50ZXJydXB0IGlkZW50aXR5OiAgJTA4eFxu
IiwKKwkJCSAgIGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VOMl9JSVIpKTsKKwkJc2VxX3By
aW50ZihtLCAiSW50ZXJydXB0IG1hc2s6ICAgICAgJTA4eFxuIiwKKwkJCSAgIGludGVsX3VuY29y
ZV9yZWFkKHVuY29yZSwgR0VOMl9JTVIpKTsKKwl9IGVsc2UgeworCQlzZXFfcHJpbnRmKG0sICJH
cmFwaGljcyBJbnRlcnJ1cHQgZW5hYmxlOgkJJTA4eFxuIiwKKwkJCSAgIGludGVsX3VuY29yZV9y
ZWFkKHVuY29yZSwgR1RJRVIpKTsKKwkJc2VxX3ByaW50ZihtLCAiR3JhcGhpY3MgSW50ZXJydXB0
IGlkZW50aXR5OgkJJTA4eFxuIiwKKwkJCSAgIGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR1RJ
SVIpKTsKKwkJc2VxX3ByaW50ZihtLCAiR3JhcGhpY3MgSW50ZXJydXB0IG1hc2s6CQklMDh4XG4i
LAorCQkJICAgaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHVElNUikpOworCX0KKworCWlmIChJ
TlRFTF9HRU4oaTkxNSkgPj0gMTEpIHsKKwkJc2VxX3ByaW50ZihtLCAiUkNTIEludHIgTWFzazpc
dCAlMDh4XG4iLAorCQkJICAgaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLAorCQkJCQkgICAgIEdF
TjExX1JDUzBfUlNWRF9JTlRSX01BU0spKTsKKwkJc2VxX3ByaW50ZihtLCAiQkNTIEludHIgTWFz
azpcdCAlMDh4XG4iLAorCQkJICAgaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLAorCQkJCQkgICAg
IEdFTjExX0JDU19SU1ZEX0lOVFJfTUFTSykpOworCQlzZXFfcHJpbnRmKG0sICJWQ1MwL1ZDUzEg
SW50ciBNYXNrOlx0ICUwOHhcbiIsCisJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsCisJ
CQkJCSAgICAgR0VOMTFfVkNTMF9WQ1MxX0lOVFJfTUFTSykpOworCQlzZXFfcHJpbnRmKG0sICJW
Q1MyL1ZDUzMgSW50ciBNYXNrOlx0ICUwOHhcbiIsCisJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1
bmNvcmUsCisJCQkJCSAgICAgR0VOMTFfVkNTMl9WQ1MzX0lOVFJfTUFTSykpOworCQlzZXFfcHJp
bnRmKG0sICJWRUNTMC9WRUNTMSBJbnRyIE1hc2s6XHQgJTA4eFxuIiwKKwkJCSAgIGludGVsX3Vu
Y29yZV9yZWFkKHVuY29yZSwKKwkJCQkJICAgICBHRU4xMV9WRUNTMF9WRUNTMV9JTlRSX01BU0sp
KTsKKwkJc2VxX3ByaW50ZihtLCAiR1VDL1NHIEludHIgTWFzazpcdCAlMDh4XG4iLAorCQkJICAg
aW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLAorCQkJCQkgICAgIEdFTjExX0dVQ19TR19JTlRSX01B
U0spKTsKKwkJc2VxX3ByaW50ZihtLCAiR1BNL1dHQk9YUEVSRiBJbnRyIE1hc2s6ICUwOHhcbiIs
CisJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsCisJCQkJCSAgICAgR0VOMTFfR1BNX1dH
Qk9YUEVSRl9JTlRSX01BU0spKTsKKwkJc2VxX3ByaW50ZihtLCAiQ3J5cHRvIEludHIgTWFzazpc
dCAlMDh4XG4iLAorCQkJICAgaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLAorCQkJCQkgICAgIEdF
TjExX0NSWVBUT19SU1ZEX0lOVFJfTUFTSykpOworCQlzZXFfcHJpbnRmKG0sICJHdW5pdC9DU01F
IEludHIgTWFzazpcdCAlMDh4XG4iLAorCQkJICAgaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLAor
CQkJCQkgICAgIEdFTjExX0dVTklUX0NTTUVfSU5UUl9NQVNLKSk7CisKKwl9IGVsc2UgaWYgKElO
VEVMX0dFTihpOTE1KSA+PSA2KSB7CisJCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LCBpZCkg
eworCQkJc2VxX3ByaW50ZihtLAorCQkJCSAgICJHcmFwaGljcyBJbnRlcnJ1cHQgbWFzayAoJXMp
OgklMDh4XG4iLAorCQkJCSAgIGVuZ2luZS0+bmFtZSwgRU5HSU5FX1JFQUQoZW5naW5lLCBSSU5H
X0lNUikpOworCQl9CisJfQorCisJaW50ZWxfcnVudGltZV9wbV9wdXQodW5jb3JlLT5ycG0sIHdh
a2VyZWYpOworCisJcmV0dXJuIDA7Cit9CitERUZJTkVfR1RfREVCVUdGU19BVFRSSUJVVEUoaW50
ZXJydXB0X2luZm8pOworCit2b2lkIGRlYnVnZnNfZ3RfcmVnaXN0ZXJfaXJxKHN0cnVjdCBpbnRl
bF9ndCAqZ3QsIHN0cnVjdCBkZW50cnkgKnJvb3QpCit7CisJc3RhdGljIGNvbnN0IHN0cnVjdCBk
ZWJ1Z2ZzX2d0X2ZpbGUgZmlsZXNbXSA9IHsKKwkJeyAiaW50ZXJydXB0X2luZm8iLCAmaW50ZXJy
dXB0X2luZm9fZm9wcywgTlVMTCB9LAorCX07CisKKwlpbnRlbF9ndF9kZWJ1Z2ZzX3JlZ2lzdGVy
X2ZpbGVzKHJvb3QsIGZpbGVzLCBBUlJBWV9TSVpFKGZpbGVzKSwgZ3QpOworfQpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19ndF9pcnEuaCBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2RlYnVnZnNfZ3RfaXJxLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXgg
MDAwMDAwMDAwMDAwMC4uZjNkNjAxYjNkMDE5YgotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2RlYnVnZnNfZ3RfaXJxLmgKQEAgLTAsMCArMSwxNSBAQAorLyogU1BE
WC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVCAqLworCisvKgorICogQ29weXJpZ2h0IMKpIDIwMjAg
SW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisjaWZuZGVmIERFQlVHRlNfR1RfSVJRX0gKKyNkZWZp
bmUgREVCVUdGU19HVF9JUlFfSAorCitzdHJ1Y3QgaW50ZWxfZ3Q7CitzdHJ1Y3QgZGVudHJ5Owor
Cit2b2lkIGRlYnVnZnNfZ3RfcmVnaXN0ZXJfaXJxKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIHN0cnVj
dCBkZW50cnkgKnJvb3QpOworCisjZW5kaWYgLyogREVCVUdGU19HVF9JUlFfSCAqLwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19ndF9wbS5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvZGVidWdmc19ndF9wbS5jCmluZGV4IGFhYjMwZDkwODA3MmQuLmM5NGE5
NDZlMGFkYjEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2RlYnVnZnNfZ3Rf
cG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX2d0X3BtLmMKQEAgLTEw
LDYgKzEwLDcgQEAKICNpbmNsdWRlICJkZWJ1Z2ZzX2d0X3BtLmgiCiAjaW5jbHVkZSAiaTkxNV9k
cnYuaCIKICNpbmNsdWRlICJpbnRlbF9ndC5oIgorI2luY2x1ZGUgImludGVsX2d0X3BtLmgiCiAj
aW5jbHVkZSAiaW50ZWxfbGxjLmgiCiAjaW5jbHVkZSAiaW50ZWxfcmM2LmgiCiAjaW5jbHVkZSAi
aW50ZWxfcnBzLmgiCkBAIC0xNyw2ICsxOCwzNiBAQAogI2luY2x1ZGUgImludGVsX3NpZGViYW5k
LmgiCiAjaW5jbHVkZSAiaW50ZWxfdW5jb3JlLmgiCiAKK3N0YXRpYyBpbnQgZm9yY2V3YWtlX3Vz
ZXJfb3BlbihzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZmlsZSkKK3sKKwlzdHJ1
Y3QgaW50ZWxfZ3QgKmd0ID0gaW5vZGUtPmlfcHJpdmF0ZTsKKworCWF0b21pY19pbmMoJmd0LT51
c2VyX3dha2VyZWYpOworCWludGVsX2d0X3BtX2dldChndCk7CisJaWYgKElOVEVMX0dFTihndC0+
aTkxNSkgPj0gNikKKwkJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV91c2VyX2dldChndC0+dW5jb3Jl
KTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGZvcmNld2FrZV91c2VyX3JlbGVhc2Uo
c3RydWN0IGlub2RlICppbm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpCit7CisJc3RydWN0IGludGVs
X2d0ICpndCA9IGlub2RlLT5pX3ByaXZhdGU7CisKKwlpZiAoSU5URUxfR0VOKGd0LT5pOTE1KSA+
PSA2KQorCQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3VzZXJfcHV0KGd0LT51bmNvcmUpOworCWlu
dGVsX2d0X3BtX3B1dChndCk7CisJYXRvbWljX2RlYygmZ3QtPnVzZXJfd2FrZXJlZik7CisKKwly
ZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBmaWxlX29wZXJhdGlvbnMgZm9yY2V3
YWtlX3VzZXJfZm9wcyA9IHsKKwkub3duZXIgPSBUSElTX01PRFVMRSwKKwkub3BlbiA9IGZvcmNl
d2FrZV91c2VyX29wZW4sCisJLnJlbGVhc2UgPSBmb3JjZXdha2VfdXNlcl9yZWxlYXNlLAorfTsK
Kwogc3RhdGljIGludCBmd19kb21haW5zX3Nob3coc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpk
YXRhKQogewogCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBtLT5wcml2YXRlOwpAQCAtNTk3LDYgKzYy
OCw3IEBAIHZvaWQgZGVidWdmc19ndF9wbV9yZWdpc3RlcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBz
dHJ1Y3QgZGVudHJ5ICpyb290KQogCQl7ICJkcnBjIiwgJmRycGNfZm9wcywgTlVMTCB9LAogCQl7
ICJmcmVxdWVuY3kiLCAmZnJlcXVlbmN5X2ZvcHMsIE5VTEwgfSwKIAkJeyAiZm9yY2V3YWtlIiwg
JmZ3X2RvbWFpbnNfZm9wcywgTlVMTCB9LAorCQl7ICJmb3JjZXdha2VfdXNlciIsICZmb3JjZXdh
a2VfdXNlcl9mb3BzLCBOVUxMfSwKIAkJeyAibGxjIiwgJmxsY19mb3BzLCBsbGNfZXZhbCB9LAog
CQl7ICJycHNfYm9vc3QiLCAmcnBzX2Jvb3N0X2ZvcHMsIHJwc19ldmFsIH0sCiAJfTsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2RlYnVnZnNfc3NldS5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvZGVidWdmc19zc2V1LmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXgg
MDAwMDAwMDAwMDAwMC4uNjFjYWQxZTE3ZTdiMAotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2RlYnVnZnNfc3NldS5jCkBAIC0wLDAgKzEsMjk0IEBACisvLyBTUERY
LUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCisKKy8qCisgKiBDb3B5cmlnaHQgwqkgMjAyMCBJbnRl
bCBDb3Jwb3JhdGlvbgorICovCisKKyNpbmNsdWRlICJkZWJ1Z2ZzX2d0LmgiCisjaW5jbHVkZSAi
ZGVidWdmc19zc2V1LmgiCisjaW5jbHVkZSAiaTkxNV9kcnYuaCIKKworc3RhdGljIHZvaWQgaW50
ZWxfc3NldV9jb3B5X3N1YnNsaWNlcyhjb25zdCBzdHJ1Y3Qgc3NldV9kZXZfaW5mbyAqc3NldSwK
KwkJCQkgICAgICBpbnQgc2xpY2UsIHU4ICp0b19tYXNrKQoreworCWludCBvZmZzZXQgPSBzbGlj
ZSAqIHNzZXUtPnNzX3N0cmlkZTsKKworCW1lbWNweSgmdG9fbWFza1tvZmZzZXRdLCAmc3NldS0+
c3Vic2xpY2VfbWFza1tvZmZzZXRdLCBzc2V1LT5zc19zdHJpZGUpOworfQorCitzdGF0aWMgdm9p
ZCBjaGVycnl2aWV3X3NzZXVfZGV2aWNlX3N0YXR1cyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAorCQkJ
CQkgIHN0cnVjdCBzc2V1X2Rldl9pbmZvICpzc2V1KQoreworI2RlZmluZSBTU19NQVggMgorCXN0
cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IGd0LT51bmNvcmU7CisJY29uc3QgaW50IHNzX21h
eCA9IFNTX01BWDsKKwl1MzIgc2lnMVtTU19NQVhdLCBzaWcyW1NTX01BWF07CisJaW50IHNzOwor
CisJc2lnMVswXSA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgQ0hWX1BPV0VSX1NTMF9TSUcx
KTsKKwlzaWcxWzFdID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBDSFZfUE9XRVJfU1MxX1NJ
RzEpOworCXNpZzJbMF0gPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIENIVl9QT1dFUl9TUzBf
U0lHMik7CisJc2lnMlsxXSA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgQ0hWX1BPV0VSX1NT
MV9TSUcyKTsKKworCWZvciAoc3MgPSAwOyBzcyA8IHNzX21heDsgc3MrKykgeworCQl1bnNpZ25l
ZCBpbnQgZXVfY250OworCisJCWlmIChzaWcxW3NzXSAmIENIVl9TU19QR19FTkFCTEUpCisJCQkv
KiBza2lwIGRpc2FibGVkIHN1YnNsaWNlICovCisJCQljb250aW51ZTsKKworCQlzc2V1LT5zbGlj
ZV9tYXNrID0gQklUKDApOworCQlzc2V1LT5zdWJzbGljZV9tYXNrWzBdIHw9IEJJVChzcyk7CisJ
CWV1X2NudCA9ICgoc2lnMVtzc10gJiBDSFZfRVUwOF9QR19FTkFCTEUpID8gMCA6IDIpICsKKwkJ
CSAoKHNpZzFbc3NdICYgQ0hWX0VVMTlfUEdfRU5BQkxFKSA/IDAgOiAyKSArCisJCQkgKChzaWcx
W3NzXSAmIENIVl9FVTIxMF9QR19FTkFCTEUpID8gMCA6IDIpICsKKwkJCSAoKHNpZzJbc3NdICYg
Q0hWX0VVMzExX1BHX0VOQUJMRSkgPyAwIDogMik7CisJCXNzZXUtPmV1X3RvdGFsICs9IGV1X2Nu
dDsKKwkJc3NldS0+ZXVfcGVyX3N1YnNsaWNlID0gbWF4X3QodW5zaWduZWQgaW50LAorCQkJCQkg
ICAgICBzc2V1LT5ldV9wZXJfc3Vic2xpY2UsIGV1X2NudCk7CisJfQorI3VuZGVmIFNTX01BWAor
fQorCitzdGF0aWMgdm9pZCBnZW4xMF9zc2V1X2RldmljZV9zdGF0dXMoc3RydWN0IGludGVsX2d0
ICpndCwKKwkJCQkgICAgIHN0cnVjdCBzc2V1X2Rldl9pbmZvICpzc2V1KQoreworI2RlZmluZSBT
U19NQVggNgorCWNvbnN0IHN0cnVjdCBpbnRlbF9ydW50aW1lX2luZm8gKmluZm8gPSBSVU5USU1F
X0lORk8oZ3QtPmk5MTUpOworCXUzMiBzX3JlZ1tTU19NQVhdLCBldV9yZWdbMiAqIFNTX01BWF0s
IGV1X21hc2tbMl07CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gZ3QtPnVuY29yZTsK
KwlpbnQgcywgc3M7CisKKwlmb3IgKHMgPSAwOyBzIDwgaW5mby0+c3NldS5tYXhfc2xpY2VzOyBz
KyspIHsKKwkJLyoKKwkJICogRklYTUU6IFZhbGlkIFNTIE1hc2sgcmVzcGVjdHMgdGhlIHNwZWMg
YW5kIHJlYWQKKwkJICogb25seSB2YWxpZCBiaXRzIGZvciB0aG9zZSByZWdpc3RlcnMsIGV4Y2x1
ZGluZyByZXNlcnZlZAorCQkgKiBhbHRob3VnaCB0aGlzIHNlZW1zIHdyb25nIGJlY2F1c2UgaXQg
d291bGQgbGVhdmUgbWFueQorCQkgKiBzdWJzbGljZXMgd2l0aG91dCBBQ0suCisJCSAqLworCQlz
X3JlZ1tzXSA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VOMTBfU0xJQ0VfUEdDVExfQUNL
KHMpKSAmCisJCQkgICBHRU4xMF9QR0NUTF9WQUxJRF9TU19NQVNLKHMpOworCQlldV9yZWdbMiAq
IHNdID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLAorCQkJCQkJICBHRU4xMF9TUzAxX0VVX1BH
Q1RMX0FDSyhzKSk7CisJCWV1X3JlZ1syICogcyArIDFdID0gaW50ZWxfdW5jb3JlX3JlYWQodW5j
b3JlLAorCQkJCQkJICBHRU4xMF9TUzIzX0VVX1BHQ1RMX0FDSyhzKSk7CisJfQorCisJZXVfbWFz
a1swXSA9IEdFTjlfUEdDVExfU1NBX0VVMDhfQUNLIHwKKwkJICAgICBHRU45X1BHQ1RMX1NTQV9F
VTE5X0FDSyB8CisJCSAgICAgR0VOOV9QR0NUTF9TU0FfRVUyMTBfQUNLIHwKKwkJICAgICBHRU45
X1BHQ1RMX1NTQV9FVTMxMV9BQ0s7CisJZXVfbWFza1sxXSA9IEdFTjlfUEdDVExfU1NCX0VVMDhf
QUNLIHwKKwkJICAgICBHRU45X1BHQ1RMX1NTQl9FVTE5X0FDSyB8CisJCSAgICAgR0VOOV9QR0NU
TF9TU0JfRVUyMTBfQUNLIHwKKwkJICAgICBHRU45X1BHQ1RMX1NTQl9FVTMxMV9BQ0s7CisKKwlm
b3IgKHMgPSAwOyBzIDwgaW5mby0+c3NldS5tYXhfc2xpY2VzOyBzKyspIHsKKwkJaWYgKChzX3Jl
Z1tzXSAmIEdFTjlfUEdDVExfU0xJQ0VfQUNLKSA9PSAwKQorCQkJLyogc2tpcCBkaXNhYmxlZCBz
bGljZSAqLworCQkJY29udGludWU7CisKKwkJc3NldS0+c2xpY2VfbWFzayB8PSBCSVQocyk7CisJ
CWludGVsX3NzZXVfY29weV9zdWJzbGljZXMoJmluZm8tPnNzZXUsIHMsIHNzZXUtPnN1YnNsaWNl
X21hc2spOworCisJCWZvciAoc3MgPSAwOyBzcyA8IGluZm8tPnNzZXUubWF4X3N1YnNsaWNlczsg
c3MrKykgeworCQkJdW5zaWduZWQgaW50IGV1X2NudDsKKworCQkJaWYgKGluZm8tPnNzZXUuaGFz
X3N1YnNsaWNlX3BnICYmCisJCQkgICAgIShzX3JlZ1tzXSAmIChHRU45X1BHQ1RMX1NTX0FDSyhz
cykpKSkKKwkJCQkvKiBza2lwIGRpc2FibGVkIHN1YnNsaWNlICovCisJCQkJY29udGludWU7CisK
KwkJCWV1X2NudCA9IDIgKiBod2VpZ2h0MzIoZXVfcmVnWzIgKiBzICsgc3MgLyAyXSAmCisJCQkJ
CSAgICAgICBldV9tYXNrW3NzICUgMl0pOworCQkJc3NldS0+ZXVfdG90YWwgKz0gZXVfY250Owor
CQkJc3NldS0+ZXVfcGVyX3N1YnNsaWNlID0gbWF4X3QodW5zaWduZWQgaW50LAorCQkJCQkJICAg
ICAgc3NldS0+ZXVfcGVyX3N1YnNsaWNlLAorCQkJCQkJICAgICAgZXVfY250KTsKKwkJfQorCX0K
KyN1bmRlZiBTU19NQVgKK30KKworc3RhdGljIHZvaWQgZ2VuOV9zc2V1X2RldmljZV9zdGF0dXMo
c3RydWN0IGludGVsX2d0ICpndCwKKwkJCQkgICAgc3RydWN0IHNzZXVfZGV2X2luZm8gKnNzZXUp
Cit7CisjZGVmaW5lIFNTX01BWCAzCisJY29uc3Qgc3RydWN0IGludGVsX3J1bnRpbWVfaW5mbyAq
aW5mbyA9IFJVTlRJTUVfSU5GTyhndC0+aTkxNSk7CisJdTMyIHNfcmVnW1NTX01BWF0sIGV1X3Jl
Z1syICogU1NfTUFYXSwgZXVfbWFza1syXTsKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUg
PSBndC0+dW5jb3JlOworCWludCBzLCBzczsKKworCWZvciAocyA9IDA7IHMgPCBpbmZvLT5zc2V1
Lm1heF9zbGljZXM7IHMrKykgeworCQlzX3JlZ1tzXSA9IGludGVsX3VuY29yZV9yZWFkKHVuY29y
ZSwgR0VOOV9TTElDRV9QR0NUTF9BQ0socykpOworCQlldV9yZWdbMipzXSA9IGludGVsX3VuY29y
ZV9yZWFkKHVuY29yZSwKKwkJCQkJCUdFTjlfU1MwMV9FVV9QR0NUTF9BQ0socykpOworCQlldV9y
ZWdbMipzICsgMV0gPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsCisJCQkJCQkgICAgR0VOOV9T
UzIzX0VVX1BHQ1RMX0FDSyhzKSk7CisJfQorCisJZXVfbWFza1swXSA9IEdFTjlfUEdDVExfU1NB
X0VVMDhfQUNLIHwKKwkJICAgICBHRU45X1BHQ1RMX1NTQV9FVTE5X0FDSyB8CisJCSAgICAgR0VO
OV9QR0NUTF9TU0FfRVUyMTBfQUNLIHwKKwkJICAgICBHRU45X1BHQ1RMX1NTQV9FVTMxMV9BQ0s7
CisJZXVfbWFza1sxXSA9IEdFTjlfUEdDVExfU1NCX0VVMDhfQUNLIHwKKwkJICAgICBHRU45X1BH
Q1RMX1NTQl9FVTE5X0FDSyB8CisJCSAgICAgR0VOOV9QR0NUTF9TU0JfRVUyMTBfQUNLIHwKKwkJ
ICAgICBHRU45X1BHQ1RMX1NTQl9FVTMxMV9BQ0s7CisKKwlmb3IgKHMgPSAwOyBzIDwgaW5mby0+
c3NldS5tYXhfc2xpY2VzOyBzKyspIHsKKwkJaWYgKChzX3JlZ1tzXSAmIEdFTjlfUEdDVExfU0xJ
Q0VfQUNLKSA9PSAwKQorCQkJLyogc2tpcCBkaXNhYmxlZCBzbGljZSAqLworCQkJY29udGludWU7
CisKKwkJc3NldS0+c2xpY2VfbWFzayB8PSBCSVQocyk7CisKKwkJaWYgKElTX0dFTjlfQkMoZ3Qt
Pmk5MTUpKQorCQkJaW50ZWxfc3NldV9jb3B5X3N1YnNsaWNlcygmaW5mby0+c3NldSwgcywKKwkJ
CQkJCSAgc3NldS0+c3Vic2xpY2VfbWFzayk7CisKKwkJZm9yIChzcyA9IDA7IHNzIDwgaW5mby0+
c3NldS5tYXhfc3Vic2xpY2VzOyBzcysrKSB7CisJCQl1bnNpZ25lZCBpbnQgZXVfY250OworCQkJ
dTggc3NfaWR4ID0gcyAqIGluZm8tPnNzZXUuc3Nfc3RyaWRlICsKKwkJCQkgICAgc3MgLyBCSVRT
X1BFUl9CWVRFOworCisJCQlpZiAoSVNfR0VOOV9MUChndC0+aTkxNSkpIHsKKwkJCQlpZiAoIShz
X3JlZ1tzXSAmIChHRU45X1BHQ1RMX1NTX0FDSyhzcykpKSkKKwkJCQkJLyogc2tpcCBkaXNhYmxl
ZCBzdWJzbGljZSAqLworCQkJCQljb250aW51ZTsKKworCQkJCXNzZXUtPnN1YnNsaWNlX21hc2tb
c3NfaWR4XSB8PQorCQkJCQlCSVQoc3MgJSBCSVRTX1BFUl9CWVRFKTsKKwkJCX0KKworCQkJZXVf
Y250ID0gMiAqIGh3ZWlnaHQzMihldV9yZWdbMipzICsgc3MvMl0gJgorCQkJCQkgICAgICAgZXVf
bWFza1tzcyUyXSk7CisJCQlzc2V1LT5ldV90b3RhbCArPSBldV9jbnQ7CisJCQlzc2V1LT5ldV9w
ZXJfc3Vic2xpY2UgPSBtYXhfdCh1bnNpZ25lZCBpbnQsCisJCQkJCQkgICAgICBzc2V1LT5ldV9w
ZXJfc3Vic2xpY2UsCisJCQkJCQkgICAgICBldV9jbnQpOworCQl9CisJfQorI3VuZGVmIFNTX01B
WAorfQorCitzdGF0aWMgdm9pZCBiZHdfc3NldV9kZXZpY2Vfc3RhdHVzKHN0cnVjdCBpbnRlbF9n
dCAqZ3QsCisJCQkJICAgc3RydWN0IHNzZXVfZGV2X2luZm8gKnNzZXUpCit7CisJY29uc3Qgc3Ry
dWN0IGludGVsX3J1bnRpbWVfaW5mbyAqaW5mbyA9IFJVTlRJTUVfSU5GTyhndC0+aTkxNSk7CisJ
dTMyIHNsaWNlX2luZm8gPSBpbnRlbF91bmNvcmVfcmVhZChndC0+dW5jb3JlLCBHRU44X0dUX1NM
SUNFX0lORk8pOworCWludCBzOworCisJc3NldS0+c2xpY2VfbWFzayA9IHNsaWNlX2luZm8gJiBH
RU44X0xTTElDRVNUQVRfTUFTSzsKKworCWlmIChzc2V1LT5zbGljZV9tYXNrKSB7CisJCXNzZXUt
PmV1X3Blcl9zdWJzbGljZSA9IGluZm8tPnNzZXUuZXVfcGVyX3N1YnNsaWNlOworCQlmb3IgKHMg
PSAwOyBzIDwgZmxzKHNzZXUtPnNsaWNlX21hc2spOyBzKyspCisJCQlpbnRlbF9zc2V1X2NvcHlf
c3Vic2xpY2VzKCZpbmZvLT5zc2V1LCBzLAorCQkJCQkJICBzc2V1LT5zdWJzbGljZV9tYXNrKTsK
KwkJc3NldS0+ZXVfdG90YWwgPSBzc2V1LT5ldV9wZXJfc3Vic2xpY2UgKgorCQkJCSBpbnRlbF9z
c2V1X3N1YnNsaWNlX3RvdGFsKHNzZXUpOworCisJCS8qIHN1YnRyYWN0IGZ1c2VkIG9mZiBFVShz
KSBmcm9tIGVuYWJsZWQgc2xpY2UocykgKi8KKwkJZm9yIChzID0gMDsgcyA8IGZscyhzc2V1LT5z
bGljZV9tYXNrKTsgcysrKSB7CisJCQl1OCBzdWJzbGljZV83ZXUgPSBpbmZvLT5zc2V1LnN1YnNs
aWNlXzdldVtzXTsKKworCQkJc3NldS0+ZXVfdG90YWwgLT0gaHdlaWdodDgoc3Vic2xpY2VfN2V1
KTsKKwkJfQorCX0KK30KKworc3RhdGljIHZvaWQgcHJpbnRfc3NldV9pbmZvKHN0cnVjdCBzZXFf
ZmlsZSAqbSwgYm9vbCBpc19hdmFpbGFibGVfaW5mbywKKwkJCSAgICBjb25zdCBzdHJ1Y3Qgc3Nl
dV9kZXZfaW5mbyAqc3NldSkKK3sKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gbS0+cHJpdmF0ZTsK
Kwljb25zdCBjaGFyICp0eXBlID0gaXNfYXZhaWxhYmxlX2luZm8gPyAiQXZhaWxhYmxlIiA6ICJF
bmFibGVkIjsKKwlpbnQgczsKKworCXNlcV9wcmludGYobSwgIiAgJXMgU2xpY2UgTWFzazogJTA0
eFxuIiwgdHlwZSwKKwkJICAgc3NldS0+c2xpY2VfbWFzayk7CisJc2VxX3ByaW50ZihtLCAiICAl
cyBTbGljZSBUb3RhbDogJXVcbiIsIHR5cGUsCisJCSAgIGh3ZWlnaHQ4KHNzZXUtPnNsaWNlX21h
c2spKTsKKwlzZXFfcHJpbnRmKG0sICIgICVzIFN1YnNsaWNlIFRvdGFsOiAldVxuIiwgdHlwZSwK
KwkJICAgaW50ZWxfc3NldV9zdWJzbGljZV90b3RhbChzc2V1KSk7CisJZm9yIChzID0gMDsgcyA8
IGZscyhzc2V1LT5zbGljZV9tYXNrKTsgcysrKSB7CisJCXNlcV9wcmludGYobSwgIiAgJXMgU2xp
Y2UlaSBzdWJzbGljZXM6ICV1XG4iLCB0eXBlLAorCQkJICAgcywgaW50ZWxfc3NldV9zdWJzbGlj
ZXNfcGVyX3NsaWNlKHNzZXUsIHMpKTsKKwl9CisJc2VxX3ByaW50ZihtLCAiICAlcyBFVSBUb3Rh
bDogJXVcbiIsIHR5cGUsCisJCSAgIHNzZXUtPmV1X3RvdGFsKTsKKwlzZXFfcHJpbnRmKG0sICIg
ICVzIEVVIFBlciBTdWJzbGljZTogJXVcbiIsIHR5cGUsCisJCSAgIHNzZXUtPmV1X3Blcl9zdWJz
bGljZSk7CisKKwlpZiAoIWlzX2F2YWlsYWJsZV9pbmZvKQorCQlyZXR1cm47CisKKwlzZXFfcHJp
bnRmKG0sICIgIEhhcyBQb29sZWQgRVU6ICVzXG4iLCB5ZXNubyhIQVNfUE9PTEVEX0VVKGd0LT5p
OTE1KSkpOworCWlmIChIQVNfUE9PTEVEX0VVKGd0LT5pOTE1KSkKKwkJc2VxX3ByaW50ZihtLCAi
ICBNaW4gRVUgaW4gcG9vbDogJXVcbiIsIHNzZXUtPm1pbl9ldV9pbl9wb29sKTsKKworCXNlcV9w
cmludGYobSwgIiAgSGFzIFNsaWNlIFBvd2VyIEdhdGluZzogJXNcbiIsCisJCSAgIHllc25vKHNz
ZXUtPmhhc19zbGljZV9wZykpOworCXNlcV9wcmludGYobSwgIiAgSGFzIFN1YnNsaWNlIFBvd2Vy
IEdhdGluZzogJXNcbiIsCisJCSAgIHllc25vKHNzZXUtPmhhc19zdWJzbGljZV9wZykpOworCXNl
cV9wcmludGYobSwgIiAgSGFzIEVVIFBvd2VyIEdhdGluZzogJXNcbiIsCisJCSAgIHllc25vKHNz
ZXUtPmhhc19ldV9wZykpOworfQorCitzdGF0aWMgaW50IHNzZXVfc3RhdHVzX3Nob3coc3RydWN0
IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCit7CisJc3RydWN0IGludGVsX2d0ICpndCA9IG0t
PnByaXZhdGU7CisJY29uc3Qgc3RydWN0IGludGVsX3J1bnRpbWVfaW5mbyAqaW5mbyA9IFJVTlRJ
TUVfSU5GTyhndC0+aTkxNSk7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndC0+
aTkxNTsKKwlzdHJ1Y3Qgc3NldV9kZXZfaW5mbyBzc2V1OworCWludGVsX3dha2VyZWZfdCB3YWtl
cmVmOworCisJaWYgKElOVEVMX0dFTihpOTE1KSA8IDgpCisJCXJldHVybiAtRU5PREVWOworCisJ
c2VxX3B1dHMobSwgIlNTRVUgRGV2aWNlIEluZm9cbiIpOworCXByaW50X3NzZXVfaW5mbyhtLCB0
cnVlLCAmaW5mby0+c3NldSk7CisKKwlzZXFfcHV0cyhtLCAiU1NFVSBEZXZpY2UgU3RhdHVzXG4i
KTsKKwltZW1zZXQoJnNzZXUsIDAsIHNpemVvZihzc2V1KSk7CisJaW50ZWxfc3NldV9zZXRfaW5m
bygmc3NldSwgaW5mby0+c3NldS5tYXhfc2xpY2VzLAorCQkJICAgIGluZm8tPnNzZXUubWF4X3N1
YnNsaWNlcywKKwkJCSAgICBpbmZvLT5zc2V1Lm1heF9ldXNfcGVyX3N1YnNsaWNlKTsKKworCXdp
dGhfaW50ZWxfcnVudGltZV9wbShndC0+dW5jb3JlLT5ycG0sIHdha2VyZWYpIHsKKwkJaWYgKElT
X0NIRVJSWVZJRVcoaTkxNSkpCisJCQljaGVycnl2aWV3X3NzZXVfZGV2aWNlX3N0YXR1cyhndCwg
JnNzZXUpOworCQllbHNlIGlmIChJU19CUk9BRFdFTEwoaTkxNSkpCisJCQliZHdfc3NldV9kZXZp
Y2Vfc3RhdHVzKGd0LCAmc3NldSk7CisJCWVsc2UgaWYgKElTX0dFTihpOTE1LCA5KSkKKwkJCWdl
bjlfc3NldV9kZXZpY2Vfc3RhdHVzKGd0LCAmc3NldSk7CisJCWVsc2UgaWYgKElOVEVMX0dFTihp
OTE1KSA+PSAxMCkKKwkJCWdlbjEwX3NzZXVfZGV2aWNlX3N0YXR1cyhndCwgJnNzZXUpOworCX0K
KworCXByaW50X3NzZXVfaW5mbyhtLCBmYWxzZSwgJnNzZXUpOworCisJcmV0dXJuIDA7Cit9CitE
RUZJTkVfR1RfREVCVUdGU19BVFRSSUJVVEUoc3NldV9zdGF0dXMpOworCitzdGF0aWMgaW50IHJj
c190b3BvbG9neV9zaG93KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQoreworCXN0
cnVjdCBpbnRlbF9ndCAqZ3QgPSBtLT5wcml2YXRlOworCXN0cnVjdCBkcm1fcHJpbnRlciBwID0g
ZHJtX3NlcV9maWxlX3ByaW50ZXIobSk7CisKKwlpbnRlbF9kZXZpY2VfaW5mb19wcmludF90b3Bv
bG9neSgmUlVOVElNRV9JTkZPKGd0LT5pOTE1KS0+c3NldSwgJnApOworCisJcmV0dXJuIDA7Cit9
CitERUZJTkVfR1RfREVCVUdGU19BVFRSSUJVVEUocmNzX3RvcG9sb2d5KTsKKwordm9pZCBkZWJ1
Z2ZzX2d0X3JlZ2lzdGVyX3NzZXUoc3RydWN0IGludGVsX2d0ICpndCwgc3RydWN0IGRlbnRyeSAq
cm9vdCkKK3sKKwlzdGF0aWMgY29uc3Qgc3RydWN0IGRlYnVnZnNfZ3RfZmlsZSBmaWxlc1tdID0g
eworCQl7ICJzc2V1X3N0YXR1cyIsICZzc2V1X3N0YXR1c19mb3BzLCBOVUxMIH0sCisJCXsgInJj
c190b3BvbG9neSIsICZyY3NfdG9wb2xvZ3lfZm9wcywgTlVMTCB9LAorCX07CisKKwlpbnRlbF9n
dF9kZWJ1Z2ZzX3JlZ2lzdGVyX2ZpbGVzKHJvb3QsIGZpbGVzLCBBUlJBWV9TSVpFKGZpbGVzKSwg
Z3QpOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19zc2V1
LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX3NzZXUuaApuZXcgZmlsZSBtb2Rl
IDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAwLi4xNmRhOGZiNWZlNGZlCi0tLSAvZGV2L251bGwK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19zc2V1LmgKQEAgLTAsMCArMSwx
NiBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVCAqLworCisvKgorICogQ29weXJp
Z2h0IMKpIDIwMjAgSW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisjaWZuZGVmIERFQlVHRlNfU1NF
VV9ICisjZGVmaW5lIERFQlVHRlNfU1NFVV9ICisKK3N0cnVjdCBpbnRlbF9ndDsKK3N0cnVjdCBk
ZW50cnk7CitzdHJ1Y3Qgc3NldV9kZXZfaW5mbzsKKwordm9pZCBkZWJ1Z2ZzX2d0X3JlZ2lzdGVy
X3NzZXUoc3RydWN0IGludGVsX2d0ICpndCwgc3RydWN0IGRlbnRyeSAqcm9vdCk7CisKKyNlbmRp
ZiAvKiBERUJVR0ZTX1NTRVVfSCAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9kZWJ1Z2ZzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwppbmRl
eCBiMjJiNGU5YzMxMzhiLi45YjZhNTA2MTQxMTBhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2RlYnVnZnMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rl
YnVnZnMuYwpAQCAtNDI2LDkgKzQyNiw4IEBAIHN0YXRpYyB2b2lkIGdlbjhfZGlzcGxheV9pbnRl
cnJ1cHRfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0pCiBzdGF0aWMgaW50IGk5MTVfaW50ZXJydXB0
X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQogewogCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKLQlzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmU7CiAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Ci0JaW50
IGksIHBpcGU7CisJaW50IHBpcGU7CiAKIAl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQo
JmRldl9wcml2LT5ydW50aW1lX3BtKTsKIApAQCAtNDc0LDE1ICs0NzMsNiBAQCBzdGF0aWMgaW50
IGk5MTVfaW50ZXJydXB0X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQogCQkJ
ICAgSTkxNV9SRUFEKERQSU5WR1RUKSk7CiAJCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9w
cml2LCBQT1dFUl9ET01BSU5fSU5JVCwgcHJlZik7CiAKLQkJZm9yIChpID0gMDsgaSA8IDQ7IGkr
KykgewotCQkJc2VxX3ByaW50ZihtLCAiR1QgSW50ZXJydXB0IElNUiAlZDpcdCUwOHhcbiIsCi0J
CQkJICAgaSwgSTkxNV9SRUFEKEdFTjhfR1RfSU1SKGkpKSk7Ci0JCQlzZXFfcHJpbnRmKG0sICJH
VCBJbnRlcnJ1cHQgSUlSICVkOlx0JTA4eFxuIiwKLQkJCQkgICBpLCBJOTE1X1JFQUQoR0VOOF9H
VF9JSVIoaSkpKTsKLQkJCXNlcV9wcmludGYobSwgIkdUIEludGVycnVwdCBJRVIgJWQ6XHQlMDh4
XG4iLAotCQkJCSAgIGksIEk5MTVfUkVBRChHRU44X0dUX0lFUihpKSkpOwotCQl9Ci0KIAkJc2Vx
X3ByaW50ZihtLCAiUENVIGludGVycnVwdCBtYXNrOlx0JTA4eFxuIiwKIAkJCSAgIEk5MTVfUkVB
RChHRU44X1BDVV9JTVIpKTsKIAkJc2VxX3ByaW50ZihtLCAiUENVIGludGVycnVwdCBpZGVudGl0
eTpcdCUwOHhcbiIsCkBAIC00OTMsMTkgKzQ4Myw2IEBAIHN0YXRpYyBpbnQgaTkxNV9pbnRlcnJ1
cHRfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCiAJCXNlcV9wcmludGYobSwg
Ik1hc3RlciBJbnRlcnJ1cHQgQ29udHJvbDogICUwOHhcbiIsCiAJCQkgICBJOTE1X1JFQUQoR0VO
MTFfR0ZYX01TVFJfSVJRKSk7CiAKLQkJc2VxX3ByaW50ZihtLCAiUmVuZGVyL0NvcHkgSW50ciBF
bmFibGU6ICAgJTA4eFxuIiwKLQkJCSAgIEk5MTVfUkVBRChHRU4xMV9SRU5ERVJfQ09QWV9JTlRS
X0VOQUJMRSkpOwotCQlzZXFfcHJpbnRmKG0sICJWQ1MvVkVDUyBJbnRyIEVuYWJsZTogICAgICAl
MDh4XG4iLAotCQkJICAgSTkxNV9SRUFEKEdFTjExX1ZDU19WRUNTX0lOVFJfRU5BQkxFKSk7Ci0J
CXNlcV9wcmludGYobSwgIkdVQy9TRyBJbnRyIEVuYWJsZTpcdCAgICUwOHhcbiIsCi0JCQkgICBJ
OTE1X1JFQUQoR0VOMTFfR1VDX1NHX0lOVFJfRU5BQkxFKSk7Ci0JCXNlcV9wcmludGYobSwgIkdQ
TS9XR0JPWFBFUkYgSW50ciBFbmFibGU6ICUwOHhcbiIsCi0JCQkgICBJOTE1X1JFQUQoR0VOMTFf
R1BNX1dHQk9YUEVSRl9JTlRSX0VOQUJMRSkpOwotCQlzZXFfcHJpbnRmKG0sICJDcnlwdG8gSW50
ciBFbmFibGU6XHQgICAlMDh4XG4iLAotCQkJICAgSTkxNV9SRUFEKEdFTjExX0NSWVBUT19SU1ZE
X0lOVFJfRU5BQkxFKSk7Ci0JCXNlcV9wcmludGYobSwgIkdVbml0L0NTTUUgSW50ciBFbmFibGU6
XHQgICAlMDh4XG4iLAotCQkJICAgSTkxNV9SRUFEKEdFTjExX0dVTklUX0NTTUVfSU5UUl9FTkFC
TEUpKTsKLQogCQlzZXFfcHJpbnRmKG0sICJEaXNwbGF5IEludGVycnVwdCBDb250cm9sOlx0JTA4
eFxuIiwKIAkJCSAgIEk5MTVfUkVBRChHRU4xMV9ESVNQTEFZX0lOVF9DVEwpKTsKIApAQCAtNTE0
LDE1ICs0OTEsNiBAQCBzdGF0aWMgaW50IGk5MTVfaW50ZXJydXB0X2luZm8oc3RydWN0IHNlcV9m
aWxlICptLCB2b2lkICpkYXRhKQogCQlzZXFfcHJpbnRmKG0sICJNYXN0ZXIgSW50ZXJydXB0IENv
bnRyb2w6XHQlMDh4XG4iLAogCQkJICAgSTkxNV9SRUFEKEdFTjhfTUFTVEVSX0lSUSkpOwogCi0J
CWZvciAoaSA9IDA7IGkgPCA0OyBpKyspIHsKLQkJCXNlcV9wcmludGYobSwgIkdUIEludGVycnVw
dCBJTVIgJWQ6XHQlMDh4XG4iLAotCQkJCSAgIGksIEk5MTVfUkVBRChHRU44X0dUX0lNUihpKSkp
OwotCQkJc2VxX3ByaW50ZihtLCAiR1QgSW50ZXJydXB0IElJUiAlZDpcdCUwOHhcbiIsCi0JCQkJ
ICAgaSwgSTkxNV9SRUFEKEdFTjhfR1RfSUlSKGkpKSk7Ci0JCQlzZXFfcHJpbnRmKG0sICJHVCBJ
bnRlcnJ1cHQgSUVSICVkOlx0JTA4eFxuIiwKLQkJCQkgICBpLCBJOTE1X1JFQUQoR0VOOF9HVF9J
RVIoaSkpKTsKLQkJfQotCiAJCWdlbjhfZGlzcGxheV9pbnRlcnJ1cHRfaW5mbyhtKTsKIAl9IGVs
c2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpKSB7CiAJCWludGVsX3dha2VyZWZfdCBwcmVm
OwpAQCAtNTU2LDIwICs1MjQsNiBAQCBzdGF0aWMgaW50IGk5MTVfaW50ZXJydXB0X2luZm8oc3Ry
dWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQogCQlzZXFfcHJpbnRmKG0sICJNYXN0ZXIgSUVS
Olx0JTA4eFxuIiwKIAkJCSAgIEk5MTVfUkVBRChWTFZfTUFTVEVSX0lFUikpOwogCi0JCXNlcV9w
cmludGYobSwgIlJlbmRlciBJRVI6XHQlMDh4XG4iLAotCQkJICAgSTkxNV9SRUFEKEdUSUVSKSk7
Ci0JCXNlcV9wcmludGYobSwgIlJlbmRlciBJSVI6XHQlMDh4XG4iLAotCQkJICAgSTkxNV9SRUFE
KEdUSUlSKSk7Ci0JCXNlcV9wcmludGYobSwgIlJlbmRlciBJTVI6XHQlMDh4XG4iLAotCQkJICAg
STkxNV9SRUFEKEdUSU1SKSk7Ci0KLQkJc2VxX3ByaW50ZihtLCAiUE0gSUVSOlx0XHQlMDh4XG4i
LAotCQkJICAgSTkxNV9SRUFEKEdFTjZfUE1JRVIpKTsKLQkJc2VxX3ByaW50ZihtLCAiUE0gSUlS
Olx0XHQlMDh4XG4iLAotCQkJICAgSTkxNV9SRUFEKEdFTjZfUE1JSVIpKTsKLQkJc2VxX3ByaW50
ZihtLCAiUE0gSU1SOlx0XHQlMDh4XG4iLAotCQkJICAgSTkxNV9SRUFEKEdFTjZfUE1JTVIpKTsK
LQogCQlwcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJ
Tl9JTklUKTsKIAkJc2VxX3ByaW50ZihtLCAiUG9ydCBob3RwbHVnOlx0JTA4eFxuIiwKIAkJCSAg
IEk5MTVfUkVBRChQT1JUX0hPVFBMVUdfRU4pKTsKQEAgLTYwMyw0MCArNTU3LDYgQEAgc3RhdGlj
IGludCBpOTE1X2ludGVycnVwdF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkK
IAkJCSAgIEk5MTVfUkVBRChTREVJSVIpKTsKIAkJc2VxX3ByaW50ZihtLCAiU291dGggRGlzcGxh
eSBJbnRlcnJ1cHQgbWFzazoJCSUwOHhcbiIsCiAJCQkgICBJOTE1X1JFQUQoU0RFSU1SKSk7Ci0J
CXNlcV9wcmludGYobSwgIkdyYXBoaWNzIEludGVycnVwdCBlbmFibGU6CQklMDh4XG4iLAotCQkJ
ICAgSTkxNV9SRUFEKEdUSUVSKSk7Ci0JCXNlcV9wcmludGYobSwgIkdyYXBoaWNzIEludGVycnVw
dCBpZGVudGl0eToJCSUwOHhcbiIsCi0JCQkgICBJOTE1X1JFQUQoR1RJSVIpKTsKLQkJc2VxX3By
aW50ZihtLCAiR3JhcGhpY3MgSW50ZXJydXB0IG1hc2s6CQklMDh4XG4iLAotCQkJICAgSTkxNV9S
RUFEKEdUSU1SKSk7Ci0JfQotCi0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpIHsKLQkJ
c2VxX3ByaW50ZihtLCAiUkNTIEludHIgTWFzazpcdCAlMDh4XG4iLAotCQkJICAgSTkxNV9SRUFE
KEdFTjExX1JDUzBfUlNWRF9JTlRSX01BU0spKTsKLQkJc2VxX3ByaW50ZihtLCAiQkNTIEludHIg
TWFzazpcdCAlMDh4XG4iLAotCQkJICAgSTkxNV9SRUFEKEdFTjExX0JDU19SU1ZEX0lOVFJfTUFT
SykpOwotCQlzZXFfcHJpbnRmKG0sICJWQ1MwL1ZDUzEgSW50ciBNYXNrOlx0ICUwOHhcbiIsCi0J
CQkgICBJOTE1X1JFQUQoR0VOMTFfVkNTMF9WQ1MxX0lOVFJfTUFTSykpOwotCQlzZXFfcHJpbnRm
KG0sICJWQ1MyL1ZDUzMgSW50ciBNYXNrOlx0ICUwOHhcbiIsCi0JCQkgICBJOTE1X1JFQUQoR0VO
MTFfVkNTMl9WQ1MzX0lOVFJfTUFTSykpOwotCQlzZXFfcHJpbnRmKG0sICJWRUNTMC9WRUNTMSBJ
bnRyIE1hc2s6XHQgJTA4eFxuIiwKLQkJCSAgIEk5MTVfUkVBRChHRU4xMV9WRUNTMF9WRUNTMV9J
TlRSX01BU0spKTsKLQkJc2VxX3ByaW50ZihtLCAiR1VDL1NHIEludHIgTWFzazpcdCAlMDh4XG4i
LAotCQkJICAgSTkxNV9SRUFEKEdFTjExX0dVQ19TR19JTlRSX01BU0spKTsKLQkJc2VxX3ByaW50
ZihtLCAiR1BNL1dHQk9YUEVSRiBJbnRyIE1hc2s6ICUwOHhcbiIsCi0JCQkgICBJOTE1X1JFQUQo
R0VOMTFfR1BNX1dHQk9YUEVSRl9JTlRSX01BU0spKTsKLQkJc2VxX3ByaW50ZihtLCAiQ3J5cHRv
IEludHIgTWFzazpcdCAlMDh4XG4iLAotCQkJICAgSTkxNV9SRUFEKEdFTjExX0NSWVBUT19SU1ZE
X0lOVFJfTUFTSykpOwotCQlzZXFfcHJpbnRmKG0sICJHdW5pdC9DU01FIEludHIgTWFzazpcdCAl
MDh4XG4iLAotCQkJICAgSTkxNV9SRUFEKEdFTjExX0dVTklUX0NTTUVfSU5UUl9NQVNLKSk7Ci0K
LQl9IGVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNikgewotCQlmb3JfZWFjaF91YWJp
X2VuZ2luZShlbmdpbmUsIGRldl9wcml2KSB7Ci0JCQlzZXFfcHJpbnRmKG0sCi0JCQkJICAgIkdy
YXBoaWNzIEludGVycnVwdCBtYXNrICglcyk6CSUwOHhcbiIsCi0JCQkJICAgZW5naW5lLT5uYW1l
LCBFTkdJTkVfUkVBRChlbmdpbmUsIFJJTkdfSU1SKSk7Ci0JCX0KIAl9CiAKIAlpbnRlbF9ydW50
aW1lX3BtX3B1dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwpAQCAtMTMwNCwxNiAr
MTIyNCw2IEBAIHN0YXRpYyBpbnQgaTkxNV9lbmdpbmVfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0s
IHZvaWQgKnVudXNlZCkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBpOTE1X3Jjc190b3Bv
bG9neShzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKLXsKLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Ci0Jc3RydWN0
IGRybV9wcmludGVyIHAgPSBkcm1fc2VxX2ZpbGVfcHJpbnRlcihtKTsKLQotCWludGVsX2Rldmlj
ZV9pbmZvX3ByaW50X3RvcG9sb2d5KCZSVU5USU1FX0lORk8oZGV2X3ByaXYpLT5zc2V1LCAmcCk7
Ci0KLQlyZXR1cm4gMDsKLX0KLQogc3RhdGljIGludCBpOTE1X3Nocmlua2VyX2luZm8oc3RydWN0
IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7CkBAIC0xNTU4LDI2NiArMTQ2OCwxMCBA
QCBpOTE1X2NhY2hlX3NoYXJpbmdfc2V0KHZvaWQgKmRhdGEsIHU2NCB2YWwpCiAJcmV0dXJuIDA7
CiB9CiAKLXN0YXRpYyB2b2lkCi1pbnRlbF9zc2V1X2NvcHlfc3Vic2xpY2VzKGNvbnN0IHN0cnVj
dCBzc2V1X2Rldl9pbmZvICpzc2V1LCBpbnQgc2xpY2UsCi0JCQkgIHU4ICp0b19tYXNrKQotewot
CWludCBvZmZzZXQgPSBzbGljZSAqIHNzZXUtPnNzX3N0cmlkZTsKLQotCW1lbWNweSgmdG9fbWFz
a1tvZmZzZXRdLCAmc3NldS0+c3Vic2xpY2VfbWFza1tvZmZzZXRdLCBzc2V1LT5zc19zdHJpZGUp
OwotfQotCiBERUZJTkVfU0lNUExFX0FUVFJJQlVURShpOTE1X2NhY2hlX3NoYXJpbmdfZm9wcywK
IAkJCWk5MTVfY2FjaGVfc2hhcmluZ19nZXQsIGk5MTVfY2FjaGVfc2hhcmluZ19zZXQsCiAJCQki
JWxsdVxuIik7CiAKLXN0YXRpYyB2b2lkIGNoZXJyeXZpZXdfc3NldV9kZXZpY2Vfc3RhdHVzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkJICBzdHJ1Y3Qgc3NldV9kZXZf
aW5mbyAqc3NldSkKLXsKLSNkZWZpbmUgU1NfTUFYIDIKLQljb25zdCBpbnQgc3NfbWF4ID0gU1Nf
TUFYOwotCXUzMiBzaWcxW1NTX01BWF0sIHNpZzJbU1NfTUFYXTsKLQlpbnQgc3M7Ci0KLQlzaWcx
WzBdID0gSTkxNV9SRUFEKENIVl9QT1dFUl9TUzBfU0lHMSk7Ci0Jc2lnMVsxXSA9IEk5MTVfUkVB
RChDSFZfUE9XRVJfU1MxX1NJRzEpOwotCXNpZzJbMF0gPSBJOTE1X1JFQUQoQ0hWX1BPV0VSX1NT
MF9TSUcyKTsKLQlzaWcyWzFdID0gSTkxNV9SRUFEKENIVl9QT1dFUl9TUzFfU0lHMik7Ci0KLQlm
b3IgKHNzID0gMDsgc3MgPCBzc19tYXg7IHNzKyspIHsKLQkJdW5zaWduZWQgaW50IGV1X2NudDsK
LQotCQlpZiAoc2lnMVtzc10gJiBDSFZfU1NfUEdfRU5BQkxFKQotCQkJLyogc2tpcCBkaXNhYmxl
ZCBzdWJzbGljZSAqLwotCQkJY29udGludWU7Ci0KLQkJc3NldS0+c2xpY2VfbWFzayA9IEJJVCgw
KTsKLQkJc3NldS0+c3Vic2xpY2VfbWFza1swXSB8PSBCSVQoc3MpOwotCQlldV9jbnQgPSAoKHNp
ZzFbc3NdICYgQ0hWX0VVMDhfUEdfRU5BQkxFKSA/IDAgOiAyKSArCi0JCQkgKChzaWcxW3NzXSAm
IENIVl9FVTE5X1BHX0VOQUJMRSkgPyAwIDogMikgKwotCQkJICgoc2lnMVtzc10gJiBDSFZfRVUy
MTBfUEdfRU5BQkxFKSA/IDAgOiAyKSArCi0JCQkgKChzaWcyW3NzXSAmIENIVl9FVTMxMV9QR19F
TkFCTEUpID8gMCA6IDIpOwotCQlzc2V1LT5ldV90b3RhbCArPSBldV9jbnQ7Ci0JCXNzZXUtPmV1
X3Blcl9zdWJzbGljZSA9IG1heF90KHVuc2lnbmVkIGludCwKLQkJCQkJICAgICAgc3NldS0+ZXVf
cGVyX3N1YnNsaWNlLCBldV9jbnQpOwotCX0KLSN1bmRlZiBTU19NQVgKLX0KLQotc3RhdGljIHZv
aWQgZ2VuMTBfc3NldV9kZXZpY2Vfc3RhdHVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKLQkJCQkgICAgIHN0cnVjdCBzc2V1X2Rldl9pbmZvICpzc2V1KQotewotI2RlZmluZSBT
U19NQVggNgotCWNvbnN0IHN0cnVjdCBpbnRlbF9ydW50aW1lX2luZm8gKmluZm8gPSBSVU5USU1F
X0lORk8oZGV2X3ByaXYpOwotCXUzMiBzX3JlZ1tTU19NQVhdLCBldV9yZWdbMiAqIFNTX01BWF0s
IGV1X21hc2tbMl07Ci0JaW50IHMsIHNzOwotCi0JZm9yIChzID0gMDsgcyA8IGluZm8tPnNzZXUu
bWF4X3NsaWNlczsgcysrKSB7Ci0JCS8qCi0JCSAqIEZJWE1FOiBWYWxpZCBTUyBNYXNrIHJlc3Bl
Y3RzIHRoZSBzcGVjIGFuZCByZWFkCi0JCSAqIG9ubHkgdmFsaWQgYml0cyBmb3IgdGhvc2UgcmVn
aXN0ZXJzLCBleGNsdWRpbmcgcmVzZXJ2ZWQKLQkJICogYWx0aG91Z2ggdGhpcyBzZWVtcyB3cm9u
ZyBiZWNhdXNlIGl0IHdvdWxkIGxlYXZlIG1hbnkKLQkJICogc3Vic2xpY2VzIHdpdGhvdXQgQUNL
LgotCQkgKi8KLQkJc19yZWdbc10gPSBJOTE1X1JFQUQoR0VOMTBfU0xJQ0VfUEdDVExfQUNLKHMp
KSAmCi0JCQlHRU4xMF9QR0NUTF9WQUxJRF9TU19NQVNLKHMpOwotCQlldV9yZWdbMiAqIHNdID0g
STkxNV9SRUFEKEdFTjEwX1NTMDFfRVVfUEdDVExfQUNLKHMpKTsKLQkJZXVfcmVnWzIgKiBzICsg
MV0gPSBJOTE1X1JFQUQoR0VOMTBfU1MyM19FVV9QR0NUTF9BQ0socykpOwotCX0KLQotCWV1X21h
c2tbMF0gPSBHRU45X1BHQ1RMX1NTQV9FVTA4X0FDSyB8Ci0JCSAgICAgR0VOOV9QR0NUTF9TU0Ff
RVUxOV9BQ0sgfAotCQkgICAgIEdFTjlfUEdDVExfU1NBX0VVMjEwX0FDSyB8Ci0JCSAgICAgR0VO
OV9QR0NUTF9TU0FfRVUzMTFfQUNLOwotCWV1X21hc2tbMV0gPSBHRU45X1BHQ1RMX1NTQl9FVTA4
X0FDSyB8Ci0JCSAgICAgR0VOOV9QR0NUTF9TU0JfRVUxOV9BQ0sgfAotCQkgICAgIEdFTjlfUEdD
VExfU1NCX0VVMjEwX0FDSyB8Ci0JCSAgICAgR0VOOV9QR0NUTF9TU0JfRVUzMTFfQUNLOwotCi0J
Zm9yIChzID0gMDsgcyA8IGluZm8tPnNzZXUubWF4X3NsaWNlczsgcysrKSB7Ci0JCWlmICgoc19y
ZWdbc10gJiBHRU45X1BHQ1RMX1NMSUNFX0FDSykgPT0gMCkKLQkJCS8qIHNraXAgZGlzYWJsZWQg
c2xpY2UgKi8KLQkJCWNvbnRpbnVlOwotCi0JCXNzZXUtPnNsaWNlX21hc2sgfD0gQklUKHMpOwot
CQlpbnRlbF9zc2V1X2NvcHlfc3Vic2xpY2VzKCZpbmZvLT5zc2V1LCBzLCBzc2V1LT5zdWJzbGlj
ZV9tYXNrKTsKLQotCQlmb3IgKHNzID0gMDsgc3MgPCBpbmZvLT5zc2V1Lm1heF9zdWJzbGljZXM7
IHNzKyspIHsKLQkJCXVuc2lnbmVkIGludCBldV9jbnQ7Ci0KLQkJCWlmIChpbmZvLT5zc2V1Lmhh
c19zdWJzbGljZV9wZyAmJgotCQkJICAgICEoc19yZWdbc10gJiAoR0VOOV9QR0NUTF9TU19BQ0so
c3MpKSkpCi0JCQkJLyogc2tpcCBkaXNhYmxlZCBzdWJzbGljZSAqLwotCQkJCWNvbnRpbnVlOwot
Ci0JCQlldV9jbnQgPSAyICogaHdlaWdodDMyKGV1X3JlZ1syICogcyArIHNzIC8gMl0gJgotCQkJ
CQkgICAgICAgZXVfbWFza1tzcyAlIDJdKTsKLQkJCXNzZXUtPmV1X3RvdGFsICs9IGV1X2NudDsK
LQkJCXNzZXUtPmV1X3Blcl9zdWJzbGljZSA9IG1heF90KHVuc2lnbmVkIGludCwKLQkJCQkJCSAg
ICAgIHNzZXUtPmV1X3Blcl9zdWJzbGljZSwKLQkJCQkJCSAgICAgIGV1X2NudCk7Ci0JCX0KLQl9
Ci0jdW5kZWYgU1NfTUFYCi19Ci0KLXN0YXRpYyB2b2lkIGdlbjlfc3NldV9kZXZpY2Vfc3RhdHVz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkgICAgc3RydWN0IHNzZXVf
ZGV2X2luZm8gKnNzZXUpCi17Ci0jZGVmaW5lIFNTX01BWCAzCi0JY29uc3Qgc3RydWN0IGludGVs
X3J1bnRpbWVfaW5mbyAqaW5mbyA9IFJVTlRJTUVfSU5GTyhkZXZfcHJpdik7Ci0JdTMyIHNfcmVn
W1NTX01BWF0sIGV1X3JlZ1syICogU1NfTUFYXSwgZXVfbWFza1syXTsKLQlpbnQgcywgc3M7Ci0K
LQlmb3IgKHMgPSAwOyBzIDwgaW5mby0+c3NldS5tYXhfc2xpY2VzOyBzKyspIHsKLQkJc19yZWdb
c10gPSBJOTE1X1JFQUQoR0VOOV9TTElDRV9QR0NUTF9BQ0socykpOwotCQlldV9yZWdbMipzXSA9
IEk5MTVfUkVBRChHRU45X1NTMDFfRVVfUEdDVExfQUNLKHMpKTsKLQkJZXVfcmVnWzIqcyArIDFd
ID0gSTkxNV9SRUFEKEdFTjlfU1MyM19FVV9QR0NUTF9BQ0socykpOwotCX0KLQotCWV1X21hc2tb
MF0gPSBHRU45X1BHQ1RMX1NTQV9FVTA4X0FDSyB8Ci0JCSAgICAgR0VOOV9QR0NUTF9TU0FfRVUx
OV9BQ0sgfAotCQkgICAgIEdFTjlfUEdDVExfU1NBX0VVMjEwX0FDSyB8Ci0JCSAgICAgR0VOOV9Q
R0NUTF9TU0FfRVUzMTFfQUNLOwotCWV1X21hc2tbMV0gPSBHRU45X1BHQ1RMX1NTQl9FVTA4X0FD
SyB8Ci0JCSAgICAgR0VOOV9QR0NUTF9TU0JfRVUxOV9BQ0sgfAotCQkgICAgIEdFTjlfUEdDVExf
U1NCX0VVMjEwX0FDSyB8Ci0JCSAgICAgR0VOOV9QR0NUTF9TU0JfRVUzMTFfQUNLOwotCi0JZm9y
IChzID0gMDsgcyA8IGluZm8tPnNzZXUubWF4X3NsaWNlczsgcysrKSB7Ci0JCWlmICgoc19yZWdb
c10gJiBHRU45X1BHQ1RMX1NMSUNFX0FDSykgPT0gMCkKLQkJCS8qIHNraXAgZGlzYWJsZWQgc2xp
Y2UgKi8KLQkJCWNvbnRpbnVlOwotCi0JCXNzZXUtPnNsaWNlX21hc2sgfD0gQklUKHMpOwotCi0J
CWlmIChJU19HRU45X0JDKGRldl9wcml2KSkKLQkJCWludGVsX3NzZXVfY29weV9zdWJzbGljZXMo
JmluZm8tPnNzZXUsIHMsCi0JCQkJCQkgIHNzZXUtPnN1YnNsaWNlX21hc2spOwotCi0JCWZvciAo
c3MgPSAwOyBzcyA8IGluZm8tPnNzZXUubWF4X3N1YnNsaWNlczsgc3MrKykgewotCQkJdW5zaWdu
ZWQgaW50IGV1X2NudDsKLQkJCXU4IHNzX2lkeCA9IHMgKiBpbmZvLT5zc2V1LnNzX3N0cmlkZSAr
Ci0JCQkJICAgIHNzIC8gQklUU19QRVJfQllURTsKLQotCQkJaWYgKElTX0dFTjlfTFAoZGV2X3By
aXYpKSB7Ci0JCQkJaWYgKCEoc19yZWdbc10gJiAoR0VOOV9QR0NUTF9TU19BQ0soc3MpKSkpCi0J
CQkJCS8qIHNraXAgZGlzYWJsZWQgc3Vic2xpY2UgKi8KLQkJCQkJY29udGludWU7Ci0KLQkJCQlz
c2V1LT5zdWJzbGljZV9tYXNrW3NzX2lkeF0gfD0KLQkJCQkJQklUKHNzICUgQklUU19QRVJfQllU
RSk7Ci0JCQl9Ci0KLQkJCWV1X2NudCA9IDIgKiBod2VpZ2h0MzIoZXVfcmVnWzIqcyArIHNzLzJd
ICYKLQkJCQkJICAgICAgIGV1X21hc2tbc3MlMl0pOwotCQkJc3NldS0+ZXVfdG90YWwgKz0gZXVf
Y250OwotCQkJc3NldS0+ZXVfcGVyX3N1YnNsaWNlID0gbWF4X3QodW5zaWduZWQgaW50LAotCQkJ
CQkJICAgICAgc3NldS0+ZXVfcGVyX3N1YnNsaWNlLAotCQkJCQkJICAgICAgZXVfY250KTsKLQkJ
fQotCX0KLSN1bmRlZiBTU19NQVgKLX0KLQotc3RhdGljIHZvaWQgYmR3X3NzZXVfZGV2aWNlX3N0
YXR1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0JCQkJICAgc3RydWN0IHNz
ZXVfZGV2X2luZm8gKnNzZXUpCi17Ci0JY29uc3Qgc3RydWN0IGludGVsX3J1bnRpbWVfaW5mbyAq
aW5mbyA9IFJVTlRJTUVfSU5GTyhkZXZfcHJpdik7Ci0JdTMyIHNsaWNlX2luZm8gPSBJOTE1X1JF
QUQoR0VOOF9HVF9TTElDRV9JTkZPKTsKLQlpbnQgczsKLQotCXNzZXUtPnNsaWNlX21hc2sgPSBz
bGljZV9pbmZvICYgR0VOOF9MU0xJQ0VTVEFUX01BU0s7Ci0KLQlpZiAoc3NldS0+c2xpY2VfbWFz
aykgewotCQlzc2V1LT5ldV9wZXJfc3Vic2xpY2UgPSBpbmZvLT5zc2V1LmV1X3Blcl9zdWJzbGlj
ZTsKLQkJZm9yIChzID0gMDsgcyA8IGZscyhzc2V1LT5zbGljZV9tYXNrKTsgcysrKQotCQkJaW50
ZWxfc3NldV9jb3B5X3N1YnNsaWNlcygmaW5mby0+c3NldSwgcywKLQkJCQkJCSAgc3NldS0+c3Vi
c2xpY2VfbWFzayk7Ci0JCXNzZXUtPmV1X3RvdGFsID0gc3NldS0+ZXVfcGVyX3N1YnNsaWNlICoK
LQkJCQkgaW50ZWxfc3NldV9zdWJzbGljZV90b3RhbChzc2V1KTsKLQotCQkvKiBzdWJ0cmFjdCBm
dXNlZCBvZmYgRVUocykgZnJvbSBlbmFibGVkIHNsaWNlKHMpICovCi0JCWZvciAocyA9IDA7IHMg
PCBmbHMoc3NldS0+c2xpY2VfbWFzayk7IHMrKykgewotCQkJdTggc3Vic2xpY2VfN2V1ID0gaW5m
by0+c3NldS5zdWJzbGljZV83ZXVbc107Ci0KLQkJCXNzZXUtPmV1X3RvdGFsIC09IGh3ZWlnaHQ4
KHN1YnNsaWNlXzdldSk7Ci0JCX0KLQl9Ci19Ci0KLXN0YXRpYyB2b2lkIGk5MTVfcHJpbnRfc3Nl
dV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgYm9vbCBpc19hdmFpbGFibGVfaW5mbywKLQkJCQkg
Y29uc3Qgc3RydWN0IHNzZXVfZGV2X2luZm8gKnNzZXUpCi17Ci0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwotCWNvbnN0IGNoYXIg
KnR5cGUgPSBpc19hdmFpbGFibGVfaW5mbyA/ICJBdmFpbGFibGUiIDogIkVuYWJsZWQiOwotCWlu
dCBzOwotCi0Jc2VxX3ByaW50ZihtLCAiICAlcyBTbGljZSBNYXNrOiAlMDR4XG4iLCB0eXBlLAot
CQkgICBzc2V1LT5zbGljZV9tYXNrKTsKLQlzZXFfcHJpbnRmKG0sICIgICVzIFNsaWNlIFRvdGFs
OiAldVxuIiwgdHlwZSwKLQkJICAgaHdlaWdodDgoc3NldS0+c2xpY2VfbWFzaykpOwotCXNlcV9w
cmludGYobSwgIiAgJXMgU3Vic2xpY2UgVG90YWw6ICV1XG4iLCB0eXBlLAotCQkgICBpbnRlbF9z
c2V1X3N1YnNsaWNlX3RvdGFsKHNzZXUpKTsKLQlmb3IgKHMgPSAwOyBzIDwgZmxzKHNzZXUtPnNs
aWNlX21hc2spOyBzKyspIHsKLQkJc2VxX3ByaW50ZihtLCAiICAlcyBTbGljZSVpIHN1YnNsaWNl
czogJXVcbiIsIHR5cGUsCi0JCQkgICBzLCBpbnRlbF9zc2V1X3N1YnNsaWNlc19wZXJfc2xpY2Uo
c3NldSwgcykpOwotCX0KLQlzZXFfcHJpbnRmKG0sICIgICVzIEVVIFRvdGFsOiAldVxuIiwgdHlw
ZSwKLQkJICAgc3NldS0+ZXVfdG90YWwpOwotCXNlcV9wcmludGYobSwgIiAgJXMgRVUgUGVyIFN1
YnNsaWNlOiAldVxuIiwgdHlwZSwKLQkJICAgc3NldS0+ZXVfcGVyX3N1YnNsaWNlKTsKLQotCWlm
ICghaXNfYXZhaWxhYmxlX2luZm8pCi0JCXJldHVybjsKLQotCXNlcV9wcmludGYobSwgIiAgSGFz
IFBvb2xlZCBFVTogJXNcbiIsIHllc25vKEhBU19QT09MRURfRVUoZGV2X3ByaXYpKSk7Ci0JaWYg
KEhBU19QT09MRURfRVUoZGV2X3ByaXYpKQotCQlzZXFfcHJpbnRmKG0sICIgIE1pbiBFVSBpbiBw
b29sOiAldVxuIiwgc3NldS0+bWluX2V1X2luX3Bvb2wpOwotCi0Jc2VxX3ByaW50ZihtLCAiICBI
YXMgU2xpY2UgUG93ZXIgR2F0aW5nOiAlc1xuIiwKLQkJICAgeWVzbm8oc3NldS0+aGFzX3NsaWNl
X3BnKSk7Ci0Jc2VxX3ByaW50ZihtLCAiICBIYXMgU3Vic2xpY2UgUG93ZXIgR2F0aW5nOiAlc1xu
IiwKLQkJICAgeWVzbm8oc3NldS0+aGFzX3N1YnNsaWNlX3BnKSk7Ci0Jc2VxX3ByaW50ZihtLCAi
ICBIYXMgRVUgUG93ZXIgR2F0aW5nOiAlc1xuIiwKLQkJICAgeWVzbm8oc3NldS0+aGFzX2V1X3Bn
KSk7Ci19Ci0KLXN0YXRpYyBpbnQgaTkxNV9zc2V1X3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0s
IHZvaWQgKnVudXNlZCkKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBu
b2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Ci0JY29uc3Qgc3RydWN0IGludGVsX3J1bnRpbWVfaW5m
byAqaW5mbyA9IFJVTlRJTUVfSU5GTyhkZXZfcHJpdik7Ci0Jc3RydWN0IHNzZXVfZGV2X2luZm8g
c3NldTsKLQlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKLQotCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpIDwgOCkKLQkJcmV0dXJuIC1FTk9ERVY7Ci0KLQlzZXFfcHV0cyhtLCAiU1NFVSBEZXZpY2Ug
SW5mb1xuIik7Ci0JaTkxNV9wcmludF9zc2V1X2luZm8obSwgdHJ1ZSwgJmluZm8tPnNzZXUpOwot
Ci0Jc2VxX3B1dHMobSwgIlNTRVUgRGV2aWNlIFN0YXR1c1xuIik7Ci0JbWVtc2V0KCZzc2V1LCAw
LCBzaXplb2Yoc3NldSkpOwotCWludGVsX3NzZXVfc2V0X2luZm8oJnNzZXUsIGluZm8tPnNzZXUu
bWF4X3NsaWNlcywKLQkJCSAgICBpbmZvLT5zc2V1Lm1heF9zdWJzbGljZXMsCi0JCQkgICAgaW5m
by0+c3NldS5tYXhfZXVzX3Blcl9zdWJzbGljZSk7Ci0KLQl3aXRoX2ludGVsX3J1bnRpbWVfcG0o
JmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtlcmVmKSB7Ci0JCWlmIChJU19DSEVSUllWSUVXKGRl
dl9wcml2KSkKLQkJCWNoZXJyeXZpZXdfc3NldV9kZXZpY2Vfc3RhdHVzKGRldl9wcml2LCAmc3Nl
dSk7Ci0JCWVsc2UgaWYgKElTX0JST0FEV0VMTChkZXZfcHJpdikpCi0JCQliZHdfc3NldV9kZXZp
Y2Vfc3RhdHVzKGRldl9wcml2LCAmc3NldSk7Ci0JCWVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwg
OSkpCi0JCQlnZW45X3NzZXVfZGV2aWNlX3N0YXR1cyhkZXZfcHJpdiwgJnNzZXUpOwotCQllbHNl
IGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwKQotCQkJZ2VuMTBfc3NldV9kZXZpY2Vfc3Rh
dHVzKGRldl9wcml2LCAmc3NldSk7Ci0JfQotCi0JaTkxNV9wcmludF9zc2V1X2luZm8obSwgZmFs
c2UsICZzc2V1KTsKLQotCXJldHVybiAwOwotfQotCiBzdGF0aWMgaW50IGk5MTVfZm9yY2V3YWtl
X29wZW4oc3RydWN0IGlub2RlICppbm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpCiB7CiAJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBpbm9kZS0+aV9wcml2YXRlOwpAQCAtMTg2MiwxMCAr
MTUxNiw4IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2luZm9fbGlzdCBpOTE1X2RlYnVnZnNf
bGlzdFtdID0gewogCXsiaTkxNV9sbGMiLCBpOTE1X2xsYywgMH0sCiAJeyJpOTE1X3J1bnRpbWVf
cG1fc3RhdHVzIiwgaTkxNV9ydW50aW1lX3BtX3N0YXR1cywgMH0sCiAJeyJpOTE1X2VuZ2luZV9p
bmZvIiwgaTkxNV9lbmdpbmVfaW5mbywgMH0sCi0JeyJpOTE1X3Jjc190b3BvbG9neSIsIGk5MTVf
cmNzX3RvcG9sb2d5LCAwfSwKIAl7Imk5MTVfc2hyaW5rZXJfaW5mbyIsIGk5MTVfc2hyaW5rZXJf
aW5mbywgMH0sCiAJeyJpOTE1X3dhX3JlZ2lzdGVycyIsIGk5MTVfd2FfcmVnaXN0ZXJzLCAwfSwK
LQl7Imk5MTVfc3NldV9zdGF0dXMiLCBpOTE1X3NzZXVfc3RhdHVzLCAwfSwKIAl7Imk5MTVfcnBz
X2Jvb3N0X2luZm8iLCBpOTE1X3Jwc19ib29zdF9pbmZvLCAwfSwKIH07CiAjZGVmaW5lIEk5MTVf
REVCVUdGU19FTlRSSUVTIEFSUkFZX1NJWkUoaTkxNV9kZWJ1Z2ZzX2xpc3QpCi0tIAoyLjI1LjEK
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdm
eCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xp
c3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeAo=

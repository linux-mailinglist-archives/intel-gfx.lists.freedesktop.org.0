Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id DC1F1BB590
	for <lists+intel-gfx@lfdr.de>; Mon, 23 Sep 2019 15:39:28 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id BF00C6E90B;
	Mon, 23 Sep 2019 13:39:26 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 607CB6E90B
 for <intel-gfx@lists.freedesktop.org>; Mon, 23 Sep 2019 13:39:25 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 18587623-1500050 for multiple; Mon, 23 Sep 2019 14:39:24 +0100
MIME-Version: 1.0
From: Chris Wilson <chris@chris-wilson.co.uk>
User-Agent: alot/0.6
To: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>,
 intel-gfx@lists.freedesktop.org
References: <20190921095542.23205-1-chris@chris-wilson.co.uk>
 <20190921095542.23205-3-chris@chris-wilson.co.uk>
 <7386c6e5-96df-5f57-0b9a-214787cdad57@linux.intel.com>
In-Reply-To: <7386c6e5-96df-5f57-0b9a-214787cdad57@linux.intel.com>
Message-ID: <156924595998.29097.6410793778914589365@skylake-alporthouse-com>
Date: Mon, 23 Sep 2019 14:39:20 +0100
Subject: Re: [Intel-gfx] [PATCH 3/5] drm/i915: Fixup preempt-to-busy vs
 resubmission of a virtual request
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVvdGluZyBUdnJ0a28gVXJzdWxpbiAoMjAxOS0wOS0yMyAxNDozMjoyMykKPiAKPiBPbiAyMS8w
OS8yMDE5IDEwOjU1LCBDaHJpcyBXaWxzb24gd3JvdGU6Cj4gPiBBcyBwcmVlbXB0LXRvLWJ1c3kg
bGVhdmVzIHRoZSByZXF1ZXN0IG9uIHRoZSBIVyBhcyB0aGUgcmVzdWJtaXNzaW9uIGlzCj4gPiBw
cm9jZXNzZWQsIHRoYXQgcmVxdWVzdCBtYXkgY29tcGxldGUgaW4gdGhlIGJhY2tncm91bmQgYW5k
IGV2ZW4gY2F1c2UgYQo+ID4gc2Vjb25kIHZpcnR1YWwgcmVxdWVzdCB0byBlbnRlciBxdWV1ZS4g
VGhpcyBzZWNvbmQgdmlydHVhbCByZXF1ZXN0Cj4gPiBicmVha3Mgb3VyICJzaW5nbGUgcmVxdWVz
dCBpbiB0aGUgdmlydHVhbCBwaXBlbGluZSIgYXNzdW1wdGlvbnMuCj4gPiBGdXJ0aGVybW9yZSwg
YXMgdGhlIHZpcnR1YWwgcmVxdWVzdCBtYXkgYmUgY29tcGxldGVkIGFuZCByZXRpcmVkLCB3ZQo+
ID4gbG9zZSB0aGUgcmVmZXJlbmNlIHRoZSB2aXJ0dWFsIGVuZ2luZSBhc3N1bWVzIGlzIGhlbGQu
IE5vcm1hbGx5LCBqdXN0Cj4gPiByZW1vdmluZyB0aGUgcmVxdWVzdCBmcm9tIHRoZSBzY2hlZHVs
ZXIgcXVldWUgcmVtb3ZlcyBpdCBmcm9tIHRoZQo+ID4gZW5naW5lLCBidXQgdGhlIHZpcnR1YWwg
ZW5naW5lIGtlZXBzIHRyYWNrIG9mIGl0cyBzaW5nbGV0b24gcmVxdWVzdCB2aWEKPiA+IGl0cyB2
ZS0+cmVxdWVzdC4gVGhpcyBwb2ludGVyIG5lZWRzIHByb3RlY3Rpbmcgd2l0aCBhIHJlZmVyZW5j
ZS4KPiA+IAo+ID4gRml4ZXM6IDIyYjdhNDI2YmJlMSAoImRybS9pOTE1L2V4ZWNsaXN0czogUHJl
ZW1wdC10by1idXN5IikKPiA+IFNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hy
aXMtd2lsc29uLmNvLnVrPgo+ID4gQ2M6IE1pa2EgS3VvcHBhbGEgPG1pa2Eua3VvcHBhbGFAbGlu
dXguaW50ZWwuY29tPgo+ID4gQ2M6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBpbnRl
bC5jb20+Cj4gPiAtLS0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMg
fCAzNCArKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLQo+ID4gICAxIGZpbGUgY2hhbmdlZCwg
MjYgaW5zZXJ0aW9ucygrKSwgOCBkZWxldGlvbnMoLSkKPiA+IAo+ID4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfbHJjLmMKPiA+IGluZGV4IDUzYmM0MzA4NzkzYy4uMWIyYmFjYzYwMzAwIDEwMDY0
NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKPiA+ICsrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCj4gPiBAQCAtNTI5LDcgKzUyOSw2
IEBAIF9fdW53aW5kX2luY29tcGxldGVfcmVxdWVzdHMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lKQo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaTkxNV9yZXF1ZXN0X2Nh
bmNlbF9icmVhZGNydW1iKHJxKTsKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNw
aW5fdW5sb2NrKCZycS0+bG9jayk7Cj4gPiAgICAgICAgICAgICAgICAgICAgICAgfQo+ID4gLSAg
ICAgICAgICAgICAgICAgICAgIHJxLT5lbmdpbmUgPSBvd25lcjsKPiA+ICAgICAgICAgICAgICAg
ICAgICAgICBvd25lci0+c3VibWl0X3JlcXVlc3QocnEpOwo+ID4gICAgICAgICAgICAgICAgICAg
ICAgIGFjdGl2ZSA9IE5VTEw7Cj4gPiAgICAgICAgICAgICAgIH0KPiA+IEBAIC0xMjQ4LDYgKzEy
NDcsNyBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfZGVxdWV1ZShzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUpCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJtaXQgPSB0
cnVlOwo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdCA9IHJxOwo+ID4gICAg
ICAgICAgICAgICAgICAgICAgIH0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBpOTE1X3JlcXVl
c3RfcHV0KHJxKTsKPiA+ICAgCj4gPiAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzdWJtaXQp
IHsKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwaW5fdW5sb2NrKCZ2ZS0+YmFz
ZS5hY3RpdmUubG9jayk7Cj4gPiBAQCAtMjUzNSw2ICsyNTM1LDcgQEAgc3RhdGljIHZvaWQgZXhl
Y2xpc3RzX2NhbmNlbF9yZXF1ZXN0cyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4g
PiAgIAo+ID4gICAgICAgICAgICAgICAgICAgICAgIHJxLT5lbmdpbmUgPSBlbmdpbmU7Cj4gPiAg
ICAgICAgICAgICAgICAgICAgICAgX19pOTE1X3JlcXVlc3Rfc3VibWl0KHJxKTsKPiA+ICsgICAg
ICAgICAgICAgICAgICAgICBpOTE1X3JlcXVlc3RfcHV0KHJxKTsKPiA+ICAgCj4gPiAgICAgICAg
ICAgICAgICAgICAgICAgdmUtPmJhc2UuZXhlY2xpc3RzLnF1ZXVlX3ByaW9yaXR5X2hpbnQgPSBJ
TlRfTUlOOwo+ID4gICAgICAgICAgICAgICB9Cj4gPiBAQCAtMzc4Nyw3ICszNzg4LDkgQEAgc3Rh
dGljIHZvaWQgdmlydHVhbF9zdWJtaXNzaW9uX3Rhc2tsZXQodW5zaWduZWQgbG9uZyBkYXRhKQo+
ID4gICAKPiA+ICAgc3RhdGljIHZvaWQgdmlydHVhbF9zdWJtaXRfcmVxdWVzdChzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpycSkKPiA+ICAgewo+ID4gLSAgICAgc3RydWN0IHZpcnR1YWxfZW5naW5lICp2
ZSA9IHRvX3ZpcnR1YWxfZW5naW5lKHJxLT5lbmdpbmUpOwo+ID4gKyAgICAgc3RydWN0IHZpcnR1
YWxfZW5naW5lICp2ZSA9IHRvX3ZpcnR1YWxfZW5naW5lKHJxLT5od19jb250ZXh0LT5lbmdpbmUp
Owo+ID4gKyAgICAgc3RydWN0IGk5MTVfcmVxdWVzdCAqc3RhbGU7Cj4gPiArICAgICB1bnNpZ25l
ZCBsb25nIGZsYWdzOwo+ID4gICAKPiA+ICAgICAgIEdFTV9UUkFDRSgiJXM6IHJxPSVsbHg6JWxs
ZFxuIiwKPiA+ICAgICAgICAgICAgICAgICB2ZS0+YmFzZS5uYW1lLAo+ID4gQEAgLTM3OTYsMTUg
KzM3OTksMzAgQEAgc3RhdGljIHZvaWQgdmlydHVhbF9zdWJtaXRfcmVxdWVzdChzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpycSkKPiA+ICAgCj4gPiAgICAgICBHRU1fQlVHX09OKHZlLT5iYXNlLnN1Ym1p
dF9yZXF1ZXN0ICE9IHZpcnR1YWxfc3VibWl0X3JlcXVlc3QpOwo+ID4gICAKPiA+IC0gICAgIEdF
TV9CVUdfT04odmUtPnJlcXVlc3QpOwo+ID4gLSAgICAgR0VNX0JVR19PTighbGlzdF9lbXB0eSh2
aXJ0dWFsX3F1ZXVlKHZlKSkpOwo+ID4gKyAgICAgc3Bpbl9sb2NrX2lycXNhdmUoJnZlLT5iYXNl
LmFjdGl2ZS5sb2NrLCBmbGFncyk7Cj4gPiArCj4gPiArICAgICBzdGFsZSA9IHZlLT5yZXF1ZXN0
Owo+IAo+IGZldGNoX2FuZF96ZXJvIHNvIHlvdSBkb24ndCBoYXZlIHRvIHNldCBpdCB0byBOVUxM
IGEgYml0IGxvd2VyPwoKSSBpdGVyYXRlZCB0aHJvdWdoIHhjaGcgdGhlbiBmZXRjaF9hbmRfemVy
bywgYmVmb3JlIHNldHRsaW5nIG9uIHRoaXMKdmFyaWFudC4gTXkgZmVlbGluZyB3YXMgc2V0dGlu
ZyB2ZS0+cmVxdWVzdCBpbiBib3RoIHNpZGVzIG9mIHRoZSBpZigpCndhcyBtb3JlIGJhbGFuY2Vk
LgoKPiBzL3N0YWxlL2NvbXBsZXRlZC8sIHBsdXMgYSBjb21tZW50IGRlc2NyaWJpbmcgcHJlZW1w
dC10by1idXN5IGlzIHRvIGJsYW1lPwoKY29tcGxldGVkIGlzIGEgbGl0dGxlIGxvbmcsIG9sZD8g
QWxyZWFkeSBhZGRlZCBhIGNvbW1lbnQgdG8gcmVtaW5kIGFib3V0CnRoZSBwcmVlbXB0LXRvLWJ1
c3kgbGluayA6KQoKPiA+ICsgICAgIGlmIChzdGFsZSkgewo+ID4gKyAgICAgICAgICAgICBHRU1f
QlVHX09OKCFpOTE1X3JlcXVlc3RfY29tcGxldGVkKHN0YWxlKSk7Cj4gPiArICAgICAgICAgICAg
IF9faTkxNV9yZXF1ZXN0X3N1Ym1pdChzdGFsZSk7Cj4gPiArICAgICAgICAgICAgIGk5MTVfcmVx
dWVzdF9wdXQoc3RhbGUpOwo+ID4gKyAgICAgfQo+ID4gKwo+ID4gKyAgICAgaWYgKGk5MTVfcmVx
dWVzdF9jb21wbGV0ZWQocnEpKSB7Cj4gPiArICAgICAgICAgICAgIF9faTkxNV9yZXF1ZXN0X3N1
Ym1pdChycSk7Cj4gPiArICAgICAgICAgICAgIHZlLT5yZXF1ZXN0ID0gTlVMTDsKPiA+ICsgICAg
IH0gZWxzZSB7Cj4gPiArICAgICAgICAgICAgIHZlLT5iYXNlLmV4ZWNsaXN0cy5xdWV1ZV9wcmlv
cml0eV9oaW50ID0gcnFfcHJpbyhycSk7Cj4gPiArICAgICAgICAgICAgIHZlLT5yZXF1ZXN0ID0g
aTkxNV9yZXF1ZXN0X2dldChycSk7Cj4gPiArICAgICAgICAgICAgIHJxLT5lbmdpbmUgPSAmdmUt
PmJhc2U7IC8qIGZpeHVwIGZyb20gdW53aW5kICovCj4gCj4gVGhlIGxhc3QgbGluZSBoYXMgbWUg
Y29uZnVzZWQuIElzbid0IHRoaXMgdGhlIG5vcm1hbCB2ZW5nIHJxIHN1Ym1pc3Npb24gCj4gcGF0
aD8KCkl0IGlzIGFsc28gb24gdGhlIG5vcm1hbCBzdWJtaXNzaW9uIHBhdGguCgo+IEluIHdoaWNo
IGNhc2UgcnEtPmVuZ2luZSB3aWxsIGFscmVhZHkgYmUgc2V0IHRvIHZlbmcuCgpZZXMKCj4gQnV0
IG9uIHRoZSAKPiB1bndpbmQgcGF0aCB5b3UgaGF2ZSByZW1vdmVkIHJlc2V0LWJhY2sgb2YgcnEt
PmVuZ2luZSB0byBvd25lci4gQWguLiB0aGUgCj4gdW53aW5kIGNhbGxzIHZlbmctPnN1Ym1pdF9y
ZXF1ZXN0IG9uIGl0LCBhbmQgdGhlbiB3ZSBlbmQgdXAgaW4gaGVyZS4uIAo+IE9rYXksIHRoaXMg
aXMgb3V0c2lkZSB0aGUgbm9ybWFsIHBhdGgsIEkgbWVhbiB0aGUgZWxzZSBibG9jayBoYXMgdHdv
IAo+IGZ1bmN0aW9ucy9wYXRocywgYW5kIHRoaXMgc2hvdWxkIGJlIGV4cGxhaW5lZCBpbiBhIGNv
bW1lbnQuCgpUaGF0IHdhcyB0aGUgaW50ZW50IG9mICJmaXh1cCBmcm9tIHVud2luZD8iCgpJIGNh
biBzcXVlZXplIGluIC8qIGZpeHVwIF9fdW53aW5kX2luY29tcGxldGVfcmVxdWVzdHMgKi8gaXMg
dGhhdCBtb3JlCmNsdWVmdWw/IE9yIGRvIHlvdSB0aGluayBpdCBuZWVkcyBtb3JlPwotQ2hyaXMK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4
IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlz
dHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

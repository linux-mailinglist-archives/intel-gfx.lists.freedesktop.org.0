Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1DA25DA266
	for <lists+intel-gfx@lfdr.de>; Thu, 17 Oct 2019 01:43:48 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F14246E9DD;
	Wed, 16 Oct 2019 23:43:44 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 61DCC6E9DD
 for <intel-gfx@lists.freedesktop.org>; Wed, 16 Oct 2019 23:43:39 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18862923-1500050 
 for multiple; Thu, 17 Oct 2019 00:43:25 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 17 Oct 2019 00:43:23 +0100
Message-Id: <20191016234323.6821-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191016144744.7073-1-tvrtko.ursulin@linux.intel.com>
References: <20191016144744.7073-1-tvrtko.ursulin@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915: Make for_each_engine_masked work on
 intel_gt
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KCk1lZGl1bSB0
ZXJtIGdvYWwgaXMgdG8gZWxpbWluYXRlIHRoZSBpOTE1LT5lbmdpbmVbXSBhcnJheSBhbmQgdG8g
Z2V0IHRoZXJlCndlIGhhdmUgcmVjZW50bHkgaW50cm9kdWNlZCBlcXVpdmFsZW50IGFycmF5IGlu
IGludGVsX2d0LiBOb3cgd2UgbmVlZCB0bwptaWdyYXRlIHRoZSBjb2RlIGZ1cnRoZXIgdG93YXJk
cyB0aGlzIHN0YXRlLgoKVGhpcyBuZXh0IHN0ZXAgaXMgdG8gZWxpbWluYXRlIHVzYWdlIG9mIGk5
MTUtPmVuZ2luZXNbXSBmcm9tIHRoZQpmb3JfZWFjaF9lbmdpbmVfbWFza2VkIGl0ZXJhdG9yLgoK
Rm9yIHRoaXMgdG8gd29yayB3ZSBhbHNvIG5lZWQgdG8gdXNlIGVuZ2luZS0+aWQgYXMgaW5kZXgg
d2hlbiBwb3B1bGF0aW5nCnRoZSBndC0+ZW5naW5lW10gYXJyYXkgYW5kIGFkanVzdCB0aGUgZGVm
YXVsdCBlbmdpbmUgc2V0IGluZGV4aW5nIHRvIHVzZQplbmdpbmUtPmxlZ2FjeV9pZHggaW5zdGVh
ZCBvZiBhc3N1bWluZyBndC0+ZW5naW5lc1tdIGluZGV4aW5nLgoKU2lnbmVkLW9mZi1ieTogVHZy
dGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KQ2M6IENocmlzIFdpbHNvbiA8
Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9jb250ZXh0LmMgfCAgNCArKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9lbmdpbmVfY3MuYyAgIHwgIDQgKysrKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
ZW5naW5lX3VzZXIuYyB8ICA1ICstLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9n
dC5jICAgICAgICAgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2hhbmdj
aGVjay5jICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYyAg
ICAgICB8IDEyICsrKysrKy0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2V4ZWNsaXN0
LmMgICAgICAgICB8ICA0ICsrLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIu
YyAgICAgICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuYyAgICAg
ICAgICB8ICA0ICsrLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggICAgICAgICAg
ICAgfCAgNiArKystLS0KIDEwIGZpbGVzIGNoYW5nZWQsIDIzIGluc2VydGlvbnMoKyksIDIyIGRl
bGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5j
CmluZGV4IDVkODIyMWM3YmE4My4uNGUzMGNiOTc0NjQ4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKQEAgLTIwOSw4ICsyMDksOCBAQCBzdGF0aWMgc3Ry
dWN0IGk5MTVfZ2VtX2VuZ2luZXMgKmRlZmF1bHRfZW5naW5lcyhzdHJ1Y3QgaTkxNV9nZW1fY29u
dGV4dCAqY3R4KQogCQkJcmV0dXJuIEVSUl9DQVNUKGNlKTsKIAkJfQogCi0JCWUtPmVuZ2luZXNb
aWRdID0gY2U7Ci0JCWUtPm51bV9lbmdpbmVzID0gaWQgKyAxOworCQllLT5lbmdpbmVzW2VuZ2lu
ZS0+bGVnYWN5X2lkeF0gPSBjZTsKKwkJZS0+bnVtX2VuZ2luZXMgPSBlbmdpbmUtPmxlZ2FjeV9p
ZHggKyAxOwogCX0KIAogCXJldHVybiBlOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9l
bmdpbmVfY3MuYwppbmRleCA1MDUxYTFmZDI1NjUuLjRkY2RiOTA5YjYyZCAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKQEAgLTI3Nyw2ICsyNzcsOSBAQCBzdGF0
aWMgaW50IGludGVsX2VuZ2luZV9zZXR1cChzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBlbnVtIGludGVs
X2VuZ2luZV9pZCBpZCkKIAlCVUlMRF9CVUdfT04oTUFYX0VOR0lORV9DTEFTUyA+PSBCSVQoR0VO
MTFfRU5HSU5FX0NMQVNTX1dJRFRIKSk7CiAJQlVJTERfQlVHX09OKE1BWF9FTkdJTkVfSU5TVEFO
Q0UgPj0gQklUKEdFTjExX0VOR0lORV9JTlNUQU5DRV9XSURUSCkpOwogCisJaWYgKEdFTV9ERUJV
R19XQVJOX09OKGlkID49IEFSUkFZX1NJWkUoZ3QtPmVuZ2luZSkpKQorCQlyZXR1cm4gLUVJTlZB
TDsKKwogCWlmIChHRU1fREVCVUdfV0FSTl9PTihpbmZvLT5jbGFzcyA+IE1BWF9FTkdJTkVfQ0xB
U1MpKQogCQlyZXR1cm4gLUVJTlZBTDsKIApAQCAtMzI4LDYgKzMzMSw3IEBAIHN0YXRpYyBpbnQg
aW50ZWxfZW5naW5lX3NldHVwKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGVudW0gaW50ZWxfZW5naW5l
X2lkIGlkKQogCWludGVsX2VuZ2luZV9zYW5pdGl6ZV9tbWlvKGVuZ2luZSk7CiAKIAlndC0+ZW5n
aW5lX2NsYXNzW2luZm8tPmNsYXNzXVtpbmZvLT5pbnN0YW5jZV0gPSBlbmdpbmU7CisJZ3QtPmVu
Z2luZVtpZF0gPSBlbmdpbmU7CiAKIAlpbnRlbF9lbmdpbmVfYWRkX3VzZXIoZW5naW5lKTsKIAln
dC0+aTkxNS0+ZW5naW5lW2lkXSA9IGVuZ2luZTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZV91c2VyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9lbmdpbmVfdXNlci5jCmluZGV4IDc3Y2Q1ZGU4MzkzMC4uYTM3MzM0ZTNjM2IxIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdXNlci5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV91c2VyLmMKQEAgLTE4MywxMSAr
MTgzLDggQEAgc3RhdGljIHZvaWQgYWRkX2xlZ2FjeV9yaW5nKHN0cnVjdCBsZWdhY3lfcmluZyAq
cmluZywKIAlpZiAodW5saWtlbHkoaWR4ID09IC0xKSkKIAkJcmV0dXJuOwogCi0JR0VNX0JVR19P
TihpZHggPj0gQVJSQVlfU0laRShyaW5nLT5ndC0+ZW5naW5lKSk7Ci0JcmluZy0+Z3QtPmVuZ2lu
ZVtpZHhdID0gZW5naW5lOwotCXJpbmctPmluc3RhbmNlKys7Ci0KIAllbmdpbmUtPmxlZ2FjeV9p
ZHggPSBpZHg7CisJcmluZy0+aW5zdGFuY2UrKzsKIH0KIAogdm9pZCBpbnRlbF9lbmdpbmVzX2Ry
aXZlcl9yZWdpc3RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9ndC5jCmluZGV4IGIzNjE5YTJhNWQwZS4uYzk5YjZiMmYzOGMyIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2d0LmMKQEAgLTE4Niw3ICsxODYsNyBAQCBpbnRlbF9ndF9jbGVh
cl9lcnJvcl9yZWdpc3RlcnMoc3RydWN0IGludGVsX2d0ICpndCwKIAkJc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lOwogCQllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKIAotCQlmb3JfZWFj
aF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgaTkxNSwgZW5naW5lX21hc2ssIGlkKQorCQlmb3JfZWFj
aF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgZ3QsIGVuZ2luZV9tYXNrLCBpZCkKIAkJCWdlbjhfY2xl
YXJfZW5naW5lX2Vycm9yX3JlZ2lzdGVyKGVuZ2luZSk7CiAJfQogfQpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfaGFuZ2NoZWNrLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9oYW5nY2hlY2suYwppbmRleCBjMTRkYmViM2NjYzMuLmIyYWY3Mzk4NGY5
MyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfaGFuZ2NoZWNrLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfaGFuZ2NoZWNrLmMKQEAgLTIzNyw3
ICsyMzcsNyBAQCBzdGF0aWMgdm9pZCBoYW5nY2hlY2tfZGVjbGFyZV9oYW5nKHN0cnVjdCBpbnRl
bF9ndCAqZ3QsCiAJCWh1bmcgJj0gfnN0dWNrOwogCWxlbiA9IHNjbnByaW50Zihtc2csIHNpemVv
Zihtc2cpLAogCQkJIiVzIG9uICIsIHN0dWNrID09IGh1bmcgPyAibm8gcHJvZ3Jlc3MiIDogImhh
bmciKTsKLQlmb3JfZWFjaF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgZ3QtPmk5MTUsIGh1bmcsIHRt
cCkKKwlmb3JfZWFjaF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgZ3QsIGh1bmcsIHRtcCkKIAkJbGVu
ICs9IHNjbnByaW50Zihtc2cgKyBsZW4sIHNpemVvZihtc2cpIC0gbGVuLAogCQkJCSAiJXMsICIs
IGVuZ2luZS0+bmFtZSk7CiAJbXNnW2xlbi0yXSA9ICdcMCc7CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfcmVzZXQuYwppbmRleCA0NzdiZmFmZGIxMDMuLmIxOTFiMDc0NTcwMyAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jCkBAIC0yOTgsNyArMjk4LDcgQEAgc3RhdGljIGlu
dCBnZW42X3Jlc2V0X2VuZ2luZXMoc3RydWN0IGludGVsX2d0ICpndCwKIAkJaW50ZWxfZW5naW5l
X21hc2tfdCB0bXA7CiAKIAkJaHdfbWFzayA9IDA7Ci0JCWZvcl9lYWNoX2VuZ2luZV9tYXNrZWQo
ZW5naW5lLCBndC0+aTkxNSwgZW5naW5lX21hc2ssIHRtcCkgeworCQlmb3JfZWFjaF9lbmdpbmVf
bWFza2VkKGVuZ2luZSwgZ3QsIGVuZ2luZV9tYXNrLCB0bXApIHsKIAkJCUdFTV9CVUdfT04oZW5n
aW5lLT5pZCA+PSBBUlJBWV9TSVpFKGh3X2VuZ2luZV9tYXNrKSk7CiAJCQlod19tYXNrIHw9IGh3
X2VuZ2luZV9tYXNrW2VuZ2luZS0+aWRdOwogCQl9CkBAIC00MzIsNyArNDMyLDcgQEAgc3RhdGlj
IGludCBnZW4xMV9yZXNldF9lbmdpbmVzKHN0cnVjdCBpbnRlbF9ndCAqZ3QsCiAJCWh3X21hc2sg
PSBHRU4xMV9HUkRPTV9GVUxMOwogCX0gZWxzZSB7CiAJCWh3X21hc2sgPSAwOwotCQlmb3JfZWFj
aF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgZ3QtPmk5MTUsIGVuZ2luZV9tYXNrLCB0bXApIHsKKwkJ
Zm9yX2VhY2hfZW5naW5lX21hc2tlZChlbmdpbmUsIGd0LCBlbmdpbmVfbWFzaywgdG1wKSB7CiAJ
CQlHRU1fQlVHX09OKGVuZ2luZS0+aWQgPj0gQVJSQVlfU0laRShod19lbmdpbmVfbWFzaykpOwog
CQkJaHdfbWFzayB8PSBod19lbmdpbmVfbWFza1tlbmdpbmUtPmlkXTsKIAkJCXJldCA9IGdlbjEx
X2xvY2tfc2ZjKGVuZ2luZSwgJmh3X21hc2spOwpAQCAtNDUxLDcgKzQ1MSw3IEBAIHN0YXRpYyBp
bnQgZ2VuMTFfcmVzZXRfZW5naW5lcyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAogCSAqIGV4cGlyYXRp
b24pLgogCSAqLwogCWlmIChlbmdpbmVfbWFzayAhPSBBTExfRU5HSU5FUykKLQkJZm9yX2VhY2hf
ZW5naW5lX21hc2tlZChlbmdpbmUsIGd0LT5pOTE1LCBlbmdpbmVfbWFzaywgdG1wKQorCQlmb3Jf
ZWFjaF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgZ3QsIGVuZ2luZV9tYXNrLCB0bXApCiAJCQlnZW4x
MV91bmxvY2tfc2ZjKGVuZ2luZSk7CiAKIAlyZXR1cm4gcmV0OwpAQCAtNTEwLDcgKzUxMCw3IEBA
IHN0YXRpYyBpbnQgZ2VuOF9yZXNldF9lbmdpbmVzKHN0cnVjdCBpbnRlbF9ndCAqZ3QsCiAJaW50
ZWxfZW5naW5lX21hc2tfdCB0bXA7CiAJaW50IHJldDsKIAotCWZvcl9lYWNoX2VuZ2luZV9tYXNr
ZWQoZW5naW5lLCBndC0+aTkxNSwgZW5naW5lX21hc2ssIHRtcCkgeworCWZvcl9lYWNoX2VuZ2lu
ZV9tYXNrZWQoZW5naW5lLCBndCwgZW5naW5lX21hc2ssIHRtcCkgewogCQlyZXQgPSBnZW44X2Vu
Z2luZV9yZXNldF9wcmVwYXJlKGVuZ2luZSk7CiAJCWlmIChyZXQgJiYgIXJlc2V0X25vbl9yZWFk
eSkKIAkJCWdvdG8gc2tpcF9yZXNldDsKQEAgLTUzNiw3ICs1MzYsNyBAQCBzdGF0aWMgaW50IGdl
bjhfcmVzZXRfZW5naW5lcyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAogCQlyZXQgPSBnZW42X3Jlc2V0
X2VuZ2luZXMoZ3QsIGVuZ2luZV9tYXNrLCByZXRyeSk7CiAKIHNraXBfcmVzZXQ6Ci0JZm9yX2Vh
Y2hfZW5naW5lX21hc2tlZChlbmdpbmUsIGd0LT5pOTE1LCBlbmdpbmVfbWFzaywgdG1wKQorCWZv
cl9lYWNoX2VuZ2luZV9tYXNrZWQoZW5naW5lLCBndCwgZW5naW5lX21hc2ssIHRtcCkKIAkJZ2Vu
OF9lbmdpbmVfcmVzZXRfY2FuY2VsKGVuZ2luZSk7CiAKIAlyZXR1cm4gcmV0OwpAQCAtMTIwNiw3
ICsxMjA2LDcgQEAgdm9pZCBpbnRlbF9ndF9oYW5kbGVfZXJyb3Ioc3RydWN0IGludGVsX2d0ICpn
dCwKIAkgKiBzaW5nbGUgcmVzZXQgZmFpbHMuCiAJICovCiAJaWYgKGludGVsX2hhc19yZXNldF9l
bmdpbmUoZ3QpICYmICFpbnRlbF9ndF9pc193ZWRnZWQoZ3QpKSB7Ci0JCWZvcl9lYWNoX2VuZ2lu
ZV9tYXNrZWQoZW5naW5lLCBndC0+aTkxNSwgZW5naW5lX21hc2ssIHRtcCkgeworCQlmb3JfZWFj
aF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgZ3QsIGVuZ2luZV9tYXNrLCB0bXApIHsKIAkJCUJVSUxE
X0JVR19PTihJOTE1X1JFU0VUX01PREVTRVQgPj0gSTkxNV9SRVNFVF9FTkdJTkUpOwogCQkJaWYg
KHRlc3RfYW5kX3NldF9iaXQoSTkxNV9SRVNFVF9FTkdJTkUgKyBlbmdpbmUtPmlkLAogCQkJCQkg
ICAgICZndC0+cmVzZXQuZmxhZ3MpKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3Z0L2V4ZWNsaXN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZXhlY2xpc3QuYwppbmRl
eCBmMjFiOGZiNWIzN2UuLmQ2ZTdhMTE4OWJhZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Z0L2V4ZWNsaXN0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2V4ZWNs
aXN0LmMKQEAgLTUzNCw3ICs1MzQsNyBAQCBzdGF0aWMgdm9pZCBjbGVhbl9leGVjbGlzdChzdHJ1
Y3QgaW50ZWxfdmdwdSAqdmdwdSwKIAlzdHJ1Y3QgaW50ZWxfdmdwdV9zdWJtaXNzaW9uICpzID0g
JnZncHUtPnN1Ym1pc3Npb247CiAJaW50ZWxfZW5naW5lX21hc2tfdCB0bXA7CiAKLQlmb3JfZWFj
aF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgZGV2X3ByaXYsIGVuZ2luZV9tYXNrLCB0bXApIHsKKwlm
b3JfZWFjaF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgJmRldl9wcml2LT5ndCwgZW5naW5lX21hc2ss
IHRtcCkgewogCQlrZnJlZShzLT5yaW5nX3NjYW5fYnVmZmVyW2VuZ2luZS0+aWRdKTsKIAkJcy0+
cmluZ19zY2FuX2J1ZmZlcltlbmdpbmUtPmlkXSA9IE5VTEw7CiAJCXMtPnJpbmdfc2Nhbl9idWZm
ZXJfc2l6ZVtlbmdpbmUtPmlkXSA9IDA7CkBAIC01NDgsNyArNTQ4LDcgQEAgc3RhdGljIHZvaWQg
cmVzZXRfZXhlY2xpc3Qoc3RydWN0IGludGVsX3ZncHUgKnZncHUsCiAJc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lOwogCWludGVsX2VuZ2luZV9tYXNrX3QgdG1wOwogCi0JZm9yX2VhY2hf
ZW5naW5lX21hc2tlZChlbmdpbmUsIGRldl9wcml2LCBlbmdpbmVfbWFzaywgdG1wKQorCWZvcl9l
YWNoX2VuZ2luZV9tYXNrZWQoZW5naW5lLCAmZGV2X3ByaXYtPmd0LCBlbmdpbmVfbWFzaywgdG1w
KQogCQlpbml0X3ZncHVfZXhlY2xpc3QodmdwdSwgZW5naW5lLT5pZCk7CiB9CiAKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d2dC9zY2hlZHVsZXIuYwppbmRleCA2ODUwZjFmNDAyNDEuLjllYmIyNTM0NTU4YiAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIuYwpAQCAtODg3LDcgKzg4Nyw3IEBAIHZv
aWQgaW50ZWxfdmdwdV9jbGVhbl93b3JrbG9hZHMoc3RydWN0IGludGVsX3ZncHUgKnZncHUsCiAJ
aW50ZWxfZW5naW5lX21hc2tfdCB0bXA7CiAKIAkvKiBmcmVlIHRoZSB1bnN1Ym1pdGVkIHdvcmts
b2FkcyBpbiB0aGUgcXVldWVzLiAqLwotCWZvcl9lYWNoX2VuZ2luZV9tYXNrZWQoZW5naW5lLCBk
ZXZfcHJpdiwgZW5naW5lX21hc2ssIHRtcCkgeworCWZvcl9lYWNoX2VuZ2luZV9tYXNrZWQoZW5n
aW5lLCAmZGV2X3ByaXYtPmd0LCBlbmdpbmVfbWFzaywgdG1wKSB7CiAJCWxpc3RfZm9yX2VhY2hf
ZW50cnlfc2FmZShwb3MsIG4sCiAJCQkmcy0+d29ya2xvYWRfcV9oZWFkW2VuZ2luZS0+aWRdLCBs
aXN0KSB7CiAJCQlsaXN0X2RlbF9pbml0KCZwb3MtPmxpc3QpOwpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
YWN0aXZlLmMKaW5kZXggYWEzN2MwNzAwNGI5Li43OTI3YjFhMGM3YTYgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9hY3RpdmUuYwpAQCAtNTkwLDggKzU5MCw4IEBAIHN0YXRpYyBzdHJ1Y3QgYWN0aXZl
X25vZGUgKnJldXNlX2lkbGVfYmFycmllcihzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwgdTY0IGlk
eCkKIGludCBpOTE1X2FjdGl2ZV9hY3F1aXJlX3ByZWFsbG9jYXRlX2JhcnJpZXIoc3RydWN0IGk5
MTVfYWN0aXZlICpyZWYsCiAJCQkJCSAgICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUp
CiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBlbmdpbmUtPmk5MTU7CiAJaW50
ZWxfZW5naW5lX21hc2tfdCB0bXAsIG1hc2sgPSBlbmdpbmUtPm1hc2s7CisJc3RydWN0IGludGVs
X2d0ICpndCA9IGVuZ2luZS0+Z3Q7CiAJc3RydWN0IGxsaXN0X25vZGUgKnBvcywgKm5leHQ7CiAJ
aW50IGVycjsKIApAQCAtNjAzLDcgKzYwMyw3IEBAIGludCBpOTE1X2FjdGl2ZV9hY3F1aXJlX3By
ZWFsbG9jYXRlX2JhcnJpZXIoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsCiAJICogV2UgY2FuIHRo
ZW4gdXNlIHRoZSBwcmVhbGxvY2F0ZWQgbm9kZXMgaW4KIAkgKiBpOTE1X2FjdGl2ZV9hY3F1aXJl
X2JhcnJpZXIoKQogCSAqLwotCWZvcl9lYWNoX2VuZ2luZV9tYXNrZWQoZW5naW5lLCBpOTE1LCBt
YXNrLCB0bXApIHsKKwlmb3JfZWFjaF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgZ3QsIG1hc2ssIHRt
cCkgewogCQl1NjQgaWR4ID0gZW5naW5lLT5rZXJuZWxfY29udGV4dC0+dGltZWxpbmUtPmZlbmNl
X2NvbnRleHQ7CiAJCXN0cnVjdCBhY3RpdmVfbm9kZSAqbm9kZTsKIApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
ZHJ2LmgKaW5kZXggODg5NTZmMzdkOTZjLi40MGU5MjNiMGMyYzggMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kcnYuaApAQCAtMTQxNSwxMCArMTQxNSwxMCBAQCBzdGF0aWMgaW5saW5lIHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpwZGV2X3RvX2k5MTUoc3RydWN0IHBjaV9kZXYgKnBkZXYpCiAJCWZvcl9l
YWNoX2lmICgoZW5naW5lX18pID0gKGRldl9wcml2X18pLT5lbmdpbmVbKGlkX18pXSkKIAogLyog
SXRlcmF0b3Igb3ZlciBzdWJzZXQgb2YgZW5naW5lcyBzZWxlY3RlZCBieSBtYXNrICovCi0jZGVm
aW5lIGZvcl9lYWNoX2VuZ2luZV9tYXNrZWQoZW5naW5lX18sIGRldl9wcml2X18sIG1hc2tfXywg
dG1wX18pIFwKLQlmb3IgKCh0bXBfXykgPSAobWFza19fKSAmIElOVEVMX0lORk8oZGV2X3ByaXZf
XyktPmVuZ2luZV9tYXNrOyBcCisjZGVmaW5lIGZvcl9lYWNoX2VuZ2luZV9tYXNrZWQoZW5naW5l
X18sIGd0X18sIG1hc2tfXywgdG1wX18pIFwKKwlmb3IgKCh0bXBfXykgPSAobWFza19fKSAmIElO
VEVMX0lORk8oKGd0X18pLT5pOTE1KS0+ZW5naW5lX21hc2s7IFwKIAkgICAgICh0bXBfXykgPyBc
Ci0JICAgICAoKGVuZ2luZV9fKSA9IChkZXZfcHJpdl9fKS0+ZW5naW5lW19fbWFza19uZXh0X2Jp
dCh0bXBfXyldKSwgMSA6IFwKKwkgICAgICgoZW5naW5lX18pID0gKGd0X18pLT5lbmdpbmVbX19t
YXNrX25leHRfYml0KHRtcF9fKV0pLCAxIDogXAogCSAgICAgMDspCiAKICNkZWZpbmUgcmJfdG9f
dWFiaV9lbmdpbmUocmIpIFwKLS0gCjIuMjMuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlz
dHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4v
bGlzdGluZm8vaW50ZWwtZ2Z4

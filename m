Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 4876258E86
	for <lists+intel-gfx@lfdr.de>; Fri, 28 Jun 2019 01:27:12 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 04B136E853;
	Thu, 27 Jun 2019 23:27:10 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1D5E16E853
 for <intel-gfx@lists.freedesktop.org>; Thu, 27 Jun 2019 23:27:07 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 17050704-1500050 for multiple; Fri, 28 Jun 2019 00:27:05 +0100
MIME-Version: 1.0
From: Chris Wilson <chris@chris-wilson.co.uk>
User-Agent: alot/0.6
To: Matthew Auld <matthew.auld@intel.com>, intel-gfx@lists.freedesktop.org
References: <20190627205633.1143-1-matthew.auld@intel.com>
 <20190627205633.1143-10-matthew.auld@intel.com>
In-Reply-To: <20190627205633.1143-10-matthew.auld@intel.com>
Message-ID: <156167802335.21955.17556881680838243429@skylake-alporthouse-com>
Date: Fri, 28 Jun 2019 00:27:03 +0100
Subject: Re: [Intel-gfx] [PATCH v2 09/37] drm/i915/lmem: support kernel
 mapping
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVvdGluZyBNYXR0aGV3IEF1bGQgKDIwMTktMDYtMjcgMjE6NTY6MDUpCj4gRnJvbTogQWJkaWVs
IEphbnVsZ3VlIDxhYmRpZWwuamFudWxndWVAbGludXguaW50ZWwuY29tPgo+IAo+IFdlIGNhbiBj
cmVhdGUgTE1FTSBvYmplY3RzLCBidXQgd2UgYWxzbyBuZWVkIHRvIHN1cHBvcnQgbWFwcGluZyB0
aGVtCj4gaW50byBrZXJuZWwgc3BhY2UgZm9yIGludGVybmFsIHVzZS4KPiAKPiBTaWduZWQtb2Zm
LWJ5OiBBYmRpZWwgSmFudWxndWUgPGFiZGllbC5qYW51bGd1ZUBsaW51eC5pbnRlbC5jb20+Cj4g
U2lnbmVkLW9mZi1ieTogTWF0dGhldyBBdWxkIDxtYXR0aGV3LmF1bGRAaW50ZWwuY29tPgo+IENj
OiBKb29uYXMgTGFodGluZW4gPGpvb25hcy5sYWh0aW5lbkBsaW51eC5pbnRlbC5jb20+Cj4gLS0t
Cj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wYWdlcy5jICAgICB8IDE4ICsr
KystCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3JlZ2lvbl9sbWVtLmMgICAgICB8IDI0
ICsrKysrKwo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9yZWdpb25fbG1lbS5oICAgICAg
fCAgNiArKwo+ICAuLi4vZHJtL2k5MTUvc2VsZnRlc3RzL2ludGVsX21lbW9yeV9yZWdpb24uYyAg
fCA3NyArKysrKysrKysrKysrKysrKysrCj4gIDQgZmlsZXMgY2hhbmdlZCwgMTIxIGluc2VydGlv
bnMoKyksIDQgZGVsZXRpb25zKC0pCj4gCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9wYWdlcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX3BhZ2VzLmMKPiBpbmRleCBiMzZhZDI2OWY0ZWEuLjE1ZWFhZWRmZmM0NiAxMDA2NDQKPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcGFnZXMuYwo+ICsrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wYWdlcy5jCj4gQEAgLTE3Niw3ICsxNzYs
OSBAQCBfX2k5MTVfZ2VtX29iamVjdF91bnNldF9wYWdlcyhzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29i
amVjdCAqb2JqKQo+ICAgICAgICAgICAgICAgICB2b2lkICpwdHI7Cj4gIAo+ICAgICAgICAgICAg
ICAgICBwdHIgPSBwYWdlX21hc2tfYml0cyhvYmotPm1tLm1hcHBpbmcpOwo+IC0gICAgICAgICAg
ICAgICBpZiAoaXNfdm1hbGxvY19hZGRyKHB0cikpCj4gKyAgICAgICAgICAgICAgIGlmIChpOTE1
X2dlbV9vYmplY3RfaXNfbG1lbShvYmopKQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGlvX21h
cHBpbmdfdW5tYXAocHRyKTsKPiArICAgICAgICAgICAgICAgZWxzZSBpZiAoaXNfdm1hbGxvY19h
ZGRyKHB0cikpCj4gICAgICAgICAgICAgICAgICAgICAgICAgdnVubWFwKHB0cik7Cj4gICAgICAg
ICAgICAgICAgIGVsc2UKPiAgICAgICAgICAgICAgICAgICAgICAgICBrdW5tYXAoa21hcF90b19w
YWdlKHB0cikpOwo+IEBAIC0yMzUsNyArMjM3LDcgQEAgaW50IF9faTkxNV9nZW1fb2JqZWN0X3B1
dF9wYWdlcyhzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAo+ICB9Cj4gIAo+ICAvKiBU
aGUgJ21hcHBpbmcnIHBhcnQgb2YgaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAoKSBiZWxvdyAqLwo+
IC1zdGF0aWMgdm9pZCAqaTkxNV9nZW1fb2JqZWN0X21hcChjb25zdCBzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqLAo+ICtzdGF0aWMgdm9pZCAqaTkxNV9nZW1fb2JqZWN0X21hcChzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGVudW0gaTkxNV9tYXBfdHlwZSB0eXBlKQo+ICB7Cj4gICAgICAgICB1bnNpZ25lZCBs
b25nIG5fcGFnZXMgPSBvYmotPmJhc2Uuc2l6ZSA+PiBQQUdFX1NISUZUOwo+IEBAIC0yNDgsNiAr
MjUwLDExIEBAIHN0YXRpYyB2b2lkICppOTE1X2dlbV9vYmplY3RfbWFwKGNvbnN0IHN0cnVjdCBk
cm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCj4gICAgICAgICBwZ3Byb3RfdCBwZ3Byb3Q7Cj4gICAg
ICAgICB2b2lkICphZGRyOwo+ICAKPiArICAgICAgIGlmIChpOTE1X2dlbV9vYmplY3RfaXNfbG1l
bShvYmopKSB7Cj4gKyAgICAgICAgICAgICAgIC8qIFhYWDogd2UgYXJlIGlnbm9yaW5nIHRoZSB0
eXBlIGhlcmUgLS0gdGhpcyBpcyBzaW1wbHkgd2MgKi8KClllYWgsIGRvbid0LiBUaGUgY2FsbGVy
cyBjZXJ0YWlubHkgZG8gbm90IGV4cGVjdCB0aGF0LgoKPiArICAgICAgICAgICAgICAgcmV0dXJu
IGk5MTVfZ2VtX29iamVjdF9sbWVtX2lvX21hcChvYmosIDAsIG9iai0+YmFzZS5zaXplKTsKPiAr
ICAgICAgIH0KPiArCj4gICAgICAgICAvKiBBIHNpbmdsZSBwYWdlIGNhbiBhbHdheXMgYmUga21h
cHBlZCAqLwo+ICAgICAgICAgaWYgKG5fcGFnZXMgPT0gMSAmJiB0eXBlID09IEk5MTVfTUFQX1dC
KQo+ICAgICAgICAgICAgICAgICByZXR1cm4ga21hcChzZ19wYWdlKHNndC0+c2dsKSk7Cj4gQEAg
LTI5Myw3ICszMDAsOCBAQCB2b2lkICppOTE1X2dlbV9vYmplY3RfcGluX21hcChzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdCAqb2JqLAo+ICAgICAgICAgdm9pZCAqcHRyOwo+ICAgICAgICAgaW50
IGVycjsKPiAgCj4gLSAgICAgICBpZiAodW5saWtlbHkoIWk5MTVfZ2VtX29iamVjdF9oYXNfc3Ry
dWN0X3BhZ2Uob2JqKSkpCj4gKyAgICAgICBpZiAodW5saWtlbHkoIWk5MTVfZ2VtX29iamVjdF9o
YXNfc3RydWN0X3BhZ2Uob2JqKSAmJgo+ICsgICAgICAgICAgICAgICAgICAgICFpOTE1X2dlbV9v
YmplY3RfaXNfbG1lbShvYmopKSkKClJlZGVmaW5lIHRoZSBmZWF0dXJlIGJpdCBpbiB0aGUgb2Jq
LT5vcHMtPmZsYWdzLgoKPiAgICAgICAgICAgICAgICAgcmV0dXJuIEVSUl9QVFIoLUVOWElPKTsK
PiAgCj4gICAgICAgICBlcnIgPSBtdXRleF9sb2NrX2ludGVycnVwdGlibGUoJm9iai0+bW0ubG9j
ayk7Cj4gQEAgLTMyNSw3ICszMzMsOSBAQCB2b2lkICppOTE1X2dlbV9vYmplY3RfcGluX21hcChz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAo+ICAgICAgICAgICAgICAgICAgICAgICAg
IGdvdG8gZXJyX3VucGluOwo+ICAgICAgICAgICAgICAgICB9Cj4gIAo+IC0gICAgICAgICAgICAg
ICBpZiAoaXNfdm1hbGxvY19hZGRyKHB0cikpCj4gKyAgICAgICAgICAgICAgIGlmIChpOTE1X2dl
bV9vYmplY3RfaXNfbG1lbShvYmopKQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGlvX21hcHBp
bmdfdW5tYXAocHRyKTsKPiArICAgICAgICAgICAgICAgZWxzZSBpZiAoaXNfdm1hbGxvY19hZGRy
KHB0cikpCj4gICAgICAgICAgICAgICAgICAgICAgICAgdnVubWFwKHB0cik7Cj4gICAgICAgICAg
ICAgICAgIGVsc2UKPiAgICAgICAgICAgICAgICAgICAgICAgICBrdW5tYXAoa21hcF90b19wYWdl
KHB0cikpOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9yZWdpb25f
bG1lbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcmVnaW9uX2xtZW0uYwo+IGluZGV4
IDE1NjU1Y2M1MDEzZi4uNzAxYmNhYzM0NzllIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX3JlZ2lvbl9sbWVtLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9yZWdpb25fbG1lbS5jCj4gQEAgLTczLDYgKzczLDMwIEBAIHN0YXRpYyBjb25zdCBzdHJ1
Y3QgaW50ZWxfbWVtb3J5X3JlZ2lvbl9vcHMgcmVnaW9uX2xtZW1fb3BzID0gewo+ICAgICAgICAg
LmNyZWF0ZV9vYmplY3QgPSBsbWVtX2NyZWF0ZV9vYmplY3QsCj4gIH07Cj4gIAo+ICsvKiBYWFg6
IFRpbWUgdG8gdmZ1bmMgeW91ciBsaWZlIHVwPyAqLwo+ICt2b2lkIF9faW9tZW0gKmk5MTVfZ2Vt
X29iamVjdF9sbWVtX2lvX21hcF9wYWdlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmos
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25l
ZCBsb25nIG4pCj4gK3sKPiArICAgICAgIHJlc291cmNlX3NpemVfdCBvZmZzZXQ7Cj4gKwo+ICsg
ICAgICAgb2Zmc2V0ID0gaTkxNV9nZW1fb2JqZWN0X2dldF9kbWFfYWRkcmVzcyhvYmosIG4pOwoK
VGhhdCBzZWVtcyBkdWJpb3VzLiBTbyBkdWJpb3VzIHRoYXQgSSBhZ2FpbiBzYXkgZG8gbm90IG1p
eCB0ZXJtcy4KCj4gKyAgICAgICByZXR1cm4gaW9fbWFwcGluZ19tYXBfYXRvbWljX3djKCZvYmot
Pm1lbW9yeV9yZWdpb24tPmlvbWFwLCBvZmZzZXQpOwoKQWhlbS4gVGhlIGNhbGxlciBtYXkgbm90
IGJlIHJlYWR5IHRvIGFiaWRlIGJ5IHRoZSB0ZXJtcyBvZiB0aGUgYXRvbWljCmNvbnRyYWN0LgoK
PiArfQpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRl
bC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6
Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

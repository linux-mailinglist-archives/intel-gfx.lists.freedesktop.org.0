Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 450D01A2D24
	for <lists+intel-gfx@lfdr.de>; Thu,  9 Apr 2020 02:57:34 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 76EEE6EB29;
	Thu,  9 Apr 2020 00:57:32 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga17.intel.com (mga17.intel.com [192.55.52.151])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B8B7F6EB28
 for <intel-gfx@lists.freedesktop.org>; Thu,  9 Apr 2020 00:57:29 +0000 (UTC)
IronPort-SDR: 8h9v7ClMvvJhI3KBuSkOt+xi4pnA4ADeaGFyN8J79tzKFrHA+7O2XQSlI2s6u6rbmUSOVXGdf+
 wmNtq/sU42hA==
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga008.fm.intel.com ([10.253.24.58])
 by fmsmga107.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 08 Apr 2020 17:57:29 -0700
IronPort-SDR: CKeWfq29GOsiXrqVJcpaEPZPebQbTGsIdNrk1dE6w8ZiL2pNO3SO0fsjaVF5vwz4L3w0aFK1Oo
 fs4+nbuToj4w==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.72,360,1580803200"; d="scan'208";a="244185376"
Received: from dceraolo-linux.fm.intel.com ([10.1.27.145])
 by fmsmga008.fm.intel.com with ESMTP; 08 Apr 2020 17:57:29 -0700
From: Daniele Ceraolo Spurio <daniele.ceraolospurio@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed,  8 Apr 2020 17:56:57 -0700
Message-Id: <20200409005658.12262-4-daniele.ceraolospurio@intel.com>
X-Mailer: git-send-email 2.24.1
In-Reply-To: <20200409005658.12262-1-daniele.ceraolospurio@intel.com>
References: <20200409005658.12262-1-daniele.ceraolospurio@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 3/4] drm/i915: consolidate WOPCM management
 under gt/uc
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VGhlIFdPUENNIGlzIG5vdCBhIHVDLXNwZWNpZmljIHJlc291cmNlLCBidXQgdGhlIG9ubHkgdXNl
LWNhc2Ugd2UgaGF2ZQpmb3IgaXQgb24gdGhlIFNXIHNpZGUgaXMgdGhlIHByb2dyYW1taW5nIG9m
IHRoZSByZWxhdGVkIHJlZ2lzdGVycyBmb3IKR3VDL0h1QyBETUEsIGV2ZXJ5dGhpbmcgZWxzZSBp
cyBIVy1tYW5hZ2VkLiBHaXZlbiB0aGF0IHRoZSB3b3BjbSBpbml0CmZ1bmN0aW9ucyBhcmUgYWxy
ZWFkeSBoZWF2aWx5IHVDIGZvY3VzZWQgKHRvIHRoZSBwb2ludCB0aGF0IHRoZXkgc2tpcApvbiBI
VyB0aGF0IGRvZXNuJ3QgaGF2ZSBHdUMvSHVDKSwgaXQgbWFrZXMgc2Vuc2UgdG8gc3RvcCBwcmV0
ZW5kaW5nIHdlCmhhbmRsZSBXT1BDTSBhcyBhIGdsb2JhbCByZXNvdXJjZSBhbmQganVzdCBmb2N1
cyBvbiB0aGUgcGFydCB3ZSBjYXJlCmFib3V0LiBUaGVyZWZvcmUsIHdlIGNhbiBtb3ZlIHRoZSBp
bml0IGZ1bmN0aW9ucyBpbnNpZGUgZ3QvdWMgYW5kCmNvbnNvbGlkYXRlIGFsbCB0aGUgdUMgV09Q
Q00gZnVuY3Rpb25zIGluc2lkZSB0aGUgc2FtZSBmaWxlLgoKQXMgcGFydCBvZiB0aGUgbW92ZSwg
dGhlIGluaXRpYWxpemF0aW9uIGhhcyBiZWVuIHNsaWdodGx5IHNpbXBsaWZpZWQsCmluY2x1ZGlu
ZyBkcm9wcGluZyBhIGNoZWNrIG9uIEZXIGZldGNoIHRvIHZlcmlmeSB0aGF0IHRoZSBGVyBibG9i
IGlzIG5vdApiaWdnZXIgdGhhdCB0aGUgd2hvbGUgV09QQ00uIFRoaXMgbWVhbnMgdGhhdCBpbiB0
aGUgZXh0cmVtZWx5IHVubGlrZWx5CmNhc2Ugd2UgZG8gaGF2ZSBhIEZXIHRoYXQgaXMgdG9vIGJp
ZyAod2h5IHdvdWxkIHdlIGV2ZXIgc2hpcCBhIEZXIHRoYXQKY2FuJ3QgYmUgbG9hZGVkPykgd2Ug
bWlnaHQgdW5kZXJmbG93IGluIG91ciBwYXJ0aXRpb25pbmcgbWF0aCwgYnV0IHdlJ3JlCnN0aWxs
IHNhZmUgZHVlIHRvIHRoZSBjaGVjayB3ZSBwZXJmb3JtIHdoZW4gd2UgdmVyaWZ5IHRoZSBwYXJ0
aXRpb25pbmcKYWZ0ZXIgd2UncmUgZG9uZSB3aXRoIHRoZSBjYWxjdWxhdGlvbnMuIE5vdGUgdGhh
dCB0aGlzIGlzIG5vdCBhCnJlZ3Jlc3Npb24gZ2l2ZW4gdGhhdCBldmVuIG5vdyB3ZSBtaWdodCB1
bmRlcmZsb3cgaWYgdGhlIGJpbmFyeSBpcyBjbG9zZQp0byB0aGUgc2l6ZSBvZiB0aGUgV09QQ00g
ZHVlIHRvIGFkZGluZyB0aGUgcmVzZXJ2ZWQgcmVnaW9ucyB0byB0aGUgbWl4LgoKU2lnbmVkLW9m
Zi1ieTogRGFuaWVsZSBDZXJhb2xvIFNwdXJpbyA8ZGFuaWVsZS5jZXJhb2xvc3B1cmlvQGludGVs
LmNvbT4KQ2M6IE1pY2hhbCBXYWpkZWN6a28gPG1pY2hhbC53YWpkZWN6a29AaW50ZWwuY29tPgot
LS0KIERvY3VtZW50YXRpb24vZ3B1L2k5MTUucnN0ICAgICAgICAgICAgICAgICAgICB8ICAgMiAr
LQogZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUgICAgICAgICAgICAgICAgIHwgICA0ICst
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9nZ3R0LmMgICAgICAgICAgfCAgIDIgKy0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX3VjLmMgICAgICAgICB8ICA2NyArLS0t
LS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX3VjLmggICAgICAgICB8ICAy
NSArKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF91Y19mdy5jICAgICAgfCAg
MTEgLS0KIC4uLi97aW50ZWxfd29wY20uYyA9PiBndC91Yy9pbnRlbF91Y193b3BjbS5jfSB8IDE0
MSArKysrKysrKysrKystLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgICAg
ICAgICAgICAgICB8ICAgMiAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oICAgICAg
ICAgICAgICAgfCAgIDMgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyAgICAgICAg
ICAgICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF93b3BjbS5oICAgICAg
ICAgICAgfCAgNjAgLS0tLS0tLS0KIDExIGZpbGVzIGNoYW5nZWQsIDEyOCBpbnNlcnRpb25zKCsp
LCAxOTEgZGVsZXRpb25zKC0pCiByZW5hbWUgZHJpdmVycy9ncHUvZHJtL2k5MTUve2ludGVsX3dv
cGNtLmMgPT4gZ3QvdWMvaW50ZWxfdWNfd29wY20uY30gKDcxJSkKIGRlbGV0ZSBtb2RlIDEwMDY0
NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF93b3BjbS5oCgpkaWZmIC0tZ2l0IGEvRG9jdW1l
bnRhdGlvbi9ncHUvaTkxNS5yc3QgYi9Eb2N1bWVudGF0aW9uL2dwdS9pOTE1LnJzdAppbmRleCA0
MjliMDhhYWM3OTcuLjI4YzM5NmExODU3NCAxMDA2NDQKLS0tIGEvRG9jdW1lbnRhdGlvbi9ncHUv
aTkxNS5yc3QKKysrIGIvRG9jdW1lbnRhdGlvbi9ncHUvaTkxNS5yc3QKQEAgLTQzMCw3ICs0MzAs
NyBAQCBXT1BDTQogV09QQ00gTGF5b3V0CiB+fn5+fn5+fn5+fn4KIAotLi4ga2VybmVsLWRvYzo6
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3dvcGNtLmMKKy4uIGtlcm5lbC1kb2M6OiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF91Y193b3BjbS5jCiAgICA6ZG9jOiBXT1BDTSBM
YXlvdXQKIAogR3VDCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZSBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCmluZGV4IDJmY2U4YjAwNDBmMy4uYzM1ZDVl
ODI3ODM2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQorKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQpAQCAtMTYyLDEzICsxNjIsMTMgQEAgaTkxNS15
ICs9IFwKIAkgIGk5MTVfc2NoZWR1bGVyLm8gXAogCSAgaTkxNV90cmFjZV9wb2ludHMubyBcCiAJ
ICBpOTE1X3ZtYS5vIFwKLQkgIGludGVsX3JlZ2lvbl9sbWVtLm8gXAotCSAgaW50ZWxfd29wY20u
bworCSAgaW50ZWxfcmVnaW9uX2xtZW0ubwogCiAjIGdlbmVyYWwtcHVycG9zZSBtaWNyb2NvbnRy
b2xsZXIgKEd1Qykgc3VwcG9ydAogaTkxNS15ICs9IGd0L3VjL2ludGVsX3VjLm8gXAogCSAgZ3Qv
dWMvaW50ZWxfdWNfZGVidWdmcy5vIFwKIAkgIGd0L3VjL2ludGVsX3VjX2Z3Lm8gXAorCSAgZ3Qv
dWMvaW50ZWxfdWNfd29wY20ubyBcCiAJICBndC91Yy9pbnRlbF9ndWMubyBcCiAJICBndC91Yy9p
bnRlbF9ndWNfYWRzLm8gXAogCSAgZ3QvdWMvaW50ZWxfZ3VjX2N0Lm8gXApkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ2d0dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZ2d0dC5jCmluZGV4IGVlYmQxMTkwNTA2Zi4uNGEzYjgyZGMyNzY1IDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9nZ3R0LmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ2d0dC5jCkBAIC01MDYsNyArNTA2LDcgQEAgc3RhdGlj
IGludCBpbml0X2dndHQoc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCkKIAkgKiB3aHkuCiAJICovCiAJ
Z2d0dC0+cGluX2JpYXMgPSBtYXhfdCh1MzIsIEk5MTVfR1RUX1BBR0VfU0laRSwKLQkJCSAgICAg
ICBpbnRlbF93b3BjbV9ndWNfc2l6ZSgmZ2d0dC0+dm0uaTkxNS0+d29wY20pKTsKKwkJCSAgICAg
ICBpbnRlbF91Y193b3BjbV9ndWNfc2l6ZSgmZ2d0dC0+dm0uZ3QtPnVjKSk7CiAKIAlyZXQgPSBp
bnRlbF92Z3RfYmFsbG9vbihnZ3R0KTsKIAlpZiAocmV0KQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfdWMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3Vj
L2ludGVsX3VjLmMKaW5kZXggZjUxOGZlMDVjNmY5Li5lZTMyMDVlZWZkNzAgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX3VjLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvdWMvaW50ZWxfdWMuYwpAQCAtMzMzLDY5ICszMzMsNiBAQCBzdGF0aWMgaW50
IF9fdWNfc2FuaXRpemUoc3RydWN0IGludGVsX3VjICp1YykKIAlyZXR1cm4gX19pbnRlbF91Y19y
ZXNldF9odyh1Yyk7CiB9CiAKLS8qIEluaXRpYWxpemUgYW5kIHZlcmlmeSB0aGUgdUMgcmVncyBy
ZWxhdGVkIHRvIHVDIHBvc2l0aW9uaW5nIGluIFdPUENNICovCi1zdGF0aWMgaW50IHVjX2luaXRf
d29wY20oc3RydWN0IGludGVsX3VjICp1YykKLXsKLQlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gdWNf
dG9fZ3QodWMpOwotCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IGd0LT51bmNvcmU7Ci0J
dTMyIGJhc2UgPSBpbnRlbF93b3BjbV9ndWNfYmFzZSgmZ3QtPmk5MTUtPndvcGNtKTsKLQl1MzIg
c2l6ZSA9IGludGVsX3dvcGNtX2d1Y19zaXplKCZndC0+aTkxNS0+d29wY20pOwotCXUzMiBodWNf
YWdlbnQgPSBpbnRlbF91Y191c2VzX2h1Yyh1YykgPyBIVUNfTE9BRElOR19BR0VOVF9HVUMgOiAw
OwotCXUzMiBtYXNrOwotCWludCBlcnI7Ci0KLQlpZiAodW5saWtlbHkoIWJhc2UgfHwgIXNpemUp
KSB7Ci0JCWk5MTVfcHJvYmVfZXJyb3IoZ3QtPmk5MTUsICJVbnN1Y2Nlc3NmdWwgV09QQ00gcGFy
dGl0aW9uaW5nXG4iKTsKLQkJcmV0dXJuIC1FMkJJRzsKLQl9Ci0KLQlHRU1fQlVHX09OKCFpbnRl
bF91Y19zdXBwb3J0c19ndWModWMpKTsKLQlHRU1fQlVHX09OKCEoYmFzZSAmIEdVQ19XT1BDTV9P
RkZTRVRfTUFTSykpOwotCUdFTV9CVUdfT04oYmFzZSAmIH5HVUNfV09QQ01fT0ZGU0VUX01BU0sp
OwotCUdFTV9CVUdfT04oIShzaXplICYgR1VDX1dPUENNX1NJWkVfTUFTSykpOwotCUdFTV9CVUdf
T04oc2l6ZSAmIH5HVUNfV09QQ01fU0laRV9NQVNLKTsKLQotCWVyciA9IGk5MTVfaW5qZWN0X3By
b2JlX2Vycm9yKGd0LT5pOTE1LCAtRU5YSU8pOwotCWlmIChlcnIpCi0JCXJldHVybiBlcnI7Ci0K
LQltYXNrID0gR1VDX1dPUENNX1NJWkVfTUFTSyB8IEdVQ19XT1BDTV9TSVpFX0xPQ0tFRDsKLQll
cnIgPSBpbnRlbF91bmNvcmVfd3JpdGVfYW5kX3ZlcmlmeSh1bmNvcmUsIEdVQ19XT1BDTV9TSVpF
LCBzaXplLCBtYXNrLAotCQkJCQkgICAgc2l6ZSB8IEdVQ19XT1BDTV9TSVpFX0xPQ0tFRCk7Ci0J
aWYgKGVycikKLQkJZ290byBlcnJfb3V0OwotCi0JbWFzayA9IEdVQ19XT1BDTV9PRkZTRVRfTUFT
SyB8IEdVQ19XT1BDTV9PRkZTRVRfVkFMSUQgfCBodWNfYWdlbnQ7Ci0JZXJyID0gaW50ZWxfdW5j
b3JlX3dyaXRlX2FuZF92ZXJpZnkodW5jb3JlLCBETUFfR1VDX1dPUENNX09GRlNFVCwKLQkJCQkJ
ICAgIGJhc2UgfCBodWNfYWdlbnQsIG1hc2ssCi0JCQkJCSAgICBiYXNlIHwgaHVjX2FnZW50IHwK
LQkJCQkJICAgIEdVQ19XT1BDTV9PRkZTRVRfVkFMSUQpOwotCWlmIChlcnIpCi0JCWdvdG8gZXJy
X291dDsKLQotCXJldHVybiAwOwotCi1lcnJfb3V0OgotCWk5MTVfcHJvYmVfZXJyb3IoZ3QtPmk5
MTUsICJGYWlsZWQgdG8gaW5pdCB1QyBXT1BDTSByZWdpc3RlcnMhXG4iKTsKLQlpOTE1X3Byb2Jl
X2Vycm9yKGd0LT5pOTE1LCAiJXMoJSN4KT0lI3hcbiIsICJETUFfR1VDX1dPUENNX09GRlNFVCIs
Ci0JCQkgaTkxNV9tbWlvX3JlZ19vZmZzZXQoRE1BX0dVQ19XT1BDTV9PRkZTRVQpLAotCQkJIGlu
dGVsX3VuY29yZV9yZWFkKHVuY29yZSwgRE1BX0dVQ19XT1BDTV9PRkZTRVQpKTsKLQlpOTE1X3By
b2JlX2Vycm9yKGd0LT5pOTE1LCAiJXMoJSN4KT0lI3hcbiIsICJHVUNfV09QQ01fU0laRSIsCi0J
CQkgaTkxNV9tbWlvX3JlZ19vZmZzZXQoR1VDX1dPUENNX1NJWkUpLAotCQkJIGludGVsX3VuY29y
ZV9yZWFkKHVuY29yZSwgR1VDX1dPUENNX1NJWkUpKTsKLQotCXJldHVybiBlcnI7Ci19Ci0KLXN0
YXRpYyBib29sIHVjX2lzX3dvcGNtX2xvY2tlZChzdHJ1Y3QgaW50ZWxfdWMgKnVjKQotewotCXN0
cnVjdCBpbnRlbF9ndCAqZ3QgPSB1Y190b19ndCh1Yyk7Ci0Jc3RydWN0IGludGVsX3VuY29yZSAq
dW5jb3JlID0gZ3QtPnVuY29yZTsKLQotCXJldHVybiAoaW50ZWxfdW5jb3JlX3JlYWQodW5jb3Jl
LCBHVUNfV09QQ01fU0laRSkgJiBHVUNfV09QQ01fU0laRV9MT0NLRUQpIHx8Ci0JICAgICAgIChp
bnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIERNQV9HVUNfV09QQ01fT0ZGU0VUKSAmIEdVQ19XT1BD
TV9PRkZTRVRfVkFMSUQpOwotfQotCiBzdGF0aWMgaW50IF9fdWNfY2hlY2tfaHcoc3RydWN0IGlu
dGVsX3VjICp1YykKIHsKIAlpZiAoIWludGVsX3VjX3N1cHBvcnRzX2d1Yyh1YykpCkBAIC00MDYs
NyArMzQzLDcgQEAgc3RhdGljIGludCBfX3VjX2NoZWNrX2h3KHN0cnVjdCBpbnRlbF91YyAqdWMp
CiAJICogYmVmb3JlIG9uIHRoaXMgc3lzdGVtIGFmdGVyIHJlYm9vdCwgb3RoZXJ3aXNlIHdlIHJp
c2sgR1BVIGhhbmdzLgogCSAqIFRvIGNoZWNrIGlmIEd1QyB3YXMgbG9hZGVkIGJlZm9yZSB3ZSBs
b29rIGF0IFdPUENNIHJlZ2lzdGVycy4KIAkgKi8KLQlpZiAodWNfaXNfd29wY21fbG9ja2VkKHVj
KSkKKwlpZiAoaW50ZWxfdWNfaXNfd29wY21fbG9ja2VkKHVjKSkKIAkJcmV0dXJuIC1FSU87CiAK
IAlyZXR1cm4gMDsKQEAgLTQzMCw3ICszNjcsNyBAQCBzdGF0aWMgaW50IF9fdWNfaW5pdF9odyhz
dHJ1Y3QgaW50ZWxfdWMgKnVjKQogCQlnb3RvIGVycl9vdXQ7CiAJfQogCi0JcmV0ID0gdWNfaW5p
dF93b3BjbSh1Yyk7CisJcmV0ID0gaW50ZWxfdWNfaW5pdF93b3BjbSh1Yyk7CiAJaWYgKHJldCkK
IAkJZ290byBlcnJfb3V0OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91
Yy9pbnRlbF91Yy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfdWMuaAppbmRl
eCA5Yzk1NGM1ODllZGYuLmI4OTM2MzYwOGY5YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvdWMvaW50ZWxfdWMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9p
bnRlbF91Yy5oCkBAIC0yOCw2ICsyOCwxMiBAQCBzdHJ1Y3QgaW50ZWxfdWMgewogCXN0cnVjdCBp
bnRlbF9ndWMgZ3VjOwogCXN0cnVjdCBpbnRlbF9odWMgaHVjOwogCisJLyogV09QQ00gcGFydGl0
aW9uaW5nIGZvciB1YyB1c2FnZSAqLworCXN0cnVjdCB7CisJCXUzMiBndWNfYmFzZTsKKwkJdTMy
IGd1Y19zaXplOworCX0gd29wY207CisKIAkvKiBTbmFwc2hvdCBvZiBHdUMgbG9nIGZyb20gbGFz
dCBmYWlsZWQgbG9hZCAqLwogCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpsb2FkX2Vycl9s
b2c7CiB9OwpAQCAtNDIsNiArNDgsMjUgQEAgdm9pZCBpbnRlbF91Y19ydW50aW1lX3N1c3BlbmQo
c3RydWN0IGludGVsX3VjICp1Yyk7CiBpbnQgaW50ZWxfdWNfcmVzdW1lKHN0cnVjdCBpbnRlbF91
YyAqdWMpOwogaW50IGludGVsX3VjX3J1bnRpbWVfcmVzdW1lKHN0cnVjdCBpbnRlbF91YyAqdWMp
OwogCit2b2lkIGludGVsX3VjX3BhcnRpdGlvbl93b3BjbShzdHJ1Y3QgaW50ZWxfdWMgKnVjKTsK
K2ludCBpbnRlbF91Y19pbml0X3dvcGNtKHN0cnVjdCBpbnRlbF91YyAqdWMpOworYm9vbCBpbnRl
bF91Y19pc193b3BjbV9sb2NrZWQoc3RydWN0IGludGVsX3VjICp1Yyk7CisKKy8qKgorICogaW50
ZWxfdWNfd29wY21fZ3VjX3NpemUoKQorICogQHVjOglpbnRlbF91YyBzdHJ1Y3R1cmUKKyAqCisg
KiBSZXR1cm5zIHNpemUgb2YgdGhlIFdPUENNIHNoYWRvd2VkIHJlZ2lvbi4KKyAqCisgKiBSZXR1
cm5zOgorICogMCBpZiBHdUMgaXMgbm90IHByZXNlbnQgb3Igbm90IGluIHVzZS4KKyAqIE90aGVy
d2lzZSwgdGhlIEd1QyBXT1BDTSBzaXplLgorICovCitzdGF0aWMgaW5saW5lIHUzMiBpbnRlbF91
Y193b3BjbV9ndWNfc2l6ZShzdHJ1Y3QgaW50ZWxfdWMgKnVjKQoreworCXJldHVybiB1Yy0+d29w
Y20uZ3VjX3NpemU7Cit9CisKIC8qCiAgKiBXZSBuZWVkIHRvIGtub3cgYXMgZWFybHkgYXMgcG9z
c2libGUgaWYgd2UncmUgZ29pbmcgdG8gdXNlIEd1QyBvciBub3QgdG8KICAqIHRha2UgdGhlIGNv
cnJlY3Qgc2V0dXAgcGF0aHMuIEFkZGl0aW9uYWxseSwgb25jZSB3ZSd2ZSBzdGFydGVkIGxvYWRp
bmcgdGhlCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF91Y19m
dy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfdWNfZncuYwppbmRleCBlMWNh
YWU5Mzk5NmQuLmZmMjEzMGY4ZWUxOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvdWMvaW50ZWxfdWNfZncuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRl
bF91Y19mdy5jCkBAIC0yODAsNyArMjgwLDYgQEAgaW50IGludGVsX3VjX2Z3X2ZldGNoKHN0cnVj
dCBpbnRlbF91Y19mdyAqdWNfZncpCiAJc2l6ZV90IHNpemU7CiAJaW50IGVycjsKIAotCUdFTV9C
VUdfT04oIWk5MTUtPndvcGNtLnNpemUpOwogCUdFTV9CVUdfT04oIWludGVsX3VjX2Z3X2lzX2Vu
YWJsZWQodWNfZncpKTsKIAogCWVyciA9IGk5MTVfaW5qZWN0X3Byb2JlX2Vycm9yKGk5MTUsIC1F
TlhJTyk7CkBAIC0zNDAsMTYgKzMzOSw2IEBAIGludCBpbnRlbF91Y19md19mZXRjaChzdHJ1Y3Qg
aW50ZWxfdWNfZncgKnVjX2Z3KQogCQlnb3RvIGZhaWw7CiAJfQogCi0JLyogU2FuaXR5IGNoZWNr
IHdoZXRoZXIgdGhpcyBmdyBpcyBub3QgbGFyZ2VyIHRoYW4gd2hvbGUgV09QQ00gbWVtb3J5ICov
Ci0Jc2l6ZSA9IF9faW50ZWxfdWNfZndfZ2V0X3VwbG9hZF9zaXplKHVjX2Z3KTsKLQlpZiAodW5s
aWtlbHkoc2l6ZSA+PSBpOTE1LT53b3BjbS5zaXplKSkgewotCQlkcm1fd2FybigmaTkxNS0+ZHJt
LCAiJXMgZmlybXdhcmUgJXM6IGludmFsaWQgc2l6ZTogJXp1ID4gJXp1XG4iLAotCQkJIGludGVs
X3VjX2Z3X3R5cGVfcmVwcih1Y19mdy0+dHlwZSksIHVjX2Z3LT5wYXRoLAotCQkJIHNpemUsIChz
aXplX3QpaTkxNS0+d29wY20uc2l6ZSk7Ci0JCWVyciA9IC1FMkJJRzsKLQkJZ290byBmYWlsOwot
CX0KLQogCS8qIEdldCB2ZXJzaW9uIG51bWJlcnMgZnJvbSB0aGUgQ1NTIGhlYWRlciAqLwogCXVj
X2Z3LT5tYWpvcl92ZXJfZm91bmQgPSBGSUVMRF9HRVQoQ1NTX1NXX1ZFUlNJT05fVUNfTUFKT1Is
CiAJCQkJCSAgIGNzcy0+c3dfdmVyc2lvbik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF93b3BjbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfdWNf
d29wY20uYwpzaW1pbGFyaXR5IGluZGV4IDcxJQpyZW5hbWUgZnJvbSBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF93b3BjbS5jCnJlbmFtZSB0byBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9p
bnRlbF91Y193b3BjbS5jCmluZGV4IDIxODYzODZhNDVjOC4uZDg0YTFlYjA2YzhlIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF93b3BjbS5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L3VjL2ludGVsX3VjX3dvcGNtLmMKQEAgLTMsNyArMyw5IEBACiAgKiBDb3B5
cmlnaHQgwqkgMjAxNy0yMDE5IEludGVsIENvcnBvcmF0aW9uCiAgKi8KIAotI2luY2x1ZGUgImlu
dGVsX3dvcGNtLmgiCisjaW5jbHVkZSAiaW50ZWxfdWMuaCIKKyNpbmNsdWRlICJndC9pbnRlbF9n
dC5oIgorCiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKIAogLyoqCkBAIC02MywzMiArNjUsNiBAQAog
I2RlZmluZSBHRU45X0dVQ19GV19SRVNFUlZFRAlTWl8xMjhLCiAjZGVmaW5lIEdFTjlfR1VDX1dP
UENNX09GRlNFVAkoR1VDX1dPUENNX1JFU0VSVkVEICsgR0VOOV9HVUNfRldfUkVTRVJWRUQpCiAK
LXN0YXRpYyBpbmxpbmUgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKndvcGNtX3RvX2k5MTUoc3Ry
dWN0IGludGVsX3dvcGNtICp3b3BjbSkKLXsKLQlyZXR1cm4gY29udGFpbmVyX29mKHdvcGNtLCBz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSwgd29wY20pOwotfQotCi0vKioKLSAqIGludGVsX3dvcGNt
X2luaXRfZWFybHkoKSAtIEVhcmx5IGluaXRpYWxpemF0aW9uIG9mIHRoZSBXT1BDTS4KLSAqIEB3
b3BjbTogcG9pbnRlciB0byBpbnRlbF93b3BjbS4KLSAqCi0gKiBTZXR1cCB0aGUgc2l6ZSBvZiBX
T1BDTSB3aGljaCB3aWxsIGJlIHVzZWQgYnkgbGF0ZXIgb24gV09QQ00gcGFydGl0aW9uaW5nLgot
ICovCi12b2lkIGludGVsX3dvcGNtX2luaXRfZWFybHkoc3RydWN0IGludGVsX3dvcGNtICp3b3Bj
bSkKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHdvcGNtX3RvX2k5MTUod29w
Y20pOwotCi0JaWYgKCFIQVNfR1RfVUMoaTkxNSkpCi0JCXJldHVybjsKLQotCWlmIChJTlRFTF9H
RU4oaTkxNSkgPj0gMTEpCi0JCXdvcGNtLT5zaXplID0gR0VOMTFfV09QQ01fU0laRTsKLQllbHNl
Ci0JCXdvcGNtLT5zaXplID0gR0VOOV9XT1BDTV9TSVpFOwotCi0JZHJtX2RiZygmaTkxNS0+ZHJt
LCAiV09QQ006ICV1S1xuIiwgd29wY20tPnNpemUgLyAxMDI0KTsKLX0KLQogc3RhdGljIGlubGlu
ZSB1MzIgY29udGV4dF9yZXNlcnZlZF9zaXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQogewogCWlmIChJU19HRU45X0xQKGk5MTUpKQpAQCAtMjA5LDggKzE4NSw4IEBAIHN0YXRpYyBi
b29sIF9fd29wY21fcmVnc19sb2NrZWQoc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlLAogfQog
CiAvKioKLSAqIGludGVsX3dvcGNtX2luaXQoKSAtIEluaXRpYWxpemUgdGhlIFdPUENNIHN0cnVj
dHVyZS4KLSAqIEB3b3BjbTogcG9pbnRlciB0byBpbnRlbF93b3BjbS4KKyAqIGludGVsX3VjX3Bh
cnRpdGlvbl93b3BjbSgpIC0gSW5pdGlhbGl6ZSBXT1BDTSBwYXJ0aXRpb25pbmcgZm9yIEZXIGxv
YWRpbmcuCisgKiBAdWM6IHBvaW50ZXIgdG8gaW50ZWxfdWMuCiAgKgogICogVGhpcyBmdW5jdGlv
biB3aWxsIHBhcnRpdGlvbiBXT1BDTSBzcGFjZSBiYXNlZCBvbiBHdUMgYW5kIEh1QyBmaXJtd2Fy
ZSBzaXplcwogICogYW5kIHdpbGwgYWxsb2NhdGUgbWF4IHJlbWFpbmluZyBmb3IgdXNlIGJ5IEd1
Qy4gVGhpcyBmdW5jdGlvbiB3aWxsIGFsc28KQEAgLTIxOCwyNSArMTk0LDMwIEBAIHN0YXRpYyBi
b29sIF9fd29wY21fcmVnc19sb2NrZWQoc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlLAogICog
c2l6ZS4gSXQgd2lsbCBmYWlsIHRoZSBXT1BDTSBpbml0IGlmIGFueSBvZiB0aGVzZSBjaGVja3Mg
ZmFpbCwgc28gdGhhdCB0aGUKICAqIGZvbGxvd2luZyBXT1BDTSByZWdpc3RlcnMgc2V0dXAgYW5k
IEd1QyBmaXJtd2FyZSB1cGxvYWRpbmcgd291bGQgYmUgYWJvcnRlZC4KICAqLwotdm9pZCBpbnRl
bF93b3BjbV9pbml0KHN0cnVjdCBpbnRlbF93b3BjbSAqd29wY20pCit2b2lkIGludGVsX3VjX3Bh
cnRpdGlvbl93b3BjbShzdHJ1Y3QgaW50ZWxfdWMgKnVjKQogewotCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gd29wY21fdG9faTkxNSh3b3BjbSk7Ci0Jc3RydWN0IGludGVsX2d0ICpn
dCA9ICZpOTE1LT5ndDsKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gdWNfdG9fZ3QodWMpOworCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3QtPmk5MTU7CiAJdTMyIGd1Y19md19zaXpl
ID0gaW50ZWxfdWNfZndfZ2V0X3VwbG9hZF9zaXplKCZndC0+dWMuZ3VjLmZ3KTsKIAl1MzIgaHVj
X2Z3X3NpemUgPSBpbnRlbF91Y19md19nZXRfdXBsb2FkX3NpemUoJmd0LT51Yy5odWMuZncpOwog
CXUzMiBjdHhfcnN2ZCA9IGNvbnRleHRfcmVzZXJ2ZWRfc2l6ZShpOTE1KTsKKwl1MzIgd29wY21f
c2l6ZTsKIAl1MzIgZ3VjX3dvcGNtX2Jhc2U7CiAJdTMyIGd1Y193b3BjbV9zaXplOwogCiAJaWYg
KCFndWNfZndfc2l6ZSkKIAkJcmV0dXJuOwogCi0JR0VNX0JVR19PTighd29wY20tPnNpemUpOwot
CUdFTV9CVUdfT04od29wY20tPmd1Yy5iYXNlKTsKLQlHRU1fQlVHX09OKHdvcGNtLT5ndWMuc2l6
ZSk7Ci0JR0VNX0JVR19PTihndWNfZndfc2l6ZSA+PSB3b3BjbS0+c2l6ZSk7Ci0JR0VNX0JVR19P
TihodWNfZndfc2l6ZSA+PSB3b3BjbS0+c2l6ZSk7Ci0JR0VNX0JVR19PTihjdHhfcnN2ZCArIFdP
UENNX1JFU0VSVkVEX1NJWkUgPj0gd29wY20tPnNpemUpOworCWlmIChJTlRFTF9HRU4oaTkxNSkg
Pj0gMTEpCisJCXdvcGNtX3NpemUgPSBHRU4xMV9XT1BDTV9TSVpFOworCWVsc2UKKwkJd29wY21f
c2l6ZSA9IEdFTjlfV09QQ01fU0laRTsKKworCWRybV9kYmcoJmk5MTUtPmRybSwgIldPUENNOiAl
dUtcbiIsIHdvcGNtX3NpemUgLyAxMDI0KTsKKworCUdFTV9CVUdfT04odWMtPndvcGNtLmd1Y19i
YXNlKTsKKwlHRU1fQlVHX09OKHVjLT53b3BjbS5ndWNfc2l6ZSk7CisJR0VNX0JVR19PTihjdHhf
cnN2ZCArIFdPUENNX1JFU0VSVkVEX1NJWkUgPj0gd29wY21fc2l6ZSk7CiAKIAlpZiAoaTkxNV9p
bmplY3RfcHJvYmVfZmFpbHVyZShpOTE1KSkKIAkJcmV0dXJuOwpAQCAtMjU4LDIxICsyMzksOTEg
QEAgdm9pZCBpbnRlbF93b3BjbV9pbml0KHN0cnVjdCBpbnRlbF93b3BjbSAqd29wY20pCiAJICog
TmVlZCB0byBjbGFtcCBndWNfd29wY21fYmFzZSBub3cgdG8gbWFrZSBzdXJlIHRoZSBmb2xsb3dp
bmcgbWF0aCBpcwogCSAqIGNvcnJlY3QuIEZvcm1hbCBjaGVjayBvZiB3aG9sZSBXT1BDTSBsYXlv
dXQgd2lsbCBiZSBkb25lIGJlbG93LgogCSAqLwotCWd1Y193b3BjbV9iYXNlID0gbWluKGd1Y193
b3BjbV9iYXNlLCB3b3BjbS0+c2l6ZSAtIGN0eF9yc3ZkKTsKKwlndWNfd29wY21fYmFzZSA9IG1p
bihndWNfd29wY21fYmFzZSwgd29wY21fc2l6ZSAtIGN0eF9yc3ZkKTsKIAogCS8qIEFsaWduZWQg
cmVtYWluaW5ncyBvZiB1c2FibGUgV09QQ00gc3BhY2UgY2FuIGJlIGFzc2lnbmVkIHRvIEd1Qy4g
Ki8KLQlndWNfd29wY21fc2l6ZSA9IHdvcGNtLT5zaXplIC0gY3R4X3JzdmQgLSBndWNfd29wY21f
YmFzZTsKKwlndWNfd29wY21fc2l6ZSA9IHdvcGNtX3NpemUgLSBjdHhfcnN2ZCAtIGd1Y193b3Bj
bV9iYXNlOwogCWd1Y193b3BjbV9zaXplICY9IEdVQ19XT1BDTV9TSVpFX01BU0s7CiAKIAlkcm1f
ZGJnKCZpOTE1LT5kcm0sICJDYWxjdWxhdGVkIEd1QyBXT1BDTSBbJXVLLCAldUspXG4iLAogCQln
dWNfd29wY21fYmFzZSAvIFNaXzFLLCBndWNfd29wY21fc2l6ZSAvIFNaXzFLKTsKIAogY2hlY2s6
Ci0JaWYgKF9fY2hlY2tfbGF5b3V0KGk5MTUsIHdvcGNtLT5zaXplLCBndWNfd29wY21fYmFzZSwg
Z3VjX3dvcGNtX3NpemUsCisJaWYgKF9fY2hlY2tfbGF5b3V0KGk5MTUsIHdvcGNtX3NpemUsIGd1
Y193b3BjbV9iYXNlLCBndWNfd29wY21fc2l6ZSwKIAkJCSAgIGd1Y19md19zaXplLCBodWNfZndf
c2l6ZSkpIHsKLQkJd29wY20tPmd1Yy5iYXNlID0gZ3VjX3dvcGNtX2Jhc2U7Ci0JCXdvcGNtLT5n
dWMuc2l6ZSA9IGd1Y193b3BjbV9zaXplOwotCQlHRU1fQlVHX09OKCF3b3BjbS0+Z3VjLmJhc2Up
OwotCQlHRU1fQlVHX09OKCF3b3BjbS0+Z3VjLnNpemUpOworCQl1Yy0+d29wY20uZ3VjX2Jhc2Ug
PSBndWNfd29wY21fYmFzZTsKKwkJdWMtPndvcGNtLmd1Y19zaXplID0gZ3VjX3dvcGNtX3NpemU7
CisJCUdFTV9CVUdfT04oIXVjLT53b3BjbS5ndWNfYmFzZSk7CisJCUdFTV9CVUdfT04oIXVjLT53
b3BjbS5ndWNfc2l6ZSk7CisJfQorfQorCisvKioKKyAqIGludGVsX3VjX2luaXRfd29wY20oKSAt
IHNldHVwIHVDIFdPUENNIHJlZ2lzdGVycyBhaGVhZCBvZiBGVyBsb2FkaW5nLgorICogQHVjOiBw
b2ludGVyIHRvIGludGVsX3VjLgorICoKKyAqIEluaXRpYWxpemUgYW5kIHZlcmlmeSB0aGUgdUMg
cmVncyByZWxhdGVkIHRvIHVDIHBvc2l0aW9uaW5nIGluIFdPUENNCisgKgorICogUmV0dXJuOiAw
IGlmIHN1Y2Nlc3NmdWwsIG5lZ2F0aXZlIGVycm5vIGNvZGUgb24gZmFpbHVyZS4KKyAqLworaW50
IGludGVsX3VjX2luaXRfd29wY20oc3RydWN0IGludGVsX3VjICp1YykKK3sKKwlzdHJ1Y3QgaW50
ZWxfZ3QgKmd0ID0gdWNfdG9fZ3QodWMpOworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9
IGd0LT51bmNvcmU7CisJdTMyIGJhc2UgPSB1Yy0+d29wY20uZ3VjX2Jhc2U7CisJdTMyIHNpemUg
PSB1Yy0+d29wY20uZ3VjX3NpemU7CisJdTMyIGh1Y19hZ2VudCA9IGludGVsX3VjX3VzZXNfaHVj
KHVjKSA/IEhVQ19MT0FESU5HX0FHRU5UX0dVQyA6IDA7CisJdTMyIG1hc2s7CisJaW50IGVycjsK
KworCWlmICh1bmxpa2VseSghYmFzZSB8fCAhc2l6ZSkpIHsKKwkJaTkxNV9wcm9iZV9lcnJvcihn
dC0+aTkxNSwgIlVuc3VjY2Vzc2Z1bCBXT1BDTSBwYXJ0aXRpb25pbmdcbiIpOworCQlyZXR1cm4g
LUUyQklHOwogCX0KKworCUdFTV9CVUdfT04oIWludGVsX3VjX3N1cHBvcnRzX2d1Yyh1YykpOwor
CUdFTV9CVUdfT04oIShiYXNlICYgR1VDX1dPUENNX09GRlNFVF9NQVNLKSk7CisJR0VNX0JVR19P
TihiYXNlICYgfkdVQ19XT1BDTV9PRkZTRVRfTUFTSyk7CisJR0VNX0JVR19PTighKHNpemUgJiBH
VUNfV09QQ01fU0laRV9NQVNLKSk7CisJR0VNX0JVR19PTihzaXplICYgfkdVQ19XT1BDTV9TSVpF
X01BU0spOworCisJZXJyID0gaTkxNV9pbmplY3RfcHJvYmVfZXJyb3IoZ3QtPmk5MTUsIC1FTlhJ
Tyk7CisJaWYgKGVycikKKwkJcmV0dXJuIGVycjsKKworCW1hc2sgPSBHVUNfV09QQ01fU0laRV9N
QVNLIHwgR1VDX1dPUENNX1NJWkVfTE9DS0VEOworCWVyciA9IGludGVsX3VuY29yZV93cml0ZV9h
bmRfdmVyaWZ5KHVuY29yZSwgR1VDX1dPUENNX1NJWkUsIHNpemUsIG1hc2ssCisJCQkJCSAgICBz
aXplIHwgR1VDX1dPUENNX1NJWkVfTE9DS0VEKTsKKwlpZiAoZXJyKQorCQlnb3RvIGVycl9vdXQ7
CisKKwltYXNrID0gR1VDX1dPUENNX09GRlNFVF9NQVNLIHwgR1VDX1dPUENNX09GRlNFVF9WQUxJ
RCB8IGh1Y19hZ2VudDsKKwllcnIgPSBpbnRlbF91bmNvcmVfd3JpdGVfYW5kX3ZlcmlmeSh1bmNv
cmUsIERNQV9HVUNfV09QQ01fT0ZGU0VULAorCQkJCQkgICAgYmFzZSB8IGh1Y19hZ2VudCwgbWFz
aywKKwkJCQkJICAgIGJhc2UgfCBodWNfYWdlbnQgfAorCQkJCQkgICAgR1VDX1dPUENNX09GRlNF
VF9WQUxJRCk7CisJaWYgKGVycikKKwkJZ290byBlcnJfb3V0OworCisJcmV0dXJuIDA7CisKK2Vy
cl9vdXQ6CisJaTkxNV9wcm9iZV9lcnJvcihndC0+aTkxNSwgIkZhaWxlZCB0byBpbml0IHVDIFdP
UENNIHJlZ2lzdGVycyFcbiIpOworCWk5MTVfcHJvYmVfZXJyb3IoZ3QtPmk5MTUsICIlcyglI3gp
PSUjeFxuIiwgIkRNQV9HVUNfV09QQ01fT0ZGU0VUIiwKKwkJCSBpOTE1X21taW9fcmVnX29mZnNl
dChETUFfR1VDX1dPUENNX09GRlNFVCksCisJCQkgaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBE
TUFfR1VDX1dPUENNX09GRlNFVCkpOworCWk5MTVfcHJvYmVfZXJyb3IoZ3QtPmk5MTUsICIlcygl
I3gpPSUjeFxuIiwgIkdVQ19XT1BDTV9TSVpFIiwKKwkJCSBpOTE1X21taW9fcmVnX29mZnNldChH
VUNfV09QQ01fU0laRSksCisJCQkgaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHVUNfV09QQ01f
U0laRSkpOworCisJcmV0dXJuIGVycjsKK30KKworYm9vbCBpbnRlbF91Y19pc193b3BjbV9sb2Nr
ZWQoc3RydWN0IGludGVsX3VjICp1YykKK3sKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gdWNfdG9f
Z3QodWMpOworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IGd0LT51bmNvcmU7CisKKwly
ZXR1cm4gKGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR1VDX1dPUENNX1NJWkUpICYgR1VDX1dP
UENNX1NJWkVfTE9DS0VEKSB8fAorCSAgICAgICAoaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBE
TUFfR1VDX1dPUENNX09GRlNFVCkgJiBHVUNfV09QQ01fT0ZGU0VUX1ZBTElEKTsKIH0KZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2Rydi5jCmluZGV4IGE3YTNiNGI5ODU3Mi4uYWI2MjNmZWYzODg0IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZHJ2LmMKQEAgLTQ1MSw4ICs0NTEsNiBAQCBzdGF0aWMgaW50IGk5MTVfZHJp
dmVyX2Vhcmx5X3Byb2JlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlpZiAo
cmV0IDwgMCkKIAkJZ290byBlcnJfd29ya3F1ZXVlczsKIAotCWludGVsX3dvcGNtX2luaXRfZWFy
bHkoJmRldl9wcml2LT53b3BjbSk7Ci0KIAlpbnRlbF9ndF9pbml0X2Vhcmx5KCZkZXZfcHJpdi0+
Z3QsIGRldl9wcml2KTsKIAogCWk5MTVfZ2VtX2luaXRfZWFybHkoZGV2X3ByaXYpOwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZHJ2LmgKaW5kZXggZTllZTRkYWE5MzIwLi5kMzQ2YTIwZTg3MDggMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9kcnYuaApAQCAtODksNyArODksNiBAQAogI2luY2x1ZGUgImludGVsX21lbW9y
eV9yZWdpb24uaCIKICNpbmNsdWRlICJpbnRlbF91bmNvcmUuaCIKICNpbmNsdWRlICJpbnRlbF93
YWtlcmVmLmgiCi0jaW5jbHVkZSAiaW50ZWxfd29wY20uaCIKIAogI2luY2x1ZGUgImk5MTVfZ2Vt
LmgiCiAjaW5jbHVkZSAiaTkxNV9nZW1fZ3R0LmgiCkBAIC04NjAsOCArODU5LDYgQEAgc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgewogCiAJc3RydWN0IGludGVsX2d2dCAqZ3Z0OwogCi0Jc3RydWN0
IGludGVsX3dvcGNtIHdvcGNtOwotCiAJc3RydWN0IGludGVsX2NzciBjc3I7CiAKIAlzdHJ1Y3Qg
aW50ZWxfZ21idXMgZ21idXNbR01CVVNfTlVNX1BJTlNdOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMK
aW5kZXggMGNiY2I5ZjU0ZTdkLi5lYWZkMDE1YTJkYzUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZ2VtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0u
YwpAQCAtMTEwNSw3ICsxMTA1LDcgQEAgaW50IGk5MTVfZ2VtX2luaXQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQogCQlyZXR1cm4gcmV0OwogCiAJaW50ZWxfdWNfZmV0Y2hfZmly
bXdhcmVzKCZkZXZfcHJpdi0+Z3QudWMpOwotCWludGVsX3dvcGNtX2luaXQoJmRldl9wcml2LT53
b3BjbSk7CisJaW50ZWxfdWNfcGFydGl0aW9uX3dvcGNtKCZkZXZfcHJpdi0+Z3QudWMpOwogCiAJ
cmV0ID0gaTkxNV9pbml0X2dndHQoZGV2X3ByaXYpOwogCWlmIChyZXQpIHsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3dvcGNtLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF93b3BjbS5oCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAxN2Q2YWE4NjAw
OGEuLjAwMDAwMDAwMDAwMAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF93b3BjbS5o
CisrKyAvZGV2L251bGwKQEAgLTEsNjAgKzAsMCBAQAotLyoKLSAqIFNQRFgtTGljZW5zZS1JZGVu
dGlmaWVyOiBNSVQKLSAqCi0gKiBDb3B5cmlnaHQgwqkgMjAxNy0yMDE4IEludGVsIENvcnBvcmF0
aW9uCi0gKi8KLQotI2lmbmRlZiBfSU5URUxfV09QQ01fSF8KLSNkZWZpbmUgX0lOVEVMX1dPUENN
X0hfCi0KLSNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgotCi0vKioKLSAqIHN0cnVjdCBpbnRlbF93
b3BjbSAtIE92ZXJhbGwgV09QQ00gaW5mbyBhbmQgV09QQ00gcmVnaW9ucy4KLSAqIEBzaXplOiBT
aXplIG9mIG92ZXJhbGwgV09QQ00uCi0gKiBAZ3VjOiBHdUMgV09QQ00gUmVnaW9uIGluZm8uCi0g
KiBAZ3VjLmJhc2U6IEd1QyBXT1BDTSBiYXNlIHdoaWNoIGlzIG9mZnNldCBmcm9tIFdPUENNIGJh
c2UuCi0gKiBAZ3VjLnNpemU6IFNpemUgb2YgdGhlIEd1QyBXT1BDTSByZWdpb24uCi0gKi8KLXN0
cnVjdCBpbnRlbF93b3BjbSB7Ci0JdTMyIHNpemU7Ci0Jc3RydWN0IHsKLQkJdTMyIGJhc2U7Ci0J
CXUzMiBzaXplOwotCX0gZ3VjOwotfTsKLQotLyoqCi0gKiBpbnRlbF93b3BjbV9ndWNfYmFzZSgp
Ci0gKiBAd29wY206CWludGVsX3dvcGNtIHN0cnVjdHVyZQotICoKLSAqIFJldHVybnMgdGhlIGJh
c2Ugb2YgdGhlIFdPUENNIHNoYWRvd2VkIHJlZ2lvbi4KLSAqCi0gKiBSZXR1cm5zOgotICogMCBp
ZiBHdUMgaXMgbm90IHByZXNlbnQgb3Igbm90IGluIHVzZS4KLSAqIE90aGVyd2lzZSwgdGhlIEd1
QyBXT1BDTSBiYXNlLgotICovCi1zdGF0aWMgaW5saW5lIHUzMiBpbnRlbF93b3BjbV9ndWNfYmFz
ZShzdHJ1Y3QgaW50ZWxfd29wY20gKndvcGNtKQotewotCXJldHVybiB3b3BjbS0+Z3VjLmJhc2U7
Ci19Ci0KLS8qKgotICogaW50ZWxfd29wY21fZ3VjX3NpemUoKQotICogQHdvcGNtOglpbnRlbF93
b3BjbSBzdHJ1Y3R1cmUKLSAqCi0gKiBSZXR1cm5zIHNpemUgb2YgdGhlIFdPUENNIHNoYWRvd2Vk
IHJlZ2lvbi4KLSAqCi0gKiBSZXR1cm5zOgotICogMCBpZiBHdUMgaXMgbm90IHByZXNlbnQgb3Ig
bm90IGluIHVzZS4KLSAqIE90aGVyd2lzZSwgdGhlIEd1QyBXT1BDTSBzaXplLgotICovCi1zdGF0
aWMgaW5saW5lIHUzMiBpbnRlbF93b3BjbV9ndWNfc2l6ZShzdHJ1Y3QgaW50ZWxfd29wY20gKndv
cGNtKQotewotCXJldHVybiB3b3BjbS0+Z3VjLnNpemU7Ci19Ci0KLXZvaWQgaW50ZWxfd29wY21f
aW5pdF9lYXJseShzdHJ1Y3QgaW50ZWxfd29wY20gKndvcGNtKTsKLXZvaWQgaW50ZWxfd29wY21f
aW5pdChzdHJ1Y3QgaW50ZWxfd29wY20gKndvcGNtKTsKLQotI2VuZGlmCi0tIAoyLjI0LjEKCl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBt
YWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3Rz
LmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeAo=

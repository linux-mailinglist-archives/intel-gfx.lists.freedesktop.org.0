Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 6888537FF5
	for <lists+intel-gfx@lfdr.de>; Thu,  6 Jun 2019 23:52:49 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 55A31899D5;
	Thu,  6 Jun 2019 21:52:47 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga07.intel.com (mga07.intel.com [134.134.136.100])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B6762899D4
 for <intel-gfx@lists.freedesktop.org>; Thu,  6 Jun 2019 21:52:46 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga002.jf.intel.com ([10.7.209.21])
 by orsmga105.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 06 Jun 2019 14:52:46 -0700
X-ExtLoop1: 1
Received: from dceraolo-linux.fm.intel.com ([10.1.27.145])
 by orsmga002.jf.intel.com with ESMTP; 06 Jun 2019 14:52:46 -0700
From: Daniele Ceraolo Spurio <daniele.ceraolospurio@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Thu,  6 Jun 2019 14:52:14 -0700
Message-Id: <20190606215218.34486-6-daniele.ceraolospurio@intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190606215218.34486-1-daniele.ceraolospurio@intel.com>
References: <20190606215218.34486-1-daniele.ceraolospurio@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [RFC 5/8] drm/i915: split out uncore_mmio_debug
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

TXVsdGlwbGUgdW5jb3JlIHN0cnVjdHVyZXMgd2lsbCBzaGFyZSB0aGUgZGVidWcgaW5mcmFzdHJ1
Y3R1cmUsIHNvCm1vdmUgaXQgdG8gYSBjb21tb24gcGxhY2UgYW5kIGFkZCBleHRyYSBsb2NraW5n
IGFyb3VuZCBpdC4KClNpZ25lZC1vZmYtYnk6IERhbmllbGUgQ2VyYW9sbyBTcHVyaW8gPGRhbmll
bGUuY2VyYW9sb3NwdXJpb0BpbnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kcnYuYyAgICAgfCAgMSArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oICAgICB8
ICAxICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3VuY29yZS5jIHwgNjYgKysrKysrKysr
KysrKysrKysrKystLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3VuY29yZS5o
IHwgMTAgKysrKy0KIDQgZmlsZXMgY2hhbmdlZCwgNTggaW5zZXJ0aW9ucygrKSwgMjAgZGVsZXRp
b25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKaW5kZXggOTA5NDczNmFmNWRhLi44ZmRkNjY4
ZWI3YzcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYwpAQCAtODk3LDYgKzg5Nyw3IEBAIHN0YXRp
YyBpbnQgaTkxNV9kcml2ZXJfaW5pdF9lYXJseShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCiAKIAlzcGluX2xvY2tfaW5pdCgmZGV2X3ByaXYtPmlycV9sb2NrKTsKIAlzcGluX2xv
Y2tfaW5pdCgmZGV2X3ByaXYtPmdwdV9lcnJvci5sb2NrKTsKKwlzcGluX2xvY2tfaW5pdCgmZGV2
X3ByaXYtPm1taW9fZGVidWcubG9jayk7CiAJbXV0ZXhfaW5pdCgmZGV2X3ByaXYtPmJhY2tsaWdo
dF9sb2NrKTsKIAogCW11dGV4X2luaXQoJmRldl9wcml2LT5zYl9sb2NrKTsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2Rydi5oCmluZGV4IGEwNTM5YjgzN2RmNS4uNTUyMjEzMmEyYWQyIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZHJ2LmgKQEAgLTEzOTgsNiArMTM5OCw3IEBAIHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
IHsKIAlyZXNvdXJjZV9zaXplX3Qgc3RvbGVuX3VzYWJsZV9zaXplOwkvKiBUb3RhbCBzaXplIG1p
bnVzIHJlc2VydmVkIHJhbmdlcyAqLwogCiAJc3RydWN0IGludGVsX3VuY29yZSB1bmNvcmU7CisJ
c3RydWN0IGludGVsX3VuY29yZV9tbWlvX2RlYnVnIG1taW9fZGVidWc7CiAKIAlzdHJ1Y3QgaTkx
NV92aXJ0dWFsX2dwdSB2Z3B1OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF91bmNvcmUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3VuY29yZS5jCmluZGV4
IDdlYmVhMDAyMDdhNi4uOGU0MjQ3NmVhNGE3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF91bmNvcmUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91bmNv
cmUuYwpAQCAtMzQsNiArMzQsMTMgQEAKIAogI2RlZmluZSBfX3Jhd19wb3N0aW5nX3JlYWQoLi4u
KSAoKHZvaWQpX19yYXdfdW5jb3JlX3JlYWQzMihfX1ZBX0FSR1NfXykpCiAKK3ZvaWQKK2ludGVs
X3VuY29yZV9tbWlvX2RlYnVnX2luaXRfZWFybHkoc3RydWN0IGludGVsX3VuY29yZV9tbWlvX2Rl
YnVnICptbWlvX2RlYnVnKQoreworCXNwaW5fbG9ja19pbml0KCZtbWlvX2RlYnVnLT5sb2NrKTsK
KwltbWlvX2RlYnVnLT51bmNsYWltZWRfbW1pb19jaGVjayA9IDE7Cit9CisKIHN0YXRpYyBjb25z
dCBjaGFyICogY29uc3QgZm9yY2V3YWtlX2RvbWFpbl9uYW1lc1tdID0gewogCSJyZW5kZXIiLAog
CSJibGl0dGVyIiwKQEAgLTQ3Myw2ICs0ODAsOCBAQCBjaGVja19mb3JfdW5jbGFpbWVkX21taW8o
c3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlKQogewogCWJvb2wgcmV0ID0gZmFsc2U7CiAKKwls
b2NrZGVwX2Fzc2VydF9oZWxkKCZ1bmNvcmUtPmRlYnVnLT5sb2NrKTsKKwogCWlmIChpbnRlbF91
bmNvcmVfaGFzX2ZwZ2FfZGJnX3VuY2xhaW1lZCh1bmNvcmUpKQogCQlyZXQgfD0gZnBnYV9jaGVj
a19mb3JfdW5jbGFpbWVkX21taW8odW5jb3JlKTsKIApAQCAtNDg5LDcgKzQ5OCw3IEBAIHN0YXRp
YyB2b2lkIF9faW50ZWxfdW5jb3JlX2Vhcmx5X3Nhbml0aXplKHN0cnVjdCBpbnRlbF91bmNvcmUg
KnVuY29yZSwKIAkJCQkJICB1bnNpZ25lZCBpbnQgcmVzdG9yZV9mb3JjZXdha2UpCiB7CiAJLyog
Y2xlYXIgb3V0IHVuY2xhaW1lZCByZWcgZGV0ZWN0aW9uIGJpdCAqLwotCWlmIChjaGVja19mb3Jf
dW5jbGFpbWVkX21taW8odW5jb3JlKSkKKwlpZiAoaW50ZWxfdW5jb3JlX3VuY2xhaW1lZF9tbWlv
KHVuY29yZSkpCiAJCURSTV9ERUJVRygidW5jbGFpbWVkIG1taW8gZGV0ZWN0ZWQgb24gdW5jb3Jl
IGluaXQsIGNsZWFyaW5nXG4iKTsKIAogCS8qIFdhRGlzYWJsZVNoYWRvd1JlZ0ZvckNwZDpjaHYg
Ki8KQEAgLTU5NSwxOCArNjA0LDIwIEBAIHZvaWQgaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQo
c3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlLAogdm9pZCBpbnRlbF91bmNvcmVfZm9yY2V3YWtl
X3VzZXJfZ2V0KHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSkKIHsKIAlzcGluX2xvY2tfaXJx
KCZ1bmNvcmUtPmxvY2spOworCXNwaW5fbG9ja19pcnEoJnVuY29yZS0+ZGVidWctPmxvY2spOwog
CWlmICghdW5jb3JlLT51c2VyX2ZvcmNld2FrZS5jb3VudCsrKSB7CiAJCWludGVsX3VuY29yZV9m
b3JjZXdha2VfZ2V0X19sb2NrZWQodW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKIAogCQkvKiBTYXZl
IGFuZCBkaXNhYmxlIG1taW8gZGVidWdnaW5nIGZvciB0aGUgdXNlciBieXBhc3MgKi8KIAkJdW5j
b3JlLT51c2VyX2ZvcmNld2FrZS5zYXZlZF9tbWlvX2NoZWNrID0KLQkJCXVuY29yZS0+dW5jbGFp
bWVkX21taW9fY2hlY2s7CisJCQl1bmNvcmUtPmRlYnVnLT51bmNsYWltZWRfbW1pb19jaGVjazsK
IAkJdW5jb3JlLT51c2VyX2ZvcmNld2FrZS5zYXZlZF9tbWlvX2RlYnVnID0KIAkJCWk5MTVfbW9k
cGFyYW1zLm1taW9fZGVidWc7CiAKLQkJdW5jb3JlLT51bmNsYWltZWRfbW1pb19jaGVjayA9IDA7
CisJCXVuY29yZS0+ZGVidWctPnVuY2xhaW1lZF9tbWlvX2NoZWNrID0gMDsKIAkJaTkxNV9tb2Rw
YXJhbXMubW1pb19kZWJ1ZyA9IDA7CiAJfQorCXNwaW5fdW5sb2NrX2lycSgmdW5jb3JlLT5kZWJ1
Zy0+bG9jayk7CiAJc3Bpbl91bmxvY2tfaXJxKCZ1bmNvcmUtPmxvY2spOwogfQogCkBAIC02MjAs
MTggKzYzMSwyMCBAQCB2b2lkIGludGVsX3VuY29yZV9mb3JjZXdha2VfdXNlcl9nZXQoc3RydWN0
IGludGVsX3VuY29yZSAqdW5jb3JlKQogdm9pZCBpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3VzZXJf
cHV0KHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSkKIHsKIAlzcGluX2xvY2tfaXJxKCZ1bmNv
cmUtPmxvY2spOworCXNwaW5fbG9ja19pcnEoJnVuY29yZS0+ZGVidWctPmxvY2spOwogCWlmICgh
LS11bmNvcmUtPnVzZXJfZm9yY2V3YWtlLmNvdW50KSB7Ci0JCWlmIChpbnRlbF91bmNvcmVfdW5j
bGFpbWVkX21taW8odW5jb3JlKSkKKwkJaWYgKGNoZWNrX2Zvcl91bmNsYWltZWRfbW1pbyh1bmNv
cmUpKQogCQkJZGV2X2luZm8odW5jb3JlX3RvX2k5MTUodW5jb3JlKS0+ZHJtLmRldiwKIAkJCQkg
IkludmFsaWQgbW1pbyBkZXRlY3RlZCBkdXJpbmcgdXNlciBhY2Nlc3NcbiIpOwogCi0JCXVuY29y
ZS0+dW5jbGFpbWVkX21taW9fY2hlY2sgPQorCQl1bmNvcmUtPmRlYnVnLT51bmNsYWltZWRfbW1p
b19jaGVjayA9CiAJCQl1bmNvcmUtPnVzZXJfZm9yY2V3YWtlLnNhdmVkX21taW9fY2hlY2s7CiAJ
CWk5MTVfbW9kcGFyYW1zLm1taW9fZGVidWcgPQogCQkJdW5jb3JlLT51c2VyX2ZvcmNld2FrZS5z
YXZlZF9tbWlvX2RlYnVnOwogCiAJCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0X19sb2NrZWQo
dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKIAl9CisJc3Bpbl91bmxvY2tfaXJxKCZ1bmNvcmUtPmRl
YnVnLT5sb2NrKTsKIAlzcGluX3VubG9ja19pcnEoJnVuY29yZS0+bG9jayk7CiB9CiAKQEAgLTEw
NDQsMTIgKzEwNTcsMTkgQEAgc3RhdGljIGlubGluZSB2b2lkCiB1bmNsYWltZWRfcmVnX2RlYnVn
KHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSwKIAkJICAgIGNvbnN0IGk5MTVfcmVnX3QgcmVn
LAogCQkgICAgY29uc3QgYm9vbCByZWFkLAotCQkgICAgY29uc3QgYm9vbCBiZWZvcmUpCisJCSAg
ICBjb25zdCBib29sIGJlZm9yZSwKKwkJICAgIHVuc2lnbmVkIGxvbmcgKmlycWZsYWdzKQogewog
CWlmIChsaWtlbHkoIWk5MTVfbW9kcGFyYW1zLm1taW9fZGVidWcpKQogCQlyZXR1cm47CiAKKwlp
ZiAoYmVmb3JlKQorCQlzcGluX2xvY2tfaXJxc2F2ZSgmdW5jb3JlLT5kZWJ1Zy0+bG9jaywgKmly
cWZsYWdzKTsKKwogCV9fdW5jbGFpbWVkX3JlZ19kZWJ1Zyh1bmNvcmUsIHJlZywgcmVhZCwgYmVm
b3JlKTsKKworCWlmICghYmVmb3JlKQorCQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZ1bmNvcmUt
PmRlYnVnLT5sb2NrLCAqaXJxZmxhZ3MpOwogfQogCiAjZGVmaW5lIEdFTjJfUkVBRF9IRUFERVIo
eCkgXApAQCAtMTA5NSwxMyArMTExNSwxNCBAQCBfX2dlbjJfcmVhZCg2NCkKICNkZWZpbmUgR0VO
Nl9SRUFEX0hFQURFUih4KSBcCiAJdTMyIG9mZnNldCA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KHJl
Zyk7IFwKIAl1bnNpZ25lZCBsb25nIGlycWZsYWdzOyBcCisJdW5zaWduZWQgbG9uZyBkZWJ1Z19p
cnFmbGFnczsgXAogCXUjI3ggdmFsID0gMDsgXAogCV9fYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxk
KHVuY29yZS0+cnBtKTsgXAogCXNwaW5fbG9ja19pcnFzYXZlKCZ1bmNvcmUtPmxvY2ssIGlycWZs
YWdzKTsgXAotCXVuY2xhaW1lZF9yZWdfZGVidWcodW5jb3JlLCByZWcsIHRydWUsIHRydWUpCisJ
dW5jbGFpbWVkX3JlZ19kZWJ1Zyh1bmNvcmUsIHJlZywgdHJ1ZSwgdHJ1ZSwgJmRlYnVnX2lycWZs
YWdzKQogCiAjZGVmaW5lIEdFTjZfUkVBRF9GT09URVIgXAotCXVuY2xhaW1lZF9yZWdfZGVidWco
dW5jb3JlLCByZWcsIHRydWUsIGZhbHNlKTsgXAorCXVuY2xhaW1lZF9yZWdfZGVidWcodW5jb3Jl
LCByZWcsIHRydWUsIGZhbHNlLCAmZGVidWdfaXJxZmxhZ3MpOyBcCiAJc3Bpbl91bmxvY2tfaXJx
cmVzdG9yZSgmdW5jb3JlLT5sb2NrLCBpcnFmbGFncyk7IFwKIAl0cmFjZV9pOTE1X3JlZ19ydyhm
YWxzZSwgcmVnLCB2YWwsIHNpemVvZih2YWwpLCB0cmFjZSk7IFwKIAlyZXR1cm4gdmFsCkBAIC0x
MjA0LDEzICsxMjI1LDE0IEBAIF9fZ2VuMl93cml0ZSgzMikKICNkZWZpbmUgR0VONl9XUklURV9I
RUFERVIgXAogCXUzMiBvZmZzZXQgPSBpOTE1X21taW9fcmVnX29mZnNldChyZWcpOyBcCiAJdW5z
aWduZWQgbG9uZyBpcnFmbGFnczsgXAorCXVuc2lnbmVkIGxvbmcgZGVidWdfaXJxZmxhZ3M7IFwK
IAl0cmFjZV9pOTE1X3JlZ19ydyh0cnVlLCByZWcsIHZhbCwgc2l6ZW9mKHZhbCksIHRyYWNlKTsg
XAogCV9fYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKHVuY29yZS0+cnBtKTsgXAogCXNwaW5fbG9j
a19pcnFzYXZlKCZ1bmNvcmUtPmxvY2ssIGlycWZsYWdzKTsgXAotCXVuY2xhaW1lZF9yZWdfZGVi
dWcodW5jb3JlLCByZWcsIGZhbHNlLCB0cnVlKQorCXVuY2xhaW1lZF9yZWdfZGVidWcodW5jb3Jl
LCByZWcsIGZhbHNlLCB0cnVlLCAmZGVidWdfaXJxZmxhZ3MpCiAKICNkZWZpbmUgR0VONl9XUklU
RV9GT09URVIgXAotCXVuY2xhaW1lZF9yZWdfZGVidWcodW5jb3JlLCByZWcsIGZhbHNlLCBmYWxz
ZSk7IFwKKwl1bmNsYWltZWRfcmVnX2RlYnVnKHVuY29yZSwgcmVnLCBmYWxzZSwgZmFsc2UsICZk
ZWJ1Z19pcnFmbGFncyk7IFwKIAlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZ1bmNvcmUtPmxvY2ss
IGlycWZsYWdzKQogCiAjZGVmaW5lIF9fZ2VuNl93cml0ZSh4KSBcCkBAIC0xNTc0LDYgKzE1OTYs
OSBAQCBpbnQgaW50ZWxfdW5jb3JlX2luaXRfbW1pbyhzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNv
cmUpCiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB1bmNvcmVfdG9faTkxNSh1bmNv
cmUpOwogCWludCByZXQ7CiAKKwl1bmNvcmUtPnJwbSA9ICZpOTE1LT5ydW50aW1lX3BtOworCXVu
Y29yZS0+ZGVidWcgPSAmaTkxNS0+bW1pb19kZWJ1ZzsKKwogCXJldCA9IHVuY29yZV9tbWlvX3Nl
dHVwKHVuY29yZSk7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKQEAgLTE1OTEsMTIgKzE2MTYs
OSBAQCBpbnQgaW50ZWxfdW5jb3JlX2luaXRfbW1pbyhzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNv
cmUpCiAKIAlfX2ludGVsX3VuY29yZV9lYXJseV9zYW5pdGl6ZSh1bmNvcmUsIDApOwogCi0JdW5j
b3JlLT51bmNsYWltZWRfbW1pb19jaGVjayA9IDE7CiAJdW5jb3JlLT5wbWljX2J1c19hY2Nlc3Nf
bmIubm90aWZpZXJfY2FsbCA9CiAJCWk5MTVfcG1pY19idXNfYWNjZXNzX25vdGlmaWVyOwogCi0J
dW5jb3JlLT5ycG0gPSAmaTkxNS0+cnVudGltZV9wbTsKLQogCWlmICghaW50ZWxfdW5jb3JlX2hh
c19mb3JjZXdha2UodW5jb3JlKSkgewogCQlpZiAoSVNfR0VOKGk5MTUsIDUpKSB7CiAJCQlBU1NJ
R05fV1JJVEVfTU1JT19WRlVOQ1NfTk9fRlcodW5jb3JlLCBnZW41KTsKQEAgLTE4NTgsNyArMTg4
MCwxMyBAQCBpbnQgX19pbnRlbF93YWl0X2Zvcl9yZWdpc3RlcihzdHJ1Y3QgaW50ZWxfdW5jb3Jl
ICp1bmNvcmUsCiAKIGJvb2wgaW50ZWxfdW5jb3JlX3VuY2xhaW1lZF9tbWlvKHN0cnVjdCBpbnRl
bF91bmNvcmUgKnVuY29yZSkKIHsKLQlyZXR1cm4gY2hlY2tfZm9yX3VuY2xhaW1lZF9tbWlvKHVu
Y29yZSk7CisJYm9vbCByZXQ7CisKKwlzcGluX2xvY2tfaXJxKCZ1bmNvcmUtPmRlYnVnLT5sb2Nr
KTsKKwlyZXQgPSBjaGVja19mb3JfdW5jbGFpbWVkX21taW8odW5jb3JlKTsKKwlzcGluX3VubG9j
a19pcnEoJnVuY29yZS0+ZGVidWctPmxvY2spOworCisJcmV0dXJuIHJldDsKIH0KIAogYm9vbApA
QCAtMTg2NiwyNCArMTg5NCwyNCBAQCBpbnRlbF91bmNvcmVfYXJtX3VuY2xhaW1lZF9tbWlvX2Rl
dGVjdGlvbihzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUpCiB7CiAJYm9vbCByZXQgPSBmYWxz
ZTsKIAotCXNwaW5fbG9ja19pcnEoJnVuY29yZS0+bG9jayk7CisJc3Bpbl9sb2NrX2lycSgmdW5j
b3JlLT5kZWJ1Zy0+bG9jayk7CiAKLQlpZiAodW5saWtlbHkodW5jb3JlLT51bmNsYWltZWRfbW1p
b19jaGVjayA8PSAwKSkKKwlpZiAodW5saWtlbHkodW5jb3JlLT5kZWJ1Zy0+dW5jbGFpbWVkX21t
aW9fY2hlY2sgPD0gMCkpCiAJCWdvdG8gb3V0OwogCi0JaWYgKHVubGlrZWx5KGludGVsX3VuY29y
ZV91bmNsYWltZWRfbW1pbyh1bmNvcmUpKSkgeworCWlmICh1bmxpa2VseShjaGVja19mb3JfdW5j
bGFpbWVkX21taW8odW5jb3JlKSkpIHsKIAkJaWYgKCFpOTE1X21vZHBhcmFtcy5tbWlvX2RlYnVn
KSB7CiAJCQlEUk1fREVCVUcoIlVuY2xhaW1lZCByZWdpc3RlciBkZXRlY3RlZCwgIgogCQkJCSAg
ImVuYWJsaW5nIG9uZXNob3QgdW5jbGFpbWVkIHJlZ2lzdGVyIHJlcG9ydGluZy4gIgogCQkJCSAg
IlBsZWFzZSB1c2UgaTkxNS5tbWlvX2RlYnVnPU4gZm9yIG1vcmUgaW5mb3JtYXRpb24uXG4iKTsK
IAkJCWk5MTVfbW9kcGFyYW1zLm1taW9fZGVidWcrKzsKIAkJfQotCQl1bmNvcmUtPnVuY2xhaW1l
ZF9tbWlvX2NoZWNrLS07CisJCXVuY29yZS0+ZGVidWctPnVuY2xhaW1lZF9tbWlvX2NoZWNrLS07
CiAJCXJldCA9IHRydWU7CiAJfQogCiBvdXQ6Ci0Jc3Bpbl91bmxvY2tfaXJxKCZ1bmNvcmUtPmxv
Y2spOworCXNwaW5fdW5sb2NrX2lycSgmdW5jb3JlLT5kZWJ1Zy0+bG9jayk7CiAKIAlyZXR1cm4g
cmV0OwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdW5jb3JlLmgg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91bmNvcmUuaAppbmRleCBiMmRlNDdkYTA1M2Yu
LjUzYzFhMzM0ZTJhZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdW5j
b3JlLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdW5jb3JlLmgKQEAgLTM2LDYg
KzM2LDExIEBAIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlOwogc3RydWN0IGk5MTVfcnVudGltZV9w
bTsKIHN0cnVjdCBpbnRlbF91bmNvcmU7CiAKK3N0cnVjdCBpbnRlbF91bmNvcmVfbW1pb19kZWJ1
ZyB7CisJc3BpbmxvY2tfdCBsb2NrOyAvKiogbG9jayBpcyBhbHNvIHRha2VuIGluIGlycSBjb250
ZXh0cy4gKi8KKwlpbnQgdW5jbGFpbWVkX21taW9fY2hlY2s7Cit9OworCiBlbnVtIGZvcmNld2Fr
ZV9kb21haW5faWQgewogCUZXX0RPTUFJTl9JRF9SRU5ERVIgPSAwLAogCUZXX0RPTUFJTl9JRF9C
TElUVEVSLApAQCAtMTQyLDcgKzE0Nyw3IEBAIHN0cnVjdCBpbnRlbF91bmNvcmUgewogCQlpbnQg
c2F2ZWRfbW1pb19kZWJ1ZzsKIAl9IHVzZXJfZm9yY2V3YWtlOwogCi0JaW50IHVuY2xhaW1lZF9t
bWlvX2NoZWNrOworCXN0cnVjdCBpbnRlbF91bmNvcmVfbW1pb19kZWJ1ZyAqZGVidWc7CiB9Owog
CiAvKiBJdGVyYXRlIG92ZXIgaW5pdGlhbGlzZWQgZncgZG9tYWlucyAqLwpAQCAtMTc3LDYgKzE4
Miw5IEBAIGludGVsX3VuY29yZV9oYXNfZmlmbyhjb25zdCBzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1
bmNvcmUpCiAJcmV0dXJuIHVuY29yZS0+ZmxhZ3MgJiBVTkNPUkVfSEFTX0ZJRk87CiB9CiAKK3Zv
aWQKK2ludGVsX3VuY29yZV9tbWlvX2RlYnVnX2luaXRfZWFybHkoc3RydWN0IGludGVsX3VuY29y
ZV9tbWlvX2RlYnVnICptbWlvX2RlYnVnKTsKKwogdm9pZCBpbnRlbF91bmNvcmVfaW5pdF9lYXJs
eShzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUpOwogaW50IGludGVsX3VuY29yZV9pbml0X21t
aW8oc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlKTsKIHZvaWQgaW50ZWxfdW5jb3JlX2Z3X2Rv
bWFpbl9wcnVuZShzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUsCi0tIAoyLjIwLjEKCl9fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWls
aW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZy
ZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

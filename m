Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 2B3159B988
	for <lists+intel-gfx@lfdr.de>; Sat, 24 Aug 2019 02:21:01 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 510586ED70;
	Sat, 24 Aug 2019 00:20:59 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga05.intel.com (mga05.intel.com [192.55.52.43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 3E6BA6ED70
 for <intel-gfx@lists.freedesktop.org>; Sat, 24 Aug 2019 00:20:57 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga008.fm.intel.com ([10.253.24.58])
 by fmsmga105.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 23 Aug 2019 17:20:56 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,422,1559545200"; d="scan'208";a="179309186"
Received: from dceraolo-linux.fm.intel.com ([10.1.27.145])
 by fmsmga008.fm.intel.com with ESMTP; 23 Aug 2019 17:20:56 -0700
From: Daniele Ceraolo Spurio <daniele.ceraolospurio@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 23 Aug 2019 17:20:22 -0700
Message-Id: <20190824002022.27636-1-daniele.ceraolospurio@intel.com>
X-Mailer: git-send-email 2.23.0
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915: use a separate context for gpu relocs
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VGhlIENTIHByZS1wYXJzZXIgY2FuIHByZS1mZXRjaCBjb21tYW5kcyBhY3Jvc3MgbWVtb3J5IHN5
bmMgcG9pbnRzIGFuZApzdGFydGluZyBmcm9tIGdlbjEyIGl0IGlzIGFibGUgdG8gcHJlLWZldGNo
IGFjcm9zcyBCQl9TVEFSVCBhbmQgQkJfRU5ECmJvdW5kYXJpZXMgYXMgd2VsbCwgc28gd2hlbiB3
ZSBlbWl0IGdwdSByZWxvY3MgdGhlIHByZS1wYXJzZXIgbWlnaHQKZmV0Y2ggdGhlIHRhcmdldCBs
b2NhdGlvbiBvZiB0aGUgcmVsb2MgYmVmb3JlIHRoZSBtZW1vcnkgd3JpdGUgbGFuZHMuCgpUaGUg
cGFyc2VyIGNhbid0IHByZS1mZXRjaCBhY3Jvc3MgdGhlIGN0eCBzd2l0Y2gsIHNvIHdlIHVzZSBh
IHNlcGFyYXRlCmNvbnRleHQgdG8gZ3VhcmFudGVlIHRoYXQgdGhlIG1lbW9yeSBpcyBzeW5jcm9u
aXplZCBiZWZvcmUgdGhlIHBhcnNlcgpjYW4gZ2V0IHRvIGl0LgoKU3VnZ2VzdGVkLWJ5OiBDaHJp
cyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KU2lnbmVkLW9mZi1ieTogRGFuaWVs
ZSBDZXJhb2xvIFNwdXJpbyA8ZGFuaWVsZS5jZXJhb2xvc3B1cmlvQGludGVsLmNvbT4KQ2M6IENo
cmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgotLS0KIC4uLi9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYyAgICB8IDI3ICsrKysrKysrKysrKysrKysrKy0K
IDEgZmlsZSBjaGFuZ2VkLCAyNiBpbnNlcnRpb25zKCspLCAxIGRlbGV0aW9uKC0pCgpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKaW5kZXggYjVmNjkz
NzM2OWVhLi5kMjcyMDFjNjU0ZTkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5
MTVfZ2VtX2V4ZWNidWZmZXIuYwpAQCAtMjUyLDYgKzI1Miw3IEBAIHN0cnVjdCBpOTE1X2V4ZWNi
dWZmZXIgewogCQlib29sIGhhc19mZW5jZSA6IDE7CiAJCWJvb2wgbmVlZHNfdW5mZW5jZWQgOiAx
OwogCisJCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsKIAkJc3RydWN0IGk5MTVfcmVxdWVzdCAq
cnE7CiAJCXUzMiAqcnFfY21kOwogCQl1bnNpZ25lZCBpbnQgcnFfc2l6ZTsKQEAgLTkwMyw2ICs5
MDQsNyBAQCBzdGF0aWMgdm9pZCByZWxvY19jYWNoZV9pbml0KHN0cnVjdCByZWxvY19jYWNoZSAq
Y2FjaGUsCiAJY2FjaGUtPmhhc19mZW5jZSA9IGNhY2hlLT5nZW4gPCA0OwogCWNhY2hlLT5uZWVk
c191bmZlbmNlZCA9IElOVEVMX0lORk8oaTkxNSktPnVuZmVuY2VkX25lZWRzX2FsaWdubWVudDsK
IAljYWNoZS0+bm9kZS5hbGxvY2F0ZWQgPSBmYWxzZTsKKwljYWNoZS0+Y2UgPSBOVUxMOwogCWNh
Y2hlLT5ycSA9IE5VTEw7CiAJY2FjaGUtPnJxX3NpemUgPSAwOwogfQpAQCAtOTQzLDYgKzk0NSw3
IEBAIHN0YXRpYyB2b2lkIHJlbG9jX2dwdV9mbHVzaChzdHJ1Y3QgcmVsb2NfY2FjaGUgKmNhY2hl
KQogc3RhdGljIHZvaWQgcmVsb2NfY2FjaGVfcmVzZXQoc3RydWN0IHJlbG9jX2NhY2hlICpjYWNo
ZSkKIHsKIAl2b2lkICp2YWRkcjsKKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7CiAKIAlpZiAo
Y2FjaGUtPnJxKQogCQlyZWxvY19ncHVfZmx1c2goY2FjaGUpOwpAQCAtOTczLDYgKzk3NiwxMCBA
QCBzdGF0aWMgdm9pZCByZWxvY19jYWNoZV9yZXNldChzdHJ1Y3QgcmVsb2NfY2FjaGUgKmNhY2hl
KQogCQl9CiAJfQogCisJY2UgPSBmZXRjaF9hbmRfemVybygmY2FjaGUtPmNlKTsKKwlpZiAoY2Up
CisJCWludGVsX2NvbnRleHRfcHV0KGNlKTsKKwogCWNhY2hlLT52YWRkciA9IDA7CiAJY2FjaGUt
PnBhZ2UgPSAtMTsKIH0KQEAgLTExNjgsNyArMTE3NSw3IEBAIHN0YXRpYyBpbnQgX19yZWxvY19n
cHVfYWxsb2Moc3RydWN0IGk5MTVfZXhlY2J1ZmZlciAqZWIsCiAJaWYgKGVycikKIAkJZ290byBl
cnJfdW5tYXA7CiAKLQlycSA9IGk5MTVfcmVxdWVzdF9jcmVhdGUoZWItPmNvbnRleHQpOworCXJx
ID0gaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVzdChjYWNoZS0+Y2UpOwogCWlmIChJU19FUlIo
cnEpKSB7CiAJCWVyciA9IFBUUl9FUlIocnEpOwogCQlnb3RvIGVycl91bnBpbjsKQEAgLTEyMzks
NiArMTI0NiwyNCBAQCBzdGF0aWMgdTMyICpyZWxvY19ncHUoc3RydWN0IGk5MTVfZXhlY2J1ZmZl
ciAqZWIsCiAJCWlmICghaW50ZWxfZW5naW5lX2Nhbl9zdG9yZV9kd29yZChlYi0+ZW5naW5lKSkK
IAkJCXJldHVybiBFUlJfUFRSKC1FTk9ERVYpOwogCisJCS8qCisJCSAqIFRoZSBDUyBwcmUtcGFy
c2VyIGNhbiBwcmUtZmV0Y2ggY29tbWFuZHMgYWNyb3NzIG1lbW9yeSBzeW5jCisJCSAqIHBvaW50
cyBhbmQgc3RhcnRpbmcgZ2VuMTIgaXQgaXMgYWJsZSB0byBwcmUtZmV0Y2ggYWNyb3NzCisJCSAq
IEJCX1NUQVJUIGFuZCBCQl9FTkQgYm91bmRhcmllcyAod2l0aGluIHRoZSBzYW1lIGNvbnRleHQp
LiBXZQorCQkgKiB1c2UgYSBzZXBhcmF0ZSBjb250ZXh0IHRvIGd1YXJhbnRlZSB0aGF0IHRoZSBy
ZWxvYyB3cml0ZXMKKwkJICogbGFuZCBiZWZvcmUgdGhlIHBhcnNlciBnZXRzIHRvIHRoZSB0YXJn
ZXQgbWVtb3J5IGxvY2F0aW9uLgorCQkgKi8KKwkJaWYgKCFjYWNoZS0+Y2UpIHsKKwkJCXN0cnVj
dCBpbnRlbF9jb250ZXh0ICpjZTsKKworCQkJY2UgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZShlYi0+
Y29udGV4dC0+Z2VtX2NvbnRleHQsCisJCQkJCQkgIGViLT5lbmdpbmUpOworCQkJaWYgKElTX0VS
UihjZSkpCisJCQkJcmV0dXJuIEVSUl9DQVNUKGNlKTsKKworCQkJY2FjaGUtPmNlID0gY2U7IC8q
IHJlbGVhc2VkIGluIHJlbG9jX2NhY2hlX3Jlc2V0ICovCisJCX0KKwogCQllcnIgPSBfX3JlbG9j
X2dwdV9hbGxvYyhlYiwgdm1hLCBsZW4pOwogCQlpZiAodW5saWtlbHkoZXJyKSkKIAkJCXJldHVy
biBFUlJfUFRSKGVycik7Ci0tIAoyLjIzLjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3Rz
LmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xp
c3RpbmZvL2ludGVsLWdmeA==

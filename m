Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id D194822D86
	for <lists+intel-gfx@lfdr.de>; Mon, 20 May 2019 10:02:18 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 44312891F4;
	Mon, 20 May 2019 08:02:15 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 62A6F89221
 for <intel-gfx@lists.freedesktop.org>; Mon, 20 May 2019 08:02:04 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16610882-1500050 
 for multiple; Mon, 20 May 2019 09:01:36 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Mon, 20 May 2019 09:01:21 +0100
Message-Id: <20190520080127.18255-27-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190520080127.18255-1-chris@chris-wilson.co.uk>
References: <20190520080127.18255-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 27/33] drm/i915: Keep contexts pinned until
 after the next kernel context switch
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

V2UgbmVlZCB0byBrZWVwIHRoZSBjb250ZXh0IGltYWdlIHBpbm5lZCBpbiBtZW1vcnkgdW50aWwg
YWZ0ZXIgdGhlIEdQVQpoYXMgZmluaXNoZWQgd3JpdGluZyBpbnRvIGl0LiBTaW5jZSBpdCBjb250
aW51ZXMgdG8gd3JpdGUgYXMgd2Ugc2lnbmFsCnRoZSBmaW5hbCBicmVhZGNydW1iLCB3ZSBuZWVk
IHRvIGtlZXAgaXQgcGlubmVkIHVudGlsIHRoZSByZXF1ZXN0IGFmdGVyCml0IGlzIGNvbXBsZXRl
LiBDdXJyZW50bHkgd2Uga25vdyB0aGUgb3JkZXIgaW4gd2hpY2ggcmVxdWVzdHMgZXhlY3V0ZSBv
bgplYWNoIGVuZ2luZSwgYW5kIHNvIHRvIHJlbW92ZSB0aGF0IHByZXN1bXB0aW9uIHdlIG5lZWQg
dG8gaWRlbnRpZnkgYQpyZXF1ZXN0L2NvbnRleHQtc3dpdGNoIHdlIGtub3cgbXVzdCBvY2N1ciBh
ZnRlciBvdXIgY29tcGxldGlvbi4gQW55CnJlcXVlc3QgcXVldWVkIGFmdGVyIHRoZSBzaWduYWwg
bXVzdCBpbXBseSBhIGNvbnRleHQgc3dpdGNoLCBmb3IKc2ltcGxpY2l0eSB3ZSB1c2UgYSBmcmVz
aCByZXF1ZXN0IGZyb20gdGhlIGtlcm5lbCBjb250ZXh0LgoKU2lnbmVkLW9mZi1ieTogQ2hyaXMg
V2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYyAgIHwgMjQgKystLS0tCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5oICAgfCAgMSAtCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fcG0uYyAgICAgICAgfCAyMCArKysrLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfY29udGV4dC5jICAgICAgIHwgODAgKysrKysrKysrKysrKysrLS0tCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmggICAgICAgfCAgMyArCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0X3R5cGVzLmggfCAgNiArLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lLmggICAgICAgIHwgIDIgLQogZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMgICAgIHwgMjMgKy0tLS0tCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uYyAgICAgfCAgMiArCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaCAgfCAxMyArLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2xyYy5jICAgICAgICAgICB8IDYyICsrLS0tLS0tLS0tLS0tCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMgICAgfCA0NCArLS0tLS0tLS0t
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9tb2NrX2VuZ2luZS5jICAgICAgICAgfCAxMSArLS0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMgICAgICAgICAgICB8IDgxICsrKysr
KysrKysrKysrKysrKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmggICAgICAg
ICAgICB8ICA1ICsrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZV90eXBlcy5oICAg
ICAgfCAgMyArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jICAgICAgICAgICAgICAg
fCAgNCAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYyAgICAgICAgICAgfCAx
NSAtLS0tCiAuLi4vZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2dlbV9kZXZpY2UuYyAgfCAg
MSAtCiAxOSBmaWxlcyBjaGFuZ2VkLCAyMTUgaW5zZXJ0aW9ucygrKSwgMTg1IGRlbGV0aW9ucygt
KQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCmluZGV4IGE5
NjA4ZDljZWQ2YS4uYWEyYmQxZDZjZWI2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9jb250ZXh0LmMKQEAgLTY4OCwxNyArNjg4LDYgQEAgaW50IGk5MTVfZ2VtX2NvbnRl
eHRzX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCXJldHVybiAwOwog
fQogCi12b2lkIGk5MTVfZ2VtX2NvbnRleHRzX2xvc3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQotewotCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKLQllbnVtIGlu
dGVsX2VuZ2luZV9pZCBpZDsKLQotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5kcm0u
c3RydWN0X211dGV4KTsKLQotCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGRldl9wcml2LCBpZCkK
LQkJaW50ZWxfZW5naW5lX2xvc3RfY29udGV4dChlbmdpbmUpOwotfQotCiB2b2lkIGk5MTVfZ2Vt
X2NvbnRleHRzX2Zpbmkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7CiAJbG9ja2Rl
cF9hc3NlcnRfaGVsZCgmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CkBAIC0xMTgzLDEwICsxMTcy
LDYgQEAgZ2VuOF9tb2RpZnlfcnBjcyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHN0cnVjdCBp
bnRlbF9zc2V1IHNzZXUpCiAJaWYgKHJldCkKIAkJZ290byBvdXRfYWRkOwogCi0JcmV0ID0gZ2Vu
OF9lbWl0X3JwY3NfY29uZmlnKHJxLCBjZSwgc3NldSk7Ci0JaWYgKHJldCkKLQkJZ290byBvdXRf
YWRkOwotCiAJLyoKIAkgKiBHdWFyYW50ZWUgY29udGV4dCBpbWFnZSBhbmQgdGhlIHRpbWVsaW5l
IHJlbWFpbnMgcGlubmVkIHVudGlsIHRoZQogCSAqIG1vZGlmeWluZyByZXF1ZXN0IGlzIHJldGly
ZWQgYnkgc2V0dGluZyB0aGUgY2UgYWN0aXZpdHkgdHJhY2tlci4KQEAgLTExOTQsOSArMTE3OSwx
MiBAQCBnZW44X21vZGlmeV9ycGNzKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgc3RydWN0IGlu
dGVsX3NzZXUgc3NldSkKIAkgKiBCdXQgd2Ugb25seSBuZWVkIHRvIHRha2Ugb25lIHBpbiBvbiB0
aGUgYWNjb3VudCBvZiBpdC4gT3IgaW4gb3RoZXIKIAkgKiB3b3JkcyB0cmFuc2ZlciB0aGUgcGlu
bmVkIGNlIG9iamVjdCB0byB0cmFja2VkIGFjdGl2ZSByZXF1ZXN0LgogCSAqLwotCWlmICghaTkx
NV9hY3RpdmVfcmVxdWVzdF9pc3NldCgmY2UtPmFjdGl2ZV90cmFja2VyKSkKLQkJX19pbnRlbF9j
b250ZXh0X3BpbihjZSk7Ci0JX19pOTE1X2FjdGl2ZV9yZXF1ZXN0X3NldCgmY2UtPmFjdGl2ZV90
cmFja2VyLCBycSk7CisJR0VNX0JVR19PTihpOTE1X2FjdGl2ZV9pc19pZGxlKCZjZS0+YWN0aXZl
KSk7CisJcmV0ID0gaTkxNV9hY3RpdmVfcmVmKCZjZS0+YWN0aXZlLCBycS0+ZmVuY2UuY29udGV4
dCwgcnEpOworCWlmIChyZXQpCisJCWdvdG8gb3V0X2FkZDsKKworCXJldCA9IGdlbjhfZW1pdF9y
cGNzX2NvbmZpZyhycSwgY2UsIHNzZXUpOwogCiBvdXRfYWRkOgogCWk5MTVfcmVxdWVzdF9hZGQo
cnEpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRl
eHQuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmgKaW5kZXgg
NjMwMzkyYzc3ZTQ4Li45NjkxZGQwNjJmNzIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX2NvbnRleHQuaApAQCAtMTM0LDcgKzEzNCw2IEBAIHN0YXRpYyBpbmxpbmUgYm9v
bCBpOTE1X2dlbV9jb250ZXh0X2lzX2tlcm5lbChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4
KQogCiAvKiBpOTE1X2dlbV9jb250ZXh0LmMgKi8KIGludCBfX211c3RfY2hlY2sgaTkxNV9nZW1f
Y29udGV4dHNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwotdm9pZCBp
OTE1X2dlbV9jb250ZXh0c19sb3N0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7
CiB2b2lkIGk5MTVfZ2VtX2NvbnRleHRzX2Zpbmkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KTsKIAogaW50IGk5MTVfZ2VtX2NvbnRleHRfb3BlbihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKaW5kZXggMTEx
YjY4N2YxNGI1Li4xZjJmZWRkZDllMjAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9wbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9wbS5jCkBAIC0xMCw2ICsxMCwyMiBAQAogI2luY2x1ZGUgImk5MTVfZHJ2LmgiCiAjaW5jbHVk
ZSAiaTkxNV9nbG9iYWxzLmgiCiAKK3N0YXRpYyB2b2lkIGNhbGxfaWRsZV9iYXJyaWVycyhzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJc3RydWN0IGxsaXN0X25vZGUgKm5vZGUs
ICpuZXh0OworCisJbGxpc3RfZm9yX2VhY2hfc2FmZShub2RlLCBuZXh0LCBsbGlzdF9kZWxfYWxs
KCZlbmdpbmUtPmJhcnJpZXJfdGFza3MpKSB7CisJCXN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0
ICphY3RpdmUgPQorCQkJY29udGFpbmVyX29mKChzdHJ1Y3QgbGlzdF9oZWFkICopbm9kZSwKKwkJ
CQkgICAgIHR5cGVvZigqYWN0aXZlKSwgbGluayk7CisKKwkJSU5JVF9MSVNUX0hFQUQoJmFjdGl2
ZS0+bGluayk7CisJCVJDVV9JTklUX1BPSU5URVIoYWN0aXZlLT5yZXF1ZXN0LCBOVUxMKTsKKwor
CQlhY3RpdmUtPnJldGlyZShhY3RpdmUsIE5VTEwpOworCX0KK30KKwogc3RhdGljIHZvaWQgaTkx
NV9nZW1fcGFyayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIHsKIAlzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmU7CkBAIC0xNyw4ICszMywxMCBAQCBzdGF0aWMgdm9pZCBpOTE1
X2dlbV9wYXJrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCiAJbG9ja2RlcF9hc3Nl
cnRfaGVsZCgmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAKLQlmb3JfZWFjaF9lbmdpbmUoZW5n
aW5lLCBpOTE1LCBpZCkKKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgeworCQlj
YWxsX2lkbGVfYmFycmllcnMoZW5naW5lKTsgLyogY2xlYW51cCBhZnRlciB3ZWRnaW5nICovCiAJ
CWk5MTVfZ2VtX2JhdGNoX3Bvb2xfZmluaSgmZW5naW5lLT5iYXRjaF9wb29sKTsKKwl9CiAKIAlp
OTE1X3RpbWVsaW5lc19wYXJrKGk5MTUpOwogCWk5MTVfdm1hX3BhcmtlZChpOTE1KTsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYwppbmRleCBjNzhlYzBiNThlNzcuLmMxMGVi
NDkwNDI2NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4
dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYwpAQCAtNjEs
NyArNjEsNiBAQCBpbnQgX19pbnRlbF9jb250ZXh0X2RvX3BpbihzdHJ1Y3QgaW50ZWxfY29udGV4
dCAqY2UpCiAKIAkJaTkxNV9nZW1fY29udGV4dF9nZXQoY2UtPmdlbV9jb250ZXh0KTsgLyogZm9y
IGN0eC0+cHBndHQgKi8KIAotCQlpbnRlbF9jb250ZXh0X2dldChjZSk7CiAJCXNtcF9tYl9fYmVm
b3JlX2F0b21pYygpOyAvKiBmbHVzaCBwaW4gYmVmb3JlIGl0IGlzIHZpc2libGUgKi8KIAl9CiAK
QEAgLTg5LDIwICs4OCw0NSBAQCB2b2lkIGludGVsX2NvbnRleHRfdW5waW4oc3RydWN0IGludGVs
X2NvbnRleHQgKmNlKQogCQljZS0+b3BzLT51bnBpbihjZSk7CiAKIAkJaTkxNV9nZW1fY29udGV4
dF9wdXQoY2UtPmdlbV9jb250ZXh0KTsKLQkJaW50ZWxfY29udGV4dF9wdXQoY2UpOworCQlpbnRl
bF9jb250ZXh0X2luYWN0aXZlKGNlKTsKIAl9CiAKIAltdXRleF91bmxvY2soJmNlLT5waW5fbXV0
ZXgpOwogCWludGVsX2NvbnRleHRfcHV0KGNlKTsKIH0KIAotc3RhdGljIHZvaWQgaW50ZWxfY29u
dGV4dF9yZXRpcmUoc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2ZSwKLQkJCQkgc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnEpCitzdGF0aWMgaW50IF9fY29udGV4dF9waW5fc3RhdGUoc3Ry
dWN0IGk5MTVfdm1hICp2bWEsIHVuc2lnbmVkIGxvbmcgZmxhZ3MpCiB7Ci0Jc3RydWN0IGludGVs
X2NvbnRleHQgKmNlID0KLQkJY29udGFpbmVyX29mKGFjdGl2ZSwgdHlwZW9mKCpjZSksIGFjdGl2
ZV90cmFja2VyKTsKKwlpbnQgZXJyOwogCi0JaW50ZWxfY29udGV4dF91bnBpbihjZSk7CisJZXJy
ID0gaTkxNV92bWFfcGluKHZtYSwgMCwgMCwgZmxhZ3MgfCBQSU5fR0xPQkFMKTsKKwlpZiAoZXJy
KQorCQlyZXR1cm4gZXJyOworCisJLyoKKwkgKiBBbmQgbWFyayBpdCBhcyBhIGdsb2JhbGx5IHBp
bm5lZCBvYmplY3QgdG8gbGV0IHRoZSBzaHJpbmtlciBrbm93CisJICogaXQgY2Fubm90IHJlY2xh
aW0gdGhlIG9iamVjdCB1bnRpbCB3ZSByZWxlYXNlIGl0LgorCSAqLworCXZtYS0+b2JqLT5waW5f
Z2xvYmFsKys7CisJdm1hLT5vYmotPm1tLmRpcnR5ID0gdHJ1ZTsKKworCXJldHVybiAwOworfQor
CitzdGF0aWMgdm9pZCBfX2NvbnRleHRfdW5waW5fc3RhdGUoc3RydWN0IGk5MTVfdm1hICp2bWEp
Cit7CisJdm1hLT5vYmotPnBpbl9nbG9iYWwtLTsKKwlfX2k5MTVfdm1hX3VucGluKHZtYSk7Cit9
CisKK3N0YXRpYyB2b2lkIGludGVsX2NvbnRleHRfcmV0aXJlKHN0cnVjdCBpOTE1X2FjdGl2ZSAq
YWN0aXZlKQoreworCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSA9IGNvbnRhaW5lcl9vZihhY3Rp
dmUsIHR5cGVvZigqY2UpLCBhY3RpdmUpOworCisJaWYgKGNlLT5zdGF0ZSkKKwkJX19jb250ZXh0
X3VucGluX3N0YXRlKGNlLT5zdGF0ZSk7CisKKwlpbnRlbF9jb250ZXh0X3B1dChjZSk7CiB9CiAK
IHZvaWQKQEAgLTEyNSw4ICsxNDksNDYgQEAgaW50ZWxfY29udGV4dF9pbml0KHN0cnVjdCBpbnRl
bF9jb250ZXh0ICpjZSwKIAogCW11dGV4X2luaXQoJmNlLT5waW5fbXV0ZXgpOwogCi0JaTkxNV9h
Y3RpdmVfcmVxdWVzdF9pbml0KCZjZS0+YWN0aXZlX3RyYWNrZXIsCi0JCQkJIE5VTEwsIGludGVs
X2NvbnRleHRfcmV0aXJlKTsKKwlpOTE1X2FjdGl2ZV9pbml0KGN0eC0+aTkxNSwgJmNlLT5hY3Rp
dmUsIGludGVsX2NvbnRleHRfcmV0aXJlKTsKK30KKworaW50IGludGVsX2NvbnRleHRfYWN0aXZl
KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgdW5zaWduZWQgbG9uZyBmbGFncykKK3sKKwlpbnQg
ZXJyOworCisJaWYgKCFpOTE1X2FjdGl2ZV9hY3F1aXJlKCZjZS0+YWN0aXZlKSkKKwkJcmV0dXJu
IDA7CisKKwlpbnRlbF9jb250ZXh0X2dldChjZSk7CisKKwlpZiAoIWNlLT5zdGF0ZSkKKwkJcmV0
dXJuIDA7CisKKwllcnIgPSBfX2NvbnRleHRfcGluX3N0YXRlKGNlLT5zdGF0ZSwgZmxhZ3MpOwor
CWlmIChlcnIpIHsKKwkJaTkxNV9hY3RpdmVfY2FuY2VsKCZjZS0+YWN0aXZlKTsKKwkJaW50ZWxf
Y29udGV4dF9wdXQoY2UpOworCQlyZXR1cm4gZXJyOworCX0KKworCS8qIFByZWFsbG9jYXRlIHRy
YWNraW5nIG5vZGVzICovCisJaWYgKCFpOTE1X2dlbV9jb250ZXh0X2lzX2tlcm5lbChjZS0+Z2Vt
X2NvbnRleHQpKSB7CisJCWVyciA9IGk5MTVfYWN0aXZlX2FjcXVpcmVfcHJlYWxsb2NhdGVfYmFy
cmllcigmY2UtPmFjdGl2ZSwKKwkJCQkJCQkgICAgICBjZS0+ZW5naW5lKTsKKwkJaWYgKGVycikg
eworCQkJaTkxNV9hY3RpdmVfcmVsZWFzZSgmY2UtPmFjdGl2ZSk7CisJCQlyZXR1cm4gZXJyOwor
CQl9CisJfQorCisJcmV0dXJuIDA7Cit9CisKK3ZvaWQgaW50ZWxfY29udGV4dF9pbmFjdGl2ZShz
dHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCit7CisJLyogTm9kZXMgcHJlYWxsb2NhdGVkIGluIGlu
dGVsX2NvbnRleHRfYWN0aXZlKCkgKi8KKwlpOTE1X2FjdGl2ZV9hY3F1aXJlX2JhcnJpZXIoJmNl
LT5hY3RpdmUpOworCWk5MTVfYWN0aXZlX3JlbGVhc2UoJmNlLT5hY3RpdmUpOwogfQogCiBzdGF0
aWMgdm9pZCBpOTE1X2dsb2JhbF9jb250ZXh0X3Nocmluayh2b2lkKQpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfY29udGV4dC5oCmluZGV4IDYzMzkyYzg4Y2Q5OC4uZTcxNjI5ZjdjMmUwIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmgKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5oCkBAIC0xMDIsNiArMTAyLDkg
QEAgc3RhdGljIGlubGluZSB2b2lkIGludGVsX2NvbnRleHRfZXhpdChzdHJ1Y3QgaW50ZWxfY29u
dGV4dCAqY2UpCiAJCWNlLT5vcHMtPmV4aXQoY2UpOwogfQogCitpbnQgaW50ZWxfY29udGV4dF9h
Y3RpdmUoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCB1bnNpZ25lZCBsb25nIGZsYWdzKTsKK3Zv
aWQgaW50ZWxfY29udGV4dF9pbmFjdGl2ZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpOworCiBz
dGF0aWMgaW5saW5lIHN0cnVjdCBpbnRlbF9jb250ZXh0ICppbnRlbF9jb250ZXh0X2dldChzdHJ1
Y3QgaW50ZWxfY29udGV4dCAqY2UpCiB7CiAJa3JlZl9nZXQoJmNlLT5yZWYpOwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dF90eXBlcy5oIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dF90eXBlcy5oCmluZGV4IDgyNWZjZjBhYzlj
NC4uZTk1YmU0YmU5NjEyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9jb250ZXh0X3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29u
dGV4dF90eXBlcy5oCkBAIC01NiwxMCArNTYsMTAgQEAgc3RydWN0IGludGVsX2NvbnRleHQgewog
CWludGVsX2VuZ2luZV9tYXNrX3Qgc2F0dXJhdGVkOyAvKiBzdWJtaXR0aW5nIHNlbWFwaG9yZXMg
dG9vIGxhdGU/ICovCiAKIAkvKioKLQkgKiBhY3RpdmVfdHJhY2tlcjogQWN0aXZlIHRyYWNrZXIg
Zm9yIHRoZSBleHRlcm5hbCBycSBhY3Rpdml0eQotCSAqIG9uIHRoaXMgaW50ZWxfY29udGV4dCBv
YmplY3QuCisJICogYWN0aXZlOiBBY3RpdmUgdHJhY2tlciBmb3IgdGhlIHJxIGFjdGl2aXR5IChp
bmMuIGV4dGVybmFsKSBvbiB0aGlzCisJICogaW50ZWxfY29udGV4dCBvYmplY3QuCiAJICovCi0J
c3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgYWN0aXZlX3RyYWNrZXI7CisJc3RydWN0IGk5MTVf
YWN0aXZlIGFjdGl2ZTsKIAogCWNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0X29wcyAqb3BzOwog
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaCBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oCmluZGV4IDkzNTliM2E3YWQ5Yy4u
MWFlMjkzNGI3ZWNjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9l
bmdpbmUuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaApAQCAt
NDQ4LDggKzQ0OCw2IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9lbmdpbmVfcmVzZXQoc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAogYm9vbCBpbnRlbF9lbmdpbmVfaXNfaWRsZShz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpOwogYm9vbCBpbnRlbF9lbmdpbmVzX2FyZV9p
ZGxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiAKLXZvaWQgaW50ZWxfZW5n
aW5lX2xvc3RfY29udGV4dChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpOwotCiB2b2lk
IGludGVsX2VuZ2luZXNfcmVzZXRfZGVmYXVsdF9zdWJtaXNzaW9uKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KTsKIHVuc2lnbmVkIGludCBpbnRlbF9lbmdpbmVzX2hhc19jb250ZXh0X2lz
b2xhdGlvbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7CiAKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKaW5kZXggMWFmMmUwMGRjMzZiLi5hY2QzYmMzM2E5
OWMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jCkBAIC01NzEs
NiArNTcxLDggQEAgc3RhdGljIGludCBpbnRlbF9lbmdpbmVfc2V0dXBfY29tbW9uKHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsKIAlpbnQgZXJyOwogCisJaW5pdF9sbGlzdF9oZWFk
KCZlbmdpbmUtPmJhcnJpZXJfdGFza3MpOworCiAJZXJyID0gaW5pdF9zdGF0dXNfcGFnZShlbmdp
bmUpOwogCWlmIChlcnIpCiAJCXJldHVybiBlcnI7CkBAIC04MzAsNiArODMyLDcgQEAgdm9pZCBp
bnRlbF9lbmdpbmVfY2xlYW51cF9jb21tb24oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KQogCWlmIChlbmdpbmUtPnByZWVtcHRfY29udGV4dCkKIAkJaW50ZWxfY29udGV4dF91bnBpbihl
bmdpbmUtPnByZWVtcHRfY29udGV4dCk7CiAJaW50ZWxfY29udGV4dF91bnBpbihlbmdpbmUtPmtl
cm5lbF9jb250ZXh0KTsKKwlHRU1fQlVHX09OKCFsbGlzdF9lbXB0eSgmZW5naW5lLT5iYXJyaWVy
X3Rhc2tzKSk7CiAKIAlpOTE1X3RpbWVsaW5lX2ZpbmkoJmVuZ2luZS0+dGltZWxpbmUpOwogCkBA
IC0xMTYwLDI2ICsxMTYzLDYgQEAgdm9pZCBpbnRlbF9lbmdpbmVzX3Jlc2V0X2RlZmF1bHRfc3Vi
bWlzc2lvbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkJZW5naW5lLT5zZXRfZGVm
YXVsdF9zdWJtaXNzaW9uKGVuZ2luZSk7CiB9CiAKLS8qKgotICogaW50ZWxfZW5naW5lX2xvc3Rf
Y29udGV4dDogY2FsbGVkIHdoZW4gdGhlIEdQVSBpcyByZXNldCBpbnRvIHVua25vd24gc3RhdGUK
LSAqIEBlbmdpbmU6IHRoZSBlbmdpbmUKLSAqCi0gKiBXZSBoYXZlIGVpdGhlciByZXNldCB0aGUg
R1BVIG9yIG90aGVyd2lzZSBhYm91dCB0byBsb3NlIHN0YXRlIHRyYWNraW5nIG9mCi0gKiB0aGUg
Y3VycmVudCBHUFUgbG9naWNhbCBzdGF0ZSAoZS5nLiBzdXNwZW5kKS4gT24gbmV4dCB1c2UsIGl0
IGlzIHRoZXJlZm9yZQotICogaW1wZXJhdGl2ZSB0aGF0IHdlIG1ha2Ugbm8gcHJlc3VtcHRpb25z
IGFib3V0IHRoZSBjdXJyZW50IHN0YXRlIGFuZCBsb2FkCi0gKiBmcm9tIHNjcmF0Y2guCi0gKi8K
LXZvaWQgaW50ZWxfZW5naW5lX2xvc3RfY29udGV4dChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUpCi17Ci0Jc3RydWN0IGludGVsX2NvbnRleHQgKmNlOwotCi0JbG9ja2RlcF9hc3NlcnRf
aGVsZCgmZW5naW5lLT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQotCWNlID0gZmV0Y2hfYW5k
X3plcm8oJmVuZ2luZS0+bGFzdF9yZXRpcmVkX2NvbnRleHQpOwotCWlmIChjZSkKLQkJaW50ZWxf
Y29udGV4dF91bnBpbihjZSk7Ci19Ci0KIGJvb2wgaW50ZWxfZW5naW5lX2Nhbl9zdG9yZV9kd29y
ZChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7CiAJc3dpdGNoIChJTlRFTF9HRU4o
ZW5naW5lLT5pOTE1KSkgewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZW5naW5lX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0u
YwppbmRleCBjY2YwMzQ3NjQ3NDEuLjNjNDQ4YTA2MWFiZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMKQEAgLTg4LDYgKzg4LDggQEAgc3RhdGljIGJvb2wgc3dp
dGNoX3RvX2tlcm5lbF9jb250ZXh0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAog
CS8qIENoZWNrIGFnYWluIG9uIHRoZSBuZXh0IHJldGlyZW1lbnQuICovCiAJZW5naW5lLT53YWtl
cmVmX3NlcmlhbCA9IGVuZ2luZS0+c2VyaWFsICsgMTsKKworCWk5MTVfcmVxdWVzdF9hZGRfYmFy
cmllcnMocnEpOwogCV9faTkxNV9yZXF1ZXN0X2NvbW1pdChycSk7CiAKIAlyZXR1cm4gZmFsc2U7
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMu
aCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oCmluZGV4IDJj
MjMyNTAxZDk3My4uZDNkNWE1MDVmNjIxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9lbmdpbmVfdHlwZXMuaApAQCAtMTEsNiArMTEsNyBAQAogI2luY2x1ZGUgPGxpbnV4L2ly
cV93b3JrLmg+CiAjaW5jbHVkZSA8bGludXgva3JlZi5oPgogI2luY2x1ZGUgPGxpbnV4L2xpc3Qu
aD4KKyNpbmNsdWRlIDxsaW51eC9sbGlzdC5oPgogI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CiAK
ICNpbmNsdWRlICJpOTE1X2dlbS5oIgpAQCAtMjg2LDYgKzI4Nyw3IEBAIHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgewogCXN0cnVjdCBpbnRlbF9yaW5nICpidWZmZXI7CiAKIAlzdHJ1Y3QgaTkxNV90
aW1lbGluZSB0aW1lbGluZTsKKwlzdHJ1Y3QgbGxpc3RfaGVhZCBiYXJyaWVyX3Rhc2tzOwogCiAJ
c3RydWN0IGludGVsX2NvbnRleHQgKmtlcm5lbF9jb250ZXh0OyAvKiBwaW5uZWQgKi8KIAlzdHJ1
Y3QgaW50ZWxfY29udGV4dCAqcHJlZW1wdF9jb250ZXh0OyAvKiBwaW5uZWQ7IG9wdGlvbmFsICov
CkBAIC00MzMsMTcgKzQzNSw2IEBAIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgewogCiAJc3RydWN0
IGludGVsX2VuZ2luZV9leGVjbGlzdHMgZXhlY2xpc3RzOwogCi0JLyogQ29udGV4dHMgYXJlIHBp
bm5lZCB3aGlsc3QgdGhleSBhcmUgYWN0aXZlIG9uIHRoZSBHUFUuIFRoZSBsYXN0Ci0JICogY29u
dGV4dCBleGVjdXRlZCByZW1haW5zIGFjdGl2ZSB3aGlsc3QgdGhlIEdQVSBpcyBpZGxlIC0gdGhl
Ci0JICogc3dpdGNoIGF3YXkgYW5kIHdyaXRlIHRvIHRoZSBjb250ZXh0IG9iamVjdCBvbmx5IG9j
Y3VycyBvbiB0aGUKLQkgKiBuZXh0IGV4ZWN1dGlvbi4gIENvbnRleHRzIGFyZSBvbmx5IHVucGlu
bmVkIG9uIHJldGlyZW1lbnQgb2YgdGhlCi0JICogZm9sbG93aW5nIHJlcXVlc3QgZW5zdXJpbmcg
dGhhdCB3ZSBjYW4gYWx3YXlzIHdyaXRlIHRvIHRoZSBvYmplY3QKLQkgKiBvbiB0aGUgY29udGV4
dCBzd2l0Y2ggZXZlbiBhZnRlciBpZGxpbmcuIEFjcm9zcyBzdXNwZW5kLCB3ZSBzd2l0Y2gKLQkg
KiB0byB0aGUga2VybmVsIGNvbnRleHQgYW5kIHRyYXNoIGl0IGFzIHRoZSBzYXZlIG1heSBub3Qg
aGFwcGVuCi0JICogYmVmb3JlIHRoZSBoYXJkd2FyZSBpcyBwb3dlcmVkIGRvd24uCi0JICovCi0J
c3RydWN0IGludGVsX2NvbnRleHQgKmxhc3RfcmV0aXJlZF9jb250ZXh0OwotCiAJLyogc3RhdHVz
X25vdGlmaWVyOiBsaXN0IG9mIGNhbGxiYWNrcyBmb3IgY29udGV4dC1zd2l0Y2ggY2hhbmdlcyAq
LwogCXN0cnVjdCBhdG9taWNfbm90aWZpZXJfaGVhZCBjb250ZXh0X3N0YXR1c19ub3RpZmllcjsK
IApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwppbmRleCBmZWQ3MDQ4MDJjNTcuLjMzMWE2
NDA2MGMzMiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKQEAgLTE0MjIsNjAgKzE0
MjIsMTEgQEAgc3RhdGljIHZvaWQgZXhlY2xpc3RzX2NvbnRleHRfZGVzdHJveShzdHJ1Y3Qga3Jl
ZiAqa3JlZikKIAlpbnRlbF9jb250ZXh0X2ZyZWUoY2UpOwogfQogCi1zdGF0aWMgaW50IF9fY29u
dGV4dF9waW4oc3RydWN0IGk5MTVfdm1hICp2bWEpCi17Ci0JdW5zaWduZWQgaW50IGZsYWdzOwot
CWludCBlcnI7Ci0KLQlmbGFncyA9IFBJTl9HTE9CQUwgfCBQSU5fSElHSDsKLQlmbGFncyB8PSBQ
SU5fT0ZGU0VUX0JJQVMgfCBpOTE1X2dndHRfcGluX2JpYXModm1hKTsKLQotCWVyciA9IGk5MTVf
dm1hX3Bpbih2bWEsIDAsIDAsIGZsYWdzKTsKLQlpZiAoZXJyKQotCQlyZXR1cm4gZXJyOwotCi0J
dm1hLT5vYmotPnBpbl9nbG9iYWwrKzsKLQl2bWEtPm9iai0+bW0uZGlydHkgPSB0cnVlOwotCi0J
cmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyB2b2lkIF9fY29udGV4dF91bnBpbihzdHJ1Y3QgaTkxNV92
bWEgKnZtYSkKLXsKLQl2bWEtPm9iai0+cGluX2dsb2JhbC0tOwotCV9faTkxNV92bWFfdW5waW4o
dm1hKTsKLX0KLQogc3RhdGljIHZvaWQgZXhlY2xpc3RzX2NvbnRleHRfdW5waW4oc3RydWN0IGlu
dGVsX2NvbnRleHQgKmNlKQogewotCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKLQot
CS8qCi0JICogVGhlIHRhc2tsZXQgbWF5IHN0aWxsIGJlIHVzaW5nIGEgcG9pbnRlciB0byBvdXIg
c3RhdGUsIHZpYSBhbgotCSAqIG9sZCByZXF1ZXN0LiBIb3dldmVyLCBzaW5jZSB3ZSBrbm93IHdl
IG9ubHkgdW5waW4gdGhlIGNvbnRleHQKLQkgKiBvbiByZXRpcmVtZW50IG9mIHRoZSBmb2xsb3dp
bmcgcmVxdWVzdCwgd2Uga25vdyB0aGF0IHRoZSBsYXN0Ci0JICogcmVxdWVzdCByZWZlcmVuY2lu
ZyB1cyB3aWxsIGhhdmUgaGFkIGEgY29tcGxldGlvbiBDUyBpbnRlcnJ1cHQuCi0JICogSWYgd2Ug
c2VlIHRoYXQgaXQgaXMgc3RpbGwgYWN0aXZlLCBpdCBtZWFucyB0aGF0IHRoZSB0YXNrbGV0IGhh
c24ndAotCSAqIGhhZCB0aGUgY2hhbmNlIHRvIHJ1biB5ZXQ7IGxldCBpdCBydW4gYmVmb3JlIHdl
IHRlYXJkb3duIHRoZQotCSAqIHJlZmVyZW5jZSBpdCBtYXkgdXNlLgotCSAqLwotCWVuZ2luZSA9
IFJFQURfT05DRShjZS0+aW5mbGlnaHQpOwotCWlmICh1bmxpa2VseShlbmdpbmUpKSB7Ci0JCXVu
c2lnbmVkIGxvbmcgZmxhZ3M7Ci0KLQkJc3Bpbl9sb2NrX2lycXNhdmUoJmVuZ2luZS0+dGltZWxp
bmUubG9jaywgZmxhZ3MpOwotCQlwcm9jZXNzX2NzYihlbmdpbmUpOwotCQlzcGluX3VubG9ja19p
cnFyZXN0b3JlKCZlbmdpbmUtPnRpbWVsaW5lLmxvY2ssIGZsYWdzKTsKLQotCQlHRU1fQlVHX09O
KFJFQURfT05DRShjZS0+aW5mbGlnaHQpKTsKLQl9Ci0KIAlpOTE1X2dlbV9jb250ZXh0X3VucGlu
X2h3X2lkKGNlLT5nZW1fY29udGV4dCk7Ci0KLQlpbnRlbF9yaW5nX3VucGluKGNlLT5yaW5nKTsK
LQogCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAoY2UtPnN0YXRlLT5vYmopOwotCV9fY29udGV4
dF91bnBpbihjZS0+c3RhdGUpOworCWludGVsX3JpbmdfdW5waW4oY2UtPnJpbmcpOwogfQogCiBz
dGF0aWMgdm9pZApAQCAtMTUxMiw3ICsxNDYzLDEwIEBAIF9fZXhlY2xpc3RzX2NvbnRleHRfcGlu
KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKIAkJZ290byBlcnI7CiAJR0VNX0JVR19PTighY2Ut
PnN0YXRlKTsKIAotCXJldCA9IF9fY29udGV4dF9waW4oY2UtPnN0YXRlKTsKKwlyZXQgPSBpbnRl
bF9jb250ZXh0X2FjdGl2ZShjZSwKKwkJCQkgICBlbmdpbmUtPmk5MTUtPmdndHQucGluX2JpYXMg
fAorCQkJCSAgIFBJTl9PRkZTRVRfQklBUyB8CisJCQkJICAgUElOX0hJR0gpOwogCWlmIChyZXQp
CiAJCWdvdG8gZXJyOwogCkBAIC0xNTIxLDcgKzE0NzUsNyBAQCBfX2V4ZWNsaXN0c19jb250ZXh0
X3BpbihzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCiAJCQkJCUk5MTVfTUFQX09WRVJSSURFKTsK
IAlpZiAoSVNfRVJSKHZhZGRyKSkgewogCQlyZXQgPSBQVFJfRVJSKHZhZGRyKTsKLQkJZ290byB1
bnBpbl92bWE7CisJCWdvdG8gdW5waW5fYWN0aXZlOwogCX0KIAogCXJldCA9IGludGVsX3Jpbmdf
cGluKGNlLT5yaW5nKTsKQEAgLTE1NDIsOCArMTQ5Niw4IEBAIF9fZXhlY2xpc3RzX2NvbnRleHRf
cGluKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKIAlpbnRlbF9yaW5nX3VucGluKGNlLT5yaW5n
KTsKIHVucGluX21hcDoKIAlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKGNlLT5zdGF0ZS0+b2Jq
KTsKLXVucGluX3ZtYToKLQlfX2NvbnRleHRfdW5waW4oY2UtPnN0YXRlKTsKK3VucGluX2FjdGl2
ZToKKwlpbnRlbF9jb250ZXh0X2luYWN0aXZlKGNlKTsKIGVycjoKIAlyZXR1cm4gcmV0OwogfQpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jCmluZGV4IGZmNThkNjU4
ZTNlMi4uZmM1OTZhZGM2MzdhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9yaW5nYnVmZmVyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmlu
Z2J1ZmZlci5jCkBAIC0xMzQ5LDQ1ICsxMzQ5LDkgQEAgc3RhdGljIHZvaWQgX19jb250ZXh0X3Vu
cGluX3BwZ3R0KHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCiAJCWdlbjZfcHBndHRfdW5w
aW4ocHBndHQpOwogfQogCi1zdGF0aWMgaW50IF9fY29udGV4dF9waW4oc3RydWN0IGludGVsX2Nv
bnRleHQgKmNlKQotewotCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwotCWludCBlcnI7Ci0KLQl2bWEg
PSBjZS0+c3RhdGU7Ci0JaWYgKCF2bWEpCi0JCXJldHVybiAwOwotCi0JZXJyID0gaTkxNV92bWFf
cGluKHZtYSwgMCwgMCwgUElOX0dMT0JBTCB8IFBJTl9ISUdIKTsKLQlpZiAoZXJyKQotCQlyZXR1
cm4gZXJyOwotCi0JLyoKLQkgKiBBbmQgbWFyayBpcyBhcyBhIGdsb2JhbGx5IHBpbm5lZCBvYmpl
Y3QgdG8gbGV0IHRoZSBzaHJpbmtlciBrbm93Ci0JICogaXQgY2Fubm90IHJlY2xhaW0gdGhlIG9i
amVjdCB1bnRpbCB3ZSByZWxlYXNlIGl0LgotCSAqLwotCXZtYS0+b2JqLT5waW5fZ2xvYmFsKys7
Ci0Jdm1hLT5vYmotPm1tLmRpcnR5ID0gdHJ1ZTsKLQotCXJldHVybiAwOwotfQotCi1zdGF0aWMg
dm9pZCBfX2NvbnRleHRfdW5waW4oc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQotewotCXN0cnVj
dCBpOTE1X3ZtYSAqdm1hOwotCi0Jdm1hID0gY2UtPnN0YXRlOwotCWlmICghdm1hKQotCQlyZXR1
cm47Ci0KLQl2bWEtPm9iai0+cGluX2dsb2JhbC0tOwotCWk5MTVfdm1hX3VucGluKHZtYSk7Ci19
Ci0KIHN0YXRpYyB2b2lkIHJpbmdfY29udGV4dF91bnBpbihzdHJ1Y3QgaW50ZWxfY29udGV4dCAq
Y2UpCiB7CiAJX19jb250ZXh0X3VucGluX3BwZ3R0KGNlLT5nZW1fY29udGV4dCk7Ci0JX19jb250
ZXh0X3VucGluKGNlKTsKIH0KIAogc3RhdGljIHN0cnVjdCBpOTE1X3ZtYSAqCkBAIC0xNDc3LDE4
ICsxNDQxLDE4IEBAIHN0YXRpYyBpbnQgcmluZ19jb250ZXh0X3BpbihzdHJ1Y3QgaW50ZWxfY29u
dGV4dCAqY2UpCiAJCWNlLT5zdGF0ZSA9IHZtYTsKIAl9CiAKLQllcnIgPSBfX2NvbnRleHRfcGlu
KGNlKTsKKwllcnIgPSBpbnRlbF9jb250ZXh0X2FjdGl2ZShjZSwgUElOX0hJR0gpOwogCWlmIChl
cnIpCiAJCXJldHVybiBlcnI7CiAKIAllcnIgPSBfX2NvbnRleHRfcGluX3BwZ3R0KGNlLT5nZW1f
Y29udGV4dCk7CiAJaWYgKGVycikKLQkJZ290byBlcnJfdW5waW47CisJCWdvdG8gZXJyX2FjdGl2
ZTsKIAogCXJldHVybiAwOwogCi1lcnJfdW5waW46Ci0JX19jb250ZXh0X3VucGluKGNlKTsKK2Vy
cl9hY3RpdmU6CisJaW50ZWxfY29udGV4dF9pbmFjdGl2ZShjZSk7CiAJcmV0dXJuIGVycjsKIH0K
IApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvbW9ja19lbmdpbmUuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L21vY2tfZW5naW5lLmMKaW5kZXggNmQ3NTYyNzY5ZWIyLi5i
NzY3NWVmMTg1MjMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L21vY2tfZW5n
aW5lLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvbW9ja19lbmdpbmUuYwpAQCAtMTQ2
LDEyICsxNDYsMTggQEAgc3RhdGljIHZvaWQgbW9ja19jb250ZXh0X2Rlc3Ryb3koc3RydWN0IGty
ZWYgKnJlZikKIAogc3RhdGljIGludCBtb2NrX2NvbnRleHRfcGluKHN0cnVjdCBpbnRlbF9jb250
ZXh0ICpjZSkKIHsKKwlpbnQgcmV0OworCiAJaWYgKCFjZS0+cmluZykgewogCQljZS0+cmluZyA9
IG1vY2tfcmluZyhjZS0+ZW5naW5lKTsKIAkJaWYgKCFjZS0+cmluZykKIAkJCXJldHVybiAtRU5P
TUVNOwogCX0KIAorCXJldCA9IGludGVsX2NvbnRleHRfYWN0aXZlKGNlLCBQSU5fSElHSCk7CisJ
aWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKwogCW1vY2tfdGltZWxpbmVfcGluKGNlLT5yaW5nLT50
aW1lbGluZSk7CiAJcmV0dXJuIDA7CiB9CkBAIC0zMjgsMTQgKzMzNCw5IEBAIHZvaWQgbW9ja19l
bmdpbmVfZnJlZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7CiAJc3RydWN0IG1v
Y2tfZW5naW5lICptb2NrID0KIAkJY29udGFpbmVyX29mKGVuZ2luZSwgdHlwZW9mKCptb2NrKSwg
YmFzZSk7Ci0Jc3RydWN0IGludGVsX2NvbnRleHQgKmNlOwogCiAJR0VNX0JVR19PTih0aW1lcl9w
ZW5kaW5nKCZtb2NrLT5od19kZWxheSkpOwogCi0JY2UgPSBmZXRjaF9hbmRfemVybygmZW5naW5l
LT5sYXN0X3JldGlyZWRfY29udGV4dCk7Ci0JaWYgKGNlKQotCQlpbnRlbF9jb250ZXh0X3VucGlu
KGNlKTsKLQogCWludGVsX2NvbnRleHRfdW5waW4oZW5naW5lLT5rZXJuZWxfY29udGV4dCk7CiAK
IAlpbnRlbF9lbmdpbmVfZmluaV9icmVhZGNydW1icyhlbmdpbmUpOwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfYWN0aXZlLmMKaW5kZXggODYzYWUxMjcwN2JhLi41NjMyOTllNTA5MDEgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9hY3RpdmUuYwpAQCAtMTAwLDcgKzEwMCw3IEBAIGFjdGl2ZV9pbnN0YW5jZShz
dHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwgdTY0IGlkeCkKIAkJcGFyZW50ID0gKnA7CiAKIAkJbm9k
ZSA9IHJiX2VudHJ5KHBhcmVudCwgc3RydWN0IGFjdGl2ZV9ub2RlLCBub2RlKTsKLQkJaWYgKG5v
ZGUtPnRpbWVsaW5lID09IGlkeCkKKwkJaWYgKG5vZGUtPnRpbWVsaW5lID09IGlkeCAmJiAhSVNf
RVJSKG5vZGUtPmJhc2UucmVxdWVzdCkpCiAJCQlnb3RvIHJlcGxhY2U7CiAKIAkJaWYgKG5vZGUt
PnRpbWVsaW5lIDwgaWR4KQpAQCAtMTU3LDYgKzE1Nyw3IEBAIHZvaWQgaTkxNV9hY3RpdmVfaW5p
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAlyZWYtPnJldGlyZSA9IHJldGlyZTsK
IAlyZWYtPnRyZWUgPSBSQl9ST09UOwogCWk5MTVfYWN0aXZlX3JlcXVlc3RfaW5pdCgmcmVmLT5s
YXN0LCBOVUxMLCBsYXN0X3JldGlyZSk7CisJaW5pdF9sbGlzdF9oZWFkKCZyZWYtPmJhcnJpZXJz
KTsKIAlyZWYtPmNvdW50ID0gMDsKIH0KIApAQCAtMjYzLDYgKzI2NCw4NCBAQCB2b2lkIGk5MTVf
YWN0aXZlX2Zpbmkoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCiB9CiAjZW5kaWYKIAoraW50IGk5
MTVfYWN0aXZlX2FjcXVpcmVfcHJlYWxsb2NhdGVfYmFycmllcihzdHJ1Y3QgaTkxNV9hY3RpdmUg
KnJlZiwKKwkJCQkJICAgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGVuZ2luZS0+aTkxNTsKKwl1bnNpZ25lZCBsb25n
IHRtcDsKKwlpbnQgZXJyID0gMDsKKworCWk5MTVfYWN0aXZlX2FjcXVpcmUocmVmKTsKKwlmb3Jf
ZWFjaF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgaTkxNSwgZW5naW5lLT5tYXNrLCB0bXApIHsKKwkJ
c3RydWN0IGludGVsX2NvbnRleHQgKmtjdHggPSBlbmdpbmUtPmtlcm5lbF9jb250ZXh0OworCQlz
dHJ1Y3QgYWN0aXZlX25vZGUgKm5vZGU7CisKKwkJbm9kZSA9IGttZW1fY2FjaGVfYWxsb2MoZ2xv
YmFsLnNsYWJfY2FjaGUsIEdGUF9LRVJORUwpOworCQlpZiAodW5saWtlbHkoIW5vZGUpKSB7CisJ
CQllcnIgPSAtRU5PTUVNOworCQkJYnJlYWs7CisJCX0KKworCQlpOTE1X2FjdGl2ZV9yZXF1ZXN0
X2luaXQoJm5vZGUtPmJhc2UsCisJCQkJCSAodm9pZCAqKWVuZ2luZSwgbm9kZV9yZXRpcmUpOwor
CQlub2RlLT50aW1lbGluZSA9IGtjdHgtPnJpbmctPnRpbWVsaW5lLT5mZW5jZV9jb250ZXh0Owor
CQlub2RlLT5yZWYgPSByZWY7CisJCXJlZi0+Y291bnQrKzsKKworCQlsbGlzdF9hZGQoKHN0cnVj
dCBsbGlzdF9ub2RlICopJm5vZGUtPmJhc2UubGluaywKKwkJCSAgJnJlZi0+YmFycmllcnMpOwor
CX0KKwlpOTE1X2FjdGl2ZV9yZWxlYXNlKHJlZik7CisKKwlyZXR1cm4gZXJyOworfQorCit2b2lk
IGk5MTVfYWN0aXZlX2FjcXVpcmVfYmFycmllcihzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZikKK3sK
KwlzdHJ1Y3QgbGxpc3Rfbm9kZSAqcG9zLCAqbmV4dDsKKworCWk5MTVfYWN0aXZlX2FjcXVpcmUo
cmVmKTsKKworCWxsaXN0X2Zvcl9lYWNoX3NhZmUocG9zLCBuZXh0LCBsbGlzdF9kZWxfYWxsKCZy
ZWYtPmJhcnJpZXJzKSkgeworCQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CisJCXN0
cnVjdCBhY3RpdmVfbm9kZSAqbm9kZTsKKwkJc3RydWN0IHJiX25vZGUgKipwLCAqcGFyZW50Owor
CisJCW5vZGUgPSBjb250YWluZXJfb2YoKHN0cnVjdCBsaXN0X2hlYWQgKilwb3MsCisJCQkJICAg
IHR5cGVvZigqbm9kZSksIGJhc2UubGluayk7CisKKwkJZW5naW5lID0gKHZvaWQgKilyY3VfYWNj
ZXNzX3BvaW50ZXIobm9kZS0+YmFzZS5yZXF1ZXN0KTsKKwkJUkNVX0lOSVRfUE9JTlRFUihub2Rl
LT5iYXNlLnJlcXVlc3QsIEVSUl9QVFIoLUVBR0FJTikpOworCisJCXBhcmVudCA9IE5VTEw7CisJ
CXAgPSAmcmVmLT50cmVlLnJiX25vZGU7CisJCXdoaWxlICgqcCkgeworCQkJcGFyZW50ID0gKnA7
CisJCQlpZiAocmJfZW50cnkocGFyZW50LAorCQkJCSAgICAgc3RydWN0IGFjdGl2ZV9ub2RlLAor
CQkJCSAgICAgbm9kZSktPnRpbWVsaW5lIDwgbm9kZS0+dGltZWxpbmUpCisJCQkJcCA9ICZwYXJl
bnQtPnJiX3JpZ2h0OworCQkJZWxzZQorCQkJCXAgPSAmcGFyZW50LT5yYl9sZWZ0OworCQl9CisJ
CXJiX2xpbmtfbm9kZSgmbm9kZS0+bm9kZSwgcGFyZW50LCBwKTsKKwkJcmJfaW5zZXJ0X2NvbG9y
KCZub2RlLT5ub2RlLCAmcmVmLT50cmVlKTsKKworCQlsbGlzdF9hZGQoKHN0cnVjdCBsbGlzdF9u
b2RlICopJm5vZGUtPmJhc2UubGluaywKKwkJCSAgJmVuZ2luZS0+YmFycmllcl90YXNrcyk7CisJ
fQorCWk5MTVfYWN0aXZlX3JlbGVhc2UocmVmKTsKK30KKwordm9pZCBpOTE1X3JlcXVlc3RfYWRk
X2JhcnJpZXJzKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQoreworCXN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSA9IHJxLT5lbmdpbmU7CisJc3RydWN0IGxsaXN0X25vZGUgKm5vZGUsICpu
ZXh0OworCisJbGxpc3RfZm9yX2VhY2hfc2FmZShub2RlLCBuZXh0LCBsbGlzdF9kZWxfYWxsKCZl
bmdpbmUtPmJhcnJpZXJfdGFza3MpKQorCQlsaXN0X2FkZF90YWlsKChzdHJ1Y3QgbGlzdF9oZWFk
ICopbm9kZSwgJnJxLT5hY3RpdmVfbGlzdCk7Cit9CisKIGludCBpOTE1X2FjdGl2ZV9yZXF1ZXN0
X3NldChzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlLAogCQkJICAgIHN0cnVjdCBp
OTE1X3JlcXVlc3QgKnJxKQogewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9hY3RpdmUuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmgKaW5kZXggN2Q3
NTg3MTljZTM5Li5kNTVkMzc2NzM5NDQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfYWN0aXZlLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuaApA
QCAtNDA2LDQgKzQwNiw5IEBAIHZvaWQgaTkxNV9hY3RpdmVfZmluaShzdHJ1Y3QgaTkxNV9hY3Rp
dmUgKnJlZik7CiBzdGF0aWMgaW5saW5lIHZvaWQgaTkxNV9hY3RpdmVfZmluaShzdHJ1Y3QgaTkx
NV9hY3RpdmUgKnJlZikgeyB9CiAjZW5kaWYKIAoraW50IGk5MTVfYWN0aXZlX2FjcXVpcmVfcHJl
YWxsb2NhdGVfYmFycmllcihzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwKKwkJCQkJICAgIHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7Cit2b2lkIGk5MTVfYWN0aXZlX2FjcXVpcmVfYmFy
cmllcihzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZik7Cit2b2lkIGk5MTVfcmVxdWVzdF9hZGRfYmFy
cmllcnMoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpOworCiAjZW5kaWYgLyogX0k5MTVfQUNUSVZF
X0hfICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZV90eXBl
cy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmVfdHlwZXMuaAppbmRleCBiNjc5
MjUzYjUzYTUuLmMwMjU5OTFiOTIzMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9hY3RpdmVfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2
ZV90eXBlcy5oCkBAIC03LDYgKzcsNyBAQAogI2lmbmRlZiBfSTkxNV9BQ1RJVkVfVFlQRVNfSF8K
ICNkZWZpbmUgX0k5MTVfQUNUSVZFX1RZUEVTX0hfCiAKKyNpbmNsdWRlIDxsaW51eC9sbGlzdC5o
PgogI2luY2x1ZGUgPGxpbnV4L3JidHJlZS5oPgogI2luY2x1ZGUgPGxpbnV4L3JjdXBkYXRlLmg+
CiAKQEAgLTMxLDYgKzMyLDggQEAgc3RydWN0IGk5MTVfYWN0aXZlIHsKIAl1bnNpZ25lZCBpbnQg
Y291bnQ7CiAKIAl2b2lkICgqcmV0aXJlKShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZik7CisKKwlz
dHJ1Y3QgbGxpc3RfaGVhZCBiYXJyaWVyczsKIH07CiAKICNlbmRpZiAvKiBfSTkxNV9BQ1RJVkVf
VFlQRVNfSF8gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCmluZGV4IDkwOTIzZmE2NjAzZC4uYWQ5
NDRlMTJkOGJlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKQEAgLTExNTMsMTAgKzExNTMsNiBA
QCB2b2lkIGk5MTVfZ2VtX3Nhbml0aXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQog
CiAJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtFX0FM
TCk7CiAJaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7Ci0KLQltdXRleF9sb2Nr
KCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQlpOTE1X2dlbV9jb250ZXh0c19sb3N0KGk5MTUp
OwotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiB9CiAKIHZvaWQgaTkx
NV9nZW1faW5pdF9zd2l6emxpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYwppbmRleCBkYTFlNjk4NGE4Y2MuLmVhYzdjNjAw
Nzg0NiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMKQEAgLTIxMywxOCArMjEzLDYg
QEAgc3RhdGljIHZvaWQgX19yZXRpcmVfZW5naW5lX3JlcXVlc3Qoc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lLAogCXNwaW5fdW5sb2NrKCZycS0+bG9jayk7CiAKIAlsb2NhbF9pcnFfZW5h
YmxlKCk7Ci0KLQkvKgotCSAqIFRoZSBiYWNraW5nIG9iamVjdCBmb3IgdGhlIGNvbnRleHQgaXMg
ZG9uZSBhZnRlciBzd2l0Y2hpbmcgdG8gdGhlCi0JICogKm5leHQqIGNvbnRleHQuIFRoZXJlZm9y
ZSB3ZSBjYW5ub3QgcmV0aXJlIHRoZSBwcmV2aW91cyBjb250ZXh0IHVudGlsCi0JICogdGhlIG5l
eHQgY29udGV4dCBoYXMgYWxyZWFkeSBzdGFydGVkIHJ1bm5pbmcuIEhvd2V2ZXIsIHNpbmNlIHdl
Ci0JICogY2Fubm90IHRha2UgdGhlIHJlcXVpcmVkIGxvY2tzIGF0IGk5MTVfcmVxdWVzdF9zdWJt
aXQoKSB3ZQotCSAqIGRlZmVyIHRoZSB1bnBpbm5pbmcgb2YgdGhlIGFjdGl2ZSBjb250ZXh0IHRv
IG5vdywgcmV0aXJlbWVudCBvZgotCSAqIHRoZSBzdWJzZXF1ZW50IHJlcXVlc3QuCi0JICovCi0J
aWYgKGVuZ2luZS0+bGFzdF9yZXRpcmVkX2NvbnRleHQpCi0JCWludGVsX2NvbnRleHRfdW5waW4o
ZW5naW5lLT5sYXN0X3JldGlyZWRfY29udGV4dCk7Ci0JZW5naW5lLT5sYXN0X3JldGlyZWRfY29u
dGV4dCA9IHJxLT5od19jb250ZXh0OwogfQogCiBzdGF0aWMgdm9pZCBfX3JldGlyZV9lbmdpbmVf
dXB0byhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCkBAIC03NTksOSArNzQ3LDYgQEAg
X19pOTE1X3JlcXVlc3RfY3JlYXRlKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgZ2ZwX3QgZ2Zw
KQogCiAJcnEtPmluZml4ID0gcnEtPnJpbmctPmVtaXQ7IC8qIGVuZCBvZiBoZWFkZXI7IHN0YXJ0
IG9mIHVzZXIgcGF5bG9hZCAqLwogCi0JLyogS2VlcCBhIHNlY29uZCBwaW4gZm9yIHRoZSBkdWFs
IHJldGlyZW1lbnQgYWxvbmcgZW5naW5lIGFuZCByaW5nICovCi0JX19pbnRlbF9jb250ZXh0X3Bp
bihjZSk7Ci0KIAlpbnRlbF9jb250ZXh0X21hcmtfYWN0aXZlKGNlKTsKIAlyZXR1cm4gcnE7CiAK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2dlbV9kZXZp
Y2UuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2dlbV9kZXZpY2UuYwpp
bmRleCBiN2YzZmJiNGFlODkuLmE5NmQwYzAxMmQ0NiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfZ2VtX2RldmljZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2dlbV9kZXZpY2UuYwpAQCAtNTYsNyArNTYsNiBAQCBzdGF0
aWMgdm9pZCBtb2NrX2RldmljZV9yZWxlYXNlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCiAKIAlt
dXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAltb2NrX2RldmljZV9mbHVzaChp
OTE1KTsKLQlpOTE1X2dlbV9jb250ZXh0c19sb3N0KGk5MTUpOwogCW11dGV4X3VubG9jaygmaTkx
NS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAKIAlmbHVzaF93b3JrKCZpOTE1LT5nZW0uaWRsZV93b3Jr
KTsKLS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Au
b3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwt
Z2Z4

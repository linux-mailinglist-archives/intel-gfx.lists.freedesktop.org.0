Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 6FC7ECE827
	for <lists+intel-gfx@lfdr.de>; Mon,  7 Oct 2019 17:45:52 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B2AFA6E043;
	Mon,  7 Oct 2019 15:45:50 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7FFAD6E043
 for <intel-gfx@lists.freedesktop.org>; Mon,  7 Oct 2019 15:45:49 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18753909-1500050 
 for multiple; Mon, 07 Oct 2019 16:45:32 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Mon,  7 Oct 2019 16:45:31 +0100
Message-Id: <20191007154531.1750-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915/gt: Prefer local path to runtime
 powermanagement
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QXZvaWQgZ29pbmcgdG8gdGhlIGJhc2UgaTkxNSBkZXZpY2Ugd2hlbiB3ZSBhbHJlYWR5IGhhdmUg
YSBwYXRoIGZyb20gZ3QKdG8gdGhlIHJ1bnRpbWUgcG93ZXJtYW5hZ2VtZW50IGludGVyZmFjZS4g
VGhlIGJlbmVmaXQgaXMgdGhhdCBpdCBsb29rcyBhCmJpdCBtb3JlIHNlbGYtY29uc2lzdGVudCB0
byBhbHdheXMgYmUgYWNxdWlyaW5nIHRoZSBndC0+dW5jb3JlLT5ycG0gZm9yCnVzZSB3aXRoIHRo
ZSBndC0+dW5jb3JlLgoKU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13
aWxzb24uY28udWs+CkNjOiBEYW5pZWxlIENlcmFvbG8gU3B1cmlvIDxkYW5pZWxlLmNlcmFvbG9z
cHVyaW9AaW50ZWwuY29tPgpDYzogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVs
LmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMgICAgICAg
IHwgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMgICAgICB8
IDQgKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMgICAgICB8
IDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmMgICAgICAgICAgICAgfCA3
ICsrKy0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3BtLmMgICAgICAgICAg
fCA0ICsrLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2hhbmdjaGVjay5jICAgICAg
fCA0ICsrLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMgICAgICAgICAg
fCA2ICsrKy0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfaGFuZ2NoZWNrLmMg
ICB8IDQgKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfcmVzZXQuYyAgICAg
ICB8IDggKysrKy0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91
bmRzLmMgfCA0ICsrLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19sb2cu
YyAgICAgfCAzICstLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfaHVjLmMgICAg
ICAgICB8IDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX3VjLmMgICAgICAg
ICAgfCAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2lycS5jICAgICAgICAgICAgICAg
IHwgNiArKystLS0KIDE0IGZpbGVzIGNoYW5nZWQsIDI4IGluc2VydGlvbnMoKyksIDMwIGRlbGV0
aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRl
eHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYwppbmRleCBiZTM0
ZDk3YWMxOGYuLjEyMjVjNGI4ZTlhYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfY29udGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2Nv
bnRleHQuYwpAQCAtNjIsNyArNjIsNyBAQCBpbnQgX19pbnRlbF9jb250ZXh0X2RvX3BpbihzdHJ1
Y3QgaW50ZWxfY29udGV4dCAqY2UpCiAJCX0KIAogCQllcnIgPSAwOwotCQl3aXRoX2ludGVsX3J1
bnRpbWVfcG0oJmNlLT5lbmdpbmUtPmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpCisJCXdpdGhf
aW50ZWxfcnVudGltZV9wbShjZS0+ZW5naW5lLT5ndC0+dW5jb3JlLT5ycG0sIHdha2VyZWYpCiAJ
CQllcnIgPSBjZS0+b3BzLT5waW4oY2UpOwogCQlpZiAoZXJyKQogCQkJZ290byBlcnI7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jCmluZGV4IDgwZmQwNzJhYzcxOS4u
ZDEwZDEzZDAyODJmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9l
bmdpbmVfY3MuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3Mu
YwpAQCAtMTQ1OCwxMCArMTQ1OCwxMCBAQCB2b2lkIGludGVsX2VuZ2luZV9kdW1wKHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZlbmdpbmUt
PmFjdGl2ZS5sb2NrLCBmbGFncyk7CiAKIAlkcm1fcHJpbnRmKG0sICJcdE1NSU8gYmFzZTogIDB4
JTA4eFxuIiwgZW5naW5lLT5tbWlvX2Jhc2UpOwotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3Bt
X2dldF9pZl9pbl91c2UoJmVuZ2luZS0+aTkxNS0+cnVudGltZV9wbSk7CisJd2FrZXJlZiA9IGlu
dGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3VzZShlbmdpbmUtPmd0LT51bmNvcmUtPnJwbSk7CiAJ
aWYgKHdha2VyZWYpIHsKIAkJaW50ZWxfZW5naW5lX3ByaW50X3JlZ2lzdGVycyhlbmdpbmUsIG0p
OwotCQlpbnRlbF9ydW50aW1lX3BtX3B1dCgmZW5naW5lLT5pOTE1LT5ydW50aW1lX3BtLCB3YWtl
cmVmKTsKKwkJaW50ZWxfcnVudGltZV9wbV9wdXQoZW5naW5lLT5ndC0+dW5jb3JlLT5ycG0sIHdh
a2VyZWYpOwogCX0gZWxzZSB7CiAJCWRybV9wcmludGYobSwgIlx0RGV2aWNlIGlzIGFzbGVlcDsg
c2tpcHBpbmcgcmVnaXN0ZXIgZHVtcFxuIik7CiAJfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9lbmdpbmVfcG0uYwppbmRleCA4ZTVlNTEzZWRkYzkuLjQzZmM3Y2UzZjU0ZSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMKQEAgLTE4NSw3ICsxODUsNyBA
QCBzdGF0aWMgY29uc3Qgc3RydWN0IGludGVsX3dha2VyZWZfb3BzIHdmX29wcyA9IHsKIAogdm9p
ZCBpbnRlbF9lbmdpbmVfaW5pdF9fcG0oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQog
ewotCXN0cnVjdCBpbnRlbF9ydW50aW1lX3BtICpycG0gPSAmZW5naW5lLT5pOTE1LT5ydW50aW1l
X3BtOworCXN0cnVjdCBpbnRlbF9ydW50aW1lX3BtICpycG0gPSBlbmdpbmUtPmd0LT51bmNvcmUt
PnJwbTsKIAogCWludGVsX3dha2VyZWZfaW5pdCgmZW5naW5lLT53YWtlcmVmLCBycG0sICZ3Zl9v
cHMpOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmMKaW5kZXggOGY0NGNmOGM3OWIyLi5i
MzYxOWEyYTVkMGUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuYwpAQCAtMjczLDcgKzI3
Myw3IEBAIHZvaWQgaW50ZWxfZ3RfY2hlY2tfYW5kX2NsZWFyX2ZhdWx0cyhzdHJ1Y3QgaW50ZWxf
Z3QgKmd0KQogCiB2b2lkIGludGVsX2d0X2ZsdXNoX2dndHRfd3JpdGVzKHN0cnVjdCBpbnRlbF9n
dCAqZ3QpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndC0+aTkxNTsKKwlz
dHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBndC0+dW5jb3JlOwogCWludGVsX3dha2VyZWZf
dCB3YWtlcmVmOwogCiAJLyoKQEAgLTI5NywxMyArMjk3LDEyIEBAIHZvaWQgaW50ZWxfZ3RfZmx1
c2hfZ2d0dF93cml0ZXMoc3RydWN0IGludGVsX2d0ICpndCkKIAogCXdtYigpOwogCi0JaWYgKElO
VEVMX0lORk8oaTkxNSktPmhhc19jb2hlcmVudF9nZ3R0KQorCWlmIChJTlRFTF9JTkZPKGd0LT5p
OTE1KS0+aGFzX2NvaGVyZW50X2dndHQpCiAJCXJldHVybjsKIAogCWludGVsX2d0X2NoaXBzZXRf
Zmx1c2goZ3QpOwogCi0Jd2l0aF9pbnRlbF9ydW50aW1lX3BtKCZpOTE1LT5ydW50aW1lX3BtLCB3
YWtlcmVmKSB7Ci0JCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IGd0LT51bmNvcmU7CisJ
d2l0aF9pbnRlbF9ydW50aW1lX3BtKHVuY29yZS0+cnBtLCB3YWtlcmVmKSB7CiAJCXVuc2lnbmVk
IGxvbmcgZmxhZ3M7CiAKIAkJc3Bpbl9sb2NrX2lycXNhdmUoJnVuY29yZS0+bG9jaywgZmxhZ3Mp
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3BtLmMKaW5kZXggYjUyZTJiYTNkMDkyLi44
N2UzNGUwYjY0MjcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0
X3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYwpAQCAtOTQs
NyArOTQsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGludGVsX3dha2VyZWZfb3BzIHdmX29wcyA9
IHsKIAogdm9pZCBpbnRlbF9ndF9wbV9pbml0X2Vhcmx5KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7
Ci0JaW50ZWxfd2FrZXJlZl9pbml0KCZndC0+d2FrZXJlZiwgJmd0LT5pOTE1LT5ydW50aW1lX3Bt
LCAmd2Zfb3BzKTsKKwlpbnRlbF93YWtlcmVmX2luaXQoJmd0LT53YWtlcmVmLCBndC0+dW5jb3Jl
LT5ycG0sICZ3Zl9vcHMpOwogCiAJQkxPQ0tJTkdfSU5JVF9OT1RJRklFUl9IRUFEKCZndC0+cG1f
bm90aWZpY2F0aW9ucyk7CiB9CkBAIC0yMjIsNyArMjIyLDcgQEAgdm9pZCBpbnRlbF9ndF9zdXNw
ZW5kKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiAJLyogV2UgZXhwZWN0IHRvIGJlIGlkbGUgYWxyZWFk
eTsgYnV0IGFsc28gd2FudCB0byBiZSBpbmRlcGVuZGVudCAqLwogCXdhaXRfZm9yX2lkbGUoZ3Qp
OwogCi0Jd2l0aF9pbnRlbF9ydW50aW1lX3BtKCZndC0+aTkxNS0+cnVudGltZV9wbSwgd2FrZXJl
ZikKKwl3aXRoX2ludGVsX3J1bnRpbWVfcG0oZ3QtPnVuY29yZS0+cnBtLCB3YWtlcmVmKQogCQlp
bnRlbF9yYzZfZGlzYWJsZSgmZ3QtPnJjNik7CiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2hhbmdjaGVjay5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfaGFuZ2NoZWNrLmMKaW5kZXggOTgxNGIxOGIzMmFkLi5jMTRkYmViM2NjYzMgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2hhbmdjaGVjay5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2hhbmdjaGVjay5jCkBAIC0yNzEsNyArMjcxLDcg
QEAgc3RhdGljIHZvaWQgaGFuZ2NoZWNrX2VsYXBzZWQoc3RydWN0IHdvcmtfc3RydWN0ICp3b3Jr
KQogCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoZ3QpKQogCQlyZXR1cm47CiAKLQl3YWtlcmVmID0g
aW50ZWxfcnVudGltZV9wbV9nZXRfaWZfaW5fdXNlKCZndC0+aTkxNS0+cnVudGltZV9wbSk7CisJ
d2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3VzZShndC0+dW5jb3JlLT5ycG0p
OwogCWlmICghd2FrZXJlZikKIAkJcmV0dXJuOwogCkBAIC0zMjIsNyArMzIyLDcgQEAgc3RhdGlj
IHZvaWQgaGFuZ2NoZWNrX2VsYXBzZWQoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQogCWlmICho
dW5nKQogCQloYW5nY2hlY2tfZGVjbGFyZV9oYW5nKGd0LCBodW5nLCBzdHVjayk7CiAKLQlpbnRl
bF9ydW50aW1lX3BtX3B1dCgmZ3QtPmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOworCWludGVs
X3J1bnRpbWVfcG1fcHV0KGd0LT51bmNvcmUtPnJwbSwgd2FrZXJlZik7CiAKIAkvKiBSZXNldCB0
aW1lciBpbiBjYXNlIEdQVSBoYW5ncyB3aXRob3V0IGFub3RoZXIgcmVxdWVzdCBiZWluZyBhZGRl
ZCAqLwogCWludGVsX2d0X3F1ZXVlX2hhbmdjaGVjayhndCk7CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfcmVzZXQuYwppbmRleCA3YjNkOWQ0NTE3YTAuLjllMzk4MjlhNmM0ZCAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jCkBAIC04MTEsNyArODExLDcgQEAgdm9pZCBpbnRl
bF9ndF9zZXRfd2VkZ2VkKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiAJaW50ZWxfd2FrZXJlZl90IHdh
a2VyZWY7CiAKIAltdXRleF9sb2NrKCZndC0+cmVzZXQubXV0ZXgpOwotCXdpdGhfaW50ZWxfcnVu
dGltZV9wbSgmZ3QtPmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpCisJd2l0aF9pbnRlbF9ydW50
aW1lX3BtKGd0LT51bmNvcmUtPnJwbSwgd2FrZXJlZikKIAkJX19pbnRlbF9ndF9zZXRfd2VkZ2Vk
KGd0KTsKIAltdXRleF91bmxvY2soJmd0LT5yZXNldC5tdXRleCk7CiB9CkBAIC0xMTg2LDcgKzEx
ODYsNyBAQCB2b2lkIGludGVsX2d0X2hhbmRsZV9lcnJvcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAog
CSAqIGlzbid0IHRoZSBjYXNlIGF0IGxlYXN0IHdoZW4gd2UgZ2V0IGhlcmUgYnkgZG9pbmcgYQog
CSAqIHNpbXVsYXRlZCByZXNldCB2aWEgZGVidWdmcywgc28gZ2V0IGFuIFJQTSByZWZlcmVuY2Uu
CiAJICovCi0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZndC0+aTkxNS0+cnVudGlt
ZV9wbSk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGd0LT51bmNvcmUtPnJwbSk7
CiAKIAllbmdpbmVfbWFzayAmPSBJTlRFTF9JTkZPKGd0LT5pOTE1KS0+ZW5naW5lX21hc2s7CiAK
QEAgLTEyNDYsNyArMTI0Niw3IEBAIHZvaWQgaW50ZWxfZ3RfaGFuZGxlX2Vycm9yKHN0cnVjdCBp
bnRlbF9ndCAqZ3QsCiAJd2FrZV91cF9hbGwoJmd0LT5yZXNldC5xdWV1ZSk7CiAKIG91dDoKLQlp
bnRlbF9ydW50aW1lX3BtX3B1dCgmZ3QtPmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOworCWlu
dGVsX3J1bnRpbWVfcG1fcHV0KGd0LT51bmNvcmUtPnJwbSwgd2FrZXJlZik7CiB9CiAKIGludCBp
bnRlbF9ndF9yZXNldF90cnlsb2NrKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGludCAqc3JjdSkKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfaGFuZ2NoZWNrLmMKaW5kZXggZThhNDBk
Zjc5YmQwLi41NjlhNDEwNWQ0OWUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L3NlbGZ0ZXN0X2hhbmdjaGVjay5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0
ZXN0X2hhbmdjaGVjay5jCkBAIC0xNjk1LDE0ICsxNjk1LDE0IEBAIGludCBpbnRlbF9oYW5nY2hl
Y2tfbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJaWYgKGlu
dGVsX2d0X2lzX3dlZGdlZChndCkpCiAJCXJldHVybiAtRUlPOyAvKiB3ZSdyZSBsb25nIHBhc3Qg
aG9wZSBvZiBhIHN1Y2Nlc3NmdWwgcmVzZXQgKi8KIAotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1l
X3BtX2dldCgmZ3QtPmk5MTUtPnJ1bnRpbWVfcG0pOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1l
X3BtX2dldChndC0+dW5jb3JlLT5ycG0pOwogCXNhdmVkX2hhbmdjaGVjayA9IGZldGNoX2FuZF96
ZXJvKCZpOTE1X21vZHBhcmFtcy5lbmFibGVfaGFuZ2NoZWNrKTsKIAlkcmFpbl9kZWxheWVkX3dv
cmsoJmd0LT5oYW5nY2hlY2sud29yayk7IC8qIGZsdXNoIHBhcmFtICovCiAKIAllcnIgPSBpbnRl
bF9ndF9saXZlX3N1YnRlc3RzKHRlc3RzLCBndCk7CiAKIAlpOTE1X21vZHBhcmFtcy5lbmFibGVf
aGFuZ2NoZWNrID0gc2F2ZWRfaGFuZ2NoZWNrOwotCWludGVsX3J1bnRpbWVfcG1fcHV0KCZndC0+
aTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoZ3QtPnVu
Y29yZS0+cnBtLCB3YWtlcmVmKTsKIAogCXJldHVybiBlcnI7CiB9CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9yZXNldC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Qvc2VsZnRlc3RfcmVzZXQuYwppbmRleCBkNzk0ODJkYjdmZTguLjQxOWIzOGZhNzgyOCAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfcmVzZXQuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9yZXNldC5jCkBAIC0xNyw3ICsxNyw3
IEBAIHN0YXRpYyBpbnQgaWd0X2dsb2JhbF9yZXNldCh2b2lkICphcmcpCiAJLyogQ2hlY2sgdGhh
dCB3ZSBjYW4gaXNzdWUgYSBnbG9iYWwgR1BVIHJlc2V0ICovCiAKIAlpZ3RfZ2xvYmFsX3Jlc2V0
X2xvY2soZ3QpOwotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmZ3QtPmk5MTUtPnJ1
bnRpbWVfcG0pOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChndC0+dW5jb3JlLT5y
cG0pOwogCiAJcmVzZXRfY291bnQgPSBpOTE1X3Jlc2V0X2NvdW50KCZndC0+aTkxNS0+Z3B1X2Vy
cm9yKTsKIApAQCAtMjgsNyArMjgsNyBAQCBzdGF0aWMgaW50IGlndF9nbG9iYWxfcmVzZXQodm9p
ZCAqYXJnKQogCQllcnIgPSAtRUlOVkFMOwogCX0KIAotCWludGVsX3J1bnRpbWVfcG1fcHV0KCZn
dC0+aTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoZ3Qt
PnVuY29yZS0+cnBtLCB3YWtlcmVmKTsKIAlpZ3RfZ2xvYmFsX3Jlc2V0X3VubG9jayhndCk7CiAK
IAlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKGd0KSkKQEAgLTQ1LDE0ICs0NSwxNCBAQCBzdGF0aWMg
aW50IGlndF93ZWRnZWRfcmVzZXQodm9pZCAqYXJnKQogCS8qIENoZWNrIHRoYXQgd2UgY2FuIHJl
Y292ZXIgYSB3ZWRnZWQgZGV2aWNlIHdpdGggYSBHUFUgcmVzZXQgKi8KIAogCWlndF9nbG9iYWxf
cmVzZXRfbG9jayhndCk7Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZndC0+aTkx
NS0+cnVudGltZV9wbSk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGd0LT51bmNv
cmUtPnJwbSk7CiAKIAlpbnRlbF9ndF9zZXRfd2VkZ2VkKGd0KTsKIAogCUdFTV9CVUdfT04oIWlu
dGVsX2d0X2lzX3dlZGdlZChndCkpOwogCWludGVsX2d0X3Jlc2V0KGd0LCBBTExfRU5HSU5FUywg
TlVMTCk7CiAKLQlpbnRlbF9ydW50aW1lX3BtX3B1dCgmZ3QtPmk5MTUtPnJ1bnRpbWVfcG0sIHdh
a2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KGd0LT51bmNvcmUtPnJwbSwgd2FrZXJlZik7
CiAJaWd0X2dsb2JhbF9yZXNldF91bmxvY2soZ3QpOwogCiAJcmV0dXJuIGludGVsX2d0X2lzX3dl
ZGdlZChndCkgPyAtRUlPIDogMDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVz
dF93b3JrYXJvdW5kcy5jCmluZGV4IDk1NjI3ZTgwZjI0Ni4uZDM3YjBkNjc1NDlkIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF93b3JrYXJvdW5kcy5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMKQEAgLTI1Niw3
ICsyNTYsNyBAQCBzd2l0Y2hfdG9fc2NyYXRjaF9jb250ZXh0KHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSwKIAlHRU1fQlVHX09OKElTX0VSUihjZSkpOwogCiAJcnEgPSBFUlJfUFRSKC1F
Tk9ERVYpOwotCXdpdGhfaW50ZWxfcnVudGltZV9wbSgmZW5naW5lLT5pOTE1LT5ydW50aW1lX3Bt
LCB3YWtlcmVmKQorCXdpdGhfaW50ZWxfcnVudGltZV9wbShlbmdpbmUtPmd0LT51bmNvcmUtPnJw
bSwgd2FrZXJlZikKIAkJcnEgPSBpZ3Rfc3Bpbm5lcl9jcmVhdGVfcmVxdWVzdChzcGluLCBjZSwg
TUlfTk9PUCk7CiAKIAlpbnRlbF9jb250ZXh0X3B1dChjZSk7CkBAIC0zMTMsNyArMzEzLDcgQEAg
c3RhdGljIGludCBjaGVja193aGl0ZWxpc3RfYWNyb3NzX3Jlc2V0KHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSwKIAlpZiAoZXJyKQogCQlnb3RvIG91dF9zcGluOwogCi0Jd2l0aF9pbnRl
bF9ydW50aW1lX3BtKCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKQorCXdpdGhfaW50ZWxfcnVu
dGltZV9wbShlbmdpbmUtPmd0LT51bmNvcmUtPnJwbSwgd2FrZXJlZikKIAkJZXJyID0gcmVzZXQo
ZW5naW5lKTsKIAogCWlndF9zcGlubmVyX2VuZCgmc3Bpbik7CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfbG9nLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC91Yy9pbnRlbF9ndWNfbG9nLmMKaW5kZXggMzYzMzIwNjRkZTljLi4yY2YyZDMzMTRmNjIg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19sb2cuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfbG9nLmMKQEAgLTYwNyw3
ICs2MDcsNiBAQCBpbnQgaW50ZWxfZ3VjX2xvZ19yZWxheV9vcGVuKHN0cnVjdCBpbnRlbF9ndWNf
bG9nICpsb2cpCiB2b2lkIGludGVsX2d1Y19sb2dfcmVsYXlfZmx1c2goc3RydWN0IGludGVsX2d1
Y19sb2cgKmxvZykKIHsKIAlzdHJ1Y3QgaW50ZWxfZ3VjICpndWMgPSBsb2dfdG9fZ3VjKGxvZyk7
Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndWNfdG9fZ3QoZ3VjKS0+aTkxNTsK
IAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKIAogCS8qCkBAIC02MTYsNyArNjE1LDcgQEAgdm9p
ZCBpbnRlbF9ndWNfbG9nX3JlbGF5X2ZsdXNoKHN0cnVjdCBpbnRlbF9ndWNfbG9nICpsb2cpCiAJ
ICovCiAJZmx1c2hfd29yaygmbG9nLT5yZWxheS5mbHVzaF93b3JrKTsKIAotCXdpdGhfaW50ZWxf
cnVudGltZV9wbSgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZikKKwl3aXRoX2ludGVsX3J1bnRp
bWVfcG0oZ3VjX3RvX2d0KGd1YyktPnVuY29yZS0+cnBtLCB3YWtlcmVmKQogCQlndWNfYWN0aW9u
X2ZsdXNoX2xvZyhndWMpOwogCiAJLyogR3VDIHdvdWxkIGhhdmUgdXBkYXRlZCBsb2cgYnVmZmVy
IGJ5IG5vdywgc28gY2FwdHVyZSBpdCAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvdWMvaW50ZWxfaHVjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9o
dWMuYwppbmRleCBkNDYyNWM5N2I0ZjkuLjMzNjA4YTExNGQ0ZSAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfaHVjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvdWMvaW50ZWxfaHVjLmMKQEAgLTE4NSw3ICsxODUsNyBAQCBpbnQgaW50ZWxfaHVjX2No
ZWNrX3N0YXR1cyhzdHJ1Y3QgaW50ZWxfaHVjICpodWMpCiAJaWYgKCFpbnRlbF9odWNfaXNfc3Vw
cG9ydGVkKGh1YykpCiAJCXJldHVybiAtRU5PREVWOwogCi0Jd2l0aF9pbnRlbF9ydW50aW1lX3Bt
KCZndC0+aTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZikKKwl3aXRoX2ludGVsX3J1bnRpbWVfcG0o
Z3QtPnVuY29yZS0+cnBtLCB3YWtlcmVmKQogCQlzdGF0dXMgPSBpbnRlbF91bmNvcmVfcmVhZChn
dC0+dW5jb3JlLCBodWMtPnN0YXR1cy5yZWcpOwogCiAJcmV0dXJuIChzdGF0dXMgJiBodWMtPnN0
YXR1cy5tYXNrKSA9PSBodWMtPnN0YXR1cy52YWx1ZTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L3VjL2ludGVsX3VjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9p
bnRlbF91Yy5jCmluZGV4IDI5YTllZWM2MGQyZS4uM2ZkYmM5MzVkMTU1IDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF91Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3VjL2ludGVsX3VjLmMKQEAgLTU4Nyw3ICs1ODcsNyBAQCB2b2lkIGludGVsX3Vj
X3N1c3BlbmQoc3RydWN0IGludGVsX3VjICp1YykKIAlpZiAoIWludGVsX2d1Y19pc19ydW5uaW5n
KGd1YykpCiAJCXJldHVybjsKIAotCXdpdGhfaW50ZWxfcnVudGltZV9wbSgmdWNfdG9fZ3QodWMp
LT5pOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKQorCXdpdGhfaW50ZWxfcnVudGltZV9wbSh1Y190
b19ndCh1YyktPnVuY29yZS0+cnBtLCB3YWtlcmVmKQogCQlpbnRlbF91Y19ydW50aW1lX3N1c3Bl
bmQodWMpOwogfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2lycS5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9pcnEuYwppbmRleCBmMjM3MWI2MDgzYzYuLjNh
ZjdmNzkxNGM0MCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9pcnEuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2lycS5jCkBAIC00MTIsNyArNDEyLDcgQEAg
dm9pZCBnZW45X3Jlc2V0X2d1Y19pbnRlcnJ1cHRzKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKIHsK
IAlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gZ3VjX3RvX2d0KGd1Yyk7CiAKLQlhc3NlcnRfcnBtX3dh
a2Vsb2NrX2hlbGQoJmd0LT5pOTE1LT5ydW50aW1lX3BtKTsKKwlhc3NlcnRfcnBtX3dha2Vsb2Nr
X2hlbGQoZ3QtPnVuY29yZS0+cnBtKTsKIAogCXNwaW5fbG9ja19pcnEoJmd0LT5pcnFfbG9jayk7
CiAJZ2VuNl9ndF9wbV9yZXNldF9paXIoZ3QsIGd0LT5wbV9ndWNfZXZlbnRzKTsKQEAgLTQyMyw3
ICs0MjMsNyBAQCB2b2lkIGdlbjlfZW5hYmxlX2d1Y19pbnRlcnJ1cHRzKHN0cnVjdCBpbnRlbF9n
dWMgKmd1YykKIHsKIAlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gZ3VjX3RvX2d0KGd1Yyk7CiAKLQlh
c3NlcnRfcnBtX3dha2Vsb2NrX2hlbGQoJmd0LT5pOTE1LT5ydW50aW1lX3BtKTsKKwlhc3NlcnRf
cnBtX3dha2Vsb2NrX2hlbGQoZ3QtPnVuY29yZS0+cnBtKTsKIAogCXNwaW5fbG9ja19pcnEoJmd0
LT5pcnFfbG9jayk7CiAJaWYgKCFndWMtPmludGVycnVwdHMuZW5hYmxlZCkgewpAQCAtNDQwLDcg
KzQ0MCw3IEBAIHZvaWQgZ2VuOV9kaXNhYmxlX2d1Y19pbnRlcnJ1cHRzKHN0cnVjdCBpbnRlbF9n
dWMgKmd1YykKIHsKIAlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gZ3VjX3RvX2d0KGd1Yyk7CiAKLQlh
c3NlcnRfcnBtX3dha2Vsb2NrX2hlbGQoJmd0LT5pOTE1LT5ydW50aW1lX3BtKTsKKwlhc3NlcnRf
cnBtX3dha2Vsb2NrX2hlbGQoZ3QtPnVuY29yZS0+cnBtKTsKIAogCXNwaW5fbG9ja19pcnEoJmd0
LT5pcnFfbG9jayk7CiAJZ3VjLT5pbnRlcnJ1cHRzLmVuYWJsZWQgPSBmYWxzZTsKLS0gCjIuMjMu
MAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwt
Z2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8v
bGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

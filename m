Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 9903AD6253
	for <lists+intel-gfx@lfdr.de>; Mon, 14 Oct 2019 14:21:26 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E64E96E1F3;
	Mon, 14 Oct 2019 12:21:24 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4DC556E1F3
 for <intel-gfx@lists.freedesktop.org>; Mon, 14 Oct 2019 12:21:23 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 18831648-1500050 for multiple; Mon, 14 Oct 2019 13:21:20 +0100
MIME-Version: 1.0
From: Chris Wilson <chris@chris-wilson.co.uk>
User-Agent: alot/0.6
To: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>,
 intel-gfx@lists.freedesktop.org
References: <20191014090757.32111-1-chris@chris-wilson.co.uk>
 <20191014090757.32111-12-chris@chris-wilson.co.uk>
 <8947bb82-2d5e-05b6-634c-4669476876d2@linux.intel.com>
In-Reply-To: <8947bb82-2d5e-05b6-634c-4669476876d2@linux.intel.com>
Message-ID: <157105567849.18859.13582226068488487412@skylake-alporthouse-com>
Date: Mon, 14 Oct 2019 13:21:18 +0100
Subject: Re: [Intel-gfx] [PATCH 12/15] drm/i915/gem: Cancel non-persistent
 contexts on close
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVvdGluZyBUdnJ0a28gVXJzdWxpbiAoMjAxOS0xMC0xNCAxMzoxMTo0NikKPiAKPiBPbiAxNC8x
MC8yMDE5IDEwOjA3LCBDaHJpcyBXaWxzb24gd3JvdGU6Cj4gPiBOb3JtYWxseSwgd2UgcmVseSBv
biBvdXIgaGFuZ2NoZWNrIHRvIHByZXZlbnQgcGVyc2lzdGVudCBiYXRjaGVzIGZyb20KPiA+IGhv
Z2dpbmcgdGhlIEdQVS4gSG93ZXZlciwgaWYgdGhlIHVzZXIgZGlzYWJsZXMgaGFuZ2NoZWNrLCB0
aGlzIG1lY2hhbmlzbQo+ID4gYnJlYWtzIGRvd24uIERlc3BpdGUgb3VyIGluc2lzdGVuY2UgdGhh
dCB0aGlzIGlzIHVuc2FmZSwgdGhlIHVzZXJzIGFyZQo+ID4gZXF1YWxseSBpbnNpc3RlbnQgdGhh
dCB0aGV5IHdhbnQgdG8gdXNlIGVuZGxlc3MgYmF0Y2hlcyBhbmQgd2lsbCBkaXNhYmxlCj4gPiB0
aGUgaGFuZ2NoZWNrIG1lY2hhbmlzbS4gV2UgYXJlIGxvb2tpbmcgYXQgcGVyaGFwcyByZXBsYWNp
bmcgaGFuZ2NoZWNrCj4gPiB3aXRoIGEgc29mdGVyIG1lY2hhbmlzbSwgdGhhdCBzZW5kcyBhIHB1
bHNlIGRvd24gdGhlIGVuZ2luZSB0byBjaGVjayBpZgo+ID4gaXQgaXMgd2VsbC4gV2UgY2FuIHVz
ZSB0aGUgc2FtZSBwcmVlbXB0aXZlIHB1bHNlIHRvIGZsdXNoIGFuIGFjdGl2ZQo+ID4gcGVyc2lz
dGVudCBjb250ZXh0IG9mZiB0aGUgR1BVIHVwb24gY29udGV4dCBjbG9zZSwgcHJldmVudGluZyBy
ZXNvdXJjZXMKPiA+IGJlaW5nIGxvc3QgYW5kIHVua2lsbGFibGUgcmVxdWVzdHMgcmVtYWluaW5n
IG9uIHRoZSBHUFUgYWZ0ZXIgcHJvY2Vzcwo+ID4gdGVybWluYXRpb24uIFRvIGF2b2lkIGNoYW5n
aW5nIHRoZSBBQkkgYW5kIGFjY2lkZW50YWxseSBicmVha2luZwo+ID4gZXhpc3RpbmcgdXNlcnNw
YWNlLCB3ZSBtYWtlIHRoZSBwZXJzaXN0ZW5jZSBvZiBhIGNvbnRleHQgZXhwbGljaXQgYW5kCj4g
PiBlbmFibGUgaXQgYnkgZGVmYXVsdCAobWF0Y2hpbmcgY3VycmVudCBBQkkpLiBVc2Vyc3BhY2Ug
Y2FuIG9wdCBvdXQgb2YKPiA+IHBlcnNpc3RlbnQgbW9kZSAoZm9yY2luZyByZXF1ZXN0cyB0byBi
ZSBjYW5jZWxsZWQgd2hlbiB0aGUgY29udGV4dCBpcwo+ID4gY2xvc2VkIGJ5IHByb2Nlc3MgdGVy
bWluYXRpb24gb3IgZXhwbGljaXRseSkgYnkgYSBjb250ZXh0IHBhcmFtZXRlci4gVG8KPiA+IGZh
Y2lsaXRhdGUgZXhpc3RpbmcgdXNlLWNhc2VzIG9mIGRpc2FibGluZyBoYW5nY2hlY2ssIGlmIHRo
ZSBtb2RwYXJhbSBpcwo+ID4gZGlzYWJsZWQgKGk5MTUuZW5hYmxlX2hhbmdjaGVjaz0wKSwgd2Ug
ZGlzYWJsZSBwZXJzaXN0ZW5jZSBtb2RlIGJ5Cj4gPiBkZWZhdWx0LiAgKE5vdGUsIG9uZSBvZiB0
aGUgb3V0Y29tZXMgZm9yIHN1cHBvcnRpbmcgZW5kbGVzcyBtb2RlIHdpbGwgYmUKPiA+IHRoZSBy
ZW1vdmFsIG9mIGhhbmdjaGVja2luZywgYXQgd2hpY2ggcG9pbnQgb3B0aW5nIGludG8gcGVyc2lz
dGVudCBtb2RlCj4gPiB3aWxsIGJlIG1hbmRhdG9yeSwgb3IgbWF5YmUgdGhlIGRlZmF1bHQgcGVy
aGFwcyBjb250cm9sbGVkIGJ5IGNncm91cHMuKQo+ID4gCj4gPiB2MjogQ2hlY2sgZm9yIGhhbmdj
aGVja2luZyBhdCBjb250ZXh0IHRlcm1pbmF0aW9uLCBzbyB0aGF0IHdlIGFyZSBub3QKPiA+IGxl
ZnQgd2l0aCB1bmR5aW5nIGNvbnRleHRzIGZyb20gYSBjcmFmdHkgdXNlci4KPiA+IHYzOiBGb3Jj
ZSBjb250ZXh0IHRlcm1pbmF0aW9uIGV2ZW4gaWYgZm9yY2VkLXByZWVtcHRpb24gaXMgZGlzYWJs
ZWQuCj4gPiAKPiA+IFRlc3RjYXNlOiBpZ3QvZ2VtX2N0eF9wZXJzaXN0ZW5jZQo+ID4gU2lnbmVk
LW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Cj4gPiBDYzog
Sm9vbmFzIExhaHRpbmVuIDxqb29uYXMubGFodGluZW5AbGludXguaW50ZWwuY29tPgo+ID4gQ2M6
IE1pY2hhxYIgV2luaWFyc2tpIDxtaWNoYWwud2luaWFyc2tpQGludGVsLmNvbT4KPiA+IENjOiBK
b24gQmxvb21maWVsZCA8am9uLmJsb29tZmllbGRAaW50ZWwuY29tPgo+ID4gUmV2aWV3ZWQtYnk6
IEpvbiBCbG9vbWZpZWxkIDxqb24uYmxvb21maWVsZEBpbnRlbC5jb20+Cj4gPiAtLS0KPiA+ICAg
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYyAgIHwgMTgyICsrKysr
KysrKysrKysrKysrKwo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29u
dGV4dC5oICAgfCAgMTUgKysKPiA+ICAgLi4uL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29u
dGV4dF90eXBlcy5oIHwgICAxICsKPiA+ICAgLi4uL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3Rz
L21vY2tfY29udGV4dC5jIHwgICAyICsKPiA+ICAgaW5jbHVkZS91YXBpL2RybS9pOTE1X2RybS5o
ICAgICAgICAgICAgICAgICAgIHwgIDE1ICsrCj4gPiAgIDUgZmlsZXMgY2hhbmdlZCwgMjE1IGlu
c2VydGlvbnMoKykKPiA+IAo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
Y29udGV4dC5jCj4gPiBpbmRleCA1ZDgyMjFjN2JhODMuLjcwYjcyNDU2ZTJjNCAxMDA2NDQKPiA+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKPiA+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKPiA+IEBAIC03
MCw2ICs3MCw3IEBACj4gPiAgICNpbmNsdWRlIDxkcm0vaTkxNV9kcm0uaD4KPiA+ICAgCj4gPiAg
ICNpbmNsdWRlICJndC9pbnRlbF9scmNfcmVnLmgiCj4gPiArI2luY2x1ZGUgImd0L2ludGVsX2Vu
Z2luZV9oZWFydGJlYXQuaCIKPiA+ICAgI2luY2x1ZGUgImd0L2ludGVsX2VuZ2luZV91c2VyLmgi
Cj4gPiAgIAo+ID4gICAjaW5jbHVkZSAiaTkxNV9nZW1fY29udGV4dC5oIgo+ID4gQEAgLTI2OSw2
ICsyNzAsMTI4IEBAIHZvaWQgaTkxNV9nZW1fY29udGV4dF9yZWxlYXNlKHN0cnVjdCBrcmVmICpy
ZWYpCj4gPiAgICAgICAgICAgICAgIHNjaGVkdWxlX3dvcmsoJmdjLT5mcmVlX3dvcmspOwo+ID4g
ICB9Cj4gPiAgIAo+ID4gK3N0YXRpYyBpbmxpbmUgc3RydWN0IGk5MTVfZ2VtX2VuZ2luZXMgKgo+
ID4gK19fY29udGV4dF9lbmdpbmVzX3N0YXRpYyhjb25zdCBzdHJ1Y3QgaTkxNV9nZW1fY29udGV4
dCAqY3R4KQo+ID4gK3sKPiA+ICsgICAgIHJldHVybiByY3VfZGVyZWZlcmVuY2VfcHJvdGVjdGVk
KGN0eC0+ZW5naW5lcywgdHJ1ZSk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBib29sIF9fcmVz
ZXRfZW5naW5lKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiA+ICt7Cj4gPiArICAg
ICBzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gZW5naW5lLT5ndDsKPiA+ICsgICAgIGJvb2wgc3VjY2Vz
cyA9IGZhbHNlOwo+ID4gKwo+ID4gKyAgICAgaWYgKCFpbnRlbF9oYXNfcmVzZXRfZW5naW5lKGd0
KSkKPiA+ICsgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwo+ID4gKwo+ID4gKyAgICAgaWYgKCF0
ZXN0X2FuZF9zZXRfYml0KEk5MTVfUkVTRVRfRU5HSU5FICsgZW5naW5lLT5pZCwKPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAmZ3QtPnJlc2V0LmZsYWdzKSkgewo+ID4gKyAgICAgICAg
ICAgICBzdWNjZXNzID0gaW50ZWxfZW5naW5lX3Jlc2V0KGVuZ2luZSwgTlVMTCkgPT0gMDsKPiA+
ICsgICAgICAgICAgICAgY2xlYXJfYW5kX3dha2VfdXBfYml0KEk5MTVfUkVTRVRfRU5HSU5FICsg
ZW5naW5lLT5pZCwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZndC0+
cmVzZXQuZmxhZ3MpOwo+ID4gKyAgICAgfQo+ID4gKwo+ID4gKyAgICAgcmV0dXJuIHN1Y2Nlc3M7
Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIF9fcmVzZXRfY29udGV4dChzdHJ1Y3QgaTkx
NV9nZW1fY29udGV4dCAqY3R4LAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gPiArewo+ID4gKyAgICAgaW50ZWxfZ3RfaGFuZGxl
X2Vycm9yKGVuZ2luZS0+Z3QsIGVuZ2luZS0+bWFzaywgMCwKPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAiY29udGV4dCBjbG9zdXJlIGluICVzIiwgY3R4LT5uYW1lKTsKPiA+ICt9Cj4g
PiArCj4gPiArc3RhdGljIGJvb2wgX19jYW5jZWxfZW5naW5lKHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSkKPiA+ICt7Cj4gPiArICAgICAvKgo+ID4gKyAgICAgICogU2VuZCBhICJoaWdo
IHByaW9yaXR5IHB1bHNlIiBkb3duIHRoZSBlbmdpbmUgdG8gY2F1c2UgdGhlCj4gPiArICAgICAg
KiBjdXJyZW50IHJlcXVlc3QgdG8gYmUgbW9tZW50YXJpbHkgcHJlZW1wdGVkLiAoSWYgaXQgZmFp
bHMgdG8KPiA+ICsgICAgICAqIGJlIHByZWVtcHRlZCwgaXQgd2lsbCBiZSByZXNldCkuIEFzIHdl
IGhhdmUgbWFya2VkIG91ciBjb250ZXh0Cj4gPiArICAgICAgKiBhcyBiYW5uZWQsIGFueSBpbmNv
bXBsZXRlIHJlcXVlc3QsIGluY2x1ZGluZyBhbnkgcnVubmluZywgd2lsbAo+ID4gKyAgICAgICog
YmUgc2tpcHBlZCBmb2xsb3dpbmcgdGhlIHByZWVtcHRpb24uCj4gPiArICAgICAgKi8KPiA+ICsg
ICAgIGlmIChDT05GSUdfRFJNX0k5MTVfUFJFRU1QVF9USU1FT1VUICYmICFpbnRlbF9lbmdpbmVf
cHVsc2UoZW5naW5lKSkKPiA+ICsgICAgICAgICAgICAgcmV0dXJuIHRydWU7Cj4gCj4gTWF5YmUg
SSBsb3N0IHRoZSB0cmFpbiBvZiB0aG91Z2h0IGhlcmUuLiBCdXQgd2h5IG5vdCBldmVuIHRyeSB3
aXRoIHRoZSAKPiBwdWxzZSBldmVuIGlmIGZvcmNlZCBwcmVlbXB0aW9uIGlzIG5vdCBjb21waWxl
ZCBpbj8gVGhlcmUgaXMgYSBjaGFuY2UgaXQgCj4gbWF5IHByZWVtcHQgbm9ybWFsbHksIG5vPwoK
SWYgdGhlcmUgaXMgbm8gcmVzZXQtb24tcHJlZW1wdGlvbiBmYWlsdXJlIGFuZCBubyBoYW5nY2hl
Y2tpbmcsIHRoZXJlIGlzCm5vIHJlc2V0IGFuZCB3ZSBhcmUgbGVmdCB3aXRoIHRoZSBkZW5pYWwt
b2Ytc2VydmljZSB0aGF0IHdlIGFyZSBzZWVraW5nCnRvIGNsb3NlLgogCj4gSG0sIG9yIGZyb20g
dGhlIG90aGVyIGFuZ2xlLCB3aHkgYm90aGVyIHdpdGggcHJlZW1wdGlvbiBhbmQgbm90IGp1c3Qg
Cj4gcmVzZXQ/IFdoYXQgaXMgdGhlIHZhbHVlIGluIGxldHRpbmcgdGhlIGNsb3NlZCBjb250ZXh0
IGNvbXBsZXRlIGlmIGF0IAo+IHRoZSBzYW1lIHRpbWUsIGlmIGl0IGlzIHByZWVtcHRhYmxlLCB3
ZSB3aWxsIGNhbmNlbCBhbGwgb3V0c3RhbmRpbmcgd29yayAKPiBhbnl3YXk/CgpUaGUgcmVzZXQg
aXMgdGhlIGVsZXBoYW50IGd1bjsgaXQgaXMgbGlrZWx5IHRvIGNhdXNlIGNvbGxhdGVyYWwgZGFt
YWdlLgpTbyB3ZSB0cnkgd2l0aCBhIGJpdCBvZiBmaW5lc3NlIGZpcnN0LgotQ2hyaXMKX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxp
bmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

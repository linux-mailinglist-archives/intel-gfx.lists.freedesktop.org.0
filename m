Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id ECE1B2CC8EB
	for <lists+intel-gfx@lfdr.de>; Wed,  2 Dec 2020 22:28:29 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F22266EADF;
	Wed,  2 Dec 2020 21:28:25 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (unknown [77.68.26.236])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B2D7A6EB0B
 for <intel-gfx@lists.freedesktop.org>; Wed,  2 Dec 2020 21:28:23 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from build.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 23195638-1500050 
 for multiple; Wed, 02 Dec 2020 21:28:16 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed,  2 Dec 2020 21:28:14 +0000
Message-Id: <20201202212814.26320-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v3] drm/i915/display: Record the plane update
 times for debugging
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Chris Wilson <chris@chris-wilson.co.uk>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

U2luY2Ugd2UgdHJ5IGFuZCBlc3RpbWF0ZSBob3cgbG9uZyB3ZSByZXF1aXJlIHRvIHVwZGF0ZSB0
aGUgcmVnaXN0ZXJzIHRvCnBlcmZvcm0gYSBwbGFuZSB1cGRhdGUsIGl0IGlzIG9mIHZpdGFsIGlt
cG9ydGFuY2UgdGhhdCB3ZSBtZWFzdXJlIHRoZQpkaXN0cmlidXRpb24gb2YgcGxhbmUgdXBkYXRl
cyB0byBiZXR0ZXIgZ3VpZGUgb3VyIGVzdGltYXRlLiBJZiB3ZQp1bmRlcmVzdGltYXRlIGhvdyBs
b25nIGl0IHRha2VzIHRvIHBlcmZvcm0gdGhlIHBsYW5lIHVwZGF0ZSwgd2UgbWF5CnNsaXAgaW50
byB0aGUgbmV4dCBzY2Fub3V0IGZyYW1lIGNhdXNpbmcgYSB0ZWFyLiBJZiB3ZSBvdmVyZXN0aW1h
dGUsIHdlCm1heSB1bm5lY2Vzc2FyaWx5IGRlbGF5IHRoZSB1cGRhdGUgdG8gdGhlIG5leHQgZnJh
bWUsIGNhdXNpbmcgdmlzaWJsZQpqaXR0ZXIuCgpSZXBsYWNlIHRoZSB3YXJuaW5nIHRoYXQgd2Ug
ZXhjZWVkIHNvbWUgYXJiaXRyYXJ5IHRocmVzaG9sZCBmb3IgdGhlCnZibGFuayB1cGRhdGUgd2l0
aCBhIGhpc3RvZ3JhbSBmb3IgZGVidWdmcy4KCnYyOiBBZGQgYSBwZXItY3J0YyBkZWJ1Z2ZzIGVu
dHJ5IHNvIHRoYXQgdGhlIGluZm9ybWF0aW9uIGlzIGVhc2llciB0bwpleHRyYWN0IHdoZW4gdGVz
dGluZyBpbmRpdmlkdWFsIENSVEMsIGFuZCBzbyB0aGF0IGl0IGNhbiBiZSByZXNldCBiZWZvcmUK
YSB0ZXN0LgoKdjM6IEZsaXAgdGhlIGdyYXBoIG9uIGl0cyBzaWRlOyBjcmVhdGVzIHNwYWNlIHRv
IGxhYmVsIHRoZSB0aW1lIGF4aXMuCgpVcGRhdGVzOiA0Njg0CiAgICAgICB8CiAgIDF1cyB8CiAg
ICAgICB8CiAgIDR1cyB8KioqKioqKioKICAgICAgIHwqKioqKioqKioqCiAgMTZ1cyB8KioqKioq
KioqKioKICAgICAgIHwqKioqKgogIDY2dXMgfAogICAgICAgfAogMjYydXMgfAogICAgICAgfAog
ICAxbXMgfAogICAgICAgfAogICA0bXMgfAogICAgICAgfAogIDE3bXMgfAogICAgICAgfApNaW4g
dXBkYXRlOiA1OTE4bnMKTWF4IHVwZGF0ZTogNTQ3ODFucwpBdmVyYWdlIHVwZGF0ZTogMTY2Mjhu
cwpPdmVycnVucyA+IDI1MHVzOiAwCgpDbG9zZXM6IGh0dHBzOi8vZ2l0bGFiLmZyZWVkZXNrdG9w
Lm9yZy9kcm0vaW50ZWwvLS9pc3N1ZXMvMTk4MgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24g
PGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KQ2M6IEphbmkgTmlrdWxhIDxqYW5pLm5pa3VsYUBs
aW51eC5pbnRlbC5jb20+CkNjOiBWaWxsZSBTeXJqw6Rsw6QgPHZpbGxlLnN5cmphbGFAbGludXgu
aW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxh
eS5jICB8ICAxMCArLQogLi4uL2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV9kZWJ1Z2Zz
LmMgIHwgMTI0ICsrKysrKysrKysrKysrKysrKwogLi4uL2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZGlzcGxheV9kZWJ1Z2ZzLmggIHwgICAzICsKIC4uLi9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rp
c3BsYXlfdHlwZXMuaCAgICB8ICAgOSArKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9zcHJpdGUuYyAgIHwgIDQ5ICsrKystLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfc3ByaXRlLmggICB8ICAxMCArKwogNiBmaWxlcyBjaGFuZ2VkLCAxODcgaW5zZXJ0
aW9ucygrKSwgMTggZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2Rpc3BsYXkuYwppbmRleCBiYTI2NTQ1MzkyYmMuLjkxODdhMjBhOGFjYSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKQEAgLTQ1LDYgKzQ1
LDcgQEAKIAogI2luY2x1ZGUgImRpc3BsYXkvaW50ZWxfY3J0LmgiCiAjaW5jbHVkZSAiZGlzcGxh
eS9pbnRlbF9kZGkuaCIKKyNpbmNsdWRlICJkaXNwbGF5L2ludGVsX2Rpc3BsYXlfZGVidWdmcy5o
IgogI2luY2x1ZGUgImRpc3BsYXkvaW50ZWxfZHAuaCIKICNpbmNsdWRlICJkaXNwbGF5L2ludGVs
X2RwX21zdC5oIgogI2luY2x1ZGUgImRpc3BsYXkvaW50ZWxfZHBsbF9tZ3IuaCIKQEAgLTE3MjY2
LDYgKzE3MjY3LDEyIEBAIGludGVsX2N1cnNvcl9wbGFuZV9jcmVhdGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAogCXJldHVybiBFUlJfUFRSKHJldCk7CiB9CiAKK3N0YXRpYyBp
bnQgaW50ZWxfY3J0Y19sYXRlX3JlZ2lzdGVyKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykKK3sKKwlp
bnRlbF9jcnRjX2RlYnVnZnNfYWRkKGNydGMpOworCXJldHVybiAwOworfQorCiAjZGVmaW5lIElO
VEVMX0NSVENfRlVOQ1MgXAogCS5nYW1tYV9zZXQgPSBkcm1fYXRvbWljX2hlbHBlcl9sZWdhY3lf
Z2FtbWFfc2V0LCBcCiAJLnNldF9jb25maWcgPSBkcm1fYXRvbWljX2hlbHBlcl9zZXRfY29uZmln
LCBcCkBAIC0xNzI3NSw3ICsxNzI4Miw4IEBAIGludGVsX2N1cnNvcl9wbGFuZV9jcmVhdGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogCS5hdG9taWNfZGVzdHJveV9zdGF0ZSA9
IGludGVsX2NydGNfZGVzdHJveV9zdGF0ZSwgXAogCS5zZXRfY3JjX3NvdXJjZSA9IGludGVsX2Ny
dGNfc2V0X2NyY19zb3VyY2UsIFwKIAkudmVyaWZ5X2NyY19zb3VyY2UgPSBpbnRlbF9jcnRjX3Zl
cmlmeV9jcmNfc291cmNlLCBcCi0JLmdldF9jcmNfc291cmNlcyA9IGludGVsX2NydGNfZ2V0X2Ny
Y19zb3VyY2VzCisJLmdldF9jcmNfc291cmNlcyA9IGludGVsX2NydGNfZ2V0X2NyY19zb3VyY2Vz
LCBcCisJLmxhdGVfcmVnaXN0ZXIgPSBpbnRlbF9jcnRjX2xhdGVfcmVnaXN0ZXIKIAogc3RhdGlj
IGNvbnN0IHN0cnVjdCBkcm1fY3J0Y19mdW5jcyBiZHdfY3J0Y19mdW5jcyA9IHsKIAlJTlRFTF9D
UlRDX0ZVTkNTLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9kaXNwbGF5X2RlYnVnZnMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZGlzcGxheV9kZWJ1Z2ZzLmMKaW5kZXggY2E0MWU4YzAwYWQ3Li5jZDdlNTUxOWVlN2QgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV9kZWJ1Z2Zz
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X2RlYnVn
ZnMuYwpAQCAtMTgsNiArMTgsNyBAQAogI2luY2x1ZGUgImludGVsX3BtLmgiCiAjaW5jbHVkZSAi
aW50ZWxfcHNyLmgiCiAjaW5jbHVkZSAiaW50ZWxfc2lkZWJhbmQuaCIKKyNpbmNsdWRlICJpbnRl
bF9zcHJpdGUuaCIKIAogc3RhdGljIGlubGluZSBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqbm9k
ZV90b19pOTE1KHN0cnVjdCBkcm1faW5mb19ub2RlICpub2RlKQogewpAQCAtODY1LDYgKzg2Niwx
MTAgQEAgc3RhdGljIHZvaWQgaW50ZWxfc2NhbGVyX2luZm8oc3RydWN0IHNlcV9maWxlICptLCBz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKIAl9CiB9CiAKKyNpZiBJU19FTkFCTEVEKENPTkZJR19E
Uk1fSTkxNV9ERUJVR19WQkxBTktfRVZBREUpCitzdGF0aWMgdm9pZCBjcnRjX3VwZGF0ZXNfaW5m
byhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sCisJCQkgICAgICBzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywK
KwkJCSAgICAgIGNvbnN0IGNoYXIgKmhkcikKK3sKKwl1NjQgY291bnQ7CisJaW50IHJvdzsKKwor
CWNvdW50ID0gMDsKKwlmb3IgKHJvdyA9IDA7IHJvdyA8IEFSUkFZX1NJWkUoY3J0Yy0+ZGVidWcu
dmJsLnRpbWVzKTsgcm93KyspCisJCWNvdW50ICs9IGNydGMtPmRlYnVnLnZibC50aW1lc1tyb3dd
OworCXNlcV9wcmludGYobSwgIiVzVXBkYXRlczogJWxsdVxuIiwgaGRyLCBjb3VudCk7CisJaWYg
KCFjb3VudCkKKwkJcmV0dXJuOworCisJZm9yIChyb3cgPSAwOyByb3cgPCBBUlJBWV9TSVpFKGNy
dGMtPmRlYnVnLnZibC50aW1lcyk7IHJvdysrKSB7CisJCWNoYXIgY29sdW1uc1s4MF0gPSAiICAg
ICAgIHwiOworCQl1bnNpZ25lZCBpbnQgeDsKKworCQlpZiAocm93ICYgMSkgeworCQkJY29uc3Qg
Y2hhciAqdW5pdHM7CisKKwkJCWlmIChyb3cgPiAxMCkgeworCQkJCXggPSAxMDAwMDAwOworCQkJ
CXVuaXRzID0gIm1zIjsKKwkJCX0gZWxzZSB7CisJCQkJeCA9IDEwMDA7CisJCQkJdW5pdHMgPSAi
dXMiOworCQkJfQorCisJCQlzbnByaW50Zihjb2x1bW5zLCBzaXplb2YoY29sdW1ucyksICIlNGxk
JXMgfCIsCisJCQkJIERJVl9ST1VORF9DTE9TRVNUKEJJVChyb3cgKyA5KSwgeCksIHVuaXRzKTsK
KwkJfQorCisJCWlmIChjcnRjLT5kZWJ1Zy52YmwudGltZXNbcm93XSkgeworCQkJeCA9IGlsb2cy
KGNydGMtPmRlYnVnLnZibC50aW1lc1tyb3ddKTsKKwkJCW1lbXNldChjb2x1bW5zICsgOCwgJyon
LCB4KTsKKwkJCWNvbHVtbnNbOCArIHhdID0gJ1wwJzsKKwkJfQorCisJCXNlcV9wcmludGYobSwg
IiVzJXNcbiIsIGhkciwgY29sdW1ucyk7CisJfQorCisJc2VxX3ByaW50ZihtLCAiJXNNaW4gdXBk
YXRlOiAlbGx1bnNcbiIsCisJCSAgIGhkciwgY3J0Yy0+ZGVidWcudmJsLm1pbik7CisJc2VxX3By
aW50ZihtLCAiJXNNYXggdXBkYXRlOiAlbGx1bnNcbiIsCisJCSAgIGhkciwgY3J0Yy0+ZGVidWcu
dmJsLm1heCk7CisJc2VxX3ByaW50ZihtLCAiJXNBdmVyYWdlIHVwZGF0ZTogJWxsdW5zXG4iLAor
CQkgICBoZHIsIGRpdjY0X3U2NChjcnRjLT5kZWJ1Zy52Ymwuc3VtLCAgY291bnQpKTsKKwlzZXFf
cHJpbnRmKG0sICIlc092ZXJydW5zID4gJXV1czogJXVcbiIsCisJCSAgIGhkciwgVkJMQU5LX0VW
QVNJT05fVElNRV9VUywgY3J0Yy0+ZGVidWcudmJsLm92ZXIpOworfQorCitzdGF0aWMgaW50IGNy
dGNfdXBkYXRlc19zaG93KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKK3sKKwljcnRj
X3VwZGF0ZXNfaW5mbyhtLCBtLT5wcml2YXRlLCAiIik7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRp
YyBpbnQgY3J0Y191cGRhdGVzX29wZW4oc3RydWN0IGlub2RlICppbm9kZSwgc3RydWN0IGZpbGUg
KmZpbGUpCit7CisJcmV0dXJuIHNpbmdsZV9vcGVuKGZpbGUsIGNydGNfdXBkYXRlc19zaG93LCBp
bm9kZS0+aV9wcml2YXRlKTsKK30KKworc3RhdGljIHNzaXplX3QgY3J0Y191cGRhdGVzX3dyaXRl
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgY29uc3QgY2hhciBfX3VzZXIgKnVidWYsCisJCQkJ
ICBzaXplX3QgbGVuLCBsb2ZmX3QgKm9mZnApCit7CisJc3RydWN0IHNlcV9maWxlICptID0gZmls
ZS0+cHJpdmF0ZV9kYXRhOworCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gbS0+cHJpdmF0ZTsK
KworCS8qIE1heSByYWNlIHdpdGggYW4gdXBkYXRlLiBNZWguICovCisJbWVtc2V0KCZjcnRjLT5k
ZWJ1Zy52YmwsIDAsIHNpemVvZihjcnRjLT5kZWJ1Zy52YmwpKTsKKworCXJldHVybiBsZW47Cit9
CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVyYXRpb25zIGNydGNfdXBkYXRlc19mb3Bz
ID0geworCS5vd25lciA9IFRISVNfTU9EVUxFLAorCS5vcGVuID0gY3J0Y191cGRhdGVzX29wZW4s
CisJLnJlYWQgPSBzZXFfcmVhZCwKKwkubGxzZWVrID0gc2VxX2xzZWVrLAorCS5yZWxlYXNlID0g
c2luZ2xlX3JlbGVhc2UsCisJLndyaXRlID0gY3J0Y191cGRhdGVzX3dyaXRlCit9OworCitzdGF0
aWMgdm9pZCBjcnRjX3VwZGF0ZXNfYWRkKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykKK3sKKwlkZWJ1
Z2ZzX2NyZWF0ZV9maWxlKCJpOTE1X3VwZGF0ZV9pbmZvIiwgMDY0NCwgY3J0Yy0+ZGVidWdmc19l
bnRyeSwKKwkJCSAgICB0b19pbnRlbF9jcnRjKGNydGMpLCAmY3J0Y191cGRhdGVzX2ZvcHMpOwor
fQorCisjZWxzZQorc3RhdGljIHZvaWQgY3J0Y191cGRhdGVzX2luZm8oc3RydWN0IHNlcV9maWxl
ICptLAorCQkJICAgICAgc3RydWN0IGludGVsX2NydGMgKmNydGMsCisJCQkgICAgICBjb25zdCBj
aGFyICpoZHIpCit7Cit9CisKK3N0YXRpYyB2b2lkIGNydGNfdXBkYXRlc19hZGQoc3RydWN0IGRy
bV9jcnRjICpjcnRjKQoreworfQorI2VuZGlmCisKIHN0YXRpYyB2b2lkIGludGVsX2NydGNfaW5m
byhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQogewogCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsK
QEAgLTkwNyw2ICsxMDEyLDggQEAgc3RhdGljIHZvaWQgaW50ZWxfY3J0Y19pbmZvKHN0cnVjdCBz
ZXFfZmlsZSAqbSwgc3RydWN0IGludGVsX2NydGMgKmNydGMpCiAJc2VxX3ByaW50ZihtLCAiXHR1
bmRlcnJ1biByZXBvcnRpbmc6IGNwdT0lcyBwY2g9JXNcbiIsCiAJCSAgIHllc25vKCFjcnRjLT5j
cHVfZmlmb191bmRlcnJ1bl9kaXNhYmxlZCksCiAJCSAgIHllc25vKCFjcnRjLT5wY2hfZmlmb191
bmRlcnJ1bl9kaXNhYmxlZCkpOworCisJY3J0Y191cGRhdGVzX2luZm8obSwgY3J0YywgIlx0Iik7
CiB9CiAKIHN0YXRpYyBpbnQgaTkxNV9kaXNwbGF5X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2
b2lkICp1bnVzZWQpCkBAIC0yMjc4LDMgKzIzODUsMjAgQEAgaW50IGludGVsX2Nvbm5lY3Rvcl9k
ZWJ1Z2ZzX2FkZChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQogCiAJcmV0dXJuIDA7
CiB9CisKKy8qKgorICogaW50ZWxfY3J0Y19kZWJ1Z2ZzX2FkZCAtIGFkZCBpOTE1IHNwZWNpZmlj
IGNydGMgZGVidWdmcyBmaWxlcworICogQGNydGM6IHBvaW50ZXIgdG8gYSBkcm1fY3J0YworICoK
KyAqIFJldHVybnMgMCBvbiBzdWNjZXNzLCBuZWdhdGl2ZSBlcnJvciBjb2RlcyBvbiBlcnJvci4K
KyAqCisgKiBGYWlsdXJlIHRvIGFkZCBkZWJ1Z2ZzIGVudHJpZXMgc2hvdWxkIGdlbmVyYWxseSBi
ZSBpZ25vcmVkLgorICovCitpbnQgaW50ZWxfY3J0Y19kZWJ1Z2ZzX2FkZChzdHJ1Y3QgZHJtX2Ny
dGMgKmNydGMpCit7CisJaWYgKCFjcnRjLT5kZWJ1Z2ZzX2VudHJ5KQorCQlyZXR1cm4gLUVOT0RF
VjsKKworCWNydGNfdXBkYXRlc19hZGQoY3J0Yyk7CisJcmV0dXJuIDA7Cit9CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfZGVidWdmcy5oIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X2RlYnVnZnMuaAppbmRl
eCBjOTIyYzE3NDViZmUuLjU1NzkwMWYzZWI5MCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X2RlYnVnZnMuaAorKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfZGVidWdmcy5oCkBAIC03LDE0ICs3LDE3IEBA
CiAjZGVmaW5lIF9fSU5URUxfRElTUExBWV9ERUJVR0ZTX0hfXwogCiBzdHJ1Y3QgZHJtX2Nvbm5l
Y3RvcjsKK3N0cnVjdCBkcm1fY3J0YzsKIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlOwogCiAjaWZk
ZWYgQ09ORklHX0RFQlVHX0ZTCiB2b2lkIGludGVsX2Rpc3BsYXlfZGVidWdmc19yZWdpc3Rlcihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7CiBpbnQgaW50ZWxfY29ubmVjdG9yX2RlYnVn
ZnNfYWRkKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpOworaW50IGludGVsX2NydGNf
ZGVidWdmc19hZGQoc3RydWN0IGRybV9jcnRjICpjcnRjKTsKICNlbHNlCiBzdGF0aWMgaW5saW5l
IHZvaWQgaW50ZWxfZGlzcGxheV9kZWJ1Z2ZzX3JlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KSB7fQogc3RhdGljIGlubGluZSBpbnQgaW50ZWxfY29ubmVjdG9yX2RlYnVnZnNf
YWRkKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpIHsgcmV0dXJuIDA7IH0KK3N0YXRp
YyBpbmxpbmUgaW50IGludGVsX2NydGNfZGVidWdmc19hZGQoc3RydWN0IGRybV9jcnRjICpjcnRj
KSB7IHJldHVybiAwOyB9CiAjZW5kaWYKIAogI2VuZGlmIC8qIF9fSU5URUxfRElTUExBWV9ERUJV
R0ZTX0hfXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9kaXNwbGF5X3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rp
c3BsYXlfdHlwZXMuaAppbmRleCA0OTFlMzU1MDE3NGYuLmQ0MjZkZDMxNDc5ZSAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgKQEAg
LTExODgsNiArMTE4OCwxNSBAQCBzdHJ1Y3QgaW50ZWxfY3J0YyB7CiAJCWt0aW1lX3Qgc3RhcnRf
dmJsX3RpbWU7CiAJCWludCBtaW5fdmJsLCBtYXhfdmJsOwogCQlpbnQgc2NhbmxpbmVfc3RhcnQ7
CisjaWZkZWYgQ09ORklHX0RSTV9JOTE1X0RFQlVHX1ZCTEFOS19FVkFERQorCQlzdHJ1Y3Qgewor
CQkJdTY0IG1pbjsKKwkJCXU2NCBtYXg7CisJCQl1NjQgc3VtOworCQkJdW5zaWduZWQgaW50IG92
ZXI7CisJCQl1bnNpZ25lZCBpbnQgdGltZXNbMTddOyAvKiBbMXVzLCAxNm1zXSAqLworCQl9IHZi
bDsKKyNlbmRpZgogCX0gZGVidWc7CiAKIAkvKiBzY2FsZXJzIGF2YWlsYWJsZSBvbiB0aGlzIGNy
dGMgKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3By
aXRlLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nwcml0ZS5jCmluZGV4
IDAxOWEyZDZkODA3YS4uYjdlMjA4ODE2MDc0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX3Nwcml0ZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfc3ByaXRlLmMKQEAgLTYxLDE0ICs2MSw2IEBAIGludCBpbnRlbF91c2Vjc190
b19zY2FubGluZXMoY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUs
CiAJCQkgICAgMTAwMCAqIGFkanVzdGVkX21vZGUtPmNydGNfaHRvdGFsKTsKIH0KIAotLyogRklY
TUU6IFdlIHNob3VsZCBpbnN0ZWFkIG9ubHkgdGFrZSBzcGlubG9ja3Mgb25jZSBmb3IgdGhlIGVu
dGlyZSB1cGRhdGUKLSAqIGluc3RlYWQgb2Ygb25jZSBwZXIgbW1pby4gKi8KLSNpZiBJU19FTkFC
TEVEKENPTkZJR19QUk9WRV9MT0NLSU5HKQotI2RlZmluZSBWQkxBTktfRVZBU0lPTl9USU1FX1VT
IDI1MAotI2Vsc2UKLSNkZWZpbmUgVkJMQU5LX0VWQVNJT05fVElNRV9VUyAxMDAKLSNlbmRpZgot
CiAvKioKICAqIGludGVsX3BpcGVfdXBkYXRlX3N0YXJ0KCkgLSBzdGFydCB1cGRhdGUgb2YgYSBz
ZXQgb2YgZGlzcGxheSByZWdpc3RlcnMKICAqIEBuZXdfY3J0Y19zdGF0ZTogdGhlIG5ldyBjcnRj
IHN0YXRlCkBAIC0xODcsNiArMTc5LDM2IEBAIHZvaWQgaW50ZWxfcGlwZV91cGRhdGVfc3RhcnQo
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQogCWxvY2FsX2ly
cV9kaXNhYmxlKCk7CiB9CiAKKyNpZiBJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9ERUJVR19W
QkxBTktfRVZBREUpCitzdGF0aWMgdm9pZCBkYmdfdmJsYW5rX2V2YWRlKHN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjLCBrdGltZV90IGVuZCkKK3sKKwl1NjQgZGVsdGEgPSBrdGltZV90b19ucyhrdGlt
ZV9zdWIoZW5kLCBjcnRjLT5kZWJ1Zy5zdGFydF92YmxfdGltZSkpOworCXVuc2lnbmVkIGludCBo
OworCisJaCA9IGlsb2cyKGRlbHRhID4+IDkpOworCWlmIChoID49IEFSUkFZX1NJWkUoY3J0Yy0+
ZGVidWcudmJsLnRpbWVzKSkKKwkJaCA9IEFSUkFZX1NJWkUoY3J0Yy0+ZGVidWcudmJsLnRpbWVz
KSAtIDE7CisJY3J0Yy0+ZGVidWcudmJsLnRpbWVzW2hdKys7CisKKwljcnRjLT5kZWJ1Zy52Ymwu
c3VtICs9IGRlbHRhOworCWlmICghY3J0Yy0+ZGVidWcudmJsLm1pbiB8fCBkZWx0YSA8IGNydGMt
PmRlYnVnLnZibC5taW4pCisJCWNydGMtPmRlYnVnLnZibC5taW4gPSBkZWx0YTsKKwlpZiAoZGVs
dGEgPiBjcnRjLT5kZWJ1Zy52YmwubWF4KQorCQljcnRjLT5kZWJ1Zy52YmwubWF4ID0gZGVsdGE7
CisKKwlpZiAoZGVsdGEgPiAxMDAwICogVkJMQU5LX0VWQVNJT05fVElNRV9VUykgeworCQlkcm1f
ZGJnX2ttcyhjcnRjLT5iYXNlLmRldiwKKwkJCSAgICAiQXRvbWljIHVwZGF0ZSBvbiBwaXBlICgl
YykgdG9vayAlbGxkIHVzLCBtYXggdGltZSB1bmRlciBldmFzaW9uIGlzICV1IHVzXG4iLAorCQkJ
ICAgIHBpcGVfbmFtZShjcnRjLT5waXBlKSwKKwkJCSAgICBkaXZfdTY0KGRlbHRhLCAxMDAwKSwK
KwkJCSAgICBWQkxBTktfRVZBU0lPTl9USU1FX1VTKTsKKwkJY3J0Yy0+ZGVidWcudmJsLm92ZXIr
KzsKKwl9Cit9CisjZWxzZQorc3RhdGljIHZvaWQgZGJnX3ZibGFua19ldmFkZShzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0Yywga3RpbWVfdCBlbmQpIHt9CisjZW5kaWYKKwogLyoqCiAgKiBpbnRlbF9w
aXBlX3VwZGF0ZV9lbmQoKSAtIGVuZCB1cGRhdGUgb2YgYSBzZXQgb2YgZGlzcGxheSByZWdpc3Rl
cnMKICAqIEBuZXdfY3J0Y19zdGF0ZTogdGhlIG5ldyBjcnRjIHN0YXRlCkBAIC0yNDksMTUgKzI3
MSw4IEBAIHZvaWQgaW50ZWxfcGlwZV91cGRhdGVfZW5kKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpuZXdfY3J0Y19zdGF0ZSkKIAkJCWNydGMtPmRlYnVnLm1pbl92YmwsIGNydGMtPmRlYnVnLm1h
eF92YmwsCiAJCQljcnRjLT5kZWJ1Zy5zY2FubGluZV9zdGFydCwgc2NhbmxpbmVfZW5kKTsKIAl9
Ci0jaWZkZWYgQ09ORklHX0RSTV9JOTE1X0RFQlVHX1ZCTEFOS19FVkFERQotCWVsc2UgaWYgKGt0
aW1lX3VzX2RlbHRhKGVuZF92YmxfdGltZSwgY3J0Yy0+ZGVidWcuc3RhcnRfdmJsX3RpbWUpID4K
LQkJIFZCTEFOS19FVkFTSU9OX1RJTUVfVVMpCi0JCWRybV93YXJuKCZkZXZfcHJpdi0+ZHJtLAot
CQkJICJBdG9taWMgdXBkYXRlIG9uIHBpcGUgKCVjKSB0b29rICVsbGQgdXMsIG1heCB0aW1lIHVu
ZGVyIGV2YXNpb24gaXMgJXUgdXNcbiIsCi0JCQkgcGlwZV9uYW1lKHBpcGUpLAotCQkJIGt0aW1l
X3VzX2RlbHRhKGVuZF92YmxfdGltZSwgY3J0Yy0+ZGVidWcuc3RhcnRfdmJsX3RpbWUpLAotCQkJ
IFZCTEFOS19FVkFTSU9OX1RJTUVfVVMpOwotI2VuZGlmCisKKwlkYmdfdmJsYW5rX2V2YWRlKGNy
dGMsIGVuZF92YmxfdGltZSk7CiB9CiAKIGludCBpbnRlbF9wbGFuZV9jaGVja19zdHJpZGUoY29u
c3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3ByaXRlLmggYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nwcml0ZS5oCmluZGV4IGNkMjEwNGJhMWNhMS4uNzYxMjZk
ZDhkNTg0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nw
cml0ZS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3ByaXRlLmgK
QEAgLTE3LDYgKzE3LDE2IEBAIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlOwogc3RydWN0IGludGVs
X2NydGNfc3RhdGU7CiBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGU7CiAKKy8qCisgKiBGSVhNRTog
V2Ugc2hvdWxkIGluc3RlYWQgb25seSB0YWtlIHNwaW5sb2NrcyBvbmNlIGZvciB0aGUgZW50aXJl
IHVwZGF0ZQorICogaW5zdGVhZCBvZiBvbmNlIHBlciBtbWlvLgorICovCisjaWYgSVNfRU5BQkxF
RChDT05GSUdfUFJPVkVfTE9DS0lORykKKyNkZWZpbmUgVkJMQU5LX0VWQVNJT05fVElNRV9VUyAy
NTAKKyNlbHNlCisjZGVmaW5lIFZCTEFOS19FVkFTSU9OX1RJTUVfVVMgMTAwCisjZW5kaWYKKwog
aW50IGludGVsX3VzZWNzX3RvX3NjYW5saW5lcyhjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9k
ZSAqYWRqdXN0ZWRfbW9kZSwKIAkJCSAgICAgaW50IHVzZWNzKTsKIHN0cnVjdCBpbnRlbF9wbGFu
ZSAqaW50ZWxfc3ByaXRlX3BsYW5lX2NyZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCi0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNr
dG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2lu
dGVsLWdmeAo=

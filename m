Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id A1EAFC8D54
	for <lists+intel-gfx@lfdr.de>; Wed,  2 Oct 2019 17:49:42 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id DCC186E25D;
	Wed,  2 Oct 2019 15:49:40 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga02.intel.com (mga02.intel.com [134.134.136.20])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 742F76E25D
 for <intel-gfx@lists.freedesktop.org>; Wed,  2 Oct 2019 15:49:39 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga008.fm.intel.com ([10.253.24.58])
 by orsmga101.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 02 Oct 2019 08:49:38 -0700
X-IronPort-AV: E=Sophos;i="5.67,574,1566889200"; d="scan'208";a="190980216"
Received: from paaron-mobl.ger.corp.intel.com (HELO [10.251.93.134])
 ([10.251.93.134])
 by fmsmga008-auth.fm.intel.com with ESMTP/TLS/AES256-SHA;
 02 Oct 2019 08:49:37 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20191002112000.12280-1-chris@chris-wilson.co.uk>
 <20191002112000.12280-8-chris@chris-wilson.co.uk>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <16005632-0236-f0bb-236a-91a3a5767338@linux.intel.com>
Date: Wed, 2 Oct 2019 16:49:34 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <20191002112000.12280-8-chris@chris-wilson.co.uk>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH 08/30] drm/i915: Coordinate i915_active with
 its own mutex
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDAyLzEwLzIwMTkgMTI6MTksIENocmlzIFdpbHNvbiB3cm90ZToKPiBGb3JnbyB0aGUgc3Ry
dWN0X211dGV4IHNlcmlhbGlzYXRpb24gZm9yIGk5MTVfYWN0aXZlLCBhbmQgaW50ZXJwb3NlIGl0
cwo+IG93biBtdXRleCBoYW5kbGluZyBmb3IgYWN0aXZlL3JldGlyZS4KPiAKPiBUaGlzIGlzIGEg
bXVsdGktbGF5ZXJlZCBzbGVpZ2h0LW9mLWhhbmQuIEZpcnN0LCB3ZSBoYWQgdG8gZW5zdXJlIHRo
YXQgbm8KPiBhY3RpdmUvcmV0aXJlIGNhbGxiYWNrcyBhY2NpZGVudGFsbHkgaW52ZXJ0ZWQgdGhl
IG11dGV4IG9yZGVyaW5nIHJ1bGVzLAo+IG5vciBhc3N1bWVkIHRoYXQgdGhleSB3ZXJlIHRoZW1z
ZWx2ZXMgc2VyaWFsaXNlZCBieSBzdHJ1Y3RfbXV0ZXguIE1vcmUKPiBjaGFsbGVuZ2luZyB0aG91
Z2gsIGlzIHRoZSBydWxlIG92ZXIgdXBkYXRpbmcgZWxlbWVudHMgb2YgdGhlIGFjdGl2ZQo+IHJi
dHJlZS4gSW5zdGVhZCBvZiB0aGUgd2hvbGUgaTkxNV9hY3RpdmUgbm93IGJlaW5nIHNlcmlhbGlz
ZWQgYnkKPiBzdHJ1Y3RfbXV0ZXgsIGFsbG9jYXRpb25zL3JvdGF0aW9ucyBvZiB0aGUgdHJlZSBh
cmUgc2VyaWFsaXNlZCBieSB0aGUKPiBpOTE1X2FjdGl2ZS5tdXRleCBhbmQgaW5kaXZpZHVhbCBu
b2RlcyBhcmUgc2VyaWFsaXNlZCBieSB0aGUgY2FsbGVyCj4gdXNpbmcgdGhlIGk5MTVfdGltZWxp
bmUubXV0ZXggKHdlIG5lZWQgdG8gdXNlIG5lc3RlZCBzcGlubG9ja3MgdG8KPiBpbnRlcmFjdCB3
aXRoIHRoZSBkbWFfZmVuY2UgY2FsbGJhY2sgbGlzdHMpLgo+IAo+IFRoZSBwYWluIHBvaW50IGhl
cmUgaXMgdGhhdCBpbnN0ZWFkIG9mIGEgc2luZ2xlIG11dGV4IGFyb3VuZCBleGVjYnVmLCB3ZQo+
IG5vdyBoYXZlIHRvIHRha2UgYSBtdXRleCBmb3IgYWN0aXZlIHRyYWNrZXIgKG9uZSBmb3IgZWFj
aCB2bWEsIGNvbnRleHQsCj4gZXRjKSBhbmQgYSBjb3VwbGUgb2Ygc3BpbmxvY2tzIGZvciBlYWNo
IGZlbmNlIHVwZGF0ZS4gVGhlIGltcHJvdmVtZW50IGluCj4gZmluZSBncmFpbmVkIGxvY2tpbmcg
YWxsb3dpbmcgZm9yIG11bHRpcGxlIGNvbmN1cnJlbnQgY2xpZW50cwo+IChldmVudHVhbGx5ISkg
c2hvdWxkIGJlIHdvcnRoIGl0IGluIHR5cGljYWwgbG9hZHMuCj4gCj4gdjI6IEFkZCBzb21lIGNv
bW1lbnRzIHRoYXQgYmFyZWx5IGVsdWNpZGF0ZSBhbnl0aGluZyA6KAoKSGVyZSdzIG9uZSByLWIg
d2hpY2ggaXMgYmFyZWx5IHdvcnRoIGFueXRoaW5nIGFzIHdlbGw6IDspCgpSZXZpZXdlZC1ieTog
VHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KClJlZ2FyZHMsCgpUdnJ0
a28KCj4gU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28u
dWs+Cj4gLS0tCj4gICAuLi4vZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZnJvbnRidWZmZXIu
YyAgfCAgIDIgKy0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfb3Zlcmxh
eS5jICB8ICAgMyArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRl
eHQuYyAgIHwgICA0ICstCj4gICAuLi4vZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3Rf
dHlwZXMuaCAgfCAgIDEgKwo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3Bt
LmMgICAgICAgIHwgICA5ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250
ZXh0LmMgICAgICAgfCAgIDQgKy0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2Vu
Z2luZV9wb29sLmMgICB8ICAgMiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
cmVzZXQuYyAgICAgICAgIHwgIDEwICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF90aW1lbGluZS5jICAgICAgfCAgIDcgKy0KPiAgIC4uLi9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
dGltZWxpbmVfdHlwZXMuaCAgICB8ICAgOSArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
c2VsZnRlc3RfY29udGV4dC5jICAgIHwgIDE2ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9zZWxmdGVzdF9scmMuYyAgICAgICAgfCAgMTAgKy0KPiAgIC4uLi9ncHUvZHJtL2k5MTUvZ3Qv
c2VsZnRlc3RzL21vY2tfdGltZWxpbmUuYyB8ICAgMiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Z0L3NjaGVkdWxlci5jICAgICAgICAgIHwgICAzIC0KPiAgIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfYWN0aXZlLmMgICAgICAgICAgICB8IDMyMiArKysrKysrKystLS0tLS0tLS0KPiAg
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmggICAgICAgICAgICB8IDMxOSArKysr
LS0tLS0tLS0tLS0tLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmVfdHlwZXMu
aCAgICAgIHwgIDIzICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jICAgICAg
ICAgICAgICAgfCAgNDIgKystCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQu
YyAgICAgICAgICAgfCAgIDMgKy0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vy
cm9yLmMgICAgICAgICB8ICAgNCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1
ZXN0LmMgICAgICAgICAgIHwgIDM4ICstLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9y
ZXF1ZXN0LmggICAgICAgICAgIHwgICAxIC0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
dm1hLmMgICAgICAgICAgICAgICB8ICAgNCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvc2Vs
ZnRlc3RzL2k5MTVfYWN0aXZlLmMgIHwgIDMyICstCj4gICAyNCBmaWxlcyBjaGFuZ2VkLCAyOTgg
aW5zZXJ0aW9ucygrKSwgNTcyIGRlbGV0aW9ucygtKQo+IAo+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Zyb250YnVmZmVyLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2Zyb250YnVmZmVyLmMKPiBpbmRleCA2NDI4YjhkZDcwZDMu
Ljg0YjE2NGYzMTg5NSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2Zyb250YnVmZmVyLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2Zyb250YnVmZmVyLmMKPiBAQCAtMjU3LDcgKzI1Nyw3IEBAIGludGVsX2Zyb250YnVm
ZmVyX2dldChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQo+ICAgCWZyb250LT5vYmog
PSBvYmo7Cj4gICAJa3JlZl9pbml0KCZmcm9udC0+cmVmKTsKPiAgIAlhdG9taWNfc2V0KCZmcm9u
dC0+Yml0cywgMCk7Cj4gLQlpOTE1X2FjdGl2ZV9pbml0KGk5MTUsICZmcm9udC0+d3JpdGUsCj4g
KwlpOTE1X2FjdGl2ZV9pbml0KCZmcm9udC0+d3JpdGUsCj4gICAJCQkgZnJvbnRidWZmZXJfYWN0
aXZlLAo+ICAgCQkJIGk5MTVfYWN0aXZlX21heV9zbGVlcChmcm9udGJ1ZmZlcl9yZXRpcmUpKTsK
PiAgIAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX292
ZXJsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfb3ZlcmxheS5jCj4g
aW5kZXggM2Y0YWMxZWU3NjY4Li5lMTJlMWE3NTNhZjAgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9vdmVybGF5LmMKPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX292ZXJsYXkuYwo+IEBAIC0xMzYwLDggKzEzNjAsNyBAQCB2
b2lkIGludGVsX292ZXJsYXlfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ICAgCW92ZXJsYXktPmNvbnRyYXN0ID0gNzU7Cj4gICAJb3ZlcmxheS0+c2F0dXJhdGlvbiA9
IDE0NjsKPiAgIAo+IC0JaTkxNV9hY3RpdmVfaW5pdChkZXZfcHJpdiwKPiAtCQkJICZvdmVybGF5
LT5sYXN0X2ZsaXAsCj4gKwlpOTE1X2FjdGl2ZV9pbml0KCZvdmVybGF5LT5sYXN0X2ZsaXAsCj4g
ICAJCQkgTlVMTCwgaW50ZWxfb3ZlcmxheV9sYXN0X2ZsaXBfcmV0aXJlKTsKPiAgIAo+ICAgCXJl
dCA9IGdldF9yZWdpc3RlcnMob3ZlcmxheSwgT1ZFUkxBWV9ORUVEU19QSFlTSUNBTChkZXZfcHJp
dikpOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29u
dGV4dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYwo+IGlu
ZGV4IDRjZDdkMmVjZjFkNS4uOWQ4NWFhYjY4ZDM0IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCj4gQEAgLTg2OCwyMCArODY4LDE4IEBAIHN0YXRp
YyBpbnQgY29udGV4dF9iYXJyaWVyX3Rhc2soc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwK
PiAgIAkJCQl2b2lkICgqdGFzaykodm9pZCAqZGF0YSksCj4gICAJCQkJdm9pZCAqZGF0YSkKPiAg
IHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gY3R4LT5pOTE1Owo+ICAgCXN0
cnVjdCBjb250ZXh0X2JhcnJpZXJfdGFzayAqY2I7Cj4gICAJc3RydWN0IGk5MTVfZ2VtX2VuZ2lu
ZXNfaXRlciBpdDsKPiAgIAlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7Cj4gICAJaW50IGVyciA9
IDA7Cj4gICAKPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgp
Owo+ICAgCUdFTV9CVUdfT04oIXRhc2spOwo+ICAgCj4gICAJY2IgPSBrbWFsbG9jKHNpemVvZigq
Y2IpLCBHRlBfS0VSTkVMKTsKPiAgIAlpZiAoIWNiKQo+ICAgCQlyZXR1cm4gLUVOT01FTTsKPiAg
IAo+IC0JaTkxNV9hY3RpdmVfaW5pdChpOTE1LCAmY2ItPmJhc2UsIE5VTEwsIGNiX3JldGlyZSk7
Cj4gKwlpOTE1X2FjdGl2ZV9pbml0KCZjYi0+YmFzZSwgTlVMTCwgY2JfcmV0aXJlKTsKPiAgIAll
cnIgPSBpOTE1X2FjdGl2ZV9hY3F1aXJlKCZjYi0+YmFzZSk7Cj4gICAJaWYgKGVycikgewo+ICAg
CQlrZnJlZShjYik7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV9vYmplY3RfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9v
YmplY3RfdHlwZXMuaAo+IGluZGV4IGUxYWFiMmZkMWNkOS4uYzAwYjRmMDc3ZjllIDEwMDY0NAo+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaAo+
ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaAo+
IEBAIC04LDYgKzgsNyBAQAo+ICAgI2RlZmluZSBfX0k5MTVfR0VNX09CSkVDVF9UWVBFU19IX18K
PiAgIAo+ICAgI2luY2x1ZGUgPGRybS9kcm1fZ2VtLmg+Cj4gKyNpbmNsdWRlIDx1YXBpL2RybS9p
OTE1X2RybS5oPgo+ICAgCj4gICAjaW5jbHVkZSAiaTkxNV9hY3RpdmUuaCIKPiAgICNpbmNsdWRl
ICJpOTE1X3NlbGZ0ZXN0LmgiCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMK
PiBpbmRleCBjY2ExOTJlY2ZmOGIuLjBhNDExNWM2YzI3NSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9wbS5jCj4gQEAgLTE2LDE0ICsxNiwxMSBAQCBzdGF0aWMgdm9pZCBj
YWxsX2lkbGVfYmFycmllcnMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+ICAgCXN0
cnVjdCBsbGlzdF9ub2RlICpub2RlLCAqbmV4dDsKPiAgIAo+ICAgCWxsaXN0X2Zvcl9lYWNoX3Nh
ZmUobm9kZSwgbmV4dCwgbGxpc3RfZGVsX2FsbCgmZW5naW5lLT5iYXJyaWVyX3Rhc2tzKSkgewo+
IC0JCXN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUgPQo+ICsJCXN0cnVjdCBkbWFf
ZmVuY2VfY2IgKmNiID0KPiAgIAkJCWNvbnRhaW5lcl9vZigoc3RydWN0IGxpc3RfaGVhZCAqKW5v
ZGUsCj4gLQkJCQkgICAgIHR5cGVvZigqYWN0aXZlKSwgbGluayk7Cj4gKwkJCQkgICAgIHR5cGVv
ZigqY2IpLCBub2RlKTsKPiAgIAo+IC0JCUlOSVRfTElTVF9IRUFEKCZhY3RpdmUtPmxpbmspOwo+
IC0JCVJDVV9JTklUX1BPSU5URVIoYWN0aXZlLT5yZXF1ZXN0LCBOVUxMKTsKPiAtCj4gLQkJYWN0
aXZlLT5yZXRpcmUoYWN0aXZlLCBOVUxMKTsKPiArCQljYi0+ZnVuYyhOVUxMLCBjYik7Cj4gICAJ
fQo+ICAgfQo+ICAgCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYwo+IGlu
ZGV4IDA2ZmFiZGYyMDVjZi4uMzVhNDBjMjgyMGEyIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2NvbnRleHQuYwo+IEBAIC0yNDAsNyArMjQwLDcgQEAgaW50ZWxfY29udGV4dF9p
bml0KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKPiAgIAo+ICAgCW11dGV4X2luaXQoJmNlLT5w
aW5fbXV0ZXgpOwo+ICAgCj4gLQlpOTE1X2FjdGl2ZV9pbml0KGN0eC0+aTkxNSwgJmNlLT5hY3Rp
dmUsCj4gKwlpOTE1X2FjdGl2ZV9pbml0KCZjZS0+YWN0aXZlLAo+ICAgCQkJIF9faW50ZWxfY29u
dGV4dF9hY3RpdmUsIF9faW50ZWxfY29udGV4dF9yZXRpcmUpOwo+ICAgfQo+ICAgCj4gQEAgLTMw
Nyw3ICszMDcsNyBAQCBpbnQgaW50ZWxfY29udGV4dF9wcmVwYXJlX3JlbW90ZV9yZXF1ZXN0KHN0
cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKPiAgIAkJCXJldHVybiBlcnI7Cj4gICAKPiAgIAkJLyog
UXVldWUgdGhpcyBzd2l0Y2ggYWZ0ZXIgY3VycmVudCBhY3Rpdml0eSBieSB0aGlzIGNvbnRleHQu
ICovCj4gLQkJZXJyID0gaTkxNV9hY3RpdmVfcmVxdWVzdF9zZXQoJnRsLT5sYXN0X3JlcXVlc3Qs
IHJxKTsKPiArCQllcnIgPSBpOTE1X2FjdGl2ZV9mZW5jZV9zZXQoJnRsLT5sYXN0X3JlcXVlc3Qs
IHJxKTsKPiAgIAkJbXV0ZXhfdW5sb2NrKCZ0bC0+bXV0ZXgpOwo+ICAgCQlpZiAoZXJyKQo+ICAg
CQkJcmV0dXJuIGVycjsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZW5naW5lX3Bvb2wuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9w
b29sLmMKPiBpbmRleCA4MWZhYjEwMWZkYjQuLjNjZGJkNWY4YjViZSAxMDA2NDQKPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG9vbC5jCj4gKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bvb2wuYwo+IEBAIC05NSw3ICs5NSw3IEBA
IG5vZGVfY3JlYXRlKHN0cnVjdCBpbnRlbF9lbmdpbmVfcG9vbCAqcG9vbCwgc2l6ZV90IHN6KQo+
ICAgCQlyZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKPiAgIAo+ICAgCW5vZGUtPnBvb2wgPSBwb29s
Owo+IC0JaTkxNV9hY3RpdmVfaW5pdChlbmdpbmUtPmk5MTUsICZub2RlLT5hY3RpdmUsIHBvb2xf
YWN0aXZlLCBwb29sX3JldGlyZSk7Cj4gKwlpOTE1X2FjdGl2ZV9pbml0KCZub2RlLT5hY3RpdmUs
IHBvb2xfYWN0aXZlLCBwb29sX3JldGlyZSk7Cj4gICAKPiAgIAlvYmogPSBpOTE1X2dlbV9vYmpl
Y3RfY3JlYXRlX2ludGVybmFsKGVuZ2luZS0+aTkxNSwgc3opOwo+ICAgCWlmIChJU19FUlIob2Jq
KSkgewo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwo+IGluZGV4IGUxODk4OTdl
ODc5Ny4uMDU1NDk2ZjA4MjVmIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX3Jlc2V0LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNl
dC5jCj4gQEAgLTg0NCwxMCArODQ0LDEwIEBAIHN0YXRpYyBib29sIF9faW50ZWxfZ3RfdW5zZXRf
d2VkZ2VkKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCj4gICAJICovCj4gICAJc3Bpbl9sb2NrX2lycXNh
dmUoJnRpbWVsaW5lcy0+bG9jaywgZmxhZ3MpOwo+ICAgCWxpc3RfZm9yX2VhY2hfZW50cnkodGws
ICZ0aW1lbGluZXMtPmFjdGl2ZV9saXN0LCBsaW5rKSB7Cj4gLQkJc3RydWN0IGk5MTVfcmVxdWVz
dCAqcnE7Cj4gKwkJc3RydWN0IGRtYV9mZW5jZSAqZmVuY2U7Cj4gICAKPiAtCQlycSA9IGk5MTVf
YWN0aXZlX3JlcXVlc3RfZ2V0X3VubG9ja2VkKCZ0bC0+bGFzdF9yZXF1ZXN0KTsKPiAtCQlpZiAo
IXJxKQo+ICsJCWZlbmNlID0gaTkxNV9hY3RpdmVfZmVuY2VfZ2V0KCZ0bC0+bGFzdF9yZXF1ZXN0
KTsKPiArCQlpZiAoIWZlbmNlKQo+ICAgCQkJY29udGludWU7Cj4gICAKPiAgIAkJc3Bpbl91bmxv
Y2tfaXJxcmVzdG9yZSgmdGltZWxpbmVzLT5sb2NrLCBmbGFncyk7Cj4gQEAgLTg1OSw4ICs4NTks
OCBAQCBzdGF0aWMgYm9vbCBfX2ludGVsX2d0X3Vuc2V0X3dlZGdlZChzdHJ1Y3QgaW50ZWxfZ3Qg
Kmd0KQo+ICAgCQkgKiAoSTkxNV9GRU5DRV9USU1FT1VUKSBzbyB0aGlzIHdhaXQgc2hvdWxkIG5v
dCBiZSB1bmJvdW5kZWQKPiAgIAkJICogaW4gdGhlIHdvcnN0IGNhc2UuCj4gICAJCSAqLwo+IC0J
CWRtYV9mZW5jZV9kZWZhdWx0X3dhaXQoJnJxLT5mZW5jZSwgZmFsc2UsIE1BWF9TQ0hFRFVMRV9U
SU1FT1VUKTsKPiAtCQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKPiArCQlkbWFfZmVuY2VfZGVmYXVs
dF93YWl0KGZlbmNlLCBmYWxzZSwgTUFYX1NDSEVEVUxFX1RJTUVPVVQpOwo+ICsJCWRtYV9mZW5j
ZV9wdXQoZmVuY2UpOwo+ICAgCj4gICAJCS8qIFJlc3RhcnQgaXRlcmF0aW9uIGFmdGVyIGRyb3Bp
bmcgbG9jayAqLwo+ICAgCQlzcGluX2xvY2tfaXJxc2F2ZSgmdGltZWxpbmVzLT5sb2NrLCBmbGFn
cyk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3RpbWVsaW5l
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF90aW1lbGluZS5jCj4gaW5kZXggNjUz
ZjYwZTc4MzkyLi4wZjk1OTY5NDMwM2MgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfdGltZWxpbmUuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX3RpbWVsaW5lLmMKPiBAQCAtMTc4LDggKzE3OCw3IEBAIGNhY2hlbGluZV9hbGxvYyhzdHJ1
Y3QgaW50ZWxfdGltZWxpbmVfaHdzcCAqaHdzcCwgdW5zaWduZWQgaW50IGNhY2hlbGluZSkKPiAg
IAljbC0+aHdzcCA9IGh3c3A7Cj4gICAJY2wtPnZhZGRyID0gcGFnZV9wYWNrX2JpdHModmFkZHIs
IGNhY2hlbGluZSk7Cj4gICAKPiAtCWk5MTVfYWN0aXZlX2luaXQoaHdzcC0+Z3QtPmk5MTUsICZj
bC0+YWN0aXZlLAo+IC0JCQkgX19jYWNoZWxpbmVfYWN0aXZlLCBfX2NhY2hlbGluZV9yZXRpcmUp
Owo+ICsJaTkxNV9hY3RpdmVfaW5pdCgmY2wtPmFjdGl2ZSwgX19jYWNoZWxpbmVfYWN0aXZlLCBf
X2NhY2hlbGluZV9yZXRpcmUpOwo+ICAgCj4gICAJcmV0dXJuIGNsOwo+ICAgfQo+IEBAIC0yNTUs
NyArMjU0LDcgQEAgaW50IGludGVsX3RpbWVsaW5lX2luaXQoc3RydWN0IGludGVsX3RpbWVsaW5l
ICp0aW1lbGluZSwKPiAgIAo+ICAgCW11dGV4X2luaXQoJnRpbWVsaW5lLT5tdXRleCk7Cj4gICAK
PiAtCUlOSVRfQUNUSVZFX1JFUVVFU1QoJnRpbWVsaW5lLT5sYXN0X3JlcXVlc3QsICZ0aW1lbGlu
ZS0+bXV0ZXgpOwo+ICsJSU5JVF9BQ1RJVkVfRkVOQ0UoJnRpbWVsaW5lLT5sYXN0X3JlcXVlc3Qs
ICZ0aW1lbGluZS0+bXV0ZXgpOwo+ICAgCUlOSVRfTElTVF9IRUFEKCZ0aW1lbGluZS0+cmVxdWVz
dHMpOwo+ICAgCj4gICAJaTkxNV9zeW5jbWFwX2luaXQoJnRpbWVsaW5lLT5zeW5jKTsKPiBAQCAt
NDQzLDcgKzQ0Miw3IEBAIF9faW50ZWxfdGltZWxpbmVfZ2V0X3NlcW5vKHN0cnVjdCBpbnRlbF90
aW1lbGluZSAqdGwsCj4gICAJICogZnJlZSBpdCBhZnRlciB0aGUgY3VycmVudCByZXF1ZXN0IGlz
IHJldGlyZWQsIHdoaWNoIGVuc3VyZXMgdGhhdAo+ICAgCSAqIGFsbCB3cml0ZXMgaW50byB0aGUg
Y2FjaGVsaW5lIGZyb20gcHJldmlvdXMgcmVxdWVzdHMgYXJlIGNvbXBsZXRlLgo+ICAgCSAqLwo+
IC0JZXJyID0gaTkxNV9hY3RpdmVfcmVmKCZ0bC0+aHdzcF9jYWNoZWxpbmUtPmFjdGl2ZSwgdGws
IHJxKTsKPiArCWVyciA9IGk5MTVfYWN0aXZlX3JlZigmdGwtPmh3c3BfY2FjaGVsaW5lLT5hY3Rp
dmUsIHRsLCAmcnEtPmZlbmNlKTsKPiAgIAlpZiAoZXJyKQo+ICAgCQlnb3RvIGVycl9jYWNoZWxp
bmU7Cj4gICAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfdGlt
ZWxpbmVfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3RpbWVsaW5lX3R5
cGVzLmgKPiBpbmRleCBjNjY4YzRjNTBlNzUuLjk4ZDllZTE2NjM3OSAxMDA2NDQKPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF90aW1lbGluZV90eXBlcy5oCj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfdGltZWxpbmVfdHlwZXMuaAo+IEBAIC01OCwxMiAr
NTgsMTMgQEAgc3RydWN0IGludGVsX3RpbWVsaW5lIHsKPiAgIAkgKi8KPiAgIAlzdHJ1Y3QgbGlz
dF9oZWFkIHJlcXVlc3RzOwo+ICAgCj4gLQkvKiBDb250YWlucyBhbiBSQ1UgZ3VhcmRlZCBwb2lu
dGVyIHRvIHRoZSBsYXN0IHJlcXVlc3QuIE5vIHJlZmVyZW5jZSBpcwo+ICsJLyoKPiArCSAqIENv
bnRhaW5zIGFuIFJDVSBndWFyZGVkIHBvaW50ZXIgdG8gdGhlIGxhc3QgcmVxdWVzdC4gTm8gcmVm
ZXJlbmNlIGlzCj4gICAJICogaGVsZCB0byB0aGUgcmVxdWVzdCwgdXNlcnMgbXVzdCBjYXJlZnVs
bHkgYWNxdWlyZSBhIHJlZmVyZW5jZSB0bwo+IC0JICogdGhlIHJlcXVlc3QgdXNpbmcgaTkxNV9h
Y3RpdmVfcmVxdWVzdF9nZXRfcmVxdWVzdF9yY3UoKSwgb3IgaG9sZCB0aGUKPiAtCSAqIHN0cnVj
dF9tdXRleC4KPiArCSAqIHRoZSByZXF1ZXN0IHVzaW5nIGk5MTVfYWN0aXZlX2ZlbmNlX2dldCgp
LCBvciBtYW5hZ2UgdGhlIFJDVQo+ICsJICogcHJvdGVjdGlvbiB0aGVtc2VsdmVzIChjZiB0aGUg
aTkxNV9hY3RpdmVfZmVuY2UgQVBJKS4KPiAgIAkgKi8KPiAtCXN0cnVjdCBpOTE1X2FjdGl2ZV9y
ZXF1ZXN0IGxhc3RfcmVxdWVzdDsKPiArCXN0cnVjdCBpOTE1X2FjdGl2ZV9mZW5jZSBsYXN0X3Jl
cXVlc3Q7Cj4gICAKPiAgIAkvKioKPiAgIAkgKiBXZSB0cmFjayB0aGUgbW9zdCByZWNlbnQgc2Vx
bm8gdGhhdCB3ZSB3YWl0IG9uIGluIGV2ZXJ5IGNvbnRleHQgc28KPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfY29udGV4dC5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Qvc2VsZnRlc3RfY29udGV4dC5jCj4gaW5kZXggNGNlMWUyNTQzM2QyLi5lNmJjYmU3
YWI1ZTEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfY29u
dGV4dC5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfY29udGV4dC5j
Cj4gQEAgLTQ3LDI0ICs0NywyMCBAQCBzdGF0aWMgaW50IGNvbnRleHRfc3luYyhzdHJ1Y3QgaW50
ZWxfY29udGV4dCAqY2UpCj4gICAKPiAgIAltdXRleF9sb2NrKCZ0bC0+bXV0ZXgpOwo+ICAgCWRv
IHsKPiAtCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKPiArCQlzdHJ1Y3QgZG1hX2ZlbmNlICpm
ZW5jZTsKPiAgIAkJbG9uZyB0aW1lb3V0Owo+ICAgCj4gLQkJcmN1X3JlYWRfbG9jaygpOwo+IC0J
CXJxID0gcmN1X2RlcmVmZXJlbmNlKHRsLT5sYXN0X3JlcXVlc3QucmVxdWVzdCk7Cj4gLQkJaWYg
KHJxKQo+IC0JCQlycSA9IGk5MTVfcmVxdWVzdF9nZXRfcmN1KHJxKTsKPiAtCQlyY3VfcmVhZF91
bmxvY2soKTsKPiAtCQlpZiAoIXJxKQo+ICsJCWZlbmNlID0gaTkxNV9hY3RpdmVfZmVuY2VfZ2V0
KCZ0bC0+bGFzdF9yZXF1ZXN0KTsKPiArCQlpZiAoIWZlbmNlKQo+ICAgCQkJYnJlYWs7Cj4gICAK
PiAtCQl0aW1lb3V0ID0gaTkxNV9yZXF1ZXN0X3dhaXQocnEsIDAsIEhaIC8gMTApOwo+ICsJCXRp
bWVvdXQgPSBkbWFfZmVuY2Vfd2FpdF90aW1lb3V0KGZlbmNlLCBmYWxzZSwgSFogLyAxMCk7Cj4g
ICAJCWlmICh0aW1lb3V0IDwgMCkKPiAgIAkJCWVyciA9IHRpbWVvdXQ7Cj4gICAJCWVsc2UKPiAt
CQkJaTkxNV9yZXF1ZXN0X3JldGlyZV91cHRvKHJxKTsKPiArCQkJaTkxNV9yZXF1ZXN0X3JldGly
ZV91cHRvKHRvX3JlcXVlc3QoZmVuY2UpKTsKPiAgIAo+IC0JCWk5MTVfcmVxdWVzdF9wdXQocnEp
Owo+ICsJCWRtYV9mZW5jZV9wdXQoZmVuY2UpOwo+ICAgCX0gd2hpbGUgKCFlcnIpOwo+ICAgCW11
dGV4X3VubG9jaygmdGwtPm11dGV4KTsKPiAgIAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0
ZXN0X2xyYy5jCj4gaW5kZXggMmRhNGZhNTE0OWNiLi4wMWQ1YTI2YjlhYTcgMTAwNjQ0Cj4gLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKPiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwo+IEBAIC0xMTc2LDkgKzExNzYsMTMgQEAg
c3RhdGljIHN0cnVjdCBpOTE1X3JlcXVlc3QgKmR1bW15X3JlcXVlc3Qoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQo+ICAgCWlmICghcnEpCj4gICAJCXJldHVybiBOVUxMOwo+ICAgCj4g
LQlJTklUX0xJU1RfSEVBRCgmcnEtPmFjdGl2ZV9saXN0KTsKPiAgIAlycS0+ZW5naW5lID0gZW5n
aW5lOwo+ICAgCj4gKwlzcGluX2xvY2tfaW5pdCgmcnEtPmxvY2spOwo+ICsJSU5JVF9MSVNUX0hF
QUQoJnJxLT5mZW5jZS5jYl9saXN0KTsKPiArCXJxLT5mZW5jZS5sb2NrID0gJnJxLT5sb2NrOwo+
ICsJcnEtPmZlbmNlLm9wcyA9ICZpOTE1X2ZlbmNlX29wczsKPiArCj4gICAJaTkxNV9zY2hlZF9u
b2RlX2luaXQoJnJxLT5zY2hlZCk7Cj4gICAKPiAgIAkvKiBtYXJrIHRoaXMgcmVxdWVzdCBhcyBw
ZXJtYW5lbnRseSBpbmNvbXBsZXRlICovCj4gQEAgLTEyNzEsOCArMTI3NSw4IEBAIHN0YXRpYyBp
bnQgbGl2ZV9zdXBwcmVzc193YWl0X3ByZWVtcHQodm9pZCAqYXJnKQo+ICAgCQkJCX0KPiAgIAo+
ICAgCQkJCS8qIERpc2FibGUgTkVXQ0xJRU5UIHByb21vdGlvbiAqLwo+IC0JCQkJX19pOTE1X2Fj
dGl2ZV9yZXF1ZXN0X3NldCgmaTkxNV9yZXF1ZXN0X3RpbWVsaW5lKHJxW2ldKS0+bGFzdF9yZXF1
ZXN0LAo+IC0JCQkJCQkJICBkdW1teSk7Cj4gKwkJCQlfX2k5MTVfYWN0aXZlX2ZlbmNlX3NldCgm
aTkxNV9yZXF1ZXN0X3RpbWVsaW5lKHJxW2ldKS0+bGFzdF9yZXF1ZXN0LAo+ICsJCQkJCQkJJmR1
bW15LT5mZW5jZSk7Cj4gICAJCQkJaTkxNV9yZXF1ZXN0X2FkZChycVtpXSk7Cj4gICAJCQl9Cj4g
ICAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RzL21vY2tf
dGltZWxpbmUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0cy9tb2NrX3RpbWVs
aW5lLmMKPiBpbmRleCA1OTgxNzBlZmNhZjYuLjJhNzdjMDUxZjM2YSAxMDA2NDQKPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdHMvbW9ja190aW1lbGluZS5jCj4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RzL21vY2tfdGltZWxpbmUuYwo+IEBAIC0x
NSw3ICsxNSw3IEBAIHZvaWQgbW9ja190aW1lbGluZV9pbml0KHN0cnVjdCBpbnRlbF90aW1lbGlu
ZSAqdGltZWxpbmUsIHU2NCBjb250ZXh0KQo+ICAgCj4gICAJbXV0ZXhfaW5pdCgmdGltZWxpbmUt
Pm11dGV4KTsKPiAgIAo+IC0JSU5JVF9BQ1RJVkVfUkVRVUVTVCgmdGltZWxpbmUtPmxhc3RfcmVx
dWVzdCwgJnRpbWVsaW5lLT5tdXRleCk7Cj4gKwlJTklUX0FDVElWRV9GRU5DRSgmdGltZWxpbmUt
Pmxhc3RfcmVxdWVzdCwgJnRpbWVsaW5lLT5tdXRleCk7Cj4gICAJSU5JVF9MSVNUX0hFQUQoJnRp
bWVsaW5lLT5yZXF1ZXN0cyk7Cj4gICAKPiAgIAlpOTE1X3N5bmNtYXBfaW5pdCgmdGltZWxpbmUt
PnN5bmMpOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVy
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMKPiBpbmRleCA2Yzc5ZDE2
YjM4MWUuLjAzZjU2NzA4NDU0OCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dnQvc2NoZWR1bGVyLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVy
LmMKPiBAQCAtMzg1LDExICszODUsOCBAQCBpbnRlbF9ndnRfd29ya2xvYWRfcmVxX2FsbG9jKHN0
cnVjdCBpbnRlbF92Z3B1X3dvcmtsb2FkICp3b3JrbG9hZCkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50
ZWxfdmdwdSAqdmdwdSA9IHdvcmtsb2FkLT52Z3B1Owo+ICAgCXN0cnVjdCBpbnRlbF92Z3B1X3N1
Ym1pc3Npb24gKnMgPSAmdmdwdS0+c3VibWlzc2lvbjsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHZncHUtPmd2dC0+ZGV2X3ByaXY7Cj4gICAJc3RydWN0IGk5MTVfcmVx
dWVzdCAqcnE7Cj4gICAKPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5kcm0uc3Ry
dWN0X211dGV4KTsKPiAtCj4gICAJaWYgKHdvcmtsb2FkLT5yZXEpCj4gICAJCXJldHVybiAwOwo+
ICAgCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5jCj4gaW5kZXggN2NhMDY2Njg4Yjk4Li4w
MjM2NTJkZWQ0YmUgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3Rp
dmUuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMKPiBAQCAtMTIs
OCArMTIsNiBAQAo+ICAgI2luY2x1ZGUgImk5MTVfYWN0aXZlLmgiCj4gICAjaW5jbHVkZSAiaTkx
NV9nbG9iYWxzLmgiCj4gICAKPiAtI2RlZmluZSBCS0wocmVmKSAoJihyZWYpLT5pOTE1LT5kcm0u
c3RydWN0X211dGV4KQo+IC0KPiAgIC8qCj4gICAgKiBBY3RpdmUgcmVmcyBtZW1vcnkgbWFuYWdl
bWVudAo+ICAgICoKPiBAQCAtMjcsMzUgKzI1LDM1IEBAIHN0YXRpYyBzdHJ1Y3QgaTkxNV9nbG9i
YWxfYWN0aXZlIHsKPiAgIH0gZ2xvYmFsOwo+ICAgCj4gICBzdHJ1Y3QgYWN0aXZlX25vZGUgewo+
IC0Jc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgYmFzZTsKPiArCXN0cnVjdCBpOTE1X2FjdGl2
ZV9mZW5jZSBiYXNlOwo+ICAgCXN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmOwo+ICAgCXN0cnVjdCBy
Yl9ub2RlIG5vZGU7Cj4gICAJdTY0IHRpbWVsaW5lOwo+ICAgfTsKPiAgIAo+ICAgc3RhdGljIGlu
bGluZSBzdHJ1Y3QgYWN0aXZlX25vZGUgKgo+IC1ub2RlX2Zyb21fYWN0aXZlKHN0cnVjdCBpOTE1
X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUpCj4gK25vZGVfZnJvbV9hY3RpdmUoc3RydWN0IGk5MTVf
YWN0aXZlX2ZlbmNlICphY3RpdmUpCj4gICB7Cj4gICAJcmV0dXJuIGNvbnRhaW5lcl9vZihhY3Rp
dmUsIHN0cnVjdCBhY3RpdmVfbm9kZSwgYmFzZSk7Cj4gICB9Cj4gICAKPiAgICNkZWZpbmUgdGFr
ZV9wcmVhbGxvY2F0ZWRfYmFycmllcnMoeCkgbGxpc3RfZGVsX2FsbCgmKHgpLT5wcmVhbGxvY2F0
ZWRfYmFycmllcnMpCj4gICAKPiAtc3RhdGljIGlubGluZSBib29sIGlzX2JhcnJpZXIoY29uc3Qg
c3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2ZSkKPiArc3RhdGljIGlubGluZSBib29s
IGlzX2JhcnJpZXIoY29uc3Qgc3RydWN0IGk5MTVfYWN0aXZlX2ZlbmNlICphY3RpdmUpCj4gICB7
Cj4gLQlyZXR1cm4gSVNfRVJSKHJjdV9hY2Nlc3NfcG9pbnRlcihhY3RpdmUtPnJlcXVlc3QpKTsK
PiArCXJldHVybiBJU19FUlIocmN1X2FjY2Vzc19wb2ludGVyKGFjdGl2ZS0+ZmVuY2UpKTsKPiAg
IH0KPiAgIAo+ICAgc3RhdGljIGlubGluZSBzdHJ1Y3QgbGxpc3Rfbm9kZSAqYmFycmllcl90b19s
bChzdHJ1Y3QgYWN0aXZlX25vZGUgKm5vZGUpCj4gICB7Cj4gICAJR0VNX0JVR19PTighaXNfYmFy
cmllcigmbm9kZS0+YmFzZSkpOwo+IC0JcmV0dXJuIChzdHJ1Y3QgbGxpc3Rfbm9kZSAqKSZub2Rl
LT5iYXNlLmxpbms7Cj4gKwlyZXR1cm4gKHN0cnVjdCBsbGlzdF9ub2RlICopJm5vZGUtPmJhc2Uu
Y2Iubm9kZTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGlubGluZSBzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICoKPiAgIF9fYmFycmllcl90b19lbmdpbmUoc3RydWN0IGFjdGl2ZV9ub2RlICpub2RlKQo+
ICAgewo+IC0JcmV0dXJuIChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICopUkVBRF9PTkNFKG5vZGUt
PmJhc2UubGluay5wcmV2KTsKPiArCXJldHVybiAoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqKVJF
QURfT05DRShub2RlLT5iYXNlLmNiLm5vZGUucHJldik7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBp
bmxpbmUgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqCj4gQEAgLTY4LDcgKzY2LDcgQEAgYmFycmll
cl90b19lbmdpbmUoc3RydWN0IGFjdGl2ZV9ub2RlICpub2RlKQo+ICAgc3RhdGljIGlubGluZSBz
dHJ1Y3QgYWN0aXZlX25vZGUgKmJhcnJpZXJfZnJvbV9sbChzdHJ1Y3QgbGxpc3Rfbm9kZSAqeCkK
PiAgIHsKPiAgIAlyZXR1cm4gY29udGFpbmVyX29mKChzdHJ1Y3QgbGlzdF9oZWFkICopeCwKPiAt
CQkJICAgIHN0cnVjdCBhY3RpdmVfbm9kZSwgYmFzZS5saW5rKTsKPiArCQkJICAgIHN0cnVjdCBh
Y3RpdmVfbm9kZSwgYmFzZS5jYi5ub2RlKTsKPiAgIH0KPiAgIAo+ICAgI2lmIElTX0VOQUJMRUQo
Q09ORklHX0RSTV9JOTE1X0RFQlVHX0dFTSkgJiYgSVNfRU5BQkxFRChDT05GSUdfREVCVUdfT0JK
RUNUUykKPiBAQCAtMTQ3LDE1ICsxNDUsMTggQEAgX19hY3RpdmVfcmV0aXJlKHN0cnVjdCBpOTE1
X2FjdGl2ZSAqcmVmKQo+ICAgCWlmICghcmV0aXJlKQo+ICAgCQlyZXR1cm47Cj4gICAKPiAtCUdF
TV9CVUdfT04ocmN1X2FjY2Vzc19wb2ludGVyKHJlZi0+ZXhjbCkpOwo+ICsJR0VNX0JVR19PTihy
Y3VfYWNjZXNzX3BvaW50ZXIocmVmLT5leGNsLmZlbmNlKSk7Cj4gICAJcmJ0cmVlX3Bvc3RvcmRl
cl9mb3JfZWFjaF9lbnRyeV9zYWZlKGl0LCBuLCAmcm9vdCwgbm9kZSkgewo+IC0JCUdFTV9CVUdf
T04oaTkxNV9hY3RpdmVfcmVxdWVzdF9pc3NldCgmaXQtPmJhc2UpKTsKPiArCQlHRU1fQlVHX09O
KGk5MTVfYWN0aXZlX2ZlbmNlX2lzc2V0KCZpdC0+YmFzZSkpOwo+ICAgCQlrbWVtX2NhY2hlX2Zy
ZWUoZ2xvYmFsLnNsYWJfY2FjaGUsIGl0KTsKPiAgIAl9Cj4gICAKPiAgIAkvKiBBZnRlciB0aGUg
ZmluYWwgcmV0aXJlLCB0aGUgZW50aXJlIHN0cnVjdCBtYXkgYmUgZnJlZWQgKi8KPiAgIAlpZiAo
cmVmLT5yZXRpcmUpCj4gICAJCXJlZi0+cmV0aXJlKHJlZik7Cj4gKwo+ICsJLyogLi4uIGV4Y2Vw
dCBpZiB5b3Ugd2FpdCBvbiBpdCwgeW91IG11c3QgbWFuYWdlIHlvdXIgb3duIHJlZmVyZW5jZXMh
ICovCj4gKwl3YWtlX3VwX3ZhcihyZWYpOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZAo+IEBA
IC0xODksMTIgKzE5MCwyMCBAQCBhY3RpdmVfcmV0aXJlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVm
KQo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZAo+IC1ub2RlX3JldGlyZShzdHJ1Y3QgaTkxNV9h
Y3RpdmVfcmVxdWVzdCAqYmFzZSwgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCj4gK25vZGVfcmV0
aXJlKHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlLCBzdHJ1Y3QgZG1hX2ZlbmNlX2NiICpjYikKPiAg
IHsKPiAtCWFjdGl2ZV9yZXRpcmUobm9kZV9mcm9tX2FjdGl2ZShiYXNlKS0+cmVmKTsKPiArCWk5
MTVfYWN0aXZlX2ZlbmNlX2NiKGZlbmNlLCBjYik7Cj4gKwlhY3RpdmVfcmV0aXJlKGNvbnRhaW5l
cl9vZihjYiwgc3RydWN0IGFjdGl2ZV9ub2RlLCBiYXNlLmNiKS0+cmVmKTsKPiAgIH0KPiAgIAo+
IC1zdGF0aWMgc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKgo+ICtzdGF0aWMgdm9pZAo+ICtl
eGNsX3JldGlyZShzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSwgc3RydWN0IGRtYV9mZW5jZV9jYiAq
Y2IpCj4gK3sKPiArCWk5MTVfYWN0aXZlX2ZlbmNlX2NiKGZlbmNlLCBjYik7Cj4gKwlhY3RpdmVf
cmV0aXJlKGNvbnRhaW5lcl9vZihjYiwgc3RydWN0IGk5MTVfYWN0aXZlLCBleGNsLmNiKSk7Cj4g
K30KPiArCj4gK3N0YXRpYyBzdHJ1Y3QgaTkxNV9hY3RpdmVfZmVuY2UgKgo+ICAgYWN0aXZlX2lu
c3RhbmNlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLCBzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRs
KQo+ICAgewo+ICAgCXN0cnVjdCBhY3RpdmVfbm9kZSAqbm9kZSwgKnByZWFsbG9jOwo+IEBAIC0y
MzgsNyArMjQ3LDcgQEAgYWN0aXZlX2luc3RhbmNlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLCBz
dHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRsKQo+ICAgCX0KPiAgIAo+ICAgCW5vZGUgPSBwcmVhbGxv
YzsKPiAtCWk5MTVfYWN0aXZlX3JlcXVlc3RfaW5pdCgmbm9kZS0+YmFzZSwgJnRsLT5tdXRleCwg
TlVMTCwgbm9kZV9yZXRpcmUpOwo+ICsJX19pOTE1X2FjdGl2ZV9mZW5jZV9pbml0KCZub2RlLT5i
YXNlLCAmdGwtPm11dGV4LCBOVUxMLCBub2RlX3JldGlyZSk7Cj4gICAJbm9kZS0+cmVmID0gcmVm
Owo+ICAgCW5vZGUtPnRpbWVsaW5lID0gaWR4Owo+ICAgCj4gQEAgLTI1Myw4ICsyNjIsNyBAQCBh
Y3RpdmVfaW5zdGFuY2Uoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsIHN0cnVjdCBpbnRlbF90aW1l
bGluZSAqdGwpCj4gICAJcmV0dXJuICZub2RlLT5iYXNlOwo+ICAgfQo+ICAgCj4gLXZvaWQgX19p
OTE1X2FjdGl2ZV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+IC0JCQlzdHJ1
Y3QgaTkxNV9hY3RpdmUgKnJlZiwKPiArdm9pZCBfX2k5MTVfYWN0aXZlX2luaXQoc3RydWN0IGk5
MTVfYWN0aXZlICpyZWYsCj4gICAJCQlpbnQgKCphY3RpdmUpKHN0cnVjdCBpOTE1X2FjdGl2ZSAq
cmVmKSwKPiAgIAkJCXZvaWQgKCpyZXRpcmUpKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKSwKPiAg
IAkJCXN0cnVjdCBsb2NrX2NsYXNzX2tleSAqa2V5KQo+IEBAIC0yNjMsMTkgKzI3MSwxOCBAQCB2
b2lkIF9faTkxNV9hY3RpdmVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAg
IAo+ICAgCWRlYnVnX2FjdGl2ZV9pbml0KHJlZik7Cj4gICAKPiAtCXJlZi0+aTkxNSA9IGk5MTU7
Cj4gICAJcmVmLT5mbGFncyA9IDA7Cj4gICAJcmVmLT5hY3RpdmUgPSBhY3RpdmU7Cj4gICAJcmVm
LT5yZXRpcmUgPSBwdHJfdW5wYWNrX2JpdHMocmV0aXJlLCAmYml0cywgMik7Cj4gICAJaWYgKGJp
dHMgJiBJOTE1X0FDVElWRV9NQVlfU0xFRVApCj4gICAJCXJlZi0+ZmxhZ3MgfD0gSTkxNV9BQ1RJ
VkVfUkVUSVJFX1NMRUVQUzsKPiAgIAo+IC0JcmVmLT5leGNsID0gTlVMTDsKPiAgIAlyZWYtPnRy
ZWUgPSBSQl9ST09UOwo+ICAgCXJlZi0+Y2FjaGUgPSBOVUxMOwo+ICAgCWluaXRfbGxpc3RfaGVh
ZCgmcmVmLT5wcmVhbGxvY2F0ZWRfYmFycmllcnMpOwo+ICAgCWF0b21pY19zZXQoJnJlZi0+Y291
bnQsIDApOwo+ICAgCV9fbXV0ZXhfaW5pdCgmcmVmLT5tdXRleCwgImk5MTVfYWN0aXZlIiwga2V5
KTsKPiArCV9faTkxNV9hY3RpdmVfZmVuY2VfaW5pdCgmcmVmLT5leGNsLCAmcmVmLT5tdXRleCwg
TlVMTCwgZXhjbF9yZXRpcmUpOwo+ICAgCUlOSVRfV09SSygmcmVmLT53b3JrLCBhY3RpdmVfd29y
ayk7Cj4gICB9Cj4gICAKPiBAQCAtMzI5LDkgKzMzNiw5IEBAIF9fYWN0aXZlX2RlbF9iYXJyaWVy
KHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLCBzdHJ1Y3QgYWN0aXZlX25vZGUgKm5vZGUpCj4gICAK
PiAgIGludCBpOTE1X2FjdGl2ZV9yZWYoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsCj4gICAJCSAg
ICBzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRsLAo+IC0JCSAgICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0
ICpycSkKPiArCQkgICAgc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UpCj4gICB7Cj4gLQlzdHJ1Y3Qg
aTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlOwo+ICsJc3RydWN0IGk5MTVfYWN0aXZlX2ZlbmNl
ICphY3RpdmU7Cj4gICAJaW50IGVycjsKPiAgIAo+ICAgCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJnRs
LT5tdXRleCk7Cj4gQEAgLTM1NCw2NiArMzYxLDQ0IEBAIGludCBpOTE1X2FjdGl2ZV9yZWYoc3Ry
dWN0IGk5MTVfYWN0aXZlICpyZWYsCj4gICAJCSAqIHJlcXVlc3QgdGhhdCB3ZSB3YW50IHRvIGVt
aXQgb24gdGhlIGtlcm5lbF9jb250ZXh0Lgo+ICAgCQkgKi8KPiAgIAkJX19hY3RpdmVfZGVsX2Jh
cnJpZXIocmVmLCBub2RlX2Zyb21fYWN0aXZlKGFjdGl2ZSkpOwo+IC0JCVJDVV9JTklUX1BPSU5U
RVIoYWN0aXZlLT5yZXF1ZXN0LCBOVUxMKTsKPiAtCQlJTklUX0xJU1RfSEVBRCgmYWN0aXZlLT5s
aW5rKTsKPiAtCX0gZWxzZSB7Cj4gLQkJaWYgKCFpOTE1X2FjdGl2ZV9yZXF1ZXN0X2lzc2V0KGFj
dGl2ZSkpCj4gLQkJCWF0b21pY19pbmMoJnJlZi0+Y291bnQpOwo+ICsJCVJDVV9JTklUX1BPSU5U
RVIoYWN0aXZlLT5mZW5jZSwgTlVMTCk7Cj4gKwkJYXRvbWljX2RlYygmcmVmLT5jb3VudCk7Cj4g
ICAJfQo+IC0JR0VNX0JVR19PTighYXRvbWljX3JlYWQoJnJlZi0+Y291bnQpKTsKPiAtCV9faTkx
NV9hY3RpdmVfcmVxdWVzdF9zZXQoYWN0aXZlLCBycSk7Cj4gKwlpZiAoIV9faTkxNV9hY3RpdmVf
ZmVuY2Vfc2V0KGFjdGl2ZSwgZmVuY2UpKQo+ICsJCWF0b21pY19pbmMoJnJlZi0+Y291bnQpOwo+
ICAgCj4gICBvdXQ6Cj4gICAJaTkxNV9hY3RpdmVfcmVsZWFzZShyZWYpOwo+ICAgCXJldHVybiBl
cnI7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgZXhjbF9jYihzdHJ1Y3QgZG1hX2ZlbmNlICpm
LCBzdHJ1Y3QgZG1hX2ZlbmNlX2NiICpjYikKPiAtewo+IC0Jc3RydWN0IGk5MTVfYWN0aXZlICpy
ZWYgPSBjb250YWluZXJfb2YoY2IsIHR5cGVvZigqcmVmKSwgZXhjbF9jYik7Cj4gLQo+IC0JUkNV
X0lOSVRfUE9JTlRFUihyZWYtPmV4Y2wsIE5VTEwpOwo+IC0JZG1hX2ZlbmNlX3B1dChmKTsKPiAt
Cj4gLQlhY3RpdmVfcmV0aXJlKHJlZik7Cj4gLX0KPiAtCj4gICB2b2lkIGk5MTVfYWN0aXZlX3Nl
dF9leGNsdXNpdmUoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsIHN0cnVjdCBkbWFfZmVuY2UgKmYp
Cj4gICB7Cj4gICAJLyogV2UgZXhwZWN0IHRoZSBjYWxsZXIgdG8gbWFuYWdlIHRoZSBleGNsdXNp
dmUgdGltZWxpbmUgb3JkZXJpbmcgKi8KPiAgIAlHRU1fQlVHX09OKGk5MTVfYWN0aXZlX2lzX2lk
bGUocmVmKSk7Cj4gICAKPiAtCWRtYV9mZW5jZV9nZXQoZik7Cj4gLQo+IC0JcmN1X3JlYWRfbG9j
aygpOwo+IC0JaWYgKHJjdV9hY2Nlc3NfcG9pbnRlcihyZWYtPmV4Y2wpKSB7Cj4gLQkJc3RydWN0
IGRtYV9mZW5jZSAqb2xkOwo+IC0KPiAtCQlvbGQgPSBkbWFfZmVuY2VfZ2V0X3JjdV9zYWZlKCZy
ZWYtPmV4Y2wpOwo+IC0JCWlmIChvbGQpIHsKPiAtCQkJaWYgKGRtYV9mZW5jZV9yZW1vdmVfY2Fs
bGJhY2sob2xkLCAmcmVmLT5leGNsX2NiKSkKPiAtCQkJCWF0b21pY19kZWMoJnJlZi0+Y291bnQp
Owo+IC0JCQlkbWFfZmVuY2VfcHV0KG9sZCk7Cj4gLQkJfQo+IC0JfQo+IC0JcmN1X3JlYWRfdW5s
b2NrKCk7Cj4gLQo+IC0JYXRvbWljX2luYygmcmVmLT5jb3VudCk7Cj4gLQlyY3VfYXNzaWduX3Bv
aW50ZXIocmVmLT5leGNsLCBmKTsKPiArCS8qCj4gKwkgKiBBcyB3ZSBkb24ndCBrbm93IHdoaWNo
IG11dGV4IHRoZSBjYWxsZXIgaXMgdXNpbmcsIHdlIHRvbGQgYSBzbWFsbAo+ICsJICogbGllIHRv
IHRoZSBkZWJ1ZyBjb2RlIHRoYXQgaXQgaXMgdXNpbmcgdGhlIGk5MTVfYWN0aXZlLm11dGV4Owo+
ICsJICogYW5kIG5vdyB3ZSBtdXN0IHN0aWNrIHRvIHRoYXQgbGllLgo+ICsJICovCj4gKwltdXRl
eF9hY3F1aXJlKCZyZWYtPm11dGV4LmRlcF9tYXAsIDAsIDAsIF9USElTX0lQXyk7Cj4gKwlpZiAo
IV9faTkxNV9hY3RpdmVfZmVuY2Vfc2V0KCZyZWYtPmV4Y2wsIGYpKQo+ICsJCWF0b21pY19pbmMo
JnJlZi0+Y291bnQpOwo+ICsJbXV0ZXhfcmVsZWFzZSgmcmVmLT5tdXRleC5kZXBfbWFwLCAwLCBf
VEhJU19JUF8pOwo+ICt9Cj4gICAKPiAtCWlmIChkbWFfZmVuY2VfYWRkX2NhbGxiYWNrKGYsICZy
ZWYtPmV4Y2xfY2IsIGV4Y2xfY2IpKSB7Cj4gLQkJUkNVX0lOSVRfUE9JTlRFUihyZWYtPmV4Y2ws
IE5VTEwpOwo+IC0JCWF0b21pY19kZWMoJnJlZi0+Y291bnQpOwo+IC0JCWRtYV9mZW5jZV9wdXQo
Zik7Cj4gLQl9Cj4gK2Jvb2wgaTkxNV9hY3RpdmVfYWNxdWlyZV9pZl9idXN5KHN0cnVjdCBpOTE1
X2FjdGl2ZSAqcmVmKQo+ICt7Cj4gKwlkZWJ1Z19hY3RpdmVfYXNzZXJ0KHJlZik7Cj4gKwlyZXR1
cm4gYXRvbWljX2FkZF91bmxlc3MoJnJlZi0+Y291bnQsIDEsIDApOwo+ICAgfQo+ICAgCj4gICBp
bnQgaTkxNV9hY3RpdmVfYWNxdWlyZShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZikKPiAgIHsKPiAg
IAlpbnQgZXJyOwo+ICAgCj4gLQlkZWJ1Z19hY3RpdmVfYXNzZXJ0KHJlZik7Cj4gLQlpZiAoYXRv
bWljX2FkZF91bmxlc3MoJnJlZi0+Y291bnQsIDEsIDApKQo+ICsJaWYgKGk5MTVfYWN0aXZlX2Fj
cXVpcmVfaWZfYnVzeShyZWYpKQo+ICAgCQlyZXR1cm4gMDsKPiAgIAo+ICAgCWVyciA9IG11dGV4
X2xvY2tfaW50ZXJydXB0aWJsZSgmcmVmLT5tdXRleCk7Cj4gQEAgLTQzOCwxMjEgKzQyMyw1NyBA
QCB2b2lkIGk5MTVfYWN0aXZlX3JlbGVhc2Uoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCj4gICAJ
YWN0aXZlX3JldGlyZShyZWYpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIF9fYWN0aXZlX3Vu
Z3JhYihzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZikKPiAtewo+IC0JY2xlYXJfYW5kX3dha2VfdXBf
Yml0KEk5MTVfQUNUSVZFX0dSQUJfQklULCAmcmVmLT5mbGFncyk7Cj4gLX0KPiAtCj4gLWJvb2wg
aTkxNV9hY3RpdmVfdHJ5Z3JhYihzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZikKPiArc3RhdGljIHZv
aWQgZW5hYmxlX3NpZ25hbGluZyhzdHJ1Y3QgaTkxNV9hY3RpdmVfZmVuY2UgKmFjdGl2ZSkKPiAg
IHsKPiAtCWRlYnVnX2FjdGl2ZV9hc3NlcnQocmVmKTsKPiAtCj4gLQlpZiAodGVzdF9hbmRfc2V0
X2JpdChJOTE1X0FDVElWRV9HUkFCX0JJVCwgJnJlZi0+ZmxhZ3MpKQo+IC0JCXJldHVybiBmYWxz
ZTsKPiAtCj4gLQlpZiAoIWF0b21pY19hZGRfdW5sZXNzKCZyZWYtPmNvdW50LCAxLCAwKSkgewo+
IC0JCV9fYWN0aXZlX3VuZ3JhYihyZWYpOwo+IC0JCXJldHVybiBmYWxzZTsKPiAtCX0KPiArCXN0
cnVjdCBkbWFfZmVuY2UgKmZlbmNlOwo+ICAgCj4gLQlyZXR1cm4gdHJ1ZTsKPiAtfQo+IC0KPiAt
dm9pZCBpOTE1X2FjdGl2ZV91bmdyYWIoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCj4gLXsKPiAt
CUdFTV9CVUdfT04oIXRlc3RfYml0KEk5MTVfQUNUSVZFX0dSQUJfQklULCAmcmVmLT5mbGFncykp
Owo+IC0KPiAtCWFjdGl2ZV9yZXRpcmUocmVmKTsKPiAtCV9fYWN0aXZlX3VuZ3JhYihyZWYpOwo+
IC19Cj4gLQo+IC1zdGF0aWMgaW50IGV4Y2xfd2FpdChzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZikK
PiAtewo+IC0Jc3RydWN0IGRtYV9mZW5jZSAqb2xkOwo+IC0JaW50IGVyciA9IDA7Cj4gLQo+IC0J
aWYgKCFyY3VfYWNjZXNzX3BvaW50ZXIocmVmLT5leGNsKSkKPiAtCQlyZXR1cm4gMDsKPiAtCj4g
LQlyY3VfcmVhZF9sb2NrKCk7Cj4gLQlvbGQgPSBkbWFfZmVuY2VfZ2V0X3JjdV9zYWZlKCZyZWYt
PmV4Y2wpOwo+IC0JcmN1X3JlYWRfdW5sb2NrKCk7Cj4gLQlpZiAob2xkKSB7Cj4gLQkJZXJyID0g
ZG1hX2ZlbmNlX3dhaXQob2xkLCB0cnVlKTsKPiAtCQlkbWFfZmVuY2VfcHV0KG9sZCk7Cj4gLQl9
Cj4gKwlmZW5jZSA9IGk5MTVfYWN0aXZlX2ZlbmNlX2dldChhY3RpdmUpOwo+ICsJaWYgKCFmZW5j
ZSkKPiArCQlyZXR1cm47Cj4gICAKPiAtCXJldHVybiBlcnI7Cj4gKwlkbWFfZmVuY2VfZW5hYmxl
X3N3X3NpZ25hbGluZyhmZW5jZSk7Cj4gKwlkbWFfZmVuY2VfcHV0KGZlbmNlKTsKPiAgIH0KPiAg
IAo+ICAgaW50IGk5MTVfYWN0aXZlX3dhaXQoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCj4gICB7
Cj4gICAJc3RydWN0IGFjdGl2ZV9ub2RlICppdCwgKm47Cj4gLQlpbnQgZXJyOwo+ICsJaW50IGVy
ciA9IDA7Cj4gICAKPiAgIAltaWdodF9zbGVlcCgpOwo+IC0JbWlnaHRfbG9jaygmcmVmLT5tdXRl
eCk7Cj4gLQo+IC0JaWYgKGk5MTVfYWN0aXZlX2lzX2lkbGUocmVmKSkKPiAtCQlyZXR1cm4gMDsK
PiAtCj4gLQllcnIgPSBtdXRleF9sb2NrX2ludGVycnVwdGlibGUoJnJlZi0+bXV0ZXgpOwo+IC0J
aWYgKGVycikKPiAtCQlyZXR1cm4gZXJyOwo+ICAgCj4gLQlpZiAoIWF0b21pY19hZGRfdW5sZXNz
KCZyZWYtPmNvdW50LCAxLCAwKSkgewo+IC0JCW11dGV4X3VubG9jaygmcmVmLT5tdXRleCk7Cj4g
KwlpZiAoIWk5MTVfYWN0aXZlX2FjcXVpcmVfaWZfYnVzeShyZWYpKQo+ICAgCQlyZXR1cm4gMDsK
PiAtCX0KPiAtCj4gLQllcnIgPSBleGNsX3dhaXQocmVmKTsKPiAtCWlmIChlcnIpCj4gLQkJZ290
byBvdXQ7Cj4gICAKPiArCS8qIEZsdXNoIGxhenkgc2lnbmFscyAqLwo+ICsJZW5hYmxlX3NpZ25h
bGluZygmcmVmLT5leGNsKTsKPiAgIAlyYnRyZWVfcG9zdG9yZGVyX2Zvcl9lYWNoX2VudHJ5X3Nh
ZmUoaXQsIG4sICZyZWYtPnRyZWUsIG5vZGUpIHsKPiAtCQlpZiAoaXNfYmFycmllcigmaXQtPmJh
c2UpKSB7IC8qIHVuY29ubmVjdGVkIGlkbGUtYmFycmllciAqLwo+IC0JCQllcnIgPSAtRUJVU1k7
Cj4gLQkJCWJyZWFrOwo+IC0JCX0KPiArCQlpZiAoaXNfYmFycmllcigmaXQtPmJhc2UpKSAvKiB1
bmNvbm5lY3RlZCBpZGxlIGJhcnJpZXIgKi8KPiArCQkJY29udGludWU7Cj4gICAKPiAtCQllcnIg
PSBpOTE1X2FjdGl2ZV9yZXF1ZXN0X3JldGlyZSgmaXQtPmJhc2UsIEJLTChyZWYpKTsKPiAtCQlp
ZiAoZXJyKQo+IC0JCQlicmVhazsKPiArCQllbmFibGVfc2lnbmFsaW5nKCZpdC0+YmFzZSk7Cj4g
ICAJfQo+ICsJLyogQW55IGZlbmNlIGFkZGVkIGFmdGVyIHRoZSB3YWl0IGJlZ2lucyB3aWxsIG5v
dCBiZSBhdXRvLXNpZ25hbGVkICovCj4gICAKPiAtb3V0Ogo+IC0JX19hY3RpdmVfcmV0aXJlKHJl
Zik7Cj4gKwlpOTE1X2FjdGl2ZV9yZWxlYXNlKHJlZik7Cj4gICAJaWYgKGVycikKPiAgIAkJcmV0
dXJuIGVycjsKPiAgIAo+IC0JaWYgKHdhaXRfb25fYml0KCZyZWYtPmZsYWdzLCBJOTE1X0FDVElW
RV9HUkFCX0JJVCwgVEFTS19LSUxMQUJMRSkpCj4gKwlpZiAod2FpdF92YXJfZXZlbnRfaW50ZXJy
dXB0aWJsZShyZWYsIGk5MTVfYWN0aXZlX2lzX2lkbGUocmVmKSkpCj4gICAJCXJldHVybiAtRUlO
VFI7Cj4gICAKPiAtCWZsdXNoX3dvcmsoJnJlZi0+d29yayk7Cj4gLQlpZiAoIWk5MTVfYWN0aXZl
X2lzX2lkbGUocmVmKSkKPiAtCQlyZXR1cm4gLUVCVVNZOwo+IC0KPiAgIAlyZXR1cm4gMDsKPiAg
IH0KPiAgIAo+IC1pbnQgaTkxNV9yZXF1ZXN0X2F3YWl0X2FjdGl2ZV9yZXF1ZXN0KHN0cnVjdCBp
OTE1X3JlcXVlc3QgKnJxLAo+IC0JCQkJICAgICAgc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3Qg
KmFjdGl2ZSkKPiAtewo+IC0Jc3RydWN0IGk5MTVfcmVxdWVzdCAqYmFycmllciA9Cj4gLQkJaTkx
NV9hY3RpdmVfcmVxdWVzdF9yYXcoYWN0aXZlLCAmcnEtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgp
Owo+IC0KPiAtCXJldHVybiBiYXJyaWVyID8gaTkxNV9yZXF1ZXN0X2F3YWl0X2RtYV9mZW5jZShy
cSwgJmJhcnJpZXItPmZlbmNlKSA6IDA7Cj4gLX0KPiAtCj4gICBpbnQgaTkxNV9yZXF1ZXN0X2F3
YWl0X2FjdGl2ZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgc3RydWN0IGk5MTVfYWN0aXZlICpy
ZWYpCj4gICB7Cj4gICAJaW50IGVyciA9IDA7Cj4gICAKPiAtCWlmIChyY3VfYWNjZXNzX3BvaW50
ZXIocmVmLT5leGNsKSkgewo+ICsJaWYgKHJjdV9hY2Nlc3NfcG9pbnRlcihyZWYtPmV4Y2wuZmVu
Y2UpKSB7Cj4gICAJCXN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlOwo+ICAgCj4gICAJCXJjdV9yZWFk
X2xvY2soKTsKPiAtCQlmZW5jZSA9IGRtYV9mZW5jZV9nZXRfcmN1X3NhZmUoJnJlZi0+ZXhjbCk7
Cj4gKwkJZmVuY2UgPSBkbWFfZmVuY2VfZ2V0X3JjdV9zYWZlKCZyZWYtPmV4Y2wuZmVuY2UpOwo+
ICAgCQlyY3VfcmVhZF91bmxvY2soKTsKPiAgIAkJaWYgKGZlbmNlKSB7Cj4gICAJCQllcnIgPSBp
OTE1X3JlcXVlc3RfYXdhaXRfZG1hX2ZlbmNlKHJxLCBmZW5jZSk7Cj4gQEAgLTU3OCw3ICs0OTks
NyBAQCB2b2lkIGk5MTVfYWN0aXZlX2Zpbmkoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCj4gICAK
PiAgIHN0YXRpYyBpbmxpbmUgYm9vbCBpc19pZGxlX2JhcnJpZXIoc3RydWN0IGFjdGl2ZV9ub2Rl
ICpub2RlLCB1NjQgaWR4KQo+ICAgewo+IC0JcmV0dXJuIG5vZGUtPnRpbWVsaW5lID09IGlkeCAm
JiAhaTkxNV9hY3RpdmVfcmVxdWVzdF9pc3NldCgmbm9kZS0+YmFzZSk7Cj4gKwlyZXR1cm4gbm9k
ZS0+dGltZWxpbmUgPT0gaWR4ICYmICFpOTE1X2FjdGl2ZV9mZW5jZV9pc3NldCgmbm9kZS0+YmFz
ZSk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBzdHJ1Y3QgYWN0aXZlX25vZGUgKnJldXNlX2lkbGVf
YmFycmllcihzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwgdTY0IGlkeCkKPiBAQCAtNjk4LDEzICs2
MTksMTMgQEAgaW50IGk5MTVfYWN0aXZlX2FjcXVpcmVfcHJlYWxsb2NhdGVfYmFycmllcihzdHJ1
Y3QgaTkxNV9hY3RpdmUgKnJlZiwKPiAgIAkJCW5vZGUtPmJhc2UubG9jayA9Cj4gICAJCQkJJmVu
Z2luZS0+a2VybmVsX2NvbnRleHQtPnRpbWVsaW5lLT5tdXRleDsKPiAgICNlbmRpZgo+IC0JCQlS
Q1VfSU5JVF9QT0lOVEVSKG5vZGUtPmJhc2UucmVxdWVzdCwgTlVMTCk7Cj4gLQkJCW5vZGUtPmJh
c2UucmV0aXJlID0gbm9kZV9yZXRpcmU7Cj4gKwkJCVJDVV9JTklUX1BPSU5URVIobm9kZS0+YmFz
ZS5mZW5jZSwgTlVMTCk7Cj4gKwkJCW5vZGUtPmJhc2UuY2IuZnVuYyA9IG5vZGVfcmV0aXJlOwo+
ICAgCQkJbm9kZS0+dGltZWxpbmUgPSBpZHg7Cj4gICAJCQlub2RlLT5yZWYgPSByZWY7Cj4gICAJ
CX0KPiAgIAo+IC0JCWlmICghaTkxNV9hY3RpdmVfcmVxdWVzdF9pc3NldCgmbm9kZS0+YmFzZSkp
IHsKPiArCQlpZiAoIWk5MTVfYWN0aXZlX2ZlbmNlX2lzc2V0KCZub2RlLT5iYXNlKSkgewo+ICAg
CQkJLyoKPiAgIAkJCSAqIE1hcmsgdGhpcyBhcyBiZWluZyAqb3VyKiB1bmNvbm5lY3RlZCBwcm90
by1ub2RlLgo+ICAgCQkJICoKPiBAQCAtNzE0LDggKzYzNSw4IEBAIGludCBpOTE1X2FjdGl2ZV9h
Y3F1aXJlX3ByZWFsbG9jYXRlX2JhcnJpZXIoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsCj4gICAJ
CQkgKiBhbmQgdGhlbiB3ZSBjYW4gdXNlIHRoZSByYl9ub2RlIGFuZCBsaXN0IHBvaW50ZXJzCj4g
ICAJCQkgKiBmb3Igb3VyIHRyYWNraW5nIG9mIHRoZSBwZW5kaW5nIGJhcnJpZXIuCj4gICAJCQkg
Ki8KPiAtCQkJUkNVX0lOSVRfUE9JTlRFUihub2RlLT5iYXNlLnJlcXVlc3QsIEVSUl9QVFIoLUVB
R0FJTikpOwo+IC0JCQlub2RlLT5iYXNlLmxpbmsucHJldiA9ICh2b2lkICopZW5naW5lOwo+ICsJ
CQlSQ1VfSU5JVF9QT0lOVEVSKG5vZGUtPmJhc2UuZmVuY2UsIEVSUl9QVFIoLUVBR0FJTikpOwo+
ICsJCQlub2RlLT5iYXNlLmNiLm5vZGUucHJldiA9ICh2b2lkICopZW5naW5lOwo+ICAgCQkJYXRv
bWljX2luYygmcmVmLT5jb3VudCk7Cj4gICAJCX0KPiAgIAo+IEBAIC03ODIsNDQgKzcwMywxMTMg
QEAgdm9pZCBpOTE1X3JlcXVlc3RfYWRkX2FjdGl2ZV9iYXJyaWVycyhzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpycSkKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUgPSBycS0+
ZW5naW5lOwo+ICAgCXN0cnVjdCBsbGlzdF9ub2RlICpub2RlLCAqbmV4dDsKPiArCXVuc2lnbmVk
IGxvbmcgZmxhZ3M7Cj4gICAKPiAgIAlHRU1fQlVHX09OKGludGVsX2VuZ2luZV9pc192aXJ0dWFs
KGVuZ2luZSkpOwo+ICAgCUdFTV9CVUdfT04oaTkxNV9yZXF1ZXN0X3RpbWVsaW5lKHJxKSAhPSBl
bmdpbmUtPmtlcm5lbF9jb250ZXh0LT50aW1lbGluZSk7Cj4gICAKPiArCW5vZGUgPSBsbGlzdF9k
ZWxfYWxsKCZlbmdpbmUtPmJhcnJpZXJfdGFza3MpOwo+ICsJaWYgKCFub2RlKQo+ICsJCXJldHVy
bjsKPiAgIAkvKgo+ICAgCSAqIEF0dGFjaCB0aGUgbGlzdCBvZiBwcm90by1mZW5jZXMgdG8gdGhl
IGluLWZsaWdodCByZXF1ZXN0IHN1Y2gKPiAgIAkgKiB0aGF0IHRoZSBwYXJlbnQgaTkxNV9hY3Rp
dmUgd2lsbCBiZSByZWxlYXNlZCB3aGVuIHRoaXMgcmVxdWVzdAo+ICAgCSAqIGlzIHJldGlyZWQu
Cj4gICAJICovCj4gLQlsbGlzdF9mb3JfZWFjaF9zYWZlKG5vZGUsIG5leHQsIGxsaXN0X2RlbF9h
bGwoJmVuZ2luZS0+YmFycmllcl90YXNrcykpIHsKPiAtCQlSQ1VfSU5JVF9QT0lOVEVSKGJhcnJp
ZXJfZnJvbV9sbChub2RlKS0+YmFzZS5yZXF1ZXN0LCBycSk7Cj4gKwlzcGluX2xvY2tfaXJxc2F2
ZSgmcnEtPmxvY2ssIGZsYWdzKTsKPiArCWxsaXN0X2Zvcl9lYWNoX3NhZmUobm9kZSwgbmV4dCwg
bm9kZSkgewo+ICsJCVJDVV9JTklUX1BPSU5URVIoYmFycmllcl9mcm9tX2xsKG5vZGUpLT5iYXNl
LmZlbmNlLCAmcnEtPmZlbmNlKTsKPiAgIAkJc21wX3dtYigpOyAvKiBzZXJpYWxpc2Ugd2l0aCBy
ZXVzZV9pZGxlX2JhcnJpZXIgKi8KPiAtCQlsaXN0X2FkZF90YWlsKChzdHJ1Y3QgbGlzdF9oZWFk
ICopbm9kZSwgJnJxLT5hY3RpdmVfbGlzdCk7Cj4gKwkJbGlzdF9hZGRfdGFpbCgoc3RydWN0IGxp
c3RfaGVhZCAqKW5vZGUsICZycS0+ZmVuY2UuY2JfbGlzdCk7Cj4gKwl9Cj4gKwlzcGluX3VubG9j
a19pcnFyZXN0b3JlKCZycS0+bG9jaywgZmxhZ3MpOwo+ICt9Cj4gKwo+ICsjaWYgSVNfRU5BQkxF
RChDT05GSUdfRFJNX0k5MTVfREVCVUdfR0VNKQo+ICsjZGVmaW5lIGFjdGl2ZV9pc19oZWxkKGFj
dGl2ZSkgbG9ja2RlcF9pc19oZWxkKChhY3RpdmUpLT5sb2NrKQo+ICsjZWxzZQo+ICsjZGVmaW5l
IGFjdGl2ZV9pc19oZWxkKGFjdGl2ZSkgdHJ1ZQo+ICsjZW5kaWYKPiArCj4gKy8qCj4gKyAqIF9f
aTkxNV9hY3RpdmVfZmVuY2Vfc2V0OiBVcGRhdGUgdGhlIGxhc3QgYWN0aXZlIGZlbmNlIGFsb25n
IGl0cyB0aW1lbGluZQo+ICsgKiBAYWN0aXZlOiB0aGUgYWN0aXZlIHRyYWNrZXIKPiArICogQGZl
bmNlOiB0aGUgbmV3IGZlbmNlICh1bmRlciBjb25zdHJ1Y3Rpb24pCj4gKyAqCj4gKyAqIFJlY29y
ZHMgdGhlIG5ldyBAZmVuY2UgYXMgdGhlIGxhc3QgYWN0aXZlIGZlbmNlIGFsb25nIGl0cyB0aW1l
bGluZSBpbgo+ICsgKiB0aGlzIGFjdGl2ZSB0cmFja2VyLCBtb3ZpbmcgdGhlIHRyYWNraW5nIGNh
bGxiYWNrcyBmcm9tIHRoZSBwcmV2aW91cwo+ICsgKiBmZW5jZSBvbnRvIHRoaXMgb25lLiBSZXR1
cm5zIHRoZSBwcmV2aW91cyBmZW5jZSAoaWYgbm90IGFscmVhZHkgY29tcGxldGVkKSwKPiArICog
d2hpY2ggdGhlIGNhbGxlciBtdXN0IGVuc3VyZSBpcyBleGVjdXRlZCBiZWZvcmUgdGhlIG5ldyBm
ZW5jZS4gVG8gZW5zdXJlCj4gKyAqIHRoYXQgdGhlIG9yZGVyIG9mIGZlbmNlcyB3aXRoaW4gdGhl
IHRpbWVsaW5lIG9mIHRoZSBpOTE1X2FjdGl2ZV9mZW5jZSBpcwo+ICsgKiBtYWludGFpbmVkLCBp
dCBtdXN0IGJlIGxvY2tlZCBieSB0aGUgY2FsbGVyLgo+ICsgKi8KPiArc3RydWN0IGRtYV9mZW5j
ZSAqCj4gK19faTkxNV9hY3RpdmVfZmVuY2Vfc2V0KHN0cnVjdCBpOTE1X2FjdGl2ZV9mZW5jZSAq
YWN0aXZlLAo+ICsJCQlzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSkKPiArewo+ICsJc3RydWN0IGRt
YV9mZW5jZSAqcHJldjsKPiArCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4gKwo+ICsJLyogTkI6IG11
c3QgYmUgc2VyaWFsaXNlZCBieSBhbiBvdXRlciB0aW1lbGluZSBtdXRleCAoYWN0aXZlLT5sb2Nr
KSAqLwo+ICsJc3Bpbl9sb2NrX2lycXNhdmUoZmVuY2UtPmxvY2ssIGZsYWdzKTsKPiArCUdFTV9C
VUdfT04odGVzdF9iaXQoRE1BX0ZFTkNFX0ZMQUdfU0lHTkFMRURfQklULCAmZmVuY2UtPmZsYWdz
KSk7Cj4gKwo+ICsJcHJldiA9IHJjdV9kZXJlZmVyZW5jZV9wcm90ZWN0ZWQoYWN0aXZlLT5mZW5j
ZSwgYWN0aXZlX2lzX2hlbGQoYWN0aXZlKSk7Cj4gKwlpZiAocHJldikgewo+ICsJCUdFTV9CVUdf
T04ocHJldiA9PSBmZW5jZSk7Cj4gKwkJc3Bpbl9sb2NrX25lc3RlZChwcmV2LT5sb2NrLCBTSU5H
TEVfREVQVEhfTkVTVElORyk7Cj4gKwkJX19saXN0X2RlbF9lbnRyeSgmYWN0aXZlLT5jYi5ub2Rl
KTsKPiArCQlzcGluX3VubG9jayhwcmV2LT5sb2NrKTsgLyogc2VyaWFsaXNlIHdpdGggcHJldi0+
Y2JfbGlzdCAqLwo+ICsKPiArCQkvKgo+ICsJCSAqIGFjdGl2ZS0+ZmVuY2UgaXMgcmVzZXQgYnkg
dGhlIGNhbGxiYWNrIGZyb20gaW5zaWRlCj4gKwkJICogaW50ZXJydXB0IGNvbnRleHQuIFdlIG5l
ZWQgdG8gc2VyaWFsaXNlIG91ciBsaXN0Cj4gKwkJICogbWFuaXB1bGF0aW9uIHdpdGggdGhlIGZl
bmNlLT5sb2NrIHRvIHByZXZlbnQgdGhlIHByZXYKPiArCQkgKiBiZWluZyBsb3N0IGluc2lkZSBh
biBpbnRlcnJ1cHQgKGl0IGNhbid0IGJlIHJlcGxhY2VkIGFzCj4gKwkJICogbm8gb3RoZXIgY2Fs
bGVyIGlzIGFsbG93ZWQgdG8gZW50ZXIgX19pOTE1X2FjdGl2ZV9mZW5jZV9zZXQKPiArCQkgKiBh
cyB3ZSBob2xkIHRoZSB0aW1lbGluZSBsb2NrKS4gQWZ0ZXIgc2VyaWFsaXNpbmcgd2l0aAo+ICsJ
CSAqIHRoZSBjYWxsYmFjaywgd2UgbmVlZCB0byBkb3VibGUgY2hlY2sgd2hpY2ggcmFuIGZpcnN0
LAo+ICsJCSAqIG91ciBsaXN0X2RlbCgpIFtkZWNvdXBsaW5nIHByZXYgZnJvbSB0aGUgY2FsbGJh
Y2tdIG9yCj4gKwkJICogdGhlIGNhbGxiYWNrLi4uCj4gKwkJICovCj4gKwkJcHJldiA9IHJjdV9h
Y2Nlc3NfcG9pbnRlcihhY3RpdmUtPmZlbmNlKTsKPiAgIAl9Cj4gKwo+ICsJcmN1X2Fzc2lnbl9w
b2ludGVyKGFjdGl2ZS0+ZmVuY2UsIGZlbmNlKTsKPiArCWxpc3RfYWRkX3RhaWwoJmFjdGl2ZS0+
Y2Iubm9kZSwgJmZlbmNlLT5jYl9saXN0KTsKPiArCj4gKwlzcGluX3VubG9ja19pcnFyZXN0b3Jl
KGZlbmNlLT5sb2NrLCBmbGFncyk7Cj4gKwo+ICsJcmV0dXJuIHByZXY7Cj4gICB9Cj4gICAKPiAt
aW50IGk5MTVfYWN0aXZlX3JlcXVlc3Rfc2V0KHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICph
Y3RpdmUsCj4gLQkJCSAgICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKPiAraW50IGk5MTVfYWN0
aXZlX2ZlbmNlX3NldChzdHJ1Y3QgaTkxNV9hY3RpdmVfZmVuY2UgKmFjdGl2ZSwKPiArCQkJICBz
dHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKPiAgIHsKPiAtCWludCBlcnI7Cj4gKwlzdHJ1Y3QgZG1h
X2ZlbmNlICpmZW5jZTsKPiArCWludCBlcnIgPSAwOwo+ICAgCj4gICAjaWYgSVNfRU5BQkxFRChD
T05GSUdfRFJNX0k5MTVfREVCVUdfR0VNKQo+ICAgCWxvY2tkZXBfYXNzZXJ0X2hlbGQoYWN0aXZl
LT5sb2NrKTsKPiAgICNlbmRpZgo+ICAgCj4gLQkvKiBNdXN0IG1haW50YWluIG9yZGVyaW5nIHdy
dCBwcmV2aW91cyBhY3RpdmUgcmVxdWVzdHMgKi8KPiAtCWVyciA9IGk5MTVfcmVxdWVzdF9hd2Fp
dF9hY3RpdmVfcmVxdWVzdChycSwgYWN0aXZlKTsKPiAtCWlmIChlcnIpCj4gLQkJcmV0dXJuIGVy
cjsKPiArCS8qIE11c3QgbWFpbnRhaW4gdGltZWxpbmUgb3JkZXJpbmcgd3J0IHByZXZpb3VzIGFj
dGl2ZSByZXF1ZXN0cyAqLwo+ICsJcmN1X3JlYWRfbG9jaygpOwo+ICsJZmVuY2UgPSBfX2k5MTVf
YWN0aXZlX2ZlbmNlX3NldChhY3RpdmUsICZycS0+ZmVuY2UpOwo+ICsJaWYgKGZlbmNlKSAvKiBi
dXQgdGhlIHByZXZpb3VzIGZlbmNlIG1heSBub3QgYmVsb25nIHRvIHRoYXQgdGltZWxpbmUhICov
Cj4gKwkJZmVuY2UgPSBkbWFfZmVuY2VfZ2V0X3JjdShmZW5jZSk7Cj4gKwlyY3VfcmVhZF91bmxv
Y2soKTsKPiArCWlmIChmZW5jZSkgewo+ICsJCWVyciA9IGk5MTVfcmVxdWVzdF9hd2FpdF9kbWFf
ZmVuY2UocnEsIGZlbmNlKTsKPiArCQlkbWFfZmVuY2VfcHV0KGZlbmNlKTsKPiArCX0KPiAgIAo+
IC0JX19pOTE1X2FjdGl2ZV9yZXF1ZXN0X3NldChhY3RpdmUsIHJxKTsKPiAtCXJldHVybiAwOwo+
ICsJcmV0dXJuIGVycjsKPiAgIH0KPiAgIAo+IC12b2lkIGk5MTVfYWN0aXZlX3JldGlyZV9ub29w
KHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUsCj4gLQkJCSAgICAgc3RydWN0IGk5
MTVfcmVxdWVzdCAqcmVxdWVzdCkKPiArdm9pZCBpOTE1X2FjdGl2ZV9ub29wKHN0cnVjdCBkbWFf
ZmVuY2UgKmZlbmNlLCBzdHJ1Y3QgZG1hX2ZlbmNlX2NiICpjYikKPiAgIHsKPiAtCS8qIFNwYWNl
IGxlZnQgaW50ZW50aW9uYWxseSBibGFuayAqLwo+ICsJaTkxNV9hY3RpdmVfZmVuY2VfY2IoZmVu
Y2UsIGNiKTsKPiAgIH0KPiAgIAo+ICAgI2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X1NF
TEZURVNUKQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5o
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuaAo+IGluZGV4IDkwMDM0ZjYxYjdj
Mi4uNGY1MmZlNjE0NmQyIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
YWN0aXZlLmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5oCj4gQEAg
LTEyLDYgKzEyLDEwIEBACj4gICAjaW5jbHVkZSAiaTkxNV9hY3RpdmVfdHlwZXMuaCIKPiAgICNp
bmNsdWRlICJpOTE1X3JlcXVlc3QuaCIKPiAgIAo+ICtzdHJ1Y3QgaTkxNV9yZXF1ZXN0Owo+ICtz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzOwo+ICtzdHJ1Y3QgaW50ZWxfdGltZWxpbmU7Cj4gKwo+ICAg
LyoKPiAgICAqIFdlIHRyZWF0IHJlcXVlc3RzIGFzIGZlbmNlcy4gVGhpcyBpcyBub3QgYmUgdG8g
Y29uZnVzZWQgd2l0aCBvdXIKPiAgICAqICJmZW5jZSByZWdpc3RlcnMiIGJ1dCBwaXBlbGluZSBz
eW5jaHJvbmlzYXRpb24gb2JqZWN0cyBhbGEgR0xfQVJCX3N5bmMuCj4gQEAgLTI4LDMwOCArMzIs
MTA4IEBACj4gICAgKiB3cml0ZSBhY2Nlc3Mgc28gdGhhdCB3ZSBjYW4gcGVyZm9ybSBjb25jdXJy
ZW50IHJlYWQgb3BlcmF0aW9ucyBiZXR3ZWVuCj4gICAgKiB0aGUgQ1BVIGFuZCBHUFUgZW5naW5l
cywgYXMgd2VsbCBhcyB3YWl0aW5nIGZvciBhbGwgcmVuZGVyaW5nIHRvCj4gICAgKiBjb21wbGV0
ZSwgb3Igd2FpdGluZyBmb3IgdGhlIGxhc3QgR1BVIHVzZXIgb2YgYSAiZmVuY2UgcmVnaXN0ZXIi
LiBUaGUKPiAtICogb2JqZWN0IHRoZW4gZW1iZWRzIGEgI2k5MTVfYWN0aXZlX3JlcXVlc3QgdG8g
dHJhY2sgdGhlIG1vc3QgcmVjZW50IChpbgo+ICsgKiBvYmplY3QgdGhlbiBlbWJlZHMgYSAjaTkx
NV9hY3RpdmVfZmVuY2UgdG8gdHJhY2sgdGhlIG1vc3QgcmVjZW50IChpbgo+ICAgICogcmV0aXJl
bWVudCBvcmRlcikgcmVxdWVzdCByZWxldmFudCBmb3IgdGhlIGRlc2lyZWQgbW9kZSBvZiBhY2Nl
c3MuCj4gLSAqIFRoZSAjaTkxNV9hY3RpdmVfcmVxdWVzdCBpcyB1cGRhdGVkIHdpdGggaTkxNV9h
Y3RpdmVfcmVxdWVzdF9zZXQoKSB0bwo+ICsgKiBUaGUgI2k5MTVfYWN0aXZlX2ZlbmNlIGlzIHVw
ZGF0ZWQgd2l0aCBpOTE1X2FjdGl2ZV9mZW5jZV9zZXQoKSB0bwo+ICAgICogdHJhY2sgdGhlIG1v
c3QgcmVjZW50IGZlbmNlIHJlcXVlc3QsIHR5cGljYWxseSB0aGlzIGlzIGRvbmUgYXMgcGFydCBv
Zgo+ICAgICogaTkxNV92bWFfbW92ZV90b19hY3RpdmUoKS4KPiAgICAqCj4gLSAqIFdoZW4gdGhl
ICNpOTE1X2FjdGl2ZV9yZXF1ZXN0IGNvbXBsZXRlcyAoaXMgcmV0aXJlZCksIGl0IHdpbGwKPiAr
ICogV2hlbiB0aGUgI2k5MTVfYWN0aXZlX2ZlbmNlIGNvbXBsZXRlcyAoaXMgcmV0aXJlZCksIGl0
IHdpbGwKPiAgICAqIHNpZ25hbCBpdHMgY29tcGxldGlvbiB0byB0aGUgb3duZXIgdGhyb3VnaCBh
IGNhbGxiYWNrIGFzIHdlbGwgYXMgbWFyawo+IC0gKiBpdHNlbGYgYXMgaWRsZSAoaTkxNV9hY3Rp
dmVfcmVxdWVzdC5yZXF1ZXN0ID09IE5VTEwpLiBUaGUgb3duZXIKPiArICogaXRzZWxmIGFzIGlk
bGUgKGk5MTVfYWN0aXZlX2ZlbmNlLnJlcXVlc3QgPT0gTlVMTCkuIFRoZSBvd25lcgo+ICAgICog
Y2FuIHRoZW4gcGVyZm9ybSBhbnkgYWN0aW9uLCBzdWNoIGFzIGRlbGF5ZWQgZnJlZWluZyBvZiBh
biBhY3RpdmUKPiAgICAqIHJlc291cmNlIGluY2x1ZGluZyBpdHNlbGYuCj4gICAgKi8KPiAgIAo+
IC12b2lkIGk5MTVfYWN0aXZlX3JldGlyZV9ub29wKHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0
ICphY3RpdmUsCj4gLQkJCSAgICAgc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCk7Cj4gK3Zv
aWQgaTkxNV9hY3RpdmVfbm9vcChzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSwgc3RydWN0IGRtYV9m
ZW5jZV9jYiAqY2IpOwo+ICAgCj4gICAvKioKPiAtICogaTkxNV9hY3RpdmVfcmVxdWVzdF9pbml0
IC0gcHJlcGFyZXMgdGhlIGFjdGl2aXR5IHRyYWNrZXIgZm9yIHVzZQo+ICsgKiBfX2k5MTVfYWN0
aXZlX2ZlbmNlX2luaXQgLSBwcmVwYXJlcyB0aGUgYWN0aXZpdHkgdHJhY2tlciBmb3IgdXNlCj4g
ICAgKiBAYWN0aXZlIC0gdGhlIGFjdGl2ZSB0cmFja2VyCj4gLSAqIEBycSAtIGluaXRpYWwgcmVx
dWVzdCB0byB0cmFjaywgY2FuIGJlIE5VTEwKPiArICogQGZlbmNlIC0gaW5pdGlhbCBmZW5jZSB0
byB0cmFjaywgY2FuIGJlIE5VTEwKPiAgICAqIEBmdW5jIC0gYSBjYWxsYmFjayB3aGVuIHRoZW4g
dGhlIHRyYWNrZXIgaXMgcmV0aXJlZCAoYmVjb21lcyBpZGxlKSwKPiAgICAqICAgICAgICAgY2Fu
IGJlIE5VTEwKPiAgICAqCj4gLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3RfaW5pdCgpIHByZXBhcmVz
IHRoZSBlbWJlZGRlZCBAYWN0aXZlIHN0cnVjdCBmb3IgdXNlIGFzCj4gLSAqIGFuIGFjdGl2aXR5
IHRyYWNrZXIsIHRoYXQgaXMgZm9yIHRyYWNraW5nIHRoZSBsYXN0IGtub3duIGFjdGl2ZSByZXF1
ZXN0Cj4gLSAqIGFzc29jaWF0ZWQgd2l0aCBpdC4gV2hlbiB0aGUgbGFzdCByZXF1ZXN0IGJlY29t
ZXMgaWRsZSwgd2hlbiBpdCBpcyByZXRpcmVkCj4gKyAqIGk5MTVfYWN0aXZlX2ZlbmNlX2luaXQo
KSBwcmVwYXJlcyB0aGUgZW1iZWRkZWQgQGFjdGl2ZSBzdHJ1Y3QgZm9yIHVzZSBhcwo+ICsgKiBh
biBhY3Rpdml0eSB0cmFja2VyLCB0aGF0IGlzIGZvciB0cmFja2luZyB0aGUgbGFzdCBrbm93biBh
Y3RpdmUgZmVuY2UKPiArICogYXNzb2NpYXRlZCB3aXRoIGl0LiBXaGVuIHRoZSBsYXN0IGZlbmNl
IGJlY29tZXMgaWRsZSwgd2hlbiBpdCBpcyByZXRpcmVkCj4gICAgKiBhZnRlciBjb21wbGV0aW9u
LCB0aGUgb3B0aW9uYWwgY2FsbGJhY2sgQGZ1bmMgaXMgaW52b2tlZC4KPiAgICAqLwo+ICAgc3Rh
dGljIGlubGluZSB2b2lkCj4gLWk5MTVfYWN0aXZlX3JlcXVlc3RfaW5pdChzdHJ1Y3QgaTkxNV9h
Y3RpdmVfcmVxdWVzdCAqYWN0aXZlLAo+ICtfX2k5MTVfYWN0aXZlX2ZlbmNlX2luaXQoc3RydWN0
IGk5MTVfYWN0aXZlX2ZlbmNlICphY3RpdmUsCj4gICAJCQkgc3RydWN0IG11dGV4ICpsb2NrLAo+
IC0JCQkgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCj4gLQkJCSBpOTE1X2FjdGl2ZV9yZXRpcmVf
Zm4gcmV0aXJlKQo+ICsJCQkgdm9pZCAqZmVuY2UsCj4gKwkJCSBkbWFfZmVuY2VfZnVuY190IGZu
KQo+ICAgewo+IC0JUkNVX0lOSVRfUE9JTlRFUihhY3RpdmUtPnJlcXVlc3QsIHJxKTsKPiAtCUlO
SVRfTElTVF9IRUFEKCZhY3RpdmUtPmxpbmspOwo+IC0JYWN0aXZlLT5yZXRpcmUgPSByZXRpcmUg
PzogaTkxNV9hY3RpdmVfcmV0aXJlX25vb3A7Cj4gKwlSQ1VfSU5JVF9QT0lOVEVSKGFjdGl2ZS0+
ZmVuY2UsIGZlbmNlKTsKPiArCWFjdGl2ZS0+Y2IuZnVuYyA9IGZuID86IGk5MTVfYWN0aXZlX25v
b3A7Cj4gICAjaWYgSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfREVCVUdfR0VNKQo+ICAgCWFj
dGl2ZS0+bG9jayA9IGxvY2s7Cj4gICAjZW5kaWYKPiAgIH0KPiAgIAo+IC0jZGVmaW5lIElOSVRf
QUNUSVZFX1JFUVVFU1QobmFtZSwgbG9jaykgXAo+IC0JaTkxNV9hY3RpdmVfcmVxdWVzdF9pbml0
KChuYW1lKSwgKGxvY2spLCBOVUxMLCBOVUxMKQo+IC0KPiAtLyoqCj4gLSAqIGk5MTVfYWN0aXZl
X3JlcXVlc3Rfc2V0IC0gdXBkYXRlcyB0aGUgdHJhY2tlciB0byB3YXRjaCB0aGUgY3VycmVudCBy
ZXF1ZXN0Cj4gLSAqIEBhY3RpdmUgLSB0aGUgYWN0aXZlIHRyYWNrZXIKPiAtICogQHJlcXVlc3Qg
LSB0aGUgcmVxdWVzdCB0byB3YXRjaAo+IC0gKgo+IC0gKiBfX2k5MTVfYWN0aXZlX3JlcXVlc3Rf
c2V0KCkgd2F0Y2hlcyB0aGUgZ2l2ZW4gQHJlcXVlc3QgZm9yIGNvbXBsZXRpb24uIFdoaWxzdAo+
IC0gKiB0aGF0IEByZXF1ZXN0IGlzIGJ1c3ksIHRoZSBAYWN0aXZlIHJlcG9ydHMgYnVzeS4gV2hl
biB0aGF0IEByZXF1ZXN0IGlzCj4gLSAqIHJldGlyZWQsIHRoZSBAYWN0aXZlIHRyYWNrZXIgaXMg
dXBkYXRlZCB0byByZXBvcnQgaWRsZS4KPiAtICovCj4gLXN0YXRpYyBpbmxpbmUgdm9pZAo+IC1f
X2k5MTVfYWN0aXZlX3JlcXVlc3Rfc2V0KHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3Rp
dmUsCj4gLQkJCSAgc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCkKPiAtewo+IC0jaWYgSVNf
RU5BQkxFRChDT05GSUdfRFJNX0k5MTVfREVCVUdfR0VNKQo+IC0JbG9ja2RlcF9hc3NlcnRfaGVs
ZChhY3RpdmUtPmxvY2spOwo+IC0jZW5kaWYKPiAtCWxpc3RfbW92ZSgmYWN0aXZlLT5saW5rLCAm
cmVxdWVzdC0+YWN0aXZlX2xpc3QpOwo+IC0JcmN1X2Fzc2lnbl9wb2ludGVyKGFjdGl2ZS0+cmVx
dWVzdCwgcmVxdWVzdCk7Cj4gLX0KPiArI2RlZmluZSBJTklUX0FDVElWRV9GRU5DRShBLCBMT0NL
KSBcCj4gKwlfX2k5MTVfYWN0aXZlX2ZlbmNlX2luaXQoKEEpLCAoTE9DSyksIE5VTEwsIE5VTEwp
Cj4gICAKPiAtaW50IF9fbXVzdF9jaGVjawo+IC1pOTE1X2FjdGl2ZV9yZXF1ZXN0X3NldChzdHJ1
Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlLAo+IC0JCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0
ICpycSk7Cj4gK3N0cnVjdCBkbWFfZmVuY2UgKgo+ICtfX2k5MTVfYWN0aXZlX2ZlbmNlX3NldChz
dHJ1Y3QgaTkxNV9hY3RpdmVfZmVuY2UgKmFjdGl2ZSwKPiArCQkJc3RydWN0IGRtYV9mZW5jZSAq
ZmVuY2UpOwo+ICAgCj4gICAvKioKPiAtICogaTkxNV9hY3RpdmVfcmVxdWVzdF9yYXcgLSByZXR1
cm4gdGhlIGFjdGl2ZSByZXF1ZXN0Cj4gKyAqIGk5MTVfYWN0aXZlX2ZlbmNlX3NldCAtIHVwZGF0
ZXMgdGhlIHRyYWNrZXIgdG8gd2F0Y2ggdGhlIGN1cnJlbnQgZmVuY2UKPiAgICAqIEBhY3RpdmUg
LSB0aGUgYWN0aXZlIHRyYWNrZXIKPiArICogQHJxIC0gdGhlIHJlcXVlc3QgdG8gd2F0Y2gKPiAg
ICAqCj4gLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3RfcmF3KCkgcmV0dXJucyB0aGUgY3VycmVudCBy
ZXF1ZXN0IGJlaW5nIHRyYWNrZWQsIG9yIE5VTEwuCj4gLSAqIEl0IGRvZXMgbm90IG9idGFpbiBh
IHJlZmVyZW5jZSBvbiB0aGUgcmVxdWVzdCBmb3IgdGhlIGNhbGxlciwgc28gdGhlIGNhbGxlcgo+
IC0gKiBtdXN0IGhvbGQgc3RydWN0X211dGV4Lgo+ICsgKiBpOTE1X2FjdGl2ZV9mZW5jZV9zZXQo
KSB3YXRjaGVzIHRoZSBnaXZlbiBAcnEgZm9yIGNvbXBsZXRpb24uIFdoaWxlCj4gKyAqIHRoYXQg
QHJxIGlzIGJ1c3ksIHRoZSBAYWN0aXZlIHJlcG9ydHMgYnVzeS4gV2hlbiB0aGF0IEBycSBpcyBz
aWduYWxlZAo+ICsgKiAob3IgZWxzZSByZXRpcmVkKSB0aGUgQGFjdGl2ZSB0cmFja2VyIGlzIHVw
ZGF0ZWQgdG8gcmVwb3J0IGlkbGUuCj4gICAgKi8KPiAtc3RhdGljIGlubGluZSBzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICoKPiAtaTkxNV9hY3RpdmVfcmVxdWVzdF9yYXcoY29uc3Qgc3RydWN0IGk5MTVf
YWN0aXZlX3JlcXVlc3QgKmFjdGl2ZSwKPiAtCQkJc3RydWN0IG11dGV4ICptdXRleCkKPiAtewo+
IC0JcmV0dXJuIHJjdV9kZXJlZmVyZW5jZV9wcm90ZWN0ZWQoYWN0aXZlLT5yZXF1ZXN0LAo+IC0J
CQkJCSBsb2NrZGVwX2lzX2hlbGQobXV0ZXgpKTsKPiAtfQo+IC0KPiAtLyoqCj4gLSAqIGk5MTVf
YWN0aXZlX3JlcXVlc3RfcGVlayAtIHJlcG9ydCB0aGUgYWN0aXZlIHJlcXVlc3QgYmVpbmcgbW9u
aXRvcmVkCj4gLSAqIEBhY3RpdmUgLSB0aGUgYWN0aXZlIHRyYWNrZXIKPiAtICoKPiAtICogaTkx
NV9hY3RpdmVfcmVxdWVzdF9wZWVrKCkgcmV0dXJucyB0aGUgY3VycmVudCByZXF1ZXN0IGJlaW5n
IHRyYWNrZWQgaWYKPiAtICogc3RpbGwgYWN0aXZlLCBvciBOVUxMLiBJdCBkb2VzIG5vdCBvYnRh
aW4gYSByZWZlcmVuY2Ugb24gdGhlIHJlcXVlc3QKPiAtICogZm9yIHRoZSBjYWxsZXIsIHNvIHRo
ZSBjYWxsZXIgbXVzdCBob2xkIHN0cnVjdF9tdXRleC4KPiAtICovCj4gLXN0YXRpYyBpbmxpbmUg
c3RydWN0IGk5MTVfcmVxdWVzdCAqCj4gLWk5MTVfYWN0aXZlX3JlcXVlc3RfcGVlayhjb25zdCBz
dHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlLAo+IC0JCQkgc3RydWN0IG11dGV4ICpt
dXRleCkKPiAtewo+IC0Jc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdDsKPiAtCj4gLQlyZXF1
ZXN0ID0gaTkxNV9hY3RpdmVfcmVxdWVzdF9yYXcoYWN0aXZlLCBtdXRleCk7Cj4gLQlpZiAoIXJl
cXVlc3QgfHwgaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChyZXF1ZXN0KSkKPiAtCQlyZXR1cm4gTlVM
TDsKPiAtCj4gLQlyZXR1cm4gcmVxdWVzdDsKPiAtfQo+IC0KPiAtLyoqCj4gLSAqIGk5MTVfYWN0
aXZlX3JlcXVlc3RfZ2V0IC0gcmV0dXJuIGEgcmVmZXJlbmNlIHRvIHRoZSBhY3RpdmUgcmVxdWVz
dAo+IC0gKiBAYWN0aXZlIC0gdGhlIGFjdGl2ZSB0cmFja2VyCj4gLSAqCj4gLSAqIGk5MTVfYWN0
aXZlX3JlcXVlc3RfZ2V0KCkgcmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgYWN0aXZlIHJlcXVl
c3QsIG9yIE5VTEwKPiAtICogaWYgdGhlIGFjdGl2ZSB0cmFja2VyIGlzIGlkbGUuIFRoZSBjYWxs
ZXIgbXVzdCBob2xkIHN0cnVjdF9tdXRleC4KPiAtICovCj4gLXN0YXRpYyBpbmxpbmUgc3RydWN0
IGk5MTVfcmVxdWVzdCAqCj4gLWk5MTVfYWN0aXZlX3JlcXVlc3RfZ2V0KGNvbnN0IHN0cnVjdCBp
OTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUsCj4gLQkJCXN0cnVjdCBtdXRleCAqbXV0ZXgpCj4g
LXsKPiAtCXJldHVybiBpOTE1X3JlcXVlc3RfZ2V0KGk5MTVfYWN0aXZlX3JlcXVlc3RfcGVlayhh
Y3RpdmUsIG11dGV4KSk7Cj4gLX0KPiAtCj4gLS8qKgo+IC0gKiBfX2k5MTVfYWN0aXZlX3JlcXVl
c3RfZ2V0X3JjdSAtIHJldHVybiBhIHJlZmVyZW5jZSB0byB0aGUgYWN0aXZlIHJlcXVlc3QKPiAt
ICogQGFjdGl2ZSAtIHRoZSBhY3RpdmUgdHJhY2tlcgo+IC0gKgo+IC0gKiBfX2k5MTVfYWN0aXZl
X3JlcXVlc3RfZ2V0KCkgcmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgYWN0aXZlIHJlcXVlc3Qs
Cj4gLSAqIG9yIE5VTEwgaWYgdGhlIGFjdGl2ZSB0cmFja2VyIGlzIGlkbGUuIFRoZSBjYWxsZXIg
bXVzdCBob2xkIHRoZSBSQ1UgcmVhZAo+IC0gKiBsb2NrLCBidXQgdGhlIHJldHVybmVkIHBvaW50
ZXIgaXMgc2FmZSB0byB1c2Ugb3V0c2lkZSBvZiBSQ1UuCj4gLSAqLwo+IC1zdGF0aWMgaW5saW5l
IHN0cnVjdCBpOTE1X3JlcXVlc3QgKgo+IC1fX2k5MTVfYWN0aXZlX3JlcXVlc3RfZ2V0X3JjdShj
b25zdCBzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlKQo+IC17Cj4gLQkvKgo+IC0J
ICogUGVyZm9ybWluZyBhIGxvY2tsZXNzIHJldHJpZXZhbCBvZiB0aGUgYWN0aXZlIHJlcXVlc3Qg
aXMgc3VwZXIKPiAtCSAqIHRyaWNreS4gU0xBQl9UWVBFU0FGRV9CWV9SQ1UgbWVyZWx5IGd1YXJh
bnRlZXMgdGhhdCB0aGUgYmFja2luZwo+IC0JICogc2xhYiBvZiByZXF1ZXN0IG9iamVjdHMgd2ls
bCBub3QgYmUgZnJlZWQgd2hpbHN0IHdlIGhvbGQgdGhlCj4gLQkgKiBSQ1UgcmVhZCBsb2NrLiBJ
dCBkb2VzIG5vdCBndWFyYW50ZWUgdGhhdCB0aGUgcmVxdWVzdCBpdHNlbGYKPiAtCSAqIHdpbGwg
bm90IGJlIGZyZWVkIGFuZCB0aGVuICpyZXVzZWQqLiBWaXosCj4gLQkgKgo+IC0JICogVGhyZWFk
IEEJCQlUaHJlYWQgQgo+IC0JICoKPiAtCSAqIHJxID0gYWN0aXZlLnJlcXVlc3QKPiAtCSAqCQkJ
CXJldGlyZShycSkgLT4gZnJlZShycSk7Cj4gLQkgKgkJCQkocnEgaXMgbm93IGZpcnN0IG9uIHRo
ZSBzbGFiIGZyZWVsaXN0KQo+IC0JICoJCQkJYWN0aXZlLnJlcXVlc3QgPSBOVUxMCj4gLQkgKgo+
IC0JICoJCQkJcnEgPSBuZXcgc3VibWlzc2lvbiBvbiBhIG5ldyBvYmplY3QKPiAtCSAqIHJlZihy
cSkKPiAtCSAqCj4gLQkgKiBUbyBwcmV2ZW50IHRoZSByZXF1ZXN0IGZyb20gYmVpbmcgcmV1c2Vk
IHdoaWxzdCB0aGUgY2FsbGVyCj4gLQkgKiB1c2VzIGl0LCB3ZSB0YWtlIGEgcmVmZXJlbmNlIGxp
a2Ugbm9ybWFsLiBXaGlsc3QgYWNxdWlyaW5nCj4gLQkgKiB0aGUgcmVmZXJlbmNlIHdlIGNoZWNr
IHRoYXQgaXQgaXMgbm90IGluIGEgZGVzdHJveWVkIHN0YXRlCj4gLQkgKiAocmVmY250ID09IDAp
LiBUaGF0IHByZXZlbnRzIHRoZSByZXF1ZXN0IGJlaW5nIHJlYWxsb2NhdGVkCj4gLQkgKiB3aGls
c3QgdGhlIGNhbGxlciBob2xkcyBvbiB0byBpdC4gVG8gY2hlY2sgdGhhdCB0aGUgcmVxdWVzdAo+
IC0JICogd2FzIG5vdCByZWFsbG9jYXRlZCBhcyB3ZSBhY3F1aXJlZCB0aGUgcmVmZXJlbmNlIHdl
IGhhdmUgdG8KPiAtCSAqIGNoZWNrIHRoYXQgb3VyIHJlcXVlc3QgcmVtYWlucyB0aGUgYWN0aXZl
IHJlcXVlc3QgYWNyb3NzCj4gLQkgKiB0aGUgbG9va3VwLCBpbiB0aGUgc2FtZSBtYW5uZXIgYXMg
YSBzZXFsb2NrLiBUaGUgdmlzaWJpbGl0eQo+IC0JICogb2YgdGhlIHBvaW50ZXIgdmVyc3VzIHRo
ZSByZWZlcmVuY2UgY291bnRpbmcgaXMgY29udHJvbGxlZAo+IC0JICogYnkgdXNpbmcgUkNVIGJh
cnJpZXJzIChyY3VfZGVyZWZlcmVuY2UgYW5kIHJjdV9hc3NpZ25fcG9pbnRlcikuCj4gLQkgKgo+
IC0JICogSW4gdGhlIG1pZGRsZSBvZiBhbGwgdGhhdCwgd2UgaW5zcGVjdCB3aGV0aGVyIHRoZSBy
ZXF1ZXN0IGlzCj4gLQkgKiBjb21wbGV0ZS4gUmV0aXJpbmcgaXMgbGF6eSBzbyB0aGUgcmVxdWVz
dCBtYXkgYmUgY29tcGxldGVkIGxvbmcKPiAtCSAqIGJlZm9yZSB0aGUgYWN0aXZlIHRyYWNrZXIg
aXMgdXBkYXRlZC4gUXVlcnlpbmcgd2hldGhlciB0aGUKPiAtCSAqIHJlcXVlc3QgaXMgY29tcGxl
dGUgaXMgZmFyIGNoZWFwZXIgKGFzIGl0IGludm9sdmVzIG5vIGxvY2tlZAo+IC0JICogaW5zdHJ1
Y3Rpb25zIHNldHRpbmcgY2FjaGVsaW5lcyB0byBleGNsdXNpdmUpIHRoYW4gYWNxdWlyaW5nCj4g
LQkgKiB0aGUgcmVmZXJlbmNlLCBzbyB3ZSBkbyBpdCBmaXJzdC4gVGhlIFJDVSByZWFkIGxvY2sg
ZW5zdXJlcyB0aGUKPiAtCSAqIHBvaW50ZXIgZGVyZWZlcmVuY2UgaXMgdmFsaWQsIGJ1dCBkb2Vz
IG5vdCBlbnN1cmUgdGhhdCB0aGUKPiAtCSAqIHNlcW5vIG5vciBIV1MgaXMgdGhlIHJpZ2h0IG9u
ZSEgSG93ZXZlciwgaWYgdGhlIHJlcXVlc3Qgd2FzCj4gLQkgKiByZWFsbG9jYXRlZCwgdGhhdCBt
ZWFucyB0aGUgYWN0aXZlIHRyYWNrZXIncyByZXF1ZXN0IHdhcyBjb21wbGV0ZS4KPiAtCSAqIElm
IHRoZSBuZXcgcmVxdWVzdCBpcyBhbHNvIGNvbXBsZXRlLCB0aGVuIGJvdGggYXJlIGFuZCB3ZSBj
YW4KPiAtCSAqIGp1c3QgcmVwb3J0IHRoZSBhY3RpdmUgdHJhY2tlciBpcyBpZGxlLiBJZiB0aGUg
bmV3IHJlcXVlc3QgaXMKPiAtCSAqIGluY29tcGxldGUsIHRoZW4gd2UgYWNxdWlyZSBhIHJlZmVy
ZW5jZSBvbiBpdCBhbmQgY2hlY2sgdGhhdAo+IC0JICogaXQgcmVtYWluZWQgdGhlIGFjdGl2ZSBy
ZXF1ZXN0Lgo+IC0JICoKPiAtCSAqIEl0IGlzIHRoZW4gaW1wZXJhdGl2ZSB0aGF0IHdlIGRvIG5v
dCB6ZXJvIHRoZSByZXF1ZXN0IG9uCj4gLQkgKiByZWFsbG9jYXRpb24sIHNvIHRoYXQgd2UgY2Fu
IGNoYXNlIHRoZSBkYW5nbGluZyBwb2ludGVycyEKPiAtCSAqIFNlZSBpOTE1X3JlcXVlc3RfYWxs
b2MoKS4KPiAtCSAqLwo+IC0JZG8gewo+IC0JCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3Q7
Cj4gLQo+IC0JCXJlcXVlc3QgPSByY3VfZGVyZWZlcmVuY2UoYWN0aXZlLT5yZXF1ZXN0KTsKPiAt
CQlpZiAoIXJlcXVlc3QgfHwgaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChyZXF1ZXN0KSkKPiAtCQkJ
cmV0dXJuIE5VTEw7Cj4gLQo+IC0JCS8qCj4gLQkJICogQW4gZXNwZWNpYWxseSBzaWxseSBjb21w
aWxlciBjb3VsZCBkZWNpZGUgdG8gcmVjb21wdXRlIHRoZQo+IC0JCSAqIHJlc3VsdCBvZiBpOTE1
X3JlcXVlc3RfY29tcGxldGVkLCBtb3JlIHNwZWNpZmljYWxseQo+IC0JCSAqIHJlLWVtaXQgdGhl
IGxvYWQgZm9yIHJlcXVlc3QtPmZlbmNlLnNlcW5vLiBBIHJhY2Ugd291bGQgY2F0Y2gKPiAtCQkg
KiBhIGxhdGVyIHNlcW5vIHZhbHVlLCB3aGljaCBjb3VsZCBmbGlwIHRoZSByZXN1bHQgZnJvbSB0
cnVlIHRvCj4gLQkJICogZmFsc2UuIFdoaWNoIG1lYW5zIHBhcnQgb2YgdGhlIGluc3RydWN0aW9u
cyBiZWxvdyBtaWdodCBub3QKPiAtCQkgKiBiZSBleGVjdXRlZCwgd2hpbGUgbGF0ZXIgb24gaW5z
dHJ1Y3Rpb25zIGFyZSBleGVjdXRlZC4gRHVlIHRvCj4gLQkJICogYmFycmllcnMgd2l0aGluIHRo
ZSByZWZjb3VudGluZyB0aGUgaW5jb25zaXN0ZW5jeSBjYW4ndCByZWFjaAo+IC0JCSAqIHBhc3Qg
dGhlIGNhbGwgdG8gaTkxNV9yZXF1ZXN0X2dldF9yY3UsIGJ1dCBub3QgZXhlY3V0aW5nCj4gLQkJ
ICogdGhhdCB3aGlsZSBzdGlsbCBleGVjdXRpbmcgaTkxNV9yZXF1ZXN0X3B1dCgpIGNyZWF0ZXMK
PiAtCQkgKiBoYXZvYyBlbm91Z2guICBQcmV2ZW50IHRoaXMgd2l0aCBhIGNvbXBpbGVyIGJhcnJp
ZXIuCj4gLQkJICovCj4gLQkJYmFycmllcigpOwo+IC0KPiAtCQlyZXF1ZXN0ID0gaTkxNV9yZXF1
ZXN0X2dldF9yY3UocmVxdWVzdCk7Cj4gLQo+IC0JCS8qCj4gLQkJICogV2hhdCBzdG9wcyB0aGUg
Zm9sbG93aW5nIHJjdV9hY2Nlc3NfcG9pbnRlcigpIGZyb20gb2NjdXJyaW5nCj4gLQkJICogYmVm
b3JlIHRoZSBhYm92ZSBpOTE1X3JlcXVlc3RfZ2V0X3JjdSgpPyBJZiB3ZSB3ZXJlCj4gLQkJICog
dG8gcmVhZCB0aGUgdmFsdWUgYmVmb3JlIHBhdXNpbmcgdG8gZ2V0IHRoZSByZWZlcmVuY2UgdG8K
PiAtCQkgKiB0aGUgcmVxdWVzdCwgd2UgbWF5IG5vdCBub3RpY2UgYSBjaGFuZ2UgaW4gdGhlIGFj
dGl2ZQo+IC0JCSAqIHRyYWNrZXIuCj4gLQkJICoKPiAtCQkgKiBUaGUgcmN1X2FjY2Vzc19wb2lu
dGVyKCkgaXMgYSBtZXJlIGNvbXBpbGVyIGJhcnJpZXIsIHdoaWNoCj4gLQkJICogbWVhbnMgYm90
aCB0aGUgQ1BVIGFuZCBjb21waWxlciBhcmUgZnJlZSB0byBwZXJmb3JtIHRoZQo+IC0JCSAqIG1l
bW9yeSByZWFkIHdpdGhvdXQgY29uc3RyYWludC4gVGhlIGNvbXBpbGVyIG9ubHkgaGFzIHRvCj4g
LQkJICogZW5zdXJlIHRoYXQgYW55IG9wZXJhdGlvbnMgYWZ0ZXIgdGhlIHJjdV9hY2Nlc3NfcG9p
bnRlcigpCj4gLQkJICogb2NjdXIgYWZ0ZXJ3YXJkcyBpbiBwcm9ncmFtIG9yZGVyLiBUaGlzIG1l
YW5zIHRoZSByZWFkIG1heQo+IC0JCSAqIGJlIHBlcmZvcm1lZCBlYXJsaWVyIGJ5IGFuIG91dC1v
Zi1vcmRlciBDUFUsIG9yIGFkdmVudHVyb3VzCj4gLQkJICogY29tcGlsZXIuCj4gLQkJICoKPiAt
CQkgKiBUaGUgYXRvbWljIG9wZXJhdGlvbiBhdCB0aGUgaGVhcnQgb2YKPiAtCQkgKiBpOTE1X3Jl
cXVlc3RfZ2V0X3JjdSgpLCBzZWUgZG1hX2ZlbmNlX2dldF9yY3UoKSwgaXMKPiAtCQkgKiBhdG9t
aWNfaW5jX25vdF96ZXJvKCkgd2hpY2ggaXMgb25seSBhIGZ1bGwgbWVtb3J5IGJhcnJpZXIKPiAt
CQkgKiB3aGVuIHN1Y2Nlc3NmdWwuIFRoYXQgaXMsIGlmIGk5MTVfcmVxdWVzdF9nZXRfcmN1KCkK
PiAtCQkgKiByZXR1cm5zIHRoZSByZXF1ZXN0IChhbmQgc28gd2l0aCB0aGUgcmVmZXJlbmNlIGNv
dW50ZWQKPiAtCQkgKiBpbmNyZW1lbnRlZCkgdGhlbiB0aGUgZm9sbG93aW5nIHJlYWQgZm9yIHJj
dV9hY2Nlc3NfcG9pbnRlcigpCj4gLQkJICogbXVzdCBvY2N1ciBhZnRlciB0aGUgYXRvbWljIG9w
ZXJhdGlvbiBhbmQgc28gY29uZmlybQo+IC0JCSAqIHRoYXQgdGhpcyByZXF1ZXN0IGlzIHRoZSBv
bmUgY3VycmVudGx5IGJlaW5nIHRyYWNrZWQuCj4gLQkJICoKPiAtCQkgKiBUaGUgY29ycmVzcG9u
ZGluZyB3cml0ZSBiYXJyaWVyIGlzIHBhcnQgb2YKPiAtCQkgKiByY3VfYXNzaWduX3BvaW50ZXIo
KS4KPiAtCQkgKi8KPiAtCQlpZiAoIXJlcXVlc3QgfHwgcmVxdWVzdCA9PSByY3VfYWNjZXNzX3Bv
aW50ZXIoYWN0aXZlLT5yZXF1ZXN0KSkKPiAtCQkJcmV0dXJuIHJjdV9wb2ludGVyX2hhbmRvZmYo
cmVxdWVzdCk7Cj4gLQo+IC0JCWk5MTVfcmVxdWVzdF9wdXQocmVxdWVzdCk7Cj4gLQl9IHdoaWxl
ICgxKTsKPiAtfQo+IC0KPiAraW50IF9fbXVzdF9jaGVjawo+ICtpOTE1X2FjdGl2ZV9mZW5jZV9z
ZXQoc3RydWN0IGk5MTVfYWN0aXZlX2ZlbmNlICphY3RpdmUsCj4gKwkJICAgICAgc3RydWN0IGk5
MTVfcmVxdWVzdCAqcnEpOwo+ICAgLyoqCj4gLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3RfZ2V0X3Vu
bG9ja2VkIC0gcmV0dXJuIGEgcmVmZXJlbmNlIHRvIHRoZSBhY3RpdmUgcmVxdWVzdAo+ICsgKiBp
OTE1X2FjdGl2ZV9mZW5jZV9nZXQgLSByZXR1cm4gYSByZWZlcmVuY2UgdG8gdGhlIGFjdGl2ZSBm
ZW5jZQo+ICAgICogQGFjdGl2ZSAtIHRoZSBhY3RpdmUgdHJhY2tlcgo+ICAgICoKPiAtICogaTkx
NV9hY3RpdmVfcmVxdWVzdF9nZXRfdW5sb2NrZWQoKSByZXR1cm5zIGEgcmVmZXJlbmNlIHRvIHRo
ZSBhY3RpdmUgcmVxdWVzdCwKPiArICogaTkxNV9hY3RpdmVfZmVuY2VfZ2V0KCkgcmV0dXJucyBh
IHJlZmVyZW5jZSB0byB0aGUgYWN0aXZlIGZlbmNlLAo+ICAgICogb3IgTlVMTCBpZiB0aGUgYWN0
aXZlIHRyYWNrZXIgaXMgaWRsZS4gVGhlIHJlZmVyZW5jZSBpcyBvYnRhaW5lZCB1bmRlciBSQ1Us
Cj4gICAgKiBzbyBubyBsb2NraW5nIGlzIHJlcXVpcmVkIGJ5IHRoZSBjYWxsZXIuCj4gICAgKgo+
IC0gKiBUaGUgcmVmZXJlbmNlIHNob3VsZCBiZSBmcmVlZCB3aXRoIGk5MTVfcmVxdWVzdF9wdXQo
KS4KPiArICogVGhlIHJlZmVyZW5jZSBzaG91bGQgYmUgZnJlZWQgd2l0aCBkbWFfZmVuY2VfcHV0
KCkuCj4gICAgKi8KPiAtc3RhdGljIGlubGluZSBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICoKPiAtaTkx
NV9hY3RpdmVfcmVxdWVzdF9nZXRfdW5sb2NrZWQoY29uc3Qgc3RydWN0IGk5MTVfYWN0aXZlX3Jl
cXVlc3QgKmFjdGl2ZSkKPiArc3RhdGljIGlubGluZSBzdHJ1Y3QgZG1hX2ZlbmNlICoKPiAraTkx
NV9hY3RpdmVfZmVuY2VfZ2V0KHN0cnVjdCBpOTE1X2FjdGl2ZV9mZW5jZSAqYWN0aXZlKQo+ICAg
ewo+IC0Jc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdDsKPiArCXN0cnVjdCBkbWFfZmVuY2Ug
KmZlbmNlOwo+ICAgCj4gICAJcmN1X3JlYWRfbG9jaygpOwo+IC0JcmVxdWVzdCA9IF9faTkxNV9h
Y3RpdmVfcmVxdWVzdF9nZXRfcmN1KGFjdGl2ZSk7Cj4gKwlmZW5jZSA9IGRtYV9mZW5jZV9nZXRf
cmN1X3NhZmUoJmFjdGl2ZS0+ZmVuY2UpOwo+ICAgCXJjdV9yZWFkX3VubG9jaygpOwo+ICAgCj4g
LQlyZXR1cm4gcmVxdWVzdDsKPiArCXJldHVybiBmZW5jZTsKPiAgIH0KPiAgIAo+ICAgLyoqCj4g
LSAqIGk5MTVfYWN0aXZlX3JlcXVlc3RfaXNzZXQgLSByZXBvcnQgd2hldGhlciB0aGUgYWN0aXZl
IHRyYWNrZXIgaXMgYXNzaWduZWQKPiArICogaTkxNV9hY3RpdmVfZmVuY2VfaXNzZXQgLSByZXBv
cnQgd2hldGhlciB0aGUgYWN0aXZlIHRyYWNrZXIgaXMgYXNzaWduZWQKPiAgICAqIEBhY3RpdmUg
LSB0aGUgYWN0aXZlIHRyYWNrZXIKPiAgICAqCj4gLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3RfaXNz
ZXQoKSByZXR1cm5zIHRydWUgaWYgdGhlIGFjdGl2ZSB0cmFja2VyIGlzIGN1cnJlbnRseQo+IC0g
KiBhc3NpZ25lZCB0byBhIHJlcXVlc3QuIER1ZSB0byB0aGUgbGF6eSByZXRpcmluZywgdGhhdCBy
ZXF1ZXN0IG1heSBiZSBpZGxlCj4gKyAqIGk5MTVfYWN0aXZlX2ZlbmNlX2lzc2V0KCkgcmV0dXJu
cyB0cnVlIGlmIHRoZSBhY3RpdmUgdHJhY2tlciBpcyBjdXJyZW50bHkKPiArICogYXNzaWduZWQg
dG8gYSBmZW5jZS4gRHVlIHRvIHRoZSBsYXp5IHJldGlyaW5nLCB0aGF0IGZlbmNlIG1heSBiZSBp
ZGxlCj4gICAgKiBhbmQgdGhpcyBtYXkgcmVwb3J0IHN0YWxlIGluZm9ybWF0aW9uLgo+ICAgICov
Cj4gICBzdGF0aWMgaW5saW5lIGJvb2wKPiAtaTkxNV9hY3RpdmVfcmVxdWVzdF9pc3NldChjb25z
dCBzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlKQo+ICtpOTE1X2FjdGl2ZV9mZW5j
ZV9pc3NldChjb25zdCBzdHJ1Y3QgaTkxNV9hY3RpdmVfZmVuY2UgKmFjdGl2ZSkKPiAgIHsKPiAt
CXJldHVybiByY3VfYWNjZXNzX3BvaW50ZXIoYWN0aXZlLT5yZXF1ZXN0KTsKPiArCXJldHVybiBy
Y3VfYWNjZXNzX3BvaW50ZXIoYWN0aXZlLT5mZW5jZSk7Cj4gICB9Cj4gICAKPiAtLyoqCj4gLSAq
IGk5MTVfYWN0aXZlX3JlcXVlc3RfcmV0aXJlIC0gd2FpdHMgdW50aWwgdGhlIHJlcXVlc3QgaXMg
cmV0aXJlZAo+IC0gKiBAYWN0aXZlIC0gdGhlIGFjdGl2ZSByZXF1ZXN0IG9uIHdoaWNoIHRvIHdh
aXQKPiAtICoKPiAtICogaTkxNV9hY3RpdmVfcmVxdWVzdF9yZXRpcmUoKSB3YWl0cyB1bnRpbCB0
aGUgcmVxdWVzdCBpcyBjb21wbGV0ZWQsCj4gLSAqIGFuZCB0aGVuIGVuc3VyZXMgdGhhdCBhdCBs
ZWFzdCB0aGUgcmV0aXJlbWVudCBoYW5kbGVyIGZvciB0aGlzCj4gLSAqIEBhY3RpdmUgdHJhY2tl
ciBpcyBjYWxsZWQgYmVmb3JlIHJldHVybmluZy4gSWYgdGhlIEBhY3RpdmUKPiAtICogdHJhY2tl
ciBpcyBpZGxlLCB0aGUgZnVuY3Rpb24gcmV0dXJucyBpbW1lZGlhdGVseS4KPiAtICovCj4gLXN0
YXRpYyBpbmxpbmUgaW50IF9fbXVzdF9jaGVjawo+IC1pOTE1X2FjdGl2ZV9yZXF1ZXN0X3JldGly
ZShzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlLAo+IC0JCQkgICBzdHJ1Y3QgbXV0
ZXggKm11dGV4KQo+ICtzdGF0aWMgaW5saW5lIHZvaWQKPiAraTkxNV9hY3RpdmVfZmVuY2VfY2Io
c3RydWN0IGRtYV9mZW5jZSAqZmVuY2UsIHN0cnVjdCBkbWFfZmVuY2VfY2IgKmNiKQo+ICAgewo+
IC0Jc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdDsKPiAtCWxvbmcgcmV0Owo+IC0KPiAtCXJl
cXVlc3QgPSBpOTE1X2FjdGl2ZV9yZXF1ZXN0X3JhdyhhY3RpdmUsIG11dGV4KTsKPiAtCWlmICgh
cmVxdWVzdCkKPiAtCQlyZXR1cm4gMDsKPiAtCj4gLQlyZXQgPSBpOTE1X3JlcXVlc3Rfd2FpdChy
ZXF1ZXN0LAo+IC0JCQkJSTkxNV9XQUlUX0lOVEVSUlVQVElCTEUsCj4gLQkJCQlNQVhfU0NIRURV
TEVfVElNRU9VVCk7Cj4gLQlpZiAocmV0IDwgMCkKPiAtCQlyZXR1cm4gcmV0Owo+ICsJc3RydWN0
IGk5MTVfYWN0aXZlX2ZlbmNlICphY3RpdmUgPQo+ICsJCWNvbnRhaW5lcl9vZihjYiwgdHlwZW9m
KCphY3RpdmUpLCBjYik7Cj4gICAKPiAtCWxpc3RfZGVsX2luaXQoJmFjdGl2ZS0+bGluayk7Cj4g
LQlSQ1VfSU5JVF9QT0lOVEVSKGFjdGl2ZS0+cmVxdWVzdCwgTlVMTCk7Cj4gLQo+IC0JYWN0aXZl
LT5yZXRpcmUoYWN0aXZlLCByZXF1ZXN0KTsKPiAtCj4gLQlyZXR1cm4gMDsKPiArCVJDVV9JTklU
X1BPSU5URVIoYWN0aXZlLT5mZW5jZSwgTlVMTCk7Cj4gICB9Cj4gICAKPiAgIC8qCj4gQEAgLTM1
OCw0NyArMTYyLDQwIEBAIGk5MTVfYWN0aXZlX3JlcXVlc3RfcmV0aXJlKHN0cnVjdCBpOTE1X2Fj
dGl2ZV9yZXF1ZXN0ICphY3RpdmUsCj4gICAgKiBzeW5jaHJvbmlzYXRpb24uCj4gICAgKi8KPiAg
IAo+IC12b2lkIF9faTkxNV9hY3RpdmVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiAtCQkJc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsCj4gK3ZvaWQgX19pOTE1X2FjdGl2ZV9p
bml0KHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLAo+ICAgCQkJaW50ICgqYWN0aXZlKShzdHJ1Y3Qg
aTkxNV9hY3RpdmUgKnJlZiksCj4gICAJCQl2b2lkICgqcmV0aXJlKShzdHJ1Y3QgaTkxNV9hY3Rp
dmUgKnJlZiksCj4gICAJCQlzdHJ1Y3QgbG9ja19jbGFzc19rZXkgKmtleSk7Cj4gLSNkZWZpbmUg
aTkxNV9hY3RpdmVfaW5pdChpOTE1LCByZWYsIGFjdGl2ZSwgcmV0aXJlKSBkbyB7CQlcCj4gKyNk
ZWZpbmUgaTkxNV9hY3RpdmVfaW5pdChyZWYsIGFjdGl2ZSwgcmV0aXJlKSBkbyB7CQlcCj4gICAJ
c3RhdGljIHN0cnVjdCBsb2NrX2NsYXNzX2tleSBfX2tleTsJCQkJXAo+ICAgCQkJCQkJCQkJXAo+
IC0JX19pOTE1X2FjdGl2ZV9pbml0KGk5MTUsIHJlZiwgYWN0aXZlLCByZXRpcmUsICZfX2tleSk7
CQlcCj4gKwlfX2k5MTVfYWN0aXZlX2luaXQocmVmLCBhY3RpdmUsIHJldGlyZSwgJl9fa2V5KTsJ
CVwKPiAgIH0gd2hpbGUgKDApCj4gICAKPiAgIGludCBpOTE1X2FjdGl2ZV9yZWYoc3RydWN0IGk5
MTVfYWN0aXZlICpyZWYsCj4gICAJCSAgICBzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRsLAo+IC0J
CSAgICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSk7Cj4gKwkJICAgIHN0cnVjdCBkbWFfZmVuY2Ug
KmZlbmNlKTsKPiAgIAo+ICAgc3RhdGljIGlubGluZSBpbnQKPiAgIGk5MTVfYWN0aXZlX2FkZF9y
ZXF1ZXN0KHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkK
PiAgIHsKPiAtCXJldHVybiBpOTE1X2FjdGl2ZV9yZWYocmVmLCBpOTE1X3JlcXVlc3RfdGltZWxp
bmUocnEpLCBycSk7Cj4gKwlyZXR1cm4gaTkxNV9hY3RpdmVfcmVmKHJlZiwgaTkxNV9yZXF1ZXN0
X3RpbWVsaW5lKHJxKSwgJnJxLT5mZW5jZSk7Cj4gICB9Cj4gICAKPiAgIHZvaWQgaTkxNV9hY3Rp
dmVfc2V0X2V4Y2x1c2l2ZShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwgc3RydWN0IGRtYV9mZW5j
ZSAqZik7Cj4gICAKPiAgIHN0YXRpYyBpbmxpbmUgYm9vbCBpOTE1X2FjdGl2ZV9oYXNfZXhjbHVz
aXZlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQo+ICAgewo+IC0JcmV0dXJuIHJjdV9hY2Nlc3Nf
cG9pbnRlcihyZWYtPmV4Y2wpOwo+ICsJcmV0dXJuIHJjdV9hY2Nlc3NfcG9pbnRlcihyZWYtPmV4
Y2wuZmVuY2UpOwo+ICAgfQo+ICAgCj4gICBpbnQgaTkxNV9hY3RpdmVfd2FpdChzdHJ1Y3QgaTkx
NV9hY3RpdmUgKnJlZik7Cj4gICAKPiAtaW50IGk5MTVfcmVxdWVzdF9hd2FpdF9hY3RpdmUoc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnEsCj4gLQkJCSAgICAgIHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVm
KTsKPiAtaW50IGk5MTVfcmVxdWVzdF9hd2FpdF9hY3RpdmVfcmVxdWVzdChzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICpycSwKPiAtCQkJCSAgICAgIHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3Rp
dmUpOwo+ICtpbnQgaTkxNV9yZXF1ZXN0X2F3YWl0X2FjdGl2ZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0
ICpycSwgc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpOwo+ICAgCj4gICBpbnQgaTkxNV9hY3RpdmVf
YWNxdWlyZShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZik7Cj4gK2Jvb2wgaTkxNV9hY3RpdmVfYWNx
dWlyZV9pZl9idXN5KHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKTsKPiAgIHZvaWQgaTkxNV9hY3Rp
dmVfcmVsZWFzZShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZik7Cj4gLXZvaWQgX19pOTE1X2FjdGl2
ZV9yZWxlYXNlX25lc3RlZChzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwgaW50IHN1YmNsYXNzKTsK
PiAtCj4gLWJvb2wgaTkxNV9hY3RpdmVfdHJ5Z3JhYihzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZik7
Cj4gLXZvaWQgaTkxNV9hY3RpdmVfdW5ncmFiKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKTsKPiAg
IAo+ICAgc3RhdGljIGlubGluZSBib29sCj4gICBpOTE1X2FjdGl2ZV9pc19pZGxlKGNvbnN0IHN0
cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2FjdGl2ZV90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmVf
dHlwZXMuaAo+IGluZGV4IDAyMTE2N2YwMDA0ZC4uZDg5YTc0YzE0MmM2IDEwMDY0NAo+IC0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlX3R5cGVzLmgKPiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZV90eXBlcy5oCj4gQEAgLTE3LDE3ICsxNyw5IEBACj4g
ICAKPiAgICNpbmNsdWRlICJpOTE1X3V0aWxzLmgiCj4gICAKPiAtc3RydWN0IGRybV9pOTE1X3By
aXZhdGU7Cj4gLXN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0Owo+IC1zdHJ1Y3QgaTkxNV9yZXF1
ZXN0Owo+IC0KPiAtdHlwZWRlZiB2b2lkICgqaTkxNV9hY3RpdmVfcmV0aXJlX2ZuKShzdHJ1Y3Qg
aTkxNV9hY3RpdmVfcmVxdWVzdCAqLAo+IC0JCQkJICAgICAgc3RydWN0IGk5MTVfcmVxdWVzdCAq
KTsKPiAtCj4gLXN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0IHsKPiAtCXN0cnVjdCBpOTE1X3Jl
cXVlc3QgX19yY3UgKnJlcXVlc3Q7Cj4gLQlzdHJ1Y3QgbGlzdF9oZWFkIGxpbms7Cj4gLQlpOTE1
X2FjdGl2ZV9yZXRpcmVfZm4gcmV0aXJlOwo+ICtzdHJ1Y3QgaTkxNV9hY3RpdmVfZmVuY2Ugewo+
ICsJc3RydWN0IGRtYV9mZW5jZSBfX3JjdSAqZmVuY2U7Cj4gKwlzdHJ1Y3QgZG1hX2ZlbmNlX2Ni
IGNiOwo+ICAgI2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X0RFQlVHX0dFTSkKPiAgIAkv
Kgo+ICAgCSAqIEluY29ycG9yZWFsIQo+IEBAIC01MywyMCArNDUsMTcgQEAgc3RydWN0IGFjdGl2
ZV9ub2RlOwo+ICAgI2RlZmluZSBpOTE1X2FjdGl2ZV9tYXlfc2xlZXAoZm4pIHB0cl9wYWNrX2Jp
dHMoJihmbiksIEk5MTVfQUNUSVZFX01BWV9TTEVFUCwgMikKPiAgIAo+ICAgc3RydWN0IGk5MTVf
YWN0aXZlIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1Owo+ICsJYXRvbWljX3Qg
Y291bnQ7Cj4gKwlzdHJ1Y3QgbXV0ZXggbXV0ZXg7Cj4gICAKPiAgIAlzdHJ1Y3QgYWN0aXZlX25v
ZGUgKmNhY2hlOwo+ICAgCXN0cnVjdCByYl9yb290IHRyZWU7Cj4gLQlzdHJ1Y3QgbXV0ZXggbXV0
ZXg7Cj4gLQlhdG9taWNfdCBjb3VudDsKPiAgIAo+ICAgCS8qIFByZWFsbG9jYXRlZCAiZXhjbHVz
aXZlIiBub2RlICovCj4gLQlzdHJ1Y3QgZG1hX2ZlbmNlIF9fcmN1ICpleGNsOwo+IC0Jc3RydWN0
IGRtYV9mZW5jZV9jYiBleGNsX2NiOwo+ICsJc3RydWN0IGk5MTVfYWN0aXZlX2ZlbmNlIGV4Y2w7
Cj4gICAKPiAgIAl1bnNpZ25lZCBsb25nIGZsYWdzOwo+ICAgI2RlZmluZSBJOTE1X0FDVElWRV9S
RVRJUkVfU0xFRVBTIEJJVCgwKQo+IC0jZGVmaW5lIEk5MTVfQUNUSVZFX0dSQUJfQklUIDEKPiAg
IAo+ICAgCWludCAoKmFjdGl2ZSkoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpOwo+ICAgCXZvaWQg
KCpyZXRpcmUpKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2Vt
LmMKPiBpbmRleCBmNTAwNThjZjhhYjguLjY0ODkwNjI3ZDYzOCAxMDA2NDQKPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9nZW0uYwo+IEBAIC04OTIsMjggKzg5MiwzOCBAQCB3YWl0X2Zvcl90aW1lbGluZXMoc3Ry
dWN0IGludGVsX2d0ICpndCwgdW5zaWduZWQgaW50IHdhaXQsIGxvbmcgdGltZW91dCkKPiAgIAo+
ICAgCXNwaW5fbG9ja19pcnFzYXZlKCZ0aW1lbGluZXMtPmxvY2ssIGZsYWdzKTsKPiAgIAlsaXN0
X2Zvcl9lYWNoX2VudHJ5KHRsLCAmdGltZWxpbmVzLT5hY3RpdmVfbGlzdCwgbGluaykgewo+IC0J
CXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOwo+ICsJCXN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlOwo+
ICAgCj4gLQkJcnEgPSBpOTE1X2FjdGl2ZV9yZXF1ZXN0X2dldF91bmxvY2tlZCgmdGwtPmxhc3Rf
cmVxdWVzdCk7Cj4gLQkJaWYgKCFycSkKPiArCQlmZW5jZSA9IGk5MTVfYWN0aXZlX2ZlbmNlX2dl
dCgmdGwtPmxhc3RfcmVxdWVzdCk7Cj4gKwkJaWYgKCFmZW5jZSkKPiAgIAkJCWNvbnRpbnVlOwo+
ICAgCj4gICAJCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnRpbWVsaW5lcy0+bG9jaywgZmxhZ3Mp
Owo+ICAgCj4gLQkJLyoKPiAtCQkgKiAiUmFjZS10by1pZGxlIi4KPiAtCQkgKgo+IC0JCSAqIFN3
aXRjaGluZyB0byB0aGUga2VybmVsIGNvbnRleHQgaXMgb2Z0ZW4gdXNlZCBhIHN5bmNocm9ub3Vz
Cj4gLQkJICogc3RlcCBwcmlvciB0byBpZGxpbmcsIGUuZy4gaW4gc3VzcGVuZCBmb3IgZmx1c2hp
bmcgYWxsCj4gLQkJICogY3VycmVudCBvcGVyYXRpb25zIHRvIG1lbW9yeSBiZWZvcmUgc2xlZXBp
bmcuIFRoZXNlIHdlCj4gLQkJICogd2FudCB0byBjb21wbGV0ZSBhcyBxdWlja2x5IGFzIHBvc3Np
YmxlIHRvIGF2b2lkIHByb2xvbmdlZAo+IC0JCSAqIHN0YWxscywgc28gYWxsb3cgdGhlIGdwdSB0
byBib29zdCB0byBtYXhpbXVtIGNsb2Nrcy4KPiAtCQkgKi8KPiAtCQlpZiAod2FpdCAmIEk5MTVf
V0FJVF9GT1JfSURMRV9CT09TVCkKPiAtCQkJZ2VuNl9ycHNfYm9vc3QocnEpOwo+ICsJCWlmICgh
ZG1hX2ZlbmNlX2lzX2k5MTUoZmVuY2UpKSB7Cj4gKwkJCXRpbWVvdXQgPSBkbWFfZmVuY2Vfd2Fp
dF90aW1lb3V0KGZlbmNlLAo+ICsJCQkJCQkJIGZsYWdzICYgSTkxNV9XQUlUX0lOVEVSUlVQVElC
TEUsCj4gKwkJCQkJCQkgdGltZW91dCk7Cj4gKwkJfSBlbHNlIHsKPiArCQkJc3RydWN0IGk5MTVf
cmVxdWVzdCAqcnEgPSB0b19yZXF1ZXN0KGZlbmNlKTsKPiArCj4gKwkJCS8qCj4gKwkJCSAqICJS
YWNlLXRvLWlkbGUiLgo+ICsJCQkgKgo+ICsJCQkgKiBTd2l0Y2hpbmcgdG8gdGhlIGtlcm5lbCBj
b250ZXh0IGlzIG9mdGVuIHVzZWQgYXMKPiArCQkJICogYSBzeW5jaHJvbm91cyBzdGVwIHByaW9y
IHRvIGlkbGluZywgZS5nLiBpbiBzdXNwZW5kCj4gKwkJCSAqIGZvciBmbHVzaGluZyBhbGwgY3Vy
cmVudCBvcGVyYXRpb25zIHRvIG1lbW9yeSBiZWZvcmUKPiArCQkJICogc2xlZXBpbmcuIFRoZXNl
IHdlIHdhbnQgdG8gY29tcGxldGUgYXMgcXVpY2tseSBhcwo+ICsJCQkgKiBwb3NzaWJsZSB0byBh
dm9pZCBwcm9sb25nZWQgc3RhbGxzLCBzbyBhbGxvdyB0aGUgZ3B1Cj4gKwkJCSAqIHRvIGJvb3N0
IHRvIG1heGltdW0gY2xvY2tzLgo+ICsJCQkgKi8KPiArCQkJaWYgKGZsYWdzICYgSTkxNV9XQUlU
X0ZPUl9JRExFX0JPT1NUKQo+ICsJCQkJZ2VuNl9ycHNfYm9vc3QocnEpOwo+ICsKPiArCQkJdGlt
ZW91dCA9IGk5MTVfcmVxdWVzdF93YWl0KHJxLCBmbGFncywgdGltZW91dCk7Cj4gKwkJfQo+ICAg
Cj4gLQkJdGltZW91dCA9IGk5MTVfcmVxdWVzdF93YWl0KHJxLCB3YWl0LCB0aW1lb3V0KTsKPiAt
CQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKPiArCQlkbWFfZmVuY2VfcHV0KGZlbmNlKTsKPiAgIAkJ
aWYgKHRpbWVvdXQgPCAwKQo+ICAgCQkJcmV0dXJuIHRpbWVvdXQ7Cj4gICAKPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2dlbV9ndHQuYwo+IGluZGV4IDU1Y2ViZjI1NmQwMy4uNzQ2MmQ4N2Y3YTQ4IDEw
MDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jCj4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMKPiBAQCAtMTg2MSw3ICsxODYxLDYg
QEAgc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3ZtYV9vcHMgcGRfdm1hX29wcyA9IHsKPiAgIAo+
ICAgc3RhdGljIHN0cnVjdCBpOTE1X3ZtYSAqcGRfdm1hX2NyZWF0ZShzdHJ1Y3QgZ2VuNl9wcGd0
dCAqcHBndHQsIGludCBzaXplKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSBwcGd0dC0+YmFzZS52bS5pOTE1Owo+ICAgCXN0cnVjdCBpOTE1X2dndHQgKmdndHQgPSBw
cGd0dC0+YmFzZS52bS5ndC0+Z2d0dDsKPiAgIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKPiAgIAo+
IEBAIC0xODcyLDcgKzE4NzEsNyBAQCBzdGF0aWMgc3RydWN0IGk5MTVfdm1hICpwZF92bWFfY3Jl
YXRlKHN0cnVjdCBnZW42X3BwZ3R0ICpwcGd0dCwgaW50IHNpemUpCj4gICAJaWYgKCF2bWEpCj4g
ICAJCXJldHVybiBFUlJfUFRSKC1FTk9NRU0pOwo+ICAgCj4gLQlpOTE1X2FjdGl2ZV9pbml0KGk5
MTUsICZ2bWEtPmFjdGl2ZSwgTlVMTCwgTlVMTCk7Cj4gKwlpOTE1X2FjdGl2ZV9pbml0KCZ2bWEt
PmFjdGl2ZSwgTlVMTCwgTlVMTCk7Cj4gICAKPiAgIAltdXRleF9pbml0KCZ2bWEtPnBhZ2VzX211
dGV4KTsKPiAgIAl2bWEtPnZtID0gaTkxNV92bV9nZXQoJmdndHQtPnZtKTsKPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmMKPiBpbmRleCA2Mzg0YTA2YWE1YmYuLmEyOGVlNzU0Yjdi
NCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jCj4g
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuYwo+IEBAIC0xMjk5LDcg
KzEyOTksNyBAQCBjYXB0dXJlX3ZtYShzdHJ1Y3QgY2FwdHVyZV92bWEgKm5leHQsCj4gICAJaWYg
KCFjKQo+ICAgCQlyZXR1cm4gbmV4dDsKPiAgIAo+IC0JaWYgKCFpOTE1X2FjdGl2ZV90cnlncmFi
KCZ2bWEtPmFjdGl2ZSkpIHsKPiArCWlmICghaTkxNV9hY3RpdmVfYWNxdWlyZV9pZl9idXN5KCZ2
bWEtPmFjdGl2ZSkpIHsKPiAgIAkJa2ZyZWUoYyk7Cj4gICAJCXJldHVybiBuZXh0Owo+ICAgCX0K
PiBAQCAtMTQzOSw3ICsxNDM5LDcgQEAgZ2VtX3JlY29yZF9yaW5ncyhzdHJ1Y3QgaTkxNV9ncHVf
c3RhdGUgKmVycm9yLCBzdHJ1Y3QgY29tcHJlc3MgKmNvbXByZXNzKQo+ICAgCQkJKnRoaXMtPnNs
b3QgPQo+ICAgCQkJCWk5MTVfZXJyb3Jfb2JqZWN0X2NyZWF0ZShpOTE1LCB2bWEsIGNvbXByZXNz
KTsKPiAgIAo+IC0JCQlpOTE1X2FjdGl2ZV91bmdyYWIoJnZtYS0+YWN0aXZlKTsKPiArCQkJaTkx
NV9hY3RpdmVfcmVsZWFzZSgmdm1hLT5hY3RpdmUpOwo+ICAgCQkJaTkxNV92bWFfcHV0KHZtYSk7
Cj4gICAKPiAgIAkJCWNhcHR1cmUgPSB0aGlzLT5uZXh0Owo+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
cmVxdWVzdC5jCj4gaW5kZXggYTg5MTY0MTI3NTliLi40ZmZlNjJhNDIxODYgMTAwNjQ0Cj4gLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMKPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYwo+IEBAIC0yMTgsOCArMjE4LDYgQEAgc3RhdGljIHZv
aWQgcmVtb3ZlX2Zyb21fZW5naW5lKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQo+ICAgCj4gICBz
dGF0aWMgYm9vbCBpOTE1X3JlcXVlc3RfcmV0aXJlKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQo+
ICAgewo+IC0Jc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2ZSwgKm5leHQ7Cj4gLQo+
ICAgCWlmICghaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChycSkpCj4gICAJCXJldHVybiBmYWxzZTsK
PiAgIAo+IEBAIC0yNDQsMzUgKzI0Miw2IEBAIHN0YXRpYyBib29sIGk5MTVfcmVxdWVzdF9yZXRp
cmUoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCj4gICAJCQkJICAmaTkxNV9yZXF1ZXN0X3RpbWVs
aW5lKHJxKS0+cmVxdWVzdHMpKTsKPiAgIAlycS0+cmluZy0+aGVhZCA9IHJxLT5wb3N0Zml4Owo+
ICAgCj4gLQkvKgo+IC0JICogV2FsayB0aHJvdWdoIHRoZSBhY3RpdmUgbGlzdCwgY2FsbGluZyBy
ZXRpcmUgb24gZWFjaC4gVGhpcyBhbGxvd3MKPiAtCSAqIG9iamVjdHMgdG8gdHJhY2sgdGhlaXIg
R1BVIGFjdGl2aXR5IGFuZCBtYXJrIHRoZW1zZWx2ZXMgYXMgaWRsZQo+IC0JICogd2hlbiB0aGVp
ciAqbGFzdCogYWN0aXZlIHJlcXVlc3QgaXMgY29tcGxldGVkICh1cGRhdGluZyBzdGF0ZQo+IC0J
ICogdHJhY2tpbmcgbGlzdHMgZm9yIGV2aWN0aW9uLCBhY3RpdmUgcmVmZXJlbmNlcyBmb3IgR0VN
LCBldGMpLgo+IC0JICoKPiAtCSAqIEFzIHRoZSAtPnJldGlyZSgpIG1heSBmcmVlIHRoZSBub2Rl
LCB3ZSBkZWNvdXBsZSBpdCBmaXJzdCBhbmQKPiAtCSAqIHBhc3MgYWxvbmcgdGhlIGF1eGlsaWFy
eSBpbmZvcm1hdGlvbiAodG8gYXZvaWQgZGVyZWZlcmVuY2luZwo+IC0JICogdGhlIG5vZGUgYWZ0
ZXIgdGhlIGNhbGxiYWNrKS4KPiAtCSAqLwo+IC0JbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKGFj
dGl2ZSwgbmV4dCwgJnJxLT5hY3RpdmVfbGlzdCwgbGluaykgewo+IC0JCS8qCj4gLQkJICogSW4g
bWljcm9iZW5jaG1hcmtzIG9yIGZvY3VzaW5nIHVwb24gdGltZSBpbnNpZGUgdGhlIGtlcm5lbCwK
PiAtCQkgKiB3ZSBtYXkgc3BlbmQgYW4gaW5vcmRpbmF0ZSBhbW91bnQgb2YgdGltZSBzaW1wbHkg
aGFuZGxpbmcKPiAtCQkgKiB0aGUgcmV0aXJlbWVudCBvZiByZXF1ZXN0cyBhbmQgcHJvY2Vzc2lu
ZyB0aGVpciBjYWxsYmFja3MuCj4gLQkJICogT2Ygd2hpY2gsIHRoaXMgbG9vcCBpdHNlbGYgaXMg
cGFydGljdWxhcmx5IGhvdCBkdWUgdG8gdGhlCj4gLQkJICogY2FjaGUgbWlzc2VzIHdoZW4ganVt
cGluZyBhcm91bmQgdGhlIGxpc3Qgb2YKPiAtCQkgKiBpOTE1X2FjdGl2ZV9yZXF1ZXN0LiAgU28g
d2UgdHJ5IHRvIGtlZXAgdGhpcyBsb29wIGFzCj4gLQkJICogc3RyZWFtbGluZWQgYXMgcG9zc2li
bGUgYW5kIGFsc28gcHJlZmV0Y2ggdGhlIG5leHQKPiAtCQkgKiBpOTE1X2FjdGl2ZV9yZXF1ZXN0
IHRvIHRyeSBhbmQgaGlkZSB0aGUgbGlrZWx5IGNhY2hlIG1pc3MuCj4gLQkJICovCj4gLQkJcHJl
ZmV0Y2h3KG5leHQpOwo+IC0KPiAtCQlJTklUX0xJU1RfSEVBRCgmYWN0aXZlLT5saW5rKTsKPiAt
CQlSQ1VfSU5JVF9QT0lOVEVSKGFjdGl2ZS0+cmVxdWVzdCwgTlVMTCk7Cj4gLQo+IC0JCWFjdGl2
ZS0+cmV0aXJlKGFjdGl2ZSwgcnEpOwo+IC0JfQo+IC0KPiAgIAlsb2NhbF9pcnFfZGlzYWJsZSgp
Owo+ICAgCj4gICAJLyoKPiBAQCAtNzA0LDcgKzY3Myw2IEBAIF9faTkxNV9yZXF1ZXN0X2NyZWF0
ZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIGdmcF90IGdmcCkKPiAgIAlycS0+ZmxhZ3MgPSAw
Owo+ICAgCXJxLT5leGVjdXRpb25fbWFzayA9IEFMTF9FTkdJTkVTOwo+ICAgCj4gLQlJTklUX0xJ
U1RfSEVBRCgmcnEtPmFjdGl2ZV9saXN0KTsKPiAgIAlJTklUX0xJU1RfSEVBRCgmcnEtPmV4ZWN1
dGVfY2IpOwo+ICAgCj4gICAJLyoKPiBAQCAtNzQzLDcgKzcxMSw2IEBAIF9faTkxNV9yZXF1ZXN0
X2NyZWF0ZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIGdmcF90IGdmcCkKPiAgIAljZS0+cmlu
Zy0+ZW1pdCA9IHJxLT5oZWFkOwo+ICAgCj4gICAJLyogTWFrZSBzdXJlIHdlIGRpZG4ndCBhZGQg
b3Vyc2VsdmVzIHRvIGV4dGVybmFsIHN0YXRlIGJlZm9yZSBmcmVlaW5nICovCj4gLQlHRU1fQlVH
X09OKCFsaXN0X2VtcHR5KCZycS0+YWN0aXZlX2xpc3QpKTsKPiAgIAlHRU1fQlVHX09OKCFsaXN0
X2VtcHR5KCZycS0+c2NoZWQuc2lnbmFsZXJzX2xpc3QpKTsKPiAgIAlHRU1fQlVHX09OKCFsaXN0
X2VtcHR5KCZycS0+c2NoZWQud2FpdGVyc19saXN0KSk7Cj4gICAKPiBAQCAtMTE3NCw4ICsxMTQx
LDggQEAgX19pOTE1X3JlcXVlc3RfYWRkX3RvX3RpbWVsaW5lKHN0cnVjdCBpOTE1X3JlcXVlc3Qg
KnJxKQo+ICAgCSAqIHByZWNsdWRlcyBvcHRpbWlzaW5nIHRvIHVzZSBzZW1hcGhvcmVzIHNlcmlh
bGlzYXRpb24gb2YgYSBzaW5nbGUKPiAgIAkgKiB0aW1lbGluZSBhY3Jvc3MgZW5naW5lcy4KPiAg
IAkgKi8KPiAtCXByZXYgPSByY3VfZGVyZWZlcmVuY2VfcHJvdGVjdGVkKHRpbWVsaW5lLT5sYXN0
X3JlcXVlc3QucmVxdWVzdCwKPiAtCQkJCQkgbG9ja2RlcF9pc19oZWxkKCZ0aW1lbGluZS0+bXV0
ZXgpKTsKPiArCXByZXYgPSB0b19yZXF1ZXN0KF9faTkxNV9hY3RpdmVfZmVuY2Vfc2V0KCZ0aW1l
bGluZS0+bGFzdF9yZXF1ZXN0LAo+ICsJCQkJCQkgICZycS0+ZmVuY2UpKTsKPiAgIAlpZiAocHJl
diAmJiAhaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChwcmV2KSkgewo+ICAgCQlpZiAoaXNfcG93ZXJf
b2ZfMihwcmV2LT5lbmdpbmUtPm1hc2sgfCBycS0+ZW5naW5lLT5tYXNrKSkKPiAgIAkJCWk5MTVf
c3dfZmVuY2VfYXdhaXRfc3dfZmVuY2UoJnJxLT5zdWJtaXQsCj4gQEAgLTEyMDAsNyArMTE2Nyw2
IEBAIF9faTkxNV9yZXF1ZXN0X2FkZF90b190aW1lbGluZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpy
cSkKPiAgIAkgKiB1cywgdGhlIHRpbWVsaW5lIHdpbGwgaG9sZCBpdHMgc2Vxbm8gd2hpY2ggaXMg
bGF0ZXIgdGhhbiBvdXJzLgo+ICAgCSAqLwo+ICAgCUdFTV9CVUdfT04odGltZWxpbmUtPnNlcW5v
ICE9IHJxLT5mZW5jZS5zZXFubyk7Cj4gLQlfX2k5MTVfYWN0aXZlX3JlcXVlc3Rfc2V0KCZ0aW1l
bGluZS0+bGFzdF9yZXF1ZXN0LCBycSk7Cj4gICAKPiAgIAlyZXR1cm4gcHJldjsKPiAgIH0KPiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmggYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuaAo+IGluZGV4IGVjNWJiNGMyZTVhZS4uOTFhODg1
YzM2YzZiIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5o
Cj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmgKPiBAQCAtMjExLDcg
KzIxMSw2IEBAIHN0cnVjdCBpOTE1X3JlcXVlc3Qgewo+ICAgCSAqIG9uIHRoZSBhY3RpdmVfbGlz
dCAob2YgdGhlaXIgZmluYWwgcmVxdWVzdCkuCj4gICAJICovCj4gICAJc3RydWN0IGk5MTVfY2Fw
dHVyZV9saXN0ICpjYXB0dXJlX2xpc3Q7Cj4gLQlzdHJ1Y3QgbGlzdF9oZWFkIGFjdGl2ZV9saXN0
Owo+ICAgCj4gICAJLyoqIFRpbWUgYXQgd2hpY2ggdGhpcyByZXF1ZXN0IHdhcyBlbWl0dGVkLCBp
biBqaWZmaWVzLiAqLwo+ICAgCXVuc2lnbmVkIGxvbmcgZW1pdHRlZF9qaWZmaWVzOwo+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV92bWEuYwo+IGluZGV4IGUxOTEyNDdjN2M1Zi4uOWZkY2Q0ZTJjNzk5IDEwMDY0
NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMKPiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCj4gQEAgLTEyMCw4ICsxMjAsNyBAQCB2bWFfY3JlYXRl
KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCj4gICAJdm1hLT5zaXplID0gb2JqLT5i
YXNlLnNpemU7Cj4gICAJdm1hLT5kaXNwbGF5X2FsaWdubWVudCA9IEk5MTVfR1RUX01JTl9BTElH
Tk1FTlQ7Cj4gICAKPiAtCWk5MTVfYWN0aXZlX2luaXQodm0tPmk5MTUsICZ2bWEtPmFjdGl2ZSwK
PiAtCQkJIF9faTkxNV92bWFfYWN0aXZlLCBfX2k5MTVfdm1hX3JldGlyZSk7Cj4gKwlpOTE1X2Fj
dGl2ZV9pbml0KCZ2bWEtPmFjdGl2ZSwgX19pOTE1X3ZtYV9hY3RpdmUsIF9faTkxNV92bWFfcmV0
aXJlKTsKPiAgIAo+ICAgCS8qIERlY2xhcmUgb3Vyc2VsdmVzIHNhZmUgZm9yIHVzZSBpbnNpZGUg
c2hyaW5rZXJzICovCj4gICAJaWYgKElTX0VOQUJMRUQoQ09ORklHX0xPQ0tERVApKSB7Cj4gQEAg
LTExNDgsNiArMTE0Nyw3IEBAIGludCBfX2k5MTVfdm1hX3VuYmluZChzdHJ1Y3QgaTkxNV92bWEg
KnZtYSkKPiAgIAlpZiAocmV0KQo+ICAgCQlyZXR1cm4gcmV0Owo+ICAgCj4gKwlHRU1fQlVHX09O
KGk5MTVfdm1hX2lzX2FjdGl2ZSh2bWEpKTsKPiAgIAlpZiAoaTkxNV92bWFfaXNfcGlubmVkKHZt
YSkpIHsKPiAgIAkJdm1hX3ByaW50X2FsbG9jYXRvcih2bWEsICJpcyBwaW5uZWQiKTsKPiAgIAkJ
cmV0dXJuIC1FQlVTWTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRl
c3RzL2k5MTVfYWN0aXZlLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9h
Y3RpdmUuYwo+IGluZGV4IGE0MTc4NTgyMmVkOS4uMmNjNzFiY2Y4ODRmIDEwMDY0NAo+IC0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2FjdGl2ZS5jCj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfYWN0aXZlLmMKPiBAQCAtNjgsNyArNjgs
NyBAQCBzdGF0aWMgc3RydWN0IGxpdmVfYWN0aXZlICpfX2xpdmVfYWxsb2Moc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gICAJCXJldHVybiBOVUxMOwo+ICAgCj4gICAJa3JlZl9pbml0
KCZhY3RpdmUtPnJlZik7Cj4gLQlpOTE1X2FjdGl2ZV9pbml0KGk5MTUsICZhY3RpdmUtPmJhc2Us
IF9fbGl2ZV9hY3RpdmUsIF9fbGl2ZV9yZXRpcmUpOwo+ICsJaTkxNV9hY3RpdmVfaW5pdCgmYWN0
aXZlLT5iYXNlLCBfX2xpdmVfYWN0aXZlLCBfX2xpdmVfcmV0aXJlKTsKPiAgIAo+ICAgCXJldHVy
biBhY3RpdmU7Cj4gICB9Cj4gQEAgLTE0NiwxOSArMTQ2LDEzIEBAIHN0YXRpYyBpbnQgbGl2ZV9h
Y3RpdmVfd2FpdCh2b2lkICphcmcpCj4gICB7Cj4gICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBhcmc7Cj4gICAJc3RydWN0IGxpdmVfYWN0aXZlICphY3RpdmU7Cj4gLQlpbnRlbF93
YWtlcmVmX3Qgd2FrZXJlZjsKPiAgIAlpbnQgZXJyID0gMDsKPiAgIAo+ICAgCS8qIENoZWNrIHRo
YXQgd2UgZ2V0IGEgY2FsbGJhY2sgd2hlbiByZXF1ZXN0cyByZXRpcmUgdXBvbiB3YWl0aW5nICov
Cj4gICAKPiAtCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+IC0Jd2FrZXJl
ZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKPiAtCj4gICAJYWN0
aXZlID0gX19saXZlX2FjdGl2ZV9zZXR1cChpOTE1KTsKPiAtCWlmIChJU19FUlIoYWN0aXZlKSkg
ewo+IC0JCWVyciA9IFBUUl9FUlIoYWN0aXZlKTsKPiAtCQlnb3RvIGVycjsKPiAtCX0KPiArCWlm
IChJU19FUlIoYWN0aXZlKSkKPiArCQlyZXR1cm4gUFRSX0VSUihhY3RpdmUpOwo+ICAgCj4gICAJ
aTkxNV9hY3RpdmVfd2FpdCgmYWN0aXZlLT5iYXNlKTsKPiAgIAlpZiAoIVJFQURfT05DRShhY3Rp
dmUtPnJldGlyZWQpKSB7Cj4gQEAgLTE2OCwxMSArMTYyLDkgQEAgc3RhdGljIGludCBsaXZlX2Fj
dGl2ZV93YWl0KHZvaWQgKmFyZykKPiAgIAo+ICAgCV9fbGl2ZV9wdXQoYWN0aXZlKTsKPiAgIAo+
ICsJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAJaWYgKGlndF9mbHVz
aF90ZXN0KGk5MTUsIEk5MTVfV0FJVF9MT0NLRUQpKQo+ICAgCQllcnIgPSAtRUlPOwo+IC0KPiAt
ZXJyOgo+IC0JaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYp
Owo+ICAgCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAKPiAgIAly
ZXR1cm4gZXJyOwo+IEBAIC0xODIsMjMgKzE3NCwxOSBAQCBzdGF0aWMgaW50IGxpdmVfYWN0aXZl
X3JldGlyZSh2b2lkICphcmcpCj4gICB7Cj4gICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSBhcmc7Cj4gICAJc3RydWN0IGxpdmVfYWN0aXZlICphY3RpdmU7Cj4gLQlpbnRlbF93YWtl
cmVmX3Qgd2FrZXJlZjsKPiAgIAlpbnQgZXJyID0gMDsKPiAgIAo+ICAgCS8qIENoZWNrIHRoYXQg
d2UgZ2V0IGEgY2FsbGJhY2sgd2hlbiByZXF1ZXN0cyBhcmUgaW5kaXJlY3RseSByZXRpcmVkICov
Cj4gICAKPiAtCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+IC0Jd2FrZXJl
ZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKPiAtCj4gICAJYWN0
aXZlID0gX19saXZlX2FjdGl2ZV9zZXR1cChpOTE1KTsKPiAtCWlmIChJU19FUlIoYWN0aXZlKSkg
ewo+IC0JCWVyciA9IFBUUl9FUlIoYWN0aXZlKTsKPiAtCQlnb3RvIGVycjsKPiAtCX0KPiArCWlm
IChJU19FUlIoYWN0aXZlKSkKPiArCQlyZXR1cm4gUFRSX0VSUihhY3RpdmUpOwo+ICAgCj4gICAJ
Lyogd2FpdHMgZm9yICYgcmV0aXJlcyBhbGwgcmVxdWVzdHMgKi8KPiArCW11dGV4X2xvY2soJmk5
MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCWlmIChpZ3RfZmx1c2hfdGVzdChpOTE1LCBJOTE1
X1dBSVRfTE9DS0VEKSkKPiAgIAkJZXJyID0gLUVJTzsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7Cj4gICAKPiAgIAlpZiAoIVJFQURfT05DRShhY3RpdmUtPnJldGly
ZWQpKSB7Cj4gICAJCXByX2VycigiaTkxNV9hY3RpdmUgbm90IHJldGlyZWQgYWZ0ZXIgZmx1c2hp
bmchXG4iKTsKPiBAQCAtMjA3LDEwICsxOTUsNiBAQCBzdGF0aWMgaW50IGxpdmVfYWN0aXZlX3Jl
dGlyZSh2b2lkICphcmcpCj4gICAKPiAgIAlfX2xpdmVfcHV0KGFjdGl2ZSk7Cj4gICAKPiAtZXJy
Ogo+IC0JaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwo+
IC0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAtCj4gICAJcmV0dXJu
IGVycjsKPiAgIH0KPiAgIAo+IApfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVz
a3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9p
bnRlbC1nZng=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 22CCEFF4B8
	for <lists+intel-gfx@lfdr.de>; Sat, 16 Nov 2019 19:26:06 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 91F0D6E14E;
	Sat, 16 Nov 2019 18:26:02 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 24BD26E14E
 for <intel-gfx@lists.freedesktop.org>; Sat, 16 Nov 2019 18:25:58 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19226596-1500050 
 for multiple; Sat, 16 Nov 2019 18:25:37 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Sat, 16 Nov 2019 18:25:35 +0000
Message-Id: <20191116182535.1790934-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191116175139.1790440-2-chris@chris-wilson.co.uk>
References: <20191116175139.1790440-2-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915: Mark up the calling context for
 intel_wakeref_put()
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UHJldmlvdXNseSwgd2UgYXNzdW1lZCB3ZSBjb3VsZCB1c2UgbXV0ZXhfdHJ5bG9jaygpIHdpdGhp
biBhbiBhdG9taWMKY29udGV4dCwgZmFsbGluZyBiYWNrIHRvIGEgd29ya2luZyBpZiBjb250ZW5k
ZWQuIEhvd2V2ZXIsIHN1Y2ggdHJpY2tlcnkKaXMgaWxsZWdhbCBpbnNpZGUgaW50ZXJydXB0IGNv
bnRleHQsIGFuZCBzbyB3ZSBuZWVkIHRvIGFsd2F5cyB1c2UgYQp3b3JrZXIgdW5kZXIgc3VjaCBj
aXJjdW1zdGFuY2VzLiBBcyB3ZSBub3JtYWxseSBhcmUgaW4gcHJvY2VzcyBjb250ZXh0LAp3ZSBj
YW4gdHlwaWNhbGx5IHVzZSBhIHBsYWluIG11dGV4LCBhbmQgb25seSBkZWZlciB0byBhIHdvcmsg
d2hlbiB3ZQprbm93IHdlIGFyZSBjYWxsZXIgZnJvbSBhbiBpbnRlcnJ1cHQgcGF0aC4KCkZpeGVz
OiA1MWZiZDhkZTg3ZGMgKCJkcm0vaTkxNS9wbXU6IEF0b21pY2FsbHkgYWNxdWlyZSB0aGUgZ3Rf
cG0gd2FrZXJlZiIpClJlZmVyZW5jZXM6IGEwODU1ZDI0ZmMyMmQgKCJsb2NraW5nL211dGV4OiBD
b21wbGFpbiB1cG9uIG11dGV4IEFQSSBtaXN1c2UgaW4gSVJRIGNvbnRleHRzIikKUmVmZXJlbmNl
czogaHR0cHM6Ly9idWdzLmZyZWVkZXNrdG9wLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTExNjI2ClNp
Z25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgpDYzog
VHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uaCB8ICA1ICsrKwogZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYyAgICAgfCAgMSAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9ndF9wbS5oICAgICB8ICA1ICsrKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfbHJjLmMgICAgICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUu
YyAgICAgICAgfCAgNSArLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11LmMgICAgICAg
ICAgIHwgIDYgKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfd2FrZXJlZi5jICAgICAg
fCAzNyArKysrKysrKystLS0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
d2FrZXJlZi5oICAgICAgfCAyNyArKysrKysrKysrKy0tLS0tLQogOCBmaWxlcyBjaGFuZ2VkLCA0
OSBpbnNlcnRpb25zKCspLCAzOSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2VuZ2luZV9wbS5oCmluZGV4IDczOWM1MGZlZmNlZi4uNmRiMDdiZGQxZWVmIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uaAorKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uaApAQCAtMzEsNiArMzEsMTEg
QEAgc3RhdGljIGlubGluZSB2b2lkIGludGVsX2VuZ2luZV9wbV9wdXQoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQogCWludGVsX3dha2VyZWZfcHV0KCZlbmdpbmUtPndha2VyZWYpOwog
fQogCitzdGF0aWMgaW5saW5lIHZvaWQgaW50ZWxfZW5naW5lX3BtX3B1dF9hc3luYyhzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJaW50ZWxfd2FrZXJlZl9wdXRfYXN5bmMoJmVu
Z2luZS0+d2FrZXJlZik7Cit9CisKIHZvaWQgaW50ZWxfZW5naW5lX2luaXRfX3BtKHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7CiAKICNlbmRpZiAvKiBJTlRFTF9FTkdJTkVfUE1fSCAq
LwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3BtLmMKaW5kZXggZTYxZjc1MmEzY2Q1Li43
YTkwNDRhYzRiNzUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0
X3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYwpAQCAtMTA1
LDcgKzEwNSw2IEBAIHN0YXRpYyBpbnQgX19ndF9wYXJrKHN0cnVjdCBpbnRlbF93YWtlcmVmICp3
ZikKIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaW50ZWxfd2FrZXJlZl9vcHMgd2Zfb3BzID0gewogCS5n
ZXQgPSBfX2d0X3VucGFyaywKIAkucHV0ID0gX19ndF9wYXJrLAotCS5mbGFncyA9IElOVEVMX1dB
S0VSRUZfUFVUX0FTWU5DLAogfTsKIAogdm9pZCBpbnRlbF9ndF9wbV9pbml0X2Vhcmx5KHN0cnVj
dCBpbnRlbF9ndCAqZ3QpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9ndF9wbS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uaAppbmRleCBi
M2UxNzM5OWJlOWIuLjk5MGVmYzI3YTRlNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZ3RfcG0uaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9n
dF9wbS5oCkBAIC0zMiw2ICszMiwxMSBAQCBzdGF0aWMgaW5saW5lIHZvaWQgaW50ZWxfZ3RfcG1f
cHV0KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiAJaW50ZWxfd2FrZXJlZl9wdXQoJmd0LT53YWtlcmVm
KTsKIH0KIAorc3RhdGljIGlubGluZSB2b2lkIGludGVsX2d0X3BtX3B1dF9hc3luYyhzdHJ1Y3Qg
aW50ZWxfZ3QgKmd0KQoreworCWludGVsX3dha2VyZWZfcHV0X2FzeW5jKCZndC0+d2FrZXJlZik7
Cit9CisKIHN0YXRpYyBpbmxpbmUgaW50IGludGVsX2d0X3BtX3dhaXRfZm9yX2lkbGUoc3RydWN0
IGludGVsX2d0ICpndCkKIHsKIAlyZXR1cm4gaW50ZWxfd2FrZXJlZl93YWl0X2Zvcl9pZGxlKCZn
dC0+d2FrZXJlZik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9s
cmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCmluZGV4IDMzY2UyNThk
NDg0Zi4uYjY1YmMwNjg1NWIwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9scmMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwpAQCAt
MTE3Miw3ICsxMTcyLDcgQEAgX19leGVjbGlzdHNfc2NoZWR1bGVfb3V0KHN0cnVjdCBpOTE1X3Jl
cXVlc3QgKnJxLAogCiAJaW50ZWxfZW5naW5lX2NvbnRleHRfb3V0KGVuZ2luZSk7CiAJZXhlY2xp
c3RzX2NvbnRleHRfc3RhdHVzX2NoYW5nZShycSwgSU5URUxfQ09OVEVYVF9TQ0hFRFVMRV9PVVQp
OwotCWludGVsX2d0X3BtX3B1dChlbmdpbmUtPmd0KTsKKwlpbnRlbF9ndF9wbV9wdXRfYXN5bmMo
ZW5naW5lLT5ndCk7CiAKIAkvKgogCSAqIElmIHRoaXMgaXMgcGFydCBvZiBhIHZpcnR1YWwgZW5n
aW5lLCBpdHMgbmV4dCByZXF1ZXN0IG1heQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9hY3RpdmUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMKaW5k
ZXggNTQ0OGYzN2M4MTAyLi5kY2ExNWFjZTg4ZjYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfYWN0aXZlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3Rp
dmUuYwpAQCAtNjcyLDEyICs2NzIsMTMgQEAgdm9pZCBpOTE1X2FjdGl2ZV9hY3F1aXJlX2JhcnJp
ZXIoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCiAJICogcG9wdWxhdGVkIGJ5IGk5MTVfcmVxdWVz
dF9hZGRfYWN0aXZlX2JhcnJpZXJzKCkgdG8gcG9pbnQgdG8gdGhlCiAJICogcmVxdWVzdCB0aGF0
IHdpbGwgZXZlbnR1YWxseSByZWxlYXNlIHRoZW0uCiAJICovCi0Jc3Bpbl9sb2NrX2lycXNhdmVf
bmVzdGVkKCZyZWYtPnRyZWVfbG9jaywgZmxhZ3MsIFNJTkdMRV9ERVBUSF9ORVNUSU5HKTsKIAls
bGlzdF9mb3JfZWFjaF9zYWZlKHBvcywgbmV4dCwgdGFrZV9wcmVhbGxvY2F0ZWRfYmFycmllcnMo
cmVmKSkgewogCQlzdHJ1Y3QgYWN0aXZlX25vZGUgKm5vZGUgPSBiYXJyaWVyX2Zyb21fbGwocG9z
KTsKIAkJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lID0gYmFycmllcl90b19lbmdpbmUo
bm9kZSk7CiAJCXN0cnVjdCByYl9ub2RlICoqcCwgKnBhcmVudDsKIAorCQlzcGluX2xvY2tfaXJx
c2F2ZV9uZXN0ZWQoJnJlZi0+dHJlZV9sb2NrLCBmbGFncywKKwkJCQkJIFNJTkdMRV9ERVBUSF9O
RVNUSU5HKTsKIAkJcGFyZW50ID0gTlVMTDsKIAkJcCA9ICZyZWYtPnRyZWUucmJfbm9kZTsKIAkJ
d2hpbGUgKCpwKSB7CkBAIC02OTMsMTIgKzY5NCwxMiBAQCB2b2lkIGk5MTVfYWN0aXZlX2FjcXVp
cmVfYmFycmllcihzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZikKIAkJfQogCQlyYl9saW5rX25vZGUo
Jm5vZGUtPm5vZGUsIHBhcmVudCwgcCk7CiAJCXJiX2luc2VydF9jb2xvcigmbm9kZS0+bm9kZSwg
JnJlZi0+dHJlZSk7CisJCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnJlZi0+dHJlZV9sb2NrLCBm
bGFncyk7CiAKIAkJR0VNX0JVR19PTighaW50ZWxfZW5naW5lX3BtX2lzX2F3YWtlKGVuZ2luZSkp
OwogCQlsbGlzdF9hZGQoYmFycmllcl90b19sbChub2RlKSwgJmVuZ2luZS0+YmFycmllcl90YXNr
cyk7CiAJCWludGVsX2VuZ2luZV9wbV9wdXQoZW5naW5lKTsKIAl9Ci0Jc3Bpbl91bmxvY2tfaXJx
cmVzdG9yZSgmcmVmLT50cmVlX2xvY2ssIGZsYWdzKTsKIH0KIAogdm9pZCBpOTE1X3JlcXVlc3Rf
YWRkX2FjdGl2ZV9iYXJyaWVycyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3BtdS5jCmluZGV4IDliMDJiZTBhZDRlNi4uOTVlODI0YTc4ZDRkIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfcG11LmMKQEAgLTE5MCw3ICsxOTAsNyBAQCBzdGF0aWMgdTY0IGdldF9yYzYoc3RydWN0
IGludGVsX2d0ICpndCkKIAl2YWwgPSAwOwogCWlmIChpbnRlbF9ndF9wbV9nZXRfaWZfYXdha2Uo
Z3QpKSB7CiAJCXZhbCA9IF9fZ2V0X3JjNihndCk7Ci0JCWludGVsX2d0X3BtX3B1dChndCk7CisJ
CWludGVsX2d0X3BtX3B1dF9hc3luYyhndCk7CiAJfQogCiAJc3Bpbl9sb2NrX2lycXNhdmUoJnBt
dS0+bG9jaywgZmxhZ3MpOwpAQCAtMzYwLDcgKzM2MCw3IEBAIGVuZ2luZXNfc2FtcGxlKHN0cnVj
dCBpbnRlbF9ndCAqZ3QsIHVuc2lnbmVkIGludCBwZXJpb2RfbnMpCiBza2lwOgogCQlpZiAodW5s
aWtlbHkobW1pb19sb2NrKSkKIAkJCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUobW1pb19sb2NrLCBm
bGFncyk7Ci0JCWludGVsX2VuZ2luZV9wbV9wdXQoZW5naW5lKTsKKwkJaW50ZWxfZW5naW5lX3Bt
X3B1dF9hc3luYyhlbmdpbmUpOwogCX0KIH0KIApAQCAtMzk4LDcgKzM5OCw3IEBAIGZyZXF1ZW5j
eV9zYW1wbGUoc3RydWN0IGludGVsX2d0ICpndCwgdW5zaWduZWQgaW50IHBlcmlvZF9ucykKIAkJ
CWlmIChzdGF0KQogCQkJCXZhbCA9IGludGVsX2dldF9jYWdmKHJwcywgc3RhdCk7CiAKLQkJCWlu
dGVsX2d0X3BtX3B1dChndCk7CisJCQlpbnRlbF9ndF9wbV9wdXRfYXN5bmMoZ3QpOwogCQl9CiAK
IAkJYWRkX3NhbXBsZV9tdWx0KCZwbXUtPnNhbXBsZVtfX0k5MTVfU0FNUExFX0ZSRVFfQUNUXSwK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3dha2VyZWYuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX3dha2VyZWYuYwppbmRleCA4NjhjYzc4MDQ4ZDAuLjgwODRj
ZGVkNjJkYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfd2FrZXJlZi5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3dha2VyZWYuYwpAQCAtNTIsOSArNTIs
MjAgQEAgaW50IF9faW50ZWxfd2FrZXJlZl9nZXRfZmlyc3Qoc3RydWN0IGludGVsX3dha2VyZWYg
KndmKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgdm9pZCBfX19faW50ZWxfd2FrZXJlZl9wdXRf
bGFzdChzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2YpCit2b2lkIF9faW50ZWxfd2FrZXJlZl9wdXRf
bGFzdChzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2YsIHVuc2lnbmVkIGxvbmcgZmxhZ3MpCiB7Ci0J
aWYgKCFhdG9taWNfZGVjX2FuZF90ZXN0KCZ3Zi0+Y291bnQpKQorCUlOVEVMX1dBS0VSRUZfQlVH
X09OKHdvcmtfcGVuZGluZygmd2YtPndvcmspKTsKKworCS8qIEFzc3VtZSB3ZSBhcmUgbm90IGlu
IHByb2Nlc3MgY29udGV4dCBhbmQgc28gY2Fubm90IHNsZWVwLiAqLworCWlmIChmbGFncyAmIElO
VEVMX1dBS0VSRUZfUFVUX0FTWU5DKSB7CisJCXNjaGVkdWxlX3dvcmsoJndmLT53b3JrKTsKKwkJ
cmV0dXJuOworCX0KKworCW11dGV4X2xvY2soJndmLT5tdXRleCk7CisKKwlJTlRFTF9XQUtFUkVG
X0JVR19PTihhdG9taWNfcmVhZCgmd2YtPmNvdW50KSA8PSAwKTsKKwlpZiAodW5saWtlbHkoIWF0
b21pY19kZWNfYW5kX3Rlc3QoJndmLT5jb3VudCkpKQogCQlnb3RvIHVubG9jazsKIAogCS8qIG9w
cy0+cHV0KCkgbXVzdCByZXNjaGVkdWxlIGl0cyBvd24gcmVsZWFzZSBvbiBlcnJvci9kZWZlcnJh
bCAqLwpAQCAtNjcsMjkgKzc4LDkgQEAgc3RhdGljIHZvaWQgX19fX2ludGVsX3dha2VyZWZfcHV0
X2xhc3Qoc3RydWN0IGludGVsX3dha2VyZWYgKndmKQogCW11dGV4X3VubG9jaygmd2YtPm11dGV4
KTsKIH0KIAotdm9pZCBfX2ludGVsX3dha2VyZWZfcHV0X2xhc3Qoc3RydWN0IGludGVsX3dha2Vy
ZWYgKndmKQotewotCUlOVEVMX1dBS0VSRUZfQlVHX09OKHdvcmtfcGVuZGluZygmd2YtPndvcmsp
KTsKLQotCS8qIEFzc3VtZSB3ZSBhcmUgbm90IGluIHByb2Nlc3MgY29udGV4dCBhbmQgc28gY2Fu
bm90IHNsZWVwLiAqLwotCWlmICh3Zi0+b3BzLT5mbGFncyAmIElOVEVMX1dBS0VSRUZfUFVUX0FT
WU5DIHx8Ci0JICAgICFtdXRleF90cnlsb2NrKCZ3Zi0+bXV0ZXgpKSB7Ci0JCXNjaGVkdWxlX3dv
cmsoJndmLT53b3JrKTsKLQkJcmV0dXJuOwotCX0KLQotCV9fX19pbnRlbF93YWtlcmVmX3B1dF9s
YXN0KHdmKTsKLX0KLQogc3RhdGljIHZvaWQgX19pbnRlbF93YWtlcmVmX3B1dF93b3JrKHN0cnVj
dCB3b3JrX3N0cnVjdCAqd3JrKQogewotCXN0cnVjdCBpbnRlbF93YWtlcmVmICp3ZiA9IGNvbnRh
aW5lcl9vZih3cmssIHR5cGVvZigqd2YpLCB3b3JrKTsKLQotCWlmIChhdG9taWNfYWRkX3VubGVz
cygmd2YtPmNvdW50LCAtMSwgMSkpCi0JCXJldHVybjsKLQotCW11dGV4X2xvY2soJndmLT5tdXRl
eCk7Ci0JX19fX2ludGVsX3dha2VyZWZfcHV0X2xhc3Qod2YpOworCWludGVsX3dha2VyZWZfcHV0
KGNvbnRhaW5lcl9vZih3cmssIHN0cnVjdCBpbnRlbF93YWtlcmVmLCB3b3JrKSk7CiB9CiAKIHZv
aWQgX19pbnRlbF93YWtlcmVmX2luaXQoc3RydWN0IGludGVsX3dha2VyZWYgKndmLApkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfd2FrZXJlZi5oIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfd2FrZXJlZi5oCmluZGV4IDVmMGM5NzJhODBmYi4uZmY0ODc2MDkzNTQx
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF93YWtlcmVmLmgKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfd2FrZXJlZi5oCkBAIC0yOSw5ICsyOSw2IEBAIHR5
cGVkZWYgZGVwb3Rfc3RhY2tfaGFuZGxlX3QgaW50ZWxfd2FrZXJlZl90Owogc3RydWN0IGludGVs
X3dha2VyZWZfb3BzIHsKIAlpbnQgKCpnZXQpKHN0cnVjdCBpbnRlbF93YWtlcmVmICp3Zik7CiAJ
aW50ICgqcHV0KShzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2YpOwotCi0JdW5zaWduZWQgbG9uZyBm
bGFnczsKLSNkZWZpbmUgSU5URUxfV0FLRVJFRl9QVVRfQVNZTkMgQklUKDApCiB9OwogCiBzdHJ1
Y3QgaW50ZWxfd2FrZXJlZiB7CkBAIC01Nyw3ICs1NCw3IEBAIHZvaWQgX19pbnRlbF93YWtlcmVm
X2luaXQoc3RydWN0IGludGVsX3dha2VyZWYgKndmLAogfSB3aGlsZSAoMCkKIAogaW50IF9faW50
ZWxfd2FrZXJlZl9nZXRfZmlyc3Qoc3RydWN0IGludGVsX3dha2VyZWYgKndmKTsKLXZvaWQgX19p
bnRlbF93YWtlcmVmX3B1dF9sYXN0KHN0cnVjdCBpbnRlbF93YWtlcmVmICp3Zik7Cit2b2lkIF9f
aW50ZWxfd2FrZXJlZl9wdXRfbGFzdChzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2YsIHVuc2lnbmVk
IGxvbmcgZmxhZ3MpOwogCiAvKioKICAqIGludGVsX3dha2VyZWZfZ2V0OiBBY3F1aXJlIHRoZSB3
YWtlcmVmCkBAIC0xMDAsMTAgKzk3LDkgQEAgaW50ZWxfd2FrZXJlZl9nZXRfaWZfYWN0aXZlKHN0
cnVjdCBpbnRlbF93YWtlcmVmICp3ZikKIH0KIAogLyoqCi0gKiBpbnRlbF93YWtlcmVmX3B1dDog
UmVsZWFzZSB0aGUgd2FrZXJlZgotICogQGk5MTU6IHRoZSBkcm1faTkxNV9wcml2YXRlIGRldmlj
ZQorICogaW50ZWxfd2FrZXJlZl9wdXRfZmxhZ3M6IFJlbGVhc2UgdGhlIHdha2VyZWYKICAqIEB3
ZjogdGhlIHdha2VyZWYKLSAqIEBmbjogY2FsbGJhY2sgZm9yIHJlbGVhc2luZyB0aGUgd2FrZXJl
ZiwgY2FsbGVkIG9ubHkgb24gZmluYWwgcmVsZWFzZS4KKyAqIEBmbGFnczogY29udHJvbCBmbGFn
cwogICoKICAqIFJlbGVhc2Ugb3VyIGhvbGQgb24gdGhlIHdha2VyZWYuIFdoZW4gdGhlcmUgYXJl
IG5vIG1vcmUgdXNlcnMsCiAgKiB0aGUgcnVudGltZSBwbSB3YWtlcmVmIHdpbGwgYmUgcmVsZWFz
ZWQgYWZ0ZXIgdGhlIEBmbiBjYWxsYmFjayBpcyBjYWxsZWQKQEAgLTExNiwxMSArMTEyLDI0IEBA
IGludGVsX3dha2VyZWZfZ2V0X2lmX2FjdGl2ZShzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2YpCiAg
KiBjb2RlIG90aGVyd2lzZS4KICAqLwogc3RhdGljIGlubGluZSB2b2lkCi1pbnRlbF93YWtlcmVm
X3B1dChzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2YpCitfX2ludGVsX3dha2VyZWZfcHV0KHN0cnVj
dCBpbnRlbF93YWtlcmVmICp3ZiwgdW5zaWduZWQgbG9uZyBmbGFncykKKyNkZWZpbmUgSU5URUxf
V0FLRVJFRl9QVVRfQVNZTkMgQklUKDApCiB7CiAJSU5URUxfV0FLRVJFRl9CVUdfT04oYXRvbWlj
X3JlYWQoJndmLT5jb3VudCkgPD0gMCk7CiAJaWYgKHVubGlrZWx5KCFhdG9taWNfYWRkX3VubGVz
cygmd2YtPmNvdW50LCAtMSwgMSkpKQotCQlfX2ludGVsX3dha2VyZWZfcHV0X2xhc3Qod2YpOwor
CQlfX2ludGVsX3dha2VyZWZfcHV0X2xhc3Qod2YsIGZsYWdzKTsKK30KKworc3RhdGljIGlubGlu
ZSB2b2lkCitpbnRlbF93YWtlcmVmX3B1dChzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2YpCit7CisJ
X19pbnRlbF93YWtlcmVmX3B1dCh3ZiwgMCk7Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZAoraW50
ZWxfd2FrZXJlZl9wdXRfYXN5bmMoc3RydWN0IGludGVsX3dha2VyZWYgKndmKQoreworCV9faW50
ZWxfd2FrZXJlZl9wdXQod2YsIElOVEVMX1dBS0VSRUZfUFVUX0FTWU5DKTsKIH0KIAogLyoqCi0t
IAoyLjI0LjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
CkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpo
dHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

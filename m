Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 6666E3BD1F
	for <lists+intel-gfx@lfdr.de>; Mon, 10 Jun 2019 21:51:40 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id BAE5E89154;
	Mon, 10 Jun 2019 19:51:38 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 504DB89154
 for <intel-gfx@lists.freedesktop.org>; Mon, 10 Jun 2019 19:51:37 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 16856556-1500050 for multiple; Mon, 10 Jun 2019 20:51:33 +0100
MIME-Version: 1.0
To: Matthew Auld <matthew.william.auld@gmail.com>
From: Chris Wilson <chris@chris-wilson.co.uk>
In-Reply-To: <CAM0jSHOy7vy34LCvW4x7dK-pSF5yb3bb=_hXYuSDmd94ER7Vxw@mail.gmail.com>
References: <20190610072126.6355-1-chris@chris-wilson.co.uk>
 <20190610072126.6355-28-chris@chris-wilson.co.uk>
 <CAM0jSHOy7vy34LCvW4x7dK-pSF5yb3bb=_hXYuSDmd94ER7Vxw@mail.gmail.com>
Message-ID: <156019629150.2497.9556144011128786991@skylake-alporthouse-com>
User-Agent: alot/0.6
Date: Mon, 10 Jun 2019 20:51:31 +0100
Subject: Re: [Intel-gfx] [PATCH 27/28] drm/i915: Allow vma binding to occur
 asynchronously
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Intel Graphics Development <intel-gfx@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVvdGluZyBNYXR0aGV3IEF1bGQgKDIwMTktMDYtMTAgMTg6MzQ6NTIpCj4gT24gTW9uLCAxMCBK
dW4gMjAxOSBhdCAwODoyMSwgQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+
IHdyb3RlOgo+ID4KPiA+IElmIHdlIGxldCBwYWdlcyBiZSBhbGxvY2F0ZWQgYXN5bmNocm9ub3Vz
bHksIHdlIGFsc28gdGhlbiB3YW50IHRvIHB1c2gKPiA+IHRoZSBiaW5kaW5nIHByb2Nlc3MgaW50
byBhbiBhc3luY2hyb25vdXMgdGFzay4gTWFrZSBpdCBzbywgdXRpbGlzaW5nIHRoZQo+ID4gcmVj
ZW50IGltcHJvdmVtZW50cyB0byBmZW5jZSBlcnJvciB0cmFja2luZyBhbmQgc3RydWN0X211dGV4
IHJlZHVjdGlvbi4KPiA+Cj4gPiBTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNo
cmlzLXdpbHNvbi5jby51az4KPiAKPiBbc25pcF0KPiAKPiA+ICtzdGF0aWMgaW50IHF1ZXVlX2Fz
eW5jX2JpbmQoc3RydWN0IGk5MTVfdm1hICp2bWEsCj4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZW51bSBpOTE1X2NhY2hlX2xldmVsIGNhY2hlX2xldmVsLAo+ID4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHUzMiBmbGFncykKPiA+ICt7Cj4gPiArICAgICAgIGJvb2wgcmVhZHkg
PSB0cnVlOwo+ID4gKwo+ID4gKyAgICAgICAvKiBXZSBhcmUgbm90IGFsbG93ZWQgdG8gc2hyaW5r
IGluc2lkZSB2bS0+bXV0ZXghICovCj4gPiArICAgICAgIHZtYS0+YXN5bmMuZG1hID0ga21hbGxv
YyhzaXplb2YoKnZtYS0+YXN5bmMuZG1hKSwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIEdGUF9OT1dBSVQgfCBfX0dGUF9OT1dBUk4pOwo+ID4gKyAgICAgICBpZiAoIXZtYS0+
YXN5bmMuZG1hKQo+ID4gKyAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwo+ID4gKwo+ID4g
KyAgICAgICBkbWFfZmVuY2VfaW5pdCh2bWEtPmFzeW5jLmRtYSwKPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgJmFzeW5jX2JpbmRfb3BzLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAmYXN5
bmNfbG9jaywKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgdm1hLT52bS0+aTkxNS0+bW0udW5v
cmRlcmVkX3RpbWVsaW5lLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAwKTsKPiA+ICsKPiA+
ICsgICAgICAgLyogWFhYIGZpbmQgYW5kIGF2b2lkIGFsbG9jYXRpb25zIHVuZGVyIHJlc2VydmF0
aW9uX29iamVjdCBsb2NrcyAqLwo+ID4gKyAgICAgICBpZiAoIWk5MTVfdm1hX3RyeWxvY2sodm1h
KSkgewo+ID4gKyAgICAgICAgICAgICAgIGtmcmVlKGZldGNoX2FuZF96ZXJvKCZ2bWEtPmFzeW5j
LmRtYSkpOwo+ID4gKyAgICAgICAgICAgICAgIHJldHVybiAtRUFHQUlOOwo+ID4gKyAgICAgICB9
Cj4gPiArCj4gPiArICAgICAgIGlmIChyY3VfYWNjZXNzX3BvaW50ZXIodm1hLT5yZXN2LT5mZW5j
ZV9leGNsKSkgeyAvKiBhc3luYyBwYWdlcyAqLwo+ID4gKyAgICAgICAgICAgICAgIHN0cnVjdCBk
bWFfZmVuY2UgKmYgPSByZXNlcnZhdGlvbl9vYmplY3RfZ2V0X2V4Y2wodm1hLT5yZXN2KTsKPiA+
ICsKPiA+ICsgICAgICAgICAgICAgICBpZiAoIWRtYV9mZW5jZV9hZGRfY2FsbGJhY2soZiwKPiA+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJnZtYS0+YXN5bmMu
Y2IsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fcXVl
dWVfYXN5bmNfYmluZCkpCj4gPiArICAgICAgICAgICAgICAgICAgICAgICByZWFkeSA9IGZhbHNl
Owo+ID4gKyAgICAgICB9Cj4gPiArICAgICAgIHJlc2VydmF0aW9uX29iamVjdF9hZGRfZXhjbF9m
ZW5jZSh2bWEtPnJlc3YsIHZtYS0+YXN5bmMuZG1hKTsKPiA+ICsgICAgICAgaTkxNV92bWFfdW5s
b2NrKHZtYSk7Cj4gPiArCj4gPiArICAgICAgIGk5MTVfdm1fZ2V0KHZtYS0+dm0pOwo+ID4gKyAg
ICAgICBpOTE1X3ZtYV9nZXQodm1hKTsKPiA+ICsgICAgICAgX19pOTE1X3ZtYV9waW4odm1hKTsg
LyogYXZvaWQgYmVpbmcgc2hydW5rICovCj4gPiArCj4gPiArICAgICAgIHZtYS0+YXN5bmMuY2Fj
aGVfbGV2ZWwgPSBjYWNoZV9sZXZlbDsKPiA+ICsgICAgICAgdm1hLT5hc3luYy5mbGFncyA9IGZs
YWdzOwo+IAo+IERvIHdlIG5lZWQgdG8gbW92ZSB0aGlzIHN0dWZmIHRvIGJlZm9yZSB0aGUgYWRk
X2NhbGxiYWNrPwoKWWVzLiBJJ20gdXNlZCB0byBoYXZpbmcgYW4gaTkxNV9zd19mZW5jZV9jb21t
aXQgdG8gaGF2ZSBldmVyeXRoaW5nIGluCnBsYWNlIGJlZm9yZSBJIGxldCBnbyA6KAoKPiA+ICsg
ICAgICAgaWYgKHJlYWR5KQo+ID4gKyAgICAgICAgICAgICAgIF9fcXVldWVfYXN5bmNfYmluZCh2
bWEtPmFzeW5jLmRtYSwgJnZtYS0+YXN5bmMuY2IpOwo+ID4gKwo+ID4gKyAgICAgICByZXR1cm4g
MDsKPiA+ICt9Cj4gPiArCj4gPiAgLyoqCj4gPiAgICogaTkxNV92bWFfYmluZCAtIFNldHMgdXAg
UFRFcyBmb3IgYW4gVk1BIGluIGl0J3MgY29ycmVzcG9uZGluZyBhZGRyZXNzIHNwYWNlLgo+ID4g
ICAqIEB2bWE6IFZNQSB0byBtYXAKPiA+IEBAIC0yOTMsMTcgKzQwNSwxMiBAQCBpbnQgaTkxNV92
bWFfYmluZChzdHJ1Y3QgaTkxNV92bWEgKnZtYSwgZW51bSBpOTE1X2NhY2hlX2xldmVsIGNhY2hl
X2xldmVsLAo+ID4gICAgICAgICB1MzIgdm1hX2ZsYWdzOwo+ID4gICAgICAgICBpbnQgcmV0Owo+
ID4KPiA+ICsgICAgICAgR0VNX0JVR19PTighZmxhZ3MpOwo+ID4gICAgICAgICBHRU1fQlVHX09O
KCFkcm1fbW1fbm9kZV9hbGxvY2F0ZWQoJnZtYS0+bm9kZSkpOwo+ID4gICAgICAgICBHRU1fQlVH
X09OKHZtYS0+c2l6ZSA+IHZtYS0+bm9kZS5zaXplKTsKPiA+IC0KPiA+IC0gICAgICAgaWYgKEdF
TV9ERUJVR19XQVJOX09OKHJhbmdlX292ZXJmbG93cyh2bWEtPm5vZGUuc3RhcnQsCj4gPiAtICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm1hLT5ub2RlLnNpemUs
Cj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm1hLT52
bS0+dG90YWwpKSkKPiA+IC0gICAgICAgICAgICAgICByZXR1cm4gLUVOT0RFVjsKPiA+IC0KPiA+
IC0gICAgICAgaWYgKEdFTV9ERUJVR19XQVJOX09OKCFmbGFncykpCj4gPiAtICAgICAgICAgICAg
ICAgcmV0dXJuIC1FSU5WQUw7Cj4gPiAtCj4gPiArICAgICAgIEdFTV9CVUdfT04ocmFuZ2Vfb3Zl
cmZsb3dzKHZtYS0+bm9kZS5zdGFydCwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdm1hLT5ub2RlLnNpemUsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHZtYS0+dm0tPnRvdGFsKSk7Cj4gPiAgICAgICAgIGJpbmRfZmxhZ3MgPSAwOwo+ID4gICAg
ICAgICBpZiAoZmxhZ3MgJiBQSU5fR0xPQkFMKQo+ID4gICAgICAgICAgICAgICAgIGJpbmRfZmxh
Z3MgfD0gSTkxNV9WTUFfR0xPQkFMX0JJTkQ7Cj4gPiBAQCAtMzE4LDE0ICs0MjUsMTggQEAgaW50
IGk5MTVfdm1hX2JpbmQoc3RydWN0IGk5MTVfdm1hICp2bWEsIGVudW0gaTkxNV9jYWNoZV9sZXZl
bCBjYWNoZV9sZXZlbCwKPiAKPiBBcmUgd2UgYWltaW5nIGZvciB2bWFfYmluZC92bWFfYmluZF9h
c3luYy92bWFfcGluL3ZtYV9waW5fYXN5bmMgZXRjID8KCkF0IHRoZSBtb21lbnQsIGl0J3MgYSBw
cmV0dHkgc3RyYWlnaHRmb3J3YXJkIHNwbGl0IGJldHdlZW4gZ2xvYmFsIGJlaW5nCnN5bmNocm9u
b3VzIGFuZCB1c2VyIGJlaW5nIGFzeW5jaHJvbm91cy4gTm93LCB1c2VyIHNob3VsZCBhbHdheXMg
cmVtYWluCmFzeW5jLCBpZiBvbmx5IGJlY2F1c2Ugd2UgaGF2ZSB0byBwbGF5IGdhbWVzIHdpdGgg
YXZvaWRpbmcgYWxsb2NhdGlvbnMKdW5kZXJuZWF0aCB2bS0+bXV0ZXg7IGJ1dCB3ZSBtYXkgd2Fu
dCB0byBtYWtlIGdsb2JhbCBvcHRpb25hbGx5IGFzeW5jCihpZiB3ZSBoYXZlIHNvbWUgY2FsbGVy
IHRoYXQgY2FyZXMpLgoKVGhlIGltcGxpY2F0aW9uIG9mIHRoZSBxdWVzdGlvbiBpcyB0aGF0IHlv
dSB3b3VsZCByYXRoZXIgYmUgYSBmbGFnCnVwZnJvbnQgc28gdGhhdCB3ZSBkb24ndCBoYXZlIHRv
IHJldHJvZml0IGxhdGVyIG9uIDopCgo+ID4gICAgICAgICBpZiAoYmluZF9mbGFncyA9PSAwKQo+
ID4gICAgICAgICAgICAgICAgIHJldHVybiAwOwo+ID4KPiA+IC0gICAgICAgR0VNX0JVR19PTigh
dm1hLT5wYWdlcyk7Cj4gPiArICAgICAgIGlmICgoYmluZF9mbGFncyAmIH52bWFfZmxhZ3MpICYg
STkxNV9WTUFfTE9DQUxfQklORCkKPiA+ICsgICAgICAgICAgICAgICBiaW5kX2ZsYWdzIHw9IEk5
MTVfVk1BX0FMTE9DX0JJTkQ7Cj4gPgo+ID4gICAgICAgICB0cmFjZV9pOTE1X3ZtYV9iaW5kKHZt
YSwgYmluZF9mbGFncyk7Cj4gPiAtICAgICAgIHJldCA9IHZtYS0+b3BzLT5iaW5kX3ZtYSh2bWEs
IGNhY2hlX2xldmVsLCBiaW5kX2ZsYWdzKTsKPiA+ICsgICAgICAgaWYgKGJpbmRfZmxhZ3MgJiBJ
OTE1X1ZNQV9BTExPQ19CSU5EKQo+ID4gKyAgICAgICAgICAgICAgIHJldCA9IHF1ZXVlX2FzeW5j
X2JpbmQodm1hLCBjYWNoZV9sZXZlbCwgYmluZF9mbGFncyk7Cj4gPiArICAgICAgIGVsc2UKPiA+
ICsgICAgICAgICAgICAgICByZXQgPSBfX3ZtYV9iaW5kKHZtYSwgY2FjaGVfbGV2ZWwsIGJpbmRf
ZmxhZ3MpOwo+ID4gICAgICAgICBpZiAocmV0KQo+ID4gICAgICAgICAgICAgICAgIHJldHVybiBy
ZXQ7Cj4gCj4gTG9va3MgbGlrZSBjbGVhcl9wYWdlcygpIGlzIGNhbGxlZCB1bmNvbmRpdGlvbmFs
bHkgaW4gdm1hX3JlbW92ZSgpIGlmCj4gd2UgZXJyb3Igb3V0IGhlcmUsIGV2ZW4gdGhvdWdoIHRo
YXQgaXMgbm93IHNldCBhcyBwYXJ0IG9mIHRoZSB3b3JrZXI/CgpSaWdodCwgSSBtb3ZlZCB0aGUg
LT5zZXRfcGFnZXMsIEkgc2hvdWxkIG1vdmUgdGhlIC0+Y2xlYXJfcGFnZXMuCgo+ID4gLSAgICAg
ICB2bWEtPmZsYWdzIHw9IGJpbmRfZmxhZ3M7Cj4gPiArICAgICAgIHZtYS0+ZmxhZ3MgfD0gYmlu
ZF9mbGFncyAmIH5JOTE1X1ZNQV9BTExPQ19CSU5EOwo+ID4gICAgICAgICByZXR1cm4gMDsKPiA+
ICB9Cj4gPgo+ID4gQEAgLTU2OSw3ICs2ODAsNyBAQCBpOTE1X3ZtYV9pbnNlcnQoc3RydWN0IGk5
MTVfdm1hICp2bWEsIHU2NCBzaXplLCB1NjQgYWxpZ25tZW50LCB1NjQgZmxhZ3MpCj4gPiAgICAg
ICAgIH0KPiA+Cj4gPiAgICAgICAgIGlmICh2bWEtPm9iaikgewo+ID4gLSAgICAgICAgICAgICAg
IHJldCA9IGk5MTVfZ2VtX29iamVjdF9waW5fcGFnZXModm1hLT5vYmopOwo+ID4gKyAgICAgICAg
ICAgICAgIHJldCA9IGk5MTVfZ2VtX29iamVjdF9waW5fcGFnZXNfYXN5bmModm1hLT5vYmopOwo+
ID4gICAgICAgICAgICAgICAgIGlmIChyZXQpCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICBy
ZXR1cm4gcmV0Owo+ID4KPiA+IEBAIC01NzgsMjUgKzY4OSwxOSBAQCBpOTE1X3ZtYV9pbnNlcnQo
c3RydWN0IGk5MTVfdm1hICp2bWEsIHU2NCBzaXplLCB1NjQgYWxpZ25tZW50LCB1NjQgZmxhZ3Mp
Cj4gPiAgICAgICAgICAgICAgICAgY2FjaGVfbGV2ZWwgPSAwOwo+ID4gICAgICAgICB9Cj4gPgo+
ID4gLSAgICAgICBHRU1fQlVHX09OKHZtYS0+cGFnZXMpOwo+ID4gLQo+ID4gLSAgICAgICByZXQg
PSB2bWEtPm9wcy0+c2V0X3BhZ2VzKHZtYSk7Cj4gPiAtICAgICAgIGlmIChyZXQpCj4gPiAtICAg
ICAgICAgICAgICAgZ290byBlcnJfdW5waW47Cj4gPiAtCj4gCj4gSSBndWVzcyBvbmUgY2FzdWFs
dHkgaGVyZSBpcyB0aGUgIW9mZnNldF9maXhlZCBwYXRoIGZvcgo+IGh1Z2UtZ3R0LXBhZ2VzLCBz
aW5jZSB3ZSBuZWVkIHRvIGluc3BlY3QgdGhlIHZtYS0+cGFnZV9zaXplcyBiZWxvdy4KPiBUaG91
Z2ggcHJvYmFibHkgbm90IHRoZSBlbmQgb2YgdGhlIHdvcmxkIGlmIHRoYXQncyB0aGUgY2FzZS4K
Cldob29wcy4gVGhhdCdzIGEgbnVpc2FuY2UgYXMgdGhlcmUgaXMgbm8gd2F5IHdlIGNhbiBrbm93
IGF0IHRoaXMgc3RhZ2UsCnNvIHdlJ2xsIGp1c3QgaGF2ZSB0byBhc3N1bWUgdGhlIHdvcnN0Lgot
Q2hyaXMKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50
ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBz
Oi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

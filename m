Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id BA5E2435B7
	for <lists+intel-gfx@lfdr.de>; Thu, 13 Jun 2019 13:58:27 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1D6B58996F;
	Thu, 13 Jun 2019 11:58:26 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id D49808994A
 for <intel-gfx@lists.freedesktop.org>; Thu, 13 Jun 2019 11:58:24 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16888035-1500050 
 for multiple; Thu, 13 Jun 2019 12:58:10 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 13 Jun 2019 12:58:09 +0100
Message-Id: <20190613115809.30156-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915: Refine i915_reset.lock_map
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

V2UgYWxyZWFkeSB1c2UgYSBtdXRleCB0byBzZXJpYWxpc2UgaTkxNV9yZXNldCgpIGFuZCB3ZWRn
aW5nLCBzbyBhbGwgd2UKbmVlZCBpdCB0byBsaW5rIHRoYXQgaW50byBpOTE1X3JlcXVlc3Rfd2Fp
dCgpIGFuZCB3ZSBoYXZlIG91ciBsb2NrIGN5Y2xlCmRldGVjdGlvbi4KClNpZ25lZC1vZmYtYnk6
IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgpDYzogTWlrYSBLdW9wcGFs
YSA8bWlrYS5rdW9wcGFsYUBsaW51eC5pbnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfcmVzZXQuYyAgICAgICAgICAgIHwgIDYgKystLS0tCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2Rydi5oICAgICAgICAgICAgICAgICAgfCAgOCAtLS0tLS0tLQogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyAgICAgICAgICAgICAgICAgIHwgIDMgLS0tCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYyAgICAgICAgICAgICAgfCAxMiArKysrKysr
KysrLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2dlbV9kZXZpY2UuYyB8
ICAyIC0tCiA1IGZpbGVzIGNoYW5nZWQsIDEyIGluc2VydGlvbnMoKyksIDE5IGRlbGV0aW9ucygt
KQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jCmluZGV4IDhiYTdhZjhiN2NlZC4u
YzY5YzI5OGUwZDJjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9y
ZXNldC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMKQEAgLTk3
OCwxMSArOTc4LDExIEBAIHZvaWQgaTkxNV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKIAogCW1pZ2h0X3NsZWVwKCk7CiAJR0VNX0JVR19PTighdGVzdF9iaXQoSTkxNV9SRVNF
VF9CQUNLT0ZGLCAmZXJyb3ItPmZsYWdzKSk7Ci0JbG9ja19tYXBfYWNxdWlyZSgmaTkxNS0+Z3Qu
cmVzZXRfbG9ja21hcCk7CisJbG9ja2RlcF9hc3NlcnRfaGVsZCgmZXJyb3ItPndlZGdlX211dGV4
KTsKIAogCS8qIENsZWFyIGFueSBwcmV2aW91cyBmYWlsZWQgYXR0ZW1wdHMgYXQgcmVjb3Zlcnku
IFRpbWUgdG8gdHJ5IGFnYWluLiAqLwogCWlmICghX19pOTE1X2dlbV91bnNldF93ZWRnZWQoaTkx
NSkpCi0JCWdvdG8gdW5sb2NrOworCQlyZXR1cm47CiAKIAlpZiAocmVhc29uKQogCQlkZXZfbm90
aWNlKGk5MTUtPmRybS5kZXYsICJSZXNldHRpbmcgY2hpcCBmb3IgJXNcbiIsIHJlYXNvbik7CkBA
IC0xMDMwLDggKzEwMzAsNiBAQCB2b2lkIGk5MTVfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCiAKIGZpbmlzaDoKIAlyZXNldF9maW5pc2goaTkxNSk7Ci11bmxvY2s6Ci0JbG9j
a19tYXBfcmVsZWFzZSgmaTkxNS0+Z3QucmVzZXRfbG9ja21hcCk7CiAJcmV0dXJuOwogCiB0YWlu
dDoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCmluZGV4IDkwZDk0ZDkwNGU2NS4uMzY4M2VmNmQ0YzI4
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKQEAgLTE5MDEsMTQgKzE5MDEsNiBAQCBzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSB7CiAJCWt0aW1lX3QgbGFzdF9pbml0X3RpbWU7CiAKIAkJc3RydWN0
IGk5MTVfdm1hICpzY3JhdGNoOwotCi0JCS8qCi0JCSAqIFdlIG11c3QgbmV2ZXIgd2FpdCBvbiB0
aGUgR1BVIHdoaWxlIGhvbGRpbmcgYSBsb2NrIGFzIHdlCi0JCSAqIG1heSBuZWVkIHRvIHBlcmZv
cm0gYSBHUFUgcmVzZXQuIFNvIHdoaWxlIHdlIGRvbid0IG5lZWQgdG8KLQkJICogc2VyaWFsaXNl
IHdhaXQvcmVzZXQgd2l0aCBhbiBleHBsaWNpdCBsb2NrLCB3ZSBkbyB3YW50Ci0JCSAqIGxvY2tk
ZXAgdG8gZGV0ZWN0IHBvdGVudGlhbCBkZXBlbmRlbmN5IGN5Y2xlcy4KLQkJICovCi0JCXN0cnVj
dCBsb2NrZGVwX21hcCByZXNldF9sb2NrbWFwOwogCX0gZ3Q7CiAKIAlzdHJ1Y3QgewpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZ2VtLmMKaW5kZXggNGJiZGVkNGFhOTM2Li43MjMyMzYxOTczZmQgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9nZW0uYwpAQCAtMTc0Niw3ICsxNzQ2LDYgQEAgc3RhdGljIHZvaWQgaTkxNV9n
ZW1faW5pdF9fbW0oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAKIGludCBpOTE1X2dl
bV9pbml0X2Vhcmx5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKLQlzdGF0
aWMgc3RydWN0IGxvY2tfY2xhc3Nfa2V5IHJlc2V0X2tleTsKIAlpbnQgZXJyOwogCiAJaW50ZWxf
Z3RfcG1faW5pdChkZXZfcHJpdik7CkBAIC0xNzU0LDggKzE3NTMsNiBAQCBpbnQgaTkxNV9nZW1f
aW5pdF9lYXJseShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJSU5JVF9MSVNU
X0hFQUQoJmRldl9wcml2LT5ndC5hY3RpdmVfcmluZ3MpOwogCUlOSVRfTElTVF9IRUFEKCZkZXZf
cHJpdi0+Z3QuY2xvc2VkX3ZtYSk7CiAJc3Bpbl9sb2NrX2luaXQoJmRldl9wcml2LT5ndC5jbG9z
ZWRfbG9jayk7Ci0JbG9ja2RlcF9pbml0X21hcCgmZGV2X3ByaXYtPmd0LnJlc2V0X2xvY2ttYXAs
Ci0JCQkgImk5MTUucmVzZXQiLCAmcmVzZXRfa2V5LCAwKTsKIAogCWk5MTVfZ2VtX2luaXRfX21t
KGRldl9wcml2KTsKIAlpOTE1X2dlbV9pbml0X19wbShkZXZfcHJpdik7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfcmVxdWVzdC5jCmluZGV4IDFjYmMzZWY0ZmMyNy4uNTMxMTI4NjU3OGI3IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYwpAQCAtMTQ0NCw3ICsxNDQ0LDE1IEBAIGxvbmcgaTkx
NV9yZXF1ZXN0X3dhaXQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCiAJCXJldHVybiAtRVRJTUU7
CiAKIAl0cmFjZV9pOTE1X3JlcXVlc3Rfd2FpdF9iZWdpbihycSwgZmxhZ3MpOwotCWxvY2tfbWFw
X2FjcXVpcmUoJnJxLT5pOTE1LT5ndC5yZXNldF9sb2NrbWFwKTsKKworCS8qCisJICogV2UgbXVz
dCBuZXZlciB3YWl0IG9uIHRoZSBHUFUgd2hpbGUgaG9sZGluZyBhIGxvY2sgYXMgd2UKKwkgKiBt
YXkgbmVlZCB0byBwZXJmb3JtIGEgR1BVIHJlc2V0LiBTbyB3aGlsZSB3ZSBkb24ndCBuZWVkIHRv
CisJICogc2VyaWFsaXNlIHdhaXQvcmVzZXQgd2l0aCBhbiBleHBsaWNpdCBsb2NrLCB3ZSBkbyB3
YW50CisJICogbG9ja2RlcCB0byBkZXRlY3QgcG90ZW50aWFsIGRlcGVuZGVuY3kgY3ljbGVzLgor
CSAqLworCW11dGV4X2FjcXVpcmUoJnJxLT5pOTE1LT5ncHVfZXJyb3Iud2VkZ2VfbXV0ZXguZGVw
X21hcCwKKwkJICAgICAgMCwgMCwgX1RISVNfSVBfKTsKIAogCS8qCiAJICogT3B0aW1pc3RpYyBz
cGluIGJlZm9yZSB0b3VjaGluZyBJUlFzLgpAQCAtMTUxOCw3ICsxNTI2LDcgQEAgbG9uZyBpOTE1
X3JlcXVlc3Rfd2FpdChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKIAlkbWFfZmVuY2VfcmVtb3Zl
X2NhbGxiYWNrKCZycS0+ZmVuY2UsICZ3YWl0LmNiKTsKIAogb3V0OgotCWxvY2tfbWFwX3JlbGVh
c2UoJnJxLT5pOTE1LT5ndC5yZXNldF9sb2NrbWFwKTsKKwltdXRleF9yZWxlYXNlKCZycS0+aTkx
NS0+Z3B1X2Vycm9yLndlZGdlX211dGV4LmRlcF9tYXAsIDAsIF9USElTX0lQXyk7CiAJdHJhY2Vf
aTkxNV9yZXF1ZXN0X3dhaXRfZW5kKHJxKTsKIAlyZXR1cm4gdGltZW91dDsKIH0KZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2dlbV9kZXZpY2UuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2dlbV9kZXZpY2UuYwppbmRleCAxZTlm
ZmNlZDc4YzEuLmI3ZjNmYmI0YWU4OSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
c2VsZnRlc3RzL21vY2tfZ2VtX2RldmljZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3Nl
bGZ0ZXN0cy9tb2NrX2dlbV9kZXZpY2UuYwpAQCAtMTMwLDcgKzEzMCw2IEBAIHN0YXRpYyBzdHJ1
Y3QgZGV2X3BtX2RvbWFpbiBwbV9kb21haW4gPSB7CiAKIHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICptb2NrX2dlbV9kZXZpY2Uodm9pZCkKIHsKLQlzdGF0aWMgc3RydWN0IGxvY2tfY2xhc3Nfa2V5
IHJlc2V0X2tleTsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNTsKIAlzdHJ1Y3QgcGNp
X2RldiAqcGRldjsKIAlpbnQgZXJyOwpAQCAtMjA1LDcgKzIwNCw2IEBAIHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICptb2NrX2dlbV9kZXZpY2Uodm9pZCkKIAlJTklUX0xJU1RfSEVBRCgmaTkxNS0+
Z3QuYWN0aXZlX3JpbmdzKTsKIAlJTklUX0xJU1RfSEVBRCgmaTkxNS0+Z3QuY2xvc2VkX3ZtYSk7
CiAJc3Bpbl9sb2NrX2luaXQoJmk5MTUtPmd0LmNsb3NlZF9sb2NrKTsKLQlsb2NrZGVwX2luaXRf
bWFwKCZpOTE1LT5ndC5yZXNldF9sb2NrbWFwLCAiaTkxNS5yZXNldCIsICZyZXNldF9rZXksIDAp
OwogCiAJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAKLS0gCjIuMjAuMQoK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4
IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlz
dHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id B768BAD259
	for <lists+intel-gfx@lfdr.de>; Mon,  9 Sep 2019 05:42:14 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 5BFCD89654;
	Mon,  9 Sep 2019 03:42:11 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga01.intel.com (mga01.intel.com [192.55.52.88])
 by gabe.freedesktop.org (Postfix) with ESMTPS id F0CE289364
 for <intel-gfx@lists.freedesktop.org>; Mon,  9 Sep 2019 03:42:08 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga005.fm.intel.com ([10.253.24.32])
 by fmsmga101.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 08 Sep 2019 20:42:08 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,483,1559545200"; d="scan'208";a="383846699"
Received: from labuser-z97x-ud5h.jf.intel.com ([10.54.75.49])
 by fmsmga005.fm.intel.com with ESMTP; 08 Sep 2019 20:42:08 -0700
From: Manasi Navare <manasi.d.navare@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Sun,  8 Sep 2019 20:43:23 -0700
Message-Id: <20190909034325.20006-5-manasi.d.navare@intel.com>
X-Mailer: git-send-email 2.19.1
In-Reply-To: <20190909034325.20006-1-manasi.d.navare@intel.com>
References: <20190909034325.20006-1-manasi.d.navare@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 4/6] drm/i915/display/icl: Enable master-slaves
 in trans port sync
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Daniel Vetter <daniel.vetter@ffwll.ch>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QXMgcGVyIHRoZSBkaXNwbGF5IGVuYWJsZSBzZXF1ZW5jZSwgd2UgbmVlZCB0byBmb2xsb3cgdGhl
IGVuYWJsZSBzZXF1ZW5jZQpmb3Igc2xhdmVzIGZpcnN0IHdpdGggRFBfVFBfQ1RMIHNldCB0byBJ
ZGxlIGFuZCBjb25maWd1cmUgdGhlIHRyYW5zY29kZXIKcG9ydCBzeW5jIHJlZ2lzdGVyIHRvIHNl
bGVjdCB0aGUgY29yZXJzcG9uZGluZyBtYXN0ZXIsIHRoZW4gZm9sbG93IHRoZQplbmFibGUgc2Vx
dWVuY2UgZm9yIG1hc3RlciBsZWF2aW5nIERQX1RQX0NUTCB0byBpZGxlLgpBdCB0aGlzIHBvaW50
IHRoZSB0cmFuc2NvZGVyIHBvcnQgc3luYyBtb2RlIGlzIGNvbmZpZ3VyZWQgYW5kIGVuYWJsZWQK
YW5kIHRoZSBWYmxhbmtzIG9mIGJvdGggcG9ydHMgYXJlIHN5bmNocm9uaXplZCBzbyB0aGVuIHNl
dCBEUF9UUF9DVEwKZm9yIHRoZSBzbGF2ZSBhbmQgbWFzdGVyIHRvIE5vcm1hbCBhbmQgZG8gcG9z
dCBjcnRjIGVuYWJsZSB1cGRhdGVzLgoKdjQ6CiogUmV1c2Ugc2tsX2NvbW1pdF9tb2Rlc2V0X2Vu
YWJsZXMoKSBob29rIChNYWFydGVuKQoqIE9idGFpbiBzbGF2ZSBjcnRjIGFuZCBzdGF0ZXMgZnJv
bSBtYXN0ZXIgKE1hYXJ0ZW4pCnYzOgoqIFJlYmFzZSBvbiBkcm0tdGlwIChNYW5hc2kpCnYyOgoq
IENyZWF0ZSBhIGljbF91cGRhdGVfY3J0Y3MgaG9vayAoTWFhcnRlbiwgRGFudmV0KQoqIFRoaXMg
c2VxdWVuY2Ugb25seSBmb3IgQ1JUQ3MgaW4gdHJhbnMgcG9ydCBzeW5jIG1vZGUgKE1hYXJ0ZW4p
CgpDYzogRGFuaWVsIFZldHRlciA8ZGFuaWVsLnZldHRlckBmZndsbC5jaD4KQ2M6IFZpbGxlIFN5
cmrDpGzDpCA8dmlsbGUuc3lyamFsYUBsaW51eC5pbnRlbC5jb20+CkNjOiBNYWFydGVuIExhbmto
b3JzdCA8bWFhcnRlbi5sYW5raG9yc3RAbGludXguaW50ZWwuY29tPgpDYzogTWF0dCBSb3BlciA8
bWF0dGhldy5kLnJvcGVyQGludGVsLmNvbT4KU2lnbmVkLW9mZi1ieTogTWFuYXNpIE5hdmFyZSA8
bWFuYXNpLmQubmF2YXJlQGludGVsLmNvbT4KClNpZ25lZC1vZmYtYnk6IE1hbmFzaSBOYXZhcmUg
PG1hbmFzaS5kLm5hdmFyZUBpbnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kZGkuYyAgICAgfCAgIDMgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfZGlzcGxheS5jIHwgMTU4ICsrKysrKysrKysrKysrKysrKy0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5oIHwgICA0ICsKIDMgZmlsZXMgY2hhbmdl
ZCwgMTYyIGluc2VydGlvbnMoKyksIDMgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZGRpLmMKaW5kZXggM2U2Mzk0MTM5OTY0Li42MmU5ZjU2MDJiNmIgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGkuYwpAQCAtMzM0Nyw3ICszMzQ3
LDggQEAgc3RhdGljIHZvaWQgaHN3X2RkaV9wcmVfZW5hYmxlX2RwKHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyLAogCQkJCQkgICAgICB0cnVlKTsKIAlpbnRlbF9kcF9zaW5rX3NldF9mZWNf
cmVhZHkoaW50ZWxfZHAsIGNydGNfc3RhdGUpOwogCWludGVsX2RwX3N0YXJ0X2xpbmtfdHJhaW4o
aW50ZWxfZHApOwotCWlmIChwb3J0ICE9IFBPUlRfQSB8fCBJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDkpCisJaWYgKChwb3J0ICE9IFBPUlRfQSB8fCBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpICYm
CisJICAgICFpc190cmFuc19wb3J0X3N5bmNfbW9kZShkZXZfcHJpdiwgY3J0Y19zdGF0ZSkpCiAJ
CWludGVsX2RwX3N0b3BfbGlua190cmFpbihpbnRlbF9kcCk7CiAKIAlpbnRlbF9kZGlfZW5hYmxl
X2ZlYyhlbmNvZGVyLCBjcnRjX3N0YXRlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9kaXNwbGF5LmMKaW5kZXggNzZjYTFjYTg2NGMwLi4zNTFjOTBhZDcwNTkgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCkBAIC01MjEsNiAr
NTIxLDI0IEBAIG5lZWRzX21vZGVzZXQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnN0
YXRlKQogCXJldHVybiBkcm1fYXRvbWljX2NydGNfbmVlZHNfbW9kZXNldCgmc3RhdGUtPmJhc2Up
OwogfQogCitib29sCitpc190cmFuc19wb3J0X3N5bmNfbW9kZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCisJCQljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqc3RhdGUp
Cit7CisJcmV0dXJuIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExICYmCisJCShzdGF0ZS0+bWFz
dGVyX3RyYW5zY29kZXIgIT0gSU5WQUxJRF9UUkFOU0NPREVSIHx8CisJCSBzdGF0ZS0+c3luY19t
b2RlX3NsYXZlc19tYXNrKSk7Cit9CisKK3N0YXRpYyBib29sCitpc190cmFuc19wb3J0X3N5bmNf
bWFzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKKwkJCSAgY29uc3Qgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKnN0YXRlKQoreworCXJldHVybiAoSU5URUxfR0VOKGRldl9w
cml2KSA+PSAxMSAmJgorCQkoc3RhdGUtPm1hc3Rlcl90cmFuc2NvZGVyID09IElOVkFMSURfVFJB
TlNDT0RFUiAmJgorCQkgc3RhdGUtPnN5bmNfbW9kZV9zbGF2ZXNfbWFzaykpOworfQorCiAvKgog
ICogUGxhdGZvcm0gc3BlY2lmaWMgaGVscGVycyB0byBjYWxjdWxhdGUgdGhlIHBvcnQgUExMIGxv
b3BiYWNrLSAoY2xvY2subSksCiAgKiBhbmQgcG9zdC1kaXZpZGVyIChjbG9jay5wKSB2YWx1ZXMs
IHByZS0gKGNsb2NrLnZjbykgYW5kIHBvc3QtZGl2aWRlZCBmYXN0CkBAIC0xMzk3NCw2ICsxMzk5
MiwzMCBAQCBzdGF0aWMgdm9pZCBpbnRlbF91cGRhdGVfY3J0YyhzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YywKIAlpbnRlbF9maW5pc2hfY3J0Y19jb21taXQoc3RhdGUsIGNydGMpOwogfQogCitzdGF0
aWMgc3RydWN0IGludGVsX2NydGMgKiBpbnRlbF9nZXRfc2xhdmVfY3J0YyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkJCQlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3
X2NydGNfc3RhdGUpCit7CisJaWYgKG5ld19jcnRjX3N0YXRlLT5zeW5jX21vZGVfc2xhdmVzX21h
c2sgJgorCSAgICBCSVQoVFJBTlNDT0RFUl9BKSkKKwkJcmV0dXJuIGludGVsX2dldF9jcnRjX2Zv
cl9waXBlKGRldl9wcml2LAorCQkJCQkgICAgICAgUElQRV9BKTsKKwllbHNlIGlmIChuZXdfY3J0
Y19zdGF0ZS0+c3luY19tb2RlX3NsYXZlc19tYXNrICYKKwkJIEJJVChUUkFOU0NPREVSX0IpKQor
CQlyZXR1cm4gaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsCisJCQkJCSAgICAgICBQ
SVBFX0IpOworCWVsc2UgaWYgKG5ld19jcnRjX3N0YXRlLT5zeW5jX21vZGVfc2xhdmVzX21hc2sg
JgorCQkgQklUKFRSQU5TQ09ERVJfQykpCisJCXJldHVybiBpbnRlbF9nZXRfY3J0Y19mb3JfcGlw
ZShkZXZfcHJpdiwKKwkJCQkJICAgICAgIFBJUEVfQyk7CisJZWxzZSBpZiAobmV3X2NydGNfc3Rh
dGUtPnN5bmNfbW9kZV9zbGF2ZXNfbWFzayAmCisJCSBCSVQoVFJBTlNDT0RFUl9EKSkKKwkJcmV0
dXJuIGludGVsX2dldF9jcnRjX2Zvcl9waXBlKGRldl9wcml2LAorCQkJCQkgICAgICAgUElQRV9E
KTsKKwkvKiBzaG91bGQgbmV2ZXIgaGFwcGVuICovCisJV0FSTl9PTigxKTsKKwlyZXR1cm4gTlVM
TDsKK30KKwogc3RhdGljIHZvaWQgaW50ZWxfb2xkX2NydGNfc3RhdGVfZGlzYWJsZXMoc3RydWN0
IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCiAJCQkJCSAgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKm9sZF9jcnRjX3N0YXRlLAogCQkJCQkgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpuZXdf
Y3J0Y19zdGF0ZSwKQEAgLTE0MDUyLDYgKzE0MDk0LDEwNCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9j
b21taXRfbW9kZXNldF9lbmFibGVzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQog
CX0KIH0KIAorc3RhdGljIHZvaWQgaW50ZWxfY3J0Y19lbmFibGVfdHJhbnNfcG9ydF9zeW5jKHN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjLAorCQkJCQkgICAgICBzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0
YXRlICpzdGF0ZSwKKwkJCQkJICAgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRj
X3N0YXRlKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
c3RhdGUtPmJhc2UuZGV2KTsKKworCXVwZGF0ZV9zY2FubGluZV9vZmZzZXQobmV3X2NydGNfc3Rh
dGUpOworCWRldl9wcml2LT5kaXNwbGF5LmNydGNfZW5hYmxlKG5ld19jcnRjX3N0YXRlLCBzdGF0
ZSk7CisJaW50ZWxfY3J0Y19lbmFibGVfcGlwZV9jcmMoY3J0Yyk7Cit9CisKK3N0YXRpYyB2b2lk
IGludGVsX3NldF9kcF90cF9jdGxfbm9ybWFsKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAorCQkJ
CSAgICAgICBzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKK3sKKwlzdHJ1Y3QgZHJt
X2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZTsKKwlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29u
bjsKKwlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwOworCWludCBpOworCisJZm9yX2VhY2hfbmV3
X2Nvbm5lY3Rvcl9pbl9zdGF0ZSgmc3RhdGUtPmJhc2UsIGNvbm4sIGNvbm5fc3RhdGUsIGkpIHsK
KwkJaWYgKGNvbm5fc3RhdGUtPmNydGMgPT0gJmNydGMtPmJhc2UpCisJCQlicmVhazsKKwl9CisJ
aW50ZWxfZHAgPSBlbmNfdG9faW50ZWxfZHAoJmludGVsX2F0dGFjaGVkX2VuY29kZXIoY29ubikt
PmJhc2UpOworCWludGVsX2RwX3N0b3BfbGlua190cmFpbihpbnRlbF9kcCk7Cit9CisKK3N0YXRp
YyB2b2lkIGludGVsX3Bvc3RfY3J0Y19lbmFibGVfdXBkYXRlcyhzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YywKKwkJCQkJICAgc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkJCSAg
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKKwkJCQkJICAgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQoreworCXN0cnVjdCBpbnRlbF9wbGFu
ZV9zdGF0ZSAqbmV3X3BsYW5lX3N0YXRlID0KKwkJaW50ZWxfYXRvbWljX2dldF9uZXdfcGxhbmVf
c3RhdGUoc3RhdGUsCisJCQkJCQkgdG9faW50ZWxfcGxhbmUoY3J0Yy0+YmFzZS5wcmltYXJ5KSk7
CisKKwlpZiAobmV3X2NydGNfc3RhdGUtPnVwZGF0ZV9waXBlICYmICFuZXdfY3J0Y19zdGF0ZS0+
ZW5hYmxlX2ZiYykKKwkJaW50ZWxfZmJjX2Rpc2FibGUoY3J0Yyk7CisJZWxzZSBpZiAobmV3X3Bs
YW5lX3N0YXRlKQorCQlpbnRlbF9mYmNfZW5hYmxlKGNydGMsIG5ld19jcnRjX3N0YXRlLCBuZXdf
cGxhbmVfc3RhdGUpOworCisJaW50ZWxfYmVnaW5fY3J0Y19jb21taXQoc3RhdGUsIGNydGMpOwor
CXNrbF91cGRhdGVfcGxhbmVzX29uX2NydGMoc3RhdGUsIGNydGMpOworCWludGVsX2ZpbmlzaF9j
cnRjX2NvbW1pdChzdGF0ZSwgY3J0Yyk7Cit9CisKK3N0YXRpYyB2b2lkIGludGVsX3VwZGF0ZV90
cmFuc19wb3J0X3N5bmNfY3J0Y3Moc3RydWN0IGludGVsX2NydGMgKmNydGMsCisJCQkJCSAgICAg
ICBzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKKwkJCQkJICAgICAgIHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKKwkJCQkJICAgICAgIHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0ZSkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHN0YXRlLT5iYXNlLmRldik7CisJc3RydWN0IGludGVsX2Ny
dGMgKnNsYXZlX2NydGMgPSBpbnRlbF9nZXRfc2xhdmVfY3J0YyhkZXZfcHJpdiwKKwkJCQkJCQkg
ICAgIG5ld19jcnRjX3N0YXRlKTsKKwlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X3NsYXZl
X2NydGNfc3RhdGUgPQorCQlpbnRlbF9hdG9taWNfZ2V0X25ld19jcnRjX3N0YXRlKHN0YXRlLCBz
bGF2ZV9jcnRjKTsKKwlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX3NsYXZlX2NydGNfc3Rh
dGUgPQorCQlpbnRlbF9hdG9taWNfZ2V0X29sZF9jcnRjX3N0YXRlKHN0YXRlLCBzbGF2ZV9jcnRj
KTsKKworCVdBUk5fT04oIXNsYXZlX2NydGMgfHwgIW5ld19zbGF2ZV9jcnRjX3N0YXRlIHx8CisJ
CSFvbGRfc2xhdmVfY3J0Y19zdGF0ZSk7CisKKwlEUk1fREVCVUdfS01TKCJVcGRhdGluZyBUcmFu
c2NvZGVyIFBvcnQgU3luYyBNYXN0ZXIgQ1JUQyA9ICVkICVzIGFuZCBTbGF2ZSBDUlRDICVkICVz
XG4iLAorCQkgICAgICBjcnRjLT5iYXNlLmJhc2UuaWQsIGNydGMtPmJhc2UubmFtZSwgc2xhdmVf
Y3J0Yy0+YmFzZS5iYXNlLmlkLAorCQkgICAgICBzbGF2ZV9jcnRjLT5iYXNlLm5hbWUpOworCisJ
LyogRW5hYmxlIHNlcSBmb3Igc2xhdmUgd2l0aCB3aXRoIERQX1RQX0NUTCBsZWZ0IElkbGUgdW50
aWwgdGhlCisJICogbWFzdGVyIGlzIHJlYWR5CisJICovCisJaW50ZWxfY3J0Y19lbmFibGVfdHJh
bnNfcG9ydF9zeW5jKHNsYXZlX2NydGMsCisJCQkJCSAgc3RhdGUsCisJCQkJCSAgbmV3X3NsYXZl
X2NydGNfc3RhdGUpOworCisJLyogRW5hYmxlIHNlcSBmb3IgbWFzdGVyIHdpdGggd2l0aCBEUF9U
UF9DVEwgbGVmdCBJZGxlICovCisJaW50ZWxfY3J0Y19lbmFibGVfdHJhbnNfcG9ydF9zeW5jKGNy
dGMsCisJCQkJCSAgc3RhdGUsCisJCQkJCSAgbmV3X2NydGNfc3RhdGUpOworCisJLyogU2V0IFNs
YXZlJ3MgRFBfVFBfQ1RMIHRvIE5vcm1hbCAqLworCWludGVsX3NldF9kcF90cF9jdGxfbm9ybWFs
KHNsYXZlX2NydGMsCisJCQkJICAgc3RhdGUpOworCisJLyogU2V0IE1hc3RlcidzIERQX1RQX0NU
TCBUbyBOb3JtYWwgKi8KKwl1c2xlZXBfcmFuZ2UoMjAwLCA0MDApOworCWludGVsX3NldF9kcF90
cF9jdGxfbm9ybWFsKGNydGMsCisJCQkJICAgc3RhdGUpOworCisJLyogTm93IGRvIHRoZSBwb3N0
IGNydGMgZW5hYmxlIGZvciBhbGwgbWFzdGVyIGFuZCBzbGF2ZXMgKi8KKwlpbnRlbF9wb3N0X2Ny
dGNfZW5hYmxlX3VwZGF0ZXMoc2xhdmVfY3J0YywKKwkJCQkgICAgICAgc3RhdGUsCisJCQkJICAg
ICAgIG5ld19zbGF2ZV9jcnRjX3N0YXRlLAorCQkJCSAgICAgICBvbGRfc2xhdmVfY3J0Y19zdGF0
ZSk7CisJaW50ZWxfcG9zdF9jcnRjX2VuYWJsZV91cGRhdGVzKGNydGMsCisJCQkJICAgICAgIHN0
YXRlLAorCQkJCSAgICAgICBuZXdfY3J0Y19zdGF0ZSwKKwkJCQkgICAgICAgb2xkX2NydGNfc3Rh
dGUpOworfQorCiBzdGF0aWMgdm9pZCBza2xfY29tbWl0X21vZGVzZXRfZW5hYmxlcyhzdHJ1Y3Qg
aW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KHN0YXRlLT5iYXNlLmRldik7CkBAIC0xNDA4Niw2ICsxNDIyNiw3
IEBAIHN0YXRpYyB2b2lkIHNrbF9jb21taXRfbW9kZXNldF9lbmFibGVzKHN0cnVjdCBpbnRlbF9h
dG9taWNfc3RhdGUgKnN0YXRlKQogCQlmb3JfZWFjaF9vbGRuZXdfaW50ZWxfY3J0Y19pbl9zdGF0
ZShzdGF0ZSwgY3J0Yywgb2xkX2NydGNfc3RhdGUsIG5ld19jcnRjX3N0YXRlLCBpKSB7CiAJCQli
b29sIHZibF93YWl0ID0gZmFsc2U7CiAJCQl1bnNpZ25lZCBpbnQgY21hc2sgPSBkcm1fY3J0Y19t
YXNrKCZjcnRjLT5iYXNlKTsKKwkJCWJvb2wgbW9kZXNldCA9IG5lZWRzX21vZGVzZXQobmV3X2Ny
dGNfc3RhdGUpOwogCiAJCQlwaXBlID0gY3J0Yy0+cGlwZTsKIApAQCAtMTQxMDgsMTIgKzE0MjQ5
LDI1IEBAIHN0YXRpYyB2b2lkIHNrbF9jb21taXRfbW9kZXNldF9lbmFibGVzKHN0cnVjdCBpbnRl
bF9hdG9taWNfc3RhdGUgKnN0YXRlKQogCQkJICovCiAJCQlpZiAoIXNrbF9kZGJfZW50cnlfZXF1
YWwoJm5ld19jcnRjX3N0YXRlLT53bS5za2wuZGRiLAogCQkJCQkJICZvbGRfY3J0Y19zdGF0ZS0+
d20uc2tsLmRkYikgJiYKKwkJCSAgICAhbW9kZXNldCAmJgogCQkJICAgICFuZXdfY3J0Y19zdGF0
ZS0+YmFzZS5hY3RpdmVfY2hhbmdlZCAmJgogCQkJICAgIHN0YXRlLT53bV9yZXN1bHRzLmRpcnR5
X3BpcGVzICE9IHVwZGF0ZWQpCiAJCQkJdmJsX3dhaXQgPSB0cnVlOwogCi0JCQlpbnRlbF91cGRh
dGVfY3J0YyhjcnRjLCBzdGF0ZSwgb2xkX2NydGNfc3RhdGUsCi0JCQkJCSAgbmV3X2NydGNfc3Rh
dGUpOworCQkJaWYgKG1vZGVzZXQgJiYgaXNfdHJhbnNfcG9ydF9zeW5jX21vZGUoZGV2X3ByaXYs
CisJCQkJCQkJICAgICAgIG5ld19jcnRjX3N0YXRlKSkgeworCQkJCWlmIChpc190cmFuc19wb3J0
X3N5bmNfbWFzdGVyKGRldl9wcml2LAorCQkJCQkJCSAgICAgIG5ld19jcnRjX3N0YXRlKSkKKwkJ
CQkJaW50ZWxfdXBkYXRlX3RyYW5zX3BvcnRfc3luY19jcnRjcyhjcnRjLAorCQkJCQkJCQkJICAg
c3RhdGUsCisJCQkJCQkJCQkgICBvbGRfY3J0Y19zdGF0ZSwKKwkJCQkJCQkJCSAgIG5ld19jcnRj
X3N0YXRlKTsKKwkJCQllbHNlCisJCQkJCWNvbnRpbnVlOworCQkJfSBlbHNlIHsKKwkJCQlpbnRl
bF91cGRhdGVfY3J0YyhjcnRjLCBzdGF0ZSwgb2xkX2NydGNfc3RhdGUsCisJCQkJCQkgIG5ld19j
cnRjX3N0YXRlKTsKKwkJCX0KIAogCQkJaWYgKHZibF93YWl0KQogCQkJCWludGVsX3dhaXRfZm9y
X3ZibGFuayhkZXZfcHJpdiwgcGlwZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfZGlzcGxheS5oCmluZGV4IGMxMDExMjA0YjQwNy4uM2UwYTM2ZWM1ODBkIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuaAorKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuaApAQCAtMjcsNiArMjcs
NyBAQAogCiAjaW5jbHVkZSA8ZHJtL2RybV91dGlsLmg+CiAjaW5jbHVkZSA8ZHJtL2k5MTVfZHJt
Lmg+CisjaW5jbHVkZSAiaW50ZWxfZHBfbGlua190cmFpbmluZy5oIgogCiBlbnVtIGxpbmtfbV9u
X3NldDsKIHN0cnVjdCBkcGxsOwpAQCAtNTIsNiArNTMsNyBAQCBzdHJ1Y3QgaW50ZWxfcGxhbmU7
CiBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGU7CiBzdHJ1Y3QgaW50ZWxfcmVtYXBwZWRfaW5mbzsK
IHN0cnVjdCBpbnRlbF9yb3RhdGlvbl9pbmZvOworc3RydWN0IGludGVsX2NydGNfc3RhdGU7CiAK
IGVudW0gaTkxNV9ncGlvIHsKIAlHUElPQSwKQEAgLTQ0OSw2ICs0NTEsOCBAQCB1MzIgaW50ZWxf
cGxhbmVfZmJfbWF4X3N0cmlkZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJ
CQkgICAgICB1MzIgcGl4ZWxfZm9ybWF0LCB1NjQgbW9kaWZpZXIpOwogYm9vbCBpbnRlbF9wbGFu
ZV9jYW5fcmVtYXAoY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSk7
CiBlbnVtIHBoeSBpbnRlbF9wb3J0X3RvX3BoeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwgZW51bSBwb3J0IHBvcnQpOworYm9vbCBpc190cmFuc19wb3J0X3N5bmNfbW9kZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKKwkJCSAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKnN0YXRlKTsKIAogdm9pZCBpbnRlbF9wbGFuZV9kZXN0cm95KHN0cnVjdCBkcm1fcGxh
bmUgKnBsYW5lKTsKIHZvaWQgaTgzMF9lbmFibGVfcGlwZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsIGVudW0gcGlwZSBwaXBlKTsKLS0gCjIuMTkuMQoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJ
bnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Au
b3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

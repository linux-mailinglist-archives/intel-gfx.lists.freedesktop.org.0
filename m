Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id DAA37E0E49
	for <lists+intel-gfx@lfdr.de>; Wed, 23 Oct 2019 00:39:19 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7EAF06E925;
	Tue, 22 Oct 2019 22:39:17 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7AAEE6E919
 for <intel-gfx@lists.freedesktop.org>; Tue, 22 Oct 2019 22:39:05 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18930835-1500050 
 for multiple; Tue, 22 Oct 2019 23:38:54 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 22 Oct 2019 23:38:23 +0100
Message-Id: <20191022223831.22677-4-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0.rc0
In-Reply-To: <20191022223831.22677-1-chris@chris-wilson.co.uk>
References: <20191022223831.22677-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 04/12] drm/i915/gt: Expose reset stop timeout
 via sysfs
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QWxsb3cgb3Vyc2VsdmVzIHRvIHNsZWVwIGJlZm9yZSBhIEdQVSByZXNldCwgZm9yIGEgZmV3IG1p
bGxpc2Vjb25kcy4KVGhpcyBhbGxvd3MgZm9yIHVzZXJzcGFjZSB0byBncmFjZWZ1bGx5IHF1aWVz
Y2UgYmVmb3JlIGJlaW5nIHNob3QgZG93bi4KQnkgc3RvcHBpbmcgc3VibWlzc2lvbiBhbmQgdGhl
biB3YWl0aW5nIGZvciB0aGUgY3VycmVudCByZXF1ZXN0cyB0bwpjb21wbGV0ZSwgd2UgYXJlIGxl
c3MgbGlrZWx5IHRvIGRpc3J1cHQgaW5ub2NlbnQgY29udGV4dHMgYnkgcGVyZm9ybWluZwp0aGUg
cmVzZXQgd2hpbGUgdGhleSBhcmUgYWN0aXZlLiBUaGUgbG9uZ2VyIHdlIHdhaXQsIHRoZSBtb3Jl
IGxpa2VseSB3ZQphcmUgdG8gc3BhcmUgaW5ub2NlbnRzLCBidXQgYWxzbyB0aGUgbW9yZSBkaXNy
dXB0aXZlIHRvIGludGVyYWN0aXZlLCBvcgpvdGhlciBsb3cgbGF0ZW5jeSB0YXNrLCB0aGUgcmVz
ZXQgaXRzZWxmIHdpbGwgYmUuCgpUaGUgdGltZW91dCBjYW4gYmUgYWRqdXN0ZWQgdXNpbmcKCgkv
c3lzL2NsYXNzL2RybS9jYXJkPy9lbmdpbmUvKi9zdG9wX3RpbWVvdXRfbXMKClNpZ25lZC1vZmYt
Ynk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgpDYzogSm9vbmFzIExh
aHRpbmVuIDxqb29uYXMubGFodGluZW5AbGludXguaW50ZWwuY29tPgpDYzogSm9uIEJsb29tZmll
bGQgPGpvbi5ibG9vbWZpZWxkQGludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9L
Y29uZmlnLnByb2ZpbGUgICAgICAgICB8IDE0ICsrKysrKysrKwogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMgICAgfCAxOSArKysrKysrKysrKy0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9zeXNmcy5jIHwgMzEgKysrKysrKysrKysrKysrKysr
KysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oIHwgIDEgKwog
NCBmaWxlcyBjaGFuZ2VkLCA2NCBpbnNlcnRpb25zKCspLCAxIGRlbGV0aW9uKC0pCgpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvS2NvbmZpZy5wcm9maWxlIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvS2NvbmZpZy5wcm9maWxlCmluZGV4IGI4ZGY4MGJjMGI0Ny4uMjc0YmRkMjA4ZTBk
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9LY29uZmlnLnByb2ZpbGUKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvS2NvbmZpZy5wcm9maWxlCkBAIC0yNiw2ICsyNiwyMCBAQCBj
b25maWcgRFJNX0k5MTVfU1BJTl9SRVFVRVNUCiAJICB0aGUgY29zdCBvZiBlbmFibGluZyB0aGUg
aW50ZXJydXB0IChpZiBjdXJyZW50bHkgZGlzYWJsZWQpIHRvIGJlCiAJICBhIGZldyBtaWNyb3Nl
Y29uZHMuCiAKK2NvbmZpZyBEUk1fSTkxNV9TVE9QX1RJTUVPVVQKKwlpbnQgIkhvdyBsb25nIHRv
IHdhaXQgZm9yIGFuIGVuZ2luZSB0byBxdWllc2NlIGdyYWNlZnVsbHkgYmVmb3JlIHJlc2V0ICht
cykiCisJZGVmYXVsdCAxMDAgIyBtaWxsaXNlY29uZHMKKwloZWxwCisJICBCeSBzdG9wcGluZyBz
dWJtaXNzaW9uIGFuZCBzbGVlcGluZyBmb3IgYSBzaG9ydCB0aW1lIGJlZm9yZSByZXNldHRpbmcK
KwkgIHRoZSBHUFUsIHdlIGFsbG93IHRoZSBpbm5vY2VudCBjb250ZXh0cyBhbHNvIG9uIHRoZSBz
eXN0ZW0gdG8gcXVpZXNjZS4KKwkgIEl0IGlzIHRoZW4gbGVzcyBsaWtlbHkgZm9yIGEgaGFuZ2lu
ZyBjb250ZXh0IHRvIGNhdXNlIGNvbGxhdGVyYWwKKwkgIGRhbWFnZSBhcyB0aGUgc3lzdGVtIGlz
IHJlc2V0IGluIG9yZGVyIHRvIHJlY292ZXIuIFRoZSBjb2xvcmFyeSBpcworCSAgdGhhdCB0aGUg
cmVzZXQgaXRzZWxmIG1heSB0YWtlIGxvbmdlciBhbmQgc28gYmUgbW9yZSBkaXNydXB0aXZlIHRv
CisJICBpbnRlcmFjdGl2ZSBvciBsb3cgbGF0ZW5jeSB3b3JrbG9hZHMuCisKKwkgIFRoaXMgaXMg
YWRqdXN0YWJsZSB2aWEKKwkgIC9zeXMvY2xhc3MvZHJtL2NhcmQ/L2VuZ2luZS8qL3N0b3BfdGlt
ZW91dF9tcworCiBjb25maWcgRFJNX0k5MTVfVElNRVNMSUNFX0RVUkFUSU9OCiAJaW50ICJTY2hl
ZHVsaW5nIHF1YW50dW0gZm9yIHVzZXJzcGFjZSBiYXRjaGVzIChtcywgamlmZnkgZ3JhbnVsYXJp
dHkpIgogCWRlZmF1bHQgMSAjIG1pbGxpc2Vjb25kcwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9lbmdpbmVfY3MuYwppbmRleCA5OGRiYWFhYWYzZGIuLjVmOGRhZDA0OTE1ZiAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKQEAgLTMwOCw2ICszMDgsOCBA
QCBzdGF0aWMgaW50IGludGVsX2VuZ2luZV9zZXR1cChzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBlbnVt
IGludGVsX2VuZ2luZV9pZCBpZCkKIAllbmdpbmUtPmluc3RhbmNlID0gaW5mby0+aW5zdGFuY2U7
CiAJX19zcHJpbnRfZW5naW5lX25hbWUoZW5naW5lKTsKIAorCWVuZ2luZS0+cHJvcHMuc3RvcF90
aW1lb3V0X21zID0KKwkJQ09ORklHX0RSTV9JOTE1X1NUT1BfVElNRU9VVDsKIAllbmdpbmUtPnBy
b3BzLnRpbWVzbGljZV9kdXJhdGlvbl9tcyA9CiAJCUNPTkZJR19EUk1fSTkxNV9USU1FU0xJQ0Vf
RFVSQVRJT047CiAKQEAgLTg3OCw2ICs4ODAsMjEgQEAgdTY0IGludGVsX2VuZ2luZV9nZXRfbGFz
dF9iYXRjaF9oZWFkKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAlyZXR1
cm4gYmJhZGRyOwogfQogCitzdGF0aWMgdW5zaWduZWQgbG9uZyBzdG9wX3RpbWVvdXQoY29uc3Qg
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCWlmIChpbl9hdG9taWMoKSB8fCBp
cnFzX2Rpc2FibGVkKCkpIC8qIGluc2lkZSBhdG9taWMgcHJlZW1wdC1yZXNldD8gKi8KKwkJcmV0
dXJuIDA7IC8qIEdvaW5nIHRvbyBmYXN0LCBjYW4ndCBzdG9wIG5vdyEgKi8KKworCS8qCisJICog
SWYgd2UgYXJlIGRvaW5nIGEgbm9ybWFsIEdQVSByZXNldCwgd2UgY2FuIHRha2Ugb3VyIHRpbWUg
YW5kIGFsbG93CisJICogdGhlIGVuZ2luZSB0byBxdWllc2NlLiBXZSd2ZSBzdG9wcGVkIHN1Ym1p
c3Npb24gdG8gdGhlIGVuZ2luZSwgYW5kCisJICogaWYgd2Ugd2FpdCBsb25nIGVub3VnaCBhbiBp
bm5vY2VudCBjb250ZXh0IHNob3VsZCBjb21wbGV0ZSBhbmQKKwkgKiBsZWF2ZSB0aGUgZW5naW5l
IGlkbGUuIFNvIHRoZXkgc2hvdWxkIG5vdCBiZSBjYXVnaHQgdW5hd2FyZSBieQorCSAqIHRoZSBm
b3J0aGNvbWluZyBHUFUgcmVzZXQgKHdoaWNoIHVzdWFsbHkgZm9sbG93cyB0aGUgc3RvcF9jcykh
CisJICovCisJcmV0dXJuIFJFQURfT05DRShlbmdpbmUtPnByb3BzLnN0b3BfdGltZW91dF9tcyk7
Cit9CisKIGludCBpbnRlbF9lbmdpbmVfc3RvcF9jcyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUpCiB7CiAJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gZW5naW5lLT51bmNvcmU7
CkBAIC04OTUsNyArOTEyLDcgQEAgaW50IGludGVsX2VuZ2luZV9zdG9wX2NzKHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSkKIAllcnIgPSAwOwogCWlmIChfX2ludGVsX3dhaXRfZm9yX3Jl
Z2lzdGVyX2Z3KHVuY29yZSwKIAkJCQkJIG1vZGUsIE1PREVfSURMRSwgTU9ERV9JRExFLAotCQkJ
CQkgMTAwMCwgMCwKKwkJCQkJIDEwMDAsIHN0b3BfdGltZW91dChlbmdpbmUpLAogCQkJCQkgTlVM
TCkpIHsKIAkJR0VNX1RSQUNFKCIlczogdGltZWQgb3V0IG9uIFNUT1BfUklORyAtPiBJRExFXG4i
LCBlbmdpbmUtPm5hbWUpOwogCQllcnIgPSAtRVRJTUVET1VUOwpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3N5c2ZzLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9lbmdpbmVfc3lzZnMuYwppbmRleCA1NWFlODE3NjlhOGUuLjczYTc1NWY0
NGNjZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3N5
c2ZzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3N5c2ZzLmMK
QEAgLTE4NCw2ICsxODQsMzYgQEAgdGltZXNsaWNlX3N0b3JlKHN0cnVjdCBrb2JqZWN0ICprb2Jq
LCBzdHJ1Y3Qga29ial9hdHRyaWJ1dGUgKmF0dHIsCiBzdGF0aWMgc3RydWN0IGtvYmpfYXR0cmli
dXRlIHRpbWVzbGljZV9kdXJhdGlvbl9hdHRyID0KIF9fQVRUUih0aW1lc2xpY2VfZHVyYXRpb25f
bXMsIDA2NDQsIHRpbWVzbGljZV9zaG93LCB0aW1lc2xpY2Vfc3RvcmUpOwogCitzdGF0aWMgc3Np
emVfdAorc3RvcF9zaG93KHN0cnVjdCBrb2JqZWN0ICprb2JqLCBzdHJ1Y3Qga29ial9hdHRyaWJ1
dGUgKmF0dHIsIGNoYXIgKmJ1ZikKK3sKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUg
PSBrb2JqX3RvX2VuZ2luZShrb2JqKTsKKworCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiVsdVxuIiwg
ZW5naW5lLT5wcm9wcy5zdG9wX3RpbWVvdXRfbXMpOworfQorCitzdGF0aWMgc3NpemVfdAorc3Rv
cF9zdG9yZShzdHJ1Y3Qga29iamVjdCAqa29iaiwgc3RydWN0IGtvYmpfYXR0cmlidXRlICphdHRy
LAorCSAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGNvdW50KQoreworCXN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSA9IGtvYmpfdG9fZW5naW5lKGtvYmopOworCXVuc2lnbmVkIGxvbmcg
bG9uZyBkdXJhdGlvbjsKKwlpbnQgZXJyOworCisJZXJyID0ga3N0cnRvdWxsKGJ1ZiwgMCwgJmR1
cmF0aW9uKTsKKwlpZiAoZXJyKQorCQlyZXR1cm4gZXJyOworCisJaWYgKGR1cmF0aW9uID4gamlm
Zmllc190b19tc2VjcyhNQVhfU0NIRURVTEVfVElNRU9VVCkpCisJCXJldHVybiAtRUlOVkFMOwor
CisJV1JJVEVfT05DRShlbmdpbmUtPnByb3BzLnN0b3BfdGltZW91dF9tcywgZHVyYXRpb24pOwor
CXJldHVybiBjb3VudDsKK30KKworc3RhdGljIHN0cnVjdCBrb2JqX2F0dHJpYnV0ZSBzdG9wX3Rp
bWVvdXRfYXR0ciA9CitfX0FUVFIoc3RvcF90aW1lb3V0X21zLCAwNjQ0LCBzdG9wX3Nob3csIHN0
b3Bfc3RvcmUpOworCiBzdGF0aWMgdm9pZCBrb2JqX2VuZ2luZV9yZWxlYXNlKHN0cnVjdCBrb2Jq
ZWN0ICprb2JqKQogewogCWtmcmVlKGtvYmopOwpAQCAtMjI0LDYgKzI1NCw3IEBAIHZvaWQgaW50
ZWxfZW5naW5lc19hZGRfc3lzZnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJCSZt
bWlvX2F0dHIuYXR0ciwKIAkJJmNhcHNfYXR0ci5hdHRyLAogCQkmYWxsX2NhcHNfYXR0ci5hdHRy
LAorCQkmc3RvcF90aW1lb3V0X2F0dHIuYXR0ciwKIAkJTlVMTAogCX07CiAKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmgKaW5kZXggODlhOTYxNmU4NTM5Li43
NmVmOGE2M2Y5MjEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2Vu
Z2luZV90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90
eXBlcy5oCkBAIC01NDQsNiArNTQ0LDcgQEAgc3RydWN0IGludGVsX2VuZ2luZV9jcyB7CiAJfSBz
dGF0czsKIAogCXN0cnVjdCB7CisJCXVuc2lnbmVkIGxvbmcgc3RvcF90aW1lb3V0X21zOwogCQl1
bnNpZ25lZCBsb25nIHRpbWVzbGljZV9kdXJhdGlvbl9tczsKIAl9IHByb3BzOwogfTsKLS0gCjIu
MjQuMC5yYzAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
CkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpo
dHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

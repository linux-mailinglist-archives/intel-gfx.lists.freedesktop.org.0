Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id A1F824D448
	for <lists+intel-gfx@lfdr.de>; Thu, 20 Jun 2019 18:53:09 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E90F46E5D2;
	Thu, 20 Jun 2019 16:53:07 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga12.intel.com (mga12.intel.com [192.55.52.136])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6E39B6E5D2
 for <intel-gfx@lists.freedesktop.org>; Thu, 20 Jun 2019 16:53:06 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga005.fm.intel.com ([10.253.24.32])
 by fmsmga106.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 20 Jun 2019 09:53:06 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,397,1557212400"; d="scan'208";a="358597407"
Received: from yyosef-mobl.ger.corp.intel.com (HELO [10.252.23.42])
 ([10.252.23.42])
 by fmsmga005.fm.intel.com with ESMTP; 20 Jun 2019 09:53:05 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20190620102432.31580-1-chris@chris-wilson.co.uk>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <5b87d958-e7f7-deb0-49dc-87f97f758680@linux.intel.com>
Date: Thu, 20 Jun 2019 17:53:04 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.7.0
MIME-Version: 1.0
In-Reply-To: <20190620102432.31580-1-chris@chris-wilson.co.uk>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH] drm/i915/selftests: Use request managed
 wakerefs
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDIwLzA2LzIwMTkgMTE6MjQsIENocmlzIFdpbHNvbiB3cm90ZToKPiBTaW5jZSBjb21taXQg
NzlmZmFjODU5OWM0ICgiZHJtL2k5MTU6IEludmVydCB0aGUgR0VNIHdha2VyZWYKPiBoaWVyYXJj
aHkiKSwgdGhlIHJlcXVlc3QgY3JlYXRpb24gaXRzZWxmIHRvb2sgcmVzcG9uc2liaWxpdHkgZm9y
Cj4gbWFuYWdpbmcgdGhlIGVuZ2luZS9HVCB3YWtlcmVmcyBhbmQgc28gd2UgY2FuIHJlbW92ZSB0
aGUgcmVkdW5kYW50IGdyYWJzCj4gaW4gb3VyIHNlbGZ0ZXN0cy4KPiAKPiBSZWZlcmVuY2VzOiA3
OWZmYWM4NTk5YzQgKCJkcm0vaTkxNTogSW52ZXJ0IHRoZSBHRU0gd2FrZXJlZiBoaWVyYXJjaHki
KQo+IFNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVr
Pgo+IC0tLQo+ICAgLi4uL2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fY29udGV4dC5j
IHwgMzUgKysrKy0tLS0tLS0tLS0tLS0tLQo+ICAgMSBmaWxlIGNoYW5nZWQsIDcgaW5zZXJ0aW9u
cygrKSwgMjggZGVsZXRpb25zKC0pCj4gCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fY29udGV4dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMKPiBpbmRleCBlYWEyYjE2NTc0Yzcu
LmYyZDRlNzczNDA0YSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2Vs
ZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9zZWxmdGVzdHMvaTkxNV9nZW1fY29udGV4dC5jCj4gQEAgLTMxLDcgKzMxLDYgQEAgc3RhdGlj
IGludCBsaXZlX25vcF9zd2l0Y2godm9pZCAqYXJnKQo+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZTsKPiAgIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqKmN0eDsKPiAgIAllbnVt
IGludGVsX2VuZ2luZV9pZCBpZDsKPiAtCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICAgCXN0
cnVjdCBpZ3RfbGl2ZV90ZXN0IHQ7Cj4gICAJc3RydWN0IGRybV9maWxlICpmaWxlOwo+ICAgCXVu
c2lnbmVkIGxvbmcgbjsKPiBAQCAtNTMsNyArNTIsNiBAQCBzdGF0aWMgaW50IGxpdmVfbm9wX3N3
aXRjaCh2b2lkICphcmcpCj4gICAJCXJldHVybiBQVFJfRVJSKGZpbGUpOwo+ICAgCj4gICAJbXV0
ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gLQl3YWtlcmVmID0gaW50ZWxfcnVu
dGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwo+ICAgCj4gICAJY3R4ID0ga2NhbGxvYyhu
Y3R4LCBzaXplb2YoKmN0eCksIEdGUF9LRVJORUwpOwo+ICAgCWlmICghY3R4KSB7Cj4gQEAgLTE1
Miw3ICsxNTAsNiBAQCBzdGF0aWMgaW50IGxpdmVfbm9wX3N3aXRjaCh2b2lkICphcmcpCj4gICAJ
fQo+ICAgCj4gICBvdXRfdW5sb2NrOgo+IC0JaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1
bnRpbWVfcG0sIHdha2VyZWYpOwo+ICAgCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9t
dXRleCk7Cj4gICAJbW9ja19maWxlX2ZyZWUoaTkxNSwgZmlsZSk7Cj4gICAJcmV0dXJuIGVycjsK
PiBAQCAtNTA3LDcgKzUwNCw2IEBAIHN0YXRpYyBpbnQgaWd0X2N0eF9leGVjKHZvaWQgKmFyZykK
PiAgIAkJZHcgPSAwOwo+ICAgCQl3aGlsZSAoIXRpbWVfYWZ0ZXIoamlmZmllcywgZW5kX3RpbWUp
KSB7Cj4gICAJCQlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4Owo+IC0JCQlpbnRlbF93YWtl
cmVmX3Qgd2FrZXJlZjsKPiAgIAo+ICAgCQkJY3R4ID0gbGl2ZV9jb250ZXh0KGk5MTUsIGZpbGUp
Owo+ICAgCQkJaWYgKElTX0VSUihjdHgpKSB7Cj4gQEAgLTUyMyw4ICs1MTksNyBAQCBzdGF0aWMg
aW50IGlndF9jdHhfZXhlYyh2b2lkICphcmcpCj4gICAJCQkJfQo+ICAgCQkJfQo+ICAgCj4gLQkJ
CXdpdGhfaW50ZWxfcnVudGltZV9wbSgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZikKPiAtCQkJ
CWVyciA9IGdwdV9maWxsKG9iaiwgY3R4LCBlbmdpbmUsIGR3KTsKPiArCQkJZXJyID0gZ3B1X2Zp
bGwob2JqLCBjdHgsIGVuZ2luZSwgZHcpOwo+ICAgCQkJaWYgKGVycikgewo+ICAgCQkJCXByX2Vy
cigiRmFpbGVkIHRvIGZpbGwgZHdvcmQgJWx1IFslbHUvJWx1XSB3aXRoIGdwdSAoJXMpIGluIGN0
eCAldSBbZnVsbC1wcGd0dD8gJXNdLCBlcnI9JWRcbiIsCj4gICAJCQkJICAgICAgIG5kd29yZHMs
IGR3LCBtYXhfZHdvcmRzKG9iaiksCj4gQEAgLTYyMyw3ICs2MTgsNiBAQCBzdGF0aWMgaW50IGln
dF9zaGFyZWRfY3R4X2V4ZWModm9pZCAqYXJnKQo+ICAgCQluY29udGV4dHMgPSAwOwo+ICAgCQl3
aGlsZSAoIXRpbWVfYWZ0ZXIoamlmZmllcywgZW5kX3RpbWUpKSB7Cj4gICAJCQlzdHJ1Y3QgaTkx
NV9nZW1fY29udGV4dCAqY3R4Owo+IC0JCQlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiAgIAo+
ICAgCQkJY3R4ID0ga2VybmVsX2NvbnRleHQoaTkxNSk7Cj4gICAJCQlpZiAoSVNfRVJSKGN0eCkp
IHsKPiBAQCAtNjQyLDkgKzYzNiw3IEBAIHN0YXRpYyBpbnQgaWd0X3NoYXJlZF9jdHhfZXhlYyh2
b2lkICphcmcpCj4gICAJCQkJfQo+ICAgCQkJfQo+ICAgCj4gLQkJCWVyciA9IDA7Cj4gLQkJCXdp
dGhfaW50ZWxfcnVudGltZV9wbSgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZikKPiAtCQkJCWVy
ciA9IGdwdV9maWxsKG9iaiwgY3R4LCBlbmdpbmUsIGR3KTsKPiArCQkJZXJyID0gZ3B1X2ZpbGwo
b2JqLCBjdHgsIGVuZ2luZSwgZHcpOwo+ICAgCQkJaWYgKGVycikgewo+ICAgCQkJCXByX2Vycigi
RmFpbGVkIHRvIGZpbGwgZHdvcmQgJWx1IFslbHUvJWx1XSB3aXRoIGdwdSAoJXMpIGluIGN0eCAl
dSBbZnVsbC1wcGd0dD8gJXNdLCBlcnI9JWRcbiIsCj4gICAJCQkJICAgICAgIG5kd29yZHMsIGR3
LCBtYXhfZHdvcmRzKG9iaiksCj4gQEAgLTEwMzAsNyArMTAyMiw2IEBAIF9faWd0X2N0eF9zc2V1
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCXN0cnVjdCBpOTE1X2dlbV9jb250
ZXh0ICpjdHg7Cj4gICAJc3RydWN0IGludGVsX2NvbnRleHQgKmNlOwo+ICAgCXN0cnVjdCBpbnRl
bF9zc2V1IHBnX3NzZXU7Cj4gLQlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiAgIAlzdHJ1Y3Qg
ZHJtX2ZpbGUgKmZpbGU7Cj4gICAJaW50IHJldDsKPiAgIAo+IEBAIC0xMDc4LDEyICsxMDY5LDEw
IEBAIF9faWd0X2N0eF9zc2V1KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCQln
b3RvIG91dF91bmxvY2s7Cj4gICAJfQo+ICAgCj4gLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9w
bV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwo+IC0KPiAgIAljZSA9IGk5MTVfZ2VtX2NvbnRleHRf
Z2V0X2VuZ2luZShjdHgsIFJDUzApOwo+ICAgCWlmIChJU19FUlIoY2UpKSB7Cj4gICAJCXJldCA9
IFBUUl9FUlIoY2UpOwo+IC0JCWdvdG8gb3V0X3JwbTsKPiArCQlnb3RvIG91dF9wdXQ7Cj4gICAJ
fQo+ICAgCj4gICAJcmV0ID0gaW50ZWxfY29udGV4dF9waW4oY2UpOwo+IEBAIC0xMTE3LDggKzEx
MDYsNyBAQCBfX2lndF9jdHhfc3NldShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAg
IAlpbnRlbF9jb250ZXh0X3VucGluKGNlKTsKPiAgIG91dF9jb250ZXh0Ogo+ICAgCWludGVsX2Nv
bnRleHRfcHV0KGNlKTsKPiAtb3V0X3JwbToKPiAtCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1
LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKPiArb3V0X3B1dDoKPiAgIAlpOTE1X2dlbV9vYmplY3Rf
cHV0KG9iaik7Cj4gICAKPiAgIG91dF91bmxvY2s6Cj4gQEAgLTEyMDcsOCArMTE5NSw2IEBAIHN0
YXRpYyBpbnQgaWd0X2N0eF9yZWFkb25seSh2b2lkICphcmcpCj4gICAJCXVuc2lnbmVkIGludCBp
ZDsKPiAgIAo+ICAgCQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgewo+IC0JCQlp
bnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiAtCj4gICAJCQlpZiAoIWludGVsX2VuZ2luZV9jYW5f
c3RvcmVfZHdvcmQoZW5naW5lKSkKPiAgIAkJCQljb250aW51ZTsKPiAgIAo+IEBAIC0xMjIzLDkg
KzEyMDksNyBAQCBzdGF0aWMgaW50IGlndF9jdHhfcmVhZG9ubHkodm9pZCAqYXJnKQo+ICAgCQkJ
CQlpOTE1X2dlbV9vYmplY3Rfc2V0X3JlYWRvbmx5KG9iaik7Cj4gICAJCQl9Cj4gICAKPiAtCQkJ
ZXJyID0gMDsKPiAtCQkJd2l0aF9pbnRlbF9ydW50aW1lX3BtKCZpOTE1LT5ydW50aW1lX3BtLCB3
YWtlcmVmKQo+IC0JCQkJZXJyID0gZ3B1X2ZpbGwob2JqLCBjdHgsIGVuZ2luZSwgZHcpOwo+ICsJ
CQllcnIgPSBncHVfZmlsbChvYmosIGN0eCwgZW5naW5lLCBkdyk7Cj4gICAJCQlpZiAoZXJyKSB7
Cj4gICAJCQkJcHJfZXJyKCJGYWlsZWQgdG8gZmlsbCBkd29yZCAlbHUgWyVsdS8lbHVdIHdpdGgg
Z3B1ICglcykgaW4gY3R4ICV1IFtmdWxsLXBwZ3R0PyAlc10sIGVycj0lZFxuIiwKPiAgIAkJCQkg
ICAgICAgbmR3b3JkcywgZHcsIG1heF9kd29yZHMob2JqKSwKPiBAQCAtMTQ4OCw3ICsxNDcyLDYg
QEAgc3RhdGljIGludCBpZ3Rfdm1faXNvbGF0aW9uKHZvaWQgKmFyZykKPiAgIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGFyZzsKPiAgIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAq
Y3R4X2EsICpjdHhfYjsKPiAgIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4gLQlp
bnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiAgIAlzdHJ1Y3QgaWd0X2xpdmVfdGVzdCB0Owo+ICAg
CXN0cnVjdCBkcm1fZmlsZSAqZmlsZTsKPiAgIAlJOTE1X1JORF9TVEFURShwcm5nKTsKPiBAQCAt
MTUzNSw4ICsxNTE4LDYgQEAgc3RhdGljIGludCBpZ3Rfdm1faXNvbGF0aW9uKHZvaWQgKmFyZykK
PiAgIAlHRU1fQlVHX09OKGN0eF9iLT52bS0+dG90YWwgIT0gdm1fdG90YWwpOwo+ICAgCXZtX3Rv
dGFsIC09IEk5MTVfR1RUX1BBR0VfU0laRTsKPiAgIAo+IC0Jd2FrZXJlZiA9IGludGVsX3J1bnRp
bWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKPiAtCj4gICAJY291bnQgPSAwOwo+ICAgCWZv
cl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKSB7Cj4gICAJCUlHVF9USU1FT1VUKGVuZF90
aW1lKTsKPiBAQCAtMTU2MCw3ICsxNTQxLDcgQEAgc3RhdGljIGludCBpZ3Rfdm1faXNvbGF0aW9u
KHZvaWQgKmFyZykKPiAgIAkJCQllcnIgPSByZWFkX2Zyb21fc2NyYXRjaChjdHhfYiwgZW5naW5l
LAo+ICAgCQkJCQkJCW9mZnNldCwgJnZhbHVlKTsKPiAgIAkJCWlmIChlcnIpCj4gLQkJCQlnb3Rv
IG91dF9ycG07Cj4gKwkJCQlnb3RvIG91dF91bmxvY2s7Cj4gICAKPiAgIAkJCWlmICh2YWx1ZSkg
ewo+ICAgCQkJCXByX2VycigiJXM6IFJlYWQgJTA4eCBmcm9tIHNjcmF0Y2ggKG9mZnNldCAweCUw
OHhfJTA4eCksIGFmdGVyICVsdSByZWFkcyFcbiIsCj4gQEAgLTE1NjksNyArMTU1MCw3IEBAIHN0
YXRpYyBpbnQgaWd0X3ZtX2lzb2xhdGlvbih2b2lkICphcmcpCj4gICAJCQkJICAgICAgIGxvd2Vy
XzMyX2JpdHMob2Zmc2V0KSwKPiAgIAkJCQkgICAgICAgdGhpcyk7Cj4gICAJCQkJZXJyID0gLUVJ
TlZBTDsKPiAtCQkJCWdvdG8gb3V0X3JwbTsKPiArCQkJCWdvdG8gb3V0X3VubG9jazsKPiAgIAkJ
CX0KPiAgIAo+ICAgCQkJdGhpcysrOwo+IEBAIC0xNTc5LDggKzE1NjAsNiBAQCBzdGF0aWMgaW50
IGlndF92bV9pc29sYXRpb24odm9pZCAqYXJnKQo+ICAgCXByX2luZm8oIkNoZWNrZWQgJWx1IHNj
cmF0Y2ggb2Zmc2V0cyBhY3Jvc3MgJWQgZW5naW5lc1xuIiwKPiAgIAkJY291bnQsIFJVTlRJTUVf
SU5GTyhpOTE1KS0+bnVtX2VuZ2luZXMpOwo+ICAgCj4gLW91dF9ycG06Cj4gLQlpbnRlbF9ydW50
aW1lX3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7Cj4gICBvdXRfdW5sb2NrOgo+
ICAgCWlmIChpZ3RfbGl2ZV90ZXN0X2VuZCgmdCkpCj4gICAJCWVyciA9IC1FSU87Cj4gCgpSZXZp
ZXdlZC1ieTogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KClJlZ2Fy
ZHMsCgpUdnJ0a28KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
Cmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

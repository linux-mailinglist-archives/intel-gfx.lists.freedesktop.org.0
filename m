Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8C3031D9AA4
	for <lists+intel-gfx@lfdr.de>; Tue, 19 May 2020 17:04:46 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id EF6836E252;
	Tue, 19 May 2020 15:04:44 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga12.intel.com (mga12.intel.com [192.55.52.136])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B3F246E22B
 for <intel-gfx@lists.freedesktop.org>; Tue, 19 May 2020 15:04:43 +0000 (UTC)
IronPort-SDR: 0wAh4LPJXgXNLMu1aGoyivGarJzcDPJVvqW/kCYwgmMXGeuJJKMIq/oJYc3rYxlUIN3Wu+TV5v
 hHry1kO7TZSQ==
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga006.jf.intel.com ([10.7.209.51])
 by fmsmga106.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 19 May 2020 08:04:43 -0700
IronPort-SDR: s+2G4sCqQn73CKrCNS6YDSDg/mGqhvQxt+ldaP68UCsacZnqTEzy0ouHcgVVAwW++peXsrNKWw
 dVc9ZIe5xrxQ==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.73,410,1583222400"; d="scan'208";a="267912176"
Received: from benedikt-mobl.ger.corp.intel.com (HELO [10.252.57.184])
 ([10.252.57.184])
 by orsmga006.jf.intel.com with ESMTP; 19 May 2020 08:04:40 -0700
To: Animesh Manna <animesh.manna@intel.com>, intel-gfx@lists.freedesktop.org
References: <20200518121256.14354-1-animesh.manna@intel.com>
From: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
Message-ID: <a8d3d95a-036a-e9dd-c4eb-cba2615860e5@linux.intel.com>
Date: Tue, 19 May 2020 17:04:39 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.8.0
MIME-Version: 1.0
In-Reply-To: <20200518121256.14354-1-animesh.manna@intel.com>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH v10] drm/i915/dsb: Pre allocate and late
 cleanup of cmd buffer
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Jani Nikula <jani.nikula@intel.com>, Daniel Vetter <daniel.vetter@ffwll.ch>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T3AgMTgtMDUtMjAyMCBvbSAxNDoxMiBzY2hyZWVmIEFuaW1lc2ggTWFubmE6Cj4gUHJlLWFsbG9j
YXRlIGNvbW1hbmQgYnVmZmVyIGluIGF0b21pY19jb21taXQgdXNpbmcgaW50ZWxfZHNiX3ByZXBh
cmUKPiBmdW5jdGlvbiB3aGljaCBhbHNvIGluY2x1ZGVzIHBpbm5pbmcgYW5kIG1hcCBpbiBjcHUg
ZG9tYWluLgo+Cj4gTm8gZnVuY3Rpb25hbCBjaGFuZ2UgaXMgZHNiIHdyaXRlL2NvbW1pdCBmdW5j
dGlvbnMuCj4KPiBOb3cgZHNiIGdldC9wdXQgZnVuY3Rpb24gaXMgcmVtb3ZlZCBhbmQgcmVmLWNv
dW50IG1lY2hhbmlzbSBpcwo+IG5vdCBuZWVkZWQuIEJlbG93IGRzYiBhcGkgYWRkZWQgdG8gZG8g
cmVzcGVjdGl2ZSBqb2IgbWVudGlvbmVkCj4gYmVsb3cuCj4KPiBpbnRlbF9kc2JfcHJlcGFyZSAt
IEFsbG9jYXRlLCBwaW4gYW5kIG1hcCB0aGUgYnVmZmVyLgo+IGludGVsX2RzYl9jbGVhbnVwIC0g
VW5waW4gYW5kIHJlbGVhc2UgdGhlIGdlbSBvYmplY3QuCj4KPiBSRkM6IEluaXRpYWwgcGF0Y2gg
Zm9yIGRlc2lnbiByZXZpZXcuCj4gdjI6IGluY2x1ZGVkIF9pbml0KCkgcGFydCBpbiBfcHJlcGFy
ZSgpLiBbRGFuaWVsLCBWaWxsZV0KPiB2MzogZHNiX2NsZWFudXAgY2FsbGVkIGFmdGVyIGNsZWFu
dXBfcGxhbmVzLiBbRGFuaWVsXQo+IHY0OiBkc2Igc3RydWN0dXJlIGlzIG1vdmVkIHRvIGludGVs
X2NydGNfc3RhdGUgZnJvbSBpbnRlbF9jcnRjLiBbTWFhcnRlbl0KPiB2NTogZHNiIGdldC9wdXQv
cmVmLWNvdW50IG1lY2hhbmlzbSByZW1vdmVkLiBbTWFhcnRlbl0KPiB2NjogQmFzZWQgb24gcmV2
aWV3IGZlZWRiYWNrIGZvbGxvd2luZyBjaGFuZ2VzIGFyZSBhZGRlZCwKPiAtIHJlcGxhY2VkIGlu
dGVsX2RzYiBzdHJ1Y3R1cmUgYnkgcG9pbnRlciBpbiBpbnRlbF9jcnRjX3N0YXRlLiBbTWFhcnRl
bl0KPiAtIHBhc3NpbmcgaW50ZWxfY3J0Y19zdGF0ZSB0byBkc3AtYXBpIHRvIHNpbXBsaWZ5IHRo
ZSBjb2RlLiBbTWFhcnRlbl0KPiAtIGZldyBkc2IgZnVuY3Rpb25zIHByb3RvdHlwZSBtb2RpZmll
ZCB0byBzaW1wbGlmeSBjb2RlLgo+IHY3OiBhZGRlZCBmZXcgY29zbWV0aWMgY2hhbmdlcyBzdWdn
ZXN0ZWQgYnkgSmFuaSBhbmQgbnVsbCBjaGVjayBmb3IKPiBjcnRjX3N0YXRlIGluIGRzYl9jbGVh
bnVwIHJlbW92ZWQgYXMgc3VnZ2VzdGVkIGJ5IE1hYXJ0ZW4uCj4gdjg6IGNoYW5nZWQgdGhlIGZ1
bmN0aW9uIHBhcmFtZXRlciB0byBpbnRlbF9jcnRjX3N0YXRlKiBvZgo+IGl2Yl9sb2FkX2x1dF9l
eHRfbWF4KCkgZnJvbSBpbnRlbF9jcnRjLiBbTWFhcnRlbl0KPiB2OTogZXJyb3IgaGFuZGxpbmcg
aW1wcm92ZWQgaW4gX3dyaXRlKCkgYW5kIHByZXBhcmUoKS4gW01hYXJ0ZW5dCj4KPiBDYzogTWFh
cnRlbiBMYW5raG9yc3QgPG1hYXJ0ZW4ubGFua2hvcnN0QGxpbnV4LmludGVsLmNvbT4KPiBDYzog
VmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KPiBDYzogSmFu
aSBOaWt1bGEgPGphbmkubmlrdWxhQGludGVsLmNvbT4KPiBDYzogRGFuaWVsIFZldHRlciA8ZGFu
aWVsLnZldHRlckBmZndsbC5jaD4KPiBBY2tlZC1ieTogRGFuaWVsIFZldHRlciA8ZGFuaWVsLnZl
dHRlckBmZndsbC5jaD4KPiBTaWduZWQtb2ZmLWJ5OiBBbmltZXNoIE1hbm5hIDxhbmltZXNoLm1h
bm5hQGludGVsLmNvbT4KPiAtLS0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9hdG9taWMuYyAgIHwgICAzICsKPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9jb2xvci5jICAgIHwgIDY2ICsrLS0tCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfZGlzcGxheS5jICB8ICA1OCArKystCj4gIC4uLi9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2Rpc3BsYXlfdHlwZXMuaCAgICB8ICAgNiArLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2RzYi5jICAgICAgfCAyNTAgKysrKysrKystLS0tLS0tLS0tCj4gIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHNiLmggICAgICB8ICAxNyArLQo+ICA2IGZpbGVz
IGNoYW5nZWQsIDIwNiBpbnNlcnRpb25zKCspLCAxOTQgZGVsZXRpb25zKC0pCj4KPiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9taWMuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWljLmMKPiBpbmRleCBkMDQzMDU3ZDJm
YTAuLjNjYjg2NmYyMmU3NCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2F0b21pYy5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9hdG9taWMuYwo+IEBAIC0yNTIsNiArMjUyLDcgQEAgaW50ZWxfY3J0Y19kdXBsaWNhdGVf
c3RhdGUoc3RydWN0IGRybV9jcnRjICpjcnRjKQo+ICAJY3J0Y19zdGF0ZS0+d20ubmVlZF9wb3N0
dmJsX3VwZGF0ZSA9IGZhbHNlOwo+ICAJY3J0Y19zdGF0ZS0+ZmJfYml0cyA9IDA7Cj4gIAljcnRj
X3N0YXRlLT51cGRhdGVfcGxhbmVzID0gMDsKPiArCWNydGNfc3RhdGUtPmRzYiA9IE5VTEw7Cj4g
IAo+ICAJcmV0dXJuICZjcnRjX3N0YXRlLT51YXBpOwo+ICB9Cj4gQEAgLTI5Miw2ICsyOTMsOCBA
QCBpbnRlbF9jcnRjX2Rlc3Ryb3lfc3RhdGUoc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ICB7Cj4g
IAlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9IHRvX2ludGVsX2NydGNfc3Rh
dGUoc3RhdGUpOwo+ICAKPiArCWRybV9XQVJOX09OKGNydGMtPmRldiwgY3J0Y19zdGF0ZS0+ZHNi
KTsKPiArCj4gIAlfX2RybV9hdG9taWNfaGVscGVyX2NydGNfZGVzdHJveV9zdGF0ZSgmY3J0Y19z
dGF0ZS0+dWFwaSk7Cj4gIAlpbnRlbF9jcnRjX2ZyZWVfaHdfc3RhdGUoY3J0Y19zdGF0ZSk7Cj4g
IAlrZnJlZShjcnRjX3N0YXRlKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF9jb2xvci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9jb2xvci5jCj4gaW5kZXggOThlY2U5Y2Q3Y2RkLi45NDViYjAzYmRkNGQgMTAwNjQ0Cj4gLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9jb2xvci5jCj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9jb2xvci5jCj4gQEAgLTcxNCwxNiArNzE0
LDE2IEBAIHN0YXRpYyB2b2lkIGJkd19sb2FkX2x1dF8xMChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YywKPiAgCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBQUkVDX1BBTF9JTkRFWChwaXBlKSwgMCk7
Cj4gIH0KPiAgCj4gLXN0YXRpYyB2b2lkIGl2Yl9sb2FkX2x1dF9leHRfbWF4KHN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjKQo+ICtzdGF0aWMgdm9pZCBpdmJfbG9hZF9sdXRfZXh0X21heChjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+ICsJc3RydWN0IGludGVs
X2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2
KTsKPiAtCXN0cnVjdCBpbnRlbF9kc2IgKmRzYiA9IGludGVsX2RzYl9nZXQoY3J0Yyk7Cj4gIAll
bnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gIAo+ICAJLyogUHJvZ3JhbSB0aGUgbWF4IHJl
Z2lzdGVyIHRvIGNsYW1wIHZhbHVlcyA+IDEuMC4gKi8KPiAtCWludGVsX2RzYl9yZWdfd3JpdGUo
ZHNiLCBQUkVDX1BBTF9FWFRfR0NfTUFYKHBpcGUsIDApLCAxIDw8IDE2KTsKPiAtCWludGVsX2Rz
Yl9yZWdfd3JpdGUoZHNiLCBQUkVDX1BBTF9FWFRfR0NfTUFYKHBpcGUsIDEpLCAxIDw8IDE2KTsK
PiAtCWludGVsX2RzYl9yZWdfd3JpdGUoZHNiLCBQUkVDX1BBTF9FWFRfR0NfTUFYKHBpcGUsIDIp
LCAxIDw8IDE2KTsKPiArCWludGVsX2RzYl9yZWdfd3JpdGUoY3J0Y19zdGF0ZSwgUFJFQ19QQUxf
RVhUX0dDX01BWChwaXBlLCAwKSwgMSA8PCAxNik7Cj4gKwlpbnRlbF9kc2JfcmVnX3dyaXRlKGNy
dGNfc3RhdGUsIFBSRUNfUEFMX0VYVF9HQ19NQVgocGlwZSwgMSksIDEgPDwgMTYpOwo+ICsJaW50
ZWxfZHNiX3JlZ193cml0ZShjcnRjX3N0YXRlLCBQUkVDX1BBTF9FWFRfR0NfTUFYKHBpcGUsIDIp
LCAxIDw8IDE2KTsKPiAgCj4gIAkvKgo+ICAJICogUHJvZ3JhbSB0aGUgZ2MgbWF4IDIgcmVnaXN0
ZXIgdG8gY2xhbXAgdmFsdWVzID4gMS4wLgo+IEBAIC03MzEsMTUgKzczMSwxMyBAQCBzdGF0aWMg
dm9pZCBpdmJfbG9hZF9sdXRfZXh0X21heChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiAgCSAq
IGZyb20gMy4wIHRvIDcuMAo+ICAJICovCj4gIAlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAx
MCB8fCBJU19HRU1JTklMQUtFKGRldl9wcml2KSkgewo+IC0JCWludGVsX2RzYl9yZWdfd3JpdGUo
ZHNiLCBQUkVDX1BBTF9FWFQyX0dDX01BWChwaXBlLCAwKSwKPiArCQlpbnRlbF9kc2JfcmVnX3dy
aXRlKGNydGNfc3RhdGUsIFBSRUNfUEFMX0VYVDJfR0NfTUFYKHBpcGUsIDApLAo+ICAJCQkJICAg
IDEgPDwgMTYpOwo+IC0JCWludGVsX2RzYl9yZWdfd3JpdGUoZHNiLCBQUkVDX1BBTF9FWFQyX0dD
X01BWChwaXBlLCAxKSwKPiArCQlpbnRlbF9kc2JfcmVnX3dyaXRlKGNydGNfc3RhdGUsIFBSRUNf
UEFMX0VYVDJfR0NfTUFYKHBpcGUsIDEpLAo+ICAJCQkJICAgIDEgPDwgMTYpOwo+IC0JCWludGVs
X2RzYl9yZWdfd3JpdGUoZHNiLCBQUkVDX1BBTF9FWFQyX0dDX01BWChwaXBlLCAyKSwKPiArCQlp
bnRlbF9kc2JfcmVnX3dyaXRlKGNydGNfc3RhdGUsIFBSRUNfUEFMX0VYVDJfR0NfTUFYKHBpcGUs
IDIpLAo+ICAJCQkJICAgIDEgPDwgMTYpOwo+ICAJfQo+IC0KPiAtCWludGVsX2RzYl9wdXQoZHNi
KTsKPiAgfQo+ICAKPiAgc3RhdGljIHZvaWQgaXZiX2xvYWRfbHV0cyhjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiBAQCAtNzUzLDcgKzc1MSw3IEBAIHN0YXRpYyB2
b2lkIGl2Yl9sb2FkX2x1dHMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUpCj4gIAl9IGVsc2UgaWYgKGNydGNfc3RhdGUtPmdhbW1hX21vZGUgPT0gR0FNTUFfTU9ERV9N
T0RFX1NQTElUKSB7Cj4gIAkJaXZiX2xvYWRfbHV0XzEwKGNydGMsIGRlZ2FtbWFfbHV0LCBQQUxf
UFJFQ19TUExJVF9NT0RFIHwKPiAgCQkJCVBBTF9QUkVDX0lOREVYX1ZBTFVFKDApKTsKPiAtCQlp
dmJfbG9hZF9sdXRfZXh0X21heChjcnRjKTsKPiArCQlpdmJfbG9hZF9sdXRfZXh0X21heChjcnRj
X3N0YXRlKTsKPiAgCQlpdmJfbG9hZF9sdXRfMTAoY3J0YywgZ2FtbWFfbHV0LCBQQUxfUFJFQ19T
UExJVF9NT0RFIHwKPiAgCQkJCVBBTF9QUkVDX0lOREVYX1ZBTFVFKDUxMikpOwo+ICAJfSBlbHNl
IHsKPiBAQCAtNzYxLDcgKzc1OSw3IEBAIHN0YXRpYyB2b2lkIGl2Yl9sb2FkX2x1dHMoY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIAo+ICAJCWl2Yl9sb2FkX2x1
dF8xMChjcnRjLCBibG9iLAo+ICAJCQkJUEFMX1BSRUNfSU5ERVhfVkFMVUUoMCkpOwo+IC0JCWl2
Yl9sb2FkX2x1dF9leHRfbWF4KGNydGMpOwo+ICsJCWl2Yl9sb2FkX2x1dF9leHRfbWF4KGNydGNf
c3RhdGUpOwo+ICAJfQo+ICB9Cj4gIAo+IEBAIC03NzYsNyArNzc0LDcgQEAgc3RhdGljIHZvaWQg
YmR3X2xvYWRfbHV0cyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkK
PiAgCX0gZWxzZSBpZiAoY3J0Y19zdGF0ZS0+Z2FtbWFfbW9kZSA9PSBHQU1NQV9NT0RFX01PREVf
U1BMSVQpIHsKPiAgCQliZHdfbG9hZF9sdXRfMTAoY3J0YywgZGVnYW1tYV9sdXQsIFBBTF9QUkVD
X1NQTElUX01PREUgfAo+ICAJCQkJUEFMX1BSRUNfSU5ERVhfVkFMVUUoMCkpOwo+IC0JCWl2Yl9s
b2FkX2x1dF9leHRfbWF4KGNydGMpOwo+ICsJCWl2Yl9sb2FkX2x1dF9leHRfbWF4KGNydGNfc3Rh
dGUpOwo+ICAJCWJkd19sb2FkX2x1dF8xMChjcnRjLCBnYW1tYV9sdXQsIFBBTF9QUkVDX1NQTElU
X01PREUgfAo+ICAJCQkJUEFMX1BSRUNfSU5ERVhfVkFMVUUoNTEyKSk7Cj4gIAl9IGVsc2Ugewo+
IEBAIC03ODQsNyArNzgyLDcgQEAgc3RhdGljIHZvaWQgYmR3X2xvYWRfbHV0cyhjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgCj4gIAkJYmR3X2xvYWRfbHV0XzEw
KGNydGMsIGJsb2IsCj4gIAkJCQlQQUxfUFJFQ19JTkRFWF9WQUxVRSgwKSk7Cj4gLQkJaXZiX2xv
YWRfbHV0X2V4dF9tYXgoY3J0Yyk7Cj4gKwkJaXZiX2xvYWRfbHV0X2V4dF9tYXgoY3J0Y19zdGF0
ZSk7Cj4gIAl9Cj4gIH0KPiAgCj4gQEAgLTg3Nyw3ICs4NzUsNyBAQCBzdGF0aWMgdm9pZCBnbGtf
bG9hZF9sdXRzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAJ
CWlsa19sb2FkX2x1dF84KGNydGMsIGdhbW1hX2x1dCk7Cj4gIAl9IGVsc2Ugewo+ICAJCWJkd19s
b2FkX2x1dF8xMChjcnRjLCBnYW1tYV9sdXQsIFBBTF9QUkVDX0lOREVYX1ZBTFVFKDApKTsKPiAt
CQlpdmJfbG9hZF9sdXRfZXh0X21heChjcnRjKTsKPiArCQlpdmJfbG9hZF9sdXRfZXh0X21heChj
cnRjX3N0YXRlKTsKPiAgCX0KPiAgfQo+ICAKPiBAQCAtOTAwLDE0ICs4OTgsMTIgQEAgaWNsX2xv
YWRfZ2NtYXgoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gIAkg
ICAgICAgY29uc3Qgc3RydWN0IGRybV9jb2xvcl9sdXQgKmNvbG9yKQo+ICB7Cj4gIAlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsK
PiAtCXN0cnVjdCBpbnRlbF9kc2IgKmRzYiA9IGludGVsX2RzYl9nZXQoY3J0Yyk7Cj4gIAllbnVt
IHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gIAo+ICAJLyogRklYTUUgTFVUIGVudHJpZXMgYXJl
IDE2IGJpdCBvbmx5LCBzbyB3ZSBjYW4gcHJvZyAweEZGRkYgbWF4ICovCj4gLQlpbnRlbF9kc2Jf
cmVnX3dyaXRlKGRzYiwgUFJFQ19QQUxfR0NfTUFYKHBpcGUsIDApLCBjb2xvci0+cmVkKTsKPiAt
CWludGVsX2RzYl9yZWdfd3JpdGUoZHNiLCBQUkVDX1BBTF9HQ19NQVgocGlwZSwgMSksIGNvbG9y
LT5ncmVlbik7Cj4gLQlpbnRlbF9kc2JfcmVnX3dyaXRlKGRzYiwgUFJFQ19QQUxfR0NfTUFYKHBp
cGUsIDIpLCBjb2xvci0+Ymx1ZSk7Cj4gLQlpbnRlbF9kc2JfcHV0KGRzYik7Cj4gKwlpbnRlbF9k
c2JfcmVnX3dyaXRlKGNydGNfc3RhdGUsIFBSRUNfUEFMX0dDX01BWChwaXBlLCAwKSwgY29sb3It
PnJlZCk7Cj4gKwlpbnRlbF9kc2JfcmVnX3dyaXRlKGNydGNfc3RhdGUsIFBSRUNfUEFMX0dDX01B
WChwaXBlLCAxKSwgY29sb3ItPmdyZWVuKTsKPiArCWludGVsX2RzYl9yZWdfd3JpdGUoY3J0Y19z
dGF0ZSwgUFJFQ19QQUxfR0NfTUFYKHBpcGUsIDIpLCBjb2xvci0+Ymx1ZSk7Cj4gIH0KPiAgCj4g
IHN0YXRpYyB2b2lkCj4gQEAgLTkxNiw3ICs5MTIsNiBAQCBpY2xfcHJvZ3JhbV9nYW1tYV9zdXBl
cmZpbmVfc2VnbWVudChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkK
PiAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51
YXBpLmNydGMpOwo+ICAJY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpibG9iID0gY3J0
Y19zdGF0ZS0+aHcuZ2FtbWFfbHV0Owo+ICAJY29uc3Qgc3RydWN0IGRybV9jb2xvcl9sdXQgKmx1
dCA9IGJsb2ItPmRhdGE7Cj4gLQlzdHJ1Y3QgaW50ZWxfZHNiICpkc2IgPSBpbnRlbF9kc2JfZ2V0
KGNydGMpOwo+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAJaW50IGk7Cj4gIAo+
IEBAIC05MjcsMTkgKzkyMiwxNyBAQCBpY2xfcHJvZ3JhbV9nYW1tYV9zdXBlcmZpbmVfc2VnbWVu
dChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgCSAqIDkgZW50
cmllcywgY29ycmVzcG9uZGluZyB0byB2YWx1ZXMgMCwgMS8oOCAqIDEyOCAqIDI1NiksCj4gIAkg
KiAyLyg4ICogMTI4ICogMjU2KSAuLi4gOC8oOCAqIDEyOCAqIDI1NikuCj4gIAkgKi8KPiAtCWlu
dGVsX2RzYl9yZWdfd3JpdGUoZHNiLCBQUkVDX1BBTF9NVUxUSV9TRUdfSU5ERVgocGlwZSksCj4g
KwlpbnRlbF9kc2JfcmVnX3dyaXRlKGNydGNfc3RhdGUsIFBSRUNfUEFMX01VTFRJX1NFR19JTkRF
WChwaXBlKSwKPiAgCQkJICAgIFBBTF9QUkVDX0FVVE9fSU5DUkVNRU5UKTsKPiAgCj4gIAlmb3Ig
KGkgPSAwOyBpIDwgOTsgaSsrKSB7Cj4gIAkJY29uc3Qgc3RydWN0IGRybV9jb2xvcl9sdXQgKmVu
dHJ5ID0gJmx1dFtpXTsKPiAgCj4gLQkJaW50ZWxfZHNiX2luZGV4ZWRfcmVnX3dyaXRlKGRzYiwg
UFJFQ19QQUxfTVVMVElfU0VHX0RBVEEocGlwZSksCj4gKwkJaW50ZWxfZHNiX2luZGV4ZWRfcmVn
X3dyaXRlKGNydGNfc3RhdGUsIFBSRUNfUEFMX01VTFRJX1NFR19EQVRBKHBpcGUpLAo+ICAJCQkJ
CSAgICBpbGtfbHV0XzEycDRfbGR3KGVudHJ5KSk7Cj4gLQkJaW50ZWxfZHNiX2luZGV4ZWRfcmVn
X3dyaXRlKGRzYiwgUFJFQ19QQUxfTVVMVElfU0VHX0RBVEEocGlwZSksCj4gKwkJaW50ZWxfZHNi
X2luZGV4ZWRfcmVnX3dyaXRlKGNydGNfc3RhdGUsIFBSRUNfUEFMX01VTFRJX1NFR19EQVRBKHBp
cGUpLAo+ICAJCQkJCSAgICBpbGtfbHV0XzEycDRfdWR3KGVudHJ5KSk7Cj4gIAl9Cj4gLQo+IC0J
aW50ZWxfZHNiX3B1dChkc2IpOwo+ICB9Cj4gIAo+ICBzdGF0aWMgdm9pZAo+IEBAIC05NDksNyAr
OTQyLDYgQEAgaWNsX3Byb2dyYW1fZ2FtbWFfbXVsdGlfc2VnbWVudChjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgCWNvbnN0IHN0cnVjdCBkcm1fcHJvcGVydHlf
YmxvYiAqYmxvYiA9IGNydGNfc3RhdGUtPmh3LmdhbW1hX2x1dDsKPiAgCWNvbnN0IHN0cnVjdCBk
cm1fY29sb3JfbHV0ICpsdXQgPSBibG9iLT5kYXRhOwo+ICAJY29uc3Qgc3RydWN0IGRybV9jb2xv
cl9sdXQgKmVudHJ5Owo+IC0Jc3RydWN0IGludGVsX2RzYiAqZHNiID0gaW50ZWxfZHNiX2dldChj
cnRjKTsKPiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCWludCBpOwo+ICAKPiBA
QCAtOTYzLDEyICs5NTUsMTMgQEAgaWNsX3Byb2dyYW1fZ2FtbWFfbXVsdGlfc2VnbWVudChjb25z
dCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgCSAqIFBBTF9QUkVDX0lO
REVYWzBdIGFuZCBQQUxfUFJFQ19JTkRFWFsxXSBtYXAgdG8gc2VnMlsxXSwKPiAgCSAqIHNlZzJb
MF0gYmVpbmcgdW51c2VkIGJ5IHRoZSBoYXJkd2FyZS4KPiAgCSAqLwo+IC0JaW50ZWxfZHNiX3Jl
Z193cml0ZShkc2IsIFBSRUNfUEFMX0lOREVYKHBpcGUpLCBQQUxfUFJFQ19BVVRPX0lOQ1JFTUVO
VCk7Cj4gKwlpbnRlbF9kc2JfcmVnX3dyaXRlKGNydGNfc3RhdGUsIFBSRUNfUEFMX0lOREVYKHBp
cGUpLAo+ICsJCQkgICAgUEFMX1BSRUNfQVVUT19JTkNSRU1FTlQpOwo+ICAJZm9yIChpID0gMTsg
aSA8IDI1NzsgaSsrKSB7Cj4gIAkJZW50cnkgPSAmbHV0W2kgKiA4XTsKPiAtCQlpbnRlbF9kc2Jf
aW5kZXhlZF9yZWdfd3JpdGUoZHNiLCBQUkVDX1BBTF9EQVRBKHBpcGUpLAo+ICsJCWludGVsX2Rz
Yl9pbmRleGVkX3JlZ193cml0ZShjcnRjX3N0YXRlLCBQUkVDX1BBTF9EQVRBKHBpcGUpLAo+ICAJ
CQkJCSAgICBpbGtfbHV0XzEycDRfbGR3KGVudHJ5KSk7Cj4gLQkJaW50ZWxfZHNiX2luZGV4ZWRf
cmVnX3dyaXRlKGRzYiwgUFJFQ19QQUxfREFUQShwaXBlKSwKPiArCQlpbnRlbF9kc2JfaW5kZXhl
ZF9yZWdfd3JpdGUoY3J0Y19zdGF0ZSwgUFJFQ19QQUxfREFUQShwaXBlKSwKPiAgCQkJCQkgICAg
aWxrX2x1dF8xMnA0X3VkdyhlbnRyeSkpOwo+ICAJfQo+ICAKPiBAQCAtOTg2LDI0ICs5NzksMjIg
QEAgaWNsX3Byb2dyYW1fZ2FtbWFfbXVsdGlfc2VnbWVudChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgCSAqLwo+ICAJZm9yIChpID0gMDsgaSA8IDI1NjsgaSsr
KSB7Cj4gIAkJZW50cnkgPSAmbHV0W2kgKiA4ICogMTI4XTsKPiAtCQlpbnRlbF9kc2JfaW5kZXhl
ZF9yZWdfd3JpdGUoZHNiLCBQUkVDX1BBTF9EQVRBKHBpcGUpLAo+ICsJCWludGVsX2RzYl9pbmRl
eGVkX3JlZ193cml0ZShjcnRjX3N0YXRlLCBQUkVDX1BBTF9EQVRBKHBpcGUpLAo+ICAJCQkJCSAg
ICBpbGtfbHV0XzEycDRfbGR3KGVudHJ5KSk7Cj4gLQkJaW50ZWxfZHNiX2luZGV4ZWRfcmVnX3dy
aXRlKGRzYiwgUFJFQ19QQUxfREFUQShwaXBlKSwKPiArCQlpbnRlbF9kc2JfaW5kZXhlZF9yZWdf
d3JpdGUoY3J0Y19zdGF0ZSwgUFJFQ19QQUxfREFUQShwaXBlKSwKPiAgCQkJCQkgICAgaWxrX2x1
dF8xMnA0X3VkdyhlbnRyeSkpOwo+ICAJfQo+ICAKPiAgCS8qIFRoZSBsYXN0IGVudHJ5IGluIHRo
ZSBMVVQgaXMgdG8gYmUgcHJvZ3JhbW1lZCBpbiBHQ01BWCAqLwo+ICAJZW50cnkgPSAmbHV0WzI1
NiAqIDggKiAxMjhdOwo+ICAJaWNsX2xvYWRfZ2NtYXgoY3J0Y19zdGF0ZSwgZW50cnkpOwo+IC0J
aXZiX2xvYWRfbHV0X2V4dF9tYXgoY3J0Yyk7Cj4gLQlpbnRlbF9kc2JfcHV0KGRzYik7Cj4gKwlp
dmJfbG9hZF9sdXRfZXh0X21heChjcnRjX3N0YXRlKTsKPiAgfQo+ICAKPiAgc3RhdGljIHZvaWQg
aWNsX2xvYWRfbHV0cyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkK
PiAgewo+ICAJY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpnYW1tYV9sdXQgPSBjcnRj
X3N0YXRlLT5ody5nYW1tYV9sdXQ7Cj4gIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAtCXN0cnVjdCBpbnRlbF9kc2IgKmRz
YiA9IGludGVsX2RzYl9nZXQoY3J0Yyk7Cj4gIAo+ICAJaWYgKGNydGNfc3RhdGUtPmh3LmRlZ2Ft
bWFfbHV0KQo+ICAJCWdsa19sb2FkX2RlZ2FtbWFfbHV0KGNydGNfc3RhdGUpOwo+IEBAIC0xMDE4
LDExICsxMDA5LDEwIEBAIHN0YXRpYyB2b2lkIGljbF9sb2FkX2x1dHMoY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIAkJYnJlYWs7Cj4gIAlkZWZhdWx0Ogo+ICAJ
CWJkd19sb2FkX2x1dF8xMChjcnRjLCBnYW1tYV9sdXQsIFBBTF9QUkVDX0lOREVYX1ZBTFVFKDAp
KTsKPiAtCQlpdmJfbG9hZF9sdXRfZXh0X21heChjcnRjKTsKPiArCQlpdmJfbG9hZF9sdXRfZXh0
X21heChjcnRjX3N0YXRlKTsKPiAgCX0KPiAgCj4gLQlpbnRlbF9kc2JfY29tbWl0KGRzYik7Cj4g
LQlpbnRlbF9kc2JfcHV0KGRzYik7Cj4gKwlpbnRlbF9kc2JfY29tbWl0KGNydGNfc3RhdGUpOwo+
ICB9Cj4gIAo+ICBzdGF0aWMgdTMyIGNodl9jZ21fZGVnYW1tYV9sZHcoY29uc3Qgc3RydWN0IGRy
bV9jb2xvcl9sdXQgKmNvbG9yKQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2Rpc3BsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfZGlzcGxheS5jCj4gaW5kZXggNDMyYjRlZWFmOWY2Li41MTQ0ODNmZmQyNDcgMTAwNjQ0Cj4g
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKPiArKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwo+IEBAIC0xNDg3
Myw4ICsxNDg3MywyNCBAQCBzdGF0aWMgaW50IGludGVsX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2LAo+ICAKPiAgc3RhdGljIGludCBpbnRlbF9hdG9taWNfcHJlcGFyZV9jb21t
aXQoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gIHsKPiAtCXJldHVybiBkcm1f
YXRvbWljX2hlbHBlcl9wcmVwYXJlX3BsYW5lcyhzdGF0ZS0+YmFzZS5kZXYsCj4gLQkJCQkJCSZz
dGF0ZS0+YmFzZSk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZTsKPiAr
CXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOwo+ICsJaW50IGksIHJldDsKPiArCj4gKwlyZXQgPSBk
cm1fYXRvbWljX2hlbHBlcl9wcmVwYXJlX3BsYW5lcyhzdGF0ZS0+YmFzZS5kZXYsICZzdGF0ZS0+
YmFzZSk7Cj4gKwlpZiAocmV0IDwgMCkKPiArCQlyZXR1cm4gcmV0Owo+ICsKPiArCWZvcl9lYWNo
X25ld19pbnRlbF9jcnRjX2luX3N0YXRlKHN0YXRlLCBjcnRjLCBjcnRjX3N0YXRlLCBpKSB7Cj4g
KwkJYm9vbCBtb2RlX2NoYW5nZWQgPSBuZWVkc19tb2Rlc2V0KGNydGNfc3RhdGUpOwo+ICsKPiAr
CQlpZiAobW9kZV9jaGFuZ2VkIHx8IGNydGNfc3RhdGUtPnVwZGF0ZV9waXBlIHx8Cj4gKwkJICAg
IGNydGNfc3RhdGUtPnVhcGkuY29sb3JfbWdtdF9jaGFuZ2VkKSB7Cj4gKwkJCWludGVsX2RzYl9w
cmVwYXJlKGNydGNfc3RhdGUpOwo+ICsJCX0KPiArCX0KPiArCj4gKwlyZXR1cm4gMDsKPiAgfQo+
ICAKPiAgdTMyIGludGVsX2NydGNfZ2V0X3ZibGFua19jb3VudGVyKHN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjKQo+IEBAIC0xNTMyNywxNSArMTUzNDMsMjcgQEAgc3RhdGljIHZvaWQgaW50ZWxfYXRv
bWljX2NvbW1pdF9mZW5jZV93YWl0KHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKmludGVsX3N0
YXQKPiAgCQkgICAgJndhaXRfcmVzZXQpOwo+ICB9Cj4gIAo+ICtzdGF0aWMgdm9pZCBpbnRlbF9j
bGVhbnVwX2RzYnMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gK3sKPiArCXN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwgKm5ld19jcnRjX3N0YXRlOwo+
ICsJc3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4gKwlpbnQgaTsKPiArCj4gKwlmb3JfZWFjaF9v
bGRuZXdfaW50ZWxfY3J0Y19pbl9zdGF0ZShzdGF0ZSwgY3J0Yywgb2xkX2NydGNfc3RhdGUsCj4g
KwkJCQkJICAgIG5ld19jcnRjX3N0YXRlLCBpKQo+ICsJCWludGVsX2RzYl9jbGVhbnVwKG9sZF9j
cnRjX3N0YXRlKTsKPiArfQo+ICsKPiAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX2NsZWFudXBf
d29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gIHsKPiAtCXN0cnVjdCBkcm1fYXRvbWlj
X3N0YXRlICpzdGF0ZSA9Cj4gLQkJY29udGFpbmVyX29mKHdvcmssIHN0cnVjdCBkcm1fYXRvbWlj
X3N0YXRlLCBjb21taXRfd29yayk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoc3RhdGUtPmRldik7Cj4gKwlzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0
ZSA9Cj4gKwkJY29udGFpbmVyX29mKHdvcmssIHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUsIGJh
c2UuY29tbWl0X3dvcmspOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KHN0YXRlLT5iYXNlLmRldik7Cj4gIAo+IC0JZHJtX2F0b21pY19oZWxwZXJfY2xlYW51cF9w
bGFuZXMoJmk5MTUtPmRybSwgc3RhdGUpOwo+IC0JZHJtX2F0b21pY19oZWxwZXJfY29tbWl0X2Ns
ZWFudXBfZG9uZShzdGF0ZSk7Cj4gLQlkcm1fYXRvbWljX3N0YXRlX3B1dChzdGF0ZSk7Cj4gKwlp
bnRlbF9jbGVhbnVwX2RzYnMoc3RhdGUpOwo+ICsJZHJtX2F0b21pY19oZWxwZXJfY2xlYW51cF9w
bGFuZXMoJmk5MTUtPmRybSwgJnN0YXRlLT5iYXNlKTsKPiArCWRybV9hdG9taWNfaGVscGVyX2Nv
bW1pdF9jbGVhbnVwX2RvbmUoJnN0YXRlLT5iYXNlKTsKPiArCWRybV9hdG9taWNfc3RhdGVfcHV0
KCZzdGF0ZS0+YmFzZSk7Cj4gIAo+ICAJaW50ZWxfYXRvbWljX2hlbHBlcl9mcmVlX3N0YXRlKGk5
MTUpOwo+ICB9Cj4gQEAgLTE1NDY5LDYgKzE1NDk3LDEzIEBAIHN0YXRpYyB2b2lkIGludGVsX2F0
b21pY19jb21taXRfdGFpbChzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgCQkJ
bW9kZXNldF9wdXRfcG93ZXJfZG9tYWlucyhkZXZfcHJpdiwgcHV0X2RvbWFpbnNbaV0pOwo+ICAK
PiAgCQlpbnRlbF9tb2Rlc2V0X3ZlcmlmeV9jcnRjKGNydGMsIHN0YXRlLCBvbGRfY3J0Y19zdGF0
ZSwgbmV3X2NydGNfc3RhdGUpOwo+ICsKPiArCQkvKgo+ICsJCSAqIERTQiBjbGVhbnVwIGlzIGRv
bmUgaW4gY2xlYW51cF93b3JrIGFsaWduaW5nIHdpdGggZnJhbWVidWZmZXIKPiArCQkgKiBjbGVh
bnVwLiBTbyBjb3B5IGFuZCByZXNldCB0aGUgZHNiIHN0cnVjdHVyZSB0byBzeW5jIHdpdGgKPiAr
CQkgKiBjb21taXRfZG9uZSBhbmQgbGF0ZXIgZG8gZHNiIGNsZWFudXAgaW4gY2xlYW51cF93b3Jr
Lgo+ICsJCSAqLwo+ICsJCW9sZF9jcnRjX3N0YXRlLT5kc2IgPSBmZXRjaF9hbmRfemVybygmbmV3
X2NydGNfc3RhdGUtPmRzYik7Cj4gIAl9Cj4gIAo+ICAJLyogVW5kZXJydW5zIGRvbid0IGFsd2F5
cyByYWlzZSBpbnRlcnJ1cHRzLCBzbyBjaGVjayBtYW51YWxseSAqLwo+IEBAIC0xNTYxOCw4ICsx
NTY1MywxNSBAQCBzdGF0aWMgaW50IGludGVsX2F0b21pY19jb21taXQoc3RydWN0IGRybV9kZXZp
Y2UgKmRldiwKPiAgCQlpbnRlbF9hdG9taWNfc3dhcF9nbG9iYWxfc3RhdGUoc3RhdGUpOwo+ICAK
PiAgCWlmIChyZXQpIHsKPiArCQlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3Rh
dGU7Cj4gKwkJc3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4gKwkJaW50IGk7Cj4gKwo+ICAJCWk5
MTVfc3dfZmVuY2VfY29tbWl0KCZzdGF0ZS0+Y29tbWl0X3JlYWR5KTsKPiAgCj4gKwkJZm9yX2Vh
Y2hfbmV3X2ludGVsX2NydGNfaW5fc3RhdGUoc3RhdGUsIGNydGMsIG5ld19jcnRjX3N0YXRlLCBp
KQo+ICsJCQlpbnRlbF9kc2JfY2xlYW51cChuZXdfY3J0Y19zdGF0ZSk7Cj4gKwo+ICAJCWRybV9h
dG9taWNfaGVscGVyX2NsZWFudXBfcGxhbmVzKGRldiwgJnN0YXRlLT5iYXNlKTsKPiAgCQlpbnRl
bF9ydW50aW1lX3BtX3B1dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHN0YXRlLT53YWtlcmVmKTsK
PiAgCQlyZXR1cm4gcmV0Owo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfZGlzcGxheV90eXBlcy5oCj4gaW5kZXggODc4NzZmY2U5MWE1Li5jYTU3OTAwNWQ4MTgg
MTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5
X3R5cGVzLmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3Bs
YXlfdHlwZXMuaAo+IEBAIC0xMDc4LDYgKzEwNzgsOSBAQCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSB7Cj4gIAo+ICAJLyogT25seSB2YWxpZCBvbiBUR0wrICovCj4gIAllbnVtIHRyYW5zY29kZXIg
bXN0X21hc3Rlcl90cmFuc2NvZGVyOwo+ICsKPiArCS8qIEZvciBEU0IgcmVsYXRlZCBpbmZvICov
Cj4gKwlzdHJ1Y3QgaW50ZWxfZHNiICpkc2I7Cj4gIH07Cj4gIAo+ICBlbnVtIGludGVsX3BpcGVf
Y3JjX3NvdXJjZSB7Cj4gQEAgLTExNDcsOSArMTE1MCw2IEBAIHN0cnVjdCBpbnRlbF9jcnRjIHsK
PiAgCS8qIHNjYWxlcnMgYXZhaWxhYmxlIG9uIHRoaXMgY3J0YyAqLwo+ICAJaW50IG51bV9zY2Fs
ZXJzOwo+ICAKPiAtCS8qIHBlciBwaXBlIERTQiByZWxhdGVkIGluZm8gKi8KPiAtCXN0cnVjdCBp
bnRlbF9kc2IgZHNiOwo+IC0KPiAgI2lmZGVmIENPTkZJR19ERUJVR19GUwo+ICAJc3RydWN0IGlu
dGVsX3BpcGVfY3JjIHBpcGVfY3JjOwo+ICAjZW5kaWYKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kc2IuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfZHNiLmMKPiBpbmRleCAyOWZlYzZhOTJkMTcuLjUwY2I1MThhN2RmMyAxMDA2
NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RzYi5jCj4gKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kc2IuYwo+IEBAIC0zNCwxNTIg
KzM0LDUyIEBACj4gICNkZWZpbmUgRFNCX0JZVEVfRU5fU0hJRlQJCTIwCj4gICNkZWZpbmUgRFNC
X1JFR19WQUxVRV9NQVNLCQkweGZmZmZmCj4gIAo+IC1zdGF0aWMgYm9vbCBpc19kc2JfYnVzeShz
dHJ1Y3QgaW50ZWxfZHNiICpkc2IpCj4gK3N0YXRpYyBib29sIGlzX2RzYl9idXN5KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBpcGUgcGlwZSwKPiArCQkJZW51bSBkc2JfaWQg
aWQpCj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gY29udGFpbmVyX29mKGRzYiwg
dHlwZW9mKCpjcnRjKSwgZHNiKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+IC0JZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5w
aXBlOwo+IC0KPiAtCXJldHVybiBEU0JfU1RBVFVTICYgaW50ZWxfZGVfcmVhZChkZXZfcHJpdiwg
RFNCX0NUUkwocGlwZSwgZHNiLT5pZCkpOwo+ICsJcmV0dXJuIERTQl9TVEFUVVMgJiBpbnRlbF9k
ZV9yZWFkKGk5MTUsIERTQl9DVFJMKHBpcGUsIGlkKSk7Cj4gIH0KPiAgCj4gLXN0YXRpYyBib29s
IGludGVsX2RzYl9lbmFibGVfZW5naW5lKHN0cnVjdCBpbnRlbF9kc2IgKmRzYikKPiArc3RhdGlj
IGJvb2wgaW50ZWxfZHNiX2VuYWJsZV9lbmdpbmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gKwkJCQkgICAgZW51bSBwaXBlIHBpcGUsIGVudW0gZHNiX2lkIGlkKQo+ICB7Cj4gLQlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IGNvbnRhaW5lcl9vZihkc2IsIHR5cGVvZigqY3J0Yyks
IGRzYik7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNy
dGMtPmJhc2UuZGV2KTsKPiAtCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCXUzMiBk
c2JfY3RybDsKPiAgCj4gLQlkc2JfY3RybCA9IGludGVsX2RlX3JlYWQoZGV2X3ByaXYsIERTQl9D
VFJMKHBpcGUsIGRzYi0+aWQpKTsKPiArCWRzYl9jdHJsID0gaW50ZWxfZGVfcmVhZChpOTE1LCBE
U0JfQ1RSTChwaXBlLCBpZCkpOwo+ICAJaWYgKERTQl9TVEFUVVMgJiBkc2JfY3RybCkgewo+IC0J
CWRybV9kYmdfa21zKCZkZXZfcHJpdi0+ZHJtLCAiRFNCIGVuZ2luZSBpcyBidXN5LlxuIik7Cj4g
KwkJZHJtX2RiZ19rbXMoJmk5MTUtPmRybSwgIkRTQiBlbmdpbmUgaXMgYnVzeS5cbiIpOwo+ICAJ
CXJldHVybiBmYWxzZTsKPiAgCX0KPiAgCj4gIAlkc2JfY3RybCB8PSBEU0JfRU5BQkxFOwo+IC0J
aW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIERTQl9DVFJMKHBpcGUsIGRzYi0+aWQpLCBkc2JfY3Ry
bCk7Cj4gKwlpbnRlbF9kZV93cml0ZShpOTE1LCBEU0JfQ1RSTChwaXBlLCBpZCksIGRzYl9jdHJs
KTsKPiAgCj4gLQlpbnRlbF9kZV9wb3N0aW5nX3JlYWQoZGV2X3ByaXYsIERTQl9DVFJMKHBpcGUs
IGRzYi0+aWQpKTsKPiArCWludGVsX2RlX3Bvc3RpbmdfcmVhZChpOTE1LCBEU0JfQ1RSTChwaXBl
LCBpZCkpOwo+ICAJcmV0dXJuIHRydWU7Cj4gIH0KPiAgCj4gLXN0YXRpYyBib29sIGludGVsX2Rz
Yl9kaXNhYmxlX2VuZ2luZShzdHJ1Y3QgaW50ZWxfZHNiICpkc2IpCj4gK3N0YXRpYyBib29sIGlu
dGVsX2RzYl9kaXNhYmxlX2VuZ2luZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAr
CQkJCSAgICAgZW51bSBwaXBlIHBpcGUsIGVudW0gZHNiX2lkIGlkKQo+ICB7Cj4gLQlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YyA9IGNvbnRhaW5lcl9vZihkc2IsIHR5cGVvZigqY3J0YyksIGRzYik7
Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJh
c2UuZGV2KTsKPiAtCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCXUzMiBkc2JfY3Ry
bDsKPiAgCj4gLQlkc2JfY3RybCA9IGludGVsX2RlX3JlYWQoZGV2X3ByaXYsIERTQl9DVFJMKHBp
cGUsIGRzYi0+aWQpKTsKPiArCWRzYl9jdHJsID0gaW50ZWxfZGVfcmVhZChpOTE1LCBEU0JfQ1RS
TChwaXBlLCBpZCkpOwo+ICAJaWYgKERTQl9TVEFUVVMgJiBkc2JfY3RybCkgewo+IC0JCWRybV9k
Ymdfa21zKCZkZXZfcHJpdi0+ZHJtLCAiRFNCIGVuZ2luZSBpcyBidXN5LlxuIik7Cj4gKwkJZHJt
X2RiZ19rbXMoJmk5MTUtPmRybSwgIkRTQiBlbmdpbmUgaXMgYnVzeS5cbiIpOwo+ICAJCXJldHVy
biBmYWxzZTsKPiAgCX0KPiAgCj4gIAlkc2JfY3RybCAmPSB+RFNCX0VOQUJMRTsKPiAtCWludGVs
X2RlX3dyaXRlKGRldl9wcml2LCBEU0JfQ1RSTChwaXBlLCBkc2ItPmlkKSwgZHNiX2N0cmwpOwo+
ICsJaW50ZWxfZGVfd3JpdGUoaTkxNSwgRFNCX0NUUkwocGlwZSwgaWQpLCBkc2JfY3RybCk7Cj4g
IAo+IC0JaW50ZWxfZGVfcG9zdGluZ19yZWFkKGRldl9wcml2LCBEU0JfQ1RSTChwaXBlLCBkc2It
PmlkKSk7Cj4gKwlpbnRlbF9kZV9wb3N0aW5nX3JlYWQoaTkxNSwgRFNCX0NUUkwocGlwZSwgaWQp
KTsKPiAgCXJldHVybiB0cnVlOwo+ICB9Cj4gIAo+IC0vKioKPiAtICogaW50ZWxfZHNiX2dldCgp
IC0gQWxsb2NhdGUgRFNCIGNvbnRleHQgYW5kIHJldHVybiBhIERTQiBpbnN0YW5jZS4KPiAtICog
QGNydGM6IGludGVsX2NydGMgc3RydWN0dXJlIHRvIGdldCBwaXBlIGluZm8uCj4gLSAqCj4gLSAq
IFRoaXMgZnVuY3Rpb24gcHJvdmlkZXMgaGFuZGxlIG9mIGEgRFNCIGluc3RhbmNlLCBmb3IgdGhl
IGZ1cnRoZXIgRFNCCj4gLSAqIG9wZXJhdGlvbnMuCj4gLSAqCj4gLSAqIFJldHVybnM6IGFkZHJl
c3Mgb2YgSW50ZWxfZHNiIGluc3RhbmNlIHJlcXVlc3RlZCBmb3IuCj4gLSAqIEZhaWx1cmU6IFJl
dHVybnMgdGhlIHNhbWUgRFNCIGluc3RhbmNlLCBidXQgd2l0aG91dCBhIGNvbW1hbmQgYnVmZmVy
Lgo+IC0gKi8KPiAtCj4gLXN0cnVjdCBpbnRlbF9kc2IgKgo+IC1pbnRlbF9kc2JfZ2V0KHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjKQo+IC17Cj4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0
Yy0+YmFzZS5kZXY7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
ZGV2KTsKPiAtCXN0cnVjdCBpbnRlbF9kc2IgKmRzYiA9ICZjcnRjLT5kc2I7Cj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwo+IC0Jc3RydWN0IGk5MTVfdm1hICp2bWE7Cj4gLQl1
MzIgKmJ1ZjsKPiAtCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+IC0KPiAtCWlmICghSEFTX0RT
QihpOTE1KSkKPiAtCQlyZXR1cm4gZHNiOwo+IC0KPiAtCWlmIChkc2ItPnJlZmNvdW50KysgIT0g
MCkKPiAtCQlyZXR1cm4gZHNiOwo+IC0KPiAtCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dl
dCgmaTkxNS0+cnVudGltZV9wbSk7Cj4gLQo+IC0Jb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0
ZV9pbnRlcm5hbChpOTE1LCBEU0JfQlVGX1NJWkUpOwo+IC0JaWYgKElTX0VSUihvYmopKSB7Cj4g
LQkJZHJtX2VycigmaTkxNS0+ZHJtLCAiR2VtIG9iamVjdCBjcmVhdGlvbiBmYWlsZWRcbiIpOwo+
IC0JCWdvdG8gb3V0Owo+IC0JfQo+IC0KPiAtCXZtYSA9IGk5MTVfZ2VtX29iamVjdF9nZ3R0X3Bp
bihvYmosIE5VTEwsIDAsIDAsIDApOwo+IC0JaWYgKElTX0VSUih2bWEpKSB7Cj4gLQkJZHJtX2Vy
cigmaTkxNS0+ZHJtLCAiVm1hIGNyZWF0aW9uIGZhaWxlZFxuIik7Cj4gLQkJaTkxNV9nZW1fb2Jq
ZWN0X3B1dChvYmopOwo+IC0JCWdvdG8gb3V0Owo+IC0JfQo+IC0KPiAtCWJ1ZiA9IGk5MTVfZ2Vt
X29iamVjdF9waW5fbWFwKHZtYS0+b2JqLCBJOTE1X01BUF9XQyk7Cj4gLQlpZiAoSVNfRVJSKGJ1
ZikpIHsKPiAtCQlkcm1fZXJyKCZpOTE1LT5kcm0sICJDb21tYW5kIGJ1ZmZlciBjcmVhdGlvbiBm
YWlsZWRcbiIpOwo+IC0JCWdvdG8gb3V0Owo+IC0JfQo+IC0KPiAtCWRzYi0+aWQgPSBEU0IxOwo+
IC0JZHNiLT52bWEgPSB2bWE7Cj4gLQlkc2ItPmNtZF9idWYgPSBidWY7Cj4gLQo+IC1vdXQ6Cj4g
LQkvKgo+IC0JICogT24gZXJyb3IgZHNiLT5jbWRfYnVmIHdpbGwgY29udGludWUgdG8gYmUgTlVM
TCwgbWFraW5nIHRoZSB3cml0ZXMKPiAtCSAqIHBhc3MtdGhyb3VnaC4gTGVhdmUgdGhlIGRhbmds
aW5nIHJlZiB0byBiZSByZW1vdmVkIGxhdGVyIGJ5IHRoZQo+IC0JICogY29ycmVzcG9uZGluZyBp
bnRlbF9kc2JfcHV0KCk6IHRoZSBpbXBvcnRhbnQgZXJyb3IgbWVzc2FnZSB3aWxsCj4gLQkgKiBh
bHJlYWR5IGJlIGxvZ2dlZCBhYm92ZS4KPiAtCSAqLwo+IC0KPiAtCWludGVsX3J1bnRpbWVfcG1f
cHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKPiAtCj4gLQlyZXR1cm4gZHNiOwo+IC19
Cj4gLQo+IC0vKioKPiAtICogaW50ZWxfZHNiX3B1dCgpIC0gVG8gZGVzdHJveSBEU0IgY29udGV4
dC4KPiAtICogQGRzYjogaW50ZWxfZHNiIHN0cnVjdHVyZS4KPiAtICoKPiAtICogVGhpcyBmdW5j
dGlvbiBkZXN0cm95cyB0aGUgRFNCIGNvbnRleHQgYWxsb2NhdGVkIGJ5IGEgZHNiX2dldCgpLCBi
eQo+IC0gKiB1bnBpbm5pbmcgYW5kIHJlbGVhc2luZyB0aGUgVk1BIG9iamVjdCBhc3NvY2lhdGVk
IHdpdGggaXQuCj4gLSAqLwo+IC0KPiAtdm9pZCBpbnRlbF9kc2JfcHV0KHN0cnVjdCBpbnRlbF9k
c2IgKmRzYikKPiAtewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSBjb250YWluZXJfb2Yo
ZHNiLCB0eXBlb2YoKmNydGMpLCBkc2IpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAtCj4gLQlpZiAoIUhBU19EU0IoaTkxNSkp
Cj4gLQkJcmV0dXJuOwo+IC0KPiAtCWlmIChkcm1fV0FSTl9PTigmaTkxNS0+ZHJtLCBkc2ItPnJl
ZmNvdW50ID09IDApKQo+IC0JCXJldHVybjsKPiAtCj4gLQlpZiAoLS1kc2ItPnJlZmNvdW50ID09
IDApIHsKPiAtCQlpOTE1X3ZtYV91bnBpbl9hbmRfcmVsZWFzZSgmZHNiLT52bWEsIEk5MTVfVk1B
X1JFTEVBU0VfTUFQKTsKPiAtCQlkc2ItPmNtZF9idWYgPSBOVUxMOwo+IC0JCWRzYi0+ZnJlZV9w
b3MgPSAwOwo+IC0JCWRzYi0+aW5zX3N0YXJ0X29mZnNldCA9IDA7Cj4gLQl9Cj4gLX0KPiAtCj4g
IC8qKgo+ICAgKiBpbnRlbF9kc2JfaW5kZXhlZF9yZWdfd3JpdGUoKSAtV3JpdGUgdG8gdGhlIERT
QiBjb250ZXh0IGZvciBhdXRvCj4gICAqIGluY3JlbWVudCByZWdpc3Rlci4KPiAtICogQGRzYjog
aW50ZWxfZHNiIHN0cnVjdHVyZS4KPiArICogQGNydGNfc3RhdGU6IGludGVsX2NydGNfc3RhdGUg
c3RydWN0dXJlCj4gICAqIEByZWc6IHJlZ2lzdGVyIGFkZHJlc3MuCj4gICAqIEB2YWw6IHZhbHVl
Lgo+ICAgKgo+IEBAIC0xODksMTkgKzg5LDIwIEBAIHZvaWQgaW50ZWxfZHNiX3B1dChzdHJ1Y3Qg
aW50ZWxfZHNiICpkc2IpCj4gICAqIGlzIGRvbmUgdGhyb3VnaCBtbWlvIHdyaXRlLgo+ICAgKi8K
PiAgCj4gLXZvaWQgaW50ZWxfZHNiX2luZGV4ZWRfcmVnX3dyaXRlKHN0cnVjdCBpbnRlbF9kc2Ig
KmRzYiwgaTkxNV9yZWdfdCByZWcsCj4gLQkJCQkgdTMyIHZhbCkKPiArdm9pZCBpbnRlbF9kc2Jf
aW5kZXhlZF9yZWdfd3JpdGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUsCj4gKwkJCQkgaTkxNV9yZWdfdCByZWcsIHUzMiB2YWwpCj4gIHsKPiAtCXN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjID0gY29udGFpbmVyX29mKGRzYiwgdHlwZW9mKCpjcnRjKSwgZHNiKTsKPiAr
CXN0cnVjdCBpbnRlbF9kc2IgKmRzYiA9IGNydGNfc3RhdGUtPmRzYjsKPiArCXN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRl
dik7Cj4gLQl1MzIgKmJ1ZiA9IGRzYi0+Y21kX2J1ZjsKPiArCXUzMiAqYnVmOwo+ICAJdTMyIHJl
Z192YWw7Cj4gIAo+IC0JaWYgKCFidWYpIHsKPiArCWlmICghZHNiKSB7Cj4gIAkJaW50ZWxfZGVf
d3JpdGUoZGV2X3ByaXYsIHJlZywgdmFsKTsKPiAgCQlyZXR1cm47Cj4gIAl9Cj4gLQo+ICsJYnVm
ID0gZHNiLT5jbWRfYnVmOwo+ICAJaWYgKGRybV9XQVJOX09OKCZkZXZfcHJpdi0+ZHJtLCBkc2It
PmZyZWVfcG9zID49IERTQl9CVUZfU0laRSkpIHsKPiAgCQlkcm1fZGJnX2ttcygmZGV2X3ByaXYt
PmRybSwgIkRTQiBidWZmZXIgb3ZlcmZsb3dcbiIpOwo+ICAJCXJldHVybjsKPiBAQCAtMjU2LDcg
KzE1Nyw3IEBAIHZvaWQgaW50ZWxfZHNiX2luZGV4ZWRfcmVnX3dyaXRlKHN0cnVjdCBpbnRlbF9k
c2IgKmRzYiwgaTkxNV9yZWdfdCByZWcsCj4gIC8qKgo+ICAgKiBpbnRlbF9kc2JfcmVnX3dyaXRl
KCkgLVdyaXRlIHRvIHRoZSBEU0IgY29udGV4dCBmb3Igbm9ybWFsCj4gICAqIHJlZ2lzdGVyLgo+
IC0gKiBAZHNiOiBpbnRlbF9kc2Igc3RydWN0dXJlLgo+ICsgKiBAY3J0Y19zdGF0ZTogaW50ZWxf
Y3J0Y19zdGF0ZSBzdHJ1Y3R1cmUKPiAgICogQHJlZzogcmVnaXN0ZXIgYWRkcmVzcy4KPiAgICog
QHZhbDogdmFsdWUuCj4gICAqCj4gQEAgLTI2NSwxNyArMTY2LDE5IEBAIHZvaWQgaW50ZWxfZHNi
X2luZGV4ZWRfcmVnX3dyaXRlKHN0cnVjdCBpbnRlbF9kc2IgKmRzYiwgaTkxNV9yZWdfdCByZWcs
Cj4gICAqIGFuZCByZXN0IGFsbCBlcnJvbmVvdXMgY29uZGl0aW9uIHJlZ2lzdGVyIHByb2dyYW1t
aW5nIGlzIGRvbmUKPiAgICogdGhyb3VnaCBtbWlvIHdyaXRlLgo+ICAgKi8KPiAtdm9pZCBpbnRl
bF9kc2JfcmVnX3dyaXRlKHN0cnVjdCBpbnRlbF9kc2IgKmRzYiwgaTkxNV9yZWdfdCByZWcsIHUz
MiB2YWwpCj4gK3ZvaWQgaW50ZWxfZHNiX3JlZ193cml0ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiArCQkJIGk5MTVfcmVnX3QgcmVnLCB1MzIgdmFsKQo+ICB7
Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IGNvbnRhaW5lcl9vZihkc2IsIHR5cGVvZigq
Y3J0YyksIGRzYik7Cj4gKwlzdHJ1Y3QgaW50ZWxfZHNiICpkc2IgPSBjcnRjX3N0YXRlLT5kc2I7
Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+
dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAJdTMyICpidWYgPSBkc2ItPmNtZF9idWY7Cj4gIAo+IC0J
aWYgKCFidWYpIHsKPiArCWlmICghZHNiKSB7Cj4gIAkJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYs
IHJlZywgdmFsKTsKPiAgCQlyZXR1cm47Cj4gIAl9Cj4gLQo+ICsJYnVmID0gZHNiLT5jbWRfYnVm
Owo+ICAJaWYgKGRybV9XQVJOX09OKCZkZXZfcHJpdi0+ZHJtLCBkc2ItPmZyZWVfcG9zID49IERT
Ql9CVUZfU0laRSkpIHsKPiAgCQlkcm1fZGJnX2ttcygmZGV2X3ByaXYtPmRybSwgIkRTQiBidWZm
ZXIgb3ZlcmZsb3dcbiIpOwo+ICAJCXJldHVybjsKPiBAQCAtMjkwLDI2ICsxOTMsMjcgQEAgdm9p
ZCBpbnRlbF9kc2JfcmVnX3dyaXRlKHN0cnVjdCBpbnRlbF9kc2IgKmRzYiwgaTkxNV9yZWdfdCBy
ZWcsIHUzMiB2YWwpCj4gIAo+ICAvKioKPiAgICogaW50ZWxfZHNiX2NvbW1pdCgpIC0gVHJpZ2dl
ciB3b3JrbG9hZCBleGVjdXRpb24gb2YgRFNCLgo+IC0gKiBAZHNiOiBpbnRlbF9kc2Igc3RydWN0
dXJlLgo+ICsgKiBAY3J0Y19zdGF0ZTogaW50ZWxfY3J0Y19zdGF0ZSBzdHJ1Y3R1cmUKPiAgICoK
PiAgICogVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIGRvIGFjdHVhbCB3cml0ZSB0byBoYXJkd2Fy
ZSB1c2luZyBEU0IuCj4gICAqIE9uIGVycm9ycywgZmFsbCBiYWNrIHRvIE1NSU8uIEFsc28gdGhp
cyBmdW5jdGlvbiBoZWxwIHRvIHJlc2V0IHRoZSBjb250ZXh0Lgo+ICAgKi8KPiAtdm9pZCBpbnRl
bF9kc2JfY29tbWl0KHN0cnVjdCBpbnRlbF9kc2IgKmRzYikKPiArdm9pZCBpbnRlbF9kc2JfY29t
bWl0KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gLQlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IGNvbnRhaW5lcl9vZihkc2IsIHR5cGVvZigqY3J0Yyks
IGRzYik7Cj4gKwlzdHJ1Y3QgaW50ZWxfZHNiICpkc2IgPSBjcnRjX3N0YXRlLT5kc2I7Cj4gKwlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5j
cnRjKTsKPiAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5iYXNlLmRldjsKPiAgCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiAgCWVudW0g
cGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCXUzMiB0YWlsOwo+ICAKPiAtCWlmICghZHNiLT5m
cmVlX3BvcykKPiArCWlmICghKGRzYiB8fCBkc2ItPmZyZWVfcG9zKSkKPiAgCQlyZXR1cm47Cj4g
IAo+IC0JaWYgKCFpbnRlbF9kc2JfZW5hYmxlX2VuZ2luZShkc2IpKQo+ICsJaWYgKCFpbnRlbF9k
c2JfZW5hYmxlX2VuZ2luZShkZXZfcHJpdiwgcGlwZSwgZHNiLT5pZCkpCj4gIAkJZ290byByZXNl
dDsKPiAgCj4gLQlpZiAoaXNfZHNiX2J1c3koZHNiKSkgewo+ICsJaWYgKGlzX2RzYl9idXN5KGRl
dl9wcml2LCBwaXBlLCBkc2ItPmlkKSkgewo+ICAJCWRybV9lcnIoJmRldl9wcml2LT5kcm0sCj4g
IAkJCSJIRUFEX1BUUiB3cml0ZSBmYWlsZWQgLSBkc2IgZW5naW5lIGlzIGJ1c3kuXG4iKTsKPiAg
CQlnb3RvIHJlc2V0Owo+IEBAIC0zMjIsNyArMjI2LDcgQEAgdm9pZCBpbnRlbF9kc2JfY29tbWl0
KHN0cnVjdCBpbnRlbF9kc2IgKmRzYikKPiAgCQltZW1zZXQoJmRzYi0+Y21kX2J1Zltkc2ItPmZy
ZWVfcG9zXSwgMCwKPiAgCQkgICAgICAgKHRhaWwgLSBkc2ItPmZyZWVfcG9zICogNCkpOwo+ICAK
PiAtCWlmIChpc19kc2JfYnVzeShkc2IpKSB7Cj4gKwlpZiAoaXNfZHNiX2J1c3koZGV2X3ByaXYs
IHBpcGUsIGRzYi0+aWQpKSB7Cj4gIAkJZHJtX2VycigmZGV2X3ByaXYtPmRybSwKPiAgCQkJIlRB
SUxfUFRSIHdyaXRlIGZhaWxlZCAtIGRzYiBlbmdpbmUgaXMgYnVzeS5cbiIpOwo+ICAJCWdvdG8g
cmVzZXQ7Cj4gQEAgLTMzMiw3ICsyMzYsNyBAQCB2b2lkIGludGVsX2RzYl9jb21taXQoc3RydWN0
IGludGVsX2RzYiAqZHNiKQo+ICAJCSAgICBpOTE1X2dndHRfb2Zmc2V0KGRzYi0+dm1hKSwgdGFp
bCk7Cj4gIAlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgRFNCX1RBSUwocGlwZSwgZHNiLT5pZCks
Cj4gIAkJICAgICAgIGk5MTVfZ2d0dF9vZmZzZXQoZHNiLT52bWEpICsgdGFpbCk7Cj4gLQlpZiAo
d2FpdF9mb3IoIWlzX2RzYl9idXN5KGRzYiksIDEpKSB7Cj4gKwlpZiAod2FpdF9mb3IoIWlzX2Rz
Yl9idXN5KGRldl9wcml2LCBwaXBlLCBkc2ItPmlkKSwgMSkpIHsKPiAgCQlkcm1fZXJyKCZkZXZf
cHJpdi0+ZHJtLAo+ICAJCQkiVGltZWQgb3V0IHdhaXRpbmcgZm9yIERTQiB3b3JrbG9hZCBjb21w
bGV0aW9uLlxuIik7Cj4gIAkJZ290byByZXNldDsKPiBAQCAtMzQxLDUgKzI0NSw3OSBAQCB2b2lk
IGludGVsX2RzYl9jb21taXQoc3RydWN0IGludGVsX2RzYiAqZHNiKQo+ICByZXNldDoKPiAgCWRz
Yi0+ZnJlZV9wb3MgPSAwOwo+ICAJZHNiLT5pbnNfc3RhcnRfb2Zmc2V0ID0gMDsKPiAtCWludGVs
X2RzYl9kaXNhYmxlX2VuZ2luZShkc2IpOwo+ICsJaW50ZWxfZHNiX2Rpc2FibGVfZW5naW5lKGRl
dl9wcml2LCBwaXBlLCBkc2ItPmlkKTsKPiArfQo+ICsKPiArLyoqCj4gKyAqIGludGVsX2RzYl9w
cmVwYXJlKCkgLSBBbGxvY2F0ZSwgcGluIGFuZCBtYXAgdGhlIERTQiBjb21tYW5kIGJ1ZmZlci4K
PiArICogQGNydGNfc3RhdGU6IGludGVsX2NydGNfc3RhdGUgc3RydWN0dXJlIHRvIHByZXBhcmUg
YXNzb2NpYXRlZCBkc2IgaW5zdGFuY2UuCj4gKyAqCj4gKyAqIFRoaXMgZnVuY3Rpb24gcHJlcGFy
ZSB0aGUgY29tbWFuZCBidWZmZXIgd2hpY2ggaXMgdXNlZCB0byBzdG9yZSBkc2IKPiArICogaW5z
dHJ1Y3Rpb25zIHdpdGggZGF0YS4KPiArICovCj4gK3ZvaWQgaW50ZWxfZHNiX3ByZXBhcmUoc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gK3sKPiArCXN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAr
CXN0cnVjdCBpbnRlbF9kc2IgKmRzYjsKPiArCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpv
Ymo7Cj4gKwlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKPiArCXUzMiAqYnVmOwo+ICsJaW50ZWxfd2Fr
ZXJlZl90IHdha2VyZWY7Cj4gKwo+ICsJaWYgKCFIQVNfRFNCKGk5MTUpKQo+ICsJCXJldHVybjsK
PiArCj4gKwlkc2IgPSBrbWFsbG9jKHNpemVvZigqZHNiKSwgR0ZQX0tFUk5FTCk7Cj4gKwo+ICsJ
d2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKPiArCj4g
KwlvYmogPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX2ludGVybmFsKGk5MTUsIERTQl9CVUZfU0la
RSk7Cj4gKwlpZiAoSVNfRVJSKG9iaikpIHsKPiArCQlkcm1fZXJyKCZpOTE1LT5kcm0sICJHZW0g
b2JqZWN0IGNyZWF0aW9uIGZhaWxlZFxuIik7Cj4gKwkJa2ZyZWUoZHNiKTsKPiArCQlnb3RvIG91
dDsKPiArCX0KPiArCj4gKwl2bWEgPSBpOTE1X2dlbV9vYmplY3RfZ2d0dF9waW4ob2JqLCBOVUxM
LCAwLCAwLCAwKTsKPiArCWlmIChJU19FUlIodm1hKSkgewo+ICsJCWRybV9lcnIoJmk5MTUtPmRy
bSwgIlZtYSBjcmVhdGlvbiBmYWlsZWRcbiIpOwo+ICsJCWk5MTVfZ2VtX29iamVjdF9wdXQob2Jq
KTsKPiArCQlrZnJlZShkc2IpOwo+ICsJCWdvdG8gb3V0Owo+ICsJfQo+ICsKPiArCWJ1ZiA9IGk5
MTVfZ2VtX29iamVjdF9waW5fbWFwKHZtYS0+b2JqLCBJOTE1X01BUF9XQyk7Cj4gKwlpZiAoSVNf
RVJSKGJ1ZikpIHsKPiArCQlkcm1fZXJyKCZpOTE1LT5kcm0sICJDb21tYW5kIGJ1ZmZlciBjcmVh
dGlvbiBmYWlsZWRcbiIpOwo+ICsJCWk5MTVfdm1hX3VucGluX2FuZF9yZWxlYXNlKCZ2bWEsIEk5
MTVfVk1BX1JFTEVBU0VfTUFQKTsKPiArCQlrZnJlZShkc2IpOwo+ICsJCWdvdG8gb3V0Owo+ICsJ
fQo+ICsKPiArCWRzYi0+aWQgPSBEU0IxOwo+ICsJZHNiLT52bWEgPSB2bWE7Cj4gKwlkc2ItPmNt
ZF9idWYgPSBidWY7Cj4gKwlkc2ItPmZyZWVfcG9zID0gMDsKPiArCWRzYi0+aW5zX3N0YXJ0X29m
ZnNldCA9IDA7Cj4gKwljcnRjX3N0YXRlLT5kc2IgPSBkc2I7Cj4gK291dDoKPiArCWludGVsX3J1
bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKPiArfQo+ICsKPiArLyoq
Cj4gKyAqIGludGVsX2RzYl9jbGVhbnVwKCkgLSBUbyBjbGVhbnVwIERTQiBjb250ZXh0Lgo+ICsg
KiBAY3J0Y19zdGF0ZTogaW50ZWxfY3J0Y19zdGF0ZSBzdHJ1Y3R1cmUgdG8gY2xlYW51cCBhc3Nv
Y2lhdGVkIGRzYiBpbnN0YW5jZS4KPiArICoKPiArICogVGhpcyBmdW5jdGlvbiBjbGVhbnVwIHRo
ZSBEU0IgY29udGV4dCBieSB1bnBpbm5pbmcgYW5kIHJlbGVhc2luZwo+ICsgKiB0aGUgVk1BIG9i
amVjdCBhc3NvY2lhdGVkIHdpdGggaXQuCj4gKyAqLwo+ICt2b2lkIGludGVsX2RzYl9jbGVhbnVw
KHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICt7Cj4gKwlpZiAoIWNydGNf
c3RhdGUtPmRzYikKPiArCQlyZXR1cm47Cj4gKwo+ICsJaTkxNV92bWFfdW5waW5fYW5kX3JlbGVh
c2UoJmNydGNfc3RhdGUtPmRzYi0+dm1hLCBJOTE1X1ZNQV9SRUxFQVNFX01BUCk7Cj4gKwlrZnJl
ZShjcnRjX3N0YXRlLT5kc2IpOwo+ICsJY3J0Y19zdGF0ZS0+ZHNiID0gTlVMTDsKPiAgfQo+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RzYi5oIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kc2IuaAo+IGluZGV4IDM5NWVmOWNlNTU4
ZS4uNjU0YTExZjI0YjgwIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfZHNiLmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2RzYi5oCj4gQEAgLTEwLDcgKzEwLDcgQEAKPiAgCj4gICNpbmNsdWRlICJpOTE1X3JlZy5oIgo+
ICAKPiAtc3RydWN0IGludGVsX2NydGM7Cj4gK3N0cnVjdCBpbnRlbF9jcnRjX3N0YXRlOwo+ICBz
dHJ1Y3QgaTkxNV92bWE7Cj4gIAo+ICBlbnVtIGRzYl9pZCB7Cj4gQEAgLTIyLDcgKzIyLDYgQEAg
ZW51bSBkc2JfaWQgewo+ICB9Owo+ICAKPiAgc3RydWN0IGludGVsX2RzYiB7Cj4gLQlsb25nIHJl
ZmNvdW50Owo+ICAJZW51bSBkc2JfaWQgaWQ7Cj4gIAl1MzIgKmNtZF9idWY7Cj4gIAlzdHJ1Y3Qg
aTkxNV92bWEgKnZtYTsKPiBAQCAtNDEsMTIgKzQwLDEyIEBAIHN0cnVjdCBpbnRlbF9kc2Igewo+
ICAJdTMyIGluc19zdGFydF9vZmZzZXQ7Cj4gIH07Cj4gIAo+IC1zdHJ1Y3QgaW50ZWxfZHNiICoK
PiAtaW50ZWxfZHNiX2dldChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0Yyk7Cj4gLXZvaWQgaW50ZWxf
ZHNiX3B1dChzdHJ1Y3QgaW50ZWxfZHNiICpkc2IpOwo+IC12b2lkIGludGVsX2RzYl9yZWdfd3Jp
dGUoc3RydWN0IGludGVsX2RzYiAqZHNiLCBpOTE1X3JlZ190IHJlZywgdTMyIHZhbCk7Cj4gLXZv
aWQgaW50ZWxfZHNiX2luZGV4ZWRfcmVnX3dyaXRlKHN0cnVjdCBpbnRlbF9kc2IgKmRzYiwgaTkx
NV9yZWdfdCByZWcsCj4gLQkJCQkgdTMyIHZhbCk7Cj4gLXZvaWQgaW50ZWxfZHNiX2NvbW1pdChz
dHJ1Y3QgaW50ZWxfZHNiICpkc2IpOwo+ICt2b2lkIGludGVsX2RzYl9wcmVwYXJlKHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKTsKPiArdm9pZCBpbnRlbF9kc2JfY2xlYW51cChz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7Cj4gK3ZvaWQgaW50ZWxfZHNiX3Jl
Z193cml0ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiArCQkJ
IGk5MTVfcmVnX3QgcmVnLCB1MzIgdmFsKTsKPiArdm9pZCBpbnRlbF9kc2JfaW5kZXhlZF9yZWdf
d3JpdGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gKwkJCQkg
aTkxNV9yZWdfdCByZWcsIHUzMiB2YWwpOwo+ICt2b2lkIGludGVsX2RzYl9jb21taXQoY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpOwo+ICAKPiAgI2VuZGlmCgpSZXZp
ZXdlZC1ieTogTWFhcnRlbiBMYW5raG9yc3QgPG1hYXJ0ZW4ubGFua2hvcnN0QGludGVsLmNvbT4K
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdm
eCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xp
c3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeAo=

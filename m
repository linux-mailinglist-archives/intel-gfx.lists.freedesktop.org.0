Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id BA8A1FB1DB
	for <lists+intel-gfx@lfdr.de>; Wed, 13 Nov 2019 14:55:57 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D57F56ED17;
	Wed, 13 Nov 2019 13:55:55 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6DCBA6ED15;
 Wed, 13 Nov 2019 13:55:53 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19187912-1500050 
 for multiple; Wed, 13 Nov 2019 13:55:06 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 13 Nov 2019 13:55:05 +0000
Message-Id: <20191113135505.11426-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t] i915/gem_create: Check for cache bypass
 around zeroed pages
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: igt-dev@lists.freedesktop.org, Matthew Auld <matthew.auld@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Q2hlY2sgdGhhdCBldmVuIGlmIHVzZXJzcGFjZSB0cmllcyB0byBzbmVhayBhcm91bmQgdGhlIENQ
VSBjYWNoZXMgb2YgaXRzCnplcm9lZCBwYWdlcywgaXQgc2VlcyBub3RoaW5nIGJ1dCB6ZXJvZXMu
CgpTdWdnZXN0ZWQtYnk6IEpvb25hcyBMYWh0aW5lbiA8am9vbmFzLmxhaHRpbmVuQGxpbnV4Lmlu
dGVsLmNvbT4KU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24u
Y28udWs+CkNjOiBKb29uYXMgTGFodGluZW4gPGpvb25hcy5sYWh0aW5lbkBsaW51eC5pbnRlbC5j
b20+CkNjOiBNYXR0aGV3IEF1bGQgPG1hdHRoZXcuYXVsZEBpbnRlbC5jb20+Ci0tLQogdGVzdHMv
aTkxNS9nZW1fY3JlYXRlLmMgfCA0NSArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
Ky0tLS0tLQogMSBmaWxlIGNoYW5nZWQsIDM5IGluc2VydGlvbnMoKyksIDYgZGVsZXRpb25zKC0p
CgpkaWZmIC0tZ2l0IGEvdGVzdHMvaTkxNS9nZW1fY3JlYXRlLmMgYi90ZXN0cy9pOTE1L2dlbV9j
cmVhdGUuYwppbmRleCBhZWQ3ZDFjZWMuLjlmN2E0NTAyNSAxMDA2NDQKLS0tIGEvdGVzdHMvaTkx
NS9nZW1fY3JlYXRlLmMKKysrIGIvdGVzdHMvaTkxNS9nZW1fY3JlYXRlLmMKQEAgLTU1LDggKzU1
LDEwIEBACiAjaW5jbHVkZSAiaW50ZWxfaW8uaCIKICNpbmNsdWRlICJpbnRlbF9jaGlwc2V0Lmgi
CiAjaW5jbHVkZSAiaWd0X2F1eC5oIgorI2luY2x1ZGUgImlndF94ODYuaCIKICNpbmNsdWRlICJk
cm10ZXN0LmgiCiAjaW5jbHVkZSAiZHJtLmgiCisjaW5jbHVkZSAiaTkxNS9nZW1fbW1hbi5oIgog
I2luY2x1ZGUgImk5MTVfZHJtLmgiCiAKIElHVF9URVNUX0RFU0NSSVBUSU9OKCJUaGlzIGlzIGEg
dGVzdCBmb3IgdGhlIGV4dGVuZGVkICYgb2xkIGdlbV9jcmVhdGUgaW9jdGwsIgpAQCAtMTg4LDEx
ICsxOTAsMTMgQEAgc3RhdGljIHZvaWQgKnRocmVhZF9jbGVhcih2b2lkICpkYXRhKQogewogCXN0
cnVjdCB0aHJlYWRfY2xlYXIgKmFyZyA9IGRhdGE7CiAJdW5zaWduZWQgbG9uZyBjaGVja2VkID0g
MDsKKwllbnVtIHsgUFJXLCBHVFQsIFdDLCBTVFJFQU0sIF9fTEFTVF9fIH0gbW9kZSA9IFBSVzsK
IAlpbnQgaTkxNSA9IGFyZy0+aTkxNTsKIAogCWlndF91bnRpbF90aW1lb3V0KGFyZy0+dGltZW91
dCkgewogCQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2NyZWF0ZSBjcmVhdGUgPSB7fTsKIAkJdWludDY0
X3QgbnBhZ2VzOworCQl2b2lkICpwdHIgPSBOVUxMOwogCiAJCW5wYWdlcyA9IHJhbmRvbSgpOwog
CQlucGFnZXMgPDw9IDMyOwpAQCAtMjAxLDE4ICsyMDUsNDcgQEAgc3RhdGljIHZvaWQgKnRocmVh
ZF9jbGVhcih2b2lkICpkYXRhKQogCQljcmVhdGUuc2l6ZSA9IG5wYWdlcyA8PCAxMjsKIAogCQlj
cmVhdGVfaW9jdGwoaTkxNSwgJmNyZWF0ZSk7Ci0JCWZvciAodWludDY0X3QgcGFnZSA9IDA7IHBh
Z2UgPCBucGFnZXM7IHBhZ2UrKykgewotCQkJdWludDY0X3QgeDsKKwkJc3dpdGNoIChtb2RlKSB7
CisJCWNhc2UgX19MQVNUX186CisJCWNhc2UgUFJXOgorCQkJYnJlYWs7CisJCWNhc2UgV0M6CisJ
CWNhc2UgU1RSRUFNOgorCQkJcHRyID0gX19nZW1fbW1hcF9fd2MoaTkxNSwgY3JlYXRlLmhhbmRs
ZSwKKwkJCQkJICAgICAwLCBjcmVhdGUuc2l6ZSwgUFJPVF9SRUFEKTsKKwkJCWJyZWFrOworCQlj
YXNlIEdUVDoKKwkJCXB0ciA9IF9fZ2VtX21tYXBfX2d0dChpOTE1LCBjcmVhdGUuaGFuZGxlLAor
CQkJCQkgICAgICBjcmVhdGUuc2l6ZSwgUFJPVF9SRUFEKTsKKwkJCWJyZWFrOworCQl9CisJCS8q
IE5vIHNldC1kb21haW5zIGFzIHdlIGFyZSBiZWluZyBhcyBuYXVnaHR5IGFzIHBvc3NpYmxlICov
CiAKLQkJCWdlbV9yZWFkKGk5MTUsIGNyZWF0ZS5oYW5kbGUsCi0JCQkJIHBhZ2UgKiA0MDk2ICsg
KHBhZ2UgJSAoNDA5NiAtIHNpemVvZih4KSkpLAotCQkJCSAmeCwgc2l6ZW9mKHgpKTsKLQkJCWln
dF9hc3NlcnRfZXFfdTY0KHgsIDApOworCQlmb3IgKHVpbnQ2NF90IHBhZ2UgPSAwOyBwYWdlIDwg
bnBhZ2VzOyBwYWdlKyspIHsKKwkJCXVpbnQ2NF90IHhbOF0gPSB7CisJCQkJcGFnZSAqIDQwOTYg
KworCQkJCXNpemVvZih4KSAqICgocGFnZSAlICg0MDk2IC0gc2l6ZW9mKHgpKSAvIHNpemVvZih4
KSkpCisJCQl9OworCisJCQlpZiAoIXB0cikKKwkJCQlnZW1fcmVhZChpOTE1LCBjcmVhdGUuaGFu
ZGxlLCB4WzBdLCB4LCBzaXplb2YoeCkpOworCQkJZWxzZSBpZiAobW9kZSA9PSBTVFJFQU0pCisJ
CQkJaWd0X21lbWNweV9mcm9tX3djKHgsIHB0ciArIHhbMF0sIHNpemVvZih4KSk7CisJCQllbHNl
CisJCQkJbWVtY3B5KHgsIHB0ciArIHhbMF0sIHNpemVvZih4KSk7CisKKwkJCWZvciAoaW50IGkg
PSAwOyBpIDwgQVJSQVlfU0laRSh4KTsgaSsrKQorCQkJCWlndF9hc3NlcnRfZXFfdTY0KHhbaV0s
IDApOwogCQl9CisJCWlmIChwdHIpCisJCQltdW5tYXAocHRyLCBjcmVhdGUuc2l6ZSk7CiAJCWdl
bV9jbG9zZShpOTE1LCBjcmVhdGUuaGFuZGxlKTsKIAkJY2hlY2tlZCArPSBucGFnZXM7CiAKIAkJ
YXRvbWljX2ZldGNoX2FkZCgmYXJnLT5tYXgsIG5wYWdlcyk7CisKKwkJaWYgKCsrbW9kZSA9PSBf
X0xBU1RfXykKKwkJCW1vZGUgPSBQUlc7CiAJfQogCiAJcmV0dXJuICh2b2lkICopKHVpbnRwdHJf
dCljaGVja2VkOwotLSAKMi4yNC4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVl
ZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5m
by9pbnRlbC1nZng=

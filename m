Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 45BF276123
	for <lists+intel-gfx@lfdr.de>; Fri, 26 Jul 2019 10:46:35 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 96D396E8AD;
	Fri, 26 Jul 2019 08:46:32 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id DCA236E8A9
 for <intel-gfx@lists.freedesktop.org>; Fri, 26 Jul 2019 08:46:30 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17621077-1500050 
 for multiple; Fri, 26 Jul 2019 09:46:15 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 26 Jul 2019 09:45:50 +0100
Message-Id: <20190726084613.22129-4-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20190726084613.22129-1-chris@chris-wilson.co.uk>
References: <20190726084613.22129-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 04/27] drm/i915: Replace hangcheck by heartbeats
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UmVwbGFjZSBzYW1wbGluZyB0aGUgZW5naW5lIHN0YXRlIGV2ZXJ5IHNvIG9mdGVuIHdpdGggYSBw
ZXJpb2RpYwpoZWFydGJlYXQgcmVxdWVzdCB0byBtZWFzdXJlIHRoZSBoZWFsdGggb2YgYW4gZW5n
aW5lLiBUaGlzIGlzIGNvdXBsZWQKd2l0aCB0aGUgZm9yY2VkLXByZWVtcHRpb24gdG8gYWxsb3cg
bG9uZyBydW5uaW5nIHJlcXVlc3RzIHRvIHN1cnZpdmUgc28KbG9uZyBhcyB0aGV5IGRvIG5vdCBi
bG9jayBvdGhlciB1c2Vycy4KClNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hy
aXMtd2lsc29uLmNvLnVrPgpDYzogSm9vbmFzIExhaHRpbmVuIDxqb29uYXMubGFodGluZW5AbGlu
dXguaW50ZWwuY29tPgpDYzogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNv
bT4KQ2M6IEpvbiBCbG9vbWZpZWxkIDxqb24uYmxvb21maWVsZEBpbnRlbC5jb20+Ci0tLQpOb3Rl
LCBzdHJpY3RseSB0aGlzIHN0aWxsIHJlcXVpcmVzIHN0cnVjdF9tdXRleC1mcmVlIHJldGlyZW1l
bnQgZm9yIHRoZQpjb3JuZXIgY2FzZSB3aGVyZSB0aGUgaWRsZS13b3JrZXIgaXMgaW5lZmZlY3Rp
dmUgYW5kIHdlIGdldCBhIGJhY2tsb2cgb2YKcmVxdWVzdHMgb24gdGhlIGtlcm5lbCByaW5nLiBP
ciBpZiB0aGUgbGVnYWN5IHJpbmdidWZmZXIgaXMgZnVsbC4uLgpXaGVuIHdlIGFyZSBhYmxlIHRv
IHJldGlyZSBmcm9tIG91dHNpZGUgb2Ygc3RydWN0X211dGV4IHdlIGNhbiBkbyB0aGUKZnVsbCBp
ZGxlLWJhcnJpZXIgYW5kIGlkbGUtd29yayBmcm9tIGhlcmUuCi0tLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvS2NvbmZpZy5wcm9maWxlICAgICAgICAgIHwgIDExICsKIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L01ha2VmaWxlICAgICAgICAgICAgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX3BtLmMgICAgICAgIHwgICAyIC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2VuZ2luZS5oICAgICAgICB8ICAzMiAtLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZW5naW5lX2NzLmMgICAgIHwgIDEwICstCiAuLi4vZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2VuZ2luZV9oZWFydGJlYXQuYyAgfCAgOTkgKysrKysKIC4uLi9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfZW5naW5lX2hlYXJ0YmVhdC5oICB8ICAxNyArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9lbmdpbmVfcG0uYyAgICAgfCAgIDUgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2VuZ2luZV90eXBlcy5oICB8ICAxNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfZ3QuYyAgICAgICAgICAgIHwgICAxIC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2d0LmggICAgICAgICAgICB8ICAgNCAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9ndF9wbS5jICAgICAgICAgfCAgIDIgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
Z3RfdHlwZXMuaCAgICAgIHwgICA5IC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2hh
bmdjaGVjay5jICAgICB8IDM2MCAtLS0tLS0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX3Jlc2V0LmMgICAgICAgICB8ICAgMyArLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Qvc2VsZnRlc3RfaGFuZ2NoZWNrLmMgIHwgICA0IC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZGVidWdmcy5jICAgICAgICAgICB8ICA4NiAtLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9kcnYuYyAgICAgICAgICAgICAgIHwgICA2ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2Rydi5oICAgICAgICAgICAgICAgfCAgIDEgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9ncHVfZXJyb3IuYyAgICAgICAgIHwgIDM3ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2dwdV9lcnJvci5oICAgICAgICAgfCAgIDIgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9wYXJhbXMuYyAgICAgICAgICAgIHwgICA1IC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
cGFyYW1zLmggICAgICAgICAgICB8ICAgMSAtCiAyMyBmaWxlcyBjaGFuZ2VkLCAxNTEgaW5zZXJ0
aW9ucygrKSwgNTYyIGRlbGV0aW9ucygtKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQuYwogY3JlYXRlIG1vZGUgMTAwNjQ0
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQuaAogZGVsZXRl
IG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2hhbmdjaGVjay5jCgpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvS2NvbmZpZy5wcm9maWxlIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvS2NvbmZpZy5wcm9maWxlCmluZGV4IDMxODRlODQ5MTMzMy4uYWFmYjU3
Zjg0MTY5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9LY29uZmlnLnByb2ZpbGUK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvS2NvbmZpZy5wcm9maWxlCkBAIC0zNywzICszNywx
NCBAQCBjb25maWcgRFJNX0k5MTVfUFJFRU1QVF9USU1FT1VUCiAJICB0byBleGVjdXRlLgogCiAJ
ICBNYXkgYmUgMCB0byBkaXNhYmxlIHRoZSB0aW1lb3V0LgorCitjb25maWcgRFJNX0k5MTVfSEVB
UlRCRUFUX0lOVEVSVkFMCisJaW50ICJJbnRlcnZhbCBiZXR3ZWVuIGhlYXJ0YmVhdCBwdWxzZXMg
KG1zKSIKKwlkZWZhdWx0IDI1MDAgIyBtaWNyb3NlY29uZHMKKwloZWxwCisJICBXaGlsZSBhY3Rp
dmUgdGhlIGRyaXZlciB1c2VzIGEgcGVyaW9kaWMgcmVxdWVzdCwgYSBoZWFydGJlYXQsIHRvCisJ
ICBjaGVjayB0aGUgd2VsbG5lc3Mgb2YgdGhlIEdQVSBhbmQgdG8gcmVndWxhcmx5IGZsdXNoIHN0
YXRlIGNoYW5nZXMKKwkgIChpZGxlIGJhcnJpZXJzKS4KKworCSAgTWF5IGJlIDAgdG8gZGlzYWJs
ZSBoZWFydGJlYXRzIGFuZCB0aGVyZWZvcmUgZGlzYWJsZSBhdXRvbWF0aWMgR1BVCisJICBoYW5n
IGRldGVjdGlvbi4KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUKaW5kZXggNTI0NTE2MjUxYTQwLi4xODIwMTg1
MmQ2OGQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCkBAIC03MywxMCArNzMsMTAgQEAgZ3QteSArPSBc
CiAJZ3QvaW50ZWxfYnJlYWRjcnVtYnMubyBcCiAJZ3QvaW50ZWxfY29udGV4dC5vIFwKIAlndC9p
bnRlbF9lbmdpbmVfY3MubyBcCisJZ3QvaW50ZWxfZW5naW5lX2hlYXJ0YmVhdC5vIFwKIAlndC9p
bnRlbF9lbmdpbmVfcG0ubyBcCiAJZ3QvaW50ZWxfZ3QubyBcCiAJZ3QvaW50ZWxfZ3RfcG0ubyBc
Ci0JZ3QvaW50ZWxfaGFuZ2NoZWNrLm8gXAogCWd0L2ludGVsX2xyYy5vIFwKIAlndC9pbnRlbF9y
ZW5kZXJzdGF0ZS5vIFwKIAlndC9pbnRlbF9yZXNldC5vIFwKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX3BtLmMKaW5kZXggYjU1NjFjYmRjNWVhLi5hNWEwYWVmY2MwNGMgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5jCkBAIC0xNzAsOCArMTcwLDYgQEAgdm9pZCBp
OTE1X2dlbV9zdXNwZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCUdFTV9CVUdf
T04oaTkxNS0+Z3QuYXdha2UpOwogCWZsdXNoX3dvcmsoJmk5MTUtPmdlbS5pZGxlX3dvcmspOwog
Ci0JY2FuY2VsX2RlbGF5ZWRfd29ya19zeW5jKCZpOTE1LT5ndC5oYW5nY2hlY2sud29yayk7Ci0K
IAlpOTE1X2dlbV9kcmFpbl9mcmVlZF9vYmplY3RzKGk5MTUpOwogCiAJaW50ZWxfdWNfc3VzcGVu
ZCgmaTkxNS0+Z3QudWMpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZW5naW5lLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaAppbmRl
eCBkYjVjNzNjZTg2ZWUuLjM4ZWViNDMyMGM5NyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfZW5naW5lLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZW5naW5lLmgKQEAgLTkwLDM4ICs5MCw2IEBAIHN0cnVjdCBkcm1fcHJpbnRlcjsKIC8qIHNl
cW5vIHNpemUgaXMgYWN0dWFsbHkgb25seSBhIHVpbnQzMiwgYnV0IHNpbmNlIHdlIHBsYW4gdG8g
dXNlIE1JX0ZMVVNIX0RXIHRvCiAgKiBkbyB0aGUgd3JpdGVzLCBhbmQgdGhhdCBtdXN0IGhhdmUg
cXcgYWxpZ25lZCBvZmZzZXRzLCBzaW1wbHkgcHJldGVuZCBpdCdzIDhiLgogICovCi1lbnVtIGlu
dGVsX2VuZ2luZV9oYW5nY2hlY2tfYWN0aW9uIHsKLQlFTkdJTkVfSURMRSA9IDAsCi0JRU5HSU5F
X1dBSVQsCi0JRU5HSU5FX0FDVElWRV9TRVFOTywKLQlFTkdJTkVfQUNUSVZFX0hFQUQsCi0JRU5H
SU5FX0FDVElWRV9TVUJVTklUUywKLQlFTkdJTkVfV0FJVF9LSUNLLAotCUVOR0lORV9ERUFELAot
fTsKLQotc3RhdGljIGlubGluZSBjb25zdCBjaGFyICoKLWhhbmdjaGVja19hY3Rpb25fdG9fc3Ry
KGNvbnN0IGVudW0gaW50ZWxfZW5naW5lX2hhbmdjaGVja19hY3Rpb24gYSkKLXsKLQlzd2l0Y2gg
KGEpIHsKLQljYXNlIEVOR0lORV9JRExFOgotCQlyZXR1cm4gImlkbGUiOwotCWNhc2UgRU5HSU5F
X1dBSVQ6Ci0JCXJldHVybiAid2FpdCI7Ci0JY2FzZSBFTkdJTkVfQUNUSVZFX1NFUU5POgotCQly
ZXR1cm4gImFjdGl2ZSBzZXFubyI7Ci0JY2FzZSBFTkdJTkVfQUNUSVZFX0hFQUQ6Ci0JCXJldHVy
biAiYWN0aXZlIGhlYWQiOwotCWNhc2UgRU5HSU5FX0FDVElWRV9TVUJVTklUUzoKLQkJcmV0dXJu
ICJhY3RpdmUgc3VidW5pdHMiOwotCWNhc2UgRU5HSU5FX1dBSVRfS0lDSzoKLQkJcmV0dXJuICJ3
YWl0IGtpY2siOwotCWNhc2UgRU5HSU5FX0RFQUQ6Ci0JCXJldHVybiAiZGVhZCI7Ci0JfQotCi0J
cmV0dXJuICJ1bmtub3duIjsKLX0KIAogdm9pZCBpbnRlbF9lbmdpbmVzX3NldF9zY2hlZHVsZXJf
Y2FwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7CiAKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKaW5kZXggNjVjYmYxZDkxMThkLi44OWY0YTM4MjViNzcg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jCkBAIC02MjEsNyAr
NjIxLDYgQEAgc3RhdGljIGludCBpbnRlbF9lbmdpbmVfc2V0dXBfY29tbW9uKHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSkKIAlpbnRlbF9lbmdpbmVfaW5pdF9hY3RpdmUoZW5naW5lLCBF
TkdJTkVfUEhZU0lDQUwpOwogCWludGVsX2VuZ2luZV9pbml0X2JyZWFkY3J1bWJzKGVuZ2luZSk7
CiAJaW50ZWxfZW5naW5lX2luaXRfZXhlY2xpc3RzKGVuZ2luZSk7Ci0JaW50ZWxfZW5naW5lX2lu
aXRfaGFuZ2NoZWNrKGVuZ2luZSk7CiAJaW50ZWxfZW5naW5lX2luaXRfYmF0Y2hfcG9vbChlbmdp
bmUpOwogCWludGVsX2VuZ2luZV9pbml0X2NtZF9wYXJzZXIoZW5naW5lKTsKIAlpbnRlbF9lbmdp
bmVfaW5pdF9fcG0oZW5naW5lKTsKQEAgLTE0NTMsOCArMTQ1MiwxMyBAQCB2b2lkIGludGVsX2Vu
Z2luZV9kdW1wKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAkJZHJtX3ByaW50Ziht
LCAiKioqIFdFREdFRCAqKipcbiIpOwogCiAJZHJtX3ByaW50ZihtLCAiXHRBd2FrZT8gJWRcbiIs
IGF0b21pY19yZWFkKCZlbmdpbmUtPndha2VyZWYuY291bnQpKTsKLQlkcm1fcHJpbnRmKG0sICJc
dEhhbmdjaGVjazogJWQgbXMgYWdvXG4iLAotCQkgICBqaWZmaWVzX3RvX21zZWNzKGppZmZpZXMg
LSBlbmdpbmUtPmhhbmdjaGVjay5hY3Rpb25fdGltZXN0YW1wKSk7CisKKwlyY3VfcmVhZF9sb2Nr
KCk7CisJcnEgPSBSRUFEX09OQ0UoZW5naW5lLT5sYXN0X2hlYXJ0YmVhdCk7CisJaWYgKHJxKQor
CQlkcm1fcHJpbnRmKG0sICJcdEhlYXJ0YmVhdDogJWQgbXMgYWdvXG4iLAorCQkJICAgamlmZmll
c190b19tc2VjcyhqaWZmaWVzIC0gcnEtPmVtaXR0ZWRfamlmZmllcykpOworCXJjdV9yZWFkX3Vu
bG9jaygpOwogCWRybV9wcmludGYobSwgIlx0UmVzZXQgY291bnQ6ICVkIChnbG9iYWwgJWQpXG4i
LAogCQkgICBpOTE1X3Jlc2V0X2VuZ2luZV9jb3VudChlcnJvciwgZW5naW5lKSwKIAkJICAgaTkx
NV9yZXNldF9jb3VudChlcnJvcikpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZW5naW5lX2hlYXJ0YmVhdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZW5naW5lX2hlYXJ0YmVhdC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAw
MDAwMC4uNDIzMzBiMTA3NGU2Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZW5naW5lX2hlYXJ0YmVhdC5jCkBAIC0wLDAgKzEsOTkgQEAKKy8qCisgKiBT
UERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCisgKgorICogQ29weXJpZ2h0IMKpIDIwMTkgSW50
ZWwgQ29ycG9yYXRpb24KKyAqLworCisjaW5jbHVkZSAiaTkxNV9yZXF1ZXN0LmgiCisKKyNpbmNs
dWRlICJpbnRlbF9jb250ZXh0LmgiCisjaW5jbHVkZSAiaW50ZWxfZW5naW5lX2hlYXJ0YmVhdC5o
IgorI2luY2x1ZGUgImludGVsX2VuZ2luZV9wbS5oIgorI2luY2x1ZGUgImludGVsX2d0LmgiCisj
aW5jbHVkZSAiaW50ZWxfcmVzZXQuaCIKKworc3RhdGljIGxvbmcgZGVsYXkodm9pZCkKK3sKKwlj
b25zdCBsb25nIHQgPSBtc2Vjc190b19qaWZmaWVzKENPTkZJR19EUk1fSTkxNV9IRUFSVEJFQVRf
SU5URVJWQUwpOworCisJcmV0dXJuIHJvdW5kX2ppZmZpZXNfdXBfcmVsYXRpdmUodCk7Cit9CisK
K3N0YXRpYyB2b2lkIGhlYXJ0YmVhdChzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndyaykKK3sKKwlzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUgPQorCQljb250YWluZXJfb2Yod3JrLCB0eXBlb2Yo
KmVuZ2luZSksIGhlYXJ0YmVhdC53b3JrKTsKKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UgPSBl
bmdpbmUtPmtlcm5lbF9jb250ZXh0OworCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOworCisJaWYg
KCFpbnRlbF9lbmdpbmVfcG1fZ2V0X2lmX2F3YWtlKGVuZ2luZSkpCisJCXJldHVybjsKKworCXJx
ID0gZW5naW5lLT5sYXN0X2hlYXJ0YmVhdDsKKwlpZiAocnEgJiYgaTkxNV9yZXF1ZXN0X2NvbXBs
ZXRlZChycSkpIHsKKwkJaTkxNV9yZXF1ZXN0X3B1dChycSk7CisJCWVuZ2luZS0+bGFzdF9oZWFy
dGJlYXQgPSBOVUxMOworCX0KKworCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoZW5naW5lLT5ndCkp
CisJCWdvdG8gb3V0OworCisJaWYgKGVuZ2luZS0+bGFzdF9oZWFydGJlYXQpIHsKKwkJaWYgKGVu
Z2luZS0+c2NoZWR1bGUgJiYgcnEtPnNjaGVkLmF0dHIucHJpb3JpdHkgPCBJTlRfTUFYKSB7CisJ
CQlzdHJ1Y3QgaTkxNV9zY2hlZF9hdHRyIGF0dHIgPSB7IC5wcmlvcml0eSA9IElOVF9NQVggfTsK
KworCQkJbG9jYWxfYmhfZGlzYWJsZSgpOworCQkJZW5naW5lLT5zY2hlZHVsZShycSwgJmF0dHIp
OworCQkJbG9jYWxfYmhfZW5hYmxlKCk7CisJCX0gZWxzZSB7CisJCQlpbnRlbF9ndF9oYW5kbGVf
ZXJyb3IoZW5naW5lLT5ndCwgZW5naW5lLT5tYXNrLAorCQkJCQkgICAgICBJOTE1X0VSUk9SX0NB
UFRVUkUsCisJCQkJCSAgICAgICJzdG9wcGVkIGhlYXJ0YmVhdCBvbiAlcyIsCisJCQkJCSAgICAg
IGVuZ2luZS0+bmFtZSk7CisJCX0KKwkJZ290byBvdXQ7CisJfQorCisJaWYgKGVuZ2luZS0+d2Fr
ZXJlZl9zZXJpYWwgPT0gZW5naW5lLT5zZXJpYWwpCisJCWdvdG8gb3V0OworCisJaWYgKGludGVs
X2NvbnRleHRfdGltZWxpbmVfbG9jayhjZSkpCisJCWdvdG8gb3V0OworCisJaW50ZWxfY29udGV4
dF9lbnRlcihjZSk7CisJcnEgPSBfX2k5MTVfcmVxdWVzdF9jcmVhdGUoY2UsIEdGUF9OT1dBSVQg
fCBfX0dGUF9OT1dBUk4pOworCWludGVsX2NvbnRleHRfZXhpdChjZSk7CisJaWYgKElTX0VSUihy
cSkpCisJCWdvdG8gdW5sb2NrOworCisJZW5naW5lLT5sYXN0X2hlYXJ0YmVhdCA9IGk5MTVfcmVx
dWVzdF9nZXQocnEpOworCWVuZ2luZS0+d2FrZXJlZl9zZXJpYWwgPSBlbmdpbmUtPnNlcmlhbCAr
IDE7CisKKwlpOTE1X3JlcXVlc3RfYWRkX2JhcnJpZXJzKHJxKTsKKwlfX2k5MTVfcmVxdWVzdF9j
b21taXQocnEpOworCit1bmxvY2s6CisJaW50ZWxfY29udGV4dF90aW1lbGluZV91bmxvY2soY2Up
Oworb3V0OgorCXNjaGVkdWxlX2RlbGF5ZWRfd29yaygmZW5naW5lLT5oZWFydGJlYXQsIGRlbGF5
KCkpOworCWludGVsX2VuZ2luZV9wbV9wdXQoZW5naW5lKTsKK30KKwordm9pZCBpbnRlbF9lbmdp
bmVfdW5wYXJrX2hlYXJ0YmVhdChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJ
aWYgKCFDT05GSUdfRFJNX0k5MTVfSEVBUlRCRUFUX0lOVEVSVkFMKQorCQlyZXR1cm47CisKKwlz
Y2hlZHVsZV9kZWxheWVkX3dvcmsoJmVuZ2luZS0+aGVhcnRiZWF0LCBkZWxheSgpKTsKK30KKwor
dm9pZCBpbnRlbF9lbmdpbmVfcGFya19oZWFydGJlYXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lKQoreworCWNhbmNlbF9kZWxheWVkX3dvcmtfc3luYygmZW5naW5lLT5oZWFydGJlYXQp
OworCWk5MTVfcmVxdWVzdF9wdXQoZmV0Y2hfYW5kX3plcm8oJmVuZ2luZS0+bGFzdF9oZWFydGJl
YXQpKTsKK30KKwordm9pZCBpbnRlbF9lbmdpbmVfaW5pdF9oZWFydGJlYXQoc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lKQoreworCUlOSVRfREVMQVlFRF9XT1JLKCZlbmdpbmUtPmhlYXJ0
YmVhdCwgaGVhcnRiZWF0KTsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2VuZ2luZV9oZWFydGJlYXQuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2VuZ2luZV9oZWFydGJlYXQuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAw
MDAuLmUwNGY5YzdhYTg1ZAotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQuaApAQCAtMCwwICsxLDE3IEBACisvKgorICogU1BE
WC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAorICoKKyAqIENvcHlyaWdodCDCqSAyMDE5IEludGVs
IENvcnBvcmF0aW9uCisgKi8KKworI2lmbmRlZiBJTlRFTF9FTkdJTkVfSEVBUlRCRUFUX0gKKyNk
ZWZpbmUgSU5URUxfRU5HSU5FX0hFQVJUQkVBVF9ICisKK3N0cnVjdCBpbnRlbF9lbmdpbmVfY3M7
CisKK3ZvaWQgaW50ZWxfZW5naW5lX2luaXRfaGVhcnRiZWF0KHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSk7CisKK3ZvaWQgaW50ZWxfZW5naW5lX3BhcmtfaGVhcnRiZWF0KHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7Cit2b2lkIGludGVsX2VuZ2luZV91bnBhcmtfaGVhcnRi
ZWF0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7CisKKyNlbmRpZiAvKiBJTlRFTF9F
TkdJTkVfSEVBUlRCRUFUX0ggKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2VuZ2luZV9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5l
X3BtLmMKaW5kZXggZTc0ZmJmMDRhNjhkLi42MzQ5YmIwMzhjNzIgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5jCkBAIC03LDYgKzcsNyBAQAogI2luY2x1ZGUgImk5
MTVfZHJ2LmgiCiAKICNpbmNsdWRlICJpbnRlbF9lbmdpbmUuaCIKKyNpbmNsdWRlICJpbnRlbF9l
bmdpbmVfaGVhcnRiZWF0LmgiCiAjaW5jbHVkZSAiaW50ZWxfZW5naW5lX3BtLmgiCiAjaW5jbHVk
ZSAiaW50ZWxfZ3QuaCIKICNpbmNsdWRlICJpbnRlbF9ndF9wbS5oIgpAQCAtMzIsNyArMzMsNyBA
QCBzdGF0aWMgaW50IF9fZW5naW5lX3VucGFyayhzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2YpCiAJ
aWYgKGVuZ2luZS0+dW5wYXJrKQogCQllbmdpbmUtPnVucGFyayhlbmdpbmUpOwogCi0JaW50ZWxf
ZW5naW5lX2luaXRfaGFuZ2NoZWNrKGVuZ2luZSk7CisJaW50ZWxfZW5naW5lX3VucGFya19oZWFy
dGJlYXQoZW5naW5lKTsKIAlyZXR1cm4gMDsKIH0KIApAQCAtMTE1LDYgKzExNiw3IEBAIHN0YXRp
YyBpbnQgX19lbmdpbmVfcGFyayhzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2YpCiAKIAlHRU1fVFJB
Q0UoIiVzXG4iLCBlbmdpbmUtPm5hbWUpOwogCisJaW50ZWxfZW5naW5lX3BhcmtfaGVhcnRiZWF0
KGVuZ2luZSk7CiAJaW50ZWxfZW5naW5lX2Rpc2FybV9icmVhZGNydW1icyhlbmdpbmUpOwogCiAJ
LyogTXVzdCBiZSByZXNldCB1cG9uIGlkbGluZywgb3Igd2UgbWF5IG1pc3MgdGhlIGJ1c3kgd2Fr
ZXVwLiAqLwpAQCAtMTQyLDQgKzE0NCw1IEBAIHZvaWQgaW50ZWxfZW5naW5lX3BtX3B1dChzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB2b2lkIGludGVsX2VuZ2luZV9pbml0X19wbShz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7CiAJaW50ZWxfd2FrZXJlZl9pbml0KCZl
bmdpbmUtPndha2VyZWYpOworCWludGVsX2VuZ2luZV9pbml0X2hlYXJ0YmVhdChlbmdpbmUpOwog
fQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVz
LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaAppbmRleCA4
YmU2MzAxOWQ3MDcuLjlhM2VhZDU1Njc0MyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfZW5naW5lX3R5cGVzLmgKQEAgLTE0LDYgKzE0LDcgQEAKICNpbmNsdWRlIDxsaW51eC9s
bGlzdC5oPgogI2luY2x1ZGUgPGxpbnV4L3RpbWVyLmg+CiAjaW5jbHVkZSA8bGludXgvdHlwZXMu
aD4KKyNpbmNsdWRlIDxsaW51eC93b3JrcXVldWUuaD4KIAogI2luY2x1ZGUgImk5MTVfZ2VtLmgi
CiAjaW5jbHVkZSAiaTkxNV9nZW1fYmF0Y2hfcG9vbC5oIgpAQCAtNTUsMTQgKzU2LDYgQEAgc3Ry
dWN0IGludGVsX2luc3Rkb25lIHsKIAl1MzIgcm93W0k5MTVfTUFYX1NMSUNFU11bSTkxNV9NQVhf
U1VCU0xJQ0VTXTsKIH07CiAKLXN0cnVjdCBpbnRlbF9lbmdpbmVfaGFuZ2NoZWNrIHsKLQl1NjQg
YWN0aGQ7Ci0JdTMyIGxhc3RfcmluZzsKLQl1MzIgbGFzdF9oZWFkOwotCXVuc2lnbmVkIGxvbmcg
YWN0aW9uX3RpbWVzdGFtcDsKLQlzdHJ1Y3QgaW50ZWxfaW5zdGRvbmUgaW5zdGRvbmU7Ci19Owot
CiBzdHJ1Y3QgaW50ZWxfcmluZyB7CiAJc3RydWN0IGtyZWYgcmVmOwogCXN0cnVjdCBpOTE1X3Zt
YSAqdm1hOwpAQCAtMjk4LDYgKzI5MSw5IEBAIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgewogCXN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpkZWZhdWx0X3N0YXRlOwogCXZvaWQgKnBpbm5lZF9k
ZWZhdWx0X3N0YXRlOwogCisJc3RydWN0IGRlbGF5ZWRfd29yayBoZWFydGJlYXQ7CisJc3RydWN0
IGk5MTVfcmVxdWVzdCAqbGFzdF9oZWFydGJlYXQ7CisKIAkvKiBSYXRoZXIgdGhhbiBoYXZlIGV2
ZXJ5IGNsaWVudCB3YWl0IHVwb24gYWxsIHVzZXIgaW50ZXJydXB0cywKIAkgKiB3aXRoIHRoZSBo
ZXJkIHdha2luZyBhZnRlciBldmVyeSBpbnRlcnJ1cHQgYW5kIGVhY2ggZG9pbmcgdGhlCiAJICog
aGVhdnl3ZWlnaHQgc2Vxbm8gZGFuY2UsIHdlIGRlbGVnYXRlIHRoZSB0YXNrIChvZiBiZWluZyB0
aGUKQEAgLTQzNyw4ICs0MzMsNiBAQCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzIHsKIAkvKiBzdGF0
dXNfbm90aWZpZXI6IGxpc3Qgb2YgY2FsbGJhY2tzIGZvciBjb250ZXh0LXN3aXRjaCBjaGFuZ2Vz
ICovCiAJc3RydWN0IGF0b21pY19ub3RpZmllcl9oZWFkIGNvbnRleHRfc3RhdHVzX25vdGlmaWVy
OwogCi0Jc3RydWN0IGludGVsX2VuZ2luZV9oYW5nY2hlY2sgaGFuZ2NoZWNrOwotCiAjZGVmaW5l
IEk5MTVfRU5HSU5FX05FRURTX0NNRF9QQVJTRVIgQklUKDApCiAjZGVmaW5lIEk5MTVfRU5HSU5F
X1NVUFBPUlRTX1NUQVRTICAgQklUKDEpCiAjZGVmaW5lIEk5MTVfRU5HSU5FX0hBU19QUkVFTVBU
SU9OICAgQklUKDIpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9n
dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuYwppbmRleCBmN2U2OWRiNDAx
OWQuLmZlYWY5MTZjOWFiZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZ3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5jCkBAIC0xOSw3
ICsxOSw2IEBAIHZvaWQgaW50ZWxfZ3RfaW5pdF9lYXJseShzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAogCXNwaW5fbG9ja19pbml0KCZndC0+Y2xv
c2VkX2xvY2spOwogCi0JaW50ZWxfZ3RfaW5pdF9oYW5nY2hlY2soZ3QpOwogCWludGVsX2d0X2lu
aXRfcmVzZXQoZ3QpOwogCWludGVsX2d0X3BtX2luaXRfZWFybHkoZ3QpOwogfQpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuaCBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2d0LmgKaW5kZXggNjQwYmIwNTMxZjViLi41NGQyMjkxM2VkZTMgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmgKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuaApAQCAtMzksOCArMzksNiBAQCB2b2lkIGludGVsX2d0
X2NsZWFyX2Vycm9yX3JlZ2lzdGVycyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAogdm9pZCBpbnRlbF9n
dF9mbHVzaF9nZ3R0X3dyaXRlcyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIHZvaWQgaW50ZWxfZ3Rf
Y2hpcHNldF9mbHVzaChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIAotdm9pZCBpbnRlbF9ndF9pbml0
X2hhbmdjaGVjayhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKLQogaW50IGludGVsX2d0X2luaXRfc2Ny
YXRjaChzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1bnNpZ25lZCBpbnQgc2l6ZSk7CiB2b2lkIGludGVs
X2d0X2Zpbmlfc2NyYXRjaChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIApAQCAtNTUsNiArNTMsNCBA
QCBzdGF0aWMgaW5saW5lIGJvb2wgaW50ZWxfZ3RfaXNfd2VkZ2VkKHN0cnVjdCBpbnRlbF9ndCAq
Z3QpCiAJcmV0dXJuIF9faW50ZWxfcmVzZXRfZmFpbGVkKCZndC0+cmVzZXQpOwogfQogCi12b2lk
IGludGVsX2d0X3F1ZXVlX2hhbmdjaGVjayhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKLQogI2VuZGlm
IC8qIF9fSU5URUxfR1RfSF9fICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9ndF9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYwpp
bmRleCA2NWMwZDBjOWQ1NDMuLmQyMjNiMDdlZTMyNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9ndF9wbS5jCkBAIC00Niw4ICs0Niw2IEBAIHN0YXRpYyBpbnQgaW50ZWxfZ3RfdW5wYXJr
KHN0cnVjdCBpbnRlbF93YWtlcmVmICp3ZikKIAogCWk5MTVfcG11X2d0X3VucGFya2VkKGk5MTUp
OwogCi0JaW50ZWxfZ3RfcXVldWVfaGFuZ2NoZWNrKGd0KTsKLQogCXBtX25vdGlmeShpOTE1LCBJ
TlRFTF9HVF9VTlBBUkspOwogCiAJcmV0dXJuIDA7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9ndF90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZ3RfdHlwZXMuaAppbmRleCAzNGQ0YTg2OGU0ZjEuLjAxMTJiYjk4Y2JmMyAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfdHlwZXMuaAorKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF90eXBlcy5oCkBAIC0yMywxNCArMjMsNiBAQCBzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKIHN0cnVjdCBpOTE1X2dndHQ7CiBzdHJ1Y3QgaW50ZWxfdW5j
b3JlOwogCi1zdHJ1Y3QgaW50ZWxfaGFuZ2NoZWNrIHsKLQkvKiBGb3IgaGFuZ2NoZWNrIHRpbWVy
ICovCi0jZGVmaW5lIERSTV9JOTE1X0hBTkdDSEVDS19QRVJJT0QgMTUwMCAvKiBpbiBtcyAqLwot
I2RlZmluZSBEUk1fSTkxNV9IQU5HQ0hFQ0tfSklGRklFUyBtc2Vjc190b19qaWZmaWVzKERSTV9J
OTE1X0hBTkdDSEVDS19QRVJJT0QpCi0KLQlzdHJ1Y3QgZGVsYXllZF93b3JrIHdvcms7Ci19Owot
CiBzdHJ1Y3QgaW50ZWxfZ3QgewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1OwogCXN0
cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZTsKQEAgLTU0LDcgKzQ2LDYgQEAgc3RydWN0IGludGVs
X2d0IHsKIAlzdHJ1Y3QgbGlzdF9oZWFkIGNsb3NlZF92bWE7CiAJc3BpbmxvY2tfdCBjbG9zZWRf
bG9jazsgLyogZ3VhcmRzIHRoZSBsaXN0IG9mIGNsb3NlZF92bWEgKi8KIAotCXN0cnVjdCBpbnRl
bF9oYW5nY2hlY2sgaGFuZ2NoZWNrOwogCXN0cnVjdCBpbnRlbF9yZXNldCByZXNldDsKIAogCS8q
KgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfaGFuZ2NoZWNrLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5nY2hlY2suYwpkZWxldGVkIGZpbGUg
bW9kZSAxMDA2NDQKaW5kZXggMDVkMDQyY2RlZmUyLi4wMDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfaGFuZ2NoZWNrLmMKKysrIC9kZXYvbnVsbApAQCAtMSwz
NjAgKzAsMCBAQAotLyoKLSAqIENvcHlyaWdodCDCqSAyMDE2IEludGVsIENvcnBvcmF0aW9uCi0g
KgotICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFu
eSBwZXJzb24gb2J0YWluaW5nIGEKLSAqIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2Np
YXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksCi0gKiB0byBkZWFsIGlu
IHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1p
dGF0aW9uCi0gKiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlz
aCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwKLSAqIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUg
U29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZQotICogU29mdHdhcmUg
aXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9u
czoKLSAqCi0gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9u
IG5vdGljZSAoaW5jbHVkaW5nIHRoZSBuZXh0Ci0gKiBwYXJhZ3JhcGgpIHNoYWxsIGJlIGluY2x1
ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlCi0gKiBTb2Z0
d2FyZS4KLSAqCi0gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBX
QVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgotICogSU1QTElFRCwgSU5DTFVESU5HIEJV
VCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksCi0gKiBG
SVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4g
Tk8gRVZFTlQgU0hBTEwKLSAqIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJ
QUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSCi0gKiBMSUFCSUxJVFksIFdIRVRI
RVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORwot
ICogRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhF
IFVTRSBPUiBPVEhFUiBERUFMSU5HUwotICogSU4gVEhFIFNPRlRXQVJFLgotICoKLSAqLwotCi0j
aW5jbHVkZSAiaTkxNV9kcnYuaCIKLSNpbmNsdWRlICJpbnRlbF9lbmdpbmUuaCIKLSNpbmNsdWRl
ICJpbnRlbF9ndC5oIgotI2luY2x1ZGUgImludGVsX3Jlc2V0LmgiCi0KLXN0cnVjdCBoYW5nY2hl
Y2sgewotCXU2NCBhY3RoZDsKLQl1MzIgcmluZzsKLQl1MzIgaGVhZDsKLQllbnVtIGludGVsX2Vu
Z2luZV9oYW5nY2hlY2tfYWN0aW9uIGFjdGlvbjsKLQl1bnNpZ25lZCBsb25nIGFjdGlvbl90aW1l
c3RhbXA7Ci0JaW50IGRlYWRsb2NrOwotCXN0cnVjdCBpbnRlbF9pbnN0ZG9uZSBpbnN0ZG9uZTsK
LQlib29sIHdlZGdlZDoxOwotCWJvb2wgc3RhbGxlZDoxOwotfTsKLQotc3RhdGljIGJvb2wgaW5z
dGRvbmVfdW5jaGFuZ2VkKHUzMiBjdXJyZW50X2luc3Rkb25lLCB1MzIgKm9sZF9pbnN0ZG9uZSkK
LXsKLQl1MzIgdG1wID0gY3VycmVudF9pbnN0ZG9uZSB8ICpvbGRfaW5zdGRvbmU7Ci0JYm9vbCB1
bmNoYW5nZWQ7Ci0KLQl1bmNoYW5nZWQgPSB0bXAgPT0gKm9sZF9pbnN0ZG9uZTsKLQkqb2xkX2lu
c3Rkb25lIHw9IHRtcDsKLQotCXJldHVybiB1bmNoYW5nZWQ7Ci19Ci0KLXN0YXRpYyBib29sIHN1
YnVuaXRzX3N0dWNrKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKLXsKLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBlbmdpbmUtPmk5MTU7Ci0Jc3RydWN0IGludGVs
X2luc3Rkb25lIGluc3Rkb25lOwotCXN0cnVjdCBpbnRlbF9pbnN0ZG9uZSAqYWNjdV9pbnN0ZG9u
ZSA9ICZlbmdpbmUtPmhhbmdjaGVjay5pbnN0ZG9uZTsKLQlib29sIHN0dWNrOwotCWludCBzbGlj
ZTsKLQlpbnQgc3Vic2xpY2U7Ci0KLQlpbnRlbF9lbmdpbmVfZ2V0X2luc3Rkb25lKGVuZ2luZSwg
Jmluc3Rkb25lKTsKLQotCS8qIFRoZXJlIG1pZ2h0IGJlIHVuc3RhYmxlIHN1YnVuaXQgc3RhdGVz
IGV2ZW4gd2hlbgotCSAqIGFjdHVhbCBoZWFkIGlzIG5vdCBtb3ZpbmcuIEZpbHRlciBvdXQgdGhl
IHVuc3RhYmxlIG9uZXMgYnkKLQkgKiBhY2N1bXVsYXRpbmcgdGhlIHVuZG9uZSAtPiBkb25lIHRy
YW5zaXRpb25zIGFuZCBvbmx5Ci0JICogY29uc2lkZXIgdGhvc2UgYXMgcHJvZ3Jlc3MuCi0JICov
Ci0Jc3R1Y2sgPSBpbnN0ZG9uZV91bmNoYW5nZWQoaW5zdGRvbmUuaW5zdGRvbmUsCi0JCQkJICAg
JmFjY3VfaW5zdGRvbmUtPmluc3Rkb25lKTsKLQlzdHVjayAmPSBpbnN0ZG9uZV91bmNoYW5nZWQo
aW5zdGRvbmUuc2xpY2VfY29tbW9uLAotCQkJCSAgICAmYWNjdV9pbnN0ZG9uZS0+c2xpY2VfY29t
bW9uKTsKLQotCWZvcl9lYWNoX2luc3Rkb25lX3NsaWNlX3N1YnNsaWNlKGRldl9wcml2LCBzbGlj
ZSwgc3Vic2xpY2UpIHsKLQkJc3R1Y2sgJj0gaW5zdGRvbmVfdW5jaGFuZ2VkKGluc3Rkb25lLnNh
bXBsZXJbc2xpY2VdW3N1YnNsaWNlXSwKLQkJCQkJICAgICZhY2N1X2luc3Rkb25lLT5zYW1wbGVy
W3NsaWNlXVtzdWJzbGljZV0pOwotCQlzdHVjayAmPSBpbnN0ZG9uZV91bmNoYW5nZWQoaW5zdGRv
bmUucm93W3NsaWNlXVtzdWJzbGljZV0sCi0JCQkJCSAgICAmYWNjdV9pbnN0ZG9uZS0+cm93W3Ns
aWNlXVtzdWJzbGljZV0pOwotCX0KLQotCXJldHVybiBzdHVjazsKLX0KLQotc3RhdGljIGVudW0g
aW50ZWxfZW5naW5lX2hhbmdjaGVja19hY3Rpb24KLWhlYWRfc3R1Y2soc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lLCB1NjQgYWN0aGQpCi17Ci0JaWYgKGFjdGhkICE9IGVuZ2luZS0+aGFu
Z2NoZWNrLmFjdGhkKSB7Ci0KLQkJLyogQ2xlYXIgc3VidW5pdCBzdGF0ZXMgb24gaGVhZCBtb3Zl
bWVudCAqLwotCQltZW1zZXQoJmVuZ2luZS0+aGFuZ2NoZWNrLmluc3Rkb25lLCAwLAotCQkgICAg
ICAgc2l6ZW9mKGVuZ2luZS0+aGFuZ2NoZWNrLmluc3Rkb25lKSk7Ci0KLQkJcmV0dXJuIEVOR0lO
RV9BQ1RJVkVfSEVBRDsKLQl9Ci0KLQlpZiAoIXN1YnVuaXRzX3N0dWNrKGVuZ2luZSkpCi0JCXJl
dHVybiBFTkdJTkVfQUNUSVZFX1NVQlVOSVRTOwotCi0JcmV0dXJuIEVOR0lORV9ERUFEOwotfQot
Ci1zdGF0aWMgZW51bSBpbnRlbF9lbmdpbmVfaGFuZ2NoZWNrX2FjdGlvbgotZW5naW5lX3N0dWNr
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgdTY0IGFjdGhkKQotewotCWVudW0gaW50
ZWxfZW5naW5lX2hhbmdjaGVja19hY3Rpb24gaGE7Ci0JdTMyIHRtcDsKLQotCWhhID0gaGVhZF9z
dHVjayhlbmdpbmUsIGFjdGhkKTsKLQlpZiAoaGEgIT0gRU5HSU5FX0RFQUQpCi0JCXJldHVybiBo
YTsKLQotCWlmIChJU19HRU4oZW5naW5lLT5pOTE1LCAyKSkKLQkJcmV0dXJuIEVOR0lORV9ERUFE
OwotCi0JLyogSXMgdGhlIGNoaXAgaGFuZ2luZyBvbiBhIFdBSVRfRk9SX0VWRU5UPwotCSAqIElm
IHNvIHdlIGNhbiBzaW1wbHkgcG9rZSB0aGUgUkJfV0FJVCBiaXQKLQkgKiBhbmQgYnJlYWsgdGhl
IGhhbmcuIFRoaXMgc2hvdWxkIHdvcmsgb24KLQkgKiBhbGwgYnV0IHRoZSBzZWNvbmQgZ2VuZXJh
dGlvbiBjaGlwc2V0cy4KLQkgKi8KLQl0bXAgPSBFTkdJTkVfUkVBRChlbmdpbmUsIFJJTkdfQ1RM
KTsKLQlpZiAodG1wICYgUklOR19XQUlUKSB7Ci0JCWludGVsX2d0X2hhbmRsZV9lcnJvcihlbmdp
bmUtPmd0LCBlbmdpbmUtPm1hc2ssIDAsCi0JCQkJICAgICAgInN0dWNrIHdhaXQgb24gJXMiLCBl
bmdpbmUtPm5hbWUpOwotCQlFTkdJTkVfV1JJVEUoZW5naW5lLCBSSU5HX0NUTCwgdG1wKTsKLQkJ
cmV0dXJuIEVOR0lORV9XQUlUX0tJQ0s7Ci0JfQotCi0JcmV0dXJuIEVOR0lORV9ERUFEOwotfQot
Ci1zdGF0aWMgdm9pZCBoYW5nY2hlY2tfbG9hZF9zYW1wbGUoc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lLAotCQkJCSAgc3RydWN0IGhhbmdjaGVjayAqaGMpCi17Ci0JaGMtPmFjdGhkID0g
aW50ZWxfZW5naW5lX2dldF9hY3RpdmVfaGVhZChlbmdpbmUpOwotCWhjLT5yaW5nID0gRU5HSU5F
X1JFQUQoZW5naW5lLCBSSU5HX1NUQVJUKTsKLQloYy0+aGVhZCA9IEVOR0lORV9SRUFEKGVuZ2lu
ZSwgUklOR19IRUFEKTsKLX0KLQotc3RhdGljIHZvaWQgaGFuZ2NoZWNrX3N0b3JlX3NhbXBsZShz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCi0JCQkJICAgY29uc3Qgc3RydWN0IGhhbmdj
aGVjayAqaGMpCi17Ci0JZW5naW5lLT5oYW5nY2hlY2suYWN0aGQgPSBoYy0+YWN0aGQ7Ci0JZW5n
aW5lLT5oYW5nY2hlY2subGFzdF9yaW5nID0gaGMtPnJpbmc7Ci0JZW5naW5lLT5oYW5nY2hlY2su
bGFzdF9oZWFkID0gaGMtPmhlYWQ7Ci19Ci0KLXN0YXRpYyBlbnVtIGludGVsX2VuZ2luZV9oYW5n
Y2hlY2tfYWN0aW9uCi1oYW5nY2hlY2tfZ2V0X2FjdGlvbihzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmUsCi0JCSAgICAgY29uc3Qgc3RydWN0IGhhbmdjaGVjayAqaGMpCi17Ci0JaWYgKGlu
dGVsX2VuZ2luZV9pc19pZGxlKGVuZ2luZSkpCi0JCXJldHVybiBFTkdJTkVfSURMRTsKLQotCWlm
IChlbmdpbmUtPmhhbmdjaGVjay5sYXN0X3JpbmcgIT0gaGMtPnJpbmcpCi0JCXJldHVybiBFTkdJ
TkVfQUNUSVZFX1NFUU5POwotCi0JaWYgKGVuZ2luZS0+aGFuZ2NoZWNrLmxhc3RfaGVhZCAhPSBo
Yy0+aGVhZCkKLQkJcmV0dXJuIEVOR0lORV9BQ1RJVkVfU0VRTk87Ci0KLQlyZXR1cm4gZW5naW5l
X3N0dWNrKGVuZ2luZSwgaGMtPmFjdGhkKTsKLX0KLQotc3RhdGljIHZvaWQgaGFuZ2NoZWNrX2Fj
Y3VtdWxhdGVfc2FtcGxlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCQkJc3Ry
dWN0IGhhbmdjaGVjayAqaGMpCi17Ci0JdW5zaWduZWQgbG9uZyB0aW1lb3V0ID0gSTkxNV9FTkdJ
TkVfREVBRF9USU1FT1VUOwotCi0JaGMtPmFjdGlvbiA9IGhhbmdjaGVja19nZXRfYWN0aW9uKGVu
Z2luZSwgaGMpOwotCi0JLyogV2UgYWx3YXlzIGluY3JlbWVudCB0aGUgcHJvZ3Jlc3MKLQkgKiBp
ZiB0aGUgZW5naW5lIGlzIGJ1c3kgYW5kIHN0aWxsIHByb2Nlc3NpbmcKLQkgKiB0aGUgc2FtZSBy
ZXF1ZXN0LCBzbyB0aGF0IG5vIHNpbmdsZSByZXF1ZXN0Ci0JICogY2FuIHJ1biBpbmRlZmluaXRl
bHkgKHN1Y2ggYXMgYSBjaGFpbiBvZgotCSAqIGJhdGNoZXMpLiBUaGUgb25seSB0aW1lIHdlIGRv
IG5vdCBpbmNyZW1lbnQKLQkgKiB0aGUgaGFuZ2NoZWNrIHNjb3JlIG9uIHRoaXMgcmluZywgaWYg
dGhpcwotCSAqIGVuZ2luZSBpcyBpbiBhIGxlZ2l0aW1hdGUgd2FpdCBmb3IgYW5vdGhlcgotCSAq
IGVuZ2luZS4gSW4gdGhhdCBjYXNlIHRoZSB3YWl0aW5nIGVuZ2luZSBpcyBhCi0JICogdmljdGlt
IGFuZCB3ZSB3YW50IHRvIGJlIHN1cmUgd2UgY2F0Y2ggdGhlCi0JICogcmlnaHQgY3VscHJpdC4g
VGhlbiBldmVyeSB0aW1lIHdlIGRvIGtpY2sKLQkgKiB0aGUgcmluZywgbWFrZSBpdCBhcyBhIHBy
b2dyZXNzIGFzIHRoZSBzZXFubwotCSAqIGFkdmFuY2VtZW50IG1pZ2h0IGVuc3VyZSBhbmQgaWYg
bm90LCBpdAotCSAqIHdpbGwgY2F0Y2ggdGhlIGhhbmdpbmcgZW5naW5lLgotCSAqLwotCi0Jc3dp
dGNoIChoYy0+YWN0aW9uKSB7Ci0JY2FzZSBFTkdJTkVfSURMRToKLQljYXNlIEVOR0lORV9BQ1RJ
VkVfU0VRTk86Ci0JCS8qIENsZWFyIGhlYWQgYW5kIHN1YnVuaXQgc3RhdGVzIG9uIHNlcW5vIG1v
dmVtZW50ICovCi0JCWhjLT5hY3RoZCA9IDA7Ci0KLQkJbWVtc2V0KCZlbmdpbmUtPmhhbmdjaGVj
ay5pbnN0ZG9uZSwgMCwKLQkJICAgICAgIHNpemVvZihlbmdpbmUtPmhhbmdjaGVjay5pbnN0ZG9u
ZSkpOwotCi0JCS8qIEludGVudGlvbmFsIGZhbGwgdGhyb3VnaCAqLwotCWNhc2UgRU5HSU5FX1dB
SVRfS0lDSzoKLQljYXNlIEVOR0lORV9XQUlUOgotCQllbmdpbmUtPmhhbmdjaGVjay5hY3Rpb25f
dGltZXN0YW1wID0gamlmZmllczsKLQkJYnJlYWs7Ci0KLQljYXNlIEVOR0lORV9BQ1RJVkVfSEVB
RDoKLQljYXNlIEVOR0lORV9BQ1RJVkVfU1VCVU5JVFM6Ci0JCS8qCi0JCSAqIFNlcW5vIHN0dWNr
IHdpdGggc3RpbGwgYWN0aXZlIGVuZ2luZSBnZXRzIGxlZXdheSwKLQkJICogaW4gaG9wZXMgdGhh
dCBpdCBpcyBqdXN0IGEgbG9uZyBzaGFkZXIuCi0JCSAqLwotCQl0aW1lb3V0ID0gSTkxNV9TRVFO
T19ERUFEX1RJTUVPVVQ7Ci0JCWJyZWFrOwotCi0JY2FzZSBFTkdJTkVfREVBRDoKLQkJYnJlYWs7
Ci0KLQlkZWZhdWx0OgotCQlNSVNTSU5HX0NBU0UoaGMtPmFjdGlvbik7Ci0JfQotCi0JaGMtPnN0
YWxsZWQgPSB0aW1lX2FmdGVyKGppZmZpZXMsCi0JCQkJIGVuZ2luZS0+aGFuZ2NoZWNrLmFjdGlv
bl90aW1lc3RhbXAgKyB0aW1lb3V0KTsKLQloYy0+d2VkZ2VkID0gdGltZV9hZnRlcihqaWZmaWVz
LAotCQkJCSBlbmdpbmUtPmhhbmdjaGVjay5hY3Rpb25fdGltZXN0YW1wICsKLQkJCQkgSTkxNV9F
TkdJTkVfV0VER0VEX1RJTUVPVVQpOwotfQotCi1zdGF0aWMgdm9pZCBoYW5nY2hlY2tfZGVjbGFy
ZV9oYW5nKHN0cnVjdCBpbnRlbF9ndCAqZ3QsCi0JCQkJICAgaW50ZWxfZW5naW5lX21hc2tfdCBo
dW5nLAotCQkJCSAgIGludGVsX2VuZ2luZV9tYXNrX3Qgc3R1Y2spCi17Ci0Jc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lOwotCWludGVsX2VuZ2luZV9tYXNrX3QgdG1wOwotCWNoYXIgbXNn
WzgwXTsKLQlpbnQgbGVuOwotCi0JLyogSWYgc29tZSByaW5ncyBodW5nIGJ1dCBvdGhlcnMgd2Vy
ZSBzdGlsbCBidXN5LCBvbmx5Ci0JICogYmxhbWUgdGhlIGhhbmdpbmcgcmluZ3MgaW4gdGhlIHN5
bm9wc2lzLgotCSAqLwotCWlmIChzdHVjayAhPSBodW5nKQotCQlodW5nICY9IH5zdHVjazsKLQls
ZW4gPSBzY25wcmludGYobXNnLCBzaXplb2YobXNnKSwKLQkJCSIlcyBvbiAiLCBzdHVjayA9PSBo
dW5nID8gIm5vIHByb2dyZXNzIiA6ICJoYW5nIik7Ci0JZm9yX2VhY2hfZW5naW5lX21hc2tlZChl
bmdpbmUsIGd0LT5pOTE1LCBodW5nLCB0bXApCi0JCWxlbiArPSBzY25wcmludGYobXNnICsgbGVu
LCBzaXplb2YobXNnKSAtIGxlbiwKLQkJCQkgIiVzLCAiLCBlbmdpbmUtPm5hbWUpOwotCW1zZ1ts
ZW4tMl0gPSAnXDAnOwotCi0JcmV0dXJuIGludGVsX2d0X2hhbmRsZV9lcnJvcihndCwgaHVuZywg
STkxNV9FUlJPUl9DQVBUVVJFLCAiJXMiLCBtc2cpOwotfQotCi0vKgotICogVGhpcyBpcyBjYWxs
ZWQgd2hlbiB0aGUgY2hpcCBoYXNuJ3QgcmVwb3J0ZWQgYmFjayB3aXRoIGNvbXBsZXRlZAotICog
YmF0Y2hidWZmZXJzIGluIGEgbG9uZyB0aW1lLiBXZSBrZWVwIHRyYWNrIHBlciByaW5nIHNlcW5v
IHByb2dyZXNzIGFuZAotICogaWYgdGhlcmUgYXJlIG5vIHByb2dyZXNzLCBoYW5nY2hlY2sgc2Nv
cmUgZm9yIHRoYXQgcmluZyBpcyBpbmNyZWFzZWQuCi0gKiBGdXJ0aGVyLCBhY3RoZCBpcyBpbnNw
ZWN0ZWQgdG8gc2VlIGlmIHRoZSByaW5nIGlzIHN0dWNrLiBPbiBzdHVjayBjYXNlCi0gKiB3ZSBr
aWNrIHRoZSByaW5nLiBJZiB3ZSBzZWUgbm8gcHJvZ3Jlc3Mgb24gdGhyZWUgc3Vic2VxdWVudCBj
YWxscwotICogd2UgYXNzdW1lIGNoaXAgaXMgd2VkZ2VkIGFuZCB0cnkgdG8gZml4IGl0IGJ5IHJl
c2V0dGluZyB0aGUgY2hpcC4KLSAqLwotc3RhdGljIHZvaWQgaGFuZ2NoZWNrX2VsYXBzZWQoc3Ry
dWN0IHdvcmtfc3RydWN0ICp3b3JrKQotewotCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPQotCQljb250
YWluZXJfb2Yod29yaywgdHlwZW9mKCpndCksIGhhbmdjaGVjay53b3JrLndvcmspOwotCWludGVs
X2VuZ2luZV9tYXNrX3QgaHVuZyA9IDAsIHN0dWNrID0gMCwgd2VkZ2VkID0gMDsKLQlzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0JZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Ci0JaW50
ZWxfd2FrZXJlZl90IHdha2VyZWY7Ci0KLQlpZiAoIWk5MTVfbW9kcGFyYW1zLmVuYWJsZV9oYW5n
Y2hlY2spCi0JCXJldHVybjsKLQotCWlmICghUkVBRF9PTkNFKGd0LT5hd2FrZSkpCi0JCXJldHVy
bjsKLQotCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoZ3QpKQotCQlyZXR1cm47Ci0KLQl3YWtlcmVm
ID0gaW50ZWxfcnVudGltZV9wbV9nZXRfaWZfaW5fdXNlKCZndC0+aTkxNS0+cnVudGltZV9wbSk7
Ci0JaWYgKCF3YWtlcmVmKQotCQlyZXR1cm47Ci0KLQkvKiBBcyBlbmFibGluZyB0aGUgR1BVIHJl
cXVpcmVzIGZhaXJseSBleHRlbnNpdmUgbW1pbyBhY2Nlc3MsCi0JICogcGVyaW9kaWNhbGx5IGFy
bSB0aGUgbW1pbyBjaGVja2VyIHRvIHNlZSBpZiB3ZSBhcmUgdHJpZ2dlcmluZwotCSAqIGFueSBp
bnZhbGlkIGFjY2Vzcy4KLQkgKi8KLQlpbnRlbF91bmNvcmVfYXJtX3VuY2xhaW1lZF9tbWlvX2Rl
dGVjdGlvbihndC0+dW5jb3JlKTsKLQotCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LT5pOTE1
LCBpZCkgewotCQlzdHJ1Y3QgaGFuZ2NoZWNrIGhjOwotCi0JCWludGVsX2VuZ2luZV9zaWduYWxf
YnJlYWRjcnVtYnMoZW5naW5lKTsKLQotCQloYW5nY2hlY2tfbG9hZF9zYW1wbGUoZW5naW5lLCAm
aGMpOwotCQloYW5nY2hlY2tfYWNjdW11bGF0ZV9zYW1wbGUoZW5naW5lLCAmaGMpOwotCQloYW5n
Y2hlY2tfc3RvcmVfc2FtcGxlKGVuZ2luZSwgJmhjKTsKLQotCQlpZiAoaGMuc3RhbGxlZCkgewot
CQkJaHVuZyB8PSBlbmdpbmUtPm1hc2s7Ci0JCQlpZiAoaGMuYWN0aW9uICE9IEVOR0lORV9ERUFE
KQotCQkJCXN0dWNrIHw9IGVuZ2luZS0+bWFzazsKLQkJfQotCi0JCWlmIChoYy53ZWRnZWQpCi0J
CQl3ZWRnZWQgfD0gZW5naW5lLT5tYXNrOwotCX0KLQotCWlmIChHRU1fU0hPV19ERUJVRygpICYm
IChodW5nIHwgc3R1Y2spKSB7Ci0JCXN0cnVjdCBkcm1fcHJpbnRlciBwID0gZHJtX2RlYnVnX3By
aW50ZXIoImhhbmdjaGVjayIpOwotCi0JCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LT5pOTE1
LCBpZCkgewotCQkJaWYgKGludGVsX2VuZ2luZV9pc19pZGxlKGVuZ2luZSkpCi0JCQkJY29udGlu
dWU7Ci0KLQkJCWludGVsX2VuZ2luZV9kdW1wKGVuZ2luZSwgJnAsICIlc1xuIiwgZW5naW5lLT5u
YW1lKTsKLQkJfQotCX0KLQotCWlmICh3ZWRnZWQpIHsKLQkJZGV2X2VycihndC0+aTkxNS0+ZHJt
LmRldiwKLQkJCSJHUFUgcmVjb3ZlcnkgdGltZWQgb3V0LCIKLQkJCSIgY2FuY2VsbGluZyBhbGwg
aW4tZmxpZ2h0IHJlbmRlcmluZy5cbiIpOwotCQlHRU1fVFJBQ0VfRFVNUCgpOwotCQlpbnRlbF9n
dF9zZXRfd2VkZ2VkKGd0KTsKLQl9Ci0KLQlpZiAoaHVuZykKLQkJaGFuZ2NoZWNrX2RlY2xhcmVf
aGFuZyhndCwgaHVuZywgc3R1Y2spOwotCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoJmd0LT5pOTE1
LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKLQotCS8qIFJlc2V0IHRpbWVyIGluIGNhc2UgR1BVIGhh
bmdzIHdpdGhvdXQgYW5vdGhlciByZXF1ZXN0IGJlaW5nIGFkZGVkICovCi0JaW50ZWxfZ3RfcXVl
dWVfaGFuZ2NoZWNrKGd0KTsKLX0KLQotdm9pZCBpbnRlbF9ndF9xdWV1ZV9oYW5nY2hlY2soc3Ry
dWN0IGludGVsX2d0ICpndCkKLXsKLQl1bnNpZ25lZCBsb25nIGRlbGF5OwotCi0JaWYgKHVubGlr
ZWx5KCFpOTE1X21vZHBhcmFtcy5lbmFibGVfaGFuZ2NoZWNrKSkKLQkJcmV0dXJuOwotCi0JLyoK
LQkgKiBEb24ndCBjb250aW51YWxseSBkZWZlciB0aGUgaGFuZ2NoZWNrIHNvIHRoYXQgaXQgaXMg
YWx3YXlzIHJ1biBhdAotCSAqIGxlYXN0IG9uY2UgYWZ0ZXIgd29yayBoYXMgYmVlbiBzY2hlZHVs
ZWQgb24gYW55IHJpbmcuIE90aGVyd2lzZSwKLQkgKiB3ZSB3aWxsIGlnbm9yZSBhIGh1bmcgcmlu
ZyBpZiBhIHNlY29uZCByaW5nIGlzIGtlcHQgYnVzeS4KLQkgKi8KLQotCWRlbGF5ID0gcm91bmRf
amlmZmllc191cF9yZWxhdGl2ZShEUk1fSTkxNV9IQU5HQ0hFQ0tfSklGRklFUyk7Ci0JcXVldWVf
ZGVsYXllZF93b3JrKHN5c3RlbV9sb25nX3dxLCAmZ3QtPmhhbmdjaGVjay53b3JrLCBkZWxheSk7
Ci19Ci0KLXZvaWQgaW50ZWxfZW5naW5lX2luaXRfaGFuZ2NoZWNrKHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSkKLXsKLQltZW1zZXQoJmVuZ2luZS0+aGFuZ2NoZWNrLCAwLCBzaXplb2Yo
ZW5naW5lLT5oYW5nY2hlY2spKTsKLQllbmdpbmUtPmhhbmdjaGVjay5hY3Rpb25fdGltZXN0YW1w
ID0gamlmZmllczsKLX0KLQotdm9pZCBpbnRlbF9ndF9pbml0X2hhbmdjaGVjayhzdHJ1Y3QgaW50
ZWxfZ3QgKmd0KQotewotCUlOSVRfREVMQVlFRF9XT1JLKCZndC0+aGFuZ2NoZWNrLndvcmssIGhh
bmdjaGVja19lbGFwc2VkKTsKLX0KLQotI2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X1NF
TEZURVNUKQotI2luY2x1ZGUgInNlbGZ0ZXN0X2hhbmdjaGVjay5jIgotI2VuZGlmCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwppbmRleCA5OGMwNzFmZTUzMmIuLjBjYjQ1NzUzOGU2
MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jCkBAIC05NzgsOCArOTc4LDYg
QEAgdm9pZCBpbnRlbF9ndF9yZXNldChzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAogCWlmIChyZXQpCiAJ
CWdvdG8gdGFpbnQ7CiAKLQlpbnRlbF9ndF9xdWV1ZV9oYW5nY2hlY2soZ3QpOwotCiBmaW5pc2g6
CiAJcmVzZXRfZmluaXNoKGd0LCBhd2FrZSk7CiB1bmxvY2s6CkBAIC0xMzA1LDQgKzEzMDMsNSBA
QCB2b2lkIF9faW50ZWxfZmluaV93ZWRnZShzdHJ1Y3QgaW50ZWxfd2VkZ2VfbWUgKncpCiAKICNp
ZiBJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9TRUxGVEVTVCkKICNpbmNsdWRlICJzZWxmdGVz
dF9yZXNldC5jIgorI2luY2x1ZGUgInNlbGZ0ZXN0X2hhbmdjaGVjay5jIgogI2VuZGlmCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hlY2suYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jCmluZGV4IGUyZmEzOGEx
ZmYwZi4uOWQ2NDM5MDk2NmUzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9z
ZWxmdGVzdF9oYW5nY2hlY2suYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVz
dF9oYW5nY2hlY2suYwpAQCAtMTczMiw3ICsxNzMyLDYgQEAgaW50IGludGVsX2hhbmdjaGVja19s
aXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAl9OwogCXN0cnVj
dCBpbnRlbF9ndCAqZ3QgPSAmaTkxNS0+Z3Q7CiAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Ci0J
Ym9vbCBzYXZlZF9oYW5nY2hlY2s7CiAJaW50IGVycjsKIAogCWlmICghaW50ZWxfaGFzX2dwdV9y
ZXNldChndC0+aTkxNSkpCkBAIC0xNzQyLDggKzE3NDEsNiBAQCBpbnQgaW50ZWxfaGFuZ2NoZWNr
X2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCQlyZXR1cm4g
LUVJTzsgLyogd2UncmUgbG9uZyBwYXN0IGhvcGUgb2YgYSBzdWNjZXNzZnVsIHJlc2V0ICovCiAK
IAl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmd0LT5pOTE1LT5ydW50aW1lX3BtKTsK
LQlzYXZlZF9oYW5nY2hlY2sgPSBmZXRjaF9hbmRfemVybygmaTkxNV9tb2RwYXJhbXMuZW5hYmxl
X2hhbmdjaGVjayk7Ci0JZHJhaW5fZGVsYXllZF93b3JrKCZndC0+aGFuZ2NoZWNrLndvcmspOyAv
KiBmbHVzaCBwYXJhbSAqLwogCiAJZXJyID0gaW50ZWxfZ3RfbGl2ZV9zdWJ0ZXN0cyh0ZXN0cywg
Z3QpOwogCkBAIC0xNzUxLDcgKzE3NDgsNiBAQCBpbnQgaW50ZWxfaGFuZ2NoZWNrX2xpdmVfc2Vs
ZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCWlndF9mbHVzaF90ZXN0KGd0
LT5pOTE1LCBJOTE1X1dBSVRfTE9DS0VEKTsKIAltdXRleF91bmxvY2soJmd0LT5pOTE1LT5kcm0u
c3RydWN0X211dGV4KTsKIAotCWk5MTVfbW9kcGFyYW1zLmVuYWJsZV9oYW5nY2hlY2sgPSBzYXZl
ZF9oYW5nY2hlY2s7CiAJaW50ZWxfcnVudGltZV9wbV9wdXQoJmd0LT5pOTE1LT5ydW50aW1lX3Bt
LCB3YWtlcmVmKTsKIAogCXJldHVybiBlcnI7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2RlYnVnZnMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5j
CmluZGV4IDI0Nzg3YmI0OGM5Zi4uMWYwNDA4ZmYzNDViIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2RlYnVnZnMuYwpAQCAtMTA0NCw5MSArMTA0NCw2IEBAIHN0YXRpYyBpbnQgaTkxNV9mcmVxdWVu
Y3lfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKIAlyZXR1cm4gcmV0Owog
fQogCi1zdGF0aWMgdm9pZCBpOTE1X2luc3Rkb25lX2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAotCQkJICAgICAgIHN0cnVjdCBzZXFfZmlsZSAqbSwKLQkJCSAgICAgICBz
dHJ1Y3QgaW50ZWxfaW5zdGRvbmUgKmluc3Rkb25lKQotewotCWludCBzbGljZTsKLQlpbnQgc3Vi
c2xpY2U7Ci0KLQlzZXFfcHJpbnRmKG0sICJcdFx0SU5TVERPTkU6IDB4JTA4eFxuIiwKLQkJICAg
aW5zdGRvbmUtPmluc3Rkb25lKTsKLQotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDMpCi0J
CXJldHVybjsKLQotCXNlcV9wcmludGYobSwgIlx0XHRTQ19JTlNURE9ORTogMHglMDh4XG4iLAot
CQkgICBpbnN0ZG9uZS0+c2xpY2VfY29tbW9uKTsKLQotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
IDw9IDYpCi0JCXJldHVybjsKLQotCWZvcl9lYWNoX2luc3Rkb25lX3NsaWNlX3N1YnNsaWNlKGRl
dl9wcml2LCBzbGljZSwgc3Vic2xpY2UpCi0JCXNlcV9wcmludGYobSwgIlx0XHRTQU1QTEVSX0lO
U1RET05FWyVkXVslZF06IDB4JTA4eFxuIiwKLQkJCSAgIHNsaWNlLCBzdWJzbGljZSwgaW5zdGRv
bmUtPnNhbXBsZXJbc2xpY2VdW3N1YnNsaWNlXSk7Ci0KLQlmb3JfZWFjaF9pbnN0ZG9uZV9zbGlj
ZV9zdWJzbGljZShkZXZfcHJpdiwgc2xpY2UsIHN1YnNsaWNlKQotCQlzZXFfcHJpbnRmKG0sICJc
dFx0Uk9XX0lOU1RET05FWyVkXVslZF06IDB4JTA4eFxuIiwKLQkJCSAgIHNsaWNlLCBzdWJzbGlj
ZSwgaW5zdGRvbmUtPnJvd1tzbGljZV1bc3Vic2xpY2VdKTsKLX0KLQotc3RhdGljIGludCBpOTE1
X2hhbmdjaGVja19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQotewotCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwot
CXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSAmaTkxNS0+Z3Q7Ci0Jc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lOwotCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwotCWVudW0gaW50ZWxfZW5naW5l
X2lkIGlkOwotCi0Jc2VxX3ByaW50ZihtLCAiUmVzZXQgZmxhZ3M6ICVseFxuIiwgZ3QtPnJlc2V0
LmZsYWdzKTsKLQlpZiAodGVzdF9iaXQoSTkxNV9XRURHRUQsICZndC0+cmVzZXQuZmxhZ3MpKQot
CQlzZXFfcHV0cyhtLCAiXHRXZWRnZWRcbiIpOwotCWlmICh0ZXN0X2JpdChJOTE1X1JFU0VUX0JB
Q0tPRkYsICZndC0+cmVzZXQuZmxhZ3MpKQotCQlzZXFfcHV0cyhtLCAiXHREZXZpY2UgKGdsb2Jh
bCkgcmVzZXQgaW4gcHJvZ3Jlc3NcbiIpOwotCi0JaWYgKCFpOTE1X21vZHBhcmFtcy5lbmFibGVf
aGFuZ2NoZWNrKSB7Ci0JCXNlcV9wdXRzKG0sICJIYW5nY2hlY2sgZGlzYWJsZWRcbiIpOwotCQly
ZXR1cm4gMDsKLQl9Ci0KLQlpZiAodGltZXJfcGVuZGluZygmZ3QtPmhhbmdjaGVjay53b3JrLnRp
bWVyKSkKLQkJc2VxX3ByaW50ZihtLCAiSGFuZ2NoZWNrIGFjdGl2ZSwgdGltZXIgZmlyZXMgaW4g
JWRtc1xuIiwKLQkJCSAgIGppZmZpZXNfdG9fbXNlY3MoZ3QtPmhhbmdjaGVjay53b3JrLnRpbWVy
LmV4cGlyZXMgLQotCQkJCQkgICAgamlmZmllcykpOwotCWVsc2UgaWYgKGRlbGF5ZWRfd29ya19w
ZW5kaW5nKCZndC0+aGFuZ2NoZWNrLndvcmspKQotCQlzZXFfcHV0cyhtLCAiSGFuZ2NoZWNrIGFj
dGl2ZSwgd29yayBwZW5kaW5nXG4iKTsKLQllbHNlCi0JCXNlcV9wdXRzKG0sICJIYW5nY2hlY2sg
aW5hY3RpdmVcbiIpOwotCi0Jc2VxX3ByaW50ZihtLCAiR1QgYWN0aXZlPyAlc1xuIiwgeWVzbm8o
Z3QtPmF3YWtlKSk7Ci0KLQl3aXRoX2ludGVsX3J1bnRpbWVfcG0oJmk5MTUtPnJ1bnRpbWVfcG0s
IHdha2VyZWYpIHsKLQkJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKLQkJCXN0
cnVjdCBpbnRlbF9pbnN0ZG9uZSBpbnN0ZG9uZTsKLQotCQkJc2VxX3ByaW50ZihtLCAiJXM6ICVk
IG1zIGFnb1xuIiwKLQkJCQkgICBlbmdpbmUtPm5hbWUsCi0JCQkJICAgamlmZmllc190b19tc2Vj
cyhqaWZmaWVzIC0KLQkJCQkJCSAgICBlbmdpbmUtPmhhbmdjaGVjay5hY3Rpb25fdGltZXN0YW1w
KSk7Ci0KLQkJCXNlcV9wcmludGYobSwgIlx0QUNUSEQgPSAweCUwOGxseCBbY3VycmVudCAweCUw
OGxseF1cbiIsCi0JCQkJICAgKGxvbmcgbG9uZyllbmdpbmUtPmhhbmdjaGVjay5hY3RoZCwKLQkJ
CQkgICBpbnRlbF9lbmdpbmVfZ2V0X2FjdGl2ZV9oZWFkKGVuZ2luZSkpOwotCi0JCQlpbnRlbF9l
bmdpbmVfZ2V0X2luc3Rkb25lKGVuZ2luZSwgJmluc3Rkb25lKTsKLQotCQkJc2VxX3B1dHMobSwg
Ilx0aW5zdGRvbmUgcmVhZCA9XG4iKTsKLQkJCWk5MTVfaW5zdGRvbmVfaW5mbyhpOTE1LCBtLCAm
aW5zdGRvbmUpOwotCi0JCQlzZXFfcHV0cyhtLCAiXHRpbnN0ZG9uZSBhY2N1ID1cbiIpOwotCQkJ
aTkxNV9pbnN0ZG9uZV9pbmZvKGk5MTUsIG0sCi0JCQkJCSAgICZlbmdpbmUtPmhhbmdjaGVjay5p
bnN0ZG9uZSk7Ci0JCX0KLQl9Ci0KLQlyZXR1cm4gMDsKLX0KLQogc3RhdGljIGludCBpcm9ubGFr
ZV9kcnBjX2luZm8oc3RydWN0IHNlcV9maWxlICptKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwpAQCAtNDM4Nyw3ICs0MzAyLDYg
QEAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1faW5mb19saXN0IGk5MTVfZGVidWdmc19saXN0W10g
PSB7CiAJeyJpOTE1X2d1Y19zdGFnZV9wb29sIiwgaTkxNV9ndWNfc3RhZ2VfcG9vbCwgMH0sCiAJ
eyJpOTE1X2h1Y19sb2FkX3N0YXR1cyIsIGk5MTVfaHVjX2xvYWRfc3RhdHVzX2luZm8sIDB9LAog
CXsiaTkxNV9mcmVxdWVuY3lfaW5mbyIsIGk5MTVfZnJlcXVlbmN5X2luZm8sIDB9LAotCXsiaTkx
NV9oYW5nY2hlY2tfaW5mbyIsIGk5MTVfaGFuZ2NoZWNrX2luZm8sIDB9LAogCXsiaTkxNV9kcnBj
X2luZm8iLCBpOTE1X2RycGNfaW5mbywgMH0sCiAJeyJpOTE1X2Vtb25fc3RhdHVzIiwgaTkxNV9l
bW9uX3N0YXR1cywgMH0sCiAJeyJpOTE1X3JpbmdfZnJlcV90YWJsZSIsIGk5MTVfcmluZ19mcmVx
X3RhYmxlLCAwfSwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCmluZGV4IGYyZDNkNzU0YWYzNy4uOGMy
NzdmYmY5NjYzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKQEAgLTQxMSw4ICs0MTEsNyBAQCBz
dGF0aWMgaW50IGk5MTVfZ2V0cGFyYW1faW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9p
ZCAqZGF0YSwKIAkJCXJldHVybiAtRU5PREVWOwogCQlicmVhazsKIAljYXNlIEk5MTVfUEFSQU1f
SEFTX0dQVV9SRVNFVDoKLQkJdmFsdWUgPSBpOTE1X21vZHBhcmFtcy5lbmFibGVfaGFuZ2NoZWNr
ICYmCi0JCQlpbnRlbF9oYXNfZ3B1X3Jlc2V0KGRldl9wcml2KTsKKwkJdmFsdWUgPSBpbnRlbF9o
YXNfZ3B1X3Jlc2V0KGRldl9wcml2KTsKIAkJaWYgKHZhbHVlICYmIGludGVsX2hhc19yZXNldF9l
bmdpbmUoZGV2X3ByaXYpKQogCQkJdmFsdWUgPSAyOwogCQlicmVhazsKQEAgLTE5NzUsMTAgKzE5
NzQsNyBAQCB2b2lkIGk5MTVfZHJpdmVyX3JlbW92ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQog
CiAJaW50ZWxfY3NyX3Vjb2RlX2ZpbmkoZGV2X3ByaXYpOwogCi0JLyogRnJlZSBlcnJvciBzdGF0
ZSBhZnRlciBpbnRlcnJ1cHRzIGFyZSBmdWxseSBkaXNhYmxlZC4gKi8KLQljYW5jZWxfZGVsYXll
ZF93b3JrX3N5bmMoJmRldl9wcml2LT5ndC5oYW5nY2hlY2sud29yayk7CiAJaTkxNV9yZXNldF9l
cnJvcl9zdGF0ZShkZXZfcHJpdik7Ci0KIAlpOTE1X2dlbV9kcml2ZXJfcmVtb3ZlKGRldl9wcml2
KTsKIAogCWludGVsX3Bvd2VyX2RvbWFpbnNfZHJpdmVyX3JlbW92ZShkZXZfcHJpdik7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9kcnYuaAppbmRleCA1OWQ0YTExNDYwMzkuLjBlNzE1YjEyNjZmMCAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAorKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2Rydi5oCkBAIC0yMzc1LDcgKzIzNzUsNiBAQCBleHRlcm4gY29uc3Qgc3Ry
dWN0IGRldl9wbV9vcHMgaTkxNV9wbV9vcHM7CiBpbnQgaTkxNV9kcml2ZXJfcHJvYmUoc3RydWN0
IHBjaV9kZXYgKnBkZXYsIGNvbnN0IHN0cnVjdCBwY2lfZGV2aWNlX2lkICplbnQpOwogdm9pZCBp
OTE1X2RyaXZlcl9yZW1vdmUoc3RydWN0IGRybV9kZXZpY2UgKmRldik7CiAKLXZvaWQgaW50ZWxf
ZW5naW5lX2luaXRfaGFuZ2NoZWNrKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7CiBp
bnQgdmx2X2ZvcmNlX2dmeF9jbG9jayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
IGJvb2wgb24pOwogCiBzdGF0aWMgaW5saW5lIGJvb2wgaW50ZWxfZ3Z0X2FjdGl2ZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2dwdV9lcnJvci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJy
b3IuYwppbmRleCA2NzRkMzQxYTIzZjYuLmVmZjEwY2E1YTc4OCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2dwdV9lcnJvci5jCkBAIC01NTQsMTAgKzU1NCw2IEBAIHN0YXRpYyB2b2lkIGVycm9y
X3ByaW50X2VuZ2luZShzdHJ1Y3QgZHJtX2k5MTVfZXJyb3Jfc3RhdGVfYnVmICptLAogCX0KIAll
cnJfcHJpbnRmKG0sICIgIHJpbmctPmhlYWQ6IDB4JTA4eFxuIiwgZWUtPmNwdV9yaW5nX2hlYWQp
OwogCWVycl9wcmludGYobSwgIiAgcmluZy0+dGFpbDogMHglMDh4XG4iLCBlZS0+Y3B1X3Jpbmdf
dGFpbCk7Ci0JZXJyX3ByaW50ZihtLCAiICBoYW5nY2hlY2sgdGltZXN0YW1wOiAlZG1zICglbHUl
cylcbiIsCi0JCSAgIGppZmZpZXNfdG9fbXNlY3MoZWUtPmhhbmdjaGVja190aW1lc3RhbXAgLSBl
cG9jaCksCi0JCSAgIGVlLT5oYW5nY2hlY2tfdGltZXN0YW1wLAotCQkgICBlZS0+aGFuZ2NoZWNr
X3RpbWVzdGFtcCA9PSBlcG9jaCA/ICI7IGVwb2NoIiA6ICIiKTsKIAllcnJfcHJpbnRmKG0sICIg
IGVuZ2luZSByZXNldCBjb3VudDogJXVcbiIsIGVlLT5yZXNldF9jb3VudCk7CiAKIAlmb3IgKG4g
PSAwOyBuIDwgZWUtPm51bV9wb3J0czsgbisrKSB7CkBAIC02OTUsMTEgKzY5MSw4IEBAIHN0YXRp
YyB2b2lkIF9fZXJyX3ByaW50X3RvX3NnbChzdHJ1Y3QgZHJtX2k5MTVfZXJyb3Jfc3RhdGVfYnVm
ICptLAogCXRzID0ga3RpbWVfdG9fdGltZXNwZWM2NChlcnJvci0+dXB0aW1lKTsKIAllcnJfcHJp
bnRmKG0sICJVcHRpbWU6ICVsbGQgcyAlbGQgdXNcbiIsCiAJCSAgIChzNjQpdHMudHZfc2VjLCB0
cy50dl9uc2VjIC8gTlNFQ19QRVJfVVNFQyk7Ci0JZXJyX3ByaW50ZihtLCAiRXBvY2g6ICVsdSBq
aWZmaWVzICgldSBIWilcbiIsIGVycm9yLT5lcG9jaCwgSFopOwotCWVycl9wcmludGYobSwgIkNh
cHR1cmU6ICVsdSBqaWZmaWVzOyAlZCBtcyBhZ28sICVkIG1zIGFmdGVyIGVwb2NoXG4iLAotCQkg
ICBlcnJvci0+Y2FwdHVyZSwKLQkJICAgamlmZmllc190b19tc2VjcyhqaWZmaWVzIC0gZXJyb3It
PmNhcHR1cmUpLAotCQkgICBqaWZmaWVzX3RvX21zZWNzKGVycm9yLT5jYXB0dXJlIC0gZXJyb3It
PmVwb2NoKSk7CisJZXJyX3ByaW50ZihtLCAiQ2FwdHVyZTogJWx1IGppZmZpZXM7ICVkIG1zIGFn
b1xuIiwKKwkJICAgZXJyb3ItPmNhcHR1cmUsIGppZmZpZXNfdG9fbXNlY3MoamlmZmllcyAtIGVy
cm9yLT5jYXB0dXJlKSk7CiAKIAlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShlcnJvci0+ZW5n
aW5lKTsgaSsrKSB7CiAJCWlmICghZXJyb3ItPmVuZ2luZVtpXS5jb250ZXh0LnBpZCkKQEAgLTc2
MCw3ICs3NTMsOSBAQCBzdGF0aWMgdm9pZCBfX2Vycl9wcmludF90b19zZ2woc3RydWN0IGRybV9p
OTE1X2Vycm9yX3N0YXRlX2J1ZiAqbSwKIAogCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGVy
cm9yLT5lbmdpbmUpOyBpKyspIHsKIAkJaWYgKGVycm9yLT5lbmdpbmVbaV0uZW5naW5lX2lkICE9
IC0xKQotCQkJZXJyb3JfcHJpbnRfZW5naW5lKG0sICZlcnJvci0+ZW5naW5lW2ldLCBlcnJvci0+
ZXBvY2gpOworCQkJZXJyb3JfcHJpbnRfZW5naW5lKG0sCisJCQkJCSAgICZlcnJvci0+ZW5naW5l
W2ldLAorCQkJCQkgICBlcnJvci0+Y2FwdHVyZSk7CiAJfQogCiAJZm9yIChpID0gMDsgaSA8IEFS
UkFZX1NJWkUoZXJyb3ItPmVuZ2luZSk7IGkrKykgewpAQCAtNzkwLDcgKzc4NSw3IEBAIHN0YXRp
YyB2b2lkIF9fZXJyX3ByaW50X3RvX3NnbChzdHJ1Y3QgZHJtX2k5MTVfZXJyb3Jfc3RhdGVfYnVm
ICptLAogCQkJZm9yIChqID0gMDsgaiA8IGVlLT5udW1fcmVxdWVzdHM7IGorKykKIAkJCQllcnJv
cl9wcmludF9yZXF1ZXN0KG0sICIgIiwKIAkJCQkJCSAgICAmZWUtPnJlcXVlc3RzW2pdLAotCQkJ
CQkJICAgIGVycm9yLT5lcG9jaCk7CisJCQkJCQkgICAgZXJyb3ItPmNhcHR1cmUpOwogCQl9CiAK
IAkJcHJpbnRfZXJyb3Jfb2JqKG0sIG0tPmk5MTUtPmVuZ2luZVtpXSwKQEAgLTExNzEsOCArMTE2
Niw2IEBAIHN0YXRpYyB2b2lkIGVycm9yX3JlY29yZF9lbmdpbmVfcmVnaXN0ZXJzKHN0cnVjdCBp
OTE1X2dwdV9zdGF0ZSAqZXJyb3IsCiAJfQogCiAJZWUtPmlkbGUgPSBpbnRlbF9lbmdpbmVfaXNf
aWRsZShlbmdpbmUpOwotCWlmICghZWUtPmlkbGUpCi0JCWVlLT5oYW5nY2hlY2tfdGltZXN0YW1w
ID0gZW5naW5lLT5oYW5nY2hlY2suYWN0aW9uX3RpbWVzdGFtcDsKIAllZS0+cmVzZXRfY291bnQg
PSBpOTE1X3Jlc2V0X2VuZ2luZV9jb3VudCgmZGV2X3ByaXYtPmdwdV9lcnJvciwKIAkJCQkJCSAg
ZW5naW5lKTsKIApAQCAtMTY3MywyMiArMTY2Niw2IEBAIHN0YXRpYyB2b2lkIGNhcHR1cmVfcGFy
YW1zKHN0cnVjdCBpOTE1X2dwdV9zdGF0ZSAqZXJyb3IpCiAJaTkxNV9wYXJhbXNfY29weSgmZXJy
b3ItPnBhcmFtcywgJmk5MTVfbW9kcGFyYW1zKTsKIH0KIAotc3RhdGljIHVuc2lnbmVkIGxvbmcg
Y2FwdHVyZV9maW5kX2Vwb2NoKGNvbnN0IHN0cnVjdCBpOTE1X2dwdV9zdGF0ZSAqZXJyb3IpCi17
Ci0JdW5zaWduZWQgbG9uZyBlcG9jaCA9IGVycm9yLT5jYXB0dXJlOwotCWludCBpOwotCi0JZm9y
IChpID0gMDsgaSA8IEFSUkFZX1NJWkUoZXJyb3ItPmVuZ2luZSk7IGkrKykgewotCQljb25zdCBz
dHJ1Y3QgZHJtX2k5MTVfZXJyb3JfZW5naW5lICplZSA9ICZlcnJvci0+ZW5naW5lW2ldOwotCi0J
CWlmIChlZS0+aGFuZ2NoZWNrX3RpbWVzdGFtcCAmJgotCQkgICAgdGltZV9iZWZvcmUoZWUtPmhh
bmdjaGVja190aW1lc3RhbXAsIGVwb2NoKSkKLQkJCWVwb2NoID0gZWUtPmhhbmdjaGVja190aW1l
c3RhbXA7Ci0JfQotCi0JcmV0dXJuIGVwb2NoOwotfQotCiBzdGF0aWMgdm9pZCBjYXB0dXJlX2Zp
bmlzaChzdHJ1Y3QgaTkxNV9ncHVfc3RhdGUgKmVycm9yKQogewogCXN0cnVjdCBpOTE1X2dndHQg
KmdndHQgPSAmZXJyb3ItPmk5MTUtPmdndHQ7CkBAIC0xNzQwLDggKzE3MTcsNiBAQCBpOTE1X2Nh
cHR1cmVfZ3B1X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCWVycm9yLT5v
dmVybGF5ID0gaW50ZWxfb3ZlcmxheV9jYXB0dXJlX2Vycm9yX3N0YXRlKGk5MTUpOwogCWVycm9y
LT5kaXNwbGF5ID0gaW50ZWxfZGlzcGxheV9jYXB0dXJlX2Vycm9yX3N0YXRlKGk5MTUpOwogCi0J
ZXJyb3ItPmVwb2NoID0gY2FwdHVyZV9maW5kX2Vwb2NoKGVycm9yKTsKLQogCWNhcHR1cmVfZmlu
aXNoKGVycm9yKTsKIAljb21wcmVzc19maW5pKCZjb21wcmVzcyk7CiAKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2dwdV9lcnJvci5oCmluZGV4IGEyNGMzNTEwN2QxNi4uYzRiYTI5N2NhODYyIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5oCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmgKQEAgLTM0LDcgKzM0LDYgQEAgc3RydWN0
IGk5MTVfZ3B1X3N0YXRlIHsKIAlrdGltZV90IGJvb3R0aW1lOwogCWt0aW1lX3QgdXB0aW1lOwog
CXVuc2lnbmVkIGxvbmcgY2FwdHVyZTsKLQl1bnNpZ25lZCBsb25nIGVwb2NoOwogCiAJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTU7CiAKQEAgLTg0LDcgKzgzLDYgQEAgc3RydWN0IGk5MTVf
Z3B1X3N0YXRlIHsKIAkJaW50IGVuZ2luZV9pZDsKIAkJLyogU29mdHdhcmUgdHJhY2tlZCBzdGF0
ZSAqLwogCQlib29sIGlkbGU7Ci0JCXVuc2lnbmVkIGxvbmcgaGFuZ2NoZWNrX3RpbWVzdGFtcDsK
IAkJaW50IG51bV9yZXF1ZXN0czsKIAkJdTMyIHJlc2V0X2NvdW50OwogCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BhcmFtcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9wYXJhbXMuYwppbmRleCAyOTY0NTJmOWVmZTQuLmU0Y2Q1OGU5MGU0MCAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wYXJhbXMuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3BhcmFtcy5jCkBAIC03NywxMSArNzcsNiBAQCBpOTE1X3BhcmFtX25hbWVk
KGVycm9yX2NhcHR1cmUsIGJvb2wsIDA2MDAsCiAJInRyaWFnaW5nIGFuZCBkZWJ1Z2dpbmcgaGFu
Z3MuIik7CiAjZW5kaWYKIAotaTkxNV9wYXJhbV9uYW1lZF91bnNhZmUoZW5hYmxlX2hhbmdjaGVj
aywgYm9vbCwgMDYwMCwKLQkiUGVyaW9kaWNhbGx5IGNoZWNrIEdQVSBhY3Rpdml0eSBmb3IgZGV0
ZWN0aW5nIGhhbmdzLiAiCi0JIldBUk5JTkc6IERpc2FibGluZyB0aGlzIGNhbiBjYXVzZSBzeXN0
ZW0gd2lkZSBoYW5ncy4gIgotCSIoZGVmYXVsdDogdHJ1ZSkiKTsKLQogaTkxNV9wYXJhbV9uYW1l
ZF91bnNhZmUoZW5hYmxlX3BzciwgaW50LCAwNjAwLAogCSJFbmFibGUgUFNSICIKIAkiKDA9ZGlz
YWJsZWQsIDE9ZW5hYmxlZCkgIgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9wYXJhbXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGFyYW1zLmgKaW5kZXggZDI5
YWRlM2I3ZGU2Li45YTMzNTljNmY2ZjMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfcGFyYW1zLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wYXJhbXMuaApA
QCAtNjgsNyArNjgsNiBAQCBzdHJ1Y3QgZHJtX3ByaW50ZXI7CiAJcGFyYW0oY2hhciAqLCBmb3Jj
ZV9wcm9iZSwgQ09ORklHX0RSTV9JOTE1X0ZPUkNFX1BST0JFKSBcCiAJLyogbGVhdmUgYm9vbHMg
YXQgdGhlIGVuZCB0byBub3QgY3JlYXRlIGhvbGVzICovIFwKIAlwYXJhbShib29sLCBhbHBoYV9z
dXBwb3J0LCBJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9BTFBIQV9TVVBQT1JUKSkgXAotCXBh
cmFtKGJvb2wsIGVuYWJsZV9oYW5nY2hlY2ssIHRydWUpIFwKIAlwYXJhbShib29sLCBwcmVmYXVs
dF9kaXNhYmxlLCBmYWxzZSkgXAogCXBhcmFtKGJvb2wsIGxvYWRfZGV0ZWN0X3Rlc3QsIGZhbHNl
KSBcCiAJcGFyYW0oYm9vbCwgZm9yY2VfcmVzZXRfbW9kZXNldF90ZXN0LCBmYWxzZSkgXAotLSAK
Mi4yMi4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJ
bnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0
cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

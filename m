Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id DC68CAB815
	for <lists+intel-gfx@lfdr.de>; Fri,  6 Sep 2019 14:23:28 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 5A9286E284;
	Fri,  6 Sep 2019 12:23:27 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga02.intel.com (mga02.intel.com [134.134.136.20])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4F8236E288
 for <intel-gfx@lists.freedesktop.org>; Fri,  6 Sep 2019 12:23:24 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga007.fm.intel.com ([10.253.24.52])
 by orsmga101.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 06 Sep 2019 05:23:20 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,473,1559545200"; d="scan'208";a="184523372"
Received: from rosetta.fi.intel.com ([10.237.72.194])
 by fmsmga007.fm.intel.com with ESMTP; 06 Sep 2019 05:23:18 -0700
Received: by rosetta.fi.intel.com (Postfix, from userid 1000)
 id 8301B84077D; Fri,  6 Sep 2019 15:23:17 +0300 (EEST)
From: Mika Kuoppala <mika.kuoppala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri,  6 Sep 2019 15:23:13 +0300
Message-Id: <20190906122314.2146-1-mika.kuoppala@linux.intel.com>
X-Mailer: git-send-email 2.17.1
Subject: [Intel-gfx] [PATCH 1/2] drm/i915: Use engine relative LRIs on
 context setup
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Lucas De Marchi <lucas.demarchi@intel.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RGFuaWVsZSBwb2ludGVkIG91dCB0aGF0IHJlbGF0aXZlIG1taW8gd29ya3MgZGlmZmVyZW50bHkg
aW4Kb24gY29udGV4dCByZXN0b3JlLiBJbnN0ZWFkIG9mIGFkZGluZyB0aGUgZW5naW5lIG1taW8g
YmFzZSB0byBvZmZzZXQsCml0IG1hc2tzIG91dCB0aGUgYmFzZSBhbmQgYWRkcyBiaXRzIFsxMjoy
XSB0byBjdXJyZW50IGVuZ2luZSBiYXNlLgoKVGhpcyBzaG91bGQgYWxsb3cgdXMgdG8gY29uc3Ry
dWN0IGNvbnRleHQgcmVnaXN0ZXIgc3RhdGUgdG8gYmUKYXBwbGljYWJsZSB0byBhbGwgaW5zdGFu
Y2VzLCBpbmNsdWRpbmcgdmlydHVhbC4gQW5kIGF2b2lkIHRoZSB0cm91YmxlCm9mIHVwZGF0aW5n
IHRoZSByZWdpc3RlcnMgb24gdmlydHVhbCBpbnN0YW5jZXMgd2hlbiBzdWJtaXR0aW5nIHdvcmsu
CgpCc3BlYzogMjAyMDYKQ2M6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVr
PgpDYzogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KQ2M6IE1pY2hh
bCBXYWpkZWN6a28gPG1pY2hhbC53YWpkZWN6a29AaW50ZWwuY29tPgpDYzogSm9vbmFzIExhaHRp
bmVuIDxqb29uYXMubGFodGluZW5AbGludXguaW50ZWwuY29tPgpDYzogTHVjYXMgRGUgTWFyY2hp
IDxsdWNhcy5kZW1hcmNoaUBpbnRlbC5jb20+CkNjOiBKb2huIEhhcnJpc29uIDxKb2huLkMuSGFy
cmlzb25ASW50ZWwuY29tPgpTdWdnZXN0ZWQtYnk6IERhbmllbGUgQ2VyYW9sbyBTcHVyaW8gPGRh
bmllbGUuY2VyYW9sb3NwdXJpb0BpbnRlbC5jb20+ClNpZ25lZC1vZmYtYnk6IE1pa2EgS3VvcHBh
bGEgPG1pa2Eua3VvcHBhbGFAbGludXguaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oIHwgIDcgKysrKysKIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2dwdV9jb21tYW5kcy5oIHwgIDIgKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2xyYy5jICAgICAgICAgIHwgMjcgKysrKysrKysrKysrKystLS0tLS0KIDMgZmls
ZXMgY2hhbmdlZCwgMjggaW5zZXJ0aW9ucygrKSwgOCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaCBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oCmluZGV4IDE1ZTAyY2I1OGE2Ny4u
OTQzZjA2NjM4MzdlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9l
bmdpbmVfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVf
dHlwZXMuaApAQCAtNDgxLDYgKzQ4MSw3IEBAIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgewogI2Rl
ZmluZSBJOTE1X0VOR0lORV9IQVNfU0VNQVBIT1JFUyAgIEJJVCgzKQogI2RlZmluZSBJOTE1X0VO
R0lORV9ORUVEU19CUkVBRENSVU1CX1RBU0tMRVQgQklUKDQpCiAjZGVmaW5lIEk5MTVfRU5HSU5F
X0lTX1ZJUlRVQUwgICAgICAgQklUKDUpCisjZGVmaW5lIEk5MTVfRU5HSU5FX0hBU19SRUxBVElW
RV9NTUlPIEJJVCg2KQogCXVuc2lnbmVkIGludCBmbGFnczsKIAogCS8qCkBAIC01NzYsNiArNTc3
LDEyIEBAIGludGVsX2VuZ2luZV9pc192aXJ0dWFsKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSkKIAlyZXR1cm4gZW5naW5lLT5mbGFncyAmIEk5MTVfRU5HSU5FX0lTX1ZJUlRV
QUw7CiB9CiAKK3N0YXRpYyBpbmxpbmUgYm9vbAoraW50ZWxfZW5naW5lX2hhc19yZWxhdGl2ZV9t
bWlvKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKiBjb25zdCBlbmdpbmUpCit7CisJcmV0
dXJuIGVuZ2luZS0+ZmxhZ3MgJiBJOTE1X0VOR0lORV9IQVNfUkVMQVRJVkVfTU1JTzsKK30KKwog
I2RlZmluZSBpbnN0ZG9uZV9oYXNfc2xpY2UoZGV2X3ByaXZfX18sIHNzZXVfX18sIHNsaWNlX19f
KSBcCiAJKChJU19HRU4oZGV2X3ByaXZfX18sIDcpID8gMSA6ICgoc3NldV9fXyktPnNsaWNlX21h
c2spKSAmIEJJVChzbGljZV9fXykpCiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2dwdV9jb21tYW5kcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
Z3B1X2NvbW1hbmRzLmgKaW5kZXggODZlMDBhMmRiOGE0Li5lMWI4N2E1MTZlZjggMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2dwdV9jb21tYW5kcy5oCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2dwdV9jb21tYW5kcy5oCkBAIC0xMzIsNiArMTMy
LDggQEAKICAqICAgYWRkcmVzcy92YWx1ZSBwYWlycy4gRG9uJ3Qgb3ZlcmR1ZSBpdCwgdGhvdWdo
LCB4IDw9IDJeNCBtdXN0IGhvbGQhCiAgKi8KICNkZWZpbmUgTUlfTE9BRF9SRUdJU1RFUl9JTU0o
eCkJTUlfSU5TVFIoMHgyMiwgMiooeCktMSkKKy8qIEdlbjExKy4gYWRkciA9IGJhc2UgKyAoY3R4
X3Jlc3RvcmUgPyBvZmZzZXQgJiBHRU5NQVNLKDEyOjIpIDogb2Zmc2V0KSAqLworI2RlZmluZSAg
IE1JX0xSSV9DU19NTUlPCQkoMTw8MTkpCiAjZGVmaW5lICAgTUlfTFJJX0ZPUkNFX1BPU1RFRAkJ
KDE8PDEyKQogI2RlZmluZSBNSV9TVE9SRV9SRUdJU1RFUl9NRU0gICAgICAgIE1JX0lOU1RSKDB4
MjQsIDEpCiAjZGVmaW5lIE1JX1NUT1JFX1JFR0lTVEVSX01FTV9HRU44ICAgTUlfSU5TVFIoMHgy
NCwgMikKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKaW5kZXggODdiNzQ3M2E2ZGZiLi42
YzY4ZWQyYmYzZDIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xy
Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCkBAIC0xMjE0LDcg
KzEyMTQsMTAgQEAgc3RhdGljIHZvaWQgZXhlY2xpc3RzX2RlcXVldWUoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQogCQkJCXVuc2lnbmVkIGludCBuOwogCiAJCQkJR0VNX0JVR19PTihS
RUFEX09OQ0UodmUtPmNvbnRleHQuaW5mbGlnaHQpKTsKLQkJCQl2aXJ0dWFsX3VwZGF0ZV9yZWdp
c3Rlcl9vZmZzZXRzKHJlZ3MsIGVuZ2luZSk7CisKKwkJCQlpZiAoIWludGVsX2VuZ2luZV9oYXNf
cmVsYXRpdmVfbW1pbyhlbmdpbmUpKQorCQkJCQl2aXJ0dWFsX3VwZGF0ZV9yZWdpc3Rlcl9vZmZz
ZXRzKHJlZ3MsCisJCQkJCQkJCQllbmdpbmUpOwogCiAJCQkJaWYgKCFsaXN0X2VtcHR5KCZ2ZS0+
Y29udGV4dC5zaWduYWxzKSkKIAkJCQkJdmlydHVhbF94ZmVyX2JyZWFkY3J1bWJzKHZlLCBlbmdp
bmUpOwpAQCAtMjkzOSw2ICsyOTQyLDEwIEBAIHZvaWQgaW50ZWxfZXhlY2xpc3RzX3NldF9kZWZh
dWx0X3N1Ym1pc3Npb24oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCQlpZiAoSEFT
X0xPR0lDQUxfUklOR19QUkVFTVBUSU9OKGVuZ2luZS0+aTkxNSkpCiAJCQllbmdpbmUtPmZsYWdz
IHw9IEk5MTVfRU5HSU5FX0hBU19QUkVFTVBUSU9OOwogCX0KKworCWVuZ2luZS0+ZmxhZ3MgfD0g
KGVuZ2luZS0+Y2xhc3MgIT0gQ09QWV9FTkdJTkVfQ0xBU1MgJiYKKwkJCSAgSU5URUxfR0VOKGVu
Z2luZS0+aTkxNSkgPj0gMTEpID8KKwkJSTkxNV9FTkdJTkVfSEFTX1JFTEFUSVZFX01NSU8gOiAw
OwogfQogCiBzdGF0aWMgdm9pZCBleGVjbGlzdHNfZGVzdHJveShzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUpCkBAIC0zMTMwLDggKzMxMzcsMTAgQEAgc3RhdGljIHZvaWQgZXhlY2xpc3Rz
X2luaXRfcmVnX3N0YXRlKHUzMiAqcmVncywKIAkJCQkgICAgIHN0cnVjdCBpbnRlbF9yaW5nICpy
aW5nKQogewogCXN0cnVjdCBpOTE1X3BwZ3R0ICpwcGd0dCA9IHZtX2FsaWFzKGNlLT52bSk7Ci0J
Ym9vbCByY3MgPSBlbmdpbmUtPmNsYXNzID09IFJFTkRFUl9DTEFTUzsKLQl1MzIgYmFzZSA9IGVu
Z2luZS0+bW1pb19iYXNlOworCWNvbnN0IGJvb2wgcmNzID0gZW5naW5lLT5jbGFzcyA9PSBSRU5E
RVJfQ0xBU1M7CisJY29uc3QgdTMyIGJhc2UgPSBlbmdpbmUtPm1taW9fYmFzZTsKKwljb25zdCB1
MzIgbHJpX2Jhc2UgPSBpbnRlbF9lbmdpbmVfaGFzX3JlbGF0aXZlX21taW8oZW5naW5lKSA/CisJ
CU1JX0xSSV9DU19NTUlPIDogMDsKIAogCS8qCiAJICogQSBjb250ZXh0IGlzIGFjdHVhbGx5IGEg
YmlnIGJhdGNoIGJ1ZmZlciB3aXRoIHNldmVyYWwKQEAgLTMxNDQsNyArMzE1Myw3IEBAIHN0YXRp
YyB2b2lkIGV4ZWNsaXN0c19pbml0X3JlZ19zdGF0ZSh1MzIgKnJlZ3MsCiAJICogTXVzdCBrZWVw
IGNvbnNpc3RlbnQgd2l0aCB2aXJ0dWFsX3VwZGF0ZV9yZWdpc3Rlcl9vZmZzZXRzKCkuCiAJICov
CiAJcmVnc1tDVFhfTFJJX0hFQURFUl8wXSA9IE1JX0xPQURfUkVHSVNURVJfSU1NKHJjcyA/IDE0
IDogMTEpIHwKLQkJCQkgTUlfTFJJX0ZPUkNFX1BPU1RFRDsKKwkJTUlfTFJJX0ZPUkNFX1BPU1RF
RCB8IGxyaV9iYXNlOwogCiAJQ1RYX1JFRyhyZWdzLCBDVFhfQ09OVEVYVF9DT05UUk9MLCBSSU5H
X0NPTlRFWFRfQ09OVFJPTChiYXNlKSwKIAkJX01BU0tFRF9CSVRfRElTQUJMRShDVFhfQ1RSTF9F
TkdJTkVfQ1RYX1JFU1RPUkVfSU5ISUJJVCkgfApAQCAtMzE5MSw3ICszMjAwLDggQEAgc3RhdGlj
IHZvaWQgZXhlY2xpc3RzX2luaXRfcmVnX3N0YXRlKHUzMiAqcmVncywKIAkJfQogCX0KIAotCXJl
Z3NbQ1RYX0xSSV9IRUFERVJfMV0gPSBNSV9MT0FEX1JFR0lTVEVSX0lNTSg5KSB8IE1JX0xSSV9G
T1JDRV9QT1NURUQ7CisJcmVnc1tDVFhfTFJJX0hFQURFUl8xXSA9CisJCU1JX0xPQURfUkVHSVNU
RVJfSU1NKDkpIHwgTUlfTFJJX0ZPUkNFX1BPU1RFRCB8IGxyaV9iYXNlOwogCiAJQ1RYX1JFRyhy
ZWdzLCBDVFhfQ1RYX1RJTUVTVEFNUCwgUklOR19DVFhfVElNRVNUQU1QKGJhc2UpLCAwKTsKIAkv
KiBQRFAgdmFsdWVzIHdlbGwgYmUgYXNzaWduZWQgbGF0ZXIgaWYgbmVlZGVkICovCkBAIC0zMjE4
LDcgKzMyMjgsNyBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfaW5pdF9yZWdfc3RhdGUodTMyICpy
ZWdzLAogCX0KIAogCWlmIChyY3MpIHsKLQkJcmVnc1tDVFhfTFJJX0hFQURFUl8yXSA9IE1JX0xP
QURfUkVHSVNURVJfSU1NKDEpOworCQlyZWdzW0NUWF9MUklfSEVBREVSXzJdID0gTUlfTE9BRF9S
RUdJU1RFUl9JTU0oMSkgfCBscmlfYmFzZTsKIAkJQ1RYX1JFRyhyZWdzLCBDVFhfUl9QV1JfQ0xL
X1NUQVRFLCBHRU44X1JfUFdSX0NMS19TVEFURSwgMCk7CiAJfQogCkBAIC0zNDExLDggKzM0MjEs
OSBAQCBzdGF0aWMgdm9pZCB2aXJ0dWFsX2VuZ2luZV9pbml0aWFsX2hpbnQoc3RydWN0IHZpcnR1
YWxfZW5naW5lICp2ZSkKIAkJcmV0dXJuOwogCiAJc3dhcCh2ZS0+c2libGluZ3Nbc3dwXSwgdmUt
PnNpYmxpbmdzWzBdKTsKLQl2aXJ0dWFsX3VwZGF0ZV9yZWdpc3Rlcl9vZmZzZXRzKHZlLT5jb250
ZXh0LmxyY19yZWdfc3RhdGUsCi0JCQkJCXZlLT5zaWJsaW5nc1swXSk7CisJaWYgKCFpbnRlbF9l
bmdpbmVfaGFzX3JlbGF0aXZlX21taW8odmUtPnNpYmxpbmdzWzBdKSkKKwkJdmlydHVhbF91cGRh
dGVfcmVnaXN0ZXJfb2Zmc2V0cyh2ZS0+Y29udGV4dC5scmNfcmVnX3N0YXRlLAorCQkJCQkJdmUt
PnNpYmxpbmdzWzBdKTsKIH0KIAogc3RhdGljIGludCB2aXJ0dWFsX2NvbnRleHRfcGluKHN0cnVj
dCBpbnRlbF9jb250ZXh0ICpjZSkKLS0gCjIuMTcuMQoKX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhA
bGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxt
YW4vbGlzdGluZm8vaW50ZWwtZ2Z4

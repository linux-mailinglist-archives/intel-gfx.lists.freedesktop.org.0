Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id A21B4DA6DF
	for <lists+intel-gfx@lfdr.de>; Thu, 17 Oct 2019 10:02:12 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id ADCF66E454;
	Thu, 17 Oct 2019 08:02:10 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id BD67C6E454
 for <intel-gfx@lists.freedesktop.org>; Thu, 17 Oct 2019 08:02:08 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18865344-1500050 
 for multiple; Thu, 17 Oct 2019 09:01:45 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 17 Oct 2019 09:01:44 +0100
Message-Id: <20191017080144.16899-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915/selftests: Add coverage of mocs
 registers
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UHJvYmUgdGhlIG1vY3MgcmVnaXN0ZXJzIGZvciBuZXcgY29udGV4dHMgYW5kIGFjcm9zcyBHUFUg
cmVzZXRzLiBTaW1pbGFyCnRvIGludGVsX3dvcmthcm91bmRzLCB3ZSBoYXZlIHRhYmxlcyBvZiB3
aGF0IHJlZ2lzdGVyIHZhbHVlcyB3ZSBleHBlY3QKdG8gc2VlLCBzbyB2ZXJpZnkgdGhhdCB1c2Vy
IGNvbnRleHRzIGFyZSBhZmZlY3RlZCBieSB0aGVtLiBJbiB0aGUKZnV0dXJlLCB3ZSBzaG91bGQg
YWRkIHRlc3RzIHNpbWlsYXIgdG8gaW50ZWxfc3NldSB0byBjb3ZlciBkeW5hbWljCnJlY29uZmln
dXJhdGlvbnMuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNv
bi5jby51az4KQ2M6IFByYXRoYXAgS3VtYXIgVmFsc2FuIDxwcmF0aGFwLmt1bWFyLnZhbHNhbkBp
bnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbW9jcy5jICAgICAg
ICAgIHwgICA0ICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X21vY3MuYyAgICAg
ICB8IDMwOSArKysrKysrKysrKysrKysrKysKIC4uLi9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9s
aXZlX3NlbGZ0ZXN0cy5oICB8ICAgMSArCiAzIGZpbGVzIGNoYW5nZWQsIDMxNCBpbnNlcnRpb25z
KCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rf
bW9jcy5jCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbW9jcy5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbW9jcy5jCmluZGV4IDViYWMzOTY2OTA2
Yi4uZjVhMjM5NjQwNTUzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9tb2NzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbW9jcy5jCkBAIC00
OTAsMyArNDkwLDcgQEAgdm9pZCBpbnRlbF9tb2NzX2luaXQoc3RydWN0IGludGVsX2d0ICpndCkK
IAlpZiAoSEFTX0dMT0JBTF9NT0NTX1JFR0lTVEVSUyhndC0+aTkxNSkpCiAJCWludGVsX21vY3Nf
aW5pdF9nbG9iYWwoZ3QpOwogfQorCisjaWYgSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfU0VM
RlRFU1QpCisjaW5jbHVkZSAic2VsZnRlc3RfbW9jcy5jIgorI2VuZGlmCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9tb2NzLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9zZWxmdGVzdF9tb2NzLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MDAwMDAwLi4wYWFjM2IxYWI4NDYKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9zZWxmdGVzdF9tb2NzLmMKQEAgLTAsMCArMSwzMDkgQEAKKy8qCisgKiBTUERYLUxp
Y2Vuc2UtSWRlbnRpZmllcjogTUlUCisgKgorICogQ29weXJpZ2h0IMKpIDIwMTkgSW50ZWwgQ29y
cG9yYXRpb24KKyAqLworCisjaW5jbHVkZSAiaTkxNV9zZWxmdGVzdC5oIgorCisjaW5jbHVkZSAi
Z2VtL3NlbGZ0ZXN0cy9tb2NrX2NvbnRleHQuaCIKKyNpbmNsdWRlICJzZWxmdGVzdHMvaWd0X3Jl
c2V0LmgiCisjaW5jbHVkZSAic2VsZnRlc3RzL2lndF9zcGlubmVyLmgiCisKK3N0cnVjdCBsaXZl
X21vY3MgeworCXN0cnVjdCBkcm1faTkxNV9tb2NzX3RhYmxlIHRhYmxlOworCXN0cnVjdCBpOTE1
X2dlbV9jb250ZXh0ICpjdHg7CisJc3RydWN0IGk5MTVfdm1hICpzY3JhdGNoOworCXZvaWQgKnZh
ZGRyOworfTsKKworc3RhdGljIGludCByZXF1ZXN0X2FkZF9zeW5jKHN0cnVjdCBpOTE1X3JlcXVl
c3QgKnJxLCBpbnQgZXJyKQoreworCWk5MTVfcmVxdWVzdF9nZXQocnEpOworCWk5MTVfcmVxdWVz
dF9hZGQocnEpOworCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgSFogLyA1KSA8IDApCisJ
CWVyciA9IC1FVElNRTsKKwlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKKworCXJldHVybiBlcnI7Cit9
CisKK3N0YXRpYyBpbnQgcmVxdWVzdF9hZGRfc3BpbihzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwg
c3RydWN0IGlndF9zcGlubmVyICpzcGluKQoreworCWludCBlcnIgPSAwOworCisJaTkxNV9yZXF1
ZXN0X2dldChycSk7CisJaTkxNV9yZXF1ZXN0X2FkZChycSk7CisJaWYgKHNwaW4gJiYgIWlndF93
YWl0X2Zvcl9zcGlubmVyKHNwaW4sIHJxKSkKKwkJZXJyID0gLUVUSU1FOworCWk5MTVfcmVxdWVz
dF9wdXQocnEpOworCisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIHN0cnVjdCBpOTE1X3ZtYSAq
Y3JlYXRlX3NjcmF0Y2goc3RydWN0IGludGVsX2d0ICpndCkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqOworCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOworCWludCBlcnI7CisKKwlv
YmogPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX2ludGVybmFsKGd0LT5pOTE1LCBQQUdFX1NJWkUp
OworCWlmIChJU19FUlIob2JqKSkKKwkJcmV0dXJuIEVSUl9DQVNUKG9iaik7CisKKwlpOTE1X2dl
bV9vYmplY3Rfc2V0X2NhY2hlX2NvaGVyZW5jeShvYmosIEk5MTVfQ0FDSElOR19DQUNIRUQpOwor
CisJdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uob2JqLCAmZ3QtPmdndHQtPnZtLCBOVUxMKTsKKwlp
ZiAoSVNfRVJSKHZtYSkpIHsKKwkJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOworCQlyZXR1cm4g
dm1hOworCX0KKworCWVyciA9IGk5MTVfdm1hX3Bpbih2bWEsIDAsIDAsIFBJTl9HTE9CQUwpOwor
CWlmIChlcnIpIHsKKwkJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOworCQlyZXR1cm4gRVJSX1BU
UihlcnIpOworCX0KKworCXJldHVybiB2bWE7Cit9CisKK3N0YXRpYyBpbnQgbGl2ZV9tb2NzX2lu
aXQoc3RydWN0IGxpdmVfbW9jcyAqYXJnLCBzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQoreworCWludCBl
cnI7CisKKwlpZiAoIWdldF9tb2NzX3NldHRpbmdzKGd0LT5pOTE1LCAmYXJnLT50YWJsZSkpCisJ
CXJldHVybiAtRUlOVkFMOworCisJYXJnLT5jdHggPSBrZXJuZWxfY29udGV4dChndC0+aTkxNSk7
CisJaWYgKCFhcmctPmN0eCkKKwkJcmV0dXJuIC1FTk9NRU07CisKKwlhcmctPnNjcmF0Y2ggPSBj
cmVhdGVfc2NyYXRjaChndCk7CisJaWYgKElTX0VSUihhcmctPnNjcmF0Y2gpKSB7CisJCWVyciA9
IFBUUl9FUlIoYXJnLT5zY3JhdGNoKTsKKwkJZ290byBlcnJfY3R4OworCX0KKworCWFyZy0+dmFk
ZHIgPSBpOTE1X2dlbV9vYmplY3RfcGluX21hcChhcmctPnNjcmF0Y2gtPm9iaiwgSTkxNV9NQVBf
V0IpOworCWlmIChJU19FUlIoYXJnLT52YWRkcikpIHsKKwkJZXJyID0gUFRSX0VSUihhcmctPnZh
ZGRyKTsKKwkJZ290byBlcnJfc2NyYXRjaDsKKwl9CisKKwlyZXR1cm4gMDsKKworZXJyX3NjcmF0
Y2g6CisJaTkxNV92bWFfcHV0KGFyZy0+c2NyYXRjaCk7CitlcnJfY3R4OgorCWtlcm5lbF9jb250
ZXh0X2Nsb3NlKGFyZy0+Y3R4KTsKKwlyZXR1cm4gZXJyOworfQorCitzdGF0aWMgdm9pZCBsaXZl
X21vY3NfZmluaShzdHJ1Y3QgbGl2ZV9tb2NzICphcmcpCit7CisJaTkxNV92bWFfdW5waW5fYW5k
X3JlbGVhc2UoJmFyZy0+c2NyYXRjaCwgSTkxNV9WTUFfUkVMRUFTRV9NQVApOworCWtlcm5lbF9j
b250ZXh0X2Nsb3NlKGFyZy0+Y3R4KTsKK30KKworc3RhdGljIGludCByZWFkX21vY3NfdGFibGUo
c3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCisJCQkgICBjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfbW9j
c190YWJsZSAqdGFibGUsCisJCQkgICBzdHJ1Y3QgaTkxNV92bWEgKnZtYSkKK3sKKwl1bnNpZ25l
ZCBpbnQgaTsKKwlpbnQgZXJyOworCXUzMiAqY3M7CisKKwlpOTE1X3ZtYV9sb2NrKHZtYSk7CisJ
ZXJyID0gaTkxNV9yZXF1ZXN0X2F3YWl0X29iamVjdChycSwgdm1hLT5vYmosIHRydWUpOworCWlm
ICghZXJyKQorCQllcnIgPSBpOTE1X3ZtYV9tb3ZlX3RvX2FjdGl2ZSh2bWEsIHJxLCBFWEVDX09C
SkVDVF9XUklURSk7CisJaTkxNV92bWFfdW5sb2NrKHZtYSk7CisJaWYgKGVycikKKwkJcmV0dXJu
IGVycjsKKworCWNzID0gaW50ZWxfcmluZ19iZWdpbihycSwgNCAqIHRhYmxlLT5uX2VudHJpZXMp
OworCWlmIChJU19FUlIoY3MpKQorCQlyZXR1cm4gUFRSX0VSUihjcyk7CisKKwlmb3IgKGkgPSAw
OyBpIDwgdGFibGUtPm5fZW50cmllczsgaSsrKSB7CisJCSpjcysrID0gTUlfU1RPUkVfUkVHSVNU
RVJfTUVNX0dFTjggfCBNSV9VU0VfR0dUVDsKKwkJKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNl
dChIQVNfR0xPQkFMX01PQ1NfUkVHSVNURVJTKHJxLT5pOTE1KSA/CisJCQkJCSAgICAgR0VOMTJf
R0xPQkFMX01PQ1MoaSkgOgorCQkJCQkgICAgIG1vY3NfcmVnaXN0ZXIocnEtPmVuZ2luZSwgaSkp
OworCQkqY3MrKyA9IGk5MTVfZ2d0dF9vZmZzZXQodm1hKSArIGkgKiBzaXplb2YodTMyKTsKKwkJ
KmNzKysgPSAwOworCX0KKworCWludGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOworCisJcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyBpbnQgY2hlY2tfbW9jc190YWJsZShzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUsCisJCQkgICAgY29uc3Qgc3RydWN0IGRybV9pOTE1X21vY3NfdGFibGUgKnRh
YmxlLAorCQkJICAgIGNvbnN0IHUzMiAqdmFkZHIpCit7CisJdW5zaWduZWQgaW50IGk7CisJdTMy
IGV4cGVjdDsKKworCWZvciAoaSA9IDA7IGkgPCB0YWJsZS0+c2l6ZTsgaSsrKSB7CisJCWlmIChI
QVNfR0xPQkFMX01PQ1NfUkVHSVNURVJTKGVuZ2luZS0+aTkxNSkpCisJCQlleHBlY3QgPSB0YWJs
ZS0+dGFibGVbaV0uY29udHJvbF92YWx1ZTsKKwkJZWxzZQorCQkJZXhwZWN0ID0gZ2V0X2VudHJ5
X2NvbnRyb2wodGFibGUsIGkpOworCisJCWlmICh2YWRkcltpXSAhPSBleHBlY3QpIHsKKwkJCXBy
X2VycigiJXM6IEludmFsaWQgTU9DU1slZF0gZW50cnksIGZvdW5kICUwOHgsIGV4cGVjdGVkICUw
OHhcbiIsCisJCQkgICAgICAgZW5naW5lLT5uYW1lLCBpLCB2YWRkcltpXSwgZXhwZWN0KTsKKwkJ
CXJldHVybiAtRUlOVkFMOworCQl9CisJfQorCisJLyogQWxsIHJlbWFpbmluZyBlbnRyaWVzIGFy
ZSBkZWZhdWx0ICovCisJaWYgKEhBU19HTE9CQUxfTU9DU19SRUdJU1RFUlMoZW5naW5lLT5pOTE1
KSkKKwkJZXhwZWN0ID0gdGFibGUtPnRhYmxlWzBdLmNvbnRyb2xfdmFsdWU7CisJZWxzZQorCQll
eHBlY3QgPSB0YWJsZS0+dGFibGVbSTkxNV9NT0NTX1BURV0uY29udHJvbF92YWx1ZTsKKwlmb3Ig
KDsgaSA8IHRhYmxlLT5uX2VudHJpZXM7IGkrKykgeworCQlpZiAodmFkZHJbaV0gIT0gZXhwZWN0
KSB7CisJCQlwcl9lcnIoIiVzOiBJbnZhbGlkIE1PQ1NbJWQqXSBlbnRyeSwgZm91bmQgJTA4eCwg
ZXhwZWN0ZWQgJTA4eFxuIiwKKwkJCSAgICAgICBlbmdpbmUtPm5hbWUsIGksIHZhZGRyW2ldLCBl
eHBlY3QpOworCQkJcmV0dXJuIC1FSU5WQUw7CisJCX0KKwl9CisKKwlyZXR1cm4gMDsKK30KKwor
c3RhdGljIGludCBjaGVja19tb2NzX2VuZ2luZShzdHJ1Y3QgbGl2ZV9tb2NzICphcmcsCisJCQkg
ICAgIHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKK3sKKwlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpy
cTsKKwlpbnQgZXJyOworCisJbWVtc2V0MzIoYXJnLT52YWRkciwgU1RBQ0tfTUFHSUMsIFBBR0Vf
U0laRS9zaXplb2YodTMyKSk7CisKKwlycSA9IGludGVsX2NvbnRleHRfY3JlYXRlX3JlcXVlc3Qo
Y2UpOworCWlmIChJU19FUlIocnEpKQorCQlyZXR1cm4gUFRSX0VSUihycSk7CisKKwllcnIgPSBy
ZWFkX21vY3NfdGFibGUocnEsICZhcmctPnRhYmxlLCBhcmctPnNjcmF0Y2gpOworCisJZXJyID0g
cmVxdWVzdF9hZGRfc3luYyhycSwgZXJyKTsKKwlpZihlcnIpCisJCXJldHVybiBlcnI7CisKKwly
ZXR1cm4gY2hlY2tfbW9jc190YWJsZShjZS0+ZW5naW5lLCAmYXJnLT50YWJsZSwgYXJnLT52YWRk
cik7Cit9CisKK3N0YXRpYyBpbnQgbGl2ZV9tb2NzX2NsZWFuKHZvaWQgKmFyZykKK3sKKwlzdHJ1
Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOworCXN0cnVjdCBpOTE1X2dlbV9lbmdpbmVzX2l0ZXIgaXQ7
CisJc3RydWN0IGludGVsX2NvbnRleHQgKmNlOworCXN0cnVjdCBsaXZlX21vY3MgbW9jczsKKwlp
bnQgZXJyOworCisJZXJyID0gbGl2ZV9tb2NzX2luaXQoJm1vY3MsIGd0KTsKKwlpZiAoZXJyKQor
CQlyZXR1cm4gZXJyOworCisJLyogWFhYIGZvcl9lYWNoX2VuZ2luZShndCkgb25jZSB3ZSBjYW4g
Y3JlYXRlIHJhdyBpbnRlbF9jb250ZXh0ICovCisJZm9yX2VhY2hfZ2VtX2VuZ2luZShjZSwgaTkx
NV9nZW1fY29udGV4dF9lbmdpbmVzKG1vY3MuY3R4KSwgaXQpIHsKKwkJZXJyID0gY2hlY2tfbW9j
c19lbmdpbmUoJm1vY3MsIGNlKTsKKwkJaWYgKGVycikKKwkJCWJyZWFrOworCX0KKwlpOTE1X2dl
bV9jb250ZXh0X3VubG9ja19lbmdpbmVzKG1vY3MuY3R4KTsKKworCWxpdmVfbW9jc19maW5pKCZt
b2NzKTsKKworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBpbnQgYWN0aXZlX2VuZ2luZV9yZXNl
dChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCisJCQkgICAgICAgY29uc3QgY2hhciAqcmVhc29u
KQoreworCXN0cnVjdCBpZ3Rfc3Bpbm5lciBzcGluOworCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJx
OworCWludCBlcnI7CisKKwllcnIgPSBpZ3Rfc3Bpbm5lcl9pbml0KCZzcGluLCBjZS0+ZW5naW5l
LT5ndCk7CisJaWYgKGVycikKKwkJcmV0dXJuIGVycjsKKworCXJxID0gaWd0X3NwaW5uZXJfY3Jl
YXRlX3JlcXVlc3QoJnNwaW4sIGNlLCBNSV9OT09QKTsKKwlpZiAoSVNfRVJSKHJxKSkgeworCQlp
Z3Rfc3Bpbm5lcl9maW5pKCZzcGluKTsKKwkJcmV0dXJuIFBUUl9FUlIocnEpOworCX0KKworCWVy
ciA9IHJlcXVlc3RfYWRkX3NwaW4ocnEsICZzcGluKTsKKwlpZiAoZXJyID09IDApCisJCWVyciA9
IGludGVsX2VuZ2luZV9yZXNldChjZS0+ZW5naW5lLCByZWFzb24pOworCisJaWd0X3NwaW5uZXJf
ZW5kKCZzcGluKTsKKwlpZ3Rfc3Bpbm5lcl9maW5pKCZzcGluKTsKKworCXJldHVybiBlcnI7CisK
K30KK3N0YXRpYyBpbnQgbGl2ZV9tb2NzX3Jlc2V0KHZvaWQgKmFyZykKK3sKKwlzdHJ1Y3QgaW50
ZWxfZ3QgKmd0ID0gYXJnOworCXN0cnVjdCBpOTE1X2dlbV9lbmdpbmVzX2l0ZXIgaXQ7CisJc3Ry
dWN0IGludGVsX2NvbnRleHQgKmNlOworCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOworCXN0cnVj
dCBsaXZlX21vY3MgbW9jczsKKwlpbnQgZXJyID0gMDsKKworCWlmICghaW50ZWxfaGFzX3Jlc2V0
X2VuZ2luZShndCkpCisJCXJldHVybiAwOworCisJZXJyID0gbGl2ZV9tb2NzX2luaXQoJm1vY3Ms
IGd0KTsKKwlpZiAoZXJyKQorCQlyZXR1cm4gZXJyOworCisJaWd0X2dsb2JhbF9yZXNldF9sb2Nr
KGd0KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZ3QtPnVuY29yZS0+cnBtKTsK
KworCWZvcl9lYWNoX2dlbV9lbmdpbmUoY2UsIGk5MTVfZ2VtX2NvbnRleHRfZW5naW5lcyhtb2Nz
LmN0eCksIGl0KSB7CisJCWVyciA9IGludGVsX2VuZ2luZV9yZXNldChjZS0+ZW5naW5lLCAibW9j
cyIpOworCQlpZiAoZXJyKQorCQkJYnJlYWs7CisKKwkJZXJyID0gY2hlY2tfbW9jc19lbmdpbmUo
Jm1vY3MsIGNlKTsKKwkJaWYgKGVycikKKwkJCWJyZWFrOworCisJCWVyciA9IGFjdGl2ZV9lbmdp
bmVfcmVzZXQoY2UsICJtb2NzIik7CisJCWlmIChlcnIpCisJCQlicmVhazsKKworCQllcnIgPSBj
aGVja19tb2NzX2VuZ2luZSgmbW9jcywgY2UpOworCQlpZiAoZXJyKQorCQkJYnJlYWs7CisJfQor
CWk5MTVfZ2VtX2NvbnRleHRfdW5sb2NrX2VuZ2luZXMobW9jcy5jdHgpOworCisJaW50ZWxfcnVu
dGltZV9wbV9wdXQoZ3QtPnVuY29yZS0+cnBtLCB3YWtlcmVmKTsKKwlpZ3RfZ2xvYmFsX3Jlc2V0
X3VubG9jayhndCk7CisKKwlsaXZlX21vY3NfZmluaSgmbW9jcyk7CisJcmV0dXJuIGVycjsKK30K
KworaW50IGludGVsX21vY3NfbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCit7CisJc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3N1YnRlc3QgdGVzdHNbXSA9IHsK
KwkJU1VCVEVTVChsaXZlX21vY3NfY2xlYW4pLAorCQlTVUJURVNUKGxpdmVfbW9jc19yZXNldCks
CisJfTsKKwlzdHJ1Y3QgZHJtX2k5MTVfbW9jc190YWJsZSB0YWJsZTsKKworCWlmICghZ2V0X21v
Y3Nfc2V0dGluZ3MoaTkxNSwgJnRhYmxlKSkKKwkJcmV0dXJuIDA7CisKKwlyZXR1cm4gaW50ZWxf
Z3RfbGl2ZV9zdWJ0ZXN0cyh0ZXN0cywgJmk5MTUtPmd0KTsKK30KZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2xpdmVfc2VsZnRlc3RzLmggYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9saXZlX3NlbGZ0ZXN0cy5oCmluZGV4IDZkYWY2
NTk5ZWM3OS4uMWE2YWJjZmZjZTgxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9z
ZWxmdGVzdHMvaTkxNV9saXZlX3NlbGZ0ZXN0cy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L3NlbGZ0ZXN0cy9pOTE1X2xpdmVfc2VsZnRlc3RzLmgKQEAgLTE2LDYgKzE2LDcgQEAgc2VsZnRl
c3QoZ3RfZW5naW5lcywgaW50ZWxfZW5naW5lX2xpdmVfc2VsZnRlc3RzKQogc2VsZnRlc3QoZ3Rf
dGltZWxpbmVzLCBpbnRlbF90aW1lbGluZV9saXZlX3NlbGZ0ZXN0cykKIHNlbGZ0ZXN0KGd0X2Nv
bnRleHRzLCBpbnRlbF9jb250ZXh0X2xpdmVfc2VsZnRlc3RzKQogc2VsZnRlc3QoZ3RfbHJjLCBp
bnRlbF9scmNfbGl2ZV9zZWxmdGVzdHMpCitzZWxmdGVzdChndF9tb2NzLCBpbnRlbF9tb2NzX2xp
dmVfc2VsZnRlc3RzKQogc2VsZnRlc3QoZ3RfcG0sIGludGVsX2d0X3BtX2xpdmVfc2VsZnRlc3Rz
KQogc2VsZnRlc3QocmVxdWVzdHMsIGk5MTVfcmVxdWVzdF9saXZlX3NlbGZ0ZXN0cykKIHNlbGZ0
ZXN0KGFjdGl2ZSwgaTkxNV9hY3RpdmVfbGl2ZV9zZWxmdGVzdHMpCi0tIAoyLjIzLjAKCl9fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWls
aW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZy
ZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

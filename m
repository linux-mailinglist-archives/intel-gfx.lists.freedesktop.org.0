Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8A5E1BB5E6
	for <lists+intel-gfx@lfdr.de>; Mon, 23 Sep 2019 15:58:37 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CC4C86E920;
	Mon, 23 Sep 2019 13:58:35 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga02.intel.com (mga02.intel.com [134.134.136.20])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B0DAD6E920
 for <intel-gfx@lists.freedesktop.org>; Mon, 23 Sep 2019 13:58:34 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga004.fm.intel.com ([10.253.24.48])
 by orsmga101.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 23 Sep 2019 06:58:34 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,540,1559545200"; d="scan'208";a="213335893"
Received: from kgalazka-mobl.ger.corp.intel.com (HELO [10.252.3.235])
 ([10.252.3.235])
 by fmsmga004.fm.intel.com with ESMTP; 23 Sep 2019 06:58:33 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20190921095542.23205-1-chris@chris-wilson.co.uk>
 <20190921095542.23205-3-chris@chris-wilson.co.uk>
 <7386c6e5-96df-5f57-0b9a-214787cdad57@linux.intel.com>
 <156924595998.29097.6410793778914589365@skylake-alporthouse-com>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <066a69ee-4fa2-d6c7-46e2-c4ab0a46d076@linux.intel.com>
Date: Mon, 23 Sep 2019 14:58:32 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <156924595998.29097.6410793778914589365@skylake-alporthouse-com>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH 3/5] drm/i915: Fixup preempt-to-busy vs
 resubmission of a virtual request
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDIzLzA5LzIwMTkgMTQ6MzksIENocmlzIFdpbHNvbiB3cm90ZToKPiBRdW90aW5nIFR2cnRr
byBVcnN1bGluICgyMDE5LTA5LTIzIDE0OjMyOjIzKQo+Pgo+PiBPbiAyMS8wOS8yMDE5IDEwOjU1
LCBDaHJpcyBXaWxzb24gd3JvdGU6Cj4+PiBBcyBwcmVlbXB0LXRvLWJ1c3kgbGVhdmVzIHRoZSBy
ZXF1ZXN0IG9uIHRoZSBIVyBhcyB0aGUgcmVzdWJtaXNzaW9uIGlzCj4+PiBwcm9jZXNzZWQsIHRo
YXQgcmVxdWVzdCBtYXkgY29tcGxldGUgaW4gdGhlIGJhY2tncm91bmQgYW5kIGV2ZW4gY2F1c2Ug
YQo+Pj4gc2Vjb25kIHZpcnR1YWwgcmVxdWVzdCB0byBlbnRlciBxdWV1ZS4gVGhpcyBzZWNvbmQg
dmlydHVhbCByZXF1ZXN0Cj4+PiBicmVha3Mgb3VyICJzaW5nbGUgcmVxdWVzdCBpbiB0aGUgdmly
dHVhbCBwaXBlbGluZSIgYXNzdW1wdGlvbnMuCj4+PiBGdXJ0aGVybW9yZSwgYXMgdGhlIHZpcnR1
YWwgcmVxdWVzdCBtYXkgYmUgY29tcGxldGVkIGFuZCByZXRpcmVkLCB3ZQo+Pj4gbG9zZSB0aGUg
cmVmZXJlbmNlIHRoZSB2aXJ0dWFsIGVuZ2luZSBhc3N1bWVzIGlzIGhlbGQuIE5vcm1hbGx5LCBq
dXN0Cj4+PiByZW1vdmluZyB0aGUgcmVxdWVzdCBmcm9tIHRoZSBzY2hlZHVsZXIgcXVldWUgcmVt
b3ZlcyBpdCBmcm9tIHRoZQo+Pj4gZW5naW5lLCBidXQgdGhlIHZpcnR1YWwgZW5naW5lIGtlZXBz
IHRyYWNrIG9mIGl0cyBzaW5nbGV0b24gcmVxdWVzdCB2aWEKPj4+IGl0cyB2ZS0+cmVxdWVzdC4g
VGhpcyBwb2ludGVyIG5lZWRzIHByb3RlY3Rpbmcgd2l0aCBhIHJlZmVyZW5jZS4KPj4+Cj4+PiBG
aXhlczogMjJiN2E0MjZiYmUxICgiZHJtL2k5MTUvZXhlY2xpc3RzOiBQcmVlbXB0LXRvLWJ1c3ki
KQo+Pj4gU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28u
dWs+Cj4+PiBDYzogTWlrYSBLdW9wcGFsYSA8bWlrYS5rdW9wcGFsYUBsaW51eC5pbnRlbC5jb20+
Cj4+PiBDYzogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KPj4+IC0t
LQo+Pj4gICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMgfCAzNCArKysrKysr
KysrKysrKysrKysrKysrLS0tLS0tLQo+Pj4gICAgMSBmaWxlIGNoYW5nZWQsIDI2IGluc2VydGlv
bnMoKyksIDggZGVsZXRpb25zKC0pCj4+Pgo+Pj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2xyYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJj
LmMKPj4+IGluZGV4IDUzYmM0MzA4NzkzYy4uMWIyYmFjYzYwMzAwIDEwMDY0NAo+Pj4gLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKPj4+ICsrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCj4+PiBAQCAtNTI5LDcgKzUyOSw2IEBAIF9fdW53aW5k
X2luY29tcGxldGVfcmVxdWVzdHMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+Pj4g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGk5MTVfcmVxdWVzdF9jYW5jZWxfYnJlYWRj
cnVtYihycSk7Cj4+PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Bpbl91bmxvY2so
JnJxLT5sb2NrKTsKPj4+ICAgICAgICAgICAgICAgICAgICAgICAgfQo+Pj4gLSAgICAgICAgICAg
ICAgICAgICAgIHJxLT5lbmdpbmUgPSBvd25lcjsKPj4+ICAgICAgICAgICAgICAgICAgICAgICAg
b3duZXItPnN1Ym1pdF9yZXF1ZXN0KHJxKTsKPj4+ICAgICAgICAgICAgICAgICAgICAgICAgYWN0
aXZlID0gTlVMTDsKPj4+ICAgICAgICAgICAgICAgIH0KPj4+IEBAIC0xMjQ4LDYgKzEyNDcsNyBA
QCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfZGVxdWV1ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUpCj4+PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VibWl0ID0gdHJ1ZTsK
Pj4+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0ID0gcnE7Cj4+PiAgICAgICAg
ICAgICAgICAgICAgICAgIH0KPj4+ICsgICAgICAgICAgICAgICAgICAgICBpOTE1X3JlcXVlc3Rf
cHV0KHJxKTsKPj4+ICAgIAo+Pj4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXN1Ym1pdCkg
ewo+Pj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwaW5fdW5sb2NrKCZ2ZS0+YmFz
ZS5hY3RpdmUubG9jayk7Cj4+PiBAQCAtMjUzNSw2ICsyNTM1LDcgQEAgc3RhdGljIHZvaWQgZXhl
Y2xpc3RzX2NhbmNlbF9yZXF1ZXN0cyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4+
PiAgICAKPj4+ICAgICAgICAgICAgICAgICAgICAgICAgcnEtPmVuZ2luZSA9IGVuZ2luZTsKPj4+
ICAgICAgICAgICAgICAgICAgICAgICAgX19pOTE1X3JlcXVlc3Rfc3VibWl0KHJxKTsKPj4+ICsg
ICAgICAgICAgICAgICAgICAgICBpOTE1X3JlcXVlc3RfcHV0KHJxKTsKPj4+ICAgIAo+Pj4gICAg
ICAgICAgICAgICAgICAgICAgICB2ZS0+YmFzZS5leGVjbGlzdHMucXVldWVfcHJpb3JpdHlfaGlu
dCA9IElOVF9NSU47Cj4+PiAgICAgICAgICAgICAgICB9Cj4+PiBAQCAtMzc4Nyw3ICszNzg4LDkg
QEAgc3RhdGljIHZvaWQgdmlydHVhbF9zdWJtaXNzaW9uX3Rhc2tsZXQodW5zaWduZWQgbG9uZyBk
YXRhKQo+Pj4gICAgCj4+PiAgICBzdGF0aWMgdm9pZCB2aXJ0dWFsX3N1Ym1pdF9yZXF1ZXN0KHN0
cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQo+Pj4gICAgewo+Pj4gLSAgICAgc3RydWN0IHZpcnR1YWxf
ZW5naW5lICp2ZSA9IHRvX3ZpcnR1YWxfZW5naW5lKHJxLT5lbmdpbmUpOwo+Pj4gKyAgICAgc3Ry
dWN0IHZpcnR1YWxfZW5naW5lICp2ZSA9IHRvX3ZpcnR1YWxfZW5naW5lKHJxLT5od19jb250ZXh0
LT5lbmdpbmUpOwo+Pj4gKyAgICAgc3RydWN0IGk5MTVfcmVxdWVzdCAqc3RhbGU7Cj4+PiArICAg
ICB1bnNpZ25lZCBsb25nIGZsYWdzOwo+Pj4gICAgCj4+PiAgICAgICAgR0VNX1RSQUNFKCIlczog
cnE9JWxseDolbGxkXG4iLAo+Pj4gICAgICAgICAgICAgICAgICB2ZS0+YmFzZS5uYW1lLAo+Pj4g
QEAgLTM3OTYsMTUgKzM3OTksMzAgQEAgc3RhdGljIHZvaWQgdmlydHVhbF9zdWJtaXRfcmVxdWVz
dChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKPj4+ICAgIAo+Pj4gICAgICAgIEdFTV9CVUdfT04o
dmUtPmJhc2Uuc3VibWl0X3JlcXVlc3QgIT0gdmlydHVhbF9zdWJtaXRfcmVxdWVzdCk7Cj4+PiAg
ICAKPj4+IC0gICAgIEdFTV9CVUdfT04odmUtPnJlcXVlc3QpOwo+Pj4gLSAgICAgR0VNX0JVR19P
TighbGlzdF9lbXB0eSh2aXJ0dWFsX3F1ZXVlKHZlKSkpOwo+Pj4gKyAgICAgc3Bpbl9sb2NrX2ly
cXNhdmUoJnZlLT5iYXNlLmFjdGl2ZS5sb2NrLCBmbGFncyk7Cj4+PiArCj4+PiArICAgICBzdGFs
ZSA9IHZlLT5yZXF1ZXN0Owo+Pgo+PiBmZXRjaF9hbmRfemVybyBzbyB5b3UgZG9uJ3QgaGF2ZSB0
byBzZXQgaXQgdG8gTlVMTCBhIGJpdCBsb3dlcj8KPiAKPiBJIGl0ZXJhdGVkIHRocm91Z2ggeGNo
ZyB0aGVuIGZldGNoX2FuZF96ZXJvLCBiZWZvcmUgc2V0dGxpbmcgb24gdGhpcwo+IHZhcmlhbnQu
IE15IGZlZWxpbmcgd2FzIHNldHRpbmcgdmUtPnJlcXVlc3QgaW4gYm90aCBzaWRlcyBvZiB0aGUg
aWYoKQo+IHdhcyBtb3JlIGJhbGFuY2VkLgoKT2suCgo+IAo+PiBzL3N0YWxlL2NvbXBsZXRlZC8s
IHBsdXMgYSBjb21tZW50IGRlc2NyaWJpbmcgcHJlZW1wdC10by1idXN5IGlzIHRvIGJsYW1lPwo+
IAo+IGNvbXBsZXRlZCBpcyBhIGxpdHRsZSBsb25nLCBvbGQ/IEFscmVhZHkgYWRkZWQgYSBjb21t
ZW50IHRvIHJlbWluZCBhYm91dAo+IHRoZSBwcmVlbXB0LXRvLWJ1c3kgbGluayA6KQoKSSBkaXNs
aWtlZCBzdGFsZSBzaW5jZSBpdCBoYXMgbmVnYXRpdmUgY29ubm90YXRpb25zIGFuZCB0aGlzIGlz
IGFjdHVhbGx5IApub3JtYWwvZXhwZWN0ZWQgc2l0dWF0aW9uIChhbGJlaXQgcmFyZSksIGJ1dCBt
YXliZSBpdCdzIGp1c3QgbWUuIE9sZCBpcyAKcGVyaGFwcyBiZXR0ZXIuIEJ1dCB5b3UgY2FuIGFs
c28ga2VlcCBzdGFsZSBJIGd1ZXNzLgoKPj4+ICsgICAgIGlmIChzdGFsZSkgewo+Pj4gKyAgICAg
ICAgICAgICBHRU1fQlVHX09OKCFpOTE1X3JlcXVlc3RfY29tcGxldGVkKHN0YWxlKSk7Cj4+PiAr
ICAgICAgICAgICAgIF9faTkxNV9yZXF1ZXN0X3N1Ym1pdChzdGFsZSk7Cj4+PiArICAgICAgICAg
ICAgIGk5MTVfcmVxdWVzdF9wdXQoc3RhbGUpOwo+Pj4gKyAgICAgfQo+Pj4gKwo+Pj4gKyAgICAg
aWYgKGk5MTVfcmVxdWVzdF9jb21wbGV0ZWQocnEpKSB7Cj4+PiArICAgICAgICAgICAgIF9faTkx
NV9yZXF1ZXN0X3N1Ym1pdChycSk7Cj4+PiArICAgICAgICAgICAgIHZlLT5yZXF1ZXN0ID0gTlVM
TDsKPj4+ICsgICAgIH0gZWxzZSB7Cj4+PiArICAgICAgICAgICAgIHZlLT5iYXNlLmV4ZWNsaXN0
cy5xdWV1ZV9wcmlvcml0eV9oaW50ID0gcnFfcHJpbyhycSk7Cj4+PiArICAgICAgICAgICAgIHZl
LT5yZXF1ZXN0ID0gaTkxNV9yZXF1ZXN0X2dldChycSk7Cj4+PiArICAgICAgICAgICAgIHJxLT5l
bmdpbmUgPSAmdmUtPmJhc2U7IC8qIGZpeHVwIGZyb20gdW53aW5kICovCj4+Cj4+IFRoZSBsYXN0
IGxpbmUgaGFzIG1lIGNvbmZ1c2VkLiBJc24ndCB0aGlzIHRoZSBub3JtYWwgdmVuZyBycSBzdWJt
aXNzaW9uCj4+IHBhdGg/Cj4gCj4gSXQgaXMgYWxzbyBvbiB0aGUgbm9ybWFsIHN1Ym1pc3Npb24g
cGF0aC4KPiAKPj4gSW4gd2hpY2ggY2FzZSBycS0+ZW5naW5lIHdpbGwgYWxyZWFkeSBiZSBzZXQg
dG8gdmVuZy4KPiAKPiBZZXMKPiAKPj4gQnV0IG9uIHRoZQo+PiB1bndpbmQgcGF0aCB5b3UgaGF2
ZSByZW1vdmVkIHJlc2V0LWJhY2sgb2YgcnEtPmVuZ2luZSB0byBvd25lci4gQWguLiB0aGUKPj4g
dW53aW5kIGNhbGxzIHZlbmctPnN1Ym1pdF9yZXF1ZXN0IG9uIGl0LCBhbmQgdGhlbiB3ZSBlbmQg
dXAgaW4gaGVyZS4uCj4+IE9rYXksIHRoaXMgaXMgb3V0c2lkZSB0aGUgbm9ybWFsIHBhdGgsIEkg
bWVhbiB0aGUgZWxzZSBibG9jayBoYXMgdHdvCj4+IGZ1bmN0aW9ucy9wYXRocywgYW5kIHRoaXMg
c2hvdWxkIGJlIGV4cGxhaW5lZCBpbiBhIGNvbW1lbnQuCj4gCj4gVGhhdCB3YXMgdGhlIGludGVu
dCBvZiAiZml4dXAgZnJvbSB1bndpbmQ/Igo+IAo+IEkgY2FuIHNxdWVlemUgaW4gLyogZml4dXAg
X191bndpbmRfaW5jb21wbGV0ZV9yZXF1ZXN0cyAqLyBpcyB0aGF0IG1vcmUKPiBjbHVlZnVsPyBP
ciBkbyB5b3UgdGhpbmsgaXQgbmVlZHMgbW9yZT8KCkkgdGhvdWdodCBpdCBkb2VzLCBidXQgdGhl
biBJIGRpZCBub3Qga25vdyB3aGF0IEkgd291bGQgd3JpdGUgc28gaXQncyAKdXNlZnVsLiBTbyBJ
IHRoaW5rIGl0J3MgZmluZSBhZnRlciBhbGwuCgpSZXZpZXdlZC1ieTogVHZydGtvIFVyc3VsaW4g
PHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KClJlZ2FyZHMsCgpUdnJ0a28KCj4gLUNocmlzCj4g
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdm
eCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xp
c3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

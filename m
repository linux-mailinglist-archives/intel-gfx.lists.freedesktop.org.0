Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 6529557D9D
	for <lists+intel-gfx@lfdr.de>; Thu, 27 Jun 2019 10:01:19 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3F9F66E82E;
	Thu, 27 Jun 2019 08:01:17 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga18.intel.com (mga18.intel.com [134.134.136.126])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9AC576E82F
 for <intel-gfx@lists.freedesktop.org>; Thu, 27 Jun 2019 08:01:02 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga004.jf.intel.com ([10.7.209.38])
 by orsmga106.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 27 Jun 2019 01:01:02 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,423,1557212400"; d="scan'208";a="313709890"
Received: from lswidere-mobl.ger.corp.intel.com (HELO
 delly.ger.corp.intel.com) ([10.249.140.121])
 by orsmga004.jf.intel.com with ESMTP; 27 Jun 2019 01:01:00 -0700
From: Lionel Landwerlin <lionel.g.landwerlin@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 27 Jun 2019 11:00:43 +0300
Message-Id: <20190627080045.8814-9-lionel.g.landwerlin@intel.com>
X-Mailer: git-send-email 2.21.0.392.gf8f6787159e
In-Reply-To: <20190627080045.8814-1-lionel.g.landwerlin@intel.com>
References: <20190627080045.8814-1-lionel.g.landwerlin@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v5 08/10] drm/i915/perf: allow holding
 preemption on filtered ctx
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

V2Ugd291bGQgbGlrZSB0byBtYWtlIHVzZSBvZiBwZXJmIGluIFZ1bGthbi4gVGhlIFZ1bGthbiBB
UEkgaXMgbXVjaApsb3dlciBsZXZlbCB0aGFuIE9wZW5HTCwgd2l0aCBhcHBsaWNhdGlvbnMgZGly
ZWN0bHkgZXhwb3NlZCB0byB0aGUKY29uY2VwdCBvZiBjb21tYW5kIGJ1ZmZlcnMgKHByZXR0eSBt
dWNoIGVxdWl2YWxlbnQgdG8gb3VyIGJhdGNoCmJ1ZmZlcnMpLiBJbiBWdWxrYW4sIHF1ZXJpZXMg
YXJlIGFsd2F5cyBsaW1pdGVkIGluIHNjb3BlIHRvIGEgY29tbWFuZApidWZmZXIuIEluIE9wZW5H
TCwgdGhlIGxhY2sgb2YgY29tbWFuZCBidWZmZXIgY29uY2VwdCBtZWFudCB0aGF0CnF1ZXJpZXMn
IGR1cmF0aW9uIGNvdWxkIHNwYW4gbXVsdGlwbGUgY29tbWFuZCBidWZmZXJzLgoKV2l0aCB0aGF0
IHJlc3RyaWN0aW9uIGdvbmUgaW4gVnVsa2FuLCB3ZSB3b3VsZCBsaWtlIHRvIHNpbXBsaWZ5Cm1l
YXN1cmluZyBwZXJmb3JtYW5jZSBqdXN0IGJ5IG1lYXN1cmluZyB0aGUgZGVsdGFzIGJldHdlZW4g
dGhlIGNvdW50ZXIKc25hcHNob3RzIHdyaXR0ZW4gYnkgMiBNSV9SRUNPUkRfUEVSRl9DT1VOVCBj
b21tYW5kcywgcmF0aGVyIHRoYW4gdGhlCm1vcmUgY29tcGxleCBzY2hlbWUgd2UgY3VycmVudGx5
IGhhdmUgaW4gdGhlIEdMIGRyaXZlciwgdXNpbmcgMgpNSV9SRUNPUkRfUEVSRl9DT1VOVCBjb21t
YW5kcyBhbmQgZG9pbmcgc29tZSBwb3N0IHByb2Nlc3Npbmcgb24gdGhlCnN0cmVhbSBvZiBPQSBy
ZXBvcnRzLCBjb21pbmcgZnJvbSB0aGUgZ2xvYmFsIE9BIGJ1ZmZlciwgdG8gcmVtb3ZlIGFueQp1
bnJlbGF0ZWQgZGVsdGFzIGluIGJldHdlZW4gdGhlIDIgTUlfUkVDT1JEX1BFUkZfQ09VTlQuCgpE
aXNhYmxpbmcgcHJlZW1wdGlvbiBvbmx5IGFwcGx5IHRvIGEgc2luZ2xlIGNvbnRleHQgd2l0aCB3
aGljaCB3YW50IHRvCnF1ZXJ5IHBlcmZvcm1hbmNlIGNvdW50ZXJzIGZvciBhbmQgaXMgY29uc2lk
ZXJlZCBhIHByaXZpbGVnZWQKb3BlcmF0aW9uLCBieSBkZWZhdWx0IHByb3RlY3RlZCBieSBDQVBf
U1lTX0FETUlOLiBJdCBpcyBwb3NzaWJsZSB0bwplbmFibGUgaXQgZm9yIGEgbm9ybWFsIHVzZXIg
YnkgZGlzYWJsaW5nIHRoZSBwYXJhbm9pZCBzdHJlYW0gc2V0dGluZy4KCnYyOiBTdG9yZSBwcmVl
bXB0aW9uIHNldHRpbmcgaW4gaW50ZWxfY29udGV4dCAoQ2hyaXMpCgp2MzogVXNlIHByaW9yaXRp
ZXMgdG8gYXZvaWQgcHJlZW1wdGlvbiByYXRoZXIgdGhhbiB0aGUgSFcgbWVjaGFuaXNtCgp2NDog
SnVzdCBtb2RpZnkgdGhlIHBvcnQgcHJpb3JpdHkgcmVwb3J0aW5nIGZ1bmN0aW9uCgpTaWduZWQt
b2ZmLWJ5OiBMaW9uZWwgTGFuZHdlcmxpbiA8bGlvbmVsLmcubGFuZHdlcmxpbkBpbnRlbC5jb20+
Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMgICAgICAgICB8ICA3ICsr
KysrKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgICAgICAgICAgICAgfCAgMiAr
LQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaCAgICAgICAgICAgICB8IDEzICsrKysr
KysrKysrKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMgICAgICAgICAgICB8IDIy
ICsrKysrKysrKysrKysrKysrKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wcmlvbGlz
dF90eXBlcy5oICB8ICA3ICsrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVz
dC5jICAgICAgICAgfCAgMSArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuaCAg
ICAgICAgIHwgIDEgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX3N1Ym1pc3Npb24u
YyB8IDEyICsrKysrKysrKystCiBpbmNsdWRlL3VhcGkvZHJtL2k5MTVfZHJtLmggICAgICAgICAg
ICAgICAgIHwgMTEgKysrKysrKysrKysKIDkgZmlsZXMgY2hhbmdlZCwgNzEgaW5zZXJ0aW9ucygr
KSwgNSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9scmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCmluZGV4IGE2
ZWE0Njg5ODZkMS4uNTJmNGQ2OWNkYjJmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9scmMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMu
YwpAQCAtMjU2LDcgKzI1NiwxMiBAQCBzdGF0aWMgaW5saW5lIGludCBycV9wcmlvKGNvbnN0IHN0
cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogCiBzdGF0aWMgaW50IGVmZmVjdGl2ZV9wcmlvKGNvbnN0
IHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogewotCWludCBwcmlvID0gcnFfcHJpbyhycSk7CisJ
aW50IHByaW87CisKKwlpZiAocnEtPmhhc19wZXJmKQorCQlwcmlvID0gSTkxNV9VU0VSX1BSSU9S
SVRZKEk5MTVfUFJJT1JJVFlfUEVSRik7CisJZWxzZQorCQlwcmlvID0gcnFfcHJpbyhycSk7CiAK
IAkvKgogCSAqIE9uIHVud2luZGluZyB0aGUgYWN0aXZlIHJlcXVlc3QsIHdlIGdpdmUgaXQgYSBw
cmlvcml0eSBidW1wCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYwppbmRleCBlZjU0Y2YxYzU0YTUuLjY4
ZTI5YjFlZDFjOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCkBAIC00ODQsNyArNDg0LDcgQEAg
c3RhdGljIGludCBpOTE1X2dldHBhcmFtX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZv
aWQgKmRhdGEsCiAJCXZhbHVlID0gSU5URUxfSU5GTyhkZXZfcHJpdiktPmhhc19jb2hlcmVudF9n
Z3R0OwogCQlicmVhazsKIAljYXNlIEk5MTVfUEFSQU1fUEVSRl9SRVZJU0lPTjoKLQkJdmFsdWUg
PSAxOworCQl2YWx1ZSA9IDI7CiAJCWJyZWFrOwogCWNhc2UgSTkxNV9QQVJBTV9IQVNfRVhFQ19Q
RVJGX0NPTkZJRzoKIAkJLyogT2J2aW91c2x5IHJlcXVpcmVzIHBlcmYgc3VwcG9ydC4gKi8KZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2Rydi5oCmluZGV4IDUxYjEwMzQ5MzYyMy4uZjFiOGEwYWRhOTg2IDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZHJ2LmgKQEAgLTEyMzIsNiArMTIzMiwxOSBAQCBzdHJ1Y3QgaTkxNV9w
ZXJmX3N0cmVhbSB7CiAJICovCiAJYm9vbCBlbmFibGVkOwogCisJLyoqCisJICogQGhvbGRfcHJl
ZW1wdGlvbjogV2hldGhlciBwcmVlbXB0aW9uIGlzIHB1dCBvbiBob2xkIGZvciBjb21tYW5kCisJ
ICogc3VibWlzc2lvbnMgZG9uZSBvbiB0aGUgQGN0eC4gVGhpcyBpcyB1c2VmdWwgZm9yIHNvbWUg
ZHJpdmVycyB0aGF0CisJICogY2Fubm90IGVhc2lseSBwb3N0IHByb2Nlc3MgdGhlIE9BIGJ1ZmZl
ciBjb250ZXh0IHRvIHN1YnRyYWN0IGRlbHRhCisJICogb2YgcGVyZm9ybWFuY2UgY291bnRlcnMg
bm90IGFzc29jaWF0ZWQgd2l0aCBAY3R4LgorCSAqLworCWJvb2wgaG9sZF9wcmVlbXB0aW9uOwor
CisJLyoqCisJICogQGxhc3RfY29uZmlnX3JlcXVlc3QKKwkgKi8KKwlzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpsYXN0X2NvbmZpZ19yZXF1ZXN0OworCiAJLyoqCiAJICogQG9wczogVGhlIGNhbGxiYWNr
cyBwcm92aWRpbmcgdGhlIGltcGxlbWVudGF0aW9uIG9mIHRoaXMgc3BlY2lmaWMKIAkgKiB0eXBl
IG9mIGNvbmZpZ3VyZWQgc3RyZWFtLgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9wZXJmLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYwppbmRleCAzNGQ3
NGZhNjRjNzQuLmJmNGY1ZmVlNjc2NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9wZXJmLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMKQEAgLTM0
Myw2ICszNDMsOCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVfb2FfZm9ybWF0IGdlbjhfcGx1
c19vYV9mb3JtYXRzW0k5MTVfT0FfRk9STUFUX01BWF0gPSB7CiAgKiBzdHJ1Y3QgcGVyZl9vcGVu
X3Byb3BlcnRpZXMgLSBmb3IgdmFsaWRhdGVkIHByb3BlcnRpZXMgZ2l2ZW4gdG8gb3BlbiBhIHN0
cmVhbQogICogQHNhbXBsZV9mbGFnczogYERSTV9JOTE1X1BFUkZfUFJPUF9TQU1QTEVfKmAgcHJv
cGVydGllcyBhcmUgdHJhY2tlZCBhcyBmbGFncwogICogQHNpbmdsZV9jb250ZXh0OiBXaGV0aGVy
IGEgc2luZ2xlIG9yIGFsbCBncHUgY29udGV4dHMgc2hvdWxkIGJlIG1vbml0b3JlZAorICogQGhv
bGRfcHJlZW1wdGlvbjogV2hldGhlciB0aGUgcHJlZW1wdGlvbiBpcyBkaXNhYmxlZCBmb3IgdGhl
IGZpbHRlcmVkCisgKiAgICAgICAgICAgICAgICAgICBjb250ZXh0CiAgKiBAY3R4X2hhbmRsZTog
QSBnZW0gY3R4IGhhbmRsZSBmb3IgdXNlIHdpdGggQHNpbmdsZV9jb250ZXh0CiAgKiBAbWV0cmlj
c19zZXQ6IEFuIElEIGZvciBhbiBPQSB1bml0IG1ldHJpYyBzZXQgYWR2ZXJ0aXNlZCB2aWEgc3lz
ZnMKICAqIEBvYV9mb3JtYXQ6IEFuIE9BIHVuaXQgSFcgcmVwb3J0IGZvcm1hdApAQCAtMzU3LDYg
KzM1OSw3IEBAIHN0cnVjdCBwZXJmX29wZW5fcHJvcGVydGllcyB7CiAJdTMyIHNhbXBsZV9mbGFn
czsKIAogCXU2NCBzaW5nbGVfY29udGV4dDoxOworCXU2NCBob2xkX3ByZWVtcHRpb246MTsKIAl1
NjQgY3R4X2hhbmRsZTsKIAogCS8qIE9BIHNhbXBsaW5nIHN0YXRlICovCkBAIC0yMzUyLDYgKzIz
NTUsOCBAQCBzdGF0aWMgaW50IGk5MTVfb2Ffc3RyZWFtX2luaXQoc3RydWN0IGk5MTVfcGVyZl9z
dHJlYW0gKnN0cmVhbSwKIAlzdHJlYW0tPnNhbXBsZV9mbGFncyB8PSBTQU1QTEVfT0FfUkVQT1JU
OwogCXN0cmVhbS0+c2FtcGxlX3NpemUgKz0gZm9ybWF0X3NpemU7CiAKKwlzdHJlYW0tPmhvbGRf
cHJlZW1wdGlvbiA9IHByb3BzLT5ob2xkX3ByZWVtcHRpb247CisKIAlkZXZfcHJpdi0+cGVyZi5v
YS5vYV9idWZmZXIuZm9ybWF0X3NpemUgPSBmb3JtYXRfc2l6ZTsKIAlpZiAoV0FSTl9PTihkZXZf
cHJpdi0+cGVyZi5vYS5vYV9idWZmZXIuZm9ybWF0X3NpemUgPT0gMCkpCiAJCXJldHVybiAtRUlO
VkFMOwpAQCAtMjg5MCw2ICsyODk1LDE1IEBAIGk5MTVfcGVyZl9vcGVuX2lvY3RsX2xvY2tlZChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJCX0KIAl9CiAKKwlpZiAocHJvcHMt
PmhvbGRfcHJlZW1wdGlvbikgeworCQlpZiAoIXByb3BzLT5zaW5nbGVfY29udGV4dCkgeworCQkJ
RFJNX0RFQlVHKCJwcmVlbXB0aW9uIGRpc2FibGUgd2l0aCBubyBjb250ZXh0XG4iKTsKKwkJCXJl
dCA9IC1FSU5WQUw7CisJCQlnb3RvIGVycjsKKwkJfQorCQlwcml2aWxlZ2VkX29wID0gdHJ1ZTsK
Kwl9CisKIAkvKgogCSAqIE9uIEhhc3dlbGwgdGhlIE9BIHVuaXQgc3VwcG9ydHMgY2xvY2sgZ2F0
aW5nIG9mZiBmb3IgYSBzcGVjaWZpYwogCSAqIGNvbnRleHQgYW5kIGluIHRoaXMgbW9kZSB0aGVy
ZSdzIG5vIHZpc2liaWxpdHkgb2YgbWV0cmljcyBmb3IgdGhlCkBAIC0yOTA0LDggKzI5MTgsOSBA
QCBpOTE1X3BlcmZfb3Blbl9pb2N0bF9sb2NrZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAogCSAqIE1JX1JFUE9SVF9QRVJGX0NPVU5UIGNvbW1hbmRzIGFuZCBzbyBjb25zaWRl
ciBpdCBhIHByaXZpbGVnZWQgb3AgdG8KIAkgKiBlbmFibGUgdGhlIE9BIHVuaXQgYnkgZGVmYXVs
dC4KIAkgKi8KLQlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgJiYgc3BlY2lmaWNfY3R4KQorCWlm
IChJU19IQVNXRUxMKGRldl9wcml2KSAmJiBzcGVjaWZpY19jdHggJiYgIXByb3BzLT5ob2xkX3By
ZWVtcHRpb24pIHsKIAkJcHJpdmlsZWdlZF9vcCA9IGZhbHNlOworCX0KIAogCS8qIFNpbWlsYXIg
dG8gcGVyZidzIGtlcm5lbC5wZXJmX3BhcmFub2lkX2NwdSBzeXNjdGwgb3B0aW9uCiAJICogd2Ug
Y2hlY2sgYSBkZXYuaTkxNS5wZXJmX3N0cmVhbV9wYXJhbm9pZCBzeXNjdGwgb3B0aW9uCkBAIC0y
OTE0LDcgKzI5MjksNyBAQCBpOTE1X3BlcmZfb3Blbl9pb2N0bF9sb2NrZWQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAogCSAqLwogCWlmIChwcml2aWxlZ2VkX29wICYmCiAJICAg
IGk5MTVfcGVyZl9zdHJlYW1fcGFyYW5vaWQgJiYgIWNhcGFibGUoQ0FQX1NZU19BRE1JTikpIHsK
LQkJRFJNX0RFQlVHKCJJbnN1ZmZpY2llbnQgcHJpdmlsZWdlcyB0byBvcGVuIHN5c3RlbS13aWRl
IGk5MTUgcGVyZiBzdHJlYW1cbiIpOworCQlEUk1fREVCVUcoIkluc3VmZmljaWVudCBwcml2aWxl
Z2VzIHRvIG9wZW4gaTkxNSBwZXJmIHN0cmVhbVxuIik7CiAJCXJldCA9IC1FQUNDRVM7CiAJCWdv
dG8gZXJyX2N0eDsKIAl9CkBAIC0zMTA2LDYgKzMxMjEsOSBAQCBzdGF0aWMgaW50IHJlYWRfcHJv
cGVydGllc191bmxvY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJCQlw
cm9wcy0+b2FfcGVyaW9kaWMgPSB0cnVlOwogCQkJcHJvcHMtPm9hX3BlcmlvZF9leHBvbmVudCA9
IHZhbHVlOwogCQkJYnJlYWs7CisJCWNhc2UgRFJNX0k5MTVfUEVSRl9QUk9QX0hPTERfUFJFRU1Q
VElPTjoKKwkJCXByb3BzLT5ob2xkX3ByZWVtcHRpb24gPSB2YWx1ZSAhPSAwID8gMSA6IDA7CisJ
CQlicmVhazsKIAkJY2FzZSBEUk1fSTkxNV9QRVJGX1BST1BfTUFYOgogCQkJTUlTU0lOR19DQVNF
KGlkKTsKIAkJCXJldHVybiAtRUlOVkFMOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9wcmlvbGlzdF90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wcmlv
bGlzdF90eXBlcy5oCmluZGV4IDQ5NzA5ZGU2OTg3NS4uZmMxYzFmZTdjZTU4IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ByaW9saXN0X3R5cGVzLmgKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9wcmlvbGlzdF90eXBlcy5oCkBAIC0xNyw2ICsxNywxMyBAQCBl
bnVtIHsKIAlJOTE1X1BSSU9SSVRZX05PUk1BTCA9IEk5MTVfQ09OVEVYVF9ERUZBVUxUX1BSSU9S
SVRZLAogCUk5MTVfUFJJT1JJVFlfTUFYID0gSTkxNV9DT05URVhUX01BWF9VU0VSX1BSSU9SSVRZ
ICsgMSwKIAorCS8qIFJlcXVlc3RzIGNvbnRhaW5pbmcgcGVyZm9ybWFuY2UgcXVlcmllcyBtdXN0
IG5vdCBiZSBwcmVlbXB0ZWQgYnkKKwkgKiBhbm90aGVyIGNvbnRleHQuIFRoZXkgZ2V0IHNjaGVk
dWxlZCB3aXRoIHRoZWlyIGRlZmF1bHQgcHJpb3JpdHkgYW5kCisJICogb25jZSB0aGV5IHJlYWNo
IHRoZSBleGVjbGlzdCBwb3J0cyB3ZSBidW1wIHRoZW0gdG8KKwkgKiBJOTE1X1BSSU9SSVRZX1BF
UkYgc28gdGhhdCB0aGV5IHN0aWNrIHRvIHRoZSBIVyB1bnRpbCB0aGV5IGZpbmlzaC4KKwkgKi8K
KwlJOTE1X1BSSU9SSVRZX1BFUkYgPSBJOTE1X0NPTlRFWFRfTUFYX1VTRVJfUFJJT1JJVFkgKyAy
LAorCiAJSTkxNV9QUklPUklUWV9JTlZBTElEID0gSU5UX01JTgogfTsKIApkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3JlcXVlc3QuYwppbmRleCA1ZmY4N2M0YTBjZDUuLjQ0YjRiMmJmZWRmOSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMKQEAgLTY4NSw2ICs2ODUsNyBAQCBfX2k5MTVfcmVx
dWVzdF9jcmVhdGUoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCBnZnBfdCBnZnApCiAJcnEtPmJh
dGNoID0gTlVMTDsKIAlycS0+Y2FwdHVyZV9saXN0ID0gTlVMTDsKIAlycS0+d2FpdGJvb3N0ID0g
ZmFsc2U7CisJcnEtPmhhc19wZXJmID0gZmFsc2U7CiAJcnEtPmV4ZWN1dGlvbl9tYXNrID0gQUxM
X0VOR0lORVM7CiAKIAlJTklUX0xJU1RfSEVBRCgmcnEtPmFjdGl2ZV9saXN0KTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5oIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9yZXF1ZXN0LmgKaW5kZXggYjU4Y2VlZjkyZTIwLi4yMWJlNmI0NDYwMmQgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5oCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5oCkBAIC0yMTcsNiArMjE3LDcgQEAgc3RydWN0
IGk5MTVfcmVxdWVzdCB7CiAJdW5zaWduZWQgbG9uZyBlbWl0dGVkX2ppZmZpZXM7CiAKIAlib29s
IHdhaXRib29zdDsKKwlib29sIGhhc19wZXJmOwogCiAJLyoqIHRpbWVsaW5lLT5yZXF1ZXN0IGVu
dHJ5IGZvciB0aGlzIHJlcXVlc3QgKi8KIAlzdHJ1Y3QgbGlzdF9oZWFkIGxpbms7CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfc3VibWlzc2lvbi5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYwppbmRleCAxMmMyMjM1OWZkYWMu
LjM0MWUzMDNlZjBhMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3Vj
X3N1Ym1pc3Npb24uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfc3VibWlz
c2lvbi5jCkBAIC03MDcsNiArNzA3LDE2IEBAIHN0YXRpYyBpbmxpbmUgaW50IHJxX3ByaW8oY29u
c3Qgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJcmV0dXJuIHJxLT5zY2hlZC5hdHRyLnByaW9y
aXR5IHwgX19OT19QUkVFTVBUSU9OOwogfQogCitzdGF0aWMgaW5saW5lIGludCBlZmZlY3RpdmVf
cHJpbyhjb25zdCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKK3sKKwlpbnQgcHJpbzsKKworCWlm
IChycS0+aGFzX3BlcmYpCisJCXJldHVybiBJOTE1X1VTRVJfUFJJT1JJVFkoSTkxNV9QUklPUklU
WV9QRVJGKSB8IF9fTk9fUFJFRU1QVElPTjsKKworCXJldHVybiBycV9wcmlvKHJxKTsKK30KKwog
c3RhdGljIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnNjaGVkdWxlX2luKHN0cnVjdCBpOTE1X3JlcXVl
c3QgKnJxLCBpbnQgaWR4KQogewogCXRyYWNlX2k5MTVfcmVxdWVzdF9pbihycSwgaWR4KTsKQEAg
LTc0Nyw3ICs3NTcsNyBAQCBzdGF0aWMgdm9pZCBfX2d1Y19kZXF1ZXVlKHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSkKIAkJCQkmZW5naW5lLT5pOTE1LT5ndWMucHJlZW1wdF93b3JrW2Vu
Z2luZS0+aWRdOwogCQkJaW50IHByaW8gPSBleGVjbGlzdHMtPnF1ZXVlX3ByaW9yaXR5X2hpbnQ7
CiAKLQkJCWlmIChpOTE1X3NjaGVkdWxlcl9uZWVkX3ByZWVtcHQocHJpbywgcnFfcHJpbyhsYXN0
KSkpIHsKKwkJCWlmIChpOTE1X3NjaGVkdWxlcl9uZWVkX3ByZWVtcHQocHJpbywgZWZmZWN0aXZl
X3ByaW8obGFzdCkpKSB7CiAJCQkJaW50ZWxfd3JpdGVfc3RhdHVzX3BhZ2UoZW5naW5lLAogCQkJ
CQkJCUk5MTVfR0VNX0hXU19QUkVFTVBULAogCQkJCQkJCUdVQ19QUkVFTVBUX0lOUFJPR1JFU1Mp
OwpkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2RybS9pOTE1X2RybS5oIGIvaW5jbHVkZS91YXBp
L2RybS9pOTE1X2RybS5oCmluZGV4IDU5MzhhNzM5NjNmZS4uZTNjNmM3MjE5M2VkIDEwMDY0NAot
LS0gYS9pbmNsdWRlL3VhcGkvZHJtL2k5MTVfZHJtLmgKKysrIGIvaW5jbHVkZS91YXBpL2RybS9p
OTE1X2RybS5oCkBAIC0xOTgyLDYgKzE5ODIsMTcgQEAgZW51bSBkcm1faTkxNV9wZXJmX3Byb3Bl
cnR5X2lkIHsKIAkgKi8KIAlEUk1fSTkxNV9QRVJGX1BST1BfT0FfRVhQT05FTlQsCiAKKwkvKioK
KwkgKiBTcGVjaWZ5aW5nIHRoaXMgcHJvcGVydHkgaXMgb25seSB2YWxpZCB3aGVuIHNwZWNpZnkg
YSBjb250ZXh0IHRvCisJICogZmlsdGVyIHdpdGggRFJNX0k5MTVfUEVSRl9QUk9QX0NUWF9IQU5E
TEUuIFNwZWNpZnlpbmcgdGhpcyBwcm9wZXJ0eQorCSAqIHdpbGwgaG9sZCBwcmVlbXB0aW9uIG9m
IHRoZSBwYXJ0aWN1bGFyIGNvbnRleHQgd2Ugd2FudCB0byBnYXRoZXIKKwkgKiBwZXJmb3JtYW5j
ZSBkYXRhIGFib3V0LiBUaGUgZXhlY2J1ZjIgc3VibWlzc2lvbnMgbXVzdCBpbmNsdWRlIGEKKwkg
KiBkcm1faTkxNV9nZW1fZXhlY2J1ZmZlcl9leHRfcGVyZiBwYXJhbWV0ZXIgZm9yIHRoaXMgdG8g
YXBwbHkuCisJICoKKwkgKiBUaGlzIHByb3BlcnR5IGlzIGF2YWlsYWJsZSBpbiBwZXJmIHJldmlz
aW9uIDIuCisJICovCisJRFJNX0k5MTVfUEVSRl9QUk9QX0hPTERfUFJFRU1QVElPTiwKKwogCURS
TV9JOTE1X1BFUkZfUFJPUF9NQVggLyogbm9uLUFCSSAqLwogfTsKIAotLSAKMi4yMS4wLjM5Mi5n
ZjhmNjc4NzE1OWUKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9y
ZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdm
eA==

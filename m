Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 027B7A135F
	for <lists+intel-gfx@lfdr.de>; Thu, 29 Aug 2019 10:12:37 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F30756E063;
	Thu, 29 Aug 2019 08:12:21 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id BE78B6E03B
 for <intel-gfx@lists.freedesktop.org>; Thu, 29 Aug 2019 08:12:10 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18299861-1500050 
 for multiple; Thu, 29 Aug 2019 09:11:53 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 29 Aug 2019 09:11:17 +0100
Message-Id: <20190829081150.10271-4-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190829081150.10271-1-chris@chris-wilson.co.uk>
References: <20190829081150.10271-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 03/36] drm/i915/gtt: Downgrade Cherryview back
 to aliasing-ppgtt
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

V2l0aCB0aGUgdXBjb21pbmcgY2hhbmdlIGluIHRpbWluZyAoZHJhbWF0aWNhbGx5IHJlZHVjaW5n
IHRoZSBsYXRlbmN5CmJldHdlZW4gbWFuaXB1bGF0aW5nIHRoZSBwcEdUVCBhbmQgZXhlY3V0aW9u
KSwgbm8gYW1vdW50IG9mIHR3ZWFraW5nCmNvdWxkIHNhdmUgQ2hlcnJ5dmlldywgaXQgd291bGQg
YWx3YXlzIGZhaWwgdG8gaW52YWxpZGF0ZSBpdHMgVExCLgoKU2lnbmVkLW9mZi1ieTogQ2hyaXMg
V2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfbHJjLmMgfCA2OSArKysrKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wY2kuYyAgICAgfCAgMiArLQogMiBmaWxlcyBjaGFuZ2Vk
LCAxMSBpbnNlcnRpb25zKCspLCA2MCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2xyYy5jCmluZGV4IDdkNDYwYjE4NDJkZC4uMGUyODI2M2M3Yjg3IDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9scmMuYwpAQCAtMTg3MSw2MCArMTg3MSw2IEBAIHN0YXRpYyBpbnQgZ2Vu
OF9lbWl0X2luaXRfYnJlYWRjcnVtYihzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCBlbWl0X3BkcHMoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCi17
Ci0JY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqIGNvbnN0IGVuZ2luZSA9IHJxLT5lbmdp
bmU7Ci0Jc3RydWN0IGk5MTVfcHBndHQgKiBjb25zdCBwcGd0dCA9IGk5MTVfdm1fdG9fcHBndHQo
cnEtPmh3X2NvbnRleHQtPnZtKTsKLQlpbnQgZXJyLCBpOwotCXUzMiAqY3M7Ci0KLQlHRU1fQlVH
X09OKGludGVsX3ZncHVfYWN0aXZlKHJxLT5pOTE1KSk7Ci0KLQkvKgotCSAqIEJld2FyZSB5ZSBv
ZiB0aGUgZHJhZ29ucywgdGhpcyBzZXF1ZW5jZSBpcyBtYWdpYyEKLQkgKgotCSAqIFNtYWxsIGNo
YW5nZXMgdG8gdGhpcyBzZXF1ZW5jZSBjYW4gY2F1c2UgYW55dGhpbmcgZnJvbQotCSAqIEdQVSBo
YW5ncyB0byBmb3JjZXdha2UgZXJyb3JzIGFuZCBtYWNoaW5lIGxvY2t1cHMhCi0JICovCi0KLQkv
KiBGbHVzaCBhbnkgcmVzaWR1YWwgb3BlcmF0aW9ucyBmcm9tIHRoZSBjb250ZXh0IGxvYWQgKi8K
LQllcnIgPSBlbmdpbmUtPmVtaXRfZmx1c2gocnEsIEVNSVRfRkxVU0gpOwotCWlmIChlcnIpCi0J
CXJldHVybiBlcnI7Ci0KLQkvKiBNYWdpYyByZXF1aXJlZCB0byBwcmV2ZW50IGZvcmNld2FrZSBl
cnJvcnMhICovCi0JZXJyID0gZW5naW5lLT5lbWl0X2ZsdXNoKHJxLCBFTUlUX0lOVkFMSURBVEUp
OwotCWlmIChlcnIpCi0JCXJldHVybiBlcnI7Ci0KLQljcyA9IGludGVsX3JpbmdfYmVnaW4ocnEs
IDQgKiBHRU44XzNMVkxfUERQRVMgKyAyKTsKLQlpZiAoSVNfRVJSKGNzKSkKLQkJcmV0dXJuIFBU
Ul9FUlIoY3MpOwotCi0JLyogRW5zdXJlIHRoZSBMUkkgaGF2ZSBsYW5kZWQgYmVmb3JlIHdlIGlu
dmFsaWRhdGUgJiBjb250aW51ZSAqLwotCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oMiAq
IEdFTjhfM0xWTF9QRFBFUykgfCBNSV9MUklfRk9SQ0VfUE9TVEVEOwotCWZvciAoaSA9IEdFTjhf
M0xWTF9QRFBFUzsgaS0tOyApIHsKLQkJY29uc3QgZG1hX2FkZHJfdCBwZF9kYWRkciA9IGk5MTVf
cGFnZV9kaXJfZG1hX2FkZHIocHBndHQsIGkpOwotCQl1MzIgYmFzZSA9IGVuZ2luZS0+bW1pb19i
YXNlOwotCi0JCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9SSU5HX1BEUF9VRFco
YmFzZSwgaSkpOwotCQkqY3MrKyA9IHVwcGVyXzMyX2JpdHMocGRfZGFkZHIpOwotCQkqY3MrKyA9
IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEdFTjhfUklOR19QRFBfTERXKGJhc2UsIGkpKTsKLQkJKmNz
KysgPSBsb3dlcl8zMl9iaXRzKHBkX2RhZGRyKTsKLQl9Ci0JKmNzKysgPSBNSV9OT09QOwotCi0J
aW50ZWxfcmluZ19hZHZhbmNlKHJxLCBjcyk7Ci0KLQkvKiBCZSBkb3VibHkgc3VyZSB0aGUgTFJJ
IGhhdmUgbGFuZGVkIGJlZm9yZSBwcm9jZWVkaW5nICovCi0JZXJyID0gZW5naW5lLT5lbWl0X2Zs
dXNoKHJxLCBFTUlUX0ZMVVNIKTsKLQlpZiAoZXJyKQotCQlyZXR1cm4gZXJyOwotCi0JLyogUmUt
aW52YWxpZGF0ZSB0aGUgVExCIGZvciBsdWNrICovCi0JcmV0dXJuIGVuZ2luZS0+ZW1pdF9mbHVz
aChycSwgRU1JVF9JTlZBTElEQVRFKTsKLX0KLQogc3RhdGljIGludCBleGVjbGlzdHNfcmVxdWVz
dF9hbGxvYyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0KQogewogCWludCByZXQ7CkBAIC0x
OTQ3LDEwICsxODkzLDcgQEAgc3RhdGljIGludCBleGVjbGlzdHNfcmVxdWVzdF9hbGxvYyhzdHJ1
Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0KQogCSAqLwogCiAJLyogVW5jb25kaXRpb25hbGx5IGlu
dmFsaWRhdGUgR1BVIGNhY2hlcyBhbmQgVExCcy4gKi8KLQlpZiAoaTkxNV92bV9pc180bHZsKHJl
cXVlc3QtPmh3X2NvbnRleHQtPnZtKSkKLQkJcmV0ID0gcmVxdWVzdC0+ZW5naW5lLT5lbWl0X2Zs
dXNoKHJlcXVlc3QsIEVNSVRfSU5WQUxJREFURSk7Ci0JZWxzZQotCQlyZXQgPSBlbWl0X3BkcHMo
cmVxdWVzdCk7CisJcmV0ID0gcmVxdWVzdC0+ZW5naW5lLT5lbWl0X2ZsdXNoKHJlcXVlc3QsIEVN
SVRfSU5WQUxJREFURSk7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIApAQCAtMzE2NywxMiAr
MzExMCwyMCBAQCBzdGF0aWMgdTMyIGludGVsX2xyX2luZGlyZWN0X2N0eF9vZmZzZXQoc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCXJldHVybiBpbmRpcmVjdF9jdHhfb2Zmc2V0Owog
fQogCitzdGF0aWMgc3RydWN0IGk5MTVfcHBndHQgKnZtX2FsaWFzKHN0cnVjdCBpOTE1X2FkZHJl
c3Nfc3BhY2UgKnZtKQoreworCWlmIChpOTE1X2lzX2dndHQodm0pKQorCQlyZXR1cm4gaTkxNV92
bV90b19nZ3R0KHZtKS0+YWxpYXM7CisJZWxzZQorCQlyZXR1cm4gaTkxNV92bV90b19wcGd0dCh2
bSk7Cit9CisKIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19pbml0X3JlZ19zdGF0ZSh1MzIgKnJlZ3Ms
CiAJCQkJICAgICBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCiAJCQkJICAgICBzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUsCiAJCQkJICAgICBzdHJ1Y3QgaW50ZWxfcmluZyAqcmluZykK
IHsKLQlzdHJ1Y3QgaTkxNV9wcGd0dCAqcHBndHQgPSBpOTE1X3ZtX3RvX3BwZ3R0KGNlLT52bSk7
CisJc3RydWN0IGk5MTVfcHBndHQgKnBwZ3R0ID0gdm1fYWxpYXMoY2UtPnZtKTsKIAlib29sIHJj
cyA9IGVuZ2luZS0+Y2xhc3MgPT0gUkVOREVSX0NMQVNTOwogCXUzMiBiYXNlID0gZW5naW5lLT5t
bWlvX2Jhc2U7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGNpLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BjaS5jCmluZGV4IDE4MjEyYzM5YTliYS4uZmJl
OThhMmRiODhlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BjaS5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGNpLmMKQEAgLTU3MCw3ICs1NzAsNyBAQCBz
dGF0aWMgY29uc3Qgc3RydWN0IGludGVsX2RldmljZV9pbmZvIGludGVsX2NoZXJyeXZpZXdfaW5m
byA9IHsKIAkuaGFzX3JwcyA9IHRydWUsCiAJLmhhc19sb2dpY2FsX3JpbmdfY29udGV4dHMgPSAx
LAogCS5kaXNwbGF5Lmhhc19nbWNoID0gMSwKLQkucHBndHRfdHlwZSA9IElOVEVMX1BQR1RUX0ZV
TEwsCisJLnBwZ3R0X3R5cGUgPSBJTlRFTF9QUEdUVF9BTElBU0lORywKIAkucHBndHRfc2l6ZSA9
IDMyLAogCS5oYXNfcmVzZXRfZW5naW5lID0gMSwKIAkuaGFzX3Nub29wID0gdHJ1ZSwKLS0gCjIu
MjMuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50
ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBz
Oi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

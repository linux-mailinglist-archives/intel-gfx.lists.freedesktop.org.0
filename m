Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id ED3441D7539
	for <lists+intel-gfx@lfdr.de>; Mon, 18 May 2020 12:31:21 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 4C5486E1C0;
	Mon, 18 May 2020 10:31:20 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga03.intel.com (mga03.intel.com [134.134.136.65])
 by gabe.freedesktop.org (Postfix) with ESMTPS id DCF2C6E1C0
 for <intel-gfx@lists.freedesktop.org>; Mon, 18 May 2020 10:31:18 +0000 (UTC)
IronPort-SDR: byWAqhDc2CFf9IyI5RuFetW9V5H08trncQcCG96m/BE4pEDaPNHObWgoTtU68Ge25hQ904BAxQ
 DpPlxThEBnWQ==
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga006.jf.intel.com ([10.7.209.51])
 by orsmga103.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 18 May 2020 03:31:18 -0700
IronPort-SDR: 8VyyuB1PpJ2YYkgDjtpu9NiehtHdcqv84sN2uJjUeqs39ldkSb4c/8A30ZiZKSy4sJv9nlzUqP
 YgUv+LWuRHZg==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.73,406,1583222400"; d="scan'208";a="267473332"
Received: from rcburbid-mobl2.ger.corp.intel.com (HELO [10.252.57.97])
 ([10.252.57.97])
 by orsmga006.jf.intel.com with ESMTP; 18 May 2020 03:31:16 -0700
To: Animesh Manna <animesh.manna@intel.com>, intel-gfx@lists.freedesktop.org
References: <20200514145831.15206-1-animesh.manna@intel.com>
From: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
Message-ID: <50006d10-6632-a3b0-d238-32f2e0fabd9b@linux.intel.com>
Date: Mon, 18 May 2020 12:31:15 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.8.0
MIME-Version: 1.0
In-Reply-To: <20200514145831.15206-1-animesh.manna@intel.com>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH v8] drm/i915/dsb: Pre allocate and late
 cleanup of cmd buffer
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Jani Nikula <jani.nikula@intel.com>, Daniel Vetter <daniel.vetter@ffwll.ch>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T3AgMTQtMDUtMjAyMCBvbSAxNjo1OCBzY2hyZWVmIEFuaW1lc2ggTWFubmE6Cj4gUHJlLWFsbG9j
YXRlIGNvbW1hbmQgYnVmZmVyIGluIGF0b21pY19jb21taXQgdXNpbmcgaW50ZWxfZHNiX3ByZXBh
cmUKPiBmdW5jdGlvbiB3aGljaCBhbHNvIGluY2x1ZGVzIHBpbm5pbmcgYW5kIG1hcCBpbiBjcHUg
ZG9tYWluLgo+Cj4gTm8gZnVuY3Rpb25hbCBjaGFuZ2UgaXMgZHNiIHdyaXRlL2NvbW1pdCBmdW5j
dGlvbnMuCj4KPiBOb3cgZHNiIGdldC9wdXQgZnVuY3Rpb24gaXMgcmVtb3ZlZCBhbmQgcmVmLWNv
dW50IG1lY2hhbmlzbSBpcwo+IG5vdCBuZWVkZWQuIEJlbG93IGRzYiBhcGkgYWRkZWQgdG8gZG8g
cmVzcGVjdGl2ZSBqb2IgbWVudGlvbmVkCj4gYmVsb3cuCj4KPiBpbnRlbF9kc2JfcHJlcGFyZSAt
IEFsbG9jYXRlLCBwaW4gYW5kIG1hcCB0aGUgYnVmZmVyLgo+IGludGVsX2RzYl9jbGVhbnVwIC0g
VW5waW4gYW5kIHJlbGVhc2UgdGhlIGdlbSBvYmplY3QuCj4KPiBSRkM6IEluaXRpYWwgcGF0Y2gg
Zm9yIGRlc2lnbiByZXZpZXcuCj4gdjI6IGluY2x1ZGVkIF9pbml0KCkgcGFydCBpbiBfcHJlcGFy
ZSgpLiBbRGFuaWVsLCBWaWxsZV0KPiB2MzogZHNiX2NsZWFudXAgY2FsbGVkIGFmdGVyIGNsZWFu
dXBfcGxhbmVzLiBbRGFuaWVsXQo+IHY0OiBkc2Igc3RydWN0dXJlIGlzIG1vdmVkIHRvIGludGVs
X2NydGNfc3RhdGUgZnJvbSBpbnRlbF9jcnRjLiBbTWFhcnRlbl0KPiB2NTogZHNiIGdldC9wdXQv
cmVmLWNvdW50IG1lY2hhbmlzbSByZW1vdmVkLiBbTWFhcnRlbl0KPiB2NjogQmFzZWQgb24gcmV2
aWV3IGZlZWRiYWNrIGZvbGxvd2luZyBjaGFuZ2VzIGFyZSBhZGRlZCwKPiAtIHJlcGxhY2VkIGlu
dGVsX2RzYiBzdHJ1Y3R1cmUgYnkgcG9pbnRlciBpbiBpbnRlbF9jcnRjX3N0YXRlLiBbTWFhcnRl
bl0KPiAtIHBhc3NpbmcgaW50ZWxfY3J0Y19zdGF0ZSB0byBkc3AtYXBpIHRvIHNpbXBsaWZ5IHRo
ZSBjb2RlLiBbTWFhcnRlbl0KPiAtIGZldyBkc2IgZnVuY3Rpb25zIHByb3RvdHlwZSBtb2RpZmll
ZCB0byBzaW1wbGlmeSBjb2RlLgo+IHY3OiBhZGRlZCBmZXcgY29zbWV0aWMgY2hhbmdlcyBzdWdn
ZXN0ZWQgYnkgSmFuaSBhbmQgbnVsbCBjaGVjayBmb3IKPiBjcnRjX3N0YXRlIGluIGRzYl9jbGVh
bnVwIHJlbW92ZWQgYXMgc3VnZ2VzdGVkIGJ5IE1hYXJ0ZW4uCj4gdjg6IGNoYW5nZWQgdGhlIGZ1
bmN0aW9uIHBhcmFtZXRlciB0byBpbnRlbF9jcnRjX3N0YXRlKiBvZgo+IGl2Yl9sb2FkX2x1dF9l
eHRfbWF4KCkgZnJvbSBpbnRlbF9jcnRjLiBbTWFhcnRlbl0KPgo+IENjOiBNYWFydGVuIExhbmto
b3JzdCA8bWFhcnRlbi5sYW5raG9yc3RAbGludXguaW50ZWwuY29tPgo+IENjOiBWaWxsZSBTeXJq
w6Rsw6QgPHZpbGxlLnN5cmphbGFAbGludXguaW50ZWwuY29tPgo+IENjOiBKYW5pIE5pa3VsYSA8
amFuaS5uaWt1bGFAaW50ZWwuY29tPgo+IENjOiBEYW5pZWwgVmV0dGVyIDxkYW5pZWwudmV0dGVy
QGZmd2xsLmNoPgo+IEFja2VkLWJ5OiBEYW5pZWwgVmV0dGVyIDxkYW5pZWwudmV0dGVyQGZmd2xs
LmNoPgo+IFNpZ25lZC1vZmYtYnk6IEFuaW1lc2ggTWFubmEgPGFuaW1lc2gubWFubmFAaW50ZWwu
Y29tPgo+IC0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0b21pYy5j
ICAgfCAgIDMgKwo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2NvbG9yLmMg
ICAgfCAgNjYgKystLS0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNw
bGF5LmMgIHwgIDU4ICsrKystCj4gIC4uLi9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlf
dHlwZXMuaCAgICB8ICAgNiArLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2RzYi5jICAgICAgfCAyNDYgKysrKysrKystLS0tLS0tLS0tCj4gIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfZHNiLmggICAgICB8ICAxNyArLQo+ICA2IGZpbGVzIGNoYW5nZWQs
IDIwMiBpbnNlcnRpb25zKCspLCAxOTQgZGVsZXRpb25zKC0pCj4KPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9taWMuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWljLmMKPiBpbmRleCBkMDQzMDU3ZDJmYTAuLjNjYjg2
NmYyMmU3NCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2F0b21pYy5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9t
aWMuYwo+IEBAIC0yNTIsNiArMjUyLDcgQEAgaW50ZWxfY3J0Y19kdXBsaWNhdGVfc3RhdGUoc3Ry
dWN0IGRybV9jcnRjICpjcnRjKQo+ICAJY3J0Y19zdGF0ZS0+d20ubmVlZF9wb3N0dmJsX3VwZGF0
ZSA9IGZhbHNlOwo+ICAJY3J0Y19zdGF0ZS0+ZmJfYml0cyA9IDA7Cj4gIAljcnRjX3N0YXRlLT51
cGRhdGVfcGxhbmVzID0gMDsKPiArCWNydGNfc3RhdGUtPmRzYiA9IE5VTEw7Cj4gIAo+ICAJcmV0
dXJuICZjcnRjX3N0YXRlLT51YXBpOwo+ICB9Cj4gQEAgLTI5Miw2ICsyOTMsOCBAQCBpbnRlbF9j
cnRjX2Rlc3Ryb3lfc3RhdGUoc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ICB7Cj4gIAlzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9IHRvX2ludGVsX2NydGNfc3RhdGUoc3RhdGUp
Owo+ICAKPiArCWRybV9XQVJOX09OKGNydGMtPmRldiwgY3J0Y19zdGF0ZS0+ZHNiKTsKPiArCj4g
IAlfX2RybV9hdG9taWNfaGVscGVyX2NydGNfZGVzdHJveV9zdGF0ZSgmY3J0Y19zdGF0ZS0+dWFw
aSk7Cj4gIAlpbnRlbF9jcnRjX2ZyZWVfaHdfc3RhdGUoY3J0Y19zdGF0ZSk7Cj4gIAlrZnJlZShj
cnRjX3N0YXRlKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9jb2xvci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9jb2xvci5j
Cj4gaW5kZXggOThlY2U5Y2Q3Y2RkLi45NDViYjAzYmRkNGQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9jb2xvci5jCj4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9jb2xvci5jCj4gQEAgLTcxNCwxNiArNzE0LDE2IEBAIHN0
YXRpYyB2b2lkIGJkd19sb2FkX2x1dF8xMChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgCWlu
dGVsX2RlX3dyaXRlKGRldl9wcml2LCBQUkVDX1BBTF9JTkRFWChwaXBlKSwgMCk7Cj4gIH0KPiAg
Cj4gLXN0YXRpYyB2b2lkIGl2Yl9sb2FkX2x1dF9leHRfbWF4KHN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjKQo+ICtzdGF0aWMgdm9pZCBpdmJfbG9hZF9sdXRfZXh0X21heChjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+ICsJc3RydWN0IGludGVsX2NydGMgKmNy
dGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAtCXN0
cnVjdCBpbnRlbF9kc2IgKmRzYiA9IGludGVsX2RzYl9nZXQoY3J0Yyk7Cj4gIAllbnVtIHBpcGUg
cGlwZSA9IGNydGMtPnBpcGU7Cj4gIAo+ICAJLyogUHJvZ3JhbSB0aGUgbWF4IHJlZ2lzdGVyIHRv
IGNsYW1wIHZhbHVlcyA+IDEuMC4gKi8KPiAtCWludGVsX2RzYl9yZWdfd3JpdGUoZHNiLCBQUkVD
X1BBTF9FWFRfR0NfTUFYKHBpcGUsIDApLCAxIDw8IDE2KTsKPiAtCWludGVsX2RzYl9yZWdfd3Jp
dGUoZHNiLCBQUkVDX1BBTF9FWFRfR0NfTUFYKHBpcGUsIDEpLCAxIDw8IDE2KTsKPiAtCWludGVs
X2RzYl9yZWdfd3JpdGUoZHNiLCBQUkVDX1BBTF9FWFRfR0NfTUFYKHBpcGUsIDIpLCAxIDw8IDE2
KTsKPiArCWludGVsX2RzYl9yZWdfd3JpdGUoY3J0Y19zdGF0ZSwgUFJFQ19QQUxfRVhUX0dDX01B
WChwaXBlLCAwKSwgMSA8PCAxNik7Cj4gKwlpbnRlbF9kc2JfcmVnX3dyaXRlKGNydGNfc3RhdGUs
IFBSRUNfUEFMX0VYVF9HQ19NQVgocGlwZSwgMSksIDEgPDwgMTYpOwo+ICsJaW50ZWxfZHNiX3Jl
Z193cml0ZShjcnRjX3N0YXRlLCBQUkVDX1BBTF9FWFRfR0NfTUFYKHBpcGUsIDIpLCAxIDw8IDE2
KTsKPiAgCj4gIAkvKgo+ICAJICogUHJvZ3JhbSB0aGUgZ2MgbWF4IDIgcmVnaXN0ZXIgdG8gY2xh
bXAgdmFsdWVzID4gMS4wLgo+IEBAIC03MzEsMTUgKzczMSwxMyBAQCBzdGF0aWMgdm9pZCBpdmJf
bG9hZF9sdXRfZXh0X21heChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiAgCSAqIGZyb20gMy4w
IHRvIDcuMAo+ICAJICovCj4gIAlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCB8fCBJU19H
RU1JTklMQUtFKGRldl9wcml2KSkgewo+IC0JCWludGVsX2RzYl9yZWdfd3JpdGUoZHNiLCBQUkVD
X1BBTF9FWFQyX0dDX01BWChwaXBlLCAwKSwKPiArCQlpbnRlbF9kc2JfcmVnX3dyaXRlKGNydGNf
c3RhdGUsIFBSRUNfUEFMX0VYVDJfR0NfTUFYKHBpcGUsIDApLAo+ICAJCQkJICAgIDEgPDwgMTYp
Owo+IC0JCWludGVsX2RzYl9yZWdfd3JpdGUoZHNiLCBQUkVDX1BBTF9FWFQyX0dDX01BWChwaXBl
LCAxKSwKPiArCQlpbnRlbF9kc2JfcmVnX3dyaXRlKGNydGNfc3RhdGUsIFBSRUNfUEFMX0VYVDJf
R0NfTUFYKHBpcGUsIDEpLAo+ICAJCQkJICAgIDEgPDwgMTYpOwo+IC0JCWludGVsX2RzYl9yZWdf
d3JpdGUoZHNiLCBQUkVDX1BBTF9FWFQyX0dDX01BWChwaXBlLCAyKSwKPiArCQlpbnRlbF9kc2Jf
cmVnX3dyaXRlKGNydGNfc3RhdGUsIFBSRUNfUEFMX0VYVDJfR0NfTUFYKHBpcGUsIDIpLAo+ICAJ
CQkJICAgIDEgPDwgMTYpOwo+ICAJfQo+IC0KPiAtCWludGVsX2RzYl9wdXQoZHNiKTsKPiAgfQo+
ICAKPiAgc3RhdGljIHZvaWQgaXZiX2xvYWRfbHV0cyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKPiBAQCAtNzUzLDcgKzc1MSw3IEBAIHN0YXRpYyB2b2lkIGl2Yl9s
b2FkX2x1dHMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIAl9
IGVsc2UgaWYgKGNydGNfc3RhdGUtPmdhbW1hX21vZGUgPT0gR0FNTUFfTU9ERV9NT0RFX1NQTElU
KSB7Cj4gIAkJaXZiX2xvYWRfbHV0XzEwKGNydGMsIGRlZ2FtbWFfbHV0LCBQQUxfUFJFQ19TUExJ
VF9NT0RFIHwKPiAgCQkJCVBBTF9QUkVDX0lOREVYX1ZBTFVFKDApKTsKPiAtCQlpdmJfbG9hZF9s
dXRfZXh0X21heChjcnRjKTsKPiArCQlpdmJfbG9hZF9sdXRfZXh0X21heChjcnRjX3N0YXRlKTsK
PiAgCQlpdmJfbG9hZF9sdXRfMTAoY3J0YywgZ2FtbWFfbHV0LCBQQUxfUFJFQ19TUExJVF9NT0RF
IHwKPiAgCQkJCVBBTF9QUkVDX0lOREVYX1ZBTFVFKDUxMikpOwo+ICAJfSBlbHNlIHsKPiBAQCAt
NzYxLDcgKzc1OSw3IEBAIHN0YXRpYyB2b2lkIGl2Yl9sb2FkX2x1dHMoY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIAo+ICAJCWl2Yl9sb2FkX2x1dF8xMChjcnRj
LCBibG9iLAo+ICAJCQkJUEFMX1BSRUNfSU5ERVhfVkFMVUUoMCkpOwo+IC0JCWl2Yl9sb2FkX2x1
dF9leHRfbWF4KGNydGMpOwo+ICsJCWl2Yl9sb2FkX2x1dF9leHRfbWF4KGNydGNfc3RhdGUpOwo+
ICAJfQo+ICB9Cj4gIAo+IEBAIC03NzYsNyArNzc0LDcgQEAgc3RhdGljIHZvaWQgYmR3X2xvYWRf
bHV0cyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgCX0gZWxz
ZSBpZiAoY3J0Y19zdGF0ZS0+Z2FtbWFfbW9kZSA9PSBHQU1NQV9NT0RFX01PREVfU1BMSVQpIHsK
PiAgCQliZHdfbG9hZF9sdXRfMTAoY3J0YywgZGVnYW1tYV9sdXQsIFBBTF9QUkVDX1NQTElUX01P
REUgfAo+ICAJCQkJUEFMX1BSRUNfSU5ERVhfVkFMVUUoMCkpOwo+IC0JCWl2Yl9sb2FkX2x1dF9l
eHRfbWF4KGNydGMpOwo+ICsJCWl2Yl9sb2FkX2x1dF9leHRfbWF4KGNydGNfc3RhdGUpOwo+ICAJ
CWJkd19sb2FkX2x1dF8xMChjcnRjLCBnYW1tYV9sdXQsIFBBTF9QUkVDX1NQTElUX01PREUgfAo+
ICAJCQkJUEFMX1BSRUNfSU5ERVhfVkFMVUUoNTEyKSk7Cj4gIAl9IGVsc2Ugewo+IEBAIC03ODQs
NyArNzgyLDcgQEAgc3RhdGljIHZvaWQgYmR3X2xvYWRfbHV0cyhjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgCj4gIAkJYmR3X2xvYWRfbHV0XzEwKGNydGMsIGJs
b2IsCj4gIAkJCQlQQUxfUFJFQ19JTkRFWF9WQUxVRSgwKSk7Cj4gLQkJaXZiX2xvYWRfbHV0X2V4
dF9tYXgoY3J0Yyk7Cj4gKwkJaXZiX2xvYWRfbHV0X2V4dF9tYXgoY3J0Y19zdGF0ZSk7Cj4gIAl9
Cj4gIH0KPiAgCj4gQEAgLTg3Nyw3ICs4NzUsNyBAQCBzdGF0aWMgdm9pZCBnbGtfbG9hZF9sdXRz
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAJCWlsa19sb2Fk
X2x1dF84KGNydGMsIGdhbW1hX2x1dCk7Cj4gIAl9IGVsc2Ugewo+ICAJCWJkd19sb2FkX2x1dF8x
MChjcnRjLCBnYW1tYV9sdXQsIFBBTF9QUkVDX0lOREVYX1ZBTFVFKDApKTsKPiAtCQlpdmJfbG9h
ZF9sdXRfZXh0X21heChjcnRjKTsKPiArCQlpdmJfbG9hZF9sdXRfZXh0X21heChjcnRjX3N0YXRl
KTsKPiAgCX0KPiAgfQo+ICAKPiBAQCAtOTAwLDE0ICs4OTgsMTIgQEAgaWNsX2xvYWRfZ2NtYXgo
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gIAkgICAgICAgY29u
c3Qgc3RydWN0IGRybV9jb2xvcl9sdXQgKmNvbG9yKQo+ICB7Cj4gIAlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAtCXN0cnVj
dCBpbnRlbF9kc2IgKmRzYiA9IGludGVsX2RzYl9nZXQoY3J0Yyk7Cj4gIAllbnVtIHBpcGUgcGlw
ZSA9IGNydGMtPnBpcGU7Cj4gIAo+ICAJLyogRklYTUUgTFVUIGVudHJpZXMgYXJlIDE2IGJpdCBv
bmx5LCBzbyB3ZSBjYW4gcHJvZyAweEZGRkYgbWF4ICovCj4gLQlpbnRlbF9kc2JfcmVnX3dyaXRl
KGRzYiwgUFJFQ19QQUxfR0NfTUFYKHBpcGUsIDApLCBjb2xvci0+cmVkKTsKPiAtCWludGVsX2Rz
Yl9yZWdfd3JpdGUoZHNiLCBQUkVDX1BBTF9HQ19NQVgocGlwZSwgMSksIGNvbG9yLT5ncmVlbik7
Cj4gLQlpbnRlbF9kc2JfcmVnX3dyaXRlKGRzYiwgUFJFQ19QQUxfR0NfTUFYKHBpcGUsIDIpLCBj
b2xvci0+Ymx1ZSk7Cj4gLQlpbnRlbF9kc2JfcHV0KGRzYik7Cj4gKwlpbnRlbF9kc2JfcmVnX3dy
aXRlKGNydGNfc3RhdGUsIFBSRUNfUEFMX0dDX01BWChwaXBlLCAwKSwgY29sb3ItPnJlZCk7Cj4g
KwlpbnRlbF9kc2JfcmVnX3dyaXRlKGNydGNfc3RhdGUsIFBSRUNfUEFMX0dDX01BWChwaXBlLCAx
KSwgY29sb3ItPmdyZWVuKTsKPiArCWludGVsX2RzYl9yZWdfd3JpdGUoY3J0Y19zdGF0ZSwgUFJF
Q19QQUxfR0NfTUFYKHBpcGUsIDIpLCBjb2xvci0+Ymx1ZSk7Cj4gIH0KPiAgCj4gIHN0YXRpYyB2
b2lkCj4gQEAgLTkxNiw3ICs5MTIsNiBAQCBpY2xfcHJvZ3JhbV9nYW1tYV9zdXBlcmZpbmVfc2Vn
bWVudChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgCXN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMp
Owo+ICAJY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpibG9iID0gY3J0Y19zdGF0ZS0+
aHcuZ2FtbWFfbHV0Owo+ICAJY29uc3Qgc3RydWN0IGRybV9jb2xvcl9sdXQgKmx1dCA9IGJsb2It
PmRhdGE7Cj4gLQlzdHJ1Y3QgaW50ZWxfZHNiICpkc2IgPSBpbnRlbF9kc2JfZ2V0KGNydGMpOwo+
ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ICAJaW50IGk7Cj4gIAo+IEBAIC05Mjcs
MTkgKzkyMiwxNyBAQCBpY2xfcHJvZ3JhbV9nYW1tYV9zdXBlcmZpbmVfc2VnbWVudChjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgCSAqIDkgZW50cmllcywgY29y
cmVzcG9uZGluZyB0byB2YWx1ZXMgMCwgMS8oOCAqIDEyOCAqIDI1NiksCj4gIAkgKiAyLyg4ICog
MTI4ICogMjU2KSAuLi4gOC8oOCAqIDEyOCAqIDI1NikuCj4gIAkgKi8KPiAtCWludGVsX2RzYl9y
ZWdfd3JpdGUoZHNiLCBQUkVDX1BBTF9NVUxUSV9TRUdfSU5ERVgocGlwZSksCj4gKwlpbnRlbF9k
c2JfcmVnX3dyaXRlKGNydGNfc3RhdGUsIFBSRUNfUEFMX01VTFRJX1NFR19JTkRFWChwaXBlKSwK
PiAgCQkJICAgIFBBTF9QUkVDX0FVVE9fSU5DUkVNRU5UKTsKPiAgCj4gIAlmb3IgKGkgPSAwOyBp
IDwgOTsgaSsrKSB7Cj4gIAkJY29uc3Qgc3RydWN0IGRybV9jb2xvcl9sdXQgKmVudHJ5ID0gJmx1
dFtpXTsKPiAgCj4gLQkJaW50ZWxfZHNiX2luZGV4ZWRfcmVnX3dyaXRlKGRzYiwgUFJFQ19QQUxf
TVVMVElfU0VHX0RBVEEocGlwZSksCj4gKwkJaW50ZWxfZHNiX2luZGV4ZWRfcmVnX3dyaXRlKGNy
dGNfc3RhdGUsIFBSRUNfUEFMX01VTFRJX1NFR19EQVRBKHBpcGUpLAo+ICAJCQkJCSAgICBpbGtf
bHV0XzEycDRfbGR3KGVudHJ5KSk7Cj4gLQkJaW50ZWxfZHNiX2luZGV4ZWRfcmVnX3dyaXRlKGRz
YiwgUFJFQ19QQUxfTVVMVElfU0VHX0RBVEEocGlwZSksCj4gKwkJaW50ZWxfZHNiX2luZGV4ZWRf
cmVnX3dyaXRlKGNydGNfc3RhdGUsIFBSRUNfUEFMX01VTFRJX1NFR19EQVRBKHBpcGUpLAo+ICAJ
CQkJCSAgICBpbGtfbHV0XzEycDRfdWR3KGVudHJ5KSk7Cj4gIAl9Cj4gLQo+IC0JaW50ZWxfZHNi
X3B1dChkc2IpOwo+ICB9Cj4gIAo+ICBzdGF0aWMgdm9pZAo+IEBAIC05NDksNyArOTQyLDYgQEAg
aWNsX3Byb2dyYW1fZ2FtbWFfbXVsdGlfc2VnbWVudChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKPiAgCWNvbnN0IHN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqYmxv
YiA9IGNydGNfc3RhdGUtPmh3LmdhbW1hX2x1dDsKPiAgCWNvbnN0IHN0cnVjdCBkcm1fY29sb3Jf
bHV0ICpsdXQgPSBibG9iLT5kYXRhOwo+ICAJY29uc3Qgc3RydWN0IGRybV9jb2xvcl9sdXQgKmVu
dHJ5Owo+IC0Jc3RydWN0IGludGVsX2RzYiAqZHNiID0gaW50ZWxfZHNiX2dldChjcnRjKTsKPiAg
CWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCWludCBpOwo+ICAKPiBAQCAtOTYzLDEy
ICs5NTUsMTMgQEAgaWNsX3Byb2dyYW1fZ2FtbWFfbXVsdGlfc2VnbWVudChjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgCSAqIFBBTF9QUkVDX0lOREVYWzBdIGFu
ZCBQQUxfUFJFQ19JTkRFWFsxXSBtYXAgdG8gc2VnMlsxXSwKPiAgCSAqIHNlZzJbMF0gYmVpbmcg
dW51c2VkIGJ5IHRoZSBoYXJkd2FyZS4KPiAgCSAqLwo+IC0JaW50ZWxfZHNiX3JlZ193cml0ZShk
c2IsIFBSRUNfUEFMX0lOREVYKHBpcGUpLCBQQUxfUFJFQ19BVVRPX0lOQ1JFTUVOVCk7Cj4gKwlp
bnRlbF9kc2JfcmVnX3dyaXRlKGNydGNfc3RhdGUsIFBSRUNfUEFMX0lOREVYKHBpcGUpLAo+ICsJ
CQkgICAgUEFMX1BSRUNfQVVUT19JTkNSRU1FTlQpOwo+ICAJZm9yIChpID0gMTsgaSA8IDI1Nzsg
aSsrKSB7Cj4gIAkJZW50cnkgPSAmbHV0W2kgKiA4XTsKPiAtCQlpbnRlbF9kc2JfaW5kZXhlZF9y
ZWdfd3JpdGUoZHNiLCBQUkVDX1BBTF9EQVRBKHBpcGUpLAo+ICsJCWludGVsX2RzYl9pbmRleGVk
X3JlZ193cml0ZShjcnRjX3N0YXRlLCBQUkVDX1BBTF9EQVRBKHBpcGUpLAo+ICAJCQkJCSAgICBp
bGtfbHV0XzEycDRfbGR3KGVudHJ5KSk7Cj4gLQkJaW50ZWxfZHNiX2luZGV4ZWRfcmVnX3dyaXRl
KGRzYiwgUFJFQ19QQUxfREFUQShwaXBlKSwKPiArCQlpbnRlbF9kc2JfaW5kZXhlZF9yZWdfd3Jp
dGUoY3J0Y19zdGF0ZSwgUFJFQ19QQUxfREFUQShwaXBlKSwKPiAgCQkJCQkgICAgaWxrX2x1dF8x
MnA0X3VkdyhlbnRyeSkpOwo+ICAJfQo+ICAKPiBAQCAtOTg2LDI0ICs5NzksMjIgQEAgaWNsX3By
b2dyYW1fZ2FtbWFfbXVsdGlfc2VnbWVudChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSkKPiAgCSAqLwo+ICAJZm9yIChpID0gMDsgaSA8IDI1NjsgaSsrKSB7Cj4gIAkJ
ZW50cnkgPSAmbHV0W2kgKiA4ICogMTI4XTsKPiAtCQlpbnRlbF9kc2JfaW5kZXhlZF9yZWdfd3Jp
dGUoZHNiLCBQUkVDX1BBTF9EQVRBKHBpcGUpLAo+ICsJCWludGVsX2RzYl9pbmRleGVkX3JlZ193
cml0ZShjcnRjX3N0YXRlLCBQUkVDX1BBTF9EQVRBKHBpcGUpLAo+ICAJCQkJCSAgICBpbGtfbHV0
XzEycDRfbGR3KGVudHJ5KSk7Cj4gLQkJaW50ZWxfZHNiX2luZGV4ZWRfcmVnX3dyaXRlKGRzYiwg
UFJFQ19QQUxfREFUQShwaXBlKSwKPiArCQlpbnRlbF9kc2JfaW5kZXhlZF9yZWdfd3JpdGUoY3J0
Y19zdGF0ZSwgUFJFQ19QQUxfREFUQShwaXBlKSwKPiAgCQkJCQkgICAgaWxrX2x1dF8xMnA0X3Vk
dyhlbnRyeSkpOwo+ICAJfQo+ICAKPiAgCS8qIFRoZSBsYXN0IGVudHJ5IGluIHRoZSBMVVQgaXMg
dG8gYmUgcHJvZ3JhbW1lZCBpbiBHQ01BWCAqLwo+ICAJZW50cnkgPSAmbHV0WzI1NiAqIDggKiAx
MjhdOwo+ICAJaWNsX2xvYWRfZ2NtYXgoY3J0Y19zdGF0ZSwgZW50cnkpOwo+IC0JaXZiX2xvYWRf
bHV0X2V4dF9tYXgoY3J0Yyk7Cj4gLQlpbnRlbF9kc2JfcHV0KGRzYik7Cj4gKwlpdmJfbG9hZF9s
dXRfZXh0X21heChjcnRjX3N0YXRlKTsKPiAgfQo+ICAKPiAgc3RhdGljIHZvaWQgaWNsX2xvYWRf
bHV0cyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+ICAJ
Y29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpnYW1tYV9sdXQgPSBjcnRjX3N0YXRlLT5o
dy5nYW1tYV9sdXQ7Cj4gIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMo
Y3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAtCXN0cnVjdCBpbnRlbF9kc2IgKmRzYiA9IGludGVs
X2RzYl9nZXQoY3J0Yyk7Cj4gIAo+ICAJaWYgKGNydGNfc3RhdGUtPmh3LmRlZ2FtbWFfbHV0KQo+
ICAJCWdsa19sb2FkX2RlZ2FtbWFfbHV0KGNydGNfc3RhdGUpOwo+IEBAIC0xMDE4LDExICsxMDA5
LDEwIEBAIHN0YXRpYyB2b2lkIGljbF9sb2FkX2x1dHMoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCj4gIAkJYnJlYWs7Cj4gIAlkZWZhdWx0Ogo+ICAJCWJkd19sb2Fk
X2x1dF8xMChjcnRjLCBnYW1tYV9sdXQsIFBBTF9QUkVDX0lOREVYX1ZBTFVFKDApKTsKPiAtCQlp
dmJfbG9hZF9sdXRfZXh0X21heChjcnRjKTsKPiArCQlpdmJfbG9hZF9sdXRfZXh0X21heChjcnRj
X3N0YXRlKTsKPiAgCX0KPiAgCj4gLQlpbnRlbF9kc2JfY29tbWl0KGRzYik7Cj4gLQlpbnRlbF9k
c2JfcHV0KGRzYik7Cj4gKwlpbnRlbF9kc2JfY29tbWl0KGNydGNfc3RhdGUpOwo+ICB9Cj4gIAo+
ICBzdGF0aWMgdTMyIGNodl9jZ21fZGVnYW1tYV9sZHcoY29uc3Qgc3RydWN0IGRybV9jb2xvcl9s
dXQgKmNvbG9yKQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX2Rpc3BsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxh
eS5jCj4gaW5kZXggNDMyYjRlZWFmOWY2Li41MTQ0ODNmZmQyNDcgMTAwNjQ0Cj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKPiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwo+IEBAIC0xNDg3Myw4ICsxNDg3
MywyNCBAQCBzdGF0aWMgaW50IGludGVsX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2LAo+ICAKPiAgc3RhdGljIGludCBpbnRlbF9hdG9taWNfcHJlcGFyZV9jb21taXQoc3RydWN0
IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gIHsKPiAtCXJldHVybiBkcm1fYXRvbWljX2hl
bHBlcl9wcmVwYXJlX3BsYW5lcyhzdGF0ZS0+YmFzZS5kZXYsCj4gLQkJCQkJCSZzdGF0ZS0+YmFz
ZSk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZTsKPiArCXN0cnVjdCBp
bnRlbF9jcnRjICpjcnRjOwo+ICsJaW50IGksIHJldDsKPiArCj4gKwlyZXQgPSBkcm1fYXRvbWlj
X2hlbHBlcl9wcmVwYXJlX3BsYW5lcyhzdGF0ZS0+YmFzZS5kZXYsICZzdGF0ZS0+YmFzZSk7Cj4g
KwlpZiAocmV0IDwgMCkKPiArCQlyZXR1cm4gcmV0Owo+ICsKPiArCWZvcl9lYWNoX25ld19pbnRl
bF9jcnRjX2luX3N0YXRlKHN0YXRlLCBjcnRjLCBjcnRjX3N0YXRlLCBpKSB7Cj4gKwkJYm9vbCBt
b2RlX2NoYW5nZWQgPSBuZWVkc19tb2Rlc2V0KGNydGNfc3RhdGUpOwo+ICsKPiArCQlpZiAobW9k
ZV9jaGFuZ2VkIHx8IGNydGNfc3RhdGUtPnVwZGF0ZV9waXBlIHx8Cj4gKwkJICAgIGNydGNfc3Rh
dGUtPnVhcGkuY29sb3JfbWdtdF9jaGFuZ2VkKSB7Cj4gKwkJCWludGVsX2RzYl9wcmVwYXJlKGNy
dGNfc3RhdGUpOwo+ICsJCX0KPiArCX0KPiArCj4gKwlyZXR1cm4gMDsKPiAgfQo+ICAKPiAgdTMy
IGludGVsX2NydGNfZ2V0X3ZibGFua19jb3VudGVyKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+
IEBAIC0xNTMyNywxNSArMTUzNDMsMjcgQEAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX2NvbW1p
dF9mZW5jZV93YWl0KHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKmludGVsX3N0YXQKPiAgCQkg
ICAgJndhaXRfcmVzZXQpOwo+ICB9Cj4gIAo+ICtzdGF0aWMgdm9pZCBpbnRlbF9jbGVhbnVwX2Rz
YnMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gK3sKPiArCXN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwgKm5ld19jcnRjX3N0YXRlOwo+ICsJc3RydWN0
IGludGVsX2NydGMgKmNydGM7Cj4gKwlpbnQgaTsKPiArCj4gKwlmb3JfZWFjaF9vbGRuZXdfaW50
ZWxfY3J0Y19pbl9zdGF0ZShzdGF0ZSwgY3J0Yywgb2xkX2NydGNfc3RhdGUsCj4gKwkJCQkJICAg
IG5ld19jcnRjX3N0YXRlLCBpKQo+ICsJCWludGVsX2RzYl9jbGVhbnVwKG9sZF9jcnRjX3N0YXRl
KTsKPiArfQo+ICsKPiAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX2NsZWFudXBfd29yayhzdHJ1
Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gIHsKPiAtCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpz
dGF0ZSA9Cj4gLQkJY29udGFpbmVyX29mKHdvcmssIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlLCBj
b21taXRfd29yayk7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
c3RhdGUtPmRldik7Cj4gKwlzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSA9Cj4gKwkJ
Y29udGFpbmVyX29mKHdvcmssIHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUsIGJhc2UuY29tbWl0
X3dvcmspOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KHN0YXRl
LT5iYXNlLmRldik7Cj4gIAo+IC0JZHJtX2F0b21pY19oZWxwZXJfY2xlYW51cF9wbGFuZXMoJmk5
MTUtPmRybSwgc3RhdGUpOwo+IC0JZHJtX2F0b21pY19oZWxwZXJfY29tbWl0X2NsZWFudXBfZG9u
ZShzdGF0ZSk7Cj4gLQlkcm1fYXRvbWljX3N0YXRlX3B1dChzdGF0ZSk7Cj4gKwlpbnRlbF9jbGVh
bnVwX2RzYnMoc3RhdGUpOwo+ICsJZHJtX2F0b21pY19oZWxwZXJfY2xlYW51cF9wbGFuZXMoJmk5
MTUtPmRybSwgJnN0YXRlLT5iYXNlKTsKPiArCWRybV9hdG9taWNfaGVscGVyX2NvbW1pdF9jbGVh
bnVwX2RvbmUoJnN0YXRlLT5iYXNlKTsKPiArCWRybV9hdG9taWNfc3RhdGVfcHV0KCZzdGF0ZS0+
YmFzZSk7Cj4gIAo+ICAJaW50ZWxfYXRvbWljX2hlbHBlcl9mcmVlX3N0YXRlKGk5MTUpOwo+ICB9
Cj4gQEAgLTE1NDY5LDYgKzE1NDk3LDEzIEBAIHN0YXRpYyB2b2lkIGludGVsX2F0b21pY19jb21t
aXRfdGFpbChzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgCQkJbW9kZXNldF9w
dXRfcG93ZXJfZG9tYWlucyhkZXZfcHJpdiwgcHV0X2RvbWFpbnNbaV0pOwo+ICAKPiAgCQlpbnRl
bF9tb2Rlc2V0X3ZlcmlmeV9jcnRjKGNydGMsIHN0YXRlLCBvbGRfY3J0Y19zdGF0ZSwgbmV3X2Ny
dGNfc3RhdGUpOwo+ICsKPiArCQkvKgo+ICsJCSAqIERTQiBjbGVhbnVwIGlzIGRvbmUgaW4gY2xl
YW51cF93b3JrIGFsaWduaW5nIHdpdGggZnJhbWVidWZmZXIKPiArCQkgKiBjbGVhbnVwLiBTbyBj
b3B5IGFuZCByZXNldCB0aGUgZHNiIHN0cnVjdHVyZSB0byBzeW5jIHdpdGgKPiArCQkgKiBjb21t
aXRfZG9uZSBhbmQgbGF0ZXIgZG8gZHNiIGNsZWFudXAgaW4gY2xlYW51cF93b3JrLgo+ICsJCSAq
Lwo+ICsJCW9sZF9jcnRjX3N0YXRlLT5kc2IgPSBmZXRjaF9hbmRfemVybygmbmV3X2NydGNfc3Rh
dGUtPmRzYik7Cj4gIAl9Cj4gIAo+ICAJLyogVW5kZXJydW5zIGRvbid0IGFsd2F5cyByYWlzZSBp
bnRlcnJ1cHRzLCBzbyBjaGVjayBtYW51YWxseSAqLwo+IEBAIC0xNTYxOCw4ICsxNTY1MywxNSBA
QCBzdGF0aWMgaW50IGludGVsX2F0b21pY19jb21taXQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwK
PiAgCQlpbnRlbF9hdG9taWNfc3dhcF9nbG9iYWxfc3RhdGUoc3RhdGUpOwo+ICAKPiAgCWlmIChy
ZXQpIHsKPiArCQlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGU7Cj4gKwkJ
c3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4gKwkJaW50IGk7Cj4gKwo+ICAJCWk5MTVfc3dfZmVu
Y2VfY29tbWl0KCZzdGF0ZS0+Y29tbWl0X3JlYWR5KTsKPiAgCj4gKwkJZm9yX2VhY2hfbmV3X2lu
dGVsX2NydGNfaW5fc3RhdGUoc3RhdGUsIGNydGMsIG5ld19jcnRjX3N0YXRlLCBpKQo+ICsJCQlp
bnRlbF9kc2JfY2xlYW51cChuZXdfY3J0Y19zdGF0ZSk7Cj4gKwo+ICAJCWRybV9hdG9taWNfaGVs
cGVyX2NsZWFudXBfcGxhbmVzKGRldiwgJnN0YXRlLT5iYXNlKTsKPiAgCQlpbnRlbF9ydW50aW1l
X3BtX3B1dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHN0YXRlLT53YWtlcmVmKTsKPiAgCQlyZXR1
cm4gcmV0Owo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2Rpc3BsYXlfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlz
cGxheV90eXBlcy5oCj4gaW5kZXggODc4NzZmY2U5MWE1Li5jYTU3OTAwNWQ4MTggMTAwNjQ0Cj4g
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgK
PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMu
aAo+IEBAIC0xMDc4LDYgKzEwNzgsOSBAQCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSB7Cj4gIAo+
ICAJLyogT25seSB2YWxpZCBvbiBUR0wrICovCj4gIAllbnVtIHRyYW5zY29kZXIgbXN0X21hc3Rl
cl90cmFuc2NvZGVyOwo+ICsKPiArCS8qIEZvciBEU0IgcmVsYXRlZCBpbmZvICovCj4gKwlzdHJ1
Y3QgaW50ZWxfZHNiICpkc2I7Cj4gIH07Cj4gIAo+ICBlbnVtIGludGVsX3BpcGVfY3JjX3NvdXJj
ZSB7Cj4gQEAgLTExNDcsOSArMTE1MCw2IEBAIHN0cnVjdCBpbnRlbF9jcnRjIHsKPiAgCS8qIHNj
YWxlcnMgYXZhaWxhYmxlIG9uIHRoaXMgY3J0YyAqLwo+ICAJaW50IG51bV9zY2FsZXJzOwo+ICAK
PiAtCS8qIHBlciBwaXBlIERTQiByZWxhdGVkIGluZm8gKi8KPiAtCXN0cnVjdCBpbnRlbF9kc2Ig
ZHNiOwo+IC0KPiAgI2lmZGVmIENPTkZJR19ERUJVR19GUwo+ICAJc3RydWN0IGludGVsX3BpcGVf
Y3JjIHBpcGVfY3JjOwo+ICAjZW5kaWYKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9kc2IuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfZHNiLmMKPiBpbmRleCAyOWZlYzZhOTJkMTcuLjA2NDI0MjgxNzZiYiAxMDA2NDQKPiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RzYi5jCj4gKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kc2IuYwo+IEBAIC0zNCwxNTIgKzM0LDUyIEBA
Cj4gICNkZWZpbmUgRFNCX0JZVEVfRU5fU0hJRlQJCTIwCj4gICNkZWZpbmUgRFNCX1JFR19WQUxV
RV9NQVNLCQkweGZmZmZmCj4gIAo+IC1zdGF0aWMgYm9vbCBpc19kc2JfYnVzeShzdHJ1Y3QgaW50
ZWxfZHNiICpkc2IpCj4gK3N0YXRpYyBib29sIGlzX2RzYl9idXN5KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LCBlbnVtIHBpcGUgcGlwZSwKPiArCQkJZW51bSBkc2JfaWQgaWQpCj4gIHsK
PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gY29udGFpbmVyX29mKGRzYiwgdHlwZW9mKCpj
cnRjKSwgZHNiKTsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY3J0Yy0+YmFzZS5kZXYpOwo+IC0JZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+IC0K
PiAtCXJldHVybiBEU0JfU1RBVFVTICYgaW50ZWxfZGVfcmVhZChkZXZfcHJpdiwgRFNCX0NUUkwo
cGlwZSwgZHNiLT5pZCkpOwo+ICsJcmV0dXJuIERTQl9TVEFUVVMgJiBpbnRlbF9kZV9yZWFkKGk5
MTUsIERTQl9DVFJMKHBpcGUsIGlkKSk7Cj4gIH0KPiAgCj4gLXN0YXRpYyBib29sIGludGVsX2Rz
Yl9lbmFibGVfZW5naW5lKHN0cnVjdCBpbnRlbF9kc2IgKmRzYikKPiArc3RhdGljIGJvb2wgaW50
ZWxfZHNiX2VuYWJsZV9lbmdpbmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gKwkJ
CQkgICAgZW51bSBwaXBlIHBpcGUsIGVudW0gZHNiX2lkIGlkKQo+ICB7Cj4gLQlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IGNvbnRhaW5lcl9vZihkc2IsIHR5cGVvZigqY3J0YyksIGRzYik7Cj4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2Uu
ZGV2KTsKPiAtCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCXUzMiBkc2JfY3RybDsK
PiAgCj4gLQlkc2JfY3RybCA9IGludGVsX2RlX3JlYWQoZGV2X3ByaXYsIERTQl9DVFJMKHBpcGUs
IGRzYi0+aWQpKTsKPiArCWRzYl9jdHJsID0gaW50ZWxfZGVfcmVhZChpOTE1LCBEU0JfQ1RSTChw
aXBlLCBpZCkpOwo+ICAJaWYgKERTQl9TVEFUVVMgJiBkc2JfY3RybCkgewo+IC0JCWRybV9kYmdf
a21zKCZkZXZfcHJpdi0+ZHJtLCAiRFNCIGVuZ2luZSBpcyBidXN5LlxuIik7Cj4gKwkJZHJtX2Ri
Z19rbXMoJmk5MTUtPmRybSwgIkRTQiBlbmdpbmUgaXMgYnVzeS5cbiIpOwo+ICAJCXJldHVybiBm
YWxzZTsKPiAgCX0KPiAgCj4gIAlkc2JfY3RybCB8PSBEU0JfRU5BQkxFOwo+IC0JaW50ZWxfZGVf
d3JpdGUoZGV2X3ByaXYsIERTQl9DVFJMKHBpcGUsIGRzYi0+aWQpLCBkc2JfY3RybCk7Cj4gKwlp
bnRlbF9kZV93cml0ZShpOTE1LCBEU0JfQ1RSTChwaXBlLCBpZCksIGRzYl9jdHJsKTsKPiAgCj4g
LQlpbnRlbF9kZV9wb3N0aW5nX3JlYWQoZGV2X3ByaXYsIERTQl9DVFJMKHBpcGUsIGRzYi0+aWQp
KTsKPiArCWludGVsX2RlX3Bvc3RpbmdfcmVhZChpOTE1LCBEU0JfQ1RSTChwaXBlLCBpZCkpOwo+
ICAJcmV0dXJuIHRydWU7Cj4gIH0KPiAgCj4gLXN0YXRpYyBib29sIGludGVsX2RzYl9kaXNhYmxl
X2VuZ2luZShzdHJ1Y3QgaW50ZWxfZHNiICpkc2IpCj4gK3N0YXRpYyBib29sIGludGVsX2RzYl9k
aXNhYmxlX2VuZ2luZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiArCQkJCSAgICAg
ZW51bSBwaXBlIHBpcGUsIGVudW0gZHNiX2lkIGlkKQo+ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YyA9IGNvbnRhaW5lcl9vZihkc2IsIHR5cGVvZigqY3J0YyksIGRzYik7Cj4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsK
PiAtCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCXUzMiBkc2JfY3RybDsKPiAgCj4g
LQlkc2JfY3RybCA9IGludGVsX2RlX3JlYWQoZGV2X3ByaXYsIERTQl9DVFJMKHBpcGUsIGRzYi0+
aWQpKTsKPiArCWRzYl9jdHJsID0gaW50ZWxfZGVfcmVhZChpOTE1LCBEU0JfQ1RSTChwaXBlLCBp
ZCkpOwo+ICAJaWYgKERTQl9TVEFUVVMgJiBkc2JfY3RybCkgewo+IC0JCWRybV9kYmdfa21zKCZk
ZXZfcHJpdi0+ZHJtLCAiRFNCIGVuZ2luZSBpcyBidXN5LlxuIik7Cj4gKwkJZHJtX2RiZ19rbXMo
Jmk5MTUtPmRybSwgIkRTQiBlbmdpbmUgaXMgYnVzeS5cbiIpOwo+ICAJCXJldHVybiBmYWxzZTsK
PiAgCX0KPiAgCj4gIAlkc2JfY3RybCAmPSB+RFNCX0VOQUJMRTsKPiAtCWludGVsX2RlX3dyaXRl
KGRldl9wcml2LCBEU0JfQ1RSTChwaXBlLCBkc2ItPmlkKSwgZHNiX2N0cmwpOwo+ICsJaW50ZWxf
ZGVfd3JpdGUoaTkxNSwgRFNCX0NUUkwocGlwZSwgaWQpLCBkc2JfY3RybCk7Cj4gIAo+IC0JaW50
ZWxfZGVfcG9zdGluZ19yZWFkKGRldl9wcml2LCBEU0JfQ1RSTChwaXBlLCBkc2ItPmlkKSk7Cj4g
KwlpbnRlbF9kZV9wb3N0aW5nX3JlYWQoaTkxNSwgRFNCX0NUUkwocGlwZSwgaWQpKTsKPiAgCXJl
dHVybiB0cnVlOwo+ICB9Cj4gIAo+IC0vKioKPiAtICogaW50ZWxfZHNiX2dldCgpIC0gQWxsb2Nh
dGUgRFNCIGNvbnRleHQgYW5kIHJldHVybiBhIERTQiBpbnN0YW5jZS4KPiAtICogQGNydGM6IGlu
dGVsX2NydGMgc3RydWN0dXJlIHRvIGdldCBwaXBlIGluZm8uCj4gLSAqCj4gLSAqIFRoaXMgZnVu
Y3Rpb24gcHJvdmlkZXMgaGFuZGxlIG9mIGEgRFNCIGluc3RhbmNlLCBmb3IgdGhlIGZ1cnRoZXIg
RFNCCj4gLSAqIG9wZXJhdGlvbnMuCj4gLSAqCj4gLSAqIFJldHVybnM6IGFkZHJlc3Mgb2YgSW50
ZWxfZHNiIGluc3RhbmNlIHJlcXVlc3RlZCBmb3IuCj4gLSAqIEZhaWx1cmU6IFJldHVybnMgdGhl
IHNhbWUgRFNCIGluc3RhbmNlLCBidXQgd2l0aG91dCBhIGNvbW1hbmQgYnVmZmVyLgo+IC0gKi8K
PiAtCj4gLXN0cnVjdCBpbnRlbF9kc2IgKgo+IC1pbnRlbF9kc2JfZ2V0KHN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjKQo+IC17Cj4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+YmFzZS5k
ZXY7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiAt
CXN0cnVjdCBpbnRlbF9kc2IgKmRzYiA9ICZjcnRjLT5kc2I7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqOwo+IC0Jc3RydWN0IGk5MTVfdm1hICp2bWE7Cj4gLQl1MzIgKmJ1ZjsK
PiAtCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+IC0KPiAtCWlmICghSEFTX0RTQihpOTE1KSkK
PiAtCQlyZXR1cm4gZHNiOwo+IC0KPiAtCWlmIChkc2ItPnJlZmNvdW50KysgIT0gMCkKPiAtCQly
ZXR1cm4gZHNiOwo+IC0KPiAtCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+
cnVudGltZV9wbSk7Cj4gLQo+IC0Jb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5h
bChpOTE1LCBEU0JfQlVGX1NJWkUpOwo+IC0JaWYgKElTX0VSUihvYmopKSB7Cj4gLQkJZHJtX2Vy
cigmaTkxNS0+ZHJtLCAiR2VtIG9iamVjdCBjcmVhdGlvbiBmYWlsZWRcbiIpOwo+IC0JCWdvdG8g
b3V0Owo+IC0JfQo+IC0KPiAtCXZtYSA9IGk5MTVfZ2VtX29iamVjdF9nZ3R0X3BpbihvYmosIE5V
TEwsIDAsIDAsIDApOwo+IC0JaWYgKElTX0VSUih2bWEpKSB7Cj4gLQkJZHJtX2VycigmaTkxNS0+
ZHJtLCAiVm1hIGNyZWF0aW9uIGZhaWxlZFxuIik7Cj4gLQkJaTkxNV9nZW1fb2JqZWN0X3B1dChv
YmopOwo+IC0JCWdvdG8gb3V0Owo+IC0JfQo+IC0KPiAtCWJ1ZiA9IGk5MTVfZ2VtX29iamVjdF9w
aW5fbWFwKHZtYS0+b2JqLCBJOTE1X01BUF9XQyk7Cj4gLQlpZiAoSVNfRVJSKGJ1ZikpIHsKPiAt
CQlkcm1fZXJyKCZpOTE1LT5kcm0sICJDb21tYW5kIGJ1ZmZlciBjcmVhdGlvbiBmYWlsZWRcbiIp
Owo+IC0JCWdvdG8gb3V0Owo+IC0JfQo+IC0KPiAtCWRzYi0+aWQgPSBEU0IxOwo+IC0JZHNiLT52
bWEgPSB2bWE7Cj4gLQlkc2ItPmNtZF9idWYgPSBidWY7Cj4gLQo+IC1vdXQ6Cj4gLQkvKgo+IC0J
ICogT24gZXJyb3IgZHNiLT5jbWRfYnVmIHdpbGwgY29udGludWUgdG8gYmUgTlVMTCwgbWFraW5n
IHRoZSB3cml0ZXMKPiAtCSAqIHBhc3MtdGhyb3VnaC4gTGVhdmUgdGhlIGRhbmdsaW5nIHJlZiB0
byBiZSByZW1vdmVkIGxhdGVyIGJ5IHRoZQo+IC0JICogY29ycmVzcG9uZGluZyBpbnRlbF9kc2Jf
cHV0KCk6IHRoZSBpbXBvcnRhbnQgZXJyb3IgbWVzc2FnZSB3aWxsCj4gLQkgKiBhbHJlYWR5IGJl
IGxvZ2dlZCBhYm92ZS4KPiAtCSAqLwo+IC0KPiAtCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1
LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKPiAtCj4gLQlyZXR1cm4gZHNiOwo+IC19Cj4gLQo+IC0v
KioKPiAtICogaW50ZWxfZHNiX3B1dCgpIC0gVG8gZGVzdHJveSBEU0IgY29udGV4dC4KPiAtICog
QGRzYjogaW50ZWxfZHNiIHN0cnVjdHVyZS4KPiAtICoKPiAtICogVGhpcyBmdW5jdGlvbiBkZXN0
cm95cyB0aGUgRFNCIGNvbnRleHQgYWxsb2NhdGVkIGJ5IGEgZHNiX2dldCgpLCBieQo+IC0gKiB1
bnBpbm5pbmcgYW5kIHJlbGVhc2luZyB0aGUgVk1BIG9iamVjdCBhc3NvY2lhdGVkIHdpdGggaXQu
Cj4gLSAqLwo+IC0KPiAtdm9pZCBpbnRlbF9kc2JfcHV0KHN0cnVjdCBpbnRlbF9kc2IgKmRzYikK
PiAtewo+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSBjb250YWluZXJfb2YoZHNiLCB0eXBl
b2YoKmNydGMpLCBkc2IpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGNydGMtPmJhc2UuZGV2KTsKPiAtCj4gLQlpZiAoIUhBU19EU0IoaTkxNSkpCj4gLQkJcmV0
dXJuOwo+IC0KPiAtCWlmIChkcm1fV0FSTl9PTigmaTkxNS0+ZHJtLCBkc2ItPnJlZmNvdW50ID09
IDApKQo+IC0JCXJldHVybjsKPiAtCj4gLQlpZiAoLS1kc2ItPnJlZmNvdW50ID09IDApIHsKPiAt
CQlpOTE1X3ZtYV91bnBpbl9hbmRfcmVsZWFzZSgmZHNiLT52bWEsIEk5MTVfVk1BX1JFTEVBU0Vf
TUFQKTsKPiAtCQlkc2ItPmNtZF9idWYgPSBOVUxMOwo+IC0JCWRzYi0+ZnJlZV9wb3MgPSAwOwo+
IC0JCWRzYi0+aW5zX3N0YXJ0X29mZnNldCA9IDA7Cj4gLQl9Cj4gLX0KPiAtCj4gIC8qKgo+ICAg
KiBpbnRlbF9kc2JfaW5kZXhlZF9yZWdfd3JpdGUoKSAtV3JpdGUgdG8gdGhlIERTQiBjb250ZXh0
IGZvciBhdXRvCj4gICAqIGluY3JlbWVudCByZWdpc3Rlci4KPiAtICogQGRzYjogaW50ZWxfZHNi
IHN0cnVjdHVyZS4KPiArICogQGNydGNfc3RhdGU6IGludGVsX2NydGNfc3RhdGUgc3RydWN0dXJl
Cj4gICAqIEByZWc6IHJlZ2lzdGVyIGFkZHJlc3MuCj4gICAqIEB2YWw6IHZhbHVlLgo+ICAgKgo+
IEBAIC0xODksMTkgKzg5LDIwIEBAIHZvaWQgaW50ZWxfZHNiX3B1dChzdHJ1Y3QgaW50ZWxfZHNi
ICpkc2IpCj4gICAqIGlzIGRvbmUgdGhyb3VnaCBtbWlvIHdyaXRlLgo+ICAgKi8KPiAgCj4gLXZv
aWQgaW50ZWxfZHNiX2luZGV4ZWRfcmVnX3dyaXRlKHN0cnVjdCBpbnRlbF9kc2IgKmRzYiwgaTkx
NV9yZWdfdCByZWcsCj4gLQkJCQkgdTMyIHZhbCkKPiArdm9pZCBpbnRlbF9kc2JfaW5kZXhlZF9y
ZWdfd3JpdGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gKwkJ
CQkgaTkxNV9yZWdfdCByZWcsIHUzMiB2YWwpCj4gIHsKPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjID0gY29udGFpbmVyX29mKGRzYiwgdHlwZW9mKCpjcnRjKSwgZHNiKTsKPiArCXN0cnVjdCBp
bnRlbF9kc2IgKmRzYiA9IGNydGNfc3RhdGUtPmRzYjsKPiArCXN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gLQl1
MzIgKmJ1ZiA9IGRzYi0+Y21kX2J1ZjsKPiArCXUzMiAqYnVmOwo+ICAJdTMyIHJlZ192YWw7Cj4g
IAo+IC0JaWYgKCFidWYpIHsKPiArCWlmICghKGRzYiAmJiBkc2ItPmNtZF9idWYpKSB7ClNhbWUg
YXMgYmVsb3cuCj4gIAkJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIHJlZywgdmFsKTsKPiAgCQly
ZXR1cm47Cj4gIAl9Cj4gLQo+ICsJYnVmID0gZHNiLT5jbWRfYnVmOwo+ICAJaWYgKGRybV9XQVJO
X09OKCZkZXZfcHJpdi0+ZHJtLCBkc2ItPmZyZWVfcG9zID49IERTQl9CVUZfU0laRSkpIHsKPiAg
CQlkcm1fZGJnX2ttcygmZGV2X3ByaXYtPmRybSwgIkRTQiBidWZmZXIgb3ZlcmZsb3dcbiIpOwo+
ICAJCXJldHVybjsKPiBAQCAtMjU2LDcgKzE1Nyw3IEBAIHZvaWQgaW50ZWxfZHNiX2luZGV4ZWRf
cmVnX3dyaXRlKHN0cnVjdCBpbnRlbF9kc2IgKmRzYiwgaTkxNV9yZWdfdCByZWcsCj4gIC8qKgo+
ICAgKiBpbnRlbF9kc2JfcmVnX3dyaXRlKCkgLVdyaXRlIHRvIHRoZSBEU0IgY29udGV4dCBmb3Ig
bm9ybWFsCj4gICAqIHJlZ2lzdGVyLgo+IC0gKiBAZHNiOiBpbnRlbF9kc2Igc3RydWN0dXJlLgo+
ICsgKiBAY3J0Y19zdGF0ZTogaW50ZWxfY3J0Y19zdGF0ZSBzdHJ1Y3R1cmUKPiAgICogQHJlZzog
cmVnaXN0ZXIgYWRkcmVzcy4KPiAgICogQHZhbDogdmFsdWUuCj4gICAqCj4gQEAgLTI2NSwxNyAr
MTY2LDE5IEBAIHZvaWQgaW50ZWxfZHNiX2luZGV4ZWRfcmVnX3dyaXRlKHN0cnVjdCBpbnRlbF9k
c2IgKmRzYiwgaTkxNV9yZWdfdCByZWcsCj4gICAqIGFuZCByZXN0IGFsbCBlcnJvbmVvdXMgY29u
ZGl0aW9uIHJlZ2lzdGVyIHByb2dyYW1taW5nIGlzIGRvbmUKPiAgICogdGhyb3VnaCBtbWlvIHdy
aXRlLgo+ICAgKi8KPiAtdm9pZCBpbnRlbF9kc2JfcmVnX3dyaXRlKHN0cnVjdCBpbnRlbF9kc2Ig
KmRzYiwgaTkxNV9yZWdfdCByZWcsIHUzMiB2YWwpCj4gK3ZvaWQgaW50ZWxfZHNiX3JlZ193cml0
ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiArCQkJIGk5MTVf
cmVnX3QgcmVnLCB1MzIgdmFsKQo+ICB7Cj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IGNv
bnRhaW5lcl9vZihkc2IsIHR5cGVvZigqY3J0YyksIGRzYik7Cj4gKwlzdHJ1Y3QgaW50ZWxfZHNi
ICpkc2IgPSBjcnRjX3N0YXRlLT5kc2I7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRv
X2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiAgCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ICAJdTMyICpidWYg
PSBkc2ItPmNtZF9idWY7Cj4gIAo+IC0JaWYgKCFidWYpIHsKPiArCWlmICghKGRzYiAmJiBkc2It
PmNtZF9idWYpKSB7CmlmICghZHNiKSBzaG91bGQgYmUgZW5vdWdoIHdpdGggcHJvcGVyIGVycm9y
IGhhbmRsaW5nLiA6KQo+ICAJCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCByZWcsIHZhbCk7Cj4g
IAkJcmV0dXJuOwo+ICAJfQo+IC0KPiArCWJ1ZiA9IGRzYi0+Y21kX2J1ZjsKPiAgCWlmIChkcm1f
V0FSTl9PTigmZGV2X3ByaXYtPmRybSwgZHNiLT5mcmVlX3BvcyA+PSBEU0JfQlVGX1NJWkUpKSB7
Cj4gIAkJZHJtX2RiZ19rbXMoJmRldl9wcml2LT5kcm0sICJEU0IgYnVmZmVyIG92ZXJmbG93XG4i
KTsKPiAgCQlyZXR1cm47Cj4gQEAgLTI5MCwyNiArMTkzLDI3IEBAIHZvaWQgaW50ZWxfZHNiX3Jl
Z193cml0ZShzdHJ1Y3QgaW50ZWxfZHNiICpkc2IsIGk5MTVfcmVnX3QgcmVnLCB1MzIgdmFsKQo+
ICAKPiAgLyoqCj4gICAqIGludGVsX2RzYl9jb21taXQoKSAtIFRyaWdnZXIgd29ya2xvYWQgZXhl
Y3V0aW9uIG9mIERTQi4KPiAtICogQGRzYjogaW50ZWxfZHNiIHN0cnVjdHVyZS4KPiArICogQGNy
dGNfc3RhdGU6IGludGVsX2NydGNfc3RhdGUgc3RydWN0dXJlCj4gICAqCj4gICAqIFRoaXMgZnVu
Y3Rpb24gaXMgdXNlZCB0byBkbyBhY3R1YWwgd3JpdGUgdG8gaGFyZHdhcmUgdXNpbmcgRFNCLgo+
ICAgKiBPbiBlcnJvcnMsIGZhbGwgYmFjayB0byBNTUlPLiBBbHNvIHRoaXMgZnVuY3Rpb24gaGVs
cCB0byByZXNldCB0aGUgY29udGV4dC4KPiAgICovCj4gLXZvaWQgaW50ZWxfZHNiX2NvbW1pdChz
dHJ1Y3QgaW50ZWxfZHNiICpkc2IpCj4gK3ZvaWQgaW50ZWxfZHNiX2NvbW1pdChjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2Ny
dGMgKmNydGMgPSBjb250YWluZXJfb2YoZHNiLCB0eXBlb2YoKmNydGMpLCBkc2IpOwo+ICsJc3Ry
dWN0IGludGVsX2RzYiAqZHNiID0gY3J0Y19zdGF0ZS0+ZHNiOwo+ICsJc3RydWN0IGludGVsX2Ny
dGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gIAlzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gIAllbnVtIHBpcGUgcGlwZSA9IGNy
dGMtPnBpcGU7Cj4gIAl1MzIgdGFpbDsKPiAgCj4gLQlpZiAoIWRzYi0+ZnJlZV9wb3MpCj4gKwlp
ZiAoIShkc2IgJiYgZHNiLT5mcmVlX3BvcykpCj4gIAkJcmV0dXJuOwo+ICAKPiAtCWlmICghaW50
ZWxfZHNiX2VuYWJsZV9lbmdpbmUoZHNiKSkKPiArCWlmICghaW50ZWxfZHNiX2VuYWJsZV9lbmdp
bmUoZGV2X3ByaXYsIHBpcGUsIGRzYi0+aWQpKQo+ICAJCWdvdG8gcmVzZXQ7Cj4gIAo+IC0JaWYg
KGlzX2RzYl9idXN5KGRzYikpIHsKPiArCWlmIChpc19kc2JfYnVzeShkZXZfcHJpdiwgcGlwZSwg
ZHNiLT5pZCkpIHsKPiAgCQlkcm1fZXJyKCZkZXZfcHJpdi0+ZHJtLAo+ICAJCQkiSEVBRF9QVFIg
d3JpdGUgZmFpbGVkIC0gZHNiIGVuZ2luZSBpcyBidXN5LlxuIik7Cj4gIAkJZ290byByZXNldDsK
PiBAQCAtMzIyLDcgKzIyNiw3IEBAIHZvaWQgaW50ZWxfZHNiX2NvbW1pdChzdHJ1Y3QgaW50ZWxf
ZHNiICpkc2IpCj4gIAkJbWVtc2V0KCZkc2ItPmNtZF9idWZbZHNiLT5mcmVlX3Bvc10sIDAsCj4g
IAkJICAgICAgICh0YWlsIC0gZHNiLT5mcmVlX3BvcyAqIDQpKTsKPiAgCj4gLQlpZiAoaXNfZHNi
X2J1c3koZHNiKSkgewo+ICsJaWYgKGlzX2RzYl9idXN5KGRldl9wcml2LCBwaXBlLCBkc2ItPmlk
KSkgewo+ICAJCWRybV9lcnIoJmRldl9wcml2LT5kcm0sCj4gIAkJCSJUQUlMX1BUUiB3cml0ZSBm
YWlsZWQgLSBkc2IgZW5naW5lIGlzIGJ1c3kuXG4iKTsKPiAgCQlnb3RvIHJlc2V0Owo+IEBAIC0z
MzIsNyArMjM2LDcgQEAgdm9pZCBpbnRlbF9kc2JfY29tbWl0KHN0cnVjdCBpbnRlbF9kc2IgKmRz
YikKPiAgCQkgICAgaTkxNV9nZ3R0X29mZnNldChkc2ItPnZtYSksIHRhaWwpOwo+ICAJaW50ZWxf
ZGVfd3JpdGUoZGV2X3ByaXYsIERTQl9UQUlMKHBpcGUsIGRzYi0+aWQpLAo+ICAJCSAgICAgICBp
OTE1X2dndHRfb2Zmc2V0KGRzYi0+dm1hKSArIHRhaWwpOwo+IC0JaWYgKHdhaXRfZm9yKCFpc19k
c2JfYnVzeShkc2IpLCAxKSkgewo+ICsJaWYgKHdhaXRfZm9yKCFpc19kc2JfYnVzeShkZXZfcHJp
diwgcGlwZSwgZHNiLT5pZCksIDEpKSB7Cj4gIAkJZHJtX2VycigmZGV2X3ByaXYtPmRybSwKPiAg
CQkJIlRpbWVkIG91dCB3YWl0aW5nIGZvciBEU0Igd29ya2xvYWQgY29tcGxldGlvbi5cbiIpOwo+
ICAJCWdvdG8gcmVzZXQ7Cj4gQEAgLTM0MSw1ICsyNDUsNzUgQEAgdm9pZCBpbnRlbF9kc2JfY29t
bWl0KHN0cnVjdCBpbnRlbF9kc2IgKmRzYikKPiAgcmVzZXQ6Cj4gIAlkc2ItPmZyZWVfcG9zID0g
MDsKPiAgCWRzYi0+aW5zX3N0YXJ0X29mZnNldCA9IDA7Cj4gLQlpbnRlbF9kc2JfZGlzYWJsZV9l
bmdpbmUoZHNiKTsKPiArCWludGVsX2RzYl9kaXNhYmxlX2VuZ2luZShkZXZfcHJpdiwgcGlwZSwg
ZHNiLT5pZCk7Cj4gK30KPiArCj4gKy8qKgo+ICsgKiBpbnRlbF9kc2JfcHJlcGFyZSgpIC0gQWxs
b2NhdGUsIHBpbiBhbmQgbWFwIHRoZSBEU0IgY29tbWFuZCBidWZmZXIuCj4gKyAqIEBjcnRjX3N0
YXRlOiBpbnRlbF9jcnRjX3N0YXRlIHN0cnVjdHVyZSB0byBwcmVwYXJlIGFzc29jaWF0ZWQgZHNi
IGluc3RhbmNlLgo+ICsgKgo+ICsgKiBUaGlzIGZ1bmN0aW9uIHByZXBhcmUgdGhlIGNvbW1hbmQg
YnVmZmVyIHdoaWNoIGlzIHVzZWQgdG8gc3RvcmUgZHNiCj4gKyAqIGluc3RydWN0aW9ucyB3aXRo
IGRhdGEuCj4gKyAqLwo+ICt2b2lkIGludGVsX2RzYl9wcmVwYXJlKHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlKQo+ICt7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRv
X2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgaW50ZWxf
ZHNiICpkc2I7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwo+ICsJc3RydWN0
IGk5MTVfdm1hICp2bWE7Cj4gKwl1MzIgKmJ1ZjsKPiArCWludGVsX3dha2VyZWZfdCB3YWtlcmVm
Owo+ICsKPiArCWlmICghSEFTX0RTQihpOTE1KSkKPiArCQlyZXR1cm47Cj4gKwo+ICsJZHNiID0g
a21hbGxvYyhzaXplb2YoKmRzYiksIEdGUF9LRVJORUwpOwo+ICsKPiArCXdha2VyZWYgPSBpbnRl
bF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7Cj4gKwo+ICsJb2JqID0gaTkxNV9n
ZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5hbChpOTE1LCBEU0JfQlVGX1NJWkUpOwo+ICsJaWYgKElT
X0VSUihvYmopKSB7Cj4gKwkJZHJtX2VycigmaTkxNS0+ZHJtLCAiR2VtIG9iamVjdCBjcmVhdGlv
biBmYWlsZWRcbiIpOwo+ICsJCWdvdG8gb3V0Owo+ICsJfQo+ICsKPiArCXZtYSA9IGk5MTVfZ2Vt
X29iamVjdF9nZ3R0X3BpbihvYmosIE5VTEwsIDAsIDAsIDApOwo+ICsJaWYgKElTX0VSUih2bWEp
KSB7Cj4gKwkJZHJtX2VycigmaTkxNS0+ZHJtLCAiVm1hIGNyZWF0aW9uIGZhaWxlZFxuIik7Cj4g
KwkJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOwo+ICsJCWdvdG8gb3V0Owo+ICsJfQo+ICsKPiAr
CWJ1ZiA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKHZtYS0+b2JqLCBJOTE1X01BUF9XQyk7Cj4g
KwlpZiAoSVNfRVJSKGJ1ZikpIHsKPiArCQlkcm1fZXJyKCZpOTE1LT5kcm0sICJDb21tYW5kIGJ1
ZmZlciBjcmVhdGlvbiBmYWlsZWRcbiIpOwo+ICsJCWdvdG8gb3V0Owo+ICsJfQo+ICsKPiArCWRz
Yi0+aWQgPSBEU0IxOwo+ICsJZHNiLT52bWEgPSB2bWE7Cj4gKwlkc2ItPmNtZF9idWYgPSBidWY7
Cj4gKwlkc2ItPmZyZWVfcG9zID0gMDsKPiArCWRzYi0+aW5zX3N0YXJ0X29mZnNldCA9IDA7Cj4g
KwljcnRjX3N0YXRlLT5kc2IgPSBkc2I7Cj4gK291dDoKPiArCWludGVsX3J1bnRpbWVfcG1fcHV0
KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKWW91ciBlcnJvciBoYW5kbGluZyBuZWVkIHdv
cmssIHBsZWFzZSBmaXggdGhlbS4gOikKPiArfQo+ICsKPiArLyoqCj4gKyAqIGludGVsX2RzYl9j
bGVhbnVwKCkgLSBUbyBjbGVhbnVwIERTQiBjb250ZXh0Lgo+ICsgKiBAY3J0Y19zdGF0ZTogaW50
ZWxfY3J0Y19zdGF0ZSBzdHJ1Y3R1cmUgdG8gY2xlYW51cCBhc3NvY2lhdGVkIGRzYiBpbnN0YW5j
ZS4KPiArICoKPiArICogVGhpcyBmdW5jdGlvbiBjbGVhbnVwIHRoZSBEU0IgY29udGV4dCBieSB1
bnBpbm5pbmcgYW5kIHJlbGVhc2luZwo+ICsgKiB0aGUgVk1BIG9iamVjdCBhc3NvY2lhdGVkIHdp
dGggaXQuCj4gKyAqLwo+ICt2b2lkIGludGVsX2RzYl9jbGVhbnVwKHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlKQo+ICt7Cj4gKwlpZiAoIWNydGNfc3RhdGUtPmRzYikKPiArCQly
ZXR1cm47Cj4gKwo+ICsJaTkxNV92bWFfdW5waW5fYW5kX3JlbGVhc2UoJmNydGNfc3RhdGUtPmRz
Yi0+dm1hLCBJOTE1X1ZNQV9SRUxFQVNFX01BUCk7Cj4gKwlrZnJlZShjcnRjX3N0YXRlLT5kc2Ip
Owo+ICsJY3J0Y19zdGF0ZS0+ZHNiID0gTlVMTDsKPiAgfQoKT3RoZXJ3aXNlIGxvb2tzIGdvb2Qu
CgoKfk1hYXJ0ZW4KCgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2RzYi5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kc2IuaAo+
IGluZGV4IDM5NWVmOWNlNTU4ZS4uNjU0YTExZjI0YjgwIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHNiLmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2RzYi5oCj4gQEAgLTEwLDcgKzEwLDcgQEAKPiAgCj4gICNpbmNs
dWRlICJpOTE1X3JlZy5oIgo+ICAKPiAtc3RydWN0IGludGVsX2NydGM7Cj4gK3N0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlOwo+ICBzdHJ1Y3QgaTkxNV92bWE7Cj4gIAo+ICBlbnVtIGRzYl9pZCB7Cj4g
QEAgLTIyLDcgKzIyLDYgQEAgZW51bSBkc2JfaWQgewo+ICB9Owo+ICAKPiAgc3RydWN0IGludGVs
X2RzYiB7Cj4gLQlsb25nIHJlZmNvdW50Owo+ICAJZW51bSBkc2JfaWQgaWQ7Cj4gIAl1MzIgKmNt
ZF9idWY7Cj4gIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKPiBAQCAtNDEsMTIgKzQwLDEyIEBAIHN0
cnVjdCBpbnRlbF9kc2Igewo+ICAJdTMyIGluc19zdGFydF9vZmZzZXQ7Cj4gIH07Cj4gIAo+IC1z
dHJ1Y3QgaW50ZWxfZHNiICoKPiAtaW50ZWxfZHNiX2dldChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
Yyk7Cj4gLXZvaWQgaW50ZWxfZHNiX3B1dChzdHJ1Y3QgaW50ZWxfZHNiICpkc2IpOwo+IC12b2lk
IGludGVsX2RzYl9yZWdfd3JpdGUoc3RydWN0IGludGVsX2RzYiAqZHNiLCBpOTE1X3JlZ190IHJl
ZywgdTMyIHZhbCk7Cj4gLXZvaWQgaW50ZWxfZHNiX2luZGV4ZWRfcmVnX3dyaXRlKHN0cnVjdCBp
bnRlbF9kc2IgKmRzYiwgaTkxNV9yZWdfdCByZWcsCj4gLQkJCQkgdTMyIHZhbCk7Cj4gLXZvaWQg
aW50ZWxfZHNiX2NvbW1pdChzdHJ1Y3QgaW50ZWxfZHNiICpkc2IpOwo+ICt2b2lkIGludGVsX2Rz
Yl9wcmVwYXJlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKTsKPiArdm9pZCBp
bnRlbF9kc2JfY2xlYW51cChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7Cj4g
K3ZvaWQgaW50ZWxfZHNiX3JlZ193cml0ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSwKPiArCQkJIGk5MTVfcmVnX3QgcmVnLCB1MzIgdmFsKTsKPiArdm9pZCBpbnRl
bF9kc2JfaW5kZXhlZF9yZWdfd3JpdGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUsCj4gKwkJCQkgaTkxNV9yZWdfdCByZWcsIHUzMiB2YWwpOwo+ICt2b2lkIGludGVs
X2RzYl9jb21taXQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpOwo+
ICAKPiAgI2VuZGlmCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Au
b3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwt
Z2Z4Cg==

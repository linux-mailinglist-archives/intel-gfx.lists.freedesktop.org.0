Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id EC77276129
	for <lists+intel-gfx@lfdr.de>; Fri, 26 Jul 2019 10:46:39 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 313356E8B2;
	Fri, 26 Jul 2019 08:46:33 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A52EA6E8A7
 for <intel-gfx@lists.freedesktop.org>; Fri, 26 Jul 2019 08:46:26 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17621102-1500050 
 for multiple; Fri, 26 Jul 2019 09:46:18 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 26 Jul 2019 09:46:13 +0100
Message-Id: <20190726084613.22129-27-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20190726084613.22129-1-chris@chris-wilson.co.uk>
References: <20190726084613.22129-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 27/27] drm/i915: Markup expected timeline locks
 for i915_active
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QXMgZXZlcnkgaTkxNV9hY3RpdmVfcmVxdWVzdCBzaG91bGQgYmUgc2VyaWFsaXNlZCBieSBhIGRl
ZGljYXRlZCBsb2NrLAppOTE1X2FjdGl2ZSBjb25zaXN0cyBvZiBhIHRyZWUgb2YgbG9ja3M7IG9u
ZSBmb3IgZWFjaCBub2RlLiBNYXJrdXAgdXAKdGhlIGk5MTVfYWN0aXZlX3JlcXVlc3Qgd2l0aCB3
aGF0IGxvY2sgaXMgc3VwcG9zZWQgdG8gYmUgZ3VhcmRpbmcgaXQgc28KdGhhdCB3ZSBjYW4gdmVy
aWZ5IHRoYXQgdGhlIHNlcmlhbGlzZWQgdXBkYXRlZCBhcmUgaW5kZWVkIHNlcmlhbGlzZWQuCgpT
aWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KLS0t
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX292ZXJsYXkuYyAgICAgfCAgMiAr
LQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NsaWVudF9ibHQuYyAgIHwgIDIg
Ky0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMgICAgICB8ICAy
ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMgICAgICAgICAgfCAg
MiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bvb2wuaCAgICAgIHwg
IDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3RpbWVsaW5lLmMgICAgICAgICB8
ICA3ICsrKy0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3RpbWVsaW5lLmMg
ICAgICB8ICA0ICsrKysKIC4uLi9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RzL21vY2tfdGltZWxp
bmUuYyAgICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5jICAgICAg
ICAgICAgICAgfCAxNiArKysrKysrKysrKy0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2FjdGl2ZS5oICAgICAgICAgICAgICAgfCAxMiArKysrKysrKysrLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfYWN0aXZlX3R5cGVzLmggICAgICAgICB8ICAzICsrKwogZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV92bWEuYyAgICAgICAgICAgICAgICAgIHwgIDQgKystLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfYWN0aXZlLmMgICAgIHwgIDMgKy0tCiAxMyBmaWxl
cyBjaGFuZ2VkLCA0MCBpbnNlcnRpb25zKCspLCAyMSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX292ZXJsYXkuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfb3ZlcmxheS5jCmluZGV4IDFhMTVmYTM0MjA1Yy4u
ZDVlMDZiNDYzNTY3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX292ZXJsYXkuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX292
ZXJsYXkuYwpAQCAtMjMwLDcgKzIzMCw3IEBAIGFsbG9jX3JlcXVlc3Qoc3RydWN0IGludGVsX292
ZXJsYXkgKm92ZXJsYXksIHZvaWQgKCpmbikoc3RydWN0IGludGVsX292ZXJsYXkgKikpCiAJaWYg
KElTX0VSUihycSkpCiAJCXJldHVybiBycTsKIAotCWVyciA9IGk5MTVfYWN0aXZlX3JlZigmb3Zl
cmxheS0+bGFzdF9mbGlwLCBycS0+ZmVuY2UuY29udGV4dCwgcnEpOworCWVyciA9IGk5MTVfYWN0
aXZlX3JlZigmb3ZlcmxheS0+bGFzdF9mbGlwLCBycS0+dGltZWxpbmUsIHJxKTsKIAlpZiAoZXJy
KSB7CiAJCWk5MTVfcmVxdWVzdF9hZGQocnEpOwogCQlyZXR1cm4gRVJSX1BUUihlcnIpOwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NsaWVudF9ibHQuYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jbGllbnRfYmx0LmMKaW5kZXggMjMx
MmEwYzZhZjg5Li5mMTViMGI4MmU1NjIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9jbGllbnRfYmx0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX2NsaWVudF9ibHQuYwpAQCAtMTk3LDcgKzE5Nyw3IEBAIHN0YXRpYyB2b2lkIGNs
ZWFyX3BhZ2VzX3dvcmtlcihzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCiAJICoga2VlcCB0cmFj
ayBvZiB0aGUgR1BVIGFjdGl2aXR5IHdpdGhpbiB0aGlzIHZtYS9yZXF1ZXN0LCBhbmQKIAkgKiBw
cm9wYWdhdGUgdGhlIHNpZ25hbCBmcm9tIHRoZSByZXF1ZXN0IHRvIHctPmRtYS4KIAkgKi8KLQll
cnIgPSBpOTE1X2FjdGl2ZV9yZWYoJnZtYS0+YWN0aXZlLCBycS0+ZmVuY2UuY29udGV4dCwgcnEp
OworCWVyciA9IGk5MTVfYWN0aXZlX3JlZigmdm1hLT5hY3RpdmUsIHJxLT50aW1lbGluZSwgcnEp
OwogCWlmIChlcnIpCiAJCWdvdG8gb3V0X3JlcXVlc3Q7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCmluZGV4IGUzMTQzMWZhMTQxZS4uZTU5NWZhMjM5Njc0
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKQEAgLTky
Nyw3ICs5MjcsNyBAQCBzdGF0aWMgaW50IGNvbnRleHRfYmFycmllcl90YXNrKHN0cnVjdCBpOTE1
X2dlbV9jb250ZXh0ICpjdHgsCiAJCWlmIChlbWl0KQogCQkJZXJyID0gZW1pdChycSwgZGF0YSk7
CiAJCWlmIChlcnIgPT0gMCkKLQkJCWVyciA9IGk5MTVfYWN0aXZlX3JlZigmY2ItPmJhc2UsIHJx
LT5mZW5jZS5jb250ZXh0LCBycSk7CisJCQllcnIgPSBpOTE1X2FjdGl2ZV9yZWYoJmNiLT5iYXNl
LCBycS0+dGltZWxpbmUsIHJxKTsKIAogCQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKIAkJaWYgKGVy
cikKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYwppbmRleCAyYmFlOWJjZmZj
MWMuLjhkNjQ3ZmYxZDMwMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfY29udGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQu
YwpAQCAtMzAwLDcgKzMwMCw3IEBAIGludCBpbnRlbF9jb250ZXh0X3ByZXBhcmVfcmVtb3RlX3Jl
cXVlc3Qoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAogCSAqIHdvcmRzIHRyYW5zZmVyIHRoZSBw
aW5uZWQgY2Ugb2JqZWN0IHRvIHRyYWNrZWQgYWN0aXZlIHJlcXVlc3QuCiAJICovCiAJR0VNX0JV
R19PTihpOTE1X2FjdGl2ZV9pc19pZGxlKCZjZS0+YWN0aXZlKSk7Ci0JZXJyID0gaTkxNV9hY3Rp
dmVfcmVmKCZjZS0+YWN0aXZlLCBycS0+ZmVuY2UuY29udGV4dCwgcnEpOworCWVyciA9IGk5MTVf
YWN0aXZlX3JlZigmY2UtPmFjdGl2ZSwgcnEtPnRpbWVsaW5lLCBycSk7CiAKIHVubG9jazoKIAlp
ZiAocnEtPnRpbWVsaW5lICE9IHRsKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZW5naW5lX3Bvb2wuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2Vu
Z2luZV9wb29sLmgKaW5kZXggZjdhMGE2NjBjMWM5Li44ZDA2OWVmZDk0NTcgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wb29sLmgKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bvb2wuaApAQCAtMTgsNyArMTgsNyBAQCBz
dGF0aWMgaW5saW5lIGludAogaW50ZWxfZW5naW5lX3Bvb2xfbWFya19hY3RpdmUoc3RydWN0IGlu
dGVsX2VuZ2luZV9wb29sX25vZGUgKm5vZGUsCiAJCQkgICAgICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0
ICpycSkKIHsKLQlyZXR1cm4gaTkxNV9hY3RpdmVfcmVmKCZub2RlLT5hY3RpdmUsIHJxLT5mZW5j
ZS5jb250ZXh0LCBycSk7CisJcmV0dXJuIGk5MTVfYWN0aXZlX3JlZigmbm9kZS0+YWN0aXZlLCBy
cS0+dGltZWxpbmUsIHJxKTsKIH0KIAogc3RhdGljIGlubGluZSB2b2lkCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF90aW1lbGluZS5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfdGltZWxpbmUuYwppbmRleCBlYWZkOTRkNWUyMTEuLjAyZmJlMTFiNjcx
YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfdGltZWxpbmUuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF90aW1lbGluZS5jCkBAIC0yNTQsNyAr
MjU0LDcgQEAgaW50IGludGVsX3RpbWVsaW5lX2luaXQoc3RydWN0IGludGVsX3RpbWVsaW5lICp0
aW1lbGluZSwKIAogCW11dGV4X2luaXQoJnRpbWVsaW5lLT5tdXRleCk7CiAKLQlJTklUX0FDVElW
RV9SRVFVRVNUKCZ0aW1lbGluZS0+bGFzdF9yZXF1ZXN0KTsKKwlJTklUX0FDVElWRV9SRVFVRVNU
KCZ0aW1lbGluZS0+bGFzdF9yZXF1ZXN0LCAmdGltZWxpbmUtPm11dGV4KTsKIAlJTklUX0xJU1Rf
SEVBRCgmdGltZWxpbmUtPnJlcXVlc3RzKTsKIAogCWk5MTVfc3luY21hcF9pbml0KCZ0aW1lbGlu
ZS0+c3luYyk7CkBAIC00NDAsOCArNDQwLDcgQEAgX19pbnRlbF90aW1lbGluZV9nZXRfc2Vxbm8o
c3RydWN0IGludGVsX3RpbWVsaW5lICp0bCwKIAkgKiBmcmVlIGl0IGFmdGVyIHRoZSBjdXJyZW50
IHJlcXVlc3QgaXMgcmV0aXJlZCwgd2hpY2ggZW5zdXJlcyB0aGF0CiAJICogYWxsIHdyaXRlcyBp
bnRvIHRoZSBjYWNoZWxpbmUgZnJvbSBwcmV2aW91cyByZXF1ZXN0cyBhcmUgY29tcGxldGUuCiAJ
ICovCi0JZXJyID0gaTkxNV9hY3RpdmVfcmVmKCZ0bC0+aHdzcF9jYWNoZWxpbmUtPmFjdGl2ZSwK
LQkJCSAgICAgIHRsLT5mZW5jZV9jb250ZXh0LCBycSk7CisJZXJyID0gaTkxNV9hY3RpdmVfcmVm
KCZ0bC0+aHdzcF9jYWNoZWxpbmUtPmFjdGl2ZSwgdGwsIHJxKTsKIAlpZiAoZXJyKQogCQlnb3Rv
IGVycl9jYWNoZWxpbmU7CiAKQEAgLTQ5Miw3ICs0OTEsNyBAQCBpbnQgaW50ZWxfdGltZWxpbmVf
Z2V0X3NlcW5vKHN0cnVjdCBpbnRlbF90aW1lbGluZSAqdGwsCiBzdGF0aWMgaW50IGNhY2hlbGlu
ZV9yZWYoc3RydWN0IGludGVsX3RpbWVsaW5lX2NhY2hlbGluZSAqY2wsCiAJCQkgc3RydWN0IGk5
MTVfcmVxdWVzdCAqcnEpCiB7Ci0JcmV0dXJuIGk5MTVfYWN0aXZlX3JlZigmY2wtPmFjdGl2ZSwg
cnEtPmZlbmNlLmNvbnRleHQsIHJxKTsKKwlyZXR1cm4gaTkxNV9hY3RpdmVfcmVmKCZjbC0+YWN0
aXZlLCBycS0+dGltZWxpbmUsIHJxKTsKIH0KIAogaW50IGludGVsX3RpbWVsaW5lX3JlYWRfaHdz
cChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpmcm9tLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Qvc2VsZnRlc3RfdGltZWxpbmUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3Nl
bGZ0ZXN0X3RpbWVsaW5lLmMKaW5kZXggZDU0MTEzNjk3NzQ1Li4zMjE0ODE0MDMxNjUgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3RpbWVsaW5lLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfdGltZWxpbmUuYwpAQCAtNjg5LDcgKzY4
OSw5IEBAIHN0YXRpYyBpbnQgbGl2ZV9od3NwX3dyYXAodm9pZCAqYXJnKQogCiAJCXRsLT5zZXFu
byA9IC00dTsKIAorCQltdXRleF9sb2NrX25lc3RlZCgmdGwtPm11dGV4LCBTSU5HTEVfREVQVEhf
TkVTVElORyk7CiAJCWVyciA9IGludGVsX3RpbWVsaW5lX2dldF9zZXFubyh0bCwgcnEsICZzZXFu
b1swXSk7CisJCW11dGV4X3VubG9jaygmdGwtPm11dGV4KTsKIAkJaWYgKGVycikgewogCQkJaTkx
NV9yZXF1ZXN0X2FkZChycSk7CiAJCQlnb3RvIG91dDsKQEAgLTcwNCw3ICs3MDYsOSBAQCBzdGF0
aWMgaW50IGxpdmVfaHdzcF93cmFwKHZvaWQgKmFyZykKIAkJfQogCQlod3NwX3NlcW5vWzBdID0g
dGwtPmh3c3Bfc2Vxbm87CiAKKwkJbXV0ZXhfbG9ja19uZXN0ZWQoJnRsLT5tdXRleCwgU0lOR0xF
X0RFUFRIX05FU1RJTkcpOwogCQllcnIgPSBpbnRlbF90aW1lbGluZV9nZXRfc2Vxbm8odGwsIHJx
LCAmc2Vxbm9bMV0pOworCQltdXRleF91bmxvY2soJnRsLT5tdXRleCk7CiAJCWlmIChlcnIpIHsK
IAkJCWk5MTVfcmVxdWVzdF9hZGQocnEpOwogCQkJZ290byBvdXQ7CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdHMvbW9ja190aW1lbGluZS5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RzL21vY2tfdGltZWxpbmUuYwppbmRleCA1YzU0OTIwNTgy
OGEuLjU5ODE3MGVmY2FmNiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2Vs
ZnRlc3RzL21vY2tfdGltZWxpbmUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxm
dGVzdHMvbW9ja190aW1lbGluZS5jCkBAIC0xNSw3ICsxNSw3IEBAIHZvaWQgbW9ja190aW1lbGlu
ZV9pbml0KHN0cnVjdCBpbnRlbF90aW1lbGluZSAqdGltZWxpbmUsIHU2NCBjb250ZXh0KQogCiAJ
bXV0ZXhfaW5pdCgmdGltZWxpbmUtPm11dGV4KTsKIAotCUlOSVRfQUNUSVZFX1JFUVVFU1QoJnRp
bWVsaW5lLT5sYXN0X3JlcXVlc3QpOworCUlOSVRfQUNUSVZFX1JFUVVFU1QoJnRpbWVsaW5lLT5s
YXN0X3JlcXVlc3QsICZ0aW1lbGluZS0+bXV0ZXgpOwogCUlOSVRfTElTVF9IRUFEKCZ0aW1lbGlu
ZS0+cmVxdWVzdHMpOwogCiAJaTkxNV9zeW5jbWFwX2luaXQoJnRpbWVsaW5lLT5zeW5jKTsKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5jCmluZGV4IGJiYjQ0YjA3MmQxYS4uMDM0OTc1NzE0YWEz
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMKQEAgLTEzMSwxMCArMTMxLDExIEBAIG5v
ZGVfcmV0aXJlKHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICpiYXNlLCBzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICpycSkKIH0KIAogc3RhdGljIHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICoKLWFj
dGl2ZV9pbnN0YW5jZShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwgdTY0IGlkeCkKK2FjdGl2ZV9p
bnN0YW5jZShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwgc3RydWN0IGludGVsX3RpbWVsaW5lICp0
bCkKIHsKIAlzdHJ1Y3QgYWN0aXZlX25vZGUgKm5vZGUsICpwcmVhbGxvYzsKIAlzdHJ1Y3QgcmJf
bm9kZSAqKnAsICpwYXJlbnQ7CisJdTY0IGlkeCA9IHRsLT5mZW5jZV9jb250ZXh0OwogCiAJLyoK
IAkgKiBXZSB0cmFjayB0aGUgbW9zdCByZWNlbnRseSB1c2VkIHRpbWVsaW5lIHRvIHNraXAgYSBy
YnRyZWUgc2VhcmNoCkBAIC0xNzMsNyArMTc0LDcgQEAgYWN0aXZlX2luc3RhbmNlKHN0cnVjdCBp
OTE1X2FjdGl2ZSAqcmVmLCB1NjQgaWR4KQogCX0KIAogCW5vZGUgPSBwcmVhbGxvYzsKLQlpOTE1
X2FjdGl2ZV9yZXF1ZXN0X2luaXQoJm5vZGUtPmJhc2UsIE5VTEwsIG5vZGVfcmV0aXJlKTsKKwlp
OTE1X2FjdGl2ZV9yZXF1ZXN0X2luaXQoJm5vZGUtPmJhc2UsICZ0bC0+bXV0ZXgsIE5VTEwsIG5v
ZGVfcmV0aXJlKTsKIAlub2RlLT5yZWYgPSByZWY7CiAJbm9kZS0+dGltZWxpbmUgPSBpZHg7CiAK
QEAgLTIwOCwyMCArMjA5LDIxIEBAIHZvaWQgX19pOTE1X2FjdGl2ZV9pbml0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAogfQogCiBpbnQgaTkxNV9hY3RpdmVfcmVmKHN0cnVjdCBpOTE1
X2FjdGl2ZSAqcmVmLAotCQkgICAgdTY0IHRpbWVsaW5lLAorCQkgICAgc3RydWN0IGludGVsX3Rp
bWVsaW5lICp0bCwKIAkJICAgIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogewogCXN0cnVjdCBp
OTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmU7CiAJaW50IGVycjsKIAotCUdFTV9CVUdfT04oIXRp
bWVsaW5lKTsgLyogcmVzZXJ2ZWQgZm9yIGlkbGUtYmFycmllciAqLworCUdFTV9CVUdfT04oIXRs
LT5mZW5jZV9jb250ZXh0KTsgLyogcmVzZXJ2ZWQgZm9yIGlkbGUtYmFycmllciAqLworCWxvY2tk
ZXBfYXNzZXJ0X2hlbGQoJnRsLT5tdXRleCk7CiAKIAkvKiBQcmV2ZW50IHJlYXBpbmcgaW4gY2Fz
ZSB3ZSBtYWxsb2Mvd2FpdCB3aGlsZSBidWlsZGluZyB0aGUgdHJlZSAqLwogCWVyciA9IGk5MTVf
YWN0aXZlX2FjcXVpcmUocmVmKTsKIAlpZiAoZXJyKQogCQlyZXR1cm4gZXJyOwogCi0JYWN0aXZl
ID0gYWN0aXZlX2luc3RhbmNlKHJlZiwgdGltZWxpbmUpOworCWFjdGl2ZSA9IGFjdGl2ZV9pbnN0
YW5jZShyZWYsIHRsKTsKIAlpZiAoIWFjdGl2ZSkgewogCQllcnIgPSAtRU5PTUVNOwogCQlnb3Rv
IG91dDsKQEAgLTUxMCw2ICs1MTIsMTAgQEAgaW50IGk5MTVfYWN0aXZlX3JlcXVlc3Rfc2V0KHN0
cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUsCiB7CiAJaW50IGVycjsKIAorI2lmIElT
X0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X0RFQlVHX0dFTSkKKwlsb2NrZGVwX2Fzc2VydF9oZWxk
KGFjdGl2ZS0+bG9jayk7CisjZW5kaWYKKwogCS8qIE11c3QgbWFpbnRhaW4gb3JkZXJpbmcgd3J0
IHByZXZpb3VzIGFjdGl2ZSByZXF1ZXN0cyAqLwogCWVyciA9IGk5MTVfcmVxdWVzdF9hd2FpdF9h
Y3RpdmVfcmVxdWVzdChycSwgYWN0aXZlKTsKIAlpZiAoZXJyKQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
YWN0aXZlLmgKaW5kZXggYWQyOGI4NjZlYjg3Li43MzQyNTIyNGQ5MzQgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9hY3RpdmUuaApAQCAtNTgsMTUgKzU4LDIwIEBAIHZvaWQgaTkxNV9hY3RpdmVfcmV0
aXJlX25vb3Aoc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2ZSwKICAqLwogc3RhdGlj
IGlubGluZSB2b2lkCiBpOTE1X2FjdGl2ZV9yZXF1ZXN0X2luaXQoc3RydWN0IGk5MTVfYWN0aXZl
X3JlcXVlc3QgKmFjdGl2ZSwKKwkJCSBzdHJ1Y3QgbXV0ZXggKmxvY2ssCiAJCQkgc3RydWN0IGk5
MTVfcmVxdWVzdCAqcnEsCiAJCQkgaTkxNV9hY3RpdmVfcmV0aXJlX2ZuIHJldGlyZSkKIHsKIAlS
Q1VfSU5JVF9QT0lOVEVSKGFjdGl2ZS0+cmVxdWVzdCwgcnEpOwogCUlOSVRfTElTVF9IRUFEKCZh
Y3RpdmUtPmxpbmspOwogCWFjdGl2ZS0+cmV0aXJlID0gcmV0aXJlID86IGk5MTVfYWN0aXZlX3Jl
dGlyZV9ub29wOworI2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X0RFQlVHX0dFTSkKKwlh
Y3RpdmUtPmxvY2sgPSBsb2NrOworI2VuZGlmCiB9CiAKLSNkZWZpbmUgSU5JVF9BQ1RJVkVfUkVR
VUVTVChuYW1lKSBpOTE1X2FjdGl2ZV9yZXF1ZXN0X2luaXQoKG5hbWUpLCBOVUxMLCBOVUxMKQor
I2RlZmluZSBJTklUX0FDVElWRV9SRVFVRVNUKG5hbWUsIGxvY2spIFwKKwlpOTE1X2FjdGl2ZV9y
ZXF1ZXN0X2luaXQoKG5hbWUpLCAobG9jayksIE5VTEwsIE5VTEwpCiAKIC8qKgogICogaTkxNV9h
Y3RpdmVfcmVxdWVzdF9zZXQgLSB1cGRhdGVzIHRoZSB0cmFja2VyIHRvIHdhdGNoIHRoZSBjdXJy
ZW50IHJlcXVlc3QKQEAgLTgxLDYgKzg2LDkgQEAgc3RhdGljIGlubGluZSB2b2lkCiBfX2k5MTVf
YWN0aXZlX3JlcXVlc3Rfc2V0KHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUsCiAJ
CQkgIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QpCiB7CisjaWYgSVNfRU5BQkxFRChDT05G
SUdfRFJNX0k5MTVfREVCVUdfR0VNKQorCWxvY2tkZXBfYXNzZXJ0X2hlbGQoYWN0aXZlLT5sb2Nr
KTsKKyNlbmRpZgogCWxpc3RfbW92ZSgmYWN0aXZlLT5saW5rLCAmcmVxdWVzdC0+YWN0aXZlX2xp
c3QpOwogCXJjdV9hc3NpZ25fcG9pbnRlcihhY3RpdmUtPnJlcXVlc3QsIHJlcXVlc3QpOwogfQpA
QCAtMzYyLDcgKzM3MCw3IEBAIHZvaWQgX19pOTE1X2FjdGl2ZV9pbml0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAogfSB3aGlsZSAoMCkKIAogaW50IGk5MTVfYWN0aXZlX3JlZihzdHJ1
Y3QgaTkxNV9hY3RpdmUgKnJlZiwKLQkJICAgIHU2NCB0aW1lbGluZSwKKwkJICAgIHN0cnVjdCBp
bnRlbF90aW1lbGluZSAqdGwsCiAJCSAgICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSk7CiAKIGlu
dCBpOTE1X2FjdGl2ZV93YWl0KHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKTsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlX3R5cGVzLmggYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2FjdGl2ZV90eXBlcy5oCmluZGV4IDc0NzQzZGQwZDVmMC4uYTIxZWM3ZTAw
ZjVhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZV90eXBlcy5o
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlX3R5cGVzLmgKQEAgLTI0LDYg
KzI0LDkgQEAgc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgewogCXN0cnVjdCBpOTE1X3JlcXVl
c3QgX19yY3UgKnJlcXVlc3Q7CiAJc3RydWN0IGxpc3RfaGVhZCBsaW5rOwogCWk5MTVfYWN0aXZl
X3JldGlyZV9mbiByZXRpcmU7CisjaWYgSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfREVCVUdf
R0VNKQorCXN0cnVjdCBtdXRleCAqbG9jazsKKyNlbmRpZgogfTsKIAogc3RydWN0IGFjdGl2ZV9u
b2RlOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMKaW5kZXggYzM4Nzc3MGMzNzY0Li5mN2Y1MTZhNzVj
NjYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYwpAQCAtOTE5LDcgKzkxOSw3IEBAIGludCBpOTE1
X3ZtYV9tb3ZlX3RvX2FjdGl2ZShzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKIAkgKiBhZGQgdGhlIGFj
dGl2ZSByZWZlcmVuY2UgZmlyc3QgYW5kIHF1ZXVlIGZvciBpdCB0byBiZSBkcm9wcGVkCiAJICog
Kmxhc3QqLgogCSAqLwotCWVyciA9IGk5MTVfYWN0aXZlX3JlZigmdm1hLT5hY3RpdmUsIHJxLT5m
ZW5jZS5jb250ZXh0LCBycSk7CisJZXJyID0gaTkxNV9hY3RpdmVfcmVmKCZ2bWEtPmFjdGl2ZSwg
cnEtPnRpbWVsaW5lLCBycSk7CiAJaWYgKHVubGlrZWx5KGVycikpCiAJCXJldHVybiBlcnI7CiAK
QEAgLTkyOSw3ICs5MjksNyBAQCBpbnQgaTkxNV92bWFfbW92ZV90b19hY3RpdmUoc3RydWN0IGk5
MTVfdm1hICp2bWEsCiAKIAkJaWYgKGludGVsX2Zyb250YnVmZmVyX2ludmFsaWRhdGUob2JqLT5m
cm9udGJ1ZmZlciwgT1JJR0lOX0NTKSkKIAkJCWk5MTVfYWN0aXZlX3JlZigmb2JqLT5mcm9udGJ1
ZmZlci0+d3JpdGUsCi0JCQkJCXJxLT5mZW5jZS5jb250ZXh0LAorCQkJCQlycS0+dGltZWxpbmUs
CiAJCQkJCXJxKTsKIAogCQlvYmotPnJlYWRfZG9tYWlucyA9IDA7CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9hY3RpdmUuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2FjdGl2ZS5jCmluZGV4IGU1Y2Q1ZDQ3ZTM4MC4uNzdkODQ0
YWM4YjcxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9h
Y3RpdmUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9hY3RpdmUu
YwpAQCAtMTEwLDggKzExMCw3IEBAIF9fbGl2ZV9hY3RpdmVfc2V0dXAoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCiAJCQkJCQkgICAgICAgc3VibWl0LAogCQkJCQkJICAgICAgIEdGUF9L
RVJORUwpOwogCQlpZiAoZXJyID49IDApCi0JCQllcnIgPSBpOTE1X2FjdGl2ZV9yZWYoJmFjdGl2
ZS0+YmFzZSwKLQkJCQkJICAgICAgcnEtPmZlbmNlLmNvbnRleHQsIHJxKTsKKwkJCWVyciA9IGk5
MTVfYWN0aXZlX3JlZigmYWN0aXZlLT5iYXNlLCBycS0+dGltZWxpbmUsIHJxKTsKIAkJaTkxNV9y
ZXF1ZXN0X2FkZChycSk7CiAJCWlmIChlcnIpIHsKIAkJCXByX2VycigiRmFpbGVkIHRvIHRyYWNr
IGFjdGl2ZSByZWYhXG4iKTsKLS0gCjIuMjIuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlz
dHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4v
bGlzdGluZm8vaW50ZWwtZ2Z4

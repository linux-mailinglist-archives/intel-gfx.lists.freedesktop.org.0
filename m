Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 49C6C4231A
	for <lists+intel-gfx@lfdr.de>; Wed, 12 Jun 2019 12:57:27 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6EB6D892FB;
	Wed, 12 Jun 2019 10:57:25 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A458E892FB
 for <intel-gfx@lists.freedesktop.org>; Wed, 12 Jun 2019 10:57:23 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16875093-1500050 
 for <intel-gfx@lists.freedesktop.org>; Wed, 12 Jun 2019 11:57:19 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 12 Jun 2019 11:57:20 +0100
Message-Id: <20190612105720.30310-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
MIME-Version: 1.0
Subject: [Intel-gfx] [CI] drm/i915: Combine unbound/bound list tracking for
 objects
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

V2l0aCBhc3luYyBiaW5kaW5nLCB3ZSBkb24ndCB3YW50IHRvIG1hbmFnZSBhIGJvdW5kL3VuYm91
bmQgbGlzdCBhcyB3ZQptYXkgZW5kIHVwIHJ1bm5pbmcgYmVmb3JlIHdlIGV2ZW4gYWNxdWlyZSB0
aGUgcGFnZXMuIEFsbCB0aGF0IGlzCnJlcXVpcmVkIGlzIGtlZXBpbmcgdHJhY2sgb2Ygc2hyaW5r
YWJsZSBvYmplY3RzLCBzbyByZWR1Y2UgaXQgdG8gdGhlCm1pbmltdW0gbGlzdC4KCkZpeGVzOiA2
OTUxZTU4OTNiNDggKCJkcm0vaTkxNTogTW92ZSBHRU0gb2JqZWN0IGRvbWFpbiBtYW5hZ2VtZW50
IGZyb20gc3RydWN0X211dGV4IHRvIGxvY2FsIikKU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29u
IDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+ClJldmlld2VkLWJ5OiBNYXR0aGV3IEF1bGQgPG1h
dHRoZXcud2lsbGlhbS5hdWxkQGdtYWlsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fZG9tYWluLmMgICAgfCAgMTEgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9vYmplY3QuYyAgICB8ICAgMiArLQogLi4uL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fb2JqZWN0X3R5cGVzLmggIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fcGFnZXMuYyAgICAgfCAgMTAgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9wbS5jICAgICAgICB8ICAzMCArKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9zaHJpbmtlci5jICB8ICAzMCArKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9zdG9sZW4uYyAgICB8ICAgNSArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9k
ZWJ1Z2ZzLmMgICAgICAgICAgIHwgMTkxICstLS0tLS0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9kcnYuaCAgICAgICAgICAgICAgIHwgIDE0ICstCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2dlbS5jICAgICAgICAgICAgICAgfCAgMzAgKystCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3ZtYS5jICAgICAgICAgICAgICAgfCAgMzQgKy0tLQogLi4uL2dwdS9kcm0v
aTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZXZpY3QuYyAgIHwgIDE2ICstCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZ3R0LmMgfCAgIDIgKy0KIDEzIGZpbGVzIGNoYW5n
ZWQsIDk1IGluc2VydGlvbnMoKyksIDI4MiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZG9tYWluLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fZG9tYWluLmMKaW5kZXggMzE5MjkyMjBiOTBmLi5iZDE4MGVmNDZh
ZWIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9kb21haW4u
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZG9tYWluLmMKQEAgLTIx
OSw3ICsyMTksNyBAQCBpbnQgaTkxNV9nZW1fb2JqZWN0X3NldF9jYWNoZV9sZXZlbChzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCSAqIHJld3JpdGUgdGhlIFBURSBpbiB0aGUgYmVs
aWVmIHRoYXQgZG9pbmcgc28gdHJhbXBsZXMgdXBvbiBsZXNzCiAJICogc3RhdGUgYW5kIHNvIGlu
dm9sdmVzIGxlc3Mgd29yay4KIAkgKi8KLQlpZiAob2JqLT5iaW5kX2NvdW50KSB7CisJaWYgKGF0
b21pY19yZWFkKCZvYmotPmJpbmRfY291bnQpKSB7CiAJCS8qIEJlZm9yZSB3ZSBjaGFuZ2UgdGhl
IFBURSwgdGhlIEdQVSBtdXN0IG5vdCBiZSBhY2Nlc3NpbmcgaXQuCiAJCSAqIElmIHdlIHdhaXQg
dXBvbiB0aGUgb2JqZWN0LCB3ZSBrbm93IHRoYXQgYWxsIHRoZSBib3VuZAogCQkgKiBWTUEgYXJl
IG5vIGxvbmdlciBhY3RpdmUuCkBAIC00ODAsMTMgKzQ4MCw4IEBAIHN0YXRpYyB2b2lkIGk5MTVf
Z2VtX29iamVjdF9idW1wX2luYWN0aXZlX2dndHQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iaikKIAogCQlzcGluX2xvY2tfaXJxc2F2ZSgmaTkxNS0+bW0ub2JqX2xvY2ssIGZsYWdzKTsK
IAotCQlpZiAob2JqLT5tbS5tYWR2ID09IEk5MTVfTUFEVl9XSUxMTkVFRCkgewotCQkJc3RydWN0
IGxpc3RfaGVhZCAqbGlzdDsKLQotCQkJbGlzdCA9IG9iai0+YmluZF9jb3VudCA/Ci0JCQkJJmk5
MTUtPm1tLmJvdW5kX2xpc3QgOiAmaTkxNS0+bW0udW5ib3VuZF9saXN0OwotCQkJbGlzdF9tb3Zl
X3RhaWwoJm9iai0+bW0ubGluaywgbGlzdCk7Ci0JCX0KKwkJaWYgKG9iai0+bW0ubWFkdiA9PSBJ
OTE1X01BRFZfV0lMTE5FRUQpCisJCQlsaXN0X21vdmVfdGFpbCgmb2JqLT5tbS5saW5rLCAmaTkx
NS0+bW0uc2hyaW5rX2xpc3QpOwogCiAJCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPm1t
Lm9ial9sb2NrLCBmbGFncyk7CiAJfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX29iamVjdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X29iamVjdC5jCmluZGV4IGQwMmExYWZmMjA1OC4uMzZiNzZjNmEwYTlkIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5jCkBAIC0yMTYsNyArMjE2LDcgQEAgc3Rh
dGljIHZvaWQgX19pOTE1X2dlbV9mcmVlX29iamVjdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCiAKIAkJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAotCQlH
RU1fQlVHX09OKG9iai0+YmluZF9jb3VudCk7CisJCUdFTV9CVUdfT04oYXRvbWljX3JlYWQoJm9i
ai0+YmluZF9jb3VudCkpOwogCQlHRU1fQlVHX09OKG9iai0+dXNlcmZhdWx0X2NvdW50KTsKIAkJ
R0VNX0JVR19PTihhdG9taWNfcmVhZCgmb2JqLT5mcm9udGJ1ZmZlcl9iaXRzKSk7CiAJCUdFTV9C
VUdfT04oIWxpc3RfZW1wdHkoJm9iai0+bHV0X2xpc3QpKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaAppbmRleCA5YzE2MWJhNzM1NTguLjVi
MDU2OTg2MTljZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X29iamVjdF90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9v
YmplY3RfdHlwZXMuaApAQCAtMTU1LDcgKzE1NSw3IEBAIHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0IHsKICNkZWZpbmUgU1RSSURFX01BU0sgKH5USUxJTkdfTUFTSykKIAogCS8qKiBDb3VudCBv
ZiBWTUEgYWN0dWFsbHkgYm91bmQgYnkgdGhpcyBvYmplY3QgKi8KLQl1bnNpZ25lZCBpbnQgYmlu
ZF9jb3VudDsKKwlhdG9taWNfdCBiaW5kX2NvdW50OwogCXVuc2lnbmVkIGludCBhY3RpdmVfY291
bnQ7CiAJLyoqIENvdW50IG9mIGhvdyBtYW55IGdsb2JhbCBWTUEgYXJlIGN1cnJlbnRseSBwaW5u
ZWQgZm9yIHVzZSBieSBIVyAqLwogCXVuc2lnbmVkIGludCBwaW5fZ2xvYmFsOwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BhZ2VzLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcGFnZXMuYwppbmRleCA3ZmY5MDdkNmQwYzYuLmIzNmFk
MjY5ZjRlYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3Bh
Z2VzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BhZ2VzLmMKQEAg
LTU3LDEzICs1NywxOSBAQCB2b2lkIF9faTkxNV9nZW1fb2JqZWN0X3NldF9wYWdlcyhzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCUdFTV9CVUdfT04oIUhBU19QQUdFX1NJWkVTKGk5
MTUsIG9iai0+bW0ucGFnZV9zaXplcy5zZykpOwogCiAJaWYgKGk5MTVfZ2VtX29iamVjdF9pc19z
aHJpbmthYmxlKG9iaikpIHsKKwkJc3RydWN0IGxpc3RfaGVhZCAqbGlzdDsKIAkJdW5zaWduZWQg
bG9uZyBmbGFnczsKIAogCQlzcGluX2xvY2tfaXJxc2F2ZSgmaTkxNS0+bW0ub2JqX2xvY2ssIGZs
YWdzKTsKIAogCQlpOTE1LT5tbS5zaHJpbmtfY291bnQrKzsKIAkJaTkxNS0+bW0uc2hyaW5rX21l
bW9yeSArPSBvYmotPmJhc2Uuc2l6ZTsKLQkJbGlzdF9hZGQoJm9iai0+bW0ubGluaywgJmk5MTUt
Pm1tLnVuYm91bmRfbGlzdCk7CisKKwkJaWYgKG9iai0+bW0ubWFkdiAhPSBJOTE1X01BRFZfV0lM
TE5FRUQpCisJCQlsaXN0ID0gJmk5MTUtPm1tLnB1cmdlX2xpc3Q7CisJCWVsc2UKKwkJCWxpc3Qg
PSAmaTkxNS0+bW0uc2hyaW5rX2xpc3Q7CisJCWxpc3RfYWRkX3RhaWwoJm9iai0+bW0ubGluaywg
bGlzdCk7CiAKIAkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+bW0ub2JqX2xvY2ssIGZs
YWdzKTsKIAl9CkBAIC0xOTMsNyArMTk5LDcgQEAgaW50IF9faTkxNV9nZW1fb2JqZWN0X3B1dF9w
YWdlcyhzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCWlmIChpOTE1X2dlbV9vYmpl
Y3RfaGFzX3Bpbm5lZF9wYWdlcyhvYmopKQogCQlyZXR1cm4gLUVCVVNZOwogCi0JR0VNX0JVR19P
TihvYmotPmJpbmRfY291bnQpOworCUdFTV9CVUdfT04oYXRvbWljX3JlYWQoJm9iai0+YmluZF9j
b3VudCkpOwogCiAJLyogTWF5IGJlIGNhbGxlZCBieSBzaHJpbmtlciBmcm9tIHdpdGhpbiBnZXRf
cGFnZXMoKSAob24gYW5vdGhlciBibykgKi8KIAltdXRleF9sb2NrX25lc3RlZCgmb2JqLT5tbS5s
b2NrLCBzdWJjbGFzcyk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fcG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5jCmluZGV4
IGY0MGYxM2MwYjhiNy4uZjY4YzBhZDFhYTQ3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fcG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fcG0uYwpAQCAtMTU4LDE1ICsxNTgsMjIgQEAgdm9pZCBpOTE1X2dlbV9zdXNwZW5kKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCWludGVsX3VjX3N1c3BlbmQoaTkxNSk7CiB9
CiAKK3N0YXRpYyBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqZmlyc3RfbW1fb2JqZWN0KHN0
cnVjdCBsaXN0X2hlYWQgKmxpc3QpCit7CisJcmV0dXJuIGxpc3RfZmlyc3RfZW50cnlfb3JfbnVs
bChsaXN0LAorCQkJCQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCwKKwkJCQkJbW0ubGluayk7
Cit9CisKIHZvaWQgaTkxNV9nZW1fc3VzcGVuZF9sYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQogewogCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CiAJc3RydWN0IGxp
c3RfaGVhZCAqcGhhc2VzW10gPSB7Ci0JCSZpOTE1LT5tbS51bmJvdW5kX2xpc3QsCi0JCSZpOTE1
LT5tbS5ib3VuZF9saXN0LAorCQkmaTkxNS0+bW0uc2hyaW5rX2xpc3QsCiAJCSZpOTE1LT5tbS5w
dXJnZV9saXN0LAogCQlOVUxMCiAJfSwgKipwaGFzZTsKKwl1bnNpZ25lZCBsb25nIGZsYWdzOwog
CiAJLyoKIAkgKiBOZWl0aGVyIHRoZSBCSU9TLCBvdXJzZWx2ZXMgb3IgYW55IG90aGVyIGtlcm5l
bApAQCAtMTg4LDEzICsxOTUsMzAgQEAgdm9pZCBpOTE1X2dlbV9zdXNwZW5kX2xhdGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJICogbWFjaGluZSBpbiBhbiB1bnVzYWJsZSBjb25k
aXRpb24uCiAJICovCiAKKwlzcGluX2xvY2tfaXJxc2F2ZSgmaTkxNS0+bW0ub2JqX2xvY2ssIGZs
YWdzKTsKIAlmb3IgKHBoYXNlID0gcGhhc2VzOyAqcGhhc2U7IHBoYXNlKyspIHsKLQkJbGlzdF9m
b3JfZWFjaF9lbnRyeShvYmosICpwaGFzZSwgbW0ubGluaykgeworCQlMSVNUX0hFQUQoa2VlcCk7
CisKKwkJd2hpbGUgKChvYmogPSBmaXJzdF9tbV9vYmplY3QoKnBoYXNlKSkpIHsKKwkJCWxpc3Rf
bW92ZV90YWlsKCZvYmotPm1tLmxpbmssICZrZWVwKTsKKworCQkJLyogQmV3YXJlIHRoZSBiYWNr
Z3JvdW5kIF9pOTE1X2dlbV9mcmVlX29iamVjdHMgKi8KKwkJCWlmICgha3JlZl9nZXRfdW5sZXNz
X3plcm8oJm9iai0+YmFzZS5yZWZjb3VudCkpCisJCQkJY29udGludWU7CisKKwkJCXNwaW5fdW5s
b2NrX2lycXJlc3RvcmUoJmk5MTUtPm1tLm9ial9sb2NrLCBmbGFncyk7CisKIAkJCWk5MTVfZ2Vt
X29iamVjdF9sb2NrKG9iaik7CiAJCQlXQVJOX09OKGk5MTVfZ2VtX29iamVjdF9zZXRfdG9fZ3R0
X2RvbWFpbihvYmosIGZhbHNlKSk7CiAJCQlpOTE1X2dlbV9vYmplY3RfdW5sb2NrKG9iaik7CisJ
CQlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CisKKwkJCXNwaW5fbG9ja19pcnFzYXZlKCZpOTE1
LT5tbS5vYmpfbG9jaywgZmxhZ3MpOwogCQl9CisKKwkJbGlzdF9zcGxpY2VfdGFpbCgma2VlcCwg
KnBoYXNlKTsKIAl9CisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+bW0ub2JqX2xvY2ss
IGZsYWdzKTsKIAogCWludGVsX3VjX3Nhbml0aXplKGk5MTUpOwogCWk5MTVfZ2VtX3Nhbml0aXpl
KGk5MTUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3No
cmlua2VyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fc2hyaW5rZXIuYwpp
bmRleCA3MGE0YzlkM2MwOTguLjFiOTNiYzMzNDYzMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3Nocmlua2VyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX3Nocmlua2VyLmMKQEAgLTY5LDcgKzY5LDcgQEAgc3RhdGljIGJvb2wg
Y2FuX3JlbGVhc2VfcGFnZXMoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIAkgKiB0
byB0aGUgR1BVLCBzaW1wbHkgdW5iaW5kaW5nIGZyb20gdGhlIEdQVSBpcyBub3QgZ29pbmcgdG8g
c3VjY2VlZAogCSAqIGluIHJlbGVhc2luZyBvdXIgcGluIGNvdW50IG9uIHRoZSBwYWdlcyB0aGVt
c2VsdmVzLgogCSAqLwotCWlmIChhdG9taWNfcmVhZCgmb2JqLT5tbS5wYWdlc19waW5fY291bnQp
ID4gb2JqLT5iaW5kX2NvdW50KQorCWlmIChhdG9taWNfcmVhZCgmb2JqLT5tbS5wYWdlc19waW5f
Y291bnQpID4gYXRvbWljX3JlYWQoJm9iai0+YmluZF9jb3VudCkpCiAJCXJldHVybiBmYWxzZTsK
IAogCS8qIElmIGFueSB2bWEgYXJlICJwZXJtYW5lbnRseSIgcGlubmVkLCBpdCB3aWxsIHByZXZl
bnQgdXMgZnJvbQpAQCAtMTQ1LDggKzE0NSwxMCBAQCBpOTE1X2dlbV9zaHJpbmsoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCXVuc2lnbmVkIGludCBiaXQ7CiAJfSBwaGFzZXNbXSA9
IHsKIAkJeyAmaTkxNS0+bW0ucHVyZ2VfbGlzdCwgfjB1IH0sCi0JCXsgJmk5MTUtPm1tLnVuYm91
bmRfbGlzdCwgSTkxNV9TSFJJTktfVU5CT1VORCB9LAotCQl7ICZpOTE1LT5tbS5ib3VuZF9saXN0
LCBJOTE1X1NIUklOS19CT1VORCB9LAorCQl7CisJCQkmaTkxNS0+bW0uc2hyaW5rX2xpc3QsCisJ
CQlJOTE1X1NIUklOS19CT1VORCB8IEk5MTVfU0hSSU5LX1VOQk9VTkQKKwkJfSwKIAkJeyBOVUxM
LCAwIH0sCiAJfSwgKnBoYXNlOwogCWludGVsX3dha2VyZWZfdCB3YWtlcmVmID0gMDsKQEAgLTIz
OCw3ICsyNDAsNyBAQCBpOTE1X2dlbV9zaHJpbmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCiAJCQkJY29udGludWU7CiAKIAkJCWlmICghKHNocmluayAmIEk5MTVfU0hSSU5LX0JPVU5E
KSAmJgotCQkJICAgIFJFQURfT05DRShvYmotPmJpbmRfY291bnQpKQorCQkJICAgIGF0b21pY19y
ZWFkKCZvYmotPmJpbmRfY291bnQpKQogCQkJCWNvbnRpbnVlOwogCiAJCQlpZiAoIWNhbl9yZWxl
YXNlX3BhZ2VzKG9iaikpCkBAIC0zNzgsNyArMzgwLDcgQEAgaTkxNV9nZW1fc2hyaW5rZXJfb29t
KHN0cnVjdCBub3RpZmllcl9ibG9jayAqbmIsIHVuc2lnbmVkIGxvbmcgZXZlbnQsIHZvaWQgKnB0
cikKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9CiAJCWNvbnRhaW5lcl9vZihuYiwg
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUsIG1tLm9vbV9ub3RpZmllcik7CiAJc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3QgKm9iajsKLQl1bnNpZ25lZCBsb25nIHVuZXZpY3RhYmxlLCBib3VuZCwg
dW5ib3VuZCwgZnJlZWRfcGFnZXM7CisJdW5zaWduZWQgbG9uZyB1bmV2aWN0YWJsZSwgYXZhaWxh
YmxlLCBmcmVlZF9wYWdlczsKIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKIAl1bnNpZ25lZCBs
b25nIGZsYWdzOwogCkBAIC0zOTMsMjYgKzM5NSwyMCBAQCBpOTE1X2dlbV9zaHJpbmtlcl9vb20o
c3RydWN0IG5vdGlmaWVyX2Jsb2NrICpuYiwgdW5zaWduZWQgbG9uZyBldmVudCwgdm9pZCAqcHRy
KQogCSAqIGFzc2VydCB0aGF0IHRoZXJlIGFyZSBubyBvYmplY3RzIHdpdGggcGlubmVkIHBhZ2Vz
IHRoYXQgYXJlIG5vdAogCSAqIGJlaW5nIHBvaW50ZWQgdG8gYnkgaGFyZHdhcmUuCiAJICovCi0J
dW5ib3VuZCA9IGJvdW5kID0gdW5ldmljdGFibGUgPSAwOworCWF2YWlsYWJsZSA9IHVuZXZpY3Rh
YmxlID0gMDsKIAlzcGluX2xvY2tfaXJxc2F2ZSgmaTkxNS0+bW0ub2JqX2xvY2ssIGZsYWdzKTsK
LQlsaXN0X2Zvcl9lYWNoX2VudHJ5KG9iaiwgJmk5MTUtPm1tLnVuYm91bmRfbGlzdCwgbW0ubGlu
aykgeworCWxpc3RfZm9yX2VhY2hfZW50cnkob2JqLCAmaTkxNS0+bW0uc2hyaW5rX2xpc3QsIG1t
LmxpbmspIHsKIAkJaWYgKCFjYW5fcmVsZWFzZV9wYWdlcyhvYmopKQogCQkJdW5ldmljdGFibGUg
Kz0gb2JqLT5iYXNlLnNpemUgPj4gUEFHRV9TSElGVDsKIAkJZWxzZQotCQkJdW5ib3VuZCArPSBv
YmotPmJhc2Uuc2l6ZSA+PiBQQUdFX1NISUZUOwotCX0KLQlsaXN0X2Zvcl9lYWNoX2VudHJ5KG9i
aiwgJmk5MTUtPm1tLmJvdW5kX2xpc3QsIG1tLmxpbmspIHsKLQkJaWYgKCFjYW5fcmVsZWFzZV9w
YWdlcyhvYmopKQotCQkJdW5ldmljdGFibGUgKz0gb2JqLT5iYXNlLnNpemUgPj4gUEFHRV9TSElG
VDsKLQkJZWxzZQotCQkJYm91bmQgKz0gb2JqLT5iYXNlLnNpemUgPj4gUEFHRV9TSElGVDsKKwkJ
CWF2YWlsYWJsZSArPSBvYmotPmJhc2Uuc2l6ZSA+PiBQQUdFX1NISUZUOwogCX0KIAlzcGluX3Vu
bG9ja19pcnFyZXN0b3JlKCZpOTE1LT5tbS5vYmpfbG9jaywgZmxhZ3MpOwogCi0JaWYgKGZyZWVk
X3BhZ2VzIHx8IHVuYm91bmQgfHwgYm91bmQpCisJaWYgKGZyZWVkX3BhZ2VzIHx8IGF2YWlsYWJs
ZSkKIAkJcHJfaW5mbygiUHVyZ2luZyBHUFUgbWVtb3J5LCAlbHUgcGFnZXMgZnJlZWQsICIKLQkJ
CSIlbHUgcGFnZXMgc3RpbGwgcGlubmVkLlxuIiwKLQkJCWZyZWVkX3BhZ2VzLCB1bmV2aWN0YWJs
ZSk7CisJCQkiJWx1IHBhZ2VzIHN0aWxsIHBpbm5lZCwgJWx1IHBhZ2VzIGxlZnQgYXZhaWxhYmxl
LlxuIiwKKwkJCWZyZWVkX3BhZ2VzLCB1bmV2aWN0YWJsZSwgYXZhaWxhYmxlKTsKIAogCSoodW5z
aWduZWQgbG9uZyAqKXB0ciArPSBmcmVlZF9wYWdlczsKIAlyZXR1cm4gTk9USUZZX0RPTkU7CmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fc3RvbGVuLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fc3RvbGVuLmMKaW5kZXggOGY2MTlhZDJm
YWI4Li5kZTFmYWIyMDU4ZWMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9zdG9sZW4uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
c3RvbGVuLmMKQEAgLTYxMyw3ICs2MTMsNiBAQCBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3N0b2xl
bl9mb3JfcHJlYWxsb2NhdGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdgogCXN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CiAJc3RydWN0IGRybV9tbV9ub2RlICpzdG9s
ZW47CiAJc3RydWN0IGk5MTVfdm1hICp2bWE7Ci0JdW5zaWduZWQgbG9uZyBmbGFnczsKIAlpbnQg
cmV0OwogCiAJaWYgKCFkcm1fbW1faW5pdGlhbGl6ZWQoJmRldl9wcml2LT5tbS5zdG9sZW4pKQpA
QCAtNjkwLDEwICs2ODksOCBAQCBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3N0b2xlbl9mb3JfcHJl
YWxsb2NhdGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdgogCWxpc3RfbW92ZV90
YWlsKCZ2bWEtPnZtX2xpbmssICZnZ3R0LT52bS5ib3VuZF9saXN0KTsKIAltdXRleF91bmxvY2so
JmdndHQtPnZtLm11dGV4KTsKIAotCXNwaW5fbG9ja19pcnFzYXZlKCZkZXZfcHJpdi0+bW0ub2Jq
X2xvY2ssIGZsYWdzKTsKIAlHRU1fQlVHX09OKGk5MTVfZ2VtX29iamVjdF9pc19zaHJpbmthYmxl
KG9iaikpOwotCW9iai0+YmluZF9jb3VudCsrOwotCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRl
dl9wcml2LT5tbS5vYmpfbG9jaywgZmxhZ3MpOworCWF0b21pY19pbmMoJm9iai0+YmluZF9jb3Vu
dCk7CiAKIAlyZXR1cm4gb2JqOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2RlYnVnZnMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCmluZGV4
IGIwNzBlNmYzNzgwYy4uM2QzZDI3ZmY1ZGFiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2RlYnVnZnMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVn
ZnMuYwpAQCAtMTA0LDE5ICsxMDQsNiBAQCBzdGF0aWMgY2hhciBnZXRfcGluX21hcHBlZF9mbGFn
KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiAJcmV0dXJuIG9iai0+bW0ubWFwcGlu
ZyA/ICdNJyA6ICcgJzsKIH0KIAotc3RhdGljIHU2NCBpOTE1X2dlbV9vYmpfdG90YWxfZ2d0dF9z
aXplKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCi17Ci0JdTY0IHNpemUgPSAwOwot
CXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwotCi0JZm9yX2VhY2hfZ2d0dF92bWEodm1hLCBvYmopIHsK
LQkJaWYgKGRybV9tbV9ub2RlX2FsbG9jYXRlZCgmdm1hLT5ub2RlKSkKLQkJCXNpemUgKz0gdm1h
LT5ub2RlLnNpemU7Ci0JfQotCi0JcmV0dXJuIHNpemU7Ci19Ci0KIHN0YXRpYyBjb25zdCBjaGFy
ICoKIHN0cmluZ2lmeV9wYWdlX3NpemVzKHVuc2lnbmVkIGludCBwYWdlX3NpemVzLCBjaGFyICpi
dWYsIHNpemVfdCBsZW4pCiB7CkBAIC0yNDcsODQgKzIzNCw2IEBAIGRlc2NyaWJlX29iaihzdHJ1
Y3Qgc2VxX2ZpbGUgKm0sIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiAJCXNlcV9w
cmludGYobSwgIiAoZnJvbnRidWZmZXI6IDB4JTAzeCkiLCBmcm9udGJ1ZmZlcl9iaXRzKTsKIH0K
IAotc3RhdGljIGludCBvYmpfcmFua19ieV9zdG9sZW4oY29uc3Qgdm9pZCAqQSwgY29uc3Qgdm9p
ZCAqQikKLXsKLQljb25zdCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqYSA9Ci0JCSooY29u
c3Qgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKiopQTsKLQljb25zdCBzdHJ1Y3QgZHJtX2k5
MTVfZ2VtX29iamVjdCAqYiA9Ci0JCSooY29uc3Qgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
KiopQjsKLQotCWlmIChhLT5zdG9sZW4tPnN0YXJ0IDwgYi0+c3RvbGVuLT5zdGFydCkKLQkJcmV0
dXJuIC0xOwotCWlmIChhLT5zdG9sZW4tPnN0YXJ0ID4gYi0+c3RvbGVuLT5zdGFydCkKLQkJcmV0
dXJuIDE7Ci0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQgaTkxNV9nZW1fc3RvbGVuX2xpc3Rf
aW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCi17Ci0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwotCXN0cnVjdCBk
cm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKLQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29i
amVjdCAqKm9iamVjdHM7Ci0Jc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKLQl1NjQg
dG90YWxfb2JqX3NpemUsIHRvdGFsX2d0dF9zaXplOwotCXVuc2lnbmVkIGxvbmcgdG90YWwsIGNv
dW50LCBuOwotCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Ci0JaW50IHJldDsKLQotCXRvdGFsID0gUkVB
RF9PTkNFKGRldl9wcml2LT5tbS5zaHJpbmtfY291bnQpOwotCW9iamVjdHMgPSBrdm1hbGxvY19h
cnJheSh0b3RhbCwgc2l6ZW9mKCpvYmplY3RzKSwgR0ZQX0tFUk5FTCk7Ci0JaWYgKCFvYmplY3Rz
KQotCQlyZXR1cm4gLUVOT01FTTsKLQotCXJldCA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgm
ZGV2LT5zdHJ1Y3RfbXV0ZXgpOwotCWlmIChyZXQpCi0JCWdvdG8gb3V0OwotCi0JdG90YWxfb2Jq
X3NpemUgPSB0b3RhbF9ndHRfc2l6ZSA9IGNvdW50ID0gMDsKLQotCXNwaW5fbG9ja19pcnFzYXZl
KCZkZXZfcHJpdi0+bW0ub2JqX2xvY2ssIGZsYWdzKTsKLQlsaXN0X2Zvcl9lYWNoX2VudHJ5KG9i
aiwgJmRldl9wcml2LT5tbS5ib3VuZF9saXN0LCBtbS5saW5rKSB7Ci0JCWlmIChjb3VudCA9PSB0
b3RhbCkKLQkJCWJyZWFrOwotCi0JCWlmIChvYmotPnN0b2xlbiA9PSBOVUxMKQotCQkJY29udGlu
dWU7Ci0KLQkJb2JqZWN0c1tjb3VudCsrXSA9IG9iajsKLQkJdG90YWxfb2JqX3NpemUgKz0gb2Jq
LT5iYXNlLnNpemU7Ci0JCXRvdGFsX2d0dF9zaXplICs9IGk5MTVfZ2VtX29ial90b3RhbF9nZ3R0
X3NpemUob2JqKTsKLQotCX0KLQlsaXN0X2Zvcl9lYWNoX2VudHJ5KG9iaiwgJmRldl9wcml2LT5t
bS51bmJvdW5kX2xpc3QsIG1tLmxpbmspIHsKLQkJaWYgKGNvdW50ID09IHRvdGFsKQotCQkJYnJl
YWs7Ci0KLQkJaWYgKG9iai0+c3RvbGVuID09IE5VTEwpCi0JCQljb250aW51ZTsKLQotCQlvYmpl
Y3RzW2NvdW50KytdID0gb2JqOwotCQl0b3RhbF9vYmpfc2l6ZSArPSBvYmotPmJhc2Uuc2l6ZTsK
LQl9Ci0Jc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZGV2X3ByaXYtPm1tLm9ial9sb2NrLCBmbGFn
cyk7Ci0KLQlzb3J0KG9iamVjdHMsIGNvdW50LCBzaXplb2YoKm9iamVjdHMpLCBvYmpfcmFua19i
eV9zdG9sZW4sIE5VTEwpOwotCi0Jc2VxX3B1dHMobSwgIlN0b2xlbjpcbiIpOwotCWZvciAobiA9
IDA7IG4gPCBjb3VudDsgbisrKSB7Ci0JCXNlcV9wdXRzKG0sICIgICAiKTsKLQkJZGVzY3JpYmVf
b2JqKG0sIG9iamVjdHNbbl0pOwotCQlzZXFfcHV0YyhtLCAnXG4nKTsKLQl9Ci0Jc2VxX3ByaW50
ZihtLCAiVG90YWwgJWx1IG9iamVjdHMsICVsbHUgYnl0ZXMsICVsbHUgR1RUIHNpemVcbiIsCi0J
CSAgIGNvdW50LCB0b3RhbF9vYmpfc2l6ZSwgdG90YWxfZ3R0X3NpemUpOwotCi0JbXV0ZXhfdW5s
b2NrKCZkZXYtPnN0cnVjdF9tdXRleCk7Ci1vdXQ6Ci0Ja3ZmcmVlKG9iamVjdHMpOwotCXJldHVy
biByZXQ7Ci19Ci0KIHN0cnVjdCBmaWxlX3N0YXRzIHsKIAlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3Nw
YWNlICp2bTsKIAl1bnNpZ25lZCBsb25nIGNvdW50OwpAQCAtMzQ0LDcgKzI1Myw3IEBAIHN0YXRp
YyBpbnQgcGVyX2ZpbGVfc3RhdHMoaW50IGlkLCB2b2lkICpwdHIsIHZvaWQgKmRhdGEpCiAKIAlz
dGF0cy0+Y291bnQrKzsKIAlzdGF0cy0+dG90YWwgKz0gb2JqLT5iYXNlLnNpemU7Ci0JaWYgKCFv
YmotPmJpbmRfY291bnQpCisJaWYgKCFhdG9taWNfcmVhZCgmb2JqLT5iaW5kX2NvdW50KSkKIAkJ
c3RhdHMtPnVuYm91bmQgKz0gb2JqLT5iYXNlLnNpemU7CiAJaWYgKG9iai0+YmFzZS5uYW1lIHx8
IG9iai0+YmFzZS5kbWFfYnVmKQogCQlzdGF0cy0+c2hhcmVkICs9IG9iai0+YmFzZS5zaXplOwpA
QCAtNDUxLDEwNSArMzYwLDIyIEBAIHN0YXRpYyB2b2lkIHByaW50X2NvbnRleHRfc3RhdHMoc3Ry
dWN0IHNlcV9maWxlICptLAogCiBzdGF0aWMgaW50IGk5MTVfZ2VtX29iamVjdF9pbmZvKHN0cnVj
dCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Ci0Jc3RydWN0IGRybV9kZXZpY2Ug
KmRldiA9ICZkZXZfcHJpdi0+ZHJtOwotCXN0cnVjdCBpOTE1X2dndHQgKmdndHQgPSAmZGV2X3By
aXYtPmdndHQ7Ci0JdTMyIGNvdW50LCBtYXBwZWRfY291bnQsIHB1cmdlYWJsZV9jb3VudCwgZHB5
X2NvdW50LCBodWdlX2NvdW50OwotCXU2NCBzaXplLCBtYXBwZWRfc2l6ZSwgcHVyZ2VhYmxlX3Np
emUsIGRweV9zaXplLCBodWdlX3NpemU7Ci0Jc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
ajsKLQl1bnNpZ25lZCBpbnQgcGFnZV9zaXplcyA9IDA7Ci0JdW5zaWduZWQgbG9uZyBmbGFnczsK
LQljaGFyIGJ1Zls4MF07CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3Rv
X2k5MTUobS0+cHJpdmF0ZSk7CiAJaW50IHJldDsKIAogCXNlcV9wcmludGYobSwgIiV1IHNocmlu
a2FibGUgb2JqZWN0cywgJWxsdSBieXRlc1xuIiwKLQkJICAgZGV2X3ByaXYtPm1tLnNocmlua19j
b3VudCwKLQkJICAgZGV2X3ByaXYtPm1tLnNocmlua19tZW1vcnkpOwotCi0Jc2l6ZSA9IGNvdW50
ID0gMDsKLQltYXBwZWRfc2l6ZSA9IG1hcHBlZF9jb3VudCA9IDA7Ci0JcHVyZ2VhYmxlX3NpemUg
PSBwdXJnZWFibGVfY291bnQgPSAwOwotCWh1Z2Vfc2l6ZSA9IGh1Z2VfY291bnQgPSAwOwotCi0J
c3Bpbl9sb2NrX2lycXNhdmUoJmRldl9wcml2LT5tbS5vYmpfbG9jaywgZmxhZ3MpOwotCWxpc3Rf
Zm9yX2VhY2hfZW50cnkob2JqLCAmZGV2X3ByaXYtPm1tLnVuYm91bmRfbGlzdCwgbW0ubGluaykg
ewotCQlzaXplICs9IG9iai0+YmFzZS5zaXplOwotCQkrK2NvdW50OwotCi0JCWlmIChvYmotPm1t
Lm1hZHYgPT0gSTkxNV9NQURWX0RPTlRORUVEKSB7Ci0JCQlwdXJnZWFibGVfc2l6ZSArPSBvYmot
PmJhc2Uuc2l6ZTsKLQkJCSsrcHVyZ2VhYmxlX2NvdW50OwotCQl9Ci0KLQkJaWYgKG9iai0+bW0u
bWFwcGluZykgewotCQkJbWFwcGVkX2NvdW50Kys7Ci0JCQltYXBwZWRfc2l6ZSArPSBvYmotPmJh
c2Uuc2l6ZTsKLQkJfQotCi0JCWlmIChvYmotPm1tLnBhZ2Vfc2l6ZXMuc2cgPiBJOTE1X0dUVF9Q
QUdFX1NJWkUpIHsKLQkJCWh1Z2VfY291bnQrKzsKLQkJCWh1Z2Vfc2l6ZSArPSBvYmotPmJhc2Uu
c2l6ZTsKLQkJCXBhZ2Vfc2l6ZXMgfD0gb2JqLT5tbS5wYWdlX3NpemVzLnNnOwotCQl9Ci0JfQot
CXNlcV9wcmludGYobSwgIiV1IHVuYm91bmQgb2JqZWN0cywgJWxsdSBieXRlc1xuIiwgY291bnQs
IHNpemUpOwotCi0Jc2l6ZSA9IGNvdW50ID0gZHB5X3NpemUgPSBkcHlfY291bnQgPSAwOwotCWxp
c3RfZm9yX2VhY2hfZW50cnkob2JqLCAmZGV2X3ByaXYtPm1tLmJvdW5kX2xpc3QsIG1tLmxpbmsp
IHsKLQkJc2l6ZSArPSBvYmotPmJhc2Uuc2l6ZTsKLQkJKytjb3VudDsKLQotCQlpZiAob2JqLT5w
aW5fZ2xvYmFsKSB7Ci0JCQlkcHlfc2l6ZSArPSBvYmotPmJhc2Uuc2l6ZTsKLQkJCSsrZHB5X2Nv
dW50OwotCQl9Ci0KLQkJaWYgKG9iai0+bW0ubWFkdiA9PSBJOTE1X01BRFZfRE9OVE5FRUQpIHsK
LQkJCXB1cmdlYWJsZV9zaXplICs9IG9iai0+YmFzZS5zaXplOwotCQkJKytwdXJnZWFibGVfY291
bnQ7Ci0JCX0KLQotCQlpZiAob2JqLT5tbS5tYXBwaW5nKSB7Ci0JCQltYXBwZWRfY291bnQrKzsK
LQkJCW1hcHBlZF9zaXplICs9IG9iai0+YmFzZS5zaXplOwotCQl9Ci0KLQkJaWYgKG9iai0+bW0u
cGFnZV9zaXplcy5zZyA+IEk5MTVfR1RUX1BBR0VfU0laRSkgewotCQkJaHVnZV9jb3VudCsrOwot
CQkJaHVnZV9zaXplICs9IG9iai0+YmFzZS5zaXplOwotCQkJcGFnZV9zaXplcyB8PSBvYmotPm1t
LnBhZ2Vfc2l6ZXMuc2c7Ci0JCX0KLQl9Ci0Jc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZGV2X3By
aXYtPm1tLm9ial9sb2NrLCBmbGFncyk7Ci0KLQlzZXFfcHJpbnRmKG0sICIldSBib3VuZCBvYmpl
Y3RzLCAlbGx1IGJ5dGVzXG4iLAotCQkgICBjb3VudCwgc2l6ZSk7Ci0Jc2VxX3ByaW50ZihtLCAi
JXUgcHVyZ2VhYmxlIG9iamVjdHMsICVsbHUgYnl0ZXNcbiIsCi0JCSAgIHB1cmdlYWJsZV9jb3Vu
dCwgcHVyZ2VhYmxlX3NpemUpOwotCXNlcV9wcmludGYobSwgIiV1IG1hcHBlZCBvYmplY3RzLCAl
bGx1IGJ5dGVzXG4iLAotCQkgICBtYXBwZWRfY291bnQsIG1hcHBlZF9zaXplKTsKLQlzZXFfcHJp
bnRmKG0sICIldSBodWdlLXBhZ2VkIG9iamVjdHMgKCVzKSAlbGx1IGJ5dGVzXG4iLAotCQkgICBo
dWdlX2NvdW50LAotCQkgICBzdHJpbmdpZnlfcGFnZV9zaXplcyhwYWdlX3NpemVzLCBidWYsIHNp
emVvZihidWYpKSwKLQkJICAgaHVnZV9zaXplKTsKLQlzZXFfcHJpbnRmKG0sICIldSBkaXNwbGF5
IG9iamVjdHMgKGdsb2JhbGx5IHBpbm5lZCksICVsbHUgYnl0ZXNcbiIsCi0JCSAgIGRweV9jb3Vu
dCwgZHB5X3NpemUpOwotCi0Jc2VxX3ByaW50ZihtLCAiJWxsdSBbJXBhXSBndHQgdG90YWxcbiIs
Ci0JCSAgIGdndHQtPnZtLnRvdGFsLCAmZ2d0dC0+bWFwcGFibGVfZW5kKTsKLQlzZXFfcHJpbnRm
KG0sICJTdXBwb3J0ZWQgcGFnZSBzaXplczogJXNcbiIsCi0JCSAgIHN0cmluZ2lmeV9wYWdlX3Np
emVzKElOVEVMX0lORk8oZGV2X3ByaXYpLT5wYWdlX3NpemVzLAotCQkJCQlidWYsIHNpemVvZihi
dWYpKSk7CisJCSAgIGk5MTUtPm1tLnNocmlua19jb3VudCwKKwkJICAgaTkxNS0+bW0uc2hyaW5r
X21lbW9yeSk7CiAKIAlzZXFfcHV0YyhtLCAnXG4nKTsKIAotCXJldCA9IG11dGV4X2xvY2tfaW50
ZXJydXB0aWJsZSgmZGV2LT5zdHJ1Y3RfbXV0ZXgpOworCXJldCA9IG11dGV4X2xvY2tfaW50ZXJy
dXB0aWJsZSgmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJl
dDsKIAotCXByaW50X2JhdGNoX3Bvb2xfc3RhdHMobSwgZGV2X3ByaXYpOwotCXByaW50X2NvbnRl
eHRfc3RhdHMobSwgZGV2X3ByaXYpOwotCW11dGV4X3VubG9jaygmZGV2LT5zdHJ1Y3RfbXV0ZXgp
OworCXByaW50X2JhdGNoX3Bvb2xfc3RhdHMobSwgaTkxNSk7CisJcHJpbnRfY29udGV4dF9zdGF0
cyhtLCBpOTE1KTsKKwltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCiAJ
cmV0dXJuIDA7CiB9CkBAIC00NTM1LDcgKzQzNjEsNiBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGZp
bGVfb3BlcmF0aW9ucyBpOTE1X2ZpZm9fdW5kZXJydW5fcmVzZXRfb3BzID0gewogc3RhdGljIGNv
bnN0IHN0cnVjdCBkcm1faW5mb19saXN0IGk5MTVfZGVidWdmc19saXN0W10gPSB7CiAJeyJpOTE1
X2NhcGFiaWxpdGllcyIsIGk5MTVfY2FwYWJpbGl0aWVzLCAwfSwKIAl7Imk5MTVfZ2VtX29iamVj
dHMiLCBpOTE1X2dlbV9vYmplY3RfaW5mbywgMH0sCi0JeyJpOTE1X2dlbV9zdG9sZW4iLCBpOTE1
X2dlbV9zdG9sZW5fbGlzdF9pbmZvIH0sCiAJeyJpOTE1X2dlbV9mZW5jZV9yZWdzIiwgaTkxNV9n
ZW1fZmVuY2VfcmVnc19pbmZvLCAwfSwKIAl7Imk5MTVfZ2VtX2ludGVycnVwdCIsIGk5MTVfaW50
ZXJydXB0X2luZm8sIDB9LAogCXsiaTkxNV9nZW1fYmF0Y2hfcG9vbCIsIGk5MTVfZ2VtX2JhdGNo
X3Bvb2xfaW5mbywgMH0sCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Ry
di5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAppbmRleCAwZWE3Zjc4YWUyMjcu
Ljk2ZWQxMjlhMTQxOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYu
aAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCkBAIC03NDcsMTkgKzc0Nywx
NSBAQCBzdHJ1Y3QgaTkxNV9nZW1fbW0gewogCS8qIFByb3RlY3RzIGJvdW5kX2xpc3QvdW5ib3Vu
ZF9saXN0IGFuZCAjZHJtX2k5MTVfZ2VtX29iamVjdC5tbS5saW5rICovCiAJc3BpbmxvY2tfdCBv
YmpfbG9jazsKIAotCS8qKiBMaXN0IG9mIGFsbCBvYmplY3RzIGluIGd0dF9zcGFjZS4gVXNlZCB0
byByZXN0b3JlIGd0dAotCSAqIG1hcHBpbmdzIG9uIHJlc3VtZSAqLwotCXN0cnVjdCBsaXN0X2hl
YWQgYm91bmRfbGlzdDsKIAkvKioKLQkgKiBMaXN0IG9mIG9iamVjdHMgd2hpY2ggYXJlIG5vdCBi
b3VuZCB0byB0aGUgR1RUICh0aHVzCi0JICogYXJlIGlkbGUgYW5kIG5vdCB1c2VkIGJ5IHRoZSBH
UFUpLiBUaGVzZSBvYmplY3RzIG1heSBvciBtYXkKLQkgKiBub3QgYWN0dWFsbHkgaGF2ZSBhbnkg
cGFnZXMgYXR0YWNoZWQuCisJICogTGlzdCBvZiBvYmplY3RzIHdoaWNoIGFyZSBwdXJnZWFibGUu
CiAJICovCi0Jc3RydWN0IGxpc3RfaGVhZCB1bmJvdW5kX2xpc3Q7CisJc3RydWN0IGxpc3RfaGVh
ZCBwdXJnZV9saXN0OworCiAJLyoqCi0JICogTGlzdCBvZiBvYmplY3RzIHdoaWNoIGFyZSBwdXJn
ZWFibGUuIE1heSBiZSBhY3RpdmUuCisJICogTGlzdCBvZiBvYmplY3RzIHdoaWNoIGhhdmUgYWxs
b2NhdGVkIHBhZ2VzIGFuZCBhcmUgc2hyaW5rYWJsZS4KIAkgKi8KLQlzdHJ1Y3QgbGlzdF9oZWFk
IHB1cmdlX2xpc3Q7CisJc3RydWN0IGxpc3RfaGVhZCBzaHJpbmtfbGlzdDsKIAogCS8qKiBMaXN0
IG9mIGFsbCBvYmplY3RzIGluIGd0dF9zcGFjZSwgY3VycmVudGx5IG1tYXBlZCBieSB1c2Vyc3Bh
Y2UuCiAJICogQWxsIG9iamVjdHMgd2l0aGluIHRoaXMgbGlzdCBtdXN0IGFsc28gYmUgb24gYm91
bmRfbGlzdC4KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCmluZGV4IGU5ODBjMWVlM2RjZi4uODg1MDAw
YzRhZmE5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKQEAgLTExNDQsMTAgKzExNDQsOCBAQCBp
OTE1X2dlbV9tYWR2aXNlX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEs
CiAKIAkJCWlmIChvYmotPm1tLm1hZHYgIT0gSTkxNV9NQURWX1dJTExORUVEKQogCQkJCWxpc3Qg
PSAmaTkxNS0+bW0ucHVyZ2VfbGlzdDsKLQkJCWVsc2UgaWYgKG9iai0+YmluZF9jb3VudCkKLQkJ
CQlsaXN0ID0gJmk5MTUtPm1tLmJvdW5kX2xpc3Q7CiAJCQllbHNlCi0JCQkJbGlzdCA9ICZpOTE1
LT5tbS51bmJvdW5kX2xpc3Q7CisJCQkJbGlzdCA9ICZpOTE1LT5tbS5zaHJpbmtfbGlzdDsKIAkJ
CWxpc3RfbW92ZV90YWlsKCZvYmotPm1tLmxpbmssIGxpc3QpOwogCiAJCQlzcGluX3VubG9ja19p
cnFyZXN0b3JlKCZpOTE1LT5tbS5vYmpfbG9jaywgZmxhZ3MpOwpAQCAtMTc3MCw4ICsxNzY4LDcg
QEAgc3RhdGljIHZvaWQgaTkxNV9nZW1faW5pdF9fbW0oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCiAJaW5pdF9sbGlzdF9oZWFkKCZpOTE1LT5tbS5mcmVlX2xpc3QpOwogCiAJSU5JVF9M
SVNUX0hFQUQoJmk5MTUtPm1tLnB1cmdlX2xpc3QpOwotCUlOSVRfTElTVF9IRUFEKCZpOTE1LT5t
bS51bmJvdW5kX2xpc3QpOwotCUlOSVRfTElTVF9IRUFEKCZpOTE1LT5tbS5ib3VuZF9saXN0KTsK
KwlJTklUX0xJU1RfSEVBRCgmaTkxNS0+bW0uc2hyaW5rX2xpc3QpOwogCUlOSVRfTElTVF9IRUFE
KCZpOTE1LT5tbS5mZW5jZV9saXN0KTsKIAogCUlOSVRfTElTVF9IRUFEKCZpOTE1LT5tbS51c2Vy
ZmF1bHRfbGlzdCk7CkBAIC0xODM0LDExICsxODMxLDcgQEAgaW50IGk5MTVfZ2VtX2ZyZWV6ZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiBpbnQgaTkxNV9nZW1fZnJlZXplX2xh
dGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7CiAJc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKm9iajsKLQlzdHJ1Y3QgbGlzdF9oZWFkICpwaGFzZXNbXSA9IHsKLQkJJmk5MTUt
Pm1tLnVuYm91bmRfbGlzdCwKLQkJJmk5MTUtPm1tLmJvdW5kX2xpc3QsCi0JCU5VTEwKLQl9LCAq
KnBoYXNlOworCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwogCiAJLyoKIAkgKiBDYWxsZWQganVz
dCBiZWZvcmUgd2Ugd3JpdGUgdGhlIGhpYmVybmF0aW9uIGltYWdlLgpAQCAtMTg1NSwxNyArMTg0
OCwxOCBAQCBpbnQgaTkxNV9nZW1fZnJlZXplX2xhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCiAJICogdGhlIG9iamVjdHMgYXMgd2VsbCwgc2VlIGk5MTVfZ2VtX2ZyZWV6ZSgpCiAJ
ICovCiAKLQlpOTE1X2dlbV9zaHJpbmsoaTkxNSwgLTFVTCwgTlVMTCwgSTkxNV9TSFJJTktfVU5C
T1VORCk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCisJaTkxNV9n
ZW1fc2hyaW5rKGk5MTUsIC0xVUwsIE5VTEwsIH4wKTsKIAlpOTE1X2dlbV9kcmFpbl9mcmVlZF9v
YmplY3RzKGk5MTUpOwogCi0JZm9yIChwaGFzZSA9IHBoYXNlczsgKnBoYXNlOyBwaGFzZSsrKSB7
Ci0JCWxpc3RfZm9yX2VhY2hfZW50cnkob2JqLCAqcGhhc2UsIG1tLmxpbmspIHsKLQkJCWk5MTVf
Z2VtX29iamVjdF9sb2NrKG9iaik7Ci0JCQlXQVJOX09OKGk5MTVfZ2VtX29iamVjdF9zZXRfdG9f
Y3B1X2RvbWFpbihvYmosIHRydWUpKTsKLQkJCWk5MTVfZ2VtX29iamVjdF91bmxvY2sob2JqKTsK
LQkJfQorCWxpc3RfZm9yX2VhY2hfZW50cnkob2JqLCAmaTkxNS0+bW0uc2hyaW5rX2xpc3QsIG1t
LmxpbmspIHsKKwkJaTkxNV9nZW1fb2JqZWN0X2xvY2sob2JqKTsKKwkJV0FSTl9PTihpOTE1X2dl
bV9vYmplY3Rfc2V0X3RvX2NwdV9kb21haW4ob2JqLCB0cnVlKSk7CisJCWk5MTVfZ2VtX29iamVj
dF91bmxvY2sob2JqKTsKIAl9Ci0JR0VNX0JVR19PTighbGlzdF9lbXB0eSgmaTkxNS0+bW0ucHVy
Z2VfbGlzdCkpOworCisJaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7CiAKIAly
ZXR1cm4gMDsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCmluZGV4IDgwMDUwZjZhMDg5My4uY2Iz
NDFlNGFjZjk5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMKQEAgLTgzLDEwICs4Myw3IEBAIHN0
YXRpYyB2b2lkIG9ial9idW1wX21ydShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQog
CXVuc2lnbmVkIGxvbmcgZmxhZ3M7CiAKIAlzcGluX2xvY2tfaXJxc2F2ZSgmaTkxNS0+bW0ub2Jq
X2xvY2ssIGZsYWdzKTsKLQotCWlmIChvYmotPmJpbmRfY291bnQpCi0JCWxpc3RfbW92ZV90YWls
KCZvYmotPm1tLmxpbmssICZpOTE1LT5tbS5ib3VuZF9saXN0KTsKLQorCWxpc3RfbW92ZV90YWls
KCZvYmotPm1tLmxpbmssICZpOTE1LT5tbS5zaHJpbmtfbGlzdCk7CiAJc3Bpbl91bmxvY2tfaXJx
cmVzdG9yZSgmaTkxNS0+bW0ub2JqX2xvY2ssIGZsYWdzKTsKIAogCW9iai0+bW0uZGlydHkgPSB0
cnVlOyAvKiBiZSBwYXJhbm9pZCAgKi8KQEAgLTUzOCw3ICs1MzUsNyBAQCBzdGF0aWMgdm9pZCBh
c3NlcnRfYmluZF9jb3VudChjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQog
CSAqIGFzc3VtZSB0aGF0IG5vIGVsc2UgaXMgcGlubmluZyB0aGUgcGFnZXMsIGJ1dCBhcyBhIHJv
dWdoIGFzc2VydGlvbgogCSAqIHRoYXQgd2Ugd2lsbCBub3QgcnVuIGludG8gcHJvYmxlbXMgbGF0
ZXIsIHRoaXMgd2lsbCBkbyEpCiAJICovCi0JR0VNX0JVR19PTihhdG9taWNfcmVhZCgmb2JqLT5t
bS5wYWdlc19waW5fY291bnQpIDwgb2JqLT5iaW5kX2NvdW50KTsKKwlHRU1fQlVHX09OKGF0b21p
Y19yZWFkKCZvYmotPm1tLnBhZ2VzX3Bpbl9jb3VudCkgPCBhdG9taWNfcmVhZCgmb2JqLT5iaW5k
X2NvdW50KSk7CiB9CiAKIC8qKgpAQCAtNjgwLDE4ICs2NzcsOCBAQCBpOTE1X3ZtYV9pbnNlcnQo
c3RydWN0IGk5MTVfdm1hICp2bWEsIHU2NCBzaXplLCB1NjQgYWxpZ25tZW50LCB1NjQgZmxhZ3Mp
CiAJbXV0ZXhfdW5sb2NrKCZ2bWEtPnZtLT5tdXRleCk7CiAKIAlpZiAodm1hLT5vYmopIHsKLQkJ
c3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IHZtYS0+b2JqOwotCQl1bnNpZ25lZCBs
b25nIGZsYWdzOwotCi0JCXNwaW5fbG9ja19pcnFzYXZlKCZkZXZfcHJpdi0+bW0ub2JqX2xvY2ss
IGZsYWdzKTsKLQotCQlpZiAoaTkxNV9nZW1fb2JqZWN0X2lzX3Nocmlua2FibGUob2JqKSkKLQkJ
CWxpc3RfbW92ZV90YWlsKCZvYmotPm1tLmxpbmssICZkZXZfcHJpdi0+bW0uYm91bmRfbGlzdCk7
Ci0KLQkJb2JqLT5iaW5kX2NvdW50Kys7Ci0JCWFzc2VydF9iaW5kX2NvdW50KG9iaik7Ci0KLQkJ
c3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZGV2X3ByaXYtPm1tLm9ial9sb2NrLCBmbGFncyk7CisJ
CWF0b21pY19pbmMoJnZtYS0+b2JqLT5iaW5kX2NvdW50KTsKKwkJYXNzZXJ0X2JpbmRfY291bnQo
dm1hLT5vYmopOwogCX0KIAogCXJldHVybiAwOwpAQCAtNzA3LDggKzY5NCw2IEBAIGk5MTVfdm1h
X2luc2VydChzdHJ1Y3QgaTkxNV92bWEgKnZtYSwgdTY0IHNpemUsIHU2NCBhbGlnbm1lbnQsIHU2
NCBmbGFncykKIHN0YXRpYyB2b2lkCiBpOTE1X3ZtYV9yZW1vdmUoc3RydWN0IGk5MTVfdm1hICp2
bWEpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2bWEtPnZtLT5pOTE1Owot
CiAJR0VNX0JVR19PTighZHJtX21tX25vZGVfYWxsb2NhdGVkKCZ2bWEtPm5vZGUpKTsKIAlHRU1f
QlVHX09OKHZtYS0+ZmxhZ3MgJiAoSTkxNV9WTUFfR0xPQkFMX0JJTkQgfCBJOTE1X1ZNQV9MT0NB
TF9CSU5EKSk7CiAKQEAgLTcyNSwxNyArNzEwLDggQEAgaTkxNV92bWFfcmVtb3ZlKHN0cnVjdCBp
OTE1X3ZtYSAqdm1hKQogCSAqLwogCWlmICh2bWEtPm9iaikgewogCQlzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqID0gdm1hLT5vYmo7Ci0JCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Ci0KLQkJ
c3Bpbl9sb2NrX2lycXNhdmUoJmk5MTUtPm1tLm9ial9sb2NrLCBmbGFncyk7Ci0KLQkJR0VNX0JV
R19PTihvYmotPmJpbmRfY291bnQgPT0gMCk7Ci0JCWlmICgtLW9iai0+YmluZF9jb3VudCA9PSAw
ICYmCi0JCSAgICBpOTE1X2dlbV9vYmplY3RfaXNfc2hyaW5rYWJsZShvYmopICYmCi0JCSAgICBv
YmotPm1tLm1hZHYgPT0gSTkxNV9NQURWX1dJTExORUVEKQotCQkJbGlzdF9tb3ZlX3RhaWwoJm9i
ai0+bW0ubGluaywgJmk5MTUtPm1tLnVuYm91bmRfbGlzdCk7CiAKLQkJc3Bpbl91bmxvY2tfaXJx
cmVzdG9yZSgmaTkxNS0+bW0ub2JqX2xvY2ssIGZsYWdzKTsKKwkJYXRvbWljX2RlYygmb2JqLT5i
aW5kX2NvdW50KTsKIAogCQkvKgogCQkgKiBBbmQgZmluYWxseSBub3cgdGhlIG9iamVjdCBpcyBj
b21wbGV0ZWx5IGRlY291cGxlZCBmcm9tIHRoaXMKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ldmljdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
c2VsZnRlc3RzL2k5MTVfZ2VtX2V2aWN0LmMKaW5kZXggMWQ4MjM1MzAzZWRmLi43MWMxMzYzYWQ1
MzYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9l
dmljdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ldmlj
dC5jCkBAIC02NywyMCArNjcsMjQgQEAgc3RhdGljIGludCBwb3B1bGF0ZV9nZ3R0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAogCQljb3VudCsrOwogCX0KIAorCWJvdW5kID0gMDsKIAl1
bmJvdW5kID0gMDsKLQlsaXN0X2Zvcl9lYWNoX2VudHJ5KG9iaiwgJmk5MTUtPm1tLnVuYm91bmRf
bGlzdCwgbW0ubGluaykKLQkJaWYgKG9iai0+bW0ucXVpcmtlZCkKKwlsaXN0X2Zvcl9lYWNoX2Vu
dHJ5KG9iaiwgb2JqZWN0cywgc3RfbGluaykgeworCQlHRU1fQlVHX09OKCFvYmotPm1tLnF1aXJr
ZWQpOworCisJCWlmIChhdG9taWNfcmVhZCgmb2JqLT5iaW5kX2NvdW50KSkKKwkJCWJvdW5kKys7
CisJCWVsc2UKIAkJCXVuYm91bmQrKzsKKwl9CisJR0VNX0JVR19PTihib3VuZCArIHVuYm91bmQg
IT0gY291bnQpOworCiAJaWYgKHVuYm91bmQpIHsKIAkJcHJfZXJyKCIlczogRm91bmQgJWx1IG9i
amVjdHMgdW5ib3VuZCwgZXhwZWN0ZWQgJXUhXG4iLAogCQkgICAgICAgX19mdW5jX18sIHVuYm91
bmQsIDApOwogCQlyZXR1cm4gLUVJTlZBTDsKIAl9CiAKLQlib3VuZCA9IDA7Ci0JbGlzdF9mb3Jf
ZWFjaF9lbnRyeShvYmosICZpOTE1LT5tbS5ib3VuZF9saXN0LCBtbS5saW5rKQotCQlpZiAob2Jq
LT5tbS5xdWlya2VkKQotCQkJYm91bmQrKzsKIAlpZiAoYm91bmQgIT0gY291bnQpIHsKIAkJcHJf
ZXJyKCIlczogRm91bmQgJWx1IG9iamVjdHMgYm91bmQsIGV4cGVjdGVkICVsdSFcbiIsCiAJCSAg
ICAgICBfX2Z1bmNfXywgYm91bmQsIGNvdW50KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ndHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3Nl
bGZ0ZXN0cy9pOTE1X2dlbV9ndHQuYwppbmRleCBhNTU3ZTc3ZDljNTQuLjIwOTNkMDhhNzU2OSAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ndHQuYwpAQCAt
MTIzMyw3ICsxMjMzLDcgQEAgc3RhdGljIHZvaWQgdHJhY2tfdm1hX2JpbmQoc3RydWN0IGk5MTVf
dm1hICp2bWEpCiB7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IHZtYS0+b2Jq
OwogCi0Jb2JqLT5iaW5kX2NvdW50Kys7IC8qIHRyYWNrIGZvciBldmljdGlvbiBsYXRlciAqLwor
CWF0b21pY19pbmMoJm9iai0+YmluZF9jb3VudCk7IC8qIHRyYWNrIGZvciBldmljdGlvbiBsYXRl
ciAqLwogCV9faTkxNV9nZW1fb2JqZWN0X3Bpbl9wYWdlcyhvYmopOwogCiAJdm1hLT5wYWdlcyA9
IG9iai0+bW0ucGFnZXM7Ci0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3Rz
LmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xp
c3RpbmZvL2ludGVsLWdmeA==

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 4B783C1035
	for <lists+intel-gfx@lfdr.de>; Sat, 28 Sep 2019 10:26:15 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2BF156E029;
	Sat, 28 Sep 2019 08:26:13 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id BDE676E029
 for <intel-gfx@lists.freedesktop.org>; Sat, 28 Sep 2019 08:26:10 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18647745-1500050 
 for multiple; Sat, 28 Sep 2019 09:25:50 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Sat, 28 Sep 2019 09:25:46 +0100
Message-Id: <20190928082546.3473-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190927163400.22767-1-chris@chris-wilson.co.uk>
References: <20190927163400.22767-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v2] drm/i915/userptr: Never allow userptr into
 the mappable GGTT
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Daniel Vetter <daniel.vetter@ffwll.ch>, stable@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RGFuaWVsIFZldHRlciB1bmNvdmVyZWQgYSBuYXN0eSBjeWNsZSBpbiB1c2luZyB0aGUgbW11LW5v
dGlmaWVycyB0bwppbnZhbGlkYXRlIHVzZXJwdHIgb2JqZWN0cyB3aGljaCBhbHNvIGhhcHBlbiB0
byBiZSBwdWxsZWQgaW50byBHR1RUCm1tYXBzLiBUaGF0IGlzIHdoZW4gd2UgdW5iaW5kIHRoZSB1
c2VycHRyIG9iamVjdCAob24gbW11IGludmFsaWRhdGlvbiksCndlIHJldm9rZSBhbGwgQ1BVIG1t
YXBzLCB3aGljaCBtYXkgdGhlbiByZWN1cnNlIGludG8gbW11IGludmFsaWRhdGlvbi4KCldlIGxv
b2tlZCBmb3Igd2F5cyBvZiBicmVha2luZyB0aGUgY3ljbGUsIGJ1dCB0aGUgcmV2b2NhdGlvbiBv
bgppbnZhbGlkYXRpb24gaXMgcmVxdWlyZWQgYW5kIGNhbm5vdCBiZSBhdm9pZGVkLiBUaGUgb25s
eSBzb2x1dGlvbiB3ZQpjb3VsZCBzZWUgd2FzIHRvIG5vdCBhbGxvdyBzdWNoIEdHVFQgYmluZGlu
Z3Mgb2YgdXNlcnB0ciBvYmplY3RzIGluIHRoZQpmaXJzdCBwbGFjZS4gSW4gcHJhY3RpY2UsIG5v
IG9uZSByZWFsbHkgd2FudHMgdG8gdXNlIGEgR0dUVCBtbWFwcGluZyBvZgphIENQVSBwb2ludGVy
Li4uCgpKdXN0IGJlZm9yZSBEYW5pZWwncyBleHBsb3NpdmUgbG9ja2RlcCBwYXRjaGVzIGxhbmQg
aW4gcmMxLCB3ZSBnb3QgYQpnZW51aW5lIGJsaXAgZnJvbSBDSToKCjw0PlsgIDI0Ni43OTM5NThd
ID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQo8
ND5bICAyNDYuNzkzOTcyXSBXQVJOSU5HOiBwb3NzaWJsZSBjaXJjdWxhciBsb2NraW5nIGRlcGVu
ZGVuY3kgZGV0ZWN0ZWQKPDQ+WyAgMjQ2Ljc5Mzk4OV0gNS4zLjAtZ2JkNmM1NmY1MGQxNS1kcm10
aXBfMzcyKyAjMSBUYWludGVkOiBHICAgICBVCjw0PlsgIDI0Ni43OTQwMDNdIC0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQo8ND5bICAyNDYuNzk0
MDE3XSBrc3dhcGQwLzE0NSBpcyB0cnlpbmcgdG8gYWNxdWlyZSBsb2NrOgo8ND5bICAyNDYuNzk0
MDMwXSAwMDAwMDAwMDNmNTY1YmU2ICgmZGV2LT5zdHJ1Y3RfbXV0ZXgvMSl7Ky4rLn0sIGF0OiB1
c2VycHRyX21uX2ludmFsaWRhdGVfcmFuZ2Vfc3RhcnQrMHgxOGYvMHgyMjAgW2k5MTVdCjw0Plsg
IDI0Ni43OTQyNTBdCiAgICAgICAgICAgICAgICAgIGJ1dCB0YXNrIGlzIGFscmVhZHkgaG9sZGlu
ZyBsb2NrOgo8ND5bICAyNDYuNzk0MjYzXSAwMDAwMDAwMDE3OTljZWY5ICgmYW5vbl92bWEtPnJ3
c2VtKXsrKysrfSwgYXQ6IHBhZ2VfbG9ja19hbm9uX3ZtYV9yZWFkKzB4ZTYvMHgyYTAKPDQ+WyAg
MjQ2Ljc5NDI5MV0KICAgICAgICAgICAgICAgICAgd2hpY2ggbG9jayBhbHJlYWR5IGRlcGVuZHMg
b24gdGhlIG5ldyBsb2NrLgoKPDQ+WyAgMjQ2Ljc5NDMwN10KICAgICAgICAgICAgICAgICAgdGhl
IGV4aXN0aW5nIGRlcGVuZGVuY3kgY2hhaW4gKGluIHJldmVyc2Ugb3JkZXIpIGlzOgo8ND5bICAy
NDYuNzk0MzIyXQogICAgICAgICAgICAgICAgICAtPiAjMyAoJmFub25fdm1hLT5yd3NlbSl7Kysr
K306Cjw0PlsgIDI0Ni43OTQzNDRdICAgICAgICBkb3duX3dyaXRlKzB4MzMvMHg3MAo8ND5bICAy
NDYuNzk0MzU3XSAgICAgICAgX192bWFfYWRqdXN0KzB4M2Q5LzB4N2IwCjw0PlsgIDI0Ni43OTQz
NzBdICAgICAgICBfX3NwbGl0X3ZtYSsweDE2YS8weDE4MAo8ND5bICAyNDYuNzk0Mzg1XSAgICAg
ICAgbXByb3RlY3RfZml4dXArMHgyYTUvMHgzMjAKPDQ+WyAgMjQ2Ljc5NDM5OV0gICAgICAgIGRv
X21wcm90ZWN0X3BrZXkrMHgyMDgvMHgyZTAKPDQ+WyAgMjQ2Ljc5NDQxM10gICAgICAgIF9feDY0
X3N5c19tcHJvdGVjdCsweDE2LzB4MjAKPDQ+WyAgMjQ2Ljc5NDQyOV0gICAgICAgIGRvX3N5c2Nh
bGxfNjQrMHg1NS8weDFjMAo8ND5bICAyNDYuNzk0NDQzXSAgICAgICAgZW50cnlfU1lTQ0FMTF82
NF9hZnRlcl9od2ZyYW1lKzB4NDkvMHhiZQo8ND5bICAyNDYuNzk0NDU2XQogICAgICAgICAgICAg
ICAgICAtPiAjMiAoJm1hcHBpbmctPmlfbW1hcF9yd3NlbSl7KysrK306Cjw0PlsgIDI0Ni43OTQ0
NzhdICAgICAgICBkb3duX3dyaXRlKzB4MzMvMHg3MAo8ND5bICAyNDYuNzk0NDkzXSAgICAgICAg
dW5tYXBfbWFwcGluZ19wYWdlcysweDQ4LzB4MTMwCjw0PlsgIDI0Ni43OTQ1MTldICAgICAgICBp
OTE1X3ZtYV9yZXZva2VfbW1hcCsweDgxLzB4MWIwIFtpOTE1XQo8ND5bICAyNDYuNzk0NTE5XSAg
ICAgICAgaTkxNV92bWFfdW5iaW5kKzB4MTFkLzB4NGEwIFtpOTE1XQo8ND5bICAyNDYuNzk0NTE5
XSAgICAgICAgaTkxNV92bWFfZGVzdHJveSsweDMxLzB4MzAwIFtpOTE1XQo8ND5bICAyNDYuNzk0
NTE5XSAgICAgICAgX19pOTE1X2dlbV9mcmVlX29iamVjdHMrMHhiOC8weDRiMCBbaTkxNV0KPDQ+
WyAgMjQ2Ljc5NDUxOV0gICAgICAgIGRybV9maWxlX2ZyZWUucGFydC4wKzB4MWU2LzB4MjkwCjw0
PlsgIDI0Ni43OTQ1MTldICAgICAgICBkcm1fcmVsZWFzZSsweGE2LzB4ZTAKPDQ+WyAgMjQ2Ljc5
NDUxOV0gICAgICAgIF9fZnB1dCsweGMyLzB4MjUwCjw0PlsgIDI0Ni43OTQ1MTldICAgICAgICB0
YXNrX3dvcmtfcnVuKzB4ODIvMHhiMAo8ND5bICAyNDYuNzk0NTE5XSAgICAgICAgZG9fZXhpdCsw
eDM1Yi8weGRiMAo8ND5bICAyNDYuNzk0NTE5XSAgICAgICAgZG9fZ3JvdXBfZXhpdCsweDM0LzB4
YjAKPDQ+WyAgMjQ2Ljc5NDUxOV0gICAgICAgIF9feDY0X3N5c19leGl0X2dyb3VwKzB4Zi8weDEw
Cjw0PlsgIDI0Ni43OTQ1MTldICAgICAgICBkb19zeXNjYWxsXzY0KzB4NTUvMHgxYzAKPDQ+WyAg
MjQ2Ljc5NDUxOV0gICAgICAgIGVudHJ5X1NZU0NBTExfNjRfYWZ0ZXJfaHdmcmFtZSsweDQ5LzB4
YmUKPDQ+WyAgMjQ2Ljc5NDUxOV0KICAgICAgICAgICAgICAgICAgLT4gIzEgKCZ2bS0+bXV0ZXgp
eysuKy59Ogo8ND5bICAyNDYuNzk0NTE5XSAgICAgICAgaTkxNV9nZW1fc2hyaW5rZXJfdGFpbnRz
X211dGV4KzB4NmQvMHhlMCBbaTkxNV0KPDQ+WyAgMjQ2Ljc5NDUxOV0gICAgICAgIGk5MTVfYWRk
cmVzc19zcGFjZV9pbml0KzB4OWYvMHgxNjAgW2k5MTVdCjw0PlsgIDI0Ni43OTQ1MTldICAgICAg
ICBpOTE1X2dndHRfaW5pdF9odysweDU1LzB4MTcwIFtpOTE1XQo8ND5bICAyNDYuNzk0NTE5XSAg
ICAgICAgaTkxNV9kcml2ZXJfcHJvYmUrMHhjOWYvMHgxNjIwIFtpOTE1XQo8ND5bICAyNDYuNzk0
NTE5XSAgICAgICAgaTkxNV9wY2lfcHJvYmUrMHg0My8weDFiMCBbaTkxNV0KPDQ+WyAgMjQ2Ljc5
NDUxOV0gICAgICAgIHBjaV9kZXZpY2VfcHJvYmUrMHg5ZS8weDEyMAo8ND5bICAyNDYuNzk0NTE5
XSAgICAgICAgcmVhbGx5X3Byb2JlKzB4ZWEvMHgzZDAKPDQ+WyAgMjQ2Ljc5NDUxOV0gICAgICAg
IGRyaXZlcl9wcm9iZV9kZXZpY2UrMHgxMGIvMHgxMjAKPDQ+WyAgMjQ2Ljc5NDUxOV0gICAgICAg
IGRldmljZV9kcml2ZXJfYXR0YWNoKzB4NGEvMHg1MAo8ND5bICAyNDYuNzk0NTE5XSAgICAgICAg
X19kcml2ZXJfYXR0YWNoKzB4OTcvMHgxMzAKPDQ+WyAgMjQ2Ljc5NDUxOV0gICAgICAgIGJ1c19m
b3JfZWFjaF9kZXYrMHg3NC8weGMwCjw0PlsgIDI0Ni43OTQ1MTldICAgICAgICBidXNfYWRkX2Ry
aXZlcisweDEzZi8weDIxMAo8ND5bICAyNDYuNzk0NTE5XSAgICAgICAgZHJpdmVyX3JlZ2lzdGVy
KzB4NTYvMHhlMAo8ND5bICAyNDYuNzk0NTE5XSAgICAgICAgZG9fb25lX2luaXRjYWxsKzB4NTgv
MHgzMDAKPDQ+WyAgMjQ2Ljc5NDUxOV0gICAgICAgIGRvX2luaXRfbW9kdWxlKzB4NTYvMHgxZjYK
PDQ+WyAgMjQ2Ljc5NDUxOV0gICAgICAgIGxvYWRfbW9kdWxlKzB4MjViZC8weDJhNDAKPDQ+WyAg
MjQ2Ljc5NDUxOV0gICAgICAgIF9fc2Vfc3lzX2Zpbml0X21vZHVsZSsweGQzLzB4ZjAKPDQ+WyAg
MjQ2Ljc5NDUxOV0gICAgICAgIGRvX3N5c2NhbGxfNjQrMHg1NS8weDFjMAo8ND5bICAyNDYuNzk0
NTE5XSAgICAgICAgZW50cnlfU1lTQ0FMTF82NF9hZnRlcl9od2ZyYW1lKzB4NDkvMHhiZQo8ND5b
ICAyNDYuNzk0NTE5XQogICAgICAgICAgICAgICAgICAtPiAjMCAoJmRldi0+c3RydWN0X211dGV4
LzEpeysuKy59Ogo8ND5bICAyNDYuNzk0NTE5XSAgICAgICAgX19sb2NrX2FjcXVpcmUrMHgxNWQ4
LzB4MWU5MAo8ND5bICAyNDYuNzk0NTE5XSAgICAgICAgbG9ja19hY3F1aXJlKzB4YTYvMHgxYzAK
PDQ+WyAgMjQ2Ljc5NDUxOV0gICAgICAgIF9fbXV0ZXhfbG9jaysweDlkLzB4OWIwCjw0PlsgIDI0
Ni43OTQ1MTldICAgICAgICB1c2VycHRyX21uX2ludmFsaWRhdGVfcmFuZ2Vfc3RhcnQrMHgxOGYv
MHgyMjAgW2k5MTVdCjw0PlsgIDI0Ni43OTQ1MTldICAgICAgICBfX21tdV9ub3RpZmllcl9pbnZh
bGlkYXRlX3JhbmdlX3N0YXJ0KzB4ODUvMHgxMTAKPDQ+WyAgMjQ2Ljc5NDUxOV0gICAgICAgIHRy
eV90b191bm1hcF9vbmUrMHg3NmIvMHg4NjAKPDQ+WyAgMjQ2Ljc5NDUxOV0gICAgICAgIHJtYXBf
d2Fsa19hbm9uKzB4MTA0LzB4MjgwCjw0PlsgIDI0Ni43OTQ1MTldICAgICAgICB0cnlfdG9fdW5t
YXArMHhjMC8weGYwCjw0PlsgIDI0Ni43OTQ1MTldICAgICAgICBzaHJpbmtfcGFnZV9saXN0KzB4
NTYxLzB4YzEwCjw0PlsgIDI0Ni43OTQ1MTldICAgICAgICBzaHJpbmtfaW5hY3RpdmVfbGlzdCsw
eDIyMC8weDQ0MAo8ND5bICAyNDYuNzk0NTE5XSAgICAgICAgc2hyaW5rX25vZGVfbWVtY2crMHgz
NmUvMHg3NDAKPDQ+WyAgMjQ2Ljc5NDUxOV0gICAgICAgIHNocmlua19ub2RlKzB4Y2IvMHg0OTAK
PDQ+WyAgMjQ2Ljc5NDUxOV0gICAgICAgIGJhbGFuY2VfcGdkYXQrMHgyNDEvMHg1ODAKPDQ+WyAg
MjQ2Ljc5NDUxOV0gICAgICAgIGtzd2FwZCsweDE2Yy8weDUzMAo8ND5bICAyNDYuNzk0NTE5XSAg
ICAgICAga3RocmVhZCsweDExOS8weDEzMAo8ND5bICAyNDYuNzk0NTE5XSAgICAgICAgcmV0X2Zy
b21fZm9yaysweDI0LzB4NTAKPDQ+WyAgMjQ2Ljc5NDUxOV0KICAgICAgICAgICAgICAgICAgb3Ro
ZXIgaW5mbyB0aGF0IG1pZ2h0IGhlbHAgdXMgZGVidWcgdGhpczoKCjw0PlsgIDI0Ni43OTQ1MTld
IENoYWluIGV4aXN0cyBvZjoKICAgICAgICAgICAgICAgICAgICAmZGV2LT5zdHJ1Y3RfbXV0ZXgv
MSAtLT4gJm1hcHBpbmctPmlfbW1hcF9yd3NlbSAtLT4gJmFub25fdm1hLT5yd3NlbQoKPDQ+WyAg
MjQ2Ljc5NDUxOV0gIFBvc3NpYmxlIHVuc2FmZSBsb2NraW5nIHNjZW5hcmlvOgoKPDQ+WyAgMjQ2
Ljc5NDUxOV0gICAgICAgIENQVTAgICAgICAgICAgICAgICAgICAgIENQVTEKPDQ+WyAgMjQ2Ljc5
NDUxOV0gICAgICAgIC0tLS0gICAgICAgICAgICAgICAgICAgIC0tLS0KPDQ+WyAgMjQ2Ljc5NDUx
OV0gICBsb2NrKCZhbm9uX3ZtYS0+cndzZW0pOwo8ND5bICAyNDYuNzk0NTE5XSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbG9jaygmbWFwcGluZy0+aV9tbWFwX3J3c2VtKTsKPDQ+WyAg
MjQ2Ljc5NDUxOV0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2soJmFub25fdm1h
LT5yd3NlbSk7Cjw0PlsgIDI0Ni43OTQ1MTldICAgbG9jaygmZGV2LT5zdHJ1Y3RfbXV0ZXgvMSk7
Cjw0PlsgIDI0Ni43OTQ1MTldCiAgICAgICAgICAgICAgICAgICAqKiogREVBRExPQ0sgKioqCgp2
MjogU2F5IG5vIHRvIG1tYXBfaW9jdGwKCkJ1Z3ppbGxhOiBodHRwczovL2J1Z3MuZnJlZWRlc2t0
b3Aub3JnL3Nob3dfYnVnLmNnaT9pZD0xMTE3NDQKU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29u
IDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+CkNjOiBUdnJ0a28gVXJzdWxpbiA8dHZydGtvLnVy
c3VsaW5AaW50ZWwuY29tPgpDYzogRGFuaWVsIFZldHRlciA8ZGFuaWVsLnZldHRlckBmZndsbC5j
aD4KQ2M6IHN0YWJsZUB2Z2VyLmtlcm5lbC5vcmcKLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fbW1hbi5jICAgICAgICAgfCA3ICsrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaCAgICAgICB8IDYgKysrKysrCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0X3R5cGVzLmggfCAzICsrLQogZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3VzZXJwdHIuYyAgICAgIHwgMSArCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2dlbS5jICAgICAgICAgICAgICAgICAgfCAzICsrKwogNSBmaWxlcyBjaGFu
Z2VkLCAxOSBpbnNlcnRpb25zKCspLCAxIGRlbGV0aW9uKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21tYW4uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9tbWFuLmMKaW5kZXggODYwYjc1MWM1MWYxLi5kZDBjMjg0MGJhNGQgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9tbWFuLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21tYW4uYwpAQCAtMzQzLDYgKzM0Myw3
IEBAIHZtX2ZhdWx0X3QgaTkxNV9nZW1fZmF1bHQoc3RydWN0IHZtX2ZhdWx0ICp2bWYpCiAJCS8q
IGZhbGx0aHJvdWdoICovCiAJY2FzZSAtRUlPOiAvKiBzaG1lbWZzIGZhaWx1cmUgZnJvbSBzd2Fw
IGRldmljZSAqLwogCWNhc2UgLUVGQVVMVDogLyogcHVyZ2VkIG9iamVjdCAqLworCWNhc2UgLUVO
T0RFVjogLyogYmFkIG9iamVjdCwgaG93IGRpZCB5b3UgZ2V0IGhlcmUhICovCiAJCXJldHVybiBW
TV9GQVVMVF9TSUdCVVM7CiAKIAljYXNlIC1FTk9TUEM6IC8qIHNobWVtZnMgYWxsb2NhdGlvbiBm
YWlsdXJlICovCkBAIC00NjYsMTAgKzQ2NywxNiBAQCBpOTE1X2dlbV9tbWFwX2d0dChzdHJ1Y3Qg
ZHJtX2ZpbGUgKmZpbGUsCiAJaWYgKCFvYmopCiAJCXJldHVybiAtRU5PRU5UOwogCisJaWYgKGk5
MTVfZ2VtX29iamVjdF9uZXZlcl9iaW5kX2dndHQob2JqKSkgeworCQlyZXQgPSAtRU5PREVWOwor
CQlnb3RvIG91dDsKKwl9CisKIAlyZXQgPSBjcmVhdGVfbW1hcF9vZmZzZXQob2JqKTsKIAlpZiAo
cmV0ID09IDApCiAJCSpvZmZzZXQgPSBkcm1fdm1hX25vZGVfb2Zmc2V0X2FkZHIoJm9iai0+YmFz
ZS52bWFfbm9kZSk7CiAKK291dDoKIAlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CiAJcmV0dXJu
IHJldDsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9v
YmplY3QuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaAppbmRl
eCAyOWI5ZWRkYzRjN2YuLmFlYzA1Zjk2N2Q5ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9vYmplY3QuaApAQCAtMTUyLDYgKzE1MiwxMiBAQCBpOTE1X2dlbV9vYmplY3Rf
aXNfcHJveHkoY29uc3Qgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIAlyZXR1cm4g
b2JqLT5vcHMtPmZsYWdzICYgSTkxNV9HRU1fT0JKRUNUX0lTX1BST1hZOwogfQogCitzdGF0aWMg
aW5saW5lIGJvb2wKK2k5MTVfZ2VtX29iamVjdF9uZXZlcl9iaW5kX2dndHQoY29uc3Qgc3RydWN0
IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKK3sKKwlyZXR1cm4gb2JqLT5vcHMtPmZsYWdzICYg
STkxNV9HRU1fT0JKRUNUX05PX0dHVFQ7Cit9CisKIHN0YXRpYyBpbmxpbmUgYm9vbAogaTkxNV9n
ZW1fb2JqZWN0X25lZWRzX2FzeW5jX2NhbmNlbChjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29i
amVjdCAqb2JqKQogewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX29iamVjdF90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29i
amVjdF90eXBlcy5oCmluZGV4IGQ2OTVmMTg3Yjc5MC4uZTFhYWIyZmQxY2Q5IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0X3R5cGVzLmgKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oCkBAIC0zMiw3
ICszMiw4IEBAIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0X29wcyB7CiAjZGVmaW5lIEk5MTVf
R0VNX09CSkVDVF9IQVNfU1RSVUNUX1BBR0UJQklUKDApCiAjZGVmaW5lIEk5MTVfR0VNX09CSkVD
VF9JU19TSFJJTktBQkxFCUJJVCgxKQogI2RlZmluZSBJOTE1X0dFTV9PQkpFQ1RfSVNfUFJPWFkJ
QklUKDIpCi0jZGVmaW5lIEk5MTVfR0VNX09CSkVDVF9BU1lOQ19DQU5DRUwJQklUKDMpCisjZGVm
aW5lIEk5MTVfR0VNX09CSkVDVF9OT19HR1RUCQlCSVQoMykKKyNkZWZpbmUgSTkxNV9HRU1fT0JK
RUNUX0FTWU5DX0NBTkNFTAlCSVQoNCkKIAogCS8qIEludGVyZmFjZSBiZXR3ZWVuIHRoZSBHRU0g
b2JqZWN0IGFuZCBpdHMgYmFja2luZyBzdG9yYWdlLgogCSAqIGdldF9wYWdlcygpIGlzIGNhbGxl
ZCBvbmNlIHByaW9yIHRvIHRoZSB1c2Ugb2YgdGhlIGFzc29jaWF0ZWQgc2V0CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdXNlcnB0ci5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3VzZXJwdHIuYwppbmRleCAxMWIyMzFjMTg3YzUuLjZi
M2I1MGYwZjZkOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X3VzZXJwdHIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdXNlcnB0
ci5jCkBAIC03MDIsNiArNzAyLDcgQEAgaTkxNV9nZW1fdXNlcnB0cl9kbWFidWZfZXhwb3J0KHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiBzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3Rfb3BzIGk5MTVfZ2VtX3VzZXJwdHJfb3BzID0gewogCS5mbGFncyA9IEk5
MTVfR0VNX09CSkVDVF9IQVNfU1RSVUNUX1BBR0UgfAogCQkgSTkxNV9HRU1fT0JKRUNUX0lTX1NI
UklOS0FCTEUgfAorCQkgSTkxNV9HRU1fT0JKRUNUX05PX0dHVFQgfAogCQkgSTkxNV9HRU1fT0JK
RUNUX0FTWU5DX0NBTkNFTCwKIAkuZ2V0X3BhZ2VzID0gaTkxNV9nZW1fdXNlcnB0cl9nZXRfcGFn
ZXMsCiAJLnB1dF9wYWdlcyA9IGk5MTVfZ2VtX3VzZXJwdHJfcHV0X3BhZ2VzLApkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZ2VtLmMKaW5kZXggM2QzZmRhNGNhZTk5Li4xNDI2ZTUwNjcwMGQgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9nZW0uYwpAQCAtOTcwLDYgKzk3MCw5IEBAIGk5MTVfZ2VtX29iamVjdF9nZ3R0X3Bp
bihzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCiAJbG9ja2RlcF9hc3NlcnRfaGVs
ZCgmb2JqLT5iYXNlLmRldi0+c3RydWN0X211dGV4KTsKIAorCWlmIChpOTE1X2dlbV9vYmplY3Rf
bmV2ZXJfYmluZF9nZ3R0KG9iaikpCisJCXJldHVybiBFUlJfUFRSKC1FTk9ERVYpOworCiAJaWYg
KGZsYWdzICYgUElOX01BUFBBQkxFICYmCiAJICAgICghdmlldyB8fCB2aWV3LT50eXBlID09IEk5
MTVfR0dUVF9WSUVXX05PUk1BTCkpIHsKIAkJLyogSWYgdGhlIHJlcXVpcmVkIHNwYWNlIGlzIGxh
cmdlciB0aGFuIHRoZSBhdmFpbGFibGUKLS0gCjIuMjMuMAoKX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1n
ZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21h
aWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

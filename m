Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id EF39956EE5
	for <lists+intel-gfx@lfdr.de>; Wed, 26 Jun 2019 18:36:05 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CF2C76E49F;
	Wed, 26 Jun 2019 16:36:03 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga05.intel.com (mga05.intel.com [192.55.52.43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8625F6E49F
 for <intel-gfx@lists.freedesktop.org>; Wed, 26 Jun 2019 16:36:02 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga003.jf.intel.com ([10.7.209.27])
 by fmsmga105.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 26 Jun 2019 09:36:01 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,420,1557212400"; d="scan'208";a="164407023"
Received: from gaia.fi.intel.com ([10.237.72.169])
 by orsmga003.jf.intel.com with ESMTP; 26 Jun 2019 09:36:00 -0700
Received: by gaia.fi.intel.com (Postfix, from userid 1000)
 id DE4B15C1EAE; Wed, 26 Jun 2019 19:35:45 +0300 (EEST)
From: Mika Kuoppala <mika.kuoppala@linux.intel.com>
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
In-Reply-To: <20190626154549.10066-3-chris@chris-wilson.co.uk>
References: <20190626154549.10066-1-chris@chris-wilson.co.uk>
 <20190626154549.10066-3-chris@chris-wilson.co.uk>
Date: Wed, 26 Jun 2019 19:35:45 +0300
Message-ID: <87mui4484e.fsf@gaia.fi.intel.com>
MIME-Version: 1.0
Subject: Re: [Intel-gfx] [PATCH 3/3] drm/i915: Lift intel_engines_resume()
 to callers
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: matthew.auld@intel.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Q2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+IHdyaXRlczoKCj4gU2luY2Ug
dGhlIHJlc2V0IHBhdGggd2FudHMgdG8gcmVjb3ZlciB0aGUgZW5naW5lcyBpdHNlbGYsIGl0IG9u
bHkgd2FudHMKPiB0byByZWluaXRpYWxpc2UgdGhlIGhhcmR3YXJlIHVzaW5nIGk5MTVfZ2VtX2lu
aXRfaHcoKS4gUHVsbCB0aGUgY2FsbCB0bwo+IGludGVsX2VuZ2luZXNfcmVzdW1lKCkgdG8gdGhl
IG1vZHVsZSBpbml0L3Jlc3VtZSBwYXRoIHNvIHdlIGNhbiBhdm9pZCBpdAo+IGR1cmluZyByZXNl
dC4KPgo+IFNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNv
LnVrPgoKUmV2aWV3ZWQtYnk6IE1pa2EgS3VvcHBhbGEgPG1pa2Eua3VvcHBhbGFAbGludXguaW50
ZWwuY29tPgoKPiAtLS0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMg
ICAgfCAgNyArKy0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMg
fCAyNCAtLS0tLS0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0u
aCB8ICAyIC0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYyAgICAgfCAy
MSArKysrKystCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3BtLmggICAgIHwg
IDIgKy0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYyAgICAgfCAyMSAr
KysrKystCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMgICAgICAgICAgIHwgNzEg
KysrKysrKy0tLS0tLS0tLS0tLS0tLS0KPiAgNyBmaWxlcyBjaGFuZ2VkLCA2NSBpbnNlcnRpb25z
KCspLCA4MyBkZWxldGlvbnMoLSkKPgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fcG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9w
bS5jCj4gaW5kZXggNmI3MzBiZDRkNzJmLi40ZDc3NDM3NmY1YjggMTAwNjQ0Cj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYwo+IEBAIC0yNTQsMTQgKzI1NCwxNSBAQCB2b2lkIGk5
MTVfZ2VtX3Jlc3VtZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgCWk5MTVfZ2Vt
X3Jlc3RvcmVfZ3R0X21hcHBpbmdzKGk5MTUpOwo+ICAJaTkxNV9nZW1fcmVzdG9yZV9mZW5jZXMo
aTkxNSk7Cj4gIAo+ICsJaWYgKGk5MTVfZ2VtX2luaXRfaHcoaTkxNSkpCj4gKwkJZ290byBlcnJf
d2VkZ2VkOwo+ICsKPiAgCS8qCj4gIAkgKiBBcyB3ZSBkaWRuJ3QgZmx1c2ggdGhlIGtlcm5lbCBj
b250ZXh0IGJlZm9yZSBzdXNwZW5kLCB3ZSBjYW5ub3QKPiAgCSAqIGd1YXJhbnRlZSB0aGF0IHRo
ZSBjb250ZXh0IGltYWdlIGlzIGNvbXBsZXRlLiBTbyBsZXQncyBqdXN0IHJlc2V0Cj4gIAkgKiBp
dCBhbmQgc3RhcnQgYWdhaW4uCj4gIAkgKi8KPiAtCWludGVsX2d0X3Jlc3VtZSgmaTkxNS0+Z3Qp
Owo+IC0KPiAtCWlmIChpOTE1X2dlbV9pbml0X2h3KGk5MTUpKQo+ICsJaWYgKGludGVsX2d0X3Jl
c3VtZSgmaTkxNS0+Z3QpKQo+ICAJCWdvdG8gZXJyX3dlZGdlZDsKPiAgCj4gIAlpbnRlbF91Y19y
ZXN1bWUoaTkxNSk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2VuZ2luZV9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMK
PiBpbmRleCA1MjUzYzM4MjAzNGQuLjg0ZTQzMmFiZThlMCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5jCj4gQEAgLTE0MiwyNyArMTQyLDMgQEAgdm9pZCBp
bnRlbF9lbmdpbmVfaW5pdF9fcG0oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+ICB7
Cj4gIAlpbnRlbF93YWtlcmVmX2luaXQoJmVuZ2luZS0+d2FrZXJlZik7Cj4gIH0KPiAtCj4gLWlu
dCBpbnRlbF9lbmdpbmVzX3Jlc3VtZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAt
ewo+IC0Jc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwo+IC0JZW51bSBpbnRlbF9lbmdp
bmVfaWQgaWQ7Cj4gLQlpbnQgZXJyID0gMDsKPiAtCj4gLQlpbnRlbF9ndF9wbV9nZXQoJmk5MTUt
Pmd0KTsKPiAtCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKSB7Cj4gLQkJaW50ZWxf
ZW5naW5lX3BtX2dldChlbmdpbmUpOwo+IC0JCWVuZ2luZS0+c2VyaWFsKys7IC8qIGtlcm5lbCBj
b250ZXh0IGxvc3QgKi8KPiAtCQllcnIgPSBlbmdpbmUtPnJlc3VtZShlbmdpbmUpOwo+IC0JCWlu
dGVsX2VuZ2luZV9wbV9wdXQoZW5naW5lKTsKPiAtCQlpZiAoZXJyKSB7Cj4gLQkJCWRldl9lcnIo
aTkxNS0+ZHJtLmRldiwKPiAtCQkJCSJGYWlsZWQgdG8gcmVzdGFydCAlcyAoJWQpXG4iLAo+IC0J
CQkJZW5naW5lLT5uYW1lLCBlcnIpOwo+IC0JCQlicmVhazsKPiAtCQl9Cj4gLQl9Cj4gLQlpbnRl
bF9ndF9wbV9wdXQoJmk5MTUtPmd0KTsKPiAtCj4gLQlyZXR1cm4gZXJyOwo+IC19Cj4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5oIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmgKPiBpbmRleCA3ZDA1N2NkY2Q5MTku
LjAxNWFjNzJkN2FkMCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9lbmdpbmVfcG0uaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2lu
ZV9wbS5oCj4gQEAgLTMxLDYgKzMxLDQgQEAgdm9pZCBpbnRlbF9lbmdpbmVfcGFyayhzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUpOwo+ICAKPiAgdm9pZCBpbnRlbF9lbmdpbmVfaW5pdF9f
cG0oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKPiAgCj4gLWludCBpbnRlbF9lbmdp
bmVzX3Jlc3VtZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gLQo+ICAjZW5kaWYg
LyogSU5URUxfRU5HSU5FX1BNX0ggKi8KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZ3RfcG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3Bt
LmMKPiBpbmRleCBlYzZiNjlkMDE0YjYuLjM2YmE4MGU2YTBiNyAxMDA2NDQKPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9wbS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYwo+IEBAIC01LDYgKzUsNyBAQAo+ICAgKi8KPiAgCj4gICNp
bmNsdWRlICJpOTE1X2Rydi5oIgo+ICsjaW5jbHVkZSAiaW50ZWxfZW5naW5lX3BtLmgiCj4gICNp
bmNsdWRlICJpbnRlbF9ndF9wbS5oIgo+ICAjaW5jbHVkZSAiaW50ZWxfcG0uaCIKPiAgI2luY2x1
ZGUgImludGVsX3dha2VyZWYuaCIKPiBAQCAtMTIyLDEwICsxMjMsMTEgQEAgdm9pZCBpbnRlbF9n
dF9zYW5pdGl6ZShzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBib29sIGZvcmNlKQo+ICAJCWludGVsX2Vu
Z2luZV9yZXNldChlbmdpbmUsIGZhbHNlKTsKPiAgfQo+ICAKPiAtdm9pZCBpbnRlbF9ndF9yZXN1
bWUoc3RydWN0IGludGVsX2d0ICpndCkKPiAraW50IGludGVsX2d0X3Jlc3VtZShzdHJ1Y3QgaW50
ZWxfZ3QgKmd0KQo+ICB7Cj4gIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4gIAll
bnVtIGludGVsX2VuZ2luZV9pZCBpZDsKPiArCWludCBlcnIgPSAwOwo+ICAKPiAgCS8qCj4gIAkg
KiBBZnRlciByZXN1bWUsIHdlIG1heSBuZWVkIHRvIHBva2UgaW50byB0aGUgcGlubmVkIGtlcm5l
bAo+IEBAIC0xMzMsOSArMTM1LDEyIEBAIHZvaWQgaW50ZWxfZ3RfcmVzdW1lKHN0cnVjdCBpbnRl
bF9ndCAqZ3QpCj4gIAkgKiBPbmx5IHRoZSBrZXJuZWwgY29udGV4dHMgc2hvdWxkIHJlbWFpbiBw
aW5uZWQgb3ZlciBzdXNwZW5kLAo+ICAJICogYWxsb3dpbmcgdXMgdG8gZml4dXAgdGhlIHVzZXIg
Y29udGV4dHMgb24gdGhlaXIgZmlyc3QgcGluLgo+ICAJICovCj4gKwlpbnRlbF9ndF9wbV9nZXQo
Z3QpOwo+ICAJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QtPmk5MTUsIGlkKSB7Cj4gIAkJc3Ry
dWN0IGludGVsX2NvbnRleHQgKmNlOwo+ICAKPiArCQlpbnRlbF9lbmdpbmVfcG1fZ2V0KGVuZ2lu
ZSk7Cj4gKwo+ICAJCWNlID0gZW5naW5lLT5rZXJuZWxfY29udGV4dDsKPiAgCQlpZiAoY2UpCj4g
IAkJCWNlLT5vcHMtPnJlc2V0KGNlKTsKPiBAQCAtMTQzLDUgKzE0OCwxOSBAQCB2b2lkIGludGVs
X2d0X3Jlc3VtZShzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQo+ICAJCWNlID0gZW5naW5lLT5wcmVlbXB0
X2NvbnRleHQ7Cj4gIAkJaWYgKGNlKQo+ICAJCQljZS0+b3BzLT5yZXNldChjZSk7Cj4gKwo+ICsJ
CWVuZ2luZS0+c2VyaWFsKys7IC8qIGtlcm5lbCBjb250ZXh0IGxvc3QgKi8KPiArCQllcnIgPSBl
bmdpbmUtPnJlc3VtZShlbmdpbmUpOwo+ICsKPiArCQlpbnRlbF9lbmdpbmVfcG1fcHV0KGVuZ2lu
ZSk7Cj4gKwkJaWYgKGVycikgewo+ICsJCQlkZXZfZXJyKGd0LT5pOTE1LT5kcm0uZGV2LAo+ICsJ
CQkJIkZhaWxlZCB0byByZXN0YXJ0ICVzICglZClcbiIsCj4gKwkJCQllbmdpbmUtPm5hbWUsIGVy
cik7Cj4gKwkJCWJyZWFrOwo+ICsJCX0KPiAgCX0KPiArCWludGVsX2d0X3BtX3B1dChndCk7Cj4g
Kwo+ICsJcmV0dXJuIGVycjsKPiAgfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9ndF9wbS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0u
aAo+IGluZGV4IDRkYmI5MmNmNThkNy4uYmE5NjBlMWZjMjA5IDEwMDY0NAo+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3BtLmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9ndF9wbS5oCj4gQEAgLTIyLDYgKzIyLDYgQEAgdm9pZCBpbnRlbF9ndF9w
bV9wdXQoc3RydWN0IGludGVsX2d0ICpndCk7Cj4gIHZvaWQgaW50ZWxfZ3RfcG1faW5pdF9lYXJs
eShzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKPiAgCj4gIHZvaWQgaW50ZWxfZ3Rfc2FuaXRpemUoc3Ry
dWN0IGludGVsX2d0ICpndCwgYm9vbCBmb3JjZSk7Cj4gLXZvaWQgaW50ZWxfZ3RfcmVzdW1lKHN0
cnVjdCBpbnRlbF9ndCAqZ3QpOwo+ICtpbnQgaW50ZWxfZ3RfcmVzdW1lKHN0cnVjdCBpbnRlbF9n
dCAqZ3QpOwo+ICAKPiAgI2VuZGlmIC8qIElOVEVMX0dUX1BNX0ggKi8KPiBkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX3Jlc2V0LmMKPiBpbmRleCBlN2NiZDljZjg1YzEuLmFkZmRiOTA4NTg3ZiAx
MDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jCj4gKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwo+IEBAIC05NDksNiArOTQ5
LDIxIEBAIHN0YXRpYyBpbnQgZG9fcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gIAlyZXR1cm4gZ3RfcmVzZXQoaTkxNSwgc3RhbGxlZF9tYXNrKTsKPiAgfQo+ICAKPiArc3Rh
dGljIGludCByZXN1bWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gK3sKPiArCXN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKPiArCWVudW0gaW50ZWxfZW5naW5lX2lkIGlk
Owo+ICsJaW50IHJldDsKPiArCj4gKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkg
ewo+ICsJCXJldCA9IGVuZ2luZS0+cmVzdW1lKGVuZ2luZSk7Cj4gKwkJaWYgKHJldCkKPiArCQkJ
cmV0dXJuIHJldDsKPiArCX0KPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiAgLyoqCj4gICAq
IGk5MTVfcmVzZXQgLSByZXNldCBjaGlwIGFmdGVyIGEgaGFuZwo+ICAgKiBAaTkxNTogI2RybV9p
OTE1X3ByaXZhdGUgdG8gcmVzZXQKPiBAQCAtMTAyMyw5ICsxMDM4LDEzIEBAIHZvaWQgaTkxNV9y
ZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgCWlmIChyZXQpIHsKPiAgCQlE
Uk1fRVJST1IoIkZhaWxlZCB0byBpbml0aWFsaXNlIEhXIGZvbGxvd2luZyByZXNldCAoJWQpXG4i
LAo+ICAJCQkgIHJldCk7Cj4gLQkJZ290byBlcnJvcjsKPiArCQlnb3RvIHRhaW50Owo+ICAJfQo+
ICAKPiArCXJldCA9IHJlc3VtZShpOTE1KTsKPiArCWlmIChyZXQpCj4gKwkJZ290byB0YWludDsK
PiArCj4gIAlpOTE1X3F1ZXVlX2hhbmdjaGVjayhpOTE1KTsKPiAgCj4gIGZpbmlzaDoKPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZ2VtLmMKPiBpbmRleCBkZWVjYmUxMjhlNWIuLmI3ZjI5MGI3N2Y4ZiAxMDA2
NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCj4gKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwo+IEBAIC00Niw3ICs0Niw2IEBACj4gICNpbmNsdWRl
ICJnZW0vaTkxNV9nZW1faW9jdGxzLmgiCj4gICNpbmNsdWRlICJnZW0vaTkxNV9nZW1fcG0uaCIK
PiAgI2luY2x1ZGUgImdlbS9pOTE1X2dlbWZzLmgiCj4gLSNpbmNsdWRlICJndC9pbnRlbF9lbmdp
bmVfcG0uaCIKPiAgI2luY2x1ZGUgImd0L2ludGVsX2d0LmgiCj4gICNpbmNsdWRlICJndC9pbnRl
bF9ndF9wbS5oIgo+ICAjaW5jbHVkZSAiZ3QvaW50ZWxfbW9jcy5oIgo+IEBAIC0xMTkyLDEyICsx
MTkxLDE3IEBAIHN0YXRpYyB2b2lkIGluaXRfdW51c2VkX3JpbmdzKHN0cnVjdCBpbnRlbF9ndCAq
Z3QpCj4gIAl9Cj4gIH0KPiAgCj4gLXN0YXRpYyBpbnQgaW5pdF9odyhzdHJ1Y3QgaW50ZWxfZ3Qg
Kmd0KQo+ICtpbnQgaTkxNV9nZW1faW5pdF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndC0+aTkxNTsKPiAt
CXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IGd0LT51bmNvcmU7Cj4gKwlzdHJ1Y3QgaW50
ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwo+ICsJc3RydWN0IGludGVsX2d0ICpn
dCA9ICZpOTE1LT5ndDsKPiAgCWludCByZXQ7Cj4gIAo+ICsJQlVHX09OKCFpOTE1LT5rZXJuZWxf
Y29udGV4dCk7Cj4gKwlyZXQgPSBpOTE1X3Rlcm1pbmFsbHlfd2VkZ2VkKGk5MTUpOwo+ICsJaWYg
KHJldCkKPiArCQlyZXR1cm4gcmV0Owo+ICsKPiAgCWd0LT5sYXN0X2luaXRfdGltZSA9IGt0aW1l
X2dldCgpOwo+ICAKPiAgCS8qIERvdWJsZSBsYXllciBzZWN1cml0eSBibGFua2V0LCBzZWUgaTkx
NV9nZW1faW5pdCgpICovCj4gQEAgLTEyNDgsNTEgKzEyNTIsMTAgQEAgc3RhdGljIGludCBpbml0
X2h3KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCj4gIAo+ICAJaW50ZWxfbW9jc19pbml0X2wzY2NfdGFi
bGUoZ3QpOwo+ICAKPiAtCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KHVuY29yZSwgRk9SQ0VX
QUtFX0FMTCk7Cj4gLQo+IC0JcmV0dXJuIDA7Cj4gLQo+IC1vdXQ6Cj4gLQlpbnRlbF91bmNvcmVf
Zm9yY2V3YWtlX3B1dCh1bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+IC0KPiAtCXJldHVybiByZXQ7
Cj4gLX0KPiAtCj4gLWludCBpOTE1X2dlbV9pbml0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQo+IC17Cj4gLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+dW5j
b3JlOwo+IC0JaW50IHJldDsKPiAtCj4gLQlCVUdfT04oIWk5MTUtPmtlcm5lbF9jb250ZXh0KTsK
PiAtCXJldCA9IGk5MTVfdGVybWluYWxseV93ZWRnZWQoaTkxNSk7Cj4gLQlpZiAocmV0KQo+IC0J
CXJldHVybiByZXQ7Cj4gLQo+IC0JLyogRG91YmxlIGxheWVyIHNlY3VyaXR5IGJsYW5rZXQsIHNl
ZSBpOTE1X2dlbV9pbml0KCkgKi8KPiAtCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KHVuY29y
ZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gLQo+IC0JcmV0ID0gaW5pdF9odygmaTkxNS0+Z3QpOwo+IC0J
aWYgKHJldCkKPiAtCQlnb3RvIGVycl9pbml0Owo+IC0KPiAtCS8qIE9ubHkgd2hlbiB0aGUgSFcg
aXMgcmUtaW5pdGlhbGlzZWQsIGNhbiB3ZSByZXBsYXkgdGhlIHJlcXVlc3RzICovCj4gLQlyZXQg
PSBpbnRlbF9lbmdpbmVzX3Jlc3VtZShpOTE1KTsKPiAtCWlmIChyZXQpCj4gLQkJZ290byBlcnJf
ZW5naW5lczsKPiAtCj4gLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCh1bmNvcmUsIEZPUkNF
V0FLRV9BTEwpOwo+IC0KPiAgCWludGVsX2VuZ2luZXNfc2V0X3NjaGVkdWxlcl9jYXBzKGk5MTUp
Owo+ICAKPiAtCXJldHVybiAwOwo+IC0KPiAtZXJyX2VuZ2luZXM6Cj4gLQlpbnRlbF91Y19maW5p
X2h3KGk5MTUpOwo+IC1lcnJfaW5pdDoKPiArb3V0Ogo+ICAJaW50ZWxfdW5jb3JlX2ZvcmNld2Fr
ZV9wdXQodW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiAtCj4gLQlpbnRlbF9lbmdpbmVzX3NldF9z
Y2hlZHVsZXJfY2FwcyhpOTE1KTsKPiAtCj4gIAlyZXR1cm4gcmV0Owo+ICB9Cj4gIAo+IEBAIC0x
NTI0LDYgKzE0ODcsMTEgQEAgaW50IGk5MTVfZ2VtX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ICAJaWYgKHJldCkKPiAgCQlnb3RvIGVycl91Y19pbml0Owo+ICAKPiAr
CS8qIE9ubHkgd2hlbiB0aGUgSFcgaXMgcmUtaW5pdGlhbGlzZWQsIGNhbiB3ZSByZXBsYXkgdGhl
IHJlcXVlc3RzICovCj4gKwlyZXQgPSBpbnRlbF9ndF9yZXN1bWUoJmRldl9wcml2LT5ndCk7Cj4g
KwlpZiAocmV0KQo+ICsJCWdvdG8gZXJyX2luaXRfaHc7Cj4gKwo+ICAJLyoKPiAgCSAqIERlc3Bp
dGUgaXRzIG5hbWUgaW50ZWxfaW5pdF9jbG9ja19nYXRpbmcgYXBwbGllcyBib3RoIGRpc3BsYXkK
PiAgCSAqIGNsb2NrIGdhdGluZyB3b3JrYXJvdW5kczsgR1QgbW1pbyB3b3JrYXJvdW5kcyBhbmQg
dGhlIG9jY2FzaW9uYWwKPiBAQCAtMTUzNywyMCArMTUwNSwyMCBAQCBpbnQgaTkxNV9nZW1faW5p
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gIAo+ICAJcmV0ID0gaW50ZWxf
ZW5naW5lc192ZXJpZnlfd29ya2Fyb3VuZHMoZGV2X3ByaXYpOwo+ICAJaWYgKHJldCkKPiAtCQln
b3RvIGVycl9pbml0X2h3Owo+ICsJCWdvdG8gZXJyX2d0Owo+ICAKPiAgCXJldCA9IF9faW50ZWxf
ZW5naW5lc19yZWNvcmRfZGVmYXVsdHMoZGV2X3ByaXYpOwo+ICAJaWYgKHJldCkKPiAtCQlnb3Rv
IGVycl9pbml0X2h3Owo+ICsJCWdvdG8gZXJyX2d0Owo+ICAKPiAgCWlmIChpOTE1X2luamVjdF9s
b2FkX2ZhaWx1cmUoKSkgewo+ICAJCXJldCA9IC1FTk9ERVY7Cj4gLQkJZ290byBlcnJfaW5pdF9o
dzsKPiArCQlnb3RvIGVycl9ndDsKPiAgCX0KPiAgCj4gIAlpZiAoaTkxNV9pbmplY3RfbG9hZF9m
YWlsdXJlKCkpIHsKPiAgCQlyZXQgPSAtRUlPOwo+IC0JCWdvdG8gZXJyX2luaXRfaHc7Cj4gKwkJ
Z290byBlcnJfZ3Q7Cj4gIAl9Cj4gIAo+ICAJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRl
dl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+IEBAIC0xNTY0LDcgKzE1MzIsNyBAQCBp
bnQgaTkxNV9nZW1faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gIAkg
KiBIVyBhcyBpcnJldmlzaWJseSB3ZWRnZWQsIGJ1dCBrZWVwIGVub3VnaCBzdGF0ZSBhcm91bmQg
dGhhdCB0aGUKPiAgCSAqIGRyaXZlciBkb2Vzbid0IGV4cGxvZGUgZHVyaW5nIHJ1bnRpbWUuCj4g
IAkgKi8KPiAtZXJyX2luaXRfaHc6Cj4gK2Vycl9ndDoKPiAgCW11dGV4X3VubG9jaygmZGV2X3By
aXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAKPiAgCWk5MTVfZ2VtX3NldF93ZWRnZWQoZGV2X3By
aXYpOwo+IEBAIC0xNTc0LDYgKzE1NDIsNyBAQCBpbnQgaTkxNV9nZW1faW5pdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gIAlpOTE1X2dlbV9kcmFpbl93b3JrcXVldWUoZGV2
X3ByaXYpOwo+ICAKPiAgCW11dGV4X2xvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsK
PiArZXJyX2luaXRfaHc6Cj4gIAlpbnRlbF91Y19maW5pX2h3KGRldl9wcml2KTsKPiAgZXJyX3Vj
X2luaXQ6Cj4gIAlpbnRlbF91Y19maW5pKGRldl9wcml2KTsKPiAtLSAKPiAyLjIwLjEKX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxp
bmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

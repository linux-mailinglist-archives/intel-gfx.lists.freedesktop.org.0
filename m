Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id D33B3BD4C6
	for <lists+intel-gfx@lfdr.de>; Wed, 25 Sep 2019 00:02:08 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2CE2089EAC;
	Tue, 24 Sep 2019 22:02:06 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2C1B089E05;
 Tue, 24 Sep 2019 22:02:03 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18605264-1500050 
 for multiple; Tue, 24 Sep 2019 23:01:43 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 24 Sep 2019 23:01:37 +0100
Message-Id: <20190924220137.20627-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t] i915/perf_pmu: Compare semaphore and busy
 measurements
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: igt-dev@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T3VyIHNlbWFwaG9yZSB0aW1lIGlzIG1lYXN1cmVkIGJ5IHNhbXBsaW5nIGEgcmluZyByZWdpc3Rl
ciwgd2hlcmVhcyBvdXIKYnVzeSB0aW1lIGlzIG1lYXN1cmVkIGV4YWN0bHkuIFRoaXMgbGVhdmVz
IGEgd2luZG93IG9mIGRpc2NyZXBhbmN5IHRoYXQKd2Ugd2lzaCB0byBrZWVwIHNtYWxsIChhdCBs
ZWFzdCB3aXRoaW4gc2FtcGxlIHRvbGVyYW5jZSkuCgpSZWZlcmVuY2VzOiBodHRwczovL2J1Z3Mu
ZnJlZWRlc2t0b3Aub3JnL3Nob3dfYnVnLmNnaT9pZD0xMTE3ODgKU2lnbmVkLW9mZi1ieTogQ2hy
aXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+CkNjOiBUdnJ0a28gVXJzdWxpbiA8
dHZydGtvLnVyc3VsaW5AaW50ZWwuY29tPgotLS0KIHRlc3RzL3BlcmZfcG11LmMgfCA3MyArKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0KIDEgZmlsZSBjaGFu
Z2VkLCA3MiBpbnNlcnRpb25zKCspLCAxIGRlbGV0aW9uKC0pCgpkaWZmIC0tZ2l0IGEvdGVzdHMv
cGVyZl9wbXUuYyBiL3Rlc3RzL3BlcmZfcG11LmMKaW5kZXggOGEwNmU1ZDQ0Li4yZmNhZjg4ZGUg
MTAwNjQ0Ci0tLSBhL3Rlc3RzL3BlcmZfcG11LmMKKysrIGIvdGVzdHMvcGVyZl9wbXUuYwpAQCAt
MTMwLDcgKzEzMCw3IEBAIHN0YXRpYyB1aW50NjRfdCBwbXVfcmVhZF9tdWx0aShpbnQgZmQsIHVu
c2lnbmVkIGludCBudW0sIHVpbnQ2NF90ICp2YWwpCiAjZGVmaW5lIF9fYXNzZXJ0X3dpdGhpbl9l
cHNpbG9uKHgsIHJlZiwgdG9sX3VwLCB0b2xfZG93bikgXAogCWlndF9hc3NlcnRfZigoZG91Ymxl
KSh4KSA8PSAoMS4wICsgKHRvbF91cCkpICogKGRvdWJsZSkocmVmKSAmJiBcCiAJCSAgICAgKGRv
dWJsZSkoeCkgPj0gKDEuMCAtICh0b2xfZG93bikpICogKGRvdWJsZSkocmVmKSwgXAotCQkgICAg
ICInJXMnICE9ICclcycgKCVmIG5vdCB3aXRoaW4gKyVmJSUvLSVmJSUgdG9sZXJhbmNlIG9mICVm
KVxuIixcCisJCSAgICAgIiclcycgIT0gJyVzJyAoJWYgbm90IHdpdGhpbiArJS4xZiUlLy0lLjFm
JSUgdG9sZXJhbmNlIG9mICVmKVxuIixcCiAJCSAgICAgI3gsICNyZWYsIChkb3VibGUpKHgpLCBc
CiAJCSAgICAgKHRvbF91cCkgKiAxMDAuMCwgKHRvbF9kb3duKSAqIDEwMC4wLCBcCiAJCSAgICAg
KGRvdWJsZSkocmVmKSkKQEAgLTc0NCw2ICs3NDQsNzQgQEAgc2VtYV93YWl0KGludCBnZW1fZmQs
IGNvbnN0IHN0cnVjdCBpbnRlbF9leGVjdXRpb25fZW5naW5lMiAqZSwKIAlhc3NlcnRfd2l0aGlu
X2Vwc2lsb24odmFsWzFdIC0gdmFsWzBdLCBzbGVwdCwgdG9sZXJhbmNlKTsKIH0KIAorc3RhdGlj
IHZvaWQKK19fc2VtYV9idXN5KGludCBnZW1fZmQsIGludCBwbXUsCisJICAgIGNvbnN0IHN0cnVj
dCBpbnRlbF9leGVjdXRpb25fZW5naW5lMiAqZSwKKwkgICAgY29uc3Qgc3RydWN0IGludGVsX2V4
ZWN1dGlvbl9lbmdpbmUyICpzaWduYWwsCisJICAgIGludCBzZW1hX3BjdCwKKwkgICAgaW50IGJ1
c3lfcGN0KQoreworCXVpbnQ2NF90IHRvdGFsLCBzZW1hLCBidXN5OworCXVpbnQ2NF90IHN0YXJ0
WzJdLCBlbmRbMl07CisJaWd0X3NwaW5fdCAqc3BpblsyXTsKKworCXNwaW5bMF0gPSBpZ3Rfc3Bp
bl9uZXcoZ2VtX2ZkLAorCQkJICAgICAgIC5lbmdpbmUgPSBzaWduYWwtPmZsYWdzLAorCQkJICAg
ICAgIC5mbGFncyA9IElHVF9TUElOX0ZFTkNFX09VVCk7CisJc3BpblsxXSA9IGlndF9zcGluX25l
dyhnZW1fZmQsCisJCQkgICAgICAgLmVuZ2luZSA9IGUtPmZsYWdzLAorCQkJICAgICAgIC5mZW5j
ZSA9IHNwaW5bMF0tPm91dF9mZW5jZSwKKwkJCSAgICAgICAuZmxhZ3MgPSBJR1RfU1BJTl9GRU5D
RV9JTik7CisKKwl0b3RhbCA9IHBtdV9yZWFkX211bHRpKHBtdSwgMiwgc3RhcnQpOworCisJc2Vt
YSA9IG1lYXN1cmVkX3VzbGVlcChiYXRjaF9kdXJhdGlvbl9ucyAqIHNlbWFfcGN0IC8gMTAwIC8g
MTAwMCk7CisJaWd0X3NwaW5fZW5kKHNwaW5bMF0pOworCWJ1c3kgPSBtZWFzdXJlZF91c2xlZXAo
YmF0Y2hfZHVyYXRpb25fbnMgKiAoYnVzeV9wY3QgLSBzZW1hX3BjdCkgLyAxMDAgLyAxMDAwKTsK
KwlpZ3Rfc3Bpbl9lbmQoc3BpblsxXSk7CisJbWVhc3VyZWRfdXNsZWVwKGJhdGNoX2R1cmF0aW9u
X25zICogKDEwMCAtIGJ1c3lfcGN0KSAvIDEwMCAvIDEwMDApOworCisJdG90YWwgPSBwbXVfcmVh
ZF9tdWx0aShwbXUsIDIsIGVuZCkgLSB0b3RhbDsKKworCWlndF9pbmZvKCIlczwtJXMsIHRhcmdl
dDogeyUuMWYlJSBbJWRdLCAlLjFmJSUgWyVkXX0sIG1lYXN1cmVkIHslLjFmJSUsICUuMWYlJX1c
biIsCisJCSBlLT5uYW1lLCBzaWduYWwtPm5hbWUsCisJCSBzZW1hICogMTAwLiAvIHRvdGFsLCBz
ZW1hX3BjdCwKKwkJIChzZW1hICsgYnVzeSkgKiAxMDAuIC8gdG90YWwsIGJ1c3lfcGN0LAorCQkg
KGVuZFswXSAtIHN0YXJ0WzBdKSAqIDEwMC4gLyB0b3RhbCwKKwkJIChlbmRbMV0gLSBzdGFydFsx
XSkgKiAxMDAuIC8gdG90YWwpOworCisJYXNzZXJ0X3dpdGhpbl9lcHNpbG9uKGVuZFswXSAtIHN0
YXJ0WzBdLCBzZW1hLCB0b2xlcmFuY2UpOworCWFzc2VydF93aXRoaW5fZXBzaWxvbihlbmRbMV0g
LSBzdGFydFsxXSwgc2VtYSArIGJ1c3ksIHRvbGVyYW5jZSk7CisJaWd0X2Fzc2VydCgoZW5kWzBd
IC0gc3RhcnRbMF0pIDwgKGVuZFsxXSAtIHN0YXJ0WzFdKSAqICgxICsgdG9sZXJhbmNlKSk7CisK
KwlpZ3Rfc3Bpbl9mcmVlKGdlbV9mZCwgc3BpblsxXSk7CisJaWd0X3NwaW5fZnJlZShnZW1fZmQs
IHNwaW5bMF0pOworfQorCitzdGF0aWMgdm9pZAorc2VtYV9idXN5KGludCBnZW1fZmQsCisJICBj
b25zdCBzdHJ1Y3QgaW50ZWxfZXhlY3V0aW9uX2VuZ2luZTIgKmUsCisJICB1bnNpZ25lZCBpbnQg
ZmxhZ3MpCit7CisJY29uc3Qgc3RydWN0IGludGVsX2V4ZWN1dGlvbl9lbmdpbmUyICpzaWduYWw7
CisJaW50IGZkOworCisJZmQgPSBvcGVuX2dyb3VwKEk5MTVfUE1VX0VOR0lORV9TRU1BKGUtPmNs
YXNzLCBlLT5pbnN0YW5jZSksIC0xKTsKKwlvcGVuX2dyb3VwKEk5MTVfUE1VX0VOR0lORV9CVVNZ
KGUtPmNsYXNzLCBlLT5pbnN0YW5jZSksIGZkKTsKKworCV9fZm9yX2VhY2hfcGh5c2ljYWxfZW5n
aW5lKGdlbV9mZCwgc2lnbmFsKSB7CisJCWlmIChlLT5jbGFzcyA9PSBzaWduYWwtPmNsYXNzICYm
CisJCSAgICBlLT5pbnN0YW5jZSA9PSBzaWduYWwtPmluc3RhbmNlKQorCQkJY29udGludWU7CisK
KwkJX19zZW1hX2J1c3koZ2VtX2ZkLCBmZCwgZSwgc2lnbmFsLCA1MCwgMTAwKTsKKwkJX19zZW1h
X2J1c3koZ2VtX2ZkLCBmZCwgZSwgc2lnbmFsLCAyNSwgNTApOworCQlfX3NlbWFfYnVzeShnZW1f
ZmQsIGZkLCBlLCBzaWduYWwsIDc1LCA3NSk7CisJfQorCisJY2xvc2UoZmQpOworfQorCiAjZGVm
aW5lICAgTUlfV0FJVF9GT1JfUElQRV9DX1ZCTEFOSyAoMTw8MjEpCiAjZGVmaW5lICAgTUlfV0FJ
VF9GT1JfUElQRV9CX1ZCTEFOSyAoMTw8MTEpCiAjZGVmaW5lICAgTUlfV0FJVF9GT1JfUElQRV9B
X1ZCTEFOSyAoMTw8MykKQEAgLTE3NzQsNiArMTg0Miw5IEBAIGlndF9tYWluCiAJCQlzZW1hX3dh
aXQoZmQsIGUsCiAJCQkJICBURVNUX0JVU1kgfCBURVNUX1RSQUlMSU5HX0lETEUpOwogCisJCWln
dF9zdWJ0ZXN0X2YoInNlbWFwaG9yZS1idXN5LSVzIiwgZS0+bmFtZSkKKwkJCXNlbWFfYnVzeShm
ZCwgZSwgMCk7CisKIAkJLyoqCiAJCSAqIENoZWNrIHRoYXQgdHdvIHBlcmYgY2xpZW50cyBkbyBu
b3QgaW5mbHVlbmNlIGVhY2gKIAkJICogb3RoZXJzIG9ic2VydmF0aW9ucy4KLS0gCjIuMjMuMAoK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4
IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlz
dHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

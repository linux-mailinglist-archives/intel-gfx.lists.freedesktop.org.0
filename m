Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id B34747F4CB
	for <lists+intel-gfx@lfdr.de>; Fri,  2 Aug 2019 12:11:41 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id EB1476EDAB;
	Fri,  2 Aug 2019 10:11:39 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga09.intel.com (mga09.intel.com [134.134.136.24])
 by gabe.freedesktop.org (Postfix) with ESMTPS id F058E6EDAA
 for <intel-gfx@lists.freedesktop.org>; Fri,  2 Aug 2019 10:11:37 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga002.jf.intel.com ([10.7.209.21])
 by orsmga102.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 02 Aug 2019 03:11:37 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,337,1559545200"; d="scan'208";a="184540994"
Received: from gadevlin-mobl.ger.corp.intel.com (HELO [10.251.95.57])
 ([10.251.95.57])
 by orsmga002.jf.intel.com with ESMTP; 02 Aug 2019 03:11:35 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <459d6860-f0e2-16ed-62ea-c860baac1970@linux.intel.com>
 <20190802100015.1281-1-chris@chris-wilson.co.uk>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <afef45ed-5547-6995-0ec3-862f5a406373@linux.intel.com>
Date: Fri, 2 Aug 2019 11:11:34 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <20190802100015.1281-1-chris@chris-wilson.co.uk>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH v3] drm/i915: Allow sharing the idle-barrier
 from other kernel requests
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDAyLzA4LzIwMTkgMTE6MDAsIENocmlzIFdpbHNvbiB3cm90ZToKPiBCeSBwbGFjaW5nIG91
ciBpZGxlLWJhcnJpZXJzIGluIHRoZSBpOTE1X2FjdGl2ZSBmZW5jZSB0cmVlLCB3ZSBleHBvc2UK
PiB0aG9zZSBmb3IgcmV1c2UgYnkgb3RoZXIgY29tcG9uZW50cyB0aGF0IGFyZSBpc3N1aW5nIHJl
cXVlc3RzIGFsb25nIHRoZQo+IGtlcm5lbF9jb250ZXh0LiBSZXVzaW5nIHRoZSBwcm90by1iYXJy
aWVyIGFjdGl2ZV9ub2RlIGlzIHBlcmZlY3RseSBmaW5lCj4gYXMgdGhlIG5ldyByZXF1ZXN0IGlt
cGxpZXMgYSBjb250ZXh0LXN3aXRjaCwgYW5kIHNvIGFuIG9wcG9ydHVuZSBwb2ludAo+IHRvIHJ1
biB0aGUgaWRsZS1iYXJyaWVyLiBIb3dldmVyLCB0aGUgcHJvdG8tYmFycmllciBpcyBub3QgZXF1
aXZhbGVudAo+IHRvIGEgbm9ybWFsIGFjdGl2ZV9ub2RlIGFuZCBjYXJlIG11c3QgYmUgdGFrZW4g
dG8gYXZvaWQgZGVyZWZlcmVuY2luZyB0aGUKPiBFUlJfUFRSIHVzZWQgYXMgaXRzIHJlcXVlc3Qg
bWFya2VyLgo+IAo+IHYyOiBDb21tZW50IHRoZSBtb3JlIGVncmVnaW91cyBjaGVlawo+IHYzOiBB
IGdsb3NzYXJ5IQo+IAo+IFJlcG9ydGVkLWJ5OiBMaW9uZWwgTGFuZHdlcmxpbiA8bGlvbmVsLmcu
bGFuZHdlcmxpbkBpbnRlbC5jb20+Cj4gRml4ZXM6IGNlNDc2YzgwYjhiZiAoImRybS9pOTE1OiBL
ZWVwIGNvbnRleHRzIHBpbm5lZCB1bnRpbCBhZnRlciB0aGUgbmV4dCBrZXJuZWwgY29udGV4dCBz
d2l0Y2giKQo+IEZpeGVzOiBhOTg3N2RhMmQ2MjkgKCJkcm0vaTkxNS9vYTogUmVjb25maWd1cmUg
Y29udGV4dHMgb24gdGhlIGZseSIpCj4gU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJp
c0BjaHJpcy13aWxzb24uY28udWs+Cj4gQ2M6IExpb25lbCBMYW5kd2VybGluIDxsaW9uZWwuZy5s
YW5kd2VybGluQGludGVsLmNvbT4KPiBDYzogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGlu
QGludGVsLmNvbT4KPiAtLS0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRl
eHQuYyAgICAgICB8ICA0MCArKy0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2Nv
bnRleHQuaCAgICAgICB8ICAxMyArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
ZW5naW5lX3BtLmMgICAgIHwgICAyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxm
dGVzdF9jb250ZXh0LmMgICAgfCAzMTAgKysrKysrKysrKysrKysrKysrCj4gICBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5jICAgICAgICAgICAgfCAyODggKysrKysrKysrKysrKy0t
LQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuaCAgICAgICAgICAgIHwgICAy
ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZV90eXBlcy5oICAgICAgfCAg
IDIgKy0KPiAgIC4uLi9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9saXZlX3NlbGZ0ZXN0cy5oICB8
ICAgMyArLQo+ICAgOCBmaWxlcyBjaGFuZ2VkLCA1OTcgaW5zZXJ0aW9ucygrKSwgNjMgZGVsZXRp
b25zKC0pCj4gICBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2Vs
ZnRlc3RfY29udGV4dC5jCj4gCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQu
Ywo+IGluZGV4IGYzMDQ0MWExNDBmOC4uMzRjOGUzN2E3M2I4IDEwMDY0NAo+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYwo+IEBAIC0xNjIsMjMgKzE2Miw0MSBAQCBzdGF0aWMg
aW50IF9faW50ZWxfY29udGV4dF9hY3RpdmUoc3RydWN0IGk5MTVfYWN0aXZlICphY3RpdmUpCj4g
ICAJaWYgKGVycikKPiAgIAkJZ290byBlcnJfcmluZzsKPiAgIAo+ICsJcmV0dXJuIDA7Cj4gKwo+
ICtlcnJfcmluZzoKPiArCWludGVsX3JpbmdfdW5waW4oY2UtPnJpbmcpOwo+ICtlcnJfcHV0Ogo+
ICsJaW50ZWxfY29udGV4dF9wdXQoY2UpOwo+ICsJcmV0dXJuIGVycjsKPiArfQo+ICsKPiAraW50
IGludGVsX2NvbnRleHRfYWN0aXZlX2FjcXVpcmUoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQo+
ICt7Cj4gKwlpbnQgZXJyOwo+ICsKPiArCWVyciA9IGk5MTVfYWN0aXZlX2FjcXVpcmUoJmNlLT5h
Y3RpdmUpOwo+ICsJaWYgKGVycikKPiArCQlyZXR1cm4gZXJyOwo+ICsKPiAgIAkvKiBQcmVhbGxv
Y2F0ZSB0cmFja2luZyBub2RlcyAqLwo+ICAgCWlmICghaTkxNV9nZW1fY29udGV4dF9pc19rZXJu
ZWwoY2UtPmdlbV9jb250ZXh0KSkgewo+ICAgCQllcnIgPSBpOTE1X2FjdGl2ZV9hY3F1aXJlX3By
ZWFsbG9jYXRlX2JhcnJpZXIoJmNlLT5hY3RpdmUsCj4gICAJCQkJCQkJICAgICAgY2UtPmVuZ2lu
ZSk7Cj4gLQkJaWYgKGVycikKPiAtCQkJZ290byBlcnJfc3RhdGU7Cj4gKwkJaWYgKGVycikgewo+
ICsJCQlpOTE1X2FjdGl2ZV9yZWxlYXNlKCZjZS0+YWN0aXZlKTsKPiArCQkJcmV0dXJuIGVycjsK
PiArCQl9Cj4gICAJfQo+ICAgCj4gICAJcmV0dXJuIDA7Cj4gK30KPiAgIAo+IC1lcnJfc3RhdGU6
Cj4gLQlfX2NvbnRleHRfdW5waW5fc3RhdGUoY2UtPnN0YXRlKTsKPiAtZXJyX3Jpbmc6Cj4gLQlp
bnRlbF9yaW5nX3VucGluKGNlLT5yaW5nKTsKPiAtZXJyX3B1dDoKPiAtCWludGVsX2NvbnRleHRf
cHV0KGNlKTsKPiAtCXJldHVybiBlcnI7Cj4gK3ZvaWQgaW50ZWxfY29udGV4dF9hY3RpdmVfcmVs
ZWFzZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCj4gK3sKPiArCS8qIE5vZGVzIHByZWFsbG9j
YXRlZCBpbiBpbnRlbF9jb250ZXh0X2FjdGl2ZSgpICovCj4gKwlpOTE1X2FjdGl2ZV9hY3F1aXJl
X2JhcnJpZXIoJmNlLT5hY3RpdmUpOwo+ICsJaTkxNV9hY3RpdmVfcmVsZWFzZSgmY2UtPmFjdGl2
ZSk7Cj4gICB9Cj4gICAKPiAgIHZvaWQKPiBAQCAtMzAxLDMgKzMxOSw3IEBAIHN0cnVjdCBpOTE1
X3JlcXVlc3QgKmludGVsX2NvbnRleHRfY3JlYXRlX3JlcXVlc3Qoc3RydWN0IGludGVsX2NvbnRl
eHQgKmNlKQo+ICAgCj4gICAJcmV0dXJuIHJxOwo+ICAgfQo+ICsKPiArI2lmIElTX0VOQUJMRUQo
Q09ORklHX0RSTV9JOTE1X1NFTEZURVNUKQo+ICsjaW5jbHVkZSAic2VsZnRlc3RfY29udGV4dC5j
Igo+ICsjZW5kaWYKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
Y29udGV4dC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5oCj4gaW5k
ZXggMjNjN2U0YzBjZTdjLi4wN2Y5OTI0ZGU0OGYgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfY29udGV4dC5oCj4gQEAgLTEwNCwxNyArMTA0LDggQEAgc3RhdGljIGlubGluZSB2
b2lkIGludGVsX2NvbnRleHRfZXhpdChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCj4gICAJCWNl
LT5vcHMtPmV4aXQoY2UpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBpbmxpbmUgaW50IGludGVsX2Nv
bnRleHRfYWN0aXZlX2FjcXVpcmUoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQo+IC17Cj4gLQly
ZXR1cm4gaTkxNV9hY3RpdmVfYWNxdWlyZSgmY2UtPmFjdGl2ZSk7Cj4gLX0KPiAtCj4gLXN0YXRp
YyBpbmxpbmUgdm9pZCBpbnRlbF9jb250ZXh0X2FjdGl2ZV9yZWxlYXNlKHN0cnVjdCBpbnRlbF9j
b250ZXh0ICpjZSkKPiAtewo+IC0JLyogTm9kZXMgcHJlYWxsb2NhdGVkIGluIGludGVsX2NvbnRl
eHRfYWN0aXZlKCkgKi8KPiAtCWk5MTVfYWN0aXZlX2FjcXVpcmVfYmFycmllcigmY2UtPmFjdGl2
ZSk7Cj4gLQlpOTE1X2FjdGl2ZV9yZWxlYXNlKCZjZS0+YWN0aXZlKTsKPiAtfQo+ICtpbnQgaW50
ZWxfY29udGV4dF9hY3RpdmVfYWNxdWlyZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpOwo+ICt2
b2lkIGludGVsX2NvbnRleHRfYWN0aXZlX3JlbGVhc2Uoc3RydWN0IGludGVsX2NvbnRleHQgKmNl
KTsKPiAgIAo+ICAgc3RhdGljIGlubGluZSBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqaW50ZWxfY29u
dGV4dF9nZXQoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQo+ICAgewo+IGRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5jCj4gaW5kZXggZTc0ZmJmMDRhNjhkLi5jZTU0MDky
NDc1ZGEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5l
X3BtLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uYwo+
IEBAIC05MCw3ICs5MCw3IEBAIHN0YXRpYyBib29sIHN3aXRjaF90b19rZXJuZWxfY29udGV4dChz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gICAJLyogQ2hlY2sgYWdhaW4gb24gdGhl
IG5leHQgcmV0aXJlbWVudC4gKi8KPiAgIAllbmdpbmUtPndha2VyZWZfc2VyaWFsID0gZW5naW5l
LT5zZXJpYWwgKyAxOwo+ICAgCj4gLQlpOTE1X3JlcXVlc3RfYWRkX2JhcnJpZXJzKHJxKTsKPiAr
CWk5MTVfcmVxdWVzdF9hZGRfYWN0aXZlX2JhcnJpZXJzKHJxKTsKPiAgIAlfX2k5MTVfcmVxdWVz
dF9jb21taXQocnEpOwo+ICAgCj4gICAJcmV0dXJuIGZhbHNlOwo+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9zZWxmdGVzdF9jb250ZXh0LmMKPiBuZXcgZmlsZSBtb2RlIDEwMDY0NAo+IGluZGV4
IDAwMDAwMDAwMDAwMC4uZDM5YjU1OTRjYjAyCj4gLS0tIC9kZXYvbnVsbAo+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2NvbnRleHQuYwo+IEBAIC0wLDAgKzEsMzEwIEBA
Cj4gKy8qCj4gKyAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCj4gKyAqCj4gKyAq
IENvcHlyaWdodCDCqSAyMDE5IEludGVsIENvcnBvcmF0aW9uCj4gKyAqLwo+ICsKPiArI2luY2x1
ZGUgImk5MTVfc2VsZnRlc3QuaCIKPiArI2luY2x1ZGUgImludGVsX2d0LmgiCj4gKwo+ICsjaW5j
bHVkZSAiZ2VtL3NlbGZ0ZXN0cy9tb2NrX2NvbnRleHQuaCIKPiArI2luY2x1ZGUgInNlbGZ0ZXN0
cy9pZ3RfZmx1c2hfdGVzdC5oIgo+ICsjaW5jbHVkZSAic2VsZnRlc3RzL21vY2tfZHJtLmgiCj4g
Kwo+ICtzdGF0aWMgaW50IHJlcXVlc3Rfc3luYyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKPiAr
ewo+ICsJbG9uZyB0aW1lb3V0Owo+ICsJaW50IGVyciA9IDA7Cj4gKwo+ICsJaTkxNV9yZXF1ZXN0
X2dldChycSk7Cj4gKwo+ICsJaTkxNV9yZXF1ZXN0X2FkZChycSk7Cj4gKwl0aW1lb3V0ID0gaTkx
NV9yZXF1ZXN0X3dhaXQocnEsIDAsIEhaIC8gMTApOwo+ICsJaWYgKHRpbWVvdXQgPCAwKQo+ICsJ
CWVyciA9IHRpbWVvdXQ7Cj4gKwllbHNlCj4gKwkJaTkxNV9yZXF1ZXN0X3JldGlyZV91cHRvKHJx
KTsKPiArCj4gKwlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKPiArCj4gKwlyZXR1cm4gZXJyOwo+ICt9
Cj4gKwo+ICtzdGF0aWMgaW50IGNvbnRleHRfc3luYyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2Up
Cj4gK3sKPiArCXN0cnVjdCBpbnRlbF90aW1lbGluZSAqdGwgPSBjZS0+cmluZy0+dGltZWxpbmU7
Cj4gKwlpbnQgZXJyID0gMDsKPiArCj4gKwlkbyB7Cj4gKwkJc3RydWN0IGk5MTVfcmVxdWVzdCAq
cnE7Cj4gKwkJbG9uZyB0aW1lb3V0Owo+ICsKPiArCQlyY3VfcmVhZF9sb2NrKCk7Cj4gKwkJcnEg
PSByY3VfZGVyZWZlcmVuY2UodGwtPmxhc3RfcmVxdWVzdC5yZXF1ZXN0KTsKPiArCQlpZiAocnEp
Cj4gKwkJCXJxID0gaTkxNV9yZXF1ZXN0X2dldF9yY3UocnEpOwo+ICsJCXJjdV9yZWFkX3VubG9j
aygpOwo+ICsJCWlmICghcnEpCj4gKwkJCWJyZWFrOwo+ICsKPiArCQl0aW1lb3V0ID0gaTkxNV9y
ZXF1ZXN0X3dhaXQocnEsIDAsIEhaIC8gMTApOwo+ICsJCWlmICh0aW1lb3V0IDwgMCkKPiArCQkJ
ZXJyID0gdGltZW91dDsKPiArCQllbHNlCj4gKwkJCWk5MTVfcmVxdWVzdF9yZXRpcmVfdXB0byhy
cSk7Cj4gKwo+ICsJCWk5MTVfcmVxdWVzdF9wdXQocnEpOwo+ICsJfSB3aGlsZSAoIWVycik7Cj4g
Kwo+ICsJcmV0dXJuIGVycjsKPiArfQo+ICsKPiArc3RhdGljIGludCBfX2xpdmVfYWN0aXZlX2Nv
bnRleHQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAo+ICsJCQkJIHN0cnVjdCBpOTE1
X2dlbV9jb250ZXh0ICpmaXhtZSkKPiArewo+ICsJc3RydWN0IGludGVsX2NvbnRleHQgKmNlOwo+
ICsJaW50IHBhc3M7Cj4gKwlpbnQgZXJyOwo+ICsKPiArCS8qCj4gKwkgKiBXZSBrZWVwIGFjdGl2
ZSBjb250ZXh0cyBhbGl2ZSB1bnRpbCBhZnRlciBhIHN1YnNlcXVlbnQgY29udGV4dAo+ICsJICog
c3dpdGNoIGFzIHRoZSBmaW5hbCB3cml0ZSBmcm9tIHRoZSBjb250ZXh0LXNhdmUgd2lsbCBiZSBh
ZnRlcgo+ICsJICogd2UgcmV0aXJlIHRoZSBmaW5hbCByZXF1ZXN0LiBXZSB0cmFjayB3aGVuIHdl
IHVucGluIHRoZSBjb250ZXh0LAo+ICsJICogdW5kZXIgdGhlIHByZXN1bXB0aW9uIHRoYXQgdGhl
IGZpbmFsIHBpbiBpcyBmcm9tIHRoZSBsYXN0IHJlcXVlc3QsCj4gKwkgKiBhbmQgaW5zdGVhZCBv
ZiBpbW1lZGlhdGVseSB1bnBpbm5pbmcgdGhlIGNvbnRleHQsIHdlIGFkZCBhIHRhc2sKPiArCSAq
IHRvIHVucGluIHRoZSBjb250ZXh0IGZyb20gdGhlIG5leHQgaWRsZS1iYXJyaWVyLgo+ICsJICoK
PiArCSAqIFRoaXMgdGVzdCBtYWtlcyBzdXJlIHRoYXQgdGhlIGNvbnRleHQgaXMga2VwdCBhbGl2
ZSB1bnRpbCBhCj4gKwkgKiBzdWJzZXF1ZW50IGlkbGUtYmFycmllciAoZW1pdHRlZCB3aGVuIHRo
ZSBlbmdpbmUgd2FrZXJlZiBoaXRzIDAKPiArCSAqIHdpdGggbm8gbW9yZSBvdXRzdGFuZGluZyBy
ZXF1ZXN0cykuCj4gKwkgKi8KPiArCj4gKwlpZiAoaW50ZWxfZW5naW5lX3BtX2lzX2F3YWtlKGVu
Z2luZSkpIHsKPiArCQlwcl9lcnIoIiVzIGlzIGF3YWtlIGJlZm9yZSBzdGFydGluZyAlcyFcbiIs
Cj4gKwkJICAgICAgIGVuZ2luZS0+bmFtZSwgX19mdW5jX18pOwo+ICsJCXJldHVybiAtRUlOVkFM
Owo+ICsJfQo+ICsKPiArCWNlID0gaW50ZWxfY29udGV4dF9jcmVhdGUoZml4bWUsIGVuZ2luZSk7
Cj4gKwlpZiAoIWNlKQo+ICsJCXJldHVybiAtRU5PTUVNOwo+ICsKPiArCWZvciAocGFzcyA9IDA7
IHBhc3MgPD0gMjsgcGFzcysrKSB7Cj4gKwkJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7Cj4gKwo+
ICsJCXJxID0gaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVzdChjZSk7Cj4gKwkJaWYgKElTX0VS
UihycSkpIHsKPiArCQkJZXJyID0gUFRSX0VSUihycSk7Cj4gKwkJCWdvdG8gZXJyOwo+ICsJCX0K
PiArCj4gKwkJZXJyID0gcmVxdWVzdF9zeW5jKHJxKTsKPiArCQlpZiAoZXJyKQo+ICsJCQlnb3Rv
IGVycjsKPiArCj4gKwkJLyogQ29udGV4dCB3aWxsIGJlIGtlcHQgYWN0aXZlIHVudGlsIGFmdGVy
IGFuIGlkbGUtYmFycmllci4gKi8KPiArCQlpZiAoaTkxNV9hY3RpdmVfaXNfaWRsZSgmY2UtPmFj
dGl2ZSkpIHsKPiArCQkJcHJfZXJyKCJjb250ZXh0IGlzIG5vdCBhY3RpdmU7IGV4cGVjdGVkIGlk
bGUtYmFycmllciAoJXMgcGFzcyAlZClcbiIsCj4gKwkJCSAgICAgICBlbmdpbmUtPm5hbWUsIHBh
c3MpOwo+ICsJCQllcnIgPSAtRUlOVkFMOwo+ICsJCQlnb3RvIGVycjsKPiArCQl9Cj4gKwo+ICsJ
CWlmICghaW50ZWxfZW5naW5lX3BtX2lzX2F3YWtlKGVuZ2luZSkpIHsKPiArCQkJcHJfZXJyKCIl
cyBpcyBhc2xlZXAgYmVmb3JlIGlkbGUtYmFycmllclxuIiwKPiArCQkJICAgICAgIGVuZ2luZS0+
bmFtZSk7Cj4gKwkJCWVyciA9IC1FSU5WQUw7Cj4gKwkJCWdvdG8gZXJyOwo+ICsJCX0KPiArCX0K
PiArCj4gKwkvKiBOb3cgbWFrZSBzdXJlIG91ciBpZGxlLWJhcnJpZXJzIGFyZSBmbHVzaGVkICov
Cj4gKwllcnIgPSBjb250ZXh0X3N5bmMoZW5naW5lLT5rZXJuZWxfY29udGV4dCk7Cj4gKwlpZiAo
ZXJyKQo+ICsJCWdvdG8gZXJyOwo+ICsKPiArCWlmICghaTkxNV9hY3RpdmVfaXNfaWRsZSgmY2Ut
PmFjdGl2ZSkpIHsKPiArCQlwcl9lcnIoImNvbnRleHQgaXMgc3RpbGwgYWN0aXZlISIpOwo+ICsJ
CWVyciA9IC1FSU5WQUw7Cj4gKwl9Cj4gKwo+ICsJaWYgKGludGVsX2VuZ2luZV9wbV9pc19hd2Fr
ZShlbmdpbmUpKSB7Cj4gKwkJc3RydWN0IGRybV9wcmludGVyIHAgPSBkcm1fZGVidWdfcHJpbnRl
cihfX2Z1bmNfXyk7Cj4gKwo+ICsJCWludGVsX2VuZ2luZV9kdW1wKGVuZ2luZSwgJnAsCj4gKwkJ
CQkgICIlcyBpcyBzdGlsbCBhd2FrZSBhZnRlciBpZGxlLWJhcnJpZXJzXG4iLAo+ICsJCQkJICBl
bmdpbmUtPm5hbWUpOwo+ICsJCUdFTV9UUkFDRV9EVU1QKCk7Cj4gKwo+ICsJCWVyciA9IC1FSU5W
QUw7Cj4gKwkJZ290byBlcnI7Cj4gKwl9Cj4gKwo+ICtlcnI6Cj4gKwlpbnRlbF9jb250ZXh0X3B1
dChjZSk7Cj4gKwlyZXR1cm4gZXJyOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGxpdmVfYWN0aXZl
X2NvbnRleHQodm9pZCAqYXJnKQo+ICt7Cj4gKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOwo+
ICsJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwo+ICsJc3RydWN0IGk5MTVfZ2VtX2Nv
bnRleHQgKmZpeG1lOwo+ICsJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Cj4gKwlzdHJ1Y3QgZHJt
X2ZpbGUgKmZpbGU7Cj4gKwlpbnQgZXJyID0gMDsKPiArCj4gKwlmaWxlID0gbW9ja19maWxlKGd0
LT5pOTE1KTsKPiArCWlmIChJU19FUlIoZmlsZSkpCj4gKwkJcmV0dXJuIFBUUl9FUlIoZmlsZSk7
Cj4gKwo+ICsJbXV0ZXhfbG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsKPiAr
CWZpeG1lID0gbGl2ZV9jb250ZXh0KGd0LT5pOTE1LCBmaWxlKTsKPiArCWlmICghZml4bWUpIHsK
PiArCQllcnIgPSAtRU5PTUVNOwo+ICsJCWdvdG8gdW5sb2NrOwo+ICsJfQo+ICsKPiArCWZvcl9l
YWNoX2VuZ2luZShlbmdpbmUsIGd0LT5pOTE1LCBpZCkgewo+ICsJCWVyciA9IF9fbGl2ZV9hY3Rp
dmVfY29udGV4dChlbmdpbmUsIGZpeG1lKTsKPiArCQlpZiAoZXJyKQo+ICsJCQlicmVhazsKPiAr
Cj4gKwkJZXJyID0gaWd0X2ZsdXNoX3Rlc3QoZ3QtPmk5MTUsIEk5MTVfV0FJVF9MT0NLRUQpOwo+
ICsJCWlmIChlcnIpCj4gKwkJCWJyZWFrOwo+ICsJfQo+ICsKPiArdW5sb2NrOgo+ICsJbXV0ZXhf
dW5sb2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gKwltb2NrX2ZpbGVfZnJlZShn
dC0+aTkxNSwgZmlsZSk7Cj4gKwlyZXR1cm4gZXJyOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IF9f
cmVtb3RlX3N5bmMoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCBzdHJ1Y3QgaW50ZWxfY29udGV4
dCAqcmVtb3RlKQo+ICt7Cj4gKwlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKPiArCWludCBlcnI7
Cj4gKwo+ICsJZXJyID0gaW50ZWxfY29udGV4dF9waW4ocmVtb3RlKTsKPiArCWlmIChlcnIpCj4g
KwkJcmV0dXJuIGVycjsKPiArCj4gKwlycSA9IGludGVsX2NvbnRleHRfY3JlYXRlX3JlcXVlc3Qo
Y2UpOwo+ICsJaWYgKElTX0VSUihycSkpIHsKPiArCQllcnIgPSBQVFJfRVJSKHJxKTsKPiArCQln
b3RvIHVucGluOwo+ICsJfQo+ICsKPiArCWVyciA9IGludGVsX2NvbnRleHRfcHJlcGFyZV9yZW1v
dGVfcmVxdWVzdChyZW1vdGUsIHJxKTsKPiArCWlmIChlcnIpIHsKPiArCQlpOTE1X3JlcXVlc3Rf
YWRkKHJxKTsKPiArCQlnb3RvIHVucGluOwo+ICsJfQo+ICsKPiArCWVyciA9IHJlcXVlc3Rfc3lu
YyhycSk7Cj4gKwo+ICt1bnBpbjoKPiArCWludGVsX2NvbnRleHRfdW5waW4ocmVtb3RlKTsKPiAr
CXJldHVybiBlcnI7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgX19saXZlX3JlbW90ZV9jb250ZXh0
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKPiArCQkJCSBzdHJ1Y3QgaTkxNV9nZW1f
Y29udGV4dCAqZml4bWUpCj4gK3sKPiArCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpsb2NhbCwgKnJl
bW90ZTsKPiArCWludCBwYXNzOwo+ICsJaW50IGVycjsKPiArCj4gKwkvKgo+ICsJICogQ2hlY2sg
dGhhdCBvdXIgaWRsZSBiYXJyaWVycyBkbyBub3QgaW50ZXJmZXJlIHdpdGggbm9ybWFsCj4gKwkg
KiBhY3Rpdml0eSB0cmFja2luZy4gSW4gcGFydGljdWxhciwgY2hlY2sgdGhhdCBvcGVyYXRpbmcK
PiArCSAqIG9uIHRoZSBjb250ZXh0IGltYWdlIHJlbW90ZWx5IChpbnRlbF9jb250ZXh0X3ByZXBh
cmVfcmVtb3RlX3JlcXVlc3QpLAo+ICsJICogd2hpY2ggaW5zZXJ0cyBmb3JlaWduIGZlbmNlcyBp
bnRvIGludGVsX2NvbnRleHQuYWN0aXZlLCBkb2VzIG5vdAo+ICsJICogY2xvYmJlciB0aGUgaWRs
ZS1iYXJyaWVyLgo+ICsJICovCj4gKwo+ICsJcmVtb3RlID0gaW50ZWxfY29udGV4dF9jcmVhdGUo
Zml4bWUsIGVuZ2luZSk7Cj4gKwlpZiAoIXJlbW90ZSkKPiArCQlyZXR1cm4gLUVOT01FTTsKPiAr
Cj4gKwlsb2NhbCA9IGludGVsX2NvbnRleHRfY3JlYXRlKGZpeG1lLCBlbmdpbmUpOwo+ICsJaWYg
KCFsb2NhbCkgewo+ICsJCWVyciA9IC1FTk9NRU07Cj4gKwkJZ290byBlcnJfcmVtb3RlOwo+ICsJ
fQo+ICsKPiArCWZvciAocGFzcyA9IDA7IHBhc3MgPD0gMjsgcGFzcysrKSB7Cj4gKwkJZXJyID0g
X19yZW1vdGVfc3luYyhsb2NhbCwgcmVtb3RlKTsKPiArCQlpZiAoZXJyKQo+ICsJCQlicmVhazsK
PiArCj4gKwkJZXJyID0gX19yZW1vdGVfc3luYyhlbmdpbmUtPmtlcm5lbF9jb250ZXh0LCByZW1v
dGUpOwo+ICsJCWlmIChlcnIpCj4gKwkJCWJyZWFrOwo+ICsKPiArCQlpZiAoaTkxNV9hY3RpdmVf
aXNfaWRsZSgmcmVtb3RlLT5hY3RpdmUpKSB7Cj4gKwkJCXByX2VycigicmVtb3RlIGNvbnRleHQg
aXMgbm90IGFjdGl2ZTsgZXhwZWN0ZWQgaWRsZS1iYXJyaWVyICglcyBwYXNzICVkKVxuIiwKPiAr
CQkJICAgICAgIGVuZ2luZS0+bmFtZSwgcGFzcyk7Cj4gKwkJCWVyciA9IC1FSU5WQUw7Cj4gKwkJ
CWJyZWFrOwo+ICsJCX0KPiArCX0KPiArCj4gKwlpbnRlbF9jb250ZXh0X3B1dChsb2NhbCk7Cj4g
K2Vycl9yZW1vdGU6Cj4gKwlpbnRlbF9jb250ZXh0X3B1dChyZW1vdGUpOwo+ICsJcmV0dXJuIGVy
cjsKPiArfQo+ICsKPiArc3RhdGljIGludCBsaXZlX3JlbW90ZV9jb250ZXh0KHZvaWQgKmFyZykK
PiArewo+ICsJc3RydWN0IGludGVsX2d0ICpndCA9IGFyZzsKPiArCXN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZTsKPiArCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpmaXhtZTsKPiArCWVu
dW0gaW50ZWxfZW5naW5lX2lkIGlkOwo+ICsJc3RydWN0IGRybV9maWxlICpmaWxlOwo+ICsJaW50
IGVyciA9IDA7Cj4gKwo+ICsJZmlsZSA9IG1vY2tfZmlsZShndC0+aTkxNSk7Cj4gKwlpZiAoSVNf
RVJSKGZpbGUpKQo+ICsJCXJldHVybiBQVFJfRVJSKGZpbGUpOwo+ICsKPiArCW11dGV4X2xvY2so
Jmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiArCj4gKwlmaXhtZSA9IGxpdmVfY29udGV4
dChndC0+aTkxNSwgZmlsZSk7Cj4gKwlpZiAoIWZpeG1lKSB7Cj4gKwkJZXJyID0gLUVOT01FTTsK
PiArCQlnb3RvIHVubG9jazsKPiArCX0KPiArCj4gKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBn
dC0+aTkxNSwgaWQpIHsKPiArCQllcnIgPSBfX2xpdmVfcmVtb3RlX2NvbnRleHQoZW5naW5lLCBm
aXhtZSk7Cj4gKwkJaWYgKGVycikKPiArCQkJYnJlYWs7Cj4gKwo+ICsJCWVyciA9IGlndF9mbHVz
aF90ZXN0KGd0LT5pOTE1LCBJOTE1X1dBSVRfTE9DS0VEKTsKPiArCQlpZiAoZXJyKQo+ICsJCQli
cmVhazsKPiArCX0KPiArCj4gK3VubG9jazoKPiArCW11dGV4X3VubG9jaygmZ3QtPmk5MTUtPmRy
bS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJbW9ja19maWxlX2ZyZWUoZ3QtPmk5MTUsIGZpbGUpOwo+ICsJ
cmV0dXJuIGVycjsKPiArfQo+ICsKPiAraW50IGludGVsX2NvbnRleHRfbGl2ZV9zZWxmdGVzdHMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gK3sKPiArCXN0YXRpYyBjb25zdCBzdHJ1
Y3QgaTkxNV9zdWJ0ZXN0IHRlc3RzW10gPSB7Cj4gKwkJU1VCVEVTVChsaXZlX2FjdGl2ZV9jb250
ZXh0KSwKPiArCQlTVUJURVNUKGxpdmVfcmVtb3RlX2NvbnRleHQpLAo+ICsJfTsKPiArCXN0cnVj
dCBpbnRlbF9ndCAqZ3QgPSAmaTkxNS0+Z3Q7Cj4gKwo+ICsJaWYgKGludGVsX2d0X2lzX3dlZGdl
ZChndCkpCj4gKwkJcmV0dXJuIDA7Cj4gKwo+ICsJcmV0dXJuIGludGVsX2d0X2xpdmVfc3VidGVz
dHModGVzdHMsIGd0KTsKPiArfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2FjdGl2ZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuYwo+IGluZGV4
IGQzMmRiOGE0ZGI1Yy4uM2E4MTI3ZmFjZTc5IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfYWN0aXZlLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Fj
dGl2ZS5jCj4gQEAgLTMzLDYgKzMzLDM4IEBAIHN0cnVjdCBhY3RpdmVfbm9kZSB7Cj4gICAJdTY0
IHRpbWVsaW5lOwo+ICAgfTsKPiAgIAo+ICtzdGF0aWMgaW5saW5lIHN0cnVjdCBhY3RpdmVfbm9k
ZSAqCj4gK25vZGVfZnJvbV9hY3RpdmUoc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2
ZSkKPiArewo+ICsJcmV0dXJuIGNvbnRhaW5lcl9vZihhY3RpdmUsIHN0cnVjdCBhY3RpdmVfbm9k
ZSwgYmFzZSk7Cj4gK30KPiArCj4gKyNkZWZpbmUgdGFrZV9wcmVhbGxvY2F0ZWRfYmFycmllcnMo
eCkgbGxpc3RfZGVsX2FsbCgmKHgpLT5wcmVhbGxvY2F0ZWRfYmFycmllcnMpCj4gKwo+ICtzdGF0
aWMgaW5saW5lIGJvb2wgaXNfYmFycmllcihjb25zdCBzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVz
dCAqYWN0aXZlKQo+ICt7Cj4gKwlyZXR1cm4gSVNfRVJSKHJjdV9hY2Nlc3NfcG9pbnRlcihhY3Rp
dmUtPnJlcXVlc3QpKTsKPiArfQo+ICsKPiArc3RhdGljIGlubGluZSBzdHJ1Y3QgbGxpc3Rfbm9k
ZSAqYmFycmllcl90b19sbChzdHJ1Y3QgYWN0aXZlX25vZGUgKm5vZGUpCj4gK3sKPiArCUdFTV9C
VUdfT04oIWlzX2JhcnJpZXIoJm5vZGUtPmJhc2UpKTsKPiArCXJldHVybiAoc3RydWN0IGxsaXN0
X25vZGUgKikmbm9kZS0+YmFzZS5saW5rOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW5saW5lIHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKgo+ICtiYXJyaWVyX3RvX2VuZ2luZShzdHJ1Y3QgYWN0aXZlX25v
ZGUgKm5vZGUpCj4gK3sKPiArCUdFTV9CVUdfT04oIWlzX2JhcnJpZXIoJm5vZGUtPmJhc2UpKTsK
PiArCXJldHVybiAoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqKW5vZGUtPmJhc2UubGluay5wcmV2
Owo+ICt9Cj4gKwo+ICtzdGF0aWMgaW5saW5lIHN0cnVjdCBhY3RpdmVfbm9kZSAqYmFycmllcl9m
cm9tX2xsKHN0cnVjdCBsbGlzdF9ub2RlICp4KQo+ICt7Cj4gKwlyZXR1cm4gY29udGFpbmVyX29m
KChzdHJ1Y3QgbGlzdF9oZWFkICopeCwKPiArCQkJICAgIHN0cnVjdCBhY3RpdmVfbm9kZSwgYmFz
ZS5saW5rKTsKPiArfQo+ICsKPiAgICNpZiBJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9ERUJV
R19HRU0pICYmIElTX0VOQUJMRUQoQ09ORklHX0RFQlVHX09CSkVDVFMpCj4gICAKPiAgIHN0YXRp
YyB2b2lkICphY3RpdmVfZGVidWdfaGludCh2b2lkICphZGRyKQo+IEBAIC0xMjcsNyArMTU5LDcg
QEAgYWN0aXZlX3JldGlyZShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZikKPiAgIHN0YXRpYyB2b2lk
Cj4gICBub2RlX3JldGlyZShzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYmFzZSwgc3RydWN0
IGk5MTVfcmVxdWVzdCAqcnEpCj4gICB7Cj4gLQlhY3RpdmVfcmV0aXJlKGNvbnRhaW5lcl9vZihi
YXNlLCBzdHJ1Y3QgYWN0aXZlX25vZGUsIGJhc2UpLT5yZWYpOwo+ICsJYWN0aXZlX3JldGlyZShu
b2RlX2Zyb21fYWN0aXZlKGJhc2UpLT5yZWYpOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgc3RydWN0
IGk5MTVfYWN0aXZlX3JlcXVlc3QgKgo+IEBAIC0xODQsNiArMjE2LDcgQEAgYWN0aXZlX2luc3Rh
bmNlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLCB1NjQgaWR4KQo+ICAgCXJlZi0+Y2FjaGUgPSBu
b2RlOwo+ICAgCW11dGV4X3VubG9jaygmcmVmLT5tdXRleCk7Cj4gICAKPiArCUJVSUxEX0JVR19P
TihvZmZzZXRvZih0eXBlb2YoKm5vZGUpLCBiYXNlKSk7Cj4gICAJcmV0dXJuICZub2RlLT5iYXNl
Owo+ICAgfQo+ICAgCj4gQEAgLTIwMSwxMSArMjM0LDUyIEBAIHZvaWQgX19pOTE1X2FjdGl2ZV9p
bml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCXJlZi0+cmV0aXJlID0gcmV0
aXJlOwo+ICAgCXJlZi0+dHJlZSA9IFJCX1JPT1Q7Cj4gICAJcmVmLT5jYWNoZSA9IE5VTEw7Cj4g
LQlpbml0X2xsaXN0X2hlYWQoJnJlZi0+YmFycmllcnMpOwo+ICsJaW5pdF9sbGlzdF9oZWFkKCZy
ZWYtPnByZWFsbG9jYXRlZF9iYXJyaWVycyk7Cj4gICAJYXRvbWljX3NldCgmcmVmLT5jb3VudCwg
MCk7Cj4gICAJX19tdXRleF9pbml0KCZyZWYtPm11dGV4LCAiaTkxNV9hY3RpdmUiLCBrZXkpOwo+
ICAgfQo+ICAgCj4gK3N0YXRpYyBib29sIF9fYWN0aXZlX2RlbF9iYXJyaWVyKHN0cnVjdCBpOTE1
X2FjdGl2ZSAqcmVmLAo+ICsJCQkJIHN0cnVjdCBhY3RpdmVfbm9kZSAqbm9kZSkKPiArewo+ICsJ
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lID0gYmFycmllcl90b19lbmdpbmUobm9kZSk7
Cj4gKwlzdHJ1Y3QgbGxpc3Rfbm9kZSAqaGVhZCA9IE5VTEwsICp0YWlsID0gTlVMTDsKPiArCXN0
cnVjdCBsbGlzdF9ub2RlICpwb3MsICpuZXh0Owo+ICsKPiArCUdFTV9CVUdfT04obm9kZS0+dGlt
ZWxpbmUgIT0gZW5naW5lLT5rZXJuZWxfY29udGV4dC0+cmluZy0+dGltZWxpbmUtPmZlbmNlX2Nv
bnRleHQpOwo+ICsKPiArCS8qCj4gKwkgKiBSZWJ1aWxkIHRoZSBsbGlzdCBleGNsdWRpbmcgb3Vy
IG5vZGUuIFdlIG1heSBwZXJmb3JtIHRoaXMKPiArCSAqIG91dHNpZGUgb2YgdGhlIGtlcm5lbF9j
b250ZXh0IHRpbWVsaW5lIG11dGV4IGFuZCBzbyBzb21lb25lCj4gKwkgKiBlbHNlIG1heSBiZSBt
YW5pcHVsYXRpbmcgdGhlIGVuZ2luZS0+YmFycmllcl90YXNrcywgaW4KPiArCSAqIHdoaWNoIGNh
c2UgZWl0aGVyIHdlIG9yIHRoZXkgd2lsbCBiZSB1cHNldCA6KQo+ICsJICoKPiArCSAqIEEgc2Vj
b25kIF9fYWN0aXZlX2RlbF9iYXJyaWVyKCkgd2lsbCByZXBvcnQgZmFpbHVyZSB0byBjbGFpbQo+
ICsJICogdGhlIGFjdGl2ZV9ub2RlIGFuZCB0aGUgY2FsbGVyIHdpbGwganVzdCBzaHJ1ZyBhbmQg
a25vdyBub3QgdG8KPiArCSAqIGNsYWltIG93bmVyc2hpcCBvZiBpdHMgbm9kZS4KPiArCSAqCj4g
KwkgKiBBIGNvbmN1cnJlbnQgaTkxNV9yZXF1ZXN0X2FkZF9hY3RpdmVfYmFycmllcnMoKSB3aWxs
IG1pc3MgYWRkaW5nCj4gKwkgKiBhbnkgb2YgdGhlIHRhc2tzLCBidXQgd2Ugd2lsbCB0cnkgYWdh
aW4gb24gdGhlIG5leHQgLS0gYW5kIHNpbmNlCj4gKwkgKiB3ZSBhcmUgYWN0aXZlbHkgdXNpbmcg
dGhlIGJhcnJpZXIsIHdlIGtub3cgdGhhdCB0aGVyZSB3aWxsIGJlCj4gKwkgKiBhdCBsZWFzdCBh
bm90aGVyIG9wcG9ydHVuaXR5IHdoZW4gd2UgaWRsZS4KPiArCSAqLwo+ICsJbGxpc3RfZm9yX2Vh
Y2hfc2FmZShwb3MsIG5leHQsIGxsaXN0X2RlbF9hbGwoJmVuZ2luZS0+YmFycmllcl90YXNrcykp
IHsKPiArCQlpZiAobm9kZSA9PSBiYXJyaWVyX2Zyb21fbGwocG9zKSkgewo+ICsJCQlub2RlID0g
TlVMTDsKPiArCQkJY29udGludWU7Cj4gKwkJfQo+ICsKPiArCQlwb3MtPm5leHQgPSBoZWFkOwo+
ICsJCWhlYWQgPSBwb3M7Cj4gKwkJaWYgKCF0YWlsKQo+ICsJCQl0YWlsID0gcG9zOwo+ICsJfQo+
ICsJaWYgKGhlYWQpCj4gKwkJbGxpc3RfYWRkX2JhdGNoKGhlYWQsIHRhaWwsICZlbmdpbmUtPmJh
cnJpZXJfdGFza3MpOwo+ICsKPiArCXJldHVybiAhbm9kZTsKPiArfQo+ICsKPiAgIGludCBpOTE1
X2FjdGl2ZV9yZWYoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsCj4gICAJCSAgICB1NjQgdGltZWxp
bmUsCj4gICAJCSAgICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKPiBAQCAtMjI0LDggKzI5OCwy
MCBAQCBpbnQgaTkxNV9hY3RpdmVfcmVmKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLAo+ICAgCQln
b3RvIG91dDsKPiAgIAl9Cj4gICAKPiAtCWlmICghaTkxNV9hY3RpdmVfcmVxdWVzdF9pc3NldChh
Y3RpdmUpKQo+IC0JCWF0b21pY19pbmMoJnJlZi0+Y291bnQpOwo+ICsJaWYgKGlzX2JhcnJpZXIo
YWN0aXZlKSkgeyAvKiBwcm90by1ub2RlIHVzZWQgYnkgb3VyIGlkbGUgYmFycmllciAqLwo+ICsJ
CS8qCj4gKwkJICogVGhpcyByZXF1ZXN0IGlzIG9uIHRoZSBrZXJuZWxfY29udGV4dCB0aW1lbGlu
ZSwgYW5kIHNvCj4gKwkJICogd2UgY2FuIHVzZSBpdCB0byBzdWJzdGl0dXRlIGZvciB0aGUgcGVu
ZGluZyBpZGxlLWJhcnJlcgo+ICsJCSAqIHJlcXVlc3QgdGhhdCB3ZSB3YW50IHRvIGVtaXQgb24g
dGhlIGtlcm5lbF9jb250ZXh0Lgo+ICsJCSAqLwo+ICsJCV9fYWN0aXZlX2RlbF9iYXJyaWVyKHJl
Ziwgbm9kZV9mcm9tX2FjdGl2ZShhY3RpdmUpKTsKPiArCQlSQ1VfSU5JVF9QT0lOVEVSKGFjdGl2
ZS0+cmVxdWVzdCwgTlVMTCk7Cj4gKwkJSU5JVF9MSVNUX0hFQUQoJmFjdGl2ZS0+bGluayk7Cj4g
Kwl9IGVsc2Ugewo+ICsJCWlmICghaTkxNV9hY3RpdmVfcmVxdWVzdF9pc3NldChhY3RpdmUpKQo+
ICsJCQlhdG9taWNfaW5jKCZyZWYtPmNvdW50KTsKPiArCX0KPiArCUdFTV9CVUdfT04oIWF0b21p
Y19yZWFkKCZyZWYtPmNvdW50KSk7Cj4gICAJX19pOTE1X2FjdGl2ZV9yZXF1ZXN0X3NldChhY3Rp
dmUsIHJxKTsKPiAgIAo+ICAgb3V0Ogo+IEBAIC0zMTIsNiArMzk4LDExIEBAIGludCBpOTE1X2Fj
dGl2ZV93YWl0KHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQo+ICAgCX0KPiAgIAo+ICAgCXJidHJl
ZV9wb3N0b3JkZXJfZm9yX2VhY2hfZW50cnlfc2FmZShpdCwgbiwgJnJlZi0+dHJlZSwgbm9kZSkg
ewo+ICsJCWlmIChpc19iYXJyaWVyKCZpdC0+YmFzZSkpIHsgLyogdW5jb25uZWN0ZWQgaWRsZS1i
YXJyaWVyICovCj4gKwkJCWVyciA9IC1FQlVTWTsKPiArCQkJYnJlYWs7Cj4gKwkJfQo+ICsKPiAg
IAkJZXJyID0gaTkxNV9hY3RpdmVfcmVxdWVzdF9yZXRpcmUoJml0LT5iYXNlLCBCS0wocmVmKSk7
Cj4gICAJCWlmIChlcnIpCj4gICAJCQlicmVhazsKPiBAQCAtMzc0LDYgKzQ2NSw5MiBAQCB2b2lk
IGk5MTVfYWN0aXZlX2Zpbmkoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCj4gICB9Cj4gICAjZW5k
aWYKPiAgIAo+ICtzdGF0aWMgaW5saW5lIGJvb2wgaXNfaWRsZV9iYXJyaWVyKHN0cnVjdCBhY3Rp
dmVfbm9kZSAqbm9kZSwgdTY0IGlkeCkKPiArewo+ICsJcmV0dXJuIG5vZGUtPnRpbWVsaW5lID09
IGlkeCAmJiAhaTkxNV9hY3RpdmVfcmVxdWVzdF9pc3NldCgmbm9kZS0+YmFzZSk7Cj4gK30KPiAr
Cj4gK3N0YXRpYyBzdHJ1Y3QgYWN0aXZlX25vZGUgKnJldXNlX2lkbGVfYmFycmllcihzdHJ1Y3Qg
aTkxNV9hY3RpdmUgKnJlZiwgdTY0IGlkeCkKPiArewo+ICsJc3RydWN0IHJiX25vZGUgKnByZXYs
ICpwOwo+ICsKPiArCWlmIChSQl9FTVBUWV9ST09UKCZyZWYtPnRyZWUpKQo+ICsJCXJldHVybiBO
VUxMOwo+ICsKPiArCW11dGV4X2xvY2soJnJlZi0+bXV0ZXgpOwo+ICsJR0VNX0JVR19PTihpOTE1
X2FjdGl2ZV9pc19pZGxlKHJlZikpOwo+ICsKPiArCS8qCj4gKwkgKiBUcnkgdG8gcmV1c2UgYW55
IGV4aXN0aW5nIGJhcnJpZXIgbm9kZXMgYWxyZWFkeSBhbGxvY2F0ZWQgZm9yIHRoaXMKPiArCSAq
IGk5MTVfYWN0aXZlLCBkdWUgdG8gb3ZlcmxhcHBpbmcgYWN0aXZlIHBoYXNlcyB0aGVyZSBpcyBs
aWtlbHkgYQo+ICsJICogbm9kZSBrZXB0IGFsaXZlIChhcyB3ZSByZXVzZSBiZWZvcmUgcGFya2lu
ZykuIFdlIHByZWZlciB0byByZXVzZQo+ICsJICogY29tcGxldGVseSBpZGxlIGJhcnJpZXJzIChs
ZXNzIGhhc3NsZSBpbiBtYW5pcHVsYXRpbmcgdGhlIGxsaXN0cyksCj4gKwkgKiBidXQgb3RoZXJ3
aXNlIGFueSB3aWxsIGRvLgo+ICsJICovCj4gKwlpZiAocmVmLT5jYWNoZSAmJiBpc19pZGxlX2Jh
cnJpZXIocmVmLT5jYWNoZSwgaWR4KSkgewo+ICsJCXAgPSAmcmVmLT5jYWNoZS0+bm9kZTsKPiAr
CQlnb3RvIG1hdGNoOwo+ICsJfQo+ICsKPiArCXByZXYgPSBOVUxMOwo+ICsJcCA9IHJlZi0+dHJl
ZS5yYl9ub2RlOwo+ICsJd2hpbGUgKHApIHsKPiArCQlzdHJ1Y3QgYWN0aXZlX25vZGUgKm5vZGUg
PQo+ICsJCQlyYl9lbnRyeShwLCBzdHJ1Y3QgYWN0aXZlX25vZGUsIG5vZGUpOwo+ICsKPiArCQlp
ZiAoaXNfaWRsZV9iYXJyaWVyKG5vZGUsIGlkeCkpCj4gKwkJCWdvdG8gbWF0Y2g7Cj4gKwo+ICsJ
CXByZXYgPSBwOwo+ICsJCWlmIChub2RlLT50aW1lbGluZSA8IGlkeCkKPiArCQkJcCA9IHAtPnJi
X3JpZ2h0Owo+ICsJCWVsc2UKPiArCQkJcCA9IHAtPnJiX2xlZnQ7Cj4gKwl9Cj4gKwo+ICsJLyoK
PiArCSAqIE5vIHF1aWNrIG1hdGNoLCBidXQgd2UgZGlkIGZpbmQgdGhlIGxlZnRtb3N0IHJiX25v
ZGUgZm9yIHRoZQo+ICsJICoga2VybmVsX2NvbnRleHQuIFdhbGsgdGhlIHJiX3RyZWUgaW4tb3Jk
ZXIgdG8gc2VlIGlmIHRoZXJlIHdlcmUKPiArCSAqIGFueSBpZGxlLWJhcnJpZXJzIG9uIHRoaXMg
dGltZWxpbmUgdGhhdCB3ZSBtaXNzZWQsIG9yIGp1c3QgdXNlCj4gKwkgKiB0aGUgZmlyc3QgcGVu
ZGluZyBiYXJyaWVyLgo+ICsJICovCj4gKwlmb3IgKHAgPSBwcmV2OyBwOyBwID0gcmJfbmV4dChw
KSkgewo+ICsJCXN0cnVjdCBhY3RpdmVfbm9kZSAqbm9kZSA9Cj4gKwkJCXJiX2VudHJ5KHAsIHN0
cnVjdCBhY3RpdmVfbm9kZSwgbm9kZSk7Cj4gKwo+ICsJCWlmIChub2RlLT50aW1lbGluZSA+IGlk
eCkKPiArCQkJYnJlYWs7Cj4gKwo+ICsJCWlmIChub2RlLT50aW1lbGluZSA8IGlkeCkKPiArCQkJ
Y29udGludWU7Cj4gKwo+ICsJCWlmIChpc19pZGxlX2JhcnJpZXIobm9kZSwgaWR4KSkKPiArCQkJ
Z290byBtYXRjaDsKPiArCj4gKwkJLyoKPiArCQkgKiBUaGUgbGlzdCBvZiBwZW5kaW5nIGJhcnJp
ZXJzIGlzIHByb3RlY3RlZCBieSB0aGUKPiArCQkgKiBrZXJuZWxfY29udGV4dCB0aW1lbGluZSwg
d2hpY2ggbm90YWJseSB3ZSBkbyBub3QgaG9sZAo+ICsJCSAqIGhlcmUuIGk5MTVfcmVxdWVzdF9h
ZGRfYWN0aXZlX2JhcnJpZXJzKCkgbWF5IGNvbnN1bWUKPiArCQkgKiB0aGUgYmFycmllciBiZWZv
cmUgd2UgY2xhaW0gaXQsIHNvIHdlIGhhdmUgdG8gY2hlY2sKPiArCQkgKiBmb3Igc3VjY2Vzcy4K
PiArCQkgKi8KPiArCQlpZiAoaXNfYmFycmllcigmbm9kZS0+YmFzZSkgJiYgX19hY3RpdmVfZGVs
X2JhcnJpZXIocmVmLCBub2RlKSkKPiArCQkJZ290byBtYXRjaDsKPiArCX0KPiArCj4gKwltdXRl
eF91bmxvY2soJnJlZi0+bXV0ZXgpOwo+ICsKPiArCXJldHVybiBOVUxMOwo+ICsKPiArbWF0Y2g6
Cj4gKwlyYl9lcmFzZShwLCAmcmVmLT50cmVlKTsgLyogSGlkZSBmcm9tIHdhaXRzIGFuZCBzaWJs
aW5nIGFsbG9jYXRpb25zICovCj4gKwlpZiAocCA9PSAmcmVmLT5jYWNoZS0+bm9kZSkKPiArCQly
ZWYtPmNhY2hlID0gTlVMTDsKPiArCW11dGV4X3VubG9jaygmcmVmLT5tdXRleCk7Cj4gKwo+ICsJ
cmV0dXJuIHJiX2VudHJ5KHAsIHN0cnVjdCBhY3RpdmVfbm9kZSwgbm9kZSk7Cj4gK30KPiArCj4g
ICBpbnQgaTkxNV9hY3RpdmVfYWNxdWlyZV9wcmVhbGxvY2F0ZV9iYXJyaWVyKHN0cnVjdCBpOTE1
X2FjdGl2ZSAqcmVmLAo+ICAgCQkJCQkgICAgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KQo+ICAgewo+IEBAIC0zODIsMzkgKzU1OSw2MSBAQCBpbnQgaTkxNV9hY3RpdmVfYWNxdWlyZV9w
cmVhbGxvY2F0ZV9iYXJyaWVyKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLAo+ICAgCXN0cnVjdCBs
bGlzdF9ub2RlICpwb3MsICpuZXh0Owo+ICAgCWludCBlcnI7Cj4gICAKPiAtCUdFTV9CVUdfT04o
IW1hc2spOwo+ICsJR0VNX0JVR19PTighbGxpc3RfZW1wdHkoJnJlZi0+cHJlYWxsb2NhdGVkX2Jh
cnJpZXJzKSk7Cj4gKwo+ICsJLyoKPiArCSAqIFByZWFsbG9jYXRlIGEgbm9kZSBmb3IgZWFjaCBw
aHlzaWNhbCBlbmdpbmUgc3VwcG9ydGluZyB0aGUgdGFyZ2V0Cj4gKwkgKiBlbmdpbmUgKHJlbWVt
YmVyIHZpcnR1YWwgZW5naW5lcyBoYXZlIG1vcmUgdGhhbiBvbmUgc2libGluZykuCj4gKwkgKiBX
ZSBjYW4gdGhlbiB1c2UgdGhlIHByZWFsbG9jYXRlZCBub2RlcyBpbgo+ICsJICogaTkxNV9hY3Rp
dmVfYWNxdWlyZV9iYXJyaWVyKCkKPiArCSAqLwo+ICAgCWZvcl9lYWNoX2VuZ2luZV9tYXNrZWQo
ZW5naW5lLCBpOTE1LCBtYXNrLCB0bXApIHsKPiAtCQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqa2N0
eCA9IGVuZ2luZS0+a2VybmVsX2NvbnRleHQ7Cj4gKwkJdTY0IGlkeCA9IGVuZ2luZS0+a2VybmVs
X2NvbnRleHQtPnJpbmctPnRpbWVsaW5lLT5mZW5jZV9jb250ZXh0Owo+ICAgCQlzdHJ1Y3QgYWN0
aXZlX25vZGUgKm5vZGU7Cj4gICAKPiAtCQlub2RlID0ga21lbV9jYWNoZV9hbGxvYyhnbG9iYWwu
c2xhYl9jYWNoZSwgR0ZQX0tFUk5FTCk7Cj4gLQkJaWYgKHVubGlrZWx5KCFub2RlKSkgewo+IC0J
CQllcnIgPSAtRU5PTUVNOwo+IC0JCQlnb3RvIHVud2luZDsKPiArCQlub2RlID0gcmV1c2VfaWRs
ZV9iYXJyaWVyKHJlZiwgaWR4KTsKPiArCQlpZiAoIW5vZGUpIHsKPiArCQkJbm9kZSA9IGttZW1f
Y2FjaGVfYWxsb2MoZ2xvYmFsLnNsYWJfY2FjaGUsIEdGUF9LRVJORUwpOwo+ICsJCQlpZiAoIW5v
ZGUpIHsKPiArCQkJCWVyciA9IEVOT01FTTsKPiArCQkJCWdvdG8gdW53aW5kOwo+ICsJCQl9Cj4g
Kwo+ICsJCQlSQ1VfSU5JVF9QT0lOVEVSKG5vZGUtPmJhc2UucmVxdWVzdCwgTlVMTCk7Cj4gKwkJ
CW5vZGUtPmJhc2UucmV0aXJlID0gbm9kZV9yZXRpcmU7Cj4gKwkJCW5vZGUtPnRpbWVsaW5lID0g
aWR4Owo+ICsJCQlub2RlLT5yZWYgPSByZWY7Cj4gICAJCX0KPiAgIAo+IC0JCWk5MTVfYWN0aXZl
X3JlcXVlc3RfaW5pdCgmbm9kZS0+YmFzZSwKPiAtCQkJCQkgKHZvaWQgKillbmdpbmUsIG5vZGVf
cmV0aXJlKTsKPiAtCQlub2RlLT50aW1lbGluZSA9IGtjdHgtPnJpbmctPnRpbWVsaW5lLT5mZW5j
ZV9jb250ZXh0Owo+IC0JCW5vZGUtPnJlZiA9IHJlZjsKPiAtCQlhdG9taWNfaW5jKCZyZWYtPmNv
dW50KTsKPiArCQlpZiAoIWk5MTVfYWN0aXZlX3JlcXVlc3RfaXNzZXQoJm5vZGUtPmJhc2UpKSB7
Cj4gKwkJCS8qCj4gKwkJCSAqIE1hcmsgdGhpcyBhcyBiZWluZyAqb3VyKiB1bmNvbm5lY3RlZCBw
cm90by1ub2RlLgo+ICsJCQkgKgo+ICsJCQkgKiBTaW5jZSB0aGlzIG5vZGUgaXMgbm90IGluIGFu
eSBsaXN0LCBhbmQgd2UgaGF2ZQo+ICsJCQkgKiBkZWNvdXBsZWQgaXQgZnJvbSB0aGUgcmJ0cmVl
LCB3ZSBjYW4gcmV1c2UgdGhlCj4gKwkJCSAqIHJlcXVlc3QgdG8gaW5kaWNhdGUgdGhpcyBpcyBh
biBpZGxlLWJhcnJpZXIgbm9kZQo+ICsJCQkgKiBhbmQgdGhlbiB3ZSBjYW4gdXNlIHRoZSByYl9u
b2RlIGFuZCBsaXN0IHBvaW50ZXJzCj4gKwkJCSAqIGZvciBvdXIgdHJhY2tpbmcgb2YgdGhlIHBl
bmRpbmcgYmFycmllci4KPiArCQkJICovCj4gKwkJCVJDVV9JTklUX1BPSU5URVIobm9kZS0+YmFz
ZS5yZXF1ZXN0LCBFUlJfUFRSKC1FQUdBSU4pKTsKPiArCQkJbm9kZS0+YmFzZS5saW5rLnByZXYg
PSAodm9pZCAqKWVuZ2luZTsKPiArCQkJYXRvbWljX2luYygmcmVmLT5jb3VudCk7Cj4gKwkJfQo+
ICAgCj4gKwkJR0VNX0JVR19PTihiYXJyaWVyX3RvX2VuZ2luZShub2RlKSAhPSBlbmdpbmUpOwo+
ICsJCWxsaXN0X2FkZChiYXJyaWVyX3RvX2xsKG5vZGUpLCAmcmVmLT5wcmVhbGxvY2F0ZWRfYmFy
cmllcnMpOwo+ICAgCQlpbnRlbF9lbmdpbmVfcG1fZ2V0KGVuZ2luZSk7Cj4gLQkJbGxpc3RfYWRk
KChzdHJ1Y3QgbGxpc3Rfbm9kZSAqKSZub2RlLT5iYXNlLmxpbmssCj4gLQkJCSAgJnJlZi0+YmFy
cmllcnMpOwo+ICAgCX0KPiAgIAo+ICAgCXJldHVybiAwOwo+ICAgCj4gICB1bndpbmQ6Cj4gLQls
bGlzdF9mb3JfZWFjaF9zYWZlKHBvcywgbmV4dCwgbGxpc3RfZGVsX2FsbCgmcmVmLT5iYXJyaWVy
cykpIHsKPiAtCQlzdHJ1Y3QgYWN0aXZlX25vZGUgKm5vZGU7Cj4gKwlsbGlzdF9mb3JfZWFjaF9z
YWZlKHBvcywgbmV4dCwgdGFrZV9wcmVhbGxvY2F0ZWRfYmFycmllcnMocmVmKSkgewo+ICsJCXN0
cnVjdCBhY3RpdmVfbm9kZSAqbm9kZSA9IGJhcnJpZXJfZnJvbV9sbChwb3MpOwo+ICAgCj4gLQkJ
bm9kZSA9IGNvbnRhaW5lcl9vZigoc3RydWN0IGxpc3RfaGVhZCAqKXBvcywKPiAtCQkJCSAgICB0
eXBlb2YoKm5vZGUpLCBiYXNlLmxpbmspOwo+IC0JCWVuZ2luZSA9ICh2b2lkICopcmN1X2FjY2Vz
c19wb2ludGVyKG5vZGUtPmJhc2UucmVxdWVzdCk7Cj4gKwkJYXRvbWljX2RlYygmcmVmLT5jb3Vu
dCk7Cj4gKwkJaW50ZWxfZW5naW5lX3BtX3B1dChiYXJyaWVyX3RvX2VuZ2luZShub2RlKSk7Cj4g
ICAKPiAtCQlpbnRlbF9lbmdpbmVfcG1fcHV0KGVuZ2luZSk7Cj4gICAJCWttZW1fY2FjaGVfZnJl
ZShnbG9iYWwuc2xhYl9jYWNoZSwgbm9kZSk7Cj4gICAJfQo+ICAgCXJldHVybiBlcnI7Cj4gQEAg
LTQyNiwyNSArNjI1LDI3IEBAIHZvaWQgaTkxNV9hY3RpdmVfYWNxdWlyZV9iYXJyaWVyKHN0cnVj
dCBpOTE1X2FjdGl2ZSAqcmVmKQo+ICAgCj4gICAJR0VNX0JVR19PTihpOTE1X2FjdGl2ZV9pc19p
ZGxlKHJlZikpOwo+ICAgCj4gKwkvKgo+ICsJICogVHJhbnNmZXIgdGhlIGxpc3Qgb2YgcHJlYWxs
b2NhdGVkIGJhcnJpZXJzIGludG8gdGhlCj4gKwkgKiBpOTE1X2FjdGl2ZSByYnRyZWUsIGJ1dCBv
bmx5IGFzIHByb3RvLW5vZGVzLiBUaGV5IHdpbGwgYmUKPiArCSAqIHBvcHVsYXRlZCBieSBpOTE1
X3JlcXVlc3RfYWRkX2FjdGl2ZV9iYXJyaWVyKCkgdG8gcG9pbnQgdG8gdGhlCj4gKwkgKiByZXF1
ZXN0IHRoYXQgd2lsbCBldmVudHVhbGx5IHJlbGVhc2UgdGhlbS4KPiArCSAqLwo+ICAgCW11dGV4
X2xvY2tfbmVzdGVkKCZyZWYtPm11dGV4LCBTSU5HTEVfREVQVEhfTkVTVElORyk7Cj4gLQlsbGlz
dF9mb3JfZWFjaF9zYWZlKHBvcywgbmV4dCwgbGxpc3RfZGVsX2FsbCgmcmVmLT5iYXJyaWVycykp
IHsKPiAtCQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4gLQkJc3RydWN0IGFjdGl2
ZV9ub2RlICpub2RlOwo+ICsJbGxpc3RfZm9yX2VhY2hfc2FmZShwb3MsIG5leHQsIHRha2VfcHJl
YWxsb2NhdGVkX2JhcnJpZXJzKHJlZikpIHsKPiArCQlzdHJ1Y3QgYWN0aXZlX25vZGUgKm5vZGUg
PSBiYXJyaWVyX2Zyb21fbGwocG9zKTsKPiArCQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUgPSBiYXJyaWVyX3RvX2VuZ2luZShub2RlKTsKPiAgIAkJc3RydWN0IHJiX25vZGUgKipwLCAq
cGFyZW50Owo+ICAgCj4gLQkJbm9kZSA9IGNvbnRhaW5lcl9vZigoc3RydWN0IGxpc3RfaGVhZCAq
KXBvcywKPiAtCQkJCSAgICB0eXBlb2YoKm5vZGUpLCBiYXNlLmxpbmspOwo+IC0KPiAtCQllbmdp
bmUgPSAodm9pZCAqKXJjdV9hY2Nlc3NfcG9pbnRlcihub2RlLT5iYXNlLnJlcXVlc3QpOwo+IC0J
CVJDVV9JTklUX1BPSU5URVIobm9kZS0+YmFzZS5yZXF1ZXN0LCBFUlJfUFRSKC1FQUdBSU4pKTsK
PiAtCj4gICAJCXBhcmVudCA9IE5VTEw7Cj4gICAJCXAgPSAmcmVmLT50cmVlLnJiX25vZGU7Cj4g
ICAJCXdoaWxlICgqcCkgewo+ICsJCQlzdHJ1Y3QgYWN0aXZlX25vZGUgKml0Owo+ICsKPiAgIAkJ
CXBhcmVudCA9ICpwOwo+IC0JCQlpZiAocmJfZW50cnkocGFyZW50LAo+IC0JCQkJICAgICBzdHJ1
Y3QgYWN0aXZlX25vZGUsCj4gLQkJCQkgICAgIG5vZGUpLT50aW1lbGluZSA8IG5vZGUtPnRpbWVs
aW5lKQo+ICsKPiArCQkJaXQgPSByYl9lbnRyeShwYXJlbnQsIHN0cnVjdCBhY3RpdmVfbm9kZSwg
bm9kZSk7Cj4gKwkJCWlmIChpdC0+dGltZWxpbmUgPCBub2RlLT50aW1lbGluZSkKPiAgIAkJCQlw
ID0gJnBhcmVudC0+cmJfcmlnaHQ7Cj4gICAJCQllbHNlCj4gICAJCQkJcCA9ICZwYXJlbnQtPnJi
X2xlZnQ7Cj4gQEAgLTQ1MiwyMCArNjUzLDI5IEBAIHZvaWQgaTkxNV9hY3RpdmVfYWNxdWlyZV9i
YXJyaWVyKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQo+ICAgCQlyYl9saW5rX25vZGUoJm5vZGUt
Pm5vZGUsIHBhcmVudCwgcCk7Cj4gICAJCXJiX2luc2VydF9jb2xvcigmbm9kZS0+bm9kZSwgJnJl
Zi0+dHJlZSk7Cj4gICAKPiAtCQlsbGlzdF9hZGQoKHN0cnVjdCBsbGlzdF9ub2RlICopJm5vZGUt
PmJhc2UubGluaywKPiAtCQkJICAmZW5naW5lLT5iYXJyaWVyX3Rhc2tzKTsKPiArCQlsbGlzdF9h
ZGQoYmFycmllcl90b19sbChub2RlKSwgJmVuZ2luZS0+YmFycmllcl90YXNrcyk7Cj4gICAJCWlu
dGVsX2VuZ2luZV9wbV9wdXQoZW5naW5lKTsKPiAgIAl9Cj4gICAJbXV0ZXhfdW5sb2NrKCZyZWYt
Pm11dGV4KTsKPiAgIH0KPiAgIAo+IC12b2lkIGk5MTVfcmVxdWVzdF9hZGRfYmFycmllcnMoc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnEpCj4gK3ZvaWQgaTkxNV9yZXF1ZXN0X2FkZF9hY3RpdmVfYmFy
cmllcnMoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCj4gICB7Cj4gICAJc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lID0gcnEtPmVuZ2luZTsKPiAgIAlzdHJ1Y3QgbGxpc3Rfbm9kZSAqbm9k
ZSwgKm5leHQ7Cj4gICAKPiAtCWxsaXN0X2Zvcl9lYWNoX3NhZmUobm9kZSwgbmV4dCwgbGxpc3Rf
ZGVsX2FsbCgmZW5naW5lLT5iYXJyaWVyX3Rhc2tzKSkKPiArCUdFTV9CVUdfT04oaW50ZWxfZW5n
aW5lX2lzX3ZpcnR1YWwoZW5naW5lKSk7Cj4gKwlHRU1fQlVHX09OKHJxLT50aW1lbGluZSAhPSBl
bmdpbmUtPmtlcm5lbF9jb250ZXh0LT5yaW5nLT50aW1lbGluZSk7Cj4gKwo+ICsJLyoKPiArCSAq
IEF0dGFjaCB0aGUgbGlzdCBvZiBwcm90by1mZW5jZXMgdG8gdGhlIGluLWZsaWdodCByZXF1ZXN0
IHN1Y2gKPiArCSAqIHRoYXQgdGhlIHBhcmVudCBpOTE1X2FjdGl2ZSB3aWxsIGJlIHJlbGVhc2Vk
IHdoZW4gdGhpcyByZXF1ZXN0Cj4gKwkgKiBpcyByZXRpcmVkLgo+ICsJICovCj4gKwlsbGlzdF9m
b3JfZWFjaF9zYWZlKG5vZGUsIG5leHQsIGxsaXN0X2RlbF9hbGwoJmVuZ2luZS0+YmFycmllcl90
YXNrcykpIHsKPiArCQlSQ1VfSU5JVF9QT0lOVEVSKGJhcnJpZXJfZnJvbV9sbChub2RlKS0+YmFz
ZS5yZXF1ZXN0LCBycSk7Cj4gICAJCWxpc3RfYWRkX3RhaWwoKHN0cnVjdCBsaXN0X2hlYWQgKilu
b2RlLCAmcnEtPmFjdGl2ZV9saXN0KTsKPiArCX0KPiAgIH0KPiAgIAo+ICAgaW50IGk5MTVfYWN0
aXZlX3JlcXVlc3Rfc2V0KHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUsCj4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmggYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5oCj4gaW5kZXggYmE2OGIwNzdlYzZjLi41NjYzMzZjOTll
ZDcgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuaAo+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmgKPiBAQCAtNDEzLDYgKzQxMyw2
IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBpOTE1X2FjdGl2ZV9maW5pKHN0cnVjdCBpOTE1X2FjdGl2
ZSAqcmVmKSB7IH0KPiAgIGludCBpOTE1X2FjdGl2ZV9hY3F1aXJlX3ByZWFsbG9jYXRlX2JhcnJp
ZXIoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsCj4gICAJCQkJCSAgICBzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmUpOwo+ICAgdm9pZCBpOTE1X2FjdGl2ZV9hY3F1aXJlX2JhcnJpZXIoc3Ry
dWN0IGk5MTVfYWN0aXZlICpyZWYpOwo+IC12b2lkIGk5MTVfcmVxdWVzdF9hZGRfYmFycmllcnMo
c3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpOwo+ICt2b2lkIGk5MTVfcmVxdWVzdF9hZGRfYWN0aXZl
X2JhcnJpZXJzKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKTsKPiAgIAo+ICAgI2VuZGlmIC8qIF9J
OTE1X0FDVElWRV9IXyAqLwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2FjdGl2ZV90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmVfdHlwZXMu
aAo+IGluZGV4IDc0NzQzZGQwZDVmMC4uYWUzZWU0NDFjMTE0IDEwMDY0NAo+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlX3R5cGVzLmgKPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2FjdGl2ZV90eXBlcy5oCj4gQEAgLTQyLDcgKzQyLDcgQEAgc3RydWN0IGk5
MTVfYWN0aXZlIHsKPiAgIAlpbnQgKCphY3RpdmUpKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKTsK
PiAgIAl2b2lkICgqcmV0aXJlKShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZik7Cj4gICAKPiAtCXN0
cnVjdCBsbGlzdF9oZWFkIGJhcnJpZXJzOwo+ICsJc3RydWN0IGxsaXN0X2hlYWQgcHJlYWxsb2Nh
dGVkX2JhcnJpZXJzOwo+ICAgfTsKPiAgIAo+ICAgI2VuZGlmIC8qIF9JOTE1X0FDVElWRV9UWVBF
U19IXyAqLwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkx
NV9saXZlX3NlbGZ0ZXN0cy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVf
bGl2ZV9zZWxmdGVzdHMuaAo+IGluZGV4IDJiMzFhNGVlMGI0Yy4uYTg0MWQzZjliZWRjIDEwMDY0
NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2xpdmVfc2VsZnRl
c3RzLmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9saXZlX3Nl
bGZ0ZXN0cy5oCj4gQEAgLTE1LDYgKzE1LDcgQEAgc2VsZnRlc3Qod29ya2Fyb3VuZHMsIGludGVs
X3dvcmthcm91bmRzX2xpdmVfc2VsZnRlc3RzKQo+ICAgc2VsZnRlc3QodGltZWxpbmVzLCBpbnRl
bF90aW1lbGluZV9saXZlX3NlbGZ0ZXN0cykKPiAgIHNlbGZ0ZXN0KHJlcXVlc3RzLCBpOTE1X3Jl
cXVlc3RfbGl2ZV9zZWxmdGVzdHMpCj4gICBzZWxmdGVzdChhY3RpdmUsIGk5MTVfYWN0aXZlX2xp
dmVfc2VsZnRlc3RzKQo+ICtzZWxmdGVzdChndF9jb250ZXh0cywgaW50ZWxfY29udGV4dF9saXZl
X3NlbGZ0ZXN0cykKPiAgIHNlbGZ0ZXN0KG9iamVjdHMsIGk5MTVfZ2VtX29iamVjdF9saXZlX3Nl
bGZ0ZXN0cykKPiAgIHNlbGZ0ZXN0KG1tYW4sIGk5MTVfZ2VtX21tYW5fbGl2ZV9zZWxmdGVzdHMp
Cj4gICBzZWxmdGVzdChkbWFidWYsIGk5MTVfZ2VtX2RtYWJ1Zl9saXZlX3NlbGZ0ZXN0cykKPiBA
QCAtMjQsNyArMjUsNyBAQCBzZWxmdGVzdChndHQsIGk5MTVfZ2VtX2d0dF9saXZlX3NlbGZ0ZXN0
cykKPiAgIHNlbGZ0ZXN0KGdlbSwgaTkxNV9nZW1fbGl2ZV9zZWxmdGVzdHMpCj4gICBzZWxmdGVz
dChldmljdCwgaTkxNV9nZW1fZXZpY3RfbGl2ZV9zZWxmdGVzdHMpCj4gICBzZWxmdGVzdChodWdl
cGFnZXMsIGk5MTVfZ2VtX2h1Z2VfcGFnZV9saXZlX3NlbGZ0ZXN0cykKPiAtc2VsZnRlc3QoY29u
dGV4dHMsIGk5MTVfZ2VtX2NvbnRleHRfbGl2ZV9zZWxmdGVzdHMpCj4gK3NlbGZ0ZXN0KGdlbV9j
b250ZXh0cywgaTkxNV9nZW1fY29udGV4dF9saXZlX3NlbGZ0ZXN0cykKPiAgIHNlbGZ0ZXN0KGJs
dCwgaTkxNV9nZW1fb2JqZWN0X2JsdF9saXZlX3NlbGZ0ZXN0cykKPiAgIHNlbGZ0ZXN0KGNsaWVu
dCwgaTkxNV9nZW1fY2xpZW50X2JsdF9saXZlX3NlbGZ0ZXN0cykKPiAgIHNlbGZ0ZXN0KHJlc2V0
LCBpbnRlbF9yZXNldF9saXZlX3NlbGZ0ZXN0cykKPiAKClJldmlld2VkLWJ5OiBUdnJ0a28gVXJz
dWxpbiA8dHZydGtvLnVyc3VsaW5AaW50ZWwuY29tPgoKUmVnYXJkcywKClR2cnRrbwpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGlu
ZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVl
ZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id AB42799E65
	for <lists+intel-gfx@lfdr.de>; Thu, 22 Aug 2019 20:02:11 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 22F226E9EB;
	Thu, 22 Aug 2019 18:02:08 +0000 (UTC)
X-Original-To: Intel-GFX@lists.freedesktop.org
Delivered-To: Intel-GFX@lists.freedesktop.org
Received: from mga09.intel.com (mga09.intel.com [134.134.136.24])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A97D96E55A
 for <Intel-GFX@lists.freedesktop.org>; Thu, 22 Aug 2019 18:02:06 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga004.jf.intel.com ([10.7.209.38])
 by orsmga102.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 22 Aug 2019 11:02:05 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,417,1559545200"; d="scan'208";a="330471908"
Received: from relo-linux-5.jf.intel.com ([10.165.21.134])
 by orsmga004.jf.intel.com with ESMTP; 22 Aug 2019 11:02:05 -0700
From: John.C.Harrison@Intel.com
To: Intel-GFX@Lists.FreeDesktop.Org
Date: Thu, 22 Aug 2019 11:02:04 -0700
Message-Id: <20190822180205.21071-2-John.C.Harrison@Intel.com>
X-Mailer: git-send-email 2.21.0.5.gaeb582a983
In-Reply-To: <20190822180205.21071-1-John.C.Harrison@Intel.com>
References: <20190822180205.21071-1-John.C.Harrison@Intel.com>
MIME-Version: 1.0
Organization: Intel Corporation (UK) Ltd. - Co. Reg. #1134945 - Pipers Way,
 Swindon SN3 1RJ
Subject: [Intel-gfx] [PATCH 1/2] drm/i915: Engine relative MMIO
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Chris P Wilson <chris.p.wilson@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogSm9obiBIYXJyaXNvbiA8Sm9obi5DLkhhcnJpc29uQEludGVsLmNvbT4KCldpdGggdmly
dHVhbCBlbmdpbmVzLCBpdCBpcyBubyBsb25nZXIgcG9zc2libGUgdG8ga25vdyB3aGljaCBzcGVj
aWZpYwpwaHlzaWNhbCBlbmdpbmUgYSBnaXZlbiByZXF1ZXN0IHdpbGwgYmUgZXhlY3V0ZWQgb24g
YXQgdGhlIHRpbWUgdGhhdApyZXF1ZXN0IGlzIGdlbmVyYXRlZC4gVGhpcyBtZWFucyB0aGF0IHRo
ZSByZXF1ZXN0IGl0c2VsZiBtdXN0IGJlIGVuZ2luZQphZ25vc3RpYyAtIGFueSBkaXJlY3QgcmVn
aXN0ZXIgd3JpdGVzIG11c3QgYmUgcmVsYXRpdmUgdG8gdGhlIGVuZ2luZQphbmQgbm90IGFic29s
dXRlIGFkZHJlc3Nlcy4KClRoZSBMUkkgY29tbWFuZCBoYXMgc3VwcG9ydCBmb3IgZW5naW5lIHJl
bGF0aXZlIGFkZHJlc3NpbmcuIEhvd2V2ZXIsCnRoZSBtZWNoYW5pc20gaXMgbm90IHRyYW5zcGFy
ZW50IHRvIHRoZSBkcml2ZXIuIFRoZSBzY2hlbWUgZm9yIEdlbjExCihNSV9MUklfQUREX0NTX01N
SU9fU1RBUlQpIHJlcXVpcmVzIHRoZSBMUkkgYWRkcmVzcyB0byBoYXZlIG5vCmFic29sdXRlIGVu
Z2luZSBiYXNlIGNvbXBvbmVudC4gVGhlIGhhcmR3YXJlIHRoZW4gYWRkcyBvbiB0aGUgY29ycmVj
dAplbmdpbmUgb2Zmc2V0IGF0IGV4ZWN1dGlvbiB0aW1lLgoKRHVlIHRvIHRoZSBub24tdHJpdmlh
bCBhbmQgZGlmZmVyaW5nIHNjaGVtZXMgb24gZGlmZmVyZW50IGhhcmR3YXJlLCBpdAppcyBub3Qg
cG9zc2libGUgdG8gc2ltcGx5IHVwZGF0ZSB0aGUgY29kZSB0aGF0IGNyZWF0ZXMgdGhlIExSSQpj
b21tYW5kcyB0byBzZXQgYSByZW1hcCBmbGFnIGFuZCBsZXQgdGhlIGhhcmR3YXJlIGdldCBvbiB3
aXRoIGl0LgpJbnN0ZWFkLCB0aGlzIHBhdGNoIGFkZHMgZnVuY3Rpb24gd3JhcHBlcnMgZm9yIGdl
bmVyYXRpbmcgdGhlIExSSQpjb21tYW5kIGl0c2VsZiBhbmQgdGhlbiBmb3IgY29uc3RydWN0aW5n
IHRoZSBjb3JyZWN0IGFkZHJlc3MgdG8gdXNlCndpdGggdGhlIExSSS4KCnYyOiBGaXggYnVpbGQg
YnJlYWsgaW4gR1ZULiBSZW1vdmUgZmxhZ3MgcGFyYW1ldGVyIFtyZXZpZXcgZmVlZGJhY2sKZnJv
bSBDaHJpcyBXXS4KCnYzOiBGaXggYnVpbGQgYnJlYWsgaW4gc2VsZnRlc3QuIFJlYmFzZSB0byBu
ZXdlciBiYXNlIHRyZWUgYW5kIGZpeAptZXJnZSBjb25mbGljdC4KCnY0OiBNb3JlIHJlYmFzaW5n
LiBSbW92ZWQgcmVsYXRpdmUgYWRkcmVzc2luZyBzdXBwb3J0IGZyb20gR2VuNy05IG9ubHkKY29k
ZSBwYXRocyBbcmV2aWV3IGZlZWRiYWNrIGZyb20gQ2hyaXMgV10uCgp2NTogTW9yZSByZWJhc2lu
ZyAobmV3ICdndCcgZGlyZWN0b3J5KS4gRml4IHdoaXRlIHNwYWNlIGlzc3VlLiBVc2UKQ09QWSBj
bGFzcyByYXRoZXIgdGhhbiBCQ1MwIGlkIGZvciBjaGVja2luZyBhZ2FpbnN0IEJDUyBlbmdpbmUu
Cgp2NjogQ2hhbmdlIHRvIE1JX0xSSSBmb3IgZ2VuZXJpYyBjb2RlIGFuZCBfX01JX0xSSSBmb3Ig
bGVnYWN5IGNvZGUuCk1JX0xSSSBpcyBub3cgYSBtYWNybyB3cmFwcGVyIGFyb3VuZCBhbiBlbmdp
bmUgZnVuY3Rpb24gcG9pbnRlciB0bwpyZWR1Y2UgcnVudGltZSBjaGVja3Mgb24gTFJJIHJlbGF0
aXZlIHN1cHBvcnQuIFtyZXZpZXcgZmVlZGJhY2sgZnJvbQpUdnJ0a29dCgpTaWduZWQtb2ZmLWJ5
OiBKb2huIEhhcnJpc29uIDxKb2huLkMuSGFycmlzb25ASW50ZWwuY29tPgpDQzogUm9kcmlnbyBW
aXZpIDxyb2RyaWdvLnZpdmlAaW50ZWwuY29tPgpDQzogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51
cnN1bGluQGludGVsLmNvbT4KQ0M6IENocmlzIFAgV2lsc29uIDxjaHJpcy5wLndpbHNvbkBpbnRl
bC5jb20+CkNDOiBEYW5pZWxlIENlcmFvbG8gU3B1cmlvIDxkYW5pZWxlLmNlcmFvbG9zcHVyaW9A
aW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0
LmMgICB8IDE0ICsrLS0KIC4uLi9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIu
YyAgICB8ICAzICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaCAgICAg
ICAgfCAgNSArKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMgICAg
IHwgNDIgKysrKysrKysrKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5
cGVzLmggIHwgIDMgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3B1X2NvbW1hbmRz
LmggIHwgIDggKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jICAgICAgICAg
ICB8IDc3ICsrKysrKysrKystLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2xyY19yZWcuaCAgICAgICB8ICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9t
b2NzLmMgICAgICAgICAgfCAxNyArKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9y
aW5nYnVmZmVyLmMgICAgfCAyNSArKysrLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X3dvcmthcm91bmRzLmMgICB8ICA0ICstCiAuLi4vZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dv
cmthcm91bmRzLmMgICAgfCAxNSArKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvbW1pb19j
b250ZXh0LmMgICAgICAgfCAxNiArKystCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2NtZF9w
YXJzZXIuYyAgICAgICAgfCAgNiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMg
ICAgICAgICAgICAgIHwgMTYgKystLQogMTUgZmlsZXMgY2hhbmdlZCwgMTc1IGluc2VydGlvbnMo
KyksIDgwIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
Y29udGV4dC5jCmluZGV4IDFjZGZlMDU1MTRjMy4uYjhmMjMxNDhhYzgwIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKQEAgLTk5MiwxMSArOTkyLDExIEBA
IHN0YXRpYyBpbnQgZW1pdF9wcGd0dF91cGRhdGUoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsIHZv
aWQgKmRhdGEpCiAJCWlmIChJU19FUlIoY3MpKQogCQkJcmV0dXJuIFBUUl9FUlIoY3MpOwogCi0J
CSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oMik7CisJCSpjcysrID0gTUlfTE9BRF9SRUdJ
U1RFUl9JTU0oZW5naW5lLCAyKTsKIAotCQkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEdF
TjhfUklOR19QRFBfVURXKGJhc2UsIDApKTsKKwkJKmNzKysgPSBpOTE1X2dldF9scmlfcmVnKGVu
Z2luZSwgR0VOOF9SSU5HX1BEUF9VRFcoYmFzZSwgMCkpOwogCQkqY3MrKyA9IHVwcGVyXzMyX2Jp
dHMocGRfZGFkZHIpOwotCQkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEdFTjhfUklOR19Q
RFBfTERXKGJhc2UsIDApKTsKKwkJKmNzKysgPSBpOTE1X2dldF9scmlfcmVnKGVuZ2luZSwgR0VO
OF9SSU5HX1BEUF9MRFcoYmFzZSwgMCkpOwogCQkqY3MrKyA9IGxvd2VyXzMyX2JpdHMocGRfZGFk
ZHIpOwogCiAJCSpjcysrID0gTUlfTk9PUDsKQEAgLTEwMDgsMTMgKzEwMDgsMTUgQEAgc3RhdGlj
IGludCBlbWl0X3BwZ3R0X3VwZGF0ZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgdm9pZCAqZGF0
YSkKIAkJaWYgKElTX0VSUihjcykpCiAJCQlyZXR1cm4gUFRSX0VSUihjcyk7CiAKLQkJKmNzKysg
PSBNSV9MT0FEX1JFR0lTVEVSX0lNTSgyICogR0VOOF8zTFZMX1BEUEVTKTsKKwkJKmNzKysgPSBN
SV9MT0FEX1JFR0lTVEVSX0lNTShlbmdpbmUsIDIgKiBHRU44XzNMVkxfUERQRVMpOwogCQlmb3Ig
KGkgPSBHRU44XzNMVkxfUERQRVM7IGktLTsgKSB7CiAJCQljb25zdCBkbWFfYWRkcl90IHBkX2Rh
ZGRyID0gaTkxNV9wYWdlX2Rpcl9kbWFfYWRkcihwcGd0dCwgaSk7CiAKLQkJCSpjcysrID0gaTkx
NV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9SSU5HX1BEUF9VRFcoYmFzZSwgaSkpOworCQkJKmNzKysg
PSBpOTE1X2dldF9scmlfcmVnKGVuZ2luZSwKKwkJCQkJCSBHRU44X1JJTkdfUERQX1VEVyhiYXNl
LCBpKSk7CiAJCQkqY3MrKyA9IHVwcGVyXzMyX2JpdHMocGRfZGFkZHIpOwotCQkJKmNzKysgPSBp
OTE1X21taW9fcmVnX29mZnNldChHRU44X1JJTkdfUERQX0xEVyhiYXNlLCBpKSk7CisJCQkqY3Mr
KyA9IGk5MTVfZ2V0X2xyaV9yZWcoZW5naW5lLAorCQkJCQkJIEdFTjhfUklOR19QRFBfTERXKGJh
c2UsIGkpKTsKIAkJCSpjcysrID0gbG93ZXJfMzJfYml0cyhwZF9kYWRkcik7CiAJCX0KIAkJKmNz
KysgPSBNSV9OT09QOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX2V4ZWNidWZmZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVj
YnVmZmVyLmMKaW5kZXggMmRjYTI5NjJjNzNhLi4xM2JhZDc4MDZmNTIgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYwpAQCAtMTk0Nyw3ICsxOTQ3
LDggQEAgc3RhdGljIGludCBpOTE1X3Jlc2V0X2dlbjdfc29sX29mZnNldHMoc3RydWN0IGk5MTVf
cmVxdWVzdCAqcnEpCiAJaWYgKElTX0VSUihjcykpCiAJCXJldHVybiBQVFJfRVJSKGNzKTsKIAot
CSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oNCk7CisJLyogR2VuNyBvbmx5IHNvIG5vIG5l
ZWQgdG8gc3VwcG9ydCByZWxhdGl2ZSBvZmZzZXRzICovCisJKmNzKysgPSBfX01JX0xPQURfUkVH
SVNURVJfSU1NKDQpOwogCWZvciAoaSA9IDA7IGkgPCA0OyBpKyspIHsKIAkJKmNzKysgPSBpOTE1
X21taW9fcmVnX29mZnNldChHRU43X1NPX1dSSVRFX09GRlNFVChpKSk7CiAJCSpjcysrID0gMDsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lLmgKaW5kZXggZDNjNjk5M2Y0ZjQ2Li4w
OWQ3MjA4YjAxMjcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2Vu
Z2luZS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oCkBAIC01
MTEsNCArNTExLDkgQEAgdm9pZCBpbnRlbF9lbmdpbmVfaW5pdF9hY3RpdmUoc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lLAogI2RlZmluZSBFTkdJTkVfTU9DSwkxCiAjZGVmaW5lIEVOR0lO
RV9WSVJUVUFMCTIKIAorI2RlZmluZSBNSV9MT0FEX1JFR0lTVEVSX0lNTShlbmdpbmUsIGNvdW50
KQlcCisJCQkJCShlbmdpbmUpLT5nZXRfbHJpX2NtZCgoZW5naW5lKSwgKGNvdW50KSkKKwordTMy
IGk5MTVfZ2V0X2xyaV9yZWcoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBp
OTE1X3JlZ190IHJlZyk7CisKICNlbmRpZiAvKiBfSU5URUxfUklOR0JVRkZFUl9IXyAqLwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYwppbmRleCA4MjYzMGRiMDM5NGIu
LmVmZTFjMzc3ZDc5NyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
ZW5naW5lX2NzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2Nz
LmMKQEAgLTIzNiw2ICsyMzYsNDYgQEAgc3RhdGljIHUzMiBfX2VuZ2luZV9tbWlvX2Jhc2Uoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJcmV0dXJuIGJhc2VzW2ldLmJhc2U7CiB9CiAK
K3N0YXRpYyB1MzIgaTkxNV9nZXRfbHJpX2NtZF9sZWdhY3koY29uc3Qgc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lLAorCQkJCSAgIHUzMiB3b3JkX2NvdW50KQoreworCXJldHVybiBfX01J
X0xPQURfUkVHSVNURVJfSU1NKHdvcmRfY291bnQpOworfQorCitzdGF0aWMgdTMyIGk5MTVfZ2V0
X2xyaV9jbWRfYWRkX29mZnNldChjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUs
CisJCQkJICAgICAgIHUzMiB3b3JkX2NvdW50KQoreworCXJldHVybiBfX01JX0xPQURfUkVHSVNU
RVJfSU1NKHdvcmRfY291bnQpIHwKKwkgICAgICAgTUlfTFJJX0FERF9DU19NTUlPX1NUQVJUX0dF
TjExOworfQorCitzdGF0aWMgYm9vbCBpOTE1X2VuZ2luZV9oYXNfcmVsYXRpdmVfbHJpKGNvbnN0
IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlpZiAoSU5URUxfR0VOKGVuZ2lu
ZS0+aTkxNSkgPCAxMSkKKwkJcmV0dXJuIGZhbHNlOworCisJaWYgKGVuZ2luZS0+Y2xhc3MgPT0g
Q09QWV9FTkdJTkVfQ0xBU1MpCisJCXJldHVybiBmYWxzZTsKKworCXJldHVybiB0cnVlOworfQor
CitzdGF0aWMgdm9pZCBscmlfaW5pdChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7
CisJaWYgKGk5MTVfZW5naW5lX2hhc19yZWxhdGl2ZV9scmkoZW5naW5lKSkKKwkJZW5naW5lLT5n
ZXRfbHJpX2NtZCA9IGk5MTVfZ2V0X2xyaV9jbWRfYWRkX29mZnNldDsKKwllbHNlCisJCWVuZ2lu
ZS0+Z2V0X2xyaV9jbWQgPSBpOTE1X2dldF9scmlfY21kX2xlZ2FjeTsKK30KKwordTMyIGk5MTVf
Z2V0X2xyaV9yZWcoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBpOTE1X3Jl
Z190IHJlZykKK3sKKwlpZiAoIWk5MTVfZW5naW5lX2hhc19yZWxhdGl2ZV9scmkoZW5naW5lKSkK
KwkJcmV0dXJuIGk5MTVfbW1pb19yZWdfb2Zmc2V0KHJlZyk7CisKKwlyZXR1cm4gaTkxNV9tbWlv
X3JlZ19vZmZzZXQocmVnKSAtIGVuZ2luZS0+bW1pb19iYXNlOworfQorCiBzdGF0aWMgdm9pZCBf
X3NwcmludF9lbmdpbmVfbmFtZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7CiAJ
LyoKQEAgLTMyMCw2ICszNjAsOCBAQCBzdGF0aWMgaW50IGludGVsX2VuZ2luZV9zZXR1cChzdHJ1
Y3QgaW50ZWxfZ3QgKmd0LCBlbnVtIGludGVsX2VuZ2luZV9pZCBpZCkKIAkvKiBOb3RoaW5nIHRv
IGRvIGhlcmUsIGV4ZWN1dGUgaW4gb3JkZXIgb2YgZGVwZW5kZW5jaWVzICovCiAJZW5naW5lLT5z
Y2hlZHVsZSA9IE5VTEw7CiAKKwlscmlfaW5pdChlbmdpbmUpOworCiAJc2VxbG9ja19pbml0KCZl
bmdpbmUtPnN0YXRzLmxvY2spOwogCiAJQVRPTUlDX0lOSVRfTk9USUZJRVJfSEVBRCgmZW5naW5l
LT5jb250ZXh0X3N0YXR1c19ub3RpZmllcik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2VuZ2luZV90eXBlcy5oCmluZGV4IGE4MmNlYTk1YzJmMi4uN2NhNmM4NmEzM2Y2IDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaAorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaApAQCAtMzA2LDYg
KzMwNiw5IEBAIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgewogCXUzMiBjb250ZXh0X3NpemU7CiAJ
dTMyIG1taW9fYmFzZTsKIAorCXUzMiAoKmdldF9scmlfY21kKShjb25zdCBzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUsCisJCQkgICB1MzIgd29yZF9jb3VudCk7CisKIAl1MzIgdWFiaV9j
YXBhYmlsaXRpZXM7CiAKIAlzdHJ1Y3QgcmJfbm9kZSB1YWJpX25vZGU7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ncHVfY29tbWFuZHMuaCBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2dwdV9jb21tYW5kcy5oCmluZGV4IDg2ZTAwYTJkYjhhNC4uZWFh
MDE5ZGYwY2U3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ncHVf
Y29tbWFuZHMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ncHVfY29tbWFu
ZHMuaApAQCAtMTMwLDkgKzEzMCwxNSBAQAogICogICBzaW1wbHkgaWdub3JlcyB0aGUgcmVnaXN0
ZXIgbG9hZCB1bmRlciBjZXJ0YWluIGNvbmRpdGlvbnMuCiAgKiAtIE9uZSBjYW4gYWN0dWFsbHkg
bG9hZCBhcmJpdHJhcnkgbWFueSBhcmJpdHJhcnkgcmVnaXN0ZXJzOiBTaW1wbHkgaXNzdWUgeAog
ICogICBhZGRyZXNzL3ZhbHVlIHBhaXJzLiBEb24ndCBvdmVyZHVlIGl0LCB0aG91Z2gsIHggPD0g
Ml40IG11c3QgaG9sZCEKKyAqIC0gTmV3ZXIgaGFyZHdhcmUgc3VwcG9ydHMgZW5naW5lIHJlbGF0
aXZlIGFkZHJlc3NpbmcgYnV0IG9sZGVyIGhhcmR3YXJlIGRvZXMKKyAqICAgbm90LiBUaGlzIGlz
IHJlcXVpcmVkIGZvciBodyBlbmdpbmUgbG9hZCBiYWxhbmNpbmcuIEhlbmNlIHRoZSBNSV9MUkkK
KyAqICAgaW5zdHJ1Y3Rpb24gaXRzZWxmIGlzIHByZWZpeGVkIHdpdGggJ19fJyBhbmQgc2hvdWxk
IG9ubHkgYmUgdXNlZCBvbgorICogICBsZWdhY3kgaGFyZHdhcmUgY29kZSBwYXRocy4gR2VuZXJp
YyBjb2RlIG11c3QgYWx3YXlzIHVzZSB0aGUgTUlfTFJJCisgKiAgIGFuZCBpOTE1X2dldF9scmlf
cmVnKCkgaGVscGVyIGZ1bmN0aW9ucyBpbnN0ZWFkLgogICovCi0jZGVmaW5lIE1JX0xPQURfUkVH
SVNURVJfSU1NKHgpCU1JX0lOU1RSKDB4MjIsIDIqKHgpLTEpCisjZGVmaW5lIF9fTUlfTE9BRF9S
RUdJU1RFUl9JTU0oeCkJTUlfSU5TVFIoMHgyMiwgMiooeCktMSkKICNkZWZpbmUgICBNSV9MUklf
Rk9SQ0VfUE9TVEVECQkoMTw8MTIpCisjZGVmaW5lICAgTUlfTFJJX0FERF9DU19NTUlPX1NUQVJU
X0dFTjExCSgxPDwxOSkKICNkZWZpbmUgTUlfU1RPUkVfUkVHSVNURVJfTUVNICAgICAgICBNSV9J
TlNUUigweDI0LCAxKQogI2RlZmluZSBNSV9TVE9SRV9SRUdJU1RFUl9NRU1fR0VOOCAgIE1JX0lO
U1RSKDB4MjQsIDIpCiAjZGVmaW5lICAgTUlfU1JNX0xSTV9HTE9CQUxfR1RUCQkoMTw8MjIpCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCmluZGV4IGQ0MjU4NDQzOWY1MS4uZTE1NDc4Njgx
NGJjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwpAQCAtMTkwMiwxNCArMTkwMiwx
NSBAQCBzdGF0aWMgaW50IGVtaXRfcGRwcyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIAkJcmV0
dXJuIFBUUl9FUlIoY3MpOwogCiAJLyogRW5zdXJlIHRoZSBMUkkgaGF2ZSBsYW5kZWQgYmVmb3Jl
IHdlIGludmFsaWRhdGUgJiBjb250aW51ZSAqLwotCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9J
TU0oMiAqIEdFTjhfM0xWTF9QRFBFUykgfCBNSV9MUklfRk9SQ0VfUE9TVEVEOworCSpjcysrID0g
TUlfTE9BRF9SRUdJU1RFUl9JTU0oZW5naW5lLCAyICogR0VOOF8zTFZMX1BEUEVTKSB8CisJCQkJ
IE1JX0xSSV9GT1JDRV9QT1NURUQ7CiAJZm9yIChpID0gR0VOOF8zTFZMX1BEUEVTOyBpLS07ICkg
ewogCQljb25zdCBkbWFfYWRkcl90IHBkX2RhZGRyID0gaTkxNV9wYWdlX2Rpcl9kbWFfYWRkcihw
cGd0dCwgaSk7CiAJCXUzMiBiYXNlID0gZW5naW5lLT5tbWlvX2Jhc2U7CiAKLQkJKmNzKysgPSBp
OTE1X21taW9fcmVnX29mZnNldChHRU44X1JJTkdfUERQX1VEVyhiYXNlLCBpKSk7CisJCSpjcysr
ID0gaTkxNV9nZXRfbHJpX3JlZyhlbmdpbmUsIEdFTjhfUklOR19QRFBfVURXKGJhc2UsIGkpKTsK
IAkJKmNzKysgPSB1cHBlcl8zMl9iaXRzKHBkX2RhZGRyKTsKLQkJKmNzKysgPSBpOTE1X21taW9f
cmVnX29mZnNldChHRU44X1JJTkdfUERQX0xEVyhiYXNlLCBpKSk7CisJCSpjcysrID0gaTkxNV9n
ZXRfbHJpX3JlZyhlbmdpbmUsIEdFTjhfUklOR19QRFBfTERXKGJhc2UsIGkpKTsKIAkJKmNzKysg
PSBsb3dlcl8zMl9iaXRzKHBkX2RhZGRyKTsKIAl9CiAJKmNzKysgPSBNSV9OT09QOwpAQCAtMTk4
NCw3ICsxOTg1LDggQEAgZ2VuOF9lbWl0X2ZsdXNoX2NvaGVyZW50bDNfd2Eoc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lLCB1MzIgKmJhdGNoKQogCQkJCQkgICBJTlRFTF9HVF9TQ1JBVENI
X0ZJRUxEX0NPSEVSRU5UTDNfV0EpOwogCSpiYXRjaCsrID0gMDsKIAotCSpiYXRjaCsrID0gTUlf
TE9BRF9SRUdJU1RFUl9JTU0oMSk7CisJLyogR2VuOC85IG9ubHkgc28gbm8gbmVlZCB0byBzdXBw
b3J0IHJlbGF0aXZlIG9mZnNldHMgKi8KKwkqYmF0Y2grKyA9IF9fTUlfTE9BRF9SRUdJU1RFUl9J
TU0oMSk7CiAJKmJhdGNoKysgPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X0wzU1FDUkVHNCk7
CiAJKmJhdGNoKysgPSAweDQwNDAwMDAwIHwgR0VOOF9MUVNDX0ZMVVNIX0NPSEVSRU5UX0xJTkVT
OwogCkBAIC0yMDYxLDEzICsyMDYzLDE0IEBAIHN0cnVjdCBscmkgewogCXUzMiB2YWx1ZTsKIH07
CiAKLXN0YXRpYyB1MzIgKmVtaXRfbHJpKHUzMiAqYmF0Y2gsIGNvbnN0IHN0cnVjdCBscmkgKmxy
aSwgdW5zaWduZWQgaW50IGNvdW50KQorc3RhdGljIHUzMiAqZW1pdF9scmkoc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lLCB1MzIgKmJhdGNoLAorCQkgICAgIGNvbnN0IHN0cnVjdCBscmkg
KmxyaSwgdW5zaWduZWQgaW50IGNvdW50KQogewogCUdFTV9CVUdfT04oIWNvdW50IHx8IGNvdW50
ID4gNjMpOwogCi0JKmJhdGNoKysgPSBNSV9MT0FEX1JFR0lTVEVSX0lNTShjb3VudCk7CisJKmJh
dGNoKysgPSBNSV9MT0FEX1JFR0lTVEVSX0lNTShlbmdpbmUsIGNvdW50KTsKIAlkbyB7Ci0JCSpi
YXRjaCsrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQobHJpLT5yZWcpOworCQkqYmF0Y2grKyA9IGk5
MTVfZ2V0X2xyaV9yZWcoZW5naW5lLCBscmktPnJlZyk7CiAJCSpiYXRjaCsrID0gbHJpLT52YWx1
ZTsKIAl9IHdoaWxlIChscmkrKywgLS1jb3VudCk7CiAJKmJhdGNoKysgPSBNSV9OT09QOwpAQCAt
MjEwNSw3ICsyMTA4LDcgQEAgc3RhdGljIHUzMiAqZ2VuOV9pbml0X2luZGlyZWN0Y3R4X2JiKHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgdTMyICpiYXRjaCkKIAkvKiBXYUZsdXNoQ29o
ZXJlbnRMM0NhY2hlTGluZXNBdENvbnRleHRTd2l0Y2g6c2tsLGJ4dCxnbGsgKi8KIAliYXRjaCA9
IGdlbjhfZW1pdF9mbHVzaF9jb2hlcmVudGwzX3dhKGVuZ2luZSwgYmF0Y2gpOwogCi0JYmF0Y2gg
PSBlbWl0X2xyaShiYXRjaCwgbHJpLCBBUlJBWV9TSVpFKGxyaSkpOworCWJhdGNoID0gZW1pdF9s
cmkoZW5naW5lLCBiYXRjaCwgbHJpLCBBUlJBWV9TSVpFKGxyaSkpOwogCiAJLyogV2FNZWRpYVBv
b2xTdGF0ZUNtZEluV0FCQjpieHQsZ2xrICovCiAJaWYgKEhBU19QT09MRURfRVUoZW5naW5lLT5p
OTE1KSkgewpAQCAtMzE2OCwxMCArMzE3MSwxMCBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfaW5p
dF9yZWdfc3RhdGUodTMyICpyZWdzLAogCSAqCiAJICogTXVzdCBrZWVwIGNvbnNpc3RlbnQgd2l0
aCB2aXJ0dWFsX3VwZGF0ZV9yZWdpc3Rlcl9vZmZzZXRzKCkuCiAJICovCi0JcmVnc1tDVFhfTFJJ
X0hFQURFUl8wXSA9IE1JX0xPQURfUkVHSVNURVJfSU1NKHJjcyA/IDE0IDogMTEpIHwKKwlyZWdz
W0NUWF9MUklfSEVBREVSXzBdID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oZW5naW5lLCByY3MgPyAx
NCA6IDExKSB8CiAJCQkJIE1JX0xSSV9GT1JDRV9QT1NURUQ7CiAKLQlDVFhfUkVHKHJlZ3MsIENU
WF9DT05URVhUX0NPTlRST0wsIFJJTkdfQ09OVEVYVF9DT05UUk9MKGJhc2UpLAorCUNUWF9SRUco
ZW5naW5lLCByZWdzLCBDVFhfQ09OVEVYVF9DT05UUk9MLCBSSU5HX0NPTlRFWFRfQ09OVFJPTChi
YXNlKSwKIAkJX01BU0tFRF9CSVRfRElTQUJMRShDVFhfQ1RSTF9FTkdJTkVfQ1RYX1JFU1RPUkVf
SU5ISUJJVCkgfAogCQlfTUFTS0VEX0JJVF9FTkFCTEUoQ1RYX0NUUkxfSU5ISUJJVF9TWU5fQ1RY
X1NXSVRDSCkpOwogCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA8IDExKSB7CkBAIC0zMTc5
LDIyICszMTgyLDIzIEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19pbml0X3JlZ19zdGF0ZSh1MzIg
KnJlZ3MsCiAJCQlfTUFTS0VEX0JJVF9ESVNBQkxFKENUWF9DVFJMX0VOR0lORV9DVFhfU0FWRV9J
TkhJQklUIHwKIAkJCQkJICAgIENUWF9DVFJMX1JTX0NUWF9FTkFCTEUpOwogCX0KLQlDVFhfUkVH
KHJlZ3MsIENUWF9SSU5HX0hFQUQsIFJJTkdfSEVBRChiYXNlKSwgMCk7Ci0JQ1RYX1JFRyhyZWdz
LCBDVFhfUklOR19UQUlMLCBSSU5HX1RBSUwoYmFzZSksIDApOwotCUNUWF9SRUcocmVncywgQ1RY
X1JJTkdfQlVGRkVSX1NUQVJULCBSSU5HX1NUQVJUKGJhc2UpLCAwKTsKLQlDVFhfUkVHKHJlZ3Ms
IENUWF9SSU5HX0JVRkZFUl9DT05UUk9MLCBSSU5HX0NUTChiYXNlKSwKKwlDVFhfUkVHKGVuZ2lu
ZSwgcmVncywgQ1RYX1JJTkdfSEVBRCwgUklOR19IRUFEKGJhc2UpLCAwKTsKKwlDVFhfUkVHKGVu
Z2luZSwgcmVncywgQ1RYX1JJTkdfVEFJTCwgUklOR19UQUlMKGJhc2UpLCAwKTsKKwlDVFhfUkVH
KGVuZ2luZSwgcmVncywgQ1RYX1JJTkdfQlVGRkVSX1NUQVJULCBSSU5HX1NUQVJUKGJhc2UpLCAw
KTsKKwlDVFhfUkVHKGVuZ2luZSwgcmVncywgQ1RYX1JJTkdfQlVGRkVSX0NPTlRST0wsIFJJTkdf
Q1RMKGJhc2UpLAogCQlSSU5HX0NUTF9TSVpFKHJpbmctPnNpemUpIHwgUklOR19WQUxJRCk7Ci0J
Q1RYX1JFRyhyZWdzLCBDVFhfQkJfSEVBRF9VLCBSSU5HX0JCQUREUl9VRFcoYmFzZSksIDApOwot
CUNUWF9SRUcocmVncywgQ1RYX0JCX0hFQURfTCwgUklOR19CQkFERFIoYmFzZSksIDApOwotCUNU
WF9SRUcocmVncywgQ1RYX0JCX1NUQVRFLCBSSU5HX0JCU1RBVEUoYmFzZSksIFJJTkdfQkJfUFBH
VFQpOwotCUNUWF9SRUcocmVncywgQ1RYX1NFQ09ORF9CQl9IRUFEX1UsIFJJTkdfU0JCQUREUl9V
RFcoYmFzZSksIDApOwotCUNUWF9SRUcocmVncywgQ1RYX1NFQ09ORF9CQl9IRUFEX0wsIFJJTkdf
U0JCQUREUihiYXNlKSwgMCk7Ci0JQ1RYX1JFRyhyZWdzLCBDVFhfU0VDT05EX0JCX1NUQVRFLCBS
SU5HX1NCQlNUQVRFKGJhc2UpLCAwKTsKKwlDVFhfUkVHKGVuZ2luZSwgcmVncywgQ1RYX0JCX0hF
QURfVSwgUklOR19CQkFERFJfVURXKGJhc2UpLCAwKTsKKwlDVFhfUkVHKGVuZ2luZSwgcmVncywg
Q1RYX0JCX0hFQURfTCwgUklOR19CQkFERFIoYmFzZSksIDApOworCUNUWF9SRUcoZW5naW5lLCBy
ZWdzLCBDVFhfQkJfU1RBVEUsIFJJTkdfQkJTVEFURShiYXNlKSwgUklOR19CQl9QUEdUVCk7CisJ
Q1RYX1JFRyhlbmdpbmUsIHJlZ3MsIENUWF9TRUNPTkRfQkJfSEVBRF9VLCBSSU5HX1NCQkFERFJf
VURXKGJhc2UpLCAwKTsKKwlDVFhfUkVHKGVuZ2luZSwgcmVncywgQ1RYX1NFQ09ORF9CQl9IRUFE
X0wsIFJJTkdfU0JCQUREUihiYXNlKSwgMCk7CisJQ1RYX1JFRyhlbmdpbmUsIHJlZ3MsIENUWF9T
RUNPTkRfQkJfU1RBVEUsIFJJTkdfU0JCU1RBVEUoYmFzZSksIDApOwogCWlmIChyY3MpIHsKIAkJ
c3RydWN0IGk5MTVfY3R4X3dvcmthcm91bmRzICp3YV9jdHggPSAmZW5naW5lLT53YV9jdHg7CiAK
LQkJQ1RYX1JFRyhyZWdzLCBDVFhfUkNTX0lORElSRUNUX0NUWCwgUklOR19JTkRJUkVDVF9DVFgo
YmFzZSksIDApOwotCQlDVFhfUkVHKHJlZ3MsIENUWF9SQ1NfSU5ESVJFQ1RfQ1RYX09GRlNFVCwK
KwkJQ1RYX1JFRyhlbmdpbmUsIHJlZ3MsIENUWF9SQ1NfSU5ESVJFQ1RfQ1RYLAorCQkJUklOR19J
TkRJUkVDVF9DVFgoYmFzZSksIDApOworCQlDVFhfUkVHKGVuZ2luZSwgcmVncywgQ1RYX1JDU19J
TkRJUkVDVF9DVFhfT0ZGU0VULAogCQkJUklOR19JTkRJUkVDVF9DVFhfT0ZGU0VUKGJhc2UpLCAw
KTsKIAkJaWYgKHdhX2N0eC0+aW5kaXJlY3RfY3R4LnNpemUpIHsKIAkJCXUzMiBnZ3R0X29mZnNl
dCA9IGk5MTVfZ2d0dF9vZmZzZXQod2FfY3R4LT52bWEpOwpAQCAtMzIwNyw3ICszMjExLDggQEAg
c3RhdGljIHZvaWQgZXhlY2xpc3RzX2luaXRfcmVnX3N0YXRlKHUzMiAqcmVncywKIAkJCQlpbnRl
bF9scl9pbmRpcmVjdF9jdHhfb2Zmc2V0KGVuZ2luZSkgPDwgNjsKIAkJfQogCi0JCUNUWF9SRUco
cmVncywgQ1RYX0JCX1BFUl9DVFhfUFRSLCBSSU5HX0JCX1BFUl9DVFhfUFRSKGJhc2UpLCAwKTsK
KwkJQ1RYX1JFRyhlbmdpbmUsIHJlZ3MsIENUWF9CQl9QRVJfQ1RYX1BUUiwKKwkJCVJJTkdfQkJf
UEVSX0NUWF9QVFIoYmFzZSksIDApOwogCQlpZiAod2FfY3R4LT5wZXJfY3R4LnNpemUpIHsKIAkJ
CXUzMiBnZ3R0X29mZnNldCA9IGk5MTVfZ2d0dF9vZmZzZXQod2FfY3R4LT52bWEpOwogCkBAIC0z
MjE2LDE4ICszMjIxLDE5IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19pbml0X3JlZ19zdGF0ZSh1
MzIgKnJlZ3MsCiAJCX0KIAl9CiAKLQlyZWdzW0NUWF9MUklfSEVBREVSXzFdID0gTUlfTE9BRF9S
RUdJU1RFUl9JTU0oOSkgfCBNSV9MUklfRk9SQ0VfUE9TVEVEOworCXJlZ3NbQ1RYX0xSSV9IRUFE
RVJfMV0gPSBNSV9MT0FEX1JFR0lTVEVSX0lNTShlbmdpbmUsIDkpIHwKKwkJCQkgTUlfTFJJX0ZP
UkNFX1BPU1RFRDsKIAotCUNUWF9SRUcocmVncywgQ1RYX0NUWF9USU1FU1RBTVAsIFJJTkdfQ1RY
X1RJTUVTVEFNUChiYXNlKSwgMCk7CisJQ1RYX1JFRyhlbmdpbmUsIHJlZ3MsIENUWF9DVFhfVElN
RVNUQU1QLCBSSU5HX0NUWF9USU1FU1RBTVAoYmFzZSksIDApOwogCS8qIFBEUCB2YWx1ZXMgd2Vs
bCBiZSBhc3NpZ25lZCBsYXRlciBpZiBuZWVkZWQgKi8KLQlDVFhfUkVHKHJlZ3MsIENUWF9QRFAz
X1VEVywgR0VOOF9SSU5HX1BEUF9VRFcoYmFzZSwgMyksIDApOwotCUNUWF9SRUcocmVncywgQ1RY
X1BEUDNfTERXLCBHRU44X1JJTkdfUERQX0xEVyhiYXNlLCAzKSwgMCk7Ci0JQ1RYX1JFRyhyZWdz
LCBDVFhfUERQMl9VRFcsIEdFTjhfUklOR19QRFBfVURXKGJhc2UsIDIpLCAwKTsKLQlDVFhfUkVH
KHJlZ3MsIENUWF9QRFAyX0xEVywgR0VOOF9SSU5HX1BEUF9MRFcoYmFzZSwgMiksIDApOwotCUNU
WF9SRUcocmVncywgQ1RYX1BEUDFfVURXLCBHRU44X1JJTkdfUERQX1VEVyhiYXNlLCAxKSwgMCk7
Ci0JQ1RYX1JFRyhyZWdzLCBDVFhfUERQMV9MRFcsIEdFTjhfUklOR19QRFBfTERXKGJhc2UsIDEp
LCAwKTsKLQlDVFhfUkVHKHJlZ3MsIENUWF9QRFAwX1VEVywgR0VOOF9SSU5HX1BEUF9VRFcoYmFz
ZSwgMCksIDApOwotCUNUWF9SRUcocmVncywgQ1RYX1BEUDBfTERXLCBHRU44X1JJTkdfUERQX0xE
VyhiYXNlLCAwKSwgMCk7CisJQ1RYX1JFRyhlbmdpbmUsIHJlZ3MsIENUWF9QRFAzX1VEVywgR0VO
OF9SSU5HX1BEUF9VRFcoYmFzZSwgMyksIDApOworCUNUWF9SRUcoZW5naW5lLCByZWdzLCBDVFhf
UERQM19MRFcsIEdFTjhfUklOR19QRFBfTERXKGJhc2UsIDMpLCAwKTsKKwlDVFhfUkVHKGVuZ2lu
ZSwgcmVncywgQ1RYX1BEUDJfVURXLCBHRU44X1JJTkdfUERQX1VEVyhiYXNlLCAyKSwgMCk7CisJ
Q1RYX1JFRyhlbmdpbmUsIHJlZ3MsIENUWF9QRFAyX0xEVywgR0VOOF9SSU5HX1BEUF9MRFcoYmFz
ZSwgMiksIDApOworCUNUWF9SRUcoZW5naW5lLCByZWdzLCBDVFhfUERQMV9VRFcsIEdFTjhfUklO
R19QRFBfVURXKGJhc2UsIDEpLCAwKTsKKwlDVFhfUkVHKGVuZ2luZSwgcmVncywgQ1RYX1BEUDFf
TERXLCBHRU44X1JJTkdfUERQX0xEVyhiYXNlLCAxKSwgMCk7CisJQ1RYX1JFRyhlbmdpbmUsIHJl
Z3MsIENUWF9QRFAwX1VEVywgR0VOOF9SSU5HX1BEUF9VRFcoYmFzZSwgMCksIDApOworCUNUWF9S
RUcoZW5naW5lLCByZWdzLCBDVFhfUERQMF9MRFcsIEdFTjhfUklOR19QRFBfTERXKGJhc2UsIDAp
LCAwKTsKIAogCWlmIChpOTE1X3ZtX2lzXzRsdmwoJnBwZ3R0LT52bSkpIHsKIAkJLyogNjRiIFBQ
R1RUICg0OGJpdCBjYW5vbmljYWwpCkBAIC0zMjQzLDggKzMyNDksOSBAQCBzdGF0aWMgdm9pZCBl
eGVjbGlzdHNfaW5pdF9yZWdfc3RhdGUodTMyICpyZWdzLAogCX0KIAogCWlmIChyY3MpIHsKLQkJ
cmVnc1tDVFhfTFJJX0hFQURFUl8yXSA9IE1JX0xPQURfUkVHSVNURVJfSU1NKDEpOwotCQlDVFhf
UkVHKHJlZ3MsIENUWF9SX1BXUl9DTEtfU1RBVEUsIEdFTjhfUl9QV1JfQ0xLX1NUQVRFLCAwKTsK
KwkJcmVnc1tDVFhfTFJJX0hFQURFUl8yXSA9IE1JX0xPQURfUkVHSVNURVJfSU1NKGVuZ2luZSwg
MSk7CisJCUNUWF9SRUcoZW5naW5lLCByZWdzLCBDVFhfUl9QV1JfQ0xLX1NUQVRFLAorCQkJR0VO
OF9SX1BXUl9DTEtfU1RBVEUsIDApOwogCX0KIAogCXJlZ3NbQ1RYX0VORF0gPSBNSV9CQVRDSF9C
VUZGRVJfRU5EOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJj
X3JlZy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjX3JlZy5oCmluZGV4IGI4
ZjIwYWQ3MTE2OS4uZTU2YTI3Njk3YjZmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9scmNfcmVnLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
bHJjX3JlZy5oCkBAIC0zOSwxMCArMzksMTAgQEAKICNkZWZpbmUgQ1RYX1JfUFdSX0NMS19TVEFU
RQkJMHg0MgogI2RlZmluZSBDVFhfRU5ECQkJCTB4NDQKIAotI2RlZmluZSBDVFhfUkVHKHJlZ19z
dGF0ZSwgcG9zLCByZWcsIHZhbCkgZG8geyBcCisjZGVmaW5lIENUWF9SRUcoZW5naW5lLCByZWdf
c3RhdGUsIHBvcywgcmVnLCB2YWwpIGRvIHsgXAogCXUzMiAqcmVnX3N0YXRlX18gPSAocmVnX3N0
YXRlKTsgXAogCWNvbnN0IHUzMiBwb3NfXyA9IChwb3MpOyBcCi0JKHJlZ19zdGF0ZV9fKVsocG9z
X18pICsgMF0gPSBpOTE1X21taW9fcmVnX29mZnNldChyZWcpOyBcCisJKHJlZ19zdGF0ZV9fKVso
cG9zX18pICsgMF0gPSBpOTE1X2dldF9scmlfcmVnKChlbmdpbmUpLCAocmVnKSk7IFwKIAkocmVn
X3N0YXRlX18pWyhwb3NfXykgKyAxXSA9ICh2YWwpOyBcCiB9IHdoaWxlICgwKQogCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9tb2NzLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9tb2NzLmMKaW5kZXggNzI4NzA0YmJiZTE4Li5iYTI5YTBiZGFlMjgg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX21vY3MuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9tb2NzLmMKQEAgLTM2OCw5ICszNjgsNiBAQCBz
dGF0aWMgdTMyIGdldF9lbnRyeV9jb250cm9sKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9tb2NzX3Rh
YmxlICp0YWJsZSwKIC8qKgogICogaW50ZWxfbW9jc19pbml0X2VuZ2luZSgpIC0gZW1pdCB0aGUg
bW9jcyBjb250cm9sIHRhYmxlCiAgKiBAZW5naW5lOglUaGUgZW5naW5lIGZvciB3aG9tIHRvIGVt
aXQgdGhlIHJlZ2lzdGVycy4KLSAqCi0gKiBUaGlzIGZ1bmN0aW9uIHNpbXBseSBlbWl0cyBhIE1J
X0xPQURfUkVHSVNURVJfSU1NIGNvbW1hbmQgZm9yIHRoZQotICogZ2l2ZW4gdGFibGUgc3RhcnRp
bmcgYXQgdGhlIGdpdmVuIGFkZHJlc3MuCiAgKi8KIHZvaWQgaW50ZWxfbW9jc19pbml0X2VuZ2lu
ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7CkBAIC00NTYsMTggKzQ1MywyMCBA
QCBzdGF0aWMgaW50IGVtaXRfbW9jc19jb250cm9sX3RhYmxlKHN0cnVjdCBpOTE1X3JlcXVlc3Qg
KnJxLAogCWlmIChJU19FUlIoY3MpKQogCQlyZXR1cm4gUFRSX0VSUihjcyk7CiAKLQkqY3MrKyA9
IE1JX0xPQURfUkVHSVNURVJfSU1NKHRhYmxlLT5uX2VudHJpZXMpOworCSpjcysrID0gTUlfTE9B
RF9SRUdJU1RFUl9JTU0ocnEtPmVuZ2luZSwgdGFibGUtPm5fZW50cmllcyk7CiAKIAlmb3IgKGlu
ZGV4ID0gMDsgaW5kZXggPCB0YWJsZS0+c2l6ZTsgaW5kZXgrKykgewogCQl1MzIgdmFsdWUgPSBn
ZXRfZW50cnlfY29udHJvbCh0YWJsZSwgaW5kZXgpOwogCi0JCSpjcysrID0gaTkxNV9tbWlvX3Jl
Z19vZmZzZXQobW9jc19yZWdpc3RlcihlbmdpbmUsIGluZGV4KSk7CisJCSpjcysrID0gaTkxNV9n
ZXRfbHJpX3JlZyhycS0+ZW5naW5lLAorCQkJCQkgbW9jc19yZWdpc3RlcihlbmdpbmUsIGluZGV4
KSk7CiAJCSpjcysrID0gdmFsdWU7CiAJfQogCiAJLyogQWxsIHJlbWFpbmluZyBlbnRyaWVzIGFy
ZSBhbHNvIHVudXNlZCAqLwogCWZvciAoOyBpbmRleCA8IHRhYmxlLT5uX2VudHJpZXM7IGluZGV4
KyspIHsKLQkJKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChtb2NzX3JlZ2lzdGVyKGVuZ2lu
ZSwgaW5kZXgpKTsKKwkJKmNzKysgPSBpOTE1X2dldF9scmlfcmVnKHJxLT5lbmdpbmUsCisJCQkJ
CSBtb2NzX3JlZ2lzdGVyKGVuZ2luZSwgaW5kZXgpKTsKIAkJKmNzKysgPSB1bnVzZWRfdmFsdWU7
CiAJfQogCkBAIC01MTQsNyArNTEzLDExIEBAIHN0YXRpYyBpbnQgZW1pdF9tb2NzX2wzY2NfdGFi
bGUoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCiAJaWYgKElTX0VSUihjcykpCiAJCXJldHVybiBQ
VFJfRVJSKGNzKTsKIAotCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0odGFibGUtPm5fZW50
cmllcyAvIDIpOworCS8qCisJICogR0VOOV9MTkNGQ01PQ1MgaXMgbm90IGVuZ2luZSByZWxhdGl2
ZSwgdGhlcmVmb3JlIHRoZXJlIGlzIG5vCisJICogbmVlZCBmb3IgcmVsYXRpdmUgYWRkcmVzc2lu
Zz8KKwkgKi8KKwkqY3MrKyA9IF9fTUlfTE9BRF9SRUdJU1RFUl9JTU0odGFibGUtPm5fZW50cmll
cyAvIDIpOwogCiAJZm9yIChpID0gMDsgaSA8IHRhYmxlLT5zaXplIC8gMjsgaSsrKSB7CiAJCXUx
NiBsb3cgPSBnZXRfZW50cnlfbDNjYyh0YWJsZSwgMiAqIGkpOwpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jCmluZGV4IDYwMWMxNjIzOWZkZi4uNTg5OTc5NTNlYTlh
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jCkBAIC0xNTM0
LDEyICsxNTM0LDEzIEBAIHN0YXRpYyBpbnQgbG9hZF9wZF9kaXIoc3RydWN0IGk5MTVfcmVxdWVz
dCAqcnEsIGNvbnN0IHN0cnVjdCBpOTE1X3BwZ3R0ICpwcGd0dCkKIAlpZiAoSVNfRVJSKGNzKSkK
IAkJcmV0dXJuIFBUUl9FUlIoY3MpOwogCi0JKmNzKysgPSBNSV9MT0FEX1JFR0lTVEVSX0lNTSgx
KTsKLQkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfUFBfRElSX0RDTFYoZW5naW5l
LT5tbWlvX2Jhc2UpKTsKKwkvKiBDYW4gdGhlc2Ugbm90IGJlIG1lcmdlZCBpbnRvIGEgc2luZ2xl
IExSST8/PyAqLworCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oZW5naW5lLCAxKTsKKwkq
Y3MrKyA9IGk5MTVfZ2V0X2xyaV9yZWcoZW5naW5lLCBSSU5HX1BQX0RJUl9EQ0xWKGVuZ2luZS0+
bW1pb19iYXNlKSk7CiAJKmNzKysgPSBQUF9ESVJfRENMVl8yRzsKIAotCSpjcysrID0gTUlfTE9B
RF9SRUdJU1RFUl9JTU0oMSk7Ci0JKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChSSU5HX1BQ
X0RJUl9CQVNFKGVuZ2luZS0+bW1pb19iYXNlKSk7CisJKmNzKysgPSBNSV9MT0FEX1JFR0lTVEVS
X0lNTShlbmdpbmUsIDEpOworCSpjcysrID0gaTkxNV9nZXRfbHJpX3JlZyhlbmdpbmUsIFJJTkdf
UFBfRElSX0JBU0UoZW5naW5lLT5tbWlvX2Jhc2UpKTsKIAkqY3MrKyA9IHB4X2Jhc2UocHBndHQt
PnBkKS0+Z2d0dF9vZmZzZXQgPDwgMTA7CiAKIAlpbnRlbF9yaW5nX2FkdmFuY2UocnEsIGNzKTsK
QEAgLTE2MDgsNyArMTYwOSwxMSBAQCBzdGF0aWMgaW5saW5lIGludCBtaV9zZXRfY29udGV4dChz
dHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgdTMyIGZsYWdzKQogCQlpZiAobnVtX2VuZ2luZXMpIHsK
IAkJCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKnNpZ25hbGxlcjsKIAotCQkJKmNzKysgPSBNSV9M
T0FEX1JFR0lTVEVSX0lNTShudW1fZW5naW5lcyk7CisJCQkvKgorCQkJICogTXVzdCB1c2UgYWJz
b2x1dGUgZW5naW5lIGFkZHJlc3MgYXMgdGhlIHJlZ2lzdGVyCisJCQkgKiB3cml0ZSBpcyB0YXJn
ZXRpbmcgYSBkaWZmZXJlbnQgZW5naW5lLgorCQkJICovCisJCQkqY3MrKyA9IF9fTUlfTE9BRF9S
RUdJU1RFUl9JTU0obnVtX2VuZ2luZXMpOwogCQkJZm9yX2VhY2hfZW5naW5lKHNpZ25hbGxlciwg
aTkxNSwgaWQpIHsKIAkJCQlpZiAoc2lnbmFsbGVyID09IGVuZ2luZSkKIAkJCQkJY29udGludWU7
CkBAIC0xNjYyLDcgKzE2NjcsMTEgQEAgc3RhdGljIGlubGluZSBpbnQgbWlfc2V0X2NvbnRleHQo
c3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsIHUzMiBmbGFncykKIAkJCXN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKnNpZ25hbGxlcjsKIAkJCWk5MTVfcmVnX3QgbGFzdF9yZWcgPSB7fTsgLyoga2VlcCBn
Y2MgcXVpZXQgKi8KIAotCQkJKmNzKysgPSBNSV9MT0FEX1JFR0lTVEVSX0lNTShudW1fZW5naW5l
cyk7CisJCQkvKgorCQkJICogTXVzdCB1c2UgYWJzb2x1dGUgZW5naW5lIGFkZHJlc3MgYXMgdGhl
IHJlZ2lzdGVyCisJCQkgKiB3cml0ZSBpcyB0YXJnZXRpbmcgYSBkaWZmZXJlbnQgZW5naW5lLgor
CQkJICovCisJCQkqY3MrKyA9IF9fTUlfTE9BRF9SRUdJU1RFUl9JTU0obnVtX2VuZ2luZXMpOwog
CQkJZm9yX2VhY2hfZW5naW5lKHNpZ25hbGxlciwgaTkxNSwgaWQpIHsKIAkJCQlpZiAoc2lnbmFs
bGVyID09IGVuZ2luZSkKIAkJCQkJY29udGludWU7CkBAIC0xNzA3LDkgKzE3MTYsOSBAQCBzdGF0
aWMgaW50IHJlbWFwX2wzX3NsaWNlKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCBpbnQgc2xpY2Up
CiAJICogaGVyZSBiZWNhdXNlIG5vIG90aGVyIGNvZGUgc2hvdWxkIGFjY2VzcyB0aGVzZSByZWdp
c3RlcnMgb3RoZXIgdGhhbgogCSAqIGF0IGluaXRpYWxpemF0aW9uIHRpbWUuCiAJICovCi0JKmNz
KysgPSBNSV9MT0FEX1JFR0lTVEVSX0lNTShHRU43X0wzTE9HX1NJWkUvNCk7CisJKmNzKysgPSBN
SV9MT0FEX1JFR0lTVEVSX0lNTShycS0+ZW5naW5lLCBHRU43X0wzTE9HX1NJWkUvNCk7CiAJZm9y
IChpID0gMDsgaSA8IEdFTjdfTDNMT0dfU0laRS80OyBpKyspIHsKLQkJKmNzKysgPSBpOTE1X21t
aW9fcmVnX29mZnNldChHRU43X0wzTE9HKHNsaWNlLCBpKSk7CisJCSpjcysrID0gaTkxNV9nZXRf
bHJpX3JlZyhycS0+ZW5naW5lLCBHRU43X0wzTE9HKHNsaWNlLCBpKSk7CiAJCSpjcysrID0gcmVt
YXBfaW5mb1tpXTsKIAl9CiAJKmNzKysgPSBNSV9OT09QOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfd29ya2Fyb3VuZHMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX3dvcmthcm91bmRzLmMKaW5kZXggMTI2YWIzNjY3OTE5Li40NDM2OTc5OGVjYzUg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3dvcmthcm91bmRzLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfd29ya2Fyb3VuZHMuYwpAQCAtNjM4
LDkgKzYzOCw5IEBAIGludCBpbnRlbF9lbmdpbmVfZW1pdF9jdHhfd2Eoc3RydWN0IGk5MTVfcmVx
dWVzdCAqcnEpCiAJaWYgKElTX0VSUihjcykpCiAJCXJldHVybiBQVFJfRVJSKGNzKTsKIAotCSpj
cysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0od2FsLT5jb3VudCk7CisJKmNzKysgPSBNSV9MT0FE
X1JFR0lTVEVSX0lNTShycS0+ZW5naW5lLCB3YWwtPmNvdW50KTsKIAlmb3IgKGkgPSAwLCB3YSA9
IHdhbC0+bGlzdDsgaSA8IHdhbC0+Y291bnQ7IGkrKywgd2ErKykgewotCQkqY3MrKyA9IGk5MTVf
bW1pb19yZWdfb2Zmc2V0KHdhLT5yZWcpOworCQkqY3MrKyA9IGk5MTVfZ2V0X2xyaV9yZWcocnEt
PmVuZ2luZSwgd2EtPnJlZyk7CiAJCSpjcysrID0gd2EtPnZhbDsKIAl9CiAJKmNzKysgPSBNSV9O
T09QOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rfd29ya2Fy
b3VuZHMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMK
aW5kZXggZDA2ZDY4YWMyYTNiLi5jMzFlYTAyYWI5MWMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Qvc2VsZnRlc3Rfd29ya2Fyb3VuZHMuYwpAQCAtNDgwLDYgKzQ4MCw4IEBAIHN0YXRp
YyBpbnQgY2hlY2tfZGlydHlfd2hpdGVsaXN0KHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgs
CiAKIAlmb3IgKGkgPSAwOyBpIDwgZW5naW5lLT53aGl0ZWxpc3QuY291bnQ7IGkrKykgewogCQl1
MzIgcmVnID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoZW5naW5lLT53aGl0ZWxpc3QubGlzdFtpXS5y
ZWcpOworCQl1MzIgcmVnTFJJID0gaTkxNV9nZXRfbHJpX3JlZyhlbmdpbmUsCisJCQkJCSAgICAg
IGVuZ2luZS0+d2hpdGVsaXN0Lmxpc3RbaV0ucmVnKTsKIAkJdTY0IGFkZHIgPSBzY3JhdGNoLT5u
b2RlLnN0YXJ0OwogCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKIAkJdTMyIHNybSwgbHJtLCBy
c3ZkOwpAQCAtNTE1LDggKzUxNyw4IEBAIHN0YXRpYyBpbnQgY2hlY2tfZGlydHlfd2hpdGVsaXN0
KHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsCiAJCWlkeCA9IDE7CiAJCWZvciAodiA9IDA7
IHYgPCBBUlJBWV9TSVpFKHZhbHVlcyk7IHYrKykgewogCQkJLyogTFJJIGdhcmJhZ2UgKi8KLQkJ
CSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oMSk7Ci0JCQkqY3MrKyA9IHJlZzsKKwkJCSpj
cysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oZW5naW5lLCAxKTsKKwkJCSpjcysrID0gcmVnTFJJ
OwogCQkJKmNzKysgPSB2YWx1ZXNbdl07CiAKIAkJCS8qIFNSTSByZXN1bHQgKi8KQEAgLTUyOCw4
ICs1MzAsOCBAQCBzdGF0aWMgaW50IGNoZWNrX2RpcnR5X3doaXRlbGlzdChzdHJ1Y3QgaTkxNV9n
ZW1fY29udGV4dCAqY3R4LAogCQl9CiAJCWZvciAodiA9IDA7IHYgPCBBUlJBWV9TSVpFKHZhbHVl
cyk7IHYrKykgewogCQkJLyogTFJJIGdhcmJhZ2UgKi8KLQkJCSpjcysrID0gTUlfTE9BRF9SRUdJ
U1RFUl9JTU0oMSk7Ci0JCQkqY3MrKyA9IHJlZzsKKwkJCSpjcysrID0gTUlfTE9BRF9SRUdJU1RF
Ul9JTU0oZW5naW5lLCAxKTsKKwkJCSpjcysrID0gcmVnTFJJOwogCQkJKmNzKysgPSB+dmFsdWVz
W3ZdOwogCiAJCQkvKiBTUk0gcmVzdWx0ICovCkBAIC04MjMsOSArODI1LDEwIEBAIHN0YXRpYyBp
bnQgc2NydWJfd2hpdGVsaXN0ZWRfcmVnaXN0ZXJzKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpj
dHgsCiAJCWdvdG8gZXJyX2JhdGNoOwogCX0KIAotCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9J
TU0od2hpdGVsaXN0X3dyaXRhYmxlX2NvdW50KGVuZ2luZSkpOworCSpjcysrID0gTUlfTE9BRF9S
RUdJU1RFUl9JTU0oZW5naW5lLCB3aGl0ZWxpc3Rfd3JpdGFibGVfY291bnQoZW5naW5lKSk7CiAJ
Zm9yIChpID0gMDsgaSA8IGVuZ2luZS0+d2hpdGVsaXN0LmNvdW50OyBpKyspIHsKLQkJdTMyIHJl
ZyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KGVuZ2luZS0+d2hpdGVsaXN0Lmxpc3RbaV0ucmVnKTsK
KwkJdTMyIHJlZyA9IGk5MTVfZ2V0X2xyaV9yZWcoZW5naW5lLAorCQkJCQkgICBlbmdpbmUtPndo
aXRlbGlzdC5saXN0W2ldLnJlZyk7CiAKIAkJaWYgKHJvX3JlZ2lzdGVyKHJlZykpCiAJCQljb250
aW51ZTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9tbWlvX2NvbnRleHQu
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9tbWlvX2NvbnRleHQuYwppbmRleCA0MjA4ZTQw
NDQ1YjEuLmU0NGUxZDE0Mjg1YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0
L21taW9fY29udGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9tbWlvX2NvbnRl
eHQuYwpAQCAtMjEwLDE0ICsyMTAsMTQgQEAgcmVzdG9yZV9jb250ZXh0X21taW9fZm9yX2luaGli
aXQoc3RydWN0IGludGVsX3ZncHUgKnZncHUsCiAJaWYgKElTX0VSUihjcykpCiAJCXJldHVybiBQ
VFJfRVJSKGNzKTsKIAotCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oY291bnQpOworCSpj
cysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0ocmVxLT5lbmdpbmUsIGNvdW50KTsKIAlmb3IgKG1t
aW8gPSBndnQtPmVuZ2luZV9tbWlvX2xpc3QubW1pbzsKIAkgICAgIGk5MTVfbW1pb19yZWdfdmFs
aWQobW1pby0+cmVnKTsgbW1pbysrKSB7CiAJCWlmIChtbWlvLT5yaW5nX2lkICE9IHJpbmdfaWQg
fHwKIAkJICAgICFtbWlvLT5pbl9jb250ZXh0KQogCQkJY29udGludWU7CiAKLQkJKmNzKysgPSBp
OTE1X21taW9fcmVnX29mZnNldChtbWlvLT5yZWcpOworCQkqY3MrKyA9IGk5MTVfZ2V0X2xyaV9y
ZWcocmVxLT5lbmdpbmUsIG1taW8tPnJlZyk7CiAJCSpjcysrID0gdmdwdV92cmVnX3QodmdwdSwg
bW1pby0+cmVnKSB8CiAJCQkJKG1taW8tPm1hc2sgPDwgMTYpOwogCQlndnRfZGJnX2NvcmUoImFk
ZCBscmkgcmVnIHBhaXIgMHgleDoweCV4IGluIGluaGliaXQgY3R4LCB2Z3B1OiVkLCByaW5kX2lk
OiVkXG4iLApAQCAtMjQ1LDcgKzI0NSwxMSBAQCByZXN0b3JlX3JlbmRlcl9tb2NzX2NvbnRyb2xf
Zm9yX2luaGliaXQoc3RydWN0IGludGVsX3ZncHUgKnZncHUsCiAJaWYgKElTX0VSUihjcykpCiAJ
CXJldHVybiBQVFJfRVJSKGNzKTsKIAotCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oR0VO
OV9NT0NTX1NJWkUpOworCS8qCisJICogR0VOOV9HRlhfTU9DUyBpcyBub3QgZW5naW5lIHJlbGF0
aXZlLCB0aGVyZWZvcmUgdGhlcmUgaXMgbm8KKwkgKiBuZWVkIGZvciByZWxhdGl2ZSBhZGRyZXNz
aW5nLgorCSAqLworCSpjcysrID0gX19NSV9MT0FEX1JFR0lTVEVSX0lNTShHRU45X01PQ1NfU0la
RSk7CiAKIAlmb3IgKGluZGV4ID0gMDsgaW5kZXggPCBHRU45X01PQ1NfU0laRTsgaW5kZXgrKykg
ewogCQkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEdFTjlfR0ZYX01PQ1MoaW5kZXgpKTsK
QEAgLTI3Miw3ICsyNzYsMTEgQEAgcmVzdG9yZV9yZW5kZXJfbW9jc19sM2NjX2Zvcl9pbmhpYml0
KHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LAogCWlmIChJU19FUlIoY3MpKQogCQlyZXR1cm4gUFRS
X0VSUihjcyk7CiAKLQkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKEdFTjlfTU9DU19TSVpF
IC8gMik7CisJLyoKKwkgKiBHRU45X0xOQ0ZDTU9DUyBpcyBub3QgZW5naW5lIHJlbGF0aXZlLCB0
aGVyZWZvcmUgdGhlcmUgaXMgbm8KKwkgKiBuZWVkIGZvciByZWxhdGl2ZSBhZGRyZXNzaW5nLgor
CSAqLworCSpjcysrID0gX19NSV9MT0FEX1JFR0lTVEVSX0lNTShHRU45X01PQ1NfU0laRSAvIDIp
OwogCiAJZm9yIChpbmRleCA9IDA7IGluZGV4IDwgR0VOOV9NT0NTX1NJWkUgLyAyOyBpbmRleCsr
KSB7CiAJCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOV9MTkNGQ01PQ1MoaW5kZXgp
KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfY21kX3BhcnNlci5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9jbWRfcGFyc2VyLmMKaW5kZXggMjQ1NTUxMDJlMTk4
Li4xNWJhMDhhYjgxODAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfY21k
X3BhcnNlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfY21kX3BhcnNlci5jCkBA
IC0yMjIsNyArMjIyLDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1faTkxNV9jbWRfZGVzY3Jp
cHRvciBjb21tb25fY21kc1tdID0gewogCUNNRCggIE1JX1NVU1BFTkRfRkxVU0gsICAgICAgICAg
ICAgICAgICBTTUksICAgIEYsICAxLCAgICAgIFMgICksCiAJQ01EKCAgTUlfU0VNQVBIT1JFX01C
T1gsICAgICAgICAgICAgICAgIFNNSSwgICAhRiwgIDB4RkYsICAgUiAgKSwKIAlDTUQoICBNSV9T
VE9SRV9EV09SRF9JTkRFWCwgICAgICAgICAgICAgU01JLCAgICFGLCAgMHhGRiwgICBSICApLAot
CUNNRCggIE1JX0xPQURfUkVHSVNURVJfSU1NKDEpLCAgICAgICAgICBTTUksICAgIUYsICAweEZG
LCAgIFcsCisJQ01EKCAgX19NSV9MT0FEX1JFR0lTVEVSX0lNTSgxKSwgICAgICAgIFNNSSwgICAh
RiwgIDB4RkYsICAgVywKIAkgICAgICAucmVnID0geyAub2Zmc2V0ID0gMSwgLm1hc2sgPSAweDAw
N0ZGRkZDLCAuc3RlcCA9IDIgfSAgICApLAogCUNNRCggIE1JX1NUT1JFX1JFR0lTVEVSX01FTSwg
ICAgICAgICAgICBTTUksICAgIEYsICAzLCAgICAgVyB8IEIsCiAJICAgICAgLnJlZyA9IHsgLm9m
ZnNldCA9IDEsIC5tYXNrID0gMHgwMDdGRkZGQyB9LApAQCAtMTE4Myw4ICsxMTgzLDggQEAgc3Rh
dGljIGJvb2wgY2hlY2tfY21kKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwK
IAkJCQkJcmV0dXJuIGZhbHNlOwogCQkJCX0KIAotCQkJCWlmIChkZXNjLT5jbWQudmFsdWUgPT0g
TUlfTE9BRF9SRUdJU1RFUl9JTU0oMSkgJiYKLQkJCQkgICAgKG9mZnNldCArIDIgPiBsZW5ndGgg
fHwKKwkJCQlpZiAoZGVzYy0+Y21kLnZhbHVlID09IF9fTUlfTE9BRF9SRUdJU1RFUl9JTU0oMSkK
KwkJCQkgICAgJiYgKG9mZnNldCArIDIgPiBsZW5ndGggfHwKIAkJCQkgICAgIChjbWRbb2Zmc2V0
ICsgMV0gJiByZWctPm1hc2spICE9IHJlZy0+dmFsdWUpKSB7CiAJCQkJCURSTV9ERUJVR19EUklW
RVIoIkNNRDogUmVqZWN0ZWQgTFJJIHRvIG1hc2tlZCByZWdpc3RlciAweCUwOFhcbiIsCiAJCQkJ
CQkJIHJlZ19hZGRyKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVy
Zi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMKaW5kZXggZTQyYjg2ODI3ZDZi
Li44M2FiZGRhMDViYTIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVy
Zi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5jCkBAIC0xNjkyLDE3ICsx
NjkyLDIzIEBAIGdlbjhfdXBkYXRlX3JlZ19zdGF0ZV91bmxvY2tlZChzdHJ1Y3QgaTkxNV9wZXJm
X3N0cmVhbSAqc3RyZWFtLAogCX07CiAJaW50IGk7CiAKLQlDVFhfUkVHKHJlZ19zdGF0ZSwgY3R4
X29hY3R4Y3RybCwgR0VOOF9PQUNUWENPTlRST0wsCisJLyoKKwkgKiBOQjogVGhlIExSSSBpbnN0
cnVjdGlvbiBpcyBnZW5lcmF0ZWQgYnkgdGhlIGhhcmR3YXJlLgorCSAqIFNob3VsZCB3ZSByZWFk
IGl0IGluIGFuZCBhc3NlcnQgdGhhdCB0aGUgb2Zmc2V0IGZsYWcgaXMgc2V0PworCSAqLworCisJ
Q1RYX1JFRyhjZS0+ZW5naW5lLCByZWdfc3RhdGUsIGN0eF9vYWN0eGN0cmwsIEdFTjhfT0FDVFhD
T05UUk9MLAogCQkoc3RyZWFtLT5wZXJpb2RfZXhwb25lbnQgPDwgR0VOOF9PQV9USU1FUl9QRVJJ
T0RfU0hJRlQpIHwKIAkJKHN0cmVhbS0+cGVyaW9kaWMgPyBHRU44X09BX1RJTUVSX0VOQUJMRSA6
IDApIHwKIAkJR0VOOF9PQV9DT1VOVEVSX1JFU1VNRSk7CiAKIAlmb3IgKGkgPSAwOyBpIDwgQVJS
QVlfU0laRShmbGV4X3JlZ3MpOyBpKyspIHsKLQkJQ1RYX1JFRyhyZWdfc3RhdGUsIGN0eF9mbGV4
ZXUwICsgaSAqIDIsIGZsZXhfcmVnc1tpXSwKKwkJQ1RYX1JFRyhjZS0+ZW5naW5lLCByZWdfc3Rh
dGUsIGN0eF9mbGV4ZXUwICsgaSAqIDIsCisJCQlmbGV4X3JlZ3NbaV0sCiAJCQlvYV9jb25maWdf
ZmxleF9yZWcob2FfY29uZmlnLCBmbGV4X3JlZ3NbaV0pKTsKIAl9CiAKLQlDVFhfUkVHKHJlZ19z
dGF0ZSwKKwlDVFhfUkVHKGNlLT5lbmdpbmUsIHJlZ19zdGF0ZSwKIAkJQ1RYX1JfUFdSX0NMS19T
VEFURSwgR0VOOF9SX1BXUl9DTEtfU1RBVEUsCiAJCWludGVsX3NzZXVfbWFrZV9ycGNzKGk5MTUs
ICZjZS0+c3NldSkpOwogfQpAQCAtMTc1MSw5ICsxNzU3LDkgQEAgZ2VuOF9sb2FkX2ZsZXgoc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnEsCiAJaWYgKElTX0VSUihjcykpCiAJCXJldHVybiBQVFJfRVJS
KGNzKTsKIAotCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oY291bnQpOworCSpjcysrID0g
TUlfTE9BRF9SRUdJU1RFUl9JTU0ocnEtPmVuZ2luZSwgY291bnQpOwogCWRvIHsKLQkJKmNzKysg
PSBpOTE1X21taW9fcmVnX29mZnNldChmbGV4LT5yZWcpOworCQkqY3MrKyA9IGk5MTVfZ2V0X2xy
aV9yZWcocnEtPmVuZ2luZSwgZmxleC0+cmVnKTsKIAkJKmNzKysgPSBmbGV4LT52YWx1ZTsKIAl9
IHdoaWxlIChmbGV4KyssIC0tY291bnQpOwogCSpjcysrID0gTUlfTk9PUDsKLS0gCjIuMjEuMC41
LmdhZWI1ODJhOTgzCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5v
cmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1n
Zng=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id C72EDE0B17
	for <lists+intel-gfx@lfdr.de>; Tue, 22 Oct 2019 19:56:25 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F0D466E8BE;
	Tue, 22 Oct 2019 17:56:23 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga04.intel.com (mga04.intel.com [192.55.52.120])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 52C796E8BE
 for <intel-gfx@lists.freedesktop.org>; Tue, 22 Oct 2019 17:56:21 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga003.fm.intel.com ([10.253.24.29])
 by fmsmga104.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 22 Oct 2019 10:56:21 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.68,217,1569308400"; d="scan'208";a="203715486"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.174])
 by FMSMGA003.fm.intel.com with SMTP; 22 Oct 2019 10:56:19 -0700
Received: by stinkbox (sSMTP sendmail emulation);
 Tue, 22 Oct 2019 20:56:18 +0300
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 22 Oct 2019 20:55:54 +0300
Message-Id: <20191022175554.18012-9-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20191022175554.18012-1-ville.syrjala@linux.intel.com>
References: <20191022175554.18012-1-ville.syrjala@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 8/8] drm/i915: Have pfit calculations return an
 error code
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KCkNo
YW5nZSBpbnRlbF97Z21jaCxwY2h9X3BhbmVsX2ZpdHRpbmcoKSB0byByZXR1cm4gYSBub3JtYWwK
ZXJyb3IgdnMuIHN1Y2Nlc3MgaW50LiBXZSdsbCBuZWVkIHRoaXMgbGF0ZXIgdG8gdmFsaWRhdGUg
dGhhdAp0aGUgbWFyZ2luIHByb3BlcnRpZXMgYXJlbid0IG1pc2NvbmZpZ3VyZWQuCgpTaWduZWQt
b2ZmLWJ5OiBWaWxsZSBTeXJqw6Rsw6QgPHZpbGxlLnN5cmphbGFAbGludXguaW50ZWwuY29tPgot
LS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaWNsX2RzaS5jICAgICB8IDEwICsrKysr
KystLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHAuYyAgICB8IDEwICsr
KysrLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfaGRtaS5jICB8IDIy
ICsrKysrKysrKysrLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfbHZkcy5jICB8IDEzICsrKysrKysrLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfcGFuZWwuYyB8IDE5ICsrKysrKysrKysrLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfcGFuZWwuaCB8ICA2ICsrKy0tLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS92bHZfZHNpLmMgICAgIHwgIDYgKysrKy0tCiA3IGZpbGVzIGNoYW5nZWQs
IDQ5IGluc2VydGlvbnMoKyksIDM3IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaWNsX2RzaS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pY2xfZHNpLmMKaW5kZXggZDI1MmY2OGU1ZDA5Li4yMDEwYWQ5OTE4NzYgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaWNsX2RzaS5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaWNsX2RzaS5jCkBAIC0xMjY2LDEzICsxMjY2LDE3IEBAIHN0
YXRpYyBpbnQgZ2VuMTFfZHNpX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAogCQkJCQkJICAgYmFzZSk7CiAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqaW50ZWxf
Y29ubmVjdG9yID0gaW50ZWxfZHNpLT5hdHRhY2hlZF9jb25uZWN0b3I7CiAJY29uc3Qgc3RydWN0
IGRybV9kaXNwbGF5X21vZGUgKmZpeGVkX21vZGUgPQotCQkJCQlpbnRlbF9jb25uZWN0b3ItPnBh
bmVsLmZpeGVkX21vZGU7CisJCWludGVsX2Nvbm5lY3Rvci0+cGFuZWwuZml4ZWRfbW9kZTsKIAlz
dHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9Ci0JCQkJCSZwaXBlX2NvbmZp
Zy0+YmFzZS5hZGp1c3RlZF9tb2RlOworCQkmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9k
ZTsKKwlpbnQgcmV0OwogCiAJcGlwZV9jb25maWctPm91dHB1dF9mb3JtYXQgPSBJTlRFTF9PVVRQ
VVRfRk9STUFUX1JHQjsKIAlpbnRlbF9maXhlZF9wYW5lbF9tb2RlKGZpeGVkX21vZGUsIGFkanVz
dGVkX21vZGUpOwotCWludGVsX3BjaF9wYW5lbF9maXR0aW5nKHBpcGVfY29uZmlnLCBjb25uX3N0
YXRlKTsKKworCXJldCA9IGludGVsX3BjaF9wYW5lbF9maXR0aW5nKHBpcGVfY29uZmlnLCBjb25u
X3N0YXRlKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OwogCiAJYWRqdXN0ZWRfbW9kZS0+Zmxh
Z3MgPSAwOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2RwLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwLmMKaW5kZXggOGNh
MzViYTkxNzMxLi41MGNlYmQ1YmY4ZWIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZHAuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX2RwLmMKQEAgLTIyNTMsOSArMjI1Myw3IEBAIGludGVsX2RwX3ljYmNyNDIwX2NvbmZpZyhz
dHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAogCiAJY3J0Y19zdGF0ZS0+b3V0cHV0X2Zvcm1hdCA9
IElOVEVMX09VVFBVVF9GT1JNQVRfWUNCQ1I0MjA7CiAKLQlpbnRlbF9wY2hfcGFuZWxfZml0dGlu
ZyhjcnRjX3N0YXRlLCBjb25uX3N0YXRlKTsKLQotCXJldHVybiAwOworCXJldHVybiBpbnRlbF9w
Y2hfcGFuZWxfZml0dGluZyhjcnRjX3N0YXRlLCBjb25uX3N0YXRlKTsKIH0KIAogYm9vbCBpbnRl
bF9kcF9saW1pdGVkX2NvbG9yX3JhbmdlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLApAQCAtMjMzNCw5ICsyMzMyLDExIEBAIGludGVsX2RwX2NvbXB1dGVfY29uZmln
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJCSAgICAgICBhZGp1c3RlZF9tb2Rl
KTsKIAogCQlpZiAoSEFTX0dNQ0goZGV2X3ByaXYpKQotCQkJaW50ZWxfZ21jaF9wYW5lbF9maXR0
aW5nKHBpcGVfY29uZmlnLCBjb25uX3N0YXRlKTsKKwkJCXJldCA9IGludGVsX2dtY2hfcGFuZWxf
Zml0dGluZyhwaXBlX2NvbmZpZywgY29ubl9zdGF0ZSk7CiAJCWVsc2UKLQkJCWludGVsX3BjaF9w
YW5lbF9maXR0aW5nKHBpcGVfY29uZmlnLCBjb25uX3N0YXRlKTsKKwkJCXJldCA9IGludGVsX3Bj
aF9wYW5lbF9maXR0aW5nKHBpcGVfY29uZmlnLCBjb25uX3N0YXRlKTsKKwkJaWYgKHJldCkKKwkJ
CXJldHVybiByZXQ7CiAJfQogCiAJaWYgKGFkanVzdGVkX21vZGUtPmZsYWdzICYgRFJNX01PREVf
RkxBR19EQkxTQ0FOKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9oZG1pLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2hkbWkuYwpp
bmRleCA0MjZkZWM5Nzk5OTIuLmU5ZWYzOTY0YmU1YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9oZG1pLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF9oZG1pLmMKQEAgLTIyNzcsMjIgKzIyNzcsMjUgQEAgc3RhdGljIGJvb2wg
aGRtaV9kZWVwX2NvbG9yX3Bvc3NpYmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLAogCXJldHVybiB0cnVlOwogfQogCi1zdGF0aWMgYm9vbAorc3RhdGljIGludAog
aW50ZWxfaGRtaV95Y2JjcjQyMF9jb25maWcoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUsCiAJCQkgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0
ZSkKIHsKIAlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gY29ubl9zdGF0ZS0+Y29u
bmVjdG9yOworCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0K
KwkJJmNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZTsKKworCWlmICghZHJtX21vZGVfaXNf
NDIwX29ubHkoJmNvbm5lY3Rvci0+ZGlzcGxheV9pbmZvLCBhZGp1c3RlZF9tb2RlKSkKKwkJcmV0
dXJuIDA7CiAKIAlpZiAoIWNvbm5lY3Rvci0+eWNiY3JfNDIwX2FsbG93ZWQpIHsKIAkJRFJNX0VS
Uk9SKCJQbGF0Zm9ybSBkb2Vzbid0IHN1cHBvcnQgWUNCQ1I0MjAgb3V0cHV0XG4iKTsKLQkJcmV0
dXJuIGZhbHNlOworCQlyZXR1cm4gLUVJTlZBTDsKIAl9CiAKIAljcnRjX3N0YXRlLT5vdXRwdXRf
Zm9ybWF0ID0gSU5URUxfT1VUUFVUX0ZPUk1BVF9ZQ0JDUjQyMDsKIAotCWludGVsX3BjaF9wYW5l
bF9maXR0aW5nKGNydGNfc3RhdGUsIGNvbm5fc3RhdGUpOwotCi0JcmV0dXJuIHRydWU7CisJcmV0
dXJuIGludGVsX3BjaF9wYW5lbF9maXR0aW5nKGNydGNfc3RhdGUsIGNvbm5fc3RhdGUpOwogfQog
CiBzdGF0aWMgaW50IGludGVsX2hkbWlfcG9ydF9jbG9jayhpbnQgY2xvY2ssIGludCBicGMpCkBA
IC0yNDE5LDEyICsyNDIyLDkgQEAgaW50IGludGVsX2hkbWlfY29tcHV0ZV9jb25maWcoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJaWYgKGFkanVzdGVkX21vZGUtPmZsYWdzICYgRFJN
X01PREVfRkxBR19EQkxDTEspCiAJCXBpcGVfY29uZmlnLT5waXhlbF9tdWx0aXBsaWVyID0gMjsK
IAotCWlmIChkcm1fbW9kZV9pc180MjBfb25seSgmY29ubmVjdG9yLT5kaXNwbGF5X2luZm8sIGFk
anVzdGVkX21vZGUpKSB7Ci0JCWlmICghaW50ZWxfaGRtaV95Y2JjcjQyMF9jb25maWcocGlwZV9j
b25maWcsIGNvbm5fc3RhdGUpKSB7Ci0JCQlEUk1fRVJST1IoIkNhbid0IHN1cHBvcnQgWUNCQ1I0
MjAgb3V0cHV0XG4iKTsKLQkJCXJldHVybiAtRUlOVkFMOwotCQl9Ci0JfQorCXJldCA9IGludGVs
X2hkbWlfeWNiY3I0MjBfY29uZmlnKHBpcGVfY29uZmlnLCBjb25uX3N0YXRlKTsKKwlpZiAocmV0
KQorCQlyZXR1cm4gcmV0OwogCiAJcGlwZV9jb25maWctPmxpbWl0ZWRfY29sb3JfcmFuZ2UgPQog
CQlpbnRlbF9oZG1pX2xpbWl0ZWRfY29sb3JfcmFuZ2UocGlwZV9jb25maWcsIGNvbm5fc3RhdGUp
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9sdmRzLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2x2ZHMuYwppbmRleCAwM2U4ZGE3
Nzk3ZGMuLjc1MWFiYmM2M2RhYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9sdmRzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9sdmRzLmMKQEAgLTM5NSw2ICszOTUsNyBAQCBzdGF0aWMgaW50IGludGVsX2x2ZHNfY29tcHV0
ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIsCiAJc3RydWN0IGRy
bV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0
ZWRfbW9kZTsKIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMo
cGlwZV9jb25maWctPmJhc2UuY3J0Yyk7CiAJdW5zaWduZWQgaW50IGx2ZHNfYnBwOworCWludCBy
ZXQ7CiAKIAkvKiBTaG91bGQgbmV2ZXIgaGFwcGVuISEgKi8KIAlpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA8IDQgJiYgaW50ZWxfY3J0Yy0+cGlwZSA9PSAwKSB7CkBAIC00MjcsMTMgKzQyOCwxNSBA
QCBzdGF0aWMgaW50IGludGVsX2x2ZHNfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29k
ZXIgKmludGVsX2VuY29kZXIsCiAJaWYgKGFkanVzdGVkX21vZGUtPmZsYWdzICYgRFJNX01PREVf
RkxBR19EQkxTQ0FOKQogCQlyZXR1cm4gLUVJTlZBTDsKIAotCWlmIChIQVNfUENIX1NQTElUKGRl
dl9wcml2KSkgeworCWlmIChIQVNfUENIX1NQTElUKGRldl9wcml2KSkKIAkJcGlwZV9jb25maWct
Pmhhc19wY2hfZW5jb2RlciA9IHRydWU7CiAKLQkJaW50ZWxfcGNoX3BhbmVsX2ZpdHRpbmcocGlw
ZV9jb25maWcsIGNvbm5fc3RhdGUpOwotCX0gZWxzZSB7Ci0JCWludGVsX2dtY2hfcGFuZWxfZml0
dGluZyhwaXBlX2NvbmZpZywgY29ubl9zdGF0ZSk7Ci0JfQorCWlmIChIQVNfR01DSChkZXZfcHJp
dikpCisJCXJldCA9IGludGVsX2dtY2hfcGFuZWxfZml0dGluZyhwaXBlX2NvbmZpZywgY29ubl9z
dGF0ZSk7CisJZWxzZQorCQlyZXQgPSBpbnRlbF9wY2hfcGFuZWxfZml0dGluZyhwaXBlX2NvbmZp
ZywgY29ubl9zdGF0ZSk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKIAogCS8qCiAJICogWFhY
OiBJdCB3b3VsZCBiZSBuaWNlIHRvIHN1cHBvcnQgbG93ZXIgcmVmcmVzaCByYXRlcyBvbiB0aGUK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcGFuZWwuYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcGFuZWwuYwppbmRleCAyOTgxZDE3
NTE4NzcuLjVhOGI1YTc0NzU3OSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9wYW5lbC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfcGFuZWwuYwpAQCAtMTczLDkgKzE3Myw4IEBAIGludGVsX3BhbmVsX3ZidF9maXhlZF9tb2Rl
KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKIH0KIAogLyogYWRqdXN0ZWRfbW9k
ZSBoYXMgYmVlbiBwcmVzZXQgdG8gYmUgdGhlIHBhbmVsJ3MgZml4ZWQgbW9kZSAqLwotdm9pZAot
aW50ZWxfcGNoX3BhbmVsX2ZpdHRpbmcoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUsCi0JCQljb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKK2lu
dCBpbnRlbF9wY2hfcGFuZWxfZml0dGluZyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSwKKwkJCSAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0
ZSkKIHsKIAljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9CiAJ
CSZjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGU7CkBAIC0xODUsNyArMTg0LDcgQEAgaW50
ZWxfcGNoX3BhbmVsX2ZpdHRpbmcoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
CiAJaWYgKGFkanVzdGVkX21vZGUtPmNydGNfaGRpc3BsYXkgPT0gY3J0Y19zdGF0ZS0+cGlwZV9z
cmNfdyAmJgogCSAgICBhZGp1c3RlZF9tb2RlLT5jcnRjX3ZkaXNwbGF5ID09IGNydGNfc3RhdGUt
PnBpcGVfc3JjX2ggJiYKIAkgICAgY3J0Y19zdGF0ZS0+b3V0cHV0X2Zvcm1hdCAhPSBJTlRFTF9P
VVRQVVRfRk9STUFUX1lDQkNSNDIwKQotCQlyZXR1cm47CisJCXJldHVybiAwOwogCiAJc3dpdGNo
IChjb25uX3N0YXRlLT5zY2FsaW5nX21vZGUpIHsKIAljYXNlIERSTV9NT0RFX1NDQUxFX0NFTlRF
UjoKQEAgLTIzNiwxMiArMjM1LDE0IEBAIGludGVsX3BjaF9wYW5lbF9maXR0aW5nKHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCiAJZGVmYXVsdDoKIAkJTUlTU0lOR19DQVNF
KGNvbm5fc3RhdGUtPnNjYWxpbmdfbW9kZSk7Ci0JCXJldHVybjsKKwkJcmV0dXJuIC1FSU5WQUw7
CiAJfQogCiAJZHJtX3JlY3RfaW5pdCgmY3J0Y19zdGF0ZS0+cGNoX3BmaXQuZHN0LAogCQkgICAg
ICB4LCB5LCB3aWR0aCwgaGVpZ2h0KTsKIAljcnRjX3N0YXRlLT5wY2hfcGZpdC5lbmFibGVkID0g
dHJ1ZTsKKworCXJldHVybiAwOwogfQogCiBzdGF0aWMgdm9pZApAQCAtMzc3LDggKzM3OCw4IEBA
IHN0YXRpYyB2b2lkIGk5eHhfc2NhbGVfYXNwZWN0KHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLAogCX0KIH0KIAotdm9pZCBpbnRlbF9nbWNoX3BhbmVsX2ZpdHRpbmcoc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCi0JCQkgICAgICBjb25zdCBzdHJ1Y3QgZHJt
X2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKK2ludCBpbnRlbF9nbWNoX3BhbmVsX2ZpdHRp
bmcoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCisJCQkgICAgIGNvbnN0IHN0
cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQogewogCXN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwogCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwpA
QCAtNDI3LDcgKzQyOCw3IEBAIHZvaWQgaW50ZWxfZ21jaF9wYW5lbF9maXR0aW5nKHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCQlicmVhazsKIAlkZWZhdWx0OgogCQlNSVNT
SU5HX0NBU0UoY29ubl9zdGF0ZS0+c2NhbGluZ19tb2RlKTsKLQkJcmV0dXJuOworCQlyZXR1cm4g
LUVJTlZBTDsKIAl9CiAKIAkvKiA5NjUrIHdhbnRzIGZ1enp5IGZpdHRpbmcgKi8KQEAgLTQ0OCw2
ICs0NDksOCBAQCB2b2lkIGludGVsX2dtY2hfcGFuZWxfZml0dGluZyhzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAljcnRjX3N0YXRlLT5nbWNoX3BmaXQuY29udHJvbCA9IHBm
aXRfY29udHJvbDsKIAljcnRjX3N0YXRlLT5nbWNoX3BmaXQucGdtX3JhdGlvcyA9IHBmaXRfcGdt
X3JhdGlvczsKIAljcnRjX3N0YXRlLT5nbWNoX3BmaXQubHZkc19ib3JkZXJfYml0cyA9IGJvcmRl
cjsKKworCXJldHVybiAwOwogfQogCiAvKioKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfcGFuZWwuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfcGFuZWwuaAppbmRleCBlMmZhMTU0M2E2MWYuLmE1YzkzMjMyZWI2ZiAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9wYW5lbC5oCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcGFuZWwuaApAQCAtMjUsMTAgKzI1LDEwIEBA
IGludCBpbnRlbF9wYW5lbF9pbml0KHN0cnVjdCBpbnRlbF9wYW5lbCAqcGFuZWwsCiB2b2lkIGlu
dGVsX3BhbmVsX2Zpbmkoc3RydWN0IGludGVsX3BhbmVsICpwYW5lbCk7CiB2b2lkIGludGVsX2Zp
eGVkX3BhbmVsX21vZGUoY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmZpeGVkX21vZGUs
CiAJCQkgICAgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUpOwotdm9pZCBp
bnRlbF9wY2hfcGFuZWxfZml0dGluZyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSwKK2ludCBpbnRlbF9wY2hfcGFuZWxfZml0dGluZyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSwKKwkJCSAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29u
bl9zdGF0ZSk7CitpbnQgaW50ZWxfZ21jaF9wYW5lbF9maXR0aW5nKHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlLAogCQkJICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9z
dGF0ZSAqY29ubl9zdGF0ZSk7Ci12b2lkIGludGVsX2dtY2hfcGFuZWxfZml0dGluZyhzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKLQkJCSAgICAgIGNvbnN0IHN0cnVjdCBkcm1f
Y29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKTsKIHZvaWQgaW50ZWxfcGFuZWxfc2V0X2JhY2ts
aWdodF9hY3BpKGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlLAog
CQkJCSAgICB1MzIgbGV2ZWwsIHUzMiBtYXgpOwogaW50IGludGVsX3BhbmVsX3NldHVwX2JhY2ts
aWdodChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLApkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS92bHZfZHNpLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L3Zsdl9kc2kuYwppbmRleCA5ZjRmN2M2NzBjYzguLjdiMDAwN2ZhYTU3OSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS92bHZfZHNpLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS92bHZfZHNpLmMKQEAgLTI3Miw5ICsyNzIsMTEgQEAgc3Rh
dGljIGludCBpbnRlbF9kc2lfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCiAJCWludGVsX2ZpeGVkX3BhbmVsX21vZGUoZml4ZWRfbW9kZSwgYWRqdXN0ZWRfbW9k
ZSk7CiAKIAkJaWYgKEhBU19HTUNIKGRldl9wcml2KSkKLQkJCWludGVsX2dtY2hfcGFuZWxfZml0
dGluZyhwaXBlX2NvbmZpZywgY29ubl9zdGF0ZSk7CisJCQlyZXQgPSBpbnRlbF9nbWNoX3BhbmVs
X2ZpdHRpbmcocGlwZV9jb25maWcsIGNvbm5fc3RhdGUpOwogCQllbHNlCi0JCQlpbnRlbF9wY2hf
cGFuZWxfZml0dGluZyhwaXBlX2NvbmZpZywgY29ubl9zdGF0ZSk7CisJCQlyZXQgPSBpbnRlbF9w
Y2hfcGFuZWxfZml0dGluZyhwaXBlX2NvbmZpZywgY29ubl9zdGF0ZSk7CisJCWlmIChyZXQpCisJ
CQlyZXR1cm4gcmV0OwogCX0KIAogCWlmIChhZGp1c3RlZF9tb2RlLT5mbGFncyAmIERSTV9NT0RF
X0ZMQUdfREJMU0NBTikKLS0gCjIuMjEuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlz
dGluZm8vaW50ZWwtZ2Z4

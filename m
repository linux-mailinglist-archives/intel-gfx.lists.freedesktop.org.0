Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 7FAC433739
	for <lists+intel-gfx@lfdr.de>; Mon,  3 Jun 2019 19:49:54 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E5AC2892CF;
	Mon,  3 Jun 2019 17:49:48 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5D638892C8
 for <intel-gfx@lists.freedesktop.org>; Mon,  3 Jun 2019 17:49:46 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16778864-1500050 
 for multiple; Mon, 03 Jun 2019 18:49:39 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Mon,  3 Jun 2019 18:49:33 +0100
Message-Id: <20190603174935.23982-5-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190603174935.23982-1-chris@chris-wilson.co.uk>
References: <20190603174935.23982-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 5/7] drm/i915: Pull kref into i915_address_space
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

TWFrZSB0aGUga3JlZiBjb21tb24gdG8gYm90aCBkZXJpdmVkIHN0cnVjdHMgKGk5MTVfZ2d0dCBh
bmQgaTkxNV9wcGd0dCkKc28gdGhhdCB3ZSBjYW4gc2FmZWx5IHJlZmVyZW5jZSBjb3VudCBhbiBh
YnN0cmFjdCBjdHgtPnZtIGFkZHJlc3Mgc3BhY2UuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxz
b24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KLS0tCiAuLi4vZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9jbGllbnRfYmx0LmMgICAgfCAgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9jb250ZXh0LmMgICB8IDEzMiArKysrKysrKystLS0tLS0tLS0KIC4uLi9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaCB8ICAgNiArLQogLi4uL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jICAgIHwgICA0ICstCiAuLi4vZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfYmx0LmMgICAgfCAgIDQgKy0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV91c2VycHRyLmMgICB8ICAgNiArLQogLi4uL2dwdS9kcm0v
aTkxNS9nZW0vc2VsZnRlc3RzL2h1Z2VfcGFnZXMuYyAgIHwgIDI2ICsrLS0KIC4uLi9kcm0vaTkx
NS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQuYyB8ICAzNiArKystLQogLi4uL2dwdS9k
cm0vaTkxNS9nZW0vc2VsZnRlc3RzL21vY2tfY29udGV4dC5jIHwgICAzICstCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyAgICAgICAgICAgfCAgIDkgKy0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX3JpbmdidWZmZXIuYyAgICB8ICAyNiArKy0tCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hlY2suYyAgfCAgIDcgKy0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jICAgICAgICB8ICAgMiArLQogLi4uL2dwdS9kcm0v
aTkxNS9ndC9zZWxmdGVzdF93b3JrYXJvdW5kcy5jICAgIHwgIDEwICstCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMgICAgICAgICAgfCAgIDggKy0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZGVidWdmcy5jICAgICAgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9kcnYuaCAgICAgICAgICAgICAgIHwgICA2IC0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZ2VtX2d0dC5jICAgICAgICAgICB8ICAzNSArKy0tLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9nZW1fZ3R0LmggICAgICAgICAgIHwgIDI3ICsrLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmMgICAgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV90cmFjZS5oICAgICAgICAgICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZ3R0LmMgfCAgMTAgKy0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L3NlbGZ0ZXN0cy9pOTE1X3JlcXVlc3QuYyB8ICAgMyArLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvc2VsZnRlc3RzL2k5MTVfdm1hLmMgICAgIHwgICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9zZWxmdGVzdHMvaWd0X3NwaW5uZXIuYyAgfCAgIDUgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L3NlbGZ0ZXN0cy9tb2NrX2d0dC5jICAgICB8ICAgMSAtCiAyNiBmaWxlcyBjaGFuZ2VkLCAxODgg
aW5zZXJ0aW9ucygrKSwgMTkyIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jbGllbnRfYmx0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fY2xpZW50X2JsdC5jCmluZGV4IDQ4OTljYTFkZDc2Yy4uZjI1M2VjNTc2
NWFkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY2xpZW50
X2JsdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jbGllbnRfYmx0
LmMKQEAgLTI1MCwxMyArMjUwLDExIEBAIGludCBpOTE1X2dlbV9zY2hlZHVsZV9maWxsX3BhZ2Vz
X2JsdChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogewogCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShvYmotPmJhc2UuZGV2KTsKIAlzdHJ1Y3QgaTkxNV9n
ZW1fY29udGV4dCAqY3R4ID0gY2UtPmdlbV9jb250ZXh0OwotCXN0cnVjdCBpOTE1X2FkZHJlc3Nf
c3BhY2UgKnZtOworCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0gY3R4LT52bSA/OiAm
aTkxNS0+Z2d0dC52bTsKIAlzdHJ1Y3QgY2xlYXJfcGFnZXNfd29yayAqd29yazsKIAlzdHJ1Y3Qg
aTkxNV9zbGVldmUgKnNsZWV2ZTsKIAlpbnQgZXJyOwogCi0Jdm0gPSBjdHgtPnBwZ3R0ID8gJmN0
eC0+cHBndHQtPnZtIDogJmk5MTUtPmdndHQudm07Ci0KIAlzbGVldmUgPSBjcmVhdGVfc2xlZXZl
KHZtLCBvYmosIHBhZ2VzLCBwYWdlX3NpemVzKTsKIAlpZiAoSVNfRVJSKHNsZWV2ZSkpCiAJCXJl
dHVybiBQVFJfRVJSKHNsZWV2ZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fY29udGV4dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X2NvbnRleHQuYwppbmRleCAwODcyMWVmNjJlNGUuLjJlYzMxYjk5ZWM4MiAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCkBAIC0yOTQsNyArMjk0LDggQEAg
c3RhdGljIHZvaWQgaTkxNV9nZW1fY29udGV4dF9mcmVlKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0
ICpjdHgpCiAJR0VNX0JVR19PTighaTkxNV9nZW1fY29udGV4dF9pc19jbG9zZWQoY3R4KSk7CiAK
IAlyZWxlYXNlX2h3X2lkKGN0eCk7Ci0JaTkxNV9wcGd0dF9wdXQoY3R4LT5wcGd0dCk7CisJaWYg
KGN0eC0+dm0pCisJCWk5MTVfdm1fcHV0KGN0eC0+dm0pOwogCiAJZnJlZV9lbmdpbmVzKHJjdV9h
Y2Nlc3NfcG9pbnRlcihjdHgtPmVuZ2luZXMpKTsKIAltdXRleF9kZXN0cm95KCZjdHgtPmVuZ2lu
ZXNfbXV0ZXgpOwpAQCAtMzc5LDcgKzM4MCw3IEBAIHN0YXRpYyB2b2lkIGNvbnRleHRfY2xvc2Uo
c3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKIH0KIAogc3RhdGljIHUzMiBkZWZhdWx0X2Rl
c2NfdGVtcGxhdGUoY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCi0JCQkJIGNv
bnN0IHN0cnVjdCBpOTE1X2h3X3BwZ3R0ICpwcGd0dCkKKwkJCQkgY29uc3Qgc3RydWN0IGk5MTVf
YWRkcmVzc19zcGFjZSAqdm0pCiB7CiAJdTMyIGFkZHJlc3NfbW9kZTsKIAl1MzIgZGVzYzsKQEAg
LTM4Nyw3ICszODgsNyBAQCBzdGF0aWMgdTMyIGRlZmF1bHRfZGVzY190ZW1wbGF0ZShjb25zdCBz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAlkZXNjID0gR0VOOF9DVFhfVkFMSUQgfCBH
RU44X0NUWF9QUklWSUxFR0U7CiAKIAlhZGRyZXNzX21vZGUgPSBJTlRFTF9MRUdBQ1lfMzJCX0NP
TlRFWFQ7Ci0JaWYgKHBwZ3R0ICYmIGk5MTVfdm1faXNfNGx2bCgmcHBndHQtPnZtKSkKKwlpZiAo
dm0gJiYgaTkxNV92bV9pc180bHZsKHZtKSkKIAkJYWRkcmVzc19tb2RlID0gSU5URUxfTEVHQUNZ
XzY0Ql9DT05URVhUOwogCWRlc2MgfD0gYWRkcmVzc19tb2RlIDw8IEdFTjhfQ1RYX0FERFJFU1NJ
TkdfTU9ERV9TSElGVDsKIApAQCAtNDAzLDcgKzQwNCw3IEBAIHN0YXRpYyB1MzIgZGVmYXVsdF9k
ZXNjX3RlbXBsYXRlKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogfQogCiBz
dGF0aWMgc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKgotX19jcmVhdGVfY29udGV4dChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCitfX2NyZWF0ZV9jb250ZXh0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQogewogCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7CiAJ
c3RydWN0IGk5MTVfZ2VtX2VuZ2luZXMgKmU7CkBAIC00MTUsOCArNDE2LDggQEAgX19jcmVhdGVf
Y29udGV4dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJCXJldHVybiBFUlJf
UFRSKC1FTk9NRU0pOwogCiAJa3JlZl9pbml0KCZjdHgtPnJlZik7Ci0JbGlzdF9hZGRfdGFpbCgm
Y3R4LT5saW5rLCAmZGV2X3ByaXYtPmNvbnRleHRzLmxpc3QpOwotCWN0eC0+aTkxNSA9IGRldl9w
cml2OworCWxpc3RfYWRkX3RhaWwoJmN0eC0+bGluaywgJmk5MTUtPmNvbnRleHRzLmxpc3QpOwor
CWN0eC0+aTkxNSA9IGk5MTU7CiAJY3R4LT5zY2hlZC5wcmlvcml0eSA9IEk5MTVfVVNFUl9QUklP
UklUWShJOTE1X1BSSU9SSVRZX05PUk1BTCk7CiAJbXV0ZXhfaW5pdCgmY3R4LT5tdXRleCk7CiAK
QEAgLTQzNSwxNCArNDM2LDE0IEBAIF9fY3JlYXRlX2NvbnRleHQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQogCS8qIE5COiBNYXJrIGFsbCBzbGljZXMgYXMgbmVlZGluZyBhIHJl
bWFwIHNvIHRoYXQgd2hlbiB0aGUgY29udGV4dCBmaXJzdAogCSAqIGxvYWRzIGl0IHdpbGwgcmVz
dG9yZSB3aGF0ZXZlciByZW1hcCBzdGF0ZSBhbHJlYWR5IGV4aXN0cy4gSWYgdGhlcmUKIAkgKiBp
cyBubyByZW1hcCBpbmZvLCBpdCB3aWxsIGJlIGEgTk9QLiAqLwotCWN0eC0+cmVtYXBfc2xpY2Ug
PSBBTExfTDNfU0xJQ0VTKGRldl9wcml2KTsKKwljdHgtPnJlbWFwX3NsaWNlID0gQUxMX0wzX1NM
SUNFUyhpOTE1KTsKIAogCWk5MTVfZ2VtX2NvbnRleHRfc2V0X2Jhbm5hYmxlKGN0eCk7CiAJaTkx
NV9nZW1fY29udGV4dF9zZXRfcmVjb3ZlcmFibGUoY3R4KTsKIAogCWN0eC0+cmluZ19zaXplID0g
NCAqIFBBR0VfU0laRTsKIAljdHgtPmRlc2NfdGVtcGxhdGUgPQotCQlkZWZhdWx0X2Rlc2NfdGVt
cGxhdGUoZGV2X3ByaXYsIGRldl9wcml2LT5tbS5hbGlhc2luZ19wcGd0dCk7CisJCWRlZmF1bHRf
ZGVzY190ZW1wbGF0ZShpOTE1LCAmaTkxNS0+bW0uYWxpYXNpbmdfcHBndHQtPnZtKTsKIAogCWZv
ciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGN0eC0+aGFuZ190aW1lc3RhbXApOyBpKyspCiAJCWN0
eC0+aGFuZ190aW1lc3RhbXBbaV0gPSBqaWZmaWVzIC0gQ09OVEVYVF9GQVNUX0hBTkdfSklGRklF
UzsKQEAgLTQ1NCwyNiArNDU1LDI2IEBAIF9fY3JlYXRlX2NvbnRleHQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQogCXJldHVybiBFUlJfUFRSKGVycik7CiB9CiAKLXN0YXRpYyBz
dHJ1Y3QgaTkxNV9od19wcGd0dCAqCi1fX3NldF9wcGd0dChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4
dCAqY3R4LCBzdHJ1Y3QgaTkxNV9od19wcGd0dCAqcHBndHQpCitzdGF0aWMgc3RydWN0IGk5MTVf
YWRkcmVzc19zcGFjZSAqCitfX3NldF9wcGd0dChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4
LCBzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSkKIHsKLQlzdHJ1Y3QgaTkxNV9od19wcGd0
dCAqb2xkID0gY3R4LT5wcGd0dDsKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICpvbGQgPSBj
dHgtPnZtOwogCi0JY3R4LT5wcGd0dCA9IGk5MTVfcHBndHRfZ2V0KHBwZ3R0KTsKLQljdHgtPmRl
c2NfdGVtcGxhdGUgPSBkZWZhdWx0X2Rlc2NfdGVtcGxhdGUoY3R4LT5pOTE1LCBwcGd0dCk7CisJ
Y3R4LT52bSA9IGk5MTVfdm1fZ2V0KHZtKTsKKwljdHgtPmRlc2NfdGVtcGxhdGUgPSBkZWZhdWx0
X2Rlc2NfdGVtcGxhdGUoY3R4LT5pOTE1LCB2bSk7CiAKIAlyZXR1cm4gb2xkOwogfQogCiBzdGF0
aWMgdm9pZCBfX2Fzc2lnbl9wcGd0dChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAotCQkJ
ICAgc3RydWN0IGk5MTVfaHdfcHBndHQgKnBwZ3R0KQorCQkJICAgc3RydWN0IGk5MTVfYWRkcmVz
c19zcGFjZSAqdm0pCiB7Ci0JaWYgKHBwZ3R0ID09IGN0eC0+cHBndHQpCisJaWYgKHZtID09IGN0
eC0+dm0pCiAJCXJldHVybjsKIAotCXBwZ3R0ID0gX19zZXRfcHBndHQoY3R4LCBwcGd0dCk7Ci0J
aWYgKHBwZ3R0KQotCQlpOTE1X3BwZ3R0X3B1dChwcGd0dCk7CisJdm0gPSBfX3NldF9wcGd0dChj
dHgsIHZtKTsKKwlpZiAodm0pCisJCWk5MTVfdm1fcHV0KHZtKTsKIH0KIAogc3RhdGljIHN0cnVj
dCBpOTE1X2dlbV9jb250ZXh0ICoKQEAgLTUwNSw4ICs1MDYsOCBAQCBpOTE1X2dlbV9jcmVhdGVf
Y29udGV4dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHVuc2lnbmVkIGludCBm
bGFncykKIAkJCXJldHVybiBFUlJfQ0FTVChwcGd0dCk7CiAJCX0KIAotCQlfX2Fzc2lnbl9wcGd0
dChjdHgsIHBwZ3R0KTsKLQkJaTkxNV9wcGd0dF9wdXQocHBndHQpOworCQlfX2Fzc2lnbl9wcGd0
dChjdHgsICZwcGd0dC0+dm0pOworCQlpOTE1X3ZtX3B1dCgmcHBndHQtPnZtKTsKIAl9CiAKIAlp
ZiAoZmxhZ3MgJiBJOTE1X0NPTlRFWFRfQ1JFQVRFX0ZMQUdTX1NJTkdMRV9USU1FTElORSkgewpA
QCAtNzA2LDcgKzcwNyw3IEBAIHN0YXRpYyBpbnQgY29udGV4dF9pZHJfY2xlYW51cChpbnQgaWQs
IHZvaWQgKnAsIHZvaWQgKmRhdGEpCiAKIHN0YXRpYyBpbnQgdm1faWRyX2NsZWFudXAoaW50IGlk
LCB2b2lkICpwLCB2b2lkICpkYXRhKQogewotCWk5MTVfcHBndHRfcHV0KHApOworCWk5MTVfdm1f
cHV0KHApOwogCXJldHVybiAwOwogfQogCkBAIC03MTYsOCArNzE3LDggQEAgc3RhdGljIGludCBn
ZW1fY29udGV4dF9yZWdpc3RlcihzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAogCWludCBy
ZXQ7CiAKIAljdHgtPmZpbGVfcHJpdiA9IGZwcml2OwotCWlmIChjdHgtPnBwZ3R0KQotCQljdHgt
PnBwZ3R0LT52bS5maWxlID0gZnByaXY7CisJaWYgKGN0eC0+dm0pCisJCWN0eC0+dm0tPmZpbGUg
PSBmcHJpdjsKIAogCWN0eC0+cGlkID0gZ2V0X3Rhc2tfcGlkKGN1cnJlbnQsIFBJRFRZUEVfUElE
KTsKIAljdHgtPm5hbWUgPSBrYXNwcmludGYoR0ZQX0tFUk5FTCwgIiVzWyVkXSIsCkBAIC04MzEs
NyArODMyLDcgQEAgaW50IGk5MTVfZ2VtX3ZtX2NyZWF0ZV9pb2N0bChzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2LCB2b2lkICpkYXRhLAogCWlmIChlcnIpCiAJCWdvdG8gZXJyX3B1dDsKIAotCWVyciA9
IGlkcl9hbGxvYygmZmlsZV9wcml2LT52bV9pZHIsIHBwZ3R0LCAwLCAwLCBHRlBfS0VSTkVMKTsK
KwllcnIgPSBpZHJfYWxsb2MoJmZpbGVfcHJpdi0+dm1faWRyLCAmcHBndHQtPnZtLCAwLCAwLCBH
RlBfS0VSTkVMKTsKIAlpZiAoZXJyIDwgMCkKIAkJZ290byBlcnJfdW5sb2NrOwogCkBAIC04NDUs
NyArODQ2LDcgQEAgaW50IGk5MTVfZ2VtX3ZtX2NyZWF0ZV9pb2N0bChzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2LCB2b2lkICpkYXRhLAogZXJyX3VubG9jazoKIAltdXRleF91bmxvY2soJmZpbGVfcHJp
di0+dm1faWRyX2xvY2spOwogZXJyX3B1dDoKLQlpOTE1X3BwZ3R0X3B1dChwcGd0dCk7CisJaTkx
NV92bV9wdXQoJnBwZ3R0LT52bSk7CiAJcmV0dXJuIGVycjsKIH0KIApAQCAtODU0LDcgKzg1NSw3
IEBAIGludCBpOTE1X2dlbV92bV9kZXN0cm95X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYs
IHZvaWQgKmRhdGEsCiB7CiAJc3RydWN0IGRybV9pOTE1X2ZpbGVfcHJpdmF0ZSAqZmlsZV9wcml2
ID0gZmlsZS0+ZHJpdmVyX3ByaXY7CiAJc3RydWN0IGRybV9pOTE1X2dlbV92bV9jb250cm9sICph
cmdzID0gZGF0YTsKLQlzdHJ1Y3QgaTkxNV9od19wcGd0dCAqcHBndHQ7CisJc3RydWN0IGk5MTVf
YWRkcmVzc19zcGFjZSAqdm07CiAJaW50IGVycjsKIAl1MzIgaWQ7CiAKQEAgLTg3MiwxMyArODcz
LDEzIEBAIGludCBpOTE1X2dlbV92bV9kZXN0cm95X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYsIHZvaWQgKmRhdGEsCiAJaWYgKGVycikKIAkJcmV0dXJuIGVycjsKIAotCXBwZ3R0ID0gaWRy
X3JlbW92ZSgmZmlsZV9wcml2LT52bV9pZHIsIGlkKTsKKwl2bSA9IGlkcl9yZW1vdmUoJmZpbGVf
cHJpdi0+dm1faWRyLCBpZCk7CiAKIAltdXRleF91bmxvY2soJmZpbGVfcHJpdi0+dm1faWRyX2xv
Y2spOwotCWlmICghcHBndHQpCisJaWYgKCF2bSkKIAkJcmV0dXJuIC1FTk9FTlQ7CiAKLQlpOTE1
X3BwZ3R0X3B1dChwcGd0dCk7CisJaTkxNV92bV9wdXQodm0pOwogCXJldHVybiAwOwogfQogCkBA
IC05NjQsMTAgKzk2NSwxMCBAQCBzdGF0aWMgaW50IGdldF9wcGd0dChzdHJ1Y3QgZHJtX2k5MTVf
ZmlsZV9wcml2YXRlICpmaWxlX3ByaXYsCiAJCSAgICAgc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQg
KmN0eCwKIAkJICAgICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2NvbnRleHRfcGFyYW0gKmFyZ3MpCiB7
Ci0Jc3RydWN0IGk5MTVfaHdfcHBndHQgKnBwZ3R0OworCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3Bh
Y2UgKnZtOwogCWludCByZXQ7CiAKLQlpZiAoIWN0eC0+cHBndHQpCisJaWYgKCFjdHgtPnZtKQog
CQlyZXR1cm4gLUVOT0RFVjsKIAogCS8qIFhYWCByY3UgYWNxdWlyZT8gKi8KQEAgLTk3NSwxOSAr
OTc2LDE5IEBAIHN0YXRpYyBpbnQgZ2V0X3BwZ3R0KHN0cnVjdCBkcm1faTkxNV9maWxlX3ByaXZh
dGUgKmZpbGVfcHJpdiwKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCi0JcHBndHQgPSBpOTE1
X3BwZ3R0X2dldChjdHgtPnBwZ3R0KTsKKwl2bSA9IGk5MTVfdm1fZ2V0KGN0eC0+dm0pOwogCW11
dGV4X3VubG9jaygmY3R4LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAogCXJldCA9IG11dGV4
X2xvY2tfaW50ZXJydXB0aWJsZSgmZmlsZV9wcml2LT52bV9pZHJfbG9jayk7CiAJaWYgKHJldCkK
IAkJZ290byBlcnJfcHV0OwogCi0JcmV0ID0gaWRyX2FsbG9jKCZmaWxlX3ByaXYtPnZtX2lkciwg
cHBndHQsIDAsIDAsIEdGUF9LRVJORUwpOworCXJldCA9IGlkcl9hbGxvYygmZmlsZV9wcml2LT52
bV9pZHIsIHZtLCAwLCAwLCBHRlBfS0VSTkVMKTsKIAlHRU1fQlVHX09OKCFyZXQpOwogCWlmIChy
ZXQgPCAwKQogCQlnb3RvIGVycl91bmxvY2s7CiAKLQlpOTE1X3BwZ3R0X2dldChwcGd0dCk7CisJ
aTkxNV92bV9nZXQodm0pOwogCiAJYXJncy0+c2l6ZSA9IDA7CiAJYXJncy0+dmFsdWUgPSByZXQ7
CkBAIC05OTYsMjkgKzk5NywzMCBAQCBzdGF0aWMgaW50IGdldF9wcGd0dChzdHJ1Y3QgZHJtX2k5
MTVfZmlsZV9wcml2YXRlICpmaWxlX3ByaXYsCiBlcnJfdW5sb2NrOgogCW11dGV4X3VubG9jaygm
ZmlsZV9wcml2LT52bV9pZHJfbG9jayk7CiBlcnJfcHV0OgotCWk5MTVfcHBndHRfcHV0KHBwZ3R0
KTsKKwlpOTE1X3ZtX3B1dCh2bSk7CiAJcmV0dXJuIHJldDsKIH0KIAogc3RhdGljIHZvaWQgc2V0
X3BwZ3R0X2JhcnJpZXIodm9pZCAqZGF0YSkKIHsKLQlzdHJ1Y3QgaTkxNV9od19wcGd0dCAqb2xk
ID0gZGF0YTsKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICpvbGQgPSBkYXRhOwogCi0JaWYg
KElOVEVMX0dFTihvbGQtPnZtLmk5MTUpIDwgOCkKLQkJZ2VuNl9wcGd0dF91bnBpbl9hbGwob2xk
KTsKKwlpZiAoSU5URUxfR0VOKG9sZC0+aTkxNSkgPCA4KQorCQlnZW42X3BwZ3R0X3VucGluX2Fs
bChpOTE1X3ZtX3RvX3BwZ3R0KG9sZCkpOwogCi0JaTkxNV9wcGd0dF9wdXQob2xkKTsKKwlpOTE1
X3ZtX3B1dChvbGQpOwogfQogCiBzdGF0aWMgaW50IGVtaXRfcHBndHRfdXBkYXRlKHN0cnVjdCBp
OTE1X3JlcXVlc3QgKnJxLCB2b2lkICpkYXRhKQogewotCXN0cnVjdCBpOTE1X2h3X3BwZ3R0ICpw
cGd0dCA9IHJxLT5nZW1fY29udGV4dC0+cHBndHQ7CisJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFj
ZSAqdm0gPSBycS0+Z2VtX2NvbnRleHQtPnZtOwogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSA9IHJxLT5lbmdpbmU7CiAJdTMyIGJhc2UgPSBlbmdpbmUtPm1taW9fYmFzZTsKIAl1MzIg
KmNzOwogCWludCBpOwogCi0JaWYgKGk5MTVfdm1faXNfNGx2bCgmcHBndHQtPnZtKSkgeworCWlm
IChpOTE1X3ZtX2lzXzRsdmwodm0pKSB7CisJCXN0cnVjdCBpOTE1X2h3X3BwZ3R0ICpwcGd0dCA9
IGk5MTVfdm1fdG9fcHBndHQodm0pOwogCQljb25zdCBkbWFfYWRkcl90IHBkX2RhZGRyID0gcHhf
ZG1hKCZwcGd0dC0+cG1sNCk7CiAKIAkJY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJxLCA2KTsKQEAg
LTEwMzUsNiArMTAzNyw4IEBAIHN0YXRpYyBpbnQgZW1pdF9wcGd0dF91cGRhdGUoc3RydWN0IGk5
MTVfcmVxdWVzdCAqcnEsIHZvaWQgKmRhdGEpCiAJCSpjcysrID0gTUlfTk9PUDsKIAkJaW50ZWxf
cmluZ19hZHZhbmNlKHJxLCBjcyk7CiAJfSBlbHNlIGlmIChIQVNfTE9HSUNBTF9SSU5HX0NPTlRF
WFRTKGVuZ2luZS0+aTkxNSkpIHsKKwkJc3RydWN0IGk5MTVfaHdfcHBndHQgKnBwZ3R0ID0gaTkx
NV92bV90b19wcGd0dCh2bSk7CisKIAkJY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJxLCA0ICogR0VO
OF8zTFZMX1BEUEVTICsgMik7CiAJCWlmIChJU19FUlIoY3MpKQogCQkJcmV0dXJuIFBUUl9FUlIo
Y3MpOwpAQCAtMTA1Miw3ICsxMDU2LDcgQEAgc3RhdGljIGludCBlbWl0X3BwZ3R0X3VwZGF0ZShz
dHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgdm9pZCAqZGF0YSkKIAkJaW50ZWxfcmluZ19hZHZhbmNl
KHJxLCBjcyk7CiAJfSBlbHNlIHsKIAkJLyogcHBHVFQgaXMgbm90IHBhcnQgb2YgdGhlIGxlZ2Fj
eSBjb250ZXh0IGltYWdlICovCi0JCWdlbjZfcHBndHRfcGluKHBwZ3R0KTsKKwkJZ2VuNl9wcGd0
dF9waW4oaTkxNV92bV90b19wcGd0dCh2bSkpOwogCX0KIAogCXJldHVybiAwOwpAQCAtMTA2Miwx
MyArMTA2NiwxMyBAQCBzdGF0aWMgaW50IHNldF9wcGd0dChzdHJ1Y3QgZHJtX2k5MTVfZmlsZV9w
cml2YXRlICpmaWxlX3ByaXYsCiAJCSAgICAgc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwK
IAkJICAgICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2NvbnRleHRfcGFyYW0gKmFyZ3MpCiB7Ci0Jc3Ry
dWN0IGk5MTVfaHdfcHBndHQgKnBwZ3R0LCAqb2xkOworCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3Bh
Y2UgKnZtLCAqb2xkOwogCWludCBlcnI7CiAKIAlpZiAoYXJncy0+c2l6ZSkKIAkJcmV0dXJuIC1F
SU5WQUw7CiAKLQlpZiAoIWN0eC0+cHBndHQpCisJaWYgKCFjdHgtPnZtKQogCQlyZXR1cm4gLUVO
T0RFVjsKIAogCWlmICh1cHBlcl8zMl9iaXRzKGFyZ3MtPnZhbHVlKSkKQEAgLTEwNzgsMjQgKzEw
ODIsMjQgQEAgc3RhdGljIGludCBzZXRfcHBndHQoc3RydWN0IGRybV9pOTE1X2ZpbGVfcHJpdmF0
ZSAqZmlsZV9wcml2LAogCWlmIChlcnIpCiAJCXJldHVybiBlcnI7CiAKLQlwcGd0dCA9IGlkcl9m
aW5kKCZmaWxlX3ByaXYtPnZtX2lkciwgYXJncy0+dmFsdWUpOwotCWlmIChwcGd0dCkKLQkJaTkx
NV9wcGd0dF9nZXQocHBndHQpOworCXZtID0gaWRyX2ZpbmQoJmZpbGVfcHJpdi0+dm1faWRyLCBh
cmdzLT52YWx1ZSk7CisJaWYgKHZtKQorCQlpOTE1X3ZtX2dldCh2bSk7CiAJbXV0ZXhfdW5sb2Nr
KCZmaWxlX3ByaXYtPnZtX2lkcl9sb2NrKTsKLQlpZiAoIXBwZ3R0KQorCWlmICghdm0pCiAJCXJl
dHVybiAtRU5PRU5UOwogCiAJZXJyID0gbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKCZjdHgtPmk5
MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWlmIChlcnIpCiAJCWdvdG8gb3V0OwogCi0JaWYgKHBw
Z3R0ID09IGN0eC0+cHBndHQpCisJaWYgKHZtID09IGN0eC0+dm0pCiAJCWdvdG8gdW5sb2NrOwog
CiAJLyogVGVhcmRvd24gdGhlIGV4aXN0aW5nIG9iajp2bWEgY2FjaGUsIGl0IHdpbGwgaGF2ZSB0
byBiZSByZWJ1aWx0LiAqLwogCWx1dF9jbG9zZShjdHgpOwogCi0Jb2xkID0gX19zZXRfcHBndHQo
Y3R4LCBwcGd0dCk7CisJb2xkID0gX19zZXRfcHBndHQoY3R4LCB2bSk7CiAKIAkvKgogCSAqIFdl
IG5lZWQgdG8gZmx1c2ggYW55IHJlcXVlc3RzIHVzaW5nIHRoZSBjdXJyZW50IHBwZ3R0IGJlZm9y
ZQpAQCAtMTEwNywxNiArMTExMSwxNiBAQCBzdGF0aWMgaW50IHNldF9wcGd0dChzdHJ1Y3QgZHJt
X2k5MTVfZmlsZV9wcml2YXRlICpmaWxlX3ByaXYsCiAJCQkJICAgc2V0X3BwZ3R0X2JhcnJpZXIs
CiAJCQkJICAgb2xkKTsKIAlpZiAoZXJyKSB7Ci0JCWN0eC0+cHBndHQgPSBvbGQ7CisJCWN0eC0+
dm0gPSBvbGQ7CiAJCWN0eC0+ZGVzY190ZW1wbGF0ZSA9IGRlZmF1bHRfZGVzY190ZW1wbGF0ZShj
dHgtPmk5MTUsIG9sZCk7Ci0JCWk5MTVfcHBndHRfcHV0KHBwZ3R0KTsKKwkJaTkxNV92bV9wdXQo
dm0pOwogCX0KIAogdW5sb2NrOgogCW11dGV4X3VubG9jaygmY3R4LT5pOTE1LT5kcm0uc3RydWN0
X211dGV4KTsKIAogb3V0OgotCWk5MTVfcHBndHRfcHV0KHBwZ3R0KTsKKwlpOTE1X3ZtX3B1dCh2
bSk7CiAJcmV0dXJuIGVycjsKIH0KIApAQCAtMjAwNywxNSArMjAxMSwxNSBAQCBzdGF0aWMgaW50
IGNsb25lX3RpbWVsaW5lKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpkc3QsCiBzdGF0aWMgaW50
IGNsb25lX3ZtKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpkc3QsCiAJCSAgICBzdHJ1Y3QgaTkx
NV9nZW1fY29udGV4dCAqc3JjKQogewotCXN0cnVjdCBpOTE1X2h3X3BwZ3R0ICpwcGd0dDsKKwlz
dHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsKIAogCXJjdV9yZWFkX2xvY2soKTsKIAlkbyB7
Ci0JCXBwZ3R0ID0gUkVBRF9PTkNFKHNyYy0+cHBndHQpOwotCQlpZiAoIXBwZ3R0KQorCQl2bSA9
IFJFQURfT05DRShzcmMtPnZtKTsKKwkJaWYgKCF2bSkKIAkJCWJyZWFrOwogCi0JCWlmICgha3Jl
Zl9nZXRfdW5sZXNzX3plcm8oJnBwZ3R0LT5yZWYpKQorCQlpZiAoIWtyZWZfZ2V0X3VubGVzc196
ZXJvKCZ2bS0+cmVmKSkKIAkJCWNvbnRpbnVlOwogCiAJCS8qCkBAIC0yMDMzLDE2ICsyMDM3LDE2
IEBAIHN0YXRpYyBpbnQgY2xvbmVfdm0oc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmRzdCwKIAkJ
ICogaXQgY2Fubm90IGJlIHJlYWxsb2NhdGVkIGVsc2V3aGVyZS4KIAkJICovCiAKLQkJaWYgKHBw
Z3R0ID09IFJFQURfT05DRShzcmMtPnBwZ3R0KSkKKwkJaWYgKHZtID09IFJFQURfT05DRShzcmMt
PnZtKSkKIAkJCWJyZWFrOwogCi0JCWk5MTVfcHBndHRfcHV0KHBwZ3R0KTsKKwkJaTkxNV92bV9w
dXQodm0pOwogCX0gd2hpbGUgKDEpOwogCXJjdV9yZWFkX3VubG9jaygpOwogCi0JaWYgKHBwZ3R0
KSB7Ci0JCV9fYXNzaWduX3BwZ3R0KGRzdCwgcHBndHQpOwotCQlpOTE1X3BwZ3R0X3B1dChwcGd0
dCk7CisJaWYgKHZtKSB7CisJCV9fYXNzaWduX3BwZ3R0KGRzdCwgdm0pOworCQlpOTE1X3ZtX3B1
dCh2bSk7CiAJfQogCiAJcmV0dXJuIDA7CkBAIC0yMjcyLDggKzIyNzYsOCBAQCBpbnQgaTkxNV9n
ZW1fY29udGV4dF9nZXRwYXJhbV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpk
YXRhLAogCiAJY2FzZSBJOTE1X0NPTlRFWFRfUEFSQU1fR1RUX1NJWkU6CiAJCWFyZ3MtPnNpemUg
PSAwOwotCQlpZiAoY3R4LT5wcGd0dCkKLQkJCWFyZ3MtPnZhbHVlID0gY3R4LT5wcGd0dC0+dm0u
dG90YWw7CisJCWlmIChjdHgtPnZtKQorCQkJYXJncy0+dmFsdWUgPSBjdHgtPnZtLT50b3RhbDsK
IAkJZWxzZSBpZiAodG9faTkxNShkZXYpLT5tbS5hbGlhc2luZ19wcGd0dCkKIAkJCWFyZ3MtPnZh
bHVlID0gdG9faTkxNShkZXYpLT5tbS5hbGlhc2luZ19wcGd0dC0+dm0udG90YWw7CiAJCWVsc2UK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0X3R5
cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dF90eXBlcy5o
CmluZGV4IGZiOTY1ZGVkMjUwOC4uYmQzOTEzM2MxOGU1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dF90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0X3R5cGVzLmgKQEAgLTI1LDcgKzI1LDcgQEAg
c3RydWN0IHBpZDsKIAogc3RydWN0IGRybV9pOTE1X3ByaXZhdGU7CiBzdHJ1Y3QgZHJtX2k5MTVf
ZmlsZV9wcml2YXRlOwotc3RydWN0IGk5MTVfaHdfcHBndHQ7CitzdHJ1Y3QgaTkxNV9hZGRyZXNz
X3NwYWNlOwogc3RydWN0IGk5MTVfdGltZWxpbmU7CiBzdHJ1Y3QgaW50ZWxfcmluZzsKIApAQCAt
ODEsNyArODEsNyBAQCBzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCB7CiAJc3RydWN0IGk5MTVfdGlt
ZWxpbmUgKnRpbWVsaW5lOwogCiAJLyoqCi0JICogQHBwZ3R0OiB1bmlxdWUgYWRkcmVzcyBzcGFj
ZSAoR1RUKQorCSAqIEB2bTogdW5pcXVlIGFkZHJlc3Mgc3BhY2UgKEdUVCkKIAkgKgogCSAqIElu
IGZ1bGwtcHBndHQgbW9kZSwgZWFjaCBjb250ZXh0IGhhcyBpdHMgb3duIGFkZHJlc3Mgc3BhY2Ug
ZW5zdXJpbmcKIAkgKiBjb21wbGV0ZSBzZXBlcmF0aW9uIG9mIG9uZSBjbGllbnQgZnJvbSBhbGwg
b3RoZXJzLgpAQCAtODksNyArODksNyBAQCBzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCB7CiAJICog
SW4gb3RoZXIgbW9kZXMsIHRoaXMgaXMgYSBOVUxMIHBvaW50ZXIgd2l0aCB0aGUgZXhwZWN0YXRp
b24gdGhhdAogCSAqIHRoZSBjYWxsZXIgdXNlcyB0aGUgc2hhcmVkIGdsb2JhbCBHVFQuCiAJICov
Ci0Jc3RydWN0IGk5MTVfaHdfcHBndHQgKnBwZ3R0OworCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3Bh
Y2UgKnZtOwogCiAJLyoqCiAJICogQHBpZDogcHJvY2VzcyBpZCBvZiBjcmVhdG9yCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYwppbmRleCBlZDUyMmZk
ZmJlN2YuLjY1MTNlZTRiY2VkYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX2V4ZWNidWZmZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fZXhlY2J1ZmZlci5jCkBAIC03MjMsOCArNzIzLDggQEAgc3RhdGljIGludCBlYl9zZWxl
Y3RfY29udGV4dChzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYikKIAkJcmV0dXJuIC1FTk9FTlQ7
CiAKIAllYi0+Z2VtX2NvbnRleHQgPSBjdHg7Ci0JaWYgKGN0eC0+cHBndHQpIHsKLQkJZWItPnZt
ID0gJmN0eC0+cHBndHQtPnZtOworCWlmIChjdHgtPnZtKSB7CisJCWViLT52bSA9IGN0eC0+dm07
CiAJCWViLT5pbnZhbGlkX2ZsYWdzIHw9IEVYRUNfT0JKRUNUX05FRURTX0dUVDsKIAl9IGVsc2Ug
ewogCQllYi0+dm0gPSAmZWItPmk5MTUtPmdndHQudm07CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0X2JsdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF9ibHQuYwppbmRleCBmYzhlZTdlZjNkNjkuLmNiNDJlM2Ez
MTJlMiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVj
dF9ibHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0X2Js
dC5jCkBAIC00OSwxNCArNDksMTIgQEAgaW50IGk5MTVfZ2VtX29iamVjdF9maWxsX2JsdChzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShvYmotPmJhc2UuZGV2KTsKIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4
dCAqY3R4ID0gY2UtPmdlbV9jb250ZXh0OwotCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZt
OworCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0gY3R4LT52bSA/OiAmaTkxNS0+Z2d0
dC52bTsKIAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsK
IAlpbnQgZXJyOwogCiAJLyogWFhYOiBjZS0+dm0gcGxlYXNlICovCi0Jdm0gPSBjdHgtPnBwZ3R0
ID8gJmN0eC0+cHBndHQtPnZtIDogJmk5MTUtPmdndHQudm07Ci0KIAl2bWEgPSBpOTE1X3ZtYV9p
bnN0YW5jZShvYmosIHZtLCBOVUxMKTsKIAlpZiAoSVNfRVJSKHZtYSkpCiAJCXJldHVybiBQVFJf
RVJSKHZtYSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
dXNlcnB0ci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3VzZXJwdHIuYwpp
bmRleCBjZmE5OTBlZGIzNTEuLjUyOGI2MTY3ODMzNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3VzZXJwdHIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fdXNlcnB0ci5jCkBAIC03NjgsMTQgKzc2OCwxNCBAQCBpOTE1X2dlbV91
c2VycHRyX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJCXJldHVybiAtRUZBVUxUOwog
CiAJaWYgKGFyZ3MtPmZsYWdzICYgSTkxNV9VU0VSUFRSX1JFQURfT05MWSkgewotCQlzdHJ1Y3Qg
aTkxNV9od19wcGd0dCAqcHBndHQ7CisJCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtOwog
CiAJCS8qCiAJCSAqIE9uIGFsbW9zdCBhbGwgb2YgdGhlIG9sZGVyIGh3LCB3ZSBjYW5ub3QgdGVs
bCB0aGUgR1BVIHRoYXQKIAkJICogYSBwYWdlIGlzIHJlYWRvbmx5LgogCQkgKi8KLQkJcHBndHQg
PSBkZXZfcHJpdi0+a2VybmVsX2NvbnRleHQtPnBwZ3R0OwotCQlpZiAoIXBwZ3R0IHx8ICFwcGd0
dC0+dm0uaGFzX3JlYWRfb25seSkKKwkJdm0gPSBkZXZfcHJpdi0+a2VybmVsX2NvbnRleHQtPnZt
OworCQlpZiAoIXZtIHx8ICF2bS0+aGFzX3JlYWRfb25seSkKIAkJCXJldHVybiAtRU5PREVWOwog
CX0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdl
X3BhZ2VzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2h1Z2VfcGFnZXMu
YwppbmRleCBlYzI5ODVjMGE5MmUuLjIzMmQ1Y2Y0Mzk2YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2VzLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2VzLmMKQEAgLTEwMzgsOCArMTAzOCw3IEBA
IHN0YXRpYyBpbnQgX19pZ3Rfd3JpdGVfaHVnZShzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4
LAogCQkJICAgIHUzMiBkd29yZCwgdTMyIHZhbCkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUob2JqLT5iYXNlLmRldik7Ci0Jc3RydWN0IGk5MTVfYWRkcmVzc19z
cGFjZSAqdm0gPQotCQljdHgtPnBwZ3R0ID8gJmN0eC0+cHBndHQtPnZtIDogJmk5MTUtPmdndHQu
dm07CisJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSBjdHgtPnZtID86ICZpOTE1LT5n
Z3R0LnZtOwogCXVuc2lnbmVkIGludCBmbGFncyA9IFBJTl9VU0VSIHwgUElOX09GRlNFVF9GSVhF
RDsKIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKIAlpbnQgZXJyOwpAQCAtMTA5Miw4ICsxMDkxLDcg
QEAgc3RhdGljIGludCBpZ3Rfd3JpdGVfaHVnZShzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4
LAogCQkJICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogewogCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShvYmotPmJhc2UuZGV2KTsKLQlzdHJ1Y3QgaTkx
NV9hZGRyZXNzX3NwYWNlICp2bSA9Ci0JCWN0eC0+cHBndHQgPyAmY3R4LT5wcGd0dC0+dm0gOiAm
aTkxNS0+Z2d0dC52bTsKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9IGN0eC0+dm0g
PzogJmk5MTUtPmdndHQudm07CiAJc3RhdGljIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZXNbSTkxNV9OVU1fRU5HSU5FU107CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwog
CUk5MTVfUk5EX1NUQVRFKHBybmcpOwpAQCAtMTQxOSw3ICsxNDE3LDcgQEAgc3RhdGljIGludCBp
Z3RfcHBndHRfcGluX3VwZGF0ZSh2b2lkICphcmcpCiAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQg
KmN0eCA9IGFyZzsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBjdHgtPmk5
MTU7CiAJdW5zaWduZWQgbG9uZyBzdXBwb3J0ZWQgPSBJTlRFTF9JTkZPKGRldl9wcml2KS0+cGFn
ZV9zaXplczsKLQlzdHJ1Y3QgaTkxNV9od19wcGd0dCAqcHBndHQgPSBjdHgtPnBwZ3R0OworCXN0
cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0gY3R4LT52bTsKIAlzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqOwogCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwogCXVuc2lnbmVkIGludCBm
bGFncyA9IFBJTl9VU0VSIHwgUElOX09GRlNFVF9GSVhFRDsKQEAgLTE0MzQsNyArMTQzMiw3IEBA
IHN0YXRpYyBpbnQgaWd0X3BwZ3R0X3Bpbl91cGRhdGUodm9pZCAqYXJnKQogCSAqIGh1Z2UtZ3R0
LXBhZ2VzLgogCSAqLwogCi0JaWYgKCFwcGd0dCB8fCAhaTkxNV92bV9pc180bHZsKCZwcGd0dC0+
dm0pKSB7CisJaWYgKCF2bSB8fCAhaTkxNV92bV9pc180bHZsKHZtKSkgewogCQlwcl9pbmZvKCI0
OGIgUFBHVFQgbm90IHN1cHBvcnRlZCwgc2tpcHBpbmdcbiIpOwogCQlyZXR1cm4gMDsKIAl9CkBA
IC0xNDQ5LDcgKzE0NDcsNyBAQCBzdGF0aWMgaW50IGlndF9wcGd0dF9waW5fdXBkYXRlKHZvaWQg
KmFyZykKIAkJaWYgKElTX0VSUihvYmopKQogCQkJcmV0dXJuIFBUUl9FUlIob2JqKTsKIAotCQl2
bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosICZwcGd0dC0+dm0sIE5VTEwpOworCQl2bWEgPSBp
OTE1X3ZtYV9pbnN0YW5jZShvYmosIHZtLCBOVUxMKTsKIAkJaWYgKElTX0VSUih2bWEpKSB7CiAJ
CQllcnIgPSBQVFJfRVJSKHZtYSk7CiAJCQlnb3RvIG91dF9wdXQ7CkBAIC0xNTAzLDcgKzE1MDEs
NyBAQCBzdGF0aWMgaW50IGlndF9wcGd0dF9waW5fdXBkYXRlKHZvaWQgKmFyZykKIAlpZiAoSVNf
RVJSKG9iaikpCiAJCXJldHVybiBQVFJfRVJSKG9iaik7CiAKLQl2bWEgPSBpOTE1X3ZtYV9pbnN0
YW5jZShvYmosICZwcGd0dC0+dm0sIE5VTEwpOworCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9i
aiwgdm0sIE5VTEwpOwogCWlmIChJU19FUlIodm1hKSkgewogCQllcnIgPSBQVFJfRVJSKHZtYSk7
CiAJCWdvdG8gb3V0X3B1dDsKQEAgLTE1NDEsOCArMTUzOSw3IEBAIHN0YXRpYyBpbnQgaWd0X3Rt
cGZzX2ZhbGxiYWNrKHZvaWQgKmFyZykKIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4ID0g
YXJnOwogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gY3R4LT5pOTE1OwogCXN0cnVj
dCB2ZnNtb3VudCAqZ2VtZnMgPSBpOTE1LT5tbS5nZW1mczsKLQlzdHJ1Y3QgaTkxNV9hZGRyZXNz
X3NwYWNlICp2bSA9Ci0JCWN0eC0+cHBndHQgPyAmY3R4LT5wcGd0dC0+dm0gOiAmaTkxNS0+Z2d0
dC52bTsKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9IGN0eC0+dm0gPzogJmk5MTUt
PmdndHQudm07CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKIAlzdHJ1Y3QgaTkx
NV92bWEgKnZtYTsKIAl1MzIgKnZhZGRyOwpAQCAtMTU5OSw4ICsxNTk2LDcgQEAgc3RhdGljIGlu
dCBpZ3Rfc2hyaW5rX3RocCh2b2lkICphcmcpCiB7CiAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQg
KmN0eCA9IGFyZzsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGN0eC0+aTkxNTsK
LQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9Ci0JCWN0eC0+cHBndHQgPyAmY3R4LT5w
cGd0dC0+dm0gOiAmaTkxNS0+Z2d0dC52bTsKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2
bSA9IGN0eC0+dm0gPzogJmk5MTUtPmdndHQudm07CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iajsKIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKIAl1bnNpZ25lZCBpbnQgZmxhZ3MgPSBQ
SU5fVVNFUjsKQEAgLTE3MjEsNyArMTcxNyw3IEBAIGludCBpOTE1X2dlbV9odWdlX3BhZ2VfbW9j
a19zZWxmdGVzdHModm9pZCkKIAllcnIgPSBpOTE1X3N1YnRlc3RzKHRlc3RzLCBwcGd0dCk7CiAK
IG91dF9jbG9zZToKLQlpOTE1X3BwZ3R0X3B1dChwcGd0dCk7CisJaTkxNV92bV9wdXQoJnBwZ3R0
LT52bSk7CiAKIG91dF91bmxvY2s6CiAJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVj
dF9tdXRleCk7CkBAIC0xNzY2LDggKzE3NjIsOCBAQCBpbnQgaTkxNV9nZW1faHVnZV9wYWdlX2xp
dmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAkJZ290byBv
dXRfdW5sb2NrOwogCX0KIAotCWlmIChjdHgtPnBwZ3R0KQotCQljdHgtPnBwZ3R0LT52bS5zY3J1
Yl82NEsgPSB0cnVlOworCWlmIChjdHgtPnZtKQorCQljdHgtPnZtLT5zY3J1Yl82NEsgPSB0cnVl
OwogCiAJZXJyID0gaTkxNV9zdWJ0ZXN0cyh0ZXN0cywgY3R4KTsKIApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQuYwppbmRleCAx
YmMzYjgwMjY0MDAuLjI1YTdlYjEyZDMzOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMKQEAgLTI0OCw4ICsyNDgsNyBA
QCBzdGF0aWMgaW50IGdwdV9maWxsKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJ
CSAgICB1bnNpZ25lZCBpbnQgZHcpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KG9iai0+YmFzZS5kZXYpOwotCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZt
ID0KLQkJY3R4LT5wcGd0dCA/ICZjdHgtPnBwZ3R0LT52bSA6ICZpOTE1LT5nZ3R0LnZtOworCXN0
cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0gY3R4LT52bSA/OiAmaTkxNS0+Z2d0dC52bTsK
IAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKIAlzdHJ1
Y3QgaTkxNV92bWEgKmJhdGNoOwpAQCAtNDM4LDggKzQzNyw3IEBAIGNyZWF0ZV90ZXN0X29iamVj
dChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAogCQkgICBzdHJ1Y3QgbGlzdF9oZWFkICpv
YmplY3RzKQogewogCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7Ci0Jc3RydWN0IGk5
MTVfYWRkcmVzc19zcGFjZSAqdm0gPQotCQljdHgtPnBwZ3R0ID8gJmN0eC0+cHBndHQtPnZtIDog
JmN0eC0+aTkxNS0+Z2d0dC52bTsKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9IGN0
eC0+dm0gPzogJmN0eC0+aTkxNS0+Z2d0dC52bTsKIAl1NjQgc2l6ZTsKIAlpbnQgZXJyOwogCkBA
IC01NDEsNyArNTM5LDcgQEAgc3RhdGljIGludCBpZ3RfY3R4X2V4ZWModm9pZCAqYXJnKQogCQkJ
CXByX2VycigiRmFpbGVkIHRvIGZpbGwgZHdvcmQgJWx1IFslbHUvJWx1XSB3aXRoIGdwdSAoJXMp
IGluIGN0eCAldSBbZnVsbC1wcGd0dD8gJXNdLCBlcnI9JWRcbiIsCiAJCQkJICAgICAgIG5kd29y
ZHMsIGR3LCBtYXhfZHdvcmRzKG9iaiksCiAJCQkJICAgICAgIGVuZ2luZS0+bmFtZSwgY3R4LT5o
d19pZCwKLQkJCQkgICAgICAgeWVzbm8oISFjdHgtPnBwZ3R0KSwgZXJyKTsKKwkJCQkgICAgICAg
eWVzbm8oISFjdHgtPnZtKSwgZXJyKTsKIAkJCQlnb3RvIG91dF91bmxvY2s7CiAJCQl9CiAKQEAg
LTYxMiw3ICs2MTAsNyBAQCBzdGF0aWMgaW50IGlndF9zaGFyZWRfY3R4X2V4ZWModm9pZCAqYXJn
KQogCQlnb3RvIG91dF91bmxvY2s7CiAJfQogCi0JaWYgKCFwYXJlbnQtPnBwZ3R0KSB7IC8qIG5v
dCBmdWxsLXBwZ3R0OyBub3RoaW5nIHRvIHNoYXJlICovCisJaWYgKCFwYXJlbnQtPnZtKSB7IC8q
IG5vdCBmdWxsLXBwZ3R0OyBub3RoaW5nIHRvIHNoYXJlICovCiAJCWVyciA9IDA7CiAJCWdvdG8g
b3V0X3VubG9jazsKIAl9CkBAIC02NDMsNyArNjQxLDcgQEAgc3RhdGljIGludCBpZ3Rfc2hhcmVk
X2N0eF9leGVjKHZvaWQgKmFyZykKIAkJCQlnb3RvIG91dF90ZXN0OwogCQkJfQogCi0JCQlfX2Fz
c2lnbl9wcGd0dChjdHgsIHBhcmVudC0+cHBndHQpOworCQkJX19hc3NpZ25fcHBndHQoY3R4LCBw
YXJlbnQtPnZtKTsKIAogCQkJaWYgKCFvYmopIHsKIAkJCQlvYmogPSBjcmVhdGVfdGVzdF9vYmpl
Y3QocGFyZW50LCBmaWxlLCAmb2JqZWN0cyk7CkBAIC02NjEsNyArNjU5LDcgQEAgc3RhdGljIGlu
dCBpZ3Rfc2hhcmVkX2N0eF9leGVjKHZvaWQgKmFyZykKIAkJCQlwcl9lcnIoIkZhaWxlZCB0byBm
aWxsIGR3b3JkICVsdSBbJWx1LyVsdV0gd2l0aCBncHUgKCVzKSBpbiBjdHggJXUgW2Z1bGwtcHBn
dHQ/ICVzXSwgZXJyPSVkXG4iLAogCQkJCSAgICAgICBuZHdvcmRzLCBkdywgbWF4X2R3b3Jkcyhv
YmopLAogCQkJCSAgICAgICBlbmdpbmUtPm5hbWUsIGN0eC0+aHdfaWQsCi0JCQkJICAgICAgIHll
c25vKCEhY3R4LT5wcGd0dCksIGVycik7CisJCQkJICAgICAgIHllc25vKCEhY3R4LT52bSksIGVy
cik7CiAJCQkJa2VybmVsX2NvbnRleHRfY2xvc2UoY3R4KTsKIAkJCQlnb3RvIG91dF90ZXN0Owog
CQkJfQpAQCAtNzU4LDcgKzc1Niw3IEBAIGVtaXRfcnBjc19xdWVyeShzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqLAogCiAJR0VNX0JVR19PTighaW50ZWxfZW5naW5lX2Nhbl9zdG9yZV9k
d29yZChjZS0+ZW5naW5lKSk7CiAKLQl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosICZjZS0+
Z2VtX2NvbnRleHQtPnBwZ3R0LT52bSwgTlVMTCk7CisJdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uo
b2JqLCBjZS0+Z2VtX2NvbnRleHQtPnZtLCBOVUxMKTsKIAlpZiAoSVNfRVJSKHZtYSkpCiAJCXJl
dHVybiBQVFJfRVJSKHZtYSk7CiAKQEAgLTExNzYsOCArMTE3NCw4IEBAIHN0YXRpYyBpbnQgaWd0
X2N0eF9yZWFkb25seSh2b2lkICphcmcpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSBhcmc7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IE5VTEw7CisJc3Ry
dWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm07CiAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0
eDsKLQlzdHJ1Y3QgaTkxNV9od19wcGd0dCAqcHBndHQ7CiAJdW5zaWduZWQgbG9uZyBpZHgsIG5k
d29yZHMsIGR3OwogCXN0cnVjdCBpZ3RfbGl2ZV90ZXN0IHQ7CiAJc3RydWN0IGRybV9maWxlICpm
aWxlOwpAQCAtMTIwOCw4ICsxMjA2LDggQEAgc3RhdGljIGludCBpZ3RfY3R4X3JlYWRvbmx5KHZv
aWQgKmFyZykKIAkJZ290byBvdXRfdW5sb2NrOwogCX0KIAotCXBwZ3R0ID0gY3R4LT5wcGd0dCA/
OiBpOTE1LT5tbS5hbGlhc2luZ19wcGd0dDsKLQlpZiAoIXBwZ3R0IHx8ICFwcGd0dC0+dm0uaGFz
X3JlYWRfb25seSkgeworCXZtID0gY3R4LT52bSA/OiAmaTkxNS0+bW0uYWxpYXNpbmdfcHBndHQt
PnZtOworCWlmICghdm0gfHwgIXZtLT5oYXNfcmVhZF9vbmx5KSB7CiAJCWVyciA9IDA7CiAJCWdv
dG8gb3V0X3VubG9jazsKIAl9CkBAIC0xMjQ0LDcgKzEyNDIsNyBAQCBzdGF0aWMgaW50IGlndF9j
dHhfcmVhZG9ubHkodm9pZCAqYXJnKQogCQkJCXByX2VycigiRmFpbGVkIHRvIGZpbGwgZHdvcmQg
JWx1IFslbHUvJWx1XSB3aXRoIGdwdSAoJXMpIGluIGN0eCAldSBbZnVsbC1wcGd0dD8gJXNdLCBl
cnI9JWRcbiIsCiAJCQkJICAgICAgIG5kd29yZHMsIGR3LCBtYXhfZHdvcmRzKG9iaiksCiAJCQkJ
ICAgICAgIGVuZ2luZS0+bmFtZSwgY3R4LT5od19pZCwKLQkJCQkgICAgICAgeWVzbm8oISFjdHgt
PnBwZ3R0KSwgZXJyKTsKKwkJCQkgICAgICAgeWVzbm8oISFjdHgtPnZtKSwgZXJyKTsKIAkJCQln
b3RvIG91dF91bmxvY2s7CiAJCQl9CiAKQEAgLTEyODgsNyArMTI4Niw3IEBAIHN0YXRpYyBpbnQg
aWd0X2N0eF9yZWFkb25seSh2b2lkICphcmcpCiBzdGF0aWMgaW50IGNoZWNrX3NjcmF0Y2goc3Ry
dWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwgdTY0IG9mZnNldCkKIHsKIAlzdHJ1Y3QgZHJtX21t
X25vZGUgKm5vZGUgPQotCQlfX2RybV9tbV9pbnRlcnZhbF9maXJzdCgmY3R4LT5wcGd0dC0+dm0u
bW0sCisJCV9fZHJtX21tX2ludGVydmFsX2ZpcnN0KCZjdHgtPnZtLT5tbSwKIAkJCQkJb2Zmc2V0
LCBvZmZzZXQgKyBzaXplb2YodTMyKSAtIDEpOwogCWlmICghbm9kZSB8fCBub2RlLT5zdGFydCA+
IG9mZnNldCkKIAkJcmV0dXJuIDA7CkBAIC0xMzM2LDcgKzEzMzQsNyBAQCBzdGF0aWMgaW50IHdy
aXRlX3RvX3NjcmF0Y2goc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKIAlfX2k5MTVfZ2Vt
X29iamVjdF9mbHVzaF9tYXAob2JqLCAwLCA2NCk7CiAJaTkxNV9nZW1fb2JqZWN0X3VucGluX21h
cChvYmopOwogCi0Jdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uob2JqLCAmY3R4LT5wcGd0dC0+dm0s
IE5VTEwpOworCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9iaiwgY3R4LT52bSwgTlVMTCk7CiAJ
aWYgKElTX0VSUih2bWEpKSB7CiAJCWVyciA9IFBUUl9FUlIodm1hKTsKIAkJZ290byBlcnI7CkBA
IC0xNDMzLDcgKzE0MzEsNyBAQCBzdGF0aWMgaW50IHJlYWRfZnJvbV9zY3JhdGNoKHN0cnVjdCBp
OTE1X2dlbV9jb250ZXh0ICpjdHgsCiAJaTkxNV9nZW1fb2JqZWN0X2ZsdXNoX21hcChvYmopOwog
CWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAob2JqKTsKIAotCXZtYSA9IGk5MTVfdm1hX2luc3Rh
bmNlKG9iaiwgJmN0eC0+cHBndHQtPnZtLCBOVUxMKTsKKwl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5j
ZShvYmosIGN0eC0+dm0sIE5VTEwpOwogCWlmIChJU19FUlIodm1hKSkgewogCQllcnIgPSBQVFJf
RVJSKHZtYSk7CiAJCWdvdG8gZXJyOwpAQCAtMTU0MiwxMSArMTU0MCwxMSBAQCBzdGF0aWMgaW50
IGlndF92bV9pc29sYXRpb24odm9pZCAqYXJnKQogCX0KIAogCS8qIFdlIGNhbiBvbmx5IHRlc3Qg
dm0gaXNvbGF0aW9uLCBpZiB0aGUgdm0gYXJlIGRpc3RpbmN0ICovCi0JaWYgKGN0eF9hLT5wcGd0
dCA9PSBjdHhfYi0+cHBndHQpCisJaWYgKGN0eF9hLT52bSA9PSBjdHhfYi0+dm0pCiAJCWdvdG8g
b3V0X3VubG9jazsKIAotCXZtX3RvdGFsID0gY3R4X2EtPnBwZ3R0LT52bS50b3RhbDsKLQlHRU1f
QlVHX09OKGN0eF9iLT5wcGd0dC0+dm0udG90YWwgIT0gdm1fdG90YWwpOworCXZtX3RvdGFsID0g
Y3R4X2EtPnZtLT50b3RhbDsKKwlHRU1fQlVHX09OKGN0eF9iLT52bS0+dG90YWwgIT0gdm1fdG90
YWwpOwogCXZtX3RvdGFsIC09IEk5MTVfR1RUX1BBR0VfU0laRTsKIAogCXdha2VyZWYgPSBpbnRl
bF9ydW50aW1lX3BtX2dldChpOTE1KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9zZWxmdGVzdHMvbW9ja19jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
c2VsZnRlc3RzL21vY2tfY29udGV4dC5jCmluZGV4IDY4ZDUwZGEwMzVlNi4uOGYwNTcxNjdhMjVh
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL21vY2tfY29u
dGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvbW9ja19jb250
ZXh0LmMKQEAgLTQ5LDcgKzQ5LDggQEAgbW9ja19jb250ZXh0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAogCQlpZiAoIXBwZ3R0KQogCQkJZ290byBlcnJfcHV0OwogCi0JCV9fc2V0X3Bw
Z3R0KGN0eCwgcHBndHQpOworCQlfX3NldF9wcGd0dChjdHgsICZwcGd0dC0+dm0pOworCQlpOTE1
X3ZtX3B1dCgmcHBndHQtPnZtKTsKIAl9CiAKIAlyZXR1cm4gY3R4OwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9scmMuYwppbmRleCBmZWQ3MDQ4MDJjNTcuLjQ4OGUwMjhjY2I2NiAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKQEAgLTE1MDUsNyArMTUwNSw3IEBAIF9fZXhlY2xpc3Rz
X2NvbnRleHRfcGluKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKIAl2b2lkICp2YWRkcjsKIAlp
bnQgcmV0OwogCi0JR0VNX0JVR19PTighY2UtPmdlbV9jb250ZXh0LT5wcGd0dCk7CisJR0VNX0JV
R19PTighY2UtPmdlbV9jb250ZXh0LT52bSk7CiAKIAlyZXQgPSBleGVjbGlzdHNfY29udGV4dF9k
ZWZlcnJlZF9hbGxvYyhjZSwgZW5naW5lKTsKIAlpZiAocmV0KQpAQCAtMTYyMSw3ICsxNjIxLDgg
QEAgc3RhdGljIGludCBnZW44X2VtaXRfaW5pdF9icmVhZGNydW1iKHN0cnVjdCBpOTE1X3JlcXVl
c3QgKnJxKQogc3RhdGljIGludCBlbWl0X3BkcHMoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiB7
CiAJY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqIGNvbnN0IGVuZ2luZSA9IHJxLT5lbmdp
bmU7Ci0Jc3RydWN0IGk5MTVfaHdfcHBndHQgKiBjb25zdCBwcGd0dCA9IHJxLT5nZW1fY29udGV4
dC0+cHBndHQ7CisJc3RydWN0IGk5MTVfaHdfcHBndHQgKiBjb25zdCBwcGd0dCA9CisJCWk5MTVf
dm1fdG9fcHBndHQocnEtPmdlbV9jb250ZXh0LT52bSk7CiAJaW50IGVyciwgaTsKIAl1MzIgKmNz
OwogCkBAIC0xNjk0LDcgKzE2OTUsNyBAQCBzdGF0aWMgaW50IGV4ZWNsaXN0c19yZXF1ZXN0X2Fs
bG9jKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QpCiAJICovCiAKIAkvKiBVbmNvbmRpdGlv
bmFsbHkgaW52YWxpZGF0ZSBHUFUgY2FjaGVzIGFuZCBUTEJzLiAqLwotCWlmIChpOTE1X3ZtX2lz
XzRsdmwoJnJlcXVlc3QtPmdlbV9jb250ZXh0LT5wcGd0dC0+dm0pKQorCWlmIChpOTE1X3ZtX2lz
XzRsdmwocmVxdWVzdC0+Z2VtX2NvbnRleHQtPnZtKSkKIAkJcmV0ID0gcmVxdWVzdC0+ZW5naW5l
LT5lbWl0X2ZsdXNoKHJlcXVlc3QsIEVNSVRfSU5WQUxJREFURSk7CiAJZWxzZQogCQlyZXQgPSBl
bWl0X3BkcHMocmVxdWVzdCk7CkBAIC0yODI0LDcgKzI4MjUsNyBAQCBzdGF0aWMgdm9pZCBleGVj
bGlzdHNfaW5pdF9yZWdfc3RhdGUodTMyICpyZWdzLAogCQkJCSAgICAgc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lLAogCQkJCSAgICAgc3RydWN0IGludGVsX3JpbmcgKnJpbmcpCiB7Ci0J
c3RydWN0IGk5MTVfaHdfcHBndHQgKnBwZ3R0ID0gY2UtPmdlbV9jb250ZXh0LT5wcGd0dDsKKwlz
dHJ1Y3QgaTkxNV9od19wcGd0dCAqcHBndHQgPSBpOTE1X3ZtX3RvX3BwZ3R0KGNlLT5nZW1fY29u
dGV4dC0+dm0pOwogCWJvb2wgcmNzID0gZW5naW5lLT5jbGFzcyA9PSBSRU5ERVJfQ0xBU1M7CiAJ
dTMyIGJhc2UgPSBlbmdpbmUtPm1taW9fYmFzZTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfcmluZ2J1ZmZlci5jCmluZGV4IGZmNThkNjU4ZTNlMi4uNjM2OWNjNWUyMmI0IDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jCkBAIC0xMzMwLDIzICsx
MzMwLDIzIEBAIHN0YXRpYyB2b2lkIHJpbmdfY29udGV4dF9kZXN0cm95KHN0cnVjdCBrcmVmICpy
ZWYpCiAKIHN0YXRpYyBpbnQgX19jb250ZXh0X3Bpbl9wcGd0dChzdHJ1Y3QgaTkxNV9nZW1fY29u
dGV4dCAqY3R4KQogewotCXN0cnVjdCBpOTE1X2h3X3BwZ3R0ICpwcGd0dDsKKwlzdHJ1Y3QgaTkx
NV9hZGRyZXNzX3NwYWNlICp2bTsKIAlpbnQgZXJyID0gMDsKIAotCXBwZ3R0ID0gY3R4LT5wcGd0
dCA/OiBjdHgtPmk5MTUtPm1tLmFsaWFzaW5nX3BwZ3R0OwotCWlmIChwcGd0dCkKLQkJZXJyID0g
Z2VuNl9wcGd0dF9waW4ocHBndHQpOworCXZtID0gY3R4LT52bSA/OiAmY3R4LT5pOTE1LT5tbS5h
bGlhc2luZ19wcGd0dC0+dm07CisJaWYgKHZtKQorCQllcnIgPSBnZW42X3BwZ3R0X3BpbihpOTE1
X3ZtX3RvX3BwZ3R0KCh2bSkpKTsKIAogCXJldHVybiBlcnI7CiB9CiAKIHN0YXRpYyB2b2lkIF9f
Y29udGV4dF91bnBpbl9wcGd0dChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQogewotCXN0
cnVjdCBpOTE1X2h3X3BwZ3R0ICpwcGd0dDsKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2
bTsKIAotCXBwZ3R0ID0gY3R4LT5wcGd0dCA/OiBjdHgtPmk5MTUtPm1tLmFsaWFzaW5nX3BwZ3R0
OwotCWlmIChwcGd0dCkKLQkJZ2VuNl9wcGd0dF91bnBpbihwcGd0dCk7CisJdm0gPSBjdHgtPnZt
ID86ICZjdHgtPmk5MTUtPm1tLmFsaWFzaW5nX3BwZ3R0LT52bTsKKwlpZiAodm0pCisJCWdlbjZf
cHBndHRfdW5waW4oaTkxNV92bV90b19wcGd0dCh2bSkpOwogfQogCiBzdGF0aWMgaW50IF9fY29u
dGV4dF9waW4oc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQpAQCAtMTcwNCwxNCArMTcwNCwxNiBA
QCBzdGF0aWMgaW50IHN3aXRjaF9jb250ZXh0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogewog
CXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSA9IHJxLT5lbmdpbmU7CiAJc3RydWN0IGk5
MTVfZ2VtX2NvbnRleHQgKmN0eCA9IHJxLT5nZW1fY29udGV4dDsKLQlzdHJ1Y3QgaTkxNV9od19w
cGd0dCAqcHBndHQgPSBjdHgtPnBwZ3R0ID86IHJxLT5pOTE1LT5tbS5hbGlhc2luZ19wcGd0dDsK
KwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9CisJCWN0eC0+dm0gPzogJnJxLT5pOTE1
LT5tbS5hbGlhc2luZ19wcGd0dC0+dm07CiAJdW5zaWduZWQgaW50IHVud2luZF9tbSA9IDA7CiAJ
dTMyIGh3X2ZsYWdzID0gMDsKIAlpbnQgcmV0LCBpOwogCiAJR0VNX0JVR19PTihIQVNfRVhFQ0xJ
U1RTKHJxLT5pOTE1KSk7CiAKLQlpZiAocHBndHQpIHsKKwlpZiAodm0pIHsKKwkJc3RydWN0IGk5
MTVfaHdfcHBndHQgKnBwZ3R0ID0gaTkxNV92bV90b19wcGd0dCh2bSk7CiAJCWludCBsb29wczsK
IAogCQkvKgpAQCAtMTc1OCw3ICsxNzYwLDcgQEAgc3RhdGljIGludCBzd2l0Y2hfY29udGV4dChz
dHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIAkJCWdvdG8gZXJyX21tOwogCX0KIAotCWlmIChwcGd0
dCkgeworCWlmICh2bSkgewogCQlyZXQgPSBlbmdpbmUtPmVtaXRfZmx1c2gocnEsIEVNSVRfSU5W
QUxJREFURSk7CiAJCWlmIChyZXQpCiAJCQlnb3RvIGVycl9tbTsKQEAgLTE4MDEsNyArMTgwMyw3
IEBAIHN0YXRpYyBpbnQgc3dpdGNoX2NvbnRleHQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAK
IGVycl9tbToKIAlpZiAodW53aW5kX21tKQotCQlwcGd0dC0+cGRfZGlydHlfZW5naW5lcyB8PSB1
bndpbmRfbW07CisJCWk5MTVfdm1fdG9fcHBndHQodm0pLT5wZF9kaXJ0eV9lbmdpbmVzIHw9IHVu
d2luZF9tbTsKIGVycjoKIAlyZXR1cm4gcmV0OwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfaGFuZ2NoZWNrLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9zZWxmdGVzdF9oYW5nY2hlY2suYwppbmRleCAzYmU2N2U1NjFjMjYuLjQ1Mzc5YTYzZTAxMyAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfaGFuZ2NoZWNrLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfaGFuZ2NoZWNrLmMKQEAgLTEy
OCw4ICsxMjgsNyBAQCBzdGF0aWMgc3RydWN0IGk5MTVfcmVxdWVzdCAqCiBoYW5nX2NyZWF0ZV9y
ZXF1ZXN0KHN0cnVjdCBoYW5nICpoLCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7
CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBoLT5pOTE1OwotCXN0cnVjdCBpOTE1
X2FkZHJlc3Nfc3BhY2UgKnZtID0KLQkJaC0+Y3R4LT5wcGd0dCA/ICZoLT5jdHgtPnBwZ3R0LT52
bSA6ICZpOTE1LT5nZ3R0LnZtOworCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0gaC0+
Y3R4LT52bSA/OiAmaTkxNS0+Z2d0dC52bTsKIAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSA9IE5V
TEw7CiAJc3RydWN0IGk5MTVfdm1hICpod3MsICp2bWE7CiAJdW5zaWduZWQgaW50IGZsYWdzOwpA
QCAtMTM1NCw4ICsxMzUzLDggQEAgc3RhdGljIGludCBpZ3RfcmVzZXRfZXZpY3RfcHBndHQodm9p
ZCAqYXJnKQogCX0KIAogCWVyciA9IDA7Ci0JaWYgKGN0eC0+cHBndHQpIC8qIGFsaWFzaW5nID09
IGdsb2JhbCBndHQgbG9ja2luZywgY292ZXJlZCBhYm92ZSAqLwotCQllcnIgPSBfX2lndF9yZXNl
dF9ldmljdF92bWEoaTkxNSwgJmN0eC0+cHBndHQtPnZtLAorCWlmIChjdHgtPnZtKSAvKiBhbGlh
c2luZyA9PSBnbG9iYWwgZ3R0IGxvY2tpbmcsIGNvdmVyZWQgYWJvdmUgKi8KKwkJZXJyID0gX19p
Z3RfcmVzZXRfZXZpY3Rfdm1hKGk5MTUsIGN0eC0+dm0sCiAJCQkJCSAgICBldmljdF92bWEsIEVY
RUNfT0JKRUNUX1dSSVRFKTsKIAogb3V0OgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Qvc2VsZnRlc3RfbHJjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9s
cmMuYwppbmRleCAwNjU5MzI1NGI3ZDYuLmYwY2EyYTA5ZGFiZCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKQEAgLTEwOTAsNyArMTA5MCw3IEBAIHN0YXRpYyBpbnQgc21v
a2Vfc3VibWl0KHN0cnVjdCBwcmVlbXB0X3Ntb2tlICpzbW9rZSwKIAlpbnQgZXJyID0gMDsKIAog
CWlmIChiYXRjaCkgewotCQl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShiYXRjaCwgJmN0eC0+cHBn
dHQtPnZtLCBOVUxMKTsKKwkJdm1hID0gaTkxNV92bWFfaW5zdGFuY2UoYmF0Y2gsIGN0eC0+dm0s
IE5VTEwpOwogCQlpZiAoSVNfRVJSKHZtYSkpCiAJCQlyZXR1cm4gUFRSX0VSUih2bWEpOwogCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF93b3JrYXJvdW5kcy5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rfd29ya2Fyb3VuZHMuYwppbmRleCAy
Y2IxNTE5ZmRlNDIuLmM4ZDMzNWQ2M2Y5YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Qvc2VsZnRlc3Rfd29ya2Fyb3VuZHMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9zZWxmdGVzdF93b3JrYXJvdW5kcy5jCkBAIC0zNTgsNyArMzU4LDcgQEAgc3RhdGljIHN0cnVj
dCBpOTE1X3ZtYSAqY3JlYXRlX2JhdGNoKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCiAJ
aWYgKElTX0VSUihvYmopKQogCQlyZXR1cm4gRVJSX0NBU1Qob2JqKTsKIAotCXZtYSA9IGk5MTVf
dm1hX2luc3RhbmNlKG9iaiwgJmN0eC0+cHBndHQtPnZtLCBOVUxMKTsKKwl2bWEgPSBpOTE1X3Zt
YV9pbnN0YW5jZShvYmosIGN0eC0+dm0sIE5VTEwpOwogCWlmIChJU19FUlIodm1hKSkgewogCQll
cnIgPSBQVFJfRVJSKHZtYSk7CiAJCWdvdG8gZXJyX29iajsKQEAgLTQ0Miw3ICs0NDIsNyBAQCBz
dGF0aWMgaW50IGNoZWNrX2RpcnR5X3doaXRlbGlzdChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAq
Y3R4LAogCWludCBlcnIgPSAwLCBpLCB2OwogCXUzMiAqY3MsICpyZXN1bHRzOwogCi0Jc2NyYXRj
aCA9IGNyZWF0ZV9zY3JhdGNoKCZjdHgtPnBwZ3R0LT52bSwgMiAqIEFSUkFZX1NJWkUodmFsdWVz
KSArIDEpOworCXNjcmF0Y2ggPSBjcmVhdGVfc2NyYXRjaChjdHgtPnZtLCAyICogQVJSQVlfU0la
RSh2YWx1ZXMpICsgMSk7CiAJaWYgKElTX0VSUihzY3JhdGNoKSkKIAkJcmV0dXJuIFBUUl9FUlIo
c2NyYXRjaCk7CiAKQEAgLTkyNSw3ICs5MjUsNyBAQCBzdGF0aWMgaW50IGxpdmVfaXNvbGF0ZWRf
d2hpdGVsaXN0KHZvaWQgKmFyZykKIAlpZiAoIWludGVsX2VuZ2luZXNfaGFzX2NvbnRleHRfaXNv
bGF0aW9uKGk5MTUpKQogCQlyZXR1cm4gMDsKIAotCWlmICghaTkxNS0+a2VybmVsX2NvbnRleHQt
PnBwZ3R0KQorCWlmICghaTkxNS0+a2VybmVsX2NvbnRleHQtPnZtKQogCQlyZXR1cm4gMDsKIAog
CWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGNsaWVudCk7IGkrKykgewpAQCAtOTM3LDE0ICs5
MzcsMTQgQEAgc3RhdGljIGludCBsaXZlX2lzb2xhdGVkX3doaXRlbGlzdCh2b2lkICphcmcpCiAJ
CQlnb3RvIGVycjsKIAkJfQogCi0JCWNsaWVudFtpXS5zY3JhdGNoWzBdID0gY3JlYXRlX3NjcmF0
Y2goJmMtPnBwZ3R0LT52bSwgMTAyNCk7CisJCWNsaWVudFtpXS5zY3JhdGNoWzBdID0gY3JlYXRl
X3NjcmF0Y2goYy0+dm0sIDEwMjQpOwogCQlpZiAoSVNfRVJSKGNsaWVudFtpXS5zY3JhdGNoWzBd
KSkgewogCQkJZXJyID0gUFRSX0VSUihjbGllbnRbaV0uc2NyYXRjaFswXSk7CiAJCQlrZXJuZWxf
Y29udGV4dF9jbG9zZShjKTsKIAkJCWdvdG8gZXJyOwogCQl9CiAKLQkJY2xpZW50W2ldLnNjcmF0
Y2hbMV0gPSBjcmVhdGVfc2NyYXRjaCgmYy0+cHBndHQtPnZtLCAxMDI0KTsKKwkJY2xpZW50W2ld
LnNjcmF0Y2hbMV0gPSBjcmVhdGVfc2NyYXRjaChjLT52bSwgMTAyNCk7CiAJCWlmIChJU19FUlIo
Y2xpZW50W2ldLnNjcmF0Y2hbMV0pKSB7CiAJCQllcnIgPSBQVFJfRVJSKGNsaWVudFtpXS5zY3Jh
dGNoWzFdKTsKIAkJCWk5MTVfdm1hX3VucGluX2FuZF9yZWxlYXNlKCZjbGllbnRbaV0uc2NyYXRj
aFswXSwgMCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVy
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMKaW5kZXggYTA5YWQ5OGEz
ZjQzLi5jZTZkMmYwNmU4ZjcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9z
Y2hlZHVsZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMKQEAg
LTM2OCw3ICszNjgsNyBAQCBzdGF0aWMgaW50IHNldF9jb250ZXh0X3BwZ3R0X2Zyb21fc2hhZG93
KHN0cnVjdCBpbnRlbF92Z3B1X3dvcmtsb2FkICp3b3JrbG9hZCwKIAkJCQkJIHN0cnVjdCBpOTE1
X2dlbV9jb250ZXh0ICpjdHgpCiB7CiAJc3RydWN0IGludGVsX3ZncHVfbW0gKm1tID0gd29ya2xv
YWQtPnNoYWRvd19tbTsKLQlzdHJ1Y3QgaTkxNV9od19wcGd0dCAqcHBndHQgPSBjdHgtPnBwZ3R0
OworCXN0cnVjdCBpOTE1X2h3X3BwZ3R0ICpwcGd0dCA9IGk5MTVfdm1fdG9fcHBndHQoY3R4LT52
bSk7CiAJaW50IGkgPSAwOwogCiAJaWYgKG1tLT50eXBlICE9IElOVEVMX0dWVF9NTV9QUEdUVCB8
fCAhbW0tPnBwZ3R0X21tLnNoYWRvd2VkKQpAQCAtMTEzMCw3ICsxMTMwLDcgQEAgdm9pZCBpbnRl
bF92Z3B1X2NsZWFuX3N1Ym1pc3Npb24oc3RydWN0IGludGVsX3ZncHUgKnZncHUpCiAKIAlpbnRl
bF92Z3B1X3NlbGVjdF9zdWJtaXNzaW9uX29wcyh2Z3B1LCBBTExfRU5HSU5FUywgMCk7CiAKLQlp
OTE1X2NvbnRleHRfcHBndHRfcm9vdF9yZXN0b3JlKHMsIHMtPnNoYWRvd1swXS0+Z2VtX2NvbnRl
eHQtPnBwZ3R0KTsKKwlpOTE1X2NvbnRleHRfcHBndHRfcm9vdF9yZXN0b3JlKHMsIGk5MTVfdm1f
dG9fcHBndHQocy0+c2hhZG93WzBdLT5nZW1fY29udGV4dC0+dm0pKTsKIAlmb3JfZWFjaF9lbmdp
bmUoZW5naW5lLCB2Z3B1LT5ndnQtPmRldl9wcml2LCBpZCkKIAkJaW50ZWxfY29udGV4dF91bnBp
bihzLT5zaGFkb3dbaWRdKTsKIApAQCAtMTE5NSw3ICsxMTk1LDcgQEAgaW50IGludGVsX3ZncHVf
c2V0dXBfc3VibWlzc2lvbihzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKIAlpZiAoSVNfRVJSKGN0
eCkpCiAJCXJldHVybiBQVFJfRVJSKGN0eCk7CiAKLQlpOTE1X2NvbnRleHRfcHBndHRfcm9vdF9z
YXZlKHMsIGN0eC0+cHBndHQpOworCWk5MTVfY29udGV4dF9wcGd0dF9yb290X3NhdmUocywgaTkx
NV92bV90b19wcGd0dChjdHgtPnZtKSk7CiAKIAlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCB2Z3B1
LT5ndnQtPmRldl9wcml2LCBpKSB7CiAJCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsKQEAgLTEy
MzgsNyArMTIzOCw3IEBAIGludCBpbnRlbF92Z3B1X3NldHVwX3N1Ym1pc3Npb24oc3RydWN0IGlu
dGVsX3ZncHUgKnZncHUpCiAJcmV0dXJuIDA7CiAKIG91dF9zaGFkb3dfY3R4OgotCWk5MTVfY29u
dGV4dF9wcGd0dF9yb290X3Jlc3RvcmUocywgY3R4LT5wcGd0dCk7CisJaTkxNV9jb250ZXh0X3Bw
Z3R0X3Jvb3RfcmVzdG9yZShzLCBpOTE1X3ZtX3RvX3BwZ3R0KGN0eC0+dm0pKTsKIAlmb3JfZWFj
aF9lbmdpbmUoZW5naW5lLCB2Z3B1LT5ndnQtPmRldl9wcml2LCBpKSB7CiAJCWlmIChJU19FUlIo
cy0+c2hhZG93W2ldKSkKIAkJCWJyZWFrOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9kZWJ1Z2ZzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwpp
bmRleCA0YTdmN2VmMWM5ZWEuLjNkM2QyN2ZmNWRhYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9k
ZWJ1Z2ZzLmMKQEAgLTMzNiw3ICszMzYsNyBAQCBzdGF0aWMgdm9pZCBwcmludF9jb250ZXh0X3N0
YXRzKHN0cnVjdCBzZXFfZmlsZSAqbSwKIAkJaTkxNV9nZW1fY29udGV4dF91bmxvY2tfZW5naW5l
cyhjdHgpOwogCiAJCWlmICghSVNfRVJSX09SX05VTEwoY3R4LT5maWxlX3ByaXYpKSB7Ci0JCQlz
dHJ1Y3QgZmlsZV9zdGF0cyBzdGF0cyA9IHsgLnZtID0gJmN0eC0+cHBndHQtPnZtLCB9OworCQkJ
c3RydWN0IGZpbGVfc3RhdHMgc3RhdHMgPSB7IC52bSA9IGN0eC0+dm0sIH07CiAJCQlzdHJ1Y3Qg
ZHJtX2ZpbGUgKmZpbGUgPSBjdHgtPmZpbGVfcHJpdi0+ZmlsZTsKIAkJCXN0cnVjdCB0YXNrX3N0
cnVjdCAqdGFzazsKIAkJCWNoYXIgbmFtZVs4MF07CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2Rydi5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAppbmRl
eCA1MjI5YTRkZjA4NzkuLjc3OTkwN2I1YTM3MCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9kcnYuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCkBA
IC0yNzYzLDEyICsyNzYzLDYgQEAgc3RydWN0IGRybV9nZW1fb2JqZWN0ICppOTE1X2dlbV9wcmlt
ZV9pbXBvcnQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKIHN0cnVjdCBkbWFfYnVmICppOTE1X2dl
bV9wcmltZV9leHBvcnQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKIAkJCQlzdHJ1Y3QgZHJtX2dl
bV9vYmplY3QgKmdlbV9vYmosIGludCBmbGFncyk7CiAKLXN0YXRpYyBpbmxpbmUgc3RydWN0IGk5
MTVfaHdfcHBndHQgKgotaTkxNV92bV90b19wcGd0dChzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNl
ICp2bSkKLXsKLQlyZXR1cm4gY29udGFpbmVyX29mKHZtLCBzdHJ1Y3QgaTkxNV9od19wcGd0dCwg
dm0pOwotfQotCiAvKiBpOTE1X2dlbV9mZW5jZV9yZWcuYyAqLwogc3RydWN0IGRybV9pOTE1X2Zl
bmNlX3JlZyAqCiBpOTE1X3Jlc2VydmVfZmVuY2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMKaW5kZXggNTAwMGE5OTBkZGYz
Li40ZDE3MzcyZTE4ZWQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2Vt
X2d0dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jCkBAIC00Nzks
NiArNDc5LDggQEAgc3RhdGljIHZvaWQgdm1fZnJlZV9wYWdlKHN0cnVjdCBpOTE1X2FkZHJlc3Nf
c3BhY2UgKnZtLCBzdHJ1Y3QgcGFnZSAqcGFnZSkKIAogc3RhdGljIHZvaWQgaTkxNV9hZGRyZXNz
X3NwYWNlX2luaXQoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sIGludCBzdWJjbGFzcykK
IHsKKwlrcmVmX2luaXQoJnZtLT5yZWYpOworCiAJLyoKIAkgKiBUaGUgdm0tPm11dGV4IG11c3Qg
YmUgcmVjbGFpbSBzYWZlIChmb3IgdXNlIGluIHRoZSBzaHJpbmtlcikuCiAJICogRG8gYSBkdW1t
eSBhY3F1aXJlIG5vdyB1bmRlciBmc19yZWNsYWltIHNvIHRoYXQgYW55IGFsbG9jYXRpb24KQEAg
LTEyMjYsOSArMTIyOCw4IEBAIHN0YXRpYyBpbnQgZ2VuOF9pbml0X3NjcmF0Y2goc3RydWN0IGk5
MTVfYWRkcmVzc19zcGFjZSAqdm0pCiAJICovCiAJaWYgKHZtLT5oYXNfcmVhZF9vbmx5ICYmCiAJ
ICAgIHZtLT5pOTE1LT5rZXJuZWxfY29udGV4dCAmJgotCSAgICB2bS0+aTkxNS0+a2VybmVsX2Nv
bnRleHQtPnBwZ3R0KSB7Ci0JCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKmNsb25lID0KLQkJ
CSZ2bS0+aTkxNS0+a2VybmVsX2NvbnRleHQtPnBwZ3R0LT52bTsKKwkgICAgdm0tPmk5MTUtPmtl
cm5lbF9jb250ZXh0LT52bSkgeworCQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICpjbG9uZSA9
IHZtLT5pOTE1LT5rZXJuZWxfY29udGV4dC0+dm07CiAKIAkJR0VNX0JVR19PTighY2xvbmUtPmhh
c19yZWFkX29ubHkpOwogCkBAIC0xNTg3LDggKzE1ODgsNiBAQCBzdGF0aWMgaW50IGdlbjhfcHJl
YWxsb2NhdGVfdG9wX2xldmVsX3BkcChzdHJ1Y3QgaTkxNV9od19wcGd0dCAqcHBndHQpCiBzdGF0
aWMgdm9pZCBwcGd0dF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCQkgICAg
ICAgc3RydWN0IGk5MTVfaHdfcHBndHQgKnBwZ3R0KQogewotCWtyZWZfaW5pdCgmcHBndHQtPnJl
Zik7Ci0KIAlwcGd0dC0+dm0uaTkxNSA9IGk5MTU7CiAJcHBndHQtPnZtLmRtYSA9ICZpOTE1LT5k
cm0ucGRldi0+ZGV2OwogCXBwZ3R0LT52bS50b3RhbCA9IEJJVF9VTEwoSU5URUxfSU5GTyhpOTE1
KS0+cHBndHRfc2l6ZSk7CkBAIC0yMjY1LDIxICsyMjY0LDIzIEBAIHN0YXRpYyB2b2lkIHBwZ3R0
X2Rlc3Ryb3lfdm1hKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtKQogCX0KIH0KIAotdm9p
ZCBpOTE1X3BwZ3R0X3JlbGVhc2Uoc3RydWN0IGtyZWYgKmtyZWYpCit2b2lkIGk5MTVfdm1fcmVs
ZWFzZShzdHJ1Y3Qga3JlZiAqa3JlZikKIHsKLQlzdHJ1Y3QgaTkxNV9od19wcGd0dCAqcHBndHQg
PQotCQljb250YWluZXJfb2Yoa3JlZiwgc3RydWN0IGk5MTVfaHdfcHBndHQsIHJlZik7CisJc3Ry
dWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPQorCQljb250YWluZXJfb2Yoa3JlZiwgc3RydWN0
IGk5MTVfYWRkcmVzc19zcGFjZSwgcmVmKTsKIAotCXRyYWNlX2k5MTVfcHBndHRfcmVsZWFzZSgm
cHBndHQtPnZtKTsKKwlHRU1fQlVHX09OKGk5MTVfaXNfZ2d0dCh2bSkpOworCXRyYWNlX2k5MTVf
cHBndHRfcmVsZWFzZSh2bSk7CiAKLQlwcGd0dF9kZXN0cm95X3ZtYSgmcHBndHQtPnZtKTsKKwlw
cGd0dF9kZXN0cm95X3ZtYSh2bSk7CiAKLQlHRU1fQlVHX09OKCFsaXN0X2VtcHR5KCZwcGd0dC0+
dm0uYm91bmRfbGlzdCkpOwotCUdFTV9CVUdfT04oIWxpc3RfZW1wdHkoJnBwZ3R0LT52bS51bmJv
dW5kX2xpc3QpKTsKKwlHRU1fQlVHX09OKCFsaXN0X2VtcHR5KCZ2bS0+Ym91bmRfbGlzdCkpOwor
CUdFTV9CVUdfT04oIWxpc3RfZW1wdHkoJnZtLT51bmJvdW5kX2xpc3QpKTsKIAotCXBwZ3R0LT52
bS5jbGVhbnVwKCZwcGd0dC0+dm0pOwotCWk5MTVfYWRkcmVzc19zcGFjZV9maW5pKCZwcGd0dC0+
dm0pOwotCWtmcmVlKHBwZ3R0KTsKKwl2bS0+Y2xlYW51cCh2bSk7CisJaTkxNV9hZGRyZXNzX3Nw
YWNlX2Zpbmkodm0pOworCisJa2ZyZWUodm0pOwogfQogCiAvKiBDZXJ0YWluIEdlbjUgY2hpcHNl
dHMgcmVxdWlyZSByZXF1aXJlIGlkbGluZyB0aGUgR1BVIGJlZm9yZQpAQCAtMjg0NCw3ICsyODQ1
LDcgQEAgaW50IGk5MTVfZ2VtX2luaXRfYWxpYXNpbmdfcHBndHQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCiAJcmV0dXJuIDA7CiAKIGVycl9wcGd0dDoKLQlpOTE1X3BwZ3R0X3B1dChw
cGd0dCk7CisJaTkxNV92bV9wdXQoJnBwZ3R0LT52bSk7CiAJcmV0dXJuIGVycjsKIH0KIApAQCAt
Mjg1Nyw3ICsyODU4LDcgQEAgdm9pZCBpOTE1X2dlbV9maW5pX2FsaWFzaW5nX3BwZ3R0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCWlmICghcHBndHQpCiAJCXJldHVybjsKIAotCWk5
MTVfcHBndHRfcHV0KHBwZ3R0KTsKKwlpOTE1X3ZtX3B1dCgmcHBndHQtPnZtKTsKIAogCWdndHQt
PnZtLnZtYV9vcHMuYmluZF92bWEgICA9IGdndHRfYmluZF92bWE7CiAJZ2d0dC0+dm0udm1hX29w
cy51bmJpbmRfdm1hID0gZ2d0dF91bmJpbmRfdm1hOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9n
dHQuaAppbmRleCAxNTJhMDM1NjBjMjIuLjI5OTI4YjU4YTNjZSAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9nZW1fZ3R0LmgKQEAgLTI5Myw2ICsyOTMsOCBAQCBzdHJ1Y3QgcGFnZXN0YXNoIHsKIH07
CiAKIHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgeworCXN0cnVjdCBrcmVmIHJlZjsKKwogCXN0
cnVjdCBkcm1fbW0gbW07CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTU7CiAJc3RydWN0
IGRldmljZSAqZG1hOwpAQCAtNDEyLDcgKzQxNCw2IEBAIHN0cnVjdCBpOTE1X2dndHQgewogCiBz
dHJ1Y3QgaTkxNV9od19wcGd0dCB7CiAJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSB2bTsKLQlz
dHJ1Y3Qga3JlZiByZWY7CiAKIAlpbnRlbF9lbmdpbmVfbWFza190IHBkX2RpcnR5X2VuZ2luZXM7
CiAJdW5pb24gewpAQCAtNTgyLDEwICs1ODMsMTkgQEAgaTkxNV9wYWdlX2Rpcl9kbWFfYWRkcihj
b25zdCBzdHJ1Y3QgaTkxNV9od19wcGd0dCAqcHBndHQsIGNvbnN0IHVuc2lnbmVkIG4pCiBzdGF0
aWMgaW5saW5lIHN0cnVjdCBpOTE1X2dndHQgKgogaTkxNV92bV90b19nZ3R0KHN0cnVjdCBpOTE1
X2FkZHJlc3Nfc3BhY2UgKnZtKQogeworCUJVSUxEX0JVR19PTihvZmZzZXRvZihzdHJ1Y3QgaTkx
NV9nZ3R0LCB2bSkpOwogCUdFTV9CVUdfT04oIWk5MTVfaXNfZ2d0dCh2bSkpOwogCXJldHVybiBj
b250YWluZXJfb2Yodm0sIHN0cnVjdCBpOTE1X2dndHQsIHZtKTsKIH0KIAorc3RhdGljIGlubGlu
ZSBzdHJ1Y3QgaTkxNV9od19wcGd0dCAqCitpOTE1X3ZtX3RvX3BwZ3R0KHN0cnVjdCBpOTE1X2Fk
ZHJlc3Nfc3BhY2UgKnZtKQoreworCUJVSUxEX0JVR19PTihvZmZzZXRvZihzdHJ1Y3QgaTkxNV9o
d19wcGd0dCwgdm0pKTsKKwlHRU1fQlVHX09OKGk5MTVfaXNfZ2d0dCh2bSkpOworCXJldHVybiBj
b250YWluZXJfb2Yodm0sIHN0cnVjdCBpOTE1X2h3X3BwZ3R0LCB2bSk7Cit9CisKICNkZWZpbmUg
SU5URUxfTUFYX1BQQVRfRU5UUklFUyA4CiAjZGVmaW5lIElOVEVMX1BQQVRfUEVSRkVDVF9NQVRD
SCAofjBVKQogCkBAIC02MzEsMTggKzY0MSwxOSBAQCB2b2lkIGk5MTVfZ2d0dF9jbGVhbnVwX2h3
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiBpbnQgaTkxNV9wcGd0dF9pbml0
X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiAKIHN0cnVjdCBpOTE1X2h3
X3BwZ3R0ICppOTE1X3BwZ3R0X2NyZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpOwotdm9pZCBpOTE1X3BwZ3R0X3JlbGVhc2Uoc3RydWN0IGtyZWYgKmtyZWYpOwogCi1zdGF0
aWMgaW5saW5lIHN0cnVjdCBpOTE1X2h3X3BwZ3R0ICppOTE1X3BwZ3R0X2dldChzdHJ1Y3QgaTkx
NV9od19wcGd0dCAqcHBndHQpCitzdGF0aWMgaW5saW5lIHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3Bh
Y2UgKgoraTkxNV92bV9nZXQoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0pCiB7Ci0Ja3Jl
Zl9nZXQoJnBwZ3R0LT5yZWYpOwotCXJldHVybiBwcGd0dDsKKwlrcmVmX2dldCgmdm0tPnJlZik7
CisJcmV0dXJuIHZtOwogfQogCi1zdGF0aWMgaW5saW5lIHZvaWQgaTkxNV9wcGd0dF9wdXQoc3Ry
dWN0IGk5MTVfaHdfcHBndHQgKnBwZ3R0KQordm9pZCBpOTE1X3ZtX3JlbGVhc2Uoc3RydWN0IGty
ZWYgKmtyZWYpOworCitzdGF0aWMgaW5saW5lIHZvaWQgaTkxNV92bV9wdXQoc3RydWN0IGk5MTVf
YWRkcmVzc19zcGFjZSAqdm0pCiB7Ci0JaWYgKHBwZ3R0KQotCQlrcmVmX3B1dCgmcHBndHQtPnJl
ZiwgaTkxNV9wcGd0dF9yZWxlYXNlKTsKKwlrcmVmX3B1dCgmdm0tPnJlZiwgaTkxNV92bV9yZWxl
YXNlKTsKIH0KIAogaW50IGdlbjZfcHBndHRfcGluKHN0cnVjdCBpOTE1X2h3X3BwZ3R0ICpiYXNl
KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jCmluZGV4IDcwNzgxMTI1NjUwMS4u
YWZlZDJhMWZiMDIxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9l
cnJvci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmMKQEAgLTE0
MjUsNyArMTQyNSw3IEBAIHN0YXRpYyB2b2lkIGdlbV9yZWNvcmRfcmluZ3Moc3RydWN0IGk5MTVf
Z3B1X3N0YXRlICplcnJvcikKIAkJCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHggPSByZXF1
ZXN0LT5nZW1fY29udGV4dDsKIAkJCXN0cnVjdCBpbnRlbF9yaW5nICpyaW5nOwogCi0JCQllZS0+
dm0gPSBjdHgtPnBwZ3R0ID8gJmN0eC0+cHBndHQtPnZtIDogJmdndHQtPnZtOworCQkJZWUtPnZt
ID0gY3R4LT52bSA/OiAmZ2d0dC0+dm07CiAKIAkJCXJlY29yZF9jb250ZXh0KCZlZS0+Y29udGV4
dCwgY3R4KTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90cmFjZS5o
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90cmFjZS5oCmluZGV4IDgzYjM4OWUzNGI1MC4u
NWM4Y2ZhYTcwZDcyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3RyYWNl
LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90cmFjZS5oCkBAIC05NzcsNyArOTc3
LDcgQEAgREVDTEFSRV9FVkVOVF9DTEFTUyhpOTE1X2NvbnRleHQsCiAJCQlfX2VudHJ5LT5kZXYg
PSBjdHgtPmk5MTUtPmRybS5wcmltYXJ5LT5pbmRleDsKIAkJCV9fZW50cnktPmN0eCA9IGN0eDsK
IAkJCV9fZW50cnktPmh3X2lkID0gY3R4LT5od19pZDsKLQkJCV9fZW50cnktPnZtID0gY3R4LT5w
cGd0dCA/ICZjdHgtPnBwZ3R0LT52bSA6IE5VTEw7CisJCQlfX2VudHJ5LT52bSA9IGN0eC0+dm07
CiAJKSwKIAogCVRQX3ByaW50aygiZGV2PSV1LCBjdHg9JXAsIGN0eF92bT0lcCwgaHdfaWQ9JXUi
LApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0
dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jCmluZGV4
IGRkYThiOWM3OWMzNy4uOGU0MTViODFlNjZiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZ3R0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
c2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jCkBAIC0yMDksNyArMjA5LDcgQEAgc3RhdGljIGludCBp
Z3RfcHBndHRfYWxsb2Modm9pZCAqYXJnKQogCiBlcnJfcHBndHRfY2xlYW51cDoKIAltdXRleF9s
b2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0JaTkxNV9wcGd0dF9wdXQocHBndHQp
OworCWk5MTVfdm1fcHV0KCZwcGd0dC0+dm0pOwogCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRy
bS5zdHJ1Y3RfbXV0ZXgpOwogCXJldHVybiBlcnI7CiB9CkBAIC0xMDIxLDcgKzEwMjEsNyBAQCBz
dGF0aWMgaW50IGV4ZXJjaXNlX3BwZ3R0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKIAogCWVyciA9IGZ1bmMoZGV2X3ByaXYsICZwcGd0dC0+dm0sIDAsIHBwZ3R0LT52bS50b3Rh
bCwgZW5kX3RpbWUpOwogCi0JaTkxNV9wcGd0dF9wdXQocHBndHQpOworCWk5MTVfdm1fcHV0KCZw
cGd0dC0+dm0pOwogb3V0X3VubG9jazoKIAltdXRleF91bmxvY2soJmRldl9wcml2LT5kcm0uc3Ry
dWN0X211dGV4KTsKIApAQCAtMTI1MSw3ICsxMjUxLDYgQEAgc3RhdGljIGludCBleGVyY2lzZV9t
b2NrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogewogCWNvbnN0IHU2NCBsaW1pdCA9
IHRvdGFscmFtX3BhZ2VzKCkgPDwgUEFHRV9TSElGVDsKIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4
dCAqY3R4OwotCXN0cnVjdCBpOTE1X2h3X3BwZ3R0ICpwcGd0dDsKIAlJR1RfVElNRU9VVChlbmRf
dGltZSk7CiAJaW50IGVycjsKIApAQCAtMTI1OSwxMCArMTI1OCw3IEBAIHN0YXRpYyBpbnQgZXhl
cmNpc2VfbW9jayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAlpZiAoIWN0eCkKIAkJ
cmV0dXJuIC1FTk9NRU07CiAKLQlwcGd0dCA9IGN0eC0+cHBndHQ7Ci0JR0VNX0JVR19PTighcHBn
dHQpOwotCi0JZXJyID0gZnVuYyhpOTE1LCAmcHBndHQtPnZtLCAwLCBtaW4ocHBndHQtPnZtLnRv
dGFsLCBsaW1pdCksIGVuZF90aW1lKTsKKwllcnIgPSBmdW5jKGk5MTUsIGN0eC0+dm0sIDAsIG1p
bihjdHgtPnZtLT50b3RhbCwgbGltaXQpLCBlbmRfdGltZSk7CiAKIAltb2NrX2NvbnRleHRfY2xv
c2UoY3R4KTsKIAlyZXR1cm4gZXJyOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
c2VsZnRlc3RzL2k5MTVfcmVxdWVzdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3Rz
L2k5MTVfcmVxdWVzdC5jCmluZGV4IGRmYWE1YmM1MmVjYy4uMTEyNzhiYWMzYTI0IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9yZXF1ZXN0LmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfcmVxdWVzdC5jCkBAIC03NTQsOCAr
NzU0LDcgQEAgc3RhdGljIGludCBsaXZlX2VtcHR5X3JlcXVlc3Qodm9pZCAqYXJnKQogc3RhdGlj
IHN0cnVjdCBpOTE1X3ZtYSAqcmVjdXJzaXZlX2JhdGNoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQogewogCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHggPSBpOTE1LT5rZXJuZWxf
Y29udGV4dDsKLQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9Ci0JCWN0eC0+cHBndHQg
PyAmY3R4LT5wcGd0dC0+dm0gOiAmaTkxNS0+Z2d0dC52bTsKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNz
X3NwYWNlICp2bSA9IGN0eC0+dm0gPzogJmk5MTUtPmdndHQudm07CiAJc3RydWN0IGRybV9pOTE1
X2dlbV9vYmplY3QgKm9iajsKIAljb25zdCBpbnQgZ2VuID0gSU5URUxfR0VOKGk5MTUpOwogCXN0
cnVjdCBpOTE1X3ZtYSAqdm1hOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2Vs
ZnRlc3RzL2k5MTVfdm1hLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV92
bWEuYwppbmRleCA2ZjNlNDFjMGNiM2YuLmExNjZkOTQwNWE5NCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfdm1hLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvc2VsZnRlc3RzL2k5MTVfdm1hLmMKQEAgLTM4LDcgKzM4LDcgQEAgc3RhdGljIGJvb2wg
YXNzZXJ0X3ZtYShzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKIHsKIAlib29sIG9rID0gdHJ1ZTsKIAot
CWlmICh2bWEtPnZtICE9ICZjdHgtPnBwZ3R0LT52bSkgeworCWlmICh2bWEtPnZtICE9IGN0eC0+
dm0pIHsKIAkJcHJfZXJyKCJWTUEgY3JlYXRlZCB3aXRoIHdyb25nIFZNXG4iKTsKIAkJb2sgPSBm
YWxzZTsKIAl9CkBAIC0xMTMsNyArMTEzLDcgQEAgc3RhdGljIGludCBjcmVhdGVfdm1hcyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAlsaXN0X2Zvcl9lYWNoX2VudHJ5KG9iaiwgb2Jq
ZWN0cywgc3RfbGluaykgewogCQlmb3IgKHBpbm5lZCA9IDA7IHBpbm5lZCA8PSAxOyBwaW5uZWQr
KykgewogCQkJbGlzdF9mb3JfZWFjaF9lbnRyeShjdHgsIGNvbnRleHRzLCBsaW5rKSB7Ci0JCQkJ
c3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSAmY3R4LT5wcGd0dC0+dm07CisJCQkJc3Ry
dWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSBjdHgtPnZtOwogCQkJCXN0cnVjdCBpOTE1X3Zt
YSAqdm1hOwogCQkJCWludCBlcnI7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L3NlbGZ0ZXN0cy9pZ3Rfc3Bpbm5lci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3Rz
L2lndF9zcGlubmVyLmMKaW5kZXggM2VhNzdjMGNhNjc4Li4xZTU5YjU0M2NmMjcgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pZ3Rfc3Bpbm5lci5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pZ3Rfc3Bpbm5lci5jCkBAIC04OSwxNyArODks
MTYgQEAgaWd0X3NwaW5uZXJfY3JlYXRlX3JlcXVlc3Qoc3RydWN0IGlndF9zcGlubmVyICpzcGlu
LAogCQkJICAgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAogCQkJICAgdTMyIGFyYml0
cmF0aW9uX2NvbW1hbmQpCiB7Ci0Jc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSAmY3R4
LT5wcGd0dC0+dm07CiAJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEgPSBOVUxMOwogCXN0cnVjdCBp
OTE1X3ZtYSAqaHdzLCAqdm1hOwogCXUzMiAqYmF0Y2g7CiAJaW50IGVycjsKIAotCXZtYSA9IGk5
MTVfdm1hX2luc3RhbmNlKHNwaW4tPm9iaiwgdm0sIE5VTEwpOworCXZtYSA9IGk5MTVfdm1hX2lu
c3RhbmNlKHNwaW4tPm9iaiwgY3R4LT52bSwgTlVMTCk7CiAJaWYgKElTX0VSUih2bWEpKQogCQly
ZXR1cm4gRVJSX0NBU1Qodm1hKTsKIAotCWh3cyA9IGk5MTVfdm1hX2luc3RhbmNlKHNwaW4tPmh3
cywgdm0sIE5VTEwpOworCWh3cyA9IGk5MTVfdm1hX2luc3RhbmNlKHNwaW4tPmh3cywgY3R4LT52
bSwgTlVMTCk7CiAJaWYgKElTX0VSUihod3MpKQogCQlyZXR1cm4gRVJSX0NBU1QoaHdzKTsKIApk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfZ3R0LmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvbW9ja19ndHQuYwppbmRleCBjZDgzOTI5ZmRl
OGUuLjllNjFjMmYwNmNjOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRl
c3RzL21vY2tfZ3R0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tf
Z3R0LmMKQEAgLTY1LDcgKzY1LDYgQEAgbW9ja19wcGd0dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwKIAlpZiAoIXBwZ3R0KQogCQlyZXR1cm4gTlVMTDsKIAotCWtyZWZfaW5pdCgmcHBn
dHQtPnJlZik7CiAJcHBndHQtPnZtLmk5MTUgPSBpOTE1OwogCXBwZ3R0LT52bS50b3RhbCA9IHJv
dW5kX2Rvd24oVTY0X01BWCwgUEFHRV9TSVpFKTsKIAlwcGd0dC0+dm0uZmlsZSA9IEVSUl9QVFIo
LUVOT0RFVik7Ci0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVk
ZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZv
L2ludGVsLWdmeA==

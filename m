Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id CD6AF14EB37
	for <lists+intel-gfx@lfdr.de>; Fri, 31 Jan 2020 11:46:29 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D211A6FAE5;
	Fri, 31 Jan 2020 10:46:27 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (unknown [77.68.26.236])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6D4A86E963
 for <intel-gfx@lists.freedesktop.org>; Fri, 31 Jan 2020 10:46:06 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 20070421-1500050 
 for multiple; Fri, 31 Jan 2020 10:45:50 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 31 Jan 2020 10:45:45 +0000
Message-Id: <20200131104548.2451485-9-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.25.0
In-Reply-To: <20200131104548.2451485-1-chris@chris-wilson.co.uk>
References: <20200131104548.2451485-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 09/12] drm/i915/gt: Split logical ring context
 manipulation into intel_lrc.c
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RXh0cmFjdCB0aGUgY29yZSBmdW5jdGlvbnMgZm9yIHNldHRpbmcgdXAgdGhlIG1hY2hpbmUgZGVw
ZW5kZW50IGxvZ2ljYWwKcmluZyBjb250ZXh0IHRvIGludGVsX2xyYy5jLiBUaGlzIHdpbGwgYmUg
c2hhcmVkIGJ5IGFsbCBzdWJtaXNzaW9uCmJhY2tlbmRzIHRoYXQgdXRpbGlzZSBsb2dpY2FsIHJp
bmcgY29udGV4dHMuCgp2MjogU3BsaXQgaW50ZWxfbHJjLmggYXMgd2VsbAoKU2lnbmVkLW9mZi1i
eTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+CkNjOiBEYW5pZWxlIENl
cmFvbG8gU3B1cmlvIDxkYW5pZWxlLmNlcmFvbG9zcHVyaW9AaW50ZWwuY29tPgpDYzogVHZydGtv
IFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KUmV2aWV3ZWQtYnk6IERhbmllbGUg
Q2VyYW9sbyBTcHVyaW8gPGRhbmllbGUuY2VyYW9sb3NwdXJpb0BpbnRlbC5jb20+Ci0tLQogZHJp
dmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUgICAgICAgICAgICAgICAgIHwgICAgMyArCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9nZW44X2VuZ2luZV9jcy5jICAgICAgfCAgMzQwICsrKysKIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2dlbjhfZW5naW5lX2NzLmggICAgICB8ICAgMjcgKwogZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dF9zc2V1LmMgIHwgICAgMiArLQogLi4u
L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV93b3JrYXJvdW5kX2JiLmMgIHwgIDMzNyArKysrCiAu
Li4vZHJtL2k5MTUvZ3QvaW50ZWxfZXhlY2xpc3RzX3N1Ym1pc3Npb24uYyAgfCAxNTI1ICstLS0t
LS0tLS0tLS0tLS0tCiAuLi4vZHJtL2k5MTUvZ3QvaW50ZWxfZXhlY2xpc3RzX3N1Ym1pc3Npb24u
aCAgfCAgIDE2IC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jICAgICAgICAg
ICB8ICA4MzAgKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuaCAg
ICAgICAgICAgfCAgIDQ3ICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2V4ZWNs
aXN0cy5jICB8ICA0OTggKy0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9s
cmMuYyAgICAgICAgfCAgNTQ0ICsrKysrKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50
ZWxfZ3VjX2Fkcy5jICAgIHwgICAgMiArLQogLi4uL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9n
dWNfc3VibWlzc2lvbi5jIHwgICAzNiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L21taW9f
Y29udGV4dC5jICAgICAgIHwgICAgMSArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1
bGVyLmMgICAgICAgICAgfCAgICAxICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5j
ICAgICAgICAgICAgICB8ICAgIDEgKwogMTYgZmlsZXMgY2hhbmdlZCwgMjIwMCBpbnNlcnRpb25z
KCspLCAyMDEwIGRlbGV0aW9ucygtKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2dlbjhfZW5naW5lX2NzLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9nZW44X2VuZ2luZV9jcy5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3dvcmthcm91bmRfYmIuYwogY3JlYXRlIG1v
ZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCiBjcmVhdGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmgKIGNyZWF0ZSBtb2Rl
IDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwoKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
TWFrZWZpbGUKaW5kZXggZjJiNTc0MjIxOGEwLi4xMmQ1M2U5YTAyNmEgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01h
a2VmaWxlCkBAIC03OCw2ICs3OCw3IEBAIGd0LXkgKz0gXAogCWd0L2RlYnVnZnNfZ3QubyBcCiAJ
Z3QvZGVidWdmc19ndF9wbS5vIFwKIAlndC9nZW42X3BwZ3R0Lm8gXAorCWd0L2dlbjhfZW5naW5l
X2NzLm8gXAogCWd0L2dlbjhfcHBndHQubyBcCiAJZ3QvaW50ZWxfYnJlYWRjcnVtYnMubyBcCiAJ
Z3QvaW50ZWxfY29udGV4dC5vIFwKQEAgLTg3LDYgKzg4LDcgQEAgZ3QteSArPSBcCiAJZ3QvaW50
ZWxfZW5naW5lX3BtLm8gXAogCWd0L2ludGVsX2VuZ2luZV9wb29sLm8gXAogCWd0L2ludGVsX2Vu
Z2luZV91c2VyLm8gXAorCWd0L2ludGVsX2VuZ2luZV93b3JrYXJvdW5kX2JiLm8gXAogCWd0L2lu
dGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uLm8gXAogCWd0L2ludGVsX2dndHQubyBcCiAJZ3QvaW50
ZWxfZ3QubyBcCkBAIC05Niw2ICs5OCw3IEBAIGd0LXkgKz0gXAogCWd0L2ludGVsX2d0X3JlcXVl
c3RzLm8gXAogCWd0L2ludGVsX2d0dC5vIFwKIAlndC9pbnRlbF9sbGMubyBcCisJZ3QvaW50ZWxf
bHJjLm8gXAogCWd0L2ludGVsX21vY3MubyBcCiAJZ3QvaW50ZWxfcHBndHQubyBcCiAJZ3QvaW50
ZWxfcmM2Lm8gXApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZ2VuOF9lbmdp
bmVfY3MuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2dlbjhfZW5naW5lX2NzLmMKbmV3IGZp
bGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi44NmE4YjMyODYyMWQKLS0tIC9kZXYv
bnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9nZW44X2VuZ2luZV9jcy5jCkBAIC0w
LDAgKzEsMzQwIEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCisvKgorICogQ29w
eXJpZ2h0IMKpIDIwMTQgSW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisjaW5jbHVkZSAiZ2VuOF9l
bmdpbmVfY3MuaCIKKyNpbmNsdWRlICJpOTE1X2Rydi5oIgorI2luY2x1ZGUgImludGVsX2dwdV9j
b21tYW5kcy5oIgorI2luY2x1ZGUgImludGVsX3JpbmcuaCIKKyNpbmNsdWRlICJpbnRlbF9scmMu
aCIKKworaW50IGdlbjhfZW1pdF9mbHVzaF94Y3Moc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVz
dCwgdTMyIG1vZGUpCit7CisJdTMyIGNtZCwgKmNzOworCisJY3MgPSBpbnRlbF9yaW5nX2JlZ2lu
KHJlcXVlc3QsIDQpOworCWlmIChJU19FUlIoY3MpKQorCQlyZXR1cm4gUFRSX0VSUihjcyk7CisK
KwljbWQgPSBNSV9GTFVTSF9EVyArIDE7CisKKwkvKiBXZSBhbHdheXMgcmVxdWlyZSBhIGNvbW1h
bmQgYmFycmllciBzbyB0aGF0IHN1YnNlcXVlbnQKKwkgKiBjb21tYW5kcywgc3VjaCBhcyBicmVh
ZGNydW1iIGludGVycnVwdHMsIGFyZSBzdHJpY3RseSBvcmRlcmVkCisJICogd3J0IHRoZSBjb250
ZW50cyBvZiB0aGUgd3JpdGUgY2FjaGUgYmVpbmcgZmx1c2hlZCB0byBtZW1vcnkKKwkgKiAoYW5k
IHRodXMgYmVpbmcgY29oZXJlbnQgZnJvbSB0aGUgQ1BVKS4KKwkgKi8KKwljbWQgfD0gTUlfRkxV
U0hfRFdfU1RPUkVfSU5ERVggfCBNSV9GTFVTSF9EV19PUF9TVE9SRURXOworCisJaWYgKG1vZGUg
JiBFTUlUX0lOVkFMSURBVEUpIHsKKwkJY21kIHw9IE1JX0lOVkFMSURBVEVfVExCOworCQlpZiAo
cmVxdWVzdC0+ZW5naW5lLT5jbGFzcyA9PSBWSURFT19ERUNPREVfQ0xBU1MpCisJCQljbWQgfD0g
TUlfSU5WQUxJREFURV9CU0Q7CisJfQorCisJKmNzKysgPSBjbWQ7CisJKmNzKysgPSBMUkNfUFBI
V1NQX1NDUkFUQ0hfQUREUjsKKwkqY3MrKyA9IDA7IC8qIHVwcGVyIGFkZHIgKi8KKwkqY3MrKyA9
IDA7IC8qIHZhbHVlICovCisJaW50ZWxfcmluZ19hZHZhbmNlKHJlcXVlc3QsIGNzKTsKKworCXJl
dHVybiAwOworfQorCitpbnQgZ2VuOF9lbWl0X2ZsdXNoX3JjcyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0
ICpyZXF1ZXN0LCB1MzIgbW9kZSkKK3sKKwl1MzIgKmNzLCBmbGFncyA9IDA7CisKKwlmbGFncyB8
PSBQSVBFX0NPTlRST0xfQ1NfU1RBTEw7CisKKwlpZiAobW9kZSAmIEVNSVRfRkxVU0gpIHsKKwkJ
ZmxhZ3MgfD0gUElQRV9DT05UUk9MX1JFTkRFUl9UQVJHRVRfQ0FDSEVfRkxVU0g7CisJCWZsYWdz
IHw9IFBJUEVfQ09OVFJPTF9ERVBUSF9DQUNIRV9GTFVTSDsKKwkJZmxhZ3MgfD0gUElQRV9DT05U
Uk9MX0RDX0ZMVVNIX0VOQUJMRTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0ZMVVNIX0VOQUJM
RTsKKwl9CisKKwlpZiAobW9kZSAmIEVNSVRfSU5WQUxJREFURSkgeworCQlmbGFncyB8PSBQSVBF
X0NPTlRST0xfVExCX0lOVkFMSURBVEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9JTlNUUlVD
VElPTl9DQUNIRV9JTlZBTElEQVRFOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfVEVYVFVSRV9D
QUNIRV9JTlZBTElEQVRFOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfVkZfQ0FDSEVfSU5WQUxJ
REFURTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0NPTlNUX0NBQ0hFX0lOVkFMSURBVEU7CisJ
CWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9TVEFURV9DQUNIRV9JTlZBTElEQVRFOworCQlmbGFncyB8
PSBQSVBFX0NPTlRST0xfUVdfV1JJVEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9TVE9SRV9E
QVRBX0lOREVYOworCX0KKworCWNzID0gaW50ZWxfcmluZ19iZWdpbihyZXF1ZXN0LCA2KTsKKwlp
ZiAoSVNfRVJSKGNzKSkKKwkJcmV0dXJuIFBUUl9FUlIoY3MpOworCisJY3MgPSBnZW44X2VtaXRf
cGlwZV9jb250cm9sKGNzLCBmbGFncywgTFJDX1BQSFdTUF9TQ1JBVENIX0FERFIpOworCisJaW50
ZWxfcmluZ19hZHZhbmNlKHJlcXVlc3QsIGNzKTsKKworCXJldHVybiAwOworfQorCitpbnQgZ2Vu
OV9lbWl0X2ZsdXNoX3JjcyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0LCB1MzIgbW9kZSkK
K3sKKwlib29sIHZmX2ZsdXNoX3dhID0gZmFsc2UsIGRjX2ZsdXNoX3dhID0gZmFsc2U7CisJdTMy
ICpjcywgZmxhZ3MgPSAwOworCWludCBsZW4gPSA2OworCisJZmxhZ3MgfD0gUElQRV9DT05UUk9M
X0NTX1NUQUxMOworCisJaWYgKG1vZGUgJiBFTUlUX0ZMVVNIKSB7CisJCWZsYWdzIHw9IFBJUEVf
Q09OVFJPTF9SRU5ERVJfVEFSR0VUX0NBQ0hFX0ZMVVNIOworCQlmbGFncyB8PSBQSVBFX0NPTlRS
T0xfREVQVEhfQ0FDSEVfRkxVU0g7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9EQ19GTFVTSF9F
TkFCTEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9GTFVTSF9FTkFCTEU7CisJfQorCisJaWYg
KG1vZGUgJiBFTUlUX0lOVkFMSURBVEUpIHsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1RMQl9J
TlZBTElEQVRFOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfSU5TVFJVQ1RJT05fQ0FDSEVfSU5W
QUxJREFURTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1RFWFRVUkVfQ0FDSEVfSU5WQUxJREFU
RTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1ZGX0NBQ0hFX0lOVkFMSURBVEU7CisJCWZsYWdz
IHw9IFBJUEVfQ09OVFJPTF9DT05TVF9DQUNIRV9JTlZBTElEQVRFOworCQlmbGFncyB8PSBQSVBF
X0NPTlRST0xfU1RBVEVfQ0FDSEVfSU5WQUxJREFURTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9M
X1FXX1dSSVRFOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfU1RPUkVfREFUQV9JTkRFWDsKKwor
CQkvKgorCQkgKiBPbiBHRU45OiBiZWZvcmUgVkZfQ0FDSEVfSU5WQUxJREFURSB3ZSBuZWVkIHRv
IGVtaXQgYSBOVUxMCisJCSAqIHBpcGUgY29udHJvbC4KKwkJICovCisJCXZmX2ZsdXNoX3dhID0g
dHJ1ZTsKKwkJbGVuICs9IDY7CisKKwkJLyogV2FGb3JHQU1IYW5nOmtibCAqLworCQlpZiAoSVNf
S0JMX1JFVklEKHJlcXVlc3QtPmk5MTUsIDAsIEtCTF9SRVZJRF9CMCkpIHsKKwkJCWRjX2ZsdXNo
X3dhID0gdHJ1ZTsKKwkJCWxlbiArPSAxMjsKKwkJfQorCX0KKworCWNzID0gaW50ZWxfcmluZ19i
ZWdpbihyZXF1ZXN0LCBsZW4pOworCWlmIChJU19FUlIoY3MpKQorCQlyZXR1cm4gUFRSX0VSUihj
cyk7CisKKwlpZiAodmZfZmx1c2hfd2EpCisJCWNzID0gZ2VuOF9lbWl0X3BpcGVfY29udHJvbChj
cywgMCwgMCk7CisKKwlpZiAoZGNfZmx1c2hfd2EpCisJCWNzID0gZ2VuOF9lbWl0X3BpcGVfY29u
dHJvbChjcywgUElQRV9DT05UUk9MX0RDX0ZMVVNIX0VOQUJMRSwKKwkJCQkJICAgIDApOworCisJ
Y3MgPSBnZW44X2VtaXRfcGlwZV9jb250cm9sKGNzLCBmbGFncywgTFJDX1BQSFdTUF9TQ1JBVENI
X0FERFIpOworCisJaWYgKGRjX2ZsdXNoX3dhKQorCQljcyA9IGdlbjhfZW1pdF9waXBlX2NvbnRy
b2woY3MsIFBJUEVfQ09OVFJPTF9DU19TVEFMTCwgMCk7CisKKwlpbnRlbF9yaW5nX2FkdmFuY2Uo
cmVxdWVzdCwgY3MpOworCisJcmV0dXJuIDA7Cit9CisKK2ludCBnZW4xMV9lbWl0X2ZsdXNoX3Jj
cyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0LCB1MzIgbW9kZSkKK3sKKwlpZiAobW9kZSAm
IEVNSVRfRkxVU0gpIHsKKwkJdTMyICpjczsKKwkJdTMyIGZsYWdzID0gMDsKKworCQlmbGFncyB8
PSBQSVBFX0NPTlRST0xfQ1NfU1RBTEw7CisKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1RJTEVf
Q0FDSEVfRkxVU0g7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9SRU5ERVJfVEFSR0VUX0NBQ0hF
X0ZMVVNIOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfREVQVEhfQ0FDSEVfRkxVU0g7CisJCWZs
YWdzIHw9IFBJUEVfQ09OVFJPTF9EQ19GTFVTSF9FTkFCTEU7CisJCWZsYWdzIHw9IFBJUEVfQ09O
VFJPTF9GTFVTSF9FTkFCTEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9RV19XUklURTsKKwkJ
ZmxhZ3MgfD0gUElQRV9DT05UUk9MX1NUT1JFX0RBVEFfSU5ERVg7CisKKwkJY3MgPSBpbnRlbF9y
aW5nX2JlZ2luKHJlcXVlc3QsIDYpOworCQlpZiAoSVNfRVJSKGNzKSkKKwkJCXJldHVybiBQVFJf
RVJSKGNzKTsKKworCQljcyA9IGdlbjhfZW1pdF9waXBlX2NvbnRyb2woY3MsIGZsYWdzLCBMUkNf
UFBIV1NQX1NDUkFUQ0hfQUREUik7CisJCWludGVsX3JpbmdfYWR2YW5jZShyZXF1ZXN0LCBjcyk7
CisJfQorCisJaWYgKG1vZGUgJiBFTUlUX0lOVkFMSURBVEUpIHsKKwkJdTMyICpjczsKKwkJdTMy
IGZsYWdzID0gMDsKKworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfQ1NfU1RBTEw7CisKKwkJZmxh
Z3MgfD0gUElQRV9DT05UUk9MX0NPTU1BTkRfQ0FDSEVfSU5WQUxJREFURTsKKwkJZmxhZ3MgfD0g
UElQRV9DT05UUk9MX1RMQl9JTlZBTElEQVRFOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfSU5T
VFJVQ1RJT05fQ0FDSEVfSU5WQUxJREFURTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1RFWFRV
UkVfQ0FDSEVfSU5WQUxJREFURTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1ZGX0NBQ0hFX0lO
VkFMSURBVEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9DT05TVF9DQUNIRV9JTlZBTElEQVRF
OworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfU1RBVEVfQ0FDSEVfSU5WQUxJREFURTsKKwkJZmxh
Z3MgfD0gUElQRV9DT05UUk9MX1FXX1dSSVRFOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfU1RP
UkVfREFUQV9JTkRFWDsKKworCQljcyA9IGludGVsX3JpbmdfYmVnaW4ocmVxdWVzdCwgNik7CisJ
CWlmIChJU19FUlIoY3MpKQorCQkJcmV0dXJuIFBUUl9FUlIoY3MpOworCisJCWNzID0gZ2VuOF9l
bWl0X3BpcGVfY29udHJvbChjcywgZmxhZ3MsIExSQ19QUEhXU1BfU0NSQVRDSF9BRERSKTsKKwkJ
aW50ZWxfcmluZ19hZHZhbmNlKHJlcXVlc3QsIGNzKTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKwor
c3RhdGljIHUzMiBwcmVwYXJzZXJfZGlzYWJsZShib29sIHN0YXRlKQoreworCXJldHVybiBNSV9B
UkJfQ0hFQ0sgfCAxIDw8IDggfCBzdGF0ZTsKK30KKworaW50IGdlbjEyX2VtaXRfZmx1c2hfcmNz
KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QsIHUzMiBtb2RlKQoreworCWlmIChtb2RlICYg
RU1JVF9GTFVTSCkgeworCQl1MzIgZmxhZ3MgPSAwOworCQl1MzIgKmNzOworCisJCWZsYWdzIHw9
IFBJUEVfQ09OVFJPTF9USUxFX0NBQ0hFX0ZMVVNIOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xf
UkVOREVSX1RBUkdFVF9DQUNIRV9GTFVTSDsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0RFUFRI
X0NBQ0hFX0ZMVVNIOworCQkvKiBXYV8xNDA5NjAwOTA3OnRnbCAqLworCQlmbGFncyB8PSBQSVBF
X0NPTlRST0xfREVQVEhfU1RBTEw7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9EQ19GTFVTSF9F
TkFCTEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9GTFVTSF9FTkFCTEU7CisJCWZsYWdzIHw9
IFBJUEVfQ09OVFJPTF9IRENfUElQRUxJTkVfRkxVU0g7CisKKwkJZmxhZ3MgfD0gUElQRV9DT05U
Uk9MX1NUT1JFX0RBVEFfSU5ERVg7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9RV19XUklURTsK
KworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfQ1NfU1RBTEw7CisKKwkJY3MgPSBpbnRlbF9yaW5n
X2JlZ2luKHJlcXVlc3QsIDYpOworCQlpZiAoSVNfRVJSKGNzKSkKKwkJCXJldHVybiBQVFJfRVJS
KGNzKTsKKworCQljcyA9IGdlbjhfZW1pdF9waXBlX2NvbnRyb2woY3MsIGZsYWdzLCBMUkNfUFBI
V1NQX1NDUkFUQ0hfQUREUik7CisJCWludGVsX3JpbmdfYWR2YW5jZShyZXF1ZXN0LCBjcyk7CisJ
fQorCisJaWYgKG1vZGUgJiBFTUlUX0lOVkFMSURBVEUpIHsKKwkJdTMyIGZsYWdzID0gMDsKKwkJ
dTMyICpjczsKKworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfQ09NTUFORF9DQUNIRV9JTlZBTElE
QVRFOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfVExCX0lOVkFMSURBVEU7CisJCWZsYWdzIHw9
IFBJUEVfQ09OVFJPTF9JTlNUUlVDVElPTl9DQUNIRV9JTlZBTElEQVRFOworCQlmbGFncyB8PSBQ
SVBFX0NPTlRST0xfVEVYVFVSRV9DQUNIRV9JTlZBTElEQVRFOworCQlmbGFncyB8PSBQSVBFX0NP
TlRST0xfVkZfQ0FDSEVfSU5WQUxJREFURTsKKwkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0NPTlNU
X0NBQ0hFX0lOVkFMSURBVEU7CisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9TVEFURV9DQUNIRV9J
TlZBTElEQVRFOworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfTDNfUk9fQ0FDSEVfSU5WQUxJREFU
RTsKKworCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfU1RPUkVfREFUQV9JTkRFWDsKKwkJZmxhZ3Mg
fD0gUElQRV9DT05UUk9MX1FXX1dSSVRFOworCisJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9DU19T
VEFMTDsKKworCQljcyA9IGludGVsX3JpbmdfYmVnaW4ocmVxdWVzdCwgOCk7CisJCWlmIChJU19F
UlIoY3MpKQorCQkJcmV0dXJuIFBUUl9FUlIoY3MpOworCisJCS8qCisJCSAqIFByZXZlbnQgdGhl
IHByZS1wYXJzZXIgZnJvbSBza2lwcGluZyBwYXN0IHRoZSBUTEIKKwkJICogaW52YWxpZGF0ZSBh
bmQgbG9hZGluZyBhIHN0YWxlIHBhZ2UgZm9yIHRoZSBiYXRjaAorCQkgKiBidWZmZXIgLyByZXF1
ZXN0IHBheWxvYWQuCisJCSAqLworCQkqY3MrKyA9IHByZXBhcnNlcl9kaXNhYmxlKHRydWUpOwor
CisJCWNzID0gZ2VuOF9lbWl0X3BpcGVfY29udHJvbChjcywgZmxhZ3MsIExSQ19QUEhXU1BfU0NS
QVRDSF9BRERSKTsKKworCQkqY3MrKyA9IHByZXBhcnNlcl9kaXNhYmxlKGZhbHNlKTsKKwkJaW50
ZWxfcmluZ19hZHZhbmNlKHJlcXVlc3QsIGNzKTsKKworCQkvKgorCQkgKiBXYV8xNjA0NTQ0ODg5
OnRnbAorCQkgKi8KKwkJaWYgKElTX1RHTF9SRVZJRChyZXF1ZXN0LT5pOTE1LCBUR0xfUkVWSURf
QTAsIFRHTF9SRVZJRF9BMCkpIHsKKwkJCWZsYWdzID0gMDsKKwkJCWZsYWdzIHw9IFBJUEVfQ09O
VFJPTF9DU19TVEFMTDsKKwkJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9IRENfUElQRUxJTkVfRkxV
U0g7CisKKwkJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9TVE9SRV9EQVRBX0lOREVYOworCQkJZmxh
Z3MgfD0gUElQRV9DT05UUk9MX1FXX1dSSVRFOworCisJCQljcyA9IGludGVsX3JpbmdfYmVnaW4o
cmVxdWVzdCwgNik7CisJCQlpZiAoSVNfRVJSKGNzKSkKKwkJCQlyZXR1cm4gUFRSX0VSUihjcyk7
CisKKwkJCWNzID0gZ2VuOF9lbWl0X3BpcGVfY29udHJvbChjcywgZmxhZ3MsCisJCQkJCQkgICAg
TFJDX1BQSFdTUF9TQ1JBVENIX0FERFIpOworCQkJaW50ZWxfcmluZ19hZHZhbmNlKHJlcXVlc3Qs
IGNzKTsKKwkJfQorCX0KKworCXJldHVybiAwOworfQorCitpbnQgZ2VuOF9lbWl0X2JiX3N0YXJ0
KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAorCQkgICAgICAgdTY0IG9mZnNldCwgdTMyIGxlbiwK
KwkJICAgICAgIGNvbnN0IHVuc2lnbmVkIGludCBmbGFncykKK3sKKwl1MzIgKmNzOworCisJY3Mg
PSBpbnRlbF9yaW5nX2JlZ2luKHJxLCA2KTsKKwlpZiAoSVNfRVJSKGNzKSkKKwkJcmV0dXJuIFBU
Ul9FUlIoY3MpOworCisJKmNzKysgPSBNSV9BUkJfT05fT0ZGIHwgTUlfQVJCX0VOQUJMRTsKKwor
CSpjcysrID0gTUlfQkFUQ0hfQlVGRkVSX1NUQVJUX0dFTjggfAorCQkoZmxhZ3MgJiBJOTE1X0RJ
U1BBVENIX1NFQ1VSRSA/IDAgOiBCSVQoOCkpOworCSpjcysrID0gbG93ZXJfMzJfYml0cyhvZmZz
ZXQpOworCSpjcysrID0gdXBwZXJfMzJfYml0cyhvZmZzZXQpOworCisJKmNzKysgPSBNSV9BUkJf
T05fT0ZGIHwgTUlfQVJCX0RJU0FCTEU7CisJKmNzKysgPSBNSV9OT09QOworCisJaW50ZWxfcmlu
Z19hZHZhbmNlKHJxLCBjcyk7CisKKwlyZXR1cm4gMDsKK30KKworaW50IGdlbjhfZW1pdF9iYl9z
dGFydF9ub2FyYihzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKKwkJCSAgICAgdTY0IG9mZnNldCwg
dTMyIGxlbiwKKwkJCSAgICAgY29uc3QgdW5zaWduZWQgaW50IGZsYWdzKQoreworCXUzMiAqY3M7
CisKKwljcyA9IGludGVsX3JpbmdfYmVnaW4ocnEsIDQpOworCWlmIChJU19FUlIoY3MpKQorCQly
ZXR1cm4gUFRSX0VSUihjcyk7CisKKwkvKgorCSAqIFdhRGlzYWJsZUN0eFJlc3RvcmVBcmJpdHJh
dGlvbjpiZHcsY2h2CisJICoKKwkgKiBXZSBkb24ndCBuZWVkIHRvIHBlcmZvcm0gTUlfQVJCX0VO
QUJMRSBhcyBvZnRlbiBhcyB3ZSBkbyAoaW4KKwkgKiBwYXJ0aWN1bGFyIGFsbCB0aGUgZ2VuIHRo
YXQgZG8gbm90IG5lZWQgdGhlIHcvYSBhdCBhbGwhKSwgaWYgd2UKKwkgKiB0b29rIGNhcmUgdG8g
bWFrZSBzdXJlIHRoYXQgb24gZXZlcnkgc3dpdGNoIGludG8gdGhpcyBjb250ZXh0CisJICogKGJv
dGggb3JkaW5hcnkgYW5kIGZvciBwcmVlbXB0aW9uKSB0aGF0IGFyYml0cmFydGlvbiB3YXMgZW5h
YmxlZAorCSAqIHdlIHdvdWxkIGJlIGZpbmUuICBIb3dldmVyLCBmb3IgZ2VuOCB0aGVyZSBpcyBh
bm90aGVyIHcvYSB0aGF0CisJICogcmVxdWlyZXMgdXMgdG8gbm90IHByZWVtcHQgaW5zaWRlIEdQ
R1BVIGV4ZWN1dGlvbiwgc28gd2Uga2VlcAorCSAqIGFyYml0cmF0aW9uIGRpc2FibGVkIGZvciBn
ZW44IGJhdGNoZXMuIEFyYml0cmF0aW9uIHdpbGwgYmUKKwkgKiByZS1lbmFibGVkIGJlZm9yZSB3
ZSBjbG9zZSB0aGUgcmVxdWVzdAorCSAqIChlbmdpbmUtPmVtaXRfZmluaV9icmVhZGNydW1iKS4K
KwkgKi8KKwkqY3MrKyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJfRElTQUJMRTsKKworCS8qIEZJ
WE1FKEJEVyspOiBBZGRyZXNzIHNwYWNlIGFuZCBzZWN1cml0eSBzZWxlY3RvcnMuICovCisJKmNz
KysgPSBNSV9CQVRDSF9CVUZGRVJfU1RBUlRfR0VOOCB8CisJCShmbGFncyAmIEk5MTVfRElTUEFU
Q0hfU0VDVVJFID8gMCA6IEJJVCg4KSk7CisJKmNzKysgPSBsb3dlcl8zMl9iaXRzKG9mZnNldCk7
CisJKmNzKysgPSB1cHBlcl8zMl9iaXRzKG9mZnNldCk7CisKKwlpbnRlbF9yaW5nX2FkdmFuY2Uo
cnEsIGNzKTsKKworCXJldHVybiAwOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvZ2VuOF9lbmdpbmVfY3MuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2dlbjhfZW5n
aW5lX2NzLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5lYmNhNDNh
NWUzM2MKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9nZW44X2Vu
Z2luZV9jcy5oCkBAIC0wLDAgKzEsMjcgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBN
SVQgKi8KKy8qCisgKiBDb3B5cmlnaHQgwqkgMjAxNCBJbnRlbCBDb3Jwb3JhdGlvbgorICovCisK
KyNpZm5kZWYgX19HRU44X0VOR0lORV9DU19IX18KKyNkZWZpbmUgX19HRU44X0VOR0lORV9DU19I
X18KKworI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CisKK3N0cnVjdCBpOTE1X3JlcXVlc3Q7CisK
K2ludCBnZW44X2VtaXRfZmx1c2hfeGNzKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QsIHUz
MiBtb2RlKTsKKworaW50IGdlbjhfZW1pdF9mbHVzaF9yY3Moc3RydWN0IGk5MTVfcmVxdWVzdCAq
cmVxdWVzdCwgdTMyIG1vZGUpOworaW50IGdlbjlfZW1pdF9mbHVzaF9yY3Moc3RydWN0IGk5MTVf
cmVxdWVzdCAqcmVxdWVzdCwgdTMyIG1vZGUpOworaW50IGdlbjExX2VtaXRfZmx1c2hfcmNzKHN0
cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QsIHUzMiBtb2RlKTsKK2ludCBnZW4xMl9lbWl0X2Zs
dXNoX3JjcyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0LCB1MzIgbW9kZSk7CisKK2ludCBn
ZW44X2VtaXRfYmJfc3RhcnQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCisJCSAgICAgICB1NjQg
b2Zmc2V0LCB1MzIgbGVuLAorCQkgICAgICAgY29uc3QgdW5zaWduZWQgaW50IGZsYWdzKTsKK2lu
dCBnZW44X2VtaXRfYmJfc3RhcnRfbm9hcmIoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCisJCQkg
ICAgIHU2NCBvZmZzZXQsIHUzMiBsZW4sCisJCQkgICAgIGNvbnN0IHVuc2lnbmVkIGludCBmbGFn
cyk7CisKKyNlbmRpZiAvKiBfX0dFTjhfRU5HSU5FX0NTX0hfXyAqLwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dF9zc2V1LmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0X3NzZXUuYwppbmRleCBlZTRlZjI1NTk5MTQuLjU3YTMw
OTU2YzkyMiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4
dF9zc2V1LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dF9zc2V1
LmMKQEAgLTgsNyArOCw3IEBACiAjaW5jbHVkZSAiaW50ZWxfY29udGV4dC5oIgogI2luY2x1ZGUg
ImludGVsX2VuZ2luZV9wbS5oIgogI2luY2x1ZGUgImludGVsX2dwdV9jb21tYW5kcy5oIgotI2lu
Y2x1ZGUgImludGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uLmgiCisjaW5jbHVkZSAiaW50ZWxfbHJj
LmgiCiAjaW5jbHVkZSAiaW50ZWxfbHJjX3JlZy5oIgogI2luY2x1ZGUgImludGVsX3JpbmcuaCIK
ICNpbmNsdWRlICJpbnRlbF9zc2V1LmgiCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9lbmdpbmVfd29ya2Fyb3VuZF9iYi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZW5naW5lX3dvcmthcm91bmRfYmIuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRl
eCAwMDAwMDAwMDAwMDAuLmI0MGRkNzQyNzRhNQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV93b3JrYXJvdW5kX2JiLmMKQEAgLTAsMCArMSwz
MzcgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBNSVQKKy8qCisgKiBDb3B5cmlnaHQg
wqkgMjAxNCBJbnRlbCBDb3Jwb3JhdGlvbgorICovCisKKyNpbmNsdWRlICJpOTE1X2Rydi5oIgor
I2luY2x1ZGUgImk5MTVfcmVnLmgiCisjaW5jbHVkZSAiaW50ZWxfZW5naW5lLmgiCisjaW5jbHVk
ZSAiaW50ZWxfZ3B1X2NvbW1hbmRzLmgiCisjaW5jbHVkZSAiaW50ZWxfZ3QuaCIKKyNpbmNsdWRl
ICJpbnRlbF9scmMuaCIKKworLyoKKyAqIEluIHRoaXMgV0Egd2UgbmVlZCB0byBzZXQgR0VOOF9M
M1NRQ1JFRzRbMjE6MjFdIGFuZCByZXNldCBpdCBhZnRlcgorICogUElQRV9DT05UUk9MIGluc3Ry
dWN0aW9uLiBUaGlzIGlzIHJlcXVpcmVkIGZvciB0aGUgZmx1c2ggdG8gaGFwcGVuIGNvcnJlY3Rs
eQorICogYnV0IHRoZXJlIGlzIGEgc2xpZ2h0IGNvbXBsaWNhdGlvbiBhcyB0aGlzIGlzIGFwcGxp
ZWQgaW4gV0EgYmF0Y2ggd2hlcmUgdGhlCisgKiB2YWx1ZXMgYXJlIG9ubHkgaW5pdGlhbGl6ZWQg
b25jZSBzbyB3ZSBjYW5ub3QgdGFrZSByZWdpc3RlciB2YWx1ZSBhdCB0aGUKKyAqIGJlZ2lubmlu
ZyBhbmQgcmV1c2UgaXQgZnVydGhlcjsgaGVuY2Ugd2Ugc2F2ZSBpdHMgdmFsdWUgdG8gbWVtb3J5
LCB1cGxvYWQgYQorICogY29uc3RhbnQgdmFsdWUgd2l0aCBiaXQyMSBzZXQgYW5kIHRoZW4gd2Ug
cmVzdG9yZSBpdCBiYWNrIHdpdGggdGhlIHNhdmVkCisgKiB2YWx1ZS4KKyAqCisgKiBUbyBzaW1w
bGlmeSB0aGUgV0EsIGEgY29uc3RhbnQgdmFsdWUgaXMgZm9ybWVkIGJ5IHVzaW5nIHRoZSBkZWZh
dWx0IHZhbHVlCisgKiBvZiB0aGlzIHJlZ2lzdGVyLiBUaGlzIHNob3VsZG4ndCBiZSBhIHByb2Js
ZW0gYmVjYXVzZSB3ZSBhcmUgb25seSBtb2RpZnlpbmcKKyAqIGl0IGZvciBhIHNob3J0IHBlcmlv
ZCBhbmQgdGhpcyBiYXRjaCBpbiBub24tcHJlbXB0aWJsZS4gV2UgY2FuIG9mY291cnNlCisgKiB1
c2UgYWRkaXRpb25hbCBpbnN0cnVjdGlvbnMgdGhhdCByZWFkIHRoZSBhY3R1YWwgdmFsdWUgb2Yg
dGhlIHJlZ2lzdGVyCisgKiBhdCB0aGF0IHRpbWUgYW5kIHNldCBvdXIgYml0IG9mIGludGVyZXN0
IGJ1dCBpdCBtYWtlcyB0aGUgV0EgY29tcGxpY2F0ZWQuCisgKgorICogVGhpcyBXQSBpcyBhbHNv
IHJlcXVpcmVkIGZvciBHZW45IHNvIGV4dHJhY3RpbmcgYXMgYSBmdW5jdGlvbiBhdm9pZHMKKyAq
IGNvZGUgZHVwbGljYXRpb24uCisgKi8KK3N0YXRpYyB1MzIgKgorZ2VuOF9lbWl0X2ZsdXNoX2Nv
aGVyZW50bDNfd2Eoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1MzIgKmJhdGNoKQor
eworCS8qIE5CIG5vIG9uZSBlbHNlIGlzIGFsbG93ZWQgdG8gc2NyaWJibGUgb3ZlciBzY3JhdGNo
ICsgMjU2ISAqLworCSpiYXRjaCsrID0gTUlfU1RPUkVfUkVHSVNURVJfTUVNX0dFTjggfCBNSV9T
Uk1fTFJNX0dMT0JBTF9HVFQ7CisJKmJhdGNoKysgPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44
X0wzU1FDUkVHNCk7CisJKmJhdGNoKysgPSBpbnRlbF9ndF9zY3JhdGNoX29mZnNldChlbmdpbmUt
Pmd0LAorCQkJCQkgICBJTlRFTF9HVF9TQ1JBVENIX0ZJRUxEX0NPSEVSRU5UTDNfV0EpOworCSpi
YXRjaCsrID0gMDsKKworCSpiYXRjaCsrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oMSk7CisJKmJh
dGNoKysgPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X0wzU1FDUkVHNCk7CisJKmJhdGNoKysg
PSAweDQwNDAwMDAwIHwgR0VOOF9MUVNDX0ZMVVNIX0NPSEVSRU5UX0xJTkVTOworCisJYmF0Y2gg
PSBnZW44X2VtaXRfcGlwZV9jb250cm9sKGJhdGNoLAorCQkJCSAgICAgICBQSVBFX0NPTlRST0xf
Q1NfU1RBTEwgfAorCQkJCSAgICAgICBQSVBFX0NPTlRST0xfRENfRkxVU0hfRU5BQkxFLAorCQkJ
CSAgICAgICAwKTsKKworCSpiYXRjaCsrID0gTUlfTE9BRF9SRUdJU1RFUl9NRU1fR0VOOCB8IE1J
X1NSTV9MUk1fR0xPQkFMX0dUVDsKKwkqYmF0Y2grKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEdF
TjhfTDNTUUNSRUc0KTsKKwkqYmF0Y2grKyA9IGludGVsX2d0X3NjcmF0Y2hfb2Zmc2V0KGVuZ2lu
ZS0+Z3QsCisJCQkJCSAgIElOVEVMX0dUX1NDUkFUQ0hfRklFTERfQ09IRVJFTlRMM19XQSk7CisJ
KmJhdGNoKysgPSAwOworCisJcmV0dXJuIGJhdGNoOworfQorCisvKgorICogVHlwaWNhbGx5IHdl
IG9ubHkgaGF2ZSBvbmUgaW5kaXJlY3RfY3R4IGFuZCBwZXJfY3R4IGJhdGNoIGJ1ZmZlciB3aGlj
aCBhcmUKKyAqIGluaXRpYWxpemVkIGF0IHRoZSBiZWdpbm5pbmcgYW5kIHNoYXJlZCBhY3Jvc3Mg
YWxsIGNvbnRleHRzIGJ1dCB0aGlzIGZpZWxkCisgKiBoZWxwcyB1cyB0byBoYXZlIG11bHRpcGxl
IGJhdGNoZXMgYXQgZGlmZmVyZW50IG9mZnNldHMgYW5kIHNlbGVjdCB0aGVtIGJhc2VkCisgKiBv
biBhIGNyaXRlcmlhLiBBdCB0aGUgbW9tZW50IHRoaXMgYmF0Y2ggYWx3YXlzIHN0YXJ0IGF0IHRo
ZSBiZWdpbm5pbmcgb2YgdGhlCisgKiBwYWdlIGFuZCBhdCB0aGlzIHBvaW50IHdlIGRvbid0IGhh
dmUgbXVsdGlwbGUgd2FfY3R4IGJhdGNoIGJ1ZmZlcnMuCisgKgorICogVGhlIG51bWJlciBvZiBX
QSBhcHBsaWVkIGFyZSBub3Qga25vd24gYXQgdGhlIGJlZ2lubmluZzsgd2UgdXNlIHRoaXMgZmll
bGQKKyAqIHRvIHJldHVybiB0aGUgbm8gb2YgRFdPUkRTIHdyaXR0ZW4uCisgKgorICogSXQgaXMg
dG8gYmUgbm90ZWQgdGhhdCB0aGlzIGJhdGNoIGRvZXMgbm90IGNvbnRhaW4gTUlfQkFUQ0hfQlVG
RkVSX0VORAorICogc28gaXQgYWRkcyBOT09QcyBhcyBwYWRkaW5nIHRvIG1ha2UgaXQgY2FjaGVs
aW5lIGFsaWduZWQuCisgKiBNSV9CQVRDSF9CVUZGRVJfRU5EIHdpbGwgYmUgYWRkZWQgdG8gcGVy
Y3R4IGJhdGNoIGFuZCBib3RoIG9mIHRoZW0gdG9nZXRoZXIKKyAqIG1ha2VzIGEgY29tcGxldGUg
YmF0Y2ggYnVmZmVyLgorICovCitzdGF0aWMgdTMyICpnZW44X2luaXRfaW5kaXJlY3RjdHhfYmIo
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1MzIgKmJhdGNoKQoreworCS8qIFdhRGlz
YWJsZUN0eFJlc3RvcmVBcmJpdHJhdGlvbjpiZHcsY2h2ICovCisJKmJhdGNoKysgPSBNSV9BUkJf
T05fT0ZGIHwgTUlfQVJCX0RJU0FCTEU7CisKKwkvKiBXYUZsdXNoQ29oZXJlbnRMM0NhY2hlTGlu
ZXNBdENvbnRleHRTd2l0Y2g6YmR3ICovCisJaWYgKElTX0JST0FEV0VMTChlbmdpbmUtPmk5MTUp
KQorCQliYXRjaCA9IGdlbjhfZW1pdF9mbHVzaF9jb2hlcmVudGwzX3dhKGVuZ2luZSwgYmF0Y2gp
OworCisJLyogV2FDbGVhclNsbVNwYWNlQXRDb250ZXh0U3dpdGNoOmJkdyxjaHYgKi8KKwkvKiBB
Y3R1YWwgc2NyYXRjaCBsb2NhdGlvbiBpcyBhdCAxMjggYnl0ZXMgb2Zmc2V0ICovCisJYmF0Y2gg
PSBnZW44X2VtaXRfcGlwZV9jb250cm9sKGJhdGNoLAorCQkJCSAgICAgICBQSVBFX0NPTlRST0xf
RkxVU0hfTDMgfAorCQkJCSAgICAgICBQSVBFX0NPTlRST0xfU1RPUkVfREFUQV9JTkRFWCB8CisJ
CQkJICAgICAgIFBJUEVfQ09OVFJPTF9DU19TVEFMTCB8CisJCQkJICAgICAgIFBJUEVfQ09OVFJP
TF9RV19XUklURSwKKwkJCQkgICAgICAgTFJDX1BQSFdTUF9TQ1JBVENIX0FERFIpOworCisJKmJh
dGNoKysgPSBNSV9BUkJfT05fT0ZGIHwgTUlfQVJCX0VOQUJMRTsKKworCS8qIFBhZCB0byBlbmQg
b2YgY2FjaGVsaW5lICovCisJd2hpbGUgKCh1bnNpZ25lZCBsb25nKWJhdGNoICUgQ0FDSEVMSU5F
X0JZVEVTKQorCQkqYmF0Y2grKyA9IE1JX05PT1A7CisKKwkvKgorCSAqIE1JX0JBVENIX0JVRkZF
Ul9FTkQgaXMgbm90IHJlcXVpcmVkIGluIEluZGlyZWN0IGN0eCBCQiBiZWNhdXNlCisJICogZXhl
Y3V0aW9uIGRlcGVuZHMgb24gdGhlIGxlbmd0aCBzcGVjaWZpZWQgaW4gdGVybXMgb2YgY2FjaGUg
bGluZXMKKwkgKiBpbiB0aGUgcmVnaXN0ZXIgQ1RYX1JDU19JTkRJUkVDVF9DVFgKKwkgKi8KKwor
CXJldHVybiBiYXRjaDsKK30KKworc3RydWN0IGxyaSB7CisJaTkxNV9yZWdfdCByZWc7CisJdTMy
IHZhbHVlOworfTsKKworc3RhdGljIHUzMiAqZW1pdF9scmkodTMyICpiYXRjaCwgY29uc3Qgc3Ry
dWN0IGxyaSAqbHJpLCB1bnNpZ25lZCBpbnQgY291bnQpCit7CisJR0VNX0JVR19PTighY291bnQg
fHwgY291bnQgPiA2Myk7CisKKwkqYmF0Y2grKyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKGNvdW50
KTsKKwlkbyB7CisJCSpiYXRjaCsrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQobHJpLT5yZWcpOwor
CQkqYmF0Y2grKyA9IGxyaS0+dmFsdWU7CisJfSB3aGlsZSAobHJpKyssIC0tY291bnQpOworCSpi
YXRjaCsrID0gTUlfTk9PUDsKKworCXJldHVybiBiYXRjaDsKK30KKworc3RhdGljIHUzMiAqZ2Vu
OV9pbml0X2luZGlyZWN0Y3R4X2JiKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgdTMy
ICpiYXRjaCkKK3sKKwlzdGF0aWMgY29uc3Qgc3RydWN0IGxyaSBscmlbXSA9IHsKKwkJLyogV2FE
aXNhYmxlR2F0aGVyQXRTZXRTaGFkZXJDb21tb25TbGljZTpza2wsYnh0LGtibCxnbGsgKi8KKwkJ
eworCQkJQ09NTU9OX1NMSUNFX0NISUNLRU4yLAorCQkJX19NQVNLRURfRklFTEQoR0VOOV9ESVNB
QkxFX0dBVEhFUl9BVF9TRVRfU0hBREVSX0NPTU1PTl9TTElDRSwKKwkJCQkgICAgICAgMCksCisJ
CX0sCisKKwkJLyogQlNwZWM6IDExMzkxICovCisJCXsKKwkJCUZGX1NMSUNFX0NISUNLRU4sCisJ
CQlfX01BU0tFRF9GSUVMRChGRl9TTElDRV9DSElDS0VOX0NMX1BST1ZPS0lOR19WRVJURVhfRklY
LAorCQkJCSAgICAgICBGRl9TTElDRV9DSElDS0VOX0NMX1BST1ZPS0lOR19WRVJURVhfRklYKSwK
KwkJfSwKKworCQkvKiBCU3BlYzogMTEyOTkgKi8KKwkJeworCQkJXzNEX0NISUNLRU4zLAorCQkJ
X19NQVNLRURfRklFTEQoXzNEX0NISUNLRU5fU0ZfUFJPVk9LSU5HX1ZFUlRFWF9GSVgsCisJCQkJ
ICAgICAgIF8zRF9DSElDS0VOX1NGX1BST1ZPS0lOR19WRVJURVhfRklYKSwKKwkJfQorCX07CisK
KwkqYmF0Y2grKyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJfRElTQUJMRTsKKworCS8qIFdhRmx1
c2hDb2hlcmVudEwzQ2FjaGVMaW5lc0F0Q29udGV4dFN3aXRjaDpza2wsYnh0LGdsayAqLworCWJh
dGNoID0gZ2VuOF9lbWl0X2ZsdXNoX2NvaGVyZW50bDNfd2EoZW5naW5lLCBiYXRjaCk7CisKKwkv
KiBXYUNsZWFyU2xtU3BhY2VBdENvbnRleHRTd2l0Y2g6c2tsLGJ4dCxrYmwsZ2xrLGNmbCAqLwor
CWJhdGNoID0gZ2VuOF9lbWl0X3BpcGVfY29udHJvbChiYXRjaCwKKwkJCQkgICAgICAgUElQRV9D
T05UUk9MX0ZMVVNIX0wzIHwKKwkJCQkgICAgICAgUElQRV9DT05UUk9MX1NUT1JFX0RBVEFfSU5E
RVggfAorCQkJCSAgICAgICBQSVBFX0NPTlRST0xfQ1NfU1RBTEwgfAorCQkJCSAgICAgICBQSVBF
X0NPTlRST0xfUVdfV1JJVEUsCisJCQkJICAgICAgIExSQ19QUEhXU1BfU0NSQVRDSF9BRERSKTsK
KworCWJhdGNoID0gZW1pdF9scmkoYmF0Y2gsIGxyaSwgQVJSQVlfU0laRShscmkpKTsKKworCS8q
IFdhTWVkaWFQb29sU3RhdGVDbWRJbldBQkI6Ynh0LGdsayAqLworCWlmIChIQVNfUE9PTEVEX0VV
KGVuZ2luZS0+aTkxNSkpIHsKKwkJLyoKKwkJICogRVUgcG9vbCBjb25maWd1cmF0aW9uIGlzIHNl
dHVwIGFsb25nIHdpdGggZ29sZGVuIGNvbnRleHQKKwkJICogZHVyaW5nIGNvbnRleHQgaW5pdGlh
bGl6YXRpb24uIFRoaXMgdmFsdWUgZGVwZW5kcyBvbgorCQkgKiBkZXZpY2UgdHlwZSAoMng2IG9y
IDN4NikgYW5kIG5lZWRzIHRvIGJlIHVwZGF0ZWQgYmFzZWQKKwkJICogb24gd2hpY2ggc3Vic2xp
Y2UgaXMgZGlzYWJsZWQgZXNwZWNpYWxseSBmb3IgMng2CisJCSAqIGRldmljZXMsIGhvd2V2ZXIg
aXQgaXMgc2FmZSB0byBsb2FkIGRlZmF1bHQKKwkJICogY29uZmlndXJhdGlvbiBvZiAzeDYgZGV2
aWNlIGluc3RlYWQgb2YgbWFza2luZyBvZmYKKwkJICogY29ycmVzcG9uZGluZyBiaXRzIGJlY2F1
c2UgSFcgaWdub3JlcyBiaXRzIG9mIGEgZGlzYWJsZWQKKwkJICogc3Vic2xpY2UgYW5kIGRyb3Bz
IGRvd24gdG8gYXBwcm9wcmlhdGUgY29uZmlnLiBQbGVhc2UKKwkJICogc2VlIHJlbmRlcl9zdGF0
ZV9zZXR1cCgpIGluIGk5MTVfZ2VtX3JlbmRlcl9zdGF0ZS5jIGZvcgorCQkgKiBwb3NzaWJsZSBj
b25maWd1cmF0aW9ucywgdG8gYXZvaWQgZHVwbGljYXRpb24gdGhleSBhcmUKKwkJICogbm90IHNo
b3duIGhlcmUgYWdhaW4uCisJCSAqLworCQkqYmF0Y2grKyA9IEdFTjlfTUVESUFfUE9PTF9TVEFU
RTsKKwkJKmJhdGNoKysgPSBHRU45X01FRElBX1BPT0xfRU5BQkxFOworCQkqYmF0Y2grKyA9IDB4
MDA3NzcwMDA7CisJCSpiYXRjaCsrID0gMDsKKwkJKmJhdGNoKysgPSAwOworCQkqYmF0Y2grKyA9
IDA7CisJfQorCisJKmJhdGNoKysgPSBNSV9BUkJfT05fT0ZGIHwgTUlfQVJCX0VOQUJMRTsKKwor
CS8qIFBhZCB0byBlbmQgb2YgY2FjaGVsaW5lICovCisJd2hpbGUgKCh1bnNpZ25lZCBsb25nKWJh
dGNoICUgQ0FDSEVMSU5FX0JZVEVTKQorCQkqYmF0Y2grKyA9IE1JX05PT1A7CisKKwlyZXR1cm4g
YmF0Y2g7Cit9CisKK3N0YXRpYyB1MzIgKgorZ2VuMTBfaW5pdF9pbmRpcmVjdGN0eF9iYihzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHUzMiAqYmF0Y2gpCit7CisJaW50IGk7CisKKwkv
KgorCSAqIFdhUGlwZUNvbnRyb2xCZWZvcmUzRFN0YXRlU2FtcGxlUGF0dGVybjogY25sCisJICoK
KwkgKiBFbnN1cmUgdGhlIGVuZ2luZSBpcyBpZGxlIHByaW9yIHRvIHByb2dyYW1taW5nIGEKKwkg
KiAzRFNUQVRFX1NBTVBMRV9QQVRURVJOIGR1cmluZyBhIGNvbnRleHQgcmVzdG9yZS4KKwkgKi8K
KwliYXRjaCA9IGdlbjhfZW1pdF9waXBlX2NvbnRyb2woYmF0Y2gsCisJCQkJICAgICAgIFBJUEVf
Q09OVFJPTF9DU19TVEFMTCwKKwkJCQkgICAgICAgMCk7CisJLyoKKwkgKiBXYVBpcGVDb250cm9s
QmVmb3JlM0RTdGF0ZVNhbXBsZVBhdHRlcm4gc2F5cyB3ZSBuZWVkIDQgZHdvcmRzIGZvcgorCSAq
IHRoZSBQSVBFX0NPTlRST0wgZm9sbG93ZWQgYnkgMTIgZHdvcmRzIG9mIDB4MCwgc28gMTYgZHdv
cmRzIGluCisJICogdG90YWwuIEhvd2V2ZXIsIGEgUElQRV9DT05UUk9MIGlzIDYgZHdvcmRzIGxv
bmcsIG5vdCA0LCB3aGljaCBpcworCSAqIGNvbmZ1c2luZy4gU2luY2UgZ2VuOF9lbWl0X3BpcGVf
Y29udHJvbCgpIGFscmVhZHkgYWR2YW5jZXMgdGhlCisJICogYmF0Y2ggYnkgNiBkd29yZHMsIHdl
IGFkdmFuY2UgdGhlIG90aGVyIDEwIGhlcmUsIGNvbXBsZXRpbmcgYQorCSAqIGNhY2hlbGluZS4g
SXQncyBub3QgY2xlYXIgaWYgdGhlIHdvcmthcm91bmQgcmVxdWlyZXMgdGhpcyBwYWRkaW5nCisJ
ICogYmVmb3JlIG90aGVyIGNvbW1hbmRzLCBvciBpZiBpdCdzIGp1c3QgdGhlIHJlZ3VsYXIgcGFk
ZGluZyB3ZSB3b3VsZAorCSAqIGFscmVhZHkgaGF2ZSBmb3IgdGhlIHdvcmthcm91bmQgYmIsIHNv
IGxlYXZlIGl0IGhlcmUgZm9yIG5vdy4KKwkgKi8KKwlmb3IgKGkgPSAwOyBpIDwgMTA7IGkrKykK
KwkJKmJhdGNoKysgPSBNSV9OT09QOworCisJLyogUGFkIHRvIGVuZCBvZiBjYWNoZWxpbmUgKi8K
Kwl3aGlsZSAoKHVuc2lnbmVkIGxvbmcpYmF0Y2ggJSBDQUNIRUxJTkVfQllURVMpCisJCSpiYXRj
aCsrID0gTUlfTk9PUDsKKworCXJldHVybiBiYXRjaDsKK30KKworI2RlZmluZSBDVFhfV0FfQkJf
T0JKX1NJWkUgKFBBR0VfU0laRSkKKworc3RhdGljIGludCBscmNfc2V0dXBfd2FfY3R4KHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVj
dCAqb2JqOworCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOworCWludCBlcnI7CisKKwlvYmogPSBpOTE1
X2dlbV9vYmplY3RfY3JlYXRlX3NobWVtKGVuZ2luZS0+aTkxNSwgQ1RYX1dBX0JCX09CSl9TSVpF
KTsKKwlpZiAoSVNfRVJSKG9iaikpCisJCXJldHVybiBQVFJfRVJSKG9iaik7CisKKwl2bWEgPSBp
OTE1X3ZtYV9pbnN0YW5jZShvYmosICZlbmdpbmUtPmd0LT5nZ3R0LT52bSwgTlVMTCk7CisJaWYg
KElTX0VSUih2bWEpKSB7CisJCWVyciA9IFBUUl9FUlIodm1hKTsKKwkJZ290byBlcnI7CisJfQor
CisJZXJyID0gaTkxNV9nZ3R0X3Bpbih2bWEsIDAsIFBJTl9ISUdIKTsKKwlpZiAoZXJyKQorCQln
b3RvIGVycjsKKworCWVuZ2luZS0+d2FfY3R4LnZtYSA9IHZtYTsKKwlyZXR1cm4gMDsKKworZXJy
OgorCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKKwlyZXR1cm4gZXJyOworfQorCit0eXBlZGVm
IHUzMiAqKCp3YV9iYl9mdW5jX3QpKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgdTMy
ICpiYXRjaCk7CisKK2ludCBpbnRlbF9lbmdpbmVfaW5pdF93b3JrYXJvdW5kX2JiKHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlzdHJ1Y3QgaTkxNV9jdHhfd29ya2Fyb3VuZHMg
KndhX2N0eCA9ICZlbmdpbmUtPndhX2N0eDsKKwlzdHJ1Y3QgaTkxNV93YV9jdHhfYmIgKndhX2Ji
WzJdID0geyAmd2FfY3R4LT5pbmRpcmVjdF9jdHgsCisJCQkJCSAgICAmd2FfY3R4LT5wZXJfY3R4
IH07CisJd2FfYmJfZnVuY190IHdhX2JiX2ZuWzJdOworCXN0cnVjdCBwYWdlICpwYWdlOworCXZv
aWQgKmJhdGNoLCAqYmF0Y2hfcHRyOworCXVuc2lnbmVkIGludCBpOworCWludCByZXQ7CisKKwlp
ZiAoZW5naW5lLT5jbGFzcyAhPSBSRU5ERVJfQ0xBU1MpCisJCXJldHVybiAwOworCisJc3dpdGNo
IChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSkgeworCWNhc2UgMTI6CisJY2FzZSAxMToKKwkJcmV0
dXJuIDA7CisJY2FzZSAxMDoKKwkJd2FfYmJfZm5bMF0gPSBnZW4xMF9pbml0X2luZGlyZWN0Y3R4
X2JiOworCQl3YV9iYl9mblsxXSA9IE5VTEw7CisJCWJyZWFrOworCWNhc2UgOToKKwkJd2FfYmJf
Zm5bMF0gPSBnZW45X2luaXRfaW5kaXJlY3RjdHhfYmI7CisJCXdhX2JiX2ZuWzFdID0gTlVMTDsK
KwkJYnJlYWs7CisJY2FzZSA4OgorCQl3YV9iYl9mblswXSA9IGdlbjhfaW5pdF9pbmRpcmVjdGN0
eF9iYjsKKwkJd2FfYmJfZm5bMV0gPSBOVUxMOworCQlicmVhazsKKwlkZWZhdWx0OgorCQlNSVNT
SU5HX0NBU0UoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkpOworCQlyZXR1cm4gMDsKKwl9CisKKwly
ZXQgPSBscmNfc2V0dXBfd2FfY3R4KGVuZ2luZSk7CisJaWYgKHJldCkgeworCQlEUk1fREVCVUdf
RFJJVkVSKCJGYWlsZWQgdG8gc2V0dXAgY29udGV4dCBXQSBwYWdlOiAlZFxuIiwgcmV0KTsKKwkJ
cmV0dXJuIHJldDsKKwl9CisKKwlwYWdlID0gaTkxNV9nZW1fb2JqZWN0X2dldF9kaXJ0eV9wYWdl
KHdhX2N0eC0+dm1hLT5vYmosIDApOworCWJhdGNoID0gYmF0Y2hfcHRyID0ga21hcF9hdG9taWMo
cGFnZSk7CisKKwkvKgorCSAqIEVtaXQgdGhlIHR3byB3b3JrYXJvdW5kIGJhdGNoIGJ1ZmZlcnMs
IHJlY29yZGluZyB0aGUgb2Zmc2V0IGZyb20gdGhlCisJICogc3RhcnQgb2YgdGhlIHdvcmthcm91
bmQgYmF0Y2ggYnVmZmVyIG9iamVjdCBmb3IgZWFjaCBhbmQgdGhlaXIKKwkgKiByZXNwZWN0aXZl
IHNpemVzLgorCSAqLworCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKHdhX2JiX2ZuKTsgaSsr
KSB7CisJCXdhX2JiW2ldLT5vZmZzZXQgPSBiYXRjaF9wdHIgLSBiYXRjaDsKKwkJaWYgKEdFTV9E
RUJVR19XQVJOX09OKCFJU19BTElHTkVEKHdhX2JiW2ldLT5vZmZzZXQsCisJCQkJCQkgIENBQ0hF
TElORV9CWVRFUykpKSB7CisJCQlyZXQgPSAtRUlOVkFMOworCQkJYnJlYWs7CisJCX0KKwkJaWYg
KHdhX2JiX2ZuW2ldKQorCQkJYmF0Y2hfcHRyID0gd2FfYmJfZm5baV0oZW5naW5lLCBiYXRjaF9w
dHIpOworCQl3YV9iYltpXS0+c2l6ZSA9IGJhdGNoX3B0ciAtIChiYXRjaCArIHdhX2JiW2ldLT5v
ZmZzZXQpOworCX0KKworCUdFTV9CVUdfT04oYmF0Y2hfcHRyIC0gYmF0Y2ggPiBDVFhfV0FfQkJf
T0JKX1NJWkUpOworCisJa3VubWFwX2F0b21pYyhiYXRjaCk7CisJaWYgKHJldCkKKwkJaW50ZWxf
ZW5naW5lX2Zpbmlfd29ya2Fyb3VuZF9iYihlbmdpbmUpOworCisJcmV0dXJuIHJldDsKK30KKwor
dm9pZCBpbnRlbF9lbmdpbmVfZmluaV93b3JrYXJvdW5kX2JiKHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSkKK3sKKwlpOTE1X3ZtYV91bnBpbl9hbmRfcmVsZWFzZSgmZW5naW5lLT53YV9j
dHgudm1hLCAwKTsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2V4ZWNsaXN0c19zdWJtaXNzaW9uLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9l
eGVjbGlzdHNfc3VibWlzc2lvbi5jCmluZGV4IDY5ODI3NmQzYzA3NC4uZmUxZjgwNDQ4Mjc0IDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9leGVjbGlzdHNfc3VibWlz
c2lvbi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2V4ZWNsaXN0c19zdWJt
aXNzaW9uLmMKQEAgLTMsMTIxICszLDE4IEBACiAgKiBDb3B5cmlnaHQgwqkgMjAxNCBJbnRlbCBD
b3Jwb3JhdGlvbgogICovCiAKLS8qKgotICogRE9DOiBMb2dpY2FsIFJpbmdzLCBMb2dpY2FsIFJp
bmcgQ29udGV4dHMgYW5kIEV4ZWNsaXN0cwotICoKLSAqIE1vdGl2YXRpb246Ci0gKiBHRU44IGJy
aW5ncyBhbiBleHBhbnNpb24gb2YgdGhlIEhXIGNvbnRleHRzOiAiTG9naWNhbCBSaW5nIENvbnRl
eHRzIi4KLSAqIFRoZXNlIGV4cGFuZGVkIGNvbnRleHRzIGVuYWJsZSBhIG51bWJlciBvZiBuZXcg
YWJpbGl0aWVzLCBlc3BlY2lhbGx5Ci0gKiAiRXhlY2xpc3RzIiAoYWxzbyBpbXBsZW1lbnRlZCBp
biB0aGlzIGZpbGUpLgotICoKLSAqIE9uZSBvZiB0aGUgbWFpbiBkaWZmZXJlbmNlcyB3aXRoIHRo
ZSBsZWdhY3kgSFcgY29udGV4dHMgaXMgdGhhdCBsb2dpY2FsCi0gKiByaW5nIGNvbnRleHRzIGlu
Y29ycG9yYXRlIG1hbnkgbW9yZSB0aGluZ3MgdG8gdGhlIGNvbnRleHQncyBzdGF0ZSwgbGlrZQot
ICogUERQcyBvciByaW5nYnVmZmVyIGNvbnRyb2wgcmVnaXN0ZXJzOgotICoKLSAqIFRoZSByZWFz
b24gd2h5IFBEUHMgYXJlIGluY2x1ZGVkIGluIHRoZSBjb250ZXh0IGlzIHN0cmFpZ2h0Zm9yd2Fy
ZDogYXMKLSAqIFBQR1RUcyAocGVyLXByb2Nlc3MgR1RUcykgYXJlIGFjdHVhbGx5IHBlci1jb250
ZXh0LCBoYXZpbmcgdGhlIFBEUHMKLSAqIGNvbnRhaW5lZCB0aGVyZSBtZWFuIHlvdSBkb24ndCBu
ZWVkIHRvIGRvIGEgcHBndHQtPnN3aXRjaF9tbSB5b3Vyc2VsZiwKLSAqIGluc3RlYWQsIHRoZSBH
UFUgd2lsbCBkbyBpdCBmb3IgeW91IG9uIHRoZSBjb250ZXh0IHN3aXRjaC4KLSAqCi0gKiBCdXQs
IHdoYXQgYWJvdXQgdGhlIHJpbmdidWZmZXIgY29udHJvbCByZWdpc3RlcnMgKGhlYWQsIHRhaWws
IGV0Yy4uKT8KLSAqIHNob3VsZG4ndCB3ZSBqdXN0IG5lZWQgYSBzZXQgb2YgdGhvc2UgcGVyIGVu
Z2luZSBjb21tYW5kIHN0cmVhbWVyPyBUaGlzIGlzCi0gKiB3aGVyZSB0aGUgbmFtZSAiTG9naWNh
bCBSaW5ncyIgc3RhcnRzIHRvIG1ha2Ugc2Vuc2U6IGJ5IHZpcnR1YWxpemluZyB0aGUKLSAqIHJp
bmdzLCB0aGUgZW5naW5lIGNzIHNoaWZ0cyB0byBhIG5ldyAicmluZyBidWZmZXIiIHdpdGggZXZl
cnkgY29udGV4dAotICogc3dpdGNoLiBXaGVuIHlvdSB3YW50IHRvIHN1Ym1pdCBhIHdvcmtsb2Fk
IHRvIHRoZSBHUFUgeW91OiBBKSBjaG9vc2UgeW91cgotICogY29udGV4dCwgQikgZmluZCBpdHMg
YXBwcm9wcmlhdGUgdmlydHVhbGl6ZWQgcmluZywgQykgd3JpdGUgY29tbWFuZHMgdG8gaXQKLSAq
IGFuZCB0aGVuLCBmaW5hbGx5LCBEKSB0ZWxsIHRoZSBHUFUgdG8gc3dpdGNoIHRvIHRoYXQgY29u
dGV4dC4KLSAqCi0gKiBJbnN0ZWFkIG9mIHRoZSBsZWdhY3kgTUlfU0VUX0NPTlRFWFQsIHRoZSB3
YXkgeW91IHRlbGwgdGhlIEdQVSB0byBzd2l0Y2gKLSAqIHRvIGEgY29udGV4dHMgaXMgdmlhIGEg
Y29udGV4dCBleGVjdXRpb24gbGlzdCwgZXJnbyAiRXhlY2xpc3RzIi4KLSAqCi0gKiBMUkMgaW1w
bGVtZW50YXRpb246Ci0gKiBSZWdhcmRpbmcgdGhlIGNyZWF0aW9uIG9mIGNvbnRleHRzLCB3ZSBo
YXZlOgotICoKLSAqIC0gT25lIGdsb2JhbCBkZWZhdWx0IGNvbnRleHQuCi0gKiAtIE9uZSBsb2Nh
bCBkZWZhdWx0IGNvbnRleHQgZm9yIGVhY2ggb3BlbmVkIGZkLgotICogLSBPbmUgbG9jYWwgZXh0
cmEgY29udGV4dCBmb3IgZWFjaCBjb250ZXh0IGNyZWF0ZSBpb2N0bCBjYWxsLgotICoKLSAqIE5v
dyB0aGF0IHJpbmdidWZmZXJzIGJlbG9uZyBwZXItY29udGV4dCAoYW5kIG5vdCBwZXItZW5naW5l
LCBsaWtlIGJlZm9yZSkKLSAqIGFuZCB0aGF0IGNvbnRleHRzIGFyZSB1bmlxdWVseSB0aWVkIHRv
IGEgZ2l2ZW4gZW5naW5lIChhbmQgbm90IHJldXNhYmxlLAotICogbGlrZSBiZWZvcmUpIHdlIG5l
ZWQ6Ci0gKgotICogLSBPbmUgcmluZ2J1ZmZlciBwZXItZW5naW5lIGluc2lkZSBlYWNoIGNvbnRl
eHQuCi0gKiAtIE9uZSBiYWNraW5nIG9iamVjdCBwZXItZW5naW5lIGluc2lkZSBlYWNoIGNvbnRl
eHQuCi0gKgotICogVGhlIGdsb2JhbCBkZWZhdWx0IGNvbnRleHQgc3RhcnRzIGl0cyBsaWZlIHdp
dGggdGhlc2UgbmV3IG9iamVjdHMgZnVsbHkKLSAqIGFsbG9jYXRlZCBhbmQgcG9wdWxhdGVkLiBU
aGUgbG9jYWwgZGVmYXVsdCBjb250ZXh0IGZvciBlYWNoIG9wZW5lZCBmZCBpcwotICogbW9yZSBj
b21wbGV4LCBiZWNhdXNlIHdlIGRvbid0IGtub3cgYXQgY3JlYXRpb24gdGltZSB3aGljaCBlbmdp
bmUgaXMgZ29pbmcKLSAqIHRvIHVzZSB0aGVtLiBUbyBoYW5kbGUgdGhpcywgd2UgaGF2ZSBpbXBs
ZW1lbnRlZCBhIGRlZmVycmVkIGNyZWF0aW9uIG9mIExSCi0gKiBjb250ZXh0czoKLSAqCi0gKiBU
aGUgbG9jYWwgY29udGV4dCBzdGFydHMgaXRzIGxpZmUgYXMgYSBob2xsb3cgb3IgYmxhbmsgaG9s
ZGVyLCB0aGF0IG9ubHkKLSAqIGdldHMgcG9wdWxhdGVkIGZvciBhIGdpdmVuIGVuZ2luZSBvbmNl
IHdlIHJlY2VpdmUgYW4gZXhlY2J1ZmZlci4gSWYgbGF0ZXIKLSAqIG9uIHdlIHJlY2VpdmUgYW5v
dGhlciBleGVjYnVmZmVyIGlvY3RsIGZvciB0aGUgc2FtZSBjb250ZXh0IGJ1dCBhIGRpZmZlcmVu
dAotICogZW5naW5lLCB3ZSBhbGxvY2F0ZS9wb3B1bGF0ZSBhIG5ldyByaW5nYnVmZmVyIGFuZCBj
b250ZXh0IGJhY2tpbmcgb2JqZWN0IGFuZAotICogc28gb24uCi0gKgotICogRmluYWxseSwgcmVn
YXJkaW5nIGxvY2FsIGNvbnRleHRzIGNyZWF0ZWQgdXNpbmcgdGhlIGlvY3RsIGNhbGw6IGFzIHRo
ZXkgYXJlCi0gKiBvbmx5IGFsbG93ZWQgd2l0aCB0aGUgcmVuZGVyIHJpbmcsIHdlIGNhbiBhbGxv
Y2F0ZSAmIHBvcHVsYXRlIHRoZW0gcmlnaHQKLSAqIGF3YXkgKG5vIG5lZWQgdG8gZGVmZXIgYW55
dGhpbmcsIGF0IGxlYXN0IGZvciBub3cpLgotICoKLSAqIEV4ZWNsaXN0cyBpbXBsZW1lbnRhdGlv
bjoKLSAqIEV4ZWNsaXN0cyBhcmUgdGhlIG5ldyBtZXRob2QgYnkgd2hpY2gsIG9uIGdlbjgrIGhh
cmR3YXJlLCB3b3JrbG9hZHMgYXJlCi0gKiBzdWJtaXR0ZWQgZm9yIGV4ZWN1dGlvbiAoYXMgb3Bw
b3NlZCB0byB0aGUgbGVnYWN5LCByaW5nYnVmZmVyLWJhc2VkLCBtZXRob2QpLgotICogVGhpcyBt
ZXRob2Qgd29ya3MgYXMgZm9sbG93czoKLSAqCi0gKiBXaGVuIGEgcmVxdWVzdCBpcyBjb21taXR0
ZWQsIGl0cyBjb21tYW5kcyAodGhlIEJCIHN0YXJ0IGFuZCBhbnkgbGVhZGluZyBvcgotICogdHJh
aWxpbmcgY29tbWFuZHMsIGxpa2UgdGhlIHNlcW5vIGJyZWFkY3J1bWJzKSBhcmUgcGxhY2VkIGlu
IHRoZSByaW5nYnVmZmVyCi0gKiBmb3IgdGhlIGFwcHJvcHJpYXRlIGNvbnRleHQuIFRoZSB0YWls
IHBvaW50ZXIgaW4gdGhlIGhhcmR3YXJlIGNvbnRleHQgaXMgbm90Ci0gKiB1cGRhdGVkIGF0IHRo
aXMgdGltZSwgYnV0IGluc3RlYWQsIGtlcHQgYnkgdGhlIGRyaXZlciBpbiB0aGUgcmluZ2J1ZmZl
cgotICogc3RydWN0dXJlLiBBIHN0cnVjdHVyZSByZXByZXNlbnRpbmcgdGhpcyByZXF1ZXN0IGlz
IGFkZGVkIHRvIGEgcmVxdWVzdCBxdWV1ZQotICogZm9yIHRoZSBhcHByb3ByaWF0ZSBlbmdpbmU6
IHRoaXMgc3RydWN0dXJlIGNvbnRhaW5zIGEgY29weSBvZiB0aGUgY29udGV4dCdzCi0gKiB0YWls
IGFmdGVyIHRoZSByZXF1ZXN0IHdhcyB3cml0dGVuIHRvIHRoZSByaW5nIGJ1ZmZlciBhbmQgYSBw
b2ludGVyIHRvIHRoZQotICogY29udGV4dCBpdHNlbGYuCi0gKgotICogSWYgdGhlIGVuZ2luZSdz
IHJlcXVlc3QgcXVldWUgd2FzIGVtcHR5IGJlZm9yZSB0aGUgcmVxdWVzdCB3YXMgYWRkZWQsIHRo
ZQotICogcXVldWUgaXMgcHJvY2Vzc2VkIGltbWVkaWF0ZWx5LiBPdGhlcndpc2UgdGhlIHF1ZXVl
IHdpbGwgYmUgcHJvY2Vzc2VkIGR1cmluZwotICogYSBjb250ZXh0IHN3aXRjaCBpbnRlcnJ1cHQu
IEluIGFueSBjYXNlLCBlbGVtZW50cyBvbiB0aGUgcXVldWUgd2lsbCBnZXQgc2VudAotICogKGlu
IHBhaXJzKSB0byB0aGUgR1BVJ3MgRXhlY0xpc3RzIFN1Ym1pdCBQb3J0IChFTFNQLCBmb3Igc2hv
cnQpIHdpdGggYQotICogZ2xvYmFsbHkgdW5pcXVlIDIwLWJpdHMgc3VibWlzc2lvbiBJRC4KLSAq
Ci0gKiBXaGVuIGV4ZWN1dGlvbiBvZiBhIHJlcXVlc3QgY29tcGxldGVzLCB0aGUgR1BVIHVwZGF0
ZXMgdGhlIGNvbnRleHQgc3RhdHVzCi0gKiBidWZmZXIgd2l0aCBhIGNvbnRleHQgY29tcGxldGUg
ZXZlbnQgYW5kIGdlbmVyYXRlcyBhIGNvbnRleHQgc3dpdGNoIGludGVycnVwdC4KLSAqIER1cmlu
ZyB0aGUgaW50ZXJydXB0IGhhbmRsaW5nLCB0aGUgZHJpdmVyIGV4YW1pbmVzIHRoZSBldmVudHMg
aW4gdGhlIGJ1ZmZlcjoKLSAqIGZvciBlYWNoIGNvbnRleHQgY29tcGxldGUgZXZlbnQsIGlmIHRo
ZSBhbm5vdW5jZWQgSUQgbWF0Y2hlcyB0aGF0IG9uIHRoZSBoZWFkCi0gKiBvZiB0aGUgcmVxdWVz
dCBxdWV1ZSwgdGhlbiB0aGF0IHJlcXVlc3QgaXMgcmV0aXJlZCBhbmQgcmVtb3ZlZCBmcm9tIHRo
ZSBxdWV1ZS4KLSAqCi0gKiBBZnRlciBwcm9jZXNzaW5nLCBpZiBhbnkgcmVxdWVzdHMgd2VyZSBy
ZXRpcmVkIGFuZCB0aGUgcXVldWUgaXMgbm90IGVtcHR5Ci0gKiB0aGVuIGEgbmV3IGV4ZWN1dGlv
biBsaXN0IGNhbiBiZSBzdWJtaXR0ZWQuIFRoZSB0d28gcmVxdWVzdHMgYXQgdGhlIGZyb250IG9m
Ci0gKiB0aGUgcXVldWUgYXJlIG5leHQgdG8gYmUgc3VibWl0dGVkIGJ1dCBzaW5jZSBhIGNvbnRl
eHQgbWF5IG5vdCBvY2N1ciB0d2ljZSBpbgotICogYW4gZXhlY3V0aW9uIGxpc3QsIGlmIHN1YnNl
cXVlbnQgcmVxdWVzdHMgaGF2ZSB0aGUgc2FtZSBJRCBhcyB0aGUgZmlyc3QgdGhlbgotICogdGhl
IHR3byByZXF1ZXN0cyBtdXN0IGJlIGNvbWJpbmVkLiBUaGlzIGlzIGRvbmUgc2ltcGx5IGJ5IGRp
c2NhcmRpbmcgcmVxdWVzdHMKLSAqIGF0IHRoZSBoZWFkIG9mIHRoZSBxdWV1ZSB1bnRpbCBlaXRo
ZXIgb25seSBvbmUgcmVxdWVzdHMgaXMgbGVmdCAoaW4gd2hpY2ggY2FzZQotICogd2UgdXNlIGEg
TlVMTCBzZWNvbmQgY29udGV4dCkgb3IgdGhlIGZpcnN0IHR3byByZXF1ZXN0cyBoYXZlIHVuaXF1
ZSBJRHMuCi0gKgotICogQnkgYWx3YXlzIGV4ZWN1dGluZyB0aGUgZmlyc3QgdHdvIHJlcXVlc3Rz
IGluIHRoZSBxdWV1ZSB0aGUgZHJpdmVyIGVuc3VyZXMKLSAqIHRoYXQgdGhlIEdQVSBpcyBrZXB0
IGFzIGJ1c3kgYXMgcG9zc2libGUuIEluIHRoZSBjYXNlIHdoZXJlIGEgc2luZ2xlIGNvbnRleHQK
LSAqIGNvbXBsZXRlcyBidXQgYSBzZWNvbmQgY29udGV4dCBpcyBzdGlsbCBleGVjdXRpbmcsIHRo
ZSByZXF1ZXN0IGZvciB0aGlzIHNlY29uZAotICogY29udGV4dCB3aWxsIGJlIGF0IHRoZSBoZWFk
IG9mIHRoZSBxdWV1ZSB3aGVuIHdlIHJlbW92ZSB0aGUgZmlyc3Qgb25lLiBUaGlzCi0gKiByZXF1
ZXN0IHdpbGwgdGhlbiBiZSByZXN1Ym1pdHRlZCBhbG9uZyB3aXRoIGEgbmV3IHJlcXVlc3QgZm9y
IGEgZGlmZmVyZW50IGNvbnRleHQsCi0gKiB3aGljaCB3aWxsIGNhdXNlIHRoZSBoYXJkd2FyZSB0
byBjb250aW51ZSBleGVjdXRpbmcgdGhlIHNlY29uZCByZXF1ZXN0IGFuZCBxdWV1ZQotICogdGhl
IG5ldyByZXF1ZXN0ICh0aGUgR1BVIGRldGVjdHMgdGhlIGNvbmRpdGlvbiBvZiBhIGNvbnRleHQg
Z2V0dGluZyBwcmVlbXB0ZWQKLSAqIHdpdGggdGhlIHNhbWUgY29udGV4dCBhbmQgb3B0aW1pemVz
IHRoZSBjb250ZXh0IHN3aXRjaCBmbG93IGJ5IG5vdCBkb2luZwotICogcHJlZW1wdGlvbiwgYnV0
IGp1c3Qgc2FtcGxpbmcgdGhlIG5ldyB0YWlsIHBvaW50ZXIpLgotICoKLSAqLwogI2luY2x1ZGUg
PGxpbnV4L2ludGVycnVwdC5oPgogCisjaW5jbHVkZSAiZ2VuOF9lbmdpbmVfY3MuaCIKICNpbmNs
dWRlICJpOTE1X2Rydi5oIgotI2luY2x1ZGUgImk5MTVfcGVyZi5oIgogI2luY2x1ZGUgImk5MTVf
dHJhY2UuaCIKLSNpbmNsdWRlICJpOTE1X3ZncHUuaCIKICNpbmNsdWRlICJpbnRlbF9jb250ZXh0
LmgiCiAjaW5jbHVkZSAiaW50ZWxfZW5naW5lX3BtLmgiCiAjaW5jbHVkZSAiaW50ZWxfZXhlY2xp
c3RzX3N1Ym1pc3Npb24uaCIKICNpbmNsdWRlICJpbnRlbF9ndC5oIgogI2luY2x1ZGUgImludGVs
X2d0X3BtLmgiCiAjaW5jbHVkZSAiaW50ZWxfZ3RfcmVxdWVzdHMuaCIKKyNpbmNsdWRlICJpbnRl
bF9scmMuaCIKICNpbmNsdWRlICJpbnRlbF9scmNfcmVnLmgiCiAjaW5jbHVkZSAiaW50ZWxfbW9j
cy5oIgogI2luY2x1ZGUgImludGVsX3Jlc2V0LmgiCkBAIC0yMDYsMTUgKzEwMyw2IEBAIHN0YXRp
YyBzdHJ1Y3QgdmlydHVhbF9lbmdpbmUgKnRvX3ZpcnR1YWxfZW5naW5lKHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSkKIHN0YXRpYyBpbnQgX19leGVjbGlzdHNfY29udGV4dF9hbGxvYyhz
dHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCiAJCQkJICAgICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmUpOwogCi1zdGF0aWMgdm9pZCBleGVjbGlzdHNfaW5pdF9yZWdfc3RhdGUodTMyICpy
ZWdfc3RhdGUsCi0JCQkJICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCi0JCQkJ
ICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCi0JCQkJICAgICBjb25z
dCBzdHJ1Y3QgaW50ZWxfcmluZyAqcmluZywKLQkJCQkgICAgIGJvb2wgY2xvc2UpOwotc3RhdGlj
IHZvaWQKLV9fZXhlY2xpc3RzX3VwZGF0ZV9yZWdfc3RhdGUoY29uc3Qgc3RydWN0IGludGVsX2Nv
bnRleHQgKmNlLAotCQkJICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUp
OwotCiBzdGF0aWMgdm9pZCBtYXJrX2VpbyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIHsKIAlp
ZiAoaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChycSkpCkBAIC00MDcsNTI3ICsyOTUsNiBAQCBhc3Nl
cnRfcHJpb3JpdHlfcXVldWUoY29uc3Qgc3RydWN0IGk5MTVfcmVxdWVzdCAqcHJldiwKIAlyZXR1
cm4gcnFfcHJpbyhwcmV2KSA+PSBycV9wcmlvKG5leHQpOwogfQogCi0vKgotICogVGhlIGNvbnRl
eHQgZGVzY3JpcHRvciBlbmNvZGVzIHZhcmlvdXMgYXR0cmlidXRlcyBvZiBhIGNvbnRleHQsCi0g
KiBpbmNsdWRpbmcgaXRzIEdUVCBhZGRyZXNzIGFuZCBzb21lIGZsYWdzLiBCZWNhdXNlIGl0J3Mg
ZmFpcmx5Ci0gKiBleHBlbnNpdmUgdG8gY2FsY3VsYXRlLCB3ZSdsbCBqdXN0IGRvIGl0IG9uY2Ug
YW5kIGNhY2hlIHRoZSByZXN1bHQsCi0gKiB3aGljaCByZW1haW5zIHZhbGlkIHVudGlsIHRoZSBj
b250ZXh0IGlzIHVucGlubmVkLgotICoKLSAqIFRoaXMgaXMgd2hhdCBhIGRlc2NyaXB0b3IgbG9v
a3MgbGlrZSwgZnJvbSBMU0IgdG8gTVNCOjoKLSAqCi0gKiAgICAgIGJpdHMgIDAtMTE6ICAgIGZs
YWdzLCBHRU44X0NUWF8qIChjYWNoZWQgaW4gY3R4LT5kZXNjX3RlbXBsYXRlKQotICogICAgICBi
aXRzIDEyLTMxOiAgICBMUkNBLCBHVFQgYWRkcmVzcyBvZiAodGhlIEhXU1Agb2YpIHRoaXMgY29u
dGV4dAotICogICAgICBiaXRzIDMyLTUyOiAgICBjdHggSUQsIGEgZ2xvYmFsbHkgdW5pcXVlIHRh
ZyAoaGlnaGVzdCBiaXQgdXNlZCBieSBHdUMpCi0gKiAgICAgIGJpdHMgNTMtNTQ6ICAgIG1ieiwg
cmVzZXJ2ZWQgZm9yIHVzZSBieSBoYXJkd2FyZQotICogICAgICBiaXRzIDU1LTYzOiAgICBncm91
cCBJRCwgY3VycmVudGx5IHVudXNlZCBhbmQgc2V0IHRvIDAKLSAqCi0gKiBTdGFydGluZyBmcm9t
IEdlbjExLCB0aGUgdXBwZXIgZHdvcmQgb2YgdGhlIGRlc2NyaXB0b3IgaGFzIGEgbmV3IGZvcm1h
dDoKLSAqCi0gKiAgICAgIGJpdHMgMzItMzY6ICAgIHJlc2VydmVkCi0gKiAgICAgIGJpdHMgMzct
NDc6ICAgIFNXIGNvbnRleHQgSUQKLSAqICAgICAgYml0cyA0ODo1MzogICAgZW5naW5lIGluc3Rh
bmNlCi0gKiAgICAgIGJpdCA1NDogICAgICAgIG1ieiwgcmVzZXJ2ZWQgZm9yIHVzZSBieSBoYXJk
d2FyZQotICogICAgICBiaXRzIDU1LTYwOiAgICBTVyBjb3VudGVyCi0gKiAgICAgIGJpdHMgNjEt
NjM6ICAgIGVuZ2luZSBjbGFzcwotICoKLSAqIGVuZ2luZSBpbmZvLCBTVyBjb250ZXh0IElEIGFu
ZCBTVyBjb3VudGVyIG5lZWQgdG8gZm9ybSBhIHVuaXF1ZSBudW1iZXIKLSAqIChDb250ZXh0IElE
KSBwZXIgbHJjLgotICovCi1zdGF0aWMgdTY0Ci1scmNfZGVzY3JpcHRvcihzdHJ1Y3QgaW50ZWxf
Y29udGV4dCAqY2UsIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKLXsKLQl1NjQgZGVz
YzsKLQotCWRlc2MgPSBJTlRFTF9MRUdBQ1lfMzJCX0NPTlRFWFQ7Ci0JaWYgKGk5MTVfdm1faXNf
NGx2bChjZS0+dm0pKQotCQlkZXNjID0gSU5URUxfTEVHQUNZXzY0Ql9DT05URVhUOwotCWRlc2Mg
PDw9IEdFTjhfQ1RYX0FERFJFU1NJTkdfTU9ERV9TSElGVDsKLQotCWRlc2MgfD0gR0VOOF9DVFhf
VkFMSUQgfCBHRU44X0NUWF9QUklWSUxFR0U7Ci0JaWYgKElTX0dFTihlbmdpbmUtPmk5MTUsIDgp
KQotCQlkZXNjIHw9IEdFTjhfQ1RYX0wzTExDX0NPSEVSRU5UOwotCi0JZGVzYyB8PSBpOTE1X2dn
dHRfb2Zmc2V0KGNlLT5zdGF0ZSk7IC8qIGJpdHMgMTItMzEgKi8KLQkvKgotCSAqIFRoZSBmb2xs
b3dpbmcgMzJiaXRzIGFyZSBjb3BpZWQgaW50byB0aGUgT0EgcmVwb3J0cyAoZHdvcmQgMikuCi0J
ICogQ29uc2lkZXIgdXBkYXRpbmcgb2FfZ2V0X3JlbmRlcl9jdHhfaWQgaW4gaTkxNV9wZXJmLmMg
d2hlbiBjaGFuZ2luZwotCSAqIGFueXRoaW5nIGJlbG93LgotCSAqLwotCWlmIChJTlRFTF9HRU4o
ZW5naW5lLT5pOTE1KSA+PSAxMSkgewotCQlkZXNjIHw9ICh1NjQpZW5naW5lLT5pbnN0YW5jZSA8
PCBHRU4xMV9FTkdJTkVfSU5TVEFOQ0VfU0hJRlQ7Ci0JCQkJCQkJCS8qIGJpdHMgNDgtNTMgKi8K
LQotCQlkZXNjIHw9ICh1NjQpZW5naW5lLT5jbGFzcyA8PCBHRU4xMV9FTkdJTkVfQ0xBU1NfU0hJ
RlQ7Ci0JCQkJCQkJCS8qIGJpdHMgNjEtNjMgKi8KLQl9Ci0KLQlyZXR1cm4gZGVzYzsKLX0KLQot
c3RhdGljIGlubGluZSB1bnNpZ25lZCBpbnQgZHdvcmRfaW5fcGFnZSh2b2lkICphZGRyKQotewot
CXJldHVybiBvZmZzZXRfaW5fcGFnZShhZGRyKSAvIHNpemVvZih1MzIpOwotfQotCi1zdGF0aWMg
dm9pZCBzZXRfb2Zmc2V0cyh1MzIgKnJlZ3MsCi0JCQljb25zdCB1OCAqZGF0YSwKLQkJCWNvbnN0
IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCWJvb2wgY2xlYXIpCi0jZGVmaW5l
IE5PUCh4KSAoQklUKDcpIHwgKHgpKQotI2RlZmluZSBMUkkoY291bnQsIGZsYWdzKSAoKGZsYWdz
KSA8PCA2IHwgKGNvdW50KSB8IEJVSUxEX0JVR19PTl9aRVJPKGNvdW50ID49IEJJVCg2KSkpCi0j
ZGVmaW5lIFBPU1RFRCBCSVQoMCkKLSNkZWZpbmUgUkVHKHgpICgoKHgpID4+IDIpIHwgQlVJTERf
QlVHX09OX1pFUk8oeCA+PSAweDIwMCkpCi0jZGVmaW5lIFJFRzE2KHgpIFwKLQkoKCh4KSA+PiA5
KSB8IEJJVCg3KSB8IEJVSUxEX0JVR19PTl9aRVJPKHggPj0gMHgxMDAwMCkpLCBcCi0JKCgoeCkg
Pj4gMikgJiAweDdmKQotI2RlZmluZSBFTkQoeCkgMCwgKHgpCi17Ci0JY29uc3QgdTMyIGJhc2Ug
PSBlbmdpbmUtPm1taW9fYmFzZTsKLQotCXdoaWxlICgqZGF0YSkgewotCQl1OCBjb3VudCwgZmxh
Z3M7Ci0KLQkJaWYgKCpkYXRhICYgQklUKDcpKSB7IC8qIHNraXAgKi8KLQkJCWNvdW50ID0gKmRh
dGErKyAmIH5CSVQoNyk7Ci0JCQlpZiAoY2xlYXIpCi0JCQkJbWVtc2V0MzIocmVncywgTUlfTk9P
UCwgY291bnQpOwotCQkJcmVncyArPSBjb3VudDsKLQkJCWNvbnRpbnVlOwotCQl9Ci0KLQkJY291
bnQgPSAqZGF0YSAmIDB4M2Y7Ci0JCWZsYWdzID0gKmRhdGEgPj4gNjsKLQkJZGF0YSsrOwotCi0J
CSpyZWdzID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oY291bnQpOwotCQlpZiAoZmxhZ3MgJiBQT1NU
RUQpCi0JCQkqcmVncyB8PSBNSV9MUklfRk9SQ0VfUE9TVEVEOwotCQlpZiAoSU5URUxfR0VOKGVu
Z2luZS0+aTkxNSkgPj0gMTEpCi0JCQkqcmVncyB8PSBNSV9MUklfQ1NfTU1JTzsKLQkJcmVncysr
OwotCi0JCUdFTV9CVUdfT04oIWNvdW50KTsKLQkJZG8gewotCQkJdTMyIG9mZnNldCA9IDA7Ci0J
CQl1OCB2OwotCi0JCQlkbyB7Ci0JCQkJdiA9ICpkYXRhKys7Ci0JCQkJb2Zmc2V0IDw8PSA3Owot
CQkJCW9mZnNldCB8PSB2ICYgfkJJVCg3KTsKLQkJCX0gd2hpbGUgKHYgJiBCSVQoNykpOwotCi0J
CQlyZWdzWzBdID0gYmFzZSArIChvZmZzZXQgPDwgMik7Ci0JCQlpZiAoY2xlYXIpCi0JCQkJcmVn
c1sxXSA9IDA7Ci0JCQlyZWdzICs9IDI7Ci0JCX0gd2hpbGUgKC0tY291bnQpOwotCX0KLQotCWlm
IChjbGVhcikgewotCQl1OCBjb3VudCA9ICorK2RhdGE7Ci0KLQkJLyogQ2xlYXIgcGFzdCB0aGUg
dGFpbCBmb3IgSFcgYWNjZXNzICovCi0JCUdFTV9CVUdfT04oZHdvcmRfaW5fcGFnZShyZWdzKSA+
IGNvdW50KTsKLQkJbWVtc2V0MzIocmVncywgTUlfTk9PUCwgY291bnQgLSBkd29yZF9pbl9wYWdl
KHJlZ3MpKTsKLQotCQkvKiBDbG9zZSB0aGUgYmF0Y2g7IHVzZWQgbWFpbmx5IGJ5IGxpdmVfbHJj
X2xheW91dCgpICovCi0JCSpyZWdzID0gTUlfQkFUQ0hfQlVGRkVSX0VORDsKLQkJaWYgKElOVEVM
X0dFTihlbmdpbmUtPmk5MTUpID49IDEwKQotCQkJKnJlZ3MgfD0gQklUKDApOwotCX0KLX0KLQot
c3RhdGljIGNvbnN0IHU4IGdlbjhfeGNzX29mZnNldHNbXSA9IHsKLQlOT1AoMSksCi0JTFJJKDEx
LCAwKSwKLQlSRUcxNigweDI0NCksCi0JUkVHKDB4MDM0KSwKLQlSRUcoMHgwMzApLAotCVJFRygw
eDAzOCksCi0JUkVHKDB4MDNjKSwKLQlSRUcoMHgxNjgpLAotCVJFRygweDE0MCksCi0JUkVHKDB4
MTEwKSwKLQlSRUcoMHgxMWMpLAotCVJFRygweDExNCksCi0JUkVHKDB4MTE4KSwKLQotCU5PUCg5
KSwKLQlMUkkoOSwgMCksCi0JUkVHMTYoMHgzYTgpLAotCVJFRzE2KDB4MjhjKSwKLQlSRUcxNigw
eDI4OCksCi0JUkVHMTYoMHgyODQpLAotCVJFRzE2KDB4MjgwKSwKLQlSRUcxNigweDI3YyksCi0J
UkVHMTYoMHgyNzgpLAotCVJFRzE2KDB4Mjc0KSwKLQlSRUcxNigweDI3MCksCi0KLQlOT1AoMTMp
LAotCUxSSSgyLCAwKSwKLQlSRUcxNigweDIwMCksCi0JUkVHKDB4MDI4KSwKLQotCUVORCg4MCkK
LX07Ci0KLXN0YXRpYyBjb25zdCB1OCBnZW45X3hjc19vZmZzZXRzW10gPSB7Ci0JTk9QKDEpLAot
CUxSSSgxNCwgUE9TVEVEKSwKLQlSRUcxNigweDI0NCksCi0JUkVHKDB4MDM0KSwKLQlSRUcoMHgw
MzApLAotCVJFRygweDAzOCksCi0JUkVHKDB4MDNjKSwKLQlSRUcoMHgxNjgpLAotCVJFRygweDE0
MCksCi0JUkVHKDB4MTEwKSwKLQlSRUcoMHgxMWMpLAotCVJFRygweDExNCksCi0JUkVHKDB4MTE4
KSwKLQlSRUcoMHgxYzApLAotCVJFRygweDFjNCksCi0JUkVHKDB4MWM4KSwKLQotCU5PUCgzKSwK
LQlMUkkoOSwgUE9TVEVEKSwKLQlSRUcxNigweDNhOCksCi0JUkVHMTYoMHgyOGMpLAotCVJFRzE2
KDB4Mjg4KSwKLQlSRUcxNigweDI4NCksCi0JUkVHMTYoMHgyODApLAotCVJFRzE2KDB4MjdjKSwK
LQlSRUcxNigweDI3OCksCi0JUkVHMTYoMHgyNzQpLAotCVJFRzE2KDB4MjcwKSwKLQotCU5PUCgx
MyksCi0JTFJJKDEsIFBPU1RFRCksCi0JUkVHMTYoMHgyMDApLAotCi0JTk9QKDEzKSwKLQlMUkko
NDQsIFBPU1RFRCksCi0JUkVHKDB4MDI4KSwKLQlSRUcoMHgwOWMpLAotCVJFRygweDBjMCksCi0J
UkVHKDB4MTc4KSwKLQlSRUcoMHgxN2MpLAotCVJFRzE2KDB4MzU4KSwKLQlSRUcoMHgxNzApLAot
CVJFRygweDE1MCksCi0JUkVHKDB4MTU0KSwKLQlSRUcoMHgxNTgpLAotCVJFRzE2KDB4NDFjKSwK
LQlSRUcxNigweDYwMCksCi0JUkVHMTYoMHg2MDQpLAotCVJFRzE2KDB4NjA4KSwKLQlSRUcxNigw
eDYwYyksCi0JUkVHMTYoMHg2MTApLAotCVJFRzE2KDB4NjE0KSwKLQlSRUcxNigweDYxOCksCi0J
UkVHMTYoMHg2MWMpLAotCVJFRzE2KDB4NjIwKSwKLQlSRUcxNigweDYyNCksCi0JUkVHMTYoMHg2
MjgpLAotCVJFRzE2KDB4NjJjKSwKLQlSRUcxNigweDYzMCksCi0JUkVHMTYoMHg2MzQpLAotCVJF
RzE2KDB4NjM4KSwKLQlSRUcxNigweDYzYyksCi0JUkVHMTYoMHg2NDApLAotCVJFRzE2KDB4NjQ0
KSwKLQlSRUcxNigweDY0OCksCi0JUkVHMTYoMHg2NGMpLAotCVJFRzE2KDB4NjUwKSwKLQlSRUcx
NigweDY1NCksCi0JUkVHMTYoMHg2NTgpLAotCVJFRzE2KDB4NjVjKSwKLQlSRUcxNigweDY2MCks
Ci0JUkVHMTYoMHg2NjQpLAotCVJFRzE2KDB4NjY4KSwKLQlSRUcxNigweDY2YyksCi0JUkVHMTYo
MHg2NzApLAotCVJFRzE2KDB4Njc0KSwKLQlSRUcxNigweDY3OCksCi0JUkVHMTYoMHg2N2MpLAot
CVJFRygweDA2OCksCi0KLQlFTkQoMTc2KQotfTsKLQotc3RhdGljIGNvbnN0IHU4IGdlbjEyX3hj
c19vZmZzZXRzW10gPSB7Ci0JTk9QKDEpLAotCUxSSSgxMywgUE9TVEVEKSwKLQlSRUcxNigweDI0
NCksCi0JUkVHKDB4MDM0KSwKLQlSRUcoMHgwMzApLAotCVJFRygweDAzOCksCi0JUkVHKDB4MDNj
KSwKLQlSRUcoMHgxNjgpLAotCVJFRygweDE0MCksCi0JUkVHKDB4MTEwKSwKLQlSRUcoMHgxYzAp
LAotCVJFRygweDFjNCksCi0JUkVHKDB4MWM4KSwKLQlSRUcoMHgxODApLAotCVJFRzE2KDB4MmI0
KSwKLQotCU5PUCg1KSwKLQlMUkkoOSwgUE9TVEVEKSwKLQlSRUcxNigweDNhOCksCi0JUkVHMTYo
MHgyOGMpLAotCVJFRzE2KDB4Mjg4KSwKLQlSRUcxNigweDI4NCksCi0JUkVHMTYoMHgyODApLAot
CVJFRzE2KDB4MjdjKSwKLQlSRUcxNigweDI3OCksCi0JUkVHMTYoMHgyNzQpLAotCVJFRzE2KDB4
MjcwKSwKLQotCUVORCg4MCkKLX07Ci0KLXN0YXRpYyBjb25zdCB1OCBnZW44X3Jjc19vZmZzZXRz
W10gPSB7Ci0JTk9QKDEpLAotCUxSSSgxNCwgUE9TVEVEKSwKLQlSRUcxNigweDI0NCksCi0JUkVH
KDB4MDM0KSwKLQlSRUcoMHgwMzApLAotCVJFRygweDAzOCksCi0JUkVHKDB4MDNjKSwKLQlSRUco
MHgxNjgpLAotCVJFRygweDE0MCksCi0JUkVHKDB4MTEwKSwKLQlSRUcoMHgxMWMpLAotCVJFRygw
eDExNCksCi0JUkVHKDB4MTE4KSwKLQlSRUcoMHgxYzApLAotCVJFRygweDFjNCksCi0JUkVHKDB4
MWM4KSwKLQotCU5PUCgzKSwKLQlMUkkoOSwgUE9TVEVEKSwKLQlSRUcxNigweDNhOCksCi0JUkVH
MTYoMHgyOGMpLAotCVJFRzE2KDB4Mjg4KSwKLQlSRUcxNigweDI4NCksCi0JUkVHMTYoMHgyODAp
LAotCVJFRzE2KDB4MjdjKSwKLQlSRUcxNigweDI3OCksCi0JUkVHMTYoMHgyNzQpLAotCVJFRzE2
KDB4MjcwKSwKLQotCU5PUCgxMyksCi0JTFJJKDEsIDApLAotCVJFRygweDBjOCksCi0KLQlFTkQo
ODApCi19OwotCi1zdGF0aWMgY29uc3QgdTggZ2VuOV9yY3Nfb2Zmc2V0c1tdID0gewotCU5PUCgx
KSwKLQlMUkkoMTQsIFBPU1RFRCksCi0JUkVHMTYoMHgyNDQpLAotCVJFRygweDM0KSwKLQlSRUco
MHgzMCksCi0JUkVHKDB4MzgpLAotCVJFRygweDNjKSwKLQlSRUcoMHgxNjgpLAotCVJFRygweDE0
MCksCi0JUkVHKDB4MTEwKSwKLQlSRUcoMHgxMWMpLAotCVJFRygweDExNCksCi0JUkVHKDB4MTE4
KSwKLQlSRUcoMHgxYzApLAotCVJFRygweDFjNCksCi0JUkVHKDB4MWM4KSwKLQotCU5PUCgzKSwK
LQlMUkkoOSwgUE9TVEVEKSwKLQlSRUcxNigweDNhOCksCi0JUkVHMTYoMHgyOGMpLAotCVJFRzE2
KDB4Mjg4KSwKLQlSRUcxNigweDI4NCksCi0JUkVHMTYoMHgyODApLAotCVJFRzE2KDB4MjdjKSwK
LQlSRUcxNigweDI3OCksCi0JUkVHMTYoMHgyNzQpLAotCVJFRzE2KDB4MjcwKSwKLQotCU5PUCgx
MyksCi0JTFJJKDEsIDApLAotCVJFRygweGM4KSwKLQotCU5PUCgxMyksCi0JTFJJKDQ0LCBQT1NU
RUQpLAotCVJFRygweDI4KSwKLQlSRUcoMHg5YyksCi0JUkVHKDB4YzApLAotCVJFRygweDE3OCks
Ci0JUkVHKDB4MTdjKSwKLQlSRUcxNigweDM1OCksCi0JUkVHKDB4MTcwKSwKLQlSRUcoMHgxNTAp
LAotCVJFRygweDE1NCksCi0JUkVHKDB4MTU4KSwKLQlSRUcxNigweDQxYyksCi0JUkVHMTYoMHg2
MDApLAotCVJFRzE2KDB4NjA0KSwKLQlSRUcxNigweDYwOCksCi0JUkVHMTYoMHg2MGMpLAotCVJF
RzE2KDB4NjEwKSwKLQlSRUcxNigweDYxNCksCi0JUkVHMTYoMHg2MTgpLAotCVJFRzE2KDB4NjFj
KSwKLQlSRUcxNigweDYyMCksCi0JUkVHMTYoMHg2MjQpLAotCVJFRzE2KDB4NjI4KSwKLQlSRUcx
NigweDYyYyksCi0JUkVHMTYoMHg2MzApLAotCVJFRzE2KDB4NjM0KSwKLQlSRUcxNigweDYzOCks
Ci0JUkVHMTYoMHg2M2MpLAotCVJFRzE2KDB4NjQwKSwKLQlSRUcxNigweDY0NCksCi0JUkVHMTYo
MHg2NDgpLAotCVJFRzE2KDB4NjRjKSwKLQlSRUcxNigweDY1MCksCi0JUkVHMTYoMHg2NTQpLAot
CVJFRzE2KDB4NjU4KSwKLQlSRUcxNigweDY1YyksCi0JUkVHMTYoMHg2NjApLAotCVJFRzE2KDB4
NjY0KSwKLQlSRUcxNigweDY2OCksCi0JUkVHMTYoMHg2NmMpLAotCVJFRzE2KDB4NjcwKSwKLQlS
RUcxNigweDY3NCksCi0JUkVHMTYoMHg2NzgpLAotCVJFRzE2KDB4NjdjKSwKLQlSRUcoMHg2OCks
Ci0KLQlFTkQoMTc2KQotfTsKLQotc3RhdGljIGNvbnN0IHU4IGdlbjExX3Jjc19vZmZzZXRzW10g
PSB7Ci0JTk9QKDEpLAotCUxSSSgxNSwgUE9TVEVEKSwKLQlSRUcxNigweDI0NCksCi0JUkVHKDB4
MDM0KSwKLQlSRUcoMHgwMzApLAotCVJFRygweDAzOCksCi0JUkVHKDB4MDNjKSwKLQlSRUcoMHgx
NjgpLAotCVJFRygweDE0MCksCi0JUkVHKDB4MTEwKSwKLQlSRUcoMHgxMWMpLAotCVJFRygweDEx
NCksCi0JUkVHKDB4MTE4KSwKLQlSRUcoMHgxYzApLAotCVJFRygweDFjNCksCi0JUkVHKDB4MWM4
KSwKLQlSRUcoMHgxODApLAotCi0JTk9QKDEpLAotCUxSSSg5LCBQT1NURUQpLAotCVJFRzE2KDB4
M2E4KSwKLQlSRUcxNigweDI4YyksCi0JUkVHMTYoMHgyODgpLAotCVJFRzE2KDB4Mjg0KSwKLQlS
RUcxNigweDI4MCksCi0JUkVHMTYoMHgyN2MpLAotCVJFRzE2KDB4Mjc4KSwKLQlSRUcxNigweDI3
NCksCi0JUkVHMTYoMHgyNzApLAotCi0JTFJJKDEsIFBPU1RFRCksCi0JUkVHKDB4MWIwKSwKLQot
CU5PUCgxMCksCi0JTFJJKDEsIDApLAotCVJFRygweDBjOCksCi0KLQlFTkQoODApCi19OwotCi1z
dGF0aWMgY29uc3QgdTggZ2VuMTJfcmNzX29mZnNldHNbXSA9IHsKLQlOT1AoMSksCi0JTFJJKDEz
LCBQT1NURUQpLAotCVJFRzE2KDB4MjQ0KSwKLQlSRUcoMHgwMzQpLAotCVJFRygweDAzMCksCi0J
UkVHKDB4MDM4KSwKLQlSRUcoMHgwM2MpLAotCVJFRygweDE2OCksCi0JUkVHKDB4MTQwKSwKLQlS
RUcoMHgxMTApLAotCVJFRygweDFjMCksCi0JUkVHKDB4MWM0KSwKLQlSRUcoMHgxYzgpLAotCVJF
RygweDE4MCksCi0JUkVHMTYoMHgyYjQpLAotCi0JTk9QKDUpLAotCUxSSSg5LCBQT1NURUQpLAot
CVJFRzE2KDB4M2E4KSwKLQlSRUcxNigweDI4YyksCi0JUkVHMTYoMHgyODgpLAotCVJFRzE2KDB4
Mjg0KSwKLQlSRUcxNigweDI4MCksCi0JUkVHMTYoMHgyN2MpLAotCVJFRzE2KDB4Mjc4KSwKLQlS
RUcxNigweDI3NCksCi0JUkVHMTYoMHgyNzApLAotCi0JTFJJKDMsIFBPU1RFRCksCi0JUkVHKDB4
MWIwKSwKLQlSRUcxNigweDVhOCksCi0JUkVHMTYoMHg1YWMpLAotCi0JTk9QKDYpLAotCUxSSSgx
LCAwKSwKLQlSRUcoMHgwYzgpLAotCi0JRU5EKDgwKQotfTsKLQotI3VuZGVmIEVORAotI3VuZGVm
IFJFRzE2Ci0jdW5kZWYgUkVHCi0jdW5kZWYgTFJJCi0jdW5kZWYgTk9QCi0KLXN0YXRpYyBjb25z
dCB1OCAqcmVnX29mZnNldHMoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQot
ewotCS8qCi0JICogVGhlIGdlbjEyKyBsaXN0cyBvbmx5IGhhdmUgdGhlIHJlZ2lzdGVycyB3ZSBw
cm9ncmFtIGluIHRoZSBiYXNpYwotCSAqIGRlZmF1bHQgc3RhdGUuIFdlIHJlbHkgb24gdGhlIGNv
bnRleHQgaW1hZ2UgdXNpbmcgcmVsYXRpdmUKLQkgKiBhZGRyZXNzaW5nIHRvIGF1dG9tYXRpYyBm
aXh1cCB0aGUgcmVnaXN0ZXIgc3RhdGUgYmV0d2VlbiB0aGUKLQkgKiBwaHlzaWNhbCBlbmdpbmVz
IGZvciB2aXJ0dWFsIGVuZ2luZS4KLQkgKi8KLQlHRU1fQlVHX09OKElOVEVMX0dFTihlbmdpbmUt
Pmk5MTUpID49IDEyICYmCi0JCSAgICFpbnRlbF9lbmdpbmVfaGFzX3JlbGF0aXZlX21taW8oZW5n
aW5lKSk7Ci0KLQlpZiAoZW5naW5lLT5jbGFzcyA9PSBSRU5ERVJfQ0xBU1MpIHsKLQkJaWYgKElO
VEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDEyKQotCQkJcmV0dXJuIGdlbjEyX3Jjc19vZmZzZXRz
OwotCQllbHNlIGlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMSkKLQkJCXJldHVybiBn
ZW4xMV9yY3Nfb2Zmc2V0czsKLQkJZWxzZSBpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0g
OSkKLQkJCXJldHVybiBnZW45X3Jjc19vZmZzZXRzOwotCQllbHNlCi0JCQlyZXR1cm4gZ2VuOF9y
Y3Nfb2Zmc2V0czsKLQl9IGVsc2UgewotCQlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0g
MTIpCi0JCQlyZXR1cm4gZ2VuMTJfeGNzX29mZnNldHM7Ci0JCWVsc2UgaWYgKElOVEVMX0dFTihl
bmdpbmUtPmk5MTUpID49IDkpCi0JCQlyZXR1cm4gZ2VuOV94Y3Nfb2Zmc2V0czsKLQkJZWxzZQot
CQkJcmV0dXJuIGdlbjhfeGNzX29mZnNldHM7Ci0JfQotfQotCiBzdGF0aWMgc3RydWN0IGk5MTVf
cmVxdWVzdCAqCiBfX3Vud2luZF9pbmNvbXBsZXRlX3JlcXVlc3RzKHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSkKIHsKQEAgLTEwNjgsMTggKzQzNSw2IEBAIHN0YXRpYyB2b2lkIGludGVs
X2VuZ2luZV9jb250ZXh0X291dChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJd3Jp
dGVfc2VxdW5sb2NrX2lycXJlc3RvcmUoJmVuZ2luZS0+c3RhdHMubG9jaywgZmxhZ3MpOwogfQog
Ci1zdGF0aWMgaW50IGxyY19yaW5nX21pX21vZGUoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lKQotewotCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMikKLQkJcmV0
dXJuIDB4NjA7Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gOSkKLQkJcmV0
dXJuIDB4NTQ7Ci0JZWxzZSBpZiAoZW5naW5lLT5jbGFzcyA9PSBSRU5ERVJfQ0xBU1MpCi0JCXJl
dHVybiAweDU4OwotCWVsc2UKLQkJcmV0dXJuIC0xOwotfQotCiBzdGF0aWMgdm9pZAogZXhlY2xp
c3RzX2NoZWNrX2NvbnRleHQoY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAogCQkJY29u
c3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQpAQCAtMTEwOCw3ICs0NjMsNyBAQCBl
eGVjbGlzdHNfY2hlY2tfY29udGV4dChjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCiAJ
CXZhbGlkID0gZmFsc2U7CiAJfQogCi0JeCA9IGxyY19yaW5nX21pX21vZGUoZW5naW5lKTsKKwl4
ID0gaW50ZWxfbHJjX3JpbmdfbWlfbW9kZShlbmdpbmUpOwogCWlmICh4ICE9IC0xICYmIHJlZ3Nb
eCArIDFdICYgKHJlZ3NbeCArIDFdID4+IDE2KSAmIFNUT1BfUklORykgewogCQlwcl9lcnIoIiVz
OiBjb250ZXh0IHN1Ym1pdHRlZCB3aXRoIFNUT1BfUklORyBbJTA4eF0gaW4gUklOR19NSV9NT0RF
XG4iLAogCQkgICAgICAgZW5naW5lLT5uYW1lLCByZWdzW3ggKyAxXSk7CkBAIC0xMTMwLDcgKzQ4
NSw3IEBAIHN0YXRpYyB2b2lkIHJlc3RvcmVfZGVmYXVsdF9zdGF0ZShzdHJ1Y3QgaW50ZWxfY29u
dGV4dCAqY2UsCiAJCSAgICAgICBlbmdpbmUtPnBpbm5lZF9kZWZhdWx0X3N0YXRlICsgTFJDX1NU
QVRFX1BOICogUEFHRV9TSVpFLAogCQkgICAgICAgZW5naW5lLT5jb250ZXh0X3NpemUgLSBQQUdF
X1NJWkUpOwogCi0JZXhlY2xpc3RzX2luaXRfcmVnX3N0YXRlKHJlZ3MsIGNlLCBlbmdpbmUsIGNl
LT5yaW5nLCBmYWxzZSk7CisJaW50ZWxfbHJjX2luaXRfcmVnX3N0YXRlKHJlZ3MsIGNlLCBlbmdp
bmUsIGNlLT5yaW5nLCBmYWxzZSk7CiB9CiAKIHN0YXRpYyB2b2lkIHJlc2V0X2FjdGl2ZShzdHJ1
Y3QgaTkxNV9yZXF1ZXN0ICpycSwKQEAgLTExNjcsNyArNTIyLDcgQEAgc3RhdGljIHZvaWQgcmVz
ZXRfYWN0aXZlKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAogCiAJLyogU2NydWIgdGhlIGNvbnRl
eHQgaW1hZ2UgdG8gcHJldmVudCByZXBsYXlpbmcgdGhlIHByZXZpb3VzIGJhdGNoICovCiAJcmVz
dG9yZV9kZWZhdWx0X3N0YXRlKGNlLCBlbmdpbmUpOwotCV9fZXhlY2xpc3RzX3VwZGF0ZV9yZWdf
c3RhdGUoY2UsIGVuZ2luZSk7CisJaW50ZWxfbHJjX3VwZGF0ZV9yZWdfc3RhdGUoY2UsIGVuZ2lu
ZSk7CiAKIAkvKiBXZSd2ZSBzd2l0Y2hlZCBhd2F5LCBzbyB0aGlzIHNob3VsZCBiZSBhIG5vLW9w
LCBidXQgaW50ZW50IG1hdHRlcnMgKi8KIAljZS0+bHJjX2Rlc2MgfD0gQ1RYX0RFU0NfRk9SQ0Vf
UkVTVE9SRTsKQEAgLTE1MzYsNyArODkxLDcgQEAgc3RhdGljIGJvb2wgY2FuX21lcmdlX3JxKGNv
bnN0IHN0cnVjdCBpOTE1X3JlcXVlc3QgKnByZXYsCiBzdGF0aWMgdm9pZCB2aXJ0dWFsX3VwZGF0
ZV9yZWdpc3Rlcl9vZmZzZXRzKHUzMiAqcmVncywKIAkJCQkJICAgIHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSkKIHsKLQlzZXRfb2Zmc2V0cyhyZWdzLCByZWdfb2Zmc2V0cyhlbmdpbmUp
LCBlbmdpbmUsIGZhbHNlKTsKKwlpbnRlbF9scmNfc2V0X3JlZ19vZmZzZXRzKHJlZ3MsIGVuZ2lu
ZSk7CiB9CiAKIHN0YXRpYyBib29sIHZpcnR1YWxfbWF0Y2hlcyhjb25zdCBzdHJ1Y3QgdmlydHVh
bF9lbmdpbmUgKnZlLApAQCAtMjg3MCwyOSArMjIyNSw2IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0
c19jb250ZXh0X3VucGluKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKIAlpOTE1X2dlbV9vYmpl
Y3RfdW5waW5fbWFwKGNlLT5zdGF0ZS0+b2JqKTsKIH0KIAotc3RhdGljIHZvaWQKLV9fZXhlY2xp
c3RzX3VwZGF0ZV9yZWdfc3RhdGUoY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAotCQkJ
ICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCi17Ci0Jc3RydWN0IGlu
dGVsX3JpbmcgKnJpbmcgPSBjZS0+cmluZzsKLQl1MzIgKnJlZ3MgPSBjZS0+bHJjX3JlZ19zdGF0
ZTsKLQotCUdFTV9CVUdfT04oIWludGVsX3Jpbmdfb2Zmc2V0X3ZhbGlkKHJpbmcsIHJpbmctPmhl
YWQpKTsKLQlHRU1fQlVHX09OKCFpbnRlbF9yaW5nX29mZnNldF92YWxpZChyaW5nLCByaW5nLT50
YWlsKSk7Ci0KLQlyZWdzW0NUWF9SSU5HX1NUQVJUXSA9IGk5MTVfZ2d0dF9vZmZzZXQocmluZy0+
dm1hKTsKLQlyZWdzW0NUWF9SSU5HX0hFQURdID0gcmluZy0+aGVhZDsKLQlyZWdzW0NUWF9SSU5H
X1RBSUxdID0gcmluZy0+dGFpbDsKLQotCS8qIFJQQ1MgKi8KLQlpZiAoZW5naW5lLT5jbGFzcyA9
PSBSRU5ERVJfQ0xBU1MpIHsKLQkJcmVnc1tDVFhfUl9QV1JfQ0xLX1NUQVRFXSA9Ci0JCQlpbnRl
bF9zc2V1X21ha2VfcnBjcyhlbmdpbmUtPmk5MTUsICZjZS0+c3NldSk7Ci0KLQkJaTkxNV9vYV9p
bml0X3JlZ19zdGF0ZShjZSwgZW5naW5lKTsKLQl9Ci19Ci0KIHN0YXRpYyBpbnQKIF9fZXhlY2xp
c3RzX2NvbnRleHRfcGluKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKIAkJCXN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSkKQEAgLTI5MDgsOSArMjI0MCwxMSBAQCBfX2V4ZWNsaXN0c19j
b250ZXh0X3BpbihzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCiAJaWYgKElTX0VSUih2YWRkcikp
CiAJCXJldHVybiBQVFJfRVJSKHZhZGRyKTsKIAotCWNlLT5scmNfZGVzYyA9IGxyY19kZXNjcmlw
dG9yKGNlLCBlbmdpbmUpIHwgQ1RYX0RFU0NfRk9SQ0VfUkVTVE9SRTsKKwljZS0+bHJjX2Rlc2Mg
PQorCQlpbnRlbF9scmNfZGVzY3JpcHRvcihjZSwgZW5naW5lKSB8IENUWF9ERVNDX0ZPUkNFX1JF
U1RPUkU7CisKIAljZS0+bHJjX3JlZ19zdGF0ZSA9IHZhZGRyICsgTFJDX1NUQVRFX1BOICogUEFH
RV9TSVpFOwotCV9fZXhlY2xpc3RzX3VwZGF0ZV9yZWdfc3RhdGUoY2UsIGVuZ2luZSk7CisJaW50
ZWxfbHJjX3VwZGF0ZV9yZWdfc3RhdGUoY2UsIGVuZ2luZSk7CiAKIAlyZXR1cm4gMDsKIH0KQEAg
LTI5NDksOSArMjI4Myw5IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19jb250ZXh0X3Jlc2V0KHN0
cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKIAlpbnRlbF9yaW5nX3Jlc2V0KGNlLT5yaW5nLCBjZS0+
cmluZy0+ZW1pdCk7CiAKIAkvKiBTY3J1YiBhd2F5IHRoZSBnYXJiYWdlICovCi0JZXhlY2xpc3Rz
X2luaXRfcmVnX3N0YXRlKGNlLT5scmNfcmVnX3N0YXRlLAorCWludGVsX2xyY19pbml0X3JlZ19z
dGF0ZShjZS0+bHJjX3JlZ19zdGF0ZSwKIAkJCQkgY2UsIGNlLT5lbmdpbmUsIGNlLT5yaW5nLCB0
cnVlKTsKLQlfX2V4ZWNsaXN0c191cGRhdGVfcmVnX3N0YXRlKGNlLCBjZS0+ZW5naW5lKTsKKwlp
bnRlbF9scmNfdXBkYXRlX3JlZ19zdGF0ZShjZSwgY2UtPmVuZ2luZSk7CiAKIAljZS0+bHJjX2Rl
c2MgfD0gQ1RYX0RFU0NfRk9SQ0VfUkVTVE9SRTsKIH0KQEAgLTMwMzEsMzMwICsyMzY1LDYgQEAg
c3RhdGljIGludCBleGVjbGlzdHNfcmVxdWVzdF9hbGxvYyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpy
ZXF1ZXN0KQogCXJldHVybiAwOwogfQogCi0vKgotICogSW4gdGhpcyBXQSB3ZSBuZWVkIHRvIHNl
dCBHRU44X0wzU1FDUkVHNFsyMToyMV0gYW5kIHJlc2V0IGl0IGFmdGVyCi0gKiBQSVBFX0NPTlRS
T0wgaW5zdHJ1Y3Rpb24uIFRoaXMgaXMgcmVxdWlyZWQgZm9yIHRoZSBmbHVzaCB0byBoYXBwZW4g
Y29ycmVjdGx5Ci0gKiBidXQgdGhlcmUgaXMgYSBzbGlnaHQgY29tcGxpY2F0aW9uIGFzIHRoaXMg
aXMgYXBwbGllZCBpbiBXQSBiYXRjaCB3aGVyZSB0aGUKLSAqIHZhbHVlcyBhcmUgb25seSBpbml0
aWFsaXplZCBvbmNlIHNvIHdlIGNhbm5vdCB0YWtlIHJlZ2lzdGVyIHZhbHVlIGF0IHRoZQotICog
YmVnaW5uaW5nIGFuZCByZXVzZSBpdCBmdXJ0aGVyOyBoZW5jZSB3ZSBzYXZlIGl0cyB2YWx1ZSB0
byBtZW1vcnksIHVwbG9hZCBhCi0gKiBjb25zdGFudCB2YWx1ZSB3aXRoIGJpdDIxIHNldCBhbmQg
dGhlbiB3ZSByZXN0b3JlIGl0IGJhY2sgd2l0aCB0aGUgc2F2ZWQgdmFsdWUuCi0gKiBUbyBzaW1w
bGlmeSB0aGUgV0EsIGEgY29uc3RhbnQgdmFsdWUgaXMgZm9ybWVkIGJ5IHVzaW5nIHRoZSBkZWZh
dWx0IHZhbHVlCi0gKiBvZiB0aGlzIHJlZ2lzdGVyLiBUaGlzIHNob3VsZG4ndCBiZSBhIHByb2Js
ZW0gYmVjYXVzZSB3ZSBhcmUgb25seSBtb2RpZnlpbmcKLSAqIGl0IGZvciBhIHNob3J0IHBlcmlv
ZCBhbmQgdGhpcyBiYXRjaCBpbiBub24tcHJlbXB0aWJsZS4gV2UgY2FuIG9mY291cnNlCi0gKiB1
c2UgYWRkaXRpb25hbCBpbnN0cnVjdGlvbnMgdGhhdCByZWFkIHRoZSBhY3R1YWwgdmFsdWUgb2Yg
dGhlIHJlZ2lzdGVyCi0gKiBhdCB0aGF0IHRpbWUgYW5kIHNldCBvdXIgYml0IG9mIGludGVyZXN0
IGJ1dCBpdCBtYWtlcyB0aGUgV0EgY29tcGxpY2F0ZWQuCi0gKgotICogVGhpcyBXQSBpcyBhbHNv
IHJlcXVpcmVkIGZvciBHZW45IHNvIGV4dHJhY3RpbmcgYXMgYSBmdW5jdGlvbiBhdm9pZHMKLSAq
IGNvZGUgZHVwbGljYXRpb24uCi0gKi8KLXN0YXRpYyB1MzIgKgotZ2VuOF9lbWl0X2ZsdXNoX2Nv
aGVyZW50bDNfd2Eoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1MzIgKmJhdGNoKQot
ewotCS8qIE5CIG5vIG9uZSBlbHNlIGlzIGFsbG93ZWQgdG8gc2NyaWJibGUgb3ZlciBzY3JhdGNo
ICsgMjU2ISAqLwotCSpiYXRjaCsrID0gTUlfU1RPUkVfUkVHSVNURVJfTUVNX0dFTjggfCBNSV9T
Uk1fTFJNX0dMT0JBTF9HVFQ7Ci0JKmJhdGNoKysgPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44
X0wzU1FDUkVHNCk7Ci0JKmJhdGNoKysgPSBpbnRlbF9ndF9zY3JhdGNoX29mZnNldChlbmdpbmUt
Pmd0LAotCQkJCQkgICBJTlRFTF9HVF9TQ1JBVENIX0ZJRUxEX0NPSEVSRU5UTDNfV0EpOwotCSpi
YXRjaCsrID0gMDsKLQotCSpiYXRjaCsrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oMSk7Ci0JKmJh
dGNoKysgPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X0wzU1FDUkVHNCk7Ci0JKmJhdGNoKysg
PSAweDQwNDAwMDAwIHwgR0VOOF9MUVNDX0ZMVVNIX0NPSEVSRU5UX0xJTkVTOwotCi0JYmF0Y2gg
PSBnZW44X2VtaXRfcGlwZV9jb250cm9sKGJhdGNoLAotCQkJCSAgICAgICBQSVBFX0NPTlRST0xf
Q1NfU1RBTEwgfAotCQkJCSAgICAgICBQSVBFX0NPTlRST0xfRENfRkxVU0hfRU5BQkxFLAotCQkJ
CSAgICAgICAwKTsKLQotCSpiYXRjaCsrID0gTUlfTE9BRF9SRUdJU1RFUl9NRU1fR0VOOCB8IE1J
X1NSTV9MUk1fR0xPQkFMX0dUVDsKLQkqYmF0Y2grKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEdF
TjhfTDNTUUNSRUc0KTsKLQkqYmF0Y2grKyA9IGludGVsX2d0X3NjcmF0Y2hfb2Zmc2V0KGVuZ2lu
ZS0+Z3QsCi0JCQkJCSAgIElOVEVMX0dUX1NDUkFUQ0hfRklFTERfQ09IRVJFTlRMM19XQSk7Ci0J
KmJhdGNoKysgPSAwOwotCi0JcmV0dXJuIGJhdGNoOwotfQotCi0vKgotICogVHlwaWNhbGx5IHdl
IG9ubHkgaGF2ZSBvbmUgaW5kaXJlY3RfY3R4IGFuZCBwZXJfY3R4IGJhdGNoIGJ1ZmZlciB3aGlj
aCBhcmUKLSAqIGluaXRpYWxpemVkIGF0IHRoZSBiZWdpbm5pbmcgYW5kIHNoYXJlZCBhY3Jvc3Mg
YWxsIGNvbnRleHRzIGJ1dCB0aGlzIGZpZWxkCi0gKiBoZWxwcyB1cyB0byBoYXZlIG11bHRpcGxl
IGJhdGNoZXMgYXQgZGlmZmVyZW50IG9mZnNldHMgYW5kIHNlbGVjdCB0aGVtIGJhc2VkCi0gKiBv
biBhIGNyaXRlcmlhLiBBdCB0aGUgbW9tZW50IHRoaXMgYmF0Y2ggYWx3YXlzIHN0YXJ0IGF0IHRo
ZSBiZWdpbm5pbmcgb2YgdGhlIHBhZ2UKLSAqIGFuZCBhdCB0aGlzIHBvaW50IHdlIGRvbid0IGhh
dmUgbXVsdGlwbGUgd2FfY3R4IGJhdGNoIGJ1ZmZlcnMuCi0gKgotICogVGhlIG51bWJlciBvZiBX
QSBhcHBsaWVkIGFyZSBub3Qga25vd24gYXQgdGhlIGJlZ2lubmluZzsgd2UgdXNlIHRoaXMgZmll
bGQKLSAqIHRvIHJldHVybiB0aGUgbm8gb2YgRFdPUkRTIHdyaXR0ZW4uCi0gKgotICogSXQgaXMg
dG8gYmUgbm90ZWQgdGhhdCB0aGlzIGJhdGNoIGRvZXMgbm90IGNvbnRhaW4gTUlfQkFUQ0hfQlVG
RkVSX0VORAotICogc28gaXQgYWRkcyBOT09QcyBhcyBwYWRkaW5nIHRvIG1ha2UgaXQgY2FjaGVs
aW5lIGFsaWduZWQuCi0gKiBNSV9CQVRDSF9CVUZGRVJfRU5EIHdpbGwgYmUgYWRkZWQgdG8gcGVy
Y3R4IGJhdGNoIGFuZCBib3RoIG9mIHRoZW0gdG9nZXRoZXIKLSAqIG1ha2VzIGEgY29tcGxldGUg
YmF0Y2ggYnVmZmVyLgotICovCi1zdGF0aWMgdTMyICpnZW44X2luaXRfaW5kaXJlY3RjdHhfYmIo
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1MzIgKmJhdGNoKQotewotCS8qIFdhRGlz
YWJsZUN0eFJlc3RvcmVBcmJpdHJhdGlvbjpiZHcsY2h2ICovCi0JKmJhdGNoKysgPSBNSV9BUkJf
T05fT0ZGIHwgTUlfQVJCX0RJU0FCTEU7Ci0KLQkvKiBXYUZsdXNoQ29oZXJlbnRMM0NhY2hlTGlu
ZXNBdENvbnRleHRTd2l0Y2g6YmR3ICovCi0JaWYgKElTX0JST0FEV0VMTChlbmdpbmUtPmk5MTUp
KQotCQliYXRjaCA9IGdlbjhfZW1pdF9mbHVzaF9jb2hlcmVudGwzX3dhKGVuZ2luZSwgYmF0Y2gp
OwotCi0JLyogV2FDbGVhclNsbVNwYWNlQXRDb250ZXh0U3dpdGNoOmJkdyxjaHYgKi8KLQkvKiBB
Y3R1YWwgc2NyYXRjaCBsb2NhdGlvbiBpcyBhdCAxMjggYnl0ZXMgb2Zmc2V0ICovCi0JYmF0Y2gg
PSBnZW44X2VtaXRfcGlwZV9jb250cm9sKGJhdGNoLAotCQkJCSAgICAgICBQSVBFX0NPTlRST0xf
RkxVU0hfTDMgfAotCQkJCSAgICAgICBQSVBFX0NPTlRST0xfU1RPUkVfREFUQV9JTkRFWCB8Ci0J
CQkJICAgICAgIFBJUEVfQ09OVFJPTF9DU19TVEFMTCB8Ci0JCQkJICAgICAgIFBJUEVfQ09OVFJP
TF9RV19XUklURSwKLQkJCQkgICAgICAgTFJDX1BQSFdTUF9TQ1JBVENIX0FERFIpOwotCi0JKmJh
dGNoKysgPSBNSV9BUkJfT05fT0ZGIHwgTUlfQVJCX0VOQUJMRTsKLQotCS8qIFBhZCB0byBlbmQg
b2YgY2FjaGVsaW5lICovCi0Jd2hpbGUgKCh1bnNpZ25lZCBsb25nKWJhdGNoICUgQ0FDSEVMSU5F
X0JZVEVTKQotCQkqYmF0Y2grKyA9IE1JX05PT1A7Ci0KLQkvKgotCSAqIE1JX0JBVENIX0JVRkZF
Ul9FTkQgaXMgbm90IHJlcXVpcmVkIGluIEluZGlyZWN0IGN0eCBCQiBiZWNhdXNlCi0JICogZXhl
Y3V0aW9uIGRlcGVuZHMgb24gdGhlIGxlbmd0aCBzcGVjaWZpZWQgaW4gdGVybXMgb2YgY2FjaGUg
bGluZXMKLQkgKiBpbiB0aGUgcmVnaXN0ZXIgQ1RYX1JDU19JTkRJUkVDVF9DVFgKLQkgKi8KLQot
CXJldHVybiBiYXRjaDsKLX0KLQotc3RydWN0IGxyaSB7Ci0JaTkxNV9yZWdfdCByZWc7Ci0JdTMy
IHZhbHVlOwotfTsKLQotc3RhdGljIHUzMiAqZW1pdF9scmkodTMyICpiYXRjaCwgY29uc3Qgc3Ry
dWN0IGxyaSAqbHJpLCB1bnNpZ25lZCBpbnQgY291bnQpCi17Ci0JR0VNX0JVR19PTighY291bnQg
fHwgY291bnQgPiA2Myk7Ci0KLQkqYmF0Y2grKyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKGNvdW50
KTsKLQlkbyB7Ci0JCSpiYXRjaCsrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQobHJpLT5yZWcpOwot
CQkqYmF0Y2grKyA9IGxyaS0+dmFsdWU7Ci0JfSB3aGlsZSAobHJpKyssIC0tY291bnQpOwotCSpi
YXRjaCsrID0gTUlfTk9PUDsKLQotCXJldHVybiBiYXRjaDsKLX0KLQotc3RhdGljIHUzMiAqZ2Vu
OV9pbml0X2luZGlyZWN0Y3R4X2JiKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgdTMy
ICpiYXRjaCkKLXsKLQlzdGF0aWMgY29uc3Qgc3RydWN0IGxyaSBscmlbXSA9IHsKLQkJLyogV2FE
aXNhYmxlR2F0aGVyQXRTZXRTaGFkZXJDb21tb25TbGljZTpza2wsYnh0LGtibCxnbGsgKi8KLQkJ
ewotCQkJQ09NTU9OX1NMSUNFX0NISUNLRU4yLAotCQkJX19NQVNLRURfRklFTEQoR0VOOV9ESVNB
QkxFX0dBVEhFUl9BVF9TRVRfU0hBREVSX0NPTU1PTl9TTElDRSwKLQkJCQkgICAgICAgMCksCi0J
CX0sCi0KLQkJLyogQlNwZWM6IDExMzkxICovCi0JCXsKLQkJCUZGX1NMSUNFX0NISUNLRU4sCi0J
CQlfX01BU0tFRF9GSUVMRChGRl9TTElDRV9DSElDS0VOX0NMX1BST1ZPS0lOR19WRVJURVhfRklY
LAotCQkJCSAgICAgICBGRl9TTElDRV9DSElDS0VOX0NMX1BST1ZPS0lOR19WRVJURVhfRklYKSwK
LQkJfSwKLQotCQkvKiBCU3BlYzogMTEyOTkgKi8KLQkJewotCQkJXzNEX0NISUNLRU4zLAotCQkJ
X19NQVNLRURfRklFTEQoXzNEX0NISUNLRU5fU0ZfUFJPVk9LSU5HX1ZFUlRFWF9GSVgsCi0JCQkJ
ICAgICAgIF8zRF9DSElDS0VOX1NGX1BST1ZPS0lOR19WRVJURVhfRklYKSwKLQkJfQotCX07Ci0K
LQkqYmF0Y2grKyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJfRElTQUJMRTsKLQotCS8qIFdhRmx1
c2hDb2hlcmVudEwzQ2FjaGVMaW5lc0F0Q29udGV4dFN3aXRjaDpza2wsYnh0LGdsayAqLwotCWJh
dGNoID0gZ2VuOF9lbWl0X2ZsdXNoX2NvaGVyZW50bDNfd2EoZW5naW5lLCBiYXRjaCk7Ci0KLQkv
KiBXYUNsZWFyU2xtU3BhY2VBdENvbnRleHRTd2l0Y2g6c2tsLGJ4dCxrYmwsZ2xrLGNmbCAqLwot
CWJhdGNoID0gZ2VuOF9lbWl0X3BpcGVfY29udHJvbChiYXRjaCwKLQkJCQkgICAgICAgUElQRV9D
T05UUk9MX0ZMVVNIX0wzIHwKLQkJCQkgICAgICAgUElQRV9DT05UUk9MX1NUT1JFX0RBVEFfSU5E
RVggfAotCQkJCSAgICAgICBQSVBFX0NPTlRST0xfQ1NfU1RBTEwgfAotCQkJCSAgICAgICBQSVBF
X0NPTlRST0xfUVdfV1JJVEUsCi0JCQkJICAgICAgIExSQ19QUEhXU1BfU0NSQVRDSF9BRERSKTsK
LQotCWJhdGNoID0gZW1pdF9scmkoYmF0Y2gsIGxyaSwgQVJSQVlfU0laRShscmkpKTsKLQotCS8q
IFdhTWVkaWFQb29sU3RhdGVDbWRJbldBQkI6Ynh0LGdsayAqLwotCWlmIChIQVNfUE9PTEVEX0VV
KGVuZ2luZS0+aTkxNSkpIHsKLQkJLyoKLQkJICogRVUgcG9vbCBjb25maWd1cmF0aW9uIGlzIHNl
dHVwIGFsb25nIHdpdGggZ29sZGVuIGNvbnRleHQKLQkJICogZHVyaW5nIGNvbnRleHQgaW5pdGlh
bGl6YXRpb24uIFRoaXMgdmFsdWUgZGVwZW5kcyBvbgotCQkgKiBkZXZpY2UgdHlwZSAoMng2IG9y
IDN4NikgYW5kIG5lZWRzIHRvIGJlIHVwZGF0ZWQgYmFzZWQKLQkJICogb24gd2hpY2ggc3Vic2xp
Y2UgaXMgZGlzYWJsZWQgZXNwZWNpYWxseSBmb3IgMng2Ci0JCSAqIGRldmljZXMsIGhvd2V2ZXIg
aXQgaXMgc2FmZSB0byBsb2FkIGRlZmF1bHQKLQkJICogY29uZmlndXJhdGlvbiBvZiAzeDYgZGV2
aWNlIGluc3RlYWQgb2YgbWFza2luZyBvZmYKLQkJICogY29ycmVzcG9uZGluZyBiaXRzIGJlY2F1
c2UgSFcgaWdub3JlcyBiaXRzIG9mIGEgZGlzYWJsZWQKLQkJICogc3Vic2xpY2UgYW5kIGRyb3Bz
IGRvd24gdG8gYXBwcm9wcmlhdGUgY29uZmlnLiBQbGVhc2UKLQkJICogc2VlIHJlbmRlcl9zdGF0
ZV9zZXR1cCgpIGluIGk5MTVfZ2VtX3JlbmRlcl9zdGF0ZS5jIGZvcgotCQkgKiBwb3NzaWJsZSBj
b25maWd1cmF0aW9ucywgdG8gYXZvaWQgZHVwbGljYXRpb24gdGhleSBhcmUKLQkJICogbm90IHNo
b3duIGhlcmUgYWdhaW4uCi0JCSAqLwotCQkqYmF0Y2grKyA9IEdFTjlfTUVESUFfUE9PTF9TVEFU
RTsKLQkJKmJhdGNoKysgPSBHRU45X01FRElBX1BPT0xfRU5BQkxFOwotCQkqYmF0Y2grKyA9IDB4
MDA3NzcwMDA7Ci0JCSpiYXRjaCsrID0gMDsKLQkJKmJhdGNoKysgPSAwOwotCQkqYmF0Y2grKyA9
IDA7Ci0JfQotCi0JKmJhdGNoKysgPSBNSV9BUkJfT05fT0ZGIHwgTUlfQVJCX0VOQUJMRTsKLQot
CS8qIFBhZCB0byBlbmQgb2YgY2FjaGVsaW5lICovCi0Jd2hpbGUgKCh1bnNpZ25lZCBsb25nKWJh
dGNoICUgQ0FDSEVMSU5FX0JZVEVTKQotCQkqYmF0Y2grKyA9IE1JX05PT1A7Ci0KLQlyZXR1cm4g
YmF0Y2g7Ci19Ci0KLXN0YXRpYyB1MzIgKgotZ2VuMTBfaW5pdF9pbmRpcmVjdGN0eF9iYihzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHUzMiAqYmF0Y2gpCi17Ci0JaW50IGk7Ci0KLQkv
KgotCSAqIFdhUGlwZUNvbnRyb2xCZWZvcmUzRFN0YXRlU2FtcGxlUGF0dGVybjogY25sCi0JICoK
LQkgKiBFbnN1cmUgdGhlIGVuZ2luZSBpcyBpZGxlIHByaW9yIHRvIHByb2dyYW1taW5nIGEKLQkg
KiAzRFNUQVRFX1NBTVBMRV9QQVRURVJOIGR1cmluZyBhIGNvbnRleHQgcmVzdG9yZS4KLQkgKi8K
LQliYXRjaCA9IGdlbjhfZW1pdF9waXBlX2NvbnRyb2woYmF0Y2gsCi0JCQkJICAgICAgIFBJUEVf
Q09OVFJPTF9DU19TVEFMTCwKLQkJCQkgICAgICAgMCk7Ci0JLyoKLQkgKiBXYVBpcGVDb250cm9s
QmVmb3JlM0RTdGF0ZVNhbXBsZVBhdHRlcm4gc2F5cyB3ZSBuZWVkIDQgZHdvcmRzIGZvcgotCSAq
IHRoZSBQSVBFX0NPTlRST0wgZm9sbG93ZWQgYnkgMTIgZHdvcmRzIG9mIDB4MCwgc28gMTYgZHdv
cmRzIGluCi0JICogdG90YWwuIEhvd2V2ZXIsIGEgUElQRV9DT05UUk9MIGlzIDYgZHdvcmRzIGxv
bmcsIG5vdCA0LCB3aGljaCBpcwotCSAqIGNvbmZ1c2luZy4gU2luY2UgZ2VuOF9lbWl0X3BpcGVf
Y29udHJvbCgpIGFscmVhZHkgYWR2YW5jZXMgdGhlCi0JICogYmF0Y2ggYnkgNiBkd29yZHMsIHdl
IGFkdmFuY2UgdGhlIG90aGVyIDEwIGhlcmUsIGNvbXBsZXRpbmcgYQotCSAqIGNhY2hlbGluZS4g
SXQncyBub3QgY2xlYXIgaWYgdGhlIHdvcmthcm91bmQgcmVxdWlyZXMgdGhpcyBwYWRkaW5nCi0J
ICogYmVmb3JlIG90aGVyIGNvbW1hbmRzLCBvciBpZiBpdCdzIGp1c3QgdGhlIHJlZ3VsYXIgcGFk
ZGluZyB3ZSB3b3VsZAotCSAqIGFscmVhZHkgaGF2ZSBmb3IgdGhlIHdvcmthcm91bmQgYmIsIHNv
IGxlYXZlIGl0IGhlcmUgZm9yIG5vdy4KLQkgKi8KLQlmb3IgKGkgPSAwOyBpIDwgMTA7IGkrKykK
LQkJKmJhdGNoKysgPSBNSV9OT09QOwotCi0JLyogUGFkIHRvIGVuZCBvZiBjYWNoZWxpbmUgKi8K
LQl3aGlsZSAoKHVuc2lnbmVkIGxvbmcpYmF0Y2ggJSBDQUNIRUxJTkVfQllURVMpCi0JCSpiYXRj
aCsrID0gTUlfTk9PUDsKLQotCXJldHVybiBiYXRjaDsKLX0KLQotI2RlZmluZSBDVFhfV0FfQkJf
T0JKX1NJWkUgKFBBR0VfU0laRSkKLQotc3RhdGljIGludCBscmNfc2V0dXBfd2FfY3R4KHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVj
dCAqb2JqOwotCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwotCWludCBlcnI7Ci0KLQlvYmogPSBpOTE1
X2dlbV9vYmplY3RfY3JlYXRlX3NobWVtKGVuZ2luZS0+aTkxNSwgQ1RYX1dBX0JCX09CSl9TSVpF
KTsKLQlpZiAoSVNfRVJSKG9iaikpCi0JCXJldHVybiBQVFJfRVJSKG9iaik7Ci0KLQl2bWEgPSBp
OTE1X3ZtYV9pbnN0YW5jZShvYmosICZlbmdpbmUtPmd0LT5nZ3R0LT52bSwgTlVMTCk7Ci0JaWYg
KElTX0VSUih2bWEpKSB7Ci0JCWVyciA9IFBUUl9FUlIodm1hKTsKLQkJZ290byBlcnI7Ci0JfQot
Ci0JZXJyID0gaTkxNV9nZ3R0X3Bpbih2bWEsIDAsIFBJTl9ISUdIKTsKLQlpZiAoZXJyKQotCQln
b3RvIGVycjsKLQotCWVuZ2luZS0+d2FfY3R4LnZtYSA9IHZtYTsKLQlyZXR1cm4gMDsKLQotZXJy
OgotCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKLQlyZXR1cm4gZXJyOwotfQotCi1zdGF0aWMg
dm9pZCBscmNfZGVzdHJveV93YV9jdHgoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQot
ewotCWk5MTVfdm1hX3VucGluX2FuZF9yZWxlYXNlKCZlbmdpbmUtPndhX2N0eC52bWEsIDApOwot
fQotCi10eXBlZGVmIHUzMiAqKCp3YV9iYl9mdW5jX3QpKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSwgdTMyICpiYXRjaCk7Ci0KLXN0YXRpYyBpbnQgaW50ZWxfaW5pdF93b3JrYXJvdW5k
X2JiKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKLXsKLQlzdHJ1Y3QgaTkxNV9jdHhf
d29ya2Fyb3VuZHMgKndhX2N0eCA9ICZlbmdpbmUtPndhX2N0eDsKLQlzdHJ1Y3QgaTkxNV93YV9j
dHhfYmIgKndhX2JiWzJdID0geyAmd2FfY3R4LT5pbmRpcmVjdF9jdHgsCi0JCQkJCSAgICAmd2Ff
Y3R4LT5wZXJfY3R4IH07Ci0Jd2FfYmJfZnVuY190IHdhX2JiX2ZuWzJdOwotCXN0cnVjdCBwYWdl
ICpwYWdlOwotCXZvaWQgKmJhdGNoLCAqYmF0Y2hfcHRyOwotCXVuc2lnbmVkIGludCBpOwotCWlu
dCByZXQ7Ci0KLQlpZiAoZW5naW5lLT5jbGFzcyAhPSBSRU5ERVJfQ0xBU1MpCi0JCXJldHVybiAw
OwotCi0Jc3dpdGNoIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSkgewotCWNhc2UgMTI6Ci0JY2Fz
ZSAxMToKLQkJcmV0dXJuIDA7Ci0JY2FzZSAxMDoKLQkJd2FfYmJfZm5bMF0gPSBnZW4xMF9pbml0
X2luZGlyZWN0Y3R4X2JiOwotCQl3YV9iYl9mblsxXSA9IE5VTEw7Ci0JCWJyZWFrOwotCWNhc2Ug
OToKLQkJd2FfYmJfZm5bMF0gPSBnZW45X2luaXRfaW5kaXJlY3RjdHhfYmI7Ci0JCXdhX2JiX2Zu
WzFdID0gTlVMTDsKLQkJYnJlYWs7Ci0JY2FzZSA4OgotCQl3YV9iYl9mblswXSA9IGdlbjhfaW5p
dF9pbmRpcmVjdGN0eF9iYjsKLQkJd2FfYmJfZm5bMV0gPSBOVUxMOwotCQlicmVhazsKLQlkZWZh
dWx0OgotCQlNSVNTSU5HX0NBU0UoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkpOwotCQlyZXR1cm4g
MDsKLQl9Ci0KLQlyZXQgPSBscmNfc2V0dXBfd2FfY3R4KGVuZ2luZSk7Ci0JaWYgKHJldCkgewot
CQlEUk1fREVCVUdfRFJJVkVSKCJGYWlsZWQgdG8gc2V0dXAgY29udGV4dCBXQSBwYWdlOiAlZFxu
IiwgcmV0KTsKLQkJcmV0dXJuIHJldDsKLQl9Ci0KLQlwYWdlID0gaTkxNV9nZW1fb2JqZWN0X2dl
dF9kaXJ0eV9wYWdlKHdhX2N0eC0+dm1hLT5vYmosIDApOwotCWJhdGNoID0gYmF0Y2hfcHRyID0g
a21hcF9hdG9taWMocGFnZSk7Ci0KLQkvKgotCSAqIEVtaXQgdGhlIHR3byB3b3JrYXJvdW5kIGJh
dGNoIGJ1ZmZlcnMsIHJlY29yZGluZyB0aGUgb2Zmc2V0IGZyb20gdGhlCi0JICogc3RhcnQgb2Yg
dGhlIHdvcmthcm91bmQgYmF0Y2ggYnVmZmVyIG9iamVjdCBmb3IgZWFjaCBhbmQgdGhlaXIKLQkg
KiByZXNwZWN0aXZlIHNpemVzLgotCSAqLwotCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKHdh
X2JiX2ZuKTsgaSsrKSB7Ci0JCXdhX2JiW2ldLT5vZmZzZXQgPSBiYXRjaF9wdHIgLSBiYXRjaDsK
LQkJaWYgKEdFTV9ERUJVR19XQVJOX09OKCFJU19BTElHTkVEKHdhX2JiW2ldLT5vZmZzZXQsCi0J
CQkJCQkgIENBQ0hFTElORV9CWVRFUykpKSB7Ci0JCQlyZXQgPSAtRUlOVkFMOwotCQkJYnJlYWs7
Ci0JCX0KLQkJaWYgKHdhX2JiX2ZuW2ldKQotCQkJYmF0Y2hfcHRyID0gd2FfYmJfZm5baV0oZW5n
aW5lLCBiYXRjaF9wdHIpOwotCQl3YV9iYltpXS0+c2l6ZSA9IGJhdGNoX3B0ciAtIChiYXRjaCAr
IHdhX2JiW2ldLT5vZmZzZXQpOwotCX0KLQotCUJVR19PTihiYXRjaF9wdHIgLSBiYXRjaCA+IENU
WF9XQV9CQl9PQkpfU0laRSk7Ci0KLQlrdW5tYXBfYXRvbWljKGJhdGNoKTsKLQlpZiAocmV0KQot
CQlscmNfZGVzdHJveV93YV9jdHgoZW5naW5lKTsKLQotCXJldHVybiByZXQ7Ci19Ci0KIHN0YXRp
YyB2b2lkIGVuYWJsZV9lcnJvcl9pbnRlcnJ1cHQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lKQogewogCXUzMiBzdGF0dXM7CkBAIC0zNTI3LDI1ICsyNTM3LDYgQEAgc3RhdGljIHZvaWQg
cmVzZXRfY3NiX3BvaW50ZXJzKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAkJCSAg
ICAgICAmZXhlY2xpc3RzLT5jc2Jfc3RhdHVzW3Jlc2V0X3ZhbHVlXSk7CiB9CiAKLXN0YXRpYyB2
b2lkIF9fcmVzZXRfc3RvcF9yaW5nKHUzMiAqcmVncywgY29uc3Qgc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lKQotewotCWludCB4OwotCi0JeCA9IGxyY19yaW5nX21pX21vZGUoZW5naW5l
KTsKLQlpZiAoeCAhPSAtMSkgewotCQlyZWdzW3ggKyAxXSAmPSB+U1RPUF9SSU5HOwotCQlyZWdz
W3ggKyAxXSB8PSBTVE9QX1JJTkcgPDwgMTY7Ci0JfQotfQotCi1zdGF0aWMgdm9pZCBfX2V4ZWNs
aXN0c19yZXNldF9yZWdfc3RhdGUoY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAotCQkJ
CQljb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCi17Ci0JdTMyICpyZWdzID0g
Y2UtPmxyY19yZWdfc3RhdGU7Ci0KLQlfX3Jlc2V0X3N0b3BfcmluZyhyZWdzLCBlbmdpbmUpOwot
fQotCiBzdGF0aWMgdm9pZCBfX2V4ZWNsaXN0c19yZXNldChzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmUsIGJvb2wgc3RhbGxlZCkKIHsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0
cyAqIGNvbnN0IGV4ZWNsaXN0cyA9ICZlbmdpbmUtPmV4ZWNsaXN0czsKQEAgLTM2MzMsOCArMjYy
NCw4IEBAIHN0YXRpYyB2b2lkIF9fZXhlY2xpc3RzX3Jlc2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSwgYm9vbCBzdGFsbGVkKQogCUVOR0lORV9UUkFDRShlbmdpbmUsICJyZXBsYXkg
e2hlYWQ6JTA0eCwgdGFpbDolMDR4fVxuIiwKIAkJICAgICBjZS0+cmluZy0+aGVhZCwgY2UtPnJp
bmctPnRhaWwpOwogCWludGVsX3JpbmdfdXBkYXRlX3NwYWNlKGNlLT5yaW5nKTsKLQlfX2V4ZWNs
aXN0c19yZXNldF9yZWdfc3RhdGUoY2UsIGVuZ2luZSk7Ci0JX19leGVjbGlzdHNfdXBkYXRlX3Jl
Z19zdGF0ZShjZSwgZW5naW5lKTsKKwlpbnRlbF9scmNfcmVzZXRfcmVnX3N0YXRlKGNlLCBlbmdp
bmUpOworCWludGVsX2xyY191cGRhdGVfcmVnX3N0YXRlKGNlLCBlbmdpbmUpOwogCWNlLT5scmNf
ZGVzYyB8PSBDVFhfREVTQ19GT1JDRV9SRVNUT1JFOyAvKiBwYXJhbm9pZDogR1BVIHdhcyByZXNl
dCEgKi8KIAogdW53aW5kOgpAQCAtMzc2Myw2NyArMjc1NCw2IEBAIHN0YXRpYyB2b2lkIGV4ZWNs
aXN0c19yZXNldF9maW5pc2goc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCQkgICAg
IGF0b21pY19yZWFkKCZleGVjbGlzdHMtPnRhc2tsZXQuY291bnQpKTsKIH0KIAotc3RhdGljIGlu
dCBnZW44X2VtaXRfYmJfc3RhcnRfbm9hcmIoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCi0JCQkJ
ICAgIHU2NCBvZmZzZXQsIHUzMiBsZW4sCi0JCQkJICAgIGNvbnN0IHVuc2lnbmVkIGludCBmbGFn
cykKLXsKLQl1MzIgKmNzOwotCi0JY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJxLCA0KTsKLQlpZiAo
SVNfRVJSKGNzKSkKLQkJcmV0dXJuIFBUUl9FUlIoY3MpOwotCi0JLyoKLQkgKiBXYURpc2FibGVD
dHhSZXN0b3JlQXJiaXRyYXRpb246YmR3LGNodgotCSAqCi0JICogV2UgZG9uJ3QgbmVlZCB0byBw
ZXJmb3JtIE1JX0FSQl9FTkFCTEUgYXMgb2Z0ZW4gYXMgd2UgZG8gKGluCi0JICogcGFydGljdWxh
ciBhbGwgdGhlIGdlbiB0aGF0IGRvIG5vdCBuZWVkIHRoZSB3L2EgYXQgYWxsISksIGlmIHdlCi0J
ICogdG9vayBjYXJlIHRvIG1ha2Ugc3VyZSB0aGF0IG9uIGV2ZXJ5IHN3aXRjaCBpbnRvIHRoaXMg
Y29udGV4dAotCSAqIChib3RoIG9yZGluYXJ5IGFuZCBmb3IgcHJlZW1wdGlvbikgdGhhdCBhcmJp
dHJhcnRpb24gd2FzIGVuYWJsZWQKLQkgKiB3ZSB3b3VsZCBiZSBmaW5lLiAgSG93ZXZlciwgZm9y
IGdlbjggdGhlcmUgaXMgYW5vdGhlciB3L2EgdGhhdAotCSAqIHJlcXVpcmVzIHVzIHRvIG5vdCBw
cmVlbXB0IGluc2lkZSBHUEdQVSBleGVjdXRpb24sIHNvIHdlIGtlZXAKLQkgKiBhcmJpdHJhdGlv
biBkaXNhYmxlZCBmb3IgZ2VuOCBiYXRjaGVzLiBBcmJpdHJhdGlvbiB3aWxsIGJlCi0JICogcmUt
ZW5hYmxlZCBiZWZvcmUgd2UgY2xvc2UgdGhlIHJlcXVlc3QKLQkgKiAoZW5naW5lLT5lbWl0X2Zp
bmlfYnJlYWRjcnVtYikuCi0JICovCi0JKmNzKysgPSBNSV9BUkJfT05fT0ZGIHwgTUlfQVJCX0RJ
U0FCTEU7Ci0KLQkvKiBGSVhNRShCRFcrKTogQWRkcmVzcyBzcGFjZSBhbmQgc2VjdXJpdHkgc2Vs
ZWN0b3JzLiAqLwotCSpjcysrID0gTUlfQkFUQ0hfQlVGRkVSX1NUQVJUX0dFTjggfAotCQkoZmxh
Z3MgJiBJOTE1X0RJU1BBVENIX1NFQ1VSRSA/IDAgOiBCSVQoOCkpOwotCSpjcysrID0gbG93ZXJf
MzJfYml0cyhvZmZzZXQpOwotCSpjcysrID0gdXBwZXJfMzJfYml0cyhvZmZzZXQpOwotCi0JaW50
ZWxfcmluZ19hZHZhbmNlKHJxLCBjcyk7Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCBn
ZW44X2VtaXRfYmJfc3RhcnQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCi0JCQkgICAgICB1NjQg
b2Zmc2V0LCB1MzIgbGVuLAotCQkJICAgICAgY29uc3QgdW5zaWduZWQgaW50IGZsYWdzKQotewot
CXUzMiAqY3M7Ci0KLQljcyA9IGludGVsX3JpbmdfYmVnaW4ocnEsIDYpOwotCWlmIChJU19FUlIo
Y3MpKQotCQlyZXR1cm4gUFRSX0VSUihjcyk7Ci0KLQkqY3MrKyA9IE1JX0FSQl9PTl9PRkYgfCBN
SV9BUkJfRU5BQkxFOwotCi0JKmNzKysgPSBNSV9CQVRDSF9CVUZGRVJfU1RBUlRfR0VOOCB8Ci0J
CShmbGFncyAmIEk5MTVfRElTUEFUQ0hfU0VDVVJFID8gMCA6IEJJVCg4KSk7Ci0JKmNzKysgPSBs
b3dlcl8zMl9iaXRzKG9mZnNldCk7Ci0JKmNzKysgPSB1cHBlcl8zMl9iaXRzKG9mZnNldCk7Ci0K
LQkqY3MrKyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJfRElTQUJMRTsKLQkqY3MrKyA9IE1JX05P
T1A7Ci0KLQlpbnRlbF9yaW5nX2FkdmFuY2UocnEsIGNzKTsKLQotCXJldHVybiAwOwotfQotCiBz
dGF0aWMgdm9pZCBnZW44X2xvZ2ljYWxfcmluZ19lbmFibGVfaXJxKHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSkKIHsKIAlFTkdJTkVfV1JJVEUoZW5naW5lLCBSSU5HX0lNUiwKQEAgLTM4
MzYsMjQ5ICsyNzY2LDYgQEAgc3RhdGljIHZvaWQgZ2VuOF9sb2dpY2FsX3JpbmdfZGlzYWJsZV9p
cnEoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCUVOR0lORV9XUklURShlbmdpbmUs
IFJJTkdfSU1SLCB+ZW5naW5lLT5pcnFfa2VlcF9tYXNrKTsKIH0KIAotc3RhdGljIGludCBnZW44
X2VtaXRfZmx1c2goc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCwgdTMyIG1vZGUpCi17Ci0J
dTMyIGNtZCwgKmNzOwotCi0JY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJlcXVlc3QsIDQpOwotCWlm
IChJU19FUlIoY3MpKQotCQlyZXR1cm4gUFRSX0VSUihjcyk7Ci0KLQljbWQgPSBNSV9GTFVTSF9E
VyArIDE7Ci0KLQkvKiBXZSBhbHdheXMgcmVxdWlyZSBhIGNvbW1hbmQgYmFycmllciBzbyB0aGF0
IHN1YnNlcXVlbnQKLQkgKiBjb21tYW5kcywgc3VjaCBhcyBicmVhZGNydW1iIGludGVycnVwdHMs
IGFyZSBzdHJpY3RseSBvcmRlcmVkCi0JICogd3J0IHRoZSBjb250ZW50cyBvZiB0aGUgd3JpdGUg
Y2FjaGUgYmVpbmcgZmx1c2hlZCB0byBtZW1vcnkKLQkgKiAoYW5kIHRodXMgYmVpbmcgY29oZXJl
bnQgZnJvbSB0aGUgQ1BVKS4KLQkgKi8KLQljbWQgfD0gTUlfRkxVU0hfRFdfU1RPUkVfSU5ERVgg
fCBNSV9GTFVTSF9EV19PUF9TVE9SRURXOwotCi0JaWYgKG1vZGUgJiBFTUlUX0lOVkFMSURBVEUp
IHsKLQkJY21kIHw9IE1JX0lOVkFMSURBVEVfVExCOwotCQlpZiAocmVxdWVzdC0+ZW5naW5lLT5j
bGFzcyA9PSBWSURFT19ERUNPREVfQ0xBU1MpCi0JCQljbWQgfD0gTUlfSU5WQUxJREFURV9CU0Q7
Ci0JfQotCi0JKmNzKysgPSBjbWQ7Ci0JKmNzKysgPSBMUkNfUFBIV1NQX1NDUkFUQ0hfQUREUjsK
LQkqY3MrKyA9IDA7IC8qIHVwcGVyIGFkZHIgKi8KLQkqY3MrKyA9IDA7IC8qIHZhbHVlICovCi0J
aW50ZWxfcmluZ19hZHZhbmNlKHJlcXVlc3QsIGNzKTsKLQotCXJldHVybiAwOwotfQotCi1zdGF0
aWMgaW50IGdlbjhfZW1pdF9mbHVzaF9yZW5kZXIoc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVz
dCwKLQkJCQkgIHUzMiBtb2RlKQotewotCWJvb2wgdmZfZmx1c2hfd2EgPSBmYWxzZSwgZGNfZmx1
c2hfd2EgPSBmYWxzZTsKLQl1MzIgKmNzLCBmbGFncyA9IDA7Ci0JaW50IGxlbjsKLQotCWZsYWdz
IHw9IFBJUEVfQ09OVFJPTF9DU19TVEFMTDsKLQotCWlmIChtb2RlICYgRU1JVF9GTFVTSCkgewot
CQlmbGFncyB8PSBQSVBFX0NPTlRST0xfUkVOREVSX1RBUkdFVF9DQUNIRV9GTFVTSDsKLQkJZmxh
Z3MgfD0gUElQRV9DT05UUk9MX0RFUFRIX0NBQ0hFX0ZMVVNIOwotCQlmbGFncyB8PSBQSVBFX0NP
TlRST0xfRENfRkxVU0hfRU5BQkxFOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfRkxVU0hfRU5B
QkxFOwotCX0KLQotCWlmIChtb2RlICYgRU1JVF9JTlZBTElEQVRFKSB7Ci0JCWZsYWdzIHw9IFBJ
UEVfQ09OVFJPTF9UTEJfSU5WQUxJREFURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0lOU1RS
VUNUSU9OX0NBQ0hFX0lOVkFMSURBVEU7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9URVhUVVJF
X0NBQ0hFX0lOVkFMSURBVEU7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9WRl9DQUNIRV9JTlZB
TElEQVRFOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfQ09OU1RfQ0FDSEVfSU5WQUxJREFURTsK
LQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1NUQVRFX0NBQ0hFX0lOVkFMSURBVEU7Ci0JCWZsYWdz
IHw9IFBJUEVfQ09OVFJPTF9RV19XUklURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1NUT1JF
X0RBVEFfSU5ERVg7Ci0KLQkJLyoKLQkJICogT24gR0VOOTogYmVmb3JlIFZGX0NBQ0hFX0lOVkFM
SURBVEUgd2UgbmVlZCB0byBlbWl0IGEgTlVMTAotCQkgKiBwaXBlIGNvbnRyb2wuCi0JCSAqLwot
CQlpZiAoSVNfR0VOKHJlcXVlc3QtPmk5MTUsIDkpKQotCQkJdmZfZmx1c2hfd2EgPSB0cnVlOwot
Ci0JCS8qIFdhRm9yR0FNSGFuZzprYmwgKi8KLQkJaWYgKElTX0tCTF9SRVZJRChyZXF1ZXN0LT5p
OTE1LCAwLCBLQkxfUkVWSURfQjApKQotCQkJZGNfZmx1c2hfd2EgPSB0cnVlOwotCX0KLQotCWxl
biA9IDY7Ci0KLQlpZiAodmZfZmx1c2hfd2EpCi0JCWxlbiArPSA2OwotCi0JaWYgKGRjX2ZsdXNo
X3dhKQotCQlsZW4gKz0gMTI7Ci0KLQljcyA9IGludGVsX3JpbmdfYmVnaW4ocmVxdWVzdCwgbGVu
KTsKLQlpZiAoSVNfRVJSKGNzKSkKLQkJcmV0dXJuIFBUUl9FUlIoY3MpOwotCi0JaWYgKHZmX2Zs
dXNoX3dhKQotCQljcyA9IGdlbjhfZW1pdF9waXBlX2NvbnRyb2woY3MsIDAsIDApOwotCi0JaWYg
KGRjX2ZsdXNoX3dhKQotCQljcyA9IGdlbjhfZW1pdF9waXBlX2NvbnRyb2woY3MsIFBJUEVfQ09O
VFJPTF9EQ19GTFVTSF9FTkFCTEUsCi0JCQkJCSAgICAwKTsKLQotCWNzID0gZ2VuOF9lbWl0X3Bp
cGVfY29udHJvbChjcywgZmxhZ3MsIExSQ19QUEhXU1BfU0NSQVRDSF9BRERSKTsKLQotCWlmIChk
Y19mbHVzaF93YSkKLQkJY3MgPSBnZW44X2VtaXRfcGlwZV9jb250cm9sKGNzLCBQSVBFX0NPTlRS
T0xfQ1NfU1RBTEwsIDApOwotCi0JaW50ZWxfcmluZ19hZHZhbmNlKHJlcXVlc3QsIGNzKTsKLQot
CXJldHVybiAwOwotfQotCi1zdGF0aWMgaW50IGdlbjExX2VtaXRfZmx1c2hfcmVuZGVyKHN0cnVj
dCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QsCi0JCQkJICAgdTMyIG1vZGUpCi17Ci0JaWYgKG1vZGUg
JiBFTUlUX0ZMVVNIKSB7Ci0JCXUzMiAqY3M7Ci0JCXUzMiBmbGFncyA9IDA7Ci0KLQkJZmxhZ3Mg
fD0gUElQRV9DT05UUk9MX0NTX1NUQUxMOwotCi0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9USUxF
X0NBQ0hFX0ZMVVNIOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfUkVOREVSX1RBUkdFVF9DQUNI
RV9GTFVTSDsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0RFUFRIX0NBQ0hFX0ZMVVNIOwotCQlm
bGFncyB8PSBQSVBFX0NPTlRST0xfRENfRkxVU0hfRU5BQkxFOwotCQlmbGFncyB8PSBQSVBFX0NP
TlRST0xfRkxVU0hfRU5BQkxFOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfUVdfV1JJVEU7Ci0J
CWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9TVE9SRV9EQVRBX0lOREVYOwotCi0JCWNzID0gaW50ZWxf
cmluZ19iZWdpbihyZXF1ZXN0LCA2KTsKLQkJaWYgKElTX0VSUihjcykpCi0JCQlyZXR1cm4gUFRS
X0VSUihjcyk7Ci0KLQkJY3MgPSBnZW44X2VtaXRfcGlwZV9jb250cm9sKGNzLCBmbGFncywgTFJD
X1BQSFdTUF9TQ1JBVENIX0FERFIpOwotCQlpbnRlbF9yaW5nX2FkdmFuY2UocmVxdWVzdCwgY3Mp
OwotCX0KLQotCWlmIChtb2RlICYgRU1JVF9JTlZBTElEQVRFKSB7Ci0JCXUzMiAqY3M7Ci0JCXUz
MiBmbGFncyA9IDA7Ci0KLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0NTX1NUQUxMOwotCi0JCWZs
YWdzIHw9IFBJUEVfQ09OVFJPTF9DT01NQU5EX0NBQ0hFX0lOVkFMSURBVEU7Ci0JCWZsYWdzIHw9
IFBJUEVfQ09OVFJPTF9UTEJfSU5WQUxJREFURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0lO
U1RSVUNUSU9OX0NBQ0hFX0lOVkFMSURBVEU7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9URVhU
VVJFX0NBQ0hFX0lOVkFMSURBVEU7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9WRl9DQUNIRV9J
TlZBTElEQVRFOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfQ09OU1RfQ0FDSEVfSU5WQUxJREFU
RTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1NUQVRFX0NBQ0hFX0lOVkFMSURBVEU7Ci0JCWZs
YWdzIHw9IFBJUEVfQ09OVFJPTF9RV19XUklURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1NU
T1JFX0RBVEFfSU5ERVg7Ci0KLQkJY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJlcXVlc3QsIDYpOwot
CQlpZiAoSVNfRVJSKGNzKSkKLQkJCXJldHVybiBQVFJfRVJSKGNzKTsKLQotCQljcyA9IGdlbjhf
ZW1pdF9waXBlX2NvbnRyb2woY3MsIGZsYWdzLCBMUkNfUFBIV1NQX1NDUkFUQ0hfQUREUik7Ci0J
CWludGVsX3JpbmdfYWR2YW5jZShyZXF1ZXN0LCBjcyk7Ci0JfQotCi0JcmV0dXJuIDA7Ci19Ci0K
LXN0YXRpYyB1MzIgcHJlcGFyc2VyX2Rpc2FibGUoYm9vbCBzdGF0ZSkKLXsKLQlyZXR1cm4gTUlf
QVJCX0NIRUNLIHwgMSA8PCA4IHwgc3RhdGU7Ci19Ci0KLXN0YXRpYyBpbnQgZ2VuMTJfZW1pdF9m
bHVzaF9yZW5kZXIoc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCwKLQkJCQkgICB1MzIgbW9k
ZSkKLXsKLQlpZiAobW9kZSAmIEVNSVRfRkxVU0gpIHsKLQkJdTMyIGZsYWdzID0gMDsKLQkJdTMy
ICpjczsKLQotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfVElMRV9DQUNIRV9GTFVTSDsKLQkJZmxh
Z3MgfD0gUElQRV9DT05UUk9MX1JFTkRFUl9UQVJHRVRfQ0FDSEVfRkxVU0g7Ci0JCWZsYWdzIHw9
IFBJUEVfQ09OVFJPTF9ERVBUSF9DQUNIRV9GTFVTSDsKLQkJLyogV2FfMTQwOTYwMDkwNzp0Z2wg
Ki8KLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0RFUFRIX1NUQUxMOwotCQlmbGFncyB8PSBQSVBF
X0NPTlRST0xfRENfRkxVU0hfRU5BQkxFOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfRkxVU0hf
RU5BQkxFOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfSERDX1BJUEVMSU5FX0ZMVVNIOwotCi0J
CWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9TVE9SRV9EQVRBX0lOREVYOwotCQlmbGFncyB8PSBQSVBF
X0NPTlRST0xfUVdfV1JJVEU7Ci0KLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0NTX1NUQUxMOwot
Ci0JCWNzID0gaW50ZWxfcmluZ19iZWdpbihyZXF1ZXN0LCA2KTsKLQkJaWYgKElTX0VSUihjcykp
Ci0JCQlyZXR1cm4gUFRSX0VSUihjcyk7Ci0KLQkJY3MgPSBnZW44X2VtaXRfcGlwZV9jb250cm9s
KGNzLCBmbGFncywgTFJDX1BQSFdTUF9TQ1JBVENIX0FERFIpOwotCQlpbnRlbF9yaW5nX2FkdmFu
Y2UocmVxdWVzdCwgY3MpOwotCX0KLQotCWlmIChtb2RlICYgRU1JVF9JTlZBTElEQVRFKSB7Ci0J
CXUzMiBmbGFncyA9IDA7Ci0JCXUzMiAqY3M7Ci0KLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0NP
TU1BTkRfQ0FDSEVfSU5WQUxJREFURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1RMQl9JTlZB
TElEQVRFOwotCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfSU5TVFJVQ1RJT05fQ0FDSEVfSU5WQUxJ
REFURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1RFWFRVUkVfQ0FDSEVfSU5WQUxJREFURTsK
LQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1ZGX0NBQ0hFX0lOVkFMSURBVEU7Ci0JCWZsYWdzIHw9
IFBJUEVfQ09OVFJPTF9DT05TVF9DQUNIRV9JTlZBTElEQVRFOwotCQlmbGFncyB8PSBQSVBFX0NP
TlRST0xfU1RBVEVfQ0FDSEVfSU5WQUxJREFURTsKLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX0wz
X1JPX0NBQ0hFX0lOVkFMSURBVEU7Ci0KLQkJZmxhZ3MgfD0gUElQRV9DT05UUk9MX1NUT1JFX0RB
VEFfSU5ERVg7Ci0JCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9RV19XUklURTsKLQotCQlmbGFncyB8
PSBQSVBFX0NPTlRST0xfQ1NfU1RBTEw7Ci0KLQkJY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJlcXVl
c3QsIDgpOwotCQlpZiAoSVNfRVJSKGNzKSkKLQkJCXJldHVybiBQVFJfRVJSKGNzKTsKLQotCQkv
KgotCQkgKiBQcmV2ZW50IHRoZSBwcmUtcGFyc2VyIGZyb20gc2tpcHBpbmcgcGFzdCB0aGUgVExC
Ci0JCSAqIGludmFsaWRhdGUgYW5kIGxvYWRpbmcgYSBzdGFsZSBwYWdlIGZvciB0aGUgYmF0Y2gK
LQkJICogYnVmZmVyIC8gcmVxdWVzdCBwYXlsb2FkLgotCQkgKi8KLQkJKmNzKysgPSBwcmVwYXJz
ZXJfZGlzYWJsZSh0cnVlKTsKLQotCQljcyA9IGdlbjhfZW1pdF9waXBlX2NvbnRyb2woY3MsIGZs
YWdzLCBMUkNfUFBIV1NQX1NDUkFUQ0hfQUREUik7Ci0KLQkJKmNzKysgPSBwcmVwYXJzZXJfZGlz
YWJsZShmYWxzZSk7Ci0JCWludGVsX3JpbmdfYWR2YW5jZShyZXF1ZXN0LCBjcyk7Ci0KLQkJLyoK
LQkJICogV2FfMTYwNDU0NDg4OTp0Z2wKLQkJICovCi0JCWlmIChJU19UR0xfUkVWSUQocmVxdWVz
dC0+aTkxNSwgVEdMX1JFVklEX0EwLCBUR0xfUkVWSURfQTApKSB7Ci0JCQlmbGFncyA9IDA7Ci0J
CQlmbGFncyB8PSBQSVBFX0NPTlRST0xfQ1NfU1RBTEw7Ci0JCQlmbGFncyB8PSBQSVBFX0NPTlRS
T0xfSERDX1BJUEVMSU5FX0ZMVVNIOwotCi0JCQlmbGFncyB8PSBQSVBFX0NPTlRST0xfU1RPUkVf
REFUQV9JTkRFWDsKLQkJCWZsYWdzIHw9IFBJUEVfQ09OVFJPTF9RV19XUklURTsKLQotCQkJY3Mg
PSBpbnRlbF9yaW5nX2JlZ2luKHJlcXVlc3QsIDYpOwotCQkJaWYgKElTX0VSUihjcykpCi0JCQkJ
cmV0dXJuIFBUUl9FUlIoY3MpOwotCi0JCQljcyA9IGdlbjhfZW1pdF9waXBlX2NvbnRyb2woY3Ms
IGZsYWdzLAotCQkJCQkJICAgIExSQ19QUEhXU1BfU0NSQVRDSF9BRERSKTsKLQkJCWludGVsX3Jp
bmdfYWR2YW5jZShyZXF1ZXN0LCBjcyk7Ci0JCX0KLQl9Ci0KLQlyZXR1cm4gMDsKLX0KLQogLyoK
ICAqIFJlc2VydmUgc3BhY2UgZm9yIDIgTk9PUHMgYXQgdGhlIGVuZCBvZiBlYWNoIHJlcXVlc3Qg
dG8gYmUKICAqIHVzZWQgYXMgYSB3b3JrYXJvdW5kIGZvciBub3QgYmVpbmcgYWxsb3dlZCB0byBk
byBsaXRlCkBAIC00Mjk0LDExICsyOTgxLDEwIEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19yZWxl
YXNlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAlleGVjbGlzdHNfc2h1dGRvd24o
ZW5naW5lKTsKIAogCWludGVsX2VuZ2luZV9jbGVhbnVwX2NvbW1vbihlbmdpbmUpOwotCWxyY19k
ZXN0cm95X3dhX2N0eChlbmdpbmUpOworCWludGVsX2VuZ2luZV9maW5pX3dvcmthcm91bmRfYmIo
ZW5naW5lKTsKIH0KIAotc3RhdGljIHZvaWQKLWxvZ2ljYWxfcmluZ19kZWZhdWx0X3ZmdW5jcyhz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCitzdGF0aWMgdm9pZCBleGVjbGlzdHNfZGVm
YXVsdF92ZnVuY3Moc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewogCS8qIERlZmF1
bHQgdmZ1bmNzIHdoaWNoIGNhbiBiZSBvdmVycmlkZW4gYnkgZWFjaCBlbmdpbmUuICovCiAKQEAg
LTQzMDcsNyArMjk5Myw3IEBAIGxvZ2ljYWxfcmluZ19kZWZhdWx0X3ZmdW5jcyhzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJZW5naW5lLT5jb3BzID0gJmV4ZWNsaXN0c19jb250ZXh0
X29wczsKIAllbmdpbmUtPnJlcXVlc3RfYWxsb2MgPSBleGVjbGlzdHNfcmVxdWVzdF9hbGxvYzsK
IAotCWVuZ2luZS0+ZW1pdF9mbHVzaCA9IGdlbjhfZW1pdF9mbHVzaDsKKwllbmdpbmUtPmVtaXRf
Zmx1c2ggPSBnZW44X2VtaXRfZmx1c2hfeGNzOwogCWVuZ2luZS0+ZW1pdF9pbml0X2JyZWFkY3J1
bWIgPSBnZW44X2VtaXRfaW5pdF9icmVhZGNydW1iOwogCWVuZ2luZS0+ZW1pdF9maW5pX2JyZWFk
Y3J1bWIgPSBnZW44X2VtaXRfZmluaV9icmVhZGNydW1iOwogCWlmIChJTlRFTF9HRU4oZW5naW5l
LT5pOTE1KSA+PSAxMikKQEAgLTQzMjgsOCArMzAxNCw3IEBAIGxvZ2ljYWxfcmluZ19kZWZhdWx0
X3ZmdW5jcyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJfQogfQogCi1zdGF0aWMg
aW5saW5lIHZvaWQKLWxvZ2ljYWxfcmluZ19kZWZhdWx0X2lycXMoc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lKQorc3RhdGljIGlubGluZSB2b2lkIGV4ZWNsaXN0c19kZWZhdWx0X2lycXMo
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewogCXVuc2lnbmVkIGludCBzaGlmdCA9
IDA7CiAKQEAgLTQzNTUsMTUgKzMwNDAsMTkgQEAgc3RhdGljIHZvaWQgcmNzX3N1Ym1pc3Npb25f
b3ZlcnJpZGUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewogCXN3aXRjaCAoSU5U
RUxfR0VOKGVuZ2luZS0+aTkxNSkpIHsKIAljYXNlIDEyOgotCQllbmdpbmUtPmVtaXRfZmx1c2gg
PSBnZW4xMl9lbWl0X2ZsdXNoX3JlbmRlcjsKKwkJZW5naW5lLT5lbWl0X2ZsdXNoID0gZ2VuMTJf
ZW1pdF9mbHVzaF9yY3M7CiAJCWVuZ2luZS0+ZW1pdF9maW5pX2JyZWFkY3J1bWIgPSBnZW4xMl9l
bWl0X2ZpbmlfYnJlYWRjcnVtYl9yY3M7CiAJCWJyZWFrOwogCWNhc2UgMTE6Ci0JCWVuZ2luZS0+
ZW1pdF9mbHVzaCA9IGdlbjExX2VtaXRfZmx1c2hfcmVuZGVyOworCQllbmdpbmUtPmVtaXRfZmx1
c2ggPSBnZW4xMV9lbWl0X2ZsdXNoX3JjczsKIAkJZW5naW5lLT5lbWl0X2ZpbmlfYnJlYWRjcnVt
YiA9IGdlbjExX2VtaXRfZmluaV9icmVhZGNydW1iX3JjczsKIAkJYnJlYWs7CisJY2FzZSA5Ogor
CQllbmdpbmUtPmVtaXRfZmx1c2ggPSBnZW45X2VtaXRfZmx1c2hfcmNzOworCQllbmdpbmUtPmVt
aXRfZmluaV9icmVhZGNydW1iID0gZ2VuOF9lbWl0X2ZpbmlfYnJlYWRjcnVtYl9yY3M7CisJCWJy
ZWFrOwogCWRlZmF1bHQ6Ci0JCWVuZ2luZS0+ZW1pdF9mbHVzaCA9IGdlbjhfZW1pdF9mbHVzaF9y
ZW5kZXI7CisJCWVuZ2luZS0+ZW1pdF9mbHVzaCA9IGdlbjhfZW1pdF9mbHVzaF9yY3M7CiAJCWVu
Z2luZS0+ZW1pdF9maW5pX2JyZWFkY3J1bWIgPSBnZW44X2VtaXRfZmluaV9icmVhZGNydW1iX3Jj
czsKIAkJYnJlYWs7CiAJfQpAQCAtNDM4MSwxMyArMzA3MCwxMyBAQCBpbnQgaW50ZWxfZXhlY2xp
c3RzX3N1Ym1pc3Npb25fc2V0dXAoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCXRp
bWVyX3NldHVwKCZlbmdpbmUtPmV4ZWNsaXN0cy50aW1lciwgZXhlY2xpc3RzX3RpbWVzbGljZSwg
MCk7CiAJdGltZXJfc2V0dXAoJmVuZ2luZS0+ZXhlY2xpc3RzLnByZWVtcHQsIGV4ZWNsaXN0c19w
cmVlbXB0LCAwKTsKIAotCWxvZ2ljYWxfcmluZ19kZWZhdWx0X3ZmdW5jcyhlbmdpbmUpOwotCWxv
Z2ljYWxfcmluZ19kZWZhdWx0X2lycXMoZW5naW5lKTsKKwlleGVjbGlzdHNfZGVmYXVsdF92ZnVu
Y3MoZW5naW5lKTsKKwlleGVjbGlzdHNfZGVmYXVsdF9pcnFzKGVuZ2luZSk7CiAKIAlpZiAoZW5n
aW5lLT5jbGFzcyA9PSBSRU5ERVJfQ0xBU1MpCiAJCXJjc19zdWJtaXNzaW9uX292ZXJyaWRlKGVu
Z2luZSk7CiAKLQlpZiAoaW50ZWxfaW5pdF93b3JrYXJvdW5kX2JiKGVuZ2luZSkpCisJaWYgKGlu
dGVsX2VuZ2luZV9pbml0X3dvcmthcm91bmRfYmIoZW5naW5lKSkKIAkJLyoKIAkJICogV2UgY29u
dGludWUgZXZlbiBpZiB3ZSBmYWlsIHRvIGluaXRpYWxpemUgV0EgYmF0Y2gKIAkJICogYmVjYXVz
ZSB3ZSBvbmx5IGV4cGVjdCByYXJlIGdsaXRjaGVzIGJ1dCBub3RoaW5nCkBAIC00NDI0LDEzNyAr
MzExMyw2IEBAIGludCBpbnRlbF9leGVjbGlzdHNfc3VibWlzc2lvbl9zZXR1cChzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyB1MzIgaW50ZWxf
bHJfaW5kaXJlY3RfY3R4X29mZnNldChjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpCi17Ci0JdTMyIGluZGlyZWN0X2N0eF9vZmZzZXQ7Ci0KLQlzd2l0Y2ggKElOVEVMX0dFTihl
bmdpbmUtPmk5MTUpKSB7Ci0JZGVmYXVsdDoKLQkJTUlTU0lOR19DQVNFKElOVEVMX0dFTihlbmdp
bmUtPmk5MTUpKTsKLQkJLyogZmFsbCB0aHJvdWdoICovCi0JY2FzZSAxMjoKLQkJaW5kaXJlY3Rf
Y3R4X29mZnNldCA9Ci0JCQlHRU4xMl9DVFhfUkNTX0lORElSRUNUX0NUWF9PRkZTRVRfREVGQVVM
VDsKLQkJYnJlYWs7Ci0JY2FzZSAxMToKLQkJaW5kaXJlY3RfY3R4X29mZnNldCA9Ci0JCQlHRU4x
MV9DVFhfUkNTX0lORElSRUNUX0NUWF9PRkZTRVRfREVGQVVMVDsKLQkJYnJlYWs7Ci0JY2FzZSAx
MDoKLQkJaW5kaXJlY3RfY3R4X29mZnNldCA9Ci0JCQlHRU4xMF9DVFhfUkNTX0lORElSRUNUX0NU
WF9PRkZTRVRfREVGQVVMVDsKLQkJYnJlYWs7Ci0JY2FzZSA5OgotCQlpbmRpcmVjdF9jdHhfb2Zm
c2V0ID0KLQkJCUdFTjlfQ1RYX1JDU19JTkRJUkVDVF9DVFhfT0ZGU0VUX0RFRkFVTFQ7Ci0JCWJy
ZWFrOwotCWNhc2UgODoKLQkJaW5kaXJlY3RfY3R4X29mZnNldCA9Ci0JCQlHRU44X0NUWF9SQ1Nf
SU5ESVJFQ1RfQ1RYX09GRlNFVF9ERUZBVUxUOwotCQlicmVhazsKLQl9Ci0KLQlyZXR1cm4gaW5k
aXJlY3RfY3R4X29mZnNldDsKLX0KLQotCi1zdGF0aWMgdm9pZCBpbml0X2NvbW1vbl9yZWdfc3Rh
dGUodTMyICogY29uc3QgcmVncywKLQkJCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSwKLQkJCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9yaW5nICpyaW5nLAotCQkJCSAgYm9v
bCBpbmhpYml0KQotewotCXUzMiBjdGw7Ci0KLQljdGwgPSBfTUFTS0VEX0JJVF9FTkFCTEUoQ1RY
X0NUUkxfSU5ISUJJVF9TWU5fQ1RYX1NXSVRDSCk7Ci0JY3RsIHw9IF9NQVNLRURfQklUX0RJU0FC
TEUoQ1RYX0NUUkxfRU5HSU5FX0NUWF9SRVNUT1JFX0lOSElCSVQpOwotCWlmIChpbmhpYml0KQot
CQljdGwgfD0gQ1RYX0NUUkxfRU5HSU5FX0NUWF9SRVNUT1JFX0lOSElCSVQ7Ci0JaWYgKElOVEVM
X0dFTihlbmdpbmUtPmk5MTUpIDwgMTEpCi0JCWN0bCB8PSBfTUFTS0VEX0JJVF9ESVNBQkxFKENU
WF9DVFJMX0VOR0lORV9DVFhfU0FWRV9JTkhJQklUIHwKLQkJCQkJICAgQ1RYX0NUUkxfUlNfQ1RY
X0VOQUJMRSk7Ci0JcmVnc1tDVFhfQ09OVEVYVF9DT05UUk9MXSA9IGN0bDsKLQotCXJlZ3NbQ1RY
X1JJTkdfQ1RMXSA9IFJJTkdfQ1RMX1NJWkUocmluZy0+c2l6ZSkgfCBSSU5HX1ZBTElEOwotfQot
Ci1zdGF0aWMgdm9pZCBpbml0X3dhX2JiX3JlZ19zdGF0ZSh1MzIgKiBjb25zdCByZWdzLAotCQkJ
CSBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCi0JCQkJIHUzMiBwb3NfYmJf
cGVyX2N0eCkKLXsKLQljb25zdCBzdHJ1Y3QgaTkxNV9jdHhfd29ya2Fyb3VuZHMgKiBjb25zdCB3
YV9jdHggPSAmZW5naW5lLT53YV9jdHg7Ci0KLQlpZiAod2FfY3R4LT5wZXJfY3R4LnNpemUpIHsK
LQkJY29uc3QgdTMyIGdndHRfb2Zmc2V0ID0gaTkxNV9nZ3R0X29mZnNldCh3YV9jdHgtPnZtYSk7
Ci0KLQkJcmVnc1twb3NfYmJfcGVyX2N0eF0gPQotCQkJKGdndHRfb2Zmc2V0ICsgd2FfY3R4LT5w
ZXJfY3R4Lm9mZnNldCkgfCAweDAxOwotCX0KLQotCWlmICh3YV9jdHgtPmluZGlyZWN0X2N0eC5z
aXplKSB7Ci0JCWNvbnN0IHUzMiBnZ3R0X29mZnNldCA9IGk5MTVfZ2d0dF9vZmZzZXQod2FfY3R4
LT52bWEpOwotCi0JCXJlZ3NbcG9zX2JiX3Blcl9jdHggKyAyXSA9Ci0JCQkoZ2d0dF9vZmZzZXQg
KyB3YV9jdHgtPmluZGlyZWN0X2N0eC5vZmZzZXQpIHwKLQkJCSh3YV9jdHgtPmluZGlyZWN0X2N0
eC5zaXplIC8gQ0FDSEVMSU5FX0JZVEVTKTsKLQotCQlyZWdzW3Bvc19iYl9wZXJfY3R4ICsgNF0g
PQotCQkJaW50ZWxfbHJfaW5kaXJlY3RfY3R4X29mZnNldChlbmdpbmUpIDw8IDY7Ci0JfQotfQot
Ci1zdGF0aWMgdm9pZCBpbml0X3BwZ3R0X3JlZ19zdGF0ZSh1MzIgKnJlZ3MsIGNvbnN0IHN0cnVj
dCBpOTE1X3BwZ3R0ICpwcGd0dCkKLXsKLQlpZiAoaTkxNV92bV9pc180bHZsKCZwcGd0dC0+dm0p
KSB7Ci0JCS8qIDY0YiBQUEdUVCAoNDhiaXQgY2Fub25pY2FsKQotCQkgKiBQRFAwX0RFU0NSSVBU
T1IgY29udGFpbnMgdGhlIGJhc2UgYWRkcmVzcyB0byBQTUw0IGFuZAotCQkgKiBvdGhlciBQRFAg
RGVzY3JpcHRvcnMgYXJlIGlnbm9yZWQuCi0JCSAqLwotCQlBU1NJR05fQ1RYX1BNTDQocHBndHQs
IHJlZ3MpOwotCX0gZWxzZSB7Ci0JCUFTU0lHTl9DVFhfUERQKHBwZ3R0LCByZWdzLCAzKTsKLQkJ
QVNTSUdOX0NUWF9QRFAocHBndHQsIHJlZ3MsIDIpOwotCQlBU1NJR05fQ1RYX1BEUChwcGd0dCwg
cmVncywgMSk7Ci0JCUFTU0lHTl9DVFhfUERQKHBwZ3R0LCByZWdzLCAwKTsKLQl9Ci19Ci0KLXN0
YXRpYyBzdHJ1Y3QgaTkxNV9wcGd0dCAqdm1fYWxpYXMoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFj
ZSAqdm0pCi17Ci0JaWYgKGk5MTVfaXNfZ2d0dCh2bSkpCi0JCXJldHVybiBpOTE1X3ZtX3RvX2dn
dHQodm0pLT5hbGlhczsKLQllbHNlCi0JCXJldHVybiBpOTE1X3ZtX3RvX3BwZ3R0KHZtKTsKLX0K
LQotc3RhdGljIHZvaWQgZXhlY2xpc3RzX2luaXRfcmVnX3N0YXRlKHUzMiAqcmVncywKLQkJCQkg
ICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKLQkJCQkgICAgIGNvbnN0IHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCQkgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9y
aW5nICpyaW5nLAotCQkJCSAgICAgYm9vbCBpbmhpYml0KQotewotCS8qCi0JICogQSBjb250ZXh0
IGlzIGFjdHVhbGx5IGEgYmlnIGJhdGNoIGJ1ZmZlciB3aXRoIHNldmVyYWwKLQkgKiBNSV9MT0FE
X1JFR0lTVEVSX0lNTSBjb21tYW5kcyBmb2xsb3dlZCBieSAocmVnLCB2YWx1ZSkgcGFpcnMuIFRo
ZQotCSAqIHZhbHVlcyB3ZSBhcmUgc2V0dGluZyBoZXJlIGFyZSBvbmx5IGZvciB0aGUgZmlyc3Qg
Y29udGV4dCByZXN0b3JlOgotCSAqIG9uIGEgc3Vic2VxdWVudCBzYXZlLCB0aGUgR1BVIHdpbGwg
cmVjcmVhdGUgdGhpcyBiYXRjaGJ1ZmZlciB3aXRoIG5ldwotCSAqIHZhbHVlcyAoaW5jbHVkaW5n
IGFsbCB0aGUgbWlzc2luZyBNSV9MT0FEX1JFR0lTVEVSX0lNTSBjb21tYW5kcyB0aGF0Ci0JICog
d2UgYXJlIG5vdCBpbml0aWFsaXppbmcgaGVyZSkuCi0JICoKLQkgKiBNdXN0IGtlZXAgY29uc2lz
dGVudCB3aXRoIHZpcnR1YWxfdXBkYXRlX3JlZ2lzdGVyX29mZnNldHMoKS4KLQkgKi8KLQlzZXRf
b2Zmc2V0cyhyZWdzLCByZWdfb2Zmc2V0cyhlbmdpbmUpLCBlbmdpbmUsIGluaGliaXQpOwotCi0J
aW5pdF9jb21tb25fcmVnX3N0YXRlKHJlZ3MsIGVuZ2luZSwgcmluZywgaW5oaWJpdCk7Ci0JaW5p
dF9wcGd0dF9yZWdfc3RhdGUocmVncywgdm1fYWxpYXMoY2UtPnZtKSk7Ci0KLQlpbml0X3dhX2Ji
X3JlZ19zdGF0ZShyZWdzLCBlbmdpbmUsCi0JCQkgICAgIElOVEVMX0dFTihlbmdpbmUtPmk5MTUp
ID49IDEyID8KLQkJCSAgICAgR0VOMTJfQ1RYX0JCX1BFUl9DVFhfUFRSIDoKLQkJCSAgICAgQ1RY
X0JCX1BFUl9DVFhfUFRSKTsKLQotCV9fcmVzZXRfc3RvcF9yaW5nKHJlZ3MsIGVuZ2luZSk7Ci19
Ci0KIHN0YXRpYyBpbnQKIHBvcHVsYXRlX2xyX2NvbnRleHQoc3RydWN0IGludGVsX2NvbnRleHQg
KmNlLAogCQkgICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKmN0eF9vYmosCkBAIC00NTky
LDcgKzMxNTAsNyBAQCBwb3B1bGF0ZV9scl9jb250ZXh0KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpj
ZSwKIAogCS8qIFRoZSBzZWNvbmQgcGFnZSBvZiB0aGUgY29udGV4dCBvYmplY3QgY29udGFpbnMg
c29tZSBmaWVsZHMgd2hpY2ggbXVzdAogCSAqIGJlIHNldCB1cCBwcmlvciB0byB0aGUgZmlyc3Qg
ZXhlY3V0aW9uLiAqLwotCWV4ZWNsaXN0c19pbml0X3JlZ19zdGF0ZSh2YWRkciArIExSQ19TVEFU
RV9QTiAqIFBBR0VfU0laRSwKKwlpbnRlbF9scmNfaW5pdF9yZWdfc3RhdGUodmFkZHIgKyBMUkNf
U1RBVEVfUE4gKiBQQUdFX1NJWkUsCiAJCQkJIGNlLCBlbmdpbmUsIHJpbmcsIGluaGliaXQpOwog
CiAJcmV0ID0gMDsKQEAgLTUyNjAsMzEgKzM4MTgsNiBAQCB2b2lkIGludGVsX2V4ZWNsaXN0c19z
aG93X3JlcXVlc3RzKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAlzcGluX3VubG9j
a19pcnFyZXN0b3JlKCZlbmdpbmUtPmFjdGl2ZS5sb2NrLCBmbGFncyk7CiB9CiAKLXZvaWQgaW50
ZWxfbHJfY29udGV4dF9yZXNldChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCi0JCQkg
ICAgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAotCQkJICAgIHUzMiBoZWFkLAotCQkJICAgIGJv
b2wgc2NydWIpCi17Ci0JR0VNX0JVR19PTighaW50ZWxfY29udGV4dF9pc19waW5uZWQoY2UpKTsK
LQotCS8qCi0JICogV2Ugd2FudCBhIHNpbXBsZSBjb250ZXh0ICsgcmluZyB0byBleGVjdXRlIHRo
ZSBicmVhZGNydW1iIHVwZGF0ZS4KLQkgKiBXZSBjYW5ub3QgcmVseSBvbiB0aGUgY29udGV4dCBi
ZWluZyBpbnRhY3QgYWNyb3NzIHRoZSBHUFUgaGFuZywKLQkgKiBzbyBjbGVhciBpdCBhbmQgcmVi
dWlsZCBqdXN0IHdoYXQgd2UgbmVlZCBmb3IgdGhlIGJyZWFkY3J1bWIuCi0JICogQWxsIHBlbmRp
bmcgcmVxdWVzdHMgZm9yIHRoaXMgY29udGV4dCB3aWxsIGJlIHphcHBlZCwgYW5kIGFueQotCSAq
IGZ1dHVyZSByZXF1ZXN0IHdpbGwgYmUgYWZ0ZXIgdXNlcnNwYWNlIGhhcyBoYWQgdGhlIG9wcG9y
dHVuaXR5Ci0JICogdG8gcmVjcmVhdGUgaXRzIG93biBzdGF0ZS4KLQkgKi8KLQlpZiAoc2NydWIp
Ci0JCXJlc3RvcmVfZGVmYXVsdF9zdGF0ZShjZSwgZW5naW5lKTsKLQotCS8qIFJlcnVuIHRoZSBy
ZXF1ZXN0OyBpdHMgcGF5bG9hZCBoYXMgYmVlbiBuZXV0ZXJlZCAoaWYgZ3VpbHR5KS4gKi8KLQlj
ZS0+cmluZy0+aGVhZCA9IGhlYWQ7Ci0JaW50ZWxfcmluZ191cGRhdGVfc3BhY2UoY2UtPnJpbmcp
OwotCi0JX19leGVjbGlzdHNfdXBkYXRlX3JlZ19zdGF0ZShjZSwgZW5naW5lKTsKLX0KLQogYm9v
bAogaW50ZWxfZW5naW5lX2luX2V4ZWNsaXN0c19zdWJtaXNzaW9uX21vZGUoY29uc3Qgc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfZXhlY2xpc3RzX3N1Ym1pc3Npb24uaCBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uLmgKaW5kZXggZDBhNDhlNDczMDA3Li5k
YTdkOWFiZjlkNjUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2V4
ZWNsaXN0c19zdWJtaXNzaW9uLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
ZXhlY2xpc3RzX3N1Ym1pc3Npb24uaApAQCAtMTYsMjQgKzE2LDggQEAgc3RydWN0IGludGVsX2Vu
Z2luZV9jczsKIAogaW50IGludGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uX3NldHVwKHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7CiAKLS8qIExvZ2ljYWwgUmluZyBDb250ZXh0cyAqLwot
LyogQXQgdGhlIHN0YXJ0IG9mIHRoZSBjb250ZXh0IGltYWdlIGlzIGl0cyBwZXItcHJvY2VzcyBI
V1MgcGFnZSAqLwotI2RlZmluZSBMUkNfUFBIV1NQX1BOCSgwKQotI2RlZmluZSBMUkNfUFBIV1NQ
X1NaCSgxKQotLyogQWZ0ZXIgdGhlIFBQSFdTUCB3ZSBoYXZlIHRoZSBsb2dpY2FsIHN0YXRlIGZv
ciB0aGUgY29udGV4dCAqLwotI2RlZmluZSBMUkNfU1RBVEVfUE4JKExSQ19QUEhXU1BfUE4gKyBM
UkNfUFBIV1NQX1NaKQotCi0vKiBTcGFjZSB3aXRoaW4gUFBIV1NQIHJlc2VydmVkIHRvIGJlIHVz
ZWQgYXMgc2NyYXRjaCAqLwotI2RlZmluZSBMUkNfUFBIV1NQX1NDUkFUQ0gJCTB4MzQKLSNkZWZp
bmUgTFJDX1BQSFdTUF9TQ1JBVENIX0FERFIJCShMUkNfUFBIV1NQX1NDUkFUQ0ggKiBzaXplb2Yo
dTMyKSkKLQogdm9pZCBpbnRlbF9leGVjbGlzdHNfc2V0X2RlZmF1bHRfc3VibWlzc2lvbihzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpOwogCi12b2lkIGludGVsX2xyX2NvbnRleHRfcmVz
ZXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAotCQkJICAgIHN0cnVjdCBpbnRlbF9j
b250ZXh0ICpjZSwKLQkJCSAgICB1MzIgaGVhZCwKLQkJCSAgICBib29sIHNjcnViKTsKLQogdm9p
ZCBpbnRlbF9leGVjbGlzdHNfc2hvd19yZXF1ZXN0cyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUsCiAJCQkJICAgc3RydWN0IGRybV9wcmludGVyICptLAogCQkJCSAgIHZvaWQgKCpzaG93
X3JlcXVlc3QpKHN0cnVjdCBkcm1fcHJpbnRlciAqbSwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
bHJjLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5mYTEyZDcxYTE5
OWUKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMu
YwpAQCAtMCwwICsxLDgzMCBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAorLyoK
KyAqIENvcHlyaWdodCDCqSAyMDE0IEludGVsIENvcnBvcmF0aW9uCisgKi8KKworLyoqCisgKiBE
T0M6IExvZ2ljYWwgUmluZ3MsIExvZ2ljYWwgUmluZyBDb250ZXh0cyBhbmQgRXhlY2xpc3RzCisg
KgorICogTW90aXZhdGlvbjoKKyAqIEdFTjggYnJpbmdzIGFuIGV4cGFuc2lvbiBvZiB0aGUgSFcg
Y29udGV4dHM6ICJMb2dpY2FsIFJpbmcgQ29udGV4dHMiLgorICogVGhlc2UgZXhwYW5kZWQgY29u
dGV4dHMgZW5hYmxlIGEgbnVtYmVyIG9mIG5ldyBhYmlsaXRpZXMsIGVzcGVjaWFsbHkKKyAqICJF
eGVjbGlzdHMiIChhbHNvIGltcGxlbWVudGVkIGluIHRoaXMgZmlsZSkuCisgKgorICogT25lIG9m
IHRoZSBtYWluIGRpZmZlcmVuY2VzIHdpdGggdGhlIGxlZ2FjeSBIVyBjb250ZXh0cyBpcyB0aGF0
IGxvZ2ljYWwKKyAqIHJpbmcgY29udGV4dHMgaW5jb3Jwb3JhdGUgbWFueSBtb3JlIHRoaW5ncyB0
byB0aGUgY29udGV4dCdzIHN0YXRlLCBsaWtlCisgKiBQRFBzIG9yIHJpbmdidWZmZXIgY29udHJv
bCByZWdpc3RlcnM6CisgKgorICogVGhlIHJlYXNvbiB3aHkgUERQcyBhcmUgaW5jbHVkZWQgaW4g
dGhlIGNvbnRleHQgaXMgc3RyYWlnaHRmb3J3YXJkOiBhcworICogUFBHVFRzIChwZXItcHJvY2Vz
cyBHVFRzKSBhcmUgYWN0dWFsbHkgcGVyLWNvbnRleHQsIGhhdmluZyB0aGUgUERQcworICogY29u
dGFpbmVkIHRoZXJlIG1lYW4geW91IGRvbid0IG5lZWQgdG8gZG8gYSBwcGd0dC0+c3dpdGNoX21t
IHlvdXJzZWxmLAorICogaW5zdGVhZCwgdGhlIEdQVSB3aWxsIGRvIGl0IGZvciB5b3Ugb24gdGhl
IGNvbnRleHQgc3dpdGNoLgorICoKKyAqIEJ1dCwgd2hhdCBhYm91dCB0aGUgcmluZ2J1ZmZlciBj
b250cm9sIHJlZ2lzdGVycyAoaGVhZCwgdGFpbCwgZXRjLi4pPworICogc2hvdWxkbid0IHdlIGp1
c3QgbmVlZCBhIHNldCBvZiB0aG9zZSBwZXIgZW5naW5lIGNvbW1hbmQgc3RyZWFtZXI/IFRoaXMg
aXMKKyAqIHdoZXJlIHRoZSBuYW1lICJMb2dpY2FsIFJpbmdzIiBzdGFydHMgdG8gbWFrZSBzZW5z
ZTogYnkgdmlydHVhbGl6aW5nIHRoZQorICogcmluZ3MsIHRoZSBlbmdpbmUgY3Mgc2hpZnRzIHRv
IGEgbmV3ICJyaW5nIGJ1ZmZlciIgd2l0aCBldmVyeSBjb250ZXh0CisgKiBzd2l0Y2guIFdoZW4g
eW91IHdhbnQgdG8gc3VibWl0IGEgd29ya2xvYWQgdG8gdGhlIEdQVSB5b3U6IEEpIGNob29zZSB5
b3VyCisgKiBjb250ZXh0LCBCKSBmaW5kIGl0cyBhcHByb3ByaWF0ZSB2aXJ0dWFsaXplZCByaW5n
LCBDKSB3cml0ZSBjb21tYW5kcyB0byBpdAorICogYW5kIHRoZW4sIGZpbmFsbHksIEQpIHRlbGwg
dGhlIEdQVSB0byBzd2l0Y2ggdG8gdGhhdCBjb250ZXh0LgorICoKKyAqIEluc3RlYWQgb2YgdGhl
IGxlZ2FjeSBNSV9TRVRfQ09OVEVYVCwgdGhlIHdheSB5b3UgdGVsbCB0aGUgR1BVIHRvIHN3aXRj
aAorICogdG8gYSBjb250ZXh0cyBpcyB2aWEgYSBjb250ZXh0IGV4ZWN1dGlvbiBsaXN0LCBlcmdv
ICJFeGVjbGlzdHMiLgorICoKKyAqIExSQyBpbXBsZW1lbnRhdGlvbjoKKyAqIFJlZ2FyZGluZyB0
aGUgY3JlYXRpb24gb2YgY29udGV4dHMsIHdlIGhhdmU6CisgKgorICogLSBPbmUgZ2xvYmFsIGRl
ZmF1bHQgY29udGV4dC4KKyAqIC0gT25lIGxvY2FsIGRlZmF1bHQgY29udGV4dCBmb3IgZWFjaCBv
cGVuZWQgZmQuCisgKiAtIE9uZSBsb2NhbCBleHRyYSBjb250ZXh0IGZvciBlYWNoIGNvbnRleHQg
Y3JlYXRlIGlvY3RsIGNhbGwuCisgKgorICogTm93IHRoYXQgcmluZ2J1ZmZlcnMgYmVsb25nIHBl
ci1jb250ZXh0IChhbmQgbm90IHBlci1lbmdpbmUsIGxpa2UgYmVmb3JlKQorICogYW5kIHRoYXQg
Y29udGV4dHMgYXJlIHVuaXF1ZWx5IHRpZWQgdG8gYSBnaXZlbiBlbmdpbmUgKGFuZCBub3QgcmV1
c2FibGUsCisgKiBsaWtlIGJlZm9yZSkgd2UgbmVlZDoKKyAqCisgKiAtIE9uZSByaW5nYnVmZmVy
IHBlci1lbmdpbmUgaW5zaWRlIGVhY2ggY29udGV4dC4KKyAqIC0gT25lIGJhY2tpbmcgb2JqZWN0
IHBlci1lbmdpbmUgaW5zaWRlIGVhY2ggY29udGV4dC4KKyAqCisgKiBUaGUgZ2xvYmFsIGRlZmF1
bHQgY29udGV4dCBzdGFydHMgaXRzIGxpZmUgd2l0aCB0aGVzZSBuZXcgb2JqZWN0cyBmdWxseQor
ICogYWxsb2NhdGVkIGFuZCBwb3B1bGF0ZWQuIFRoZSBsb2NhbCBkZWZhdWx0IGNvbnRleHQgZm9y
IGVhY2ggb3BlbmVkIGZkIGlzCisgKiBtb3JlIGNvbXBsZXgsIGJlY2F1c2Ugd2UgZG9uJ3Qga25v
dyBhdCBjcmVhdGlvbiB0aW1lIHdoaWNoIGVuZ2luZSBpcyBnb2luZworICogdG8gdXNlIHRoZW0u
IFRvIGhhbmRsZSB0aGlzLCB3ZSBoYXZlIGltcGxlbWVudGVkIGEgZGVmZXJyZWQgY3JlYXRpb24g
b2YgTFIKKyAqIGNvbnRleHRzOgorICoKKyAqIFRoZSBsb2NhbCBjb250ZXh0IHN0YXJ0cyBpdHMg
bGlmZSBhcyBhIGhvbGxvdyBvciBibGFuayBob2xkZXIsIHRoYXQgb25seQorICogZ2V0cyBwb3B1
bGF0ZWQgZm9yIGEgZ2l2ZW4gZW5naW5lIG9uY2Ugd2UgcmVjZWl2ZSBhbiBleGVjYnVmZmVyLiBJ
ZiBsYXRlcgorICogb24gd2UgcmVjZWl2ZSBhbm90aGVyIGV4ZWNidWZmZXIgaW9jdGwgZm9yIHRo
ZSBzYW1lIGNvbnRleHQgYnV0IGEgZGlmZmVyZW50CisgKiBlbmdpbmUsIHdlIGFsbG9jYXRlL3Bv
cHVsYXRlIGEgbmV3IHJpbmdidWZmZXIgYW5kIGNvbnRleHQgYmFja2luZyBvYmplY3QgYW5kCisg
KiBzbyBvbi4KKyAqCisgKiBGaW5hbGx5LCByZWdhcmRpbmcgbG9jYWwgY29udGV4dHMgY3JlYXRl
ZCB1c2luZyB0aGUgaW9jdGwgY2FsbDogYXMgdGhleSBhcmUKKyAqIG9ubHkgYWxsb3dlZCB3aXRo
IHRoZSByZW5kZXIgcmluZywgd2UgY2FuIGFsbG9jYXRlICYgcG9wdWxhdGUgdGhlbSByaWdodAor
ICogYXdheSAobm8gbmVlZCB0byBkZWZlciBhbnl0aGluZywgYXQgbGVhc3QgZm9yIG5vdykuCisg
KgorICogRXhlY2xpc3RzIGltcGxlbWVudGF0aW9uOgorICogRXhlY2xpc3RzIGFyZSB0aGUgbmV3
IG1ldGhvZCBieSB3aGljaCwgb24gZ2VuOCsgaGFyZHdhcmUsIHdvcmtsb2FkcyBhcmUKKyAqIHN1
Ym1pdHRlZCBmb3IgZXhlY3V0aW9uIChhcyBvcHBvc2VkIHRvIHRoZSBsZWdhY3ksIHJpbmdidWZm
ZXItYmFzZWQsIG1ldGhvZCkuCisgKiBUaGlzIG1ldGhvZCB3b3JrcyBhcyBmb2xsb3dzOgorICoK
KyAqIFdoZW4gYSByZXF1ZXN0IGlzIGNvbW1pdHRlZCwgaXRzIGNvbW1hbmRzICh0aGUgQkIgc3Rh
cnQgYW5kIGFueSBsZWFkaW5nIG9yCisgKiB0cmFpbGluZyBjb21tYW5kcywgbGlrZSB0aGUgc2Vx
bm8gYnJlYWRjcnVtYnMpIGFyZSBwbGFjZWQgaW4gdGhlIHJpbmdidWZmZXIKKyAqIGZvciB0aGUg
YXBwcm9wcmlhdGUgY29udGV4dC4gVGhlIHRhaWwgcG9pbnRlciBpbiB0aGUgaGFyZHdhcmUgY29u
dGV4dCBpcyBub3QKKyAqIHVwZGF0ZWQgYXQgdGhpcyB0aW1lLCBidXQgaW5zdGVhZCwga2VwdCBi
eSB0aGUgZHJpdmVyIGluIHRoZSByaW5nYnVmZmVyCisgKiBzdHJ1Y3R1cmUuIEEgc3RydWN0dXJl
IHJlcHJlc2VudGluZyB0aGlzIHJlcXVlc3QgaXMgYWRkZWQgdG8gYSByZXF1ZXN0IHF1ZXVlCisg
KiBmb3IgdGhlIGFwcHJvcHJpYXRlIGVuZ2luZTogdGhpcyBzdHJ1Y3R1cmUgY29udGFpbnMgYSBj
b3B5IG9mIHRoZSBjb250ZXh0J3MKKyAqIHRhaWwgYWZ0ZXIgdGhlIHJlcXVlc3Qgd2FzIHdyaXR0
ZW4gdG8gdGhlIHJpbmcgYnVmZmVyIGFuZCBhIHBvaW50ZXIgdG8gdGhlCisgKiBjb250ZXh0IGl0
c2VsZi4KKyAqCisgKiBJZiB0aGUgZW5naW5lJ3MgcmVxdWVzdCBxdWV1ZSB3YXMgZW1wdHkgYmVm
b3JlIHRoZSByZXF1ZXN0IHdhcyBhZGRlZCwgdGhlCisgKiBxdWV1ZSBpcyBwcm9jZXNzZWQgaW1t
ZWRpYXRlbHkuIE90aGVyd2lzZSB0aGUgcXVldWUgd2lsbCBiZSBwcm9jZXNzZWQgZHVyaW5nCisg
KiBhIGNvbnRleHQgc3dpdGNoIGludGVycnVwdC4gSW4gYW55IGNhc2UsIGVsZW1lbnRzIG9uIHRo
ZSBxdWV1ZSB3aWxsIGdldCBzZW50CisgKiAoaW4gcGFpcnMpIHRvIHRoZSBHUFUncyBFeGVjTGlz
dHMgU3VibWl0IFBvcnQgKEVMU1AsIGZvciBzaG9ydCkgd2l0aCBhCisgKiBnbG9iYWxseSB1bmlx
dWUgMjAtYml0cyBzdWJtaXNzaW9uIElELgorICoKKyAqIFdoZW4gZXhlY3V0aW9uIG9mIGEgcmVx
dWVzdCBjb21wbGV0ZXMsIHRoZSBHUFUgdXBkYXRlcyB0aGUgY29udGV4dCBzdGF0dXMKKyAqIGJ1
ZmZlciB3aXRoIGEgY29udGV4dCBjb21wbGV0ZSBldmVudCBhbmQgZ2VuZXJhdGVzIGEgY29udGV4
dCBzd2l0Y2gKKyAqIGludGVycnVwdC4gRHVyaW5nIHRoZSBpbnRlcnJ1cHQgaGFuZGxpbmcsIHRo
ZSBkcml2ZXIgZXhhbWluZXMgdGhlIGV2ZW50cyBpbgorICogdGhlIGJ1ZmZlcjogZm9yIGVhY2gg
Y29udGV4dCBjb21wbGV0ZSBldmVudCwgaWYgdGhlIGFubm91bmNlZCBJRCBtYXRjaGVzCisgKiB0
aGF0IG9uIHRoZSBoZWFkIG9mIHRoZSByZXF1ZXN0IHF1ZXVlLCB0aGVuIHRoYXQgcmVxdWVzdCBp
cyByZXRpcmVkIGFuZAorICogcmVtb3ZlZCBmcm9tIHRoZSBxdWV1ZS4KKyAqCisgKiBBZnRlciBw
cm9jZXNzaW5nLCBpZiBhbnkgcmVxdWVzdHMgd2VyZSByZXRpcmVkIGFuZCB0aGUgcXVldWUgaXMg
bm90IGVtcHR5CisgKiB0aGVuIGEgbmV3IGV4ZWN1dGlvbiBsaXN0IGNhbiBiZSBzdWJtaXR0ZWQu
IFRoZSB0d28gcmVxdWVzdHMgYXQgdGhlIGZyb250IG9mCisgKiB0aGUgcXVldWUgYXJlIG5leHQg
dG8gYmUgc3VibWl0dGVkIGJ1dCBzaW5jZSBhIGNvbnRleHQgbWF5IG5vdCBvY2N1ciB0d2ljZQor
ICogaW4gYW4gZXhlY3V0aW9uIGxpc3QsIGlmIHN1YnNlcXVlbnQgcmVxdWVzdHMgaGF2ZSB0aGUg
c2FtZSBJRCBhcyB0aGUgZmlyc3QKKyAqIHRoZW4gdGhlIHR3byByZXF1ZXN0cyBtdXN0IGJlIGNv
bWJpbmVkLiBUaGlzIGlzIGRvbmUgc2ltcGx5IGJ5IGRpc2NhcmRpbmcKKyAqIHJlcXVlc3RzIGF0
IHRoZSBoZWFkIG9mIHRoZSBxdWV1ZSB1bnRpbCBlaXRoZXIgb25seSBvbmUgcmVxdWVzdHMgaXMg
bGVmdAorICogKGluIHdoaWNoIGNhc2Ugd2UgdXNlIGEgTlVMTCBzZWNvbmQgY29udGV4dCkgb3Ig
dGhlIGZpcnN0IHR3byByZXF1ZXN0cyBoYXZlCisgKiB1bmlxdWUgSURzLgorICoKKyAqIEJ5IGFs
d2F5cyBleGVjdXRpbmcgdGhlIGZpcnN0IHR3byByZXF1ZXN0cyBpbiB0aGUgcXVldWUgdGhlIGRy
aXZlciBlbnN1cmVzCisgKiB0aGF0IHRoZSBHUFUgaXMga2VwdCBhcyBidXN5IGFzIHBvc3NpYmxl
LiBJbiB0aGUgY2FzZSB3aGVyZSBhIHNpbmdsZSBjb250ZXh0CisgKiBjb21wbGV0ZXMgYnV0IGEg
c2Vjb25kIGNvbnRleHQgaXMgc3RpbGwgZXhlY3V0aW5nLCB0aGUgcmVxdWVzdCBmb3IgdGhpcwor
ICogc2Vjb25kIGNvbnRleHQgd2lsbCBiZSBhdCB0aGUgaGVhZCBvZiB0aGUgcXVldWUgd2hlbiB3
ZSByZW1vdmUgdGhlIGZpcnN0CisgKiBvbmUuIFRoaXMgcmVxdWVzdCB3aWxsIHRoZW4gYmUgcmVz
dWJtaXR0ZWQgYWxvbmcgd2l0aCBhIG5ldyByZXF1ZXN0IGZvciBhCisgKiBkaWZmZXJlbnQgY29u
dGV4dCwgd2hpY2ggd2lsbCBjYXVzZSB0aGUgaGFyZHdhcmUgdG8gY29udGludWUgZXhlY3V0aW5n
IHRoZQorICogc2Vjb25kIHJlcXVlc3QgYW5kIHF1ZXVlIHRoZSBuZXcgcmVxdWVzdCAodGhlIEdQ
VSBkZXRlY3RzIHRoZSBjb25kaXRpb24gb2YgYQorICogY29udGV4dCBnZXR0aW5nIHByZWVtcHRl
ZCB3aXRoIHRoZSBzYW1lIGNvbnRleHQgYW5kIG9wdGltaXplcyB0aGUgY29udGV4dAorICogc3dp
dGNoIGZsb3cgYnkgbm90IGRvaW5nIHByZWVtcHRpb24sIGJ1dCBqdXN0IHNhbXBsaW5nIHRoZSBu
ZXcgdGFpbCBwb2ludGVyKS4KKyAqLworCisjaW5jbHVkZSA8bGludXgvbW0uaD4KKworI2luY2x1
ZGUgImk5MTVfZHJ2LmgiCisjaW5jbHVkZSAiaTkxNV9wZXJmLmgiCisjaW5jbHVkZSAiaW50ZWxf
Y29udGV4dC5oIgorI2luY2x1ZGUgImludGVsX2VuZ2luZS5oIgorI2luY2x1ZGUgImludGVsX2xy
Yy5oIgorI2luY2x1ZGUgImludGVsX2xyY19yZWcuaCIKKyNpbmNsdWRlICJpbnRlbF9yaW5nLmgi
CisjaW5jbHVkZSAiaW50ZWxfc3NldS5oIgorCitzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGludCBk
d29yZF9pbl9wYWdlKHZvaWQgKmFkZHIpCit7CisJcmV0dXJuIG9mZnNldF9pbl9wYWdlKGFkZHIp
IC8gc2l6ZW9mKHUzMik7Cit9CisKK3N0YXRpYyB2b2lkIHNldF9vZmZzZXRzKHUzMiAqcmVncywK
KwkJCWNvbnN0IHU4ICpkYXRhLAorCQkJY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lLAorCQkJYm9vbCBjbGVhcikKKyNkZWZpbmUgTk9QKHgpIChCSVQoNykgfCAoeCkpCisjZGVm
aW5lIExSSShjb3VudCwgZmxhZ3MpICgoZmxhZ3MpIDw8IDYgfCAoY291bnQpIHwgQlVJTERfQlVH
X09OX1pFUk8oY291bnQgPj0gQklUKDYpKSkKKyNkZWZpbmUgUE9TVEVEIEJJVCgwKQorI2RlZmlu
ZSBSRUcoeCkgKCgoeCkgPj4gMikgfCBCVUlMRF9CVUdfT05fWkVSTyh4ID49IDB4MjAwKSkKKyNk
ZWZpbmUgUkVHMTYoeCkgXAorCSgoKHgpID4+IDkpIHwgQklUKDcpIHwgQlVJTERfQlVHX09OX1pF
Uk8oeCA+PSAweDEwMDAwKSksIFwKKwkoKCh4KSA+PiAyKSAmIDB4N2YpCisjZGVmaW5lIEVORCh4
KSAwLCAoeCkKK3sKKwljb25zdCB1MzIgYmFzZSA9IGVuZ2luZS0+bW1pb19iYXNlOworCisJd2hp
bGUgKCpkYXRhKSB7CisJCXU4IGNvdW50LCBmbGFnczsKKworCQlpZiAoKmRhdGEgJiBCSVQoNykp
IHsgLyogc2tpcCAqLworCQkJY291bnQgPSAqZGF0YSsrICYgfkJJVCg3KTsKKwkJCWlmIChjbGVh
cikKKwkJCQltZW1zZXQzMihyZWdzLCBNSV9OT09QLCBjb3VudCk7CisJCQlyZWdzICs9IGNvdW50
OworCQkJY29udGludWU7CisJCX0KKworCQljb3VudCA9ICpkYXRhICYgMHgzZjsKKwkJZmxhZ3Mg
PSAqZGF0YSA+PiA2OworCQlkYXRhKys7CisKKwkJKnJlZ3MgPSBNSV9MT0FEX1JFR0lTVEVSX0lN
TShjb3VudCk7CisJCWlmIChmbGFncyAmIFBPU1RFRCkKKwkJCSpyZWdzIHw9IE1JX0xSSV9GT1JD
RV9QT1NURUQ7CisJCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMSkKKwkJCSpyZWdz
IHw9IE1JX0xSSV9DU19NTUlPOworCQlyZWdzKys7CisKKwkJR0VNX0JVR19PTighY291bnQpOwor
CQlkbyB7CisJCQl1MzIgb2Zmc2V0ID0gMDsKKwkJCXU4IHY7CisKKwkJCWRvIHsKKwkJCQl2ID0g
KmRhdGErKzsKKwkJCQlvZmZzZXQgPDw9IDc7CisJCQkJb2Zmc2V0IHw9IHYgJiB+QklUKDcpOwor
CQkJfSB3aGlsZSAodiAmIEJJVCg3KSk7CisKKwkJCXJlZ3NbMF0gPSBiYXNlICsgKG9mZnNldCA8
PCAyKTsKKwkJCWlmIChjbGVhcikKKwkJCQlyZWdzWzFdID0gMDsKKwkJCXJlZ3MgKz0gMjsKKwkJ
fSB3aGlsZSAoLS1jb3VudCk7CisJfQorCisJaWYgKGNsZWFyKSB7CisJCXU4IGNvdW50ID0gKisr
ZGF0YTsKKworCQkvKiBDbGVhciBwYXN0IHRoZSB0YWlsIGZvciBIVyBhY2Nlc3MgKi8KKwkJR0VN
X0JVR19PTihkd29yZF9pbl9wYWdlKHJlZ3MpID4gY291bnQpOworCQltZW1zZXQzMihyZWdzLCBN
SV9OT09QLCBjb3VudCAtIGR3b3JkX2luX3BhZ2UocmVncykpOworCisJCS8qIENsb3NlIHRoZSBi
YXRjaDsgdXNlZCBtYWlubHkgYnkgbGl2ZV9scmNfbGF5b3V0KCkgKi8KKwkJKnJlZ3MgPSBNSV9C
QVRDSF9CVUZGRVJfRU5EOworCQlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTApCisJ
CQkqcmVncyB8PSBCSVQoMCk7CisJfQorfQorCitzdGF0aWMgY29uc3QgdTggZ2VuOF94Y3Nfb2Zm
c2V0c1tdID0geworCU5PUCgxKSwKKwlMUkkoMTEsIDApLAorCVJFRzE2KDB4MjQ0KSwKKwlSRUco
MHgwMzQpLAorCVJFRygweDAzMCksCisJUkVHKDB4MDM4KSwKKwlSRUcoMHgwM2MpLAorCVJFRygw
eDE2OCksCisJUkVHKDB4MTQwKSwKKwlSRUcoMHgxMTApLAorCVJFRygweDExYyksCisJUkVHKDB4
MTE0KSwKKwlSRUcoMHgxMTgpLAorCisJTk9QKDkpLAorCUxSSSg5LCAwKSwKKwlSRUcxNigweDNh
OCksCisJUkVHMTYoMHgyOGMpLAorCVJFRzE2KDB4Mjg4KSwKKwlSRUcxNigweDI4NCksCisJUkVH
MTYoMHgyODApLAorCVJFRzE2KDB4MjdjKSwKKwlSRUcxNigweDI3OCksCisJUkVHMTYoMHgyNzQp
LAorCVJFRzE2KDB4MjcwKSwKKworCU5PUCgxMyksCisJTFJJKDIsIDApLAorCVJFRzE2KDB4MjAw
KSwKKwlSRUcoMHgwMjgpLAorCisJRU5EKDgwKQorfTsKKworc3RhdGljIGNvbnN0IHU4IGdlbjlf
eGNzX29mZnNldHNbXSA9IHsKKwlOT1AoMSksCisJTFJJKDE0LCBQT1NURUQpLAorCVJFRzE2KDB4
MjQ0KSwKKwlSRUcoMHgwMzQpLAorCVJFRygweDAzMCksCisJUkVHKDB4MDM4KSwKKwlSRUcoMHgw
M2MpLAorCVJFRygweDE2OCksCisJUkVHKDB4MTQwKSwKKwlSRUcoMHgxMTApLAorCVJFRygweDEx
YyksCisJUkVHKDB4MTE0KSwKKwlSRUcoMHgxMTgpLAorCVJFRygweDFjMCksCisJUkVHKDB4MWM0
KSwKKwlSRUcoMHgxYzgpLAorCisJTk9QKDMpLAorCUxSSSg5LCBQT1NURUQpLAorCVJFRzE2KDB4
M2E4KSwKKwlSRUcxNigweDI4YyksCisJUkVHMTYoMHgyODgpLAorCVJFRzE2KDB4Mjg0KSwKKwlS
RUcxNigweDI4MCksCisJUkVHMTYoMHgyN2MpLAorCVJFRzE2KDB4Mjc4KSwKKwlSRUcxNigweDI3
NCksCisJUkVHMTYoMHgyNzApLAorCisJTk9QKDEzKSwKKwlMUkkoMSwgUE9TVEVEKSwKKwlSRUcx
NigweDIwMCksCisKKwlOT1AoMTMpLAorCUxSSSg0NCwgUE9TVEVEKSwKKwlSRUcoMHgwMjgpLAor
CVJFRygweDA5YyksCisJUkVHKDB4MGMwKSwKKwlSRUcoMHgxNzgpLAorCVJFRygweDE3YyksCisJ
UkVHMTYoMHgzNTgpLAorCVJFRygweDE3MCksCisJUkVHKDB4MTUwKSwKKwlSRUcoMHgxNTQpLAor
CVJFRygweDE1OCksCisJUkVHMTYoMHg0MWMpLAorCVJFRzE2KDB4NjAwKSwKKwlSRUcxNigweDYw
NCksCisJUkVHMTYoMHg2MDgpLAorCVJFRzE2KDB4NjBjKSwKKwlSRUcxNigweDYxMCksCisJUkVH
MTYoMHg2MTQpLAorCVJFRzE2KDB4NjE4KSwKKwlSRUcxNigweDYxYyksCisJUkVHMTYoMHg2MjAp
LAorCVJFRzE2KDB4NjI0KSwKKwlSRUcxNigweDYyOCksCisJUkVHMTYoMHg2MmMpLAorCVJFRzE2
KDB4NjMwKSwKKwlSRUcxNigweDYzNCksCisJUkVHMTYoMHg2MzgpLAorCVJFRzE2KDB4NjNjKSwK
KwlSRUcxNigweDY0MCksCisJUkVHMTYoMHg2NDQpLAorCVJFRzE2KDB4NjQ4KSwKKwlSRUcxNigw
eDY0YyksCisJUkVHMTYoMHg2NTApLAorCVJFRzE2KDB4NjU0KSwKKwlSRUcxNigweDY1OCksCisJ
UkVHMTYoMHg2NWMpLAorCVJFRzE2KDB4NjYwKSwKKwlSRUcxNigweDY2NCksCisJUkVHMTYoMHg2
NjgpLAorCVJFRzE2KDB4NjZjKSwKKwlSRUcxNigweDY3MCksCisJUkVHMTYoMHg2NzQpLAorCVJF
RzE2KDB4Njc4KSwKKwlSRUcxNigweDY3YyksCisJUkVHKDB4MDY4KSwKKworCUVORCgxNzYpCit9
OworCitzdGF0aWMgY29uc3QgdTggZ2VuMTJfeGNzX29mZnNldHNbXSA9IHsKKwlOT1AoMSksCisJ
TFJJKDEzLCBQT1NURUQpLAorCVJFRzE2KDB4MjQ0KSwKKwlSRUcoMHgwMzQpLAorCVJFRygweDAz
MCksCisJUkVHKDB4MDM4KSwKKwlSRUcoMHgwM2MpLAorCVJFRygweDE2OCksCisJUkVHKDB4MTQw
KSwKKwlSRUcoMHgxMTApLAorCVJFRygweDFjMCksCisJUkVHKDB4MWM0KSwKKwlSRUcoMHgxYzgp
LAorCVJFRygweDE4MCksCisJUkVHMTYoMHgyYjQpLAorCisJTk9QKDUpLAorCUxSSSg5LCBQT1NU
RUQpLAorCVJFRzE2KDB4M2E4KSwKKwlSRUcxNigweDI4YyksCisJUkVHMTYoMHgyODgpLAorCVJF
RzE2KDB4Mjg0KSwKKwlSRUcxNigweDI4MCksCisJUkVHMTYoMHgyN2MpLAorCVJFRzE2KDB4Mjc4
KSwKKwlSRUcxNigweDI3NCksCisJUkVHMTYoMHgyNzApLAorCisJRU5EKDgwKQorfTsKKworc3Rh
dGljIGNvbnN0IHU4IGdlbjhfcmNzX29mZnNldHNbXSA9IHsKKwlOT1AoMSksCisJTFJJKDE0LCBQ
T1NURUQpLAorCVJFRzE2KDB4MjQ0KSwKKwlSRUcoMHgwMzQpLAorCVJFRygweDAzMCksCisJUkVH
KDB4MDM4KSwKKwlSRUcoMHgwM2MpLAorCVJFRygweDE2OCksCisJUkVHKDB4MTQwKSwKKwlSRUco
MHgxMTApLAorCVJFRygweDExYyksCisJUkVHKDB4MTE0KSwKKwlSRUcoMHgxMTgpLAorCVJFRygw
eDFjMCksCisJUkVHKDB4MWM0KSwKKwlSRUcoMHgxYzgpLAorCisJTk9QKDMpLAorCUxSSSg5LCBQ
T1NURUQpLAorCVJFRzE2KDB4M2E4KSwKKwlSRUcxNigweDI4YyksCisJUkVHMTYoMHgyODgpLAor
CVJFRzE2KDB4Mjg0KSwKKwlSRUcxNigweDI4MCksCisJUkVHMTYoMHgyN2MpLAorCVJFRzE2KDB4
Mjc4KSwKKwlSRUcxNigweDI3NCksCisJUkVHMTYoMHgyNzApLAorCisJTk9QKDEzKSwKKwlMUkko
MSwgMCksCisJUkVHKDB4MGM4KSwKKworCUVORCg4MCkKK307CisKK3N0YXRpYyBjb25zdCB1OCBn
ZW45X3Jjc19vZmZzZXRzW10gPSB7CisJTk9QKDEpLAorCUxSSSgxNCwgUE9TVEVEKSwKKwlSRUcx
NigweDI0NCksCisJUkVHKDB4MzQpLAorCVJFRygweDMwKSwKKwlSRUcoMHgzOCksCisJUkVHKDB4
M2MpLAorCVJFRygweDE2OCksCisJUkVHKDB4MTQwKSwKKwlSRUcoMHgxMTApLAorCVJFRygweDEx
YyksCisJUkVHKDB4MTE0KSwKKwlSRUcoMHgxMTgpLAorCVJFRygweDFjMCksCisJUkVHKDB4MWM0
KSwKKwlSRUcoMHgxYzgpLAorCisJTk9QKDMpLAorCUxSSSg5LCBQT1NURUQpLAorCVJFRzE2KDB4
M2E4KSwKKwlSRUcxNigweDI4YyksCisJUkVHMTYoMHgyODgpLAorCVJFRzE2KDB4Mjg0KSwKKwlS
RUcxNigweDI4MCksCisJUkVHMTYoMHgyN2MpLAorCVJFRzE2KDB4Mjc4KSwKKwlSRUcxNigweDI3
NCksCisJUkVHMTYoMHgyNzApLAorCisJTk9QKDEzKSwKKwlMUkkoMSwgMCksCisJUkVHKDB4Yzgp
LAorCisJTk9QKDEzKSwKKwlMUkkoNDQsIFBPU1RFRCksCisJUkVHKDB4MjgpLAorCVJFRygweDlj
KSwKKwlSRUcoMHhjMCksCisJUkVHKDB4MTc4KSwKKwlSRUcoMHgxN2MpLAorCVJFRzE2KDB4MzU4
KSwKKwlSRUcoMHgxNzApLAorCVJFRygweDE1MCksCisJUkVHKDB4MTU0KSwKKwlSRUcoMHgxNTgp
LAorCVJFRzE2KDB4NDFjKSwKKwlSRUcxNigweDYwMCksCisJUkVHMTYoMHg2MDQpLAorCVJFRzE2
KDB4NjA4KSwKKwlSRUcxNigweDYwYyksCisJUkVHMTYoMHg2MTApLAorCVJFRzE2KDB4NjE0KSwK
KwlSRUcxNigweDYxOCksCisJUkVHMTYoMHg2MWMpLAorCVJFRzE2KDB4NjIwKSwKKwlSRUcxNigw
eDYyNCksCisJUkVHMTYoMHg2MjgpLAorCVJFRzE2KDB4NjJjKSwKKwlSRUcxNigweDYzMCksCisJ
UkVHMTYoMHg2MzQpLAorCVJFRzE2KDB4NjM4KSwKKwlSRUcxNigweDYzYyksCisJUkVHMTYoMHg2
NDApLAorCVJFRzE2KDB4NjQ0KSwKKwlSRUcxNigweDY0OCksCisJUkVHMTYoMHg2NGMpLAorCVJF
RzE2KDB4NjUwKSwKKwlSRUcxNigweDY1NCksCisJUkVHMTYoMHg2NTgpLAorCVJFRzE2KDB4NjVj
KSwKKwlSRUcxNigweDY2MCksCisJUkVHMTYoMHg2NjQpLAorCVJFRzE2KDB4NjY4KSwKKwlSRUcx
NigweDY2YyksCisJUkVHMTYoMHg2NzApLAorCVJFRzE2KDB4Njc0KSwKKwlSRUcxNigweDY3OCks
CisJUkVHMTYoMHg2N2MpLAorCVJFRygweDY4KSwKKworCUVORCgxNzYpCit9OworCitzdGF0aWMg
Y29uc3QgdTggZ2VuMTFfcmNzX29mZnNldHNbXSA9IHsKKwlOT1AoMSksCisJTFJJKDE1LCBQT1NU
RUQpLAorCVJFRzE2KDB4MjQ0KSwKKwlSRUcoMHgwMzQpLAorCVJFRygweDAzMCksCisJUkVHKDB4
MDM4KSwKKwlSRUcoMHgwM2MpLAorCVJFRygweDE2OCksCisJUkVHKDB4MTQwKSwKKwlSRUcoMHgx
MTApLAorCVJFRygweDExYyksCisJUkVHKDB4MTE0KSwKKwlSRUcoMHgxMTgpLAorCVJFRygweDFj
MCksCisJUkVHKDB4MWM0KSwKKwlSRUcoMHgxYzgpLAorCVJFRygweDE4MCksCisKKwlOT1AoMSks
CisJTFJJKDksIFBPU1RFRCksCisJUkVHMTYoMHgzYTgpLAorCVJFRzE2KDB4MjhjKSwKKwlSRUcx
NigweDI4OCksCisJUkVHMTYoMHgyODQpLAorCVJFRzE2KDB4MjgwKSwKKwlSRUcxNigweDI3Yyks
CisJUkVHMTYoMHgyNzgpLAorCVJFRzE2KDB4Mjc0KSwKKwlSRUcxNigweDI3MCksCisKKwlMUkko
MSwgUE9TVEVEKSwKKwlSRUcoMHgxYjApLAorCisJTk9QKDEwKSwKKwlMUkkoMSwgMCksCisJUkVH
KDB4MGM4KSwKKworCUVORCg4MCkKK307CisKK3N0YXRpYyBjb25zdCB1OCBnZW4xMl9yY3Nfb2Zm
c2V0c1tdID0geworCU5PUCgxKSwKKwlMUkkoMTMsIFBPU1RFRCksCisJUkVHMTYoMHgyNDQpLAor
CVJFRygweDAzNCksCisJUkVHKDB4MDMwKSwKKwlSRUcoMHgwMzgpLAorCVJFRygweDAzYyksCisJ
UkVHKDB4MTY4KSwKKwlSRUcoMHgxNDApLAorCVJFRygweDExMCksCisJUkVHKDB4MWMwKSwKKwlS
RUcoMHgxYzQpLAorCVJFRygweDFjOCksCisJUkVHKDB4MTgwKSwKKwlSRUcxNigweDJiNCksCisK
KwlOT1AoNSksCisJTFJJKDksIFBPU1RFRCksCisJUkVHMTYoMHgzYTgpLAorCVJFRzE2KDB4Mjhj
KSwKKwlSRUcxNigweDI4OCksCisJUkVHMTYoMHgyODQpLAorCVJFRzE2KDB4MjgwKSwKKwlSRUcx
NigweDI3YyksCisJUkVHMTYoMHgyNzgpLAorCVJFRzE2KDB4Mjc0KSwKKwlSRUcxNigweDI3MCks
CisKKwlMUkkoMywgUE9TVEVEKSwKKwlSRUcoMHgxYjApLAorCVJFRzE2KDB4NWE4KSwKKwlSRUcx
NigweDVhYyksCisKKwlOT1AoNiksCisJTFJJKDEsIDApLAorCVJFRygweDBjOCksCisKKwlFTkQo
ODApCit9OworCisjdW5kZWYgRU5ECisjdW5kZWYgUkVHMTYKKyN1bmRlZiBSRUcKKyN1bmRlZiBM
UkkKKyN1bmRlZiBOT1AKKworc3RhdGljIGNvbnN0IHU4ICpyZWdfb2Zmc2V0cyhjb25zdCBzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJLyoKKwkgKiBUaGUgZ2VuMTIrIGxpc3Rz
IG9ubHkgaGF2ZSB0aGUgcmVnaXN0ZXJzIHdlIHByb2dyYW0gaW4gdGhlIGJhc2ljCisJICogZGVm
YXVsdCBzdGF0ZS4gV2UgcmVseSBvbiB0aGUgY29udGV4dCBpbWFnZSB1c2luZyByZWxhdGl2ZQor
CSAqIGFkZHJlc3NpbmcgdG8gYXV0b21hdGljIGZpeHVwIHRoZSByZWdpc3RlciBzdGF0ZSBiZXR3
ZWVuIHRoZQorCSAqIHBoeXNpY2FsIGVuZ2luZXMgZm9yIHZpcnR1YWwgZW5naW5lLgorCSAqLwor
CUdFTV9CVUdfT04oSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTIgJiYKKwkJICAgIWludGVs
X2VuZ2luZV9oYXNfcmVsYXRpdmVfbW1pbyhlbmdpbmUpKTsKKworCWlmIChlbmdpbmUtPmNsYXNz
ID09IFJFTkRFUl9DTEFTUykgeworCQlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTIp
CisJCQlyZXR1cm4gZ2VuMTJfcmNzX29mZnNldHM7CisJCWVsc2UgaWYgKElOVEVMX0dFTihlbmdp
bmUtPmk5MTUpID49IDExKQorCQkJcmV0dXJuIGdlbjExX3Jjc19vZmZzZXRzOworCQllbHNlIGlm
IChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSA5KQorCQkJcmV0dXJuIGdlbjlfcmNzX29mZnNl
dHM7CisJCWVsc2UKKwkJCXJldHVybiBnZW44X3Jjc19vZmZzZXRzOworCX0gZWxzZSB7CisJCWlm
IChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMikKKwkJCXJldHVybiBnZW4xMl94Y3Nfb2Zm
c2V0czsKKwkJZWxzZSBpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gOSkKKwkJCXJldHVy
biBnZW45X3hjc19vZmZzZXRzOworCQllbHNlCisJCQlyZXR1cm4gZ2VuOF94Y3Nfb2Zmc2V0czsK
Kwl9Cit9CisKK2ludCBpbnRlbF9scmNfcmluZ19taV9tb2RlKGNvbnN0IHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTIp
CisJCXJldHVybiAweDYwOworCWVsc2UgaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDkp
CisJCXJldHVybiAweDU0OworCWVsc2UgaWYgKGVuZ2luZS0+Y2xhc3MgPT0gUkVOREVSX0NMQVNT
KQorCQlyZXR1cm4gMHg1ODsKKwllbHNlCisJCXJldHVybiAtMTsKK30KKworc3RhdGljIHZvaWQg
X19yZXNldF9zdG9wX3JpbmcodTMyICpyZWdzLCBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmUpCit7CisJaW50IHg7CisKKwl4ID0gaW50ZWxfbHJjX3JpbmdfbWlfbW9kZShlbmdp
bmUpOworCWlmICh4ICE9IC0xKSB7CisJCXJlZ3NbeCArIDFdICY9IH5TVE9QX1JJTkc7CisJCXJl
Z3NbeCArIDFdIHw9IFNUT1BfUklORyA8PCAxNjsKKwl9Cit9CisKK3N0YXRpYyB2b2lkIGluaXRf
Y29tbW9uX3JlZ19zdGF0ZSh1MzIgKiBjb25zdCByZWdzLAorCQkJCSAgY29uc3Qgc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lLAorCQkJCSAgY29uc3Qgc3RydWN0IGludGVsX3JpbmcgKnJp
bmcsCisJCQkJICBib29sIGluaGliaXQpCit7CisJdTMyIGN0bDsKKworCWN0bCA9IF9NQVNLRURf
QklUX0VOQUJMRShDVFhfQ1RSTF9JTkhJQklUX1NZTl9DVFhfU1dJVENIKTsKKwljdGwgfD0gX01B
U0tFRF9CSVRfRElTQUJMRShDVFhfQ1RSTF9FTkdJTkVfQ1RYX1JFU1RPUkVfSU5ISUJJVCk7CisJ
aWYgKGluaGliaXQpCisJCWN0bCB8PSBDVFhfQ1RSTF9FTkdJTkVfQ1RYX1JFU1RPUkVfSU5ISUJJ
VDsKKwlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPCAxMSkKKwkJY3RsIHw9IF9NQVNLRURf
QklUX0RJU0FCTEUoQ1RYX0NUUkxfRU5HSU5FX0NUWF9TQVZFX0lOSElCSVQgfAorCQkJCQkgICBD
VFhfQ1RSTF9SU19DVFhfRU5BQkxFKTsKKwlyZWdzW0NUWF9DT05URVhUX0NPTlRST0xdID0gY3Rs
OworCisJcmVnc1tDVFhfUklOR19DVExdID0gUklOR19DVExfU0laRShyaW5nLT5zaXplKSB8IFJJ
TkdfVkFMSUQ7Cit9CisKK3N0YXRpYyB1MzIgbHJjX2luZGlyZWN0X2N0eF9vZmZzZXQoY29uc3Qg
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCXUzMiBpbmRpcmVjdF9jdHhfb2Zm
c2V0OworCisJc3dpdGNoIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSkgeworCWRlZmF1bHQ6CisJ
CU1JU1NJTkdfQ0FTRShJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSk7CisJCS8qIGZhbGwgdGhyb3Vn
aCAqLworCWNhc2UgMTI6CisJCWluZGlyZWN0X2N0eF9vZmZzZXQgPQorCQkJR0VOMTJfQ1RYX1JD
U19JTkRJUkVDVF9DVFhfT0ZGU0VUX0RFRkFVTFQ7CisJCWJyZWFrOworCWNhc2UgMTE6CisJCWlu
ZGlyZWN0X2N0eF9vZmZzZXQgPQorCQkJR0VOMTFfQ1RYX1JDU19JTkRJUkVDVF9DVFhfT0ZGU0VU
X0RFRkFVTFQ7CisJCWJyZWFrOworCWNhc2UgMTA6CisJCWluZGlyZWN0X2N0eF9vZmZzZXQgPQor
CQkJR0VOMTBfQ1RYX1JDU19JTkRJUkVDVF9DVFhfT0ZGU0VUX0RFRkFVTFQ7CisJCWJyZWFrOwor
CWNhc2UgOToKKwkJaW5kaXJlY3RfY3R4X29mZnNldCA9CisJCQlHRU45X0NUWF9SQ1NfSU5ESVJF
Q1RfQ1RYX09GRlNFVF9ERUZBVUxUOworCQlicmVhazsKKwljYXNlIDg6CisJCWluZGlyZWN0X2N0
eF9vZmZzZXQgPQorCQkJR0VOOF9DVFhfUkNTX0lORElSRUNUX0NUWF9PRkZTRVRfREVGQVVMVDsK
KwkJYnJlYWs7CisJfQorCisJcmV0dXJuIGluZGlyZWN0X2N0eF9vZmZzZXQ7Cit9CisKK3N0YXRp
YyB2b2lkIGluaXRfd2FfYmJfcmVnX3N0YXRlKHUzMiAqIGNvbnN0IHJlZ3MsCisJCQkJIGNvbnN0
IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKKwkJCQkgdTMyIHBvc19iYl9wZXJfY3R4
KQoreworCWNvbnN0IHN0cnVjdCBpOTE1X2N0eF93b3JrYXJvdW5kcyAqIGNvbnN0IHdhX2N0eCA9
ICZlbmdpbmUtPndhX2N0eDsKKworCWlmICh3YV9jdHgtPnBlcl9jdHguc2l6ZSkgeworCQljb25z
dCB1MzIgZ2d0dF9vZmZzZXQgPSBpOTE1X2dndHRfb2Zmc2V0KHdhX2N0eC0+dm1hKTsKKworCQly
ZWdzW3Bvc19iYl9wZXJfY3R4XSA9CisJCQkoZ2d0dF9vZmZzZXQgKyB3YV9jdHgtPnBlcl9jdHgu
b2Zmc2V0KSB8IDB4MDE7CisJfQorCisJaWYgKHdhX2N0eC0+aW5kaXJlY3RfY3R4LnNpemUpIHsK
KwkJY29uc3QgdTMyIGdndHRfb2Zmc2V0ID0gaTkxNV9nZ3R0X29mZnNldCh3YV9jdHgtPnZtYSk7
CisKKwkJcmVnc1twb3NfYmJfcGVyX2N0eCArIDJdID0KKwkJCShnZ3R0X29mZnNldCArIHdhX2N0
eC0+aW5kaXJlY3RfY3R4Lm9mZnNldCkgfAorCQkJKHdhX2N0eC0+aW5kaXJlY3RfY3R4LnNpemUg
LyBDQUNIRUxJTkVfQllURVMpOworCisJCXJlZ3NbcG9zX2JiX3Blcl9jdHggKyA0XSA9IGxyY19p
bmRpcmVjdF9jdHhfb2Zmc2V0KGVuZ2luZSkgPDwgNjsKKwl9Cit9CisKK3N0YXRpYyB2b2lkIGlu
aXRfcHBndHRfcmVnX3N0YXRlKHUzMiAqcmVncywgY29uc3Qgc3RydWN0IGk5MTVfcHBndHQgKnBw
Z3R0KQoreworCWlmIChpOTE1X3ZtX2lzXzRsdmwoJnBwZ3R0LT52bSkpIHsKKwkJLyogNjRiIFBQ
R1RUICg0OGJpdCBjYW5vbmljYWwpCisJCSAqIFBEUDBfREVTQ1JJUFRPUiBjb250YWlucyB0aGUg
YmFzZSBhZGRyZXNzIHRvIFBNTDQgYW5kCisJCSAqIG90aGVyIFBEUCBEZXNjcmlwdG9ycyBhcmUg
aWdub3JlZC4KKwkJICovCisJCUFTU0lHTl9DVFhfUE1MNChwcGd0dCwgcmVncyk7CisJfSBlbHNl
IHsKKwkJQVNTSUdOX0NUWF9QRFAocHBndHQsIHJlZ3MsIDMpOworCQlBU1NJR05fQ1RYX1BEUChw
cGd0dCwgcmVncywgMik7CisJCUFTU0lHTl9DVFhfUERQKHBwZ3R0LCByZWdzLCAxKTsKKwkJQVNT
SUdOX0NUWF9QRFAocHBndHQsIHJlZ3MsIDApOworCX0KK30KKworc3RhdGljIHN0cnVjdCBpOTE1
X3BwZ3R0ICp2bV9hbGlhcyhzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSkKK3sKKwlpZiAo
aTkxNV9pc19nZ3R0KHZtKSkKKwkJcmV0dXJuIGk5MTVfdm1fdG9fZ2d0dCh2bSktPmFsaWFzOwor
CWVsc2UKKwkJcmV0dXJuIGk5MTVfdm1fdG9fcHBndHQodm0pOworfQorCit2b2lkIGludGVsX2xy
Y19pbml0X3JlZ19zdGF0ZSh1MzIgKnJlZ3MsCisJCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxf
Y29udGV4dCAqY2UsCisJCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUsCisJCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfcmluZyAqcmluZywKKwkJCSAgICAgIGJv
b2wgaW5oaWJpdCkKK3sKKwkvKgorCSAqIEEgY29udGV4dCBpcyBhY3R1YWxseSBhIGJpZyBiYXRj
aCBidWZmZXIgd2l0aCBzZXZlcmFsCisJICogTUlfTE9BRF9SRUdJU1RFUl9JTU0gY29tbWFuZHMg
Zm9sbG93ZWQgYnkgKHJlZywgdmFsdWUpIHBhaXJzLiBUaGUKKwkgKiB2YWx1ZXMgd2UgYXJlIHNl
dHRpbmcgaGVyZSBhcmUgb25seSBmb3IgdGhlIGZpcnN0IGNvbnRleHQgcmVzdG9yZToKKwkgKiBv
biBhIHN1YnNlcXVlbnQgc2F2ZSwgdGhlIEdQVSB3aWxsIHJlY3JlYXRlIHRoaXMgYmF0Y2hidWZm
ZXIgd2l0aCBuZXcKKwkgKiB2YWx1ZXMgKGluY2x1ZGluZyBhbGwgdGhlIG1pc3NpbmcgTUlfTE9B
RF9SRUdJU1RFUl9JTU0gY29tbWFuZHMgdGhhdAorCSAqIHdlIGFyZSBub3QgaW5pdGlhbGl6aW5n
IGhlcmUpLgorCSAqLworCXNldF9vZmZzZXRzKHJlZ3MsIHJlZ19vZmZzZXRzKGVuZ2luZSksIGVu
Z2luZSwgaW5oaWJpdCk7CisKKwlpbml0X2NvbW1vbl9yZWdfc3RhdGUocmVncywgZW5naW5lLCBy
aW5nLCBpbmhpYml0KTsKKwlpbml0X3BwZ3R0X3JlZ19zdGF0ZShyZWdzLCB2bV9hbGlhcyhjZS0+
dm0pKTsKKworCWluaXRfd2FfYmJfcmVnX3N0YXRlKHJlZ3MsIGVuZ2luZSwKKwkJCSAgICAgSU5U
RUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTIgPworCQkJICAgICBHRU4xMl9DVFhfQkJfUEVSX0NU
WF9QVFIgOgorCQkJICAgICBDVFhfQkJfUEVSX0NUWF9QVFIpOworCisJX19yZXNldF9zdG9wX3Jp
bmcocmVncywgZW5naW5lKTsKK30KKwordm9pZCBpbnRlbF9scmNfdXBkYXRlX3JlZ19zdGF0ZShj
b25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCisJCQkJY29uc3Qgc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQoreworCWNvbnN0IHN0cnVjdCBpbnRlbF9yaW5nICpyaW5nID0gY2Ut
PnJpbmc7CisJdTMyICpyZWdzID0gY2UtPmxyY19yZWdfc3RhdGU7CisKKwlHRU1fQlVHX09OKCFp
bnRlbF9yaW5nX29mZnNldF92YWxpZChyaW5nLCByaW5nLT5oZWFkKSk7CisJR0VNX0JVR19PTigh
aW50ZWxfcmluZ19vZmZzZXRfdmFsaWQocmluZywgcmluZy0+dGFpbCkpOworCisJcmVnc1tDVFhf
UklOR19TVEFSVF0gPSBpOTE1X2dndHRfb2Zmc2V0KHJpbmctPnZtYSk7CisJcmVnc1tDVFhfUklO
R19IRUFEXSA9IHJpbmctPmhlYWQ7CisJcmVnc1tDVFhfUklOR19UQUlMXSA9IHJpbmctPnRhaWw7
CisKKwkvKiBSUENTICovCisJaWYgKGVuZ2luZS0+Y2xhc3MgPT0gUkVOREVSX0NMQVNTKSB7CisJ
CXJlZ3NbQ1RYX1JfUFdSX0NMS19TVEFURV0gPQorCQkJaW50ZWxfc3NldV9tYWtlX3JwY3MoZW5n
aW5lLT5pOTE1LCAmY2UtPnNzZXUpOworCisJCWk5MTVfb2FfaW5pdF9yZWdfc3RhdGUoY2UsIGVu
Z2luZSk7CisJfQorfQorCit2b2lkIGludGVsX2xyY19yZXNldF9yZWdfc3RhdGUoY29uc3Qgc3Ry
dWN0IGludGVsX2NvbnRleHQgKmNlLAorCQkJICAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSkKK3sKKwl1MzIgKnJlZ3MgPSBjZS0+bHJjX3JlZ19zdGF0ZTsKKworCV9f
cmVzZXRfc3RvcF9yaW5nKHJlZ3MsIGVuZ2luZSk7Cit9CisKK3ZvaWQgaW50ZWxfbHJjX3NldF9y
ZWdfb2Zmc2V0cyh1MzIgKnJlZ3MsIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sK
KwlzZXRfb2Zmc2V0cyhyZWdzLCByZWdfb2Zmc2V0cyhlbmdpbmUpLCBlbmdpbmUsIGZhbHNlKTsK
K30KKworLyoKKyAqIFRoZSBjb250ZXh0IGRlc2NyaXB0b3IgZW5jb2RlcyB2YXJpb3VzIGF0dHJp
YnV0ZXMgb2YgYSBjb250ZXh0LAorICogaW5jbHVkaW5nIGl0cyBHVFQgYWRkcmVzcyBhbmQgc29t
ZSBmbGFncy4gQmVjYXVzZSBpdCdzIGZhaXJseQorICogZXhwZW5zaXZlIHRvIGNhbGN1bGF0ZSwg
d2UnbGwganVzdCBkbyBpdCBvbmNlIGFuZCBjYWNoZSB0aGUgcmVzdWx0LAorICogd2hpY2ggcmVt
YWlucyB2YWxpZCB1bnRpbCB0aGUgY29udGV4dCBpcyB1bnBpbm5lZC4KKyAqCisgKiBUaGlzIGlz
IHdoYXQgYSBkZXNjcmlwdG9yIGxvb2tzIGxpa2UsIGZyb20gTFNCIHRvIE1TQjo6CisgKgorICog
ICAgICBiaXRzICAwLTExOiAgICBmbGFncywgR0VOOF9DVFhfKiAoY2FjaGVkIGluIGN0eC0+ZGVz
Y190ZW1wbGF0ZSkKKyAqICAgICAgYml0cyAxMi0zMTogICAgTFJDQSwgR1RUIGFkZHJlc3Mgb2Yg
KHRoZSBIV1NQIG9mKSB0aGlzIGNvbnRleHQKKyAqICAgICAgYml0cyAzMi01MjogICAgY3R4IElE
LCBhIGdsb2JhbGx5IHVuaXF1ZSB0YWcgKGhpZ2hlc3QgYml0IHVzZWQgYnkgR3VDKQorICogICAg
ICBiaXRzIDUzLTU0OiAgICBtYnosIHJlc2VydmVkIGZvciB1c2UgYnkgaGFyZHdhcmUKKyAqICAg
ICAgYml0cyA1NS02MzogICAgZ3JvdXAgSUQsIGN1cnJlbnRseSB1bnVzZWQgYW5kIHNldCB0byAw
CisgKgorICogU3RhcnRpbmcgZnJvbSBHZW4xMSwgdGhlIHVwcGVyIGR3b3JkIG9mIHRoZSBkZXNj
cmlwdG9yIGhhcyBhIG5ldyBmb3JtYXQ6CisgKgorICogICAgICBiaXRzIDMyLTM2OiAgICByZXNl
cnZlZAorICogICAgICBiaXRzIDM3LTQ3OiAgICBTVyBjb250ZXh0IElECisgKiAgICAgIGJpdHMg
NDg6NTM6ICAgIGVuZ2luZSBpbnN0YW5jZQorICogICAgICBiaXQgNTQ6ICAgICAgICBtYnosIHJl
c2VydmVkIGZvciB1c2UgYnkgaGFyZHdhcmUKKyAqICAgICAgYml0cyA1NS02MDogICAgU1cgY291
bnRlcgorICogICAgICBiaXRzIDYxLTYzOiAgICBlbmdpbmUgY2xhc3MKKyAqCisgKiBlbmdpbmUg
aW5mbywgU1cgY29udGV4dCBJRCBhbmQgU1cgY291bnRlciBuZWVkIHRvIGZvcm0gYSB1bmlxdWUg
bnVtYmVyCisgKiAoQ29udGV4dCBJRCkgcGVyIGxyYy4KKyAqLwordTY0IGludGVsX2xyY19kZXNj
cmlwdG9yKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJCSBzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUpCit7CisJdTY0IGRlc2M7CisKKwlkZXNjID0gSU5URUxfTEVHQUNZXzMyQl9D
T05URVhUOworCWlmIChpOTE1X3ZtX2lzXzRsdmwoY2UtPnZtKSkKKwkJZGVzYyA9IElOVEVMX0xF
R0FDWV82NEJfQ09OVEVYVDsKKwlkZXNjIDw8PSBHRU44X0NUWF9BRERSRVNTSU5HX01PREVfU0hJ
RlQ7CisKKwlkZXNjIHw9IEdFTjhfQ1RYX1ZBTElEIHwgR0VOOF9DVFhfUFJJVklMRUdFOworCWlm
IChJU19HRU4oZW5naW5lLT5pOTE1LCA4KSkKKwkJZGVzYyB8PSBHRU44X0NUWF9MM0xMQ19DT0hF
UkVOVDsKKworCWRlc2MgfD0gaTkxNV9nZ3R0X29mZnNldChjZS0+c3RhdGUpOyAvKiBiaXRzIDEy
LTMxICovCisJLyoKKwkgKiBUaGUgZm9sbG93aW5nIDMyYml0cyBhcmUgY29waWVkIGludG8gdGhl
IE9BIHJlcG9ydHMgKGR3b3JkIDIpLgorCSAqIENvbnNpZGVyIHVwZGF0aW5nIG9hX2dldF9yZW5k
ZXJfY3R4X2lkIGluIGk5MTVfcGVyZi5jIHdoZW4gY2hhbmdpbmcKKwkgKiBhbnl0aGluZyBiZWxv
dy4KKwkgKi8KKwlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTEpIHsKKwkJZGVzYyB8
PSAodTY0KWVuZ2luZS0+aW5zdGFuY2UgPDwgR0VOMTFfRU5HSU5FX0lOU1RBTkNFX1NISUZUOwor
CQkJCQkJCQkvKiBiaXRzIDQ4LTUzICovCisKKwkJZGVzYyB8PSAodTY0KWVuZ2luZS0+Y2xhc3Mg
PDwgR0VOMTFfRU5HSU5FX0NMQVNTX1NISUZUOworCQkJCQkJCQkvKiBiaXRzIDYxLTYzICovCisJ
fQorCisJcmV0dXJuIGRlc2M7Cit9CisKKyNpZiBJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9T
RUxGVEVTVCkKKyNpbmNsdWRlICJzZWxmdGVzdF9scmMuYyIKKyNlbmRpZgpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9scmMuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAu
LmEwNWMyYTVlMTEyYQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2xyYy5oCkBAIC0wLDAgKzEsNDcgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVy
OiBNSVQgKi8KKy8qCisgKiBDb3B5cmlnaHQgwqkgMjAxNCBJbnRlbCBDb3Jwb3JhdGlvbgorICov
CisKKyNpZm5kZWYgX19JTlRFTF9MUkNfSF9fCisjZGVmaW5lIF9fSU5URUxfTFJDX0hfXworCisj
aW5jbHVkZSA8bGludXgvdHlwZXMuaD4KKworc3RydWN0IGludGVsX2NvbnRleHQ7CitzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzOworc3RydWN0IGludGVsX3Jpbmc7CisKKy8qIExvZ2ljYWwgUmluZyBD
b250ZXh0cyAqLworLyogQXQgdGhlIHN0YXJ0IG9mIHRoZSBjb250ZXh0IGltYWdlIGlzIGl0cyBw
ZXItcHJvY2VzcyBIV1MgcGFnZSAqLworI2RlZmluZSBMUkNfUFBIV1NQX1BOCSgwKQorI2RlZmlu
ZSBMUkNfUFBIV1NQX1NaCSgxKQorLyogQWZ0ZXIgdGhlIFBQSFdTUCB3ZSBoYXZlIHRoZSBsb2dp
Y2FsIHN0YXRlIGZvciB0aGUgY29udGV4dCAqLworI2RlZmluZSBMUkNfU1RBVEVfUE4JKExSQ19Q
UEhXU1BfUE4gKyBMUkNfUFBIV1NQX1NaKQorCisvKiBTcGFjZSB3aXRoaW4gUFBIV1NQIHJlc2Vy
dmVkIHRvIGJlIHVzZWQgYXMgc2NyYXRjaCAqLworI2RlZmluZSBMUkNfUFBIV1NQX1NDUkFUQ0gJ
CTB4MzQKKyNkZWZpbmUgTFJDX1BQSFdTUF9TQ1JBVENIX0FERFIJCShMUkNfUFBIV1NQX1NDUkFU
Q0ggKiBzaXplb2YodTMyKSkKKworaW50IGludGVsX2xyY19yaW5nX21pX21vZGUoY29uc3Qgc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKKwordm9pZCBpbnRlbF9scmNfc2V0X3JlZ19v
ZmZzZXRzKHUzMiAqcmVncywgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKKwordm9p
ZCBpbnRlbF9scmNfaW5pdF9yZWdfc3RhdGUodTMyICpyZWdfc3RhdGUsCisJCQkgICAgICBjb25z
dCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCisJCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUsCisJCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfcmluZyAqcmlu
ZywKKwkJCSAgICAgIGJvb2wgaW5oaWJpdCk7CisKK3ZvaWQgaW50ZWxfbHJjX3VwZGF0ZV9yZWdf
c3RhdGUoY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAorCQkJCWNvbnN0IHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7Cit2b2lkIGludGVsX2xyY19yZXNldF9yZWdfc3RhdGUo
Y29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAorCQkJICAgICAgIGNvbnN0IHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7CisKK3U2NCBpbnRlbF9scmNfZGVzY3JpcHRvcihzdHJ1
Y3QgaW50ZWxfY29udGV4dCAqY2UsCisJCQkgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KTsKKworaW50IGludGVsX2VuZ2luZV9pbml0X3dvcmthcm91bmRfYmIoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKTsKK3ZvaWQgaW50ZWxfZW5naW5lX2Zpbmlfd29ya2Fyb3VuZF9iYihz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpOworCisjZW5kaWYgLyogX19JTlRFTF9MUkNf
SF9fICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9leGVj
bGlzdHMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2V4ZWNsaXN0cy5jCmlu
ZGV4IDVlMDRlY2I2MWRjYy4uZWFjMmI3ZjA5MDgwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9zZWxmdGVzdF9leGVjbGlzdHMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9zZWxmdGVzdF9leGVjbGlzdHMuYwpAQCAtNiw5ICs2LDEwIEBACiAKICNpbmNsdWRlIDxs
aW51eC9wcmltZV9udW1iZXJzLmg+CiAKLSNpbmNsdWRlICJnZW0vaTkxNV9nZW1fcG0uaCIKICNp
bmNsdWRlICJndC9pbnRlbF9lbmdpbmVfaGVhcnRiZWF0LmgiCisjaW5jbHVkZSAiZ3QvaW50ZWxf
ZW5naW5lX3BtLmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfcmVzZXQuaCIKKyNpbmNsdWRlICJndC9p
bnRlbF9yaW5nLmgiCiAKICNpbmNsdWRlICJpOTE1X3NlbGZ0ZXN0LmgiCiAjaW5jbHVkZSAic2Vs
ZnRlc3RzL2k5MTVfcmFuZG9tLmgiCkBAIC0yMDEsNyArMjAyLDcgQEAgc3RhdGljIGludCBsaXZl
X3VubGl0ZV9yZXN0b3JlKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGludCBwcmlvKQogCQl9CiAJCUdF
TV9CVUdfT04oIWNlWzFdLT5yaW5nLT5zaXplKTsKIAkJaW50ZWxfcmluZ19yZXNldChjZVsxXS0+
cmluZywgY2VbMV0tPnJpbmctPnNpemUgLyAyKTsKLQkJX19leGVjbGlzdHNfdXBkYXRlX3JlZ19z
dGF0ZShjZVsxXSwgZW5naW5lKTsKKwkJaW50ZWxfbHJjX3VwZGF0ZV9yZWdfc3RhdGUoY2VbMV0s
IGVuZ2luZSk7CiAKIAkJcnFbMF0gPSBpZ3Rfc3Bpbm5lcl9jcmVhdGVfcmVxdWVzdCgmc3Bpbiwg
Y2VbMF0sIE1JX0FSQl9DSEVDSyk7CiAJCWlmIChJU19FUlIocnFbMF0pKSB7CkBAIC0zNzQxLDQ5
NiArMzc0MiwzIEBAIGludCBpbnRlbF9leGVjbGlzdHNfbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAKIAlyZXR1cm4gaW50ZWxfZ3RfbGl2ZV9zdWJ0ZXN0cyh0
ZXN0cywgJmk5MTUtPmd0KTsKIH0KLQotc3RhdGljIHZvaWQgaGV4ZHVtcChjb25zdCB2b2lkICpi
dWYsIHNpemVfdCBsZW4pCi17Ci0JY29uc3Qgc2l6ZV90IHJvd3NpemUgPSA4ICogc2l6ZW9mKHUz
Mik7Ci0JY29uc3Qgdm9pZCAqcHJldiA9IE5VTEw7Ci0JYm9vbCBza2lwID0gZmFsc2U7Ci0Jc2l6
ZV90IHBvczsKLQotCWZvciAocG9zID0gMDsgcG9zIDwgbGVuOyBwb3MgKz0gcm93c2l6ZSkgewot
CQljaGFyIGxpbmVbMTI4XTsKLQotCQlpZiAocHJldiAmJiAhbWVtY21wKHByZXYsIGJ1ZiArIHBv
cywgcm93c2l6ZSkpIHsKLQkJCWlmICghc2tpcCkgewotCQkJCXByX2luZm8oIipcbiIpOwotCQkJ
CXNraXAgPSB0cnVlOwotCQkJfQotCQkJY29udGludWU7Ci0JCX0KLQotCQlXQVJOX09OX09OQ0Uo
aGV4X2R1bXBfdG9fYnVmZmVyKGJ1ZiArIHBvcywgbGVuIC0gcG9zLAotCQkJCQkJcm93c2l6ZSwg
c2l6ZW9mKHUzMiksCi0JCQkJCQlsaW5lLCBzaXplb2YobGluZSksCi0JCQkJCQlmYWxzZSkgPj0g
c2l6ZW9mKGxpbmUpKTsKLQkJcHJfaW5mbygiWyUwNHp4XSAlc1xuIiwgcG9zLCBsaW5lKTsKLQot
CQlwcmV2ID0gYnVmICsgcG9zOwotCQlza2lwID0gZmFsc2U7Ci0JfQotfQotCi1zdGF0aWMgaW50
IGxpdmVfbHJjX2xheW91dCh2b2lkICphcmcpCi17Ci0Jc3RydWN0IGludGVsX2d0ICpndCA9IGFy
ZzsKLQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0JZW51bSBpbnRlbF9lbmdpbmVf
aWQgaWQ7Ci0JdTMyICpscmM7Ci0JaW50IGVycjsKLQotCS8qCi0JICogQ2hlY2sgdGhlIHJlZ2lz
dGVycyBvZmZzZXRzIHdlIHVzZSB0byBjcmVhdGUgdGhlIGluaXRpYWwgcmVnIHN0YXRlCi0JICog
bWF0Y2ggdGhlIGxheW91dCBzYXZlZCBieSBIVy4KLQkgKi8KLQotCWxyYyA9IGttYWxsb2MoUEFH
RV9TSVpFLCBHRlBfS0VSTkVMKTsKLQlpZiAoIWxyYykKLQkJcmV0dXJuIC1FTk9NRU07Ci0KLQll
cnIgPSAwOwotCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LCBpZCkgewotCQl1MzIgKmh3Owot
CQlpbnQgZHc7Ci0KLQkJaWYgKCFlbmdpbmUtPmRlZmF1bHRfc3RhdGUpCi0JCQljb250aW51ZTsK
LQotCQlodyA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKGVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSwK
LQkJCQkJICAgICBJOTE1X01BUF9XQik7Ci0JCWlmIChJU19FUlIoaHcpKSB7Ci0JCQllcnIgPSBQ
VFJfRVJSKGh3KTsKLQkJCWJyZWFrOwotCQl9Ci0JCWh3ICs9IExSQ19TVEFURV9QTiAqIFBBR0Vf
U0laRSAvIHNpemVvZigqaHcpOwotCi0JCWV4ZWNsaXN0c19pbml0X3JlZ19zdGF0ZShtZW1zZXQo
bHJjLCBQT0lTT05fSU5VU0UsIFBBR0VfU0laRSksCi0JCQkJCSBlbmdpbmUtPmtlcm5lbF9jb250
ZXh0LAotCQkJCQkgZW5naW5lLAotCQkJCQkgZW5naW5lLT5rZXJuZWxfY29udGV4dC0+cmluZywK
LQkJCQkJIHRydWUpOwotCi0JCWR3ID0gMDsKLQkJZG8gewotCQkJdTMyIGxyaSA9IGh3W2R3XTsK
LQotCQkJaWYgKGxyaSA9PSAwKSB7Ci0JCQkJZHcrKzsKLQkJCQljb250aW51ZTsKLQkJCX0KLQot
CQkJaWYgKGxyY1tkd10gPT0gMCkgewotCQkJCXByX2RlYnVnKCIlczogc2tpcHBlZCBpbnN0cnVj
dGlvbiAleCBhdCBkd29yZCAlZFxuIiwKLQkJCQkJIGVuZ2luZS0+bmFtZSwgbHJpLCBkdyk7Ci0J
CQkJZHcrKzsKLQkJCQljb250aW51ZTsKLQkJCX0KLQotCQkJaWYgKChscmkgJiBHRU5NQVNLKDMx
LCAyMykpICE9IE1JX0lOU1RSKDB4MjIsIDApKSB7Ci0JCQkJcHJfZXJyKCIlczogRXhwZWN0ZWQg
TFJJIGNvbW1hbmQgYXQgZHdvcmQgJWQsIGZvdW5kICUwOHhcbiIsCi0JCQkJICAgICAgIGVuZ2lu
ZS0+bmFtZSwgZHcsIGxyaSk7Ci0JCQkJZXJyID0gLUVJTlZBTDsKLQkJCQlicmVhazsKLQkJCX0K
LQotCQkJaWYgKGxyY1tkd10gIT0gbHJpKSB7Ci0JCQkJcHJfZXJyKCIlczogTFJJIGNvbW1hbmQg
bWlzbWF0Y2ggYXQgZHdvcmQgJWQsIGV4cGVjdGVkICUwOHggZm91bmQgJTA4eFxuIiwKLQkJCQkg
ICAgICAgZW5naW5lLT5uYW1lLCBkdywgbHJpLCBscmNbZHddKTsKLQkJCQllcnIgPSAtRUlOVkFM
OwotCQkJCWJyZWFrOwotCQkJfQotCi0JCQlscmkgJj0gMHg3ZjsKLQkJCWxyaSsrOwotCQkJZHcr
KzsKLQotCQkJd2hpbGUgKGxyaSkgewotCQkJCWlmIChod1tkd10gIT0gbHJjW2R3XSkgewotCQkJ
CQlwcl9lcnIoIiVzOiBEaWZmZXJlbnQgcmVnaXN0ZXJzIGZvdW5kIGF0IGR3b3JkICVkLCBleHBl
Y3RlZCAleCwgZm91bmQgJXhcbiIsCi0JCQkJCSAgICAgICBlbmdpbmUtPm5hbWUsIGR3LCBod1tk
d10sIGxyY1tkd10pOwotCQkJCQllcnIgPSAtRUlOVkFMOwotCQkJCQlicmVhazsKLQkJCQl9Ci0K
LQkJCQkvKgotCQkJCSAqIFNraXAgb3ZlciB0aGUgYWN0dWFsIHJlZ2lzdGVyIHZhbHVlIGFzIHdl
Ci0JCQkJICogZXhwZWN0IHRoYXQgdG8gZGlmZmVyLgotCQkJCSAqLwotCQkJCWR3ICs9IDI7Ci0J
CQkJbHJpIC09IDI7Ci0JCQl9Ci0JCX0gd2hpbGUgKChscmNbZHddICYgfkJJVCgwKSkgIT0gTUlf
QkFUQ0hfQlVGRkVSX0VORCk7Ci0KLQkJaWYgKGVycikgewotCQkJcHJfaW5mbygiJXM6IEhXIHJl
Z2lzdGVyIGltYWdlOlxuIiwgZW5naW5lLT5uYW1lKTsKLQkJCWhleGR1bXAoaHcsIFBBR0VfU0la
RSk7Ci0KLQkJCXByX2luZm8oIiVzOiBTVyByZWdpc3RlciBpbWFnZTpcbiIsIGVuZ2luZS0+bmFt
ZSk7Ci0JCQloZXhkdW1wKGxyYywgUEFHRV9TSVpFKTsKLQkJfQotCi0JCWk5MTVfZ2VtX29iamVj
dF91bnBpbl9tYXAoZW5naW5lLT5kZWZhdWx0X3N0YXRlKTsKLQkJaWYgKGVycikKLQkJCWJyZWFr
OwotCX0KLQotCWtmcmVlKGxyYyk7Ci0JcmV0dXJuIGVycjsKLX0KLQotc3RhdGljIGludCBmaW5k
X29mZnNldChjb25zdCB1MzIgKmxyaSwgdTMyIG9mZnNldCkKLXsKLQlpbnQgaTsKLQotCWZvciAo
aSA9IDA7IGkgPCBQQUdFX1NJWkUgLyBzaXplb2YodTMyKTsgaSsrKQotCQlpZiAobHJpW2ldID09
IG9mZnNldCkKLQkJCXJldHVybiBpOwotCi0JcmV0dXJuIC0xOwotfQotCi1zdGF0aWMgaW50IGxp
dmVfbHJjX2ZpeGVkKHZvaWQgKmFyZykKLXsKLQlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOwot
CXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKLQllbnVtIGludGVsX2VuZ2luZV9pZCBp
ZDsKLQlpbnQgZXJyID0gMDsKLQotCS8qCi0JICogQ2hlY2sgdGhlIGFzc3VtZWQgcmVnaXN0ZXIg
b2Zmc2V0cyBtYXRjaCB0aGUgYWN0dWFsIGxvY2F0aW9ucyBpbgotCSAqIHRoZSBjb250ZXh0IGlt
YWdlLgotCSAqLwotCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7Ci0JCWNvbnN0
IHN0cnVjdCB7Ci0JCQl1MzIgcmVnOwotCQkJdTMyIG9mZnNldDsKLQkJCWNvbnN0IGNoYXIgKm5h
bWU7Ci0JCX0gdGJsW10gPSB7Ci0JCQl7Ci0JCQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19T
VEFSVChlbmdpbmUtPm1taW9fYmFzZSkpLAotCQkJCUNUWF9SSU5HX1NUQVJUIC0gMSwKLQkJCQki
UklOR19TVEFSVCIKLQkJCX0sCi0JCQl7Ci0JCQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19D
VEwoZW5naW5lLT5tbWlvX2Jhc2UpKSwKLQkJCQlDVFhfUklOR19DVEwgLSAxLAotCQkJCSJSSU5H
X0NUTCIKLQkJCX0sCi0JCQl7Ci0JCQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19IRUFEKGVu
Z2luZS0+bW1pb19iYXNlKSksCi0JCQkJQ1RYX1JJTkdfSEVBRCAtIDEsCi0JCQkJIlJJTkdfSEVB
RCIKLQkJCX0sCi0JCQl7Ci0JCQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19UQUlMKGVuZ2lu
ZS0+bW1pb19iYXNlKSksCi0JCQkJQ1RYX1JJTkdfVEFJTCAtIDEsCi0JCQkJIlJJTkdfVEFJTCIK
LQkJCX0sCi0JCQl7Ci0JCQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19NSV9NT0RFKGVuZ2lu
ZS0+bW1pb19iYXNlKSksCi0JCQkJbHJjX3JpbmdfbWlfbW9kZShlbmdpbmUpLAotCQkJCSJSSU5H
X01JX01PREUiCi0JCQl9LAotCQkJewotCQkJCWk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfQkJT
VEFURShlbmdpbmUtPm1taW9fYmFzZSkpLAotCQkJCUNUWF9CQl9TVEFURSAtIDEsCi0JCQkJIkJC
X1NUQVRFIgotCQkJfSwKLQkJCXsgfSwKLQkJfSwgKnQ7Ci0JCXUzMiAqaHc7Ci0KLQkJaWYgKCFl
bmdpbmUtPmRlZmF1bHRfc3RhdGUpCi0JCQljb250aW51ZTsKLQotCQlodyA9IGk5MTVfZ2VtX29i
amVjdF9waW5fbWFwKGVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSwKLQkJCQkJICAgICBJOTE1X01BUF9X
Qik7Ci0JCWlmIChJU19FUlIoaHcpKSB7Ci0JCQllcnIgPSBQVFJfRVJSKGh3KTsKLQkJCWJyZWFr
OwotCQl9Ci0JCWh3ICs9IExSQ19TVEFURV9QTiAqIFBBR0VfU0laRSAvIHNpemVvZigqaHcpOwot
Ci0JCWZvciAodCA9IHRibDsgdC0+bmFtZTsgdCsrKSB7Ci0JCQlpbnQgZHcgPSBmaW5kX29mZnNl
dChodywgdC0+cmVnKTsKLQotCQkJaWYgKGR3ICE9IHQtPm9mZnNldCkgewotCQkJCXByX2Vycigi
JXM6IE9mZnNldCBmb3IgJXMgWzB4JXhdIG1pc21hdGNoLCBmb3VuZCAleCwgZXhwZWN0ZWQgJXhc
biIsCi0JCQkJICAgICAgIGVuZ2luZS0+bmFtZSwKLQkJCQkgICAgICAgdC0+bmFtZSwKLQkJCQkg
ICAgICAgdC0+cmVnLAotCQkJCSAgICAgICBkdywKLQkJCQkgICAgICAgdC0+b2Zmc2V0KTsKLQkJ
CQllcnIgPSAtRUlOVkFMOwotCQkJfQotCQl9Ci0KLQkJaTkxNV9nZW1fb2JqZWN0X3VucGluX21h
cChlbmdpbmUtPmRlZmF1bHRfc3RhdGUpOwotCX0KLQotCXJldHVybiBlcnI7Ci19Ci0KLXN0YXRp
YyBpbnQgX19saXZlX2xyY19zdGF0ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCi0J
CQkgICAgc3RydWN0IGk5MTVfdm1hICpzY3JhdGNoKQotewotCXN0cnVjdCBpbnRlbF9jb250ZXh0
ICpjZTsKLQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKLQllbnVtIHsKLQkJUklOR19TVEFSVF9J
RFggPSAwLAotCQlSSU5HX1RBSUxfSURYLAotCQlNQVhfSURYCi0JfTsKLQl1MzIgZXhwZWN0ZWRb
TUFYX0lEWF07Ci0JdTMyICpjczsKLQlpbnQgZXJyOwotCWludCBuOwotCi0JY2UgPSBpbnRlbF9j
b250ZXh0X2NyZWF0ZShlbmdpbmUpOwotCWlmIChJU19FUlIoY2UpKQotCQlyZXR1cm4gUFRSX0VS
UihjZSk7Ci0KLQllcnIgPSBpbnRlbF9jb250ZXh0X3BpbihjZSk7Ci0JaWYgKGVycikKLQkJZ290
byBlcnJfcHV0OwotCi0JcnEgPSBpOTE1X3JlcXVlc3RfY3JlYXRlKGNlKTsKLQlpZiAoSVNfRVJS
KHJxKSkgewotCQllcnIgPSBQVFJfRVJSKHJxKTsKLQkJZ290byBlcnJfdW5waW47Ci0JfQotCi0J
Y3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJxLCA0ICogTUFYX0lEWCk7Ci0JaWYgKElTX0VSUihjcykp
IHsKLQkJZXJyID0gUFRSX0VSUihjcyk7Ci0JCWk5MTVfcmVxdWVzdF9hZGQocnEpOwotCQlnb3Rv
IGVycl91bnBpbjsKLQl9Ci0KLQkqY3MrKyA9IE1JX1NUT1JFX1JFR0lTVEVSX01FTV9HRU44IHwg
TUlfVVNFX0dHVFQ7Ci0JKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChSSU5HX1NUQVJUKGVu
Z2luZS0+bW1pb19iYXNlKSk7Ci0JKmNzKysgPSBpOTE1X2dndHRfb2Zmc2V0KHNjcmF0Y2gpICsg
UklOR19TVEFSVF9JRFggKiBzaXplb2YodTMyKTsKLQkqY3MrKyA9IDA7Ci0KLQlleHBlY3RlZFtS
SU5HX1NUQVJUX0lEWF0gPSBpOTE1X2dndHRfb2Zmc2V0KGNlLT5yaW5nLT52bWEpOwotCi0JKmNz
KysgPSBNSV9TVE9SRV9SRUdJU1RFUl9NRU1fR0VOOCB8IE1JX1VTRV9HR1RUOwotCSpjcysrID0g
aTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19UQUlMKGVuZ2luZS0+bW1pb19iYXNlKSk7Ci0JKmNz
KysgPSBpOTE1X2dndHRfb2Zmc2V0KHNjcmF0Y2gpICsgUklOR19UQUlMX0lEWCAqIHNpemVvZih1
MzIpOwotCSpjcysrID0gMDsKLQotCWk5MTVfcmVxdWVzdF9nZXQocnEpOwotCWk5MTVfcmVxdWVz
dF9hZGQocnEpOwotCi0JaW50ZWxfZW5naW5lX2ZsdXNoX3N1Ym1pc3Npb24oZW5naW5lKTsKLQll
eHBlY3RlZFtSSU5HX1RBSUxfSURYXSA9IGNlLT5yaW5nLT50YWlsOwotCi0JaWYgKGk5MTVfcmVx
dWVzdF93YWl0KHJxLCAwLCBIWiAvIDUpIDwgMCkgewotCQllcnIgPSAtRVRJTUU7Ci0JCWdvdG8g
ZXJyX3JxOwotCX0KLQotCWNzID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAoc2NyYXRjaC0+b2Jq
LCBJOTE1X01BUF9XQik7Ci0JaWYgKElTX0VSUihjcykpIHsKLQkJZXJyID0gUFRSX0VSUihjcyk7
Ci0JCWdvdG8gZXJyX3JxOwotCX0KLQotCWZvciAobiA9IDA7IG4gPCBNQVhfSURYOyBuKyspIHsK
LQkJaWYgKGNzW25dICE9IGV4cGVjdGVkW25dKSB7Ci0JCQlwcl9lcnIoIiVzOiBTdG9yZWQgcmVn
aXN0ZXJbJWRdIHZhbHVlWzB4JXhdIGRpZCBub3QgbWF0Y2ggZXhwZWN0ZWRbMHgleF1cbiIsCi0J
CQkgICAgICAgZW5naW5lLT5uYW1lLCBuLCBjc1tuXSwgZXhwZWN0ZWRbbl0pOwotCQkJZXJyID0g
LUVJTlZBTDsKLQkJCWJyZWFrOwotCQl9Ci0JfQotCi0JaTkxNV9nZW1fb2JqZWN0X3VucGluX21h
cChzY3JhdGNoLT5vYmopOwotCi1lcnJfcnE6Ci0JaTkxNV9yZXF1ZXN0X3B1dChycSk7Ci1lcnJf
dW5waW46Ci0JaW50ZWxfY29udGV4dF91bnBpbihjZSk7Ci1lcnJfcHV0OgotCWludGVsX2NvbnRl
eHRfcHV0KGNlKTsKLQlyZXR1cm4gZXJyOwotfQotCi1zdGF0aWMgaW50IGxpdmVfbHJjX3N0YXRl
KHZvaWQgKmFyZykKLXsKLQlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOwotCXN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZTsKLQlzdHJ1Y3QgaTkxNV92bWEgKnNjcmF0Y2g7Ci0JZW51bSBp
bnRlbF9lbmdpbmVfaWQgaWQ7Ci0JaW50IGVyciA9IDA7Ci0KLQkvKgotCSAqIENoZWNrIHRoZSBs
aXZlIHJlZ2lzdGVyIHN0YXRlIG1hdGNoZXMgd2hhdCB3ZSBleHBlY3QgZm9yIHRoaXMKLQkgKiBp
bnRlbF9jb250ZXh0LgotCSAqLwotCi0Jc2NyYXRjaCA9IGNyZWF0ZV9zY3JhdGNoKGd0KTsKLQlp
ZiAoSVNfRVJSKHNjcmF0Y2gpKQotCQlyZXR1cm4gUFRSX0VSUihzY3JhdGNoKTsKLQotCWZvcl9l
YWNoX2VuZ2luZShlbmdpbmUsIGd0LCBpZCkgewotCQllcnIgPSBfX2xpdmVfbHJjX3N0YXRlKGVu
Z2luZSwgc2NyYXRjaCk7Ci0JCWlmIChlcnIpCi0JCQlicmVhazsKLQl9Ci0KLQlpZiAoaWd0X2Zs
dXNoX3Rlc3QoZ3QtPmk5MTUpKQotCQllcnIgPSAtRUlPOwotCi0JaTkxNV92bWFfdW5waW5fYW5k
X3JlbGVhc2UoJnNjcmF0Y2gsIDApOwotCXJldHVybiBlcnI7Ci19Ci0KLXN0YXRpYyBpbnQgZ3By
X21ha2VfZGlydHkoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQotewotCXN0cnVjdCBp
OTE1X3JlcXVlc3QgKnJxOwotCXUzMiAqY3M7Ci0JaW50IG47Ci0KLQlycSA9IGludGVsX2VuZ2lu
ZV9jcmVhdGVfa2VybmVsX3JlcXVlc3QoZW5naW5lKTsKLQlpZiAoSVNfRVJSKHJxKSkKLQkJcmV0
dXJuIFBUUl9FUlIocnEpOwotCi0JY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJxLCAyICogTlVNX0dQ
Ul9EVyArIDIpOwotCWlmIChJU19FUlIoY3MpKSB7Ci0JCWk5MTVfcmVxdWVzdF9hZGQocnEpOwot
CQlyZXR1cm4gUFRSX0VSUihjcyk7Ci0JfQotCi0JKmNzKysgPSBNSV9MT0FEX1JFR0lTVEVSX0lN
TShOVU1fR1BSX0RXKTsKLQlmb3IgKG4gPSAwOyBuIDwgTlVNX0dQUl9EVzsgbisrKSB7Ci0JCSpj
cysrID0gQ1NfR1BSKGVuZ2luZSwgbik7Ci0JCSpjcysrID0gU1RBQ0tfTUFHSUM7Ci0JfQotCSpj
cysrID0gTUlfTk9PUDsKLQotCWludGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOwotCWk5MTVfcmVx
dWVzdF9hZGQocnEpOwotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQgX19saXZlX2dwcl9j
bGVhcihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCi0JCQkgICAgc3RydWN0IGk5MTVf
dm1hICpzY3JhdGNoKQotewotCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsKLQlzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpycTsKLQl1MzIgKmNzOwotCWludCBlcnI7Ci0JaW50IG47Ci0KLQlpZiAoSU5U
RUxfR0VOKGVuZ2luZS0+aTkxNSkgPCA5ICYmIGVuZ2luZS0+Y2xhc3MgIT0gUkVOREVSX0NMQVNT
KQotCQlyZXR1cm4gMDsgLyogR1BSIG9ubHkgb24gcmNzMCBmb3IgZ2VuOCAqLwotCi0JZXJyID0g
Z3ByX21ha2VfZGlydHkoZW5naW5lKTsKLQlpZiAoZXJyKQotCQlyZXR1cm4gZXJyOwotCi0JY2Ug
PSBpbnRlbF9jb250ZXh0X2NyZWF0ZShlbmdpbmUpOwotCWlmIChJU19FUlIoY2UpKQotCQlyZXR1
cm4gUFRSX0VSUihjZSk7Ci0KLQlycSA9IGludGVsX2NvbnRleHRfY3JlYXRlX3JlcXVlc3QoY2Up
OwotCWlmIChJU19FUlIocnEpKSB7Ci0JCWVyciA9IFBUUl9FUlIocnEpOwotCQlnb3RvIGVycl9w
dXQ7Ci0JfQotCi0JY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJxLCA0ICogTlVNX0dQUl9EVyk7Ci0J
aWYgKElTX0VSUihjcykpIHsKLQkJZXJyID0gUFRSX0VSUihjcyk7Ci0JCWk5MTVfcmVxdWVzdF9h
ZGQocnEpOwotCQlnb3RvIGVycl9wdXQ7Ci0JfQotCi0JZm9yIChuID0gMDsgbiA8IE5VTV9HUFJf
RFc7IG4rKykgewotCQkqY3MrKyA9IE1JX1NUT1JFX1JFR0lTVEVSX01FTV9HRU44IHwgTUlfVVNF
X0dHVFQ7Ci0JCSpjcysrID0gQ1NfR1BSKGVuZ2luZSwgbik7Ci0JCSpjcysrID0gaTkxNV9nZ3R0
X29mZnNldChzY3JhdGNoKSArIG4gKiBzaXplb2YodTMyKTsKLQkJKmNzKysgPSAwOwotCX0KLQot
CWk5MTVfcmVxdWVzdF9nZXQocnEpOwotCWk5MTVfcmVxdWVzdF9hZGQocnEpOwotCi0JaWYgKGk5
MTVfcmVxdWVzdF93YWl0KHJxLCAwLCBIWiAvIDUpIDwgMCkgewotCQllcnIgPSAtRVRJTUU7Ci0J
CWdvdG8gZXJyX3JxOwotCX0KLQotCWNzID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAoc2NyYXRj
aC0+b2JqLCBJOTE1X01BUF9XQik7Ci0JaWYgKElTX0VSUihjcykpIHsKLQkJZXJyID0gUFRSX0VS
Uihjcyk7Ci0JCWdvdG8gZXJyX3JxOwotCX0KLQotCWZvciAobiA9IDA7IG4gPCBOVU1fR1BSX0RX
OyBuKyspIHsKLQkJaWYgKGNzW25dKSB7Ci0JCQlwcl9lcnIoIiVzOiBHUFJbJWRdLiVzIHdhcyBu
b3QgemVybywgZm91bmQgMHglMDh4IVxuIiwKLQkJCSAgICAgICBlbmdpbmUtPm5hbWUsCi0JCQkg
ICAgICAgbiAvIDIsIG4gJiAxID8gInVkdyIgOiAibGR3IiwKLQkJCSAgICAgICBjc1tuXSk7Ci0J
CQllcnIgPSAtRUlOVkFMOwotCQkJYnJlYWs7Ci0JCX0KLQl9Ci0KLQlpOTE1X2dlbV9vYmplY3Rf
dW5waW5fbWFwKHNjcmF0Y2gtPm9iaik7Ci0KLWVycl9ycToKLQlpOTE1X3JlcXVlc3RfcHV0KHJx
KTsKLWVycl9wdXQ6Ci0JaW50ZWxfY29udGV4dF9wdXQoY2UpOwotCXJldHVybiBlcnI7Ci19Ci0K
LXN0YXRpYyBpbnQgbGl2ZV9ncHJfY2xlYXIodm9pZCAqYXJnKQotewotCXN0cnVjdCBpbnRlbF9n
dCAqZ3QgPSBhcmc7Ci0Jc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCXN0cnVjdCBp
OTE1X3ZtYSAqc2NyYXRjaDsKLQllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKLQlpbnQgZXJyID0g
MDsKLQotCS8qCi0JICogQ2hlY2sgdGhhdCBHUFIgcmVnaXN0ZXJzIGFyZSBjbGVhcmVkIGluIG5l
dyBjb250ZXh0cyBhcyB3ZSBuZWVkCi0JICogdG8gYXZvaWQgbGVha2luZyBhbnkgaW5mb3JtYXRp
b24gZnJvbSBwcmV2aW91cyBjb250ZXh0cy4KLQkgKi8KLQotCXNjcmF0Y2ggPSBjcmVhdGVfc2Ny
YXRjaChndCk7Ci0JaWYgKElTX0VSUihzY3JhdGNoKSkKLQkJcmV0dXJuIFBUUl9FUlIoc2NyYXRj
aCk7Ci0KLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndCwgaWQpIHsKLQkJZXJyID0gX19saXZl
X2dwcl9jbGVhcihlbmdpbmUsIHNjcmF0Y2gpOwotCQlpZiAoZXJyKQotCQkJYnJlYWs7Ci0JfQot
Ci0JaWYgKGlndF9mbHVzaF90ZXN0KGd0LT5pOTE1KSkKLQkJZXJyID0gLUVJTzsKLQotCWk5MTVf
dm1hX3VucGluX2FuZF9yZWxlYXNlKCZzY3JhdGNoLCAwKTsKLQlyZXR1cm4gZXJyOwotfQotCi1p
bnQgaW50ZWxfbHJjX2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQotewotCXN0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9zdWJ0ZXN0IHRlc3RzW10gPSB7Ci0JCVNV
QlRFU1QobGl2ZV9scmNfbGF5b3V0KSwKLQkJU1VCVEVTVChsaXZlX2xyY19maXhlZCksCi0JCVNV
QlRFU1QobGl2ZV9scmNfc3RhdGUpLAotCQlTVUJURVNUKGxpdmVfZ3ByX2NsZWFyKSwKLQl9Owot
Ci0JaWYgKCFIQVNfTE9HSUNBTF9SSU5HX0NPTlRFWFRTKGk5MTUpKQotCQlyZXR1cm4gMDsKLQot
CXJldHVybiBpbnRlbF9ndF9saXZlX3N1YnRlc3RzKHRlc3RzLCAmaTkxNS0+Z3QpOwotfQpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRl
eCAwMDAwMDAwMDAwMDAuLmQzNjdmMjg2ZGIxNgotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCkBAIC0wLDAgKzEsNTQ0IEBACisvLyBTUERY
LUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCisvKgorICogQ29weXJpZ2h0IMKpIDIwMTggSW50ZWwg
Q29ycG9yYXRpb24KKyAqLworCisjaW5jbHVkZSA8bGludXgvcHJpbWVfbnVtYmVycy5oPgorCisj
aW5jbHVkZSAiZ3QvaW50ZWxfZW5naW5lX2hlYXJ0YmVhdC5oIgorI2luY2x1ZGUgImd0L2ludGVs
X2VuZ2luZV9wbS5oIgorI2luY2x1ZGUgImd0L2ludGVsX3Jlc2V0LmgiCisjaW5jbHVkZSAiZ3Qv
aW50ZWxfcmluZy5oIgorCisjaW5jbHVkZSAiaTkxNV9zZWxmdGVzdC5oIgorI2luY2x1ZGUgInNl
bGZ0ZXN0cy9pOTE1X3JhbmRvbS5oIgorI2luY2x1ZGUgInNlbGZ0ZXN0cy9pZ3RfZmx1c2hfdGVz
dC5oIgorI2luY2x1ZGUgInNlbGZ0ZXN0cy9pZ3RfbGl2ZV90ZXN0LmgiCisjaW5jbHVkZSAic2Vs
ZnRlc3RzL2lndF9zcGlubmVyLmgiCisjaW5jbHVkZSAic2VsZnRlc3RzL2xpYl9zd19mZW5jZS5o
IgorCisjaW5jbHVkZSAiZ2VtL3NlbGZ0ZXN0cy9pZ3RfZ2VtX3V0aWxzLmgiCisjaW5jbHVkZSAi
Z2VtL3NlbGZ0ZXN0cy9tb2NrX2NvbnRleHQuaCIKKworI2RlZmluZSBDU19HUFIoZW5naW5lLCBu
KSAoKGVuZ2luZSktPm1taW9fYmFzZSArIDB4NjAwICsgKG4pICogNCkKKyNkZWZpbmUgTlVNX0dQ
Ul9EVyAoMTYgKiAyKSAvKiBlYWNoIEdQUiBpcyAyIGR3b3JkcyAqLworCitzdGF0aWMgc3RydWN0
IGk5MTVfdm1hICpjcmVhdGVfc2NyYXRjaChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQoreworCXN0cnVj
dCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CisJc3RydWN0IGk5MTVfdm1hICp2bWE7CisJaW50
IGVycjsKKworCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfaW50ZXJuYWwoZ3QtPmk5MTUs
IFBBR0VfU0laRSk7CisJaWYgKElTX0VSUihvYmopKQorCQlyZXR1cm4gRVJSX0NBU1Qob2JqKTsK
KworCWk5MTVfZ2VtX29iamVjdF9zZXRfY2FjaGVfY29oZXJlbmN5KG9iaiwgSTkxNV9DQUNISU5H
X0NBQ0hFRCk7CisKKwl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosICZndC0+Z2d0dC0+dm0s
IE5VTEwpOworCWlmIChJU19FUlIodm1hKSkgeworCQlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7
CisJCXJldHVybiB2bWE7CisJfQorCisJZXJyID0gaTkxNV92bWFfcGluKHZtYSwgMCwgMCwgUElO
X0dMT0JBTCk7CisJaWYgKGVycikgeworCQlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CisJCXJl
dHVybiBFUlJfUFRSKGVycik7CisJfQorCisJcmV0dXJuIHZtYTsKK30KKworc3RhdGljIHZvaWQg
aGV4ZHVtcChjb25zdCB2b2lkICpidWYsIHNpemVfdCBsZW4pCit7CisJY29uc3Qgc2l6ZV90IHJv
d3NpemUgPSA4ICogc2l6ZW9mKHUzMik7CisJY29uc3Qgdm9pZCAqcHJldiA9IE5VTEw7CisJYm9v
bCBza2lwID0gZmFsc2U7CisJc2l6ZV90IHBvczsKKworCWZvciAocG9zID0gMDsgcG9zIDwgbGVu
OyBwb3MgKz0gcm93c2l6ZSkgeworCQljaGFyIGxpbmVbMTI4XTsKKworCQlpZiAocHJldiAmJiAh
bWVtY21wKHByZXYsIGJ1ZiArIHBvcywgcm93c2l6ZSkpIHsKKwkJCWlmICghc2tpcCkgeworCQkJ
CXByX2luZm8oIipcbiIpOworCQkJCXNraXAgPSB0cnVlOworCQkJfQorCQkJY29udGludWU7CisJ
CX0KKworCQlXQVJOX09OX09OQ0UoaGV4X2R1bXBfdG9fYnVmZmVyKGJ1ZiArIHBvcywgbGVuIC0g
cG9zLAorCQkJCQkJcm93c2l6ZSwgc2l6ZW9mKHUzMiksCisJCQkJCQlsaW5lLCBzaXplb2YobGlu
ZSksCisJCQkJCQlmYWxzZSkgPj0gc2l6ZW9mKGxpbmUpKTsKKwkJcHJfaW5mbygiWyUwNHp4XSAl
c1xuIiwgcG9zLCBsaW5lKTsKKworCQlwcmV2ID0gYnVmICsgcG9zOworCQlza2lwID0gZmFsc2U7
CisJfQorfQorCitzdGF0aWMgaW50IGxpdmVfbHJjX2xheW91dCh2b2lkICphcmcpCit7CisJc3Ry
dWN0IGludGVsX2d0ICpndCA9IGFyZzsKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7
CisJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CisJdTMyICpscmM7CisJaW50IGVycjsKKworCS8q
CisJICogQ2hlY2sgdGhlIHJlZ2lzdGVycyBvZmZzZXRzIHdlIHVzZSB0byBjcmVhdGUgdGhlIGlu
aXRpYWwgcmVnIHN0YXRlCisJICogbWF0Y2ggdGhlIGxheW91dCBzYXZlZCBieSBIVy4KKwkgKi8K
KworCWxyYyA9IGttYWxsb2MoUEFHRV9TSVpFLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWxyYykKKwkJ
cmV0dXJuIC1FTk9NRU07CisKKwllcnIgPSAwOworCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0
LCBpZCkgeworCQl1MzIgKmh3OworCQlpbnQgZHc7CisKKwkJaWYgKCFlbmdpbmUtPmRlZmF1bHRf
c3RhdGUpCisJCQljb250aW51ZTsKKworCQlodyA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKGVu
Z2luZS0+ZGVmYXVsdF9zdGF0ZSwKKwkJCQkJICAgICBJOTE1X01BUF9XQik7CisJCWlmIChJU19F
UlIoaHcpKSB7CisJCQllcnIgPSBQVFJfRVJSKGh3KTsKKwkJCWJyZWFrOworCQl9CisJCWh3ICs9
IExSQ19TVEFURV9QTiAqIFBBR0VfU0laRSAvIHNpemVvZigqaHcpOworCisJCWludGVsX2xyY19p
bml0X3JlZ19zdGF0ZShtZW1zZXQobHJjLCBQT0lTT05fSU5VU0UsIFBBR0VfU0laRSksCisJCQkJ
CSBlbmdpbmUtPmtlcm5lbF9jb250ZXh0LAorCQkJCQkgZW5naW5lLAorCQkJCQkgZW5naW5lLT5r
ZXJuZWxfY29udGV4dC0+cmluZywKKwkJCQkJIHRydWUpOworCisJCWR3ID0gMDsKKwkJZG8gewor
CQkJdTMyIGxyaSA9IGh3W2R3XTsKKworCQkJaWYgKGxyaSA9PSAwKSB7CisJCQkJZHcrKzsKKwkJ
CQljb250aW51ZTsKKwkJCX0KKworCQkJaWYgKGxyY1tkd10gPT0gMCkgeworCQkJCXByX2RlYnVn
KCIlczogc2tpcHBlZCBpbnN0cnVjdGlvbiAleCBhdCBkd29yZCAlZFxuIiwKKwkJCQkJIGVuZ2lu
ZS0+bmFtZSwgbHJpLCBkdyk7CisJCQkJZHcrKzsKKwkJCQljb250aW51ZTsKKwkJCX0KKworCQkJ
aWYgKChscmkgJiBHRU5NQVNLKDMxLCAyMykpICE9IE1JX0lOU1RSKDB4MjIsIDApKSB7CisJCQkJ
cHJfZXJyKCIlczogRXhwZWN0ZWQgTFJJIGNvbW1hbmQgYXQgZHdvcmQgJWQsIGZvdW5kICUwOHhc
biIsCisJCQkJICAgICAgIGVuZ2luZS0+bmFtZSwgZHcsIGxyaSk7CisJCQkJZXJyID0gLUVJTlZB
TDsKKwkJCQlicmVhazsKKwkJCX0KKworCQkJaWYgKGxyY1tkd10gIT0gbHJpKSB7CisJCQkJcHJf
ZXJyKCIlczogTFJJIGNvbW1hbmQgbWlzbWF0Y2ggYXQgZHdvcmQgJWQsIGV4cGVjdGVkICUwOHgg
Zm91bmQgJTA4eFxuIiwKKwkJCQkgICAgICAgZW5naW5lLT5uYW1lLCBkdywgbHJpLCBscmNbZHdd
KTsKKwkJCQllcnIgPSAtRUlOVkFMOworCQkJCWJyZWFrOworCQkJfQorCisJCQlscmkgJj0gMHg3
ZjsKKwkJCWxyaSsrOworCQkJZHcrKzsKKworCQkJd2hpbGUgKGxyaSkgeworCQkJCWlmIChod1tk
d10gIT0gbHJjW2R3XSkgeworCQkJCQlwcl9lcnIoIiVzOiBEaWZmZXJlbnQgcmVnaXN0ZXJzIGZv
dW5kIGF0IGR3b3JkICVkLCBleHBlY3RlZCAleCwgZm91bmQgJXhcbiIsCisJCQkJCSAgICAgICBl
bmdpbmUtPm5hbWUsIGR3LCBod1tkd10sIGxyY1tkd10pOworCQkJCQllcnIgPSAtRUlOVkFMOwor
CQkJCQlicmVhazsKKwkJCQl9CisKKwkJCQkvKgorCQkJCSAqIFNraXAgb3ZlciB0aGUgYWN0dWFs
IHJlZ2lzdGVyIHZhbHVlIGFzIHdlCisJCQkJICogZXhwZWN0IHRoYXQgdG8gZGlmZmVyLgorCQkJ
CSAqLworCQkJCWR3ICs9IDI7CisJCQkJbHJpIC09IDI7CisJCQl9CisJCX0gd2hpbGUgKChscmNb
ZHddICYgfkJJVCgwKSkgIT0gTUlfQkFUQ0hfQlVGRkVSX0VORCk7CisKKwkJaWYgKGVycikgewor
CQkJcHJfaW5mbygiJXM6IEhXIHJlZ2lzdGVyIGltYWdlOlxuIiwgZW5naW5lLT5uYW1lKTsKKwkJ
CWhleGR1bXAoaHcsIFBBR0VfU0laRSk7CisKKwkJCXByX2luZm8oIiVzOiBTVyByZWdpc3RlciBp
bWFnZTpcbiIsIGVuZ2luZS0+bmFtZSk7CisJCQloZXhkdW1wKGxyYywgUEFHRV9TSVpFKTsKKwkJ
fQorCisJCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAoZW5naW5lLT5kZWZhdWx0X3N0YXRlKTsK
KwkJaWYgKGVycikKKwkJCWJyZWFrOworCX0KKworCWtmcmVlKGxyYyk7CisJcmV0dXJuIGVycjsK
K30KKworc3RhdGljIGludCBmaW5kX29mZnNldChjb25zdCB1MzIgKmxyaSwgdTMyIG9mZnNldCkK
K3sKKwlpbnQgaTsKKworCWZvciAoaSA9IDA7IGkgPCBQQUdFX1NJWkUgLyBzaXplb2YodTMyKTsg
aSsrKQorCQlpZiAobHJpW2ldID09IG9mZnNldCkKKwkJCXJldHVybiBpOworCisJcmV0dXJuIC0x
OworfQorCitzdGF0aWMgaW50IGxpdmVfbHJjX2ZpeGVkKHZvaWQgKmFyZykKK3sKKwlzdHJ1Y3Qg
aW50ZWxfZ3QgKmd0ID0gYXJnOworCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKKwll
bnVtIGludGVsX2VuZ2luZV9pZCBpZDsKKwlpbnQgZXJyID0gMDsKKworCS8qCisJICogQ2hlY2sg
dGhlIGFzc3VtZWQgcmVnaXN0ZXIgb2Zmc2V0cyBtYXRjaCB0aGUgYWN0dWFsIGxvY2F0aW9ucyBp
bgorCSAqIHRoZSBjb250ZXh0IGltYWdlLgorCSAqLworCisJZm9yX2VhY2hfZW5naW5lKGVuZ2lu
ZSwgZ3QsIGlkKSB7CisJCWNvbnN0IHN0cnVjdCB7CisJCQl1MzIgcmVnOworCQkJdTMyIG9mZnNl
dDsKKwkJCWNvbnN0IGNoYXIgKm5hbWU7CisJCX0gdGJsW10gPSB7CisJCQl7CisJCQkJaTkxNV9t
bWlvX3JlZ19vZmZzZXQoUklOR19TVEFSVChlbmdpbmUtPm1taW9fYmFzZSkpLAorCQkJCUNUWF9S
SU5HX1NUQVJUIC0gMSwKKwkJCQkiUklOR19TVEFSVCIKKwkJCX0sCisJCQl7CisJCQkJaTkxNV9t
bWlvX3JlZ19vZmZzZXQoUklOR19DVEwoZW5naW5lLT5tbWlvX2Jhc2UpKSwKKwkJCQlDVFhfUklO
R19DVEwgLSAxLAorCQkJCSJSSU5HX0NUTCIKKwkJCX0sCisJCQl7CisJCQkJaTkxNV9tbWlvX3Jl
Z19vZmZzZXQoUklOR19IRUFEKGVuZ2luZS0+bW1pb19iYXNlKSksCisJCQkJQ1RYX1JJTkdfSEVB
RCAtIDEsCisJCQkJIlJJTkdfSEVBRCIKKwkJCX0sCisJCQl7CisJCQkJaTkxNV9tbWlvX3JlZ19v
ZmZzZXQoUklOR19UQUlMKGVuZ2luZS0+bW1pb19iYXNlKSksCisJCQkJQ1RYX1JJTkdfVEFJTCAt
IDEsCisJCQkJIlJJTkdfVEFJTCIKKwkJCX0sCisJCQl7CisJCQkJaTkxNV9tbWlvX3JlZ19vZmZz
ZXQoUklOR19NSV9NT0RFKGVuZ2luZS0+bW1pb19iYXNlKSksCisJCQkJaW50ZWxfbHJjX3Jpbmdf
bWlfbW9kZShlbmdpbmUpLAorCQkJCSJSSU5HX01JX01PREUiCisJCQl9LAorCQkJeworCQkJCWk5
MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfQkJTVEFURShlbmdpbmUtPm1taW9fYmFzZSkpLAorCQkJ
CUNUWF9CQl9TVEFURSAtIDEsCisJCQkJIkJCX1NUQVRFIgorCQkJfSwKKwkJCXsgfSwKKwkJfSwg
KnQ7CisJCXUzMiAqaHc7CisKKwkJaWYgKCFlbmdpbmUtPmRlZmF1bHRfc3RhdGUpCisJCQljb250
aW51ZTsKKworCQlodyA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKGVuZ2luZS0+ZGVmYXVsdF9z
dGF0ZSwKKwkJCQkJICAgICBJOTE1X01BUF9XQik7CisJCWlmIChJU19FUlIoaHcpKSB7CisJCQll
cnIgPSBQVFJfRVJSKGh3KTsKKwkJCWJyZWFrOworCQl9CisJCWh3ICs9IExSQ19TVEFURV9QTiAq
IFBBR0VfU0laRSAvIHNpemVvZigqaHcpOworCisJCWZvciAodCA9IHRibDsgdC0+bmFtZTsgdCsr
KSB7CisJCQlpbnQgZHcgPSBmaW5kX29mZnNldChodywgdC0+cmVnKTsKKworCQkJaWYgKGR3ICE9
IHQtPm9mZnNldCkgeworCQkJCXByX2VycigiJXM6IE9mZnNldCBmb3IgJXMgWzB4JXhdIG1pc21h
dGNoLCBmb3VuZCAleCwgZXhwZWN0ZWQgJXhcbiIsCisJCQkJICAgICAgIGVuZ2luZS0+bmFtZSwK
KwkJCQkgICAgICAgdC0+bmFtZSwKKwkJCQkgICAgICAgdC0+cmVnLAorCQkJCSAgICAgICBkdywK
KwkJCQkgICAgICAgdC0+b2Zmc2V0KTsKKwkJCQllcnIgPSAtRUlOVkFMOworCQkJfQorCQl9CisK
KwkJaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChlbmdpbmUtPmRlZmF1bHRfc3RhdGUpOworCX0K
KworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBpbnQgX19saXZlX2xyY19zdGF0ZShzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUsCisJCQkgICAgc3RydWN0IGk5MTVfdm1hICpzY3JhdGNo
KQoreworCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsKKwlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpy
cTsKKwllbnVtIHsKKwkJUklOR19TVEFSVF9JRFggPSAwLAorCQlSSU5HX1RBSUxfSURYLAorCQlN
QVhfSURYCisJfTsKKwl1MzIgZXhwZWN0ZWRbTUFYX0lEWF07CisJdTMyICpjczsKKwlpbnQgZXJy
OworCWludCBuOworCisJY2UgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZShlbmdpbmUpOworCWlmIChJ
U19FUlIoY2UpKQorCQlyZXR1cm4gUFRSX0VSUihjZSk7CisKKwllcnIgPSBpbnRlbF9jb250ZXh0
X3BpbihjZSk7CisJaWYgKGVycikKKwkJZ290byBlcnJfcHV0OworCisJcnEgPSBpOTE1X3JlcXVl
c3RfY3JlYXRlKGNlKTsKKwlpZiAoSVNfRVJSKHJxKSkgeworCQllcnIgPSBQVFJfRVJSKHJxKTsK
KwkJZ290byBlcnJfdW5waW47CisJfQorCisJY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJxLCA0ICog
TUFYX0lEWCk7CisJaWYgKElTX0VSUihjcykpIHsKKwkJZXJyID0gUFRSX0VSUihjcyk7CisJCWk5
MTVfcmVxdWVzdF9hZGQocnEpOworCQlnb3RvIGVycl91bnBpbjsKKwl9CisKKwkqY3MrKyA9IE1J
X1NUT1JFX1JFR0lTVEVSX01FTV9HRU44IHwgTUlfVVNFX0dHVFQ7CisJKmNzKysgPSBpOTE1X21t
aW9fcmVnX29mZnNldChSSU5HX1NUQVJUKGVuZ2luZS0+bW1pb19iYXNlKSk7CisJKmNzKysgPSBp
OTE1X2dndHRfb2Zmc2V0KHNjcmF0Y2gpICsgUklOR19TVEFSVF9JRFggKiBzaXplb2YodTMyKTsK
KwkqY3MrKyA9IDA7CisKKwlleHBlY3RlZFtSSU5HX1NUQVJUX0lEWF0gPSBpOTE1X2dndHRfb2Zm
c2V0KGNlLT5yaW5nLT52bWEpOworCisJKmNzKysgPSBNSV9TVE9SRV9SRUdJU1RFUl9NRU1fR0VO
OCB8IE1JX1VTRV9HR1RUOworCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19UQUlM
KGVuZ2luZS0+bW1pb19iYXNlKSk7CisJKmNzKysgPSBpOTE1X2dndHRfb2Zmc2V0KHNjcmF0Y2gp
ICsgUklOR19UQUlMX0lEWCAqIHNpemVvZih1MzIpOworCSpjcysrID0gMDsKKworCWk5MTVfcmVx
dWVzdF9nZXQocnEpOworCWk5MTVfcmVxdWVzdF9hZGQocnEpOworCisJaW50ZWxfZW5naW5lX2Zs
dXNoX3N1Ym1pc3Npb24oZW5naW5lKTsKKwlleHBlY3RlZFtSSU5HX1RBSUxfSURYXSA9IGNlLT5y
aW5nLT50YWlsOworCisJaWYgKGk5MTVfcmVxdWVzdF93YWl0KHJxLCAwLCBIWiAvIDUpIDwgMCkg
eworCQllcnIgPSAtRVRJTUU7CisJCWdvdG8gZXJyX3JxOworCX0KKworCWNzID0gaTkxNV9nZW1f
b2JqZWN0X3Bpbl9tYXAoc2NyYXRjaC0+b2JqLCBJOTE1X01BUF9XQik7CisJaWYgKElTX0VSUihj
cykpIHsKKwkJZXJyID0gUFRSX0VSUihjcyk7CisJCWdvdG8gZXJyX3JxOworCX0KKworCWZvciAo
biA9IDA7IG4gPCBNQVhfSURYOyBuKyspIHsKKwkJaWYgKGNzW25dICE9IGV4cGVjdGVkW25dKSB7
CisJCQlwcl9lcnIoIiVzOiBTdG9yZWQgcmVnaXN0ZXJbJWRdIHZhbHVlWzB4JXhdIGRpZCBub3Qg
bWF0Y2ggZXhwZWN0ZWRbMHgleF1cbiIsCisJCQkgICAgICAgZW5naW5lLT5uYW1lLCBuLCBjc1tu
XSwgZXhwZWN0ZWRbbl0pOworCQkJZXJyID0gLUVJTlZBTDsKKwkJCWJyZWFrOworCQl9CisJfQor
CisJaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChzY3JhdGNoLT5vYmopOworCitlcnJfcnE6CisJ
aTkxNV9yZXF1ZXN0X3B1dChycSk7CitlcnJfdW5waW46CisJaW50ZWxfY29udGV4dF91bnBpbihj
ZSk7CitlcnJfcHV0OgorCWludGVsX2NvbnRleHRfcHV0KGNlKTsKKwlyZXR1cm4gZXJyOworfQor
CitzdGF0aWMgaW50IGxpdmVfbHJjX3N0YXRlKHZvaWQgKmFyZykKK3sKKwlzdHJ1Y3QgaW50ZWxf
Z3QgKmd0ID0gYXJnOworCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKKwlzdHJ1Y3Qg
aTkxNV92bWEgKnNjcmF0Y2g7CisJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CisJaW50IGVyciA9
IDA7CisKKwkvKgorCSAqIENoZWNrIHRoZSBsaXZlIHJlZ2lzdGVyIHN0YXRlIG1hdGNoZXMgd2hh
dCB3ZSBleHBlY3QgZm9yIHRoaXMKKwkgKiBpbnRlbF9jb250ZXh0LgorCSAqLworCisJc2NyYXRj
aCA9IGNyZWF0ZV9zY3JhdGNoKGd0KTsKKwlpZiAoSVNfRVJSKHNjcmF0Y2gpKQorCQlyZXR1cm4g
UFRSX0VSUihzY3JhdGNoKTsKKworCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LCBpZCkgewor
CQllcnIgPSBfX2xpdmVfbHJjX3N0YXRlKGVuZ2luZSwgc2NyYXRjaCk7CisJCWlmIChlcnIpCisJ
CQlicmVhazsKKwl9CisKKwlpZiAoaWd0X2ZsdXNoX3Rlc3QoZ3QtPmk5MTUpKQorCQllcnIgPSAt
RUlPOworCisJaTkxNV92bWFfdW5waW5fYW5kX3JlbGVhc2UoJnNjcmF0Y2gsIDApOworCXJldHVy
biBlcnI7Cit9CisKK3N0YXRpYyBpbnQgZ3ByX21ha2VfZGlydHkoc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lKQoreworCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOworCXUzMiAqY3M7CisJ
aW50IG47CisKKwlycSA9IGludGVsX2VuZ2luZV9jcmVhdGVfa2VybmVsX3JlcXVlc3QoZW5naW5l
KTsKKwlpZiAoSVNfRVJSKHJxKSkKKwkJcmV0dXJuIFBUUl9FUlIocnEpOworCisJY3MgPSBpbnRl
bF9yaW5nX2JlZ2luKHJxLCAyICogTlVNX0dQUl9EVyArIDIpOworCWlmIChJU19FUlIoY3MpKSB7
CisJCWk5MTVfcmVxdWVzdF9hZGQocnEpOworCQlyZXR1cm4gUFRSX0VSUihjcyk7CisJfQorCisJ
KmNzKysgPSBNSV9MT0FEX1JFR0lTVEVSX0lNTShOVU1fR1BSX0RXKTsKKwlmb3IgKG4gPSAwOyBu
IDwgTlVNX0dQUl9EVzsgbisrKSB7CisJCSpjcysrID0gQ1NfR1BSKGVuZ2luZSwgbik7CisJCSpj
cysrID0gU1RBQ0tfTUFHSUM7CisJfQorCSpjcysrID0gTUlfTk9PUDsKKworCWludGVsX3Jpbmdf
YWR2YW5jZShycSwgY3MpOworCWk5MTVfcmVxdWVzdF9hZGQocnEpOworCisJcmV0dXJuIDA7Cit9
CisKK3N0YXRpYyBpbnQgX19saXZlX2dwcl9jbGVhcihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUsCisJCQkgICAgc3RydWN0IGk5MTVfdm1hICpzY3JhdGNoKQoreworCXN0cnVjdCBpbnRl
bF9jb250ZXh0ICpjZTsKKwlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKKwl1MzIgKmNzOworCWlu
dCBlcnI7CisJaW50IG47CisKKwlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPCA5ICYmIGVu
Z2luZS0+Y2xhc3MgIT0gUkVOREVSX0NMQVNTKQorCQlyZXR1cm4gMDsgLyogR1BSIG9ubHkgb24g
cmNzMCBmb3IgZ2VuOCAqLworCisJZXJyID0gZ3ByX21ha2VfZGlydHkoZW5naW5lKTsKKwlpZiAo
ZXJyKQorCQlyZXR1cm4gZXJyOworCisJY2UgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZShlbmdpbmUp
OworCWlmIChJU19FUlIoY2UpKQorCQlyZXR1cm4gUFRSX0VSUihjZSk7CisKKwlycSA9IGludGVs
X2NvbnRleHRfY3JlYXRlX3JlcXVlc3QoY2UpOworCWlmIChJU19FUlIocnEpKSB7CisJCWVyciA9
IFBUUl9FUlIocnEpOworCQlnb3RvIGVycl9wdXQ7CisJfQorCisJY3MgPSBpbnRlbF9yaW5nX2Jl
Z2luKHJxLCA0ICogTlVNX0dQUl9EVyk7CisJaWYgKElTX0VSUihjcykpIHsKKwkJZXJyID0gUFRS
X0VSUihjcyk7CisJCWk5MTVfcmVxdWVzdF9hZGQocnEpOworCQlnb3RvIGVycl9wdXQ7CisJfQor
CisJZm9yIChuID0gMDsgbiA8IE5VTV9HUFJfRFc7IG4rKykgeworCQkqY3MrKyA9IE1JX1NUT1JF
X1JFR0lTVEVSX01FTV9HRU44IHwgTUlfVVNFX0dHVFQ7CisJCSpjcysrID0gQ1NfR1BSKGVuZ2lu
ZSwgbik7CisJCSpjcysrID0gaTkxNV9nZ3R0X29mZnNldChzY3JhdGNoKSArIG4gKiBzaXplb2Yo
dTMyKTsKKwkJKmNzKysgPSAwOworCX0KKworCWk5MTVfcmVxdWVzdF9nZXQocnEpOworCWk5MTVf
cmVxdWVzdF9hZGQocnEpOworCisJaWYgKGk5MTVfcmVxdWVzdF93YWl0KHJxLCAwLCBIWiAvIDUp
IDwgMCkgeworCQllcnIgPSAtRVRJTUU7CisJCWdvdG8gZXJyX3JxOworCX0KKworCWNzID0gaTkx
NV9nZW1fb2JqZWN0X3Bpbl9tYXAoc2NyYXRjaC0+b2JqLCBJOTE1X01BUF9XQik7CisJaWYgKElT
X0VSUihjcykpIHsKKwkJZXJyID0gUFRSX0VSUihjcyk7CisJCWdvdG8gZXJyX3JxOworCX0KKwor
CWZvciAobiA9IDA7IG4gPCBOVU1fR1BSX0RXOyBuKyspIHsKKwkJaWYgKGNzW25dKSB7CisJCQlw
cl9lcnIoIiVzOiBHUFJbJWRdLiVzIHdhcyBub3QgemVybywgZm91bmQgMHglMDh4IVxuIiwKKwkJ
CSAgICAgICBlbmdpbmUtPm5hbWUsCisJCQkgICAgICAgbiAvIDIsIG4gJiAxID8gInVkdyIgOiAi
bGR3IiwKKwkJCSAgICAgICBjc1tuXSk7CisJCQllcnIgPSAtRUlOVkFMOworCQkJYnJlYWs7CisJ
CX0KKwl9CisKKwlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHNjcmF0Y2gtPm9iaik7CisKK2Vy
cl9ycToKKwlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKK2Vycl9wdXQ6CisJaW50ZWxfY29udGV4dF9w
dXQoY2UpOworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBpbnQgbGl2ZV9ncHJfY2xlYXIodm9p
ZCAqYXJnKQoreworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7CisJc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lOworCXN0cnVjdCBpOTE1X3ZtYSAqc2NyYXRjaDsKKwllbnVtIGludGVs
X2VuZ2luZV9pZCBpZDsKKwlpbnQgZXJyID0gMDsKKworCS8qCisJICogQ2hlY2sgdGhhdCBHUFIg
cmVnaXN0ZXJzIGFyZSBjbGVhcmVkIGluIG5ldyBjb250ZXh0cyBhcyB3ZSBuZWVkCisJICogdG8g
YXZvaWQgbGVha2luZyBhbnkgaW5mb3JtYXRpb24gZnJvbSBwcmV2aW91cyBjb250ZXh0cy4KKwkg
Ki8KKworCXNjcmF0Y2ggPSBjcmVhdGVfc2NyYXRjaChndCk7CisJaWYgKElTX0VSUihzY3JhdGNo
KSkKKwkJcmV0dXJuIFBUUl9FUlIoc2NyYXRjaCk7CisKKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5l
LCBndCwgaWQpIHsKKwkJZXJyID0gX19saXZlX2dwcl9jbGVhcihlbmdpbmUsIHNjcmF0Y2gpOwor
CQlpZiAoZXJyKQorCQkJYnJlYWs7CisJfQorCisJaWYgKGlndF9mbHVzaF90ZXN0KGd0LT5pOTE1
KSkKKwkJZXJyID0gLUVJTzsKKworCWk5MTVfdm1hX3VucGluX2FuZF9yZWxlYXNlKCZzY3JhdGNo
LCAwKTsKKwlyZXR1cm4gZXJyOworfQorCitpbnQgaW50ZWxfbHJjX2xpdmVfc2VsZnRlc3RzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQoreworCXN0YXRpYyBjb25zdCBzdHJ1Y3QgaTkx
NV9zdWJ0ZXN0IHRlc3RzW10gPSB7CisJCVNVQlRFU1QobGl2ZV9scmNfbGF5b3V0KSwKKwkJU1VC
VEVTVChsaXZlX2xyY19maXhlZCksCisJCVNVQlRFU1QobGl2ZV9scmNfc3RhdGUpLAorCQlTVUJU
RVNUKGxpdmVfZ3ByX2NsZWFyKSwKKwl9OworCisJaWYgKCFIQVNfTE9HSUNBTF9SSU5HX0NPTlRF
WFRTKGk5MTUpKQorCQlyZXR1cm4gMDsKKworCXJldHVybiBpbnRlbF9ndF9saXZlX3N1YnRlc3Rz
KHRlc3RzLCAmaTkxNS0+Z3QpOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvdWMvaW50ZWxfZ3VjX2Fkcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxf
Z3VjX2Fkcy5jCmluZGV4IDYwM2MyYzg0MzE1ZS4uODA5Y2QxMGRjNzMxIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfYWRzLmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX2Fkcy5jCkBAIC0zLDggKzMsOCBAQAogICogQ29w
eXJpZ2h0IMKpIDIwMTQtMjAxOSBJbnRlbCBDb3Jwb3JhdGlvbgogICovCiAKLSNpbmNsdWRlICJn
dC9pbnRlbF9leGVjbGlzdHNfc3VibWlzc2lvbi5oIiAvKiBscmMgbGF5b3V0ICovCiAjaW5jbHVk
ZSAiZ3QvaW50ZWxfZ3QuaCIKKyNpbmNsdWRlICJndC9pbnRlbF9scmMuaCIKICNpbmNsdWRlICJp
bnRlbF9ndWNfYWRzLmgiCiAjaW5jbHVkZSAiaW50ZWxfdWMuaCIKICNpbmNsdWRlICJpOTE1X2Ry
di5oIgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX3N1
Ym1pc3Npb24uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNz
aW9uLmMKaW5kZXggYmIyMDk1ZTcxZGNhLi43MTI0OTY3OTcyODIgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9uLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYwpAQCAtMTEsNiArMTEs
NyBAQAogI2luY2x1ZGUgImd0L2ludGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uLmgiIC8qIFhYWCAq
LwogI2luY2x1ZGUgImd0L2ludGVsX2d0LmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfZ3RfcG0uaCIK
KyNpbmNsdWRlICJndC9pbnRlbF9scmMuaCIKICNpbmNsdWRlICJndC9pbnRlbF9scmNfcmVnLmgi
CiAjaW5jbHVkZSAiZ3QvaW50ZWxfcmluZy5oIgogCkBAIC00MDIsNiArNDAzLDM5IEBAIGNhbmNl
bF9wb3J0X3JlcXVlc3RzKHN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3RzICogY29uc3QgZXhl
Y2xpc3RzKQogCQltZW1zZXQoZXhlY2xpc3RzLT5pbmZsaWdodCwgMCwgc2l6ZW9mKGV4ZWNsaXN0
cy0+aW5mbGlnaHQpKTsKIH0KIAorc3RhdGljIHZvaWQgY29udGV4dF9yZXNldChzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUsCisJCQkgIHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJ
CSAgdTMyIGhlYWQsCisJCQkgIGJvb2wgc2NydWIpCit7CisJR0VNX0JVR19PTighaW50ZWxfY29u
dGV4dF9pc19waW5uZWQoY2UpKTsKKworCS8qCisJICogV2Ugd2FudCBhIHNpbXBsZSBjb250ZXh0
ICsgcmluZyB0byBleGVjdXRlIHRoZSBicmVhZGNydW1iIHVwZGF0ZS4KKwkgKiBXZSBjYW5ub3Qg
cmVseSBvbiB0aGUgY29udGV4dCBiZWluZyBpbnRhY3QgYWNyb3NzIHRoZSBHUFUgaGFuZywKKwkg
KiBzbyBjbGVhciBpdCBhbmQgcmVidWlsZCBqdXN0IHdoYXQgd2UgbmVlZCBmb3IgdGhlIGJyZWFk
Y3J1bWIuCisJICogQWxsIHBlbmRpbmcgcmVxdWVzdHMgZm9yIHRoaXMgY29udGV4dCB3aWxsIGJl
IHphcHBlZCwgYW5kIGFueQorCSAqIGZ1dHVyZSByZXF1ZXN0IHdpbGwgYmUgYWZ0ZXIgdXNlcnNw
YWNlIGhhcyBoYWQgdGhlIG9wcG9ydHVuaXR5CisJICogdG8gcmVjcmVhdGUgaXRzIG93biBzdGF0
ZS4KKwkgKi8KKwlpZiAoc2NydWIpIHsKKwkJdTMyICpyZWdzID0gY2UtPmxyY19yZWdfc3RhdGU7
CisKKwkJaWYgKGVuZ2luZS0+cGlubmVkX2RlZmF1bHRfc3RhdGUpCisJCQltZW1jcHkocmVncywg
Lyogc2tpcCByZXN0b3JpbmcgdGhlIHZhbmlsbGEgUFBIV1NQICovCisJCQkgICAgICAgZW5naW5l
LT5waW5uZWRfZGVmYXVsdF9zdGF0ZSArIExSQ19TVEFURV9QTiAqIFBBR0VfU0laRSwKKwkJCSAg
ICAgICBlbmdpbmUtPmNvbnRleHRfc2l6ZSAtIFBBR0VfU0laRSk7CisKKwkJaW50ZWxfbHJjX2lu
aXRfcmVnX3N0YXRlKHJlZ3MsIGNlLCBlbmdpbmUsIGNlLT5yaW5nLCBmYWxzZSk7CisJfQorCisJ
LyogUmVydW4gdGhlIHJlcXVlc3Q7IGl0cyBwYXlsb2FkIGhhcyBiZWVuIG5ldXRlcmVkIChpZiBn
dWlsdHkpLiAqLworCWNlLT5yaW5nLT5oZWFkID0gaGVhZDsKKwlpbnRlbF9yaW5nX3VwZGF0ZV9z
cGFjZShjZS0+cmluZyk7CisKKwlpbnRlbF9scmNfdXBkYXRlX3JlZ19zdGF0ZShjZSwgZW5naW5l
KTsKK30KKwogc3RhdGljIHZvaWQgZ3VjX3Jlc2V0X3Jld2luZChzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUsIGJvb2wgc3RhbGxlZCkKIHsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNs
aXN0cyAqIGNvbnN0IGV4ZWNsaXN0cyA9ICZlbmdpbmUtPmV4ZWNsaXN0czsKQEAgLTQyMSw3ICs0
NTUsNyBAQCBzdGF0aWMgdm9pZCBndWNfcmVzZXRfcmV3aW5kKHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSwgYm9vbCBzdGFsbGVkKQogCQlzdGFsbGVkID0gZmFsc2U7CiAKIAlfX2k5MTVf
cmVxdWVzdF9yZXNldChycSwgc3RhbGxlZCk7Ci0JaW50ZWxfbHJfY29udGV4dF9yZXNldChlbmdp
bmUsIHJxLT5jb250ZXh0LCBycS0+aGVhZCwgc3RhbGxlZCk7CisJY29udGV4dF9yZXNldChlbmdp
bmUsIHJxLT5jb250ZXh0LCBycS0+aGVhZCwgc3RhbGxlZCk7CiAKIG91dF91bmxvY2s6CiAJc3Bp
bl91bmxvY2tfaXJxcmVzdG9yZSgmZW5naW5lLT5hY3RpdmUubG9jaywgZmxhZ3MpOwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L21taW9fY29udGV4dC5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3Z0L21taW9fY29udGV4dC5jCmluZGV4IGFhZjE1OTE2ZDI5YS4uMzM0ZGNm
YTJkMzJmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvbW1pb19jb250ZXh0
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L21taW9fY29udGV4dC5jCkBAIC0zNSw2
ICszNSw3IEBACiAKICNpbmNsdWRlICJpOTE1X2Rydi5oIgogI2luY2x1ZGUgImd0L2ludGVsX2Nv
bnRleHQuaCIKKyNpbmNsdWRlICJndC9pbnRlbF9scmMuaCIKICNpbmNsdWRlICJndC9pbnRlbF9y
aW5nLmgiCiAjaW5jbHVkZSAiZ3Z0LmgiCiAjaW5jbHVkZSAidHJhY2UuaCIKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d2dC9zY2hlZHVsZXIuYwppbmRleCAyOTBjNzkyOTcyZmYuLjI5MDI1OWQ3OTk1YyAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIuYwpAQCAtMzYsNiArMzYsNyBAQAogI2luY2x1
ZGUgPGxpbnV4L2t0aHJlYWQuaD4KIAogI2luY2x1ZGUgImd0L2ludGVsX2NvbnRleHQuaCIKKyNp
bmNsdWRlICJndC9pbnRlbF9scmMuaCIKICNpbmNsdWRlICJndC9pbnRlbF9yaW5nLmgiCiAKICNp
bmNsdWRlICJpOTE1X2Rydi5oIgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9wZXJmLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYwppbmRleCAyNTA5MWY4
Mjc4OWMuLjM0NDljMDg1YzgyYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9wZXJmLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMKQEAgLTIwMCw2
ICsyMDAsNyBAQAogI2luY2x1ZGUgImd0L2ludGVsX2VuZ2luZV91c2VyLmgiCiAjaW5jbHVkZSAi
Z3QvaW50ZWxfZXhlY2xpc3RzX3N1Ym1pc3Npb24uaCIKICNpbmNsdWRlICJndC9pbnRlbF9ndC5o
IgorI2luY2x1ZGUgImd0L2ludGVsX2xyYy5oIgogI2luY2x1ZGUgImd0L2ludGVsX2xyY19yZWcu
aCIKICNpbmNsdWRlICJndC9pbnRlbF9yaW5nLmgiCiAKLS0gCjIuMjUuMAoKX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlz
dApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0
b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4Cg==

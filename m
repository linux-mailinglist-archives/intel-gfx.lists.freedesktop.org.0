Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id DF979DC649
	for <lists+intel-gfx@lfdr.de>; Fri, 18 Oct 2019 15:39:15 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1F2606EB4F;
	Fri, 18 Oct 2019 13:39:14 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id AF7396EB49;
 Fri, 18 Oct 2019 13:39:06 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18883049-1500050 
 for multiple; Fri, 18 Oct 2019 14:38:58 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 18 Oct 2019 14:38:55 +0100
Message-Id: <20191018133855.31743-4-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191018133855.31743-1-chris@chris-wilson.co.uk>
References: <20191018133855.31743-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t 3/3] i915: Exercise timeslice sysfs
 property
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: igt-dev@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

U2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Ci0t
LQogdGVzdHMvTWFrZWZpbGUuc291cmNlcyAgICAgICAgICAgICAgICB8ICAgMSArCiB0ZXN0cy9p
OTE1L3N5c2ZzX3RpbWVzbGljZV9kdXJhdGlvbi5jIHwgMzA0ICsrKysrKysrKysrKysrKysrKysr
KysrKysrCiB0ZXN0cy9tZXNvbi5idWlsZCAgICAgICAgICAgICAgICAgICAgIHwgICAxICsKIDMg
ZmlsZXMgY2hhbmdlZCwgMzA2IGluc2VydGlvbnMoKykKIGNyZWF0ZSBtb2RlIDEwMDY0NCB0ZXN0
cy9pOTE1L3N5c2ZzX3RpbWVzbGljZV9kdXJhdGlvbi5jCgpkaWZmIC0tZ2l0IGEvdGVzdHMvTWFr
ZWZpbGUuc291cmNlcyBiL3Rlc3RzL01ha2VmaWxlLnNvdXJjZXMKaW5kZXggNDQ5NGQyYzA1Li45
YmZlMjE0ZDcgMTAwNjQ0Ci0tLSBhL3Rlc3RzL01ha2VmaWxlLnNvdXJjZXMKKysrIGIvdGVzdHMv
TWFrZWZpbGUuc291cmNlcwpAQCAtMTAwLDYgKzEwMCw3IEBAIFRFU1RTX3Byb2dzID0gXAogCXZn
ZW1fc2xvdyBcCiAJaTkxNS9zeXNmc19oZWFydGJlYXRfaW50ZXJ2YWwgXAogCWk5MTUvc3lzZnNf
cHJlZW1wdGlvbl90aW1lb3V0IFwKKwlpOTE1L3N5c2ZzX3RpbWVzbGljZV9kdXJhdGlvbiBcCiAJ
JChOVUxMKQogCiBURVNUU19wcm9ncyArPSBnZW1fYmFkX3JlbG9jCmRpZmYgLS1naXQgYS90ZXN0
cy9pOTE1L3N5c2ZzX3RpbWVzbGljZV9kdXJhdGlvbi5jIGIvdGVzdHMvaTkxNS9zeXNmc190aW1l
c2xpY2VfZHVyYXRpb24uYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAuLjBm
MmUxOGI5NwotLS0gL2Rldi9udWxsCisrKyBiL3Rlc3RzL2k5MTUvc3lzZnNfdGltZXNsaWNlX2R1
cmF0aW9uLmMKQEAgLTAsMCArMSwzMDQgQEAKKy8qCisgKiBDb3B5cmlnaHQgwqkgMjAxOSBJbnRl
bCBDb3Jwb3JhdGlvbgorICoKKyAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUg
b2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCisgKiBjb3B5IG9mIHRoaXMgc29m
dHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIp
LAorICogdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVk
aW5nIHdpdGhvdXQgbGltaXRhdGlvbgorICogdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlm
eSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsCisgKiBhbmQvb3Igc2Vs
bCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0
aGUKKyAqIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9s
bG93aW5nIGNvbmRpdGlvbnM6CisgKgorICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5k
IHRoaXMgcGVybWlzc2lvbiBub3RpY2UgKGluY2x1ZGluZyB0aGUgbmV4dAorICogcGFyYWdyYXBo
KSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25z
IG9mIHRoZQorICogU29mdHdhcmUuCisgKgorICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJB
UyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKKyAqIElNUExJ
RUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hB
TlRBQklMSVRZLAorICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklO
RlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMCisgKiBUSEUgQVVUSE9SUyBPUiBDT1BZUklH
SFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUgorICog
TElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhF
UldJU0UsIEFSSVNJTkcKKyAqIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhF
IFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MKKyAqIElOIFRIRSBTT0ZUV0FS
RS4KKyAqLworCisjaW5jbHVkZSA8ZGlyZW50Lmg+CisjaW5jbHVkZSA8ZXJybm8uaD4KKyNpbmNs
dWRlIDxmY250bC5oPgorI2luY2x1ZGUgPGludHR5cGVzLmg+CisjaW5jbHVkZSA8c3lzL3N0YXQu
aD4KKyNpbmNsdWRlIDxzeXMvdHlwZXMuaD4KKyNpbmNsdWRlIDx1bmlzdGQuaD4KKworI2luY2x1
ZGUgImRybXRlc3QuaCIgLyogZ2VtX3F1aWVzY2VudF9ncHUoKSEgKi8KKyNpbmNsdWRlICJpZ3Rf
ZHVtbXlsb2FkLmgiCisjaW5jbHVkZSAiaWd0X3N5c2ZzLmgiCisjaW5jbHVkZSAiaW9jdGxfd3Jh
cHBlcnMuaCIgLyogaWd0X3JlcXVpcmVfZ2VtKCkhICovCisjaW5jbHVkZSAic3dfc3luYy5oIgor
CisjaW5jbHVkZSAiaWd0X2RlYnVnZnMuaCIKKworc3RhdGljIGJvb2wgX19lbmFibGVfaGFuZ2No
ZWNrKGludCBkaXIsIGJvb2wgc3RhdGUpCit7CisJcmV0dXJuIGlndF9zeXNmc19zZXQoZGlyLCAi
ZW5hYmxlX2hhbmdjaGVjayIsIHN0YXRlID8gIjEiIDogIjAiKTsKK30KKworc3RhdGljIGJvb2wg
ZW5hYmxlX2hhbmdjaGVjayhpbnQgaTkxNSwgYm9vbCBzdGF0ZSkKK3sKKwlib29sIHN1Y2Nlc3M7
CisJaW50IGRpcjsKKworCWRpciA9IGlndF9zeXNmc19vcGVuX3BhcmFtZXRlcnMoaTkxNSk7CisJ
aWYgKGRpciA8IDApIC8qIG5vIHBhcmFtZXRlcnMsIG11c3QgYmUgZGVmYXVsdCEgKi8KKwkJcmV0
dXJuIGZhbHNlOworCisJc3VjY2VzcyA9IF9fZW5hYmxlX2hhbmdjaGVjayhkaXIsIHN0YXRlKTsK
KwljbG9zZShkaXIpOworCisJcmV0dXJuIHN1Y2Nlc3M7Cit9CisKK3N0YXRpYyB2b2lkIHNldF90
aW1lc2xpY2UoaW50IGVuZ2luZSwgdW5zaWduZWQgaW50IHZhbHVlKQoreworCXVuc2lnbmVkIGlu
dCBkZWxheTsKKworCWlndF9zeXNmc19wcmludGYoZW5naW5lLCAidGltZXNsaWNlX2R1cmF0aW9u
X21zIiwgIiV1IiwgdmFsdWUpOworCWlndF9zeXNmc19zY2FuZihlbmdpbmUsICJ0aW1lc2xpY2Vf
ZHVyYXRpb25fbXMiLCAiJXUiLCAmZGVsYXkpOworCWlndF9hc3NlcnRfZXEoZGVsYXksIHZhbHVl
KTsKK30KKworc3RhdGljIHZvaWQgdGVzdF9pZGVtcG90ZW50KGludCBpOTE1LCBpbnQgZW5naW5l
KQoreworCWNvbnN0IHVuc2lnbmVkIGludCBkZWxheXNbXSA9IHsgMCwgMSwgMTIzNCwgNjU0MzIx
IH07CisJdW5zaWduZWQgaW50IHNhdmVkOworCisJaWd0X2Fzc2VydChpZ3Rfc3lzZnNfc2NhbmYo
ZW5naW5lLCAidGltZXNsaWNlX2R1cmF0aW9uX21zIiwgIiV1IiwgJnNhdmVkKSA9PSAxKTsKKwlp
Z3RfZGVidWcoIkluaXRpYWwgdGltZXNsaWNlX2R1cmF0aW9uX21zOiV1XG4iLCBzYXZlZCk7CisK
Kwlmb3IgKGludCBpID0gMDsgaSA8IEFSUkFZX1NJWkUoZGVsYXlzKTsgaSsrKQorCQlzZXRfdGlt
ZXNsaWNlKGVuZ2luZSwgZGVsYXlzW2ldKTsKKworCXNldF90aW1lc2xpY2UoZW5naW5lLCBzYXZl
ZCk7Cit9CisKK3N0YXRpYyB2b2lkIHRlc3RfaW52YWxpZChpbnQgaTkxNSwgaW50IGVuZ2luZSkK
K3sKKwl1bnNpZ25lZCBpbnQgc2F2ZWQsIGRlbGF5OworCisJaWd0X2Fzc2VydChpZ3Rfc3lzZnNf
c2NhbmYoZW5naW5lLCAidGltZXNsaWNlX2R1cmF0aW9uX21zIiwgIiV1IiwgJnNhdmVkKSA9PSAx
KTsKKwlpZ3RfZGVidWcoIkluaXRpYWwgdGltZXNsaWNlX2R1cmF0aW9uX21zOiV1XG4iLCBzYXZl
ZCk7CisKKwlpZ3Rfc3lzZnNfcHJpbnRmKGVuZ2luZSwgInRpbWVzbGljZV9kdXJhdGlvbl9tcyIs
IFBSSXU2NCwgLTEpOworCWlndF9zeXNmc19zY2FuZihlbmdpbmUsICJ0aW1lc2xpY2VfZHVyYXRp
b25fbXMiLCAiJXUiLCAmZGVsYXkpOworCWlndF9hc3NlcnRfZXEoZGVsYXksIHNhdmVkKTsKKwor
CWlndF9zeXNmc19wcmludGYoZW5naW5lLCAidGltZXNsaWNlX2R1cmF0aW9uX21zIiwgIiVkIiwg
LTEpOworCWlndF9zeXNmc19zY2FuZihlbmdpbmUsICJ0aW1lc2xpY2VfZHVyYXRpb25fbXMiLCAi
JXUiLCAmZGVsYXkpOworCWlndF9hc3NlcnRfZXEoZGVsYXksIHNhdmVkKTsKKworCWlndF9zeXNm
c19wcmludGYoZW5naW5lLCAidGltZXNsaWNlX2R1cmF0aW9uX21zIiwgUFJJdTY0LCAxMjN1bGwg
PDwgMzIpOworCWlndF9zeXNmc19zY2FuZihlbmdpbmUsICJ0aW1lc2xpY2VfZHVyYXRpb25fbXMi
LCAiJXUiLCAmZGVsYXkpOworCWlndF9hc3NlcnRfZXEoZGVsYXksIHNhdmVkKTsKK30KKworc3Rh
dGljIHZvaWQgc2V0X3VuYmFubmFibGUoaW50IGk5MTUsIHVpbnQzMl90IGN0eCkKK3sKKwlzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX2NvbnRleHRfcGFyYW0gcCA9IHsKKwkJLmN0eF9pZCA9IGN0eCwKKwkJ
LnBhcmFtID0gSTkxNV9DT05URVhUX1BBUkFNX0JBTk5BQkxFLAorCX07CisKKwlpZ3RfYXNzZXJ0
X2VxKF9fZ2VtX2NvbnRleHRfc2V0X3BhcmFtKGk5MTUsICZwKSwgMCk7Cit9CisKK3N0YXRpYyB1
aW50MzJfdCBjcmVhdGVfY29udGV4dChpbnQgaTkxNSwgdW5zaWduZWQgaW50IGNsYXNzLCB1bnNp
Z25lZCBpbnQgaW5zdCwgaW50IHByaW8pCit7CisJdWludDMyX3QgY3R4OworCisJY3R4ID0gZ2Vt
X2NvbnRleHRfY3JlYXRlX2Zvcl9lbmdpbmUoaTkxNSwgY2xhc3MsIGluc3QpOworCXNldF91bmJh
bm5hYmxlKGk5MTUsIGN0eCk7CisJZ2VtX2NvbnRleHRfc2V0X3ByaW9yaXR5KGk5MTUsIGN0eCwg
cHJpbyk7CisKKwlyZXR1cm4gY3R4OworfQorCitzdGF0aWMgdWludDY0X3QgX190ZXN0X3RpbWVv
dXQoaW50IGk5MTUsIGludCBlbmdpbmUsIHVuc2lnbmVkIGludCB0aW1lb3V0KQoreworCXVuc2ln
bmVkIGludCBjbGFzcywgaW5zdDsKKwlzdHJ1Y3QgdGltZXNwZWMgdHMgPSB7fTsKKwlpZ3Rfc3Bp
bl90ICpzcGluWzJdOworCXVpbnQ2NF90IGVsYXBzZWQ7CisJdWludDMyX3QgY3R4WzJdOworCisJ
aWd0X2Fzc2VydChpZ3Rfc3lzZnNfc2NhbmYoZW5naW5lLCAiY2xhc3MiLCAiJXUiLCAmY2xhc3Mp
ID09IDEpOworCWlndF9hc3NlcnQoaWd0X3N5c2ZzX3NjYW5mKGVuZ2luZSwgImluc3RhbmNlIiwg
IiV1IiwgJmluc3QpID09IDEpOworCisJaWd0X3N5c2ZzX3ByaW50ZihlbmdpbmUsICJ0aW1lc2xp
Y2VfZHVyYXRpb25fbXMiLCAiJXUiLCB0aW1lb3V0KTsKKworCWN0eFswXSA9IGNyZWF0ZV9jb250
ZXh0KGk5MTUsIGNsYXNzLCBpbnN0LCAwKTsKKwlzcGluWzBdID0gaWd0X3NwaW5fbmV3KGk5MTUs
IGN0eFswXSwKKwkJCSAgICAgICAuZmxhZ3MgPSAoSUdUX1NQSU5fTk9fUFJFRU1QVElPTiB8CisJ
CQkJCSBJR1RfU1BJTl9QT0xMX1JVTiB8CisJCQkJCSBJR1RfU1BJTl9GRU5DRV9PVVQpKTsKKwlp
Z3Rfc3Bpbl9idXN5d2FpdF91bnRpbF9zdGFydGVkKHNwaW5bMF0pOworCisJY3R4WzFdID0gY3Jl
YXRlX2NvbnRleHQoaTkxNSwgY2xhc3MsIGluc3QsIDApOworCWlndF9uc2VjX2VsYXBzZWQoJnRz
KTsKKwlzcGluWzFdID0gaWd0X3NwaW5fbmV3KGk5MTUsIGN0eFsxXSwgLmZsYWdzID0gSUdUX1NQ
SU5fUE9MTF9SVU4pOworCWlndF9zcGluX2J1c3l3YWl0X3VudGlsX3N0YXJ0ZWQoc3BpblsxXSk7
CisJZWxhcHNlZCA9IGlndF9uc2VjX2VsYXBzZWQoJnRzKTsKKworCWlndF9zcGluX2ZyZWUoaTkx
NSwgc3BpblsxXSk7CisKKwlpZ3RfYXNzZXJ0X2VxKHN5bmNfZmVuY2Vfd2FpdChzcGluWzBdLT5v
dXRfZmVuY2UsIDEpLCAwKTsKKwlpZ3RfYXNzZXJ0X2VxKHN5bmNfZmVuY2Vfc3RhdHVzKHNwaW5b
MF0tPm91dF9mZW5jZSksIC1FSU8pOworCisJaWd0X3NwaW5fZnJlZShpOTE1LCBzcGluWzBdKTsK
KworCWdlbV9jb250ZXh0X2Rlc3Ryb3koaTkxNSwgY3R4WzFdKTsKKwlnZW1fY29udGV4dF9kZXN0
cm95KGk5MTUsIGN0eFswXSk7CisJZ2VtX3F1aWVzY2VudF9ncHUoaTkxNSk7CisKKwlyZXR1cm4g
ZWxhcHNlZDsKK30KKworc3RhdGljIHZvaWQgdGVzdF90aW1lb3V0KGludCBpOTE1LCBpbnQgZW5n
aW5lKQoreworCWludCBkZWxheXNbXSA9IHsgMSwgNTAsIDEwMCwgNTAwIH07CisJdW5zaWduZWQg
aW50IHNhdmVkLCBkZWxheTsKKworCWlndF9yZXF1aXJlKGlndF9zeXNmc19wcmludGYoZW5naW5l
LCAicHJlZW1wdF90aW1lb3V0X21zIiwgIiV1IiwgMSkgPT0gMSk7CisJaWd0X2Fzc2VydChpZ3Rf
c3lzZnNfc2NhbmYoZW5naW5lLCAidGltZXNsaWNlX2R1cmF0aW9uX21zIiwgIiV1IiwgJnNhdmVk
KSA9PSAxKTsKKwlpZ3RfZGVidWcoIkluaXRpYWwgdGltZXNsaWNlX2R1cmF0aW9uX21zOiV1XG4i
LCBzYXZlZCk7CisKKwlnZW1fcXVpZXNjZW50X2dwdShpOTE1KTsKKwlpZ3RfcmVxdWlyZShlbmFi
bGVfaGFuZ2NoZWNrKGk5MTUsIGZhbHNlKSk7CisKKwlmb3IgKGludCBpID0gMDsgaSA8IEFSUkFZ
X1NJWkUoZGVsYXlzKTsgaSsrKSB7CisJCXVpbnQ2NF90IGVsYXBzZWQ7CisKKwkJZWxhcHNlZCA9
IF9fdGVzdF90aW1lb3V0KGk5MTUsIGVuZ2luZSwgZGVsYXlzW2ldKTsKKwkJaWd0X2luZm8oInRp
bWVzbGljZV9kdXJhdGlvbl9tczolZCwgZWxhcHNlZD0lLjNmbXNcbiIsCisJCQkgZGVsYXlzW2ld
LCBlbGFwc2VkICogMWUtNik7CisKKwkJLyoKKwkJICogV2UgbmVlZCB0byBnaXZlIGEgY291cGxl
IG9mIGppZmZpZXMgc2xhY2sgZm9yIHRoZSBzY2hlZHVsZXIgdGltZW91dHMKKwkJICogYW5kIHRo
ZW4gYSBsaXR0bGUgbW9yZSBzbGFjayBmciB0aGUgb3ZlcmhlYWQgaW4gc3VibWl0dGluZyBhbmQK
KwkJICogbWVhc3VyaW5nLiA1MG1zIHNob3VsZCBjb3ZlciBhbGwgb2Ygb3VyIHNpbnMgYW5kIGJl
IHVzZWZ1bAorCQkgKiB0b2xlcmFuY2UuCisJCSAqLworCQlpZ3RfYXNzZXJ0X2YoZWxhcHNlZCAv
IDEwMDAgLyAxMDAwIDwgZGVsYXkgKyA1MCwKKwkJCSAgICAgIkZvcmNlZCBwcmVlbXB0aW9uIHRp
bWVvdXQgZXhjZWVkZWQgcmVxdWVzdCFcbiIpOworCisJfQorCisJaWd0X2Fzc2VydChlbmFibGVf
aGFuZ2NoZWNrKGk5MTUsIHRydWUpKTsKKwlnZW1fcXVpZXNjZW50X2dwdShpOTE1KTsKKworCXNl
dF90aW1lc2xpY2UoZW5naW5lLCBzYXZlZCk7Cit9CisKK3N0YXRpYyB2b2lkIHRlc3Rfb2ZmKGlu
dCBpOTE1LCBpbnQgZW5naW5lKQoreworCXVuc2lnbmVkIGludCBjbGFzcywgaW5zdDsKKwl1bnNp
Z25lZCBpbnQgc2F2ZWQ7CisJaWd0X3NwaW5fdCAqc3BpblsyXTsKKwl1aW50MzJfdCBjdHhbMl07
CisKKwlpZ3RfcmVxdWlyZShpZ3Rfc3lzZnNfcHJpbnRmKGVuZ2luZSwgInByZWVtcHRfdGltZW91
dF9tcyIsICIldSIsIDEpID09IDEpOworCWlndF9hc3NlcnQoaWd0X3N5c2ZzX3NjYW5mKGVuZ2lu
ZSwgInRpbWVzbGljZV9kdXJhdGlvbl9tcyIsICIldSIsICZzYXZlZCkgPT0gMSk7CisJaWd0X2Rl
YnVnKCJJbml0aWFsIHRpbWVzbGljZV9kdXJhdGlvbl9tczoldVxuIiwgc2F2ZWQpOworCisJZ2Vt
X3F1aWVzY2VudF9ncHUoaTkxNSk7CisJaWd0X3JlcXVpcmUoZW5hYmxlX2hhbmdjaGVjayhpOTE1
LCBmYWxzZSkpOworCisJaWd0X2Fzc2VydChpZ3Rfc3lzZnNfc2NhbmYoZW5naW5lLCAiY2xhc3Mi
LCAiJXUiLCAmY2xhc3MpID09IDEpOworCWlndF9hc3NlcnQoaWd0X3N5c2ZzX3NjYW5mKGVuZ2lu
ZSwgImluc3RhbmNlIiwgIiV1IiwgJmluc3QpID09IDEpOworCisJaWd0X3N5c2ZzX3ByaW50Zihl
bmdpbmUsICJ0aW1lc2xpY2VfZHVyYXRpb25fbXMiLCAiJXUiLCAwKTsKKworCWN0eFswXSA9IGNy
ZWF0ZV9jb250ZXh0KGk5MTUsIGNsYXNzLCBpbnN0LCAwKTsKKwlzcGluWzBdID0gaWd0X3NwaW5f
bmV3KGk5MTUsIGN0eFswXSwKKwkJCSAgICAgICAuZmxhZ3MgPSAoSUdUX1NQSU5fTk9fUFJFRU1Q
VElPTiB8CisJCQkJCSBJR1RfU1BJTl9QT0xMX1JVTiB8CisJCQkJCSBJR1RfU1BJTl9GRU5DRV9P
VVQpKTsKKwlpZ3Rfc3Bpbl9idXN5d2FpdF91bnRpbF9zdGFydGVkKHNwaW5bMF0pOworCisJY3R4
WzFdID0gY3JlYXRlX2NvbnRleHQoaTkxNSwgY2xhc3MsIGluc3QsIDApOworCXNwaW5bMV0gPSBp
Z3Rfc3Bpbl9uZXcoaTkxNSwgY3R4WzFdLCAuZmxhZ3MgPSBJR1RfU1BJTl9QT0xMX1JVTik7CisK
Kwlmb3IgKGludCBpID0gMDsgaSA8IDE1MDsgaSsrKSB7CisJCWlndF9hc3NlcnRfZXEoc3luY19m
ZW5jZV9zdGF0dXMoc3BpblswXS0+b3V0X2ZlbmNlKSwgMCk7CisJCXNsZWVwKDEpOworCX0KKwor
CWlndF9zeXNmc19wcmludGYoZW5naW5lLCAidGltZXNsaWNlX2R1cmF0aW9uX21zIiwgIiV1Iiwg
MSk7CisKKwlpZ3Rfc3Bpbl9idXN5d2FpdF91bnRpbF9zdGFydGVkKHNwaW5bMV0pOworCWlndF9z
cGluX2ZyZWUoaTkxNSwgc3BpblsxXSk7CisKKwlpZ3RfYXNzZXJ0X2VxKHN5bmNfZmVuY2Vfd2Fp
dChzcGluWzBdLT5vdXRfZmVuY2UsIDEpLCAwKTsKKwlpZ3RfYXNzZXJ0X2VxKHN5bmNfZmVuY2Vf
c3RhdHVzKHNwaW5bMF0tPm91dF9mZW5jZSksIC1FSU8pOworCisJaWd0X3NwaW5fZnJlZShpOTE1
LCBzcGluWzBdKTsKKworCWdlbV9jb250ZXh0X2Rlc3Ryb3koaTkxNSwgY3R4WzFdKTsKKwlnZW1f
Y29udGV4dF9kZXN0cm95KGk5MTUsIGN0eFswXSk7CisKKwlpZ3RfYXNzZXJ0KGVuYWJsZV9oYW5n
Y2hlY2soaTkxNSwgdHJ1ZSkpOworCWdlbV9xdWllc2NlbnRfZ3B1KGk5MTUpOworCisJc2V0X3Rp
bWVzbGljZShlbmdpbmUsIHNhdmVkKTsKK30KKworaWd0X21haW4KK3sKKwlpbnQgaTkxNSwgc3lz
ID0gLTE7CisJc3RydWN0IGRpcmVudCAqZGU7CisJaW50IGVuZ2luZXM7CisJRElSICpkaXI7CisK
KwlpZ3RfZml4dHVyZSB7CisJCWk5MTUgPSBkcm1fb3Blbl9kcml2ZXIoRFJJVkVSX0lOVEVMKTsK
KwkJaWd0X3JlcXVpcmVfZ2VtKGk5MTUpOworCisJCXN5cyA9IGlndF9zeXNmc19vcGVuKGk5MTUp
OworCQlpZ3RfcmVxdWlyZShzeXMgIT0gLTEpOworCX0KKworCWVuZ2luZXMgPSBvcGVuYXQoc3lz
LCAiZW5naW5lIiwgT19SRE9OTFkpOworCWRpciA9IGZkb3BlbmRpcihlbmdpbmVzKTsKKwl3aGls
ZSAoZGlyICYmIChkZSA9IHJlYWRkaXIoZGlyKSkpIHsKKwkJaW50IGVuZ2luZSA9IG9wZW5hdChl
bmdpbmVzLCBkZS0+ZF9uYW1lLCBPX1JET05MWSk7CisJCXN0cnVjdCBzdGF0IHN0OworCQljaGFy
ICpuYW1lOworCisJCW5hbWUgPSBpZ3Rfc3lzZnNfZ2V0KGVuZ2luZSwgIm5hbWUiKTsKKwkJaWYg
KCFuYW1lKQorCQkJY29udGludWU7CisKKwkJaWd0X3N1YnRlc3RfZ3JvdXAgeworCQkJaWd0X2Zp
eHR1cmUgeworCQkJCWlndF9yZXF1aXJlKGZzdGF0YXQoZW5naW5lLAorCQkJCQkJICAgICJ0aW1l
c2xpY2VfZHVyYXRpb25fbXMiLAorCQkJCQkJICAgICZzdCwgMCkgPT0gMCk7CisJCQl9CisKKwkJ
CWlndF9zdWJ0ZXN0X2YoIiVzLWlkZW1wb3RlbnQiLCBuYW1lKQorCQkJCXRlc3RfaWRlbXBvdGVu
dChpOTE1LCBlbmdpbmUpOworCQkJaWd0X3N1YnRlc3RfZigiJXMtaW52YWxpZCIsIG5hbWUpCisJ
CQkJdGVzdF9pbnZhbGlkKGk5MTUsIGVuZ2luZSk7CisJCQlpZ3Rfc3VidGVzdF9mKCIlcy10aW1l
b3V0IiwgbmFtZSkKKwkJCQl0ZXN0X3RpbWVvdXQoaTkxNSwgZW5naW5lKTsKKwkJCWlndF9zdWJ0
ZXN0X2YoIiVzLW9mZiIsIG5hbWUpCisJCQkJdGVzdF9vZmYoaTkxNSwgZW5naW5lKTsKKwkJfQor
CisJCWZyZWUobmFtZSk7CisJCWNsb3NlKGVuZ2luZSk7CisJfQorCisJaWd0X2ZpeHR1cmUgewor
CQljbG9zZShzeXMpOworCQljbG9zZShpOTE1KTsKKwl9Cit9CmRpZmYgLS1naXQgYS90ZXN0cy9t
ZXNvbi5idWlsZCBiL3Rlc3RzL21lc29uLmJ1aWxkCmluZGV4IDIzZjczMGMyMC4uZjYwM2FiM2Uw
IDEwMDY0NAotLS0gYS90ZXN0cy9tZXNvbi5idWlsZAorKysgYi90ZXN0cy9tZXNvbi5idWlsZApA
QCAtMjQwLDYgKzI0MCw3IEBAIGk5MTVfcHJvZ3MgPSBbCiAJJ2k5MTVfc3VzcGVuZCcsCiAJJ3N5
c2ZzX2hlYXJ0YmVhdF9pbnRlcnZhbCcsCiAJJ3N5c2ZzX3ByZWVtcHRpb25fdGltZW91dCcsCisJ
J3N5c2ZzX3RpbWVzbGljZV9kdXJhdGlvbicsCiBdCiAKIHRlc3RfZGVwcyA9IFsgaWd0X2RlcHMg
XQotLSAKMi4yMy4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5v
cmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1n
Zng=

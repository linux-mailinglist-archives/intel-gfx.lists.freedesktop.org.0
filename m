Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 7EE525FDB7
	for <lists+intel-gfx@lfdr.de>; Thu,  4 Jul 2019 22:17:14 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B4E116E3E9;
	Thu,  4 Jul 2019 20:17:12 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E37A46E3E9
 for <intel-gfx@lists.freedesktop.org>; Thu,  4 Jul 2019 20:17:10 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17134087-1500050 
 for multiple; Thu, 04 Jul 2019 21:16:58 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu,  4 Jul 2019 21:16:56 +0100
Message-Id: <20190704201656.15775-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915/gtt: Mark the freed page table entries
 with scratch
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Mika Kuoppala <mika.kuoppala@intel.com>,
 Matthew Auld <matthew.auld@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T24gdW53aW5kaW5nIHRoZSBhbGxvY2F0aW9uIGVycm9yIHBhdGggYW5kIGhhdmluZyBmcmVlZCB0
aGUgcGFnZSB0YWJsZQplbnRyeSwgaXQgaXMgaW1wZXJhdGl2ZSB0aGF0IHdlIG1hcmsgaXQgYXMg
c2NyYXRjaC4KCjw0PiBbNDE2LjA3NTU2OV0gZ2VuZXJhbCBwcm90ZWN0aW9uIGZhdWx0OiAwMDAw
IFsjMV0gUFJFRU1QVCBTTVAgUFRJCjw0PiBbNDE2LjA3NTgwMV0gQ1BVOiAwIFBJRDogMjM4NSBD
b21tOiBrd29ya2VyL3UyOjExIFRhaW50ZWQ6IEcgICAgIFUgICAgICAgICAgICA1LjIuMC1yYzct
Q0ktUGF0Y2h3b3JrXzEzNTM0KyAjMQo8ND4gWzQxNi4wNzYxNjJdIEhhcmR3YXJlIG5hbWU6IFFF
TVUgU3RhbmRhcmQgUEMgKGk0NDBGWCArIFBJSVgsIDE5OTYpLCBCSU9TIHJlbC0xLjEwLjEtMC1n
ODg5MTY5Ny1wcmVidWlsdC5xZW11LXByb2plY3Qub3JnIDA0LzAxLzIwMTQKPDQ+IFs0MTYuMDc2
NTIyXSBXb3JrcXVldWU6IGk5MTUgX19pOTE1X3ZtX3JlbGVhc2UgW2k5MTVdCjw0PiBbNDE2LjA3
Njc1NF0gUklQOiAwMDEwOmdlbjhfcHBndHRfY2xlYW51cF8zbHZsKzB4NTgvMHhiMCBbaTkxNV0K
PDQ+IFs0MTYuMDc3MDIzXSBDb2RlOiA4MSBlMiAwNCBmZSBmZiBmZiA4MSBjMiBmZiAwMSAwMCAw
MCA0YyA4ZCA3NCBkNiA1OCA0ZCA4YiA2NSAwMCA0ZCAzYiBhNyAyOCAwMiAwMCAwMCA3NCA0MCA0
OSA4ZCA1YyAyNCA1MCA0OSA4MSBjNCA1MCAxMCAwMCAwMCA8NDg+IDhiIDJiIDQ5IDNiIGFmIDIw
IDAyIDAwIDAwIDc0IDEzIDRjIDg5IGZmIDQ4IDg5IGVlIGU4IDAxIGZiIGZmCjw0PiBbNDE2LjA3
NzQ0NV0gUlNQOiAwMDE4OmZmZmZjOTAwMDA0NmJkOTggRUZMQUdTOiAwMDAxMDIwNgo8ND4gWzQx
Ni4wNzc2MjVdIFJBWDogMDAwMTAwMDAwMDAwMDAwMCBSQlg6IDZiNmI2YjZiNmI2YjZiYmIgUkNY
OiA4YjRiNTZkNTAwMDAwMDAwCjw0PiBbNDE2LjA3NzgzOF0gUkRYOiAwMDAwMDAwMDAwMDAwMWZm
IFJTSTogZmZmZjg4ODA1YTU3ODAwOCBSREk6IGZmZmY4ODgwNWJkMGVmYzgKPDQ+IFs0MTYuMDc4
MTY3XSBSQlA6IGZmZmY4ODgwNWJkMGVmYzggUjA4OiAwMDAwMDAwMDA0ZTQyYjkzIFIwOTogMDAw
MDAwMDAwMDAwMDAwMQo8ND4gWzQxNi4wNzgzODFdIFIxMDogMDAwMDAwMDAwMDAwMDAwMCBSMTE6
IGZmZmY4ODgwNzdhMWIwYjggUjEyOiA2YjZiNmI2YjZiNmI3YmJiCjw0PiBbNDE2LjA3ODU5NF0g
UjEzOiBmZmZmODg4MDVhNTc4MDU4IFIxNDogZmZmZjg4ODA1YTU3OTA1OCBSMTU6IGZmZmY4ODgw
NWJkMGVmYzgKPDQ+IFs0MTYuMDc4ODE1XSBGUzogIDAwMDAwMDAwMDAwMDAwMDAoMDAwMCkgR1M6
ZmZmZjg4ODA3ZGEwMDAwMCgwMDAwKSBrbmxHUzowMDAwMDAwMDAwMDAwMDAwCjw0PiBbNDE2LjA3
OTM5NV0gQ1M6ICAwMDEwIERTOiAwMDAwIEVTOiAwMDAwIENSMDogMDAwMDAwMDA4MDA1MDAzMwo8
ND4gWzQxNi4wNzk4NTFdIENSMjogMDAwMDU2MTYwZmVjMmIxNCBDUjM6IDAwMDAwMDAwNzFiYmMw
MDMgQ1I0OiAwMDAwMDAwMDAwMzYwNmYwCjw0PiBbNDE2LjA4MDM4OF0gQ2FsbCBUcmFjZToKPDQ+
IFs0MTYuMDgwODI4XSAgZ2VuOF9wcGd0dF9jbGVhbnVwKzB4NjQvMHgxMDAgW2k5MTVdCjw0PiBb
NDE2LjA4MTM5OV0gIF9faTkxNV92bV9yZWxlYXNlKzB4ZmMvMHgxZDAgW2k5MTVdCgpGaXhlczog
MWQxYjU0OTBiOTFjICgiZHJtL2k5MTUvZ3R0OiBSZXBsYWNlIHN0cnVjdF9tdXRleCBzZXJpYWxp
c2F0aW9uIGZvciBhbGxvY2F0aW9uIikKU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJp
c0BjaHJpcy13aWxzb24uY28udWs+CkNjOiBNYXR0aGV3IEF1bGQgPG1hdHRoZXcuYXVsZEBpbnRl
bC5jb20+CkNjOiBNaWthIEt1b3BwYWxhIDxtaWthLmt1b3BwYWxhQGludGVsLmNvbT4KLS0tCkFu
b3RoZXIgZGF5LCBhbm90aGVyIGVycm9yIHBhdGggZml4LgotLS0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZ2VtX2d0dC5jIHwgMiArKwogMSBmaWxlIGNoYW5nZWQsIDIgaW5zZXJ0aW9ucygr
KQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMKaW5kZXggOTc1NmYxYjY3MGU5Li41N2Ri
MmQ3MjcwYzUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jCkBAIC0xNDkxLDYgKzE0
OTEsNyBAQCBzdGF0aWMgaW50IGdlbjhfcHBndHRfYWxsb2NfcGRwKHN0cnVjdCBpOTE1X2FkZHJl
c3Nfc3BhY2UgKnZtLAogCXNwaW5fbG9jaygmcGRwLT5sb2NrKTsKIAlpZiAoYXRvbWljX2RlY19h
bmRfdGVzdCgmcGQtPnVzZWQpKSB7CiAJCWdlbjhfcHBndHRfc2V0X3BkcGUocGRwLCB2bS0+c2Ny
YXRjaF9wZCwgcGRwZSk7CisJCXBkcC0+ZW50cnlbcGRwZV0gPSB2bS0+c2NyYXRjaF9wZDsKIAkJ
R0VNX0JVR19PTighYXRvbWljX3JlYWQoJnBkcC0+dXNlZCkpOwogCQlhdG9taWNfZGVjKCZwZHAt
PnVzZWQpOwogCQlHRU1fQlVHX09OKGFsbG9jKTsKQEAgLTE1NjcsNiArMTU2OCw3IEBAIHN0YXRp
YyBpbnQgZ2VuOF9wcGd0dF9hbGxvY180bHZsKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZt
LAogCXNwaW5fbG9jaygmcG1sNC0+bG9jayk7CiAJaWYgKGF0b21pY19kZWNfYW5kX3Rlc3QoJnBk
cC0+dXNlZCkpIHsKIAkJZ2VuOF9wcGd0dF9zZXRfcG1sNGUocG1sNCwgdm0tPnNjcmF0Y2hfcGRw
LCBwbWw0ZSk7CisJCXBtbDQtPmVudHJ5W3BtbDRlXSA9IHZtLT5zY3JhdGNoX3BkcDsKIAkJR0VN
X0JVR19PTihhbGxvYyk7CiAJCWFsbG9jID0gcGRwOyAvKiBkZWZlciB0aGUgZnJlZSB1bnRpbCBh
ZnRlciB0aGUgbG9jayAqLwogCX0KLS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhA
bGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxt
YW4vbGlzdGluZm8vaW50ZWwtZ2Z4

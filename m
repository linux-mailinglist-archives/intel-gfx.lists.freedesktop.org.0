Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 46530C9AD9
	for <lists+intel-gfx@lfdr.de>; Thu,  3 Oct 2019 11:36:58 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E6E136E990;
	Thu,  3 Oct 2019 09:36:54 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id DA9D76E984
 for <intel-gfx@lists.freedesktop.org>; Thu,  3 Oct 2019 09:36:50 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18704191-1500050 
 for multiple; Thu, 03 Oct 2019 10:36:44 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu,  3 Oct 2019 10:36:33 +0100
Message-Id: <20191003093639.10186-17-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191003093639.10186-1-chris@chris-wilson.co.uk>
References: <20191003093639.10186-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 16/22] drm/i915: Move context management under
 GEM
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

S2VlcCB0cmFjayBvZiB0aGUgR0VNIGNvbnRleHRzIHVuZGVybmVhdGggaTkxNS0+Z2VtLmNvbnRl
eHRzIGFuZCBhc3NpZ24KdGhlbSB0aGVpciBvd24gbG9jayBmb3IgdGhlIHB1cnBvc2VzIG9mIGxp
c3QgbWFuYWdlbWVudC4KCnYyOiBGb2N1cyBvbiBsb2NrIHRyYWNraW5nOyBjdHgtPnZtIGlzIHBy
b3RlY3RlZCBieSBjdHgtPm11dGV4CgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlz
QGNocmlzLXdpbHNvbi5jby51az4KQ2M6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBp
bnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQu
YyAgIHwgMTcwICsrKysrKysrLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5
MTVfZ2VtX2NvbnRleHQuaCAgIHwgIDI3ICsrLQogLi4uL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fY29udGV4dF90eXBlcy5oIHwgICAyICstCiAuLi4vZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9leGVjYnVmZmVyLmMgICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV91c2VycHRyLmMgICB8ICAgMyArLQogLi4uL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3Rz
L2h1Z2VfcGFnZXMuYyAgIHwgIDM2ICsrLS0KIC4uLi9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5
MTVfZ2VtX2NvbnRleHQuYyB8IDE2NiArKysrKysrKy0tLS0tLS0tLQogLi4uL2dwdS9kcm0vaTkx
NS9nZW0vc2VsZnRlc3RzL21vY2tfY29udGV4dC5jIHwgICA0ICstCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9jb250ZXh0LmMgICAgICAgfCAgMTAgKy0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2xyYy5jICAgICAgICAgICB8ICAgNSArCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9zZWxmdGVzdF9jb250ZXh0LmMgICAgfCAgMjQgKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9zZWxmdGVzdF9oYW5nY2hlY2suYyAgfCAgMzkgKystLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Qvc2VsZnRlc3RfbHJjLmMgICAgICAgIHwgICA2ICstCiAuLi4vZ3B1L2RybS9pOTE1L2d0
L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMgICAgfCAgMTAgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2d2dC9zY2hlZHVsZXIuYyAgICAgICAgICB8ICAyNCArLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZGVidWdmcy5jICAgICAgICAgICB8ICA1MCArKystLS0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZHJ2LmMgICAgICAgICAgICAgICB8ICAgMiAtCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2Rydi5oICAgICAgICAgICAgICAgfCAgMjcgKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2dlbS5jICAgICAgICAgICAgICAgfCAgMTAgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZ2VtX2d0dC5jICAgICAgICAgICB8ICAgNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9wZXJmLmMgICAgICAgICAgICAgIHwgIDI0ICsrLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9zeXNmcy5jICAgICAgICAgICAgIHwgIDc3ICsrKystLS0tCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3RyYWNlLmggICAgICAgICAgICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbS5jICAgICB8ICAgOCAtCiAuLi4vZ3B1L2RybS9pOTE1L3Nl
bGZ0ZXN0cy9pOTE1X2dlbV9ldmljdC5jICAgfCAgIDMgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
c2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jIHwgIDExICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9z
ZWxmdGVzdHMvaTkxNV9yZXF1ZXN0LmMgfCAgMTIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L3Nl
bGZ0ZXN0cy9pOTE1X3ZtYS5jICAgICB8ICAgNyArLQogLi4uL2dwdS9kcm0vaTkxNS9zZWxmdGVz
dHMvbW9ja19nZW1fZGV2aWNlLmMgIHwgICA2ICstCiAyOSBmaWxlcyBjaGFuZ2VkLCAzODYgaW5z
ZXJ0aW9ucygrKSwgMzg1IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fY29udGV4dC5jCmluZGV4IGFlNTg4NTQ0YmYzYS4uMzIzYmNiZDFmOTQ1IDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKQEAgLTIxOCw5ICsy
MTgsMTIgQEAgc3RhdGljIHN0cnVjdCBpOTE1X2dlbV9lbmdpbmVzICpkZWZhdWx0X2VuZ2luZXMo
c3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKIAogc3RhdGljIHZvaWQgaTkxNV9nZW1fY29u
dGV4dF9mcmVlKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCiB7Ci0JbG9ja2RlcF9hc3Nl
cnRfaGVsZCgmY3R4LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlHRU1fQlVHX09OKCFpOTE1
X2dlbV9jb250ZXh0X2lzX2Nsb3NlZChjdHgpKTsKIAorCXNwaW5fbG9jaygmY3R4LT5pOTE1LT5n
ZW0uY29udGV4dHMubG9jayk7CisJbGlzdF9kZWwoJmN0eC0+bGluayk7CisJc3Bpbl91bmxvY2so
JmN0eC0+aTkxNS0+Z2VtLmNvbnRleHRzLmxvY2spOworCiAJZnJlZV9lbmdpbmVzKHJjdV9hY2Nl
c3NfcG9pbnRlcihjdHgtPmVuZ2luZXMpKTsKIAltdXRleF9kZXN0cm95KCZjdHgtPmVuZ2luZXNf
bXV0ZXgpOwogCkBAIC0yMzAsNjcgKzIzMyw1NCBAQCBzdGF0aWMgdm9pZCBpOTE1X2dlbV9jb250
ZXh0X2ZyZWUoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKIAlrZnJlZShjdHgtPm5hbWUp
OwogCXB1dF9waWQoY3R4LT5waWQpOwogCi0JbGlzdF9kZWwoJmN0eC0+bGluayk7CiAJbXV0ZXhf
ZGVzdHJveSgmY3R4LT5tdXRleCk7CiAKIAlrZnJlZV9yY3UoY3R4LCByY3UpOwogfQogCi1zdGF0
aWMgdm9pZCBjb250ZXh0c19mcmVlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQorc3Rh
dGljIHZvaWQgY29udGV4dHNfZnJlZV9hbGwoc3RydWN0IGxsaXN0X25vZGUgKmxpc3QpCiB7Ci0J
c3RydWN0IGxsaXN0X25vZGUgKmZyZWVkID0gbGxpc3RfZGVsX2FsbCgmaTkxNS0+Y29udGV4dHMu
ZnJlZV9saXN0KTsKIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LCAqY247CiAKLQlsb2Nr
ZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQotCWxsaXN0X2Zvcl9l
YWNoX2VudHJ5X3NhZmUoY3R4LCBjbiwgZnJlZWQsIGZyZWVfbGluaykKKwlsbGlzdF9mb3JfZWFj
aF9lbnRyeV9zYWZlKGN0eCwgY24sIGxpc3QsIGZyZWVfbGluaykKIAkJaTkxNV9nZW1fY29udGV4
dF9mcmVlKGN0eCk7CiB9CiAKLXN0YXRpYyB2b2lkIGNvbnRleHRzX2ZyZWVfZmlyc3Qoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCitzdGF0aWMgdm9pZCBjb250ZXh0c19mbHVzaF9mcmVl
KHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0cyAqZ2MpCiB7Ci0Jc3RydWN0IGk5MTVfZ2VtX2NvbnRl
eHQgKmN0eDsKLQlzdHJ1Y3QgbGxpc3Rfbm9kZSAqZnJlZWQ7Ci0KLQlsb2NrZGVwX2Fzc2VydF9o
ZWxkKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQotCWZyZWVkID0gbGxpc3RfZGVsX2ZpcnN0
KCZpOTE1LT5jb250ZXh0cy5mcmVlX2xpc3QpOwotCWlmICghZnJlZWQpCi0JCXJldHVybjsKLQot
CWN0eCA9IGNvbnRhaW5lcl9vZihmcmVlZCwgdHlwZW9mKCpjdHgpLCBmcmVlX2xpbmspOwotCWk5
MTVfZ2VtX2NvbnRleHRfZnJlZShjdHgpOworCWNvbnRleHRzX2ZyZWVfYWxsKGxsaXN0X2RlbF9h
bGwoJmdjLT5mcmVlX2xpc3QpKTsKIH0KIAogc3RhdGljIHZvaWQgY29udGV4dHNfZnJlZV93b3Jr
ZXIoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0KLQkJY29udGFpbmVyX29mKHdvcmssIHR5cGVvZigqaTkxNSksIGNvbnRleHRzLmZy
ZWVfd29yayk7CisJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHRzICpnYyA9CisJCWNvbnRhaW5lcl9v
Zih3b3JrLCB0eXBlb2YoKmdjKSwgZnJlZV93b3JrKTsKIAotCW11dGV4X2xvY2soJmk5MTUtPmRy
bS5zdHJ1Y3RfbXV0ZXgpOwotCWNvbnRleHRzX2ZyZWUoaTkxNSk7Ci0JbXV0ZXhfdW5sb2NrKCZp
OTE1LT5kcm0uc3RydWN0X211dGV4KTsKKwljb250ZXh0c19mbHVzaF9mcmVlKGdjKTsKIH0KIAog
dm9pZCBpOTE1X2dlbV9jb250ZXh0X3JlbGVhc2Uoc3RydWN0IGtyZWYgKnJlZikKIHsKIAlzdHJ1
Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4ID0gY29udGFpbmVyX29mKHJlZiwgdHlwZW9mKCpjdHgp
LCByZWYpOwotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gY3R4LT5pOTE1OworCXN0
cnVjdCBpOTE1X2dlbV9jb250ZXh0cyAqZ2MgPSAmY3R4LT5pOTE1LT5nZW0uY29udGV4dHM7CiAK
IAl0cmFjZV9pOTE1X2NvbnRleHRfZnJlZShjdHgpOwotCWlmIChsbGlzdF9hZGQoJmN0eC0+ZnJl
ZV9saW5rLCAmaTkxNS0+Y29udGV4dHMuZnJlZV9saXN0KSkKLQkJcXVldWVfd29yayhpOTE1LT53
cSwgJmk5MTUtPmNvbnRleHRzLmZyZWVfd29yayk7CisJaWYgKGxsaXN0X2FkZCgmY3R4LT5mcmVl
X2xpbmssICZnYy0+ZnJlZV9saXN0KSkKKwkJcXVldWVfd29yayhjdHgtPmk5MTUtPndxLCAmZ2Mt
PmZyZWVfd29yayk7CiB9CiAKIHN0YXRpYyB2b2lkIGNvbnRleHRfY2xvc2Uoc3RydWN0IGk5MTVf
Z2VtX2NvbnRleHQgKmN0eCkKIHsKLQlpOTE1X2dlbV9jb250ZXh0X3NldF9jbG9zZWQoY3R4KTsK
KwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsKIAotCWlmIChjdHgtPnZtKQotCQlpOTE1
X3ZtX2Nsb3NlKGN0eC0+dm0pOworCWk5MTVfZ2VtX2NvbnRleHRfc2V0X2Nsb3NlZChjdHgpOwog
CiAJbXV0ZXhfbG9jaygmY3R4LT5tdXRleCk7CiAKKwl2bSA9IGk5MTVfZ2VtX2NvbnRleHRfdm0o
Y3R4KTsKKwlpZiAodm0pCisJCWk5MTVfdm1fY2xvc2Uodm0pOworCiAJY3R4LT5maWxlX3ByaXYg
PSBFUlJfUFRSKC1FQkFERik7CiAKIAkvKgpAQCAtMzE3LDcgKzMwNyw2IEBAIF9fY3JlYXRlX2Nv
bnRleHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJCXJldHVybiBFUlJfUFRSKC1F
Tk9NRU0pOwogCiAJa3JlZl9pbml0KCZjdHgtPnJlZik7Ci0JbGlzdF9hZGRfdGFpbCgmY3R4LT5s
aW5rLCAmaTkxNS0+Y29udGV4dHMubGlzdCk7CiAJY3R4LT5pOTE1ID0gaTkxNTsKIAljdHgtPnNj
aGVkLnByaW9yaXR5ID0gSTkxNV9VU0VSX1BSSU9SSVRZKEk5MTVfUFJJT1JJVFlfTk9STUFMKTsK
IAltdXRleF9pbml0KCZjdHgtPm11dGV4KTsKQEAgLTM0Myw2ICszMzIsMTAgQEAgX19jcmVhdGVf
Y29udGV4dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAlmb3IgKGkgPSAwOyBpIDwg
QVJSQVlfU0laRShjdHgtPmhhbmdfdGltZXN0YW1wKTsgaSsrKQogCQljdHgtPmhhbmdfdGltZXN0
YW1wW2ldID0gamlmZmllcyAtIENPTlRFWFRfRkFTVF9IQU5HX0pJRkZJRVM7CiAKKwlzcGluX2xv
Y2soJmk5MTUtPmdlbS5jb250ZXh0cy5sb2NrKTsKKwlsaXN0X2FkZF90YWlsKCZjdHgtPmxpbmss
ICZpOTE1LT5nZW0uY29udGV4dHMubGlzdCk7CisJc3Bpbl91bmxvY2soJmk5MTUtPmdlbS5jb250
ZXh0cy5sb2NrKTsKKwogCXJldHVybiBjdHg7CiAKIGVycl9mcmVlOgpAQCAtMzcyLDExICszNjUs
MTEgQEAgc3RhdGljIHZvaWQgX19hcHBseV9wcGd0dChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2Us
IHZvaWQgKnZtKQogc3RhdGljIHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKgogX19zZXRfcHBn
dHQoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwgc3RydWN0IGk5MTVfYWRkcmVzc19zcGFj
ZSAqdm0pCiB7Ci0Jc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqb2xkID0gY3R4LT52bTsKKwlz
dHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICpvbGQgPSBpOTE1X2dlbV9jb250ZXh0X3ZtKGN0eCk7
CiAKIAlHRU1fQlVHX09OKG9sZCAmJiBpOTE1X3ZtX2lzXzRsdmwodm0pICE9IGk5MTVfdm1faXNf
NGx2bChvbGQpKTsKIAotCWN0eC0+dm0gPSBpOTE1X3ZtX29wZW4odm0pOworCXJjdV9hc3NpZ25f
cG9pbnRlcihjdHgtPnZtLCBpOTE1X3ZtX29wZW4odm0pKTsKIAljb250ZXh0X2FwcGx5X2FsbChj
dHgsIF9fYXBwbHlfcHBndHQsIHZtKTsKIAogCXJldHVybiBvbGQ7CkBAIC0zODUsNyArMzc4LDcg
QEAgX19zZXRfcHBndHQoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwgc3RydWN0IGk5MTVf
YWRkcmVzc19zcGFjZSAqdm0pCiBzdGF0aWMgdm9pZCBfX2Fzc2lnbl9wcGd0dChzdHJ1Y3QgaTkx
NV9nZW1fY29udGV4dCAqY3R4LAogCQkJICAgc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0p
CiB7Ci0JaWYgKHZtID09IGN0eC0+dm0pCisJaWYgKHZtID09IHJjdV9hY2Nlc3NfcG9pbnRlcihj
dHgtPnZtKSkKIAkJcmV0dXJuOwogCiAJdm0gPSBfX3NldF9wcGd0dChjdHgsIHZtKTsKQEAgLTQx
NywyNyArNDEwLDI1IEBAIHN0YXRpYyB2b2lkIF9fYXNzaWduX3RpbWVsaW5lKHN0cnVjdCBpOTE1
X2dlbV9jb250ZXh0ICpjdHgsCiB9CiAKIHN0YXRpYyBzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAq
Ci1pOTE1X2dlbV9jcmVhdGVfY29udGV4dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsIHVuc2lnbmVkIGludCBmbGFncykKK2k5MTVfZ2VtX2NyZWF0ZV9jb250ZXh0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LCB1bnNpZ25lZCBpbnQgZmxhZ3MpCiB7CiAJc3RydWN0IGk5
MTVfZ2VtX2NvbnRleHQgKmN0eDsKIAotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5k
cm0uc3RydWN0X211dGV4KTsKLQogCWlmIChmbGFncyAmIEk5MTVfQ09OVEVYVF9DUkVBVEVfRkxB
R1NfU0lOR0xFX1RJTUVMSU5FICYmCi0JICAgICFIQVNfRVhFQ0xJU1RTKGRldl9wcml2KSkKKwkg
ICAgIUhBU19FWEVDTElTVFMoaTkxNSkpCiAJCXJldHVybiBFUlJfUFRSKC1FSU5WQUwpOwogCi0J
LyogUmVhcCB0aGUgbW9zdCBzdGFsZSBjb250ZXh0ICovCi0JY29udGV4dHNfZnJlZV9maXJzdChk
ZXZfcHJpdik7CisJLyogUmVhcCB0aGUgc3RhbGUgY29udGV4dHMgKi8KKwljb250ZXh0c19mbHVz
aF9mcmVlKCZpOTE1LT5nZW0uY29udGV4dHMpOwogCi0JY3R4ID0gX19jcmVhdGVfY29udGV4dChk
ZXZfcHJpdik7CisJY3R4ID0gX19jcmVhdGVfY29udGV4dChpOTE1KTsKIAlpZiAoSVNfRVJSKGN0
eCkpCiAJCXJldHVybiBjdHg7CiAKLQlpZiAoSEFTX0ZVTExfUFBHVFQoZGV2X3ByaXYpKSB7CisJ
aWYgKEhBU19GVUxMX1BQR1RUKGk5MTUpKSB7CiAJCXN0cnVjdCBpOTE1X3BwZ3R0ICpwcGd0dDsK
IAotCQlwcGd0dCA9IGk5MTVfcHBndHRfY3JlYXRlKGRldl9wcml2KTsKKwkJcHBndHQgPSBpOTE1
X3BwZ3R0X2NyZWF0ZShpOTE1KTsKIAkJaWYgKElTX0VSUihwcGd0dCkpIHsKIAkJCURSTV9ERUJV
R19EUklWRVIoIlBQR1RUIHNldHVwIGZhaWxlZCAoJWxkKVxuIiwKIAkJCQkJIFBUUl9FUlIocHBn
dHQpKTsKQEAgLTQ1Miw3ICs0NDMsNyBAQCBpOTE1X2dlbV9jcmVhdGVfY29udGV4dChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHVuc2lnbmVkIGludCBmbGFncykKIAlpZiAoZmxh
Z3MgJiBJOTE1X0NPTlRFWFRfQ1JFQVRFX0ZMQUdTX1NJTkdMRV9USU1FTElORSkgewogCQlzdHJ1
Y3QgaW50ZWxfdGltZWxpbmUgKnRpbWVsaW5lOwogCi0JCXRpbWVsaW5lID0gaW50ZWxfdGltZWxp
bmVfY3JlYXRlKCZkZXZfcHJpdi0+Z3QsIE5VTEwpOworCQl0aW1lbGluZSA9IGludGVsX3RpbWVs
aW5lX2NyZWF0ZSgmaTkxNS0+Z3QsIE5VTEwpOwogCQlpZiAoSVNfRVJSKHRpbWVsaW5lKSkgewog
CQkJY29udGV4dF9jbG9zZShjdHgpOwogCQkJcmV0dXJuIEVSUl9DQVNUKHRpbWVsaW5lKTsKQEAg
LTQ5Nyw0OCArNDg4LDQwIEBAIGk5MTVfZ2VtX2NvbnRleHRfY3JlYXRlX2tlcm5lbChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50IHByaW8pCiAJcmV0dXJuIGN0eDsKIH0KIAotc3Rh
dGljIHZvaWQgaW5pdF9jb250ZXh0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKK3N0
YXRpYyB2b2lkIGluaXRfY29udGV4dHMoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHRzICpnYykKIHsK
LQltdXRleF9pbml0KCZpOTE1LT5jb250ZXh0cy5tdXRleCk7Ci0JSU5JVF9MSVNUX0hFQUQoJmk5
MTUtPmNvbnRleHRzLmxpc3QpOwotCi0JLyogVXNpbmcgdGhlIHNpbXBsZSBpZGEgaW50ZXJmYWNl
LCB0aGUgbWF4IGlzIGxpbWl0ZWQgYnkgc2l6ZW9mKGludCkgKi8KLQlCVUlMRF9CVUdfT04oTUFY
X0NPTlRFWFRfSFdfSUQgPiBJTlRfTUFYKTsKLQlCVUlMRF9CVUdfT04oR0VOMTFfTUFYX0NPTlRF
WFRfSFdfSUQgPiBJTlRfTUFYKTsKLQlpZGFfaW5pdCgmaTkxNS0+Y29udGV4dHMuaHdfaWRhKTsK
LQlJTklUX0xJU1RfSEVBRCgmaTkxNS0+Y29udGV4dHMuaHdfaWRfbGlzdCk7CisJc3Bpbl9sb2Nr
X2luaXQoJmdjLT5sb2NrKTsKKwlJTklUX0xJU1RfSEVBRCgmZ2MtPmxpc3QpOwogCi0JSU5JVF9X
T1JLKCZpOTE1LT5jb250ZXh0cy5mcmVlX3dvcmssIGNvbnRleHRzX2ZyZWVfd29ya2VyKTsKLQlp
bml0X2xsaXN0X2hlYWQoJmk5MTUtPmNvbnRleHRzLmZyZWVfbGlzdCk7CisJSU5JVF9XT1JLKCZn
Yy0+ZnJlZV93b3JrLCBjb250ZXh0c19mcmVlX3dvcmtlcik7CisJaW5pdF9sbGlzdF9oZWFkKCZn
Yy0+ZnJlZV9saXN0KTsKIH0KIAotaW50IGk5MTVfZ2VtX2NvbnRleHRzX2luaXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQoraW50IGk5MTVfZ2VtX2luaXRfY29udGV4dHMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7CiAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQg
KmN0eDsKIAogCS8qIFJlYXNzdXJlIG91cnNlbHZlcyB3ZSBhcmUgb25seSBjYWxsZWQgb25jZSAq
LwotCUdFTV9CVUdfT04oZGV2X3ByaXYtPmtlcm5lbF9jb250ZXh0KTsKKwlHRU1fQlVHX09OKGk5
MTUtPmtlcm5lbF9jb250ZXh0KTsKIAotCWluaXRfY29udGV4dHMoZGV2X3ByaXYpOworCWluaXRf
Y29udGV4dHMoJmk5MTUtPmdlbS5jb250ZXh0cyk7CiAKIAkvKiBsb3dlc3QgcHJpb3JpdHk7IGlk
bGUgdGFzayAqLwotCWN0eCA9IGk5MTVfZ2VtX2NvbnRleHRfY3JlYXRlX2tlcm5lbChkZXZfcHJp
diwgSTkxNV9QUklPUklUWV9NSU4pOworCWN0eCA9IGk5MTVfZ2VtX2NvbnRleHRfY3JlYXRlX2tl
cm5lbChpOTE1LCBJOTE1X1BSSU9SSVRZX01JTik7CiAJaWYgKElTX0VSUihjdHgpKSB7CiAJCURS
TV9FUlJPUigiRmFpbGVkIHRvIGNyZWF0ZSBkZWZhdWx0IGdsb2JhbCBjb250ZXh0XG4iKTsKIAkJ
cmV0dXJuIFBUUl9FUlIoY3R4KTsKIAl9Ci0JZGV2X3ByaXYtPmtlcm5lbF9jb250ZXh0ID0gY3R4
OworCWk5MTUtPmtlcm5lbF9jb250ZXh0ID0gY3R4OwogCiAJRFJNX0RFQlVHX0RSSVZFUigiJXMg
Y29udGV4dCBzdXBwb3J0IGluaXRpYWxpemVkXG4iLAotCQkJIERSSVZFUl9DQVBTKGRldl9wcml2
KS0+aGFzX2xvZ2ljYWxfY29udGV4dHMgPworCQkJIERSSVZFUl9DQVBTKGk5MTUpLT5oYXNfbG9n
aWNhbF9jb250ZXh0cyA/CiAJCQkgImxvZ2ljYWwiIDogImZha2UiKTsKIAlyZXR1cm4gMDsKIH0K
IAotdm9pZCBpOTE1X2dlbV9jb250ZXh0c19maW5pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQordm9pZCBpOTE1X2dlbV9kcml2ZXJfcmVsZWFzZV9fY29udGV4dHMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCiB7Ci0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+ZHJtLnN0
cnVjdF9tdXRleCk7Ci0KIAlkZXN0cm95X2tlcm5lbF9jb250ZXh0KCZpOTE1LT5rZXJuZWxfY29u
dGV4dCk7CiB9CiAKQEAgLTU1NywxMSArNTQwLDE2IEBAIHN0YXRpYyBpbnQgdm1faWRyX2NsZWFu
dXAoaW50IGlkLCB2b2lkICpwLCB2b2lkICpkYXRhKQogc3RhdGljIGludCBnZW1fY29udGV4dF9y
ZWdpc3RlcihzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAogCQkJCXN0cnVjdCBkcm1faTkx
NV9maWxlX3ByaXZhdGUgKmZwcml2KQogeworCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZt
OwogCWludCByZXQ7CiAKIAljdHgtPmZpbGVfcHJpdiA9IGZwcml2OwotCWlmIChjdHgtPnZtKQot
CQljdHgtPnZtLT5maWxlID0gZnByaXY7CisKKwltdXRleF9sb2NrKCZjdHgtPm11dGV4KTsKKwl2
bSA9IGk5MTVfZ2VtX2NvbnRleHRfdm0oY3R4KTsKKwlpZiAodm0pCisJCVdSSVRFX09OQ0Uodm0t
PmZpbGUsIGZwcml2KTsgLyogWFhYICovCisJbXV0ZXhfdW5sb2NrKCZjdHgtPm11dGV4KTsKIAog
CWN0eC0+cGlkID0gZ2V0X3Rhc2tfcGlkKGN1cnJlbnQsIFBJRFRZUEVfUElEKTsKIAljdHgtPm5h
bWUgPSBrYXNwcmludGYoR0ZQX0tFUk5FTCwgIiVzWyVkXSIsCkBAIC01OTgsOSArNTg2LDcgQEAg
aW50IGk5MTVfZ2VtX2NvbnRleHRfb3BlbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
IAlpZHJfaW5pdCgmZmlsZV9wcml2LT5jb250ZXh0X2lkcik7CiAJaWRyX2luaXRfYmFzZSgmZmls
ZV9wcml2LT52bV9pZHIsIDEpOwogCi0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRl
eCk7CiAJY3R4ID0gaTkxNV9nZW1fY3JlYXRlX2NvbnRleHQoaTkxNSwgMCk7Ci0JbXV0ZXhfdW5s
b2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlpZiAoSVNfRVJSKGN0eCkpIHsKIAkJZXJy
ID0gUFRSX0VSUihjdHgpOwogCQlnb3RvIGVycjsKQEAgLTYyOCw2ICs2MTQsNyBAQCBpbnQgaTkx
NV9nZW1fY29udGV4dF9vcGVuKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogdm9pZCBp
OTE1X2dlbV9jb250ZXh0X2Nsb3NlKHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkKIHsKIAlzdHJ1Y3Qg
ZHJtX2k5MTVfZmlsZV9wcml2YXRlICpmaWxlX3ByaXYgPSBmaWxlLT5kcml2ZXJfcHJpdjsKKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGZpbGVfcHJpdi0+ZGV2X3ByaXY7CiAKIAlp
ZHJfZm9yX2VhY2goJmZpbGVfcHJpdi0+Y29udGV4dF9pZHIsIGNvbnRleHRfaWRyX2NsZWFudXAs
IE5VTEwpOwogCWlkcl9kZXN0cm95KCZmaWxlX3ByaXYtPmNvbnRleHRfaWRyKTsKQEAgLTYzNiw2
ICs2MjMsOCBAQCB2b2lkIGk5MTVfZ2VtX2NvbnRleHRfY2xvc2Uoc3RydWN0IGRybV9maWxlICpm
aWxlKQogCWlkcl9mb3JfZWFjaCgmZmlsZV9wcml2LT52bV9pZHIsIHZtX2lkcl9jbGVhbnVwLCBO
VUxMKTsKIAlpZHJfZGVzdHJveSgmZmlsZV9wcml2LT52bV9pZHIpOwogCW11dGV4X2Rlc3Ryb3ko
JmZpbGVfcHJpdi0+dm1faWRyX2xvY2spOworCisJY29udGV4dHNfZmx1c2hfZnJlZSgmaTkxNS0+
Z2VtLmNvbnRleHRzKTsKIH0KIAogaW50IGk5MTVfZ2VtX3ZtX2NyZWF0ZV9pb2N0bChzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLApAQCAtODE0LDE2ICs4MDMsMTIgQEAgc3RhdGlj
IGludCBnZXRfcHBndHQoc3RydWN0IGRybV9pOTE1X2ZpbGVfcHJpdmF0ZSAqZmlsZV9wcml2LAog
CXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtOwogCWludCByZXQ7CiAKLQlpZiAoIWN0eC0+
dm0pCisJaWYgKCFyY3VfYWNjZXNzX3BvaW50ZXIoY3R4LT52bSkpCiAJCXJldHVybiAtRU5PREVW
OwogCi0JLyogWFhYIHJjdSBhY3F1aXJlPyAqLwotCXJldCA9IG11dGV4X2xvY2tfaW50ZXJydXB0
aWJsZSgmY3R4LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQlpZiAocmV0KQotCQlyZXR1cm4g
cmV0OwotCisJcmN1X3JlYWRfbG9jaygpOwogCXZtID0gaTkxNV92bV9nZXQoY3R4LT52bSk7Ci0J
bXV0ZXhfdW5sb2NrKCZjdHgtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCXJjdV9yZWFkX3Vu
bG9jaygpOwogCiAJcmV0ID0gbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKCZmaWxlX3ByaXYtPnZt
X2lkcl9sb2NrKTsKIAlpZiAocmV0KQpAQCAtOTMyLDcgKzkxNyw3IEBAIHN0YXRpYyBpbnQgc2V0
X3BwZ3R0KHN0cnVjdCBkcm1faTkxNV9maWxlX3ByaXZhdGUgKmZpbGVfcHJpdiwKIAlpZiAoYXJn
cy0+c2l6ZSkKIAkJcmV0dXJuIC1FSU5WQUw7CiAKLQlpZiAoIWN0eC0+dm0pCisJaWYgKCFyY3Vf
YWNjZXNzX3BvaW50ZXIoY3R4LT52bSkpCiAJCXJldHVybiAtRU5PREVWOwogCiAJaWYgKHVwcGVy
XzMyX2JpdHMoYXJncy0+dmFsdWUpKQpAQCAtOTQ2LDE3ICs5MzEsMjAgQEAgc3RhdGljIGludCBz
ZXRfcHBndHQoc3RydWN0IGRybV9pOTE1X2ZpbGVfcHJpdmF0ZSAqZmlsZV9wcml2LAogCWlmICgh
dm0pCiAJCXJldHVybiAtRU5PRU5UOwogCi0JZXJyID0gbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxl
KCZjdHgtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCWVyciA9IG11dGV4X2xvY2tfaW50ZXJy
dXB0aWJsZSgmY3R4LT5tdXRleCk7CiAJaWYgKGVycikKIAkJZ290byBvdXQ7CiAKLQlpZiAodm0g
PT0gY3R4LT52bSkKKwlpZiAoaTkxNV9nZW1fY29udGV4dF9pc19jbG9zZWQoY3R4KSkgeworCQll
cnIgPSAtRU5PRU5UOworCQlnb3RvIG91dDsKKwl9CisKKwlpZiAodm0gPT0gcmN1X2FjY2Vzc19w
b2ludGVyKGN0eC0+dm0pKQogCQlnb3RvIHVubG9jazsKIAogCS8qIFRlYXJkb3duIHRoZSBleGlz
dGluZyBvYmo6dm1hIGNhY2hlLCBpdCB3aWxsIGhhdmUgdG8gYmUgcmVidWlsdC4gKi8KLQltdXRl
eF9sb2NrKCZjdHgtPm11dGV4KTsKIAlsdXRfY2xvc2UoY3R4KTsKLQltdXRleF91bmxvY2soJmN0
eC0+bXV0ZXgpOwogCiAJb2xkID0gX19zZXRfcHBndHQoY3R4LCB2bSk7CiAKQEAgLTk3Niw4ICs5
NjQsNyBAQCBzdGF0aWMgaW50IHNldF9wcGd0dChzdHJ1Y3QgZHJtX2k5MTVfZmlsZV9wcml2YXRl
ICpmaWxlX3ByaXYsCiAJfQogCiB1bmxvY2s6Ci0JbXV0ZXhfdW5sb2NrKCZjdHgtPmk5MTUtPmRy
bS5zdHJ1Y3RfbXV0ZXgpOwotCisJbXV0ZXhfdW5sb2NrKCZjdHgtPm11dGV4KTsKIG91dDoKIAlp
OTE1X3ZtX3B1dCh2bSk7CiAJcmV0dXJuIGVycjsKQEAgLTE4MzYsNyArMTgyMyw3IEBAIHN0YXRp
YyBpbnQgY2xvbmVfdm0oc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmRzdCwKIAogCXJjdV9yZWFk
X2xvY2soKTsKIAlkbyB7Ci0JCXZtID0gUkVBRF9PTkNFKHNyYy0+dm0pOworCQl2bSA9IHJjdV9k
ZXJlZmVyZW5jZShzcmMtPnZtKTsKIAkJaWYgKCF2bSkKIAkJCWJyZWFrOwogCkBAIC0xODU4LDcg
KzE4NDUsNyBAQCBzdGF0aWMgaW50IGNsb25lX3ZtKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpk
c3QsCiAJCSAqIGl0IGNhbm5vdCBiZSByZWFsbG9jYXRlZCBlbHNld2hlcmUuCiAJCSAqLwogCi0J
CWlmICh2bSA9PSBSRUFEX09OQ0Uoc3JjLT52bSkpCisJCWlmICh2bSA9PSByY3VfYWNjZXNzX3Bv
aW50ZXIoc3JjLT52bSkpCiAJCQlicmVhazsKIAogCQlpOTE1X3ZtX3B1dCh2bSk7CkBAIC0xOTYw
LDEyICsxOTQ3LDcgQEAgaW50IGk5MTVfZ2VtX2NvbnRleHRfY3JlYXRlX2lvY3RsKHN0cnVjdCBk
cm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAJCXJldHVybiAtRUlPOwogCX0KIAotCXJldCA9
IGk5MTVfbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKGRldik7Ci0JaWYgKHJldCkKLQkJcmV0dXJu
IHJldDsKLQogCWV4dF9kYXRhLmN0eCA9IGk5MTVfZ2VtX2NyZWF0ZV9jb250ZXh0KGk5MTUsIGFy
Z3MtPmZsYWdzKTsKLQltdXRleF91bmxvY2soJmRldi0+c3RydWN0X211dGV4KTsKIAlpZiAoSVNf
RVJSKGV4dF9kYXRhLmN0eCkpCiAJCXJldHVybiBQVFJfRVJSKGV4dF9kYXRhLmN0eCk7CiAKQEAg
LTIwOTIsMTAgKzIwNzQsMTIgQEAgaW50IGk5MTVfZ2VtX2NvbnRleHRfZ2V0cGFyYW1faW9jdGwo
c3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIAogCWNhc2UgSTkxNV9DT05URVhU
X1BBUkFNX0dUVF9TSVpFOgogCQlhcmdzLT5zaXplID0gMDsKLQkJaWYgKGN0eC0+dm0pCi0JCQlh
cmdzLT52YWx1ZSA9IGN0eC0+dm0tPnRvdGFsOworCQlyY3VfcmVhZF9sb2NrKCk7CisJCWlmIChy
Y3VfYWNjZXNzX3BvaW50ZXIoY3R4LT52bSkpCisJCQlhcmdzLT52YWx1ZSA9IHJjdV9kZXJlZmVy
ZW5jZShjdHgtPnZtKS0+dG90YWw7CiAJCWVsc2UKIAkJCWFyZ3MtPnZhbHVlID0gdG9faTkxNShk
ZXYpLT5nZ3R0LnZtLnRvdGFsOworCQlyY3VfcmVhZF91bmxvY2soKTsKIAkJYnJlYWs7CiAKIAlj
YXNlIEk5MTVfQ09OVEVYVF9QQVJBTV9OT19FUlJPUl9DQVBUVVJFOgpAQCAtMjE2MSw3ICsyMTQ1
LDcgQEAgaW50IGk5MTVfZ2VtX2NvbnRleHRfc2V0cGFyYW1faW9jdGwoc3RydWN0IGRybV9kZXZp
Y2UgKmRldiwgdm9pZCAqZGF0YSwKIGludCBpOTE1X2dlbV9jb250ZXh0X3Jlc2V0X3N0YXRzX2lv
Y3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJCQkJICAgICAgIHZvaWQgKmRhdGEsIHN0cnVj
dCBkcm1fZmlsZSAqZmlsZSkKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGRldik7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGRldik7CiAJc3RydWN0IGRybV9pOTE1X3Jlc2V0X3N0YXRzICphcmdzID0gZGF0YTsKIAlzdHJ1
Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4OwogCWludCByZXQ7CkBAIC0yMTgzLDcgKzIxNjcsNyBA
QCBpbnQgaTkxNV9nZW1fY29udGV4dF9yZXNldF9zdGF0c19pb2N0bChzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2LAogCSAqLwogCiAJaWYgKGNhcGFibGUoQ0FQX1NZU19BRE1JTikpCi0JCWFyZ3MtPnJl
c2V0X2NvdW50ID0gaTkxNV9yZXNldF9jb3VudCgmZGV2X3ByaXYtPmdwdV9lcnJvcik7CisJCWFy
Z3MtPnJlc2V0X2NvdW50ID0gaTkxNV9yZXNldF9jb3VudCgmaTkxNS0+Z3B1X2Vycm9yKTsKIAll
bHNlCiAJCWFyZ3MtPnJlc2V0X2NvdW50ID0gMDsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9jb250ZXh0LmgKaW5kZXggNTBiYzI3ZDMwYzAzLi45MjM0NTg2ODMwZDEgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmgKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaApAQCAtMTEsNyAr
MTEsOSBAQAogCiAjaW5jbHVkZSAiZ3QvaW50ZWxfY29udGV4dC5oIgogCisjaW5jbHVkZSAiaTkx
NV9kcnYuaCIKICNpbmNsdWRlICJpOTE1X2dlbS5oIgorI2luY2x1ZGUgImk5MTVfZ2VtX2d0dC5o
IgogI2luY2x1ZGUgImk5MTVfc2NoZWR1bGVyLmgiCiAjaW5jbHVkZSAiaW50ZWxfZGV2aWNlX2lu
Zm8uaCIKIApAQCAtMTE4LDggKzEyMCw4IEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBpOTE1X2dlbV9j
b250ZXh0X2lzX2tlcm5lbChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQogfQogCiAvKiBp
OTE1X2dlbV9jb250ZXh0LmMgKi8KLWludCBfX211c3RfY2hlY2sgaTkxNV9nZW1fY29udGV4dHNf
aW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwotdm9pZCBpOTE1X2dlbV9j
b250ZXh0c19maW5pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CitpbnQgX19t
dXN0X2NoZWNrIGk5MTVfZ2VtX2luaXRfY29udGV4dHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpOwordm9pZCBpOTE1X2dlbV9kcml2ZXJfcmVsZWFzZV9fY29udGV4dHMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpOwogCiBpbnQgaTkxNV9nZW1fY29udGV4dF9vcGVuKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCQkJICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpOwpA
QCAtMTU4LDYgKzE2MCwyNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgaTkxNV9nZW1fY29udGV4dF9w
dXQoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKIAlrcmVmX3B1dCgmY3R4LT5yZWYsIGk5
MTVfZ2VtX2NvbnRleHRfcmVsZWFzZSk7CiB9CiAKK3N0YXRpYyBpbmxpbmUgc3RydWN0IGk5MTVf
YWRkcmVzc19zcGFjZSAqCitpOTE1X2dlbV9jb250ZXh0X3ZtKHN0cnVjdCBpOTE1X2dlbV9jb250
ZXh0ICpjdHgpCit7CisJcmV0dXJuIHJjdV9kZXJlZmVyZW5jZV9wcm90ZWN0ZWQoY3R4LT52bSwg
bG9ja2RlcF9pc19oZWxkKCZjdHgtPm11dGV4KSk7Cit9CisKK3N0YXRpYyBpbmxpbmUgc3RydWN0
IGk5MTVfYWRkcmVzc19zcGFjZSAqCitpOTE1X2dlbV9jb250ZXh0X2dldF92bV9yY3Uoc3RydWN0
IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKK3sKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2
bTsKKworCXJjdV9yZWFkX2xvY2soKTsKKwl2bSA9IHJjdV9kZXJlZmVyZW5jZShjdHgtPnZtKTsK
KwlpZiAoIXZtKQorCQl2bSA9ICZjdHgtPmk5MTUtPmdndHQudm07CisJdm0gPSBpOTE1X3ZtX2dl
dCh2bSk7CisJcmN1X3JlYWRfdW5sb2NrKCk7CisKKwlyZXR1cm4gdm07Cit9CisKIHN0YXRpYyBp
bmxpbmUgc3RydWN0IGk5MTVfZ2VtX2VuZ2luZXMgKgogaTkxNV9nZW1fY29udGV4dF9lbmdpbmVz
KHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCiB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dF90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaAppbmRleCA4N2JlMjc4NzdlMjIuLmFi
OGUxMzY3ZGZjOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X2NvbnRleHRfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
Y29udGV4dF90eXBlcy5oCkBAIC04OCw3ICs4OCw3IEBAIHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0
IHsKIAkgKiBJbiBvdGhlciBtb2RlcywgdGhpcyBpcyBhIE5VTEwgcG9pbnRlciB3aXRoIHRoZSBl
eHBlY3RhdGlvbiB0aGF0CiAJICogdGhlIGNhbGxlciB1c2VzIHRoZSBzaGFyZWQgZ2xvYmFsIEdU
VC4KIAkgKi8KLQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsKKwlzdHJ1Y3QgaTkxNV9h
ZGRyZXNzX3NwYWNlIF9fcmN1ICp2bTsKIAogCS8qKgogCSAqIEBwaWQ6IHByb2Nlc3MgaWQgb2Yg
Y3JlYXRvcgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4
ZWNidWZmZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVy
LmMKaW5kZXggODhhODgxYmUxMmVjLi45ODgxNmMzNWZmYzMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYwpAQCAtNzI4LDcgKzcyOCw3IEBAIHN0
YXRpYyBpbnQgZWJfc2VsZWN0X2NvbnRleHQoc3RydWN0IGk5MTVfZXhlY2J1ZmZlciAqZWIpCiAJ
CXJldHVybiAtRU5PRU5UOwogCiAJZWItPmdlbV9jb250ZXh0ID0gY3R4OwotCWlmIChjdHgtPnZt
KQorCWlmIChyY3VfYWNjZXNzX3BvaW50ZXIoY3R4LT52bSkpCiAJCWViLT5pbnZhbGlkX2ZsYWdz
IHw9IEVYRUNfT0JKRUNUX05FRURTX0dUVDsKIAogCWViLT5jb250ZXh0X2ZsYWdzID0gMDsKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV91c2VycHRyLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdXNlcnB0ci5jCmluZGV4IDE3MzhhMTVl
YjkxMS4uNGY5NzA0NzQwMTNmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fdXNlcnB0ci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV91c2VycHRyLmMKQEAgLTc1OCw3ICs3NTgsOCBAQCBpOTE1X2dlbV91c2VycHRyX2lvY3RsKHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJCSAqIE9uIGFsbW9zdCBhbGwgb2YgdGhlIG9sZGVyIGh3
LCB3ZSBjYW5ub3QgdGVsbCB0aGUgR1BVIHRoYXQKIAkJICogYSBwYWdlIGlzIHJlYWRvbmx5Lgog
CQkgKi8KLQkJdm0gPSBkZXZfcHJpdi0+a2VybmVsX2NvbnRleHQtPnZtOworCQl2bSA9IHJjdV9k
ZXJlZmVyZW5jZV9wcm90ZWN0ZWQoZGV2X3ByaXYtPmtlcm5lbF9jb250ZXh0LT52bSwKKwkJCQkJ
ICAgICAgIHRydWUpOyAvKiBzdGF0aWMgdm0gKi8KIAkJaWYgKCF2bSB8fCAhdm0tPmhhc19yZWFk
X29ubHkpCiAJCQlyZXR1cm4gLUVOT0RFVjsKIAl9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vc2VsZnRlc3RzL2h1Z2VfcGFnZXMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9zZWxmdGVzdHMvaHVnZV9wYWdlcy5jCmluZGV4IDk4YjJhNmNjZmNjMS4uMzMxNDg1OGYz
MDQ2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2h1Z2Vf
cGFnZXMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2h1Z2VfcGFn
ZXMuYwpAQCAtMTMyMiwxNSArMTMyMiwxNSBAQCBzdGF0aWMgaW50IGlndF9wcGd0dF9waW5fdXBk
YXRlKHZvaWQgKmFyZykKIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4ID0gYXJnOwogCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGN0eC0+aTkxNTsKIAl1bnNpZ25lZCBs
b25nIHN1cHBvcnRlZCA9IElOVEVMX0lORk8oZGV2X3ByaXYpLT5wYWdlX3NpemVzOwotCXN0cnVj
dCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0gY3R4LT52bTsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdCAqb2JqOwogCXN0cnVjdCBpOTE1X2dlbV9lbmdpbmVzX2l0ZXIgaXQ7CisJc3RydWN0
IGk5MTVfYWRkcmVzc19zcGFjZSAqdm07CiAJc3RydWN0IGludGVsX2NvbnRleHQgKmNlOwogCXN0
cnVjdCBpOTE1X3ZtYSAqdm1hOwogCXVuc2lnbmVkIGludCBmbGFncyA9IFBJTl9VU0VSIHwgUElO
X09GRlNFVF9GSVhFRDsKIAl1bnNpZ25lZCBpbnQgbjsKIAlpbnQgZmlyc3QsIGxhc3Q7Ci0JaW50
IGVycjsKKwlpbnQgZXJyID0gMDsKIAogCS8qCiAJICogTWFrZSBzdXJlIHRoZXJlJ3Mgbm8gZnVu
bnkgYnVzaW5lc3Mgd2hlbiBkb2luZyBhIFBJTl9VUERBVEUgLS0gaW4gdGhlCkBAIC0xMzQwLDkg
KzEzNDAsMTAgQEAgc3RhdGljIGludCBpZ3RfcHBndHRfcGluX3VwZGF0ZSh2b2lkICphcmcpCiAJ
ICogaHVnZS1ndHQtcGFnZXMuCiAJICovCiAKLQlpZiAoIXZtIHx8ICFpOTE1X3ZtX2lzXzRsdmwo
dm0pKSB7CisJdm0gPSBpOTE1X2dlbV9jb250ZXh0X2dldF92bV9yY3UoY3R4KTsKKwlpZiAoIWk5
MTVfdm1faXNfNGx2bCh2bSkpIHsKIAkJcHJfaW5mbygiNDhiIFBQR1RUIG5vdCBzdXBwb3J0ZWQs
IHNraXBwaW5nXG4iKTsKLQkJcmV0dXJuIDA7CisJCWdvdG8gb3V0X3ZtOwogCX0KIAogCWZpcnN0
ID0gaWxvZzIoSTkxNV9HVFRfUEFHRV9TSVpFXzY0Syk7CkBAIC0xNDUxLDYgKzE0NTIsOCBAQCBz
dGF0aWMgaW50IGlndF9wcGd0dF9waW5fdXBkYXRlKHZvaWQgKmFyZykKIAlpOTE1X3ZtYV9jbG9z
ZSh2bWEpOwogb3V0X3B1dDoKIAlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CitvdXRfdm06CisJ
aTkxNV92bV9wdXQodm0pOwogCiAJcmV0dXJuIGVycjsKIH0KQEAgLTE0NjAsNyArMTQ2Myw3IEBA
IHN0YXRpYyBpbnQgaWd0X3RtcGZzX2ZhbGxiYWNrKHZvaWQgKmFyZykKIAlzdHJ1Y3QgaTkxNV9n
ZW1fY29udGV4dCAqY3R4ID0gYXJnOwogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
Y3R4LT5pOTE1OwogCXN0cnVjdCB2ZnNtb3VudCAqZ2VtZnMgPSBpOTE1LT5tbS5nZW1mczsKLQlz
dHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9IGN0eC0+dm0gPzogJmk5MTUtPmdndHQudm07
CisJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSBpOTE1X2dlbV9jb250ZXh0X2dldF92
bV9yY3UoY3R4KTsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwogCXN0cnVjdCBp
OTE1X3ZtYSAqdm1hOwogCXUzMiAqdmFkZHI7CkBAIC0xNTEwLDYgKzE1MTMsNyBAQCBzdGF0aWMg
aW50IGlndF90bXBmc19mYWxsYmFjayh2b2lkICphcmcpCiBvdXRfcmVzdG9yZToKIAlpOTE1LT5t
bS5nZW1mcyA9IGdlbWZzOwogCisJaTkxNV92bV9wdXQodm0pOwogCXJldHVybiBlcnI7CiB9CiAK
QEAgLTE1MTcsMTQgKzE1MjEsMTQgQEAgc3RhdGljIGludCBpZ3Rfc2hyaW5rX3RocCh2b2lkICph
cmcpCiB7CiAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCA9IGFyZzsKIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGN0eC0+aTkxNTsKLQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3Nw
YWNlICp2bSA9IGN0eC0+dm0gPzogJmk5MTUtPmdndHQudm07CisJc3RydWN0IGk5MTVfYWRkcmVz
c19zcGFjZSAqdm0gPSBpOTE1X2dlbV9jb250ZXh0X2dldF92bV9yY3UoY3R4KTsKIAlzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwogCXN0cnVjdCBpOTE1X2dlbV9lbmdpbmVzX2l0ZXIg
aXQ7CiAJc3RydWN0IGludGVsX2NvbnRleHQgKmNlOwogCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwog
CXVuc2lnbmVkIGludCBmbGFncyA9IFBJTl9VU0VSOwogCXVuc2lnbmVkIGludCBuOwotCWludCBl
cnI7CisJaW50IGVyciA9IDA7CiAKIAkvKgogCSAqIFNhbml0eSBjaGVjayBzaHJpbmtpbmcgaHVn
ZS1wYWdlZCBvYmplY3QgLS0gbWFrZSBzdXJlIG5vdGhpbmcgYmxvd3MKQEAgLTE1MzMsMTIgKzE1
MzcsMTQgQEAgc3RhdGljIGludCBpZ3Rfc2hyaW5rX3RocCh2b2lkICphcmcpCiAKIAlpZiAoIWln
dF9jYW5fYWxsb2NhdGVfdGhwKGk5MTUpKSB7CiAJCXByX2luZm8oIm1pc3NpbmcgVEhQIHN1cHBv
cnQsIHNraXBwaW5nXG4iKTsKLQkJcmV0dXJuIDA7CisJCWdvdG8gb3V0X3ZtOwogCX0KIAogCW9i
aiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfc2htZW0oaTkxNSwgU1pfMk0pOwotCWlmIChJU19F
UlIob2JqKSkKLQkJcmV0dXJuIFBUUl9FUlIob2JqKTsKKwlpZiAoSVNfRVJSKG9iaikpIHsKKwkJ
ZXJyID0gUFRSX0VSUihvYmopOworCQlnb3RvIG91dF92bTsKKwl9CiAKIAl2bWEgPSBpOTE1X3Zt
YV9pbnN0YW5jZShvYmosIHZtLCBOVUxMKTsKIAlpZiAoSVNfRVJSKHZtYSkpIHsKQEAgLTE2MDcs
NiArMTYxMyw4IEBAIHN0YXRpYyBpbnQgaWd0X3Nocmlua190aHAodm9pZCAqYXJnKQogCWk5MTVf
dm1hX2Nsb3NlKHZtYSk7CiBvdXRfcHV0OgogCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKK291
dF92bToKKwlpOTE1X3ZtX3B1dCh2bSk7CiAKIAlyZXR1cm4gZXJyOwogfQpAQCAtMTY3NSw2ICsx
NjgzLDcgQEAgaW50IGk5MTVfZ2VtX2h1Z2VfcGFnZV9saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAl9OwogCXN0cnVjdCBkcm1fZmlsZSAqZmlsZTsKIAlzdHJ1
Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4OworCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZt
OwogCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwogCWludCBlcnI7CiAKQEAgLTE2OTksOCArMTcw
OCwxMSBAQCBpbnQgaTkxNV9nZW1faHVnZV9wYWdlX2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQogCQlnb3RvIG91dF91bmxvY2s7CiAJfQogCi0JaWYgKGN0eC0+
dm0pCi0JCWN0eC0+dm0tPnNjcnViXzY0SyA9IHRydWU7CisJbXV0ZXhfbG9jaygmY3R4LT5tdXRl
eCk7CisJdm0gPSBpOTE1X2dlbV9jb250ZXh0X3ZtKGN0eCk7CisJaWYgKHZtKQorCQlXUklURV9P
TkNFKHZtLT5zY3J1Yl82NEssIHRydWUpOworCW11dGV4X3VubG9jaygmY3R4LT5tdXRleCk7CiAK
IAllcnIgPSBpOTE1X3N1YnRlc3RzKHRlc3RzLCBjdHgpOwogCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fY29udGV4dC5jCmluZGV4IDJmYjMx
YWRhMmZhNy4uNjlhODZmYzFlMzliIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQuYwpAQCAtNTMsMTkgKzUzLDE3IEBAIHN0
YXRpYyBpbnQgbGl2ZV9ub3Bfc3dpdGNoKHZvaWQgKmFyZykKIAlpZiAoSVNfRVJSKGZpbGUpKQog
CQlyZXR1cm4gUFRSX0VSUihmaWxlKTsKIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3Rf
bXV0ZXgpOwotCiAJY3R4ID0ga2NhbGxvYyhuY3R4LCBzaXplb2YoKmN0eCksIEdGUF9LRVJORUwp
OwogCWlmICghY3R4KSB7CiAJCWVyciA9IC1FTk9NRU07Ci0JCWdvdG8gb3V0X3VubG9jazsKKwkJ
Z290byBvdXRfZmlsZTsKIAl9CiAKIAlmb3IgKG4gPSAwOyBuIDwgbmN0eDsgbisrKSB7CiAJCWN0
eFtuXSA9IGxpdmVfY29udGV4dChpOTE1LCBmaWxlKTsKIAkJaWYgKElTX0VSUihjdHhbbl0pKSB7
CiAJCQllcnIgPSBQVFJfRVJSKGN0eFtuXSk7Ci0JCQlnb3RvIG91dF91bmxvY2s7CisJCQlnb3Rv
IG91dF9maWxlOwogCQl9CiAJfQogCkBAIC03OSw3ICs3Nyw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9u
b3Bfc3dpdGNoKHZvaWQgKmFyZykKIAkJCXJxID0gaWd0X3JlcXVlc3RfYWxsb2MoY3R4W25dLCBl
bmdpbmUpOwogCQkJaWYgKElTX0VSUihycSkpIHsKIAkJCQllcnIgPSBQVFJfRVJSKHJxKTsKLQkJ
CQlnb3RvIG91dF91bmxvY2s7CisJCQkJZ290byBvdXRfZmlsZTsKIAkJCX0KIAkJCWk5MTVfcmVx
dWVzdF9hZGQocnEpOwogCQl9CkBAIC04Nyw3ICs4NSw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9ub3Bf
c3dpdGNoKHZvaWQgKmFyZykKIAkJCXByX2VycigiRmFpbGVkIHRvIHBvcHVsYXRlZCAlZCBjb250
ZXh0c1xuIiwgbmN0eCk7CiAJCQlpbnRlbF9ndF9zZXRfd2VkZ2VkKCZpOTE1LT5ndCk7CiAJCQll
cnIgPSAtRUlPOwotCQkJZ290byBvdXRfdW5sb2NrOworCQkJZ290byBvdXRfZmlsZTsKIAkJfQog
CiAJCXRpbWVzWzFdID0ga3RpbWVfZ2V0X3JhdygpOwpAQCAtOTcsNyArOTUsNyBAQCBzdGF0aWMg
aW50IGxpdmVfbm9wX3N3aXRjaCh2b2lkICphcmcpCiAKIAkJZXJyID0gaWd0X2xpdmVfdGVzdF9i
ZWdpbigmdCwgaTkxNSwgX19mdW5jX18sIGVuZ2luZS0+bmFtZSk7CiAJCWlmIChlcnIpCi0JCQln
b3RvIG91dF91bmxvY2s7CisJCQlnb3RvIG91dF9maWxlOwogCiAJCWVuZF90aW1lID0gamlmZmll
cyArIGk5MTVfc2VsZnRlc3QudGltZW91dF9qaWZmaWVzOwogCQlmb3JfZWFjaF9wcmltZV9udW1i
ZXJfZnJvbShwcmltZSwgMiwgODE5MikgewpAQCAtMTA3LDcgKzEwNSw3IEBAIHN0YXRpYyBpbnQg
bGl2ZV9ub3Bfc3dpdGNoKHZvaWQgKmFyZykKIAkJCQlycSA9IGlndF9yZXF1ZXN0X2FsbG9jKGN0
eFtuICUgbmN0eF0sIGVuZ2luZSk7CiAJCQkJaWYgKElTX0VSUihycSkpIHsKIAkJCQkJZXJyID0g
UFRSX0VSUihycSk7Ci0JCQkJCWdvdG8gb3V0X3VubG9jazsKKwkJCQkJZ290byBvdXRfZmlsZTsK
IAkJCQl9CiAKIAkJCQkvKgpAQCAtMTQzLDcgKzE0MSw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9ub3Bf
c3dpdGNoKHZvaWQgKmFyZykKIAogCQllcnIgPSBpZ3RfbGl2ZV90ZXN0X2VuZCgmdCk7CiAJCWlm
IChlcnIpCi0JCQlnb3RvIG91dF91bmxvY2s7CisJCQlnb3RvIG91dF9maWxlOwogCiAJCXByX2lu
Zm8oIlN3aXRjaCBsYXRlbmNpZXMgb24gJXM6IDEgPSAlbGx1bnMsICVsdSA9ICVsbHVuc1xuIiwK
IAkJCWVuZ2luZS0+bmFtZSwKQEAgLTE1MSw4ICsxNDksNyBAQCBzdGF0aWMgaW50IGxpdmVfbm9w
X3N3aXRjaCh2b2lkICphcmcpCiAJCQlwcmltZSAtIDEsIGRpdjY0X3U2NChrdGltZV90b19ucyh0
aW1lc1sxXSksIHByaW1lIC0gMSkpOwogCX0KIAotb3V0X3VubG9jazoKLQltdXRleF91bmxvY2so
Jmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworb3V0X2ZpbGU6CiAJbW9ja19maWxlX2ZyZWUoaTkx
NSwgZmlsZSk7CiAJcmV0dXJuIGVycjsKIH0KQEAgLTI1MywxMiArMjUwLDEwIEBAIHN0YXRpYyBp
bnQgbGl2ZV9wYXJhbGxlbF9zd2l0Y2godm9pZCAqYXJnKQogCWlmIChJU19FUlIoZmlsZSkpCiAJ
CXJldHVybiBQVFJfRVJSKGZpbGUpOwogCi0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9t
dXRleCk7Ci0KIAljdHggPSBsaXZlX2NvbnRleHQoaTkxNSwgZmlsZSk7CiAJaWYgKElTX0VSUihj
dHgpKSB7CiAJCWVyciA9IFBUUl9FUlIoY3R4KTsKLQkJZ290byBvdXRfbG9ja2VkOworCQlnb3Rv
IG91dF9maWxlOwogCX0KIAogCWVuZ2luZXMgPSBpOTE1X2dlbV9jb250ZXh0X2xvY2tfZW5naW5l
cyhjdHgpOwpAQCAtMjY4LDcgKzI2Myw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9wYXJhbGxlbF9zd2l0
Y2godm9pZCAqYXJnKQogCWlmICghZGF0YSkgewogCQlpOTE1X2dlbV9jb250ZXh0X3VubG9ja19l
bmdpbmVzKGN0eCk7CiAJCWVyciA9IC1FTk9NRU07Ci0JCWdvdG8gb3V0X2xvY2tlZDsKKwkJZ290
byBvdXQ7CiAJfQogCiAJbSA9IDA7IC8qIFVzZSB0aGUgZmlyc3QgY29udGV4dCBhcyBvdXIgdGVt
cGxhdGUgZm9yIHRoZSBlbmdpbmVzICovCkBAIC0yNzYsNyArMjcxLDcgQEAgc3RhdGljIGludCBs
aXZlX3BhcmFsbGVsX3N3aXRjaCh2b2lkICphcmcpCiAJCWVyciA9IGludGVsX2NvbnRleHRfcGlu
KGNlKTsKIAkJaWYgKGVycikgewogCQkJaTkxNV9nZW1fY29udGV4dF91bmxvY2tfZW5naW5lcyhj
dHgpOwotCQkJZ290byBvdXRfbG9ja2VkOworCQkJZ290byBvdXQ7CiAJCX0KIAkJZGF0YVttKytd
LmNlWzBdID0gaW50ZWxfY29udGV4dF9nZXQoY2UpOwogCX0KQEAgLTI4Nyw3ICsyODIsNyBAQCBz
dGF0aWMgaW50IGxpdmVfcGFyYWxsZWxfc3dpdGNoKHZvaWQgKmFyZykKIAkJY3R4ID0gbGl2ZV9j
b250ZXh0KGk5MTUsIGZpbGUpOwogCQlpZiAoSVNfRVJSKGN0eCkpIHsKIAkJCWVyciA9IFBUUl9F
UlIoY3R4KTsKLQkJCWdvdG8gb3V0X2xvY2tlZDsKKwkJCWdvdG8gb3V0OwogCQl9CiAKIAkJZm9y
IChtID0gMDsgbSA8IGNvdW50OyBtKyspIHsKQEAgLTI5NiwyMCArMjkxLDE4IEBAIHN0YXRpYyBp
bnQgbGl2ZV9wYXJhbGxlbF9zd2l0Y2godm9pZCAqYXJnKQogCiAJCQljZSA9IGludGVsX2NvbnRl
eHRfY3JlYXRlKGN0eCwgZGF0YVttXS5jZVswXS0+ZW5naW5lKTsKIAkJCWlmIChJU19FUlIoY2Up
KQotCQkJCWdvdG8gb3V0X2xvY2tlZDsKKwkJCQlnb3RvIG91dDsKIAogCQkJZXJyID0gaW50ZWxf
Y29udGV4dF9waW4oY2UpOwogCQkJaWYgKGVycikgewogCQkJCWludGVsX2NvbnRleHRfcHV0KGNl
KTsKLQkJCQlnb3RvIG91dF9sb2NrZWQ7CisJCQkJZ290byBvdXQ7CiAJCQl9CiAKIAkJCWRhdGFb
bV0uY2Vbbl0gPSBjZTsKIAkJfQogCX0KIAotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVj
dF9tdXRleCk7Ci0KIAlmb3IgKGZuID0gZnVuYzsgIWVyciAmJiAqZm47IGZuKyspIHsKIAkJc3Ry
dWN0IGlndF9saXZlX3Rlc3QgdDsKIAkJaW50IG47CkBAIC0zNTQsOCArMzQ3LDcgQEAgc3RhdGlj
IGludCBsaXZlX3BhcmFsbGVsX3N3aXRjaCh2b2lkICphcmcpCiAJCW11dGV4X3VubG9jaygmaTkx
NS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJfQogCi0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVj
dF9tdXRleCk7Ci1vdXRfbG9ja2VkOgorb3V0OgogCWZvciAobiA9IDA7IG4gPCBjb3VudDsgbisr
KSB7CiAJCWZvciAobSA9IDA7IG0gPCBBUlJBWV9TSVpFKGRhdGEtPmNlKTsgbSsrKSB7CiAJCQlp
ZiAoIWRhdGFbbl0uY2VbbV0pCkBAIC0zNjUsOCArMzU3LDggQEAgc3RhdGljIGludCBsaXZlX3Bh
cmFsbGVsX3N3aXRjaCh2b2lkICphcmcpCiAJCQlpbnRlbF9jb250ZXh0X3B1dChkYXRhW25dLmNl
W21dKTsKIAkJfQogCX0KLQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwog
CWtmcmVlKGRhdGEpOworb3V0X2ZpbGU6CiAJbW9ja19maWxlX2ZyZWUoaTkxNSwgZmlsZSk7CiAJ
cmV0dXJuIGVycjsKIH0KQEAgLTYyNiwxMSArNjE4LDkgQEAgc3RhdGljIGludCBpZ3RfY3R4X2V4
ZWModm9pZCAqYXJnKQogCQlpZiAoSVNfRVJSKGZpbGUpKQogCQkJcmV0dXJuIFBUUl9FUlIoZmls
ZSk7CiAKLQkJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0KIAkJZXJyID0g
aWd0X2xpdmVfdGVzdF9iZWdpbigmdCwgaTkxNSwgX19mdW5jX18sIGVuZ2luZS0+bmFtZSk7CiAJ
CWlmIChlcnIpCi0JCQlnb3RvIG91dF91bmxvY2s7CisJCQlnb3RvIG91dF9maWxlOwogCiAJCW5j
b250ZXh0cyA9IDA7CiAJCW5kd29yZHMgPSAwOwpAQCAtNjQyLDcgKzYzMiw3IEBAIHN0YXRpYyBp
bnQgaWd0X2N0eF9leGVjKHZvaWQgKmFyZykKIAkJCWN0eCA9IGtlcm5lbF9jb250ZXh0KGk5MTUp
OwogCQkJaWYgKElTX0VSUihjdHgpKSB7CiAJCQkJZXJyID0gUFRSX0VSUihjdHgpOwotCQkJCWdv
dG8gb3V0X3VubG9jazsKKwkJCQlnb3RvIG91dF9maWxlOwogCQkJfQogCiAJCQljZSA9IGk5MTVf
Z2VtX2NvbnRleHRfZ2V0X2VuZ2luZShjdHgsIGVuZ2luZS0+bGVnYWN5X2lkeCk7CkBAIC02NTQs
NyArNjQ0LDcgQEAgc3RhdGljIGludCBpZ3RfY3R4X2V4ZWModm9pZCAqYXJnKQogCQkJCQllcnIg
PSBQVFJfRVJSKG9iaik7CiAJCQkJCWludGVsX2NvbnRleHRfcHV0KGNlKTsKIAkJCQkJa2VybmVs
X2NvbnRleHRfY2xvc2UoY3R4KTsKLQkJCQkJZ290byBvdXRfdW5sb2NrOworCQkJCQlnb3RvIG91
dF9maWxlOwogCQkJCX0KIAkJCX0KIApAQCAtNjYzLDE3ICs2NTMsMTggQEAgc3RhdGljIGludCBp
Z3RfY3R4X2V4ZWModm9pZCAqYXJnKQogCQkJCXByX2VycigiRmFpbGVkIHRvIGZpbGwgZHdvcmQg
JWx1IFslbHUvJWx1XSB3aXRoIGdwdSAoJXMpIFtmdWxsLXBwZ3R0PyAlc10sIGVycj0lZFxuIiwK
IAkJCQkgICAgICAgbmR3b3JkcywgZHcsIG1heF9kd29yZHMob2JqKSwKIAkJCQkgICAgICAgZW5n
aW5lLT5uYW1lLAotCQkJCSAgICAgICB5ZXNubyghIWN0eC0+dm0pLCBlcnIpOworCQkJCSAgICAg
ICB5ZXNubyghIXJjdV9hY2Nlc3NfcG9pbnRlcihjdHgtPnZtKSksCisJCQkJICAgICAgIGVycik7
CiAJCQkJaW50ZWxfY29udGV4dF9wdXQoY2UpOwogCQkJCWtlcm5lbF9jb250ZXh0X2Nsb3NlKGN0
eCk7Ci0JCQkJZ290byBvdXRfdW5sb2NrOworCQkJCWdvdG8gb3V0X2ZpbGU7CiAJCQl9CiAKIAkJ
CWVyciA9IHRocm90dGxlKGNlLCB0cSwgQVJSQVlfU0laRSh0cSkpOwogCQkJaWYgKGVycikgewog
CQkJCWludGVsX2NvbnRleHRfcHV0KGNlKTsKIAkJCQlrZXJuZWxfY29udGV4dF9jbG9zZShjdHgp
OwotCQkJCWdvdG8gb3V0X3VubG9jazsKKwkJCQlnb3RvIG91dF9maWxlOwogCQkJfQogCiAJCQlp
ZiAoKytkdyA9PSBtYXhfZHdvcmRzKG9iaikpIHsKQEAgLTcwMywxMSArNjk0LDEwIEBAIHN0YXRp
YyBpbnQgaWd0X2N0eF9leGVjKHZvaWQgKmFyZykKIAkJCWR3ICs9IHJlbTsKIAkJfQogCi1vdXRf
dW5sb2NrOgorb3V0X2ZpbGU6CiAJCXRocm90dGxlX3JlbGVhc2UodHEsIEFSUkFZX1NJWkUodHEp
KTsKIAkJaWYgKGlndF9saXZlX3Rlc3RfZW5kKCZ0KSkKIAkJCWVyciA9IC1FSU87Ci0JCW11dGV4
X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAKIAkJbW9ja19maWxlX2ZyZWUoaTkx
NSwgZmlsZSk7CiAJCWlmIChlcnIpCkBAIC03NDIsMjIgKzczMiwyMCBAQCBzdGF0aWMgaW50IGln
dF9zaGFyZWRfY3R4X2V4ZWModm9pZCAqYXJnKQogCWlmIChJU19FUlIoZmlsZSkpCiAJCXJldHVy
biBQVFJfRVJSKGZpbGUpOwogCi0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7
Ci0KIAlwYXJlbnQgPSBsaXZlX2NvbnRleHQoaTkxNSwgZmlsZSk7CiAJaWYgKElTX0VSUihwYXJl
bnQpKSB7CiAJCWVyciA9IFBUUl9FUlIocGFyZW50KTsKLQkJZ290byBvdXRfdW5sb2NrOworCQln
b3RvIG91dF9maWxlOwogCX0KIAogCWlmICghcGFyZW50LT52bSkgeyAvKiBub3QgZnVsbC1wcGd0
dDsgbm90aGluZyB0byBzaGFyZSAqLwogCQllcnIgPSAwOwotCQlnb3RvIG91dF91bmxvY2s7CisJ
CWdvdG8gb3V0X2ZpbGU7CiAJfQogCiAJZXJyID0gaWd0X2xpdmVfdGVzdF9iZWdpbigmdCwgaTkx
NSwgX19mdW5jX18sICIiKTsKIAlpZiAoZXJyKQotCQlnb3RvIG91dF91bmxvY2s7CisJCWdvdG8g
b3V0X2ZpbGU7CiAKIAlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgewogCQl1bnNp
Z25lZCBsb25nIG5jb250ZXh0cywgbmR3b3JkcywgZHc7CkBAIC04MDEsNyArNzg5LDggQEAgc3Rh
dGljIGludCBpZ3Rfc2hhcmVkX2N0eF9leGVjKHZvaWQgKmFyZykKIAkJCQlwcl9lcnIoIkZhaWxl
ZCB0byBmaWxsIGR3b3JkICVsdSBbJWx1LyVsdV0gd2l0aCBncHUgKCVzKSBbZnVsbC1wcGd0dD8g
JXNdLCBlcnI9JWRcbiIsCiAJCQkJICAgICAgIG5kd29yZHMsIGR3LCBtYXhfZHdvcmRzKG9iaiks
CiAJCQkJICAgICAgIGVuZ2luZS0+bmFtZSwKLQkJCQkgICAgICAgeWVzbm8oISFjdHgtPnZtKSwg
ZXJyKTsKKwkJCQkgICAgICAgeWVzbm8oISFyY3VfYWNjZXNzX3BvaW50ZXIoY3R4LT52bSkpLAor
CQkJCSAgICAgICBlcnIpOwogCQkJCWludGVsX2NvbnRleHRfcHV0KGNlKTsKIAkJCQlrZXJuZWxf
Y29udGV4dF9jbG9zZShjdHgpOwogCQkJCWdvdG8gb3V0X3Rlc3Q7CkBAIC04NDAsMTcgKzgyOSwx
MyBAQCBzdGF0aWMgaW50IGlndF9zaGFyZWRfY3R4X2V4ZWModm9pZCAqYXJnKQogCQkJZHcgKz0g
cmVtOwogCQl9CiAKLQkJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAkJ
aTkxNV9nZW1fZHJhaW5fZnJlZWRfb2JqZWN0cyhpOTE1KTsKLQkJbXV0ZXhfbG9jaygmaTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7CiAJfQogb3V0X3Rlc3Q6CiAJdGhyb3R0bGVfcmVsZWFzZSh0cSwg
QVJSQVlfU0laRSh0cSkpOwogCWlmIChpZ3RfbGl2ZV90ZXN0X2VuZCgmdCkpCiAJCWVyciA9IC1F
SU87Ci1vdXRfdW5sb2NrOgotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7
Ci0KK291dF9maWxlOgogCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUpOwogCXJldHVybiBlcnI7
CiB9CkBAIC0xMjIyLDggKzEyMDcsNiBAQCBfX2lndF9jdHhfc3NldShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKIAlpZiAoZmxhZ3MgJiBURVNUX1JFU0VUKQogCQlpZ3RfZ2xvYmFsX3Jl
c2V0X2xvY2soJmk5MTUtPmd0KTsKIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwotCiAJY3R4ID0gbGl2ZV9jb250ZXh0KGk5MTUsIGZpbGUpOwogCWlmIChJU19FUlIoY3R4
KSkgewogCQlyZXQgPSBQVFJfRVJSKGN0eCk7CkBAIC0xMjc4LDggKzEyNjEsNiBAQCBfX2lndF9j
dHhfc3NldShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAlpOTE1X2dlbV9vYmplY3Rf
cHV0KG9iaik7CiAKIG91dF91bmxvY2s6Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0
X211dGV4KTsKLQogCWlmIChmbGFncyAmIFRFU1RfUkVTRVQpCiAJCWlndF9nbG9iYWxfcmVzZXRf
dW5sb2NrKCZpOTE1LT5ndCk7CiAKQEAgLTEzMzksMjMgKzEzMjAsMjQgQEAgc3RhdGljIGludCBp
Z3RfY3R4X3JlYWRvbmx5KHZvaWQgKmFyZykKIAlpZiAoSVNfRVJSKGZpbGUpKQogCQlyZXR1cm4g
UFRSX0VSUihmaWxlKTsKIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwot
CiAJZXJyID0gaWd0X2xpdmVfdGVzdF9iZWdpbigmdCwgaTkxNSwgX19mdW5jX18sICIiKTsKIAlp
ZiAoZXJyKQotCQlnb3RvIG91dF91bmxvY2s7CisJCWdvdG8gb3V0X2ZpbGU7CiAKIAljdHggPSBs
aXZlX2NvbnRleHQoaTkxNSwgZmlsZSk7CiAJaWYgKElTX0VSUihjdHgpKSB7CiAJCWVyciA9IFBU
Ul9FUlIoY3R4KTsKLQkJZ290byBvdXRfdW5sb2NrOworCQlnb3RvIG91dF9maWxlOwogCX0KIAot
CXZtID0gY3R4LT52bSA/OiAmaTkxNS0+Z2d0dC5hbGlhcy0+dm07CisJcmN1X3JlYWRfbG9jaygp
OworCXZtID0gcmN1X2RlcmVmZXJlbmNlKGN0eC0+dm0pID86ICZpOTE1LT5nZ3R0LmFsaWFzLT52
bTsKIAlpZiAoIXZtIHx8ICF2bS0+aGFzX3JlYWRfb25seSkgeworCQlyY3VfcmVhZF91bmxvY2so
KTsKIAkJZXJyID0gMDsKLQkJZ290byBvdXRfdW5sb2NrOworCQlnb3RvIG91dF9maWxlOwogCX0K
KwlyY3VfcmVhZF91bmxvY2soKTsKIAogCW5kd29yZHMgPSAwOwogCWR3ID0gMDsKQEAgLTEzNzMs
NyArMTM1NSw3IEBAIHN0YXRpYyBpbnQgaWd0X2N0eF9yZWFkb25seSh2b2lkICphcmcpCiAJCQkJ
aWYgKElTX0VSUihvYmopKSB7CiAJCQkJCWVyciA9IFBUUl9FUlIob2JqKTsKIAkJCQkJaTkxNV9n
ZW1fY29udGV4dF91bmxvY2tfZW5naW5lcyhjdHgpOwotCQkJCQlnb3RvIG91dF91bmxvY2s7CisJ
CQkJCWdvdG8gb3V0X2ZpbGU7CiAJCQkJfQogCiAJCQkJaWYgKHByYW5kb21fdTMyX3N0YXRlKCZw
cm5nKSAmIDEpCkBAIC0xMzg0LDE1ICsxMzY2LDE3IEBAIHN0YXRpYyBpbnQgaWd0X2N0eF9yZWFk
b25seSh2b2lkICphcmcpCiAJCQlpZiAoZXJyKSB7CiAJCQkJcHJfZXJyKCJGYWlsZWQgdG8gZmls
bCBkd29yZCAlbHUgWyVsdS8lbHVdIHdpdGggZ3B1ICglcykgW2Z1bGwtcHBndHQ/ICVzXSwgZXJy
PSVkXG4iLAogCQkJCSAgICAgICBuZHdvcmRzLCBkdywgbWF4X2R3b3JkcyhvYmopLAotCQkJCSAg
ICAgICBjZS0+ZW5naW5lLT5uYW1lLCB5ZXNubyghIWN0eC0+dm0pLCBlcnIpOworCQkJCSAgICAg
ICBjZS0+ZW5naW5lLT5uYW1lLAorCQkJCSAgICAgICB5ZXNubyghIXJjdV9hY2Nlc3NfcG9pbnRl
cihjdHgtPnZtKSksCisJCQkJICAgICAgIGVycik7CiAJCQkJaTkxNV9nZW1fY29udGV4dF91bmxv
Y2tfZW5naW5lcyhjdHgpOwotCQkJCWdvdG8gb3V0X3VubG9jazsKKwkJCQlnb3RvIG91dF9maWxl
OwogCQkJfQogCiAJCQllcnIgPSB0aHJvdHRsZShjZSwgdHEsIEFSUkFZX1NJWkUodHEpKTsKIAkJ
CWlmIChlcnIpIHsKIAkJCQlpOTE1X2dlbV9jb250ZXh0X3VubG9ja19lbmdpbmVzKGN0eCk7Ci0J
CQkJZ290byBvdXRfdW5sb2NrOworCQkJCWdvdG8gb3V0X2ZpbGU7CiAJCQl9CiAKIAkJCWlmICgr
K2R3ID09IG1heF9kd29yZHMob2JqKSkgewpAQCAtMTQyNCwyMCArMTQwOCwxOSBAQCBzdGF0aWMg
aW50IGlndF9jdHhfcmVhZG9ubHkodm9pZCAqYXJnKQogCQlkdyArPSByZW07CiAJfQogCi1vdXRf
dW5sb2NrOgorb3V0X2ZpbGU6CiAJdGhyb3R0bGVfcmVsZWFzZSh0cSwgQVJSQVlfU0laRSh0cSkp
OwogCWlmIChpZ3RfbGl2ZV90ZXN0X2VuZCgmdCkpCiAJCWVyciA9IC1FSU87Ci0JbXV0ZXhfdW5s
b2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAogCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZp
bGUpOwogCXJldHVybiBlcnI7CiB9CiAKLXN0YXRpYyBpbnQgY2hlY2tfc2NyYXRjaChzdHJ1Y3Qg
aTkxNV9nZW1fY29udGV4dCAqY3R4LCB1NjQgb2Zmc2V0KQorc3RhdGljIGludCBjaGVja19zY3Jh
dGNoKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtLCB1NjQgb2Zmc2V0KQogewogCXN0cnVj
dCBkcm1fbW1fbm9kZSAqbm9kZSA9Ci0JCV9fZHJtX21tX2ludGVydmFsX2ZpcnN0KCZjdHgtPnZt
LT5tbSwKKwkJX19kcm1fbW1faW50ZXJ2YWxfZmlyc3QoJnZtLT5tbSwKIAkJCQkJb2Zmc2V0LCBv
ZmZzZXQgKyBzaXplb2YodTMyKSAtIDEpOwogCWlmICghbm9kZSB8fCBub2RlLT5zdGFydCA+IG9m
ZnNldCkKIAkJcmV0dXJuIDA7CkBAIC0xNDU1LDYgKzE0MzgsNyBAQCBzdGF0aWMgaW50IHdyaXRl
X3RvX3NjcmF0Y2goc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKIHsKIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGN0eC0+aTkxNTsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29i
amVjdCAqb2JqOworCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtOwogCXN0cnVjdCBpOTE1
X3JlcXVlc3QgKnJxOwogCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwogCXUzMiAqY21kOwpAQCAtMTQ4
NywxNyArMTQ3MSwxOCBAQCBzdGF0aWMgaW50IHdyaXRlX3RvX3NjcmF0Y2goc3RydWN0IGk5MTVf
Z2VtX2NvbnRleHQgKmN0eCwKIAogCWludGVsX2d0X2NoaXBzZXRfZmx1c2goZW5naW5lLT5ndCk7
CiAKLQl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosIGN0eC0+dm0sIE5VTEwpOworCXZtID0g
aTkxNV9nZW1fY29udGV4dF9nZXRfdm1fcmN1KGN0eCk7CisJdm1hID0gaTkxNV92bWFfaW5zdGFu
Y2Uob2JqLCB2bSwgTlVMTCk7CiAJaWYgKElTX0VSUih2bWEpKSB7CiAJCWVyciA9IFBUUl9FUlIo
dm1hKTsKLQkJZ290byBlcnI7CisJCWdvdG8gZXJyX3ZtOwogCX0KIAogCWVyciA9IGk5MTVfdm1h
X3Bpbih2bWEsIDAsIDAsIFBJTl9VU0VSIHwgUElOX09GRlNFVF9GSVhFRCk7CiAJaWYgKGVycikK
LQkJZ290byBlcnI7CisJCWdvdG8gZXJyX3ZtOwogCi0JZXJyID0gY2hlY2tfc2NyYXRjaChjdHgs
IG9mZnNldCk7CisJZXJyID0gY2hlY2tfc2NyYXRjaCh2bSwgb2Zmc2V0KTsKIAlpZiAoZXJyKQog
CQlnb3RvIGVycl91bnBpbjsKIApAQCAtMTUyMyw2ICsxNTA4LDcgQEAgc3RhdGljIGludCB3cml0
ZV90b19zY3JhdGNoKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsCiAKIAlpOTE1X3JlcXVl
c3RfYWRkKHJxKTsKIAorCWk5MTVfdm1fcHV0KHZtKTsKIAlyZXR1cm4gMDsKIAogc2tpcF9yZXF1
ZXN0OgpAQCAtMTUzMSw2ICsxNTE3LDggQEAgc3RhdGljIGludCB3cml0ZV90b19zY3JhdGNoKHN0
cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsCiAJaTkxNV9yZXF1ZXN0X2FkZChycSk7CiBlcnJf
dW5waW46CiAJaTkxNV92bWFfdW5waW4odm1hKTsKK2Vycl92bToKKwlpOTE1X3ZtX3B1dCh2bSk7
CiBlcnI6CiAJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOwogCXJldHVybiBlcnI7CkBAIC0xNTQy
LDYgKzE1MzAsNyBAQCBzdGF0aWMgaW50IHJlYWRfZnJvbV9zY3JhdGNoKHN0cnVjdCBpOTE1X2dl
bV9jb250ZXh0ICpjdHgsCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBjdHgt
Pmk5MTU7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKKwlzdHJ1Y3QgaTkxNV9h
ZGRyZXNzX3NwYWNlICp2bTsKIAljb25zdCB1MzIgUkNTX0dQUjAgPSAweDI2MDA7IC8qIG5vdCBh
bGwgZW5naW5lcyBoYXZlIHRoZWlyIG93biBHUFIhICovCiAJY29uc3QgdTMyIHJlc3VsdCA9IDB4
MTAwOwogCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOwpAQCAtMTU4NiwxNyArMTU3NSwxOCBAQCBz
dGF0aWMgaW50IHJlYWRfZnJvbV9zY3JhdGNoKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgs
CiAKIAlpbnRlbF9ndF9jaGlwc2V0X2ZsdXNoKGVuZ2luZS0+Z3QpOwogCi0Jdm1hID0gaTkxNV92
bWFfaW5zdGFuY2Uob2JqLCBjdHgtPnZtLCBOVUxMKTsKKwl2bSA9IGk5MTVfZ2VtX2NvbnRleHRf
Z2V0X3ZtX3JjdShjdHgpOworCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9iaiwgdm0sIE5VTEwp
OwogCWlmIChJU19FUlIodm1hKSkgewogCQllcnIgPSBQVFJfRVJSKHZtYSk7Ci0JCWdvdG8gZXJy
OworCQlnb3RvIGVycl92bTsKIAl9CiAKIAllcnIgPSBpOTE1X3ZtYV9waW4odm1hLCAwLCAwLCBQ
SU5fVVNFUiB8IFBJTl9PRkZTRVRfRklYRUQpOwogCWlmIChlcnIpCi0JCWdvdG8gZXJyOworCQln
b3RvIGVycl92bTsKIAotCWVyciA9IGNoZWNrX3NjcmF0Y2goY3R4LCBvZmZzZXQpOworCWVyciA9
IGNoZWNrX3NjcmF0Y2godm0sIG9mZnNldCk7CiAJaWYgKGVycikKIAkJZ290byBlcnJfdW5waW47
CiAKQEAgLTE2MjcsMTIgKzE2MTcsMTIgQEAgc3RhdGljIGludCByZWFkX2Zyb21fc2NyYXRjaChz
dHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAogCWVyciA9IGk5MTVfZ2VtX29iamVjdF9zZXRf
dG9fY3B1X2RvbWFpbihvYmosIGZhbHNlKTsKIAlpOTE1X2dlbV9vYmplY3RfdW5sb2NrKG9iaik7
CiAJaWYgKGVycikKLQkJZ290byBlcnI7CisJCWdvdG8gZXJyX3ZtOwogCiAJY21kID0gaTkxNV9n
ZW1fb2JqZWN0X3Bpbl9tYXAob2JqLCBJOTE1X01BUF9XQik7CiAJaWYgKElTX0VSUihjbWQpKSB7
CiAJCWVyciA9IFBUUl9FUlIoY21kKTsKLQkJZ290byBlcnI7CisJCWdvdG8gZXJyX3ZtOwogCX0K
IAogCSp2YWx1ZSA9IGNtZFtyZXN1bHQgLyBzaXplb2YoKmNtZCldOwpAQCAtMTY0Nyw2ICsxNjM3
LDggQEAgc3RhdGljIGludCByZWFkX2Zyb21fc2NyYXRjaChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4
dCAqY3R4LAogCWk5MTVfcmVxdWVzdF9hZGQocnEpOwogZXJyX3VucGluOgogCWk5MTVfdm1hX3Vu
cGluKHZtYSk7CitlcnJfdm06CisJaTkxNV92bV9wdXQodm0pOwogZXJyOgogCWk5MTVfZ2VtX29i
amVjdF9wdXQob2JqKTsKIAlyZXR1cm4gZXJyOwpAQCAtMTY3NywyNyArMTY2OSwyNSBAQCBzdGF0
aWMgaW50IGlndF92bV9pc29sYXRpb24odm9pZCAqYXJnKQogCWlmIChJU19FUlIoZmlsZSkpCiAJ
CXJldHVybiBQVFJfRVJSKGZpbGUpOwogCi0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9t
dXRleCk7Ci0KIAllcnIgPSBpZ3RfbGl2ZV90ZXN0X2JlZ2luKCZ0LCBpOTE1LCBfX2Z1bmNfXywg
IiIpOwogCWlmIChlcnIpCi0JCWdvdG8gb3V0X3VubG9jazsKKwkJZ290byBvdXRfZmlsZTsKIAog
CWN0eF9hID0gbGl2ZV9jb250ZXh0KGk5MTUsIGZpbGUpOwogCWlmIChJU19FUlIoY3R4X2EpKSB7
CiAJCWVyciA9IFBUUl9FUlIoY3R4X2EpOwotCQlnb3RvIG91dF91bmxvY2s7CisJCWdvdG8gb3V0
X2ZpbGU7CiAJfQogCiAJY3R4X2IgPSBsaXZlX2NvbnRleHQoaTkxNSwgZmlsZSk7CiAJaWYgKElT
X0VSUihjdHhfYikpIHsKIAkJZXJyID0gUFRSX0VSUihjdHhfYik7Ci0JCWdvdG8gb3V0X3VubG9j
azsKKwkJZ290byBvdXRfZmlsZTsKIAl9CiAKIAkvKiBXZSBjYW4gb25seSB0ZXN0IHZtIGlzb2xh
dGlvbiwgaWYgdGhlIHZtIGFyZSBkaXN0aW5jdCAqLwogCWlmIChjdHhfYS0+dm0gPT0gY3R4X2It
PnZtKQotCQlnb3RvIG91dF91bmxvY2s7CisJCWdvdG8gb3V0X2ZpbGU7CiAKIAl2bV90b3RhbCA9
IGN0eF9hLT52bS0+dG90YWw7CiAJR0VNX0JVR19PTihjdHhfYi0+dm0tPnRvdGFsICE9IHZtX3Rv
dGFsKTsKQEAgLTE3MjYsNyArMTcxNiw3IEBAIHN0YXRpYyBpbnQgaWd0X3ZtX2lzb2xhdGlvbih2
b2lkICphcmcpCiAJCQkJZXJyID0gcmVhZF9mcm9tX3NjcmF0Y2goY3R4X2IsIGVuZ2luZSwKIAkJ
CQkJCQlvZmZzZXQsICZ2YWx1ZSk7CiAJCQlpZiAoZXJyKQotCQkJCWdvdG8gb3V0X3VubG9jazsK
KwkJCQlnb3RvIG91dF9maWxlOwogCiAJCQlpZiAodmFsdWUpIHsKIAkJCQlwcl9lcnIoIiVzOiBS
ZWFkICUwOHggZnJvbSBzY3JhdGNoIChvZmZzZXQgMHglMDh4XyUwOHgpLCBhZnRlciAlbHUgcmVh
ZHMhXG4iLApAQCAtMTczNSw3ICsxNzI1LDcgQEAgc3RhdGljIGludCBpZ3Rfdm1faXNvbGF0aW9u
KHZvaWQgKmFyZykKIAkJCQkgICAgICAgbG93ZXJfMzJfYml0cyhvZmZzZXQpLAogCQkJCSAgICAg
ICB0aGlzKTsKIAkJCQllcnIgPSAtRUlOVkFMOwotCQkJCWdvdG8gb3V0X3VubG9jazsKKwkJCQln
b3RvIG91dF9maWxlOwogCQkJfQogCiAJCQl0aGlzKys7CkBAIC0xNzQ1LDExICsxNzM1LDkgQEAg
c3RhdGljIGludCBpZ3Rfdm1faXNvbGF0aW9uKHZvaWQgKmFyZykKIAlwcl9pbmZvKCJDaGVja2Vk
ICVsdSBzY3JhdGNoIG9mZnNldHMgYWNyb3NzICVkIGVuZ2luZXNcbiIsCiAJCWNvdW50LCBSVU5U
SU1FX0lORk8oaTkxNSktPm51bV9lbmdpbmVzKTsKIAotb3V0X3VubG9jazoKK291dF9maWxlOgog
CWlmIChpZ3RfbGl2ZV90ZXN0X2VuZCgmdCkpCiAJCWVyciA9IC1FSU87Ci0JbXV0ZXhfdW5sb2Nr
KCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQogCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUp
OwogCXJldHVybiBlcnI7CiB9CkBAIC0xNzgxLDEzICsxNzY5LDkgQEAgc3RhdGljIGludCBtb2Nr
X2NvbnRleHRfYmFycmllcih2b2lkICphcmcpCiAJICogYSByZXF1ZXN0OyB1c2VmdWwgZm9yIHJl
dGlyaW5nIG9sZCBzdGF0ZSBhZnRlciBsb2FkaW5nIG5ldy4KIAkgKi8KIAotCW11dGV4X2xvY2so
Jmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCiAJY3R4ID0gbW9ja19jb250ZXh0KGk5MTUsICJt
b2NrIik7Ci0JaWYgKCFjdHgpIHsKLQkJZXJyID0gLUVOT01FTTsKLQkJZ290byB1bmxvY2s7Ci0J
fQorCWlmICghY3R4KQorCQlyZXR1cm4gLUVOT01FTTsKIAogCWNvdW50ZXIgPSAwOwogCWVyciA9
IGNvbnRleHRfYmFycmllcl90YXNrKGN0eCwgMCwKQEAgLTE4NjAsOCArMTg0NCw2IEBAIHN0YXRp
YyBpbnQgbW9ja19jb250ZXh0X2JhcnJpZXIodm9pZCAqYXJnKQogCiBvdXQ6CiAJbW9ja19jb250
ZXh0X2Nsb3NlKGN0eCk7Ci11bmxvY2s6Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0
X211dGV4KTsKIAlyZXR1cm4gZXJyOwogI3VuZGVmIHByX2ZtdAogI2RlZmluZSBwcl9mbXQoeCkg
eApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9tb2NrX2Nv
bnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvbW9ja19jb250ZXh0
LmMKaW5kZXggMDEwNGYxNmIxMzI3Li5mZDc5OWRlZmQ4YmUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvbW9ja19jb250ZXh0LmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9tb2NrX2NvbnRleHQuYwpAQCAtNjUsNyArNjUsNyBA
QCB2b2lkIG1vY2tfY29udGV4dF9jbG9zZShzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQog
CiB2b2lkIG1vY2tfaW5pdF9jb250ZXh0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
IHsKLQlpbml0X2NvbnRleHRzKGk5MTUpOworCWluaXRfY29udGV4dHMoJmk5MTUtPmdlbS5jb250
ZXh0cyk7CiB9CiAKIHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICoKQEAgLTc0LDggKzc0LDYgQEAg
bGl2ZV9jb250ZXh0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBzdHJ1Y3QgZHJtX2Zp
bGUgKmZpbGUpCiAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eDsKIAlpbnQgZXJyOwogCi0J
bG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0KIAljdHggPSBp
OTE1X2dlbV9jcmVhdGVfY29udGV4dChpOTE1LCAwKTsKIAlpZiAoSVNfRVJSKGN0eCkpCiAJCXJl
dHVybiBjdHg7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250
ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMKaW5kZXggMzVh
NDBjMjgyMGEyLi5iZTM0ZDk3YWMxOGYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2NvbnRleHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9j
b250ZXh0LmMKQEAgLTIyMSwxMiArMjIxLDIwIEBAIGludGVsX2NvbnRleHRfaW5pdChzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqY2UsCiAJCSAgIHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsCiAJ
CSAgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsKKwlzdHJ1Y3QgaTkxNV9hZGRy
ZXNzX3NwYWNlICp2bTsKKwogCUdFTV9CVUdfT04oIWVuZ2luZS0+Y29wcyk7CiAKIAlrcmVmX2lu
aXQoJmNlLT5yZWYpOwogCiAJY2UtPmdlbV9jb250ZXh0ID0gY3R4OwotCWNlLT52bSA9IGk5MTVf
dm1fZ2V0KGN0eC0+dm0gPzogJmVuZ2luZS0+Z3QtPmdndHQtPnZtKTsKKwlyY3VfcmVhZF9sb2Nr
KCk7CisJdm0gPSByY3VfZGVyZWZlcmVuY2UoY3R4LT52bSk7CisJaWYgKHZtKQorCQljZS0+dm0g
PSBpOTE1X3ZtX2dldCh2bSk7CisJZWxzZQorCQljZS0+dm0gPSBpOTE1X3ZtX2dldCgmZW5naW5l
LT5ndC0+Z2d0dC0+dm0pOworCXJjdV9yZWFkX3VubG9jaygpOwogCWlmIChjdHgtPnRpbWVsaW5l
KQogCQljZS0+dGltZWxpbmUgPSBpbnRlbF90aW1lbGluZV9nZXQoY3R4LT50aW1lbGluZSk7CiAK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKaW5kZXggZmM4YzkzZGY0MjM2Li5kNjI1MzAz
ODg4Y2IgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCkBAIC05ODEsNiArOTgxLDEx
IEBAIF9fZXhlY2xpc3RzX3NjaGVkdWxlX2luKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogCQlj
ZS0+bHJjX2Rlc2MgfD0KIAkJCSh1NjQpKGVuZ2luZS0+Y29udGV4dF90YWcrKyAlIE5VTV9DT05U
RVhUX1RBRykgPDwKIAkJCUdFTjExX1NXX0NUWF9JRF9TSElGVDsKKworI2RlZmluZSBHRU4xMV9N
QVhfQ09OVEVYVF9IV19JRCAoMTw8MTEpIC8qIGV4Y2x1c2l2ZSAqLworLyogaW4gR2VuMTIgSUQg
MHg3RkYgaXMgcmVzZXJ2ZWQgdG8gaW5kaWNhdGUgaWRsZSAqLworI2RlZmluZSBHRU4xMl9NQVhf
Q09OVEVYVF9IV19JRCAgICAgICAgKEdFTjExX01BWF9DT05URVhUX0hXX0lEIC0gMSkKKwogCQlC
VUlMRF9CVUdfT04oTlVNX0NPTlRFWFRfVEFHID4gR0VOMTJfTUFYX0NPTlRFWFRfSFdfSUQpOwog
CX0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfY29udGV4
dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfY29udGV4dC5jCmluZGV4IDg2
Y2ZmYmIwYTljYi4uN2M4MzhhNTdlMTc0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9zZWxmdGVzdF9jb250ZXh0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2Vs
ZnRlc3RfY29udGV4dC5jCkBAIC0xNTUsMTMgKzE1NSw5IEBAIHN0YXRpYyBpbnQgbGl2ZV9jb250
ZXh0X3NpemUodm9pZCAqYXJnKQogCSAqIEhXIHRyaWVzIHRvIHdyaXRlIHBhc3QgdGhlIGVuZCBv
ZiBvbmUuCiAJICovCiAKLQltdXRleF9sb2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7
Ci0KIAlmaXhtZSA9IGtlcm5lbF9jb250ZXh0KGd0LT5pOTE1KTsKLQlpZiAoSVNfRVJSKGZpeG1l
KSkgewotCQllcnIgPSBQVFJfRVJSKGZpeG1lKTsKLQkJZ290byB1bmxvY2s7Ci0JfQorCWlmIChJ
U19FUlIoZml4bWUpKQorCQlyZXR1cm4gUFRSX0VSUihmaXhtZSk7CiAKIAlmb3JfZWFjaF9lbmdp
bmUoZW5naW5lLCBndC0+aTkxNSwgaWQpIHsKIAkJc3RydWN0IHsKQEAgLTIwMSw4ICsxOTcsNiBA
QCBzdGF0aWMgaW50IGxpdmVfY29udGV4dF9zaXplKHZvaWQgKmFyZykKIAl9CiAKIAlrZXJuZWxf
Y29udGV4dF9jbG9zZShmaXhtZSk7Ci11bmxvY2s6Ci0JbXV0ZXhfdW5sb2NrKCZndC0+aTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7CiAJcmV0dXJuIGVycjsKIH0KIApAQCAtMzA1LDEyICsyOTksMTAg
QEAgc3RhdGljIGludCBsaXZlX2FjdGl2ZV9jb250ZXh0KHZvaWQgKmFyZykKIAlpZiAoSVNfRVJS
KGZpbGUpKQogCQlyZXR1cm4gUFRSX0VSUihmaWxlKTsKIAotCW11dGV4X2xvY2soJmd0LT5pOTE1
LT5kcm0uc3RydWN0X211dGV4KTsKLQogCWZpeG1lID0gbGl2ZV9jb250ZXh0KGd0LT5pOTE1LCBm
aWxlKTsKIAlpZiAoSVNfRVJSKGZpeG1lKSkgewogCQllcnIgPSBQVFJfRVJSKGZpeG1lKTsKLQkJ
Z290byB1bmxvY2s7CisJCWdvdG8gb3V0X2ZpbGU7CiAJfQogCiAJZm9yX2VhY2hfZW5naW5lKGVu
Z2luZSwgZ3QtPmk5MTUsIGlkKSB7CkBAIC0zMjMsOCArMzE1LDcgQEAgc3RhdGljIGludCBsaXZl
X2FjdGl2ZV9jb250ZXh0KHZvaWQgKmFyZykKIAkJCWJyZWFrOwogCX0KIAotdW5sb2NrOgotCW11
dGV4X3VubG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworb3V0X2ZpbGU6CiAJbW9j
a19maWxlX2ZyZWUoZ3QtPmk5MTUsIGZpbGUpOwogCXJldHVybiBlcnI7CiB9CkBAIC00MTgsMTIg
KzQwOSwxMCBAQCBzdGF0aWMgaW50IGxpdmVfcmVtb3RlX2NvbnRleHQodm9pZCAqYXJnKQogCWlm
IChJU19FUlIoZmlsZSkpCiAJCXJldHVybiBQVFJfRVJSKGZpbGUpOwogCi0JbXV0ZXhfbG9jaygm
Z3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCiAJZml4bWUgPSBsaXZlX2NvbnRleHQoZ3Qt
Pmk5MTUsIGZpbGUpOwogCWlmIChJU19FUlIoZml4bWUpKSB7CiAJCWVyciA9IFBUUl9FUlIoZml4
bWUpOwotCQlnb3RvIHVubG9jazsKKwkJZ290byBvdXRfZmlsZTsKIAl9CiAKIAlmb3JfZWFjaF9l
bmdpbmUoZW5naW5lLCBndC0+aTkxNSwgaWQpIHsKQEAgLTQzNiw4ICs0MjUsNyBAQCBzdGF0aWMg
aW50IGxpdmVfcmVtb3RlX2NvbnRleHQodm9pZCAqYXJnKQogCQkJYnJlYWs7CiAJfQogCi11bmxv
Y2s6Ci0JbXV0ZXhfdW5sb2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CitvdXRfZmls
ZToKIAltb2NrX2ZpbGVfZnJlZShndC0+aTkxNSwgZmlsZSk7CiAJcmV0dXJuIGVycjsKIH0KZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfaGFuZ2NoZWNrLmMKaW5kZXggZmZiYjNk
MjNiODg3Li5lOGE0MGRmNzliZDAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L3NlbGZ0ZXN0X2hhbmdjaGVjay5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0
ZXN0X2hhbmdjaGVjay5jCkBAIC01OCw5ICs1OCw3IEBAIHN0YXRpYyBpbnQgaGFuZ19pbml0KHN0
cnVjdCBoYW5nICpoLCBzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogCW1lbXNldChoLCAwLCBzaXplb2Yo
KmgpKTsKIAloLT5ndCA9IGd0OwogCi0JbXV0ZXhfbG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3Rf
bXV0ZXgpOwogCWgtPmN0eCA9IGtlcm5lbF9jb250ZXh0KGd0LT5pOTE1KTsKLQltdXRleF91bmxv
Y2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlpZiAoSVNfRVJSKGgtPmN0eCkpCiAJ
CXJldHVybiBQVFJfRVJSKGgtPmN0eCk7CiAKQEAgLTEzMyw3ICsxMzEsNyBAQCBzdGF0aWMgc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqCiBoYW5nX2NyZWF0ZV9yZXF1ZXN0KHN0cnVjdCBoYW5nICpoLCBz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7CiAJc3RydWN0IGludGVsX2d0ICpndCA9
IGgtPmd0OwotCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0gaC0+Y3R4LT52bSA/OiAm
ZW5naW5lLT5ndC0+Z2d0dC0+dm07CisJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSBp
OTE1X2dlbV9jb250ZXh0X2dldF92bV9yY3UoaC0+Y3R4KTsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdCAqb2JqOwogCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxID0gTlVMTDsKIAlzdHJ1Y3Qg
aTkxNV92bWEgKmh3cywgKnZtYTsKQEAgLTE0MywxMiArMTQxLDE1IEBAIGhhbmdfY3JlYXRlX3Jl
cXVlc3Qoc3RydWN0IGhhbmcgKmgsIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAlp
bnQgZXJyOwogCiAJb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5hbChndC0+aTkx
NSwgUEFHRV9TSVpFKTsKLQlpZiAoSVNfRVJSKG9iaikpCisJaWYgKElTX0VSUihvYmopKSB7CisJ
CWk5MTVfdm1fcHV0KHZtKTsKIAkJcmV0dXJuIEVSUl9DQVNUKG9iaik7CisJfQogCiAJdmFkZHIg
PSBpOTE1X2dlbV9vYmplY3RfcGluX21hcChvYmosIGk5MTVfY29oZXJlbnRfbWFwX3R5cGUoZ3Qt
Pmk5MTUpKTsKIAlpZiAoSVNfRVJSKHZhZGRyKSkgewogCQlpOTE1X2dlbV9vYmplY3RfcHV0KG9i
aik7CisJCWk5MTVfdm1fcHV0KHZtKTsKIAkJcmV0dXJuIEVSUl9DQVNUKHZhZGRyKTsKIAl9CiAK
QEAgLTE1OSwxNiArMTYwLDIyIEBAIGhhbmdfY3JlYXRlX3JlcXVlc3Qoc3RydWN0IGhhbmcgKmgs
IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAloLT5iYXRjaCA9IHZhZGRyOwogCiAJ
dm1hID0gaTkxNV92bWFfaW5zdGFuY2UoaC0+b2JqLCB2bSwgTlVMTCk7Ci0JaWYgKElTX0VSUih2
bWEpKQorCWlmIChJU19FUlIodm1hKSkgeworCQlpOTE1X3ZtX3B1dCh2bSk7CiAJCXJldHVybiBF
UlJfQ0FTVCh2bWEpOworCX0KIAogCWh3cyA9IGk5MTVfdm1hX2luc3RhbmNlKGgtPmh3cywgdm0s
IE5VTEwpOwotCWlmIChJU19FUlIoaHdzKSkKKwlpZiAoSVNfRVJSKGh3cykpIHsKKwkJaTkxNV92
bV9wdXQodm0pOwogCQlyZXR1cm4gRVJSX0NBU1QoaHdzKTsKKwl9CiAKIAllcnIgPSBpOTE1X3Zt
YV9waW4odm1hLCAwLCAwLCBQSU5fVVNFUik7Ci0JaWYgKGVycikKKwlpZiAoZXJyKSB7CisJCWk5
MTVfdm1fcHV0KHZtKTsKIAkJcmV0dXJuIEVSUl9QVFIoZXJyKTsKKwl9CiAKIAllcnIgPSBpOTE1
X3ZtYV9waW4oaHdzLCAwLCAwLCBQSU5fVVNFUik7CiAJaWYgKGVycikKQEAgLTI2Niw2ICsyNzMs
NyBAQCBoYW5nX2NyZWF0ZV9yZXF1ZXN0KHN0cnVjdCBoYW5nICpoLCBzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmUpCiAJaTkxNV92bWFfdW5waW4oaHdzKTsKIHVucGluX3ZtYToKIAlpOTE1
X3ZtYV91bnBpbih2bWEpOworCWk5MTVfdm1fcHV0KHZtKTsKIAlyZXR1cm4gZXJyID8gRVJSX1BU
UihlcnIpIDogcnE7CiB9CiAKQEAgLTM4Miw5ICszOTAsNyBAQCBzdGF0aWMgaW50IGlndF9yZXNl
dF9ub3Aodm9pZCAqYXJnKQogCWlmIChJU19FUlIoZmlsZSkpCiAJCXJldHVybiBQVFJfRVJSKGZp
bGUpOwogCi0JbXV0ZXhfbG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWN0eCA9
IGxpdmVfY29udGV4dChndC0+aTkxNSwgZmlsZSk7Ci0JbXV0ZXhfdW5sb2NrKCZndC0+aTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7CiAJaWYgKElTX0VSUihjdHgpKSB7CiAJCWVyciA9IFBUUl9FUlIo
Y3R4KTsKIAkJZ290byBvdXQ7CkBAIC00NTgsOSArNDY0LDcgQEAgc3RhdGljIGludCBpZ3RfcmVz
ZXRfbm9wX2VuZ2luZSh2b2lkICphcmcpCiAJaWYgKElTX0VSUihmaWxlKSkKIAkJcmV0dXJuIFBU
Ul9FUlIoZmlsZSk7CiAKLQltdXRleF9sb2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7
CiAJY3R4ID0gbGl2ZV9jb250ZXh0KGd0LT5pOTE1LCBmaWxlKTsKLQltdXRleF91bmxvY2soJmd0
LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlpZiAoSVNfRVJSKGN0eCkpIHsKIAkJZXJyID0g
UFRSX0VSUihjdHgpOwogCQlnb3RvIG91dDsKQEAgLTcwNSw5ICs3MDksNyBAQCBzdGF0aWMgaW50
IGFjdGl2ZV9lbmdpbmUodm9pZCAqZGF0YSkKIAkJcmV0dXJuIFBUUl9FUlIoZmlsZSk7CiAKIAlm
b3IgKGNvdW50ID0gMDsgY291bnQgPCBBUlJBWV9TSVpFKGN0eCk7IGNvdW50KyspIHsKLQkJbXV0
ZXhfbG9jaygmZW5naW5lLT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAkJY3R4W2NvdW50XSA9
IGxpdmVfY29udGV4dChlbmdpbmUtPmk5MTUsIGZpbGUpOwotCQltdXRleF91bmxvY2soJmVuZ2lu
ZS0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJCWlmIChJU19FUlIoY3R4W2NvdW50XSkpIHsK
IAkJCWVyciA9IFBUUl9FUlIoY3R4W2NvdW50XSk7CiAJCQl3aGlsZSAoLS1jb3VudCkKQEAgLTEy
OTEsNiArMTI5Myw3IEBAIHN0YXRpYyBpbnQgaWd0X3Jlc2V0X2V2aWN0X3BwZ3R0KHZvaWQgKmFy
ZykKIHsKIAlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOwogCXN0cnVjdCBpOTE1X2dlbV9jb250
ZXh0ICpjdHg7CisJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm07CiAJc3RydWN0IGRybV9m
aWxlICpmaWxlOwogCWludCBlcnI7CiAKQEAgLTEyOTgsMTggKzEzMDEsMjAgQEAgc3RhdGljIGlu
dCBpZ3RfcmVzZXRfZXZpY3RfcHBndHQodm9pZCAqYXJnKQogCWlmIChJU19FUlIoZmlsZSkpCiAJ
CXJldHVybiBQVFJfRVJSKGZpbGUpOwogCi0JbXV0ZXhfbG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1
Y3RfbXV0ZXgpOwogCWN0eCA9IGxpdmVfY29udGV4dChndC0+aTkxNSwgZmlsZSk7Ci0JbXV0ZXhf
dW5sb2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJaWYgKElTX0VSUihjdHgpKSB7
CiAJCWVyciA9IFBUUl9FUlIoY3R4KTsKIAkJZ290byBvdXQ7CiAJfQogCiAJZXJyID0gMDsKLQlp
ZiAoY3R4LT52bSkgLyogYWxpYXNpbmcgPT0gZ2xvYmFsIGd0dCBsb2NraW5nLCBjb3ZlcmVkIGFi
b3ZlICovCi0JCWVyciA9IF9faWd0X3Jlc2V0X2V2aWN0X3ZtYShndCwgY3R4LT52bSwKKwl2bSA9
IGk5MTVfZ2VtX2NvbnRleHRfZ2V0X3ZtX3JjdShjdHgpOworCWlmICghaTkxNV9pc19nZ3R0KHZt
KSkgeworCQkvKiBhbGlhc2luZyA9PSBnbG9iYWwgZ3R0IGxvY2tpbmcsIGNvdmVyZWQgYWJvdmUg
Ki8KKwkJZXJyID0gX19pZ3RfcmVzZXRfZXZpY3Rfdm1hKGd0LCB2bSwKIAkJCQkJICAgIGV2aWN0
X3ZtYSwgRVhFQ19PQkpFQ1RfV1JJVEUpOworCX0KKwlpOTE1X3ZtX3B1dCh2bSk7CiAKIG91dDoK
IAltb2NrX2ZpbGVfZnJlZShndC0+aTkxNSwgZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3Nl
bGZ0ZXN0X2xyYy5jCmluZGV4IDA0YzFjZjU3MzY0Mi4uOGRjNDJjNWM3NTY5IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwpAQCAtMTYzMSw3ICsxNjMxLDExIEBAIHN0YXRp
YyBpbnQgc21va2Vfc3VibWl0KHN0cnVjdCBwcmVlbXB0X3Ntb2tlICpzbW9rZSwKIAlpbnQgZXJy
ID0gMDsKIAogCWlmIChiYXRjaCkgewotCQl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShiYXRjaCwg
Y3R4LT52bSwgTlVMTCk7CisJCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtOworCisJCXZt
ID0gaTkxNV9nZW1fY29udGV4dF9nZXRfdm1fcmN1KGN0eCk7CisJCXZtYSA9IGk5MTVfdm1hX2lu
c3RhbmNlKGJhdGNoLCB2bSwgTlVMTCk7CisJCWk5MTVfdm1fcHV0KHZtKTsKIAkJaWYgKElTX0VS
Uih2bWEpKQogCQkJcmV0dXJuIFBUUl9FUlIodm1hKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rfd29ya2Fyb3VuZHMuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMKaW5kZXggNGVlMmUyYmFiZDBkLi5kMTc5NzZk
OWZiOTEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmth
cm91bmRzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rfd29ya2Fyb3Vu
ZHMuYwpAQCAtMzMsNiArMzMsOCBAQCBzdHJ1Y3Qgd2FfbGlzdHMgewogCX0gZW5naW5lW0k5MTVf
TlVNX0VOR0lORVNdOwogfTsKIAorI2RlZmluZSBjdHhfdm0oY3R4KSByY3VfZGVyZWZlcmVuY2Vf
cHJvdGVjdGVkKChjdHgpLT52bSwgdHJ1ZSkKKwogc3RhdGljIHZvaWQKIHJlZmVyZW5jZV9saXN0
c19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBzdHJ1Y3Qgd2FfbGlzdHMgKmxp
c3RzKQogewpAQCAtMzYyLDcgKzM2NCw3IEBAIHN0YXRpYyBzdHJ1Y3QgaTkxNV92bWEgKmNyZWF0
ZV9iYXRjaChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQogCWlmIChJU19FUlIob2JqKSkK
IAkJcmV0dXJuIEVSUl9DQVNUKG9iaik7CiAKLQl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmos
IGN0eC0+dm0sIE5VTEwpOworCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9iaiwgY3R4X3ZtKGN0
eCksIE5VTEwpOwogCWlmIChJU19FUlIodm1hKSkgewogCQllcnIgPSBQVFJfRVJSKHZtYSk7CiAJ
CWdvdG8gZXJyX29iajsKQEAgLTQ2OCw3ICs0NzAsNyBAQCBzdGF0aWMgaW50IGNoZWNrX2RpcnR5
X3doaXRlbGlzdChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAogCWludCBlcnIgPSAwLCBp
LCB2OwogCXUzMiAqY3MsICpyZXN1bHRzOwogCi0Jc2NyYXRjaCA9IGNyZWF0ZV9zY3JhdGNoKGN0
eC0+dm0sIDIgKiBBUlJBWV9TSVpFKHZhbHVlcykgKyAxKTsKKwlzY3JhdGNoID0gY3JlYXRlX3Nj
cmF0Y2goY3R4X3ZtKGN0eCksIDIgKiBBUlJBWV9TSVpFKHZhbHVlcykgKyAxKTsKIAlpZiAoSVNf
RVJSKHNjcmF0Y2gpKQogCQlyZXR1cm4gUFRSX0VSUihzY3JhdGNoKTsKIApAQCAtMTAxOCwxNCAr
MTAyMCwxNCBAQCBzdGF0aWMgaW50IGxpdmVfaXNvbGF0ZWRfd2hpdGVsaXN0KHZvaWQgKmFyZykK
IAkJCWdvdG8gZXJyOwogCQl9CiAKLQkJY2xpZW50W2ldLnNjcmF0Y2hbMF0gPSBjcmVhdGVfc2Ny
YXRjaChjLT52bSwgMTAyNCk7CisJCWNsaWVudFtpXS5zY3JhdGNoWzBdID0gY3JlYXRlX3NjcmF0
Y2goY3R4X3ZtKGMpLCAxMDI0KTsKIAkJaWYgKElTX0VSUihjbGllbnRbaV0uc2NyYXRjaFswXSkp
IHsKIAkJCWVyciA9IFBUUl9FUlIoY2xpZW50W2ldLnNjcmF0Y2hbMF0pOwogCQkJa2VybmVsX2Nv
bnRleHRfY2xvc2UoYyk7CiAJCQlnb3RvIGVycjsKIAkJfQogCi0JCWNsaWVudFtpXS5zY3JhdGNo
WzFdID0gY3JlYXRlX3NjcmF0Y2goYy0+dm0sIDEwMjQpOworCQljbGllbnRbaV0uc2NyYXRjaFsx
XSA9IGNyZWF0ZV9zY3JhdGNoKGN0eF92bShjKSwgMTAyNCk7CiAJCWlmIChJU19FUlIoY2xpZW50
W2ldLnNjcmF0Y2hbMV0pKSB7CiAJCQllcnIgPSBQVFJfRVJSKGNsaWVudFtpXS5zY3JhdGNoWzFd
KTsKIAkJCWk5MTVfdm1hX3VucGluX2FuZF9yZWxlYXNlKCZjbGllbnRbaV0uc2NyYXRjaFswXSwg
MCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMKaW5kZXggMDNmNTY3MDg0NTQ4Li42
ODUwZjFmNDAyNDEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVs
ZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMKQEAgLTM2NSw3
ICszNjUsOCBAQCBzdGF0aWMgdm9pZCBzZXRfY29udGV4dF9wcGd0dF9mcm9tX3NoYWRvdyhzdHJ1
Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xvYWQsCiAJCQkJCSAgc3RydWN0IGk5MTVfZ2Vt
X2NvbnRleHQgKmN0eCkKIHsKIAlzdHJ1Y3QgaW50ZWxfdmdwdV9tbSAqbW0gPSB3b3JrbG9hZC0+
c2hhZG93X21tOwotCXN0cnVjdCBpOTE1X3BwZ3R0ICpwcGd0dCA9IGk5MTVfdm1fdG9fcHBndHQo
Y3R4LT52bSk7CisJc3RydWN0IGk5MTVfcHBndHQgKnBwZ3R0ID0KKwkJaTkxNV92bV90b19wcGd0
dChpOTE1X2dlbV9jb250ZXh0X2dldF92bV9yY3UoY3R4KSk7CiAJaW50IGkgPSAwOwogCiAJaWYg
KG1tLT5wcGd0dF9tbS5yb290X2VudHJ5X3R5cGUgPT0gR1RUX1RZUEVfUFBHVFRfUk9PVF9MNF9F
TlRSWSkgewpAQCAtMzc4LDYgKzM3OSw4IEBAIHN0YXRpYyB2b2lkIHNldF9jb250ZXh0X3BwZ3R0
X2Zyb21fc2hhZG93KHN0cnVjdCBpbnRlbF92Z3B1X3dvcmtsb2FkICp3b3JrbG9hZCwKIAkJCXB4
X2RtYShwZCkgPSBtbS0+cHBndHRfbW0uc2hhZG93X3BkcHNbaV07CiAJCX0KIAl9CisKKwlpOTE1
X3ZtX3B1dCgmcHBndHQtPnZtKTsKIH0KIAogc3RhdGljIGludApAQCAtMTIzMCwyMCArMTIzMywx
OCBAQCBpbnQgaW50ZWxfdmdwdV9zZXR1cF9zdWJtaXNzaW9uKHN0cnVjdCBpbnRlbF92Z3B1ICp2
Z3B1KQogCXN0cnVjdCBpbnRlbF92Z3B1X3N1Ym1pc3Npb24gKnMgPSAmdmdwdS0+c3VibWlzc2lv
bjsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CiAJc3RydWN0IGk5MTVfZ2VtX2Nv
bnRleHQgKmN0eDsKKwlzdHJ1Y3QgaTkxNV9wcGd0dCAqcHBndHQ7CiAJZW51bSBpbnRlbF9lbmdp
bmVfaWQgaTsKIAlpbnQgcmV0OwogCi0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRl
eCk7Ci0KIAljdHggPSBpOTE1X2dlbV9jb250ZXh0X2NyZWF0ZV9rZXJuZWwoaTkxNSwgSTkxNV9Q
UklPUklUWV9NQVgpOwotCWlmIChJU19FUlIoY3R4KSkgewotCQlyZXQgPSBQVFJfRVJSKGN0eCk7
Ci0JCWdvdG8gb3V0X3VubG9jazsKLQl9CisJaWYgKElTX0VSUihjdHgpKQorCQlyZXR1cm4gUFRS
X0VSUihjdHgpOwogCiAJaTkxNV9nZW1fY29udGV4dF9zZXRfZm9yY2Vfc2luZ2xlX3N1Ym1pc3Np
b24oY3R4KTsKIAotCWk5MTVfY29udGV4dF9wcGd0dF9yb290X3NhdmUocywgaTkxNV92bV90b19w
cGd0dChjdHgtPnZtKSk7CisJcHBndHQgPSBpOTE1X3ZtX3RvX3BwZ3R0KGk5MTVfZ2VtX2NvbnRl
eHRfZ2V0X3ZtX3JjdShjdHgpKTsKKwlpOTE1X2NvbnRleHRfcHBndHRfcm9vdF9zYXZlKHMsIHBw
Z3R0KTsKIAogCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGkpIHsKIAkJc3RydWN0IGlu
dGVsX2NvbnRleHQgKmNlOwpAQCAtMTI4OCwxMiArMTI4OSwxMiBAQCBpbnQgaW50ZWxfdmdwdV9z
ZXR1cF9zdWJtaXNzaW9uKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQogCWF0b21pY19zZXQoJnMt
PnJ1bm5pbmdfd29ya2xvYWRfbnVtLCAwKTsKIAliaXRtYXBfemVybyhzLT50bGJfaGFuZGxlX3Bl
bmRpbmcsIEk5MTVfTlVNX0VOR0lORVMpOwogCisJaTkxNV92bV9wdXQoJnBwZ3R0LT52bSk7CiAJ
aTkxNV9nZW1fY29udGV4dF9wdXQoY3R4KTsKLQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1
Y3RfbXV0ZXgpOwogCXJldHVybiAwOwogCiBvdXRfc2hhZG93X2N0eDoKLQlpOTE1X2NvbnRleHRf
cHBndHRfcm9vdF9yZXN0b3JlKHMsIGk5MTVfdm1fdG9fcHBndHQoY3R4LT52bSkpOworCWk5MTVf
Y29udGV4dF9wcGd0dF9yb290X3Jlc3RvcmUocywgcHBndHQpOwogCWZvcl9lYWNoX2VuZ2luZShl
bmdpbmUsIGk5MTUsIGkpIHsKIAkJaWYgKElTX0VSUihzLT5zaGFkb3dbaV0pKQogCQkJYnJlYWs7
CkBAIC0xMzAxLDkgKzEzMDIsOCBAQCBpbnQgaW50ZWxfdmdwdV9zZXR1cF9zdWJtaXNzaW9uKHN0
cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQogCQlpbnRlbF9jb250ZXh0X3VucGluKHMtPnNoYWRvd1tp
XSk7CiAJCWludGVsX2NvbnRleHRfcHV0KHMtPnNoYWRvd1tpXSk7CiAJfQorCWk5MTVfdm1fcHV0
KCZwcGd0dC0+dm0pOwogCWk5MTVfZ2VtX2NvbnRleHRfcHV0KGN0eCk7Ci1vdXRfdW5sb2NrOgot
CW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJcmV0dXJuIHJldDsKIH0K
IApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwppbmRleCAwZTkwYWM2MDhlMDcuLmIwNGNl
YmMyNmVjYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKQEAgLTMxNiwxMiArMzE2
LDE4IEBAIHN0YXRpYyB2b2lkIHByaW50X2NvbnRleHRfc3RhdHMoc3RydWN0IHNlcV9maWxlICpt
LAogCQkJCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogewogCXN0cnVjdCBmaWxlX3N0
YXRzIGtzdGF0cyA9IHt9OwotCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7CisJc3RydWN0
IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwgKmNuOwogCi0JbGlzdF9mb3JfZWFjaF9lbnRyeShjdHgs
ICZpOTE1LT5jb250ZXh0cy5saXN0LCBsaW5rKSB7CisJc3Bpbl9sb2NrKCZpOTE1LT5nZW0uY29u
dGV4dHMubG9jayk7CisJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKGN0eCwgY24sICZpOTE1LT5n
ZW0uY29udGV4dHMubGlzdCwgbGluaykgewogCQlzdHJ1Y3QgaTkxNV9nZW1fZW5naW5lc19pdGVy
IGl0OwogCQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7CiAKKwkJaWYgKCFrcmVmX2dldF91bmxl
c3NfemVybygmY3R4LT5yZWYpKQorCQkJY29udGludWU7CisKKwkJc3Bpbl91bmxvY2soJmk5MTUt
PmdlbS5jb250ZXh0cy5sb2NrKTsKKwogCQlmb3JfZWFjaF9nZW1fZW5naW5lKGNlLAogCQkJCSAg
ICBpOTE1X2dlbV9jb250ZXh0X2xvY2tfZW5naW5lcyhjdHgpLCBpdCkgewogCQkJaW50ZWxfY29u
dGV4dF9sb2NrX3Bpbm5lZChjZSk7CkBAIC0zMzgsNyArMzQ0LDkgQEAgc3RhdGljIHZvaWQgcHJp
bnRfY29udGV4dF9zdGF0cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sCiAJCWk5MTVfZ2VtX2NvbnRleHRf
dW5sb2NrX2VuZ2luZXMoY3R4KTsKIAogCQlpZiAoIUlTX0VSUl9PUl9OVUxMKGN0eC0+ZmlsZV9w
cml2KSkgewotCQkJc3RydWN0IGZpbGVfc3RhdHMgc3RhdHMgPSB7IC52bSA9IGN0eC0+dm0sIH07
CisJCQlzdHJ1Y3QgZmlsZV9zdGF0cyBzdGF0cyA9IHsKKwkJCQkudm0gPSByY3VfYWNjZXNzX3Bv
aW50ZXIoY3R4LT52bSksCisJCQl9OwogCQkJc3RydWN0IGRybV9maWxlICpmaWxlID0gY3R4LT5m
aWxlX3ByaXYtPmZpbGU7CiAJCQlzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2s7CiAJCQljaGFyIG5h
bWVbODBdOwpAQCAtMzU1LDcgKzM2MywxMiBAQCBzdGF0aWMgdm9pZCBwcmludF9jb250ZXh0X3N0
YXRzKHN0cnVjdCBzZXFfZmlsZSAqbSwKIAogCQkJcHJpbnRfZmlsZV9zdGF0cyhtLCBuYW1lLCBz
dGF0cyk7CiAJCX0KKworCQlzcGluX2xvY2soJmk5MTUtPmdlbS5jb250ZXh0cy5sb2NrKTsKKwkJ
bGlzdF9zYWZlX3Jlc2V0X25leHQoY3R4LCBjbiwgbGluayk7CisJCWk5MTVfZ2VtX2NvbnRleHRf
cHV0KGN0eCk7CiAJfQorCXNwaW5fdW5sb2NrKCZpOTE1LT5nZW0uY29udGV4dHMubG9jayk7CiAK
IAlwcmludF9maWxlX3N0YXRzKG0sICJba11jb250ZXh0cyIsIGtzdGF0cyk7CiB9CkBAIC0zNjMs
NyArMzc2LDYgQEAgc3RhdGljIHZvaWQgcHJpbnRfY29udGV4dF9zdGF0cyhzdHJ1Y3Qgc2VxX2Zp
bGUgKm0sCiBzdGF0aWMgaW50IGk5MTVfZ2VtX29iamVjdF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAq
bSwgdm9pZCAqZGF0YSkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVf
dG9faTkxNShtLT5wcml2YXRlKTsKLQlpbnQgcmV0OwogCiAJc2VxX3ByaW50ZihtLCAiJXUgc2hy
aW5rYWJsZSBbJXUgZnJlZV0gb2JqZWN0cywgJWxsdSBieXRlc1xuIiwKIAkJICAgaTkxNS0+bW0u
c2hyaW5rX2NvdW50LApAQCAtMzcyLDEyICszODQsNyBAQCBzdGF0aWMgaW50IGk5MTVfZ2VtX29i
amVjdF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKIAogCXNlcV9wdXRjKG0s
ICdcbicpOwogCi0JcmV0ID0gbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKCZpOTE1LT5kcm0uc3Ry
dWN0X211dGV4KTsKLQlpZiAocmV0KQotCQlyZXR1cm4gcmV0OwotCiAJcHJpbnRfY29udGV4dF9z
dGF0cyhtLCBpOTE1KTsKLQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwog
CiAJcmV0dXJuIDA7CiB9CkBAIC0xNTc5LDE5ICsxNTg2LDE5IEBAIHN0YXRpYyB2b2lkIGRlc2Ny
aWJlX2N0eF9yaW5nKHN0cnVjdCBzZXFfZmlsZSAqbSwgc3RydWN0IGludGVsX3JpbmcgKnJpbmcp
CiAKIHN0YXRpYyBpbnQgaTkxNV9jb250ZXh0X3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZv
aWQgKnVudXNlZCkKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2Rl
X3RvX2k5MTUobS0+cHJpdmF0ZSk7Ci0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZkZXZfcHJp
di0+ZHJtOwotCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7Ci0JaW50IHJldDsKLQotCXJl
dCA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmZGV2LT5zdHJ1Y3RfbXV0ZXgpOwotCWlmIChy
ZXQpCi0JCXJldHVybiByZXQ7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2Rl
X3RvX2k5MTUobS0+cHJpdmF0ZSk7CisJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwgKmNu
OwogCi0JbGlzdF9mb3JfZWFjaF9lbnRyeShjdHgsICZkZXZfcHJpdi0+Y29udGV4dHMubGlzdCwg
bGluaykgeworCXNwaW5fbG9jaygmaTkxNS0+Z2VtLmNvbnRleHRzLmxvY2spOworCWxpc3RfZm9y
X2VhY2hfZW50cnlfc2FmZShjdHgsIGNuLCAmaTkxNS0+Z2VtLmNvbnRleHRzLmxpc3QsIGxpbmsp
IHsKIAkJc3RydWN0IGk5MTVfZ2VtX2VuZ2luZXNfaXRlciBpdDsKIAkJc3RydWN0IGludGVsX2Nv
bnRleHQgKmNlOwogCisJCWlmICgha3JlZl9nZXRfdW5sZXNzX3plcm8oJmN0eC0+cmVmKSkKKwkJ
CWNvbnRpbnVlOworCisJCXNwaW5fdW5sb2NrKCZpOTE1LT5nZW0uY29udGV4dHMubG9jayk7CisK
IAkJc2VxX3B1dHMobSwgIkhXIGNvbnRleHQgIik7CiAJCWlmIChjdHgtPnBpZCkgewogCQkJc3Ry
dWN0IHRhc2tfc3RydWN0ICp0YXNrOwpAQCAtMTYyNiw5ICsxNjMzLDEyIEBAIHN0YXRpYyBpbnQg
aTkxNV9jb250ZXh0X3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKIAkJ
aTkxNV9nZW1fY29udGV4dF91bmxvY2tfZW5naW5lcyhjdHgpOwogCiAJCXNlcV9wdXRjKG0sICdc
bicpOwotCX0KIAotCW11dGV4X3VubG9jaygmZGV2LT5zdHJ1Y3RfbXV0ZXgpOworCQlzcGluX2xv
Y2soJmk5MTUtPmdlbS5jb250ZXh0cy5sb2NrKTsKKwkJbGlzdF9zYWZlX3Jlc2V0X25leHQoY3R4
LCBjbiwgbGluayk7CisJCWk5MTVfZ2VtX2NvbnRleHRfcHV0KGN0eCk7CisJfQorCXNwaW5fdW5s
b2NrKCZpOTE1LT5nZW0uY29udGV4dHMubG9jayk7CiAKIAlyZXR1cm4gMDsKIH0KZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2Rydi5jCmluZGV4IDUzMjNlNGZhNTVkOS4uMDI0ZGE1ODJiYTBmIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZHJ2LmMKQEAgLTE2NjUsMTAgKzE2NjUsOCBAQCBzdGF0aWMgdm9pZCBpOTE1X2Ry
aXZlcl9wb3N0Y2xvc2Uoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgc3RydWN0IGRybV9maWxlICpm
aWxlKQogewogCXN0cnVjdCBkcm1faTkxNV9maWxlX3ByaXZhdGUgKmZpbGVfcHJpdiA9IGZpbGUt
PmRyaXZlcl9wcml2OwogCi0JbXV0ZXhfbG9jaygmZGV2LT5zdHJ1Y3RfbXV0ZXgpOwogCWk5MTVf
Z2VtX2NvbnRleHRfY2xvc2UoZmlsZSk7CiAJaTkxNV9nZW1fcmVsZWFzZShkZXYsIGZpbGUpOwot
CW11dGV4X3VubG9jaygmZGV2LT5zdHJ1Y3RfbXV0ZXgpOwogCiAJa2ZyZWVfcmN1KGZpbGVfcHJp
diwgcmN1KTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaCBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKaW5kZXggY2I2M2IyYmQwY2U4Li4zNWI2
MTBkNTIzNzkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaApAQCAtMTUzNiwyNSArMTUzNiw2IEBA
IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlIHsKIAlpbnQgYXVkaW9fcG93ZXJfcmVmY291bnQ7CiAJ
dTMyIGF1ZGlvX2ZyZXFfY250cmw7CiAKLQlzdHJ1Y3QgewotCQlzdHJ1Y3QgbXV0ZXggbXV0ZXg7
Ci0JCXN0cnVjdCBsaXN0X2hlYWQgbGlzdDsKLQkJc3RydWN0IGxsaXN0X2hlYWQgZnJlZV9saXN0
OwotCQlzdHJ1Y3Qgd29ya19zdHJ1Y3QgZnJlZV93b3JrOwotCi0JCS8qIFRoZSBodyB3YW50cyB0
byBoYXZlIGEgc3RhYmxlIGNvbnRleHQgaWRlbnRpZmllciBmb3IgdGhlCi0JCSAqIGxpZmV0aW1l
IG9mIHRoZSBjb250ZXh0IChmb3IgT0EsIFBBU0lELCBmYXVsdHMsIGV0YykuCi0JCSAqIFRoaXMg
aXMgbGltaXRlZCBpbiBleGVjbGlzdHMgdG8gMjEgYml0cy4KLQkJICovCi0JCXN0cnVjdCBpZGEg
aHdfaWRhOwotI2RlZmluZSBNQVhfQ09OVEVYVF9IV19JRCAoMTw8MjEpIC8qIGV4Y2x1c2l2ZSAq
LwotI2RlZmluZSBNQVhfR1VDX0NPTlRFWFRfSFdfSUQgKDEgPDwgMjApIC8qIGV4Y2x1c2l2ZSAq
LwotI2RlZmluZSBHRU4xMV9NQVhfQ09OVEVYVF9IV19JRCAoMTw8MTEpIC8qIGV4Y2x1c2l2ZSAq
LwotLyogaW4gR2VuMTIgSUQgMHg3RkYgaXMgcmVzZXJ2ZWQgdG8gaW5kaWNhdGUgaWRsZSAqLwot
I2RlZmluZSBHRU4xMl9NQVhfQ09OVEVYVF9IV19JRAkoR0VOMTFfTUFYX0NPTlRFWFRfSFdfSUQg
LSAxKQotCQlzdHJ1Y3QgbGlzdF9oZWFkIGh3X2lkX2xpc3Q7Ci0JfSBjb250ZXh0czsKLQogCXUz
MiBmZGlfcnhfY29uZmlnOwogCiAJLyogU2hhZG93IGZvciBESVNQTEFZX1BIWV9DT05UUk9MIHdo
aWNoIGNhbid0IGJlIHNhZmVseSByZWFkICovCkBAIC0xNzEwLDYgKzE2OTEsMTQgQEAgc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgewogCiAJc3RydWN0IHsKIAkJc3RydWN0IG5vdGlmaWVyX2Jsb2Nr
IHBtX25vdGlmaWVyOworCisJCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0cyB7CisJCQlzcGlubG9j
a190IGxvY2s7IC8qIGxvY2tzIGxpc3QgKi8KKwkJCXN0cnVjdCBsaXN0X2hlYWQgbGlzdDsKKwor
CQkJc3RydWN0IGxsaXN0X2hlYWQgZnJlZV9saXN0OworCQkJc3RydWN0IHdvcmtfc3RydWN0IGZy
ZWVfd29yazsKKwkJfSBjb250ZXh0czsKIAl9IGdlbTsKIAogCS8qIEZvciBpOTQ1Z20gdmJsYW5r
IGlycSB2cy4gQzMgd29ya2Fyb3VuZCAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKaW5kZXggNWE2
NjRiZGVhZDhjLi5mNmRiNDE1OTg1ZDUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZ2VtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwpAQCAtMTI2
Niw3ICsxMjY2LDcgQEAgaW50IGk5MTVfZ2VtX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQogCQlnb3RvIGVycl91bmxvY2s7CiAJfQogCi0JcmV0ID0gaTkxNV9nZW1fY29u
dGV4dHNfaW5pdChkZXZfcHJpdik7CisJcmV0ID0gaTkxNV9nZW1faW5pdF9jb250ZXh0cyhkZXZf
cHJpdik7CiAJaWYgKHJldCkgewogCQlHRU1fQlVHX09OKHJldCA9PSAtRUlPKTsKIAkJZ290byBl
cnJfc2NyYXRjaDsKQEAgLTEzNDgsNyArMTM0OCw3IEBAIGludCBpOTE1X2dlbV9pbml0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAl9CiBlcnJfY29udGV4dDoKIAlpZiAocmV0
ICE9IC1FSU8pCi0JCWk5MTVfZ2VtX2NvbnRleHRzX2ZpbmkoZGV2X3ByaXYpOworCQlpOTE1X2dl
bV9kcml2ZXJfcmVsZWFzZV9fY29udGV4dHMoZGV2X3ByaXYpOwogZXJyX3NjcmF0Y2g6CiAJaW50
ZWxfZ3RfZHJpdmVyX3JlbGVhc2UoJmRldl9wcml2LT5ndCk7CiBlcnJfdW5sb2NrOgpAQCAtMTQx
NiwxMSArMTQxNiw5IEBAIHZvaWQgaTkxNV9nZW1fZHJpdmVyX3JlbW92ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAKIHZvaWQgaTkxNV9nZW1fZHJpdmVyX3JlbGVhc2Uoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewotCW11dGV4X2xvY2soJmRldl9wcml2
LT5kcm0uc3RydWN0X211dGV4KTsKIAlpbnRlbF9lbmdpbmVzX2NsZWFudXAoZGV2X3ByaXYpOwot
CWk5MTVfZ2VtX2NvbnRleHRzX2ZpbmkoZGV2X3ByaXYpOworCWk5MTVfZ2VtX2RyaXZlcl9yZWxl
YXNlX19jb250ZXh0cyhkZXZfcHJpdik7CiAJaW50ZWxfZ3RfZHJpdmVyX3JlbGVhc2UoJmRldl9w
cml2LT5ndCk7Ci0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7CiAK
IAlpbnRlbF93YV9saXN0X2ZyZWUoJmRldl9wcml2LT5ndF93YV9saXN0KTsKIApAQCAtMTQzMCw3
ICsxNDI4LDcgQEAgdm9pZCBpOTE1X2dlbV9kcml2ZXJfcmVsZWFzZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCiAKIAlpOTE1X2dlbV9kcmFpbl9mcmVlZF9vYmplY3RzKGRldl9w
cml2KTsKIAotCVdBUk5fT04oIWxpc3RfZW1wdHkoJmRldl9wcml2LT5jb250ZXh0cy5saXN0KSk7
CisJV0FSTl9PTighbGlzdF9lbXB0eSgmZGV2X3ByaXYtPmdlbS5jb250ZXh0cy5saXN0KSk7CiB9
CiAKIHZvaWQgaTkxNV9nZW1faW5pdF9tbWlvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuYwppbmRleCAxZDI2NjM0Y2E1OTcuLjdiMTVi
Yjg5MTk3MCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMKQEAgLTEzNjYsNyArMTM2
Niw5IEBAIHN0YXRpYyBpbnQgZ2VuOF9pbml0X3NjcmF0Y2goc3RydWN0IGk5MTVfYWRkcmVzc19z
cGFjZSAqdm0pCiAJaWYgKHZtLT5oYXNfcmVhZF9vbmx5ICYmCiAJICAgIHZtLT5pOTE1LT5rZXJu
ZWxfY29udGV4dCAmJgogCSAgICB2bS0+aTkxNS0+a2VybmVsX2NvbnRleHQtPnZtKSB7Ci0JCXN0
cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKmNsb25lID0gdm0tPmk5MTUtPmtlcm5lbF9jb250ZXh0
LT52bTsKKwkJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqY2xvbmUgPQorCQkJcmN1X2RlcmVm
ZXJlbmNlX3Byb3RlY3RlZCh2bS0+aTkxNS0+a2VybmVsX2NvbnRleHQtPnZtLAorCQkJCQkJICB0
cnVlKTsgLyogc3RhdGljICovCiAKIAkJR0VNX0JVR19PTighY2xvbmUtPmhhc19yZWFkX29ubHkp
OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5jCmluZGV4IGVjZmJjMzdiNzM4Yi4uMjMxMzg4ZDA2
YzgyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYwpAQCAtMTg1Myw4ICsxODUzLDggQEAgc3Rh
dGljIGludCBnZW44X2NvbmZpZ3VyZV9hbGxfY29udGV4dHMoc3RydWN0IGk5MTVfcGVyZl9zdHJl
YW0gKnN0cmVhbSwKIAl9OwogI3VuZGVmIGN0eF9mbGV4ZXVOCiAJc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lOwotCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7Ci0JaW50IGk7CisJ
c3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwgKmNuOworCWludCBpLCBlcnI7CiAKIAlmb3Ig
KGkgPSAyOyBpIDwgQVJSQVlfU0laRShyZWdzKTsgaSsrKQogCQlyZWdzW2ldLnZhbHVlID0gb2Ff
Y29uZmlnX2ZsZXhfcmVnKG9hX2NvbmZpZywgcmVnc1tpXS5yZWcpOwpAQCAtMTg3NywxNiArMTg3
NywyNyBAQCBzdGF0aWMgaW50IGdlbjhfY29uZmlndXJlX2FsbF9jb250ZXh0cyhzdHJ1Y3QgaTkx
NV9wZXJmX3N0cmVhbSAqc3RyZWFtLAogCSAqIGNvbnRleHQuIENvbnRleHRzIGlkbGUgYXQgdGhl
IHRpbWUgb2YgcmVjb25maWd1cmF0aW9uIGFyZSBub3QKIAkgKiB0cmFwcGVkIGJlaGluZCB0aGUg
YmFycmllci4KIAkgKi8KLQlsaXN0X2Zvcl9lYWNoX2VudHJ5KGN0eCwgJmk5MTUtPmNvbnRleHRz
Lmxpc3QsIGxpbmspIHsKLQkJaW50IGVycjsKLQorCXNwaW5fbG9jaygmaTkxNS0+Z2VtLmNvbnRl
eHRzLmxvY2spOworCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShjdHgsIGNuLCAmaTkxNS0+Z2Vt
LmNvbnRleHRzLmxpc3QsIGxpbmspIHsKIAkJaWYgKGN0eCA9PSBpOTE1LT5rZXJuZWxfY29udGV4
dCkKIAkJCWNvbnRpbnVlOwogCisJCWlmICgha3JlZl9nZXRfdW5sZXNzX3plcm8oJmN0eC0+cmVm
KSkKKwkJCWNvbnRpbnVlOworCisJCXNwaW5fdW5sb2NrKCZpOTE1LT5nZW0uY29udGV4dHMubG9j
ayk7CisKIAkJZXJyID0gZ2VuOF9jb25maWd1cmVfY29udGV4dChjdHgsIHJlZ3MsIEFSUkFZX1NJ
WkUocmVncykpOwotCQlpZiAoZXJyKQorCQlpZiAoZXJyKSB7CisJCQlpOTE1X2dlbV9jb250ZXh0
X3B1dChjdHgpOwogCQkJcmV0dXJuIGVycjsKKwkJfQorCisJCXNwaW5fbG9jaygmaTkxNS0+Z2Vt
LmNvbnRleHRzLmxvY2spOworCQlsaXN0X3NhZmVfcmVzZXRfbmV4dChjdHgsIGNuLCBsaW5rKTsK
KwkJaTkxNV9nZW1fY29udGV4dF9wdXQoY3R4KTsKIAl9CisJc3Bpbl91bmxvY2soJmk5MTUtPmdl
bS5jb250ZXh0cy5sb2NrKTsKIAogCS8qCiAJICogQWZ0ZXIgdXBkYXRpbmcgYWxsIG90aGVyIGNv
bnRleHRzLCB3ZSBuZWVkIHRvIG1vZGlmeSBvdXJzZWx2ZXMuCkBAIC0xODk1LDcgKzE5MDYsNiBA
QCBzdGF0aWMgaW50IGdlbjhfY29uZmlndXJlX2FsbF9jb250ZXh0cyhzdHJ1Y3QgaTkxNV9wZXJm
X3N0cmVhbSAqc3RyZWFtLAogCSAqLwogCWZvcl9lYWNoX3VhYmlfZW5naW5lKGVuZ2luZSwgaTkx
NSkgewogCQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UgPSBlbmdpbmUtPmtlcm5lbF9jb250ZXh0
OwotCQlpbnQgZXJyOwogCiAJCWlmIChlbmdpbmUtPmNsYXNzICE9IFJFTkRFUl9DTEFTUykKIAkJ
CWNvbnRpbnVlOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zeXNmcy5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zeXNmcy5jCmluZGV4IDAzNGI4YWJjNTA2Mi4u
MmE3MjQwN2E2MzgwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3N5c2Zz
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zeXNmcy5jCkBAIC0xNDQsOSArMTQ0
LDkgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgbWVkaWFfcmM2X2F0dHJf
Z3JvdXAgPSB7CiB9OwogI2VuZGlmCiAKLXN0YXRpYyBpbnQgbDNfYWNjZXNzX3ZhbGlkKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgbG9mZl90IG9mZnNldCkKK3N0YXRpYyBpbnQg
bDNfYWNjZXNzX3ZhbGlkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBsb2ZmX3Qgb2Zm
c2V0KQogewotCWlmICghSEFTX0wzX0RQRihkZXZfcHJpdikpCisJaWYgKCFIQVNfTDNfRFBGKGk5
MTUpKQogCQlyZXR1cm4gLUVQRVJNOwogCiAJaWYgKG9mZnNldCAlIDQgIT0gMCkKQEAgLTE2NCwz
MSArMTY0LDI0IEBAIGk5MTVfbDNfcmVhZChzdHJ1Y3QgZmlsZSAqZmlscCwgc3RydWN0IGtvYmpl
Y3QgKmtvYmosCiAJICAgICBsb2ZmX3Qgb2Zmc2V0LCBzaXplX3QgY291bnQpCiB7CiAJc3RydWN0
IGRldmljZSAqa2RldiA9IGtvYmpfdG9fZGV2KGtvYmopOwotCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IGtkZXZfbWlub3JfdG9faTkxNShrZGV2KTsKLQlzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2ID0gJmRldl9wcml2LT5kcm07CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7CiAJaW50IHNsaWNlID0gKGludCkodWludHB0
cl90KWF0dHItPnByaXZhdGU7CiAJaW50IHJldDsKIAotCWNvdW50ID0gcm91bmRfZG93bihjb3Vu
dCwgNCk7Ci0KLQlyZXQgPSBsM19hY2Nlc3NfdmFsaWQoZGV2X3ByaXYsIG9mZnNldCk7CisJcmV0
ID0gbDNfYWNjZXNzX3ZhbGlkKGk5MTUsIG9mZnNldCk7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJl
dDsKIAorCWNvdW50ID0gcm91bmRfZG93bihjb3VudCwgNCk7CiAJY291bnQgPSBtaW5fdChzaXpl
X3QsIEdFTjdfTDNMT0dfU0laRSAtIG9mZnNldCwgY291bnQpOworCW1lbXNldChidWYsIDAsIGNv
dW50KTsKIAotCXJldCA9IGk5MTVfbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKGRldik7Ci0JaWYg
KHJldCkKLQkJcmV0dXJuIHJldDsKLQotCWlmIChkZXZfcHJpdi0+bDNfcGFyaXR5LnJlbWFwX2lu
Zm9bc2xpY2VdKQorCXNwaW5fbG9jaygmaTkxNS0+Z2VtLmNvbnRleHRzLmxvY2spOworCWlmIChp
OTE1LT5sM19wYXJpdHkucmVtYXBfaW5mb1tzbGljZV0pCiAJCW1lbWNweShidWYsCi0JCSAgICAg
ICBkZXZfcHJpdi0+bDNfcGFyaXR5LnJlbWFwX2luZm9bc2xpY2VdICsgKG9mZnNldC80KSwKKwkJ
ICAgICAgIGk5MTUtPmwzX3Bhcml0eS5yZW1hcF9pbmZvW3NsaWNlXSArIG9mZnNldCAvIDQsCiAJ
CSAgICAgICBjb3VudCk7Ci0JZWxzZQotCQltZW1zZXQoYnVmLCAwLCBjb3VudCk7Ci0KLQltdXRl
eF91bmxvY2soJmRldi0+c3RydWN0X211dGV4KTsKKwlzcGluX3VubG9jaygmaTkxNS0+Z2VtLmNv
bnRleHRzLmxvY2spOwogCiAJcmV0dXJuIGNvdW50OwogfQpAQCAtMTk5LDQ2ICsxOTIsNDYgQEAg
aTkxNV9sM193cml0ZShzdHJ1Y3QgZmlsZSAqZmlscCwgc3RydWN0IGtvYmplY3QgKmtvYmosCiAJ
ICAgICAgbG9mZl90IG9mZnNldCwgc2l6ZV90IGNvdW50KQogewogCXN0cnVjdCBkZXZpY2UgKmtk
ZXYgPSBrb2JqX3RvX2Rldihrb2JqKTsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7Ci0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9
ICZkZXZfcHJpdi0+ZHJtOworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0ga2Rldl9t
aW5vcl90b19pOTE1KGtkZXYpOwogCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7CiAJaW50
IHNsaWNlID0gKGludCkodWludHB0cl90KWF0dHItPnByaXZhdGU7Ci0JdTMyICoqcmVtYXBfaW5m
bzsKKwl1MzIgKnJlbWFwX2luZm8sICpmcmVlbWUgPSBOVUxMOwogCWludCByZXQ7CiAKLQlyZXQg
PSBsM19hY2Nlc3NfdmFsaWQoZGV2X3ByaXYsIG9mZnNldCk7CisJcmV0ID0gbDNfYWNjZXNzX3Zh
bGlkKGk5MTUsIG9mZnNldCk7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIAotCXJldCA9IGk5
MTVfbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKGRldik7Ci0JaWYgKHJldCkKLQkJcmV0dXJuIHJl
dDsKKwlyZW1hcF9pbmZvID0ga3phbGxvYyhHRU43X0wzTE9HX1NJWkUsIEdGUF9LRVJORUwpOwor
CWlmICghcmVtYXBfaW5mbykKKwkJcmV0dXJuIC1FTk9NRU07CiAKLQlyZW1hcF9pbmZvID0gJmRl
dl9wcml2LT5sM19wYXJpdHkucmVtYXBfaW5mb1tzbGljZV07Ci0JaWYgKCEqcmVtYXBfaW5mbykg
ewotCQkqcmVtYXBfaW5mbyA9IGt6YWxsb2MoR0VON19MM0xPR19TSVpFLCBHRlBfS0VSTkVMKTsK
LQkJaWYgKCEqcmVtYXBfaW5mbykgewotCQkJcmV0ID0gLUVOT01FTTsKLQkJCWdvdG8gb3V0Owot
CQl9CisJc3Bpbl9sb2NrKCZpOTE1LT5nZW0uY29udGV4dHMubG9jayk7CisKKwlpZiAoaTkxNS0+
bDNfcGFyaXR5LnJlbWFwX2luZm9bc2xpY2VdKSB7CisJCWZyZWVtZSA9IHJlbWFwX2luZm87CisJ
CXJlbWFwX2luZm8gPSBpOTE1LT5sM19wYXJpdHkucmVtYXBfaW5mb1tzbGljZV07CisJfSBlbHNl
IHsKKwkJaTkxNS0+bDNfcGFyaXR5LnJlbWFwX2luZm9bc2xpY2VdID0gcmVtYXBfaW5mbzsKIAl9
CiAKLQkvKiBUT0RPOiBJZGVhbGx5IHdlIHJlYWxseSB3YW50IGEgR1BVIHJlc2V0IGhlcmUgdG8g
bWFrZSBzdXJlIGVycm9ycwotCSAqIGFyZW4ndCBwcm9wYWdhdGVkLiBTaW5jZSBJIGNhbm5vdCBm
aW5kIGEgc3RhYmxlIHdheSB0byByZXNldCB0aGUgR1BVCi0JICogYXQgdGhpcyBwb2ludCBpdCBp
cyBsZWZ0IGFzIGEgVE9ETy4KLQkqLwotCW1lbWNweSgqcmVtYXBfaW5mbyArIChvZmZzZXQvNCks
IGJ1ZiwgY291bnQpOworCWNvdW50ID0gcm91bmRfZG93bihjb3VudCwgNCk7CisJbWVtY3B5KHJl
bWFwX2luZm8gKyBvZmZzZXQgLyA0LCBidWYsIGNvdW50KTsKIAogCS8qIE5COiBXZSBkZWZlciB0
aGUgcmVtYXBwaW5nIHVudGlsIHdlIHN3aXRjaCB0byB0aGUgY29udGV4dCAqLwotCWxpc3RfZm9y
X2VhY2hfZW50cnkoY3R4LCAmZGV2X3ByaXYtPmNvbnRleHRzLmxpc3QsIGxpbmspCi0JCWN0eC0+
cmVtYXBfc2xpY2UgfD0gKDE8PHNsaWNlKTsKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5KGN0eCwgJmk5
MTUtPmdlbS5jb250ZXh0cy5saXN0LCBsaW5rKQorCQljdHgtPnJlbWFwX3NsaWNlIHw9IEJJVChz
bGljZSk7CiAKLQlyZXQgPSBjb3VudDsKKwlzcGluX3VubG9jaygmaTkxNS0+Z2VtLmNvbnRleHRz
LmxvY2spOworCWtmcmVlKGZyZWVtZSk7CiAKLW91dDoKLQltdXRleF91bmxvY2soJmRldi0+c3Ry
dWN0X211dGV4KTsKKwkvKgorCSAqIFRPRE86IElkZWFsbHkgd2UgcmVhbGx5IHdhbnQgYSBHUFUg
cmVzZXQgaGVyZSB0byBtYWtlIHN1cmUgZXJyb3JzCisJICogYXJlbid0IHByb3BhZ2F0ZWQuIFNp
bmNlIEkgY2Fubm90IGZpbmQgYSBzdGFibGUgd2F5IHRvIHJlc2V0IHRoZSBHUFUKKwkgKiBhdCB0
aGlzIHBvaW50IGl0IGlzIGxlZnQgYXMgYSBUT0RPLgorCSAqLwogCi0JcmV0dXJuIHJldDsKKwly
ZXR1cm4gY291bnQ7CiB9CiAKIHN0YXRpYyBjb25zdCBzdHJ1Y3QgYmluX2F0dHJpYnV0ZSBkcGZf
YXR0cnMgPSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3RyYWNlLmgg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3RyYWNlLmgKaW5kZXggMWYyY2Y2Y2ZhZmI1Li43
ZWY3YTFlMTY2NGMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdHJhY2Uu
aAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3RyYWNlLmgKQEAgLTk1Miw3ICs5NTIs
NyBAQCBERUNMQVJFX0VWRU5UX0NMQVNTKGk5MTVfY29udGV4dCwKIAlUUF9mYXN0X2Fzc2lnbigK
IAkJCV9fZW50cnktPmRldiA9IGN0eC0+aTkxNS0+ZHJtLnByaW1hcnktPmluZGV4OwogCQkJX19l
bnRyeS0+Y3R4ID0gY3R4OwotCQkJX19lbnRyeS0+dm0gPSBjdHgtPnZtOworCQkJX19lbnRyeS0+
dm0gPSByY3VfYWNjZXNzX3BvaW50ZXIoY3R4LT52bSk7CiAJKSwKIAogCVRQX3ByaW50aygiZGV2
PSV1LCBjdHg9JXAsIGN0eF92bT0lcCIsCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9zZWxmdGVzdHMvaTkxNV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9p
OTE1X2dlbS5jCmluZGV4IDAzNDZjM2U1YjZiNi4uYmZhNDBhNWI2ZDk4IDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW0uYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW0uYwpAQCAtMTM4LDExICsxMzgsOSBAQCBzdGF0
aWMgaW50IGlndF9nZW1fc3VzcGVuZCh2b2lkICphcmcpCiAJCXJldHVybiBQVFJfRVJSKGZpbGUp
OwogCiAJZXJyID0gLUVOT01FTTsKLQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4
KTsKIAljdHggPSBsaXZlX2NvbnRleHQoaTkxNSwgZmlsZSk7CiAJaWYgKCFJU19FUlIoY3R4KSkK
IAkJZXJyID0gc3dpdGNoX3RvX2NvbnRleHQoaTkxNSwgY3R4KTsKLQltdXRleF91bmxvY2soJmk5
MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWlmIChlcnIpCiAJCWdvdG8gb3V0OwogCkBAIC0xNTcs
OSArMTU1LDcgQEAgc3RhdGljIGludCBpZ3RfZ2VtX3N1c3BlbmQodm9pZCAqYXJnKQogCiAJcG1f
cmVzdW1lKGk5MTUpOwogCi0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJ
ZXJyID0gc3dpdGNoX3RvX2NvbnRleHQoaTkxNSwgY3R4KTsKLQltdXRleF91bmxvY2soJmk5MTUt
PmRybS5zdHJ1Y3RfbXV0ZXgpOwogb3V0OgogCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUpOwog
CXJldHVybiBlcnI7CkBAIC0xNzcsMTEgKzE3Myw5IEBAIHN0YXRpYyBpbnQgaWd0X2dlbV9oaWJl
cm5hdGUodm9pZCAqYXJnKQogCQlyZXR1cm4gUFRSX0VSUihmaWxlKTsKIAogCWVyciA9IC1FTk9N
RU07Ci0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJY3R4ID0gbGl2ZV9j
b250ZXh0KGk5MTUsIGZpbGUpOwogCWlmICghSVNfRVJSKGN0eCkpCiAJCWVyciA9IHN3aXRjaF90
b19jb250ZXh0KGk5MTUsIGN0eCk7Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211
dGV4KTsKIAlpZiAoZXJyKQogCQlnb3RvIG91dDsKIApAQCAtMTk2LDkgKzE5MCw3IEBAIHN0YXRp
YyBpbnQgaWd0X2dlbV9oaWJlcm5hdGUodm9pZCAqYXJnKQogCiAJcG1fcmVzdW1lKGk5MTUpOwog
Ci0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJZXJyID0gc3dpdGNoX3Rv
X2NvbnRleHQoaTkxNSwgY3R4KTsKLQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwogb3V0OgogCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUpOwogCXJldHVybiBlcnI7CmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZXZpY3Qu
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ldmljdC5jCmluZGV4
IGYzOWYwMjgyZTc4Yy4uMGFmOWE1OGQwMTFkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZXZpY3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9zZWxmdGVzdHMvaTkxNV9nZW1fZXZpY3QuYwpAQCAtNDczLDcgKzQ3Myw2IEBAIHN0YXRpYyBp
bnQgaWd0X2V2aWN0X2NvbnRleHRzKHZvaWQgKmFyZykKIAkJfQogCiAJCWNvdW50ID0gMDsKLQkJ
bXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJCW9uc3RhY2tfZmVuY2VfaW5p
dCgmZmVuY2UpOwogCQlkbyB7CiAJCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKQEAgLTUxMCw4
ICs1MDksNiBAQCBzdGF0aWMgaW50IGlndF9ldmljdF9jb250ZXh0cyh2b2lkICphcmcpCiAJCQlj
b3VudCsrOwogCQkJZXJyID0gMDsKIAkJfSB3aGlsZSgxKTsKLQkJbXV0ZXhfdW5sb2NrKCZpOTE1
LT5kcm0uc3RydWN0X211dGV4KTsKLQogCQlvbnN0YWNrX2ZlbmNlX2ZpbmkoJmZlbmNlKTsKIAkJ
cHJfaW5mbygiU3VibWl0dGVkICVsdSBjb250ZXh0cy9yZXF1ZXN0cyBvbiAlc1xuIiwKIAkJCWNv
dW50LCBlbmdpbmUtPm5hbWUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2Vs
ZnRlc3RzL2k5MTVfZ2VtX2d0dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5
MTVfZ2VtX2d0dC5jCmluZGV4IGU0MGU2Y2ZhNTFmMS4uNjgxNDZjNmEzYjg2IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZ3R0LmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jCkBAIC0xMjQ2LDYgKzEy
NDYsNyBAQCBzdGF0aWMgaW50IGV4ZXJjaXNlX21vY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCiAJCQkJICAgICB1bnNpZ25lZCBsb25nIGVuZF90aW1lKSkKIHsKIAljb25zdCB1NjQg
bGltaXQgPSB0b3RhbHJhbV9wYWdlcygpIDw8IFBBR0VfU0hJRlQ7CisJc3RydWN0IGk5MTVfYWRk
cmVzc19zcGFjZSAqdm07CiAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eDsKIAlJR1RfVElN
RU9VVChlbmRfdGltZSk7CiAJaW50IGVycjsKQEAgLTEyNTQsNyArMTI1NSw5IEBAIHN0YXRpYyBp
bnQgZXhlcmNpc2VfbW9jayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAlpZiAoIWN0
eCkKIAkJcmV0dXJuIC1FTk9NRU07CiAKLQllcnIgPSBmdW5jKGk5MTUsIGN0eC0+dm0sIDAsIG1p
bihjdHgtPnZtLT50b3RhbCwgbGltaXQpLCBlbmRfdGltZSk7CisJdm0gPSBpOTE1X2dlbV9jb250
ZXh0X2dldF92bV9yY3UoY3R4KTsKKwllcnIgPSBmdW5jKGk5MTUsIHZtLCAwLCBtaW4odm0tPnRv
dGFsLCBsaW1pdCksIGVuZF90aW1lKTsKKwlpOTE1X3ZtX3B1dCh2bSk7CiAKIAltb2NrX2NvbnRl
eHRfY2xvc2UoY3R4KTsKIAlyZXR1cm4gZXJyOwpAQCAtMTgwMSw3ICsxODA0LDcgQEAgc3RhdGlj
IGludCBpZ3RfY3NfdGxiKHZvaWQgKmFyZykKIAkJZ290byBvdXRfdW5sb2NrOwogCX0KIAotCXZt
ID0gY3R4LT52bTsKKwl2bSA9IGk5MTVfZ2VtX2NvbnRleHRfZ2V0X3ZtX3JjdShjdHgpOwogCWlm
ICghdm0pCiAJCWdvdG8gb3V0X3VubG9jazsKIApAQCAtMTgwOSw3ICsxODEyLDcgQEAgc3RhdGlj
IGludCBpZ3RfY3NfdGxiKHZvaWQgKmFyZykKIAliYmUgPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRl
X2ludGVybmFsKGk5MTUsIFBBR0VfU0laRSk7CiAJaWYgKElTX0VSUihiYmUpKSB7CiAJCWVyciA9
IFBUUl9FUlIoYmJlKTsKLQkJZ290byBvdXRfdW5sb2NrOworCQlnb3RvIG91dF92bTsKIAl9CiAK
IAliYXRjaCA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKGJiZSwgSTkxNV9NQVBfV0MpOwpAQCAt
MjAxNCw2ICsyMDE3LDggQEAgc3RhdGljIGludCBpZ3RfY3NfdGxiKHZvaWQgKmFyZykKIAlpOTE1
X2dlbV9vYmplY3RfcHV0KGFjdCk7CiBvdXRfcHV0X2JiZToKIAlpOTE1X2dlbV9vYmplY3RfcHV0
KGJiZSk7CitvdXRfdm06CisJaTkxNV92bV9wdXQodm0pOwogb3V0X3VubG9jazoKIAltdXRleF91
bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZp
bGUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfcmVx
dWVzdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfcmVxdWVzdC5jCmlu
ZGV4IGQ3ZDY4YzZhNmJkNS4uMDg5N2E3YjA0OTQ0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9yZXF1ZXN0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvc2VsZnRlc3RzL2k5MTVfcmVxdWVzdC5jCkBAIC0xODEsOSArMTgxLDcgQEAgc3RhdGljIGlu
dCBpZ3RfcmVxdWVzdF9yZXdpbmQodm9pZCAqYXJnKQogCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpj
ZTsKIAlpbnQgZXJyID0gLUVJTlZBTDsKIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3Rf
bXV0ZXgpOwogCWN0eFswXSA9IG1vY2tfY29udGV4dChpOTE1LCAiQSIpOwotCW11dGV4X3VubG9j
aygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAKIAljZSA9IGk5MTVfZ2VtX2NvbnRleHRfZ2V0
X2VuZ2luZShjdHhbMF0sIFJDUzApOwogCUdFTV9CVUdfT04oSVNfRVJSKGNlKSk7CkBAIC0xOTcs
OSArMTk1LDcgQEAgc3RhdGljIGludCBpZ3RfcmVxdWVzdF9yZXdpbmQodm9pZCAqYXJnKQogCWk5
MTVfcmVxdWVzdF9nZXQocmVxdWVzdCk7CiAJaTkxNV9yZXF1ZXN0X2FkZChyZXF1ZXN0KTsKIAot
CW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWN0eFsxXSA9IG1vY2tfY29u
dGV4dChpOTE1LCAiQiIpOwotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7
CiAKIAljZSA9IGk5MTVfZ2VtX2NvbnRleHRfZ2V0X2VuZ2luZShjdHhbMV0sIFJDUzApOwogCUdF
TV9CVUdfT04oSVNfRVJSKGNlKSk7CkBAIC00MzgsOSArNDM0LDcgQEAgc3RhdGljIGludCBtb2Nr
X2JyZWFkY3J1bWJzX3Ntb2tldGVzdCh2b2lkICphcmcpCiAJfQogCiAJZm9yIChuID0gMDsgbiA8
IHQubmNvbnRleHRzOyBuKyspIHsKLQkJbXV0ZXhfbG9jaygmdC5lbmdpbmUtPmk5MTUtPmRybS5z
dHJ1Y3RfbXV0ZXgpOwogCQl0LmNvbnRleHRzW25dID0gbW9ja19jb250ZXh0KHQuZW5naW5lLT5p
OTE1LCAibW9jayIpOwotCQltdXRleF91bmxvY2soJnQuZW5naW5lLT5pOTE1LT5kcm0uc3RydWN0
X211dGV4KTsKIAkJaWYgKCF0LmNvbnRleHRzW25dKSB7CiAJCQlyZXQgPSAtRU5PTUVNOwogCQkJ
Z290byBvdXRfY29udGV4dHM7CkBAIC03MzQsOSArNzI4LDkgQEAgc3RhdGljIGludCBsaXZlX2Vt
cHR5X3JlcXVlc3Qodm9pZCAqYXJnKQogc3RhdGljIHN0cnVjdCBpOTE1X3ZtYSAqcmVjdXJzaXZl
X2JhdGNoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogewogCXN0cnVjdCBpOTE1X2dl
bV9jb250ZXh0ICpjdHggPSBpOTE1LT5rZXJuZWxfY29udGV4dDsKLQlzdHJ1Y3QgaTkxNV9hZGRy
ZXNzX3NwYWNlICp2bSA9IGN0eC0+dm0gPzogJmk5MTUtPmdndHQudm07CiAJc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3QgKm9iajsKIAljb25zdCBpbnQgZ2VuID0gSU5URUxfR0VOKGk5MTUpOwor
CXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtOwogCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwog
CXUzMiAqY21kOwogCWludCBlcnI7CkBAIC03NDUsNyArNzM5LDkgQEAgc3RhdGljIHN0cnVjdCBp
OTE1X3ZtYSAqcmVjdXJzaXZlX2JhdGNoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQog
CWlmIChJU19FUlIob2JqKSkKIAkJcmV0dXJuIEVSUl9DQVNUKG9iaik7CiAKKwl2bSA9IGk5MTVf
Z2VtX2NvbnRleHRfZ2V0X3ZtX3JjdShjdHgpOwogCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9i
aiwgdm0sIE5VTEwpOworCWk5MTVfdm1fcHV0KHZtKTsKIAlpZiAoSVNfRVJSKHZtYSkpIHsKIAkJ
ZXJyID0gUFRSX0VSUih2bWEpOwogCQlnb3RvIGVycjsKQEAgLTEyMjAsOSArMTIxNiw3IEBAIHN0
YXRpYyBpbnQgbGl2ZV9icmVhZGNydW1ic19zbW9rZXRlc3Qodm9pZCAqYXJnKQogCX0KIAogCWZv
ciAobiA9IDA7IG4gPCB0WzBdLm5jb250ZXh0czsgbisrKSB7Ci0JCW11dGV4X2xvY2soJmk5MTUt
PmRybS5zdHJ1Y3RfbXV0ZXgpOwogCQl0WzBdLmNvbnRleHRzW25dID0gbGl2ZV9jb250ZXh0KGk5
MTUsIGZpbGUpOwotCQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCQlp
ZiAoIXRbMF0uY29udGV4dHNbbl0pIHsKIAkJCXJldCA9IC1FTk9NRU07CiAJCQlnb3RvIG91dF9j
b250ZXh0czsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1
X3ZtYS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfdm1hLmMKaW5kZXgg
YWMxZmY1NThlYjkwLi41OGI1ZjQwYTA3ZGQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L3NlbGZ0ZXN0cy9pOTE1X3ZtYS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0
ZXN0cy9pOTE1X3ZtYS5jCkBAIC0yNCw2ICsyNCw3IEBACiAKICNpbmNsdWRlIDxsaW51eC9wcmlt
ZV9udW1iZXJzLmg+CiAKKyNpbmNsdWRlICJnZW0vaTkxNV9nZW1fY29udGV4dC5oIgogI2luY2x1
ZGUgImdlbS9zZWxmdGVzdHMvbW9ja19jb250ZXh0LmgiCiAKICNpbmNsdWRlICJpOTE1X3NjYXR0
ZXJsaXN0LmgiCkBAIC0zOCw3ICszOSw3IEBAIHN0YXRpYyBib29sIGFzc2VydF92bWEoc3RydWN0
IGk5MTVfdm1hICp2bWEsCiB7CiAJYm9vbCBvayA9IHRydWU7CiAKLQlpZiAodm1hLT52bSAhPSBj
dHgtPnZtKSB7CisJaWYgKHZtYS0+dm0gIT0gcmN1X2FjY2Vzc19wb2ludGVyKGN0eC0+dm0pKSB7
CiAJCXByX2VycigiVk1BIGNyZWF0ZWQgd2l0aCB3cm9uZyBWTVxuIik7CiAJCW9rID0gZmFsc2U7
CiAJfQpAQCAtMTEzLDExICsxMTQsMTMgQEAgc3RhdGljIGludCBjcmVhdGVfdm1hcyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAlsaXN0X2Zvcl9lYWNoX2VudHJ5KG9iaiwgb2JqZWN0
cywgc3RfbGluaykgewogCQlmb3IgKHBpbm5lZCA9IDA7IHBpbm5lZCA8PSAxOyBwaW5uZWQrKykg
ewogCQkJbGlzdF9mb3JfZWFjaF9lbnRyeShjdHgsIGNvbnRleHRzLCBsaW5rKSB7Ci0JCQkJc3Ry
dWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSBjdHgtPnZtOworCQkJCXN0cnVjdCBpOTE1X2Fk
ZHJlc3Nfc3BhY2UgKnZtOwogCQkJCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwogCQkJCWludCBlcnI7
CiAKKwkJCQl2bSA9IGk5MTVfZ2VtX2NvbnRleHRfZ2V0X3ZtX3JjdShjdHgpOwogCQkJCXZtYSA9
IGNoZWNrZWRfdm1hX2luc3RhbmNlKG9iaiwgdm0sIE5VTEwpOworCQkJCWk5MTVfdm1fcHV0KHZt
KTsKIAkJCQlpZiAoSVNfRVJSKHZtYSkpCiAJCQkJCXJldHVybiBQVFJfRVJSKHZtYSk7CiAKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2dlbV9kZXZpY2Uu
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2dlbV9kZXZpY2UuYwppbmRl
eCA0ZTZjZGUwZDQ4NTkuLjMzNWYzN2JhOThkZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvc2VsZnRlc3RzL21vY2tfZ2VtX2RldmljZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L3NlbGZ0ZXN0cy9tb2NrX2dlbV9kZXZpY2UuYwpAQCAtNTksMTEgKzU5LDkgQEAgc3RhdGlj
IHZvaWQgbW9ja19kZXZpY2VfcmVsZWFzZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQogCiAJaTkx
NV9nZW1fZHJhaW5fd29ya3F1ZXVlKGk5MTUpOwogCi0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0
cnVjdF9tdXRleCk7CiAJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpCiAJCW1vY2tf
ZW5naW5lX2ZyZWUoZW5naW5lKTsKLQlpOTE1X2dlbV9jb250ZXh0c19maW5pKGk5MTUpOwotCW11
dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CisJaTkxNV9nZW1fZHJpdmVyX3Jl
bGVhc2VfX2NvbnRleHRzKGk5MTUpOwogCiAJaW50ZWxfdGltZWxpbmVzX2ZpbmkoaTkxNSk7CiAK
QEAgLTIwNiw3ICsyMDQsNyBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqbW9ja19nZW1fZGV2
aWNlKHZvaWQpCiAJcmV0dXJuIGk5MTU7CiAKIGVycl9jb250ZXh0OgotCWk5MTVfZ2VtX2NvbnRl
eHRzX2ZpbmkoaTkxNSk7CisJaTkxNV9nZW1fZHJpdmVyX3JlbGVhc2VfX2NvbnRleHRzKGk5MTUp
OwogZXJyX2VuZ2luZToKIAltb2NrX2VuZ2luZV9mcmVlKGk5MTUtPmVuZ2luZVtSQ1MwXSk7CiBl
cnJfdW5sb2NrOgotLSAKMi4yMy4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVl
ZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5m
by9pbnRlbC1nZng=

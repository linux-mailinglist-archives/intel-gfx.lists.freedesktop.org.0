Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1293BE6500
	for <lists+intel-gfx@lfdr.de>; Sun, 27 Oct 2019 20:08:47 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id DB4AF6E095;
	Sun, 27 Oct 2019 19:08:44 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 722CE6E095
 for <intel-gfx@lists.freedesktop.org>; Sun, 27 Oct 2019 19:08:43 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18986305-1500050 
 for multiple; Sun, 27 Oct 2019 19:08:37 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Sun, 27 Oct 2019 19:08:36 +0000
Message-Id: <20191027190836.10832-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0.rc1
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915/gt: Pull timeline initialise to
 intel_gt_init_early
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T3VyIHRpbWVsaW5lcyBhcmUgY3VycmVudGx5IGNvbnRhaW5lZCB3aXRoaW4gYW4gaW50ZWxfZ3Qs
IGFuZCB3ZSBvbmx5Cm5lZWQgdG8gcGVyZm9ybSBsaXN0L3NwaW5sb2NrIGluaXRpYWxpc2F0aW9u
LCBzbyB3ZSBjYW4gcHVsbCB0aGUKaW50ZWxfdGltZWxpbmVzX2luaXQoKSBpbnRvIG91ciBpbnRl
bF9ndF9pbml0X2Vhcmx5KCkuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNo
cmlzLXdpbHNvbi5jby51az4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5j
ICAgICAgICAgICAgICAgfCAgMiArKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfdGlt
ZWxpbmUuYyAgICAgICAgIHwgMTQgKystLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX3RpbWVsaW5lLmggICAgICAgICB8ICA0ICsrLS0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZ2VtLmMgICAgICAgICAgICAgICAgICB8ICA0IC0tLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2dlbV9kZXZpY2UuYyB8ICA1IC0tLS0tCiA1IGZpbGVzIGNo
YW5nZWQsIDYgaW5zZXJ0aW9ucygrKSwgMjMgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2d0LmMKaW5kZXggMTY4ZWNlZjZlNTdmLi4xNWFhNDY3MTM5OTkgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfZ3QuYwpAQCAtMjUsNiArMjUsNyBAQCB2b2lkIGludGVsX2d0X2luaXRf
ZWFybHkoc3RydWN0IGludGVsX2d0ICpndCwgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
CiAKIAlpbnRlbF9ndF9pbml0X3Jlc2V0KGd0KTsKIAlpbnRlbF9ndF9pbml0X3JlcXVlc3RzKGd0
KTsKKwlpbnRlbF9ndF9pbml0X3RpbWVsaW5lcyhndCk7CiAJaW50ZWxfZ3RfcG1faW5pdF9lYXJs
eShndCk7CiAJaW50ZWxfdWNfaW5pdF9lYXJseSgmZ3QtPnVjKTsKIH0KQEAgLTM5NSw0ICszOTYs
NSBAQCB2b2lkIGludGVsX2d0X2RyaXZlcl9sYXRlX3JlbGVhc2Uoc3RydWN0IGludGVsX2d0ICpn
dCkKIHsKIAlpbnRlbF91Y19kcml2ZXJfbGF0ZV9yZWxlYXNlKCZndC0+dWMpOwogCWludGVsX2d0
X2ZpbmlfcmVzZXQoZ3QpOworCWludGVsX2d0X2ZpbmlfdGltZWxpbmVzKGd0KTsKIH0KZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3RpbWVsaW5lLmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF90aW1lbGluZS5jCmluZGV4IDE0YWQxMGFjZDU0OC4uMTZh
OWU4OGQ5M2RlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF90aW1l
bGluZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3RpbWVsaW5lLmMKQEAg
LTI2Miw3ICsyNjIsNyBAQCBpbnQgaW50ZWxfdGltZWxpbmVfaW5pdChzdHJ1Y3QgaW50ZWxfdGlt
ZWxpbmUgKnRpbWVsaW5lLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgdm9pZCB0aW1lbGluZXNf
aW5pdChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQordm9pZCBpbnRlbF9ndF9pbml0X3RpbWVsaW5lcyhz
dHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewogCXN0cnVjdCBpbnRlbF9ndF90aW1lbGluZXMgKnRpbWVs
aW5lcyA9ICZndC0+dGltZWxpbmVzOwogCkBAIC0yNzMsMTEgKzI3Myw2IEBAIHN0YXRpYyB2b2lk
IHRpbWVsaW5lc19pbml0KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiAJSU5JVF9MSVNUX0hFQUQoJnRp
bWVsaW5lcy0+aHdzcF9mcmVlX2xpc3QpOwogfQogCi12b2lkIGludGVsX3RpbWVsaW5lc19pbml0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQotewotCXRpbWVsaW5lc19pbml0KCZpOTE1
LT5ndCk7Ci19Ci0KIHZvaWQgaW50ZWxfdGltZWxpbmVfZmluaShzdHJ1Y3QgaW50ZWxfdGltZWxp
bmUgKnRpbWVsaW5lKQogewogCUdFTV9CVUdfT04oYXRvbWljX3JlYWQoJnRpbWVsaW5lLT5waW5f
Y291bnQpKTsKQEAgLTU2Miw3ICs1NTcsNyBAQCB2b2lkIF9faW50ZWxfdGltZWxpbmVfZnJlZShz
dHJ1Y3Qga3JlZiAqa3JlZikKIAlrZnJlZV9yY3UodGltZWxpbmUsIHJjdSk7CiB9CiAKLXN0YXRp
YyB2b2lkIHRpbWVsaW5lc19maW5pKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCit2b2lkIGludGVsX2d0
X2ZpbmlfdGltZWxpbmVzKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7CiAJc3RydWN0IGludGVsX2d0
X3RpbWVsaW5lcyAqdGltZWxpbmVzID0gJmd0LT50aW1lbGluZXM7CiAKQEAgLTU3MCwxMSArNTY1
LDYgQEAgc3RhdGljIHZvaWQgdGltZWxpbmVzX2Zpbmkoc3RydWN0IGludGVsX2d0ICpndCkKIAlH
RU1fQlVHX09OKCFsaXN0X2VtcHR5KCZ0aW1lbGluZXMtPmh3c3BfZnJlZV9saXN0KSk7CiB9CiAK
LXZvaWQgaW50ZWxfdGltZWxpbmVzX2Zpbmkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Ci17Ci0JdGltZWxpbmVzX2ZpbmkoJmk5MTUtPmd0KTsKLX0KLQogI2lmIElTX0VOQUJMRUQoQ09O
RklHX0RSTV9JOTE1X1NFTEZURVNUKQogI2luY2x1ZGUgImd0L3NlbGZ0ZXN0cy9tb2NrX3RpbWVs
aW5lLmMiCiAjaW5jbHVkZSAiZ3Qvc2VsZnRlc3RfdGltZWxpbmUuYyIKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3RpbWVsaW5lLmggYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF90aW1lbGluZS5oCmluZGV4IGY1ODNhZjFiYTE4ZC4uZjViN2VhZGUzODA5
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF90aW1lbGluZS5oCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3RpbWVsaW5lLmgKQEAgLTg4LDcgKzg4
LDcgQEAgaW50IGludGVsX3RpbWVsaW5lX3JlYWRfaHdzcChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpm
cm9tLAogCQkJICAgICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICp1bnRpbCwKIAkJCSAgICAgdTMyICpo
d3NwX29mZnNldCk7CiAKLXZvaWQgaW50ZWxfdGltZWxpbmVzX2luaXQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpOwotdm9pZCBpbnRlbF90aW1lbGluZXNfZmluaShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSk7Cit2b2lkIGludGVsX2d0X2luaXRfdGltZWxpbmVzKHN0cnVjdCBp
bnRlbF9ndCAqZ3QpOwordm9pZCBpbnRlbF9ndF9maW5pX3RpbWVsaW5lcyhzdHJ1Y3QgaW50ZWxf
Z3QgKmd0KTsKIAogI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwppbmRleCBkZWFhM2M2MTY4
MzcuLjk4YmNhZTE4NjkyOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9n
ZW0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCkBAIC0xMTk1LDggKzEx
OTUsNiBAQCBpbnQgaTkxNV9nZW1faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCiAJCW1rd3JpdGVfZGV2aWNlX2luZm8oZGV2X3ByaXYpLT5wYWdlX3NpemVzID0KIAkJCUk5
MTVfR1RUX1BBR0VfU0laRV80SzsKIAotCWludGVsX3RpbWVsaW5lc19pbml0KGRldl9wcml2KTsK
LQogCXJldCA9IGk5MTVfZ2VtX2luaXRfdXNlcnB0cihkZXZfcHJpdik7CiAJaWYgKHJldCkKIAkJ
cmV0dXJuIHJldDsKQEAgLTEzMTAsNyArMTMwOCw2IEBAIGludCBpOTE1X2dlbV9pbml0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlpZiAocmV0ICE9IC1FSU8pIHsKIAkJaW50
ZWxfdWNfY2xlYW51cF9maXJtd2FyZXMoJmRldl9wcml2LT5ndC51Yyk7CiAJCWk5MTVfZ2VtX2Ns
ZWFudXBfdXNlcnB0cihkZXZfcHJpdik7Ci0JCWludGVsX3RpbWVsaW5lc19maW5pKGRldl9wcml2
KTsKIAl9CiAKIAlpZiAocmV0ID09IC1FSU8pIHsKQEAgLTEzNzQsNyArMTM3MSw2IEBAIHZvaWQg
aTkxNV9nZW1fZHJpdmVyX3JlbGVhc2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQogCiAJaW50ZWxfdWNfY2xlYW51cF9maXJtd2FyZXMoJmRldl9wcml2LT5ndC51Yyk7CiAJaTkx
NV9nZW1fY2xlYW51cF91c2VycHRyKGRldl9wcml2KTsKLQlpbnRlbF90aW1lbGluZXNfZmluaShk
ZXZfcHJpdik7CiAKIAlpOTE1X2dlbV9kcmFpbl9mcmVlZF9vYmplY3RzKGRldl9wcml2KTsKIApk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfZ2VtX2Rldmlj
ZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfZ2VtX2RldmljZS5jCmlu
ZGV4IDI3ZWQzY2VlNmE5Yi4uZTU4YjBiYzljZGI2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9zZWxmdGVzdHMvbW9ja19nZW1fZGV2aWNlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvc2VsZnRlc3RzL21vY2tfZ2VtX2RldmljZS5jCkBAIC02NSw4ICs2NSw2IEBAIHN0YXRp
YyB2b2lkIG1vY2tfZGV2aWNlX3JlbGVhc2Uoc3RydWN0IGRybV9kZXZpY2UgKmRldikKIAkJbW9j
a19lbmdpbmVfZnJlZShlbmdpbmUpOwogCWk5MTVfZ2VtX2RyaXZlcl9yZWxlYXNlX19jb250ZXh0
cyhpOTE1KTsKIAotCWludGVsX3RpbWVsaW5lc19maW5pKGk5MTUpOwotCiAJZHJhaW5fd29ya3F1
ZXVlKGk5MTUtPndxKTsKIAlpOTE1X2dlbV9kcmFpbl9mcmVlZF9vYmplY3RzKGk5MTUpOwogCkBA
IC0xODAsOCArMTc4LDYgQEAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKm1vY2tfZ2VtX2Rldmlj
ZSh2b2lkKQogCiAJbW9ja19pbml0X2NvbnRleHRzKGk5MTUpOwogCi0JaW50ZWxfdGltZWxpbmVz
X2luaXQoaTkxNSk7Ci0KIAltb2NrX2luaXRfZ2d0dChpOTE1LCAmaTkxNS0+Z2d0dCk7CiAKIAlt
a3dyaXRlX2RldmljZV9pbmZvKGk5MTUpLT5lbmdpbmVfbWFzayA9IEJJVCgwKTsKQEAgLTIwNiw3
ICsyMDIsNiBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqbW9ja19nZW1fZGV2aWNlKHZvaWQp
CiBlcnJfZW5naW5lOgogCW1vY2tfZW5naW5lX2ZyZWUoaTkxNS0+ZW5naW5lW1JDUzBdKTsKIGVy
cl91bmxvY2s6Ci0JaW50ZWxfdGltZWxpbmVzX2ZpbmkoaTkxNSk7CiAJZGVzdHJveV93b3JrcXVl
dWUoaTkxNS0+d3EpOwogZXJyX2RydjoKIAlpbnRlbF9tZW1vcnlfcmVnaW9uc19kcml2ZXJfcmVs
ZWFzZShpOTE1KTsKLS0gCjIuMjQuMC5yYzEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3Rz
LmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xp
c3RpbmZvL2ludGVsLWdmeA==

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 5483C6C7D9C
	for <lists+intel-gfx@lfdr.de>; Fri, 24 Mar 2023 13:01:47 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A19F310EBCA;
	Fri, 24 Mar 2023 12:01:45 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga06.intel.com (mga06b.intel.com [134.134.136.31])
 by gabe.freedesktop.org (Postfix) with ESMTPS id CF85310EBD2
 for <intel-gfx@lists.freedesktop.org>; Fri, 24 Mar 2023 12:01:43 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=intel.com; i=@intel.com; q=dns/txt; s=Intel;
 t=1679659303; x=1711195303;
 h=from:to:subject:date:message-id:references:in-reply-to:
 content-transfer-encoding:mime-version;
 bh=WLr2yZiWfS2ya0LpyinVudvrjvA2nSYhHCGmGtThbm0=;
 b=ffXsNms1dWNkvVVq29LTszYDqpiv+baKSHuCA9ZdRJX9L0vUq2VO1dkH
 H/kt1ZgKv932YjXpeo7OKgeY+Elw9CnIeGQd4Av/R2ghtSmCyxyZHUjkj
 tLdo0aujSrzB0T5HZOEKjw2EfuE0lqy6ZZ3GPUQ9RhjJaPaeEP4U80gzv
 KxpCDVzCImwxEs3TZR85Qsx+rtIMFl2nIL+EgfTP+LLyBo3FswmtTL/Hm
 YRO3jaHjANWoQv+8PbBi/qJLhEXbDEUqmUVoPAreujXPnXTT/zXii2gwp
 gZ2crsOTM5eW6DBvDaHKweEcIoxEjnCwcMtge76iooyjODPceUb11rpv2 A==;
X-IronPort-AV: E=McAfee;i="6600,9927,10658"; a="402347868"
X-IronPort-AV: E=Sophos;i="5.98,287,1673942400"; d="scan'208";a="402347868"
Received: from orsmga001.jf.intel.com ([10.7.209.18])
 by orsmga104.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 24 Mar 2023 05:01:43 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=McAfee;i="6600,9927,10658"; a="715204705"
X-IronPort-AV: E=Sophos;i="5.98,287,1673942400"; d="scan'208";a="715204705"
Received: from fmsmsx602.amr.corp.intel.com ([10.18.126.82])
 by orsmga001.jf.intel.com with ESMTP; 24 Mar 2023 05:01:43 -0700
Received: from fmsmsx612.amr.corp.intel.com (10.18.126.92) by
 fmsmsx602.amr.corp.intel.com (10.18.126.82) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id
 15.1.2507.21; Fri, 24 Mar 2023 05:01:42 -0700
Received: from fmsmsx611.amr.corp.intel.com (10.18.126.91) by
 fmsmsx612.amr.corp.intel.com (10.18.126.92) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id
 15.1.2507.21; Fri, 24 Mar 2023 05:01:42 -0700
Received: from fmsedg601.ED.cps.intel.com (10.1.192.135) by
 fmsmsx611.amr.corp.intel.com (10.18.126.91) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id
 15.1.2507.21 via Frontend Transport; Fri, 24 Mar 2023 05:01:42 -0700
Received: from NAM11-CO1-obe.outbound.protection.outlook.com (104.47.56.176)
 by edgegateway.intel.com (192.55.55.70) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.1.2507.21; Fri, 24 Mar 2023 05:01:41 -0700
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=i4z+5hq7XWn1O2asW19tdf/wMlfgPeFGyRzwYravFY4KTcxWhuy4WseTldVFWowAvHr+Kj5CtNlv/7UT66JmX55qY6VcIyBFMIMpLFq1wxdVp3Y73MmcvdSO0oQvuayWTV5M4tATo8SlLYtfVasryafCYj+aMiWVVU9C5gvoz7fmky0EFpdzWpnlYjqlVppXfwj7pLh2iydpkQGgn+kt3EP3+hZZ7ETcJCM3/UtO2OoJQf9H8Ttjbk+Efaw76rQRGxZlWeFxxhimcljk2zaslA/0q1fNNF713EahAdKM90cEphA3ClKldRfwESyoHXFibrg0cLiqNVZ8mAI7YfJe6w==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=WLr2yZiWfS2ya0LpyinVudvrjvA2nSYhHCGmGtThbm0=;
 b=cZwNkZ2J+ZiyjtKqAkyUhenoAO1XEvh92YEd9ezDrgtnPFNMz8iJ/YHOHELJwpHlO+rGSYqgpB4qNkkcaBSE0i33T2kej4Y6gjcj9e4cL71pOvTtmBg9AGWLbjpcrFVgOZ9eN4wp63K78k9vVHv2IRM21Cz76ZTIFHcEAgSYA9i6DQlR5J06nt9TYK+L36wVaKUeBe004Bhj+VynxNvTnKcD8DCTvWNeYq5PnJNwMKuHH2FfJx/QWmfYFHNahm47qrKbTRTYrfdCjMsLk38rOsbWQvtUORhD9EvT4c7Ttc3NWchLsBKgT594ryYIKOr1Hs8DUCyJodeD2OW+ZUubNA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=intel.com; dmarc=pass action=none header.from=intel.com;
 dkim=pass header.d=intel.com; arc=none
Received: from MW4PR11MB7054.namprd11.prod.outlook.com (2603:10b6:303:219::20)
 by DS0PR11MB7904.namprd11.prod.outlook.com (2603:10b6:8:f8::8) with
 Microsoft
 SMTP Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.6134.25; Fri, 24 Mar 2023 12:01:37 +0000
Received: from MW4PR11MB7054.namprd11.prod.outlook.com
 ([fe80::3910:8188:6548:993b]) by MW4PR11MB7054.namprd11.prod.outlook.com
 ([fe80::3910:8188:6548:993b%7]) with mapi id 15.20.6178.038; Fri, 24 Mar 2023
 12:01:37 +0000
From: "Kahola, Mika" <mika.kahola@intel.com>
To: "Deak, Imre" <imre.deak@intel.com>, "intel-gfx@lists.freedesktop.org"
 <intel-gfx@lists.freedesktop.org>
Thread-Topic: [Intel-gfx] [PATCH 05/29] drm/i915/tc: Move TC port fields to a
 new intel_tc_port struct
Thread-Index: AQHZXZK4AUxnXaKFl0eIe4XMeYPSI68J1YUQ
Date: Fri, 24 Mar 2023 12:01:37 +0000
Message-ID: <MW4PR11MB7054CD1F25D7A8914B793007EF849@MW4PR11MB7054.namprd11.prod.outlook.com>
References: <20230323142035.1432621-1-imre.deak@intel.com>
 <20230323142035.1432621-6-imre.deak@intel.com>
In-Reply-To: <20230323142035.1432621-6-imre.deak@intel.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
authentication-results: dkim=none (message not signed)
 header.d=none;dmarc=none action=none header.from=intel.com;
x-ms-publictraffictype: Email
x-ms-traffictypediagnostic: MW4PR11MB7054:EE_|DS0PR11MB7904:EE_
x-ms-office365-filtering-correlation-id: 31c8f3b9-38f8-41ad-9bb0-08db2c5f8559
x-ld-processed: 46c98d88-e344-4ed4-8496-4ed7712e255d,ExtAddr
x-ms-exchange-senderadcheck: 1
x-ms-exchange-antispam-relay: 0
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: aCb7LxFUVo3pfZoot6W01LUjrgDG2sWCjRIkX122Bn+cY5AIVMSQNuFJu+c5WlTKLkmS01kKOECmD4VpKiabtFKarzPCbSHOvREEwoj0mbfvbsWJEUvRa/4wZ4AcFdcQ7iEk7gdwbYND7EVrKX4HX1Fib41fyEhvFTMtpbCo1WRSZlwxPw6S87sPjq4Y7yU4VOZiw9LQyTciiOwD2N+woknkuvE5KAHjME0dtGskEQb/YYNUSsg85AK2k2d6nzzARZuyHcQKfdex0a/AvktqlodBWzizVKSEIUxzqmJm+XWwbdecZCDIEBbAp/+4BjR16INvHDshdCzukVK2bW0sj49bL43H/aSviGwR42ag5pLo+UozDeH8kENcZUqlBejRhbZnZMOisAL6tgKyd/Fr+28/KWMeGvJvwNMlpHI1SpkKcDEMq86sqdJAUGTcvw/ojA9DnYN6BobYSfP85u3MpDdqoPAZqC2Xn6YEbhShoBup6x6hn3yZmRlA3uRBkgF/6TLdyZw/UU6O9zHPlhH4zESXT58YVLPCko1/4KGTRg4ITmbjfbrsLTPxSfEFV8VrBZOFMYo8H9vSayEwRXqYgeV8uIlJDH5x4mL+OtxXyDZqUkN8qpf45otS0aajRDYjEG2ajU/WBkm8Uct7P/TLRdfSLouGSQ6JnyUi12NpSJaFkRt2wP8MymwFFCqwwEkN07NielQtdfud8OqRay93MQ==
x-forefront-antispam-report: CIP:255.255.255.255; CTRY:; LANG:en; SCL:1; SRV:;
 IPV:NLI; SFV:NSPM; H:MW4PR11MB7054.namprd11.prod.outlook.com; PTR:; CAT:NONE;
 SFS:(13230025)(396003)(366004)(136003)(376002)(39860400002)(346002)(451199018)(52536014)(122000001)(38100700002)(478600001)(30864003)(5660300002)(26005)(2906002)(186003)(53546011)(6506007)(71200400001)(55016003)(86362001)(9686003)(38070700005)(7696005)(33656002)(8936002)(8676002)(66556008)(66476007)(66946007)(64756008)(66446008)(76116006)(316002)(83380400001)(110136005)(41300700001)(82960400001)(579004)(559001);
 DIR:OUT; SFP:1102; 
x-ms-exchange-antispam-messagedata-chunkcount: 1
x-ms-exchange-antispam-messagedata-0: =?utf-8?B?ejRpcERmdlJseHJnQXNNL1hCcGlsRGVBTEcraGMzeG9TZTZod2hRNEoyTkpm?=
 =?utf-8?B?VUx4VElPVmM3TTVFcCtwaWVvcTh0YmpCelI4ZEpRMHVubEpVQVhpaWNhVG53?=
 =?utf-8?B?THZleUdHVk52TzJhOGJkTHBsYlIzMmUxM1FQcFAxVDkyZTJjenAvelN3Q04v?=
 =?utf-8?B?K0JDMDFFUFZKYTNGZHdMb3l6SnR4WlpJbm5ZeUhFQ05nUkIzMm1tU2dyME1N?=
 =?utf-8?B?czZYcVEwcUQraldJWnY4QXRVNllYczNDemNrNXZYczcyVXZhWm9pbEp2TjVL?=
 =?utf-8?B?VFJkQlBsV1FFcTI1cjU5RjduUkFqeWRXVkpISXAvYno5NVpGRFlsbndBcHor?=
 =?utf-8?B?a2NhcVUwK3ZndHNJL2VjSys4bStjTnB4eTRZVzFpNnp4VlIxSmExUVh4eS9p?=
 =?utf-8?B?MHh3YW5YZWlkeHp3bHIvbjVnK2ZTeDAvK3hhTjdSeUNDdlNzcFp6QmFsVWVY?=
 =?utf-8?B?WGJVbHFjN2FSdXlEeGlPRzEwOVhkNklGa0wxdTdnRnlJOHZRdFNaMG0rT2t2?=
 =?utf-8?B?WFJ5NVJZd0c4WWczVFp1MFlNREdhdEtZMnpUb1BpZzdIYnZzZ2hZMUErZ1FH?=
 =?utf-8?B?ZmRVQnRVeDZWWkZFeWRXUWpSNnhqL2V6SUFtTnovd3ZTaHFobDEwVGZlbGZE?=
 =?utf-8?B?OG1iZDI0RTNvMzFRekl5WEVlaXVSV0NmLy9QaDdFRlFyM0E4azBFaXc1NTdi?=
 =?utf-8?B?NHRuckRqeUtJS1A3WmpaTVBWS2NlTTFDaE1sdG4yQjZGdFAxSjlXM0Nmdk1Z?=
 =?utf-8?B?dHJKbHgvYXpuc0xVQlJvZnlSZVo5L2M2VDhMUUhQUzJyMEpWdDRqSWlHWWpj?=
 =?utf-8?B?M0RoaDRYS04zV2tQcFNLbUZYcDBmaWxyNkp3azRaZVN4MjlEb2JpbFJlTENM?=
 =?utf-8?B?UTRCb1B5WVh0VmZFaTVxNWRuN1VTRDdZR1RxZkVLM2hacmRqWG5LU3BzRDY2?=
 =?utf-8?B?L3FxSy94aXcrR3JSekI3VkNwTHBKaExxd3BacEVQZmZXUWgweGVwd2Z6b2NB?=
 =?utf-8?B?OGNtVzR3bllQUXg3NldUcEJyOTNMWGdrYUZLemZ3czExQlBBL0xhY1hyNWdU?=
 =?utf-8?B?V0VGU2VJWnYwK2FDQlF2bEsvWU50bFR4NXRXNWRESEIrSlVxL1NaTDQvOUZK?=
 =?utf-8?B?T1JKY3l4WkpRK3lFOHhsc2luaGZRMCtOdHoxcUg1WTBHbnRvdHlmYytWNDJj?=
 =?utf-8?B?Q1RLSzFSS0NIWHRvTXFvdnF1RnhLTXhhYkdHUERNdnlWNEQva3pMRStPK3hG?=
 =?utf-8?B?V0N0cXJabTRuYnBsUUtJdWtldFNDRWRWeTh1dlFHZlM5dmhyNi9UVXlaRWVW?=
 =?utf-8?B?MHlEb285WUNVMU5sWkNsTDlUcU5nVEpRempCaEUxWU1pcHplVFlmc1grbmxi?=
 =?utf-8?B?ZEk4OWFmN3JMWG1RZEh5UG13RzIxWGY1RkYzODZsU0hxdFVTVTUyM2NCZUln?=
 =?utf-8?B?cm1DZVI3REhBS1UyQXVxVURuZlZ1QkwwSmQydFU3RWRXWFpVMXF4TzdZU0Ry?=
 =?utf-8?B?NE5BS3p1U3Jrai8zVDFzRzczTk1BRkJua0F2eWh0Qjl5dnNsMC81N1ZjM1pk?=
 =?utf-8?B?Yml1dFpjU21zWW1iNWJjRFB3MS9IS2JVdjd5bXNuQVFjWURLcE5XUFBXRWV0?=
 =?utf-8?B?NGlvNE1LVThRQ1hLU3JvZ3ZUMUhnUjhlenhldGRSN0hqUG1KaHFrY0w1OHJP?=
 =?utf-8?B?YW5sVEhoUFo3KzNBUmdqNitwUUpVeGhGcWR1R05neFhEQ1BrWCtwc21oemVZ?=
 =?utf-8?B?blV5ekhFWTNSMVZzOS81elo5OXl1ZUZId2g3aXZjSXpXek1FTUMvRFdWRjVy?=
 =?utf-8?B?cS9tYlBQQzJ0UFB0a1AzVWthd25tZHNEeG9hUWkreENqUy9WQTdWQk9RWDEy?=
 =?utf-8?B?ZjNxclVUTEFZMWdTRjZwMi9TQnlXK2M3Y0J1Qk9NSHlRQTQ1VS9zTktYWFhF?=
 =?utf-8?B?NW11NGtFZkdXbkhOeW5vb25oMlI2YXZQOEZ3OVpFSVdMczNIRUlCaHpXK0Jx?=
 =?utf-8?B?QUxuL3B1WEFsLzhHTWQ3WEVDcDBtenZ4UXlBd09TRW1CRHhjMS9BQlorbkhh?=
 =?utf-8?B?eXFYV29iNTVBZ1c5SzhhNjBqMkpjTXdyeG1SMktUUDg4Snd6ZkpFdFFXSmJ4?=
 =?utf-8?Q?1IjWVwM+lts3yxFXqglrHiHxD?=
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: MW4PR11MB7054.namprd11.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 31c8f3b9-38f8-41ad-9bb0-08db2c5f8559
X-MS-Exchange-CrossTenant-originalarrivaltime: 24 Mar 2023 12:01:37.3346 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 46c98d88-e344-4ed4-8496-4ed7712e255d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: XuqykWlCNLtfQX+wSyFl6FYxVBldDBqePCxJjqRpdVe8AI0e9U3OVMR9+EvAgwVxksKdTl2UW3ReKBmRIlr5IQ==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DS0PR11MB7904
X-OriginatorOrg: intel.com
Subject: Re: [Intel-gfx] [PATCH 05/29] drm/i915/tc: Move TC port fields to a
 new intel_tc_port struct
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

PiAtLS0tLU9yaWdpbmFsIE1lc3NhZ2UtLS0tLQ0KPiBGcm9tOiBJbnRlbC1nZnggPGludGVsLWdm
eC1ib3VuY2VzQGxpc3RzLmZyZWVkZXNrdG9wLm9yZz4gT24gQmVoYWxmIE9mIEltcmUNCj4gRGVh
aw0KPiBTZW50OiBUaHVyc2RheSwgTWFyY2ggMjMsIDIwMjMgNDoyMCBQTQ0KPiBUbzogaW50ZWwt
Z2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZw0KPiBTdWJqZWN0OiBbSW50ZWwtZ2Z4XSBbUEFUQ0gg
MDUvMjldIGRybS9pOTE1L3RjOiBNb3ZlIFRDIHBvcnQgZmllbGRzIHRvIGEgbmV3DQo+IGludGVs
X3RjX3BvcnQgc3RydWN0DQo+IA0KPiBNb3ZlIHRoZSBUQyBwb3J0IHNwZWNpZmljIGZpZWxkcyBm
cm9tIGludGVsX2RpZ2l0YWxfcG9ydCB0byBhIG5ldyBpbnRlbF90Y19wb3J0DQo+IHN0cnVjdC4g
UGFzcyBhbiBpbnRlbF90Y19wb3J0IHBvaW50ZXIgdG8gYWxsIHN0YXRpYyBmdW5jdGlvbnMgaW4g
aW50ZWxfdGMuYyBrZWVwaW5nDQo+IGRpZ19wb3J0IGFjY2Vzc2libGUgZm9yIHRoZXNlIHZpYSBh
IHBvaW50ZXIgc3RvcmVkIGluIHRoZSBuZXcgc3RydWN0Lg0KPiANCj4gVGhlIG5leHQgcGF0Y2gg
d2lsbCBhbGxvY2F0ZSB0aGUgaW50ZWxfdGNfcG9ydCBkeW5hbWljYWxseSwgYWxsb3dpbmcgbW92
aW5nIHRoZQ0KPiBzdHJ1Y3QgZGVmaW5pdGlvbiB0byBpbnRlbF90Yy5jLg0KPiANCg0KUmV2aWV3
ZWQtYnk6IE1pa2EgS2Fob2xhIDxtaWthLmthaG9sYUBpbnRlbC5jb20+DQoNCj4gU2lnbmVkLW9m
Zi1ieTogSW1yZSBEZWFrIDxpbXJlLmRlYWtAaW50ZWwuY29tPg0KPiAtLS0NCj4gIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5oICB8ICAgNyAtDQo+ICAuLi4vZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmggICAgfCAgMTMgKy0NCj4gIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfdGMuYyAgICAgICB8IDU3OCArKysrKysrKysr
LS0tLS0tLS0NCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfdGMuaCAgICAg
ICB8ICAyNiArDQo+ICA0IGZpbGVzIGNoYW5nZWQsIDMzNSBpbnNlcnRpb25zKCspLCAyODkgZGVs
ZXRpb25zKC0pDQo+IA0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9kaXNwbGF5LmgNCj4gYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2Rpc3BsYXkuaA0KPiBpbmRleCA1OTZmZDNlYzE5ODM4Li4yODcxNTliZGViMGQxIDEwMDY0NA0K
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuaA0KPiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuaA0KPiBAQCAt
MTY0LDEzICsxNjQsNiBAQCBlbnVtIHRjX3BvcnQgew0KPiAgCUk5MTVfTUFYX1RDX1BPUlRTDQo+
ICB9Ow0KPiANCj4gLWVudW0gdGNfcG9ydF9tb2RlIHsNCj4gLQlUQ19QT1JUX0RJU0NPTk5FQ1RF
RCwNCj4gLQlUQ19QT1JUX1RCVF9BTFQsDQo+IC0JVENfUE9SVF9EUF9BTFQsDQo+IC0JVENfUE9S
VF9MRUdBQ1ksDQo+IC19Ow0KPiAtDQo+ICBlbnVtIGF1eF9jaCB7DQo+ICAJQVVYX0NIX05PTkUg
PSAtMSwNCj4gDQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX2Rpc3BsYXlfdHlwZXMuaA0KPiBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfZGlzcGxheV90eXBlcy5oDQo+IGluZGV4IGFiMTQ2YjViNjhiZDUuLjAxMzBjN2I3ZjAyMzIg
MTAwNjQ0DQo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxh
eV90eXBlcy5oDQo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlz
cGxheV90eXBlcy5oDQo+IEBAIC01NCw2ICs1NCw3IEBADQo+ICAjaW5jbHVkZSAiaW50ZWxfZGlz
cGxheV9wb3dlci5oIg0KPiAgI2luY2x1ZGUgImludGVsX2RwbGxfbWdyLmgiDQo+ICAjaW5jbHVk
ZSAiaW50ZWxfd21fdHlwZXMuaCINCj4gKyNpbmNsdWRlICJpbnRlbF90Yy5oIg0KPiANCj4gIHN0
cnVjdCBkcm1fcHJpbnRlcjsNCj4gIHN0cnVjdCBfX2ludGVsX2dsb2JhbF9vYmpzX3N0YXRlOw0K
PiBAQCAtMTc4MCwxNyArMTc4MSw3IEBAIHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgew0KPiAg
CWludGVsX3dha2VyZWZfdCBkZGlfaW9fd2FrZXJlZjsNCj4gIAlpbnRlbF93YWtlcmVmX3QgYXV4
X3dha2VyZWY7DQo+IA0KPiAtCXN0cnVjdCBtdXRleCB0Y19sb2NrOwkvKiBwcm90ZWN0cyB0aGUg
VHlwZUMgcG9ydCBtb2RlICovDQo+IC0JaW50ZWxfd2FrZXJlZl90IHRjX2xvY2tfd2FrZXJlZjsN
Cj4gLQllbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIHRjX2xvY2tfcG93ZXJfZG9tYWlu
Ow0KPiAtCXN0cnVjdCBkZWxheWVkX3dvcmsgdGNfZGlzY29ubmVjdF9waHlfd29yazsNCj4gLQlp
bnQgdGNfbGlua19yZWZjb3VudDsNCj4gLQlib29sIHRjX2xlZ2FjeV9wb3J0OjE7DQo+IC0JY2hh
ciB0Y19wb3J0X25hbWVbOF07DQo+IC0JZW51bSB0Y19wb3J0X21vZGUgdGNfbW9kZTsNCj4gLQll
bnVtIHRjX3BvcnRfbW9kZSB0Y19pbml0X21vZGU7DQo+IC0JZW51bSBwaHlfZmlhIHRjX3BoeV9m
aWE7DQo+IC0JdTggdGNfcGh5X2ZpYV9pZHg7DQo+ICsJc3RydWN0IGludGVsX3RjX3BvcnQgdGM7
DQo+IA0KPiAgCS8qIHByb3RlY3RzIG51bV9oZGNwX3N0cmVhbXMgcmVmZXJlbmNlIGNvdW50LCBo
ZGNwX3BvcnRfZGF0YSBhbmQNCj4gaGRjcF9hdXRoX3N0YXR1cyAqLw0KPiAgCXN0cnVjdCBtdXRl
eCBoZGNwX211dGV4Ow0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF90Yy5jDQo+IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF90Yy5j
DQo+IGluZGV4IGQyYWZlOGI2NWJlZWUuLjcwNzcxMDQ0YTJmZTggMTAwNjQ0DQo+IC0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfdGMuYw0KPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3RjLmMNCj4gQEAgLTE1LDkgKzE1LDkgQEANCj4gICNp
bmNsdWRlICJpbnRlbF9tZ19waHlfcmVncy5oIg0KPiAgI2luY2x1ZGUgImludGVsX3RjLmgiDQo+
IA0KPiAtc3RhdGljIHUzMiB0Y19waHlfaHBkX2xpdmVfc3RhdHVzKHN0cnVjdCBpbnRlbF9kaWdp
dGFsX3BvcnQgKmRpZ19wb3J0KTsgLXN0YXRpYw0KPiBib29sIHRjX3BoeV9pc19yZWFkeShzdHJ1
Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCk7IC1zdGF0aWMgYm9vbA0KPiB0Y19waHlf
dGFrZV9vd25lcnNoaXAoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQsIGJvb2wg
dGFrZSk7DQo+ICtzdGF0aWMgdTMyIHRjX3BoeV9ocGRfbGl2ZV9zdGF0dXMoc3RydWN0IGludGVs
X3RjX3BvcnQgKnRjKTsgc3RhdGljDQo+ICtib29sIHRjX3BoeV9pc19yZWFkeShzdHJ1Y3QgaW50
ZWxfdGNfcG9ydCAqdGMpOyBzdGF0aWMgYm9vbA0KPiArdGNfcGh5X3Rha2Vfb3duZXJzaGlwKHN0
cnVjdCBpbnRlbF90Y19wb3J0ICp0YywgYm9vbCB0YWtlKTsNCj4gDQo+ICBzdGF0aWMgY29uc3Qg
Y2hhciAqdGNfcG9ydF9tb2RlX25hbWUoZW51bSB0Y19wb3J0X21vZGUgbW9kZSkgIHsgQEAgLQ0K
PiAzNCwxMyArMzQsMjQgQEAgc3RhdGljIGNvbnN0IGNoYXIgKnRjX3BvcnRfbW9kZV9uYW1lKGVu
dW0gdGNfcG9ydF9tb2RlDQo+IG1vZGUpDQo+ICAJcmV0dXJuIG5hbWVzW21vZGVdOw0KPiAgfQ0K
PiANCj4gK3N0YXRpYyBzdHJ1Y3QgaW50ZWxfdGNfcG9ydCAqdG9fdGNfcG9ydChzdHJ1Y3QgaW50
ZWxfZGlnaXRhbF9wb3J0DQo+ICsqZGlnX3BvcnQpIHsNCj4gKwlyZXR1cm4gJmRpZ19wb3J0LT50
YzsNCj4gK30NCj4gKw0KPiArc3RhdGljIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICp0Y190b19p
OTE1KHN0cnVjdCBpbnRlbF90Y19wb3J0ICp0Yykgew0KPiArCXJldHVybiB0b19pOTE1KHRjLT5k
aWdfcG9ydC0+YmFzZS5iYXNlLmRldik7DQo+ICt9DQo+ICsNCj4gIHN0YXRpYyBib29sIGludGVs
X3RjX3BvcnRfaW5fbW9kZShzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCwNCj4g
IAkJCQkgIGVudW0gdGNfcG9ydF9tb2RlIG1vZGUpDQo+ICB7DQo+ICAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsNCj4gIAll
bnVtIHBoeSBwaHkgPSBpbnRlbF9wb3J0X3RvX3BoeShpOTE1LCBkaWdfcG9ydC0+YmFzZS5wb3J0
KTsNCj4gKwlzdHJ1Y3QgaW50ZWxfdGNfcG9ydCAqdGMgPSB0b190Y19wb3J0KGRpZ19wb3J0KTsN
Cj4gDQo+IC0JcmV0dXJuIGludGVsX3BoeV9pc190YyhpOTE1LCBwaHkpICYmIGRpZ19wb3J0LT50
Y19tb2RlID09IG1vZGU7DQo+ICsJcmV0dXJuIGludGVsX3BoeV9pc190YyhpOTE1LCBwaHkpICYm
IHRjLT5tb2RlID09IG1vZGU7DQo+ICB9DQo+IA0KPiAgYm9vbCBpbnRlbF90Y19wb3J0X2luX3Ri
dF9hbHRfbW9kZShzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCkgQEAgLQ0KPiA2
MSwxNSArNzIsMTcgQEAgYm9vbCBpbnRlbF90Y19wb3J0X2luX2xlZ2FjeV9tb2RlKHN0cnVjdCBp
bnRlbF9kaWdpdGFsX3BvcnQNCj4gKmRpZ19wb3J0KSAgYm9vbCBpbnRlbF90Y19jb2xkX3JlcXVp
cmVzX2F1eF9wdyhzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0DQo+ICpkaWdfcG9ydCkgIHsNCj4g
IAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGlnX3BvcnQtPmJhc2Uu
YmFzZS5kZXYpOw0KPiArCXN0cnVjdCBpbnRlbF90Y19wb3J0ICp0YyA9IHRvX3RjX3BvcnQoZGln
X3BvcnQpOw0KPiANCj4gLQlyZXR1cm4gKERJU1BMQVlfVkVSKGk5MTUpID09IDExICYmIGRpZ19w
b3J0LT50Y19sZWdhY3lfcG9ydCkgfHwNCj4gKwlyZXR1cm4gKERJU1BMQVlfVkVSKGk5MTUpID09
IDExICYmIHRjLT5sZWdhY3lfcG9ydCkgfHwNCj4gIAkJSVNfQUxERVJMQUtFX1AoaTkxNSk7DQo+
ICB9DQo+IA0KPiAgc3RhdGljIGVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4NCj4gLXRj
X2NvbGRfZ2V0X3Bvd2VyX2RvbWFpbihzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9y
dCwgZW51bQ0KPiB0Y19wb3J0X21vZGUgbW9kZSkNCj4gK3RjX2NvbGRfZ2V0X3Bvd2VyX2RvbWFp
bihzdHJ1Y3QgaW50ZWxfdGNfcG9ydCAqdGMsIGVudW0gdGNfcG9ydF9tb2RlDQo+ICttb2RlKQ0K
PiAgew0KPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkaWdfcG9y
dC0+YmFzZS5iYXNlLmRldik7DQo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
Y190b19pOTE1KHRjKTsNCj4gKwlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCA9
IHRjLT5kaWdfcG9ydDsNCj4gDQo+ICAJaWYgKG1vZGUgPT0gVENfUE9SVF9UQlRfQUxUIHx8DQo+
ICFpbnRlbF90Y19jb2xkX3JlcXVpcmVzX2F1eF9wdyhkaWdfcG9ydCkpDQo+ICAJCXJldHVybiBQ
T1dFUl9ET01BSU5fVENfQ09MRF9PRkY7DQo+IEBAIC03OCwyNyArOTEsMjcgQEAgdGNfY29sZF9n
ZXRfcG93ZXJfZG9tYWluKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQNCj4gKmRpZ19wb3J0LCBl
bnVtIHRjX3BvcnRfbW9kZSAgfQ0KPiANCj4gIHN0YXRpYyBpbnRlbF93YWtlcmVmX3QNCj4gLXRj
X2NvbGRfYmxvY2tfaW5fbW9kZShzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCwg
ZW51bQ0KPiB0Y19wb3J0X21vZGUgbW9kZSwNCj4gK3RjX2NvbGRfYmxvY2tfaW5fbW9kZShzdHJ1
Y3QgaW50ZWxfdGNfcG9ydCAqdGMsIGVudW0gdGNfcG9ydF9tb2RlIG1vZGUsDQo+ICAJCSAgICAg
IGVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gKmRvbWFpbikgIHsNCj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYp
Ow0KPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdGNfdG9faTkxNSh0Yyk7DQo+
IA0KPiAtCSpkb21haW4gPSB0Y19jb2xkX2dldF9wb3dlcl9kb21haW4oZGlnX3BvcnQsIG1vZGUp
Ow0KPiArCSpkb21haW4gPSB0Y19jb2xkX2dldF9wb3dlcl9kb21haW4odGMsIG1vZGUpOw0KPiAN
Cj4gIAlyZXR1cm4gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoaTkxNSwgKmRvbWFpbik7ICB9DQo+
IA0KPiAgc3RhdGljIGludGVsX3dha2VyZWZfdA0KPiAtdGNfY29sZF9ibG9jayhzdHJ1Y3QgaW50
ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCwgZW51bQ0KPiBpbnRlbF9kaXNwbGF5X3Bvd2VyX2Rv
bWFpbiAqZG9tYWluKQ0KPiArdGNfY29sZF9ibG9jayhzdHJ1Y3QgaW50ZWxfdGNfcG9ydCAqdGMs
IGVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4NCj4gKypkb21haW4pDQo+ICB7DQo+IC0J
cmV0dXJuIHRjX2NvbGRfYmxvY2tfaW5fbW9kZShkaWdfcG9ydCwgZGlnX3BvcnQtPnRjX21vZGUs
IGRvbWFpbik7DQo+ICsJcmV0dXJuIHRjX2NvbGRfYmxvY2tfaW5fbW9kZSh0YywgdGMtPm1vZGUs
IGRvbWFpbik7DQo+ICB9DQo+IA0KPiAgc3RhdGljIHZvaWQNCj4gLXRjX2NvbGRfdW5ibG9jayhz
dHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCwgZW51bQ0KPiBpbnRlbF9kaXNwbGF5
X3Bvd2VyX2RvbWFpbiBkb21haW4sDQo+ICt0Y19jb2xkX3VuYmxvY2soc3RydWN0IGludGVsX3Rj
X3BvcnQgKnRjLCBlbnVtDQo+ICtpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBkb21haW4sDQo+
ICAJCWludGVsX3dha2VyZWZfdCB3YWtlcmVmKQ0KPiAgew0KPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShkaWdfcG9ydC0+YmFzZS5iYXNlLmRldik7DQo+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0Y190b19pOTE1KHRjKTsNCj4gDQo+ICAJLyoN
Cj4gIAkgKiB3YWtlcmVmID09IC0xLCBtZWFucyBzb21lIGVycm9yIGhhcHBlbmVkIHNhdmluZyBz
YXZlX2RlcG90X3N0YWNrDQo+IGJ1dCBAQCAtMTEyLDczICsxMjUsNzYgQEAgdGNfY29sZF91bmJs
b2NrKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQNCj4gKmRpZ19wb3J0LCBlbnVtIGludGVsX2Rp
c3BsYXlfcG93ZXJfZG8gIH0NCj4gDQo+ICBzdGF0aWMgdm9pZA0KPiAtYXNzZXJ0X3RjX2NvbGRf
YmxvY2tlZChzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCkNCj4gK2Fzc2VydF90
Y19jb2xkX2Jsb2NrZWQoc3RydWN0IGludGVsX3RjX3BvcnQgKnRjKQ0KPiAgew0KPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkaWdfcG9ydC0+YmFzZS5iYXNlLmRl
dik7DQo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0Y190b19pOTE1KHRjKTsN
Cj4gIAlib29sIGVuYWJsZWQ7DQo+IA0KPiAgCWVuYWJsZWQgPSBpbnRlbF9kaXNwbGF5X3Bvd2Vy
X2lzX2VuYWJsZWQoaTkxNSwNCj4gLQ0KPiB0Y19jb2xkX2dldF9wb3dlcl9kb21haW4oZGlnX3Bv
cnQsDQo+IC0NCj4gZGlnX3BvcnQtPnRjX21vZGUpKTsNCj4gKw0KPiB0Y19jb2xkX2dldF9wb3dl
cl9kb21haW4odGMsDQo+ICsJCQkJCQkJCQkgIHRjLQ0KPiA+bW9kZSkpOw0KPiAgCWRybV9XQVJO
X09OKCZpOTE1LT5kcm0sICFlbmFibGVkKTsNCj4gIH0NCj4gDQo+ICBzdGF0aWMgZW51bSBpbnRl
bF9kaXNwbGF5X3Bvd2VyX2RvbWFpbg0KPiAtdGNfcG9ydF9wb3dlcl9kb21haW4oc3RydWN0IGlu
dGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQpDQo+ICt0Y19wb3J0X3Bvd2VyX2RvbWFpbihzdHJ1
Y3QgaW50ZWxfdGNfcG9ydCAqdGMpDQo+ICB7DQo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsNCj4gLQllbnVtIHRjX3Bv
cnQgdGNfcG9ydCA9IGludGVsX3BvcnRfdG9fdGMoaTkxNSwgZGlnX3BvcnQtPmJhc2UucG9ydCk7
DQo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0Y190b19pOTE1KHRjKTsNCj4g
KwllbnVtIHRjX3BvcnQgdGNfcG9ydCA9IGludGVsX3BvcnRfdG9fdGMoaTkxNSwNCj4gK3RjLT5k
aWdfcG9ydC0+YmFzZS5wb3J0KTsNCj4gDQo+ICAJcmV0dXJuIFBPV0VSX0RPTUFJTl9QT1JUX0RE
SV9MQU5FU19UQzEgKyB0Y19wb3J0IC0NCj4gVENfUE9SVF8xOyAgfQ0KPiANCj4gIHN0YXRpYyB2
b2lkDQo+IC1hc3NlcnRfdGNfcG9ydF9wb3dlcl9lbmFibGVkKHN0cnVjdCBpbnRlbF9kaWdpdGFs
X3BvcnQgKmRpZ19wb3J0KQ0KPiArYXNzZXJ0X3RjX3BvcnRfcG93ZXJfZW5hYmxlZChzdHJ1Y3Qg
aW50ZWxfdGNfcG9ydCAqdGMpDQo+ICB7DQo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsNCj4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRjX3RvX2k5MTUodGMpOw0KPiANCj4gIAlkcm1fV0FSTl9PTigm
aTkxNS0+ZHJtLA0KPiAtCQkgICAgIWludGVsX2Rpc3BsYXlfcG93ZXJfaXNfZW5hYmxlZChpOTE1
LA0KPiB0Y19wb3J0X3Bvd2VyX2RvbWFpbihkaWdfcG9ydCkpKTsNCj4gKwkJICAgICFpbnRlbF9k
aXNwbGF5X3Bvd2VyX2lzX2VuYWJsZWQoaTkxNSwNCj4gdGNfcG9ydF9wb3dlcl9kb21haW4odGMp
KSk7DQo+ICB9DQo+IA0KPiAgdTMyIGludGVsX3RjX3BvcnRfZ2V0X2xhbmVfbWFzayhzdHJ1Y3Qg
aW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCkgIHsNCj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOw0KPiArCXN0cnVj
dCBpbnRlbF90Y19wb3J0ICp0YyA9IHRvX3RjX3BvcnQoZGlnX3BvcnQpOw0KPiAgCXUzMiBsYW5l
X21hc2s7DQo+IA0KPiAtCWxhbmVfbWFzayA9IGludGVsX2RlX3JlYWQoaTkxNSwgUE9SVF9UWF9E
RkxFWERQU1AoZGlnX3BvcnQtDQo+ID50Y19waHlfZmlhKSk7DQo+ICsJbGFuZV9tYXNrID0gaW50
ZWxfZGVfcmVhZChpOTE1LCBQT1JUX1RYX0RGTEVYRFBTUCh0Yy0+cGh5X2ZpYSkpOw0KPiANCj4g
IAlkcm1fV0FSTl9PTigmaTkxNS0+ZHJtLCBsYW5lX21hc2sgPT0gMHhmZmZmZmZmZik7DQo+IC0J
YXNzZXJ0X3RjX2NvbGRfYmxvY2tlZChkaWdfcG9ydCk7DQo+ICsJYXNzZXJ0X3RjX2NvbGRfYmxv
Y2tlZCh0Yyk7DQo+IA0KPiAtCWxhbmVfbWFzayAmPSBEUF9MQU5FX0FTU0lHTk1FTlRfTUFTSyhk
aWdfcG9ydC0NCj4gPnRjX3BoeV9maWFfaWR4KTsNCj4gLQlyZXR1cm4gbGFuZV9tYXNrID4+IERQ
X0xBTkVfQVNTSUdOTUVOVF9TSElGVChkaWdfcG9ydC0NCj4gPnRjX3BoeV9maWFfaWR4KTsNCj4g
KwlsYW5lX21hc2sgJj0gRFBfTEFORV9BU1NJR05NRU5UX01BU0sodGMtPnBoeV9maWFfaWR4KTsN
Cj4gKwlyZXR1cm4gbGFuZV9tYXNrID4+IERQX0xBTkVfQVNTSUdOTUVOVF9TSElGVCh0Yy0+cGh5
X2ZpYV9pZHgpOw0KPiAgfQ0KPiANCj4gIHUzMiBpbnRlbF90Y19wb3J0X2dldF9waW5fYXNzaWdu
bWVudF9tYXNrKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQNCj4gKmRpZ19wb3J0KSAgew0KPiAg
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkaWdfcG9ydC0+YmFzZS5i
YXNlLmRldik7DQo+ICsJc3RydWN0IGludGVsX3RjX3BvcnQgKnRjID0gdG9fdGNfcG9ydChkaWdf
cG9ydCk7DQo+ICAJdTMyIHBpbl9tYXNrOw0KPiANCj4gLQlwaW5fbWFzayA9IGludGVsX2RlX3Jl
YWQoaTkxNSwgUE9SVF9UWF9ERkxFWFBBMShkaWdfcG9ydC0NCj4gPnRjX3BoeV9maWEpKTsNCj4g
KwlwaW5fbWFzayA9IGludGVsX2RlX3JlYWQoaTkxNSwgUE9SVF9UWF9ERkxFWFBBMSh0Yy0+cGh5
X2ZpYSkpOw0KPiANCj4gIAlkcm1fV0FSTl9PTigmaTkxNS0+ZHJtLCBwaW5fbWFzayA9PSAweGZm
ZmZmZmZmKTsNCj4gLQlhc3NlcnRfdGNfY29sZF9ibG9ja2VkKGRpZ19wb3J0KTsNCj4gKwlhc3Nl
cnRfdGNfY29sZF9ibG9ja2VkKHRjKTsNCj4gDQo+IC0JcmV0dXJuIChwaW5fbWFzayAmIERQX1BJ
Tl9BU1NJR05NRU5UX01BU0soZGlnX3BvcnQtDQo+ID50Y19waHlfZmlhX2lkeCkpID4+DQo+IC0J
ICAgICAgIERQX1BJTl9BU1NJR05NRU5UX1NISUZUKGRpZ19wb3J0LT50Y19waHlfZmlhX2lkeCk7
DQo+ICsJcmV0dXJuIChwaW5fbWFzayAmIERQX1BJTl9BU1NJR05NRU5UX01BU0sodGMtPnBoeV9m
aWFfaWR4KSkgPj4NCj4gKwkgICAgICAgRFBfUElOX0FTU0lHTk1FTlRfU0hJRlQodGMtPnBoeV9m
aWFfaWR4KTsNCj4gIH0NCj4gDQo+ICBpbnQgaW50ZWxfdGNfcG9ydF9maWFfbWF4X2xhbmVfY291
bnQoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQpICB7DQo+ICAJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsN
Cj4gKwlzdHJ1Y3QgaW50ZWxfdGNfcG9ydCAqdGMgPSB0b190Y19wb3J0KGRpZ19wb3J0KTsNCj4g
IAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsNCj4gIAl1MzIgbGFuZV9tYXNrOw0KPiANCj4gLQlp
ZiAoZGlnX3BvcnQtPnRjX21vZGUgIT0gVENfUE9SVF9EUF9BTFQpDQo+ICsJaWYgKHRjLT5tb2Rl
ICE9IFRDX1BPUlRfRFBfQUxUKQ0KPiAgCQlyZXR1cm4gNDsNCj4gDQo+IC0JYXNzZXJ0X3RjX2Nv
bGRfYmxvY2tlZChkaWdfcG9ydCk7DQo+ICsJYXNzZXJ0X3RjX2NvbGRfYmxvY2tlZCh0Yyk7DQo+
IA0KPiAgCWxhbmVfbWFzayA9IDA7DQo+ICAJd2l0aF9pbnRlbF9kaXNwbGF5X3Bvd2VyKGk5MTUs
IFBPV0VSX0RPTUFJTl9ESVNQTEFZX0NPUkUsDQo+IHdha2VyZWYpIEBAIC0yMDUsNDUgKzIyMSw0
NiBAQCB2b2lkDQo+IGludGVsX3RjX3BvcnRfc2V0X2ZpYV9sYW5lX2NvdW50KHN0cnVjdCBpbnRl
bF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0LA0KPiAgCQkJCSAgICAgIGludCByZXF1aXJlZF9sYW5l
cykNCj4gIHsNCj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGln
X3BvcnQtPmJhc2UuYmFzZS5kZXYpOw0KPiArCXN0cnVjdCBpbnRlbF90Y19wb3J0ICp0YyA9IHRv
X3RjX3BvcnQoZGlnX3BvcnQpOw0KPiAgCWJvb2wgbGFuZV9yZXZlcnNhbCA9IGRpZ19wb3J0LT5z
YXZlZF9wb3J0X2JpdHMgJg0KPiBERElfQlVGX1BPUlRfUkVWRVJTQUw7DQo+ICAJdTMyIHZhbDsN
Cj4gDQo+ICAJZHJtX1dBUk5fT04oJmk5MTUtPmRybSwNCj4gLQkJICAgIGxhbmVfcmV2ZXJzYWwg
JiYgZGlnX3BvcnQtPnRjX21vZGUgIT0gVENfUE9SVF9MRUdBQ1kpOw0KPiArCQkgICAgbGFuZV9y
ZXZlcnNhbCAmJiB0Yy0+bW9kZSAhPSBUQ19QT1JUX0xFR0FDWSk7DQo+IA0KPiAtCWFzc2VydF90
Y19jb2xkX2Jsb2NrZWQoZGlnX3BvcnQpOw0KPiArCWFzc2VydF90Y19jb2xkX2Jsb2NrZWQodGMp
Ow0KPiANCj4gLQl2YWwgPSBpbnRlbF9kZV9yZWFkKGk5MTUsIFBPUlRfVFhfREZMRVhEUE1MRTEo
ZGlnX3BvcnQtDQo+ID50Y19waHlfZmlhKSk7DQo+IC0JdmFsICY9IH5ERkxFWERQTUxFMV9EUE1M
RVRDX01BU0soZGlnX3BvcnQtPnRjX3BoeV9maWFfaWR4KTsNCj4gKwl2YWwgPSBpbnRlbF9kZV9y
ZWFkKGk5MTUsIFBPUlRfVFhfREZMRVhEUE1MRTEodGMtPnBoeV9maWEpKTsNCj4gKwl2YWwgJj0g
fkRGTEVYRFBNTEUxX0RQTUxFVENfTUFTSyh0Yy0+cGh5X2ZpYV9pZHgpOw0KPiANCj4gIAlzd2l0
Y2ggKHJlcXVpcmVkX2xhbmVzKSB7DQo+ICAJY2FzZSAxOg0KPiAgCQl2YWwgfD0gbGFuZV9yZXZl
cnNhbCA/DQo+IC0JCQlERkxFWERQTUxFMV9EUE1MRVRDX01MMyhkaWdfcG9ydC0NCj4gPnRjX3Bo
eV9maWFfaWR4KSA6DQo+IC0JCQlERkxFWERQTUxFMV9EUE1MRVRDX01MMChkaWdfcG9ydC0NCj4g
PnRjX3BoeV9maWFfaWR4KTsNCj4gKwkJCURGTEVYRFBNTEUxX0RQTUxFVENfTUwzKHRjLT5waHlf
ZmlhX2lkeCkgOg0KPiArCQkJREZMRVhEUE1MRTFfRFBNTEVUQ19NTDAodGMtPnBoeV9maWFfaWR4
KTsNCj4gIAkJYnJlYWs7DQo+ICAJY2FzZSAyOg0KPiAgCQl2YWwgfD0gbGFuZV9yZXZlcnNhbCA/
DQo+IC0JCQlERkxFWERQTUxFMV9EUE1MRVRDX01MM18yKGRpZ19wb3J0LQ0KPiA+dGNfcGh5X2Zp
YV9pZHgpIDoNCj4gLQkJCURGTEVYRFBNTEUxX0RQTUxFVENfTUwxXzAoZGlnX3BvcnQtDQo+ID50
Y19waHlfZmlhX2lkeCk7DQo+ICsJCQlERkxFWERQTUxFMV9EUE1MRVRDX01MM18yKHRjLT5waHlf
ZmlhX2lkeCkgOg0KPiArCQkJREZMRVhEUE1MRTFfRFBNTEVUQ19NTDFfMCh0Yy0+cGh5X2ZpYV9p
ZHgpOw0KPiAgCQlicmVhazsNCj4gIAljYXNlIDQ6DQo+IC0JCXZhbCB8PSBERkxFWERQTUxFMV9E
UE1MRVRDX01MM18wKGRpZ19wb3J0LQ0KPiA+dGNfcGh5X2ZpYV9pZHgpOw0KPiArCQl2YWwgfD0g
REZMRVhEUE1MRTFfRFBNTEVUQ19NTDNfMCh0Yy0+cGh5X2ZpYV9pZHgpOw0KPiAgCQlicmVhazsN
Cj4gIAlkZWZhdWx0Og0KPiAgCQlNSVNTSU5HX0NBU0UocmVxdWlyZWRfbGFuZXMpOw0KPiAgCX0N
Cj4gDQo+IC0JaW50ZWxfZGVfd3JpdGUoaTkxNSwgUE9SVF9UWF9ERkxFWERQTUxFMShkaWdfcG9y
dC0+dGNfcGh5X2ZpYSksDQo+IHZhbCk7DQo+ICsJaW50ZWxfZGVfd3JpdGUoaTkxNSwgUE9SVF9U
WF9ERkxFWERQTUxFMSh0Yy0+cGh5X2ZpYSksIHZhbCk7DQo+ICB9DQo+IA0KPiAtc3RhdGljIHZv
aWQgdGNfcG9ydF9maXh1cF9sZWdhY3lfZmxhZyhzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpk
aWdfcG9ydCwNCj4gK3N0YXRpYyB2b2lkIHRjX3BvcnRfZml4dXBfbGVnYWN5X2ZsYWcoc3RydWN0
IGludGVsX3RjX3BvcnQgKnRjLA0KPiAgCQkJCSAgICAgIHUzMiBsaXZlX3N0YXR1c19tYXNrKQ0K
PiAgew0KPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkaWdfcG9y
dC0+YmFzZS5iYXNlLmRldik7DQo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
Y190b19pOTE1KHRjKTsNCj4gIAl1MzIgdmFsaWRfaHBkX21hc2s7DQo+IA0KPiAtCWlmIChkaWdf
cG9ydC0+dGNfbGVnYWN5X3BvcnQpDQo+ICsJaWYgKHRjLT5sZWdhY3lfcG9ydCkNCj4gIAkJdmFs
aWRfaHBkX21hc2sgPSBCSVQoVENfUE9SVF9MRUdBQ1kpOw0KPiAgCWVsc2UNCj4gIAkJdmFsaWRf
aHBkX21hc2sgPSBCSVQoVENfUE9SVF9EUF9BTFQpIHwgQEAgLTI1NSwzNA0KPiArMjcyLDM1IEBA
IHN0YXRpYyB2b2lkIHRjX3BvcnRfZml4dXBfbGVnYWN5X2ZsYWcoc3RydWN0IGludGVsX2RpZ2l0
YWxfcG9ydA0KPiAqZGlnX3BvcnQsDQo+ICAJLyogSWYgbGl2ZSBzdGF0dXMgbWlzbWF0Y2hlcyB0
aGUgVkJUIGZsYWcsIHRydXN0IHRoZSBsaXZlIHN0YXR1cy4gKi8NCj4gIAlkcm1fZGJnX2ttcygm
aTkxNS0+ZHJtLA0KPiAgCQkgICAgIlBvcnQgJXM6IGxpdmUgc3RhdHVzICUwOHggbWlzbWF0Y2hl
cyB0aGUgbGVnYWN5IHBvcnQgZmxhZw0KPiAlMDh4LCBmaXhpbmcgZmxhZ1xuIiwNCj4gLQkJICAg
IGRpZ19wb3J0LT50Y19wb3J0X25hbWUsIGxpdmVfc3RhdHVzX21hc2ssIHZhbGlkX2hwZF9tYXNr
KTsNCj4gKwkJICAgIHRjLT5wb3J0X25hbWUsIGxpdmVfc3RhdHVzX21hc2ssIHZhbGlkX2hwZF9t
YXNrKTsNCj4gDQo+IC0JZGlnX3BvcnQtPnRjX2xlZ2FjeV9wb3J0ID0gIWRpZ19wb3J0LT50Y19s
ZWdhY3lfcG9ydDsNCj4gKwl0Yy0+bGVnYWN5X3BvcnQgPSAhdGMtPmxlZ2FjeV9wb3J0Ow0KPiAg
fQ0KPiANCj4gIC8qKg0KPiAgICogSUNMIFRDIFBIWSBoYW5kbGVycw0KPiAgICogLS0tLS0tLS0t
LS0tLS0tLS0tLQ0KPiAgICovDQo+IC1zdGF0aWMgdTMyIGljbF90Y19waHlfaHBkX2xpdmVfc3Rh
dHVzKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KQ0KPiArc3RhdGljIHUzMiBp
Y2xfdGNfcGh5X2hwZF9saXZlX3N0YXR1cyhzdHJ1Y3QgaW50ZWxfdGNfcG9ydCAqdGMpDQo+ICB7
DQo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRpZ19wb3J0LT5i
YXNlLmJhc2UuZGV2KTsNCj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRjX3Rv
X2k5MTUodGMpOw0KPiArCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0ID0gdGMt
PmRpZ19wb3J0Ow0KPiAgCXUzMiBpc3JfYml0ID0gaTkxNS0+ZGlzcGxheS5ob3RwbHVnLnBjaF9o
cGRbZGlnX3BvcnQtPmJhc2UuaHBkX3Bpbl07DQo+ICAJdTMyIG1hc2sgPSAwOw0KPiAgCXUzMiB2
YWw7DQo+IA0KPiAtCXZhbCA9IGludGVsX2RlX3JlYWQoaTkxNSwgUE9SVF9UWF9ERkxFWERQU1Ao
ZGlnX3BvcnQtPnRjX3BoeV9maWEpKTsNCj4gKwl2YWwgPSBpbnRlbF9kZV9yZWFkKGk5MTUsIFBP
UlRfVFhfREZMRVhEUFNQKHRjLT5waHlfZmlhKSk7DQo+IA0KPiAgCWlmICh2YWwgPT0gMHhmZmZm
ZmZmZikgew0KPiAgCQlkcm1fZGJnX2ttcygmaTkxNS0+ZHJtLA0KPiAgCQkJICAgICJQb3J0ICVz
OiBQSFkgaW4gVENDT0xELCBub3RoaW5nIGNvbm5lY3RlZFxuIiwNCj4gLQkJCSAgICBkaWdfcG9y
dC0+dGNfcG9ydF9uYW1lKTsNCj4gKwkJCSAgICB0Yy0+cG9ydF9uYW1lKTsNCj4gIAkJcmV0dXJu
IG1hc2s7DQo+ICAJfQ0KPiANCj4gLQlpZiAodmFsICYgVENfTElWRV9TVEFURV9UQlQoZGlnX3Bv
cnQtPnRjX3BoeV9maWFfaWR4KSkNCj4gKwlpZiAodmFsICYgVENfTElWRV9TVEFURV9UQlQodGMt
PnBoeV9maWFfaWR4KSkNCj4gIAkJbWFzayB8PSBCSVQoVENfUE9SVF9UQlRfQUxUKTsNCj4gLQlp
ZiAodmFsICYgVENfTElWRV9TVEFURV9UQyhkaWdfcG9ydC0+dGNfcGh5X2ZpYV9pZHgpKQ0KPiAr
CWlmICh2YWwgJiBUQ19MSVZFX1NUQVRFX1RDKHRjLT5waHlfZmlhX2lkeCkpDQo+ICAJCW1hc2sg
fD0gQklUKFRDX1BPUlRfRFBfQUxUKTsNCj4gDQo+ICAJaWYgKGludGVsX2RlX3JlYWQoaTkxNSwg
U0RFSVNSKSAmIGlzcl9iaXQpIEBAIC0yOTAsNyArMzA4LDcgQEAgc3RhdGljDQo+IHUzMiBpY2xf
dGNfcGh5X2hwZF9saXZlX3N0YXR1cyhzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9y
dCkNCj4gDQo+ICAJLyogVGhlIHNpbmsgY2FuIGJlIGNvbm5lY3RlZCBvbmx5IGluIGEgc2luZ2xl
IG1vZGUuICovDQo+ICAJaWYgKCFkcm1fV0FSTl9PTl9PTkNFKCZpOTE1LT5kcm0sIGh3ZWlnaHQz
MihtYXNrKSA+IDEpKQ0KPiAtCQl0Y19wb3J0X2ZpeHVwX2xlZ2FjeV9mbGFnKGRpZ19wb3J0LCBt
YXNrKTsNCj4gKwkJdGNfcG9ydF9maXh1cF9sZWdhY3lfZmxhZyh0YywgbWFzayk7DQo+IA0KPiAg
CXJldHVybiBtYXNrOw0KPiAgfQ0KPiBAQCAtMzAzLDYwICszMjEsNjAgQEAgc3RhdGljIHUzMiBp
Y2xfdGNfcGh5X2hwZF9saXZlX3N0YXR1cyhzdHJ1Y3QNCj4gaW50ZWxfZGlnaXRhbF9wb3J0ICpk
aWdfcG9ydCkNCj4gICAqIG93bmVkIGJ5IHRoZSBUQlQgc3Vic3lzdGVtIGFuZCBzbyBzd2l0Y2hp
bmcgdGhlIG93bmVyc2hpcCB0byBkaXNwbGF5IGlzIG5vdA0KPiAgICogcmVxdWlyZWQuDQo+ICAg
Ki8NCj4gLXN0YXRpYyBib29sIGljbF90Y19waHlfaXNfcmVhZHkoc3RydWN0IGludGVsX2RpZ2l0
YWxfcG9ydCAqZGlnX3BvcnQpDQo+ICtzdGF0aWMgYm9vbCBpY2xfdGNfcGh5X2lzX3JlYWR5KHN0
cnVjdCBpbnRlbF90Y19wb3J0ICp0YykNCj4gIHsNCj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOw0KPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdGNfdG9faTkxNSh0Yyk7DQo+ICAJdTMyIHZhbDsNCj4g
DQo+IC0JdmFsID0gaW50ZWxfZGVfcmVhZChpOTE1LCBQT1JUX1RYX0RGTEVYRFBQTVMoZGlnX3Bv
cnQtDQo+ID50Y19waHlfZmlhKSk7DQo+ICsJdmFsID0gaW50ZWxfZGVfcmVhZChpOTE1LCBQT1JU
X1RYX0RGTEVYRFBQTVModGMtPnBoeV9maWEpKTsNCj4gIAlpZiAodmFsID09IDB4ZmZmZmZmZmYp
IHsNCj4gIAkJZHJtX2RiZ19rbXMoJmk5MTUtPmRybSwNCj4gIAkJCSAgICAiUG9ydCAlczogUEhZ
IGluIFRDQ09MRCwgYXNzdW1pbmcgbm90IHJlYWR5XG4iLA0KPiAtCQkJICAgIGRpZ19wb3J0LT50
Y19wb3J0X25hbWUpOw0KPiArCQkJICAgIHRjLT5wb3J0X25hbWUpOw0KPiAgCQlyZXR1cm4gZmFs
c2U7DQo+ICAJfQ0KPiANCj4gLQlyZXR1cm4gdmFsICYgRFBfUEhZX01PREVfU1RBVFVTX0NPTVBM
RVRFRChkaWdfcG9ydC0NCj4gPnRjX3BoeV9maWFfaWR4KTsNCj4gKwlyZXR1cm4gdmFsICYgRFBf
UEhZX01PREVfU1RBVFVTX0NPTVBMRVRFRCh0Yy0+cGh5X2ZpYV9pZHgpOw0KPiAgfQ0KPiANCj4g
LXN0YXRpYyBib29sIGljbF90Y19waHlfdGFrZV9vd25lcnNoaXAoc3RydWN0IGludGVsX2RpZ2l0
YWxfcG9ydCAqZGlnX3BvcnQsDQo+ICtzdGF0aWMgYm9vbCBpY2xfdGNfcGh5X3Rha2Vfb3duZXJz
aGlwKHN0cnVjdCBpbnRlbF90Y19wb3J0ICp0YywNCj4gIAkJCQkgICAgICBib29sIHRha2UpDQo+
ICB7DQo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRpZ19wb3J0
LT5iYXNlLmJhc2UuZGV2KTsNCj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRj
X3RvX2k5MTUodGMpOw0KPiAgCXUzMiB2YWw7DQo+IA0KPiAtCXZhbCA9IGludGVsX2RlX3JlYWQo
aTkxNSwgUE9SVF9UWF9ERkxFWERQQ1NTUyhkaWdfcG9ydC0NCj4gPnRjX3BoeV9maWEpKTsNCj4g
Kwl2YWwgPSBpbnRlbF9kZV9yZWFkKGk5MTUsIFBPUlRfVFhfREZMRVhEUENTU1ModGMtPnBoeV9m
aWEpKTsNCj4gIAlpZiAodmFsID09IDB4ZmZmZmZmZmYpIHsNCj4gIAkJZHJtX2RiZ19rbXMoJmk5
MTUtPmRybSwNCj4gIAkJCSAgICAiUG9ydCAlczogUEhZIGluIFRDQ09MRCwgY2FuJ3QgJXMgb3du
ZXJzaGlwXG4iLA0KPiAtCQkJICAgIGRpZ19wb3J0LT50Y19wb3J0X25hbWUsIHRha2UgPyAidGFr
ZSIgOiAicmVsZWFzZSIpOw0KPiArCQkJICAgIHRjLT5wb3J0X25hbWUsIHRha2UgPyAidGFrZSIg
OiAicmVsZWFzZSIpOw0KPiANCj4gIAkJcmV0dXJuIGZhbHNlOw0KPiAgCX0NCj4gDQo+IC0JdmFs
ICY9IH5EUF9QSFlfTU9ERV9TVEFUVVNfTk9UX1NBRkUoZGlnX3BvcnQtPnRjX3BoeV9maWFfaWR4
KTsNCj4gKwl2YWwgJj0gfkRQX1BIWV9NT0RFX1NUQVRVU19OT1RfU0FGRSh0Yy0+cGh5X2ZpYV9p
ZHgpOw0KPiAgCWlmICh0YWtlKQ0KPiAtCQl2YWwgfD0gRFBfUEhZX01PREVfU1RBVFVTX05PVF9T
QUZFKGRpZ19wb3J0LQ0KPiA+dGNfcGh5X2ZpYV9pZHgpOw0KPiArCQl2YWwgfD0gRFBfUEhZX01P
REVfU1RBVFVTX05PVF9TQUZFKHRjLT5waHlfZmlhX2lkeCk7DQo+IA0KPiAtCWludGVsX2RlX3dy
aXRlKGk5MTUsIFBPUlRfVFhfREZMRVhEUENTU1MoZGlnX3BvcnQtPnRjX3BoeV9maWEpLA0KPiB2
YWwpOw0KPiArCWludGVsX2RlX3dyaXRlKGk5MTUsIFBPUlRfVFhfREZMRVhEUENTU1ModGMtPnBo
eV9maWEpLCB2YWwpOw0KPiANCj4gIAlyZXR1cm4gdHJ1ZTsNCj4gIH0NCj4gDQo+IC1zdGF0aWMg
Ym9vbCBpY2xfdGNfcGh5X2lzX293bmVkKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19w
b3J0KQ0KPiArc3RhdGljIGJvb2wgaWNsX3RjX3BoeV9pc19vd25lZChzdHJ1Y3QgaW50ZWxfdGNf
cG9ydCAqdGMpDQo+ICB7DQo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsNCj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRjX3RvX2k5MTUodGMpOw0KPiAgCXUzMiB2YWw7DQo+IA0KPiAtCXZhbCA9IGlu
dGVsX2RlX3JlYWQoaTkxNSwgUE9SVF9UWF9ERkxFWERQQ1NTUyhkaWdfcG9ydC0NCj4gPnRjX3Bo
eV9maWEpKTsNCj4gKwl2YWwgPSBpbnRlbF9kZV9yZWFkKGk5MTUsIFBPUlRfVFhfREZMRVhEUENT
U1ModGMtPnBoeV9maWEpKTsNCj4gIAlpZiAodmFsID09IDB4ZmZmZmZmZmYpIHsNCj4gIAkJZHJt
X2RiZ19rbXMoJmk5MTUtPmRybSwNCj4gIAkJCSAgICAiUG9ydCAlczogUEhZIGluIFRDQ09MRCwg
YXNzdW1lIG5vdCBvd25lZFxuIiwNCj4gLQkJCSAgICBkaWdfcG9ydC0+dGNfcG9ydF9uYW1lKTsN
Cj4gKwkJCSAgICB0Yy0+cG9ydF9uYW1lKTsNCj4gIAkJcmV0dXJuIGZhbHNlOw0KPiAgCX0NCj4g
DQo+IC0JcmV0dXJuIHZhbCAmIERQX1BIWV9NT0RFX1NUQVRVU19OT1RfU0FGRShkaWdfcG9ydC0N
Cj4gPnRjX3BoeV9maWFfaWR4KTsNCj4gKwlyZXR1cm4gdmFsICYgRFBfUEhZX01PREVfU1RBVFVT
X05PVF9TQUZFKHRjLT5waHlfZmlhX2lkeCk7DQo+ICB9DQo+IA0KPiAgLyoNCj4gQEAgLTM3MCwz
NiArMzg4LDM3IEBAIHN0YXRpYyBib29sIGljbF90Y19waHlfaXNfb3duZWQoc3RydWN0DQo+IGlu
dGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQpDQo+ICAgKiBjb25uZWN0IGFuZCBkaXNjb25uZWN0
IHRvIGNsZWFubHkgdHJhbnNmZXIgb3duZXJzaGlwIHdpdGggdGhlIGNvbnRyb2xsZXIgYW5kDQo+
ICAgKiBzZXQgdGhlIHR5cGUtQyBwb3dlciBzdGF0ZS4NCj4gICAqLw0KPiAtc3RhdGljIHZvaWQg
aWNsX3RjX3BoeV9jb25uZWN0KHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0LA0K
PiArc3RhdGljIHZvaWQgaWNsX3RjX3BoeV9jb25uZWN0KHN0cnVjdCBpbnRlbF90Y19wb3J0ICp0
YywNCj4gIAkJCSAgICAgICBpbnQgcmVxdWlyZWRfbGFuZXMpDQo+ICB7DQo+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsN
Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRjX3RvX2k5MTUodGMpOw0KPiAr
CXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0ID0gdGMtPmRpZ19wb3J0Ow0KPiAg
CXUzMiBsaXZlX3N0YXR1c19tYXNrOw0KPiAgCWludCBtYXhfbGFuZXM7DQo+IA0KPiAtCWlmICgh
dGNfcGh5X2lzX3JlYWR5KGRpZ19wb3J0KSAmJg0KPiAtCSAgICAhZHJtX1dBUk5fT04oJmk5MTUt
PmRybSwgZGlnX3BvcnQtPnRjX2xlZ2FjeV9wb3J0KSkgew0KPiArCWlmICghdGNfcGh5X2lzX3Jl
YWR5KHRjKSAmJg0KPiArCSAgICAhZHJtX1dBUk5fT04oJmk5MTUtPmRybSwgdGMtPmxlZ2FjeV9w
b3J0KSkgew0KPiAgCQlkcm1fZGJnX2ttcygmaTkxNS0+ZHJtLCAiUG9ydCAlczogUEhZIG5vdCBy
ZWFkeVxuIiwNCj4gLQkJCSAgICBkaWdfcG9ydC0+dGNfcG9ydF9uYW1lKTsNCj4gKwkJCSAgICB0
Yy0+cG9ydF9uYW1lKTsNCj4gIAkJZ290byBvdXRfc2V0X3RidF9hbHRfbW9kZTsNCj4gIAl9DQo+
IA0KPiAtCWxpdmVfc3RhdHVzX21hc2sgPSB0Y19waHlfaHBkX2xpdmVfc3RhdHVzKGRpZ19wb3J0
KTsNCj4gKwlsaXZlX3N0YXR1c19tYXNrID0gdGNfcGh5X2hwZF9saXZlX3N0YXR1cyh0Yyk7DQo+
ICAJaWYgKCEobGl2ZV9zdGF0dXNfbWFzayAmIChCSVQoVENfUE9SVF9EUF9BTFQpIHwNCj4gQklU
KFRDX1BPUlRfTEVHQUNZKSkpICYmDQo+IC0JICAgICFkaWdfcG9ydC0+dGNfbGVnYWN5X3BvcnQp
IHsNCj4gKwkgICAgIXRjLT5sZWdhY3lfcG9ydCkgew0KPiAgCQlkcm1fZGJnX2ttcygmaTkxNS0+
ZHJtLCAiUG9ydCAlczogUEhZIG93bmVyc2hpcCBub3QNCj4gcmVxdWlyZWQgKGxpdmUgc3RhdHVz
ICUwMngpXG4iLA0KPiAtCQkJICAgIGRpZ19wb3J0LT50Y19wb3J0X25hbWUsIGxpdmVfc3RhdHVz
X21hc2spOw0KPiArCQkJICAgIHRjLT5wb3J0X25hbWUsIGxpdmVfc3RhdHVzX21hc2spOw0KPiAg
CQlnb3RvIG91dF9zZXRfdGJ0X2FsdF9tb2RlOw0KPiAgCX0NCj4gDQo+IC0JaWYgKCF0Y19waHlf
dGFrZV9vd25lcnNoaXAoZGlnX3BvcnQsIHRydWUpICYmDQo+IC0JICAgICFkcm1fV0FSTl9PTigm
aTkxNS0+ZHJtLCBkaWdfcG9ydC0+dGNfbGVnYWN5X3BvcnQpKQ0KPiArCWlmICghdGNfcGh5X3Rh
a2Vfb3duZXJzaGlwKHRjLCB0cnVlKSAmJg0KPiArCSAgICAhZHJtX1dBUk5fT04oJmk5MTUtPmRy
bSwgdGMtPmxlZ2FjeV9wb3J0KSkNCj4gIAkJZ290byBvdXRfc2V0X3RidF9hbHRfbW9kZTsNCj4g
DQo+ICAJbWF4X2xhbmVzID0gaW50ZWxfdGNfcG9ydF9maWFfbWF4X2xhbmVfY291bnQoZGlnX3Bv
cnQpOw0KPiAtCWlmIChkaWdfcG9ydC0+dGNfbGVnYWN5X3BvcnQpIHsNCj4gKwlpZiAodGMtPmxl
Z2FjeV9wb3J0KSB7DQo+ICAJCWRybV9XQVJOX09OKCZpOTE1LT5kcm0sIG1heF9sYW5lcyAhPSA0
KTsNCj4gLQkJZGlnX3BvcnQtPnRjX21vZGUgPSBUQ19QT1JUX0xFR0FDWTsNCj4gKwkJdGMtPm1v
ZGUgPSBUQ19QT1JUX0xFR0FDWTsNCj4gDQo+ICAJCXJldHVybjsNCj4gIAl9DQo+IEBAIC00MDgs
NDggKzQyNyw0OCBAQCBzdGF0aWMgdm9pZCBpY2xfdGNfcGh5X2Nvbm5lY3Qoc3RydWN0DQo+IGlu
dGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQsDQo+ICAJICogTm93IHdlIGhhdmUgdG8gcmUtY2hl
Y2sgdGhlIGxpdmUgc3RhdGUsIGluIGNhc2UgdGhlIHBvcnQgcmVjZW50bHkNCj4gIAkgKiBiZWNh
bWUgZGlzY29ubmVjdGVkLiBOb3QgbmVjZXNzYXJ5IGZvciBsZWdhY3kgbW9kZS4NCj4gIAkgKi8N
Cj4gLQlpZiAoISh0Y19waHlfaHBkX2xpdmVfc3RhdHVzKGRpZ19wb3J0KSAmIEJJVChUQ19QT1JU
X0RQX0FMVCkpKSB7DQo+ICsJaWYgKCEodGNfcGh5X2hwZF9saXZlX3N0YXR1cyh0YykgJiBCSVQo
VENfUE9SVF9EUF9BTFQpKSkgew0KPiAgCQlkcm1fZGJnX2ttcygmaTkxNS0+ZHJtLCAiUG9ydCAl
czogUEhZIHN1ZGRlbg0KPiBkaXNjb25uZWN0XG4iLA0KPiAtCQkJICAgIGRpZ19wb3J0LT50Y19w
b3J0X25hbWUpOw0KPiArCQkJICAgIHRjLT5wb3J0X25hbWUpOw0KPiAgCQlnb3RvIG91dF9yZWxl
YXNlX3BoeTsNCj4gIAl9DQo+IA0KPiAgCWlmIChtYXhfbGFuZXMgPCByZXF1aXJlZF9sYW5lcykg
ew0KPiAgCQlkcm1fZGJnX2ttcygmaTkxNS0+ZHJtLA0KPiAgCQkJICAgICJQb3J0ICVzOiBQSFkg
bWF4IGxhbmVzICVkIDwgcmVxdWlyZWQgbGFuZXMgJWRcbiIsDQo+IC0JCQkgICAgZGlnX3BvcnQt
PnRjX3BvcnRfbmFtZSwNCj4gKwkJCSAgICB0Yy0+cG9ydF9uYW1lLA0KPiAgCQkJICAgIG1heF9s
YW5lcywgcmVxdWlyZWRfbGFuZXMpOw0KPiAgCQlnb3RvIG91dF9yZWxlYXNlX3BoeTsNCj4gIAl9
DQo+IA0KPiAtCWRpZ19wb3J0LT50Y19tb2RlID0gVENfUE9SVF9EUF9BTFQ7DQo+ICsJdGMtPm1v
ZGUgPSBUQ19QT1JUX0RQX0FMVDsNCj4gDQo+ICAJcmV0dXJuOw0KPiANCj4gIG91dF9yZWxlYXNl
X3BoeToNCj4gLQl0Y19waHlfdGFrZV9vd25lcnNoaXAoZGlnX3BvcnQsIGZhbHNlKTsNCj4gKwl0
Y19waHlfdGFrZV9vd25lcnNoaXAodGMsIGZhbHNlKTsNCj4gIG91dF9zZXRfdGJ0X2FsdF9tb2Rl
Og0KPiAtCWRpZ19wb3J0LT50Y19tb2RlID0gVENfUE9SVF9UQlRfQUxUOw0KPiArCXRjLT5tb2Rl
ID0gVENfUE9SVF9UQlRfQUxUOw0KPiAgfQ0KPiANCj4gIC8qDQo+ICAgKiBTZWUgdGhlIGNvbW1l
bnQgYXQgdGhlIGNvbm5lY3QgZnVuY3Rpb24uIFRoaXMgaW1wbGVtZW50cyB0aGUgRGlzY29ubmVj
dA0KPiAgICogRmxvdy4NCj4gICAqLw0KPiAtc3RhdGljIHZvaWQgaWNsX3RjX3BoeV9kaXNjb25u
ZWN0KHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KQ0KPiArc3RhdGljIHZvaWQg
aWNsX3RjX3BoeV9kaXNjb25uZWN0KHN0cnVjdCBpbnRlbF90Y19wb3J0ICp0YykNCj4gIHsNCj4g
LQlzd2l0Y2ggKGRpZ19wb3J0LT50Y19tb2RlKSB7DQo+ICsJc3dpdGNoICh0Yy0+bW9kZSkgew0K
PiAgCWNhc2UgVENfUE9SVF9MRUdBQ1k6DQo+ICAJY2FzZSBUQ19QT1JUX0RQX0FMVDoNCj4gLQkJ
dGNfcGh5X3Rha2Vfb3duZXJzaGlwKGRpZ19wb3J0LCBmYWxzZSk7DQo+ICsJCXRjX3BoeV90YWtl
X293bmVyc2hpcCh0YywgZmFsc2UpOw0KPiAgCQlmYWxsdGhyb3VnaDsNCj4gIAljYXNlIFRDX1BP
UlRfVEJUX0FMVDoNCj4gLQkJZGlnX3BvcnQtPnRjX21vZGUgPSBUQ19QT1JUX0RJU0NPTk5FQ1RF
RDsNCj4gKwkJdGMtPm1vZGUgPSBUQ19QT1JUX0RJU0NPTk5FQ1RFRDsNCj4gIAkJZmFsbHRocm91
Z2g7DQo+ICAJY2FzZSBUQ19QT1JUX0RJU0NPTk5FQ1RFRDoNCj4gIAkJYnJlYWs7DQo+ICAJZGVm
YXVsdDoNCj4gLQkJTUlTU0lOR19DQVNFKGRpZ19wb3J0LT50Y19tb2RlKTsNCj4gKwkJTUlTU0lO
R19DQVNFKHRjLT5tb2RlKTsNCj4gIAl9DQo+ICB9DQo+IA0KPiBAQCAtNDU3LDkgKzQ3NiwxMCBA
QCBzdGF0aWMgdm9pZCBpY2xfdGNfcGh5X2Rpc2Nvbm5lY3Qoc3RydWN0DQo+IGludGVsX2RpZ2l0
YWxfcG9ydCAqZGlnX3BvcnQpDQo+ICAgKiBBRExQIFRDIFBIWSBoYW5kbGVycw0KPiAgICogLS0t
LS0tLS0tLS0tLS0tLS0tLS0NCj4gICAqLw0KPiAtc3RhdGljIHUzMiBhZGxwX3RjX3BoeV9ocGRf
bGl2ZV9zdGF0dXMoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQpDQo+ICtzdGF0
aWMgdTMyIGFkbHBfdGNfcGh5X2hwZF9saXZlX3N0YXR1cyhzdHJ1Y3QgaW50ZWxfdGNfcG9ydCAq
dGMpDQo+ICB7DQo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRp
Z19wb3J0LT5iYXNlLmJhc2UuZGV2KTsNCj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRjX3RvX2k5MTUodGMpOw0KPiArCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19w
b3J0ID0gdGMtPmRpZ19wb3J0Ow0KPiAgCWVudW0gdGNfcG9ydCB0Y19wb3J0ID0gaW50ZWxfcG9y
dF90b190YyhpOTE1LCBkaWdfcG9ydC0+YmFzZS5wb3J0KTsNCj4gIAl1MzIgaXNyX2JpdCA9IGk5
MTUtPmRpc3BsYXkuaG90cGx1Zy5wY2hfaHBkW2RpZ19wb3J0LT5iYXNlLmhwZF9waW5dOw0KPiAg
CXUzMiB2YWwsIG1hc2sgPSAwOw0KPiBAQCAtNDgwLDcgKzUwMCw3IEBAIHN0YXRpYyB1MzIgYWRs
cF90Y19waHlfaHBkX2xpdmVfc3RhdHVzKHN0cnVjdA0KPiBpbnRlbF9kaWdpdGFsX3BvcnQgKmRp
Z19wb3J0KQ0KPiANCj4gIAkvKiBUaGUgc2luayBjYW4gYmUgY29ubmVjdGVkIG9ubHkgaW4gYSBz
aW5nbGUgbW9kZS4gKi8NCj4gIAlpZiAoIWRybV9XQVJOX09OKCZpOTE1LT5kcm0sIGh3ZWlnaHQz
MihtYXNrKSA+IDEpKQ0KPiAtCQl0Y19wb3J0X2ZpeHVwX2xlZ2FjeV9mbGFnKGRpZ19wb3J0LCBt
YXNrKTsNCj4gKwkJdGNfcG9ydF9maXh1cF9sZWdhY3lfZmxhZyh0YywgbWFzayk7DQo+IA0KPiAg
CXJldHVybiBtYXNrOw0KPiAgfQ0KPiBAQCAtNDkyLDI4ICs1MTIsMjggQEAgc3RhdGljIHUzMiBh
ZGxwX3RjX3BoeV9ocGRfbGl2ZV9zdGF0dXMoc3RydWN0DQo+IGludGVsX2RpZ2l0YWxfcG9ydCAq
ZGlnX3BvcnQpDQo+ICAgKiBEUC1hbHQsIGxlZ2FjeSBvciBub3RoaW5nKS4gRm9yIFRCVC1hbHQg
c2lua3MgdGhlIFBIWSBpcyBvd25lZCBieSB0aGUgVEJUDQo+ICAgKiBzdWJzeXN0ZW0gYW5kIHNv
IHN3aXRjaGluZyB0aGUgb3duZXJzaGlwIHRvIGRpc3BsYXkgaXMgbm90IHJlcXVpcmVkLg0KPiAg
ICovDQo+IC1zdGF0aWMgYm9vbCBhZGxwX3RjX3BoeV9pc19yZWFkeShzdHJ1Y3QgaW50ZWxfZGln
aXRhbF9wb3J0ICpkaWdfcG9ydCkNCj4gK3N0YXRpYyBib29sIGFkbHBfdGNfcGh5X2lzX3JlYWR5
KHN0cnVjdCBpbnRlbF90Y19wb3J0ICp0YykNCj4gIHsNCj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOw0KPiAtCWVudW0g
dGNfcG9ydCB0Y19wb3J0ID0gaW50ZWxfcG9ydF90b190YyhpOTE1LCBkaWdfcG9ydC0+YmFzZS5w
b3J0KTsNCj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRjX3RvX2k5MTUodGMp
Ow0KPiArCWVudW0gdGNfcG9ydCB0Y19wb3J0ID0gaW50ZWxfcG9ydF90b190YyhpOTE1LA0KPiAr
dGMtPmRpZ19wb3J0LT5iYXNlLnBvcnQpOw0KPiAgCXUzMiB2YWw7DQo+IA0KPiAgCXZhbCA9IGlu
dGVsX2RlX3JlYWQoaTkxNSwgVENTU19ERElfU1RBVFVTKHRjX3BvcnQpKTsNCj4gIAlpZiAodmFs
ID09IDB4ZmZmZmZmZmYpIHsNCj4gIAkJZHJtX2RiZ19rbXMoJmk5MTUtPmRybSwNCj4gIAkJCSAg
ICAiUG9ydCAlczogUEhZIGluIFRDQ09MRCwgYXNzdW1pbmcgbm90IHJlYWR5XG4iLA0KPiAtCQkJ
ICAgIGRpZ19wb3J0LT50Y19wb3J0X25hbWUpOw0KPiArCQkJICAgIHRjLT5wb3J0X25hbWUpOw0K
PiAgCQlyZXR1cm4gZmFsc2U7DQo+ICAJfQ0KPiANCj4gIAlyZXR1cm4gdmFsICYgVENTU19ERElf
U1RBVFVTX1JFQURZOw0KPiAgfQ0KPiANCj4gLXN0YXRpYyBib29sIGFkbHBfdGNfcGh5X3Rha2Vf
b3duZXJzaGlwKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0LA0KPiArc3RhdGlj
IGJvb2wgYWRscF90Y19waHlfdGFrZV9vd25lcnNoaXAoc3RydWN0IGludGVsX3RjX3BvcnQgKnRj
LA0KPiAgCQkJCSAgICAgICBib29sIHRha2UpDQo+ICB7DQo+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsNCj4gLQllbnVt
IHBvcnQgcG9ydCA9IGRpZ19wb3J0LT5iYXNlLnBvcnQ7DQo+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0Y190b19pOTE1KHRjKTsNCj4gKwllbnVtIHBvcnQgcG9ydCA9IHRjLT5k
aWdfcG9ydC0+YmFzZS5wb3J0Ow0KPiANCj4gIAlpbnRlbF9kZV9ybXcoaTkxNSwgRERJX0JVRl9D
VEwocG9ydCksDQo+IERESV9CVUZfQ1RMX1RDX1BIWV9PV05FUlNISVAsDQo+ICAJCSAgICAgdGFr
ZSA/IERESV9CVUZfQ1RMX1RDX1BIWV9PV05FUlNISVAgOiAwKTsgQEAgLTUyMSwxMA0KPiArNTQx
LDEwIEBAIHN0YXRpYyBib29sIGFkbHBfdGNfcGh5X3Rha2Vfb3duZXJzaGlwKHN0cnVjdCBpbnRl
bF9kaWdpdGFsX3BvcnQNCj4gKmRpZ19wb3J0LA0KPiAgCXJldHVybiB0cnVlOw0KPiAgfQ0KPiAN
Cj4gLXN0YXRpYyBib29sIGFkbHBfdGNfcGh5X2lzX293bmVkKHN0cnVjdCBpbnRlbF9kaWdpdGFs
X3BvcnQgKmRpZ19wb3J0KQ0KPiArc3RhdGljIGJvb2wgYWRscF90Y19waHlfaXNfb3duZWQoc3Ry
dWN0IGludGVsX3RjX3BvcnQgKnRjKQ0KPiAgew0KPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShkaWdfcG9ydC0+YmFzZS5iYXNlLmRldik7DQo+IC0JZW51bSBwb3J0
IHBvcnQgPSBkaWdfcG9ydC0+YmFzZS5wb3J0Ow0KPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdGNfdG9faTkxNSh0Yyk7DQo+ICsJZW51bSBwb3J0IHBvcnQgPSB0Yy0+ZGlnX3Bv
cnQtPmJhc2UucG9ydDsNCj4gIAl1MzIgdmFsOw0KPiANCj4gIAl2YWwgPSBpbnRlbF9kZV9yZWFk
KGk5MTUsIERESV9CVUZfQ1RMKHBvcnQpKTsgQEAgLTUzNSw3MyArNTU1LDczDQo+IEBAIHN0YXRp
YyBib29sIGFkbHBfdGNfcGh5X2lzX293bmVkKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRp
Z19wb3J0KQ0KPiAgICogR2VuZXJpYyBUQyBQSFkgaGFuZGxlcnMNCj4gICAqIC0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tDQo+ICAgKi8NCj4gLXN0YXRpYyB1MzIgdGNfcGh5X2hwZF9saXZlX3N0YXR1
cyhzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCkNCj4gK3N0YXRpYyB1MzIgdGNf
cGh5X2hwZF9saXZlX3N0YXR1cyhzdHJ1Y3QgaW50ZWxfdGNfcG9ydCAqdGMpDQo+ICB7DQo+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRpZ19wb3J0LT5iYXNlLmJh
c2UuZGV2KTsNCj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRjX3RvX2k5MTUo
dGMpOw0KPiANCj4gIAlpZiAoSVNfQUxERVJMQUtFX1AoaTkxNSkpDQo+IC0JCXJldHVybiBhZGxw
X3RjX3BoeV9ocGRfbGl2ZV9zdGF0dXMoZGlnX3BvcnQpOw0KPiArCQlyZXR1cm4gYWRscF90Y19w
aHlfaHBkX2xpdmVfc3RhdHVzKHRjKTsNCj4gDQo+IC0JcmV0dXJuIGljbF90Y19waHlfaHBkX2xp
dmVfc3RhdHVzKGRpZ19wb3J0KTsNCj4gKwlyZXR1cm4gaWNsX3RjX3BoeV9ocGRfbGl2ZV9zdGF0
dXModGMpOw0KPiAgfQ0KPiANCj4gLXN0YXRpYyBib29sIHRjX3BoeV9pc19yZWFkeShzdHJ1Y3Qg
aW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCkNCj4gK3N0YXRpYyBib29sIHRjX3BoeV9pc19y
ZWFkeShzdHJ1Y3QgaW50ZWxfdGNfcG9ydCAqdGMpDQo+ICB7DQo+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsNCj4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRjX3RvX2k5MTUodGMpOw0KPiANCj4gIAlp
ZiAoSVNfQUxERVJMQUtFX1AoaTkxNSkpDQo+IC0JCXJldHVybiBhZGxwX3RjX3BoeV9pc19yZWFk
eShkaWdfcG9ydCk7DQo+ICsJCXJldHVybiBhZGxwX3RjX3BoeV9pc19yZWFkeSh0Yyk7DQo+IA0K
PiAtCXJldHVybiBpY2xfdGNfcGh5X2lzX3JlYWR5KGRpZ19wb3J0KTsNCj4gKwlyZXR1cm4gaWNs
X3RjX3BoeV9pc19yZWFkeSh0Yyk7DQo+ICB9DQo+IA0KPiAtc3RhdGljIGJvb2wgdGNfcGh5X2lz
X293bmVkKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KQ0KPiArc3RhdGljIGJv
b2wgdGNfcGh5X2lzX293bmVkKHN0cnVjdCBpbnRlbF90Y19wb3J0ICp0YykNCj4gIHsNCj4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGlnX3BvcnQtPmJhc2UuYmFz
ZS5kZXYpOw0KPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdGNfdG9faTkxNSh0
Yyk7DQo+IA0KPiAgCWlmIChJU19BTERFUkxBS0VfUChpOTE1KSkNCj4gLQkJcmV0dXJuIGFkbHBf
dGNfcGh5X2lzX293bmVkKGRpZ19wb3J0KTsNCj4gKwkJcmV0dXJuIGFkbHBfdGNfcGh5X2lzX293
bmVkKHRjKTsNCj4gDQo+IC0JcmV0dXJuIGljbF90Y19waHlfaXNfb3duZWQoZGlnX3BvcnQpOw0K
PiArCXJldHVybiBpY2xfdGNfcGh5X2lzX293bmVkKHRjKTsNCj4gIH0NCj4gDQo+IC1zdGF0aWMg
Ym9vbCB0Y19waHlfdGFrZV9vd25lcnNoaXAoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGln
X3BvcnQsIGJvb2wNCj4gdGFrZSkNCj4gK3N0YXRpYyBib29sIHRjX3BoeV90YWtlX293bmVyc2hp
cChzdHJ1Y3QgaW50ZWxfdGNfcG9ydCAqdGMsIGJvb2wgdGFrZSkNCj4gIHsNCj4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYp
Ow0KPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdGNfdG9faTkxNSh0Yyk7DQo+
IA0KPiAgCWlmIChJU19BTERFUkxBS0VfUChpOTE1KSkNCj4gLQkJcmV0dXJuIGFkbHBfdGNfcGh5
X3Rha2Vfb3duZXJzaGlwKGRpZ19wb3J0LCB0YWtlKTsNCj4gKwkJcmV0dXJuIGFkbHBfdGNfcGh5
X3Rha2Vfb3duZXJzaGlwKHRjLCB0YWtlKTsNCj4gDQo+IC0JcmV0dXJuIGljbF90Y19waHlfdGFr
ZV9vd25lcnNoaXAoZGlnX3BvcnQsIHRha2UpOw0KPiArCXJldHVybiBpY2xfdGNfcGh5X3Rha2Vf
b3duZXJzaGlwKHRjLCB0YWtlKTsNCj4gIH0NCj4gDQo+IC1zdGF0aWMgYm9vbCB0Y19waHlfaXNf
cmVhZHlfYW5kX293bmVkKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0LA0KPiAr
c3RhdGljIGJvb2wgdGNfcGh5X2lzX3JlYWR5X2FuZF9vd25lZChzdHJ1Y3QgaW50ZWxfdGNfcG9y
dCAqdGMsDQo+ICAJCQkJICAgICAgYm9vbCBwaHlfaXNfcmVhZHksIGJvb2wgcGh5X2lzX293bmVk
KSAgew0KPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkaWdfcG9y
dC0+YmFzZS5iYXNlLmRldik7DQo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
Y190b19pOTE1KHRjKTsNCj4gDQo+ICAJZHJtX1dBUk5fT04oJmk5MTUtPmRybSwgcGh5X2lzX293
bmVkICYmICFwaHlfaXNfcmVhZHkpOw0KPiANCj4gIAlyZXR1cm4gcGh5X2lzX3JlYWR5ICYmIHBo
eV9pc19vd25lZDsNCj4gIH0NCj4gDQo+IC1zdGF0aWMgYm9vbCB0Y19waHlfaXNfY29ubmVjdGVk
KHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0LA0KPiArc3RhdGljIGJvb2wgdGNf
cGh5X2lzX2Nvbm5lY3RlZChzdHJ1Y3QgaW50ZWxfdGNfcG9ydCAqdGMsDQo+ICAJCQkJZW51bSBp
Y2xfcG9ydF9kcGxsX2lkIHBvcnRfcGxsX3R5cGUpICB7DQo+IC0Jc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIgPSAmZGlnX3BvcnQtPmJhc2U7DQo+ICsJc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIgPSAmdGMtPmRpZ19wb3J0LT5iYXNlOw0KPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7DQo+IC0JYm9vbCBwaHlfaXNf
cmVhZHkgPSB0Y19waHlfaXNfcmVhZHkoZGlnX3BvcnQpOw0KPiAtCWJvb2wgcGh5X2lzX293bmVk
ID0gdGNfcGh5X2lzX293bmVkKGRpZ19wb3J0KTsNCj4gKwlib29sIHBoeV9pc19yZWFkeSA9IHRj
X3BoeV9pc19yZWFkeSh0Yyk7DQo+ICsJYm9vbCBwaHlfaXNfb3duZWQgPSB0Y19waHlfaXNfb3du
ZWQodGMpOw0KPiAgCWJvb2wgaXNfY29ubmVjdGVkOw0KPiANCj4gLQlpZiAodGNfcGh5X2lzX3Jl
YWR5X2FuZF9vd25lZChkaWdfcG9ydCwgcGh5X2lzX3JlYWR5LA0KPiBwaHlfaXNfb3duZWQpKQ0K
PiArCWlmICh0Y19waHlfaXNfcmVhZHlfYW5kX293bmVkKHRjLCBwaHlfaXNfcmVhZHksIHBoeV9p
c19vd25lZCkpDQo+ICAJCWlzX2Nvbm5lY3RlZCA9IHBvcnRfcGxsX3R5cGUgPT0gSUNMX1BPUlRf
RFBMTF9NR19QSFk7DQo+ICAJZWxzZQ0KPiAgCQlpc19jb25uZWN0ZWQgPSBwb3J0X3BsbF90eXBl
ID09IElDTF9QT1JUX0RQTExfREVGQVVMVDsNCj4gDQo+ICAJZHJtX2RiZ19rbXMoJmk5MTUtPmRy
bSwNCj4gIAkJICAgICJQb3J0ICVzOiBQSFkgY29ubmVjdGVkOiAlcyAocmVhZHk6ICVzLCBvd25l
ZDogJXMsIHBsbF90eXBlOg0KPiAlcylcbiIsDQo+IC0JCSAgICBkaWdfcG9ydC0+dGNfcG9ydF9u
YW1lLA0KPiArCQkgICAgdGMtPnBvcnRfbmFtZSwNCj4gIAkJICAgIHN0cl95ZXNfbm8oaXNfY29u
bmVjdGVkKSwNCj4gIAkJICAgIHN0cl95ZXNfbm8ocGh5X2lzX3JlYWR5KSwNCj4gIAkJICAgIHN0
cl95ZXNfbm8ocGh5X2lzX293bmVkKSwNCj4gQEAgLTYxMCwxMyArNjMwLDEzIEBAIHN0YXRpYyBi
b29sIHRjX3BoeV9pc19jb25uZWN0ZWQoc3RydWN0DQo+IGludGVsX2RpZ2l0YWxfcG9ydCAqZGln
X3BvcnQsDQo+ICAJcmV0dXJuIGlzX2Nvbm5lY3RlZDsNCj4gIH0NCj4gDQo+IC1zdGF0aWMgdm9p
ZCB0Y19waHlfd2FpdF9mb3JfcmVhZHkoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3Bv
cnQpDQo+ICtzdGF0aWMgdm9pZCB0Y19waHlfd2FpdF9mb3JfcmVhZHkoc3RydWN0IGludGVsX3Rj
X3BvcnQgKnRjKQ0KPiAgew0KPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShkaWdfcG9ydC0+YmFzZS5iYXNlLmRldik7DQo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0Y190b19pOTE1KHRjKTsNCj4gDQo+IC0JaWYgKHdhaXRfZm9yKHRjX3BoeV9p
c19yZWFkeShkaWdfcG9ydCksIDEwMCkpDQo+ICsJaWYgKHdhaXRfZm9yKHRjX3BoeV9pc19yZWFk
eSh0YyksIDEwMCkpDQo+ICAJCWRybV9lcnIoJmk5MTUtPmRybSwgIlBvcnQgJXM6IHRpbWVvdXQg
d2FpdGluZyBmb3IgUEhZDQo+IHJlYWR5XG4iLA0KPiAtCQkJZGlnX3BvcnQtPnRjX3BvcnRfbmFt
ZSk7DQo+ICsJCQl0Yy0+cG9ydF9uYW1lKTsNCj4gIH0NCj4gDQo+ICBzdGF0aWMgZW51bSB0Y19w
b3J0X21vZGUNCj4gQEAgLTYyOSwxNSArNjQ5LDE1IEBAIGhwZF9tYXNrX3RvX3RjX21vZGUodTMy
IGxpdmVfc3RhdHVzX21hc2spICB9DQo+IA0KPiAgc3RhdGljIGVudW0gdGNfcG9ydF9tb2RlDQo+
IC10Y19waHlfaHBkX2xpdmVfbW9kZShzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9y
dCkNCj4gK3RjX3BoeV9ocGRfbGl2ZV9tb2RlKHN0cnVjdCBpbnRlbF90Y19wb3J0ICp0YykNCj4g
IHsNCj4gLQl1MzIgbGl2ZV9zdGF0dXNfbWFzayA9IHRjX3BoeV9ocGRfbGl2ZV9zdGF0dXMoZGln
X3BvcnQpOw0KPiArCXUzMiBsaXZlX3N0YXR1c19tYXNrID0gdGNfcGh5X2hwZF9saXZlX3N0YXR1
cyh0Yyk7DQo+IA0KPiAgCXJldHVybiBocGRfbWFza190b190Y19tb2RlKGxpdmVfc3RhdHVzX21h
c2spOw0KPiAgfQ0KPiANCj4gIHN0YXRpYyBlbnVtIHRjX3BvcnRfbW9kZQ0KPiAtZ2V0X3RjX21v
ZGVfaW5fcGh5X293bmVkX3N0YXRlKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0
LA0KPiArZ2V0X3RjX21vZGVfaW5fcGh5X293bmVkX3N0YXRlKHN0cnVjdCBpbnRlbF90Y19wb3J0
ICp0YywNCj4gIAkJCSAgICAgICBlbnVtIHRjX3BvcnRfbW9kZSBsaXZlX21vZGUpDQo+ICB7DQo+
ICAJc3dpdGNoIChsaXZlX21vZGUpIHsNCj4gQEAgLTY0OSw3ICs2NjksNyBAQCBnZXRfdGNfbW9k
ZV9pbl9waHlfb3duZWRfc3RhdGUoc3RydWN0DQo+IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3Bv
cnQsDQo+ICAJCWZhbGx0aHJvdWdoOw0KPiAgCWNhc2UgVENfUE9SVF9UQlRfQUxUOg0KPiAgCWNh
c2UgVENfUE9SVF9ESVNDT05ORUNURUQ6DQo+IC0JCWlmIChkaWdfcG9ydC0+dGNfbGVnYWN5X3Bv
cnQpDQo+ICsJCWlmICh0Yy0+bGVnYWN5X3BvcnQpDQo+ICAJCQlyZXR1cm4gVENfUE9SVF9MRUdB
Q1k7DQo+ICAJCWVsc2UNCj4gIAkJCXJldHVybiBUQ19QT1JUX0RQX0FMVDsNCj4gQEAgLTY1Nyw3
ICs2NzcsNyBAQCBnZXRfdGNfbW9kZV9pbl9waHlfb3duZWRfc3RhdGUoc3RydWN0DQo+IGludGVs
X2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQsICB9DQo+IA0KPiAgc3RhdGljIGVudW0gdGNfcG9ydF9t
b2RlDQo+IC1nZXRfdGNfbW9kZV9pbl9waHlfbm90X293bmVkX3N0YXRlKHN0cnVjdCBpbnRlbF9k
aWdpdGFsX3BvcnQgKmRpZ19wb3J0LA0KPiArZ2V0X3RjX21vZGVfaW5fcGh5X25vdF9vd25lZF9z
dGF0ZShzdHJ1Y3QgaW50ZWxfdGNfcG9ydCAqdGMsDQo+ICAJCQkJICAgZW51bSB0Y19wb3J0X21v
ZGUgbGl2ZV9tb2RlKQ0KPiAgew0KPiAgCXN3aXRjaCAobGl2ZV9tb2RlKSB7DQo+IEBAIC02NzAs
NyArNjkwLDcgQEAgZ2V0X3RjX21vZGVfaW5fcGh5X25vdF9vd25lZF9zdGF0ZShzdHJ1Y3QNCj4g
aW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCwNCj4gIAkJTUlTU0lOR19DQVNFKGxpdmVfbW9k
ZSk7DQo+ICAJCWZhbGx0aHJvdWdoOw0KPiAgCWNhc2UgVENfUE9SVF9ESVNDT05ORUNURUQ6DQo+
IC0JCWlmIChkaWdfcG9ydC0+dGNfbGVnYWN5X3BvcnQpDQo+ICsJCWlmICh0Yy0+bGVnYWN5X3Bv
cnQpDQo+ICAJCQlyZXR1cm4gVENfUE9SVF9ESVNDT05ORUNURUQ7DQo+ICAJCWVsc2UNCj4gIAkJ
CXJldHVybiBUQ19QT1JUX1RCVF9BTFQ7DQo+IEBAIC02NzgsMTAgKzY5OCwxMCBAQCBnZXRfdGNf
bW9kZV9pbl9waHlfbm90X293bmVkX3N0YXRlKHN0cnVjdA0KPiBpbnRlbF9kaWdpdGFsX3BvcnQg
KmRpZ19wb3J0LCAgfQ0KPiANCj4gIHN0YXRpYyBlbnVtIHRjX3BvcnRfbW9kZQ0KPiAtdGNfcGh5
X2dldF9jdXJyZW50X21vZGUoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQpDQo+
ICt0Y19waHlfZ2V0X2N1cnJlbnRfbW9kZShzdHJ1Y3QgaW50ZWxfdGNfcG9ydCAqdGMpDQo+ICB7
DQo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRpZ19wb3J0LT5i
YXNlLmJhc2UuZGV2KTsNCj4gLQllbnVtIHRjX3BvcnRfbW9kZSBsaXZlX21vZGUgPSB0Y19waHlf
aHBkX2xpdmVfbW9kZShkaWdfcG9ydCk7DQo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0Y190b19pOTE1KHRjKTsNCj4gKwllbnVtIHRjX3BvcnRfbW9kZSBsaXZlX21vZGUgPSB0
Y19waHlfaHBkX2xpdmVfbW9kZSh0Yyk7DQo+ICAJYm9vbCBwaHlfaXNfcmVhZHk7DQo+ICAJYm9v
bCBwaHlfaXNfb3duZWQ7DQo+ICAJZW51bSB0Y19wb3J0X21vZGUgbW9kZTsNCj4gQEAgLTY5MSwy
MiArNzExLDIyIEBAIHRjX3BoeV9nZXRfY3VycmVudF9tb2RlKHN0cnVjdCBpbnRlbF9kaWdpdGFs
X3BvcnQNCj4gKmRpZ19wb3J0KQ0KPiAgCSAqIGFuZCBzeXN0ZW0gcmVzdW1lIHdoZXRoZXIgb3Ig
bm90IGEgc2luayBpcyBjb25uZWN0ZWQuIFdhaXQgaGVyZSBmb3INCj4gIAkgKiB0aGUgaW5pdGlh
bGl6YXRpb24gdG8gZ2V0IHJlYWR5Lg0KPiAgCSAqLw0KPiAtCWlmIChkaWdfcG9ydC0+dGNfbGVn
YWN5X3BvcnQpDQo+IC0JCXRjX3BoeV93YWl0X2Zvcl9yZWFkeShkaWdfcG9ydCk7DQo+ICsJaWYg
KHRjLT5sZWdhY3lfcG9ydCkNCj4gKwkJdGNfcGh5X3dhaXRfZm9yX3JlYWR5KHRjKTsNCj4gDQo+
IC0JcGh5X2lzX3JlYWR5ID0gdGNfcGh5X2lzX3JlYWR5KGRpZ19wb3J0KTsNCj4gLQlwaHlfaXNf
b3duZWQgPSB0Y19waHlfaXNfb3duZWQoZGlnX3BvcnQpOw0KPiArCXBoeV9pc19yZWFkeSA9IHRj
X3BoeV9pc19yZWFkeSh0Yyk7DQo+ICsJcGh5X2lzX293bmVkID0gdGNfcGh5X2lzX293bmVkKHRj
KTsNCj4gDQo+IC0JaWYgKCF0Y19waHlfaXNfcmVhZHlfYW5kX293bmVkKGRpZ19wb3J0LCBwaHlf
aXNfcmVhZHksDQo+IHBoeV9pc19vd25lZCkpIHsNCj4gLQkJbW9kZSA9IGdldF90Y19tb2RlX2lu
X3BoeV9ub3Rfb3duZWRfc3RhdGUoZGlnX3BvcnQsDQo+IGxpdmVfbW9kZSk7DQo+ICsJaWYgKCF0
Y19waHlfaXNfcmVhZHlfYW5kX293bmVkKHRjLCBwaHlfaXNfcmVhZHksIHBoeV9pc19vd25lZCkp
IHsNCj4gKwkJbW9kZSA9IGdldF90Y19tb2RlX2luX3BoeV9ub3Rfb3duZWRfc3RhdGUodGMsIGxp
dmVfbW9kZSk7DQo+ICAJfSBlbHNlIHsNCj4gIAkJZHJtX1dBUk5fT04oJmk5MTUtPmRybSwgbGl2
ZV9tb2RlID09DQo+IFRDX1BPUlRfVEJUX0FMVCk7DQo+IC0JCW1vZGUgPSBnZXRfdGNfbW9kZV9p
bl9waHlfb3duZWRfc3RhdGUoZGlnX3BvcnQsDQo+IGxpdmVfbW9kZSk7DQo+ICsJCW1vZGUgPSBn
ZXRfdGNfbW9kZV9pbl9waHlfb3duZWRfc3RhdGUodGMsIGxpdmVfbW9kZSk7DQo+ICAJfQ0KPiAN
Cj4gIAlkcm1fZGJnX2ttcygmaTkxNS0+ZHJtLA0KPiAgCQkgICAgIlBvcnQgJXM6IFBIWSBtb2Rl
OiAlcyAocmVhZHk6ICVzLCBvd25lZDogJXMsIEhQRDogJXMpXG4iLA0KPiAtCQkgICAgZGlnX3Bv
cnQtPnRjX3BvcnRfbmFtZSwNCj4gKwkJICAgIHRjLT5wb3J0X25hbWUsDQo+ICAJCSAgICB0Y19w
b3J0X21vZGVfbmFtZShtb2RlKSwNCj4gIAkJICAgIHN0cl95ZXNfbm8ocGh5X2lzX3JlYWR5KSwN
Cj4gIAkJICAgIHN0cl95ZXNfbm8ocGh5X2lzX293bmVkKSwNCj4gQEAgLTcxNSwzOCArNzM1LDM5
IEBAIHRjX3BoeV9nZXRfY3VycmVudF9tb2RlKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQNCj4g
KmRpZ19wb3J0KQ0KPiAgCXJldHVybiBtb2RlOw0KPiAgfQ0KPiANCj4gLXN0YXRpYyBlbnVtIHRj
X3BvcnRfbW9kZSBkZWZhdWx0X3RjX21vZGUoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGln
X3BvcnQpDQo+ICtzdGF0aWMgZW51bSB0Y19wb3J0X21vZGUgZGVmYXVsdF90Y19tb2RlKHN0cnVj
dCBpbnRlbF90Y19wb3J0ICp0YykNCj4gIHsNCj4gLQlpZiAoZGlnX3BvcnQtPnRjX2xlZ2FjeV9w
b3J0KQ0KPiArCWlmICh0Yy0+bGVnYWN5X3BvcnQpDQo+ICAJCXJldHVybiBUQ19QT1JUX0xFR0FD
WTsNCj4gDQo+ICAJcmV0dXJuIFRDX1BPUlRfVEJUX0FMVDsNCj4gIH0NCj4gDQo+ICBzdGF0aWMg
ZW51bSB0Y19wb3J0X21vZGUNCj4gLWhwZF9tYXNrX3RvX3RhcmdldF9tb2RlKHN0cnVjdCBpbnRl
bF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0LCB1MzINCj4gbGl2ZV9zdGF0dXNfbWFzaykNCj4gK2hw
ZF9tYXNrX3RvX3RhcmdldF9tb2RlKHN0cnVjdCBpbnRlbF90Y19wb3J0ICp0YywgdTMyIGxpdmVf
c3RhdHVzX21hc2spDQo+ICB7DQo+ICAJZW51bSB0Y19wb3J0X21vZGUgbW9kZSA9IGhwZF9tYXNr
X3RvX3RjX21vZGUobGl2ZV9zdGF0dXNfbWFzayk7DQo+IA0KPiAgCWlmIChtb2RlICE9IFRDX1BP
UlRfRElTQ09OTkVDVEVEKQ0KPiAgCQlyZXR1cm4gbW9kZTsNCj4gDQo+IC0JcmV0dXJuIGRlZmF1
bHRfdGNfbW9kZShkaWdfcG9ydCk7DQo+ICsJcmV0dXJuIGRlZmF1bHRfdGNfbW9kZSh0Yyk7DQo+
ICB9DQo+IA0KPiAgc3RhdGljIGVudW0gdGNfcG9ydF9tb2RlDQo+IC10Y19waHlfZ2V0X3Rhcmdl
dF9tb2RlKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KQ0KPiArdGNfcGh5X2dl
dF90YXJnZXRfbW9kZShzdHJ1Y3QgaW50ZWxfdGNfcG9ydCAqdGMpDQo+ICB7DQo+IC0JdTMyIGxp
dmVfc3RhdHVzX21hc2sgPSB0Y19waHlfaHBkX2xpdmVfc3RhdHVzKGRpZ19wb3J0KTsNCj4gKwl1
MzIgbGl2ZV9zdGF0dXNfbWFzayA9IHRjX3BoeV9ocGRfbGl2ZV9zdGF0dXModGMpOw0KPiANCj4g
LQlyZXR1cm4gaHBkX21hc2tfdG9fdGFyZ2V0X21vZGUoZGlnX3BvcnQsIGxpdmVfc3RhdHVzX21h
c2spOw0KPiArCXJldHVybiBocGRfbWFza190b190YXJnZXRfbW9kZSh0YywgbGl2ZV9zdGF0dXNf
bWFzayk7DQo+ICB9DQo+IA0KPiAtc3RhdGljIHZvaWQgaW50ZWxfdGNfcG9ydF9yZXNldF9tb2Rl
KHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0LA0KPiArc3RhdGljIHZvaWQgaW50
ZWxfdGNfcG9ydF9yZXNldF9tb2RlKHN0cnVjdCBpbnRlbF90Y19wb3J0ICp0YywNCj4gIAkJCQkg
ICAgIGludCByZXF1aXJlZF9sYW5lcywgYm9vbCBmb3JjZV9kaXNjb25uZWN0KSAgew0KPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkaWdfcG9ydC0+YmFzZS5iYXNl
LmRldik7DQo+IC0JZW51bSB0Y19wb3J0X21vZGUgb2xkX3RjX21vZGUgPSBkaWdfcG9ydC0+dGNf
bW9kZTsNCj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRjX3RvX2k5MTUodGMp
Ow0KPiArCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0ID0gdGMtPmRpZ19wb3J0
Ow0KPiArCWVudW0gdGNfcG9ydF9tb2RlIG9sZF90Y19tb2RlID0gdGMtPm1vZGU7DQo+IA0KPiAg
CWludGVsX2Rpc3BsYXlfcG93ZXJfZmx1c2hfd29yayhpOTE1KTsNCj4gIAlpZiAoIWludGVsX3Rj
X2NvbGRfcmVxdWlyZXNfYXV4X3B3KGRpZ19wb3J0KSkgeyBAQCAtNzU4LDIyICs3NzksMjINCj4g
QEAgc3RhdGljIHZvaWQgaW50ZWxfdGNfcG9ydF9yZXNldF9tb2RlKHN0cnVjdCBpbnRlbF9kaWdp
dGFsX3BvcnQgKmRpZ19wb3J0LA0KPiAgCQlkcm1fV0FSTl9PTigmaTkxNS0+ZHJtLCBhdXhfcG93
ZXJlZCk7DQo+ICAJfQ0KPiANCj4gLQlpY2xfdGNfcGh5X2Rpc2Nvbm5lY3QoZGlnX3BvcnQpOw0K
PiArCWljbF90Y19waHlfZGlzY29ubmVjdCh0Yyk7DQo+ICAJaWYgKCFmb3JjZV9kaXNjb25uZWN0
KQ0KPiAtCQlpY2xfdGNfcGh5X2Nvbm5lY3QoZGlnX3BvcnQsIHJlcXVpcmVkX2xhbmVzKTsNCj4g
KwkJaWNsX3RjX3BoeV9jb25uZWN0KHRjLCByZXF1aXJlZF9sYW5lcyk7DQo+IA0KPiAgCWRybV9k
Ymdfa21zKCZpOTE1LT5kcm0sICJQb3J0ICVzOiBUQyBwb3J0IG1vZGUgcmVzZXQgKCVzIC0+ICVz
KVxuIiwNCj4gLQkJICAgIGRpZ19wb3J0LT50Y19wb3J0X25hbWUsDQo+ICsJCSAgICB0Yy0+cG9y
dF9uYW1lLA0KPiAgCQkgICAgdGNfcG9ydF9tb2RlX25hbWUob2xkX3RjX21vZGUpLA0KPiAtCQkg
ICAgdGNfcG9ydF9tb2RlX25hbWUoZGlnX3BvcnQtPnRjX21vZGUpKTsNCj4gKwkJICAgIHRjX3Bv
cnRfbW9kZV9uYW1lKHRjLT5tb2RlKSk7DQo+ICB9DQo+IA0KPiAtc3RhdGljIGJvb2wgaW50ZWxf
dGNfcG9ydF9uZWVkc19yZXNldChzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCkN
Cj4gK3N0YXRpYyBib29sIGludGVsX3RjX3BvcnRfbmVlZHNfcmVzZXQoc3RydWN0IGludGVsX3Rj
X3BvcnQgKnRjKQ0KPiAgew0KPiAtCXJldHVybiB0Y19waHlfZ2V0X3RhcmdldF9tb2RlKGRpZ19w
b3J0KSAhPSBkaWdfcG9ydC0+dGNfbW9kZTsNCj4gKwlyZXR1cm4gdGNfcGh5X2dldF90YXJnZXRf
bW9kZSh0YykgIT0gdGMtPm1vZGU7DQo+ICB9DQo+IA0KPiAtc3RhdGljIHZvaWQgaW50ZWxfdGNf
cG9ydF91cGRhdGVfbW9kZShzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCwNCj4g
K3N0YXRpYyB2b2lkIGludGVsX3RjX3BvcnRfdXBkYXRlX21vZGUoc3RydWN0IGludGVsX3RjX3Bv
cnQgKnRjLA0KPiAgCQkJCSAgICAgIGludCByZXF1aXJlZF9sYW5lcywgYm9vbCBmb3JjZV9kaXNj
b25uZWN0KSAgew0KPiAgCWVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluOyBA
QCAtNzgyLDQ0ICs4MDMsNDQgQEANCj4gc3RhdGljIHZvaWQgaW50ZWxfdGNfcG9ydF91cGRhdGVf
bW9kZShzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCwNCj4gDQo+ICAJaWYgKCFu
ZWVkc19yZXNldCkgew0KPiAgCQkvKiBHZXQgcG93ZXIgZG9tYWluIHJlcXVpcmVkIHRvIGNoZWNr
IHRoZSBob3RwbHVnIGxpdmUgc3RhdHVzLg0KPiAqLw0KPiAtCQl3cmVmID0gdGNfY29sZF9ibG9j
ayhkaWdfcG9ydCwgJmRvbWFpbik7DQo+IC0JCW5lZWRzX3Jlc2V0ID0gaW50ZWxfdGNfcG9ydF9u
ZWVkc19yZXNldChkaWdfcG9ydCk7DQo+IC0JCXRjX2NvbGRfdW5ibG9jayhkaWdfcG9ydCwgZG9t
YWluLCB3cmVmKTsNCj4gKwkJd3JlZiA9IHRjX2NvbGRfYmxvY2sodGMsICZkb21haW4pOw0KPiAr
CQluZWVkc19yZXNldCA9IGludGVsX3RjX3BvcnRfbmVlZHNfcmVzZXQodGMpOw0KPiArCQl0Y19j
b2xkX3VuYmxvY2sodGMsIGRvbWFpbiwgd3JlZik7DQo+ICAJfQ0KPiANCj4gIAlpZiAoIW5lZWRz
X3Jlc2V0KQ0KPiAgCQlyZXR1cm47DQo+IA0KPiAgCS8qIEdldCBwb3dlciBkb21haW4gcmVxdWly
ZWQgZm9yIHJlc2V0dGluZyB0aGUgbW9kZS4gKi8NCj4gLQl3cmVmID0gdGNfY29sZF9ibG9ja19p
bl9tb2RlKGRpZ19wb3J0LCBUQ19QT1JUX0RJU0NPTk5FQ1RFRCwNCj4gJmRvbWFpbik7DQo+ICsJ
d3JlZiA9IHRjX2NvbGRfYmxvY2tfaW5fbW9kZSh0YywgVENfUE9SVF9ESVNDT05ORUNURUQsDQo+
ICZkb21haW4pOw0KPiANCj4gLQlpbnRlbF90Y19wb3J0X3Jlc2V0X21vZGUoZGlnX3BvcnQsIHJl
cXVpcmVkX2xhbmVzLCBmb3JjZV9kaXNjb25uZWN0KTsNCj4gKwlpbnRlbF90Y19wb3J0X3Jlc2V0
X21vZGUodGMsIHJlcXVpcmVkX2xhbmVzLCBmb3JjZV9kaXNjb25uZWN0KTsNCj4gDQo+ICAJLyog
R2V0IHBvd2VyIGRvbWFpbiBtYXRjaGluZyB0aGUgbmV3IG1vZGUgYWZ0ZXIgcmVzZXQuICovDQo+
IC0JdGNfY29sZF91bmJsb2NrKGRpZ19wb3J0LCBkaWdfcG9ydC0+dGNfbG9ja19wb3dlcl9kb21h
aW4sDQo+IC0JCQlmZXRjaF9hbmRfemVybygmZGlnX3BvcnQtPnRjX2xvY2tfd2FrZXJlZikpOw0K
PiAtCWlmIChkaWdfcG9ydC0+dGNfbW9kZSAhPSBUQ19QT1JUX0RJU0NPTk5FQ1RFRCkNCj4gLQkJ
ZGlnX3BvcnQtPnRjX2xvY2tfd2FrZXJlZiA9IHRjX2NvbGRfYmxvY2soZGlnX3BvcnQsDQo+IC0J
CQkJCQkJICAmZGlnX3BvcnQtDQo+ID50Y19sb2NrX3Bvd2VyX2RvbWFpbik7DQo+ICsJdGNfY29s
ZF91bmJsb2NrKHRjLCB0Yy0+bG9ja19wb3dlcl9kb21haW4sDQo+ICsJCQlmZXRjaF9hbmRfemVy
bygmdGMtPmxvY2tfd2FrZXJlZikpOw0KPiArCWlmICh0Yy0+bW9kZSAhPSBUQ19QT1JUX0RJU0NP
Tk5FQ1RFRCkNCj4gKwkJdGMtPmxvY2tfd2FrZXJlZiA9IHRjX2NvbGRfYmxvY2sodGMsICZ0Yy0N
Cj4gPmxvY2tfcG93ZXJfZG9tYWluKTsNCj4gDQo+IC0JdGNfY29sZF91bmJsb2NrKGRpZ19wb3J0
LCBkb21haW4sIHdyZWYpOw0KPiArCXRjX2NvbGRfdW5ibG9jayh0YywgZG9tYWluLCB3cmVmKTsN
Cj4gIH0NCj4gDQo+IC1zdGF0aWMgdm9pZCBfX2ludGVsX3RjX3BvcnRfZ2V0X2xpbmsoc3RydWN0
IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQpDQo+ICtzdGF0aWMgdm9pZCBfX2ludGVsX3Rj
X3BvcnRfZ2V0X2xpbmsoc3RydWN0IGludGVsX3RjX3BvcnQgKnRjKQ0KPiAgew0KPiAtCWRpZ19w
b3J0LT50Y19saW5rX3JlZmNvdW50Kys7DQo+ICsJdGMtPmxpbmtfcmVmY291bnQrKzsNCj4gIH0N
Cj4gDQo+IC1zdGF0aWMgdm9pZCBfX2ludGVsX3RjX3BvcnRfcHV0X2xpbmsoc3RydWN0IGludGVs
X2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQpDQo+ICtzdGF0aWMgdm9pZCBfX2ludGVsX3RjX3BvcnRf
cHV0X2xpbmsoc3RydWN0IGludGVsX3RjX3BvcnQgKnRjKQ0KPiAgew0KPiAtCWRpZ19wb3J0LT50
Y19saW5rX3JlZmNvdW50LS07DQo+ICsJdGMtPmxpbmtfcmVmY291bnQtLTsNCj4gIH0NCj4gDQo+
IC1zdGF0aWMgYm9vbCB0Y19wb3J0X2lzX2VuYWJsZWQoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9y
dCAqZGlnX3BvcnQpDQo+ICtzdGF0aWMgYm9vbCB0Y19wb3J0X2lzX2VuYWJsZWQoc3RydWN0IGlu
dGVsX3RjX3BvcnQgKnRjKQ0KPiAgew0KPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShkaWdfcG9ydC0+YmFzZS5iYXNlLmRldik7DQo+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0Y190b19pOTE1KHRjKTsNCj4gKwlzdHJ1Y3QgaW50ZWxfZGlnaXRh
bF9wb3J0ICpkaWdfcG9ydCA9IHRjLT5kaWdfcG9ydDsNCj4gDQo+IC0JYXNzZXJ0X3RjX3BvcnRf
cG93ZXJfZW5hYmxlZChkaWdfcG9ydCk7DQo+ICsJYXNzZXJ0X3RjX3BvcnRfcG93ZXJfZW5hYmxl
ZCh0Yyk7DQo+IA0KPiAgCXJldHVybiBpbnRlbF9kZV9yZWFkKGk5MTUsIERESV9CVUZfQ1RMKGRp
Z19wb3J0LT5iYXNlLnBvcnQpKSAmDQo+ICAJICAgICAgIERESV9CVUZfQ1RMX0VOQUJMRTsNCj4g
QEAgLTgzNSwyNyArODU2LDI4IEBAIHN0YXRpYyBib29sIHRjX3BvcnRfaXNfZW5hYmxlZChzdHJ1
Y3QNCj4gaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCkgIHZvaWQgaW50ZWxfdGNfcG9ydF9p
bml0X21vZGUoc3RydWN0DQo+IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQpICB7DQo+ICAJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRpZ19wb3J0LT5iYXNlLmJh
c2UuZGV2KTsNCj4gKwlzdHJ1Y3QgaW50ZWxfdGNfcG9ydCAqdGMgPSB0b190Y19wb3J0KGRpZ19w
b3J0KTsNCj4gIAlpbnRlbF93YWtlcmVmX3QgdGNfY29sZF93cmVmOw0KPiAgCWVudW0gaW50ZWxf
ZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluOw0KPiAgCWJvb2wgdXBkYXRlX21vZGUgPSBmYWxz
ZTsNCj4gDQo+IC0JbXV0ZXhfbG9jaygmZGlnX3BvcnQtPnRjX2xvY2spOw0KPiArCW11dGV4X2xv
Y2soJnRjLT5sb2NrKTsNCj4gDQo+IC0JZHJtX1dBUk5fT04oJmk5MTUtPmRybSwgZGlnX3BvcnQt
PnRjX21vZGUgIT0NCj4gVENfUE9SVF9ESVNDT05ORUNURUQpOw0KPiAtCWRybV9XQVJOX09OKCZp
OTE1LT5kcm0sIGRpZ19wb3J0LT50Y19sb2NrX3dha2VyZWYpOw0KPiAtCWRybV9XQVJOX09OKCZp
OTE1LT5kcm0sIGRpZ19wb3J0LT50Y19saW5rX3JlZmNvdW50KTsNCj4gKwlkcm1fV0FSTl9PTigm
aTkxNS0+ZHJtLCB0Yy0+bW9kZSAhPSBUQ19QT1JUX0RJU0NPTk5FQ1RFRCk7DQo+ICsJZHJtX1dB
Uk5fT04oJmk5MTUtPmRybSwgdGMtPmxvY2tfd2FrZXJlZik7DQo+ICsJZHJtX1dBUk5fT04oJmk5
MTUtPmRybSwgdGMtPmxpbmtfcmVmY291bnQpOw0KPiANCj4gLQl0Y19jb2xkX3dyZWYgPSB0Y19j
b2xkX2Jsb2NrKGRpZ19wb3J0LCAmZG9tYWluKTsNCj4gKwl0Y19jb2xkX3dyZWYgPSB0Y19jb2xk
X2Jsb2NrKHRjLCAmZG9tYWluKTsNCj4gDQo+IC0JZGlnX3BvcnQtPnRjX21vZGUgPSB0Y19waHlf
Z2V0X2N1cnJlbnRfbW9kZShkaWdfcG9ydCk7DQo+ICsJdGMtPm1vZGUgPSB0Y19waHlfZ2V0X2N1
cnJlbnRfbW9kZSh0Yyk7DQo+ICAJLyoNCj4gIAkgKiBTYXZlIHRoZSBpbml0aWFsIG1vZGUgZm9y
IHRoZSBzdGF0ZSBjaGVjayBpbg0KPiAgCSAqIGludGVsX3RjX3BvcnRfc2FuaXRpemVfbW9kZSgp
Lg0KPiAgCSAqLw0KPiAtCWRpZ19wb3J0LT50Y19pbml0X21vZGUgPSBkaWdfcG9ydC0+dGNfbW9k
ZTsNCj4gLQlpZiAoZGlnX3BvcnQtPnRjX21vZGUgIT0gVENfUE9SVF9ESVNDT05ORUNURUQpDQo+
IC0JCWRpZ19wb3J0LT50Y19sb2NrX3dha2VyZWYgPQ0KPiAtCQkJdGNfY29sZF9ibG9jayhkaWdf
cG9ydCwgJmRpZ19wb3J0LQ0KPiA+dGNfbG9ja19wb3dlcl9kb21haW4pOw0KPiArCXRjLT5pbml0
X21vZGUgPSB0Yy0+bW9kZTsNCj4gKwlpZiAodGMtPm1vZGUgIT0gVENfUE9SVF9ESVNDT05ORUNU
RUQpDQo+ICsJCXRjLT5sb2NrX3dha2VyZWYgPQ0KPiArCQkJdGNfY29sZF9ibG9jayh0YywgJnRj
LT5sb2NrX3Bvd2VyX2RvbWFpbik7DQo+IA0KPiAgCS8qDQo+ICAJICogVGhlIFBIWSBuZWVkcyB0
byBiZSBjb25uZWN0ZWQgZm9yIEFVWCB0byB3b3JrIGR1cmluZyBIVyByZWFkb3V0DQo+IGFuZCBA
QCAtODY4LDMxICs4OTAsMzIgQEAgdm9pZCBpbnRlbF90Y19wb3J0X2luaXRfbW9kZShzdHJ1Y3QN
Cj4gaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCkNCj4gIAkgKiBjYXVzZSBhIHByb2JsZW0g
YXMgdGhlIFBIWSBvd25lcnNoaXAgc3RhdGUgaXMgaWdub3JlZCBieSB0aGUNCj4gIAkgKiBJT00v
VENTUyBmaXJtd2FyZSAob25seSBkaXNwbGF5IGNhbiBvd24gdGhlIFBIWSBpbiB0aGF0IGNhc2Up
Lg0KPiAgCSAqLw0KPiAtCWlmICghdGNfcG9ydF9pc19lbmFibGVkKGRpZ19wb3J0KSkgew0KPiAr
CWlmICghdGNfcG9ydF9pc19lbmFibGVkKHRjKSkgew0KPiAgCQl1cGRhdGVfbW9kZSA9IHRydWU7
DQo+IC0JfSBlbHNlIGlmIChkaWdfcG9ydC0+dGNfbW9kZSA9PSBUQ19QT1JUX0RJU0NPTk5FQ1RF
RCkgew0KPiAtCQlkcm1fV0FSTl9PTigmaTkxNS0+ZHJtLCAhZGlnX3BvcnQtPnRjX2xlZ2FjeV9w
b3J0KTsNCj4gKwl9IGVsc2UgaWYgKHRjLT5tb2RlID09IFRDX1BPUlRfRElTQ09OTkVDVEVEKSB7
DQo+ICsJCWRybV9XQVJOX09OKCZpOTE1LT5kcm0sICF0Yy0+bGVnYWN5X3BvcnQpOw0KPiAgCQlk
cm1fZXJyKCZpOTE1LT5kcm0sDQo+ICAJCQkiUG9ydCAlczogUEhZIGRpc2Nvbm5lY3RlZCBvbiBl
bmFibGVkIHBvcnQsDQo+IGNvbm5lY3RpbmcgaXRcbiIsDQo+IC0JCQlkaWdfcG9ydC0+dGNfcG9y
dF9uYW1lKTsNCj4gKwkJCXRjLT5wb3J0X25hbWUpOw0KPiAgCQl1cGRhdGVfbW9kZSA9IHRydWU7
DQo+ICAJfQ0KPiANCj4gIAlpZiAodXBkYXRlX21vZGUpDQo+IC0JCWludGVsX3RjX3BvcnRfdXBk
YXRlX21vZGUoZGlnX3BvcnQsIDEsIGZhbHNlKTsNCj4gKwkJaW50ZWxfdGNfcG9ydF91cGRhdGVf
bW9kZSh0YywgMSwgZmFsc2UpOw0KPiANCj4gLQkvKiBQcmV2ZW50IGNoYW5naW5nIGRpZ19wb3J0
LT50Y19tb2RlIHVudGlsDQo+IGludGVsX3RjX3BvcnRfc2FuaXRpemVfbW9kZSgpIGlzIGNhbGxl
ZC4gKi8NCj4gLQlfX2ludGVsX3RjX3BvcnRfZ2V0X2xpbmsoZGlnX3BvcnQpOw0KPiArCS8qIFBy
ZXZlbnQgY2hhbmdpbmcgdGMtPm1vZGUgdW50aWwgaW50ZWxfdGNfcG9ydF9zYW5pdGl6ZV9tb2Rl
KCkgaXMNCj4gY2FsbGVkLiAqLw0KPiArCV9faW50ZWxfdGNfcG9ydF9nZXRfbGluayh0Yyk7DQo+
IA0KPiAtCXRjX2NvbGRfdW5ibG9jayhkaWdfcG9ydCwgZG9tYWluLCB0Y19jb2xkX3dyZWYpOw0K
PiArCXRjX2NvbGRfdW5ibG9jayh0YywgZG9tYWluLCB0Y19jb2xkX3dyZWYpOw0KPiANCj4gLQlt
dXRleF91bmxvY2soJmRpZ19wb3J0LT50Y19sb2NrKTsNCj4gKwltdXRleF91bmxvY2soJnRjLT5s
b2NrKTsNCj4gIH0NCj4gDQo+IC1zdGF0aWMgYm9vbCB0Y19wb3J0X2hhc19hY3RpdmVfbGlua3Mo
c3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQsDQo+ICtzdGF0aWMgYm9vbCB0Y19w
b3J0X2hhc19hY3RpdmVfbGlua3Moc3RydWN0IGludGVsX3RjX3BvcnQgKnRjLA0KPiAgCQkJCSAg
ICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpICB7DQo+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRpZ19wb3J0LT5iYXNlLmJhc2Uu
ZGV2KTsNCj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRjX3RvX2k5MTUodGMp
Ow0KPiArCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0ID0gdGMtPmRpZ19wb3J0
Ow0KPiAgCWVudW0gaWNsX3BvcnRfZHBsbF9pZCBwbGxfdHlwZSA9IElDTF9QT1JUX0RQTExfREVG
QVVMVDsNCj4gIAlpbnQgYWN0aXZlX2xpbmtzID0gMDsNCj4gDQo+IEBAIC05MDQsMTAgKzkyNywx
MCBAQCBzdGF0aWMgYm9vbCB0Y19wb3J0X2hhc19hY3RpdmVfbGlua3Moc3RydWN0DQo+IGludGVs
X2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQsDQo+ICAJCWFjdGl2ZV9saW5rcyA9IDE7DQo+ICAJfQ0K
PiANCj4gLQlpZiAoYWN0aXZlX2xpbmtzICYmICF0Y19waHlfaXNfY29ubmVjdGVkKGRpZ19wb3J0
LCBwbGxfdHlwZSkpDQo+ICsJaWYgKGFjdGl2ZV9saW5rcyAmJiAhdGNfcGh5X2lzX2Nvbm5lY3Rl
ZCh0YywgcGxsX3R5cGUpKQ0KPiAgCQlkcm1fZXJyKCZpOTE1LT5kcm0sDQo+ICAJCQkiUG9ydCAl
czogUEhZIGRpc2Nvbm5lY3RlZCB3aXRoICVkIGFjdGl2ZSBsaW5rKHMpXG4iLA0KPiAtCQkJZGln
X3BvcnQtPnRjX3BvcnRfbmFtZSwgYWN0aXZlX2xpbmtzKTsNCj4gKwkJCXRjLT5wb3J0X25hbWUs
IGFjdGl2ZV9saW5rcyk7DQo+IA0KPiAgCXJldHVybiBhY3RpdmVfbGlua3M7DQo+ICB9DQo+IEBA
IC05MjgsMzUgKzk1MSwzNiBAQCB2b2lkIGludGVsX3RjX3BvcnRfc2FuaXRpemVfbW9kZShzdHJ1
Y3QNCj4gaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCwNCj4gIAkJCQkgY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpICB7DQo+ICAJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsNCj4gKwlzdHJ1
Y3QgaW50ZWxfdGNfcG9ydCAqdGMgPSB0b190Y19wb3J0KGRpZ19wb3J0KTsNCj4gDQo+IC0JbXV0
ZXhfbG9jaygmZGlnX3BvcnQtPnRjX2xvY2spOw0KPiArCW11dGV4X2xvY2soJnRjLT5sb2NrKTsN
Cj4gDQo+IC0JZHJtX1dBUk5fT04oJmk5MTUtPmRybSwgZGlnX3BvcnQtPnRjX2xpbmtfcmVmY291
bnQgIT0gMSk7DQo+IC0JaWYgKCF0Y19wb3J0X2hhc19hY3RpdmVfbGlua3MoZGlnX3BvcnQsIGNy
dGNfc3RhdGUpKSB7DQo+ICsJZHJtX1dBUk5fT04oJmk5MTUtPmRybSwgdGMtPmxpbmtfcmVmY291
bnQgIT0gMSk7DQo+ICsJaWYgKCF0Y19wb3J0X2hhc19hY3RpdmVfbGlua3ModGMsIGNydGNfc3Rh
dGUpKSB7DQo+ICAJCS8qDQo+ICAJCSAqIFRCVC1hbHQgaXMgdGhlIGRlZmF1bHQgbW9kZSBpbiBh
bnkgY2FzZSB0aGUgUEhZIG93bmVyc2hpcCBpcw0KPiBub3QNCj4gIAkJICogaGVsZCAocmVnYXJk
bGVzcyBvZiB0aGUgc2luaydzIGNvbm5lY3RlZCBsaXZlIHN0YXRlKSwgc28NCj4gIAkJICogd2Un
bGwganVzdCBzd2l0Y2ggdG8gZGlzY29ubmVjdGVkIG1vZGUgZnJvbSBpdCBoZXJlIHdpdGhvdXQN
Cj4gIAkJICogYSBub3RlLg0KPiAgCQkgKi8NCj4gLQkJaWYgKGRpZ19wb3J0LT50Y19pbml0X21v
ZGUgIT0gVENfUE9SVF9UQlRfQUxUICYmDQo+IC0JCSAgICBkaWdfcG9ydC0+dGNfaW5pdF9tb2Rl
ICE9IFRDX1BPUlRfRElTQ09OTkVDVEVEKQ0KPiArCQlpZiAodGMtPmluaXRfbW9kZSAhPSBUQ19Q
T1JUX1RCVF9BTFQgJiYNCj4gKwkJICAgIHRjLT5pbml0X21vZGUgIT0gVENfUE9SVF9ESVNDT05O
RUNURUQpDQo+ICAJCQlkcm1fZGJnX2ttcygmaTkxNS0+ZHJtLA0KPiAgCQkJCSAgICAiUG9ydCAl
czogUEhZIGxlZnQgaW4gJXMgbW9kZSBvbiBkaXNhYmxlZA0KPiBwb3J0LCBkaXNjb25uZWN0aW5n
IGl0XG4iLA0KPiAtCQkJCSAgICBkaWdfcG9ydC0+dGNfcG9ydF9uYW1lLA0KPiAtCQkJCSAgICB0
Y19wb3J0X21vZGVfbmFtZShkaWdfcG9ydC0NCj4gPnRjX2luaXRfbW9kZSkpOw0KPiAtCQlpY2xf
dGNfcGh5X2Rpc2Nvbm5lY3QoZGlnX3BvcnQpOw0KPiAtCQlfX2ludGVsX3RjX3BvcnRfcHV0X2xp
bmsoZGlnX3BvcnQpOw0KPiArCQkJCSAgICB0Yy0+cG9ydF9uYW1lLA0KPiArCQkJCSAgICB0Y19w
b3J0X21vZGVfbmFtZSh0Yy0+aW5pdF9tb2RlKSk7DQo+ICsJCWljbF90Y19waHlfZGlzY29ubmVj
dCh0Yyk7DQo+ICsJCV9faW50ZWxfdGNfcG9ydF9wdXRfbGluayh0Yyk7DQo+IA0KPiAtCQl0Y19j
b2xkX3VuYmxvY2soZGlnX3BvcnQsIGRpZ19wb3J0LT50Y19sb2NrX3Bvd2VyX2RvbWFpbiwNCj4g
LQkJCQlmZXRjaF9hbmRfemVybygmZGlnX3BvcnQtPnRjX2xvY2tfd2FrZXJlZikpOw0KPiArCQl0
Y19jb2xkX3VuYmxvY2sodGMsIHRjLT5sb2NrX3Bvd2VyX2RvbWFpbiwNCj4gKwkJCQlmZXRjaF9h
bmRfemVybygmdGMtPmxvY2tfd2FrZXJlZikpOw0KPiAgCX0NCj4gDQo+ICAJZHJtX2RiZ19rbXMo
Jmk5MTUtPmRybSwgIlBvcnQgJXM6IHNhbml0aXplIG1vZGUgKCVzKVxuIiwNCj4gLQkJICAgIGRp
Z19wb3J0LT50Y19wb3J0X25hbWUsDQo+IC0JCSAgICB0Y19wb3J0X21vZGVfbmFtZShkaWdfcG9y
dC0+dGNfbW9kZSkpOw0KPiArCQkgICAgdGMtPnBvcnRfbmFtZSwNCj4gKwkJICAgIHRjX3BvcnRf
bW9kZV9uYW1lKHRjLT5tb2RlKSk7DQo+IA0KPiAtCW11dGV4X3VubG9jaygmZGlnX3BvcnQtPnRj
X2xvY2spOw0KPiArCW11dGV4X3VubG9jaygmdGMtPmxvY2spOw0KPiAgfQ0KPiANCj4gIC8qDQo+
IEBAIC05NzMsMTAgKzk5NywxMSBAQCBib29sIGludGVsX3RjX3BvcnRfY29ubmVjdGVkX2xvY2tl
ZChzdHJ1Y3QNCj4gaW50ZWxfZW5jb2RlciAqZW5jb2RlcikgIHsNCj4gIAlzdHJ1Y3QgaW50ZWxf
ZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCA9IGVuY190b19kaWdfcG9ydChlbmNvZGVyKTsNCj4gIAlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGlnX3BvcnQtPmJhc2UuYmFz
ZS5kZXYpOw0KPiArCXN0cnVjdCBpbnRlbF90Y19wb3J0ICp0YyA9IHRvX3RjX3BvcnQoZGlnX3Bv
cnQpOw0KPiANCj4gIAlkcm1fV0FSTl9PTigmaTkxNS0+ZHJtLCAhaW50ZWxfdGNfcG9ydF9yZWZf
aGVsZChkaWdfcG9ydCkpOw0KPiANCj4gLQlyZXR1cm4gdGNfcGh5X2hwZF9saXZlX3N0YXR1cyhk
aWdfcG9ydCkgJiBCSVQoZGlnX3BvcnQtPnRjX21vZGUpOw0KPiArCXJldHVybiB0Y19waHlfaHBk
X2xpdmVfc3RhdHVzKHRjKSAmIEJJVCh0Yy0+bW9kZSk7DQo+ICB9DQo+IA0KPiAgYm9vbCBpbnRl
bF90Y19wb3J0X2Nvbm5lY3RlZChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikgQEAgLTk5
MSwyNw0KPiArMTAxNiwyNyBAQCBib29sIGludGVsX3RjX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyKQ0KPiAgCXJldHVybiBpc19jb25uZWN0ZWQ7DQo+ICB9DQo+
IA0KPiAtc3RhdGljIHZvaWQgX19pbnRlbF90Y19wb3J0X2xvY2soc3RydWN0IGludGVsX2RpZ2l0
YWxfcG9ydCAqZGlnX3BvcnQsDQo+ICtzdGF0aWMgdm9pZCBfX2ludGVsX3RjX3BvcnRfbG9jayhz
dHJ1Y3QgaW50ZWxfdGNfcG9ydCAqdGMsDQo+ICAJCQkJIGludCByZXF1aXJlZF9sYW5lcykNCj4g
IHsNCj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGlnX3BvcnQt
PmJhc2UuYmFzZS5kZXYpOw0KPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdGNf
dG9faTkxNSh0Yyk7DQo+IA0KPiAtCW11dGV4X2xvY2soJmRpZ19wb3J0LT50Y19sb2NrKTsNCj4g
KwltdXRleF9sb2NrKCZ0Yy0+bG9jayk7DQo+IA0KPiAtCWNhbmNlbF9kZWxheWVkX3dvcmsoJmRp
Z19wb3J0LT50Y19kaXNjb25uZWN0X3BoeV93b3JrKTsNCj4gKwljYW5jZWxfZGVsYXllZF93b3Jr
KCZ0Yy0+ZGlzY29ubmVjdF9waHlfd29yayk7DQo+IA0KPiAtCWlmICghZGlnX3BvcnQtPnRjX2xp
bmtfcmVmY291bnQpDQo+IC0JCWludGVsX3RjX3BvcnRfdXBkYXRlX21vZGUoZGlnX3BvcnQsIHJl
cXVpcmVkX2xhbmVzLA0KPiArCWlmICghdGMtPmxpbmtfcmVmY291bnQpDQo+ICsJCWludGVsX3Rj
X3BvcnRfdXBkYXRlX21vZGUodGMsIHJlcXVpcmVkX2xhbmVzLA0KPiAgCQkJCQkgIGZhbHNlKTsN
Cj4gDQo+IC0JZHJtX1dBUk5fT04oJmk5MTUtPmRybSwgZGlnX3BvcnQtPnRjX21vZGUgPT0NCj4g
VENfUE9SVF9ESVNDT05ORUNURUQpOw0KPiAtCWRybV9XQVJOX09OKCZpOTE1LT5kcm0sIGRpZ19w
b3J0LT50Y19tb2RlICE9IFRDX1BPUlRfVEJUX0FMVA0KPiAmJg0KPiAtCQkJCSF0Y19waHlfaXNf
b3duZWQoZGlnX3BvcnQpKTsNCj4gKwlkcm1fV0FSTl9PTigmaTkxNS0+ZHJtLCB0Yy0+bW9kZSA9
PSBUQ19QT1JUX0RJU0NPTk5FQ1RFRCk7DQo+ICsJZHJtX1dBUk5fT04oJmk5MTUtPmRybSwgdGMt
Pm1vZGUgIT0gVENfUE9SVF9UQlRfQUxUICYmDQo+ICsJCQkJIXRjX3BoeV9pc19vd25lZCh0Yykp
Ow0KPiAgfQ0KPiANCj4gIHZvaWQgaW50ZWxfdGNfcG9ydF9sb2NrKHN0cnVjdCBpbnRlbF9kaWdp
dGFsX3BvcnQgKmRpZ19wb3J0KSAgew0KPiAtCV9faW50ZWxfdGNfcG9ydF9sb2NrKGRpZ19wb3J0
LCAxKTsNCj4gKwlfX2ludGVsX3RjX3BvcnRfbG9jayh0b190Y19wb3J0KGRpZ19wb3J0KSwgMSk7
DQo+ICB9DQo+IA0KPiAgLyoqDQo+IEBAIC0xMDI0LDE1ICsxMDQ5LDE1IEBAIHZvaWQgaW50ZWxf
dGNfcG9ydF9sb2NrKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQNCj4gKmRpZ19wb3J0KQ0KPiAg
ICovDQo+ICBzdGF0aWMgdm9pZCBpbnRlbF90Y19wb3J0X2Rpc2Nvbm5lY3RfcGh5X3dvcmsoc3Ry
dWN0IHdvcmtfc3RydWN0ICp3b3JrKSAgew0KPiAtCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQg
KmRpZ19wb3J0ID0NCj4gLQkJY29udGFpbmVyX29mKHdvcmssIHN0cnVjdCBpbnRlbF9kaWdpdGFs
X3BvcnQsDQo+IHRjX2Rpc2Nvbm5lY3RfcGh5X3dvcmsud29yayk7DQo+ICsJc3RydWN0IGludGVs
X3RjX3BvcnQgKnRjID0NCj4gKwkJY29udGFpbmVyX29mKHdvcmssIHN0cnVjdCBpbnRlbF90Y19w
b3J0LA0KPiBkaXNjb25uZWN0X3BoeV93b3JrLndvcmspOw0KPiANCj4gLQltdXRleF9sb2NrKCZk
aWdfcG9ydC0+dGNfbG9jayk7DQo+ICsJbXV0ZXhfbG9jaygmdGMtPmxvY2spOw0KPiANCj4gLQlp
ZiAoIWRpZ19wb3J0LT50Y19saW5rX3JlZmNvdW50KQ0KPiAtCQlpbnRlbF90Y19wb3J0X3VwZGF0
ZV9tb2RlKGRpZ19wb3J0LCAxLCB0cnVlKTsNCj4gKwlpZiAoIXRjLT5saW5rX3JlZmNvdW50KQ0K
PiArCQlpbnRlbF90Y19wb3J0X3VwZGF0ZV9tb2RlKHRjLCAxLCB0cnVlKTsNCj4gDQo+IC0JbXV0
ZXhfdW5sb2NrKCZkaWdfcG9ydC0+dGNfbG9jayk7DQo+ICsJbXV0ZXhfdW5sb2NrKCZ0Yy0+bG9j
ayk7DQo+ICB9DQo+IA0KPiAgLyoqDQo+IEBAIC0xMDQzLDM2ICsxMDY4LDQ0IEBAIHN0YXRpYyB2
b2lkDQo+IGludGVsX3RjX3BvcnRfZGlzY29ubmVjdF9waHlfd29yayhzdHJ1Y3Qgd29ya19zdHJ1
Y3QgKndvcmspDQo+ICAgKi8NCj4gIHZvaWQgaW50ZWxfdGNfcG9ydF9mbHVzaF93b3JrKHN0cnVj
dCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KSAgew0KPiAtCWZsdXNoX2RlbGF5ZWRfd29y
aygmZGlnX3BvcnQtPnRjX2Rpc2Nvbm5lY3RfcGh5X3dvcmspOw0KPiArCWZsdXNoX2RlbGF5ZWRf
d29yaygmdG9fdGNfcG9ydChkaWdfcG9ydCktPmRpc2Nvbm5lY3RfcGh5X3dvcmspOw0KPiAgfQ0K
PiANCj4gIHZvaWQgaW50ZWxfdGNfcG9ydF91bmxvY2soc3RydWN0IGludGVsX2RpZ2l0YWxfcG9y
dCAqZGlnX3BvcnQpICB7DQo+IC0JaWYgKCFkaWdfcG9ydC0+dGNfbGlua19yZWZjb3VudCAmJiBk
aWdfcG9ydC0+dGNfbW9kZSAhPQ0KPiBUQ19QT1JUX0RJU0NPTk5FQ1RFRCkNCj4gLQkJcXVldWVf
ZGVsYXllZF93b3JrKHN5c3RlbV91bmJvdW5kX3dxLCAmZGlnX3BvcnQtDQo+ID50Y19kaXNjb25u
ZWN0X3BoeV93b3JrLA0KPiArCXN0cnVjdCBpbnRlbF90Y19wb3J0ICp0YyA9IHRvX3RjX3BvcnQo
ZGlnX3BvcnQpOw0KPiArDQo+ICsJaWYgKCF0Yy0+bGlua19yZWZjb3VudCAmJiB0Yy0+bW9kZSAh
PSBUQ19QT1JUX0RJU0NPTk5FQ1RFRCkNCj4gKwkJcXVldWVfZGVsYXllZF93b3JrKHN5c3RlbV91
bmJvdW5kX3dxLCAmdGMtDQo+ID5kaXNjb25uZWN0X3BoeV93b3JrLA0KPiAgCQkJCSAgIG1zZWNz
X3RvX2ppZmZpZXMoMTAwMCkpOw0KPiANCj4gLQltdXRleF91bmxvY2soJmRpZ19wb3J0LT50Y19s
b2NrKTsNCj4gKwltdXRleF91bmxvY2soJnRjLT5sb2NrKTsNCj4gIH0NCj4gDQo+ICBib29sIGlu
dGVsX3RjX3BvcnRfcmVmX2hlbGQoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQp
ICB7DQo+IC0JcmV0dXJuIG11dGV4X2lzX2xvY2tlZCgmZGlnX3BvcnQtPnRjX2xvY2spIHx8DQo+
IC0JICAgICAgIGRpZ19wb3J0LT50Y19saW5rX3JlZmNvdW50Ow0KPiArCXN0cnVjdCBpbnRlbF90
Y19wb3J0ICp0YyA9IHRvX3RjX3BvcnQoZGlnX3BvcnQpOw0KPiArDQo+ICsJcmV0dXJuIG11dGV4
X2lzX2xvY2tlZCgmdGMtPmxvY2spIHx8DQo+ICsJICAgICAgIHRjLT5saW5rX3JlZmNvdW50Ow0K
PiAgfQ0KPiANCj4gIHZvaWQgaW50ZWxfdGNfcG9ydF9nZXRfbGluayhzdHJ1Y3QgaW50ZWxfZGln
aXRhbF9wb3J0ICpkaWdfcG9ydCwNCj4gIAkJCSAgICBpbnQgcmVxdWlyZWRfbGFuZXMpDQo+ICB7
DQo+IC0JX19pbnRlbF90Y19wb3J0X2xvY2soZGlnX3BvcnQsIHJlcXVpcmVkX2xhbmVzKTsNCj4g
LQlfX2ludGVsX3RjX3BvcnRfZ2V0X2xpbmsoZGlnX3BvcnQpOw0KPiArCXN0cnVjdCBpbnRlbF90
Y19wb3J0ICp0YyA9IHRvX3RjX3BvcnQoZGlnX3BvcnQpOw0KPiArDQo+ICsJX19pbnRlbF90Y19w
b3J0X2xvY2sodGMsIHJlcXVpcmVkX2xhbmVzKTsNCj4gKwlfX2ludGVsX3RjX3BvcnRfZ2V0X2xp
bmsodGMpOw0KPiAgCWludGVsX3RjX3BvcnRfdW5sb2NrKGRpZ19wb3J0KTsNCj4gIH0NCj4gDQo+
ICB2b2lkIGludGVsX3RjX3BvcnRfcHV0X2xpbmsoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAq
ZGlnX3BvcnQpICB7DQo+ICsJc3RydWN0IGludGVsX3RjX3BvcnQgKnRjID0gdG9fdGNfcG9ydChk
aWdfcG9ydCk7DQo+ICsNCj4gIAlpbnRlbF90Y19wb3J0X2xvY2soZGlnX3BvcnQpOw0KPiAtCV9f
aW50ZWxfdGNfcG9ydF9wdXRfbGluayhkaWdfcG9ydCk7DQo+ICsJX19pbnRlbF90Y19wb3J0X3B1
dF9saW5rKHRjKTsNCj4gIAlpbnRlbF90Y19wb3J0X3VubG9jayhkaWdfcG9ydCk7DQo+IA0KPiAg
CS8qDQo+IEBAIC0xMDg1LDcgKzExMTgsNyBAQCB2b2lkIGludGVsX3RjX3BvcnRfcHV0X2xpbmso
c3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydA0KPiAqZGlnX3BvcnQpICB9DQo+IA0KPiAgc3RhdGlj
IGJvb2wNCj4gLXRjX2hhc19tb2R1bGFyX2ZpYShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwgc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydA0KPiAqZGlnX3BvcnQpDQo+ICt0Y19oYXNfbW9k
dWxhcl9maWEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHN0cnVjdCBpbnRlbF90Y19w
b3J0DQo+ICsqdGMpDQo+ICB7DQo+ICAJZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBk
b21haW47DQo+ICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7DQo+IEBAIC0xMDk0LDExICsxMTI3
LDExIEBAIHRjX2hhc19tb2R1bGFyX2ZpYShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwN
Cj4gc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnDQo+ICAJaWYgKCFJTlRFTF9JTkZPKGk5
MTUpLT5kaXNwbGF5Lmhhc19tb2R1bGFyX2ZpYSkNCj4gIAkJcmV0dXJuIGZhbHNlOw0KPiANCj4g
LQltdXRleF9sb2NrKCZkaWdfcG9ydC0+dGNfbG9jayk7DQo+IC0Jd2FrZXJlZiA9IHRjX2NvbGRf
YmxvY2soZGlnX3BvcnQsICZkb21haW4pOw0KPiArCW11dGV4X2xvY2soJnRjLT5sb2NrKTsNCj4g
Kwl3YWtlcmVmID0gdGNfY29sZF9ibG9jayh0YywgJmRvbWFpbik7DQo+ICAJdmFsID0gaW50ZWxf
ZGVfcmVhZChpOTE1LCBQT1JUX1RYX0RGTEVYRFBTUChGSUExKSk7DQo+IC0JdGNfY29sZF91bmJs
b2NrKGRpZ19wb3J0LCBkb21haW4sIHdha2VyZWYpOw0KPiAtCW11dGV4X3VubG9jaygmZGlnX3Bv
cnQtPnRjX2xvY2spOw0KPiArCXRjX2NvbGRfdW5ibG9jayh0YywgZG9tYWluLCB3YWtlcmVmKTsN
Cj4gKwltdXRleF91bmxvY2soJnRjLT5sb2NrKTsNCj4gDQo+ICAJZHJtX1dBUk5fT04oJmk5MTUt
PmRybSwgdmFsID09IDB4ZmZmZmZmZmYpOw0KPiANCj4gQEAgLTExMDYsNDIgKzExMzksNDUgQEAg
dGNfaGFzX21vZHVsYXJfZmlhKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LA0KPiBzdHJ1
Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWcgIH0NCj4gDQo+ICBzdGF0aWMgdm9pZA0KPiAtdGNf
cG9ydF9sb2FkX2ZpYV9wYXJhbXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHN0cnVj
dA0KPiBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KQ0KPiArdGNfcG9ydF9sb2FkX2ZpYV9w
YXJhbXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHN0cnVjdA0KPiAraW50ZWxfdGNf
cG9ydCAqdGMpDQo+ICB7DQo+IC0JZW51bSBwb3J0IHBvcnQgPSBkaWdfcG9ydC0+YmFzZS5wb3J0
Ow0KPiArCWVudW0gcG9ydCBwb3J0ID0gdGMtPmRpZ19wb3J0LT5iYXNlLnBvcnQ7DQo+ICAJZW51
bSB0Y19wb3J0IHRjX3BvcnQgPSBpbnRlbF9wb3J0X3RvX3RjKGk5MTUsIHBvcnQpOw0KPiANCj4g
IAkvKg0KPiAgCSAqIEVhY2ggTW9kdWxhciBGSUEgaW5zdGFuY2UgaG91c2VzIDIgVEMgcG9ydHMu
IEluIFNPQyB0aGF0IGhhcyBtb3JlDQo+ICAJICogdGhhbiB0d28gVEMgcG9ydHMsIHRoZXJlIGFy
ZSBtdWx0aXBsZSBpbnN0YW5jZXMgb2YgTW9kdWxhciBGSUEuDQo+ICAJICovDQo+IC0JaWYgKHRj
X2hhc19tb2R1bGFyX2ZpYShpOTE1LCBkaWdfcG9ydCkpIHsNCj4gLQkJZGlnX3BvcnQtPnRjX3Bo
eV9maWEgPSB0Y19wb3J0IC8gMjsNCj4gLQkJZGlnX3BvcnQtPnRjX3BoeV9maWFfaWR4ID0gdGNf
cG9ydCAlIDI7DQo+ICsJaWYgKHRjX2hhc19tb2R1bGFyX2ZpYShpOTE1LCB0YykpIHsNCj4gKwkJ
dGMtPnBoeV9maWEgPSB0Y19wb3J0IC8gMjsNCj4gKwkJdGMtPnBoeV9maWFfaWR4ID0gdGNfcG9y
dCAlIDI7DQo+ICAJfSBlbHNlIHsNCj4gLQkJZGlnX3BvcnQtPnRjX3BoeV9maWEgPSBGSUExOw0K
PiAtCQlkaWdfcG9ydC0+dGNfcGh5X2ZpYV9pZHggPSB0Y19wb3J0Ow0KPiArCQl0Yy0+cGh5X2Zp
YSA9IEZJQTE7DQo+ICsJCXRjLT5waHlfZmlhX2lkeCA9IHRjX3BvcnQ7DQo+ICAJfQ0KPiAgfQ0K
PiANCj4gIHZvaWQgaW50ZWxfdGNfcG9ydF9pbml0KHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQg
KmRpZ19wb3J0LCBib29sIGlzX2xlZ2FjeSkgIHsNCj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOw0KPiArCXN0cnVjdCBp
bnRlbF90Y19wb3J0ICp0YyA9IHRvX3RjX3BvcnQoZGlnX3BvcnQpOw0KPiAgCWVudW0gcG9ydCBw
b3J0ID0gZGlnX3BvcnQtPmJhc2UucG9ydDsNCj4gIAllbnVtIHRjX3BvcnQgdGNfcG9ydCA9IGlu
dGVsX3BvcnRfdG9fdGMoaTkxNSwgcG9ydCk7DQo+IA0KPiAgCWlmIChkcm1fV0FSTl9PTigmaTkx
NS0+ZHJtLCB0Y19wb3J0ID09IFRDX1BPUlRfTk9ORSkpDQo+ICAJCXJldHVybjsNCj4gDQo+IC0J
c25wcmludGYoZGlnX3BvcnQtPnRjX3BvcnRfbmFtZSwgc2l6ZW9mKGRpZ19wb3J0LT50Y19wb3J0
X25hbWUpLA0KPiArCXRjLT5kaWdfcG9ydCA9IGRpZ19wb3J0Ow0KPiArDQo+ICsJc25wcmludGYo
dGMtPnBvcnRfbmFtZSwgc2l6ZW9mKHRjLT5wb3J0X25hbWUpLA0KPiAgCQkgIiVjL1RDIyVkIiwg
cG9ydF9uYW1lKHBvcnQpLCB0Y19wb3J0ICsgMSk7DQo+IA0KPiAtCW11dGV4X2luaXQoJmRpZ19w
b3J0LT50Y19sb2NrKTsNCj4gLQlJTklUX0RFTEFZRURfV09SSygmZGlnX3BvcnQtPnRjX2Rpc2Nv
bm5lY3RfcGh5X3dvcmssDQo+IGludGVsX3RjX3BvcnRfZGlzY29ubmVjdF9waHlfd29yayk7DQo+
IC0JZGlnX3BvcnQtPnRjX2xlZ2FjeV9wb3J0ID0gaXNfbGVnYWN5Ow0KPiAtCWRpZ19wb3J0LT50
Y19tb2RlID0gVENfUE9SVF9ESVNDT05ORUNURUQ7DQo+IC0JZGlnX3BvcnQtPnRjX2xpbmtfcmVm
Y291bnQgPSAwOw0KPiAtCXRjX3BvcnRfbG9hZF9maWFfcGFyYW1zKGk5MTUsIGRpZ19wb3J0KTsN
Cj4gKwltdXRleF9pbml0KCZ0Yy0+bG9jayk7DQo+ICsJSU5JVF9ERUxBWUVEX1dPUksoJnRjLT5k
aXNjb25uZWN0X3BoeV93b3JrLA0KPiBpbnRlbF90Y19wb3J0X2Rpc2Nvbm5lY3RfcGh5X3dvcmsp
Ow0KPiArCXRjLT5sZWdhY3lfcG9ydCA9IGlzX2xlZ2FjeTsNCj4gKwl0Yy0+bW9kZSA9IFRDX1BP
UlRfRElTQ09OTkVDVEVEOw0KPiArCXRjLT5saW5rX3JlZmNvdW50ID0gMDsNCj4gKwl0Y19wb3J0
X2xvYWRfZmlhX3BhcmFtcyhpOTE1LCB0Yyk7DQo+IA0KPiAgCWludGVsX3RjX3BvcnRfaW5pdF9t
b2RlKGRpZ19wb3J0KTsNCj4gIH0NCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfdGMuaA0KPiBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfdGMuaA0KPiBpbmRleCA3OTY2N2Q5Nzc1MDhjLi5jYzNhN2ZkNGFjMTAyIDEwMDY0NA0KPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3RjLmgNCj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF90Yy5oDQo+IEBAIC05LDEwICs5LDM2IEBA
DQo+ICAjaW5jbHVkZSA8bGludXgvbXV0ZXguaD4NCj4gICNpbmNsdWRlIDxsaW51eC90eXBlcy5o
Pg0KPiANCj4gKyNpbmNsdWRlICJpbnRlbF9kaXNwbGF5LmgiDQo+ICsjaW5jbHVkZSAiaW50ZWxf
ZGlzcGxheV9wb3dlci5oIg0KPiArI2luY2x1ZGUgImludGVsX3dha2VyZWYuaCINCj4gKw0KPiAg
c3RydWN0IGludGVsX2NydGNfc3RhdGU7DQo+ICBzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0Ow0K
PiAgc3RydWN0IGludGVsX2VuY29kZXI7DQo+IA0KPiArZW51bSB0Y19wb3J0X21vZGUgew0KPiAr
CVRDX1BPUlRfRElTQ09OTkVDVEVELA0KPiArCVRDX1BPUlRfVEJUX0FMVCwNCj4gKwlUQ19QT1JU
X0RQX0FMVCwNCj4gKwlUQ19QT1JUX0xFR0FDWSwNCj4gK307DQo+ICsNCj4gK3N0cnVjdCBpbnRl
bF90Y19wb3J0IHsNCj4gKwlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydDsNCj4g
KwlzdHJ1Y3QgbXV0ZXggbG9jazsJLyogcHJvdGVjdHMgdGhlIFR5cGVDIHBvcnQgbW9kZSAqLw0K
PiArCWludGVsX3dha2VyZWZfdCBsb2NrX3dha2VyZWY7DQo+ICsJZW51bSBpbnRlbF9kaXNwbGF5
X3Bvd2VyX2RvbWFpbiBsb2NrX3Bvd2VyX2RvbWFpbjsNCj4gKwlzdHJ1Y3QgZGVsYXllZF93b3Jr
IGRpc2Nvbm5lY3RfcGh5X3dvcms7DQo+ICsJaW50IGxpbmtfcmVmY291bnQ7DQo+ICsJYm9vbCBs
ZWdhY3lfcG9ydDoxOw0KPiArCWNoYXIgcG9ydF9uYW1lWzhdOw0KPiArCWVudW0gdGNfcG9ydF9t
b2RlIG1vZGU7DQo+ICsJZW51bSB0Y19wb3J0X21vZGUgaW5pdF9tb2RlOw0KPiArCWVudW0gcGh5
X2ZpYSBwaHlfZmlhOw0KPiArCXU4IHBoeV9maWFfaWR4Ow0KPiArfTsNCj4gKw0KPiAgYm9vbCBp
bnRlbF90Y19wb3J0X2luX3RidF9hbHRfbW9kZShzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpk
aWdfcG9ydCk7ICBib29sDQo+IGludGVsX3RjX3BvcnRfaW5fZHBfYWx0X21vZGUoc3RydWN0IGlu
dGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQpOyAgYm9vbA0KPiBpbnRlbF90Y19wb3J0X2luX2xl
Z2FjeV9tb2RlKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KTsNCj4gLS0NCj4g
Mi4zNy4xDQoNCg==

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id C285DE758C
	for <lists+intel-gfx@lfdr.de>; Mon, 28 Oct 2019 16:53:36 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 03B1F6E95C;
	Mon, 28 Oct 2019 15:53:35 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga06.intel.com (mga06.intel.com [134.134.136.31])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B24446E96C;
 Mon, 28 Oct 2019 15:53:33 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga008.jf.intel.com ([10.7.209.65])
 by orsmga104.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 28 Oct 2019 08:53:33 -0700
X-IronPort-AV: E=Sophos;i="5.68,240,1569308400"; d="scan'208";a="193299017"
Received: from jkrzyszt-desk.igk.intel.com ([172.22.244.17])
 by orsmga008-auth.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 28 Oct 2019 08:53:30 -0700
From: Janusz Krzysztofik <janusz.krzysztofik@linux.intel.com>
To: igt-dev@lists.freedesktop.org
Date: Mon, 28 Oct 2019 16:53:16 +0100
Message-Id: <20191028155318.23416-3-janusz.krzysztofik@linux.intel.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20191028155318.23416-1-janusz.krzysztofik@linux.intel.com>
References: <20191028155318.23416-1-janusz.krzysztofik@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [RFC PATCH i-g-t v3 2/4] lib: Add GEM minimum page size
 helper
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: intel-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

U29tZSB0ZXN0cyBhc3N1bWUgNGtCIHBhZ2Ugc2l6ZSB3aGlsZSB1c2luZyBzb2Z0cGluLiAgVGhh
dCBhc3N1bXB0aW9uCm1heSBiZSB3cm9uZyBvbiBmdXR1cmUgR0VNIGJhY2tlbmRzIHdpdGggcG9z
c2libHkgbGFyZ2VyIG1pbmltdW0gcGFnZQpzaXplcy4gIEFzIGEgcmVzdWx0LCB0aG9zZSB0ZXN0
cyBtYXkgZWl0aGVyIGZhaWwgb24gc29mdHBpbiBhdCBvZmZzZXRzCndoaWNoIGFyZSBpbmNvcnJl
Y3RseSBhbGlnbmVkLCBtYXkgc2lsZW50bHkgc2tpcCBzdWNoIGluY29ycmVjdGx5CmFsaWduZWQg
YWRkcmVzc2VzIGFzc3VtaW5nIHRoZW0gb2NjdXBpZWQgYnkgb3RoZXIgdXNlcnMsIG9yIG1heSBh
bHdheXMKc3VjY2VlZCB3aGVuIGV4YW1pbmluZyBpbnZhbGlkIHVzZSBwYXR0ZXJucy4KClByb3Zp
ZGUgYSBoZWxwZXIgZnVuY3Rpb24gdGhhdCBkZXRlY3RzIG1pbmltdW0gcGFnZSBzaXplIGFuZCBy
ZXR1cm5zCnRoZSBzaXplIG9yZGVyLiAgVGVzdHMgbWF5IHVzZSBpdCB0byBjYWxjdWxhdGUgc29m
dHBpbiBvZmZzZXRzIHN1aXRhYmxlCmZvciBhY3R1YWxseSB1c2VkIGJhY2tpbmcgc3RvcmUuCgpT
aWduZWQtb2ZmLWJ5OiBKYW51c3ogS3J6eXN6dG9maWsgPGphbnVzei5rcnp5c3p0b2Zpa0BsaW51
eC5pbnRlbC5jb20+CkNjOiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4K
Q2M6IERhbmllbGUgQ2VyYW9sbyBTcHVyaW8gPGRhbmllbGUuY2VyYW9sb3NwdXJpb0BpbnRlbC5j
b20+CkNjOiBTdHVhcnQgU3VtbWVycyA8c3R1YXJ0LnN1bW1lcnNAaW50ZWwuY29tPgotLS0KIGxp
Yi9pb2N0bF93cmFwcGVycy5jIHwgODIgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysKIGxpYi9pb2N0bF93cmFwcGVycy5oIHwgIDEgKwogMiBmaWxlcyBjaGFuZ2Vk
LCA4MyBpbnNlcnRpb25zKCspCgpkaWZmIC0tZ2l0IGEvbGliL2lvY3RsX3dyYXBwZXJzLmMgYi9s
aWIvaW9jdGxfd3JhcHBlcnMuYwppbmRleCAyODBmZGQ2Mi4uYTQzMTM4MzIgMTAwNjQ0Ci0tLSBh
L2xpYi9pb2N0bF93cmFwcGVycy5jCisrKyBiL2xpYi9pb2N0bF93cmFwcGVycy5jCkBAIC01NCw2
ICs1NCw3IEBACiAjaW5jbHVkZSAiaW50ZWxfaW8uaCIKICNpbmNsdWRlICJpZ3RfZGVidWdmcy5o
IgogI2luY2x1ZGUgImlndF9zeXNmcy5oIgorI2luY2x1ZGUgImlndF94ODYuaCIKICNpbmNsdWRl
ICJjb25maWcuaCIKIAogI2lmZGVmIEhBVkVfVkFMR1JJTkQKQEAgLTExNTcsNiArMTE1OCw4NyBA
QCBib29sIGdlbV9oYXNfc29mdHBpbihpbnQgZmQpCiAJcmV0dXJuIGhhc19zb2Z0cGluOwogfQog
CitzdGF0aWMgaW50IF9fbWluX3BhZ2Vfc2l6ZV9vcmRlcihpbnQgZmQsIHN0cnVjdCBkcm1faTkx
NV9nZW1fZXhlY19vYmplY3QyICpvYmosCisJCQkJIHN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY2J1
ZmZlcjIgKmViLAorCQkJCSB1aW50NjRfdCBvZmZzZXQsIGludCBtaW5fb3JkZXIsIGludCBtYXhf
b3JkZXIpCit7CisJc3RhdGljIGNvbnN0IHVpbnQzMl90IGJiZSA9IE1JX0JBVENIX0JVRkZFUl9F
TkQ7CisJdWludDY0X3QgcGFnZV9zaXplID0gMXVsbCA8PCBtYXhfb3JkZXI7CisJaW50IG9yZGVy
OworCisJaWYgKG1heF9vcmRlciA+IG1pbl9vcmRlcikgeworCQkvKiBleHBsb3JlIHVwcGVyIGhh
bGYgb2YgdGhlIG1heF9vcmRlckBvZmZzZXQgYXJlYSAqLworCQlvcmRlciA9IF9fbWluX3BhZ2Vf
c2l6ZV9vcmRlcihmZCwgb2JqLCBlYiwgb2Zmc2V0LCBtaW5fb3JkZXIsCisJCQkJCSAgICAgIG1h
eF9vcmRlciAtIDEpOworCQlpZiAob3JkZXIgPCBtYXhfb3JkZXIpCisJCQlyZXR1cm4gb3JkZXI7
CisJfQorCisJb2JqLT5vZmZzZXQgPSBnZW44X2Nhbm9uaWNhbF9hZGRyKG9mZnNldCAtIHBhZ2Vf
c2l6ZSk7CisJZ2VtX3dyaXRlKGZkLCBvYmotPmhhbmRsZSwgMCwgJmJiZSwgc2l6ZW9mKGJiZSkp
OworCWlmICghX19nZW1fZXhlY2J1ZihmZCwgZWIpKSB7CisJCS8qIHVwcGVyIGhhbGYgbm90IG9j
Y3VwaWVkLCBtdXN0IGJlIHRoZSBtaW5pbXVtICovCisJCWlndF9kZWJ1ZygiZm91bmQgbWluIHBh
Z2Ugc2l6ZT0lI2xseCwgc2l6ZSBvcmRlcj0lZFxuIiwKKwkJCSAgKGxvbmcgbG9uZylwYWdlX3Np
emUsIG1heF9vcmRlcik7CisJCXJldHVybiBtYXhfb3JkZXI7CisJfQorCisJaWYgKG1heF9vcmRl
ciA+IG1pbl9vcmRlcikgeworCQkvKiBleHBsb3JlIGxvd2VyIGhhbGYgb2YgaW4gY2FzZSB0aGUg
dXBwZXIgaGFsZiB3YXMgb2NjdXBpZWQgKi8KKwkJcGFnZV9zaXplID4+PSAxOworCQlvcmRlciA9
IF9fbWluX3BhZ2Vfc2l6ZV9vcmRlcihmZCwgb2JqLCBlYiwgb2Zmc2V0IC0gcGFnZV9zaXplLAor
CQkJCQkgICAgICBtaW5fb3JkZXIsIG1heF9vcmRlciAtIDEpOworCQlpZiAob3JkZXIgPCBtYXhf
b3JkZXIpCisJCQlyZXR1cm4gb3JkZXI7CisJfQorCisJcmV0dXJuIG1heF9vcmRlciArIDE7Cit9
CisKKy8qKgorICogZ2VtX21pbl9wYWdlX3NpemVfb3JkZXI6CisgKiBAZmQ6IG9wZW4gaTkxNSBk
cm0gZmlsZSBkZXNjcmlwdG9yCisgKgorICogVGhpcyBmdW5jdGlvbiBkZXRlY3RzIHRoZSBtaW5p
bXVtIHNpemUgb2YgYSBnZW0gb2JqZWN0IGFsbG9jYXRlZCBmcm9tCisgKiBhIGRlZmF1bHQgYmFj
a2luZyBzdG9yZS4gIEl0IGlzIHVzZWZ1bCBmb3IgY2FsY3VsYXRpbmcgY29ycmVjdGx5IGFsaWdu
ZWQKKyAqIHNvZnRwaW4gb2Zmc2V0cy4KKyAqIFNpbmNlIHNpemUgb3JkZXIgdG8gc2l6ZSBjb252
ZXJzaW9uIChzaXplID0gMSA8PCBvcmRlcikgaXMgbGVzcyB0cml2aWFsCisgKiB0aGFuIHRoZSBv
cHBvc2l0ZSwgdGhlIGZ1bmN0aW9uIHJldHVybnMgdGhlIHNpemUgb3JkZXIgYXMgbW9yZSBoYW5k
eS4KKyAqCisgKiBSZXR1cm5zOgorICogU2l6ZSBvcmRlciBvZiB0aGUgbWluaW11bSBwYWdlIHNp
emUKKyAqLworaW50IGdlbV9taW5fcGFnZV9zaXplX29yZGVyKGludCBmZCkKK3sKKwlzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX2V4ZWNfb2JqZWN0MiBvYmo7CisJc3RydWN0IGRybV9pOTE1X2dlbV9leGVj
YnVmZmVyMiBlYjsKKwl1aW50NjRfdCBndHRfc2l6ZSA9IGdlbV9hcGVydHVyZV9zaXplKGZkKTsK
KwlpbnQgbWluX29yZGVyID0gMTI7CS8qIGN1cnJlbnQgSTkxNV9HVFRfUEFHRV9TSVpFIGVxdWl2
YWxlbnQgKi8KKwl1aW50NjRfdCBwYWdlX3NpemUgPSAxdWxsIDw8IG1pbl9vcmRlcjsKKwlpbnQg
bWF4X29yZGVyID0gMjE7CS8qIGN1cnJlbnQgSTkxNV9HVFRfTUFYX1BBR0VfU0laRSBlcXVpdmFs
ZW50ICovCisKKwkvKiBubyBzb2Z0cGluID0+IDRrQiBwYWdlIHNpemUgKi8KKwlpZiAoIWdlbV9o
YXNfc29mdHBpbihmZCkpCisJCXJldHVybiBtaW5fb3JkZXI7CisKKwltZW1zZXQoJm9iaiwgMCwg
c2l6ZW9mKG9iaikpOworCW1lbXNldCgmZWIsIDAsIHNpemVvZihlYikpOworCisJb2JqLmhhbmRs
ZSA9IGdlbV9jcmVhdGUoZmQsIHBhZ2Vfc2l6ZSk7CisJb2JqLmZsYWdzID0gRVhFQ19PQkpFQ1Rf
UElOTkVEIHwgRVhFQ19PQkpFQ1RfU1VQUE9SVFNfNDhCX0FERFJFU1M7CisJZWIuYnVmZmVyc19w
dHIgPSB0b191c2VyX3BvaW50ZXIoJm9iaik7CisJZWIuYnVmZmVyX2NvdW50ID0gMTsKKworCW1p
bl9vcmRlciA9IF9fbWluX3BhZ2Vfc2l6ZV9vcmRlcihmZCwgJm9iaiwgJmViLCBndHRfc2l6ZSwg
bWluX29yZGVyLAorCQkJCQkgIG1heF9vcmRlcik7CisKKwlnZW1fY2xvc2UoZmQsIG9iai5oYW5k
bGUpOworCisJaWd0X3JlcXVpcmUobWluX29yZGVyIDw9IG1heF9vcmRlcik7CisKKwlyZXR1cm4g
bWluX29yZGVyOworfQorCiAvKioKICAqIGdlbV9oYXNfZXhlY19mZW5jZToKICAqIEBmZDogb3Bl
biBpOTE1IGRybSBmaWxlIGRlc2NyaXB0b3IKZGlmZiAtLWdpdCBhL2xpYi9pb2N0bF93cmFwcGVy
cy5oIGIvbGliL2lvY3RsX3dyYXBwZXJzLmgKaW5kZXggMDMyMTFjOTcuLjkxNjkwODQ3IDEwMDY0
NAotLS0gYS9saWIvaW9jdGxfd3JhcHBlcnMuaAorKysgYi9saWIvaW9jdGxfd3JhcHBlcnMuaApA
QCAtMTM4LDYgKzEzOCw3IEBAIHVpbnQ2NF90IGdlbV9hcGVydHVyZV9zaXplKGludCBmZCk7CiB1
aW50NjRfdCBnZW1fZ2xvYmFsX2FwZXJ0dXJlX3NpemUoaW50IGZkKTsKIHVpbnQ2NF90IGdlbV9t
YXBwYWJsZV9hcGVydHVyZV9zaXplKHZvaWQpOwogYm9vbCBnZW1faGFzX3NvZnRwaW4oaW50IGZk
KTsKK2ludCBnZW1fbWluX3BhZ2Vfc2l6ZV9vcmRlcihpbnQgZmQpOwogYm9vbCBnZW1faGFzX2V4
ZWNfZmVuY2UoaW50IGZkKTsKIAogLyogY2hlY2sgZnVuY3Rpb25zIHdoaWNoIGF1dG8tc2tpcCB0
ZXN0cyBieSBjYWxsaW5nIGlndF9za2lwKCkgKi8KLS0gCjIuMjEuMAoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJ
bnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Au
b3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

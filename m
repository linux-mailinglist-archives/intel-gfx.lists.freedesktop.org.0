Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 0BA59A1363
	for <lists+intel-gfx@lfdr.de>; Thu, 29 Aug 2019 10:12:40 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 4FD3C6E054;
	Thu, 29 Aug 2019 08:12:23 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 407776E039
 for <intel-gfx@lists.freedesktop.org>; Thu, 29 Aug 2019 08:12:07 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18299873-1500050 
 for multiple; Thu, 29 Aug 2019 09:11:56 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 29 Aug 2019 09:11:29 +0100
Message-Id: <20190829081150.10271-16-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190829081150.10271-1-chris@chris-wilson.co.uk>
References: <20190829081150.10271-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 15/36] drm/i915: Coordinate i915_active with its
 own mutex
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Rm9yZ28gdGhlIHN0cnVjdF9tdXRleCBzZXJpYWxpc2F0aW9uIGZvciBpOTE1X2FjdGl2ZSwgYW5k
IGludGVycG9zZSBpdHMKb3duIG11dGV4IGhhbmRsaW5nIGZvciBhY3RpdmUvcmV0aXJlLgoKVGhp
cyBpcyBhIG11bHRpLWxheWVyZWQgc2xlaWdodC1vZi1oYW5kLiBGaXJzdCwgd2UgaGFkIHRvIGVu
c3VyZSB0aGF0IG5vCmFjdGl2ZS9yZXRpcmUgY2FsbGJhY2tzIGFjY2lkZW50YWxseSBpbnZlcnRl
ZCB0aGUgbXV0ZXggb3JkZXJpbmcgcnVsZXMsCm5vciBhc3N1bWVkIHRoYXQgdGhleSB3ZXJlIHRo
ZW1zZWx2ZXMgc2VyaWFsaXNlZCBieSBzdHJ1Y3RfbXV0ZXguIE1vcmUKY2hhbGxlbmdpbmcgdGhv
dWdoLCBpcyB0aGUgcnVsZSBvdmVyIHVwZGF0aW5nIGVsZW1lbnRzIG9mIHRoZSBhY3RpdmUKcmJ0
cmVlLiBJbnN0ZWFkIG9mIHRoZSB3aG9sZSBpOTE1X2FjdGl2ZSBub3cgYmVpbmcgc2VyaWFsaXNl
ZCBieQpzdHJ1Y3RfbXV0ZXgsIGFsbG9jYXRpb25zL3JvdGF0aW9ucyBvZiB0aGUgdHJlZSBhcmUg
c2VyaWFsaXNlZCBieSB0aGUKaTkxNV9hY3RpdmUubXV0ZXggYW5kIGluZGl2aWR1YWwgbm9kZXMg
YXJlIHNlcmlhbGlzZWQgYnkgdGhlIGNhbGxlcgp1c2luZyB0aGUgaTkxNV90aW1lbGluZS5tdXRl
eCAod2UgbmVlZCB0byB1c2UgbmVzdGVkIHNwaW5sb2NrcyB0bwppbnRlcmFjdCB3aXRoIHRoZSBk
bWFfZmVuY2UgY2FsbGJhY2sgbGlzdHMpLgoKVGhlIHBhaW4gcG9pbnQgaGVyZSBpcyB0aGF0IGlu
c3RlYWQgb2YgYSBzaW5nbGUgbXV0ZXggYXJvdW5kIGV4ZWNidWYsIHdlCm5vdyBoYXZlIHRvIHRh
a2UgYSBtdXRleCBmb3IgYWN0aXZlIHRyYWNrZXIgKG9uZSBmb3IgZWFjaCB2bWEsIGNvbnRleHQs
CmV0YykgYW5kIGEgY291cGxlIG9mIHNwaW5sb2NrcyBmb3IgZWFjaCBmZW5jZSB1cGRhdGUuIFRo
ZSBpbXByb3ZlbWVudCBpbgpmaW5lIGdyYWluZWQgbG9ja2luZyBhbGxvd2luZyBmb3IgbXVsdGlw
bGUgY29uY3VycmVudCBjbGllbnRzCihldmVudHVhbGx5ISkgc2hvdWxkIGJlIHdvcnRoIGl0IGlu
IHR5cGljYWwgbG9hZHMuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlz
LXdpbHNvbi5jby51az4KLS0tCiAuLi4vZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZnJvbnRi
dWZmZXIuYyAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfb3Zl
cmxheS5jICB8ICAgNSArLQogLi4uL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY2xpZW50X2Js
dC5jICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4
dC5jICAgfCAgIDggKy0KIC4uLi9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBl
cy5oICB8ICAgMSArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYyAgICAg
ICAgfCAgIDkgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYyAgICAg
ICB8ICAgNiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bvb2wuYyAg
IHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG9vbC5oICAg
fCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMgICAgICAgICB8
ICAxMCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfdGltZWxpbmUuYyAgICAgIHwg
ICA5ICstCiAuLi4vZ3B1L2RybS9pOTE1L2d0L2ludGVsX3RpbWVsaW5lX3R5cGVzLmggICAgfCAg
IDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2NvbnRleHQuYyAgICB8ICAx
NiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMgICAgICAgIHwgIDEw
ICstCiAuLi4vZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0cy9tb2NrX3RpbWVsaW5lLmMgfCAgIDIg
Ky0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIuYyAgICAgICAgICB8ICAgMyAt
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5jICAgICAgICAgICAgfCAzMzIgKysr
KysrKysrLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5oICAgICAg
ICAgICAgfCAzMTUgKysrLS0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
YWN0aXZlX3R5cGVzLmggICAgICB8ICAyMCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9n
ZW0uYyAgICAgICAgICAgICAgIHwgIDQyICsrLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9n
ZW1fZ3R0LmMgICAgICAgICAgIHwgICAzICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dw
dV9lcnJvci5jICAgICAgICAgfCAgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVx
dWVzdC5jICAgICAgICAgICB8ICAzOSArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1
ZXN0LmggICAgICAgICAgIHwgICAxIC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMg
ICAgICAgICAgICAgICB8ICAgOCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5
MTVfYWN0aXZlLmMgIHwgIDM2ICstCiAyNiBmaWxlcyBjaGFuZ2VkLCAzMTQgaW5zZXJ0aW9ucygr
KSwgNTc1IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfZnJvbnRidWZmZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfZnJvbnRidWZmZXIuYwppbmRleCA2NDI4YjhkZDcwZDMuLjg0YjE2NGYzMTg5NSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mcm9udGJ1ZmZlci5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZnJvbnRidWZmZXIuYwpA
QCAtMjU3LDcgKzI1Nyw3IEBAIGludGVsX2Zyb250YnVmZmVyX2dldChzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqKQogCWZyb250LT5vYmogPSBvYmo7CiAJa3JlZl9pbml0KCZmcm9udC0+
cmVmKTsKIAlhdG9taWNfc2V0KCZmcm9udC0+Yml0cywgMCk7Ci0JaTkxNV9hY3RpdmVfaW5pdChp
OTE1LCAmZnJvbnQtPndyaXRlLAorCWk5MTVfYWN0aXZlX2luaXQoJmZyb250LT53cml0ZSwKIAkJ
CSBmcm9udGJ1ZmZlcl9hY3RpdmUsCiAJCQkgaTkxNV9hY3RpdmVfbWF5X3NsZWVwKGZyb250YnVm
ZmVyX3JldGlyZSkpOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX292ZXJsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfb3Zl
cmxheS5jCmluZGV4IDRmMzY1NTdiM2YzYi4uNTQ0ZTk1MzM0MmVhIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX292ZXJsYXkuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX292ZXJsYXkuYwpAQCAtMjMwLDcgKzIzMCw3IEBAIGFs
bG9jX3JlcXVlc3Qoc3RydWN0IGludGVsX292ZXJsYXkgKm92ZXJsYXksIHZvaWQgKCpmbikoc3Ry
dWN0IGludGVsX292ZXJsYXkgKikpCiAJaWYgKElTX0VSUihycSkpCiAJCXJldHVybiBycTsKIAot
CWVyciA9IGk5MTVfYWN0aXZlX3JlZigmb3ZlcmxheS0+bGFzdF9mbGlwLCBycS0+dGltZWxpbmUs
IHJxKTsKKwllcnIgPSBpOTE1X2FjdGl2ZV9yZWYoJm92ZXJsYXktPmxhc3RfZmxpcCwgcnEtPnRp
bWVsaW5lLCAmcnEtPmZlbmNlKTsKIAlpZiAoZXJyKSB7CiAJCWk5MTVfcmVxdWVzdF9hZGQocnEp
OwogCQlyZXR1cm4gRVJSX1BUUihlcnIpOwpAQCAtMTM2MCw4ICsxMzYwLDcgQEAgdm9pZCBpbnRl
bF9vdmVybGF5X3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlvdmVy
bGF5LT5jb250cmFzdCA9IDc1OwogCW92ZXJsYXktPnNhdHVyYXRpb24gPSAxNDY7CiAKLQlpOTE1
X2FjdGl2ZV9pbml0KGRldl9wcml2LAotCQkJICZvdmVybGF5LT5sYXN0X2ZsaXAsCisJaTkxNV9h
Y3RpdmVfaW5pdCgmb3ZlcmxheS0+bGFzdF9mbGlwLAogCQkJIE5VTEwsIGludGVsX292ZXJsYXlf
bGFzdF9mbGlwX3JldGlyZSk7CiAKIAlyZXQgPSBnZXRfcmVnaXN0ZXJzKG92ZXJsYXksIE9WRVJM
QVlfTkVFRFNfUEhZU0lDQUwoZGV2X3ByaXYpKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9jbGllbnRfYmx0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fY2xpZW50X2JsdC5jCmluZGV4IGVjMDJmYzYyZGJjYi4uNTQyZjhlMmNmY2M3
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY2xpZW50X2Js
dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jbGllbnRfYmx0LmMK
QEAgLTE2OSw3ICsxNjksNyBAQCBzdGF0aWMgaW50IG1vdmVfdG9fYWN0aXZlKHN0cnVjdCBpOTE1
X3ZtYSAqdm1hLCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIAkJfQogCX0KIAotCXJldHVybiBp
OTE1X2FjdGl2ZV9yZWYoJnZtYS0+YWN0aXZlLCBycS0+dGltZWxpbmUsIHJxKTsKKwlyZXR1cm4g
aTkxNV9hY3RpdmVfcmVmKCZ2bWEtPmFjdGl2ZSwgcnEtPnRpbWVsaW5lLCAmcnEtPmZlbmNlKTsK
IH0KIAogc3RhdGljIHZvaWQgY2xlYXJfcGFnZXNfd29ya2VyKHN0cnVjdCB3b3JrX3N0cnVjdCAq
d29yaykKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250
ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCmluZGV4
IDM3OGJhOWEyY2Q4YS4uZDNjZThiNWJjY2M1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9jb250ZXh0LmMKQEAgLTg2OCwyMCArODY4LDE4IEBAIHN0YXRpYyBpbnQgY29u
dGV4dF9iYXJyaWVyX3Rhc2soc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKIAkJCQl2b2lk
ICgqdGFzaykodm9pZCAqZGF0YSksCiAJCQkJdm9pZCAqZGF0YSkKIHsKLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IGN0eC0+aTkxNTsKIAlzdHJ1Y3QgY29udGV4dF9iYXJyaWVyX3Rh
c2sgKmNiOwogCXN0cnVjdCBpOTE1X2dlbV9lbmdpbmVzX2l0ZXIgaXQ7CiAJc3RydWN0IGludGVs
X2NvbnRleHQgKmNlOwogCWludCBlcnIgPSAwOwogCi0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkx
NS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJR0VNX0JVR19PTighdGFzayk7CiAKIAljYiA9IGttYWxs
b2Moc2l6ZW9mKCpjYiksIEdGUF9LRVJORUwpOwogCWlmICghY2IpCiAJCXJldHVybiAtRU5PTUVN
OwogCi0JaTkxNV9hY3RpdmVfaW5pdChpOTE1LCAmY2ItPmJhc2UsIE5VTEwsIGNiX3JldGlyZSk7
CisJaTkxNV9hY3RpdmVfaW5pdCgmY2ItPmJhc2UsIE5VTEwsIGNiX3JldGlyZSk7CiAJZXJyID0g
aTkxNV9hY3RpdmVfYWNxdWlyZSgmY2ItPmJhc2UpOwogCWlmIChlcnIpIHsKIAkJa2ZyZWUoY2Ip
OwpAQCAtOTEzLDcgKzkxMSw5IEBAIHN0YXRpYyBpbnQgY29udGV4dF9iYXJyaWVyX3Rhc2soc3Ry
dWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKIAkJaWYgKGVtaXQpCiAJCQllcnIgPSBlbWl0KHJx
LCBkYXRhKTsKIAkJaWYgKGVyciA9PSAwKQotCQkJZXJyID0gaTkxNV9hY3RpdmVfcmVmKCZjYi0+
YmFzZSwgcnEtPnRpbWVsaW5lLCBycSk7CisJCQllcnIgPSBpOTE1X2FjdGl2ZV9yZWYoJmNiLT5i
YXNlLAorCQkJCQkgICAgICBycS0+dGltZWxpbmUsCisJCQkJCSAgICAgICZycS0+ZmVuY2UpOwog
CiAJCWk5MTVfcmVxdWVzdF9hZGQocnEpOwogCQlpZiAoZXJyKQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oCmluZGV4IGIwNTUwNzI3ZTY5YS4u
MDNlMWUzMjA2YWIzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fb2JqZWN0X3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X29iamVjdF90eXBlcy5oCkBAIC04LDYgKzgsNyBAQAogI2RlZmluZSBfX0k5MTVfR0VNX09CSkVD
VF9UWVBFU19IX18KIAogI2luY2x1ZGUgPGRybS9kcm1fZ2VtLmg+CisjaW5jbHVkZSA8dWFwaS9k
cm0vaTkxNV9kcm0uaD4KIAogI2luY2x1ZGUgImk5MTVfYWN0aXZlLmgiCiAjaW5jbHVkZSAiaTkx
NV9zZWxmdGVzdC5oIgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYwppbmRleCA5
MmU1M2MyNTQyNGMuLjkyNTU4ZmE0NzEwOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX3BtLmMKQEAgLTE2LDE0ICsxNiwxMSBAQCBzdGF0aWMgdm9pZCBjYWxsX2lkbGVfYmFycmll
cnMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCXN0cnVjdCBsbGlzdF9ub2RlICpu
b2RlLCAqbmV4dDsKIAogCWxsaXN0X2Zvcl9lYWNoX3NhZmUobm9kZSwgbmV4dCwgbGxpc3RfZGVs
X2FsbCgmZW5naW5lLT5iYXJyaWVyX3Rhc2tzKSkgewotCQlzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVx
dWVzdCAqYWN0aXZlID0KKwkJc3RydWN0IGRtYV9mZW5jZV9jYiAqY2IgPQogCQkJY29udGFpbmVy
X29mKChzdHJ1Y3QgbGlzdF9oZWFkICopbm9kZSwKLQkJCQkgICAgIHR5cGVvZigqYWN0aXZlKSwg
bGluayk7CisJCQkJICAgICB0eXBlb2YoKmNiKSwgbm9kZSk7CiAKLQkJSU5JVF9MSVNUX0hFQUQo
JmFjdGl2ZS0+bGluayk7Ci0JCVJDVV9JTklUX1BPSU5URVIoYWN0aXZlLT5yZXF1ZXN0LCBOVUxM
KTsKLQotCQlhY3RpdmUtPnJldGlyZShhY3RpdmUsIE5VTEwpOworCQljYi0+ZnVuYyhOVUxMLCBj
Yik7CiAJfQogfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9j
b250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMKaW5kZXgg
YWU3YzI2ODllZjMwLi41N2UxM2M2ZjU5YzUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2NvbnRleHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9jb250ZXh0LmMKQEAgLTI0MCw3ICsyNDAsNyBAQCBpbnRlbF9jb250ZXh0X2luaXQoc3RydWN0
IGludGVsX2NvbnRleHQgKmNlLAogCiAJbXV0ZXhfaW5pdCgmY2UtPnBpbl9tdXRleCk7CiAKLQlp
OTE1X2FjdGl2ZV9pbml0KGN0eC0+aTkxNSwgJmNlLT5hY3RpdmUsCisJaTkxNV9hY3RpdmVfaW5p
dCgmY2UtPmFjdGl2ZSwKIAkJCSBfX2ludGVsX2NvbnRleHRfYWN0aXZlLCBfX2ludGVsX2NvbnRl
eHRfcmV0aXJlKTsKIH0KIApAQCAtMzA3LDcgKzMwNyw3IEBAIGludCBpbnRlbF9jb250ZXh0X3By
ZXBhcmVfcmVtb3RlX3JlcXVlc3Qoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAogCQkJcmV0dXJu
IGVycjsKIAogCQkvKiBRdWV1ZSB0aGlzIHN3aXRjaCBhZnRlciBjdXJyZW50IGFjdGl2aXR5IGJ5
IHRoaXMgY29udGV4dC4gKi8KLQkJZXJyID0gaTkxNV9hY3RpdmVfcmVxdWVzdF9zZXQoJnRsLT5s
YXN0X3JlcXVlc3QsIHJxKTsKKwkJZXJyID0gaTkxNV9hY3RpdmVfZmVuY2Vfc2V0KCZ0bC0+bGFz
dF9yZXF1ZXN0LCBycSk7CiAJCW11dGV4X3VubG9jaygmdGwtPm11dGV4KTsKIAkJaWYgKGVycikK
IAkJCXJldHVybiBlcnI7CkBAIC0zMjEsNyArMzIxLDcgQEAgaW50IGludGVsX2NvbnRleHRfcHJl
cGFyZV9yZW1vdGVfcmVxdWVzdChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCiAJICogd29yZHMg
dHJhbnNmZXIgdGhlIHBpbm5lZCBjZSBvYmplY3QgdG8gdHJhY2tlZCBhY3RpdmUgcmVxdWVzdC4K
IAkgKi8KIAlHRU1fQlVHX09OKGk5MTVfYWN0aXZlX2lzX2lkbGUoJmNlLT5hY3RpdmUpKTsKLQly
ZXR1cm4gaTkxNV9hY3RpdmVfcmVmKCZjZS0+YWN0aXZlLCBycS0+dGltZWxpbmUsIHJxKTsKKwly
ZXR1cm4gaTkxNV9hY3RpdmVfcmVmKCZjZS0+YWN0aXZlLCBycS0+dGltZWxpbmUsICZycS0+ZmVu
Y2UpOwogfQogCiBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICppbnRlbF9jb250ZXh0X2NyZWF0ZV9yZXF1
ZXN0KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wb29sLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9lbmdpbmVfcG9vbC5jCmluZGV4IDgxZmFiMTAxZmRiNC4uM2NkYmQ1ZjhiNWJlIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG9vbC5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wb29sLmMKQEAgLTk1LDcgKzk1
LDcgQEAgbm9kZV9jcmVhdGUoc3RydWN0IGludGVsX2VuZ2luZV9wb29sICpwb29sLCBzaXplX3Qg
c3opCiAJCXJldHVybiBFUlJfUFRSKC1FTk9NRU0pOwogCiAJbm9kZS0+cG9vbCA9IHBvb2w7Ci0J
aTkxNV9hY3RpdmVfaW5pdChlbmdpbmUtPmk5MTUsICZub2RlLT5hY3RpdmUsIHBvb2xfYWN0aXZl
LCBwb29sX3JldGlyZSk7CisJaTkxNV9hY3RpdmVfaW5pdCgmbm9kZS0+YWN0aXZlLCBwb29sX2Fj
dGl2ZSwgcG9vbF9yZXRpcmUpOwogCiAJb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRl
cm5hbChlbmdpbmUtPmk5MTUsIHN6KTsKIAlpZiAoSVNfRVJSKG9iaikpIHsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wb29sLmggYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG9vbC5oCmluZGV4IDdlMjEyM2IzMzU5NC4uNGIw
ZjNhZTBjN2UyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdp
bmVfcG9vbC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wb29s
LmgKQEAgLTE4LDcgKzE4LDcgQEAgc3RhdGljIGlubGluZSBpbnQKIGludGVsX2VuZ2luZV9wb29s
X21hcmtfYWN0aXZlKHN0cnVjdCBpbnRlbF9lbmdpbmVfcG9vbF9ub2RlICpub2RlLAogCQkJICAg
ICAgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiB7Ci0JcmV0dXJuIGk5MTVfYWN0aXZlX3JlZigm
bm9kZS0+YWN0aXZlLCBycS0+dGltZWxpbmUsIHJxKTsKKwlyZXR1cm4gaTkxNV9hY3RpdmVfcmVm
KCZub2RlLT5hY3RpdmUsIHJxLT50aW1lbGluZSwgJnJxLT5mZW5jZSk7CiB9CiAKIHN0YXRpYyBp
bmxpbmUgdm9pZApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVz
ZXQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMKaW5kZXggYjlkODRk
NTJlOTg2Li40ODI1YzgyYWVmZWUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX3Jlc2V0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQu
YwpAQCAtODE0LDEwICs4MTQsMTAgQEAgc3RhdGljIGJvb2wgX19pbnRlbF9ndF91bnNldF93ZWRn
ZWQoc3RydWN0IGludGVsX2d0ICpndCkKIAkgKi8KIAlzcGluX2xvY2tfaXJxc2F2ZSgmdGltZWxp
bmVzLT5sb2NrLCBmbGFncyk7CiAJbGlzdF9mb3JfZWFjaF9lbnRyeSh0bCwgJnRpbWVsaW5lcy0+
YWN0aXZlX2xpc3QsIGxpbmspIHsKLQkJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7CisJCXN0cnVj
dCBkbWFfZmVuY2UgKmZlbmNlOwogCi0JCXJxID0gaTkxNV9hY3RpdmVfcmVxdWVzdF9nZXRfdW5s
b2NrZWQoJnRsLT5sYXN0X3JlcXVlc3QpOwotCQlpZiAoIXJxKQorCQlmZW5jZSA9IGk5MTVfYWN0
aXZlX2ZlbmNlX2dldCgmdGwtPmxhc3RfcmVxdWVzdCk7CisJCWlmICghZmVuY2UpCiAJCQljb250
aW51ZTsKIAogCQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZ0aW1lbGluZXMtPmxvY2ssIGZsYWdz
KTsKQEAgLTgyOSw4ICs4MjksOCBAQCBzdGF0aWMgYm9vbCBfX2ludGVsX2d0X3Vuc2V0X3dlZGdl
ZChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogCQkgKiAoSTkxNV9GRU5DRV9USU1FT1VUKSBzbyB0aGlz
IHdhaXQgc2hvdWxkIG5vdCBiZSB1bmJvdW5kZWQKIAkJICogaW4gdGhlIHdvcnN0IGNhc2UuCiAJ
CSAqLwotCQlkbWFfZmVuY2VfZGVmYXVsdF93YWl0KCZycS0+ZmVuY2UsIGZhbHNlLCBNQVhfU0NI
RURVTEVfVElNRU9VVCk7Ci0JCWk5MTVfcmVxdWVzdF9wdXQocnEpOworCQlkbWFfZmVuY2VfZGVm
YXVsdF93YWl0KGZlbmNlLCBmYWxzZSwgTUFYX1NDSEVEVUxFX1RJTUVPVVQpOworCQlkbWFfZmVu
Y2VfcHV0KGZlbmNlKTsKIAogCQkvKiBSZXN0YXJ0IGl0ZXJhdGlvbiBhZnRlciBkcm9waW5nIGxv
Y2sgKi8KIAkJc3Bpbl9sb2NrX2lycXNhdmUoJnRpbWVsaW5lcy0+bG9jaywgZmxhZ3MpOwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfdGltZWxpbmUuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3RpbWVsaW5lLmMKaW5kZXggZDgyNGJjYTQzZDU1Li43
NWQ4OTYxNjdjZmIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Rp
bWVsaW5lLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfdGltZWxpbmUuYwpA
QCAtMTc4LDggKzE3OCw3IEBAIGNhY2hlbGluZV9hbGxvYyhzdHJ1Y3QgaW50ZWxfdGltZWxpbmVf
aHdzcCAqaHdzcCwgdW5zaWduZWQgaW50IGNhY2hlbGluZSkKIAljbC0+aHdzcCA9IGh3c3A7CiAJ
Y2wtPnZhZGRyID0gcGFnZV9wYWNrX2JpdHModmFkZHIsIGNhY2hlbGluZSk7CiAKLQlpOTE1X2Fj
dGl2ZV9pbml0KGh3c3AtPmd0LT5pOTE1LCAmY2wtPmFjdGl2ZSwKLQkJCSBfX2NhY2hlbGluZV9h
Y3RpdmUsIF9fY2FjaGVsaW5lX3JldGlyZSk7CisJaTkxNV9hY3RpdmVfaW5pdCgmY2wtPmFjdGl2
ZSwgX19jYWNoZWxpbmVfYWN0aXZlLCBfX2NhY2hlbGluZV9yZXRpcmUpOwogCiAJcmV0dXJuIGNs
OwogfQpAQCAtMjU1LDcgKzI1NCw3IEBAIGludCBpbnRlbF90aW1lbGluZV9pbml0KHN0cnVjdCBp
bnRlbF90aW1lbGluZSAqdGltZWxpbmUsCiAKIAltdXRleF9pbml0KCZ0aW1lbGluZS0+bXV0ZXgp
OwogCi0JSU5JVF9BQ1RJVkVfUkVRVUVTVCgmdGltZWxpbmUtPmxhc3RfcmVxdWVzdCwgJnRpbWVs
aW5lLT5tdXRleCk7CisJSU5JVF9BQ1RJVkVfRkVOQ0UoJnRpbWVsaW5lLT5sYXN0X3JlcXVlc3Qs
ICZ0aW1lbGluZS0+bXV0ZXgpOwogCUlOSVRfTElTVF9IRUFEKCZ0aW1lbGluZS0+cmVxdWVzdHMp
OwogCiAJaTkxNV9zeW5jbWFwX2luaXQoJnRpbWVsaW5lLT5zeW5jKTsKQEAgLTQ0Myw3ICs0NDIs
NyBAQCBfX2ludGVsX3RpbWVsaW5lX2dldF9zZXFubyhzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRs
LAogCSAqIGZyZWUgaXQgYWZ0ZXIgdGhlIGN1cnJlbnQgcmVxdWVzdCBpcyByZXRpcmVkLCB3aGlj
aCBlbnN1cmVzIHRoYXQKIAkgKiBhbGwgd3JpdGVzIGludG8gdGhlIGNhY2hlbGluZSBmcm9tIHBy
ZXZpb3VzIHJlcXVlc3RzIGFyZSBjb21wbGV0ZS4KIAkgKi8KLQllcnIgPSBpOTE1X2FjdGl2ZV9y
ZWYoJnRsLT5od3NwX2NhY2hlbGluZS0+YWN0aXZlLCB0bCwgcnEpOworCWVyciA9IGk5MTVfYWN0
aXZlX3JlZigmdGwtPmh3c3BfY2FjaGVsaW5lLT5hY3RpdmUsIHRsLCAmcnEtPmZlbmNlKTsKIAlp
ZiAoZXJyKQogCQlnb3RvIGVycl9jYWNoZWxpbmU7CiAKQEAgLTQ5NCw3ICs0OTMsNyBAQCBpbnQg
aW50ZWxfdGltZWxpbmVfZ2V0X3NlcW5vKHN0cnVjdCBpbnRlbF90aW1lbGluZSAqdGwsCiBzdGF0
aWMgaW50IGNhY2hlbGluZV9yZWYoc3RydWN0IGludGVsX3RpbWVsaW5lX2NhY2hlbGluZSAqY2ws
CiAJCQkgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiB7Ci0JcmV0dXJuIGk5MTVfYWN0aXZlX3Jl
ZigmY2wtPmFjdGl2ZSwgcnEtPnRpbWVsaW5lLCBycSk7CisJcmV0dXJuIGk5MTVfYWN0aXZlX3Jl
ZigmY2wtPmFjdGl2ZSwgcnEtPnRpbWVsaW5lLCAmcnEtPmZlbmNlKTsKIH0KIAogaW50IGludGVs
X3RpbWVsaW5lX3JlYWRfaHdzcChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpmcm9tLApkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfdGltZWxpbmVfdHlwZXMuaCBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3RpbWVsaW5lX3R5cGVzLmgKaW5kZXggMmIxYmFmMmZj
YzhlLi42ZDdhYzEyOWNlOGEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX3RpbWVsaW5lX3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
dGltZWxpbmVfdHlwZXMuaApAQCAtNjMsNyArNjMsNyBAQCBzdHJ1Y3QgaW50ZWxfdGltZWxpbmUg
ewogCSAqIHRoZSByZXF1ZXN0IHVzaW5nIGk5MTVfYWN0aXZlX3JlcXVlc3RfZ2V0X3JlcXVlc3Rf
cmN1KCksIG9yIGhvbGQgdGhlCiAJICogc3RydWN0X211dGV4LgogCSAqLwotCXN0cnVjdCBpOTE1
X2FjdGl2ZV9yZXF1ZXN0IGxhc3RfcmVxdWVzdDsKKwlzdHJ1Y3QgaTkxNV9hY3RpdmVfZmVuY2Ug
bGFzdF9yZXF1ZXN0OwogCiAJLyoqCiAJICogV2UgdHJhY2sgdGhlIG1vc3QgcmVjZW50IHNlcW5v
IHRoYXQgd2Ugd2FpdCBvbiBpbiBldmVyeSBjb250ZXh0IHNvCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9zZWxmdGVzdF9jb250ZXh0LmMKaW5kZXggOWQxZWEyNmM3YTJkLi4xNDIwNTMzZThmZDUg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2NvbnRleHQuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9jb250ZXh0LmMKQEAgLTQxLDI0
ICs0MSwyMCBAQCBzdGF0aWMgaW50IGNvbnRleHRfc3luYyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAq
Y2UpCiAKIAltdXRleF9sb2NrKCZ0bC0+bXV0ZXgpOwogCWRvIHsKLQkJc3RydWN0IGk5MTVfcmVx
dWVzdCAqcnE7CisJCXN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlOwogCQlsb25nIHRpbWVvdXQ7CiAK
LQkJcmN1X3JlYWRfbG9jaygpOwotCQlycSA9IHJjdV9kZXJlZmVyZW5jZSh0bC0+bGFzdF9yZXF1
ZXN0LnJlcXVlc3QpOwotCQlpZiAocnEpCi0JCQlycSA9IGk5MTVfcmVxdWVzdF9nZXRfcmN1KHJx
KTsKLQkJcmN1X3JlYWRfdW5sb2NrKCk7Ci0JCWlmICghcnEpCisJCWZlbmNlID0gaTkxNV9hY3Rp
dmVfZmVuY2VfZ2V0KCZ0bC0+bGFzdF9yZXF1ZXN0KTsKKwkJaWYgKCFmZW5jZSkKIAkJCWJyZWFr
OwogCi0JCXRpbWVvdXQgPSBpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgSFogLyAxMCk7CisJCXRp
bWVvdXQgPSBkbWFfZmVuY2Vfd2FpdF90aW1lb3V0KGZlbmNlLCBmYWxzZSwgSFogLyAxMCk7CiAJ
CWlmICh0aW1lb3V0IDwgMCkKIAkJCWVyciA9IHRpbWVvdXQ7CiAJCWVsc2UKLQkJCWk5MTVfcmVx
dWVzdF9yZXRpcmVfdXB0byhycSk7CisJCQlpOTE1X3JlcXVlc3RfcmV0aXJlX3VwdG8odG9fcmVx
dWVzdChmZW5jZSkpOwogCi0JCWk5MTVfcmVxdWVzdF9wdXQocnEpOworCQlkbWFfZmVuY2VfcHV0
KGZlbmNlKTsKIAl9IHdoaWxlICghZXJyKTsKIAltdXRleF91bmxvY2soJnRsLT5tdXRleCk7CiAK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKaW5kZXggZDc5MTE1ODk4OGQ2Li5h
Y2ExYjNhOWM1ZGUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0
X2xyYy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCkBAIC05
ODQsOSArOTg0LDEzIEBAIHN0YXRpYyBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpkdW1teV9yZXF1ZXN0
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAlpZiAoIXJxKQogCQlyZXR1cm4gTlVM
TDsKIAotCUlOSVRfTElTVF9IRUFEKCZycS0+YWN0aXZlX2xpc3QpOwogCXJxLT5lbmdpbmUgPSBl
bmdpbmU7CiAKKwlzcGluX2xvY2tfaW5pdCgmcnEtPmxvY2spOworCUlOSVRfTElTVF9IRUFEKCZy
cS0+ZmVuY2UuY2JfbGlzdCk7CisJcnEtPmZlbmNlLmxvY2sgPSAmcnEtPmxvY2s7CisJcnEtPmZl
bmNlLm9wcyA9ICZpOTE1X2ZlbmNlX29wczsKKwogCWk5MTVfc2NoZWRfbm9kZV9pbml0KCZycS0+
c2NoZWQpOwogCiAJLyogbWFyayB0aGlzIHJlcXVlc3QgYXMgcGVybWFuZW50bHkgaW5jb21wbGV0
ZSAqLwpAQCAtMTA3OSw4ICsxMDgzLDggQEAgc3RhdGljIGludCBsaXZlX3N1cHByZXNzX3dhaXRf
cHJlZW1wdCh2b2lkICphcmcpCiAJCQkJfQogCiAJCQkJLyogRGlzYWJsZSBORVdDTElFTlQgcHJv
bW90aW9uICovCi0JCQkJX19pOTE1X2FjdGl2ZV9yZXF1ZXN0X3NldCgmcnFbaV0tPnRpbWVsaW5l
LT5sYXN0X3JlcXVlc3QsCi0JCQkJCQkJICBkdW1teSk7CisJCQkJX19pOTE1X2FjdGl2ZV9mZW5j
ZV9zZXQoJnJxW2ldLT50aW1lbGluZS0+bGFzdF9yZXF1ZXN0LAorCQkJCQkJCSZkdW1teS0+ZmVu
Y2UpOwogCQkJCWk5MTVfcmVxdWVzdF9hZGQocnFbaV0pOwogCQkJfQogCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdHMvbW9ja190aW1lbGluZS5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RzL21vY2tfdGltZWxpbmUuYwppbmRleCA1OTgxNzBl
ZmNhZjYuLjJhNzdjMDUxZjM2YSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
c2VsZnRlc3RzL21vY2tfdGltZWxpbmUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9z
ZWxmdGVzdHMvbW9ja190aW1lbGluZS5jCkBAIC0xNSw3ICsxNSw3IEBAIHZvaWQgbW9ja190aW1l
bGluZV9pbml0KHN0cnVjdCBpbnRlbF90aW1lbGluZSAqdGltZWxpbmUsIHU2NCBjb250ZXh0KQog
CiAJbXV0ZXhfaW5pdCgmdGltZWxpbmUtPm11dGV4KTsKIAotCUlOSVRfQUNUSVZFX1JFUVVFU1Qo
JnRpbWVsaW5lLT5sYXN0X3JlcXVlc3QsICZ0aW1lbGluZS0+bXV0ZXgpOworCUlOSVRfQUNUSVZF
X0ZFTkNFKCZ0aW1lbGluZS0+bGFzdF9yZXF1ZXN0LCAmdGltZWxpbmUtPm11dGV4KTsKIAlJTklU
X0xJU1RfSEVBRCgmdGltZWxpbmUtPnJlcXVlc3RzKTsKIAogCWk5MTVfc3luY21hcF9pbml0KCZ0
aW1lbGluZS0+c3luYyk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2No
ZWR1bGVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMKaW5kZXggODk0
MGZhOGQzOTFhLi42YmViNzUzYjFlYTEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d2dC9zY2hlZHVsZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVy
LmMKQEAgLTM4NSwxMSArMzg1LDggQEAgaW50ZWxfZ3Z0X3dvcmtsb2FkX3JlcV9hbGxvYyhzdHJ1
Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xvYWQpCiB7CiAJc3RydWN0IGludGVsX3ZncHUg
KnZncHUgPSB3b3JrbG9hZC0+dmdwdTsKIAlzdHJ1Y3QgaW50ZWxfdmdwdV9zdWJtaXNzaW9uICpz
ID0gJnZncHUtPnN1Ym1pc3Npb247Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKIAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKIAotCWxv
Y2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKLQogCWlmICh3
b3JrbG9hZC0+cmVxKQogCQlyZXR1cm4gMDsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9hY3RpdmUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMK
aW5kZXggNDVjY2E2Yzk3Yzk3Li4wZDA2ZDM1OGZlNDUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9h
Y3RpdmUuYwpAQCAtMTIsNyArMTIsNyBAQAogI2luY2x1ZGUgImk5MTVfYWN0aXZlLmgiCiAjaW5j
bHVkZSAiaTkxNV9nbG9iYWxzLmgiCiAKLSNkZWZpbmUgQktMKHJlZikgKCYocmVmKS0+aTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCkKKyNkZWZpbmUgQklBUwkJQklUKDI0KQogCiAvKgogICogQWN0aXZl
IHJlZnMgbWVtb3J5IG1hbmFnZW1lbnQKQEAgLTI3LDM1ICsyNywzNSBAQCBzdGF0aWMgc3RydWN0
IGk5MTVfZ2xvYmFsX2FjdGl2ZSB7CiB9IGdsb2JhbDsKIAogc3RydWN0IGFjdGl2ZV9ub2RlIHsK
LQlzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCBiYXNlOworCXN0cnVjdCBpOTE1X2FjdGl2ZV9m
ZW5jZSBiYXNlOwogCXN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmOwogCXN0cnVjdCByYl9ub2RlIG5v
ZGU7CiAJdTY0IHRpbWVsaW5lOwogfTsKIAogc3RhdGljIGlubGluZSBzdHJ1Y3QgYWN0aXZlX25v
ZGUgKgotbm9kZV9mcm9tX2FjdGl2ZShzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZl
KQorbm9kZV9mcm9tX2FjdGl2ZShzdHJ1Y3QgaTkxNV9hY3RpdmVfZmVuY2UgKmFjdGl2ZSkKIHsK
IAlyZXR1cm4gY29udGFpbmVyX29mKGFjdGl2ZSwgc3RydWN0IGFjdGl2ZV9ub2RlLCBiYXNlKTsK
IH0KIAogI2RlZmluZSB0YWtlX3ByZWFsbG9jYXRlZF9iYXJyaWVycyh4KSBsbGlzdF9kZWxfYWxs
KCYoeCktPnByZWFsbG9jYXRlZF9iYXJyaWVycykKIAotc3RhdGljIGlubGluZSBib29sIGlzX2Jh
cnJpZXIoY29uc3Qgc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2ZSkKK3N0YXRpYyBp
bmxpbmUgYm9vbCBpc19iYXJyaWVyKGNvbnN0IHN0cnVjdCBpOTE1X2FjdGl2ZV9mZW5jZSAqYWN0
aXZlKQogewotCXJldHVybiBJU19FUlIocmN1X2FjY2Vzc19wb2ludGVyKGFjdGl2ZS0+cmVxdWVz
dCkpOworCXJldHVybiBJU19FUlIocmN1X2FjY2Vzc19wb2ludGVyKGFjdGl2ZS0+ZmVuY2UpKTsK
IH0KIAogc3RhdGljIGlubGluZSBzdHJ1Y3QgbGxpc3Rfbm9kZSAqYmFycmllcl90b19sbChzdHJ1
Y3QgYWN0aXZlX25vZGUgKm5vZGUpCiB7CiAJR0VNX0JVR19PTighaXNfYmFycmllcigmbm9kZS0+
YmFzZSkpOwotCXJldHVybiAoc3RydWN0IGxsaXN0X25vZGUgKikmbm9kZS0+YmFzZS5saW5rOwor
CXJldHVybiAoc3RydWN0IGxsaXN0X25vZGUgKikmbm9kZS0+YmFzZS5jYi5ub2RlOwogfQogCiBz
dGF0aWMgaW5saW5lIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKgogX19iYXJyaWVyX3RvX2VuZ2lu
ZShzdHJ1Y3QgYWN0aXZlX25vZGUgKm5vZGUpCiB7Ci0JcmV0dXJuIChzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICopUkVBRF9PTkNFKG5vZGUtPmJhc2UubGluay5wcmV2KTsKKwlyZXR1cm4gKHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKilSRUFEX09OQ0Uobm9kZS0+YmFzZS5jYi5ub2RlLnByZXYpOwog
fQogCiBzdGF0aWMgaW5saW5lIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKgpAQCAtNjgsNyArNjgs
NyBAQCBiYXJyaWVyX3RvX2VuZ2luZShzdHJ1Y3QgYWN0aXZlX25vZGUgKm5vZGUpCiBzdGF0aWMg
aW5saW5lIHN0cnVjdCBhY3RpdmVfbm9kZSAqYmFycmllcl9mcm9tX2xsKHN0cnVjdCBsbGlzdF9u
b2RlICp4KQogewogCXJldHVybiBjb250YWluZXJfb2YoKHN0cnVjdCBsaXN0X2hlYWQgKil4LAot
CQkJICAgIHN0cnVjdCBhY3RpdmVfbm9kZSwgYmFzZS5saW5rKTsKKwkJCSAgICBzdHJ1Y3QgYWN0
aXZlX25vZGUsIGJhc2UuY2Iubm9kZSk7CiB9CiAKICNpZiBJU19FTkFCTEVEKENPTkZJR19EUk1f
STkxNV9ERUJVR19HRU0pICYmIElTX0VOQUJMRUQoQ09ORklHX0RFQlVHX09CSkVDVFMpCkBAIC0x
MjQsOCArMTI0LDE1IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBkZWJ1Z19hY3RpdmVfYXNzZXJ0KHN0
cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKSB7IH0KIAogI2VuZGlmCiAKK3N0YXRpYyBpbmxpbmUgYm9v
bCBpc19hY3RpdmUoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCit7CisJdW5zaWduZWQgaW50IGFj
dGl2ZSA9IGF0b21pY19yZWFkKCZyZWYtPmNvdW50KTsKKworCXJldHVybiBhY3RpdmUgPj0gQklB
UzsKK30KKwogc3RhdGljIHZvaWQKLV9fYWN0aXZlX3JldGlyZShzdHJ1Y3QgaTkxNV9hY3RpdmUg
KnJlZikKK19fYWN0aXZlX3JldGlyZShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwgaW50IGNvdW50
KQogewogCXN0cnVjdCBhY3RpdmVfbm9kZSAqaXQsICpuOwogCXN0cnVjdCByYl9yb290IHJvb3Q7
CkBAIC0xMzUsNyArMTQyLDcgQEAgX19hY3RpdmVfcmV0aXJlKHN0cnVjdCBpOTE1X2FjdGl2ZSAq
cmVmKQogCUdFTV9CVUdfT04oaTkxNV9hY3RpdmVfaXNfaWRsZShyZWYpKTsKIAogCS8qIHJldHVy
biB0aGUgdW51c2VkIG5vZGVzIHRvIG91ciBzbGFiY2FjaGUgLS0gZmx1c2hpbmcgdGhlIGFsbG9j
YXRvciAqLwotCWlmIChhdG9taWNfZGVjX2FuZF90ZXN0KCZyZWYtPmNvdW50KSkgeworCWlmIChh
dG9taWNfc3ViX3JldHVybihjb3VudCwgJnJlZi0+Y291bnQpID09IDApIHsKIAkJZGVidWdfYWN0
aXZlX2RlYWN0aXZhdGUocmVmKTsKIAkJcm9vdCA9IHJlZi0+dHJlZTsKIAkJcmVmLT50cmVlID0g
UkJfUk9PVDsKQEAgLTE0OSwxMyArMTU2LDE2IEBAIF9fYWN0aXZlX3JldGlyZShzdHJ1Y3QgaTkx
NV9hY3RpdmUgKnJlZikKIAogCUdFTV9CVUdfT04ocmN1X2FjY2Vzc19wb2ludGVyKHJlZi0+ZXhj
bCkpOwogCXJidHJlZV9wb3N0b3JkZXJfZm9yX2VhY2hfZW50cnlfc2FmZShpdCwgbiwgJnJvb3Qs
IG5vZGUpIHsKLQkJR0VNX0JVR19PTihpOTE1X2FjdGl2ZV9yZXF1ZXN0X2lzc2V0KCZpdC0+YmFz
ZSkpOworCQlHRU1fQlVHX09OKGk5MTVfYWN0aXZlX2ZlbmNlX2lzc2V0KCZpdC0+YmFzZSkpOwog
CQlrbWVtX2NhY2hlX2ZyZWUoZ2xvYmFsLnNsYWJfY2FjaGUsIGl0KTsKIAl9CiAKIAkvKiBBZnRl
ciB0aGUgZmluYWwgcmV0aXJlLCB0aGUgZW50aXJlIHN0cnVjdCBtYXkgYmUgZnJlZWQgKi8KIAlp
ZiAocmVmLT5yZXRpcmUpCiAJCXJlZi0+cmV0aXJlKHJlZik7CisKKwkvKiAuLi4gZXhjZXB0IGlm
IHlvdSB3YWl0IG9uIGl0LCB5b3UgbXVzdCBtYW5hZ2UgeW91ciBvd24gcmVmZXJlbmNlcyEgKi8K
Kwl3YWtlX3VwX3ZhcihyZWYpOwogfQogCiBzdGF0aWMgdm9pZApAQCAtMTY4LDE0ICsxNzgsMTQg
QEAgYWN0aXZlX3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3cmspCiAJCXJldHVybjsKIAogCW11
dGV4X2xvY2soJnJlZi0+bXV0ZXgpOwotCV9fYWN0aXZlX3JldGlyZShyZWYpOworCV9fYWN0aXZl
X3JldGlyZShyZWYsIDEpOwogfQogCiBzdGF0aWMgdm9pZAotYWN0aXZlX3JldGlyZShzdHJ1Y3Qg
aTkxNV9hY3RpdmUgKnJlZikKK2FjdGl2ZV9yZXRpcmUoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYs
IGludCBjb3VudCkKIHsKLQlHRU1fQlVHX09OKCFhdG9taWNfcmVhZCgmcmVmLT5jb3VudCkpOwot
CWlmIChhdG9taWNfYWRkX3VubGVzcygmcmVmLT5jb3VudCwgLTEsIDEpKQorCUdFTV9CVUdfT04o
YXRvbWljX3JlYWQoJnJlZi0+Y291bnQpIDwgY291bnQpOworCWlmIChhdG9taWNfYWRkX3VubGVz
cygmcmVmLT5jb3VudCwgLWNvdW50LCBjb3VudCkpCiAJCXJldHVybjsKIAogCS8qIElmIHdlIGFy
ZSBpbnNpZGUgaW50ZXJydXB0IGNvbnRleHQgKGZlbmNlIHNpZ25hbGluZyksIGRlZmVyICovCkBA
IC0xODUsMTYgKzE5NSwxNyBAQCBhY3RpdmVfcmV0aXJlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVm
KQogCQlyZXR1cm47CiAJfQogCi0JX19hY3RpdmVfcmV0aXJlKHJlZik7CisJX19hY3RpdmVfcmV0
aXJlKHJlZiwgY291bnQpOwogfQogCiBzdGF0aWMgdm9pZAotbm9kZV9yZXRpcmUoc3RydWN0IGk5
MTVfYWN0aXZlX3JlcXVlc3QgKmJhc2UsIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQorbm9kZV9y
ZXRpcmUoc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UsIHN0cnVjdCBkbWFfZmVuY2VfY2IgKmNiKQog
ewotCWFjdGl2ZV9yZXRpcmUobm9kZV9mcm9tX2FjdGl2ZShiYXNlKS0+cmVmKTsKKwlpOTE1X2Fj
dGl2ZV9mZW5jZV9jYihmZW5jZSwgY2IpOworCWFjdGl2ZV9yZXRpcmUoY29udGFpbmVyX29mKGNi
LCBzdHJ1Y3QgYWN0aXZlX25vZGUsIGJhc2UuY2IpLT5yZWYsIDEpOwogfQogCi1zdGF0aWMgc3Ry
dWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKgorc3RhdGljIHN0cnVjdCBpOTE1X2FjdGl2ZV9mZW5j
ZSAqCiBhY3RpdmVfaW5zdGFuY2Uoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsIHN0cnVjdCBpbnRl
bF90aW1lbGluZSAqdGwpCiB7CiAJc3RydWN0IGFjdGl2ZV9ub2RlICpub2RlLCAqcHJlYWxsb2M7
CkBAIC0yMTgsNyArMjI5LDcgQEAgYWN0aXZlX2luc3RhbmNlKHN0cnVjdCBpOTE1X2FjdGl2ZSAq
cmVmLCBzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRsKQogCQlyZXR1cm4gTlVMTDsKIAogCW11dGV4
X2xvY2soJnJlZi0+bXV0ZXgpOwotCUdFTV9CVUdfT04oaTkxNV9hY3RpdmVfaXNfaWRsZShyZWYp
KTsKKwlHRU1fQlVHX09OKCFpc19hY3RpdmUocmVmKSk7CiAKIAlwYXJlbnQgPSBOVUxMOwogCXAg
PSAmcmVmLT50cmVlLnJiX25vZGU7CkBAIC0yMzgsNyArMjQ5LDcgQEAgYWN0aXZlX2luc3RhbmNl
KHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLCBzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRsKQogCX0K
IAogCW5vZGUgPSBwcmVhbGxvYzsKLQlpOTE1X2FjdGl2ZV9yZXF1ZXN0X2luaXQoJm5vZGUtPmJh
c2UsICZ0bC0+bXV0ZXgsIE5VTEwsIG5vZGVfcmV0aXJlKTsKKwlfX2k5MTVfYWN0aXZlX2ZlbmNl
X2luaXQoJm5vZGUtPmJhc2UsICZ0bC0+bXV0ZXgsIE5VTEwsIG5vZGVfcmV0aXJlKTsKIAlub2Rl
LT5yZWYgPSByZWY7CiAJbm9kZS0+dGltZWxpbmUgPSBpZHg7CiAKQEAgLTI1Myw4ICsyNjQsNyBA
QCBhY3RpdmVfaW5zdGFuY2Uoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsIHN0cnVjdCBpbnRlbF90
aW1lbGluZSAqdGwpCiAJcmV0dXJuICZub2RlLT5iYXNlOwogfQogCi12b2lkIF9faTkxNV9hY3Rp
dmVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKLQkJCXN0cnVjdCBpOTE1X2Fj
dGl2ZSAqcmVmLAordm9pZCBfX2k5MTVfYWN0aXZlX2luaXQoc3RydWN0IGk5MTVfYWN0aXZlICpy
ZWYsCiAJCQlpbnQgKCphY3RpdmUpKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKSwKIAkJCXZvaWQg
KCpyZXRpcmUpKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKSwKIAkJCXN0cnVjdCBsb2NrX2NsYXNz
X2tleSAqa2V5KQpAQCAtMjYzLDcgKzI3Myw2IEBAIHZvaWQgX19pOTE1X2FjdGl2ZV9pbml0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCiAJZGVidWdfYWN0aXZlX2luaXQocmVmKTsK
IAotCXJlZi0+aTkxNSA9IGk5MTU7CiAJcmVmLT5mbGFncyA9IDA7CiAJcmVmLT5hY3RpdmUgPSBh
Y3RpdmU7CiAJcmVmLT5yZXRpcmUgPSBwdHJfdW5wYWNrX2JpdHMocmV0aXJlLCAmYml0cywgMik7
CkBAIC0zMjksOSArMzM4LDkgQEAgX19hY3RpdmVfZGVsX2JhcnJpZXIoc3RydWN0IGk5MTVfYWN0
aXZlICpyZWYsIHN0cnVjdCBhY3RpdmVfbm9kZSAqbm9kZSkKIAogaW50IGk5MTVfYWN0aXZlX3Jl
ZihzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwKIAkJICAgIHN0cnVjdCBpbnRlbF90aW1lbGluZSAq
dGwsCi0JCSAgICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKKwkJICAgIHN0cnVjdCBkbWFfZmVu
Y2UgKmZlbmNlKQogewotCXN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmU7CisJc3Ry
dWN0IGk5MTVfYWN0aXZlX2ZlbmNlICphY3RpdmU7CiAJaW50IGVycjsKIAogCWxvY2tkZXBfYXNz
ZXJ0X2hlbGQoJnRsLT5tdXRleCk7CkBAIC0zNDEsNiArMzUwLDcgQEAgaW50IGk5MTVfYWN0aXZl
X3JlZihzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwKIAlpZiAoZXJyKQogCQlyZXR1cm4gZXJyOwog
CisJR0VNX0JVR19PTighaXNfYWN0aXZlKHJlZikpOwogCWFjdGl2ZSA9IGFjdGl2ZV9pbnN0YW5j
ZShyZWYsIHRsKTsKIAlpZiAoIWFjdGl2ZSkgewogCQllcnIgPSAtRU5PTUVNOwpAQCAtMzU0LDE0
ICszNjQsMTEgQEAgaW50IGk5MTVfYWN0aXZlX3JlZihzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwK
IAkJICogcmVxdWVzdCB0aGF0IHdlIHdhbnQgdG8gZW1pdCBvbiB0aGUga2VybmVsX2NvbnRleHQu
CiAJCSAqLwogCQlfX2FjdGl2ZV9kZWxfYmFycmllcihyZWYsIG5vZGVfZnJvbV9hY3RpdmUoYWN0
aXZlKSk7Ci0JCVJDVV9JTklUX1BPSU5URVIoYWN0aXZlLT5yZXF1ZXN0LCBOVUxMKTsKLQkJSU5J
VF9MSVNUX0hFQUQoJmFjdGl2ZS0+bGluayk7Ci0JfSBlbHNlIHsKLQkJaWYgKCFpOTE1X2FjdGl2
ZV9yZXF1ZXN0X2lzc2V0KGFjdGl2ZSkpCi0JCQlhdG9taWNfaW5jKCZyZWYtPmNvdW50KTsKKwkJ
UkNVX0lOSVRfUE9JTlRFUihhY3RpdmUtPmZlbmNlLCBOVUxMKTsKKwkJYXRvbWljX2RlYygmcmVm
LT5jb3VudCk7CiAJfQotCUdFTV9CVUdfT04oIWF0b21pY19yZWFkKCZyZWYtPmNvdW50KSk7Ci0J
X19pOTE1X2FjdGl2ZV9yZXF1ZXN0X3NldChhY3RpdmUsIHJxKTsKKwlpZiAoIV9faTkxNV9hY3Rp
dmVfZmVuY2Vfc2V0KGFjdGl2ZSwgZmVuY2UpKQorCQlhdG9taWNfaW5jKCZyZWYtPmNvdW50KTsK
IAogb3V0OgogCWk5MTVfYWN0aXZlX3JlbGVhc2UocmVmKTsKQEAgLTM3NSw3ICszODIsNyBAQCBz
dGF0aWMgdm9pZCBleGNsX2NiKHN0cnVjdCBkbWFfZmVuY2UgKmYsIHN0cnVjdCBkbWFfZmVuY2Vf
Y2IgKmNiKQogCVJDVV9JTklUX1BPSU5URVIocmVmLT5leGNsLCBOVUxMKTsKIAlkbWFfZmVuY2Vf
cHV0KGYpOwogCi0JYWN0aXZlX3JldGlyZShyZWYpOworCWFjdGl2ZV9yZXRpcmUocmVmLCAxKTsK
IH0KIAogdm9pZCBpOTE1X2FjdGl2ZV9zZXRfZXhjbHVzaXZlKHN0cnVjdCBpOTE1X2FjdGl2ZSAq
cmVmLCBzdHJ1Y3QgZG1hX2ZlbmNlICpmKQpAQCAtNDA3LDE2NyArNDE0LDEwOSBAQCB2b2lkIGk5
MTVfYWN0aXZlX3NldF9leGNsdXNpdmUoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsIHN0cnVjdCBk
bWFfZmVuY2UgKmYpCiAJfQogfQogCi1pbnQgaTkxNV9hY3RpdmVfYWNxdWlyZShzdHJ1Y3QgaTkx
NV9hY3RpdmUgKnJlZikKK3N0YXRpYyBpbnQgX19hY3RpdmVfYWNxdWlyZV9pZl9idXN5KHN0cnVj
dCBpOTE1X2FjdGl2ZSAqcmVmKQogewotCWludCBlcnI7CisJdW5zaWduZWQgaW50IG9sZDsKIAog
CWRlYnVnX2FjdGl2ZV9hc3NlcnQocmVmKTsKLQlpZiAoYXRvbWljX2FkZF91bmxlc3MoJnJlZi0+
Y291bnQsIDEsIDApKQotCQlyZXR1cm4gMDsKIAotCWVyciA9IG11dGV4X2xvY2tfaW50ZXJydXB0
aWJsZSgmcmVmLT5tdXRleCk7Ci0JaWYgKGVycikKLQkJcmV0dXJuIGVycjsKLQotCWlmICghYXRv
bWljX3JlYWQoJnJlZi0+Y291bnQpICYmIHJlZi0+YWN0aXZlKQotCQllcnIgPSByZWYtPmFjdGl2
ZShyZWYpOwotCWlmICghZXJyKSB7Ci0JCWRlYnVnX2FjdGl2ZV9hY3RpdmF0ZShyZWYpOwotCQlh
dG9taWNfaW5jKCZyZWYtPmNvdW50KTsKLQl9CisJb2xkID0gYXRvbWljX3JlYWQoJnJlZi0+Y291
bnQpOworCWRvIHsKKwkJaWYgKG9sZCA9PSAwKQorCQkJcmV0dXJuIC1FQlVTWTsKIAotCW11dGV4
X3VubG9jaygmcmVmLT5tdXRleCk7CisJCWlmICh1bmxpa2VseShvbGQgKyBCSUFTICsgMSA8IG9s
ZCkpCisJCQlyZXR1cm4gLUVERUFETEs7CisJfSB3aGlsZSAoIWF0b21pY190cnlfY21weGNoZygm
cmVmLT5jb3VudCwgJm9sZCwgb2xkICsgQklBUykpOwogCi0JcmV0dXJuIGVycjsKKwlyZXR1cm4g
MDsKIH0KIAotdm9pZCBpOTE1X2FjdGl2ZV9yZWxlYXNlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVm
KQorYm9vbCBpOTE1X2FjdGl2ZV9hY3F1aXJlX2lmX2J1c3koc3RydWN0IGk5MTVfYWN0aXZlICpy
ZWYpCiB7Ci0JZGVidWdfYWN0aXZlX2Fzc2VydChyZWYpOwotCWFjdGl2ZV9yZXRpcmUocmVmKTsK
KwlyZXR1cm4gX19hY3RpdmVfYWNxdWlyZV9pZl9idXN5KHJlZikgPT0gMDsKIH0KIAotc3RhdGlj
IHZvaWQgX19hY3RpdmVfdW5ncmFiKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQorc3RhdGljIGlu
dCBfX2FjdGl2ZV9hY3F1aXJlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQogewotCWNsZWFyX2Fu
ZF93YWtlX3VwX2JpdChJOTE1X0FDVElWRV9HUkFCX0JJVCwgJnJlZi0+ZmxhZ3MpOwotfQorCXVu
c2lnbmVkIGludCBvbGQ7CiAKLWJvb2wgaTkxNV9hY3RpdmVfdHJ5Z3JhYihzdHJ1Y3QgaTkxNV9h
Y3RpdmUgKnJlZikKLXsKLQlkZWJ1Z19hY3RpdmVfYXNzZXJ0KHJlZik7CisJb2xkID0gYXRvbWlj
X3JlYWQoJnJlZi0+Y291bnQpOworCWRvIHsKKwkJaWYgKHVubGlrZWx5KG9sZCArIEJJQVMgKyAx
IDwgb2xkKSkKKwkJCXJldHVybiAtRUFHQUlOOworCX0gd2hpbGUgKCFhdG9taWNfdHJ5X2NtcHhj
aGcoJnJlZi0+Y291bnQsICZvbGQsIG9sZCArIEJJQVMpKTsKIAotCWlmICh0ZXN0X2FuZF9zZXRf
Yml0KEk5MTVfQUNUSVZFX0dSQUJfQklULCAmcmVmLT5mbGFncykpCi0JCXJldHVybiBmYWxzZTsK
LQotCWlmICghYXRvbWljX2FkZF91bmxlc3MoJnJlZi0+Y291bnQsIDEsIDApKSB7Ci0JCV9fYWN0
aXZlX3VuZ3JhYihyZWYpOwotCQlyZXR1cm4gZmFsc2U7Ci0JfQotCi0JcmV0dXJuIHRydWU7CisJ
cmV0dXJuIDA7CiB9CiAKLXZvaWQgaTkxNV9hY3RpdmVfdW5ncmFiKHN0cnVjdCBpOTE1X2FjdGl2
ZSAqcmVmKQoraW50IGk5MTVfYWN0aXZlX2FjcXVpcmUoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYp
CiB7Ci0JR0VNX0JVR19PTighdGVzdF9iaXQoSTkxNV9BQ1RJVkVfR1JBQl9CSVQsICZyZWYtPmZs
YWdzKSk7Ci0KLQlhY3RpdmVfcmV0aXJlKHJlZik7Ci0JX19hY3RpdmVfdW5ncmFiKHJlZik7Ci19
CisJaW50IGVycjsKIAotc3RhdGljIGludCBleGNsX3dhaXQoc3RydWN0IGk5MTVfYWN0aXZlICpy
ZWYpCi17Ci0Jc3RydWN0IGRtYV9mZW5jZSAqb2xkOwotCWludCBlcnIgPSAwOworCWVyciA9IF9f
YWN0aXZlX2FjcXVpcmVfaWZfYnVzeShyZWYpOworCWlmIChlcnIgIT0gLUVCVVNZKQorCQlyZXR1
cm4gZXJyOwogCi0JaWYgKCFyY3VfYWNjZXNzX3BvaW50ZXIocmVmLT5leGNsKSkKLQkJcmV0dXJu
IDA7CisJZXJyID0gbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKCZyZWYtPm11dGV4KTsKKwlpZiAo
ZXJyKQorCQlyZXR1cm4gZXJyOwogCi0JcmN1X3JlYWRfbG9jaygpOwotCW9sZCA9IGRtYV9mZW5j
ZV9nZXRfcmN1X3NhZmUoJnJlZi0+ZXhjbCk7Ci0JcmN1X3JlYWRfdW5sb2NrKCk7Ci0JaWYgKG9s
ZCkgewotCQllcnIgPSBkbWFfZmVuY2Vfd2FpdChvbGQsIHRydWUpOwotCQlkbWFfZmVuY2VfcHV0
KG9sZCk7CisJaWYgKCFhdG9taWNfcmVhZCgmcmVmLT5jb3VudCkgJiYgcmVmLT5hY3RpdmUpCisJ
CWVyciA9IHJlZi0+YWN0aXZlKHJlZik7CisJaWYgKCFlcnIpIHsKKwkJZGVidWdfYWN0aXZlX2Fj
dGl2YXRlKHJlZik7CisJCWVyciA9IF9fYWN0aXZlX2FjcXVpcmUocmVmKTsKIAl9CiAKKwltdXRl
eF91bmxvY2soJnJlZi0+bXV0ZXgpOworCiAJcmV0dXJuIGVycjsKIH0KIAordm9pZCBpOTE1X2Fj
dGl2ZV9yZWxlYXNlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQoreworCWRlYnVnX2FjdGl2ZV9h
c3NlcnQocmVmKTsKKwlhY3RpdmVfcmV0aXJlKHJlZiwgQklBUyk7Cit9CisKIGludCBpOTE1X2Fj
dGl2ZV93YWl0KHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQogewogCXN0cnVjdCBhY3RpdmVfbm9k
ZSAqaXQsICpuOwotCWludCBlcnI7CisJaW50IGVyciA9IDA7CiAKIAltaWdodF9zbGVlcCgpOwot
CW1pZ2h0X2xvY2soJnJlZi0+bXV0ZXgpOwogCi0JaWYgKGk5MTVfYWN0aXZlX2lzX2lkbGUocmVm
KSkKKwlpZiAoIWk5MTVfYWN0aXZlX2FjcXVpcmVfaWZfYnVzeShyZWYpKQogCQlyZXR1cm4gMDsK
IAotCWVyciA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmcmVmLT5tdXRleCk7Ci0JaWYgKGVy
cikKLQkJcmV0dXJuIGVycjsKLQotCWlmICghYXRvbWljX2FkZF91bmxlc3MoJnJlZi0+Y291bnQs
IDEsIDApKSB7Ci0JCW11dGV4X3VubG9jaygmcmVmLT5tdXRleCk7Ci0JCXJldHVybiAwOwotCX0K
KwkvKiBGbHVzaCBsYXp5IHNpZ25hbHMgKi8KKwlyYnRyZWVfcG9zdG9yZGVyX2Zvcl9lYWNoX2Vu
dHJ5X3NhZmUoaXQsIG4sICZyZWYtPnRyZWUsIG5vZGUpIHsKKwkJc3RydWN0IGRtYV9mZW5jZSAq
ZmVuY2U7CiAKLQllcnIgPSBleGNsX3dhaXQocmVmKTsKLQlpZiAoZXJyKQotCQlnb3RvIG91dDsK
KwkJaWYgKGlzX2JhcnJpZXIoJml0LT5iYXNlKSkgLyogdW5jb25uZWN0ZWQgaWRsZSBiYXJyaWVy
ICovCisJCQljb250aW51ZTsKIAotCXJidHJlZV9wb3N0b3JkZXJfZm9yX2VhY2hfZW50cnlfc2Fm
ZShpdCwgbiwgJnJlZi0+dHJlZSwgbm9kZSkgewotCQlpZiAoaXNfYmFycmllcigmaXQtPmJhc2Up
KSB7IC8qIHVuY29ubmVjdGVkIGlkbGUtYmFycmllciAqLwotCQkJZXJyID0gLUVCVVNZOwotCQkJ
YnJlYWs7CisJCWZlbmNlID0gaTkxNV9hY3RpdmVfZmVuY2VfZ2V0KCZpdC0+YmFzZSk7CisJCWlm
IChmZW5jZSkgeworCQkJZG1hX2ZlbmNlX2VuYWJsZV9zd19zaWduYWxpbmcoZmVuY2UpOworCQkJ
ZG1hX2ZlbmNlX3B1dChmZW5jZSk7CiAJCX0KLQotCQllcnIgPSBpOTE1X2FjdGl2ZV9yZXF1ZXN0
X3JldGlyZSgmaXQtPmJhc2UsIEJLTChyZWYpKTsKLQkJaWYgKGVycikKLQkJCWJyZWFrOwogCX0K
LQotb3V0OgotCV9fYWN0aXZlX3JldGlyZShyZWYpOworCS8qIEFueSBmZW5jZSBhZGRlZCBhZnRl
ciB0aGUgd2FpdCBiZWdpbnMgd2lsbCBub3QgYmUgYXV0by1zaWduYWxlZCAqLworCWk5MTVfYWN0
aXZlX3JlbGVhc2UocmVmKTsKIAlpZiAoZXJyKQogCQlyZXR1cm4gZXJyOwogCi0JaWYgKHdhaXRf
b25fYml0KCZyZWYtPmZsYWdzLCBJOTE1X0FDVElWRV9HUkFCX0JJVCwgVEFTS19LSUxMQUJMRSkp
Ci0JCXJldHVybiAtRUlOVFI7CisJaWYgKGlzX2FjdGl2ZShyZWYpKQorCQlyZXR1cm4gLUVBR0FJ
TjsKIAotCWZsdXNoX3dvcmsoJnJlZi0+d29yayk7Ci0JaWYgKCFpOTE1X2FjdGl2ZV9pc19pZGxl
KHJlZikpCi0JCXJldHVybiAtRUJVU1k7CisJaWYgKHdhaXRfdmFyX2V2ZW50X2ludGVycnVwdGli
bGUocmVmLCBpOTE1X2FjdGl2ZV9pc19pZGxlKHJlZikpKQorCQlyZXR1cm4gLUVJTlRSOwogCiAJ
cmV0dXJuIDA7CiB9CiAKLWludCBpOTE1X3JlcXVlc3RfYXdhaXRfYWN0aXZlX3JlcXVlc3Qoc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnEsCi0JCQkJICAgICAgc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVl
c3QgKmFjdGl2ZSkKLXsKLQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpiYXJyaWVyID0KLQkJaTkxNV9h
Y3RpdmVfcmVxdWVzdF9yYXcoYWN0aXZlLCAmcnEtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwot
Ci0JcmV0dXJuIGJhcnJpZXIgPyBpOTE1X3JlcXVlc3RfYXdhaXRfZG1hX2ZlbmNlKHJxLCAmYmFy
cmllci0+ZmVuY2UpIDogMDsKLX0KLQotaW50IGk5MTVfcmVxdWVzdF9hd2FpdF9hY3RpdmUoc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnEsIHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQotewotCXN0cnVj
dCBhY3RpdmVfbm9kZSAqaXQsICpuOwotCWludCBlcnI7Ci0KLQlpZiAoUkJfRU1QVFlfUk9PVCgm
cmVmLT50cmVlKSkKLQkJcmV0dXJuIDA7Ci0KLQkvKiBhd2FpdCBhbGxvY2F0ZXMgYW5kIHNvIHdl
IG5lZWQgdG8gYXZvaWQgaGl0dGluZyB0aGUgc2hyaW5rZXIgKi8KLQllcnIgPSBpOTE1X2FjdGl2
ZV9hY3F1aXJlKHJlZik7Ci0JaWYgKGVycikKLQkJcmV0dXJuIGVycjsKLQotCW11dGV4X2xvY2so
JnJlZi0+bXV0ZXgpOwotCXJidHJlZV9wb3N0b3JkZXJfZm9yX2VhY2hfZW50cnlfc2FmZShpdCwg
biwgJnJlZi0+dHJlZSwgbm9kZSkgewotCQllcnIgPSBpOTE1X3JlcXVlc3RfYXdhaXRfYWN0aXZl
X3JlcXVlc3QocnEsICZpdC0+YmFzZSk7Ci0JCWlmIChlcnIpCi0JCQlicmVhazsKLQl9Ci0JbXV0
ZXhfdW5sb2NrKCZyZWYtPm11dGV4KTsKLQotCWk5MTVfYWN0aXZlX3JlbGVhc2UocmVmKTsKLQly
ZXR1cm4gZXJyOwotfQotCiAjaWYgSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfREVCVUdfR0VN
KQogdm9pZCBpOTE1X2FjdGl2ZV9maW5pKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQogewpAQCAt
NTgxLDcgKzUzMCw3IEBAIHZvaWQgaTkxNV9hY3RpdmVfZmluaShzdHJ1Y3QgaTkxNV9hY3RpdmUg
KnJlZikKIAogc3RhdGljIGlubGluZSBib29sIGlzX2lkbGVfYmFycmllcihzdHJ1Y3QgYWN0aXZl
X25vZGUgKm5vZGUsIHU2NCBpZHgpCiB7Ci0JcmV0dXJuIG5vZGUtPnRpbWVsaW5lID09IGlkeCAm
JiAhaTkxNV9hY3RpdmVfcmVxdWVzdF9pc3NldCgmbm9kZS0+YmFzZSk7CisJcmV0dXJuIG5vZGUt
PnRpbWVsaW5lID09IGlkeCAmJiAhaTkxNV9hY3RpdmVfZmVuY2VfaXNzZXQoJm5vZGUtPmJhc2Up
OwogfQogCiBzdGF0aWMgc3RydWN0IGFjdGl2ZV9ub2RlICpyZXVzZV9pZGxlX2JhcnJpZXIoc3Ry
dWN0IGk5MTVfYWN0aXZlICpyZWYsIHU2NCBpZHgpCkBAIC03MDEsMTMgKzY1MCwxMyBAQCBpbnQg
aTkxNV9hY3RpdmVfYWNxdWlyZV9wcmVhbGxvY2F0ZV9iYXJyaWVyKHN0cnVjdCBpOTE1X2FjdGl2
ZSAqcmVmLAogCQkJbm9kZS0+YmFzZS5sb2NrID0KIAkJCQkmZW5naW5lLT5rZXJuZWxfY29udGV4
dC0+dGltZWxpbmUtPm11dGV4OwogI2VuZGlmCi0JCQlSQ1VfSU5JVF9QT0lOVEVSKG5vZGUtPmJh
c2UucmVxdWVzdCwgTlVMTCk7Ci0JCQlub2RlLT5iYXNlLnJldGlyZSA9IG5vZGVfcmV0aXJlOwor
CQkJUkNVX0lOSVRfUE9JTlRFUihub2RlLT5iYXNlLmZlbmNlLCBOVUxMKTsKKwkJCW5vZGUtPmJh
c2UuY2IuZnVuYyA9IG5vZGVfcmV0aXJlOwogCQkJbm9kZS0+dGltZWxpbmUgPSBpZHg7CiAJCQlu
b2RlLT5yZWYgPSByZWY7CiAJCX0KIAotCQlpZiAoIWk5MTVfYWN0aXZlX3JlcXVlc3RfaXNzZXQo
Jm5vZGUtPmJhc2UpKSB7CisJCWlmICghaTkxNV9hY3RpdmVfZmVuY2VfaXNzZXQoJm5vZGUtPmJh
c2UpKSB7CiAJCQkvKgogCQkJICogTWFyayB0aGlzIGFzIGJlaW5nICpvdXIqIHVuY29ubmVjdGVk
IHByb3RvLW5vZGUuCiAJCQkgKgpAQCAtNzE3LDggKzY2Niw4IEBAIGludCBpOTE1X2FjdGl2ZV9h
Y3F1aXJlX3ByZWFsbG9jYXRlX2JhcnJpZXIoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsCiAJCQkg
KiBhbmQgdGhlbiB3ZSBjYW4gdXNlIHRoZSByYl9ub2RlIGFuZCBsaXN0IHBvaW50ZXJzCiAJCQkg
KiBmb3Igb3VyIHRyYWNraW5nIG9mIHRoZSBwZW5kaW5nIGJhcnJpZXIuCiAJCQkgKi8KLQkJCVJD
VV9JTklUX1BPSU5URVIobm9kZS0+YmFzZS5yZXF1ZXN0LCBFUlJfUFRSKC1FQUdBSU4pKTsKLQkJ
CW5vZGUtPmJhc2UubGluay5wcmV2ID0gKHZvaWQgKillbmdpbmU7CisJCQlSQ1VfSU5JVF9QT0lO
VEVSKG5vZGUtPmJhc2UuZmVuY2UsIEVSUl9QVFIoLUVBR0FJTikpOworCQkJbm9kZS0+YmFzZS5j
Yi5ub2RlLnByZXYgPSAodm9pZCAqKWVuZ2luZTsKIAkJCWF0b21pY19pbmMoJnJlZi0+Y291bnQp
OwogCQl9CiAKQEAgLTc4NSwyNSArNzM0LDY1IEBAIHZvaWQgaTkxNV9yZXF1ZXN0X2FkZF9hY3Rp
dmVfYmFycmllcnMoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiB7CiAJc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lID0gcnEtPmVuZ2luZTsKIAlzdHJ1Y3QgbGxpc3Rfbm9kZSAqbm9kZSwg
Km5leHQ7CisJdW5zaWduZWQgbG9uZyBmbGFnczsKIAogCUdFTV9CVUdfT04oaW50ZWxfZW5naW5l
X2lzX3ZpcnR1YWwoZW5naW5lKSk7CiAJR0VNX0JVR19PTihycS0+dGltZWxpbmUgIT0gZW5naW5l
LT5rZXJuZWxfY29udGV4dC0+dGltZWxpbmUpOwogCisJbm9kZSA9IGxsaXN0X2RlbF9hbGwoJmVu
Z2luZS0+YmFycmllcl90YXNrcyk7CisJaWYgKCFub2RlKQorCQlyZXR1cm47CiAJLyoKIAkgKiBB
dHRhY2ggdGhlIGxpc3Qgb2YgcHJvdG8tZmVuY2VzIHRvIHRoZSBpbi1mbGlnaHQgcmVxdWVzdCBz
dWNoCiAJICogdGhhdCB0aGUgcGFyZW50IGk5MTVfYWN0aXZlIHdpbGwgYmUgcmVsZWFzZWQgd2hl
biB0aGlzIHJlcXVlc3QKIAkgKiBpcyByZXRpcmVkLgogCSAqLwotCWxsaXN0X2Zvcl9lYWNoX3Nh
ZmUobm9kZSwgbmV4dCwgbGxpc3RfZGVsX2FsbCgmZW5naW5lLT5iYXJyaWVyX3Rhc2tzKSkgewot
CQlSQ1VfSU5JVF9QT0lOVEVSKGJhcnJpZXJfZnJvbV9sbChub2RlKS0+YmFzZS5yZXF1ZXN0LCBy
cSk7CisJc3Bpbl9sb2NrX2lycXNhdmUoJnJxLT5sb2NrLCBmbGFncyk7CisJbGxpc3RfZm9yX2Vh
Y2hfc2FmZShub2RlLCBuZXh0LCBub2RlKSB7CisJCVJDVV9JTklUX1BPSU5URVIoYmFycmllcl9m
cm9tX2xsKG5vZGUpLT5iYXNlLmZlbmNlLCAmcnEtPmZlbmNlKTsKIAkJc21wX3dtYigpOyAvKiBz
ZXJpYWxpc2Ugd2l0aCByZXVzZV9pZGxlX2JhcnJpZXIgKi8KLQkJbGlzdF9hZGRfdGFpbCgoc3Ry
dWN0IGxpc3RfaGVhZCAqKW5vZGUsICZycS0+YWN0aXZlX2xpc3QpOworCQlsaXN0X2FkZF90YWls
KChzdHJ1Y3QgbGlzdF9oZWFkICopbm9kZSwgJnJxLT5mZW5jZS5jYl9saXN0KTsKKwl9CisJc3Bp
bl91bmxvY2tfaXJxcmVzdG9yZSgmcnEtPmxvY2ssIGZsYWdzKTsKK30KKworI2lmIElTX0VOQUJM
RUQoQ09ORklHX0RSTV9JOTE1X0RFQlVHX0dFTSkKKyNkZWZpbmUgYWN0aXZlX2lzX2hlbGQoYWN0
aXZlKSBsb2NrZGVwX2lzX2hlbGQoKGFjdGl2ZSktPmxvY2spCisjZWxzZQorI2RlZmluZSBhY3Rp
dmVfaXNfaGVsZChhY3RpdmUpIHRydWUKKyNlbmRpZgorCitzdHJ1Y3QgZG1hX2ZlbmNlICoKK19f
aTkxNV9hY3RpdmVfZmVuY2Vfc2V0KHN0cnVjdCBpOTE1X2FjdGl2ZV9mZW5jZSAqYWN0aXZlLAor
CQkJc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UpCit7CisJc3RydWN0IGRtYV9mZW5jZSAqcHJldjsK
Kwl1bnNpZ25lZCBsb25nIGZsYWdzOworCisJLyogTkI6IHVwZGF0ZXMgbXVzdCBiZSBzZXJpYWxp
c2VkIGJ5IGFuIG91dGVyIHRpbWVsaW5lIG11dGV4ICovCisJc3Bpbl9sb2NrX2lycXNhdmUoZmVu
Y2UtPmxvY2ssIGZsYWdzKTsKKwlHRU1fQlVHX09OKHRlc3RfYml0KERNQV9GRU5DRV9GTEFHX1NJ
R05BTEVEX0JJVCwgJmZlbmNlLT5mbGFncykpOworCisJcHJldiA9IHJjdV9kZXJlZmVyZW5jZV9w
cm90ZWN0ZWQoYWN0aXZlLT5mZW5jZSwgYWN0aXZlX2lzX2hlbGQoYWN0aXZlKSk7CisJaWYgKHBy
ZXYpIHsKKwkJc3Bpbl9sb2NrX25lc3RlZChwcmV2LT5sb2NrLCBTSU5HTEVfREVQVEhfTkVTVElO
Ryk7CisJCV9fbGlzdF9kZWxfZW50cnkoJmFjdGl2ZS0+Y2Iubm9kZSk7CisJCXNwaW5fdW5sb2Nr
KHByZXYtPmxvY2spOyAvKiBzZXJpYWxpc2Ugd2l0aCBwcmV2LT5jYl9saXN0ICovCisJCXByZXYg
PSByY3VfYWNjZXNzX3BvaW50ZXIoYWN0aXZlLT5mZW5jZSk7CiAJfQorCisJcmN1X2Fzc2lnbl9w
b2ludGVyKGFjdGl2ZS0+ZmVuY2UsIGZlbmNlKTsKKwlsaXN0X2FkZF90YWlsKCZhY3RpdmUtPmNi
Lm5vZGUsICZmZW5jZS0+Y2JfbGlzdCk7CisKKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKGZlbmNl
LT5sb2NrLCBmbGFncyk7CisKKwlyZXR1cm4gcHJldjsKIH0KIAotaW50IGk5MTVfYWN0aXZlX3Jl
cXVlc3Rfc2V0KHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUsCi0JCQkgICAgc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnEpCitpbnQgaTkxNV9hY3RpdmVfZmVuY2Vfc2V0KHN0cnVjdCBp
OTE1X2FjdGl2ZV9mZW5jZSAqYWN0aXZlLAorCQkJICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkK
IHsKKwlzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZTsKIAlpbnQgZXJyOwogCiAjaWYgSVNfRU5BQkxF
RChDT05GSUdfRFJNX0k5MTVfREVCVUdfR0VNKQpAQCAtODExLDE4ICs4MDAsMjUgQEAgaW50IGk5
MTVfYWN0aXZlX3JlcXVlc3Rfc2V0KHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUs
CiAjZW5kaWYKIAogCS8qIE11c3QgbWFpbnRhaW4gb3JkZXJpbmcgd3J0IHByZXZpb3VzIGFjdGl2
ZSByZXF1ZXN0cyAqLwotCWVyciA9IGk5MTVfcmVxdWVzdF9hd2FpdF9hY3RpdmVfcmVxdWVzdChy
cSwgYWN0aXZlKTsKLQlpZiAoZXJyKQotCQlyZXR1cm4gZXJyOworCXJjdV9yZWFkX2xvY2soKTsK
KwlmZW5jZSA9IF9faTkxNV9hY3RpdmVfZmVuY2Vfc2V0KGFjdGl2ZSwgJnJxLT5mZW5jZSk7CisJ
aWYgKGZlbmNlKQorCQlmZW5jZSA9IGRtYV9mZW5jZV9nZXRfcmN1KGZlbmNlKTsKKwlyY3VfcmVh
ZF91bmxvY2soKTsKKworCWlmIChmZW5jZSkgeworCQllcnIgPSBpOTE1X3JlcXVlc3RfYXdhaXRf
ZG1hX2ZlbmNlKHJxLCBmZW5jZSk7CisJCWRtYV9mZW5jZV9wdXQoZmVuY2UpOworCQlpZiAoZXJy
KQorCQkJcmV0dXJuIGVycjsKKwl9CiAKLQlfX2k5MTVfYWN0aXZlX3JlcXVlc3Rfc2V0KGFjdGl2
ZSwgcnEpOwogCXJldHVybiAwOwogfQogCi12b2lkIGk5MTVfYWN0aXZlX3JldGlyZV9ub29wKHN0
cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUsCi0JCQkgICAgIHN0cnVjdCBpOTE1X3Jl
cXVlc3QgKnJlcXVlc3QpCit2b2lkIGk5MTVfYWN0aXZlX25vb3Aoc3RydWN0IGRtYV9mZW5jZSAq
ZmVuY2UsIHN0cnVjdCBkbWFfZmVuY2VfY2IgKmNiKQogewotCS8qIFNwYWNlIGxlZnQgaW50ZW50
aW9uYWxseSBibGFuayAqLworCWk5MTVfYWN0aXZlX2ZlbmNlX2NiKGZlbmNlLCBjYik7CiB9CiAK
ICNpZiBJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9TRUxGVEVTVCkKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2FjdGl2ZS5oCmluZGV4IGJjMWM5ZDVkNGY2My4uMDVlOTQ4NzZjNzNkIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5oCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfYWN0aXZlLmgKQEAgLTEwLDcgKzEwLDEwIEBACiAjaW5jbHVkZSA8bGludXgv
bG9ja2RlcC5oPgogCiAjaW5jbHVkZSAiaTkxNV9hY3RpdmVfdHlwZXMuaCIKLSNpbmNsdWRlICJp
OTE1X3JlcXVlc3QuaCIKKworc3RydWN0IGk5MTVfcmVxdWVzdDsKK3N0cnVjdCBpbnRlbF9lbmdp
bmVfY3M7CitzdHJ1Y3QgaW50ZWxfdGltZWxpbmU7CiAKIC8qCiAgKiBXZSB0cmVhdCByZXF1ZXN0
cyBhcyBmZW5jZXMuIFRoaXMgaXMgbm90IGJlIHRvIGNvbmZ1c2VkIHdpdGggb3VyCkBAIC0yOCwz
MDggKzMxLDEwOCBAQAogICogd3JpdGUgYWNjZXNzIHNvIHRoYXQgd2UgY2FuIHBlcmZvcm0gY29u
Y3VycmVudCByZWFkIG9wZXJhdGlvbnMgYmV0d2VlbgogICogdGhlIENQVSBhbmQgR1BVIGVuZ2lu
ZXMsIGFzIHdlbGwgYXMgd2FpdGluZyBmb3IgYWxsIHJlbmRlcmluZyB0bwogICogY29tcGxldGUs
IG9yIHdhaXRpbmcgZm9yIHRoZSBsYXN0IEdQVSB1c2VyIG9mIGEgImZlbmNlIHJlZ2lzdGVyIi4g
VGhlCi0gKiBvYmplY3QgdGhlbiBlbWJlZHMgYSAjaTkxNV9hY3RpdmVfcmVxdWVzdCB0byB0cmFj
ayB0aGUgbW9zdCByZWNlbnQgKGluCisgKiBvYmplY3QgdGhlbiBlbWJlZHMgYSAjaTkxNV9hY3Rp
dmVfZmVuY2UgdG8gdHJhY2sgdGhlIG1vc3QgcmVjZW50IChpbgogICogcmV0aXJlbWVudCBvcmRl
cikgcmVxdWVzdCByZWxldmFudCBmb3IgdGhlIGRlc2lyZWQgbW9kZSBvZiBhY2Nlc3MuCi0gKiBU
aGUgI2k5MTVfYWN0aXZlX3JlcXVlc3QgaXMgdXBkYXRlZCB3aXRoIGk5MTVfYWN0aXZlX3JlcXVl
c3Rfc2V0KCkgdG8KKyAqIFRoZSAjaTkxNV9hY3RpdmVfZmVuY2UgaXMgdXBkYXRlZCB3aXRoIGk5
MTVfYWN0aXZlX2ZlbmNlX3NldCgpIHRvCiAgKiB0cmFjayB0aGUgbW9zdCByZWNlbnQgZmVuY2Ug
cmVxdWVzdCwgdHlwaWNhbGx5IHRoaXMgaXMgZG9uZSBhcyBwYXJ0IG9mCiAgKiBpOTE1X3ZtYV9t
b3ZlX3RvX2FjdGl2ZSgpLgogICoKLSAqIFdoZW4gdGhlICNpOTE1X2FjdGl2ZV9yZXF1ZXN0IGNv
bXBsZXRlcyAoaXMgcmV0aXJlZCksIGl0IHdpbGwKKyAqIFdoZW4gdGhlICNpOTE1X2FjdGl2ZV9m
ZW5jZSBjb21wbGV0ZXMgKGlzIHJldGlyZWQpLCBpdCB3aWxsCiAgKiBzaWduYWwgaXRzIGNvbXBs
ZXRpb24gdG8gdGhlIG93bmVyIHRocm91Z2ggYSBjYWxsYmFjayBhcyB3ZWxsIGFzIG1hcmsKLSAq
IGl0c2VsZiBhcyBpZGxlIChpOTE1X2FjdGl2ZV9yZXF1ZXN0LnJlcXVlc3QgPT0gTlVMTCkuIFRo
ZSBvd25lcgorICogaXRzZWxmIGFzIGlkbGUgKGk5MTVfYWN0aXZlX2ZlbmNlLnJlcXVlc3QgPT0g
TlVMTCkuIFRoZSBvd25lcgogICogY2FuIHRoZW4gcGVyZm9ybSBhbnkgYWN0aW9uLCBzdWNoIGFz
IGRlbGF5ZWQgZnJlZWluZyBvZiBhbiBhY3RpdmUKICAqIHJlc291cmNlIGluY2x1ZGluZyBpdHNl
bGYuCiAgKi8KIAotdm9pZCBpOTE1X2FjdGl2ZV9yZXRpcmVfbm9vcChzdHJ1Y3QgaTkxNV9hY3Rp
dmVfcmVxdWVzdCAqYWN0aXZlLAotCQkJICAgICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0
KTsKK3ZvaWQgaTkxNV9hY3RpdmVfbm9vcChzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSwgc3RydWN0
IGRtYV9mZW5jZV9jYiAqY2IpOwogCiAvKioKLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3RfaW5pdCAt
IHByZXBhcmVzIHRoZSBhY3Rpdml0eSB0cmFja2VyIGZvciB1c2UKKyAqIF9faTkxNV9hY3RpdmVf
ZmVuY2VfaW5pdCAtIHByZXBhcmVzIHRoZSBhY3Rpdml0eSB0cmFja2VyIGZvciB1c2UKICAqIEBh
Y3RpdmUgLSB0aGUgYWN0aXZlIHRyYWNrZXIKLSAqIEBycSAtIGluaXRpYWwgcmVxdWVzdCB0byB0
cmFjaywgY2FuIGJlIE5VTEwKKyAqIEBmZW5jZSAtIGluaXRpYWwgZmVuY2UgdG8gdHJhY2ssIGNh
biBiZSBOVUxMCiAgKiBAZnVuYyAtIGEgY2FsbGJhY2sgd2hlbiB0aGVuIHRoZSB0cmFja2VyIGlz
IHJldGlyZWQgKGJlY29tZXMgaWRsZSksCiAgKiAgICAgICAgIGNhbiBiZSBOVUxMCiAgKgotICog
aTkxNV9hY3RpdmVfcmVxdWVzdF9pbml0KCkgcHJlcGFyZXMgdGhlIGVtYmVkZGVkIEBhY3RpdmUg
c3RydWN0IGZvciB1c2UgYXMKLSAqIGFuIGFjdGl2aXR5IHRyYWNrZXIsIHRoYXQgaXMgZm9yIHRy
YWNraW5nIHRoZSBsYXN0IGtub3duIGFjdGl2ZSByZXF1ZXN0Ci0gKiBhc3NvY2lhdGVkIHdpdGgg
aXQuIFdoZW4gdGhlIGxhc3QgcmVxdWVzdCBiZWNvbWVzIGlkbGUsIHdoZW4gaXQgaXMgcmV0aXJl
ZAorICogaTkxNV9hY3RpdmVfZmVuY2VfaW5pdCgpIHByZXBhcmVzIHRoZSBlbWJlZGRlZCBAYWN0
aXZlIHN0cnVjdCBmb3IgdXNlIGFzCisgKiBhbiBhY3Rpdml0eSB0cmFja2VyLCB0aGF0IGlzIGZv
ciB0cmFja2luZyB0aGUgbGFzdCBrbm93biBhY3RpdmUgZmVuY2UKKyAqIGFzc29jaWF0ZWQgd2l0
aCBpdC4gV2hlbiB0aGUgbGFzdCBmZW5jZSBiZWNvbWVzIGlkbGUsIHdoZW4gaXQgaXMgcmV0aXJl
ZAogICogYWZ0ZXIgY29tcGxldGlvbiwgdGhlIG9wdGlvbmFsIGNhbGxiYWNrIEBmdW5jIGlzIGlu
dm9rZWQuCiAgKi8KIHN0YXRpYyBpbmxpbmUgdm9pZAotaTkxNV9hY3RpdmVfcmVxdWVzdF9pbml0
KHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUsCitfX2k5MTVfYWN0aXZlX2ZlbmNl
X2luaXQoc3RydWN0IGk5MTVfYWN0aXZlX2ZlbmNlICphY3RpdmUsCiAJCQkgc3RydWN0IG11dGV4
ICpsb2NrLAotCQkJIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAotCQkJIGk5MTVfYWN0aXZlX3Jl
dGlyZV9mbiByZXRpcmUpCisJCQkgdm9pZCAqZmVuY2UsCisJCQkgZG1hX2ZlbmNlX2Z1bmNfdCBm
bikKIHsKLQlSQ1VfSU5JVF9QT0lOVEVSKGFjdGl2ZS0+cmVxdWVzdCwgcnEpOwotCUlOSVRfTElT
VF9IRUFEKCZhY3RpdmUtPmxpbmspOwotCWFjdGl2ZS0+cmV0aXJlID0gcmV0aXJlID86IGk5MTVf
YWN0aXZlX3JldGlyZV9ub29wOworCVJDVV9JTklUX1BPSU5URVIoYWN0aXZlLT5mZW5jZSwgZmVu
Y2UpOworCWFjdGl2ZS0+Y2IuZnVuYyA9IGZuID86IGk5MTVfYWN0aXZlX25vb3A7CiAjaWYgSVNf
RU5BQkxFRChDT05GSUdfRFJNX0k5MTVfREVCVUdfR0VNKQogCWFjdGl2ZS0+bG9jayA9IGxvY2s7
CiAjZW5kaWYKIH0KIAotI2RlZmluZSBJTklUX0FDVElWRV9SRVFVRVNUKG5hbWUsIGxvY2spIFwK
LQlpOTE1X2FjdGl2ZV9yZXF1ZXN0X2luaXQoKG5hbWUpLCAobG9jayksIE5VTEwsIE5VTEwpCi0K
LS8qKgotICogaTkxNV9hY3RpdmVfcmVxdWVzdF9zZXQgLSB1cGRhdGVzIHRoZSB0cmFja2VyIHRv
IHdhdGNoIHRoZSBjdXJyZW50IHJlcXVlc3QKLSAqIEBhY3RpdmUgLSB0aGUgYWN0aXZlIHRyYWNr
ZXIKLSAqIEByZXF1ZXN0IC0gdGhlIHJlcXVlc3QgdG8gd2F0Y2gKLSAqCi0gKiBfX2k5MTVfYWN0
aXZlX3JlcXVlc3Rfc2V0KCkgd2F0Y2hlcyB0aGUgZ2l2ZW4gQHJlcXVlc3QgZm9yIGNvbXBsZXRp
b24uIFdoaWxzdAotICogdGhhdCBAcmVxdWVzdCBpcyBidXN5LCB0aGUgQGFjdGl2ZSByZXBvcnRz
IGJ1c3kuIFdoZW4gdGhhdCBAcmVxdWVzdCBpcwotICogcmV0aXJlZCwgdGhlIEBhY3RpdmUgdHJh
Y2tlciBpcyB1cGRhdGVkIHRvIHJlcG9ydCBpZGxlLgotICovCi1zdGF0aWMgaW5saW5lIHZvaWQK
LV9faTkxNV9hY3RpdmVfcmVxdWVzdF9zZXQoc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFj
dGl2ZSwKLQkJCSAgc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCkKLXsKLSNpZiBJU19FTkFC
TEVEKENPTkZJR19EUk1fSTkxNV9ERUJVR19HRU0pCi0JbG9ja2RlcF9hc3NlcnRfaGVsZChhY3Rp
dmUtPmxvY2spOwotI2VuZGlmCi0JbGlzdF9tb3ZlKCZhY3RpdmUtPmxpbmssICZyZXF1ZXN0LT5h
Y3RpdmVfbGlzdCk7Ci0JcmN1X2Fzc2lnbl9wb2ludGVyKGFjdGl2ZS0+cmVxdWVzdCwgcmVxdWVz
dCk7Ci19CisjZGVmaW5lIElOSVRfQUNUSVZFX0ZFTkNFKEEsIExPQ0spIFwKKwlfX2k5MTVfYWN0
aXZlX2ZlbmNlX2luaXQoKEEpLCAoTE9DSyksIE5VTEwsIE5VTEwpCiAKLWludCBfX211c3RfY2hl
Y2sKLWk5MTVfYWN0aXZlX3JlcXVlc3Rfc2V0KHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICph
Y3RpdmUsCi0JCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSk7CitzdHJ1Y3QgZG1hX2ZlbmNlICoK
K19faTkxNV9hY3RpdmVfZmVuY2Vfc2V0KHN0cnVjdCBpOTE1X2FjdGl2ZV9mZW5jZSAqYWN0aXZl
LAorCQkJc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UpOwogCiAvKioKLSAqIGk5MTVfYWN0aXZlX3Jl
cXVlc3RfcmF3IC0gcmV0dXJuIHRoZSBhY3RpdmUgcmVxdWVzdAorICogaTkxNV9hY3RpdmVfZmVu
Y2Vfc2V0IC0gdXBkYXRlcyB0aGUgdHJhY2tlciB0byB3YXRjaCB0aGUgY3VycmVudCBmZW5jZQog
ICogQGFjdGl2ZSAtIHRoZSBhY3RpdmUgdHJhY2tlcgorICogQHJxIC0gdGhlIHJlcXVlc3QgdG8g
d2F0Y2gKICAqCi0gKiBpOTE1X2FjdGl2ZV9yZXF1ZXN0X3JhdygpIHJldHVybnMgdGhlIGN1cnJl
bnQgcmVxdWVzdCBiZWluZyB0cmFja2VkLCBvciBOVUxMLgotICogSXQgZG9lcyBub3Qgb2J0YWlu
IGEgcmVmZXJlbmNlIG9uIHRoZSByZXF1ZXN0IGZvciB0aGUgY2FsbGVyLCBzbyB0aGUgY2FsbGVy
Ci0gKiBtdXN0IGhvbGQgc3RydWN0X211dGV4LgorICogaTkxNV9hY3RpdmVfZmVuY2Vfc2V0KCkg
d2F0Y2hlcyB0aGUgZ2l2ZW4gQHJxIGZvciBjb21wbGV0aW9uLiBXaGlsZQorICogdGhhdCBAcnEg
aXMgYnVzeSwgdGhlIEBhY3RpdmUgcmVwb3J0cyBidXN5LiBXaGVuIHRoYXQgQHJxIGlzIHNpZ25h
bGVkCisgKiAob3IgZWxzZSByZXRpcmVkKSB0aGUgQGFjdGl2ZSB0cmFja2VyIGlzIHVwZGF0ZWQg
dG8gcmVwb3J0IGlkbGUuCiAgKi8KLXN0YXRpYyBpbmxpbmUgc3RydWN0IGk5MTVfcmVxdWVzdCAq
Ci1pOTE1X2FjdGl2ZV9yZXF1ZXN0X3Jhdyhjb25zdCBzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVz
dCAqYWN0aXZlLAotCQkJc3RydWN0IG11dGV4ICptdXRleCkKLXsKLQlyZXR1cm4gcmN1X2RlcmVm
ZXJlbmNlX3Byb3RlY3RlZChhY3RpdmUtPnJlcXVlc3QsCi0JCQkJCSBsb2NrZGVwX2lzX2hlbGQo
bXV0ZXgpKTsKLX0KLQotLyoqCi0gKiBpOTE1X2FjdGl2ZV9yZXF1ZXN0X3BlZWsgLSByZXBvcnQg
dGhlIGFjdGl2ZSByZXF1ZXN0IGJlaW5nIG1vbml0b3JlZAotICogQGFjdGl2ZSAtIHRoZSBhY3Rp
dmUgdHJhY2tlcgotICoKLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3RfcGVlaygpIHJldHVybnMgdGhl
IGN1cnJlbnQgcmVxdWVzdCBiZWluZyB0cmFja2VkIGlmCi0gKiBzdGlsbCBhY3RpdmUsIG9yIE5V
TEwuIEl0IGRvZXMgbm90IG9idGFpbiBhIHJlZmVyZW5jZSBvbiB0aGUgcmVxdWVzdAotICogZm9y
IHRoZSBjYWxsZXIsIHNvIHRoZSBjYWxsZXIgbXVzdCBob2xkIHN0cnVjdF9tdXRleC4KLSAqLwot
c3RhdGljIGlubGluZSBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICoKLWk5MTVfYWN0aXZlX3JlcXVlc3Rf
cGVlayhjb25zdCBzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlLAotCQkJIHN0cnVj
dCBtdXRleCAqbXV0ZXgpCi17Ci0Jc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdDsKLQotCXJl
cXVlc3QgPSBpOTE1X2FjdGl2ZV9yZXF1ZXN0X3JhdyhhY3RpdmUsIG11dGV4KTsKLQlpZiAoIXJl
cXVlc3QgfHwgaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChyZXF1ZXN0KSkKLQkJcmV0dXJuIE5VTEw7
Ci0KLQlyZXR1cm4gcmVxdWVzdDsKLX0KLQotLyoqCi0gKiBpOTE1X2FjdGl2ZV9yZXF1ZXN0X2dl
dCAtIHJldHVybiBhIHJlZmVyZW5jZSB0byB0aGUgYWN0aXZlIHJlcXVlc3QKLSAqIEBhY3RpdmUg
LSB0aGUgYWN0aXZlIHRyYWNrZXIKLSAqCi0gKiBpOTE1X2FjdGl2ZV9yZXF1ZXN0X2dldCgpIHJl
dHVybnMgYSByZWZlcmVuY2UgdG8gdGhlIGFjdGl2ZSByZXF1ZXN0LCBvciBOVUxMCi0gKiBpZiB0
aGUgYWN0aXZlIHRyYWNrZXIgaXMgaWRsZS4gVGhlIGNhbGxlciBtdXN0IGhvbGQgc3RydWN0X211
dGV4LgotICovCi1zdGF0aWMgaW5saW5lIHN0cnVjdCBpOTE1X3JlcXVlc3QgKgotaTkxNV9hY3Rp
dmVfcmVxdWVzdF9nZXQoY29uc3Qgc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2ZSwK
LQkJCXN0cnVjdCBtdXRleCAqbXV0ZXgpCi17Ci0JcmV0dXJuIGk5MTVfcmVxdWVzdF9nZXQoaTkx
NV9hY3RpdmVfcmVxdWVzdF9wZWVrKGFjdGl2ZSwgbXV0ZXgpKTsKLX0KLQotLyoqCi0gKiBfX2k5
MTVfYWN0aXZlX3JlcXVlc3RfZ2V0X3JjdSAtIHJldHVybiBhIHJlZmVyZW5jZSB0byB0aGUgYWN0
aXZlIHJlcXVlc3QKLSAqIEBhY3RpdmUgLSB0aGUgYWN0aXZlIHRyYWNrZXIKLSAqCi0gKiBfX2k5
MTVfYWN0aXZlX3JlcXVlc3RfZ2V0KCkgcmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgYWN0aXZl
IHJlcXVlc3QsCi0gKiBvciBOVUxMIGlmIHRoZSBhY3RpdmUgdHJhY2tlciBpcyBpZGxlLiBUaGUg
Y2FsbGVyIG11c3QgaG9sZCB0aGUgUkNVIHJlYWQKLSAqIGxvY2ssIGJ1dCB0aGUgcmV0dXJuZWQg
cG9pbnRlciBpcyBzYWZlIHRvIHVzZSBvdXRzaWRlIG9mIFJDVS4KLSAqLwotc3RhdGljIGlubGlu
ZSBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICoKLV9faTkxNV9hY3RpdmVfcmVxdWVzdF9nZXRfcmN1KGNv
bnN0IHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUpCi17Ci0JLyoKLQkgKiBQZXJm
b3JtaW5nIGEgbG9ja2xlc3MgcmV0cmlldmFsIG9mIHRoZSBhY3RpdmUgcmVxdWVzdCBpcyBzdXBl
cgotCSAqIHRyaWNreS4gU0xBQl9UWVBFU0FGRV9CWV9SQ1UgbWVyZWx5IGd1YXJhbnRlZXMgdGhh
dCB0aGUgYmFja2luZwotCSAqIHNsYWIgb2YgcmVxdWVzdCBvYmplY3RzIHdpbGwgbm90IGJlIGZy
ZWVkIHdoaWxzdCB3ZSBob2xkIHRoZQotCSAqIFJDVSByZWFkIGxvY2suIEl0IGRvZXMgbm90IGd1
YXJhbnRlZSB0aGF0IHRoZSByZXF1ZXN0IGl0c2VsZgotCSAqIHdpbGwgbm90IGJlIGZyZWVkIGFu
ZCB0aGVuICpyZXVzZWQqLiBWaXosCi0JICoKLQkgKiBUaHJlYWQgQQkJCVRocmVhZCBCCi0JICoK
LQkgKiBycSA9IGFjdGl2ZS5yZXF1ZXN0Ci0JICoJCQkJcmV0aXJlKHJxKSAtPiBmcmVlKHJxKTsK
LQkgKgkJCQkocnEgaXMgbm93IGZpcnN0IG9uIHRoZSBzbGFiIGZyZWVsaXN0KQotCSAqCQkJCWFj
dGl2ZS5yZXF1ZXN0ID0gTlVMTAotCSAqCi0JICoJCQkJcnEgPSBuZXcgc3VibWlzc2lvbiBvbiBh
IG5ldyBvYmplY3QKLQkgKiByZWYocnEpCi0JICoKLQkgKiBUbyBwcmV2ZW50IHRoZSByZXF1ZXN0
IGZyb20gYmVpbmcgcmV1c2VkIHdoaWxzdCB0aGUgY2FsbGVyCi0JICogdXNlcyBpdCwgd2UgdGFr
ZSBhIHJlZmVyZW5jZSBsaWtlIG5vcm1hbC4gV2hpbHN0IGFjcXVpcmluZwotCSAqIHRoZSByZWZl
cmVuY2Ugd2UgY2hlY2sgdGhhdCBpdCBpcyBub3QgaW4gYSBkZXN0cm95ZWQgc3RhdGUKLQkgKiAo
cmVmY250ID09IDApLiBUaGF0IHByZXZlbnRzIHRoZSByZXF1ZXN0IGJlaW5nIHJlYWxsb2NhdGVk
Ci0JICogd2hpbHN0IHRoZSBjYWxsZXIgaG9sZHMgb24gdG8gaXQuIFRvIGNoZWNrIHRoYXQgdGhl
IHJlcXVlc3QKLQkgKiB3YXMgbm90IHJlYWxsb2NhdGVkIGFzIHdlIGFjcXVpcmVkIHRoZSByZWZl
cmVuY2Ugd2UgaGF2ZSB0bwotCSAqIGNoZWNrIHRoYXQgb3VyIHJlcXVlc3QgcmVtYWlucyB0aGUg
YWN0aXZlIHJlcXVlc3QgYWNyb3NzCi0JICogdGhlIGxvb2t1cCwgaW4gdGhlIHNhbWUgbWFubmVy
IGFzIGEgc2VxbG9jay4gVGhlIHZpc2liaWxpdHkKLQkgKiBvZiB0aGUgcG9pbnRlciB2ZXJzdXMg
dGhlIHJlZmVyZW5jZSBjb3VudGluZyBpcyBjb250cm9sbGVkCi0JICogYnkgdXNpbmcgUkNVIGJh
cnJpZXJzIChyY3VfZGVyZWZlcmVuY2UgYW5kIHJjdV9hc3NpZ25fcG9pbnRlcikuCi0JICoKLQkg
KiBJbiB0aGUgbWlkZGxlIG9mIGFsbCB0aGF0LCB3ZSBpbnNwZWN0IHdoZXRoZXIgdGhlIHJlcXVl
c3QgaXMKLQkgKiBjb21wbGV0ZS4gUmV0aXJpbmcgaXMgbGF6eSBzbyB0aGUgcmVxdWVzdCBtYXkg
YmUgY29tcGxldGVkIGxvbmcKLQkgKiBiZWZvcmUgdGhlIGFjdGl2ZSB0cmFja2VyIGlzIHVwZGF0
ZWQuIFF1ZXJ5aW5nIHdoZXRoZXIgdGhlCi0JICogcmVxdWVzdCBpcyBjb21wbGV0ZSBpcyBmYXIg
Y2hlYXBlciAoYXMgaXQgaW52b2x2ZXMgbm8gbG9ja2VkCi0JICogaW5zdHJ1Y3Rpb25zIHNldHRp
bmcgY2FjaGVsaW5lcyB0byBleGNsdXNpdmUpIHRoYW4gYWNxdWlyaW5nCi0JICogdGhlIHJlZmVy
ZW5jZSwgc28gd2UgZG8gaXQgZmlyc3QuIFRoZSBSQ1UgcmVhZCBsb2NrIGVuc3VyZXMgdGhlCi0J
ICogcG9pbnRlciBkZXJlZmVyZW5jZSBpcyB2YWxpZCwgYnV0IGRvZXMgbm90IGVuc3VyZSB0aGF0
IHRoZQotCSAqIHNlcW5vIG5vciBIV1MgaXMgdGhlIHJpZ2h0IG9uZSEgSG93ZXZlciwgaWYgdGhl
IHJlcXVlc3Qgd2FzCi0JICogcmVhbGxvY2F0ZWQsIHRoYXQgbWVhbnMgdGhlIGFjdGl2ZSB0cmFj
a2VyJ3MgcmVxdWVzdCB3YXMgY29tcGxldGUuCi0JICogSWYgdGhlIG5ldyByZXF1ZXN0IGlzIGFs
c28gY29tcGxldGUsIHRoZW4gYm90aCBhcmUgYW5kIHdlIGNhbgotCSAqIGp1c3QgcmVwb3J0IHRo
ZSBhY3RpdmUgdHJhY2tlciBpcyBpZGxlLiBJZiB0aGUgbmV3IHJlcXVlc3QgaXMKLQkgKiBpbmNv
bXBsZXRlLCB0aGVuIHdlIGFjcXVpcmUgYSByZWZlcmVuY2Ugb24gaXQgYW5kIGNoZWNrIHRoYXQK
LQkgKiBpdCByZW1haW5lZCB0aGUgYWN0aXZlIHJlcXVlc3QuCi0JICoKLQkgKiBJdCBpcyB0aGVu
IGltcGVyYXRpdmUgdGhhdCB3ZSBkbyBub3QgemVybyB0aGUgcmVxdWVzdCBvbgotCSAqIHJlYWxs
b2NhdGlvbiwgc28gdGhhdCB3ZSBjYW4gY2hhc2UgdGhlIGRhbmdsaW5nIHBvaW50ZXJzIQotCSAq
IFNlZSBpOTE1X3JlcXVlc3RfYWxsb2MoKS4KLQkgKi8KLQlkbyB7Ci0JCXN0cnVjdCBpOTE1X3Jl
cXVlc3QgKnJlcXVlc3Q7Ci0KLQkJcmVxdWVzdCA9IHJjdV9kZXJlZmVyZW5jZShhY3RpdmUtPnJl
cXVlc3QpOwotCQlpZiAoIXJlcXVlc3QgfHwgaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChyZXF1ZXN0
KSkKLQkJCXJldHVybiBOVUxMOwotCi0JCS8qCi0JCSAqIEFuIGVzcGVjaWFsbHkgc2lsbHkgY29t
cGlsZXIgY291bGQgZGVjaWRlIHRvIHJlY29tcHV0ZSB0aGUKLQkJICogcmVzdWx0IG9mIGk5MTVf
cmVxdWVzdF9jb21wbGV0ZWQsIG1vcmUgc3BlY2lmaWNhbGx5Ci0JCSAqIHJlLWVtaXQgdGhlIGxv
YWQgZm9yIHJlcXVlc3QtPmZlbmNlLnNlcW5vLiBBIHJhY2Ugd291bGQgY2F0Y2gKLQkJICogYSBs
YXRlciBzZXFubyB2YWx1ZSwgd2hpY2ggY291bGQgZmxpcCB0aGUgcmVzdWx0IGZyb20gdHJ1ZSB0
bwotCQkgKiBmYWxzZS4gV2hpY2ggbWVhbnMgcGFydCBvZiB0aGUgaW5zdHJ1Y3Rpb25zIGJlbG93
IG1pZ2h0IG5vdAotCQkgKiBiZSBleGVjdXRlZCwgd2hpbGUgbGF0ZXIgb24gaW5zdHJ1Y3Rpb25z
IGFyZSBleGVjdXRlZC4gRHVlIHRvCi0JCSAqIGJhcnJpZXJzIHdpdGhpbiB0aGUgcmVmY291bnRp
bmcgdGhlIGluY29uc2lzdGVuY3kgY2FuJ3QgcmVhY2gKLQkJICogcGFzdCB0aGUgY2FsbCB0byBp
OTE1X3JlcXVlc3RfZ2V0X3JjdSwgYnV0IG5vdCBleGVjdXRpbmcKLQkJICogdGhhdCB3aGlsZSBz
dGlsbCBleGVjdXRpbmcgaTkxNV9yZXF1ZXN0X3B1dCgpIGNyZWF0ZXMKLQkJICogaGF2b2MgZW5v
dWdoLiAgUHJldmVudCB0aGlzIHdpdGggYSBjb21waWxlciBiYXJyaWVyLgotCQkgKi8KLQkJYmFy
cmllcigpOwotCi0JCXJlcXVlc3QgPSBpOTE1X3JlcXVlc3RfZ2V0X3JjdShyZXF1ZXN0KTsKLQot
CQkvKgotCQkgKiBXaGF0IHN0b3BzIHRoZSBmb2xsb3dpbmcgcmN1X2FjY2Vzc19wb2ludGVyKCkg
ZnJvbSBvY2N1cnJpbmcKLQkJICogYmVmb3JlIHRoZSBhYm92ZSBpOTE1X3JlcXVlc3RfZ2V0X3Jj
dSgpPyBJZiB3ZSB3ZXJlCi0JCSAqIHRvIHJlYWQgdGhlIHZhbHVlIGJlZm9yZSBwYXVzaW5nIHRv
IGdldCB0aGUgcmVmZXJlbmNlIHRvCi0JCSAqIHRoZSByZXF1ZXN0LCB3ZSBtYXkgbm90IG5vdGlj
ZSBhIGNoYW5nZSBpbiB0aGUgYWN0aXZlCi0JCSAqIHRyYWNrZXIuCi0JCSAqCi0JCSAqIFRoZSBy
Y3VfYWNjZXNzX3BvaW50ZXIoKSBpcyBhIG1lcmUgY29tcGlsZXIgYmFycmllciwgd2hpY2gKLQkJ
ICogbWVhbnMgYm90aCB0aGUgQ1BVIGFuZCBjb21waWxlciBhcmUgZnJlZSB0byBwZXJmb3JtIHRo
ZQotCQkgKiBtZW1vcnkgcmVhZCB3aXRob3V0IGNvbnN0cmFpbnQuIFRoZSBjb21waWxlciBvbmx5
IGhhcyB0bwotCQkgKiBlbnN1cmUgdGhhdCBhbnkgb3BlcmF0aW9ucyBhZnRlciB0aGUgcmN1X2Fj
Y2Vzc19wb2ludGVyKCkKLQkJICogb2NjdXIgYWZ0ZXJ3YXJkcyBpbiBwcm9ncmFtIG9yZGVyLiBU
aGlzIG1lYW5zIHRoZSByZWFkIG1heQotCQkgKiBiZSBwZXJmb3JtZWQgZWFybGllciBieSBhbiBv
dXQtb2Ytb3JkZXIgQ1BVLCBvciBhZHZlbnR1cm91cwotCQkgKiBjb21waWxlci4KLQkJICoKLQkJ
ICogVGhlIGF0b21pYyBvcGVyYXRpb24gYXQgdGhlIGhlYXJ0IG9mCi0JCSAqIGk5MTVfcmVxdWVz
dF9nZXRfcmN1KCksIHNlZSBkbWFfZmVuY2VfZ2V0X3JjdSgpLCBpcwotCQkgKiBhdG9taWNfaW5j
X25vdF96ZXJvKCkgd2hpY2ggaXMgb25seSBhIGZ1bGwgbWVtb3J5IGJhcnJpZXIKLQkJICogd2hl
biBzdWNjZXNzZnVsLiBUaGF0IGlzLCBpZiBpOTE1X3JlcXVlc3RfZ2V0X3JjdSgpCi0JCSAqIHJl
dHVybnMgdGhlIHJlcXVlc3QgKGFuZCBzbyB3aXRoIHRoZSByZWZlcmVuY2UgY291bnRlZAotCQkg
KiBpbmNyZW1lbnRlZCkgdGhlbiB0aGUgZm9sbG93aW5nIHJlYWQgZm9yIHJjdV9hY2Nlc3NfcG9p
bnRlcigpCi0JCSAqIG11c3Qgb2NjdXIgYWZ0ZXIgdGhlIGF0b21pYyBvcGVyYXRpb24gYW5kIHNv
IGNvbmZpcm0KLQkJICogdGhhdCB0aGlzIHJlcXVlc3QgaXMgdGhlIG9uZSBjdXJyZW50bHkgYmVp
bmcgdHJhY2tlZC4KLQkJICoKLQkJICogVGhlIGNvcnJlc3BvbmRpbmcgd3JpdGUgYmFycmllciBp
cyBwYXJ0IG9mCi0JCSAqIHJjdV9hc3NpZ25fcG9pbnRlcigpLgotCQkgKi8KLQkJaWYgKCFyZXF1
ZXN0IHx8IHJlcXVlc3QgPT0gcmN1X2FjY2Vzc19wb2ludGVyKGFjdGl2ZS0+cmVxdWVzdCkpCi0J
CQlyZXR1cm4gcmN1X3BvaW50ZXJfaGFuZG9mZihyZXF1ZXN0KTsKLQotCQlpOTE1X3JlcXVlc3Rf
cHV0KHJlcXVlc3QpOwotCX0gd2hpbGUgKDEpOwotfQotCitpbnQgX19tdXN0X2NoZWNrCitpOTE1
X2FjdGl2ZV9mZW5jZV9zZXQoc3RydWN0IGk5MTVfYWN0aXZlX2ZlbmNlICphY3RpdmUsCisJCSAg
ICAgIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKTsKIC8qKgotICogaTkxNV9hY3RpdmVfcmVxdWVz
dF9nZXRfdW5sb2NrZWQgLSByZXR1cm4gYSByZWZlcmVuY2UgdG8gdGhlIGFjdGl2ZSByZXF1ZXN0
CisgKiBpOTE1X2FjdGl2ZV9mZW5jZV9nZXQgLSByZXR1cm4gYSByZWZlcmVuY2UgdG8gdGhlIGFj
dGl2ZSBmZW5jZQogICogQGFjdGl2ZSAtIHRoZSBhY3RpdmUgdHJhY2tlcgogICoKLSAqIGk5MTVf
YWN0aXZlX3JlcXVlc3RfZ2V0X3VubG9ja2VkKCkgcmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUg
YWN0aXZlIHJlcXVlc3QsCisgKiBpOTE1X2FjdGl2ZV9mZW5jZV9nZXQoKSByZXR1cm5zIGEgcmVm
ZXJlbmNlIHRvIHRoZSBhY3RpdmUgZmVuY2UsCiAgKiBvciBOVUxMIGlmIHRoZSBhY3RpdmUgdHJh
Y2tlciBpcyBpZGxlLiBUaGUgcmVmZXJlbmNlIGlzIG9idGFpbmVkIHVuZGVyIFJDVSwKICAqIHNv
IG5vIGxvY2tpbmcgaXMgcmVxdWlyZWQgYnkgdGhlIGNhbGxlci4KICAqCi0gKiBUaGUgcmVmZXJl
bmNlIHNob3VsZCBiZSBmcmVlZCB3aXRoIGk5MTVfcmVxdWVzdF9wdXQoKS4KKyAqIFRoZSByZWZl
cmVuY2Ugc2hvdWxkIGJlIGZyZWVkIHdpdGggZG1hX2ZlbmNlX3B1dCgpLgogICovCi1zdGF0aWMg
aW5saW5lIHN0cnVjdCBpOTE1X3JlcXVlc3QgKgotaTkxNV9hY3RpdmVfcmVxdWVzdF9nZXRfdW5s
b2NrZWQoY29uc3Qgc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2ZSkKK3N0YXRpYyBp
bmxpbmUgc3RydWN0IGRtYV9mZW5jZSAqCitpOTE1X2FjdGl2ZV9mZW5jZV9nZXQoc3RydWN0IGk5
MTVfYWN0aXZlX2ZlbmNlICphY3RpdmUpCiB7Ci0Jc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVz
dDsKKwlzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZTsKIAogCXJjdV9yZWFkX2xvY2soKTsKLQlyZXF1
ZXN0ID0gX19pOTE1X2FjdGl2ZV9yZXF1ZXN0X2dldF9yY3UoYWN0aXZlKTsKKwlmZW5jZSA9IGRt
YV9mZW5jZV9nZXRfcmN1X3NhZmUoJmFjdGl2ZS0+ZmVuY2UpOwogCXJjdV9yZWFkX3VubG9jaygp
OwogCi0JcmV0dXJuIHJlcXVlc3Q7CisJcmV0dXJuIGZlbmNlOwogfQogCiAvKioKLSAqIGk5MTVf
YWN0aXZlX3JlcXVlc3RfaXNzZXQgLSByZXBvcnQgd2hldGhlciB0aGUgYWN0aXZlIHRyYWNrZXIg
aXMgYXNzaWduZWQKKyAqIGk5MTVfYWN0aXZlX2ZlbmNlX2lzc2V0IC0gcmVwb3J0IHdoZXRoZXIg
dGhlIGFjdGl2ZSB0cmFja2VyIGlzIGFzc2lnbmVkCiAgKiBAYWN0aXZlIC0gdGhlIGFjdGl2ZSB0
cmFja2VyCiAgKgotICogaTkxNV9hY3RpdmVfcmVxdWVzdF9pc3NldCgpIHJldHVybnMgdHJ1ZSBp
ZiB0aGUgYWN0aXZlIHRyYWNrZXIgaXMgY3VycmVudGx5Ci0gKiBhc3NpZ25lZCB0byBhIHJlcXVl
c3QuIER1ZSB0byB0aGUgbGF6eSByZXRpcmluZywgdGhhdCByZXF1ZXN0IG1heSBiZSBpZGxlCisg
KiBpOTE1X2FjdGl2ZV9mZW5jZV9pc3NldCgpIHJldHVybnMgdHJ1ZSBpZiB0aGUgYWN0aXZlIHRy
YWNrZXIgaXMgY3VycmVudGx5CisgKiBhc3NpZ25lZCB0byBhIGZlbmNlLiBEdWUgdG8gdGhlIGxh
enkgcmV0aXJpbmcsIHRoYXQgZmVuY2UgbWF5IGJlIGlkbGUKICAqIGFuZCB0aGlzIG1heSByZXBv
cnQgc3RhbGUgaW5mb3JtYXRpb24uCiAgKi8KIHN0YXRpYyBpbmxpbmUgYm9vbAotaTkxNV9hY3Rp
dmVfcmVxdWVzdF9pc3NldChjb25zdCBzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZl
KQoraTkxNV9hY3RpdmVfZmVuY2VfaXNzZXQoY29uc3Qgc3RydWN0IGk5MTVfYWN0aXZlX2ZlbmNl
ICphY3RpdmUpCiB7Ci0JcmV0dXJuIHJjdV9hY2Nlc3NfcG9pbnRlcihhY3RpdmUtPnJlcXVlc3Qp
OworCXJldHVybiByY3VfYWNjZXNzX3BvaW50ZXIoYWN0aXZlLT5mZW5jZSk7CiB9CiAKLS8qKgot
ICogaTkxNV9hY3RpdmVfcmVxdWVzdF9yZXRpcmUgLSB3YWl0cyB1bnRpbCB0aGUgcmVxdWVzdCBp
cyByZXRpcmVkCi0gKiBAYWN0aXZlIC0gdGhlIGFjdGl2ZSByZXF1ZXN0IG9uIHdoaWNoIHRvIHdh
aXQKLSAqCi0gKiBpOTE1X2FjdGl2ZV9yZXF1ZXN0X3JldGlyZSgpIHdhaXRzIHVudGlsIHRoZSBy
ZXF1ZXN0IGlzIGNvbXBsZXRlZCwKLSAqIGFuZCB0aGVuIGVuc3VyZXMgdGhhdCBhdCBsZWFzdCB0
aGUgcmV0aXJlbWVudCBoYW5kbGVyIGZvciB0aGlzCi0gKiBAYWN0aXZlIHRyYWNrZXIgaXMgY2Fs
bGVkIGJlZm9yZSByZXR1cm5pbmcuIElmIHRoZSBAYWN0aXZlCi0gKiB0cmFja2VyIGlzIGlkbGUs
IHRoZSBmdW5jdGlvbiByZXR1cm5zIGltbWVkaWF0ZWx5LgotICovCi1zdGF0aWMgaW5saW5lIGlu
dCBfX211c3RfY2hlY2sKLWk5MTVfYWN0aXZlX3JlcXVlc3RfcmV0aXJlKHN0cnVjdCBpOTE1X2Fj
dGl2ZV9yZXF1ZXN0ICphY3RpdmUsCi0JCQkgICBzdHJ1Y3QgbXV0ZXggKm11dGV4KQorc3RhdGlj
IGlubGluZSB2b2lkCitpOTE1X2FjdGl2ZV9mZW5jZV9jYihzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5j
ZSwgc3RydWN0IGRtYV9mZW5jZV9jYiAqY2IpCiB7Ci0Jc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVx
dWVzdDsKLQlsb25nIHJldDsKLQotCXJlcXVlc3QgPSBpOTE1X2FjdGl2ZV9yZXF1ZXN0X3Jhdyhh
Y3RpdmUsIG11dGV4KTsKLQlpZiAoIXJlcXVlc3QpCi0JCXJldHVybiAwOwotCi0JcmV0ID0gaTkx
NV9yZXF1ZXN0X3dhaXQocmVxdWVzdCwKLQkJCQlJOTE1X1dBSVRfSU5URVJSVVBUSUJMRSwKLQkJ
CQlNQVhfU0NIRURVTEVfVElNRU9VVCk7Ci0JaWYgKHJldCA8IDApCi0JCXJldHVybiByZXQ7CisJ
c3RydWN0IGk5MTVfYWN0aXZlX2ZlbmNlICphY3RpdmUgPQorCQljb250YWluZXJfb2YoY2IsIHR5
cGVvZigqYWN0aXZlKSwgY2IpOwogCi0JbGlzdF9kZWxfaW5pdCgmYWN0aXZlLT5saW5rKTsKLQlS
Q1VfSU5JVF9QT0lOVEVSKGFjdGl2ZS0+cmVxdWVzdCwgTlVMTCk7Ci0KLQlhY3RpdmUtPnJldGly
ZShhY3RpdmUsIHJlcXVlc3QpOwotCi0JcmV0dXJuIDA7CisJUkNVX0lOSVRfUE9JTlRFUihhY3Rp
dmUtPmZlbmNlLCBOVUxMKTsKIH0KIAogLyoKQEAgLTM1OCwyMCArMTYxLDE5IEBAIGk5MTVfYWN0
aXZlX3JlcXVlc3RfcmV0aXJlKHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUsCiAg
KiBzeW5jaHJvbmlzYXRpb24uCiAgKi8KIAotdm9pZCBfX2k5MTVfYWN0aXZlX2luaXQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCi0JCQlzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwKK3Zv
aWQgX19pOTE1X2FjdGl2ZV9pbml0KHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLAogCQkJaW50ICgq
YWN0aXZlKShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiksCiAJCQl2b2lkICgqcmV0aXJlKShzdHJ1
Y3QgaTkxNV9hY3RpdmUgKnJlZiksCiAJCQlzdHJ1Y3QgbG9ja19jbGFzc19rZXkgKmtleSk7Ci0j
ZGVmaW5lIGk5MTVfYWN0aXZlX2luaXQoaTkxNSwgcmVmLCBhY3RpdmUsIHJldGlyZSkgZG8gewkJ
XAorI2RlZmluZSBpOTE1X2FjdGl2ZV9pbml0KHJlZiwgYWN0aXZlLCByZXRpcmUpIGRvIHsJCVwK
IAlzdGF0aWMgc3RydWN0IGxvY2tfY2xhc3Nfa2V5IF9fa2V5OwkJCQlcCiAJCQkJCQkJCQlcCi0J
X19pOTE1X2FjdGl2ZV9pbml0KGk5MTUsIHJlZiwgYWN0aXZlLCByZXRpcmUsICZfX2tleSk7CQlc
CisJX19pOTE1X2FjdGl2ZV9pbml0KHJlZiwgYWN0aXZlLCByZXRpcmUsICZfX2tleSk7CQlcCiB9
IHdoaWxlICgwKQogCiBpbnQgaTkxNV9hY3RpdmVfcmVmKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVm
LAogCQkgICAgc3RydWN0IGludGVsX3RpbWVsaW5lICp0bCwKLQkJICAgIHN0cnVjdCBpOTE1X3Jl
cXVlc3QgKnJxKTsKKwkJICAgIHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlKTsKIAogdm9pZCBpOTE1
X2FjdGl2ZV9zZXRfZXhjbHVzaXZlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLCBzdHJ1Y3QgZG1h
X2ZlbmNlICpmKTsKIApAQCAtMzc5LDE1ICsxODEsMTIgQEAgaW50IGk5MTVfYWN0aXZlX3dhaXQo
c3RydWN0IGk5MTVfYWN0aXZlICpyZWYpOwogCiBpbnQgaTkxNV9yZXF1ZXN0X2F3YWl0X2FjdGl2
ZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKIAkJCSAgICAgIHN0cnVjdCBpOTE1X2FjdGl2ZSAq
cmVmKTsKLWludCBpOTE1X3JlcXVlc3RfYXdhaXRfYWN0aXZlX3JlcXVlc3Qoc3RydWN0IGk5MTVf
cmVxdWVzdCAqcnEsCi0JCQkJICAgICAgc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2
ZSk7CitpbnQgaTkxNV9yZXF1ZXN0X2F3YWl0X2FjdGl2ZV9mZW5jZShzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpycSwKKwkJCQkgICAgc3RydWN0IGk5MTVfYWN0aXZlX2ZlbmNlICphY3RpdmUpOwogCiBp
bnQgaTkxNV9hY3RpdmVfYWNxdWlyZShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZik7Citib29sIGk5
MTVfYWN0aXZlX2FjcXVpcmVfaWZfYnVzeShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZik7CiB2b2lk
IGk5MTVfYWN0aXZlX3JlbGVhc2Uoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpOwotdm9pZCBfX2k5
MTVfYWN0aXZlX3JlbGVhc2VfbmVzdGVkKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLCBpbnQgc3Vi
Y2xhc3MpOwotCi1ib29sIGk5MTVfYWN0aXZlX3RyeWdyYWIoc3RydWN0IGk5MTVfYWN0aXZlICpy
ZWYpOwotdm9pZCBpOTE1X2FjdGl2ZV91bmdyYWIoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpOwog
CiBzdGF0aWMgaW5saW5lIGJvb2wKIGk5MTVfYWN0aXZlX2lzX2lkbGUoY29uc3Qgc3RydWN0IGk5
MTVfYWN0aXZlICpyZWYpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Fj
dGl2ZV90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmVfdHlwZXMuaApp
bmRleCAwMjExNjdmMDAwNGQuLjEyM2YyZTg4MzI2MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9hY3RpdmVfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2FjdGl2ZV90eXBlcy5oCkBAIC0xNywxNyArMTcsOSBAQAogCiAjaW5jbHVkZSAiaTkxNV91
dGlscy5oIgogCi1zdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKLXN0cnVjdCBpOTE1X2FjdGl2ZV9y
ZXF1ZXN0Owotc3RydWN0IGk5MTVfcmVxdWVzdDsKLQotdHlwZWRlZiB2b2lkICgqaTkxNV9hY3Rp
dmVfcmV0aXJlX2ZuKShzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqLAotCQkJCSAgICAgIHN0
cnVjdCBpOTE1X3JlcXVlc3QgKik7Ci0KLXN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0IHsKLQlz
dHJ1Y3QgaTkxNV9yZXF1ZXN0IF9fcmN1ICpyZXF1ZXN0OwotCXN0cnVjdCBsaXN0X2hlYWQgbGlu
azsKLQlpOTE1X2FjdGl2ZV9yZXRpcmVfZm4gcmV0aXJlOworc3RydWN0IGk5MTVfYWN0aXZlX2Zl
bmNlIHsKKwlzdHJ1Y3QgZG1hX2ZlbmNlIF9fcmN1ICpmZW5jZTsKKwlzdHJ1Y3QgZG1hX2ZlbmNl
X2NiIGNiOwogI2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X0RFQlVHX0dFTSkKIAkvKgog
CSAqIEluY29ycG9yZWFsIQpAQCAtNTMsMTIgKzQ1LDExIEBAIHN0cnVjdCBhY3RpdmVfbm9kZTsK
ICNkZWZpbmUgaTkxNV9hY3RpdmVfbWF5X3NsZWVwKGZuKSBwdHJfcGFja19iaXRzKCYoZm4pLCBJ
OTE1X0FDVElWRV9NQVlfU0xFRVAsIDIpCiAKIHN0cnVjdCBpOTE1X2FjdGl2ZSB7Ci0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTU7CisJYXRvbWljX3QgY291bnQ7CisJc3RydWN0IG11dGV4
IG11dGV4OwogCiAJc3RydWN0IGFjdGl2ZV9ub2RlICpjYWNoZTsKIAlzdHJ1Y3QgcmJfcm9vdCB0
cmVlOwotCXN0cnVjdCBtdXRleCBtdXRleDsKLQlhdG9taWNfdCBjb3VudDsKIAogCS8qIFByZWFs
bG9jYXRlZCAiZXhjbHVzaXZlIiBub2RlICovCiAJc3RydWN0IGRtYV9mZW5jZSBfX3JjdSAqZXhj
bDsKQEAgLTY2LDcgKzU3LDYgQEAgc3RydWN0IGk5MTVfYWN0aXZlIHsKIAogCXVuc2lnbmVkIGxv
bmcgZmxhZ3M7CiAjZGVmaW5lIEk5MTVfQUNUSVZFX1JFVElSRV9TTEVFUFMgQklUKDApCi0jZGVm
aW5lIEk5MTVfQUNUSVZFX0dSQUJfQklUIDEKIAogCWludCAoKmFjdGl2ZSkoc3RydWN0IGk5MTVf
YWN0aXZlICpyZWYpOwogCXZvaWQgKCpyZXRpcmUpKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKTsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2dlbS5jCmluZGV4IDY2YWJiNDI3YWE0Ny4uZDIxNmRiYzQwNmZkIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKQEAgLTkwMCwyOCArOTAwLDM4IEBAIHdhaXRfZm9yX3Rp
bWVsaW5lcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAogCXNwaW5fbG9ja19pcnFz
YXZlKCZ0aW1lbGluZXMtPmxvY2ssIGZsYWdzKTsKIAlsaXN0X2Zvcl9lYWNoX2VudHJ5KHRsLCAm
dGltZWxpbmVzLT5hY3RpdmVfbGlzdCwgbGluaykgewotCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpy
cTsKKwkJc3RydWN0IGRtYV9mZW5jZSAqZmVuY2U7CiAKLQkJcnEgPSBpOTE1X2FjdGl2ZV9yZXF1
ZXN0X2dldF91bmxvY2tlZCgmdGwtPmxhc3RfcmVxdWVzdCk7Ci0JCWlmICghcnEpCisJCWZlbmNl
ID0gaTkxNV9hY3RpdmVfZmVuY2VfZ2V0KCZ0bC0+bGFzdF9yZXF1ZXN0KTsKKwkJaWYgKCFmZW5j
ZSkKIAkJCWNvbnRpbnVlOwogCiAJCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnRpbWVsaW5lcy0+
bG9jaywgZmxhZ3MpOwogCi0JCS8qCi0JCSAqICJSYWNlLXRvLWlkbGUiLgotCQkgKgotCQkgKiBT
d2l0Y2hpbmcgdG8gdGhlIGtlcm5lbCBjb250ZXh0IGlzIG9mdGVuIHVzZWQgYSBzeW5jaHJvbm91
cwotCQkgKiBzdGVwIHByaW9yIHRvIGlkbGluZywgZS5nLiBpbiBzdXNwZW5kIGZvciBmbHVzaGlu
ZyBhbGwKLQkJICogY3VycmVudCBvcGVyYXRpb25zIHRvIG1lbW9yeSBiZWZvcmUgc2xlZXBpbmcu
IFRoZXNlIHdlCi0JCSAqIHdhbnQgdG8gY29tcGxldGUgYXMgcXVpY2tseSBhcyBwb3NzaWJsZSB0
byBhdm9pZCBwcm9sb25nZWQKLQkJICogc3RhbGxzLCBzbyBhbGxvdyB0aGUgZ3B1IHRvIGJvb3N0
IHRvIG1heGltdW0gY2xvY2tzLgotCQkgKi8KLQkJaWYgKHdhaXQgJiBJOTE1X1dBSVRfRk9SX0lE
TEVfQk9PU1QpCi0JCQlnZW42X3Jwc19ib29zdChycSk7CisJCWlmICghZG1hX2ZlbmNlX2lzX2k5
MTUoZmVuY2UpKSB7CisJCQl0aW1lb3V0ID0gZG1hX2ZlbmNlX3dhaXRfdGltZW91dChmZW5jZSwK
KwkJCQkJCQkgZmxhZ3MgJiBJOTE1X1dBSVRfSU5URVJSVVBUSUJMRSwKKwkJCQkJCQkgdGltZW91
dCk7CisJCX0gZWxzZSB7CisJCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSA9IHRvX3JlcXVlc3Qo
ZmVuY2UpOworCisJCQkvKgorCQkJICogIlJhY2UtdG8taWRsZSIuCisJCQkgKgorCQkJICogU3dp
dGNoaW5nIHRvIHRoZSBrZXJuZWwgY29udGV4dCBpcyBvZnRlbiB1c2VkIGFzCisJCQkgKiBhIHN5
bmNocm9ub3VzIHN0ZXAgcHJpb3IgdG8gaWRsaW5nLCBlLmcuIGluIHN1c3BlbmQKKwkJCSAqIGZv
ciBmbHVzaGluZyBhbGwgY3VycmVudCBvcGVyYXRpb25zIHRvIG1lbW9yeSBiZWZvcmUKKwkJCSAq
IHNsZWVwaW5nLiBUaGVzZSB3ZSB3YW50IHRvIGNvbXBsZXRlIGFzIHF1aWNrbHkgYXMKKwkJCSAq
IHBvc3NpYmxlIHRvIGF2b2lkIHByb2xvbmdlZCBzdGFsbHMsIHNvIGFsbG93IHRoZSBncHUKKwkJ
CSAqIHRvIGJvb3N0IHRvIG1heGltdW0gY2xvY2tzLgorCQkJICovCisJCQlpZiAoZmxhZ3MgJiBJ
OTE1X1dBSVRfRk9SX0lETEVfQk9PU1QpCisJCQkJZ2VuNl9ycHNfYm9vc3QocnEpOworCisJCQl0
aW1lb3V0ID0gaTkxNV9yZXF1ZXN0X3dhaXQocnEsIGZsYWdzLCB0aW1lb3V0KTsKKwkJfQogCi0J
CXRpbWVvdXQgPSBpOTE1X3JlcXVlc3Rfd2FpdChycSwgd2FpdCwgdGltZW91dCk7Ci0JCWk5MTVf
cmVxdWVzdF9wdXQocnEpOworCQlkbWFfZmVuY2VfcHV0KGZlbmNlKTsKIAkJaWYgKHRpbWVvdXQg
PCAwKQogCQkJcmV0dXJuIHRpbWVvdXQ7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZ2VtX2d0dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMK
aW5kZXggYmE1YmU1M2VlYWMzLi45YzdiYWQzMzI0MzggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
Z2VtX2d0dC5jCkBAIC0xODU2LDcgKzE4NTYsNiBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVf
dm1hX29wcyBwZF92bWFfb3BzID0gewogCiBzdGF0aWMgc3RydWN0IGk5MTVfdm1hICpwZF92bWFf
Y3JlYXRlKHN0cnVjdCBnZW42X3BwZ3R0ICpwcGd0dCwgaW50IHNpemUpCiB7Ci0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBwcGd0dC0+YmFzZS52bS5pOTE1OwogCXN0cnVjdCBpOTE1
X2dndHQgKmdndHQgPSBwcGd0dC0+YmFzZS52bS5ndC0+Z2d0dDsKIAlzdHJ1Y3QgaTkxNV92bWEg
KnZtYTsKIApAQCAtMTg2Nyw3ICsxODY2LDcgQEAgc3RhdGljIHN0cnVjdCBpOTE1X3ZtYSAqcGRf
dm1hX2NyZWF0ZShzdHJ1Y3QgZ2VuNl9wcGd0dCAqcHBndHQsIGludCBzaXplKQogCWlmICghdm1h
KQogCQlyZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKIAotCWk5MTVfYWN0aXZlX2luaXQoaTkxNSwg
JnZtYS0+YWN0aXZlLCBOVUxMLCBOVUxMKTsKKwlpOTE1X2FjdGl2ZV9pbml0KCZ2bWEtPmFjdGl2
ZSwgTlVMTCwgTlVMTCk7CiAKIAltdXRleF9pbml0KCZ2bWEtPnBhZ2VzX211dGV4KTsKIAl2bWEt
PnZtID0gaTkxNV92bV9nZXQoJmdndHQtPnZtKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9l
cnJvci5jCmluZGV4IDRhZmYzNDJiODk0NC4uMmRkNjNhMjYxYjAwIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZ3B1X2Vycm9yLmMKQEAgLTEyOTIsNyArMTI5Miw3IEBAIGNhcHR1cmVfdm1hKHN0
cnVjdCBjYXB0dXJlX3ZtYSAqbmV4dCwKIAlpZiAoIWMpCiAJCXJldHVybiBuZXh0OwogCi0JaWYg
KCFpOTE1X2FjdGl2ZV90cnlncmFiKCZ2bWEtPmFjdGl2ZSkpIHsKKwlpZiAoIWk5MTVfYWN0aXZl
X2FjcXVpcmVfaWZfYnVzeSgmdm1hLT5hY3RpdmUpKSB7CiAJCWtmcmVlKGMpOwogCQlyZXR1cm4g
bmV4dDsKIAl9CkBAIC0xNDMyLDcgKzE0MzIsNyBAQCBnZW1fcmVjb3JkX3JpbmdzKHN0cnVjdCBp
OTE1X2dwdV9zdGF0ZSAqZXJyb3IsIHN0cnVjdCBjb21wcmVzcyAqY29tcHJlc3MpCiAJCQkqdGhp
cy0+c2xvdCA9CiAJCQkJaTkxNV9lcnJvcl9vYmplY3RfY3JlYXRlKGk5MTUsIHZtYSwgY29tcHJl
c3MpOwogCi0JCQlpOTE1X2FjdGl2ZV91bmdyYWIoJnZtYS0+YWN0aXZlKTsKKwkJCWk5MTVfYWN0
aXZlX3JlbGVhc2UoJnZtYS0+YWN0aXZlKTsKIAkJCWk5MTVfdm1hX3B1dCh2bWEpOwogCiAJCQlj
YXB0dXJlID0gdGhpcy0+bmV4dDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfcmVxdWVzdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMKaW5kZXgg
NzU0YTc4MzY0YTYzLi40ZWNmYWUxNDMyNzYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfcmVxdWVzdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVz
dC5jCkBAIC0xOTcsOSArMTk3LDggQEAgc3RhdGljIHZvaWQgZnJlZV9jYXB0dXJlX2xpc3Qoc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCkKIAogc3RhdGljIGJvb2wgaTkxNV9yZXF1ZXN0X3Jl
dGlyZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIHsKLQlzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVx
dWVzdCAqYWN0aXZlLCAqbmV4dDsKLQogCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJnJxLT50aW1lbGlu
ZS0+bXV0ZXgpOworCiAJaWYgKCFpOTE1X3JlcXVlc3RfY29tcGxldGVkKHJxKSkKIAkJcmV0dXJu
IGZhbHNlOwogCkBAIC0yMjMsMzUgKzIyMiw2IEBAIHN0YXRpYyBib29sIGk5MTVfcmVxdWVzdF9y
ZXRpcmUoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJR0VNX0JVR19PTighbGlzdF9pc19maXJz
dCgmcnEtPmxpbmssICZycS0+dGltZWxpbmUtPnJlcXVlc3RzKSk7CiAJcnEtPnJpbmctPmhlYWQg
PSBycS0+cG9zdGZpeDsKIAotCS8qCi0JICogV2FsayB0aHJvdWdoIHRoZSBhY3RpdmUgbGlzdCwg
Y2FsbGluZyByZXRpcmUgb24gZWFjaC4gVGhpcyBhbGxvd3MKLQkgKiBvYmplY3RzIHRvIHRyYWNr
IHRoZWlyIEdQVSBhY3Rpdml0eSBhbmQgbWFyayB0aGVtc2VsdmVzIGFzIGlkbGUKLQkgKiB3aGVu
IHRoZWlyICpsYXN0KiBhY3RpdmUgcmVxdWVzdCBpcyBjb21wbGV0ZWQgKHVwZGF0aW5nIHN0YXRl
Ci0JICogdHJhY2tpbmcgbGlzdHMgZm9yIGV2aWN0aW9uLCBhY3RpdmUgcmVmZXJlbmNlcyBmb3Ig
R0VNLCBldGMpLgotCSAqCi0JICogQXMgdGhlIC0+cmV0aXJlKCkgbWF5IGZyZWUgdGhlIG5vZGUs
IHdlIGRlY291cGxlIGl0IGZpcnN0IGFuZAotCSAqIHBhc3MgYWxvbmcgdGhlIGF1eGlsaWFyeSBp
bmZvcm1hdGlvbiAodG8gYXZvaWQgZGVyZWZlcmVuY2luZwotCSAqIHRoZSBub2RlIGFmdGVyIHRo
ZSBjYWxsYmFjaykuCi0JICovCi0JbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKGFjdGl2ZSwgbmV4
dCwgJnJxLT5hY3RpdmVfbGlzdCwgbGluaykgewotCQkvKgotCQkgKiBJbiBtaWNyb2JlbmNobWFy
a3Mgb3IgZm9jdXNpbmcgdXBvbiB0aW1lIGluc2lkZSB0aGUga2VybmVsLAotCQkgKiB3ZSBtYXkg
c3BlbmQgYW4gaW5vcmRpbmF0ZSBhbW91bnQgb2YgdGltZSBzaW1wbHkgaGFuZGxpbmcKLQkJICog
dGhlIHJldGlyZW1lbnQgb2YgcmVxdWVzdHMgYW5kIHByb2Nlc3NpbmcgdGhlaXIgY2FsbGJhY2tz
LgotCQkgKiBPZiB3aGljaCwgdGhpcyBsb29wIGl0c2VsZiBpcyBwYXJ0aWN1bGFybHkgaG90IGR1
ZSB0byB0aGUKLQkJICogY2FjaGUgbWlzc2VzIHdoZW4ganVtcGluZyBhcm91bmQgdGhlIGxpc3Qg
b2YKLQkJICogaTkxNV9hY3RpdmVfcmVxdWVzdC4gIFNvIHdlIHRyeSB0byBrZWVwIHRoaXMgbG9v
cCBhcwotCQkgKiBzdHJlYW1saW5lZCBhcyBwb3NzaWJsZSBhbmQgYWxzbyBwcmVmZXRjaCB0aGUg
bmV4dAotCQkgKiBpOTE1X2FjdGl2ZV9yZXF1ZXN0IHRvIHRyeSBhbmQgaGlkZSB0aGUgbGlrZWx5
IGNhY2hlIG1pc3MuCi0JCSAqLwotCQlwcmVmZXRjaHcobmV4dCk7Ci0KLQkJSU5JVF9MSVNUX0hF
QUQoJmFjdGl2ZS0+bGluayk7Ci0JCVJDVV9JTklUX1BPSU5URVIoYWN0aXZlLT5yZXF1ZXN0LCBO
VUxMKTsKLQotCQlhY3RpdmUtPnJldGlyZShhY3RpdmUsIHJxKTsKLQl9Ci0KIAlsb2NhbF9pcnFf
ZGlzYWJsZSgpOwogCiAJLyoKQEAgLTY2NCw3ICs2MzQsNiBAQCBfX2k5MTVfcmVxdWVzdF9jcmVh
dGUoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCBnZnBfdCBnZnApCiAJcnEtPmZsYWdzID0gMDsK
IAlycS0+ZXhlY3V0aW9uX21hc2sgPSBBTExfRU5HSU5FUzsKIAotCUlOSVRfTElTVF9IRUFEKCZy
cS0+YWN0aXZlX2xpc3QpOwogCUlOSVRfTElTVF9IRUFEKCZycS0+ZXhlY3V0ZV9jYik7CiAKIAkv
KgpAQCAtNzAzLDcgKzY3Miw2IEBAIF9faTkxNV9yZXF1ZXN0X2NyZWF0ZShzdHJ1Y3QgaW50ZWxf
Y29udGV4dCAqY2UsIGdmcF90IGdmcCkKIAljZS0+cmluZy0+ZW1pdCA9IHJxLT5oZWFkOwogCiAJ
LyogTWFrZSBzdXJlIHdlIGRpZG4ndCBhZGQgb3Vyc2VsdmVzIHRvIGV4dGVybmFsIHN0YXRlIGJl
Zm9yZSBmcmVlaW5nICovCi0JR0VNX0JVR19PTighbGlzdF9lbXB0eSgmcnEtPmFjdGl2ZV9saXN0
KSk7CiAJR0VNX0JVR19PTighbGlzdF9lbXB0eSgmcnEtPnNjaGVkLnNpZ25hbGVyc19saXN0KSk7
CiAJR0VNX0JVR19PTighbGlzdF9lbXB0eSgmcnEtPnNjaGVkLndhaXRlcnNfbGlzdCkpOwogCkBA
IC0xMDk2LDggKzEwNjQsOCBAQCBfX2k5MTVfcmVxdWVzdF9hZGRfdG9fdGltZWxpbmUoc3RydWN0
IGk5MTVfcmVxdWVzdCAqcnEpCiAJICogcHJlY2x1ZGVzIG9wdGltaXNpbmcgdG8gdXNlIHNlbWFw
aG9yZXMgc2VyaWFsaXNhdGlvbiBvZiBhIHNpbmdsZQogCSAqIHRpbWVsaW5lIGFjcm9zcyBlbmdp
bmVzLgogCSAqLwotCXByZXYgPSByY3VfZGVyZWZlcmVuY2VfcHJvdGVjdGVkKHRpbWVsaW5lLT5s
YXN0X3JlcXVlc3QucmVxdWVzdCwKLQkJCQkJIGxvY2tkZXBfaXNfaGVsZCgmdGltZWxpbmUtPm11
dGV4KSk7CisJcHJldiA9IHRvX3JlcXVlc3QoX19pOTE1X2FjdGl2ZV9mZW5jZV9zZXQoJnRpbWVs
aW5lLT5sYXN0X3JlcXVlc3QsCisJCQkJCQkgICZycS0+ZmVuY2UpKTsKIAlpZiAocHJldiAmJiAh
aTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChwcmV2KSkgewogCQlpZiAoaXNfcG93ZXJfb2ZfMihwcmV2
LT5lbmdpbmUtPm1hc2sgfCBycS0+ZW5naW5lLT5tYXNrKSkKIAkJCWk5MTVfc3dfZmVuY2VfYXdh
aXRfc3dfZmVuY2UoJnJxLT5zdWJtaXQsCkBAIC0xMTIyLDcgKzEwOTAsNiBAQCBfX2k5MTVfcmVx
dWVzdF9hZGRfdG9fdGltZWxpbmUoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJICogdXMsIHRo
ZSB0aW1lbGluZSB3aWxsIGhvbGQgaXRzIHNlcW5vIHdoaWNoIGlzIGxhdGVyIHRoYW4gb3Vycy4K
IAkgKi8KIAlHRU1fQlVHX09OKHRpbWVsaW5lLT5zZXFubyAhPSBycS0+ZmVuY2Uuc2Vxbm8pOwot
CV9faTkxNV9hY3RpdmVfcmVxdWVzdF9zZXQoJnRpbWVsaW5lLT5sYXN0X3JlcXVlc3QsIHJxKTsK
IAogCXJldHVybiBwcmV2OwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9yZXF1ZXN0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuaAppbmRleCA4
YWM2ZTEyMjZhNTYuLjMyNTFkMmJkYmVlYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9yZXF1ZXN0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0
LmgKQEAgLTIxMSw3ICsyMTEsNiBAQCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0IHsKIAkgKiBvbiB0aGUg
YWN0aXZlX2xpc3QgKG9mIHRoZWlyIGZpbmFsIHJlcXVlc3QpLgogCSAqLwogCXN0cnVjdCBpOTE1
X2NhcHR1cmVfbGlzdCAqY2FwdHVyZV9saXN0OwotCXN0cnVjdCBsaXN0X2hlYWQgYWN0aXZlX2xp
c3Q7CiAKIAkvKiogVGltZSBhdCB3aGljaCB0aGlzIHJlcXVlc3Qgd2FzIGVtaXR0ZWQsIGluIGpp
ZmZpZXMuICovCiAJdW5zaWduZWQgbG9uZyBlbWl0dGVkX2ppZmZpZXM7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV92bWEuYwppbmRleCBhNWQ3MGVmYmU5N2QuLmI1NjBiNDcxMTRkMCAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3ZtYS5jCkBAIC0xMjAsOCArMTIwLDcgQEAgdm1hX2NyZWF0ZShzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqLAogCXZtYS0+c2l6ZSA9IG9iai0+YmFzZS5zaXplOwogCXZtYS0+ZGlz
cGxheV9hbGlnbm1lbnQgPSBJOTE1X0dUVF9NSU5fQUxJR05NRU5UOwogCi0JaTkxNV9hY3RpdmVf
aW5pdCh2bS0+aTkxNSwgJnZtYS0+YWN0aXZlLAotCQkJIF9faTkxNV92bWFfYWN0aXZlLCBfX2k5
MTVfdm1hX3JldGlyZSk7CisJaTkxNV9hY3RpdmVfaW5pdCgmdm1hLT5hY3RpdmUsIF9faTkxNV92
bWFfYWN0aXZlLCBfX2k5MTVfdm1hX3JldGlyZSk7CiAKIAkvKiBEZWNsYXJlIG91cnNlbHZlcyBz
YWZlIGZvciB1c2UgaW5zaWRlIHNocmlua2VycyAqLwogCWlmIChJU19FTkFCTEVEKENPTkZJR19M
T0NLREVQKSkgewpAQCAtMTA5NCw3ICsxMDkzLDcgQEAgaW50IGk5MTVfdm1hX21vdmVfdG9fYWN0
aXZlKHN0cnVjdCBpOTE1X3ZtYSAqdm1hLAogCSAqIGFkZCB0aGUgYWN0aXZlIHJlZmVyZW5jZSBm
aXJzdCBhbmQgcXVldWUgZm9yIGl0IHRvIGJlIGRyb3BwZWQKIAkgKiAqbGFzdCouCiAJICovCi0J
ZXJyID0gaTkxNV9hY3RpdmVfcmVmKCZ2bWEtPmFjdGl2ZSwgcnEtPnRpbWVsaW5lLCBycSk7CisJ
ZXJyID0gaTkxNV9hY3RpdmVfcmVmKCZ2bWEtPmFjdGl2ZSwgcnEtPnRpbWVsaW5lLCAmcnEtPmZl
bmNlKTsKIAlpZiAodW5saWtlbHkoZXJyKSkKIAkJcmV0dXJuIGVycjsKIApAQCAtMTEwMiw3ICsx
MTAxLDcgQEAgaW50IGk5MTVfdm1hX21vdmVfdG9fYWN0aXZlKHN0cnVjdCBpOTE1X3ZtYSAqdm1h
LAogCQlpZiAoaW50ZWxfZnJvbnRidWZmZXJfaW52YWxpZGF0ZShvYmotPmZyb250YnVmZmVyLCBP
UklHSU5fQ1MpKQogCQkJaTkxNV9hY3RpdmVfcmVmKCZvYmotPmZyb250YnVmZmVyLT53cml0ZSwK
IAkJCQkJcnEtPnRpbWVsaW5lLAotCQkJCQlycSk7CisJCQkJCSZycS0+ZmVuY2UpOwogCiAJCWRt
YV9yZXN2X2FkZF9leGNsX2ZlbmNlKHZtYS0+cmVzdiwgJnJxLT5mZW5jZSk7CiAJCW9iai0+d3Jp
dGVfZG9tYWluID0gSTkxNV9HRU1fRE9NQUlOX1JFTkRFUjsKQEAgLTExMzYsNiArMTEzNSw3IEBA
IGludCBpOTE1X3ZtYV91bmJpbmQoc3RydWN0IGk5MTVfdm1hICp2bWEpCiAJaWYgKHJldCkKIAkJ
cmV0dXJuIHJldDsKIAorCUdFTV9CVUdfT04oaTkxNV92bWFfaXNfYWN0aXZlKHZtYSkpOwogCWlm
IChpOTE1X3ZtYV9pc19waW5uZWQodm1hKSkgewogCQl2bWFfcHJpbnRfYWxsb2NhdG9yKHZtYSwg
ImlzIHBpbm5lZCIpOwogCQlyZXR1cm4gLUVCVVNZOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfYWN0aXZlLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9z
ZWxmdGVzdHMvaTkxNV9hY3RpdmUuYwppbmRleCBkNWFjOTk0NGQwOTMuLmFmNTgyN2FhYzdiMiAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfYWN0aXZlLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfYWN0aXZlLmMKQEAgLTY4
LDcgKzY4LDcgQEAgc3RhdGljIHN0cnVjdCBsaXZlX2FjdGl2ZSAqX19saXZlX2FsbG9jKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCQlyZXR1cm4gTlVMTDsKIAogCWtyZWZfaW5pdCgm
YWN0aXZlLT5yZWYpOwotCWk5MTVfYWN0aXZlX2luaXQoaTkxNSwgJmFjdGl2ZS0+YmFzZSwgX19s
aXZlX2FjdGl2ZSwgX19saXZlX3JldGlyZSk7CisJaTkxNV9hY3RpdmVfaW5pdCgmYWN0aXZlLT5i
YXNlLCBfX2xpdmVfYWN0aXZlLCBfX2xpdmVfcmV0aXJlKTsKIAogCXJldHVybiBhY3RpdmU7CiB9
CkBAIC0xMTAsNyArMTEwLDkgQEAgX19saXZlX2FjdGl2ZV9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKIAkJCQkJCSAgICAgICBzdWJtaXQsCiAJCQkJCQkgICAgICAgR0ZQX0tF
Uk5FTCk7CiAJCWlmIChlcnIgPj0gMCkKLQkJCWVyciA9IGk5MTVfYWN0aXZlX3JlZigmYWN0aXZl
LT5iYXNlLCBycS0+dGltZWxpbmUsIHJxKTsKKwkJCWVyciA9IGk5MTVfYWN0aXZlX3JlZigmYWN0
aXZlLT5iYXNlLAorCQkJCQkgICAgICBycS0+dGltZWxpbmUsCisJCQkJCSAgICAgICZycS0+ZmVu
Y2UpOwogCQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKIAkJaWYgKGVycikgewogCQkJcHJfZXJyKCJG
YWlsZWQgdG8gdHJhY2sgYWN0aXZlIHJlZiFcbiIpOwpAQCAtMTQ2LDE5ICsxNDgsMTMgQEAgc3Rh
dGljIGludCBsaXZlX2FjdGl2ZV93YWl0KHZvaWQgKmFyZykKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IGFyZzsKIAlzdHJ1Y3QgbGl2ZV9hY3RpdmUgKmFjdGl2ZTsKLQlpbnRl
bF93YWtlcmVmX3Qgd2FrZXJlZjsKIAlpbnQgZXJyID0gMDsKIAogCS8qIENoZWNrIHRoYXQgd2Ug
Z2V0IGEgY2FsbGJhY2sgd2hlbiByZXF1ZXN0cyByZXRpcmUgdXBvbiB3YWl0aW5nICovCiAKLQlt
dXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQl3YWtlcmVmID0gaW50ZWxfcnVu
dGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwotCiAJYWN0aXZlID0gX19saXZlX2FjdGl2
ZV9zZXR1cChpOTE1KTsKLQlpZiAoSVNfRVJSKGFjdGl2ZSkpIHsKLQkJZXJyID0gUFRSX0VSUihh
Y3RpdmUpOwotCQlnb3RvIGVycjsKLQl9CisJaWYgKElTX0VSUihhY3RpdmUpKQorCQlyZXR1cm4g
UFRSX0VSUihhY3RpdmUpOwogCiAJaTkxNV9hY3RpdmVfd2FpdCgmYWN0aXZlLT5iYXNlKTsKIAlp
ZiAoIVJFQURfT05DRShhY3RpdmUtPnJldGlyZWQpKSB7CkBAIC0xNjgsMTEgKzE2NCw5IEBAIHN0
YXRpYyBpbnQgbGl2ZV9hY3RpdmVfd2FpdCh2b2lkICphcmcpCiAKIAlfX2xpdmVfcHV0KGFjdGl2
ZSk7CiAKKwltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlpZiAoaWd0X2Zs
dXNoX3Rlc3QoaTkxNSwgSTkxNV9XQUlUX0xPQ0tFRCkpCiAJCWVyciA9IC1FSU87Ci0KLWVycjoK
LQlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAJbXV0
ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAogCXJldHVybiBlcnI7CkBAIC0x
ODIsMjMgKzE3NiwxOSBAQCBzdGF0aWMgaW50IGxpdmVfYWN0aXZlX3JldGlyZSh2b2lkICphcmcp
CiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBhcmc7CiAJc3RydWN0IGxpdmVf
YWN0aXZlICphY3RpdmU7Ci0JaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7CiAJaW50IGVyciA9IDA7
CiAKIAkvKiBDaGVjayB0aGF0IHdlIGdldCBhIGNhbGxiYWNrIHdoZW4gcmVxdWVzdHMgYXJlIGlu
ZGlyZWN0bHkgcmV0aXJlZCAqLwogCi0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRl
eCk7Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsK
LQogCWFjdGl2ZSA9IF9fbGl2ZV9hY3RpdmVfc2V0dXAoaTkxNSk7Ci0JaWYgKElTX0VSUihhY3Rp
dmUpKSB7Ci0JCWVyciA9IFBUUl9FUlIoYWN0aXZlKTsKLQkJZ290byBlcnI7Ci0JfQorCWlmIChJ
U19FUlIoYWN0aXZlKSkKKwkJcmV0dXJuIFBUUl9FUlIoYWN0aXZlKTsKIAogCS8qIHdhaXRzIGZv
ciAmIHJldGlyZXMgYWxsIHJlcXVlc3RzICovCisJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVj
dF9tdXRleCk7CiAJaWYgKGlndF9mbHVzaF90ZXN0KGk5MTUsIEk5MTVfV0FJVF9MT0NLRUQpKQog
CQllcnIgPSAtRUlPOworCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAK
IAlpZiAoIVJFQURfT05DRShhY3RpdmUtPnJldGlyZWQpKSB7CiAJCXByX2VycigiaTkxNV9hY3Rp
dmUgbm90IHJldGlyZWQgYWZ0ZXIgZmx1c2hpbmchXG4iKTsKQEAgLTIwNywxMCArMTk3LDYgQEAg
c3RhdGljIGludCBsaXZlX2FjdGl2ZV9yZXRpcmUodm9pZCAqYXJnKQogCiAJX19saXZlX3B1dChh
Y3RpdmUpOwogCi1lcnI6Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0s
IHdha2VyZWYpOwotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0KIAly
ZXR1cm4gZXJyOwogfQogCi0tIAoyLjIzLjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3Rz
LmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xp
c3RpbmZvL2ludGVsLWdmeA==

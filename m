Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1432710DF7E
	for <lists+intel-gfx@lfdr.de>; Sat, 30 Nov 2019 23:05:50 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CC1666E15C;
	Sat, 30 Nov 2019 22:05:47 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id DF8936E15C
 for <intel-gfx@lists.freedesktop.org>; Sat, 30 Nov 2019 22:05:45 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19409129-1500050 
 for multiple; Sat, 30 Nov 2019 22:05:40 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Sat, 30 Nov 2019 22:05:39 +0000
Message-Id: <20191130220539.1820480-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915/gt: Use soft-rc6 for w/a protection
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Tm93IHRoYXQgd2UgaGF2ZSBzb2Z0LXJjNiBpbiBwbGFjZSwgd2UgY2FuIHVzZSB0aGF0IGluc3Rl
YWQgb2YgdGhlCmZvcmNld2FrZSB0byBkaXNhYmxlIHJjNiB3aGlsZSBhY3RpdmU7IHByZWZlcnJl
ZCBieSBhIGZldwptaWNyb2JlbmNobWFya3MuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24g
PGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9ndF9wbS5jIHwgIDggLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X3JjNi5jICAgfCAxOSArKysrKysrKysrKysrLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9yYzYuaCAgIHwgIDEgLQogMyBmaWxlcyBjaGFuZ2VkLCAxMyBpbnNlcnRpb25zKCsp
LCAxNSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9ndF9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYwppbmRl
eCAyMDAwMDE4YjY0NjQuLmVjZGU2N2E3NWUzMiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9ndF9wbS5jCkBAIC02MSw5ICs2MSw2IEBAIHN0YXRpYyBpbnQgX19ndF91bnBhcmsoc3RydWN0
IGludGVsX3dha2VyZWYgKndmKQogCWd0LT5hd2FrZSA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0
KGk5MTUsIFBPV0VSX0RPTUFJTl9HVF9JUlEpOwogCUdFTV9CVUdfT04oIWd0LT5hd2FrZSk7CiAK
LQlpZiAoTkVFRFNfUkM2X0NUWF9DT1JSVVBUSU9OX1dBKGk5MTUpKQotCQlpbnRlbF91bmNvcmVf
Zm9yY2V3YWtlX2dldChndC0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKLQogCWludGVsX3JjNl91
bnBhcmsoJmd0LT5yYzYpOwogCWludGVsX3Jwc191bnBhcmsoJmd0LT5ycHMpOwogCWk5MTVfcG11
X2d0X3VucGFya2VkKGk5MTUpOwpAQCAtOTEsMTEgKzg4LDYgQEAgc3RhdGljIGludCBfX2d0X3Bh
cmsoc3RydWN0IGludGVsX3dha2VyZWYgKndmKQogCS8qIEV2ZXJ5dGhpbmcgc3dpdGNoZWQgb2Zm
LCBmbHVzaCBhbnkgcmVzaWR1YWwgaW50ZXJydXB0IGp1c3QgaW4gY2FzZSAqLwogCWludGVsX3N5
bmNocm9uaXplX2lycShpOTE1KTsKIAotCWlmIChORUVEU19SQzZfQ1RYX0NPUlJVUFRJT05fV0Eo
aTkxNSkpIHsKLQkJaW50ZWxfcmM2X2N0eF93YV9jaGVjaygmZ3QtPnJjNik7Ci0JCWludGVsX3Vu
Y29yZV9mb3JjZXdha2VfcHV0KGd0LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotCX0KLQogCUdF
TV9CVUdfT04oIXdha2VyZWYpOwogCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5MTUsIFBPV0VS
X0RPTUFJTl9HVF9JUlEsIHdha2VyZWYpOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9yYzYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JjNi5j
CmluZGV4IGM0Mzc5YzQ5YzIwZC4uZjU4Njc0ZjRhYWVjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9yYzYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9yYzYuYwpAQCAtNTI3LDI2ICs1MjcsMjUgQEAgdm9pZCBpbnRlbF9yYzZfY3R4X3dhX3Jl
c3VtZShzdHJ1Y3QgaW50ZWxfcmM2ICpyYzYpCiAgKiBDaGVjayBpZiBhbiBSQzYgQ1RYIGNvcnJ1
cHRpb24gaGFzIGhhcHBlbmVkIHNpbmNlIHRoZSBsYXN0IGNoZWNrIGFuZCBpZiBzbwogICogZGlz
YWJsZSBSQzYgYW5kIHJ1bnRpbWUgcG93ZXIgbWFuYWdlbWVudC4KICovCi12b2lkIGludGVsX3Jj
Nl9jdHhfd2FfY2hlY2soc3RydWN0IGludGVsX3JjNiAqcmM2KQorc3RhdGljIGJvb2wgaW50ZWxf
cmM2X2N0eF93YV9jaGVjayhzdHJ1Y3QgaW50ZWxfcmM2ICpyYzYpCiB7CiAJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSByYzZfdG9faTkxNShyYzYpOwogCiAJaWYgKCFORUVEU19SQzZf
Q1RYX0NPUlJVUFRJT05fV0EoaTkxNSkpCi0JCXJldHVybjsKKwkJcmV0dXJuIGZhbHNlOwogCiAJ
aWYgKHJjNi0+Y3R4X2NvcnJ1cHRlZCkKLQkJcmV0dXJuOworCQlyZXR1cm4gZmFsc2U7CiAKIAlp
ZiAoIWludGVsX3JjNl9jdHhfY29ycnVwdGVkKHJjNikpCi0JCXJldHVybjsKKwkJcmV0dXJuIGZh
bHNlOwogCiAJZGV2X25vdGljZShpOTE1LT5kcm0uZGV2LAogCQkgICAiUkM2IGNvbnRleHQgY29y
cnVwdGlvbiwgZGlzYWJsaW5nIHJ1bnRpbWUgcG93ZXIgbWFuYWdlbWVudFxuIik7CiAKLQlpbnRl
bF9yYzZfZGlzYWJsZShyYzYpOwogCXJjNi0+Y3R4X2NvcnJ1cHRlZCA9IHRydWU7CiAKLQlyZXR1
cm47CisJcmV0dXJuIHRydWU7CiB9CiAKIHN0YXRpYyB2b2lkIF9faW50ZWxfcmM2X2Rpc2FibGUo
c3RydWN0IGludGVsX3JjNiAqcmM2KQpAQCAtNjI3LDYgKzYyNiw5IEBAIHZvaWQgaW50ZWxfcmM2
X2VuYWJsZShzdHJ1Y3QgaW50ZWxfcmM2ICpyYzYpCiAJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUp
ID49IDYpCiAJCWdlbjZfcmM2X2VuYWJsZShyYzYpOwogCisJaWYgKE5FRURTX1JDNl9DVFhfQ09S
UlVQVElPTl9XQShpOTE1KSkKKwkJcmM2LT5jdGxfZW5hYmxlID0gMDsKKwogCWludGVsX3VuY29y
ZV9mb3JjZXdha2VfcHV0KHVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7CiAKIAkvKiByYzYgaXMgcmVh
ZHksIHJ1bnRpbWUtcG0gaXMgZ28hICovCkBAIC02NTIsNiArNjU0LDExIEBAIHZvaWQgaW50ZWxf
cmM2X3Bhcmsoc3RydWN0IGludGVsX3JjNiAqcmM2KQogCWlmICghcmM2LT5lbmFibGVkKQogCQly
ZXR1cm47CiAKKwlpZiAodW5saWtlbHkoaW50ZWxfcmM2X2N0eF93YV9jaGVjayhyYzYpKSkgewor
CQlpbnRlbF9yYzZfZGlzYWJsZShyYzYpOworCQlyZXR1cm47CisJfQorCiAJLyogVHVybiBvZmYg
dGhlIEhXIHRpbWVycyBhbmQgZ28gZGlyZWN0bHkgdG8gcmM2ICovCiAJc2V0KHVuY29yZSwgR0VO
Nl9SQ19DT05UUk9MLCBHRU42X1JDX0NUTF9SQzZfRU5BQkxFKTsKIAlzZXQodW5jb3JlLCBHRU42
X1JDX1NUQVRFLCAweDQgPDwgUkNfU1dfVEFSR0VUX1NUQVRFX1NISUZUKTsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JjNi5oIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfcmM2LmgKaW5kZXggMjBkNzQwZmY3ZTU1Li5mMjgyMTU3NmJmZDMgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JjNi5oCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX3JjNi5oCkBAIC0yNSw3ICsyNSw2IEBAIHZvaWQgaW50ZWxf
cmM2X2Rpc2FibGUoc3RydWN0IGludGVsX3JjNiAqcmM2KTsKIHU2NCBpbnRlbF9yYzZfcmVzaWRl
bmN5X25zKHN0cnVjdCBpbnRlbF9yYzYgKnJjNiwgaTkxNV9yZWdfdCByZWcpOwogdTY0IGludGVs
X3JjNl9yZXNpZGVuY3lfdXMoc3RydWN0IGludGVsX3JjNiAqcmM2LCBpOTE1X3JlZ190IHJlZyk7
CiAKLXZvaWQgaW50ZWxfcmM2X2N0eF93YV9jaGVjayhzdHJ1Y3QgaW50ZWxfcmM2ICpyYzYpOwog
dm9pZCBpbnRlbF9yYzZfY3R4X3dhX3Jlc3VtZShzdHJ1Y3QgaW50ZWxfcmM2ICpyYzYpOwogCiAj
ZW5kaWYgLyogSU5URUxfUkM2X0ggKi8KLS0gCjIuMjQuMAoKX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1n
ZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21h
aWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id DD9E9E1C9F
	for <lists+intel-gfx@lfdr.de>; Wed, 23 Oct 2019 15:31:23 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E8FA36EABF;
	Wed, 23 Oct 2019 13:31:21 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id F3B036EA19
 for <intel-gfx@lists.freedesktop.org>; Wed, 23 Oct 2019 13:31:19 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18937750-1500050 
 for <intel-gfx@lists.freedesktop.org>; Wed, 23 Oct 2019 14:31:15 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 23 Oct 2019 14:31:06 +0100
Message-Id: <20191023133108.21401-3-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0.rc0
In-Reply-To: <20191023133108.21401-1-chris@chris-wilson.co.uk>
References: <20191023133108.21401-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [CI 3/5] drm/i915/execlists: Cancel banned contexts on
 schedule-out
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T24gc2NoZWR1bGUtb3V0IChDUyBjb21wbGV0aW9uKSBvZiBhIGJhbm5lZCBjb250ZXh0LCBzY3J1
YiB0aGUgY29udGV4dAppbWFnZSBzbyB0aGF0IHdlIGRvIG5vdCByZXBsYXkgdGhlIGFjdGl2ZSBw
YXlsb2FkLiBUaGUgaW50ZW50IGlzIHRoYXQgd2UKc2tpcCBiYW5uZWQgcGF5bG9hZHMgb24gcmVx
dWVzdCBzdWJtaXNzaW9uIHNvIHRoYXQgdGhlIHRpbWVsaW5lCmFkdmFuY2VtZW50IGNvbnRpbnVl
cyBvbiBpbiB0aGUgYmFja2dyb3VuZC4gSG93ZXZlciwgaWYgd2UgYXJlIHJldHVybmluZwp0byBh
IHByZWVtcHRlZCByZXF1ZXN0LCBpOTE1X3JlcXVlc3Rfc2tpcCgpIGlzIGluZWZmZWN0aXZlIGFu
ZCBpbnN0ZWFkIHdlCm5lZWQgdG8gcGF0Y2ggdXAgdGhlIGNvbnRleHQgaW1hZ2Ugc28gdGhhdCBp
dCBjb250aW51ZXMgZnJvbSB0aGUgc3RhcnQKb2YgdGhlIG5leHQgcmVxdWVzdC4KCnYyOiBGaXh1
cCBjYW5jZWxsYXRpb24gc28gdGhhdCB3ZSBvbmx5IHNjcnViIHRoZSBwYXlsb2FkIG9mIHRoZSBh
Y3RpdmUKcmVxdWVzdCBhbmQgZG8gbm90IHNob3J0LWNpcmN1aXQgdGhlIGJyZWFkY3J1bWJzICh3
aGljaCBtaWdodCBjYXVzZQpvdGhlciBjb250ZXh0cyB0byBleGVjdXRlIG91dCBvZiBvcmRlciku
CnYzOiBHcmFtbWFyIHBhc3MKClNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hy
aXMtd2lsc29uLmNvLnVrPgpDYzogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVs
LmNvbT4KUmV2aWV3ZWQtYnk6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBpbnRlbC5j
b20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMgICAgfCAxMzEgKysr
KysrLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMgfCAzMjEgKysr
KysrKysrKysrKysrKysrKysrKysrKwogMiBmaWxlcyBjaGFuZ2VkLCA0MTEgaW5zZXJ0aW9ucygr
KSwgNDEgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfbHJjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwppbmRleCBm
ZjBkZDI5N2U3ODIuLjY1MWQ1ZGQzOTQ2NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfbHJjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJj
LmMKQEAgLTIzNCw2ICsyMzQsOSBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfaW5pdF9yZWdfc3Rh
dGUodTMyICpyZWdfc3RhdGUsCiAJCQkJICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmUsCiAJCQkJICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfcmluZyAqcmluZywKIAkJCQkg
ICAgIGJvb2wgY2xvc2UpOworc3RhdGljIHZvaWQKK19fZXhlY2xpc3RzX3VwZGF0ZV9yZWdfc3Rh
dGUoY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAorCQkJICAgICBjb25zdCBzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUpOwogCiBzdGF0aWMgdm9pZCBtYXJrX2VpbyhzdHJ1Y3Qg
aTkxNV9yZXF1ZXN0ICpycSkKIHsKQEAgLTI0Niw2ICsyNDksMzEgQEAgc3RhdGljIHZvaWQgbWFy
a19laW8oc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJaTkxNV9yZXF1ZXN0X21hcmtfY29tcGxl
dGUocnEpOwogfQogCitzdGF0aWMgc3RydWN0IGk5MTVfcmVxdWVzdCAqYWN0aXZlX3JlcXVlc3Qo
c3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCit7CisJY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQg
KiBjb25zdCBjZSA9IHJxLT5od19jb250ZXh0OworCXN0cnVjdCBpOTE1X3JlcXVlc3QgKmFjdGl2
ZSA9IE5VTEw7CisJc3RydWN0IGxpc3RfaGVhZCAqbGlzdDsKKworCWlmICghaTkxNV9yZXF1ZXN0
X2lzX2FjdGl2ZShycSkpIC8qIHVud291bmQsIGJ1dCBpbmNvbXBsZXRlISAqLworCQlyZXR1cm4g
cnE7CisKKwlyY3VfcmVhZF9sb2NrKCk7CisJbGlzdCA9ICZyY3VfZGVyZWZlcmVuY2UocnEtPnRp
bWVsaW5lKS0+cmVxdWVzdHM7CisJbGlzdF9mb3JfZWFjaF9lbnRyeV9mcm9tX3JldmVyc2UocnEs
IGxpc3QsIGxpbmspIHsKKwkJaWYgKGk5MTVfcmVxdWVzdF9jb21wbGV0ZWQocnEpKQorCQkJYnJl
YWs7CisKKwkJaWYgKHJxLT5od19jb250ZXh0ICE9IGNlKQorCQkJYnJlYWs7CisKKwkJYWN0aXZl
ID0gcnE7CisJfQorCXJjdV9yZWFkX3VubG9jaygpOworCisJcmV0dXJuIGFjdGl2ZTsKK30KKwog
c3RhdGljIGlubGluZSB1MzIgaW50ZWxfaHdzX3ByZWVtcHRfYWRkcmVzcyhzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUpCiB7CiAJcmV0dXJuIChpOTE1X2dndHRfb2Zmc2V0KGVuZ2luZS0+
c3RhdHVzX3BhZ2Uudm1hKSArCkBAIC05NzIsNiArMTAwMCw1OCBAQCBzdGF0aWMgdm9pZCBraWNr
X3NpYmxpbmdzKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAq
Y2UpCiAJCXRhc2tsZXRfc2NoZWR1bGUoJnZlLT5iYXNlLmV4ZWNsaXN0cy50YXNrbGV0KTsKIH0K
IAorc3RhdGljIHZvaWQgcmVzdG9yZV9kZWZhdWx0X3N0YXRlKHN0cnVjdCBpbnRlbF9jb250ZXh0
ICpjZSwKKwkJCQkgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwl1MzIgKnJl
Z3MgPSBjZS0+bHJjX3JlZ19zdGF0ZTsKKworCWlmIChlbmdpbmUtPnBpbm5lZF9kZWZhdWx0X3N0
YXRlKQorCQltZW1jcHkocmVncywgLyogc2tpcCByZXN0b3JpbmcgdGhlIHZhbmlsbGEgUFBIV1NQ
ICovCisJCSAgICAgICBlbmdpbmUtPnBpbm5lZF9kZWZhdWx0X3N0YXRlICsgTFJDX1NUQVRFX1BO
ICogUEFHRV9TSVpFLAorCQkgICAgICAgZW5naW5lLT5jb250ZXh0X3NpemUgLSBQQUdFX1NJWkUp
OworCisJZXhlY2xpc3RzX2luaXRfcmVnX3N0YXRlKHJlZ3MsIGNlLCBlbmdpbmUsIGNlLT5yaW5n
LCBmYWxzZSk7Cit9CisKK3N0YXRpYyB2b2lkIHJlc2V0X2FjdGl2ZShzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpycSwKKwkJCSBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJc3RydWN0
IGludGVsX2NvbnRleHQgKiBjb25zdCBjZSA9IHJxLT5od19jb250ZXh0OworCisJLyoKKwkgKiBU
aGUgZXhlY3V0aW5nIGNvbnRleHQgaGFzIGJlZW4gY2FuY2VsbGVkLiBXZSB3YW50IHRvIHByZXZl
bnQKKwkgKiBmdXJ0aGVyIGV4ZWN1dGlvbiBhbG9uZyB0aGlzIGNvbnRleHQgYW5kIHByb3BhZ2F0
ZSB0aGUgZXJyb3Igb24KKwkgKiB0byBhbnl0aGluZyBkZXBlbmRpbmcgb24gaXRzIHJlc3VsdHMu
CisJICoKKwkgKiBJbiBfX2k5MTVfcmVxdWVzdF9zdWJtaXQoKSwgd2UgYXBwbHkgdGhlIC1FSU8g
YW5kIHJlbW92ZSB0aGUKKwkgKiByZXF1ZXN0cycgcGF5bG9hZHMgZm9yIGFueSBiYW5uZWQgcmVx
dWVzdHMuIEJ1dCBmaXJzdCwgd2UgbXVzdAorCSAqIHJld2luZCB0aGUgY29udGV4dCBiYWNrIHRv
IHRoZSBzdGFydCBvZiB0aGUgaW5jb21wbGV0ZSByZXF1ZXN0IHNvCisJICogdGhhdCB3ZSBkbyBu
b3QganVtcCBiYWNrIGludG8gdGhlIG1pZGRsZSBvZiB0aGUgYmF0Y2guCisJICoKKwkgKiBXZSBw
cmVzZXJ2ZSB0aGUgYnJlYWRjcnVtYnMgYW5kIHNlbWFwaG9yZXMgb2YgdGhlIGluY29tcGxldGUK
KwkgKiByZXF1ZXN0cyBzbyB0aGF0IGludGVyLXRpbWVsaW5lIGRlcGVuZGVuY2llcyAoaS5lIG90
aGVyIHRpbWVsaW5lcykKKwkgKiByZW1haW4gY29ycmVjdGx5IG9yZGVyZWQuIEFuZCB3ZSBkZWZl
ciB0byBfX2k5MTVfcmVxdWVzdF9zdWJtaXQoKQorCSAqIHNvIHRoYXQgYWxsIGFzeW5jaHJvbm91
cyB3YWl0cyBhcmUgY29ycmVjdGx5IGhhbmRsZWQuCisJICovCisJR0VNX1RSQUNFKCIlcyglcyk6
IHsgcnE9JWxseDolbGxkIH1cbiIsCisJCSAgX19mdW5jX18sIGVuZ2luZS0+bmFtZSwgcnEtPmZl
bmNlLmNvbnRleHQsIHJxLT5mZW5jZS5zZXFubyk7CisKKwkvKiBPbiByZXN1Ym1pc3Npb24gb2Yg
dGhlIGFjdGl2ZSByZXF1ZXN0LCBwYXlsb2FkIHdpbGwgYmUgc2NydWJiZWQgKi8KKwlycSA9IGFj
dGl2ZV9yZXF1ZXN0KHJxKTsKKwlpZiAocnEpCisJCWNlLT5yaW5nLT5oZWFkID0gaW50ZWxfcmlu
Z193cmFwKGNlLT5yaW5nLCBycS0+aGVhZCk7CisJZWxzZQorCQljZS0+cmluZy0+aGVhZCA9IGNl
LT5yaW5nLT50YWlsOworCWludGVsX3JpbmdfdXBkYXRlX3NwYWNlKGNlLT5yaW5nKTsKKworCS8q
IFNjcnViIHRoZSBjb250ZXh0IGltYWdlIHRvIHByZXZlbnQgcmVwbGF5aW5nIHRoZSBwcmV2aW91
cyBiYXRjaCAqLworCXJlc3RvcmVfZGVmYXVsdF9zdGF0ZShjZSwgZW5naW5lKTsKKwlfX2V4ZWNs
aXN0c191cGRhdGVfcmVnX3N0YXRlKGNlLCBlbmdpbmUpOworCisJLyogV2UndmUgc3dpdGNoZWQg
YXdheSwgc28gdGhpcyBzaG91bGQgYmUgYSBuby1vcCwgYnV0IGludGVudCBtYXR0ZXJzICovCisJ
Y2UtPmxyY19kZXNjIHw9IENUWF9ERVNDX0ZPUkNFX1JFU1RPUkU7Cit9CisKIHN0YXRpYyBpbmxp
bmUgdm9pZAogX19leGVjbGlzdHNfc2NoZWR1bGVfb3V0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJx
LAogCQkJIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKiBjb25zdCBlbmdpbmUpCkBAIC05ODIsNiAr
MTA2Miw5IEBAIF9fZXhlY2xpc3RzX3NjaGVkdWxlX291dChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpy
cSwKIAlleGVjbGlzdHNfY29udGV4dF9zdGF0dXNfY2hhbmdlKHJxLCBJTlRFTF9DT05URVhUX1ND
SEVEVUxFX09VVCk7CiAJaW50ZWxfZ3RfcG1fcHV0KGVuZ2luZS0+Z3QpOwogCisJaWYgKHVubGlr
ZWx5KGk5MTVfZ2VtX2NvbnRleHRfaXNfYmFubmVkKGNlLT5nZW1fY29udGV4dCkpKQorCQlyZXNl
dF9hY3RpdmUocnEsIGVuZ2luZSk7CisKIAkvKgogCSAqIElmIHRoaXMgaXMgcGFydCBvZiBhIHZp
cnR1YWwgZW5naW5lLCBpdHMgbmV4dCByZXF1ZXN0IG1heQogCSAqIGhhdmUgYmVlbiBibG9ja2Vk
IHdhaXRpbmcgZm9yIGFjY2VzcyB0byB0aGUgYWN0aXZlIGNvbnRleHQuCkBAIC0xMzgwLDYgKzE0
NjMsMTAgQEAgc3RhdGljIHVuc2lnbmVkIGxvbmcgYWN0aXZlX3ByZWVtcHRfdGltZW91dChzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJaWYgKCFycSkKIAkJcmV0dXJuIDA7CiAKKwkv
KiBGb3JjZSBhIGZhc3QgcmVzZXQgZm9yIHRlcm1pbmF0ZWQgY29udGV4dHMgKGlnbm9yaW5nIHN5
c2ZzISkgKi8KKwlpZiAodW5saWtlbHkoaTkxNV9nZW1fY29udGV4dF9pc19iYW5uZWQocnEtPmdl
bV9jb250ZXh0KSkpCisJCXJldHVybiAxOworCiAJcmV0dXJuIFJFQURfT05DRShlbmdpbmUtPnBy
b3BzLnByZWVtcHRfdGltZW91dF9tcyk7CiB9CiAKQEAgLTI3OTIsMjkgKzI4NzksNiBAQCBzdGF0
aWMgdm9pZCByZXNldF9jc2JfcG9pbnRlcnMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KQogCQkJICAgICAgICZleGVjbGlzdHMtPmNzYl9zdGF0dXNbcmVzZXRfdmFsdWVdKTsKIH0KIAot
c3RhdGljIHN0cnVjdCBpOTE1X3JlcXVlc3QgKmFjdGl2ZV9yZXF1ZXN0KHN0cnVjdCBpOTE1X3Jl
cXVlc3QgKnJxKQotewotCWNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICogY29uc3QgY2UgPSBy
cS0+aHdfY29udGV4dDsKLQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICphY3RpdmUgPSBOVUxMOwotCXN0
cnVjdCBsaXN0X2hlYWQgKmxpc3Q7Ci0KLQlpZiAoIWk5MTVfcmVxdWVzdF9pc19hY3RpdmUocnEp
KSAvKiB1bndvdW5kLCBidXQgaW5jb21wbGV0ZSEgKi8KLQkJcmV0dXJuIHJxOwotCi0JbGlzdCA9
ICZpOTE1X3JlcXVlc3RfYWN0aXZlX3RpbWVsaW5lKHJxKS0+cmVxdWVzdHM7Ci0JbGlzdF9mb3Jf
ZWFjaF9lbnRyeV9mcm9tX3JldmVyc2UocnEsIGxpc3QsIGxpbmspIHsKLQkJaWYgKGk5MTVfcmVx
dWVzdF9jb21wbGV0ZWQocnEpKQotCQkJYnJlYWs7Ci0KLQkJaWYgKHJxLT5od19jb250ZXh0ICE9
IGNlKQotCQkJYnJlYWs7Ci0KLQkJYWN0aXZlID0gcnE7Ci0JfQotCi0JcmV0dXJuIGFjdGl2ZTsK
LX0KLQogc3RhdGljIHZvaWQgX19leGVjbGlzdHNfcmVzZXRfcmVnX3N0YXRlKGNvbnN0IHN0cnVj
dCBpbnRlbF9jb250ZXh0ICpjZSwKIAkJCQkJY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lKQogewpAQCAtMjgzMSw3ICsyODk1LDYgQEAgc3RhdGljIHZvaWQgX19leGVjbGlzdHNf
cmVzZXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBib29sIHN0YWxsZWQpCiAJc3Ry
dWN0IGludGVsX2VuZ2luZV9leGVjbGlzdHMgKiBjb25zdCBleGVjbGlzdHMgPSAmZW5naW5lLT5l
eGVjbGlzdHM7CiAJc3RydWN0IGludGVsX2NvbnRleHQgKmNlOwogCXN0cnVjdCBpOTE1X3JlcXVl
c3QgKnJxOwotCXUzMiAqcmVnczsKIAogCW1iKCk7IC8qIHBhcmFub2lhOiByZWFkIHRoZSBDU0Ig
cG9pbnRlcnMgZnJvbSBhZnRlciB0aGUgcmVzZXQgKi8KIAljbGZsdXNoKGV4ZWNsaXN0cy0+Y3Ni
X3dyaXRlKTsKQEAgLTI5MDcsMTMgKzI5NzAsNyBAQCBzdGF0aWMgdm9pZCBfX2V4ZWNsaXN0c19y
ZXNldChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIGJvb2wgc3RhbGxlZCkKIAkgKiB0
byByZWNyZWF0ZSBpdHMgb3duIHN0YXRlLgogCSAqLwogCUdFTV9CVUdfT04oIWludGVsX2NvbnRl
eHRfaXNfcGlubmVkKGNlKSk7Ci0JcmVncyA9IGNlLT5scmNfcmVnX3N0YXRlOwotCWlmIChlbmdp
bmUtPnBpbm5lZF9kZWZhdWx0X3N0YXRlKSB7Ci0JCW1lbWNweShyZWdzLCAvKiBza2lwIHJlc3Rv
cmluZyB0aGUgdmFuaWxsYSBQUEhXU1AgKi8KLQkJICAgICAgIGVuZ2luZS0+cGlubmVkX2RlZmF1
bHRfc3RhdGUgKyBMUkNfU1RBVEVfUE4gKiBQQUdFX1NJWkUsCi0JCSAgICAgICBlbmdpbmUtPmNv
bnRleHRfc2l6ZSAtIFBBR0VfU0laRSk7Ci0JfQotCWV4ZWNsaXN0c19pbml0X3JlZ19zdGF0ZShy
ZWdzLCBjZSwgZW5naW5lLCBjZS0+cmluZywgZmFsc2UpOworCXJlc3RvcmVfZGVmYXVsdF9zdGF0
ZShjZSwgZW5naW5lKTsKIAogb3V0X3JlcGxheToKIAlHRU1fVFJBQ0UoIiVzIHJlcGxheSB7aGVh
ZDolMDR4LCB0YWlsOiUwNHhcbiIsCkBAIC00NTc0LDE2ICs0NjMxLDggQEAgdm9pZCBpbnRlbF9s
cl9jb250ZXh0X3Jlc2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAkgKiBmdXR1
cmUgcmVxdWVzdCB3aWxsIGJlIGFmdGVyIHVzZXJzcGFjZSBoYXMgaGFkIHRoZSBvcHBvcnR1bml0
eQogCSAqIHRvIHJlY3JlYXRlIGl0cyBvd24gc3RhdGUuCiAJICovCi0JaWYgKHNjcnViKSB7Ci0J
CXUzMiAqcmVncyA9IGNlLT5scmNfcmVnX3N0YXRlOwotCi0JCWlmIChlbmdpbmUtPnBpbm5lZF9k
ZWZhdWx0X3N0YXRlKSB7Ci0JCQltZW1jcHkocmVncywgLyogc2tpcCByZXN0b3JpbmcgdGhlIHZh
bmlsbGEgUFBIV1NQICovCi0JCQkgICAgICAgZW5naW5lLT5waW5uZWRfZGVmYXVsdF9zdGF0ZSAr
IExSQ19TVEFURV9QTiAqIFBBR0VfU0laRSwKLQkJCSAgICAgICBlbmdpbmUtPmNvbnRleHRfc2l6
ZSAtIFBBR0VfU0laRSk7Ci0JCX0KLQkJZXhlY2xpc3RzX2luaXRfcmVnX3N0YXRlKHJlZ3MsIGNl
LCBlbmdpbmUsIGNlLT5yaW5nLCBmYWxzZSk7Ci0JfQorCWlmIChzY3J1YikKKwkJcmVzdG9yZV9k
ZWZhdWx0X3N0YXRlKGNlLCBlbmdpbmUpOwogCiAJLyogUmVydW4gdGhlIHJlcXVlc3Q7IGl0cyBw
YXlsb2FkIGhhcyBiZWVuIG5ldXRlcmVkIChpZiBndWlsdHkpLiAqLwogCWNlLT5yaW5nLT5oZWFk
ID0gaGVhZDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xy
Yy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKaW5kZXggYjYzNTI2
NzFjNWEwLi5kNWQyNjhiZTU1NGUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L3NlbGZ0ZXN0X2xyYy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xy
Yy5jCkBAIC03LDYgKzcsNyBAQAogI2luY2x1ZGUgPGxpbnV4L3ByaW1lX251bWJlcnMuaD4KIAog
I2luY2x1ZGUgImdlbS9pOTE1X2dlbV9wbS5oIgorI2luY2x1ZGUgImd0L2ludGVsX2VuZ2luZV9o
ZWFydGJlYXQuaCIKICNpbmNsdWRlICJndC9pbnRlbF9yZXNldC5oIgogCiAjaW5jbHVkZSAiaTkx
NV9zZWxmdGVzdC5oIgpAQCAtMTE2MCw2ICsxMTYxLDMyNSBAQCBzdGF0aWMgaW50IGxpdmVfbm9w
cmVlbXB0KHZvaWQgKmFyZykKIAlnb3RvIGVycl9jbGllbnRfYjsKIH0KIAorc3RydWN0IGxpdmVf
cHJlZW1wdF9jYW5jZWwgeworCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKKwlzdHJ1
Y3QgcHJlZW1wdF9jbGllbnQgYSwgYjsKK307CisKK3N0YXRpYyBpbnQgX19jYW5jZWxfYWN0aXZl
MChzdHJ1Y3QgbGl2ZV9wcmVlbXB0X2NhbmNlbCAqYXJnKQoreworCXN0cnVjdCBpOTE1X3JlcXVl
c3QgKnJxOworCXN0cnVjdCBpZ3RfbGl2ZV90ZXN0IHQ7CisJaW50IGVycjsKKworCS8qIFByZWVt
cHQgY2FuY2VsIG9mIEVMU1AwICovCisJR0VNX1RSQUNFKCIlcyglcylcbiIsIF9fZnVuY19fLCBh
cmctPmVuZ2luZS0+bmFtZSk7CisJaWYgKGlndF9saXZlX3Rlc3RfYmVnaW4oJnQsIGFyZy0+ZW5n
aW5lLT5pOTE1LAorCQkJCV9fZnVuY19fLCBhcmctPmVuZ2luZS0+bmFtZSkpCisJCXJldHVybiAt
RUlPOworCisJY2xlYXJfYml0KENPTlRFWFRfQkFOTkVELCAmYXJnLT5hLmN0eC0+ZmxhZ3MpOwor
CXJxID0gc3Bpbm5lcl9jcmVhdGVfcmVxdWVzdCgmYXJnLT5hLnNwaW4sCisJCQkJICAgIGFyZy0+
YS5jdHgsIGFyZy0+ZW5naW5lLAorCQkJCSAgICBNSV9BUkJfQ0hFQ0spOworCWlmIChJU19FUlIo
cnEpKQorCQlyZXR1cm4gUFRSX0VSUihycSk7CisKKwlpOTE1X3JlcXVlc3RfZ2V0KHJxKTsKKwlp
OTE1X3JlcXVlc3RfYWRkKHJxKTsKKwlpZiAoIWlndF93YWl0X2Zvcl9zcGlubmVyKCZhcmctPmEu
c3BpbiwgcnEpKSB7CisJCWVyciA9IC1FSU87CisJCWdvdG8gb3V0OworCX0KKworCWk5MTVfZ2Vt
X2NvbnRleHRfc2V0X2Jhbm5lZChhcmctPmEuY3R4KTsKKwllcnIgPSBpbnRlbF9lbmdpbmVfcHVs
c2UoYXJnLT5lbmdpbmUpOworCWlmIChlcnIpCisJCWdvdG8gb3V0OworCisJaWYgKGk5MTVfcmVx
dWVzdF93YWl0KHJxLCAwLCBIWiAvIDUpIDwgMCkgeworCQllcnIgPSAtRUlPOworCQlnb3RvIG91
dDsKKwl9CisKKwlpZiAocnEtPmZlbmNlLmVycm9yICE9IC1FSU8pIHsKKwkJcHJfZXJyKCJDYW5j
ZWxsZWQgaW5mbGlnaHQwIHJlcXVlc3QgZGlkIG5vdCByZXBvcnQgLUVJT1xuIik7CisJCWVyciA9
IC1FSU5WQUw7CisJCWdvdG8gb3V0OworCX0KKworb3V0OgorCWk5MTVfcmVxdWVzdF9wdXQocnEp
OworCWlmIChpZ3RfbGl2ZV90ZXN0X2VuZCgmdCkpCisJCWVyciA9IC1FSU87CisJcmV0dXJuIGVy
cjsKK30KKworc3RhdGljIGludCBfX2NhbmNlbF9hY3RpdmUxKHN0cnVjdCBsaXZlX3ByZWVtcHRf
Y2FuY2VsICphcmcpCit7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnFbMl0gPSB7fTsKKwlzdHJ1
Y3QgaWd0X2xpdmVfdGVzdCB0OworCWludCBlcnI7CisKKwkvKiBQcmVlbXB0IGNhbmNlbCBvZiBF
TFNQMSAqLworCUdFTV9UUkFDRSgiJXMoJXMpXG4iLCBfX2Z1bmNfXywgYXJnLT5lbmdpbmUtPm5h
bWUpOworCWlmIChpZ3RfbGl2ZV90ZXN0X2JlZ2luKCZ0LCBhcmctPmVuZ2luZS0+aTkxNSwKKwkJ
CQlfX2Z1bmNfXywgYXJnLT5lbmdpbmUtPm5hbWUpKQorCQlyZXR1cm4gLUVJTzsKKworCWNsZWFy
X2JpdChDT05URVhUX0JBTk5FRCwgJmFyZy0+YS5jdHgtPmZsYWdzKTsKKwlycVswXSA9IHNwaW5u
ZXJfY3JlYXRlX3JlcXVlc3QoJmFyZy0+YS5zcGluLAorCQkJCSAgICAgICBhcmctPmEuY3R4LCBh
cmctPmVuZ2luZSwKKwkJCQkgICAgICAgTUlfTk9PUCk7IC8qIG5vIHByZWVtcHRpb24gKi8KKwlp
ZiAoSVNfRVJSKHJxWzBdKSkKKwkJcmV0dXJuIFBUUl9FUlIocnFbMF0pOworCisJaTkxNV9yZXF1
ZXN0X2dldChycVswXSk7CisJaTkxNV9yZXF1ZXN0X2FkZChycVswXSk7CisJaWYgKCFpZ3Rfd2Fp
dF9mb3Jfc3Bpbm5lcigmYXJnLT5hLnNwaW4sIHJxWzBdKSkgeworCQllcnIgPSAtRUlPOworCQln
b3RvIG91dDsKKwl9CisKKwljbGVhcl9iaXQoQ09OVEVYVF9CQU5ORUQsICZhcmctPmIuY3R4LT5m
bGFncyk7CisJcnFbMV0gPSBzcGlubmVyX2NyZWF0ZV9yZXF1ZXN0KCZhcmctPmIuc3BpbiwKKwkJ
CQkgICAgICAgYXJnLT5iLmN0eCwgYXJnLT5lbmdpbmUsCisJCQkJICAgICAgIE1JX0FSQl9DSEVD
Syk7CisJaWYgKElTX0VSUihycVsxXSkpIHsKKwkJZXJyID0gUFRSX0VSUihycVsxXSk7CisJCWdv
dG8gb3V0OworCX0KKworCWk5MTVfcmVxdWVzdF9nZXQocnFbMV0pOworCWVyciA9IGk5MTVfcmVx
dWVzdF9hd2FpdF9kbWFfZmVuY2UocnFbMV0sICZycVswXS0+ZmVuY2UpOworCWk5MTVfcmVxdWVz
dF9hZGQocnFbMV0pOworCWlmIChlcnIpCisJCWdvdG8gb3V0OworCisJaTkxNV9nZW1fY29udGV4
dF9zZXRfYmFubmVkKGFyZy0+Yi5jdHgpOworCWVyciA9IGludGVsX2VuZ2luZV9wdWxzZShhcmct
PmVuZ2luZSk7CisJaWYgKGVycikKKwkJZ290byBvdXQ7CisKKwlpZ3Rfc3Bpbm5lcl9lbmQoJmFy
Zy0+YS5zcGluKTsKKwlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQocnFbMV0sIDAsIEhaIC8gNSkgPCAw
KSB7CisJCWVyciA9IC1FSU87CisJCWdvdG8gb3V0OworCX0KKworCWlmIChycVswXS0+ZmVuY2Uu
ZXJyb3IgIT0gMCkgeworCQlwcl9lcnIoIk5vcm1hbCBpbmZsaWdodDAgcmVxdWVzdCBkaWQgbm90
IGNvbXBsZXRlXG4iKTsKKwkJZXJyID0gLUVJTlZBTDsKKwkJZ290byBvdXQ7CisJfQorCisJaWYg
KHJxWzFdLT5mZW5jZS5lcnJvciAhPSAtRUlPKSB7CisJCXByX2VycigiQ2FuY2VsbGVkIGluZmxp
Z2h0MSByZXF1ZXN0IGRpZCBub3QgcmVwb3J0IC1FSU9cbiIpOworCQllcnIgPSAtRUlOVkFMOwor
CQlnb3RvIG91dDsKKwl9CisKK291dDoKKwlpOTE1X3JlcXVlc3RfcHV0KHJxWzFdKTsKKwlpOTE1
X3JlcXVlc3RfcHV0KHJxWzBdKTsKKwlpZiAoaWd0X2xpdmVfdGVzdF9lbmQoJnQpKQorCQllcnIg
PSAtRUlPOworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBpbnQgX19jYW5jZWxfcXVldWVkKHN0
cnVjdCBsaXZlX3ByZWVtcHRfY2FuY2VsICphcmcpCit7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAq
cnFbM10gPSB7fTsKKwlzdHJ1Y3QgaWd0X2xpdmVfdGVzdCB0OworCWludCBlcnI7CisKKwkvKiBG
dWxsIEVMU1AgYW5kIG9uZSBpbiB0aGUgd2luZ3MgKi8KKwlHRU1fVFJBQ0UoIiVzKCVzKVxuIiwg
X19mdW5jX18sIGFyZy0+ZW5naW5lLT5uYW1lKTsKKwlpZiAoaWd0X2xpdmVfdGVzdF9iZWdpbigm
dCwgYXJnLT5lbmdpbmUtPmk5MTUsCisJCQkJX19mdW5jX18sIGFyZy0+ZW5naW5lLT5uYW1lKSkK
KwkJcmV0dXJuIC1FSU87CisKKwljbGVhcl9iaXQoQ09OVEVYVF9CQU5ORUQsICZhcmctPmEuY3R4
LT5mbGFncyk7CisJcnFbMF0gPSBzcGlubmVyX2NyZWF0ZV9yZXF1ZXN0KCZhcmctPmEuc3BpbiwK
KwkJCQkgICAgICAgYXJnLT5hLmN0eCwgYXJnLT5lbmdpbmUsCisJCQkJICAgICAgIE1JX0FSQl9D
SEVDSyk7CisJaWYgKElTX0VSUihycVswXSkpCisJCXJldHVybiBQVFJfRVJSKHJxWzBdKTsKKwor
CWk5MTVfcmVxdWVzdF9nZXQocnFbMF0pOworCWk5MTVfcmVxdWVzdF9hZGQocnFbMF0pOworCWlm
ICghaWd0X3dhaXRfZm9yX3NwaW5uZXIoJmFyZy0+YS5zcGluLCBycVswXSkpIHsKKwkJZXJyID0g
LUVJTzsKKwkJZ290byBvdXQ7CisJfQorCisJY2xlYXJfYml0KENPTlRFWFRfQkFOTkVELCAmYXJn
LT5iLmN0eC0+ZmxhZ3MpOworCXJxWzFdID0gaWd0X3JlcXVlc3RfYWxsb2MoYXJnLT5iLmN0eCwg
YXJnLT5lbmdpbmUpOworCWlmIChJU19FUlIocnFbMV0pKSB7CisJCWVyciA9IFBUUl9FUlIocnFb
MV0pOworCQlnb3RvIG91dDsKKwl9CisKKwlpOTE1X3JlcXVlc3RfZ2V0KHJxWzFdKTsKKwllcnIg
PSBpOTE1X3JlcXVlc3RfYXdhaXRfZG1hX2ZlbmNlKHJxWzFdLCAmcnFbMF0tPmZlbmNlKTsKKwlp
OTE1X3JlcXVlc3RfYWRkKHJxWzFdKTsKKwlpZiAoZXJyKQorCQlnb3RvIG91dDsKKworCXJxWzJd
ID0gc3Bpbm5lcl9jcmVhdGVfcmVxdWVzdCgmYXJnLT5iLnNwaW4sCisJCQkJICAgICAgIGFyZy0+
YS5jdHgsIGFyZy0+ZW5naW5lLAorCQkJCSAgICAgICBNSV9BUkJfQ0hFQ0spOworCWlmIChJU19F
UlIocnFbMl0pKSB7CisJCWVyciA9IFBUUl9FUlIocnFbMl0pOworCQlnb3RvIG91dDsKKwl9CisK
KwlpOTE1X3JlcXVlc3RfZ2V0KHJxWzJdKTsKKwllcnIgPSBpOTE1X3JlcXVlc3RfYXdhaXRfZG1h
X2ZlbmNlKHJxWzJdLCAmcnFbMV0tPmZlbmNlKTsKKwlpOTE1X3JlcXVlc3RfYWRkKHJxWzJdKTsK
KwlpZiAoZXJyKQorCQlnb3RvIG91dDsKKworCWk5MTVfZ2VtX2NvbnRleHRfc2V0X2Jhbm5lZChh
cmctPmEuY3R4KTsKKwllcnIgPSBpbnRlbF9lbmdpbmVfcHVsc2UoYXJnLT5lbmdpbmUpOworCWlm
IChlcnIpCisJCWdvdG8gb3V0OworCisJaWYgKGk5MTVfcmVxdWVzdF93YWl0KHJxWzJdLCAwLCBI
WiAvIDUpIDwgMCkgeworCQllcnIgPSAtRUlPOworCQlnb3RvIG91dDsKKwl9CisKKwlpZiAocnFb
MF0tPmZlbmNlLmVycm9yICE9IC1FSU8pIHsKKwkJcHJfZXJyKCJDYW5jZWxsZWQgaW5mbGlnaHQw
IHJlcXVlc3QgZGlkIG5vdCByZXBvcnQgLUVJT1xuIik7CisJCWVyciA9IC1FSU5WQUw7CisJCWdv
dG8gb3V0OworCX0KKworCWlmIChycVsxXS0+ZmVuY2UuZXJyb3IgIT0gMCkgeworCQlwcl9lcnIo
Ik5vcm1hbCBpbmZsaWdodDEgcmVxdWVzdCBkaWQgbm90IGNvbXBsZXRlXG4iKTsKKwkJZXJyID0g
LUVJTlZBTDsKKwkJZ290byBvdXQ7CisJfQorCisJaWYgKHJxWzJdLT5mZW5jZS5lcnJvciAhPSAt
RUlPKSB7CisJCXByX2VycigiQ2FuY2VsbGVkIHF1ZXVlZCByZXF1ZXN0IGRpZCBub3QgcmVwb3J0
IC1FSU9cbiIpOworCQllcnIgPSAtRUlOVkFMOworCQlnb3RvIG91dDsKKwl9CisKK291dDoKKwlp
OTE1X3JlcXVlc3RfcHV0KHJxWzJdKTsKKwlpOTE1X3JlcXVlc3RfcHV0KHJxWzFdKTsKKwlpOTE1
X3JlcXVlc3RfcHV0KHJxWzBdKTsKKwlpZiAoaWd0X2xpdmVfdGVzdF9lbmQoJnQpKQorCQllcnIg
PSAtRUlPOworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBpbnQgX19jYW5jZWxfaG9zdGlsZShz
dHJ1Y3QgbGl2ZV9wcmVlbXB0X2NhbmNlbCAqYXJnKQoreworCXN0cnVjdCBpOTE1X3JlcXVlc3Qg
KnJxOworCWludCBlcnI7CisKKwkvKiBQcmVlbXB0IGNhbmNlbCBub24tcHJlZW1wdGlibGUgc3Bp
bm5lciBpbiBFTFNQMCAqLworCWlmICghQ09ORklHX0RSTV9JOTE1X1BSRUVNUFRfVElNRU9VVCkK
KwkJcmV0dXJuIDA7CisKKwlHRU1fVFJBQ0UoIiVzKCVzKVxuIiwgX19mdW5jX18sIGFyZy0+ZW5n
aW5lLT5uYW1lKTsKKwljbGVhcl9iaXQoQ09OVEVYVF9CQU5ORUQsICZhcmctPmEuY3R4LT5mbGFn
cyk7CisJcnEgPSBzcGlubmVyX2NyZWF0ZV9yZXF1ZXN0KCZhcmctPmEuc3BpbiwKKwkJCQkgICAg
YXJnLT5hLmN0eCwgYXJnLT5lbmdpbmUsCisJCQkJICAgIE1JX05PT1ApOyAvKiBwcmVlbXB0aW9u
IGRpc2FibGVkICovCisJaWYgKElTX0VSUihycSkpCisJCXJldHVybiBQVFJfRVJSKHJxKTsKKwor
CWk5MTVfcmVxdWVzdF9nZXQocnEpOworCWk5MTVfcmVxdWVzdF9hZGQocnEpOworCWlmICghaWd0
X3dhaXRfZm9yX3NwaW5uZXIoJmFyZy0+YS5zcGluLCBycSkpIHsKKwkJZXJyID0gLUVJTzsKKwkJ
Z290byBvdXQ7CisJfQorCisJaTkxNV9nZW1fY29udGV4dF9zZXRfYmFubmVkKGFyZy0+YS5jdHgp
OworCWVyciA9IGludGVsX2VuZ2luZV9wdWxzZShhcmctPmVuZ2luZSk7IC8qIGZvcmNlIHJlc2V0
ICovCisJaWYgKGVycikKKwkJZ290byBvdXQ7CisKKwlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQocnEs
IDAsIEhaIC8gNSkgPCAwKSB7CisJCWVyciA9IC1FSU87CisJCWdvdG8gb3V0OworCX0KKworCWlm
IChycS0+ZmVuY2UuZXJyb3IgIT0gLUVJTykgeworCQlwcl9lcnIoIkNhbmNlbGxlZCBpbmZsaWdo
dDAgcmVxdWVzdCBkaWQgbm90IHJlcG9ydCAtRUlPXG4iKTsKKwkJZXJyID0gLUVJTlZBTDsKKwkJ
Z290byBvdXQ7CisJfQorCitvdXQ6CisJaTkxNV9yZXF1ZXN0X3B1dChycSk7CisJaWYgKGlndF9m
bHVzaF90ZXN0KGFyZy0+ZW5naW5lLT5pOTE1KSkKKwkJZXJyID0gLUVJTzsKKwlyZXR1cm4gZXJy
OworfQorCitzdGF0aWMgaW50IGxpdmVfcHJlZW1wdF9jYW5jZWwodm9pZCAqYXJnKQoreworCXN0
cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7CisJc3RydWN0IGxpdmVfcHJlZW1wdF9jYW5jZWwgZGF0
YTsKKwllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKKwlpbnQgZXJyID0gLUVOT01FTTsKKworCS8q
CisJICogVG8gY2FuY2VsIGFuIGluZmxpZ2h0IGNvbnRleHQsIHdlIG5lZWQgdG8gZmlyc3QgcmVt
b3ZlIGl0IGZyb20gdGhlCisJICogR1BVLiBUaGF0IHNvdW5kcyBsaWtlIHByZWVtcHRpb24hIFBs
dXMgYSBsaXR0bGUgYml0IG9mIGJvb2trZWVwaW5nLgorCSAqLworCisJaWYgKCFIQVNfTE9HSUNB
TF9SSU5HX1BSRUVNUFRJT04oZ3QtPmk5MTUpKQorCQlyZXR1cm4gMDsKKworCWlmIChwcmVlbXB0
X2NsaWVudF9pbml0KGd0LCAmZGF0YS5hKSkKKwkJcmV0dXJuIC1FTk9NRU07CisJaWYgKHByZWVt
cHRfY2xpZW50X2luaXQoZ3QsICZkYXRhLmIpKQorCQlnb3RvIGVycl9jbGllbnRfYTsKKworCWZv
cl9lYWNoX2VuZ2luZShkYXRhLmVuZ2luZSwgZ3QsIGlkKSB7CisJCWlmICghaW50ZWxfZW5naW5l
X2hhc19wcmVlbXB0aW9uKGRhdGEuZW5naW5lKSkKKwkJCWNvbnRpbnVlOworCisJCWVyciA9IF9f
Y2FuY2VsX2FjdGl2ZTAoJmRhdGEpOworCQlpZiAoZXJyKQorCQkJZ290byBlcnJfd2VkZ2VkOwor
CisJCWVyciA9IF9fY2FuY2VsX2FjdGl2ZTEoJmRhdGEpOworCQlpZiAoZXJyKQorCQkJZ290byBl
cnJfd2VkZ2VkOworCisJCWVyciA9IF9fY2FuY2VsX3F1ZXVlZCgmZGF0YSk7CisJCWlmIChlcnIp
CisJCQlnb3RvIGVycl93ZWRnZWQ7CisKKwkJZXJyID0gX19jYW5jZWxfaG9zdGlsZSgmZGF0YSk7
CisJCWlmIChlcnIpCisJCQlnb3RvIGVycl93ZWRnZWQ7CisJfQorCisJZXJyID0gMDsKK2Vycl9j
bGllbnRfYjoKKwlwcmVlbXB0X2NsaWVudF9maW5pKCZkYXRhLmIpOworZXJyX2NsaWVudF9hOgor
CXByZWVtcHRfY2xpZW50X2ZpbmkoJmRhdGEuYSk7CisJcmV0dXJuIGVycjsKKworZXJyX3dlZGdl
ZDoKKwlHRU1fVFJBQ0VfRFVNUCgpOworCWlndF9zcGlubmVyX2VuZCgmZGF0YS5iLnNwaW4pOwor
CWlndF9zcGlubmVyX2VuZCgmZGF0YS5hLnNwaW4pOworCWludGVsX2d0X3NldF93ZWRnZWQoZ3Qp
OworCWdvdG8gZXJyX2NsaWVudF9iOworfQorCiBzdGF0aWMgaW50IGxpdmVfc3VwcHJlc3Nfc2Vs
Zl9wcmVlbXB0KHZvaWQgKmFyZykKIHsKIAlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOwpAQCAt
MjY5Myw2ICszMDEzLDcgQEAgaW50IGludGVsX2V4ZWNsaXN0c19saXZlX3NlbGZ0ZXN0cyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkJU1VCVEVTVChsaXZlX3ByZWVtcHQpLAogCQlT
VUJURVNUKGxpdmVfbGF0ZV9wcmVlbXB0KSwKIAkJU1VCVEVTVChsaXZlX25vcHJlZW1wdCksCisJ
CVNVQlRFU1QobGl2ZV9wcmVlbXB0X2NhbmNlbCksCiAJCVNVQlRFU1QobGl2ZV9zdXBwcmVzc19z
ZWxmX3ByZWVtcHQpLAogCQlTVUJURVNUKGxpdmVfc3VwcHJlc3Nfd2FpdF9wcmVlbXB0KSwKIAkJ
U1VCVEVTVChsaXZlX2NoYWluX3ByZWVtcHQpLAotLSAKMi4yNC4wLnJjMAoKX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlz
dApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0
b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 5AB471BE29
	for <lists+intel-gfx@lfdr.de>; Mon, 13 May 2019 21:45:56 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 4D5B1891AC;
	Mon, 13 May 2019 19:45:54 +0000 (UTC)
X-Original-To: Intel-GFX@lists.freedesktop.org
Delivered-To: Intel-GFX@lists.freedesktop.org
Received: from mga18.intel.com (mga18.intel.com [134.134.136.126])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 219A6891AC
 for <Intel-GFX@lists.freedesktop.org>; Mon, 13 May 2019 19:45:53 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga006.jf.intel.com ([10.7.209.51])
 by orsmga106.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 13 May 2019 12:45:52 -0700
X-ExtLoop1: 1
Received: from relo-linux-5.ra.intel.com ([10.54.133.84])
 by orsmga006.jf.intel.com with ESMTP; 13 May 2019 12:45:52 -0700
From: John.C.Harrison@Intel.com
To: Intel-GFX@Lists.FreeDesktop.Org
Date: Mon, 13 May 2019 12:45:52 -0700
Message-Id: <20190513194552.6600-1-John.C.Harrison@Intel.com>
X-Mailer: git-send-email 2.21.0.5.gaeb582a983
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915: Engine relative MMIO
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Wilson@freedesktop.org, Chris P <chris.p.wilson@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogSm9obiBIYXJyaXNvbiA8Sm9obi5DLkhhcnJpc29uQEludGVsLmNvbT4KCldpdGggdmly
dHVhbCBlbmdpbmVzLCBpdCBpcyBubyBsb25nZXIgcG9zc2libGUgdG8ga25vdyB3aGljaCBzcGVj
aWZpYwpwaHlzaWNhbCBlbmdpbmUgYSBnaXZlbiByZXF1ZXN0IHdpbGwgYmUgZXhlY3V0ZWQgb24g
YXQgdGhlIHRpbWUgdGhhdApyZXF1ZXN0IGlzIGdlbmVyYXRlZC4gVGhpcyBtZWFucyB0aGF0IHRo
ZSByZXF1ZXN0IGl0c2VsZiBtdXN0IGJlIGVuZ2luZQphZ25vc3RpYyAtIGFueSBkaXJlY3QgcmVn
aXN0ZXIgd3JpdGVzIG11c3QgYmUgcmVsYXRpdmUgdG8gdGhlIGVuZ2luZQphbmQgbm90IGFic29s
dXRlIGFkZHJlc3Nlcy4KClRoZSBMUkkgY29tbWFuZCBoYXMgc3VwcG9ydCBmb3IgZW5naW5lIHJl
bGF0aXZlIGFkZHJlc3NpbmcuIEhvd2V2ZXIsCnRoZSBtZWNoYW5pc20gaXMgbm90IHRyYW5zcGFy
ZW50IHRvIHRoZSBkcml2ZXIuIFRoZSBzY2hlbWUgZm9yIEdlbjExCihNSV9MUklfQUREX0NTX01N
SU9fU1RBUlQpIHJlcXVpcmVzIHRoZSBMUkkgYWRkcmVzcyB0byBoYXZlIG5vCmFic29sdXRlIGVu
Z2luZSBiYXNlIGNvbXBvbmVudC4gVGhlIGhhcmR3YXJlIHRoZW4gYWRkcyBvbiB0aGUgY29ycmVj
dAplbmdpbmUgb2Zmc2V0IGF0IGV4ZWN1dGlvbiB0aW1lLgoKRHVlIHRvIHRoZSBub24tdHJpdmlh
bCBhbmQgZGlmZmVyaW5nIHNjaGVtZXMgb24gZGlmZmVyZW50IGhhcmR3YXJlLCBpdAppcyBub3Qg
cG9zc2libGUgdG8gc2ltcGx5IHVwZGF0ZSB0aGUgY29kZSB0aGF0IGNyZWF0ZXMgdGhlIExSSQpj
b21tYW5kcyB0byBzZXQgYSByZW1hcCBmbGFnIGFuZCBsZXQgdGhlIGhhcmR3YXJlIGdldCBvbiB3
aXRoIGl0LgpJbnN0ZWFkLCB0aGlzIHBhdGNoIGFkZHMgZnVuY3Rpb24gd3JhcHBlcnMgZm9yIGdl
bmVyYXRpbmcgdGhlIExSSQpjb21tYW5kIGl0c2VsZiBhbmQgdGhlbiBmb3IgY29uc3RydWN0aW5n
IHRoZSBjb3JyZWN0IGFkZHJlc3MgdG8gdXNlCndpdGggdGhlIExSSS4KCnYyOiBGaXggYnVpbGQg
YnJlYWsgaW4gR1ZULiBSZW1vdmUgZmxhZ3MgcGFyYW1ldGVyIFtyZXZpZXcgZmVlZGJhY2sKZnJv
bSBDaHJpcyBXXS4KCnYzOiBGaXggYnVpbGQgYnJlYWsgaW4gc2VsZnRlc3QuIFJlYmFzZSB0byBu
ZXdlciBiYXNlIHRyZWUgYW5kIGZpeAptZXJnZSBjb25mbGljdC4KCnY0OiBNb3JlIHJlYmFzaW5n
LiBSbW92ZWQgcmVsYXRpdmUgYWRkcmVzc2luZyBzdXBwb3J0IGZyb20gR2VuNy05IG9ubHkKY29k
ZSBwYXRocyBbcmV2aWV3IGZlZWRiYWNrIGZyb20gQ2hyaXMgV10uCgp2NTogTW9yZSByZWJhc2lu
ZyAobmV3ICdndCcgZGlyZWN0b3J5KS4gRml4IHdoaXRlIHNwYWNlIGlzc3VlLiBVc2UKQ09QWSBj
bGFzcyByYXRoZXIgdGhhbiBCQ1MwIGlkIGZvciBjaGVja2luZyBhZ2FpbnN0IEJDUyBlbmdpbmUu
CgpTaWduZWQtb2ZmLWJ5OiBKb2huIEhhcnJpc29uIDxKb2huLkMuSGFycmlzb25ASW50ZWwuY29t
PgpDQzogUm9kcmlnbyBWaXZpIDxyb2RyaWdvLnZpdmlAaW50ZWwuY29tPgpDQzogVHZydGtvIFVy
c3VsaW4gPHR2cnRrby51cnN1bGluQGxpbnV4LmludGVsLmNvbT4KQ0M6IFdpbHNvbiwgQ2hyaXMg
UCA8Y2hyaXMucC53aWxzb25AaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2VuZ2luZS5oICAgICAgICB8ICA0ICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2VuZ2luZV9jcy5jICAgICB8IDExICsrKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZ3B1X2NvbW1hbmRzLmggIHwgIDYgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2xyYy5jICAgICAgICAgICB8IDc5ICsrKysrKysrKystLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2xyY19yZWcuaCAgICAgICB8ICA0ICstCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9tb2NzLmMgICAgICAgICAgfCAxNyArKy0tCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMgICAgfCA0NSArKysrKysrKystLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfd29ya2Fyb3VuZHMuYyAgIHwgIDQgKy0KIC4uLi9ncHUvZHJt
L2k5MTUvZ3Qvc2VsZnRlc3Rfd29ya2Fyb3VuZHMuYyAgICB8ICA5ICsrLQogZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3Z0L21taW9fY29udGV4dC5jICAgICAgIHwgMTYgKysrLQogZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9jbWRfcGFyc2VyLmMgICAgICAgIHwgIDQgKy0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZ2VtX2NvbnRleHQuYyAgICAgICB8IDEyICstLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9nZW1fZXhlY2J1ZmZlci5jICAgIHwgIDMgKy0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfcGVyZi5jICAgICAgICAgICAgICB8IDE5ICsrKy0tCiAxNCBmaWxlcyBjaGFuZ2Vk
LCAxNTQgaW5zZXJ0aW9ucygrKSwgNzkgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9lbmdpbmUuaAppbmRleCA5MzU5YjNhN2FkOWMuLjM1MDZjOTkyMTgyYyAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lLmgKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lLmgKQEAgLTU0Niw0ICs1NDYsOCBAQCBzdGF0
aWMgaW5saW5lIGJvb2wgaW5qZWN0X3ByZWVtcHRfaGFuZyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4
ZWNsaXN0cyAqZXhlY2xpc3RzKQogCiAjZW5kaWYKIAorYm9vbCBpOTE1X2VuZ2luZV9oYXNfcmVs
YXRpdmVfbHJpKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7Cit1MzIgaTkx
NV9nZXRfbHJpX2NtZChjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHUzMiB3
b3JkX2NvdW50KTsKK3UzMiBpOTE1X2dldF9scmlfcmVnKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSwgaTkxNV9yZWdfdCByZWcpOworCiAjZW5kaWYgLyogX0lOVEVMX1JJTkdC
VUZGRVJfSF8gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2Vu
Z2luZV9jcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKaW5k
ZXggNGMzNzUzYzFiNTczLi4yMzMyOTVkNjg5ZDIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2VuZ2luZV9jcy5jCkBAIC0yNTMsNiArMjUzLDE3IEBAIHN0YXRpYyB1MzIgX19lbmdp
bmVfbW1pb19iYXNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCXJldHVybiBiYXNl
c1tpXS5iYXNlOwogfQogCitib29sIGk5MTVfZW5naW5lX2hhc19yZWxhdGl2ZV9scmkoY29uc3Qg
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCWlmIChJTlRFTF9HRU4oZW5naW5l
LT5pOTE1KSA8IDExKQorCQlyZXR1cm4gZmFsc2U7CisKKwlpZiAoZW5naW5lLT5jbGFzcyA9PSBD
T1BZX0VOR0lORV9DTEFTUykKKwkJcmV0dXJuIGZhbHNlOworCisJcmV0dXJuIHRydWU7Cit9CisK
IHN0YXRpYyB2b2lkIF9fc3ByaW50X2VuZ2luZV9uYW1lKGNoYXIgKm5hbWUsIGNvbnN0IHN0cnVj
dCBlbmdpbmVfaW5mbyAqaW5mbykKIHsKIAlXQVJOX09OKHNucHJpbnRmKG5hbWUsIElOVEVMX0VO
R0lORV9DU19NQVhfTkFNRSwgIiVzJXUiLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZ3B1X2NvbW1hbmRzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9ncHVfY29tbWFuZHMuaAppbmRleCBhMzRlY2U1M2E3NzEuLmU3Nzg0YjNmYjc1OSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3B1X2NvbW1hbmRzLmgKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3B1X2NvbW1hbmRzLmgKQEAgLTEyMyw5ICsx
MjMsMTMgQEAKICAqICAgc2ltcGx5IGlnbm9yZXMgdGhlIHJlZ2lzdGVyIGxvYWQgdW5kZXIgY2Vy
dGFpbiBjb25kaXRpb25zLgogICogLSBPbmUgY2FuIGFjdHVhbGx5IGxvYWQgYXJiaXRyYXJ5IG1h
bnkgYXJiaXRyYXJ5IHJlZ2lzdGVyczogU2ltcGx5IGlzc3VlIHgKICAqICAgYWRkcmVzcy92YWx1
ZSBwYWlycy4gRG9uJ3Qgb3ZlcmR1ZSBpdCwgdGhvdWdoLCB4IDw9IDJeNCBtdXN0IGhvbGQhCisg
KiAtIE5ld2VyIGhhcmR3YXJlIHN1cHBvcnRzIGVuZ2luZSByZWxhdGl2ZSBhZGRyZXNzZXMgYnV0
IG9sZGVyIGhhcmR3YXJlIGRvZXMKKyAqICAgbm90LiBTbyBuZXZlciBjYWxsIE1JX0xSSSBkaXJl
Y3RseSwgYWx3YXlzIHVzZSB0aGUgaTkxNV9nZXRfbHJpX2NtZCgpCisgKiAgIGFuZCBpOTE1X2dl
dF9scmlfcmVnKCkgaGVscGVyIGZ1bmN0aW9ucy4KICAqLwotI2RlZmluZSBNSV9MT0FEX1JFR0lT
VEVSX0lNTSh4KQlNSV9JTlNUUigweDIyLCAyKih4KS0xKQorI2RlZmluZSBfX01JX0xPQURfUkVH
SVNURVJfSU1NKHgpCU1JX0lOU1RSKDB4MjIsIDIqKHgpLTEpCiAjZGVmaW5lICAgTUlfTFJJX0ZP
UkNFX1BPU1RFRAkJKDE8PDEyKQorI2RlZmluZSAgIE1JX0xSSV9BRERfQ1NfTU1JT19TVEFSVF9H
RU4xMQkoMTw8MTkpCiAjZGVmaW5lIE1JX1NUT1JFX1JFR0lTVEVSX01FTSAgICAgICAgTUlfSU5T
VFIoMHgyNCwgMSkKICNkZWZpbmUgTUlfU1RPUkVfUkVHSVNURVJfTUVNX0dFTjggICBNSV9JTlNU
UigweDI0LCAyKQogI2RlZmluZSAgIE1JX1NSTV9MUk1fR0xPQkFMX0dUVAkJKDE8PDIyKQpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwppbmRleCBlMTg2MjNkZWYyODIuLjQ5YTlhNjY0OGI5
YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKQEAgLTEzODgsMTQgKzEzODgsMTUg
QEAgc3RhdGljIGludCBlbWl0X3BkcHMoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJCXJldHVy
biBQVFJfRVJSKGNzKTsKIAogCS8qIEVuc3VyZSB0aGUgTFJJIGhhdmUgbGFuZGVkIGJlZm9yZSB3
ZSBpbnZhbGlkYXRlICYgY29udGludWUgKi8KLQkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJfSU1N
KDIgKiBHRU44XzNMVkxfUERQRVMpIHwgTUlfTFJJX0ZPUkNFX1BPU1RFRDsKKwkqY3MrKyA9IGk5
MTVfZ2V0X2xyaV9jbWQoZW5naW5lLCAyICogR0VOOF8zTFZMX1BEUEVTKSB8CisJCQkJIE1JX0xS
SV9GT1JDRV9QT1NURUQ7CiAJZm9yIChpID0gR0VOOF8zTFZMX1BEUEVTOyBpLS07ICkgewogCQlj
b25zdCBkbWFfYWRkcl90IHBkX2RhZGRyID0gaTkxNV9wYWdlX2Rpcl9kbWFfYWRkcihwcGd0dCwg
aSk7CiAJCXUzMiBiYXNlID0gZW5naW5lLT5tbWlvX2Jhc2U7CiAKLQkJKmNzKysgPSBpOTE1X21t
aW9fcmVnX29mZnNldChHRU44X1JJTkdfUERQX1VEVyhiYXNlLCBpKSk7CisJCSpjcysrID0gaTkx
NV9nZXRfbHJpX3JlZyhlbmdpbmUsIEdFTjhfUklOR19QRFBfVURXKGJhc2UsIGkpKTsKIAkJKmNz
KysgPSB1cHBlcl8zMl9iaXRzKHBkX2RhZGRyKTsKLQkJKmNzKysgPSBpOTE1X21taW9fcmVnX29m
ZnNldChHRU44X1JJTkdfUERQX0xEVyhiYXNlLCBpKSk7CisJCSpjcysrID0gaTkxNV9nZXRfbHJp
X3JlZyhlbmdpbmUsIEdFTjhfUklOR19QRFBfTERXKGJhc2UsIGkpKTsKIAkJKmNzKysgPSBsb3dl
cl8zMl9iaXRzKHBkX2RhZGRyKTsKIAl9CiAJKmNzKysgPSBNSV9OT09QOwpAQCAtMTQ2OSw3ICsx
NDcwLDggQEAgZ2VuOF9lbWl0X2ZsdXNoX2NvaGVyZW50bDNfd2Eoc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lLCB1MzIgKmJhdGNoKQogCSpiYXRjaCsrID0gaTkxNV9zY3JhdGNoX29mZnNl
dChlbmdpbmUtPmk5MTUpICsgMjU2OwogCSpiYXRjaCsrID0gMDsKIAotCSpiYXRjaCsrID0gTUlf
TE9BRF9SRUdJU1RFUl9JTU0oMSk7CisJLyogR2VuOC85IG9ubHkgc28gbm8gbmVlZCB0byBzdXBw
b3J0IHJlbGF0aXZlIG9mZnNldHMgKi8KKwkqYmF0Y2grKyA9IF9fTUlfTE9BRF9SRUdJU1RFUl9J
TU0oMSk7CiAJKmJhdGNoKysgPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X0wzU1FDUkVHNCk7
CiAJKmJhdGNoKysgPSAweDQwNDAwMDAwIHwgR0VOOF9MUVNDX0ZMVVNIX0NPSEVSRU5UX0xJTkVT
OwogCkBAIC0xNTQwLDEzICsxNTQyLDE0IEBAIHN0cnVjdCBscmkgewogCXUzMiB2YWx1ZTsKIH07
CiAKLXN0YXRpYyB1MzIgKmVtaXRfbHJpKHUzMiAqYmF0Y2gsIGNvbnN0IHN0cnVjdCBscmkgKmxy
aSwgdW5zaWduZWQgaW50IGNvdW50KQorc3RhdGljIHUzMiAqZW1pdF9scmkoc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lLCB1MzIgKmJhdGNoLAorCQkgICAgIGNvbnN0IHN0cnVjdCBscmkg
KmxyaSwgdW5zaWduZWQgaW50IGNvdW50KQogewogCUdFTV9CVUdfT04oIWNvdW50IHx8IGNvdW50
ID4gNjMpOwogCi0JKmJhdGNoKysgPSBNSV9MT0FEX1JFR0lTVEVSX0lNTShjb3VudCk7CisJKmJh
dGNoKysgPSBpOTE1X2dldF9scmlfY21kKGVuZ2luZSwgY291bnQpOwogCWRvIHsKLQkJKmJhdGNo
KysgPSBpOTE1X21taW9fcmVnX29mZnNldChscmktPnJlZyk7CisJCSpiYXRjaCsrID0gaTkxNV9n
ZXRfbHJpX3JlZyhlbmdpbmUsIGxyaS0+cmVnKTsKIAkJKmJhdGNoKysgPSBscmktPnZhbHVlOwog
CX0gd2hpbGUgKGxyaSsrLCAtLWNvdW50KTsKIAkqYmF0Y2grKyA9IE1JX05PT1A7CkBAIC0xNTg0
LDcgKzE1ODcsNyBAQCBzdGF0aWMgdTMyICpnZW45X2luaXRfaW5kaXJlY3RjdHhfYmIoc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1MzIgKmJhdGNoKQogCS8qIFdhRmx1c2hDb2hlcmVu
dEwzQ2FjaGVMaW5lc0F0Q29udGV4dFN3aXRjaDpza2wsYnh0LGdsayAqLwogCWJhdGNoID0gZ2Vu
OF9lbWl0X2ZsdXNoX2NvaGVyZW50bDNfd2EoZW5naW5lLCBiYXRjaCk7CiAKLQliYXRjaCA9IGVt
aXRfbHJpKGJhdGNoLCBscmksIEFSUkFZX1NJWkUobHJpKSk7CisJYmF0Y2ggPSBlbWl0X2xyaShl
bmdpbmUsIGJhdGNoLCBscmksIEFSUkFZX1NJWkUobHJpKSk7CiAKIAkvKiBXYU1lZGlhUG9vbFN0
YXRlQ21kSW5XQUJCOmJ4dCxnbGsgKi8KIAlpZiAoSEFTX1BPT0xFRF9FVShlbmdpbmUtPmk5MTUp
KSB7CkBAIC0yNTM3LDEwICsyNTQwLDEwIEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19pbml0X3Jl
Z19zdGF0ZSh1MzIgKnJlZ3MsCiAJICogdmFsdWVzIChpbmNsdWRpbmcgYWxsIHRoZSBtaXNzaW5n
IE1JX0xPQURfUkVHSVNURVJfSU1NIGNvbW1hbmRzIHRoYXQKIAkgKiB3ZSBhcmUgbm90IGluaXRp
YWxpemluZyBoZXJlKS4KIAkgKi8KLQlyZWdzW0NUWF9MUklfSEVBREVSXzBdID0gTUlfTE9BRF9S
RUdJU1RFUl9JTU0ocmNzID8gMTQgOiAxMSkgfAotCQkJCSBNSV9MUklfRk9SQ0VfUE9TVEVEOwor
CXJlZ3NbQ1RYX0xSSV9IRUFERVJfMF0gPSBpOTE1X2dldF9scmlfY21kKGVuZ2luZSwgcmNzID8g
MTQgOiAxMSkgfAorCQkJCQkJICBNSV9MUklfRk9SQ0VfUE9TVEVEOwogCi0JQ1RYX1JFRyhyZWdz
LCBDVFhfQ09OVEVYVF9DT05UUk9MLCBSSU5HX0NPTlRFWFRfQ09OVFJPTChiYXNlKSwKKwlDVFhf
UkVHKGVuZ2luZSwgcmVncywgQ1RYX0NPTlRFWFRfQ09OVFJPTCwgUklOR19DT05URVhUX0NPTlRS
T0woYmFzZSksCiAJCV9NQVNLRURfQklUX0RJU0FCTEUoQ1RYX0NUUkxfRU5HSU5FX0NUWF9SRVNU
T1JFX0lOSElCSVQpIHwKIAkJX01BU0tFRF9CSVRfRU5BQkxFKENUWF9DVFJMX0lOSElCSVRfU1lO
X0NUWF9TV0lUQ0gpKTsKIAlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPCAxMSkgewpAQCAt
MjU0OCwyMiArMjU1MSwyMyBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfaW5pdF9yZWdfc3RhdGUo
dTMyICpyZWdzLAogCQkJX01BU0tFRF9CSVRfRElTQUJMRShDVFhfQ1RSTF9FTkdJTkVfQ1RYX1NB
VkVfSU5ISUJJVCB8CiAJCQkJCSAgICBDVFhfQ1RSTF9SU19DVFhfRU5BQkxFKTsKIAl9Ci0JQ1RY
X1JFRyhyZWdzLCBDVFhfUklOR19IRUFELCBSSU5HX0hFQUQoYmFzZSksIDApOwotCUNUWF9SRUco
cmVncywgQ1RYX1JJTkdfVEFJTCwgUklOR19UQUlMKGJhc2UpLCAwKTsKLQlDVFhfUkVHKHJlZ3Ms
IENUWF9SSU5HX0JVRkZFUl9TVEFSVCwgUklOR19TVEFSVChiYXNlKSwgMCk7Ci0JQ1RYX1JFRyhy
ZWdzLCBDVFhfUklOR19CVUZGRVJfQ09OVFJPTCwgUklOR19DVEwoYmFzZSksCisJQ1RYX1JFRyhl
bmdpbmUsIHJlZ3MsIENUWF9SSU5HX0hFQUQsIFJJTkdfSEVBRChiYXNlKSwgMCk7CisJQ1RYX1JF
RyhlbmdpbmUsIHJlZ3MsIENUWF9SSU5HX1RBSUwsIFJJTkdfVEFJTChiYXNlKSwgMCk7CisJQ1RY
X1JFRyhlbmdpbmUsIHJlZ3MsIENUWF9SSU5HX0JVRkZFUl9TVEFSVCwgUklOR19TVEFSVChiYXNl
KSwgMCk7CisJQ1RYX1JFRyhlbmdpbmUsIHJlZ3MsIENUWF9SSU5HX0JVRkZFUl9DT05UUk9MLCBS
SU5HX0NUTChiYXNlKSwKIAkJUklOR19DVExfU0laRShyaW5nLT5zaXplKSB8IFJJTkdfVkFMSUQp
OwotCUNUWF9SRUcocmVncywgQ1RYX0JCX0hFQURfVSwgUklOR19CQkFERFJfVURXKGJhc2UpLCAw
KTsKLQlDVFhfUkVHKHJlZ3MsIENUWF9CQl9IRUFEX0wsIFJJTkdfQkJBRERSKGJhc2UpLCAwKTsK
LQlDVFhfUkVHKHJlZ3MsIENUWF9CQl9TVEFURSwgUklOR19CQlNUQVRFKGJhc2UpLCBSSU5HX0JC
X1BQR1RUKTsKLQlDVFhfUkVHKHJlZ3MsIENUWF9TRUNPTkRfQkJfSEVBRF9VLCBSSU5HX1NCQkFE
RFJfVURXKGJhc2UpLCAwKTsKLQlDVFhfUkVHKHJlZ3MsIENUWF9TRUNPTkRfQkJfSEVBRF9MLCBS
SU5HX1NCQkFERFIoYmFzZSksIDApOwotCUNUWF9SRUcocmVncywgQ1RYX1NFQ09ORF9CQl9TVEFU
RSwgUklOR19TQkJTVEFURShiYXNlKSwgMCk7CisJQ1RYX1JFRyhlbmdpbmUsIHJlZ3MsIENUWF9C
Ql9IRUFEX1UsIFJJTkdfQkJBRERSX1VEVyhiYXNlKSwgMCk7CisJQ1RYX1JFRyhlbmdpbmUsIHJl
Z3MsIENUWF9CQl9IRUFEX0wsIFJJTkdfQkJBRERSKGJhc2UpLCAwKTsKKwlDVFhfUkVHKGVuZ2lu
ZSwgcmVncywgQ1RYX0JCX1NUQVRFLCBSSU5HX0JCU1RBVEUoYmFzZSksIFJJTkdfQkJfUFBHVFQp
OworCUNUWF9SRUcoZW5naW5lLCByZWdzLCBDVFhfU0VDT05EX0JCX0hFQURfVSwgUklOR19TQkJB
RERSX1VEVyhiYXNlKSwgMCk7CisJQ1RYX1JFRyhlbmdpbmUsIHJlZ3MsIENUWF9TRUNPTkRfQkJf
SEVBRF9MLCBSSU5HX1NCQkFERFIoYmFzZSksIDApOworCUNUWF9SRUcoZW5naW5lLCByZWdzLCBD
VFhfU0VDT05EX0JCX1NUQVRFLCBSSU5HX1NCQlNUQVRFKGJhc2UpLCAwKTsKIAlpZiAocmNzKSB7
CiAJCXN0cnVjdCBpOTE1X2N0eF93b3JrYXJvdW5kcyAqd2FfY3R4ID0gJmVuZ2luZS0+d2FfY3R4
OwogCi0JCUNUWF9SRUcocmVncywgQ1RYX1JDU19JTkRJUkVDVF9DVFgsIFJJTkdfSU5ESVJFQ1Rf
Q1RYKGJhc2UpLCAwKTsKLQkJQ1RYX1JFRyhyZWdzLCBDVFhfUkNTX0lORElSRUNUX0NUWF9PRkZT
RVQsCisJCUNUWF9SRUcoZW5naW5lLCByZWdzLCBDVFhfUkNTX0lORElSRUNUX0NUWCwKKwkJCVJJ
TkdfSU5ESVJFQ1RfQ1RYKGJhc2UpLCAwKTsKKwkJQ1RYX1JFRyhlbmdpbmUsIHJlZ3MsIENUWF9S
Q1NfSU5ESVJFQ1RfQ1RYX09GRlNFVCwKIAkJCVJJTkdfSU5ESVJFQ1RfQ1RYX09GRlNFVChiYXNl
KSwgMCk7CiAJCWlmICh3YV9jdHgtPmluZGlyZWN0X2N0eC5zaXplKSB7CiAJCQl1MzIgZ2d0dF9v
ZmZzZXQgPSBpOTE1X2dndHRfb2Zmc2V0KHdhX2N0eC0+dm1hKTsKQEAgLTI1NzYsNyArMjU4MCw4
IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19pbml0X3JlZ19zdGF0ZSh1MzIgKnJlZ3MsCiAJCQkJ
aW50ZWxfbHJfaW5kaXJlY3RfY3R4X29mZnNldChlbmdpbmUpIDw8IDY7CiAJCX0KIAotCQlDVFhf
UkVHKHJlZ3MsIENUWF9CQl9QRVJfQ1RYX1BUUiwgUklOR19CQl9QRVJfQ1RYX1BUUihiYXNlKSwg
MCk7CisJCUNUWF9SRUcoZW5naW5lLCByZWdzLCBDVFhfQkJfUEVSX0NUWF9QVFIsCisJCQlSSU5H
X0JCX1BFUl9DVFhfUFRSKGJhc2UpLCAwKTsKIAkJaWYgKHdhX2N0eC0+cGVyX2N0eC5zaXplKSB7
CiAJCQl1MzIgZ2d0dF9vZmZzZXQgPSBpOTE1X2dndHRfb2Zmc2V0KHdhX2N0eC0+dm1hKTsKIApA
QCAtMjU4NSwxOCArMjU5MCwxOSBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfaW5pdF9yZWdfc3Rh
dGUodTMyICpyZWdzLAogCQl9CiAJfQogCi0JcmVnc1tDVFhfTFJJX0hFQURFUl8xXSA9IE1JX0xP
QURfUkVHSVNURVJfSU1NKDkpIHwgTUlfTFJJX0ZPUkNFX1BPU1RFRDsKKwlyZWdzW0NUWF9MUklf
SEVBREVSXzFdID0gaTkxNV9nZXRfbHJpX2NtZChlbmdpbmUsIDkpIHwKKwkJCQkJCSAgTUlfTFJJ
X0ZPUkNFX1BPU1RFRDsKIAotCUNUWF9SRUcocmVncywgQ1RYX0NUWF9USU1FU1RBTVAsIFJJTkdf
Q1RYX1RJTUVTVEFNUChiYXNlKSwgMCk7CisJQ1RYX1JFRyhlbmdpbmUsIHJlZ3MsIENUWF9DVFhf
VElNRVNUQU1QLCBSSU5HX0NUWF9USU1FU1RBTVAoYmFzZSksIDApOwogCS8qIFBEUCB2YWx1ZXMg
d2VsbCBiZSBhc3NpZ25lZCBsYXRlciBpZiBuZWVkZWQgKi8KLQlDVFhfUkVHKHJlZ3MsIENUWF9Q
RFAzX1VEVywgR0VOOF9SSU5HX1BEUF9VRFcoYmFzZSwgMyksIDApOwotCUNUWF9SRUcocmVncywg
Q1RYX1BEUDNfTERXLCBHRU44X1JJTkdfUERQX0xEVyhiYXNlLCAzKSwgMCk7Ci0JQ1RYX1JFRyhy
ZWdzLCBDVFhfUERQMl9VRFcsIEdFTjhfUklOR19QRFBfVURXKGJhc2UsIDIpLCAwKTsKLQlDVFhf
UkVHKHJlZ3MsIENUWF9QRFAyX0xEVywgR0VOOF9SSU5HX1BEUF9MRFcoYmFzZSwgMiksIDApOwot
CUNUWF9SRUcocmVncywgQ1RYX1BEUDFfVURXLCBHRU44X1JJTkdfUERQX1VEVyhiYXNlLCAxKSwg
MCk7Ci0JQ1RYX1JFRyhyZWdzLCBDVFhfUERQMV9MRFcsIEdFTjhfUklOR19QRFBfTERXKGJhc2Us
IDEpLCAwKTsKLQlDVFhfUkVHKHJlZ3MsIENUWF9QRFAwX1VEVywgR0VOOF9SSU5HX1BEUF9VRFco
YmFzZSwgMCksIDApOwotCUNUWF9SRUcocmVncywgQ1RYX1BEUDBfTERXLCBHRU44X1JJTkdfUERQ
X0xEVyhiYXNlLCAwKSwgMCk7CisJQ1RYX1JFRyhlbmdpbmUsIHJlZ3MsIENUWF9QRFAzX1VEVywg
R0VOOF9SSU5HX1BEUF9VRFcoYmFzZSwgMyksIDApOworCUNUWF9SRUcoZW5naW5lLCByZWdzLCBD
VFhfUERQM19MRFcsIEdFTjhfUklOR19QRFBfTERXKGJhc2UsIDMpLCAwKTsKKwlDVFhfUkVHKGVu
Z2luZSwgcmVncywgQ1RYX1BEUDJfVURXLCBHRU44X1JJTkdfUERQX1VEVyhiYXNlLCAyKSwgMCk7
CisJQ1RYX1JFRyhlbmdpbmUsIHJlZ3MsIENUWF9QRFAyX0xEVywgR0VOOF9SSU5HX1BEUF9MRFco
YmFzZSwgMiksIDApOworCUNUWF9SRUcoZW5naW5lLCByZWdzLCBDVFhfUERQMV9VRFcsIEdFTjhf
UklOR19QRFBfVURXKGJhc2UsIDEpLCAwKTsKKwlDVFhfUkVHKGVuZ2luZSwgcmVncywgQ1RYX1BE
UDFfTERXLCBHRU44X1JJTkdfUERQX0xEVyhiYXNlLCAxKSwgMCk7CisJQ1RYX1JFRyhlbmdpbmUs
IHJlZ3MsIENUWF9QRFAwX1VEVywgR0VOOF9SSU5HX1BEUF9VRFcoYmFzZSwgMCksIDApOworCUNU
WF9SRUcoZW5naW5lLCByZWdzLCBDVFhfUERQMF9MRFcsIEdFTjhfUklOR19QRFBfTERXKGJhc2Us
IDApLCAwKTsKIAogCWlmIChpOTE1X3ZtX2lzXzRsdmwoJnBwZ3R0LT52bSkpIHsKIAkJLyogNjRi
IFBQR1RUICg0OGJpdCBjYW5vbmljYWwpCkBAIC0yNjEyLDggKzI2MTgsOSBAQCBzdGF0aWMgdm9p
ZCBleGVjbGlzdHNfaW5pdF9yZWdfc3RhdGUodTMyICpyZWdzLAogCX0KIAogCWlmIChyY3MpIHsK
LQkJcmVnc1tDVFhfTFJJX0hFQURFUl8yXSA9IE1JX0xPQURfUkVHSVNURVJfSU1NKDEpOwotCQlD
VFhfUkVHKHJlZ3MsIENUWF9SX1BXUl9DTEtfU1RBVEUsIEdFTjhfUl9QV1JfQ0xLX1NUQVRFLCAw
KTsKKwkJcmVnc1tDVFhfTFJJX0hFQURFUl8yXSA9IGk5MTVfZ2V0X2xyaV9jbWQoZW5naW5lLCAx
KTsKKwkJQ1RYX1JFRyhlbmdpbmUsIHJlZ3MsIENUWF9SX1BXUl9DTEtfU1RBVEUsCisJCQlHRU44
X1JfUFdSX0NMS19TVEFURSwgMCk7CiAKIAkJaTkxNV9vYV9pbml0X3JlZ19zdGF0ZShlbmdpbmUs
IGNlLCByZWdzKTsKIAl9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9scmNfcmVnLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmNfcmVnLmgKaW5k
ZXggNWVmOTMyZDgxMGE3Li40MGIxMTQyZDBkNzQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2xyY19yZWcuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9scmNfcmVnLmgKQEAgLTM5LDEwICszOSwxMCBAQAogI2RlZmluZSBDVFhfUl9QV1JfQ0xL
X1NUQVRFCQkweDQyCiAjZGVmaW5lIENUWF9FTkQJCQkJMHg0NAogCi0jZGVmaW5lIENUWF9SRUco
cmVnX3N0YXRlLCBwb3MsIHJlZywgdmFsKSBkbyB7IFwKKyNkZWZpbmUgQ1RYX1JFRyhlbmdpbmUs
IHJlZ19zdGF0ZSwgcG9zLCByZWcsIHZhbCkgZG8geyBcCiAJdTMyICpyZWdfc3RhdGVfXyA9IChy
ZWdfc3RhdGUpOyBcCiAJY29uc3QgdTMyIHBvc19fID0gKHBvcyk7IFwKLQkocmVnX3N0YXRlX18p
Wyhwb3NfXykgKyAwXSA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KHJlZyk7IFwKKwkocmVnX3N0YXRl
X18pWyhwb3NfXykgKyAwXSA9IGk5MTVfZ2V0X2xyaV9yZWcoKGVuZ2luZSksIChyZWcpKTsgXAog
CShyZWdfc3RhdGVfXylbKHBvc19fKSArIDFdID0gKHZhbCk7IFwKIH0gd2hpbGUgKDApCiAKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX21vY3MuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX21vY3MuYwppbmRleCA3OWRmNjYwMjJkM2EuLjVkYWU2MzMz
NDgxZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbW9jcy5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX21vY3MuYwpAQCAtMzI0LDkgKzMyNCw2
IEBAIHN0YXRpYyB1MzIgZ2V0X2VudHJ5X2NvbnRyb2woY29uc3Qgc3RydWN0IGRybV9pOTE1X21v
Y3NfdGFibGUgKnRhYmxlLAogLyoqCiAgKiBpbnRlbF9tb2NzX2luaXRfZW5naW5lKCkgLSBlbWl0
IHRoZSBtb2NzIGNvbnRyb2wgdGFibGUKICAqIEBlbmdpbmU6CVRoZSBlbmdpbmUgZm9yIHdob20g
dG8gZW1pdCB0aGUgcmVnaXN0ZXJzLgotICoKLSAqIFRoaXMgZnVuY3Rpb24gc2ltcGx5IGVtaXRz
IGEgTUlfTE9BRF9SRUdJU1RFUl9JTU0gY29tbWFuZCBmb3IgdGhlCi0gKiBnaXZlbiB0YWJsZSBz
dGFydGluZyBhdCB0aGUgZ2l2ZW4gYWRkcmVzcy4KICAqLwogdm9pZCBpbnRlbF9tb2NzX2luaXRf
ZW5naW5lKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsKQEAgLTM4MCwxOCArMzc3
LDIwIEBAIHN0YXRpYyBpbnQgZW1pdF9tb2NzX2NvbnRyb2xfdGFibGUoc3RydWN0IGk5MTVfcmVx
dWVzdCAqcnEsCiAJaWYgKElTX0VSUihjcykpCiAJCXJldHVybiBQVFJfRVJSKGNzKTsKIAotCSpj
cysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0odGFibGUtPm5fZW50cmllcyk7CisJKmNzKysgPSBp
OTE1X2dldF9scmlfY21kKHJxLT5lbmdpbmUsIHRhYmxlLT5uX2VudHJpZXMpOwogCiAJZm9yIChp
bmRleCA9IDA7IGluZGV4IDwgdGFibGUtPnNpemU7IGluZGV4KyspIHsKIAkJdTMyIHZhbHVlID0g
Z2V0X2VudHJ5X2NvbnRyb2wodGFibGUsIGluZGV4KTsKIAotCQkqY3MrKyA9IGk5MTVfbW1pb19y
ZWdfb2Zmc2V0KG1vY3NfcmVnaXN0ZXIoZW5naW5lLCBpbmRleCkpOworCQkqY3MrKyA9IGk5MTVf
Z2V0X2xyaV9yZWcocnEtPmVuZ2luZSwKKwkJCQkJIG1vY3NfcmVnaXN0ZXIoZW5naW5lLCBpbmRl
eCkpOwogCQkqY3MrKyA9IHZhbHVlOwogCX0KIAogCS8qIEFsbCByZW1haW5pbmcgZW50cmllcyBh
cmUgYWxzbyB1bnVzZWQgKi8KIAlmb3IgKDsgaW5kZXggPCB0YWJsZS0+bl9lbnRyaWVzOyBpbmRl
eCsrKSB7Ci0JCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQobW9jc19yZWdpc3Rlcihlbmdp
bmUsIGluZGV4KSk7CisJCSpjcysrID0gaTkxNV9nZXRfbHJpX3JlZyhycS0+ZW5naW5lLAorCQkJ
CQkgbW9jc19yZWdpc3RlcihlbmdpbmUsIGluZGV4KSk7CiAJCSpjcysrID0gdW51c2VkX3ZhbHVl
OwogCX0KIApAQCAtNDQ5LDcgKzQ0OCwxMSBAQCBzdGF0aWMgaW50IGVtaXRfbW9jc19sM2NjX3Rh
YmxlKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAogCWlmIChJU19FUlIoY3MpKQogCQlyZXR1cm4g
UFRSX0VSUihjcyk7CiAKLQkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKHRhYmxlLT5uX2Vu
dHJpZXMgLyAyKTsKKwkvKgorCSAqIEdFTjlfTE5DRkNNT0NTIGlzIG5vdCBlbmdpbmUgcmVsYXRp
dmUsIHRoZXJlZm9yZSB0aGVyZSBpcyBubworCSAqIG5lZWQgZm9yIHJlbGF0aXZlIGFkZHJlc3Np
bmc/CisJICovCisJKmNzKysgPSBfX01JX0xPQURfUkVHSVNURVJfSU1NKHRhYmxlLT5uX2VudHJp
ZXMgLyAyKTsKIAogCWZvciAoaSA9IDA7IGkgPCB0YWJsZS0+c2l6ZSAvIDI7IGkrKykgewogCQl1
MTYgbG93ID0gZ2V0X2VudHJ5X2wzY2ModGFibGUsIDIgKiBpKTsKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JpbmdidWZmZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX3JpbmdidWZmZXIuYwppbmRleCBmMGQ2MGFmZmRiYTMuLmU5OGMyZmU3Mjdh
NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JpbmdidWZmZXIuYwpAQCAtMTUx
NiwxMiArMTUxNiwxMyBAQCBzdGF0aWMgaW50IGxvYWRfcGRfZGlyKHN0cnVjdCBpOTE1X3JlcXVl
c3QgKnJxLAogCWlmIChJU19FUlIoY3MpKQogCQlyZXR1cm4gUFRSX0VSUihjcyk7CiAKLQkqY3Mr
KyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKDEpOwotCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZz
ZXQoUklOR19QUF9ESVJfRENMVihlbmdpbmUtPm1taW9fYmFzZSkpOworCS8qIENhbiB0aGVzZSBu
b3QgYmUgbWVyZ2VkIGludG8gYSBzaW5nbGUgTFJJPz8/ICovCisJKmNzKysgPSBpOTE1X2dldF9s
cmlfY21kKGVuZ2luZSwgMSk7CisJKmNzKysgPSBpOTE1X2dldF9scmlfcmVnKGVuZ2luZSwgUklO
R19QUF9ESVJfRENMVihlbmdpbmUtPm1taW9fYmFzZSkpOwogCSpjcysrID0gUFBfRElSX0RDTFZf
Mkc7CiAKLQkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKDEpOwotCSpjcysrID0gaTkxNV9t
bWlvX3JlZ19vZmZzZXQoUklOR19QUF9ESVJfQkFTRShlbmdpbmUtPm1taW9fYmFzZSkpOworCSpj
cysrID0gaTkxNV9nZXRfbHJpX2NtZChlbmdpbmUsIDEpOworCSpjcysrID0gaTkxNV9nZXRfbHJp
X3JlZyhlbmdpbmUsIFJJTkdfUFBfRElSX0JBU0UoZW5naW5lLT5tbWlvX2Jhc2UpKTsKIAkqY3Mr
KyA9IHBwZ3R0LT5wZC5iYXNlLmdndHRfb2Zmc2V0IDw8IDEwOwogCiAJaW50ZWxfcmluZ19hZHZh
bmNlKHJxLCBjcyk7CkBAIC0xNTg5LDcgKzE1OTAsMTEgQEAgc3RhdGljIGlubGluZSBpbnQgbWlf
c2V0X2NvbnRleHQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsIHUzMiBmbGFncykKIAkJaWYgKG51
bV9lbmdpbmVzKSB7CiAJCQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpzaWduYWxsZXI7CiAKLQkJ
CSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0obnVtX2VuZ2luZXMpOworCQkJLyoKKwkJCSAq
IE11c3QgdXNlIGFic29sdXRlIGVuZ2luZSBhZGRyZXNzIGFzIHRoZSByZWdpc3RlcgorCQkJICog
d3JpdGUgaXMgdGFyZ2V0aW5nIGEgZGlmZmVyZW50IGVuZ2luZS4KKwkJCSAqLworCQkJKmNzKysg
PSBfX01JX0xPQURfUkVHSVNURVJfSU1NKG51bV9lbmdpbmVzKTsKIAkJCWZvcl9lYWNoX2VuZ2lu
ZShzaWduYWxsZXIsIGk5MTUsIGlkKSB7CiAJCQkJaWYgKHNpZ25hbGxlciA9PSBlbmdpbmUpCiAJ
CQkJCWNvbnRpbnVlOwpAQCAtMTY0Myw3ICsxNjQ4LDExIEBAIHN0YXRpYyBpbmxpbmUgaW50IG1p
X3NldF9jb250ZXh0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCB1MzIgZmxhZ3MpCiAJCQlzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICpzaWduYWxsZXI7CiAJCQlpOTE1X3JlZ190IGxhc3RfcmVnID0g
e307IC8qIGtlZXAgZ2NjIHF1aWV0ICovCiAKLQkJCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9J
TU0obnVtX2VuZ2luZXMpOworCQkJLyoKKwkJCSAqIE11c3QgdXNlIGFic29sdXRlIGVuZ2luZSBh
ZGRyZXNzIGFzIHRoZSByZWdpc3RlcgorCQkJICogd3JpdGUgaXMgdGFyZ2V0aW5nIGEgZGlmZmVy
ZW50IGVuZ2luZS4KKwkJCSAqLworCQkJKmNzKysgPSBfX01JX0xPQURfUkVHSVNURVJfSU1NKG51
bV9lbmdpbmVzKTsKIAkJCWZvcl9lYWNoX2VuZ2luZShzaWduYWxsZXIsIGk5MTUsIGlkKSB7CiAJ
CQkJaWYgKHNpZ25hbGxlciA9PSBlbmdpbmUpCiAJCQkJCWNvbnRpbnVlOwpAQCAtMTY4Nyw5ICsx
Njk2LDkgQEAgc3RhdGljIGludCByZW1hcF9sMyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgaW50
IHNsaWNlKQogCSAqIGhlcmUgYmVjYXVzZSBubyBvdGhlciBjb2RlIHNob3VsZCBhY2Nlc3MgdGhl
c2UgcmVnaXN0ZXJzIG90aGVyIHRoYW4KIAkgKiBhdCBpbml0aWFsaXphdGlvbiB0aW1lLgogCSAq
LwotCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oR0VON19MM0xPR19TSVpFLzQpOworCSpj
cysrID0gaTkxNV9nZXRfbHJpX2NtZChycS0+ZW5naW5lLCBHRU43X0wzTE9HX1NJWkUvNCk7CiAJ
Zm9yIChpID0gMDsgaSA8IEdFTjdfTDNMT0dfU0laRS80OyBpKyspIHsKLQkJKmNzKysgPSBpOTE1
X21taW9fcmVnX29mZnNldChHRU43X0wzTE9HKHNsaWNlLCBpKSk7CisJCSpjcysrID0gaTkxNV9n
ZXRfbHJpX3JlZyhycS0+ZW5naW5lLCBHRU43X0wzTE9HKHNsaWNlLCBpKSk7CiAJCSpjcysrID0g
cmVtYXBfaW5mb1tpXTsKIAl9CiAJKmNzKysgPSBNSV9OT09QOwpAQCAtMjMzNSwzICsyMzQ0LDIz
IEBAIGludCBpbnRlbF9yaW5nX3N1Ym1pc3Npb25faW5pdChzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmUpCiAJaW50ZWxfZW5naW5lX2NsZWFudXBfY29tbW9uKGVuZ2luZSk7CiAJcmV0dXJu
IGVycjsKIH0KKwordTMyIGk5MTVfZ2V0X2xyaV9jbWQoY29uc3Qgc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lLCB1MzIgd29yZF9jb3VudCkKK3sKKwl1MzIgd29yZDsKKworCXdvcmQgPSBf
X01JX0xPQURfUkVHSVNURVJfSU1NKHdvcmRfY291bnQpOworCisJaWYgKGk5MTVfZW5naW5lX2hh
c19yZWxhdGl2ZV9scmkoZW5naW5lKSkKKwkJd29yZCB8PSBNSV9MUklfQUREX0NTX01NSU9fU1RB
UlRfR0VOMTE7CisKKwlyZXR1cm4gd29yZDsKK30KKwordTMyIGk5MTVfZ2V0X2xyaV9yZWcoY29u
c3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBpOTE1X3JlZ190IHJlZykKK3sKKwlp
ZiAoIWk5MTVfZW5naW5lX2hhc19yZWxhdGl2ZV9scmkoZW5naW5lKSkKKwkJcmV0dXJuIGk5MTVf
bW1pb19yZWdfb2Zmc2V0KHJlZyk7CisKKwlyZXR1cm4gaTkxNV9tbWlvX3JlZ19vZmZzZXQocmVn
KSAtIGVuZ2luZS0+bW1pb19iYXNlOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfd29ya2Fyb3VuZHMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X3dvcmthcm91bmRzLmMKaW5kZXggNDNlMjkwMzA2NTUxLi5kNWVkYzEwYzg2MGMgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3dvcmthcm91bmRzLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfd29ya2Fyb3VuZHMuYwpAQCAtNjI1LDkgKzYyNSw5
IEBAIGludCBpbnRlbF9lbmdpbmVfZW1pdF9jdHhfd2Eoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEp
CiAJaWYgKElTX0VSUihjcykpCiAJCXJldHVybiBQVFJfRVJSKGNzKTsKIAotCSpjcysrID0gTUlf
TE9BRF9SRUdJU1RFUl9JTU0od2FsLT5jb3VudCk7CisJKmNzKysgPSBpOTE1X2dldF9scmlfY21k
KHJxLT5lbmdpbmUsIHdhbC0+Y291bnQpOwogCWZvciAoaSA9IDAsIHdhID0gd2FsLT5saXN0OyBp
IDwgd2FsLT5jb3VudDsgaSsrLCB3YSsrKSB7Ci0JCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZz
ZXQod2EtPnJlZyk7CisJCSpjcysrID0gaTkxNV9nZXRfbHJpX3JlZyhycS0+ZW5naW5lLCB3YS0+
cmVnKTsKIAkJKmNzKysgPSB3YS0+dmFsOwogCX0KIAkqY3MrKyA9IE1JX05PT1A7CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF93b3JrYXJvdW5kcy5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rfd29ya2Fyb3VuZHMuYwppbmRleCA5Zjc2ODBi
OTk4NGIuLmIwNTEzYzFkZTUzYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
c2VsZnRlc3Rfd29ya2Fyb3VuZHMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxm
dGVzdF93b3JrYXJvdW5kcy5jCkBAIC00NDIsNiArNDQyLDcgQEAgc3RhdGljIGludCBjaGVja19k
aXJ0eV93aGl0ZWxpc3Qoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKIAogCWZvciAoaSA9
IDA7IGkgPCBlbmdpbmUtPndoaXRlbGlzdC5jb3VudDsgaSsrKSB7CiAJCXUzMiByZWcgPSBpOTE1
X21taW9fcmVnX29mZnNldChlbmdpbmUtPndoaXRlbGlzdC5saXN0W2ldLnJlZyk7CisJCXUzMiBy
ZWdMUkkgPSBpOTE1X2dldF9scmlfcmVnKGVuZ2luZSwgZW5naW5lLT53aGl0ZWxpc3QubGlzdFtp
XS5yZWcpOwogCQl1NjQgYWRkciA9IHNjcmF0Y2gtPm5vZGUuc3RhcnQ7CiAJCXN0cnVjdCBpOTE1
X3JlcXVlc3QgKnJxOwogCQl1MzIgc3JtLCBscm0sIHJzdmQ7CkBAIC00NzQsOCArNDc1LDggQEAg
c3RhdGljIGludCBjaGVja19kaXJ0eV93aGl0ZWxpc3Qoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQg
KmN0eCwKIAkJaWR4ID0gMTsKIAkJZm9yICh2ID0gMDsgdiA8IEFSUkFZX1NJWkUodmFsdWVzKTsg
disrKSB7CiAJCQkvKiBMUkkgZ2FyYmFnZSAqLwotCQkJKmNzKysgPSBNSV9MT0FEX1JFR0lTVEVS
X0lNTSgxKTsKLQkJCSpjcysrID0gcmVnOworCQkJKmNzKysgPSBpOTE1X2dldF9scmlfY21kKGVu
Z2luZSwgMSk7CisJCQkqY3MrKyA9IHJlZ0xSSTsKIAkJCSpjcysrID0gdmFsdWVzW3ZdOwogCiAJ
CQkvKiBTUk0gcmVzdWx0ICovCkBAIC00ODcsOCArNDg4LDggQEAgc3RhdGljIGludCBjaGVja19k
aXJ0eV93aGl0ZWxpc3Qoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKIAkJfQogCQlmb3Ig
KHYgPSAwOyB2IDwgQVJSQVlfU0laRSh2YWx1ZXMpOyB2KyspIHsKIAkJCS8qIExSSSBnYXJiYWdl
ICovCi0JCQkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKDEpOwotCQkJKmNzKysgPSByZWc7
CisJCQkqY3MrKyA9IGk5MTVfZ2V0X2xyaV9jbWQoZW5naW5lLCAxKTsKKwkJCSpjcysrID0gcmVn
TFJJOwogCQkJKmNzKysgPSB+dmFsdWVzW3ZdOwogCiAJCQkvKiBTUk0gcmVzdWx0ICovCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvbW1pb19jb250ZXh0LmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndnQvbW1pb19jb250ZXh0LmMKaW5kZXggYTI3YmRkMzk1MWY2Li4zODA3
Y2U1ZmU1NjQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9tbWlvX2NvbnRl
eHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvbW1pb19jb250ZXh0LmMKQEAgLTIw
MCwxNCArMjAwLDE0IEBAIHJlc3RvcmVfY29udGV4dF9tbWlvX2Zvcl9pbmhpYml0KHN0cnVjdCBp
bnRlbF92Z3B1ICp2Z3B1LAogCWlmIChJU19FUlIoY3MpKQogCQlyZXR1cm4gUFRSX0VSUihjcyk7
CiAKLQkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKGNvdW50KTsKKwkqY3MrKyA9IGk5MTVf
Z2V0X2xyaV9jbWQocmVxLT5lbmdpbmUsIGNvdW50KTsKIAlmb3IgKG1taW8gPSBndnQtPmVuZ2lu
ZV9tbWlvX2xpc3QubW1pbzsKIAkgICAgIGk5MTVfbW1pb19yZWdfdmFsaWQobW1pby0+cmVnKTsg
bW1pbysrKSB7CiAJCWlmIChtbWlvLT5yaW5nX2lkICE9IHJpbmdfaWQgfHwKIAkJICAgICFtbWlv
LT5pbl9jb250ZXh0KQogCQkJY29udGludWU7CiAKLQkJKmNzKysgPSBpOTE1X21taW9fcmVnX29m
ZnNldChtbWlvLT5yZWcpOworCQkqY3MrKyA9IGk5MTVfZ2V0X2xyaV9yZWcocmVxLT5lbmdpbmUs
IG1taW8tPnJlZyk7CiAJCSpjcysrID0gdmdwdV92cmVnX3QodmdwdSwgbW1pby0+cmVnKSB8CiAJ
CQkJKG1taW8tPm1hc2sgPDwgMTYpOwogCQlndnRfZGJnX2NvcmUoImFkZCBscmkgcmVnIHBhaXIg
MHgleDoweCV4IGluIGluaGliaXQgY3R4LCB2Z3B1OiVkLCByaW5kX2lkOiVkXG4iLApAQCAtMjM1
LDcgKzIzNSwxMSBAQCByZXN0b3JlX3JlbmRlcl9tb2NzX2NvbnRyb2xfZm9yX2luaGliaXQoc3Ry
dWN0IGludGVsX3ZncHUgKnZncHUsCiAJaWYgKElTX0VSUihjcykpCiAJCXJldHVybiBQVFJfRVJS
KGNzKTsKIAotCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oR0VOOV9NT0NTX1NJWkUpOwor
CS8qCisJICogR0VOOV9HRlhfTU9DUyBpcyBub3QgZW5naW5lIHJlbGF0aXZlLCB0aGVyZWZvcmUg
dGhlcmUgaXMgbm8KKwkgKiBuZWVkIGZvciByZWxhdGl2ZSBhZGRyZXNzaW5nLgorCSAqLworCSpj
cysrID0gX19NSV9MT0FEX1JFR0lTVEVSX0lNTShHRU45X01PQ1NfU0laRSk7CiAKIAlmb3IgKGlu
ZGV4ID0gMDsgaW5kZXggPCBHRU45X01PQ1NfU0laRTsgaW5kZXgrKykgewogCQkqY3MrKyA9IGk5
MTVfbW1pb19yZWdfb2Zmc2V0KEdFTjlfR0ZYX01PQ1MoaW5kZXgpKTsKQEAgLTI2Miw3ICsyNjYs
MTEgQEAgcmVzdG9yZV9yZW5kZXJfbW9jc19sM2NjX2Zvcl9pbmhpYml0KHN0cnVjdCBpbnRlbF92
Z3B1ICp2Z3B1LAogCWlmIChJU19FUlIoY3MpKQogCQlyZXR1cm4gUFRSX0VSUihjcyk7CiAKLQkq
Y3MrKyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKEdFTjlfTU9DU19TSVpFIC8gMik7CisJLyoKKwkg
KiBHRU45X0xOQ0ZDTU9DUyBpcyBub3QgZW5naW5lIHJlbGF0aXZlLCB0aGVyZWZvcmUgdGhlcmUg
aXMgbm8KKwkgKiBuZWVkIGZvciByZWxhdGl2ZSBhZGRyZXNzaW5nLgorCSAqLworCSpjcysrID0g
X19NSV9MT0FEX1JFR0lTVEVSX0lNTShHRU45X01PQ1NfU0laRSAvIDIpOwogCiAJZm9yIChpbmRl
eCA9IDA7IGluZGV4IDwgR0VOOV9NT0NTX1NJWkUgLyAyOyBpbmRleCsrKSB7CiAJCSpjcysrID0g
aTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOV9MTkNGQ01PQ1MoaW5kZXgpKTsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfY21kX3BhcnNlci5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9jbWRfcGFyc2VyLmMKaW5kZXggZTlmYWRjYjRkNTkyLi5mZDE4M2U3MmRhY2Ug
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfY21kX3BhcnNlci5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfY21kX3BhcnNlci5jCkBAIC0yMjEsNyArMjIxLDcg
QEAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1faTkxNV9jbWRfZGVzY3JpcHRvciBjb21tb25fY21k
c1tdID0gewogCUNNRCggIE1JX1NVU1BFTkRfRkxVU0gsICAgICAgICAgICAgICAgICBTTUksICAg
IEYsICAxLCAgICAgIFMgICksCiAJQ01EKCAgTUlfU0VNQVBIT1JFX01CT1gsICAgICAgICAgICAg
ICAgIFNNSSwgICAhRiwgIDB4RkYsICAgUiAgKSwKIAlDTUQoICBNSV9TVE9SRV9EV09SRF9JTkRF
WCwgICAgICAgICAgICAgU01JLCAgICFGLCAgMHhGRiwgICBSICApLAotCUNNRCggIE1JX0xPQURf
UkVHSVNURVJfSU1NKDEpLCAgICAgICAgICBTTUksICAgIUYsICAweEZGLCAgIFcsCisJQ01EKCAg
X19NSV9MT0FEX1JFR0lTVEVSX0lNTSgxKSwgICAgICAgIFNNSSwgICAhRiwgIDB4RkYsICAgVywK
IAkgICAgICAucmVnID0geyAub2Zmc2V0ID0gMSwgLm1hc2sgPSAweDAwN0ZGRkZDLCAuc3RlcCA9
IDIgfSAgICApLAogCUNNRCggIE1JX1NUT1JFX1JFR0lTVEVSX01FTSwgICAgICAgICAgICBTTUks
ICAgIEYsICAzLCAgICAgVyB8IEIsCiAJICAgICAgLnJlZyA9IHsgLm9mZnNldCA9IDEsIC5tYXNr
ID0gMHgwMDdGRkZGQyB9LApAQCAtMTE4Myw3ICsxMTgzLDcgQEAgc3RhdGljIGJvb2wgY2hlY2tf
Y21kKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAkJCQkJcmV0dXJuIGZh
bHNlOwogCQkJCX0KIAotCQkJCWlmIChkZXNjLT5jbWQudmFsdWUgPT0gTUlfTE9BRF9SRUdJU1RF
Ul9JTU0oMSkgJiYKKwkJCQlpZiAoZGVzYy0+Y21kLnZhbHVlID09IF9fTUlfTE9BRF9SRUdJU1RF
Ul9JTU0oMSkgJiYKIAkJCQkgICAgKG9mZnNldCArIDIgPiBsZW5ndGggfHwKIAkJCQkgICAgIChj
bWRbb2Zmc2V0ICsgMV0gJiByZWctPm1hc2spICE9IHJlZy0+dmFsdWUpKSB7CiAJCQkJCURSTV9E
RUJVR19EUklWRVIoIkNNRDogUmVqZWN0ZWQgTFJJIHRvIG1hc2tlZCByZWdpc3RlciAweCUwOFhc
biIsCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9jb250ZXh0LmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9jb250ZXh0LmMKaW5kZXggNjVjZWZjNTIw
ZTc5Li45ODI2MGQ4YTQ1YmUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
Z2VtX2NvbnRleHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9jb250ZXh0
LmMKQEAgLTEwMjYsMTEgKzEwMjYsMTEgQEAgc3RhdGljIGludCBlbWl0X3BwZ3R0X3VwZGF0ZShz
dHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgdm9pZCAqZGF0YSkKIAkJaWYgKElTX0VSUihjcykpCiAJ
CQlyZXR1cm4gUFRSX0VSUihjcyk7CiAKLQkJKmNzKysgPSBNSV9MT0FEX1JFR0lTVEVSX0lNTSgy
KTsKKwkJKmNzKysgPSBpOTE1X2dldF9scmlfY21kKGVuZ2luZSwgMik7CiAKLQkJKmNzKysgPSBp
OTE1X21taW9fcmVnX29mZnNldChHRU44X1JJTkdfUERQX1VEVyhiYXNlLCAwKSk7CisJCSpjcysr
ID0gaTkxNV9nZXRfbHJpX3JlZyhlbmdpbmUsIEdFTjhfUklOR19QRFBfVURXKGJhc2UsIDApKTsK
IAkJKmNzKysgPSB1cHBlcl8zMl9iaXRzKHBkX2RhZGRyKTsKLQkJKmNzKysgPSBpOTE1X21taW9f
cmVnX29mZnNldChHRU44X1JJTkdfUERQX0xEVyhiYXNlLCAwKSk7CisJCSpjcysrID0gaTkxNV9n
ZXRfbHJpX3JlZyhlbmdpbmUsIEdFTjhfUklOR19QRFBfTERXKGJhc2UsIDApKTsKIAkJKmNzKysg
PSBsb3dlcl8zMl9iaXRzKHBkX2RhZGRyKTsKIAogCQkqY3MrKyA9IE1JX05PT1A7CkBAIC0xMDQw
LDEzICsxMDQwLDEzIEBAIHN0YXRpYyBpbnQgZW1pdF9wcGd0dF91cGRhdGUoc3RydWN0IGk5MTVf
cmVxdWVzdCAqcnEsIHZvaWQgKmRhdGEpCiAJCWlmIChJU19FUlIoY3MpKQogCQkJcmV0dXJuIFBU
Ul9FUlIoY3MpOwogCi0JCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oMiAqIEdFTjhfM0xW
TF9QRFBFUyk7CisJCSpjcysrID0gaTkxNV9nZXRfbHJpX2NtZChlbmdpbmUsIDIgKiBHRU44XzNM
VkxfUERQRVMpOwogCQlmb3IgKGkgPSBHRU44XzNMVkxfUERQRVM7IGktLTsgKSB7CiAJCQljb25z
dCBkbWFfYWRkcl90IHBkX2RhZGRyID0gaTkxNV9wYWdlX2Rpcl9kbWFfYWRkcihwcGd0dCwgaSk7
CiAKLQkJCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9SSU5HX1BEUF9VRFcoYmFz
ZSwgaSkpOworCQkJKmNzKysgPSBpOTE1X2dldF9scmlfcmVnKGVuZ2luZSwgR0VOOF9SSU5HX1BE
UF9VRFcoYmFzZSwgaSkpOwogCQkJKmNzKysgPSB1cHBlcl8zMl9iaXRzKHBkX2RhZGRyKTsKLQkJ
CSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9SSU5HX1BEUF9MRFcoYmFzZSwgaSkp
OworCQkJKmNzKysgPSBpOTE1X2dldF9scmlfcmVnKGVuZ2luZSwgR0VOOF9SSU5HX1BEUF9MRFco
YmFzZSwgaSkpOwogCQkJKmNzKysgPSBsb3dlcl8zMl9iaXRzKHBkX2RhZGRyKTsKIAkJfQogCQkq
Y3MrKyA9IE1JX05PT1A7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dl
bV9leGVjYnVmZmVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9leGVjYnVmZmVy
LmMKaW5kZXggNjc5ZjdjMTU2MWJhLi5hYzViMDZkMmZmZGMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZ2VtX2V4ZWNidWZmZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKQEAgLTE5NjMsNyArMTk2Myw4IEBAIHN0YXRpYyBp
bnQgaTkxNV9yZXNldF9nZW43X3NvbF9vZmZzZXRzKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQog
CWlmIChJU19FUlIoY3MpKQogCQlyZXR1cm4gUFRSX0VSUihjcyk7CiAKLQkqY3MrKyA9IE1JX0xP
QURfUkVHSVNURVJfSU1NKDQpOworCS8qIEdlbjcgb25seSBzbyBubyBuZWVkIHRvIHN1cHBvcnQg
cmVsYXRpdmUgb2Zmc2V0cyAqLworCSpjcysrID0gX19NSV9MT0FEX1JFR0lTVEVSX0lNTSg0KTsK
IAlmb3IgKGkgPSAwOyBpIDwgNDsgaSsrKSB7CiAJCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZz
ZXQoR0VON19TT19XUklURV9PRkZTRVQoaSkpOwogCQkqY3MrKyA9IDA7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfcGVyZi5jCmluZGV4IGM0OTk1ZDVhMTZkMi4uODZmYWNiY2NkYjAyIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3BlcmYuYwpAQCAtMTYzNiw3ICsxNjM2LDggQEAgc3RhdGljIHZvaWQgaHN3X2Rpc2Fi
bGVfbWV0cmljX3NldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAgKiBpbiB0
aGUgY2FzZSB0aGF0IHRoZSBPQSB1bml0IGhhcyBiZWVuIGRpc2FibGVkLgogICovCiBzdGF0aWMg
dm9pZAotZ2VuOF91cGRhdGVfcmVnX3N0YXRlX3VubG9ja2VkKHN0cnVjdCBpbnRlbF9jb250ZXh0
ICpjZSwKK2dlbjhfdXBkYXRlX3JlZ19zdGF0ZV91bmxvY2tlZChzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUsCisJCQkgICAgICAgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAogCQkJICAg
ICAgIHUzMiAqcmVnX3N0YXRlLAogCQkJICAgICAgIGNvbnN0IHN0cnVjdCBpOTE1X29hX2NvbmZp
ZyAqb2FfY29uZmlnKQogewpAQCAtMTY1NSw3ICsxNjU2LDEyIEBAIGdlbjhfdXBkYXRlX3JlZ19z
dGF0ZV91bmxvY2tlZChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCiAJfTsKIAlpbnQgaTsKIAot
CUNUWF9SRUcocmVnX3N0YXRlLCBjdHhfb2FjdHhjdHJsLCBHRU44X09BQ1RYQ09OVFJPTCwKKwkv
KgorCSAqIE5COiBUaGUgTFJJIGluc3RydWN0aW9uIGlzIGdlbmVyYXRlZCBieSB0aGUgaGFyZHdh
cmUuCisJICogU2hvdWxkIHdlIHJlYWQgaXQgaW4gYW5kIGFzc2VydCB0aGF0IHRoZSBvZmZzZXQg
ZmxhZyBpcyBzZXQ/CisJICovCisKKwlDVFhfUkVHKGVuZ2luZSwgcmVnX3N0YXRlLCBjdHhfb2Fj
dHhjdHJsLCBHRU44X09BQ1RYQ09OVFJPTCwKIAkJKGk5MTUtPnBlcmYub2EucGVyaW9kX2V4cG9u
ZW50IDw8IEdFTjhfT0FfVElNRVJfUEVSSU9EX1NISUZUKSB8CiAJCShpOTE1LT5wZXJmLm9hLnBl
cmlvZGljID8gR0VOOF9PQV9USU1FUl9FTkFCTEUgOiAwKSB8CiAJCUdFTjhfT0FfQ09VTlRFUl9S
RVNVTUUpOwpAQCAtMTY4MiwxMCArMTY4OCwxMCBAQCBnZW44X3VwZGF0ZV9yZWdfc3RhdGVfdW5s
b2NrZWQoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAogCQkJfQogCQl9CiAKLQkJQ1RYX1JFRyhy
ZWdfc3RhdGUsIHN0YXRlX29mZnNldCwgZmxleF9yZWdzW2ldLCB2YWx1ZSk7CisJCUNUWF9SRUco
ZW5naW5lLCByZWdfc3RhdGUsIHN0YXRlX29mZnNldCwgZmxleF9yZWdzW2ldLCB2YWx1ZSk7CiAJ
fQogCi0JQ1RYX1JFRyhyZWdfc3RhdGUsCisJQ1RYX1JFRyhlbmdpbmUsIHJlZ19zdGF0ZSwKIAkJ
Q1RYX1JfUFdSX0NMS19TVEFURSwgR0VOOF9SX1BXUl9DTEtfU1RBVEUsCiAJCWludGVsX3NzZXVf
bWFrZV9ycGNzKGk5MTUsICZjZS0+c3NldSkpOwogfQpAQCAtMTc3MCw3ICsxNzc2LDcgQEAgc3Rh
dGljIGludCBnZW44X2NvbmZpZ3VyZV9hbGxfY29udGV4dHMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAogCQkJY2UtPnN0YXRlLT5vYmotPm1tLmRpcnR5ID0gdHJ1ZTsKIAkJCXJl
Z3MgKz0gTFJDX1NUQVRFX1BOICogUEFHRV9TSVpFIC8gc2l6ZW9mKCpyZWdzKTsKIAotCQkJZ2Vu
OF91cGRhdGVfcmVnX3N0YXRlX3VubG9ja2VkKGNlLCByZWdzLCBvYV9jb25maWcpOworCQkJZ2Vu
OF91cGRhdGVfcmVnX3N0YXRlX3VubG9ja2VkKGRldl9wcml2LT5lbmdpbmVbUkNTMF0sIGNlLCBy
ZWdzLCBvYV9jb25maWcpOwogCiAJCQlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKGNlLT5zdGF0
ZS0+b2JqKTsKIAkJfQpAQCAtMjE2Niw3ICsyMTcyLDggQEAgdm9pZCBpOTE1X29hX2luaXRfcmVn
X3N0YXRlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAogCXN0cmVhbSA9IGVuZ2lu
ZS0+aTkxNS0+cGVyZi5vYS5leGNsdXNpdmVfc3RyZWFtOwogCWlmIChzdHJlYW0pCi0JCWdlbjhf
dXBkYXRlX3JlZ19zdGF0ZV91bmxvY2tlZChjZSwgcmVncywgc3RyZWFtLT5vYV9jb25maWcpOwor
CQlnZW44X3VwZGF0ZV9yZWdfc3RhdGVfdW5sb2NrZWQoZW5naW5lLCBjZSwgcmVncywKKwkJCQkJ
ICAgICAgIHN0cmVhbS0+b2FfY29uZmlnKTsKIH0KIAogLyoqCi0tIAoyLjIxLjAuNS5nYWViNTgy
YTk4MwoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50
ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBz
Oi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

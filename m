Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id B1E002C636F
	for <lists+intel-gfx@lfdr.de>; Fri, 27 Nov 2020 11:52:11 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B8D216EB89;
	Fri, 27 Nov 2020 10:52:09 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga12.intel.com (mga12.intel.com [192.55.52.136])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6459F6EB78
 for <intel-gfx@lists.freedesktop.org>; Fri, 27 Nov 2020 10:52:01 +0000 (UTC)
IronPort-SDR: YhFZxdLF/4B30tmoQoPdidlCSZeUdhnvvIQNhxyT7z5WmNoOPGFQVQ9qePfQy1ejb7GQKNYrpN
 LJo1WoeSlk5A==
X-IronPort-AV: E=McAfee;i="6000,8403,9817"; a="151634278"
X-IronPort-AV: E=Sophos;i="5.78,374,1599548400"; d="scan'208";a="151634278"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga005.fm.intel.com ([10.253.24.32])
 by fmsmga106.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 27 Nov 2020 02:51:12 -0800
IronPort-SDR: kgFQEInaVBUqvR+vsYGwcdlo27IftCkEFcpYIyHuRayqL+pG3+U224xMPTcFWpd1cDdIY0slYH
 fUpB0kXH6fZA==
X-IronPort-AV: E=Sophos;i="5.78,374,1599548400"; d="scan'208";a="537605112"
Received: from helsinki.fi.intel.com ([10.237.66.162])
 by fmsmga005-auth.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 27 Nov 2020 02:51:10 -0800
From: Gwan-gyeong Mun <gwan-gyeong.mun@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 27 Nov 2020 12:50:39 +0200
Message-Id: <20201127105041.2793779-3-gwan-gyeong.mun@intel.com>
X-Mailer: git-send-email 2.25.0
In-Reply-To: <20201127105041.2793779-1-gwan-gyeong.mun@intel.com>
References: <20201127105041.2793779-1-gwan-gyeong.mun@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v3 3/5] drm/i915/display: Split and export main
 surface calculation from skl_check_main_surface()
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogSm9zw6kgUm9iZXJ0byBkZSBTb3V6YSA8am9zZS5zb3V6YUBpbnRlbC5jb20+CgpUaGUg
Y2FsY3VsYXRpb24gdGhlIG9mZnNldHMgb2YgdGhlIG1haW4gc3VyZmFjZSB3aWxsIGJlIG5lZWRl
ZCBieSBQU1IyCnNlbGVjdGl2ZSBmZXRjaCBjb2RlIHNvIGhlcmUgc3BsaXR0aW5nIGFuZCBleHBv
cnRpbmcgaXQuCk5vIGZ1bmN0aW9uYWwgY2hhbmdlcyB3ZXJlIGRvbmUgaGVyZS4KCnYzOiBSZWJh
c2VkCgpDYzogR3dhbi1neWVvbmcgTXVuIDxnd2FuLWd5ZW9uZy5tdW5AaW50ZWwuY29tPgpDYzog
VmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KU2lnbmVkLW9m
Zi1ieTogSm9zw6kgUm9iZXJ0byBkZSBTb3V6YSA8am9zZS5zb3V6YUBpbnRlbC5jb20+ClJldmll
d2VkLWJ5OiBHd2FuLWd5ZW9uZyBNdW4gPGd3YW4tZ3llb25nLm11bkBpbnRlbC5jb20+ClRlc3Rl
ZC1ieTogR3dhbi1neWVvbmcgTXVuIDxnd2FuLWd5ZW9uZy5tdW5AaW50ZWwuY29tPgotLS0KIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jIHwgNjIgKysrKysrKysr
KysrKy0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5o
IHwgIDIgKwogMiBmaWxlcyBjaGFuZ2VkLCA0MiBpbnNlcnRpb25zKCspLCAyMiBkZWxldGlvbnMo
LSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3Bs
YXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCmluZGV4
IDU5NTE4M2Y3YjYwZi4uZGEyNGY2NTRhMmY0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2Rpc3BsYXkuYwpAQCAtMzgxNywyMiArMzgxNywyMSBAQCBzdGF0aWMgaW50
IGludGVsX3BsYW5lX21heF9oZWlnaHQoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKIAkJcmV0
dXJuIElOVF9NQVg7CiB9CiAKLXN0YXRpYyBpbnQgc2tsX2NoZWNrX21haW5fc3VyZmFjZShzdHJ1
Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQoraW50IHNrbF9jYWxjX21haW5fc3Vy
ZmFjZV9vZmZzZXQoY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSwK
KwkJCQkgaW50ICp4LCBpbnQgKnksIHUzMiAqb2Zmc2V0KQogewogCXN0cnVjdCBpbnRlbF9wbGFu
ZSAqcGxhbmUgPSB0b19pbnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+dWFwaS5wbGFuZSk7CiAJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYp
OwogCWNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxhbmVfc3RhdGUtPmh3LmZi
OwotCXVuc2lnbmVkIGludCByb3RhdGlvbiA9IHBsYW5lX3N0YXRlLT5ody5yb3RhdGlvbjsKLQlp
bnQgeCA9IHBsYW5lX3N0YXRlLT51YXBpLnNyYy54MSA+PiAxNjsKLQlpbnQgeSA9IHBsYW5lX3N0
YXRlLT51YXBpLnNyYy55MSA+PiAxNjsKLQlpbnQgdyA9IGRybV9yZWN0X3dpZHRoKCZwbGFuZV9z
dGF0ZS0+dWFwaS5zcmMpID4+IDE2OwotCWludCBoID0gZHJtX3JlY3RfaGVpZ2h0KCZwbGFuZV9z
dGF0ZS0+dWFwaS5zcmMpID4+IDE2OwotCWludCBtaW5fd2lkdGggPSBpbnRlbF9wbGFuZV9taW5f
d2lkdGgocGxhbmUsIGZiLCAwLCByb3RhdGlvbik7Ci0JaW50IG1heF93aWR0aCA9IGludGVsX3Bs
YW5lX21heF93aWR0aChwbGFuZSwgZmIsIDAsIHJvdGF0aW9uKTsKLQlpbnQgbWF4X2hlaWdodCA9
IGludGVsX3BsYW5lX21heF9oZWlnaHQocGxhbmUsIGZiLCAwLCByb3RhdGlvbik7Ci0JaW50IGF1
eF9wbGFuZSA9IGludGVsX21haW5fdG9fYXV4X3BsYW5lKGZiLCAwKTsKLQl1MzIgYXV4X29mZnNl
dCA9IHBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVthdXhfcGxhbmVdLm9mZnNldDsKLQl1MzIgYWxp
Z25tZW50LCBvZmZzZXQ7CisJY29uc3QgdW5zaWduZWQgaW50IHJvdGF0aW9uID0gcGxhbmVfc3Rh
dGUtPmh3LnJvdGF0aW9uOworCWNvbnN0IGludCBtaW5fd2lkdGggPSBpbnRlbF9wbGFuZV9taW5f
d2lkdGgocGxhbmUsIGZiLCAwLCByb3RhdGlvbik7CisJY29uc3QgaW50IG1heF93aWR0aCA9IGlu
dGVsX3BsYW5lX21heF93aWR0aChwbGFuZSwgZmIsIDAsIHJvdGF0aW9uKTsKKwljb25zdCBpbnQg
bWF4X2hlaWdodCA9IGludGVsX3BsYW5lX21heF9oZWlnaHQocGxhbmUsIGZiLCAwLCByb3RhdGlv
bik7CisJY29uc3QgaW50IGF1eF9wbGFuZSA9IGludGVsX21haW5fdG9fYXV4X3BsYW5lKGZiLCAw
KTsKKwljb25zdCB1MzIgYXV4X29mZnNldCA9IHBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVthdXhf
cGxhbmVdLm9mZnNldDsKKwljb25zdCB1MzIgYWxpZ25tZW50ID0gaW50ZWxfc3VyZl9hbGlnbm1l
bnQoZmIsIDApOworCWNvbnN0IGludCB3ID0gZHJtX3JlY3Rfd2lkdGgoJnBsYW5lX3N0YXRlLT51
YXBpLnNyYykgPj4gMTY7CisJY29uc3QgaW50IGggPSBkcm1fcmVjdF9oZWlnaHQoJnBsYW5lX3N0
YXRlLT51YXBpLnNyYykgPj4gMTY7CiAKIAlpZiAodyA+IG1heF93aWR0aCB8fCB3IDwgbWluX3dp
ZHRoIHx8IGggPiBtYXhfaGVpZ2h0KSB7CiAJCWRybV9kYmdfa21zKCZkZXZfcHJpdi0+ZHJtLApA
QCAtMzg0MSw5ICszODQwLDggQEAgc3RhdGljIGludCBza2xfY2hlY2tfbWFpbl9zdXJmYWNlKHN0
cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCiAJCXJldHVybiAtRUlOVkFMOwog
CX0KIAotCWludGVsX2FkZF9mYl9vZmZzZXRzKCZ4LCAmeSwgcGxhbmVfc3RhdGUsIDApOwotCW9m
ZnNldCA9IGludGVsX3BsYW5lX2NvbXB1dGVfYWxpZ25lZF9vZmZzZXQoJngsICZ5LCBwbGFuZV9z
dGF0ZSwgMCk7Ci0JYWxpZ25tZW50ID0gaW50ZWxfc3VyZl9hbGlnbm1lbnQoZmIsIDApOworCWlu
dGVsX2FkZF9mYl9vZmZzZXRzKHgsIHksIHBsYW5lX3N0YXRlLCAwKTsKKwkqb2Zmc2V0ID0gaW50
ZWxfcGxhbmVfY29tcHV0ZV9hbGlnbmVkX29mZnNldCh4LCB5LCBwbGFuZV9zdGF0ZSwgMCk7CiAJ
aWYgKGRybV9XQVJOX09OKCZkZXZfcHJpdi0+ZHJtLCBhbGlnbm1lbnQgJiYgIWlzX3Bvd2VyX29m
XzIoYWxpZ25tZW50KSkpCiAJCXJldHVybiAtRUlOVkFMOwogCkBAIC0zODUyLDkgKzM4NTAsMTAg
QEAgc3RhdGljIGludCBza2xfY2hlY2tfbWFpbl9zdXJmYWNlKHN0cnVjdCBpbnRlbF9wbGFuZV9z
dGF0ZSAqcGxhbmVfc3RhdGUpCiAJICogbWFpbiBzdXJmYWNlIG9mZnNldCwgYW5kIGl0IG11c3Qg
YmUgbm9uLW5lZ2F0aXZlLiBNYWtlCiAJICogc3VyZSB0aGF0IGlzIHdoYXQgd2Ugd2lsbCBnZXQu
CiAJICovCi0JaWYgKGF1eF9wbGFuZSAmJiBvZmZzZXQgPiBhdXhfb2Zmc2V0KQotCQlvZmZzZXQg
PSBpbnRlbF9wbGFuZV9hZGp1c3RfYWxpZ25lZF9vZmZzZXQoJngsICZ5LCBwbGFuZV9zdGF0ZSwg
MCwKLQkJCQkJCQkgICBvZmZzZXQsIGF1eF9vZmZzZXQgJiB+KGFsaWdubWVudCAtIDEpKTsKKwlp
ZiAoYXV4X3BsYW5lICYmICpvZmZzZXQgPiBhdXhfb2Zmc2V0KQorCQkqb2Zmc2V0ID0gaW50ZWxf
cGxhbmVfYWRqdXN0X2FsaWduZWRfb2Zmc2V0KHgsIHksIHBsYW5lX3N0YXRlLCAwLAorCQkJCQkJ
CSAgICAqb2Zmc2V0LAorCQkJCQkJCSAgICBhdXhfb2Zmc2V0ICYgfihhbGlnbm1lbnQgLSAxKSk7
CiAKIAkvKgogCSAqIFdoZW4gdXNpbmcgYW4gWC10aWxlZCBzdXJmYWNlLCB0aGUgcGxhbmUgYmxv
d3MgdXAKQEAgLTM4NjUsMTggKzM4NjQsMzcgQEAgc3RhdGljIGludCBza2xfY2hlY2tfbWFpbl9z
dXJmYWNlKHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCiAJaWYgKGZiLT5t
b2RpZmllciA9PSBJOTE1X0ZPUk1BVF9NT0RfWF9USUxFRCkgewogCQlpbnQgY3BwID0gZmItPmZv
cm1hdC0+Y3BwWzBdOwogCi0JCXdoaWxlICgoeCArIHcpICogY3BwID4gcGxhbmVfc3RhdGUtPmNv
bG9yX3BsYW5lWzBdLnN0cmlkZSkgewotCQkJaWYgKG9mZnNldCA9PSAwKSB7CisJCXdoaWxlICgo
KnggKyB3KSAqIGNwcCA+IHBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVswXS5zdHJpZGUpIHsKKwkJ
CWlmICgqb2Zmc2V0ID09IDApIHsKIAkJCQlkcm1fZGJnX2ttcygmZGV2X3ByaXYtPmRybSwKIAkJ
CQkJICAgICJVbmFibGUgdG8gZmluZCBzdWl0YWJsZSBkaXNwbGF5IHN1cmZhY2Ugb2Zmc2V0IGR1
ZSB0byBYLXRpbGluZ1xuIik7CiAJCQkJcmV0dXJuIC1FSU5WQUw7CiAJCQl9CiAKLQkJCW9mZnNl
dCA9IGludGVsX3BsYW5lX2FkanVzdF9hbGlnbmVkX29mZnNldCgmeCwgJnksIHBsYW5lX3N0YXRl
LCAwLAotCQkJCQkJCQkgICBvZmZzZXQsIG9mZnNldCAtIGFsaWdubWVudCk7CisJCQkqb2Zmc2V0
ID0gaW50ZWxfcGxhbmVfYWRqdXN0X2FsaWduZWRfb2Zmc2V0KHgsIHksIHBsYW5lX3N0YXRlLCAw
LAorCQkJCQkJCQkgICAgKm9mZnNldCwKKwkJCQkJCQkJICAgICpvZmZzZXQgLSBhbGlnbm1lbnQp
OwogCQl9CiAJfQogCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgc2tsX2NoZWNrX21haW5f
c3VyZmFjZShzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQoreworCXN0cnVj
dCBpbnRlbF9wbGFuZSAqcGxhbmUgPSB0b19pbnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+dWFwaS5w
bGFuZSk7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShwbGFu
ZS0+YmFzZS5kZXYpOworCWNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxhbmVf
c3RhdGUtPmh3LmZiOworCWludCB4ID0gcGxhbmVfc3RhdGUtPnVhcGkuc3JjLngxID4+IDE2Owor
CWludCB5ID0gcGxhbmVfc3RhdGUtPnVhcGkuc3JjLnkxID4+IDE2OworCWNvbnN0IGludCBhdXhf
cGxhbmUgPSBpbnRlbF9tYWluX3RvX2F1eF9wbGFuZShmYiwgMCk7CisJY29uc3QgdTMyIGFsaWdu
bWVudCA9IGludGVsX3N1cmZfYWxpZ25tZW50KGZiLCAwKTsKKwl1MzIgb2Zmc2V0OworCWludCBy
ZXQ7CisKKwlyZXQgPSBza2xfY2FsY19tYWluX3N1cmZhY2Vfb2Zmc2V0KHBsYW5lX3N0YXRlLCAm
eCwgJnksICZvZmZzZXQpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CiAJLyoKIAkgKiBDQ1Mg
QVVYIHN1cmZhY2UgZG9lc24ndCBoYXZlIGl0cyBvd24geC95IG9mZnNldHMsIHdlIG11c3QgbWFr
ZSBzdXJlCiAJICogdGhleSBtYXRjaCB3aXRoIHRoZSBtYWluIHN1cmZhY2UgeC95IG9mZnNldHMu
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXku
aCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5oCmluZGV4IGIy
OTY5ZDhmZjYyNS4uZjljZTk4ZWFlMDIwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2Rpc3BsYXkuaApAQCAtNjM2LDYgKzYzNiw4IEBAIHUzMiBza2xfcGxhbmVfY3Rs
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogdTMyIHNrbF9wbGFu
ZV9jdGxfY3J0Yyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7CiB1
MzIgc2tsX3BsYW5lX3N0cmlkZShjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5l
X3N0YXRlLAogCQkgICAgIGludCBwbGFuZSk7CitpbnQgc2tsX2NhbGNfbWFpbl9zdXJmYWNlX29m
ZnNldChjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlLAorCQkJCSBp
bnQgKngsIGludCAqeSwgdTMyICpvZmZzZXQpOwogaW50IHNrbF9jaGVja19wbGFuZV9zdXJmYWNl
KHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpOwogaW50IGk5eHhfY2hlY2tf
cGxhbmVfc3VyZmFjZShzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKTsKIGlu
dCBza2xfZm9ybWF0X3RvX2ZvdXJjYyhpbnQgZm9ybWF0LCBib29sIHJnYl9vcmRlciwgYm9vbCBh
bHBoYSk7Ci0tIAoyLjI1LjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNr
dG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2lu
dGVsLWdmeAo=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 3DDB7BEAF5
	for <lists+intel-gfx@lfdr.de>; Thu, 26 Sep 2019 05:47:57 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A9A2A6EC58;
	Thu, 26 Sep 2019 03:47:54 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga07.intel.com (mga07.intel.com [134.134.136.100])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7B8C66EC58
 for <intel-gfx@lists.freedesktop.org>; Thu, 26 Sep 2019 03:47:53 +0000 (UTC)
X-Amp-Result: UNKNOWN
X-Amp-Original-Verdict: FILE UNKNOWN
X-Amp-File-Uploaded: False
Received: from fmsmga008.fm.intel.com ([10.253.24.58])
 by orsmga105.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 25 Sep 2019 20:47:52 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,550,1559545200"; d="scan'208";a="188986889"
Received: from mdroper-desk1.fm.intel.com (HELO
 mdroper-desk1.amr.corp.intel.com) ([10.1.27.135])
 by fmsmga008.fm.intel.com with ESMTP; 25 Sep 2019 20:47:51 -0700
Date: Wed, 25 Sep 2019 20:48:02 -0700
From: Matt Roper <matthew.d.roper@intel.com>
To: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
Message-ID: <20190926034802.GV1869@mdroper-desk1.amr.corp.intel.com>
References: <20190920114235.22411-1-maarten.lankhorst@linux.intel.com>
 <20190920114235.22411-11-maarten.lankhorst@linux.intel.com>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <20190920114235.22411-11-maarten.lankhorst@linux.intel.com>
User-Agent: Mutt/1.12.1 (2019-06-15)
Subject: Re: [Intel-gfx] [PATCH 11/23] drm/i915: Try to make bigjoiner work
 in atomic check.
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: intel-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T24gRnJpLCBTZXAgMjAsIDIwMTkgYXQgMDE6NDI6MjNQTSArMDIwMCwgTWFhcnRlbiBMYW5raG9y
c3Qgd3JvdGU6Cj4gV2hlbiB0aGUgY2xvY2sgaXMgaGlnaGVyIHRoYW4gdGhlIGRvdGNsb2NrLCB0
cnkgd2l0aCAyIHBpcGVzIGVuYWJsZWQuCj4gSWYgd2UgY2FuIGVuYWJsZSAyLCB0aGVuIHdlIHdp
bGwgZ28gaW50byBiaWcgam9pbmVyIG1vZGUsIGFuZCBzdGVhbAo+IHRoZSBhZGphY2VudCBjcnRj
Lgo+IAo+IFRoaXMgb25seSBsaW5rcyB0aGUgY3J0YydzIGluIHNvZnR3YXJlLCBubyBoYXJkd2Fy
ZSBvciBwbGFuZQo+IHByb2dyYW1taW5nIGlzIGRvbmUgeWV0LiBCbG9icyBhcmUgYWxzbyBjb3Bp
ZWQgZnJvbSB0aGUgbWFzdGVyJ3MKPiBjcnRjX3N0YXRlLCBzbyBpdCBkb2Vzbid0IGRlcGVuZCBh
dCBjb21taXQgdGltZSBvbiB0aGUgb3RoZXIKPiBjcnRjX3N0YXRlLgo+IAo+IFNpZ25lZC1vZmYt
Ynk6IE1hYXJ0ZW4gTGFua2hvcnN0IDxtYWFydGVuLmxhbmtob3JzdEBsaW51eC5pbnRlbC5jb20+
Cj4gLS0tCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWljLmMgICB8
ICAxNSArLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0b21pYy5oICAg
fCAgIDMgKy0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMg
IHwgMTk3ICsrKysrKysrKysrKysrKysrLQo+ICAuLi4vZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9k
aXNwbGF5X3R5cGVzLmggICAgfCAgMTEgKy0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9kcC5jICAgICAgIHwgIDI1ICsrLQo+ICA1IGZpbGVzIGNoYW5nZWQsIDIyOCBpbnNl
cnRpb25zKCspLCAyMyBkZWxldGlvbnMoLSkKPiAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9taWMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfYXRvbWljLmMKPiBpbmRleCBjNTBlMGIyMThiZDYuLjBkYjA0MDY0Yzg2ZSAx
MDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0b21pYy5j
Cj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9taWMuYwo+IEBA
IC0yMjgsMjUgKzIyOCwyNiBAQCB2b2lkIGludGVsX2NydGNfZnJlZV9od19zdGF0ZShzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgCWludGVsX2NydGNfcHV0X2NvbG9yX2Js
b2JzKGNydGNfc3RhdGUpOwo+ICB9Cj4gIAo+IC12b2lkIGludGVsX2NydGNfY29weV9jb2xvcl9i
bG9icyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiArdm9pZCBpbnRlbF9j
cnRjX2NvcHlfY29sb3JfYmxvYnMoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
Cj4gKwkJCQkgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmZyb21fY3J0Y19zdGF0ZSkK
PiAgewo+ICAJaW50ZWxfY3J0Y19wdXRfY29sb3JfYmxvYnMoY3J0Y19zdGF0ZSk7Cj4gIAo+IC0J
aWYgKGNydGNfc3RhdGUtPnVhcGkuZGVnYW1tYV9sdXQpCj4gKwlpZiAoZnJvbV9jcnRjX3N0YXRl
LT51YXBpLmRlZ2FtbWFfbHV0KQo+ICAJCWNydGNfc3RhdGUtPmh3LmRlZ2FtbWFfbHV0ID0KPiAt
CQkJZHJtX3Byb3BlcnR5X2Jsb2JfZ2V0KGNydGNfc3RhdGUtPnVhcGkuZGVnYW1tYV9sdXQpOwo+
ICsJCQlkcm1fcHJvcGVydHlfYmxvYl9nZXQoZnJvbV9jcnRjX3N0YXRlLT51YXBpLmRlZ2FtbWFf
bHV0KTsKPiAgCWVsc2UKPiAgCQljcnRjX3N0YXRlLT5ody5kZWdhbW1hX2x1dCA9IE5VTEw7Cj4g
IAo+IC0JaWYgKGNydGNfc3RhdGUtPnVhcGkuZ2FtbWFfbHV0KQo+ICsJaWYgKGZyb21fY3J0Y19z
dGF0ZS0+dWFwaS5nYW1tYV9sdXQpCj4gIAkJY3J0Y19zdGF0ZS0+aHcuZ2FtbWFfbHV0ID0KPiAt
CQkJZHJtX3Byb3BlcnR5X2Jsb2JfZ2V0KGNydGNfc3RhdGUtPnVhcGkuZ2FtbWFfbHV0KTsKPiAr
CQkJZHJtX3Byb3BlcnR5X2Jsb2JfZ2V0KGZyb21fY3J0Y19zdGF0ZS0+dWFwaS5nYW1tYV9sdXQp
Owo+ICAJZWxzZQo+ICAJCWNydGNfc3RhdGUtPmh3LmdhbW1hX2x1dCA9IE5VTEw7Cj4gIAo+IC0J
aWYgKGNydGNfc3RhdGUtPnVhcGkuY3RtKQo+ICsJaWYgKGZyb21fY3J0Y19zdGF0ZS0+dWFwaS5j
dG0pCj4gIAkJY3J0Y19zdGF0ZS0+aHcuY3RtID0KPiAtCQkJZHJtX3Byb3BlcnR5X2Jsb2JfZ2V0
KGNydGNfc3RhdGUtPnVhcGkuY3RtKTsKPiArCQkJZHJtX3Byb3BlcnR5X2Jsb2JfZ2V0KGZyb21f
Y3J0Y19zdGF0ZS0+dWFwaS5jdG0pOwo+ICAJZWxzZQo+ICAJCWNydGNfc3RhdGUtPmh3LmN0bSA9
IE5VTEw7Cj4gIH0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9hdG9taWMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWlj
LmgKPiBpbmRleCA0MmJlOTFlMDc3MmEuLjhkYTg0ZDY0YWEwNCAxMDA2NDQKPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0b21pYy5oCj4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9taWMuaAo+IEBAIC0zNiw3ICszNiw4IEBAIHN0
cnVjdCBkcm1fY3J0Y19zdGF0ZSAqaW50ZWxfY3J0Y19kdXBsaWNhdGVfc3RhdGUoc3RydWN0IGRy
bV9jcnRjICpjcnRjKTsKPiAgdm9pZCBpbnRlbF9jcnRjX2Rlc3Ryb3lfc3RhdGUoc3RydWN0IGRy
bV9jcnRjICpjcnRjLAo+ICAJCQkgICAgICAgc3RydWN0IGRybV9jcnRjX3N0YXRlICpzdGF0ZSk7
Cj4gIHZvaWQgaW50ZWxfY3J0Y19mcmVlX2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlKTsKPiAtdm9pZCBpbnRlbF9jcnRjX2NvcHlfY29sb3JfYmxvYnMoc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpOwo+ICt2b2lkIGludGVsX2NydGNfY29weV9j
b2xvcl9ibG9icyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiArCQkJCSBj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqZnJvbV9jcnRjX3N0YXRlKTsKPiAgc3RydWN0
IGRybV9hdG9taWNfc3RhdGUgKmludGVsX2F0b21pY19zdGF0ZV9hbGxvYyhzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2KTsKPiAgdm9pZCBpbnRlbF9hdG9taWNfc3RhdGVfY2xlYXIoc3RydWN0IGRybV9h
dG9taWNfc3RhdGUgKnN0YXRlKTsKPiAgCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9kaXNwbGF5LmMKPiBpbmRleCBiYTUyYTcwODQwZmQuLjE0M2Q1MzFjNGM4MSAxMDA2
NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwo+
ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCj4gQEAg
LTc0MzQsNyArNzQzNCw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfY3J0Y19jb21wdXRlX2NvbmZpZyhz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgCQkJCSAgICAgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKnBpcGVfY29uZmlnKQo+ICB7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAtCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxh
eV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlOwo+
ICsJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmcGlwZV9jb25maWct
Pmh3LmFkanVzdGVkX21vZGU7Cj4gIAlpbnQgY2xvY2tfbGltaXQgPSBkZXZfcHJpdi0+bWF4X2Rv
dGNsa19mcmVxOwo+ICAKPiAgCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNCkgewo+IEBAIC03
NDUxLDYgKzc0NTEsMjUgQEAgc3RhdGljIGludCBpbnRlbF9jcnRjX2NvbXB1dGVfY29uZmlnKHN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAJCX0KPiAgCX0KPiAgCj4gKwkvKgo+ICsJICogY29w
eSBodyBtb2RlIHRvIHRyYW5zY29kZXIgbW9kZS4KPiArCSAqIFRoaXMgbWF0dGVycyBtb3N0bHkg
Zm9yIGJpZyBqb2luZXIsIHdoaWNoIHNwbGl0cyB0aGUgbW9kZSBpbiBoYWxmLgo+ICsJICovCj4g
KwlwaXBlX2NvbmZpZy0+aHcudHJhbnNjb2Rlcl9tb2RlID0gcGlwZV9jb25maWctPmh3LmFkanVz
dGVkX21vZGU7Cj4gKwlpZiAocGlwZV9jb25maWctPmJpZ2pvaW5lcikgewo+ICsJCS8qIE1ha2Ug
c3VyZSB0aGUgY3J0YyBjb25maWcgaXMgaGFsdmVkIGhvcml6b250YWxseSAqLwo+ICsJCWFkanVz
dGVkX21vZGUtPmNydGNfY2xvY2sgLz0gMjsKPiArCQlhZGp1c3RlZF9tb2RlLT5jcnRjX2hkaXNw
bGF5IC89IDI7Cj4gKwkJYWRqdXN0ZWRfbW9kZS0+Y3J0Y19oYmxhbmtfc3RhcnQgLz0gMjsKPiAr
CQlhZGp1c3RlZF9tb2RlLT5jcnRjX2hibGFua19lbmQgLz0gMjsKPiArCQlhZGp1c3RlZF9tb2Rl
LT5jcnRjX2hzeW5jX3N0YXJ0IC89IDI7Cj4gKwkJYWRqdXN0ZWRfbW9kZS0+Y3J0Y19oc3luY19l
bmQgLz0gMjsKPiArCQlhZGp1c3RlZF9tb2RlLT5jcnRjX2h0b3RhbCAvPSAyOwo+ICsJCWFkanVz
dGVkX21vZGUtPmNydGNfaHNrZXcgLz0gMjsKCklmIGFkanVzdGVkX21vZGUgaXMgdGhlICJwaXBl
IG1vZGUsIiBkb2VzIGFueXRoaW5nIG90aGVyIHRoYW4gdGhlIHNpemUKaGF2ZSBtZWFuaW5nIG9y
IG1hdHRlciBhdCB0aGF0IGxldmVsPyAgTm90IHRoYXQgaGFsdmluZyB0aGUgcmVzdCBvZgp0aGVz
ZSBodXJ0cyBhbnl0aGluZywgaXQganVzdCBzZWVtcyBzdHJhbmdlIHRvIGNvbnNpZGVyIHRoZW0g
YXQgdGhlIHBpcGUKbGV2ZWwuCgo+ICsKPiArCQlwaXBlX2NvbmZpZy0+cGlwZV9zcmNfdyAvPSAy
Owo+ICsJfQo+ICsKPiAgCWlmIChhZGp1c3RlZF9tb2RlLT5jcnRjX2Nsb2NrID4gY2xvY2tfbGlt
aXQpIHsKPiAgCQlEUk1fREVCVUdfS01TKCJyZXF1ZXN0ZWQgcGl4ZWwgY2xvY2sgKCVkIGtIeikg
dG9vIGhpZ2ggKG1heDogJWQga0h6LCBkb3VibGUgd2lkZTogJXMpXG4iLAo+ICAJCQkgICAgICBh
ZGp1c3RlZF9tb2RlLT5jcnRjX2Nsb2NrLCBjbG9ja19saW1pdCwKPiBAQCAtODEzMyw3ICs4MTUy
LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfc2V0X3BpcGVfdGltaW5ncyhjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKCldlIG1heSB3YW50IHRvIHJlbmFtZSB0aGlzIGZ1
bmN0aW9uIHRvIGludGVsX3NldF90cmFuc2NvZGVyX3RpbWluZ3MKbm93IHRoYXQgcGlwZSBhbmQg
dHJhbnNjb2RlciBhcmUgc3RhcnRpbmcgdG8gYmUgZGlmZmVyZW50LgoKCj4gIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCWVu
dW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCWVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNj
b2RlciA9IGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyOwo+IC0JY29uc3Qgc3RydWN0IGRybV9k
aXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9k
ZTsKPiArCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJmNy
dGNfc3RhdGUtPmh3LnRyYW5zY29kZXJfbW9kZTsKPiAgCXUzMiBjcnRjX3Z0b3RhbCwgY3J0Y192
YmxhbmtfZW5kOwo+ICAJaW50IHZzeW5jc2hpZnQgPSAwOwo+ICAKPiBAQCAtMTE3NzQsNiArMTE3
OTMsOCBAQCBzdGF0aWMgaW50IGludGVsX2NydGNfYXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fY3J0
YyAqX2NydGMsCj4gIAkJdG9faW50ZWxfY3J0Y19zdGF0ZShfY3J0Y19zdGF0ZSk7Cj4gIAlpbnQg
cmV0Owo+ICAJYm9vbCBtb2RlX2NoYW5nZWQgPSBuZWVkc19tb2Rlc2V0KGNydGNfc3RhdGUpOwo+
ICsJc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUgPQo+ICsJCXRvX2ludGVsX2F0b21p
Y19zdGF0ZShjcnRjX3N0YXRlLT51YXBpLnN0YXRlKTsKPiAgCj4gIAlpZiAoSU5URUxfR0VOKGRl
dl9wcml2KSA8IDUgJiYgIUlTX0c0WChkZXZfcHJpdikgJiYKPiAgCSAgICBtb2RlX2NoYW5nZWQg
JiYgIWNydGNfc3RhdGUtPmh3LmFjdGl2ZSkKPiBAQCAtMTE3ODEsNiArMTE4MDIsNyBAQCBzdGF0
aWMgaW50IGludGVsX2NydGNfYXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fY3J0YyAqX2NydGMsCj4g
IAo+ICAJaWYgKG1vZGVfY2hhbmdlZCAmJiBjcnRjX3N0YXRlLT5ody5lbmFibGUgJiYKPiAgCSAg
ICBkZXZfcHJpdi0+ZGlzcGxheS5jcnRjX2NvbXB1dGVfY2xvY2sgJiYKPiArCSAgICAhY3J0Y19z
dGF0ZS0+Ymlnam9pbmVyX3NsYXZlICYmCj4gIAkgICAgIVdBUk5fT04oY3J0Y19zdGF0ZS0+c2hh
cmVkX2RwbGwpKSB7Cj4gIAkJcmV0ID0gZGV2X3ByaXYtPmRpc3BsYXkuY3J0Y19jb21wdXRlX2Ns
b2NrKGNydGMsIGNydGNfc3RhdGUpOwo+ICAJCWlmIChyZXQpCj4gQEAgLTExNzk2LDggKzExODE4
LDE1IEBAIHN0YXRpYyBpbnQgaW50ZWxfY3J0Y19hdG9taWNfY2hlY2soc3RydWN0IGRybV9jcnRj
ICpfY3J0YywKPiAgCj4gIAlpZiAobW9kZV9jaGFuZ2VkIHx8IGNydGNfc3RhdGUtPnVwZGF0ZV9w
aXBlIHx8Cj4gIAkgICAgY3J0Y19zdGF0ZS0+dWFwaS5jb2xvcl9tZ210X2NoYW5nZWQpIHsKPiAr
CQljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbWFzdGVyX2NydGNfc3RhdGUgPSBjcnRj
X3N0YXRlOwo+ICsKPiArCQlpZiAoY3J0Y19zdGF0ZS0+Ymlnam9pbmVyX3NsYXZlKQo+ICsJCQlt
YXN0ZXJfY3J0Y19zdGF0ZSA9Cj4gKwkJCQlpbnRlbF9hdG9taWNfZ2V0X25ld19jcnRjX3N0YXRl
KHN0YXRlLAo+ICsJCQkJCWNydGNfc3RhdGUtPmJpZ2pvaW5lcl9saW5rZWRfY3J0Yyk7Cj4gKwo+
ICAJCS8qIENvcHkgY29sb3IgYmxvYnMgdG8gaHcgc3RhdGUgKi8KPiAtCQlpbnRlbF9jcnRjX2Nv
cHlfY29sb3JfYmxvYnMoY3J0Y19zdGF0ZSk7Cj4gKwkJaW50ZWxfY3J0Y19jb3B5X2NvbG9yX2Js
b2JzKGNydGNfc3RhdGUsIG1hc3Rlcl9jcnRjX3N0YXRlKTsKPiAgCj4gIAkJcmV0ID0gaW50ZWxf
Y29sb3JfY2hlY2soY3J0Y19zdGF0ZSk7Cj4gIAkJaWYgKHJldCkKPiBAQCAtMTIyNTksNyArMTIy
ODgsNDggQEAgc3RhdGljIHZvaWQgY29weV9od190b191YXBpX3N0YXRlKHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAJY3J0Y19zdGF0ZS0+dWFwaS5lbmFibGUgPSBjcnRj
X3N0YXRlLT5ody5lbmFibGU7Cj4gIAljcnRjX3N0YXRlLT51YXBpLmFjdGl2ZSA9IGNydGNfc3Rh
dGUtPmh3LmFjdGl2ZTsKPiAgCWNydGNfc3RhdGUtPnVhcGkubW9kZSA9IGNydGNfc3RhdGUtPmh3
Lm1vZGU7Cj4gLQljcnRjX3N0YXRlLT51YXBpLmFkanVzdGVkX21vZGUgPSBjcnRjX3N0YXRlLT5o
dy5hZGp1c3RlZF9tb2RlOwo+ICsJY3J0Y19zdGF0ZS0+dWFwaS5hZGp1c3RlZF9tb2RlID0gY3J0
Y19zdGF0ZS0+aHcudHJhbnNjb2Rlcl9tb2RlOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50Cj4gK2Nv
cHlfYmlnam9pbmVyX2NydGNfc3RhdGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUsCj4gKwkJCSAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmZyb21fY3J0Y19zdGF0
ZSkKPiArewo+ICsJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnNhdmVkX3N0YXRlOwo+ICsJc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0
Yyk7Cj4gKwo+ICsJc2F2ZWRfc3RhdGUgPSBrbWVtZHVwKGZyb21fY3J0Y19zdGF0ZSwgc2l6ZW9m
KCpzYXZlZF9zdGF0ZSksIEdGUF9LRVJORUwpOwo+ICsJaWYgKCFzYXZlZF9zdGF0ZSkKPiArCQly
ZXR1cm4gLUVOT01FTTsKPiArCj4gKwlzYXZlZF9zdGF0ZS0+dWFwaSA9IGNydGNfc3RhdGUtPnVh
cGk7Cj4gKwlzYXZlZF9zdGF0ZS0+c2NhbGVyX3N0YXRlID0gY3J0Y19zdGF0ZS0+c2NhbGVyX3N0
YXRlOwo+ICsJc2F2ZWRfc3RhdGUtPnNoYXJlZF9kcGxsID0gY3J0Y19zdGF0ZS0+c2hhcmVkX2Rw
bGw7Cj4gKwlzYXZlZF9zdGF0ZS0+ZHBsbF9od19zdGF0ZSA9IGNydGNfc3RhdGUtPmRwbGxfaHdf
c3RhdGU7Cj4gKwlzYXZlZF9zdGF0ZS0+Y3JjX2VuYWJsZWQgPSBjcnRjX3N0YXRlLT5jcmNfZW5h
YmxlZDsKPiArCj4gKwlpbnRlbF9jcnRjX2ZyZWVfaHdfc3RhdGUoY3J0Y19zdGF0ZSk7Cj4gKwlt
ZW1jcHkoY3J0Y19zdGF0ZSwgc2F2ZWRfc3RhdGUsIHNpemVvZigqY3J0Y19zdGF0ZSkpOwo+ICsJ
a2ZyZWUoc2F2ZWRfc3RhdGUpOwo+ICsKPiArCS8qIFJlLWluaXQgaHcgc3RhdGUgKi8KPiArCW1l
bXNldCgmY3J0Y19zdGF0ZS0+aHcsIDAsIHNpemVvZihzYXZlZF9zdGF0ZS0+aHcpKTsKPiArCWNy
dGNfc3RhdGUtPmh3LmVuYWJsZSA9IGZyb21fY3J0Y19zdGF0ZS0+aHcuZW5hYmxlOwo+ICsJY3J0
Y19zdGF0ZS0+aHcuYWN0aXZlID0gZnJvbV9jcnRjX3N0YXRlLT5ody5hY3RpdmU7Cj4gKwljcnRj
X3N0YXRlLT5ody5tb2RlID0gZnJvbV9jcnRjX3N0YXRlLT5ody5tb2RlOwo+ICsJY3J0Y19zdGF0
ZS0+aHcuYWRqdXN0ZWRfbW9kZSA9IGZyb21fY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZTsK
PiArCj4gKwkvKiBTb21lIGZpeHVwcyAqLwo+ICsJY3J0Y19zdGF0ZS0+dWFwaS5tb2RlX2NoYW5n
ZWQgPSBmcm9tX2NydGNfc3RhdGUtPnVhcGkubW9kZV9jaGFuZ2VkOwo+ICsJY3J0Y19zdGF0ZS0+
dWFwaS5jb25uZWN0b3JzX2NoYW5nZWQgPSBmcm9tX2NydGNfc3RhdGUtPnVhcGkuY29ubmVjdG9y
c19jaGFuZ2VkOwo+ICsJY3J0Y19zdGF0ZS0+dWFwaS5hY3RpdmVfY2hhbmdlZCA9IGZyb21fY3J0
Y19zdGF0ZS0+dWFwaS5hY3RpdmVfY2hhbmdlZDsKPiArCWNydGNfc3RhdGUtPm52MTJfcGxhbmVz
ID0gY3J0Y19zdGF0ZS0+YzhfcGxhbmVzID0gY3J0Y19zdGF0ZS0+dXBkYXRlX3BsYW5lcyA9IDA7
Cj4gKwljcnRjX3N0YXRlLT5iaWdqb2luZXJfbGlua2VkX2NydGMgPSB0b19pbnRlbF9jcnRjKGZy
b21fY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPiArCWNydGNfc3RhdGUtPmJpZ2pvaW5lcl9zbGF2
ZSA9IHRydWU7Cj4gKwljcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlciA9IChlbnVtIHRyYW5zY29k
ZXIpY3J0Yy0+cGlwZTsKPiArCWNydGNfc3RhdGUtPmhhc19hdWRpbyA9IGZhbHNlOwo+ICsKPiAr
CXJldHVybiAwOwo+ICB9Cj4gIAo+ICBzdGF0aWMgaW50Cj4gQEAgLTEyNDMyLDcgKzEyNTAyLDcg
QEAgaW50ZWxfbW9kZXNldF9waXBlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlw
ZV9jb25maWcpCj4gIAkJICAgICAgYmFzZV9icHAsIHBpcGVfY29uZmlnLT5waXBlX2JwcCwgcGlw
ZV9jb25maWctPmRpdGhlcik7Cj4gIAo+ICAJLyogdWFwaSB3YW50cyBhIGNvcHkgb2YgdGhlIGFk
anVzdGVkX21vZGUgZm9yIHZibGFuayBib29ra2VlcGluZyAqLwo+IC0JcGlwZV9jb25maWctPnVh
cGkuYWRqdXN0ZWRfbW9kZSA9IHBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlOwo+ICsJcGlw
ZV9jb25maWctPnVhcGkuYWRqdXN0ZWRfbW9kZSA9IHBpcGVfY29uZmlnLT5ody50cmFuc2NvZGVy
X21vZGU7Cj4gIAo+ICAJcmV0dXJuIDA7Cj4gIH0KPiBAQCAtMTM1NDksNiArMTM2MTksMTA5IEBA
IHN0YXRpYyB2b2lkIGludGVsX2NydGNfY2hlY2tfZmFzdHNldChjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhCj4gIAluZXdfY3J0Y19zdGF0ZS0+aGFzX2RycnMgPSBv
bGRfY3J0Y19zdGF0ZS0+aGFzX2RycnM7Cj4gIH0KPiAgCj4gK3N0YXRpYyBpbnQgaW50ZWxfYXRv
bWljX2NoZWNrX2JpZ2pvaW5lcihzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAr
ewo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShzdGF0ZS0+
YmFzZS5kZXYpOwo+ICsJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLCAq
bmV3X2NydGNfc3RhdGUsICpzbGF2ZV9jcnRjX3N0YXRlLCAqbWFzdGVyX2NydGNfc3RhdGU7Cj4g
KwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywgKnNsYXZlLCAqbWFzdGVyOwo+ICsJaW50IGksIHJl
dCA9IDA7Cj4gKwo+ICsJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCAxMSkKPiArCQlyZXR1cm4g
MDsKPiArCj4gKwlmb3JfZWFjaF9vbGRuZXdfaW50ZWxfY3J0Y19pbl9zdGF0ZShzdGF0ZSwgY3J0
Yywgb2xkX2NydGNfc3RhdGUsCj4gKwkJCQkJICAgIG5ld19jcnRjX3N0YXRlLCBpKSB7Cj4gKwkJ
aWYgKCFvbGRfY3J0Y19zdGF0ZS0+Ymlnam9pbmVyX3NsYXZlKQo+ICsJCQljb250aW51ZTsKPiAr
Cj4gKwkJaWYgKGNydGMtPnBpcGUgPT0gUElQRV9BKSB7CgpSYXRoZXIgdGhhbiBhIGhhcmRjb2Rl
ZCBQSVBFX0EgY2hlY2ssIHNob3VsZCB3ZSBoYXZlIGEgYml0bWFzayBvZiBwaXBlcwp0aGF0IGNh
biBiZSBiaWcgam9pbmVyIG1hc3RlcnMgc29tZXdoZXJlPyAgbWFzayA9IDBiMTExIGZvciBnZW4x
MiwgYnV0Cm1hc2sgPSAwYjAxMCBmb3IgZ2VuMTEuICBUaGVuIHRoZSBhbGxvd2FibGUgc2xhdmVz
CndvdWxkIGJlIG1hc2sgPDwgMSwgd2hpY2ggd291bGQgYWxzbyBlbnN1cmUgZ2VuMTEgZG9lc24n
dCBhbGxvdyBhIHNsYXZlIG9uIHBpcGUgQi4KCj4gKwkJCURSTV9FUlJPUigiQmlnam9pbmVyIHNs
YXZlIG9uIHBpcGUgQT9cbiIpOwoKV2Ugc2hvdWxkIHByb2JhYmx5IGp1c3QgdXNlIGEgV0FSTl9P
TigpIGluIHRoZSBjb25kaXRpb24gYWJvdmUgc2luY2UKdGhpcyBzaG91bGRuJ3QgaGFwcGVuIHVu
bGVzcyB3ZSBzY3Jld2VkIHVwIHNvbWV3aGVyZSBpbiB0aGUgZHJpdmVyLgoKPiArCQkJcmV0dXJu
IC1FSU5WQUw7Cj4gKwkJfQo+ICsKPiArCQkvKiBjcnRjIHN0YXlpbmcgaW4gc2xhdmUgbW9kZT8g
Ki8KPiArCQlpZiAoIW5ld19jcnRjX3N0YXRlLT51YXBpLmVuYWJsZSkKPiArCQkJY29udGludWU7
Cj4gKwo+ICsJCWlmIChuZWVkc19tb2Rlc2V0KG5ld19jcnRjX3N0YXRlKSB8fCBuZXdfY3J0Y19z
dGF0ZS0+dXBkYXRlX3BpcGUpIHsKCldvbid0IG5lZWRzX21vZGVzZXQoKSBhbHdheXMgcmV0dXJu
IHRydWUgaGVyZT8gIEkuZS4sIGlmIHdlIHdlcmUgYSBzbGF2ZQpwcmV2aW91c2x5IGJ1dCBkaWRu
J3QgYmFpbCBvbiB0aGUgdWFwaS5lbmFibGUgY2hlY2sgYWJvdmUsIHRoZW4KdWFwaS5lbmFibGUg
aXMgZmxpcHBpbmcgZnJvbSBmYWxzZSB0byB0cnVlLgoKR2l2ZW4gdGhhdCBlbmFibGluZyB0aGUg
cHJldmlvdXNseS1zbGF2ZSBDUlRDIGlzIG9ubHkgcG9zc2libGUgaWYgdGhlCnByZXZpb3VzbHkt
bWFzdGVyIENSVEMgaXMgYWxzbyBtb2Rlc2V0dGluZyBpbiBhIHdheSB0aGF0IHdvbid0IG5lZWQg
YQpzbGF2ZSBhbnltb3JlLCBpdCBzZWVtcyBsaWtlIHRoZSBuZXh0IHN0ZXAgd291bGQgYmUKCiAg
ICAgICAgbWFzdGVyX2NydGNfc3RhdGUgPSBpbnRlbF9nZXRfZXhpc3RpbmdfY3J0Y19zdGF0ZSgp
CiAgICAgICAgaWYgKCFtYXN0ZXJfY3J0Y19zdGF0ZSB8fCAhbmVlZHNfbW9kZXNldChtYXN0ZXJf
Y3J0Y19zdGF0ZSkpCiAgICAgICAgICAgICAgICBmYWlsCiAgICAgICAgICAgICAgICAKb3RoZXJ3
aXNlIHdlJ3ZlIG5vdyBvdmVyY29tbWl0dGVkIG91ciBzbGF2ZSBDUlRDLgoKPiArCQkJbWFzdGVy
ID0gb2xkX2NydGNfc3RhdGUtPmJpZ2pvaW5lcl9saW5rZWRfY3J0YzsKPiArCQkJbWFzdGVyX2Ny
dGNfc3RhdGUgPSBpbnRlbF9hdG9taWNfZ2V0X2NydGNfc3RhdGUoJnN0YXRlLT5iYXNlLCBtYXN0
ZXIpOwo+ICsJCQlpZiAoSVNfRVJSKG1hc3Rlcl9jcnRjX3N0YXRlKSkKPiArCQkJCXJldHVybiBQ
VFJfRVJSKG1hc3Rlcl9jcnRjX3N0YXRlKTsKPiArCj4gKwkJCS8qCj4gKwkJCSAqIEZvcmNlIG1v
ZGVzZXQgb24gbWFzdGVyLCB0byByZWNhbGN1bGF0ZSBiaWdqb2luZXIKPiArCQkJICogc3RhdGUu
Cj4gKwkJCSAqCj4gKwkJCSAqIElmIG1hc3Rlcl9jcnRjX3N0YXRlIHdhcyBub3QgcGFydCBvZiB0
aGUgYXRvbWljIGNvbW1pdCwKPiArCQkJICogd2Ugd2lsbCBmYWlsIGJlY2F1c2UgdGhlIG1hc3Rl
ciB3YXMgbm90IGRlY29uZmlndXJlZCwKPiArCQkJICogYnV0IGF0IGxlYXN0IGZhaWwgYmVsb3cg
dG8gdW5pZnkgdGhlIGNoZWNrcy4KPiArCQkJICovCj4gKwkJCW1hc3Rlcl9jcnRjX3N0YXRlLT51
YXBpLm1vZGVfY2hhbmdlZCA9IHRydWU7CgpTaG91bGQgd2UgaW5zdGVhZCB1cGRhdGUgaW50ZWxf
cGlwZV9jb25maWdfY29tcGFyZSB0byBjaGVjayBiaWdqb2luZXIKZmllbGRzIGFuZCBwcmV2ZW50
IGZhc3RzZXRzIG9uIHN0YXRlcyBjdXJyZW50bHkgdXNpbmcgdGhlIGJpZ2pvaW5lcj8gCgo+ICsK
PiArCQkJcmV0ID0gZHJtX2F0b21pY19hZGRfYWZmZWN0ZWRfcGxhbmVzKCZzdGF0ZS0+YmFzZSwg
JmNydGMtPmJhc2UpOwo+ICsJCQlpZiAocmV0KQo+ICsJCQkJcmV0dXJuIHJldDsKPiArCj4gKwkJ
CXJldCA9IGRybV9hdG9taWNfYWRkX2FmZmVjdGVkX2Nvbm5lY3RvcnMoJnN0YXRlLT5iYXNlLCAm
Y3J0Yy0+YmFzZSk7Cj4gKwkJCWlmIChyZXQpCj4gKwkJCQlyZXR1cm4gcmV0Owo+ICsJCX0KPiAr
CX0KPiArCj4gKwlmb3JfZWFjaF9vbGRuZXdfaW50ZWxfY3J0Y19pbl9zdGF0ZShzdGF0ZSwgY3J0
Yywgb2xkX2NydGNfc3RhdGUsCj4gKwkJCQkJICAgIG5ld19jcnRjX3N0YXRlLCBpKSB7Cj4gKwkJ
aWYgKCFuZXdfY3J0Y19zdGF0ZS0+dWFwaS5lbmFibGUgfHwgIW5ld19jcnRjX3N0YXRlLT5iaWdq
b2luZXIpIHsKPiArCQkJaWYgKCFvbGRfY3J0Y19zdGF0ZS0+Ymlnam9pbmVyKQo+ICsJCQkJY29u
dGludWU7Cj4gKwkJfQo+ICsKPiArCQlpZiAoIW5lZWRzX21vZGVzZXQobmV3X2NydGNfc3RhdGUp
ICYmICFuZXdfY3J0Y19zdGF0ZS0+dXBkYXRlX3BpcGUpCj4gKwkJCWNvbnRpbnVlOwo+ICsKPiAr
CQlpZiAobmV3X2NydGNfc3RhdGUtPmJpZ2pvaW5lciAmJiAhbmV3X2NydGNfc3RhdGUtPmJpZ2pv
aW5lcl9zbGF2ZSkgewo+ICsJCQlpZiAoMSArIGNydGMtPnBpcGUgPj0gSU5URUxfTlVNX1BJUEVT
KGRldl9wcml2KSkgewo+ICsJCQkJRFJNX0RFQlVHX0tNUygiQmlnIGpvaW5lciBjb25maWd1cmF0
aW9uIHJlcXVpcmVzIENSVEMgKyAxIHRvIGJlIHVzZWQsIGRvZXNuJ3QgZXhpc3RcbiIpOwo+ICsJ
CQkJcmV0dXJuIC1FSU5WQUw7Cj4gKwkJCX0KPiArCj4gKwkJCXNsYXZlID0gbmV3X2NydGNfc3Rh
dGUtPmJpZ2pvaW5lcl9saW5rZWRfY3J0YyA9Cj4gKwkJCQlpbnRlbF9nZXRfY3J0Y19mb3JfcGlw
ZShkZXZfcHJpdiwgY3J0Yy0+cGlwZSArIDEpOwo+ICsJCQlzbGF2ZV9jcnRjX3N0YXRlID0gaW50
ZWxfYXRvbWljX2dldF9jcnRjX3N0YXRlKCZzdGF0ZS0+YmFzZSwgc2xhdmUpOwo+ICsJCQlpZiAo
SVNfRVJSKHNsYXZlX2NydGNfc3RhdGUpKQo+ICsJCQkJcmV0dXJuIFBUUl9FUlIoc2xhdmVfY3J0
Y19zdGF0ZSk7Cj4gKwo+ICsJCQlpZiAoc2xhdmVfY3J0Y19zdGF0ZS0+dWFwaS5lbmFibGUpIHsK
PiArCQkJCURSTV9ERUJVR19LTVMoIltDUlRDOiVkOiVzXSBCaWcgam9pbmVyIGNvbmZpZ3VyYXRp
b24gcmVxdWlyZXMgdGhpcyBDUlRDIHRvIGJlIHVuY29uZmlndXJlZFxuIiwKPiArCQkJCQkgICAg
ICBzbGF2ZS0+YmFzZS5iYXNlLmlkLCBzbGF2ZS0+YmFzZS5uYW1lKTsKPiArCQkJCXJldHVybiAt
RUlOVkFMOwo+ICsJCQl9IGVsc2Ugewo+ICsJCQkJRFJNX0RFQlVHX0tNUygiW0NSVEM6JWQ6JXNd
IFVzZWQgYXMgc2xhdmUgZm9yIGJpZyBqb2luZXJcbiIsCj4gKwkJCQkJICAgICAgc2xhdmUtPmJh
c2UuYmFzZS5pZCwgc2xhdmUtPmJhc2UubmFtZSk7Cj4gKwkJCQlyZXQgPSBjb3B5X2JpZ2pvaW5l
cl9jcnRjX3N0YXRlKHNsYXZlX2NydGNfc3RhdGUsIG5ld19jcnRjX3N0YXRlKTsKPiArCQkJfQo+
ICsJCX0gZWxzZSB7Cj4gKwkJCW1hc3RlciA9IG5ld19jcnRjX3N0YXRlLT5iaWdqb2luZXJfbGlu
a2VkX2NydGM7Cj4gKwkJCWlmICghbWFzdGVyKQo+ICsJCQkJY29udGludWU7Cj4gKwoKV2hhdCBh
Ym91dCB0aGUgY2FzZSBvZiBhIENSVEMgdGhhdCBwcmV2aW91c2x5IG5lZWRlZCB0aGUgYmlnam9p
bmVyIGJ1dAppcyBwZXJmb3JtaW5nIGEgbW9kZXNldCBzdWNoIHRoYXQgaXQgbm8gbG9uZ2VyIGRv
ZXM/ICBJbiB0aGF0IGNhc2UKbmV3X2NydGNfc3RhdGUtPmJpZ2pvaW5lciB3aWxsIGJlIGZhbHNl
IHNvIHdlJ2xsIGVuZCB1cCBpbiB0aGlzIGJyYW5jaC4KQnV0IHRoZW4gd2Ugc2VlbSB0byBiZSB0
cnlpbmcgdG8gZ3JhYiB0aGUgZXgtbWFzdGVyJ3MgbWFzdGVyIHdoaWNoCmRvZXNuJ3QgbWFrZSBz
ZW5zZSBmb3IgdGhpcyBjYXNlIHNpbmNlIHdlIGFjdHVhbGx5IHdhbnQgdG8gZ3JhYiB0aGUKc2xh
dmUgYW5kIGNsZWFyIGl0IG91dC4KClRoZSBjb2RlIGluIHRoaXMgYnJhbmNoIHNlZW1zIHRvIGJl
IHRyeWluZyB0byBvcGVyYXRlIG9uIGEgQ1JUQyB0aGF0IHdhcwpwcmV2aW91c2x5IGEgc2xhdmUs
IGJ1dCBhc3N1bWluZyBhbiBleC1zbGF2ZSBpcyBzdGF5aW5nIGRpc2FibGVkCighbmV3X2NydGNf
c3RhdGUtPnVhcGkuZW5hYmxlKSwgdGhlbiBJIHRoaW5rIHdlIHRvb2sgdGhlICdjb250aW51ZScg
YXQKdGhlIHRvcCBvZiB0aGUgbG9vcCBhbmQgbmV2ZXIgbWFrZSBpdCBkb3duIGhlcmUuCgo+ICsJ
CQltYXN0ZXJfY3J0Y19zdGF0ZSA9IGludGVsX2F0b21pY19nZXRfY3J0Y19zdGF0ZSgmc3RhdGUt
PmJhc2UsIG1hc3Rlcik7Cj4gKwkJCWlmIChJU19FUlIobWFzdGVyX2NydGNfc3RhdGUpKQo+ICsJ
CQkJcmV0dXJuIFBUUl9FUlIobWFzdGVyX2NydGNfc3RhdGUpOwo+ICsKPiArCQkJaWYgKCFtYXN0
ZXJfY3J0Y19zdGF0ZS0+dWFwaS5lbmFibGUgJiYgIW5ld19jcnRjX3N0YXRlLT51YXBpLmVuYWJs
ZSkgewo+ICsJCQkJRFJNX0RFQlVHX0tNUygiW0NSVEM6JWQ6JXNdIERpc2FibGluZyBzbGF2ZSBm
cm9tIGJpZyBqb2luZXJcbiIsCj4gKwkJCQkJICAgICAgY3J0Yy0+YmFzZS5iYXNlLmlkLCBjcnRj
LT5iYXNlLm5hbWUpOwo+ICsJCQkJcmV0ID0gY2xlYXJfaW50ZWxfY3J0Y19zdGF0ZShuZXdfY3J0
Y19zdGF0ZSk7Cj4gKwkJCX0KPiArCQl9Cj4gKwkJaWYgKHJldCkKPiArCQkJcmV0dXJuIHJldDsK
PiArCX0KPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiAgLyoqCj4gICAqIGludGVsX2F0b21p
Y19jaGVjayAtIHZhbGlkYXRlIHN0YXRlIG9iamVjdAo+ICAgKiBAZGV2OiBkcm0gZGV2aWNlCj4g
QEAgLTEzNTgzLDcgKzEzNzU2LDEwIEBAIHN0YXRpYyBpbnQgaW50ZWxfYXRvbWljX2NoZWNrKHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gIAo+ICAJCWlmICghbmV3X2NydGNfc3RhdGUtPnVhcGku
ZW5hYmxlKSB7Cj4gIAkJCWFueV9tcyA9IHRydWU7Cj4gLQkJCWNsZWFyX2ludGVsX2NydGNfc3Rh
dGUobmV3X2NydGNfc3RhdGUpOwo+ICsKPiArCQkJLyogYmlnIGpvaW5lciBzbGF2ZSBpcyBjbGVh
cmVkIGluIGludGVsX2F0b21pY19jaGVja19iaWdqb2luZXIoKSAqLwo+ICsJCQlpZiAoIW5ld19j
cnRjX3N0YXRlLT5iaWdqb2luZXJfc2xhdmUpCj4gKwkJCQljbGVhcl9pbnRlbF9jcnRjX3N0YXRl
KG5ld19jcnRjX3N0YXRlKTsKPiAgCQkJY29udGludWU7Cj4gIAkJfQo+ICAKPiBAQCAtMTM1OTcs
NiArMTM3NzMsMTAgQEAgc3RhdGljIGludCBpbnRlbF9hdG9taWNfY2hlY2soc3RydWN0IGRybV9k
ZXZpY2UgKmRldiwKPiAgCQkJYW55X21zID0gdHJ1ZTsKPiAgCX0KPiAgCj4gKwlyZXQgPSBpbnRl
bF9hdG9taWNfY2hlY2tfYmlnam9pbmVyKHN0YXRlKTsKPiArCWlmIChyZXQpCj4gKwkJcmV0dXJu
IHJldDsKPiArCj4gIAlyZXQgPSBkcm1fZHBfbXN0X2F0b21pY19jaGVjaygmc3RhdGUtPmJhc2Up
Owo+ICAJaWYgKHJldCkKPiAgCQlnb3RvIGZhaWw7Cj4gQEAgLTEzNzQ3LDcgKzEzOTI3LDkgQEAg
c3RhdGljIHZvaWQgaW50ZWxfdXBkYXRlX2NydGMoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4g
IAo+ICAJY29tbWl0X3BpcGVfY29uZmlnKHN0YXRlLCBvbGRfY3J0Y19zdGF0ZSwgbmV3X2NydGNf
c3RhdGUpOwo+ICAKPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gKwlpZiAobmV3
X2NydGNfc3RhdGUtPmJpZ2pvaW5lcikKPiArCQl7LyogTm90IHN1cHBvcnRlZCB5ZXQgKi99Cj4g
KwllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gIAkJc2tsX3VwZGF0ZV9wbGFu
ZXNfb25fY3J0YyhzdGF0ZSwgY3J0Yyk7Cj4gIAllbHNlCj4gIAkJaTl4eF91cGRhdGVfcGxhbmVz
X29uX2NydGMoc3RhdGUsIGNydGMpOwo+IEBAIC0xNjg0Niw3ICsxNzAyOCw2IEBAIHN0YXRpYyB2
b2lkIGludGVsX21vZGVzZXRfcmVhZG91dF9od19zdGF0ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
KQo+ICAJCX0KPiAgCj4gIAkJaW50ZWxfYndfY3J0Y191cGRhdGUoYndfc3RhdGUsIGNydGNfc3Rh
dGUpOwo+IC0KPiAgCQljb3B5X2h3X3RvX3VhcGlfc3RhdGUoY3J0Y19zdGF0ZSk7Cj4gIAkJaW50
ZWxfcGlwZV9jb25maWdfc2FuaXR5X2NoZWNrKGRldl9wcml2LCBjcnRjX3N0YXRlKTsKPiAgCX0K
ClN0cmFwIHdoaXRlc3BhY2UgY2hhbmdlLgoKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaAo+IGluZGV4IDM5NGY4NGU1ZDU4My4uZGQw
MzI5YTRiOWZmIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfZGlzcGxheV90eXBlcy5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kaXNwbGF5X3R5cGVzLmgKPiBAQCAtNzc0LDcgKzc3NCw3IEBAIHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlIHsKPiAgCXN0cnVjdCB7Cj4gIAkJYm9vbCBhY3RpdmUsIGVuYWJsZTsKPiAgCQlz
dHJ1Y3QgZHJtX3Byb3BlcnR5X2Jsb2IgKmRlZ2FtbWFfbHV0LCAqZ2FtbWFfbHV0LCAqY3RtOwo+
IC0JCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlIG1vZGUsIGFkanVzdGVkX21vZGU7Cj4gKwkJc3Ry
dWN0IGRybV9kaXNwbGF5X21vZGUgbW9kZSwgYWRqdXN0ZWRfbW9kZSwgdHJhbnNjb2Rlcl9tb2Rl
Owo+ICAJfSBodzsKPiAgCj4gIAkvKioKPiBAQCAtMTAwNSw2ICsxMDA1LDE1IEBAIHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlIHsKPiAgCS8qIGVuYWJsZSBwaXBlIGNzYz8gKi8KPiAgCWJvb2wgY3Nj
X2VuYWJsZTsKPiAgCj4gKwkvKiBlbmFibGUgcGlwZSBiaWcgam9pbmVyPyAqLwo+ICsJYm9vbCBi
aWdqb2luZXI7Cj4gKwo+ICsJLyogYmlnIGpvaW5lciBzbGF2ZSBjcnRjPyAqLwo+ICsJYm9vbCBi
aWdqb2luZXJfc2xhdmU7Cj4gKwo+ICsJLyogbGlua2VkIGNydGMgZm9yIGJpZ2pvaW5lciwgZWl0
aGVyIHNsYXZlIG9yIG1hc3RlciAqLwo+ICsJc3RydWN0IGludGVsX2NydGMgKmJpZ2pvaW5lcl9s
aW5rZWRfY3J0YzsKPiArCj4gIAkvKiBEaXNwbGF5IFN0cmVhbSBjb21wcmVzc2lvbiBzdGF0ZSAq
Lwo+ICAJc3RydWN0IHsKPiAgCQlib29sIGNvbXByZXNzaW9uX2VuYWJsZTsKPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jCj4gaW5kZXggMDQ2ZTE2NjJkMWUzLi4zZDQ4N2Nl
MTYxNTEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9k
cC5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jCj4gQEAg
LTIxMDUsNiArMjEwNSwxOSBAQCBzdGF0aWMgaW50IGludGVsX2RwX2RzY19jb21wdXRlX2NvbmZp
ZyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ICAJcGlwZV9jb25maWctPnBvcnRfY2xvY2sg
PSBpbnRlbF9kcC0+Y29tbW9uX3JhdGVzW2xpbWl0cy0+bWF4X2Nsb2NrXTsKPiAgCXBpcGVfY29u
ZmlnLT5sYW5lX2NvdW50ID0gbGltaXRzLT5tYXhfbGFuZV9jb3VudDsKPiAgCj4gKwlpZiAoYWRq
dXN0ZWRfbW9kZS0+Y3J0Y19jbG9jayA+IGludGVsX2RwX2Rvd25zdHJlYW1fbWF4X2RvdGNsb2Nr
KGludGVsX2RwLCBmYWxzZSkpIHsKPiArCQlpZiAoYWRqdXN0ZWRfbW9kZS0+Y3J0Y19jbG9jayA+
IGludGVsX2RwX2Rvd25zdHJlYW1fbWF4X2RvdGNsb2NrKGludGVsX2RwLCB0cnVlKSkgewo+ICsJ
CQlEUk1fREVCVUdfS01TKCJDbG9jayByYXRlIHRvbyBoaWdoIGZvciBiaWcgam9pbmVyXG4iKTsK
PiArCQkJcmV0dXJuIC1FSU5WQUw7Cj4gKwkJfQo+ICsJCWlmIChpbnRlbF9kcF9pc19lZHAoaW50
ZWxfZHApKSB7Cj4gKwkJCURSTV9ERUJVR19LTVMoIkNhbm5vdCBzcGxpdCBlRFAgc3RyZWFtIGlu
IGJpZ2pvaW5lciBjb25maWd1cmF0aW9uLlxuIik7Cj4gKwkJCXJldHVybiAtRUlOVkFMOwo+ICsJ
CX0KPiArCQlwaXBlX2NvbmZpZy0+Ymlnam9pbmVyID0gdHJ1ZTsKPiArCQlEUk1fREVCVUdfS01T
KCJVc2luZyBiaWdqb2luZXIgY29uZmlndXJhdGlvblxuIik7Cj4gKwl9Cj4gKwo+ICAJaWYgKGlu
dGVsX2RwX2lzX2VkcChpbnRlbF9kcCkpIHsKPiAgCQlwaXBlX2NvbmZpZy0+ZHNjX3BhcmFtcy5j
b21wcmVzc2VkX2JwcCA9Cj4gIAkJCW1pbl90KHUxNiwgZHJtX2VkcF9kc2Nfc2lua19vdXRwdXRf
YnBwKGludGVsX2RwLT5kc2NfZHBjZCkgPj4gNCwKPiBAQCAtMjEyMiwxMiArMjEzNSwxMiBAQCBz
dGF0aWMgaW50IGludGVsX2RwX2RzY19jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZHAgKmlu
dGVsX2RwLAo+ICAJCQkJCQkgICAgcGlwZV9jb25maWctPmxhbmVfY291bnQsCj4gIAkJCQkJCSAg
ICBhZGp1c3RlZF9tb2RlLT5jcnRjX2Nsb2NrLAo+ICAJCQkJCQkgICAgYWRqdXN0ZWRfbW9kZS0+
Y3J0Y19oZGlzcGxheSwKPiAtCQkJCQkJICAgIGZhbHNlKTsKPiArCQkJCQkJICAgIHBpcGVfY29u
ZmlnLT5iaWdqb2luZXIpOwo+ICAJCWRzY19kcF9zbGljZV9jb3VudCA9Cj4gIAkJCWludGVsX2Rw
X2RzY19nZXRfc2xpY2VfY291bnQoaW50ZWxfZHAsCj4gIAkJCQkJCSAgICAgYWRqdXN0ZWRfbW9k
ZS0+Y3J0Y19jbG9jaywKPiAgCQkJCQkJICAgICBhZGp1c3RlZF9tb2RlLT5jcnRjX2hkaXNwbGF5
LAo+IC0JCQkJCQkgICAgIGZhbHNlKTsKPiArCQkJCQkJICAgICBwaXBlX2NvbmZpZy0+Ymlnam9p
bmVyKTsKPiAgCQlpZiAoIWRzY19tYXhfb3V0cHV0X2JwcCB8fCAhZHNjX2RwX3NsaWNlX2NvdW50
KSB7Cj4gIAkJCURSTV9ERUJVR19LTVMoIkNvbXByZXNzZWQgQlBQL1NsaWNlIENvdW50IG5vdCBz
dXBwb3J0ZWRcbiIpOwo+ICAJCQlyZXR1cm4gLUVJTlZBTDsKPiBAQCAtMjE0MiwxMyArMjE1NSwx
MyBAQCBzdGF0aWMgaW50IGludGVsX2RwX2RzY19jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxf
ZHAgKmludGVsX2RwLAo+ICAJICogaXMgZ3JlYXRlciB0aGFuIHRoZSBtYXhpbXVtIENkY2xvY2sg
YW5kIGlmIHNsaWNlIGNvdW50IGlzIGV2ZW4KPiAgCSAqIHRoZW4gd2UgbmVlZCB0byB1c2UgMiBW
RFNDIGluc3RhbmNlcy4KPiAgCSAqLwo+IC0JaWYgKGFkanVzdGVkX21vZGUtPmNydGNfY2xvY2sg
PiBkZXZfcHJpdi0+bWF4X2NkY2xrX2ZyZXEpIHsKPiAtCQlpZiAocGlwZV9jb25maWctPmRzY19w
YXJhbXMuc2xpY2VfY291bnQgPiAxKSB7Cj4gLQkJCXBpcGVfY29uZmlnLT5kc2NfcGFyYW1zLmRz
Y19zcGxpdCA9IHRydWU7Cj4gLQkJfSBlbHNlIHsKPiArCWlmIChhZGp1c3RlZF9tb2RlLT5jcnRj
X2Nsb2NrID4gZGV2X3ByaXYtPm1heF9jZGNsa19mcmVxIHx8IHBpcGVfY29uZmlnLT5iaWdqb2lu
ZXIpIHsKPiArCQlpZiAocGlwZV9jb25maWctPmRzY19wYXJhbXMuc2xpY2VfY291bnQgPCAyKSB7
Cj4gIAkJCURSTV9ERUJVR19LTVMoIkNhbm5vdCBzcGxpdCBzdHJlYW0gdG8gdXNlIDIgVkRTQyBp
bnN0YW5jZXNcbiIpOwo+ICAJCQlyZXR1cm4gLUVJTlZBTDsKPiAgCQl9Cj4gKwo+ICsJCXBpcGVf
Y29uZmlnLT5kc2NfcGFyYW1zLmRzY19zcGxpdCA9IHRydWU7Cj4gIAl9Cj4gIAo+ICAJcmV0ID0g
aW50ZWxfZHBfY29tcHV0ZV9kc2NfcGFyYW1zKGludGVsX2RwLCBwaXBlX2NvbmZpZyk7Cj4gLS0g
Cj4gMi4yMC4xCj4gCj4gX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KPiBJbnRlbC1nZnggbWFpbGluZyBsaXN0Cj4gSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNr
dG9wLm9yZwo+IGh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8v
aW50ZWwtZ2Z4CgotLSAKTWF0dCBSb3BlcgpHcmFwaGljcyBTb2Z0d2FyZSBFbmdpbmVlcgpWVFQt
T1NHQyBQbGF0Zm9ybSBFbmFibGVtZW50CkludGVsIENvcnBvcmF0aW9uCig5MTYpIDM1Ni0yNzk1
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdm
eCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xp
c3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id AF8C22D978F
	for <lists+intel-gfx@lfdr.de>; Mon, 14 Dec 2020 12:42:31 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 782C96E1BB;
	Mon, 14 Dec 2020 11:42:29 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga17.intel.com (mga17.intel.com [192.55.52.151])
 by gabe.freedesktop.org (Postfix) with ESMTPS id F1A0A6E1B5
 for <intel-gfx@lists.freedesktop.org>; Mon, 14 Dec 2020 11:42:27 +0000 (UTC)
IronPort-SDR: b4ozVXrnRCmUug0+KeiaacLDt37O05V4PNDwsVJ+k6ZLQg+/T8AkWrPb3C/U4/lBz1CzINVqwa
 OlC0jcY4LejA==
X-IronPort-AV: E=McAfee;i="6000,8403,9834"; a="154500477"
X-IronPort-AV: E=Sophos;i="5.78,418,1599548400"; d="scan'208";a="154500477"
Received: from fmsmga003.fm.intel.com ([10.253.24.29])
 by fmsmga107.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 14 Dec 2020 03:42:26 -0800
IronPort-SDR: DLEuwhQec34+Q6y8D0uGYWafVPf057SLl6RlRo0toFWaq15+uSjfe7KHtWj8W73qj4MsFkltF/
 WPS2yaaIJv7g==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.78,418,1599548400"; d="scan'208";a="388421301"
Received: from irsmsx605.ger.corp.intel.com ([163.33.146.138])
 by FMSMGA003.fm.intel.com with ESMTP; 14 Dec 2020 03:42:25 -0800
Received: from irsmsx605.ger.corp.intel.com (163.33.146.138) by
 IRSMSX605.ger.corp.intel.com (163.33.146.138) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id
 15.1.1713.5; Mon, 14 Dec 2020 11:42:24 +0000
Received: from irsmsx605.ger.corp.intel.com ([163.33.146.138]) by
 IRSMSX605.ger.corp.intel.com ([163.33.146.138]) with mapi id 15.01.1713.004;
 Mon, 14 Dec 2020 11:42:24 +0000
From: "Mun, Gwan-gyeong" <gwan-gyeong.mun@intel.com>
To: "Gupta, Anshuman" <anshuman.gupta@intel.com>
Thread-Topic: [PATCH v5 1/2] drm/i915/display: Support PSR Multiple Transcoders
Thread-Index: AQHW0gpswOzzWdg3E02knfyL2FxEoKn2eDIA
Date: Mon, 14 Dec 2020 11:42:24 +0000
Message-ID: <10e20daa36762f3167411491b2dd15d1dd69ed63.camel@intel.com>
References: <20201211171421.4048499-1-gwan-gyeong.mun@intel.com>
 <20201214110200.GF9309@intel.com>
In-Reply-To: <20201214110200.GF9309@intel.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [163.33.253.164]
Content-ID: <13A58653336EF64FB57992D8FF56152C@intel.com>
MIME-Version: 1.0
Subject: Re: [Intel-gfx] [PATCH v5 1/2] drm/i915/display: Support PSR
 Multiple Transcoders
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: "Nikula, Jani" <jani.nikula@intel.com>,
 "intel-gfx@lists.freedesktop.org" <intel-gfx@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T24gTW9uLCAyMDIwLTEyLTE0IGF0IDE2OjMyICswNTMwLCBBbnNodW1hbiBHdXB0YSB3cm90ZToN
Cj4gT24gMjAyMC0xMi0xMSBhdCAxOToxNDoyMCArMDIwMCwgR3dhbi1neWVvbmcgTXVuIHdyb3Rl
Og0KPiA+IEl0IGlzIGEgcHJlbGltaW5hcnkgd29yayBmb3Igc3VwcG9ydGluZyBtdWx0aXBsZSBF
RFAgUFNSIGFuZA0KPiA+IERQIFBhbmVsUmVwbGF5LiBBbmQgaXQgcmVmYWN0b3JzIHNpbmdsZXRv
biBQU1IgdG8gTXVsdGkgVHJhbnNjb2Rlcg0KPiA+IHN1cHBvcnRhYmxlIFBTUi4NCj4gPiBBbmQg
dGhpcyBtb3ZlcyBhbmQgcmVuYW1lcyB0aGUgaTkxNV9wc3Igc3RydWN0dXJlIG9mDQo+ID4gZHJt
X2k5MTVfcHJpdmF0ZSdzIHRvDQo+ID4gaW50ZWxfZHAncyBpbnRlbF9wc3Igc3RydWN0dXJlLg0K
PiA+IEl0IGFsc28gY2F1c2VzIGNoYW5nZXMgaW4gUFNSIGludGVycnVwdCBoYW5kbGluZyByb3V0
aW5lIGZvcg0KPiA+IHN1cHBvcnRpbmcNCj4gPiBtdWx0aXBsZSB0cmFuc2NvZGVycy4gQnV0IGl0
IGRvZXMgbm90IGNoYW5nZSB0aGUgc2NlbmFyaW8gYW5kDQo+ID4gdGltaW5nIG9mDQo+ID4gZW5h
YmxpbmcgYW5kIGRpc2FibGluZyBQU1IuDQo+ID4gDQo+ID4gdjI6IEZpeCBpbmRlbnRhdGlvbiBh
bmQgYWRkIGNvbW1lbnRzDQo+ID4gdjM6IFJlbW92ZSBCbGFuayBsaW5lDQo+ID4gdjQ6IFJlYmFz
ZWQNCj4gPiB2NTogUmViYXNlZCBhbmQgQWRkcmVzc2VkIEFuc2h1bWFuJ3MgcmV2aWV3IGNvbW1l
bnQuDQo+ID4gICAgIC0gTW92ZSBjYWxsaW5nIG9mIGludGVsX3Bzcl9pbml0KCkgdG8gaW50ZWxf
ZHBfaW5pdF9jb25uZWN0b3IoKQ0KPiA+IA0KPiA+IFNpZ25lZC1vZmYtYnk6IEd3YW4tZ3llb25n
IE11biA8Z3dhbi1neWVvbmcubXVuQGludGVsLmNvbT4NCj4gPiBDYzogSm9zw6kgUm9iZXJ0byBk
ZSBTb3V6YSA8am9zZS5zb3V6YUBpbnRlbC5jb20+DQo+ID4gQ2M6IEp1aGEtUGVra2EgSGVpa2tp
bGEgPGp1aGFwZWtrYS5oZWlra2lsYUBnbWFpbC5jb20+DQo+ID4gQ2M6IEFuc2h1bWFuIEd1cHRh
IDxhbnNodW1hbi5ndXB0YUBpbnRlbC5jb20+DQo+ID4gLS0tDQo+ID4gIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpLmMgICAgICB8ICAgMyArDQo+ID4gIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jICB8ICAgNCAtDQo+ID4gIC4uLi9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfZGVidWdmcy5jICB8IDExMSArKy0tDQo+ID4gIC4u
Li9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaCAgICB8ICAzOCArKw0KPiA+
ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwLmMgICAgICAgfCAgMjMgKy0N
Cj4gPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9wc3IuYyAgICAgIHwgNTg1
ICsrKysrKysrKystLQ0KPiA+IC0tLS0tLQ0KPiA+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX3Bzci5oICAgICAgfCAgMTQgKy0NCj4gPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF9zcHJpdGUuYyAgIHwgICA2ICstDQo+ID4gIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZHJ2LmggICAgICAgICAgICAgICB8ICAzOCAtLQ0KPiA+ICBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2lycS5jICAgICAgICAgICAgICAgfCAgNDkgKy0NCj4gPiAgMTAgZmlsZXMg
Y2hhbmdlZCwgNDkxIGluc2VydGlvbnMoKyksIDM4MCBkZWxldGlvbnMoLSkNCj4gPiANCj4gPiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGkuYw0KPiA+
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGkuYw0KPiA+IGluZGV4IDY4
NjMyMzZkZjFkMC4uNGI4N2Y3MmNiOWMwIDEwMDY0NA0KPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpLmMNCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2RkaS5jDQo+ID4gQEAgLTQzMjAsNyArNDMyMCwxMCBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9kZGlfdXBkYXRlX3BpcGVfZHAoc3RydWN0DQo+ID4gaW50ZWxfYXRvbWljX3N0
YXRlICpzdGF0ZSwNCj4gPiAgDQo+ID4gIAlpbnRlbF9kZGlfc2V0X2RwX21zYShjcnRjX3N0YXRl
LCBjb25uX3N0YXRlKTsNCj4gPiAgDQo+ID4gKwkvL1RPRE86IG1vdmUgUFNSIHJlbGF0ZWQgZnVu
Y3Rpb25zIGludG8gaW50ZWxfcHNyX3VwZGF0ZSgpDQo+ID4gKwlpbnRlbF9wc3IyX3Byb2dyYW1f
dHJhbnNfbWFuX3Rya19jdGwoaW50ZWxfZHAsIGNydGNfc3RhdGUpOw0KPiA+ICAJaW50ZWxfcHNy
X3VwZGF0ZShpbnRlbF9kcCwgY3J0Y19zdGF0ZSwgY29ubl9zdGF0ZSk7DQo+ID4gKw0KPiA+ICAJ
aW50ZWxfZHBfc2V0X2luZm9mcmFtZXMoZW5jb2RlciwgdHJ1ZSwgY3J0Y19zdGF0ZSwgY29ubl9z
dGF0ZSk7DQo+ID4gIAlpbnRlbF9lZHBfZHJyc191cGRhdGUoaW50ZWxfZHAsIGNydGNfc3RhdGUp
Ow0KPiA+ICANCj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kaXNwbGF5LmMNCj4gPiBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZGlzcGxheS5jDQo+ID4gaW5kZXggNzYxYmU4ZGVhYTliLi5mMjZkOWJjZDcyMmMgMTAwNjQ0DQo+
ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMNCj4g
PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYw0KPiA+
IEBAIC0xNTg2OSw4ICsxNTg2OSw2IEBAIHN0YXRpYyB2b2lkIGNvbW1pdF9waXBlX2NvbmZpZyhz
dHJ1Y3QNCj4gPiBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLA0KPiA+ICANCj4gPiAgCQlpZiAo
bmV3X2NydGNfc3RhdGUtPnVwZGF0ZV9waXBlKQ0KPiA+ICAJCQlpbnRlbF9waXBlX2Zhc3RzZXQo
b2xkX2NydGNfc3RhdGUsDQo+ID4gbmV3X2NydGNfc3RhdGUpOw0KPiA+IC0NCj4gPiAtCQlpbnRl
bF9wc3IyX3Byb2dyYW1fdHJhbnNfbWFuX3Rya19jdGwobmV3X2NydGNfc3RhdGUpOw0KPiA+ICAJ
fQ0KPiA+ICANCj4gPiAgCWlmIChkZXZfcHJpdi0+ZGlzcGxheS5hdG9taWNfdXBkYXRlX3dhdGVy
bWFya3MpDQo+ID4gQEAgLTE3ODMwLDggKzE3ODI4LDYgQEAgc3RhdGljIHZvaWQgaW50ZWxfc2V0
dXBfb3V0cHV0cyhzdHJ1Y3QNCj4gPiBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikNCj4gPiAg
CQlpbnRlbF9kdm9faW5pdChkZXZfcHJpdik7DQo+ID4gIAl9DQo+ID4gIA0KPiA+IC0JaW50ZWxf
cHNyX2luaXQoZGV2X3ByaXYpOw0KPiA+IC0NCj4gPiAgCWZvcl9lYWNoX2ludGVsX2VuY29kZXIo
JmRldl9wcml2LT5kcm0sIGVuY29kZXIpIHsNCj4gPiAgCQllbmNvZGVyLT5iYXNlLnBvc3NpYmxl
X2NydGNzID0NCj4gPiAgCQkJaW50ZWxfZW5jb2Rlcl9wb3NzaWJsZV9jcnRjcyhlbmNvZGVyKTsN
Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNw
bGF5X2RlYnVnZnMuYw0KPiA+IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9k
aXNwbGF5X2RlYnVnZnMuYw0KPiA+IGluZGV4IGNkN2U1NTE5ZWU3ZC4uMDQxMDUzMTY3ZDdmIDEw
MDY0NA0KPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxh
eV9kZWJ1Z2ZzLmMNCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2Rpc3BsYXlfZGVidWdmcy5jDQo+ID4gQEAgLTI0OSwxOCArMjQ5LDE3IEBAIHN0YXRpYyBpbnQg
aTkxNV9wc3Jfc2lua19zdGF0dXNfc2hvdyhzdHJ1Y3QNCj4gPiBzZXFfZmlsZSAqbSwgdm9pZCAq
ZGF0YSkNCj4gPiAgCQkic2luayBpbnRlcm5hbCBlcnJvciIsDQo+ID4gIAl9Ow0KPiA+ICAJc3Ry
dWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciA9IG0tPnByaXZhdGU7DQo+ID4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsNCj4g
PiAgCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPQ0KPiA+ICAJCWludGVsX2F0dGFjaGVkX2Rw
KHRvX2ludGVsX2Nvbm5lY3Rvcihjb25uZWN0b3IpKTsNCj4gPiAgCWludCByZXQ7DQo+ID4gIA0K
PiA+IC0JaWYgKCFDQU5fUFNSKGRldl9wcml2KSkgew0KPiA+IC0JCXNlcV9wdXRzKG0sICJQU1Ig
VW5zdXBwb3J0ZWRcbiIpOw0KPiA+ICsJaWYgKGNvbm5lY3Rvci0+c3RhdHVzICE9IGNvbm5lY3Rv
cl9zdGF0dXNfY29ubmVjdGVkKQ0KPiA+ICAJCXJldHVybiAtRU5PREVWOw0KPiA+IC0JfQ0KPiA+
ICANCj4gPiAtCWlmIChjb25uZWN0b3ItPnN0YXR1cyAhPSBjb25uZWN0b3Jfc3RhdHVzX2Nvbm5l
Y3RlZCkNCj4gPiArCWlmICghQ0FOX1BTUihpbnRlbF9kcCkpIHsNCj4gPiArCQlzZXFfcHV0cyht
LCAiUFNSIFVuc3VwcG9ydGVkXG4iKTsNCj4gPiAgCQlyZXR1cm4gLUVOT0RFVjsNCj4gPiArCX0N
Cj4gPiAgDQo+ID4gIAlyZXQgPSBkcm1fZHBfZHBjZF9yZWFkYigmaW50ZWxfZHAtPmF1eCwgRFBf
UFNSX1NUQVRVUywgJnZhbCk7DQo+ID4gIA0KPiA+IEBAIC0yODAsMTIgKzI3OSwxMyBAQCBzdGF0
aWMgaW50IGk5MTVfcHNyX3Npbmtfc3RhdHVzX3Nob3coc3RydWN0DQo+ID4gc2VxX2ZpbGUgKm0s
IHZvaWQgKmRhdGEpDQo+ID4gIERFRklORV9TSE9XX0FUVFJJQlVURShpOTE1X3Bzcl9zaW5rX3N0
YXR1cyk7DQo+ID4gIA0KPiA+ICBzdGF0aWMgdm9pZA0KPiA+IC1wc3Jfc291cmNlX3N0YXR1cyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHN0cnVjdA0KPiA+IHNlcV9maWxlICpt
KQ0KPiA+ICtwc3Jfc291cmNlX3N0YXR1cyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLCBzdHJ1
Y3Qgc2VxX2ZpbGUgKm0pDQo+ID4gIHsNCj4gPiAgCXUzMiB2YWwsIHN0YXR1c192YWw7DQo+ID4g
IAljb25zdCBjaGFyICpzdGF0dXMgPSAidW5rbm93biI7DQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsNCj4gPiAgDQo+ID4gLQlp
ZiAoZGV2X3ByaXYtPnBzci5wc3IyX2VuYWJsZWQpIHsNCj4gPiArCWlmIChpbnRlbF9kcC0+cHNy
LnBzcjJfZW5hYmxlZCkgew0KPiA+ICAJCXN0YXRpYyBjb25zdCBjaGFyICogY29uc3QgbGl2ZV9z
dGF0dXNbXSA9IHsNCj4gPiAgCQkJIklETEUiLA0KPiA+ICAJCQkiQ0FQVFVSRSIsDQo+ID4gQEAg
LTMwMCw3ICszMDAsNyBAQCBwc3Jfc291cmNlX3N0YXR1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZQ0KPiA+ICpkZXZfcHJpdiwgc3RydWN0IHNlcV9maWxlICptKQ0KPiA+ICAJCQkiVEdfT04iDQo+
ID4gIAkJfTsNCj4gPiAgCQl2YWwgPSBpbnRlbF9kZV9yZWFkKGRldl9wcml2LA0KPiA+IC0JCQkJ
ICAgIEVEUF9QU1IyX1NUQVRVUyhkZXZfcHJpdi0NCj4gPiA+cHNyLnRyYW5zY29kZXIpKTsNCj4g
PiArCQkJCSAgICBFRFBfUFNSMl9TVEFUVVMoaW50ZWxfZHAtDQo+ID4gPnBzci50cmFuc2NvZGVy
KSk7DQo+ID4gIAkJc3RhdHVzX3ZhbCA9ICh2YWwgJiBFRFBfUFNSMl9TVEFUVVNfU1RBVEVfTUFT
SykgPj4NCj4gPiAgCQkJICAgICAgRURQX1BTUjJfU1RBVFVTX1NUQVRFX1NISUZUOw0KPiA+ICAJ
CWlmIChzdGF0dXNfdmFsIDwgQVJSQVlfU0laRShsaXZlX3N0YXR1cykpDQo+ID4gQEAgLTMxNyw3
ICszMTcsNyBAQCBwc3Jfc291cmNlX3N0YXR1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZQ0KPiA+
ICpkZXZfcHJpdiwgc3RydWN0IHNlcV9maWxlICptKQ0KPiA+ICAJCQkiU1JERU5UX09OIiwNCj4g
PiAgCQl9Ow0KPiA+ICAJCXZhbCA9IGludGVsX2RlX3JlYWQoZGV2X3ByaXYsDQo+ID4gLQkJCQkg
ICAgRURQX1BTUl9TVEFUVVMoZGV2X3ByaXYtDQo+ID4gPnBzci50cmFuc2NvZGVyKSk7DQo+ID4g
KwkJCQkgICAgRURQX1BTUl9TVEFUVVMoaW50ZWxfZHAtDQo+ID4gPnBzci50cmFuc2NvZGVyKSk7
DQo+ID4gIAkJc3RhdHVzX3ZhbCA9ICh2YWwgJiBFRFBfUFNSX1NUQVRVU19TVEFURV9NQVNLKSA+
Pg0KPiA+ICAJCQkgICAgICBFRFBfUFNSX1NUQVRVU19TVEFURV9TSElGVDsNCj4gPiAgCQlpZiAo
c3RhdHVzX3ZhbCA8IEFSUkFZX1NJWkUobGl2ZV9zdGF0dXMpKQ0KPiA+IEBAIC0zMjcsMjEgKzMy
NywxOCBAQCBwc3Jfc291cmNlX3N0YXR1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZQ0KPiA+ICpk
ZXZfcHJpdiwgc3RydWN0IHNlcV9maWxlICptKQ0KPiA+ICAJc2VxX3ByaW50ZihtLCAiU291cmNl
IFBTUiBzdGF0dXM6ICVzIFsweCUwOHhdXG4iLCBzdGF0dXMsIHZhbCk7DQo+ID4gIH0NCj4gPiAg
DQo+ID4gLXN0YXRpYyBpbnQgaTkxNV9lZHBfcHNyX3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0s
IHZvaWQgKmRhdGEpDQo+ID4gK3N0YXRpYyBpbnQgaW50ZWxfcHNyX3N0YXR1cyhzdHJ1Y3Qgc2Vx
X2ZpbGUgKm0sIHN0cnVjdCBpbnRlbF9kcA0KPiA+ICppbnRlbF9kcCkNCj4gPiAgew0KPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZh
dGUpOw0KPiA+IC0Jc3RydWN0IGk5MTVfcHNyICpwc3IgPSAmZGV2X3ByaXYtPnBzcjsNCj4gPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHAp
Ow0KPiA+ICsJc3RydWN0IGludGVsX3BzciAqcHNyID0gJmludGVsX2RwLT5wc3I7DQo+ID4gIAlp
bnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsNCj4gPiAgCWNvbnN0IGNoYXIgKnN0YXR1czsNCj4gPiAg
CWJvb2wgZW5hYmxlZDsNCj4gPiAgCXUzMiB2YWw7DQo+ID4gIA0KPiA+IC0JaWYgKCFIQVNfUFNS
KGRldl9wcml2KSkNCj4gPiAtCQlyZXR1cm4gLUVOT0RFVjsNCj4gPiAtDQo+ID4gIAlzZXFfcHJp
bnRmKG0sICJTaW5rIHN1cHBvcnQ6ICVzIiwgeWVzbm8ocHNyLT5zaW5rX3N1cHBvcnQpKTsNCj4g
PiAtCWlmIChwc3ItPmRwKQ0KPiA+IC0JCXNlcV9wcmludGYobSwgIiBbMHglMDJ4XSIsIHBzci0+
ZHAtPnBzcl9kcGNkWzBdKTsNCj4gPiArCWlmIChwc3ItPnNpbmtfc3VwcG9ydCkNCj4gPiArCQlz
ZXFfcHJpbnRmKG0sICIgWzB4JTAyeF0iLCBpbnRlbF9kcC0+cHNyX2RwY2RbMF0pOw0KPiA+ICAJ
c2VxX3B1dHMobSwgIlxuIik7DQo+ID4gIA0KPiA+ICAJaWYgKCFwc3ItPnNpbmtfc3VwcG9ydCkN
Cj4gPiBAQCAtMzY1LDE2ICszNjIsMTYgQEAgc3RhdGljIGludCBpOTE1X2VkcF9wc3Jfc3RhdHVz
KHN0cnVjdA0KPiA+IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQ0KPiA+ICANCj4gPiAgCWlmIChw
c3ItPnBzcjJfZW5hYmxlZCkgew0KPiA+ICAJCXZhbCA9IGludGVsX2RlX3JlYWQoZGV2X3ByaXYs
DQo+ID4gLQkJCQkgICAgRURQX1BTUjJfQ1RMKGRldl9wcml2LQ0KPiA+ID5wc3IudHJhbnNjb2Rl
cikpOw0KPiA+ICsJCQkJICAgIEVEUF9QU1IyX0NUTChpbnRlbF9kcC0NCj4gPiA+cHNyLnRyYW5z
Y29kZXIpKTsNCj4gPiAgCQllbmFibGVkID0gdmFsICYgRURQX1BTUjJfRU5BQkxFOw0KPiA+ICAJ
fSBlbHNlIHsNCj4gPiAgCQl2YWwgPSBpbnRlbF9kZV9yZWFkKGRldl9wcml2LA0KPiA+IC0JCQkJ
ICAgIEVEUF9QU1JfQ1RMKGRldl9wcml2LQ0KPiA+ID5wc3IudHJhbnNjb2RlcikpOw0KPiA+ICsJ
CQkJICAgIEVEUF9QU1JfQ1RMKGludGVsX2RwLQ0KPiA+ID5wc3IudHJhbnNjb2RlcikpOw0KPiA+
ICAJCWVuYWJsZWQgPSB2YWwgJiBFRFBfUFNSX0VOQUJMRTsNCj4gPiAgCX0NCj4gPiAgCXNlcV9w
cmludGYobSwgIlNvdXJjZSBQU1IgY3RsOiAlcyBbMHglMDh4XVxuIiwNCj4gPiAgCQkgICBlbmFi
bGVkZGlzYWJsZWQoZW5hYmxlZCksIHZhbCk7DQo+ID4gLQlwc3Jfc291cmNlX3N0YXR1cyhkZXZf
cHJpdiwgbSk7DQo+ID4gKwlwc3Jfc291cmNlX3N0YXR1cyhpbnRlbF9kcCwgbSk7DQo+ID4gIAlz
ZXFfcHJpbnRmKG0sICJCdXN5IGZyb250YnVmZmVyIGJpdHM6IDB4JTA4eFxuIiwNCj4gPiAgCQkg
ICBwc3ItPmJ1c3lfZnJvbnRidWZmZXJfYml0cyk7DQo+ID4gIA0KPiA+IEBAIC0zODMsNyArMzgw
LDcgQEAgc3RhdGljIGludCBpOTE1X2VkcF9wc3Jfc3RhdHVzKHN0cnVjdCBzZXFfZmlsZQ0KPiA+
ICptLCB2b2lkICpkYXRhKQ0KPiA+ICAJICovDQo+ID4gIAlpZiAoSVNfSEFTV0VMTChkZXZfcHJp
dikgfHwgSVNfQlJPQURXRUxMKGRldl9wcml2KSkgew0KPiA+ICAJCXZhbCA9IGludGVsX2RlX3Jl
YWQoZGV2X3ByaXYsDQo+ID4gLQkJCQkgICAgRURQX1BTUl9QRVJGX0NOVChkZXZfcHJpdi0NCj4g
PiA+cHNyLnRyYW5zY29kZXIpKTsNCj4gPiArCQkJCSAgICBFRFBfUFNSX1BFUkZfQ05UKGludGVs
X2RwLQ0KPiA+ID5wc3IudHJhbnNjb2RlcikpOw0KPiA+ICAJCXZhbCAmPSBFRFBfUFNSX1BFUkZf
Q05UX01BU0s7DQo+ID4gIAkJc2VxX3ByaW50ZihtLCAiUGVyZm9ybWFuY2UgY291bnRlcjogJXVc
biIsIHZhbCk7DQo+ID4gIAl9DQo+ID4gQEAgLTQwNCw3ICs0MDEsNyBAQCBzdGF0aWMgaW50IGk5
MTVfZWRwX3Bzcl9zdGF0dXMoc3RydWN0IHNlcV9maWxlDQo+ID4gKm0sIHZvaWQgKmRhdGEpDQo+
ID4gIAkJICovDQo+ID4gIAkJZm9yIChmcmFtZSA9IDA7IGZyYW1lIDwgUFNSMl9TVV9TVEFUVVNf
RlJBTUVTOyBmcmFtZSArPQ0KPiA+IDMpIHsNCj4gPiAgCQkJdmFsID0gaW50ZWxfZGVfcmVhZChk
ZXZfcHJpdiwNCj4gPiAtCQkJCQkgICAgUFNSMl9TVV9TVEFUVVMoZGV2X3ByaXYtDQo+ID4gPnBz
ci50cmFuc2NvZGVyLCBmcmFtZSkpOw0KPiA+ICsJCQkJCSAgICBQU1IyX1NVX1NUQVRVUyhpbnRl
bF9kcC0NCj4gPiA+cHNyLnRyYW5zY29kZXIsIGZyYW1lKSk7DQo+ID4gIAkJCXN1X2ZyYW1lc192
YWxbZnJhbWUgLyAzXSA9IHZhbDsNCj4gPiAgCQl9DQo+ID4gIA0KPiA+IEBAIC00MzAsMjMgKzQy
Nyw1NyBAQCBzdGF0aWMgaW50IGk5MTVfZWRwX3Bzcl9zdGF0dXMoc3RydWN0DQo+ID4gc2VxX2Zp
bGUgKm0sIHZvaWQgKmRhdGEpDQo+ID4gIAlyZXR1cm4gMDsNCj4gPiAgfQ0KPiA+ICANCj4gPiAr
c3RhdGljIGludCBpOTE1X2VkcF9wc3Jfc3RhdHVzKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAq
ZGF0YSkNCj4gPiArew0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
bm9kZV90b19pOTE1KG0tPnByaXZhdGUpOw0KPiA+ICsJc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXI7DQo+ID4gKwlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gTlVMTDsNCj4gPiArDQo+
ID4gKwlpZiAoIUhBU19QU1IoZGV2X3ByaXYpKQ0KPiA+ICsJCXJldHVybiAtRU5PREVWOw0KPiA+
ICsNCj4gPiArCS8qIEZpbmQgdGhlIGZpcnN0IEVEUCAqLw0KPiA+ICsJZm9yX2VhY2hfaW50ZWxf
ZHAoJmRldl9wcml2LT5kcm0sIGVuY29kZXIpIHsNCj4gPiArCQlpZiAoZW5jb2Rlci0+dHlwZSA9
PSBJTlRFTF9PVVRQVVRfRURQKSB7DQo+IEhvdyBhYm91dCBoYXZpbmcgYSBuZXcgbWFjcm8gZm9y
X2VhY2hfaW50ZWxfcHNyX2VkcCB7fSB0byByZWR1Y2UgdGhlDQo+IGNvZGU/DQo+IE11bHRpcGxl
IHRpbWVzIHRoaXMgaGFzIGJlZW4gdXNlZCBpbiB0aGlzIHBhdGNoIHRvIGxvb3AgZm9yIGludGVs
X2RwLg0KPiA+ICsJCQlpbnRlbF9kcCA9IGVuY190b19pbnRlbF9kcChlbmNvZGVyKTsNCj4gPiAr
CQkJYnJlYWs7DQo+ID4gKwkJfQ0KPiA+ICsJfQ0KPiA+ICsNCj4gPiArCWlmICghaW50ZWxfZHAp
DQo+ID4gKwkJcmV0dXJuIC1FTk9ERVY7DQo+ID4gKw0KPiA+ICsJcmV0dXJuIGludGVsX3Bzcl9z
dGF0dXMobSwgaW50ZWxfZHApOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICBzdGF0aWMgaW50DQo+ID4g
IGk5MTVfZWRwX3Bzcl9kZWJ1Z19zZXQodm9pZCAqZGF0YSwgdTY0IHZhbCkNCj4gPiAgew0KPiA+
ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZGF0YTsNCj4gPiAgCWludGVs
X3dha2VyZWZfdCB3YWtlcmVmOw0KPiA+IC0JaW50IHJldDsNCj4gPiArCWludCByZXQgPSAtRU5P
REVWOw0KPiA+ICsJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXI7DQo+ID4gIA0KPiA+IC0J
aWYgKCFDQU5fUFNSKGRldl9wcml2KSkNCj4gPiAtCQlyZXR1cm4gLUVOT0RFVjsNCj4gPiArCWlm
ICghSEFTX1BTUihkZXZfcHJpdikpDQo+ID4gKwkJcmV0dXJuIHJldDsNCj4gPiAgDQo+ID4gLQlk
cm1fZGJnX2ttcygmZGV2X3ByaXYtPmRybSwgIlNldHRpbmcgUFNSIGRlYnVnIHRvICVsbHhcbiIs
DQo+ID4gdmFsKTsNCj4gPiArCWZvcl9lYWNoX2ludGVsX2RwKCZkZXZfcHJpdi0+ZHJtLCBlbmNv
ZGVyKSB7DQo+ID4gKwkJc3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9IGVuY190b19pbnRlbF9k
cChlbmNvZGVyKTsNCj4gPiAgDQo+ID4gLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQo
JmRldl9wcml2LT5ydW50aW1lX3BtKTsNCj4gPiArCQlpZiAoIUNBTl9QU1IoaW50ZWxfZHApKQ0K
PiA+ICsJCQljb250aW51ZTsNCj4gPiAgDQo+ID4gLQlyZXQgPSBpbnRlbF9wc3JfZGVidWdfc2V0
KGRldl9wcml2LCB2YWwpOw0KPiA+ICsJCWlmIChlbmNvZGVyLT50eXBlID09IElOVEVMX09VVFBV
VF9FRFApIHsNCj4gPiArCQkJZHJtX2RiZ19rbXMoJmRldl9wcml2LT5kcm0sICJTZXR0aW5nIFBT
UiBkZWJ1Zw0KPiA+IHRvICVsbHhcbiIsIHZhbCk7DQo+ID4gIA0KPiA+IC0JaW50ZWxfcnVudGlt
ZV9wbV9wdXQoJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsNCj4gPiArCQkJd2FrZXJl
ZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0NCj4gPiA+cnVudGltZV9wbSk7DQo+
ID4gKw0KPiA+ICsJCQkvLyBUT0RPOiBzcGxpdCB0byBlYWNoIHRyYW5zY29kZXIncyBQU1IgZGVi
dWcNCj4gPiBzdGF0ZQ0KPiA+ICsJCQlyZXQgPSBpbnRlbF9wc3JfZGVidWdfc2V0KGludGVsX2Rw
LCB2YWwpOw0KPiA+ICsNCj4gPiArCQkJaW50ZWxfcnVudGltZV9wbV9wdXQoJmRldl9wcml2LT5y
dW50aW1lX3BtLA0KPiA+IHdha2VyZWYpOw0KPiA+ICsJCX0NCj4gPiArCX0NCj4gPiAgDQo+ID4g
IAlyZXR1cm4gcmV0Ow0KPiA+ICB9DQo+ID4gQEAgLTQ1NSwxMiArNDg2LDI1IEBAIHN0YXRpYyBp
bnQNCj4gPiAgaTkxNV9lZHBfcHNyX2RlYnVnX2dldCh2b2lkICpkYXRhLCB1NjQgKnZhbCkNCj4g
PiAgew0KPiA+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZGF0YTsNCj4g
PiArCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyOw0KPiA+ICANCj4gPiAtCWlmICghQ0FO
X1BTUihkZXZfcHJpdikpDQo+ID4gKwlpZiAoIUhBU19QU1IoZGV2X3ByaXYpKQ0KPiA+ICAJCXJl
dHVybiAtRU5PREVWOw0KPiA+ICANCj4gPiAtCSp2YWwgPSBSRUFEX09OQ0UoZGV2X3ByaXYtPnBz
ci5kZWJ1Zyk7DQo+ID4gLQlyZXR1cm4gMDsNCj4gPiArCWZvcl9lYWNoX2ludGVsX2RwKCZkZXZf
cHJpdi0+ZHJtLCBlbmNvZGVyKSB7DQo+ID4gKwkJc3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9
IGVuY190b19pbnRlbF9kcChlbmNvZGVyKTsNCj4gPiArDQo+ID4gKwkJaWYgKCFDQU5fUFNSKGlu
dGVsX2RwKSkNCj4gPiArCQkJY29udGludWU7DQo+ID4gKw0KPiA+ICsJCS8vIFRPRE86IHNwbGl0
IHRvIGVhY2ggdHJhbnNjb2RlcidzIFBTUiBkZWJ1ZyBzdGF0ZQ0KPiA+ICsJCWlmIChlbmNvZGVy
LT50eXBlID09IElOVEVMX09VVFBVVF9FRFApIHsNCj4gPiArCQkJKnZhbCA9IFJFQURfT05DRShp
bnRlbF9kcC0+cHNyLmRlYnVnKTsNCj4gPiArCQkJcmV0dXJuIDA7DQo+ID4gKwkJfQ0KPiA+ICsJ
fQ0KPiA+ICsNCj4gPiArCXJldHVybiAtRU5PREVWOw0KPiA+ICB9DQo+ID4gIA0KPiA+ICBERUZJ
TkVfU0lNUExFX0FUVFJJQlVURShpOTE1X2VkcF9wc3JfZGVidWdfZm9wcywNCj4gPiBAQCAtMTIz
NCw5ICsxMjc4LDYgQEAgc3RhdGljIHZvaWQgZHJyc19zdGF0dXNfcGVyX2NydGMoc3RydWN0DQo+
ID4gc2VxX2ZpbGUgKm0sDQo+ID4gIAkJLyogZGlzYWJsZV9kcnJzKCkgd2lsbCBtYWtlIGRycnMt
PmRwIE5VTEwgKi8NCj4gPiAgCQlpZiAoIWRycnMtPmRwKSB7DQo+ID4gIAkJCXNlcV9wdXRzKG0s
ICJJZGxlbmVzcyBEUlJTOiBEaXNhYmxlZFxuIik7DQo+ID4gLQkJCWlmIChkZXZfcHJpdi0+cHNy
LmVuYWJsZWQpDQo+ID4gLQkJCQlzZXFfcHV0cyhtLA0KPiA+IC0JCQkJIlx0QXMgUFNSIGlzIGVu
YWJsZWQsIERSUlMgaXMgbm90DQo+ID4gZW5hYmxlZFxuIik7DQo+IERvbid0IHdlIG5lZWQgdGhp
cyBkZWJ1Z2ZzIHByaW50IGFueW1vcmUgPw0KPiA+ICAJCQltdXRleF91bmxvY2soJmRycnMtPm11
dGV4KTsNCj4gPiAgCQkJcmV0dXJuOw0KPiA+ICAJCX0NCj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgNCj4gPiBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oDQo+ID4gaW5kZXgg
NWJjNWJmYmM0NTUxLi45ODk5ZmRkZjRjOTkgMTAwNjQ0DQo+ID4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgNCj4gPiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaA0KPiA+IEBAIC0xMzM5
LDYgKzEzMzksNDIgQEAgc3RydWN0IGludGVsX2RwX2NvbXBsaWFuY2Ugew0KPiA+ICAJdTggdGVz
dF9sYW5lX2NvdW50Ow0KPiA+ICB9Ow0KPiA+ICANCj4gPiArc3RydWN0IGludGVsX3BzciB7DQo+
ID4gKwkvKiBNdXRleCBmb3IgUFNSIHN0YXRlIG9mIHRoZSB0cmFuc2NvZGVyICovDQo+ID4gKwlz
dHJ1Y3QgbXV0ZXggbG9jazsNCj4gPiArDQo+ID4gKyNkZWZpbmUgSTkxNV9QU1JfREVCVUdfTU9E
RV9NQVNLCTB4MGYNCj4gPiArI2RlZmluZSBJOTE1X1BTUl9ERUJVR19ERUZBVUxUCQkweDAwDQo+
ID4gKyNkZWZpbmUgSTkxNV9QU1JfREVCVUdfRElTQUJMRQkJMHgwMQ0KPiA+ICsjZGVmaW5lIEk5
MTVfUFNSX0RFQlVHX0VOQUJMRQkJMHgwMg0KPiA+ICsjZGVmaW5lIEk5MTVfUFNSX0RFQlVHX0ZP
UkNFX1BTUjEJMHgwMw0KPiA+ICsjZGVmaW5lIEk5MTVfUFNSX0RFQlVHX0lSUQkJMHgxMA0KPiA+
ICsNCj4gPiArCXUzMiBkZWJ1ZzsNCj4gPiArCWJvb2wgc2lua19zdXBwb3J0Ow0KPiA+ICsJYm9v
bCBlbmFibGVkOw0KPiA+ICsJZW51bSBwaXBlIHBpcGU7DQo+ID4gKwllbnVtIHRyYW5zY29kZXIg
dHJhbnNjb2RlcjsNCj4gPiArCWJvb2wgYWN0aXZlOw0KPiA+ICsJc3RydWN0IHdvcmtfc3RydWN0
IHdvcms7DQo+ID4gKwl1bnNpZ25lZCBpbnQgYnVzeV9mcm9udGJ1ZmZlcl9iaXRzOw0KPiA+ICsJ
Ym9vbCBzaW5rX3BzcjJfc3VwcG9ydDsNCj4gPiArCWJvb2wgbGlua19zdGFuZGJ5Ow0KPiA+ICsJ
Ym9vbCBjb2xvcmltZXRyeV9zdXBwb3J0Ow0KPiA+ICsJYm9vbCBwc3IyX2VuYWJsZWQ7DQo+ID4g
Kwlib29sIHBzcjJfc2VsX2ZldGNoX2VuYWJsZWQ7DQo+ID4gKwl1OCBzaW5rX3N5bmNfbGF0ZW5j
eTsNCj4gPiArCWt0aW1lX3QgbGFzdF9lbnRyeV9hdHRlbXB0Ow0KPiA+ICsJa3RpbWVfdCBsYXN0
X2V4aXQ7DQo+ID4gKwlib29sIHNpbmtfbm90X3JlbGlhYmxlOw0KPiA+ICsJYm9vbCBpcnFfYXV4
X2Vycm9yOw0KPiA+ICsJdTE2IHN1X3hfZ3JhbnVsYXJpdHk7DQo+ID4gKwlib29sIGRjM2NvX2Vu
YWJsZWQ7DQo+ID4gKwl1MzIgZGMzY29fZXhpdF9kZWxheTsNCj4gPiArCXN0cnVjdCBkZWxheWVk
X3dvcmsgZGMzY29fd29yazsNCj4gPiArCXN0cnVjdCBkcm1fZHBfdnNjX3NkcCB2c2M7DQo+ID4g
K307DQo+ID4gKw0KPiA+ICBzdHJ1Y3QgaW50ZWxfZHAgew0KPiA+ICAJaTkxNV9yZWdfdCBvdXRw
dXRfcmVnOw0KPiA+ICAJdTMyIERQOw0KPiA+IEBAIC0xNDYwLDYgKzE0OTYsOCBAQCBzdHJ1Y3Qg
aW50ZWxfZHAgew0KPiA+ICANCj4gPiAgCWJvb2wgaG9ibF9mYWlsZWQ7DQo+ID4gIAlib29sIGhv
YmxfYWN0aXZlOw0KPiA+ICsNCj4gPiArCXN0cnVjdCBpbnRlbF9wc3IgcHNyOw0KPiA+ICB9Ow0K
PiA+ICANCj4gPiAgZW51bSBsc3Bjb25fdmVuZG9yIHsNCj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jDQo+ID4gYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2RwLmMNCj4gPiBpbmRleCBiMmJjMGM4YzM5YzcuLjU3MzBjYWQ3
YjZhYyAxMDA2NDQNCj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2RwLmMNCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwLmMN
Cj4gPiBAQCAtMjcwMiwxMiArMjcwMiwxMCBAQCB2b2lkIGludGVsX2RwX2NvbXB1dGVfcHNyX3Zz
Y19zZHAoc3RydWN0DQo+ID4gaW50ZWxfZHAgKmludGVsX2RwLA0KPiA+ICAJCQkJICBjb25zdCBz
dHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZQ0KPiA+ICpjb25uX3N0YXRlLA0KPiA+ICAJCQkJICBz
dHJ1Y3QgZHJtX2RwX3ZzY19zZHAgKnZzYykNCj4gPiAgew0KPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7DQo+ID4gLQ0KPiA+ICAJ
dnNjLT5zZHBfdHlwZSA9IERQX1NEUF9WU0M7DQo+ID4gIA0KPiA+IC0JaWYgKGRldl9wcml2LT5w
c3IucHNyMl9lbmFibGVkKSB7DQo+ID4gLQkJaWYgKGRldl9wcml2LT5wc3IuY29sb3JpbWV0cnlf
c3VwcG9ydCAmJg0KPiA+ICsJaWYgKGludGVsX2RwLT5wc3IucHNyMl9lbmFibGVkKSB7DQo+ID4g
KwkJaWYgKGludGVsX2RwLT5wc3IuY29sb3JpbWV0cnlfc3VwcG9ydCAmJg0KPiA+ICAJCSAgICBp
bnRlbF9kcF9uZWVkc192c2Nfc2RwKGNydGNfc3RhdGUsIGNvbm5fc3RhdGUpKSB7DQo+ID4gIAkJ
CS8qIFtQU1IyLCArQ29sb3JpbWV0cnldICovDQo+ID4gIAkJCWludGVsX2RwX2NvbXB1dGVfdnNj
X2NvbG9yaW1ldHJ5KGNydGNfc3RhdGUsDQo+ID4gY29ubl9zdGF0ZSwNCj4gPiBAQCAtMzg0NCw3
ICszODQyLDcgQEAgYm9vbCBpbnRlbF9kcF9pbml0aWFsX2Zhc3RzZXRfY2hlY2soc3RydWN0DQo+
ID4gaW50ZWxfZW5jb2RlciAqZW5jb2RlciwNCj4gPiAgCQlyZXR1cm4gZmFsc2U7DQo+ID4gIAl9
DQo+ID4gIA0KPiA+IC0JaWYgKENBTl9QU1IoaTkxNSkgJiYgaW50ZWxfZHBfaXNfZWRwKGludGVs
X2RwKSkgew0KPiA+ICsJaWYgKENBTl9QU1IoaW50ZWxfZHApICYmIGludGVsX2RwX2lzX2VkcChp
bnRlbF9kcCkpIHsNCj4gPiAgCQlkcm1fZGJnX2ttcygmaTkxNS0+ZHJtLCAiRm9yY2luZyBmdWxs
IG1vZGVzZXQgdG8NCj4gPiBjb21wdXRlIFBTUiBzdGF0ZVxuIik7DQo+ID4gIAkJY3J0Y19zdGF0
ZS0+dWFwaS5tb2RlX2NoYW5nZWQgPSB0cnVlOw0KPiA+ICAJCXJldHVybiBmYWxzZTsNCj4gPiBA
QCAtODA3MCw2ICs4MDY4LDE3IEBAIHN0YXRpYyB2b2lkDQo+ID4gaW50ZWxfZHBfbW9kZXNldF9y
ZXRyeV93b3JrX2ZuKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykNCj4gPiAgCWRybV9rbXNfaGVs
cGVyX2hvdHBsdWdfZXZlbnQoY29ubmVjdG9yLT5kZXYpOw0KPiA+ICB9DQo+ID4gIA0KPiA+ICtz
dGF0aWMgdm9pZCBpbnRlbF9kcF91cGRhdGVfcGlwZShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRl
ICpzdGF0ZSwNCj4gPiArCQkJCSBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwNCj4gPiAr
CQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZQ0KPiA+ICpjcnRjX3N0YXRlLA0KPiA+
ICsJCQkJIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlDQo+ID4gKmNvbm5fc3RhdGUp
DQo+ID4gK3sNCj4gPiArCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSBlbmNfdG9faW50ZWxf
ZHAoZW5jb2Rlcik7DQo+ID4gKw0KPiA+ICsJaW50ZWxfcGFuZWxfdXBkYXRlX2JhY2tsaWdodChz
dGF0ZSwgZW5jb2RlciwgY3J0Y19zdGF0ZSwNCj4gPiBjb25uX3N0YXRlKTsNCj4gPiArCWludGVs
X3BzcjJfcHJvZ3JhbV90cmFuc19tYW5fdHJrX2N0bChpbnRlbF9kcCwgY3J0Y19zdGF0ZSk7DQo+
ID4gK30NCj4gPiArDQo+ID4gIGJvb2wNCj4gPiAgaW50ZWxfZHBfaW5pdF9jb25uZWN0b3Ioc3Ry
dWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQsDQo+ID4gIAkJCXN0cnVjdCBpbnRlbF9j
b25uZWN0b3IgKmludGVsX2Nvbm5lY3RvcikNCj4gPiBAQCAtODE4NCw2ICs4MTkzLDggQEAgaW50
ZWxfZHBfaW5pdF9jb25uZWN0b3Ioc3RydWN0DQo+ID4gaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdf
cG9ydCwNCj4gPiAgCQkJICAgICAgICh0ZW1wICYgfjB4ZikgfCAweGQpOw0KPiA+ICAJfQ0KPiA+
ICANCj4gPiArCWludGVsX3Bzcl9pbml0KGludGVsX2RwKTsNCj4gPiArDQo+ID4gIAlyZXR1cm4g
dHJ1ZTsNCj4gPiAgDQo+ID4gIGZhaWw6DQo+ID4gQEAgLTgyMjUsNyArODIzNiw3IEBAIGJvb2wg
aW50ZWxfZHBfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZQ0KPiA+ICpkZXZfcHJpdiwNCj4g
PiAgCWludGVsX2VuY29kZXItPmdldF9jb25maWcgPSBpbnRlbF9kcF9nZXRfY29uZmlnOw0KPiA+
ICAJaW50ZWxfZW5jb2Rlci0+c3luY19zdGF0ZSA9IGludGVsX2RwX3N5bmNfc3RhdGU7DQo+ID4g
IAlpbnRlbF9lbmNvZGVyLT5pbml0aWFsX2Zhc3RzZXRfY2hlY2sgPQ0KPiA+IGludGVsX2RwX2lu
aXRpYWxfZmFzdHNldF9jaGVjazsNCj4gPiAtCWludGVsX2VuY29kZXItPnVwZGF0ZV9waXBlID0g
aW50ZWxfcGFuZWxfdXBkYXRlX2JhY2tsaWdodDsNCj4gPiArCWludGVsX2VuY29kZXItPnVwZGF0
ZV9waXBlID0gaW50ZWxfZHBfdXBkYXRlX3BpcGU7DQo+ID4gIAlpbnRlbF9lbmNvZGVyLT5zdXNw
ZW5kID0gaW50ZWxfZHBfZW5jb2Rlcl9zdXNwZW5kOw0KPiA+ICAJaW50ZWxfZW5jb2Rlci0+c2h1
dGRvd24gPSBpbnRlbF9kcF9lbmNvZGVyX3NodXRkb3duOw0KPiA+ICAJaWYgKElTX0NIRVJSWVZJ
RVcoZGV2X3ByaXYpKSB7DQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfcHNyLmMNCj4gPiBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfcHNyLmMNCj4gPiBpbmRleCBkOWEzOTVjNDg2ZDMuLmJlMmIxMjMwNTBjOSAxMDA2NDQNCj4g
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Bzci5jDQo+ID4gKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9wc3IuYw0KPiA+IEBAIC03OSwx
MSArNzksMTMgQEANCj4gPiAgICogdXNlIHBhZ2UgZmxpcHMuDQo+ID4gICAqLw0KPiA+ICANCj4g
PiAtc3RhdGljIGJvb2wgcHNyX2dsb2JhbF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQ0KPiA+ICtzdGF0aWMgYm9vbCBwc3JfZ2xvYmFsX2VuYWJsZWQoc3RydWN0IGludGVs
X2RwICppbnRlbF9kcCkNCj4gPiAgew0KPiA+IC0Jc3dpdGNoIChpOTE1LT5wc3IuZGVidWcgJiBJ
OTE1X1BTUl9ERUJVR19NT0RFX01BU0spIHsNCj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOw0KPiA+ICsNCj4gPiArCXN3aXRjaCAo
aW50ZWxfZHAtPnBzci5kZWJ1ZyAmIEk5MTVfUFNSX0RFQlVHX01PREVfTUFTSykgew0KPiA+ICAJ
Y2FzZSBJOTE1X1BTUl9ERUJVR19ERUZBVUxUOg0KPiA+IC0JCXJldHVybiBpOTE1LT5wYXJhbXMu
ZW5hYmxlX3BzcjsNCj4gPiArCQlyZXR1cm4gZGV2X3ByaXYtPnBhcmFtcy5lbmFibGVfcHNyOw0K
PiA+ICAJY2FzZSBJOTE1X1BTUl9ERUJVR19ESVNBQkxFOg0KPiA+ICAJCXJldHVybiBmYWxzZTsN
Cj4gPiAgCWRlZmF1bHQ6DQo+ID4gQEAgLTkxLDkgKzkzLDkgQEAgc3RhdGljIGJvb2wgcHNyX2ds
b2JhbF9lbmFibGVkKHN0cnVjdA0KPiA+IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpDQo+ID4gIAl9
DQo+ID4gIH0NCj4gPiAgDQo+ID4gLXN0YXRpYyBib29sIHBzcjJfZ2xvYmFsX2VuYWJsZWQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQ0KPiA+ICtzdGF0aWMgYm9vbCBwc3IyX2ds
b2JhbF9lbmFibGVkKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApDQo+ID4gIHsNCj4gPiAtCXN3
aXRjaCAoZGV2X3ByaXYtPnBzci5kZWJ1ZyAmIEk5MTVfUFNSX0RFQlVHX01PREVfTUFTSykgew0K
PiA+ICsJc3dpdGNoIChpbnRlbF9kcC0+cHNyLmRlYnVnICYgSTkxNV9QU1JfREVCVUdfTU9ERV9N
QVNLKSB7DQo+ID4gIAljYXNlIEk5MTVfUFNSX0RFQlVHX0RJU0FCTEU6DQo+ID4gIAljYXNlIEk5
MTVfUFNSX0RFQlVHX0ZPUkNFX1BTUjE6DQo+ID4gIAkJcmV0dXJuIGZhbHNlOw0KPiA+IEBAIC0x
MDIsMTEgKzEwNCwxMiBAQCBzdGF0aWMgYm9vbCBwc3IyX2dsb2JhbF9lbmFibGVkKHN0cnVjdA0K
PiA+IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQ0KPiA+ICAJfQ0KPiA+ICB9DQo+ID4gIA0K
PiA+IC1zdGF0aWMgdm9pZCBwc3JfaXJxX2NvbnRyb2woc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQ0KPiA+ICtzdGF0aWMgdm9pZCBwc3JfaXJxX2NvbnRyb2woc3RydWN0IGludGVs
X2RwICppbnRlbF9kcCkNCj4gPiAgew0KPiA+ICAJZW51bSB0cmFuc2NvZGVyIHRyYW5zX3NoaWZ0
Ow0KPiA+ICAJdTMyIG1hc2ssIHZhbDsNCj4gPiAgCWk5MTVfcmVnX3QgaW1yX3JlZzsNCj4gPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHAp
Ow0KPiA+ICANCj4gPiAgCS8qDQo+ID4gIAkgKiBnZW4xMisgaGFzIHJlZ2lzdGVycyByZWxhdGl2
ZSB0byB0cmFuc2NvZGVyIGFuZCBvbmUgcGVyDQo+ID4gdHJhbnNjb2Rlcg0KPiA+IEBAIC0xMTUs
MTQgKzExOCwxNCBAQCBzdGF0aWMgdm9pZCBwc3JfaXJxX2NvbnRyb2woc3RydWN0DQo+ID4gZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpDQo+ID4gIAkgKi8NCj4gPiAgCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDEyKSB7DQo+ID4gIAkJdHJhbnNfc2hpZnQgPSAwOw0KPiA+IC0JCWltcl9y
ZWcgPSBUUkFOU19QU1JfSU1SKGRldl9wcml2LT5wc3IudHJhbnNjb2Rlcik7DQo+ID4gKwkJaW1y
X3JlZyA9IFRSQU5TX1BTUl9JTVIoaW50ZWxfZHAtPnBzci50cmFuc2NvZGVyKTsNCj4gPiAgCX0g
ZWxzZSB7DQo+ID4gLQkJdHJhbnNfc2hpZnQgPSBkZXZfcHJpdi0+cHNyLnRyYW5zY29kZXI7DQo+
ID4gKwkJdHJhbnNfc2hpZnQgPSBpbnRlbF9kcC0+cHNyLnRyYW5zY29kZXI7DQo+ID4gIAkJaW1y
X3JlZyA9IEVEUF9QU1JfSU1SOw0KPiA+ICAJfQ0KPiA+ICANCj4gPiAgCW1hc2sgPSBFRFBfUFNS
X0VSUk9SKHRyYW5zX3NoaWZ0KTsNCj4gPiAtCWlmIChkZXZfcHJpdi0+cHNyLmRlYnVnICYgSTkx
NV9QU1JfREVCVUdfSVJRKQ0KPiA+ICsJaWYgKGludGVsX2RwLT5wc3IuZGVidWcgJiBJOTE1X1BT
Ul9ERUJVR19JUlEpDQo+ID4gIAkJbWFzayB8PSBFRFBfUFNSX1BPU1RfRVhJVCh0cmFuc19zaGlm
dCkgfA0KPiA+ICAJCQlFRFBfUFNSX1BSRV9FTlRSWSh0cmFuc19zaGlmdCk7DQo+ID4gIA0KPiA+
IEBAIC0xNzEsMzggKzE3NCwzNyBAQCBzdGF0aWMgdm9pZCBwc3JfZXZlbnRfcHJpbnQoc3RydWN0
DQo+ID4gZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwNCj4gPiAgCQlkcm1fZGJnX2ttcygmaTkxNS0+
ZHJtLCAiXHRQU1IgZGlzYWJsZWRcbiIpOw0KPiA+ICB9DQo+ID4gIA0KPiA+IC12b2lkIGludGVs
X3Bzcl9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMg0K
PiA+IHBzcl9paXIpDQo+ID4gK3ZvaWQgaW50ZWxfcHNyX2lycV9oYW5kbGVyKHN0cnVjdCBpbnRl
bF9kcCAqaW50ZWxfZHAsIHUzMiBwc3JfaWlyKQ0KPiA+ICB7DQo+ID4gLQllbnVtIHRyYW5zY29k
ZXIgY3B1X3RyYW5zY29kZXIgPSBkZXZfcHJpdi0+cHNyLnRyYW5zY29kZXI7DQo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsNCj4g
PiArCWVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNjb2RlciA9IGludGVsX2RwLT5wc3IudHJhbnNj
b2RlcjsNCj4gPiAgCWVudW0gdHJhbnNjb2RlciB0cmFuc19zaGlmdDsNCj4gPiAgCWk5MTVfcmVn
X3QgaW1yX3JlZzsNCj4gPiAgCWt0aW1lX3QgdGltZV9ucyA9ICBrdGltZV9nZXQoKTsNCj4gPiAg
DQo+ID4gIAlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMikgew0KPiA+ICAJCXRyYW5zX3No
aWZ0ID0gMDsNCj4gPiAtCQlpbXJfcmVnID0gVFJBTlNfUFNSX0lNUihkZXZfcHJpdi0+cHNyLnRy
YW5zY29kZXIpOw0KPiA+ICsJCWltcl9yZWcgPSBUUkFOU19QU1JfSU1SKGludGVsX2RwLT5wc3Iu
dHJhbnNjb2Rlcik7DQo+ID4gIAl9IGVsc2Ugew0KPiA+IC0JCXRyYW5zX3NoaWZ0ID0gZGV2X3By
aXYtPnBzci50cmFuc2NvZGVyOw0KPiA+ICsJCXRyYW5zX3NoaWZ0ID0gaW50ZWxfZHAtPnBzci50
cmFuc2NvZGVyOw0KPiA+ICAJCWltcl9yZWcgPSBFRFBfUFNSX0lNUjsNCj4gPiAgCX0NCj4gPiAg
DQo+ID4gIAlpZiAocHNyX2lpciAmIEVEUF9QU1JfUFJFX0VOVFJZKHRyYW5zX3NoaWZ0KSkgew0K
PiA+IC0JCWRldl9wcml2LT5wc3IubGFzdF9lbnRyeV9hdHRlbXB0ID0gdGltZV9uczsNCj4gPiAt
CQlkcm1fZGJnX2ttcygmZGV2X3ByaXYtPmRybSwNCj4gPiAtCQkJICAgICJbdHJhbnNjb2RlciAl
c10gUFNSIGVudHJ5IGF0dGVtcHQgaW4gMg0KPiA+IHZibGFua3NcbiIsDQo+ID4gLQkJCSAgICB0
cmFuc2NvZGVyX25hbWUoY3B1X3RyYW5zY29kZXIpKTsNCj4gPiArCQlpbnRlbF9kcC0+cHNyLmxh
c3RfZW50cnlfYXR0ZW1wdCA9IHRpbWVfbnM7DQo+ID4gKwkJRFJNX0RFQlVHX0tNUygiW3RyYW5z
Y29kZXIgJXNdIFBTUiBlbnRyeSBhdHRlbXB0IGluIDINCj4gPiB2YmxhbmtzXG4iLA0KPiAJCVBs
ZWFzZSB1c2UgZHJtX3tkYmcsd2Fybn0gYXQgZXZlcnkgcGxhY2UgdW4gdGhpcyBwYXRjaC4NCj4g
PiArCQkJICAgICAgdHJhbnNjb2Rlcl9uYW1lKGNwdV90cmFuc2NvZGVyKSk7DQo+ID4gIAl9DQo+
ID4gIA0KPiA+ICAJaWYgKHBzcl9paXIgJiBFRFBfUFNSX1BPU1RfRVhJVCh0cmFuc19zaGlmdCkp
IHsNCj4gPiAtCQlkZXZfcHJpdi0+cHNyLmxhc3RfZXhpdCA9IHRpbWVfbnM7DQo+ID4gLQkJZHJt
X2RiZ19rbXMoJmRldl9wcml2LT5kcm0sDQo+ID4gLQkJCSAgICAiW3RyYW5zY29kZXIgJXNdIFBT
UiBleGl0IGNvbXBsZXRlZFxuIiwNCj4gPiAtCQkJICAgIHRyYW5zY29kZXJfbmFtZShjcHVfdHJh
bnNjb2RlcikpOw0KPiA+ICsJCWludGVsX2RwLT5wc3IubGFzdF9leGl0ID0gdGltZV9uczsNCj4g
PiArCQlEUk1fREVCVUdfS01TKCJbdHJhbnNjb2RlciAlc10gUFNSIGV4aXQgY29tcGxldGVkXG4i
LA0KPiA+ICsJCQkgICAgICB0cmFuc2NvZGVyX25hbWUoY3B1X3RyYW5zY29kZXIpKTsNCj4gPiAg
DQo+ID4gIAkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkgew0KPiA+ICAJCQl1MzIgdmFs
ID0gaW50ZWxfZGVfcmVhZChkZXZfcHJpdiwNCj4gPiAgCQkJCQkJUFNSX0VWRU5UKGNwdV90cmFu
c2NvZGUNCj4gPiByKSk7DQo+ID4gLQkJCWJvb2wgcHNyMl9lbmFibGVkID0gZGV2X3ByaXYtPnBz
ci5wc3IyX2VuYWJsZWQ7DQo+ID4gKwkJCWJvb2wgcHNyMl9lbmFibGVkID0gaW50ZWxfZHAtPnBz
ci5wc3IyX2VuYWJsZWQ7DQo+ID4gIA0KPiA+ICAJCQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwN
Cj4gPiBQU1JfRVZFTlQoY3B1X3RyYW5zY29kZXIpLA0KPiA+ICAJCQkJICAgICAgIHZhbCk7DQo+
ID4gQEAgLTIxMywxMCArMjE1LDEwIEBAIHZvaWQgaW50ZWxfcHNyX2lycV9oYW5kbGVyKHN0cnVj
dA0KPiA+IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgcHNyX2lpcikNCj4gPiAgCWlm
IChwc3JfaWlyICYgRURQX1BTUl9FUlJPUih0cmFuc19zaGlmdCkpIHsNCj4gPiAgCQl1MzIgdmFs
Ow0KPiA+ICANCj4gPiAtCQlkcm1fd2FybigmZGV2X3ByaXYtPmRybSwgIlt0cmFuc2NvZGVyICVz
XSBQU1IgYXV4DQo+ID4gZXJyb3JcbiIsDQo+ID4gKwkJRFJNX1dBUk4oIlt0cmFuc2NvZGVyICVz
XSBQU1IgYXV4IGVycm9yXG4iLA0KPiA+ICAJCQkgdHJhbnNjb2Rlcl9uYW1lKGNwdV90cmFuc2Nv
ZGVyKSk7DQo+ID4gIA0KPiA+IC0JCWRldl9wcml2LT5wc3IuaXJxX2F1eF9lcnJvciA9IHRydWU7
DQo+ID4gKwkJaW50ZWxfZHAtPnBzci5pcnFfYXV4X2Vycm9yID0gdHJ1ZTsNCj4gPiAgDQo+ID4g
IAkJLyoNCj4gPiAgCQkgKiBJZiB0aGlzIGludGVycnVwdGlvbiBpcyBub3QgbWFza2VkIGl0IHdp
bGwga2VlcA0KPiA+IEBAIC0yMzAsNyArMjMyLDcgQEAgdm9pZCBpbnRlbF9wc3JfaXJxX2hhbmRs
ZXIoc3RydWN0DQo+ID4gZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBwc3JfaWlyKQ0K
PiA+ICAJCXZhbCB8PSBFRFBfUFNSX0VSUk9SKHRyYW5zX3NoaWZ0KTsNCj4gPiAgCQlpbnRlbF9k
ZV93cml0ZShkZXZfcHJpdiwgaW1yX3JlZywgdmFsKTsNCj4gPiAgDQo+ID4gLQkJc2NoZWR1bGVf
d29yaygmZGV2X3ByaXYtPnBzci53b3JrKTsNCj4gPiArCQlzY2hlZHVsZV93b3JrKCZpbnRlbF9k
cC0+cHNyLndvcmspOw0KPiA+ICAJfQ0KPiA+ICB9DQo+ID4gIA0KPiA+IEBAIC0yOTEsMTIgKzI5
Myw2IEBAIHZvaWQgaW50ZWxfcHNyX2luaXRfZHBjZChzdHJ1Y3QgaW50ZWxfZHANCj4gPiAqaW50
ZWxfZHApDQo+ID4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQ0KPiA+ICAJ
CXRvX2k5MTUoZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApLT5iYXNlLmJhc2UuZGV2KTsNCj4gPiAg
DQo+ID4gLQlpZiAoZGV2X3ByaXYtPnBzci5kcCkgew0KPiA+IC0JCWRybV93YXJuKCZkZXZfcHJp
di0+ZHJtLA0KPiA+IC0JCQkgIk1vcmUgdGhhbiBvbmUgZURQIHBhbmVsIGZvdW5kLCBQU1Igc3Vw
cG9ydA0KPiA+IHNob3VsZCBiZSBleHRlbmRlZFxuIik7DQo+ID4gLQkJcmV0dXJuOw0KPiA+IC0J
fQ0KPiA+IC0NCj4gPiAgCWRybV9kcF9kcGNkX3JlYWQoJmludGVsX2RwLT5hdXgsIERQX1BTUl9T
VVBQT1JULCBpbnRlbF9kcC0NCj4gPiA+cHNyX2RwY2QsDQo+ID4gIAkJCSBzaXplb2YoaW50ZWxf
ZHAtPnBzcl9kcGNkKSk7DQo+ID4gIA0KPiA+IEBAIC0zMTcsMTIgKzMxMywxMCBAQCB2b2lkIGlu
dGVsX3Bzcl9pbml0X2RwY2Qoc3RydWN0IGludGVsX2RwDQo+ID4gKmludGVsX2RwKQ0KPiA+ICAJ
CXJldHVybjsNCj4gPiAgCX0NCj4gPiAgDQo+ID4gLQlkZXZfcHJpdi0+cHNyLnNpbmtfc3VwcG9y
dCA9IHRydWU7DQo+ID4gLQlkZXZfcHJpdi0+cHNyLnNpbmtfc3luY19sYXRlbmN5ID0NCj4gPiAr
CWludGVsX2RwLT5wc3Iuc2lua19zdXBwb3J0ID0gdHJ1ZTsNCj4gPiArCWludGVsX2RwLT5wc3Iu
c2lua19zeW5jX2xhdGVuY3kgPQ0KPiA+ICAJCWludGVsX2RwX2dldF9zaW5rX3N5bmNfbGF0ZW5j
eShpbnRlbF9kcCk7DQo+ID4gIA0KPiA+IC0JZGV2X3ByaXYtPnBzci5kcCA9IGludGVsX2RwOw0K
PiA+IC0NCj4gPiAgCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkgJiYNCj4gPiAgCSAgICAo
aW50ZWxfZHAtPnBzcl9kcGNkWzBdID09DQo+ID4gRFBfUFNSMl9XSVRIX1lfQ09PUkRfSVNfU1VQ
UE9SVEVEKSkgew0KPiA+ICAJCWJvb2wgeV9yZXEgPSBpbnRlbF9kcC0+cHNyX2RwY2RbMV0gJg0K
PiA+IEBAIC0zNDAsMTQgKzMzNCwxNCBAQCB2b2lkIGludGVsX3Bzcl9pbml0X2RwY2Qoc3RydWN0
IGludGVsX2RwDQo+ID4gKmludGVsX2RwKQ0KPiA+ICAJCSAqIFktY29vcmRpbmF0ZSByZXF1aXJl
bWVudCBwYW5lbHMgd2Ugd291bGQgbmVlZCB0bw0KPiA+IGVuYWJsZQ0KPiA+ICAJCSAqIEdUQyBm
aXJzdC4NCj4gPiAgCQkgKi8NCj4gPiAtCQlkZXZfcHJpdi0+cHNyLnNpbmtfcHNyMl9zdXBwb3J0
ID0geV9yZXEgJiYgYWxwbTsNCj4gPiArCQlpbnRlbF9kcC0+cHNyLnNpbmtfcHNyMl9zdXBwb3J0
ID0geV9yZXEgJiYgYWxwbTsNCj4gPiAgCQlkcm1fZGJnX2ttcygmZGV2X3ByaXYtPmRybSwgIlBT
UjIgJXNzdXBwb3J0ZWRcbiIsDQo+ID4gLQkJCSAgICBkZXZfcHJpdi0+cHNyLnNpbmtfcHNyMl9z
dXBwb3J0ID8gIiIgOiAibm90DQo+ID4gIik7DQo+ID4gKwkJCSAgICBpbnRlbF9kcC0+cHNyLnNp
bmtfcHNyMl9zdXBwb3J0ID8gIiIgOiAibm90DQo+ID4gIik7DQo+ID4gIA0KPiA+IC0JCWlmIChk
ZXZfcHJpdi0+cHNyLnNpbmtfcHNyMl9zdXBwb3J0KSB7DQo+ID4gLQkJCWRldl9wcml2LT5wc3Iu
Y29sb3JpbWV0cnlfc3VwcG9ydCA9DQo+ID4gKwkJaWYgKGludGVsX2RwLT5wc3Iuc2lua19wc3Iy
X3N1cHBvcnQpIHsNCj4gPiArCQkJaW50ZWxfZHAtPnBzci5jb2xvcmltZXRyeV9zdXBwb3J0ID0N
Cj4gPiAgCQkJCWludGVsX2RwX2dldF9jb2xvcmltZXRyeV9zdGF0dXMoaW50ZWxfZA0KPiA+IHAp
Ow0KPiA+IC0JCQlkZXZfcHJpdi0+cHNyLnN1X3hfZ3JhbnVsYXJpdHkgPQ0KPiA+ICsJCQlpbnRl
bF9kcC0+cHNyLnN1X3hfZ3JhbnVsYXJpdHkgPQ0KPiA+ICAJCQkJaW50ZWxfZHBfZ2V0X3N1X3hf
Z3JhbnVsYXJ0aXkoaW50ZWxfZHApDQo+ID4gOw0KPiA+ICAJCX0NCj4gPiAgCX0NCj4gPiBAQCAt
MzczLDcgKzM2Nyw3IEBAIHN0YXRpYyB2b2lkIGhzd19wc3Jfc2V0dXBfYXV4KHN0cnVjdCBpbnRl
bF9kcA0KPiA+ICppbnRlbF9kcCkNCj4gPiAgCUJVSUxEX0JVR19PTihzaXplb2YoYXV4X21zZykg
PiAyMCk7DQo+ID4gIAlmb3IgKGkgPSAwOyBpIDwgc2l6ZW9mKGF1eF9tc2cpOyBpICs9IDQpDQo+
ID4gIAkJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsDQo+ID4gLQkJCSAgICAgICBFRFBfUFNSX0FV
WF9EQVRBKGRldl9wcml2LQ0KPiA+ID5wc3IudHJhbnNjb2RlciwgaSA+PiAyKSwNCj4gPiArCQkJ
ICAgICAgIEVEUF9QU1JfQVVYX0RBVEEoaW50ZWxfZHAtDQo+ID4gPnBzci50cmFuc2NvZGVyLCBp
ID4+IDIpLA0KPiA+ICAJCQkgICAgICAgaW50ZWxfZHBfcGFja19hdXgoJmF1eF9tc2dbaV0sDQo+
ID4gc2l6ZW9mKGF1eF9tc2cpIC0gaSkpOw0KPiA+ICANCj4gPiAgCWF1eF9jbG9ja19kaXZpZGVy
ID0gaW50ZWxfZHAtPmdldF9hdXhfY2xvY2tfZGl2aWRlcihpbnRlbF9kcCwNCj4gPiAwKTsNCj4g
PiBAQCAtMzg0LDcgKzM3OCw3IEBAIHN0YXRpYyB2b2lkIGhzd19wc3Jfc2V0dXBfYXV4KHN0cnVj
dCBpbnRlbF9kcA0KPiA+ICppbnRlbF9kcCkNCj4gPiAgDQo+ID4gIAkvKiBTZWxlY3Qgb25seSB2
YWxpZCBiaXRzIGZvciBTUkRfQVVYX0NUTCAqLw0KPiA+ICAJYXV4X2N0bCAmPSBwc3JfYXV4X21h
c2s7DQo+ID4gLQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgRURQX1BTUl9BVVhfQ1RMKGRldl9w
cml2LQ0KPiA+ID5wc3IudHJhbnNjb2RlciksDQo+ID4gKwlpbnRlbF9kZV93cml0ZShkZXZfcHJp
diwgRURQX1BTUl9BVVhfQ1RMKGludGVsX2RwLQ0KPiA+ID5wc3IudHJhbnNjb2RlciksDQo+ID4g
IAkJICAgICAgIGF1eF9jdGwpOw0KPiA+ICB9DQo+ID4gIA0KPiA+IEBAIC0zOTQsMTQgKzM4OCwx
NCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wc3JfZW5hYmxlX3Npbmsoc3RydWN0DQo+ID4gaW50ZWxf
ZHAgKmludGVsX2RwKQ0KPiA+ICAJdTggZHBjZF92YWwgPSBEUF9QU1JfRU5BQkxFOw0KPiA+ICAN
Cj4gPiAgCS8qIEVuYWJsZSBBTFBNIGF0IHNpbmsgZm9yIHBzcjIgKi8NCj4gPiAtCWlmIChkZXZf
cHJpdi0+cHNyLnBzcjJfZW5hYmxlZCkgew0KPiA+ICsJaWYgKGludGVsX2RwLT5wc3IucHNyMl9l
bmFibGVkKSB7DQo+ID4gIAkJZHJtX2RwX2RwY2Rfd3JpdGViKCZpbnRlbF9kcC0+YXV4LA0KPiA+
IERQX1JFQ0VJVkVSX0FMUE1fQ09ORklHLA0KPiA+ICAJCQkJICAgRFBfQUxQTV9FTkFCTEUgfA0K
PiA+ICAJCQkJICAgRFBfQUxQTV9MT0NLX0VSUk9SX0lSUV9IUERfRU5BQkxFKTsNCj4gPiAgDQo+
ID4gIAkJZHBjZF92YWwgfD0gRFBfUFNSX0VOQUJMRV9QU1IyIHwNCj4gPiBEUF9QU1JfSVJRX0hQ
RF9XSVRIX0NSQ19FUlJPUlM7DQo+ID4gIAl9IGVsc2Ugew0KPiA+IC0JCWlmIChkZXZfcHJpdi0+
cHNyLmxpbmtfc3RhbmRieSkNCj4gPiArCQlpZiAoaW50ZWxfZHAtPnBzci5saW5rX3N0YW5kYnkp
DQo+ID4gIAkJCWRwY2RfdmFsIHw9IERQX1BTUl9NQUlOX0xJTktfQUNUSVZFOw0KPiA+ICANCj4g
PiAgCQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA4KQ0KPiA+IEBAIC00NjQsNyArNDU4LDcg
QEAgc3RhdGljIHU4IHBzcl9jb21wdXRlX2lkbGVfZnJhbWVzKHN0cnVjdA0KPiA+IGludGVsX2Rw
ICppbnRlbF9kcCkNCj4gPiAgCSAqIG9mZi1ieS1vbmUgaXNzdWUgdGhhdCBIVyBoYXMgaW4gc29t
ZSBjYXNlcy4NCj4gPiAgCSAqLw0KPiA+ICAJaWRsZV9mcmFtZXMgPSBtYXgoNiwgZGV2X3ByaXYt
PnZidC5wc3IuaWRsZV9mcmFtZXMpOw0KPiA+IC0JaWRsZV9mcmFtZXMgPSBtYXgoaWRsZV9mcmFt
ZXMsIGRldl9wcml2LT5wc3Iuc2lua19zeW5jX2xhdGVuY3kNCj4gPiArIDEpOw0KPiA+ICsJaWRs
ZV9mcmFtZXMgPSBtYXgoaWRsZV9mcmFtZXMsIGludGVsX2RwLT5wc3Iuc2lua19zeW5jX2xhdGVu
Y3kNCj4gPiArIDEpOw0KPiA+ICANCj4gPiAgCWlmIChkcm1fV0FSTl9PTigmZGV2X3ByaXYtPmRy
bSwgaWRsZV9mcmFtZXMgPiAweGYpKQ0KPiA+ICAJCWlkbGVfZnJhbWVzID0gMHhmOw0KPiA+IEBA
IC00ODQsNyArNDc4LDcgQEAgc3RhdGljIHZvaWQgaHN3X2FjdGl2YXRlX3BzcjEoc3RydWN0IGlu
dGVsX2RwDQo+ID4gKmludGVsX2RwKQ0KPiA+ICAJaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpKQ0K
PiA+ICAJCXZhbCB8PSBFRFBfUFNSX01JTl9MSU5LX0VOVFJZX1RJTUVfOF9MSU5FUzsNCj4gPiAg
DQo+ID4gLQlpZiAoZGV2X3ByaXYtPnBzci5saW5rX3N0YW5kYnkpDQo+ID4gKwlpZiAoaW50ZWxf
ZHAtPnBzci5saW5rX3N0YW5kYnkpDQo+ID4gIAkJdmFsIHw9IEVEUF9QU1JfTElOS19TVEFOREJZ
Ow0KPiA+ICANCj4gPiAgCXZhbCB8PSBpbnRlbF9wc3IxX2dldF90cF90aW1lKGludGVsX2RwKTsN
Cj4gPiBAQCAtNDkyLDkgKzQ4Niw5IEBAIHN0YXRpYyB2b2lkIGhzd19hY3RpdmF0ZV9wc3IxKHN0
cnVjdCBpbnRlbF9kcA0KPiA+ICppbnRlbF9kcCkNCj4gPiAgCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDgpDQo+ID4gIAkJdmFsIHw9IEVEUF9QU1JfQ1JDX0VOQUJMRTsNCj4gPiAgDQo+ID4g
LQl2YWwgfD0gKGludGVsX2RlX3JlYWQoZGV2X3ByaXYsIEVEUF9QU1JfQ1RMKGRldl9wcml2LQ0K
PiA+ID5wc3IudHJhbnNjb2RlcikpICYNCj4gPiArCXZhbCB8PSAoaW50ZWxfZGVfcmVhZChkZXZf
cHJpdiwgRURQX1BTUl9DVEwoaW50ZWxfZHAtDQo+ID4gPnBzci50cmFuc2NvZGVyKSkgJg0KPiA+
ICAJCUVEUF9QU1JfUkVTVE9SRV9QU1JfQUNUSVZFX0NUWF9NQVNLKTsNCj4gPiAtCWludGVsX2Rl
X3dyaXRlKGRldl9wcml2LCBFRFBfUFNSX0NUTChkZXZfcHJpdi0+cHNyLnRyYW5zY29kZXIpLCAN
Cj4gPiB2YWwpOw0KPiA+ICsJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIEVEUF9QU1JfQ1RMKGlu
dGVsX2RwLT5wc3IudHJhbnNjb2RlciksIA0KPiA+IHZhbCk7DQo+ID4gIH0NCj4gPiAgDQo+ID4g
IHN0YXRpYyB1MzIgaW50ZWxfcHNyMl9nZXRfdHBfdGltZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVs
X2RwKQ0KPiA+IEBAIC01MjksNyArNTIzLDcgQEAgc3RhdGljIHZvaWQgaHN3X2FjdGl2YXRlX3Bz
cjIoc3RydWN0IGludGVsX2RwDQo+ID4gKmludGVsX2RwKQ0KPiA+ICAJaWYgKElOVEVMX0dFTihk
ZXZfcHJpdikgPj0gMTAgfHwgSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpDQo+ID4gIAkJdmFsIHw9
IEVEUF9ZX0NPT1JESU5BVEVfRU5BQkxFOw0KPiA+ICANCj4gPiAtCXZhbCB8PSBFRFBfUFNSMl9G
UkFNRV9CRUZPUkVfU1UoZGV2X3ByaXYtPnBzci5zaW5rX3N5bmNfbGF0ZW5jeSANCj4gPiArIDEp
Ow0KPiA+ICsJdmFsIHw9IEVEUF9QU1IyX0ZSQU1FX0JFRk9SRV9TVShpbnRlbF9kcC0+cHNyLnNp
bmtfc3luY19sYXRlbmN5IA0KPiA+ICsgMSk7DQo+ID4gIAl2YWwgfD0gaW50ZWxfcHNyMl9nZXRf
dHBfdGltZShpbnRlbF9kcCk7DQo+ID4gIA0KPiA+ICAJaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gMTIpIHsNCj4gPiBAQCAtNTQ4LDcgKzU0Miw3IEBAIHN0YXRpYyB2b2lkIGhzd19hY3RpdmF0
ZV9wc3IyKHN0cnVjdCBpbnRlbF9kcA0KPiA+ICppbnRlbF9kcCkNCj4gPiAgCQl2YWwgfD0gRURQ
X1BTUjJfRkFTVF9XQUtFKDcpOw0KPiA+ICAJfQ0KPiA+ICANCj4gPiAtCWlmIChkZXZfcHJpdi0+
cHNyLnBzcjJfc2VsX2ZldGNoX2VuYWJsZWQpIHsNCj4gPiArCWlmIChpbnRlbF9kcC0+cHNyLnBz
cjJfc2VsX2ZldGNoX2VuYWJsZWQpIHsNCj4gPiAgCQkvKiBXQSAxNDA4MzMwODQ3ICovDQo+ID4g
IAkJaWYgKElTX1RHTF9ESVNQX1JFVklEKGRldl9wcml2LCBUR0xfUkVWSURfQTAsDQo+ID4gVEdM
X1JFVklEX0EwKSB8fA0KPiA+ICAJCSAgICBJU19SS0xfUkVWSUQoZGV2X3ByaXYsIFJLTF9SRVZJ
RF9BMCwgUktMX1JFVklEX0EwKSkNCj4gPiBAQCAtNTU3LDIwICs1NTEsMjAgQEAgc3RhdGljIHZv
aWQgaHN3X2FjdGl2YXRlX3BzcjIoc3RydWN0IGludGVsX2RwDQo+ID4gKmludGVsX2RwKQ0KPiA+
ICAJCQkJICAgICBESVNfUkFNX0JZUEFTU19QU1IyX01BTl9UUkFDSyk7DQo+ID4gIA0KPiA+ICAJ
CWludGVsX2RlX3dyaXRlKGRldl9wcml2LA0KPiA+IC0JCQkgICAgICAgUFNSMl9NQU5fVFJLX0NU
TChkZXZfcHJpdi0NCj4gPiA+cHNyLnRyYW5zY29kZXIpLA0KPiA+ICsJCQkgICAgICAgUFNSMl9N
QU5fVFJLX0NUTChpbnRlbF9kcC0NCj4gPiA+cHNyLnRyYW5zY29kZXIpLA0KPiA+ICAJCQkgICAg
ICAgUFNSMl9NQU5fVFJLX0NUTF9FTkFCTEUpOw0KPiA+ICAJfSBlbHNlIGlmIChIQVNfUFNSMl9T
RUxfRkVUQ0goZGV2X3ByaXYpKSB7DQo+ID4gIAkJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsDQo+
ID4gLQkJCSAgICAgICBQU1IyX01BTl9UUktfQ1RMKGRldl9wcml2LQ0KPiA+ID5wc3IudHJhbnNj
b2RlciksIDApOw0KPiA+ICsJCQkgICAgICAgUFNSMl9NQU5fVFJLX0NUTChpbnRlbF9kcC0NCj4g
PiA+cHNyLnRyYW5zY29kZXIpLCAwKTsNCj4gPiAgCX0NCj4gPiAgDQo+ID4gIAkvKg0KPiA+ICAJ
ICogUFNSMiBIVyBpcyBpbmNvcnJlY3RseSB1c2luZyBFRFBfUFNSX1RQMV9UUDNfU0VMIGFuZCBC
U3BlYw0KPiA+IGlzDQo+ID4gIAkgKiByZWNvbW1lbmRpbmcga2VlcCB0aGlzIGJpdCB1bnNldCB3
aGlsZSBQU1IyIGlzIGVuYWJsZWQuDQo+ID4gIAkgKi8NCj4gPiAtCWludGVsX2RlX3dyaXRlKGRl
dl9wcml2LCBFRFBfUFNSX0NUTChkZXZfcHJpdi0+cHNyLnRyYW5zY29kZXIpLCANCj4gPiAwKTsN
Cj4gPiArCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBFRFBfUFNSX0NUTChpbnRlbF9kcC0+cHNy
LnRyYW5zY29kZXIpLCANCj4gPiAwKTsNCj4gPiAgDQo+ID4gLQlpbnRlbF9kZV93cml0ZShkZXZf
cHJpdiwgRURQX1BTUjJfQ1RMKGRldl9wcml2LQ0KPiA+ID5wc3IudHJhbnNjb2RlciksIHZhbCk7
DQo+ID4gKwlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgRURQX1BTUjJfQ1RMKGludGVsX2RwLQ0K
PiA+ID5wc3IudHJhbnNjb2RlciksIHZhbCk7DQo+ID4gIH0NCj4gPiAgDQo+ID4gIHN0YXRpYyBi
b29sDQo+ID4gQEAgLTU5Myw1NSArNTg3LDU4IEBAIHN0YXRpYyB1MzIgaW50ZWxfZ2V0X2ZyYW1l
X3RpbWVfdXMoY29uc3QNCj4gPiBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlKQ0KPiA+
ICAJCQkgICAgZHJtX21vZGVfdnJlZnJlc2goJmNzdGF0ZS0NCj4gPiA+aHcuYWRqdXN0ZWRfbW9k
ZSkpOw0KPiA+ICB9DQo+ID4gIA0KPiA+IC1zdGF0aWMgdm9pZCBwc3IyX3Byb2dyYW1faWRsZV9m
cmFtZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUNCj4gPiAqZGV2X3ByaXYsDQo+ID4gK3N0YXRp
YyB2b2lkIHBzcjJfcHJvZ3JhbV9pZGxlX2ZyYW1lcyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2Rw
LA0KPiA+ICAJCQkJICAgICB1MzIgaWRsZV9mcmFtZXMpDQo+ID4gIHsNCj4gPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOw0KPiA+ICAJ
dTMyIHZhbDsNCj4gPiAgDQo+ID4gIAlpZGxlX2ZyYW1lcyA8PD0gIEVEUF9QU1IyX0lETEVfRlJB
TUVfU0hJRlQ7DQo+ID4gLQl2YWwgPSBpbnRlbF9kZV9yZWFkKGRldl9wcml2LCBFRFBfUFNSMl9D
VEwoZGV2X3ByaXYtDQo+ID4gPnBzci50cmFuc2NvZGVyKSk7DQo+ID4gKwl2YWwgPSBpbnRlbF9k
ZV9yZWFkKGRldl9wcml2LCBFRFBfUFNSMl9DVEwoaW50ZWxfZHAtDQo+ID4gPnBzci50cmFuc2Nv
ZGVyKSk7DQo+ID4gIAl2YWwgJj0gfkVEUF9QU1IyX0lETEVfRlJBTUVfTUFTSzsNCj4gPiAgCXZh
bCB8PSBpZGxlX2ZyYW1lczsNCj4gPiAtCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBFRFBfUFNS
Ml9DVEwoZGV2X3ByaXYtDQo+ID4gPnBzci50cmFuc2NvZGVyKSwgdmFsKTsNCj4gPiArCWludGVs
X2RlX3dyaXRlKGRldl9wcml2LCBFRFBfUFNSMl9DVEwoaW50ZWxfZHAtDQo+ID4gPnBzci50cmFu
c2NvZGVyKSwgdmFsKTsNCj4gPiAgfQ0KPiA+ICANCj4gPiAtc3RhdGljIHZvaWQgdGdsX3BzcjJf
ZW5hYmxlX2RjM2NvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlDQo+ID4gKmRldl9wcml2KQ0KPiA+
ICtzdGF0aWMgdm9pZCB0Z2xfcHNyMl9lbmFibGVfZGMzY28oc3RydWN0IGludGVsX2RwICppbnRl
bF9kcCkNCj4gPiAgew0KPiA+IC0JcHNyMl9wcm9ncmFtX2lkbGVfZnJhbWVzKGRldl9wcml2LCAw
KTsNCj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUo
aW50ZWxfZHApOw0KPiA+ICsNCj4gPiArCXBzcjJfcHJvZ3JhbV9pZGxlX2ZyYW1lcyhpbnRlbF9k
cCwgMCk7DQo+ID4gIAlpbnRlbF9kaXNwbGF5X3Bvd2VyX3NldF90YXJnZXRfZGNfc3RhdGUoZGV2
X3ByaXYsDQo+ID4gRENfU1RBVEVfRU5fREMzQ08pOw0KPiA+ICB9DQo+ID4gIA0KPiA+IC1zdGF0
aWMgdm9pZCB0Z2xfcHNyMl9kaXNhYmxlX2RjM2NvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlDQo+
ID4gKmRldl9wcml2KQ0KPiA+ICtzdGF0aWMgdm9pZCB0Z2xfcHNyMl9kaXNhYmxlX2RjM2NvKHN0
cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApDQo+ID4gIHsNCj4gPiAtCXN0cnVjdCBpbnRlbF9kcCAq
aW50ZWxfZHAgPSBkZXZfcHJpdi0+cHNyLmRwOw0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7DQo+ID4gIA0KPiA+ICAJaW50ZWxf
ZGlzcGxheV9wb3dlcl9zZXRfdGFyZ2V0X2RjX3N0YXRlKGRldl9wcml2LA0KPiA+IERDX1NUQVRF
X0VOX1VQVE9fREM2KTsNCj4gPiAtCXBzcjJfcHJvZ3JhbV9pZGxlX2ZyYW1lcyhkZXZfcHJpdiwN
Cj4gPiBwc3JfY29tcHV0ZV9pZGxlX2ZyYW1lcyhpbnRlbF9kcCkpOw0KPiA+ICsJcHNyMl9wcm9n
cmFtX2lkbGVfZnJhbWVzKGludGVsX2RwLA0KPiA+IHBzcl9jb21wdXRlX2lkbGVfZnJhbWVzKGlu
dGVsX2RwKSk7DQo+ID4gIH0NCj4gPiAgDQo+ID4gIHN0YXRpYyB2b2lkIHRnbF9kYzNjb19kaXNh
YmxlX3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQ0KPiA+ICB7DQo+ID4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQ0KPiA+IC0JCWNvbnRhaW5lcl9vZih3b3JrLCB0
eXBlb2YoKmRldl9wcml2KSwNCj4gPiBwc3IuZGMzY29fd29yay53b3JrKTsNCj4gPiArCXN0cnVj
dCBpbnRlbF9kcCAqaW50ZWxfZHAgPQ0KPiA+ICsJCWNvbnRhaW5lcl9vZih3b3JrLCB0eXBlb2Yo
KmludGVsX2RwKSwNCj4gPiBwc3IuZGMzY29fd29yay53b3JrKTsNCj4gPiAgDQo+ID4gLQltdXRl
eF9sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2spOw0KPiA+ICsJbXV0ZXhfbG9jaygmaW50ZWxfZHAt
PnBzci5sb2NrKTsNCj4gPiAgCS8qIElmIGRlbGF5ZWQgd29yayBpcyBwZW5kaW5nLCBpdCBpcyBu
b3QgaWRsZSAqLw0KPiA+IC0JaWYgKGRlbGF5ZWRfd29ya19wZW5kaW5nKCZkZXZfcHJpdi0+cHNy
LmRjM2NvX3dvcmspKQ0KPiA+ICsJaWYgKGRlbGF5ZWRfd29ya19wZW5kaW5nKCZpbnRlbF9kcC0+
cHNyLmRjM2NvX3dvcmspKQ0KPiA+ICAJCWdvdG8gdW5sb2NrOw0KPiA+ICANCj4gPiAtCXRnbF9w
c3IyX2Rpc2FibGVfZGMzY28oZGV2X3ByaXYpOw0KPiA+ICsJdGdsX3BzcjJfZGlzYWJsZV9kYzNj
byhpbnRlbF9kcCk7DQo+ID4gIHVubG9jazoNCj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYt
PnBzci5sb2NrKTsNCj4gPiArCW11dGV4X3VubG9jaygmaW50ZWxfZHAtPnBzci5sb2NrKTsNCj4g
PiAgfQ0KPiA+ICANCj4gPiAtc3RhdGljIHZvaWQgdGdsX2Rpc2FsbG93X2RjM2NvX29uX3BzcjJf
ZXhpdChzdHJ1Y3QNCj4gPiBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikNCj4gPiArc3RhdGlj
IHZvaWQgdGdsX2Rpc2FsbG93X2RjM2NvX29uX3BzcjJfZXhpdChzdHJ1Y3QgaW50ZWxfZHANCj4g
PiAqaW50ZWxfZHApDQo+ID4gIHsNCj4gPiAtCWlmICghZGV2X3ByaXYtPnBzci5kYzNjb19lbmFi
bGVkKQ0KPiA+ICsJaWYgKCFpbnRlbF9kcC0+cHNyLmRjM2NvX2VuYWJsZWQpDQo+ID4gIAkJcmV0
dXJuOw0KPiA+ICANCj4gPiAtCWNhbmNlbF9kZWxheWVkX3dvcmsoJmRldl9wcml2LT5wc3IuZGMz
Y29fd29yayk7DQo+ID4gKwljYW5jZWxfZGVsYXllZF93b3JrKCZpbnRlbF9kcC0+cHNyLmRjM2Nv
X3dvcmspOw0KPiA+ICAJLyogQmVmb3JlIFBTUjIgZXhpdCBkaXNhbGxvdyBkYzNjbyovDQo+ID4g
LQl0Z2xfcHNyMl9kaXNhYmxlX2RjM2NvKGRldl9wcml2KTsNCj4gPiArCXRnbF9wc3IyX2Rpc2Fi
bGVfZGMzY28oaW50ZWxfZHApOw0KPiA+ICB9DQo+ID4gIA0KPiA+ICBzdGF0aWMgdm9pZA0KPiA+
IEBAIC03MTQsNyArNzExLDcgQEAgc3RhdGljIGJvb2wgaW50ZWxfcHNyMl9jb25maWdfdmFsaWQo
c3RydWN0DQo+ID4gaW50ZWxfZHAgKmludGVsX2RwLA0KPiA+ICAJaW50IGNydGNfdmRpc3BsYXkg
PSBjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfdmRpc3BsYXk7DQo+ID4gIAlpbnQg
cHNyX21heF9oID0gMCwgcHNyX21heF92ID0gMCwgbWF4X2JwcCA9IDA7DQo+ID4gIA0KPiA+IC0J
aWYgKCFkZXZfcHJpdi0+cHNyLnNpbmtfcHNyMl9zdXBwb3J0KQ0KPiA+ICsJaWYgKCFpbnRlbF9k
cC0+cHNyLnNpbmtfcHNyMl9zdXBwb3J0KQ0KPiA+ICAJCXJldHVybiBmYWxzZTsNCj4gPiAgDQo+
ID4gIAlpZiAoIXRyYW5zY29kZXJfaGFzX3BzcjIoZGV2X3ByaXYsIGNydGNfc3RhdGUtPmNwdV90
cmFuc2NvZGVyKSkgDQo+ID4gew0KPiA+IEBAIC03MjQsNyArNzIxLDcgQEAgc3RhdGljIGJvb2wg
aW50ZWxfcHNyMl9jb25maWdfdmFsaWQoc3RydWN0DQo+ID4gaW50ZWxfZHAgKmludGVsX2RwLA0K
PiA+ICAJCXJldHVybiBmYWxzZTsNCj4gPiAgCX0NCj4gPiAgDQo+ID4gLQlpZiAoIXBzcjJfZ2xv
YmFsX2VuYWJsZWQoZGV2X3ByaXYpKSB7DQo+ID4gKwlpZiAoIXBzcjJfZ2xvYmFsX2VuYWJsZWQo
aW50ZWxfZHApKSB7DQo+ID4gIAkJZHJtX2RiZ19rbXMoJmRldl9wcml2LT5kcm0sICJQU1IyIGRp
c2FibGVkIGJ5IGZsYWdcbiIpOw0KPiA+ICAJCXJldHVybiBmYWxzZTsNCj4gPiAgCX0NCj4gPiBA
QCAtNzczLDEwICs3NzAsMTAgQEAgc3RhdGljIGJvb2wgaW50ZWxfcHNyMl9jb25maWdfdmFsaWQo
c3RydWN0DQo+ID4gaW50ZWxfZHAgKmludGVsX2RwLA0KPiA+ICAJICogb25seSBuZWVkIHRvIHZh
bGlkYXRlIHRoZSBTVSBibG9jayB3aWR0aCBpcyBhIG11bHRpcGxlIG9mDQo+ID4gIAkgKiB4IGdy
YW51bGFyaXR5Lg0KPiA+ICAJICovDQo+ID4gLQlpZiAoY3J0Y19oZGlzcGxheSAlIGRldl9wcml2
LT5wc3Iuc3VfeF9ncmFudWxhcml0eSkgew0KPiA+ICsJaWYgKGNydGNfaGRpc3BsYXkgJSBpbnRl
bF9kcC0+cHNyLnN1X3hfZ3JhbnVsYXJpdHkpIHsNCj4gPiAgCQlkcm1fZGJnX2ttcygmZGV2X3By
aXYtPmRybSwNCj4gPiAgCQkJICAgICJQU1IyIG5vdCBlbmFibGVkLCBoZGlzcGxheSglZCkgbm90
DQo+ID4gbXVsdGlwbGUgb2YgJWRcbiIsDQo+ID4gLQkJCSAgICBjcnRjX2hkaXNwbGF5LCBkZXZf
cHJpdi0NCj4gPiA+cHNyLnN1X3hfZ3JhbnVsYXJpdHkpOw0KPiA+ICsJCQkgICAgY3J0Y19oZGlz
cGxheSwgaW50ZWxfZHAtDQo+ID4gPnBzci5zdV94X2dyYW51bGFyaXR5KTsNCj4gPiAgCQlyZXR1
cm4gZmFsc2U7DQo+ID4gIAl9DQo+ID4gIA0KPiA+IEBAIC04MTEsMTMgKzgwOCwxMCBAQCB2b2lk
IGludGVsX3Bzcl9jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZHANCj4gPiAqaW50ZWxfZHAs
DQo+ID4gIAkJJmNydGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGU7DQo+ID4gIAlpbnQgcHNyX3Nl
dHVwX3RpbWU7DQo+IFdoYXQgaXMgdGhlIHBsYW4gdG8gY2hlY2sgd2hldGhlciBhIHRyYW5zY29k
ZXIgc3VwcG9ydHMgcHNyIHdpdGggYQ0KPiBpbnRlbF9kcC4NCj4gVGhlb3JldGljYWxseSB0aGVy
ZSBjYW4gYmUgbXVsaXBsZSBjb21iaW5hdGlvbiBvZiBjcnRjIGF0dGFjaGVkIHRvIGENCj4gY29u
bmVjdG9yLCAgDQo+IElmIGl0IGlzIHdpcCwgcGxlc2UgYWRkIFRPRE8gY29tbWVudCBpbiBjb21t
aXQgbG9nLg0KPiA+ICANCj4gPiAtCWlmICghQ0FOX1BTUihkZXZfcHJpdikpDQo+ID4gLQkJcmV0
dXJuOw0KPiA+IC0NCj4gPiAtCWlmIChpbnRlbF9kcCAhPSBkZXZfcHJpdi0+cHNyLmRwKQ0KPiA+
ICsJaWYgKCFDQU5fUFNSKGludGVsX2RwKSkNCj4gPiAgCQlyZXR1cm47DQo+ID4gIA0KPiA+IC0J
aWYgKCFwc3JfZ2xvYmFsX2VuYWJsZWQoZGV2X3ByaXYpKSB7DQo+ID4gKwlpZiAoIXBzcl9nbG9i
YWxfZW5hYmxlZChpbnRlbF9kcCkpIHsNCj4gPiAgCQlkcm1fZGJnX2ttcygmZGV2X3ByaXYtPmRy
bSwgIlBTUiBkaXNhYmxlZCBieSBmbGFnXG4iKTsNCj4gPiAgCQlyZXR1cm47DQo+ID4gIAl9DQo+
ID4gQEAgLTgzNCw3ICs4MjgsNyBAQCB2b2lkIGludGVsX3Bzcl9jb21wdXRlX2NvbmZpZyhzdHJ1
Y3QgaW50ZWxfZHANCj4gPiAqaW50ZWxfZHAsDQo+ID4gIAkJcmV0dXJuOw0KPiA+ICAJfQ0KPiA+
ICANCj4gPiAtCWlmIChkZXZfcHJpdi0+cHNyLnNpbmtfbm90X3JlbGlhYmxlKSB7DQo+ID4gKwlp
ZiAoaW50ZWxfZHAtPnBzci5zaW5rX25vdF9yZWxpYWJsZSkgew0KPiA+ICAJCWRybV9kYmdfa21z
KCZkZXZfcHJpdi0+ZHJtLA0KPiA+ICAJCQkgICAgIlBTUiBzaW5rIGltcGxlbWVudGF0aW9uIGlz
IG5vdA0KPiA+IHJlbGlhYmxlXG4iKTsNCj4gPiAgCQlyZXR1cm47DQo+ID4gQEAgLTg3MCwyMyAr
ODY0LDI0IEBAIHZvaWQgaW50ZWxfcHNyX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9kcA0K
PiA+ICppbnRlbF9kcCwNCj4gPiAgc3RhdGljIHZvaWQgaW50ZWxfcHNyX2FjdGl2YXRlKHN0cnVj
dCBpbnRlbF9kcCAqaW50ZWxfZHApDQo+ID4gIHsNCj4gPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOw0KPiA+ICsJZW51bSB0cmFuc2Nv
ZGVyIHRyYW5zY29kZXIgPSBpbnRlbF9kcC0+cHNyLnRyYW5zY29kZXI7DQo+ID4gIA0KPiA+IC0J
aWYgKHRyYW5zY29kZXJfaGFzX3BzcjIoZGV2X3ByaXYsIGRldl9wcml2LT5wc3IudHJhbnNjb2Rl
cikpDQo+ID4gKwlpZiAodHJhbnNjb2Rlcl9oYXNfcHNyMihkZXZfcHJpdiwgdHJhbnNjb2Rlcikp
DQo+ID4gIAkJZHJtX1dBUk5fT04oJmRldl9wcml2LT5kcm0sDQo+ID4gLQkJCSAgICBpbnRlbF9k
ZV9yZWFkKGRldl9wcml2LA0KPiA+IEVEUF9QU1IyX0NUTChkZXZfcHJpdi0+cHNyLnRyYW5zY29k
ZXIpKSAmIEVEUF9QU1IyX0VOQUJMRSk7DQo+ID4gKwkJCSAgICBpbnRlbF9kZV9yZWFkKGRldl9w
cml2LA0KPiA+IEVEUF9QU1IyX0NUTCh0cmFuc2NvZGVyKSkgJiBFRFBfUFNSMl9FTkFCTEUpOw0K
PiA+ICANCj4gPiAgCWRybV9XQVJOX09OKCZkZXZfcHJpdi0+ZHJtLA0KPiA+IC0JCSAgICBpbnRl
bF9kZV9yZWFkKGRldl9wcml2LCBFRFBfUFNSX0NUTChkZXZfcHJpdi0NCj4gPiA+cHNyLnRyYW5z
Y29kZXIpKSAmIEVEUF9QU1JfRU5BQkxFKTsNCj4gPiAtCWRybV9XQVJOX09OKCZkZXZfcHJpdi0+
ZHJtLCBkZXZfcHJpdi0+cHNyLmFjdGl2ZSk7DQo+ID4gLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZk
ZXZfcHJpdi0+cHNyLmxvY2spOw0KPiA+ICsJCSAgICBpbnRlbF9kZV9yZWFkKGRldl9wcml2LCBF
RFBfUFNSX0NUTCh0cmFuc2NvZGVyKSkgJg0KPiA+IEVEUF9QU1JfRU5BQkxFKTsNCj4gPiArCWRy
bV9XQVJOX09OKCZkZXZfcHJpdi0+ZHJtLCBpbnRlbF9kcC0+cHNyLmFjdGl2ZSk7DQo+ID4gKwls
b2NrZGVwX2Fzc2VydF9oZWxkKCZpbnRlbF9kcC0+cHNyLmxvY2spOw0KPiA+ICANCj4gPiAgCS8q
IHBzcjEgYW5kIHBzcjIgYXJlIG11dHVhbGx5IGV4Y2x1c2l2ZS4qLw0KPiA+IC0JaWYgKGRldl9w
cml2LT5wc3IucHNyMl9lbmFibGVkKQ0KPiA+ICsJaWYgKGludGVsX2RwLT5wc3IucHNyMl9lbmFi
bGVkKQ0KPiA+ICAJCWhzd19hY3RpdmF0ZV9wc3IyKGludGVsX2RwKTsNCj4gPiAgCWVsc2UNCj4g
PiAgCQloc3dfYWN0aXZhdGVfcHNyMShpbnRlbF9kcCk7DQo+ID4gIA0KPiA+IC0JZGV2X3ByaXYt
PnBzci5hY3RpdmUgPSB0cnVlOw0KPiA+ICsJaW50ZWxfZHAtPnBzci5hY3RpdmUgPSB0cnVlOw0K
PiA+ICB9DQo+ID4gIA0KPiA+ICBzdGF0aWMgdm9pZCBpbnRlbF9wc3JfZW5hYmxlX3NvdXJjZShz
dHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLA0KPiA+IEBAIC05MDIsNyArODk3LDcgQEAgc3RhdGlj
IHZvaWQgaW50ZWxfcHNyX2VuYWJsZV9zb3VyY2Uoc3RydWN0DQo+ID4gaW50ZWxfZHAgKmludGVs
X2RwLA0KPiA+ICAJaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElTX0JST0FEV0VMTChkZXZf
cHJpdikpDQo+ID4gIAkJaHN3X3Bzcl9zZXR1cF9hdXgoaW50ZWxfZHApOw0KPiA+ICANCj4gPiAt
CWlmIChkZXZfcHJpdi0+cHNyLnBzcjJfZW5hYmxlZCAmJiAoSVNfR0VOKGRldl9wcml2LCA5KSAm
Jg0KPiA+ICsJaWYgKGludGVsX2RwLT5wc3IucHNyMl9lbmFibGVkICYmIChJU19HRU4oZGV2X3By
aXYsIDkpICYmDQo+ID4gIAkJCQkJICAgIUlTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKSkgew0KPiA+
ICAJCWk5MTVfcmVnX3QgcmVnID0gQ0hJQ0tFTl9UUkFOUyhjcHVfdHJhbnNjb2Rlcik7DQo+ID4g
IAkJdTMyIGNoaWNrZW4gPSBpbnRlbF9kZV9yZWFkKGRldl9wcml2LCByZWcpOw0KPiA+IEBAIC05
MjYsMTAgKzkyMSwxMCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wc3JfZW5hYmxlX3NvdXJjZShzdHJ1
Y3QNCj4gPiBpbnRlbF9kcCAqaW50ZWxfZHAsDQo+ID4gIAlpZiAoSU5URUxfR0VOKGRldl9wcml2
KSA8IDExKQ0KPiA+ICAJCW1hc2sgfD0gRURQX1BTUl9ERUJVR19NQVNLX0RJU1BfUkVHX1dSSVRF
Ow0KPiA+ICANCj4gPiAtCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBFRFBfUFNSX0RFQlVHKGRl
dl9wcml2LQ0KPiA+ID5wc3IudHJhbnNjb2RlciksDQo+ID4gKwlpbnRlbF9kZV93cml0ZShkZXZf
cHJpdiwgRURQX1BTUl9ERUJVRyhpbnRlbF9kcC0NCj4gPiA+cHNyLnRyYW5zY29kZXIpLA0KPiA+
ICAJCSAgICAgICBtYXNrKTsNCj4gPiAgDQo+ID4gLQlwc3JfaXJxX2NvbnRyb2woZGV2X3ByaXYp
Ow0KPiA+ICsJcHNyX2lycV9jb250cm9sKGludGVsX2RwKTsNCj4gPiAgDQo+ID4gIAlpZiAoY3J0
Y19zdGF0ZS0+ZGMzY29fZXhpdGxpbmUpIHsNCj4gPiAgCQl1MzIgdmFsOw0KPiA+IEBAIC05NDcs
MzAgKzk0MiwzMCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wc3JfZW5hYmxlX3NvdXJjZShzdHJ1Y3QN
Cj4gPiBpbnRlbF9kcCAqaW50ZWxfZHAsDQo+ID4gIA0KPiA+ICAJaWYgKEhBU19QU1JfSFdfVFJB
Q0tJTkcoZGV2X3ByaXYpICYmDQo+ID4gSEFTX1BTUjJfU0VMX0ZFVENIKGRldl9wcml2KSkNCj4g
PiAgCQlpbnRlbF9kZV9ybXcoZGV2X3ByaXYsIENISUNLRU5fUEFSMV8xLA0KPiA+IElHTk9SRV9Q
U1IyX0hXX1RSQUNLSU5HLA0KPiA+IC0JCQkgICAgIGRldl9wcml2LT5wc3IucHNyMl9zZWxfZmV0
Y2hfZW5hYmxlZCA/DQo+ID4gKwkJCSAgICAgaW50ZWxfZHAtPnBzci5wc3IyX3NlbF9mZXRjaF9l
bmFibGVkID8NCj4gPiAgCQkJICAgICBJR05PUkVfUFNSMl9IV19UUkFDS0lORyA6IDApOw0KPiA+
ICB9DQo+ID4gIA0KPiA+IC1zdGF0aWMgdm9pZCBpbnRlbF9wc3JfZW5hYmxlX2xvY2tlZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZQ0KPiA+ICpkZXZfcHJpdiwNCj4gPiArc3RhdGljIHZvaWQgaW50
ZWxfcHNyX2VuYWJsZV9sb2NrZWQoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwNCj4gPiAgCQkJ
CSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZQ0KPiA+ICpjcnRjX3N0YXRlLA0KPiA+
ICAJCQkJICAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlDQo+ID4gKmNvbm5fc3Rh
dGUpDQo+ID4gIHsNCj4gPiAtCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSBkZXZfcHJpdi0+
cHNyLmRwOw0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9f
aTkxNShpbnRlbF9kcCk7DQo+ID4gIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9y
dCA9IGRwX3RvX2RpZ19wb3J0KGludGVsX2RwKTsNCj4gPiAgCXN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyID0gJmRpZ19wb3J0LT5iYXNlOw0KPiA+ICAJdTMyIHZhbDsNCj4gPiAgDQo+ID4g
LQlkcm1fV0FSTl9PTigmZGV2X3ByaXYtPmRybSwgZGV2X3ByaXYtPnBzci5lbmFibGVkKTsNCj4g
PiArCWRybV9XQVJOX09OKCZkZXZfcHJpdi0+ZHJtLCBpbnRlbF9kcC0+cHNyLmVuYWJsZWQpOw0K
PiA+ICANCj4gPiAtCWRldl9wcml2LT5wc3IucHNyMl9lbmFibGVkID0gY3J0Y19zdGF0ZS0+aGFz
X3BzcjI7DQo+ID4gLQlkZXZfcHJpdi0+cHNyLmJ1c3lfZnJvbnRidWZmZXJfYml0cyA9IDA7DQo+
ID4gLQlkZXZfcHJpdi0+cHNyLnBpcGUgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGku
Y3J0YyktDQo+ID4gPnBpcGU7DQo+ID4gLQlkZXZfcHJpdi0+cHNyLmRjM2NvX2VuYWJsZWQgPSAh
IWNydGNfc3RhdGUtPmRjM2NvX2V4aXRsaW5lOw0KPiA+IC0JZGV2X3ByaXYtPnBzci50cmFuc2Nv
ZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXI7DQo+ID4gKwlpbnRlbF9kcC0+cHNyLnBz
cjJfZW5hYmxlZCA9IGNydGNfc3RhdGUtPmhhc19wc3IyOw0KPiA+ICsJaW50ZWxfZHAtPnBzci5i
dXN5X2Zyb250YnVmZmVyX2JpdHMgPSAwOw0KPiA+ICsJaW50ZWxfZHAtPnBzci5waXBlID0gdG9f
aW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpLQ0KPiA+ID5waXBlOw0KPiA+ICsJaW50
ZWxfZHAtPnBzci5kYzNjb19lbmFibGVkID0gISFjcnRjX3N0YXRlLT5kYzNjb19leGl0bGluZTsN
Cj4gPiArCWludGVsX2RwLT5wc3IudHJhbnNjb2RlciA9IGNydGNfc3RhdGUtPmNwdV90cmFuc2Nv
ZGVyOw0KPiA+ICAJLyogREM1L0RDNiByZXF1aXJlcyBhdCBsZWFzdCA2IGlkbGUgZnJhbWVzICov
DQo+ID4gIAl2YWwgPSB1c2Vjc190b19qaWZmaWVzKGludGVsX2dldF9mcmFtZV90aW1lX3VzKGNy
dGNfc3RhdGUpICoNCj4gPiA2KTsNCj4gPiAtCWRldl9wcml2LT5wc3IuZGMzY29fZXhpdF9kZWxh
eSA9IHZhbDsNCj4gPiAtCWRldl9wcml2LT5wc3IucHNyMl9zZWxfZmV0Y2hfZW5hYmxlZCA9IGNy
dGNfc3RhdGUtDQo+ID4gPmVuYWJsZV9wc3IyX3NlbF9mZXRjaDsNCj4gPiArCWludGVsX2RwLT5w
c3IuZGMzY29fZXhpdF9kZWxheSA9IHZhbDsNCj4gPiArCWludGVsX2RwLT5wc3IucHNyMl9zZWxf
ZmV0Y2hfZW5hYmxlZCA9IGNydGNfc3RhdGUtDQo+ID4gPmVuYWJsZV9wc3IyX3NlbF9mZXRjaDsN
Cj4gPiAgDQo+ID4gIAkvKg0KPiA+ICAJICogSWYgYSBQU1IgZXJyb3IgaGFwcGVuZWQgYW5kIHRo
ZSBkcml2ZXIgaXMgcmVsb2FkZWQsIHRoZQ0KPiA+IEVEUF9QU1JfSUlSDQo+ID4gQEAgLTk4Miwy
NyArOTc3LDI3IEBAIHN0YXRpYyB2b2lkIGludGVsX3Bzcl9lbmFibGVfbG9ja2VkKHN0cnVjdA0K
PiA+IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LA0KPiA+ICAJICovDQo+ID4gIAlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA+PSAxMikgew0KPiA+ICAJCXZhbCA9IGludGVsX2RlX3JlYWQoZGV2
X3ByaXYsDQo+ID4gLQkJCQkgICAgVFJBTlNfUFNSX0lJUihkZXZfcHJpdi0NCj4gPiA+cHNyLnRy
YW5zY29kZXIpKTsNCj4gPiArCQkJCSAgICBUUkFOU19QU1JfSUlSKGludGVsX2RwLQ0KPiA+ID5w
c3IudHJhbnNjb2RlcikpOw0KPiA+ICAJCXZhbCAmPSBFRFBfUFNSX0VSUk9SKDApOw0KPiA+ICAJ
fSBlbHNlIHsNCj4gPiAgCQl2YWwgPSBpbnRlbF9kZV9yZWFkKGRldl9wcml2LCBFRFBfUFNSX0lJ
Uik7DQo+ID4gLQkJdmFsICY9IEVEUF9QU1JfRVJST1IoZGV2X3ByaXYtPnBzci50cmFuc2NvZGVy
KTsNCj4gPiArCQl2YWwgJj0gRURQX1BTUl9FUlJPUihpbnRlbF9kcC0+cHNyLnRyYW5zY29kZXIp
Ow0KPiA+ICAJfQ0KPiA+ICAJaWYgKHZhbCkgew0KPiA+IC0JCWRldl9wcml2LT5wc3Iuc2lua19u
b3RfcmVsaWFibGUgPSB0cnVlOw0KPiA+ICsJCWludGVsX2RwLT5wc3Iuc2lua19ub3RfcmVsaWFi
bGUgPSB0cnVlOw0KPiA+ICAJCWRybV9kYmdfa21zKCZkZXZfcHJpdi0+ZHJtLA0KPiA+ICAJCQkg
ICAgIlBTUiBpbnRlcnJ1cHRpb24gZXJyb3Igc2V0LCBub3QgZW5hYmxpbmcNCj4gPiBQU1JcbiIp
Ow0KPiA+ICAJCXJldHVybjsNCj4gPiAgCX0NCj4gPiAgDQo+ID4gIAlkcm1fZGJnX2ttcygmZGV2
X3ByaXYtPmRybSwgIkVuYWJsaW5nIFBTUiVzXG4iLA0KPiA+IC0JCSAgICBkZXZfcHJpdi0+cHNy
LnBzcjJfZW5hYmxlZCA/ICIyIiA6ICIxIik7DQo+ID4gKwkJICAgIGludGVsX2RwLT5wc3IucHNy
Ml9lbmFibGVkID8gIjIiIDogIjEiKTsNCj4gPiAgCWludGVsX2RwX2NvbXB1dGVfcHNyX3ZzY19z
ZHAoaW50ZWxfZHAsIGNydGNfc3RhdGUsIGNvbm5fc3RhdGUsDQo+ID4gLQkJCQkgICAgICZkZXZf
cHJpdi0+cHNyLnZzYyk7DQo+ID4gLQlpbnRlbF93cml0ZV9kcF92c2Nfc2RwKGVuY29kZXIsIGNy
dGNfc3RhdGUsICZkZXZfcHJpdi0NCj4gPiA+cHNyLnZzYyk7DQo+ID4gKwkJCQkgICAgICZpbnRl
bF9kcC0+cHNyLnZzYyk7DQo+ID4gKwlpbnRlbF93cml0ZV9kcF92c2Nfc2RwKGVuY29kZXIsIGNy
dGNfc3RhdGUsICZpbnRlbF9kcC0NCj4gPiA+cHNyLnZzYyk7DQo+ID4gIAlpbnRlbF9wc3JfZW5h
YmxlX3NpbmsoaW50ZWxfZHApOw0KPiA+ICAJaW50ZWxfcHNyX2VuYWJsZV9zb3VyY2UoaW50ZWxf
ZHAsIGNydGNfc3RhdGUpOw0KPiA+IC0JZGV2X3ByaXYtPnBzci5lbmFibGVkID0gdHJ1ZTsNCj4g
PiArCWludGVsX2RwLT5wc3IuZW5hYmxlZCA9IHRydWU7DQo+ID4gIA0KPiA+ICAJaW50ZWxfcHNy
X2FjdGl2YXRlKGludGVsX2RwKTsNCj4gPiAgfQ0KPiA+IEBAIC0xMDIxLDcgKzEwMTYsNyBAQCB2
b2lkIGludGVsX3Bzcl9lbmFibGUoc3RydWN0IGludGVsX2RwDQo+ID4gKmludGVsX2RwLA0KPiA+
ICB7DQo+ID4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1
KGludGVsX2RwKTsNCj4gPiAgDQo+ID4gLQlpZiAoIUNBTl9QU1IoZGV2X3ByaXYpIHx8IGRldl9w
cml2LT5wc3IuZHAgIT0gaW50ZWxfZHApDQo+ID4gKwlpZiAoIUNBTl9QU1IoaW50ZWxfZHApKQ0K
PiA+ICAJCXJldHVybjsNCj4gPiAgDQo+ID4gIAlpZiAoIWNydGNfc3RhdGUtPmhhc19wc3IpDQo+
ID4gQEAgLTEwMjksNDYgKzEwMjQsNDcgQEAgdm9pZCBpbnRlbF9wc3JfZW5hYmxlKHN0cnVjdCBp
bnRlbF9kcA0KPiA+ICppbnRlbF9kcCwNCj4gPiAgDQo+ID4gIAlkcm1fV0FSTl9PTigmZGV2X3By
aXYtPmRybSwgZGV2X3ByaXYtPmRycnMuZHApOw0KPiA+ICANCj4gPiAtCW11dGV4X2xvY2soJmRl
dl9wcml2LT5wc3IubG9jayk7DQo+ID4gLQlpbnRlbF9wc3JfZW5hYmxlX2xvY2tlZChkZXZfcHJp
diwgY3J0Y19zdGF0ZSwgY29ubl9zdGF0ZSk7DQo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2
LT5wc3IubG9jayk7DQo+ID4gKwltdXRleF9sb2NrKCZpbnRlbF9kcC0+cHNyLmxvY2spOw0KPiA+
ICsJaW50ZWxfcHNyX2VuYWJsZV9sb2NrZWQoaW50ZWxfZHAsIGNydGNfc3RhdGUsIGNvbm5fc3Rh
dGUpOw0KPiA+ICsJbXV0ZXhfdW5sb2NrKCZpbnRlbF9kcC0+cHNyLmxvY2spOw0KPiA+ICB9DQo+
ID4gIA0KPiA+IC1zdGF0aWMgdm9pZCBpbnRlbF9wc3JfZXhpdChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpDQo+ID4gK3N0YXRpYyB2b2lkIGludGVsX3Bzcl9leGl0KHN0cnVjdCBp
bnRlbF9kcCAqaW50ZWxfZHApDQo+ID4gIHsNCj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOw0KPiA+ICAJdTMyIHZhbDsNCj4gPiAg
DQo+ID4gLQlpZiAoIWRldl9wcml2LT5wc3IuYWN0aXZlKSB7DQo+ID4gLQkJaWYgKHRyYW5zY29k
ZXJfaGFzX3BzcjIoZGV2X3ByaXYsIGRldl9wcml2LQ0KPiA+ID5wc3IudHJhbnNjb2RlcikpIHsN
Cj4gPiArCWlmICghaW50ZWxfZHAtPnBzci5hY3RpdmUpIHsNCj4gPiArCQlpZiAodHJhbnNjb2Rl
cl9oYXNfcHNyMihkZXZfcHJpdiwgaW50ZWxfZHAtDQo+ID4gPnBzci50cmFuc2NvZGVyKSkgew0K
PiA+ICAJCQl2YWwgPSBpbnRlbF9kZV9yZWFkKGRldl9wcml2LA0KPiA+IC0JCQkJCSAgICBFRFBf
UFNSMl9DVEwoZGV2X3ByaXYtDQo+ID4gPnBzci50cmFuc2NvZGVyKSk7DQo+ID4gKwkJCQkJICAg
IEVEUF9QU1IyX0NUTChpbnRlbF9kcC0NCj4gPiA+cHNyLnRyYW5zY29kZXIpKTsNCj4gPiAgCQkJ
ZHJtX1dBUk5fT04oJmRldl9wcml2LT5kcm0sIHZhbCAmDQo+ID4gRURQX1BTUjJfRU5BQkxFKTsN
Cj4gPiAgCQl9DQo+ID4gIA0KPiA+ICAJCXZhbCA9IGludGVsX2RlX3JlYWQoZGV2X3ByaXYsDQo+
ID4gLQkJCQkgICAgRURQX1BTUl9DVEwoZGV2X3ByaXYtDQo+ID4gPnBzci50cmFuc2NvZGVyKSk7
DQo+ID4gKwkJCQkgICAgRURQX1BTUl9DVEwoaW50ZWxfZHAtDQo+ID4gPnBzci50cmFuc2NvZGVy
KSk7DQo+ID4gIAkJZHJtX1dBUk5fT04oJmRldl9wcml2LT5kcm0sIHZhbCAmIEVEUF9QU1JfRU5B
QkxFKTsNCj4gPiAgDQo+ID4gIAkJcmV0dXJuOw0KPiA+ICAJfQ0KPiA+ICANCj4gPiAtCWlmIChk
ZXZfcHJpdi0+cHNyLnBzcjJfZW5hYmxlZCkgew0KPiA+IC0JCXRnbF9kaXNhbGxvd19kYzNjb19v
bl9wc3IyX2V4aXQoZGV2X3ByaXYpOw0KPiA+ICsJaWYgKGludGVsX2RwLT5wc3IucHNyMl9lbmFi
bGVkKSB7DQo+ID4gKwkJdGdsX2Rpc2FsbG93X2RjM2NvX29uX3BzcjJfZXhpdChpbnRlbF9kcCk7
DQo+ID4gIAkJdmFsID0gaW50ZWxfZGVfcmVhZChkZXZfcHJpdiwNCj4gPiAtCQkJCSAgICBFRFBf
UFNSMl9DVEwoZGV2X3ByaXYtDQo+ID4gPnBzci50cmFuc2NvZGVyKSk7DQo+ID4gKwkJCQkgICAg
RURQX1BTUjJfQ1RMKGludGVsX2RwLQ0KPiA+ID5wc3IudHJhbnNjb2RlcikpOw0KPiA+ICAJCWRy
bV9XQVJOX09OKCZkZXZfcHJpdi0+ZHJtLCAhKHZhbCAmIEVEUF9QU1IyX0VOQUJMRSkpOw0KPiA+
ICAJCXZhbCAmPSB+RURQX1BTUjJfRU5BQkxFOw0KPiA+ICAJCWludGVsX2RlX3dyaXRlKGRldl9w
cml2LA0KPiA+IC0JCQkgICAgICAgRURQX1BTUjJfQ1RMKGRldl9wcml2LT5wc3IudHJhbnNjb2Rl
ciksDQo+ID4gdmFsKTsNCj4gPiArCQkJICAgICAgIEVEUF9QU1IyX0NUTChpbnRlbF9kcC0+cHNy
LnRyYW5zY29kZXIpLA0KPiA+IHZhbCk7DQo+ID4gIAl9IGVsc2Ugew0KPiA+ICAJCXZhbCA9IGlu
dGVsX2RlX3JlYWQoZGV2X3ByaXYsDQo+ID4gLQkJCQkgICAgRURQX1BTUl9DVEwoZGV2X3ByaXYt
DQo+ID4gPnBzci50cmFuc2NvZGVyKSk7DQo+ID4gKwkJCQkgICAgRURQX1BTUl9DVEwoaW50ZWxf
ZHAtDQo+ID4gPnBzci50cmFuc2NvZGVyKSk7DQo+ID4gIAkJZHJtX1dBUk5fT04oJmRldl9wcml2
LT5kcm0sICEodmFsICYgRURQX1BTUl9FTkFCTEUpKTsNCj4gPiAgCQl2YWwgJj0gfkVEUF9QU1Jf
RU5BQkxFOw0KPiA+ICAJCWludGVsX2RlX3dyaXRlKGRldl9wcml2LA0KPiA+IC0JCQkgICAgICAg
RURQX1BTUl9DVEwoZGV2X3ByaXYtPnBzci50cmFuc2NvZGVyKSwNCj4gPiB2YWwpOw0KPiA+ICsJ
CQkgICAgICAgRURQX1BTUl9DVEwoaW50ZWxfZHAtPnBzci50cmFuc2NvZGVyKSwNCj4gPiB2YWwp
Ow0KPiA+ICAJfQ0KPiA+IC0JZGV2X3ByaXYtPnBzci5hY3RpdmUgPSBmYWxzZTsNCj4gPiArCWlu
dGVsX2RwLT5wc3IuYWN0aXZlID0gZmFsc2U7DQo+ID4gIH0NCj4gPiAgDQo+ID4gIHN0YXRpYyB2
b2lkIGludGVsX3Bzcl9kaXNhYmxlX2xvY2tlZChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQ0K
PiA+IEBAIC0xMDc3LDIxICsxMDczLDIxIEBAIHN0YXRpYyB2b2lkIGludGVsX3Bzcl9kaXNhYmxl
X2xvY2tlZChzdHJ1Y3QNCj4gPiBpbnRlbF9kcCAqaW50ZWxfZHApDQo+ID4gIAlpOTE1X3JlZ190
IHBzcl9zdGF0dXM7DQo+ID4gIAl1MzIgcHNyX3N0YXR1c19tYXNrOw0KPiA+ICANCj4gPiAtCWxv
Y2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5wc3IubG9jayk7DQo+ID4gKwlsb2NrZGVwX2Fz
c2VydF9oZWxkKCZpbnRlbF9kcC0+cHNyLmxvY2spOw0KPiA+ICANCj4gPiAtCWlmICghZGV2X3By
aXYtPnBzci5lbmFibGVkKQ0KPiA+ICsJaWYgKCFpbnRlbF9kcC0+cHNyLmVuYWJsZWQpDQo+ID4g
IAkJcmV0dXJuOw0KPiA+ICANCj4gPiAgCWRybV9kYmdfa21zKCZkZXZfcHJpdi0+ZHJtLCAiRGlz
YWJsaW5nIFBTUiVzXG4iLA0KPiA+IC0JCSAgICBkZXZfcHJpdi0+cHNyLnBzcjJfZW5hYmxlZCA/
ICIyIiA6ICIxIik7DQo+ID4gKwkJICAgIGludGVsX2RwLT5wc3IucHNyMl9lbmFibGVkID8gIjIi
IDogIjEiKTsNCj4gPiAgDQo+ID4gLQlpbnRlbF9wc3JfZXhpdChkZXZfcHJpdik7DQo+ID4gKwlp
bnRlbF9wc3JfZXhpdChpbnRlbF9kcCk7DQo+ID4gIA0KPiA+IC0JaWYgKGRldl9wcml2LT5wc3Iu
cHNyMl9lbmFibGVkKSB7DQo+ID4gLQkJcHNyX3N0YXR1cyA9IEVEUF9QU1IyX1NUQVRVUyhkZXZf
cHJpdi0+cHNyLnRyYW5zY29kZXIpOw0KPiA+ICsJaWYgKGludGVsX2RwLT5wc3IucHNyMl9lbmFi
bGVkKSB7DQo+ID4gKwkJcHNyX3N0YXR1cyA9IEVEUF9QU1IyX1NUQVRVUyhpbnRlbF9kcC0+cHNy
LnRyYW5zY29kZXIpOw0KPiA+ICAJCXBzcl9zdGF0dXNfbWFzayA9IEVEUF9QU1IyX1NUQVRVU19T
VEFURV9NQVNLOw0KPiA+ICAJfSBlbHNlIHsNCj4gPiAtCQlwc3Jfc3RhdHVzID0gRURQX1BTUl9T
VEFUVVMoZGV2X3ByaXYtPnBzci50cmFuc2NvZGVyKTsNCj4gPiArCQlwc3Jfc3RhdHVzID0gRURQ
X1BTUl9TVEFUVVMoaW50ZWxfZHAtPnBzci50cmFuc2NvZGVyKTsNCj4gPiAgCQlwc3Jfc3RhdHVz
X21hc2sgPSBFRFBfUFNSX1NUQVRVU19TVEFURV9NQVNLOw0KPiA+ICAJfQ0KPiA+ICANCj4gPiBA
QCAtMTEwMSw3ICsxMDk3LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfcHNyX2Rpc2FibGVfbG9ja2Vk
KHN0cnVjdA0KPiA+IGludGVsX2RwICppbnRlbF9kcCkNCj4gPiAgCQlkcm1fZXJyKCZkZXZfcHJp
di0+ZHJtLCAiVGltZWQgb3V0IHdhaXRpbmcgUFNSIGlkbGUNCj4gPiBzdGF0ZVxuIik7DQo+ID4g
IA0KPiA+ICAJLyogV0EgMTQwODMzMDg0NyAqLw0KPiA+IC0JaWYgKGRldl9wcml2LT5wc3IucHNy
Ml9zZWxfZmV0Y2hfZW5hYmxlZCAmJg0KPiA+ICsJaWYgKGludGVsX2RwLT5wc3IucHNyMl9zZWxf
ZmV0Y2hfZW5hYmxlZCAmJg0KPiA+ICAJICAgIChJU19UR0xfRElTUF9SRVZJRChkZXZfcHJpdiwg
VEdMX1JFVklEX0EwLCBUR0xfUkVWSURfQTApIHx8DQo+ID4gIAkgICAgIElTX1JLTF9SRVZJRChk
ZXZfcHJpdiwgUktMX1JFVklEX0EwLCBSS0xfUkVWSURfQTApKSkNCj4gPiAgCQlpbnRlbF9kZV9y
bXcoZGV2X3ByaXYsIENISUNLRU5fUEFSMV8xLA0KPiA+IEBAIC0xMTEwLDEwICsxMTA2LDEwIEBA
IHN0YXRpYyB2b2lkIGludGVsX3Bzcl9kaXNhYmxlX2xvY2tlZChzdHJ1Y3QNCj4gPiBpbnRlbF9k
cCAqaW50ZWxfZHApDQo+ID4gIAkvKiBEaXNhYmxlIFBTUiBvbiBTaW5rICovDQo+ID4gIAlkcm1f
ZHBfZHBjZF93cml0ZWIoJmludGVsX2RwLT5hdXgsIERQX1BTUl9FTl9DRkcsIDApOw0KPiA+ICAN
Cj4gPiAtCWlmIChkZXZfcHJpdi0+cHNyLnBzcjJfZW5hYmxlZCkNCj4gPiArCWlmIChpbnRlbF9k
cC0+cHNyLnBzcjJfZW5hYmxlZCkNCj4gPiAgCQlkcm1fZHBfZHBjZF93cml0ZWIoJmludGVsX2Rw
LT5hdXgsDQo+ID4gRFBfUkVDRUlWRVJfQUxQTV9DT05GSUcsIDApOw0KPiA+ICANCj4gPiAtCWRl
dl9wcml2LT5wc3IuZW5hYmxlZCA9IGZhbHNlOw0KPiA+ICsJaW50ZWxfZHAtPnBzci5lbmFibGVk
ID0gZmFsc2U7DQo+ID4gIH0NCj4gPiAgDQo+ID4gIC8qKg0KPiA+IEBAIC0xMTMxLDIwICsxMTI3
LDIyIEBAIHZvaWQgaW50ZWxfcHNyX2Rpc2FibGUoc3RydWN0IGludGVsX2RwDQo+ID4gKmludGVs
X2RwLA0KPiA+ICAJaWYgKCFvbGRfY3J0Y19zdGF0ZS0+aGFzX3BzcikNCj4gPiAgCQlyZXR1cm47
DQo+ID4gIA0KPiA+IC0JaWYgKGRybV9XQVJOX09OKCZkZXZfcHJpdi0+ZHJtLCAhQ0FOX1BTUihk
ZXZfcHJpdikpKQ0KPiA+ICsJaWYgKGRybV9XQVJOX09OKCZkZXZfcHJpdi0+ZHJtLCAhQ0FOX1BT
UihpbnRlbF9kcCkpKQ0KPiA+ICAJCXJldHVybjsNCj4gPiAgDQo+ID4gLQltdXRleF9sb2NrKCZk
ZXZfcHJpdi0+cHNyLmxvY2spOw0KPiA+ICsJbXV0ZXhfbG9jaygmaW50ZWxfZHAtPnBzci5sb2Nr
KTsNCj4gPiAgDQo+ID4gIAlpbnRlbF9wc3JfZGlzYWJsZV9sb2NrZWQoaW50ZWxfZHApOw0KPiA+
ICANCj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPnBzci5sb2NrKTsNCj4gPiAtCWNhbmNl
bF93b3JrX3N5bmMoJmRldl9wcml2LT5wc3Iud29yayk7DQo+ID4gLQljYW5jZWxfZGVsYXllZF93
b3JrX3N5bmMoJmRldl9wcml2LT5wc3IuZGMzY29fd29yayk7DQo+ID4gKwltdXRleF91bmxvY2so
JmludGVsX2RwLT5wc3IubG9jayk7DQo+ID4gKwljYW5jZWxfd29ya19zeW5jKCZpbnRlbF9kcC0+
cHNyLndvcmspOw0KPiA+ICsJY2FuY2VsX2RlbGF5ZWRfd29ya19zeW5jKCZpbnRlbF9kcC0+cHNy
LmRjM2NvX3dvcmspOw0KPiA+ICB9DQo+ID4gIA0KPiA+IC1zdGF0aWMgdm9pZCBwc3JfZm9yY2Vf
aHdfdHJhY2tpbmdfZXhpdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZQ0KPiA+ICpkZXZfcHJpdikN
Cj4gPiArc3RhdGljIHZvaWQgcHNyX2ZvcmNlX2h3X3RyYWNraW5nX2V4aXQoc3RydWN0IGludGVs
X2RwICppbnRlbF9kcCkNCj4gPiAgew0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7DQo+ID4gKw0KPiA+ICAJaWYgKElTX1RJR0VS
TEFLRShkZXZfcHJpdikpDQo+ID4gIAkJLyoNCj4gPiAgCQkgKiBXcml0ZXMgdG8gQ1VSU1VSRkxJ
VkUgaW4gVEdMIGFyZSBjYXVzaW5nIElPTU1VDQo+ID4gZXJyb3JzIGFuZA0KPiA+IEBAIC0xMTU4
LDcgKzExNTYsNyBAQCBzdGF0aWMgdm9pZCBwc3JfZm9yY2VfaHdfdHJhY2tpbmdfZXhpdChzdHJ1
Y3QNCj4gPiBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikNCj4gPiAgCQkgKiBTbyB1c2luZyB0
aGlzIHdvcmthcm91bmQgdW50aWwgdGhpcyBpc3N1ZSBpcyByb290DQo+ID4gY2F1c2VkDQo+ID4g
IAkJICogYW5kIGEgYmV0dGVyIGZpeCBpcyBmb3VuZC4NCj4gPiAgCQkgKi8NCj4gPiAtCQlpbnRl
bF9wc3JfZXhpdChkZXZfcHJpdik7DQo+ID4gKwkJaW50ZWxfcHNyX2V4aXQoaW50ZWxfZHApOw0K
PiA+ICAJZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KQ0KPiA+ICAJCS8qDQo+ID4g
IAkJICogRGlzcGxheSBXQSAjMDg4NDogc2tsKw0KPiA+IEBAIC0xMTY5LDEzICsxMTY3LDEzIEBA
IHN0YXRpYyB2b2lkDQo+ID4gcHNyX2ZvcmNlX2h3X3RyYWNraW5nX2V4aXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQ0KPiA+ICAJCSAqIGJ1dCBpdCBtYWtlcyBtb3JlIHNlbnNl
IHdyaXRlIHRvIHRoZSBjdXJyZW50IGFjdGl2ZQ0KPiA+ICAJCSAqIHBpcGUuDQo+ID4gIAkJICov
DQo+ID4gLQkJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIENVUlNVUkZMSVZFKGRldl9wcml2LQ0K
PiA+ID5wc3IucGlwZSksIDApOw0KPiA+ICsJCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBDVVJT
VVJGTElWRShpbnRlbF9kcC0NCj4gPiA+cHNyLnBpcGUpLCAwKTsNCj4gPiAgCWVsc2UNCj4gPiAg
CQkvKg0KPiA+ICAJCSAqIEEgd3JpdGUgdG8gQ1VSU1VSRkxJVkUgZG8gbm90IGNhdXNlIEhXIHRy
YWNraW5nIHRvDQo+ID4gZXhpdCBQU1INCj4gPiAgCQkgKiBvbiBvbGRlciBnZW5zIHNvIGRvaW5n
IHRoZSBtYW51YWwgZXhpdCBpbnN0ZWFkLg0KPiA+ICAJCSAqLw0KPiA+IC0JCWludGVsX3Bzcl9l
eGl0KGRldl9wcml2KTsNCj4gPiArCQlpbnRlbF9wc3JfZXhpdChpbnRlbF9kcCk7DQo+ID4gIH0N
Cj4gPiAgDQo+ID4gIHZvaWQgaW50ZWxfcHNyMl9wcm9ncmFtX3BsYW5lX3NlbF9mZXRjaChzdHJ1
Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLA0KPiA+IEBAIC0xMjE1LDExICsxMjEzLDExIEBAIHZvaWQN
Cj4gPiBpbnRlbF9wc3IyX3Byb2dyYW1fcGxhbmVfc2VsX2ZldGNoKHN0cnVjdCBpbnRlbF9wbGFu
ZSAqcGxhbmUsDQo+ID4gIAlpbnRlbF9kZV93cml0ZV9mdyhkZXZfcHJpdiwgUExBTkVfU0VMX0ZF
VENIX1NJWkUocGlwZSwgcGxhbmUtDQo+ID4gPmlkKSwgdmFsKTsNCj4gPiAgfQ0KPiA+ICANCj4g
PiAtdm9pZCBpbnRlbF9wc3IyX3Byb2dyYW1fdHJhbnNfbWFuX3Rya19jdGwoY29uc3Qgc3RydWN0
DQo+ID4gaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkNCj4gPiArdm9pZCBpbnRlbF9wc3Iy
X3Byb2dyYW1fdHJhbnNfbWFuX3Rya19jdGwoc3RydWN0IGludGVsX2RwDQo+ID4gKmludGVsX2Rw
LA0KPiA+ICsJCQkJCSAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUNCj4gPiAqY3J0Y19z
dGF0ZSkNCj4gPiAgew0KPiA+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9j
cnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7DQo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsNCj4gPiAtCXN0cnVjdCBpOTE1
X3BzciAqcHNyID0gJmRldl9wcml2LT5wc3I7DQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsNCj4gPiArCXN0cnVjdCBpbnRlbF9w
c3IgKnBzciA9ICZpbnRlbF9kcC0+cHNyOw0KPiA+ICANCj4gPiAgCWlmICghSEFTX1BTUjJfU0VM
X0ZFVENIKGRldl9wcml2KSB8fA0KPiA+ICAJICAgICFjcnRjX3N0YXRlLT5lbmFibGVfcHNyMl9z
ZWxfZmV0Y2gpDQo+ID4gQEAgLTEzMzYsMTMgKzEzMzQsMTMgQEAgdm9pZCBpbnRlbF9wc3JfdXBk
YXRlKHN0cnVjdCBpbnRlbF9kcA0KPiA+ICppbnRlbF9kcCwNCj4gPiAgCQkgICAgICBjb25zdCBz
dHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkNCj4gPiAgew0KPiA+ICAJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7DQo+
ID4gLQlzdHJ1Y3QgaTkxNV9wc3IgKnBzciA9ICZkZXZfcHJpdi0+cHNyOw0KPiA+ICsJc3RydWN0
IGludGVsX3BzciAqcHNyID0gJmludGVsX2RwLT5wc3I7DQo+ID4gIAlib29sIGVuYWJsZSwgcHNy
Ml9lbmFibGU7DQo+ID4gIA0KPiA+IC0JaWYgKCFDQU5fUFNSKGRldl9wcml2KSB8fCBSRUFEX09O
Q0UocHNyLT5kcCkgIT0gaW50ZWxfZHApDQo+ID4gKwlpZiAoIUNBTl9QU1IoaW50ZWxfZHApKQ0K
PiA+ICAJCXJldHVybjsNCj4gPiAgDQo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+cHNyLmxv
Y2spOw0KPiA+ICsJbXV0ZXhfbG9jaygmaW50ZWxfZHAtPnBzci5sb2NrKTsNCj4gPiAgDQo+ID4g
IAllbmFibGUgPSBjcnRjX3N0YXRlLT5oYXNfcHNyOw0KPiA+ICAJcHNyMl9lbmFibGUgPSBjcnRj
X3N0YXRlLT5oYXNfcHNyMjsNCj4gPiBAQCAtMTM1MCwxNSArMTM0OCwxNSBAQCB2b2lkIGludGVs
X3Bzcl91cGRhdGUoc3RydWN0IGludGVsX2RwDQo+ID4gKmludGVsX2RwLA0KPiA+ICAJaWYgKGVu
YWJsZSA9PSBwc3ItPmVuYWJsZWQgJiYgcHNyMl9lbmFibGUgPT0gcHNyLT5wc3IyX2VuYWJsZWQp
IA0KPiA+IHsNCj4gPiAgCQkvKiBGb3JjZSBhIFBTUiBleGl0IHdoZW4gZW5hYmxpbmcgQ1JDIHRv
IGF2b2lkIENSQw0KPiA+IHRpbWVvdXRzICovDQo+ID4gIAkJaWYgKGNydGNfc3RhdGUtPmNyY19l
bmFibGVkICYmIHBzci0+ZW5hYmxlZCkNCj4gPiAtCQkJcHNyX2ZvcmNlX2h3X3RyYWNraW5nX2V4
aXQoZGV2X3ByaXYpOw0KPiA+ICsJCQlwc3JfZm9yY2VfaHdfdHJhY2tpbmdfZXhpdChpbnRlbF9k
cCk7DQo+ID4gIAkJZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDkgJiYgcHNyLT5lbmFi
bGVkKSB7DQo+ID4gIAkJCS8qDQo+ID4gIAkJCSAqIEFjdGl2YXRlIFBTUiBhZ2FpbiBhZnRlciBh
IGZvcmNlIGV4aXQgd2hlbg0KPiA+IGVuYWJsaW5nDQo+ID4gIAkJCSAqIENSQyBpbiBvbGRlciBn
ZW5zDQo+ID4gIAkJCSAqLw0KPiA+IC0JCQlpZiAoIWRldl9wcml2LT5wc3IuYWN0aXZlICYmDQo+
ID4gLQkJCSAgICAhZGV2X3ByaXYtPnBzci5idXN5X2Zyb250YnVmZmVyX2JpdHMpDQo+ID4gLQkJ
CQlzY2hlZHVsZV93b3JrKCZkZXZfcHJpdi0+cHNyLndvcmspOw0KPiA+ICsJCQlpZiAoIWludGVs
X2RwLT5wc3IuYWN0aXZlICYmDQo+ID4gKwkJCSAgICAhaW50ZWxfZHAtPnBzci5idXN5X2Zyb250
YnVmZmVyX2JpdHMpDQo+ID4gKwkJCQlzY2hlZHVsZV93b3JrKCZpbnRlbF9kcC0+cHNyLndvcmsp
Ow0KPiA+ICAJCX0NCj4gPiAgDQo+ID4gIAkJZ290byB1bmxvY2s7DQo+ID4gQEAgLTEzNjgsMzQg
KzEzNjYsMjMgQEAgdm9pZCBpbnRlbF9wc3JfdXBkYXRlKHN0cnVjdCBpbnRlbF9kcA0KPiA+ICpp
bnRlbF9kcCwNCj4gPiAgCQlpbnRlbF9wc3JfZGlzYWJsZV9sb2NrZWQoaW50ZWxfZHApOw0KPiA+
ICANCj4gPiAgCWlmIChlbmFibGUpDQo+ID4gLQkJaW50ZWxfcHNyX2VuYWJsZV9sb2NrZWQoZGV2
X3ByaXYsIGNydGNfc3RhdGUsDQo+ID4gY29ubl9zdGF0ZSk7DQo+ID4gKwkJaW50ZWxfcHNyX2Vu
YWJsZV9sb2NrZWQoaW50ZWxfZHAsIGNydGNfc3RhdGUsDQo+ID4gY29ubl9zdGF0ZSk7DQo+ID4g
IA0KPiA+ICB1bmxvY2s6DQo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5wc3IubG9jayk7
DQo+ID4gKwltdXRleF91bmxvY2soJmludGVsX2RwLT5wc3IubG9jayk7DQo+ID4gIH0NCj4gPiAg
DQo+ID4gIC8qKg0KPiA+IC0gKiBpbnRlbF9wc3Jfd2FpdF9mb3JfaWRsZSAtIHdhaXQgZm9yIFBT
UjEgdG8gaWRsZQ0KPiA+IC0gKiBAbmV3X2NydGNfc3RhdGU6IG5ldyBDUlRDIHN0YXRlDQo+ID4g
KyAqIHBzcl93YWl0X2Zvcl9pZGxlIC0gd2FpdCBmb3IgUFNSMSB0byBpZGxlDQo+ID4gKyAqIEBp
bnRlbF9kcDogSW50ZWwgRFANCj4gPiAgICogQG91dF92YWx1ZTogUFNSIHN0YXR1cyBpbiBjYXNl
IG9mIGZhaWx1cmUNCj4gPiAgICoNCj4gPiAtICogVGhpcyBmdW5jdGlvbiBpcyBleHBlY3RlZCB0
byBiZSBjYWxsZWQgZnJvbSBwaXBlX3VwZGF0ZV9zdGFydCgpDQo+ID4gd2hlcmUgaXQgaXMNCj4g
PiAtICogbm90IGV4cGVjdGVkIHRvIHJhY2Ugd2l0aCBQU1IgZW5hYmxlIG9yIGRpc2FibGUuDQo+
ID4gLSAqDQo+ID4gICAqIFJldHVybnM6IDAgb24gc3VjY2VzcyBvciAtRVRJTUVPVVQgaWYgUFNS
IHN0YXR1cyBkb2VzIG5vdCBpZGxlLg0KPiA+ICsgKg0KPiA+ICAgKi8NCj4gPiAtaW50IGludGVs
X3Bzcl93YWl0X2Zvcl9pZGxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlDQo+ID4gKm5l
d19jcnRjX3N0YXRlLA0KPiA+IC0JCQkgICAgdTMyICpvdXRfdmFsdWUpDQo+ID4gK3N0YXRpYyBp
bnQgcHNyX3dhaXRfZm9yX2lkbGUoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwgdTMyDQo+ID4g
Km91dF92YWx1ZSkNCj4gPiAgew0KPiA+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19p
bnRlbF9jcnRjKG5ld19jcnRjX3N0YXRlLQ0KPiA+ID51YXBpLmNydGMpOw0KPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7DQo+
ID4gLQ0KPiA+IC0JaWYgKCFkZXZfcHJpdi0+cHNyLmVuYWJsZWQgfHwgIW5ld19jcnRjX3N0YXRl
LT5oYXNfcHNyKQ0KPiA+IC0JCXJldHVybiAwOw0KPiA+IC0NCj4gPiAtCS8qIEZJWE1FOiBVcGRh
dGUgdGhpcyBmb3IgUFNSMiBpZiB3ZSBuZWVkIHRvIHdhaXQgZm9yIGlkbGUgKi8NCj4gPiAtCWlm
IChSRUFEX09OQ0UoZGV2X3ByaXYtPnBzci5wc3IyX2VuYWJsZWQpKQ0KPiA+IC0JCXJldHVybiAw
Ow0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShp
bnRlbF9kcCk7DQo+ID4gIA0KPiA+ICAJLyoNCj4gPiAgCSAqIEZyb20gYnNwZWM6IFBhbmVsIFNl
bGYgUmVmcmVzaCAoQkRXKykNCj4gPiBAQCAtMTQwMywzMiArMTM5MCw2NyBAQCBpbnQgaW50ZWxf
cHNyX3dhaXRfZm9yX2lkbGUoY29uc3Qgc3RydWN0DQo+ID4gaW50ZWxfY3J0Y19zdGF0ZSAqbmV3
X2NydGNfc3RhdGUsDQo+ID4gIAkgKiBleGl0IHRyYWluaW5nIHRpbWUgKyAxLjUgbXMgb2YgYXV4
IGNoYW5uZWwgaGFuZHNoYWtlLiA1MCBtcw0KPiA+IGlzDQo+ID4gIAkgKiBkZWZlbnNpdmUgZW5v
dWdoIHRvIGNvdmVyIGV2ZXJ5dGhpbmcuDQo+ID4gIAkgKi8NCj4gPiAtDQo+ID4gIAlyZXR1cm4g
X19pbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwNCj4gPiAtCQkJCQkg
RURQX1BTUl9TVEFUVVMoZGV2X3ByaXYtDQo+ID4gPnBzci50cmFuc2NvZGVyKSwNCj4gPiArCQkJ
CQkgRURQX1BTUl9TVEFUVVMoaW50ZWxfZHAtDQo+ID4gPnBzci50cmFuc2NvZGVyKSwNCj4gPiAg
CQkJCQkgRURQX1BTUl9TVEFUVVNfU1RBVEVfTUFTSywNCj4gPiAgCQkJCQkgRURQX1BTUl9TVEFU
VVNfU1RBVEVfSURMRSwgMiwNCj4gPiA1MCwNCj4gPiAgCQkJCQkgb3V0X3ZhbHVlKTsNCj4gPiAg
fQ0KPiA+ICANCj4gPiAtc3RhdGljIGJvb2wgX19wc3Jfd2FpdF9mb3JfaWRsZV9sb2NrZWQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUNCj4gPiAqZGV2X3ByaXYpDQo+ID4gKy8qKg0KPiA+ICsgKiBp
bnRlbF9wc3Jfd2FpdF9mb3JfaWRsZSAtIHdhaXQgZm9yIFBTUjEgdG8gaWRsZQ0KPiA+ICsgKiBA
bmV3X2NydGNfc3RhdGU6IG5ldyBDUlRDIHN0YXRlDQo+ID4gKyAqDQo+ID4gKyAqIFRoaXMgZnVu
Y3Rpb24gaXMgZXhwZWN0ZWQgdG8gYmUgY2FsbGVkIGZyb20gcGlwZV91cGRhdGVfc3RhcnQoKQ0K
PiA+IHdoZXJlIGl0IGlzDQo+ID4gKyAqIG5vdCBleHBlY3RlZCB0byByYWNlIHdpdGggUFNSIGVu
YWJsZSBvciBkaXNhYmxlLg0KPiA+ICsgKi8NCj4gPiArdm9pZCBpbnRlbF9wc3Jfd2FpdF9mb3Jf
aWRsZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZQ0KPiA+ICpuZXdfY3J0Y19zdGF0ZSkN
Cj4gPiArew0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShuZXdfY3J0Y19zdGF0ZS0NCj4gPiA+dWFwaS5jcnRjLT5kZXYpOw0KPiA+ICsJc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXI7DQo+ID4gKwl1MzIgcHNyX3N0YXR1czsNCj4gPiArDQo+ID4g
KwlpZiAoIW5ld19jcnRjX3N0YXRlLT5oYXNfcHNyKQ0KPiA+ICsJCXJldHVybjsNCj4gPiArDQo+
ID4gKwlmb3JfZWFjaF9pbnRlbF9kcCgmZGV2X3ByaXYtPmRybSwgZW5jb2Rlcikgew0KPiA+ICsJ
CXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSBlbmNfdG9faW50ZWxfZHAoZW5jb2Rlcik7DQo+
ID4gKw0KPiA+ICsJCWlmIChlbmNvZGVyLT50eXBlICE9IElOVEVMX09VVFBVVF9FRFApDQo+ID4g
KwkJCWNvbnRpbnVlOw0KPiA+ICsNCj4gPiArCQkvKiB3aGVuIHRoZSBQU1IxIGlzIGVuYWJsZWQg
Ki8NCj4gPiArCQlpZiAoaW50ZWxfZHAtPnBzci5lbmFibGVkICYmICFpbnRlbF9kcC0NCj4gPiA+
cHNyLnBzcjJfZW5hYmxlZCkgew0KPiA+ICsJCQlpZiAocHNyX3dhaXRfZm9yX2lkbGUoaW50ZWxf
ZHAsICZwc3Jfc3RhdHVzKSkNCj4gPiArCQkJCWRybV9lcnIoJmRldl9wcml2LT5kcm0sDQo+ID4g
KwkJCQkJIlBTUiBpZGxlIHRpbWVkIG91dCAweCV4LA0KPiA+IGF0b21pYyB1cGRhdGUgbWF5IGZh
aWxcbiIsDQo+ID4gKwkJCQkJcHNyX3N0YXR1cyk7DQo+ID4gKw0KPiA+ICsJCQkvKiBvbmx5IG9u
ZSB0cmFuY29kZXIgY2FuIGVuYWJsZSBQU1IxICovDQo+IAkJCUFib3ZlIGNvbW1lbnQgaXMgbm90
IHRydWUgZm9yIGR1YWwgZURQLg0KPiAJCQlTaW5jZSBUR0wgRE1DIHN1cHBvcnQgY29udGV4dCBz
YXZlIGFuZCByZXN0b3JlDQo+IG9uDQo+IAkJCWJvdGggcGlwZSBBIGFuZCBwaXBlIEIuDQo+ID4g
KwkJCWJyZWFrOw0KPiA+ICsJCX0NCj4gPiArCX0NCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGlj
IGJvb2wgX19wc3Jfd2FpdF9mb3JfaWRsZV9sb2NrZWQoc3RydWN0IGludGVsX2RwICppbnRlbF9k
cCkNCj4gPiAgew0KPiA+ICAJaTkxNV9yZWdfdCByZWc7DQo+ID4gIAl1MzIgbWFzazsNCj4gPiAg
CWludCBlcnI7DQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90
b19pOTE1KGludGVsX2RwKTsNCj4gPiAgDQo+ID4gLQlpZiAoIWRldl9wcml2LT5wc3IuZW5hYmxl
ZCkNCj4gPiArCWlmICghaW50ZWxfZHAtPnBzci5lbmFibGVkKQ0KPiA+ICAJCXJldHVybiBmYWxz
ZTsNCj4gPiAgDQo+ID4gLQlpZiAoZGV2X3ByaXYtPnBzci5wc3IyX2VuYWJsZWQpIHsNCj4gPiAt
CQlyZWcgPSBFRFBfUFNSMl9TVEFUVVMoZGV2X3ByaXYtPnBzci50cmFuc2NvZGVyKTsNCj4gPiAr
CWlmIChpbnRlbF9kcC0+cHNyLnBzcjJfZW5hYmxlZCkgew0KPiA+ICsJCXJlZyA9IEVEUF9QU1Iy
X1NUQVRVUyhpbnRlbF9kcC0+cHNyLnRyYW5zY29kZXIpOw0KPiA+ICAJCW1hc2sgPSBFRFBfUFNS
Ml9TVEFUVVNfU1RBVEVfTUFTSzsNCj4gPiAgCX0gZWxzZSB7DQo+ID4gLQkJcmVnID0gRURQX1BT
Ul9TVEFUVVMoZGV2X3ByaXYtPnBzci50cmFuc2NvZGVyKTsNCj4gPiArCQlyZWcgPSBFRFBfUFNS
X1NUQVRVUyhpbnRlbF9kcC0+cHNyLnRyYW5zY29kZXIpOw0KPiA+ICAJCW1hc2sgPSBFRFBfUFNS
X1NUQVRVU19TVEFURV9NQVNLOw0KPiA+ICAJfQ0KPiA+ICANCj4gPiAtCW11dGV4X3VubG9jaygm
ZGV2X3ByaXYtPnBzci5sb2NrKTsNCj4gPiArCW11dGV4X3VubG9jaygmaW50ZWxfZHAtPnBzci5s
b2NrKTsNCj4gPiAgDQo+ID4gIAllcnIgPSBpbnRlbF9kZV93YWl0X2Zvcl9jbGVhcihkZXZfcHJp
diwgcmVnLCBtYXNrLCA1MCk7DQo+ID4gIAlpZiAoZXJyKQ0KPiA+IEBAIC0xNDM2LDggKzE0NTgs
OCBAQCBzdGF0aWMgYm9vbCBfX3Bzcl93YWl0X2Zvcl9pZGxlX2xvY2tlZChzdHJ1Y3QNCj4gPiBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikNCj4gPiAgCQkJIlRpbWVkIG91dCB3YWl0aW5nIGZv
ciBQU1IgSWRsZSBmb3IgcmUtDQo+ID4gZW5hYmxlXG4iKTsNCj4gPiAgDQo+ID4gIAkvKiBBZnRl
ciB0aGUgdW5sb2NrZWQgd2FpdCwgdmVyaWZ5IHRoYXQgUFNSIGlzIHN0aWxsIHdhbnRlZCEgKi8N
Cj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5wc3IubG9jayk7DQo+ID4gLQlyZXR1cm4gZXJy
ID09IDAgJiYgZGV2X3ByaXYtPnBzci5lbmFibGVkOw0KPiA+ICsJbXV0ZXhfbG9jaygmaW50ZWxf
ZHAtPnBzci5sb2NrKTsNCj4gPiArCXJldHVybiBlcnIgPT0gMCAmJiBpbnRlbF9kcC0+cHNyLmVu
YWJsZWQ7DQo+ID4gIH0NCj4gPiAgDQo+ID4gIHN0YXRpYyBpbnQgaW50ZWxfcHNyX2Zhc3RzZXRf
Zm9yY2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUNCj4gPiAqZGV2X3ByaXYpDQo+ID4gQEAgLTE1
MDMsMTEgKzE1MjUsMTIgQEAgc3RhdGljIGludCBpbnRlbF9wc3JfZmFzdHNldF9mb3JjZShzdHJ1
Y3QNCj4gPiBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikNCj4gPiAgCXJldHVybiBlcnI7DQo+
ID4gIH0NCj4gPiAgDQo+ID4gLWludCBpbnRlbF9wc3JfZGVidWdfc2V0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwgdTY0DQo+ID4gdmFsKQ0KPiA+ICtpbnQgaW50ZWxfcHNyX2Rl
YnVnX3NldChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLCB1NjQgdmFsKQ0KPiA+ICB7DQo+ID4g
IAljb25zdCB1MzIgbW9kZSA9IHZhbCAmIEk5MTVfUFNSX0RFQlVHX01PREVfTUFTSzsNCj4gPiAg
CXUzMiBvbGRfbW9kZTsNCj4gPiAgCWludCByZXQ7DQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsNCj4gPiAgDQo+ID4gIAlpZiAo
dmFsICYgfihJOTE1X1BTUl9ERUJVR19JUlEgfCBJOTE1X1BTUl9ERUJVR19NT0RFX01BU0spIHx8
DQo+ID4gIAkgICAgbW9kZSA+IEk5MTVfUFNSX0RFQlVHX0ZPUkNFX1BTUjEpIHsNCj4gPiBAQCAt
MTUxNSwyMSArMTUzOCwyMSBAQCBpbnQgaW50ZWxfcHNyX2RlYnVnX3NldChzdHJ1Y3QNCj4gPiBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTY0IHZhbCkNCj4gPiAgCQlyZXR1cm4gLUVJTlZB
TDsNCj4gPiAgCX0NCj4gPiAgDQo+ID4gLQlyZXQgPSBtdXRleF9sb2NrX2ludGVycnVwdGlibGUo
JmRldl9wcml2LT5wc3IubG9jayk7DQo+ID4gKwlyZXQgPSBtdXRleF9sb2NrX2ludGVycnVwdGli
bGUoJmludGVsX2RwLT5wc3IubG9jayk7DQo+ID4gIAlpZiAocmV0KQ0KPiA+ICAJCXJldHVybiBy
ZXQ7DQo+ID4gIA0KPiA+IC0Jb2xkX21vZGUgPSBkZXZfcHJpdi0+cHNyLmRlYnVnICYgSTkxNV9Q
U1JfREVCVUdfTU9ERV9NQVNLOw0KPiA+IC0JZGV2X3ByaXYtPnBzci5kZWJ1ZyA9IHZhbDsNCj4g
PiArCW9sZF9tb2RlID0gaW50ZWxfZHAtPnBzci5kZWJ1ZyAmIEk5MTVfUFNSX0RFQlVHX01PREVf
TUFTSzsNCj4gPiArCWludGVsX2RwLT5wc3IuZGVidWcgPSB2YWw7DQo+ID4gIA0KPiA+ICAJLyoN
Cj4gPiAgCSAqIERvIGl0IHJpZ2h0IGF3YXkgaWYgaXQncyBhbHJlYWR5IGVuYWJsZWQsIG90aGVy
d2lzZSBpdCB3aWxsDQo+ID4gYmUgZG9uZQ0KPiA+ICAJICogd2hlbiBlbmFibGluZyB0aGUgc291
cmNlLg0KPiA+ICAJICovDQo+ID4gLQlpZiAoZGV2X3ByaXYtPnBzci5lbmFibGVkKQ0KPiA+IC0J
CXBzcl9pcnFfY29udHJvbChkZXZfcHJpdik7DQo+ID4gKwlpZiAoaW50ZWxfZHAtPnBzci5lbmFi
bGVkKQ0KPiA+ICsJCXBzcl9pcnFfY29udHJvbChpbnRlbF9kcCk7DQo+ID4gIA0KPiA+IC0JbXV0
ZXhfdW5sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2spOw0KPiA+ICsJbXV0ZXhfdW5sb2NrKCZpbnRl
bF9kcC0+cHNyLmxvY2spOw0KPiA+ICANCj4gPiAgCWlmIChvbGRfbW9kZSAhPSBtb2RlKQ0KPiA+
ICAJCXJldCA9IGludGVsX3Bzcl9mYXN0c2V0X2ZvcmNlKGRldl9wcml2KTsNCj4gPiBAQCAtMTUz
NywyOCArMTU2MCwyOCBAQCBpbnQgaW50ZWxfcHNyX2RlYnVnX3NldChzdHJ1Y3QNCj4gPiBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTY0IHZhbCkNCj4gPiAgCXJldHVybiByZXQ7DQo+ID4g
IH0NCj4gPiAgDQo+ID4gLXN0YXRpYyB2b2lkIGludGVsX3Bzcl9oYW5kbGVfaXJxKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlDQo+ID4gKmRldl9wcml2KQ0KPiA+ICtzdGF0aWMgdm9pZCBpbnRlbF9w
c3JfaGFuZGxlX2lycShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQ0KPiA+ICB7DQo+ID4gLQlz
dHJ1Y3QgaTkxNV9wc3IgKnBzciA9ICZkZXZfcHJpdi0+cHNyOw0KPiA+ICsJc3RydWN0IGludGVs
X3BzciAqcHNyID0gJmludGVsX2RwLT5wc3I7DQo+ID4gIA0KPiA+IC0JaW50ZWxfcHNyX2Rpc2Fi
bGVfbG9ja2VkKHBzci0+ZHApOw0KPiA+ICsJaW50ZWxfcHNyX2Rpc2FibGVfbG9ja2VkKGludGVs
X2RwKTsNCj4gPiAgCXBzci0+c2lua19ub3RfcmVsaWFibGUgPSB0cnVlOw0KPiA+ICAJLyogbGV0
J3MgbWFrZSBzdXJlIHRoYXQgc2luayBpcyBhd2FrZW4gKi8NCj4gPiAtCWRybV9kcF9kcGNkX3dy
aXRlYigmcHNyLT5kcC0+YXV4LCBEUF9TRVRfUE9XRVIsDQo+ID4gRFBfU0VUX1BPV0VSX0QwKTsN
Cj4gPiArCWRybV9kcF9kcGNkX3dyaXRlYigmaW50ZWxfZHAtPmF1eCwgRFBfU0VUX1BPV0VSLA0K
PiA+IERQX1NFVF9QT1dFUl9EMCk7DQo+ID4gIH0NCj4gPiAgDQo+ID4gIHN0YXRpYyB2b2lkIGlu
dGVsX3Bzcl93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykNCj4gPiAgew0KPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0NCj4gPiAtCQljb250YWluZXJfb2Yod29y
aywgdHlwZW9mKCpkZXZfcHJpdiksIHBzci53b3JrKTsNCj4gPiArCXN0cnVjdCBpbnRlbF9kcCAq
aW50ZWxfZHAgPQ0KPiA+ICsJCWNvbnRhaW5lcl9vZih3b3JrLCB0eXBlb2YoKmludGVsX2RwKSwg
cHNyLndvcmspOw0KPiA+ICANCj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5wc3IubG9jayk7
DQo+ID4gKwltdXRleF9sb2NrKCZpbnRlbF9kcC0+cHNyLmxvY2spOw0KPiA+ICANCj4gPiAtCWlm
ICghZGV2X3ByaXYtPnBzci5lbmFibGVkKQ0KPiA+ICsJaWYgKCFpbnRlbF9kcC0+cHNyLmVuYWJs
ZWQpDQo+ID4gIAkJZ290byB1bmxvY2s7DQo+ID4gIA0KPiA+IC0JaWYgKFJFQURfT05DRShkZXZf
cHJpdi0+cHNyLmlycV9hdXhfZXJyb3IpKQ0KPiA+IC0JCWludGVsX3Bzcl9oYW5kbGVfaXJxKGRl
dl9wcml2KTsNCj4gPiArCWlmIChSRUFEX09OQ0UoaW50ZWxfZHAtPnBzci5pcnFfYXV4X2Vycm9y
KSkNCj4gPiArCQlpbnRlbF9wc3JfaGFuZGxlX2lycShpbnRlbF9kcCk7DQo+ID4gIA0KPiA+ICAJ
LyoNCj4gPiAgCSAqIFdlIGhhdmUgdG8gbWFrZSBzdXJlIFBTUiBpcyByZWFkeSBmb3IgcmUtZW5h
YmxlDQo+ID4gQEAgLTE1NjYsNyArMTU4OSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3Bzcl93b3Jr
KHN0cnVjdCB3b3JrX3N0cnVjdA0KPiA+ICp3b3JrKQ0KPiA+ICAJICogUFNSIG1pZ2h0IHRha2Ug
c29tZSB0aW1lIHRvIGdldCBmdWxseSBkaXNhYmxlZA0KPiA+ICAJICogYW5kIGJlIHJlYWR5IGZv
ciByZS1lbmFibGUuDQo+ID4gIAkgKi8NCj4gPiAtCWlmICghX19wc3Jfd2FpdF9mb3JfaWRsZV9s
b2NrZWQoZGV2X3ByaXYpKQ0KPiA+ICsJaWYgKCFfX3Bzcl93YWl0X2Zvcl9pZGxlX2xvY2tlZChp
bnRlbF9kcCkpDQo+ID4gIAkJZ290byB1bmxvY2s7DQo+ID4gIA0KPiA+ICAJLyoNCj4gPiBAQCAt
MTU3NCwxMiArMTU5NywxMiBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wc3Jfd29yayhzdHJ1Y3QNCj4g
PiB3b3JrX3N0cnVjdCAqd29yaykNCj4gPiAgCSAqIHJlY2hlY2suIFNpbmNlIHBzcl9mbHVzaCBm
aXJzdCBjbGVhcnMgdGhpcyBhbmQgdGhlbg0KPiA+IHJlc2NoZWR1bGVzIHdlDQo+ID4gIAkgKiB3
b24ndCBldmVyIG1pc3MgYSBmbHVzaCB3aGVuIGJhaWxpbmcgb3V0IGhlcmUuDQo+ID4gIAkgKi8N
Cj4gPiAtCWlmIChkZXZfcHJpdi0+cHNyLmJ1c3lfZnJvbnRidWZmZXJfYml0cyB8fCBkZXZfcHJp
di0NCj4gPiA+cHNyLmFjdGl2ZSkNCj4gPiArCWlmIChpbnRlbF9kcC0+cHNyLmJ1c3lfZnJvbnRi
dWZmZXJfYml0cyB8fCBpbnRlbF9kcC0NCj4gPiA+cHNyLmFjdGl2ZSkNCj4gPiAgCQlnb3RvIHVu
bG9jazsNCj4gPiAgDQo+ID4gLQlpbnRlbF9wc3JfYWN0aXZhdGUoZGV2X3ByaXYtPnBzci5kcCk7
DQo+ID4gKwlpbnRlbF9wc3JfYWN0aXZhdGUoaW50ZWxfZHApOw0KPiA+ICB1bmxvY2s6DQo+ID4g
LQltdXRleF91bmxvY2soJmRldl9wcml2LT5wc3IubG9jayk7DQo+ID4gKwltdXRleF91bmxvY2so
JmludGVsX2RwLT5wc3IubG9jayk7DQo+ID4gIH0NCj4gPiAgDQo+ID4gIC8qKg0KPiA+IEBAIC0x
NTk4LDI3ICsxNjIxLDM1IEBAIHN0YXRpYyB2b2lkIGludGVsX3Bzcl93b3JrKHN0cnVjdA0KPiA+
IHdvcmtfc3RydWN0ICp3b3JrKQ0KPiA+ICB2b2lkIGludGVsX3Bzcl9pbnZhbGlkYXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwNCj4gPiAgCQkJICB1bnNpZ25lZCBmcm9udGJ1
ZmZlcl9iaXRzLCBlbnVtIGZiX29wX29yaWdpbg0KPiA+IG9yaWdpbikNCj4gPiAgew0KPiA+IC0J
aWYgKCFDQU5fUFNSKGRldl9wcml2KSkNCj4gPiAtCQlyZXR1cm47DQo+ID4gKwlzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlcjsNCj4gPiArCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHA7DQo+
ID4gIA0KPiA+IC0JaWYgKG9yaWdpbiA9PSBPUklHSU5fRkxJUCkNCj4gPiAtCQlyZXR1cm47DQo+
ID4gKwlmb3JfZWFjaF9pbnRlbF9kcCgmZGV2X3ByaXYtPmRybSwgZW5jb2Rlcikgew0KPiB3aXRo
IG15IHVuZGVyc3RhbmRpbmcgbG9vcGluZyBmb3IgZWFjaCBpbnRlbF9kcCBpbg0KPiBpbnRlbF9w
c3Jfe2ludmFsaWRhdGUsZmx1c2h9DQo+IG1heSBub3QgYmUgY29ycmVjdC4gaW50ZWxfcHNyX3tp
bnZhbGlkYXRlLGZsdXNofSB3aWxsIGdldCBjYWxsZWQgZm9yDQo+IGZyb250YnVmZmVyDQo+IHVw
ZGF0ZXMgYXNzb2NpYXRlZCB3aXRoIGEgZnJhbWVidWZmZXIuIEZ1bmN0aW9uYWxseSBpZiB0d28g
ZURQDQo+IGRpc3BsYXkgaGF2ZQ0KPiBkaXN0aW5jdCBmYiwgdGhlcmUgd2lsbCBiZSBkaXN0aW5j
dCBjYWxsIHRvDQo+IGludGVsX3Bzcl97aW52YWxpZGF0ZSxmbHVzaH0uIA0KSGksIEFuc2h1bWFu
DQpUaGFuayB5b3UgZm9yIGNoZWNrIGl0Lg0KPiA+ICANCj4gPiAtCW11dGV4X2xvY2soJmRldl9w
cml2LT5wc3IubG9jayk7DQo+ID4gLQlpZiAoIWRldl9wcml2LT5wc3IuZW5hYmxlZCkgew0KPiA+
IC0JCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPnBzci5sb2NrKTsNCj4gPiAtCQlyZXR1cm47DQo+
ID4gLQl9DQo+ID4gKwkJaW50ZWxfZHAgPSBlbmNfdG9faW50ZWxfZHAoZW5jb2Rlcik7DQo+ID4g
KwkJaWYgKGVuY29kZXItPnR5cGUgIT0gSU5URUxfT1VUUFVUX0VEUCkNCj4gPiArCQkJY29udGlu
dWU7DQo+ID4gKwkJaWYgKCFDQU5fUFNSKGludGVsX2RwKSkNCj4gPiArCQkJY29udGludWU7DQo+
ID4gKw0KPiA+ICsJCWlmIChvcmlnaW4gPT0gT1JJR0lOX0ZMSVApDQo+ID4gKwkJCWNvbnRpbnVl
Ow0KPiA+ICANCj4gPiAtCWZyb250YnVmZmVyX2JpdHMgJj0gSU5URUxfRlJPTlRCVUZGRVJfQUxM
X01BU0soZGV2X3ByaXYtDQo+ID4gPnBzci5waXBlKTsNCj4gPiAtCWRldl9wcml2LT5wc3IuYnVz
eV9mcm9udGJ1ZmZlcl9iaXRzIHw9IGZyb250YnVmZmVyX2JpdHM7DQo+ID4gKwkJbXV0ZXhfbG9j
aygmaW50ZWxfZHAtPnBzci5sb2NrKTsNCj4gPiArCQlpZiAoIWludGVsX2RwLT5wc3IuZW5hYmxl
ZCkgew0KPiA+ICsJCQltdXRleF91bmxvY2soJmludGVsX2RwLT5wc3IubG9jayk7DQo+ID4gKwkJ
CWNvbnRpbnVlOw0KPiA+ICsJCX0NCj4gPiAgDQo+ID4gLQlpZiAoZnJvbnRidWZmZXJfYml0cykN
Cj4gPiAtCQlpbnRlbF9wc3JfZXhpdChkZXZfcHJpdik7DQpFYWNoIGludGVsX2RwIHN0cnVjdHVy
ZSBtYWludGFpbnMgdGhlaXIgb3duIHBzciBwaXBlIGFuZCByZWxhdGVkDQpmcmFtZWJ1ZmZlciBp
bmZvcm1hdGlvbi4NCkFuZCB0aGUgYWZmZWN0ZWQgZnJhbWVidWZmZXIgaXMgY2FsY3VsYXRlZCBi
eSB0aGlzIHNlY3Rpb24uDQo+ID4gKwkJZnJvbnRidWZmZXJfYml0cyAmPSANCj4gPiBJTlRFTF9G
Uk9OVEJVRkZFUl9BTExfTUFTSyhpbnRlbF9kcC0+cHNyLnBpcGUpOw0KPiA+ICsJCWludGVsX2Rw
LT5wc3IuYnVzeV9mcm9udGJ1ZmZlcl9iaXRzIHw9DQo+ID4gZnJvbnRidWZmZXJfYml0czsNCj4g
PiAgDQo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5wc3IubG9jayk7DQo+ID4gLX0NCj4g
PiArCQlpZiAoZnJvbnRidWZmZXJfYml0cykNCj4gPiArCQkJaW50ZWxfcHNyX2V4aXQoaW50ZWxf
ZHApOw0KPiA+ICANCj4gPiArCQltdXRleF91bmxvY2soJmludGVsX2RwLT5wc3IubG9jayk7DQo+
ID4gKwl9DQo+ID4gK30NCj4gPiAgLyoNCj4gPiAgICogV2hlbiB3ZSB3aWxsIGJlIGNvbXBsZXRl
bHkgcmVseSBvbiBQU1IyIFMvVyB0cmFja2luZyBpbiBmdXR1cmUsDQo+ID4gICAqIGludGVsX3Bz
cl9mbHVzaCgpIHdpbGwgaW52YWxpZGF0ZSBhbmQgZmx1c2ggdGhlIFBTUiBmb3INCj4gPiBPUklH
SU5fRkxJUA0KPiA+IEBAIC0xNjI2LDE1ICsxNjU3LDE1IEBAIHZvaWQgaW50ZWxfcHNyX2ludmFs
aWRhdGUoc3RydWN0DQo+ID4gZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsDQo+ID4gICAqIGFj
Y29yZGluZ2x5IGluIGZ1dHVyZS4NCj4gPiAgICovDQo+ID4gIHN0YXRpYyB2b2lkDQo+ID4gLXRn
bF9kYzNjb19mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsDQo+ID4gLQkJ
dW5zaWduZWQgaW50IGZyb250YnVmZmVyX2JpdHMsIGVudW0gZmJfb3Bfb3JpZ2luDQo+ID4gb3Jp
Z2luKQ0KPiA+ICt0Z2xfZGMzY29fZmx1c2goc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwgdW5z
aWduZWQgaW50DQo+ID4gZnJvbnRidWZmZXJfYml0cywNCj4gPiArCQllbnVtIGZiX29wX29yaWdp
biBvcmlnaW4pDQo+ID4gIHsNCj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5wc3IubG9jayk7
DQo+ID4gKwltdXRleF9sb2NrKCZpbnRlbF9kcC0+cHNyLmxvY2spOw0KPiA+ICANCj4gPiAtCWlm
ICghZGV2X3ByaXYtPnBzci5kYzNjb19lbmFibGVkKQ0KPiA+ICsJaWYgKCFpbnRlbF9kcC0+cHNy
LmRjM2NvX2VuYWJsZWQpDQo+ID4gIAkJZ290byB1bmxvY2s7DQo+ID4gIA0KPiA+IC0JaWYgKCFk
ZXZfcHJpdi0+cHNyLnBzcjJfZW5hYmxlZCB8fCAhZGV2X3ByaXYtPnBzci5hY3RpdmUpDQo+ID4g
KwlpZiAoIWludGVsX2RwLT5wc3IucHNyMl9lbmFibGVkIHx8ICFpbnRlbF9kcC0+cHNyLmFjdGl2
ZSkNCj4gPiAgCQlnb3RvIHVubG9jazsNCj4gPiAgDQo+ID4gIAkvKg0KPiA+IEBAIC0xNjQyLDE1
ICsxNjczLDE1IEBAIHRnbF9kYzNjb19mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZQ0KPiA+
ICpkZXZfcHJpdiwNCj4gPiAgCSAqIHdoZW4gZGVsYXllZCB3b3JrIHNjaGVkdWxlcyB0aGF0IG1l
YW5zIGRpc3BsYXkgaGFzIGJlZW4NCj4gPiBpZGxlLg0KPiA+ICAJICovDQo+ID4gIAlpZiAoIShm
cm9udGJ1ZmZlcl9iaXRzICYNCj4gPiAtCSAgICBJTlRFTF9GUk9OVEJVRkZFUl9BTExfTUFTSyhk
ZXZfcHJpdi0+cHNyLnBpcGUpKSkNCj4gPiArCSAgICBJTlRFTF9GUk9OVEJVRkZFUl9BTExfTUFT
SyhpbnRlbF9kcC0+cHNyLnBpcGUpKSkNCj4gPiAgCQlnb3RvIHVubG9jazsNCj4gPiAgDQo+ID4g
LQl0Z2xfcHNyMl9lbmFibGVfZGMzY28oZGV2X3ByaXYpOw0KPiA+IC0JbW9kX2RlbGF5ZWRfd29y
ayhzeXN0ZW1fd3EsICZkZXZfcHJpdi0+cHNyLmRjM2NvX3dvcmssDQo+ID4gLQkJCSBkZXZfcHJp
di0+cHNyLmRjM2NvX2V4aXRfZGVsYXkpOw0KPiA+ICsJdGdsX3BzcjJfZW5hYmxlX2RjM2NvKGlu
dGVsX2RwKTsNCj4gPiArCW1vZF9kZWxheWVkX3dvcmsoc3lzdGVtX3dxLCAmaW50ZWxfZHAtPnBz
ci5kYzNjb193b3JrLA0KPiA+ICsJCQkgaW50ZWxfZHAtPnBzci5kYzNjb19leGl0X2RlbGF5KTsN
Cj4gPiAgDQo+ID4gIHVubG9jazoNCj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPnBzci5s
b2NrKTsNCj4gPiArCW11dGV4X3VubG9jaygmaW50ZWxfZHAtPnBzci5sb2NrKTsNCj4gPiAgfQ0K
PiA+ICANCj4gPiAgLyoqDQo+ID4gQEAgLTE2NjksNDUgKzE3MDAsNTQgQEAgdGdsX2RjM2NvX2Zs
dXNoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlDQo+ID4gKmRldl9wcml2LA0KPiA+ICB2b2lkIGlu
dGVsX3Bzcl9mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsDQo+ID4gIAkJ
ICAgICB1bnNpZ25lZCBmcm9udGJ1ZmZlcl9iaXRzLCBlbnVtIGZiX29wX29yaWdpbg0KPiA+IG9y
aWdpbikNCj4gPiAgew0KPiA+IC0JaWYgKCFDQU5fUFNSKGRldl9wcml2KSkNCj4gPiAtCQlyZXR1
cm47DQo+ID4gLQ0KPiA+IC0JaWYgKG9yaWdpbiA9PSBPUklHSU5fRkxJUCkgew0KPiA+IC0JCXRn
bF9kYzNjb19mbHVzaChkZXZfcHJpdiwgZnJvbnRidWZmZXJfYml0cywgb3JpZ2luKTsNCj4gPiAt
CQlyZXR1cm47DQo+ID4gLQl9DQo+ID4gLQ0KPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPnBz
ci5sb2NrKTsNCj4gPiAtCWlmICghZGV2X3ByaXYtPnBzci5lbmFibGVkKSB7DQo+ID4gLQkJbXV0
ZXhfdW5sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2spOw0KPiA+IC0JCXJldHVybjsNCj4gPiArCXN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyOw0KPiA+ICsJc3RydWN0IGludGVsX2RwICppbnRl
bF9kcDsNCj4gPiArDQo+ID4gKwlmb3JfZWFjaF9pbnRlbF9kcCgmZGV2X3ByaXYtPmRybSwgZW5j
b2Rlcikgew0KPiA+ICsJCWludGVsX2RwID0gZW5jX3RvX2ludGVsX2RwKGVuY29kZXIpOw0KPiA+
ICsNCj4gPiArCQlpZiAoZW5jb2Rlci0+dHlwZSA9PSBJTlRFTF9PVVRQVVRfRURQICYmDQo+ID4g
Q0FOX1BTUihpbnRlbF9kcCkpIHsNCj4gPiArCQkJaWYgKG9yaWdpbiA9PSBPUklHSU5fRkxJUCkg
ew0KPiA+ICsJCQkJdGdsX2RjM2NvX2ZsdXNoKGludGVsX2RwLA0KPiA+IGZyb250YnVmZmVyX2Jp
dHMsIG9yaWdpbik7DQo+ID4gKwkJCQljb250aW51ZTsNCj4gPiArCQkJfQ0KPiA+ICsNCj4gPiAr
CQkJbXV0ZXhfbG9jaygmaW50ZWxfZHAtPnBzci5sb2NrKTsNCj4gPiArCQkJaWYgKCFpbnRlbF9k
cC0+cHNyLmVuYWJsZWQpIHsNCj4gPiArCQkJCW11dGV4X3VubG9jaygmaW50ZWxfZHAtPnBzci5s
b2NrKTsNCj4gPiArCQkJCWNvbnRpbnVlOw0KPiA+ICsJCQl9DQo+ID4gKw0KPiA+ICsJCQlmcm9u
dGJ1ZmZlcl9iaXRzICY9DQo+ID4gSU5URUxfRlJPTlRCVUZGRVJfQUxMX01BU0soaW50ZWxfZHAt
PnBzci5waXBlKTsNCj4gPiArCQkJaW50ZWxfZHAtPnBzci5idXN5X2Zyb250YnVmZmVyX2JpdHMg
Jj0NCj4gPiB+ZnJvbnRidWZmZXJfYml0czsNCj4gPiArDQo+ID4gKwkJCS8qIEJ5IGRlZmluaXRp
b24gZmx1c2ggPSBpbnZhbGlkYXRlICsgZmx1c2ggKi8NCj4gPiArCQkJaWYgKGZyb250YnVmZmVy
X2JpdHMpDQo+ID4gKwkJCQlwc3JfZm9yY2VfaHdfdHJhY2tpbmdfZXhpdChpbnRlbF9kcCk7DQo+
ID4gKw0KPiA+ICsJCQlpZiAoIWludGVsX2RwLT5wc3IuYWN0aXZlICYmICFpbnRlbF9kcC0NCj4g
PiA+cHNyLmJ1c3lfZnJvbnRidWZmZXJfYml0cykNCj4gPiArCQkJCXNjaGVkdWxlX3dvcmsoJmlu
dGVsX2RwLT5wc3Iud29yayk7DQo+ID4gKwkJCW11dGV4X3VubG9jaygmaW50ZWxfZHAtPnBzci5s
b2NrKTsNCj4gPiArCQl9DQo+ID4gIAl9DQo+ID4gLQ0KPiA+IC0JZnJvbnRidWZmZXJfYml0cyAm
PSBJTlRFTF9GUk9OVEJVRkZFUl9BTExfTUFTSyhkZXZfcHJpdi0NCj4gPiA+cHNyLnBpcGUpOw0K
PiA+IC0JZGV2X3ByaXYtPnBzci5idXN5X2Zyb250YnVmZmVyX2JpdHMgJj0gfmZyb250YnVmZmVy
X2JpdHM7DQo+ID4gLQ0KPiA+IC0JLyogQnkgZGVmaW5pdGlvbiBmbHVzaCA9IGludmFsaWRhdGUg
KyBmbHVzaCAqLw0KPiA+IC0JaWYgKGZyb250YnVmZmVyX2JpdHMpDQo+ID4gLQkJcHNyX2ZvcmNl
X2h3X3RyYWNraW5nX2V4aXQoZGV2X3ByaXYpOw0KPiA+IC0NCj4gPiAtCWlmICghZGV2X3ByaXYt
PnBzci5hY3RpdmUgJiYgIWRldl9wcml2LQ0KPiA+ID5wc3IuYnVzeV9mcm9udGJ1ZmZlcl9iaXRz
KQ0KPiA+IC0JCXNjaGVkdWxlX3dvcmsoJmRldl9wcml2LT5wc3Iud29yayk7DQo+ID4gLQltdXRl
eF91bmxvY2soJmRldl9wcml2LT5wc3IubG9jayk7DQo+ID4gIH0NCj4gPiAgDQo+ID4gIC8qKg0K
PiA+ICAgKiBpbnRlbF9wc3JfaW5pdCAtIEluaXQgYmFzaWMgUFNSIHdvcmsgYW5kIG11dGV4Lg0K
PiA+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIHByaXZhdGUNCj4gPiArICogQGludGVsX2Rw
OiBJbnRlbCBEUA0KPiA+ICAgKg0KPiA+IC0gKiBUaGlzIGZ1bmN0aW9uIGlzICBjYWxsZWQgb25s
eSBvbmNlIGF0IGRyaXZlciBsb2FkIHRvIGluaXRpYWxpemUNCj4gPiBiYXNpYw0KPiA+IC0gKiBQ
U1Igc3R1ZmYuDQo+ID4gKyAqIFRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGFmdGVyIHRoZSBpbml0
aWFsaXppbmcgY29ubmVjdG9yLg0KPiA+ICsgKiAodGhlIGluaXRpYWxpemluZyBvZiBjb25uZWN0
b3IgdHJlYXRzIHRoZSBoYW5kbGluZyBvZiBjb25uZWN0b3INCj4gPiBjYXBhYmlsaXRpZXMpDQo+
ID4gKyAqIEFuZCBpdCBpbml0aWFsaXplcyBiYXNpYyBQU1Igc3R1ZmYgZm9yIGVhY2ggRFAgRW5j
b2Rlci4NCj4gPiAgICovDQo+ID4gLXZvaWQgaW50ZWxfcHNyX2luaXQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQ0KPiA+ICt2b2lkIGludGVsX3Bzcl9pbml0KHN0cnVjdCBpbnRl
bF9kcCAqaW50ZWxfZHApDQo+ID4gIHsNCj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOw0KPiA+ICsNCj4gPiAgCWlmICghSEFTX1BT
UihkZXZfcHJpdikpDQo+ID4gIAkJcmV0dXJuOw0KPiA+ICANCj4gPiAtCWlmICghZGV2X3ByaXYt
PnBzci5zaW5rX3N1cHBvcnQpDQo+ID4gKwlpZiAoIWludGVsX2RwLT5wc3Iuc2lua19zdXBwb3J0
KQ0KPiA+ICAJCXJldHVybjsNCj4gPiAgDQo+ID4gIAlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikp
DQo+ID4gQEAgLTE3MjUsMTQgKzE3NjUsMTQgQEAgdm9pZCBpbnRlbF9wc3JfaW5pdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZQ0KPiA+ICpkZXZfcHJpdikNCj4gPiAgCS8qIFNldCBsaW5rX3N0YW5k
YnkgeCBsaW5rX29mZiBkZWZhdWx0cyAqLw0KPiA+ICAJaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYp
IHx8IElTX0JST0FEV0VMTChkZXZfcHJpdikpDQo+ID4gIAkJLyogSFNXIGFuZCBCRFcgcmVxdWly
ZSB3b3JrYXJvdW5kcyB0aGF0IHdlIGRvbid0DQo+ID4gaW1wbGVtZW50LiAqLw0KPiA+IC0JCWRl
dl9wcml2LT5wc3IubGlua19zdGFuZGJ5ID0gZmFsc2U7DQo+ID4gKwkJaW50ZWxfZHAtPnBzci5s
aW5rX3N0YW5kYnkgPSBmYWxzZTsNCj4gPiAgCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
PCAxMikNCj4gPiAgCQkvKiBGb3IgbmV3IHBsYXRmb3JtcyB1cCB0byBUR0wgbGV0J3MgcmVzcGVj
dCBWQlQgYmFjaw0KPiA+IGFnYWluICovDQo+ID4gLQkJZGV2X3ByaXYtPnBzci5saW5rX3N0YW5k
YnkgPSBkZXZfcHJpdi0NCj4gPiA+dmJ0LnBzci5mdWxsX2xpbms7DQo+ID4gKwkJaW50ZWxfZHAt
PnBzci5saW5rX3N0YW5kYnkgPSBkZXZfcHJpdi0NCj4gPiA+dmJ0LnBzci5mdWxsX2xpbms7DQo+
ID4gIA0KPiA+IC0JSU5JVF9XT1JLKCZkZXZfcHJpdi0+cHNyLndvcmssIGludGVsX3Bzcl93b3Jr
KTsNCj4gPiAtCUlOSVRfREVMQVlFRF9XT1JLKCZkZXZfcHJpdi0+cHNyLmRjM2NvX3dvcmssDQo+
ID4gdGdsX2RjM2NvX2Rpc2FibGVfd29yayk7DQo+ID4gLQltdXRleF9pbml0KCZkZXZfcHJpdi0+
cHNyLmxvY2spOw0KPiA+ICsJSU5JVF9XT1JLKCZpbnRlbF9kcC0+cHNyLndvcmssIGludGVsX3Bz
cl93b3JrKTsNCj4gPiArCUlOSVRfREVMQVlFRF9XT1JLKCZpbnRlbF9kcC0+cHNyLmRjM2NvX3dv
cmssDQo+ID4gdGdsX2RjM2NvX2Rpc2FibGVfd29yayk7DQo+ID4gKwltdXRleF9pbml0KCZpbnRl
bF9kcC0+cHNyLmxvY2spOw0KPiA+ICB9DQo+ID4gIA0KPiA+ICBzdGF0aWMgaW50IHBzcl9nZXRf
c3RhdHVzX2FuZF9lcnJvcl9zdGF0dXMoc3RydWN0IGludGVsX2RwDQo+ID4gKmludGVsX2RwLA0K
PiA+IEBAIC0xNzU4LDcgKzE3OTgsNyBAQCBzdGF0aWMgdm9pZCBwc3JfYWxwbV9jaGVjayhzdHJ1
Y3QgaW50ZWxfZHANCj4gPiAqaW50ZWxfZHApDQo+ID4gIHsNCj4gPiAgCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOw0KPiA+ICAJc3RydWN0
IGRybV9kcF9hdXggKmF1eCA9ICZpbnRlbF9kcC0+YXV4Ow0KPiA+IC0Jc3RydWN0IGk5MTVfcHNy
ICpwc3IgPSAmZGV2X3ByaXYtPnBzcjsNCj4gPiArCXN0cnVjdCBpbnRlbF9wc3IgKnBzciA9ICZp
bnRlbF9kcC0+cHNyOw0KPiA+ICAJdTggdmFsOw0KPiA+ICAJaW50IHI7DQo+ID4gIA0KPiA+IEBA
IC0xNzg1LDcgKzE4MjUsNyBAQCBzdGF0aWMgdm9pZCBwc3JfYWxwbV9jaGVjayhzdHJ1Y3QgaW50
ZWxfZHANCj4gPiAqaW50ZWxfZHApDQo+ID4gIHN0YXRpYyB2b2lkIHBzcl9jYXBhYmlsaXR5X2No
YW5nZWRfY2hlY2soc3RydWN0IGludGVsX2RwDQo+ID4gKmludGVsX2RwKQ0KPiA+ICB7DQo+ID4g
IAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2Rw
KTsNCj4gPiAtCXN0cnVjdCBpOTE1X3BzciAqcHNyID0gJmRldl9wcml2LT5wc3I7DQo+ID4gKwlz
dHJ1Y3QgaW50ZWxfcHNyICpwc3IgPSAmaW50ZWxfZHAtPnBzcjsNCj4gPiAgCXU4IHZhbDsNCj4g
PiAgCWludCByOw0KPiA+ICANCj4gPiBAQCAtMTgwOSwxOCArMTg0OSwxOCBAQCBzdGF0aWMgdm9p
ZA0KPiA+IHBzcl9jYXBhYmlsaXR5X2NoYW5nZWRfY2hlY2soc3RydWN0IGludGVsX2RwICppbnRl
bF9kcCkNCj4gPiAgdm9pZCBpbnRlbF9wc3Jfc2hvcnRfcHVsc2Uoc3RydWN0IGludGVsX2RwICpp
bnRlbF9kcCkNCj4gPiAgew0KPiA+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7DQo+ID4gLQlzdHJ1Y3QgaTkxNV9wc3IgKnBzciA9ICZk
ZXZfcHJpdi0+cHNyOw0KPiA+ICsJc3RydWN0IGludGVsX3BzciAqcHNyID0gJmludGVsX2RwLT5w
c3I7DQo+ID4gIAl1OCBzdGF0dXMsIGVycm9yX3N0YXR1czsNCj4gPiAgCWNvbnN0IHU4IGVycm9y
cyA9IERQX1BTUl9SRkJfU1RPUkFHRV9FUlJPUiB8DQo+ID4gIAkJCSAgRFBfUFNSX1ZTQ19TRFBf
VU5DT1JSRUNUQUJMRV9FUlJPUiB8DQo+ID4gIAkJCSAgRFBfUFNSX0xJTktfQ1JDX0VSUk9SOw0K
PiA+ICANCj4gPiAtCWlmICghQ0FOX1BTUihkZXZfcHJpdikgfHwgIWludGVsX2RwX2lzX2VkcChp
bnRlbF9kcCkpDQo+ID4gKwlpZiAoIUNBTl9QU1IoaW50ZWxfZHApIHx8ICFpbnRlbF9kcF9pc19l
ZHAoaW50ZWxfZHApKQ0KPiA+ICAJCXJldHVybjsNCj4gPiAgDQo+ID4gIAltdXRleF9sb2NrKCZw
c3ItPmxvY2spOw0KPiA+ICANCj4gPiAtCWlmICghcHNyLT5lbmFibGVkIHx8IHBzci0+ZHAgIT0g
aW50ZWxfZHApDQo+ID4gKwlpZiAoIXBzci0+ZW5hYmxlZCkNCj4gPiAgCQlnb3RvIGV4aXQ7DQo+
ID4gIA0KPiA+ICAJaWYgKHBzcl9nZXRfc3RhdHVzX2FuZF9lcnJvcl9zdGF0dXMoaW50ZWxfZHAs
ICZzdGF0dXMsDQo+ID4gJmVycm9yX3N0YXR1cykpIHsNCj4gPiBAQCAtMTg2MywxNSArMTkwMywx
NCBAQCB2b2lkIGludGVsX3Bzcl9zaG9ydF9wdWxzZShzdHJ1Y3QgaW50ZWxfZHANCj4gPiAqaW50
ZWxfZHApDQo+ID4gIA0KPiA+ICBib29sIGludGVsX3Bzcl9lbmFibGVkKHN0cnVjdCBpbnRlbF9k
cCAqaW50ZWxfZHApDQo+ID4gIHsNCj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOw0KPiA+ICAJYm9vbCByZXQ7DQo+ID4gIA0KPiA+
IC0JaWYgKCFDQU5fUFNSKGRldl9wcml2KSB8fCAhaW50ZWxfZHBfaXNfZWRwKGludGVsX2RwKSkN
Cj4gPiArCWlmICghQ0FOX1BTUihpbnRlbF9kcCkgfHwgIWludGVsX2RwX2lzX2VkcChpbnRlbF9k
cCkpDQo+ID4gIAkJcmV0dXJuIGZhbHNlOw0KPiA+ICANCj4gPiAtCW11dGV4X2xvY2soJmRldl9w
cml2LT5wc3IubG9jayk7DQo+ID4gLQlyZXQgPSAoZGV2X3ByaXYtPnBzci5kcCA9PSBpbnRlbF9k
cCAmJiBkZXZfcHJpdi0+cHNyLmVuYWJsZWQpOw0KPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJp
di0+cHNyLmxvY2spOw0KPiA+ICsJbXV0ZXhfbG9jaygmaW50ZWxfZHAtPnBzci5sb2NrKTsNCj4g
PiArCXJldCA9IGludGVsX2RwLT5wc3IuZW5hYmxlZDsNCj4gPiArCW11dGV4X3VubG9jaygmaW50
ZWxfZHAtPnBzci5sb2NrKTsNCj4gPiAgDQo+ID4gIAlyZXR1cm4gcmV0Ow0KPiA+ICB9DQo+ID4g
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcHNyLmgNCj4g
PiBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcHNyLmgNCj4gPiBpbmRleCAw
YTUxNzk3OGU4YWYuLjAzZWIxOTU0N2QwOSAxMDA2NDQNCj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX3Bzci5oDQo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9wc3IuaA0KPiA+IEBAIC0xOCw3ICsxOCw3IEBAIHN0cnVjdCBpbnRl
bF9hdG9taWNfc3RhdGU7DQo+ID4gIHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZTsNCj4gPiAgc3Ry
dWN0IGludGVsX3BsYW5lOw0KPiA+ICANCj4gPiAtI2RlZmluZSBDQU5fUFNSKGRldl9wcml2KSAo
SEFTX1BTUihkZXZfcHJpdikgJiYgZGV2X3ByaXYtDQo+ID4gPnBzci5zaW5rX3N1cHBvcnQpDQo+
ID4gKyNkZWZpbmUgQ0FOX1BTUihpbnRlbF9kcCkgKEhBU19QU1IoZHBfdG9faTkxNShpbnRlbF9k
cCkpICYmDQo+ID4gaW50ZWxfZHAtPnBzci5zaW5rX3N1cHBvcnQpDQo+ID4gIHZvaWQgaW50ZWxf
cHNyX2luaXRfZHBjZChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKTsNCj4gPiAgdm9pZCBpbnRl
bF9wc3JfZW5hYmxlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsDQo+ID4gIAkJICAgICAgY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsDQo+ID4gQEAgLTI4LDI0ICsy
OCwyNCBAQCB2b2lkIGludGVsX3Bzcl9kaXNhYmxlKHN0cnVjdCBpbnRlbF9kcA0KPiA+ICppbnRl
bF9kcCwNCj4gPiAgdm9pZCBpbnRlbF9wc3JfdXBkYXRlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxf
ZHAsDQo+ID4gIAkJICAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUsDQo+ID4gIAkJICAgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5f
c3RhdGUpOw0KPiA+IC1pbnQgaW50ZWxfcHNyX2RlYnVnX3NldChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsIHU2NA0KPiA+IHZhbHVlKTsNCj4gPiAraW50IGludGVsX3Bzcl9kZWJ1
Z19zZXQoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwgdTY0IHZhbHVlKTsNCj4gPiAgdm9pZCBp
bnRlbF9wc3JfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsDQo+
ID4gIAkJCSAgdW5zaWduZWQgZnJvbnRidWZmZXJfYml0cywNCj4gPiAgCQkJICBlbnVtIGZiX29w
X29yaWdpbiBvcmlnaW4pOw0KPiA+ICB2b2lkIGludGVsX3Bzcl9mbHVzaChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsDQo+ID4gIAkJICAgICB1bnNpZ25lZCBmcm9udGJ1ZmZlcl9i
aXRzLA0KPiA+ICAJCSAgICAgZW51bSBmYl9vcF9vcmlnaW4gb3JpZ2luKTsNCj4gPiAtdm9pZCBp
bnRlbF9wc3JfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOw0KPiA+ICt2
b2lkIGludGVsX3Bzcl9pbml0KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApOw0KPiA+ICB2b2lk
IGludGVsX3Bzcl9jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLA0KPiA+
ICAJCQkgICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7DQo+ID4gLXZv
aWQgaW50ZWxfcHNyX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwgdTMyDQo+ID4gcHNyX2lpcik7DQo+ID4gK3ZvaWQgaW50ZWxfcHNyX2lycV9oYW5kbGVyKHN0
cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsIHUzMg0KPiA+IHBzcl9paXIpOw0KPiA+ICB2b2lkIGlu
dGVsX3Bzcl9zaG9ydF9wdWxzZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKTsNCj4gPiAtaW50
IGludGVsX3Bzcl93YWl0X2Zvcl9pZGxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlDQo+
ID4gKm5ld19jcnRjX3N0YXRlLA0KPiA+IC0JCQkgICAgdTMyICpvdXRfdmFsdWUpOw0KPiA+ICt2
b2lkIGludGVsX3Bzcl93YWl0X2Zvcl9pZGxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
DQo+ID4gKm5ld19jcnRjX3N0YXRlKTsNCj4gPiAgYm9vbCBpbnRlbF9wc3JfZW5hYmxlZChzdHJ1
Y3QgaW50ZWxfZHAgKmludGVsX2RwKTsNCj4gPiAgaW50IGludGVsX3BzcjJfc2VsX2ZldGNoX3Vw
ZGF0ZShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwNCj4gPiAgCQkJCXN0cnVjdCBp
bnRlbF9jcnRjICpjcnRjKTsNCj4gPiAtdm9pZCBpbnRlbF9wc3IyX3Byb2dyYW1fdHJhbnNfbWFu
X3Rya19jdGwoY29uc3Qgc3RydWN0DQo+ID4gaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7
DQo+ID4gK3ZvaWQgaW50ZWxfcHNyMl9wcm9ncmFtX3RyYW5zX21hbl90cmtfY3RsKHN0cnVjdCBp
bnRlbF9kcA0KPiA+ICppbnRlbF9kcCwNCj4gPiArCQkJCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlDQo+ID4gKmNydGNfc3RhdGUpOw0KPiA+ICB2b2lkIGludGVsX3BzcjJfcHJvZ3Jh
bV9wbGFuZV9zZWxfZmV0Y2goc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwNCj4gPiAgCQkJCQlj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZQ0KPiA+ICpjcnRjX3N0YXRlLA0KPiA+ICAJCQkJ
CWNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZQ0KPiA+ICpwbGFuZV9zdGF0ZSwNCj4gPiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zcHJpdGUuYw0K
PiA+IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zcHJpdGUuYw0KPiA+IGlu
ZGV4IGI3ZTIwODgxNjA3NC4uOTQ4MjM0YzYwNjQ4IDEwMDY0NA0KPiA+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3ByaXRlLmMNCj4gPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nwcml0ZS5jDQo+ID4gQEAgLTg0LDcgKzg0LDYgQEAg
dm9pZCBpbnRlbF9waXBlX3VwZGF0ZV9zdGFydChjb25zdCBzdHJ1Y3QNCj4gPiBpbnRlbF9jcnRj
X3N0YXRlICpuZXdfY3J0Y19zdGF0ZSkNCj4gPiAgCWJvb2wgbmVlZF92bHZfZHNpX3dhID0gKElT
X1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8DQo+ID4gSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpICYm
DQo+ID4gIAkJaW50ZWxfY3J0Y19oYXNfdHlwZShuZXdfY3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVU
X0RTSSk7DQo+ID4gIAlERUZJTkVfV0FJVCh3YWl0KTsNCj4gPiAtCXUzMiBwc3Jfc3RhdHVzOw0K
PiA+ICANCj4gPiAgCWlmIChuZXdfY3J0Y19zdGF0ZS0+dWFwaS5hc3luY19mbGlwKQ0KPiA+ICAJ
CXJldHVybjsNCj4gPiBAQCAtMTA5LDEwICsxMDgsNyBAQCB2b2lkIGludGVsX3BpcGVfdXBkYXRl
X3N0YXJ0KGNvbnN0IHN0cnVjdA0KPiA+IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRl
KQ0KPiA+ICAJICogVkJMIGludGVycnVwdHMgd2lsbCBzdGFydCB0aGUgUFNSIGV4aXQgYW5kIHBy
ZXZlbnQgYSBQU1INCj4gPiAgCSAqIHJlLWVudHJ5IGFzIHdlbGwuDQo+ID4gIAkgKi8NCj4gPiAt
CWlmIChpbnRlbF9wc3Jfd2FpdF9mb3JfaWRsZShuZXdfY3J0Y19zdGF0ZSwgJnBzcl9zdGF0dXMp
KQ0KPiA+IC0JCWRybV9lcnIoJmRldl9wcml2LT5kcm0sDQo+ID4gLQkJCSJQU1IgaWRsZSB0aW1l
ZCBvdXQgMHgleCwgYXRvbWljIHVwZGF0ZSBtYXkNCj4gPiBmYWlsXG4iLA0KPiA+IC0JCQlwc3Jf
c3RhdHVzKTsNCj4gPiArCWludGVsX3Bzcl93YWl0X2Zvcl9pZGxlKG5ld19jcnRjX3N0YXRlKTsN
Cj4gPiAgDQo+ID4gIAlsb2NhbF9pcnFfZGlzYWJsZSgpOw0KPiA+ICANCj4gPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaA0KPiA+IGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9kcnYuaA0KPiA+IGluZGV4IDVkMDRiMjgyYzA2MC4uYTJlMzllOGFkY2JlIDEw
MDY0NA0KPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgNCj4gPiArKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oDQo+ID4gQEAgLTQ3NSw0MiArNDc1LDYg
QEAgc3RydWN0IGk5MTVfZHJycyB7DQo+ID4gIAllbnVtIGRycnNfc3VwcG9ydF90eXBlIHR5cGU7
DQo+ID4gIH07DQo+ID4gIA0KPiA+IC1zdHJ1Y3QgaTkxNV9wc3Igew0KPiA+IC0Jc3RydWN0IG11
dGV4IGxvY2s7DQo+ID4gLQ0KPiA+IC0jZGVmaW5lIEk5MTVfUFNSX0RFQlVHX01PREVfTUFTSwkw
eDBmDQo+ID4gLSNkZWZpbmUgSTkxNV9QU1JfREVCVUdfREVGQVVMVAkJMHgwMA0KPiA+IC0jZGVm
aW5lIEk5MTVfUFNSX0RFQlVHX0RJU0FCTEUJCTB4MDENCj4gPiAtI2RlZmluZSBJOTE1X1BTUl9E
RUJVR19FTkFCTEUJCTB4MDINCj4gPiAtI2RlZmluZSBJOTE1X1BTUl9ERUJVR19GT1JDRV9QU1Ix
CTB4MDMNCj4gPiAtI2RlZmluZSBJOTE1X1BTUl9ERUJVR19JUlEJCTB4MTANCj4gPiAtDQo+ID4g
LQl1MzIgZGVidWc7DQo+ID4gLQlib29sIHNpbmtfc3VwcG9ydDsNCj4gPiAtCWJvb2wgZW5hYmxl
ZDsNCj4gPiAtCXN0cnVjdCBpbnRlbF9kcCAqZHA7DQo+ID4gLQllbnVtIHBpcGUgcGlwZTsNCj4g
PiAtCWVudW0gdHJhbnNjb2RlciB0cmFuc2NvZGVyOw0KPiA+IC0JYm9vbCBhY3RpdmU7DQo+ID4g
LQlzdHJ1Y3Qgd29ya19zdHJ1Y3Qgd29yazsNCj4gPiAtCXVuc2lnbmVkIGJ1c3lfZnJvbnRidWZm
ZXJfYml0czsNCj4gPiAtCWJvb2wgc2lua19wc3IyX3N1cHBvcnQ7DQo+ID4gLQlib29sIGxpbmtf
c3RhbmRieTsNCj4gPiAtCWJvb2wgY29sb3JpbWV0cnlfc3VwcG9ydDsNCj4gPiAtCWJvb2wgcHNy
Ml9lbmFibGVkOw0KPiA+IC0JYm9vbCBwc3IyX3NlbF9mZXRjaF9lbmFibGVkOw0KPiA+IC0JdTgg
c2lua19zeW5jX2xhdGVuY3k7DQo+ID4gLQlrdGltZV90IGxhc3RfZW50cnlfYXR0ZW1wdDsNCj4g
PiAtCWt0aW1lX3QgbGFzdF9leGl0Ow0KPiA+IC0JYm9vbCBzaW5rX25vdF9yZWxpYWJsZTsNCj4g
PiAtCWJvb2wgaXJxX2F1eF9lcnJvcjsNCj4gPiAtCXUxNiBzdV94X2dyYW51bGFyaXR5Ow0KPiA+
IC0JYm9vbCBkYzNjb19lbmFibGVkOw0KPiA+IC0JdTMyIGRjM2NvX2V4aXRfZGVsYXk7DQo+ID4g
LQlzdHJ1Y3QgZGVsYXllZF93b3JrIGRjM2NvX3dvcms7DQo+ID4gLQlzdHJ1Y3QgZHJtX2RwX3Zz
Y19zZHAgdnNjOw0KPiA+IC19Ow0KPiA+IC0NCj4gPiAgI2RlZmluZSBRVUlSS19MVkRTX1NTQ19E
SVNBQkxFICgxPDwxKQ0KPiA+ICAjZGVmaW5lIFFVSVJLX0lOVkVSVF9CUklHSFRORVNTICgxPDwy
KQ0KPiA+ICAjZGVmaW5lIFFVSVJLX0JBQ0tMSUdIVF9QUkVTRU5UICgxPDwzKQ0KPiA+IEBAIC0x
MDQxLDggKzEwMDUsNiBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSB7DQo+ID4gIA0KPiA+ICAJ
c3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyBwb3dlcl9kb21haW5zOw0KPiA+ICANCj4gPiAtCXN0
cnVjdCBpOTE1X3BzciBwc3I7DQo+ID4gLQ0KPiA+ICAJc3RydWN0IGk5MTVfZ3B1X2Vycm9yIGdw
dV9lcnJvcjsNCj4gPiAgDQo+ID4gIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqdmx2X3Bj
dHg7DQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmMNCj4g
PiBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmMNCj4gPiBpbmRleCBiMjQ1MTA5Zjcz
ZTMuLmIwYWVlNDdjN2FkNCAxMDA2NDQNCj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2lycS5jDQo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9pcnEuYw0KPiA+
IEBAIC0yMDU3LDEwICsyMDU3LDIyIEBAIHN0YXRpYyB2b2lkIGl2Yl9kaXNwbGF5X2lycV9oYW5k
bGVyKHN0cnVjdA0KPiA+IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LA0KPiA+ICAJCWl2Yl9l
cnJfaW50X2hhbmRsZXIoZGV2X3ByaXYpOw0KPiA+ICANCj4gPiAgCWlmIChkZV9paXIgJiBERV9F
RFBfUFNSX0lOVF9IU1cpIHsNCj4gPiAtCQl1MzIgcHNyX2lpciA9IGludGVsX3VuY29yZV9yZWFk
KCZkZXZfcHJpdi0+dW5jb3JlLA0KPiA+IEVEUF9QU1JfSUlSKTsNCj4gPiArCQlzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlcjsNCj4gPiAgDQo+ID4gLQkJaW50ZWxfcHNyX2lycV9oYW5kbGVy
KGRldl9wcml2LCBwc3JfaWlyKTsNCj4gPiAtCQlpbnRlbF91bmNvcmVfd3JpdGUoJmRldl9wcml2
LT51bmNvcmUsIEVEUF9QU1JfSUlSLA0KPiA+IHBzcl9paXIpOw0KPiA+ICsJCWZvcl9lYWNoX2lu
dGVsX2RwKCZkZXZfcHJpdi0+ZHJtLCBlbmNvZGVyKSB7DQo+ID4gKwkJCXN0cnVjdCBpbnRlbF9k
cCAqaW50ZWxfZHAgPQ0KPiA+IGVuY190b19pbnRlbF9kcChlbmNvZGVyKTsNCj4gPiArDQo+ID4g
KwkJCWlmIChlbmNvZGVyLT50eXBlID09IElOVEVMX09VVFBVVF9FRFAgJiYNCj4gPiArCQkJICAg
IENBTl9QU1IoaW50ZWxfZHApKSB7DQo+ID4gKwkJCQl1MzIgcHNyX2lpciA9DQo+ID4gaW50ZWxf
dW5jb3JlX3JlYWQoJmRldl9wcml2LT51bmNvcmUsDQo+ID4gKwkJCQkJCQkJRURQX1BTUg0KPiA+
IF9JSVIpOw0KPiA+ICsNCj4gPiArCQkJCWludGVsX3Bzcl9pcnFfaGFuZGxlcihpbnRlbF9kcCwN
Cj4gPiBwc3JfaWlyKTsNCj4gPiArCQkJCWludGVsX3VuY29yZV93cml0ZSgmZGV2X3ByaXYtPnVu
Y29yZSwNCj4gPiArCQkJCQkJICAgRURQX1BTUl9JSVIsDQo+ID4gcHNyX2lpcik7DQo+ID4gKwkJ
CQlicmVhazsNCj4gPiArCQkJfQ0KPiA+ICsJCX0NCj4gPiAgCX0NCj4gPiAgDQo+ID4gIAlpZiAo
ZGVfaWlyICYgREVfQVVYX0NIQU5ORUxfQV9JVkIpDQo+ID4gQEAgLTIyNjgsMjEgKzIyODAsMzQg
QEAgZ2VuOF9kZV9taXNjX2lycV9oYW5kbGVyKHN0cnVjdA0KPiA+IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LCB1MzIgaWlyKQ0KPiA+ICAJfQ0KPiA+ICANCj4gPiAgCWlmIChpaXIgJiBHRU44
X0RFX0VEUF9QU1IpIHsNCj4gPiArCQlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcjsNCj4g
PiAgCQl1MzIgcHNyX2lpcjsNCj4gPiAgCQlpOTE1X3JlZ190IGlpcl9yZWc7DQo+ID4gIA0KPiA+
IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEyKQ0KPiA+IC0JCQlpaXJfcmVnID0gVFJB
TlNfUFNSX0lJUihkZXZfcHJpdi0NCj4gPiA+cHNyLnRyYW5zY29kZXIpOw0KPiA+IC0JCWVsc2UN
Cj4gPiAtCQkJaWlyX3JlZyA9IEVEUF9QU1JfSUlSOw0KPiA+ICsJCWZvcl9lYWNoX2ludGVsX2Rw
KCZkZXZfcHJpdi0+ZHJtLCBlbmNvZGVyKSB7DQo+ID4gKwkJCXN0cnVjdCBpbnRlbF9kcCAqaW50
ZWxfZHAgPQ0KPiA+IGVuY190b19pbnRlbF9kcChlbmNvZGVyKTsNCj4gPiAgDQo+ID4gLQkJcHNy
X2lpciA9IGludGVsX3VuY29yZV9yZWFkKCZkZXZfcHJpdi0+dW5jb3JlLA0KPiA+IGlpcl9yZWcp
Ow0KPiA+IC0JCWludGVsX3VuY29yZV93cml0ZSgmZGV2X3ByaXYtPnVuY29yZSwgaWlyX3JlZywN
Cj4gPiBwc3JfaWlyKTsNCj4gPiArCQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTIgJiYN
Cj4gPiBDQU5fUFNSKGludGVsX2RwKSkgew0KPiA+ICsJCQkJaWlyX3JlZyA9IFRSQU5TX1BTUl9J
SVIoaW50ZWxfZHAtDQo+ID4gPnBzci50cmFuc2NvZGVyKTsNCj4gPiArCQkJfSBlbHNlIGlmIChl
bmNvZGVyLT50eXBlID09IElOVEVMX09VVFBVVF9FRFAgJiYNCj4gPiArCQkJCSAgIENBTl9QU1Io
aW50ZWxfZHApKSB7DQo+ID4gKwkJCQlpaXJfcmVnID0gRURQX1BTUl9JSVI7DQo+ID4gKwkJCX0g
ZWxzZSB7DQo+ID4gKwkJCQljb250aW51ZTsNCj4gPiArCQkJfQ0KPiA+ICsNCj4gPiArCQkJcHNy
X2lpciA9IGludGVsX3VuY29yZV9yZWFkKCZkZXZfcHJpdi0+dW5jb3JlLA0KPiA+IGlpcl9yZWcp
Ow0KPiA+ICsJCQlpbnRlbF91bmNvcmVfd3JpdGUoJmRldl9wcml2LT51bmNvcmUsIGlpcl9yZWcs
DQo+ID4gcHNyX2lpcik7DQo+ID4gKw0KPiA+ICsJCQlpZiAocHNyX2lpcikNCj4gPiArCQkJCWZv
dW5kID0gdHJ1ZTsNCj4gPiAgDQo+ID4gLQkJaWYgKHBzcl9paXIpDQo+ID4gLQkJCWZvdW5kID0g
dHJ1ZTsNCj4gPiArCQkJaW50ZWxfcHNyX2lycV9oYW5kbGVyKGludGVsX2RwLCBwc3JfaWlyKTsN
Cj4gPiAgDQo+ID4gLQkJaW50ZWxfcHNyX2lycV9oYW5kbGVyKGRldl9wcml2LCBwc3JfaWlyKTsN
Cj4gPiArCQkJLyogcHJpb3IgR0VOMTIgb25seSBoYXZlIG9uZSBFRFAgUFNSICovDQo+ID4gKwkJ
CWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgMTIpDQo+ID4gKwkJCQlicmVhazsNCj4gPiArCQl9
DQo+ID4gIAl9DQo+ID4gIA0KPiA+ICAJaWYgKCFmb3VuZCkNCj4gPiAtLSANCj4gPiAyLjI1LjAN
Cj4gPiANCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCklu
dGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRw
czovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeAo=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 0D8364CFFB
	for <lists+intel-gfx@lfdr.de>; Thu, 20 Jun 2019 16:06:42 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 747EA6E5A6;
	Thu, 20 Jun 2019 14:06:37 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga05.intel.com (mga05.intel.com [192.55.52.43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 536206E599
 for <intel-gfx@lists.freedesktop.org>; Thu, 20 Jun 2019 14:06:30 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga003.jf.intel.com ([10.7.209.27])
 by fmsmga105.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 20 Jun 2019 07:06:30 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,397,1557212400"; d="scan'208";a="162531304"
Received: from ideak-desk.fi.intel.com ([10.237.72.204])
 by orsmga003.jf.intel.com with ESMTP; 20 Jun 2019 07:06:28 -0700
From: Imre Deak <imre.deak@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 20 Jun 2019 17:05:51 +0300
Message-Id: <20190620140600.11357-15-imre.deak@intel.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190620140600.11357-1-imre.deak@intel.com>
References: <20190620140600.11357-1-imre.deak@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v2 14/23] drm/i915: Keep the TypeC port mode
 fixed for detect/AUX transfers
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Paulo Zanoni <paulo.r.zanoni@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

V2UgbXVzdCBrZWVwIHRoZSBUeXBlQyBwb3J0IG1vZGUgZml4ZWQgZm9yIHRoZSBkdXJhdGlvbiBv
ZiB0aGUgY29ubmVjdG9yCmRldGVjdGlvbiBhbmQgZWFjaCBBVVggdHJhbnNmZXJzLiBBZGQgYSBu
ZXcgVHlwZUMgbG9jayBob2xkaW5nIGl0IGFyb3VuZAp0aGVzZSB0d28gc2VxdWVuY2VzLiBGb3Ig
Y29uc2lzdGVuY3kgYWxzbyBob2xkIHRoZSBsb2NrIGR1cmluZyB0aGUgcG9ydAptb2RlIHNhbml0
aXphdGlvbi4KCldoZW5ldmVyIHJlc2V0dGluZyB0aGUgcG9ydCBtb2RlIChvbmx5IGR1cmluZyB0
aGUgZGV0ZWN0aW9uIGZvciBub3cpIHRoZQpwb3J0J3MgQVVYIHBvd2VyIGRvbWFpbiBtdXN0IGJl
IGRpc2FibGVkIGFscmVhZHkuIEZsdXNoIHRoZSBhc3luYyBwb3dlcgpkb21haW4gZGlzYWJsaW5n
IHdvcmsgdG8gZW5zdXJlIHRoaXMuCgpBIGZvbGxvdy11cCBwYXRjaCB3aWxsIG1ha2UgdGhlIHBv
cnQgbW9kZSBjaGFuZ2luZyBtb3JlIHJvYnVzdCBieQpwb3N0cG9uaW5nIHRoZSBjaGFuZ2UgZm9y
IGFjdGl2ZSBwb3J0cy4KCnYyOgotIEZpeCBjaGVja3BhdGNoIGlzc3VlOiBtaXNzaW5nIGFubm90
YXRpb24gZm9yIHRjX2xvY2suCgpDYzogSm9zw6kgUm9iZXJ0byBkZSBTb3V6YSA8am9zZS5zb3V6
YUBpbnRlbC5jb20+CkNjOiBSb2RyaWdvIFZpdmkgPHJvZHJpZ28udml2aUBpbnRlbC5jb20+CkNj
OiBQYXVsbyBaYW5vbmkgPHBhdWxvLnIuemFub25pQGludGVsLmNvbT4KQ2M6IFZpbGxlIFN5cmrD
pGzDpCA8dmlsbGUuc3lyamFsYUBsaW51eC5pbnRlbC5jb20+ClNpZ25lZC1vZmYtYnk6IEltcmUg
RGVhayA8aW1yZS5kZWFrQGludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2RwLmMgfCAgNyArKysrKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfdGMuYyB8IDMwICsrKysrKysrKysrKysrKysrKysrKysrKy0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfdGMuaCB8ICAyICsrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9kcnYuaCAgICAgICAgfCAgMSArCiA0IGZpbGVzIGNoYW5nZWQsIDM5IGluc2VydGlvbnMo
KyksIDEgZGVsZXRpb24oLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2RwLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwLmMK
aW5kZXggMGM2YWZlYzc4ZjkzLi44ZjcxODhkNzFkMDggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHAuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2RwLmMKQEAgLTExOTIsNiArMTE5Miw3IEBAIGludGVsX2RwX2F1eF94ZmVy
KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPQogCQkJdG9faTkxNShpbnRlbF9kaWdfcG9ydC0+YmFzZS5iYXNlLmRldik7CiAJc3RydWN0
IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsKKwlib29sIGlzX3RjX3BvcnQg
PSBpbnRlbF9wb3J0X2lzX3RjKGk5MTUsIGludGVsX2RpZ19wb3J0LT5iYXNlLnBvcnQpOwogCWk5
MTVfcmVnX3QgY2hfY3RsLCBjaF9kYXRhWzVdOwogCXUzMiBhdXhfY2xvY2tfZGl2aWRlcjsKIAll
bnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGF1eF9kb21haW4gPQpAQCAtMTIwNyw2ICsx
MjA4LDkgQEAgaW50ZWxfZHBfYXV4X3hmZXIoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKIAlm
b3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShjaF9kYXRhKTsgaSsrKQogCQljaF9kYXRhW2ldID0g
aW50ZWxfZHAtPmF1eF9jaF9kYXRhX3JlZyhpbnRlbF9kcCwgaSk7CiAKKwlpZiAoaXNfdGNfcG9y
dCkKKwkJaW50ZWxfdGNfcG9ydF9sb2NrKGludGVsX2RpZ19wb3J0KTsKKwogCWF1eF93YWtlcmVm
ID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoaTkxNSwgYXV4X2RvbWFpbik7CiAJcHBzX3dha2Vy
ZWYgPSBwcHNfbG9jayhpbnRlbF9kcCk7CiAKQEAgLTEzNTksNiArMTM2Myw5IEBAIGludGVsX2Rw
X2F1eF94ZmVyKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCiAJcHBzX3VubG9jayhpbnRlbF9k
cCwgcHBzX3dha2VyZWYpOwogCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X2FzeW5jKGk5MTUsIGF1
eF9kb21haW4sIGF1eF93YWtlcmVmKTsKIAorCWlmIChpc190Y19wb3J0KQorCQlpbnRlbF90Y19w
b3J0X3VubG9jayhpbnRlbF9kaWdfcG9ydCk7CisKIAlyZXR1cm4gcmV0OwogfQogCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3RjLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3RjLmMKaW5kZXggODFiMGQ1Njc2MTA4Li4wMTliYzUz
YWYyOGIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfdGMu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3RjLmMKQEAgLTI5Niw4
ICsyOTYsMTEgQEAgaW50ZWxfdGNfcG9ydF9nZXRfdGFyZ2V0X21vZGUoc3RydWN0IGludGVsX2Rp
Z2l0YWxfcG9ydCAqZGlnX3BvcnQpCiAKIHN0YXRpYyB2b2lkIGludGVsX3RjX3BvcnRfcmVzZXRf
bW9kZShzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCkKIHsKKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2
KTsKIAllbnVtIHRjX3BvcnRfbW9kZSBvbGRfdGNfbW9kZSA9IGRpZ19wb3J0LT50Y19tb2RlOwog
CisJaW50ZWxfZGlzcGxheV9wb3dlcl9mbHVzaF93b3JrKGRldl9wcml2KTsKKwogCWljbF90Y19w
aHlfZGlzY29ubmVjdChkaWdfcG9ydCk7CiAJaWNsX3RjX3BoeV9jb25uZWN0KGRpZ19wb3J0KTsK
IApAQCAtMzEyLDYgKzMxNSw4IEBAIHZvaWQgaW50ZWxfdGNfcG9ydF9zYW5pdGl6ZShzdHJ1Y3Qg
aW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCkKIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciA9ICZkaWdfcG9ydC0+YmFzZTsKIAlpbnQgYWN0aXZlX2xpbmtzID0gMDsKIAorCW11dGV4
X2xvY2soJmRpZ19wb3J0LT50Y19sb2NrKTsKKwogCWRpZ19wb3J0LT50Y19tb2RlID0gaW50ZWxf
dGNfcG9ydF9nZXRfY3VycmVudF9tb2RlKGRpZ19wb3J0KTsKIAlpZiAoZGlnX3BvcnQtPmRwLmlz
X21zdCkKIAkJYWN0aXZlX2xpbmtzID0gaW50ZWxfZHBfbXN0X2VuY29kZXJfYWN0aXZlX2xpbmtz
KGRpZ19wb3J0KTsKQEAgLTMzMiw2ICszMzcsOCBAQCB2b2lkIGludGVsX3RjX3BvcnRfc2FuaXRp
emUoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQpCiAJRFJNX0RFQlVHX0tNUygi
UG9ydCAlczogc2FuaXRpemUgbW9kZSAoJXMpXG4iLAogCQkgICAgICBkaWdfcG9ydC0+dGNfcG9y
dF9uYW1lLAogCQkgICAgICB0Y19wb3J0X21vZGVfbmFtZShkaWdfcG9ydC0+dGNfbW9kZSkpOwor
CisJbXV0ZXhfdW5sb2NrKCZkaWdfcG9ydC0+dGNfbG9jayk7CiB9CiAKIHN0YXRpYyBib29sIGlu
dGVsX3RjX3BvcnRfbmVlZHNfcmVzZXQoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3Bv
cnQpCkBAIC0zNTEsMTAgKzM1OCwzMCBAQCBzdGF0aWMgYm9vbCBpbnRlbF90Y19wb3J0X25lZWRz
X3Jlc2V0KHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KQogICovCiBib29sIGlu
dGVsX3RjX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0
KQogeworCWJvb2wgaXNfY29ubmVjdGVkOworCisJbXV0ZXhfbG9jaygmZGlnX3BvcnQtPnRjX2xv
Y2spOworCiAJaWYgKGludGVsX3RjX3BvcnRfbmVlZHNfcmVzZXQoZGlnX3BvcnQpKQogCQlpbnRl
bF90Y19wb3J0X3Jlc2V0X21vZGUoZGlnX3BvcnQpOwogCi0JcmV0dXJuIHRjX3BvcnRfbGl2ZV9z
dGF0dXNfbWFzayhkaWdfcG9ydCkgJiBCSVQoZGlnX3BvcnQtPnRjX21vZGUpOworCWlzX2Nvbm5l
Y3RlZCA9IHRjX3BvcnRfbGl2ZV9zdGF0dXNfbWFzayhkaWdfcG9ydCkgJgorCQkgICAgICAgQklU
KGRpZ19wb3J0LT50Y19tb2RlKTsKKworCW11dGV4X3VubG9jaygmZGlnX3BvcnQtPnRjX2xvY2sp
OworCisJcmV0dXJuIGlzX2Nvbm5lY3RlZDsKK30KKwordm9pZCBpbnRlbF90Y19wb3J0X2xvY2so
c3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQpCit7CisJbXV0ZXhfbG9jaygmZGln
X3BvcnQtPnRjX2xvY2spOworCS8qIFRPRE86IHJlc2V0IHRoZSBUeXBlQyBwb3J0IG1vZGUgaWYg
bmVlZGVkICovCit9CisKK3ZvaWQgaW50ZWxfdGNfcG9ydF91bmxvY2soc3RydWN0IGludGVsX2Rp
Z2l0YWxfcG9ydCAqZGlnX3BvcnQpCit7CisJbXV0ZXhfdW5sb2NrKCZkaWdfcG9ydC0+dGNfbG9j
ayk7CiB9CiAKIHZvaWQgaW50ZWxfdGNfcG9ydF9pbml0KHN0cnVjdCBpbnRlbF9kaWdpdGFsX3Bv
cnQgKmRpZ19wb3J0LCBib29sIGlzX2xlZ2FjeSkKQEAgLTM2OSw1ICszOTYsNiBAQCB2b2lkIGlu
dGVsX3RjX3BvcnRfaW5pdChzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCwgYm9v
bCBpc19sZWdhY3kpCiAJc25wcmludGYoZGlnX3BvcnQtPnRjX3BvcnRfbmFtZSwgc2l6ZW9mKGRp
Z19wb3J0LT50Y19wb3J0X25hbWUpLAogCQkgIiVjL1RDIyVkIiwgcG9ydF9uYW1lKHBvcnQpLCB0
Y19wb3J0ICsgMSk7CiAKKwltdXRleF9pbml0KCZkaWdfcG9ydC0+dGNfbG9jayk7CiAJZGlnX3Bv
cnQtPnRjX2xlZ2FjeV9wb3J0ID0gaXNfbGVnYWN5OwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF90Yy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF90Yy5oCmluZGV4IDVhNzg3NmE3NDUyMi4uYjVhZjJmZTYwYjIyIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3RjLmgKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF90Yy5oCkBAIC0xNyw2ICsxNyw4IEBAIHUzMiBp
bnRlbF90Y19wb3J0X2dldF9sYW5lX21hc2soc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGln
X3BvcnQpOwogaW50IGludGVsX3RjX3BvcnRfZmlhX21heF9sYW5lX2NvdW50KHN0cnVjdCBpbnRl
bF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KTsKIAogdm9pZCBpbnRlbF90Y19wb3J0X3Nhbml0aXpl
KHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KTsKK3ZvaWQgaW50ZWxfdGNfcG9y
dF9sb2NrKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KTsKK3ZvaWQgaW50ZWxf
dGNfcG9ydF91bmxvY2soc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQpOwogCiB2
b2lkIGludGVsX3RjX3BvcnRfaW5pdChzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9y
dCwgYm9vbCBpc19sZWdhY3kpOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rydi5oCmluZGV4IDE5ZjZh
MzYwYWNkZS4uZDllN2QwMTFlZDRhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9kcnYuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcnYuaApAQCAtMTIy
NCw2ICsxMjI0LDcgQEAgc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCB7CiAJLyogVXNlZCBmb3Ig
RFAgYW5kIElDTCsgVHlwZUMvRFAgYW5kIFR5cGVDL0hETUkgcG9ydHMuICovCiAJZW51bSBhdXhf
Y2ggYXV4X2NoOwogCWVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZGRpX2lvX3Bvd2Vy
X2RvbWFpbjsKKwlzdHJ1Y3QgbXV0ZXggdGNfbG9jazsJLyogcHJvdGVjdHMgdGhlIFR5cGVDIHBv
cnQgbW9kZSAqLwogCWJvb2wgdGNfbGVnYWN5X3BvcnQ6MTsKIAljaGFyIHRjX3BvcnRfbmFtZVs4
XTsKIAllbnVtIHRjX3BvcnRfbW9kZSB0Y19tb2RlOwotLSAKMi4xNy4xCgpfX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0
CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3Rv
cC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

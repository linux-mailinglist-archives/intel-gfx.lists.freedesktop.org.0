Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id CCA8536708E
	for <lists+intel-gfx@lfdr.de>; Wed, 21 Apr 2021 18:49:18 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7B9886E9E0;
	Wed, 21 Apr 2021 16:49:15 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga02.intel.com (mga02.intel.com [134.134.136.20])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 950756E9E0
 for <intel-gfx@lists.freedesktop.org>; Wed, 21 Apr 2021 16:49:14 +0000 (UTC)
IronPort-SDR: SjRq6fzMnP/VMpSEoKCOJpfPRtFnwLRod8IJ5GAUlDIYUa95iVgC/T1KC/bGyYl7WD+2bSVgMz
 d6TpnylpvhLg==
X-IronPort-AV: E=McAfee;i="6200,9189,9961"; a="182864032"
X-IronPort-AV: E=Sophos;i="5.82,240,1613462400"; d="scan'208";a="182864032"
Received: from fmsmga001.fm.intel.com ([10.253.24.23])
 by orsmga101.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 21 Apr 2021 09:49:13 -0700
IronPort-SDR: dtUqC2bAXf3GmAFggMpx0UC5aVIXUjtkgqANW81mLbITUMH2Ktfu2cbQqbE1cuMuQAeem1B6F0
 cOz3PBogGKqA==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.82,240,1613462400"; d="scan'208";a="524353843"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.171])
 by fmsmga001.fm.intel.com with SMTP; 21 Apr 2021 09:49:11 -0700
Received: by stinkbox (sSMTP sendmail emulation);
 Wed, 21 Apr 2021 19:49:10 +0300
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 21 Apr 2021 19:48:39 +0300
Message-Id: <20210421164849.12806-8-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.26.3
In-Reply-To: <20210421164849.12806-1-ville.syrjala@linux.intel.com>
References: <20210421164849.12806-1-ville.syrjala@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 07/17] drm/i915;
 Return the whole buf_trans struct from get_buf_trans()
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KClJh
aXNlIHRoZSBhYnN0cmFjdGlvbiBsZXZlbCBvZiB0aGUgZ2V0X2J1Zl90cmFucygpIGZ1bmN0aW9u
cwphIGJpdCBtb3JlIGJ5IHJldHVybmluZyB0aGUgd2hvbGUgd3JhcHBlciBpbnRlbF9kZGlfYnVm
X3RyYW5zCnN0cnVjdC4KClNpZ25lZC1vZmYtYnk6IFZpbGxlIFN5cmrDpGzDpCA8dmlsbGUuc3ly
amFsYUBsaW51eC5pbnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kZGkuYyAgICAgIHwgNzYgKysrKysrKy0tLS0tLS0tCiAuLi4vZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9kZGlfYnVmX3RyYW5zLmMgICAgfCA5NCArKysrKysrKystLS0tLS0tLS0tCiAuLi4v
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGlfYnVmX3RyYW5zLmggICAgfCAyMCArKy0tCiAzIGZp
bGVzIGNoYW5nZWQsIDk1IGluc2VydGlvbnMoKyksIDk1IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RkaS5jCmluZGV4IGZkMmRmZjEwZmM4My4uNWFjMzFi
ZDEzYjNlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rk
aS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpLmMKQEAgLTEw
MCw3ICsxMDAsNyBAQCB2b2lkIGhzd19wcmVwYXJlX2RwX2RkaV9idWZmZXJzKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAogCXUzMiBpYm9vc3RfYml0ID0gMDsKIAlpbnQgaSwgbl9lbnRy
aWVzOwogCWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKLQljb25zdCB1bmlvbiBpbnRl
bF9kZGlfYnVmX3RyYW5zX2VudHJ5ICpkZGlfdHJhbnNsYXRpb25zOworCWNvbnN0IHN0cnVjdCBp
bnRlbF9kZGlfYnVmX3RyYW5zICpkZGlfdHJhbnNsYXRpb25zOwogCiAJZGRpX3RyYW5zbGF0aW9u
cyA9IGhzd19nZXRfYnVmX3RyYW5zKGVuY29kZXIsIGNydGNfc3RhdGUsICZuX2VudHJpZXMpOwog
CkBAIC0xMTQsOSArMTE0LDkgQEAgdm9pZCBoc3dfcHJlcGFyZV9kcF9kZGlfYnVmZmVycyhzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAogCWZvciAoaSA9IDA7IGkgPCBuX2VudHJpZXM7
IGkrKykgewogCQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgRERJX0JVRl9UUkFOU19MTyhwb3J0
LCBpKSwKLQkJCSAgICAgICBkZGlfdHJhbnNsYXRpb25zW2ldLmhzdy50cmFuczEgfCBpYm9vc3Rf
Yml0KTsKKwkJCSAgICAgICBkZGlfdHJhbnNsYXRpb25zLT5lbnRyaWVzW2ldLmhzdy50cmFuczEg
fCBpYm9vc3RfYml0KTsKIAkJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIERESV9CVUZfVFJBTlNf
SEkocG9ydCwgaSksCi0JCQkgICAgICAgZGRpX3RyYW5zbGF0aW9uc1tpXS5oc3cudHJhbnMyKTsK
KwkJCSAgICAgICBkZGlfdHJhbnNsYXRpb25zLT5lbnRyaWVzW2ldLmhzdy50cmFuczIpOwogCX0K
IH0KIApAQCAtMTMzLDcgKzEzMyw3IEBAIHN0YXRpYyB2b2lkIGhzd19wcmVwYXJlX2hkbWlfZGRp
X2J1ZmZlcnMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJdTMyIGlib29zdF9iaXQg
PSAwOwogCWludCBuX2VudHJpZXM7CiAJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owot
CWNvbnN0IHVuaW9uIGludGVsX2RkaV9idWZfdHJhbnNfZW50cnkgKmRkaV90cmFuc2xhdGlvbnM7
CisJY29uc3Qgc3RydWN0IGludGVsX2RkaV9idWZfdHJhbnMgKmRkaV90cmFuc2xhdGlvbnM7CiAK
IAlkZGlfdHJhbnNsYXRpb25zID0gaHN3X2dldF9idWZfdHJhbnMoZW5jb2RlciwgY3J0Y19zdGF0
ZSwgICZuX2VudHJpZXMpOwogCkBAIC0xNDksOSArMTQ5LDkgQEAgc3RhdGljIHZvaWQgaHN3X3By
ZXBhcmVfaGRtaV9kZGlfYnVmZmVycyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAog
CS8qIEVudHJ5IDkgaXMgZm9yIEhETUk6ICovCiAJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIERE
SV9CVUZfVFJBTlNfTE8ocG9ydCwgOSksCi0JCSAgICAgICBkZGlfdHJhbnNsYXRpb25zW2xldmVs
XS5oc3cudHJhbnMxIHwgaWJvb3N0X2JpdCk7CisJCSAgICAgICBkZGlfdHJhbnNsYXRpb25zLT5l
bnRyaWVzW2xldmVsXS5oc3cudHJhbnMxIHwgaWJvb3N0X2JpdCk7CiAJaW50ZWxfZGVfd3JpdGUo
ZGV2X3ByaXYsIERESV9CVUZfVFJBTlNfSEkocG9ydCwgOSksCi0JCSAgICAgICBkZGlfdHJhbnNs
YXRpb25zW2xldmVsXS5oc3cudHJhbnMyKTsKKwkJICAgICAgIGRkaV90cmFuc2xhdGlvbnMtPmVu
dHJpZXNbbGV2ZWxdLmhzdy50cmFuczIpOwogfQogCiB2b2lkIGludGVsX3dhaXRfZGRpX2J1Zl9p
ZGxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKQEAgLTkwOCw3ICs5MDgsNyBA
QCBzdGF0aWMgdm9pZCBza2xfZGRpX3NldF9pYm9vc3Qoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCiAJCWlib29zdCA9IGludGVsX2Jpb3NfZW5jb2Rlcl9kcF9ib29zdF9sZXZlbChlbmNv
ZGVyLT5kZXZkYXRhKTsKIAogCWlmIChpYm9vc3QgPT0gMCkgewotCQljb25zdCB1bmlvbiBpbnRl
bF9kZGlfYnVmX3RyYW5zX2VudHJ5ICpkZGlfdHJhbnNsYXRpb25zOworCQljb25zdCBzdHJ1Y3Qg
aW50ZWxfZGRpX2J1Zl90cmFucyAqZGRpX3RyYW5zbGF0aW9uczsKIAkJaW50IG5fZW50cmllczsK
IAogCQlkZGlfdHJhbnNsYXRpb25zID0gaHN3X2dldF9idWZfdHJhbnMoZW5jb2RlciwgY3J0Y19z
dGF0ZSwgJm5fZW50cmllcyk7CkBAIC05MTgsNyArOTE4LDcgQEAgc3RhdGljIHZvaWQgc2tsX2Rk
aV9zZXRfaWJvb3N0KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQlpZiAoZHJtX1dB
Uk5fT05fT05DRSgmZGV2X3ByaXYtPmRybSwgbGV2ZWwgPj0gbl9lbnRyaWVzKSkKIAkJCWxldmVs
ID0gbl9lbnRyaWVzIC0gMTsKIAotCQlpYm9vc3QgPSBkZGlfdHJhbnNsYXRpb25zW2xldmVsXS5o
c3cuaV9ib29zdDsKKwkJaWJvb3N0ID0gZGRpX3RyYW5zbGF0aW9ucy0+ZW50cmllc1tsZXZlbF0u
aHN3LmlfYm9vc3Q7CiAJfQogCiAJLyogTWFrZSBzdXJlIHRoYXQgdGhlIHJlcXVlc3RlZCBJX2Jv
b3N0IGlzIHZhbGlkICovCkBAIC05MzgsNyArOTM4LDcgQEAgc3RhdGljIHZvaWQgYnh0X2RkaV92
c3dpbmdfc2VxdWVuY2Uoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkJICAgIGlu
dCBsZXZlbCkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKLQljb25zdCB1bmlvbiBpbnRlbF9kZGlfYnVmX3RyYW5zX2Vu
dHJ5ICpkZGlfdHJhbnNsYXRpb25zOworCWNvbnN0IHN0cnVjdCBpbnRlbF9kZGlfYnVmX3RyYW5z
ICpkZGlfdHJhbnNsYXRpb25zOwogCWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKIAlp
bnQgbl9lbnRyaWVzOwogCkBAIC05NDksMTAgKzk0OSwxMCBAQCBzdGF0aWMgdm9pZCBieHRfZGRp
X3Zzd2luZ19zZXF1ZW5jZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJbGV2ZWwg
PSBuX2VudHJpZXMgLSAxOwogCiAJYnh0X2RkaV9waHlfc2V0X3NpZ25hbF9sZXZlbChkZXZfcHJp
diwgcG9ydCwKLQkJCQkgICAgIGRkaV90cmFuc2xhdGlvbnNbbGV2ZWxdLmJ4dC5tYXJnaW4sCi0J
CQkJICAgICBkZGlfdHJhbnNsYXRpb25zW2xldmVsXS5ieHQuc2NhbGUsCi0JCQkJICAgICBkZGlf
dHJhbnNsYXRpb25zW2xldmVsXS5ieHQuZW5hYmxlLAotCQkJCSAgICAgZGRpX3RyYW5zbGF0aW9u
c1tsZXZlbF0uYnh0LmRlZW1waGFzaXMpOworCQkJCSAgICAgZGRpX3RyYW5zbGF0aW9ucy0+ZW50
cmllc1tsZXZlbF0uYnh0Lm1hcmdpbiwKKwkJCQkgICAgIGRkaV90cmFuc2xhdGlvbnMtPmVudHJp
ZXNbbGV2ZWxdLmJ4dC5zY2FsZSwKKwkJCQkgICAgIGRkaV90cmFuc2xhdGlvbnMtPmVudHJpZXNb
bGV2ZWxdLmJ4dC5lbmFibGUsCisJCQkJICAgICBkZGlfdHJhbnNsYXRpb25zLT5lbnRyaWVzW2xl
dmVsXS5ieHQuZGVlbXBoYXNpcyk7CiB9CiAKIHN0YXRpYyB1OCBpbnRlbF9kZGlfZHBfdm9sdGFn
ZV9tYXgoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKQEAgLTEwMTEsNyArMTAxMSw3IEBAIHN0
YXRpYyB2b2lkIGNubF9kZGlfdnN3aW5nX3Byb2dyYW0oc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCiAJCQkJICAgaW50IGxldmVsKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwotCWNvbnN0IHVuaW9uIGludGVs
X2RkaV9idWZfdHJhbnNfZW50cnkgKmRkaV90cmFuc2xhdGlvbnM7CisJY29uc3Qgc3RydWN0IGlu
dGVsX2RkaV9idWZfdHJhbnMgKmRkaV90cmFuc2xhdGlvbnM7CiAJZW51bSBwb3J0IHBvcnQgPSBl
bmNvZGVyLT5wb3J0OwogCWludCBuX2VudHJpZXMsIGxuOwogCXUzMiB2YWw7CkBAIC0xMDMzLDgg
KzEwMzMsOCBAQCBzdGF0aWMgdm9pZCBjbmxfZGRpX3Zzd2luZ19wcm9ncmFtKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAogCXZhbCA9IGludGVsX2RlX3JlYWQoZGV2X3ByaXYsIENOTF9Q
T1JUX1RYX0RXMl9MTjAocG9ydCkpOwogCXZhbCAmPSB+KFNXSU5HX1NFTF9MT1dFUl9NQVNLIHwg
U1dJTkdfU0VMX1VQUEVSX01BU0sgfAogCQkgUkNPTVBfU0NBTEFSX01BU0spOwotCXZhbCB8PSBT
V0lOR19TRUxfVVBQRVIoZGRpX3RyYW5zbGF0aW9uc1tsZXZlbF0uY25sLmR3Ml9zd2luZ19zZWwp
OwotCXZhbCB8PSBTV0lOR19TRUxfTE9XRVIoZGRpX3RyYW5zbGF0aW9uc1tsZXZlbF0uY25sLmR3
Ml9zd2luZ19zZWwpOworCXZhbCB8PSBTV0lOR19TRUxfVVBQRVIoZGRpX3RyYW5zbGF0aW9ucy0+
ZW50cmllc1tsZXZlbF0uY25sLmR3Ml9zd2luZ19zZWwpOworCXZhbCB8PSBTV0lOR19TRUxfTE9X
RVIoZGRpX3RyYW5zbGF0aW9ucy0+ZW50cmllc1tsZXZlbF0uY25sLmR3Ml9zd2luZ19zZWwpOwog
CS8qIFJjb21wIHNjYWxhciBpcyBmaXhlZCBhcyAweDk4IGZvciBldmVyeSB0YWJsZSBlbnRyeSAq
LwogCXZhbCB8PSBSQ09NUF9TQ0FMQVIoMHg5OCk7CiAJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYs
IENOTF9QT1JUX1RYX0RXMl9HUlAocG9ydCksIHZhbCk7CkBAIC0xMDQ1LDkgKzEwNDUsOSBAQCBz
dGF0aWMgdm9pZCBjbmxfZGRpX3Zzd2luZ19wcm9ncmFtKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAogCQl2YWwgPSBpbnRlbF9kZV9yZWFkKGRldl9wcml2LCBDTkxfUE9SVF9UWF9EVzRf
TE4obG4sIHBvcnQpKTsKIAkJdmFsICY9IH4oUE9TVF9DVVJTT1JfMV9NQVNLIHwgUE9TVF9DVVJT
T1JfMl9NQVNLIHwKIAkJCSBDVVJTT1JfQ09FRkZfTUFTSyk7Ci0JCXZhbCB8PSBQT1NUX0NVUlNP
Ul8xKGRkaV90cmFuc2xhdGlvbnNbbGV2ZWxdLmNubC5kdzRfcG9zdF9jdXJzb3JfMSk7Ci0JCXZh
bCB8PSBQT1NUX0NVUlNPUl8yKGRkaV90cmFuc2xhdGlvbnNbbGV2ZWxdLmNubC5kdzRfcG9zdF9j
dXJzb3JfMik7Ci0JCXZhbCB8PSBDVVJTT1JfQ09FRkYoZGRpX3RyYW5zbGF0aW9uc1tsZXZlbF0u
Y25sLmR3NF9jdXJzb3JfY29lZmYpOworCQl2YWwgfD0gUE9TVF9DVVJTT1JfMShkZGlfdHJhbnNs
YXRpb25zLT5lbnRyaWVzW2xldmVsXS5jbmwuZHc0X3Bvc3RfY3Vyc29yXzEpOworCQl2YWwgfD0g
UE9TVF9DVVJTT1JfMihkZGlfdHJhbnNsYXRpb25zLT5lbnRyaWVzW2xldmVsXS5jbmwuZHc0X3Bv
c3RfY3Vyc29yXzIpOworCQl2YWwgfD0gQ1VSU09SX0NPRUZGKGRkaV90cmFuc2xhdGlvbnMtPmVu
dHJpZXNbbGV2ZWxdLmNubC5kdzRfY3Vyc29yX2NvZWZmKTsKIAkJaW50ZWxfZGVfd3JpdGUoZGV2
X3ByaXYsIENOTF9QT1JUX1RYX0RXNF9MTihsbiwgcG9ydCksIHZhbCk7CiAJfQogCkBAIC0xMDYy
LDcgKzEwNjIsNyBAQCBzdGF0aWMgdm9pZCBjbmxfZGRpX3Zzd2luZ19wcm9ncmFtKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyLAogCS8qIFByb2dyYW0gUE9SVF9UWF9EVzcgKi8KIAl2YWwg
PSBpbnRlbF9kZV9yZWFkKGRldl9wcml2LCBDTkxfUE9SVF9UWF9EVzdfTE4wKHBvcnQpKTsKIAl2
YWwgJj0gfk5fU0NBTEFSX01BU0s7Ci0JdmFsIHw9IE5fU0NBTEFSKGRkaV90cmFuc2xhdGlvbnNb
bGV2ZWxdLmNubC5kdzdfbl9zY2FsYXIpOworCXZhbCB8PSBOX1NDQUxBUihkZGlfdHJhbnNsYXRp
b25zLT5lbnRyaWVzW2xldmVsXS5jbmwuZHc3X25fc2NhbGFyKTsKIAlpbnRlbF9kZV93cml0ZShk
ZXZfcHJpdiwgQ05MX1BPUlRfVFhfRFc3X0dSUChwb3J0KSwgdmFsKTsKIH0KIApAQCAtMTEzMiw3
ICsxMTMyLDcgQEAgc3RhdGljIHZvaWQgaWNsX2RkaV9jb21ib192c3dpbmdfcHJvZ3JhbShzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCQkJIGludCBsZXZlbCkKIHsKIAlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsK
LQljb25zdCB1bmlvbiBpbnRlbF9kZGlfYnVmX3RyYW5zX2VudHJ5ICpkZGlfdHJhbnNsYXRpb25z
OworCWNvbnN0IHN0cnVjdCBpbnRlbF9kZGlfYnVmX3RyYW5zICpkZGlfdHJhbnNsYXRpb25zOwog
CWVudW0gcGh5IHBoeSA9IGludGVsX3BvcnRfdG9fcGh5KGRldl9wcml2LCBlbmNvZGVyLT5wb3J0
KTsKIAlpbnQgbl9lbnRyaWVzLCBsbjsKIAl1MzIgdmFsOwpAQCAtMTE3Myw4ICsxMTczLDggQEAg
c3RhdGljIHZvaWQgaWNsX2RkaV9jb21ib192c3dpbmdfcHJvZ3JhbShzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKIAl2YWwgPSBpbnRlbF9kZV9yZWFkKGRldl9wcml2LCBJQ0xfUE9SVF9U
WF9EVzJfTE4wKHBoeSkpOwogCXZhbCAmPSB+KFNXSU5HX1NFTF9MT1dFUl9NQVNLIHwgU1dJTkdf
U0VMX1VQUEVSX01BU0sgfAogCQkgUkNPTVBfU0NBTEFSX01BU0spOwotCXZhbCB8PSBTV0lOR19T
RUxfVVBQRVIoZGRpX3RyYW5zbGF0aW9uc1tsZXZlbF0uY25sLmR3Ml9zd2luZ19zZWwpOwotCXZh
bCB8PSBTV0lOR19TRUxfTE9XRVIoZGRpX3RyYW5zbGF0aW9uc1tsZXZlbF0uY25sLmR3Ml9zd2lu
Z19zZWwpOworCXZhbCB8PSBTV0lOR19TRUxfVVBQRVIoZGRpX3RyYW5zbGF0aW9ucy0+ZW50cmll
c1tsZXZlbF0uY25sLmR3Ml9zd2luZ19zZWwpOworCXZhbCB8PSBTV0lOR19TRUxfTE9XRVIoZGRp
X3RyYW5zbGF0aW9ucy0+ZW50cmllc1tsZXZlbF0uY25sLmR3Ml9zd2luZ19zZWwpOwogCS8qIFBy
b2dyYW0gUmNvbXAgc2NhbGFyIGZvciBldmVyeSB0YWJsZSBlbnRyeSAqLwogCXZhbCB8PSBSQ09N
UF9TQ0FMQVIoMHg5OCk7CiAJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIElDTF9QT1JUX1RYX0RX
Ml9HUlAocGh5KSwgdmFsKTsKQEAgLTExODUsMTYgKzExODUsMTYgQEAgc3RhdGljIHZvaWQgaWNs
X2RkaV9jb21ib192c3dpbmdfcHJvZ3JhbShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwK
IAkJdmFsID0gaW50ZWxfZGVfcmVhZChkZXZfcHJpdiwgSUNMX1BPUlRfVFhfRFc0X0xOKGxuLCBw
aHkpKTsKIAkJdmFsICY9IH4oUE9TVF9DVVJTT1JfMV9NQVNLIHwgUE9TVF9DVVJTT1JfMl9NQVNL
IHwKIAkJCSBDVVJTT1JfQ09FRkZfTUFTSyk7Ci0JCXZhbCB8PSBQT1NUX0NVUlNPUl8xKGRkaV90
cmFuc2xhdGlvbnNbbGV2ZWxdLmNubC5kdzRfcG9zdF9jdXJzb3JfMSk7Ci0JCXZhbCB8PSBQT1NU
X0NVUlNPUl8yKGRkaV90cmFuc2xhdGlvbnNbbGV2ZWxdLmNubC5kdzRfcG9zdF9jdXJzb3JfMik7
Ci0JCXZhbCB8PSBDVVJTT1JfQ09FRkYoZGRpX3RyYW5zbGF0aW9uc1tsZXZlbF0uY25sLmR3NF9j
dXJzb3JfY29lZmYpOworCQl2YWwgfD0gUE9TVF9DVVJTT1JfMShkZGlfdHJhbnNsYXRpb25zLT5l
bnRyaWVzW2xldmVsXS5jbmwuZHc0X3Bvc3RfY3Vyc29yXzEpOworCQl2YWwgfD0gUE9TVF9DVVJT
T1JfMihkZGlfdHJhbnNsYXRpb25zLT5lbnRyaWVzW2xldmVsXS5jbmwuZHc0X3Bvc3RfY3Vyc29y
XzIpOworCQl2YWwgfD0gQ1VSU09SX0NPRUZGKGRkaV90cmFuc2xhdGlvbnMtPmVudHJpZXNbbGV2
ZWxdLmNubC5kdzRfY3Vyc29yX2NvZWZmKTsKIAkJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIElD
TF9QT1JUX1RYX0RXNF9MTihsbiwgcGh5KSwgdmFsKTsKIAl9CiAKIAkvKiBQcm9ncmFtIFBPUlRf
VFhfRFc3ICovCiAJdmFsID0gaW50ZWxfZGVfcmVhZChkZXZfcHJpdiwgSUNMX1BPUlRfVFhfRFc3
X0xOMChwaHkpKTsKIAl2YWwgJj0gfk5fU0NBTEFSX01BU0s7Ci0JdmFsIHw9IE5fU0NBTEFSKGRk
aV90cmFuc2xhdGlvbnNbbGV2ZWxdLmNubC5kdzdfbl9zY2FsYXIpOworCXZhbCB8PSBOX1NDQUxB
UihkZGlfdHJhbnNsYXRpb25zLT5lbnRyaWVzW2xldmVsXS5jbmwuZHc3X25fc2NhbGFyKTsKIAlp
bnRlbF9kZV93cml0ZShkZXZfcHJpdiwgSUNMX1BPUlRfVFhfRFc3X0dSUChwaHkpLCB2YWwpOwog
fQogCkBAIC0xMjY1LDcgKzEyNjUsNyBAQCBzdGF0aWMgdm9pZCBpY2xfbWdfcGh5X2RkaV92c3dp
bmdfc2VxdWVuY2Uoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiB7CiAJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7CiAJ
ZW51bSB0Y19wb3J0IHRjX3BvcnQgPSBpbnRlbF9wb3J0X3RvX3RjKGRldl9wcml2LCBlbmNvZGVy
LT5wb3J0KTsKLQljb25zdCB1bmlvbiBpbnRlbF9kZGlfYnVmX3RyYW5zX2VudHJ5ICpkZGlfdHJh
bnNsYXRpb25zOworCWNvbnN0IHN0cnVjdCBpbnRlbF9kZGlfYnVmX3RyYW5zICpkZGlfdHJhbnNs
YXRpb25zOwogCWludCBuX2VudHJpZXMsIGxuOwogCXUzMiB2YWw7CiAKQEAgLTEyOTUsMTMgKzEy
OTUsMTMgQEAgc3RhdGljIHZvaWQgaWNsX21nX3BoeV9kZGlfdnN3aW5nX3NlcXVlbmNlKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQl2YWwgPSBpbnRlbF9kZV9yZWFkKGRldl9wcml2
LCBNR19UWDFfU1dJTkdDVFJMKGxuLCB0Y19wb3J0KSk7CiAJCXZhbCAmPSB+Q1JJX1RYREVFTVBI
X09WRVJSSURFXzE3XzEyX01BU0s7CiAJCXZhbCB8PSBDUklfVFhERUVNUEhfT1ZFUlJJREVfMTdf
MTIoCi0JCQlkZGlfdHJhbnNsYXRpb25zW2xldmVsXS5tZy5jcmlfdHhkZWVtcGhfb3ZlcnJpZGVf
MTdfMTIpOworCQkJZGRpX3RyYW5zbGF0aW9ucy0+ZW50cmllc1tsZXZlbF0ubWcuY3JpX3R4ZGVl
bXBoX292ZXJyaWRlXzE3XzEyKTsKIAkJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIE1HX1RYMV9T
V0lOR0NUUkwobG4sIHRjX3BvcnQpLCB2YWwpOwogCiAJCXZhbCA9IGludGVsX2RlX3JlYWQoZGV2
X3ByaXYsIE1HX1RYMl9TV0lOR0NUUkwobG4sIHRjX3BvcnQpKTsKIAkJdmFsICY9IH5DUklfVFhE
RUVNUEhfT1ZFUlJJREVfMTdfMTJfTUFTSzsKIAkJdmFsIHw9IENSSV9UWERFRU1QSF9PVkVSUklE
RV8xN18xMigKLQkJCWRkaV90cmFuc2xhdGlvbnNbbGV2ZWxdLm1nLmNyaV90eGRlZW1waF9vdmVy
cmlkZV8xN18xMik7CisJCQlkZGlfdHJhbnNsYXRpb25zLT5lbnRyaWVzW2xldmVsXS5tZy5jcmlf
dHhkZWVtcGhfb3ZlcnJpZGVfMTdfMTIpOwogCQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgTUdf
VFgyX1NXSU5HQ1RSTChsbiwgdGNfcG9ydCksIHZhbCk7CiAJfQogCkBAIC0xMzExLDkgKzEzMTEs
OSBAQCBzdGF0aWMgdm9pZCBpY2xfbWdfcGh5X2RkaV92c3dpbmdfc2VxdWVuY2Uoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCXZhbCAmPSB+KENSSV9UWERFRU1QSF9PVkVSUklERV8x
MV82X01BU0sgfAogCQkJIENSSV9UWERFRU1QSF9PVkVSUklERV81XzBfTUFTSyk7CiAJCXZhbCB8
PSBDUklfVFhERUVNUEhfT1ZFUlJJREVfNV8wKAotCQkJZGRpX3RyYW5zbGF0aW9uc1tsZXZlbF0u
bWcuY3JpX3R4ZGVlbXBoX292ZXJyaWRlXzVfMCkgfAorCQkJZGRpX3RyYW5zbGF0aW9ucy0+ZW50
cmllc1tsZXZlbF0ubWcuY3JpX3R4ZGVlbXBoX292ZXJyaWRlXzVfMCkgfAogCQkJQ1JJX1RYREVF
TVBIX09WRVJSSURFXzExXzYoCi0JCQkJZGRpX3RyYW5zbGF0aW9uc1tsZXZlbF0ubWcuY3JpX3R4
ZGVlbXBoX292ZXJyaWRlXzExXzYpIHwKKwkJCQlkZGlfdHJhbnNsYXRpb25zLT5lbnRyaWVzW2xl
dmVsXS5tZy5jcmlfdHhkZWVtcGhfb3ZlcnJpZGVfMTFfNikgfAogCQkJQ1JJX1RYREVFTVBIX09W
RVJSSURFX0VOOwogCQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgTUdfVFgxX0RSVkNUUkwobG4s
IHRjX3BvcnQpLCB2YWwpOwogCkBAIC0xMzIxLDkgKzEzMjEsOSBAQCBzdGF0aWMgdm9pZCBpY2xf
bWdfcGh5X2RkaV92c3dpbmdfc2VxdWVuY2Uoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
CiAJCXZhbCAmPSB+KENSSV9UWERFRU1QSF9PVkVSUklERV8xMV82X01BU0sgfAogCQkJIENSSV9U
WERFRU1QSF9PVkVSUklERV81XzBfTUFTSyk7CiAJCXZhbCB8PSBDUklfVFhERUVNUEhfT1ZFUlJJ
REVfNV8wKAotCQkJZGRpX3RyYW5zbGF0aW9uc1tsZXZlbF0ubWcuY3JpX3R4ZGVlbXBoX292ZXJy
aWRlXzVfMCkgfAorCQkJZGRpX3RyYW5zbGF0aW9ucy0+ZW50cmllc1tsZXZlbF0ubWcuY3JpX3R4
ZGVlbXBoX292ZXJyaWRlXzVfMCkgfAogCQkJQ1JJX1RYREVFTVBIX09WRVJSSURFXzExXzYoCi0J
CQkJZGRpX3RyYW5zbGF0aW9uc1tsZXZlbF0ubWcuY3JpX3R4ZGVlbXBoX292ZXJyaWRlXzExXzYp
IHwKKwkJCQlkZGlfdHJhbnNsYXRpb25zLT5lbnRyaWVzW2xldmVsXS5tZy5jcmlfdHhkZWVtcGhf
b3ZlcnJpZGVfMTFfNikgfAogCQkJQ1JJX1RYREVFTVBIX09WRVJSSURFX0VOOwogCQlpbnRlbF9k
ZV93cml0ZShkZXZfcHJpdiwgTUdfVFgyX0RSVkNUUkwobG4sIHRjX3BvcnQpLCB2YWwpOwogCkBA
IC0xNDAzLDcgKzE0MDMsNyBAQCB0Z2xfZGtsX3BoeV9kZGlfdnN3aW5nX3NlcXVlbmNlKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwogCWVudW0gdGNfcG9ydCB0Y19w
b3J0ID0gaW50ZWxfcG9ydF90b190YyhkZXZfcHJpdiwgZW5jb2Rlci0+cG9ydCk7Ci0JY29uc3Qg
dW5pb24gaW50ZWxfZGRpX2J1Zl90cmFuc19lbnRyeSAqZGRpX3RyYW5zbGF0aW9uczsKKwljb25z
dCBzdHJ1Y3QgaW50ZWxfZGRpX2J1Zl90cmFucyAqZGRpX3RyYW5zbGF0aW9uczsKIAl1MzIgdmFs
LCBkcGNudF9tYXNrLCBkcGNudF92YWw7CiAJaW50IG5fZW50cmllcywgbG47CiAKQEAgLTE0MjAs
OSArMTQyMCw5IEBAIHRnbF9ka2xfcGh5X2RkaV92c3dpbmdfc2VxdWVuY2Uoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsCiAJZHBjbnRfbWFzayA9IChES0xfVFhfUFJFU0hPT1RfQ09FRkZf
TUFTSyB8CiAJCSAgICAgIERLTF9UWF9ERV9FTVBBSFNJU19DT0VGRl9NQVNLIHwKIAkJICAgICAg
REtMX1RYX1ZTV0lOR19DT05UUk9MX01BU0spOwotCWRwY250X3ZhbCA9IERLTF9UWF9WU1dJTkdf
Q09OVFJPTChkZGlfdHJhbnNsYXRpb25zW2xldmVsXS5ka2wuZGtsX3Zzd2luZ19jb250cm9sKTsK
LQlkcGNudF92YWwgfD0gREtMX1RYX0RFX0VNUEhBU0lTX0NPRUZGKGRkaV90cmFuc2xhdGlvbnNb
bGV2ZWxdLmRrbC5ka2xfZGVfZW1waGFzaXNfY29udHJvbCk7Ci0JZHBjbnRfdmFsIHw9IERLTF9U
WF9QUkVTSE9PVF9DT0VGRihkZGlfdHJhbnNsYXRpb25zW2xldmVsXS5ka2wuZGtsX3ByZXNob290
X2NvbnRyb2wpOworCWRwY250X3ZhbCA9IERLTF9UWF9WU1dJTkdfQ09OVFJPTChkZGlfdHJhbnNs
YXRpb25zLT5lbnRyaWVzW2xldmVsXS5ka2wuZGtsX3Zzd2luZ19jb250cm9sKTsKKwlkcGNudF92
YWwgfD0gREtMX1RYX0RFX0VNUEhBU0lTX0NPRUZGKGRkaV90cmFuc2xhdGlvbnMtPmVudHJpZXNb
bGV2ZWxdLmRrbC5ka2xfZGVfZW1waGFzaXNfY29udHJvbCk7CisJZHBjbnRfdmFsIHw9IERLTF9U
WF9QUkVTSE9PVF9DT0VGRihkZGlfdHJhbnNsYXRpb25zLT5lbnRyaWVzW2xldmVsXS5ka2wuZGts
X3ByZXNob290X2NvbnRyb2wpOwogCiAJZm9yIChsbiA9IDA7IGxuIDwgMjsgbG4rKykgewogCQlp
bnRlbF9kZV93cml0ZShkZXZfcHJpdiwgSElQX0lOREVYX1JFRyh0Y19wb3J0KSwKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpX2J1Zl90cmFucy5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGlfYnVmX3RyYW5zLmMKaW5kZXgg
NDEzZTNjNTUwMjdlLi5kOTFiOTQ2ZGZhNjYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfZGRpX2J1Zl90cmFucy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfZGRpX2J1Zl90cmFucy5jCkBAIC05ODgsMTkgKzk4OCwxOSBAQCBz
dGF0aWMgY29uc3Qgc3RydWN0IGludGVsX2RkaV9idWZfdHJhbnMgcmtsX2NvbWJvX3BoeV9kZGlf
dHJhbnNsYXRpb25zX2RwX2hicjJfaAogCS5udW1fZW50cmllcyA9IEFSUkFZX1NJWkUoX3JrbF9j
b21ib19waHlfZGRpX3RyYW5zbGF0aW9uc19kcF9oYnIyX2hicjMpLAogfTsKIAotYm9vbCBpc19o
b2JsX2J1Zl90cmFucyhjb25zdCB1bmlvbiBpbnRlbF9kZGlfYnVmX3RyYW5zX2VudHJ5ICp0YWJs
ZSkKK2Jvb2wgaXNfaG9ibF9idWZfdHJhbnMoY29uc3Qgc3RydWN0IGludGVsX2RkaV9idWZfdHJh
bnMgKnRhYmxlKQogewotCXJldHVybiB0YWJsZSA9PSB0Z2xfY29tYm9fcGh5X2RkaV90cmFuc2xh
dGlvbnNfZWRwX2hicjJfaG9ibC5lbnRyaWVzOworCXJldHVybiB0YWJsZSA9PSAmdGdsX2NvbWJv
X3BoeV9kZGlfdHJhbnNsYXRpb25zX2VkcF9oYnIyX2hvYmw7CiB9CiAKLXN0YXRpYyBjb25zdCB1
bmlvbiBpbnRlbF9kZGlfYnVmX3RyYW5zX2VudHJ5ICoKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaW50
ZWxfZGRpX2J1Zl90cmFucyAqCiBpbnRlbF9nZXRfYnVmX3RyYW5zKGNvbnN0IHN0cnVjdCBpbnRl
bF9kZGlfYnVmX3RyYW5zICpkZGlfdHJhbnNsYXRpb25zLCBpbnQgKm51bV9lbnRyaWVzKQogewog
CSpudW1fZW50cmllcyA9IGRkaV90cmFuc2xhdGlvbnMtPm51bV9lbnRyaWVzOwotCXJldHVybiBk
ZGlfdHJhbnNsYXRpb25zLT5lbnRyaWVzOworCXJldHVybiBkZGlfdHJhbnNsYXRpb25zOwogfQog
Ci1zdGF0aWMgY29uc3QgdW5pb24gaW50ZWxfZGRpX2J1Zl90cmFuc19lbnRyeSAqCitzdGF0aWMg
Y29uc3Qgc3RydWN0IGludGVsX2RkaV9idWZfdHJhbnMgKgogYmR3X2dldF9idWZfdHJhbnNfZWRw
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLCBpbnQgKm5fZW50cmllcykKIHsKIAlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2
KTsKQEAgLTEwMTQsNyArMTAxNCw3IEBAIGJkd19nZXRfYnVmX3RyYW5zX2VkcChzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlciwgaW50ICpuX2VudHJpZXMpCiAJfQogfQogCi1zdGF0aWMgY29u
c3QgdW5pb24gaW50ZWxfZGRpX2J1Zl90cmFuc19lbnRyeSAqCitzdGF0aWMgY29uc3Qgc3RydWN0
IGludGVsX2RkaV9idWZfdHJhbnMgKgogc2tsX2dldF9idWZfdHJhbnNfZHAoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsIGludCAqbl9lbnRyaWVzKQogewogCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwpAQCAtMTAzMSw3
ICsxMDMxLDcgQEAgc2tsX2dldF9idWZfdHJhbnNfZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsIGludCAqbl9lbnRyaWVzKQogCX0KIH0KIAotc3RhdGljIGNvbnN0IHVuaW9uIGludGVs
X2RkaV9idWZfdHJhbnNfZW50cnkgKgorc3RhdGljIGNvbnN0IHN0cnVjdCBpbnRlbF9kZGlfYnVm
X3RyYW5zICoKIGtibF9nZXRfYnVmX3RyYW5zX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyLCBpbnQgKm5fZW50cmllcykKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKQEAgLTEwNTIsNyArMTA1Miw3IEBAIGti
bF9nZXRfYnVmX3RyYW5zX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLCBpbnQgKm5f
ZW50cmllcykKIAl9CiB9CiAKLXN0YXRpYyBjb25zdCB1bmlvbiBpbnRlbF9kZGlfYnVmX3RyYW5z
X2VudHJ5ICoKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaW50ZWxfZGRpX2J1Zl90cmFucyAqCiBza2xf
Z2V0X2J1Zl90cmFuc19lZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsIGludCAqbl9l
bnRyaWVzKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZW5jb2Rlci0+YmFzZS5kZXYpOwpAQCAtMTA4NCw3ICsxMDg0LDcgQEAgc2tsX2dldF9idWZfdHJh
bnNfZWRwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLCBpbnQgKm5fZW50cmllcykKIAkJ
cmV0dXJuIHNrbF9nZXRfYnVmX3RyYW5zX2RwKGVuY29kZXIsIG5fZW50cmllcyk7CiB9CiAKLXN0
YXRpYyBjb25zdCB1bmlvbiBpbnRlbF9kZGlfYnVmX3RyYW5zX2VudHJ5ICoKK3N0YXRpYyBjb25z
dCBzdHJ1Y3QgaW50ZWxfZGRpX2J1Zl90cmFucyAqCiBza2xfZ2V0X2J1Zl90cmFuc19oZG1pKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50ICpuX2VudHJpZXMpCiB7CiAJaWYg
KElTX1NLTF9VTFgoZGV2X3ByaXYpIHx8CkBAIC0xMTA4LDcgKzExMDgsNyBAQCBzdGF0aWMgaW50
IHNrbF9idWZfdHJhbnNfbnVtX2VudHJpZXMoZW51bSBwb3J0IHBvcnQsIGludCBuX2VudHJpZXMp
CiAJCXJldHVybiBtaW4obl9lbnRyaWVzLCA5KTsKIH0KIAotc3RhdGljIGNvbnN0IHVuaW9uIGlu
dGVsX2RkaV9idWZfdHJhbnNfZW50cnkgKgorc3RhdGljIGNvbnN0IHN0cnVjdCBpbnRlbF9kZGlf
YnVmX3RyYW5zICoKIGhzd19nZXRfYnVmX3RyYW5zX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLCBpbnQgKm5fZW50cmllcykKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKQEAgLTExMTYsMTIgKzExMTYsMTIg
QEAgaHN3X2dldF9idWZfdHJhbnNfZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsIGlu
dCAqbl9lbnRyaWVzKQogCWlmIChJU19LQUJZTEFLRShkZXZfcHJpdikgfHwKIAkgICAgSVNfQ09G
RkVFTEFLRShkZXZfcHJpdikgfHwKIAkgICAgSVNfQ09NRVRMQUtFKGRldl9wcml2KSkgewotCQlj
b25zdCB1bmlvbiBpbnRlbF9kZGlfYnVmX3RyYW5zX2VudHJ5ICpkZGlfdHJhbnNsYXRpb25zID0K
KwkJY29uc3Qgc3RydWN0IGludGVsX2RkaV9idWZfdHJhbnMgKmRkaV90cmFuc2xhdGlvbnMgPQog
CQkJa2JsX2dldF9idWZfdHJhbnNfZHAoZW5jb2Rlciwgbl9lbnRyaWVzKTsKIAkJKm5fZW50cmll
cyA9IHNrbF9idWZfdHJhbnNfbnVtX2VudHJpZXMoZW5jb2Rlci0+cG9ydCwgKm5fZW50cmllcyk7
CiAJCXJldHVybiBkZGlfdHJhbnNsYXRpb25zOwogCX0gZWxzZSBpZiAoSVNfU0tZTEFLRShkZXZf
cHJpdikpIHsKLQkJY29uc3QgdW5pb24gaW50ZWxfZGRpX2J1Zl90cmFuc19lbnRyeSAqZGRpX3Ry
YW5zbGF0aW9ucyA9CisJCWNvbnN0IHN0cnVjdCBpbnRlbF9kZGlfYnVmX3RyYW5zICpkZGlfdHJh
bnNsYXRpb25zID0KIAkJCXNrbF9nZXRfYnVmX3RyYW5zX2RwKGVuY29kZXIsIG5fZW50cmllcyk7
CiAJCSpuX2VudHJpZXMgPSBza2xfYnVmX3RyYW5zX251bV9lbnRyaWVzKGVuY29kZXItPnBvcnQs
ICpuX2VudHJpZXMpOwogCQlyZXR1cm4gZGRpX3RyYW5zbGF0aW9uczsKQEAgLTExMzcsMTMgKzEx
MzcsMTMgQEAgaHN3X2dldF9idWZfdHJhbnNfZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsIGludCAqbl9lbnRyaWVzKQogCXJldHVybiBOVUxMOwogfQogCi1zdGF0aWMgY29uc3QgdW5p
b24gaW50ZWxfZGRpX2J1Zl90cmFuc19lbnRyeSAqCitzdGF0aWMgY29uc3Qgc3RydWN0IGludGVs
X2RkaV9idWZfdHJhbnMgKgogaHN3X2dldF9idWZfdHJhbnNfZWRwKHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyLCBpbnQgKm5fZW50cmllcykKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKIAogCWlmIChESVNQTEFZ
X1ZFUihkZXZfcHJpdikgPT0gOSAmJiAhSVNfQlJPWFRPTihkZXZfcHJpdikpIHsKLQkJY29uc3Qg
dW5pb24gaW50ZWxfZGRpX2J1Zl90cmFuc19lbnRyeSAqZGRpX3RyYW5zbGF0aW9ucyA9CisJCWNv
bnN0IHN0cnVjdCBpbnRlbF9kZGlfYnVmX3RyYW5zICpkZGlfdHJhbnNsYXRpb25zID0KIAkJCXNr
bF9nZXRfYnVmX3RyYW5zX2VkcChlbmNvZGVyLCBuX2VudHJpZXMpOwogCQkqbl9lbnRyaWVzID0g
c2tsX2J1Zl90cmFuc19udW1fZW50cmllcyhlbmNvZGVyLT5wb3J0LCAqbl9lbnRyaWVzKTsKIAkJ
cmV0dXJuIGRkaV90cmFuc2xhdGlvbnM7CkBAIC0xMTU4LDcgKzExNTgsNyBAQCBoc3dfZ2V0X2J1
Zl90cmFuc19lZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsIGludCAqbl9lbnRyaWVz
KQogCXJldHVybiBOVUxMOwogfQogCi1zdGF0aWMgY29uc3QgdW5pb24gaW50ZWxfZGRpX2J1Zl90
cmFuc19lbnRyeSAqCitzdGF0aWMgY29uc3Qgc3RydWN0IGludGVsX2RkaV9idWZfdHJhbnMgKgog
aHN3X2dldF9idWZfdHJhbnNfZmRpKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkg
ICAgICBpbnQgKm5fZW50cmllcykKIHsKQEAgLTExNzYsNyArMTE3Niw3IEBAIGhzd19nZXRfYnVm
X3RyYW5zX2ZkaShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAlyZXR1cm4gTlVMTDsK
IH0KIAotc3RhdGljIGNvbnN0IHVuaW9uIGludGVsX2RkaV9idWZfdHJhbnNfZW50cnkgKgorc3Rh
dGljIGNvbnN0IHN0cnVjdCBpbnRlbF9kZGlfYnVmX3RyYW5zICoKIGhzd19nZXRfYnVmX3RyYW5z
X2hkbWkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCSAgICAgICBpbnQgKm5fZW50
cmllcykKIHsKQEAgLTExOTYsNyArMTE5Niw3IEBAIGhzd19nZXRfYnVmX3RyYW5zX2hkbWkoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJcmV0dXJuIE5VTEw7CiB9CiAKLWNvbnN0IHVu
aW9uIGludGVsX2RkaV9idWZfdHJhbnNfZW50cnkgKgorY29uc3Qgc3RydWN0IGludGVsX2RkaV9i
dWZfdHJhbnMgKgogaHN3X2dldF9idWZfdHJhbnMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsCiAJCSAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCSAg
aW50ICpuX2VudHJpZXMpCkBAIC0xMjExLDEzICsxMjExLDEzIEBAIGhzd19nZXRfYnVmX3RyYW5z
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQlyZXR1cm4gaHN3X2dldF9idWZfdHJh
bnNfZHAoZW5jb2Rlciwgbl9lbnRyaWVzKTsKIH0KIAotc3RhdGljIGNvbnN0IHVuaW9uIGludGVs
X2RkaV9idWZfdHJhbnNfZW50cnkgKgorc3RhdGljIGNvbnN0IHN0cnVjdCBpbnRlbF9kZGlfYnVm
X3RyYW5zICoKIGJ4dF9nZXRfYnVmX3RyYW5zX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyLCBpbnQgKm5fZW50cmllcykKIHsKIAlyZXR1cm4gaW50ZWxfZ2V0X2J1Zl90cmFucygmYnh0
X2RkaV90cmFuc2xhdGlvbnNfZHAsIG5fZW50cmllcyk7CiB9CiAKLXN0YXRpYyBjb25zdCB1bmlv
biBpbnRlbF9kZGlfYnVmX3RyYW5zX2VudHJ5ICoKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaW50ZWxf
ZGRpX2J1Zl90cmFucyAqCiBieHRfZ2V0X2J1Zl90cmFuc19lZHAoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIsIGludCAqbl9lbnRyaWVzKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwpAQCAtMTIzMCwxMyArMTIz
MCwxMyBAQCBieHRfZ2V0X2J1Zl90cmFuc19lZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsIGludCAqbl9lbnRyaWVzKQogCXJldHVybiBieHRfZ2V0X2J1Zl90cmFuc19kcChlbmNvZGVy
LCBuX2VudHJpZXMpOwogfQogCi1zdGF0aWMgY29uc3QgdW5pb24gaW50ZWxfZGRpX2J1Zl90cmFu
c19lbnRyeSAqCitzdGF0aWMgY29uc3Qgc3RydWN0IGludGVsX2RkaV9idWZfdHJhbnMgKgogYnh0
X2dldF9idWZfdHJhbnNfaGRtaShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwgaW50ICpu
X2VudHJpZXMpCiB7CiAJcmV0dXJuIGludGVsX2dldF9idWZfdHJhbnMoJmJ4dF9kZGlfdHJhbnNs
YXRpb25zX2hkbWksIG5fZW50cmllcyk7CiB9CiAKLWNvbnN0IHVuaW9uIGludGVsX2RkaV9idWZf
dHJhbnNfZW50cnkgKgorY29uc3Qgc3RydWN0IGludGVsX2RkaV9idWZfdHJhbnMgKgogYnh0X2dl
dF9idWZfdHJhbnMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCSAgY29uc3Qgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCSAgaW50ICpuX2VudHJpZXMpCkBA
IC0xMjQ4LDcgKzEyNDgsNyBAQCBieHRfZ2V0X2J1Zl90cmFucyhzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKIAlyZXR1cm4gYnh0X2dldF9idWZfdHJhbnNfZHAoZW5jb2Rlciwgbl9lbnRy
aWVzKTsKIH0KIAotc3RhdGljIGNvbnN0IHVuaW9uIGludGVsX2RkaV9idWZfdHJhbnNfZW50cnkg
Kgorc3RhdGljIGNvbnN0IHN0cnVjdCBpbnRlbF9kZGlfYnVmX3RyYW5zICoKIGNubF9nZXRfYnVm
X3RyYW5zX2hkbWkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsIGludCAqbl9lbnRyaWVz
KQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rl
ci0+YmFzZS5kZXYpOwpAQCAtMTI3MCw3ICsxMjcwLDcgQEAgY25sX2dldF9idWZfdHJhbnNfaGRt
aShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwgaW50ICpuX2VudHJpZXMpCiAJcmV0dXJu
IE5VTEw7CiB9CiAKLXN0YXRpYyBjb25zdCB1bmlvbiBpbnRlbF9kZGlfYnVmX3RyYW5zX2VudHJ5
ICoKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaW50ZWxfZGRpX2J1Zl90cmFucyAqCiBjbmxfZ2V0X2J1
Zl90cmFuc19kcChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwgaW50ICpuX2VudHJpZXMp
CiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVy
LT5iYXNlLmRldik7CkBAIC0xMjkyLDcgKzEyOTIsNyBAQCBjbmxfZ2V0X2J1Zl90cmFuc19kcChz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwgaW50ICpuX2VudHJpZXMpCiAJcmV0dXJuIE5V
TEw7CiB9CiAKLXN0YXRpYyBjb25zdCB1bmlvbiBpbnRlbF9kZGlfYnVmX3RyYW5zX2VudHJ5ICoK
K3N0YXRpYyBjb25zdCBzdHJ1Y3QgaW50ZWxfZGRpX2J1Zl90cmFucyAqCiBjbmxfZ2V0X2J1Zl90
cmFuc19lZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsIGludCAqbl9lbnRyaWVzKQog
ewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+
YmFzZS5kZXYpOwpAQCAtMTMxOCw3ICsxMzE4LDcgQEAgY25sX2dldF9idWZfdHJhbnNfZWRwKHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLCBpbnQgKm5fZW50cmllcykKIAl9CiB9CiAKLWNv
bnN0IHVuaW9uIGludGVsX2RkaV9idWZfdHJhbnNfZW50cnkgKgorY29uc3Qgc3RydWN0IGludGVs
X2RkaV9idWZfdHJhbnMgKgogY25sX2dldF9idWZfdHJhbnMoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCiAJCSAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
CiAJCSAgaW50ICpuX2VudHJpZXMpCkBAIC0xMzMwLDcgKzEzMzAsNyBAQCBjbmxfZ2V0X2J1Zl90
cmFucyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAlyZXR1cm4gY25sX2dldF9idWZf
dHJhbnNfZHAoZW5jb2Rlciwgbl9lbnRyaWVzKTsKIH0KIAotc3RhdGljIGNvbnN0IHVuaW9uIGlu
dGVsX2RkaV9idWZfdHJhbnNfZW50cnkgKgorc3RhdGljIGNvbnN0IHN0cnVjdCBpbnRlbF9kZGlf
YnVmX3RyYW5zICoKIGljbF9nZXRfY29tYm9fYnVmX3RyYW5zX2hkbWkoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmVuY29kZXIsCiAJCQkgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLAogCQkJICAgICBpbnQgKm5fZW50cmllcykKQEAgLTEzMzksNyArMTMzOSw3IEBA
IGljbF9nZXRfY29tYm9fYnVmX3RyYW5zX2hkbWkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsCiAJCQkJICAgbl9lbnRyaWVzKTsKIH0KIAotc3RhdGljIGNvbnN0IHVuaW9uIGludGVsX2Rk
aV9idWZfdHJhbnNfZW50cnkgKgorc3RhdGljIGNvbnN0IHN0cnVjdCBpbnRlbF9kZGlfYnVmX3Ry
YW5zICoKIGljbF9nZXRfY29tYm9fYnVmX3RyYW5zX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAogCQkJICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
CiAJCQkgICBpbnQgKm5fZW50cmllcykKQEAgLTEzNDgsNyArMTM0OCw3IEBAIGljbF9nZXRfY29t
Ym9fYnVmX3RyYW5zX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJCSAgIG5f
ZW50cmllcyk7CiB9CiAKLXN0YXRpYyBjb25zdCB1bmlvbiBpbnRlbF9kZGlfYnVmX3RyYW5zX2Vu
dHJ5ICoKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaW50ZWxfZGRpX2J1Zl90cmFucyAqCiBpY2xfZ2V0
X2NvbWJvX2J1Zl90cmFuc19lZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkg
ICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCQkgICAgaW50
ICpuX2VudHJpZXMpCkBAIC0xMzcyLDcgKzEzNzIsNyBAQCBpY2xfZ2V0X2NvbWJvX2J1Zl90cmFu
c19lZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJcmV0dXJuIGljbF9nZXRfY29t
Ym9fYnVmX3RyYW5zX2RwKGVuY29kZXIsIGNydGNfc3RhdGUsIG5fZW50cmllcyk7CiB9CiAKLWNv
bnN0IHVuaW9uIGludGVsX2RkaV9idWZfdHJhbnNfZW50cnkgKgorY29uc3Qgc3RydWN0IGludGVs
X2RkaV9idWZfdHJhbnMgKgogaWNsX2dldF9jb21ib19idWZfdHJhbnMoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmVuY29kZXIsCiAJCQljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSwKIAkJCWludCAqbl9lbnRyaWVzKQpAQCAtMTM4NSw3ICsxMzg1LDcgQEAgaWNsX2dldF9j
b21ib19idWZfdHJhbnMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCXJldHVybiBp
Y2xfZ2V0X2NvbWJvX2J1Zl90cmFuc19kcChlbmNvZGVyLCBjcnRjX3N0YXRlLCBuX2VudHJpZXMp
OwogfQogCi1zdGF0aWMgY29uc3QgdW5pb24gaW50ZWxfZGRpX2J1Zl90cmFuc19lbnRyeSAqCitz
dGF0aWMgY29uc3Qgc3RydWN0IGludGVsX2RkaV9idWZfdHJhbnMgKgogaWNsX2dldF9tZ19idWZf
dHJhbnNfaGRtaShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCSAgY29uc3Qgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCQkgIGludCAqbl9lbnRyaWVzKQpA
QCAtMTM5NCw3ICsxMzk0LDcgQEAgaWNsX2dldF9tZ19idWZfdHJhbnNfaGRtaShzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCQkgICBuX2VudHJpZXMpOwogfQogCi1zdGF0aWMgY29u
c3QgdW5pb24gaW50ZWxfZGRpX2J1Zl90cmFuc19lbnRyeSAqCitzdGF0aWMgY29uc3Qgc3RydWN0
IGludGVsX2RkaV9idWZfdHJhbnMgKgogaWNsX2dldF9tZ19idWZfdHJhbnNfZHAoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSwKIAkJCWludCAqbl9lbnRyaWVzKQpAQCAtMTQwOCw3ICsxNDA4LDcgQEAgaWNs
X2dldF9tZ19idWZfdHJhbnNfZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJfQog
fQogCi1jb25zdCB1bmlvbiBpbnRlbF9kZGlfYnVmX3RyYW5zX2VudHJ5ICoKK2NvbnN0IHN0cnVj
dCBpbnRlbF9kZGlfYnVmX3RyYW5zICoKIGljbF9nZXRfbWdfYnVmX3RyYW5zKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAogCQkgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlLAogCQkgICAgIGludCAqbl9lbnRyaWVzKQpAQCAtMTQxOSw3ICsxNDE5LDcg
QEAgaWNsX2dldF9tZ19idWZfdHJhbnMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJ
CXJldHVybiBpY2xfZ2V0X21nX2J1Zl90cmFuc19kcChlbmNvZGVyLCBjcnRjX3N0YXRlLCBuX2Vu
dHJpZXMpOwogfQogCi1zdGF0aWMgY29uc3QgdW5pb24gaW50ZWxfZGRpX2J1Zl90cmFuc19lbnRy
eSAqCitzdGF0aWMgY29uc3Qgc3RydWN0IGludGVsX2RkaV9idWZfdHJhbnMgKgogZWhsX2dldF9j
b21ib19idWZfdHJhbnNfaGRtaShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCSAg
ICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCQkgICAgIGlu
dCAqbl9lbnRyaWVzKQpAQCAtMTQyOCw3ICsxNDI4LDcgQEAgZWhsX2dldF9jb21ib19idWZfdHJh
bnNfaGRtaShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCQkgICBuX2VudHJpZXMp
OwogfQogCi1zdGF0aWMgY29uc3QgdW5pb24gaW50ZWxfZGRpX2J1Zl90cmFuc19lbnRyeSAqCitz
dGF0aWMgY29uc3Qgc3RydWN0IGludGVsX2RkaV9idWZfdHJhbnMgKgogZWhsX2dldF9jb21ib19i
dWZfdHJhbnNfZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkgICBjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCSAgIGludCAqbl9lbnRyaWVz
KQpAQCAtMTQzNyw3ICsxNDM3LDcgQEAgZWhsX2dldF9jb21ib19idWZfdHJhbnNfZHAoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkJICAgbl9lbnRyaWVzKTsKIH0KIAotc3RhdGlj
IGNvbnN0IHVuaW9uIGludGVsX2RkaV9idWZfdHJhbnNfZW50cnkgKgorc3RhdGljIGNvbnN0IHN0
cnVjdCBpbnRlbF9kZGlfYnVmX3RyYW5zICoKIGVobF9nZXRfY29tYm9fYnVmX3RyYW5zX2VkcChz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCSAgICBpbnQgKm5fZW50cmllcykKQEAgLTE0NTIs
NyArMTQ1Miw3IEBAIGVobF9nZXRfY29tYm9fYnVmX3RyYW5zX2VkcChzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKIAlyZXR1cm4gZWhsX2dldF9jb21ib19idWZfdHJhbnNfZHAoZW5jb2Rl
ciwgY3J0Y19zdGF0ZSwgbl9lbnRyaWVzKTsKIH0KIAotY29uc3QgdW5pb24gaW50ZWxfZGRpX2J1
Zl90cmFuc19lbnRyeSAqCitjb25zdCBzdHJ1Y3QgaW50ZWxfZGRpX2J1Zl90cmFucyAqCiBlaGxf
Z2V0X2NvbWJvX2J1Zl90cmFucyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCWNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCQkJaW50ICpuX2VudHJp
ZXMpCkBAIC0xNDY1LDcgKzE0NjUsNyBAQCBlaGxfZ2V0X2NvbWJvX2J1Zl90cmFucyhzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJcmV0dXJuIGVobF9nZXRfY29tYm9fYnVmX3RyYW5z
X2RwKGVuY29kZXIsIGNydGNfc3RhdGUsIG5fZW50cmllcyk7CiB9CiAKLXN0YXRpYyBjb25zdCB1
bmlvbiBpbnRlbF9kZGlfYnVmX3RyYW5zX2VudHJ5ICoKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaW50
ZWxfZGRpX2J1Zl90cmFucyAqCiBqc2xfZ2V0X2NvbWJvX2J1Zl90cmFuc19oZG1pKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCSAgICAgaW50ICpuX2VudHJpZXMpCkBAIC0xNDc0LDcgKzE0
NzQsNyBAQCBqc2xfZ2V0X2NvbWJvX2J1Zl90cmFuc19oZG1pKHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLAogCQkJCSAgIG5fZW50cmllcyk7CiB9CiAKLXN0YXRpYyBjb25zdCB1bmlvbiBp
bnRlbF9kZGlfYnVmX3RyYW5zX2VudHJ5ICoKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaW50ZWxfZGRp
X2J1Zl90cmFucyAqCiBqc2xfZ2V0X2NvbWJvX2J1Zl90cmFuc19kcChzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKIAkJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlLAogCQkJICAgaW50ICpuX2VudHJpZXMpCkBAIC0xNDgzLDcgKzE0ODMsNyBAQCBqc2xf
Z2V0X2NvbWJvX2J1Zl90cmFuc19kcChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJ
CQkgICBuX2VudHJpZXMpOwogfQogCi1zdGF0aWMgY29uc3QgdW5pb24gaW50ZWxfZGRpX2J1Zl90
cmFuc19lbnRyeSAqCitzdGF0aWMgY29uc3Qgc3RydWN0IGludGVsX2RkaV9idWZfdHJhbnMgKgog
anNsX2dldF9jb21ib19idWZfdHJhbnNfZWRwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAogCQkJICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCQkJ
ICAgIGludCAqbl9lbnRyaWVzKQpAQCAtMTUwMyw3ICsxNTAzLDcgQEAganNsX2dldF9jb21ib19i
dWZfdHJhbnNfZWRwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCXJldHVybiBqc2xf
Z2V0X2NvbWJvX2J1Zl90cmFuc19kcChlbmNvZGVyLCBjcnRjX3N0YXRlLCBuX2VudHJpZXMpOwog
fQogCi1jb25zdCB1bmlvbiBpbnRlbF9kZGlfYnVmX3RyYW5zX2VudHJ5ICoKK2NvbnN0IHN0cnVj
dCBpbnRlbF9kZGlfYnVmX3RyYW5zICoKIGpzbF9nZXRfY29tYm9fYnVmX3RyYW5zKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUsCiAJCQlpbnQgKm5fZW50cmllcykKQEAgLTE1MTYsNyArMTUxNiw3IEBAIGpz
bF9nZXRfY29tYm9fYnVmX3RyYW5zKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQly
ZXR1cm4ganNsX2dldF9jb21ib19idWZfdHJhbnNfZHAoZW5jb2RlciwgY3J0Y19zdGF0ZSwgbl9l
bnRyaWVzKTsKIH0KIAotc3RhdGljIGNvbnN0IHVuaW9uIGludGVsX2RkaV9idWZfdHJhbnNfZW50
cnkgKgorc3RhdGljIGNvbnN0IHN0cnVjdCBpbnRlbF9kZGlfYnVmX3RyYW5zICoKIHRnbF9nZXRf
Y29tYm9fYnVmX3RyYW5zX2hkbWkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkg
ICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCQkJICAgICBp
bnQgKm5fZW50cmllcykKQEAgLTE1MjUsNyArMTUyNSw3IEBAIHRnbF9nZXRfY29tYm9fYnVmX3Ry
YW5zX2hkbWkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkJICAgbl9lbnRyaWVz
KTsKIH0KIAotc3RhdGljIGNvbnN0IHVuaW9uIGludGVsX2RkaV9idWZfdHJhbnNfZW50cnkgKgor
c3RhdGljIGNvbnN0IHN0cnVjdCBpbnRlbF9kZGlfYnVmX3RyYW5zICoKIHRnbF9nZXRfY29tYm9f
YnVmX3RyYW5zX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJICAgY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCQkgICBpbnQgKm5fZW50cmll
cykKQEAgLTE1NTQsNyArMTU1NCw3IEBAIHRnbF9nZXRfY29tYm9fYnVmX3RyYW5zX2RwKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCX0KIH0KIAotc3RhdGljIGNvbnN0IHVuaW9uIGlu
dGVsX2RkaV9idWZfdHJhbnNfZW50cnkgKgorc3RhdGljIGNvbnN0IHN0cnVjdCBpbnRlbF9kZGlf
YnVmX3RyYW5zICoKIHRnbF9nZXRfY29tYm9fYnVmX3RyYW5zX2VkcChzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKIAkJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSwKIAkJCSAgICBpbnQgKm5fZW50cmllcykKQEAgLTE1NzYsNyArMTU3Niw3IEBAIHRn
bF9nZXRfY29tYm9fYnVmX3RyYW5zX2VkcChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwK
IAlyZXR1cm4gdGdsX2dldF9jb21ib19idWZfdHJhbnNfZHAoZW5jb2RlciwgY3J0Y19zdGF0ZSwg
bl9lbnRyaWVzKTsKIH0KIAotY29uc3QgdW5pb24gaW50ZWxfZGRpX2J1Zl90cmFuc19lbnRyeSAq
Citjb25zdCBzdHJ1Y3QgaW50ZWxfZGRpX2J1Zl90cmFucyAqCiB0Z2xfZ2V0X2NvbWJvX2J1Zl90
cmFucyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCWNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCQkJaW50ICpuX2VudHJpZXMpCkBAIC0xNTg5LDcg
KzE1ODksNyBAQCB0Z2xfZ2V0X2NvbWJvX2J1Zl90cmFucyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlciwKIAkJcmV0dXJuIHRnbF9nZXRfY29tYm9fYnVmX3RyYW5zX2RwKGVuY29kZXIsIGNy
dGNfc3RhdGUsIG5fZW50cmllcyk7CiB9CiAKLXN0YXRpYyBjb25zdCB1bmlvbiBpbnRlbF9kZGlf
YnVmX3RyYW5zX2VudHJ5ICoKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaW50ZWxfZGRpX2J1Zl90cmFu
cyAqCiB0Z2xfZ2V0X2RrbF9idWZfdHJhbnNfaGRtaShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKIAkJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAog
CQkJICAgaW50ICpuX2VudHJpZXMpCkBAIC0xNTk4LDcgKzE1OTgsNyBAQCB0Z2xfZ2V0X2RrbF9i
dWZfdHJhbnNfaGRtaShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCQkgICBuX2Vu
dHJpZXMpOwogfQogCi1zdGF0aWMgY29uc3QgdW5pb24gaW50ZWxfZGRpX2J1Zl90cmFuc19lbnRy
eSAqCitzdGF0aWMgY29uc3Qgc3RydWN0IGludGVsX2RkaV9idWZfdHJhbnMgKgogdGdsX2dldF9k
a2xfYnVmX3RyYW5zX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJIGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCQkJIGludCAqbl9lbnRyaWVz
KQpAQCAtMTYxMiw3ICsxNjEyLDcgQEAgdGdsX2dldF9ka2xfYnVmX3RyYW5zX2RwKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyLAogCX0KIH0KIAotY29uc3QgdW5pb24gaW50ZWxfZGRpX2J1
Zl90cmFuc19lbnRyeSAqCitjb25zdCBzdHJ1Y3QgaW50ZWxfZGRpX2J1Zl90cmFucyAqCiB0Z2xf
Z2V0X2RrbF9idWZfdHJhbnMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCSAgICAg
IGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCQkgICAgICBpbnQg
Km5fZW50cmllcykKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfZGRpX2J1Zl90cmFucy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9k
ZGlfYnVmX3RyYW5zLmgKaW5kZXggMzYzZjk2NzA5MDc5Li4yNDA3MjQxMWUwYjAgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpX2J1Zl90cmFucy5oCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpX2J1Zl90cmFucy5oCkBA
IC01OCw0OCArNTgsNDggQEAgc3RydWN0IGludGVsX2RkaV9idWZfdHJhbnMgewogCXU4IG51bV9l
bnRyaWVzOwogfTsKIAotYm9vbCBpc19ob2JsX2J1Zl90cmFucyhjb25zdCB1bmlvbiBpbnRlbF9k
ZGlfYnVmX3RyYW5zX2VudHJ5ICp0YWJsZSk7Citib29sIGlzX2hvYmxfYnVmX3RyYW5zKGNvbnN0
IHN0cnVjdCBpbnRlbF9kZGlfYnVmX3RyYW5zICp0YWJsZSk7CiAKIGludCBpbnRlbF9kZGlfaGRt
aV9udW1fZW50cmllcyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCSAgICAgICBj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCSAgICAgICBpbnQg
KmRlZmF1bHRfZW50cnkpOwogCi1jb25zdCB1bmlvbiBpbnRlbF9kZGlfYnVmX3RyYW5zX2VudHJ5
ICoKK2NvbnN0IHN0cnVjdCBpbnRlbF9kZGlfYnVmX3RyYW5zICoKIGhzd19nZXRfYnVmX3RyYW5z
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCQkgIGludCAqbl9lbnRyaWVzKTsKIAotY29uc3QgdW5p
b24gaW50ZWxfZGRpX2J1Zl90cmFuc19lbnRyeSAqCitjb25zdCBzdHJ1Y3QgaW50ZWxfZGRpX2J1
Zl90cmFucyAqCiBieHRfZ2V0X2J1Zl90cmFucyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKIAkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJICBp
bnQgKm5fZW50cmllcyk7CiAKLWNvbnN0IHVuaW9uIGludGVsX2RkaV9idWZfdHJhbnNfZW50cnkg
KgorY29uc3Qgc3RydWN0IGludGVsX2RkaV9idWZfdHJhbnMgKgogdGdsX2dldF9jb21ib19idWZf
dHJhbnMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQljb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCWludCAqbl9lbnRyaWVzKTsKLWNvbnN0IHVu
aW9uIGludGVsX2RkaV9idWZfdHJhbnNfZW50cnkgKgorY29uc3Qgc3RydWN0IGludGVsX2RkaV9i
dWZfdHJhbnMgKgogdGdsX2dldF9ka2xfYnVmX3RyYW5zKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAogCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSwKIAkJICAgICAgaW50ICpuX2VudHJpZXMpOwotY29uc3QgdW5pb24gaW50ZWxfZGRpX2J1Zl90
cmFuc19lbnRyeSAqCitjb25zdCBzdHJ1Y3QgaW50ZWxfZGRpX2J1Zl90cmFucyAqCiBqc2xfZ2V0
X2NvbWJvX2J1Zl90cmFucyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCWNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCQkJaW50ICpuX2VudHJpZXMp
OwotY29uc3QgdW5pb24gaW50ZWxfZGRpX2J1Zl90cmFuc19lbnRyeSAqCitjb25zdCBzdHJ1Y3Qg
aW50ZWxfZGRpX2J1Zl90cmFucyAqCiBlaGxfZ2V0X2NvbWJvX2J1Zl90cmFucyhzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCWNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLAogCQkJaW50ICpuX2VudHJpZXMpOwotY29uc3QgdW5pb24gaW50ZWxfZGRpX2J1
Zl90cmFuc19lbnRyeSAqCitjb25zdCBzdHJ1Y3QgaW50ZWxfZGRpX2J1Zl90cmFucyAqCiBpY2xf
Z2V0X2NvbWJvX2J1Zl90cmFucyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCWNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCQkJaW50ICpuX2VudHJp
ZXMpOwotY29uc3QgdW5pb24gaW50ZWxfZGRpX2J1Zl90cmFuc19lbnRyeSAqCitjb25zdCBzdHJ1
Y3QgaW50ZWxfZGRpX2J1Zl90cmFucyAqCiBpY2xfZ2V0X21nX2J1Zl90cmFucyhzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSwKIAkJICAgICBpbnQgKm5fZW50cmllcyk7CiAKLWNvbnN0IHVuaW9uIGlu
dGVsX2RkaV9idWZfdHJhbnNfZW50cnkgKgorY29uc3Qgc3RydWN0IGludGVsX2RkaV9idWZfdHJh
bnMgKgogY25sX2dldF9idWZfdHJhbnMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJ
CSAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCSAgaW50ICpu
X2VudHJpZXMpOwotLSAKMi4yNi4zCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVl
ZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5m
by9pbnRlbC1nZngK

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 407C7217B8
	for <lists+intel-gfx@lfdr.de>; Fri, 17 May 2019 13:26:14 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 652578997E;
	Fri, 17 May 2019 11:26:11 +0000 (UTC)
X-Original-To: Intel-gfx@lists.freedesktop.org
Delivered-To: Intel-gfx@lists.freedesktop.org
Received: from mga04.intel.com (mga04.intel.com [192.55.52.120])
 by gabe.freedesktop.org (Postfix) with ESMTPS id DEADC8995F;
 Fri, 17 May 2019 11:25:56 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga005.fm.intel.com ([10.253.24.32])
 by fmsmga104.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 17 May 2019 04:25:56 -0700
X-ExtLoop1: 1
Received: from kmarenda-mobl2.ger.corp.intel.com (HELO localhost.localdomain)
 ([10.252.11.159])
 by fmsmga005.fm.intel.com with ESMTP; 17 May 2019 04:25:55 -0700
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
To: igt-dev@lists.freedesktop.org
Date: Fri, 17 May 2019 12:25:22 +0100
Message-Id: <20190517112526.6738-22-tvrtko.ursulin@linux.intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190517112526.6738-1-tvrtko.ursulin@linux.intel.com>
References: <20190517112526.6738-1-tvrtko.ursulin@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t 21/25] gem_wsim: Allow RCS virtual engine
 with SSEU control
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Intel-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KClRvIGFsbG93
IGV4ZXJjaXNpbmcgdGhlIFNTRVUgY29uZmlndXJhdGlvbiBpbiBjb21iaW5hdGlvbiB3aXRoIFZp
cnR1YWwKRW5naW5lLCBhbGxvdyBSQ1MgdG8gYmUgc3BlY2lmaWVkIGluIHRoZSBlbmdpbmUgbWFw
IGFuZCB1c2UgYXBwcm9wcmlhdGUKaW5kZXggYmFzZWQgYWRkcmVzc2luZyB3aGVuIGFwcGx5aW5n
IFNTRVUgY29uZmlndXJhdGlvbiB0byBpdC4KClNpZ25lZC1vZmYtYnk6IFR2cnRrbyBVcnN1bGlu
IDx0dnJ0a28udXJzdWxpbkBpbnRlbC5jb20+Ci0tLQogYmVuY2htYXJrcy9nZW1fd3NpbS5jIHwg
NTEgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLQogMSBmaWxlIGNo
YW5nZWQsIDM2IGluc2VydGlvbnMoKyksIDE1IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2Jl
bmNobWFya3MvZ2VtX3dzaW0uYyBiL2JlbmNobWFya3MvZ2VtX3dzaW0uYwppbmRleCBmZWI5NjUw
NTg4YTEuLmFmMDQyZDcxYzFkMyAxMDA2NDQKLS0tIGEvYmVuY2htYXJrcy9nZW1fd3NpbS5jCisr
KyBiL2JlbmNobWFya3MvZ2VtX3dzaW0uYwpAQCAtMzgyLDcgKzM4Miw4IEBAIHN0YXRpYyBpbnQg
cGFyc2VfZW5naW5lX21hcChzdHJ1Y3Qgd19zdGVwICpzdGVwLCBjb25zdCBjaGFyICpfc3RyKQog
CQlpZiAoKGludCllbmdpbmUgPCAwKQogCQkJcmV0dXJuIC0xOwogCi0JCWlmIChlbmdpbmUgIT0g
VkNTICYmIGVuZ2luZSAhPSBWQ1MxICYmIGVuZ2luZSAhPSBWQ1MyKQorCQlpZiAoZW5naW5lICE9
IFZDUyAmJiBlbmdpbmUgIT0gVkNTMSAmJiBlbmdpbmUgIT0gVkNTMiAmJgorCQkgICAgZW5naW5l
ICE9IFJDUykKIAkJCXJldHVybiAtMTsgLyogVE9ETyAqLwogCiAJCWFkZCA9IGVuZ2luZSA9PSBW
Q1MgPyAyIDogMTsKQEAgLTExODMsNyArMTE4NCw3IEBAIHN0YXRpYyBzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX2NvbnRleHRfcGFyYW1fc3NldSBnZXRfZGV2aWNlX3NzZXUodm9pZCkKIH0KIAogc3RhdGlj
IHVpbnQ2NF90Ci1zZXRfY3R4X3NzZXUodWludDMyX3QgY3R4LCB1aW50NjRfdCBzbGljZV9tYXNr
KQorc2V0X2N0eF9zc2V1KHN0cnVjdCBjdHggKmN0eCwgdWludDY0X3Qgc2xpY2VfbWFzaykKIHsK
IAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2NvbnRleHRfcGFyYW1fc3NldSBzc2V1ID0gZ2V0X2Rldmlj
ZV9zc2V1KCk7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9jb250ZXh0X3BhcmFtIHBhcmFtID0geyB9
OwpAQCAtMTE5MSwxMCArMTE5MiwxNyBAQCBzZXRfY3R4X3NzZXUodWludDMyX3QgY3R4LCB1aW50
NjRfdCBzbGljZV9tYXNrKQogCWlmIChzbGljZV9tYXNrID09IC0xKQogCQlzbGljZV9tYXNrID0g
ZGV2aWNlX3NzZXUuc2xpY2VfbWFzazsKIAorCWlmIChjdHgtPmVuZ2luZV9tYXAgJiYgY3R4LT53
YW50c19iYWxhbmNlKSB7CisJCXNzZXUuZmxhZ3MgPSBJOTE1X0NPTlRFWFRfU1NFVV9GTEFHX0VO
R0lORV9JTkRFWDsKKwkJc3NldS5lbmdpbmUuZW5naW5lX2NsYXNzID0gSTkxNV9FTkdJTkVfQ0xB
U1NfSU5WQUxJRDsKKwkJc3NldS5lbmdpbmUuZW5naW5lX2luc3RhbmNlID0gMDsKKwl9CisKIAlz
c2V1LnNsaWNlX21hc2sgPSBzbGljZV9tYXNrOwogCi0JcGFyYW0uY3R4X2lkID0gY3R4OworCXBh
cmFtLmN0eF9pZCA9IGN0eC0+aWQ7CiAJcGFyYW0ucGFyYW0gPSBJOTE1X0NPTlRFWFRfUEFSQU1f
U1NFVTsKKwlwYXJhbS5zaXplID0gc2l6ZW9mKHNzZXUpOwogCXBhcmFtLnZhbHVlID0gKHVpbnRw
dHJfdCkmc3NldTsKIAogCWdlbV9jb250ZXh0X3NldF9wYXJhbShmZCwgJnBhcmFtKTsKQEAgLTE0
NjUsMTAgKzE0NzMsMTcgQEAgcHJlcGFyZV93b3JrbG9hZCh1bnNpZ25lZCBpbnQgaWQsIHN0cnVj
dCB3b3JrbG9hZCAqd3JrLCB1bnNpZ25lZCBpbnQgZmxhZ3MpCiAJCQkJCWN0eC0+ZW5naW5lX21h
cF9jb3VudDsKIAogCQkJCWZvciAoaiA9IDA7IGogPCBjdHgtPmVuZ2luZV9tYXBfY291bnQ7IGor
KykgewotCQkJCQlsb2FkX2JhbGFuY2UuZW5naW5lc1tqXS5lbmdpbmVfY2xhc3MgPQotCQkJCQkJ
STkxNV9FTkdJTkVfQ0xBU1NfVklERU87IC8qIEZJWE1FICovCi0JCQkJCWxvYWRfYmFsYW5jZS5l
bmdpbmVzW2pdLmVuZ2luZV9pbnN0YW5jZSA9Ci0JCQkJCQljdHgtPmVuZ2luZV9tYXBbal0gLSBW
Q1MxOyAvKiBGSVhNRSAqLworCQkJCQlpZiAoY3R4LT5lbmdpbmVfbWFwW2pdID09IFJDUykgewor
CQkJCQkJbG9hZF9iYWxhbmNlLmVuZ2luZXNbal0uZW5naW5lX2NsYXNzID0KKwkJCQkJCQlJOTE1
X0VOR0lORV9DTEFTU19SRU5ERVI7CisJCQkJCQlsb2FkX2JhbGFuY2UuZW5naW5lc1tqXS5lbmdp
bmVfaW5zdGFuY2UgPQorCQkJCQkJCTA7IC8qIEZJWE1FICovCisJCQkJCX0gZWxzZSB7CisJCQkJ
CQlsb2FkX2JhbGFuY2UuZW5naW5lc1tqXS5lbmdpbmVfY2xhc3MgPQorCQkJCQkJCUk5MTVfRU5H
SU5FX0NMQVNTX1ZJREVPOyAvKiBGSVhNRSAqLworCQkJCQkJbG9hZF9iYWxhbmNlLmVuZ2luZXNb
al0uZW5naW5lX2luc3RhbmNlID0KKwkJCQkJCQljdHgtPmVuZ2luZV9tYXBbal0gLSBWQ1MxOyAv
KiBGSVhNRSAqLworCQkJCQl9CiAJCQkJfQogCQkJfSBlbHNlIHsKIAkJCQlzZXRfZW5naW5lcy5l
eHRlbnNpb25zID0gMDsKQEAgLTE0ODEsMTAgKzE0OTYsMTYgQEAgcHJlcGFyZV93b3JrbG9hZCh1
bnNpZ25lZCBpbnQgaWQsIHN0cnVjdCB3b3JrbG9hZCAqd3JrLCB1bnNpZ25lZCBpbnQgZmxhZ3Mp
CiAJCQkJSTkxNV9FTkdJTkVfQ0xBU1NfSU5WQUxJRF9OT05FOwogCiAJCQlmb3IgKGogPSAxOyBq
IDw9IGN0eC0+ZW5naW5lX21hcF9jb3VudDsgaisrKSB7Ci0JCQkJc2V0X2VuZ2luZXMuZW5naW5l
c1tqXS5lbmdpbmVfY2xhc3MgPQotCQkJCQlJOTE1X0VOR0lORV9DTEFTU19WSURFTzsgLyogRklY
TUUgKi8KLQkJCQlzZXRfZW5naW5lcy5lbmdpbmVzW2pdLmVuZ2luZV9pbnN0YW5jZSA9Ci0JCQkJ
CWN0eC0+ZW5naW5lX21hcFtqIC0gMV0gLSBWQ1MxOyAvKiBGSVhNRSAqLworCQkJCWlmIChjdHgt
PmVuZ2luZV9tYXBbaiAtIDFdID09IFJDUykgeworCQkJCQlzZXRfZW5naW5lcy5lbmdpbmVzW2pd
LmVuZ2luZV9jbGFzcyA9CisJCQkJCQlJOTE1X0VOR0lORV9DTEFTU19SRU5ERVI7CisJCQkJCXNl
dF9lbmdpbmVzLmVuZ2luZXNbal0uZW5naW5lX2luc3RhbmNlID0gMDsgLyogRklYTUUgKi8KKwkJ
CQl9IGVsc2UgeworCQkJCQlzZXRfZW5naW5lcy5lbmdpbmVzW2pdLmVuZ2luZV9jbGFzcyA9CisJ
CQkJCQlJOTE1X0VOR0lORV9DTEFTU19WSURFTzsgLyogRklYTUUgKi8KKwkJCQkJc2V0X2VuZ2lu
ZXMuZW5naW5lc1tqXS5lbmdpbmVfaW5zdGFuY2UgPQorCQkJCQkJY3R4LT5lbmdpbmVfbWFwW2og
LSAxXSAtIFZDUzE7IC8qIEZJWE1FICovCisJCQkJfQogCQkJfQogCiAJCQlmb3IgKGogPSAwOyBq
IDwgY3R4LT5ib25kX2NvdW50OyBqKyspIHsKQEAgLTE1NjMsNyArMTU4NCw3IEBAIHByZXBhcmVf
d29ya2xvYWQodW5zaWduZWQgaW50IGlkLCBzdHJ1Y3Qgd29ya2xvYWQgKndyaywgdW5zaWduZWQg
aW50IGZsYWdzKQogCiAJCWlmICh3cmstPnNzZXUpIHsKIAkJCS8qIFNldCB0byBzbGljZSAwIG9u
bHksIG9uZSBzbGljZS4gKi8KLQkJCWN0eC0+c3NldSA9IHNldF9jdHhfc3NldShjdHhfaWQsIDEp
OworCQkJY3R4LT5zc2V1ID0gc2V0X2N0eF9zc2V1KGN0eCwgMSk7CiAJCX0KIAogCQlpZiAoc2hh
cmVfdm0pCkBAIC0yNTQ3LDkgKzI1NjgsOSBAQCBzdGF0aWMgdm9pZCAqcnVuX3dvcmtsb2FkKHZv
aWQgKmRhdGEpCiAJCQkJICAgdy0+dHlwZSA9PSBCT05EKSB7CiAJCQkJY29udGludWU7CiAJCQl9
IGVsc2UgaWYgKHctPnR5cGUgPT0gU1NFVSkgewotCQkJCWlmICh3LT5zc2V1ICE9IHdyay0+Y3R4
X2xpc3Rbdy0+Y29udGV4dF0uc3NldSkgewotCQkJCQl3cmstPmN0eF9saXN0W3ctPmNvbnRleHRd
LnNzZXUgPQotCQkJCQkJc2V0X2N0eF9zc2V1KHdyay0+Y3R4X2xpc3Rbdy0+Y29udGV4dF0uaWQs
CisJCQkJaWYgKHctPnNzZXUgIT0gd3JrLT5jdHhfbGlzdFt3LT5jb250ZXh0ICogMl0uc3NldSkg
eworCQkJCQl3cmstPmN0eF9saXN0W3ctPmNvbnRleHQgKiAyXS5zc2V1ID0KKwkJCQkJCXNldF9j
dHhfc3NldSgmd3JrLT5jdHhfbGlzdFt3LT5jb250ZXh0ICogMl0sCiAJCQkJCQkJICAgICB3LT5z
c2V1KTsKIAkJCQl9CiAJCQkJY29udGludWU7Ci0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50
ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9y
Zy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

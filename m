Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 8EB12BEB96
	for <lists+intel-gfx@lfdr.de>; Thu, 26 Sep 2019 07:18:12 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 560D36ECC1;
	Thu, 26 Sep 2019 05:18:10 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga12.intel.com (mga12.intel.com [192.55.52.136])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6B4636ECC1
 for <intel-gfx@lists.freedesktop.org>; Thu, 26 Sep 2019 05:18:09 +0000 (UTC)
X-Amp-Result: UNKNOWN
X-Amp-Original-Verdict: FILE UNKNOWN
X-Amp-File-Uploaded: False
Received: from fmsmga008.fm.intel.com ([10.253.24.58])
 by fmsmga106.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 25 Sep 2019 22:18:08 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,550,1559545200"; d="scan'208";a="189003246"
Received: from mdroper-desk1.fm.intel.com (HELO
 mdroper-desk1.amr.corp.intel.com) ([10.1.27.135])
 by fmsmga008.fm.intel.com with ESMTP; 25 Sep 2019 22:18:07 -0700
Date: Wed, 25 Sep 2019 22:18:19 -0700
From: Matt Roper <matthew.d.roper@intel.com>
To: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
Message-ID: <20190926051819.GW1869@mdroper-desk1.amr.corp.intel.com>
References: <20190920114235.22411-1-maarten.lankhorst@linux.intel.com>
 <20190920114235.22411-12-maarten.lankhorst@linux.intel.com>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <20190920114235.22411-12-maarten.lankhorst@linux.intel.com>
User-Agent: Mutt/1.12.1 (2019-06-15)
Subject: Re: [Intel-gfx] [PATCH 12/23] drm/i915: Enable big joiner support
 in enable and disable sequences.
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: intel-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T24gRnJpLCBTZXAgMjAsIDIwMTkgYXQgMDE6NDI6MjRQTSArMDIwMCwgTWFhcnRlbiBMYW5raG9y
c3Qgd3JvdGU6Cj4gTWFrZSB2ZHNjIHdvcmsgd2hlbiBubyBvdXRwdXQgaXMgZW5hYmxlZC4gVGhl
IGJpZyBqb2luZXIgbmVlZHMgVkRTQwo+IG9uIHRoZSBzbGF2ZSwgc28gZW5hYmxlIGl0IGFuZCBz
ZXQgdGhlIGFwcHJvcHJpYXRlIGJpdHMuCj4gQWxzbyB1cGRhdGUgdGltZXN0YW1waW5nIGNvbnN0
YW50cywgYmVjYXVzZSBzbGF2ZSBjcnRjJ3MgYXJlIG5vdAo+IHVwZGF0ZWQgaW4gZHJtX2F0b21p
Y19oZWxwZXJfdXBkYXRlX2xlZ2FjeV9tb2Rlc2V0X3N0YXRlKCkuCj4gCj4gVGhpcyBzaG91bGQg
YmUgZW5vdWdoIHRvIGJyaW5nIHVwIENSVEMncyBpbiBhIGJpZyBqb2luZXIgY29uZmlndXJhdGlv
biwKPiB3aXRob3V0IGFueSBwbGFuZSBjb25maWd1cmF0aW9uIG9uIHRoZSBzZWNvbmQgcGlwZSB5
ZXQuCj4gCj4gSE9XRVZFUiwgd2UgYnJpbmcgdXAgdGhlIGNydGMncyBpbiB0aGUgd3Jvbmcgb3Jk
ZXIuIFdlIG5lZWQgdG8gbWFrZQo+IHN1cmUgdGhhdCB0aGUgbWFzdGVyIGNydGMgaXMgYnJvdWdo
dCB1cCBhZnRlciB0aGUgc2xhdmUgY3J0Yywgd2UKPiBkb24ndCBkbyB0aGF0IHlldC4gVGhpcyBp
cyBkb25lIGNvcnJlY3RseSBsYXRlciBpbiB0aGlzIHNlcmllcy4KPiAKPiBUaGUgbmV4dCBzdGVw
cyBhcmUgdG8gYWRkIGF0b21pYyBjb21taXQsIGFuZCBtYWtlIHN1cmUgd2UgZW5hYmxlIGFuZAo+
IHVwZGF0ZSBib3RoIG1hc3RlciBhbmQgc2xhdmUgaW4gdGhlIGNvcnJlY3Qgb3JkZXIuCj4gCj4g
U2lnbmVkLW9mZi1ieTogTWFhcnRlbiBMYW5raG9yc3QgPG1hYXJ0ZW4ubGFua2hvcnN0QGxpbnV4
LmludGVsLmNvbT4KCkEgY291cGxlIG1pbm9yIGNvbW1lbnRzIGlubGluZSBiZWxvdywgYnV0IEkg
ZGlkbid0IHNlZSBhbnkgY2xlYXIKcHJvYmxlbXMgd2l0aCB0aGlzIHBhdGNoIHNvCgpBY2tlZC1i
eTogTWF0dCBSb3BlciA8bWF0dGhldy5kLnJvcGVyQGludGVsLmNvbT4KCkhvd2V2ZXIgdGhlcmUn
cyBhIGxvdCBvZiBwcmV0dHkgY29tcGxpY2F0ZWQgY2hhbmdlcyBoZXJlIGluIGFyZWFzIHRoYXQK
SSdtIG9ubHkgdmFndWVseSBmYW1pbGlhciB3aXRoLCBzbyBJIHRoaW5rIGl0IHdvdWxkIGJlIGdv
b2QgaWYgc29tZW9uZQpsaWtlIE1hbmFzaSB3aG8ncyBtb3JlIGZhbWlsaWFyIHdpdGggdGhpcyBh
cmVhIG9mIHRoZSBjb2RlIGNvdWxkIGxvb2sgaXQKb3Zlci4KCgpNYXR0CgoKPiAtLS0KPiAgZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGkuYyAgICAgIHwgIDU1ICsrLQo+ICBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyAgfCA0MDIgKysrKysr
KysrKysrLS0tLS0tCj4gIC4uLi9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMu
aCAgICB8ICAxNyArCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHAuYyAg
ICAgICB8ICAxOCArLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Zkc2Mu
YyAgICAgfCAxMjIgKysrKy0tCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
dmRzYy5oICAgICB8ICAgMiArCj4gIDYgZmlsZXMgY2hhbmdlZCwgNDE4IGluc2VydGlvbnMoKyks
IDE5OCBkZWxldGlvbnMoLSkKPiAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF9kZGkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZGRpLmMKPiBpbmRleCBjNzc1ZmQyMDU5MTUuLmEyNjE1NWY5MDI2MSAxMDA2NDQKPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RkaS5jCj4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGkuYwo+IEBAIC0xNjk0LDYgKzE2OTQsMTMgQEAg
c3RhdGljIHZvaWQgaW50ZWxfZGRpX2Nsb2NrX2dldChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKPiAgCQlza2xfZGRpX2Nsb2NrX2dldChlbmNvZGVyLCBwaXBlX2NvbmZpZyk7Cj4gIAll
bHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDgpCj4gIAkJaHN3X2RkaV9jbG9ja19nZXQo
ZW5jb2RlciwgcGlwZV9jb25maWcpOwo+ICsKPiArCWlmIChwaXBlX2NvbmZpZy0+Ymlnam9pbmVy
KSB7Cj4gKwkJcGlwZV9jb25maWctPmh3LnRyYW5zY29kZXJfbW9kZS5jcnRjX2Nsb2NrID0KPiAr
CQkJcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUuY3J0Y19jbG9jazsKPiArCj4gKwkJcGlw
ZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUuY3J0Y19jbG9jayAvPSAyOwo+ICsJfQo+ICB9Cj4g
IAo+ICB2b2lkIGludGVsX2RkaV9zZXRfcGlwZV9zZXR0aW5ncyhjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiBAQCAtMjE3NiwxMyArMjE4Myw2IEBAIHN0YXRpYyB2
b2lkIGludGVsX2RkaV9nZXRfcG93ZXJfZG9tYWlucyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKPiAgCSAgICBpbnRlbF9waHlfaXNfdGMoZGV2X3ByaXYsIHBoeSkpCj4gIAkJaW50ZWxf
ZGlzcGxheV9wb3dlcl9nZXQoZGV2X3ByaXYsCj4gIAkJCQkJaW50ZWxfZGRpX21haW5fbGlua19h
dXhfZG9tYWluKGRpZ19wb3J0KSk7Cj4gLQo+IC0JLyoKPiAtCSAqIFZEU0MgcG93ZXIgaXMgbmVl
ZGVkIHdoZW4gRFNDIGlzIGVuYWJsZWQKPiAtCSAqLwo+IC0JaWYgKGNydGNfc3RhdGUtPmRzY19w
YXJhbXMuY29tcHJlc3Npb25fZW5hYmxlKQo+IC0JCWludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGRl
dl9wcml2LAo+IC0JCQkJCWludGVsX2RzY19wb3dlcl9kb21haW4oY3J0Y19zdGF0ZSkpOwo+ICB9
Cj4gIAo+ICB2b2lkIGludGVsX2RkaV9lbmFibGVfcGlwZV9jbG9jayhjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiBAQCAtMzI5MCw3ICszMjkwLDggQEAgc3RhdGlj
IHZvaWQgdGdsX2RkaV9wcmVfZW5hYmxlX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ICAKPiAgCS8qIDcubCAqLwo+ICAJaW50ZWxfZGRpX2VuYWJsZV9mZWMoZW5jb2RlciwgY3J0
Y19zdGF0ZSk7Cj4gLQlpbnRlbF9kc2NfZW5hYmxlKGVuY29kZXIsIGNydGNfc3RhdGUpOwo+ICsJ
aWYgKCFjcnRjX3N0YXRlLT5iaWdqb2luZXIpCj4gKwkJaW50ZWxfZHNjX2VuYWJsZShlbmNvZGVy
LCBjcnRjX3N0YXRlKTsKPiAgfQo+ICAKPiAgc3RhdGljIHZvaWQgaHN3X2RkaV9wcmVfZW5hYmxl
X2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+IEBAIC0zMzYxLDcgKzMzNjIsOCBA
QCBzdGF0aWMgdm9pZCBoc3dfZGRpX3ByZV9lbmFibGVfZHAoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4gIAlpZiAoIWlzX21zdCkKPiAgCQlpbnRlbF9kZGlfZW5hYmxlX3BpcGVfY2xv
Y2soY3J0Y19zdGF0ZSk7Cj4gIAo+IC0JaW50ZWxfZHNjX2VuYWJsZShlbmNvZGVyLCBjcnRjX3N0
YXRlKTsKPiArCWlmICghY3J0Y19zdGF0ZS0+Ymlnam9pbmVyKQo+ICsJCWludGVsX2RzY19lbmFi
bGUoZW5jb2RlciwgY3J0Y19zdGF0ZSk7Cj4gIH0KPiAgCj4gIHN0YXRpYyB2b2lkIGludGVsX2Rk
aV9wcmVfZW5hYmxlX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+IEBAIC0zOTcy
LDE5ICszOTc0LDE4IEBAIHZvaWQgaW50ZWxfZGRpX2NvbXB1dGVfbWluX3ZvbHRhZ2VfbGV2ZWwo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAJCWNydGNfc3RhdGUtPm1pbl92
b2x0YWdlX2xldmVsID0gMjsKPiAgfQo+ICAKPiAtdm9pZCBpbnRlbF9kZGlfZ2V0X2NvbmZpZyhz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAtCQkJICBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqcGlwZV9jb25maWcpCj4gK3N0YXRpYyB2b2lkIGludGVsX2RkaV9yZWFkX2Z1bmNfY3Rs
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ICsJCQkJICAgIHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiAgewo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gIAlzdHJ1Y3QgaW50ZWxf
Y3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPnVhcGkuY3J0Yyk7
Cj4gIAllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBwaXBlX2NvbmZpZy0+Y3B1X3Ry
YW5zY29kZXI7Cj4gIAl1MzIgdGVtcCwgZmxhZ3MgPSAwOwo+ICAKPiAtCS8qIFhYWDogRFNJIHRy
YW5zY29kZXIgcGFyYW5vaWEgKi8KPiAtCWlmIChXQVJOX09OKHRyYW5zY29kZXJfaXNfZHNpKGNw
dV90cmFuc2NvZGVyKSkpCj4gKwl0ZW1wID0gSTkxNV9SRUFEKFRSQU5TX0RESV9GVU5DX0NUTChj
cHVfdHJhbnNjb2RlcikpOwo+ICsJaWYgKCEodGVtcCAmIFRSQU5TX0RESV9GVU5DX0VOQUJMRSkp
Cj4gIAkJcmV0dXJuOwo+ICAKPiAtCXRlbXAgPSBJOTE1X1JFQUQoVFJBTlNfRERJX0ZVTkNfQ1RM
KGNwdV90cmFuc2NvZGVyKSk7Cj4gIAlpZiAodGVtcCAmIFRSQU5TX0RESV9QSFNZTkMpCj4gIAkJ
ZmxhZ3MgfD0gRFJNX01PREVfRkxBR19QSFNZTkM7Cj4gIAllbHNlCj4gQEAgLTQwNjYsNiArNDA2
NywyOSBAQCB2b2lkIGludGVsX2RkaV9nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAo+ICAJZGVmYXVsdDoKPiAgCQlicmVhazsKPiAgCX0KPiArfQo+ICsKPiArdm9pZCBp
bnRlbF9kZGlfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiArCQkJ
ICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gK3sKPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+
ICsJZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0gcGlwZV9jb25maWctPmNwdV90cmFu
c2NvZGVyOwo+ICsKPiArCS8qIFhYWDogRFNJIHRyYW5zY29kZXIgcGFyYW5vaWEgKi8KPiArCWlm
IChXQVJOX09OKHRyYW5zY29kZXJfaXNfZHNpKGNwdV90cmFuc2NvZGVyKSkpCj4gKwkJcmV0dXJu
Owo+ICsKPiArCWludGVsX2RkaV9yZWFkX2Z1bmNfY3RsKGVuY29kZXIsIHBpcGVfY29uZmlnKTsK
PiArCWlmIChwaXBlX2NvbmZpZy0+Ymlnam9pbmVyX3NsYXZlKSB7Cj4gKwkJLyogcmVhZCBvdXQg
cGlwZSBzZXR0aW5ncyBmcm9tIG1hc3RlciAqLwo+ICsJCWVudW0gdHJhbnNjb2RlciBzYXZlID0g
cGlwZV9jb25maWctPmNwdV90cmFuc2NvZGVyOwo+ICsKPiArCQkgLyogT3VyIG93biB0cmFuc2Nv
ZGVyIG5lZWRzIHRvIGJlIGRpc2FibGVkIHdoZW4gcmVhZGluZyBpdCBpbiBpbnRlbF9kZGlfcmVh
ZF9mdW5jX2N0bCgpICovCj4gKwkJV0FSTl9PTihwaXBlX2NvbmZpZy0+b3V0cHV0X3R5cGVzKTsK
PiArCQlwaXBlX2NvbmZpZy0+Y3B1X3RyYW5zY29kZXIgPSAoZW51bSB0cmFuc2NvZGVyKXBpcGVf
Y29uZmlnLT5iaWdqb2luZXJfbGlua2VkX2NydGMtPnBpcGU7Cj4gKwkJaW50ZWxfZGRpX3JlYWRf
ZnVuY19jdGwoZW5jb2RlciwgcGlwZV9jb25maWcpOwo+ICsJCXBpcGVfY29uZmlnLT5jcHVfdHJh
bnNjb2RlciA9IHNhdmU7Cj4gKwl9Cj4gIAo+ICAJcGlwZV9jb25maWctPmhhc19hdWRpbyA9Cj4g
IAkJaW50ZWxfZGRpX2lzX2F1ZGlvX2VuYWJsZWQoZGV2X3ByaXYsIGNwdV90cmFuc2NvZGVyKTsK
PiBAQCAtNDA5MCw3ICs0MTE0LDggQEAgdm9pZCBpbnRlbF9kZGlfZ2V0X2NvbmZpZyhzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiAgCQlkZXZfcHJpdi0+dmJ0LmVkcC5icHAgPSBwaXBl
X2NvbmZpZy0+cGlwZV9icHA7Cj4gIAl9Cj4gIAo+IC0JaW50ZWxfZGRpX2Nsb2NrX2dldChlbmNv
ZGVyLCBwaXBlX2NvbmZpZyk7Cj4gKwlpZiAoIXBpcGVfY29uZmlnLT5iaWdqb2luZXJfc2xhdmUp
Cj4gKwkJaW50ZWxfZGRpX2Nsb2NrX2dldChlbmNvZGVyLCBwaXBlX2NvbmZpZyk7Cj4gIAo+ICAJ
aWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKQo+ICAJCXBpcGVfY29uZmlnLT5sYW5lX2xhdF9vcHRp
bV9tYXNrID0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9kaXNwbGF5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXku
Ywo+IGluZGV4IDE0M2Q1MzFjNGM4MS4uOGMwOGM0OTE0YzliIDEwMDY0NAo+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCj4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKPiBAQCAtNjQ0OSw2ICs2NDQ5LDQ1
IEBAIHN0YXRpYyB2b2lkIGljbF9waXBlX21idXNfZW5hYmxlKHN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjKQo+ICAJSTkxNV9XUklURShQSVBFX01CVVNfREJPWF9DVEwocGlwZSksIHZhbCk7Cj4gIH0K
PiAgCj4gK3N0YXRpYyB2b2lkIGljbF9kZGlfYmlnam9pbmVyX3ByZV9lbmFibGUoc3RydWN0IGlu
dGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4gKwkJCQkJIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlKQo+ICt7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqbWFzdGVyID0gdG9faW50
ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICsJc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKm1hc3Rlcl9jcnRjX3N0YXRlOwo+ICsJc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNv
bm5fc3RhdGU7Cj4gKwlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubjsKPiArCXN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyID0gTlVMTDsKPiArCWludCBpOwo+ICsKPiArCWlmIChjcnRjX3N0
YXRlLT5iaWdqb2luZXJfc2xhdmUpCj4gKwkJbWFzdGVyID0gY3J0Y19zdGF0ZS0+Ymlnam9pbmVy
X2xpbmtlZF9jcnRjOwo+ICsKPiArCW1hc3Rlcl9jcnRjX3N0YXRlID0gaW50ZWxfYXRvbWljX2dl
dF9uZXdfY3J0Y19zdGF0ZShzdGF0ZSwgbWFzdGVyKTsKPiArCj4gKwlmb3JfZWFjaF9uZXdfY29u
bmVjdG9yX2luX3N0YXRlKCZzdGF0ZS0+YmFzZSwgY29ubiwgY29ubl9zdGF0ZSwgaSkgewo+ICsJ
CWlmIChjb25uX3N0YXRlLT5jcnRjICE9ICZtYXN0ZXItPmJhc2UpCj4gKwkJCWNvbnRpbnVlOwo+
ICsKPiArCQllbmNvZGVyID0gdG9faW50ZWxfZW5jb2Rlcihjb25uX3N0YXRlLT5iZXN0X2VuY29k
ZXIpOwo+ICsJCWJyZWFrOwo+ICsJfQo+ICsKPiArCWlmICghY3J0Y19zdGF0ZS0+Ymlnam9pbmVy
X3NsYXZlKSB7Cj4gKwkJLyogbmVlZCB0byBlbmFibGUgVkRTQywgd2hpY2ggd2Ugc2tpcHBlZCBp
biBwcmUtZW5hYmxlICovCj4gKwkJaW50ZWxfZHNjX2VuYWJsZShlbmNvZGVyLCBjcnRjX3N0YXRl
KTsKPiArCX0gZWxzZSB7Cj4gKwkJLyoKPiArCQkgKiBFbmFibGUgc2VxdWVuY2Ugc3RlcHMgMS03
IG9uIGJpZ2pvaW5lciBtYXN0ZXIKPiArCQkgKi8KCkknZCBleHRlbmQgdGhpcyBjb21tZW50IHRv
IGluZGljYXRlIHRoYXQgd2UgZG8gdGhpcyBvbiB0aGUgc2xhdmUgKHVzaW5nCnRoZSBtYXN0ZXIn
cyBzdGF0ZSwgdHJhbnNjb2RlciwgYW5kIERESSkgYmVjYXVzZSB0aGUgW3dpbGxdIHByb2dyYW0g
dGhlCnNsYXZlIENSVEMgYmVmb3JlIHRoZSBtYXN0ZXIuCgo+ICsJCWludGVsX2VuY29kZXJzX3By
ZV9wbGxfZW5hYmxlKG1hc3RlciwgbWFzdGVyX2NydGNfc3RhdGUsIHN0YXRlKTsKPiArCQlpbnRl
bF9lbmFibGVfc2hhcmVkX2RwbGwobWFzdGVyX2NydGNfc3RhdGUpOwo+ICsJCWludGVsX2VuY29k
ZXJzX3ByZV9lbmFibGUobWFzdGVyLCBtYXN0ZXJfY3J0Y19zdGF0ZSwgc3RhdGUpOwo+ICsKPiAr
CQkvKiBhbmQgRFNDIG9uIHNsYXZlICovCj4gKwkJaW50ZWxfZHNjX2VuYWJsZShOVUxMLCBjcnRj
X3N0YXRlKTsKPiArCX0KPiArfQo+ICsKPiAgc3RhdGljIHZvaWQgaGFzd2VsbF9jcnRjX2VuYWJs
ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4gIAkJCQlzdHJ1Y3QgaW50
ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgewo+IEBAIC02NDYyLDM3ICs2NTAxLDM4IEBAIHN0
YXRpYyB2b2lkIGhhc3dlbGxfY3J0Y19lbmFibGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBp
cGVfY29uZmlnLAo+ICAJaWYgKFdBUk5fT04oaW50ZWxfY3J0Yy0+YWN0aXZlKSkKPiAgCQlyZXR1
cm47Cj4gIAo+IC0JaW50ZWxfZW5jb2RlcnNfcHJlX3BsbF9lbmFibGUoaW50ZWxfY3J0YywgcGlw
ZV9jb25maWcsIHN0YXRlKTsKPiArCWlmICghcGlwZV9jb25maWctPmJpZ2pvaW5lcikgewo+ICsJ
CWludGVsX2VuY29kZXJzX3ByZV9wbGxfZW5hYmxlKGludGVsX2NydGMsIHBpcGVfY29uZmlnLCBz
dGF0ZSk7Cj4gIAo+IC0JaWYgKHBpcGVfY29uZmlnLT5zaGFyZWRfZHBsbCkKPiAtCQlpbnRlbF9l
bmFibGVfc2hhcmVkX2RwbGwocGlwZV9jb25maWcpOwo+ICsJCWlmIChwaXBlX2NvbmZpZy0+c2hh
cmVkX2RwbGwpCj4gKwkJCWludGVsX2VuYWJsZV9zaGFyZWRfZHBsbChwaXBlX2NvbmZpZyk7Cj4g
IAo+IC0JaW50ZWxfZW5jb2RlcnNfcHJlX2VuYWJsZShpbnRlbF9jcnRjLCBwaXBlX2NvbmZpZywg
c3RhdGUpOwo+ICsJCWludGVsX2VuY29kZXJzX3ByZV9lbmFibGUoaW50ZWxfY3J0YywgcGlwZV9j
b25maWcsIHN0YXRlKTsKPiArCX0gZWxzZSB7Cj4gKwkJaWNsX2RkaV9iaWdqb2luZXJfcHJlX2Vu
YWJsZShzdGF0ZSwgcGlwZV9jb25maWcpOwo+ICsJfQo+ICAKPiAtCWlmIChpbnRlbF9jcnRjX2hh
c19kcF9lbmNvZGVyKHBpcGVfY29uZmlnKSkKPiAtCQlpbnRlbF9kcF9zZXRfbV9uKHBpcGVfY29u
ZmlnLCBNMV9OMSk7Cj4gKwlpbnRlbF9zZXRfcGlwZV9zcmNfc2l6ZShwaXBlX2NvbmZpZyk7Cj4g
KwlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5IHx8IElTX0JST0FEV0VMTChkZXZfcHJpdikp
Cj4gKwkJYmR3X3NldF9waXBlbWlzYyhwaXBlX2NvbmZpZyk7Cj4gIAo+IC0JaWYgKCF0cmFuc2Nv
ZGVyX2lzX2RzaShjcHVfdHJhbnNjb2RlcikpCj4gLQkJaW50ZWxfc2V0X3BpcGVfdGltaW5ncyhw
aXBlX2NvbmZpZyk7Cj4gKwlpZiAoIXBpcGVfY29uZmlnLT5iaWdqb2luZXJfc2xhdmUgJiYgIXRy
YW5zY29kZXJfaXNfZHNpKGNwdV90cmFuc2NvZGVyKSkgewo+ICsJCWlmIChpbnRlbF9jcnRjX2hh
c19kcF9lbmNvZGVyKHBpcGVfY29uZmlnKSkKPiArCQkJaW50ZWxfZHBfc2V0X21fbihwaXBlX2Nv
bmZpZywgTTFfTjEpOwo+ICAKPiAtCWludGVsX3NldF9waXBlX3NyY19zaXplKHBpcGVfY29uZmln
KTsKPiArCQlpbnRlbF9zZXRfcGlwZV90aW1pbmdzKHBpcGVfY29uZmlnKTsKPiAgCj4gLQlpZiAo
Y3B1X3RyYW5zY29kZXIgIT0gVFJBTlNDT0RFUl9FRFAgJiYKPiAtCSAgICAhdHJhbnNjb2Rlcl9p
c19kc2koY3B1X3RyYW5zY29kZXIpKSB7Cj4gLQkJSTkxNV9XUklURShQSVBFX01VTFQoY3B1X3Ry
YW5zY29kZXIpLAo+IC0JCQkgICBwaXBlX2NvbmZpZy0+cGl4ZWxfbXVsdGlwbGllciAtIDEpOwo+
IC0JfQo+ICsJCWlmIChjcHVfdHJhbnNjb2RlciAhPSBUUkFOU0NPREVSX0VEUCkKPiArCQkJSTkx
NV9XUklURShQSVBFX01VTFQoY3B1X3RyYW5zY29kZXIpLAo+ICsJCQkJICBwaXBlX2NvbmZpZy0+
cGl4ZWxfbXVsdGlwbGllciAtIDEpOwo+ICAKPiAtCWlmIChwaXBlX2NvbmZpZy0+aGFzX3BjaF9l
bmNvZGVyKSB7Cj4gLQkJaW50ZWxfY3B1X3RyYW5zY29kZXJfc2V0X21fbihwaXBlX2NvbmZpZywK
PiAtCQkJCQkgICAgICZwaXBlX2NvbmZpZy0+ZmRpX21fbiwgTlVMTCk7Cj4gLQl9Cj4gKwkJaWYg
KHBpcGVfY29uZmlnLT5oYXNfcGNoX2VuY29kZXIpIHsKPiArCQkJaW50ZWxfY3B1X3RyYW5zY29k
ZXJfc2V0X21fbihwaXBlX2NvbmZpZywKPiArCQkJCQkJICAgICZwaXBlX2NvbmZpZy0+ZmRpX21f
biwgTlVMTCk7Cj4gKwkJfQo+ICAKPiAtCWlmICghdHJhbnNjb2Rlcl9pc19kc2koY3B1X3RyYW5z
Y29kZXIpKQo+ICAJCWhhc3dlbGxfc2V0X3BpcGVjb25mKHBpcGVfY29uZmlnKTsKPiAtCj4gLQlp
ZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5IHx8IElTX0JST0FEV0VMTChkZXZfcHJpdikpCj4g
LQkJYmR3X3NldF9waXBlbWlzYyhwaXBlX2NvbmZpZyk7Cj4gKwl9Cj4gIAo+ICAJaW50ZWxfY3J0
Yy0+YWN0aXZlID0gdHJ1ZTsKPiAgCj4gQEAgLTY1MjAsOSArNjU2MCwxMSBAQCBzdGF0aWMgdm9p
ZCBoYXN3ZWxsX2NydGNfZW5hYmxlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZp
ZywKPiAgCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQo+ICAJCWljbF9zZXRfcGlwZV9j
aGlja2VuKGludGVsX2NydGMpOwo+ICAKPiAtCWludGVsX2RkaV9zZXRfcGlwZV9zZXR0aW5ncyhw
aXBlX2NvbmZpZyk7Cj4gLQlpZiAoIXRyYW5zY29kZXJfaXNfZHNpKGNwdV90cmFuc2NvZGVyKSkK
PiArCWlmICghcGlwZV9jb25maWctPmJpZ2pvaW5lcl9zbGF2ZSAmJiAhdHJhbnNjb2Rlcl9pc19k
c2koY3B1X3RyYW5zY29kZXIpKSB7Cj4gKwkJaW50ZWxfZGRpX3NldF9waXBlX3NldHRpbmdzKHBp
cGVfY29uZmlnKTsKPiArCj4gIAkJaW50ZWxfZGRpX2VuYWJsZV90cmFuc2NvZGVyX2Z1bmMocGlw
ZV9jb25maWcpOwo+ICsJfQo+ICAKPiAgCWlmIChkZXZfcHJpdi0+ZGlzcGxheS5pbml0aWFsX3dh
dGVybWFya3MgIT0gTlVMTCkKPiAgCQlkZXZfcHJpdi0+ZGlzcGxheS5pbml0aWFsX3dhdGVybWFy
a3Moc3RhdGUsIHBpcGVfY29uZmlnKTsKPiBAQCAtNjUzMSw4ICs2NTczLDEwIEBAIHN0YXRpYyB2
b2lkIGhhc3dlbGxfY3J0Y19lbmFibGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29u
ZmlnLAo+ICAJCWljbF9waXBlX21idXNfZW5hYmxlKGludGVsX2NydGMpOwo+ICAKPiAgCS8qIFhY
WDogRG8gdGhlIHBpcGUgYXNzZXJ0aW9ucyBhdCB0aGUgcmlnaHQgcGxhY2UgZm9yIEJYVCBEU0ku
ICovCj4gLQlpZiAoIXRyYW5zY29kZXJfaXNfZHNpKGNwdV90cmFuc2NvZGVyKSkKPiArCWlmICgh
cGlwZV9jb25maWctPmJpZ2pvaW5lcl9zbGF2ZSAmJiAhdHJhbnNjb2Rlcl9pc19kc2koY3B1X3Ry
YW5zY29kZXIpKQo+ICAJCWludGVsX2VuYWJsZV9waXBlKHBpcGVfY29uZmlnKTsKPiArCWVsc2UK
PiArCQl0cmFjZV9pbnRlbF9waXBlX2VuYWJsZShpbnRlbF9jcnRjKTsKPiAgCj4gIAlpZiAocGlw
ZV9jb25maWctPmhhc19wY2hfZW5jb2RlcikKPiAgCQlscHRfcGNoX2VuYWJsZShzdGF0ZSwgcGlw
ZV9jb25maWcpOwo+IEBAIC02NjYzLDkgKzY3MDcsMjcgQEAgc3RhdGljIHZvaWQgaGFzd2VsbF9j
cnRjX2Rpc2FibGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+ICAJ
ZWxzZQo+ICAJCWlyb25sYWtlX3BmaXRfZGlzYWJsZShvbGRfY3J0Y19zdGF0ZSk7Cj4gIAo+IC0J
aW50ZWxfZW5jb2RlcnNfcG9zdF9kaXNhYmxlKGludGVsX2NydGMsIG9sZF9jcnRjX3N0YXRlLCBz
dGF0ZSk7Cj4gKwlpZiAob2xkX2NydGNfc3RhdGUtPmJpZ2pvaW5lcikgewo+ICsJCXN0cnVjdCBp
bnRlbF9jcnRjICptYXN0ZXI7Cj4gKwkJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm1hc3Rlcl9j
cnRjX3N0YXRlOwo+ICAKPiAtCWludGVsX2VuY29kZXJzX3Bvc3RfcGxsX2Rpc2FibGUoaW50ZWxf
Y3J0Yywgb2xkX2NydGNfc3RhdGUsIHN0YXRlKTsKPiArCQkvKiBwb3J0cyBhcmUgZGlzYWJsZWQg
ZnJvbSB0aGUgc2xhdmUsIGFmdGVyIGl0IGRlY29uZmlndXJlcyAqLwo+ICsJCWlmICghb2xkX2Ny
dGNfc3RhdGUtPmJpZ2pvaW5lcl9zbGF2ZSkKPiArCQkJcmV0dXJuOwo+ICsKPiArCQltYXN0ZXIg
PSBvbGRfY3J0Y19zdGF0ZS0+Ymlnam9pbmVyX2xpbmtlZF9jcnRjOwo+ICsJCW1hc3Rlcl9jcnRj
X3N0YXRlID0gaW50ZWxfYXRvbWljX2dldF9vbGRfY3J0Y19zdGF0ZShzdGF0ZSwgbWFzdGVyKTsK
PiArCj4gKwkJaW50ZWxfZGRpX2Rpc2FibGVfcGlwZV9jbG9jayhvbGRfY3J0Y19zdGF0ZSk7Cj4g
Kwo+ICsJCS8qIGRpc2FibGUgcG9ydHMgb24gdGhlIG1hc3RlciBjcnRjICovCj4gKwkJaW50ZWxf
ZW5jb2RlcnNfcG9zdF9kaXNhYmxlKG1hc3RlciwgbWFzdGVyX2NydGNfc3RhdGUsIHN0YXRlKTsK
PiArCQlpbnRlbF9lbmNvZGVyc19wb3N0X3BsbF9kaXNhYmxlKG1hc3RlciwgbWFzdGVyX2NydGNf
c3RhdGUsIHN0YXRlKTsKPiArCX0gZWxzZSB7Cj4gKwkJaW50ZWxfZW5jb2RlcnNfcG9zdF9kaXNh
YmxlKGludGVsX2NydGMsIG9sZF9jcnRjX3N0YXRlLCBzdGF0ZSk7Cj4gKwo+ICsJCWludGVsX2Vu
Y29kZXJzX3Bvc3RfcGxsX2Rpc2FibGUoaW50ZWxfY3J0Yywgb2xkX2NydGNfc3RhdGUsIHN0YXRl
KTsKPiArCX0KPiAgfQo+ICAKPiAgc3RhdGljIHZvaWQgaTl4eF9wZml0X2VuYWJsZShjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiBAQCAtNjgyOSw2ICs2ODkxLDkg
QEAgc3RhdGljIHU2NCBnZXRfY3J0Y19wb3dlcl9kb21haW5zKHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlKQo+ICAJaWYgKGNydGNfc3RhdGUtPnNoYXJlZF9kcGxsKQo+ICAJCW1h
c2sgfD0gQklUX1VMTChQT1dFUl9ET01BSU5fRElTUExBWV9DT1JFKTsKPiAgCj4gKwlpZiAoY3J0
Y19zdGF0ZS0+ZHNjX3BhcmFtcy5jb21wcmVzc2lvbl9lbmFibGUpCj4gKwkJbWFzayB8PSBCSVRf
VUxMKGludGVsX2RzY19wb3dlcl9kb21haW4oY3J0Y19zdGF0ZSkpOwo+ICsKPiAgCXJldHVybiBt
YXNrOwo+ICB9Cj4gIAo+IEBAIC03NDE3LDYgKzc0ODIsMTkgQEAgc3RhdGljIHUzMiBpbGtfcGlw
ZV9waXhlbF9yYXRlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykK
PiAgCXJldHVybiBwaXhlbF9yYXRlOwo+ICB9Cj4gIAo+ICtzdGF0aWMgdm9pZCBpbnRlbF9lbmNv
ZGVyX2dldF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gKwkJCQkgICAg
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICt7Cj4gKwllbmNvZGVyLT5n
ZXRfY29uZmlnKGVuY29kZXIsIGNydGNfc3RhdGUpOwo+ICsKPiArCWNydGNfc3RhdGUtPmh3LnRy
YW5zY29kZXJfbW9kZS5mbGFncyA9IGNydGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGUuZmxhZ3M7
Cj4gKwo+ICsJLyogaWYgdHJhbnNjb2RlciBjbG9jayBpcyBub3Qgc2V0LCBhc3N1bWUgc2FtZSBh
cyBhZGp1c3RlZF9tb2RlIGNsb2NrICovCj4gKwlpZiAoIWNydGNfc3RhdGUtPmh3LnRyYW5zY29k
ZXJfbW9kZS5jcnRjX2Nsb2NrKQo+ICsJCWNydGNfc3RhdGUtPmh3LnRyYW5zY29kZXJfbW9kZS5j
cnRjX2Nsb2NrID0KPiArCQkJY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2Nr
Owo+ICt9Cj4gKwo+ICBzdGF0aWMgdm9pZCBpbnRlbF9jcnRjX2NvbXB1dGVfcGl4ZWxfcmF0ZShz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+ICAJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT51YXBpLmNydGMtPmRl
dik7Cj4gQEAgLTgyNjUsNiArODM0MywyNCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9nZXRfcGlwZV90
aW1pbmdzKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAJCXBpcGVfY29uZmlnLT5ody5hZGp1
c3RlZF9tb2RlLmNydGNfdnRvdGFsICs9IDE7Cj4gIAkJcGlwZV9jb25maWctPmh3LmFkanVzdGVk
X21vZGUuY3J0Y192YmxhbmtfZW5kICs9IDE7Cj4gIAl9Cj4gKwo+ICsJcGlwZV9jb25maWctPmh3
LnRyYW5zY29kZXJfbW9kZSA9IHBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlOwo+ICsJaWYg
KHBpcGVfY29uZmlnLT5iaWdqb2luZXIpIHsKPiArCQlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAq
YWRqdXN0ZWRfbW9kZSA9Cj4gKwkJCSZwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZTsKPiAr
Cj4gKwkJLyoKPiArCQkgICogdHJhbnNjb2RlciBpcyBwcm9ncmFtbWVkIHRvIHRoZSBmdWxsIG1v
ZGUsCj4gKwkJICAqIGJ1dCBwaXBqZSB0aW1pbmdzIGFyZSBoYWxmIG9mIHRoZSB0cmFuc2NvZGVy
IG1vZGUKPiArCQkgICovCj4gKwkJYWRqdXN0ZWRfbW9kZS0+Y3J0Y19oZGlzcGxheSAvPSAyOwo+
ICsJCWFkanVzdGVkX21vZGUtPmNydGNfaGJsYW5rX3N0YXJ0IC89IDI7Cj4gKwkJYWRqdXN0ZWRf
bW9kZS0+Y3J0Y19oYmxhbmtfZW5kIC89IDI7Cj4gKwkJYWRqdXN0ZWRfbW9kZS0+Y3J0Y19oc3lu
Y19zdGFydCAvPSAyOwo+ICsJCWFkanVzdGVkX21vZGUtPmNydGNfaHN5bmNfZW5kIC89IDI7Cj4g
KwkJYWRqdXN0ZWRfbW9kZS0+Y3J0Y19odG90YWwgLz0gMjsKPiArCQlhZGp1c3RlZF9tb2RlLT5j
cnRjX2hza2V3IC89IDI7Cj4gKwl9Cj4gIH0KPiAgCj4gIHN0YXRpYyB2b2lkIGludGVsX2dldF9w
aXBlX3NyY19zaXplKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+IEBAIC04Mjg1LDIwICs4Mzgx
LDIyIEBAIHN0YXRpYyB2b2lkIGludGVsX2dldF9waXBlX3NyY19zaXplKHN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjLAo+ICB2b2lkIGludGVsX21vZGVfZnJvbV9waXBlX2NvbmZpZyhzdHJ1Y3QgZHJt
X2Rpc3BsYXlfbW9kZSAqbW9kZSwKPiAgCQkJCSBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlw
ZV9jb25maWcpCj4gIHsKPiAtCW1vZGUtPmhkaXNwbGF5ID0gcGlwZV9jb25maWctPmh3LmFkanVz
dGVkX21vZGUuY3J0Y19oZGlzcGxheTsKPiAtCW1vZGUtPmh0b3RhbCA9IHBpcGVfY29uZmlnLT5o
dy5hZGp1c3RlZF9tb2RlLmNydGNfaHRvdGFsOwo+IC0JbW9kZS0+aHN5bmNfc3RhcnQgPSBwaXBl
X2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2hzeW5jX3N0YXJ0Owo+IC0JbW9kZS0+aHN5
bmNfZW5kID0gcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUuY3J0Y19oc3luY19lbmQ7Cj4g
KwlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqaHdfbW9kZSA9ICZwaXBlX2NvbmZpZy0+aHcudHJh
bnNjb2Rlcl9tb2RlOwo+ICAKPiAtCW1vZGUtPnZkaXNwbGF5ID0gcGlwZV9jb25maWctPmh3LmFk
anVzdGVkX21vZGUuY3J0Y192ZGlzcGxheTsKPiAtCW1vZGUtPnZ0b3RhbCA9IHBpcGVfY29uZmln
LT5ody5hZGp1c3RlZF9tb2RlLmNydGNfdnRvdGFsOwo+IC0JbW9kZS0+dnN5bmNfc3RhcnQgPSBw
aXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX3ZzeW5jX3N0YXJ0Owo+IC0JbW9kZS0+
dnN5bmNfZW5kID0gcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUuY3J0Y192c3luY19lbmQ7
Cj4gKwltb2RlLT5oZGlzcGxheSA9IGh3X21vZGUtPmNydGNfaGRpc3BsYXk7Cj4gKwltb2RlLT5o
dG90YWwgPSBod19tb2RlLT5jcnRjX2h0b3RhbDsKPiArCW1vZGUtPmhzeW5jX3N0YXJ0ID0gaHdf
bW9kZS0+Y3J0Y19oc3luY19zdGFydDsKPiArCW1vZGUtPmhzeW5jX2VuZCA9IGh3X21vZGUtPmNy
dGNfaHN5bmNfZW5kOwo+ICAKPiAtCW1vZGUtPmZsYWdzID0gcGlwZV9jb25maWctPmh3LmFkanVz
dGVkX21vZGUuZmxhZ3M7Cj4gKwltb2RlLT52ZGlzcGxheSA9IGh3X21vZGUtPmNydGNfdmRpc3Bs
YXk7Cj4gKwltb2RlLT52dG90YWwgPSBod19tb2RlLT5jcnRjX3Z0b3RhbDsKPiArCW1vZGUtPnZz
eW5jX3N0YXJ0ID0gaHdfbW9kZS0+Y3J0Y192c3luY19zdGFydDsKPiArCW1vZGUtPnZzeW5jX2Vu
ZCA9IGh3X21vZGUtPmNydGNfdnN5bmNfZW5kOwo+ICsKPiArCW1vZGUtPmZsYWdzID0gaHdfbW9k
ZS0+ZmxhZ3M7Cj4gIAltb2RlLT50eXBlID0gRFJNX01PREVfVFlQRV9EUklWRVI7Cj4gIAo+IC0J
bW9kZS0+Y2xvY2sgPSBwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrOwo+
ICsJbW9kZS0+Y2xvY2sgPSBod19tb2RlLT5jcnRjX2Nsb2NrOwo+ICAKPiAgCW1vZGUtPmhzeW5j
ID0gZHJtX21vZGVfaHN5bmMobW9kZSk7Cj4gIAltb2RlLT52cmVmcmVzaCA9IGRybV9tb2RlX3Zy
ZWZyZXNoKG1vZGUpOwo+IEBAIC0xMDM4NSw2ICsxMDQ4Myw4IEBAIHN0YXRpYyB2b2lkIGhhc3dl
bGxfZ2V0X2RkaV9wb3J0X3N0YXRlKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAJdTMyIHRt
cDsKPiAgCj4gIAl0bXAgPSBJOTE1X1JFQUQoVFJBTlNfRERJX0ZVTkNfQ1RMKHBpcGVfY29uZmln
LT5jcHVfdHJhbnNjb2RlcikpOwo+ICsJaWYgKCEodG1wICYgVFJBTlNfRERJX0ZVTkNfRU5BQkxF
KSkKPiArCQlyZXR1cm47Cj4gIAo+ICAJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTIpCj4g
IAkJcG9ydCA9IFRHTF9UUkFOU19ERElfRlVOQ19DVExfVkFMX1RPX1BPUlQodG1wKTsKPiBAQCAt
MTA0NTUsMTEgKzEwNTU1LDE5IEBAIHN0YXRpYyBib29sIGhhc3dlbGxfZ2V0X3BpcGVfY29uZmln
KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ICAJCVdBUk5fT04oYWN0aXZlKTsKPiAgCQlhY3Rp
dmUgPSB0cnVlOwo+ICAJfQo+ICsJaW50ZWxfZHNjX2dldF9jb25maWcocGlwZV9jb25maWcpOwo+
ICAKPiAtCWlmICghYWN0aXZlKQo+IC0JCWdvdG8gb3V0Owo+ICsJaWYgKCFhY3RpdmUpIHsKPiAr
CQkvKiBiaWdqb2luZXIgc2xhdmUgZG9lc24ndCBlbmFibGUgdHJhbnNjb2RlciAqLwo+ICsJCWlm
ICghcGlwZV9jb25maWctPmJpZ2pvaW5lcl9zbGF2ZSkKPiArCQkJZ290byBvdXQ7Cj4gKwo+ICsJ
CWFjdGl2ZSA9IHRydWU7Cj4gKwkJcGlwZV9jb25maWctPnBpeGVsX211bHRpcGxpZXIgPSAxOwo+
ICAKPiAtCWlmICghdHJhbnNjb2Rlcl9pc19kc2kocGlwZV9jb25maWctPmNwdV90cmFuc2NvZGVy
KSB8fAo+ICsJCS8qIHdlIGNhbm5vdCByZWFkIG91dCBtb3N0IHN0YXRlLCBzbyBkb24ndCBib3Ro
ZXIuLiAqLwo+ICsJCXBpcGVfY29uZmlnLT5xdWlya3MgfD0gUElQRV9DT05GSUdfUVVJUktfQklH
Sk9JTkVSX1NMQVZFOwo+ICsJfSBlbHNlIGlmICghdHJhbnNjb2Rlcl9pc19kc2kocGlwZV9jb25m
aWctPmNwdV90cmFuc2NvZGVyKSB8fAo+ICAJICAgIElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEp
IHsKPiAgCQloYXN3ZWxsX2dldF9kZGlfcG9ydF9zdGF0ZShjcnRjLCBwaXBlX2NvbmZpZyk7Cj4g
IAkJaW50ZWxfZ2V0X3BpcGVfdGltaW5ncyhjcnRjLCBwaXBlX2NvbmZpZyk7Cj4gQEAgLTEwNTEz
LDcgKzEwNjIxLDEwIEBAIHN0YXRpYyBib29sIGhhc3dlbGxfZ2V0X3BpcGVfY29uZmlnKHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjLAo+ICAJCX0KPiAgCX0KPiAgCj4gLQlpZiAocGlwZV9jb25maWct
PmNwdV90cmFuc2NvZGVyICE9IFRSQU5TQ09ERVJfRURQICYmCj4gKwlpZiAocGlwZV9jb25maWct
PmJpZ2pvaW5lcl9zbGF2ZSkgewo+ICsJCS8qIENhbm5vdCBiZSByZWFkIG91dCBhcyBhIHNsYXZl
LCBzZXQgdG8gMC4gKi8KPiArCQlwaXBlX2NvbmZpZy0+cGl4ZWxfbXVsdGlwbGllciA9IDA7Cj4g
Kwl9IGVsc2UgaWYgKHBpcGVfY29uZmlnLT5jcHVfdHJhbnNjb2RlciAhPSBUUkFOU0NPREVSX0VE
UCAmJgo+ICAJICAgICF0cmFuc2NvZGVyX2lzX2RzaShwaXBlX2NvbmZpZy0+Y3B1X3RyYW5zY29k
ZXIpKSB7Cj4gIAkJcGlwZV9jb25maWctPnBpeGVsX211bHRpcGxpZXIgPQo+ICAJCQlJOTE1X1JF
QUQoUElQRV9NVUxUKHBpcGVfY29uZmlnLT5jcHVfdHJhbnNjb2RlcikpICsgMTsKPiBAQCAtMTE0
NjgsNyArMTE1NzksNyBAQCBpbnRlbF9lbmNvZGVyX2N1cnJlbnRfbW9kZShzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlcikKPiAgCQlyZXR1cm4gTlVMTDsKPiAgCX0KPiAgCj4gLQllbmNvZGVy
LT5nZXRfY29uZmlnKGVuY29kZXIsIGNydGNfc3RhdGUpOwo+ICsJaW50ZWxfZW5jb2Rlcl9nZXRf
Y29uZmlnKGVuY29kZXIsIGNydGNfc3RhdGUpOwo+ICAKPiAgCWludGVsX21vZGVfZnJvbV9waXBl
X2NvbmZpZyhtb2RlLCBjcnRjX3N0YXRlKTsKPiAgCj4gQEAgLTEyMjg1LDkgKzEyMzk2LDExIEBA
IHN0YXRpYyB2b2lkIGNvcHlfdWFwaV90b19od19zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSkKPiAgCj4gIHN0YXRpYyB2b2lkIGNvcHlfaHdfdG9fdWFwaV9zdGF0ZShz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0JY3J0Y19zdGF0ZS0+
dWFwaS5lbmFibGUgPSBjcnRjX3N0YXRlLT5ody5lbmFibGU7Cj4gLQljcnRjX3N0YXRlLT51YXBp
LmFjdGl2ZSA9IGNydGNfc3RhdGUtPmh3LmFjdGl2ZTsKPiAtCWNydGNfc3RhdGUtPnVhcGkubW9k
ZSA9IGNydGNfc3RhdGUtPmh3Lm1vZGU7Cj4gKwlpZiAoIWNydGNfc3RhdGUtPmJpZ2pvaW5lcl9z
bGF2ZSkgewo+ICsJCWNydGNfc3RhdGUtPnVhcGkuZW5hYmxlID0gY3J0Y19zdGF0ZS0+aHcuZW5h
YmxlOwo+ICsJCWNydGNfc3RhdGUtPnVhcGkuYWN0aXZlID0gY3J0Y19zdGF0ZS0+aHcuYWN0aXZl
Owo+ICsJCWNydGNfc3RhdGUtPnVhcGkubW9kZSA9IGNydGNfc3RhdGUtPmh3Lm1vZGU7Cj4gKwl9
Cj4gIAljcnRjX3N0YXRlLT51YXBpLmFkanVzdGVkX21vZGUgPSBjcnRjX3N0YXRlLT5ody50cmFu
c2NvZGVyX21vZGU7Cj4gIH0KPiAgCj4gQEAgLTEyMzE4LDYgKzEyNDMxLDcgQEAgY29weV9iaWdq
b2luZXJfY3J0Y19zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAg
CWNydGNfc3RhdGUtPmh3LmFjdGl2ZSA9IGZyb21fY3J0Y19zdGF0ZS0+aHcuYWN0aXZlOwo+ICAJ
Y3J0Y19zdGF0ZS0+aHcubW9kZSA9IGZyb21fY3J0Y19zdGF0ZS0+aHcubW9kZTsKPiAgCWNydGNf
c3RhdGUtPmh3LmFkanVzdGVkX21vZGUgPSBmcm9tX2NydGNfc3RhdGUtPmh3LmFkanVzdGVkX21v
ZGU7Cj4gKwljcnRjX3N0YXRlLT5ody50cmFuc2NvZGVyX21vZGUgPSBmcm9tX2NydGNfc3RhdGUt
Pmh3LnRyYW5zY29kZXJfbW9kZTsKPiAgCj4gIAkvKiBTb21lIGZpeHVwcyAqLwo+ICAJY3J0Y19z
dGF0ZS0+dWFwaS5tb2RlX2NoYW5nZWQgPSBmcm9tX2NydGNfc3RhdGUtPnVhcGkubW9kZV9jaGFu
Z2VkOwo+IEBAIC0xMjgzMywxOSArMTI5NDcsNDEgQEAgaW50ZWxfcGlwZV9jb25maWdfY29tcGFy
ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3VycmVudF9jb25maWcsCj4gIAo+ICAJ
UElQRV9DT05GX0NIRUNLX1gob3V0cHV0X3R5cGVzKTsKPiAgCj4gLQlQSVBFX0NPTkZfQ0hFQ0tf
SShody5hZGp1c3RlZF9tb2RlLmNydGNfaGRpc3BsYXkpOwo+IC0JUElQRV9DT05GX0NIRUNLX0ko
aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2h0b3RhbCk7Cj4gLQlQSVBFX0NPTkZfQ0hFQ0tfSShody5h
ZGp1c3RlZF9tb2RlLmNydGNfaGJsYW5rX3N0YXJ0KTsKPiAtCVBJUEVfQ09ORl9DSEVDS19JKGh3
LmFkanVzdGVkX21vZGUuY3J0Y19oYmxhbmtfZW5kKTsKPiAtCVBJUEVfQ09ORl9DSEVDS19JKGh3
LmFkanVzdGVkX21vZGUuY3J0Y19oc3luY19zdGFydCk7Cj4gLQlQSVBFX0NPTkZfQ0hFQ0tfSSho
dy5hZGp1c3RlZF9tb2RlLmNydGNfaHN5bmNfZW5kKTsKPiAtCj4gLQlQSVBFX0NPTkZfQ0hFQ0tf
SShody5hZGp1c3RlZF9tb2RlLmNydGNfdmRpc3BsYXkpOwo+IC0JUElQRV9DT05GX0NIRUNLX0ko
aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX3Z0b3RhbCk7Cj4gLQlQSVBFX0NPTkZfQ0hFQ0tfSShody5h
ZGp1c3RlZF9tb2RlLmNydGNfdmJsYW5rX3N0YXJ0KTsKPiAtCVBJUEVfQ09ORl9DSEVDS19JKGh3
LmFkanVzdGVkX21vZGUuY3J0Y192YmxhbmtfZW5kKTsKPiAtCVBJUEVfQ09ORl9DSEVDS19JKGh3
LmFkanVzdGVkX21vZGUuY3J0Y192c3luY19zdGFydCk7Cj4gLQlQSVBFX0NPTkZfQ0hFQ0tfSSho
dy5hZGp1c3RlZF9tb2RlLmNydGNfdnN5bmNfZW5kKTsKPiArCWlmICghUElQRV9DT05GX1FVSVJL
KFBJUEVfQ09ORklHX1FVSVJLX0JJR0pPSU5FUl9TTEFWRSkpIHsKPiArCQkvKiBiaWdqb2luZXIg
bW9kZSA9IHRyYW5zY29kZXIgbW9kZSAvIDIsIGZvciBjYWxjdWxhdGlvbnMgKi8KPiArCQlQSVBF
X0NPTkZfQ0hFQ0tfSShody5hZGp1c3RlZF9tb2RlLmNydGNfaGRpc3BsYXkpOwo+ICsJCVBJUEVf
Q09ORl9DSEVDS19JKGh3LmFkanVzdGVkX21vZGUuY3J0Y19odG90YWwpOwo+ICsJCVBJUEVfQ09O
Rl9DSEVDS19JKGh3LmFkanVzdGVkX21vZGUuY3J0Y192ZGlzcGxheSk7Cj4gKwkJUElQRV9DT05G
X0NIRUNLX0koaHcuYWRqdXN0ZWRfbW9kZS5jcnRjX3Z0b3RhbCk7Cj4gKwo+ICsJCVBJUEVfQ09O
Rl9DSEVDS19JKGh3LnRyYW5zY29kZXJfbW9kZS5jcnRjX2hkaXNwbGF5KTsKPiArCQlQSVBFX0NP
TkZfQ0hFQ0tfSShody50cmFuc2NvZGVyX21vZGUuY3J0Y19odG90YWwpOwo+ICsJCVBJUEVfQ09O
Rl9DSEVDS19JKGh3LnRyYW5zY29kZXJfbW9kZS5jcnRjX2hibGFua19zdGFydCk7Cj4gKwkJUElQ
RV9DT05GX0NIRUNLX0koaHcudHJhbnNjb2Rlcl9tb2RlLmNydGNfaGJsYW5rX2VuZCk7Cj4gKwkJ
UElQRV9DT05GX0NIRUNLX0koaHcudHJhbnNjb2Rlcl9tb2RlLmNydGNfaHN5bmNfc3RhcnQpOwo+
ICsJCVBJUEVfQ09ORl9DSEVDS19JKGh3LnRyYW5zY29kZXJfbW9kZS5jcnRjX2hzeW5jX2VuZCk7
Cj4gKwo+ICsJCVBJUEVfQ09ORl9DSEVDS19JKGh3LnRyYW5zY29kZXJfbW9kZS5jcnRjX3ZkaXNw
bGF5KTsKPiArCQlQSVBFX0NPTkZfQ0hFQ0tfSShody50cmFuc2NvZGVyX21vZGUuY3J0Y192dG90
YWwpOwo+ICsJCVBJUEVfQ09ORl9DSEVDS19JKGh3LnRyYW5zY29kZXJfbW9kZS5jcnRjX3ZibGFu
a19zdGFydCk7Cj4gKwkJUElQRV9DT05GX0NIRUNLX0koaHcudHJhbnNjb2Rlcl9tb2RlLmNydGNf
dmJsYW5rX2VuZCk7Cj4gKwkJUElQRV9DT05GX0NIRUNLX0koaHcudHJhbnNjb2Rlcl9tb2RlLmNy
dGNfdnN5bmNfc3RhcnQpOwo+ICsJCVBJUEVfQ09ORl9DSEVDS19JKGh3LnRyYW5zY29kZXJfbW9k
ZS5jcnRjX3ZzeW5jX2VuZCk7Cj4gKwo+ICsJCVBJUEVfQ09ORl9DSEVDS19GTEFHUyhody50cmFu
c2NvZGVyX21vZGUuZmxhZ3MsCj4gKwkJCQkgICAgICBEUk1fTU9ERV9GTEFHX0lOVEVSTEFDRSk7
Cj4gKwo+ICsJCWlmICghUElQRV9DT05GX1FVSVJLKFBJUEVfQ09ORklHX1FVSVJLX01PREVfU1lO
Q19GTEFHUykpIHsKPiArCQkJUElQRV9DT05GX0NIRUNLX0ZMQUdTKGh3LnRyYW5zY29kZXJfbW9k
ZS5mbGFncywKPiArCQkJCQkgICAgICBEUk1fTU9ERV9GTEFHX1BIU1lOQyk7Cj4gKwkJCVBJUEVf
Q09ORl9DSEVDS19GTEFHUyhody50cmFuc2NvZGVyX21vZGUuZmxhZ3MsCj4gKwkJCQkJICAgICAg
RFJNX01PREVfRkxBR19OSFNZTkMpOwo+ICsJCQlQSVBFX0NPTkZfQ0hFQ0tfRkxBR1MoaHcudHJh
bnNjb2Rlcl9tb2RlLmZsYWdzLAo+ICsJCQkJCSAgICAgIERSTV9NT0RFX0ZMQUdfUFZTWU5DKTsK
PiArCQkJUElQRV9DT05GX0NIRUNLX0ZMQUdTKGh3LnRyYW5zY29kZXJfbW9kZS5mbGFncywKPiAr
CQkJCQkgICAgICBEUk1fTU9ERV9GTEFHX05WU1lOQyk7Cj4gKwkJfQo+ICsJfQo+ICAKPiAgCVBJ
UEVfQ09ORl9DSEVDS19JKHBpeGVsX211bHRpcGxpZXIpOwo+ICAJUElQRV9DT05GX0NIRUNLX0ko
b3V0cHV0X2Zvcm1hdCk7Cj4gQEAgLTEyODU3LDI0ICsxMjk5MywxMSBAQCBpbnRlbF9waXBlX2Nv
bmZpZ19jb21wYXJlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjdXJyZW50X2NvbmZp
ZywKPiAgCVBJUEVfQ09ORl9DSEVDS19CT09MKGhkbWlfc2NyYW1ibGluZyk7Cj4gIAlQSVBFX0NP
TkZfQ0hFQ0tfQk9PTChoZG1pX2hpZ2hfdG1kc19jbG9ja19yYXRpbyk7Cj4gIAlQSVBFX0NPTkZf
Q0hFQ0tfQk9PTChoYXNfaW5mb2ZyYW1lKTsKPiAtCVBJUEVfQ09ORl9DSEVDS19CT09MKGZlY19l
bmFibGUpOwo+ICsJaWYgKCFQSVBFX0NPTkZfUVVJUksoUElQRV9DT05GSUdfUVVJUktfQklHSk9J
TkVSX1NMQVZFKSkKPiArCQlQSVBFX0NPTkZfQ0hFQ0tfQk9PTChmZWNfZW5hYmxlKTsKPiAgCj4g
IAlQSVBFX0NPTkZfQ0hFQ0tfQk9PTF9JTkNPTVBMRVRFKGhhc19hdWRpbyk7Cj4gIAo+IC0JUElQ
RV9DT05GX0NIRUNLX0ZMQUdTKGh3LmFkanVzdGVkX21vZGUuZmxhZ3MsCj4gLQkJCSAgICAgIERS
TV9NT0RFX0ZMQUdfSU5URVJMQUNFKTsKPiAtCj4gLQlpZiAoIVBJUEVfQ09ORl9RVUlSSyhQSVBF
X0NPTkZJR19RVUlSS19NT0RFX1NZTkNfRkxBR1MpKSB7Cj4gLQkJUElQRV9DT05GX0NIRUNLX0ZM
QUdTKGh3LmFkanVzdGVkX21vZGUuZmxhZ3MsCj4gLQkJCQkgICAgICBEUk1fTU9ERV9GTEFHX1BI
U1lOQyk7Cj4gLQkJUElQRV9DT05GX0NIRUNLX0ZMQUdTKGh3LmFkanVzdGVkX21vZGUuZmxhZ3Ms
Cj4gLQkJCQkgICAgICBEUk1fTU9ERV9GTEFHX05IU1lOQyk7Cj4gLQkJUElQRV9DT05GX0NIRUNL
X0ZMQUdTKGh3LmFkanVzdGVkX21vZGUuZmxhZ3MsCj4gLQkJCQkgICAgICBEUk1fTU9ERV9GTEFH
X1BWU1lOQyk7Cj4gLQkJUElQRV9DT05GX0NIRUNLX0ZMQUdTKGh3LmFkanVzdGVkX21vZGUuZmxh
Z3MsCj4gLQkJCQkgICAgICBEUk1fTU9ERV9GTEFHX05WU1lOQyk7Cj4gLQl9Cj4gLQo+ICAJUElQ
RV9DT05GX0NIRUNLX1goZ21jaF9wZml0LmNvbnRyb2wpOwo+ICAJLyogcGZpdCByYXRpb3MgYXJl
IGF1dG9jb21wdXRlZCBieSB0aGUgaHcgb24gZ2VuNCsgKi8KPiAgCWlmIChJTlRFTF9HRU4oZGV2
X3ByaXYpIDwgNCkKPiBAQCAtMTI4OTgsNyArMTMwMjEsOCBAQCBpbnRlbF9waXBlX2NvbmZpZ19j
b21wYXJlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjdXJyZW50X2NvbmZpZywKPiAg
CQl9Cj4gIAo+ICAJCVBJUEVfQ09ORl9DSEVDS19JKHNjYWxlcl9zdGF0ZS5zY2FsZXJfaWQpOwo+
IC0JCVBJUEVfQ09ORl9DSEVDS19DTE9DS19GVVpaWShwaXhlbF9yYXRlKTsKPiArCQlpZiAoIVBJ
UEVfQ09ORl9RVUlSSyhQSVBFX0NPTkZJR19RVUlSS19CSUdKT0lORVJfU0xBVkUpKQo+ICsJCQlQ
SVBFX0NPTkZfQ0hFQ0tfQ0xPQ0tfRlVaWlkocGl4ZWxfcmF0ZSk7Cj4gIAo+ICAJCVBJUEVfQ09O
Rl9DSEVDS19YKGdhbW1hX21vZGUpOwo+ICAJCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkK
PiBAQCAtMTI5MTcsNDggKzEzMDQxLDUwIEBAIGludGVsX3BpcGVfY29uZmlnX2NvbXBhcmUoY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmN1cnJlbnRfY29uZmlnLAo+ICAJUElQRV9DT05G
X0NIRUNLX0JPT0woZG91YmxlX3dpZGUpOwo+ICAKPiAgCVBJUEVfQ09ORl9DSEVDS19QKHNoYXJl
ZF9kcGxsKTsKPiArCWlmICghUElQRV9DT05GX1FVSVJLKFBJUEVfQ09ORklHX1FVSVJLX0JJR0pP
SU5FUl9TTEFWRSkpIHsKPiAgCVBJUEVfQ09ORl9DSEVDS19YKGRwbGxfaHdfc3RhdGUuZHBsbCk7
CgpNaXNzaW5nIGluZGVudCBvbiB0aGlzIGxpbmU/Cgo+IC0JUElQRV9DT05GX0NIRUNLX1goZHBs
bF9od19zdGF0ZS5kcGxsX21kKTsKPiAtCVBJUEVfQ09ORl9DSEVDS19YKGRwbGxfaHdfc3RhdGUu
ZnAwKTsKPiAtCVBJUEVfQ09ORl9DSEVDS19YKGRwbGxfaHdfc3RhdGUuZnAxKTsKPiAtCVBJUEVf
Q09ORl9DSEVDS19YKGRwbGxfaHdfc3RhdGUud3JwbGwpOwo+IC0JUElQRV9DT05GX0NIRUNLX1go
ZHBsbF9od19zdGF0ZS5zcGxsKTsKPiAtCVBJUEVfQ09ORl9DSEVDS19YKGRwbGxfaHdfc3RhdGUu
Y3RybDEpOwo+IC0JUElQRV9DT05GX0NIRUNLX1goZHBsbF9od19zdGF0ZS5jZmdjcjEpOwo+IC0J
UElQRV9DT05GX0NIRUNLX1goZHBsbF9od19zdGF0ZS5jZmdjcjIpOwo+IC0JUElQRV9DT05GX0NI
RUNLX1goZHBsbF9od19zdGF0ZS5jZmdjcjApOwo+IC0JUElQRV9DT05GX0NIRUNLX1goZHBsbF9o
d19zdGF0ZS5lYmIwKTsKPiAtCVBJUEVfQ09ORl9DSEVDS19YKGRwbGxfaHdfc3RhdGUuZWJiNCk7
Cj4gLQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLnBsbDApOwo+IC0JUElQRV9DT05G
X0NIRUNLX1goZHBsbF9od19zdGF0ZS5wbGwxKTsKPiAtCVBJUEVfQ09ORl9DSEVDS19YKGRwbGxf
aHdfc3RhdGUucGxsMik7Cj4gLQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLnBsbDMp
Owo+IC0JUElQRV9DT05GX0NIRUNLX1goZHBsbF9od19zdGF0ZS5wbGw2KTsKPiAtCVBJUEVfQ09O
Rl9DSEVDS19YKGRwbGxfaHdfc3RhdGUucGxsOCk7Cj4gLQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxs
X2h3X3N0YXRlLnBsbDkpOwo+IC0JUElQRV9DT05GX0NIRUNLX1goZHBsbF9od19zdGF0ZS5wbGwx
MCk7Cj4gLQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLnBjc2R3MTIpOwo+IC0JUElQ
RV9DT05GX0NIRUNLX1goZHBsbF9od19zdGF0ZS5tZ19yZWZjbGtpbl9jdGwpOwo+IC0JUElQRV9D
T05GX0NIRUNLX1goZHBsbF9od19zdGF0ZS5tZ19jbGt0b3AyX2NvcmVjbGtjdGwxKTsKPiAtCVBJ
UEVfQ09ORl9DSEVDS19YKGRwbGxfaHdfc3RhdGUubWdfY2xrdG9wMl9oc2Nsa2N0bCk7Cj4gLQlQ
SVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLm1nX3BsbF9kaXYwKTsKPiAtCVBJUEVfQ09O
Rl9DSEVDS19YKGRwbGxfaHdfc3RhdGUubWdfcGxsX2RpdjEpOwo+IC0JUElQRV9DT05GX0NIRUNL
X1goZHBsbF9od19zdGF0ZS5tZ19wbGxfbGYpOwo+IC0JUElQRV9DT05GX0NIRUNLX1goZHBsbF9o
d19zdGF0ZS5tZ19wbGxfZnJhY19sb2NrKTsKPiAtCVBJUEVfQ09ORl9DSEVDS19YKGRwbGxfaHdf
c3RhdGUubWdfcGxsX3NzYyk7Cj4gLQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLm1n
X3BsbF9iaWFzKTsKPiAtCVBJUEVfQ09ORl9DSEVDS19YKGRwbGxfaHdfc3RhdGUubWdfcGxsX3Rk
Y19jb2xkc3RfYmlhcyk7Cj4gLQo+IC0JUElQRV9DT05GX0NIRUNLX1goZHNpX3BsbC5jdHJsKTsK
PiAtCVBJUEVfQ09ORl9DSEVDS19YKGRzaV9wbGwuZGl2KTsKPiAtCj4gLQlpZiAoSVNfRzRYKGRl
dl9wcml2KSB8fCBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDUpCj4gLQkJUElQRV9DT05GX0NIRUNL
X0kocGlwZV9icHApOwo+IC0KPiAtCVBJUEVfQ09ORl9DSEVDS19DTE9DS19GVVpaWShody5hZGp1
c3RlZF9tb2RlLmNydGNfY2xvY2spOwo+IC0JUElQRV9DT05GX0NIRUNLX0NMT0NLX0ZVWlpZKHBv
cnRfY2xvY2spOwo+IC0KPiAtCVBJUEVfQ09ORl9DSEVDS19JKG1pbl92b2x0YWdlX2xldmVsKTsK
PiArCQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLmRwbGxfbWQpOwo+ICsJCVBJUEVf
Q09ORl9DSEVDS19YKGRwbGxfaHdfc3RhdGUuZnAwKTsKPiArCQlQSVBFX0NPTkZfQ0hFQ0tfWChk
cGxsX2h3X3N0YXRlLmZwMSk7Cj4gKwkJUElQRV9DT05GX0NIRUNLX1goZHBsbF9od19zdGF0ZS53
cnBsbCk7Cj4gKwkJUElQRV9DT05GX0NIRUNLX1goZHBsbF9od19zdGF0ZS5zcGxsKTsKPiArCQlQ
SVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLmN0cmwxKTsKPiArCQlQSVBFX0NPTkZfQ0hF
Q0tfWChkcGxsX2h3X3N0YXRlLmNmZ2NyMSk7Cj4gKwkJUElQRV9DT05GX0NIRUNLX1goZHBsbF9o
d19zdGF0ZS5jZmdjcjIpOwo+ICsJCVBJUEVfQ09ORl9DSEVDS19YKGRwbGxfaHdfc3RhdGUuY2Zn
Y3IwKTsKPiArCQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLmViYjApOwo+ICsJCVBJ
UEVfQ09ORl9DSEVDS19YKGRwbGxfaHdfc3RhdGUuZWJiNCk7Cj4gKwkJUElQRV9DT05GX0NIRUNL
X1goZHBsbF9od19zdGF0ZS5wbGwwKTsKPiArCQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0
YXRlLnBsbDEpOwo+ICsJCVBJUEVfQ09ORl9DSEVDS19YKGRwbGxfaHdfc3RhdGUucGxsMik7Cj4g
KwkJUElQRV9DT05GX0NIRUNLX1goZHBsbF9od19zdGF0ZS5wbGwzKTsKPiArCQlQSVBFX0NPTkZf
Q0hFQ0tfWChkcGxsX2h3X3N0YXRlLnBsbDYpOwo+ICsJCVBJUEVfQ09ORl9DSEVDS19YKGRwbGxf
aHdfc3RhdGUucGxsOCk7Cj4gKwkJUElQRV9DT05GX0NIRUNLX1goZHBsbF9od19zdGF0ZS5wbGw5
KTsKPiArCQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLnBsbDEwKTsKPiArCQlQSVBF
X0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLnBjc2R3MTIpOwo+ICsJCVBJUEVfQ09ORl9DSEVD
S19YKGRwbGxfaHdfc3RhdGUubWdfcmVmY2xraW5fY3RsKTsKPiArCQlQSVBFX0NPTkZfQ0hFQ0tf
WChkcGxsX2h3X3N0YXRlLm1nX2Nsa3RvcDJfY29yZWNsa2N0bDEpOwo+ICsJCVBJUEVfQ09ORl9D
SEVDS19YKGRwbGxfaHdfc3RhdGUubWdfY2xrdG9wMl9oc2Nsa2N0bCk7Cj4gKwkJUElQRV9DT05G
X0NIRUNLX1goZHBsbF9od19zdGF0ZS5tZ19wbGxfZGl2MCk7Cj4gKwkJUElQRV9DT05GX0NIRUNL
X1goZHBsbF9od19zdGF0ZS5tZ19wbGxfZGl2MSk7Cj4gKwkJUElQRV9DT05GX0NIRUNLX1goZHBs
bF9od19zdGF0ZS5tZ19wbGxfbGYpOwo+ICsJCVBJUEVfQ09ORl9DSEVDS19YKGRwbGxfaHdfc3Rh
dGUubWdfcGxsX2ZyYWNfbG9jayk7Cj4gKwkJUElQRV9DT05GX0NIRUNLX1goZHBsbF9od19zdGF0
ZS5tZ19wbGxfc3NjKTsKPiArCQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLm1nX3Bs
bF9iaWFzKTsKPiArCQlQSVBFX0NPTkZfQ0hFQ0tfWChkcGxsX2h3X3N0YXRlLm1nX3BsbF90ZGNf
Y29sZHN0X2JpYXMpOwo+ICsKPiArCQlQSVBFX0NPTkZfQ0hFQ0tfWChkc2lfcGxsLmN0cmwpOwo+
ICsJCVBJUEVfQ09ORl9DSEVDS19YKGRzaV9wbGwuZGl2KTsKPiArCj4gKwkJaWYgKElTX0c0WChk
ZXZfcHJpdikgfHwgSU5URUxfR0VOKGRldl9wcml2KSA+PSA1KQo+ICsJCQlQSVBFX0NPTkZfQ0hF
Q0tfSShwaXBlX2JwcCk7Cj4gKwo+ICsJCVBJUEVfQ09ORl9DSEVDS19DTE9DS19GVVpaWShody5h
ZGp1c3RlZF9tb2RlLmNydGNfY2xvY2spOwo+ICsJCVBJUEVfQ09ORl9DSEVDS19DTE9DS19GVVpa
WShwb3J0X2Nsb2NrKTsKPiArCj4gKwkJUElQRV9DT05GX0NIRUNLX0kobWluX3ZvbHRhZ2VfbGV2
ZWwpOwo+ICsJfQo+ICAKPiAgCVBJUEVfQ09ORl9DSEVDS19YKGluZm9mcmFtZXMuZW5hYmxlKTsK
PiAgCVBJUEVfQ09ORl9DSEVDS19YKGluZm9mcmFtZXMuZ2NwKTsKPiBAQCAtMTI5NjcsNiArMTMw
OTMsMTIgQEAgaW50ZWxfcGlwZV9jb25maWdfY29tcGFyZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3VycmVudF9jb25maWcsCj4gIAlQSVBFX0NPTkZfQ0hFQ0tfSU5GT0ZSQU1FKGhk
bWkpOwo+ICAJUElQRV9DT05GX0NIRUNLX0lORk9GUkFNRShkcm0pOwo+ICAKPiArCVBJUEVfQ09O
Rl9DSEVDS19CT09MKGJpZ2pvaW5lcik7Cj4gKwlQSVBFX0NPTkZfQ0hFQ0tfQk9PTChiaWdqb2lu
ZXJfc2xhdmUpOwo+ICsJUElQRV9DT05GX0NIRUNLX1AoYmlnam9pbmVyX2xpbmtlZF9jcnRjKTsK
PiArCVBJUEVfQ09ORl9DSEVDS19CT09MKGRzY19wYXJhbXMuY29tcHJlc3Npb25fZW5hYmxlKTsK
PiArCVBJUEVfQ09ORl9DSEVDS19CT09MKGRzY19wYXJhbXMuZHNjX3NwbGl0KTsKPiArCj4gICN1
bmRlZiBQSVBFX0NPTkZfQ0hFQ0tfWAo+ICAjdW5kZWYgUElQRV9DT05GX0NIRUNLX0kKPiAgI3Vu
ZGVmIFBJUEVfQ09ORl9DSEVDS19CT09MCj4gQEAgLTEzMjIxLDYgKzEzMzUzLDcgQEAgdmVyaWZ5
X2NydGNfc3RhdGUoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gIAlzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlcjsKPiAgCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZzsK
PiAgCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZTsKPiArCXN0cnVjdCBpbnRlbF9jcnRj
ICptYXN0ZXIgPSBjcnRjOwo+ICAJYm9vbCBhY3RpdmU7Cj4gIAo+ICAJc3RhdGUgPSBvbGRfY3J0
Y19zdGF0ZS0+dWFwaS5zdGF0ZTsKPiBAQCAtMTMyNTAsNyArMTMzODMsMTAgQEAgdmVyaWZ5X2Ny
dGNfc3RhdGUoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gIAkJCSIoZXhwZWN0ZWQgJWksIGZv
dW5kICVpKVxuIiwKPiAgCQkJbmV3X2NydGNfc3RhdGUtPmh3LmFjdGl2ZSwgY3J0Yy0+YWN0aXZl
KTsKPiAgCj4gLQlmb3JfZWFjaF9lbmNvZGVyX29uX2NydGMoZGV2LCAmY3J0Yy0+YmFzZSwgZW5j
b2Rlcikgewo+ICsJaWYgKG5ld19jcnRjX3N0YXRlLT5iaWdqb2luZXJfc2xhdmUpCj4gKwkJbWFz
dGVyID0gbmV3X2NydGNfc3RhdGUtPmJpZ2pvaW5lcl9saW5rZWRfY3J0YzsKPiArCj4gKwlmb3Jf
ZWFjaF9lbmNvZGVyX29uX2NydGMoZGV2LCAmbWFzdGVyLT5iYXNlLCBlbmNvZGVyKSB7Cj4gIAkJ
ZW51bSBwaXBlIHBpcGU7Cj4gIAo+ICAJCWFjdGl2ZSA9IGVuY29kZXItPmdldF9od19zdGF0ZShl
bmNvZGVyLCAmcGlwZSk7Cj4gQEAgLTEzMjU5LDEyICsxMzM5NSwxMiBAQCB2ZXJpZnlfY3J0Y19z
dGF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgCQkJCWVuY29kZXItPmJhc2UuYmFzZS5p
ZCwgYWN0aXZlLAo+ICAJCQkJbmV3X2NydGNfc3RhdGUtPmh3LmFjdGl2ZSk7Cj4gIAo+IC0JCUk5
MTVfU1RBVEVfV0FSTihhY3RpdmUgJiYgY3J0Yy0+cGlwZSAhPSBwaXBlLAo+ICsJCUk5MTVfU1RB
VEVfV0FSTihhY3RpdmUgJiYgbWFzdGVyLT5waXBlICE9IHBpcGUsCj4gIAkJCQkiRW5jb2RlciBj
b25uZWN0ZWQgdG8gd3JvbmcgcGlwZSAlY1xuIiwKPiAgCQkJCXBpcGVfbmFtZShwaXBlKSk7Cj4g
IAo+ICAJCWlmIChhY3RpdmUpCj4gLQkJCWVuY29kZXItPmdldF9jb25maWcoZW5jb2RlciwgcGlw
ZV9jb25maWcpOwo+ICsJCQlpbnRlbF9lbmNvZGVyX2dldF9jb25maWcoZW5jb2RlciwgcGlwZV9j
b25maWcpOwo+ICAJfQo+ICAKPiAgCWludGVsX2NydGNfY29tcHV0ZV9waXhlbF9yYXRlKHBpcGVf
Y29uZmlnKTsKPiBAQCAtMTM5MDYsNiArMTQwNDIsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF91cGRh
dGVfY3J0YyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgCj4gIAlpZiAobW9kZXNldCkgewo+
ICAJCXVwZGF0ZV9zY2FubGluZV9vZmZzZXQobmV3X2NydGNfc3RhdGUpOwo+ICsJCWRybV9jYWxj
X3RpbWVzdGFtcGluZ19jb25zdGFudHMoJmNydGMtPmJhc2UsICZuZXdfY3J0Y19zdGF0ZS0+aHcu
dHJhbnNjb2Rlcl9tb2RlKTsKPiAgCQlkZXZfcHJpdi0+ZGlzcGxheS5jcnRjX2VuYWJsZShuZXdf
Y3J0Y19zdGF0ZSwgc3RhdGUpOwo+ICAKPiAgCQkvKiB2YmxhbmtzIHdvcmsgYWdhaW4sIHJlLWVu
YWJsZSBwaXBlIENSQy4gKi8KPiBAQCAtMTM5OTAsNyArMTQxMjcsNyBAQCBzdGF0aWMgdm9pZCBp
bnRlbF9jb21taXRfbW9kZXNldF9kaXNhYmxlcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpz
dGF0ZSkKPiAgCSAqLwo+ICAJZm9yX2VhY2hfb2xkbmV3X2ludGVsX2NydGNfaW5fc3RhdGVfcmV2
ZXJzZShzdGF0ZSwgY3J0Yywgb2xkX2NydGNfc3RhdGUsCj4gIAkJCQkJCSAgICBuZXdfY3J0Y19z
dGF0ZSwgaSkgewo+IC0JCWlmICghbmVlZHNfbW9kZXNldChuZXdfY3J0Y19zdGF0ZSkpCj4gKwkJ
aWYgKCFuZWVkc19tb2Rlc2V0KG5ld19jcnRjX3N0YXRlKSB8fCBvbGRfY3J0Y19zdGF0ZS0+Ymln
am9pbmVyX3NsYXZlKQo+ICAJCQljb250aW51ZTsKPiAgCj4gIAkJaW50ZWxfcHJlX3BsYW5lX3Vw
ZGF0ZShvbGRfY3J0Y19zdGF0ZSwgbmV3X2NydGNfc3RhdGUpOwo+IEBAIC0xNDAwMCw2ICsxNDEz
NywxOSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9jb21taXRfbW9kZXNldF9kaXNhYmxlcyhzdHJ1Y3Qg
aW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgCQkJCQkJICAgICAgb2xkX2NydGNfc3RhdGUs
Cj4gIAkJCQkJCSAgICAgIG5ld19jcnRjX3N0YXRlLAo+ICAJCQkJCQkgICAgICBjcnRjKTsKPiAr
Cj4gKwkJaWYgKG9sZF9jcnRjX3N0YXRlLT5iaWdqb2luZXIpIHsKPiArCQkJc3RydWN0IGludGVs
X2NydGMgKnNsYXZlID0gb2xkX2NydGNfc3RhdGUtPmJpZ2pvaW5lcl9saW5rZWRfY3J0YzsKPiAr
CQkJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9zbGF2ZV9jcnRjX3N0YXRlID0KPiArCQkJ
CWludGVsX2F0b21pY19nZXRfY3J0Y19zdGF0ZSgmc3RhdGUtPmJhc2UsIHNsYXZlKTsKPiArCQkJ
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19zbGF2ZV9jcnRjX3N0YXRlID0KPiArCQkJCWlu
dGVsX2F0b21pY19nZXRfY3J0Y19zdGF0ZSgmc3RhdGUtPmJhc2UsIHNsYXZlKTsKPiArCj4gKwkJ
CWludGVsX29sZF9jcnRjX3N0YXRlX2Rpc2FibGVzKHN0YXRlLAo+ICsJCQkJCQkgICAgICBvbGRf
c2xhdmVfY3J0Y19zdGF0ZSwKPiArCQkJCQkJICAgICAgbmV3X3NsYXZlX2NydGNfc3RhdGUsCj4g
KwkJCQkJCSAgICAgIHNsYXZlKTsKPiArCQl9Cj4gIAl9Cj4gIH0KPiAgCj4gQEAgLTE2NDMzLDcg
KzE2NTgzLDcgQEAgaW50IGludGVsX21vZGVzZXRfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
KQo+ICAJZm9yX2VhY2hfaW50ZWxfY3J0YyhkZXYsIGNydGMpIHsKPiAgCQlzdHJ1Y3QgaW50ZWxf
aW5pdGlhbF9wbGFuZV9jb25maWcgcGxhbmVfY29uZmlnID0ge307Cj4gIAo+IC0JCWlmICghY3J0
Yy0+YWN0aXZlKQo+ICsJCWlmICghdG9faW50ZWxfY3J0Y19zdGF0ZShjcnRjLT5iYXNlLnN0YXRl
KS0+dWFwaS5hY3RpdmUpCj4gIAkJCWNvbnRpbnVlOwo+ICAKPiAgCQkvKgo+IEBAIC0xNjkyMyw3
ICsxNzA3MywxNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9tb2Rlc2V0X3JlYWRvdXRfaHdfc3RhdGUo
c3RydWN0IGRybV9kZXZpY2UgKmRldikKPiAgCQkJY3J0Y19zdGF0ZSA9IHRvX2ludGVsX2NydGNf
c3RhdGUoY3J0Yy0+YmFzZS5zdGF0ZSk7Cj4gIAo+ICAJCQllbmNvZGVyLT5iYXNlLmNydGMgPSAm
Y3J0Yy0+YmFzZTsKPiAtCQkJZW5jb2Rlci0+Z2V0X2NvbmZpZyhlbmNvZGVyLCBjcnRjX3N0YXRl
KTsKPiArCQkJaW50ZWxfZW5jb2Rlcl9nZXRfY29uZmlnKGVuY29kZXIsIGNydGNfc3RhdGUpOwo+
ICsKPiArCQkJLyogcmVhZCBvdXQgdG8gc2xhdmUgY3J0YyBhcyB3ZWxsIGZvciBiaWdqb2luZXIg
Ki8KPiArCQkJaWYgKGNydGNfc3RhdGUtPmJpZ2pvaW5lcikgewo+ICsJCQkJLyogZW5jb2RlciBz
aG91bGQgcmVhZCBiZSBsaW5rZWQgdG8gYmlnam9pbmVyIG1hc3RlciAqLwo+ICsJCQkJV0FSTl9P
TihjcnRjX3N0YXRlLT5iaWdqb2luZXJfc2xhdmUpOwo+ICsKPiArCQkJCWNydGMgPSBjcnRjX3N0
YXRlLT5iaWdqb2luZXJfbGlua2VkX2NydGM7Cj4gKwkJCQljcnRjX3N0YXRlID0gdG9faW50ZWxf
Y3J0Y19zdGF0ZShjcnRjLT5iYXNlLnN0YXRlKTsKPiArCQkJCWludGVsX2VuY29kZXJfZ2V0X2Nv
bmZpZyhlbmNvZGVyLCBjcnRjX3N0YXRlKTsKPiArCQkJfQo+ICAJCX0gZWxzZSB7Cj4gIAkJCWVu
Y29kZXItPmJhc2UuY3J0YyA9IE5VTEw7Cj4gIAkJfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oCj4gaW5kZXggZGQwMzI5YTRiOWZm
Li43ZTA2YzYxNDQ3ZTYgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaAo+IEBAIC03ODYsNiArNzg2LDcgQEAgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgewo+ICAJICogYWNjb3JkaW5nbHkuCj4gIAkgKi8KPiAgI2RlZmluZSBQ
SVBFX0NPTkZJR19RVUlSS19NT0RFX1NZTkNfRkxBR1MJKDE8PDApIC8qIHVucmVsaWFibGUgc3lu
YyBtb2RlLmZsYWdzICovCj4gKyNkZWZpbmUgUElQRV9DT05GSUdfUVVJUktfQklHSk9JTkVSX1NM
QVZFCSgxPDwxKSAvKiBiaWdqb2luZXIgc2xhdmUsIHBhcnRpYWwgcmVhZG91dCAqLwo+ICAJdW5z
aWduZWQgbG9uZyBxdWlya3M7Cj4gIAo+ICAJdW5zaWduZWQgZmJfYml0czsgLyogZnJhbWVidWZm
ZXJzIHRvIGZsaXAgKi8KPiBAQCAtMTU3Miw0ICsxNTczLDIwIEBAIHN0YXRpYyBpbmxpbmUgdTMy
IGludGVsX3BsYW5lX2dndHRfb2Zmc2V0KGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAq
c3RhdGUpCj4gIAlyZXR1cm4gaTkxNV9nZ3R0X29mZnNldChzdGF0ZS0+dm1hKTsKPiAgfQo+ICAK
PiArc3RhdGljIGlubGluZSBib29sCj4gK2ludGVsX2NydGNfc3VwcG9ydHNfZHNjKGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiArewo+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShwaXBlX2NvbmZpZy0+dWFwaS5jcnRjLT5k
ZXYpOwo+ICsKPiArCS8qIE9uIFRHTCwgRFNDIGlzIHN1cHBvcnRlZCBvbiBhbGwgUGlwZXMgKi8K
PiArCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEyKQo+ICsJCXJldHVybiB0cnVlOwo+ICsK
PiArCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwICYmCj4gKwkgICAgcGlwZV9jb25maWct
PmNwdV90cmFuc2NvZGVyICE9IFRSQU5TQ09ERVJfQSkKPiArCQlyZXR1cm4gdHJ1ZTsKPiArCj4g
KwlyZXR1cm4gZmFsc2U7Cj4gK30KPiArCj4gICNlbmRpZiAvKiAgX19JTlRFTF9ESVNQTEFZX1RZ
UEVTX0hfXyAqLwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX2RwLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwLmMKPiBpbmRl
eCAzZDQ4N2NlMTYxNTEuLjIzNGJlMWMzMTk1OCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2RwLmMKPiBAQCAtMTkwNywyMiArMTkwNyw2IEBAIHN0YXRpYyBib29sIGlu
dGVsX2RwX3N1cHBvcnRzX2ZlYyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ICAJCWRybV9k
cF9zaW5rX3N1cHBvcnRzX2ZlYyhpbnRlbF9kcC0+ZmVjX2NhcGFibGUpOwo+ICB9Cj4gIAo+IC1z
dGF0aWMgYm9vbCBpbnRlbF9kcF9zb3VyY2Vfc3VwcG9ydHNfZHNjKHN0cnVjdCBpbnRlbF9kcCAq
aW50ZWxfZHAsCj4gLQkJCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2Nv
bmZpZykKPiAtewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9f
aTkxNShpbnRlbF9kcCk7Cj4gLQo+IC0JLyogT24gVEdMLCBEU0MgaXMgc3VwcG9ydGVkIG9uIGFs
bCBQaXBlcyAqLwo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTIpCj4gLQkJcmV0dXJu
IHRydWU7Cj4gLQo+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgJiYKPiAtCSAgICBw
aXBlX2NvbmZpZy0+Y3B1X3RyYW5zY29kZXIgIT0gVFJBTlNDT0RFUl9BKQo+IC0JCXJldHVybiB0
cnVlOwo+IC0KPiAtCXJldHVybiBmYWxzZTsKPiAtfQo+IC0KPiAgc3RhdGljIGJvb2wgaW50ZWxf
ZHBfc3VwcG9ydHNfZHNjKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gIAkJCQkgIGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiAgewo+IEBAIC0xOTMwLDcg
KzE5MTQsNyBAQCBzdGF0aWMgYm9vbCBpbnRlbF9kcF9zdXBwb3J0c19kc2Moc3RydWN0IGludGVs
X2RwICppbnRlbF9kcCwKPiAgCWlmICghaW50ZWxfZHBfaXNfZWRwKGludGVsX2RwKSAmJiAhcGlw
ZV9jb25maWctPmZlY19lbmFibGUgJiYgMCkKPiAgCQlyZXR1cm4gZmFsc2U7Cj4gIAo+IC0JcmV0
dXJuIGludGVsX2RwX3NvdXJjZV9zdXBwb3J0c19kc2MoaW50ZWxfZHAsIHBpcGVfY29uZmlnKSAm
Jgo+ICsJcmV0dXJuIGludGVsX2NydGNfc3VwcG9ydHNfZHNjKHBpcGVfY29uZmlnKSAmJgo+ICAJ
CWRybV9kcF9zaW5rX3N1cHBvcnRzX2RzYyhpbnRlbF9kcC0+ZHNjX2RwY2QpOwo+ICB9Cj4gIAo+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Zkc2MuYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfdmRzYy5jCj4gaW5kZXggMzhjMTgx
NDk5NTA1Li4xMWQ0ZGE5NzM0YTAgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF92ZHNjLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX3Zkc2MuYwo+IEBAIC00ODAsMTEgKzQ4MCwxMCBAQCBpbnRlbF9kc2NfcG93ZXJfZG9t
YWluKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICAJCXJldHVy
biBQT1dFUl9ET01BSU5fVFJBTlNDT0RFUihjcHVfdHJhbnNjb2Rlcik7Cj4gIH0KPiAgCj4gLXN0
YXRpYyB2b2lkIGludGVsX2NvbmZpZ3VyZV9wcHNfZm9yX2RzY19lbmNvZGVyKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+IC0JCQkJCQljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSkKPiArc3RhdGljIHZvaWQgaW50ZWxfY29uZmlndXJlX3Bwc19mb3JfZHNj
X2VuY29kZXIoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHsK
PiAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51
YXBpLmNydGMpOwo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShlbmNvZGVyLT5iYXNlLmRldik7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiAgCWNvbnN0IHN0cnVjdCBkcm1fZHNjX2Nv
bmZpZyAqdmRzY19jZmcgPSAmY3J0Y19zdGF0ZS0+ZHBfZHNjX2NmZzsKPiAgCWVudW0gcGlwZSBw
aXBlID0gY3J0Yy0+cGlwZTsKPiAgCWVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNjb2RlciA9IGNy
dGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyOwo+IEBAIC00OTQsNiArNDkzLDkgQEAgc3RhdGljIHZv
aWQgaW50ZWxfY29uZmlndXJlX3Bwc19mb3JfZHNjX2VuY29kZXIoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIsCj4gIAl1OCBudW1fdmRzY19pbnN0YW5jZXMgPSAoY3J0Y19zdGF0ZS0+ZHNj
X3BhcmFtcy5kc2Nfc3BsaXQpID8gMiA6IDE7Cj4gIAlpbnQgaSA9IDA7Cj4gIAo+ICsJaWYgKGNy
dGNfc3RhdGUtPmJpZ2pvaW5lcikKPiArCQludW1fdmRzY19pbnN0YW5jZXMgKj0gMjsKPiArCj4g
IAkvKiBQb3B1bGF0ZSBQSUNUVVJFX1BBUkFNRVRFUl9TRVRfMCByZWdpc3RlcnMgKi8KPiAgCXBw
c192YWwgPSBEU0NfVkVSX01BSiB8IHZkc2NfY2ZnLT5kc2NfdmVyc2lvbl9taW5vciA8PAo+ICAJ
CURTQ19WRVJfTUlOX1NISUZUIHwKPiBAQCAtODk5LDc0ICs5MDEsMTA0IEBAIHN0YXRpYyB2b2lk
IGludGVsX2RwX3dyaXRlX2RzY19wcHNfc2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ICAJCQkJCXNpemVvZihkcF9kc2NfcHBzX3NkcCkpOwo+ICB9Cj4gIAo+ICtzdGF0aWMgaTkx
NV9yZWdfdCBkc3NfY3RsMV9yZWcoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUpCj4gK3sKPiArCWVudW0gcGlwZSBwaXBlID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRl
LT51YXBpLmNydGMpLT5waXBlOwo+ICsKPiArCWlmIChjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2Rl
ciA9PSBUUkFOU0NPREVSX0VEUCkKPiArCQlyZXR1cm4gRFNTX0NUTDE7Cj4gKwo+ICsJcmV0dXJu
IElDTF9QSVBFX0RTU19DVEwxKHBpcGUpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaTkxNV9yZWdfdCBk
c3NfY3RsMl9yZWcoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4g
K3sKPiArCWVudW0gcGlwZSBwaXBlID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNy
dGMpLT5waXBlOwo+ICsKPiArCWlmIChjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlciA9PSBUUkFO
U0NPREVSX0VEUCkKPiArCQlyZXR1cm4gRFNTX0NUTDI7Cj4gKwo+ICsJcmV0dXJuIElDTF9QSVBF
X0RTU19DVEwyKHBpcGUpOwo+ICt9Cj4gKwo+ICB2b2lkIGludGVsX2RzY19lbmFibGUoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gIAkJICAgICAgY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gIHsKPiAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0g
dG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gLQllbnVt
IHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gLQlpOTE1X3JlZ190IGRzc19jdGwxX3JlZywgZHNz
X2N0bDJfcmVnOwo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjcnRjLT5iYXNlLmRldik7Cj4gIAl1MzIgZHNzX2N0bDFfdmFsID0gMDsKPiAgCXUzMiBkc3Nf
Y3RsMl92YWwgPSAwOwo+ICAKPiAgCWlmICghY3J0Y19zdGF0ZS0+ZHNjX3BhcmFtcy5jb21wcmVz
c2lvbl9lbmFibGUpCj4gIAkJcmV0dXJuOwo+ICAKPiAtCS8qIEVuYWJsZSBQb3dlciB3ZWxscyBm
b3IgVkRTQy9qb2luaW5nICovCj4gLQlpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChkZXZfcHJpdiwK
PiAtCQkJCWludGVsX2RzY19wb3dlcl9kb21haW4oY3J0Y19zdGF0ZSkpOwo+ICsJaW50ZWxfY29u
ZmlndXJlX3Bwc19mb3JfZHNjX2VuY29kZXIoY3J0Y19zdGF0ZSk7Cj4gIAo+IC0JaW50ZWxfY29u
ZmlndXJlX3Bwc19mb3JfZHNjX2VuY29kZXIoZW5jb2RlciwgY3J0Y19zdGF0ZSk7Cj4gKwlpZiAo
IWNydGNfc3RhdGUtPmJpZ2pvaW5lcl9zbGF2ZSkKPiArCQlpbnRlbF9kcF93cml0ZV9kc2NfcHBz
X3NkcChlbmNvZGVyLCBjcnRjX3N0YXRlKTsKPiAgCj4gLQlpbnRlbF9kcF93cml0ZV9kc2NfcHBz
X3NkcChlbmNvZGVyLCBjcnRjX3N0YXRlKTsKPiAtCj4gLQlpZiAoY3J0Y19zdGF0ZS0+Y3B1X3Ry
YW5zY29kZXIgPT0gVFJBTlNDT0RFUl9FRFApIHsKPiAtCQlkc3NfY3RsMV9yZWcgPSBEU1NfQ1RM
MTsKPiAtCQlkc3NfY3RsMl9yZWcgPSBEU1NfQ1RMMjsKPiAtCX0gZWxzZSB7Cj4gLQkJZHNzX2N0
bDFfcmVnID0gSUNMX1BJUEVfRFNTX0NUTDEocGlwZSk7Cj4gLQkJZHNzX2N0bDJfcmVnID0gSUNM
X1BJUEVfRFNTX0NUTDIocGlwZSk7Cj4gLQl9Cj4gIAlkc3NfY3RsMl92YWwgfD0gTEVGVF9CUkFO
Q0hfVkRTQ19FTkFCTEU7Cj4gIAlpZiAoY3J0Y19zdGF0ZS0+ZHNjX3BhcmFtcy5kc2Nfc3BsaXQp
IHsKPiAgCQlkc3NfY3RsMl92YWwgfD0gUklHSFRfQlJBTkNIX1ZEU0NfRU5BQkxFOwo+ICAJCWRz
c19jdGwxX3ZhbCB8PSBKT0lORVJfRU5BQkxFOwo+ICAJfQo+IC0JSTkxNV9XUklURShkc3NfY3Rs
MV9yZWcsIGRzc19jdGwxX3ZhbCk7Cj4gLQlJOTE1X1dSSVRFKGRzc19jdGwyX3JlZywgZHNzX2N0
bDJfdmFsKTsKPiArCWlmIChjcnRjX3N0YXRlLT5iaWdqb2luZXIpIHsKPiArCQlkc3NfY3RsMV92
YWwgfD0gQklHX0pPSU5FUl9FTkFCTEU7Cj4gKwkJaWYgKCFjcnRjX3N0YXRlLT5iaWdqb2luZXJf
c2xhdmUpCj4gKwkJCWRzc19jdGwxX3ZhbCB8PSBNQVNURVJfQklHX0pPSU5FUl9FTkFCTEU7Cj4g
Kwl9Cj4gKwlJOTE1X1dSSVRFKGRzc19jdGwxX3JlZyhjcnRjX3N0YXRlKSwgZHNzX2N0bDFfdmFs
KTsKPiArCUk5MTVfV1JJVEUoZHNzX2N0bDJfcmVnKGNydGNfc3RhdGUpLCBkc3NfY3RsMl92YWwp
Owo+ICB9Cj4gIAo+ICB2b2lkIGludGVsX2RzY19kaXNhYmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKPiAgewo+ICAJc3RydWN0IGludGVsX2NydGMgKmNy
dGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+ICAJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4g
LQllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gLQlpOTE1X3JlZ190IGRzc19jdGwxX3Jl
ZywgZHNzX2N0bDJfcmVnOwo+IC0JdTMyIGRzc19jdGwxX3ZhbCA9IDAsIGRzc19jdGwyX3ZhbCA9
IDA7Cj4gIAo+ICAJaWYgKCFvbGRfY3J0Y19zdGF0ZS0+ZHNjX3BhcmFtcy5jb21wcmVzc2lvbl9l
bmFibGUpCj4gIAkJcmV0dXJuOwo+ICAKPiAtCWlmIChvbGRfY3J0Y19zdGF0ZS0+Y3B1X3RyYW5z
Y29kZXIgPT0gVFJBTlNDT0RFUl9FRFApIHsKPiAtCQlkc3NfY3RsMV9yZWcgPSBEU1NfQ1RMMTsK
PiAtCQlkc3NfY3RsMl9yZWcgPSBEU1NfQ1RMMjsKPiAtCX0gZWxzZSB7Cj4gLQkJZHNzX2N0bDFf
cmVnID0gSUNMX1BJUEVfRFNTX0NUTDEocGlwZSk7Cj4gLQkJZHNzX2N0bDJfcmVnID0gSUNMX1BJ
UEVfRFNTX0NUTDIocGlwZSk7Cj4gKwlJOTE1X1dSSVRFKGRzc19jdGwxX3JlZyhvbGRfY3J0Y19z
dGF0ZSksIDApOwo+ICsJSTkxNV9XUklURShkc3NfY3RsMl9yZWcob2xkX2NydGNfc3RhdGUpLCAw
KTsKPiArfQo+ICsKPiArdm9pZCBpbnRlbF9kc2NfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiArewo+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0
b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiArCXUzMiBkc3Nf
Y3RsMV92YWwsIGRzc19jdGwyX3ZhbDsKPiArCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICsK
PiArCWlmICghaW50ZWxfY3J0Y19zdXBwb3J0c19kc2MoY3J0Y19zdGF0ZSkpCj4gKwkJcmV0dXJu
Owo+ICsKPiArCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGRl
dl9wcml2LCBpbnRlbF9kc2NfcG93ZXJfZG9tYWluKGNydGNfc3RhdGUpKTsKPiArCWlmICghd2Fr
ZXJlZikKPiArCQlyZXR1cm47Cj4gKwo+ICsJZHNzX2N0bDFfdmFsID0gSTkxNV9SRUFEKGRzc19j
dGwxX3JlZyhjcnRjX3N0YXRlKSk7Cj4gKwlkc3NfY3RsMl92YWwgPSBJOTE1X1JFQUQoZHNzX2N0
bDJfcmVnKGNydGNfc3RhdGUpKTsKPiArCWlmIChkc3NfY3RsMl92YWwgJiBMRUZUX0JSQU5DSF9W
RFNDX0VOQUJMRSkKPiArCQljcnRjX3N0YXRlLT5kc2NfcGFyYW1zLmNvbXByZXNzaW9uX2VuYWJs
ZSA9IHRydWU7Cj4gKwo+ICsJaWYgKChkc3NfY3RsMV92YWwgJiBKT0lORVJfRU5BQkxFKSAmJiAo
ZHNzX2N0bDJfdmFsICYgUklHSFRfQlJBTkNIX1ZEU0NfRU5BQkxFKSkKPiArCQljcnRjX3N0YXRl
LT5kc2NfcGFyYW1zLmRzY19zcGxpdCA9IHRydWU7Cj4gKwo+ICsJaWYgKGRzc19jdGwxX3ZhbCAm
IEJJR19KT0lORVJfRU5BQkxFKSB7Cj4gKwkJY3J0Y19zdGF0ZS0+Ymlnam9pbmVyID0gdHJ1ZTsK
PiArCj4gKwkJaWYgKCEoZHNzX2N0bDFfdmFsICYgTUFTVEVSX0JJR19KT0lORVJfRU5BQkxFKSkg
ewo+ICsJCQljcnRjX3N0YXRlLT5iaWdqb2luZXJfc2xhdmUgPSB0cnVlOwo+ICsJCQlpZiAoIVdB
Uk5fT04oY3J0Yy0+cGlwZSA9PSBQSVBFX0EpKQo+ICsJCQkJY3J0Y19zdGF0ZS0+Ymlnam9pbmVy
X2xpbmtlZF9jcnRjID0KPiArCQkJCQlpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShkZXZfcHJpdiwg
Y3J0Yy0+cGlwZSAtIDEpOwo+ICsJCX0gZWxzZSB7Cj4gKwkJCWlmICghV0FSTl9PTihJTlRFTF9O
VU1fUElQRVMoZGV2X3ByaXYpID09IGNydGMtPnBpcGUgKyAxKSkKPiArCQkJCWNydGNfc3RhdGUt
PmJpZ2pvaW5lcl9saW5rZWRfY3J0YyA9Cj4gKwkJCQkJaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUo
ZGV2X3ByaXYsIGNydGMtPnBpcGUgKyAxKTsKPiArCQl9Cj4gIAl9Cj4gLQlkc3NfY3RsMV92YWwg
PSBJOTE1X1JFQUQoZHNzX2N0bDFfcmVnKTsKPiAtCWlmIChkc3NfY3RsMV92YWwgJiBKT0lORVJf
RU5BQkxFKQo+IC0JCWRzc19jdGwxX3ZhbCAmPSB+Sk9JTkVSX0VOQUJMRTsKPiAtCUk5MTVfV1JJ
VEUoZHNzX2N0bDFfcmVnLCBkc3NfY3RsMV92YWwpOwo+IC0KPiAtCWRzc19jdGwyX3ZhbCA9IEk5
MTVfUkVBRChkc3NfY3RsMl9yZWcpOwo+IC0JaWYgKGRzc19jdGwyX3ZhbCAmIExFRlRfQlJBTkNI
X1ZEU0NfRU5BQkxFIHx8Cj4gLQkgICAgZHNzX2N0bDJfdmFsICYgUklHSFRfQlJBTkNIX1ZEU0Nf
RU5BQkxFKQo+IC0JCWRzc19jdGwyX3ZhbCAmPSB+KExFRlRfQlJBTkNIX1ZEU0NfRU5BQkxFIHwK
PiAtCQkJCSAgUklHSFRfQlJBTkNIX1ZEU0NfRU5BQkxFKTsKPiAtCUk5MTVfV1JJVEUoZHNzX2N0
bDJfcmVnLCBkc3NfY3RsMl92YWwpOwo+IC0KPiAtCS8qIERpc2FibGUgUG93ZXIgd2VsbHMgZm9y
IFZEU0Mvam9pbmluZyAqLwo+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfdW5jaGVja2VkKGRl
dl9wcml2LAo+IC0JCQkJCSAgaW50ZWxfZHNjX3Bvd2VyX2RvbWFpbihvbGRfY3J0Y19zdGF0ZSkp
Owo+ICsKPiArCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBpbnRlbF9kc2NfcG93
ZXJfZG9tYWluKGNydGNfc3RhdGUpLCB3YWtlcmVmKTsKPiAgfQo+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Zkc2MuaCBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfdmRzYy5oCj4gaW5kZXggOTBkM2Y2MDE3ZmNiLi41NjljZjE3NDAy
YmEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF92ZHNj
LmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Zkc2MuaAo+IEBA
IC0xNSw2ICsxNSw4IEBAIHZvaWQgaW50ZWxfZHNjX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiAgdm9pZCBpbnRlbF9kc2NfZGlzYWJsZShjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7Cj4gIGludCBpbnRlbF9kcF9jb21wdXRlX2RzY19wYXJh
bXMoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiAgCQkJCXN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpwaXBlX2NvbmZpZyk7Cj4gK3ZvaWQgaW50ZWxfZHNjX2dldF9jb25maWcoc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpOwo+ICsKPiAgZW51bSBpbnRlbF9kaXNwbGF5X3Bv
d2VyX2RvbWFpbgo+ICBpbnRlbF9kc2NfcG93ZXJfZG9tYWluKGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlKTsKPiAgCj4gLS0gCj4gMi4yMC4xCj4gCj4gX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KPiBJbnRlbC1nZnggbWFpbGlu
ZyBsaXN0Cj4gSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwo+IGh0dHBzOi8vbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4CgotLSAKTWF0dCBSb3Bl
cgpHcmFwaGljcyBTb2Z0d2FyZSBFbmdpbmVlcgpWVFQtT1NHQyBQbGF0Zm9ybSBFbmFibGVtZW50
CkludGVsIENvcnBvcmF0aW9uCig5MTYpIDM1Ni0yNzk1Cl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4
QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWls
bWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

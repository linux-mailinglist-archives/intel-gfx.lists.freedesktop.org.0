Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 2D547FB782
	for <lists+intel-gfx@lfdr.de>; Wed, 13 Nov 2019 19:28:37 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2EC436EDE2;
	Wed, 13 Nov 2019 18:28:35 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8A7C56EDE2;
 Wed, 13 Nov 2019 18:28:25 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19191409-1500050 
 for multiple; Wed, 13 Nov 2019 18:28:10 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 13 Nov 2019 18:28:06 +0000
Message-Id: <20191113182808.10780-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t 1/3] i915: Skip if secure batches is not
 available
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: igt-dev@lists.freedesktop.org, Kuoppala@freedesktop.org,
	"Kuoppala,  Mika" <mika.kuoppala@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogIkt1b3BwYWxhLCBNaWthIiA8bWlrYS5rdW9wcGFsYUBpbnRlbC5jb20+CgpJZiB3ZSBj
YW4ndCBkbyBzZWN1cmUgZXhlY2J1ZiwgdGhlcmUgaXMgbm8gcG9pbnQgaW4gdHJ5aW5nLgoKU2ln
bmVkLW9mZi1ieTogS3VvcHBhbGEsIE1pa2EgPG1pa2Eua3VvcHBhbGFAaW50ZWwuY29tPgotLS0K
IHRlc3RzL2k5MTUvZ2VtX2V4ZWNfcGFyYW1zLmMgICB8IDIyICsrKysrKysrKysrKysrKysrKysr
LS0KIHRlc3RzL2k5MTUvZ2VtX21vY3Nfc2V0dGluZ3MuYyB8IDE0ICsrKysrKysrKysrKysrCiB0
ZXN0cy9wZXJmX3BtdS5jICAgICAgICAgICAgICAgfCAxNCArKysrKysrKysrKysrKwogMyBmaWxl
cyBjaGFuZ2VkLCA0OCBpbnNlcnRpb25zKCspLCAyIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBh
L3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfcGFyYW1zLmMgYi90ZXN0cy9pOTE1L2dlbV9leGVjX3BhcmFt
cy5jCmluZGV4IDhmMTVlNjQ1NC4uOWMzNTI1Njk4IDEwMDY0NAotLS0gYS90ZXN0cy9pOTE1L2dl
bV9leGVjX3BhcmFtcy5jCisrKyBiL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfcGFyYW1zLmMKQEAgLTE5
Myw2ICsxOTMsMTkgQEAgc3RhdGljIHZvaWQgdGVzdF9iYXRjaF9maXJzdChpbnQgZmQpCiAJZ2Vt
X2Nsb3NlKGZkLCBvYmpbMF0uaGFuZGxlKTsKIH0KIAorc3RhdGljIGludCBoYXNfc2VjdXJlX2Jh
dGNoZXMoY29uc3QgaW50IGZkKQoreworCWludCB2ID0gLTE7CisJZHJtX2k5MTVfZ2V0cGFyYW1f
dCBncCA9IHsKKwkJLnBhcmFtID0gSTkxNV9QQVJBTV9IQVNfU0VDVVJFX0JBVENIRVMsCisJCS52
YWx1ZSA9ICZ2LAorCX07CisKKwlkcm1Jb2N0bChmZCwgRFJNX0lPQ1RMX0k5MTVfR0VUUEFSQU0s
ICZncCk7CisKKwlyZXR1cm4gdiA+IDA7Cit9CisKIHN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY2J1
ZmZlcjIgZXhlY2J1ZjsKIHN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY19vYmplY3QyIGdlbV9leGVj
WzFdOwogdWludDMyX3QgYmF0Y2hbMl0gPSB7TUlfQkFUQ0hfQlVGRkVSX0VORH07CkBAIC0zNDAs
NiArMzUzLDggQEAgaWd0X21haW4KIAl9CiAKIAlpZ3Rfc3VidGVzdCgic2VjdXJlLW5vbi1yb290
IikgeworCQlpZ3RfcmVxdWlyZShoYXNfc2VjdXJlX2JhdGNoZXMoZmQpKTsKKwogCQlpZ3RfZm9y
ayhjaGlsZCwgMSkgewogCQkJaWd0X2Ryb3Bfcm9vdCgpOwogCkBAIC0zNTEsOSArMzY2LDEyIEBA
IGlndF9tYWluCiAJfQogCiAJaWd0X3N1YnRlc3QoInNlY3VyZS1ub24tbWFzdGVyIikgewotCQlp
Z3RfcmVxdWlyZShfX2lndF9kZXZpY2Vfc2V0X21hc3RlcihmZCkgPT0gMCk7IC8qIFJlcXVpcmVz
IHJvb3QgcHJpdmlsZWdlICovCisJCWlndF9yZXF1aXJlKGhhc19zZWN1cmVfYmF0Y2hlcyhmZCkp
OworCisJCS8qIFJlcXVpcmVzIHJvb3QgcHJpdmlsZWdlLi4uICovCisJCWlndF9yZXF1aXJlKF9f
aWd0X2RldmljZV9zZXRfbWFzdGVyKGZkKSA9PSAwKTsKKwkJaWd0X2RldmljZV9kcm9wX21hc3Rl
cihmZCk7IC8qIC4uLiB0byBkcm9wIG1hc3RlciEgKi8KIAotCQlpZ3RfZGV2aWNlX2Ryb3BfbWFz
dGVyKGZkKTsKIAkJZXhlY2J1Zi5mbGFncyA9IEk5MTVfRVhFQ19SRU5ERVIgfCBJOTE1X0VYRUNf
U0VDVVJFOwogCQlSVU5fRkFJTChFUEVSTSk7CiAKZGlmZiAtLWdpdCBhL3Rlc3RzL2k5MTUvZ2Vt
X21vY3Nfc2V0dGluZ3MuYyBiL3Rlc3RzL2k5MTUvZ2VtX21vY3Nfc2V0dGluZ3MuYwppbmRleCBm
YzJjY2IyMTYuLjk2MjdkODI4ZiAxMDA2NDQKLS0tIGEvdGVzdHMvaTkxNS9nZW1fbW9jc19zZXR0
aW5ncy5jCisrKyBiL3Rlc3RzL2k5MTUvZ2VtX21vY3Nfc2V0dGluZ3MuYwpAQCAtMjI1LDYgKzIy
NSwxOSBAQCBzdGF0aWMgdWludDMyX3QgZ2V0X2VuZ2luZV9iYXNlKGludCBmZCwgdWludDMyX3Qg
ZW5naW5lKQogCX0KIH0KIAorc3RhdGljIGludCBoYXNfc2VjdXJlX2JhdGNoZXMoY29uc3QgaW50
IGZkKQoreworCWludCB2ID0gLTE7CisJZHJtX2k5MTVfZ2V0cGFyYW1fdCBncCA9IHsKKwkJLnBh
cmFtID0gSTkxNV9QQVJBTV9IQVNfU0VDVVJFX0JBVENIRVMsCisJCS52YWx1ZSA9ICZ2LAorCX07
CisKKwlkcm1Jb2N0bChmZCwgRFJNX0lPQ1RMX0k5MTVfR0VUUEFSQU0sICZncCk7CisKKwlyZXR1
cm4gdiA+IDA7Cit9CisKICNkZWZpbmUgTUlfU1RPUkVfUkVHSVNURVJfTUVNXzY0X0JJVF9BRERS
CSgoMHgyNCA8PCAyMykgfCAyKQogCiBzdGF0aWMgaW50IGNyZWF0ZV9yZWFkX2JhdGNoKHN0cnVj
dCBkcm1faTkxNV9nZW1fcmVsb2NhdGlvbl9lbnRyeSAqcmVsb2MsCkBAIC01NjYsNiArNTc5LDcg
QEAgaWd0X21haW4KIAkJaWd0X3JlcXVpcmVfZ2VtKGZkKTsKIAkJZ2VtX3JlcXVpcmVfbW9jc19y
ZWdpc3RlcnMoZmQpOwogCQlpZ3RfcmVxdWlyZShnZXRfbW9jc19zZXR0aW5ncyhmZCwgJnRhYmxl
LCBmYWxzZSkpOworCQlpZ3RfcmVxdWlyZShoYXNfc2VjdXJlX2JhdGNoZXMoZmQpKTsKIAl9CiAK
IAlmb3IgKGUgPSBpbnRlbF9leGVjdXRpb25fZW5naW5lczsgZS0+bmFtZTsgZSsrKSB7CmRpZmYg
LS1naXQgYS90ZXN0cy9wZXJmX3BtdS5jIGIvdGVzdHMvcGVyZl9wbXUuYwppbmRleCBlMmJkMmNj
NTUuLjU0ODQyNzg0YyAxMDA2NDQKLS0tIGEvdGVzdHMvcGVyZl9wbXUuYworKysgYi90ZXN0cy9w
ZXJmX3BtdS5jCkBAIC04OTMsNiArODkzLDE5IEBAIHN0YXRpYyBpbnQgd2FpdF92YmxhbmsoaW50
IGZkLCB1bmlvbiBkcm1fd2FpdF92YmxhbmsgKnZibCkKIAlyZXR1cm4gZXJyOwogfQogCitzdGF0
aWMgaW50IGhhc19zZWN1cmVfYmF0Y2hlcyhjb25zdCBpbnQgZmQpCit7CisJaW50IHYgPSAtMTsK
Kwlkcm1faTkxNV9nZXRwYXJhbV90IGdwID0geworCQkucGFyYW0gPSBJOTE1X1BBUkFNX0hBU19T
RUNVUkVfQkFUQ0hFUywKKwkJLnZhbHVlID0gJnYsCisJfTsKKworCWRybUlvY3RsKGZkLCBEUk1f
SU9DVExfSTkxNV9HRVRQQVJBTSwgJmdwKTsKKworCXJldHVybiB2ID4gMDsKK30KKwogc3RhdGlj
IHZvaWQKIGV2ZW50X3dhaXQoaW50IGdlbV9mZCwgY29uc3Qgc3RydWN0IGludGVsX2V4ZWN1dGlv
bl9lbmdpbmUyICplKQogewpAQCAtOTEwLDYgKzkyMyw3IEBAIGV2ZW50X3dhaXQoaW50IGdlbV9m
ZCwgY29uc3Qgc3RydWN0IGludGVsX2V4ZWN1dGlvbl9lbmdpbmUyICplKQogCiAJZGV2aWQgPSBp
bnRlbF9nZXRfZHJtX2RldmlkKGdlbV9mZCk7CiAJaWd0X3JlcXVpcmUoaW50ZWxfZ2VuKGRldmlk
KSA+PSA3KTsKKwlpZ3RfcmVxdWlyZShoYXNfc2VjdXJlX2JhdGNoZXMoZmQpKTsKIAlpZ3Rfc2tp
cF9vbihJU19WQUxMRVlWSUVXKGRldmlkKSB8fCBJU19DSEVSUllWSUVXKGRldmlkKSk7CiAKIAlr
bXN0ZXN0X3NldF92dF9ncmFwaGljc19tb2RlKCk7Ci0tIAoyLjI0LjAKCl9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QK
SW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9w
Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

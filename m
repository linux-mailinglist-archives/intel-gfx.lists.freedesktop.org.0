Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id A3E16E1CA1
	for <lists+intel-gfx@lfdr.de>; Wed, 23 Oct 2019 15:31:29 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F1A016EAC1;
	Wed, 23 Oct 2019 13:31:27 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1765C6EA19
 for <intel-gfx@lists.freedesktop.org>; Wed, 23 Oct 2019 13:31:17 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18937752-1500050 
 for <intel-gfx@lists.freedesktop.org>; Wed, 23 Oct 2019 14:31:15 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 23 Oct 2019 14:31:08 +0100
Message-Id: <20191023133108.21401-5-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0.rc0
In-Reply-To: <20191023133108.21401-1-chris@chris-wilson.co.uk>
References: <20191023133108.21401-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [CI 5/5] drm/i915/gt: Replace hangcheck by heartbeats
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UmVwbGFjZSBzYW1wbGluZyB0aGUgZW5naW5lIHN0YXRlIGV2ZXJ5IHNvIG9mdGVuIHdpdGggYSBw
ZXJpb2RpYwpoZWFydGJlYXQgcmVxdWVzdCB0byBtZWFzdXJlIHRoZSBoZWFsdGggb2YgYW4gZW5n
aW5lLiBUaGlzIGlzIGNvdXBsZWQKd2l0aCB0aGUgZm9yY2VkLXByZWVtcHRpb24gdG8gYWxsb3cg
bG9uZyBydW5uaW5nIHJlcXVlc3RzIHRvIHN1cnZpdmUgc28KbG9uZyBhcyB0aGV5IGRvIG5vdCBi
bG9jayBvdGhlciB1c2Vycy4KClNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hy
aXMtd2lsc29uLmNvLnVrPgpDYzogSm9vbmFzIExhaHRpbmVuIDxqb29uYXMubGFodGluZW5AbGlu
dXguaW50ZWwuY29tPgpDYzogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNv
bT4KQ2M6IEpvbiBCbG9vbWZpZWxkIDxqb24uYmxvb21maWVsZEBpbnRlbC5jb20+ClJldmlld2Vk
LWJ5OiBKb24gQmxvb21maWVsZCA8am9uLmJsb29tZmllbGRAaW50ZWwuY29tPgpSZXZpZXdlZC1i
eTogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KLS0tCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9LY29uZmlnLnByb2ZpbGUgICAgICAgICAgfCAgMTEgKwogZHJpdmVycy9n
cHUvZHJtL2k5MTUvTWFrZWZpbGUgICAgICAgICAgICAgICAgIHwgICAxIC0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jICB8ICAgMiArLQogZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oICAgIHwgICAxIC0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5jICAgICAgICB8ICAgMiAtCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9lbmdpbmUuaCAgICAgICAgfCAgMzIgLS0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jICAgICB8ICAxMiArLQogLi4uL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9lbmdpbmVfaGVhcnRiZWF0LmMgIHwgMTU3ICsrKysrKysrCiAuLi4vZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQuaCAgfCAgIDggKwogZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMgICAgIHwgICA1ICstCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaCAgfCAgMTcgKy0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2d0LmMgICAgICAgICAgICB8ICAgMSAtCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9ndC5oICAgICAgICAgICAgfCAgIDQgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZ3RfcG0uYyAgICAgICAgIHwgICAxIC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2d0X3R5cGVzLmggICAgICB8ICAgOSAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9oYW5nY2hlY2suYyAgICAgfCAzNjEgLS0tLS0tLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jICAgICAgICAgfCAgIDMgKy0KIC4uLi9kcm0vaTkx
NS9ndC9zZWxmdGVzdF9lbmdpbmVfaGVhcnRiZWF0LmMgICB8IDE3MSArKysrKysrKysKIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jICB8ICAgNCAtCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYyAgICAgICAgICAgfCAgODcgLS0tLS0KIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgICAgICAgICAgICAgICB8ICAgMyAtCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oICAgICAgICAgICAgICAgfCAgIDEgLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuYyAgICAgICAgIHwgIDMzICstCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5oICAgICAgICAgfCAgIDIgLQogZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9wcmlvbGlzdF90eXBlcy5oICAgIHwgICA2ICsKIDI1IGZpbGVzIGNoYW5n
ZWQsIDM3OSBpbnNlcnRpb25zKCspLCA1NTUgZGVsZXRpb25zKC0pCiBkZWxldGUgbW9kZSAxMDA2
NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfaGFuZ2NoZWNrLmMKCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9LY29uZmlnLnByb2ZpbGUgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9LY29uZmlnLnByb2ZpbGUKaW5kZXggYjA3MWI2MDI0MTUyLi44YWI3YWY1ZWIzMTEgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L0tjb25maWcucHJvZmlsZQorKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9LY29uZmlnLnByb2ZpbGUKQEAgLTEyLDYgKzEyLDE3IEBAIGNvbmZp
ZyBEUk1fSTkxNV9VU0VSRkFVTFRfQVVUT1NVU1BFTkQKIAkgIE1heSBiZSAwIHRvIGRpc2FibGUg
dGhlIGV4dHJhIGRlbGF5IGFuZCBzb2xlbHkgdXNlIHRoZSBkZXZpY2UgbGV2ZWwKIAkgIHJ1bnRp
bWUgcG0gYXV0b3N1c3BlbmQgZGVsYXkgdHVuYWJsZS4KIAorY29uZmlnIERSTV9JOTE1X0hFQVJU
QkVBVF9JTlRFUlZBTAorCWludCAiSW50ZXJ2YWwgYmV0d2VlbiBoZWFydGJlYXQgcHVsc2VzICht
cykiCisJZGVmYXVsdCAyNTAwICMgbWlsbGlzZWNvbmRzCisJaGVscAorCSAgVGhlIGRyaXZlciBz
ZW5kcyBhIHBlcmlvZGljIGhlYXJ0YmVhdCBkb3duIGFsbCBhY3RpdmUgZW5naW5lcyB0bworCSAg
Y2hlY2sgdGhlIGhlYWx0aCBvZiB0aGUgR1BVIGFuZCB1bmRlcnRha2UgcmVndWxhciBob3VzZS1r
ZWVwaW5nIG9mCisJICBpbnRlcm5hbCBkcml2ZXIgc3RhdGUuCisKKwkgIE1heSBiZSAwIHRvIGRp
c2FibGUgaGVhcnRiZWF0cyBhbmQgdGhlcmVmb3JlIGRpc2FibGUgYXV0b21hdGljIEdQVQorCSAg
aGFuZyBkZXRlY3Rpb24uCisKIGNvbmZpZyBEUk1fSTkxNV9QUkVFTVBUX1RJTUVPVVQKIAlpbnQg
IlByZWVtcHQgdGltZW91dCAobXMsIGppZmZ5IGdyYW51bGFyaXR5KSIKIAlkZWZhdWx0IDEwMCAj
IG1pbGxpc2Vjb25kcwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQppbmRleCAyZmQ0YmVkMTg4ZTUuLjIxNjAx
YmIyN2IyMiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUKQEAgLTg3LDcgKzg3LDYgQEAgZ3QteSArPSBc
CiAJZ3QvaW50ZWxfZ3RfcG0ubyBcCiAJZ3QvaW50ZWxfZ3RfcG1faXJxLm8gXAogCWd0L2ludGVs
X2d0X3JlcXVlc3RzLm8gXAotCWd0L2ludGVsX2hhbmdjaGVjay5vIFwKIAlndC9pbnRlbF9sbGMu
byBcCiAJZ3QvaW50ZWxfbHJjLm8gXAogCWd0L2ludGVsX3JjNi5vIFwKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKaW5kZXggMjM2ZmRmMTIyZTQ3Li41Nzk2
NTU2NzViMDggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZGlzcGxheS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxh
eS5jCkBAIC0xNDg2Myw3ICsxNDg2Myw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3BsYW5lX3VucGlu
X2ZiKHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqb2xkX3BsYW5lX3N0YXRlKQogc3RhdGljIHZv
aWQgZmJfb2JqX2J1bXBfcmVuZGVyX3ByaW9yaXR5KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0
ICpvYmopCiB7CiAJc3RydWN0IGk5MTVfc2NoZWRfYXR0ciBhdHRyID0gewotCQkucHJpb3JpdHkg
PSBJOTE1X1BSSU9SSVRZX0RJU1BMQVksCisJCS5wcmlvcml0eSA9IEk5MTVfVVNFUl9QUklPUklU
WShJOTE1X1BSSU9SSVRZX0RJU1BMQVkpLAogCX07CiAKIAlpOTE1X2dlbV9vYmplY3Rfd2FpdF9w
cmlvcml0eShvYmosIDAsICZhdHRyKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9vYmplY3QuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9vYmplY3QuaAppbmRleCBhZWFkN2U2NzI1ZjkuLjQ1OGNkNTEzMzFmMSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaApAQCAtNDYyLDYgKzQ2Miw1IEBAIGlu
dCBpOTE1X2dlbV9vYmplY3Rfd2FpdChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAog
aW50IGk5MTVfZ2VtX29iamVjdF93YWl0X3ByaW9yaXR5KHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICpvYmosCiAJCQkJICB1bnNpZ25lZCBpbnQgZmxhZ3MsCiAJCQkJICBjb25zdCBzdHJ1Y3Qg
aTkxNV9zY2hlZF9hdHRyICphdHRyKTsKLSNkZWZpbmUgSTkxNV9QUklPUklUWV9ESVNQTEFZIEk5
MTVfVVNFUl9QUklPUklUWShJOTE1X1BSSU9SSVRZX01BWCkKIAogI2VuZGlmCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5jCmluZGV4IDliYzBjZjMxMzllMy4uYzk5YmI5NGZlNDFl
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYwpAQCAtNzYsOCArNzYsNiBA
QCB2b2lkIGk5MTVfZ2VtX3N1c3BlbmQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJ
aW50ZWxfZ3Rfc3VzcGVuZCgmaTkxNS0+Z3QpOwogCWludGVsX3VjX3N1c3BlbmQoJmk5MTUtPmd0
LnVjKTsKIAotCWNhbmNlbF9kZWxheWVkX3dvcmtfc3luYygmaTkxNS0+Z3QuaGFuZ2NoZWNrLndv
cmspOwotCiAJaTkxNV9nZW1fZHJhaW5fZnJlZWRfb2JqZWN0cyhpOTE1KTsKIH0KIApkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lLmggYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaAppbmRleCA5NDA5Yjc4NTYyOTkuLmVlNDc0NDRh
NmFkNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lLmgK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lLmgKQEAgLTkxLDM4ICs5
MSw2IEBAIHN0cnVjdCBpbnRlbF9ndDsKIC8qIHNlcW5vIHNpemUgaXMgYWN0dWFsbHkgb25seSBh
IHVpbnQzMiwgYnV0IHNpbmNlIHdlIHBsYW4gdG8gdXNlIE1JX0ZMVVNIX0RXIHRvCiAgKiBkbyB0
aGUgd3JpdGVzLCBhbmQgdGhhdCBtdXN0IGhhdmUgcXcgYWxpZ25lZCBvZmZzZXRzLCBzaW1wbHkg
cHJldGVuZCBpdCdzIDhiLgogICovCi1lbnVtIGludGVsX2VuZ2luZV9oYW5nY2hlY2tfYWN0aW9u
IHsKLQlFTkdJTkVfSURMRSA9IDAsCi0JRU5HSU5FX1dBSVQsCi0JRU5HSU5FX0FDVElWRV9TRVFO
TywKLQlFTkdJTkVfQUNUSVZFX0hFQUQsCi0JRU5HSU5FX0FDVElWRV9TVUJVTklUUywKLQlFTkdJ
TkVfV0FJVF9LSUNLLAotCUVOR0lORV9ERUFELAotfTsKLQotc3RhdGljIGlubGluZSBjb25zdCBj
aGFyICoKLWhhbmdjaGVja19hY3Rpb25fdG9fc3RyKGNvbnN0IGVudW0gaW50ZWxfZW5naW5lX2hh
bmdjaGVja19hY3Rpb24gYSkKLXsKLQlzd2l0Y2ggKGEpIHsKLQljYXNlIEVOR0lORV9JRExFOgot
CQlyZXR1cm4gImlkbGUiOwotCWNhc2UgRU5HSU5FX1dBSVQ6Ci0JCXJldHVybiAid2FpdCI7Ci0J
Y2FzZSBFTkdJTkVfQUNUSVZFX1NFUU5POgotCQlyZXR1cm4gImFjdGl2ZSBzZXFubyI7Ci0JY2Fz
ZSBFTkdJTkVfQUNUSVZFX0hFQUQ6Ci0JCXJldHVybiAiYWN0aXZlIGhlYWQiOwotCWNhc2UgRU5H
SU5FX0FDVElWRV9TVUJVTklUUzoKLQkJcmV0dXJuICJhY3RpdmUgc3VidW5pdHMiOwotCWNhc2Ug
RU5HSU5FX1dBSVRfS0lDSzoKLQkJcmV0dXJuICJ3YWl0IGtpY2siOwotCWNhc2UgRU5HSU5FX0RF
QUQ6Ci0JCXJldHVybiAiZGVhZCI7Ci0JfQotCi0JcmV0dXJuICJ1bmtub3duIjsKLX0KIAogc3Rh
dGljIGlubGluZSB1bnNpZ25lZCBpbnQKIGV4ZWNsaXN0c19udW1fcG9ydHMoY29uc3Qgc3RydWN0
IGludGVsX2VuZ2luZV9leGVjbGlzdHMgKiBjb25zdCBleGVjbGlzdHMpCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jCmluZGV4IGI5MWVhMDdmNDgxOS4uOGI1MTI5ZTBi
NDlkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3Mu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYwpAQCAtMzA4
LDYgKzMwOCw4IEBAIHN0YXRpYyBpbnQgaW50ZWxfZW5naW5lX3NldHVwKHN0cnVjdCBpbnRlbF9n
dCAqZ3QsIGVudW0gaW50ZWxfZW5naW5lX2lkIGlkKQogCWVuZ2luZS0+aW5zdGFuY2UgPSBpbmZv
LT5pbnN0YW5jZTsKIAlfX3NwcmludF9lbmdpbmVfbmFtZShlbmdpbmUpOwogCisJZW5naW5lLT5w
cm9wcy5oZWFydGJlYXRfaW50ZXJ2YWxfbXMgPQorCQlDT05GSUdfRFJNX0k5MTVfSEVBUlRCRUFU
X0lOVEVSVkFMOwogCWVuZ2luZS0+cHJvcHMucHJlZW1wdF90aW1lb3V0X21zID0KIAkJQ09ORklH
X0RSTV9JOTE1X1BSRUVNUFRfVElNRU9VVDsKIAllbmdpbmUtPnByb3BzLnN0b3BfdGltZW91dF9t
cyA9CkBAIC02MDksNyArNjExLDYgQEAgc3RhdGljIGludCBpbnRlbF9lbmdpbmVfc2V0dXBfY29t
bW9uKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAlpbnRlbF9lbmdpbmVfaW5pdF9h
Y3RpdmUoZW5naW5lLCBFTkdJTkVfUEhZU0lDQUwpOwogCWludGVsX2VuZ2luZV9pbml0X2JyZWFk
Y3J1bWJzKGVuZ2luZSk7CiAJaW50ZWxfZW5naW5lX2luaXRfZXhlY2xpc3RzKGVuZ2luZSk7Ci0J
aW50ZWxfZW5naW5lX2luaXRfaGFuZ2NoZWNrKGVuZ2luZSk7CiAJaW50ZWxfZW5naW5lX2luaXRf
Y21kX3BhcnNlcihlbmdpbmUpOwogCWludGVsX2VuZ2luZV9pbml0X19wbShlbmdpbmUpOwogCkBA
IC0xNDcwLDggKzE0NzEsMTMgQEAgdm9pZCBpbnRlbF9lbmdpbmVfZHVtcChzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUsCiAJCWRybV9wcmludGYobSwgIioqKiBXRURHRUQgKioqXG4iKTsK
IAogCWRybV9wcmludGYobSwgIlx0QXdha2U/ICVkXG4iLCBhdG9taWNfcmVhZCgmZW5naW5lLT53
YWtlcmVmLmNvdW50KSk7Ci0JZHJtX3ByaW50ZihtLCAiXHRIYW5nY2hlY2s6ICVkIG1zIGFnb1xu
IiwKLQkJICAgamlmZmllc190b19tc2VjcyhqaWZmaWVzIC0gZW5naW5lLT5oYW5nY2hlY2suYWN0
aW9uX3RpbWVzdGFtcCkpOworCisJcmN1X3JlYWRfbG9jaygpOworCXJxID0gUkVBRF9PTkNFKGVu
Z2luZS0+aGVhcnRiZWF0LnN5c3RvbGUpOworCWlmIChycSkKKwkJZHJtX3ByaW50ZihtLCAiXHRI
ZWFydGJlYXQ6ICVkIG1zIGFnb1xuIiwKKwkJCSAgIGppZmZpZXNfdG9fbXNlY3MoamlmZmllcyAt
IHJxLT5lbWl0dGVkX2ppZmZpZXMpKTsKKwlyY3VfcmVhZF91bmxvY2soKTsKIAlkcm1fcHJpbnRm
KG0sICJcdFJlc2V0IGNvdW50OiAlZCAoZ2xvYmFsICVkKVxuIiwKIAkJICAgaTkxNV9yZXNldF9l
bmdpbmVfY291bnQoZXJyb3IsIGVuZ2luZSksCiAJCSAgIGk5MTVfcmVzZXRfY291bnQoZXJyb3Ip
KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9oZWFy
dGJlYXQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQu
YwppbmRleCA0YjlhYjc4MTNkNTQuLjk5NzdmNTlmNmI1MyAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2hlYXJ0YmVhdC5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQuYwpAQCAtMTEsNiArMTEsMzAgQEAK
ICNpbmNsdWRlICJpbnRlbF9lbmdpbmVfcG0uaCIKICNpbmNsdWRlICJpbnRlbF9lbmdpbmUuaCIK
ICNpbmNsdWRlICJpbnRlbF9ndC5oIgorI2luY2x1ZGUgImludGVsX3Jlc2V0LmgiCisKKy8qCisg
KiBXaGlsZSB0aGUgZW5naW5lIGlzIGFjdGl2ZSwgd2Ugc2VuZCBhIHBlcmlvZGljIHB1bHNlIGFs
b25nIHRoZSBlbmdpbmUKKyAqIHRvIGNoZWNrIG9uIGl0cyBoZWFsdGggYW5kIHRvIGZsdXNoIGFu
eSBpZGxlLWJhcnJpZXJzLiBJZiB0aGF0IHJlcXVlc3QKKyAqIGlzIHN0dWNrLCBhbmQgd2UgZmFp
bCB0byBwcmVlbXB0IGl0LCB3ZSBkZWNsYXJlIHRoZSBlbmdpbmUgaHVuZyBhbmQKKyAqIGlzc3Vl
IGEgcmVzZXQgLS0gaW4gdGhlIGhvcGUgdGhhdCByZXN0b3JlcyBwcm9ncmVzcy4KKyAqLworCitz
dGF0aWMgYm9vbCBuZXh0X2hlYXJ0YmVhdChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUp
Cit7CisJbG9uZyBkZWxheTsKKworCWRlbGF5ID0gUkVBRF9PTkNFKGVuZ2luZS0+cHJvcHMuaGVh
cnRiZWF0X2ludGVydmFsX21zKTsKKwlpZiAoIWRlbGF5KQorCQlyZXR1cm4gZmFsc2U7CisKKwlk
ZWxheSA9IG1zZWNzX3RvX2ppZmZpZXNfdGltZW91dChkZWxheSk7CisJaWYgKGRlbGF5ID49IEha
KQorCQlkZWxheSA9IHJvdW5kX2ppZmZpZXNfdXBfcmVsYXRpdmUoZGVsYXkpOworCXNjaGVkdWxl
X2RlbGF5ZWRfd29yaygmZW5naW5lLT5oZWFydGJlYXQud29yaywgZGVsYXkpOworCisJcmV0dXJu
IHRydWU7Cit9CiAKIHN0YXRpYyB2b2lkIGlkbGVfcHVsc2Uoc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lLCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIHsKQEAgLTE4LDYgKzQyLDEzOSBA
QCBzdGF0aWMgdm9pZCBpZGxlX3B1bHNlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwg
c3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJaTkxNV9yZXF1ZXN0X2FkZF9hY3RpdmVfYmFycmll
cnMocnEpOwogfQogCitzdGF0aWMgdm9pZCBzaG93X2hlYXJ0YmVhdChjb25zdCBzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpycSwKKwkJCSAgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sK
KwlzdHJ1Y3QgZHJtX3ByaW50ZXIgcCA9IGRybV9kZWJ1Z19wcmludGVyKCJoZWFydGJlYXQiKTsK
KworCWludGVsX2VuZ2luZV9kdW1wKGVuZ2luZSwgJnAsCisJCQkgICIlcyBoZWFydGJlYXQge3By
aW86JWR9IG5vdCB0aWNraW5nXG4iLAorCQkJICBlbmdpbmUtPm5hbWUsCisJCQkgIHJxLT5zY2hl
ZC5hdHRyLnByaW9yaXR5KTsKK30KKworc3RhdGljIHZvaWQgaGVhcnRiZWF0KHN0cnVjdCB3b3Jr
X3N0cnVjdCAqd3JrKQoreworCXN0cnVjdCBpOTE1X3NjaGVkX2F0dHIgYXR0ciA9IHsKKwkJLnBy
aW9yaXR5ID0gSTkxNV9VU0VSX1BSSU9SSVRZKEk5MTVfUFJJT1JJVFlfTUlOKSwKKwl9OworCXN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSA9CisJCWNvbnRhaW5lcl9vZih3cmssIHR5cGVv
ZigqZW5naW5lKSwgaGVhcnRiZWF0Lndvcmsud29yayk7CisJc3RydWN0IGludGVsX2NvbnRleHQg
KmNlID0gZW5naW5lLT5rZXJuZWxfY29udGV4dDsKKwlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsK
KworCWlmICghaW50ZWxfZW5naW5lX3BtX2dldF9pZl9hd2FrZShlbmdpbmUpKQorCQlyZXR1cm47
CisKKwlycSA9IGVuZ2luZS0+aGVhcnRiZWF0LnN5c3RvbGU7CisJaWYgKHJxICYmIGk5MTVfcmVx
dWVzdF9jb21wbGV0ZWQocnEpKSB7CisJCWk5MTVfcmVxdWVzdF9wdXQocnEpOworCQllbmdpbmUt
PmhlYXJ0YmVhdC5zeXN0b2xlID0gTlVMTDsKKwl9CisKKwlpZiAoaW50ZWxfZ3RfaXNfd2VkZ2Vk
KGVuZ2luZS0+Z3QpKQorCQlnb3RvIG91dDsKKworCWlmIChlbmdpbmUtPmhlYXJ0YmVhdC5zeXN0
b2xlKSB7CisJCWlmIChlbmdpbmUtPnNjaGVkdWxlICYmCisJCSAgICBycS0+c2NoZWQuYXR0ci5w
cmlvcml0eSA8IEk5MTVfUFJJT1JJVFlfQkFSUklFUikgeworCQkJLyoKKwkJCSAqIEdyYWR1YWxs
eSByYWlzZSB0aGUgcHJpb3JpdHkgb2YgdGhlIGhlYXJ0YmVhdCB0bworCQkJICogZ2l2ZSBoaWdo
IHByaW9yaXR5IHdvcmsgW3doaWNoIHByZXN1bWFibHkgZGVzaXJlcworCQkJICogbG93IGxhdGVu
Y3kgYW5kIG5vIGppdHRlcl0gdGhlIGNoYW5jZSB0byBuYXR1cmFsbHkKKwkJCSAqIGNvbXBsZXRl
IGJlZm9yZSBiZWluZyBwcmVlbXB0ZWQuCisJCQkgKi8KKwkJCWF0dHIucHJpb3JpdHkgPSBJOTE1
X1BSSU9SSVRZX01BU0s7CisJCQlpZiAocnEtPnNjaGVkLmF0dHIucHJpb3JpdHkgPj0gYXR0ci5w
cmlvcml0eSkKKwkJCQlhdHRyLnByaW9yaXR5IHw9IEk5MTVfVVNFUl9QUklPUklUWShJOTE1X1BS
SU9SSVRZX0hFQVJUQkVBVCk7CisJCQlpZiAocnEtPnNjaGVkLmF0dHIucHJpb3JpdHkgPj0gYXR0
ci5wcmlvcml0eSkKKwkJCQlhdHRyLnByaW9yaXR5ID0gSTkxNV9QUklPUklUWV9CQVJSSUVSOwor
CisJCQlsb2NhbF9iaF9kaXNhYmxlKCk7CisJCQllbmdpbmUtPnNjaGVkdWxlKHJxLCAmYXR0cik7
CisJCQlsb2NhbF9iaF9lbmFibGUoKTsKKwkJfSBlbHNlIHsKKwkJCWlmIChJU19FTkFCTEVEKENP
TkZJR19EUk1fSTkxNV9ERUJVR19HRU0pKQorCQkJCXNob3dfaGVhcnRiZWF0KHJxLCBlbmdpbmUp
OworCisJCQlpbnRlbF9ndF9oYW5kbGVfZXJyb3IoZW5naW5lLT5ndCwgZW5naW5lLT5tYXNrLAor
CQkJCQkgICAgICBJOTE1X0VSUk9SX0NBUFRVUkUsCisJCQkJCSAgICAgICJzdG9wcGVkIGhlYXJ0
YmVhdCBvbiAlcyIsCisJCQkJCSAgICAgIGVuZ2luZS0+bmFtZSk7CisJCX0KKwkJZ290byBvdXQ7
CisJfQorCisJaWYgKGVuZ2luZS0+d2FrZXJlZl9zZXJpYWwgPT0gZW5naW5lLT5zZXJpYWwpCisJ
CWdvdG8gb3V0OworCisJbXV0ZXhfbG9jaygmY2UtPnRpbWVsaW5lLT5tdXRleCk7CisKKwlpbnRl
bF9jb250ZXh0X2VudGVyKGNlKTsKKwlycSA9IF9faTkxNV9yZXF1ZXN0X2NyZWF0ZShjZSwgR0ZQ
X05PV0FJVCB8IF9fR0ZQX05PV0FSTik7CisJaW50ZWxfY29udGV4dF9leGl0KGNlKTsKKwlpZiAo
SVNfRVJSKHJxKSkKKwkJZ290byB1bmxvY2s7CisKKwlpZGxlX3B1bHNlKGVuZ2luZSwgcnEpOwor
CWlmIChpOTE1X21vZHBhcmFtcy5lbmFibGVfaGFuZ2NoZWNrKQorCQllbmdpbmUtPmhlYXJ0YmVh
dC5zeXN0b2xlID0gaTkxNV9yZXF1ZXN0X2dldChycSk7CisKKwlfX2k5MTVfcmVxdWVzdF9jb21t
aXQocnEpOworCV9faTkxNV9yZXF1ZXN0X3F1ZXVlKHJxLCAmYXR0cik7CisKK3VubG9jazoKKwlt
dXRleF91bmxvY2soJmNlLT50aW1lbGluZS0+bXV0ZXgpOworb3V0OgorCWlmICghbmV4dF9oZWFy
dGJlYXQoZW5naW5lKSkKKwkJaTkxNV9yZXF1ZXN0X3B1dChmZXRjaF9hbmRfemVybygmZW5naW5l
LT5oZWFydGJlYXQuc3lzdG9sZSkpOworCWludGVsX2VuZ2luZV9wbV9wdXQoZW5naW5lKTsKK30K
Kwordm9pZCBpbnRlbF9lbmdpbmVfdW5wYXJrX2hlYXJ0YmVhdChzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUpCit7CisJaWYgKCFDT05GSUdfRFJNX0k5MTVfSEVBUlRCRUFUX0lOVEVSVkFM
KQorCQlyZXR1cm47CisKKwluZXh0X2hlYXJ0YmVhdChlbmdpbmUpOworfQorCit2b2lkIGludGVs
X2VuZ2luZV9wYXJrX2hlYXJ0YmVhdChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7
CisJY2FuY2VsX2RlbGF5ZWRfd29yaygmZW5naW5lLT5oZWFydGJlYXQud29yayk7CisJaTkxNV9y
ZXF1ZXN0X3B1dChmZXRjaF9hbmRfemVybygmZW5naW5lLT5oZWFydGJlYXQuc3lzdG9sZSkpOwor
fQorCit2b2lkIGludGVsX2VuZ2luZV9pbml0X2hlYXJ0YmVhdChzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUpCit7CisJSU5JVF9ERUxBWUVEX1dPUksoJmVuZ2luZS0+aGVhcnRiZWF0Lndv
cmssIGhlYXJ0YmVhdCk7Cit9CisKK2ludCBpbnRlbF9lbmdpbmVfc2V0X2hlYXJ0YmVhdChzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCisJCQkgICAgICAgdW5zaWduZWQgbG9uZyBkZWxh
eSkKK3sKKwlpbnQgZXJyOworCisJLyogU2VuZCBvbmUgbGFzdCBwdWxzZSBiZWZvcmUgdG8gY2xl
YW51cCBwZXJzaXN0ZW50IGhvZ3MgKi8KKwlpZiAoIWRlbGF5ICYmIENPTkZJR19EUk1fSTkxNV9Q
UkVFTVBUX1RJTUVPVVQpIHsKKwkJZXJyID0gaW50ZWxfZW5naW5lX3B1bHNlKGVuZ2luZSk7CisJ
CWlmIChlcnIpCisJCQlyZXR1cm4gZXJyOworCX0KKworCVdSSVRFX09OQ0UoZW5naW5lLT5wcm9w
cy5oZWFydGJlYXRfaW50ZXJ2YWxfbXMsIGRlbGF5KTsKKworCWlmIChpbnRlbF9lbmdpbmVfcG1f
Z2V0X2lmX2F3YWtlKGVuZ2luZSkpIHsKKwkJaWYgKGRlbGF5KQorCQkJaW50ZWxfZW5naW5lX3Vu
cGFya19oZWFydGJlYXQoZW5naW5lKTsKKwkJZWxzZQorCQkJaW50ZWxfZW5naW5lX3BhcmtfaGVh
cnRiZWF0KGVuZ2luZSk7CisJCWludGVsX2VuZ2luZV9wbV9wdXQoZW5naW5lKTsKKwl9CisKKwly
ZXR1cm4gMDsKK30KKwogaW50IGludGVsX2VuZ2luZV9wdWxzZShzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUpCiB7CiAJc3RydWN0IGk5MTVfc2NoZWRfYXR0ciBhdHRyID0geyAucHJpb3Jp
dHkgPSBJOTE1X1BSSU9SSVRZX0JBUlJJRVIgfTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQuaAppbmRleCBiMzM0ZTVhYWY3OGQuLmE3YjhjMGY5
ZTAwNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2hl
YXJ0YmVhdC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9oZWFy
dGJlYXQuaApAQCAtOSw2ICs5LDE0IEBACiAKIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3M7CiAKK3Zv
aWQgaW50ZWxfZW5naW5lX2luaXRfaGVhcnRiZWF0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSk7CisKK2ludCBpbnRlbF9lbmdpbmVfc2V0X2hlYXJ0YmVhdChzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmUsCisJCQkgICAgICAgdW5zaWduZWQgbG9uZyBkZWxheSk7CisKK3ZvaWQg
aW50ZWxfZW5naW5lX3BhcmtfaGVhcnRiZWF0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSk7Cit2b2lkIGludGVsX2VuZ2luZV91bnBhcmtfaGVhcnRiZWF0KHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSk7CisKIGludCBpbnRlbF9lbmdpbmVfcHVsc2Uoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKTsKIGludCBpbnRlbF9lbmdpbmVfZmx1c2hfYmFycmllcnMoc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9lbmdpbmVfcG0uYwppbmRleCA3ZDc2NjExZDlkZjEuLjZmYmZhMjE2MmU1NCAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMKQEAgLTcsNiArNyw3IEBACiAjaW5j
bHVkZSAiaTkxNV9kcnYuaCIKIAogI2luY2x1ZGUgImludGVsX2VuZ2luZS5oIgorI2luY2x1ZGUg
ImludGVsX2VuZ2luZV9oZWFydGJlYXQuaCIKICNpbmNsdWRlICJpbnRlbF9lbmdpbmVfcG0uaCIK
ICNpbmNsdWRlICJpbnRlbF9lbmdpbmVfcG9vbC5oIgogI2luY2x1ZGUgImludGVsX2d0LmgiCkBA
IC0zNCw3ICszNSw3IEBAIHN0YXRpYyBpbnQgX19lbmdpbmVfdW5wYXJrKHN0cnVjdCBpbnRlbF93
YWtlcmVmICp3ZikKIAlpZiAoZW5naW5lLT51bnBhcmspCiAJCWVuZ2luZS0+dW5wYXJrKGVuZ2lu
ZSk7CiAKLQlpbnRlbF9lbmdpbmVfaW5pdF9oYW5nY2hlY2soZW5naW5lKTsKKwlpbnRlbF9lbmdp
bmVfdW5wYXJrX2hlYXJ0YmVhdChlbmdpbmUpOwogCXJldHVybiAwOwogfQogCkBAIC0xNTgsNiAr
MTU5LDcgQEAgc3RhdGljIGludCBfX2VuZ2luZV9wYXJrKHN0cnVjdCBpbnRlbF93YWtlcmVmICp3
ZikKIAogCWNhbGxfaWRsZV9iYXJyaWVycyhlbmdpbmUpOyAvKiBjbGVhbnVwIGFmdGVyIHdlZGdp
bmcgKi8KIAorCWludGVsX2VuZ2luZV9wYXJrX2hlYXJ0YmVhdChlbmdpbmUpOwogCWludGVsX2Vu
Z2luZV9kaXNhcm1fYnJlYWRjcnVtYnMoZW5naW5lKTsKIAlpbnRlbF9lbmdpbmVfcG9vbF9wYXJr
KCZlbmdpbmUtPnBvb2wpOwogCkBAIC0xODgsNiArMTkwLDcgQEAgdm9pZCBpbnRlbF9lbmdpbmVf
aW5pdF9fcG0oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCXN0cnVjdCBpbnRlbF9y
dW50aW1lX3BtICpycG0gPSBlbmdpbmUtPnVuY29yZS0+cnBtOwogCiAJaW50ZWxfd2FrZXJlZl9p
bml0KCZlbmdpbmUtPndha2VyZWYsIHJwbSwgJndmX29wcyk7CisJaW50ZWxfZW5naW5lX2luaXRf
aGVhcnRiZWF0KGVuZ2luZSk7CiB9CiAKICNpZiBJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9T
RUxGVEVTVCkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2lu
ZV90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmgK
aW5kZXggMTI1MWRhYzkxZjMxLi4yNjk5ODkwMWZlZmYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oCkBAIC0xNSw2ICsxNSw3IEBACiAjaW5jbHVkZSA8
bGludXgvcmJ0cmVlLmg+CiAjaW5jbHVkZSA8bGludXgvdGltZXIuaD4KICNpbmNsdWRlIDxsaW51
eC90eXBlcy5oPgorI2luY2x1ZGUgPGxpbnV4L3dvcmtxdWV1ZS5oPgogCiAjaW5jbHVkZSAiaTkx
NV9nZW0uaCIKICNpbmNsdWRlICJpOTE1X3BtdS5oIgpAQCAtNzYsMTQgKzc3LDYgQEAgc3RydWN0
IGludGVsX2luc3Rkb25lIHsKIAl1MzIgcm93W0k5MTVfTUFYX1NMSUNFU11bSTkxNV9NQVhfU1VC
U0xJQ0VTXTsKIH07CiAKLXN0cnVjdCBpbnRlbF9lbmdpbmVfaGFuZ2NoZWNrIHsKLQl1NjQgYWN0
aGQ7Ci0JdTMyIGxhc3RfcmluZzsKLQl1MzIgbGFzdF9oZWFkOwotCXVuc2lnbmVkIGxvbmcgYWN0
aW9uX3RpbWVzdGFtcDsKLQlzdHJ1Y3QgaW50ZWxfaW5zdGRvbmUgaW5zdGRvbmU7Ci19OwotCiBz
dHJ1Y3QgaW50ZWxfcmluZyB7CiAJc3RydWN0IGtyZWYgcmVmOwogCXN0cnVjdCBpOTE1X3ZtYSAq
dm1hOwpAQCAtMzMxLDYgKzMyNCwxMSBAQCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzIHsKIAogCWlu
dGVsX2VuZ2luZV9tYXNrX3Qgc2F0dXJhdGVkOyAvKiBzdWJtaXR0aW5nIHNlbWFwaG9yZXMgdG9v
IGxhdGU/ICovCiAKKwlzdHJ1Y3QgeworCQlzdHJ1Y3QgZGVsYXllZF93b3JrIHdvcms7CisJCXN0
cnVjdCBpOTE1X3JlcXVlc3QgKnN5c3RvbGU7CisJfSBoZWFydGJlYXQ7CisKIAl1bnNpZ25lZCBs
b25nIHNlcmlhbDsKIAogCXVuc2lnbmVkIGxvbmcgd2FrZXJlZl9zZXJpYWw7CkBAIC00ODEsOCAr
NDc5LDYgQEAgc3RydWN0IGludGVsX2VuZ2luZV9jcyB7CiAJLyogc3RhdHVzX25vdGlmaWVyOiBs
aXN0IG9mIGNhbGxiYWNrcyBmb3IgY29udGV4dC1zd2l0Y2ggY2hhbmdlcyAqLwogCXN0cnVjdCBh
dG9taWNfbm90aWZpZXJfaGVhZCBjb250ZXh0X3N0YXR1c19ub3RpZmllcjsKIAotCXN0cnVjdCBp
bnRlbF9lbmdpbmVfaGFuZ2NoZWNrIGhhbmdjaGVjazsKLQogI2RlZmluZSBJOTE1X0VOR0lORV9O
RUVEU19DTURfUEFSU0VSIEJJVCgwKQogI2RlZmluZSBJOTE1X0VOR0lORV9TVVBQT1JUU19TVEFU
UyAgIEJJVCgxKQogI2RlZmluZSBJOTE1X0VOR0lORV9IQVNfUFJFRU1QVElPTiAgIEJJVCgyKQpA
QCAtNTQ5LDYgKzU0NSw3IEBAIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgewogCX0gc3RhdHM7CiAK
IAlzdHJ1Y3QgeworCQl1bnNpZ25lZCBsb25nIGhlYXJ0YmVhdF9pbnRlcnZhbF9tczsKIAkJdW5z
aWduZWQgbG9uZyBwcmVlbXB0X3RpbWVvdXRfbXM7CiAJCXVuc2lnbmVkIGxvbmcgc3RvcF90aW1l
b3V0X21zOwogCX0gcHJvcHM7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9ndC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuYwppbmRleCAxYzRi
NmM5NjQyYWQuLjM1MTI3Njk5NTkxZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZ3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5jCkBA
IC0yMiw3ICsyMiw2IEBAIHZvaWQgaW50ZWxfZ3RfaW5pdF9lYXJseShzdHJ1Y3QgaW50ZWxfZ3Qg
Kmd0LCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAlJTklUX0xJU1RfSEVBRCgmZ3Qt
PmNsb3NlZF92bWEpOwogCXNwaW5fbG9ja19pbml0KCZndC0+Y2xvc2VkX2xvY2spOwogCi0JaW50
ZWxfZ3RfaW5pdF9oYW5nY2hlY2soZ3QpOwogCWludGVsX2d0X2luaXRfcmVzZXQoZ3QpOwogCWlu
dGVsX2d0X2luaXRfcmVxdWVzdHMoZ3QpOwogCWludGVsX2d0X3BtX2luaXRfZWFybHkoZ3QpOwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuaCBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmgKaW5kZXggZTZhYjBiZmYwZWZiLi41YjZlZmZlZDM3
MTMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmgKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuaApAQCAtNDYsOCArNDYsNiBAQCB2b2lk
IGludGVsX2d0X2NsZWFyX2Vycm9yX3JlZ2lzdGVycyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAogdm9p
ZCBpbnRlbF9ndF9mbHVzaF9nZ3R0X3dyaXRlcyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIHZvaWQg
aW50ZWxfZ3RfY2hpcHNldF9mbHVzaChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIAotdm9pZCBpbnRl
bF9ndF9pbml0X2hhbmdjaGVjayhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKLQogc3RhdGljIGlubGlu
ZSB1MzIgaW50ZWxfZ3Rfc2NyYXRjaF9vZmZzZXQoY29uc3Qgc3RydWN0IGludGVsX2d0ICpndCwK
IAkJCQkJICBlbnVtIGludGVsX2d0X3NjcmF0Y2hfZmllbGQgZmllbGQpCiB7CkBAIC01OSw2ICs1
Nyw0IEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF9ndF9pc193ZWRnZWQoc3RydWN0IGludGVs
X2d0ICpndCkKIAlyZXR1cm4gX19pbnRlbF9yZXNldF9mYWlsZWQoJmd0LT5yZXNldCk7CiB9CiAK
LXZvaWQgaW50ZWxfZ3RfcXVldWVfaGFuZ2NoZWNrKHN0cnVjdCBpbnRlbF9ndCAqZ3QpOwotCiAj
ZW5kaWYgLyogX19JTlRFTF9HVF9IX18gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2d0X3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9w
bS5jCmluZGV4IDA2ZTczZDU2Y2ZjZi4uYWZmNGVkYTQ3ODE5IDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9wbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2d0X3BtLmMKQEAgLTQ3LDcgKzQ3LDYgQEAgc3RhdGljIGludCBfX2d0X3VucGFy
ayhzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2YpCiAKIAlpOTE1X3BtdV9ndF91bnBhcmtlZChpOTE1
KTsKIAotCWludGVsX2d0X3F1ZXVlX2hhbmdjaGVjayhndCk7CiAJaW50ZWxfZ3RfdW5wYXJrX3Jl
cXVlc3RzKGd0KTsKIAogCXJldHVybiAwOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZ3RfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0
X3R5cGVzLmgKaW5kZXggOTgwOTczZTY2ZTdmLi5mY2IzYTZjOTQyMWMgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfdHlwZXMuaApAQCAtMjcsMTQgKzI3LDYgQEAgc3RydWN0IGk5
MTVfZ2d0dDsKIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3M7CiBzdHJ1Y3QgaW50ZWxfdW5jb3JlOwog
Ci1zdHJ1Y3QgaW50ZWxfaGFuZ2NoZWNrIHsKLQkvKiBGb3IgaGFuZ2NoZWNrIHRpbWVyICovCi0j
ZGVmaW5lIERSTV9JOTE1X0hBTkdDSEVDS19QRVJJT0QgMTUwMCAvKiBpbiBtcyAqLwotI2RlZmlu
ZSBEUk1fSTkxNV9IQU5HQ0hFQ0tfSklGRklFUyBtc2Vjc190b19qaWZmaWVzKERSTV9JOTE1X0hB
TkdDSEVDS19QRVJJT0QpCi0KLQlzdHJ1Y3QgZGVsYXllZF93b3JrIHdvcms7Ci19OwotCiBzdHJ1
Y3QgaW50ZWxfZ3QgewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1OwogCXN0cnVjdCBp
bnRlbF91bmNvcmUgKnVuY29yZTsKQEAgLTY4LDcgKzYwLDYgQEAgc3RydWN0IGludGVsX2d0IHsK
IAlzdHJ1Y3QgbGlzdF9oZWFkIGNsb3NlZF92bWE7CiAJc3BpbmxvY2tfdCBjbG9zZWRfbG9jazsg
LyogZ3VhcmRzIHRoZSBsaXN0IG9mIGNsb3NlZF92bWEgKi8KIAotCXN0cnVjdCBpbnRlbF9oYW5n
Y2hlY2sgaGFuZ2NoZWNrOwogCXN0cnVjdCBpbnRlbF9yZXNldCByZXNldDsKIAogCS8qKgpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfaGFuZ2NoZWNrLmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5nY2hlY2suYwpkZWxldGVkIGZpbGUgbW9kZSAx
MDA2NDQKaW5kZXggMGZkZWYwMGFmOWU0Li4wMDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfaGFuZ2NoZWNrLmMKKysrIC9kZXYvbnVsbApAQCAtMSwzNjEgKzAs
MCBAQAotLyoKLSAqIENvcHlyaWdodCDCqSAyMDE2IEludGVsIENvcnBvcmF0aW9uCi0gKgotICog
UGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJz
b24gb2J0YWluaW5nIGEKLSAqIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBk
b2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksCi0gKiB0byBkZWFsIGluIHRoZSBT
b2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9u
Ci0gKiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlz
dHJpYnV0ZSwgc3VibGljZW5zZSwKLSAqIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdh
cmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZQotICogU29mdHdhcmUgaXMgZnVy
bmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKLSAq
Ci0gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGlj
ZSAoaW5jbHVkaW5nIHRoZSBuZXh0Ci0gKiBwYXJhZ3JhcGgpIHNoYWxsIGJlIGluY2x1ZGVkIGlu
IGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlCi0gKiBTb2Z0d2FyZS4K
LSAqCi0gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5U
WSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgotICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1Qg
TElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksCi0gKiBGSVRORVNT
IEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZF
TlQgU0hBTEwKLSAqIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBG
T1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSCi0gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4g
QU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORwotICogRlJP
TSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBP
UiBPVEhFUiBERUFMSU5HUwotICogSU4gVEhFIFNPRlRXQVJFLgotICoKLSAqLwotCi0jaW5jbHVk
ZSAiaTkxNV9kcnYuaCIKLSNpbmNsdWRlICJpbnRlbF9lbmdpbmUuaCIKLSNpbmNsdWRlICJpbnRl
bF9ndC5oIgotI2luY2x1ZGUgImludGVsX3Jlc2V0LmgiCi0KLXN0cnVjdCBoYW5nY2hlY2sgewot
CXU2NCBhY3RoZDsKLQl1MzIgcmluZzsKLQl1MzIgaGVhZDsKLQllbnVtIGludGVsX2VuZ2luZV9o
YW5nY2hlY2tfYWN0aW9uIGFjdGlvbjsKLQl1bnNpZ25lZCBsb25nIGFjdGlvbl90aW1lc3RhbXA7
Ci0JaW50IGRlYWRsb2NrOwotCXN0cnVjdCBpbnRlbF9pbnN0ZG9uZSBpbnN0ZG9uZTsKLQlib29s
IHdlZGdlZDoxOwotCWJvb2wgc3RhbGxlZDoxOwotfTsKLQotc3RhdGljIGJvb2wgaW5zdGRvbmVf
dW5jaGFuZ2VkKHUzMiBjdXJyZW50X2luc3Rkb25lLCB1MzIgKm9sZF9pbnN0ZG9uZSkKLXsKLQl1
MzIgdG1wID0gY3VycmVudF9pbnN0ZG9uZSB8ICpvbGRfaW5zdGRvbmU7Ci0JYm9vbCB1bmNoYW5n
ZWQ7Ci0KLQl1bmNoYW5nZWQgPSB0bXAgPT0gKm9sZF9pbnN0ZG9uZTsKLQkqb2xkX2luc3Rkb25l
IHw9IHRtcDsKLQotCXJldHVybiB1bmNoYW5nZWQ7Ci19Ci0KLXN0YXRpYyBib29sIHN1YnVuaXRz
X3N0dWNrKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKLXsKLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBlbmdpbmUtPmk5MTU7Ci0JY29uc3Qgc3RydWN0IHNzZXVf
ZGV2X2luZm8gKnNzZXUgPSAmUlVOVElNRV9JTkZPKGRldl9wcml2KS0+c3NldTsKLQlzdHJ1Y3Qg
aW50ZWxfaW5zdGRvbmUgaW5zdGRvbmU7Ci0Jc3RydWN0IGludGVsX2luc3Rkb25lICphY2N1X2lu
c3Rkb25lID0gJmVuZ2luZS0+aGFuZ2NoZWNrLmluc3Rkb25lOwotCWJvb2wgc3R1Y2s7Ci0JaW50
IHNsaWNlOwotCWludCBzdWJzbGljZTsKLQotCWludGVsX2VuZ2luZV9nZXRfaW5zdGRvbmUoZW5n
aW5lLCAmaW5zdGRvbmUpOwotCi0JLyogVGhlcmUgbWlnaHQgYmUgdW5zdGFibGUgc3VidW5pdCBz
dGF0ZXMgZXZlbiB3aGVuCi0JICogYWN0dWFsIGhlYWQgaXMgbm90IG1vdmluZy4gRmlsdGVyIG91
dCB0aGUgdW5zdGFibGUgb25lcyBieQotCSAqIGFjY3VtdWxhdGluZyB0aGUgdW5kb25lIC0+IGRv
bmUgdHJhbnNpdGlvbnMgYW5kIG9ubHkKLQkgKiBjb25zaWRlciB0aG9zZSBhcyBwcm9ncmVzcy4K
LQkgKi8KLQlzdHVjayA9IGluc3Rkb25lX3VuY2hhbmdlZChpbnN0ZG9uZS5pbnN0ZG9uZSwKLQkJ
CQkgICAmYWNjdV9pbnN0ZG9uZS0+aW5zdGRvbmUpOwotCXN0dWNrICY9IGluc3Rkb25lX3VuY2hh
bmdlZChpbnN0ZG9uZS5zbGljZV9jb21tb24sCi0JCQkJICAgICZhY2N1X2luc3Rkb25lLT5zbGlj
ZV9jb21tb24pOwotCi0JZm9yX2VhY2hfaW5zdGRvbmVfc2xpY2Vfc3Vic2xpY2UoZGV2X3ByaXYs
IHNzZXUsIHNsaWNlLCBzdWJzbGljZSkgewotCQlzdHVjayAmPSBpbnN0ZG9uZV91bmNoYW5nZWQo
aW5zdGRvbmUuc2FtcGxlcltzbGljZV1bc3Vic2xpY2VdLAotCQkJCQkgICAgJmFjY3VfaW5zdGRv
bmUtPnNhbXBsZXJbc2xpY2VdW3N1YnNsaWNlXSk7Ci0JCXN0dWNrICY9IGluc3Rkb25lX3VuY2hh
bmdlZChpbnN0ZG9uZS5yb3dbc2xpY2VdW3N1YnNsaWNlXSwKLQkJCQkJICAgICZhY2N1X2luc3Rk
b25lLT5yb3dbc2xpY2VdW3N1YnNsaWNlXSk7Ci0JfQotCi0JcmV0dXJuIHN0dWNrOwotfQotCi1z
dGF0aWMgZW51bSBpbnRlbF9lbmdpbmVfaGFuZ2NoZWNrX2FjdGlvbgotaGVhZF9zdHVjayhzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHU2NCBhY3RoZCkKLXsKLQlpZiAoYWN0aGQgIT0g
ZW5naW5lLT5oYW5nY2hlY2suYWN0aGQpIHsKLQotCQkvKiBDbGVhciBzdWJ1bml0IHN0YXRlcyBv
biBoZWFkIG1vdmVtZW50ICovCi0JCW1lbXNldCgmZW5naW5lLT5oYW5nY2hlY2suaW5zdGRvbmUs
IDAsCi0JCSAgICAgICBzaXplb2YoZW5naW5lLT5oYW5nY2hlY2suaW5zdGRvbmUpKTsKLQotCQly
ZXR1cm4gRU5HSU5FX0FDVElWRV9IRUFEOwotCX0KLQotCWlmICghc3VidW5pdHNfc3R1Y2soZW5n
aW5lKSkKLQkJcmV0dXJuIEVOR0lORV9BQ1RJVkVfU1VCVU5JVFM7Ci0KLQlyZXR1cm4gRU5HSU5F
X0RFQUQ7Ci19Ci0KLXN0YXRpYyBlbnVtIGludGVsX2VuZ2luZV9oYW5nY2hlY2tfYWN0aW9uCi1l
bmdpbmVfc3R1Y2soc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1NjQgYWN0aGQpCi17
Ci0JZW51bSBpbnRlbF9lbmdpbmVfaGFuZ2NoZWNrX2FjdGlvbiBoYTsKLQl1MzIgdG1wOwotCi0J
aGEgPSBoZWFkX3N0dWNrKGVuZ2luZSwgYWN0aGQpOwotCWlmIChoYSAhPSBFTkdJTkVfREVBRCkK
LQkJcmV0dXJuIGhhOwotCi0JaWYgKElTX0dFTihlbmdpbmUtPmk5MTUsIDIpKQotCQlyZXR1cm4g
RU5HSU5FX0RFQUQ7Ci0KLQkvKiBJcyB0aGUgY2hpcCBoYW5naW5nIG9uIGEgV0FJVF9GT1JfRVZF
TlQ/Ci0JICogSWYgc28gd2UgY2FuIHNpbXBseSBwb2tlIHRoZSBSQl9XQUlUIGJpdAotCSAqIGFu
ZCBicmVhayB0aGUgaGFuZy4gVGhpcyBzaG91bGQgd29yayBvbgotCSAqIGFsbCBidXQgdGhlIHNl
Y29uZCBnZW5lcmF0aW9uIGNoaXBzZXRzLgotCSAqLwotCXRtcCA9IEVOR0lORV9SRUFEKGVuZ2lu
ZSwgUklOR19DVEwpOwotCWlmICh0bXAgJiBSSU5HX1dBSVQpIHsKLQkJaW50ZWxfZ3RfaGFuZGxl
X2Vycm9yKGVuZ2luZS0+Z3QsIGVuZ2luZS0+bWFzaywgMCwKLQkJCQkgICAgICAic3R1Y2sgd2Fp
dCBvbiAlcyIsIGVuZ2luZS0+bmFtZSk7Ci0JCUVOR0lORV9XUklURShlbmdpbmUsIFJJTkdfQ1RM
LCB0bXApOwotCQlyZXR1cm4gRU5HSU5FX1dBSVRfS0lDSzsKLQl9Ci0KLQlyZXR1cm4gRU5HSU5F
X0RFQUQ7Ci19Ci0KLXN0YXRpYyB2b2lkIGhhbmdjaGVja19sb2FkX3NhbXBsZShzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUsCi0JCQkJICBzdHJ1Y3QgaGFuZ2NoZWNrICpoYykKLXsKLQlo
Yy0+YWN0aGQgPSBpbnRlbF9lbmdpbmVfZ2V0X2FjdGl2ZV9oZWFkKGVuZ2luZSk7Ci0JaGMtPnJp
bmcgPSBFTkdJTkVfUkVBRChlbmdpbmUsIFJJTkdfU1RBUlQpOwotCWhjLT5oZWFkID0gRU5HSU5F
X1JFQUQoZW5naW5lLCBSSU5HX0hFQUQpOwotfQotCi1zdGF0aWMgdm9pZCBoYW5nY2hlY2tfc3Rv
cmVfc2FtcGxlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCQkgICBjb25zdCBz
dHJ1Y3QgaGFuZ2NoZWNrICpoYykKLXsKLQllbmdpbmUtPmhhbmdjaGVjay5hY3RoZCA9IGhjLT5h
Y3RoZDsKLQllbmdpbmUtPmhhbmdjaGVjay5sYXN0X3JpbmcgPSBoYy0+cmluZzsKLQllbmdpbmUt
PmhhbmdjaGVjay5sYXN0X2hlYWQgPSBoYy0+aGVhZDsKLX0KLQotc3RhdGljIGVudW0gaW50ZWxf
ZW5naW5lX2hhbmdjaGVja19hY3Rpb24KLWhhbmdjaGVja19nZXRfYWN0aW9uKHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJICAgICBjb25zdCBzdHJ1Y3QgaGFuZ2NoZWNrICpoYykK
LXsKLQlpZiAoaW50ZWxfZW5naW5lX2lzX2lkbGUoZW5naW5lKSkKLQkJcmV0dXJuIEVOR0lORV9J
RExFOwotCi0JaWYgKGVuZ2luZS0+aGFuZ2NoZWNrLmxhc3RfcmluZyAhPSBoYy0+cmluZykKLQkJ
cmV0dXJuIEVOR0lORV9BQ1RJVkVfU0VRTk87Ci0KLQlpZiAoZW5naW5lLT5oYW5nY2hlY2subGFz
dF9oZWFkICE9IGhjLT5oZWFkKQotCQlyZXR1cm4gRU5HSU5FX0FDVElWRV9TRVFOTzsKLQotCXJl
dHVybiBlbmdpbmVfc3R1Y2soZW5naW5lLCBoYy0+YWN0aGQpOwotfQotCi1zdGF0aWMgdm9pZCBo
YW5nY2hlY2tfYWNjdW11bGF0ZV9zYW1wbGUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
LAotCQkJCQlzdHJ1Y3QgaGFuZ2NoZWNrICpoYykKLXsKLQl1bnNpZ25lZCBsb25nIHRpbWVvdXQg
PSBJOTE1X0VOR0lORV9ERUFEX1RJTUVPVVQ7Ci0KLQloYy0+YWN0aW9uID0gaGFuZ2NoZWNrX2dl
dF9hY3Rpb24oZW5naW5lLCBoYyk7Ci0KLQkvKiBXZSBhbHdheXMgaW5jcmVtZW50IHRoZSBwcm9n
cmVzcwotCSAqIGlmIHRoZSBlbmdpbmUgaXMgYnVzeSBhbmQgc3RpbGwgcHJvY2Vzc2luZwotCSAq
IHRoZSBzYW1lIHJlcXVlc3QsIHNvIHRoYXQgbm8gc2luZ2xlIHJlcXVlc3QKLQkgKiBjYW4gcnVu
IGluZGVmaW5pdGVseSAoc3VjaCBhcyBhIGNoYWluIG9mCi0JICogYmF0Y2hlcykuIFRoZSBvbmx5
IHRpbWUgd2UgZG8gbm90IGluY3JlbWVudAotCSAqIHRoZSBoYW5nY2hlY2sgc2NvcmUgb24gdGhp
cyByaW5nLCBpZiB0aGlzCi0JICogZW5naW5lIGlzIGluIGEgbGVnaXRpbWF0ZSB3YWl0IGZvciBh
bm90aGVyCi0JICogZW5naW5lLiBJbiB0aGF0IGNhc2UgdGhlIHdhaXRpbmcgZW5naW5lIGlzIGEK
LQkgKiB2aWN0aW0gYW5kIHdlIHdhbnQgdG8gYmUgc3VyZSB3ZSBjYXRjaCB0aGUKLQkgKiByaWdo
dCBjdWxwcml0LiBUaGVuIGV2ZXJ5IHRpbWUgd2UgZG8ga2ljawotCSAqIHRoZSByaW5nLCBtYWtl
IGl0IGFzIGEgcHJvZ3Jlc3MgYXMgdGhlIHNlcW5vCi0JICogYWR2YW5jZW1lbnQgbWlnaHQgZW5z
dXJlIGFuZCBpZiBub3QsIGl0Ci0JICogd2lsbCBjYXRjaCB0aGUgaGFuZ2luZyBlbmdpbmUuCi0J
ICovCi0KLQlzd2l0Y2ggKGhjLT5hY3Rpb24pIHsKLQljYXNlIEVOR0lORV9JRExFOgotCWNhc2Ug
RU5HSU5FX0FDVElWRV9TRVFOTzoKLQkJLyogQ2xlYXIgaGVhZCBhbmQgc3VidW5pdCBzdGF0ZXMg
b24gc2Vxbm8gbW92ZW1lbnQgKi8KLQkJaGMtPmFjdGhkID0gMDsKLQotCQltZW1zZXQoJmVuZ2lu
ZS0+aGFuZ2NoZWNrLmluc3Rkb25lLCAwLAotCQkgICAgICAgc2l6ZW9mKGVuZ2luZS0+aGFuZ2No
ZWNrLmluc3Rkb25lKSk7Ci0KLQkJLyogSW50ZW50aW9uYWwgZmFsbCB0aHJvdWdoICovCi0JY2Fz
ZSBFTkdJTkVfV0FJVF9LSUNLOgotCWNhc2UgRU5HSU5FX1dBSVQ6Ci0JCWVuZ2luZS0+aGFuZ2No
ZWNrLmFjdGlvbl90aW1lc3RhbXAgPSBqaWZmaWVzOwotCQlicmVhazsKLQotCWNhc2UgRU5HSU5F
X0FDVElWRV9IRUFEOgotCWNhc2UgRU5HSU5FX0FDVElWRV9TVUJVTklUUzoKLQkJLyoKLQkJICog
U2Vxbm8gc3R1Y2sgd2l0aCBzdGlsbCBhY3RpdmUgZW5naW5lIGdldHMgbGVld2F5LAotCQkgKiBp
biBob3BlcyB0aGF0IGl0IGlzIGp1c3QgYSBsb25nIHNoYWRlci4KLQkJICovCi0JCXRpbWVvdXQg
PSBJOTE1X1NFUU5PX0RFQURfVElNRU9VVDsKLQkJYnJlYWs7Ci0KLQljYXNlIEVOR0lORV9ERUFE
OgotCQlicmVhazsKLQotCWRlZmF1bHQ6Ci0JCU1JU1NJTkdfQ0FTRShoYy0+YWN0aW9uKTsKLQl9
Ci0KLQloYy0+c3RhbGxlZCA9IHRpbWVfYWZ0ZXIoamlmZmllcywKLQkJCQkgZW5naW5lLT5oYW5n
Y2hlY2suYWN0aW9uX3RpbWVzdGFtcCArIHRpbWVvdXQpOwotCWhjLT53ZWRnZWQgPSB0aW1lX2Fm
dGVyKGppZmZpZXMsCi0JCQkJIGVuZ2luZS0+aGFuZ2NoZWNrLmFjdGlvbl90aW1lc3RhbXAgKwot
CQkJCSBJOTE1X0VOR0lORV9XRURHRURfVElNRU9VVCk7Ci19Ci0KLXN0YXRpYyB2b2lkIGhhbmdj
aGVja19kZWNsYXJlX2hhbmcoc3RydWN0IGludGVsX2d0ICpndCwKLQkJCQkgICBpbnRlbF9lbmdp
bmVfbWFza190IGh1bmcsCi0JCQkJICAgaW50ZWxfZW5naW5lX21hc2tfdCBzdHVjaykKLXsKLQlz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0JaW50ZWxfZW5naW5lX21hc2tfdCB0bXA7
Ci0JY2hhciBtc2dbODBdOwotCWludCBsZW47Ci0KLQkvKiBJZiBzb21lIHJpbmdzIGh1bmcgYnV0
IG90aGVycyB3ZXJlIHN0aWxsIGJ1c3ksIG9ubHkKLQkgKiBibGFtZSB0aGUgaGFuZ2luZyByaW5n
cyBpbiB0aGUgc3lub3BzaXMuCi0JICovCi0JaWYgKHN0dWNrICE9IGh1bmcpCi0JCWh1bmcgJj0g
fnN0dWNrOwotCWxlbiA9IHNjbnByaW50Zihtc2csIHNpemVvZihtc2cpLAotCQkJIiVzIG9uICIs
IHN0dWNrID09IGh1bmcgPyAibm8gcHJvZ3Jlc3MiIDogImhhbmciKTsKLQlmb3JfZWFjaF9lbmdp
bmVfbWFza2VkKGVuZ2luZSwgZ3QsIGh1bmcsIHRtcCkKLQkJbGVuICs9IHNjbnByaW50Zihtc2cg
KyBsZW4sIHNpemVvZihtc2cpIC0gbGVuLAotCQkJCSAiJXMsICIsIGVuZ2luZS0+bmFtZSk7Ci0J
bXNnW2xlbi0yXSA9ICdcMCc7Ci0KLQlyZXR1cm4gaW50ZWxfZ3RfaGFuZGxlX2Vycm9yKGd0LCBo
dW5nLCBJOTE1X0VSUk9SX0NBUFRVUkUsICIlcyIsIG1zZyk7Ci19Ci0KLS8qCi0gKiBUaGlzIGlz
IGNhbGxlZCB3aGVuIHRoZSBjaGlwIGhhc24ndCByZXBvcnRlZCBiYWNrIHdpdGggY29tcGxldGVk
Ci0gKiBiYXRjaGJ1ZmZlcnMgaW4gYSBsb25nIHRpbWUuIFdlIGtlZXAgdHJhY2sgcGVyIHJpbmcg
c2Vxbm8gcHJvZ3Jlc3MgYW5kCi0gKiBpZiB0aGVyZSBhcmUgbm8gcHJvZ3Jlc3MsIGhhbmdjaGVj
ayBzY29yZSBmb3IgdGhhdCByaW5nIGlzIGluY3JlYXNlZC4KLSAqIEZ1cnRoZXIsIGFjdGhkIGlz
IGluc3BlY3RlZCB0byBzZWUgaWYgdGhlIHJpbmcgaXMgc3R1Y2suIE9uIHN0dWNrIGNhc2UKLSAq
IHdlIGtpY2sgdGhlIHJpbmcuIElmIHdlIHNlZSBubyBwcm9ncmVzcyBvbiB0aHJlZSBzdWJzZXF1
ZW50IGNhbGxzCi0gKiB3ZSBhc3N1bWUgY2hpcCBpcyB3ZWRnZWQgYW5kIHRyeSB0byBmaXggaXQg
YnkgcmVzZXR0aW5nIHRoZSBjaGlwLgotICovCi1zdGF0aWMgdm9pZCBoYW5nY2hlY2tfZWxhcHNl
ZChzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCi17Ci0Jc3RydWN0IGludGVsX2d0ICpndCA9Ci0J
CWNvbnRhaW5lcl9vZih3b3JrLCB0eXBlb2YoKmd0KSwgaGFuZ2NoZWNrLndvcmsud29yayk7Ci0J
aW50ZWxfZW5naW5lX21hc2tfdCBodW5nID0gMCwgc3R1Y2sgPSAwLCB3ZWRnZWQgPSAwOwotCXN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKLQllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsK
LQlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKLQotCWlmICghaTkxNV9tb2RwYXJhbXMuZW5hYmxl
X2hhbmdjaGVjaykKLQkJcmV0dXJuOwotCi0JaWYgKCFSRUFEX09OQ0UoZ3QtPmF3YWtlKSkKLQkJ
cmV0dXJuOwotCi0JaWYgKGludGVsX2d0X2lzX3dlZGdlZChndCkpCi0JCXJldHVybjsKLQotCXdh
a2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UoZ3QtPnVuY29yZS0+cnBtKTsK
LQlpZiAoIXdha2VyZWYpCi0JCXJldHVybjsKLQotCS8qIEFzIGVuYWJsaW5nIHRoZSBHUFUgcmVx
dWlyZXMgZmFpcmx5IGV4dGVuc2l2ZSBtbWlvIGFjY2VzcywKLQkgKiBwZXJpb2RpY2FsbHkgYXJt
IHRoZSBtbWlvIGNoZWNrZXIgdG8gc2VlIGlmIHdlIGFyZSB0cmlnZ2VyaW5nCi0JICogYW55IGlu
dmFsaWQgYWNjZXNzLgotCSAqLwotCWludGVsX3VuY29yZV9hcm1fdW5jbGFpbWVkX21taW9fZGV0
ZWN0aW9uKGd0LT51bmNvcmUpOwotCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7
Ci0JCXN0cnVjdCBoYW5nY2hlY2sgaGM7Ci0KLQkJaW50ZWxfZW5naW5lX2JyZWFkY3J1bWJzX2ly
cShlbmdpbmUpOwotCi0JCWhhbmdjaGVja19sb2FkX3NhbXBsZShlbmdpbmUsICZoYyk7Ci0JCWhh
bmdjaGVja19hY2N1bXVsYXRlX3NhbXBsZShlbmdpbmUsICZoYyk7Ci0JCWhhbmdjaGVja19zdG9y
ZV9zYW1wbGUoZW5naW5lLCAmaGMpOwotCi0JCWlmIChoYy5zdGFsbGVkKSB7Ci0JCQlodW5nIHw9
IGVuZ2luZS0+bWFzazsKLQkJCWlmIChoYy5hY3Rpb24gIT0gRU5HSU5FX0RFQUQpCi0JCQkJc3R1
Y2sgfD0gZW5naW5lLT5tYXNrOwotCQl9Ci0KLQkJaWYgKGhjLndlZGdlZCkKLQkJCXdlZGdlZCB8
PSBlbmdpbmUtPm1hc2s7Ci0JfQotCi0JaWYgKEdFTV9TSE9XX0RFQlVHKCkgJiYgKGh1bmcgfCBz
dHVjaykpIHsKLQkJc3RydWN0IGRybV9wcmludGVyIHAgPSBkcm1fZGVidWdfcHJpbnRlcigiaGFu
Z2NoZWNrIik7Ci0KLQkJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7Ci0JCQlpZiAo
aW50ZWxfZW5naW5lX2lzX2lkbGUoZW5naW5lKSkKLQkJCQljb250aW51ZTsKLQotCQkJaW50ZWxf
ZW5naW5lX2R1bXAoZW5naW5lLCAmcCwgIiVzXG4iLCBlbmdpbmUtPm5hbWUpOwotCQl9Ci0JfQot
Ci0JaWYgKHdlZGdlZCkgewotCQlkZXZfZXJyKGd0LT5pOTE1LT5kcm0uZGV2LAotCQkJIkdQVSBy
ZWNvdmVyeSB0aW1lZCBvdXQsIgotCQkJIiBjYW5jZWxsaW5nIGFsbCBpbi1mbGlnaHQgcmVuZGVy
aW5nLlxuIik7Ci0JCUdFTV9UUkFDRV9EVU1QKCk7Ci0JCWludGVsX2d0X3NldF93ZWRnZWQoZ3Qp
OwotCX0KLQotCWlmIChodW5nKQotCQloYW5nY2hlY2tfZGVjbGFyZV9oYW5nKGd0LCBodW5nLCBz
dHVjayk7Ci0KLQlpbnRlbF9ydW50aW1lX3BtX3B1dChndC0+dW5jb3JlLT5ycG0sIHdha2VyZWYp
OwotCi0JLyogUmVzZXQgdGltZXIgaW4gY2FzZSBHUFUgaGFuZ3Mgd2l0aG91dCBhbm90aGVyIHJl
cXVlc3QgYmVpbmcgYWRkZWQgKi8KLQlpbnRlbF9ndF9xdWV1ZV9oYW5nY2hlY2soZ3QpOwotfQot
Ci12b2lkIGludGVsX2d0X3F1ZXVlX2hhbmdjaGVjayhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQotewot
CXVuc2lnbmVkIGxvbmcgZGVsYXk7Ci0KLQlpZiAodW5saWtlbHkoIWk5MTVfbW9kcGFyYW1zLmVu
YWJsZV9oYW5nY2hlY2spKQotCQlyZXR1cm47Ci0KLQkvKgotCSAqIERvbid0IGNvbnRpbnVhbGx5
IGRlZmVyIHRoZSBoYW5nY2hlY2sgc28gdGhhdCBpdCBpcyBhbHdheXMgcnVuIGF0Ci0JICogbGVh
c3Qgb25jZSBhZnRlciB3b3JrIGhhcyBiZWVuIHNjaGVkdWxlZCBvbiBhbnkgcmluZy4gT3RoZXJ3
aXNlLAotCSAqIHdlIHdpbGwgaWdub3JlIGEgaHVuZyByaW5nIGlmIGEgc2Vjb25kIHJpbmcgaXMg
a2VwdCBidXN5LgotCSAqLwotCi0JZGVsYXkgPSByb3VuZF9qaWZmaWVzX3VwX3JlbGF0aXZlKERS
TV9JOTE1X0hBTkdDSEVDS19KSUZGSUVTKTsKLQlxdWV1ZV9kZWxheWVkX3dvcmsoc3lzdGVtX2xv
bmdfd3EsICZndC0+aGFuZ2NoZWNrLndvcmssIGRlbGF5KTsKLX0KLQotdm9pZCBpbnRlbF9lbmdp
bmVfaW5pdF9oYW5nY2hlY2soc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQotewotCW1l
bXNldCgmZW5naW5lLT5oYW5nY2hlY2ssIDAsIHNpemVvZihlbmdpbmUtPmhhbmdjaGVjaykpOwot
CWVuZ2luZS0+aGFuZ2NoZWNrLmFjdGlvbl90aW1lc3RhbXAgPSBqaWZmaWVzOwotfQotCi12b2lk
IGludGVsX2d0X2luaXRfaGFuZ2NoZWNrKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCi17Ci0JSU5JVF9E
RUxBWUVEX1dPUksoJmd0LT5oYW5nY2hlY2sud29yaywgaGFuZ2NoZWNrX2VsYXBzZWQpOwotfQot
Ci0jaWYgSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfU0VMRlRFU1QpCi0jaW5jbHVkZSAic2Vs
ZnRlc3RfaGFuZ2NoZWNrLmMiCi0jZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX3Jlc2V0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNl
dC5jCmluZGV4IGJmOGQxZWQ0YjFkOC4uZjAzZTAwMDA1MWMxIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX3Jlc2V0LmMKQEAgLTEwMjQsOCArMTAyNCw2IEBAIHZvaWQgaW50ZWxfZ3RfcmVz
ZXQoc3RydWN0IGludGVsX2d0ICpndCwKIAlpZiAocmV0KQogCQlnb3RvIHRhaW50OwogCi0JaW50
ZWxfZ3RfcXVldWVfaGFuZ2NoZWNrKGd0KTsKLQogZmluaXNoOgogCXJlc2V0X2ZpbmlzaChndCwg
YXdha2UpOwogdW5sb2NrOgpAQCAtMTM1Myw0ICsxMzUxLDUgQEAgdm9pZCBfX2ludGVsX2Zpbmlf
d2VkZ2Uoc3RydWN0IGludGVsX3dlZGdlX21lICp3KQogCiAjaWYgSVNfRU5BQkxFRChDT05GSUdf
RFJNX0k5MTVfU0VMRlRFU1QpCiAjaW5jbHVkZSAic2VsZnRlc3RfcmVzZXQuYyIKKyNpbmNsdWRl
ICJzZWxmdGVzdF9oYW5nY2hlY2suYyIKICNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfZW5naW5lX2hlYXJ0YmVhdC5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Qvc2VsZnRlc3RfZW5naW5lX2hlYXJ0YmVhdC5jCmluZGV4IDVhZjI3YzM3YjY1Yi4u
OWZiNWQzMGM0M2JiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVz
dF9lbmdpbmVfaGVhcnRiZWF0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRl
c3RfZW5naW5lX2hlYXJ0YmVhdC5jCkBAIC00LDYgKzQsOCBAQAogICogQ29weXJpZ2h0IMKpIDIw
MTggSW50ZWwgQ29ycG9yYXRpb24KICAqLwogCisjaW5jbHVkZSA8bGludXgvc29ydC5oPgorCiAj
aW5jbHVkZSAiaTkxNV9kcnYuaCIKIAogI2luY2x1ZGUgImludGVsX2d0X3JlcXVlc3RzLmgiCkBA
IC0xNTAsMTEgKzE1MiwxODAgQEAgc3RhdGljIGludCBsaXZlX2lkbGVfcHVsc2Uodm9pZCAqYXJn
KQogCXJldHVybiBlcnI7CiB9CiAKK3N0YXRpYyBpbnQgY21wX3UzMihjb25zdCB2b2lkICpfYSwg
Y29uc3Qgdm9pZCAqX2IpCit7CisJY29uc3QgdTMyICphID0gX2EsICpiID0gX2I7CisKKwlyZXR1
cm4gKmEgLSAqYjsKK30KKworc3RhdGljIGludCBfX2xpdmVfaGVhcnRiZWF0X2Zhc3Qoc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsK
KwlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKKwlrdGltZV90IHQwLCB0MTsKKwl1MzIgdGltZXNb
NV07CisJaW50IGVycjsKKwlpbnQgaTsKKworCWNlID0gaW50ZWxfY29udGV4dF9jcmVhdGUoZW5n
aW5lLT5rZXJuZWxfY29udGV4dC0+Z2VtX2NvbnRleHQsCisJCQkJICBlbmdpbmUpOworCWlmIChJ
U19FUlIoY2UpKQorCQlyZXR1cm4gUFRSX0VSUihjZSk7CisKKwlpbnRlbF9lbmdpbmVfcG1fZ2V0
KGVuZ2luZSk7CisKKwllcnIgPSBpbnRlbF9lbmdpbmVfc2V0X2hlYXJ0YmVhdChlbmdpbmUsIDEp
OworCWlmIChlcnIpCisJCWdvdG8gZXJyX3BtOworCisJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJ
WkUodGltZXMpOyBpKyspIHsKKwkJLyogTWFudWZhY3R1cmUgYSB0aWNrICovCisJCWRvIHsKKwkJ
CXdoaWxlIChSRUFEX09OQ0UoZW5naW5lLT5oZWFydGJlYXQuc3lzdG9sZSkpCisJCQkJZmx1c2hf
ZGVsYXllZF93b3JrKCZlbmdpbmUtPmhlYXJ0YmVhdC53b3JrKTsKKworCQkJZW5naW5lLT5zZXJp
YWwrKzsgLyogcXVpY2ssIHByZXRlbmQgd2UgYXJlIG5vdCBpZGxlISAqLworCQkJZmx1c2hfZGVs
YXllZF93b3JrKCZlbmdpbmUtPmhlYXJ0YmVhdC53b3JrKTsKKwkJCWlmICghZGVsYXllZF93b3Jr
X3BlbmRpbmcoJmVuZ2luZS0+aGVhcnRiZWF0LndvcmspKSB7CisJCQkJcHJfZXJyKCIlczogaGVh
cnRiZWF0IGRpZCBub3Qgc3RhcnRcbiIsCisJCQkJICAgICAgIGVuZ2luZS0+bmFtZSk7CisJCQkJ
ZXJyID0gLUVJTlZBTDsKKwkJCQlnb3RvIGVycl9wbTsKKwkJCX0KKworCQkJcmN1X3JlYWRfbG9j
aygpOworCQkJcnEgPSBSRUFEX09OQ0UoZW5naW5lLT5oZWFydGJlYXQuc3lzdG9sZSk7CisJCQlp
ZiAocnEpCisJCQkJcnEgPSBpOTE1X3JlcXVlc3RfZ2V0X3JjdShycSk7CisJCQlyY3VfcmVhZF91
bmxvY2soKTsKKwkJfSB3aGlsZSAoIXJxKTsKKworCQl0MCA9IGt0aW1lX2dldCgpOworCQl3aGls
ZSAocnEgPT0gUkVBRF9PTkNFKGVuZ2luZS0+aGVhcnRiZWF0LnN5c3RvbGUpKQorCQkJeWllbGQo
KTsgLyogd29yayBpcyBvbiB0aGUgbG9jYWwgY3B1ISAqLworCQl0MSA9IGt0aW1lX2dldCgpOwor
CisJCWk5MTVfcmVxdWVzdF9wdXQocnEpOworCQl0aW1lc1tpXSA9IGt0aW1lX3VzX2RlbHRhKHQx
LCB0MCk7CisJfQorCisJc29ydCh0aW1lcywgQVJSQVlfU0laRSh0aW1lcyksIHNpemVvZih0aW1l
c1swXSksIGNtcF91MzIsIE5VTEwpOworCisJcHJfaW5mbygiJXM6IEhlYXJ0YmVhdCBkZWxheTog
JXV1cyBbJXUsICV1XVxuIiwKKwkJZW5naW5lLT5uYW1lLAorCQl0aW1lc1tBUlJBWV9TSVpFKHRp
bWVzKSAvIDJdLAorCQl0aW1lc1swXSwKKwkJdGltZXNbQVJSQVlfU0laRSh0aW1lcykgLSAxXSk7
CisKKwkvKiBNaW4gd29yayBkZWxheSBpcyAyICogMiAod29yc3QpLCArMSBmb3Igc2NoZWR1bGlu
ZywgKzEgZm9yIHNsYWNrICovCisJaWYgKHRpbWVzW0FSUkFZX1NJWkUodGltZXMpIC8gMl0gPiBq
aWZmaWVzX3RvX3VzZWNzKDYpKSB7CisJCXByX2VycigiJXM6IEhlYXJ0YmVhdCBkZWxheSB3YXMg
JXV1cywgZXhwZWN0ZWQgbGVzcyB0aGFuICVkdXNcbiIsCisJCSAgICAgICBlbmdpbmUtPm5hbWUs
CisJCSAgICAgICB0aW1lc1tBUlJBWV9TSVpFKHRpbWVzKSAvIDJdLAorCQkgICAgICAgamlmZmll
c190b191c2Vjcyg2KSk7CisJCWVyciA9IC1FSU5WQUw7CisJfQorCisJaW50ZWxfZW5naW5lX3Nl
dF9oZWFydGJlYXQoZW5naW5lLCBDT05GSUdfRFJNX0k5MTVfSEVBUlRCRUFUX0lOVEVSVkFMKTsK
K2Vycl9wbToKKwlpbnRlbF9lbmdpbmVfcG1fcHV0KGVuZ2luZSk7CisJaW50ZWxfY29udGV4dF9w
dXQoY2UpOworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBpbnQgbGl2ZV9oZWFydGJlYXRfZmFz
dCh2b2lkICphcmcpCit7CisJc3RydWN0IGludGVsX2d0ICpndCA9IGFyZzsKKwlzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmU7CisJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CisJaW50IGVy
cjsKKworCS8qIENoZWNrIHRoYXQgdGhlIGhlYXJ0YmVhdCB0aWNrcyBhdCB0aGUgZGVzaXJlZCBy
YXRlLiAqLworCWlmICghQ09ORklHX0RSTV9JOTE1X0hFQVJUQkVBVF9JTlRFUlZBTCkKKwkJcmV0
dXJuIDA7CisKKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndCwgaWQpIHsKKwkJZXJyID0gX19s
aXZlX2hlYXJ0YmVhdF9mYXN0KGVuZ2luZSk7CisJCWlmIChlcnIpCisJCQlicmVhazsKKwl9CisK
KwlyZXR1cm4gZXJyOworfQorCitzdGF0aWMgaW50IF9fbGl2ZV9oZWFydGJlYXRfb2ZmKHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlpbnQgZXJyOworCisJaW50ZWxfZW5naW5l
X3BtX2dldChlbmdpbmUpOworCisJZW5naW5lLT5zZXJpYWwrKzsKKwlmbHVzaF9kZWxheWVkX3dv
cmsoJmVuZ2luZS0+aGVhcnRiZWF0LndvcmspOworCWlmICghZGVsYXllZF93b3JrX3BlbmRpbmco
JmVuZ2luZS0+aGVhcnRiZWF0LndvcmspKSB7CisJCXByX2VycigiJXM6IGhlYXJ0YmVhdCBub3Qg
cnVubmluZ1xuIiwKKwkJICAgICAgIGVuZ2luZS0+bmFtZSk7CisJCWVyciA9IC1FSU5WQUw7CisJ
CWdvdG8gZXJyX3BtOworCX0KKworCWVyciA9IGludGVsX2VuZ2luZV9zZXRfaGVhcnRiZWF0KGVu
Z2luZSwgMCk7CisJaWYgKGVycikKKwkJZ290byBlcnJfcG07CisKKwllbmdpbmUtPnNlcmlhbCsr
OworCWZsdXNoX2RlbGF5ZWRfd29yaygmZW5naW5lLT5oZWFydGJlYXQud29yayk7CisJaWYgKGRl
bGF5ZWRfd29ya19wZW5kaW5nKCZlbmdpbmUtPmhlYXJ0YmVhdC53b3JrKSkgeworCQlwcl9lcnIo
IiVzOiBoZWFydGJlYXQgc3RpbGwgcnVubmluZ1xuIiwKKwkJICAgICAgIGVuZ2luZS0+bmFtZSk7
CisJCWVyciA9IC1FSU5WQUw7CisJCWdvdG8gZXJyX2JlYXQ7CisJfQorCisJaWYgKFJFQURfT05D
RShlbmdpbmUtPmhlYXJ0YmVhdC5zeXN0b2xlKSkgeworCQlwcl9lcnIoIiVzOiBoZWFydGJlYXQg
c3RpbGwgYWxsb2NhdGVkXG4iLAorCQkgICAgICAgZW5naW5lLT5uYW1lKTsKKwkJZXJyID0gLUVJ
TlZBTDsKKwkJZ290byBlcnJfYmVhdDsKKwl9CisKK2Vycl9iZWF0OgorCWludGVsX2VuZ2luZV9z
ZXRfaGVhcnRiZWF0KGVuZ2luZSwgQ09ORklHX0RSTV9JOTE1X0hFQVJUQkVBVF9JTlRFUlZBTCk7
CitlcnJfcG06CisJaW50ZWxfZW5naW5lX3BtX3B1dChlbmdpbmUpOworCXJldHVybiBlcnI7Cit9
CisKK3N0YXRpYyBpbnQgbGl2ZV9oZWFydGJlYXRfb2ZmKHZvaWQgKmFyZykKK3sKKwlzdHJ1Y3Qg
aW50ZWxfZ3QgKmd0ID0gYXJnOworCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKKwll
bnVtIGludGVsX2VuZ2luZV9pZCBpZDsKKwlpbnQgZXJyOworCisJLyogQ2hlY2sgdGhhdCB3ZSBj
YW4gdHVybiBvZmYgaGVhcnRiZWF0IGFuZCBub3QgaW50ZXJydXB0IFZJUCAqLworCWlmICghQ09O
RklHX0RSTV9JOTE1X0hFQVJUQkVBVF9JTlRFUlZBTCkKKwkJcmV0dXJuIDA7CisKKwlmb3JfZWFj
aF9lbmdpbmUoZW5naW5lLCBndCwgaWQpIHsKKwkJaWYgKCFpbnRlbF9lbmdpbmVfaGFzX3ByZWVt
cHRpb24oZW5naW5lKSkKKwkJCWNvbnRpbnVlOworCisJCWVyciA9IF9fbGl2ZV9oZWFydGJlYXRf
b2ZmKGVuZ2luZSk7CisJCWlmIChlcnIpCisJCQlicmVhazsKKwl9CisKKwlyZXR1cm4gZXJyOwor
fQorCiBpbnQgaW50ZWxfaGVhcnRiZWF0X2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQogewogCXN0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9zdWJ0ZXN0IHRlc3Rz
W10gPSB7CiAJCVNVQlRFU1QobGl2ZV9pZGxlX2ZsdXNoKSwKIAkJU1VCVEVTVChsaXZlX2lkbGVf
cHVsc2UpLAorCQlTVUJURVNUKGxpdmVfaGVhcnRiZWF0X2Zhc3QpLAorCQlTVUJURVNUKGxpdmVf
aGVhcnRiZWF0X29mZiksCiAJfTsKIAlpbnQgc2F2ZWRfaGFuZ2NoZWNrOwogCWludCBlcnI7CmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hlY2suYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jCmluZGV4IDhlMDAx
NjQ2NDMyNS4uYjg5MmI0NzM0OGFiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9zZWxmdGVzdF9oYW5nY2hlY2suYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxm
dGVzdF9oYW5nY2hlY2suYwpAQCAtMTY4Niw3ICsxNjg2LDYgQEAgaW50IGludGVsX2hhbmdjaGVj
a19saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAl9OwogCXN0
cnVjdCBpbnRlbF9ndCAqZ3QgPSAmaTkxNS0+Z3Q7CiAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7
Ci0JYm9vbCBzYXZlZF9oYW5nY2hlY2s7CiAJaW50IGVycjsKIAogCWlmICghaW50ZWxfaGFzX2dw
dV9yZXNldChndCkpCkBAIC0xNjk2LDEyICsxNjk1LDkgQEAgaW50IGludGVsX2hhbmdjaGVja19s
aXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkJcmV0dXJuIC1F
SU87IC8qIHdlJ3JlIGxvbmcgcGFzdCBob3BlIG9mIGEgc3VjY2Vzc2Z1bCByZXNldCAqLwogCiAJ
d2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGd0LT51bmNvcmUtPnJwbSk7Ci0Jc2F2ZWRf
aGFuZ2NoZWNrID0gZmV0Y2hfYW5kX3plcm8oJmk5MTVfbW9kcGFyYW1zLmVuYWJsZV9oYW5nY2hl
Y2spOwotCWRyYWluX2RlbGF5ZWRfd29yaygmZ3QtPmhhbmdjaGVjay53b3JrKTsgLyogZmx1c2gg
cGFyYW0gKi8KIAogCWVyciA9IGludGVsX2d0X2xpdmVfc3VidGVzdHModGVzdHMsIGd0KTsKIAot
CWk5MTVfbW9kcGFyYW1zLmVuYWJsZV9oYW5nY2hlY2sgPSBzYXZlZF9oYW5nY2hlY2s7CiAJaW50
ZWxfcnVudGltZV9wbV9wdXQoZ3QtPnVuY29yZS0+cnBtLCB3YWtlcmVmKTsKIAogCXJldHVybiBl
cnI7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCmluZGV4IDE2MjExNDMwZWI3OC4uNzBi
OGNjYWFmYjA1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwpAQCAtMTAxMSw5MiAr
MTAxMSw2IEBAIHN0YXRpYyBpbnQgaTkxNV9mcmVxdWVuY3lfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUg
Km0sIHZvaWQgKnVudXNlZCkKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgdm9pZCBpOTE1X2lu
c3Rkb25lX2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAotCQkJICAgICAg
IHN0cnVjdCBzZXFfZmlsZSAqbSwKLQkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfaW5zdGRvbmUgKmlu
c3Rkb25lKQotewotCWNvbnN0IHN0cnVjdCBzc2V1X2Rldl9pbmZvICpzc2V1ID0gJlJVTlRJTUVf
SU5GTyhkZXZfcHJpdiktPnNzZXU7Ci0JaW50IHNsaWNlOwotCWludCBzdWJzbGljZTsKLQotCXNl
cV9wcmludGYobSwgIlx0XHRJTlNURE9ORTogMHglMDh4XG4iLAotCQkgICBpbnN0ZG9uZS0+aW5z
dGRvbmUpOwotCi0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPD0gMykKLQkJcmV0dXJuOwotCi0J
c2VxX3ByaW50ZihtLCAiXHRcdFNDX0lOU1RET05FOiAweCUwOHhcbiIsCi0JCSAgIGluc3Rkb25l
LT5zbGljZV9jb21tb24pOwotCi0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPD0gNikKLQkJcmV0
dXJuOwotCi0JZm9yX2VhY2hfaW5zdGRvbmVfc2xpY2Vfc3Vic2xpY2UoZGV2X3ByaXYsIHNzZXUs
IHNsaWNlLCBzdWJzbGljZSkKLQkJc2VxX3ByaW50ZihtLCAiXHRcdFNBTVBMRVJfSU5TVERPTkVb
JWRdWyVkXTogMHglMDh4XG4iLAotCQkJICAgc2xpY2UsIHN1YnNsaWNlLCBpbnN0ZG9uZS0+c2Ft
cGxlcltzbGljZV1bc3Vic2xpY2VdKTsKLQotCWZvcl9lYWNoX2luc3Rkb25lX3NsaWNlX3N1YnNs
aWNlKGRldl9wcml2LCBzc2V1LCBzbGljZSwgc3Vic2xpY2UpCi0JCXNlcV9wcmludGYobSwgIlx0
XHRST1dfSU5TVERPTkVbJWRdWyVkXTogMHglMDh4XG4iLAotCQkJICAgc2xpY2UsIHN1YnNsaWNl
LCBpbnN0ZG9uZS0+cm93W3NsaWNlXVtzdWJzbGljZV0pOwotfQotCi1zdGF0aWMgaW50IGk5MTVf
aGFuZ2NoZWNrX2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCi17Ci0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Ci0J
c3RydWN0IGludGVsX2d0ICpndCA9ICZpOTE1LT5ndDsKLQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmU7Ci0JaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Ci0JZW51bSBpbnRlbF9lbmdpbmVf
aWQgaWQ7Ci0KLQlzZXFfcHJpbnRmKG0sICJSZXNldCBmbGFnczogJWx4XG4iLCBndC0+cmVzZXQu
ZmxhZ3MpOwotCWlmICh0ZXN0X2JpdChJOTE1X1dFREdFRCwgJmd0LT5yZXNldC5mbGFncykpCi0J
CXNlcV9wdXRzKG0sICJcdFdlZGdlZFxuIik7Ci0JaWYgKHRlc3RfYml0KEk5MTVfUkVTRVRfQkFD
S09GRiwgJmd0LT5yZXNldC5mbGFncykpCi0JCXNlcV9wdXRzKG0sICJcdERldmljZSAoZ2xvYmFs
KSByZXNldCBpbiBwcm9ncmVzc1xuIik7Ci0KLQlpZiAoIWk5MTVfbW9kcGFyYW1zLmVuYWJsZV9o
YW5nY2hlY2spIHsKLQkJc2VxX3B1dHMobSwgIkhhbmdjaGVjayBkaXNhYmxlZFxuIik7Ci0JCXJl
dHVybiAwOwotCX0KLQotCWlmICh0aW1lcl9wZW5kaW5nKCZndC0+aGFuZ2NoZWNrLndvcmsudGlt
ZXIpKQotCQlzZXFfcHJpbnRmKG0sICJIYW5nY2hlY2sgYWN0aXZlLCB0aW1lciBmaXJlcyBpbiAl
ZG1zXG4iLAotCQkJICAgamlmZmllc190b19tc2VjcyhndC0+aGFuZ2NoZWNrLndvcmsudGltZXIu
ZXhwaXJlcyAtCi0JCQkJCSAgICBqaWZmaWVzKSk7Ci0JZWxzZSBpZiAoZGVsYXllZF93b3JrX3Bl
bmRpbmcoJmd0LT5oYW5nY2hlY2sud29yaykpCi0JCXNlcV9wdXRzKG0sICJIYW5nY2hlY2sgYWN0
aXZlLCB3b3JrIHBlbmRpbmdcbiIpOwotCWVsc2UKLQkJc2VxX3B1dHMobSwgIkhhbmdjaGVjayBp
bmFjdGl2ZVxuIik7Ci0KLQlzZXFfcHJpbnRmKG0sICJHVCBhY3RpdmU/ICVzXG4iLCB5ZXNubyhn
dC0+YXdha2UpKTsKLQotCXdpdGhfaW50ZWxfcnVudGltZV9wbSgmaTkxNS0+cnVudGltZV9wbSwg
d2FrZXJlZikgewotCQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgewotCQkJc3Ry
dWN0IGludGVsX2luc3Rkb25lIGluc3Rkb25lOwotCi0JCQlzZXFfcHJpbnRmKG0sICIlczogJWQg
bXMgYWdvXG4iLAotCQkJCSAgIGVuZ2luZS0+bmFtZSwKLQkJCQkgICBqaWZmaWVzX3RvX21zZWNz
KGppZmZpZXMgLQotCQkJCQkJICAgIGVuZ2luZS0+aGFuZ2NoZWNrLmFjdGlvbl90aW1lc3RhbXAp
KTsKLQotCQkJc2VxX3ByaW50ZihtLCAiXHRBQ1RIRCA9IDB4JTA4bGx4IFtjdXJyZW50IDB4JTA4
bGx4XVxuIiwKLQkJCQkgICAobG9uZyBsb25nKWVuZ2luZS0+aGFuZ2NoZWNrLmFjdGhkLAotCQkJ
CSAgIGludGVsX2VuZ2luZV9nZXRfYWN0aXZlX2hlYWQoZW5naW5lKSk7Ci0KLQkJCWludGVsX2Vu
Z2luZV9nZXRfaW5zdGRvbmUoZW5naW5lLCAmaW5zdGRvbmUpOwotCi0JCQlzZXFfcHV0cyhtLCAi
XHRpbnN0ZG9uZSByZWFkID1cbiIpOwotCQkJaTkxNV9pbnN0ZG9uZV9pbmZvKGk5MTUsIG0sICZp
bnN0ZG9uZSk7Ci0KLQkJCXNlcV9wdXRzKG0sICJcdGluc3Rkb25lIGFjY3UgPVxuIik7Ci0JCQlp
OTE1X2luc3Rkb25lX2luZm8oaTkxNSwgbSwKLQkJCQkJICAgJmVuZ2luZS0+aGFuZ2NoZWNrLmlu
c3Rkb25lKTsKLQkJfQotCX0KLQotCXJldHVybiAwOwotfQotCiBzdGF0aWMgaW50IGlyb25sYWtl
X2RycGNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0pCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7CkBAIC00MzQ5LDcgKzQyNjMsNiBA
QCBzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9pbmZvX2xpc3QgaTkxNV9kZWJ1Z2ZzX2xpc3RbXSA9
IHsKIAl7Imk5MTVfZ3VjX3N0YWdlX3Bvb2wiLCBpOTE1X2d1Y19zdGFnZV9wb29sLCAwfSwKIAl7
Imk5MTVfaHVjX2xvYWRfc3RhdHVzIiwgaTkxNV9odWNfbG9hZF9zdGF0dXNfaW5mbywgMH0sCiAJ
eyJpOTE1X2ZyZXF1ZW5jeV9pbmZvIiwgaTkxNV9mcmVxdWVuY3lfaW5mbywgMH0sCi0JeyJpOTE1
X2hhbmdjaGVja19pbmZvIiwgaTkxNV9oYW5nY2hlY2tfaW5mbywgMH0sCiAJeyJpOTE1X2RycGNf
aW5mbyIsIGk5MTVfZHJwY19pbmZvLCAwfSwKIAl7Imk5MTVfcmluZ19mcmVxX3RhYmxlIiwgaTkx
NV9yaW5nX2ZyZXFfdGFibGUsIDB9LAogCXsiaTkxNV9mcm9udGJ1ZmZlcl90cmFja2luZyIsIGk5
MTVfZnJvbnRidWZmZXJfdHJhY2tpbmcsIDB9LApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9kcnYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKaW5kZXgg
NTEzOGQxZWVkMzA2Li4yNGEzOTg4MjgxZDIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZHJ2LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYwpAQCAt
MTU0OCwxMCArMTU0OCw3IEBAIHZvaWQgaTkxNV9kcml2ZXJfcmVtb3ZlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQogCiAJaTkxNV9kcml2ZXJfbW9kZXNldF9yZW1vdmUoaTkxNSk7CiAK
LQkvKiBGcmVlIGVycm9yIHN0YXRlIGFmdGVyIGludGVycnVwdHMgYXJlIGZ1bGx5IGRpc2FibGVk
LiAqLwotCWNhbmNlbF9kZWxheWVkX3dvcmtfc3luYygmaTkxNS0+Z3QuaGFuZ2NoZWNrLndvcmsp
OwogCWk5MTVfcmVzZXRfZXJyb3Jfc3RhdGUoaTkxNSk7Ci0KIAlpOTE1X2dlbV9kcml2ZXJfcmVt
b3ZlKGk5MTUpOwogCiAJaW50ZWxfcG93ZXJfZG9tYWluc19kcml2ZXJfcmVtb3ZlKGk5MTUpOwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaCBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZHJ2LmgKaW5kZXggODg4MmMwOTA4YzNiLi42NzRlOWU5MjE4MzkgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9kcnYuaApAQCAtMTg0Niw3ICsxODQ2LDYgQEAgdm9pZCBpOTE1X2Ry
aXZlcl9yZW1vdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwogaW50IGk5MTVfcmVz
dW1lX3N3aXRjaGVyb28oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwogaW50IGk5MTVf
c3VzcGVuZF9zd2l0Y2hlcm9vKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBwbV9tZXNz
YWdlX3Qgc3RhdGUpOwogCi12b2lkIGludGVsX2VuZ2luZV9pbml0X2hhbmdjaGVjayhzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUpOwogaW50IHZsdl9mb3JjZV9nZnhfY2xvY2soc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBib29sIG9uKTsKIAogc3RhdGljIGlubGluZSBi
b29sIGludGVsX2d2dF9hY3RpdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmMKaW5kZXggNWNmNGVlZDVhZGQ4Li40NzIz
OWRmNjUzZjIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9y
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuYwpAQCAtNTM0LDEw
ICs1MzQsNiBAQCBzdGF0aWMgdm9pZCBlcnJvcl9wcmludF9lbmdpbmUoc3RydWN0IGRybV9pOTE1
X2Vycm9yX3N0YXRlX2J1ZiAqbSwKIAl9CiAJZXJyX3ByaW50ZihtLCAiICByaW5nLT5oZWFkOiAw
eCUwOHhcbiIsIGVlLT5jcHVfcmluZ19oZWFkKTsKIAllcnJfcHJpbnRmKG0sICIgIHJpbmctPnRh
aWw6IDB4JTA4eFxuIiwgZWUtPmNwdV9yaW5nX3RhaWwpOwotCWVycl9wcmludGYobSwgIiAgaGFu
Z2NoZWNrIHRpbWVzdGFtcDogJWRtcyAoJWx1JXMpXG4iLAotCQkgICBqaWZmaWVzX3RvX21zZWNz
KGVlLT5oYW5nY2hlY2tfdGltZXN0YW1wIC0gZXBvY2gpLAotCQkgICBlZS0+aGFuZ2NoZWNrX3Rp
bWVzdGFtcCwKLQkJICAgZWUtPmhhbmdjaGVja190aW1lc3RhbXAgPT0gZXBvY2ggPyAiOyBlcG9j
aCIgOiAiIik7CiAJZXJyX3ByaW50ZihtLCAiICBlbmdpbmUgcmVzZXQgY291bnQ6ICV1XG4iLCBl
ZS0+cmVzZXRfY291bnQpOwogCiAJZm9yIChuID0gMDsgbiA8IGVlLT5udW1fcG9ydHM7IG4rKykg
ewpAQCAtNjc5LDExICs2NzUsOCBAQCBzdGF0aWMgdm9pZCBfX2Vycl9wcmludF90b19zZ2woc3Ry
dWN0IGRybV9pOTE1X2Vycm9yX3N0YXRlX2J1ZiAqbSwKIAl0cyA9IGt0aW1lX3RvX3RpbWVzcGVj
NjQoZXJyb3ItPnVwdGltZSk7CiAJZXJyX3ByaW50ZihtLCAiVXB0aW1lOiAlbGxkIHMgJWxkIHVz
XG4iLAogCQkgICAoczY0KXRzLnR2X3NlYywgdHMudHZfbnNlYyAvIE5TRUNfUEVSX1VTRUMpOwot
CWVycl9wcmludGYobSwgIkVwb2NoOiAlbHUgamlmZmllcyAoJXUgSFopXG4iLCBlcnJvci0+ZXBv
Y2gsIEhaKTsKLQllcnJfcHJpbnRmKG0sICJDYXB0dXJlOiAlbHUgamlmZmllczsgJWQgbXMgYWdv
LCAlZCBtcyBhZnRlciBlcG9jaFxuIiwKLQkJICAgZXJyb3ItPmNhcHR1cmUsCi0JCSAgIGppZmZp
ZXNfdG9fbXNlY3MoamlmZmllcyAtIGVycm9yLT5jYXB0dXJlKSwKLQkJICAgamlmZmllc190b19t
c2VjcyhlcnJvci0+Y2FwdHVyZSAtIGVycm9yLT5lcG9jaCkpOworCWVycl9wcmludGYobSwgIkNh
cHR1cmU6ICVsdSBqaWZmaWVzOyAlZCBtcyBhZ29cbiIsCisJCSAgIGVycm9yLT5jYXB0dXJlLCBq
aWZmaWVzX3RvX21zZWNzKGppZmZpZXMgLSBlcnJvci0+Y2FwdHVyZSkpOwogCiAJZm9yIChlZSA9
IGVycm9yLT5lbmdpbmU7IGVlOyBlZSA9IGVlLT5uZXh0KQogCQllcnJfcHJpbnRmKG0sICJBY3Rp
dmUgcHJvY2VzcyAob24gcmluZyAlcyk6ICVzIFslZF1cbiIsCkBAIC03NDIsNyArNzM1LDcgQEAg
c3RhdGljIHZvaWQgX19lcnJfcHJpbnRfdG9fc2dsKHN0cnVjdCBkcm1faTkxNV9lcnJvcl9zdGF0
ZV9idWYgKm0sCiAJCWVycl9wcmludGYobSwgIkdUVF9DQUNIRV9FTjogMHglMDh4XG4iLCBlcnJv
ci0+Z3R0X2NhY2hlKTsKIAogCWZvciAoZWUgPSBlcnJvci0+ZW5naW5lOyBlZTsgZWUgPSBlZS0+
bmV4dCkKLQkJZXJyb3JfcHJpbnRfZW5naW5lKG0sIGVlLCBlcnJvci0+ZXBvY2gpOworCQllcnJv
cl9wcmludF9lbmdpbmUobSwgZWUsIGVycm9yLT5jYXB0dXJlKTsKIAogCWZvciAoZWUgPSBlcnJv
ci0+ZW5naW5lOyBlZTsgZWUgPSBlZS0+bmV4dCkgewogCQljb25zdCBzdHJ1Y3QgZHJtX2k5MTVf
ZXJyb3Jfb2JqZWN0ICpvYmo7CkBAIC03NzAsNyArNzYzLDcgQEAgc3RhdGljIHZvaWQgX19lcnJf
cHJpbnRfdG9fc2dsKHN0cnVjdCBkcm1faTkxNV9lcnJvcl9zdGF0ZV9idWYgKm0sCiAJCQlmb3Ig
KGogPSAwOyBqIDwgZWUtPm51bV9yZXF1ZXN0czsgaisrKQogCQkJCWVycm9yX3ByaW50X3JlcXVl
c3QobSwgIiAiLAogCQkJCQkJICAgICZlZS0+cmVxdWVzdHNbal0sCi0JCQkJCQkgICAgZXJyb3It
PmVwb2NoKTsKKwkJCQkJCSAgICBlcnJvci0+Y2FwdHVyZSk7CiAJCX0KIAogCQlwcmludF9lcnJv
cl9vYmoobSwgZWUtPmVuZ2luZSwgInJpbmdidWZmZXIiLCBlZS0+cmluZ2J1ZmZlcik7CkBAIC0x
MTQ0LDggKzExMzcsNiBAQCBzdGF0aWMgdm9pZCBlcnJvcl9yZWNvcmRfZW5naW5lX3JlZ2lzdGVy
cyhzdHJ1Y3QgaTkxNV9ncHVfc3RhdGUgKmVycm9yLAogCX0KIAogCWVlLT5pZGxlID0gaW50ZWxf
ZW5naW5lX2lzX2lkbGUoZW5naW5lKTsKLQlpZiAoIWVlLT5pZGxlKQotCQllZS0+aGFuZ2NoZWNr
X3RpbWVzdGFtcCA9IGVuZ2luZS0+aGFuZ2NoZWNrLmFjdGlvbl90aW1lc3RhbXA7CiAJZWUtPnJl
c2V0X2NvdW50ID0gaTkxNV9yZXNldF9lbmdpbmVfY291bnQoJmRldl9wcml2LT5ncHVfZXJyb3Is
CiAJCQkJCQkgIGVuZ2luZSk7CiAKQEAgLTE2NTcsMjAgKzE2NDgsNiBAQCBzdGF0aWMgdm9pZCBj
YXB0dXJlX3BhcmFtcyhzdHJ1Y3QgaTkxNV9ncHVfc3RhdGUgKmVycm9yKQogCWk5MTVfcGFyYW1z
X2NvcHkoJmVycm9yLT5wYXJhbXMsICZpOTE1X21vZHBhcmFtcyk7CiB9CiAKLXN0YXRpYyB1bnNp
Z25lZCBsb25nIGNhcHR1cmVfZmluZF9lcG9jaChjb25zdCBzdHJ1Y3QgaTkxNV9ncHVfc3RhdGUg
KmVycm9yKQotewotCWNvbnN0IHN0cnVjdCBkcm1faTkxNV9lcnJvcl9lbmdpbmUgKmVlOwotCXVu
c2lnbmVkIGxvbmcgZXBvY2ggPSBlcnJvci0+Y2FwdHVyZTsKLQotCWZvciAoZWUgPSBlcnJvci0+
ZW5naW5lOyBlZTsgZWUgPSBlZS0+bmV4dCkgewotCQlpZiAoZWUtPmhhbmdjaGVja190aW1lc3Rh
bXAgJiYKLQkJICAgIHRpbWVfYmVmb3JlKGVlLT5oYW5nY2hlY2tfdGltZXN0YW1wLCBlcG9jaCkp
Ci0JCQllcG9jaCA9IGVlLT5oYW5nY2hlY2tfdGltZXN0YW1wOwotCX0KLQotCXJldHVybiBlcG9j
aDsKLX0KLQogc3RhdGljIHZvaWQgY2FwdHVyZV9maW5pc2goc3RydWN0IGk5MTVfZ3B1X3N0YXRl
ICplcnJvcikKIHsKIAlzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0ID0gJmVycm9yLT5pOTE1LT5nZ3R0
OwpAQCAtMTcyMiw4ICsxNjk5LDYgQEAgaTkxNV9jYXB0dXJlX2dwdV9zdGF0ZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAllcnJvci0+b3ZlcmxheSA9IGludGVsX292ZXJsYXlfY2Fw
dHVyZV9lcnJvcl9zdGF0ZShpOTE1KTsKIAllcnJvci0+ZGlzcGxheSA9IGludGVsX2Rpc3BsYXlf
Y2FwdHVyZV9lcnJvcl9zdGF0ZShpOTE1KTsKIAotCWVycm9yLT5lcG9jaCA9IGNhcHR1cmVfZmlu
ZF9lcG9jaChlcnJvcik7Ci0KIAljYXB0dXJlX2ZpbmlzaChlcnJvcik7CiAJY29tcHJlc3NfZmlu
aSgmY29tcHJlc3MpOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dw
dV9lcnJvci5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuaAppbmRleCA3
ZjFjZDBiMWZlZjcuLjRkYzM2ZDZlZTNhMiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9ncHVfZXJyb3IuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9l
cnJvci5oCkBAIC0zNCw3ICszNCw2IEBAIHN0cnVjdCBpOTE1X2dwdV9zdGF0ZSB7CiAJa3RpbWVf
dCBib290dGltZTsKIAlrdGltZV90IHVwdGltZTsKIAl1bnNpZ25lZCBsb25nIGNhcHR1cmU7Ci0J
dW5zaWduZWQgbG9uZyBlcG9jaDsKIAogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1Owog
CkBAIC04Niw3ICs4NSw2IEBAIHN0cnVjdCBpOTE1X2dwdV9zdGF0ZSB7CiAKIAkJLyogU29mdHdh
cmUgdHJhY2tlZCBzdGF0ZSAqLwogCQlib29sIGlkbGU7Ci0JCXVuc2lnbmVkIGxvbmcgaGFuZ2No
ZWNrX3RpbWVzdGFtcDsKIAkJaW50IG51bV9yZXF1ZXN0czsKIAkJdTMyIHJlc2V0X2NvdW50Owog
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ByaW9saXN0X3R5cGVzLmgg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ByaW9saXN0X3R5cGVzLmgKaW5kZXggYWU4YmIz
Y2I2MjdlLi43MzJhYWQxNDg4ODEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfcHJpb2xpc3RfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ByaW9s
aXN0X3R5cGVzLmgKQEAgLTE2LDYgKzE2LDEyIEBAIGVudW0gewogCUk5MTVfUFJJT1JJVFlfTUlO
ID0gSTkxNV9DT05URVhUX01JTl9VU0VSX1BSSU9SSVRZIC0gMSwKIAlJOTE1X1BSSU9SSVRZX05P
Uk1BTCA9IEk5MTVfQ09OVEVYVF9ERUZBVUxUX1BSSU9SSVRZLAogCUk5MTVfUFJJT1JJVFlfTUFY
ID0gSTkxNV9DT05URVhUX01BWF9VU0VSX1BSSU9SSVRZICsgMSwKKworCS8qIEEgcHJlZW1wdGl2
ZSBwdWxzZSB1c2VkIHRvIG1vbml0b3IgdGhlIGhlYWx0aCBvZiBlYWNoIGVuZ2luZSAqLworCUk5
MTVfUFJJT1JJVFlfSEVBUlRCRUFULAorCisJLyogSW50ZXJhY3RpdmUgd29ya2xvYWQsIHNjaGVk
dWxlZCBmb3IgaW1tZWRpYXRlIHBhZ2VmbGlwcGluZyAqLworCUk5MTVfUFJJT1JJVFlfRElTUExB
WSwKIH07CiAKICNkZWZpbmUgSTkxNV9VU0VSX1BSSU9SSVRZX1NISUZUIDIKLS0gCjIuMjQuMC5y
YzAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVs
LWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczov
L2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

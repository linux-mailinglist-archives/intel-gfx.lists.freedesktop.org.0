Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id BEC0B178DA
	for <lists+intel-gfx@lfdr.de>; Wed,  8 May 2019 13:50:19 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 35B89891DB;
	Wed,  8 May 2019 11:50:18 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga06.intel.com (mga06.intel.com [134.134.136.31])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 646BB891DB
 for <intel-gfx@lists.freedesktop.org>; Wed,  8 May 2019 11:50:17 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga005.fm.intel.com ([10.253.24.32])
 by orsmga104.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 08 May 2019 04:50:16 -0700
X-ExtLoop1: 1
Received: from jzapadkx-mobl1.ger.corp.intel.com (HELO [10.252.0.159])
 ([10.252.0.159])
 by fmsmga005.fm.intel.com with ESMTP; 08 May 2019 04:50:15 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20190508080704.24223-7-chris@chris-wilson.co.uk>
 <20190508112452.18942-1-chris@chris-wilson.co.uk>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <78b5394b-6686-6114-3245-77a662989b23@linux.intel.com>
Date: Wed, 8 May 2019 12:50:14 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.6.1
MIME-Version: 1.0
In-Reply-To: <20190508112452.18942-1-chris@chris-wilson.co.uk>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH] drm/i915: Seal races between async GPU
 cancellation, retirement and signaling
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDA4LzA1LzIwMTkgMTI6MjQsIENocmlzIFdpbHNvbiB3cm90ZToKPiBDdXJyZW50bHkgdGhl
cmUgaXMgYW4gdW5kZXJseWluZyBhc3N1bXB0aW9uIHRoYXQgaTkxNV9yZXF1ZXN0X3Vuc3VibWl0
KCkKPiBpcyBzeW5jaHJvbm91cyB3cnQgdGhlIEdQVSAtLSB0aGF0IGlzIHRoZSByZXF1ZXN0IGlz
IG5vIGxvbmdlciBpbiBmbGlnaHQKPiBhcyB3ZSByZW1vdmUgaXQuIEluIHRoZSBuZWFyIGZ1dHVy
ZSB0aGF0IG1heSBjaGFuZ2UsIGFuZCB0aGlzIG1heSB1cHNldAo+IG91ciBzaWduYWxpbmcgYXMg
d2UgY2FuIHByb2Nlc3MgYW4gaW50ZXJydXB0IGZvciB0aGF0IHJlcXVlc3Qgd2hpbGUgaXQKPiBp
cyBubyBsb25nZXIgaW4gZmxpZ2h0Lgo+IAo+IENQVTAJCQkJCUNQVTEKPiBpbnRlbF9lbmdpbmVf
YnJlYWRjcnVtYnNfaXJxCj4gKHF1ZXVlIHJlcXVlc3QgY29tcGxldGlvbikKPiAJCQkJCWk5MTVf
cmVxdWVzdF9jYW5jZWxfc2lnbmFsaW5nCj4gLi4uCQkJCQkuLi4KPiAJCQkJCWk5MTVfcmVxdWVz
dF9lbmFibGVfc2lnbmFsaW5nCj4gZG1hX2ZlbmNlX3NpZ25hbAo+IAo+IEhlbmNlIGluIHRoZSB0
aW1lIGl0IHRvb2sgdXMgdG8gZHJvcCB0aGUgbG9jayB0byBzaWduYWwgdGhlIHJlcXVlc3QsIGEK
PiBwcmVlbXB0aW9uIGV2ZW50IG1heSBoYXZlIG9jY3VycmVkIGFuZCByZS1xdWV1ZWQgdGhlIHJl
cXVlc3QuIEluIHRoZQo+IHByb2Nlc3MsIHRoYXQgcmVxdWVzdCB3b3VsZCBoYXZlIHNlZW4gSTkx
NV9GRU5DRV9GTEFHX1NJR05BTCBjbGVhciBhbmQKPiBzbyByZXVzZWQgdGhlIHJxLT5zaWduYWxf
bGluayB0aGF0IHdhcyBpbiB1c2Ugb24gQ1BVMCwgbGVhZGluZyB0byBiYWQKPiBwb2ludGVyIGNo
YXNpbmcgaW4gaW50ZWxfZW5naW5lX2JyZWFkY3J1bWJzX2lycS4KPiAKPiBBIHJlbGF0ZWQgaXNz
dWUgd2FzIHRoYXQgaWYgc29tZW9uZSBzdGFydGVkIGxpc3RlbmluZyBmb3IgYSBzaWduYWwgb24g
YQo+IGNvbXBsZXRlZCBidXQgbm8gbG9uZ2VyIGluLWZsaWdodCByZXF1ZXN0LCB3ZSBtaXNzZWQg
dGhlIG9wcG9ydHVuaXR5IHRvCj4gaW1tZWRpYXRlbHkgc2lnbmFsIHRoYXQgcmVxdWVzdC4KPiAK
PiBGdXJ0aGVybW9yZSwgYXMgaW50ZWxfY29udGV4dHMgbWF5IGJlIGltbWVkaWF0ZWx5IHJlbGVh
c2VkIGR1cmluZwo+IHJlcXVlc3QgcmV0aXJlbWVudCwgaW4gb3JkZXIgdG8gYmUgZW50aXJlbHkg
c3VyZSB0aGF0Cj4gaW50ZWxfZW5naW5lX2JyZWFkY3J1bWJzX2lycSBtYXkgbm8gbG9uZ2VyIGRl
cmVmZXJlbmNlIHRoZSBpbnRlbF9jb250ZXh0Cj4gKGNlLT5zaWduYWxzIGFuZCBjZS0+c2lnbmFs
X2xpbmspLCB3ZSBtdXN0IHdhaXQgZm9yIGlycSBzcGlubG9jay4KPiAKPiBJbiBvcmRlciB0byBw
cmV2ZW50IHRoZSByYWNlLCB3ZSB1c2UgYSBiaXQgaW4gdGhlIGZlbmNlLmZsYWdzIHRvIHNpZ25h
bAo+IHRoZSB0cmFuc2ZlciBvbnRvIHRoZSBzaWduYWwgbGlzdCBpbnNpZGUgaW50ZWxfZW5naW5l
X2JyZWFkY3J1bWJzX2lycS4KPiBGb3Igc2ltcGxpY2l0eSwgd2UgdXNlIHRoZSBETUFfRkVOQ0Vf
RkxBR19TSUdOQUxFRF9CSVQgYXMgaXQgdGhlbgo+IHF1aWNrbHkgc2lnbmFscyB0byBhbnkgb3V0
c2lkZSBvYnNlcnZlciB0aGF0IHRoZSBmZW5jZSBpcyBpbmRlZWQgc2lnbmFsZWQuCj4gCj4gdjI6
IFNrZXRjaCBvdXQgcG90ZW50aWFsIGRtYS1mZW5jZSBBUEkgZm9yIG1hbnVhbCBzaWduYWxpbmcK
PiB2MzogQW5kIHRoZSB0ZXN0X2FuZF9zZXRfYml0KCkKPiAKPiBGaXhlczogNTJjMGZkYjI1Yzdj
ICgiZHJtL2k5MTU6IFJlcGxhY2UgZ2xvYmFsIGJyZWFkY3J1bWJzIHdpdGggcGVyLWNvbnRleHQg
aW50ZXJydXB0IHRyYWNraW5nIikKPiBTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlz
QGNocmlzLXdpbHNvbi5jby51az4KPiBDYzogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGlu
QGludGVsLmNvbT4KPiAtLS0KPiAgIGRyaXZlcnMvZG1hLWJ1Zi9kbWEtZmVuY2UuYyAgICAgICAg
ICAgICAgICAgfCAgMSArCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9icmVhZGNy
dW1icy5jIHwgNzggKysrKysrKysrKysrKysrLS0tLS0tCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3JlcXVlc3QuYyAgICAgICAgIHwgIDEgKwo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfZ3VjX3N1Ym1pc3Npb24uYyB8ICAxIC0KPiAgIDQgZmlsZXMgY2hhbmdlZCwgNTkgaW5z
ZXJ0aW9ucygrKSwgMjIgZGVsZXRpb25zKC0pCj4gCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZG1h
LWJ1Zi9kbWEtZmVuY2UuYyBiL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtZmVuY2UuYwo+IGluZGV4IDNh
YTg3MzNmODMyYS4uOWJmMDYwNDI2MTlhIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9k
bWEtZmVuY2UuYwo+ICsrKyBiL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtZmVuY2UuYwo+IEBAIC0yOSw2
ICsyOSw3IEBACj4gICAKPiAgIEVYUE9SVF9UUkFDRVBPSU5UX1NZTUJPTChkbWFfZmVuY2VfZW1p
dCk7Cj4gICBFWFBPUlRfVFJBQ0VQT0lOVF9TWU1CT0woZG1hX2ZlbmNlX2VuYWJsZV9zaWduYWwp
Owo+ICtFWFBPUlRfVFJBQ0VQT0lOVF9TWU1CT0woZG1hX2ZlbmNlX3NpZ25hbGVkKTsKPiAgIAo+
ICAgc3RhdGljIERFRklORV9TUElOTE9DSyhkbWFfZmVuY2Vfc3R1Yl9sb2NrKTsKPiAgIHN0YXRp
YyBzdHJ1Y3QgZG1hX2ZlbmNlIGRtYV9mZW5jZV9zdHViOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9icmVhZGNydW1icy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfYnJlYWRjcnVtYnMuYwo+IGluZGV4IGZlNDU1ZjAxYWE2NS4uYzA5MmJkZjVm
MGJmIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2JyZWFkY3J1
bWJzLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9icmVhZGNydW1icy5j
Cj4gQEAgLTIzLDYgKzIzLDcgQEAKPiAgICAqLwo+ICAgCj4gICAjaW5jbHVkZSA8bGludXgva3Ro
cmVhZC5oPgo+ICsjaW5jbHVkZSA8dHJhY2UvZXZlbnRzL2RtYV9mZW5jZS5oPgo+ICAgI2luY2x1
ZGUgPHVhcGkvbGludXgvc2NoZWQvdHlwZXMuaD4KPiAgIAo+ICAgI2luY2x1ZGUgImk5MTVfZHJ2
LmgiCj4gQEAgLTk2LDkgKzk3LDM5IEBAIGNoZWNrX3NpZ25hbF9vcmRlcihzdHJ1Y3QgaW50ZWxf
Y29udGV4dCAqY2UsIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQo+ICAgCXJldHVybiB0cnVlOwo+
ICAgfQo+ICAgCj4gK3N0YXRpYyBib29sCj4gK19fZG1hX2ZlbmNlX3NpZ25hbChzdHJ1Y3QgZG1h
X2ZlbmNlICpmZW5jZSkKPiArewo+ICsJcmV0dXJuICF0ZXN0X2FuZF9zZXRfYml0KERNQV9GRU5D
RV9GTEFHX1NJR05BTEVEX0JJVCwgJmZlbmNlLT5mbGFncyk7Cj4gK30KPiArCj4gK3N0YXRpYyB2
b2lkCj4gK19fZG1hX2ZlbmNlX3NpZ25hbF9fdGltZXN0YW1wKHN0cnVjdCBkbWFfZmVuY2UgKmZl
bmNlLCBrdGltZV90IHRpbWVzdGFtcCkKPiArewo+ICsJZmVuY2UtPnRpbWVzdGFtcCA9IHRpbWVz
dGFtcDsKPiArCXNldF9iaXQoRE1BX0ZFTkNFX0ZMQUdfVElNRVNUQU1QX0JJVCwgJmZlbmNlLT5m
bGFncyk7Cj4gKwl0cmFjZV9kbWFfZmVuY2Vfc2lnbmFsZWQoZmVuY2UpOwo+ICt9Cj4gKwo+ICtz
dGF0aWMgdm9pZAo+ICtfX2RtYV9mZW5jZV9zaWduYWxfX25vdGlmeShzdHJ1Y3QgZG1hX2ZlbmNl
ICpmZW5jZSkKPiArewo+ICsJc3RydWN0IGRtYV9mZW5jZV9jYiAqY3VyLCAqdG1wOwo+ICsKPiAr
CWxvY2tkZXBfYXNzZXJ0X2hlbGQoZmVuY2UtPmxvY2spOwo+ICsJbG9ja2RlcF9hc3NlcnRfaXJx
c19kaXNhYmxlZCgpOwo+ICsKPiArCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShjdXIsIHRtcCwg
JmZlbmNlLT5jYl9saXN0LCBub2RlKSB7Cj4gKwkJSU5JVF9MSVNUX0hFQUQoJmN1ci0+bm9kZSk7
Cj4gKwkJY3VyLT5mdW5jKGZlbmNlLCBjdXIpOwo+ICsJfQo+ICsJSU5JVF9MSVNUX0hFQUQoJmZl
bmNlLT5jYl9saXN0KTsKPiArfQo+ICsKPiAgIHZvaWQgaW50ZWxfZW5naW5lX2JyZWFkY3J1bWJz
X2lycShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gICB7Cj4gICAJc3RydWN0IGlu
dGVsX2JyZWFkY3J1bWJzICpiID0gJmVuZ2luZS0+YnJlYWRjcnVtYnM7Cj4gKwljb25zdCBrdGlt
ZV90IHRpbWVzdGFtcCA9IGt0aW1lX2dldCgpOwo+ICAgCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpj
ZSwgKmNuOwo+ICAgCXN0cnVjdCBsaXN0X2hlYWQgKnBvcywgKm5leHQ7Cj4gICAJTElTVF9IRUFE
KHNpZ25hbCk7Cj4gQEAgLTEyMiw2ICsxNTMsMTAgQEAgdm9pZCBpbnRlbF9lbmdpbmVfYnJlYWRj
cnVtYnNfaXJxKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiAgIAo+ICAgCQkJR0VN
X0JVR19PTighdGVzdF9iaXQoSTkxNV9GRU5DRV9GTEFHX1NJR05BTCwKPiAgIAkJCQkJICAgICAm
cnEtPmZlbmNlLmZsYWdzKSk7Cj4gKwkJCWNsZWFyX2JpdChJOTE1X0ZFTkNFX0ZMQUdfU0lHTkFM
LCAmcnEtPmZlbmNlLmZsYWdzKTsKPiArCj4gKwkJCWlmICghX19kbWFfZmVuY2Vfc2lnbmFsKCZy
cS0+ZmVuY2UpKQo+ICsJCQkJY29udGludWU7Cj4gICAKPiAgIAkJCS8qCj4gICAJCQkgKiBRdWV1
ZSBmb3IgZXhlY3V0aW9uIGFmdGVyIGRyb3BwaW5nIHRoZSBzaWduYWxpbmcKPiBAQCAtMTI5LDE0
ICsxNjQsNiBAQCB2b2lkIGludGVsX2VuZ2luZV9icmVhZGNydW1ic19pcnEoc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lKQo+ICAgCQkJICogbW9yZSBzaWduYWxlcnMgdG8gdGhlIHNhbWUg
Y29udGV4dCBvciBlbmdpbmUuCj4gICAJCQkgKi8KPiAgIAkJCWk5MTVfcmVxdWVzdF9nZXQocnEp
Owo+IC0KPiAtCQkJLyoKPiAtCQkJICogV2UgbWF5IHJhY2Ugd2l0aCBkaXJlY3QgaW52b2NhdGlv
biBvZgo+IC0JCQkgKiBkbWFfZmVuY2Vfc2lnbmFsKCksIGUuZy4gaTkxNV9yZXF1ZXN0X3JldGly
ZSgpLAo+IC0JCQkgKiBzbyB3ZSBuZWVkIHRvIGFjcXVpcmUgb3VyIHJlZmVyZW5jZSB0byB0aGUg
cmVxdWVzdAo+IC0JCQkgKiBiZWZvcmUgd2UgY2FuY2VsIHRoZSBicmVhZGNydW1iLgo+IC0JCQkg
Ki8KPiAtCQkJY2xlYXJfYml0KEk5MTVfRkVOQ0VfRkxBR19TSUdOQUwsICZycS0+ZmVuY2UuZmxh
Z3MpOwo+ICAgCQkJbGlzdF9hZGRfdGFpbCgmcnEtPnNpZ25hbF9saW5rLCAmc2lnbmFsKTsKPiAg
IAkJfQo+ICAgCj4gQEAgLTE1OSw3ICsxODYsMTIgQEAgdm9pZCBpbnRlbF9lbmdpbmVfYnJlYWRj
cnVtYnNfaXJxKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiAgIAkJc3RydWN0IGk5
MTVfcmVxdWVzdCAqcnEgPQo+ICAgCQkJbGlzdF9lbnRyeShwb3MsIHR5cGVvZigqcnEpLCBzaWdu
YWxfbGluayk7Cj4gICAKPiAtCQlkbWFfZmVuY2Vfc2lnbmFsKCZycS0+ZmVuY2UpOwo+ICsJCV9f
ZG1hX2ZlbmNlX3NpZ25hbF9fdGltZXN0YW1wKCZycS0+ZmVuY2UsIHRpbWVzdGFtcCk7Cj4gKwo+
ICsJCXNwaW5fbG9jaygmcnEtPmxvY2spOwo+ICsJCV9fZG1hX2ZlbmNlX3NpZ25hbF9fbm90aWZ5
KCZycS0+ZmVuY2UpOwo+ICsJCXNwaW5fdW5sb2NrKCZycS0+bG9jayk7Cj4gKwo+ICAgCQlpOTE1
X3JlcXVlc3RfcHV0KHJxKTsKPiAgIAl9Cj4gICB9Cj4gQEAgLTI2MSwxOSArMjkzLDE3IEBAIHZv
aWQgaW50ZWxfZW5naW5lX2ZpbmlfYnJlYWRjcnVtYnMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lKQo+ICAgCj4gICBib29sIGk5MTVfcmVxdWVzdF9lbmFibGVfYnJlYWRjcnVtYihzdHJ1
Y3QgaTkxNV9yZXF1ZXN0ICpycSkKPiAgIHsKPiAtCXN0cnVjdCBpbnRlbF9icmVhZGNydW1icyAq
YiA9ICZycS0+ZW5naW5lLT5icmVhZGNydW1iczsKPiAtCj4gLQlHRU1fQlVHX09OKHRlc3RfYml0
KEk5MTVfRkVOQ0VfRkxBR19TSUdOQUwsICZycS0+ZmVuY2UuZmxhZ3MpKTsKPiArCWxvY2tkZXBf
YXNzZXJ0X2hlbGQoJnJxLT5sb2NrKTsKPiArCWxvY2tkZXBfYXNzZXJ0X2lycXNfZGlzYWJsZWQo
KTsKPiAgIAo+IC0JaWYgKCF0ZXN0X2JpdChJOTE1X0ZFTkNFX0ZMQUdfQUNUSVZFLCAmcnEtPmZl
bmNlLmZsYWdzKSkKPiAtCQlyZXR1cm4gdHJ1ZTsKPiAtCj4gLQlzcGluX2xvY2soJmItPmlycV9s
b2NrKTsKPiAtCWlmICh0ZXN0X2JpdChJOTE1X0ZFTkNFX0ZMQUdfQUNUSVZFLCAmcnEtPmZlbmNl
LmZsYWdzKSAmJgo+IC0JICAgICFfX3JlcXVlc3RfY29tcGxldGVkKHJxKSkgewo+ICsJaWYgKHRl
c3RfYml0KEk5MTVfRkVOQ0VfRkxBR19BQ1RJVkUsICZycS0+ZmVuY2UuZmxhZ3MpKSB7Cj4gKwkJ
c3RydWN0IGludGVsX2JyZWFkY3J1bWJzICpiID0gJnJxLT5lbmdpbmUtPmJyZWFkY3J1bWJzOwo+
ICAgCQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UgPSBycS0+aHdfY29udGV4dDsKPiAgIAkJc3Ry
dWN0IGxpc3RfaGVhZCAqcG9zOwo+ICAgCj4gKwkJc3Bpbl9sb2NrKCZiLT5pcnFfbG9jayk7Cj4g
KwkJR0VNX0JVR19PTih0ZXN0X2JpdChJOTE1X0ZFTkNFX0ZMQUdfU0lHTkFMLCAmcnEtPmZlbmNl
LmZsYWdzKSk7Cj4gKwo+ICAgCQlfX2ludGVsX2JyZWFkY3J1bWJzX2FybV9pcnEoYik7Cj4gICAK
PiAgIAkJLyoKPiBAQCAtMzAzLDggKzMzMyw4IEBAIGJvb2wgaTkxNV9yZXF1ZXN0X2VuYWJsZV9i
cmVhZGNydW1iKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQo+ICAgCQlHRU1fQlVHX09OKCFjaGVj
a19zaWduYWxfb3JkZXIoY2UsIHJxKSk7Cj4gICAKPiAgIAkJc2V0X2JpdChJOTE1X0ZFTkNFX0ZM
QUdfU0lHTkFMLCAmcnEtPmZlbmNlLmZsYWdzKTsKPiArCQlzcGluX3VubG9jaygmYi0+aXJxX2xv
Y2spOwo+ICAgCX0KPiAtCXNwaW5fdW5sb2NrKCZiLT5pcnFfbG9jayk7Cj4gICAKPiAgIAlyZXR1
cm4gIV9fcmVxdWVzdF9jb21wbGV0ZWQocnEpOwo+ICAgfQo+IEBAIC0zMTMsOSArMzQzLDE1IEBA
IHZvaWQgaTkxNV9yZXF1ZXN0X2NhbmNlbF9icmVhZGNydW1iKHN0cnVjdCBpOTE1X3JlcXVlc3Qg
KnJxKQo+ICAgewo+ICAgCXN0cnVjdCBpbnRlbF9icmVhZGNydW1icyAqYiA9ICZycS0+ZW5naW5l
LT5icmVhZGNydW1iczsKPiAgIAo+IC0JaWYgKCF0ZXN0X2JpdChJOTE1X0ZFTkNFX0ZMQUdfU0lH
TkFMLCAmcnEtPmZlbmNlLmZsYWdzKSkKPiAtCQlyZXR1cm47Cj4gKwlsb2NrZGVwX2Fzc2VydF9o
ZWxkKCZycS0+bG9jayk7Cj4gKwlsb2NrZGVwX2Fzc2VydF9pcnFzX2Rpc2FibGVkKCk7Cj4gICAK
PiArCS8qCj4gKwkgKiBXZSBtdXN0IHdhaXQgZm9yIGItPmlycV9sb2NrIHNvIHRoYXQgd2Uga25v
dyB0aGUgaW50ZXJydXB0IGhhbmRsZXIKPiArCSAqIGhhcyByZWxlYXNlZCBpdHMgcmVmZXJlbmNl
IHRvIHRoZSBpbnRlbF9jb250ZXh0IGFuZCBoYXMgY29tcGxldGVkCj4gKwkgKiB0aGUgRE1BX0ZF
TkNFX0ZMQUdfU0lHTkFMRURfQklUL0k5MTVfRkVOQ0VfRkxBR19TSUdOQUwgZGFuY2UgKGlmCj4g
KwkgKiByZXF1aXJlZCkuCj4gKwkgKi8KPiAgIAlzcGluX2xvY2soJmItPmlycV9sb2NrKTsKPiAg
IAlpZiAodGVzdF9iaXQoSTkxNV9GRU5DRV9GTEFHX1NJR05BTCwgJnJxLT5mZW5jZS5mbGFncykp
IHsKPiAgIAkJc3RydWN0IGludGVsX2NvbnRleHQgKmNlID0gcnEtPmh3X2NvbnRleHQ7Cj4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMKPiBpbmRleCA5NTEwZGI1NjZhNTguLmNiZTQwOThj
ZDZlYyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYwo+
ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jCj4gQEAgLTQzNyw2ICs0
MzcsNyBAQCB2b2lkIF9faTkxNV9yZXF1ZXN0X3N1Ym1pdChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpy
ZXF1ZXN0KQo+ICAgCXNldF9iaXQoSTkxNV9GRU5DRV9GTEFHX0FDVElWRSwgJnJlcXVlc3QtPmZl
bmNlLmZsYWdzKTsKPiAgIAo+ICAgCWlmICh0ZXN0X2JpdChETUFfRkVOQ0VfRkxBR19FTkFCTEVf
U0lHTkFMX0JJVCwgJnJlcXVlc3QtPmZlbmNlLmZsYWdzKSAmJgo+ICsJICAgICF0ZXN0X2JpdChE
TUFfRkVOQ0VfRkxBR19TSUdOQUxFRF9CSVQsICZyZXF1ZXN0LT5mZW5jZS5mbGFncykgJiYKPiAg
IAkgICAgIWk5MTVfcmVxdWVzdF9lbmFibGVfYnJlYWRjcnVtYihyZXF1ZXN0KSkKPiAgIAkJaW50
ZWxfZW5naW5lX3F1ZXVlX2JyZWFkY3J1bWJzKGVuZ2luZSk7Cj4gICAKPiBkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX2d1Y19zdWJtaXNzaW9uLmMKPiBpbmRleCAzODBkODNhMmJmYjYuLmVh
MGUzNzM0ZDM3YyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNf
c3VibWlzc2lvbi5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX3N1Ym1p
c3Npb24uYwo+IEBAIC0yMyw3ICsyMyw2IEBACj4gICAgKi8KPiAgIAo+ICAgI2luY2x1ZGUgPGxp
bnV4L2NpcmNfYnVmLmg+Cj4gLSNpbmNsdWRlIDx0cmFjZS9ldmVudHMvZG1hX2ZlbmNlLmg+Cj4g
ICAKPiAgICNpbmNsdWRlICJndC9pbnRlbF9lbmdpbmVfcG0uaCIKPiAgICNpbmNsdWRlICJndC9p
bnRlbF9scmNfcmVnLmgiCj4gCgpSZXZpZXdlZC1ieTogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51
cnN1bGluQGludGVsLmNvbT4KClJlZ2FyZHMsCgpUdnJ0a28KX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1n
ZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21h
aWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

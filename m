Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 2E935BFAD1
	for <lists+intel-gfx@lfdr.de>; Thu, 26 Sep 2019 23:07:07 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id AF22C6EE05;
	Thu, 26 Sep 2019 21:07:03 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga18.intel.com (mga18.intel.com [134.134.136.126])
 by gabe.freedesktop.org (Postfix) with ESMTPS id D93666EE05
 for <intel-gfx@lists.freedesktop.org>; Thu, 26 Sep 2019 21:07:02 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga006.jf.intel.com ([10.7.209.51])
 by orsmga106.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 26 Sep 2019 14:07:01 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,553,1559545200"; d="scan'208";a="194264366"
Received: from josouza-mobl.jf.intel.com ([10.7.200.160])
 by orsmga006.jf.intel.com with ESMTP; 26 Sep 2019 14:07:01 -0700
From: =?UTF-8?q?Jos=C3=A9=20Roberto=20de=20Souza?= <jose.souza@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 26 Sep 2019 14:06:57 -0700
Message-Id: <20190926210659.56317-2-jose.souza@intel.com>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190926210659.56317-1-jose.souza@intel.com>
References: <20190926210659.56317-1-jose.souza@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH CI 2/4] drm/i915/tgl: Add dkl phy programming
 sequences
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Lucas De Marchi <lucas.demarchi@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogQ2xpbnRvbiBBIFRheWxvciA8Y2xpbnRvbi5hLnRheWxvckBpbnRlbC5jb20+CgpBZGRl
ZCBES0wgUGh5IHNlcXVlbmNlcyBhbmQgaGVscGVycyBmdW5jdGlvbnMgdG8gcHJvZ3JhbSB2b2x0
YWdlCnN3aW5nLCBjbG9jayBnYXRpbmcgYW5kIGRwIG1vZGUuCgpJdCBpcyBub3Qgd3JpdHRlbiBp
biBEUCBlbmFibGluZyBzZXF1ZW5jZSBidXQgIlBIWSBDbG9ja2dhdGluZwpwcm9ncmFtbWluZyIg
c3RhdGVzIHRoYXQgY2xvY2sgZ2F0aW5nIHNob3VsZCBiZSBlbmFibGVkIGFmdGVyIHRoZQpsaW5r
IHRyYWluaW5nIGJ1dCBkb2luZyBzbyBjYXVzZXMgYWxsIHRoZSBmb2xsb3dpbmcgdHJhaW5pbmdz
IHRvIGZhaWwKc28gbm90IGVuYWJsaW5nIGl0IGZvci4KCnYyOgpTZXR0aW5nIHRoZSByaWdodCBI
SVBfSU5ERVhfUkVHIGJpdHMgKEpvc8OpKQoKdjM6CkFkZGluZyB0aGUgbWVhbmluZyBvZiBlYWNo
IGNvbHVtbiBvZiB0Z2xfZGtsX3BoeV9kZGlfdHJhbnNsYXRpb25zCkFkZGluZyBpZiBnZW4gPj0g
MTIgb24gaW50ZWxfZGRpX2hkbWlfbGV2ZWwoKSBhbmQKaW50ZWxfZGRpX3ByZV9lbmFibGVfaGRt
aSgpIGluc3RlYWQgb2YgcmV1c2UgcGFydCBvZiBnZW4gPj0gMTEgaWYKCnY0OgpNb3ZlZCB0aGUg
RFBfTU9ERSBsYW5lIHByb2dyYW1pbmcgdG8gYW5vdGhlciBwYXRjaCBhcyBJQ0wgYWxzbwpuZWVk
ZWQgaXQKU2hhcmluZyBpY2xfcGh5X3NldF9jbG9ja19nYXRpbmcoKSBhbmQgaWNsX3Byb2dyYW1f
bWdfZHBfbW9kZSgpIHdpdGgKVEdMIGFzIGJpdHMgYW5kIHByb2dyYW1pbmcgYXMgbm93IGl0IGFs
bW9zdCBpZGVudGljYWwgdG8gSUNMCgpCU3BlYzogNDkyOTIKQlNwZWM6IDQ5MTkwCgpDYzogSW1y
ZSBEZWFrIDxpbXJlLmRlYWtAaW50ZWwuY29tPgpDYzogTHVjYXMgRGUgTWFyY2hpIDxsdWNhcy5k
ZW1hcmNoaUBpbnRlbC5jb20+ClJldmlld2VkLWJ5OiBJbXJlIERlYWsgPGltcmUuZGVha0BpbnRl
bC5jb20+ClNpZ25lZC1vZmYtYnk6IEpvc8OpIFJvYmVydG8gZGUgU291emEgPGpvc2Uuc291emFA
aW50ZWwuY29tPgpTaWduZWQtb2ZmLWJ5OiBDbGludG9uIEEgVGF5bG9yIDxjbGludG9uLmEudGF5
bG9yQGludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rk
aS5jIHwgMTc0ICsrKysrKysrKysrKysrKysrKysrLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3JlZy5oICAgICAgICAgIHwgICA4IC0tCiAyIGZpbGVzIGNoYW5nZWQsIDE1NCBpbnNlcnRp
b25zKCspLCAyOCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2RkaS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9kZGkuYwppbmRleCAyMDM5M2QzOWEyOWEuLmI0NjNlNTFmOGI0NSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGkuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2RkaS5jCkBAIC01ODYsNiArNTg2LDI2IEBAIHN0YXRpYyBj
b25zdCBzdHJ1Y3QgaWNsX21nX3BoeV9kZGlfYnVmX3RyYW5zIGljbF9tZ19waHlfZGRpX3RyYW5z
bGF0aW9uc1tdID0gewogCXsgMHgwLCAweDAwLCAweDAwIH0sCS8qIDMgICAgICAgICAgICAgIDAg
ICAqLwogfTsKIAorc3RydWN0IHRnbF9ka2xfcGh5X2RkaV9idWZfdHJhbnMgeworCXUzMiBka2xf
dnN3aW5nX2NvbnRyb2w7CisJdTMyIGRrbF9wcmVzaG9vdF9jb250cm9sOworCXUzMiBka2xfZGVf
ZW1waGFzaXNfY29udHJvbDsKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgdGdsX2RrbF9waHlf
ZGRpX2J1Zl90cmFucyB0Z2xfZGtsX3BoeV9kZGlfdHJhbnNsYXRpb25zW10gPSB7CisJCQkJLyog
VlMJcHJlLWVtcAlOb24tdHJhbnMgbVYJUHJlLWVtcGggZEIgKi8KKwl7IDB4NywgMHgwLCAweDAw
IH0sCS8qIDAJMAk0MDBtVgkJMCBkQiAqLworCXsgMHg1LCAweDAsIDB4MDMgfSwJLyogMAkxCTQw
MG1WCQkzLjUgZEIgKi8KKwl7IDB4MiwgMHgwLCAweDBiIH0sCS8qIDAJMgk0MDBtVgkJNiBkQiAq
LworCXsgMHgwLCAweDAsIDB4MTkgfSwJLyogMAkzCTQwMG1WCQk5LjUgZEIgKi8KKwl7IDB4NSwg
MHgwLCAweDAwIH0sCS8qIDEJMAk2MDBtVgkJMCBkQiAqLworCXsgMHgyLCAweDAsIDB4MDMgfSwJ
LyogMQkxCTYwMG1WCQkzLjUgZEIgKi8KKwl7IDB4MCwgMHgwLCAweDE0IH0sCS8qIDEJMgk2MDBt
VgkJNiBkQiAqLworCXsgMHgyLCAweDAsIDB4MDAgfSwJLyogMgkwCTgwMG1WCQkwIGRCICovCisJ
eyAweDAsIDB4MCwgMHgwQiB9LAkvKiAyCTEJODAwbVYJCTMuNSBkQiAqLworCXsgMHgwLCAweDAs
IDB4MDAgfSwJLyogMwkwCTEyMDBtVgkJMCBkQiBIRE1JIGRlZmF1bHQgKi8KK307CisKIHN0YXRp
YyBjb25zdCBzdHJ1Y3QgZGRpX2J1Zl90cmFucyAqCiBiZHdfZ2V0X2J1Zl90cmFuc19lZHAoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgKm5fZW50cmllcykKIHsKQEAgLTg3
Miw3ICs4OTIsMTQgQEAgc3RhdGljIGludCBpbnRlbF9kZGlfaGRtaV9sZXZlbChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcG9ydCBwb3IKIAogCWxldmVsID0gZGV2X3By
aXYtPnZidC5kZGlfcG9ydF9pbmZvW3BvcnRdLmhkbWlfbGV2ZWxfc2hpZnQ7CiAKLQlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA+PSAxMSkgeworCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEy
KSB7CisJCWlmIChpbnRlbF9waHlfaXNfY29tYm8oZGV2X3ByaXYsIHBoeSkpCisJCQlpY2xfZ2V0
X2NvbWJvX2J1Zl90cmFucyhkZXZfcHJpdiwgSU5URUxfT1VUUFVUX0hETUksCisJCQkJCQkwLCAm
bl9lbnRyaWVzKTsKKwkJZWxzZQorCQkJbl9lbnRyaWVzID0gQVJSQVlfU0laRSh0Z2xfZGtsX3Bo
eV9kZGlfdHJhbnNsYXRpb25zKTsKKwkJZGVmYXVsdF9lbnRyeSA9IG5fZW50cmllcyAtIDE7CisJ
fSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID09IDExKSB7CiAJCWlmIChpbnRlbF9waHlf
aXNfY29tYm8oZGV2X3ByaXYsIHBoeSkpCiAJCQlpY2xfZ2V0X2NvbWJvX2J1Zl90cmFucyhkZXZf
cHJpdiwgSU5URUxfT1VUUFVUX0hETUksCiAJCQkJCQkwLCAmbl9lbnRyaWVzKTsKQEAgLTIzMzQs
NyArMjM2MSwxMyBAQCB1OCBpbnRlbF9kZGlfZHBfdm9sdGFnZV9tYXgoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmVuY29kZXIpCiAJZW51bSBwaHkgcGh5ID0gaW50ZWxfcG9ydF90b19waHkoZGV2X3By
aXYsIHBvcnQpOwogCWludCBuX2VudHJpZXM7CiAKLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+
PSAxMSkgeworCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEyKSB7CisJCWlmIChpbnRlbF9w
aHlfaXNfY29tYm8oZGV2X3ByaXYsIHBoeSkpCisJCQlpY2xfZ2V0X2NvbWJvX2J1Zl90cmFucyhk
ZXZfcHJpdiwgZW5jb2Rlci0+dHlwZSwKKwkJCQkJCWludGVsX2RwLT5saW5rX3JhdGUsICZuX2Vu
dHJpZXMpOworCQllbHNlCisJCQluX2VudHJpZXMgPSBBUlJBWV9TSVpFKHRnbF9ka2xfcGh5X2Rk
aV90cmFuc2xhdGlvbnMpOworCX0gZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA9PSAxMSkg
ewogCQlpZiAoaW50ZWxfcGh5X2lzX2NvbWJvKGRldl9wcml2LCBwaHkpKQogCQkJaWNsX2dldF9j
b21ib19idWZfdHJhbnMoZGV2X3ByaXYsIGVuY29kZXItPnR5cGUsCiAJCQkJCQlpbnRlbF9kcC0+
bGlua19yYXRlLCAmbl9lbnRyaWVzKTsKQEAgLTI3NzYsNiArMjgwOSw2MiBAQCBzdGF0aWMgdm9p
ZCBpY2xfZGRpX3Zzd2luZ19zZXF1ZW5jZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwK
IAkJaWNsX21nX3BoeV9kZGlfdnN3aW5nX3NlcXVlbmNlKGVuY29kZXIsIGxpbmtfY2xvY2ssIGxl
dmVsKTsKIH0KIAorc3RhdGljIHZvaWQKK3RnbF9ka2xfcGh5X2RkaV92c3dpbmdfc2VxdWVuY2Uo
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsIGludCBsaW5rX2Nsb2NrLAorCQkJCXUzMiBs
ZXZlbCkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVu
Y29kZXItPmJhc2UuZGV2KTsKKwllbnVtIHRjX3BvcnQgdGNfcG9ydCA9IGludGVsX3BvcnRfdG9f
dGMoZGV2X3ByaXYsIGVuY29kZXItPnBvcnQpOworCWNvbnN0IHN0cnVjdCB0Z2xfZGtsX3BoeV9k
ZGlfYnVmX3RyYW5zICpkZGlfdHJhbnNsYXRpb25zOworCXUzMiBuX2VudHJpZXMsIHZhbCwgbG4s
IGRwY250X21hc2ssIGRwY250X3ZhbDsKKworCW5fZW50cmllcyA9IEFSUkFZX1NJWkUodGdsX2Rr
bF9waHlfZGRpX3RyYW5zbGF0aW9ucyk7CisJZGRpX3RyYW5zbGF0aW9ucyA9IHRnbF9ka2xfcGh5
X2RkaV90cmFuc2xhdGlvbnM7CisKKwlpZiAobGV2ZWwgPj0gbl9lbnRyaWVzKQorCQlsZXZlbCA9
IG5fZW50cmllcyAtIDE7CisKKwlkcGNudF9tYXNrID0gKERLTF9UWF9QUkVTSE9PVF9DT0VGRl9N
QVNLIHwKKwkJICAgICAgREtMX1RYX0RFX0VNUEFIU0lTX0NPRUZGX01BU0sgfAorCQkgICAgICBE
S0xfVFhfVlNXSU5HX0NPTlRST0xfTUFTSyk7CisJZHBjbnRfdmFsID0gREtMX1RYX1ZTV0lOR19D
T05UUk9MKGRkaV90cmFuc2xhdGlvbnNbbGV2ZWxdLmRrbF92c3dpbmdfY29udHJvbCk7CisJZHBj
bnRfdmFsIHw9IERLTF9UWF9ERV9FTVBIQVNJU19DT0VGRihkZGlfdHJhbnNsYXRpb25zW2xldmVs
XS5ka2xfZGVfZW1waGFzaXNfY29udHJvbCk7CisJZHBjbnRfdmFsIHw9IERLTF9UWF9QUkVTSE9P
VF9DT0VGRihkZGlfdHJhbnNsYXRpb25zW2xldmVsXS5ka2xfcHJlc2hvb3RfY29udHJvbCk7CisK
Kwlmb3IgKGxuID0gMDsgbG4gPCAyOyBsbisrKSB7CisJCUk5MTVfV1JJVEUoSElQX0lOREVYX1JF
Ryh0Y19wb3J0KSwgSElQX0lOREVYX1ZBTCh0Y19wb3J0LCBsbikpOworCisJCS8qIEFsbCB0aGUg
cmVnaXN0ZXJzIGFyZSBSTVcgKi8KKwkJdmFsID0gSTkxNV9SRUFEKERLTF9UWF9EUENOVEwwKHRj
X3BvcnQpKTsKKwkJdmFsICY9IH5kcGNudF9tYXNrOworCQl2YWwgfD0gZHBjbnRfdmFsOworCQlJ
OTE1X1dSSVRFKERLTF9UWF9EUENOVEwwKHRjX3BvcnQpLCB2YWwpOworCisJCXZhbCA9IEk5MTVf
UkVBRChES0xfVFhfRFBDTlRMMSh0Y19wb3J0KSk7CisJCXZhbCAmPSB+ZHBjbnRfbWFzazsKKwkJ
dmFsIHw9IGRwY250X3ZhbDsKKwkJSTkxNV9XUklURShES0xfVFhfRFBDTlRMMSh0Y19wb3J0KSwg
dmFsKTsKKworCQl2YWwgPSBJOTE1X1JFQUQoREtMX1RYX0RQQ05UTDIodGNfcG9ydCkpOworCQl2
YWwgJj0gfkRLTF9UWF9EUDIwQklUTU9ERTsKKwkJSTkxNV9XUklURShES0xfVFhfRFBDTlRMMih0
Y19wb3J0KSwgdmFsKTsKKwl9Cit9CisKK3N0YXRpYyB2b2lkIHRnbF9kZGlfdnN3aW5nX3NlcXVl
bmNlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorCQkJCSAgICBpbnQgbGlua19jbG9j
aywKKwkJCQkgICAgdTMyIGxldmVsLAorCQkJCSAgICBlbnVtIGludGVsX291dHB1dF90eXBlIHR5
cGUpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNv
ZGVyLT5iYXNlLmRldik7CisJZW51bSBwaHkgcGh5ID0gaW50ZWxfcG9ydF90b19waHkoZGV2X3By
aXYsIGVuY29kZXItPnBvcnQpOworCisJaWYgKGludGVsX3BoeV9pc19jb21ibyhkZXZfcHJpdiwg
cGh5KSkKKwkJaWNsX2NvbWJvX3BoeV9kZGlfdnN3aW5nX3NlcXVlbmNlKGVuY29kZXIsIGxldmVs
LCB0eXBlKTsKKwllbHNlCisJCXRnbF9ka2xfcGh5X2RkaV92c3dpbmdfc2VxdWVuY2UoZW5jb2Rl
ciwgbGlua19jbG9jaywgbGV2ZWwpOworfQorCiBzdGF0aWMgdTMyIHRyYW5zbGF0ZV9zaWduYWxf
bGV2ZWwoaW50IHNpZ25hbF9sZXZlbHMpCiB7CiAJaW50IGk7CkBAIC0yODA3LDcgKzI4OTYsMTAg
QEAgdTMyIGJ4dF9zaWduYWxfbGV2ZWxzKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCiAJc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIgPSAmZHBvcnQtPmJhc2U7CiAJaW50IGxldmVsID0g
aW50ZWxfZGRpX2RwX2xldmVsKGludGVsX2RwKTsKIAotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
ID49IDExKQorCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEyKQorCQl0Z2xfZGRpX3Zzd2lu
Z19zZXF1ZW5jZShlbmNvZGVyLCBpbnRlbF9kcC0+bGlua19yYXRlLAorCQkJCQlsZXZlbCwgZW5j
b2Rlci0+dHlwZSk7CisJZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKIAkJaWNs
X2RkaV92c3dpbmdfc2VxdWVuY2UoZW5jb2RlciwgaW50ZWxfZHAtPmxpbmtfcmF0ZSwKIAkJCQkJ
bGV2ZWwsIGVuY29kZXItPnR5cGUpOwogCWVsc2UgaWYgKElTX0NBTk5PTkxBS0UoZGV2X3ByaXYp
KQpAQCAtMzA3MSwyNCArMzE2MywzOSBAQCBpY2xfcGh5X3NldF9jbG9ja19nYXRpbmcoc3RydWN0
IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQsIGJvb2wgZW5hYmxlKQogCSAgICAgICBNR19E
UF9NT0RFX0NGR19HQU9OUFdSX0dBVElORzsKIAogCWZvciAobG4gPSAwOyBsbiA8IDI7IGxuKysp
IHsKLQkJdmFsID0gSTkxNV9SRUFEKE1HX0RQX01PREUobG4sIHBvcnQpKTsKKwkJaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPj0gMTIpIHsKKwkJCUk5MTVfV1JJVEUoSElQX0lOREVYX1JFRyh0Y19w
b3J0KSwgSElQX0lOREVYX1ZBTCh0Y19wb3J0LCBsbikpOworCQkJdmFsID0gSTkxNV9SRUFEKERL
TF9EUF9NT0RFKHRjX3BvcnQpKTsKKwkJfSBlbHNlIHsKKwkJCXZhbCA9IEk5MTVfUkVBRChNR19E
UF9NT0RFKGxuLCBwb3J0KSk7CisJCX0KKwogCQlpZiAoZW5hYmxlKQogCQkJdmFsIHw9IGJpdHM7
CiAJCWVsc2UKIAkJCXZhbCAmPSB+Yml0czsKLQkJSTkxNV9XUklURShNR19EUF9NT0RFKGxuLCBw
b3J0KSwgdmFsKTsKKworCQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMikKKwkJCUk5MTVf
V1JJVEUoREtMX0RQX01PREUodGNfcG9ydCksIHZhbCk7CisJCWVsc2UKKwkJCUk5MTVfV1JJVEUo
TUdfRFBfTU9ERShsbiwgcG9ydCksIHZhbCk7CiAJfQogCi0JYml0cyA9IE1HX01JU0NfU1VTMF9D
RkdfVFIyUFdSX0dBVElORyB8IE1HX01JU0NfU1VTMF9DRkdfQ0wyUFdSX0dBVElORyB8Ci0JICAg
ICAgIE1HX01JU0NfU1VTMF9DRkdfR0FPTlBXUl9HQVRJTkcgfCBNR19NSVNDX1NVUzBfQ0ZHX1RS
UFdSX0dBVElORyB8Ci0JICAgICAgIE1HX01JU0NfU1VTMF9DRkdfQ0wxUFdSX0dBVElORyB8IE1H
X01JU0NfU1VTMF9DRkdfREdQV1JfR0FUSU5HOworCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID09
IDExKSB7CisJCWJpdHMgPSBNR19NSVNDX1NVUzBfQ0ZHX1RSMlBXUl9HQVRJTkcgfAorCQkgICAg
ICAgTUdfTUlTQ19TVVMwX0NGR19DTDJQV1JfR0FUSU5HIHwKKwkJICAgICAgIE1HX01JU0NfU1VT
MF9DRkdfR0FPTlBXUl9HQVRJTkcgfAorCQkgICAgICAgTUdfTUlTQ19TVVMwX0NGR19UUlBXUl9H
QVRJTkcgfAorCQkgICAgICAgTUdfTUlTQ19TVVMwX0NGR19DTDFQV1JfR0FUSU5HIHwKKwkJICAg
ICAgIE1HX01JU0NfU1VTMF9DRkdfREdQV1JfR0FUSU5HOwogCi0JdmFsID0gSTkxNV9SRUFEKE1H
X01JU0NfU1VTMCh0Y19wb3J0KSk7Ci0JaWYgKGVuYWJsZSkKLQkJdmFsIHw9IChiaXRzIHwgTUdf
TUlTQ19TVVMwX1NVU0NMS19EWU5DTEtHQVRFX01PREUoMykpOwotCWVsc2UKLQkJdmFsICY9IH4o
Yml0cyB8IE1HX01JU0NfU1VTMF9TVVNDTEtfRFlOQ0xLR0FURV9NT0RFX01BU0spOwotCUk5MTVf
V1JJVEUoTUdfTUlTQ19TVVMwKHRjX3BvcnQpLCB2YWwpOworCQl2YWwgPSBJOTE1X1JFQUQoTUdf
TUlTQ19TVVMwKHRjX3BvcnQpKTsKKwkJaWYgKGVuYWJsZSkKKwkJCXZhbCB8PSAoYml0cyB8IE1H
X01JU0NfU1VTMF9TVVNDTEtfRFlOQ0xLR0FURV9NT0RFKDMpKTsKKwkJZWxzZQorCQkJdmFsICY9
IH4oYml0cyB8IE1HX01JU0NfU1VTMF9TVVNDTEtfRFlOQ0xLR0FURV9NT0RFX01BU0spOworCQlJ
OTE1X1dSSVRFKE1HX01JU0NfU1VTMCh0Y19wb3J0KSwgdmFsKTsKKwl9CiB9CiAKIHN0YXRpYyB2
b2lkCkBAIC0zMDk3LDE0ICszMjA0LDIyIEBAIGljbF9wcm9ncmFtX21nX2RwX21vZGUoc3RydWN0
IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCiB7CiAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShpbnRlbF9kaWdfcG9ydC0+YmFzZS5iYXNlLmRl
dik7CiAJZW51bSBwb3J0IHBvcnQgPSBpbnRlbF9kaWdfcG9ydC0+YmFzZS5wb3J0OworCWVudW0g
dGNfcG9ydCB0Y19wb3J0ID0gaW50ZWxfcG9ydF90b190YyhkZXZfcHJpdiwgcG9ydCk7CiAJdTMy
IGxuMCwgbG4xLCBwaW5fYXNzaWdubWVudDsKIAl1OCB3aWR0aDsKIAogCWlmIChpbnRlbF9kaWdf
cG9ydC0+dGNfbW9kZSA9PSBUQ19QT1JUX1RCVF9BTFQpCiAJCXJldHVybjsKIAotCWxuMCA9IEk5
MTVfUkVBRChNR19EUF9NT0RFKDAsIHBvcnQpKTsKLQlsbjEgPSBJOTE1X1JFQUQoTUdfRFBfTU9E
RSgxLCBwb3J0KSk7CisJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTIpIHsKKwkJSTkxNV9X
UklURShISVBfSU5ERVhfUkVHKHRjX3BvcnQpLCBISVBfSU5ERVhfVkFMKHRjX3BvcnQsIDB4MCkp
OworCQlsbjAgPSBJOTE1X1JFQUQoREtMX0RQX01PREUodGNfcG9ydCkpOworCQlJOTE1X1dSSVRF
KEhJUF9JTkRFWF9SRUcodGNfcG9ydCksIEhJUF9JTkRFWF9WQUwodGNfcG9ydCwgMHgxKSk7CisJ
CWxuMSA9IEk5MTVfUkVBRChES0xfRFBfTU9ERSh0Y19wb3J0KSk7CisJfSBlbHNlIHsKKwkJbG4w
ID0gSTkxNV9SRUFEKE1HX0RQX01PREUoMCwgcG9ydCkpOworCQlsbjEgPSBJOTE1X1JFQUQoTUdf
RFBfTU9ERSgxLCBwb3J0KSk7CisJfQogCiAJbG4wICY9IH4oTUdfRFBfTU9ERV9DRkdfRFBfWDFf
TU9ERSB8IE1HX0RQX01PREVfQ0ZHX0RQX1gxX01PREUpOwogCWxuMSAmPSB+KE1HX0RQX01PREVf
Q0ZHX0RQX1gxX01PREUgfCBNR19EUF9NT0RFX0NGR19EUF9YMl9NT0RFKTsKQEAgLTMxNTksOCAr
MzI3NCwxNSBAQCBpY2xfcHJvZ3JhbV9tZ19kcF9tb2RlKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3Bv
cnQgKmludGVsX2RpZ19wb3J0LAogCQlNSVNTSU5HX0NBU0UocGluX2Fzc2lnbm1lbnQpOwogCX0K
IAotCUk5MTVfV1JJVEUoTUdfRFBfTU9ERSgwLCBwb3J0KSwgbG4wKTsKLQlJOTE1X1dSSVRFKE1H
X0RQX01PREUoMSwgcG9ydCksIGxuMSk7CisJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTIp
IHsKKwkJSTkxNV9XUklURShISVBfSU5ERVhfUkVHKHRjX3BvcnQpLCBISVBfSU5ERVhfVkFMKHRj
X3BvcnQsIDB4MCkpOworCQlJOTE1X1dSSVRFKERLTF9EUF9NT0RFKHRjX3BvcnQpLCBsbjApOwor
CQlJOTE1X1dSSVRFKEhJUF9JTkRFWF9SRUcodGNfcG9ydCksIEhJUF9JTkRFWF9WQUwodGNfcG9y
dCwgMHgxKSk7CisJCUk5MTVfV1JJVEUoREtMX0RQX01PREUodGNfcG9ydCksIGxuMSk7CisJfSBl
bHNlIHsKKwkJSTkxNV9XUklURShNR19EUF9NT0RFKDAsIHBvcnQpLCBsbjApOworCQlJOTE1X1dS
SVRFKE1HX0RQX01PREUoMSwgcG9ydCksIGxuMSk7CisJfQogfQogCiBzdGF0aWMgdm9pZCBpbnRl
bF9kcF9zaW5rX3NldF9mZWNfcmVhZHkoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKQEAgLTMy
NjUsNyArMzM4Nyw3IEBAIHN0YXRpYyB2b2lkIHRnbF9kZGlfcHJlX2VuYWJsZV9kcChzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAlpY2xfcGh5X3NldF9jbG9ja19nYXRpbmcoZGlnX3Bv
cnQsIGZhbHNlKTsKIAogCS8qIDcuZSAqLwotCWljbF9kZGlfdnN3aW5nX3NlcXVlbmNlKGVuY29k
ZXIsIGNydGNfc3RhdGUtPnBvcnRfY2xvY2ssIGxldmVsLAorCXRnbF9kZGlfdnN3aW5nX3NlcXVl
bmNlKGVuY29kZXIsIGNydGNfc3RhdGUtPnBvcnRfY2xvY2ssIGxldmVsLAogCQkJCWVuY29kZXIt
PnR5cGUpOwogCiAJLyogNy5mICovCkBAIC0zMjk3LDYgKzM0MTksMTUgQEAgc3RhdGljIHZvaWQg
dGdsX2RkaV9wcmVfZW5hYmxlX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCS8q
IDcuayAqLwogCWludGVsX2RwX3N0b3BfbGlua190cmFpbihpbnRlbF9kcCk7CiAKKwkvKgorCSAq
IFRPRE86IGVuYWJsZSBjbG9jayBnYXRpbmcKKwkgKgorCSAqIEl0IGlzIG5vdCB3cml0dGVuIGlu
IERQIGVuYWJsaW5nIHNlcXVlbmNlIGJ1dCAiUEhZIENsb2NrZ2F0aW5nCisJICogcHJvZ3JhbW1p
bmciIHN0YXRlcyB0aGF0IGNsb2NrIGdhdGluZyBzaG91bGQgYmUgZW5hYmxlZCBhZnRlciB0aGUK
KwkgKiBsaW5rIHRyYWluaW5nIGJ1dCBkb2luZyBzbyBjYXVzZXMgYWxsIHRoZSBmb2xsb3dpbmcg
dHJhaW5pbmdzIHRvIGZhaWwKKwkgKiBzbyBub3QgZW5hYmxpbmcgaXQgZm9yIG5vdy4KKwkgKi8K
KwogCS8qIDcubCAqLwogCWludGVsX2RkaV9lbmFibGVfZmVjKGVuY29kZXIsIGNydGNfc3RhdGUp
OwogCWludGVsX2RzY19lbmFibGUoZW5jb2RlciwgY3J0Y19zdGF0ZSk7CkBAIC0zNDA0LDcgKzM1
MzUsMTAgQEAgc3RhdGljIHZvaWQgaW50ZWxfZGRpX3ByZV9lbmFibGVfaGRtaShzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlciwKIAlpY2xfcHJvZ3JhbV9tZ19kcF9tb2RlKGRpZ19wb3J0LCBj
cnRjX3N0YXRlKTsKIAlpY2xfcGh5X3NldF9jbG9ja19nYXRpbmcoZGlnX3BvcnQsIGZhbHNlKTsK
IAotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQorCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDEyKQorCQl0Z2xfZGRpX3Zzd2luZ19zZXF1ZW5jZShlbmNvZGVyLCBjcnRjX3N0YXRl
LT5wb3J0X2Nsb2NrLAorCQkJCQlsZXZlbCwgSU5URUxfT1VUUFVUX0hETUkpOworCWVsc2UgaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPT0gMTEpCiAJCWljbF9kZGlfdnN3aW5nX3NlcXVlbmNlKGVu
Y29kZXIsIGNydGNfc3RhdGUtPnBvcnRfY2xvY2ssCiAJCQkJCWxldmVsLCBJTlRFTF9PVVRQVVRf
SERNSSk7CiAJZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShkZXZfcHJpdikpCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlZy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9yZWcuaAppbmRleCBiY2Y0NDljMWQxNTIuLjdmNmI1OWFhNjM0OCAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZWcuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3JlZy5oCkBAIC0xMDI0NSwxNCArMTAyNDUsNiBAQCBlbnVtIHNrbF9wb3dlcl9nYXRlIHsK
IAkJCQkJCSAgICAgX0RLTF9UWF9EVzE4KQogCiAjZGVmaW5lIF9ES0xfRFBfTU9ERQkJCQkJMHhB
MAotI2RlZmluZSAgREtMX0RQX01PREVfQ0ZHX0dBT05QV1JfR0FUSU5HCQkoMSA8PCAxKQotI2Rl
ZmluZSAgREtMX0RQX01PREVfQ0ZHX0RJR1BXUl9HQVRJTkcJCSgxIDw8IDIpCi0jZGVmaW5lICBE
S0xfRFBfTU9ERV9DRkdfQ0xOUFdSX0dBVElORwkJKDEgPDwgMykKLSNkZWZpbmUgIERLTF9EUF9N
T0RFX0NGR19UUlBXUl9HQVRJTkcJCSgxIDw8IDQpCi0jZGVmaW5lICBES0xfRFBfTU9ERV9DRkdf
VFIyUFdSX0dBVElORwkJKDEgPDwgNSkKLSNkZWZpbmUgIERLTF9EUF9NT0RFX0NGR19HQVRJTkdf
Q1RSTF9NQVNLCSgweDFmIDw8IDEpCi0jZGVmaW5lICBES0xfRFBfTU9ERV9DRkdfRFBfWDFfTU9E
RQkJCSgxIDw8IDYpCi0jZGVmaW5lICBES0xfRFBfTU9ERV9DRkdfRFBfWDJfTU9ERQkJCSgxIDw8
IDcpCiAjZGVmaW5lIERLTF9EUF9NT0RFKHRjX3BvcnQpIF9NTUlPKF9QT1JUKHRjX3BvcnQsIFwK
IAkJCQkJCSAgICAgX0RLTF9QSFkxX0JBU0UsIFwKIAkJCQkJCSAgICAgX0RLTF9QSFkyX0JBU0Up
ICsgXAotLSAKMi4yMy4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3Rv
cC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRl
bC1nZng=

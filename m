Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 92E0365259
	for <lists+intel-gfx@lfdr.de>; Thu, 11 Jul 2019 09:21:06 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id ED2886E0A6;
	Thu, 11 Jul 2019 07:21:04 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga17.intel.com (mga17.intel.com [192.55.52.151])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8F8166E0A6
 for <intel-gfx@lists.freedesktop.org>; Thu, 11 Jul 2019 07:21:03 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga002.fm.intel.com ([10.253.24.26])
 by fmsmga107.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 11 Jul 2019 00:21:03 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,476,1557212400"; d="scan'208";a="193313688"
Received: from dawalker-mobl.ger.corp.intel.com (HELO [10.251.80.131])
 ([10.251.80.131])
 by fmsmga002.fm.intel.com with ESMTP; 11 Jul 2019 00:21:00 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20190711065215.4004-1-chris@chris-wilson.co.uk>
 <20190711065215.4004-3-chris@chris-wilson.co.uk>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <633170de-39fa-f2d8-c1b7-3aea7aeb902b@linux.intel.com>
Date: Thu, 11 Jul 2019 08:20:59 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.7.1
MIME-Version: 1.0
In-Reply-To: <20190711065215.4004-3-chris@chris-wilson.co.uk>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH 03/18] drm/i915: Lock the engine while
 dumping the active request
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Alex Shumsky <alexthreed@gmail.com>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDExLzA3LzIwMTkgMDc6NTIsIENocmlzIFdpbHNvbiB3cm90ZToKPiBXZSBjYW5ub3QgbGV0
IHRoZSByZXF1ZXN0IGJlIHJldGlyZWQgYW5kIGZyZWVkIHdoaWxlIHdlIGFyZSB0cnlpbmcgdG8K
PiBkdW1wIGl0IGR1cmluZyBlcnJvciBjYXB0dXJlLiBJdCBpcyBub3Qgc3VmZmljaWVudCBqdXN0
IHRvIGdyYWIgYQo+IHJlZmVyZW5jZSB0byB0aGUgcmVxdWVzdCwgYXMgZHVyaW5nIHJldGlyZW1l
bnQgd2UgbWF5IGZyZWUgdGhlIHJpbmcKPiB3aGljaCB3ZSBhcmUgYWxzbyBkdW1waW5nLiBTbyB0
YWtlIHRoZSBlbmdpbmUgbG9jayB0byBwcmV2ZW50IHJldGlyaW5nCj4gYW5kIGZyZWVpbmcgb2Yg
dGhlIHJlcXVlc3QuCj4gCj4gUmVwb3J0ZWQtYnk6IEFsZXggU2h1bXNreSA8YWxleHRocmVlZEBn
bWFpbC5jb20+Cj4gRml4ZXM6IDgzYzMxNzgzMmViMSAoImRybS9pOTE1OiBEdW1wIHRoZSByaW5n
YnVmZmVyIG9mIHRoZSBhY3RpdmUgcmVxdWVzdCBmb3IgZGVidWdnaW5nIikKPiBTaWduZWQtb2Zm
LWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KPiBDYzogVHZydGtv
IFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KPiBDYzogSm9vbmFzIExhaHRpbmVu
IDxqb29uYXMubGFodGluZW5AbGludXguaW50ZWwuY29tPgo+IENjOiBBbGV4IFNodW1za3kgPGFs
ZXh0aHJlZWRAZ21haWwuY29tPgo+IC0tLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZW5naW5lX2NzLmMgfCAxMSArKysrLS0tLS0tLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9ncHVfZXJyb3IuYyAgICAgfCAgNiArKysrLS0KPiAgIDIgZmlsZXMgY2hhbmdlZCwgOCBp
bnNlcnRpb25zKCspLCA5IGRlbGV0aW9ucygtKQo+IAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2VuZ2luZV9jcy5jCj4gaW5kZXggYmRmMjc5ZmEzYjJlLi4wYTJlN2E0MDRjNzQgMTAw
NjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKPiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYwo+IEBAIC0xNDg0
LDYgKzE0ODQsNyBAQCB2b2lkIGludGVsX2VuZ2luZV9kdW1wKHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSwKPiAgIAlzdHJ1Y3QgaTkxNV9ncHVfZXJyb3IgKiBjb25zdCBlcnJvciA9ICZl
bmdpbmUtPmk5MTUtPmdwdV9lcnJvcjsKPiAgIAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKPiAg
IAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiArCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4gICAK
PiAgIAlpZiAoaGVhZGVyKSB7Cj4gICAJCXZhX2xpc3QgYXA7Cj4gQEAgLTE1MDMsMTAgKzE1MDQs
OSBAQCB2b2lkIGludGVsX2VuZ2luZV9kdW1wKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSwKPiAgIAkJICAgaTkxNV9yZXNldF9lbmdpbmVfY291bnQoZXJyb3IsIGVuZ2luZSksCj4gICAJ
CSAgIGk5MTVfcmVzZXRfY291bnQoZXJyb3IpKTsKPiAgIAo+IC0JcmN1X3JlYWRfbG9jaygpOwo+
IC0KPiAgIAlkcm1fcHJpbnRmKG0sICJcdFJlcXVlc3RzOlxuIik7Cj4gICAKPiArCXNwaW5fbG9j
a19pcnFzYXZlKCZlbmdpbmUtPmFjdGl2ZS5sb2NrLCBmbGFncyk7Cj4gICAJcnEgPSBpbnRlbF9l
bmdpbmVfZmluZF9hY3RpdmVfcmVxdWVzdChlbmdpbmUpOwo+ICAgCWlmIChycSkgewo+ICAgCQlw
cmludF9yZXF1ZXN0KG0sIHJxLCAiXHRcdGFjdGl2ZSAiKTsKPiBAQCAtMTUyNiw4ICsxNTI2LDcg
QEAgdm9pZCBpbnRlbF9lbmdpbmVfZHVtcChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUs
Cj4gICAKPiAgIAkJcHJpbnRfcmVxdWVzdF9yaW5nKG0sIHJxKTsKPiAgIAl9Cj4gLQo+IC0JcmN1
X3JlYWRfdW5sb2NrKCk7Cj4gKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZlbmdpbmUtPmFjdGl2
ZS5sb2NrLCBmbGFncyk7Cj4gICAKPiAgIAl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXRf
aWZfaW5fdXNlKCZlbmdpbmUtPmk5MTUtPnJ1bnRpbWVfcG0pOwo+ICAgCWlmICh3YWtlcmVmKSB7
Cj4gQEAgLTE2ODksNyArMTY4OCw2IEBAIHN0cnVjdCBpOTE1X3JlcXVlc3QgKgo+ICAgaW50ZWxf
ZW5naW5lX2ZpbmRfYWN0aXZlX3JlcXVlc3Qoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KQo+ICAgewo+ICAgCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QsICphY3RpdmUgPSBOVUxM
Owo+IC0JdW5zaWduZWQgbG9uZyBmbGFnczsKPiAgIAo+ICAgCS8qCj4gICAJICogV2UgYXJlIGNh
bGxlZCBieSB0aGUgZXJyb3IgY2FwdHVyZSwgcmVzZXQgYW5kIHRvIGR1bXAgZW5naW5lCj4gQEAg
LTE3MDIsNyArMTcwMCw3IEBAIGludGVsX2VuZ2luZV9maW5kX2FjdGl2ZV9yZXF1ZXN0KHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiAgIAkgKiBBdCBhbGwgb3RoZXIgdGltZXMsIHdl
IG11c3QgYXNzdW1lIHRoZSBHUFUgaXMgc3RpbGwgcnVubmluZywgYnV0Cj4gICAJICogd2Ugb25s
eSBjYXJlIGFib3V0IHRoZSBzbmFwc2hvdCBvZiB0aGlzIG1vbWVudC4KPiAgIAkgKi8KPiAtCXNw
aW5fbG9ja19pcnFzYXZlKCZlbmdpbmUtPmFjdGl2ZS5sb2NrLCBmbGFncyk7Cj4gKwlsb2NrZGVw
X2Fzc2VydF9oZWxkKCZlbmdpbmUtPmFjdGl2ZS5sb2NrKTsKPiAgIAlsaXN0X2Zvcl9lYWNoX2Vu
dHJ5KHJlcXVlc3QsICZlbmdpbmUtPmFjdGl2ZS5yZXF1ZXN0cywgc2NoZWQubGluaykgewo+ICAg
CQlpZiAoaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChyZXF1ZXN0KSkKPiAgIAkJCWNvbnRpbnVlOwo+
IEBAIC0xNzE3LDcgKzE3MTUsNiBAQCBpbnRlbF9lbmdpbmVfZmluZF9hY3RpdmVfcmVxdWVzdChz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gICAJCWFjdGl2ZSA9IHJlcXVlc3Q7Cj4g
ICAJCWJyZWFrOwo+ICAgCX0KPiAtCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmVuZ2luZS0+YWN0
aXZlLmxvY2ssIGZsYWdzKTsKPiAgIAo+ICAgCXJldHVybiBhY3RpdmU7Cj4gICB9Cj4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jCj4gaW5kZXggNTQ4OWNkODc5MzE1Li5mMjk3YTQz
ZGYxZTkgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3Iu
Ywo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmMKPiBAQCAtMTQx
MSw2ICsxNDExLDcgQEAgc3RhdGljIHZvaWQgZ2VtX3JlY29yZF9yaW5ncyhzdHJ1Y3QgaTkxNV9n
cHVfc3RhdGUgKmVycm9yKQo+ICAgCQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUgPSBp
OTE1LT5lbmdpbmVbaV07Cj4gICAJCXN0cnVjdCBkcm1faTkxNV9lcnJvcl9lbmdpbmUgKmVlID0g
JmVycm9yLT5lbmdpbmVbaV07Cj4gICAJCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3Q7Cj4g
KwkJdW5zaWduZWQgbG9uZyBmbGFnczsKPiAgIAo+ICAgCQllZS0+ZW5naW5lX2lkID0gLTE7Cj4g
ICAKPiBAQCAtMTQyMiwxMCArMTQyMywxMSBAQCBzdGF0aWMgdm9pZCBnZW1fcmVjb3JkX3Jpbmdz
KHN0cnVjdCBpOTE1X2dwdV9zdGF0ZSAqZXJyb3IpCj4gICAJCWVycm9yX3JlY29yZF9lbmdpbmVf
cmVnaXN0ZXJzKGVycm9yLCBlbmdpbmUsIGVlKTsKPiAgIAkJZXJyb3JfcmVjb3JkX2VuZ2luZV9l
eGVjbGlzdHMoZW5naW5lLCBlZSk7Cj4gICAKPiArCQlzcGluX2xvY2tfaXJxc2F2ZSgmZW5naW5l
LT5hY3RpdmUubG9jaywgZmxhZ3MpOwo+ICAgCQlyZXF1ZXN0ID0gaW50ZWxfZW5naW5lX2ZpbmRf
YWN0aXZlX3JlcXVlc3QoZW5naW5lKTsKPiAgIAkJaWYgKHJlcXVlc3QpIHsKPiAgIAkJCXN0cnVj
dCBpOTE1X2dlbV9jb250ZXh0ICpjdHggPSByZXF1ZXN0LT5nZW1fY29udGV4dDsKPiAtCQkJc3Ry
dWN0IGludGVsX3JpbmcgKnJpbmc7Cj4gKwkJCXN0cnVjdCBpbnRlbF9yaW5nICpyaW5nID0gcmVx
dWVzdC0+cmluZzsKPiAgIAo+ICAgCQkJZWUtPnZtID0gY3R4LT52bSA/OiAmZW5naW5lLT5ndC0+
Z2d0dC0+dm07Cj4gICAKPiBAQCAtMTQ1NSw3ICsxNDU3LDYgQEAgc3RhdGljIHZvaWQgZ2VtX3Jl
Y29yZF9yaW5ncyhzdHJ1Y3QgaTkxNV9ncHVfc3RhdGUgKmVycm9yKQo+ICAgCQkJZWUtPnJxX3Bv
c3QgPSByZXF1ZXN0LT5wb3N0Zml4Owo+ICAgCQkJZWUtPnJxX3RhaWwgPSByZXF1ZXN0LT50YWls
Owo+ICAgCj4gLQkJCXJpbmcgPSByZXF1ZXN0LT5yaW5nOwo+ICAgCQkJZWUtPmNwdV9yaW5nX2hl
YWQgPSByaW5nLT5oZWFkOwo+ICAgCQkJZWUtPmNwdV9yaW5nX3RhaWwgPSByaW5nLT50YWlsOwo+
ICAgCQkJZWUtPnJpbmdidWZmZXIgPQo+IEBAIC0xNDYzLDYgKzE0NjQsNyBAQCBzdGF0aWMgdm9p
ZCBnZW1fcmVjb3JkX3JpbmdzKHN0cnVjdCBpOTE1X2dwdV9zdGF0ZSAqZXJyb3IpCj4gICAKCkFy
ZW4ndCB0aGVyZSBhbGxvY2F0aW9ucyBpbiB0aGlzIGJsb2NrPwoKPiAgIAkJCWVuZ2luZV9yZWNv
cmRfcmVxdWVzdHMoZW5naW5lLCByZXF1ZXN0LCBlZSk7Cj4gICAJCX0KPiArCQlzcGluX3VubG9j
a19pcnFyZXN0b3JlKCZlbmdpbmUtPmFjdGl2ZS5sb2NrLCBmbGFncyk7Cj4gICAKPiAgIAkJZWUt
Pmh3c19wYWdlID0KPiAgIAkJCWk5MTVfZXJyb3Jfb2JqZWN0X2NyZWF0ZShpOTE1LAo+IAoKUmVn
YXJkcywKClR2cnRrbwpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5v
cmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1n
Zng=

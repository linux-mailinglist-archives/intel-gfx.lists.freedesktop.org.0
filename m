Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 0CB9A3C9C01
	for <lists+intel-gfx@lfdr.de>; Thu, 15 Jul 2021 11:36:03 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7B0AD6E7FE;
	Thu, 15 Jul 2021 09:36:01 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga01.intel.com (mga01.intel.com [192.55.52.88])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 42D466E7FE
 for <intel-gfx@lists.freedesktop.org>; Thu, 15 Jul 2021 09:35:59 +0000 (UTC)
X-IronPort-AV: E=McAfee;i="6200,9189,10045"; a="232335862"
X-IronPort-AV: E=Sophos;i="5.84,240,1620716400"; d="scan'208";a="232335862"
Received: from fmsmga007.fm.intel.com ([10.253.24.52])
 by fmsmga101.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 15 Jul 2021 02:35:58 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.84,240,1620716400"; d="scan'208";a="428732964"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.171])
 by fmsmga007.fm.intel.com with SMTP; 15 Jul 2021 02:35:56 -0700
Received: by stinkbox (sSMTP sendmail emulation);
 Thu, 15 Jul 2021 12:35:56 +0300
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 15 Jul 2021 12:35:26 +0300
Message-Id: <20210715093530.31711-10-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.31.1
In-Reply-To: <20210715093530.31711-1-ville.syrjala@linux.intel.com>
References: <20210715093530.31711-1-ville.syrjala@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 09/13] drm/i915: Call {vlv,
 chv}_prepare_pll() from {vlv, chv}_enable_pll()
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KCldl
IGFsd2F5cyBjYWxsIHRoZSB2bHYvY2h2IHByZXBhcmVfcGxsKCkganVzdCBiZWZvcmUgZW5hYmxl
X3BsbCgpLgpNb3ZlIHRoZSBjYWxscyBpbnRvIHRoZSBlbmFibGVfcGxsKCkgZnVuY3MuIFdlIGNh
biBhbHNvCmNvbnNvbGlkYXRlIHRoZSBEUExMX1ZDT19FTkFCTEUgY2hlY2tzIHdoaWxlIGF0IGl0
LgoKU2lnbmVkLW9mZi1ieTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4Lmlu
dGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXku
YyB8ICAgNyArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcGxsLmMgICAg
fCAyNDUgKysrKysrKysrLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kcGxsLmggICAgfCAgIDkgKy0KIDMgZmlsZXMgY2hhbmdlZCwgMTI1IGluc2VydGlvbnMo
KyksIDEzNiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2Rpc3BsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfZGlzcGxheS5jCmluZGV4IDkwN2MzY2EzMTlhYS4uZDViYzFlMzJiMmJhIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwpAQCAtMzkzNCwxMyArMzkz
NCwxMCBAQCBzdGF0aWMgdm9pZCB2YWxsZXl2aWV3X2NydGNfZW5hYmxlKHN0cnVjdCBpbnRlbF9h
dG9taWNfc3RhdGUgKnN0YXRlLAogCiAJaW50ZWxfZW5jb2RlcnNfcHJlX3BsbF9lbmFibGUoc3Rh
dGUsIGNydGMpOwogCi0JaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Ci0JCWNodl9wcmVw
YXJlX3BsbChuZXdfY3J0Y19zdGF0ZSk7CisJaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQog
CQljaHZfZW5hYmxlX3BsbChuZXdfY3J0Y19zdGF0ZSk7Ci0JfSBlbHNlIHsKLQkJdmx2X3ByZXBh
cmVfcGxsKG5ld19jcnRjX3N0YXRlKTsKKwllbHNlCiAJCXZsdl9lbmFibGVfcGxsKG5ld19jcnRj
X3N0YXRlKTsKLQl9CiAKIAlpbnRlbF9lbmNvZGVyc19wcmVfZW5hYmxlKHN0YXRlLCBjcnRjKTsK
IApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcGxsLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwbGwuYwppbmRleCAwZGY5ZGFm
NGRiZjIuLjliMzBkNmUyOWE0NyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kcGxsLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9kcGxsLmMKQEAgLTE0NjUsMTEyICsxNDY1LDcgQEAgc3RhdGljIHZvaWQgdmx2X3BsbGJfcmVj
YWxfb3BhbXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogCXZsdl9kcGlvX3dy
aXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUkVGX0RXMTMsIHJlZ192YWwpOwogfQogCi1zdGF0aWMg
dm9pZCBfdmx2X2VuYWJsZV9wbGwoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUpCi17Ci0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPnVhcGkuY3J0Yyk7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShjcnRjLT5iYXNlLmRldik7Ci0JZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwot
Ci0JaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIERQTEwocGlwZSksIGNydGNfc3RhdGUtPmRwbGxf
aHdfc3RhdGUuZHBsbCk7Ci0JaW50ZWxfZGVfcG9zdGluZ19yZWFkKGRldl9wcml2LCBEUExMKHBp
cGUpKTsKLQl1ZGVsYXkoMTUwKTsKLQotCWlmIChpbnRlbF9kZV93YWl0X2Zvcl9zZXQoZGV2X3By
aXYsIERQTEwocGlwZSksIERQTExfTE9DS19WTFYsIDEpKQotCQlkcm1fZXJyKCZkZXZfcHJpdi0+
ZHJtLCAiRFBMTCAlZCBmYWlsZWQgdG8gbG9ja1xuIiwgcGlwZSk7Ci19Ci0KLXZvaWQgdmx2X2Vu
YWJsZV9wbGwoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCi17Ci0J
c3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGku
Y3J0Yyk7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7Ci0JZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwotCi0JYXNzZXJ0X3Bp
cGVfZGlzYWJsZWQoZGV2X3ByaXYsIGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyKTsKLQotCS8q
IFBMTCBpcyBwcm90ZWN0ZWQgYnkgcGFuZWwsIG1ha2Ugc3VyZSB3ZSBjYW4gd3JpdGUgaXQgKi8K
LQlhc3NlcnRfcGFuZWxfdW5sb2NrZWQoZGV2X3ByaXYsIHBpcGUpOwotCi0JaWYgKGNydGNfc3Rh
dGUtPmRwbGxfaHdfc3RhdGUuZHBsbCAmIERQTExfVkNPX0VOQUJMRSkKLQkJX3Zsdl9lbmFibGVf
cGxsKGNydGNfc3RhdGUpOwotCi0JaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIERQTExfTUQocGlw
ZSksCi0JCSAgICAgICBjcnRjX3N0YXRlLT5kcGxsX2h3X3N0YXRlLmRwbGxfbWQpOwotCWludGVs
X2RlX3Bvc3RpbmdfcmVhZChkZXZfcHJpdiwgRFBMTF9NRChwaXBlKSk7Ci19Ci0KLQotc3RhdGlj
IHZvaWQgX2Nodl9lbmFibGVfcGxsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlKQotewotCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRj
X3N0YXRlLT51YXBpLmNydGMpOwotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwotCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsK
LQllbnVtIGRwaW9fY2hhbm5lbCBwb3J0ID0gdmx2X3BpcGVfdG9fY2hhbm5lbChwaXBlKTsKLQl1
MzIgdG1wOwotCi0Jdmx2X2RwaW9fZ2V0KGRldl9wcml2KTsKLQotCS8qIEVuYWJsZSBiYWNrIHRo
ZSAxMGJpdCBjbG9jayB0byBkaXNwbGF5IGNvbnRyb2xsZXIgKi8KLQl0bXAgPSB2bHZfZHBpb19y
ZWFkKGRldl9wcml2LCBwaXBlLCBDSFZfQ01OX0RXMTQocG9ydCkpOwotCXRtcCB8PSBEUElPX0RD
TEtQX0VOOwotCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBDSFZfQ01OX0RXMTQocG9y
dCksIHRtcCk7Ci0KLQl2bHZfZHBpb19wdXQoZGV2X3ByaXYpOwotCi0JLyoKLQkgKiBOZWVkIHRv
IHdhaXQgPiAxMDBucyBiZXR3ZWVuIGRjbGtwIGNsb2NrIGVuYWJsZSBiaXQgYW5kIFBMTCBlbmFi
bGUuCi0JICovCi0JdWRlbGF5KDEpOwotCi0JLyogRW5hYmxlIFBMTCAqLwotCWludGVsX2RlX3dy
aXRlKGRldl9wcml2LCBEUExMKHBpcGUpLCBjcnRjX3N0YXRlLT5kcGxsX2h3X3N0YXRlLmRwbGwp
OwotCi0JLyogQ2hlY2sgUExMIGlzIGxvY2tlZCAqLwotCWlmIChpbnRlbF9kZV93YWl0X2Zvcl9z
ZXQoZGV2X3ByaXYsIERQTEwocGlwZSksIERQTExfTE9DS19WTFYsIDEpKQotCQlkcm1fZXJyKCZk
ZXZfcHJpdi0+ZHJtLCAiUExMICVkIGZhaWxlZCB0byBsb2NrXG4iLCBwaXBlKTsKLX0KLQotdm9p
ZCBjaHZfZW5hYmxlX3BsbChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSkKLXsKLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0
ZS0+dWFwaS5jcnRjKTsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGNydGMtPmJhc2UuZGV2KTsKLQllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Ci0KLQlh
c3NlcnRfcGlwZV9kaXNhYmxlZChkZXZfcHJpdiwgY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXIp
OwotCi0JLyogUExMIGlzIHByb3RlY3RlZCBieSBwYW5lbCwgbWFrZSBzdXJlIHdlIGNhbiB3cml0
ZSBpdCAqLwotCWFzc2VydF9wYW5lbF91bmxvY2tlZChkZXZfcHJpdiwgcGlwZSk7Ci0KLQlpZiAo
Y3J0Y19zdGF0ZS0+ZHBsbF9od19zdGF0ZS5kcGxsICYgRFBMTF9WQ09fRU5BQkxFKQotCQlfY2h2
X2VuYWJsZV9wbGwoY3J0Y19zdGF0ZSk7Ci0KLQlpZiAocGlwZSAhPSBQSVBFX0EpIHsKLQkJLyoK
LQkJICogV2FQaXhlbFJlcGVhdE1vZGVGaXhGb3JDMDpjaHYKLQkJICoKLQkJICogRFBMTENNRCBp
cyBBV09MLiBVc2UgY2hpY2tlbiBiaXRzIHRvIHByb3BhZ2F0ZQotCQkgKiB0aGUgdmFsdWUgZnJv
bSBEUExMQk1EIHRvIGVpdGhlciBwaXBlIEIgb3IgQy4KLQkJICovCi0JCWludGVsX2RlX3dyaXRl
KGRldl9wcml2LCBDQlI0X1ZMViwgQ0JSX0RQTExCTURfUElQRShwaXBlKSk7Ci0JCWludGVsX2Rl
X3dyaXRlKGRldl9wcml2LCBEUExMX01EKFBJUEVfQiksCi0JCQkgICAgICAgY3J0Y19zdGF0ZS0+
ZHBsbF9od19zdGF0ZS5kcGxsX21kKTsKLQkJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIENCUjRf
VkxWLCAwKTsKLQkJZGV2X3ByaXYtPmNodl9kcGxsX21kW3BpcGVdID0gY3J0Y19zdGF0ZS0+ZHBs
bF9od19zdGF0ZS5kcGxsX21kOwotCi0JCS8qCi0JCSAqIERQTExCIFZHQSBtb2RlIGFsc28gc2Vl
bXMgdG8gY2F1c2UgcHJvYmxlbXMuCi0JCSAqIFdlIHNob3VsZCBhbHdheXMgaGF2ZSBpdCBkaXNh
YmxlZC4KLQkJICovCi0JCWRybV9XQVJOX09OKCZkZXZfcHJpdi0+ZHJtLAotCQkJICAgIChpbnRl
bF9kZV9yZWFkKGRldl9wcml2LCBEUExMKFBJUEVfQikpICYKLQkJCSAgICAgRFBMTF9WR0FfTU9E
RV9ESVMpID09IDApOwotCX0gZWxzZSB7Ci0JCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBEUExM
X01EKHBpcGUpLAotCQkJICAgICAgIGNydGNfc3RhdGUtPmRwbGxfaHdfc3RhdGUuZHBsbF9tZCk7
Ci0JCWludGVsX2RlX3Bvc3RpbmdfcmVhZChkZXZfcHJpdiwgRFBMTF9NRChwaXBlKSk7Ci0JfQot
fQotCi12b2lkIHZsdl9wcmVwYXJlX3BsbChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSkKK3N0YXRpYyB2b2lkIHZsdl9wcmVwYXJlX3BsbChjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKIHsKIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9
IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKIAlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKQEAgLTE1NzksMTUg
KzE0NzQsNiBAQCB2b2lkIHZsdl9wcmVwYXJlX3BsbChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKIAl1MzIgYmVzdG4sIGJlc3RtMSwgYmVzdG0yLCBiZXN0cDEsIGJl
c3RwMjsKIAl1MzIgY29yZWNsaywgcmVnX3ZhbDsKIAotCS8qIEVuYWJsZSBSZWZjbGsgKi8KLQlp
bnRlbF9kZV93cml0ZShkZXZfcHJpdiwgRFBMTChwaXBlKSwKLQkJICAgICAgIGNydGNfc3RhdGUt
PmRwbGxfaHdfc3RhdGUuZHBsbCAmCi0JCSAgICAgICB+KERQTExfVkNPX0VOQUJMRSB8IERQTExf
RVhUX0JVRkZFUl9FTkFCTEVfVkxWKSk7Ci0KLQkvKiBObyBuZWVkIHRvIGFjdHVhbGx5IHNldCB1
cCB0aGUgRFBMTCB3aXRoIERTSSAqLwotCWlmICgoY3J0Y19zdGF0ZS0+ZHBsbF9od19zdGF0ZS5k
cGxsICYgRFBMTF9WQ09fRU5BQkxFKSA9PSAwKQotCQlyZXR1cm47Ci0KIAl2bHZfZHBpb19nZXQo
ZGV2X3ByaXYpOwogCiAJYmVzdG4gPSBjcnRjX3N0YXRlLT5kcGxsLm47CkBAIC0xNjY5LDcgKzE1
NTUsNDcgQEAgdm9pZCB2bHZfcHJlcGFyZV9wbGwoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUpCiAJdmx2X2RwaW9fcHV0KGRldl9wcml2KTsKIH0KIAotdm9pZCBjaHZf
cHJlcGFyZV9wbGwoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCitz
dGF0aWMgdm9pZCBfdmx2X2VuYWJsZV9wbGwoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUpCit7CisJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRj
KGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7CisJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5w
aXBlOworCisJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIERQTEwocGlwZSksIGNydGNfc3RhdGUt
PmRwbGxfaHdfc3RhdGUuZHBsbCk7CisJaW50ZWxfZGVfcG9zdGluZ19yZWFkKGRldl9wcml2LCBE
UExMKHBpcGUpKTsKKwl1ZGVsYXkoMTUwKTsKKworCWlmIChpbnRlbF9kZV93YWl0X2Zvcl9zZXQo
ZGV2X3ByaXYsIERQTEwocGlwZSksIERQTExfTE9DS19WTFYsIDEpKQorCQlkcm1fZXJyKCZkZXZf
cHJpdi0+ZHJtLCAiRFBMTCAlZCBmYWlsZWQgdG8gbG9ja1xuIiwgcGlwZSk7Cit9CisKK3ZvaWQg
dmx2X2VuYWJsZV9wbGwoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUp
Cit7CisJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUt
PnVhcGkuY3J0Yyk7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjcnRjLT5iYXNlLmRldik7CisJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOworCisJYXNz
ZXJ0X3BpcGVfZGlzYWJsZWQoZGV2X3ByaXYsIGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyKTsK
KworCS8qIFBMTCBpcyBwcm90ZWN0ZWQgYnkgcGFuZWwsIG1ha2Ugc3VyZSB3ZSBjYW4gd3JpdGUg
aXQgKi8KKwlhc3NlcnRfcGFuZWxfdW5sb2NrZWQoZGV2X3ByaXYsIHBpcGUpOworCisJLyogRW5h
YmxlIFJlZmNsayAqLworCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBEUExMKHBpcGUpLAorCQkg
ICAgICAgY3J0Y19zdGF0ZS0+ZHBsbF9od19zdGF0ZS5kcGxsICYKKwkJICAgICAgIH4oRFBMTF9W
Q09fRU5BQkxFIHwgRFBMTF9FWFRfQlVGRkVSX0VOQUJMRV9WTFYpKTsKKworCWlmIChjcnRjX3N0
YXRlLT5kcGxsX2h3X3N0YXRlLmRwbGwgJiBEUExMX1ZDT19FTkFCTEUpIHsKKwkJdmx2X3ByZXBh
cmVfcGxsKGNydGNfc3RhdGUpOworCQlfdmx2X2VuYWJsZV9wbGwoY3J0Y19zdGF0ZSk7CisJfQor
CisJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIERQTExfTUQocGlwZSksCisJCSAgICAgICBjcnRj
X3N0YXRlLT5kcGxsX2h3X3N0YXRlLmRwbGxfbWQpOworCWludGVsX2RlX3Bvc3RpbmdfcmVhZChk
ZXZfcHJpdiwgRFBMTF9NRChwaXBlKSk7Cit9CisKK3N0YXRpYyB2b2lkIGNodl9wcmVwYXJlX3Bs
bChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKIHsKIAlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsK
IAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2Uu
ZGV2KTsKQEAgLTE2ODAsMTQgKzE2MDYsNiBAQCB2b2lkIGNodl9wcmVwYXJlX3BsbChjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKIAl1MzIgZHBpb192YWw7CiAJaW50
IHZjbzsKIAotCS8qIEVuYWJsZSBSZWZjbGsgYW5kIFNTQyAqLwotCWludGVsX2RlX3dyaXRlKGRl
dl9wcml2LCBEUExMKHBpcGUpLAotCQkgICAgICAgY3J0Y19zdGF0ZS0+ZHBsbF9od19zdGF0ZS5k
cGxsICYgfkRQTExfVkNPX0VOQUJMRSk7Ci0KLQkvKiBObyBuZWVkIHRvIGFjdHVhbGx5IHNldCB1
cCB0aGUgRFBMTCB3aXRoIERTSSAqLwotCWlmICgoY3J0Y19zdGF0ZS0+ZHBsbF9od19zdGF0ZS5k
cGxsICYgRFBMTF9WQ09fRU5BQkxFKSA9PSAwKQotCQlyZXR1cm47Ci0KIAliZXN0biA9IGNydGNf
c3RhdGUtPmRwbGwubjsKIAliZXN0bTJfZnJhYyA9IGNydGNfc3RhdGUtPmRwbGwubTIgJiAweDNm
ZmZmZjsKIAliZXN0bTEgPSBjcnRjX3N0YXRlLT5kcGxsLm0xOwpAQCAtMTc3Myw2ICsxNjkxLDgz
IEBAIHZvaWQgY2h2X3ByZXBhcmVfcGxsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlKQogCXZsdl9kcGlvX3B1dChkZXZfcHJpdik7CiB9CiAKK3N0YXRpYyB2b2lkIF9j
aHZfZW5hYmxlX3BsbChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkK
K3sKKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+
dWFwaS5jcnRjKTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGNydGMtPmJhc2UuZGV2KTsKKwllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7CisJZW51bSBk
cGlvX2NoYW5uZWwgcG9ydCA9IHZsdl9waXBlX3RvX2NoYW5uZWwocGlwZSk7CisJdTMyIHRtcDsK
KworCXZsdl9kcGlvX2dldChkZXZfcHJpdik7CisKKwkvKiBFbmFibGUgYmFjayB0aGUgMTBiaXQg
Y2xvY2sgdG8gZGlzcGxheSBjb250cm9sbGVyICovCisJdG1wID0gdmx2X2RwaW9fcmVhZChkZXZf
cHJpdiwgcGlwZSwgQ0hWX0NNTl9EVzE0KHBvcnQpKTsKKwl0bXAgfD0gRFBJT19EQ0xLUF9FTjsK
Kwl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgQ0hWX0NNTl9EVzE0KHBvcnQpLCB0bXAp
OworCisJdmx2X2RwaW9fcHV0KGRldl9wcml2KTsKKworCS8qCisJICogTmVlZCB0byB3YWl0ID4g
MTAwbnMgYmV0d2VlbiBkY2xrcCBjbG9jayBlbmFibGUgYml0IGFuZCBQTEwgZW5hYmxlLgorCSAq
LworCXVkZWxheSgxKTsKKworCS8qIEVuYWJsZSBQTEwgKi8KKwlpbnRlbF9kZV93cml0ZShkZXZf
cHJpdiwgRFBMTChwaXBlKSwgY3J0Y19zdGF0ZS0+ZHBsbF9od19zdGF0ZS5kcGxsKTsKKworCS8q
IENoZWNrIFBMTCBpcyBsb2NrZWQgKi8KKwlpZiAoaW50ZWxfZGVfd2FpdF9mb3Jfc2V0KGRldl9w
cml2LCBEUExMKHBpcGUpLCBEUExMX0xPQ0tfVkxWLCAxKSkKKwkJZHJtX2VycigmZGV2X3ByaXYt
PmRybSwgIlBMTCAlZCBmYWlsZWQgdG8gbG9ja1xuIiwgcGlwZSk7Cit9CisKK3ZvaWQgY2h2X2Vu
YWJsZV9wbGwoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCit7CisJ
c3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGku
Y3J0Yyk7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7CisJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOworCisJYXNzZXJ0X3Bp
cGVfZGlzYWJsZWQoZGV2X3ByaXYsIGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyKTsKKworCS8q
IFBMTCBpcyBwcm90ZWN0ZWQgYnkgcGFuZWwsIG1ha2Ugc3VyZSB3ZSBjYW4gd3JpdGUgaXQgKi8K
Kwlhc3NlcnRfcGFuZWxfdW5sb2NrZWQoZGV2X3ByaXYsIHBpcGUpOworCisJLyogRW5hYmxlIFJl
ZmNsayBhbmQgU1NDICovCisJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIERQTEwocGlwZSksCisJ
CSAgICAgICBjcnRjX3N0YXRlLT5kcGxsX2h3X3N0YXRlLmRwbGwgJiB+RFBMTF9WQ09fRU5BQkxF
KTsKKworCWlmIChjcnRjX3N0YXRlLT5kcGxsX2h3X3N0YXRlLmRwbGwgJiBEUExMX1ZDT19FTkFC
TEUpIHsKKwkJY2h2X3ByZXBhcmVfcGxsKGNydGNfc3RhdGUpOworCQlfY2h2X2VuYWJsZV9wbGwo
Y3J0Y19zdGF0ZSk7CisJfQorCisJaWYgKHBpcGUgIT0gUElQRV9BKSB7CisJCS8qCisJCSAqIFdh
UGl4ZWxSZXBlYXRNb2RlRml4Rm9yQzA6Y2h2CisJCSAqCisJCSAqIERQTExDTUQgaXMgQVdPTC4g
VXNlIGNoaWNrZW4gYml0cyB0byBwcm9wYWdhdGUKKwkJICogdGhlIHZhbHVlIGZyb20gRFBMTEJN
RCB0byBlaXRoZXIgcGlwZSBCIG9yIEMuCisJCSAqLworCQlpbnRlbF9kZV93cml0ZShkZXZfcHJp
diwgQ0JSNF9WTFYsIENCUl9EUExMQk1EX1BJUEUocGlwZSkpOworCQlpbnRlbF9kZV93cml0ZShk
ZXZfcHJpdiwgRFBMTF9NRChQSVBFX0IpLAorCQkJICAgICAgIGNydGNfc3RhdGUtPmRwbGxfaHdf
c3RhdGUuZHBsbF9tZCk7CisJCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBDQlI0X1ZMViwgMCk7
CisJCWRldl9wcml2LT5jaHZfZHBsbF9tZFtwaXBlXSA9IGNydGNfc3RhdGUtPmRwbGxfaHdfc3Rh
dGUuZHBsbF9tZDsKKworCQkvKgorCQkgKiBEUExMQiBWR0EgbW9kZSBhbHNvIHNlZW1zIHRvIGNh
dXNlIHByb2JsZW1zLgorCQkgKiBXZSBzaG91bGQgYWx3YXlzIGhhdmUgaXQgZGlzYWJsZWQuCisJ
CSAqLworCQlkcm1fV0FSTl9PTigmZGV2X3ByaXYtPmRybSwKKwkJCSAgICAoaW50ZWxfZGVfcmVh
ZChkZXZfcHJpdiwgRFBMTChQSVBFX0IpKSAmCisJCQkgICAgIERQTExfVkdBX01PREVfRElTKSA9
PSAwKTsKKwl9IGVsc2UgeworCQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgRFBMTF9NRChwaXBl
KSwKKwkJCSAgICAgICBjcnRjX3N0YXRlLT5kcGxsX2h3X3N0YXRlLmRwbGxfbWQpOworCQlpbnRl
bF9kZV9wb3N0aW5nX3JlYWQoZGV2X3ByaXYsIERQTExfTUQocGlwZSkpOworCX0KK30KKwogLyoq
CiAgKiB2bHZfZm9yY2VfcGxsX29uIC0gZm9yY2libHkgZW5hYmxlIGp1c3QgdGhlIFBMTAogICog
QGRldl9wcml2OiBpOTE1IHByaXZhdGUgc3RydWN0dXJlCkBAIC0xODAwLDExICsxNzk1LDkgQEAg
aW50IHZsdl9mb3JjZV9wbGxfb24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBl
bnVtIHBpcGUgcGlwZSwKIAogCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkgewogCQljaHZf
Y29tcHV0ZV9kcGxsKGNydGNfc3RhdGUpOwotCQljaHZfcHJlcGFyZV9wbGwoY3J0Y19zdGF0ZSk7
CiAJCWNodl9lbmFibGVfcGxsKGNydGNfc3RhdGUpOwogCX0gZWxzZSB7CiAJCXZsdl9jb21wdXRl
X2RwbGwoY3J0Y19zdGF0ZSk7Ci0JCXZsdl9wcmVwYXJlX3BsbChjcnRjX3N0YXRlKTsKIAkJdmx2
X2VuYWJsZV9wbGwoY3J0Y19zdGF0ZSk7CiAJfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwbGwuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfZHBsbC5oCmluZGV4IDI5ZjMxMDc1Y2RmMC4uZGIzOTZiM2UxMTQxIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwbGwuaAorKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwbGwuaApAQCAtMjUsMTQgKzI1LDEzIEBA
IHZvaWQgY2h2X2NvbXB1dGVfZHBsbChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSk7CiBpbnQgdmx2X2ZvcmNlX3BsbF9vbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsIGVudW0gcGlwZSBwaXBlLAogCQkgICAgIGNvbnN0IHN0cnVjdCBkcGxsICpkcGxsKTsKIHZv
aWQgdmx2X2ZvcmNlX3BsbF9vZmYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBl
bnVtIHBpcGUgcGlwZSk7Ci12b2lkIGk5eHhfZW5hYmxlX3BsbChjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7Ci12b2lkIHZsdl9lbmFibGVfcGxsKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKTsKKwogdm9pZCBjaHZfZW5hYmxlX3BsbChj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7Ci12b2lkIHZsdl9kaXNh
YmxlX3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlwZSBwaXBl
KTsKIHZvaWQgY2h2X2Rpc2FibGVfcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwgZW51bSBwaXBlIHBpcGUpOwordm9pZCB2bHZfZW5hYmxlX3BsbChjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7Cit2b2lkIHZsdl9kaXNhYmxlX3BsbChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlwZSBwaXBlKTsKK3ZvaWQgaTl4eF9l
bmFibGVfcGxsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKTsKIHZv
aWQgaTl4eF9kaXNhYmxlX3BsbChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSk7Ci12b2lkIHZsdl9wcmVwYXJlX3BsbChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSk7Ci12b2lkIGNodl9wcmVwYXJlX3BsbChjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7CiBib29sIGJ4dF9maW5kX2Jlc3RfZHBsbChzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCXN0cnVjdCBkcGxsICpiZXN0X2Nsb2Nr
KTsKIGludCBjaHZfY2FsY19kcGxsX3BhcmFtcyhpbnQgcmVmY2xrLCBzdHJ1Y3QgZHBsbCAqcGxs
X2Nsb2NrKTsKLS0gCjIuMzEuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRl
c2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8v
aW50ZWwtZ2Z4Cg==

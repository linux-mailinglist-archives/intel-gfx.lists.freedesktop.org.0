Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 3C4C6CC42B
	for <lists+intel-gfx@lfdr.de>; Fri,  4 Oct 2019 22:27:28 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 64D3B6E317;
	Fri,  4 Oct 2019 20:27:26 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga17.intel.com (mga17.intel.com [192.55.52.151])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E35166E317
 for <intel-gfx@lists.freedesktop.org>; Fri,  4 Oct 2019 20:27:24 +0000 (UTC)
X-Amp-Result: UNKNOWN
X-Amp-Original-Verdict: FILE UNKNOWN
X-Amp-File-Uploaded: False
Received: from fmsmga005.fm.intel.com ([10.253.24.32])
 by fmsmga107.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 04 Oct 2019 13:27:24 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.67,257,1566889200"; d="scan'208";a="392422685"
Received: from mdroper-desk1.fm.intel.com (HELO
 mdroper-desk1.amr.corp.intel.com) ([10.1.27.135])
 by fmsmga005.fm.intel.com with ESMTP; 04 Oct 2019 13:27:24 -0700
Date: Fri, 4 Oct 2019 13:27:45 -0700
From: Matt Roper <matthew.d.roper@intel.com>
To: Dhinakaran Pandiyan <dhinakaran.pandiyan@intel.com>
Message-ID: <20191004202745.GS1869@mdroper-desk1.amr.corp.intel.com>
References: <20190923102935.5860-10-dhinakaran.pandiyan@intel.com>
 <20190926105512.25818-1-dhinakaran.pandiyan@intel.com>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <20190926105512.25818-1-dhinakaran.pandiyan@intel.com>
User-Agent: Mutt/1.12.1 (2019-06-15)
Subject: Re: [Intel-gfx] [PATCH v4 9/9] Gen-12 display can decompress
 surfaces compressed by the media engine.
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: intel-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T24gVGh1LCBTZXAgMjYsIDIwMTkgYXQgMDM6NTU6MTJBTSAtMDcwMCwgRGhpbmFrYXJhbiBQYW5k
aXlhbiB3cm90ZToKPiBEZXRlY3QgdGhlIG1vZGlmaWVyIGNvcnJlc3BvbmRpbmcgdG8gbWVkaWEg
Y29tcHJlc3Npb24gdG8gZW5hYmxlCj4gZGlzcGxheSBkZWNvbXByZXNzaW9uIGZvciBZVVYgYW5k
IHhSR0IgcGFja2VkIGZvcm1hdHMuIEEgbmV3IG1vZGlmaWVyIGlzCj4gYWRkZWQgc28gdGhhdCB0
aGUgZHJpdmVyIGNhbiBkaXN0aW5ndWlzaCBiZXR3ZWVuIG1lZGlhIGFuZCByZW5kZXIKPiBjb21w
cmVzc2VkIGJ1ZmZlcnMuIFVubGlrZSByZW5kZXIgZGVjb21wcmVzc2lvbiwgcGxhbmUgNiBhbmQg
IHBsYW5lIDcgZG8gbm90Cj4gc3VwcG9ydCBtZWRpYSBkZWNvbXByZXNzaW9uLgo+IAo+IHYyOiBG
aXggY2hlY2twYXRjaCB3YXJuaW5ncyBvbiBjb2RlIHN0eWxlIChMdWNhcykKPiAKPiBGcm9tIERL
Ogo+IFNlcGFyYXRlIG1vZGlmaWVyIGFycmF5IGZvciBwbGFuZXMgdGhhdCBjYW5ub3QgZGVjb21w
cmVzcyBtZWRpYSAoVmlsbGUpCj4gCj4gdjM6IFN1cHBvcnQgcGxhbmFyIGZvcm1hdHMKPiB2NDog
U3dpdGNoIHBsYW5lIG9yZGVyCj4gCj4gQ2M6IE5hbmxleSBHIENoZXJ5IDxuYW5sZXkuZy5jaGVy
eUBpbnRlbC5jb20+Cj4gQ2M6IFZpbGxlIFN5cmrDpGzDpCA8dmlsbGUuc3lyamFsYUBsaW51eC5p
bnRlbC5jb20+Cj4gQ2M6IE1hdHQgUm9wZXIgPG1hdHRoZXcuZC5yb3BlckBpbnRlbC5jb20+Cj4g
U2lnbmVkLW9mZi1ieTogRGhpbmFrYXJhbiBQYW5kaXlhbiA8ZGhpbmFrYXJhbi5wYW5kaXlhbkBp
bnRlbC5jb20+Cj4gU2lnbmVkLW9mZi1ieTogTHVjYXMgRGUgTWFyY2hpIDxsdWNhcy5kZW1hcmNo
aUBpbnRlbC5jb20+Cj4gLS0tCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZGlzcGxheS5jICB8IDI5MCArKysrKysrKysrKysrLS0tLS0KPiAgLi4uL2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfZGlzcGxheV90eXBlcy5oICAgIHwgICAyICstCj4gIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfc3ByaXRlLmMgICB8ICA1NSArKystCj4gIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfcmVnLmggICAgICAgICAgICAgICB8ICAgMSArCj4gIDQgZmlsZXMgY2hhbmdl
ZCwgMjY3IGluc2VydGlvbnMoKyksIDgxIGRlbGV0aW9ucygtKQo+IAo+IGRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCj4gaW5kZXggOGVhNTVkNjc0NDJjLi5k
ZjNlYmFhMTY3YWIgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kaXNwbGF5LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2Rpc3BsYXkuYwo+IEBAIC0xODg4LDYgKzE4ODgsMjIgQEAgc3RhdGljIHZvaWQgaW50ZWxfZGlz
YWJsZV9waXBlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkK
PiAgCQlpbnRlbF93YWl0X2Zvcl9waXBlX29mZihvbGRfY3J0Y19zdGF0ZSk7Cj4gIH0KPiAgCj4g
K2Jvb2wgaXNfY2NzX21vZGlmaWVyKHU2NCBtb2RpZmllcikKPiArewo+ICsJcmV0dXJuIG1vZGlm
aWVyID09IEk5MTVfRk9STUFUX01PRF9ZX1RJTEVEX0dFTjEyX1JDX0NDUyB8fAo+ICsJICAgICAg
IG1vZGlmaWVyID09IEk5MTVfRk9STUFUX01PRF9ZX1RJTEVEX0dFTjEyX01DX0NDUyB8fAo+ICsJ
ICAgICAgIG1vZGlmaWVyID09IEk5MTVfRk9STUFUX01PRF9ZX1RJTEVEX0NDUyB8fAo+ICsJICAg
ICAgIG1vZGlmaWVyID09IEk5MTVfRk9STUFUX01PRF9ZZl9USUxFRF9DQ1M7Cj4gK30KPiArCj4g
K3N0YXRpYyBib29sIGlzX2Njc19wbGFuZShjb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpm
YiwgaW50IGNvbG9yX3BsYW5lKQo+ICt7Cj4gKwlpZiAoIWlzX2Njc19tb2RpZmllcihmYi0+bW9k
aWZpZXIpKQo+ICsJCXJldHVybiBmYWxzZTsKPiArCj4gKwlyZXR1cm4gY29sb3JfcGxhbmUgPj0g
ZmItPmZvcm1hdC0+bnVtX3BsYW5lcyAvIDI7Cj4gK30KClRoaXMgYXBwZWFycyB0byBjb250cmFk
aWN0IHdoYXQgeW91IGluZGljYXRlZCBvbiB0aGUgbW9kaWZpZXIgcGF0Y2g6CgogICsgKiBZLXRp
bGUgd2lkdGhzLiBGb3Igc2VtaS1wbGFuYXIgZm9ybWF0cyBsaWtlIE5WMTIsIENDUyBwbGFuZSBm
b2xsb3dzIHRoZQogICsgKiBZIGFuZCBVViBwbGFuZXMgaS5lLiwgcGxhbmVzIDAgYW5kIDIgYXJl
IHVzZWQgZm9yIFkgYW5kIFVWIHN1cmZhY2VzLAogICsgKiBwbGFuZXMgMSBhbmQgMyBmb3IgdGhl
IHJlc3BlY3RpdmUgQ0NTLgoKQmFzZWQgb24gdGhhdCBjb21tZW50IEknZCBleHBlY3Qgc29tZXRo
aW5nIG1vcmUgbGlrZSAoY29sb3JfcGxhbmUgJSAyKS4KCgo+ICsKPiAgc3RhdGljIHVuc2lnbmVk
IGludCBpbnRlbF90aWxlX3NpemUoY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICB7Cj4gIAlyZXR1cm4gSVNfR0VOKGRldl9wcml2LCAyKSA/IDIwNDggOiA0MDk2Owo+
IEBAIC0xOTA4LDExICsxOTI0LDEzIEBAIGludGVsX3RpbGVfd2lkdGhfYnl0ZXMoY29uc3Qgc3Ry
dWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIsIGludCBjb2xvcl9wbGFuZSkKPiAgCQllbHNlCj4gIAkJ
CXJldHVybiA1MTI7Cj4gIAljYXNlIEk5MTVfRk9STUFUX01PRF9ZX1RJTEVEX0NDUzoKPiAtCQlp
ZiAoY29sb3JfcGxhbmUgPT0gMSkKPiArCQlpZiAoaXNfY2NzX3BsYW5lKGZiLCBjb2xvcl9wbGFu
ZSkpCj4gIAkJCXJldHVybiAxMjg7Cj4gIAkJLyogZmFsbCB0aHJvdWdoICovCj4gKwljYXNlIEk5
MTVfRk9STUFUX01PRF9ZX1RJTEVEX0dFTjEyX01DX0NDUzoKPiArCQkvKiBmYWxsIHRocm91Z2gg
Ki8KPiAgCWNhc2UgSTkxNV9GT1JNQVRfTU9EX1lfVElMRURfR0VOMTJfUkNfQ0NTOgo+IC0JCWlm
IChjb2xvcl9wbGFuZSA9PSAxKQo+ICsJCWlmIChpc19jY3NfcGxhbmUoZmIsIGNvbG9yX3BsYW5l
KSkKPiAgCQkJcmV0dXJuIDY0Owo+ICAJCS8qIGZhbGwgdGhyb3VnaCAqLwo+ICAJY2FzZSBJOTE1
X0ZPUk1BVF9NT0RfWV9USUxFRDoKPiBAQCAtMTkyMSw3ICsxOTM5LDcgQEAgaW50ZWxfdGlsZV93
aWR0aF9ieXRlcyhjb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiwgaW50IGNvbG9yX3Bs
YW5lKQo+ICAJCWVsc2UKPiAgCQkJcmV0dXJuIDUxMjsKPiAgCWNhc2UgSTkxNV9GT1JNQVRfTU9E
X1lmX1RJTEVEX0NDUzoKPiAtCQlpZiAoY29sb3JfcGxhbmUgPT0gMSkKPiArCQlpZiAoaXNfY2Nz
X3BsYW5lKGZiLCBjb2xvcl9wbGFuZSkpCj4gIAkJCXJldHVybiAxMjg7Cj4gIAkJLyogZmFsbCB0
aHJvdWdoICovCj4gIAljYXNlIEk5MTVfRk9STUFUX01PRF9ZZl9USUxFRDoKPiBAQCAtMTk0OSw4
ICsxOTY3LDkgQEAgc3RhdGljIHVuc2lnbmVkIGludAo+ICBpbnRlbF90aWxlX2hlaWdodChjb25z
dCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiwgaW50IGNvbG9yX3BsYW5lKQo+ICB7Cj4gIAlz
d2l0Y2ggKGZiLT5tb2RpZmllcikgewo+ICsJY2FzZSBJOTE1X0ZPUk1BVF9NT0RfWV9USUxFRF9H
RU4xMl9NQ19DQ1M6Cj4gIAljYXNlIEk5MTVfRk9STUFUX01PRF9ZX1RJTEVEX0dFTjEyX1JDX0ND
UzoKPiAtCQlpZiAoY29sb3JfcGxhbmUgPT0gMSkKPiArCQlpZiAoaXNfY2NzX3BsYW5lKGZiLCBj
b2xvcl9wbGFuZSkpCj4gIAkJCXJldHVybiAxOwo+ICAJCS8qIGZhbGwgdGhyb3VnaCAqLwo+ICAJ
ZGVmYXVsdDoKPiBAQCAtMjA1NSw2ICsyMDc0LDcgQEAgc3RhdGljIHVuc2lnbmVkIGludCBpbnRl
bF9zdXJmX2FsaWdubWVudChjb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiwKPiAgCQlp
ZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KQo+ICAJCQlyZXR1cm4gMjU2ICogMTAyNDsKPiAg
CQlyZXR1cm4gMDsKPiArCWNhc2UgSTkxNV9GT1JNQVRfTU9EX1lfVElMRURfR0VOMTJfTUNfQ0NT
Ogo+ICAJY2FzZSBJOTE1X0ZPUk1BVF9NT0RfWV9USUxFRF9HRU4xMl9SQ19DQ1M6Cj4gIAkJcmV0
dXJuIDE2ICogMTAyNDsKPiAgCWNhc2UgSTkxNV9GT1JNQVRfTU9EX1lfVElMRURfQ0NTOgo+IEBA
IC0yMjU0LDEwICsyMjc0LDE3IEBAIHN0YXRpYyB1MzIgaW50ZWxfYWRqdXN0X3RpbGVfb2Zmc2V0
KGludCAqeCwgaW50ICp5LAo+ICAJcmV0dXJuIG5ld19vZmZzZXQ7Cj4gIH0KPiAgCj4gLXN0YXRp
YyBib29sIGlzX3N1cmZhY2VfbGluZWFyKHU2NCBtb2RpZmllciwgaW50IGNvbG9yX3BsYW5lKQo+
ICtzdGF0aWMgYm9vbCBpc19zdXJmYWNlX2xpbmVhcihjb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVm
ZmVyICpmYiwgaW50IGNvbG9yX3BsYW5lKQo+ICB7Cj4gLQlyZXR1cm4gbW9kaWZpZXIgPT0gRFJN
X0ZPUk1BVF9NT0RfTElORUFSIHx8Cj4gLQkgICAgICAgKG1vZGlmaWVyID09IEk5MTVfRk9STUFU
X01PRF9ZX1RJTEVEX0dFTjEyX1JDX0NDUyAmJiBjb2xvcl9wbGFuZSA9PSAxKTsKPiArCXN3aXRj
aCAoZmItPm1vZGlmaWVyKSB7Cj4gKwljYXNlIERSTV9GT1JNQVRfTU9EX0xJTkVBUjoKPiArCQly
ZXR1cm4gdHJ1ZTsKPiArCWNhc2UgSTkxNV9GT1JNQVRfTU9EX1lfVElMRURfR0VOMTJfUkNfQ0NT
Ogo+ICsJY2FzZSBJOTE1X0ZPUk1BVF9NT0RfWV9USUxFRF9HRU4xMl9NQ19DQ1M6Cj4gKwkJcmV0
dXJuIGlzX2Njc19wbGFuZShmYiwgY29sb3JfcGxhbmUpOwo+ICsJZGVmYXVsdDoKPiArCQlyZXR1
cm4gZmFsc2U7Cj4gKwl9Cj4gIH0KPiAgCj4gIHN0YXRpYyB1MzIgaW50ZWxfYWRqdXN0X2FsaWdu
ZWRfb2Zmc2V0KGludCAqeCwgaW50ICp5LAo+IEBAIC0yMjcyLDcgKzIyOTksNyBAQCBzdGF0aWMg
dTMyIGludGVsX2FkanVzdF9hbGlnbmVkX29mZnNldChpbnQgKngsIGludCAqeSwKPiAgCj4gIAlX
QVJOX09OKG5ld19vZmZzZXQgPiBvbGRfb2Zmc2V0KTsKPiAgCj4gLQlpZiAoIWlzX3N1cmZhY2Vf
bGluZWFyKGZiLT5tb2RpZmllciwgY29sb3JfcGxhbmUpKSB7Cj4gKwlpZiAoIWlzX3N1cmZhY2Vf
bGluZWFyKGZiLCBjb2xvcl9wbGFuZSkpIHsKPiAgCQl1bnNpZ25lZCBpbnQgdGlsZV9zaXplLCB0
aWxlX3dpZHRoLCB0aWxlX2hlaWdodDsKPiAgCQl1bnNpZ25lZCBpbnQgcGl0Y2hfdGlsZXM7Cj4g
IAo+IEBAIC0yMzQyLDcgKzIzNjksNyBAQCBzdGF0aWMgdTMyIGludGVsX2NvbXB1dGVfYWxpZ25l
ZF9vZmZzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAJaWYgKGFsaWdu
bWVudCkKPiAgCQlhbGlnbm1lbnQtLTsKPiAgCj4gLQlpZiAoIWlzX3N1cmZhY2VfbGluZWFyKGZi
LT5tb2RpZmllciwgY29sb3JfcGxhbmUpKSB7Cj4gKwlpZiAoIWlzX3N1cmZhY2VfbGluZWFyKGZi
LCBjb2xvcl9wbGFuZSkpIHsKPiAgCQl1bnNpZ25lZCBpbnQgdGlsZV9zaXplLCB0aWxlX3dpZHRo
LCB0aWxlX2hlaWdodDsKPiAgCQl1bnNpZ25lZCBpbnQgdGlsZV9yb3dzLCB0aWxlcywgcGl0Y2hf
dGlsZXM7Cj4gIAo+IEBAIC0yNDQ1LDYgKzI0NzIsNyBAQCBzdGF0aWMgdW5zaWduZWQgaW50IGlu
dGVsX2ZiX21vZGlmaWVyX3RvX3RpbGluZyh1NjQgZmJfbW9kaWZpZXIpCj4gIAljYXNlIEk5MTVf
Rk9STUFUX01PRF9ZX1RJTEVEOgo+ICAJY2FzZSBJOTE1X0ZPUk1BVF9NT0RfWV9USUxFRF9DQ1M6
Cj4gIAljYXNlIEk5MTVfRk9STUFUX01PRF9ZX1RJTEVEX0dFTjEyX1JDX0NDUzoKPiArCWNhc2Ug
STkxNV9GT1JNQVRfTU9EX1lfVElMRURfR0VOMTJfTUNfQ0NTOgo+ICAJCXJldHVybiBJOTE1X1RJ
TElOR19ZOwo+ICAJZGVmYXVsdDoKPiAgCQlyZXR1cm4gSTkxNV9USUxJTkdfTk9ORTsKPiBAQCAt
MjQ5NCw2ICsyNTIyLDEzIEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2Zvcm1hdF9pbmZvIGdl
bjEyX2Njc19mb3JtYXRzW10gPSB7Cj4gIAkgIC5jcHAgPSB7IDQsIDEsIH0sIC5oc3ViID0gMiwg
LnZzdWIgPSAzMiwgLmhhc19hbHBoYSA9IHRydWUgfSwKPiAgfTsKPiAgCj4gK3N0YXRpYyBjb25z
dCBzdHJ1Y3QgZHJtX2Zvcm1hdF9pbmZvIGdlbjEyX21jX2Njc19mb3JtYXRzW10gPSB7Cj4gKwl7
IC5mb3JtYXQgPSBEUk1fRk9STUFUX1lVWVYsIC5udW1fcGxhbmVzID0gMiwKPiArCSAgLmNwcCA9
IHsgMiwgMSwgfSwgLmhzdWIgPSA0LCAudnN1YiA9IDMyLCAuaXNfeXV2ID0gdHJ1ZSB9LAo+ICsJ
eyAuZm9ybWF0ID0gRFJNX0ZPUk1BVF9OVjEyLCAubnVtX3BsYW5lcyA9IDQsCj4gKwkgIC5jcHAg
PSB7IDEsIDIsIDEsIDF9LCAuaHN1YiA9IDIsIC52c3ViID0gMiwgLmlzX3l1diA9IHRydWUgfSwK
PiArfTsKCkRvbid0IHdlIGFsc28gc3VwcG9ydCBtZWRpYSBjb21wcmVzc2lvbiBvbiBSR0IgYW5k
IG1vcmUgcGFja2VkIFlVVgpmb3JtYXRzPyAgSS5lLiwgc2VlIHRoZSBtYXRyaXggb24gYnNwZWMg
cGFnZSA0OTI1MC4KCj4gKwo+ICBzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9mb3JtYXRfaW5mbyAq
Cj4gIGxvb2t1cF9mb3JtYXRfaW5mbyhjb25zdCBzdHJ1Y3QgZHJtX2Zvcm1hdF9pbmZvIGZvcm1h
dHNbXSwKPiAgCQkgICBpbnQgbnVtX2Zvcm1hdHMsIHUzMiBmb3JtYXQpCj4gQEAgLTI1MTEsMTIg
KzI1NDYsMjEgQEAgbG9va3VwX2Zvcm1hdF9pbmZvKGNvbnN0IHN0cnVjdCBkcm1fZm9ybWF0X2lu
Zm8gZm9ybWF0c1tdLAo+ICBzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9mb3JtYXRfaW5mbyAqCj4g
IGludGVsX2dldF9mb3JtYXRfaW5mbyhjb25zdCBzdHJ1Y3QgZHJtX21vZGVfZmJfY21kMiAqY21k
KQo+ICB7Cj4gKwljb25zdCBzdHJ1Y3QgZHJtX2Zvcm1hdF9pbmZvICppbmZvOwo+ICsKPiAgCXN3
aXRjaCAoY21kLT5tb2RpZmllclswXSkgewo+ICAJY2FzZSBJOTE1X0ZPUk1BVF9NT0RfWV9USUxF
RF9DQ1M6Cj4gIAljYXNlIEk5MTVfRk9STUFUX01PRF9ZZl9USUxFRF9DQ1M6Cj4gIAkJcmV0dXJu
IGxvb2t1cF9mb3JtYXRfaW5mbyhza2xfY2NzX2Zvcm1hdHMsCj4gIAkJCQkJICBBUlJBWV9TSVpF
KHNrbF9jY3NfZm9ybWF0cyksCj4gIAkJCQkJICBjbWQtPnBpeGVsX2Zvcm1hdCk7Cj4gKwljYXNl
IEk5MTVfRk9STUFUX01PRF9ZX1RJTEVEX0dFTjEyX01DX0NDUzoKPiArCQlpbmZvID0gbG9va3Vw
X2Zvcm1hdF9pbmZvKGdlbjEyX21jX2Njc19mb3JtYXRzLAo+ICsJCQkJCSAgQVJSQVlfU0laRShn
ZW4xMl9tY19jY3NfZm9ybWF0cyksCj4gKwkJCQkJICBjbWQtPnBpeGVsX2Zvcm1hdCk7Cj4gKwkJ
aWYgKGluZm8pCj4gKwkJCXJldHVybiBpbmZvOwo+ICsJCS8qIGZhbGwgdGhyb3VnaCAqLwoKT2gs
IEkgc2VlLiAgWW91J3JlIGVmZmVjdGl2ZWx5IHVuaW9uaW5nIGdlbjEyX2Njc19mb3JtYXRzIGlu
IHdpdGggdGhpcwpmYWxsIHRocm91Z2guICBJIHN0aWxsIHRoaW5nIHRoYXQgd2luZHMgdXAgYmVp
bmcgYSBiaXQgY29uZnVzaW5nIHNvIEknZAphdCBsZWFzdCBwdXQgYSBjb21tZW50IHVwIGFib3Zl
IHRoZSBtY19jY3NfZm9ybWF0cyB0YWJsZS4gIEFsdGhvdWdoIEkKYWxzbyB3b3JyeSB0aGF0IGEg
ZnV0dXJlIHBsYXRmb3JtIG1pZ2h0IGFsbG93IHJlbmRlciBjb21wcmVzc2lvbiBvbiBzb21lCmZv
cm1hdCB0aGF0IGl0IGRvZXNuJ3Qgc3VwcG9ydCBtZWRpYSBjb21wcmVzc2lvbiBvbiwgd2hpY2gg
d291bGQgZm9yY2UKdXMgdG8gZGVjb3VwbGUgdGhlIHRhYmxlcyBhdCB0aGF0IHBvaW50LgoKRXZl
biBnaXZlbiB0aGUgdW5pb24gb2YgdGhlIHR3byB0YWJsZXMsIGFyZSB3ZSBzdGlsbCBtaXNzaW5n
IHNvbWUgb2YgdGhlCmFycmFuZ2VtZW50cyBvZiBZVVY0MjIgKGkuZS4sIFlWWVUsIFVZVlksIGFu
ZCBWWVVZKT8KCj4gIAljYXNlIEk5MTVfRk9STUFUX01PRF9ZX1RJTEVEX0dFTjEyX1JDX0NDUzoK
PiAgCQlyZXR1cm4gbG9va3VwX2Zvcm1hdF9pbmZvKGdlbjEyX2Njc19mb3JtYXRzLAo+ICAJCQkJ
CSAgQVJSQVlfU0laRShnZW4xMl9jY3NfZm9ybWF0cyksCj4gQEAgLTI1MjYsMTMgKzI1NzAsNiBA
QCBpbnRlbF9nZXRfZm9ybWF0X2luZm8oY29uc3Qgc3RydWN0IGRybV9tb2RlX2ZiX2NtZDIgKmNt
ZCkKPiAgCX0KPiAgfQo+ICAKPiAtYm9vbCBpc19jY3NfbW9kaWZpZXIodTY0IG1vZGlmaWVyKQo+
IC17Cj4gLQlyZXR1cm4gbW9kaWZpZXIgPT0gSTkxNV9GT1JNQVRfTU9EX1lfVElMRURfR0VOMTJf
UkNfQ0NTIHx8Cj4gLQkgICAgICAgbW9kaWZpZXIgPT0gSTkxNV9GT1JNQVRfTU9EX1lfVElMRURf
Q0NTIHx8Cj4gLQkgICAgICAgbW9kaWZpZXIgPT0gSTkxNV9GT1JNQVRfTU9EX1lmX1RJTEVEX0ND
UzsKPiAtfQo+IC0KPiAgdTMyIGludGVsX3BsYW5lX2ZiX21heF9zdHJpZGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAJCQkgICAgICB1MzIgcGl4ZWxfZm9ybWF0LCB1NjQg
bW9kaWZpZXIpCj4gIHsKPiBAQCAtMjU3Niw3ICsyNjEzLDcgQEAgaW50ZWxfZmJfc3RyaWRlX2Fs
aWdubWVudChjb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiwgaW50IGNvbG9yX3BsYW5l
KQo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShmYi0+ZGV2
KTsKPiAgCXUzMiB0aWxlX3dpZHRoOwo+ICAKPiAtCWlmIChpc19zdXJmYWNlX2xpbmVhcihmYi0+
bW9kaWZpZXIsIGNvbG9yX3BsYW5lKSkgewo+ICsJaWYgKGlzX3N1cmZhY2VfbGluZWFyKGZiLCBj
b2xvcl9wbGFuZSkpIHsKPiAgCQl1MzIgbWF4X3N0cmlkZSA9IGludGVsX3BsYW5lX2ZiX21heF9z
dHJpZGUoZGV2X3ByaXYsCj4gIAkJCQkJCQkgICBmYi0+Zm9ybWF0LT5mb3JtYXQsCj4gIAkJCQkJ
CQkgICBmYi0+bW9kaWZpZXIpOwo+IEBAIC0yNTkyLDcgKzI2MjksNyBAQCBpbnRlbF9mYl9zdHJp
ZGVfYWxpZ25tZW50KGNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLCBpbnQgY29sb3Jf
cGxhbmUpCj4gIAl9Cj4gIAo+ICAJdGlsZV93aWR0aCA9IGludGVsX3RpbGVfd2lkdGhfYnl0ZXMo
ZmIsIGNvbG9yX3BsYW5lKTsKPiAtCWlmIChpc19jY3NfbW9kaWZpZXIoZmItPm1vZGlmaWVyKSAm
JiBjb2xvcl9wbGFuZSA9PSAwKSB7Cj4gKwlpZiAoaXNfY2NzX21vZGlmaWVyKGZiLT5tb2RpZmll
cikpIHsKPiAgCQkvKgo+ICAJCSAqIERpc3BsYXkgV0EgIzA1MzE6IHNrbCxieHQsa2JsLGdsawo+
ICAJCSAqCj4gQEAgLTI2MDIsNyArMjYzOSw3IEBAIGludGVsX2ZiX3N0cmlkZV9hbGlnbm1lbnQo
Y29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIsIGludCBjb2xvcl9wbGFuZSkKPiAgCQkg
KiByZXF1aXJlIHRoZSBlbnRpcmUgZmIgdG8gYWNjb21tb2RhdGUgdGhhdCB0byBhdm9pZAo+ICAJ
CSAqIHBvdGVudGlhbCBydW50aW1lIGVycm9ycyBhdCBwbGFuZSBjb25maWd1cmF0aW9uIHRpbWUu
Cj4gIAkJICovCj4gLQkJaWYgKElTX0dFTihkZXZfcHJpdiwgOSkgJiYgZmItPndpZHRoID4gMzg0
MCkKPiArCQlpZiAoSVNfR0VOKGRldl9wcml2LCA5KSAmJiBjb2xvcl9wbGFuZSA9PSAwICYmIGZi
LT53aWR0aCA+IDM4NDApCj4gIAkJCXRpbGVfd2lkdGggKj0gNDsKPiAgCQkvKgo+ICAJCSAqIFRo
ZSBtYWluIHN1cmZhY2UgcGl0Y2ggbXVzdCBiZSBwYWRkZWQgdG8gYSBtdWx0aXBsZSBvZiBmb3Vy
Cj4gQEAgLTI2ODIsMjUgKzI3MTksNzUgQEAgc3RhdGljIGJvb2wgaW50ZWxfcGxhbmVfbmVlZHNf
cmVtYXAoY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPiAgCXJl
dHVybiBzdHJpZGUgPiBtYXhfc3RyaWRlOwo+ICB9Cj4gIAo+ICtzdGF0aWMgdm9pZAo+ICtpbnRl
bF9mYl9wbGFuZV9nZXRfc3Vic2FtcGxpbmcoaW50ICpoc3ViLCBpbnQgKnZzdWIsIGNvbnN0IHN0
cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLCBpbnQgY29sb3JfcGxhbmUpCj4gK3sKPiArCWludCBp
Owo+ICsJc3RhdGljIGNvbnN0IHN0cnVjdCB7Cj4gKwkJdTMyIGZvcm1hdDsKPiArCQlpbnQgdnN1
Yls0XTsKPiArCQlpbnQgaHN1Yls0XTsKPiArCX0gbWNfY2NzX3N1YnNhbXBsaW5nW10gPSB7IHsg
LmhzdWIgPSB7IDEsIDIsIDgsIDE2IH0sCj4gKwkJCQkgICAgIC52c3ViID0geyAxLCAyLCAzMiwg
MzIgfSwKPiArCQkJCSAgICAgLmZvcm1hdCA9IERSTV9GT1JNQVRfTlYxMiwgfSwKPiArCQkJCSB9
Owo+ICsKPiArCSpoc3ViID0gZmItPmZvcm1hdC0+aHN1YjsKPiArCSp2c3ViID0gZmItPmZvcm1h
dC0+dnN1YjsKPiArCj4gKwlpZiAoZmItPm1vZGlmaWVyID09IEk5MTVfRk9STUFUX01PRF9ZX1RJ
TEVEX0dFTjEyX01DX0NDUyAmJgo+ICsJICAgIGZiLT5mb3JtYXQtPm51bV9wbGFuZXMgPT0gNCkg
ewo+ICsJCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKG1jX2Njc19zdWJzYW1wbGluZyk7IGkr
Kykgewo+ICsJCQlpZiAgKG1jX2Njc19zdWJzYW1wbGluZ1tpXS5mb3JtYXQgPT0gZmItPmZvcm1h
dC0+Zm9ybWF0KSB7Cj4gKwkJCQkqaHN1YiA9IG1jX2Njc19zdWJzYW1wbGluZ1tpXS5oc3ViW2Nv
bG9yX3BsYW5lXTsKPiArCQkJCSp2c3ViID0gbWNfY2NzX3N1YnNhbXBsaW5nW2ldLnZzdWJbY29s
b3JfcGxhbmVdOwo+ICsJCQkJYnJlYWs7Cj4gKwkJCX0KPiArCQl9Cj4gKwkJV0FSTl9PTihpID09
IEFSUkFZX1NJWkUobWNfY2NzX3N1YnNhbXBsaW5nKSk7Cj4gKwl9Cj4gK30KPiArCj4gK3N0YXRp
YyB2b2lkCj4gK2ludGVsX2ZiX3BsYW5lX2RpbXMoaW50ICp3LCBpbnQgKmgsIHN0cnVjdCBkcm1f
ZnJhbWVidWZmZXIgKmZiLCBpbnQgY29sb3JfcGxhbmUpCj4gK3sKPiArCWludCBoc3ViLCB2c3Vi
Owo+ICsKPiArCWludGVsX2ZiX3BsYW5lX2dldF9zdWJzYW1wbGluZygmaHN1YiwgJnZzdWIsIGZi
LCBjb2xvcl9wbGFuZSk7Cj4gKwkqdyA9IGZiLT53aWR0aC9oc3ViOwo+ICsJKmggPSBmYi0+aGVp
Z2h0L3ZzdWI7Cj4gK30KPiArCj4gIHN0YXRpYyBpbnQKPiAtaW50ZWxfZmJfY2hlY2tfY2NzX3h5
KHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLCBpbnQgeCwgaW50IHkpCj4gK2ludGVsX2ZiX2No
ZWNrX2Njc194eShzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiwgaW50IGF1eF9wbGFuZSwgaW50
IHgsIGludCB5KQo+ICB7Cj4gIAlzdHJ1Y3QgaW50ZWxfZnJhbWVidWZmZXIgKmludGVsX2ZiID0g
dG9faW50ZWxfZnJhbWVidWZmZXIoZmIpOwo+IC0JaW50IGhzdWIgPSBmYi0+Zm9ybWF0LT5oc3Vi
Owo+IC0JaW50IHZzdWIgPSBmYi0+Zm9ybWF0LT52c3ViOwo+ICsJaW50IGhzdWIsIHZzdWI7Cj4g
KwlpbnQgaHN1Yl9tYWluLCB2c3ViX21haW47Cj4gIAlpbnQgdGlsZV93aWR0aCwgdGlsZV9oZWln
aHQ7Cj4gIAlpbnQgY2NzX3gsIGNjc195Owo+ICAJaW50IG1haW5feCwgbWFpbl95Owo+ICsJaW50
IG1haW5fcGxhbmU7Cj4gKwo+ICsJaWYgKCFpc19jY3NfcGxhbmUoZmIsIGF1eF9wbGFuZSkpCj4g
KwkJcmV0dXJuIDA7Cj4gKwo+ICsJbWFpbl9wbGFuZSA9IChhdXhfcGxhbmUgLSAxKSAvIDI7CgpU
aGlzIGFsc28gZG9lc24ndCBtZW50aW9uIHRoZSBtb2RpZmllciBkZXNjcmlwdGlvbiBjb21tZW50
LiAgU28gSSBndWVzcwp0aGF0IGNvbW1lbnQganVzdCBuZWVkcyB0byBiZSB1cGRhdGVkLCBhbmQg
bWF5YmUgd2l0aCBhIGRlc2NyaXB0aW9uIHRoYXQKdGhlIGRybV9mcmFtZWJ1ZmZlciBjb2xvciBw
bGFuZSBvcmRlcmluZyBkb2Vzbid0IG1hdGNoIHRoZSBvcmRlciB0aGF0CnRoZXkgc2hvdyB1cCBp
biBtZW1vcnkuCgo+ICsJaW50ZWxfdGlsZV9kaW1zKGZiLCBhdXhfcGxhbmUsICZ0aWxlX3dpZHRo
LCAmdGlsZV9oZWlnaHQpOwo+ICsJaW50ZWxfZmJfcGxhbmVfZ2V0X3N1YnNhbXBsaW5nKCZoc3Vi
LCAmdnN1YiwgZmIsIGF1eF9wbGFuZSk7Cj4gKwlpbnRlbF9mYl9wbGFuZV9nZXRfc3Vic2FtcGxp
bmcoJmhzdWJfbWFpbiwgJnZzdWJfbWFpbiwgZmIsCj4gKwkJCQkgICAgICAgbWFpbl9wbGFuZSk7
Cj4gIAo+IC0JaW50ZWxfdGlsZV9kaW1zKGZiLCAxLCAmdGlsZV93aWR0aCwgJnRpbGVfaGVpZ2h0
KTsKPiArCWhzdWIgLz0gaHN1Yl9tYWluOwo+ICsJdnN1YiAvPSB2c3ViX21haW47Cj4gIAo+ICAJ
dGlsZV93aWR0aCAqPSBoc3ViOwo+ICAJdGlsZV9oZWlnaHQgKj0gdnN1YjsKPiAgCj4gIAljY3Nf
eCA9ICh4ICogaHN1YikgJSB0aWxlX3dpZHRoOwo+ICAJY2NzX3kgPSAoeSAqIHZzdWIpICUgdGls
ZV9oZWlnaHQ7Cj4gLQltYWluX3ggPSBpbnRlbF9mYi0+bm9ybWFsWzBdLnggJSB0aWxlX3dpZHRo
Owo+IC0JbWFpbl95ID0gaW50ZWxfZmItPm5vcm1hbFswXS55ICUgdGlsZV9oZWlnaHQ7Cj4gKwlt
YWluX3ggPSBpbnRlbF9mYi0+bm9ybWFsW21haW5fcGxhbmVdLnggJSB0aWxlX3dpZHRoOwo+ICsJ
bWFpbl95ID0gaW50ZWxfZmItPm5vcm1hbFttYWluX3BsYW5lXS55ICUgdGlsZV9oZWlnaHQ7Cj4g
IAo+ICAJLyoKPiAgCSogQ0NTIGRvZXNuJ3QgaGF2ZSBpdHMgb3duIHgveSBvZmZzZXQgcmVnaXN0
ZXIsIHNvIHRoZSBpbnRyYSBDQ1MgdGlsZQo+IEBAIC0yNzEwLDggKzI3OTcsOCBAQCBpbnRlbF9m
Yl9jaGVja19jY3NfeHkoc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIsIGludCB4LCBpbnQgeSkK
PiAgCQlEUk1fREVCVUdfS01TKCJCYWQgQ0NTIHgveSAobWFpbiAlZCwlZCBjY3MgJWQsJWQpIGZ1
bGwgKG1haW4gJWQsJWQgY2NzICVkLCVkKVxuIiwKPiAgCQkJICAgICAgbWFpbl94LCBtYWluX3ks
Cj4gIAkJCSAgICAgIGNjc194LCBjY3NfeSwKPiAtCQkJICAgICAgaW50ZWxfZmItPm5vcm1hbFsw
XS54LAo+IC0JCQkgICAgICBpbnRlbF9mYi0+bm9ybWFsWzBdLnksCj4gKwkJCSAgICAgIGludGVs
X2ZiLT5ub3JtYWxbbWFpbl9wbGFuZV0ueCwKPiArCQkJICAgICAgaW50ZWxfZmItPm5vcm1hbFtt
YWluX3BsYW5lXS55LAo+ICAJCQkgICAgICB4LCB5KTsKPiAgCQlyZXR1cm4gLUVJTlZBTDsKPiAg
CX0KPiBAQCAtMjczOSw4ICsyODI2LDcgQEAgaW50ZWxfZmlsbF9mYl9pbmZvKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgCQlpbnQgcmV0Owo+ICAKPiAgCQljcHAgPSBmYi0+
Zm9ybWF0LT5jcHBbaV07Cj4gLQkJd2lkdGggPSBkcm1fZnJhbWVidWZmZXJfcGxhbmVfd2lkdGgo
ZmItPndpZHRoLCBmYiwgaSk7Cj4gLQkJaGVpZ2h0ID0gZHJtX2ZyYW1lYnVmZmVyX3BsYW5lX2hl
aWdodChmYi0+aGVpZ2h0LCBmYiwgaSk7Cj4gKwkJaW50ZWxfZmJfcGxhbmVfZGltcygmd2lkdGgs
ICZoZWlnaHQsIGZiLCBpKTsKPiAgCj4gIAkJcmV0ID0gaW50ZWxfZmJfb2Zmc2V0X3RvX3h5KCZ4
LCAmeSwgZmIsIGkpOwo+ICAJCWlmIChyZXQpIHsKPiBAQCAtMjc0OSwxMSArMjgzNSw5IEBAIGlu
dGVsX2ZpbGxfZmJfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gIAkJ
CXJldHVybiByZXQ7Cj4gIAkJfQo+ICAKPiAtCQlpZiAoaXNfY2NzX21vZGlmaWVyKGZiLT5tb2Rp
ZmllcikgJiYgaSA9PSAxKSB7Cj4gLQkJCXJldCA9IGludGVsX2ZiX2NoZWNrX2Njc194eShmYiwg
eCwgeSk7Cj4gLQkJCWlmIChyZXQpCj4gLQkJCQlyZXR1cm4gcmV0Owo+IC0JCX0KPiArCQlyZXQg
PSBpbnRlbF9mYl9jaGVja19jY3NfeHkoZmIsIGksIHgsIHkpOwo+ICsJCWlmIChyZXQpCj4gKwkJ
CXJldHVybiByZXQ7Cj4gIAo+ICAJCS8qCj4gIAkJICogVGhlIGZlbmNlIChpZiB1c2VkKSBpcyBh
bGlnbmVkIHRvIHRoZSBzdGFydCBvZiB0aGUgb2JqZWN0Cj4gQEAgLTMzNzEsNiArMzQ1NSw3IEBA
IHN0YXRpYyBpbnQgc2tsX21heF9wbGFuZV93aWR0aChjb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVm
ZmVyICpmYiwKPiAgCQkJcmV0dXJuIDUxMjA7Cj4gIAljYXNlIEk5MTVfRk9STUFUX01PRF9ZX1RJ
TEVEX0NDUzoKPiAgCWNhc2UgSTkxNV9GT1JNQVRfTU9EX1lmX1RJTEVEX0NDUzoKPiArCWNhc2Ug
STkxNV9GT1JNQVRfTU9EX1lfVElMRURfR0VOMTJfTUNfQ0NTOgo+ICAJCS8qIEZJWE1FIEFVWCBw
bGFuZT8gKi8KPiAgCWNhc2UgSTkxNV9GT1JNQVRfTU9EX1lfVElMRUQ6Cj4gIAljYXNlIEk5MTVf
Rk9STUFUX01PRF9ZZl9USUxFRDoKPiBAQCAtMzQzMCwxNiArMzUxNSwxOCBAQCBzdGF0aWMgaW50
IGljbF9tYXhfcGxhbmVfaGVpZ2h0KHZvaWQpCj4gIH0KPiAgCj4gIHN0YXRpYyBib29sIHNrbF9j
aGVja19tYWluX2Njc19jb29yZGluYXRlcyhzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5l
X3N0YXRlLAo+IC0JCQkJCSAgIGludCBtYWluX3gsIGludCBtYWluX3ksIHUzMiBtYWluX29mZnNl
dCkKPiArCQkJCQkgICBpbnQgbWFpbl94LCBpbnQgbWFpbl95LAo+ICsJCQkJCSAgIHUzMiBtYWlu
X29mZnNldCwgaW50IGF1eF9wbGFuZSkKPiAgewo+ICAJY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1
ZmZlciAqZmIgPSBwbGFuZV9zdGF0ZS0+YmFzZS5mYjsKPiAtCWludCBoc3ViID0gZmItPmZvcm1h
dC0+aHN1YjsKPiAtCWludCB2c3ViID0gZmItPmZvcm1hdC0+dnN1YjsKPiAtCWludCBhdXhfeCA9
IHBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVsxXS54Owo+IC0JaW50IGF1eF95ID0gcGxhbmVfc3Rh
dGUtPmNvbG9yX3BsYW5lWzFdLnk7Cj4gLQl1MzIgYXV4X29mZnNldCA9IHBsYW5lX3N0YXRlLT5j
b2xvcl9wbGFuZVsxXS5vZmZzZXQ7Cj4gLQl1MzIgYWxpZ25tZW50ID0gaW50ZWxfc3VyZl9hbGln
bm1lbnQoZmIsIDEpOwo+IC0KPiArCWludCBoc3ViOwo+ICsJaW50IHZzdWI7Cj4gKwlpbnQgYXV4
X3ggPSBwbGFuZV9zdGF0ZS0+Y29sb3JfcGxhbmVbYXV4X3BsYW5lXS54Owo+ICsJaW50IGF1eF95
ID0gcGxhbmVfc3RhdGUtPmNvbG9yX3BsYW5lW2F1eF9wbGFuZV0ueTsKPiArCXUzMiBhdXhfb2Zm
c2V0ID0gcGxhbmVfc3RhdGUtPmNvbG9yX3BsYW5lW2F1eF9wbGFuZV0ub2Zmc2V0Owo+ICsJdTMy
IGFsaWdubWVudCA9IGludGVsX3N1cmZfYWxpZ25tZW50KGZiLCBhdXhfcGxhbmUpOwo+ICsKPiAr
CWludGVsX2ZiX3BsYW5lX2dldF9zdWJzYW1wbGluZygmaHN1YiwgJnZzdWIsIGZiLCBhdXhfcGxh
bmUpOwo+ICAJd2hpbGUgKGF1eF9vZmZzZXQgPj0gbWFpbl9vZmZzZXQgJiYgYXV4X3kgPD0gbWFp
bl95KSB7Cj4gIAkJaW50IHgsIHk7Cj4gIAo+IEBAIC0zNDUxLDcgKzM1MzgsNyBAQCBzdGF0aWMg
Ym9vbCBza2xfY2hlY2tfbWFpbl9jY3NfY29vcmRpbmF0ZXMoc3RydWN0IGludGVsX3BsYW5lX3N0
YXRlICpwbGFuZV9zdGF0ZQo+ICAKPiAgCQl4ID0gYXV4X3ggLyBoc3ViOwo+ICAJCXkgPSBhdXhf
eSAvIHZzdWI7Cj4gLQkJYXV4X29mZnNldCA9IGludGVsX3BsYW5lX2FkanVzdF9hbGlnbmVkX29m
ZnNldCgmeCwgJnksIHBsYW5lX3N0YXRlLCAxLAo+ICsJCWF1eF9vZmZzZXQgPSBpbnRlbF9wbGFu
ZV9hZGp1c3RfYWxpZ25lZF9vZmZzZXQoJngsICZ5LCBwbGFuZV9zdGF0ZSwgYXV4X3BsYW5lLAo+
ICAJCQkJCQkJICAgICAgIGF1eF9vZmZzZXQsIGF1eF9vZmZzZXQgLSBhbGlnbm1lbnQpOwo+ICAJ
CWF1eF94ID0geCAqIGhzdWIgKyBhdXhfeCAlIGhzdWI7Cj4gIAkJYXV4X3kgPSB5ICogdnN1YiAr
IGF1eF95ICUgdnN1YjsKPiBAQCAtMzQ2MCw5ICszNTQ3LDkgQEAgc3RhdGljIGJvb2wgc2tsX2No
ZWNrX21haW5fY2NzX2Nvb3JkaW5hdGVzKHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVf
c3RhdGUKPiAgCWlmIChhdXhfeCAhPSBtYWluX3ggfHwgYXV4X3kgIT0gbWFpbl95KQo+ICAJCXJl
dHVybiBmYWxzZTsKPiAgCj4gLQlwbGFuZV9zdGF0ZS0+Y29sb3JfcGxhbmVbMV0ub2Zmc2V0ID0g
YXV4X29mZnNldDsKPiAtCXBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVsxXS54ID0gYXV4X3g7Cj4g
LQlwbGFuZV9zdGF0ZS0+Y29sb3JfcGxhbmVbMV0ueSA9IGF1eF95Owo+ICsJcGxhbmVfc3RhdGUt
PmNvbG9yX3BsYW5lW2F1eF9wbGFuZV0ub2Zmc2V0ID0gYXV4X29mZnNldDsKPiArCXBsYW5lX3N0
YXRlLT5jb2xvcl9wbGFuZVthdXhfcGxhbmVdLnggPSBhdXhfeDsKPiArCXBsYW5lX3N0YXRlLT5j
b2xvcl9wbGFuZVthdXhfcGxhbmVdLnkgPSBhdXhfeTsKPiAgCj4gIAlyZXR1cm4gdHJ1ZTsKPiAg
fQo+IEBAIC0zNDc4LDcgKzM1NjUsOCBAQCBzdGF0aWMgaW50IHNrbF9jaGVja19tYWluX3N1cmZh
Y2Uoc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPiAgCWludCBoID0gZHJt
X3JlY3RfaGVpZ2h0KCZwbGFuZV9zdGF0ZS0+YmFzZS5zcmMpID4+IDE2Owo+ICAJaW50IG1heF93
aWR0aDsKPiAgCWludCBtYXhfaGVpZ2h0Owo+IC0JdTMyIGFsaWdubWVudCwgb2Zmc2V0LCBhdXhf
b2Zmc2V0ID0gcGxhbmVfc3RhdGUtPmNvbG9yX3BsYW5lWzFdLm9mZnNldDsKPiArCWludCBhdXhf
cGxhbmUgPSBmYi0+Zm9ybWF0LT5udW1fcGxhbmVzIC8gMjsKPiArCXUzMiBhbGlnbm1lbnQsIG9m
ZnNldCwgYXV4X29mZnNldCA9IHBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVthdXhfcGxhbmVdLm9m
ZnNldDsKPiAgCj4gIAlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKPiAgCQltYXhfd2lk
dGggPSBpY2xfbWF4X3BsYW5lX3dpZHRoKGZiLCAwLCByb3RhdGlvbik7Cj4gQEAgLTM1MzYsNyAr
MzYyNCw5IEBAIHN0YXRpYyBpbnQgc2tsX2NoZWNrX21haW5fc3VyZmFjZShzdHJ1Y3QgaW50ZWxf
cGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+ICAJICogdGhleSBtYXRjaCB3aXRoIHRoZSBtYWlu
IHN1cmZhY2UgeC95IG9mZnNldHMuCj4gIAkgKi8KPiAgCWlmIChpc19jY3NfbW9kaWZpZXIoZmIt
Pm1vZGlmaWVyKSkgewo+IC0JCXdoaWxlICghc2tsX2NoZWNrX21haW5fY2NzX2Nvb3JkaW5hdGVz
KHBsYW5lX3N0YXRlLCB4LCB5LCBvZmZzZXQpKSB7Cj4gKwo+ICsJCXdoaWxlICghc2tsX2NoZWNr
X21haW5fY2NzX2Nvb3JkaW5hdGVzKHBsYW5lX3N0YXRlLCB4LCB5LAo+ICsJCQkJCQkgICAgICAg
b2Zmc2V0LCBhdXhfcGxhbmUpKSB7Cj4gIAkJCWlmIChvZmZzZXQgPT0gMCkKPiAgCQkJCWJyZWFr
Owo+ICAKPiBAQCAtMzU0NCw3ICszNjM0LDggQEAgc3RhdGljIGludCBza2xfY2hlY2tfbWFpbl9z
dXJmYWNlKHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gIAkJCQkJCQkJ
ICAgb2Zmc2V0LCBvZmZzZXQgLSBhbGlnbm1lbnQpOwo+ICAJCX0KPiAgCj4gLQkJaWYgKHggIT0g
cGxhbmVfc3RhdGUtPmNvbG9yX3BsYW5lWzFdLnggfHwgeSAhPSBwbGFuZV9zdGF0ZS0+Y29sb3Jf
cGxhbmVbMV0ueSkgewo+ICsJCWlmICh4ICE9IHBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVthdXhf
cGxhbmVdLnggfHwKPiArCQkgICAgeSAhPSBwbGFuZV9zdGF0ZS0+Y29sb3JfcGxhbmVbYXV4X3Bs
YW5lXS55KSB7Cj4gIAkJCURSTV9ERUJVR19LTVMoIlVuYWJsZSB0byBmaW5kIHN1aXRhYmxlIGRp
c3BsYXkgc3VyZmFjZSBvZmZzZXQgZHVlIHRvIENDU1xuIik7Cj4gIAkJCXJldHVybiAtRUlOVkFM
Owo+ICAJCX0KPiBAQCAtMzU4Nyw2ICszNjc4LDQxIEBAIHN0YXRpYyBpbnQgc2tsX2NoZWNrX252
MTJfYXV4X3N1cmZhY2Uoc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPiAg
CQlyZXR1cm4gLUVJTlZBTDsKPiAgCX0KPiAgCj4gKwlpZiAoaXNfY2NzX21vZGlmaWVyKGZiLT5t
b2RpZmllcikpIHsKPiArCQlpbnQgYXV4X29mZnNldCA9IHBsYW5lX3N0YXRlLT5jb2xvcl9wbGFu
ZVszXS5vZmZzZXQ7Cj4gKwkJaW50IGFsaWdubWVudCA9IGludGVsX3N1cmZfYWxpZ25tZW50KGZi
LCAxKTsKPiArCj4gKwkJaWYgKG9mZnNldCA+IGF1eF9vZmZzZXQpIHsKPiArCQkJaW50IGhzdWIs
IHZzdWI7Cj4gKwkJCWludCBtYWluX3ggPSB4LCBtYWluX3kgPSB5Owo+ICsKPiArCj4gKwkJCWlu
dGVsX2ZiX3BsYW5lX2dldF9zdWJzYW1wbGluZygmaHN1YiwgJnZzdWIsIGZiLCAxKTsKPiArCQkJ
eCA9IG1haW5feCAvIGhzdWI7Cj4gKwkJCXkgPSBtYWluX3kgLyB2c3ViOwo+ICsJCQlvZmZzZXQg
PSBpbnRlbF9wbGFuZV9hZGp1c3RfYWxpZ25lZF9vZmZzZXQoJngsICZ5LCBwbGFuZV9zdGF0ZSwg
MSwKPiArCQkJCQkJCQkgICBvZmZzZXQsCj4gKwkJCQkJCQkJICAgYXV4X29mZnNldCAmIH4oYWxp
Z25tZW50IC0gMSkpOwo+ICsJCQl4ID0geCAqIGhzdWIgKyBtYWluX3ggJSBoc3ViOwo+ICsJCQl5
ID0geSAqIHZzdWIgKyBtYWluX3kgJSB2c3ViOwo+ICsKPiArCQl9Cj4gKwo+ICsJCXdoaWxlICgh
c2tsX2NoZWNrX21haW5fY2NzX2Nvb3JkaW5hdGVzKHBsYW5lX3N0YXRlLCB4LCB5LCBvZmZzZXQs
IDMpKSB7Cj4gKwkJCWlmIChvZmZzZXQgPT0gMCkKPiArCQkJCWJyZWFrOwo+ICsKPiArCQkJb2Zm
c2V0ID0gaW50ZWxfcGxhbmVfYWRqdXN0X2FsaWduZWRfb2Zmc2V0KCZ4LCAmeSwgcGxhbmVfc3Rh
dGUsIDEsCj4gKwkJCQkJCQkJICAgb2Zmc2V0LCBvZmZzZXQgLSBhbGlnbm1lbnQpOwo+ICsJCX0K
PiArCj4gKwkJaWYgKHggIT0gcGxhbmVfc3RhdGUtPmNvbG9yX3BsYW5lWzNdLnggfHwKPiArCQkg
ICAgeSAhPSBwbGFuZV9zdGF0ZS0+Y29sb3JfcGxhbmVbM10ueSkgewo+ICsJCQlEUk1fREVCVUdf
S01TKCJVbmFibGUgdG8gZmluZCBzdWl0YWJsZSBkaXNwbGF5IHN1cmZhY2Ugb2Zmc2V0IGR1ZSB0
byBDQ1NcbiIpOwo+ICsJCQlyZXR1cm4gLUVJTlZBTDsKPiArCQl9Cj4gKwl9Cj4gKwo+ICAJcGxh
bmVfc3RhdGUtPmNvbG9yX3BsYW5lWzFdLm9mZnNldCA9IG9mZnNldDsKPiAgCXBsYW5lX3N0YXRl
LT5jb2xvcl9wbGFuZVsxXS54ID0geDsKPiAgCXBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVsxXS55
ID0geTsKPiBAQCAtMzU5OSwxOSArMzcyNSwzMCBAQCBzdGF0aWMgaW50IHNrbF9jaGVja19jY3Nf
YXV4X3N1cmZhY2Uoc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPiAgCWNv
bnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxhbmVfc3RhdGUtPmJhc2UuZmI7Cj4g
IAlpbnQgc3JjX3ggPSBwbGFuZV9zdGF0ZS0+YmFzZS5zcmMueDEgPj4gMTY7Cj4gIAlpbnQgc3Jj
X3kgPSBwbGFuZV9zdGF0ZS0+YmFzZS5zcmMueTEgPj4gMTY7Cj4gLQlpbnQgaHN1YiA9IGZiLT5m
b3JtYXQtPmhzdWI7Cj4gLQlpbnQgdnN1YiA9IGZiLT5mb3JtYXQtPnZzdWI7Cj4gLQlpbnQgeCA9
IHNyY194IC8gaHN1YjsKPiAtCWludCB5ID0gc3JjX3kgLyB2c3ViOwo+ICAJdTMyIG9mZnNldDsK
PiArCWludCBjY3M7Cj4gIAo+IC0JaW50ZWxfYWRkX2ZiX29mZnNldHMoJngsICZ5LCBwbGFuZV9z
dGF0ZSwgMSk7Cj4gLQlvZmZzZXQgPSBpbnRlbF9wbGFuZV9jb21wdXRlX2FsaWduZWRfb2Zmc2V0
KCZ4LCAmeSwgcGxhbmVfc3RhdGUsIDEpOwo+ICAKPiAtCXBsYW5lX3N0YXRlLT5jb2xvcl9wbGFu
ZVsxXS5vZmZzZXQgPSBvZmZzZXQ7Cj4gLQlwbGFuZV9zdGF0ZS0+Y29sb3JfcGxhbmVbMV0ueCA9
IHggKiBoc3ViICsgc3JjX3ggJSBoc3ViOwo+IC0JcGxhbmVfc3RhdGUtPmNvbG9yX3BsYW5lWzFd
LnkgPSB5ICogdnN1YiArIHNyY195ICUgdnN1YjsKPiArCWZvciAoY2NzID0gZmItPmZvcm1hdC0+
bnVtX3BsYW5lcyAvIDI7IGNjcyA8IGZiLT5mb3JtYXQtPm51bV9wbGFuZXM7IGNjcysrKSB7Cj4g
KwkJaW50IGhzdWIsIHZzdWI7Cj4gKwkJaW50IG1haW5faHN1YiwgbWFpbl92c3ViOwo+ICsJCWlu
dCB4LCB5Owo+ICsKPiArCQlpbnRlbF9mYl9wbGFuZV9nZXRfc3Vic2FtcGxpbmcoJmhzdWIsICZ2
c3ViLCBmYiwgY2NzKTsKPiArCQlpbnRlbF9mYl9wbGFuZV9nZXRfc3Vic2FtcGxpbmcoJm1haW5f
aHN1YiwgJm1haW5fdnN1YiwgZmIsIChjY3MgLSAxKS8gMik7Cj4gKwo+ICsJCWhzdWIgLz0gbWFp
bl9oc3ViOwo+ICsJCXZzdWIgLz0gbWFpbl92c3ViOwo+ICsJCXggPSBzcmNfeCAvIGhzdWI7Cj4g
KwkJeSA9IHNyY195IC8gdnN1YjsKPiAgCj4gKwkJaW50ZWxfYWRkX2ZiX29mZnNldHMoJngsICZ5
LCBwbGFuZV9zdGF0ZSwgY2NzKTsKPiArCQlvZmZzZXQgPSBpbnRlbF9wbGFuZV9jb21wdXRlX2Fs
aWduZWRfb2Zmc2V0KCZ4LCAmeSwKPiArCQkJCQkJCSAgICBwbGFuZV9zdGF0ZSwgY2NzKTsKPiAr
CQlwbGFuZV9zdGF0ZS0+Y29sb3JfcGxhbmVbY2NzXS5vZmZzZXQgPSBvZmZzZXQ7Cj4gKwkJcGxh
bmVfc3RhdGUtPmNvbG9yX3BsYW5lW2Njc10ueCA9IHggKiBoc3ViICsgc3JjX3ggJSBoc3ViOwo+
ICsJCXBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVtjY3NdLnkgPSB5ICogdnN1YiArIHNyY195ICUg
dnN1YjsKPiArCX0KPiAgCXJldHVybiAwOwo+ICB9Cj4gIAo+IEBAIC0zNjE5LDYgKzM3NTYsNyBA
QCBpbnQgc2tsX2NoZWNrX3BsYW5lX3N1cmZhY2Uoc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpw
bGFuZV9zdGF0ZSkKPiAgewo+ICAJY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBw
bGFuZV9zdGF0ZS0+YmFzZS5mYjsKPiAgCWludCByZXQ7Cj4gKwlib29sIG5lZWRzX2F1eCA9IGZh
bHNlOwo+ICAKPiAgCXJldCA9IGludGVsX3BsYW5lX2NvbXB1dGVfZ3R0KHBsYW5lX3N0YXRlKTsK
PiAgCWlmIChyZXQpCj4gQEAgLTM2MjgsMjEgKzM3NjYsMzEgQEAgaW50IHNrbF9jaGVja19wbGFu
ZV9zdXJmYWNlKHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gIAkJcmV0
dXJuIDA7Cj4gIAo+ICAJLyoKPiAtCSAqIEhhbmRsZSB0aGUgQVVYIHN1cmZhY2UgZmlyc3Qgc2lu
Y2UKPiAtCSAqIHRoZSBtYWluIHN1cmZhY2Ugc2V0dXAgZGVwZW5kcyBvbiBpdC4KPiArCSAqIEhh
bmRsZSB0aGUgQVVYIHN1cmZhY2UgZmlyc3Qgc2luY2UgdGhlIG1haW4gc3VyZmFjZSBzZXR1cCBk
ZXBlbmRzIG9uCj4gKwkgKiBpdC4KPiAgCSAqLwo+IC0JaWYgKGRybV9mb3JtYXRfaW5mb19pc195
dXZfc2VtaXBsYW5hcihmYi0+Zm9ybWF0KSkgewo+IC0JCXJldCA9IHNrbF9jaGVja19udjEyX2F1
eF9zdXJmYWNlKHBsYW5lX3N0YXRlKTsKPiArCWlmIChpc19jY3NfbW9kaWZpZXIoZmItPm1vZGlm
aWVyKSkgewo+ICsJCW5lZWRzX2F1eCA9IHRydWU7Cj4gKwkJcmV0ID0gc2tsX2NoZWNrX2Njc19h
dXhfc3VyZmFjZShwbGFuZV9zdGF0ZSk7Cj4gIAkJaWYgKHJldCkKPiAgCQkJcmV0dXJuIHJldDsK
PiAtCX0gZWxzZSBpZiAoaXNfY2NzX21vZGlmaWVyKGZiLT5tb2RpZmllcikpIHsKPiAtCQlyZXQg
PSBza2xfY2hlY2tfY2NzX2F1eF9zdXJmYWNlKHBsYW5lX3N0YXRlKTsKPiArCX0KPiArCj4gKwlp
ZiAoZHJtX2Zvcm1hdF9pbmZvX2lzX3l1dl9zZW1pcGxhbmFyKGZiLT5mb3JtYXQpKSB7Cj4gKwkJ
bmVlZHNfYXV4ID0gdHJ1ZTsKPiArCQlyZXQgPSBza2xfY2hlY2tfbnYxMl9hdXhfc3VyZmFjZShw
bGFuZV9zdGF0ZSk7Cj4gIAkJaWYgKHJldCkKPiAgCQkJcmV0dXJuIHJldDsKPiAtCX0gZWxzZSB7
Cj4gLQkJcGxhbmVfc3RhdGUtPmNvbG9yX3BsYW5lWzFdLm9mZnNldCA9IH4weGZmZjsKPiAtCQlw
bGFuZV9zdGF0ZS0+Y29sb3JfcGxhbmVbMV0ueCA9IDA7Cj4gLQkJcGxhbmVfc3RhdGUtPmNvbG9y
X3BsYW5lWzFdLnkgPSAwOwo+ICsJfQo+ICsKPiArCWlmICghbmVlZHNfYXV4KSB7Cj4gKwkJaW50
IGk7Cj4gKwo+ICsJCWZvciAoaSA9IDE7IGkgPCBmYi0+Zm9ybWF0LT5udW1fcGxhbmVzOyBpKysp
IHsKPiArCQkJcGxhbmVfc3RhdGUtPmNvbG9yX3BsYW5lW2ldLm9mZnNldCA9IH4weGZmZjsKPiAr
CQkJcGxhbmVfc3RhdGUtPmNvbG9yX3BsYW5lW2ldLnggPSAwOwo+ICsJCQlwbGFuZV9zdGF0ZS0+
Y29sb3JfcGxhbmVbaV0ueSA9IDA7Cj4gKwkJfQo+ICAJfQo+ICAKPiAgCXJldCA9IHNrbF9jaGVj
a19tYWluX3N1cmZhY2UocGxhbmVfc3RhdGUpOwo+IEBAIC00MDMwLDcgKzQxNzgsNyBAQCBzdGF0
aWMgdW5zaWduZWQgaW50IHNrbF9wbGFuZV9zdHJpZGVfbXVsdChjb25zdCBzdHJ1Y3QgZHJtX2Zy
YW1lYnVmZmVyICpmYiwKPiAgCSAqIFRoZSBzdHJpZGUgaXMgZWl0aGVyIGV4cHJlc3NlZCBhcyBh
IG11bHRpcGxlIG9mIDY0IGJ5dGVzIGNodW5rcyBmb3IKPiAgCSAqIGxpbmVhciBidWZmZXJzIG9y
IGluIG51bWJlciBvZiB0aWxlcyBmb3IgdGlsZWQgYnVmZmVycy4KPiAgCSAqLwo+IC0JaWYgKGlz
X3N1cmZhY2VfbGluZWFyKGZiLT5tb2RpZmllciwgY29sb3JfcGxhbmUpKQo+ICsJaWYgKGlzX3N1
cmZhY2VfbGluZWFyKGZiLCBjb2xvcl9wbGFuZSkpCj4gIAkJcmV0dXJuIDY0Owo+ICAJZWxzZSBp
ZiAoZHJtX3JvdGF0aW9uXzkwX29yXzI3MChyb3RhdGlvbikpCj4gIAkJcmV0dXJuIGludGVsX3Rp
bGVfaGVpZ2h0KGZiLCBjb2xvcl9wbGFuZSk7Cj4gQEAgLTQxNjAsNiArNDMwOCw4IEBAIHN0YXRp
YyB1MzIgc2tsX3BsYW5lX2N0bF90aWxpbmcodTY0IGZiX21vZGlmaWVyKQo+ICAJCXJldHVybiBQ
TEFORV9DVExfVElMRURfWSB8Cj4gIAkJICAgICAgIFBMQU5FX0NUTF9SRU5ERVJfREVDT01QUkVT
U0lPTl9FTkFCTEUgfAo+ICAJCSAgICAgICBQTEFORV9DVExfQ0xFQVJfQ09MT1JfRElTQUJMRTsK
PiArCWNhc2UgSTkxNV9GT1JNQVRfTU9EX1lfVElMRURfR0VOMTJfTUNfQ0NTOgo+ICsJCXJldHVy
biBQTEFORV9DVExfVElMRURfWSB8IFBMQU5FX0NUTF9NRURJQV9ERUNPTVBSRVNTSU9OX0VOQUJM
RTsKPiAgCWNhc2UgSTkxNV9GT1JNQVRfTU9EX1lmX1RJTEVEOgo+ICAJCXJldHVybiBQTEFORV9D
VExfVElMRURfWUY7Cj4gIAljYXNlIEk5MTVfRk9STUFUX01PRF9ZZl9USUxFRF9DQ1M6Cj4gQEAg
LTk5NjgsNiArMTAxMTgsOCBAQCBza3lsYWtlX2dldF9pbml0aWFsX3BsYW5lX2NvbmZpZyhzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiAgCQkJZmItPm1vZGlmaWVyID0gSU5URUxfR0VOKGRldl9w
cml2KSA+PSAxMiA/Cj4gIAkJCQlJOTE1X0ZPUk1BVF9NT0RfWV9USUxFRF9HRU4xMl9SQ19DQ1Mg
Ogo+ICAJCQkJSTkxNV9GT1JNQVRfTU9EX1lfVElMRURfQ0NTOwo+ICsJCWVsc2UgaWYgKHZhbCAm
IFBMQU5FX0NUTF9NRURJQV9ERUNPTVBSRVNTSU9OX0VOQUJMRSkKPiArCQkJZmItPm1vZGlmaWVy
ID0gSTkxNV9GT1JNQVRfTU9EX1lfVElMRURfR0VOMTJfTUNfQ0NTOwo+ICAJCWVsc2UKPiAgCQkJ
ZmItPm1vZGlmaWVyID0gSTkxNV9GT1JNQVRfTU9EX1lfVElMRUQ7Cj4gIAkJYnJlYWs7Cj4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBl
cy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgK
PiBpbmRleCA5NzY2NjlmMDFhOGMuLjU5OThiOTU5MjI1YyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaAo+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oCj4gQEAgLTUzMCw3
ICs1MzAsNyBAQCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgewo+ICAJCSAqLwo+ICAJCXUzMiBz
dHJpZGU7Cj4gIAkJaW50IHgsIHk7Cj4gLQl9IGNvbG9yX3BsYW5lWzJdOwo+ICsJfSBjb2xvcl9w
bGFuZVs0XTsKPiAgCj4gIAkvKiBwbGFuZSBjb250cm9sIHJlZ2lzdGVyICovCj4gIAl1MzIgY3Rs
Owo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nwcml0
ZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zcHJpdGUuYwo+IGluZGV4
IDliOWI0MWIwZmM5MS4uNzg4ZDBmYzhkOGVmIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3ByaXRlLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX3Nwcml0ZS5jCj4gQEAgLTUzMiwxMSArNTMyLDEzIEBAIHNrbF9wcm9n
cmFtX3BsYW5lKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gIAlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gIAllbnVtIHBs
YW5lX2lkIHBsYW5lX2lkID0gcGxhbmUtPmlkOwo+ICAJZW51bSBwaXBlIHBpcGUgPSBwbGFuZS0+
cGlwZTsKPiArCWNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxhbmVfc3RhdGUt
PmJhc2UuZmI7Cj4gKwlpbnQgYXV4X3BsYW5lID0gZmItPmZvcm1hdC0+bnVtX3BsYW5lcyAvIDIg
KyBjb2xvcl9wbGFuZTsKPiAgCWNvbnN0IHN0cnVjdCBkcm1faW50ZWxfc3ByaXRlX2NvbG9ya2V5
ICprZXkgPSAmcGxhbmVfc3RhdGUtPmNrZXk7Cj4gIAl1MzIgc3VyZl9hZGRyID0gcGxhbmVfc3Rh
dGUtPmNvbG9yX3BsYW5lW2NvbG9yX3BsYW5lXS5vZmZzZXQ7Cj4gIAl1MzIgc3RyaWRlID0gc2ts
X3BsYW5lX3N0cmlkZShwbGFuZV9zdGF0ZSwgY29sb3JfcGxhbmUpOwo+IC0JdTMyIGF1eF9kaXN0
ID0gcGxhbmVfc3RhdGUtPmNvbG9yX3BsYW5lWzFdLm9mZnNldCAtIHN1cmZfYWRkcjsKPiAtCXUz
MiBhdXhfc3RyaWRlID0gc2tsX3BsYW5lX3N0cmlkZShwbGFuZV9zdGF0ZSwgMSk7Cj4gKwl1MzIg
YXV4X2Rpc3QgPSBwbGFuZV9zdGF0ZS0+Y29sb3JfcGxhbmVbYXV4X3BsYW5lXS5vZmZzZXQgLSBz
dXJmX2FkZHI7Cj4gKwl1MzIgYXV4X3N0cmlkZSA9IHNrbF9wbGFuZV9zdHJpZGUocGxhbmVfc3Rh
dGUsIGF1eF9wbGFuZSk7Cj4gIAlpbnQgY3J0Y194ID0gcGxhbmVfc3RhdGUtPmJhc2UuZHN0Lngx
Owo+ICAJaW50IGNydGNfeSA9IHBsYW5lX3N0YXRlLT5iYXNlLmRzdC55MTsKPiAgCXUzMiB4ID0g
cGxhbmVfc3RhdGUtPmNvbG9yX3BsYW5lW2NvbG9yX3BsYW5lXS54Owo+IEBAIC01NDQsNyArNTQ2
LDYgQEAgc2tsX3Byb2dyYW1fcGxhbmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiAgCXUz
MiBzcmNfdyA9IGRybV9yZWN0X3dpZHRoKCZwbGFuZV9zdGF0ZS0+YmFzZS5zcmMpID4+IDE2Owo+
ICAJdTMyIHNyY19oID0gZHJtX3JlY3RfaGVpZ2h0KCZwbGFuZV9zdGF0ZS0+YmFzZS5zcmMpID4+
IDE2Owo+ICAJc3RydWN0IGludGVsX3BsYW5lICpsaW5rZWQgPSBwbGFuZV9zdGF0ZS0+cGxhbmFy
X2xpbmtlZF9wbGFuZTsKPiAtCWNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxh
bmVfc3RhdGUtPmJhc2UuZmI7Cj4gIAl1OCBhbHBoYSA9IHBsYW5lX3N0YXRlLT5iYXNlLmFscGhh
ID4+IDg7Cj4gIAl1MzIgcGxhbmVfY29sb3JfY3RsID0gMDsKPiAgCXVuc2lnbmVkIGxvbmcgaXJx
ZmxhZ3M7Cj4gQEAgLTYxOSw4ICs2MjAsOCBAQCBza2xfcHJvZ3JhbV9wbGFuZShzdHJ1Y3QgaW50
ZWxfcGxhbmUgKnBsYW5lLAo+ICAKPiAgCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgMTEpCj4g
IAkJSTkxNV9XUklURV9GVyhQTEFORV9BVVhfT0ZGU0VUKHBpcGUsIHBsYW5lX2lkKSwKPiAtCQkJ
ICAgICAgKHBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVsxXS55IDw8IDE2KSB8Cj4gLQkJCSAgICAg
IHBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVsxXS54KTsKPiArCQkJICAgICAgKHBsYW5lX3N0YXRl
LT5jb2xvcl9wbGFuZVthdXhfcGxhbmVdLnkgPDwgMTYpIHwKPiArCQkJICAgICAgcGxhbmVfc3Rh
dGUtPmNvbG9yX3BsYW5lW2F1eF9wbGFuZV0ueCk7Cj4gIAo+ICAJLyoKPiAgCSAqIFRoZSBjb250
cm9sIHJlZ2lzdGVyIHNlbGYtYXJtcyBpZiB0aGUgcGxhbmUgd2FzIHByZXZpb3VzbHkKPiBAQCAt
MTczNyw3ICsxNzM4LDggQEAgc3RhdGljIGludCBza2xfcGxhbmVfY2hlY2tfZmIoY29uc3Qgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gIAkgICAgIGZiLT5tb2RpZmllciA9
PSBJOTE1X0ZPUk1BVF9NT0RfWWZfVElMRUQgfHwKPiAgCSAgICAgZmItPm1vZGlmaWVyID09IEk5
MTVfRk9STUFUX01PRF9ZX1RJTEVEX0NDUyB8fAo+ICAJICAgICBmYi0+bW9kaWZpZXIgPT0gSTkx
NV9GT1JNQVRfTU9EX1lmX1RJTEVEX0NDUyB8fAo+IC0JICAgICBmYi0+bW9kaWZpZXIgPT0gSTkx
NV9GT1JNQVRfTU9EX1lfVElMRURfR0VOMTJfUkNfQ0NTKSkgewo+ICsJICAgICBmYi0+bW9kaWZp
ZXIgPT0gSTkxNV9GT1JNQVRfTU9EX1lfVElMRURfR0VOMTJfUkNfQ0NTIHx8Cj4gKwkgICAgIGZi
LT5tb2RpZmllciA9PSBJOTE1X0ZPUk1BVF9NT0RfWV9USUxFRF9HRU4xMl9NQ19DQ1MpKSB7Cj4g
IAkJRFJNX0RFQlVHX0tNUygiWS9ZZiB0aWxpbmcgbm90IHN1cHBvcnRlZCBpbiBJRi1JRCBtb2Rl
XG4iKTsKPiAgCQlyZXR1cm4gLUVJTlZBTDsKPiAgCX0KPiBAQCAtMjE0OSw3ICsyMTUxLDE2IEBA
IHN0YXRpYyBjb25zdCB1NjQgc2tsX3BsYW5lX2Zvcm1hdF9tb2RpZmllcnNfY2NzW10gPSB7Cj4g
IAlEUk1fRk9STUFUX01PRF9JTlZBTElECj4gIH07Cj4gIAo+IC1zdGF0aWMgY29uc3QgdTY0IGdl
bjEyX3BsYW5lX2Zvcm1hdF9tb2RpZmllcnNfY2NzW10gPSB7Cj4gK3N0YXRpYyBjb25zdCB1NjQg
Z2VuMTJfcGxhbmVfZm9ybWF0X21vZGlmaWVyc19tY19jY3NbXSA9IHsKPiArCUk5MTVfRk9STUFU
X01PRF9ZX1RJTEVEX0dFTjEyX01DX0NDUywKPiArCUk5MTVfRk9STUFUX01PRF9ZX1RJTEVEX0dF
TjEyX1JDX0NDUywKPiArCUk5MTVfRk9STUFUX01PRF9ZX1RJTEVELAo+ICsJSTkxNV9GT1JNQVRf
TU9EX1hfVElMRUQsCj4gKwlEUk1fRk9STUFUX01PRF9MSU5FQVIsCj4gKwlEUk1fRk9STUFUX01P
RF9JTlZBTElECj4gK307Cj4gKwo+ICtzdGF0aWMgY29uc3QgdTY0IGdlbjEyX3BsYW5lX2Zvcm1h
dF9tb2RpZmllcnNfcmNfY2NzW10gPSB7Cj4gIAlJOTE1X0ZPUk1BVF9NT0RfWV9USUxFRF9HRU4x
Ml9SQ19DQ1MsCj4gIAlJOTE1X0ZPUk1BVF9NT0RfWV9USUxFRCwKPiAgCUk5MTVfRk9STUFUX01P
RF9YX1RJTEVELAo+IEBAIC0yMzA1LDEwICsyMzE2LDIxIEBAIHN0YXRpYyBib29sIHNrbF9wbGFu
ZV9mb3JtYXRfbW9kX3N1cHBvcnRlZChzdHJ1Y3QgZHJtX3BsYW5lICpfcGxhbmUsCj4gIAl9Cj4g
IH0KPiAgCj4gK3N0YXRpYyBib29sIGdlbjEyX3BsYW5lX3N1cHBvcnRzX21jX2NjcyhlbnVtIHBs
YW5lX2lkIHBsYW5lX2lkKQo+ICt7Cj4gKwlyZXR1cm4gcGxhbmVfaWQgPCBQTEFORV9TUFJJVEU0
Owo+ICt9Cj4gKwo+ICBzdGF0aWMgYm9vbCBnZW4xMl9wbGFuZV9mb3JtYXRfbW9kX3N1cHBvcnRl
ZChzdHJ1Y3QgZHJtX3BsYW5lICpfcGxhbmUsCj4gIAkJCQkJICAgICB1MzIgZm9ybWF0LCB1NjQg
bW9kaWZpZXIpCj4gIHsKPiArCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUgPSB0b19pbnRlbF9w
bGFuZShfcGxhbmUpOwo+ICsKPiAgCXN3aXRjaCAobW9kaWZpZXIpIHsKPiArCWNhc2UgSTkxNV9G
T1JNQVRfTU9EX1lfVElMRURfR0VOMTJfTUNfQ0NTOgo+ICsJCWlmICghZ2VuMTJfcGxhbmVfc3Vw
cG9ydHNfbWNfY2NzKHBsYW5lLT5pZCkpCj4gKwkJCXJldHVybiBmYWxzZTsKPiArCQkvKiBmYWxs
IHRocm91Z2ggKi8KPiAgCWNhc2UgRFJNX0ZPUk1BVF9NT0RfTElORUFSOgo+ICAJY2FzZSBJOTE1
X0ZPUk1BVF9NT0RfWF9USUxFRDoKPiAgCWNhc2UgSTkxNV9GT1JNQVRfTU9EX1lfVElMRUQ6Cj4g
QEAgLTIzMjYsMTQgKzIzNDgsMTcgQEAgc3RhdGljIGJvb2wgZ2VuMTJfcGxhbmVfZm9ybWF0X21v
ZF9zdXBwb3J0ZWQoc3RydWN0IGRybV9wbGFuZSAqX3BsYW5lLAo+ICAJCWlmIChpc19jY3NfbW9k
aWZpZXIobW9kaWZpZXIpKQo+ICAJCQlyZXR1cm4gdHJ1ZTsKPiAgCQkvKiBmYWxsIHRocm91Z2gg
Ki8KPiAtCWNhc2UgRFJNX0ZPUk1BVF9SR0I1NjU6Cj4gLQljYXNlIERSTV9GT1JNQVRfWFJHQjIx
MDEwMTA6Cj4gLQljYXNlIERSTV9GT1JNQVRfWEJHUjIxMDEwMTA6Cj4gIAljYXNlIERSTV9GT1JN
QVRfWVVZVjoKPiAgCWNhc2UgRFJNX0ZPUk1BVF9ZVllVOgo+ICAJY2FzZSBEUk1fRk9STUFUX1VZ
Vlk6Cj4gIAljYXNlIERSTV9GT1JNQVRfVllVWToKPiArCQlpZiAobW9kaWZpZXIgPT0gSTkxNV9G
T1JNQVRfTU9EX1lfVElMRURfR0VOMTJfTUNfQ0NTKQo+ICsJCQlyZXR1cm4gdHJ1ZTsKPiArCQkv
KiBmYWxsIHRocm91Z2ggKi8KPiAgCWNhc2UgRFJNX0ZPUk1BVF9OVjEyOgo+ICsJY2FzZSBEUk1f
Rk9STUFUX1JHQjU2NToKPiArCWNhc2UgRFJNX0ZPUk1BVF9YUkdCMjEwMTAxMDoKPiArCWNhc2Ug
RFJNX0ZPUk1BVF9YQkdSMjEwMTAxMDoKPiAgCWNhc2UgRFJNX0ZPUk1BVF9QMDEwOgo+ICAJY2Fz
ZSBEUk1fRk9STUFUX1AwMTI6Cj4gIAljYXNlIERSTV9GT1JNQVRfUDAxNjoKPiBAQCAtMjQ3MCw2
ICsyNDk1LDE0IEBAIHN0YXRpYyBjb25zdCB1MzIgKmljbF9nZXRfcGxhbmVfZm9ybWF0cyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gIAl9Cj4gIH0KPiAgCj4gK3N0YXRpYyBj
b25zdCB1NjQgKmdlbjEyX2dldF9wbGFuZV9tb2RpZmllcnMoZW51bSBwbGFuZV9pZCBwbGFuZV9p
ZCkKPiArewo+ICsJaWYgKGdlbjEyX3BsYW5lX3N1cHBvcnRzX21jX2NjcyhwbGFuZV9pZCkpCj4g
KwkJcmV0dXJuIGdlbjEyX3BsYW5lX2Zvcm1hdF9tb2RpZmllcnNfbWNfY2NzOwo+ICsJZWxzZQo+
ICsJCXJldHVybiBnZW4xMl9wbGFuZV9mb3JtYXRfbW9kaWZpZXJzX3JjX2NjczsKPiArfQo+ICsK
PiAgc3RhdGljIGJvb2wgc2tsX3BsYW5lX2hhc19jY3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ICAJCQkgICAgICBlbnVtIHBpcGUgcGlwZSwgZW51bSBwbGFuZV9pZCBwbGFu
ZV9pZCkKPiAgewo+IEBAIC0yNTM2LDcgKzI1NjksNyBAQCBza2xfdW5pdmVyc2FsX3BsYW5lX2Ny
ZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gIAo+ICAJcGxhbmUtPmhh
c19jY3MgPSBza2xfcGxhbmVfaGFzX2NjcyhkZXZfcHJpdiwgcGlwZSwgcGxhbmVfaWQpOwo+ICAJ
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTIpIHsKPiAtCQltb2RpZmllcnMgPSBnZW4xMl9w
bGFuZV9mb3JtYXRfbW9kaWZpZXJzX2NjczsKPiArCQltb2RpZmllcnMgPSBnZW4xMl9nZXRfcGxh
bmVfbW9kaWZpZXJzKHBsYW5lX2lkKTsKPiAgCQlwbGFuZV9mdW5jcyA9ICZnZW4xMl9wbGFuZV9m
dW5jczsKPiAgCX0gZWxzZSB7Cj4gIAkJaWYgKHBsYW5lLT5oYXNfY2NzKQo+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlZy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9yZWcuaAo+IGluZGV4IDUxOWNmYjBhNWM0Mi4uMDJlYWVmOGFkYWMwIDEwMDY0NAo+IC0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVnLmgKPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3JlZy5oCj4gQEAgLTY2OTcsNiArNjY5Nyw3IEBAIGVudW0gewo+ICAjZGVm
aW5lICAgUExBTkVfQ1RMX1RJTEVEX1kJCQkoNCA8PCAxMCkKPiAgI2RlZmluZSAgIFBMQU5FX0NU
TF9USUxFRF9ZRgkJCSg1IDw8IDEwKQo+ICAjZGVmaW5lICAgUExBTkVfQ1RMX0ZMSVBfSE9SSVpP
TlRBTAkJKDEgPDwgOCkKPiArI2RlZmluZSAgIFBMQU5FX0NUTF9NRURJQV9ERUNPTVBSRVNTSU9O
X0VOQUJMRQkoMSA8PCA0KSAvKiBUR0wrICovCj4gICNkZWZpbmUgICBQTEFORV9DVExfQUxQSEFf
TUFTSwkJCSgweDMgPDwgNCkgLyogUHJlLUdMSyAqLwo+ICAjZGVmaW5lICAgUExBTkVfQ1RMX0FM
UEhBX0RJU0FCTEUJCSgwIDw8IDQpCj4gICNkZWZpbmUgICBQTEFORV9DVExfQUxQSEFfU1dfUFJF
TVVMVElQTFkJKDIgPDwgNCkKPiAtLSAKPiAyLjE3LjEKPiAKPiBfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwo+IEludGVsLWdmeCBtYWlsaW5nIGxpc3QKPiBJ
bnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCj4gaHR0cHM6Ly9saXN0cy5mcmVlZGVza3Rv
cC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZngKCi0tIApNYXR0IFJvcGVyCkdyYXBoaWNz
IFNvZnR3YXJlIEVuZ2luZWVyClZUVC1PU0dDIFBsYXRmb3JtIEVuYWJsZW1lbnQKSW50ZWwgQ29y
cG9yYXRpb24KKDkxNikgMzU2LTI3OTUKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGlu
Zm8vaW50ZWwtZ2Z4

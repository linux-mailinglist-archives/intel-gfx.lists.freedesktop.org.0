Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id EA76539C9A5
	for <lists+intel-gfx@lfdr.de>; Sat,  5 Jun 2021 17:54:37 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 92FAA6E4D2;
	Sat,  5 Jun 2021 15:54:22 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga04.intel.com (mga04.intel.com [192.55.52.120])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E97AB6E40C;
 Sat,  5 Jun 2021 15:54:19 +0000 (UTC)
IronPort-SDR: 0yJ5az14z2Mh9V+bCwjjx9tly/EJnZZUmcIn0O8bQcI7SYqo1Mh3+6UhJqQ7jHc52n43fmkaiL
 DT6T7P+2+flQ==
X-IronPort-AV: E=McAfee;i="6200,9189,10006"; a="202586558"
X-IronPort-AV: E=Sophos;i="5.83,251,1616482800"; d="scan'208";a="202586558"
Received: from fmsmga005.fm.intel.com ([10.253.24.32])
 by fmsmga104.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 05 Jun 2021 08:54:15 -0700
IronPort-SDR: IIT8/Umd2lsT7qJbjsalH3sWnK9Dui+WS86T+IDtWf4U7c0NVq6j4Z3zi75+rGpQDbOxGmH9WJ
 2cKUKihWs6Yg==
X-IronPort-AV: E=Sophos;i="5.83,251,1616482800"; d="scan'208";a="636855074"
Received: from lucas-s2600cw.jf.intel.com ([10.165.21.202])
 by fmsmga005-auth.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 05 Jun 2021 08:54:14 -0700
From: Lucas De Marchi <lucas.demarchi@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Sat,  5 Jun 2021 08:53:52 -0700
Message-Id: <20210605155356.4183026-2-lucas.demarchi@intel.com>
X-Mailer: git-send-email 2.31.1
In-Reply-To: <20210605155356.4183026-1-lucas.demarchi@intel.com>
References: <20210605155356.4183026-1-lucas.demarchi@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v4 1/5] drm/i915/gt: replace IS_GEN and friends
 with GRAPHICS_VER
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VGhpcyB3YXMgZG9uZSBieSB0aGUgZm9sbG93aW5nIHNlbWFudGljIHBhdGNoOgoKCUBAIGV4cHJl
c3Npb24gaTkxNTsgQEAKCS0gSU5URUxfR0VOKGk5MTUpCgkrIEdSQVBISUNTX1ZFUihpOTE1KQoK
CUBAIGV4cHJlc3Npb24gaTkxNTsgZXhwcmVzc2lvbiBFOyBAQAoJLSBJTlRFTF9HRU4oaTkxNSkg
Pj0gRQoJKyBHUkFQSElDU19WRVIoaTkxNSkgPj0gRQoKCUBAIGV4cHJlc3Npb24gZGV2X3ByaXY7
IGV4cHJlc3Npb24gRTsgQEAKCS0gIUlTX0dFTihkZXZfcHJpdiwgRSkKCSsgR1JBUEhJQ1NfVkVS
KGRldl9wcml2KSAhPSBFCgoJQEAgZXhwcmVzc2lvbiBkZXZfcHJpdjsgZXhwcmVzc2lvbiBFOyBA
QAoJLSBJU19HRU4oZGV2X3ByaXYsIEUpCgkrIEdSQVBISUNTX1ZFUihkZXZfcHJpdikgPT0gRQoK
CUBACglleHByZXNzaW9uIGRldl9wcml2OwoJZXhwcmVzc2lvbiBmcm9tLCB1bnRpbDsKCUBACgkt
IElTX0dFTl9SQU5HRShkZXZfcHJpdiwgZnJvbSwgdW50aWwpCgkrIElTX0dSQVBISUNTX1ZFUihk
ZXZfcHJpdiwgZnJvbSwgdW50aWwpCgoJQGRlZkAKCWV4cHJlc3Npb24gRTsKCWlkZW50aWZpZXIg
aWQgPX4gIl5nZW4kIjsKCUBACgktIGlkID0gR1JBUEhJQ1NfVkVSKEUpCgkrIHZlciA9IEdSQVBI
SUNTX1ZFUihFKQoKCUBACglpZGVudGlmaWVyIGRlZi5pZDsKCUBACgktIGlkCgkrIHZlcgoKSXQg
YWxzbyB0YWtlcyBjYXJlIG9mIHJlbmFtaW5nIHRoZSB2YXJpYWJsZSB3ZSBhc3NpZ24gdG8gR1JB
UEhJQ1NfVkVSKCkKc28gdG8gdXNlICJ2ZXIiIHJhdGhlciB0aGFuICJnZW4iLgoKU2lnbmVkLW9m
Zi1ieTogTHVjYXMgRGUgTWFyY2hpIDxsdWNhcy5kZW1hcmNoaUBpbnRlbC5jb20+ClJldmlld2Vk
LWJ5OiBNYXR0IFJvcGVyIDxtYXR0aGV3LmQucm9wZXJAaW50ZWwuY29tPgotLS0KIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2RlYnVnZnNfZ3RfcG0uYyAgICAgICB8IDM4ICsrKysrLS0tLS0tCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9nZW4yX2VuZ2luZV9jcy5jICAgICAgfCAgMiArLQogZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvZ2VuOF9lbmdpbmVfY3MuYyAgICAgIHwgIDIgKy0KIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2dlbjhfcHBndHQuYyAgICAgICAgICB8ICAyICstCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0X3NzZXUuYyAgfCAgMiArLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMgICAgIHwgNTQgKysrKysrKy0tLS0tLS0t
CiAuLi4vZHJtL2k5MTUvZ3QvaW50ZWxfZXhlY2xpc3RzX3N1Ym1pc3Npb24uYyAgfCAxOCArKy0t
LQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ2d0dC5jICAgICAgICAgIHwgMTggKyst
LS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2dndHRfZmVuY2luZy5jICB8IDM0ICsr
KysrLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmMgICAgICAgICAgICB8
IDI3ICsrKystLS0tCiAuLi4vZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X2Nsb2NrX3V0aWxzLmMg
ICAgfCAxMiArKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9pcnEuYyAgICAg
ICAgfCAgNiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG1faXJxLmMgICAg
IHwgMTAgKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndHQuYyAgICAgICAgICAg
fCAxNCArKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9sbGMuYyAgICAgICAgICAg
fCAgNiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMgICAgICAgICAgIHwg
NDYgKysrKysrLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbW9jcy5jICAg
ICAgICAgIHwgIDggKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9wcGd0dC5jICAg
ICAgICAgfCAgNiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmM2LmMgICAgICAg
ICAgIHwgMTYgKystLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JlbmRlcnN0YXRl
LmMgICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jICAgICAg
ICAgfCAxNCArKy0tCiAuLi4vZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jpbmdfc3VibWlzc2lvbi5j
ICAgfCA2NCArKysrKysrKystLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X3Jwcy5jICAgICAgICAgICB8IDYwICsrKysrKysrLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9zc2V1LmMgICAgICAgICAgfCAxNCArKy0tCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF93b3JrYXJvdW5kcy5jICAgfCA2NiArKysrKysrKystLS0tLS0tLS0tCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9lbmdpbmVfY3MuYyAgfCAgNiArLQogZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfZW5naW5lX3BtLmMgIHwgIDIgKy0KIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2V4ZWNsaXN0cy5jICB8ICA0ICstCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9ndF9wbS5jICAgICAgfCAgOCArLS0KIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jICB8ICA4ICstLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbGxjLmMgICAgICAgIHwgIDQgKy0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jICAgICAgICB8ICA4ICstLQogZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbW9jcy5jICAgICAgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3NlbGZ0ZXN0X3JjNi5jICAgICAgICB8ICA0ICstCiAuLi4vZHJtL2k5MTUvZ3Qv
c2VsZnRlc3RfcmluZ19zdWJtaXNzaW9uLmMgICAgfCAgNiArLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Qvc2VsZnRlc3RfcnBzLmMgICAgICAgIHwgMTYgKystLS0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L3NlbGZ0ZXN0X3RpbWVsaW5lLmMgICB8ICA2ICstCiAuLi4vZ3B1L2RybS9pOTE1L2d0
L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMgICAgfCAgOCArLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L3VjL2ludGVsX2d1Yy5jICAgICAgICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC91Yy9pbnRlbF9ndWNfYWRzLmMgICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
dWMvaW50ZWxfZ3VjX2Z3LmMgICAgIHwgIDIgKy0KIC4uLi9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50
ZWxfZ3VjX3N1Ym1pc3Npb24uYyB8ICA2ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9p
bnRlbF9odWMuYyAgICAgICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50
ZWxfdWMuYyAgICAgICAgIHwgIDQgKy0KIDQ0IGZpbGVzIGNoYW5nZWQsIDMyMSBpbnNlcnRpb25z
KCspLCAzMjAgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvZGVidWdmc19ndF9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19ndF9w
bS5jCmluZGV4IGQ0ZjQ0NTJjZTVlZC4uMDM4OWJjZWViZDA2IDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX2d0X3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvZGVidWdmc19ndF9wbS5jCkBAIC04NSwxNCArODUsMTQgQEAgc3RhdGljIGludCBnZW42
X2RycGMoc3RydWN0IHNlcV9maWxlICptKQogCWd0X2NvcmVfc3RhdHVzID0gaW50ZWxfdW5jb3Jl
X3JlYWRfZncodW5jb3JlLCBHRU42X0dUX0NPUkVfU1RBVFVTKTsKIAogCXJjY3RsMSA9IGludGVs
X3VuY29yZV9yZWFkKHVuY29yZSwgR0VONl9SQ19DT05UUk9MKTsKLQlpZiAoSU5URUxfR0VOKGk5
MTUpID49IDkpIHsKKwlpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID49IDkpIHsKIAkJZ2VuOV9wb3dl
cmdhdGVfZW5hYmxlID0KIAkJCWludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VOOV9QR19FTkFC
TEUpOwogCQlnZW45X3Bvd2VyZ2F0ZV9zdGF0dXMgPQogCQkJaW50ZWxfdW5jb3JlX3JlYWQodW5j
b3JlLCBHRU45X1BXUkdUX0RPTUFJTl9TVEFUVVMpOwogCX0KIAotCWlmIChJTlRFTF9HRU4oaTkx
NSkgPD0gNykKKwlpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpIDw9IDcpCiAJCXNhbmR5YnJpZGdlX3Bj
b2RlX3JlYWQoaTkxNSwgR0VONl9QQ09ERV9SRUFEX1JDNlZJRFMsCiAJCQkJICAgICAgICZyYzZ2
aWRzLCBOVUxMKTsKIApAQCAtMTAwLDcgKzEwMCw3IEBAIHN0YXRpYyBpbnQgZ2VuNl9kcnBjKHN0
cnVjdCBzZXFfZmlsZSAqbSkKIAkJICAgeWVzbm8ocmNjdGwxICYgR0VONl9SQ19DVExfUkMxZV9F
TkFCTEUpKTsKIAlzZXFfcHJpbnRmKG0sICJSQzYgRW5hYmxlZDogJXNcbiIsCiAJCSAgIHllc25v
KHJjY3RsMSAmIEdFTjZfUkNfQ1RMX1JDNl9FTkFCTEUpKTsKLQlpZiAoSU5URUxfR0VOKGk5MTUp
ID49IDkpIHsKKwlpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID49IDkpIHsKIAkJc2VxX3ByaW50Ziht
LCAiUmVuZGVyIFdlbGwgR2F0aW5nIEVuYWJsZWQ6ICVzXG4iLAogCQkJICAgeWVzbm8oZ2VuOV9w
b3dlcmdhdGVfZW5hYmxlICYgR0VOOV9SRU5ERVJfUEdfRU5BQkxFKSk7CiAJCXNlcV9wcmludGYo
bSwgIk1lZGlhIFdlbGwgR2F0aW5nIEVuYWJsZWQ6ICVzXG4iLApAQCAtMTM0LDcgKzEzNCw3IEBA
IHN0YXRpYyBpbnQgZ2VuNl9kcnBjKHN0cnVjdCBzZXFfZmlsZSAqbSkKIAogCXNlcV9wcmludGYo
bSwgIkNvcmUgUG93ZXIgRG93bjogJXNcbiIsCiAJCSAgIHllc25vKGd0X2NvcmVfc3RhdHVzICYg
R0VONl9DT1JFX0NQRF9TVEFURV9NQVNLKSk7Ci0JaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KSB7
CisJaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA+PSA5KSB7CiAJCXNlcV9wcmludGYobSwgIlJlbmRl
ciBQb3dlciBXZWxsOiAlc1xuIiwKIAkJCSAgIChnZW45X3Bvd2VyZ2F0ZV9zdGF0dXMgJgogCQkJ
ICAgIEdFTjlfUFdSR1RfUkVOREVSX1NUQVRVU19NQVNLKSA/ICJVcCIgOiAiRG93biIpOwpAQCAt
MTUwLDcgKzE1MCw3IEBAIHN0YXRpYyBpbnQgZ2VuNl9kcnBjKHN0cnVjdCBzZXFfZmlsZSAqbSkK
IAlwcmludF9yYzZfcmVzKG0sICJSQzYrIHJlc2lkZW5jeSBzaW5jZSBib290OiIsIEdFTjZfR1Rf
R0ZYX1JDNnApOwogCXByaW50X3JjNl9yZXMobSwgIlJDNisrIHJlc2lkZW5jeSBzaW5jZSBib290
OiIsIEdFTjZfR1RfR0ZYX1JDNnBwKTsKIAotCWlmIChJTlRFTF9HRU4oaTkxNSkgPD0gNykgewor
CWlmIChHUkFQSElDU19WRVIoaTkxNSkgPD0gNykgewogCQlzZXFfcHJpbnRmKG0sICJSQzYgICB2
b2x0YWdlOiAlZG1WXG4iLAogCQkJICAgR0VONl9ERUNPREVfUkM2X1ZJRCgoKHJjNnZpZHMgPj4g
MCkgJiAweGZmKSkpOwogCQlzZXFfcHJpbnRmKG0sICJSQzYrICB2b2x0YWdlOiAlZG1WXG4iLApA
QCAtMjUwLDcgKzI1MCw3IEBAIHN0YXRpYyBpbnQgZnJlcXVlbmN5X3Nob3coc3RydWN0IHNlcV9m
aWxlICptLCB2b2lkICp1bnVzZWQpCiAKIAl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQo
dW5jb3JlLT5ycG0pOwogCi0JaWYgKElTX0dFTihpOTE1LCA1KSkgeworCWlmIChHUkFQSElDU19W
RVIoaTkxNSkgPT0gNSkgewogCQl1MTYgcmd2c3djdGwgPSBpbnRlbF91bmNvcmVfcmVhZDE2KHVu
Y29yZSwgTUVNU1dDVEwpOwogCQl1MTYgcmd2c3RhdCA9IGludGVsX3VuY29yZV9yZWFkMTYodW5j
b3JlLCBNRU1TVEFUX0lMSyk7CiAKQEAgLTI5Niw3ICsyOTYsNyBAQCBzdGF0aWMgaW50IGZyZXF1
ZW5jeV9zaG93KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogCiAJCXNlcV9wcmlu
dGYobSwgImVmZmljaWVudCAoUlBlKSBmcmVxdWVuY3k6ICVkIE1IelxuIiwKIAkJCSAgIGludGVs
X2dwdV9mcmVxKHJwcywgcnBzLT5lZmZpY2llbnRfZnJlcSkpOwotCX0gZWxzZSBpZiAoSU5URUxf
R0VOKGk5MTUpID49IDYpIHsKKwl9IGVsc2UgaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA+PSA2KSB7
CiAJCXUzMiBycF9zdGF0ZV9saW1pdHM7CiAJCXUzMiBndF9wZXJmX3N0YXR1czsKIAkJdTMyIHJw
X3N0YXRlX2NhcDsKQEAgLTMyMSw3ICszMjEsNyBAQCBzdGF0aWMgaW50IGZyZXF1ZW5jeV9zaG93
KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogCQlpbnRlbF91bmNvcmVfZm9yY2V3
YWtlX2dldCh1bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwogCiAJCXJlcWYgPSBpbnRlbF91bmNvcmVf
cmVhZCh1bmNvcmUsIEdFTjZfUlBOU1dSRVEpOwotCQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkp
IHsKKwkJaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA+PSA5KSB7CiAJCQlyZXFmID4+PSAyMzsKIAkJ
fSBlbHNlIHsKIAkJCXJlcWYgJj0gfkdFTjZfVFVSQk9fRElTQUJMRTsKQEAgLTM1NCw3ICszNTQs
NyBAQCBzdGF0aWMgaW50IGZyZXF1ZW5jeV9zaG93KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAq
dW51c2VkKQogCiAJCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KHVuY29yZSwgRk9SQ0VXQUtF
X0FMTCk7CiAKLQkJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkgeworCQlpZiAoR1JBUEhJQ1Nf
VkVSKGk5MTUpID49IDExKSB7CiAJCQlwbV9pZXIgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUs
IEdFTjExX0dQTV9XR0JPWFBFUkZfSU5UUl9FTkFCTEUpOwogCQkJcG1faW1yID0gaW50ZWxfdW5j
b3JlX3JlYWQodW5jb3JlLCBHRU4xMV9HUE1fV0dCT1hQRVJGX0lOVFJfTUFTSyk7CiAJCQkvKgpA
QCAtMzYzLDcgKzM2Myw3IEBAIHN0YXRpYyBpbnQgZnJlcXVlbmN5X3Nob3coc3RydWN0IHNlcV9m
aWxlICptLCB2b2lkICp1bnVzZWQpCiAJCQkgKi8KIAkJCXBtX2lzciA9IDA7CiAJCQlwbV9paXIg
PSAwOwotCQl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA4KSB7CisJCX0gZWxzZSBpZiAo
R1JBUEhJQ1NfVkVSKGk5MTUpID49IDgpIHsKIAkJCXBtX2llciA9IGludGVsX3VuY29yZV9yZWFk
KHVuY29yZSwgR0VOOF9HVF9JRVIoMikpOwogCQkJcG1faW1yID0gaW50ZWxfdW5jb3JlX3JlYWQo
dW5jb3JlLCBHRU44X0dUX0lNUigyKSk7CiAJCQlwbV9pc3IgPSBpbnRlbF91bmNvcmVfcmVhZCh1
bmNvcmUsIEdFTjhfR1RfSVNSKDIpKTsKQEAgLTM4NiwxNCArMzg2LDE0IEBAIHN0YXRpYyBpbnQg
ZnJlcXVlbmN5X3Nob3coc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCiAKIAkJc2Vx
X3ByaW50ZihtLCAiUE0gSUVSPTB4JTA4eCBJTVI9MHglMDh4LCBNQVNLPTB4JTA4eFxuIiwKIAkJ
CSAgIHBtX2llciwgcG1faW1yLCBwbV9tYXNrKTsKLQkJaWYgKElOVEVMX0dFTihpOTE1KSA8PSAx
MCkKKwkJaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA8PSAxMCkKIAkJCXNlcV9wcmludGYobSwgIlBN
IElTUj0weCUwOHggSUlSPTB4JTA4eFxuIiwKIAkJCQkgICBwbV9pc3IsIHBtX2lpcik7CiAJCXNl
cV9wcmludGYobSwgInBtX2ludHJtc2tfbWJ6OiAweCUwOHhcbiIsCiAJCQkgICBycHMtPnBtX2lu
dHJtc2tfbWJ6KTsKIAkJc2VxX3ByaW50ZihtLCAiR1RfUEVSRl9TVEFUVVM6IDB4JTA4eFxuIiwg
Z3RfcGVyZl9zdGF0dXMpOwogCQlzZXFfcHJpbnRmKG0sICJSZW5kZXIgcC1zdGF0ZSByYXRpbzog
JWRcbiIsCi0JCQkgICAoZ3RfcGVyZl9zdGF0dXMgJiAoSU5URUxfR0VOKGk5MTUpID49IDkgPyAw
eDFmZjAwIDogMHhmZjAwKSkgPj4gOCk7CisJCQkgICAoZ3RfcGVyZl9zdGF0dXMgJiAoR1JBUEhJ
Q1NfVkVSKGk5MTUpID49IDkgPyAweDFmZjAwIDogMHhmZjAwKSkgPj4gOCk7CiAJCXNlcV9wcmlu
dGYobSwgIlJlbmRlciBwLXN0YXRlIFZJRDogJWRcbiIsCiAJCQkgICBndF9wZXJmX3N0YXR1cyAm
IDB4ZmYpOwogCQlzZXFfcHJpbnRmKG0sICJSZW5kZXIgcC1zdGF0ZSBsaW1pdDogJWRcbiIsCkBA
IC00MzcsMjAgKzQzNywyMCBAQCBzdGF0aWMgaW50IGZyZXF1ZW5jeV9zaG93KHN0cnVjdCBzZXFf
ZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogCQltYXhfZnJlcSA9IChJU19HRU45X0xQKGk5MTUpID8g
cnBfc3RhdGVfY2FwID4+IDAgOgogCQkJICAgIHJwX3N0YXRlX2NhcCA+PiAxNikgJiAweGZmOwog
CQltYXhfZnJlcSAqPSAoSVNfR0VOOV9CQyhpOTE1KSB8fAotCQkJICAgICBJTlRFTF9HRU4oaTkx
NSkgPj0gMTAgPyBHRU45X0ZSRVFfU0NBTEVSIDogMSk7CisJCQkgICAgIEdSQVBISUNTX1ZFUihp
OTE1KSA+PSAxMCA/IEdFTjlfRlJFUV9TQ0FMRVIgOiAxKTsKIAkJc2VxX3ByaW50ZihtLCAiTG93
ZXN0IChSUE4pIGZyZXF1ZW5jeTogJWRNSHpcbiIsCiAJCQkgICBpbnRlbF9ncHVfZnJlcShycHMs
IG1heF9mcmVxKSk7CiAKIAkJbWF4X2ZyZXEgPSAocnBfc3RhdGVfY2FwICYgMHhmZjAwKSA+PiA4
OwogCQltYXhfZnJlcSAqPSAoSVNfR0VOOV9CQyhpOTE1KSB8fAotCQkJICAgICBJTlRFTF9HRU4o
aTkxNSkgPj0gMTAgPyBHRU45X0ZSRVFfU0NBTEVSIDogMSk7CisJCQkgICAgIEdSQVBISUNTX1ZF
UihpOTE1KSA+PSAxMCA/IEdFTjlfRlJFUV9TQ0FMRVIgOiAxKTsKIAkJc2VxX3ByaW50ZihtLCAi
Tm9taW5hbCAoUlAxKSBmcmVxdWVuY3k6ICVkTUh6XG4iLAogCQkJICAgaW50ZWxfZ3B1X2ZyZXEo
cnBzLCBtYXhfZnJlcSkpOwogCiAJCW1heF9mcmVxID0gKElTX0dFTjlfTFAoaTkxNSkgPyBycF9z
dGF0ZV9jYXAgPj4gMTYgOgogCQkJICAgIHJwX3N0YXRlX2NhcCA+PiAwKSAmIDB4ZmY7CiAJCW1h
eF9mcmVxICo9IChJU19HRU45X0JDKGk5MTUpIHx8Ci0JCQkgICAgIElOVEVMX0dFTihpOTE1KSA+
PSAxMCA/IEdFTjlfRlJFUV9TQ0FMRVIgOiAxKTsKKwkJCSAgICAgR1JBUEhJQ1NfVkVSKGk5MTUp
ID49IDEwID8gR0VOOV9GUkVRX1NDQUxFUiA6IDEpOwogCQlzZXFfcHJpbnRmKG0sICJNYXggbm9u
LW92ZXJjbG9ja2VkIChSUDApIGZyZXF1ZW5jeTogJWRNSHpcbiIsCiAJCQkgICBpbnRlbF9ncHVf
ZnJlcShycHMsIG1heF9mcmVxKSk7CiAJCXNlcV9wcmludGYobSwgIk1heCBvdmVyY2xvY2tlZCBm
cmVxdWVuY3k6ICVkTUh6XG4iLApAQCAtNDg4LDcgKzQ4OCw3IEBAIHN0YXRpYyBpbnQgbGxjX3No
b3coc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQogewogCXN0cnVjdCBpbnRlbF9ndCAq
Z3QgPSBtLT5wcml2YXRlOwogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3QtPmk5
MTU7Ci0JY29uc3QgYm9vbCBlZHJhbSA9IElOVEVMX0dFTihpOTE1KSA+IDg7CisJY29uc3QgYm9v
bCBlZHJhbSA9IEdSQVBISUNTX1ZFUihpOTE1KSA+IDg7CiAJc3RydWN0IGludGVsX3JwcyAqcnBz
ID0gJmd0LT5ycHM7CiAJdW5zaWduZWQgaW50IG1heF9ncHVfZnJlcSwgbWluX2dwdV9mcmVxOwog
CWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwpAQCAtNTAwLDcgKzUwMCw3IEBAIHN0YXRpYyBpbnQg
bGxjX3Nob3coc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQogCiAJbWluX2dwdV9mcmVx
ID0gcnBzLT5taW5fZnJlcTsKIAltYXhfZ3B1X2ZyZXEgPSBycHMtPm1heF9mcmVxOwotCWlmIChJ
U19HRU45X0JDKGk5MTUpIHx8IElOVEVMX0dFTihpOTE1KSA+PSAxMCkgeworCWlmIChJU19HRU45
X0JDKGk5MTUpIHx8IEdSQVBISUNTX1ZFUihpOTE1KSA+PSAxMCkgewogCQkvKiBDb252ZXJ0IEdU
IGZyZXF1ZW5jeSB0byA1MCBIWiB1bml0cyAqLwogCQltaW5fZ3B1X2ZyZXEgLz0gR0VOOV9GUkVR
X1NDQUxFUjsKIAkJbWF4X2dwdV9mcmVxIC89IEdFTjlfRlJFUV9TQ0FMRVI7CkBAIC01MTgsNyAr
NTE4LDcgQEAgc3RhdGljIGludCBsbGNfc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRh
dGEpCiAJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsCiAJCQkJCSAgKGdwdV9mcmVxICoKIAkJCQkJ
ICAgKElTX0dFTjlfQkMoaTkxNSkgfHwKLQkJCQkJICAgIElOVEVMX0dFTihpOTE1KSA+PSAxMCA/
CisJCQkJCSAgICBHUkFQSElDU19WRVIoaTkxNSkgPj0gMTAgPwogCQkJCQkgICAgR0VOOV9GUkVR
X1NDQUxFUiA6IDEpKSksCiAJCQkgICAoKGlhX2ZyZXEgPj4gMCkgJiAweGZmKSAqIDEwMCwKIAkJ
CSAgICgoaWFfZnJlcSA+PiA4KSAmIDB4ZmYpICogMTAwKTsKQEAgLTU4MCw3ICs1ODAsNyBAQCBz
dGF0aWMgaW50IHJwc19ib29zdF9zaG93KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkK
IAogCXNlcV9wcmludGYobSwgIldhaXQgYm9vc3RzOiAlZFxuIiwgUkVBRF9PTkNFKHJwcy0+Ym9v
c3RzKSk7CiAKLQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDYgJiYgaW50ZWxfcnBzX2lzX2FjdGl2
ZShycHMpKSB7CisJaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA+PSA2ICYmIGludGVsX3Jwc19pc19h
Y3RpdmUocnBzKSkgewogCQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBndC0+dW5jb3Jl
OwogCQl1MzIgcnB1cCwgcnB1cGVpOwogCQl1MzIgcnBkb3duLCBycGRvd25laTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2dlbjJfZW5naW5lX2NzLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9nZW4yX2VuZ2luZV9jcy5jCmluZGV4IDk2NDYyMDBkMjc5Mi4uNjEzODM4
MzA1MDVlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9nZW4yX2VuZ2luZV9j
cy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2dlbjJfZW5naW5lX2NzLmMKQEAgLTc0
LDcgKzc0LDcgQEAgaW50IGdlbjRfZW1pdF9mbHVzaF9yY3Moc3RydWN0IGk5MTVfcmVxdWVzdCAq
cnEsIHUzMiBtb2RlKQogCWNtZCA9IE1JX0ZMVVNIOwogCWlmIChtb2RlICYgRU1JVF9JTlZBTElE
QVRFKSB7CiAJCWNtZCB8PSBNSV9FWEVfRkxVU0g7Ci0JCWlmIChJU19HNFgocnEtPmVuZ2luZS0+
aTkxNSkgfHwgSVNfR0VOKHJxLT5lbmdpbmUtPmk5MTUsIDUpKQorCQlpZiAoSVNfRzRYKHJxLT5l
bmdpbmUtPmk5MTUpIHx8IEdSQVBISUNTX1ZFUihycS0+ZW5naW5lLT5pOTE1KSA9PSA1KQogCQkJ
Y21kIHw9IE1JX0lOVkFMSURBVEVfSVNQOwogCX0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvZ2VuOF9lbmdpbmVfY3MuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2dl
bjhfZW5naW5lX2NzLmMKaW5kZXggNzMyYzJlZDFkOTMzLi45NGUwYTU2NjlmOTAgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2dlbjhfZW5naW5lX2NzLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvZ2VuOF9lbmdpbmVfY3MuYwpAQCAtMzgsNyArMzgsNyBAQCBpbnQg
Z2VuOF9lbWl0X2ZsdXNoX3JjcyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgdTMyIG1vZGUpCiAJ
CSAqIE9uIEdFTjk6IGJlZm9yZSBWRl9DQUNIRV9JTlZBTElEQVRFIHdlIG5lZWQgdG8gZW1pdCBh
IE5VTEwKIAkJICogcGlwZSBjb250cm9sLgogCQkgKi8KLQkJaWYgKElTX0dFTihycS0+ZW5naW5l
LT5pOTE1LCA5KSkKKwkJaWYgKEdSQVBISUNTX1ZFUihycS0+ZW5naW5lLT5pOTE1KSA9PSA5KQog
CQkJdmZfZmx1c2hfd2EgPSB0cnVlOwogCiAJCS8qIFdhRm9yR0FNSGFuZzprYmwgKi8KZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2dlbjhfcHBndHQuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2dlbjhfcHBndHQuYwppbmRleCBlM2E4OTI0ZDIyODYuLjIxYzhiNzM1MGI3
YSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZ2VuOF9wcGd0dC5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2dlbjhfcHBndHQuYwpAQCAtNzA5LDcgKzcwOSw3IEBA
IHN0cnVjdCBpOTE1X3BwZ3R0ICpnZW44X3BwZ3R0X2NyZWF0ZShzdHJ1Y3QgaW50ZWxfZ3QgKmd0
KQogCSAqCiAJICogR2VuMTIgaGFzIGluaGVyaXRlZCB0aGUgc2FtZSByZWFkLW9ubHkgZmF1bHQg
aXNzdWUgZnJvbSBnZW4xMS4KIAkgKi8KLQlwcGd0dC0+dm0uaGFzX3JlYWRfb25seSA9ICFJU19H
RU5fUkFOR0UoZ3QtPmk5MTUsIDExLCAxMik7CisJcHBndHQtPnZtLmhhc19yZWFkX29ubHkgPSAh
SVNfR1JBUEhJQ1NfVkVSKGd0LT5pOTE1LCAxMSwgMTIpOwogCiAJaWYgKEhBU19MTUVNKGd0LT5p
OTE1KSkKIAkJcHBndHQtPnZtLmFsbG9jX3B0X2RtYSA9IGFsbG9jX3B0X2xtZW07CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0X3NzZXUuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHRfc3NldS5jCmluZGV4IDhkZmQ4ZjY1NmFh
YS4uZTg2ZDgyNTVmZWVjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9jb250ZXh0X3NzZXUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250
ZXh0X3NzZXUuYwpAQCAtNzYsNyArNzYsNyBAQCBpbnRlbF9jb250ZXh0X3JlY29uZmlndXJlX3Nz
ZXUoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAogewogCWludCByZXQ7CiAKLQlHRU1fQlVHX09O
KElOVEVMX0dFTihjZS0+ZW5naW5lLT5pOTE1KSA8IDgpOworCUdFTV9CVUdfT04oR1JBUEhJQ1Nf
VkVSKGNlLT5lbmdpbmUtPmk5MTUpIDwgOCk7CiAKIAlyZXQgPSBpbnRlbF9jb250ZXh0X2xvY2tf
cGlubmVkKGNlKTsKIAlpZiAocmV0KQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZW5naW5lX2NzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdp
bmVfY3MuYwppbmRleCA2OTI4MWI1YWJhNTEuLjljZWRkZmJiMTY4NyAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKQEAgLTI0MCwxMCArMjQwLDEwIEBAIHZvaWQg
aW50ZWxfZW5naW5lX3NldF9od3NwX3dyaXRlbWFzayhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUsIHUzMiBtYXNrKQogCSAqIFRob3VnaCB0aGV5IGFkZGVkIG1vcmUgcmluZ3Mgb24gZzR4
L2lsaywgdGhleSBkaWQgbm90IGFkZAogCSAqIHBlci1lbmdpbmUgSFdTVEFNIHVudGlsIGdlbjYu
CiAJICovCi0JaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpIDwgNiAmJiBlbmdpbmUtPmNsYXNz
ICE9IFJFTkRFUl9DTEFTUykKKwlpZiAoR1JBUEhJQ1NfVkVSKGVuZ2luZS0+aTkxNSkgPCA2ICYm
IGVuZ2luZS0+Y2xhc3MgIT0gUkVOREVSX0NMQVNTKQogCQlyZXR1cm47CiAKLQlpZiAoSU5URUxf
R0VOKGVuZ2luZS0+aTkxNSkgPj0gMykKKwlpZiAoR1JBUEhJQ1NfVkVSKGVuZ2luZS0+aTkxNSkg
Pj0gMykKIAkJRU5HSU5FX1dSSVRFKGVuZ2luZSwgUklOR19IV1NUQU0sIG1hc2spOwogCWVsc2UK
IAkJRU5HSU5FX1dSSVRFMTYoZW5naW5lLCBSSU5HX0hXU1RBTSwgbWFzayk7CkBAIC0zMTcsNyAr
MzE3LDcgQEAgc3RhdGljIGludCBpbnRlbF9lbmdpbmVfc2V0dXAoc3RydWN0IGludGVsX2d0ICpn
dCwgZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQpCiAJCUNPTkZJR19EUk1fSTkxNV9USU1FU0xJQ0Vf
RFVSQVRJT047CiAKIAkvKiBPdmVycmlkZSB0byB1bmludGVycnVwdGlibGUgZm9yIE9wZW5DTCB3
b3JrbG9hZHMuICovCi0JaWYgKElOVEVMX0dFTihpOTE1KSA9PSAxMiAmJiBlbmdpbmUtPmNsYXNz
ID09IFJFTkRFUl9DTEFTUykKKwlpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID09IDEyICYmIGVuZ2lu
ZS0+Y2xhc3MgPT0gUkVOREVSX0NMQVNTKQogCQllbmdpbmUtPnByb3BzLnByZWVtcHRfdGltZW91
dF9tcyA9IDA7CiAKIAllbmdpbmUtPmRlZmF1bHRzID0gZW5naW5lLT5wcm9wczsgLyogbmV2ZXIg
dG8gY2hhbmdlIGFnYWluICovCkBAIC0zNTQsOCArMzU0LDggQEAgc3RhdGljIHZvaWQgX19zZXR1
cF9lbmdpbmVfY2FwYWJpbGl0aWVzKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAkJ
ICogSEVWQyBzdXBwb3J0IGlzIHByZXNlbnQgb24gZmlyc3QgZW5naW5lIGluc3RhbmNlCiAJCSAq
IGJlZm9yZSBHZW4xMSBhbmQgb24gYWxsIGluc3RhbmNlcyBhZnRlcndhcmRzLgogCQkgKi8KLQkJ
aWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSB8fAotCQkgICAgKElOVEVMX0dFTihpOTE1KSA+PSA5
ICYmIGVuZ2luZS0+aW5zdGFuY2UgPT0gMCkpCisJCWlmIChHUkFQSElDU19WRVIoaTkxNSkgPj0g
MTEgfHwKKwkJICAgIChHUkFQSElDU19WRVIoaTkxNSkgPj0gOSAmJiBlbmdpbmUtPmluc3RhbmNl
ID09IDApKQogCQkJZW5naW5lLT51YWJpX2NhcGFiaWxpdGllcyB8PQogCQkJCUk5MTVfVklERU9f
Q0xBU1NfQ0FQQUJJTElUWV9IRVZDOwogCkBAIC0zNjMsMTQgKzM2MywxNCBAQCBzdGF0aWMgdm9p
ZCBfX3NldHVwX2VuZ2luZV9jYXBhYmlsaXRpZXMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lKQogCQkgKiBTRkMgYmxvY2sgaXMgcHJlc2VudCBvbmx5IG9uIGV2ZW4gbG9naWNhbCBlbmdp
bmUKIAkJICogaW5zdGFuY2VzLgogCQkgKi8KLQkJaWYgKChJTlRFTF9HRU4oaTkxNSkgPj0gMTEg
JiYKKwkJaWYgKChHUkFQSElDU19WRVIoaTkxNSkgPj0gMTEgJiYKIAkJICAgICAoZW5naW5lLT5n
dC0+aW5mby52ZGJveF9zZmNfYWNjZXNzICYKIAkJICAgICAgQklUKGVuZ2luZS0+aW5zdGFuY2Up
KSkgfHwKLQkJICAgIChJTlRFTF9HRU4oaTkxNSkgPj0gOSAmJiBlbmdpbmUtPmluc3RhbmNlID09
IDApKQorCQkgICAgKEdSQVBISUNTX1ZFUihpOTE1KSA+PSA5ICYmIGVuZ2luZS0+aW5zdGFuY2Ug
PT0gMCkpCiAJCQllbmdpbmUtPnVhYmlfY2FwYWJpbGl0aWVzIHw9CiAJCQkJSTkxNV9WSURFT19B
TkRfRU5IQU5DRV9DTEFTU19DQVBBQklMSVRZX1NGQzsKIAl9IGVsc2UgaWYgKGVuZ2luZS0+Y2xh
c3MgPT0gVklERU9fRU5IQU5DRU1FTlRfQ0xBU1MpIHsKLQkJaWYgKElOVEVMX0dFTihpOTE1KSA+
PSA5KQorCQlpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID49IDkpCiAJCQllbmdpbmUtPnVhYmlfY2Fw
YWJpbGl0aWVzIHw9CiAJCQkJSTkxNV9WSURFT19BTkRfRU5IQU5DRV9DTEFTU19DQVBBQklMSVRZ
X1NGQzsKIAl9CkBAIC00NjgsNyArNDY4LDcgQEAgc3RhdGljIGludGVsX2VuZ2luZV9tYXNrX3Qg
aW5pdF9lbmdpbmVfbWFzayhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogCiAJaW5mby0+ZW5naW5lX21h
c2sgPSBJTlRFTF9JTkZPKGk5MTUpLT5wbGF0Zm9ybV9lbmdpbmVfbWFzazsKIAotCWlmIChJTlRF
TF9HRU4oaTkxNSkgPCAxMSkKKwlpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpIDwgMTEpCiAJCXJldHVy
biBpbmZvLT5lbmdpbmVfbWFzazsKIAogCW1lZGlhX2Z1c2UgPSB+aW50ZWxfdW5jb3JlX3JlYWQo
dW5jb3JlLCBHRU4xMV9HVF9WRUJPWF9WREJPWF9ESVNBQkxFKTsKQEAgLTQ5NCw3ICs0OTQsNyBA
QCBzdGF0aWMgaW50ZWxfZW5naW5lX21hc2tfdCBpbml0X2VuZ2luZV9tYXNrKHN0cnVjdCBpbnRl
bF9ndCAqZ3QpCiAJCSAqIGhvb2tlZCB1cCB0byBhbiBTRkMgKFNjYWxlciAmIEZvcm1hdCBDb252
ZXJ0ZXIpIHVuaXQuCiAJCSAqIEluIFRHTCBlYWNoIFZEQk9YIGhhcyBhY2Nlc3MgdG8gYW4gU0ZD
LgogCQkgKi8KLQkJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMiB8fCBsb2dpY2FsX3ZkYm94Kysg
JSAyID09IDApCisJCWlmIChHUkFQSElDU19WRVIoaTkxNSkgPj0gMTIgfHwgbG9naWNhbF92ZGJv
eCsrICUgMiA9PSAwKQogCQkJZ3QtPmluZm8udmRib3hfc2ZjX2FjY2VzcyB8PSBCSVQoaSk7CiAJ
fQogCWRybV9kYmcoJmk5MTUtPmRybSwgInZkYm94IGVuYWJsZTogJTA0eCwgaW5zdGFuY2VzOiAl
MDRseFxuIiwKQEAgLTczMSw3ICs3MzEsNyBAQCBzdGF0aWMgaW50IGVuZ2luZV9zZXR1cF9jb21t
b24oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCWludGVsX2VuZ2luZV9pbml0X3do
aXRlbGlzdChlbmdpbmUpOwogCWludGVsX2VuZ2luZV9pbml0X2N0eF93YShlbmdpbmUpOwogCi0J
aWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDEyKQorCWlmIChHUkFQSElDU19WRVIoZW5n
aW5lLT5pOTE1KSA+PSAxMikKIAkJZW5naW5lLT5mbGFncyB8PSBJOTE1X0VOR0lORV9IQVNfUkVM
QVRJVkVfTU1JTzsKIAogCXJldHVybiAwOwpAQCAtOTk5LDkgKzk5OSw5IEBAIHU2NCBpbnRlbF9l
bmdpbmVfZ2V0X2FjdGl2ZV9oZWFkKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSkKIAogCXU2NCBhY3RoZDsKIAotCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOCkKKwlpZiAoR1JB
UEhJQ1NfVkVSKGk5MTUpID49IDgpCiAJCWFjdGhkID0gRU5HSU5FX1JFQUQ2NChlbmdpbmUsIFJJ
TkdfQUNUSEQsIFJJTkdfQUNUSERfVURXKTsKLQllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0g
NCkKKwllbHNlIGlmIChHUkFQSElDU19WRVIoaTkxNSkgPj0gNCkKIAkJYWN0aGQgPSBFTkdJTkVf
UkVBRChlbmdpbmUsIFJJTkdfQUNUSEQpOwogCWVsc2UKIAkJYWN0aGQgPSBFTkdJTkVfUkVBRChl
bmdpbmUsIEFDVEhEKTsKQEAgLTEwMTMsNyArMTAxMyw3IEBAIHU2NCBpbnRlbF9lbmdpbmVfZ2V0
X2xhc3RfYmF0Y2hfaGVhZChjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7
CiAJdTY0IGJiYWRkcjsKIAotCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSA4KQorCWlm
IChHUkFQSElDU19WRVIoZW5naW5lLT5pOTE1KSA+PSA4KQogCQliYmFkZHIgPSBFTkdJTkVfUkVB
RDY0KGVuZ2luZSwgUklOR19CQkFERFIsIFJJTkdfQkJBRERSX1VEVyk7CiAJZWxzZQogCQliYmFk
ZHIgPSBFTkdJTkVfUkVBRChlbmdpbmUsIFJJTkdfQkJBRERSKTsKQEAgLTEwNjAsNyArMTA2MCw3
IEBAIGludCBpbnRlbF9lbmdpbmVfc3RvcF9jcyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpCiB7CiAJaW50IGVyciA9IDA7CiAKLQlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPCAz
KQorCWlmIChHUkFQSElDU19WRVIoZW5naW5lLT5pOTE1KSA8IDMpCiAJCXJldHVybiAtRU5PREVW
OwogCiAJRU5HSU5FX1RSQUNFKGVuZ2luZSwgIlxuIik7CkBAIC0xMTEwLDcgKzExMTAsNyBAQCBy
ZWFkX3N1YnNsaWNlX3JlZyhjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCiAJ
dTMyIG1jcl9tYXNrLCBtY3Jfc3MsIG1jciwgb2xkX21jciwgdmFsOwogCWVudW0gZm9yY2V3YWtl
X2RvbWFpbnMgZndfZG9tYWluczsKIAotCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpIHsKKwlp
ZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID49IDExKSB7CiAJCW1jcl9tYXNrID0gR0VOMTFfTUNSX1NM
SUNFX01BU0sgfCBHRU4xMV9NQ1JfU1VCU0xJQ0VfTUFTSzsKIAkJbWNyX3NzID0gR0VOMTFfTUNS
X1NMSUNFKHNsaWNlKSB8IEdFTjExX01DUl9TVUJTTElDRShzdWJzbGljZSk7CiAJfSBlbHNlIHsK
QEAgLTExNTksNyArMTE1OSw3IEBAIHZvaWQgaW50ZWxfZW5naW5lX2dldF9pbnN0ZG9uZShjb25z
dCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCiAKIAltZW1zZXQoaW5zdGRvbmUsIDAs
IHNpemVvZigqaW5zdGRvbmUpKTsKIAotCXN3aXRjaCAoSU5URUxfR0VOKGk5MTUpKSB7CisJc3dp
dGNoIChHUkFQSElDU19WRVIoaTkxNSkpIHsKIAlkZWZhdWx0OgogCQlpbnN0ZG9uZS0+aW5zdGRv
bmUgPQogCQkJaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBSSU5HX0lOU1RET05FKG1taW9fYmFz
ZSkpOwpAQCAtMTE2OSw3ICsxMTY5LDcgQEAgdm9pZCBpbnRlbF9lbmdpbmVfZ2V0X2luc3Rkb25l
KGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAogCQlpbnN0ZG9uZS0+c2xp
Y2VfY29tbW9uID0KIAkJCWludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VON19TQ19JTlNURE9O
RSk7Ci0JCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTIpIHsKKwkJaWYgKEdSQVBISUNTX1ZFUihp
OTE1KSA+PSAxMikgewogCQkJaW5zdGRvbmUtPnNsaWNlX2NvbW1vbl9leHRyYVswXSA9CiAJCQkJ
aW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU4xMl9TQ19JTlNURE9ORV9FWFRSQSk7CiAJCQlp
bnN0ZG9uZS0+c2xpY2VfY29tbW9uX2V4dHJhWzFdID0KQEAgLTEyMzIsNyArMTIzMiw3IEBAIHN0
YXRpYyBib29sIHJpbmdfaXNfaWRsZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJ
CWlkbGUgPSBmYWxzZTsKIAogCS8qIE5vIGJpdCBmb3IgZ2VuMiwgc28gYXNzdW1lIHRoZSBDUyBw
YXJzZXIgaXMgaWRsZSAqLwotCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+IDIgJiYKKwlp
ZiAoR1JBUEhJQ1NfVkVSKGVuZ2luZS0+aTkxNSkgPiAyICYmCiAJICAgICEoRU5HSU5FX1JFQUQo
ZW5naW5lLCBSSU5HX01JX01PREUpICYgTU9ERV9JRExFKSkKIAkJaWRsZSA9IGZhbHNlOwogCkBA
IC0xMzI5LDcgKzEzMjksNyBAQCB2b2lkIGludGVsX2VuZ2luZXNfcmVzZXRfZGVmYXVsdF9zdWJt
aXNzaW9uKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiAKIGJvb2wgaW50ZWxfZW5naW5lX2Nhbl9zdG9y
ZV9kd29yZChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7Ci0Jc3dpdGNoIChJTlRF
TF9HRU4oZW5naW5lLT5pOTE1KSkgeworCXN3aXRjaCAoR1JBUEhJQ1NfVkVSKGVuZ2luZS0+aTkx
NSkpIHsKIAljYXNlIDI6CiAJCXJldHVybiBmYWxzZTsgLyogdXNlcyBwaHlzaWNhbCBub3Qgdmly
dHVhbCBhZGRyZXNzZXMgKi8KIAljYXNlIDM6CkBAIC0xNDM0LDcgKzE0MzQsNyBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9lbmdpbmVfcHJpbnRfcmVnaXN0ZXJzKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSwKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAqIGNvbnN0IGV4ZWNsaXN0
cyA9ICZlbmdpbmUtPmV4ZWNsaXN0czsKIAl1NjQgYWRkcjsKIAotCWlmIChlbmdpbmUtPmlkID09
IFJFTkRFUl9DTEFTUyAmJiBJU19HRU5fUkFOR0UoZGV2X3ByaXYsIDQsIDcpKQorCWlmIChlbmdp
bmUtPmlkID09IFJFTkRFUl9DTEFTUyAmJiBJU19HUkFQSElDU19WRVIoZGV2X3ByaXYsIDQsIDcp
KQogCQlkcm1fcHJpbnRmKG0sICJcdENDSUQ6IDB4JTA4eFxuIiwgRU5HSU5FX1JFQUQoZW5naW5l
LCBDQ0lEKSk7CiAJaWYgKEhBU19FWEVDTElTVFMoZGV2X3ByaXYpKSB7CiAJCWRybV9wcmludGYo
bSwgIlx0RUxfU1RBVF9ISTogMHglMDh4XG4iLApAQCAtMTQ1MSwxMyArMTQ1MSwxMyBAQCBzdGF0
aWMgdm9pZCBpbnRlbF9lbmdpbmVfcHJpbnRfcmVnaXN0ZXJzKHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSwKIAlkcm1fcHJpbnRmKG0sICJcdFJJTkdfQ1RMOiAgIDB4JTA4eCVzXG4iLAog
CQkgICBFTkdJTkVfUkVBRChlbmdpbmUsIFJJTkdfQ1RMKSwKIAkJICAgRU5HSU5FX1JFQUQoZW5n
aW5lLCBSSU5HX0NUTCkgJiAoUklOR19XQUlUIHwgUklOR19XQUlUX1NFTUFQSE9SRSkgPyAiIFt3
YWl0aW5nXSIgOiAiIik7Ci0JaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID4gMikgeworCWlm
IChHUkFQSElDU19WRVIoZW5naW5lLT5pOTE1KSA+IDIpIHsKIAkJZHJtX3ByaW50ZihtLCAiXHRS
SU5HX01PREU6ICAweCUwOHglc1xuIiwKIAkJCSAgIEVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19N
SV9NT0RFKSwKIAkJCSAgIEVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19NSV9NT0RFKSAmIChNT0RF
X0lETEUpID8gIiBbaWRsZV0iIDogIiIpOwogCX0KIAotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
ID49IDYpIHsKKwlpZiAoR1JBUEhJQ1NfVkVSKGRldl9wcml2KSA+PSA2KSB7CiAJCWRybV9wcmlu
dGYobSwgIlx0UklOR19JTVI6ICAgMHglMDh4XG4iLAogCQkJICAgRU5HSU5FX1JFQUQoZW5naW5l
LCBSSU5HX0lNUikpOwogCQlkcm1fcHJpbnRmKG0sICJcdFJJTkdfRVNSOiAgIDB4JTA4eFxuIiwK
QEAgLTE0NzQsMTUgKzE0NzQsMTUgQEAgc3RhdGljIHZvaWQgaW50ZWxfZW5naW5lX3ByaW50X3Jl
Z2lzdGVycyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCiAJYWRkciA9IGludGVsX2Vu
Z2luZV9nZXRfbGFzdF9iYXRjaF9oZWFkKGVuZ2luZSk7CiAJZHJtX3ByaW50ZihtLCAiXHRCQkFE
RFI6IDB4JTA4eF8lMDh4XG4iLAogCQkgICB1cHBlcl8zMl9iaXRzKGFkZHIpLCBsb3dlcl8zMl9i
aXRzKGFkZHIpKTsKLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA4KQorCWlmIChHUkFQSElD
U19WRVIoZGV2X3ByaXYpID49IDgpCiAJCWFkZHIgPSBFTkdJTkVfUkVBRDY0KGVuZ2luZSwgUklO
R19ETUFfRkFERCwgUklOR19ETUFfRkFERF9VRFcpOwotCWVsc2UgaWYgKElOVEVMX0dFTihkZXZf
cHJpdikgPj0gNCkKKwllbHNlIGlmIChHUkFQSElDU19WRVIoZGV2X3ByaXYpID49IDQpCiAJCWFk
ZHIgPSBFTkdJTkVfUkVBRChlbmdpbmUsIFJJTkdfRE1BX0ZBREQpOwogCWVsc2UKIAkJYWRkciA9
IEVOR0lORV9SRUFEKGVuZ2luZSwgRE1BX0ZBRERfSThYWCk7CiAJZHJtX3ByaW50ZihtLCAiXHRE
TUFfRkFERFI6IDB4JTA4eF8lMDh4XG4iLAogCQkgICB1cHBlcl8zMl9iaXRzKGFkZHIpLCBsb3dl
cl8zMl9iaXRzKGFkZHIpKTsKLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA0KSB7CisJaWYg
KEdSQVBISUNTX1ZFUihkZXZfcHJpdikgPj0gNCkgewogCQlkcm1fcHJpbnRmKG0sICJcdElQRUlS
OiAweCUwOHhcbiIsCiAJCQkgICBFTkdJTkVfUkVBRChlbmdpbmUsIFJJTkdfSVBFSVIpKTsKIAkJ
ZHJtX3ByaW50ZihtLCAiXHRJUEVIUjogMHglMDh4XG4iLApAQCAtMTU2MSw3ICsxNTYxLDcgQEAg
c3RhdGljIHZvaWQgaW50ZWxfZW5naW5lX3ByaW50X3JlZ2lzdGVycyhzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmUsCiAJCX0KIAkJcmN1X3JlYWRfdW5sb2NrKCk7CiAJCWV4ZWNsaXN0c19h
Y3RpdmVfdW5sb2NrX2JoKGV4ZWNsaXN0cyk7Ci0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID4gNikgeworCX0gZWxzZSBpZiAoR1JBUEhJQ1NfVkVSKGRldl9wcml2KSA+IDYpIHsKIAkJ
ZHJtX3ByaW50ZihtLCAiXHRQUF9ESVJfQkFTRTogMHglMDh4XG4iLAogCQkJICAgRU5HSU5FX1JF
QUQoZW5naW5lLCBSSU5HX1BQX0RJUl9CQVNFKSk7CiAJCWRybV9wcmludGYobSwgIlx0UFBfRElS
X0JBU0VfUkVBRDogMHglMDh4XG4iLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZXhlY2xpc3RzX3N1Ym1pc3Npb24uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uLmMKaW5kZXggOGRiMjAwNDIyOTUwLi5mYzc3NTky
ZDg4YTkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2V4ZWNsaXN0
c19zdWJtaXNzaW9uLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZXhlY2xp
c3RzX3N1Ym1pc3Npb24uYwpAQCAtMTg0Nyw3ICsxODQ3LDcgQEAgcHJvY2Vzc19jc2Ioc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICoqaW5hY3RpdmUp
CiAJCUVOR0lORV9UUkFDRShlbmdpbmUsICJjc2JbJWRdOiBzdGF0dXM9MHglMDh4OjB4JTA4eFxu
IiwKIAkJCSAgICAgaGVhZCwgdXBwZXJfMzJfYml0cyhjc2IpLCBsb3dlcl8zMl9iaXRzKGNzYikp
OwogCi0JCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMikKKwkJaWYgKEdSQVBISUNT
X1ZFUihlbmdpbmUtPmk5MTUpID49IDEyKQogCQkJcHJvbW90ZSA9IGdlbjEyX2NzYl9wYXJzZShj
c2IpOwogCQllbHNlCiAJCQlwcm9tb3RlID0gZ2VuOF9jc2JfcGFyc2UoY3NiKTsKQEAgLTI3NzIs
NyArMjc3Miw3IEBAIHN0YXRpYyB2b2lkIGVuYWJsZV9leGVjbGlzdHMoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQogCiAJaW50ZWxfZW5naW5lX3NldF9od3NwX3dyaXRlbWFzayhlbmdp
bmUsIH4wdSk7IC8qIEhXU1RBTSAqLwogCi0JaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49
IDExKQorCWlmIChHUkFQSElDU19WRVIoZW5naW5lLT5pOTE1KSA+PSAxMSkKIAkJbW9kZSA9IF9N
QVNLRURfQklUX0VOQUJMRShHRU4xMV9HRlhfRElTQUJMRV9MRUdBQ1lfTU9ERSk7CiAJZWxzZQog
CQltb2RlID0gX01BU0tFRF9CSVRfRU5BQkxFKEdGWF9SVU5fTElTVF9FTkFCTEUpOwpAQCAtMzEw
Myw3ICszMTAzLDcgQEAgc3RhdGljIHZvaWQgZXhlY2xpc3RzX3Bhcmsoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQogCiBzdGF0aWMgYm9vbCBjYW5fcHJlZW1wdChzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUpCiB7Ci0JaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID4gOCkK
KwlpZiAoR1JBUEhJQ1NfVkVSKGVuZ2luZS0+aTkxNSkgPiA4KQogCQlyZXR1cm4gdHJ1ZTsKIAog
CS8qIEdQR1BVIG9uIGJkdyByZXF1aXJlcyBleHRyYSB3L2E7IG5vdCBpbXBsZW1lbnRlZCAqLwpA
QCAtMzE1NiwxMyArMzE1NiwxMyBAQCBsb2dpY2FsX3JpbmdfZGVmYXVsdF92ZnVuY3Moc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCWVuZ2luZS0+ZW1pdF9mbHVzaCA9IGdlbjhfZW1p
dF9mbHVzaF94Y3M7CiAJZW5naW5lLT5lbWl0X2luaXRfYnJlYWRjcnVtYiA9IGdlbjhfZW1pdF9p
bml0X2JyZWFkY3J1bWI7CiAJZW5naW5lLT5lbWl0X2ZpbmlfYnJlYWRjcnVtYiA9IGdlbjhfZW1p
dF9maW5pX2JyZWFkY3J1bWJfeGNzOwotCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSAx
MikgeworCWlmIChHUkFQSElDU19WRVIoZW5naW5lLT5pOTE1KSA+PSAxMikgewogCQllbmdpbmUt
PmVtaXRfZmluaV9icmVhZGNydW1iID0gZ2VuMTJfZW1pdF9maW5pX2JyZWFkY3J1bWJfeGNzOwog
CQllbmdpbmUtPmVtaXRfZmx1c2ggPSBnZW4xMl9lbWl0X2ZsdXNoX3hjczsKIAl9CiAJZW5naW5l
LT5zZXRfZGVmYXVsdF9zdWJtaXNzaW9uID0gZXhlY2xpc3RzX3NldF9kZWZhdWx0X3N1Ym1pc3Np
b247CiAKLQlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPCAxMSkgeworCWlmIChHUkFQSElD
U19WRVIoZW5naW5lLT5pOTE1KSA8IDExKSB7CiAJCWVuZ2luZS0+aXJxX2VuYWJsZSA9IGdlbjhf
bG9naWNhbF9yaW5nX2VuYWJsZV9pcnE7CiAJCWVuZ2luZS0+aXJxX2Rpc2FibGUgPSBnZW44X2xv
Z2ljYWxfcmluZ19kaXNhYmxlX2lycTsKIAl9IGVsc2UgewpAQCAtMzE5NSw3ICszMTk1LDcgQEAg
c3RhdGljIHZvaWQgbG9naWNhbF9yaW5nX2RlZmF1bHRfaXJxcyhzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUpCiB7CiAJdW5zaWduZWQgaW50IHNoaWZ0ID0gMDsKIAotCWlmIChJTlRFTF9H
RU4oZW5naW5lLT5pOTE1KSA8IDExKSB7CisJaWYgKEdSQVBISUNTX1ZFUihlbmdpbmUtPmk5MTUp
IDwgMTEpIHsKIAkJY29uc3QgdTggaXJxX3NoaWZ0c1tdID0gewogCQkJW1JDUzBdICA9IEdFTjhf
UkNTX0lSUV9TSElGVCwKIAkJCVtCQ1MwXSAgPSBHRU44X0JDU19JUlFfU0hJRlQsCkBAIC0zMjE1
LDcgKzMyMTUsNyBAQCBzdGF0aWMgdm9pZCBsb2dpY2FsX3JpbmdfZGVmYXVsdF9pcnFzKHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAogc3RhdGljIHZvaWQgcmNzX3N1Ym1pc3Npb25f
b3ZlcnJpZGUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewotCXN3aXRjaCAoSU5U
RUxfR0VOKGVuZ2luZS0+aTkxNSkpIHsKKwlzd2l0Y2ggKEdSQVBISUNTX1ZFUihlbmdpbmUtPmk5
MTUpKSB7CiAJY2FzZSAxMjoKIAkJZW5naW5lLT5lbWl0X2ZsdXNoID0gZ2VuMTJfZW1pdF9mbHVz
aF9yY3M7CiAJCWVuZ2luZS0+ZW1pdF9maW5pX2JyZWFkY3J1bWIgPSBnZW4xMl9lbWl0X2Zpbmlf
YnJlYWRjcnVtYl9yY3M7CkBAIC0zMjY2LDEzICszMjY2LDEzIEBAIGludCBpbnRlbF9leGVjbGlz
dHNfc3VibWlzc2lvbl9zZXR1cChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJZXhl
Y2xpc3RzLT5jc2Jfd3JpdGUgPQogCQkmZW5naW5lLT5zdGF0dXNfcGFnZS5hZGRyW2ludGVsX2h3
c19jc2Jfd3JpdGVfaW5kZXgoaTkxNSldOwogCi0JaWYgKElOVEVMX0dFTihpOTE1KSA8IDExKQor
CWlmIChHUkFQSElDU19WRVIoaTkxNSkgPCAxMSkKIAkJZXhlY2xpc3RzLT5jc2Jfc2l6ZSA9IEdF
TjhfQ1NCX0VOVFJJRVM7CiAJZWxzZQogCQlleGVjbGlzdHMtPmNzYl9zaXplID0gR0VOMTFfQ1NC
X0VOVFJJRVM7CiAKIAllbmdpbmUtPmNvbnRleHRfdGFnID0gR0VOTUFTSyhCSVRTX1BFUl9MT05H
IC0gMiwgMCk7Ci0JaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDExKSB7CisJaWYgKEdS
QVBISUNTX1ZFUihlbmdpbmUtPmk5MTUpID49IDExKSB7CiAJCWV4ZWNsaXN0cy0+Y2NpZCB8PSBl
bmdpbmUtPmluc3RhbmNlIDw8IChHRU4xMV9FTkdJTkVfSU5TVEFOQ0VfU0hJRlQgLSAzMik7CiAJ
CWV4ZWNsaXN0cy0+Y2NpZCB8PSBlbmdpbmUtPmNsYXNzIDw8IChHRU4xMV9FTkdJTkVfQ0xBU1Nf
U0hJRlQgLSAzMik7CiAJfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZ2d0dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ2d0dC5jCmluZGV4IDEw
YzIzYTc0OWE5NS4uMjBlNDZiODQzMzI0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9nZ3R0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ2d0
dC5jCkBAIC0xMDcsMTAgKzEwNywxMCBAQCBzdGF0aWMgYm9vbCBuZWVkc19pZGxlX21hcHMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJaWYgKCFpbnRlbF92dGRfYWN0aXZlKCkpCiAJ
CXJldHVybiBmYWxzZTsKIAotCWlmIChJU19HRU4oaTkxNSwgNSkgJiYgSVNfTU9CSUxFKGk5MTUp
KQorCWlmIChHUkFQSElDU19WRVIoaTkxNSkgPT0gNSAmJiBJU19NT0JJTEUoaTkxNSkpCiAJCXJl
dHVybiB0cnVlOwogCi0JaWYgKElTX0dFTihpOTE1LCAxMikpCisJaWYgKEdSQVBISUNTX1ZFUihp
OTE1KSA9PSAxMikKIAkJcmV0dXJuIHRydWU7IC8qIFhYWCBETUFSIGZhdWx0IHJlYXNvbiA3ICov
CiAKIAlyZXR1cm4gZmFsc2U7CkBAIC0xNzYsNyArMTc2LDcgQEAgc3RhdGljIHZvaWQgZ3VjX2dn
dHRfaW52YWxpZGF0ZShzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0KQogCiAJZ2VuOF9nZ3R0X2ludmFs
aWRhdGUoZ2d0dCk7CiAKLQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDEyKQorCWlmIChHUkFQSElD
U19WRVIoaTkxNSkgPj0gMTIpCiAJCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjEy
X0dVQ19UTEJfSU5WX0NSLAogCQkJCSAgICAgIEdFTjEyX0dVQ19UTEJfSU5WX0NSX0lOVkFMSURB
VEUpOwogCWVsc2UKQEAgLTgzMiw3ICs4MzIsNyBAQCBzdGF0aWMgaW50IGdndHRfcHJvYmVfY29t
bW9uKHN0cnVjdCBpOTE1X2dndHQgKmdndHQsIHU2NCBzaXplKQogCSAqIHJlc29ydCB0byBhbiB1
bmNhY2hlZCBtYXBwaW5nLiBUaGUgV0MgaXNzdWUgaXMgZWFzaWx5IGNhdWdodCBieSB0aGUKIAkg
KiByZWFkYmFjayBjaGVjayB3aGVuIHdyaXRpbmcgR1RUIFBURSBlbnRyaWVzLgogCSAqLwotCWlm
IChJU19HRU45X0xQKGk5MTUpIHx8IElOVEVMX0dFTihpOTE1KSA+PSAxMCkKKwlpZiAoSVNfR0VO
OV9MUChpOTE1KSB8fCBHUkFQSElDU19WRVIoaTkxNSkgPj0gMTApCiAJCWdndHQtPmdzbSA9IGlv
cmVtYXAocGh5c19hZGRyLCBzaXplKTsKIAllbHNlCiAJCWdndHQtPmdzbSA9IGlvcmVtYXBfd2Mo
cGh5c19hZGRyLCBzaXplKTsKQEAgLTEwNzgsNyArMTA3OCw3IEBAIHN0YXRpYyBpbnQgZ2VuNl9n
bWNoX3Byb2JlKHN0cnVjdCBpOTE1X2dndHQgKmdndHQpCiAJCWdndHQtPnZtLnB0ZV9lbmNvZGUg
PSBoc3dfcHRlX2VuY29kZTsKIAllbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpKQogCQlnZ3R0
LT52bS5wdGVfZW5jb2RlID0gYnl0X3B0ZV9lbmNvZGU7Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGk5
MTUpID49IDcpCisJZWxzZSBpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID49IDcpCiAJCWdndHQtPnZt
LnB0ZV9lbmNvZGUgPSBpdmJfcHRlX2VuY29kZTsKIAllbHNlCiAJCWdndHQtPnZtLnB0ZV9lbmNv
ZGUgPSBzbmJfcHRlX2VuY29kZTsKQEAgLTExNTAsOSArMTE1MCw5IEBAIHN0YXRpYyBpbnQgZ2d0
dF9wcm9iZV9odyhzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0LCBzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQog
CWdndHQtPnZtLmRtYSA9IGk5MTUtPmRybS5kZXY7CiAJZG1hX3Jlc3ZfaW5pdCgmZ2d0dC0+dm0u
X3Jlc3YpOwogCi0JaWYgKElOVEVMX0dFTihpOTE1KSA8PSA1KQorCWlmIChHUkFQSElDU19WRVIo
aTkxNSkgPD0gNSkKIAkJcmV0ID0gaTkxNV9nbWNoX3Byb2JlKGdndHQpOwotCWVsc2UgaWYgKElO
VEVMX0dFTihpOTE1KSA8IDgpCisJZWxzZSBpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpIDwgOCkKIAkJ
cmV0ID0gZ2VuNl9nbWNoX3Byb2JlKGdndHQpOwogCWVsc2UKIAkJcmV0ID0gZ2VuOF9nbWNoX3By
b2JlKGdndHQpOwpAQCAtMTIwOSw3ICsxMjA5LDcgQEAgaW50IGk5MTVfZ2d0dF9wcm9iZV9odyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAogaW50IGk5MTVfZ2d0dF9lbmFibGVfaHco
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7Ci0JaWYgKElOVEVMX0dFTihpOTE1KSA8
IDYgJiYgIWludGVsX2VuYWJsZV9ndHQoKSkKKwlpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpIDwgNiAm
JiAhaW50ZWxfZW5hYmxlX2d0dCgpKQogCQlyZXR1cm4gLUVJTzsKIAogCXJldHVybiAwOwpAQCAt
MTI3NCw3ICsxMjc0LDcgQEAgdm9pZCBpOTE1X2dndHRfcmVzdW1lKHN0cnVjdCBpOTE1X2dndHQg
KmdndHQpCiAJaWYgKGZsdXNoKQogCQl3YmludmRfb25fYWxsX2NwdXMoKTsKIAotCWlmIChJTlRF
TF9HRU4oZ2d0dC0+dm0uaTkxNSkgPj0gOCkKKwlpZiAoR1JBUEhJQ1NfVkVSKGdndHQtPnZtLmk5
MTUpID49IDgpCiAJCXNldHVwX3ByaXZhdGVfcGF0KGdndHQtPnZtLmd0LT51bmNvcmUpOwogCiAJ
aW50ZWxfZ2d0dF9yZXN0b3JlX2ZlbmNlcyhnZ3R0KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2dndHRfZmVuY2luZy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZ2d0dF9mZW5jaW5nLmMKaW5kZXggN2JmODRjZDIxNTQzLi5jYWM3ZjNmNDQ2NDIg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2dndHRfZmVuY2luZy5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2dndHRfZmVuY2luZy5jCkBAIC01
Niw3ICs1Niw3IEBAIHN0YXRpYyB2b2lkIGk5NjVfd3JpdGVfZmVuY2VfcmVnKHN0cnVjdCBpOTE1
X2ZlbmNlX3JlZyAqZmVuY2UpCiAJaW50IGZlbmNlX3BpdGNoX3NoaWZ0OwogCXU2NCB2YWw7CiAK
LQlpZiAoSU5URUxfR0VOKGZlbmNlX3RvX2k5MTUoZmVuY2UpKSA+PSA2KSB7CisJaWYgKEdSQVBI
SUNTX1ZFUihmZW5jZV90b19pOTE1KGZlbmNlKSkgPj0gNikgewogCQlmZW5jZV9yZWdfbG8gPSBG
RU5DRV9SRUdfR0VONl9MTyhmZW5jZS0+aWQpOwogCQlmZW5jZV9yZWdfaGkgPSBGRU5DRV9SRUdf
R0VONl9ISShmZW5jZS0+aWQpOwogCQlmZW5jZV9waXRjaF9zaGlmdCA9IEdFTjZfRkVOQ0VfUElU
Q0hfU0hJRlQ7CkBAIC0xNzMsOSArMTczLDkgQEAgc3RhdGljIHZvaWQgZmVuY2Vfd3JpdGUoc3Ry
dWN0IGk5MTVfZmVuY2VfcmVnICpmZW5jZSkKIAkgKiBhbmQgZXhwbGljaXRseSBtYW5hZ2VkIGZv
ciBpbnRlcm5hbCB1c2Vycy4KIAkgKi8KIAotCWlmIChJU19HRU4oaTkxNSwgMikpCisJaWYgKEdS
QVBISUNTX1ZFUihpOTE1KSA9PSAyKQogCQlpODMwX3dyaXRlX2ZlbmNlX3JlZyhmZW5jZSk7Ci0J
ZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDMpKQorCWVsc2UgaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA9
PSAzKQogCQlpOTE1X3dyaXRlX2ZlbmNlX3JlZyhmZW5jZSk7CiAJZWxzZQogCQlpOTY1X3dyaXRl
X2ZlbmNlX3JlZyhmZW5jZSk7CkBAIC0xODgsNyArMTg4LDcgQEAgc3RhdGljIHZvaWQgZmVuY2Vf
d3JpdGUoc3RydWN0IGk5MTVfZmVuY2VfcmVnICpmZW5jZSkKIAogc3RhdGljIGJvb2wgZ3B1X3Vz
ZXNfZmVuY2VfcmVnaXN0ZXJzKHN0cnVjdCBpOTE1X2ZlbmNlX3JlZyAqZmVuY2UpCiB7Ci0JcmV0
dXJuIElOVEVMX0dFTihmZW5jZV90b19pOTE1KGZlbmNlKSkgPCA0OworCXJldHVybiBHUkFQSElD
U19WRVIoZmVuY2VfdG9faTkxNShmZW5jZSkpIDwgNDsKIH0KIAogc3RhdGljIGludCBmZW5jZV91
cGRhdGUoc3RydWN0IGk5MTVfZmVuY2VfcmVnICpmZW5jZSwKQEAgLTU2OSw3ICs1NjksNyBAQCBz
dGF0aWMgdm9pZCBkZXRlY3RfYml0XzZfc3dpenpsZShzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0KQog
CXUzMiBzd2l6emxlX3ggPSBJOTE1X0JJVF82X1NXSVpaTEVfVU5LTk9XTjsKIAl1MzIgc3dpenps
ZV95ID0gSTkxNV9CSVRfNl9TV0laWkxFX1VOS05PV047CiAKLQlpZiAoSU5URUxfR0VOKGk5MTUp
ID49IDggfHwgSVNfVkFMTEVZVklFVyhpOTE1KSkgeworCWlmIChHUkFQSElDU19WRVIoaTkxNSkg
Pj0gOCB8fCBJU19WQUxMRVlWSUVXKGk5MTUpKSB7CiAJCS8qCiAJCSAqIE9uIEJEVyssIHN3aXp6
bGluZyBpcyBub3QgdXNlZC4gV2UgbGVhdmUgdGhlIENQVSBtZW1vcnkKIAkJICogY29udHJvbGxl
ciBpbiBjaGFyZ2Ugb2Ygb3B0aW1pemluZyBtZW1vcnkgYWNjZXNzZXMgd2l0aG91dApAQCAtNTc5
LDcgKzU3OSw3IEBAIHN0YXRpYyB2b2lkIGRldGVjdF9iaXRfNl9zd2l6emxlKHN0cnVjdCBpOTE1
X2dndHQgKmdndHQpCiAJCSAqLwogCQlzd2l6emxlX3ggPSBJOTE1X0JJVF82X1NXSVpaTEVfTk9O
RTsKIAkJc3dpenpsZV95ID0gSTkxNV9CSVRfNl9TV0laWkxFX05PTkU7Ci0JfSBlbHNlIGlmIChJ
TlRFTF9HRU4oaTkxNSkgPj0gNikgeworCX0gZWxzZSBpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID49
IDYpIHsKIAkJaWYgKGk5MTUtPnByZXNlcnZlX2Jpb3Nfc3dpenpsZSkgewogCQkJaWYgKGludGVs
X3VuY29yZV9yZWFkKHVuY29yZSwgRElTUF9BUkJfQ1RMKSAmCiAJCQkgICAgRElTUF9USUxFX1NV
UkZBQ0VfU1dJWlpMSU5HKSB7CkBAIC02MTEsMTQgKzYxMSwxNCBAQCBzdGF0aWMgdm9pZCBkZXRl
Y3RfYml0XzZfc3dpenpsZShzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0KQogCQkJCXN3aXp6bGVfeSA9
IEk5MTVfQklUXzZfU1dJWlpMRV9OT05FOwogCQkJfQogCQl9Ci0JfSBlbHNlIGlmIChJU19HRU4o
aTkxNSwgNSkpIHsKKwl9IGVsc2UgaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA9PSA1KSB7CiAJCS8q
CiAJCSAqIE9uIElyb25sYWtlIHdoYXRldmVyIERSQU0gY29uZmlnLCBHUFUgYWx3YXlzIGRvCiAJ
CSAqIHNhbWUgc3dpenpsaW5nIHNldHVwLgogCQkgKi8KIAkJc3dpenpsZV94ID0gSTkxNV9CSVRf
Nl9TV0laWkxFXzlfMTA7CiAJCXN3aXp6bGVfeSA9IEk5MTVfQklUXzZfU1dJWlpMRV85OwotCX0g
ZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDIpKSB7CisJfSBlbHNlIGlmIChHUkFQSElDU19WRVIoaTkx
NSkgPT0gMikgewogCQkvKgogCQkgKiBBcyBmYXIgYXMgd2Uga25vdywgdGhlIDg2NSBkb2Vzbid0
IGhhdmUgdGhlc2UgYml0IDYKIAkJICogc3dpenpsaW5nIGlzc3Vlcy4KQEAgLTY5Nyw3ICs2OTcs
NyBAQCBzdGF0aWMgdm9pZCBkZXRlY3RfYml0XzZfc3dpenpsZShzdHJ1Y3QgaTkxNV9nZ3R0ICpn
Z3R0KQogCQl9CiAKIAkJLyogY2hlY2sgZm9yIEwtc2hhcGVkIG1lbW9yeSBha2EgbW9kaWZpZWQg
ZW5oYW5jZWQgYWRkcmVzc2luZyAqLwotCQlpZiAoSVNfR0VOKGk5MTUsIDQpICYmCisJCWlmIChH
UkFQSElDU19WRVIoaTkxNSkgPT0gNCAmJgogCQkgICAgIShpbnRlbF91bmNvcmVfcmVhZCh1bmNv
cmUsIERDQzIpICYgRENDMl9NT0RJRklFRF9FTkhBTkNFRF9ESVNBQkxFKSkgewogCQkJc3dpenps
ZV94ID0gSTkxNV9CSVRfNl9TV0laWkxFX1VOS05PV047CiAJCQlzd2l6emxlX3kgPSBJOTE1X0JJ
VF82X1NXSVpaTEVfVU5LTk9XTjsKQEAgLTg0NCwxMCArODQ0LDEwIEBAIHZvaWQgaW50ZWxfZ2d0
dF9pbml0X2ZlbmNlcyhzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0KQogCiAJaWYgKCFpOTE1X2dndHRf
aGFzX2FwZXJ0dXJlKGdndHQpKQogCQludW1fZmVuY2VzID0gMDsKLQllbHNlIGlmIChJTlRFTF9H
RU4oaTkxNSkgPj0gNyAmJgorCWVsc2UgaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA+PSA3ICYmCiAJ
CSAhKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkpCiAJCW51bV9m
ZW5jZXMgPSAzMjsKLQllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNCB8fAorCWVsc2UgaWYg
KEdSQVBISUNTX1ZFUihpOTE1KSA+PSA0IHx8CiAJCSBJU19JOTQ1RyhpOTE1KSB8fCBJU19JOTQ1
R00oaTkxNSkgfHwKIAkJIElTX0czMyhpOTE1KSB8fCBJU19QSU5FVklFVyhpOTE1KSkKIAkJbnVt
X2ZlbmNlcyA9IDE2OwpAQCAtODk1LDI5ICs4OTUsMjkgQEAgdm9pZCBpbnRlbF9ndF9pbml0X3N3
aXp6bGluZyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gZ3QtPmk5MTU7CiAJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gZ3QtPnVuY29y
ZTsKIAotCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA1IHx8CisJaWYgKEdSQVBISUNTX1ZFUihpOTE1
KSA8IDUgfHwKIAkgICAgaTkxNS0+Z2d0dC5iaXRfNl9zd2l6emxlX3ggPT0gSTkxNV9CSVRfNl9T
V0laWkxFX05PTkUpCiAJCXJldHVybjsKIAogCWludGVsX3VuY29yZV9ybXcodW5jb3JlLCBESVNQ
X0FSQl9DVEwsIDAsIERJU1BfVElMRV9TVVJGQUNFX1NXSVpaTElORyk7CiAKLQlpZiAoSVNfR0VO
KGk5MTUsIDUpKQorCWlmIChHUkFQSElDU19WRVIoaTkxNSkgPT0gNSkKIAkJcmV0dXJuOwogCiAJ
aW50ZWxfdW5jb3JlX3Jtdyh1bmNvcmUsIFRJTEVDVEwsIDAsIFRJTEVDVExfU1daQ1RMKTsKIAot
CWlmIChJU19HRU4oaTkxNSwgNikpCisJaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA9PSA2KQogCQlp
bnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLAogCQkJCSAgIEFSQl9NT0RFLAogCQkJCSAgIF9NQVNL
RURfQklUX0VOQUJMRShBUkJfTU9ERV9TV0laWkxFX1NOQikpOwotCWVsc2UgaWYgKElTX0dFTihp
OTE1LCA3KSkKKwllbHNlIGlmIChHUkFQSElDU19WRVIoaTkxNSkgPT0gNykKIAkJaW50ZWxfdW5j
b3JlX3dyaXRlKHVuY29yZSwKIAkJCQkgICBBUkJfTU9ERSwKIAkJCQkgICBfTUFTS0VEX0JJVF9F
TkFCTEUoQVJCX01PREVfU1dJWlpMRV9JVkIpKTsKLQllbHNlIGlmIChJU19HRU4oaTkxNSwgOCkp
CisJZWxzZSBpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID09IDgpCiAJCWludGVsX3VuY29yZV93cml0
ZSh1bmNvcmUsCiAJCQkJICAgR0FNVEFSQk1PREUsCiAJCQkJICAgX01BU0tFRF9CSVRfRU5BQkxF
KEFSQl9NT0RFX1NXSVpaTEVfQkRXKSk7CiAJZWxzZQotCQlNSVNTSU5HX0NBU0UoSU5URUxfR0VO
KGk5MTUpKTsKKwkJTUlTU0lOR19DQVNFKEdSQVBISUNTX1ZFUihpOTE1KSk7CiB9CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfZ3QuYwppbmRleCAzZjg4ZWNkZWUwMzEuLjIxNjFiZjAxZWY4YiAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5jCkBAIC0xMTMsMTAgKzExMywxMCBAQCBzdGF0aWMg
dm9pZCBpbml0X3VudXNlZF9yaW5ncyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogCQlpbml0X3VudXNl
ZF9yaW5nKGd0LCBTUkIxX0JBU0UpOwogCQlpbml0X3VudXNlZF9yaW5nKGd0LCBTUkIyX0JBU0Up
OwogCQlpbml0X3VudXNlZF9yaW5nKGd0LCBTUkIzX0JBU0UpOwotCX0gZWxzZSBpZiAoSVNfR0VO
KGk5MTUsIDIpKSB7CisJfSBlbHNlIGlmIChHUkFQSElDU19WRVIoaTkxNSkgPT0gMikgewogCQlp
bml0X3VudXNlZF9yaW5nKGd0LCBTUkIwX0JBU0UpOwogCQlpbml0X3VudXNlZF9yaW5nKGd0LCBT
UkIxX0JBU0UpOwotCX0gZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDMpKSB7CisJfSBlbHNlIGlmIChH
UkFQSElDU19WRVIoaTkxNSkgPT0gMykgewogCQlpbml0X3VudXNlZF9yaW5nKGd0LCBQUkIxX0JB
U0UpOwogCQlpbml0X3VudXNlZF9yaW5nKGd0LCBQUkIyX0JBU0UpOwogCX0KQEAgLTEzMyw3ICsx
MzMsNyBAQCBpbnQgaW50ZWxfZ3RfaW5pdF9odyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogCS8qIERv
dWJsZSBsYXllciBzZWN1cml0eSBibGFua2V0LCBzZWUgaTkxNV9nZW1faW5pdCgpICovCiAJaW50
ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQodW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKIAotCWlmIChI
QVNfRURSQU0oaTkxNSkgJiYgSU5URUxfR0VOKGk5MTUpIDwgOSkKKwlpZiAoSEFTX0VEUkFNKGk5
MTUpICYmIEdSQVBISUNTX1ZFUihpOTE1KSA8IDkpCiAJCWludGVsX3VuY29yZV9ybXcodW5jb3Jl
LCBIU1dfSURJQ1IsIDAsIElESUhBU0hNU0soMHhmKSk7CiAKIAlpZiAoSVNfSEFTV0VMTChpOTE1
KSkKQEAgLTIwNiwxMCArMjA2LDEwIEBAIGludGVsX2d0X2NsZWFyX2Vycm9yX3JlZ2lzdGVycyhz
dHJ1Y3QgaW50ZWxfZ3QgKmd0LAogCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IGd0LT51
bmNvcmU7CiAJdTMyIGVpcjsKIAotCWlmICghSVNfR0VOKGk5MTUsIDIpKQorCWlmIChHUkFQSElD
U19WRVIoaTkxNSkgIT0gMikKIAkJY2xlYXJfcmVnaXN0ZXIodW5jb3JlLCBQR1RCTF9FUik7CiAK
LQlpZiAoSU5URUxfR0VOKGk5MTUpIDwgNCkKKwlpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpIDwgNCkK
IAkJY2xlYXJfcmVnaXN0ZXIodW5jb3JlLCBJUEVJUihSRU5ERVJfUklOR19CQVNFKSk7CiAJZWxz
ZQogCQljbGVhcl9yZWdpc3Rlcih1bmNvcmUsIElQRUlSX0k5NjUpOwpAQCAtMjI3LDEzICsyMjcs
MTMgQEAgaW50ZWxfZ3RfY2xlYXJfZXJyb3JfcmVnaXN0ZXJzKHN0cnVjdCBpbnRlbF9ndCAqZ3Qs
CiAJCQkJICAgSTkxNV9NQVNURVJfRVJST1JfSU5URVJSVVBUKTsKIAl9CiAKLQlpZiAoSU5URUxf
R0VOKGk5MTUpID49IDEyKSB7CisJaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA+PSAxMikgewogCQly
bXdfY2xlYXIodW5jb3JlLCBHRU4xMl9SSU5HX0ZBVUxUX1JFRywgUklOR19GQVVMVF9WQUxJRCk7
CiAJCWludGVsX3VuY29yZV9wb3N0aW5nX3JlYWQodW5jb3JlLCBHRU4xMl9SSU5HX0ZBVUxUX1JF
Ryk7Ci0JfSBlbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOCkgeworCX0gZWxzZSBpZiAoR1JB
UEhJQ1NfVkVSKGk5MTUpID49IDgpIHsKIAkJcm13X2NsZWFyKHVuY29yZSwgR0VOOF9SSU5HX0ZB
VUxUX1JFRywgUklOR19GQVVMVF9WQUxJRCk7CiAJCWludGVsX3VuY29yZV9wb3N0aW5nX3JlYWQo
dW5jb3JlLCBHRU44X1JJTkdfRkFVTFRfUkVHKTsKLQl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1
KSA+PSA2KSB7CisJfSBlbHNlIGlmIChHUkFQSElDU19WRVIoaTkxNSkgPj0gNikgewogCQlzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CiAJCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwog
CkBAIC0yNzEsNyArMjcxLDcgQEAgc3RhdGljIHZvaWQgZ2VuOF9jaGVja19mYXVsdHMoc3RydWN0
IGludGVsX2d0ICpndCkKIAlpOTE1X3JlZ190IGZhdWx0X3JlZywgZmF1bHRfZGF0YTBfcmVnLCBm
YXVsdF9kYXRhMV9yZWc7CiAJdTMyIGZhdWx0OwogCi0JaWYgKElOVEVMX0dFTihndC0+aTkxNSkg
Pj0gMTIpIHsKKwlpZiAoR1JBUEhJQ1NfVkVSKGd0LT5pOTE1KSA+PSAxMikgewogCQlmYXVsdF9y
ZWcgPSBHRU4xMl9SSU5HX0ZBVUxUX1JFRzsKIAkJZmF1bHRfZGF0YTBfcmVnID0gR0VOMTJfRkFV
TFRfVExCX0RBVEEwOwogCQlmYXVsdF9kYXRhMV9yZWcgPSBHRU4xMl9GQVVMVF9UTEJfREFUQTE7
CkBAIC0zMTEsOSArMzExLDkgQEAgdm9pZCBpbnRlbF9ndF9jaGVja19hbmRfY2xlYXJfZmF1bHRz
KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBn
dC0+aTkxNTsKIAogCS8qIEZyb20gR0VOOCBvbndhcmRzIHdlIG9ubHkgaGF2ZSBvbmUgJ0FsbCBF
bmdpbmUgRmF1bHQgUmVnaXN0ZXInICovCi0JaWYgKElOVEVMX0dFTihpOTE1KSA+PSA4KQorCWlm
IChHUkFQSElDU19WRVIoaTkxNSkgPj0gOCkKIAkJZ2VuOF9jaGVja19mYXVsdHMoZ3QpOwotCWVs
c2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA2KQorCWVsc2UgaWYgKEdSQVBISUNTX1ZFUihpOTE1
KSA+PSA2KQogCQlnZW42X2NoZWNrX2ZhdWx0cyhndCk7CiAJZWxzZQogCQlyZXR1cm47CkBAIC0z
NjUsNyArMzY1LDcgQEAgdm9pZCBpbnRlbF9ndF9mbHVzaF9nZ3R0X3dyaXRlcyhzdHJ1Y3QgaW50
ZWxfZ3QgKmd0KQogdm9pZCBpbnRlbF9ndF9jaGlwc2V0X2ZsdXNoKHN0cnVjdCBpbnRlbF9ndCAq
Z3QpCiB7CiAJd21iKCk7Ci0JaWYgKElOVEVMX0dFTihndC0+aTkxNSkgPCA2KQorCWlmIChHUkFQ
SElDU19WRVIoZ3QtPmk5MTUpIDwgNikKIAkJaW50ZWxfZ3R0X2NoaXBzZXRfZmx1c2goKTsKIH0K
IApAQCAtNTg5LDcgKzU4OSw4IEBAIGludCBpbnRlbF9ndF9pbml0KHN0cnVjdCBpbnRlbF9ndCAq
Z3QpCiAJICovCiAJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoZ3QtPnVuY29yZSwgRk9SQ0VX
QUtFX0FMTCk7CiAKLQllcnIgPSBpbnRlbF9ndF9pbml0X3NjcmF0Y2goZ3QsIElTX0dFTihndC0+
aTkxNSwgMikgPyBTWl8yNTZLIDogU1pfNEspOworCWVyciA9IGludGVsX2d0X2luaXRfc2NyYXRj
aChndCwKKwkJCQkgICAgR1JBUEhJQ1NfVkVSKGd0LT5pOTE1KSA9PSAyID8gU1pfMjU2SyA6IFNa
XzRLKTsKIAlpZiAoZXJyKQogCQlnb3RvIG91dF9mdzsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfY2xvY2tfdXRpbHMuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2d0X2Nsb2NrX3V0aWxzLmMKaW5kZXggNTgyZmNhZWUxMWFhLi45ZjBlNzI5
ZDJkMTUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X2Nsb2Nr
X3V0aWxzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfY2xvY2tfdXRp
bHMuYwpAQCAtNzYsNyArNzYsNyBAQCBzdGF0aWMgdTMyIHJlYWRfY2xvY2tfZnJlcXVlbmN5KHN0
cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSkKIAl1MzIgZjE5XzJfbWh6ID0gMTkyMDAwMDA7CiAJ
dTMyIGYyNF9taHogPSAyNDAwMDAwMDsKIAotCWlmIChJTlRFTF9HRU4odW5jb3JlLT5pOTE1KSA8
PSA0KSB7CisJaWYgKEdSQVBISUNTX1ZFUih1bmNvcmUtPmk5MTUpIDw9IDQpIHsKIAkJLyoKIAkJ
ICogUFJNcyBzYXk6CiAJCSAqCkBAIC04NSw3ICs4NSw3IEBAIHN0YXRpYyB1MzIgcmVhZF9jbG9j
a19mcmVxdWVuY3koc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlKQogCQkgKiAgICAgICjigJxD
TEtDRkfigJ0pIE1DSEJBUiByZWdpc3RlcikKIAkJICovCiAJCXJldHVybiBSVU5USU1FX0lORk8o
dW5jb3JlLT5pOTE1KS0+cmF3Y2xrX2ZyZXEgKiAxMDAwIC8gMTY7Ci0JfSBlbHNlIGlmIChJTlRF
TF9HRU4odW5jb3JlLT5pOTE1KSA8PSA4KSB7CisJfSBlbHNlIGlmIChHUkFQSElDU19WRVIodW5j
b3JlLT5pOTE1KSA8PSA4KSB7CiAJCS8qCiAJCSAqIFBSTXMgc2F5OgogCQkgKgpAQCAtOTQsNyAr
OTQsNyBAQCBzdGF0aWMgdTMyIHJlYWRfY2xvY2tfZnJlcXVlbmN5KHN0cnVjdCBpbnRlbF91bmNv
cmUgKnVuY29yZSkKIAkJICogICAgICByb2xsaW5nIG92ZXIgZXZlcnkgMS41IGhvdXJzKS4KIAkJ
ICovCiAJCXJldHVybiBmMTJfNV9taHo7Ci0JfSBlbHNlIGlmIChJTlRFTF9HRU4odW5jb3JlLT5p
OTE1KSA8PSA5KSB7CisJfSBlbHNlIGlmIChHUkFQSElDU19WRVIodW5jb3JlLT5pOTE1KSA8PSA5
KSB7CiAJCXUzMiBjdGNfcmVnID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBDVENfTU9ERSk7
CiAJCXUzMiBmcmVxID0gMDsKIApAQCAtMTEzLDcgKzExMyw3IEBAIHN0YXRpYyB1MzIgcmVhZF9j
bG9ja19mcmVxdWVuY3koc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlKQogCQl9CiAKIAkJcmV0
dXJuIGZyZXE7Ci0JfSBlbHNlIGlmIChJTlRFTF9HRU4odW5jb3JlLT5pOTE1KSA8PSAxMikgewor
CX0gZWxzZSBpZiAoR1JBUEhJQ1NfVkVSKHVuY29yZS0+aTkxNSkgPD0gMTIpIHsKIAkJdTMyIGN0
Y19yZWcgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIENUQ19NT0RFKTsKIAkJdTMyIGZyZXEg
PSAwOwogCkBAIC0xMjgsNyArMTI4LDcgQEAgc3RhdGljIHUzMiByZWFkX2Nsb2NrX2ZyZXF1ZW5j
eShzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUpCiAJCX0gZWxzZSB7CiAJCQl1MzIgYzAgPSBp
bnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIFJQTV9DT05GSUcwKTsKIAotCQkJaWYgKElOVEVMX0dF
Tih1bmNvcmUtPmk5MTUpIDw9IDEwKQorCQkJaWYgKEdSQVBISUNTX1ZFUih1bmNvcmUtPmk5MTUp
IDw9IDEwKQogCQkJCWZyZXEgPSBnZW4xMF9nZXRfY3J5c3RhbF9jbG9ja19mcmVxKHVuY29yZSwg
YzApOwogCQkJZWxzZQogCQkJCWZyZXEgPSBnZW4xMV9nZXRfY3J5c3RhbF9jbG9ja19mcmVxKHVu
Y29yZSwgYzApOwpAQCAtMjExLDcgKzIxMSw3IEBAIHU2NCBpbnRlbF9ndF9uc190b19wbV9pbnRl
cnZhbChjb25zdCBzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1NjQgbnMpCiAJICogZnJvemVuIG1hY2hp
bmUuCiAJICovCiAJdmFsID0gZGl2X3U2NF9yb3VuZHVwKGludGVsX2d0X25zX3RvX2Nsb2NrX2lu
dGVydmFsKGd0LCBucyksIDE2KTsKLQlpZiAoSVNfR0VOKGd0LT5pOTE1LCA2KSkKKwlpZiAoR1JB
UEhJQ1NfVkVSKGd0LT5pOTE1KSA9PSA2KQogCQl2YWwgPSBkaXZfdTY0X3JvdW5kdXAodmFsLCAy
NSkgKiAyNTsKIAogCXJldHVybiB2YWw7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9ndF9pcnEuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X2ly
cS5jCmluZGV4IGY4OGMxMDM2NmU1OC4uYzEzNDYyMjc0ZmU4IDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9pcnEuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9ndF9pcnEuYwpAQCAtMzk5LDcgKzM5OSw3IEBAIHZvaWQgZ2VuNV9ndF9pcnFf
cmVzZXQoc3RydWN0IGludGVsX2d0ICpndCkKIAlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUg
PSBndC0+dW5jb3JlOwogCiAJR0VOM19JUlFfUkVTRVQodW5jb3JlLCBHVCk7Ci0JaWYgKElOVEVM
X0dFTihndC0+aTkxNSkgPj0gNikKKwlpZiAoR1JBUEhJQ1NfVkVSKGd0LT5pOTE1KSA+PSA2KQog
CQlHRU4zX0lSUV9SRVNFVCh1bmNvcmUsIEdFTjZfUE0pOwogfQogCkBAIC00MTcsMTQgKzQxNywx
NCBAQCB2b2lkIGdlbjVfZ3RfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiAJ
fQogCiAJZ3RfaXJxcyB8PSBHVF9SRU5ERVJfVVNFUl9JTlRFUlJVUFQ7Ci0JaWYgKElTX0dFTihn
dC0+aTkxNSwgNSkpCisJaWYgKEdSQVBISUNTX1ZFUihndC0+aTkxNSkgPT0gNSkKIAkJZ3RfaXJx
cyB8PSBJTEtfQlNEX1VTRVJfSU5URVJSVVBUOwogCWVsc2UKIAkJZ3RfaXJxcyB8PSBHVF9CTFRf
VVNFUl9JTlRFUlJVUFQgfCBHVF9CU0RfVVNFUl9JTlRFUlJVUFQ7CiAKIAlHRU4zX0lSUV9JTklU
KHVuY29yZSwgR1QsIGd0LT5ndF9pbXIsIGd0X2lycXMpOwogCi0JaWYgKElOVEVMX0dFTihndC0+
aTkxNSkgPj0gNikgeworCWlmIChHUkFQSElDU19WRVIoZ3QtPmk5MTUpID49IDYpIHsKIAkJLyoK
IAkJICogUlBTIGludGVycnVwdHMgd2lsbCBnZXQgZW5hYmxlZC9kaXNhYmxlZCBvbiBkZW1hbmQg
d2hlbiBSUFMKIAkJICogaXRzZWxmIGlzIGVuYWJsZWQvZGlzYWJsZWQuCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9wbV9pcnEuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2d0X3BtX2lycS5jCmluZGV4IDgxMWExMWVkMTgxYy4uZmU1MWY4OTRi
MDczIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9wbV9pcnEu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9wbV9pcnEuYwpAQCAtMTYs
MTAgKzE2LDEwIEBAIHN0YXRpYyB2b2lkIHdyaXRlX3BtX2ltcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0
KQogCXUzMiBtYXNrID0gZ3QtPnBtX2ltcjsKIAlpOTE1X3JlZ190IHJlZzsKIAotCWlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gMTEpIHsKKwlpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID49IDExKSB7CiAJ
CXJlZyA9IEdFTjExX0dQTV9XR0JPWFBFUkZfSU5UUl9NQVNLOwogCQltYXNrIDw8PSAxNjsgLyog
cG0gaXMgaW4gdXBwZXIgaGFsZiAqLwotCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDgp
IHsKKwl9IGVsc2UgaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA+PSA4KSB7CiAJCXJlZyA9IEdFTjhf
R1RfSU1SKDIpOwogCX0gZWxzZSB7CiAJCXJlZyA9IEdFTjZfUE1JTVI7CkBAIC02MSw3ICs2MSw3
IEBAIHZvaWQgZ2VuNl9ndF9wbV9tYXNrX2lycShzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1MzIgbWFz
aykKIHZvaWQgZ2VuNl9ndF9wbV9yZXNldF9paXIoc3RydWN0IGludGVsX2d0ICpndCwgdTMyIHJl
c2V0X21hc2spCiB7CiAJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gZ3QtPnVuY29yZTsK
LQlpOTE1X3JlZ190IHJlZyA9IElOVEVMX0dFTihndC0+aTkxNSkgPj0gOCA/IEdFTjhfR1RfSUlS
KDIpIDogR0VONl9QTUlJUjsKKwlpOTE1X3JlZ190IHJlZyA9IEdSQVBISUNTX1ZFUihndC0+aTkx
NSkgPj0gOCA/IEdFTjhfR1RfSUlSKDIpIDogR0VONl9QTUlJUjsKIAogCWxvY2tkZXBfYXNzZXJ0
X2hlbGQoJmd0LT5pcnFfbG9jayk7CiAKQEAgLTc3LDEwICs3NywxMCBAQCBzdGF0aWMgdm9pZCB3
cml0ZV9wbV9pZXIoc3RydWN0IGludGVsX2d0ICpndCkKIAl1MzIgbWFzayA9IGd0LT5wbV9pZXI7
CiAJaTkxNV9yZWdfdCByZWc7CiAKLQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKSB7CisJaWYg
KEdSQVBISUNTX1ZFUihpOTE1KSA+PSAxMSkgewogCQlyZWcgPSBHRU4xMV9HUE1fV0dCT1hQRVJG
X0lOVFJfRU5BQkxFOwogCQltYXNrIDw8PSAxNjsgLyogcG0gaXMgaW4gdXBwZXIgaGFsZiAqLwot
CX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDgpIHsKKwl9IGVsc2UgaWYgKEdSQVBISUNT
X1ZFUihpOTE1KSA+PSA4KSB7CiAJCXJlZyA9IEdFTjhfR1RfSUVSKDIpOwogCX0gZWxzZSB7CiAJ
CXJlZyA9IEdFTjZfUE1JRVI7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9ndHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0dC5jCmluZGV4IDk0
ODQ5NTY3MTQzZC4uMDg0ZWE2NWQ1OWMwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9ndHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndHQu
YwpAQCAtMzU2LDcgKzM1Niw3IEBAIHZvaWQgZ3R0X3dyaXRlX3dvcmthcm91bmRzKHN0cnVjdCBp
bnRlbF9ndCAqZ3QpCiAJCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsCiAJCQkJICAgR0VOOF9M
M19MUkFfMV9HUEdQVSwKIAkJCQkgICBHRU45X0wzX0xSQV8xX0dQR1BVX0RFRkFVTFRfVkFMVUVf
QlhUKTsKLQllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSAmJiBJTlRFTF9HRU4oaTkxNSkg
PD0gMTEpCisJZWxzZSBpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID49IDkgJiYgR1JBUEhJQ1NfVkVS
KGk5MTUpIDw9IDExKQogCQlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLAogCQkJCSAgIEdFTjhf
TDNfTFJBXzFfR1BHUFUsCiAJCQkJICAgR0VOOV9MM19MUkFfMV9HUEdQVV9ERUZBVUxUX1ZBTFVF
X1NLTCk7CkBAIC0zNzMsMTMgKzM3MywxMyBAQCB2b2lkIGd0dF93cml0ZV93b3JrYXJvdW5kcyhz
dHJ1Y3QgaW50ZWxfZ3QgKmd0KQogCSAqIGRyaXZlci4KIAkgKi8KIAlpZiAoSEFTX1BBR0VfU0la
RVMoaTkxNSwgSTkxNV9HVFRfUEFHRV9TSVpFXzY0SykgJiYKLQkgICAgSU5URUxfR0VOKGk5MTUp
IDw9IDEwKQorCSAgICBHUkFQSElDU19WRVIoaTkxNSkgPD0gMTApCiAJCWludGVsX3VuY29yZV9y
bXcodW5jb3JlLAogCQkJCSBHRU44X0dBTVdfRUNPX0RFVl9SV19JQSwKIAkJCQkgMCwKIAkJCQkg
R0FNV19FQ09fRU5BQkxFXzY0S19JUFNfRklFTEQpOwogCi0JaWYgKElTX0dFTl9SQU5HRShpOTE1
LCA4LCAxMSkpIHsKKwlpZiAoSVNfR1JBUEhJQ1NfVkVSKGk5MTUsIDgsIDExKSkgewogCQlib29s
IGNhbl91c2VfZ3R0X2NhY2hlID0gdHJ1ZTsKIAogCQkvKgpAQCAtNDYxLDcgKzQ2MSw3IEBAIHN0
YXRpYyB2b2lkIGJkd19zZXR1cF9wcml2YXRlX3BwYXQoc3RydWN0IGludGVsX3VuY29yZSAqdW5j
b3JlKQogCSAgICAgIEdFTjhfUFBBVCg3LCBHRU44X1BQQVRfV0IgfCBHRU44X1BQQVRfTExDRUxM
QyB8IEdFTjhfUFBBVF9BR0UoMykpOwogCiAJLyogZm9yIHNjYW5vdXQgd2l0aCBlTExDICovCi0J
aWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQorCWlmIChHUkFQSElDU19WRVIoaTkxNSkgPj0gOSkK
IAkJcGF0IHw9IEdFTjhfUFBBVCgyLCBHRU44X1BQQVRfV0IgfCBHRU44X1BQQVRfRUxMQ19PVkVS
UklERSk7CiAJZWxzZQogCQlwYXQgfD0gR0VOOF9QUEFUKDIsIEdFTjhfUFBBVF9XVCB8IEdFTjhf
UFBBVF9MTENFTExDKTsKQEAgLTUxMCwxMSArNTEwLDExIEBAIHZvaWQgc2V0dXBfcHJpdmF0ZV9w
YXQoc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdW5jb3JlLT5pOTE1OwogCi0JR0VNX0JVR19PTihJTlRFTF9HRU4oaTkxNSkg
PCA4KTsKKwlHRU1fQlVHX09OKEdSQVBISUNTX1ZFUihpOTE1KSA8IDgpOwogCi0JaWYgKElOVEVM
X0dFTihpOTE1KSA+PSAxMikKKwlpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID49IDEyKQogCQl0Z2xf
c2V0dXBfcHJpdmF0ZV9wcGF0KHVuY29yZSk7Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49
IDEwKQorCWVsc2UgaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA+PSAxMCkKIAkJY25sX3NldHVwX3By
aXZhdGVfcHBhdCh1bmNvcmUpOwogCWVsc2UgaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkgfHwgSVNf
R0VOOV9MUChpOTE1KSkKIAkJY2h2X3NldHVwX3ByaXZhdGVfcHBhdCh1bmNvcmUpOwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbGxjLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9sbGMuYwppbmRleCAwNzVkNzQxNjQ0YWUuLmViMWExNWRlZWQyMiAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbGxjLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbGxjLmMKQEAgLTY0LDcgKzY0LDcgQEAgc3RhdGlj
IGJvb2wgZ2V0X2lhX2NvbnN0YW50cyhzdHJ1Y3QgaW50ZWxfbGxjICpsbGMsCiAKIAljb25zdHMt
Pm1pbl9ncHVfZnJlcSA9IHJwcy0+bWluX2ZyZXE7CiAJY29uc3RzLT5tYXhfZ3B1X2ZyZXEgPSBy
cHMtPm1heF9mcmVxOwotCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkgeworCWlmIChHUkFQSElD
U19WRVIoaTkxNSkgPj0gOSkgewogCQkvKiBDb252ZXJ0IEdUIGZyZXF1ZW5jeSB0byA1MCBIWiB1
bml0cyAqLwogCQljb25zdHMtPm1pbl9ncHVfZnJlcSAvPSBHRU45X0ZSRVFfU0NBTEVSOwogCQlj
b25zdHMtPm1heF9ncHVfZnJlcSAvPSBHRU45X0ZSRVFfU0NBTEVSOwpAQCAtODMsMTMgKzgzLDEz
IEBAIHN0YXRpYyB2b2lkIGNhbGNfaWFfZnJlcShzdHJ1Y3QgaW50ZWxfbGxjICpsbGMsCiAJY29u
c3QgaW50IGRpZmYgPSBjb25zdHMtPm1heF9ncHVfZnJlcSAtIGdwdV9mcmVxOwogCXVuc2lnbmVk
IGludCBpYV9mcmVxID0gMCwgcmluZ19mcmVxID0gMDsKIAotCWlmIChJTlRFTF9HRU4oaTkxNSkg
Pj0gOSkgeworCWlmIChHUkFQSElDU19WRVIoaTkxNSkgPj0gOSkgewogCQkvKgogCQkgKiByaW5n
X2ZyZXEgPSAyICogR1QuIHJpbmdfZnJlcSBpcyBpbiAxMDBNSHogdW5pdHMKIAkJICogTm8gZmxv
b3IgcmVxdWlyZWQgZm9yIHJpbmcgZnJlcXVlbmN5IG9uIFNLTC4KIAkJICovCiAJCXJpbmdfZnJl
cSA9IGdwdV9mcmVxOwotCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDgpIHsKKwl9IGVs
c2UgaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA+PSA4KSB7CiAJCS8qIG1heCgyICogR1QsIEREUiku
IE5COiBHVCBpcyA1ME1IeiB1bml0cyAqLwogCQlyaW5nX2ZyZXEgPSBtYXgoY29uc3RzLT5taW5f
cmluZ19mcmVxLCBncHVfZnJlcSk7CiAJfSBlbHNlIGlmIChJU19IQVNXRUxMKGk5MTUpKSB7CmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCmluZGV4IGFhZmUyYTRkZjQ5Ni4uYTI3YmFjMGE0
YmZiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwpAQCAtNDcsNyArNDcsNyBAQCBz
dGF0aWMgdm9pZCBzZXRfb2Zmc2V0cyh1MzIgKnJlZ3MsCiAJCSpyZWdzID0gTUlfTE9BRF9SRUdJ
U1RFUl9JTU0oY291bnQpOwogCQlpZiAoZmxhZ3MgJiBQT1NURUQpCiAJCQkqcmVncyB8PSBNSV9M
UklfRk9SQ0VfUE9TVEVEOwotCQlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTEpCisJ
CWlmIChHUkFQSElDU19WRVIoZW5naW5lLT5pOTE1KSA+PSAxMSkKIAkJCSpyZWdzIHw9IE1JX0xS
SV9MUk1fQ1NfTU1JTzsKIAkJcmVncysrOwogCkBAIC03MCw3ICs3MCw3IEBAIHN0YXRpYyB2b2lk
IHNldF9vZmZzZXRzKHUzMiAqcmVncywKIAlpZiAoY2xvc2UpIHsKIAkJLyogQ2xvc2UgdGhlIGJh
dGNoOyB1c2VkIG1haW5seSBieSBsaXZlX2xyY19sYXlvdXQoKSAqLwogCQkqcmVncyA9IE1JX0JB
VENIX0JVRkZFUl9FTkQ7Ci0JCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMCkKKwkJ
aWYgKEdSQVBISUNTX1ZFUihlbmdpbmUtPmk5MTUpID49IDEwKQogCQkJKnJlZ3MgfD0gQklUKDAp
OwogCX0KIH0KQEAgLTQ5OCwyMiArNDk4LDIyIEBAIHN0YXRpYyBjb25zdCB1OCAqcmVnX29mZnNl
dHMoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCSAqIGFkZHJlc3Npbmcg
dG8gYXV0b21hdGljIGZpeHVwIHRoZSByZWdpc3RlciBzdGF0ZSBiZXR3ZWVuIHRoZQogCSAqIHBo
eXNpY2FsIGVuZ2luZXMgZm9yIHZpcnR1YWwgZW5naW5lLgogCSAqLwotCUdFTV9CVUdfT04oSU5U
RUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTIgJiYKKwlHRU1fQlVHX09OKEdSQVBISUNTX1ZFUihl
bmdpbmUtPmk5MTUpID49IDEyICYmCiAJCSAgICFpbnRlbF9lbmdpbmVfaGFzX3JlbGF0aXZlX21t
aW8oZW5naW5lKSk7CiAKIAlpZiAoZW5naW5lLT5jbGFzcyA9PSBSRU5ERVJfQ0xBU1MpIHsKLQkJ
aWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDEyKQorCQlpZiAoR1JBUEhJQ1NfVkVSKGVu
Z2luZS0+aTkxNSkgPj0gMTIpCiAJCQlyZXR1cm4gZ2VuMTJfcmNzX29mZnNldHM7Ci0JCWVsc2Ug
aWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDExKQorCQllbHNlIGlmIChHUkFQSElDU19W
RVIoZW5naW5lLT5pOTE1KSA+PSAxMSkKIAkJCXJldHVybiBnZW4xMV9yY3Nfb2Zmc2V0czsKLQkJ
ZWxzZSBpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gOSkKKwkJZWxzZSBpZiAoR1JBUEhJ
Q1NfVkVSKGVuZ2luZS0+aTkxNSkgPj0gOSkKIAkJCXJldHVybiBnZW45X3Jjc19vZmZzZXRzOwog
CQllbHNlCiAJCQlyZXR1cm4gZ2VuOF9yY3Nfb2Zmc2V0czsKIAl9IGVsc2UgewotCQlpZiAoSU5U
RUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTIpCisJCWlmIChHUkFQSElDU19WRVIoZW5naW5lLT5p
OTE1KSA+PSAxMikKIAkJCXJldHVybiBnZW4xMl94Y3Nfb2Zmc2V0czsKLQkJZWxzZSBpZiAoSU5U
RUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gOSkKKwkJZWxzZSBpZiAoR1JBUEhJQ1NfVkVSKGVuZ2lu
ZS0+aTkxNSkgPj0gOSkKIAkJCXJldHVybiBnZW45X3hjc19vZmZzZXRzOwogCQllbHNlCiAJCQly
ZXR1cm4gZ2VuOF94Y3Nfb2Zmc2V0czsKQEAgLTUyMiw5ICs1MjIsOSBAQCBzdGF0aWMgY29uc3Qg
dTggKnJlZ19vZmZzZXRzKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAog
c3RhdGljIGludCBscmNfcmluZ19taV9tb2RlKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSkKIHsKLQlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTIpCisJaWYgKEdS
QVBISUNTX1ZFUihlbmdpbmUtPmk5MTUpID49IDEyKQogCQlyZXR1cm4gMHg2MDsKLQllbHNlIGlm
IChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSA5KQorCWVsc2UgaWYgKEdSQVBISUNTX1ZFUihl
bmdpbmUtPmk5MTUpID49IDkpCiAJCXJldHVybiAweDU0OwogCWVsc2UgaWYgKGVuZ2luZS0+Y2xh
c3MgPT0gUkVOREVSX0NMQVNTKQogCQlyZXR1cm4gMHg1ODsKQEAgLTUzNCw5ICs1MzQsOSBAQCBz
dGF0aWMgaW50IGxyY19yaW5nX21pX21vZGUoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lKQogCiBzdGF0aWMgaW50IGxyY19yaW5nX2dwcjAoY29uc3Qgc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQogewotCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMikK
KwlpZiAoR1JBUEhJQ1NfVkVSKGVuZ2luZS0+aTkxNSkgPj0gMTIpCiAJCXJldHVybiAweDc0Owot
CWVsc2UgaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDkpCisJZWxzZSBpZiAoR1JBUEhJ
Q1NfVkVSKGVuZ2luZS0+aTkxNSkgPj0gOSkKIAkJcmV0dXJuIDB4Njg7CiAJZWxzZSBpZiAoZW5n
aW5lLT5jbGFzcyA9PSBSRU5ERVJfQ0xBU1MpCiAJCXJldHVybiAweGQ4OwpAQCAtNTQ2LDkgKzU0
Niw5IEBAIHN0YXRpYyBpbnQgbHJjX3JpbmdfZ3ByMChjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUpCiAKIHN0YXRpYyBpbnQgbHJjX3Jpbmdfd2FfYmJfcGVyX2N0eChjb25zdCBz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7Ci0JaWYgKElOVEVMX0dFTihlbmdpbmUt
Pmk5MTUpID49IDEyKQorCWlmIChHUkFQSElDU19WRVIoZW5naW5lLT5pOTE1KSA+PSAxMikKIAkJ
cmV0dXJuIDB4MTI7Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gOSB8fCBl
bmdpbmUtPmNsYXNzID09IFJFTkRFUl9DTEFTUykKKwllbHNlIGlmIChHUkFQSElDU19WRVIoZW5n
aW5lLT5pOTE1KSA+PSA5IHx8IGVuZ2luZS0+Y2xhc3MgPT0gUkVOREVSX0NMQVNTKQogCQlyZXR1
cm4gMHgxODsKIAllbHNlCiAJCXJldHVybiAtMTsKQEAgLTU4MSw5ICs1ODEsOSBAQCBzdGF0aWMg
aW50IGxyY19yaW5nX2NtZF9idWZfY2N0bChjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUpCiAJaWYgKGVuZ2luZS0+Y2xhc3MgIT0gUkVOREVSX0NMQVNTKQogCQlyZXR1cm4gLTE7
CiAKLQlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTIpCisJaWYgKEdSQVBISUNTX1ZF
UihlbmdpbmUtPmk5MTUpID49IDEyKQogCQlyZXR1cm4gMHhiNjsKLQllbHNlIGlmIChJTlRFTF9H
RU4oZW5naW5lLT5pOTE1KSA+PSAxMSkKKwllbHNlIGlmIChHUkFQSElDU19WRVIoZW5naW5lLT5p
OTE1KSA+PSAxMSkKIAkJcmV0dXJuIDB4YWE7CiAJZWxzZQogCQlyZXR1cm4gLTE7CkBAIC01OTIs
OSArNTkyLDkgQEAgc3RhdGljIGludCBscmNfcmluZ19jbWRfYnVmX2NjdGwoY29uc3Qgc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogc3RhdGljIHUzMgogbHJjX3JpbmdfaW5kaXJlY3Rf
b2Zmc2V0X2RlZmF1bHQoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewot
CXN3aXRjaCAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkpIHsKKwlzd2l0Y2ggKEdSQVBISUNTX1ZF
UihlbmdpbmUtPmk5MTUpKSB7CiAJZGVmYXVsdDoKLQkJTUlTU0lOR19DQVNFKElOVEVMX0dFTihl
bmdpbmUtPmk5MTUpKTsKKwkJTUlTU0lOR19DQVNFKEdSQVBISUNTX1ZFUihlbmdpbmUtPmk5MTUp
KTsKIAkJZmFsbHRocm91Z2g7CiAJY2FzZSAxMjoKIAkJcmV0dXJuIEdFTjEyX0NUWF9SQ1NfSU5E
SVJFQ1RfQ1RYX09GRlNFVF9ERUZBVUxUOwpAQCAtNjM3LDcgKzYzNyw3IEBAIHN0YXRpYyB2b2lk
IGluaXRfY29tbW9uX3JlZ3ModTMyICogY29uc3QgcmVncywKIAljdGwgfD0gX01BU0tFRF9CSVRf
RElTQUJMRShDVFhfQ1RSTF9FTkdJTkVfQ1RYX1JFU1RPUkVfSU5ISUJJVCk7CiAJaWYgKGluaGli
aXQpCiAJCWN0bCB8PSBDVFhfQ1RSTF9FTkdJTkVfQ1RYX1JFU1RPUkVfSU5ISUJJVDsKLQlpZiAo
SU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPCAxMSkKKwlpZiAoR1JBUEhJQ1NfVkVSKGVuZ2luZS0+
aTkxNSkgPCAxMSkKIAkJY3RsIHw9IF9NQVNLRURfQklUX0RJU0FCTEUoQ1RYX0NUUkxfRU5HSU5F
X0NUWF9TQVZFX0lOSElCSVQgfAogCQkJCQkgICBDVFhfQ1RSTF9SU19DVFhfRU5BQkxFKTsKIAly
ZWdzW0NUWF9DT05URVhUX0NPTlRST0xdID0gY3RsOwpAQCAtODA1LDcgKzgwNSw3IEBAIF9fbHJj
X2FsbG9jX3N0YXRlKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lKQogCWlmIChJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9ERUJVR19HRU0p
KQogCQljb250ZXh0X3NpemUgKz0gSTkxNV9HVFRfUEFHRV9TSVpFOyAvKiBmb3IgcmVkem9uZSAq
LwogCi0JaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID09IDEyKSB7CisJaWYgKEdSQVBISUNT
X1ZFUihlbmdpbmUtPmk5MTUpID09IDEyKSB7CiAJCWNlLT53YV9iYl9wYWdlID0gY29udGV4dF9z
aXplIC8gUEFHRV9TSVpFOwogCQljb250ZXh0X3NpemUgKz0gUEFHRV9TSVpFOwogCX0KQEAgLTEx
MTQsNyArMTExNCw3IEBAIHN0YXRpYyB1MzIgbHJjX2Rlc2NyaXB0b3IoY29uc3Qgc3RydWN0IGlu
dGVsX2NvbnRleHQgKmNlKQogCWRlc2MgPDw9IEdFTjhfQ1RYX0FERFJFU1NJTkdfTU9ERV9TSElG
VDsKIAogCWRlc2MgfD0gR0VOOF9DVFhfVkFMSUQgfCBHRU44X0NUWF9QUklWSUxFR0U7Ci0JaWYg
KElTX0dFTihjZS0+dm0tPmk5MTUsIDgpKQorCWlmIChHUkFQSElDU19WRVIoY2UtPnZtLT5pOTE1
KSA9PSA4KQogCQlkZXNjIHw9IEdFTjhfQ1RYX0wzTExDX0NPSEVSRU5UOwogCiAJcmV0dXJuIGk5
MTVfZ2d0dF9vZmZzZXQoY2UtPnN0YXRlKSB8IGRlc2M7CkBAIC0xNDY5LDcgKzE0NjksNyBAQCB2
b2lkIGxyY19pbml0X3dhX2N0eChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJaWYg
KGVuZ2luZS0+Y2xhc3MgIT0gUkVOREVSX0NMQVNTKQogCQlyZXR1cm47CiAKLQlzd2l0Y2ggKElO
VEVMX0dFTihlbmdpbmUtPmk5MTUpKSB7CisJc3dpdGNoIChHUkFQSElDU19WRVIoZW5naW5lLT5p
OTE1KSkgewogCWNhc2UgMTI6CiAJY2FzZSAxMToKIAkJcmV0dXJuOwpAQCAtMTQ4Niw3ICsxNDg2
LDcgQEAgdm9pZCBscmNfaW5pdF93YV9jdHgoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KQogCQl3YV9iYl9mblsxXSA9IE5VTEw7CiAJCWJyZWFrOwogCWRlZmF1bHQ6Ci0JCU1JU1NJTkdf
Q0FTRShJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSk7CisJCU1JU1NJTkdfQ0FTRShHUkFQSElDU19W
RVIoZW5naW5lLT5pOTE1KSk7CiAJCXJldHVybjsKIAl9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX21vY3MuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX21vY3MuYwppbmRleCBiMTQxMzhmZDUwNWMuLjE3ODQ4ODA3ZjExMSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbW9jcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX21vY3MuYwpAQCAtMzQ0LDExICszNDQsMTEgQEAgc3RhdGljIHVuc2ln
bmVkIGludCBnZXRfbW9jc19zZXR0aW5ncyhjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKIAkJdGFibGUtPnNpemUgPSBBUlJBWV9TSVpFKGRnMV9tb2NzX3RhYmxlKTsKIAkJdGFi
bGUtPnRhYmxlID0gZGcxX21vY3NfdGFibGU7CiAJCXRhYmxlLT5uX2VudHJpZXMgPSBHRU45X05V
TV9NT0NTX0VOVFJJRVM7Ci0JfSBlbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTIpIHsKKwl9
IGVsc2UgaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA+PSAxMikgewogCQl0YWJsZS0+c2l6ZSAgPSBB
UlJBWV9TSVpFKHRnbF9tb2NzX3RhYmxlKTsKIAkJdGFibGUtPnRhYmxlID0gdGdsX21vY3NfdGFi
bGU7CiAJCXRhYmxlLT5uX2VudHJpZXMgPSBHRU45X05VTV9NT0NTX0VOVFJJRVM7Ci0JfSBlbHNl
IGlmIChJU19HRU4oaTkxNSwgMTEpKSB7CisJfSBlbHNlIGlmIChHUkFQSElDU19WRVIoaTkxNSkg
PT0gMTEpIHsKIAkJdGFibGUtPnNpemUgID0gQVJSQVlfU0laRShpY2xfbW9jc190YWJsZSk7CiAJ
CXRhYmxlLT50YWJsZSA9IGljbF9tb2NzX3RhYmxlOwogCQl0YWJsZS0+bl9lbnRyaWVzID0gR0VO
OV9OVU1fTU9DU19FTlRSSUVTOwpAQCAtMzYxLDcgKzM2MSw3IEBAIHN0YXRpYyB1bnNpZ25lZCBp
bnQgZ2V0X21vY3Nfc2V0dGluZ3MoY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
CiAJCXRhYmxlLT5uX2VudHJpZXMgPSBHRU45X05VTV9NT0NTX0VOVFJJRVM7CiAJCXRhYmxlLT50
YWJsZSA9IGJyb3h0b25fbW9jc190YWJsZTsKIAl9IGVsc2UgewotCQlkcm1fV0FSTl9PTkNFKCZp
OTE1LT5kcm0sIElOVEVMX0dFTihpOTE1KSA+PSA5LAorCQlkcm1fV0FSTl9PTkNFKCZpOTE1LT5k
cm0sIEdSQVBISUNTX1ZFUihpOTE1KSA+PSA5LAogCQkJICAgICAgIlBsYXRmb3JtIHRoYXQgc2hv
dWxkIGhhdmUgYSBNT0NTIHRhYmxlIGRvZXMgbm90LlxuIik7CiAJCXJldHVybiAwOwogCX0KQEAg
LTM3MCw3ICszNzAsNyBAQCBzdGF0aWMgdW5zaWduZWQgaW50IGdldF9tb2NzX3NldHRpbmdzKGNv
bnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCQlyZXR1cm4gMDsKIAogCS8qIFdh
RGlzYWJsZVNraXBDYWNoaW5nOnNrbCxieHQsa2JsLGdsayAqLwotCWlmIChJU19HRU4oaTkxNSwg
OSkpIHsKKwlpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID09IDkpIHsKIAkJaW50IGk7CiAKIAkJZm9y
IChpID0gMDsgaSA8IHRhYmxlLT5zaXplOyBpKyspCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9wcGd0dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
cHBndHQuYwppbmRleCBhZWUzYTg5MjkyNDUuLjg4NjA2MGY3ZTZmYyAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcHBndHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9wcGd0dC5jCkBAIC0xNDYsOSArMTQ2LDkgQEAgaW50IGk5MTVfcHBndHRf
aW5pdF9odyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogCiAJZ3R0X3dyaXRlX3dvcmthcm91bmRzKGd0
KTsKIAotCWlmIChJU19HRU4oaTkxNSwgNikpCisJaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA9PSA2
KQogCQlnZW42X3BwZ3R0X2VuYWJsZShndCk7Ci0JZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDcpKQor
CWVsc2UgaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA9PSA3KQogCQlnZW43X3BwZ3R0X2VuYWJsZShn
dCk7CiAKIAlyZXR1cm4gMDsKQEAgLTE1Nyw3ICsxNTcsNyBAQCBpbnQgaTkxNV9wcGd0dF9pbml0
X2h3KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiBzdGF0aWMgc3RydWN0IGk5MTVfcHBndHQgKgogX19w
cGd0dF9jcmVhdGUoc3RydWN0IGludGVsX2d0ICpndCkKIHsKLQlpZiAoSU5URUxfR0VOKGd0LT5p
OTE1KSA8IDgpCisJaWYgKEdSQVBISUNTX1ZFUihndC0+aTkxNSkgPCA4KQogCQlyZXR1cm4gZ2Vu
Nl9wcGd0dF9jcmVhdGUoZ3QpOwogCWVsc2UKIAkJcmV0dXJuIGdlbjhfcHBndHRfY3JlYXRlKGd0
KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JjNi5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmM2LmMKaW5kZXggM2I3ZTYyZGViZTdlLi4yNTlk
N2ViNGUxNjUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JjNi5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JjNi5jCkBAIC0xMDksNyArMTA5
LDcgQEAgc3RhdGljIHZvaWQgZ2VuMTFfcmM2X2VuYWJsZShzdHJ1Y3QgaW50ZWxfcmM2ICpyYzYp
CiAJCUdFTjlfTUVESUFfUEdfRU5BQkxFIHwKIAkJR0VOMTFfTUVESUFfU0FNUExFUl9QR19FTkFC
TEU7CiAKLQlpZiAoSU5URUxfR0VOKGd0LT5pOTE1KSA+PSAxMikgeworCWlmIChHUkFQSElDU19W
RVIoZ3QtPmk5MTUpID49IDEyKSB7CiAJCWZvciAoaSA9IDA7IGkgPCBJOTE1X01BWF9WQ1M7IGkr
KykKIAkJCWlmIChIQVNfRU5HSU5FKGd0LCBfVkNTKGkpKSkKIAkJCQlwZ19lbmFibGUgfD0gKFZE
Tl9IQ1BfUE9XRVJHQVRFX0VOQUJMRShpKSB8CkBAIC0xMjYsNyArMTI2LDcgQEAgc3RhdGljIHZv
aWQgZ2VuOV9yYzZfZW5hYmxlKHN0cnVjdCBpbnRlbF9yYzYgKnJjNikKIAllbnVtIGludGVsX2Vu
Z2luZV9pZCBpZDsKIAogCS8qIDJiOiBQcm9ncmFtIFJDNiB0aHJlc2hvbGRzLiovCi0JaWYgKElO
VEVMX0dFTihyYzZfdG9faTkxNShyYzYpKSA+PSAxMCkgeworCWlmIChHUkFQSElDU19WRVIocmM2
X3RvX2k5MTUocmM2KSkgPj0gMTApIHsKIAkJc2V0KHVuY29yZSwgR0VONl9SQzZfV0FLRV9SQVRF
X0xJTUlULCA1NCA8PCAxNiB8IDg1KTsKIAkJc2V0KHVuY29yZSwgR0VOMTBfTUVESUFfV0FLRV9S
QVRFX0xJTUlULCAxNTApOwogCX0gZWxzZSBpZiAoSVNfU0tZTEFLRShyYzZfdG9faTkxNShyYzYp
KSkgewpAQCAtMjQ5LDkgKzI0OSw5IEBAIHN0YXRpYyB2b2lkIGdlbjZfcmM2X2VuYWJsZShzdHJ1
Y3QgaW50ZWxfcmM2ICpyYzYpCiAJcmM2dmlkcyA9IDA7CiAJcmV0ID0gc2FuZHlicmlkZ2VfcGNv
ZGVfcmVhZChpOTE1LCBHRU42X1BDT0RFX1JFQURfUkM2VklEUywKIAkJCQkgICAgICZyYzZ2aWRz
LCBOVUxMKTsKLQlpZiAoSVNfR0VOKGk5MTUsIDYpICYmIHJldCkgeworCWlmIChHUkFQSElDU19W
RVIoaTkxNSkgPT0gNiAmJiByZXQpIHsKIAkJZHJtX2RiZygmaTkxNS0+ZHJtLCAiQ291bGRuJ3Qg
Y2hlY2sgZm9yIEJJT1Mgd29ya2Fyb3VuZFxuIik7Ci0JfSBlbHNlIGlmIChJU19HRU4oaTkxNSwg
NikgJiYKKwl9IGVsc2UgaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA9PSA2ICYmCiAJCSAgIChHRU42
X0RFQ09ERV9SQzZfVklEKHJjNnZpZHMgJiAweGZmKSA8IDQ1MCkpIHsKIAkJZHJtX2RiZygmaTkx
NS0+ZHJtLAogCQkJIllvdSBzaG91bGQgdXBkYXRlIHlvdXIgQklPUy4gQ29ycmVjdGluZyBtaW5p
bXVtIHJjNiB2b2x0YWdlICglZG1WLT4lZG1WKVxuIiwKQEAgLTUxNSw3ICs1MTUsNyBAQCBzdGF0
aWMgdm9pZCBfX2ludGVsX3JjNl9kaXNhYmxlKHN0cnVjdCBpbnRlbF9yYzYgKnJjNikKIAlzdHJ1
Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSByYzZfdG9fdW5jb3JlKHJjNik7CiAKIAlpbnRlbF91
bmNvcmVfZm9yY2V3YWtlX2dldCh1bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotCWlmIChJTlRFTF9H
RU4oaTkxNSkgPj0gOSkKKwlpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID49IDkpCiAJCXNldCh1bmNv
cmUsIEdFTjlfUEdfRU5BQkxFLCAwKTsKIAlzZXQodW5jb3JlLCBHRU42X1JDX0NPTlRST0wsIDAp
OwogCXNldCh1bmNvcmUsIEdFTjZfUkNfU1RBVEUsIDApOwpAQCAtNTc1LDEzICs1NzUsMTMgQEAg
dm9pZCBpbnRlbF9yYzZfZW5hYmxlKHN0cnVjdCBpbnRlbF9yYzYgKnJjNikKIAkJY2h2X3JjNl9l
bmFibGUocmM2KTsKIAllbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpKQogCQl2bHZfcmM2X2Vu
YWJsZShyYzYpOwotCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKKwllbHNlIGlmIChH
UkFQSElDU19WRVIoaTkxNSkgPj0gMTEpCiAJCWdlbjExX3JjNl9lbmFibGUocmM2KTsKLQllbHNl
IGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkKKwllbHNlIGlmIChHUkFQSElDU19WRVIoaTkxNSkg
Pj0gOSkKIAkJZ2VuOV9yYzZfZW5hYmxlKHJjNik7CiAJZWxzZSBpZiAoSVNfQlJPQURXRUxMKGk5
MTUpKQogCQlnZW44X3JjNl9lbmFibGUocmM2KTsKLQllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkg
Pj0gNikKKwllbHNlIGlmIChHUkFQSElDU19WRVIoaTkxNSkgPj0gNikKIAkJZ2VuNl9yYzZfZW5h
YmxlKHJjNik7CiAKIAlyYzYtPm1hbnVhbCA9IHJjNi0+Y3RsX2VuYWJsZSAmIEdFTjZfUkNfQ1RM
X1JDNl9FTkFCTEU7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9y
ZW5kZXJzdGF0ZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVuZGVyc3RhdGUu
YwppbmRleCBiMDNlMTk3YjFkOTkuLmI1NzVjZDZlMGI3YSAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVuZGVyc3RhdGUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9yZW5kZXJzdGF0ZS5jCkBAIC0xNSw3ICsxNSw3IEBAIHJlbmRlcl9zdGF0
ZV9nZXRfcm9kYXRhKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAlpZiAo
ZW5naW5lLT5jbGFzcyAhPSBSRU5ERVJfQ0xBU1MpCiAJCXJldHVybiBOVUxMOwogCi0Jc3dpdGNo
IChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSkgeworCXN3aXRjaCAoR1JBUEhJQ1NfVkVSKGVuZ2lu
ZS0+aTkxNSkpIHsKIAljYXNlIDY6CiAJCXJldHVybiAmZ2VuNl9udWxsX3N0YXRlOwogCWNhc2Ug
NzoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jCmluZGV4IDgwOTE4NDZkOTU1Yi4u
NzIyNTE2MzhkNGVhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9y
ZXNldC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMKQEAgLTQy
MSw3ICs0MjEsNyBAQCBzdGF0aWMgaW50IGdlbjExX2xvY2tfc2ZjKHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSwKIAkJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqcGFpcmVkX3ZlY3M7CiAK
IAkJaWYgKGVuZ2luZS0+Y2xhc3MgIT0gVklERU9fREVDT0RFX0NMQVNTIHx8Ci0JCSAgICAhSVNf
R0VOKGVuZ2luZS0+aTkxNSwgMTIpKQorCQkgICAgR1JBUEhJQ1NfVkVSKGVuZ2luZS0+aTkxNSkg
IT0gMTIpCiAJCQlyZXR1cm4gMDsKIAogCQkvKgpAQCAtNjMzLDcgKzYzMyw3IEBAIHN0YXRpYyBp
bnQgZ2VuOF9yZXNldF9lbmdpbmVzKHN0cnVjdCBpbnRlbF9ndCAqZ3QsCiAJCSAqLwogCX0KIAot
CWlmIChJTlRFTF9HRU4oZ3QtPmk5MTUpID49IDExKQorCWlmIChHUkFQSElDU19WRVIoZ3QtPmk5
MTUpID49IDExKQogCQlyZXQgPSBnZW4xMV9yZXNldF9lbmdpbmVzKGd0LCBlbmdpbmVfbWFzaywg
cmV0cnkpOwogCWVsc2UKIAkJcmV0ID0gZ2VuNl9yZXNldF9lbmdpbmVzKGd0LCBlbmdpbmVfbWFz
aywgcmV0cnkpOwpAQCAtNjYyLDE3ICs2NjIsMTcgQEAgc3RhdGljIHJlc2V0X2Z1bmMgaW50ZWxf
Z2V0X2dwdV9yZXNldChjb25zdCBzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogCiAJaWYgKGlzX21vY2tf
Z3QoZ3QpKQogCQlyZXR1cm4gbW9ja19yZXNldDsKLQllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkg
Pj0gOCkKKwllbHNlIGlmIChHUkFQSElDU19WRVIoaTkxNSkgPj0gOCkKIAkJcmV0dXJuIGdlbjhf
cmVzZXRfZW5naW5lczsKLQllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNikKKwllbHNlIGlm
IChHUkFQSElDU19WRVIoaTkxNSkgPj0gNikKIAkJcmV0dXJuIGdlbjZfcmVzZXRfZW5naW5lczsK
LQllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNSkKKwllbHNlIGlmIChHUkFQSElDU19WRVIo
aTkxNSkgPj0gNSkKIAkJcmV0dXJuIGlsa19kb19yZXNldDsKIAllbHNlIGlmIChJU19HNFgoaTkx
NSkpCiAJCXJldHVybiBnNHhfZG9fcmVzZXQ7CiAJZWxzZSBpZiAoSVNfRzMzKGk5MTUpIHx8IElT
X1BJTkVWSUVXKGk5MTUpKQogCQlyZXR1cm4gZzMzX2RvX3Jlc2V0OwotCWVsc2UgaWYgKElOVEVM
X0dFTihpOTE1KSA+PSAzKQorCWVsc2UgaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA+PSAzKQogCQly
ZXR1cm4gaTkxNV9kb19yZXNldDsKIAllbHNlCiAJCXJldHVybiBOVUxMOwpAQCAtNzI0LDcgKzcy
NCw3IEBAIGJvb2wgaW50ZWxfaGFzX3Jlc2V0X2VuZ2luZShjb25zdCBzdHJ1Y3QgaW50ZWxfZ3Qg
Kmd0KQogaW50IGludGVsX3Jlc2V0X2d1YyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewogCXUzMiBn
dWNfZG9tYWluID0KLQkJSU5URUxfR0VOKGd0LT5pOTE1KSA+PSAxMSA/IEdFTjExX0dSRE9NX0dV
QyA6IEdFTjlfR1JET01fR1VDOworCQlHUkFQSElDU19WRVIoZ3QtPmk5MTUpID49IDExID8gR0VO
MTFfR1JET01fR1VDIDogR0VOOV9HUkRPTV9HVUM7CiAJaW50IHJldDsKIAogCUdFTV9CVUdfT04o
IUhBU19HVF9VQyhndC0+aTkxNSkpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfcmluZ19zdWJtaXNzaW9uLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9yaW5nX3N1Ym1pc3Npb24uYwppbmRleCAyYjZkZmZjYzIyNjIuLjBjNDIzZjA5NmUyYiAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ19zdWJtaXNzaW9uLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ19zdWJtaXNzaW9uLmMKQEAg
LTI5LDcgKzI5LDcgQEAgc3RhdGljIHZvaWQgc2V0X2h3c3RhbShzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUsIHUzMiBtYXNrKQogCSAqIGxvc3QgaW50ZXJydXB0cyBmb2xsb3dpbmcgYSBy
ZXNldC4KIAkgKi8KIAlpZiAoZW5naW5lLT5jbGFzcyA9PSBSRU5ERVJfQ0xBU1MpIHsKLQkJaWYg
KElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDYpCisJCWlmIChHUkFQSElDU19WRVIoZW5naW5l
LT5pOTE1KSA+PSA2KQogCQkJbWFzayAmPSB+QklUKDApOwogCQllbHNlCiAJCQltYXNrICY9IH5J
OTE1X1VTRVJfSU5URVJSVVBUOwpAQCAtNDMsNyArNDMsNyBAQCBzdGF0aWMgdm9pZCBzZXRfaHdz
X3BnYShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHBoeXNfYWRkcl90IHBoeXMpCiAJ
dTMyIGFkZHI7CiAKIAlhZGRyID0gbG93ZXJfMzJfYml0cyhwaHlzKTsKLQlpZiAoSU5URUxfR0VO
KGVuZ2luZS0+aTkxNSkgPj0gNCkKKwlpZiAoR1JBUEhJQ1NfVkVSKGVuZ2luZS0+aTkxNSkgPj0g
NCkKIAkJYWRkciB8PSAocGh5cyA+PiAyOCkgJiAweGYwOwogCiAJaW50ZWxfdW5jb3JlX3dyaXRl
KGVuZ2luZS0+dW5jb3JlLCBIV1NfUEdBLCBhZGRyKTsKQEAgLTcxLDcgKzcxLDcgQEAgc3RhdGlj
IHZvaWQgc2V0X2h3c3Aoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1MzIgb2Zmc2V0
KQogCSAqIFRoZSByaW5nIHN0YXR1cyBwYWdlIGFkZHJlc3NlcyBhcmUgbm8gbG9uZ2VyIG5leHQg
dG8gdGhlIHJlc3Qgb2YKIAkgKiB0aGUgcmluZyByZWdpc3RlcnMgYXMgb2YgZ2VuNy4KIAkgKi8K
LQlpZiAoSVNfR0VOKGVuZ2luZS0+aTkxNSwgNykpIHsKKwlpZiAoR1JBUEhJQ1NfVkVSKGVuZ2lu
ZS0+aTkxNSkgPT0gNykgewogCQlzd2l0Y2ggKGVuZ2luZS0+aWQpIHsKIAkJLyoKIAkJICogTm8g
bW9yZSByaW5ncyBleGlzdCBvbiBHZW43LiBEZWZhdWx0IGNhc2UgaXMgb25seSB0byBzaHV0IHVw
CkBAIC05Myw3ICs5Myw3IEBAIHN0YXRpYyB2b2lkIHNldF9od3NwKHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSwgdTMyIG9mZnNldCkKIAkJCWh3c3AgPSBWRUJPWF9IV1NfUEdBX0dFTjc7
CiAJCQlicmVhazsKIAkJfQotCX0gZWxzZSBpZiAoSVNfR0VOKGVuZ2luZS0+aTkxNSwgNikpIHsK
Kwl9IGVsc2UgaWYgKEdSQVBISUNTX1ZFUihlbmdpbmUtPmk5MTUpID09IDYpIHsKIAkJaHdzcCA9
IFJJTkdfSFdTX1BHQV9HRU42KGVuZ2luZS0+bW1pb19iYXNlKTsKIAl9IGVsc2UgewogCQlod3Nw
ID0gUklOR19IV1NfUEdBKGVuZ2luZS0+bW1pb19iYXNlKTsKQEAgLTEwNSw3ICsxMDUsNyBAQCBz
dGF0aWMgdm9pZCBzZXRfaHdzcChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHUzMiBv
ZmZzZXQpCiAKIHN0YXRpYyB2b2lkIGZsdXNoX2NzX3RsYihzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmUpCiB7Ci0JaWYgKCFJU19HRU5fUkFOR0UoZW5naW5lLT5pOTE1LCA2LCA3KSkKKwlp
ZiAoIUlTX0dSQVBISUNTX1ZFUihlbmdpbmUtPmk5MTUsIDYsIDcpKQogCQlyZXR1cm47CiAKIAkv
KiByaW5nIHNob3VsZCBiZSBpZGxlIGJlZm9yZSBpc3N1aW5nIGEgc3luYyBmbHVzaCovCkBAIC0x
NTMsNyArMTUzLDcgQEAgc3RhdGljIHZvaWQgc2V0X3BwX2RpcihzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUpCiAJRU5HSU5FX1dSSVRFX0ZXKGVuZ2luZSwgUklOR19QUF9ESVJfRENMViwg
UFBfRElSX0RDTFZfMkcpOwogCUVOR0lORV9XUklURV9GVyhlbmdpbmUsIFJJTkdfUFBfRElSX0JB
U0UsIHBwX2Rpcih2bSkpOwogCi0JaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDcpIHsK
KwlpZiAoR1JBUEhJQ1NfVkVSKGVuZ2luZS0+aTkxNSkgPj0gNykgewogCQlFTkdJTkVfV1JJVEVf
RlcoZW5naW5lLAogCQkJCVJJTkdfTU9ERV9HRU43LAogCQkJCV9NQVNLRURfQklUX0VOQUJMRShH
RlhfUFBHVFRfRU5BQkxFKSk7CkBAIC0yMjksNyArMjI5LDcgQEAgc3RhdGljIGludCB4Y3NfcmVz
dW1lKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAkJCQkJIDUwMDAsIDAsIE5VTEwp
KQogCQlnb3RvIGVycjsKIAotCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+IDIpCisJaWYg
KEdSQVBISUNTX1ZFUihlbmdpbmUtPmk5MTUpID4gMikKIAkJRU5HSU5FX1dSSVRFX0ZXKGVuZ2lu
ZSwKIAkJCQlSSU5HX01JX01PREUsIF9NQVNLRURfQklUX0RJU0FCTEUoU1RPUF9SSU5HKSk7CiAK
QEAgLTY0Niw5ICs2NDYsOSBAQCBzdGF0aWMgaW50IG1pX3NldF9jb250ZXh0KHN0cnVjdCBpOTE1
X3JlcXVlc3QgKnJxLAogCXUzMiAqY3M7CiAKIAlsZW4gPSA0OwotCWlmIChJU19HRU4oaTkxNSwg
NykpCisJaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA9PSA3KQogCQlsZW4gKz0gMiArIChudW1fZW5n
aW5lcyA/IDQgKiBudW1fZW5naW5lcyArIDYgOiAwKTsKLQllbHNlIGlmIChJU19HRU4oaTkxNSwg
NSkpCisJZWxzZSBpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID09IDUpCiAJCWxlbiArPSAyOwogCWlm
IChmbGFncyAmIE1JX0ZPUkNFX1JFU1RPUkUpIHsKIAkJR0VNX0JVR19PTihmbGFncyAmIE1JX1JF
U1RPUkVfSU5ISUJJVCk7CkBAIC02NjIsNyArNjYyLDcgQEAgc3RhdGljIGludCBtaV9zZXRfY29u
dGV4dChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKIAkJcmV0dXJuIFBUUl9FUlIoY3MpOwogCiAJ
LyogV2FQcm9ncmFtTWlBcmJPbk9mZkFyb3VuZE1pU2V0Q29udGV4dDppdmIsdmx2LGhzdyxiZHcs
Y2h2ICovCi0JaWYgKElTX0dFTihpOTE1LCA3KSkgeworCWlmIChHUkFQSElDU19WRVIoaTkxNSkg
PT0gNykgewogCQkqY3MrKyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJfRElTQUJMRTsKIAkJaWYg
KG51bV9lbmdpbmVzKSB7CiAJCQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpzaWduYWxsZXI7CkBA
IC02NzgsNyArNjc4LDcgQEAgc3RhdGljIGludCBtaV9zZXRfY29udGV4dChzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICpycSwKIAkJCQkJCUdFTjZfUFNNSV9TTEVFUF9NU0dfRElTQUJMRSk7CiAJCQl9CiAJ
CX0KLQl9IGVsc2UgaWYgKElTX0dFTihpOTE1LCA1KSkgeworCX0gZWxzZSBpZiAoR1JBUEhJQ1Nf
VkVSKGk5MTUpID09IDUpIHsKIAkJLyoKIAkJICogVGhpcyB3L2EgaXMgb25seSBsaXN0ZWQgZm9y
IHByZS1wcm9kdWN0aW9uIGlsayBhL2Igc3RlcHBpbmdzLAogCQkgKiBidXQgaXMgYWxzbyBtZW50
aW9uZWQgZm9yIHByb2dyYW1taW5nIHRoZSBwb3dlcmN0eC4gVG8gYmUKQEAgLTcxNiw3ICs3MTYs
NyBAQCBzdGF0aWMgaW50IG1pX3NldF9jb250ZXh0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAog
CSAqLwogCSpjcysrID0gTUlfTk9PUDsKIAotCWlmIChJU19HRU4oaTkxNSwgNykpIHsKKwlpZiAo
R1JBUEhJQ1NfVkVSKGk5MTUpID09IDcpIHsKIAkJaWYgKG51bV9lbmdpbmVzKSB7CiAJCQlzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICpzaWduYWxsZXI7CiAJCQlpOTE1X3JlZ190IGxhc3RfcmVnID0g
e307IC8qIGtlZXAgZ2NjIHF1aWV0ICovCkBAIC03NDAsNyArNzQwLDcgQEAgc3RhdGljIGludCBt
aV9zZXRfY29udGV4dChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKIAkJCSpjcysrID0gTUlfTk9P
UDsKIAkJfQogCQkqY3MrKyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJfRU5BQkxFOwotCX0gZWxz
ZSBpZiAoSVNfR0VOKGk5MTUsIDUpKSB7CisJfSBlbHNlIGlmIChHUkFQSElDU19WRVIoaTkxNSkg
PT0gNSkgewogCQkqY3MrKyA9IE1JX1NVU1BFTkRfRkxVU0g7CiAJfQogCkBAIC0xMDAxLDcgKzEw
MDEsNyBAQCBzdGF0aWMgdm9pZCByaW5nX3JlbGVhc2Uoc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGVuZ2luZS0+
aTkxNTsKIAotCWRybV9XQVJOX09OKCZkZXZfcHJpdi0+ZHJtLCBJTlRFTF9HRU4oZGV2X3ByaXYp
ID4gMiAmJgorCWRybV9XQVJOX09OKCZkZXZfcHJpdi0+ZHJtLCBHUkFQSElDU19WRVIoZGV2X3By
aXYpID4gMiAmJgogCQkgICAgKEVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19NSV9NT0RFKSAmIE1P
REVfSURMRSkgPT0gMCk7CiAKIAlpbnRlbF9lbmdpbmVfY2xlYW51cF9jb21tb24oZW5naW5lKTsK
QEAgLTEwMjksMTMgKzEwMjksMTMgQEAgc3RhdGljIHZvaWQgc2V0dXBfaXJxKHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSkKIAogCWludGVsX2VuZ2luZV9zZXRfaXJxX2hhbmRsZXIoZW5n
aW5lLCBpcnFfaGFuZGxlcik7CiAKLQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDYpIHsKKwlpZiAo
R1JBUEhJQ1NfVkVSKGk5MTUpID49IDYpIHsKIAkJZW5naW5lLT5pcnFfZW5hYmxlID0gZ2VuNl9p
cnFfZW5hYmxlOwogCQllbmdpbmUtPmlycV9kaXNhYmxlID0gZ2VuNl9pcnFfZGlzYWJsZTsKLQl9
IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA1KSB7CisJfSBlbHNlIGlmIChHUkFQSElDU19W
RVIoaTkxNSkgPj0gNSkgewogCQllbmdpbmUtPmlycV9lbmFibGUgPSBnZW41X2lycV9lbmFibGU7
CiAJCWVuZ2luZS0+aXJxX2Rpc2FibGUgPSBnZW41X2lycV9kaXNhYmxlOwotCX0gZWxzZSBpZiAo
SU5URUxfR0VOKGk5MTUpID49IDMpIHsKKwl9IGVsc2UgaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA+
PSAzKSB7CiAJCWVuZ2luZS0+aXJxX2VuYWJsZSA9IGdlbjNfaXJxX2VuYWJsZTsKIAkJZW5naW5l
LT5pcnFfZGlzYWJsZSA9IGdlbjNfaXJxX2Rpc2FibGU7CiAJfSBlbHNlIHsKQEAgLTEwNDksNyAr
MTA0OSw3IEBAIHN0YXRpYyB2b2lkIHNldHVwX2NvbW1vbihzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmUpCiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBlbmdpbmUtPmk5MTU7
CiAKIAkvKiBnZW44KyBhcmUgb25seSBzdXBwb3J0ZWQgd2l0aCBleGVjbGlzdHMgKi8KLQlHRU1f
QlVHX09OKElOVEVMX0dFTihpOTE1KSA+PSA4KTsKKwlHRU1fQlVHX09OKEdSQVBISUNTX1ZFUihp
OTE1KSA+PSA4KTsKIAogCXNldHVwX2lycShlbmdpbmUpOwogCkBAIC0xMDcwLDE0ICsxMDcwLDE0
IEBAIHN0YXRpYyB2b2lkIHNldHVwX2NvbW1vbihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpCiAJICogZW5naW5lLT5lbWl0X2luaXRfYnJlYWRjcnVtYigpLgogCSAqLwogCWVuZ2luZS0+
ZW1pdF9maW5pX2JyZWFkY3J1bWIgPSBnZW4zX2VtaXRfYnJlYWRjcnVtYjsKLQlpZiAoSVNfR0VO
KGk5MTUsIDUpKQorCWlmIChHUkFQSElDU19WRVIoaTkxNSkgPT0gNSkKIAkJZW5naW5lLT5lbWl0
X2ZpbmlfYnJlYWRjcnVtYiA9IGdlbjVfZW1pdF9icmVhZGNydW1iOwogCiAJZW5naW5lLT5zZXRf
ZGVmYXVsdF9zdWJtaXNzaW9uID0gaTl4eF9zZXRfZGVmYXVsdF9zdWJtaXNzaW9uOwogCi0JaWYg
KElOVEVMX0dFTihpOTE1KSA+PSA2KQorCWlmIChHUkFQSElDU19WRVIoaTkxNSkgPj0gNikKIAkJ
ZW5naW5lLT5lbWl0X2JiX3N0YXJ0ID0gZ2VuNl9lbWl0X2JiX3N0YXJ0OwotCWVsc2UgaWYgKElO
VEVMX0dFTihpOTE1KSA+PSA0KQorCWVsc2UgaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA+PSA0KQog
CQllbmdpbmUtPmVtaXRfYmJfc3RhcnQgPSBnZW40X2VtaXRfYmJfc3RhcnQ7CiAJZWxzZSBpZiAo
SVNfSTgzMChpOTE1KSB8fCBJU19JODQ1RyhpOTE1KSkKIAkJZW5naW5lLT5lbWl0X2JiX3N0YXJ0
ID0gaTgzMF9lbWl0X2JiX3N0YXJ0OwpAQCAtMTA5NCwxNiArMTA5NCwxNiBAQCBzdGF0aWMgdm9p
ZCBzZXR1cF9yY3Moc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCiAJZW5naW5lLT5p
cnFfZW5hYmxlX21hc2sgPSBHVF9SRU5ERVJfVVNFUl9JTlRFUlJVUFQ7CiAKLQlpZiAoSU5URUxf
R0VOKGk5MTUpID49IDcpIHsKKwlpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID49IDcpIHsKIAkJZW5n
aW5lLT5lbWl0X2ZsdXNoID0gZ2VuN19lbWl0X2ZsdXNoX3JjczsKIAkJZW5naW5lLT5lbWl0X2Zp
bmlfYnJlYWRjcnVtYiA9IGdlbjdfZW1pdF9icmVhZGNydW1iX3JjczsKLQl9IGVsc2UgaWYgKElT
X0dFTihpOTE1LCA2KSkgeworCX0gZWxzZSBpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID09IDYpIHsK
IAkJZW5naW5lLT5lbWl0X2ZsdXNoID0gZ2VuNl9lbWl0X2ZsdXNoX3JjczsKIAkJZW5naW5lLT5l
bWl0X2ZpbmlfYnJlYWRjcnVtYiA9IGdlbjZfZW1pdF9icmVhZGNydW1iX3JjczsKLQl9IGVsc2Ug
aWYgKElTX0dFTihpOTE1LCA1KSkgeworCX0gZWxzZSBpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID09
IDUpIHsKIAkJZW5naW5lLT5lbWl0X2ZsdXNoID0gZ2VuNF9lbWl0X2ZsdXNoX3JjczsKIAl9IGVs
c2UgewotCQlpZiAoSU5URUxfR0VOKGk5MTUpIDwgNCkKKwkJaWYgKEdSQVBISUNTX1ZFUihpOTE1
KSA8IDQpCiAJCQllbmdpbmUtPmVtaXRfZmx1c2ggPSBnZW4yX2VtaXRfZmx1c2g7CiAJCWVsc2UK
IAkJCWVuZ2luZS0+ZW1pdF9mbHVzaCA9IGdlbjRfZW1pdF9mbHVzaF9yY3M7CkBAIC0xMTE4LDIw
ICsxMTE4LDIwIEBAIHN0YXRpYyB2b2lkIHNldHVwX3ZjcyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmUpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBlbmdpbmUtPmk5
MTU7CiAKLQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDYpIHsKKwlpZiAoR1JBUEhJQ1NfVkVSKGk5
MTUpID49IDYpIHsKIAkJLyogZ2VuNiBic2QgbmVlZHMgYSBzcGVjaWFsIHdhIGZvciB0YWlsIHVw
ZGF0ZXMgKi8KLQkJaWYgKElTX0dFTihpOTE1LCA2KSkKKwkJaWYgKEdSQVBISUNTX1ZFUihpOTE1
KSA9PSA2KQogCQkJZW5naW5lLT5zZXRfZGVmYXVsdF9zdWJtaXNzaW9uID0gZ2VuNl9ic2Rfc2V0
X2RlZmF1bHRfc3VibWlzc2lvbjsKIAkJZW5naW5lLT5lbWl0X2ZsdXNoID0gZ2VuNl9lbWl0X2Zs
dXNoX3ZjczsKIAkJZW5naW5lLT5pcnFfZW5hYmxlX21hc2sgPSBHVF9CU0RfVVNFUl9JTlRFUlJV
UFQ7CiAKLQkJaWYgKElTX0dFTihpOTE1LCA2KSkKKwkJaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA9
PSA2KQogCQkJZW5naW5lLT5lbWl0X2ZpbmlfYnJlYWRjcnVtYiA9IGdlbjZfZW1pdF9icmVhZGNy
dW1iX3hjczsKIAkJZWxzZQogCQkJZW5naW5lLT5lbWl0X2ZpbmlfYnJlYWRjcnVtYiA9IGdlbjdf
ZW1pdF9icmVhZGNydW1iX3hjczsKIAl9IGVsc2UgewogCQllbmdpbmUtPmVtaXRfZmx1c2ggPSBn
ZW40X2VtaXRfZmx1c2hfdmNzOwotCQlpZiAoSVNfR0VOKGk5MTUsIDUpKQorCQlpZiAoR1JBUEhJ
Q1NfVkVSKGk5MTUpID09IDUpCiAJCQllbmdpbmUtPmlycV9lbmFibGVfbWFzayA9IElMS19CU0Rf
VVNFUl9JTlRFUlJVUFQ7CiAJCWVsc2UKIAkJCWVuZ2luZS0+aXJxX2VuYWJsZV9tYXNrID0gSTkx
NV9CU0RfVVNFUl9JTlRFUlJVUFQ7CkBAIC0xMTQ1LDcgKzExNDUsNyBAQCBzdGF0aWMgdm9pZCBz
ZXR1cF9iY3Moc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCWVuZ2luZS0+ZW1pdF9m
bHVzaCA9IGdlbjZfZW1pdF9mbHVzaF94Y3M7CiAJZW5naW5lLT5pcnFfZW5hYmxlX21hc2sgPSBH
VF9CTFRfVVNFUl9JTlRFUlJVUFQ7CiAKLQlpZiAoSVNfR0VOKGk5MTUsIDYpKQorCWlmIChHUkFQ
SElDU19WRVIoaTkxNSkgPT0gNikKIAkJZW5naW5lLT5lbWl0X2ZpbmlfYnJlYWRjcnVtYiA9IGdl
bjZfZW1pdF9icmVhZGNydW1iX3hjczsKIAllbHNlCiAJCWVuZ2luZS0+ZW1pdF9maW5pX2JyZWFk
Y3J1bWIgPSBnZW43X2VtaXRfYnJlYWRjcnVtYl94Y3M7CkBAIC0xMTU1LDcgKzExNTUsNyBAQCBz
dGF0aWMgdm9pZCBzZXR1cF92ZWNzKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsK
IAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGVuZ2luZS0+aTkxNTsKIAotCUdFTV9C
VUdfT04oSU5URUxfR0VOKGk5MTUpIDwgNyk7CisJR0VNX0JVR19PTihHUkFQSElDU19WRVIoaTkx
NSkgPCA3KTsKIAogCWVuZ2luZS0+ZW1pdF9mbHVzaCA9IGdlbjZfZW1pdF9mbHVzaF94Y3M7CiAJ
ZW5naW5lLT5pcnFfZW5hYmxlX21hc2sgPSBQTV9WRUJPWF9VU0VSX0lOVEVSUlVQVDsKQEAgLTEy
MDMsNyArMTIwMyw3IEBAIHN0YXRpYyBzdHJ1Y3QgaTkxNV92bWEgKmdlbjdfY3R4X3ZtYShzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJc3RydWN0IGk5MTVfdm1hICp2bWE7CiAJaW50
IHNpemUsIGVycjsKIAotCWlmICghSVNfR0VOKGVuZ2luZS0+aTkxNSwgNykgfHwgZW5naW5lLT5j
bGFzcyAhPSBSRU5ERVJfQ0xBU1MpCisJaWYgKEdSQVBISUNTX1ZFUihlbmdpbmUtPmk5MTUpICE9
IDcgfHwgZW5naW5lLT5jbGFzcyAhPSBSRU5ERVJfQ0xBU1MpCiAJCXJldHVybiAwOwogCiAJZXJy
ID0gZ2VuN19jdHhfc3dpdGNoX2JiX3NldHVwKGVuZ2luZSwgTlVMTCAvKiBwcm9iZSBzaXplICov
KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jwcy5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcnBzLmMKaW5kZXggOTdjYWIxYjk5ODcxLi4wNmU5
YThlZDRlMDMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jwcy5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jwcy5jCkBAIC0xOTYsNyArMTk2
LDcgQEAgc3RhdGljIHZvaWQgcnBzX3Jlc2V0X2ludGVycnVwdHMoc3RydWN0IGludGVsX3JwcyAq
cnBzKQogCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBycHNfdG9fZ3QocnBzKTsKIAogCXNwaW5fbG9j
a19pcnEoJmd0LT5pcnFfbG9jayk7Ci0JaWYgKElOVEVMX0dFTihndC0+aTkxNSkgPj0gMTEpCisJ
aWYgKEdSQVBISUNTX1ZFUihndC0+aTkxNSkgPj0gMTEpCiAJCWdlbjExX3Jwc19yZXNldF9pbnRl
cnJ1cHRzKHJwcyk7CiAJZWxzZQogCQlnZW42X3Jwc19yZXNldF9pbnRlcnJ1cHRzKHJwcyk7CkBA
IC02MzAsNyArNjMwLDcgQEAgc3RhdGljIHUzMiBycHNfbGltaXRzKHN0cnVjdCBpbnRlbF9ycHMg
KnJwcywgdTggdmFsKQogCSAqIGZyZXF1ZW5jeSwgaWYgdGhlIGRvd24gdGhyZXNob2xkIGV4cGly
ZXMgaW4gdGhhdCB3aW5kb3cgd2Ugd2lsbCBub3QKIAkgKiByZWNlaXZlIGEgZG93biBpbnRlcnJ1
cHQuCiAJICovCi0JaWYgKElOVEVMX0dFTihycHNfdG9faTkxNShycHMpKSA+PSA5KSB7CisJaWYg
KEdSQVBISUNTX1ZFUihycHNfdG9faTkxNShycHMpKSA+PSA5KSB7CiAJCWxpbWl0cyA9IHJwcy0+
bWF4X2ZyZXFfc29mdGxpbWl0IDw8IDIzOwogCQlpZiAodmFsIDw9IHJwcy0+bWluX2ZyZXFfc29m
dGxpbWl0KQogCQkJbGltaXRzIHw9IHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0IDw8IDE0OwpAQCAt
Njk3LDcgKzY5Nyw3IEBAIHN0YXRpYyB2b2lkIHJwc19zZXRfcG93ZXIoc3RydWN0IGludGVsX3Jw
cyAqcnBzLCBpbnQgbmV3X3Bvd2VyKQogCSAgICBpbnRlbF9ndF9uc190b19wbV9pbnRlcnZhbChn
dCwgZWlfZG93biAqIHRocmVzaG9sZF9kb3duICogMTApKTsKIAogCXNldCh1bmNvcmUsIEdFTjZf
UlBfQ09OVFJPTCwKLQkgICAgKElOVEVMX0dFTihndC0+aTkxNSkgPiA5ID8gMCA6IEdFTjZfUlBf
TUVESUFfVFVSQk8pIHwKKwkgICAgKEdSQVBISUNTX1ZFUihndC0+aTkxNSkgPiA5ID8gMCA6IEdF
TjZfUlBfTUVESUFfVFVSQk8pIHwKIAkgICAgR0VONl9SUF9NRURJQV9IV19OT1JNQUxfTU9ERSB8
CiAJICAgIEdFTjZfUlBfTUVESUFfSVNfR0ZYIHwKIAkgICAgR0VONl9SUF9FTkFCTEUgfApAQCAt
NzcxLDcgKzc3MSw3IEBAIHN0YXRpYyBpbnQgZ2VuNl9ycHNfc2V0KHN0cnVjdCBpbnRlbF9ycHMg
KnJwcywgdTggdmFsKQogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gcnBzX3RvX2k5
MTUocnBzKTsKIAl1MzIgc3dyZXE7CiAKLQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkpCisJaWYg
KEdSQVBISUNTX1ZFUihpOTE1KSA+PSA5KQogCQlzd3JlcSA9IEdFTjlfRlJFUVVFTkNZKHZhbCk7
CiAJZWxzZSBpZiAoSVNfSEFTV0VMTChpOTE1KSB8fCBJU19CUk9BRFdFTEwoaTkxNSkpCiAJCXN3
cmVxID0gSFNXX0ZSRVFVRU5DWSh2YWwpOwpAQCAtODEyLDE0ICs4MTIsMTQgQEAgc3RhdGljIGlu
dCBycHNfc2V0KHN0cnVjdCBpbnRlbF9ycHMgKnJwcywgdTggdmFsLCBib29sIHVwZGF0ZSkKIAog
CWlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpCiAJCWVyciA9
IHZsdl9ycHNfc2V0KHJwcywgdmFsKTsKLQllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNikK
KwllbHNlIGlmIChHUkFQSElDU19WRVIoaTkxNSkgPj0gNikKIAkJZXJyID0gZ2VuNl9ycHNfc2V0
KHJwcywgdmFsKTsKIAllbHNlCiAJCWVyciA9IGdlbjVfcnBzX3NldChycHMsIHZhbCk7CiAJaWYg
KGVycikKIAkJcmV0dXJuIGVycjsKIAotCWlmICh1cGRhdGUgJiYgSU5URUxfR0VOKGk5MTUpID49
IDYpCisJaWYgKHVwZGF0ZSAmJiBHUkFQSElDU19WRVIoaTkxNSkgPj0gNikKIAkJZ2VuNl9ycHNf
c2V0X3RocmVzaG9sZHMocnBzLCB2YWwpOwogCXJwcy0+bGFzdF9mcmVxID0gdmFsOwogCkBAIC04
NTMsNyArODUzLDcgQEAgdm9pZCBpbnRlbF9ycHNfdW5wYXJrKHN0cnVjdCBpbnRlbF9ycHMgKnJw
cykKIAlpZiAoaW50ZWxfcnBzX3VzZXNfdGltZXIocnBzKSkKIAkJcnBzX3N0YXJ0X3RpbWVyKHJw
cyk7CiAKLQlpZiAoSVNfR0VOKHJwc190b19pOTE1KHJwcyksIDUpKQorCWlmIChHUkFQSElDU19W
RVIocnBzX3RvX2k5MTUocnBzKSkgPT0gNSkKIAkJZ2VuNV9ycHNfdXBkYXRlKHJwcyk7CiB9CiAK
QEAgLTk5OSw3ICs5OTksNyBAQCBzdGF0aWMgdm9pZCBnZW42X3Jwc19pbml0KHN0cnVjdCBpbnRl
bF9ycHMgKnJwcykKIAogCXJwcy0+ZWZmaWNpZW50X2ZyZXEgPSBycHMtPnJwMV9mcmVxOwogCWlm
IChJU19IQVNXRUxMKGk5MTUpIHx8IElTX0JST0FEV0VMTChpOTE1KSB8fAotCSAgICBJU19HRU45
X0JDKGk5MTUpIHx8IElOVEVMX0dFTihpOTE1KSA+PSAxMCkgeworCSAgICBJU19HRU45X0JDKGk5
MTUpIHx8IEdSQVBISUNTX1ZFUihpOTE1KSA+PSAxMCkgewogCQl1MzIgZGRjY19zdGF0dXMgPSAw
OwogCiAJCWlmIChzYW5keWJyaWRnZV9wY29kZV9yZWFkKGk5MTUsCkBAIC0xMDEyLDcgKzEwMTIs
NyBAQCBzdGF0aWMgdm9pZCBnZW42X3Jwc19pbml0KHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKIAkJ
CQkJcnBzLT5tYXhfZnJlcSk7CiAJfQogCi0JaWYgKElTX0dFTjlfQkMoaTkxNSkgfHwgSU5URUxf
R0VOKGk5MTUpID49IDEwKSB7CisJaWYgKElTX0dFTjlfQkMoaTkxNSkgfHwgR1JBUEhJQ1NfVkVS
KGk5MTUpID49IDEwKSB7CiAJCS8qIFN0b3JlIHRoZSBmcmVxdWVuY3kgdmFsdWVzIGluIDE2LjY2
IE1IWiB1bml0cywgd2hpY2ggaXMKIAkJICogdGhlIG5hdHVyYWwgaGFyZHdhcmUgdW5pdCBmb3Ig
U0tMCiAJCSAqLwpAQCAtMTA0OCw3ICsxMDQ4LDcgQEAgc3RhdGljIGJvb2wgZ2VuOV9ycHNfZW5h
YmxlKHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKIAlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUg
PSBndC0+dW5jb3JlOwogCiAJLyogUHJvZ3JhbSBkZWZhdWx0cyBhbmQgdGhyZXNob2xkcyBmb3Ig
UlBTICovCi0JaWYgKElTX0dFTihndC0+aTkxNSwgOSkpCisJaWYgKEdSQVBISUNTX1ZFUihndC0+
aTkxNSkgPT0gOSkKIAkJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQ19WSURF
T19GUkVRLAogCQkJCSAgICAgIEdFTjlfRlJFUVVFTkNZKHJwcy0+cnAxX2ZyZXEpKTsKIApAQCAt
MTM2NSwxNiArMTM2NSwxNiBAQCB2b2lkIGludGVsX3Jwc19lbmFibGUoc3RydWN0IGludGVsX3Jw
cyAqcnBzKQogCQllbmFibGVkID0gY2h2X3Jwc19lbmFibGUocnBzKTsKIAllbHNlIGlmIChJU19W
QUxMRVlWSUVXKGk5MTUpKQogCQllbmFibGVkID0gdmx2X3Jwc19lbmFibGUocnBzKTsKLQllbHNl
IGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkKKwllbHNlIGlmIChHUkFQSElDU19WRVIoaTkxNSkg
Pj0gOSkKIAkJZW5hYmxlZCA9IGdlbjlfcnBzX2VuYWJsZShycHMpOwotCWVsc2UgaWYgKElOVEVM
X0dFTihpOTE1KSA+PSA4KQorCWVsc2UgaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA+PSA4KQogCQll
bmFibGVkID0gZ2VuOF9ycHNfZW5hYmxlKHJwcyk7Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUp
ID49IDYpCisJZWxzZSBpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID49IDYpCiAJCWVuYWJsZWQgPSBn
ZW42X3Jwc19lbmFibGUocnBzKTsKIAllbHNlIGlmIChJU19JUk9OTEFLRV9NKGk5MTUpKQogCQll
bmFibGVkID0gZ2VuNV9ycHNfZW5hYmxlKHJwcyk7CiAJZWxzZQotCQlNSVNTSU5HX0NBU0UoSU5U
RUxfR0VOKGk5MTUpKTsKKwkJTUlTU0lOR19DQVNFKEdSQVBISUNTX1ZFUihpOTE1KSk7CiAJaW50
ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQodW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKIAlpZiAoIWVu
YWJsZWQpCiAJCXJldHVybjsKQEAgLTEzOTMsNyArMTM5Myw3IEBAIHZvaWQgaW50ZWxfcnBzX2Vu
YWJsZShzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCiAKIAlpZiAoaGFzX2J1c3lfc3RhdHMocnBzKSkK
IAkJaW50ZWxfcnBzX3NldF90aW1lcihycHMpOwotCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+
PSA2KQorCWVsc2UgaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA+PSA2KQogCQlpbnRlbF9ycHNfc2V0
X2ludGVycnVwdHMocnBzKTsKIAllbHNlCiAJCS8qIElyb25sYWtlIGN1cnJlbnRseSB1c2VzIGlu
dGVsX2lwcy5rbyAqLyB7fQpAQCAtMTQxNCw3ICsxNDE0LDcgQEAgdm9pZCBpbnRlbF9ycHNfZGlz
YWJsZShzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCiAJaW50ZWxfcnBzX2NsZWFyX2ludGVycnVwdHMo
cnBzKTsKIAlpbnRlbF9ycHNfY2xlYXJfdGltZXIocnBzKTsKIAotCWlmIChJTlRFTF9HRU4oaTkx
NSkgPj0gNikKKwlpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID49IDYpCiAJCWdlbjZfcnBzX2Rpc2Fi
bGUocnBzKTsKIAllbHNlIGlmIChJU19JUk9OTEFLRV9NKGk5MTUpKQogCQlnZW41X3Jwc19kaXNh
YmxlKHJwcyk7CkBAIC0xNDUzLDE0ICsxNDUzLDE0IEBAIGludCBpbnRlbF9ncHVfZnJlcShzdHJ1
Y3QgaW50ZWxfcnBzICpycHMsIGludCB2YWwpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBycHNfdG9faTkxNShycHMpOwogCi0JaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQor
CWlmIChHUkFQSElDU19WRVIoaTkxNSkgPj0gOSkKIAkJcmV0dXJuIERJVl9ST1VORF9DTE9TRVNU
KHZhbCAqIEdUX0ZSRVFVRU5DWV9NVUxUSVBMSUVSLAogCQkJCQkgR0VOOV9GUkVRX1NDQUxFUik7
CiAJZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkKIAkJcmV0dXJuIGNodl9ncHVfZnJlcShy
cHMsIHZhbCk7CiAJZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSkKIAkJcmV0dXJuIGJ5dF9n
cHVfZnJlcShycHMsIHZhbCk7Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDYpCisJZWxz
ZSBpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID49IDYpCiAJCXJldHVybiB2YWwgKiBHVF9GUkVRVUVO
Q1lfTVVMVElQTElFUjsKIAllbHNlCiAJCXJldHVybiB2YWw7CkBAIC0xNDcwLDE0ICsxNDcwLDE0
IEBAIGludCBpbnRlbF9mcmVxX29wY29kZShzdHJ1Y3QgaW50ZWxfcnBzICpycHMsIGludCB2YWwp
CiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBycHNfdG9faTkxNShycHMpOwog
Ci0JaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQorCWlmIChHUkFQSElDU19WRVIoaTkxNSkgPj0g
OSkKIAkJcmV0dXJuIERJVl9ST1VORF9DTE9TRVNUKHZhbCAqIEdFTjlfRlJFUV9TQ0FMRVIsCiAJ
CQkJCSBHVF9GUkVRVUVOQ1lfTVVMVElQTElFUik7CiAJZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhp
OTE1KSkKIAkJcmV0dXJuIGNodl9mcmVxX29wY29kZShycHMsIHZhbCk7CiAJZWxzZSBpZiAoSVNf
VkFMTEVZVklFVyhpOTE1KSkKIAkJcmV0dXJuIGJ5dF9mcmVxX29wY29kZShycHMsIHZhbCk7Ci0J
ZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDYpCisJZWxzZSBpZiAoR1JBUEhJQ1NfVkVSKGk5
MTUpID49IDYpCiAJCXJldHVybiBESVZfUk9VTkRfQ0xPU0VTVCh2YWwsIEdUX0ZSRVFVRU5DWV9N
VUxUSVBMSUVSKTsKIAllbHNlCiAJCXJldHVybiB2YWw7CkBAIC0xNzcwLDcgKzE3NzAsNyBAQCB2
b2lkIGdlbjZfcnBzX2lycV9oYW5kbGVyKHN0cnVjdCBpbnRlbF9ycHMgKnJwcywgdTMyIHBtX2lp
cikKIAkJc3Bpbl91bmxvY2soJmd0LT5pcnFfbG9jayk7CiAJfQogCi0JaWYgKElOVEVMX0dFTihn
dC0+aTkxNSkgPj0gOCkKKwlpZiAoR1JBUEhJQ1NfVkVSKGd0LT5pOTE1KSA+PSA4KQogCQlyZXR1
cm47CiAKIAlpZiAocG1faWlyICYgUE1fVkVCT1hfVVNFUl9JTlRFUlJVUFQpCkBAIC0xODMzLDcg
KzE4MzMsNyBAQCB2b2lkIGludGVsX3Jwc19pbml0KHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKIAkJ
Y2h2X3Jwc19pbml0KHJwcyk7CiAJZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSkKIAkJdmx2
X3Jwc19pbml0KHJwcyk7Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDYpCisJZWxzZSBp
ZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID49IDYpCiAJCWdlbjZfcnBzX2luaXQocnBzKTsKIAllbHNl
IGlmIChJU19JUk9OTEFLRV9NKGk5MTUpKQogCQlnZW41X3Jwc19pbml0KHJwcyk7CkBAIC0xODQz
LDcgKzE4NDMsNyBAQCB2b2lkIGludGVsX3Jwc19pbml0KHN0cnVjdCBpbnRlbF9ycHMgKnJwcykK
IAlycHMtPm1pbl9mcmVxX3NvZnRsaW1pdCA9IHJwcy0+bWluX2ZyZXE7CiAKIAkvKiBBZnRlciBz
ZXR0aW5nIG1heC1zb2Z0bGltaXQsIGZpbmQgdGhlIG92ZXJjbG9jayBtYXggZnJlcSAqLwotCWlm
IChJU19HRU4oaTkxNSwgNikgfHwgSVNfSVZZQlJJREdFKGk5MTUpIHx8IElTX0hBU1dFTEwoaTkx
NSkpIHsKKwlpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID09IDYgfHwgSVNfSVZZQlJJREdFKGk5MTUp
IHx8IElTX0hBU1dFTEwoaTkxNSkpIHsKIAkJdTMyIHBhcmFtcyA9IDA7CiAKIAkJc2FuZHlicmlk
Z2VfcGNvZGVfcmVhZChpOTE1LCBHRU42X1JFQURfT0NfUEFSQU1TLApAQCAtMTg3MiwxNiArMTg3
MiwxNiBAQCB2b2lkIGludGVsX3Jwc19pbml0KHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKIAkgKgog
CSAqIFRPRE86IHZlcmlmeSBpZiB0aGlzIGNhbiBiZSByZXByb2R1Y2VkIG9uIFZMVixDSFYuCiAJ
ICovCi0JaWYgKElOVEVMX0dFTihpOTE1KSA8PSA3KQorCWlmIChHUkFQSElDU19WRVIoaTkxNSkg
PD0gNykKIAkJcnBzLT5wbV9pbnRybXNrX21ieiB8PSBHRU42X1BNX1JQX1VQX0VJX0VYUElSRUQ7
CiAKLQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDggJiYgSU5URUxfR0VOKGk5MTUpIDwgMTEpCisJ
aWYgKEdSQVBISUNTX1ZFUihpOTE1KSA+PSA4ICYmIEdSQVBISUNTX1ZFUihpOTE1KSA8IDExKQog
CQlycHMtPnBtX2ludHJtc2tfbWJ6IHw9IEdFTjhfUE1JTlRSX0RJU0FCTEVfUkVESVJFQ1RfVE9f
R1VDOwogfQogCiB2b2lkIGludGVsX3Jwc19zYW5pdGl6ZShzdHJ1Y3QgaW50ZWxfcnBzICpycHMp
CiB7Ci0JaWYgKElOVEVMX0dFTihycHNfdG9faTkxNShycHMpKSA+PSA2KQorCWlmIChHUkFQSElD
U19WRVIocnBzX3RvX2k5MTUocnBzKSkgPj0gNikKIAkJcnBzX2Rpc2FibGVfaW50ZXJydXB0cyhy
cHMpOwogfQogCkBAIC0xODkyLDExICsxODkyLDExIEBAIHUzMiBpbnRlbF9ycHNfZ2V0X2NhZ2Yo
c3RydWN0IGludGVsX3JwcyAqcnBzLCB1MzIgcnBzdGF0KQogCiAJaWYgKElTX1ZBTExFWVZJRVco
aTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkKIAkJY2FnZiA9IChycHN0YXQgPj4gOCkgJiAw
eGZmOwotCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQorCWVsc2UgaWYgKEdSQVBISUNT
X1ZFUihpOTE1KSA+PSA5KQogCQljYWdmID0gKHJwc3RhdCAmIEdFTjlfQ0FHRl9NQVNLKSA+PiBH
RU45X0NBR0ZfU0hJRlQ7CiAJZWxzZSBpZiAoSVNfSEFTV0VMTChpOTE1KSB8fCBJU19CUk9BRFdF
TEwoaTkxNSkpCiAJCWNhZ2YgPSAocnBzdGF0ICYgSFNXX0NBR0ZfTUFTSykgPj4gSFNXX0NBR0Zf
U0hJRlQ7Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDYpCisJZWxzZSBpZiAoR1JBUEhJ
Q1NfVkVSKGk5MTUpID49IDYpCiAJCWNhZ2YgPSAocnBzdGF0ICYgR0VONl9DQUdGX01BU0spID4+
IEdFTjZfQ0FHRl9TSElGVDsKIAllbHNlCiAJCWNhZ2YgPSBnZW41X2ludmVydF9mcmVxKHJwcywg
KHJwc3RhdCAmIE1FTVNUQVRfUFNUQVRFX01BU0spID4+CkBAIC0xOTE1LDcgKzE5MTUsNyBAQCBz
dGF0aWMgdTMyIHJlYWRfY2FnZihzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCiAJCXZsdl9wdW5pdF9n
ZXQoaTkxNSk7CiAJCWZyZXEgPSB2bHZfcHVuaXRfcmVhZChpOTE1LCBQVU5JVF9SRUdfR1BVX0ZS
RVFfU1RTKTsKIAkJdmx2X3B1bml0X3B1dChpOTE1KTsKLQl9IGVsc2UgaWYgKElOVEVMX0dFTihp
OTE1KSA+PSA2KSB7CisJfSBlbHNlIGlmIChHUkFQSElDU19WRVIoaTkxNSkgPj0gNikgewogCQlm
cmVxID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU42X1JQU1RBVDEpOwogCX0gZWxzZSB7
CiAJCWZyZXEgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIE1FTVNUQVRfSUxLKTsKQEAgLTE5
NjgsNyArMTk2OCw3IEBAIHZvaWQgaW50ZWxfcnBzX2RyaXZlcl9yZWdpc3RlcihzdHJ1Y3QgaW50
ZWxfcnBzICpycHMpCiAJICogV2Ugb25seSByZWdpc3RlciB0aGUgaTkxNSBpcHMgcGFydCB3aXRo
IGludGVsLWlwcyBvbmNlIGV2ZXJ5dGhpbmcgaXMKIAkgKiBzZXQgdXAsIHRvIGF2b2lkIGludGVs
LWlwcyBzbmVha2luZyBpbiBhbmQgcmVhZGluZyBib2d1cyB2YWx1ZXMuCiAJICovCi0JaWYgKElT
X0dFTihndC0+aTkxNSwgNSkpIHsKKwlpZiAoR1JBUEhJQ1NfVkVSKGd0LT5pOTE1KSA9PSA1KSB7
CiAJCUdFTV9CVUdfT04oaXBzX21jaGRldik7CiAJCXJjdV9hc3NpZ25fcG9pbnRlcihpcHNfbWNo
ZGV2LCBndC0+aTkxNSk7CiAJCWlwc19waW5nX2Zvcl9pOTE1X2xvYWQoKTsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3NzZXUuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX3NzZXUuYwppbmRleCAwZDlmNzRhZWM4ZmUuLjM2N2ZkNDRiODFjOCAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfc3NldS5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3NzZXUuYwpAQCAtNTkwLDEzICs1OTAsMTMgQEAgdm9p
ZCBpbnRlbF9zc2V1X2luZm9faW5pdChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogCQljaGVycnl2aWV3
X3NzZXVfaW5mb19pbml0KGd0KTsKIAllbHNlIGlmIChJU19CUk9BRFdFTEwoaTkxNSkpCiAJCWJk
d19zc2V1X2luZm9faW5pdChndCk7Ci0JZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDkpKQorCWVsc2Ug
aWYgKEdSQVBISUNTX1ZFUihpOTE1KSA9PSA5KQogCQlnZW45X3NzZXVfaW5mb19pbml0KGd0KTsK
LQllbHNlIGlmIChJU19HRU4oaTkxNSwgMTApKQorCWVsc2UgaWYgKEdSQVBISUNTX1ZFUihpOTE1
KSA9PSAxMCkKIAkJZ2VuMTBfc3NldV9pbmZvX2luaXQoZ3QpOwotCWVsc2UgaWYgKElTX0dFTihp
OTE1LCAxMSkpCisJZWxzZSBpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID09IDExKQogCQlnZW4xMV9z
c2V1X2luZm9faW5pdChndCk7Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDEyKQorCWVs
c2UgaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA+PSAxMikKIAkJZ2VuMTJfc3NldV9pbmZvX2luaXQo
Z3QpOwogfQogCkBAIC02MTMsNyArNjEzLDcgQEAgdTMyIGludGVsX3NzZXVfbWFrZV9ycGNzKHN0
cnVjdCBpbnRlbF9ndCAqZ3QsCiAJICogTm8gZXhwbGljaXQgUlBDUyByZXF1ZXN0IGlzIG5lZWRl
ZCB0byBlbnN1cmUgZnVsbAogCSAqIHNsaWNlL3N1YnNsaWNlL0VVIGVuYWJsZW1lbnQgcHJpb3Ig
dG8gR2VuOS4KIAkgKi8KLQlpZiAoSU5URUxfR0VOKGk5MTUpIDwgOSkKKwlpZiAoR1JBUEhJQ1Nf
VkVSKGk5MTUpIDwgOSkKIAkJcmV0dXJuIDA7CiAKIAkvKgpAQCAtNjUxLDcgKzY1MSw3IEBAIHUz
MiBpbnRlbF9zc2V1X21ha2VfcnBjcyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAogCSAqIHN1YnNsaWNl
cyBhcmUgZW5hYmxlZCwgb3IgYSBjb3VudCBiZXR3ZWVuIG9uZSBhbmQgZm91ciBvbiB0aGUgZmly
c3QKIAkgKiBzbGljZS4KIAkgKi8KLQlpZiAoSVNfR0VOKGk5MTUsIDExKSAmJgorCWlmIChHUkFQ
SElDU19WRVIoaTkxNSkgPT0gMTEgJiYKIAkgICAgc2xpY2VzID09IDEgJiYKIAkgICAgc3Vic2xp
Y2VzID4gbWluX3QodTgsIDQsIGh3ZWlnaHQ4KHNzZXUtPnN1YnNsaWNlX21hc2tbMF0pIC8gMikp
IHsKIAkJR0VNX0JVR19PTihzdWJzbGljZXMgJiAxKTsKQEAgLTY2OSw3ICs2NjksNyBAQCB1MzIg
aW50ZWxfc3NldV9tYWtlX3JwY3Moc3RydWN0IGludGVsX2d0ICpndCwKIAlpZiAoc3NldS0+aGFz
X3NsaWNlX3BnKSB7CiAJCXUzMiBtYXNrLCB2YWwgPSBzbGljZXM7CiAKLQkJaWYgKElOVEVMX0dF
TihpOTE1KSA+PSAxMSkgeworCQlpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID49IDExKSB7CiAJCQlt
YXNrID0gR0VOMTFfUlBDU19TX0NOVF9NQVNLOwogCQkJdmFsIDw8PSBHRU4xMV9SUENTX1NfQ05U
X1NISUZUOwogCQl9IGVsc2UgewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfd29ya2Fyb3VuZHMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3dvcmth
cm91bmRzLmMKaW5kZXggNjJjYjllZTViZmMzLi5iNjJkMWUzMWE2NDUgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3dvcmthcm91bmRzLmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfd29ya2Fyb3VuZHMuYwpAQCAtNjk5LDkgKzY5OSw5IEBAIF9f
aW50ZWxfZW5naW5lX2luaXRfY3R4X3dhKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwK
IAogCWlmIChJU19ERzEoaTkxNSkpCiAJCWRnMV9jdHhfd29ya2Fyb3VuZHNfaW5pdChlbmdpbmUs
IHdhbCk7Ci0JZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDEyKSkKKwllbHNlIGlmIChHUkFQSElDU19W
RVIoaTkxNSkgPT0gMTIpCiAJCWdlbjEyX2N0eF93b3JrYXJvdW5kc19pbml0KGVuZ2luZSwgd2Fs
KTsKLQllbHNlIGlmIChJU19HRU4oaTkxNSwgMTEpKQorCWVsc2UgaWYgKEdSQVBISUNTX1ZFUihp
OTE1KSA9PSAxMSkKIAkJaWNsX2N0eF93b3JrYXJvdW5kc19pbml0KGVuZ2luZSwgd2FsKTsKIAll
bHNlIGlmIChJU19DQU5OT05MQUtFKGk5MTUpKQogCQljbmxfY3R4X3dvcmthcm91bmRzX2luaXQo
ZW5naW5lLCB3YWwpOwpAQCAtNzE5LDE0ICs3MTksMTQgQEAgX19pbnRlbF9lbmdpbmVfaW5pdF9j
dHhfd2Eoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAogCQljaHZfY3R4X3dvcmthcm91
bmRzX2luaXQoZW5naW5lLCB3YWwpOwogCWVsc2UgaWYgKElTX0JST0FEV0VMTChpOTE1KSkKIAkJ
YmR3X2N0eF93b3JrYXJvdW5kc19pbml0KGVuZ2luZSwgd2FsKTsKLQllbHNlIGlmIChJU19HRU4o
aTkxNSwgNykpCisJZWxzZSBpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID09IDcpCiAJCWdlbjdfY3R4
X3dvcmthcm91bmRzX2luaXQoZW5naW5lLCB3YWwpOwotCWVsc2UgaWYgKElTX0dFTihpOTE1LCA2
KSkKKwllbHNlIGlmIChHUkFQSElDU19WRVIoaTkxNSkgPT0gNikKIAkJZ2VuNl9jdHhfd29ya2Fy
b3VuZHNfaW5pdChlbmdpbmUsIHdhbCk7Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpIDwgOCkK
KwllbHNlIGlmIChHUkFQSElDU19WRVIoaTkxNSkgPCA4KQogCQk7CiAJZWxzZQotCQlNSVNTSU5H
X0NBU0UoSU5URUxfR0VOKGk5MTUpKTsKKwkJTUlTU0lOR19DQVNFKEdSQVBISUNTX1ZFUihpOTE1
KSk7CiAKIAl3YV9pbml0X2ZpbmlzaCh3YWwpOwogfQpAQCAtOTUwLDcgKzk1MCw3IEBAIHdhX2lu
aXRfbWNyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBzdHJ1Y3QgaTkxNV93YV9saXN0
ICp3YWwpCiAJdW5zaWduZWQgaW50IHNsaWNlLCBzdWJzbGljZTsKIAl1MzIgbDNfZW4sIG1jciwg
bWNyX21hc2s7CiAKLQlHRU1fQlVHX09OKElOVEVMX0dFTihpOTE1KSA8IDEwKTsKKwlHRU1fQlVH
X09OKEdSQVBISUNTX1ZFUihpOTE1KSA8IDEwKTsKIAogCS8qCiAJICogV2FQcm9ncmFtTWdzckZv
ckwzQmFua1NwZWNpZmljTW1pb1JlYWRzOiBjbmwsaWNsCkBAIC05ODAsNyArOTgwLDcgQEAgd2Ff
aW5pdF9tY3Ioc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHN0cnVjdCBpOTE1X3dhX2xp
c3QgKndhbCkKIAkgKiBvZiBldmVyeSBNTUlPIHJlYWQuCiAJICovCiAKLQlpZiAoSU5URUxfR0VO
KGk5MTUpID49IDEwICYmIGlzX3Bvd2VyX29mXzIoc3NldS0+c2xpY2VfbWFzaykpIHsKKwlpZiAo
R1JBUEhJQ1NfVkVSKGk5MTUpID49IDEwICYmIGlzX3Bvd2VyX29mXzIoc3NldS0+c2xpY2VfbWFz
aykpIHsKIAkJdTMyIGwzX2Z1c2UgPQogCQkJaW50ZWxfdW5jb3JlX3JlYWQoJmk5MTUtPnVuY29y
ZSwgR0VOMTBfTUlSUk9SX0ZVU0UzKSAmCiAJCQlHRU4xMF9MM0JBTktfTUFTSzsKQEAgLTEwMDIs
NyArMTAwMiw3IEBAIHdhX2luaXRfbWNyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBz
dHJ1Y3QgaTkxNV93YV9saXN0ICp3YWwpCiAJfQogCXN1YnNsaWNlLS07CiAKLQlpZiAoSU5URUxf
R0VOKGk5MTUpID49IDExKSB7CisJaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA+PSAxMSkgewogCQlt
Y3IgPSBHRU4xMV9NQ1JfU0xJQ0Uoc2xpY2UpIHwgR0VOMTFfTUNSX1NVQlNMSUNFKHN1YnNsaWNl
KTsKIAkJbWNyX21hc2sgPSBHRU4xMV9NQ1JfU0xJQ0VfTUFTSyB8IEdFTjExX01DUl9TVUJTTElD
RV9NQVNLOwogCX0gZWxzZSB7CkBAIC0xMTcxLDkgKzExNzEsOSBAQCBndF9pbml0X3dvcmthcm91
bmRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBzdHJ1Y3QgaTkxNV93YV9saXN0ICp3
YWwpCiAJCWRnMV9ndF93b3JrYXJvdW5kc19pbml0KGk5MTUsIHdhbCk7CiAJZWxzZSBpZiAoSVNf
VElHRVJMQUtFKGk5MTUpKQogCQl0Z2xfZ3Rfd29ya2Fyb3VuZHNfaW5pdChpOTE1LCB3YWwpOwot
CWVsc2UgaWYgKElTX0dFTihpOTE1LCAxMikpCisJZWxzZSBpZiAoR1JBUEhJQ1NfVkVSKGk5MTUp
ID09IDEyKQogCQlnZW4xMl9ndF93b3JrYXJvdW5kc19pbml0KGk5MTUsIHdhbCk7Ci0JZWxzZSBp
ZiAoSVNfR0VOKGk5MTUsIDExKSkKKwllbHNlIGlmIChHUkFQSElDU19WRVIoaTkxNSkgPT0gMTEp
CiAJCWljbF9ndF93b3JrYXJvdW5kc19pbml0KGk5MTUsIHdhbCk7CiAJZWxzZSBpZiAoSVNfQ0FO
Tk9OTEFLRShpOTE1KSkKIAkJY25sX2d0X3dvcmthcm91bmRzX2luaXQoaTkxNSwgd2FsKTsKQEAg
LTExOTMsMTggKzExOTMsMTggQEAgZ3RfaW5pdF93b3JrYXJvdW5kcyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwgc3RydWN0IGk5MTVfd2FfbGlzdCAqd2FsKQogCQl2bHZfZ3Rfd29ya2Fy
b3VuZHNfaW5pdChpOTE1LCB3YWwpOwogCWVsc2UgaWYgKElTX0lWWUJSSURHRShpOTE1KSkKIAkJ
aXZiX2d0X3dvcmthcm91bmRzX2luaXQoaTkxNSwgd2FsKTsKLQllbHNlIGlmIChJU19HRU4oaTkx
NSwgNikpCisJZWxzZSBpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID09IDYpCiAJCXNuYl9ndF93b3Jr
YXJvdW5kc19pbml0KGk5MTUsIHdhbCk7Ci0JZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDUpKQorCWVs
c2UgaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA9PSA1KQogCQlpbGtfZ3Rfd29ya2Fyb3VuZHNfaW5p
dChpOTE1LCB3YWwpOwogCWVsc2UgaWYgKElTX0c0WChpOTE1KSkKIAkJZzR4X2d0X3dvcmthcm91
bmRzX2luaXQoaTkxNSwgd2FsKTsKLQllbHNlIGlmIChJU19HRU4oaTkxNSwgNCkpCisJZWxzZSBp
ZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID09IDQpCiAJCWdlbjRfZ3Rfd29ya2Fyb3VuZHNfaW5pdChp
OTE1LCB3YWwpOwotCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA8PSA4KQorCWVsc2UgaWYgKEdS
QVBISUNTX1ZFUihpOTE1KSA8PSA4KQogCQk7CiAJZWxzZQotCQlNSVNTSU5HX0NBU0UoSU5URUxf
R0VOKGk5MTUpKTsKKwkJTUlTU0lOR19DQVNFKEdSQVBISUNTX1ZFUihpOTE1KSk7CiB9CiAKIHZv
aWQgaW50ZWxfZ3RfaW5pdF93b3JrYXJvdW5kcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKQEAgLTE1NTgsOSArMTU1OCw5IEBAIHZvaWQgaW50ZWxfZW5naW5lX2luaXRfd2hpdGVsaXN0
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAogCWlmIChJU19ERzEoaTkxNSkpCiAJ
CWRnMV93aGl0ZWxpc3RfYnVpbGQoZW5naW5lKTsKLQllbHNlIGlmIChJU19HRU4oaTkxNSwgMTIp
KQorCWVsc2UgaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA9PSAxMikKIAkJdGdsX3doaXRlbGlzdF9i
dWlsZChlbmdpbmUpOwotCWVsc2UgaWYgKElTX0dFTihpOTE1LCAxMSkpCisJZWxzZSBpZiAoR1JB
UEhJQ1NfVkVSKGk5MTUpID09IDExKQogCQlpY2xfd2hpdGVsaXN0X2J1aWxkKGVuZ2luZSk7CiAJ
ZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShpOTE1KSkKIAkJY25sX3doaXRlbGlzdF9idWlsZChlbmdp
bmUpOwpAQCAtMTU3NiwxMCArMTU3NiwxMCBAQCB2b2lkIGludGVsX2VuZ2luZV9pbml0X3doaXRl
bGlzdChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJCWJ4dF93aGl0ZWxpc3RfYnVp
bGQoZW5naW5lKTsKIAllbHNlIGlmIChJU19TS1lMQUtFKGk5MTUpKQogCQlza2xfd2hpdGVsaXN0
X2J1aWxkKGVuZ2luZSk7Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpIDw9IDgpCisJZWxzZSBp
ZiAoR1JBUEhJQ1NfVkVSKGk5MTUpIDw9IDgpCiAJCTsKIAllbHNlCi0JCU1JU1NJTkdfQ0FTRShJ
TlRFTF9HRU4oaTkxNSkpOworCQlNSVNTSU5HX0NBU0UoR1JBUEhJQ1NfVkVSKGk5MTUpKTsKIAog
CXdhX2luaXRfZmluaXNoKHcpOwogfQpAQCAtMTY5NSw3ICsxNjk1LDcgQEAgcmNzX2VuZ2luZV93
YV9pbml0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgc3RydWN0IGk5MTVfd2FfbGlz
dCAqd2FsKQogCQkJICAgICBFTkFCTEVfU01BTExQTCk7CiAJfQogCi0JaWYgKElTX0dFTihpOTE1
LCAxMSkpIHsKKwlpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID09IDExKSB7CiAJCS8qIFRoaXMgaXMg
bm90IGFuIFdhLiBFbmFibGUgZm9yIGJldHRlciBpbWFnZSBxdWFsaXR5ICovCiAJCXdhX21hc2tl
ZF9lbih3YWwsCiAJCQkgICAgIF8zRF9DSElDS0VOMywKQEAgLTE3OTMsNyArMTc5Myw3IEBAIHJj
c19lbmdpbmVfd2FfaW5pdChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHN0cnVjdCBp
OTE1X3dhX2xpc3QgKndhbCkKIAkJCSAgICAgRkZfRE9QX0NMT0NLX0dBVEVfRElTQUJMRSk7CiAJ
fQogCi0JaWYgKElTX0dFTl9SQU5HRShpOTE1LCA5LCAxMikpIHsKKwlpZiAoSVNfR1JBUEhJQ1Nf
VkVSKGk5MTUsIDksIDEyKSkgewogCQkvKiBGdHJQZXJDdHh0UHJlZW1wdGlvbkdyYW51bGFyaXR5
Q29udHJvbDpza2wsYnh0LGtibCxjZmwsY25sLGljbCx0Z2wgKi8KIAkJd2FfbWFza2VkX2VuKHdh
bCwKIAkJCSAgICAgR0VON19GRl9TTElDRV9DU19DSElDS0VOMSwKQEAgLTE4MTcsNyArMTgxNyw3
IEBAIHJjc19lbmdpbmVfd2FfaW5pdChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHN0
cnVjdCBpOTE1X3dhX2xpc3QgKndhbCkKIAkJCSAgICAgR0VOOV9QT09MRURfRVVfTE9BRF9CQUxB
TkNJTkdfRklYX0RJU0FCTEUpOwogCX0KIAotCWlmIChJU19HRU4oaTkxNSwgOSkpIHsKKwlpZiAo
R1JBUEhJQ1NfVkVSKGk5MTUpID09IDkpIHsKIAkJLyogV2FDb250ZXh0U3dpdGNoV2l0aENvbmN1
cnJlbnRUTEJJbnZhbGlkYXRlOnNrbCxieHQsa2JsLGdsayxjZmwgKi8KIAkJd2FfbWFza2VkX2Vu
KHdhbCwKIAkJCSAgICAgR0VOOV9DU0ZFX0NISUNLRU4xX1JDUywKQEAgLTE5MjEsNyArMTkyMSw3
IEBAIHJjc19lbmdpbmVfd2FfaW5pdChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHN0
cnVjdCBpOTE1X3dhX2xpc3QgKndhbCkKIAkJCQkgICAgIEdFTjdfUFNEX1NJTkdMRV9QT1JUX0RJ
U1BBVENIX0VOQUJMRSk7CiAJfQogCi0JaWYgKElTX0dFTihpOTE1LCA3KSkgeworCWlmIChHUkFQ
SElDU19WRVIoaTkxNSkgPT0gNykgewogCQkvKiBXYUJDU1ZDU1RsYkludmFsaWRhdGlvbk1vZGU6
aXZiLHZsdixoc3cgKi8KIAkJd2FfbWFza2VkX2VuKHdhbCwKIAkJCSAgICAgR0ZYX01PREVfR0VO
NywKQEAgLTE5NTMsNyArMTk1Myw3IEBAIHJjc19lbmdpbmVfd2FfaW5pdChzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUsIHN0cnVjdCBpOTE1X3dhX2xpc3QgKndhbCkKIAkJICAgICAgIEdF
TjZfV0laX0hBU0hJTkdfMTZ4NCk7CiAJfQogCi0JaWYgKElTX0dFTl9SQU5HRShpOTE1LCA2LCA3
KSkKKwlpZiAoSVNfR1JBUEhJQ1NfVkVSKGk5MTUsIDYsIDcpKQogCQkvKgogCQkgKiBXZSBuZWVk
IHRvIGRpc2FibGUgdGhlIEFzeW5jRmxpcCBwZXJmb3JtYW5jZSBvcHRpbWlzYXRpb25zIGluCiAJ
CSAqIG9yZGVyIHRvIHVzZSBNSV9XQUlUX0ZPUl9FVkVOVCB3aXRoaW4gdGhlIENTLiBJdCBzaG91
bGQKQEAgLTE5NjUsNyArMTk2NSw3IEBAIHJjc19lbmdpbmVfd2FfaW5pdChzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUsIHN0cnVjdCBpOTE1X3dhX2xpc3QgKndhbCkKIAkJCSAgICAgTUlf
TU9ERSwKIAkJCSAgICAgQVNZTkNfRkxJUF9QRVJGX0RJU0FCTEUpOwogCi0JaWYgKElTX0dFTihp
OTE1LCA2KSkgeworCWlmIChHUkFQSElDU19WRVIoaTkxNSkgPT0gNikgewogCQkvKgogCQkgKiBS
ZXF1aXJlZCBmb3IgdGhlIGhhcmR3YXJlIHRvIHByb2dyYW0gc2NhbmxpbmUgdmFsdWVzIGZvcgog
CQkgKiB3YWl0aW5nCkBAIC0yMDE5LDE0ICsyMDE5LDE0IEBAIHJjc19lbmdpbmVfd2FfaW5pdChz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHN0cnVjdCBpOTE1X3dhX2xpc3QgKndhbCkK
IAkJCSAgICAgIENNMF9TVENfRVZJQ1RfRElTQUJMRV9MUkFfU05CKTsKIAl9CiAKLQlpZiAoSVNf
R0VOX1JBTkdFKGk5MTUsIDQsIDYpKQorCWlmIChJU19HUkFQSElDU19WRVIoaTkxNSwgNCwgNikp
CiAJCS8qIFdhVGltZWRTaW5nbGVWZXJ0ZXhEaXNwYXRjaDpjbCxidyxjdGcsZWxrLGlsayxzbmIg
Ki8KIAkJd2FfYWRkKHdhbCwgTUlfTU9ERSwKIAkJICAgICAgIDAsIF9NQVNLRURfQklUX0VOQUJM
RShWU19USU1FUl9ESVNQQVRDSCksCiAJCSAgICAgICAvKiBYWFggYml0IGRvZXNuJ3Qgc3RpY2sg
b24gQnJvYWR3YXRlciAqLwogCQkgICAgICAgSVNfSTk2NUcoaTkxNSkgPyAwIDogVlNfVElNRVJf
RElTUEFUQ0gpOwogCi0JaWYgKElTX0dFTihpOTE1LCA0KSkKKwlpZiAoR1JBUEhJQ1NfVkVSKGk5
MTUpID09IDQpCiAJCS8qCiAJCSAqIERpc2FibGUgQ09OU1RBTlRfQlVGRkVSIGJlZm9yZSBpdCBp
cyBsb2FkZWQgZnJvbSB0aGUgY29udGV4dAogCQkgKiBpbWFnZS4gRm9yIGFzIGl0IGlzIGxvYWRl
ZCwgaXQgaXMgZXhlY3V0ZWQgYW5kIHRoZSBzdG9yZWQKQEAgLTIwNTgsNyArMjA1OCw3IEBAIHhj
c19lbmdpbmVfd2FfaW5pdChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHN0cnVjdCBp
OTE1X3dhX2xpc3QgKndhbCkKIHN0YXRpYyB2b2lkCiBlbmdpbmVfaW5pdF93b3JrYXJvdW5kcyhz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHN0cnVjdCBpOTE1X3dhX2xpc3QgKndhbCkK
IHsKLQlpZiAoSTkxNV9TRUxGVEVTVF9PTkxZKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpIDwgNCkp
CisJaWYgKEk5MTVfU0VMRlRFU1RfT05MWShHUkFQSElDU19WRVIoZW5naW5lLT5pOTE1KSA8IDQp
KQogCQlyZXR1cm47CiAKIAlpZiAoZW5naW5lLT5jbGFzcyA9PSBSRU5ERVJfQ0xBU1MpCkBAIC0y
MDcxLDcgKzIwNzEsNyBAQCB2b2lkIGludGVsX2VuZ2luZV9pbml0X3dvcmthcm91bmRzKHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsKIAlzdHJ1Y3QgaTkxNV93YV9saXN0ICp3YWwg
PSAmZW5naW5lLT53YV9saXN0OwogCi0JaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpIDwgNCkK
KwlpZiAoR1JBUEhJQ1NfVkVSKGVuZ2luZS0+aTkxNSkgPCA0KQogCQlyZXR1cm47CiAKIAl3YV9p
bml0X3N0YXJ0KHdhbCwgImVuZ2luZSIsIGVuZ2luZS0+bmFtZSk7CkBAIC0yMTEyLDkgKzIxMTIs
OSBAQCBzdGF0aWMgYm9vbCBtY3JfcmFuZ2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
IHUzMiBvZmZzZXQpCiAJY29uc3Qgc3RydWN0IG1jcl9yYW5nZSAqbWNyX3JhbmdlczsKIAlpbnQg
aTsKIAotCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTIpCisJaWYgKEdSQVBISUNTX1ZFUihpOTE1
KSA+PSAxMikKIAkJbWNyX3JhbmdlcyA9IG1jcl9yYW5nZXNfZ2VuMTI7Ci0JZWxzZSBpZiAoSU5U
RUxfR0VOKGk5MTUpID49IDgpCisJZWxzZSBpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID49IDgpCiAJ
CW1jcl9yYW5nZXMgPSBtY3JfcmFuZ2VzX2dlbjg7CiAJZWxzZQogCQlyZXR1cm4gZmFsc2U7CkBA
IC0yMTQzLDcgKzIxNDMsNyBAQCB3YV9saXN0X3NybShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwK
IAl1MzIgc3JtLCAqY3M7CiAKIAlzcm0gPSBNSV9TVE9SRV9SRUdJU1RFUl9NRU0gfCBNSV9TUk1f
TFJNX0dMT0JBTF9HVFQ7Ci0JaWYgKElOVEVMX0dFTihpOTE1KSA+PSA4KQorCWlmIChHUkFQSElD
U19WRVIoaTkxNSkgPj0gOCkKIAkJc3JtKys7CiAKIAlmb3IgKGkgPSAwLCB3YSA9IHdhbC0+bGlz
dDsgaSA8IHdhbC0+Y291bnQ7IGkrKywgd2ErKykgewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfZW5naW5lX2NzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9zZWxmdGVzdF9lbmdpbmVfY3MuYwppbmRleCAzNDUzZWI3N2M0OTguLjY0YWJmNWZlYWJmYSAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfZW5naW5lX2NzLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfZW5naW5lX2NzLmMKQEAgLTUy
LDcgKzUyLDcgQEAgc3RhdGljIGludCB3cml0ZV90aW1lc3RhbXAoc3RydWN0IGk5MTVfcmVxdWVz
dCAqcnEsIGludCBzbG90KQogCQlyZXR1cm4gUFRSX0VSUihjcyk7CiAKIAljbWQgPSBNSV9TVE9S
RV9SRUdJU1RFUl9NRU0gfCBNSV9VU0VfR0dUVDsKLQlpZiAoSU5URUxfR0VOKHJxLT5lbmdpbmUt
Pmk5MTUpID49IDgpCisJaWYgKEdSQVBISUNTX1ZFUihycS0+ZW5naW5lLT5pOTE1KSA+PSA4KQog
CQljbWQrKzsKIAkqY3MrKyA9IGNtZDsKIAkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJ
TkdfVElNRVNUQU1QKHJxLT5lbmdpbmUtPm1taW9fYmFzZSkpOwpAQCAtMTI1LDcgKzEyNSw3IEBA
IHN0YXRpYyBpbnQgcGVyZl9taV9iYl9zdGFydCh2b2lkICphcmcpCiAJZW51bSBpbnRlbF9lbmdp
bmVfaWQgaWQ7CiAJaW50IGVyciA9IDA7CiAKLQlpZiAoSU5URUxfR0VOKGd0LT5pOTE1KSA8IDcp
IC8qIGZvciBwZXItZW5naW5lIENTX1RJTUVTVEFNUCAqLworCWlmIChHUkFQSElDU19WRVIoZ3Qt
Pmk5MTUpIDwgNykgLyogZm9yIHBlci1lbmdpbmUgQ1NfVElNRVNUQU1QICovCiAJCXJldHVybiAw
OwogCiAJcGVyZl9iZWdpbihndCk7CkBAIC0yNDksNyArMjQ5LDcgQEAgc3RhdGljIGludCBwZXJm
X21pX25vb3Aodm9pZCAqYXJnKQogCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwogCWludCBlcnIg
PSAwOwogCi0JaWYgKElOVEVMX0dFTihndC0+aTkxNSkgPCA3KSAvKiBmb3IgcGVyLWVuZ2luZSBD
U19USU1FU1RBTVAgKi8KKwlpZiAoR1JBUEhJQ1NfVkVSKGd0LT5pOTE1KSA8IDcpIC8qIGZvciBw
ZXItZW5naW5lIENTX1RJTUVTVEFNUCAqLwogCQlyZXR1cm4gMDsKIAogCXBlcmZfYmVnaW4oZ3Qp
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfZW5naW5lX3Bt
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9lbmdpbmVfcG0uYwppbmRleCAy
Yzg5ODYyMmJkZmIuLjcyY2NhM2YwZGEyMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Qvc2VsZnRlc3RfZW5naW5lX3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
c2VsZnRlc3RfZW5naW5lX3BtLmMKQEAgLTE5OCw3ICsxOTgsNyBAQCBzdGF0aWMgaW50IGxpdmVf
ZW5naW5lX3RpbWVzdGFtcHModm9pZCAqYXJnKQogCSAqIHRoZSBzYW1lIENTIGNsb2NrLgogCSAq
LwogCi0JaWYgKElOVEVMX0dFTihndC0+aTkxNSkgPCA4KQorCWlmIChHUkFQSElDU19WRVIoZ3Qt
Pmk5MTUpIDwgOCkKIAkJcmV0dXJuIDA7CiAKIAlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndCwg
aWQpIHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2V4ZWNs
aXN0cy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfZXhlY2xpc3RzLmMKaW5k
ZXggMWY5MzU5MWE4YzY5Li5lYTIyMDNhZjA3NjQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3NlbGZ0ZXN0X2V4ZWNsaXN0cy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L3NlbGZ0ZXN0X2V4ZWNsaXN0cy5jCkBAIC0zMjY5LDcgKzMyNjksNyBAQCBzdGF0aWMgaW50
IGxpdmVfcHJlZW1wdF91c2VyKHZvaWQgKmFyZykKIAkJaWYgKCFpbnRlbF9lbmdpbmVfaGFzX3By
ZWVtcHRpb24oZW5naW5lKSkKIAkJCWNvbnRpbnVlOwogCi0JCWlmIChJU19HRU4oZ3QtPmk5MTUs
IDgpICYmIGVuZ2luZS0+Y2xhc3MgIT0gUkVOREVSX0NMQVNTKQorCQlpZiAoR1JBUEhJQ1NfVkVS
KGd0LT5pOTE1KSA9PSA4ICYmIGVuZ2luZS0+Y2xhc3MgIT0gUkVOREVSX0NMQVNTKQogCQkJY29u
dGludWU7IC8qIHdlIG5lZWQgcGVyLWNvbnRleHQgR1BSICovCiAKIAkJaWYgKGlndF9saXZlX3Rl
c3RfYmVnaW4oJnQsIGd0LT5pOTE1LCBfX2Z1bmNfXywgZW5naW5lLT5uYW1lKSkgewpAQCAtNDI5
Myw3ICs0MjkzLDcgQEAgc3RhdGljIGludCBsaXZlX3ZpcnR1YWxfcHJlc2VydmVkKHZvaWQgKmFy
ZykKIAkJcmV0dXJuIDA7CiAKIAkvKiBBcyB3ZSB1c2UgQ1NfR1BSIHdlIGNhbm5vdCBydW4gYmVm
b3JlIHRoZXkgZXhpc3RlZCBvbiBhbGwgZW5naW5lcy4gKi8KLQlpZiAoSU5URUxfR0VOKGd0LT5p
OTE1KSA8IDkpCisJaWYgKEdSQVBISUNTX1ZFUihndC0+aTkxNSkgPCA5KQogCQlyZXR1cm4gMDsK
IAogCWZvciAoY2xhc3MgPSAwOyBjbGFzcyA8PSBNQVhfRU5HSU5FX0NMQVNTOyBjbGFzcysrKSB7
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9ndF9wbS5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfZ3RfcG0uYwppbmRleCBjMDg0NWJmNzJk
ZDMuLmI5NDQxMjE3Y2EzZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2Vs
ZnRlc3RfZ3RfcG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9ndF9w
bS5jCkBAIC03NCwxMCArNzQsMTAgQEAgc3RhdGljIGludCBsaXZlX2d0X2Nsb2Nrcyh2b2lkICph
cmcpCiAJCXJldHVybiAwOwogCX0KIAotCWlmIChJTlRFTF9HRU4oZ3QtPmk5MTUpIDwgNCkgLyog
QW55IENTX1RJTUVTVEFNUD8gKi8KKwlpZiAoR1JBUEhJQ1NfVkVSKGd0LT5pOTE1KSA8IDQpIC8q
IEFueSBDU19USU1FU1RBTVA/ICovCiAJCXJldHVybiAwOwogCi0JaWYgKElTX0dFTihndC0+aTkx
NSwgNSkpCisJaWYgKEdSQVBISUNTX1ZFUihndC0+aTkxNSkgPT0gNSkKIAkJLyoKIAkJICogWFhY
IENTX1RJTUVTVEFNUCBsb3cgZHdvcmQgaXMgZHlzZnVuY3Rpb25hbD8KIAkJICoKQEAgLTg2LDcg
Kzg2LDcgQEAgc3RhdGljIGludCBsaXZlX2d0X2Nsb2Nrcyh2b2lkICphcmcpCiAJCSAqLwogCQly
ZXR1cm4gMDsKIAotCWlmIChJU19HRU4oZ3QtPmk5MTUsIDQpKQorCWlmIChHUkFQSElDU19WRVIo
Z3QtPmk5MTUpID09IDQpCiAJCS8qCiAJCSAqIFhYWCBDU19USU1FU1RBTVAgYXBwZWFycyBnaWJi
ZXJpc2gKIAkJICoKQEAgLTEwNSw3ICsxMDUsNyBAQCBzdGF0aWMgaW50IGxpdmVfZ3RfY2xvY2tz
KHZvaWQgKmFyZykKIAkJdTY0IHRpbWU7CiAJCXU2NCBkdDsKIAotCQlpZiAoSU5URUxfR0VOKGVu
Z2luZS0+aTkxNSkgPCA3ICYmIGVuZ2luZS0+aWQgIT0gUkNTMCkKKwkJaWYgKEdSQVBISUNTX1ZF
UihlbmdpbmUtPmk5MTUpIDwgNyAmJiBlbmdpbmUtPmlkICE9IFJDUzApCiAJCQljb250aW51ZTsK
IAogCQltZWFzdXJlX2Nsb2NrcyhlbmdpbmUsICZjeWNsZXMsICZkdCk7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hlY2suYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jCmluZGV4IDViNjNkNGRmOGM5My4uODUz
MjQ2ZmFkMDVmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9o
YW5nY2hlY2suYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hl
Y2suYwpAQCAtMTgwLDcgKzE4MCw3IEBAIGhhbmdfY3JlYXRlX3JlcXVlc3Qoc3RydWN0IGhhbmcg
KmgsIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAkJZ290byBjYW5jZWxfcnE7CiAK
IAliYXRjaCA9IGgtPmJhdGNoOwotCWlmIChJTlRFTF9HRU4oZ3QtPmk5MTUpID49IDgpIHsKKwlp
ZiAoR1JBUEhJQ1NfVkVSKGd0LT5pOTE1KSA+PSA4KSB7CiAJCSpiYXRjaCsrID0gTUlfU1RPUkVf
RFdPUkRfSU1NX0dFTjQ7CiAJCSpiYXRjaCsrID0gbG93ZXJfMzJfYml0cyhod3NfYWRkcmVzcyho
d3MsIHJxKSk7CiAJCSpiYXRjaCsrID0gdXBwZXJfMzJfYml0cyhod3NfYWRkcmVzcyhod3MsIHJx
KSk7CkBAIC0xOTQsNyArMTk0LDcgQEAgaGFuZ19jcmVhdGVfcmVxdWVzdChzdHJ1Y3QgaGFuZyAq
aCwgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCQkqYmF0Y2grKyA9IE1JX0JBVENI
X0JVRkZFUl9TVEFSVCB8IDEgPDwgOCB8IDE7CiAJCSpiYXRjaCsrID0gbG93ZXJfMzJfYml0cyh2
bWEtPm5vZGUuc3RhcnQpOwogCQkqYmF0Y2grKyA9IHVwcGVyXzMyX2JpdHModm1hLT5ub2RlLnN0
YXJ0KTsKLQl9IGVsc2UgaWYgKElOVEVMX0dFTihndC0+aTkxNSkgPj0gNikgeworCX0gZWxzZSBp
ZiAoR1JBUEhJQ1NfVkVSKGd0LT5pOTE1KSA+PSA2KSB7CiAJCSpiYXRjaCsrID0gTUlfU1RPUkVf
RFdPUkRfSU1NX0dFTjQ7CiAJCSpiYXRjaCsrID0gMDsKIAkJKmJhdGNoKysgPSBsb3dlcl8zMl9i
aXRzKGh3c19hZGRyZXNzKGh3cywgcnEpKTsKQEAgLTIwNyw3ICsyMDcsNyBAQCBoYW5nX2NyZWF0
ZV9yZXF1ZXN0KHN0cnVjdCBoYW5nICpoLCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUp
CiAJCSpiYXRjaCsrID0gTUlfTk9PUDsKIAkJKmJhdGNoKysgPSBNSV9CQVRDSF9CVUZGRVJfU1RB
UlQgfCAxIDw8IDg7CiAJCSpiYXRjaCsrID0gbG93ZXJfMzJfYml0cyh2bWEtPm5vZGUuc3RhcnQp
OwotCX0gZWxzZSBpZiAoSU5URUxfR0VOKGd0LT5pOTE1KSA+PSA0KSB7CisJfSBlbHNlIGlmIChH
UkFQSElDU19WRVIoZ3QtPmk5MTUpID49IDQpIHsKIAkJKmJhdGNoKysgPSBNSV9TVE9SRV9EV09S
RF9JTU1fR0VONCB8IE1JX1VTRV9HR1RUOwogCQkqYmF0Y2grKyA9IDA7CiAJCSpiYXRjaCsrID0g
bG93ZXJfMzJfYml0cyhod3NfYWRkcmVzcyhod3MsIHJxKSk7CkBAIC0yNDMsNyArMjQzLDcgQEAg
aGFuZ19jcmVhdGVfcmVxdWVzdChzdHJ1Y3QgaGFuZyAqaCwgc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lKQogCX0KIAogCWZsYWdzID0gMDsKLQlpZiAoSU5URUxfR0VOKGd0LT5pOTE1KSA8
PSA1KQorCWlmIChHUkFQSElDU19WRVIoZ3QtPmk5MTUpIDw9IDUpCiAJCWZsYWdzIHw9IEk5MTVf
RElTUEFUQ0hfU0VDVVJFOwogCiAJZXJyID0gcnEtPmVuZ2luZS0+ZW1pdF9iYl9zdGFydChycSwg
dm1hLT5ub2RlLnN0YXJ0LCBQQUdFX1NJWkUsIGZsYWdzKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xsYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
c2VsZnRlc3RfbGxjLmMKaW5kZXggOTQwMDZmMTE3YmJkLi40NTliNzc1ZjE2M2EgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xsYy5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xsYy5jCkBAIC00NCw3ICs0NCw3IEBAIHN0YXRpYyBp
bnQgZ2VuNl92ZXJpZnlfcmluZ19mcmVxKHN0cnVjdCBpbnRlbF9sbGMgKmxsYykKIAkJaWYgKGZv
dW5kICE9IGlhX2ZyZXEpIHsKIAkJCXByX2VycigiTWluIGZyZXEgdGFibGUoJWQvWyVkLCAlZF0p
OiVkTUh6IGRpZCBub3QgbWF0Y2ggZXhwZWN0ZWQgQ1BVIGZyZXEsIGZvdW5kICVkLCBleHBlY3Rl
ZCAlZFxuIiwKIAkJCSAgICAgICBncHVfZnJlcSwgY29uc3RzLm1pbl9ncHVfZnJlcSwgY29uc3Rz
Lm1heF9ncHVfZnJlcSwKLQkJCSAgICAgICBpbnRlbF9ncHVfZnJlcShycHMsIGdwdV9mcmVxICog
KElOVEVMX0dFTihpOTE1KSA+PSA5ID8gR0VOOV9GUkVRX1NDQUxFUiA6IDEpKSwKKwkJCSAgICAg
ICBpbnRlbF9ncHVfZnJlcShycHMsIGdwdV9mcmVxICogKEdSQVBISUNTX1ZFUihpOTE1KSA+PSA5
ID8gR0VOOV9GUkVRX1NDQUxFUiA6IDEpKSwKIAkJCSAgICAgICBmb3VuZCwgaWFfZnJlcSk7CiAJ
CQllcnIgPSAtRUlOVkFMOwogCQkJYnJlYWs7CkBAIC01NCw3ICs1NCw3IEBAIHN0YXRpYyBpbnQg
Z2VuNl92ZXJpZnlfcmluZ19mcmVxKHN0cnVjdCBpbnRlbF9sbGMgKmxsYykKIAkJaWYgKGZvdW5k
ICE9IHJpbmdfZnJlcSkgewogCQkJcHJfZXJyKCJNaW4gZnJlcSB0YWJsZSglZC9bJWQsICVkXSk6
JWRNSHogZGlkIG5vdCBtYXRjaCBleHBlY3RlZCByaW5nIGZyZXEsIGZvdW5kICVkLCBleHBlY3Rl
ZCAlZFxuIiwKIAkJCSAgICAgICBncHVfZnJlcSwgY29uc3RzLm1pbl9ncHVfZnJlcSwgY29uc3Rz
Lm1heF9ncHVfZnJlcSwKLQkJCSAgICAgICBpbnRlbF9ncHVfZnJlcShycHMsIGdwdV9mcmVxICog
KElOVEVMX0dFTihpOTE1KSA+PSA5ID8gR0VOOV9GUkVRX1NDQUxFUiA6IDEpKSwKKwkJCSAgICAg
ICBpbnRlbF9ncHVfZnJlcShycHMsIGdwdV9mcmVxICogKEdSQVBISUNTX1ZFUihpOTE1KSA+PSA5
ID8gR0VOOV9GUkVRX1NDQUxFUiA6IDEpKSwKIAkJCSAgICAgICBmb3VuZCwgcmluZ19mcmVxKTsK
IAkJCWVyciA9IC1FSU5WQUw7CiAJCQlicmVhazsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRl
c3RfbHJjLmMKaW5kZXggZDhmNjYyMzUyNGU4Li4zMTE5MDE2ZDk5MTAgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCkBAIC01ODQsNyArNTg0LDcgQEAgc3RhdGljIGludCBf
X2xpdmVfbHJjX2dwcihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCiAJaW50IGVycjsK
IAlpbnQgbjsKIAotCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA8IDkgJiYgZW5naW5lLT5j
bGFzcyAhPSBSRU5ERVJfQ0xBU1MpCisJaWYgKEdSQVBISUNTX1ZFUihlbmdpbmUtPmk5MTUpIDwg
OSAmJiBlbmdpbmUtPmNsYXNzICE9IFJFTkRFUl9DTEFTUykKIAkJcmV0dXJuIDA7IC8qIEdQUiBv
bmx5IG9uIHJjczAgZm9yIGdlbjggKi8KIAogCWVyciA9IGdwcl9tYWtlX2RpcnR5KGVuZ2luZS0+
a2VybmVsX2NvbnRleHQpOwpAQCAtMTM4OSwxMCArMTM4OSwxMCBAQCBzdGF0aWMgaW50IF9fbHJj
X2lzb2xhdGlvbihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHUzMiBwb2lzb24pCiAK
IHN0YXRpYyBib29sIHNraXBfaXNvbGF0aW9uKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSkKIHsKLQlpZiAoZW5naW5lLT5jbGFzcyA9PSBDT1BZX0VOR0lORV9DTEFTUyAmJiBJ
TlRFTF9HRU4oZW5naW5lLT5pOTE1KSA9PSA5KQorCWlmIChlbmdpbmUtPmNsYXNzID09IENPUFlf
RU5HSU5FX0NMQVNTICYmIEdSQVBISUNTX1ZFUihlbmdpbmUtPmk5MTUpID09IDkpCiAJCXJldHVy
biB0cnVlOwogCi0JaWYgKGVuZ2luZS0+Y2xhc3MgPT0gUkVOREVSX0NMQVNTICYmIElOVEVMX0dF
TihlbmdpbmUtPmk5MTUpID09IDExKQorCWlmIChlbmdpbmUtPmNsYXNzID09IFJFTkRFUl9DTEFT
UyAmJiBHUkFQSElDU19WRVIoZW5naW5lLT5pOTE1KSA9PSAxMSkKIAkJcmV0dXJuIHRydWU7CiAK
IAlyZXR1cm4gZmFsc2U7CkBAIC0xNTUxLDcgKzE1NTEsNyBAQCBzdGF0aWMgaW50IF9fbGl2ZV9s
cmNfaW5kaXJlY3RfY3R4X2JiKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAkvKiBX
ZSB1c2UgdGhlIGFscmVhZHkgcmVzZXJ2ZWQgZXh0cmEgcGFnZSBpbiBjb250ZXh0IHN0YXRlICov
CiAJaWYgKCFhLT53YV9iYl9wYWdlKSB7CiAJCUdFTV9CVUdfT04oYi0+d2FfYmJfcGFnZSk7Ci0J
CUdFTV9CVUdfT04oSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPT0gMTIpOworCQlHRU1fQlVHX09O
KEdSQVBISUNTX1ZFUihlbmdpbmUtPmk5MTUpID09IDEyKTsKIAkJZ290byB1bnBpbl9iOwogCX0K
IApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbW9jcy5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbW9jcy5jCmluZGV4IGU1NWE4ODdkMTFl
Mi4uYjliYjBlNmU5N2Y3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxm
dGVzdF9tb2NzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbW9jcy5j
CkBAIC0xODMsNyArMTgzLDcgQEAgc3RhdGljIGJvb2wgbWNyX3JhbmdlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LCB1MzIgb2Zmc2V0KQogCSAqIHdoaWNoIG9ubHkgY29udHJvbHMgQ1BV
IGluaXRpYXRlZCBNTUlPLiBSb3V0aW5nIGRvZXMgbm90CiAJICogd29yayBmb3IgQ1MgYWNjZXNz
IHNvIHdlIGNhbm5vdCB2ZXJpZnkgdGhlbSBvbiB0aGlzIHBhdGguCiAJICovCi0JcmV0dXJuIElO
VEVMX0dFTihpOTE1KSA+PSA4ICYmIG9mZnNldCA+PSAweGIwMDAgJiYgb2Zmc2V0IDw9IDB4YjRm
ZjsKKwlyZXR1cm4gR1JBUEhJQ1NfVkVSKGk5MTUpID49IDggJiYgb2Zmc2V0ID49IDB4YjAwMCAm
JiBvZmZzZXQgPD0gMHhiNGZmOwogfQogCiBzdGF0aWMgaW50IGNoZWNrX2wzY2NfdGFibGUoc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Qvc2VsZnRlc3RfcmM2LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVz
dF9yYzYuYwppbmRleCA3MTBmODI1ZjZlNWEuLjhjNzBiN2UxMjA3NCAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfcmM2LmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Qvc2VsZnRlc3RfcmM2LmMKQEAgLTE0MCw3ICsxNDAsNyBAQCBzdGF0aWMgY29uc3Qg
dTMyICpfX2xpdmVfcmM2X2N0eChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCiAJfQogCiAJY21k
ID0gTUlfU1RPUkVfUkVHSVNURVJfTUVNIHwgTUlfVVNFX0dHVFQ7Ci0JaWYgKElOVEVMX0dFTihy
cS0+ZW5naW5lLT5pOTE1KSA+PSA4KQorCWlmIChHUkFQSElDU19WRVIocnEtPmVuZ2luZS0+aTkx
NSkgPj0gOCkKIAkJY21kKys7CiAKIAkqY3MrKyA9IGNtZDsKQEAgLTE5Myw3ICsxOTMsNyBAQCBp
bnQgbGl2ZV9yYzZfY3R4X3dhKHZvaWQgKmFyZykKIAlpbnQgZXJyID0gMDsKIAogCS8qIEEgcmVh
ZCBvZiBDVFhfSU5GTyB1cHNldHMgcmM2LiBQb2tlIHRoZSBiZWFyISAqLwotCWlmIChJTlRFTF9H
RU4oZ3QtPmk5MTUpIDwgOCkKKwlpZiAoR1JBUEhJQ1NfVkVSKGd0LT5pOTE1KSA8IDgpCiAJCXJl
dHVybiAwOwogCiAJZW5naW5lcyA9IHJhbmRvbWlzZWRfZW5naW5lcyhndCwgJnBybmcsICZjb3Vu
dCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9yaW5nX3N1
Ym1pc3Npb24uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3Jpbmdfc3VibWlz
c2lvbi5jCmluZGV4IGMxMmU3NDE3MWI2My4uMDQxOTU0NDA4ZDBmIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9yaW5nX3N1Ym1pc3Npb24uYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9yaW5nX3N1Ym1pc3Npb24uYwpAQCAtNDEsMTAg
KzQxLDEwIEBAIHN0YXRpYyBzdHJ1Y3QgaTkxNV92bWEgKmNyZWF0ZV93YWxseShzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJCXJldHVybiBFUlJfQ0FTVChjcyk7CiAJfQogCi0JaWYg
KElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDYpIHsKKwlpZiAoR1JBUEhJQ1NfVkVSKGVuZ2lu
ZS0+aTkxNSkgPj0gNikgewogCQkqY3MrKyA9IE1JX1NUT1JFX0RXT1JEX0lNTV9HRU40OwogCQkq
Y3MrKyA9IDA7Ci0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSA0KSB7CisJ
fSBlbHNlIGlmIChHUkFQSElDU19WRVIoZW5naW5lLT5pOTE1KSA+PSA0KSB7CiAJCSpjcysrID0g
TUlfU1RPUkVfRFdPUkRfSU1NX0dFTjQgfCBNSV9VU0VfR0dUVDsKIAkJKmNzKysgPSAwOwogCX0g
ZWxzZSB7CkBAIC0yNjYsNyArMjY2LDcgQEAgc3RhdGljIGludCBsaXZlX2N0eF9zd2l0Y2hfd2Eo
dm9pZCAqYXJnKQogCQlpZiAoIWludGVsX2VuZ2luZV9jYW5fc3RvcmVfZHdvcmQoZW5naW5lKSkK
IAkJCWNvbnRpbnVlOwogCi0JCWlmIChJU19HRU5fUkFOR0UoZ3QtPmk5MTUsIDQsIDUpKQorCQlp
ZiAoSVNfR1JBUEhJQ1NfVkVSKGd0LT5pOTE1LCA0LCA1KSkKIAkJCWNvbnRpbnVlOyAvKiBNSV9T
VE9SRV9EV09SRCBpcyBwcml2aWxlZ2VkISAqLwogCiAJCXNhdmVkX3dhID0gZmV0Y2hfYW5kX3pl
cm8oJmVuZ2luZS0+d2FfY3R4LnZtYSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9zZWxmdGVzdF9ycHMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3Jw
cy5jCmluZGV4IDNjYTFiZDU3OTNjMy4uN2VlMjUxM2UxNWY5IDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9ycHMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9zZWxmdGVzdF9ycHMuYwpAQCAtMjA0LDcgKzIwNCw3IEBAIHN0YXRpYyB2b2lkIHNob3df
cHN0YXRlX2xpbWl0cyhzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCiAJCQlpOTE1X21taW9fcmVnX29m
ZnNldChCWFRfUlBfU1RBVEVfQ0FQKSwKIAkJCWludGVsX3VuY29yZV9yZWFkKHJwc190b191bmNv
cmUocnBzKSwKIAkJCQkJICBCWFRfUlBfU1RBVEVfQ0FQKSk7Ci0JfSBlbHNlIGlmIChJU19HRU4o
aTkxNSwgOSkpIHsKKwl9IGVsc2UgaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA9PSA5KSB7CiAJCXBy
X2luZm8oIlBfU1RBVEVfTElNSVRTWyV4XTogMHglMDh4XG4iLAogCQkJaTkxNV9tbWlvX3JlZ19v
ZmZzZXQoR0VOOV9SUF9TVEFURV9MSU1JVFMpLAogCQkJaW50ZWxfdW5jb3JlX3JlYWQocnBzX3Rv
X3VuY29yZShycHMpLApAQCAtMjIyLDcgKzIyMiw3IEBAIGludCBsaXZlX3Jwc19jbG9ja19pbnRl
cnZhbCh2b2lkICphcmcpCiAJc3RydWN0IGlndF9zcGlubmVyIHNwaW47CiAJaW50IGVyciA9IDA7
CiAKLQlpZiAoIWludGVsX3Jwc19pc19lbmFibGVkKHJwcykgfHwgSU5URUxfR0VOKGd0LT5pOTE1
KSA8IDYpCisJaWYgKCFpbnRlbF9ycHNfaXNfZW5hYmxlZChycHMpIHx8IEdSQVBISUNTX1ZFUihn
dC0+aTkxNSkgPCA2KQogCQlyZXR1cm4gMDsKIAogCWlmIChpZ3Rfc3Bpbm5lcl9pbml0KCZzcGlu
LCBndCkpCkBAIC01MDYsNyArNTA2LDcgQEAgc3RhdGljIHZvaWQgc2hvd19wY3VfY29uZmlnKHN0
cnVjdCBpbnRlbF9ycHMgKnJwcykKIAogCW1pbl9ncHVfZnJlcSA9IHJwcy0+bWluX2ZyZXE7CiAJ
bWF4X2dwdV9mcmVxID0gcnBzLT5tYXhfZnJlcTsKLQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkp
IHsKKwlpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpID49IDkpIHsKIAkJLyogQ29udmVydCBHVCBmcmVx
dWVuY3kgdG8gNTAgSFogdW5pdHMgKi8KIAkJbWluX2dwdV9mcmVxIC89IEdFTjlfRlJFUV9TQ0FM
RVI7CiAJCW1heF9ncHVfZnJlcSAvPSBHRU45X0ZSRVFfU0NBTEVSOwpAQCAtNjE0LDcgKzYxNCw3
IEBAIGludCBsaXZlX3Jwc19mcmVxdWVuY3lfY3Modm9pZCAqYXJnKQogCWlmICghaW50ZWxfcnBz
X2lzX2VuYWJsZWQocnBzKSkKIAkJcmV0dXJuIDA7CiAKLQlpZiAoSU5URUxfR0VOKGd0LT5pOTE1
KSA8IDgpIC8qIGZvciBDUyBzaW1wbGljaXR5ICovCisJaWYgKEdSQVBISUNTX1ZFUihndC0+aTkx
NSkgPCA4KSAvKiBmb3IgQ1Mgc2ltcGxpY2l0eSAqLwogCQlyZXR1cm4gMDsKIAogCWlmIChDUFVf
TEFURU5DWSA+PSAwKQpAQCAtNzU1LDcgKzc1NSw3IEBAIGludCBsaXZlX3Jwc19mcmVxdWVuY3lf
c3JtKHZvaWQgKmFyZykKIAlpZiAoIWludGVsX3Jwc19pc19lbmFibGVkKHJwcykpCiAJCXJldHVy
biAwOwogCi0JaWYgKElOVEVMX0dFTihndC0+aTkxNSkgPCA4KSAvKiBmb3IgQ1Mgc2ltcGxpY2l0
eSAqLworCWlmIChHUkFQSElDU19WRVIoZ3QtPmk5MTUpIDwgOCkgLyogZm9yIENTIHNpbXBsaWNp
dHkgKi8KIAkJcmV0dXJuIDA7CiAKIAlpZiAoQ1BVX0xBVEVOQ1kgPj0gMCkKQEAgLTEwMzEsNyAr
MTAzMSw3IEBAIGludCBsaXZlX3Jwc19pbnRlcnJ1cHQodm9pZCAqYXJnKQogCSAqIEZpcnN0LCBs
ZXQncyBjaGVjayB3aGV0aGVyIG9yIG5vdCB3ZSBhcmUgcmVjZWl2aW5nIGludGVycnVwdHMuCiAJ
ICovCiAKLQlpZiAoIWludGVsX3Jwc19oYXNfaW50ZXJydXB0cyhycHMpIHx8IElOVEVMX0dFTihn
dC0+aTkxNSkgPCA2KQorCWlmICghaW50ZWxfcnBzX2hhc19pbnRlcnJ1cHRzKHJwcykgfHwgR1JB
UEhJQ1NfVkVSKGd0LT5pOTE1KSA8IDYpCiAJCXJldHVybiAwOwogCiAJaW50ZWxfZ3RfcG1fZ2V0
KGd0KTsKQEAgLTExMzYsNyArMTEzNiw3IEBAIGludCBsaXZlX3Jwc19wb3dlcih2b2lkICphcmcp
CiAJICogdGhhdCB0aGVvcnkuCiAJICovCiAKLQlpZiAoIWludGVsX3Jwc19pc19lbmFibGVkKHJw
cykgfHwgSU5URUxfR0VOKGd0LT5pOTE1KSA8IDYpCisJaWYgKCFpbnRlbF9ycHNfaXNfZW5hYmxl
ZChycHMpIHx8IEdSQVBISUNTX1ZFUihndC0+aTkxNSkgPCA2KQogCQlyZXR1cm4gMDsKIAogCWlm
ICghbGlicmFwbF9zdXBwb3J0ZWQoZ3QtPmk5MTUpKQpAQCAtMTI0MCw3ICsxMjQwLDcgQEAgaW50
IGxpdmVfcnBzX2R5bmFtaWModm9pZCAqYXJnKQogCSAqIG1vdmluZyBwYXJ0cyBpbnRvIGR5bmFt
aWMgcmVjbG9ja2luZyBiYXNlZCBvbiBsb2FkLgogCSAqLwogCi0JaWYgKCFpbnRlbF9ycHNfaXNf
ZW5hYmxlZChycHMpIHx8IElOVEVMX0dFTihndC0+aTkxNSkgPCA2KQorCWlmICghaW50ZWxfcnBz
X2lzX2VuYWJsZWQocnBzKSB8fCBHUkFQSElDU19WRVIoZ3QtPmk5MTUpIDwgNikKIAkJcmV0dXJu
IDA7CiAKIAlpZiAoaWd0X3NwaW5uZXJfaW5pdCgmc3BpbiwgZ3QpKQpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfdGltZWxpbmUuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3NlbGZ0ZXN0X3RpbWVsaW5lLmMKaW5kZXggOWFkYmQ5ZDE0N2JlLi42NGRhMGM5
MWRlYzEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3RpbWVs
aW5lLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfdGltZWxpbmUuYwpA
QCAtNDU3LDEyICs0NTcsMTIgQEAgc3RhdGljIGludCBlbWl0X2dndHRfc3RvcmVfZHcoc3RydWN0
IGk5MTVfcmVxdWVzdCAqcnEsIHUzMiBhZGRyLCB1MzIgdmFsdWUpCiAJaWYgKElTX0VSUihjcykp
CiAJCXJldHVybiBQVFJfRVJSKGNzKTsKIAotCWlmIChJTlRFTF9HRU4ocnEtPmVuZ2luZS0+aTkx
NSkgPj0gOCkgeworCWlmIChHUkFQSElDU19WRVIocnEtPmVuZ2luZS0+aTkxNSkgPj0gOCkgewog
CQkqY3MrKyA9IE1JX1NUT1JFX0RXT1JEX0lNTV9HRU40IHwgTUlfVVNFX0dHVFQ7CiAJCSpjcysr
ID0gYWRkcjsKIAkJKmNzKysgPSAwOwogCQkqY3MrKyA9IHZhbHVlOwotCX0gZWxzZSBpZiAoSU5U
RUxfR0VOKHJxLT5lbmdpbmUtPmk5MTUpID49IDQpIHsKKwl9IGVsc2UgaWYgKEdSQVBISUNTX1ZF
UihycS0+ZW5naW5lLT5pOTE1KSA+PSA0KSB7CiAJCSpjcysrID0gTUlfU1RPUkVfRFdPUkRfSU1N
X0dFTjQgfCBNSV9VU0VfR0dUVDsKIAkJKmNzKysgPSAwOwogCQkqY3MrKyA9IGFkZHI7CkBAIC05
OTIsNyArOTkyLDcgQEAgc3RhdGljIGludCBsaXZlX2h3c3BfcmVhZCh2b2lkICphcmcpCiAJICog
ZXZlbiBhY3Jvc3MgbXVsdGlwbGUgd3JhcHMuCiAJICovCiAKLQlpZiAoSU5URUxfR0VOKGd0LT5p
OTE1KSA8IDgpIC8qIENTIGNvbnZlbmllbmNlIFtTUk0vTFJNXSAqLworCWlmIChHUkFQSElDU19W
RVIoZ3QtPmk5MTUpIDwgOCkgLyogQ1MgY29udmVuaWVuY2UgW1NSTS9MUk1dICovCiAJCXJldHVy
biAwOwogCiAJdGwgPSBpbnRlbF90aW1lbGluZV9jcmVhdGUoZ3QpOwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rfd29ya2Fyb3VuZHMuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMKaW5kZXggNjQ5MzdlYzNmMmRjLi5j
MzA3NTRkYWY0YjEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0
X3dvcmthcm91bmRzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rfd29y
a2Fyb3VuZHMuYwpAQCAtMTQ1LDcgKzE0NSw3IEBAIHJlYWRfbm9ucHJpdnMoc3RydWN0IGludGVs
X2NvbnRleHQgKmNlKQogCQlnb3RvIGVycl9yZXE7CiAKIAlzcm0gPSBNSV9TVE9SRV9SRUdJU1RF
Ul9NRU0gfCBNSV9TUk1fTFJNX0dMT0JBTF9HVFQ7Ci0JaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5
MTUpID49IDgpCisJaWYgKEdSQVBISUNTX1ZFUihlbmdpbmUtPmk5MTUpID49IDgpCiAJCXNybSsr
OwogCiAJY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJxLCA0ICogUklOR19NQVhfTk9OUFJJVl9TTE9U
Uyk7CkBAIC01NDYsNyArNTQ2LDcgQEAgc3RhdGljIGludCBjaGVja19kaXJ0eV93aGl0ZWxpc3Qo
c3RydWN0IGludGVsX2NvbnRleHQgKmNlKQogCiAJCXNybSA9IE1JX1NUT1JFX1JFR0lTVEVSX01F
TTsKIAkJbHJtID0gTUlfTE9BRF9SRUdJU1RFUl9NRU07Ci0JCWlmIChJTlRFTF9HRU4oZW5naW5l
LT5pOTE1KSA+PSA4KQorCQlpZiAoR1JBUEhJQ1NfVkVSKGVuZ2luZS0+aTkxNSkgPj0gOCkKIAkJ
CWxybSsrLCBzcm0rKzsKIAogCQlwcl9kZWJ1ZygiJXM6IFdyaXRpbmcgZ2FyYmFnZSB0byAleFxu
IiwKQEAgLTc0OSw3ICs3NDksNyBAQCBzdGF0aWMgaW50IGxpdmVfZGlydHlfd2hpdGVsaXN0KHZv
aWQgKmFyZykKIAogCS8qIENhbiB0aGUgdXNlciB3cml0ZSB0byB0aGUgd2hpdGVsaXN0ZWQgcmVn
aXN0ZXJzPyAqLwogCi0JaWYgKElOVEVMX0dFTihndC0+aTkxNSkgPCA3KSAvKiBtaW5pbXVtIHJl
cXVpcmVtZW50IGZvciBMUkksIFNSTSwgTFJNICovCisJaWYgKEdSQVBISUNTX1ZFUihndC0+aTkx
NSkgPCA3KSAvKiBtaW5pbXVtIHJlcXVpcmVtZW50IGZvciBMUkksIFNSTSwgTFJNICovCiAJCXJl
dHVybiAwOwogCiAJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7CkBAIC04MjksNyAr
ODI5LDcgQEAgc3RhdGljIGludCByZWFkX3doaXRlbGlzdGVkX3JlZ2lzdGVycyhzdHJ1Y3QgaW50
ZWxfY29udGV4dCAqY2UsCiAJCWdvdG8gZXJyX3JlcTsKIAogCXNybSA9IE1JX1NUT1JFX1JFR0lT
VEVSX01FTTsKLQlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gOCkKKwlpZiAoR1JBUEhJ
Q1NfVkVSKGVuZ2luZS0+aTkxNSkgPj0gOCkKIAkJc3JtKys7CiAKIAljcyA9IGludGVsX3Jpbmdf
YmVnaW4ocnEsIDQgKiBlbmdpbmUtPndoaXRlbGlzdC5jb3VudCk7CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L3VjL2ludGVsX2d1Yy5jCmluZGV4IGZjZmE0ZmQ5Mzg0MS4uZjE0N2NiMzg5YTIwIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWMuYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWMuYwpAQCAtMTYwLDcgKzE2MCw3IEBAIHZv
aWQgaW50ZWxfZ3VjX2luaXRfZWFybHkoc3RydWN0IGludGVsX2d1YyAqZ3VjKQogCiAJbXV0ZXhf
aW5pdCgmZ3VjLT5zZW5kX211dGV4KTsKIAlzcGluX2xvY2tfaW5pdCgmZ3VjLT5pcnFfbG9jayk7
Ci0JaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkgeworCWlmIChHUkFQSElDU19WRVIoaTkxNSkg
Pj0gMTEpIHsKIAkJZ3VjLT5ub3RpZnlfcmVnID0gR0VOMTFfR1VDX0hPU1RfSU5URVJSVVBUOwog
CQlndWMtPmludGVycnVwdHMucmVzZXQgPSBnZW4xMV9yZXNldF9ndWNfaW50ZXJydXB0czsKIAkJ
Z3VjLT5pbnRlcnJ1cHRzLmVuYWJsZSA9IGdlbjExX2VuYWJsZV9ndWNfaW50ZXJydXB0czsKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19hZHMuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19hZHMuYwppbmRleCBlZmRjZTMwOWI2
ZjEuLjlhYmZiYzZlZGJkNiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMv
aW50ZWxfZ3VjX2Fkcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1
Y19hZHMuYwpAQCAtMTY2LDcgKzE2Niw3IEBAIHN0YXRpYyB2b2lkIF9fZ3VjX2Fkc19pbml0KHN0
cnVjdCBpbnRlbF9ndWMgKmd1YykKIAlibG9iLT5zeXN0ZW1faW5mby5nZW5lcmljX2d0X3N5c2lu
Zm9bR1VDX0dFTkVSSUNfR1RfU1lTSU5GT19WREJPWF9TRkNfU1VQUE9SVF9NQVNLXSA9CiAJCWd0
LT5pbmZvLnZkYm94X3NmY19hY2Nlc3M7CiAKLQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDEyICYm
ICFJU19ER0ZYKGk5MTUpKSB7CisJaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA+PSAxMiAmJiAhSVNf
REdGWChpOTE1KSkgewogCQl1MzIgZGlzdGRicmVnID0gaW50ZWxfdW5jb3JlX3JlYWQoZ3QtPnVu
Y29yZSwKIAkJCQkJCSAgR0VOMTJfRElTVF9EQlNfUE9QVUxBVEVEKTsKIAkJYmxvYi0+c3lzdGVt
X2luZm8uZ2VuZXJpY19ndF9zeXNpbmZvW0dVQ19HRU5FUklDX0dUX1NZU0lORk9fRE9PUkJFTExf
Q09VTlRfUEVSX1NRSURJXSA9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91
Yy9pbnRlbF9ndWNfZncuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19m
dy5jCmluZGV4IDIyNzBkNmIzYjI3Mi4uNzZmZTc2NmFkMWJjIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfZncuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC91Yy9pbnRlbF9ndWNfZncuYwpAQCAtMzAsNyArMzAsNyBAQCBzdGF0aWMgdm9pZCBn
dWNfcHJlcGFyZV94ZmVyKHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSkKIAllbHNlCiAJCWlu
dGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjlfR1RfUE1fQ09ORklHLCBHVF9ET09SQkVMTF9F
TkFCTEUpOwogCi0JaWYgKElTX0dFTih1bmNvcmUtPmk5MTUsIDkpKSB7CisJaWYgKEdSQVBISUNT
X1ZFUih1bmNvcmUtPmk5MTUpID09IDkpIHsKIAkJLyogRE9QIENsb2NrIEdhdGluZyBFbmFibGUg
Zm9yIEd1QyBjbG9ja3MgKi8KIAkJaW50ZWxfdW5jb3JlX3Jtdyh1bmNvcmUsIEdFTjdfTUlTQ0NQ
Q1RMLAogCQkJCSAwLCBHRU44X0RPUF9DTE9DS19HQVRFX0dVQ19FTkFCTEUpOwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9uLmMKaW5kZXggMzhj
ZGE1ZDU5OWE2Li43YzhmZjk3OTJmN2IgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9uLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvdWMvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYwpAQCAtNjIyLDcgKzYyMiw3IEBAIHN0YXRpYyB2
b2lkIGd1Y19kZWZhdWx0X3ZmdW5jcyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJ
ZW5naW5lLT5lbWl0X2ZsdXNoID0gZ2VuOF9lbWl0X2ZsdXNoX3hjczsKIAllbmdpbmUtPmVtaXRf
aW5pdF9icmVhZGNydW1iID0gZ2VuOF9lbWl0X2luaXRfYnJlYWRjcnVtYjsKIAllbmdpbmUtPmVt
aXRfZmluaV9icmVhZGNydW1iID0gZ2VuOF9lbWl0X2ZpbmlfYnJlYWRjcnVtYl94Y3M7Ci0JaWYg
KElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDEyKSB7CisJaWYgKEdSQVBISUNTX1ZFUihlbmdp
bmUtPmk5MTUpID49IDEyKSB7CiAJCWVuZ2luZS0+ZW1pdF9maW5pX2JyZWFkY3J1bWIgPSBnZW4x
Ml9lbWl0X2ZpbmlfYnJlYWRjcnVtYl94Y3M7CiAJCWVuZ2luZS0+ZW1pdF9mbHVzaCA9IGdlbjEy
X2VtaXRfZmx1c2hfeGNzOwogCX0KQEAgLTY0NCw3ICs2NDQsNyBAQCBzdGF0aWMgdm9pZCBndWNf
ZGVmYXVsdF92ZnVuY3Moc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCiBzdGF0aWMg
dm9pZCByY3Nfc3VibWlzc2lvbl9vdmVycmlkZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpCiB7Ci0Jc3dpdGNoIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSkgeworCXN3aXRjaCAoR1JB
UEhJQ1NfVkVSKGVuZ2luZS0+aTkxNSkpIHsKIAljYXNlIDEyOgogCQllbmdpbmUtPmVtaXRfZmx1
c2ggPSBnZW4xMl9lbWl0X2ZsdXNoX3JjczsKIAkJZW5naW5lLT5lbWl0X2ZpbmlfYnJlYWRjcnVt
YiA9IGdlbjEyX2VtaXRfZmluaV9icmVhZGNydW1iX3JjczsKQEAgLTY3NCw3ICs2NzQsNyBAQCBp
bnQgaW50ZWxfZ3VjX3N1Ym1pc3Npb25fc2V0dXAoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lKQogCSAqIFRoZSBzZXR1cCByZWxpZXMgb24gc2V2ZXJhbCBhc3N1bXB0aW9ucyAoZS5nLiBp
cnFzIGFsd2F5cyBlbmFibGVkKQogCSAqIHRoYXQgYXJlIG9ubHkgdmFsaWQgb24gZ2VuMTErCiAJ
ICovCi0JR0VNX0JVR19PTihJTlRFTF9HRU4oaTkxNSkgPCAxMSk7CisJR0VNX0JVR19PTihHUkFQ
SElDU19WRVIoaTkxNSkgPCAxMSk7CiAKIAl0YXNrbGV0X3NldHVwKCZlbmdpbmUtPmV4ZWNsaXN0
cy50YXNrbGV0LCBndWNfc3VibWlzc2lvbl90YXNrbGV0KTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfaHVjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC91Yy9pbnRlbF9odWMuYwppbmRleCA1NmQyMTQ0ZGM2YTAuLmZjNTM4N2I0MTBhMiAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfaHVjLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfaHVjLmMKQEAgLTQzLDcgKzQzLDcgQEAgdm9pZCBp
bnRlbF9odWNfaW5pdF9lYXJseShzdHJ1Y3QgaW50ZWxfaHVjICpodWMpCiAKIAlpbnRlbF91Y19m
d19pbml0X2Vhcmx5KCZodWMtPmZ3LCBJTlRFTF9VQ19GV19UWVBFX0hVQyk7CiAKLQlpZiAoSU5U
RUxfR0VOKGk5MTUpID49IDExKSB7CisJaWYgKEdSQVBISUNTX1ZFUihpOTE1KSA+PSAxMSkgewog
CQlodWMtPnN0YXR1cy5yZWcgPSBHRU4xMV9IVUNfS0VSTkVMX0xPQURfSU5GTzsKIAkJaHVjLT5z
dGF0dXMubWFzayA9IEhVQ19MT0FEX1NVQ0NFU1NGVUw7CiAJCWh1Yy0+c3RhdHVzLnZhbHVlID0g
SFVDX0xPQURfU1VDQ0VTU0ZVTDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L3VjL2ludGVsX3VjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF91Yy5jCmlu
ZGV4IGFiMDc4OWQ2NmUwNi4uNmQ4YjkyMzMyMTRlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC91Yy9pbnRlbF91Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3Vj
L2ludGVsX3VjLmMKQEAgLTIzLDcgKzIzLDcgQEAgc3RhdGljIHZvaWQgdWNfZXhwYW5kX2RlZmF1
bHRfb3B0aW9ucyhzdHJ1Y3QgaW50ZWxfdWMgKnVjKQogCQlyZXR1cm47CiAKIAkvKiBEb24ndCBl
bmFibGUgR3VDL0h1QyBvbiBwcmUtR2VuMTIgKi8KLQlpZiAoSU5URUxfR0VOKGk5MTUpIDwgMTIp
IHsKKwlpZiAoR1JBUEhJQ1NfVkVSKGk5MTUpIDwgMTIpIHsKIAkJaTkxNS0+cGFyYW1zLmVuYWJs
ZV9ndWMgPSAwOwogCQlyZXR1cm47CiAJfQpAQCAtNDY3LDcgKzQ2Nyw3IEBAIHN0YXRpYyBpbnQg
X191Y19pbml0X2h3KHN0cnVjdCBpbnRlbF91YyAqdWMpCiAKIAkvKiBXYUVuYWJsZXVLZXJuZWxI
ZWFkZXJWYWxpZEZpeDpza2wgKi8KIAkvKiBXYUVuYWJsZUd1Q0Jvb3RIYXNoQ2hlY2tOb3RTZXQ6
c2tsLGJ4dCxrYmwgKi8KLQlpZiAoSVNfR0VOKGk5MTUsIDkpKQorCWlmIChHUkFQSElDU19WRVIo
aTkxNSkgPT0gOSkKIAkJYXR0ZW1wdHMgPSAzOwogCWVsc2UKIAkJYXR0ZW1wdHMgPSAxOwotLSAK
Mi4zMS4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJ
bnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0
cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZngK

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 6C96414580
	for <lists+intel-gfx@lfdr.de>; Mon,  6 May 2019 09:46:04 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8BCAE89115;
	Mon,  6 May 2019 07:46:02 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mail-ed1-x541.google.com (mail-ed1-x541.google.com
 [IPv6:2a00:1450:4864:20::541])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 169DD89115
 for <intel-gfx@lists.freedesktop.org>; Mon,  6 May 2019 07:46:01 +0000 (UTC)
Received: by mail-ed1-x541.google.com with SMTP id f37so14216671edb.13
 for <intel-gfx@lists.freedesktop.org>; Mon, 06 May 2019 00:46:01 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=04n4bi/0il+bPmWqsIQ2e+x6fvuMJP2MziNsJbLuWN4=;
 b=HdLCuP4CK8kdsGDTp7GKoxgw/Gkt611I8ZC6e3bqbHsYuAoy4UUDG9XsWs+RJ02EHU
 TBUseOCUf7evM2HA3nYVHQEkrL0ze8sabLIU+zmMlCNSM6Kb920SsEWCAB5SmnA129aL
 JhZdUmk0ncH2prKamudOwBGx78AgRKpDl3Ik56ff1hgw/jlyVMn8DQi53BU4QH1Uk1rm
 it9vh5GefyVp85VXOtOK4R6/xik0fg1bdlnZCwRJUXGs79vq7JRzTeqdZSoZlgmilJ+L
 DsMqNa+S79mJSZtxPxDEMlm8uKdhAzY+l2iVXMKWoOwoZRQu4NxtlWOiHQKf6awXb0hw
 CTmw==
X-Gm-Message-State: APjAAAXrSmvaLsiop4IZ4J+mMJ4acW2Y9XJSPU+xp+PTsE0jxLbZp9Wh
 MdQT38VxBaD2KO9G8ZD4MevsVCpe6Ro=
X-Google-Smtp-Source: APXvYqzon9mPPFB9xFLuZ56pH3fApyh6Ek73kjZdssOe6Nvobk9Y3fKvc1cQgXfVibqPEzhGE6bNeA==
X-Received: by 2002:a50:8bbb:: with SMTP id m56mr24893171edm.230.1557128759478; 
 Mon, 06 May 2019 00:45:59 -0700 (PDT)
Received: from phenom.ffwll.local ([2a02:168:569e:0:3106:d637:d723:e855])
 by smtp.gmail.com with ESMTPSA id z11sm1451872ejo.45.2019.05.06.00.45.58
 (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
 Mon, 06 May 2019 00:45:58 -0700 (PDT)
From: Daniel Vetter <daniel.vetter@ffwll.ch>
To: Intel Graphics Development <intel-gfx@lists.freedesktop.org>
Date: Mon,  6 May 2019 09:45:53 +0200
Message-Id: <20190506074553.21464-1-daniel.vetter@ffwll.ch>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190502141643.21080-1-daniel.vetter@ffwll.ch>
References: <20190502141643.21080-1-daniel.vetter@ffwll.ch>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ffwll.ch; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=04n4bi/0il+bPmWqsIQ2e+x6fvuMJP2MziNsJbLuWN4=;
 b=g+Rj6lZOq58m6EpuhkaGKAgELBYFqZayO0UVs6XuXjcKuZ9wZW696L0FAvqpvsC3Sz
 5LdY6QKVhDTtVGSkx4p7OhAoLS9tQxxHKqNASJ6XRM523im0HjxD4QMpKJJbxL6qls2A
 COWjAYliGJcM4AvajlOKV2UoIpFu9r95F/qBI=
Subject: [Intel-gfx] [PATCH] RFC: console: hack up console_lock more v2
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Petr Mladek <pmladek@suse.com>, John Ogness <john.ogness@linutronix.de>,
 Peter Zijlstra <peterz@infradead.org>, Daniel Vetter <daniel.vetter@ffwll.ch>,
 Will Deacon <will.deacon@arm.com>, linux-kernel@vger.kernel.org,
 Steven Rostedt <rostedt@goodmis.org>,
 Sergey Senozhatsky <sergey.senozhatsky@gmail.com>,
 Ingo Molnar <mingo@redhat.com>, Daniel Vetter <daniel.vetter@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Y29uc29sZV90cnlsb2NrLCBjYWxsZWQgZnJvbSB3aXRoaW4gcHJpbnRrLCBjYW4gYmUgY2FsbGVk
IGZyb20gcHJldHR5Cm11Y2ggYW55d2hlcmUuIEluY2x1ZGluZyB0cnlfdG9fd2FrZV91cC4gTm90
ZSB0aGF0IHRoaXMgaXNuJ3QgY29tbW9uLAp1c3VhbGx5IHRoZSBib3ggaXMgaW4gcHJldHR5IGJh
ZCBzaGFwZSBhdCB0aGF0IHBvaW50IGFscmVhZHkuIEJ1dCBpdApyZWFsbHkgZG9lc24ndCBoZWxw
IHdoZW4gdGhlbiBsb2NrZGVwIGp1bXBzIGluIGFuZCBzcGFtcyB0aGUgbG9ncywKcG90ZW50aWFs
bHkgb2JzY3VyaW5nIHRoZSByZWFsIGJhY2t0cmFjZSB3ZSdyZSByZWFsbHkgaW50ZXJlc3RlZCBp
bi4KT25lIGNhc2UgSSd2ZSBzZWVuIChzbGlnaHRseSBzaW1wbGlmaWVkIGJhY2t0cmFjZSk6Cgog
Q2FsbCBUcmFjZToKICA8SVJRPgogIGNvbnNvbGVfdHJ5bG9jaysweGUvMHg2MAogIHZwcmludGtf
ZW1pdCsweGYxLzB4MzIwCiAgcHJpbnRrKzB4NGQvMHg2OQogIF9fd2Fybl9wcmludGsrMHg0Ni8w
eDkwCiAgbmF0aXZlX3NtcF9zZW5kX3Jlc2NoZWR1bGUrMHgyZi8weDQwCiAgY2hlY2tfcHJlZW1w
dF9jdXJyKzB4ODEvMHhhMAogIHR0d3VfZG9fd2FrZXVwKzB4MTQvMHgyMjAKICB0cnlfdG9fd2Fr
ZV91cCsweDIxOC8weDVmMAogIHBvbGx3YWtlKzB4NmYvMHg5MAogIGNyZWRpdF9lbnRyb3B5X2Jp
dHMrMHgyMDQvMHgzMTAKICBhZGRfaW50ZXJydXB0X3JhbmRvbW5lc3MrMHgxOGYvMHgyMTAKICBo
YW5kbGVfaXJxKzB4NjcvMHgxNjAKICBkb19JUlErMHg1ZS8weDEzMAogIGNvbW1vbl9pbnRlcnJ1
cHQrMHhmLzB4ZgogIDwvSVJRPgoKVGhpcyBhbG9uZSBpc24ndCBhIHByb2JsZW0sIGJ1dCB0aGUg
c3BpbmxvY2sgaW4gdGhlIHNlbWFwaG9yZSBpcyBhbHNvCnN0aWxsIGhlbGQgd2hpbGUgd2FraW5n
IHVwIHdhaXRlcnMgKHVwKCkgLT4gX191cCgpIC0+IHRyeV90b193YWtlX3VwKCkKY2FsbGNoYWlu
KSwgd2hpY2ggdGhlbiBjbG9zZXMgdGhlIHJ1bnF1ZXVlIHZzLiBzZW1hcGhvcmUubG9jayBsb29w
LAphbmQgdXBzZXRzIGxvY2tkZXAsIHdoaWNoIGlzc3VlcyBhIGNpcmN1bGFyIGxvY2tpbmcgc3Bs
YXQgdG8gZG1lc2cuCldvcnNlIGl0IHVwc2V0cyBkZXZlbG9wZXJzLCBzaW5jZSB3ZSBkb24ndCB3
YW50IHRvIHNwYW0gZG1lc2cgd2l0aApjbHV0dGVyIHdoZW4gdGhlIG1hY2hpbmUgaXMgZHlpbmcg
YWxyZWFkeS4KCkZpeCB0aGlzIGJ5IGNyZWF0aW5nIGEgcHJpbmt0X3NhZmVfdXAoKSB3aGljaCBj
YWxscyB3YWtlX3VwX3Byb2Nlc3MKb3V0c2lkZSBvZiB0aGUgc3BpbmxvY2suIFRoaXMgaXNuJ3Qg
Y29ycmVjdCBpbiBmdWxsIGdlbmVyYWxpdHksIGJ1dApnb29kIGVub3VnaCBmb3IgY29uc29sZV9s
b2NrOgoKLSBjb25zb2xlX2xvY2sgZG9lc24ndCB1c2UgaW50ZXJydXB0aWJsZSBvciBraWxsYWJs
ZSBvciB0aW1lb3V0IGRvd24oKQogIGNhbGxzLCBoZW5jZSBhbiB1cCgpIGlzIHRoZSBvbmx5IHRo
aW5nIHRoYXQgY2FuIHdha2UgdXAgYSBwcm9jZXNzLgogIEhlbmNlIHRoZSBwcm9jZXNzIGNhbid0
IGdldCB3b2tlbiBhbmQga2lsbGVkIGFuZCByZWFwZWQgd2hpbGUgd2UgdHJ5CiAgdG8gd2FrZSBp
dCB1cCB0b28uCgotIHNlbWFwaG9yZS5jIGFsd2F5cyB1cGRhdGVzIHRoZSB3YWl0ZXIgbGlzdCB3
aGlsZSB1bmRlciB0aGUgc3BpbmxvY2ssCiAgc28gdGhlcmUncyBubyBvdGhlciByYWNlcy4gU3Bl
Y2lmaWNhbGx5IGFub3RoZXIgcHJvY2VzcyB0aGF0IHJhY2VzCiAgd2l0aCBhIHF1aWNrIGNvbnNv
bGVfbG9jay91bmxvY2sgd2hpbGUgd2UndmUgZHJvcHBlZCB0aGUgc3BpbmxvY2sKICBhbHJlYWR5
IHdvbid0IHNlZSBvdXIgb3duIHdhaXRlci4KCkFsc28gY2MnaW5nIEpvaG4gT2duZXNzIHNpbmNl
IHBlcmhhcHMgaGlzIHByaW50ayByZXdvcmsgZml4ZXMgdGhpcyBhbGwKcHJvcGVybHkuCgpTaWdu
ZWQtb2ZmLWJ5OiBEYW5pZWwgVmV0dGVyIDxkYW5pZWwudmV0dGVyQGludGVsLmNvbT4KQ2M6IFBl
dGVyIFppamxzdHJhIDxwZXRlcnpAaW5mcmFkZWFkLm9yZz4KQ2M6IEluZ28gTW9sbmFyIDxtaW5n
b0ByZWRoYXQuY29tPgpDYzogV2lsbCBEZWFjb24gPHdpbGwuZGVhY29uQGFybS5jb20+CkNjOiBQ
ZXRyIE1sYWRlayA8cG1sYWRla0BzdXNlLmNvbT4KQ2M6IFNlcmdleSBTZW5vemhhdHNreSA8c2Vy
Z2V5LnNlbm96aGF0c2t5QGdtYWlsLmNvbT4KQ2M6IFN0ZXZlbiBSb3N0ZWR0IDxyb3N0ZWR0QGdv
b2RtaXMub3JnPgpDYzogRGFuaWVsIFZldHRlciA8ZGFuaWVsLnZldHRlckBmZndsbC5jaD4KQ2M6
IEpvaG4gT2duZXNzIDxqb2huLm9nbmVzc0BsaW51dHJvbml4LmRlPgpDYzogbGludXgta2VybmVs
QHZnZXIua2VybmVsLm9yZwotLS0KdjI6IE15IGZpcnN0IGF0dGVtcHQgYXQgcGF0Y2hpbmcgZG93
bl90cnlsb2NrIGRpZG4ndCB3b3JrICh0aGFua3MgdG8KUGV0ciBmb3IgcG9pbnRpbmcgb3V0KSwg
bm93IHRyeSB0byBoYXZlIGEgc3BlY2lhbCB1cCgpIHRoYXQgYnJlYWtzIHRoZQpjeWNsZS4KLURh
bmllbAotLS0KIGluY2x1ZGUvbGludXgvc2VtYXBob3JlLmggIHwgIDEgKwoga2VybmVsL2xvY2tp
bmcvc2VtYXBob3JlLmMgfCAzMSArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiBrZXJu
ZWwvcHJpbnRrL3ByaW50ay5jICAgICB8ICAyICstCiAzIGZpbGVzIGNoYW5nZWQsIDMzIGluc2Vy
dGlvbnMoKyksIDEgZGVsZXRpb24oLSkKCmRpZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L3NlbWFw
aG9yZS5oIGIvaW5jbHVkZS9saW51eC9zZW1hcGhvcmUuaAppbmRleCAxMWM4NmZiZmViOTguLjdl
ODM5YzcyODA5ZCAxMDA2NDQKLS0tIGEvaW5jbHVkZS9saW51eC9zZW1hcGhvcmUuaAorKysgYi9p
bmNsdWRlL2xpbnV4L3NlbWFwaG9yZS5oCkBAIC00MSw2ICs0MSw3IEBAIGV4dGVybiBpbnQgX19t
dXN0X2NoZWNrIGRvd25faW50ZXJydXB0aWJsZShzdHJ1Y3Qgc2VtYXBob3JlICpzZW0pOwogZXh0
ZXJuIGludCBfX211c3RfY2hlY2sgZG93bl9raWxsYWJsZShzdHJ1Y3Qgc2VtYXBob3JlICpzZW0p
OwogZXh0ZXJuIGludCBfX211c3RfY2hlY2sgZG93bl90cnlsb2NrKHN0cnVjdCBzZW1hcGhvcmUg
KnNlbSk7CiBleHRlcm4gaW50IF9fbXVzdF9jaGVjayBkb3duX3RpbWVvdXQoc3RydWN0IHNlbWFw
aG9yZSAqc2VtLCBsb25nIGppZmZpZXMpOworZXh0ZXJuIHZvaWQgcHJpbnRrX3NhZmVfdXAoc3Ry
dWN0IHNlbWFwaG9yZSAqc2VtKTsKIGV4dGVybiB2b2lkIHVwKHN0cnVjdCBzZW1hcGhvcmUgKnNl
bSk7CiAKICNlbmRpZiAvKiBfX0xJTlVYX1NFTUFQSE9SRV9IICovCmRpZmYgLS1naXQgYS9rZXJu
ZWwvbG9ja2luZy9zZW1hcGhvcmUuYyBiL2tlcm5lbC9sb2NraW5nL3NlbWFwaG9yZS5jCmluZGV4
IDU2MWFjZGQzOTk2MC4uODQ2NzU5OTNkYzU5IDEwMDY0NAotLS0gYS9rZXJuZWwvbG9ja2luZy9z
ZW1hcGhvcmUuYworKysgYi9rZXJuZWwvbG9ja2luZy9zZW1hcGhvcmUuYwpAQCAtMTk3LDYgKzE5
NywzNyBAQCBzdHJ1Y3Qgc2VtYXBob3JlX3dhaXRlciB7CiAJYm9vbCB1cDsKIH07CiAKKy8qKgor
ICogcHJpbnRrX3NhZmVfdXAgLSByZWxlYXNlIHRoZSBzZW1hcGhvcmUgaW4gY29uc29sZV91bmxv
Y2sKKyAqIEBzZW06IHRoZSBzZW1hcGhvcmUgdG8gcmVsZWFzZQorICoKKyAqIFJlbGVhc2UgdGhl
IHNlbWFwaG9yZS4gIFVubGlrZSBtdXRleGVzLCB1cCgpIG1heSBiZSBjYWxsZWQgZnJvbSBhbnkK
KyAqIGNvbnRleHQgYW5kIGV2ZW4gYnkgdGFza3Mgd2hpY2ggaGF2ZSBuZXZlciBjYWxsZWQgZG93
bigpLgorICoKKyAqIE5PVEU6IFRoaXMgaXMgYSBzcGVjaWFsIHZlcnNpb24gb2YgdXAoKSBmb3Ig
Y29uc29sZV91bmxvY2sgb25seS4gSXQgaXMgb25seQorICogc2FmZSBpZiB0aGVyZSBhcmUgbm8g
a2lsbGFibGUsIGludGVycnVwdGlibGUgb3IgdGltaW5nIG91dCBkb3duKCkgY2FsbHMuCisgKi8K
K3ZvaWQgcHJpbnRrX3NhZmVfdXAoc3RydWN0IHNlbWFwaG9yZSAqc2VtKQoreworCXVuc2lnbmVk
IGxvbmcgZmxhZ3M7CisJc3RydWN0IHNlbWFwaG9yZV93YWl0ZXIgKndhaXRlciA9IE5VTEw7CisK
KwlyYXdfc3Bpbl9sb2NrX2lycXNhdmUoJnNlbS0+bG9jaywgZmxhZ3MpOworCWlmIChsaWtlbHko
bGlzdF9lbXB0eSgmc2VtLT53YWl0X2xpc3QpKSkgeworCQlzZW0tPmNvdW50Kys7CisJfSBlbHNl
IHsKKwkJd2FpdGVyID0gbGlzdF9maXJzdF9lbnRyeSgmc2VtLT53YWl0X2xpc3QsCisJCQkJCSAg
c3RydWN0IHNlbWFwaG9yZV93YWl0ZXIsIGxpc3QpOworCQlsaXN0X2RlbCgmd2FpdGVyLT5saXN0
KTsKKwkJd2FpdGVyLT51cCA9IHRydWU7CisJfQorCXJhd19zcGluX3VubG9ja19pcnFyZXN0b3Jl
KCZzZW0tPmxvY2ssIGZsYWdzKTsKKworCWlmICh3YWl0ZXIpCisJCXdha2VfdXBfcHJvY2Vzcyh3
YWl0ZXItPnRhc2spOworfQorRVhQT1JUX1NZTUJPTChwcmludGtfc2FmZV91cCk7CisKIC8qCiAg
KiBCZWNhdXNlIHRoaXMgZnVuY3Rpb24gaXMgaW5saW5lZCwgdGhlICdzdGF0ZScgcGFyYW1ldGVy
IHdpbGwgYmUKICAqIGNvbnN0YW50LCBhbmQgdGh1cyBvcHRpbWlzZWQgYXdheSBieSB0aGUgY29t
cGlsZXIuICBMaWtld2lzZSB0aGUKZGlmZiAtLWdpdCBhL2tlcm5lbC9wcmludGsvcHJpbnRrLmMg
Yi9rZXJuZWwvcHJpbnRrL3ByaW50ay5jCmluZGV4IDAyY2E4MjdiOGZhYy4uNjIzMDM5MjlhZmRh
IDEwMDY0NAotLS0gYS9rZXJuZWwvcHJpbnRrL3ByaW50ay5jCisrKyBiL2tlcm5lbC9wcmludGsv
cHJpbnRrLmMKQEAgLTIzNCw3ICsyMzQsNyBAQCBzdGF0aWMgdm9pZCBfX3VwX2NvbnNvbGVfc2Vt
KHVuc2lnbmVkIGxvbmcgaXApCiAJbXV0ZXhfcmVsZWFzZSgmY29uc29sZV9sb2NrX2RlcF9tYXAs
IDEsIGlwKTsKIAogCXByaW50a19zYWZlX2VudGVyX2lycXNhdmUoZmxhZ3MpOwotCXVwKCZjb25z
b2xlX3NlbSk7CisJcHJpbnRrX3NhZmVfdXAoJmNvbnNvbGVfc2VtKTsKIAlwcmludGtfc2FmZV9l
eGl0X2lycXJlc3RvcmUoZmxhZ3MpOwogfQogI2RlZmluZSB1cF9jb25zb2xlX3NlbSgpIF9fdXBf
Y29uc29sZV9zZW0oX1JFVF9JUF8pCi0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4
QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWls
bWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

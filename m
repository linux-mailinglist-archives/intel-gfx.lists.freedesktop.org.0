Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 378BD1123EE
	for <lists+intel-gfx@lfdr.de>; Wed,  4 Dec 2019 08:56:44 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E274C6F438;
	Wed,  4 Dec 2019 07:56:41 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5587D6E892
 for <intel-gfx@lists.freedesktop.org>; Wed,  4 Dec 2019 07:56:39 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19451944-1500050 
 for <intel-gfx@lists.freedesktop.org>; Wed, 04 Dec 2019 07:56:34 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed,  4 Dec 2019 07:56:35 +0000
Message-Id: <20191204075635.3512650-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0
MIME-Version: 1.0
Subject: [Intel-gfx] [CI] drm/i915: Introduce DRM_I915_GEM_MMAP_OFFSET
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogQWJkaWVsIEphbnVsZ3VlIDxhYmRpZWwuamFudWxndWVAbGludXguaW50ZWwuY29tPgoK
VGhpcyBpcyByZWFsbHkganVzdCBhbiBhbGlhcyBvZiBtbWFwX2d0dC4gVGhlICdtbWFwIG9mZnNl
dCcgbm9tZW5jbGF0dXJlCmNvbWVzIGZyb20gdGhlIHZhbHVlIHJldHVybmVkIGJ5IHRoaXMgaW9j
dGwgd2hpY2ggaXMgdGhlIG9mZnNldCBpbnRvIHRoZQpkZXZpY2UgZmQgd2hpY2ggdXNlcnBhY2Ug
dXNlcyB3aXRoIG1tYXAoMikuCgptbWFwX2d0dCB3YXMgb3VyIGluaXRpYWwgbW1hcF9vZmZzZXQg
aW1wbGVtZW50YXRpb24sIHRoaXMgZXh0ZW5kcwpvdXIgQ1BVIG1tYXAgc3VwcG9ydCB0byBhbGxv
dyBhZGRpdGlvbmFsIGZhdWx0IGhhbmRsZXJzIHRoYXQgZGVwZW5kcyBvbgp0aGUgb2JqZWN0J3Mg
YmFja2luZyBwYWdlcy4KCk5vdGUgdGhhdCB3ZSBtdWx0aXBsZXggbW1hcF9ndHQgYW5kIG1tYXBf
b2Zmc2V0IHRocm91Z2ggdGhlIHNhbWUgaW9jdGwsCmFuZCB1c2UgdGhlIHplcm8gZXh0ZW5kaW5n
IGJlaGF2aW91ciBvZiBkcm0gdG8gZGlmZmVyZW50aWF0ZSBiZXR3ZWVuCnRoZW0sIHdoZW4gd2Ug
aW5zcGVjdCB0aGUgZmxhZ3MuCgpUbyBzdXBwb3J0IG11bHRpcGxlIG1tYXAgdHlwZXMgb24gYW4g
b2JqZWN0IHdlIG5lZWQgdG8gc3VwcG9ydCBtdWx0aXBsZQptbWFwX29mZnNldHMgZm9yIGFuIG9i
amVjdCAoZWFjaCBvZmZzZXQgaW4gdGhlIGdsb2JhbCBkZXZpY2UgYWRkcmVzcwpzcGFjZSBjb3Jy
ZXNwb25kaW5nIHRvIGEgdW5pcXVlIGluc3RhbmNlIG9mIHRoZSBvYmplY3QgZm9yIGEgZmlsZSAr
IG1tYXAKdHlwZSkuIEFzIHdlIGRyb3AgdGhlIHNpbXBsaWZpZWQgZHJtIGNvcmUgaWRlYSBvZiBh
IHNpbmdsZSBtbWFwX29mZnNldCwKd2UgbmVlZCB0byBwcm92aWRlIHJlcGxhY2VtZW50IGhvb2tz
IGZvciB0aGUgZHVtYiBtbWFwIGludGVyZmFjZSBhcwp3ZWxsLgoKTGluazogaHR0cHM6Ly9naXRs
YWIuZnJlZWRlc2t0b3Aub3JnL21lc2EvbWVzYS9tZXJnZV9yZXF1ZXN0cy8xNjc1ClRlc3RjYXNl
OiBpZ3QvZ2VtX21tYXBfb2Zmc2V0ClNpZ25lZC1vZmYtYnk6IEFiZGllbCBKYW51bGd1ZSA8YWJk
aWVsLmphbnVsZ3VlQGxpbnV4LmludGVsLmNvbT4KU2lnbmVkLW9mZi1ieTogTWF0dGhldyBBdWxk
IDxtYXR0aGV3LmF1bGRAaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9kb21haW4uYyAgICB8ICAgMSArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1faW9jdGxzLmggICAgfCAgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV9tbWFuLmMgICAgICB8IDQ2OCArKysrKysrKysrKysrKy0tLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9tbWFuLmggICAgICB8ICAzNCArKwogZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5jICAgIHwgIDE4ICsKIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaCAgICB8ICAgNyArLQogLi4uL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fb2JqZWN0X3R5cGVzLmggIHwgIDIyICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9wYWdlcy5jICAgICB8ICAgMyArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fdGlsaW5nLmMgICAgfCAgIDEgKwogLi4uL2RybS9pOTE1L2dlbS9zZWxmdGVz
dHMvaTkxNV9nZW1fbW1hbi5jICAgIHwgIDg4ICsrKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX3Jlc2V0LmMgICAgICAgICB8ICAgNyArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kcnYuYyAgICAgICAgICAgICAgIHwgIDE1ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2Rydi5oICAgICAgICAgICAgICAgfCAgIDQgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9n
ZW0uYyAgICAgICAgICAgICAgIHwgICAzICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dl
dHBhcmFtLmMgICAgICAgICAgfCAgIDEgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEu
YyAgICAgICAgICAgICAgIHwgICA1ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5o
ICAgICAgICAgICAgICAgfCAgIDMgKwogaW5jbHVkZS91YXBpL2RybS9pOTE1X2RybS5oICAgICAg
ICAgICAgICAgICAgIHwgIDMyICsrCiAxOCBmaWxlcyBjaGFuZ2VkLCA1NzQgaW5zZXJ0aW9ucygr
KSwgMTQyIGRlbGV0aW9ucygtKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9tbWFuLmgKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fZG9tYWluLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fZG9tYWluLmMKaW5kZXggMzExOWY3YmU5YmMwLi5mMjA2NDk1MDYyMmIgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9kb21haW4uYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZG9tYWluLmMKQEAgLTEzLDYgKzEzLDcgQEAKICNp
bmNsdWRlICJpOTE1X2dlbV9vYmplY3QuaCIKICNpbmNsdWRlICJpOTE1X3ZtYS5oIgogI2luY2x1
ZGUgImk5MTVfZ2VtX2xtZW0uaCIKKyNpbmNsdWRlICJpOTE1X2dlbV9tbWFuLmgiCiAKIHN0YXRp
YyB2b2lkIF9faTkxNV9nZW1fb2JqZWN0X2ZsdXNoX2Zvcl9kaXNwbGF5KHN0cnVjdCBkcm1faTkx
NV9nZW1fb2JqZWN0ICpvYmopCiB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1faW9jdGxzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
aW9jdGxzLmgKaW5kZXggZGRjN2YyYTUyYjNlLi44N2Q4YjI3ZjQyNmQgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9pb2N0bHMuaAorKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1faW9jdGxzLmgKQEAgLTI4LDggKzI4LDggQEAgaW50IGk5
MTVfZ2VtX21hZHZpc2VfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwK
IAkJCSAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSk7CiBpbnQgaTkxNV9nZW1fbW1hcF9pb2N0bChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCQkJc3RydWN0IGRybV9maWxlICpm
aWxlKTsKLWludCBpOTE1X2dlbV9tbWFwX2d0dF9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
LCB2b2lkICpkYXRhLAotCQkJICAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSk7CitpbnQgaTkxNV9n
ZW1fbW1hcF9vZmZzZXRfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwK
KwkJCSAgICAgICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpOwogaW50IGk5MTVfZ2VtX3ByZWFkX2lv
Y3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAJCQkgc3RydWN0IGRybV9m
aWxlICpmaWxlKTsKIGludCBpOTE1X2dlbV9wd3JpdGVfaW9jdGwoc3RydWN0IGRybV9kZXZpY2Ug
KmRldiwgdm9pZCAqZGF0YSwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9tbWFuLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fbW1hbi5j
CmluZGV4IGQ2MDk3MzYwM2NjMS4uY2RhZTQ2MDhkMTU1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fbW1hbi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9tbWFuLmMKQEAgLTUsNiArNSw3IEBACiAgKi8KIAogI2luY2x1ZGUgPGxp
bnV4L21tYW4uaD4KKyNpbmNsdWRlIDxsaW51eC9wZm5fdC5oPgogI2luY2x1ZGUgPGxpbnV4L3Np
emVzLmg+CiAKICNpbmNsdWRlICJndC9pbnRlbF9ndC5oIgpAQCAtMTQsNiArMTUsNyBAQAogI2lu
Y2x1ZGUgImk5MTVfZ2VtX2d0dC5oIgogI2luY2x1ZGUgImk5MTVfZ2VtX2lvY3Rscy5oIgogI2lu
Y2x1ZGUgImk5MTVfZ2VtX29iamVjdC5oIgorI2luY2x1ZGUgImk5MTVfZ2VtX21tYW4uaCIKICNp
bmNsdWRlICJpOTE1X3RyYWNlLmgiCiAjaW5jbHVkZSAiaTkxNV92bWEuaCIKIApAQCAtMTQ0LDYg
KzE0Niw5IEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQgdGlsZV9yb3dfcGFnZXMoY29uc3Qgc3RydWN0
IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKICAqIDMgLSBSZW1vdmUgaW1wbGljaXQgc2V0LWRv
bWFpbihHVFQpIGFuZCBzeW5jaHJvbmlzYXRpb24gb24gaW5pdGlhbAogICogICAgIHBhZ2VmYXVs
dDsgc3dhcGluIHJlbWFpbnMgdHJhbnNwYXJlbnQuCiAgKgorICogNCAtIFN1cHBvcnQgbXVsdGlw
bGUgZmF1bHQgaGFuZGxlcnMgcGVyIG9iamVjdCBkZXBlbmRpbmcgb24gb2JqZWN0J3MKKyAqICAg
ICBiYWNraW5nIHN0b3JhZ2UgKGEuay5hLiBNTUFQX09GRlNFVCkuCisgKgogICogUmVzdHJpY3Rp
b25zOgogICoKICAqICAqIHNub29wYWJsZSBvYmplY3RzIGNhbm5vdCBiZSBhY2Nlc3NlZCB2aWEg
dGhlIEdUVC4gSXQgY2FuIGNhdXNlIG1hY2hpbmUKQEAgLTE3MSw3ICsxNzYsNyBAQCBzdGF0aWMg
dW5zaWduZWQgaW50IHRpbGVfcm93X3BhZ2VzKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICpvYmopCiAgKi8KIGludCBpOTE1X2dlbV9tbWFwX2d0dF92ZXJzaW9uKHZvaWQpCiB7Ci0J
cmV0dXJuIDM7CisJcmV0dXJuIDQ7CiB9CiAKIHN0YXRpYyBpbmxpbmUgc3RydWN0IGk5MTVfZ2d0
dF92aWV3CkBAIC0xOTcsMjkgKzIwMiw4MyBAQCBjb21wdXRlX3BhcnRpYWxfdmlldyhjb25zdCBz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCXJldHVybiB2aWV3OwogfQogCi0vKioK
LSAqIGk5MTVfZ2VtX2ZhdWx0IC0gZmF1bHQgYSBwYWdlIGludG8gdGhlIEdUVAotICogQHZtZjog
ZmF1bHQgaW5mbwotICoKLSAqIFRoZSBmYXVsdCBoYW5kbGVyIGlzIHNldCB1cCBieSBkcm1fZ2Vt
X21tYXAoKSB3aGVuIGEgb2JqZWN0IGlzIEdUVCBtYXBwZWQKLSAqIGZyb20gdXNlcnNwYWNlLiAg
VGhlIGZhdWx0IGhhbmRsZXIgdGFrZXMgY2FyZSBvZiBiaW5kaW5nIHRoZSBvYmplY3QgdG8KLSAq
IHRoZSBHVFQgKGlmIG5lZWRlZCksIGFsbG9jYXRpbmcgYW5kIHByb2dyYW1taW5nIGEgZmVuY2Ug
cmVnaXN0ZXIgKGFnYWluLAotICogb25seSBpZiBuZWVkZWQgYmFzZWQgb24gd2hldGhlciB0aGUg
b2xkIHJlZyBpcyBzdGlsbCB2YWxpZCBvciB0aGUgb2JqZWN0Ci0gKiBpcyB0aWxlZCkgYW5kIGlu
c2VydGluZyBhIG5ldyBQVEUgaW50byB0aGUgZmF1bHRpbmcgcHJvY2Vzcy4KLSAqCi0gKiBOb3Rl
IHRoYXQgdGhlIGZhdWx0aW5nIHByb2Nlc3MgbWF5IGludm9sdmUgZXZpY3RpbmcgZXhpc3Rpbmcg
b2JqZWN0cwotICogZnJvbSB0aGUgR1RUIGFuZC9vciBmZW5jZSByZWdpc3RlcnMgdG8gbWFrZSBy
b29tLiAgU28gcGVyZm9ybWFuY2UgbWF5Ci0gKiBzdWZmZXIgaWYgdGhlIEdUVCB3b3JraW5nIHNl
dCBpcyBsYXJnZSBvciB0aGVyZSBhcmUgZmV3IGZlbmNlIHJlZ2lzdGVycwotICogbGVmdC4KLSAq
Ci0gKiBUaGUgY3VycmVudCBmZWF0dXJlIHNldCBzdXBwb3J0ZWQgYnkgaTkxNV9nZW1fZmF1bHQo
KSBhbmQgdGh1cyBHVFQgbW1hcHMKLSAqIGlzIGV4cG9zZWQgdmlhIEk5MTVfUEFSQU1fTU1BUF9H
VFRfVkVSU0lPTiAoc2VlIGk5MTVfZ2VtX21tYXBfZ3R0X3ZlcnNpb24pLgotICovCi12bV9mYXVs
dF90IGk5MTVfZ2VtX2ZhdWx0KHN0cnVjdCB2bV9mYXVsdCAqdm1mKQorc3RhdGljIHZtX2ZhdWx0
X3QgaTkxNV9lcnJvcl90b192bWZfZmF1bHQoaW50IGVycikKK3sKKwlzd2l0Y2ggKGVycikgewor
CWRlZmF1bHQ6CisJCVdBUk5fT05DRShlcnIsICJ1bmhhbmRsZWQgZXJyb3IgaW4gJXM6ICVpXG4i
LCBfX2Z1bmNfXywgZXJyKTsKKwkJLyogZmFsbHRocm91Z2ggKi8KKwljYXNlIC1FSU86IC8qIHNo
bWVtZnMgZmFpbHVyZSBmcm9tIHN3YXAgZGV2aWNlICovCisJY2FzZSAtRUZBVUxUOiAvKiBwdXJn
ZWQgb2JqZWN0ICovCisJY2FzZSAtRU5PREVWOiAvKiBiYWQgb2JqZWN0LCBob3cgZGlkIHlvdSBn
ZXQgaGVyZSEgKi8KKwkJcmV0dXJuIFZNX0ZBVUxUX1NJR0JVUzsKKworCWNhc2UgLUVOT1NQQzog
Lyogc2htZW1mcyBhbGxvY2F0aW9uIGZhaWx1cmUgKi8KKwljYXNlIC1FTk9NRU06IC8qIG91ciBh
bGxvY2F0aW9uIGZhaWx1cmUgKi8KKwkJcmV0dXJuIFZNX0ZBVUxUX09PTTsKKworCWNhc2UgMDoK
KwljYXNlIC1FQUdBSU46CisJY2FzZSAtRVJFU1RBUlRTWVM6CisJY2FzZSAtRUlOVFI6CisJY2Fz
ZSAtRUJVU1k6CisJCS8qCisJCSAqIEVCVVNZIGlzIG9rOiB0aGlzIGp1c3QgbWVhbnMgdGhhdCBh
bm90aGVyIHRocmVhZAorCQkgKiBhbHJlYWR5IGRpZCB0aGUgam9iLgorCQkgKi8KKwkJcmV0dXJu
IFZNX0ZBVUxUX05PUEFHRTsKKwl9Cit9CisKK3N0YXRpYyB2bV9mYXVsdF90IHZtX2ZhdWx0X2Nw
dShzdHJ1Y3Qgdm1fZmF1bHQgKnZtZikKK3sKKwlzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKmFyZWEg
PSB2bWYtPnZtYTsKKwlzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldCAqcHJpdiA9IGFyZWEtPnZtX3By
aXZhdGVfZGF0YTsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gcHJpdi0+b2Jq
OworCXVuc2lnbmVkIGxvbmcgaSwgc2l6ZSA9IGFyZWEtPnZtX2VuZCAtIGFyZWEtPnZtX3N0YXJ0
OworCWJvb2wgd3JpdGUgPSBhcmVhLT52bV9mbGFncyAmIFZNX1dSSVRFOworCXZtX2ZhdWx0X3Qg
cmV0ID0gVk1fRkFVTFRfU0lHQlVTOworCWludCBlcnI7CisKKwlpZiAoIWk5MTVfZ2VtX29iamVj
dF9oYXNfc3RydWN0X3BhZ2Uob2JqKSkKKwkJcmV0dXJuIHJldDsKKworCS8qIFNhbml0eSBjaGVj
ayB0aGF0IHdlIGFsbG93IHdyaXRpbmcgaW50byB0aGlzIG9iamVjdCAqLworCWlmIChpOTE1X2dl
bV9vYmplY3RfaXNfcmVhZG9ubHkob2JqKSAmJiB3cml0ZSkKKwkJcmV0dXJuIHJldDsKKworCWVy
ciA9IGk5MTVfZ2VtX29iamVjdF9waW5fcGFnZXMob2JqKTsKKwlpZiAoZXJyKQorCQlyZXR1cm4g
aTkxNV9lcnJvcl90b192bWZfZmF1bHQoZXJyKTsKKworCS8qIFBURXMgYXJlIHJldm9rZWQgaW4g
b2JqLT5vcHMtPnB1dF9wYWdlcygpICovCisJZm9yIChpID0gMDsgaSA8IHNpemUgPj4gUEFHRV9T
SElGVDsgaSsrKSB7CisJCXN0cnVjdCBwYWdlICpwYWdlID0gaTkxNV9nZW1fb2JqZWN0X2dldF9w
YWdlKG9iaiwgaSk7CisKKwkJcmV0ID0gdm1mX2luc2VydF9wZm4oYXJlYSwKKwkJCQkgICAgICh1
bnNpZ25lZCBsb25nKWFyZWEtPnZtX3N0YXJ0ICsgaSAqIFBBR0VfU0laRSwKKwkJCQkgICAgIHBh
Z2VfdG9fcGZuKHBhZ2UpKTsKKwkJaWYgKHJldCAhPSBWTV9GQVVMVF9OT1BBR0UpCisJCQlicmVh
azsKKwl9CisKKwlpZiAod3JpdGUpIHsKKwkJR0VNX0JVR19PTighaTkxNV9nZW1fb2JqZWN0X2hh
c19waW5uZWRfcGFnZXMob2JqKSk7CisJCW9iai0+Y2FjaGVfZGlydHkgPSB0cnVlOyAvKiBYWFgg
Zmx1c2ggYWZ0ZXIgUEFUIHVwZGF0ZT8gKi8KKwkJb2JqLT5tbS5kaXJ0eSA9IHRydWU7CisJfQor
CisJaTkxNV9nZW1fb2JqZWN0X3VucGluX3BhZ2VzKG9iaik7CisKKwlyZXR1cm4gcmV0OworfQor
CitzdGF0aWMgdm1fZmF1bHRfdCB2bV9mYXVsdF9ndHQoc3RydWN0IHZtX2ZhdWx0ICp2bWYpCiB7
CiAjZGVmaW5lIE1JTl9DSFVOS19QQUdFUyAoU1pfMU0gPj4gUEFHRV9TSElGVCkKIAlzdHJ1Y3Qg
dm1fYXJlYV9zdHJ1Y3QgKmFyZWEgPSB2bWYtPnZtYTsKLQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29i
amVjdCAqb2JqID0gdG9faW50ZWxfYm8oYXJlYS0+dm1fcHJpdmF0ZV9kYXRhKTsKKwlzdHJ1Y3Qg
aTkxNV9tbWFwX29mZnNldCAqcHJpdiA9IGFyZWEtPnZtX3ByaXZhdGVfZGF0YTsKKwlzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gcHJpdi0+b2JqOwogCXN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYgPSBvYmotPmJhc2UuZGV2OwogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShkZXYpOwogCXN0cnVjdCBpbnRlbF9ydW50aW1lX3BtICpycG0gPSAmaTkxNS0+cnVu
dGltZV9wbTsKQEAgLTMxMiw2ICszNzEsOSBAQCB2bV9mYXVsdF90IGk5MTVfZ2VtX2ZhdWx0KHN0
cnVjdCB2bV9mYXVsdCAqdm1mKQogCQlsaXN0X2FkZCgmb2JqLT51c2VyZmF1bHRfbGluaywgJmk5
MTUtPmdndHQudXNlcmZhdWx0X2xpc3QpOwogCW11dGV4X3VubG9jaygmaTkxNS0+Z2d0dC52bS5t
dXRleCk7CiAKKwkvKiBUcmFjayB0aGUgbW1vIGFzc29jaWF0ZWQgd2l0aCB0aGUgZmVuY2VkIHZt
YSAqLworCXZtYS0+bW1vID0gcHJpdjsKKwogCWlmIChJU19BQ1RJVkUoQ09ORklHX0RSTV9JOTE1
X1VTRVJGQVVMVF9BVVRPU1VTUEVORCkpCiAJCWludGVsX3dha2VyZWZfYXV0bygmaTkxNS0+Z2d0
dC51c2VyZmF1bHRfd2FrZXJlZiwKIAkJCQkgICBtc2Vjc190b19qaWZmaWVzX3RpbWVvdXQoQ09O
RklHX0RSTV9JOTE1X1VTRVJGQVVMVF9BVVRPU1VTUEVORCkpOwpAQCAtMzMyLDY3ICszOTQsMzYg
QEAgdm1fZmF1bHRfdCBpOTE1X2dlbV9mYXVsdChzdHJ1Y3Qgdm1fZmF1bHQgKnZtZikKIAlpbnRl
bF9ydW50aW1lX3BtX3B1dChycG0sIHdha2VyZWYpOwogCWk5MTVfZ2VtX29iamVjdF91bnBpbl9w
YWdlcyhvYmopOwogZXJyOgotCXN3aXRjaCAocmV0KSB7Ci0JZGVmYXVsdDoKLQkJV0FSTl9PTkNF
KHJldCwgInVuaGFuZGxlZCBlcnJvciBpbiAlczogJWlcbiIsIF9fZnVuY19fLCByZXQpOwotCQkv
KiBmYWxsdGhyb3VnaCAqLwotCWNhc2UgLUVJTzogLyogc2htZW1mcyBmYWlsdXJlIGZyb20gc3dh
cCBkZXZpY2UgKi8KLQljYXNlIC1FRkFVTFQ6IC8qIHB1cmdlZCBvYmplY3QgKi8KLQljYXNlIC1F
Tk9ERVY6IC8qIGJhZCBvYmplY3QsIGhvdyBkaWQgeW91IGdldCBoZXJlISAqLwotCQlyZXR1cm4g
Vk1fRkFVTFRfU0lHQlVTOwotCi0JY2FzZSAtRU5PU1BDOiAvKiBzaG1lbWZzIGFsbG9jYXRpb24g
ZmFpbHVyZSAqLwotCWNhc2UgLUVOT01FTTogLyogb3VyIGFsbG9jYXRpb24gZmFpbHVyZSAqLwot
CQlyZXR1cm4gVk1fRkFVTFRfT09NOwotCi0JY2FzZSAwOgotCWNhc2UgLUVBR0FJTjoKLQljYXNl
IC1FUkVTVEFSVFNZUzoKLQljYXNlIC1FSU5UUjoKLQljYXNlIC1FQlVTWToKLQkJLyoKLQkJICog
RUJVU1kgaXMgb2s6IHRoaXMganVzdCBtZWFucyB0aGF0IGFub3RoZXIgdGhyZWFkCi0JCSAqIGFs
cmVhZHkgZGlkIHRoZSBqb2IuCi0JCSAqLwotCQlyZXR1cm4gVk1fRkFVTFRfTk9QQUdFOwotCX0K
KwlyZXR1cm4gaTkxNV9lcnJvcl90b192bWZfZmF1bHQocmV0KTsKIH0KIAotdm9pZCBfX2k5MTVf
Z2VtX29iamVjdF9yZWxlYXNlX21tYXAoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikK
K3ZvaWQgX19pOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwX2d0dChzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqKQogewogCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwogCiAJR0VNX0JVR19P
Tighb2JqLT51c2VyZmF1bHRfY291bnQpOwogCi0Jb2JqLT51c2VyZmF1bHRfY291bnQgPSAwOwot
CWxpc3RfZGVsKCZvYmotPnVzZXJmYXVsdF9saW5rKTsKLQlkcm1fdm1hX25vZGVfdW5tYXAoJm9i
ai0+YmFzZS52bWFfbm9kZSwKLQkJCSAgIG9iai0+YmFzZS5kZXYtPmFub25faW5vZGUtPmlfbWFw
cGluZyk7Ci0KIAlmb3JfZWFjaF9nZ3R0X3ZtYSh2bWEsIG9iaikKLQkJaTkxNV92bWFfdW5zZXRf
dXNlcmZhdWx0KHZtYSk7CisJCWk5MTVfdm1hX3Jldm9rZV9tbWFwKHZtYSk7CisKKwlHRU1fQlVH
X09OKG9iai0+dXNlcmZhdWx0X2NvdW50KTsKIH0KIAotLyoqCi0gKiBpOTE1X2dlbV9vYmplY3Rf
cmVsZWFzZV9tbWFwIC0gcmVtb3ZlIHBoeXNpY2FsIHBhZ2UgbWFwcGluZ3MKLSAqIEBvYmo6IG9i
aiBpbiBxdWVzdGlvbgotICoKLSAqIFByZXNlcnZlIHRoZSByZXNlcnZhdGlvbiBvZiB0aGUgbW1h
cHBpbmcgd2l0aCB0aGUgRFJNIGNvcmUgY29kZSwgYnV0Ci0gKiByZWxpbnF1aXNoIG93bmVyc2hp
cCBvZiB0aGUgcGFnZXMgYmFjayB0byB0aGUgc3lzdGVtLgotICoKKy8qCiAgKiBJdCBpcyB2aXRh
bCB0aGF0IHdlIHJlbW92ZSB0aGUgcGFnZSBtYXBwaW5nIGlmIHdlIGhhdmUgbWFwcGVkIGEgdGls
ZWQKICAqIG9iamVjdCB0aHJvdWdoIHRoZSBHVFQgYW5kIHRoZW4gbG9zZSB0aGUgZmVuY2UgcmVn
aXN0ZXIgZHVlIHRvCiAgKiByZXNvdXJjZSBwcmVzc3VyZS4gU2ltaWxhcmx5IGlmIHRoZSBvYmpl
Y3QgaGFzIGJlZW4gbW92ZWQgb3V0IG9mIHRoZQogICogYXBlcnR1cmUsIHRoYW4gcGFnZXMgbWFw
cGVkIGludG8gdXNlcnNwYWNlIG11c3QgYmUgcmV2b2tlZC4gUmVtb3ZpbmcgdGhlCiAgKiBtYXBw
aW5nIHdpbGwgdGhlbiB0cmlnZ2VyIGEgcGFnZSBmYXVsdCBvbiB0aGUgbmV4dCB1c2VyIGFjY2Vz
cywgYWxsb3dpbmcKLSAqIGZpeHVwIGJ5IGk5MTVfZ2VtX2ZhdWx0KCkuCisgKiBmaXh1cCBieSB2
bV9mYXVsdF9ndHQoKS4KICAqLwotdm9pZCBpOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwKHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCitzdGF0aWMgdm9pZCBpOTE1X2dlbV9vYmpl
Y3RfcmVsZWFzZV9tbWFwX2d0dChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogewog
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShvYmotPmJhc2UuZGV2KTsK
IAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKIAotCS8qIFNlcmlhbGlzYXRpb24gYmV0d2VlbiB1
c2VyIEdUVCBhY2Nlc3MgYW5kIG91ciBjb2RlIGRlcGVuZHMgdXBvbgorCS8qCisJICogU2VyaWFs
aXNhdGlvbiBiZXR3ZWVuIHVzZXIgR1RUIGFjY2VzcyBhbmQgb3VyIGNvZGUgZGVwZW5kcyB1cG9u
CiAJICogcmV2b2tpbmcgdGhlIENQVSdzIFBURSB3aGlsc3QgdGhlIG11dGV4IGlzIGhlbGQuIFRo
ZSBuZXh0IHVzZXIKIAkgKiBwYWdlZmF1bHQgdGhlbiBoYXMgdG8gd2FpdCB1bnRpbCB3ZSByZWxl
YXNlIHRoZSBtdXRleC4KIAkgKgpAQCAtNDA2LDkgKzQzNywxMCBAQCB2b2lkIGk5MTVfZ2VtX29i
amVjdF9yZWxlYXNlX21tYXAoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIAlpZiAo
IW9iai0+dXNlcmZhdWx0X2NvdW50KQogCQlnb3RvIG91dDsKIAotCV9faTkxNV9nZW1fb2JqZWN0
X3JlbGVhc2VfbW1hcChvYmopOworCV9faTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcF9ndHQo
b2JqKTsKIAotCS8qIEVuc3VyZSB0aGF0IHRoZSBDUFUncyBQVEUgYXJlIHJldm9rZWQgYW5kIHRo
ZXJlIGFyZSBub3Qgb3V0c3RhbmRpbmcKKwkvKgorCSAqIEVuc3VyZSB0aGF0IHRoZSBDUFUncyBQ
VEUgYXJlIHJldm9rZWQgYW5kIHRoZXJlIGFyZSBub3Qgb3V0c3RhbmRpbmcKIAkgKiBtZW1vcnkg
dHJhbnNhY3Rpb25zIGZyb20gdXNlcnNwYWNlIGJlZm9yZSB3ZSByZXR1cm4uIFRoZSBUTEIKIAkg
KiBmbHVzaGluZyBpbXBsaWVkIGFib3ZlIGJ5IGNoYW5naW5nIHRoZSBQVEUgYWJvdmUgKnNob3Vs
ZCogYmUKIAkgKiBzdWZmaWNpZW50LCBhbiBleHRyYSBiYXJyaWVyIGhlcmUganVzdCBwcm92aWRl
cyB1cyB3aXRoIGEgYml0CkBAIC00MjIsNTcgKzQ1NCwxNDUgQEAgdm9pZCBpOTE1X2dlbV9vYmpl
Y3RfcmVsZWFzZV9tbWFwKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiAJaW50ZWxf
cnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogfQogCi1zdGF0aWMg
aW50IGNyZWF0ZV9tbWFwX29mZnNldChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQor
dm9pZCBpOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwX29mZnNldChzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqKQoreworCXN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICptbW87CisKKwlt
dXRleF9sb2NrKCZvYmotPm1tb19sb2NrKTsKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5KG1tbywgJm9i
ai0+bW1hcF9vZmZzZXRzLCBvZmZzZXQpIHsKKwkJLyoKKwkJICogdm1hX25vZGVfdW5tYXAgZm9y
IEdUVCBtbWFwcyBoYW5kbGVkIGFscmVhZHkgaW4KKwkJICogX19pOTE1X2dlbV9vYmplY3RfcmVs
ZWFzZV9tbWFwX2d0dAorCQkgKi8KKwkJaWYgKG1tby0+bW1hcF90eXBlICE9IEk5MTVfTU1BUF9U
WVBFX0dUVCkKKwkJCWRybV92bWFfbm9kZV91bm1hcCgmbW1vLT52bWFfbm9kZSwKKwkJCQkJICAg
b2JqLT5iYXNlLmRldi0+YW5vbl9pbm9kZS0+aV9tYXBwaW5nKTsKKwl9CisJbXV0ZXhfdW5sb2Nr
KCZvYmotPm1tb19sb2NrKTsKK30KKworLyoqCisgKiBpOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9t
bWFwIC0gcmVtb3ZlIHBoeXNpY2FsIHBhZ2UgbWFwcGluZ3MKKyAqIEBvYmo6IG9iaiBpbiBxdWVz
dGlvbgorICoKKyAqIFByZXNlcnZlIHRoZSByZXNlcnZhdGlvbiBvZiB0aGUgbW1hcHBpbmcgd2l0
aCB0aGUgRFJNIGNvcmUgY29kZSwgYnV0CisgKiByZWxpbnF1aXNoIG93bmVyc2hpcCBvZiB0aGUg
cGFnZXMgYmFjayB0byB0aGUgc3lzdGVtLgorICovCit2b2lkIGk5MTVfZ2VtX29iamVjdF9yZWxl
YXNlX21tYXAoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKK3sKKwlpOTE1X2dlbV9v
YmplY3RfcmVsZWFzZV9tbWFwX2d0dChvYmopOworCWk5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21t
YXBfb2Zmc2V0KG9iaik7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldCAqCitt
bWFwX29mZnNldF9hdHRhY2goc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKKwkJICAg
ZW51bSBpOTE1X21tYXBfdHlwZSBtbWFwX3R5cGUsCisJCSAgIHN0cnVjdCBkcm1fZmlsZSAqZmls
ZSkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUob2JqLT5iYXNl
LmRldik7Ci0Jc3RydWN0IGludGVsX2d0ICpndCA9ICZpOTE1LT5ndDsKKwlzdHJ1Y3QgaTkxNV9t
bWFwX29mZnNldCAqbW1vOwogCWludCBlcnI7CiAKLQllcnIgPSBkcm1fZ2VtX2NyZWF0ZV9tbWFw
X29mZnNldCgmb2JqLT5iYXNlKTsKKwltbW8gPSBrbWFsbG9jKHNpemVvZigqbW1vKSwgR0ZQX0tF
Uk5FTCk7CisJaWYgKCFtbW8pCisJCXJldHVybiBFUlJfUFRSKC1FTk9NRU0pOworCisJbW1vLT5v
YmogPSBvYmo7CisJbW1vLT5kZXYgPSBvYmotPmJhc2UuZGV2OworCW1tby0+ZmlsZSA9IGZpbGU7
CisJbW1vLT5tbWFwX3R5cGUgPSBtbWFwX3R5cGU7CisJZHJtX3ZtYV9ub2RlX3Jlc2V0KCZtbW8t
PnZtYV9ub2RlKTsKKworCWVyciA9IGRybV92bWFfb2Zmc2V0X2FkZChtbW8tPmRldi0+dm1hX29m
ZnNldF9tYW5hZ2VyLCAmbW1vLT52bWFfbm9kZSwKKwkJCQkgb2JqLT5iYXNlLnNpemUgLyBQQUdF
X1NJWkUpOwogCWlmIChsaWtlbHkoIWVycikpCi0JCXJldHVybiAwOworCQlnb3RvIG91dDsKIAog
CS8qIEF0dGVtcHQgdG8gcmVhcCBzb21lIG1tYXAgc3BhY2UgZnJvbSBkZWFkIG9iamVjdHMgKi8K
LQllcnIgPSBpbnRlbF9ndF9yZXRpcmVfcmVxdWVzdHNfdGltZW91dChndCwgTUFYX1NDSEVEVUxF
X1RJTUVPVVQpOworCWVyciA9IGludGVsX2d0X3JldGlyZV9yZXF1ZXN0c190aW1lb3V0KCZpOTE1
LT5ndCwgTUFYX1NDSEVEVUxFX1RJTUVPVVQpOwogCWlmIChlcnIpCi0JCXJldHVybiBlcnI7CisJ
CWdvdG8gZXJyOwogCiAJaTkxNV9nZW1fZHJhaW5fZnJlZWRfb2JqZWN0cyhpOTE1KTsKLQlyZXR1
cm4gZHJtX2dlbV9jcmVhdGVfbW1hcF9vZmZzZXQoJm9iai0+YmFzZSk7CisJZXJyID0gZHJtX3Zt
YV9vZmZzZXRfYWRkKG1tby0+ZGV2LT52bWFfb2Zmc2V0X21hbmFnZXIsICZtbW8tPnZtYV9ub2Rl
LAorCQkJCSBvYmotPmJhc2Uuc2l6ZSAvIFBBR0VfU0laRSk7CisJaWYgKGVycikKKwkJZ290byBl
cnI7CisKK291dDoKKwltdXRleF9sb2NrKCZvYmotPm1tb19sb2NrKTsKKwlsaXN0X2FkZCgmbW1v
LT5vZmZzZXQsICZvYmotPm1tYXBfb2Zmc2V0cyk7CisJbXV0ZXhfdW5sb2NrKCZvYmotPm1tb19s
b2NrKTsKKworCWlmIChmaWxlKQorCQlkcm1fdm1hX25vZGVfYWxsb3coJm1tby0+dm1hX25vZGUs
IGZpbGUpOworCisJcmV0dXJuIG1tbzsKKworZXJyOgorCWtmcmVlKG1tbyk7CisJcmV0dXJuIEVS
Ul9QVFIoZXJyKTsKIH0KIAotaW50Ci1pOTE1X2dlbV9tbWFwX2d0dChzdHJ1Y3QgZHJtX2ZpbGUg
KmZpbGUsCi0JCSAgc3RydWN0IGRybV9kZXZpY2UgKmRldiwKLQkJICB1MzIgaGFuZGxlLAotCQkg
IHU2NCAqb2Zmc2V0KQorc3RhdGljIGludAorX19hc3NpZ25fbW1hcF9vZmZzZXQoc3RydWN0IGRy
bV9maWxlICpmaWxlLAorCQkgICAgIHUzMiBoYW5kbGUsCisJCSAgICAgZW51bSBpOTE1X21tYXBf
dHlwZSBtbWFwX3R5cGUsCisJCSAgICAgdTY0ICpvZmZzZXQpCiB7CiAJc3RydWN0IGRybV9pOTE1
X2dlbV9vYmplY3QgKm9iajsKLQlpbnQgcmV0OwotCi0JaWYgKCFpOTE1X2dndHRfaGFzX2FwZXJ0
dXJlKCZ0b19pOTE1KGRldiktPmdndHQpKQotCQlyZXR1cm4gLUVOT0RFVjsKKwlzdHJ1Y3QgaTkx
NV9tbWFwX29mZnNldCAqbW1vOworCWludCBlcnI7CiAKIAlvYmogPSBpOTE1X2dlbV9vYmplY3Rf
bG9va3VwKGZpbGUsIGhhbmRsZSk7CiAJaWYgKCFvYmopCiAJCXJldHVybiAtRU5PRU5UOwogCi0J
aWYgKGk5MTVfZ2VtX29iamVjdF9uZXZlcl9iaW5kX2dndHQob2JqKSkgewotCQlyZXQgPSAtRU5P
REVWOworCWlmIChtbWFwX3R5cGUgPT0gSTkxNV9NTUFQX1RZUEVfR1RUICYmCisJICAgIGk5MTVf
Z2VtX29iamVjdF9uZXZlcl9iaW5kX2dndHQob2JqKSkgeworCQllcnIgPSAtRU5PREVWOworCQln
b3RvIG91dDsKKwl9CisKKwlpZiAobW1hcF90eXBlICE9IEk5MTVfTU1BUF9UWVBFX0dUVCAmJgor
CSAgICAhaTkxNV9nZW1fb2JqZWN0X2hhc19zdHJ1Y3RfcGFnZShvYmopKSB7CisJCWVyciA9IC1F
Tk9ERVY7CiAJCWdvdG8gb3V0OwogCX0KIAotCXJldCA9IGNyZWF0ZV9tbWFwX29mZnNldChvYmop
OwotCWlmIChyZXQgPT0gMCkKLQkJKm9mZnNldCA9IGRybV92bWFfbm9kZV9vZmZzZXRfYWRkcigm
b2JqLT5iYXNlLnZtYV9ub2RlKTsKKwltbW8gPSBtbWFwX29mZnNldF9hdHRhY2gob2JqLCBtbWFw
X3R5cGUsIGZpbGUpOworCWlmIChJU19FUlIobW1vKSkgeworCQllcnIgPSBQVFJfRVJSKG1tbyk7
CisJCWdvdG8gb3V0OworCX0KIAorCSpvZmZzZXQgPSBkcm1fdm1hX25vZGVfb2Zmc2V0X2FkZHIo
Jm1tby0+dm1hX25vZGUpOworCWVyciA9IDA7CiBvdXQ6CiAJaTkxNV9nZW1fb2JqZWN0X3B1dChv
YmopOwotCXJldHVybiByZXQ7CisJcmV0dXJuIGVycjsKK30KKworaW50CitpOTE1X2dlbV9kdW1i
X21tYXBfb2Zmc2V0KHN0cnVjdCBkcm1fZmlsZSAqZmlsZSwKKwkJCSAgc3RydWN0IGRybV9kZXZp
Y2UgKmRldiwKKwkJCSAgdTMyIGhhbmRsZSwKKwkJCSAgdTY0ICpvZmZzZXQpCit7CisJZW51bSBp
OTE1X21tYXBfdHlwZSBtbWFwX3R5cGU7CisKKwlpZiAoYm9vdF9jcHVfaGFzKFg4Nl9GRUFUVVJF
X1BBVCkpCisJCW1tYXBfdHlwZSA9IEk5MTVfTU1BUF9UWVBFX1dDOworCWVsc2UgaWYgKCFpOTE1
X2dndHRfaGFzX2FwZXJ0dXJlKCZ0b19pOTE1KGRldiktPmdndHQpKQorCQlyZXR1cm4gLUVOT0RF
VjsKKwllbHNlCisJCW1tYXBfdHlwZSA9IEk5MTVfTU1BUF9UWVBFX0dUVDsKKworCXJldHVybiBf
X2Fzc2lnbl9tbWFwX29mZnNldChmaWxlLCBoYW5kbGUsIG1tYXBfdHlwZSwgb2Zmc2V0KTsKIH0K
IAogLyoqCi0gKiBpOTE1X2dlbV9tbWFwX2d0dF9pb2N0bCAtIHByZXBhcmUgYW4gb2JqZWN0IGZv
ciBHVFQgbW1hcCdpbmcKKyAqIGk5MTVfZ2VtX21tYXBfb2Zmc2V0X2lvY3RsIC0gcHJlcGFyZSBh
biBvYmplY3QgZm9yIEdUVCBtbWFwJ2luZwogICogQGRldjogRFJNIGRldmljZQogICogQGRhdGE6
IEdUVCBtYXBwaW5nIGlvY3RsIGRhdGEKICAqIEBmaWxlOiBHRU0gb2JqZWN0IGluZm8KQEAgLTQ4
NywxMiArNjA3LDE3OCBAQCBpOTE1X2dlbV9tbWFwX2d0dChzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUs
CiAgKiB1c2Vyc3BhY2UuCiAgKi8KIGludAotaTkxNV9nZW1fbW1hcF9ndHRfaW9jdGwoc3RydWN0
IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKLQkJCXN0cnVjdCBkcm1fZmlsZSAqZmlsZSkK
K2k5MTVfZ2VtX21tYXBfb2Zmc2V0X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQg
KmRhdGEsCisJCQkgICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpCiB7Ci0Jc3RydWN0IGRybV9pOTE1
X2dlbV9tbWFwX2d0dCAqYXJncyA9IGRhdGE7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGRldik7CisJc3RydWN0IGRybV9pOTE1X2dlbV9tbWFwX29mZnNldCAqYXJn
cyA9IGRhdGE7CisJZW51bSBpOTE1X21tYXBfdHlwZSB0eXBlOworCisJaWYgKGFyZ3MtPmV4dGVu
c2lvbnMpCisJCXJldHVybiAtRUlOVkFMOwogCi0JcmV0dXJuIGk5MTVfZ2VtX21tYXBfZ3R0KGZp
bGUsIGRldiwgYXJncy0+aGFuZGxlLCAmYXJncy0+b2Zmc2V0KTsKKwlzd2l0Y2ggKGFyZ3MtPmZs
YWdzKSB7CisJY2FzZSBJOTE1X01NQVBfT0ZGU0VUX0dUVDoKKwkJaWYgKCFpOTE1X2dndHRfaGFz
X2FwZXJ0dXJlKCZpOTE1LT5nZ3R0KSkKKwkJCXJldHVybiAtRU5PREVWOworCQl0eXBlID0gSTkx
NV9NTUFQX1RZUEVfR1RUOworCQlicmVhazsKKworCWNhc2UgSTkxNV9NTUFQX09GRlNFVF9XQzoK
KwkJaWYgKCFib290X2NwdV9oYXMoWDg2X0ZFQVRVUkVfUEFUKSkKKwkJCXJldHVybiAtRU5PREVW
OworCQl0eXBlID0gSTkxNV9NTUFQX1RZUEVfV0M7CisJCWJyZWFrOworCisJY2FzZSBJOTE1X01N
QVBfT0ZGU0VUX1dCOgorCQl0eXBlID0gSTkxNV9NTUFQX1RZUEVfV0I7CisJCWJyZWFrOworCisJ
Y2FzZSBJOTE1X01NQVBfT0ZGU0VUX1VDOgorCQlpZiAoIWJvb3RfY3B1X2hhcyhYODZfRkVBVFVS
RV9QQVQpKQorCQkJcmV0dXJuIC1FTk9ERVY7CisJCXR5cGUgPSBJOTE1X01NQVBfVFlQRV9VQzsK
KwkJYnJlYWs7CisKKwlkZWZhdWx0OgorCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlyZXR1cm4g
X19hc3NpZ25fbW1hcF9vZmZzZXQoZmlsZSwgYXJncy0+aGFuZGxlLCB0eXBlLCAmYXJncy0+b2Zm
c2V0KTsKK30KKwordm9pZCBpOTE1X21tYXBfb2Zmc2V0X2Rlc3Ryb3koc3RydWN0IGk5MTVfbW1h
cF9vZmZzZXQgKm1tbywgc3RydWN0IG11dGV4ICptdXRleCkKK3sKKwlkcm1fdm1hX29mZnNldF9y
ZW1vdmUobW1vLT5kZXYtPnZtYV9vZmZzZXRfbWFuYWdlciwgJm1tby0+dm1hX25vZGUpOworCisJ
bXV0ZXhfbG9jayhtdXRleCk7CisJbGlzdF9kZWwoJm1tby0+b2Zmc2V0KTsKKwltdXRleF91bmxv
Y2sobXV0ZXgpOworCisJa2ZyZWUobW1vKTsKK30KKworc3RhdGljIHZvaWQgdm1fb3BlbihzdHJ1
Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSkKK3sKKwlzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldCAqbW1v
ID0gdm1hLT52bV9wcml2YXRlX2RhdGE7CisJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
aiA9IG1tby0+b2JqOworCisJR0VNX0JVR19PTighb2JqKTsKKwlpOTE1X2dlbV9vYmplY3RfZ2V0
KG9iaik7Cit9CisKK3N0YXRpYyB2b2lkIHZtX2Nsb3NlKHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAq
dm1hKQoreworCXN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICptbW8gPSB2bWEtPnZtX3ByaXZhdGVf
ZGF0YTsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gbW1vLT5vYmo7CisKKwlH
RU1fQlVHX09OKCFvYmopOworCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKK30KKworc3RhdGlj
IGNvbnN0IHN0cnVjdCB2bV9vcGVyYXRpb25zX3N0cnVjdCB2bV9vcHNfZ3R0ID0geworCS5mYXVs
dCA9IHZtX2ZhdWx0X2d0dCwKKwkub3BlbiA9IHZtX29wZW4sCisJLmNsb3NlID0gdm1fY2xvc2Us
Cit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IHZtX29wZXJhdGlvbnNfc3RydWN0IHZtX29wc19j
cHUgPSB7CisJLmZhdWx0ID0gdm1fZmF1bHRfY3B1LAorCS5vcGVuID0gdm1fb3BlbiwKKwkuY2xv
c2UgPSB2bV9jbG9zZSwKK307CisKKy8qCisgKiBUaGlzIG92ZXJjb21lcyB0aGUgbGltaXRhdGlv
biBpbiBkcm1fZ2VtX21tYXAncyBhc3NpZ25tZW50IG9mIGEKKyAqIGRybV9nZW1fb2JqZWN0IGFz
IHRoZSB2bWEtPnZtX3ByaXZhdGVfZGF0YS4gU2luY2Ugd2UgbmVlZCB0bworICogYmUgYWJsZSB0
byByZXNvbHZlIG11bHRpcGxlIG1tYXAgb2Zmc2V0cyB3aGljaCBjb3VsZCBiZSB0aWVkCisgKiB0
byBhIHNpbmdsZSBnZW0gb2JqZWN0LgorICovCitpbnQgaTkxNV9nZW1fbW1hcChzdHJ1Y3QgZmls
ZSAqZmlscCwgc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEpCit7CisJc3RydWN0IGRybV92bWFf
b2Zmc2V0X25vZGUgKm5vZGU7CisJc3RydWN0IGRybV9maWxlICpwcml2ID0gZmlscC0+cHJpdmF0
ZV9kYXRhOworCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBwcml2LT5taW5vci0+ZGV2OworCXN0
cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICptbW8gPSBOVUxMOworCXN0cnVjdCBkcm1fZ2VtX29iamVj
dCAqb2JqID0gTlVMTDsKKworCWlmIChkcm1fZGV2X2lzX3VucGx1Z2dlZChkZXYpKQorCQlyZXR1
cm4gLUVOT0RFVjsKKworCWRybV92bWFfb2Zmc2V0X2xvY2tfbG9va3VwKGRldi0+dm1hX29mZnNl
dF9tYW5hZ2VyKTsKKwlub2RlID0gZHJtX3ZtYV9vZmZzZXRfZXhhY3RfbG9va3VwX2xvY2tlZChk
ZXYtPnZtYV9vZmZzZXRfbWFuYWdlciwKKwkJCQkJCSAgdm1hLT52bV9wZ29mZiwKKwkJCQkJCSAg
dm1hX3BhZ2VzKHZtYSkpOworCWlmIChsaWtlbHkobm9kZSkpIHsKKwkJbW1vID0gY29udGFpbmVy
X29mKG5vZGUsIHN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0LAorCQkJCSAgIHZtYV9ub2RlKTsKKwkJ
LyoKKwkJICogSW4gb3VyIGRlcGVuZGVuY3kgY2hhaW4sIHRoZSBkcm1fdm1hX29mZnNldF9ub2Rl
CisJCSAqIGRlcGVuZHMgb24gdGhlIHZhbGlkaXR5IG9mIHRoZSBtbW8sIHdoaWNoIGRlcGVuZHMg
b24KKwkJICogdGhlIGdlbSBvYmplY3QuIEhvd2V2ZXIgdGhlIG9ubHkgcmVmZXJlbmNlIHdlIGhh
dmUKKwkJICogYXQgdGhpcyBwb2ludCBpcyB0aGUgbW1vIChhcyB0aGUgcGFyZW50IG9mIHRoZSBu
b2RlKS4KKwkJICogVHJ5IHRvIGNoZWNrIGlmIHRoZSBnZW0gb2JqZWN0IHdhcyBhdCBsZWFzdCBj
bGVhcmVkLgorCQkgKi8KKwkJaWYgKCFtbW8gfHwgIW1tby0+b2JqKSB7CisJCQlkcm1fdm1hX29m
ZnNldF91bmxvY2tfbG9va3VwKGRldi0+dm1hX29mZnNldF9tYW5hZ2VyKTsKKwkJCXJldHVybiAt
RUlOVkFMOworCQl9CisJCS8qCisJCSAqIFNraXAgMC1yZWZjbnRlZCBvYmplY3RzIGFzIGl0IGlz
IGluIHRoZSBwcm9jZXNzIG9mIGJlaW5nCisJCSAqIGRlc3Ryb3llZCBhbmQgd2lsbCBiZSBpbnZh
bGlkIHdoZW4gdGhlIHZtYSBtYW5hZ2VyIGxvY2sKKwkJICogaXMgcmVsZWFzZWQuCisJCSAqLwor
CQlvYmogPSAmbW1vLT5vYmotPmJhc2U7CisJCWlmICgha3JlZl9nZXRfdW5sZXNzX3plcm8oJm9i
ai0+cmVmY291bnQpKQorCQkJb2JqID0gTlVMTDsKKwl9CisJZHJtX3ZtYV9vZmZzZXRfdW5sb2Nr
X2xvb2t1cChkZXYtPnZtYV9vZmZzZXRfbWFuYWdlcik7CisJaWYgKCFvYmopCisJCXJldHVybiAt
RUlOVkFMOworCisJaWYgKCFkcm1fdm1hX25vZGVfaXNfYWxsb3dlZChub2RlLCBwcml2KSkgewor
CQlkcm1fZ2VtX29iamVjdF9wdXRfdW5sb2NrZWQob2JqKTsKKwkJcmV0dXJuIC1FQUNDRVM7CisJ
fQorCisJaWYgKGk5MTVfZ2VtX29iamVjdF9pc19yZWFkb25seSh0b19pbnRlbF9ibyhvYmopKSkg
eworCQlpZiAodm1hLT52bV9mbGFncyAmIFZNX1dSSVRFKSB7CisJCQlkcm1fZ2VtX29iamVjdF9w
dXRfdW5sb2NrZWQob2JqKTsKKwkJCXJldHVybiAtRUlOVkFMOworCQl9CisJCXZtYS0+dm1fZmxh
Z3MgJj0gflZNX01BWVdSSVRFOworCX0KKworCXZtYS0+dm1fZmxhZ3MgfD0gVk1fUEZOTUFQIHwg
Vk1fRE9OVEVYUEFORCB8IFZNX0RPTlREVU1QOworCXZtYS0+dm1fcHJpdmF0ZV9kYXRhID0gbW1v
OworCisJc3dpdGNoIChtbW8tPm1tYXBfdHlwZSkgeworCWNhc2UgSTkxNV9NTUFQX1RZUEVfV0M6
CisJCXZtYS0+dm1fcGFnZV9wcm90ID0KKwkJCXBncHJvdF93cml0ZWNvbWJpbmUodm1fZ2V0X3Bh
Z2VfcHJvdCh2bWEtPnZtX2ZsYWdzKSk7CisJCXZtYS0+dm1fb3BzID0gJnZtX29wc19jcHU7CisJ
CWJyZWFrOworCisJY2FzZSBJOTE1X01NQVBfVFlQRV9XQjoKKwkJdm1hLT52bV9wYWdlX3Byb3Qg
PSB2bV9nZXRfcGFnZV9wcm90KHZtYS0+dm1fZmxhZ3MpOworCQl2bWEtPnZtX29wcyA9ICZ2bV9v
cHNfY3B1OworCQlicmVhazsKKworCWNhc2UgSTkxNV9NTUFQX1RZUEVfVUM6CisJCXZtYS0+dm1f
cGFnZV9wcm90ID0KKwkJCXBncHJvdF9ub25jYWNoZWQodm1fZ2V0X3BhZ2VfcHJvdCh2bWEtPnZt
X2ZsYWdzKSk7CisJCXZtYS0+dm1fb3BzID0gJnZtX29wc19jcHU7CisJCWJyZWFrOworCisJY2Fz
ZSBJOTE1X01NQVBfVFlQRV9HVFQ6CisJCXZtYS0+dm1fcGFnZV9wcm90ID0KKwkJCXBncHJvdF93
cml0ZWNvbWJpbmUodm1fZ2V0X3BhZ2VfcHJvdCh2bWEtPnZtX2ZsYWdzKSk7CisJCXZtYS0+dm1f
b3BzID0gJnZtX29wc19ndHQ7CisJCWJyZWFrOworCX0KKwl2bWEtPnZtX3BhZ2VfcHJvdCA9IHBn
cHJvdF9kZWNyeXB0ZWQodm1hLT52bV9wYWdlX3Byb3QpOworCisJcmV0dXJuIDA7CiB9CiAKICNp
ZiBJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9TRUxGVEVTVCkKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9tbWFuLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fbW1hbi5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAw
MDAwMC4uMDMwNzg0MzQ0MGFjCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX21tYW4uaApAQCAtMCwwICsxLDM0IEBACisvKgorICogU1BEWC1MaWNl
bnNlLUlkZW50aWZpZXI6IE1JVAorICoKKyAqIENvcHlyaWdodCDCqSAyMDE5IEludGVsIENvcnBv
cmF0aW9uCisgKi8KKworI2lmbmRlZiBfX0k5MTVfR0VNX01NQU5fSF9fCisjZGVmaW5lIF9fSTkx
NV9HRU1fTU1BTl9IX18KKworI2luY2x1ZGUgPGxpbnV4L21tX3R5cGVzLmg+CisjaW5jbHVkZSA8
bGludXgvdHlwZXMuaD4KKworc3RydWN0IGRybV9kZXZpY2U7CitzdHJ1Y3QgZHJtX2ZpbGU7Citz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdDsKK3N0cnVjdCBmaWxlOworc3RydWN0IGk5MTVfbW1h
cF9vZmZzZXQ7CitzdHJ1Y3QgbXV0ZXg7CisKK2ludCBpOTE1X2dlbV9tbWFwX2d0dF92ZXJzaW9u
KHZvaWQpOworaW50IGk5MTVfZ2VtX21tYXAoc3RydWN0IGZpbGUgKmZpbHAsIHN0cnVjdCB2bV9h
cmVhX3N0cnVjdCAqdm1hKTsKKworaW50IGk5MTVfZ2VtX2R1bWJfbW1hcF9vZmZzZXQoc3RydWN0
IGRybV9maWxlICpmaWxlX3ByaXYsCisJCQkgICAgICBzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAor
CQkJICAgICAgdTMyIGhhbmRsZSwgdTY0ICpvZmZzZXQpOworCit2b2lkIF9faTkxNV9nZW1fb2Jq
ZWN0X3JlbGVhc2VfbW1hcF9ndHQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaik7Cit2
b2lkIGk5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXAoc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iaik7Cit2b2lkIGk5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXBfb2Zmc2V0KHN0cnVj
dCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopOworCit2b2lkIGk5MTVfbW1hcF9vZmZzZXRfZGVz
dHJveShzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldCAqbW1vLAorCQkJICAgICAgc3RydWN0IG11dGV4
ICptdXRleCk7CisKKyNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX29iamVjdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29i
amVjdC5jCmluZGV4IDQ1ODk0NWUxODIzZS4uZjFiODdhODM5OTI2IDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5jCkBAIC0yOSw2ICsyOSw3IEBACiAjaW5jbHVk
ZSAiaTkxNV9kcnYuaCIKICNpbmNsdWRlICJpOTE1X2dlbV9jbGZsdXNoLmgiCiAjaW5jbHVkZSAi
aTkxNV9nZW1fY29udGV4dC5oIgorI2luY2x1ZGUgImk5MTVfZ2VtX21tYW4uaCIKICNpbmNsdWRl
ICJpOTE1X2dlbV9vYmplY3QuaCIKICNpbmNsdWRlICJpOTE1X2dsb2JhbHMuaCIKICNpbmNsdWRl
ICJpOTE1X3RyYWNlLmgiCkBAIC02MSw2ICs2Miw5IEBAIHZvaWQgaTkxNV9nZW1fb2JqZWN0X2lu
aXQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAogCUlOSVRfTElTVF9IRUFEKCZv
YmotPmx1dF9saXN0KTsKIAorCW11dGV4X2luaXQoJm9iai0+bW1vX2xvY2spOworCUlOSVRfTElT
VF9IRUFEKCZvYmotPm1tYXBfb2Zmc2V0cyk7CisKIAlpbml0X3JjdV9oZWFkKCZvYmotPnJjdSk7
CiAKIAlvYmotPm9wcyA9IG9wczsKQEAgLTk3LDYgKzEwMSw3IEBAIHZvaWQgaTkxNV9nZW1fY2xv
c2Vfb2JqZWN0KHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqZ2VtLCBzdHJ1Y3QgZHJtX2ZpbGUgKmZp
bGUpCiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IHRvX2ludGVsX2JvKGdlbSk7
CiAJc3RydWN0IGRybV9pOTE1X2ZpbGVfcHJpdmF0ZSAqZnByaXYgPSBmaWxlLT5kcml2ZXJfcHJp
djsKIAlzdHJ1Y3QgaTkxNV9sdXRfaGFuZGxlICpsdXQsICpsbjsKKwlzdHJ1Y3QgaTkxNV9tbWFw
X29mZnNldCAqbW1vLCAqb247CiAJTElTVF9IRUFEKGNsb3NlKTsKIAogCWk5MTVfZ2VtX29iamVj
dF9sb2NrKG9iaik7CkBAIC0xMTEsNiArMTE2LDkgQEAgdm9pZCBpOTE1X2dlbV9jbG9zZV9vYmpl
Y3Qoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpnZW0sIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkKIAl9
CiAJaTkxNV9nZW1fb2JqZWN0X3VubG9jayhvYmopOwogCisJbGlzdF9mb3JfZWFjaF9lbnRyeV9z
YWZlKG1tbywgb24sICZvYmotPm1tYXBfb2Zmc2V0cywgb2Zmc2V0KQorCQlkcm1fdm1hX25vZGVf
cmV2b2tlKCZtbW8tPnZtYV9ub2RlLCBmaWxlKTsKKwogCWxpc3RfZm9yX2VhY2hfZW50cnlfc2Fm
ZShsdXQsIGxuLCAmY2xvc2UsIG9ial9saW5rKSB7CiAJCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0
ICpjdHggPSBsdXQtPmN0eDsKIAkJc3RydWN0IGk5MTVfdm1hICp2bWE7CkBAIC0xNTgsNiArMTY2
LDggQEAgc3RhdGljIHZvaWQgX19pOTE1X2dlbV9mcmVlX29iamVjdHMoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCiAKIAl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUt
PnJ1bnRpbWVfcG0pOwogCWxsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUob2JqLCBvbiwgZnJlZWQs
IGZyZWVkKSB7CisJCXN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICptbW8sICptbjsKKwogCQl0cmFj
ZV9pOTE1X2dlbV9vYmplY3RfZGVzdHJveShvYmopOwogCiAJCWlmICghbGlzdF9lbXB0eSgmb2Jq
LT52bWEubGlzdCkpIHsKQEAgLTE4Myw2ICsxOTMsMTQgQEAgc3RhdGljIHZvaWQgX19pOTE1X2dl
bV9mcmVlX29iamVjdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCQlzcGluX3Vu
bG9jaygmb2JqLT52bWEubG9jayk7CiAJCX0KIAorCQlpOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9t
bWFwKG9iaik7CisKKwkJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKG1tbywgbW4sICZvYmotPm1t
YXBfb2Zmc2V0cywgb2Zmc2V0KSB7CisJCQltbW8tPm9iaiA9IE5VTEw7CisJCQlpOTE1X21tYXBf
b2Zmc2V0X2Rlc3Ryb3kobW1vLCAmb2JqLT5tbW9fbG9jayk7CisJCX0KKworCQlHRU1fQlVHX09O
KCFsaXN0X2VtcHR5KCZvYmotPm1tYXBfb2Zmc2V0cykpOwogCQlHRU1fQlVHX09OKGF0b21pY19y
ZWFkKCZvYmotPmJpbmRfY291bnQpKTsKIAkJR0VNX0JVR19PTihvYmotPnVzZXJmYXVsdF9jb3Vu
dCk7CiAJCUdFTV9CVUdfT04oIWxpc3RfZW1wdHkoJm9iai0+bHV0X2xpc3QpKTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaCBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaAppbmRleCBlNTc1MGQ1MDZjYzkuLmEx
ZWI3YzBiMjNhYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X29iamVjdC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3Qu
aApAQCAtMTMyLDEzICsxMzIsMTMgQEAgdm9pZCBpOTE1X2dlbV9vYmplY3RfdW5sb2NrX2ZlbmNl
KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiBzdGF0aWMgaW5saW5lIHZvaWQKIGk5
MTVfZ2VtX29iamVjdF9zZXRfcmVhZG9ubHkoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
aikKIHsKLQlvYmotPmJhc2Uudm1hX25vZGUucmVhZG9ubHkgPSB0cnVlOworCW9iai0+ZmxhZ3Mg
fD0gSTkxNV9CT19SRUFET05MWTsKIH0KIAogc3RhdGljIGlubGluZSBib29sCiBpOTE1X2dlbV9v
YmplY3RfaXNfcmVhZG9ubHkoY29uc3Qgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikK
IHsKLQlyZXR1cm4gb2JqLT5iYXNlLnZtYV9ub2RlLnJlYWRvbmx5OworCXJldHVybiBvYmotPmZs
YWdzICYgSTkxNV9CT19SRUFET05MWTsKIH0KIAogc3RhdGljIGlubGluZSBib29sCkBAIC0zODcs
OSArMzg3LDYgQEAgc3RhdGljIGlubGluZSB2b2lkIGk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAo
c3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIAlpOTE1X2dlbV9vYmplY3RfdW5waW5f
cGFnZXMob2JqKTsKIH0KIAotdm9pZCBfX2k5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXAoc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaik7Ci12b2lkIGk5MTVfZ2VtX29iamVjdF9yZWxl
YXNlX21tYXAoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaik7Ci0KIHZvaWQKIGk5MTVf
Z2VtX29iamVjdF9mbHVzaF93cml0ZV9kb21haW4oc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iaiwKIAkJCQkgICB1bnNpZ25lZCBpbnQgZmx1c2hfZG9tYWlucyk7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0X3R5cGVzLmggYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0X3R5cGVzLmgKaW5kZXggMTVmODI5N2Rj
MzRlLi5jMGJlYjk3YjU2ZDEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9vYmplY3RfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fb2JqZWN0X3R5cGVzLmgKQEAgLTYzLDYgKzYzLDIzIEBAIHN0cnVjdCBkcm1faTkxNV9n
ZW1fb2JqZWN0X29wcyB7CiAJdm9pZCAoKnJlbGVhc2UpKHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICpvYmopOwogfTsKIAorZW51bSBpOTE1X21tYXBfdHlwZSB7CisJSTkxNV9NTUFQX1RZUEVf
R1RUID0gMCwKKwlJOTE1X01NQVBfVFlQRV9XQywKKwlJOTE1X01NQVBfVFlQRV9XQiwKKwlJOTE1
X01NQVBfVFlQRV9VQywKK307CisKK3N0cnVjdCBpOTE1X21tYXBfb2Zmc2V0IHsKKwlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2OworCXN0cnVjdCBkcm1fdm1hX29mZnNldF9ub2RlIHZtYV9ub2RlOwor
CXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CisJc3RydWN0IGRybV9maWxlICpmaWxl
OworCWVudW0gaTkxNV9tbWFwX3R5cGUgbW1hcF90eXBlOworCisJc3RydWN0IGxpc3RfaGVhZCBv
ZmZzZXQ7Cit9OworCiBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCB7CiAJc3RydWN0IGRybV9n
ZW1fb2JqZWN0IGJhc2U7CiAKQEAgLTExOCwxMiArMTM1LDE3IEBAIHN0cnVjdCBkcm1faTkxNV9n
ZW1fb2JqZWN0IHsKIAl1bnNpZ25lZCBpbnQgdXNlcmZhdWx0X2NvdW50OwogCXN0cnVjdCBsaXN0
X2hlYWQgdXNlcmZhdWx0X2xpbms7CiAKKwkvKiBQcm90ZWN0cyBhY2Nlc3MgdG8gbW1hcCBvZmZz
ZXRzICovCisJc3RydWN0IG11dGV4IG1tb19sb2NrOworCXN0cnVjdCBsaXN0X2hlYWQgbW1hcF9v
ZmZzZXRzOworCiAJSTkxNV9TRUxGVEVTVF9ERUNMQVJFKHN0cnVjdCBsaXN0X2hlYWQgc3RfbGlu
ayk7CiAKIAl1bnNpZ25lZCBsb25nIGZsYWdzOwogI2RlZmluZSBJOTE1X0JPX0FMTE9DX0NPTlRJ
R1VPVVMgQklUKDApCiAjZGVmaW5lIEk5MTVfQk9fQUxMT0NfVk9MQVRJTEUgICBCSVQoMSkKICNk
ZWZpbmUgSTkxNV9CT19BTExPQ19GTEFHUyAoSTkxNV9CT19BTExPQ19DT05USUdVT1VTIHwgSTkx
NV9CT19BTExPQ19WT0xBVElMRSkKKyNkZWZpbmUgSTkxNV9CT19SRUFET05MWSAgICAgICAgIEJJ
VCgyKQogCiAJLyoKIAkgKiBJcyB0aGUgb2JqZWN0IHRvIGJlIG1hcHBlZCBhcyByZWFkLW9ubHkg
dG8gdGhlIEdQVQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X3BhZ2VzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcGFnZXMuYwppbmRl
eCBmNDAyYzJjNDE1YzIuLjc1MTk3Y2E2OTZhOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX3BhZ2VzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX3BhZ2VzLmMKQEAgLTgsNiArOCw3IEBACiAjaW5jbHVkZSAiaTkxNV9nZW1fb2Jq
ZWN0LmgiCiAjaW5jbHVkZSAiaTkxNV9zY2F0dGVybGlzdC5oIgogI2luY2x1ZGUgImk5MTVfZ2Vt
X2xtZW0uaCIKKyNpbmNsdWRlICJpOTE1X2dlbV9tbWFuLmgiCiAKIHZvaWQgX19pOTE1X2dlbV9v
YmplY3Rfc2V0X3BhZ2VzKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJCQkJIHN0
cnVjdCBzZ190YWJsZSAqcGFnZXMsCkBAIC0yMDcsNiArMjA4LDggQEAgaW50IF9faTkxNV9nZW1f
b2JqZWN0X3B1dF9wYWdlcyhzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogCQlnb3Rv
IHVubG9jazsKIAl9CiAKKwlpOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwX29mZnNldChvYmop
OworCiAJLyoKIAkgKiAtPnB1dF9wYWdlcyBtaWdodCBuZWVkIHRvIGFsbG9jYXRlIG1lbW9yeSBm
b3IgdGhlIGJpdDE3IHN3aXp6bGUKIAkgKiBhcnJheSwgaGVuY2UgcHJvdGVjdCB0aGVtIGZyb20g
YmVpbmcgcmVhcGVkIGJ5IHJlbW92aW5nIHRoZW0gZnJvbSBndHQKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV90aWxpbmcuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV90aWxpbmcuYwppbmRleCAxZmE1OTJkODJhZjUuLjZjNzgyNWEyZGMy
YSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3RpbGluZy5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV90aWxpbmcuYwpAQCAtMTEs
NiArMTEsNyBAQAogI2luY2x1ZGUgImk5MTVfZHJ2LmgiCiAjaW5jbHVkZSAiaTkxNV9nZW0uaCIK
ICNpbmNsdWRlICJpOTE1X2dlbV9pb2N0bHMuaCIKKyNpbmNsdWRlICJpOTE1X2dlbV9tbWFuLmgi
CiAjaW5jbHVkZSAiaTkxNV9nZW1fb2JqZWN0LmgiCiAKIC8qKgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9tbWFuLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX21tYW4uYwppbmRleCA2Y2U5MTY3Zjhj
OWYuLjU5MTQzNWM1ZjM2OCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3Nl
bGZ0ZXN0cy9pOTE1X2dlbV9tbWFuLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3Nl
bGZ0ZXN0cy9pOTE1X2dlbV9tbWFuLmMKQEAgLTU2NSwxNiArNTY1LDE2IEBAIHN0YXRpYyBib29s
IGFzc2VydF9tbWFwX29mZnNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJCSAg
ICAgICBpbnQgZXhwZWN0ZWQpCiB7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsK
LQlpbnQgZXJyOworCXN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICptbW87CiAKIAlvYmogPSBpOTE1
X2dlbV9vYmplY3RfY3JlYXRlX2ludGVybmFsKGk5MTUsIHNpemUpOwogCWlmIChJU19FUlIob2Jq
KSkKIAkJcmV0dXJuIFBUUl9FUlIob2JqKTsKIAotCWVyciA9IGNyZWF0ZV9tbWFwX29mZnNldChv
YmopOworCW1tbyA9IG1tYXBfb2Zmc2V0X2F0dGFjaChvYmosIEk5MTVfTU1BUF9PRkZTRVRfR1RU
LCBOVUxMKTsKIAlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CiAKLQlyZXR1cm4gZXJyID09IGV4
cGVjdGVkOworCXJldHVybiBQVFJfRVJSX09SX1pFUk8obW1vKSA9PSBleHBlY3RlZDsKIH0KIAog
c3RhdGljIHZvaWQgZGlzYWJsZV9yZXRpcmVfd29ya2VyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQpAQCAtNjA5LDcgKzYwOSw4IEBAIHN0YXRpYyBpbnQgaWd0X21tYXBfb2Zmc2V0X2V4
aGF1c3Rpb24odm9pZCAqYXJnKQogCXN0cnVjdCBkcm1fbW0gKm1tID0gJmk5MTUtPmRybS52bWFf
b2Zmc2V0X21hbmFnZXItPnZtX2FkZHJfc3BhY2VfbW07CiAJc3RydWN0IGRybV9pOTE1X2dlbV9v
YmplY3QgKm9iajsKIAlzdHJ1Y3QgZHJtX21tX25vZGUgKmhvbGUsICpuZXh0OwotCWludCBsb29w
LCBlcnI7CisJc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQgKm1tbzsKKwlpbnQgbG9vcCwgZXJyID0g
MDsKIAogCS8qIERpc2FibGUgYmFja2dyb3VuZCByZWFwZXIgKi8KIAlkaXNhYmxlX3JldGlyZV93
b3JrZXIoaTkxNSk7CkBAIC02NzMsOSArNjc0LDEwIEBAIHN0YXRpYyBpbnQgaWd0X21tYXBfb2Zm
c2V0X2V4aGF1c3Rpb24odm9pZCAqYXJnKQogCQlnb3RvIG91dDsKIAl9CiAKLQllcnIgPSBjcmVh
dGVfbW1hcF9vZmZzZXQob2JqKTsKLQlpZiAoZXJyKSB7CisJbW1vID0gbW1hcF9vZmZzZXRfYXR0
YWNoKG9iaiwgSTkxNV9NTUFQX09GRlNFVF9HVFQsIE5VTEwpOworCWlmIChJU19FUlIobW1vKSkg
ewogCQlwcl9lcnIoIlVuYWJsZSB0byBpbnNlcnQgb2JqZWN0IGludG8gcmVjbGFpbWVkIGhvbGVc
biIpOworCQllcnIgPSBQVFJfRVJSKG1tbyk7CiAJCWdvdG8gZXJyX29iajsKIAl9CiAKQEAgLTcy
NCwxNCArNzI2LDE1IEBAIHN0YXRpYyBpbnQgaWd0X21tYXBfb2Zmc2V0X2V4aGF1c3Rpb24odm9p
ZCAqYXJnKQogfQogCiAjZGVmaW5lIGV4cGFuZDMyKHgpICgoKHgpIDw8IDApIHwgKCh4KSA8PCA4
KSB8ICgoeCkgPDwgMTYpIHwgKCh4KSA8PCAyNCkpCi1zdGF0aWMgaW50IGlndF9tbWFwX2d0dCh2
b2lkICphcmcpCitzdGF0aWMgaW50IGlndF9tbWFwKHZvaWQgKmFyZywgZW51bSBpOTE1X21tYXBf
dHlwZSB0eXBlKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYXJnOwogCXN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CisJc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQg
Km1tbzsKIAlzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKmFyZWE7CiAJdW5zaWduZWQgbG9uZyBhZGRy
OwogCXZvaWQgKnZhZGRyOwotCWludCBlcnIsIGk7CisJaW50IGVyciA9IDAsIGk7CiAKIAlpZiAo
IWk5MTVfZ2d0dF9oYXNfYXBlcnR1cmUoJmk5MTUtPmdndHQpKQogCQlyZXR1cm4gMDsKQEAgLTc0
OSwxOCArNzUyLDE5IEBAIHN0YXRpYyBpbnQgaWd0X21tYXBfZ3R0KHZvaWQgKmFyZykKIAlpOTE1
X2dlbV9vYmplY3RfZmx1c2hfbWFwKG9iaik7CiAJaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChv
YmopOwogCi0JZXJyID0gY3JlYXRlX21tYXBfb2Zmc2V0KG9iaik7Ci0JaWYgKGVycikKKwltbW8g
PSBtbWFwX29mZnNldF9hdHRhY2gob2JqLCB0eXBlLCBOVUxMKTsKKwlpZiAoSVNfRVJSKG1tbykp
IHsKKwkJZXJyID0gUFRSX0VSUihtbW8pOwogCQlnb3RvIG91dDsKKwl9CiAKLQlhZGRyID0gaWd0
X21tYXBfbm9kZShpOTE1LCAmb2JqLT5iYXNlLnZtYV9ub2RlLAotCQkJICAgICAwLCBQUk9UX1dS
SVRFLCBNQVBfU0hBUkVEKTsKKwlhZGRyID0gaWd0X21tYXBfbm9kZShpOTE1LCAmbW1vLT52bWFf
bm9kZSwgMCwgUFJPVF9XUklURSwgTUFQX1NIQVJFRCk7CiAJaWYgKElTX0VSUl9WQUxVRShhZGRy
KSkgewogCQllcnIgPSBhZGRyOwogCQlnb3RvIG91dDsKIAl9CiAKLQlwcl9kZWJ1ZygiaWd0X21t
YXAob2JqOmd0dCkgQCAlbHhcbiIsIGFkZHIpOworCXByX2RlYnVnKCJpZ3RfbW1hcCgpIEAgJWx4
XG4iLCBhZGRyKTsKIAogCWFyZWEgPSBmaW5kX3ZtYShjdXJyZW50LT5tbSwgYWRkcik7CiAJaWYg
KCFhcmVhKSB7CkBAIC03NjksOCArNzczLDggQEAgc3RhdGljIGludCBpZ3RfbW1hcF9ndHQodm9p
ZCAqYXJnKQogCQlnb3RvIG91dF91bm1hcDsKIAl9CiAKLQlpZiAoYXJlYS0+dm1fcHJpdmF0ZV9k
YXRhICE9IG9iaikgewotCQlwcl9lcnIoInZtX2FyZWFfc3RydWN0IGRpZCBub3QgcG9pbnQgYmFj
ayB0byBvdXIgb2JqZWN0IVxuIik7CisJaWYgKGFyZWEtPnZtX3ByaXZhdGVfZGF0YSAhPSBtbW8p
IHsKKwkJcHJfZXJyKCJ2bV9hcmVhX3N0cnVjdCBkaWQgbm90IHBvaW50IGJhY2sgdG8gb3VyIG1t
YXBfb2Zmc2V0IG9iamVjdCFcbiIpOwogCQllcnIgPSAtRUlOVkFMOwogCQlnb3RvIG91dF91bm1h
cDsKIAl9CkBAIC03ODAsMTQgKzc4NCwxNCBAQCBzdGF0aWMgaW50IGlndF9tbWFwX2d0dCh2b2lk
ICphcmcpCiAJCXUzMiB4OwogCiAJCWlmIChnZXRfdXNlcih4LCB1eCkpIHsKLQkJCXByX2Vycigi
VW5hYmxlIHRvIHJlYWQgZnJvbSBHVFQgbW1hcCwgb2Zmc2V0OiV6ZFxuIiwKKwkJCXByX2Vycigi
VW5hYmxlIHRvIHJlYWQgZnJvbSBtbWFwLCBvZmZzZXQ6JXpkXG4iLAogCQkJICAgICAgIGkgKiBz
aXplb2YoeCkpOwogCQkJZXJyID0gLUVGQVVMVDsKIAkJCWJyZWFrOwogCQl9CiAKIAkJaWYgKHgg
IT0gZXhwYW5kMzIoUE9JU09OX0lOVVNFKSkgewotCQkJcHJfZXJyKCJSZWFkIGluY29ycmVjdCB2
YWx1ZSBmcm9tIEdUVCBtbWFwLCBvZmZzZXQ6JXpkLCBmb3VuZDoleCwgZXhwZWN0ZWQ6JXhcbiIs
CisJCQlwcl9lcnIoIlJlYWQgaW5jb3JyZWN0IHZhbHVlIGZyb20gbW1hcCwgb2Zmc2V0OiV6ZCwg
Zm91bmQ6JXgsIGV4cGVjdGVkOiV4XG4iLAogCQkJICAgICAgIGkgKiBzaXplb2YoeCksIHgsIGV4
cGFuZDMyKFBPSVNPTl9JTlVTRSkpOwogCQkJZXJyID0gLUVJTlZBTDsKIAkJCWJyZWFrOwpAQCAt
Nzk1LDcgKzc5OSw3IEBAIHN0YXRpYyBpbnQgaWd0X21tYXBfZ3R0KHZvaWQgKmFyZykKIAogCQl4
ID0gZXhwYW5kMzIoUE9JU09OX0ZSRUUpOwogCQlpZiAocHV0X3VzZXIoeCwgdXgpKSB7Ci0JCQlw
cl9lcnIoIlVuYWJsZSB0byB3cml0ZSB0byBHVFQgbW1hcCwgb2Zmc2V0OiV6ZFxuIiwKKwkJCXBy
X2VycigiVW5hYmxlIHRvIHdyaXRlIHRvIG1tYXAsIG9mZnNldDolemRcbiIsCiAJCQkgICAgICAg
aSAqIHNpemVvZih4KSk7CiAJCQllcnIgPSAtRUZBVUxUOwogCQkJYnJlYWs7CkBAIC04MTEsNyAr
ODE1LDcgQEAgc3RhdGljIGludCBpZ3RfbW1hcF9ndHQodm9pZCAqYXJnKQogCQlnb3RvIG91dDsK
IAl9CiAJaWYgKGVyciA9PSAwICYmIG1lbWNocl9pbnYodmFkZHIsIFBPSVNPTl9GUkVFLCBQQUdF
X1NJWkUpKSB7Ci0JCXByX2VycigiV3JpdGUgdmlhIEdHVFQgbW1hcCBkaWQgbm90IGxhbmQgaW4g
YmFja2luZyBzdG9yZVxuIik7CisJCXByX2VycigiV3JpdGUgdmlhIG1tYXAgZGlkIG5vdCBsYW5k
IGluIGJhY2tpbmcgc3RvcmVcbiIpOwogCQllcnIgPSAtRUlOVkFMOwogCX0KIAlpOTE1X2dlbV9v
YmplY3RfdW5waW5fbWFwKG9iaik7CkBAIC04MjEsNiArODI1LDE2IEBAIHN0YXRpYyBpbnQgaWd0
X21tYXBfZ3R0KHZvaWQgKmFyZykKIAlyZXR1cm4gZXJyOwogfQogCitzdGF0aWMgaW50IGlndF9t
bWFwX2d0dCh2b2lkICphcmcpCit7CisJcmV0dXJuIGlndF9tbWFwKGFyZywgSTkxNV9NTUFQX1RZ
UEVfR1RUKTsKK30KKworc3RhdGljIGludCBpZ3RfbW1hcF9jcHUodm9pZCAqYXJnKQoreworCXJl
dHVybiBpZ3RfbW1hcChhcmcsIEk5MTVfTU1BUF9UWVBFX1dDKTsKK30KKwogc3RhdGljIGludCBj
aGVja19wcmVzZW50X3B0ZShwdGVfdCAqcHRlLCB1bnNpZ25lZCBsb25nIGFkZHIsIHZvaWQgKmRh
dGEpCiB7CiAJaWYgKCFwdGVfcHJlc2VudCgqcHRlKSB8fCBwdGVfbm9uZSgqcHRlKSkgewpAQCAt
ODczLDEwICs4ODcsMTEgQEAgc3RhdGljIGludCBwcmVmYXVsdF9yYW5nZSh1NjQgc3RhcnQsIHU2
NCBsZW4pCiAJcmV0dXJuIF9fZ2V0X3VzZXIoYywgZW5kIC0gMSk7CiB9CiAKLXN0YXRpYyBpbnQg
aWd0X21tYXBfZ3R0X3Jldm9rZSh2b2lkICphcmcpCitzdGF0aWMgaW50IGlndF9tbWFwX3Jldm9r
ZSh2b2lkICphcmcsIGVudW0gaTkxNV9tbWFwX3R5cGUgdHlwZSkKIHsKIAlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IGFyZzsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2Jq
OworCXN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICptbW87CiAJdW5zaWduZWQgbG9uZyBhZGRyOwog
CWludCBlcnI7CiAKQEAgLTg4NywxMiArOTAyLDEzIEBAIHN0YXRpYyBpbnQgaWd0X21tYXBfZ3R0
X3Jldm9rZSh2b2lkICphcmcpCiAJaWYgKElTX0VSUihvYmopKQogCQlyZXR1cm4gUFRSX0VSUihv
YmopOwogCi0JZXJyID0gY3JlYXRlX21tYXBfb2Zmc2V0KG9iaik7Ci0JaWYgKGVycikKKwltbW8g
PSBtbWFwX29mZnNldF9hdHRhY2gob2JqLCB0eXBlLCBOVUxMKTsKKwlpZiAoSVNfRVJSKG1tbykp
IHsKKwkJZXJyID0gUFRSX0VSUihtbW8pOwogCQlnb3RvIG91dDsKKwl9CiAKLQlhZGRyID0gaWd0
X21tYXBfbm9kZShpOTE1LCAmb2JqLT5iYXNlLnZtYV9ub2RlLAotCQkJICAgICAwLCBQUk9UX1dS
SVRFLCBNQVBfU0hBUkVEKTsKKwlhZGRyID0gaWd0X21tYXBfbm9kZShpOTE1LCAmbW1vLT52bWFf
bm9kZSwgMCwgUFJPVF9XUklURSwgTUFQX1NIQVJFRCk7CiAJaWYgKElTX0VSUl9WQUxVRShhZGRy
KSkgewogCQllcnIgPSBhZGRyOwogCQlnb3RvIG91dDsKQEAgLTkwMiw3ICs5MTgsOCBAQCBzdGF0
aWMgaW50IGlndF9tbWFwX2d0dF9yZXZva2Uodm9pZCAqYXJnKQogCWlmIChlcnIpCiAJCWdvdG8g
b3V0X3VubWFwOwogCi0JR0VNX0JVR19PTighYXRvbWljX3JlYWQoJm9iai0+YmluZF9jb3VudCkp
OworCUdFTV9CVUdfT04obW1vLT5tbWFwX3R5cGUgPT0gSTkxNV9NTUFQX1RZUEVfR1RUICYmCisJ
CSAgICFhdG9taWNfcmVhZCgmb2JqLT5iaW5kX2NvdW50KSk7CiAKIAllcnIgPSBjaGVja19wcmVz
ZW50KGFkZHIsIG9iai0+YmFzZS5zaXplKTsKIAlpZiAoZXJyKQpAQCAtOTIwLDYgKzkzNywxNSBA
QCBzdGF0aWMgaW50IGlndF9tbWFwX2d0dF9yZXZva2Uodm9pZCAqYXJnKQogCX0KIAlHRU1fQlVH
X09OKGF0b21pY19yZWFkKCZvYmotPmJpbmRfY291bnQpKTsKIAorCWlmICh0eXBlICE9IEk5MTVf
TU1BUF9UWVBFX0dUVCkgeworCQlfX2k5MTVfZ2VtX29iamVjdF9wdXRfcGFnZXMob2JqKTsKKwkJ
aWYgKGk5MTVfZ2VtX29iamVjdF9oYXNfcGFnZXMob2JqKSkgeworCQkJcHJfZXJyKCJGYWlsZWQg
dG8gcHV0LXBhZ2VzIG9iamVjdCFcbiIpOworCQkJZXJyID0gLUVJTlZBTDsKKwkJCWdvdG8gb3V0
X3VubWFwOworCQl9CisJfQorCiAJZXJyID0gY2hlY2tfYWJzZW50KGFkZHIsIG9iai0+YmFzZS5z
aXplKTsKIAlpZiAoZXJyKQogCQlnb3RvIG91dF91bm1hcDsKQEAgLTkzMSw2ICs5NTcsMTYgQEAg
c3RhdGljIGludCBpZ3RfbW1hcF9ndHRfcmV2b2tlKHZvaWQgKmFyZykKIAlyZXR1cm4gZXJyOwog
fQogCitzdGF0aWMgaW50IGlndF9tbWFwX2d0dF9yZXZva2Uodm9pZCAqYXJnKQoreworCXJldHVy
biBpZ3RfbW1hcF9yZXZva2UoYXJnLCBJOTE1X01NQVBfVFlQRV9HVFQpOworfQorCitzdGF0aWMg
aW50IGlndF9tbWFwX2NwdV9yZXZva2Uodm9pZCAqYXJnKQoreworCXJldHVybiBpZ3RfbW1hcF9y
ZXZva2UoYXJnLCBJOTE1X01NQVBfVFlQRV9XQyk7Cit9CisKIGludCBpOTE1X2dlbV9tbWFuX2xp
dmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogewogCXN0YXRpYyBj
b25zdCBzdHJ1Y3QgaTkxNV9zdWJ0ZXN0IHRlc3RzW10gPSB7CkBAIC05MzgsNyArOTc0LDkgQEAg
aW50IGk5MTVfZ2VtX21tYW5fbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCiAJCVNVQlRFU1QoaWd0X3Ntb2tlX3RpbGluZyksCiAJCVNVQlRFU1QoaWd0X21tYXBf
b2Zmc2V0X2V4aGF1c3Rpb24pLAogCQlTVUJURVNUKGlndF9tbWFwX2d0dCksCisJCVNVQlRFU1Qo
aWd0X21tYXBfY3B1KSwKIAkJU1VCVEVTVChpZ3RfbW1hcF9ndHRfcmV2b2tlKSwKKwkJU1VCVEVT
VChpZ3RfbW1hcF9jcHVfcmV2b2tlKSwKIAl9OwogCiAJcmV0dXJuIGk5MTVfc3VidGVzdHModGVz
dHMsIGk5MTUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVz
ZXQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMKaW5kZXggMzYxODky
MzhlMTNjLi4wZTk0YjcyMGM5OTMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX3Jlc2V0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQu
YwpAQCAtNjc4LDggKzY3OCwxMyBAQCBzdGF0aWMgdm9pZCByZXZva2VfbW1hcHMoc3RydWN0IGlu
dGVsX2d0ICpndCkKIAkJCWNvbnRpbnVlOwogCiAJCUdFTV9CVUdfT04odm1hLT5mZW5jZSAhPSAm
Z3QtPmdndHQtPmZlbmNlX3JlZ3NbaV0pOwotCQlub2RlID0gJnZtYS0+b2JqLT5iYXNlLnZtYV9u
b2RlOworCisJCWlmICghdm1hLT5tbW8pCisJCQljb250aW51ZTsKKworCQlub2RlID0gJnZtYS0+
bW1vLT52bWFfbm9kZTsKIAkJdm1hX29mZnNldCA9IHZtYS0+Z2d0dF92aWV3LnBhcnRpYWwub2Zm
c2V0IDw8IFBBR0VfU0hJRlQ7CisKIAkJdW5tYXBfbWFwcGluZ19yYW5nZShndC0+aTkxNS0+ZHJt
LmFub25faW5vZGUtPmlfbWFwcGluZywKIAkJCQkgICAgZHJtX3ZtYV9ub2RlX29mZnNldF9hZGRy
KG5vZGUpICsgdm1hX29mZnNldCwKIAkJCQkgICAgdm1hLT5zaXplLApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
ZHJ2LmMKaW5kZXggMzQzNDRiNjMyZTFmLi43M2EzODVmODA5ZDMgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kcnYuYwpAQCAtNjEsNiArNjEsNyBAQAogCiAjaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX2NvbnRl
eHQuaCIKICNpbmNsdWRlICJnZW0vaTkxNV9nZW1faW9jdGxzLmgiCisjaW5jbHVkZSAiZ2VtL2k5
MTVfZ2VtX21tYW4uaCIKICNpbmNsdWRlICJndC9pbnRlbF9ndC5oIgogI2luY2x1ZGUgImd0L2lu
dGVsX2d0X3BtLmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfcmM2LmgiCkBAIC0yNjYwLDE4ICsyNjYx
LDEyIEBAIGNvbnN0IHN0cnVjdCBkZXZfcG1fb3BzIGk5MTVfcG1fb3BzID0gewogCS5ydW50aW1l
X3Jlc3VtZSA9IGludGVsX3J1bnRpbWVfcmVzdW1lLAogfTsKIAotc3RhdGljIGNvbnN0IHN0cnVj
dCB2bV9vcGVyYXRpb25zX3N0cnVjdCBpOTE1X2dlbV92bV9vcHMgPSB7Ci0JLmZhdWx0ID0gaTkx
NV9nZW1fZmF1bHQsCi0JLm9wZW4gPSBkcm1fZ2VtX3ZtX29wZW4sCi0JLmNsb3NlID0gZHJtX2dl
bV92bV9jbG9zZSwKLX07Ci0KIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVyYXRpb25zIGk5
MTVfZHJpdmVyX2ZvcHMgPSB7CiAJLm93bmVyID0gVEhJU19NT0RVTEUsCiAJLm9wZW4gPSBkcm1f
b3BlbiwKIAkucmVsZWFzZSA9IGRybV9yZWxlYXNlLAogCS51bmxvY2tlZF9pb2N0bCA9IGRybV9p
b2N0bCwKLQkubW1hcCA9IGRybV9nZW1fbW1hcCwKKwkubW1hcCA9IGk5MTVfZ2VtX21tYXAsCiAJ
LnBvbGwgPSBkcm1fcG9sbCwKIAkucmVhZCA9IGRybV9yZWFkLAogCS5jb21wYXRfaW9jdGwgPSBp
OTE1X2NvbXBhdF9pb2N0bCwKQEAgLTI3MTgsNyArMjcxMyw3IEBAIHN0YXRpYyBjb25zdCBzdHJ1
Y3QgZHJtX2lvY3RsX2Rlc2MgaTkxNV9pb2N0bHNbXSA9IHsKIAlEUk1fSU9DVExfREVGX0RSVihJ
OTE1X0dFTV9QUkVBRCwgaTkxNV9nZW1fcHJlYWRfaW9jdGwsIERSTV9SRU5ERVJfQUxMT1cpLAog
CURSTV9JT0NUTF9ERUZfRFJWKEk5MTVfR0VNX1BXUklURSwgaTkxNV9nZW1fcHdyaXRlX2lvY3Rs
LCBEUk1fUkVOREVSX0FMTE9XKSwKIAlEUk1fSU9DVExfREVGX0RSVihJOTE1X0dFTV9NTUFQLCBp
OTE1X2dlbV9tbWFwX2lvY3RsLCBEUk1fUkVOREVSX0FMTE9XKSwKLQlEUk1fSU9DVExfREVGX0RS
VihJOTE1X0dFTV9NTUFQX0dUVCwgaTkxNV9nZW1fbW1hcF9ndHRfaW9jdGwsIERSTV9SRU5ERVJf
QUxMT1cpLAorCURSTV9JT0NUTF9ERUZfRFJWKEk5MTVfR0VNX01NQVBfT0ZGU0VULCBpOTE1X2dl
bV9tbWFwX29mZnNldF9pb2N0bCwgRFJNX1JFTkRFUl9BTExPVyksCiAJRFJNX0lPQ1RMX0RFRl9E
UlYoSTkxNV9HRU1fU0VUX0RPTUFJTiwgaTkxNV9nZW1fc2V0X2RvbWFpbl9pb2N0bCwgRFJNX1JF
TkRFUl9BTExPVyksCiAJRFJNX0lPQ1RMX0RFRl9EUlYoSTkxNV9HRU1fU1dfRklOSVNILCBpOTE1
X2dlbV9zd19maW5pc2hfaW9jdGwsIERSTV9SRU5ERVJfQUxMT1cpLAogCURSTV9JT0NUTF9ERUZf
RFJWKEk5MTVfR0VNX1NFVF9USUxJTkcsIGk5MTVfZ2VtX3NldF90aWxpbmdfaW9jdGwsIERSTV9S
RU5ERVJfQUxMT1cpLApAQCAtMjc2MCw3ICsyNzU1LDYgQEAgc3RhdGljIHN0cnVjdCBkcm1fZHJp
dmVyIGRyaXZlciA9IHsKIAogCS5nZW1fY2xvc2Vfb2JqZWN0ID0gaTkxNV9nZW1fY2xvc2Vfb2Jq
ZWN0LAogCS5nZW1fZnJlZV9vYmplY3RfdW5sb2NrZWQgPSBpOTE1X2dlbV9mcmVlX29iamVjdCwK
LQkuZ2VtX3ZtX29wcyA9ICZpOTE1X2dlbV92bV9vcHMsCiAKIAkucHJpbWVfaGFuZGxlX3RvX2Zk
ID0gZHJtX2dlbV9wcmltZV9oYW5kbGVfdG9fZmQsCiAJLnByaW1lX2ZkX3RvX2hhbmRsZSA9IGRy
bV9nZW1fcHJpbWVfZmRfdG9faGFuZGxlLApAQCAtMjc3MSw3ICsyNzY1LDggQEAgc3RhdGljIHN0
cnVjdCBkcm1fZHJpdmVyIGRyaXZlciA9IHsKIAkuZ2V0X3NjYW5vdXRfcG9zaXRpb24gPSBpOTE1
X2dldF9jcnRjX3NjYW5vdXRwb3MsCiAKIAkuZHVtYl9jcmVhdGUgPSBpOTE1X2dlbV9kdW1iX2Ny
ZWF0ZSwKLQkuZHVtYl9tYXBfb2Zmc2V0ID0gaTkxNV9nZW1fbW1hcF9ndHQsCisJLmR1bWJfbWFw
X29mZnNldCA9IGk5MTVfZ2VtX2R1bWJfbW1hcF9vZmZzZXQsCisKIAkuaW9jdGxzID0gaTkxNV9p
b2N0bHMsCiAJLm51bV9pb2N0bHMgPSBBUlJBWV9TSVpFKGk5MTVfaW9jdGxzKSwKIAkuZm9wcyA9
ICZpOTE1X2RyaXZlcl9mb3BzLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKaW5kZXggMTQ3NDRjMTE0
NDc1Li4wZDRhZDE4ZTEwZGQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
ZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaApAQCAtMTg1Nyw5ICsx
ODU3LDYgQEAgaTkxNV9tdXRleF9sb2NrX2ludGVycnVwdGlibGUoc3RydWN0IGRybV9kZXZpY2Ug
KmRldikKIGludCBpOTE1X2dlbV9kdW1iX2NyZWF0ZShzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJp
diwKIAkJCSBzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAogCQkJIHN0cnVjdCBkcm1fbW9kZV9jcmVh
dGVfZHVtYiAqYXJncyk7Ci1pbnQgaTkxNV9nZW1fbW1hcF9ndHQoc3RydWN0IGRybV9maWxlICpm
aWxlX3ByaXYsIHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCi0JCSAgICAgIHUzMiBoYW5kbGUsIHU2
NCAqb2Zmc2V0KTsKLWludCBpOTE1X2dlbV9tbWFwX2d0dF92ZXJzaW9uKHZvaWQpOwogCiBpbnQg
X19tdXN0X2NoZWNrIGk5MTVfZ2VtX3NldF9nbG9iYWxfc2Vxbm8oc3RydWN0IGRybV9kZXZpY2Ug
KmRldiwgdTMyIHNlcW5vKTsKIApAQCAtMTg4Miw3ICsxODc5LDYgQEAgdm9pZCBpOTE1X2dlbV9k
cml2ZXJfcmVsZWFzZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwogdm9pZCBp
OTE1X2dlbV9zdXNwZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiB2b2lk
IGk5MTVfZ2VtX3N1c3BlbmRfbGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Owogdm9pZCBpOTE1X2dlbV9yZXN1bWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KTsKLXZtX2ZhdWx0X3QgaTkxNV9nZW1fZmF1bHQoc3RydWN0IHZtX2ZhdWx0ICp2bWYpOwogCiBp
bnQgaTkxNV9nZW1fb3BlbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgc3RydWN0IGRy
bV9maWxlICpmaWxlKTsKIHZvaWQgaTkxNV9nZW1fcmVsZWFzZShzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2LCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKaW5kZXgg
ZWI5ZTI2MDljNTY5Li4wN2I3YThhNjcxZDAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZ2VtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwpAQCAt
NDQsNiArNDQsNyBAQAogI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9jbGZsdXNoLmgiCiAjaW5jbHVk
ZSAiZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaCIKICNpbmNsdWRlICJnZW0vaTkxNV9nZW1faW9jdGxz
LmgiCisjaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX21tYW4uaCIKICNpbmNsdWRlICJnZW0vaTkxNV9n
ZW1fcG0uaCIKICNpbmNsdWRlICJndC9pbnRlbF9jb250ZXh0LmgiCiAjaW5jbHVkZSAiZ3QvaW50
ZWxfZW5naW5lX3VzZXIuaCIKQEAgLTg4NSw3ICs4ODYsNyBAQCB2b2lkIGk5MTVfZ2VtX3J1bnRp
bWVfc3VzcGVuZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAogCWxpc3RfZm9yX2Vh
Y2hfZW50cnlfc2FmZShvYmosIG9uLAogCQkJCSAmaTkxNS0+Z2d0dC51c2VyZmF1bHRfbGlzdCwg
dXNlcmZhdWx0X2xpbmspCi0JCV9faTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcChvYmopOwor
CQlfX2k5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXBfZ3R0KG9iaik7CiAKIAkvKgogCSAqIFRo
ZSBmZW5jZSB3aWxsIGJlIGxvc3Qgd2hlbiB0aGUgZGV2aWNlIHBvd2VycyBkb3duLiBJZiBhbnkg
d2VyZQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZXRwYXJhbS5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZXRwYXJhbS5jCmluZGV4IGNmOGE4YzNlZjA0Ny4u
NTRmY2U4MWQ1NzI0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dldHBh
cmFtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZXRwYXJhbS5jCkBAIC0yLDYg
KzIsNyBAQAogICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAogICovCiAKKyNpbmNsdWRl
ICJnZW0vaTkxNV9nZW1fbW1hbi5oIgogI2luY2x1ZGUgImd0L2ludGVsX2VuZ2luZV91c2VyLmgi
CiAKICNpbmNsdWRlICJpOTE1X2Rydi5oIgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV92bWEuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMKaW5kZXggZTU1
MTJmMjZlMjBhLi41NjRmYTk3NTU4YzUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfdm1hLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYwpAQCAtMTA1
NCwxNyArMTA1NCwxNiBAQCBzdGF0aWMgdm9pZCBfX2k5MTVfdm1hX2lvdW5tYXAoc3RydWN0IGk5
MTVfdm1hICp2bWEpCiAKIHZvaWQgaTkxNV92bWFfcmV2b2tlX21tYXAoc3RydWN0IGk5MTVfdm1h
ICp2bWEpCiB7Ci0Jc3RydWN0IGRybV92bWFfb2Zmc2V0X25vZGUgKm5vZGUgPSAmdm1hLT5vYmot
PmJhc2Uudm1hX25vZGU7CisJc3RydWN0IGRybV92bWFfb2Zmc2V0X25vZGUgKm5vZGU7CiAJdTY0
IHZtYV9vZmZzZXQ7CiAKLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZ2bWEtPnZtLT5tdXRleCk7Ci0K
IAlpZiAoIWk5MTVfdm1hX2hhc191c2VyZmF1bHQodm1hKSkKIAkJcmV0dXJuOwogCiAJR0VNX0JV
R19PTighaTkxNV92bWFfaXNfbWFwX2FuZF9mZW5jZWFibGUodm1hKSk7CiAJR0VNX0JVR19PTigh
dm1hLT5vYmotPnVzZXJmYXVsdF9jb3VudCk7CiAKKwlub2RlID0gJnZtYS0+bW1vLT52bWFfbm9k
ZTsKIAl2bWFfb2Zmc2V0ID0gdm1hLT5nZ3R0X3ZpZXcucGFydGlhbC5vZmZzZXQgPDwgUEFHRV9T
SElGVDsKIAl1bm1hcF9tYXBwaW5nX3JhbmdlKHZtYS0+dm0tPmk5MTUtPmRybS5hbm9uX2lub2Rl
LT5pX21hcHBpbmcsCiAJCQkgICAgZHJtX3ZtYV9ub2RlX29mZnNldF9hZGRyKG5vZGUpICsgdm1h
X29mZnNldCwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmggYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5oCmluZGV4IDQ2NTkzMjgxM2JjNS4uZjA5ZjRm
NTEzYzQxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5oCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmgKQEAgLTYzLDYgKzYzLDkgQEAgc3RydWN0
IGk5MTVfdm1hIHsKIAl1NjQgZGlzcGxheV9hbGlnbm1lbnQ7CiAJc3RydWN0IGk5MTVfcGFnZV9z
aXplcyBwYWdlX3NpemVzOwogCisJLyogbW1hcC1vZmZzZXQgYXNzb2NpYXRlZCB3aXRoIGZlbmNp
bmcgZm9yIHRoaXMgdm1hICovCisJc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQJKm1tbzsKKwogCXUz
MiBmZW5jZV9zaXplOwogCXUzMiBmZW5jZV9hbGlnbm1lbnQ7CiAKZGlmZiAtLWdpdCBhL2luY2x1
ZGUvdWFwaS9kcm0vaTkxNV9kcm0uaCBiL2luY2x1ZGUvdWFwaS9kcm0vaTkxNV9kcm0uaAppbmRl
eCA1NDAwZDdlMDU3ZjEuLjgyOWMwYTQ4NTc3ZiAxMDA2NDQKLS0tIGEvaW5jbHVkZS91YXBpL2Ry
bS9pOTE1X2RybS5oCisrKyBiL2luY2x1ZGUvdWFwaS9kcm0vaTkxNV9kcm0uaApAQCAtMzk1LDYg
KzM5NSw3IEBAIHR5cGVkZWYgc3RydWN0IF9kcm1faTkxNV9zYXJlYSB7CiAjZGVmaW5lIERSTV9J
T0NUTF9JOTE1X0dFTV9QV1JJVEUJRFJNX0lPVyAoRFJNX0NPTU1BTkRfQkFTRSArIERSTV9JOTE1
X0dFTV9QV1JJVEUsIHN0cnVjdCBkcm1faTkxNV9nZW1fcHdyaXRlKQogI2RlZmluZSBEUk1fSU9D
VExfSTkxNV9HRU1fTU1BUAkJRFJNX0lPV1IoRFJNX0NPTU1BTkRfQkFTRSArIERSTV9JOTE1X0dF
TV9NTUFQLCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX21tYXApCiAjZGVmaW5lIERSTV9JT0NUTF9JOTE1
X0dFTV9NTUFQX0dUVAlEUk1fSU9XUihEUk1fQ09NTUFORF9CQVNFICsgRFJNX0k5MTVfR0VNX01N
QVBfR1RULCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX21tYXBfZ3R0KQorI2RlZmluZSBEUk1fSU9DVExf
STkxNV9HRU1fTU1BUF9PRkZTRVQJRFJNX0lPV1IoRFJNX0NPTU1BTkRfQkFTRSArIERSTV9JOTE1
X0dFTV9NTUFQX0dUVCwgc3RydWN0IGRybV9pOTE1X2dlbV9tbWFwX29mZnNldCkKICNkZWZpbmUg
RFJNX0lPQ1RMX0k5MTVfR0VNX1NFVF9ET01BSU4JRFJNX0lPVyAoRFJNX0NPTU1BTkRfQkFTRSAr
IERSTV9JOTE1X0dFTV9TRVRfRE9NQUlOLCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX3NldF9kb21haW4p
CiAjZGVmaW5lIERSTV9JT0NUTF9JOTE1X0dFTV9TV19GSU5JU0gJRFJNX0lPVyAoRFJNX0NPTU1B
TkRfQkFTRSArIERSTV9JOTE1X0dFTV9TV19GSU5JU0gsIHN0cnVjdCBkcm1faTkxNV9nZW1fc3df
ZmluaXNoKQogI2RlZmluZSBEUk1fSU9DVExfSTkxNV9HRU1fU0VUX1RJTElORwlEUk1fSU9XUiAo
RFJNX0NPTU1BTkRfQkFTRSArIERSTV9JOTE1X0dFTV9TRVRfVElMSU5HLCBzdHJ1Y3QgZHJtX2k5
MTVfZ2VtX3NldF90aWxpbmcpCkBAIC03OTMsNiArNzk0LDM3IEBAIHN0cnVjdCBkcm1faTkxNV9n
ZW1fbW1hcF9ndHQgewogCV9fdTY0IG9mZnNldDsKIH07CiAKK3N0cnVjdCBkcm1faTkxNV9nZW1f
bW1hcF9vZmZzZXQgeworCS8qKiBIYW5kbGUgZm9yIHRoZSBvYmplY3QgYmVpbmcgbWFwcGVkLiAq
LworCV9fdTMyIGhhbmRsZTsKKwlfX3UzMiBwYWQ7CisJLyoqCisJICogRmFrZSBvZmZzZXQgdG8g
dXNlIGZvciBzdWJzZXF1ZW50IG1tYXAgY2FsbAorCSAqCisJICogVGhpcyBpcyBhIGZpeGVkLXNp
emUgdHlwZSBmb3IgMzIvNjQgY29tcGF0aWJpbGl0eS4KKwkgKi8KKwlfX3U2NCBvZmZzZXQ7CisK
KwkvKioKKwkgKiBGbGFncyBmb3IgZXh0ZW5kZWQgYmVoYXZpb3VyLgorCSAqCisJICogSXQgaXMg
bWFuZGF0b3J5IHRoYXQgb25lIG9mIHRoZSBNTUFQX09GRlNFVCB0eXBlcworCSAqIChHVFQsIFdD
LCBXQiwgVUMsIGV0Yykgc2hvdWxkIGJlIGluY2x1ZGVkLgorCSAqLworCV9fdTY0IGZsYWdzOwor
I2RlZmluZSBJOTE1X01NQVBfT0ZGU0VUX0dUVCAwCisjZGVmaW5lIEk5MTVfTU1BUF9PRkZTRVRf
V0MgIDEKKyNkZWZpbmUgSTkxNV9NTUFQX09GRlNFVF9XQiAgMgorI2RlZmluZSBJOTE1X01NQVBf
T0ZGU0VUX1VDICAzCisKKwkvKgorCSAqIFplcm8tdGVybWluYXRlZCBjaGFpbiBvZiBleHRlbnNp
b25zLgorCSAqCisJICogTm8gY3VycmVudCBleHRlbnNpb25zIGRlZmluZWQ7IG1iei4KKwkgKi8K
KwlfX3U2NCBleHRlbnNpb25zOworfTsKKwogc3RydWN0IGRybV9pOTE1X2dlbV9zZXRfZG9tYWlu
IHsKIAkvKiogSGFuZGxlIGZvciB0aGUgb2JqZWN0ICovCiAJX191MzIgaGFuZGxlOwotLSAKMi4y
NC4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRl
bC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6
Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

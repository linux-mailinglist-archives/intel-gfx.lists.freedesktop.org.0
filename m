Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 105AAB80CA
	for <lists+intel-gfx@lfdr.de>; Thu, 19 Sep 2019 20:27:07 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 5FC596F543;
	Thu, 19 Sep 2019 18:27:05 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga11.intel.com (mga11.intel.com [192.55.52.93])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 189B06F543
 for <intel-gfx@lists.freedesktop.org>; Thu, 19 Sep 2019 18:27:04 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga008.jf.intel.com ([10.7.209.65])
 by fmsmga102.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 19 Sep 2019 11:27:03 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,524,1559545200"; d="scan'208";a="181562010"
Received: from genxfsim-shark-bay-client-platform.iind.intel.com
 ([10.223.34.144])
 by orsmga008.jf.intel.com with ESMTP; 19 Sep 2019 11:26:59 -0700
From: Swati Sharma <swati2.sharma@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 19 Sep 2019 23:47:19 +0530
Message-Id: <1568917040-3365-3-git-send-email-swati2.sharma@intel.com>
X-Mailer: git-send-email 1.9.1
In-Reply-To: <1568917040-3365-1-git-send-email-swati2.sharma@intel.com>
References: <1568917040-3365-1-git-send-email-swati2.sharma@intel.com>
Subject: [Intel-gfx] [v3][PATCH 2/3] drm/i915/color: Extract icl_read_luts()
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: jani.nikula@intel.com, daniel.vetter@ffwll.ch, ankit.k.nautiyal@intel.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Rm9yIGljbCssIGhhdmUgaHcgcmVhZCBvdXQgdG8gY3JlYXRlIGh3IGJsb2Igb2YgZ2FtbWEKbHV0
IHZhbHVlcy4gaWNsKyBwbGF0Zm9ybXMgc3VwcG9ydHMgbXVsdGkgc2VnbWVudGVkIGdhbW1hCm1v
ZGUgYnkgZGVmYXVsdCwgYWRkIGh3IGx1dCBjcmVhdGlvbiBmb3IgdGhpcyBtb2RlLgoKVGhpcyB3
aWxsIGJlIHVzZWQgdG8gdmFsaWRhdGUgZ2FtbWEgcHJvZ3JhbW1pbmcgdXNpbmcgZHNiCihkaXNw
bGF5IHN0YXRlIGJ1ZmZlcikgd2hpY2ggaXMgYSB0Z2wgc3BlY2lmaWMgZmVhdHVyZS4KCkZvbGxv
d2luZyBhcmUgdGhlIG1haW4gY2hhbmdlcyBkb25lIGluIHRoaXMgcGF0Y2g6CjEuIGdhbW1hX2Vu
YWJsZSBjaGVja3MgbWFkZSBzcGVjaWZpYyB0byBwbGF0Zm9ybSBmdW5jKCkKICAgc2luY2UgaWNs
IGRvZWVzbid0IHN1cHBvcnQgdGhhdCBhbmQgZW5hYmxlIGdhbW1hIHRocm91Z2ggbW9kZQoyLiBs
dXRbMF0gYW5kIGx1dFs4XSBlbnRlcmllcyBzaG91bGQgYmUgc2FtZSBzdXBlcmZpbmUgYW5kIGNv
YXJzZTsKICAgc3VwZXJmaW5lIGFuZCBmaW5lIHNlZ21lbnRzIHJlc3BlY3RpdmVseSwgY2hlY2tl
ZCB0d2ljZS1ubyBoYXJtCjMuIFJlbW92ZWQgdGVtcG9yYXJ5IGx1dAo0LiBDb2Fyc2Ugc2VnbWVu
dCBpbnRlcnBvbGF0ZWQgZ2FtbWEgdmFsdWVzIGxvb3Agc3RhcnQgZnJvbSAyCiAgIGluc3RlYWQg
b2YgMCwgc2luY2UgYWN0dWFsIGgvdyB2YWx1ZXMgc3RhcnRlZCBnZXR0aW5nIG92ZXJyaWRlZC4K
CnYyOiAtcmVhZG91dCBjb2RlIGZvciBtdWx0aXNlZ21lbnRlZCBnYW1tYSBoYXMgdG8gY29tZQog
ICAgIHVwIHdpdGggc29tZSBpbnRlcm1lZGlhdGUgZW50cmllcyB0aGF0IGFyZW4ndCBwcmVzZXJ2
ZWQKICAgICBpbiBoYXJkd2FyZSAoSmFuaSBOKQogICAgLWxpbmVhciBpbnRlcnBvbGF0aW9uIChW
aWxsZSkKICAgIC1tb3ZlZCBjb21tb24gY29kZSB0byBjaGVjayBnYW1tYV9lbmFibGUgdG8gc3Bl
Y2lmaWMgZnVuY3MsCiAgICAgc2luY2UgaWNsIGRvZXNuJ3Qgc3VwcG9ydCB0aGF0CnYzOiAtdXNl
IHUxNiBpbnN0ZWFkIG9mIF9fdTE2IFtKYW5pIE5dCiAgICAtdXNlZCBzaW5nbGUgbHV0IFtKYW5p
IE5dCiAgICAtaW1wcm92ZWQgYW5kIG1vcmUgcmVhZGFibGUgZm9yIGxvb3BzIFtKYW5pIE5dCiAg
ICAtcmVhZCB2YWx1ZXMgZGlyZWN0bHkgdG8gYWN0dWFsIGxvY2F0aW9ucyBhbmQgdGhlbiBmaWxs
IGdhcHMgW0phbmkgTl0KICAgIC1tb3ZlZCBjbGVhbmluZyB0byBwYXRjaCAxIFtKYW5pIE5dCiAg
ICAtcmVuYW1lZCBpY2xfcmVhZF9sdXRfbXVsdGlfc2VnKCkgdG8gaWNsX3JlYWRfbHV0X211bHRp
X3NlZ21lbnQgdG8KICAgICBtYWtlIGl0IHNpbWlsYXIgdG8gaWNsX2xvYWRfbHV0cygpCiAgICAt
cmVuYW1lZCBpY2xfY29tcHV0ZV9pbnRlcnBvbGF0ZWRfZ2FtbWFfYmxvYigpIHRvCiAgICAgaWNs
X2NvbXB1dGVfaW50ZXJwb2xhdGVkX2dhbW1hX2x1dF92YWx1ZXMoKSBtb3JlIHNlbnNpYmxlLCBJ
IGd1ZXNzCgpTaWduZWQtb2ZmLWJ5OiBTd2F0aSBTaGFybWEgPHN3YXRpMi5zaGFybWFAaW50ZWwu
Y29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfY29sb3IuYyB8IDIx
NiArKysrKysrKysrKysrKysrKysrKysrKysrKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9yZWcuaCAgICAgICAgICAgIHwgICA3ICsKIDIgZmlsZXMgY2hhbmdlZCwgMjA4IGluc2VydGlv
bnMoKyksIDE1IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfY29sb3IuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfY29sb3IuYwppbmRleCA3NjU0ODJkLi5hZDU0OGNlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2NvbG9yLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9jb2xvci5jCkBAIC0xMzcxLDYgKzEzNzEsOSBAQCBzdGF0aWMgaW50
IGljbF9jb2xvcl9jaGVjayhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKIAog
c3RhdGljIGludCBpOXh4X2dhbW1hX3ByZWNpc2lvbihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKIHsKKwlpZiAoIWNydGNfc3RhdGUtPmdhbW1hX2VuYWJsZSkKKwkJ
cmV0dXJuIDA7CisKIAlzd2l0Y2ggKGNydGNfc3RhdGUtPmdhbW1hX21vZGUpIHsKIAljYXNlIEdB
TU1BX01PREVfTU9ERV84QklUOgogCQlyZXR1cm4gODsKQEAgLTEzODQsNiArMTM4Nyw5IEBAIHN0
YXRpYyBpbnQgaTl4eF9nYW1tYV9wcmVjaXNpb24oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUpCiAKIHN0YXRpYyBpbnQgaWxrX2dhbW1hX3ByZWNpc2lvbihjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKIHsKKwlpZiAoIWNydGNfc3RhdGUt
PmdhbW1hX2VuYWJsZSkKKwkJcmV0dXJuIDA7CisKIAlpZiAoKGNydGNfc3RhdGUtPmNzY19tb2Rl
ICYgQ1NDX1BPU0lUSU9OX0JFRk9SRV9HQU1NQSkgPT0gMCkKIAkJcmV0dXJuIDA7CiAKQEAgLTE0
MDAsNiArMTQwNiw5IEBAIHN0YXRpYyBpbnQgaWxrX2dhbW1hX3ByZWNpc2lvbihjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKIAogc3RhdGljIGludCBjaHZfZ2FtbWFf
cHJlY2lzaW9uKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQogewor
CWlmICghY3J0Y19zdGF0ZS0+Z2FtbWFfZW5hYmxlKQorCQlyZXR1cm4gMDsKKwogCWlmIChjcnRj
X3N0YXRlLT5jZ21fbW9kZSAmIENHTV9QSVBFX01PREVfR0FNTUEpCiAJCXJldHVybiAxMDsKIAll
bHNlCkBAIC0xNDA4LDYgKzE0MTcsOSBAQCBzdGF0aWMgaW50IGNodl9nYW1tYV9wcmVjaXNpb24o
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCiAKIHN0YXRpYyBpbnQg
Z2xrX2dhbW1hX3ByZWNpc2lvbihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSkKIHsKKwlpZiAoIWNydGNfc3RhdGUtPmdhbW1hX2VuYWJsZSkKKwkJcmV0dXJuIDA7CisK
IAlzd2l0Y2ggKGNydGNfc3RhdGUtPmdhbW1hX21vZGUpIHsKIAljYXNlIEdBTU1BX01PREVfTU9E
RV84QklUOgogCQlyZXR1cm4gODsKQEAgLTE0MTksMjEgKzE0MzEsMzkgQEAgc3RhdGljIGludCBn
bGtfZ2FtbWFfcHJlY2lzaW9uKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlKQogCX0KIH0KIAorc3RhdGljIGludCBpY2xfZ2FtbWFfcHJlY2lzaW9uKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQoreworCWlmICgoY3J0Y19zdGF0ZS0+Z2Ft
bWFfbW9kZSAmIFBPU1RfQ1NDX0dBTU1BX0VOQUJMRSkgPT0gMCkKKwkJcmV0dXJuIDA7CisKKwlz
d2l0Y2ggKGNydGNfc3RhdGUtPmdhbW1hX21vZGUgJiBHQU1NQV9NT0RFX01PREVfTUFTSykgewor
CWNhc2UgR0FNTUFfTU9ERV9NT0RFXzhCSVQ6CisJCXJldHVybiA4OworCWNhc2UgR0FNTUFfTU9E
RV9NT0RFXzEwQklUOgorCQlyZXR1cm4gMTA7CisJY2FzZSBHQU1NQV9NT0RFX01PREVfMTJCSVRf
TVVMVElfU0VHTUVOVEVEOgorCQlyZXR1cm4gMTY7CisJZGVmYXVsdDoKKwkJTUlTU0lOR19DQVNF
KGNydGNfc3RhdGUtPmdhbW1hX21vZGUpOworCQlyZXR1cm4gMDsKKwl9CisKK30KKwogaW50IGlu
dGVsX2NvbG9yX2dldF9nYW1tYV9iaXRfcHJlY2lzaW9uKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlKQogewogCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50
ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwogCi0JaWYgKCFjcnRjX3N0YXRl
LT5nYW1tYV9lbmFibGUpCi0JCXJldHVybiAwOwotCiAJaWYgKEhBU19HTUNIKGRldl9wcml2KSkg
ewogCQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCiAJCQlyZXR1cm4gY2h2X2dhbW1hX3By
ZWNpc2lvbihjcnRjX3N0YXRlKTsKIAkJZWxzZQogCQkJcmV0dXJuIGk5eHhfZ2FtbWFfcHJlY2lz
aW9uKGNydGNfc3RhdGUpOwogCX0gZWxzZSB7Ci0JCWlmIChJU19DQU5OT05MQUtFKGRldl9wcml2
KSB8fCBJU19HRU1JTklMQUtFKGRldl9wcml2KSkKKwkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gMTEpCisJCQlyZXR1cm4gaWNsX2dhbW1hX3ByZWNpc2lvbihjcnRjX3N0YXRlKTsKKwkJZWxz
ZSBpZiAoSVNfQ0FOTk9OTEFLRShkZXZfcHJpdikgfHwgSVNfR0VNSU5JTEFLRShkZXZfcHJpdikp
CiAJCQlyZXR1cm4gZ2xrX2dhbW1hX3ByZWNpc2lvbihjcnRjX3N0YXRlKTsKIAkJZWxzZSBpZiAo
SVNfSVJPTkxBS0UoZGV2X3ByaXYpKQogCQkJcmV0dXJuIGlsa19nYW1tYV9wcmVjaXNpb24oY3J0
Y19zdGF0ZSk7CkBAIC0xNDY0LDYgKzE0OTQsMzAgQEAgc3RhdGljIGJvb2wgaW50ZWxfY29sb3Jf
bHV0X2VudHJ5X2VxdWFsKHN0cnVjdCBkcm1fY29sb3JfbHV0ICpsdXQxLAogCXJldHVybiB0cnVl
OwogfQogCitzdGF0aWMgYm9vbCBpbnRlbF9jb2xvcl9sdXRfZW50cnlfbXVsdGlfZXF1YWwoc3Ry
dWN0IGRybV9jb2xvcl9sdXQgKmx1dDEsCisJCQkJCSAgICAgIHN0cnVjdCBkcm1fY29sb3JfbHV0
ICpsdXQyLAorCQkJCQkgICAgICBpbnQgbHV0X3NpemUsIHUzMiBlcnIpCit7CisJaW50IGk7CisK
Kwlmb3IgKGkgPSAwOyBpIDwgOTsgaSsrKSB7CisJCWlmICghZXJyX2NoZWNrKCZsdXQxW2ldLCAm
bHV0MltpXSwgZXJyKSkKKwkJCXJldHVybiBmYWxzZTsKKwl9CisKKwlmb3IgKGkgPSAxOyBpIDwg
MjU3OyBpKyspIHsKKwkJaWYgKCFlcnJfY2hlY2soJmx1dDFbaSAqIDhdLCAmbHV0MltpICogOF0s
IGVycikpCisJCQlyZXR1cm4gZmFsc2U7CisJfQorCisJZm9yIChpID0gMDsgaSA8IDI1NjsgaSsr
KSB7CisJCWlmICghZXJyX2NoZWNrKCZsdXQxW2kgKiA4ICogMTI4XSwgJmx1dDJbaSAqIDggKiAx
MjhdLCBlcnIpKQorCQkJcmV0dXJuIGZhbHNlOworCX0KKworCXJldHVybiB0cnVlOworfQorCiBi
b29sIGludGVsX2NvbG9yX2x1dF9lcXVhbChzdHJ1Y3QgZHJtX3Byb3BlcnR5X2Jsb2IgKmJsb2Ix
LAogCQkJICAgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpibG9iMiwKIAkJCSAgIHUzMiBnYW1t
YV9tb2RlLCB1MzIgYml0X3ByZWNpc2lvbikKQEAgLTE0ODIsMTYgKzE1MzYsOCBAQCBib29sIGlu
dGVsX2NvbG9yX2x1dF9lcXVhbChzdHJ1Y3QgZHJtX3Byb3BlcnR5X2Jsb2IgKmJsb2IxLAogCWx1
dF9zaXplMiA9IGRybV9jb2xvcl9sdXRfc2l6ZShibG9iMik7CiAKIAkvKiBjaGVjayBzdyBhbmQg
aHcgbHV0IHNpemUgKi8KLQlzd2l0Y2ggKGdhbW1hX21vZGUpIHsKLQljYXNlIEdBTU1BX01PREVf
TU9ERV84QklUOgotCWNhc2UgR0FNTUFfTU9ERV9NT0RFXzEwQklUOgotCQlpZiAobHV0X3NpemUx
ICE9IGx1dF9zaXplMikKLQkJCXJldHVybiBmYWxzZTsKLQkJYnJlYWs7Ci0JZGVmYXVsdDoKLQkJ
TUlTU0lOR19DQVNFKGdhbW1hX21vZGUpOwotCQkJcmV0dXJuIGZhbHNlOwotCX0KKwlpZiAobHV0
X3NpemUxICE9IGx1dF9zaXplMikKKwkJcmV0dXJuIGZhbHNlOwogCiAJbHV0MSA9IGJsb2IxLT5k
YXRhOwogCWx1dDIgPSBibG9iMi0+ZGF0YTsKQEAgLTE0OTksMTMgKzE1NDUsMTggQEAgYm9vbCBp
bnRlbF9jb2xvcl9sdXRfZXF1YWwoc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpibG9iMSwKIAll
cnIgPSAweGZmZmYgPj4gYml0X3ByZWNpc2lvbjsKIAogCS8qIGNoZWNrIHN3IGFuZCBodyBsdXQg
ZW50cnkgdG8gYmUgZXF1YWwgKi8KLQlzd2l0Y2ggKGdhbW1hX21vZGUpIHsKKwlzd2l0Y2ggKGdh
bW1hX21vZGUgJiBHQU1NQV9NT0RFX01PREVfTUFTSykgewogCWNhc2UgR0FNTUFfTU9ERV9NT0RF
XzhCSVQ6CiAJY2FzZSBHQU1NQV9NT0RFX01PREVfMTBCSVQ6CiAJCWlmICghaW50ZWxfY29sb3Jf
bHV0X2VudHJ5X2VxdWFsKGx1dDEsIGx1dDIsCiAJCQkJCQkgbHV0X3NpemUyLCBlcnIpKQogCQkJ
cmV0dXJuIGZhbHNlOwogCQlicmVhazsKKwljYXNlIEdBTU1BX01PREVfTU9ERV8xMkJJVF9NVUxU
SV9TRUdNRU5URUQ6CisJCWlmICghaW50ZWxfY29sb3JfbHV0X2VudHJ5X211bHRpX2VxdWFsKGx1
dDEsIGx1dDIsCisJCQkJCQkgICAgICAgbHV0X3NpemUyLCBlcnIpKQorCQkJcmV0dXJuIGZhbHNl
OworCQlicmVhazsKIAlkZWZhdWx0OgogCQlNSVNTSU5HX0NBU0UoZ2FtbWFfbW9kZSk7CiAJCQly
ZXR1cm4gZmFsc2U7CkBAIC0xNzQ1LDYgKzE3OTYsMTQwIEBAIHN0YXRpYyB2b2lkIGdsa19yZWFk
X2x1dHMoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCiAJCWNydGNfc3RhdGUt
PmJhc2UuZ2FtbWFfbHV0ID0gZ2xrX3JlYWRfbHV0XzEwKGNydGNfc3RhdGUsIFBBTF9QUkVDX0lO
REVYX1ZBTFVFKDApKTsKIH0KIAorc3RhdGljIHUxNiBjYWxfc3RlcF9zaXplKHUxNiBlbmRfdmFs
LCB1MTYgc3RhcnRfdmFsLCBpbnQgc3RlcHMpCit7CisJcmV0dXJuICgoZW5kX3ZhbCAtIHN0YXJ0
X3ZhbCkgLyBzdGVwcyk7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgZHJtX2NvbG9yX2x1dCAqCitpY2xf
Y29tcHV0ZV9pbnRlcnBvbGF0ZWRfZ2FtbWFfbHV0X3ZhbHVlcyhzdHJ1Y3QgZHJtX2NvbG9yX2x1
dCAqbHV0LCB1MzIgbHV0X3NpemUpCit7CisJdTE2IHJlZF9zdGVwX3NpemUsIGdyZWVuX3N0ZXBf
c2l6ZSwgYmx1ZV9zdGVwX3NpemU7CisJaW50IHN0YXJ0LCBlbmQsIHN0ZXBzOworCWludCBpLCBq
OworCisJZm9yIChpID0gMTsgaSA8IDI1NyAtIDE7IGkrKykgeworCQlzdGFydCA9IGkgKiA4Owor
CQllbmQgPSAoaSArIDEpICogODsKKwkJc3RlcHMgPSBlbmQgLSBzdGFydDsKKworCQlyZWRfc3Rl
cF9zaXplID0gY2FsX3N0ZXBfc2l6ZShsdXRbZW5kXS5yZWQsIGx1dFtzdGFydF0ucmVkLCBzdGVw
cyk7CisJCWdyZWVuX3N0ZXBfc2l6ZSA9IGNhbF9zdGVwX3NpemUobHV0W2VuZF0uZ3JlZW4sIGx1
dFtzdGFydF0uZ3JlZW4sIHN0ZXBzKTsKKwkJYmx1ZV9zdGVwX3NpemUgPSBjYWxfc3RlcF9zaXpl
KGx1dFtlbmRdLmJsdWUsIGx1dFtzdGFydF0uYmx1ZSwgc3RlcHMpOworCisJCWZvciAoaiA9IHN0
YXJ0ICsgMTsgaiA8IGVuZDsgaisrKSB7CisJCQlsdXRbal0ucmVkID0gbHV0W2ogLSAxXS5yZWQg
KyByZWRfc3RlcF9zaXplOworCQkJbHV0W2pdLmdyZWVuID0gbHV0W2ogLSAxXS5ncmVlbiArIGdy
ZWVuX3N0ZXBfc2l6ZTsKKwkJCWx1dFtqXS5ibHVlID0gbHV0W2ogLSAxXS5ibHVlICsgYmx1ZV9z
dGVwX3NpemU7CisKKwkJCWkrKzsKKwkJfQorCX0KKworCWZvciAoaSA9IDI7IGkgPCAyNTYgLSAx
OyBpKyspIHsKKwkJc3RhcnQgPSBpICogOCAqIDEyODsKKwkJZW5kID0gKGkgKyAxKSAqIDggKiAx
Mjg7CisJCXN0ZXBzID0gZW5kIC0gc3RhcnQ7CisKKwkJcmVkX3N0ZXBfc2l6ZSA9IGNhbF9zdGVw
X3NpemUobHV0W2VuZF0ucmVkLCBsdXRbc3RhcnRdLnJlZCwgc3RlcHMpOworCQlncmVlbl9zdGVw
X3NpemUgPSBjYWxfc3RlcF9zaXplKGx1dFtlbmRdLmdyZWVuLCBsdXRbc3RhcnRdLmdyZWVuLCBz
dGVwcyk7CisJCWJsdWVfc3RlcF9zaXplID0gY2FsX3N0ZXBfc2l6ZShsdXRbZW5kXS5ibHVlLCBs
dXRbc3RhcnRdLmJsdWUsIHN0ZXBzKTsKKworCQlmb3IgKGogPSBzdGFydCArIDE7IGogPCBlbmQ7
IGorKykgeworCQkJbHV0W2pdLnJlZCA9IGx1dFtqIC0gMV0ucmVkICsgcmVkX3N0ZXBfc2l6ZTsK
KwkJCWx1dFtqXS5ncmVlbiA9IGx1dFtqIC0gMV0uZ3JlZW4gKyBncmVlbl9zdGVwX3NpemU7CisJ
CQlsdXRbal0uYmx1ZSA9IGx1dFtqIC0gMV0uYmx1ZSArIGJsdWVfc3RlcF9zaXplOworCisJCQlp
Kys7CisJCX0KKwl9CisKKwlyZXR1cm4gbHV0OworfQorCitzdGF0aWMgc3RydWN0IGRybV9wcm9w
ZXJ0eV9ibG9iICoKK2ljbF9yZWFkX2x1dF9tdWx0aV9zZWdtZW50KGNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQoreworCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0g
dG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOworCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOworCWludCBsdXRfc2l6
ZSA9IElOVEVMX0lORk8oZGV2X3ByaXYpLT5jb2xvci5nYW1tYV9sdXRfc2l6ZTsKKwllbnVtIHBp
cGUgcGlwZSA9IGNydGMtPnBpcGU7CisJc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpibG9iOwor
CXN0cnVjdCBkcm1fY29sb3JfbHV0ICpibG9iX2RhdGE7CisJdTMyIGksIHZhbDEsIHZhbDI7CisK
KwlibG9iID0gZHJtX3Byb3BlcnR5X2NyZWF0ZV9ibG9iKCZkZXZfcHJpdi0+ZHJtLAorCQkJCQlz
aXplb2Yoc3RydWN0IGRybV9jb2xvcl9sdXQpICogbHV0X3NpemUsCisJCQkJCU5VTEwpOworCWlm
IChJU19FUlIoYmxvYikpCisJCXJldHVybiBOVUxMOworCisJYmxvYl9kYXRhID0gYmxvYi0+ZGF0
YTsKKworCUk5MTVfV1JJVEUoUFJFQ19QQUxfTVVMVElfU0VHX0lOREVYKHBpcGUpLCBQQUxfUFJF
Q19BVVRPX0lOQ1JFTUVOVCk7CisKKwlmb3IgKGkgPSAwOyBpIDwgOTsgaSsrKSB7CisJCXZhbDEg
PSBJOTE1X1JFQUQoUFJFQ19QQUxfTVVMVElfU0VHX0RBVEEocGlwZSkpOworCQl2YWwyID0gSTkx
NV9SRUFEKFBSRUNfUEFMX01VTFRJX1NFR19EQVRBKHBpcGUpKTsKKworCQlibG9iX2RhdGFbaV0u
cmVkID0gUkVHX0ZJRUxEX0dFVChQQUxfUFJFQ19NVUxUSV9TRUdfUkVEX1VEV19NQVNLLCB2YWwy
KSA8PCA2IHwKKwkJCQkgICBSRUdfRklFTERfR0VUKFBBTF9QUkVDX01VTFRJX1NFR19SRURfTERX
X01BU0ssIHZhbDEpOworCQlibG9iX2RhdGFbaV0uZ3JlZW4gPSBSRUdfRklFTERfR0VUKFBBTF9Q
UkVDX01VTFRJX1NFR19HUkVFTl9VRFdfTUFTSywgdmFsMikgPDwgNiB8CisJCQkJICAgICBSRUdf
RklFTERfR0VUKFBBTF9QUkVDX01VTFRJX1NFR19HUkVFTl9MRFdfTUFTSywgdmFsMSk7CisJCWJs
b2JfZGF0YVtpXS5ibHVlID0gUkVHX0ZJRUxEX0dFVChQQUxfUFJFQ19NVUxUSV9TRUdfQkxVRV9V
RFdfTUFTSywgdmFsMikgPDwgNiB8CisJCQkJICAgIFJFR19GSUVMRF9HRVQoUEFMX1BSRUNfTVVM
VElfU0VHX0JMVUVfTERXX01BU0ssIHZhbDEpOworCX0KKworCUk5MTVfV1JJVEUoUFJFQ19QQUxf
SU5ERVgocGlwZSksIFBBTF9QUkVDX0FVVE9fSU5DUkVNRU5UKTsKKworCWZvciAoaSA9IDE7IGkg
PCAyNTc7IGkrKykgeworCQl2YWwxID0gSTkxNV9SRUFEKFBSRUNfUEFMX0RBVEEocGlwZSkpOwor
CQl2YWwyID0gSTkxNV9SRUFEKFBSRUNfUEFMX0RBVEEocGlwZSkpOworCisJCWJsb2JfZGF0YVtp
ICogOF0ucmVkID0gUkVHX0ZJRUxEX0dFVChQQUxfUFJFQ19NVUxUSV9TRUdfUkVEX1VEV19NQVNL
LCB2YWwyKSA8PCA2IHwKKwkJCQkgICAgICAgUkVHX0ZJRUxEX0dFVChQQUxfUFJFQ19NVUxUSV9T
RUdfUkVEX0xEV19NQVNLLCB2YWwxKTsKKwkJYmxvYl9kYXRhW2kgKiA4XS5ncmVlbiA9IFJFR19G
SUVMRF9HRVQoUEFMX1BSRUNfTVVMVElfU0VHX0dSRUVOX1VEV19NQVNLLCB2YWwyKSA8PCA2IHwK
KwkJCQkJIFJFR19GSUVMRF9HRVQoUEFMX1BSRUNfTVVMVElfU0VHX0dSRUVOX0xEV19NQVNLLCB2
YWwxKTsKKwkJYmxvYl9kYXRhW2kgKiA4XS5ibHVlID0gUkVHX0ZJRUxEX0dFVChQQUxfUFJFQ19N
VUxUSV9TRUdfQkxVRV9VRFdfTUFTSywgdmFsMikgPDwgNiB8CisJCQkJCVJFR19GSUVMRF9HRVQo
UEFMX1BSRUNfTVVMVElfU0VHX0JMVUVfTERXX01BU0ssIHZhbDEpOworCX0KKworCWZvciAoaSA9
IDA7IGkgPCAyNTY7IGkrKykgeworCQl2YWwxID0gSTkxNV9SRUFEKFBSRUNfUEFMX0RBVEEocGlw
ZSkpOworCQl2YWwyID0gSTkxNV9SRUFEKFBSRUNfUEFMX0RBVEEocGlwZSkpOworCisJCWJsb2Jf
ZGF0YVtpICogOCAqIDEyOF0ucmVkID0gUkVHX0ZJRUxEX0dFVChQQUxfUFJFQ19NVUxUSV9TRUdf
UkVEX1VEV19NQVNLLCB2YWwyKSA8PCA2IHwKKwkJCQkJICAgICBSRUdfRklFTERfR0VUKFBBTF9Q
UkVDX01VTFRJX1NFR19SRURfTERXX01BU0ssIHZhbDEpOworCQlibG9iX2RhdGFbaSAqIDggKiAx
MjhdLmdyZWVuID0gUkVHX0ZJRUxEX0dFVChQQUxfUFJFQ19NVUxUSV9TRUdfR1JFRU5fVURXX01B
U0ssIHZhbDIpIDw8IDYgfAorCQkJCQkgICAgICAgUkVHX0ZJRUxEX0dFVChQQUxfUFJFQ19NVUxU
SV9TRUdfR1JFRU5fTERXX01BU0ssIHZhbDEpOworCQlibG9iX2RhdGFbaSAqIDggKiAxMjhdLmJs
dWUgPSBSRUdfRklFTERfR0VUKFBBTF9QUkVDX01VTFRJX1NFR19CTFVFX1VEV19NQVNLLCB2YWwy
KSA8PCA2IHwKKwkJCQkJICAgICAgUkVHX0ZJRUxEX0dFVChQQUxfUFJFQ19NVUxUSV9TRUdfQkxV
RV9MRFdfTUFTSywgdmFsMSk7CisJfQorCisJYmxvYl9kYXRhW2x1dF9zaXplIC0gMV0ucmVkID0g
UkVHX0ZJRUxEX0dFVChQUkVDX1BBTF9HQ19NQVhfUkdCX01BU0ssCisJCQkJCQkgICAgSTkxNV9S
RUFEKFBSRUNfUEFMX0dDX01BWChwaXBlLCAwKSkpOworCWJsb2JfZGF0YVtsdXRfc2l6ZSAtIDFd
LmdyZWVuID0gUkVHX0ZJRUxEX0dFVChQUkVDX1BBTF9HQ19NQVhfUkdCX01BU0ssCisJCQkJCQkg
ICAgICBJOTE1X1JFQUQoUFJFQ19QQUxfR0NfTUFYKHBpcGUsIDEpKSk7CisJYmxvYl9kYXRhW2x1
dF9zaXplIC0gMV0uYmx1ZSA9IFJFR19GSUVMRF9HRVQoUFJFQ19QQUxfR0NfTUFYX1JHQl9NQVNL
LAorCQkJCQkJICAgICBJOTE1X1JFQUQoUFJFQ19QQUxfR0NfTUFYKHBpcGUsIDEpKSk7CisKKwli
bG9iX2RhdGEgPSBpY2xfY29tcHV0ZV9pbnRlcnBvbGF0ZWRfZ2FtbWFfbHV0X3ZhbHVlcyhibG9i
X2RhdGEsIGx1dF9zaXplKTsKKworCXJldHVybiBibG9iOworfQorCitzdGF0aWMgdm9pZCBpY2xf
cmVhZF9sdXRzKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQoreworCWlmICgo
Y3J0Y19zdGF0ZS0+Z2FtbWFfbW9kZSAmIEdBTU1BX01PREVfTU9ERV9NQVNLKSA9PQorCSAgICBH
QU1NQV9NT0RFX01PREVfOEJJVCkKKwkJY3J0Y19zdGF0ZS0+YmFzZS5nYW1tYV9sdXQgPSBpOXh4
X3JlYWRfbHV0XzgoY3J0Y19zdGF0ZSk7CisJZWxzZSBpZiAoKGNydGNfc3RhdGUtPmdhbW1hX21v
ZGUgJiBHQU1NQV9NT0RFX01PREVfTUFTSykgPT0KKwkJIEdBTU1BX01PREVfTU9ERV8xMkJJVF9N
VUxUSV9TRUdNRU5URUQpCisJCWNydGNfc3RhdGUtPmJhc2UuZ2FtbWFfbHV0ID0gaWNsX3JlYWRf
bHV0X211bHRpX3NlZ21lbnQoY3J0Y19zdGF0ZSk7CisJZWxzZQorCQljcnRjX3N0YXRlLT5iYXNl
LmdhbW1hX2x1dCA9IGdsa19yZWFkX2x1dF8xMChjcnRjX3N0YXRlLCBQQUxfUFJFQ19JTkRFWF9W
QUxVRSgwKSk7Cit9CisKIHZvaWQgaW50ZWxfY29sb3JfaW5pdChzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YykKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNy
dGMtPmJhc2UuZGV2KTsKQEAgLTE3ODgsNiArMTk3Myw3IEBAIHZvaWQgaW50ZWxfY29sb3JfaW5p
dChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKIAogCQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+
PSAxMSkgewogCQkJZGV2X3ByaXYtPmRpc3BsYXkubG9hZF9sdXRzID0gaWNsX2xvYWRfbHV0czsK
KwkJCWRldl9wcml2LT5kaXNwbGF5LnJlYWRfbHV0cyA9IGljbF9yZWFkX2x1dHM7CiAJCX0gZWxz
ZSBpZiAoSVNfQ0FOTk9OTEFLRShkZXZfcHJpdikgfHwgSVNfR0VNSU5JTEFLRShkZXZfcHJpdikp
IHsKIAkJCWRldl9wcml2LT5kaXNwbGF5LmxvYWRfbHV0cyA9IGdsa19sb2FkX2x1dHM7CiAJCQlk
ZXZfcHJpdi0+ZGlzcGxheS5yZWFkX2x1dHMgPSBnbGtfcmVhZF9sdXRzOwpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZWcuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfcmVnLmgKaW5kZXggYmYzN2VjZS4uODQ0ZGQ2MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9yZWcuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlZy5o
CkBAIC0xMDM3OCw2ICsxMDM3OCw3IEBAIGVudW0gc2tsX3Bvd2VyX2dhdGUgewogCiAjZGVmaW5l
IFBSRUNfUEFMX0lOREVYKHBpcGUpCQlfTU1JT19QSVBFKHBpcGUsIF9QQUxfUFJFQ19JTkRFWF9B
LCBfUEFMX1BSRUNfSU5ERVhfQikKICNkZWZpbmUgUFJFQ19QQUxfREFUQShwaXBlKQkJX01NSU9f
UElQRShwaXBlLCBfUEFMX1BSRUNfREFUQV9BLCBfUEFMX1BSRUNfREFUQV9CKQorI2RlZmluZSBQ
UkVDX1BBTF9HQ19NQVhfUkdCX01BU0sJIFJFR19HRU5NQVNLKDE1LCAwKQogI2RlZmluZSBQUkVD
X1BBTF9HQ19NQVgocGlwZSwgaSkJX01NSU8oX1BJUEUocGlwZSwgX1BBTF9QUkVDX0dDX01BWF9B
LCBfUEFMX1BSRUNfR0NfTUFYX0IpICsgKGkpICogNCkKICNkZWZpbmUgUFJFQ19QQUxfRVhUX0dD
X01BWChwaXBlLCBpKQlfTU1JTyhfUElQRShwaXBlLCBfUEFMX1BSRUNfRVhUX0dDX01BWF9BLCBf
UEFMX1BSRUNfRVhUX0dDX01BWF9CKSArIChpKSAqIDQpCiAjZGVmaW5lIFBSRUNfUEFMX0VYVDJf
R0NfTUFYKHBpcGUsIGkpCV9NTUlPKF9QSVBFKHBpcGUsIF9QQUxfUFJFQ19FWFQyX0dDX01BWF9B
LCBfUEFMX1BSRUNfRVhUMl9HQ19NQVhfQikgKyAoaSkgKiA0KQpAQCAtMTA0MDEsNiArMTA0MDIs
MTIgQEAgZW51bSBza2xfcG93ZXJfZ2F0ZSB7CiAKICNkZWZpbmUgX1BBTF9QUkVDX01VTFRJX1NF
R19EQVRBX0EJMHg0QTQwQwogI2RlZmluZSBfUEFMX1BSRUNfTVVMVElfU0VHX0RBVEFfQgkweDRB
QzBDCisjZGVmaW5lICBQQUxfUFJFQ19NVUxUSV9TRUdfUkVEX0xEV19NQVNLICAgUkVHX0dFTk1B
U0soMjksIDI0KQorI2RlZmluZSAgUEFMX1BSRUNfTVVMVElfU0VHX1JFRF9VRFdfTUFTSyAgIFJF
R19HRU5NQVNLKDI5LCAyMCkKKyNkZWZpbmUgIFBBTF9QUkVDX01VTFRJX1NFR19HUkVFTl9MRFdf
TUFTSyBSRUdfR0VOTUFTSygxOSwgMTQpCisjZGVmaW5lICBQQUxfUFJFQ19NVUxUSV9TRUdfR1JF
RU5fVURXX01BU0sgUkVHX0dFTk1BU0soMTksIDEwKQorI2RlZmluZSAgUEFMX1BSRUNfTVVMVElf
U0VHX0JMVUVfTERXX01BU0sgIFJFR19HRU5NQVNLKDksIDQpCisjZGVmaW5lICBQQUxfUFJFQ19N
VUxUSV9TRUdfQkxVRV9VRFdfTUFTSyAgUkVHX0dFTk1BU0soOSwgMCkKIAogI2RlZmluZSBQUkVD
X1BBTF9NVUxUSV9TRUdfSU5ERVgocGlwZSkJX01NSU9fUElQRShwaXBlLCBcCiAJCQkJCV9QQUxf
UFJFQ19NVUxUSV9TRUdfSU5ERVhfQSwgXAotLSAKMS45LjEKCl9fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwt
Z2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9t
YWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

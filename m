Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id E6F9AA1353
	for <lists+intel-gfx@lfdr.de>; Thu, 29 Aug 2019 10:12:24 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E8ADF6E039;
	Thu, 29 Aug 2019 08:12:18 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 492686E03B
 for <intel-gfx@lists.freedesktop.org>; Thu, 29 Aug 2019 08:12:06 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18299888-1500050 
 for multiple; Thu, 29 Aug 2019 09:11:58 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 29 Aug 2019 09:11:43 +0100
Message-Id: <20190829081150.10271-30-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190829081150.10271-1-chris@chris-wilson.co.uk>
References: <20190829081150.10271-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 29/36] drm/i915: Replace hangcheck by heartbeats
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UmVwbGFjZSBzYW1wbGluZyB0aGUgZW5naW5lIHN0YXRlIGV2ZXJ5IHNvIG9mdGVuIHdpdGggYSBw
ZXJpb2RpYwpoZWFydGJlYXQgcmVxdWVzdCB0byBtZWFzdXJlIHRoZSBoZWFsdGggb2YgYW4gZW5n
aW5lLiBUaGlzIGlzIGNvdXBsZWQKd2l0aCB0aGUgZm9yY2VkLXByZWVtcHRpb24gdG8gYWxsb3cg
bG9uZyBydW5uaW5nIHJlcXVlc3RzIHRvIHN1cnZpdmUgc28KbG9uZyBhcyB0aGV5IGRvIG5vdCBi
bG9jayBvdGhlciB1c2Vycy4KClNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hy
aXMtd2lsc29uLmNvLnVrPgpDYzogSm9vbmFzIExhaHRpbmVuIDxqb29uYXMubGFodGluZW5AbGlu
dXguaW50ZWwuY29tPgpDYzogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNv
bT4KQ2M6IEpvbiBCbG9vbWZpZWxkIDxqb24uYmxvb21maWVsZEBpbnRlbC5jb20+Ci0tLQogZHJp
dmVycy9ncHUvZHJtL2k5MTUvS2NvbmZpZy5wcm9maWxlICAgICAgICAgIHwgIDExICsKIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlICAgICAgICAgICAgICAgICB8ICAgMSAtCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyAgfCAgIDIgKy0KIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaCAgICB8ICAgMSAtCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYyAgICAgICAgfCAgIDIgLQogZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lLmggICAgICAgIHwgIDMyIC0tCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYyAgICAgfCAgMTAgKy0KIC4uLi9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZW5naW5lX2hlYXJ0YmVhdC5jICB8IDEwOSArKysrKysKIC4uLi9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfZW5naW5lX2hlYXJ0YmVhdC5oICB8ICAgNSArCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uYyAgICAgfCAgIDUgKy0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oICB8ICAxNiArLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfZ3QuYyAgICAgICAgICAgIHwgICAxIC0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2d0LmggICAgICAgICAgICB8ICAgNCAtCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9ndF9wbS5jICAgICAgICAgfCAgIDEgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZ3RfdHlwZXMuaCAgICAgIHwgICA5IC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2hhbmdjaGVjay5jICAgICB8IDM2MSAtLS0tLS0tLS0tLS0tLS0tLS0KIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMgICAgICAgICB8ICAgMyArLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfaGFuZ2NoZWNrLmMgIHwgICA0IC0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jICAgICAgICAgICB8ICA4NyAtLS0tLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9kcnYuYyAgICAgICAgICAgICAgIHwgICAzIC0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZHJ2LmggICAgICAgICAgICAgICB8ICAgMSAtCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jICAgICAgICAgfCAgMzMgKy0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmggICAgICAgICB8ICAgMiAtCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3ByaW9saXN0X3R5cGVzLmggICAgfCAgIDYgKwogMjQgZmlsZXMgY2hhbmdlZCwg
MTU0IGluc2VydGlvbnMoKyksIDU1NSBkZWxldGlvbnMoLSkKIGRlbGV0ZSBtb2RlIDEwMDY0NCBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5nY2hlY2suYwoKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L0tjb25maWcucHJvZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L0tjb25maWcucHJvZmlsZQppbmRleCAzMTg0ZTg0OTEzMzMuLmFhZmI1N2Y4NDE2OSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvS2NvbmZpZy5wcm9maWxlCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L0tjb25maWcucHJvZmlsZQpAQCAtMzcsMyArMzcsMTQgQEAgY29uZmlnIERS
TV9JOTE1X1BSRUVNUFRfVElNRU9VVAogCSAgdG8gZXhlY3V0ZS4KIAogCSAgTWF5IGJlIDAgdG8g
ZGlzYWJsZSB0aGUgdGltZW91dC4KKworY29uZmlnIERSTV9JOTE1X0hFQVJUQkVBVF9JTlRFUlZB
TAorCWludCAiSW50ZXJ2YWwgYmV0d2VlbiBoZWFydGJlYXQgcHVsc2VzIChtcykiCisJZGVmYXVs
dCAyNTAwICMgbWljcm9zZWNvbmRzCisJaGVscAorCSAgV2hpbGUgYWN0aXZlIHRoZSBkcml2ZXIg
dXNlcyBhIHBlcmlvZGljIHJlcXVlc3QsIGEgaGVhcnRiZWF0LCB0bworCSAgY2hlY2sgdGhlIHdl
bGxuZXNzIG9mIHRoZSBHUFUgYW5kIHRvIHJlZ3VsYXJseSBmbHVzaCBzdGF0ZSBjaGFuZ2VzCisJ
ICAoaWRsZSBiYXJyaWVycykuCisKKwkgIE1heSBiZSAwIHRvIGRpc2FibGUgaGVhcnRiZWF0cyBh
bmQgdGhlcmVmb3JlIGRpc2FibGUgYXV0b21hdGljIEdQVQorCSAgaGFuZyBkZXRlY3Rpb24uCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L01ha2VmaWxlCmluZGV4IDc1OWMwNmQwODdiNC4uMDRjOGIyOWFjYTgwIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9NYWtlZmlsZQpAQCAtODUsNyArODUsNiBAQCBndC15ICs9IFwKIAlndC9pbnRlbF9ndF9w
bS5vIFwKIAlndC9pbnRlbF9ndF9wbV9pcnEubyBcCiAJZ3QvaW50ZWxfZ3RfcmVxdWVzdHMubyBc
Ci0JZ3QvaW50ZWxfaGFuZ2NoZWNrLm8gXAogCWd0L2ludGVsX2xyYy5vIFwKIAlndC9pbnRlbF9y
ZW5kZXJzdGF0ZS5vIFwKIAlndC9pbnRlbF9yZXNldC5vIFwKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKaW5kZXggMmJiNTFmNDViZmQzLi4yMjY3YmQ5M2Yx
NGIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxh
eS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCkBA
IC0xNDMxNCw3ICsxNDMxNCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3BsYW5lX3VucGluX2ZiKHN0
cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqb2xkX3BsYW5lX3N0YXRlKQogc3RhdGljIHZvaWQgZmJf
b2JqX2J1bXBfcmVuZGVyX3ByaW9yaXR5KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmop
CiB7CiAJc3RydWN0IGk5MTVfc2NoZWRfYXR0ciBhdHRyID0gewotCQkucHJpb3JpdHkgPSBJOTE1
X1BSSU9SSVRZX0RJU1BMQVksCisJCS5wcmlvcml0eSA9IEk5MTVfVVNFUl9QUklPUklUWShJOTE1
X1BSSU9SSVRZX0RJU1BMQVkpLAogCX07CiAKIAlpOTE1X2dlbV9vYmplY3Rfd2FpdF9wcmlvcml0
eShvYmosIDAsICZhdHRyKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9vYmplY3QuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmpl
Y3QuaAppbmRleCBhNzhhZjI1ZGNlMzYuLjk2N2MzMDczN2RjNSAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaApAQCAtNDI5LDYgKzQyOSw1IEBAIGludCBpOTE1
X2dlbV9vYmplY3Rfd2FpdChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogaW50IGk5
MTVfZ2VtX29iamVjdF93YWl0X3ByaW9yaXR5KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpv
YmosCiAJCQkJICB1bnNpZ25lZCBpbnQgZmxhZ3MsCiAJCQkJICBjb25zdCBzdHJ1Y3QgaTkxNV9z
Y2hlZF9hdHRyICphdHRyKTsKLSNkZWZpbmUgSTkxNV9QUklPUklUWV9ESVNQTEFZIEk5MTVfVVNF
Ul9QUklPUklUWShJOTE1X1BSSU9SSVRZX01BWCkKIAogI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9wbS5jCmluZGV4IDU4MTZiZGI1YmZhMi4uMjdhMzA1MzQyM2RhIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYwpAQCAtNzksOCArNzksNiBAQCB2b2lk
IGk5MTVfZ2VtX3N1c3BlbmQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJICovCiAJ
c3dpdGNoX3RvX2tlcm5lbF9jb250ZXh0X3N5bmMoJmk5MTUtPmd0KTsKIAotCWNhbmNlbF9kZWxh
eWVkX3dvcmtfc3luYygmaTkxNS0+Z3QuaGFuZ2NoZWNrLndvcmspOwotCiAJaTkxNV9nZW1fZHJh
aW5fZnJlZWRfb2JqZWN0cyhpOTE1KTsKIAogCWludGVsX3VjX3N1c3BlbmQoJmk5MTUtPmd0LnVj
KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lLmgKaW5kZXggZDNjNjk5M2Y0ZjQ2
Li5kYTA5ZWVhMGZiODYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2VuZ2luZS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oCkBA
IC04OSwzOCArODksNiBAQCBzdHJ1Y3QgZHJtX3ByaW50ZXI7CiAvKiBzZXFubyBzaXplIGlzIGFj
dHVhbGx5IG9ubHkgYSB1aW50MzIsIGJ1dCBzaW5jZSB3ZSBwbGFuIHRvIHVzZSBNSV9GTFVTSF9E
VyB0bwogICogZG8gdGhlIHdyaXRlcywgYW5kIHRoYXQgbXVzdCBoYXZlIHF3IGFsaWduZWQgb2Zm
c2V0cywgc2ltcGx5IHByZXRlbmQgaXQncyA4Yi4KICAqLwotZW51bSBpbnRlbF9lbmdpbmVfaGFu
Z2NoZWNrX2FjdGlvbiB7Ci0JRU5HSU5FX0lETEUgPSAwLAotCUVOR0lORV9XQUlULAotCUVOR0lO
RV9BQ1RJVkVfU0VRTk8sCi0JRU5HSU5FX0FDVElWRV9IRUFELAotCUVOR0lORV9BQ1RJVkVfU1VC
VU5JVFMsCi0JRU5HSU5FX1dBSVRfS0lDSywKLQlFTkdJTkVfREVBRCwKLX07Ci0KLXN0YXRpYyBp
bmxpbmUgY29uc3QgY2hhciAqCi1oYW5nY2hlY2tfYWN0aW9uX3RvX3N0cihjb25zdCBlbnVtIGlu
dGVsX2VuZ2luZV9oYW5nY2hlY2tfYWN0aW9uIGEpCi17Ci0Jc3dpdGNoIChhKSB7Ci0JY2FzZSBF
TkdJTkVfSURMRToKLQkJcmV0dXJuICJpZGxlIjsKLQljYXNlIEVOR0lORV9XQUlUOgotCQlyZXR1
cm4gIndhaXQiOwotCWNhc2UgRU5HSU5FX0FDVElWRV9TRVFOTzoKLQkJcmV0dXJuICJhY3RpdmUg
c2Vxbm8iOwotCWNhc2UgRU5HSU5FX0FDVElWRV9IRUFEOgotCQlyZXR1cm4gImFjdGl2ZSBoZWFk
IjsKLQljYXNlIEVOR0lORV9BQ1RJVkVfU1VCVU5JVFM6Ci0JCXJldHVybiAiYWN0aXZlIHN1YnVu
aXRzIjsKLQljYXNlIEVOR0lORV9XQUlUX0tJQ0s6Ci0JCXJldHVybiAid2FpdCBraWNrIjsKLQlj
YXNlIEVOR0lORV9ERUFEOgotCQlyZXR1cm4gImRlYWQiOwotCX0KLQotCXJldHVybiAidW5rbm93
biI7Ci19CiAKIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgaW50CiBleGVjbGlzdHNfbnVtX3BvcnRz
KGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3RzICogY29uc3QgZXhlY2xpc3RzKQpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYwppbmRleCBhODAxNGM1OWIz
ODguLmYxMzZiOTFlYzc3MCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZW5naW5lX2NzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5l
X2NzLmMKQEAgLTU5Nyw3ICs1OTcsNiBAQCBzdGF0aWMgaW50IGludGVsX2VuZ2luZV9zZXR1cF9j
b21tb24oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCWludGVsX2VuZ2luZV9pbml0
X2FjdGl2ZShlbmdpbmUsIEVOR0lORV9QSFlTSUNBTCk7CiAJaW50ZWxfZW5naW5lX2luaXRfYnJl
YWRjcnVtYnMoZW5naW5lKTsKIAlpbnRlbF9lbmdpbmVfaW5pdF9leGVjbGlzdHMoZW5naW5lKTsK
LQlpbnRlbF9lbmdpbmVfaW5pdF9oYW5nY2hlY2soZW5naW5lKTsKIAlpbnRlbF9lbmdpbmVfaW5p
dF9jbWRfcGFyc2VyKGVuZ2luZSk7CiAJaW50ZWxfZW5naW5lX2luaXRfX3BtKGVuZ2luZSk7CiAK
QEAgLTEzNzcsOCArMTM3NiwxMyBAQCB2b2lkIGludGVsX2VuZ2luZV9kdW1wKHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSwKIAkJZHJtX3ByaW50ZihtLCAiKioqIFdFREdFRCAqKipcbiIp
OwogCiAJZHJtX3ByaW50ZihtLCAiXHRBd2FrZT8gJWRcbiIsIGF0b21pY19yZWFkKCZlbmdpbmUt
Pndha2VyZWYuY291bnQpKTsKLQlkcm1fcHJpbnRmKG0sICJcdEhhbmdjaGVjazogJWQgbXMgYWdv
XG4iLAotCQkgICBqaWZmaWVzX3RvX21zZWNzKGppZmZpZXMgLSBlbmdpbmUtPmhhbmdjaGVjay5h
Y3Rpb25fdGltZXN0YW1wKSk7CisKKwlyY3VfcmVhZF9sb2NrKCk7CisJcnEgPSBSRUFEX09OQ0Uo
ZW5naW5lLT5oZWFydGJlYXQuc3lzdG9sZSk7CisJaWYgKHJxKQorCQlkcm1fcHJpbnRmKG0sICJc
dEhlYXJ0YmVhdDogJWQgbXMgYWdvXG4iLAorCQkJICAgamlmZmllc190b19tc2VjcyhqaWZmaWVz
IC0gcnEtPmVtaXR0ZWRfamlmZmllcykpOworCXJjdV9yZWFkX3VubG9jaygpOwogCWRybV9wcmlu
dGYobSwgIlx0UmVzZXQgY291bnQ6ICVkIChnbG9iYWwgJWQpXG4iLAogCQkgICBpOTE1X3Jlc2V0
X2VuZ2luZV9jb3VudChlcnJvciwgZW5naW5lKSwKIAkJICAgaTkxNV9yZXNldF9jb3VudChlcnJv
cikpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2hl
YXJ0YmVhdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2hlYXJ0YmVh
dC5jCmluZGV4IDJmYzQxM2Y5ZDUwNi4uNWQ2NzM4Mjg2MGQxIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfaGVhcnRiZWF0LmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2hlYXJ0YmVhdC5jCkBAIC0xMSw2ICsxMSwyMSBA
QAogI2luY2x1ZGUgImludGVsX2VuZ2luZV9wbS5oIgogI2luY2x1ZGUgImludGVsX2VuZ2luZS5o
IgogI2luY2x1ZGUgImludGVsX2d0LmgiCisjaW5jbHVkZSAiaW50ZWxfcmVzZXQuaCIKKworLyoK
KyAqIFdoaWxlIHRoZSBlbmdpbmUgaXMgYWN0aXZlLCB3ZSBzZW5kIGEgcGVyaW9kaWMgcHVsc2Ug
YWxvbmcgdGhlIGVuZ2luZQorICogdG8gY2hlY2sgb24gaXRzIGhlYWx0aCBhbmQgdG8gZmx1c2gg
YW55IGlkbGUtYmFycmllcnMuIElmIHRoYXQgcmVxdWVzdAorICogaXMgc3R1Y2ssIGFuZCB3ZSBm
YWlsIHRvIHByZWVtcHQgaXQsIHdlIGRlY2xhcmUgdGhlIGVuZ2luZSBodW5nIGFuZAorICogaXNz
dWUgYSByZXNldCAtLSBpbiB0aGUgaG9wZSB0aGF0IHJlc3RvcmVzIHByb2dyZXNzLgorICovCisK
K3N0YXRpYyBsb25nIGhlYXJ0YmVhdF9leHBpcnkodm9pZCkKK3sKKwljb25zdCBsb25nIHQgPSBt
c2Vjc190b19qaWZmaWVzKENPTkZJR19EUk1fSTkxNV9IRUFSVEJFQVRfSU5URVJWQUwpOworCisJ
cmV0dXJuIHJvdW5kX2ppZmZpZXNfdXBfcmVsYXRpdmUodCk7Cit9CiAKIHN0YXRpYyB2b2lkIGlk
bGVfcHVsc2Uoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpycSkKIHsKQEAgLTE4LDYgKzMzLDEwMCBAQCBzdGF0aWMgdm9pZCBpZGxlX3B1bHNlKHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJ
aTkxNV9yZXF1ZXN0X2FkZF9hY3RpdmVfYmFycmllcnMocnEpOwogfQogCitzdGF0aWMgdm9pZCBo
ZWFydGJlYXQoc3RydWN0IHdvcmtfc3RydWN0ICp3cmspCit7CisJc3RydWN0IGk5MTVfc2NoZWRf
YXR0ciBhdHRyID0geworCQkucHJpb3JpdHkgPSBJOTE1X1VTRVJfUFJJT1JJVFkoSTkxNV9QUklP
UklUWV9NSU4pLAorCX07CisJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lID0KKwkJY29u
dGFpbmVyX29mKHdyaywgdHlwZW9mKCplbmdpbmUpLCBoZWFydGJlYXQud29yay53b3JrKTsKKwlz
dHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UgPSBlbmdpbmUtPmtlcm5lbF9jb250ZXh0OworCXN0cnVj
dCBpOTE1X3JlcXVlc3QgKnJxOworCisJaWYgKCFpbnRlbF9lbmdpbmVfcG1fZ2V0X2lmX2F3YWtl
KGVuZ2luZSkpCisJCXJldHVybjsKKworCXJxID0gZW5naW5lLT5oZWFydGJlYXQuc3lzdG9sZTsK
KwlpZiAocnEgJiYgaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChycSkpIHsKKwkJaTkxNV9yZXF1ZXN0
X3B1dChycSk7CisJCWVuZ2luZS0+aGVhcnRiZWF0LnN5c3RvbGUgPSBOVUxMOworCX0KKworCWlm
IChpbnRlbF9ndF9pc193ZWRnZWQoZW5naW5lLT5ndCkpCisJCWdvdG8gb3V0OworCisJaWYgKGVu
Z2luZS0+aGVhcnRiZWF0LnN5c3RvbGUpIHsKKwkJaWYgKElTX0VOQUJMRUQoQ09ORklHX0RSTV9J
OTE1X0RFQlVHX0dFTSkpIHsKKwkJCXN0cnVjdCBkcm1fcHJpbnRlciBwID0gZHJtX2RlYnVnX3By
aW50ZXIoX19mdW5jX18pOworCisJCQlpbnRlbF9lbmdpbmVfZHVtcChlbmdpbmUsICZwLAorCQkJ
CQkgICIlcyBoZWFydGJlYXQgbm90IHRpY2tpbmdcbiIsCisJCQkJCSAgZW5naW5lLT5uYW1lKTsK
KwkJfQorCisJCWlmIChlbmdpbmUtPnNjaGVkdWxlICYmCisJCSAgICBycS0+c2NoZWQuYXR0ci5w
cmlvcml0eSA8IEk5MTVfUFJJT1JJVFlfQkFSUklFUikgeworCQkJYXR0ci5wcmlvcml0eSA9CisJ
CQkJSTkxNV9VU0VSX1BSSU9SSVRZKEk5MTVfUFJJT1JJVFlfSEVBUlRCRUFUKTsKKwkJCWlmIChy
cS0+c2NoZWQuYXR0ci5wcmlvcml0eSA+PSBhdHRyLnByaW9yaXR5KQorCQkJCWF0dHIucHJpb3Jp
dHkgPSBJOTE1X1BSSU9SSVRZX0JBUlJJRVI7CisKKwkJCWxvY2FsX2JoX2Rpc2FibGUoKTsKKwkJ
CWVuZ2luZS0+c2NoZWR1bGUocnEsICZhdHRyKTsKKwkJCWxvY2FsX2JoX2VuYWJsZSgpOworCQl9
IGVsc2UgeworCQkJaW50ZWxfZ3RfaGFuZGxlX2Vycm9yKGVuZ2luZS0+Z3QsIGVuZ2luZS0+bWFz
aywKKwkJCQkJICAgICAgSTkxNV9FUlJPUl9DQVBUVVJFLAorCQkJCQkgICAgICAic3RvcHBlZCBo
ZWFydGJlYXQgb24gJXMiLAorCQkJCQkgICAgICBlbmdpbmUtPm5hbWUpOworCQl9CisJCWdvdG8g
b3V0OworCX0KKworCWlmIChlbmdpbmUtPndha2VyZWZfc2VyaWFsID09IGVuZ2luZS0+c2VyaWFs
KQorCQlnb3RvIG91dDsKKworCW11dGV4X2xvY2soJmNlLT50aW1lbGluZS0+bXV0ZXgpOworCisJ
aW50ZWxfY29udGV4dF9lbnRlcihjZSk7CisJcnEgPSBfX2k5MTVfcmVxdWVzdF9jcmVhdGUoY2Us
IEdGUF9OT1dBSVQgfCBfX0dGUF9OT1dBUk4pOworCWludGVsX2NvbnRleHRfZXhpdChjZSk7CisJ
aWYgKElTX0VSUihycSkpCisJCWdvdG8gdW5sb2NrOworCisJaWRsZV9wdWxzZShlbmdpbmUsIHJx
KTsKKwlpZiAoaTkxNV9tb2RwYXJhbXMuZW5hYmxlX2hhbmdjaGVjaykKKwkJZW5naW5lLT5oZWFy
dGJlYXQuc3lzdG9sZSA9IGk5MTVfcmVxdWVzdF9nZXQocnEpOworCisJX19pOTE1X3JlcXVlc3Rf
Y29tbWl0KHJxKTsKKwlfX2k5MTVfcmVxdWVzdF9xdWV1ZShycSwgJmF0dHIpOworCit1bmxvY2s6
CisJbXV0ZXhfdW5sb2NrKCZjZS0+dGltZWxpbmUtPm11dGV4KTsKK291dDoKKwlzY2hlZHVsZV9k
ZWxheWVkX3dvcmsoJmVuZ2luZS0+aGVhcnRiZWF0LndvcmssIGhlYXJ0YmVhdF9leHBpcnkoKSk7
CisJaW50ZWxfZW5naW5lX3BtX3B1dChlbmdpbmUpOworfQorCit2b2lkIGludGVsX2VuZ2luZV91
bnBhcmtfaGVhcnRiZWF0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlpZiAo
IUNPTkZJR19EUk1fSTkxNV9IRUFSVEJFQVRfSU5URVJWQUwpCisJCXJldHVybjsKKworCXNjaGVk
dWxlX2RlbGF5ZWRfd29yaygmZW5naW5lLT5oZWFydGJlYXQud29yaywgaGVhcnRiZWF0X2V4cGly
eSgpKTsKK30KKwordm9pZCBpbnRlbF9lbmdpbmVfcGFya19oZWFydGJlYXQoc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lKQoreworCWNhbmNlbF9kZWxheWVkX3dvcmsoJmVuZ2luZS0+aGVh
cnRiZWF0LndvcmspOworCWk5MTVfcmVxdWVzdF9wdXQoZmV0Y2hfYW5kX3plcm8oJmVuZ2luZS0+
aGVhcnRiZWF0LnN5c3RvbGUpKTsKK30KKwordm9pZCBpbnRlbF9lbmdpbmVfaW5pdF9oZWFydGJl
YXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCUlOSVRfREVMQVlFRF9XT1JL
KCZlbmdpbmUtPmhlYXJ0YmVhdC53b3JrLCBoZWFydGJlYXQpOworfQorCiBpbnQgaW50ZWxfZW5n
aW5lX3B1bHNlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsKIAlzdHJ1Y3QgaTkx
NV9zY2hlZF9hdHRyIGF0dHIgPSB7IC5wcmlvcml0eSA9IEk5MTVfUFJJT1JJVFlfQkFSUklFUiB9
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2hlYXJ0
YmVhdC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2hlYXJ0YmVhdC5o
CmluZGV4IGI5NTA0NTFiNTk5OC4uMzkzOTEwMDQ1NTRkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfaGVhcnRiZWF0LmgKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2hlYXJ0YmVhdC5oCkBAIC05LDYgKzksMTEgQEAKIAog
c3RydWN0IGludGVsX2VuZ2luZV9jczsKIAordm9pZCBpbnRlbF9lbmdpbmVfaW5pdF9oZWFydGJl
YXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKKwordm9pZCBpbnRlbF9lbmdpbmVf
cGFya19oZWFydGJlYXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKK3ZvaWQgaW50
ZWxfZW5naW5lX3VucGFya19oZWFydGJlYXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KTsKKwogaW50IGludGVsX2VuZ2luZV9wdWxzZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpOwogCiAjZW5kaWYgLyogSU5URUxfRU5HSU5FX0hFQVJUQkVBVF9IICovCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5jCmluZGV4IDEyYTI2MDhhODg4OS4uNWU3NGMz
Yjg2YTIxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVf
cG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uYwpAQCAt
Nyw2ICs3LDcgQEAKICNpbmNsdWRlICJpOTE1X2Rydi5oIgogCiAjaW5jbHVkZSAiaW50ZWxfZW5n
aW5lLmgiCisjaW5jbHVkZSAiaW50ZWxfZW5naW5lX2hlYXJ0YmVhdC5oIgogI2luY2x1ZGUgImlu
dGVsX2VuZ2luZV9wbS5oIgogI2luY2x1ZGUgImludGVsX2VuZ2luZV9wb29sLmgiCiAjaW5jbHVk
ZSAiaW50ZWxfZ3QuaCIKQEAgLTMzLDcgKzM0LDcgQEAgc3RhdGljIGludCBfX2VuZ2luZV91bnBh
cmsoc3RydWN0IGludGVsX3dha2VyZWYgKndmKQogCWlmIChlbmdpbmUtPnVucGFyaykKIAkJZW5n
aW5lLT51bnBhcmsoZW5naW5lKTsKIAotCWludGVsX2VuZ2luZV9pbml0X2hhbmdjaGVjayhlbmdp
bmUpOworCWludGVsX2VuZ2luZV91bnBhcmtfaGVhcnRiZWF0KGVuZ2luZSk7CiAJcmV0dXJuIDA7
CiB9CiAKQEAgLTE1Nyw2ICsxNTgsNyBAQCBzdGF0aWMgaW50IF9fZW5naW5lX3Bhcmsoc3RydWN0
IGludGVsX3dha2VyZWYgKndmKQogCiAJY2FsbF9pZGxlX2JhcnJpZXJzKGVuZ2luZSk7IC8qIGNs
ZWFudXAgYWZ0ZXIgd2VkZ2luZyAqLwogCisJaW50ZWxfZW5naW5lX3BhcmtfaGVhcnRiZWF0KGVu
Z2luZSk7CiAJaW50ZWxfZW5naW5lX2Rpc2FybV9icmVhZGNydW1icyhlbmdpbmUpOwogCWludGVs
X2VuZ2luZV9wb29sX3BhcmsoJmVuZ2luZS0+cG9vbCk7CiAKQEAgLTE4Nyw2ICsxODksNyBAQCB2
b2lkIGludGVsX2VuZ2luZV9pbml0X19wbShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUp
CiAJc3RydWN0IGludGVsX3J1bnRpbWVfcG0gKnJwbSA9ICZlbmdpbmUtPmk5MTUtPnJ1bnRpbWVf
cG07CiAKIAlpbnRlbF93YWtlcmVmX2luaXQoJmVuZ2luZS0+d2FrZXJlZiwgcnBtLCAmd2Zfb3Bz
KTsKKwlpbnRlbF9lbmdpbmVfaW5pdF9oZWFydGJlYXQoZW5naW5lKTsKIH0KIAogI2lmIElTX0VO
QUJMRUQoQ09ORklHX0RSTV9JOTE1X1NFTEZURVNUKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9lbmdpbmVfdHlwZXMuaAppbmRleCAxNWUwMmNiNThhNjcuLjA4MjViNjkzOWI5YSAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmgK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmgKQEAgLTE1
LDYgKzE1LDcgQEAKICNpbmNsdWRlIDxsaW51eC9yYnRyZWUuaD4KICNpbmNsdWRlIDxsaW51eC90
aW1lci5oPgogI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CisjaW5jbHVkZSA8bGludXgvd29ya3F1
ZXVlLmg+CiAKICNpbmNsdWRlICJpOTE1X2dlbS5oIgogI2luY2x1ZGUgImk5MTVfcG11LmgiCkBA
IC03NiwxNCArNzcsNiBAQCBzdHJ1Y3QgaW50ZWxfaW5zdGRvbmUgewogCXUzMiByb3dbSTkxNV9N
QVhfU0xJQ0VTXVtJOTE1X01BWF9TVUJTTElDRVNdOwogfTsKIAotc3RydWN0IGludGVsX2VuZ2lu
ZV9oYW5nY2hlY2sgewotCXU2NCBhY3RoZDsKLQl1MzIgbGFzdF9yaW5nOwotCXUzMiBsYXN0X2hl
YWQ7Ci0JdW5zaWduZWQgbG9uZyBhY3Rpb25fdGltZXN0YW1wOwotCXN0cnVjdCBpbnRlbF9pbnN0
ZG9uZSBpbnN0ZG9uZTsKLX07Ci0KIHN0cnVjdCBpbnRlbF9yaW5nIHsKIAlzdHJ1Y3Qga3JlZiBy
ZWY7CiAJc3RydWN0IGk5MTVfdm1hICp2bWE7CkBAIC0zMjMsNiArMzE2LDExIEBAIHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgewogCiAJaW50ZWxfZW5naW5lX21hc2tfdCBzYXR1cmF0ZWQ7IC8qIHN1
Ym1pdHRpbmcgc2VtYXBob3JlcyB0b28gbGF0ZT8gKi8KIAorCXN0cnVjdCB7CisJCXN0cnVjdCBk
ZWxheWVkX3dvcmsgd29yazsKKwkJc3RydWN0IGk5MTVfcmVxdWVzdCAqc3lzdG9sZTsKKwl9IGhl
YXJ0YmVhdDsKKwogCXVuc2lnbmVkIGxvbmcgc2VyaWFsOwogCiAJdW5zaWduZWQgbG9uZyB3YWtl
cmVmX3NlcmlhbDsKQEAgLTQ3Myw4ICs0NzEsNiBAQCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzIHsK
IAkvKiBzdGF0dXNfbm90aWZpZXI6IGxpc3Qgb2YgY2FsbGJhY2tzIGZvciBjb250ZXh0LXN3aXRj
aCBjaGFuZ2VzICovCiAJc3RydWN0IGF0b21pY19ub3RpZmllcl9oZWFkIGNvbnRleHRfc3RhdHVz
X25vdGlmaWVyOwogCi0Jc3RydWN0IGludGVsX2VuZ2luZV9oYW5nY2hlY2sgaGFuZ2NoZWNrOwot
CiAjZGVmaW5lIEk5MTVfRU5HSU5FX05FRURTX0NNRF9QQVJTRVIgQklUKDApCiAjZGVmaW5lIEk5
MTVfRU5HSU5FX1NVUFBPUlRTX1NUQVRTICAgQklUKDEpCiAjZGVmaW5lIEk5MTVfRU5HSU5FX0hB
U19QUkVFTVBUSU9OICAgQklUKDIpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9ndC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuYwppbmRleCBm
Mzg2MjhiZmQzNGMuLjQzOTI5YjFhNjVjZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZ3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5j
CkBAIC0xOSw3ICsxOSw2IEBAIHZvaWQgaW50ZWxfZ3RfaW5pdF9lYXJseShzdHJ1Y3QgaW50ZWxf
Z3QgKmd0LCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAlJTklUX0xJU1RfSEVBRCgm
Z3QtPmNsb3NlZF92bWEpOwogCXNwaW5fbG9ja19pbml0KCZndC0+Y2xvc2VkX2xvY2spOwogCi0J
aW50ZWxfZ3RfaW5pdF9oYW5nY2hlY2soZ3QpOwogCWludGVsX2d0X2luaXRfcmVzZXQoZ3QpOwog
CWludGVsX2d0X2luaXRfcmVxdWVzdHMoZ3QpOwogCWludGVsX2d0X3BtX2luaXRfZWFybHkoZ3Qp
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuaCBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmgKaW5kZXggNDkyMGNiMzUxZjEwLi5hNDM5MDNi
MWNjNjMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmgKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuaApAQCAtMzksOCArMzksNiBAQCB2
b2lkIGludGVsX2d0X2NsZWFyX2Vycm9yX3JlZ2lzdGVycyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAog
dm9pZCBpbnRlbF9ndF9mbHVzaF9nZ3R0X3dyaXRlcyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIHZv
aWQgaW50ZWxfZ3RfY2hpcHNldF9mbHVzaChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIAotdm9pZCBp
bnRlbF9ndF9pbml0X2hhbmdjaGVjayhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKLQogaW50IGludGVs
X2d0X2luaXRfc2NyYXRjaChzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1bnNpZ25lZCBpbnQgc2l6ZSk7
CiB2b2lkIGludGVsX2d0X2Zpbmlfc2NyYXRjaChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIApAQCAt
NTUsNiArNTMsNCBAQCBzdGF0aWMgaW5saW5lIGJvb2wgaW50ZWxfZ3RfaXNfd2VkZ2VkKHN0cnVj
dCBpbnRlbF9ndCAqZ3QpCiAJcmV0dXJuIF9faW50ZWxfcmVzZXRfZmFpbGVkKCZndC0+cmVzZXQp
OwogfQogCi12b2lkIGludGVsX2d0X3F1ZXVlX2hhbmdjaGVjayhzdHJ1Y3QgaW50ZWxfZ3QgKmd0
KTsKLQogI2VuZGlmIC8qIF9fSU5URUxfR1RfSF9fICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZ3RfcG0uYwppbmRleCBkZDQwNTc0ZWNlMDUuLjdlMzJlNjE1ZmJlYiAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9ndF9wbS5jCkBAIC01MCw3ICs1MCw2IEBAIHN0YXRpYyBpbnQgX19n
dF91bnBhcmsoc3RydWN0IGludGVsX3dha2VyZWYgKndmKQogCiAJaTkxNV9wbXVfZ3RfdW5wYXJr
ZWQoaTkxNSk7CiAKLQlpbnRlbF9ndF9xdWV1ZV9oYW5nY2hlY2soZ3QpOwogCWludGVsX2d0X3Vu
cGFya19yZXF1ZXN0cyhndCk7CiAKIAlwbV9ub3RpZnkoaTkxNSwgSU5URUxfR1RfVU5QQVJLKTsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3R5cGVzLmggYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF90eXBlcy5oCmluZGV4IDJkMDQwNDU5YmQ2
Yy4uNWUyZjk3MjFhOTdhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9ndF90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3R5cGVz
LmgKQEAgLTI1LDE0ICsyNSw2IEBAIHN0cnVjdCBpOTE1X2dndHQ7CiBzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzOwogc3RydWN0IGludGVsX3VuY29yZTsKIAotc3RydWN0IGludGVsX2hhbmdjaGVjayB7
Ci0JLyogRm9yIGhhbmdjaGVjayB0aW1lciAqLwotI2RlZmluZSBEUk1fSTkxNV9IQU5HQ0hFQ0tf
UEVSSU9EIDE1MDAgLyogaW4gbXMgKi8KLSNkZWZpbmUgRFJNX0k5MTVfSEFOR0NIRUNLX0pJRkZJ
RVMgbXNlY3NfdG9famlmZmllcyhEUk1fSTkxNV9IQU5HQ0hFQ0tfUEVSSU9EKQotCi0Jc3RydWN0
IGRlbGF5ZWRfd29yayB3b3JrOwotfTsKLQogc3RydWN0IGludGVsX2d0IHsKIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNTsKIAlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmU7CkBAIC02
NSw3ICs1Nyw2IEBAIHN0cnVjdCBpbnRlbF9ndCB7CiAJc3RydWN0IGxpc3RfaGVhZCBjbG9zZWRf
dm1hOwogCXNwaW5sb2NrX3QgY2xvc2VkX2xvY2s7IC8qIGd1YXJkcyB0aGUgbGlzdCBvZiBjbG9z
ZWRfdm1hICovCiAKLQlzdHJ1Y3QgaW50ZWxfaGFuZ2NoZWNrIGhhbmdjaGVjazsKIAlzdHJ1Y3Qg
aW50ZWxfcmVzZXQgcmVzZXQ7CiAKIAkvKioKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2hhbmdjaGVjay5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
aGFuZ2NoZWNrLmMKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDQwZjYyZjc4MGJlNS4u
MDAwMDAwMDAwMDAwCi0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2hhbmdjaGVj
ay5jCisrKyAvZGV2L251bGwKQEAgLTEsMzYxICswLDAgQEAKLS8qCi0gKiBDb3B5cmlnaHQgwqkg
MjAxNiBJbnRlbCBDb3Jwb3JhdGlvbgotICoKLSAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50
ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCi0gKiBjb3B5IG9m
IHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlICJT
b2Z0d2FyZSIpLAotICogdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlv
biwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbgotICogdGhlIHJpZ2h0cyB0byB1c2UsIGNv
cHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsCi0gKiBh
bmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMg
dG8gd2hvbSB0aGUKLSAqIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0
byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6Ci0gKgotICogVGhlIGFib3ZlIGNvcHlyaWdodCBu
b3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2UgKGluY2x1ZGluZyB0aGUgbmV4dAotICog
cGFyYWdyYXBoKSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFs
IHBvcnRpb25zIG9mIHRoZQotICogU29mdHdhcmUuCi0gKgotICogVEhFIFNPRlRXQVJFIElTIFBS
T1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IK
LSAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMg
T0YgTUVSQ0hBTlRBQklMSVRZLAotICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0Ug
QU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMCi0gKiBUSEUgQVVUSE9SUyBP
UiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBP
VEhFUgotICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9S
VCBPUiBPVEhFUldJU0UsIEFSSVNJTkcKLSAqIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9O
IFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MKLSAqIElOIFRI
RSBTT0ZUV0FSRS4KLSAqCi0gKi8KLQotI2luY2x1ZGUgImk5MTVfZHJ2LmgiCi0jaW5jbHVkZSAi
aW50ZWxfZW5naW5lLmgiCi0jaW5jbHVkZSAiaW50ZWxfZ3QuaCIKLSNpbmNsdWRlICJpbnRlbF9y
ZXNldC5oIgotCi1zdHJ1Y3QgaGFuZ2NoZWNrIHsKLQl1NjQgYWN0aGQ7Ci0JdTMyIHJpbmc7Ci0J
dTMyIGhlYWQ7Ci0JZW51bSBpbnRlbF9lbmdpbmVfaGFuZ2NoZWNrX2FjdGlvbiBhY3Rpb247Ci0J
dW5zaWduZWQgbG9uZyBhY3Rpb25fdGltZXN0YW1wOwotCWludCBkZWFkbG9jazsKLQlzdHJ1Y3Qg
aW50ZWxfaW5zdGRvbmUgaW5zdGRvbmU7Ci0JYm9vbCB3ZWRnZWQ6MTsKLQlib29sIHN0YWxsZWQ6
MTsKLX07Ci0KLXN0YXRpYyBib29sIGluc3Rkb25lX3VuY2hhbmdlZCh1MzIgY3VycmVudF9pbnN0
ZG9uZSwgdTMyICpvbGRfaW5zdGRvbmUpCi17Ci0JdTMyIHRtcCA9IGN1cnJlbnRfaW5zdGRvbmUg
fCAqb2xkX2luc3Rkb25lOwotCWJvb2wgdW5jaGFuZ2VkOwotCi0JdW5jaGFuZ2VkID0gdG1wID09
ICpvbGRfaW5zdGRvbmU7Ci0JKm9sZF9pbnN0ZG9uZSB8PSB0bXA7Ci0KLQlyZXR1cm4gdW5jaGFu
Z2VkOwotfQotCi1zdGF0aWMgYm9vbCBzdWJ1bml0c19zdHVjayhzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUpCi17Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZW5n
aW5lLT5pOTE1OwotCWNvbnN0IHN0cnVjdCBzc2V1X2Rldl9pbmZvICpzc2V1ID0gJlJVTlRJTUVf
SU5GTyhkZXZfcHJpdiktPnNzZXU7Ci0Jc3RydWN0IGludGVsX2luc3Rkb25lIGluc3Rkb25lOwot
CXN0cnVjdCBpbnRlbF9pbnN0ZG9uZSAqYWNjdV9pbnN0ZG9uZSA9ICZlbmdpbmUtPmhhbmdjaGVj
ay5pbnN0ZG9uZTsKLQlib29sIHN0dWNrOwotCWludCBzbGljZTsKLQlpbnQgc3Vic2xpY2U7Ci0K
LQlpbnRlbF9lbmdpbmVfZ2V0X2luc3Rkb25lKGVuZ2luZSwgJmluc3Rkb25lKTsKLQotCS8qIFRo
ZXJlIG1pZ2h0IGJlIHVuc3RhYmxlIHN1YnVuaXQgc3RhdGVzIGV2ZW4gd2hlbgotCSAqIGFjdHVh
bCBoZWFkIGlzIG5vdCBtb3ZpbmcuIEZpbHRlciBvdXQgdGhlIHVuc3RhYmxlIG9uZXMgYnkKLQkg
KiBhY2N1bXVsYXRpbmcgdGhlIHVuZG9uZSAtPiBkb25lIHRyYW5zaXRpb25zIGFuZCBvbmx5Ci0J
ICogY29uc2lkZXIgdGhvc2UgYXMgcHJvZ3Jlc3MuCi0JICovCi0Jc3R1Y2sgPSBpbnN0ZG9uZV91
bmNoYW5nZWQoaW5zdGRvbmUuaW5zdGRvbmUsCi0JCQkJICAgJmFjY3VfaW5zdGRvbmUtPmluc3Rk
b25lKTsKLQlzdHVjayAmPSBpbnN0ZG9uZV91bmNoYW5nZWQoaW5zdGRvbmUuc2xpY2VfY29tbW9u
LAotCQkJCSAgICAmYWNjdV9pbnN0ZG9uZS0+c2xpY2VfY29tbW9uKTsKLQotCWZvcl9lYWNoX2lu
c3Rkb25lX3NsaWNlX3N1YnNsaWNlKGRldl9wcml2LCBzc2V1LCBzbGljZSwgc3Vic2xpY2UpIHsK
LQkJc3R1Y2sgJj0gaW5zdGRvbmVfdW5jaGFuZ2VkKGluc3Rkb25lLnNhbXBsZXJbc2xpY2VdW3N1
YnNsaWNlXSwKLQkJCQkJICAgICZhY2N1X2luc3Rkb25lLT5zYW1wbGVyW3NsaWNlXVtzdWJzbGlj
ZV0pOwotCQlzdHVjayAmPSBpbnN0ZG9uZV91bmNoYW5nZWQoaW5zdGRvbmUucm93W3NsaWNlXVtz
dWJzbGljZV0sCi0JCQkJCSAgICAmYWNjdV9pbnN0ZG9uZS0+cm93W3NsaWNlXVtzdWJzbGljZV0p
OwotCX0KLQotCXJldHVybiBzdHVjazsKLX0KLQotc3RhdGljIGVudW0gaW50ZWxfZW5naW5lX2hh
bmdjaGVja19hY3Rpb24KLWhlYWRfc3R1Y2soc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
LCB1NjQgYWN0aGQpCi17Ci0JaWYgKGFjdGhkICE9IGVuZ2luZS0+aGFuZ2NoZWNrLmFjdGhkKSB7
Ci0KLQkJLyogQ2xlYXIgc3VidW5pdCBzdGF0ZXMgb24gaGVhZCBtb3ZlbWVudCAqLwotCQltZW1z
ZXQoJmVuZ2luZS0+aGFuZ2NoZWNrLmluc3Rkb25lLCAwLAotCQkgICAgICAgc2l6ZW9mKGVuZ2lu
ZS0+aGFuZ2NoZWNrLmluc3Rkb25lKSk7Ci0KLQkJcmV0dXJuIEVOR0lORV9BQ1RJVkVfSEVBRDsK
LQl9Ci0KLQlpZiAoIXN1YnVuaXRzX3N0dWNrKGVuZ2luZSkpCi0JCXJldHVybiBFTkdJTkVfQUNU
SVZFX1NVQlVOSVRTOwotCi0JcmV0dXJuIEVOR0lORV9ERUFEOwotfQotCi1zdGF0aWMgZW51bSBp
bnRlbF9lbmdpbmVfaGFuZ2NoZWNrX2FjdGlvbgotZW5naW5lX3N0dWNrKHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSwgdTY0IGFjdGhkKQotewotCWVudW0gaW50ZWxfZW5naW5lX2hhbmdj
aGVja19hY3Rpb24gaGE7Ci0JdTMyIHRtcDsKLQotCWhhID0gaGVhZF9zdHVjayhlbmdpbmUsIGFj
dGhkKTsKLQlpZiAoaGEgIT0gRU5HSU5FX0RFQUQpCi0JCXJldHVybiBoYTsKLQotCWlmIChJU19H
RU4oZW5naW5lLT5pOTE1LCAyKSkKLQkJcmV0dXJuIEVOR0lORV9ERUFEOwotCi0JLyogSXMgdGhl
IGNoaXAgaGFuZ2luZyBvbiBhIFdBSVRfRk9SX0VWRU5UPwotCSAqIElmIHNvIHdlIGNhbiBzaW1w
bHkgcG9rZSB0aGUgUkJfV0FJVCBiaXQKLQkgKiBhbmQgYnJlYWsgdGhlIGhhbmcuIFRoaXMgc2hv
dWxkIHdvcmsgb24KLQkgKiBhbGwgYnV0IHRoZSBzZWNvbmQgZ2VuZXJhdGlvbiBjaGlwc2V0cy4K
LQkgKi8KLQl0bXAgPSBFTkdJTkVfUkVBRChlbmdpbmUsIFJJTkdfQ1RMKTsKLQlpZiAodG1wICYg
UklOR19XQUlUKSB7Ci0JCWludGVsX2d0X2hhbmRsZV9lcnJvcihlbmdpbmUtPmd0LCBlbmdpbmUt
Pm1hc2ssIDAsCi0JCQkJICAgICAgInN0dWNrIHdhaXQgb24gJXMiLCBlbmdpbmUtPm5hbWUpOwot
CQlFTkdJTkVfV1JJVEUoZW5naW5lLCBSSU5HX0NUTCwgdG1wKTsKLQkJcmV0dXJuIEVOR0lORV9X
QUlUX0tJQ0s7Ci0JfQotCi0JcmV0dXJuIEVOR0lORV9ERUFEOwotfQotCi1zdGF0aWMgdm9pZCBo
YW5nY2hlY2tfbG9hZF9zYW1wbGUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAotCQkJ
CSAgc3RydWN0IGhhbmdjaGVjayAqaGMpCi17Ci0JaGMtPmFjdGhkID0gaW50ZWxfZW5naW5lX2dl
dF9hY3RpdmVfaGVhZChlbmdpbmUpOwotCWhjLT5yaW5nID0gRU5HSU5FX1JFQUQoZW5naW5lLCBS
SU5HX1NUQVJUKTsKLQloYy0+aGVhZCA9IEVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19IRUFEKTsK
LX0KLQotc3RhdGljIHZvaWQgaGFuZ2NoZWNrX3N0b3JlX3NhbXBsZShzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmUsCi0JCQkJICAgY29uc3Qgc3RydWN0IGhhbmdjaGVjayAqaGMpCi17Ci0J
ZW5naW5lLT5oYW5nY2hlY2suYWN0aGQgPSBoYy0+YWN0aGQ7Ci0JZW5naW5lLT5oYW5nY2hlY2su
bGFzdF9yaW5nID0gaGMtPnJpbmc7Ci0JZW5naW5lLT5oYW5nY2hlY2subGFzdF9oZWFkID0gaGMt
PmhlYWQ7Ci19Ci0KLXN0YXRpYyBlbnVtIGludGVsX2VuZ2luZV9oYW5nY2hlY2tfYWN0aW9uCi1o
YW5nY2hlY2tfZ2V0X2FjdGlvbihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCi0JCSAg
ICAgY29uc3Qgc3RydWN0IGhhbmdjaGVjayAqaGMpCi17Ci0JaWYgKGludGVsX2VuZ2luZV9pc19p
ZGxlKGVuZ2luZSkpCi0JCXJldHVybiBFTkdJTkVfSURMRTsKLQotCWlmIChlbmdpbmUtPmhhbmdj
aGVjay5sYXN0X3JpbmcgIT0gaGMtPnJpbmcpCi0JCXJldHVybiBFTkdJTkVfQUNUSVZFX1NFUU5P
OwotCi0JaWYgKGVuZ2luZS0+aGFuZ2NoZWNrLmxhc3RfaGVhZCAhPSBoYy0+aGVhZCkKLQkJcmV0
dXJuIEVOR0lORV9BQ1RJVkVfU0VRTk87Ci0KLQlyZXR1cm4gZW5naW5lX3N0dWNrKGVuZ2luZSwg
aGMtPmFjdGhkKTsKLX0KLQotc3RhdGljIHZvaWQgaGFuZ2NoZWNrX2FjY3VtdWxhdGVfc2FtcGxl
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCQkJc3RydWN0IGhhbmdjaGVjayAq
aGMpCi17Ci0JdW5zaWduZWQgbG9uZyB0aW1lb3V0ID0gSTkxNV9FTkdJTkVfREVBRF9USU1FT1VU
OwotCi0JaGMtPmFjdGlvbiA9IGhhbmdjaGVja19nZXRfYWN0aW9uKGVuZ2luZSwgaGMpOwotCi0J
LyogV2UgYWx3YXlzIGluY3JlbWVudCB0aGUgcHJvZ3Jlc3MKLQkgKiBpZiB0aGUgZW5naW5lIGlz
IGJ1c3kgYW5kIHN0aWxsIHByb2Nlc3NpbmcKLQkgKiB0aGUgc2FtZSByZXF1ZXN0LCBzbyB0aGF0
IG5vIHNpbmdsZSByZXF1ZXN0Ci0JICogY2FuIHJ1biBpbmRlZmluaXRlbHkgKHN1Y2ggYXMgYSBj
aGFpbiBvZgotCSAqIGJhdGNoZXMpLiBUaGUgb25seSB0aW1lIHdlIGRvIG5vdCBpbmNyZW1lbnQK
LQkgKiB0aGUgaGFuZ2NoZWNrIHNjb3JlIG9uIHRoaXMgcmluZywgaWYgdGhpcwotCSAqIGVuZ2lu
ZSBpcyBpbiBhIGxlZ2l0aW1hdGUgd2FpdCBmb3IgYW5vdGhlcgotCSAqIGVuZ2luZS4gSW4gdGhh
dCBjYXNlIHRoZSB3YWl0aW5nIGVuZ2luZSBpcyBhCi0JICogdmljdGltIGFuZCB3ZSB3YW50IHRv
IGJlIHN1cmUgd2UgY2F0Y2ggdGhlCi0JICogcmlnaHQgY3VscHJpdC4gVGhlbiBldmVyeSB0aW1l
IHdlIGRvIGtpY2sKLQkgKiB0aGUgcmluZywgbWFrZSBpdCBhcyBhIHByb2dyZXNzIGFzIHRoZSBz
ZXFubwotCSAqIGFkdmFuY2VtZW50IG1pZ2h0IGVuc3VyZSBhbmQgaWYgbm90LCBpdAotCSAqIHdp
bGwgY2F0Y2ggdGhlIGhhbmdpbmcgZW5naW5lLgotCSAqLwotCi0Jc3dpdGNoIChoYy0+YWN0aW9u
KSB7Ci0JY2FzZSBFTkdJTkVfSURMRToKLQljYXNlIEVOR0lORV9BQ1RJVkVfU0VRTk86Ci0JCS8q
IENsZWFyIGhlYWQgYW5kIHN1YnVuaXQgc3RhdGVzIG9uIHNlcW5vIG1vdmVtZW50ICovCi0JCWhj
LT5hY3RoZCA9IDA7Ci0KLQkJbWVtc2V0KCZlbmdpbmUtPmhhbmdjaGVjay5pbnN0ZG9uZSwgMCwK
LQkJICAgICAgIHNpemVvZihlbmdpbmUtPmhhbmdjaGVjay5pbnN0ZG9uZSkpOwotCi0JCS8qIElu
dGVudGlvbmFsIGZhbGwgdGhyb3VnaCAqLwotCWNhc2UgRU5HSU5FX1dBSVRfS0lDSzoKLQljYXNl
IEVOR0lORV9XQUlUOgotCQllbmdpbmUtPmhhbmdjaGVjay5hY3Rpb25fdGltZXN0YW1wID0gamlm
ZmllczsKLQkJYnJlYWs7Ci0KLQljYXNlIEVOR0lORV9BQ1RJVkVfSEVBRDoKLQljYXNlIEVOR0lO
RV9BQ1RJVkVfU1VCVU5JVFM6Ci0JCS8qCi0JCSAqIFNlcW5vIHN0dWNrIHdpdGggc3RpbGwgYWN0
aXZlIGVuZ2luZSBnZXRzIGxlZXdheSwKLQkJICogaW4gaG9wZXMgdGhhdCBpdCBpcyBqdXN0IGEg
bG9uZyBzaGFkZXIuCi0JCSAqLwotCQl0aW1lb3V0ID0gSTkxNV9TRVFOT19ERUFEX1RJTUVPVVQ7
Ci0JCWJyZWFrOwotCi0JY2FzZSBFTkdJTkVfREVBRDoKLQkJYnJlYWs7Ci0KLQlkZWZhdWx0Ogot
CQlNSVNTSU5HX0NBU0UoaGMtPmFjdGlvbik7Ci0JfQotCi0JaGMtPnN0YWxsZWQgPSB0aW1lX2Fm
dGVyKGppZmZpZXMsCi0JCQkJIGVuZ2luZS0+aGFuZ2NoZWNrLmFjdGlvbl90aW1lc3RhbXAgKyB0
aW1lb3V0KTsKLQloYy0+d2VkZ2VkID0gdGltZV9hZnRlcihqaWZmaWVzLAotCQkJCSBlbmdpbmUt
PmhhbmdjaGVjay5hY3Rpb25fdGltZXN0YW1wICsKLQkJCQkgSTkxNV9FTkdJTkVfV0VER0VEX1RJ
TUVPVVQpOwotfQotCi1zdGF0aWMgdm9pZCBoYW5nY2hlY2tfZGVjbGFyZV9oYW5nKHN0cnVjdCBp
bnRlbF9ndCAqZ3QsCi0JCQkJICAgaW50ZWxfZW5naW5lX21hc2tfdCBodW5nLAotCQkJCSAgIGlu
dGVsX2VuZ2luZV9tYXNrX3Qgc3R1Y2spCi17Ci0Jc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lOwotCWludGVsX2VuZ2luZV9tYXNrX3QgdG1wOwotCWNoYXIgbXNnWzgwXTsKLQlpbnQgbGVu
OwotCi0JLyogSWYgc29tZSByaW5ncyBodW5nIGJ1dCBvdGhlcnMgd2VyZSBzdGlsbCBidXN5LCBv
bmx5Ci0JICogYmxhbWUgdGhlIGhhbmdpbmcgcmluZ3MgaW4gdGhlIHN5bm9wc2lzLgotCSAqLwot
CWlmIChzdHVjayAhPSBodW5nKQotCQlodW5nICY9IH5zdHVjazsKLQlsZW4gPSBzY25wcmludGYo
bXNnLCBzaXplb2YobXNnKSwKLQkJCSIlcyBvbiAiLCBzdHVjayA9PSBodW5nID8gIm5vIHByb2dy
ZXNzIiA6ICJoYW5nIik7Ci0JZm9yX2VhY2hfZW5naW5lX21hc2tlZChlbmdpbmUsIGd0LT5pOTE1
LCBodW5nLCB0bXApCi0JCWxlbiArPSBzY25wcmludGYobXNnICsgbGVuLCBzaXplb2YobXNnKSAt
IGxlbiwKLQkJCQkgIiVzLCAiLCBlbmdpbmUtPm5hbWUpOwotCW1zZ1tsZW4tMl0gPSAnXDAnOwot
Ci0JcmV0dXJuIGludGVsX2d0X2hhbmRsZV9lcnJvcihndCwgaHVuZywgSTkxNV9FUlJPUl9DQVBU
VVJFLCAiJXMiLCBtc2cpOwotfQotCi0vKgotICogVGhpcyBpcyBjYWxsZWQgd2hlbiB0aGUgY2hp
cCBoYXNuJ3QgcmVwb3J0ZWQgYmFjayB3aXRoIGNvbXBsZXRlZAotICogYmF0Y2hidWZmZXJzIGlu
IGEgbG9uZyB0aW1lLiBXZSBrZWVwIHRyYWNrIHBlciByaW5nIHNlcW5vIHByb2dyZXNzIGFuZAot
ICogaWYgdGhlcmUgYXJlIG5vIHByb2dyZXNzLCBoYW5nY2hlY2sgc2NvcmUgZm9yIHRoYXQgcmlu
ZyBpcyBpbmNyZWFzZWQuCi0gKiBGdXJ0aGVyLCBhY3RoZCBpcyBpbnNwZWN0ZWQgdG8gc2VlIGlm
IHRoZSByaW5nIGlzIHN0dWNrLiBPbiBzdHVjayBjYXNlCi0gKiB3ZSBraWNrIHRoZSByaW5nLiBJ
ZiB3ZSBzZWUgbm8gcHJvZ3Jlc3Mgb24gdGhyZWUgc3Vic2VxdWVudCBjYWxscwotICogd2UgYXNz
dW1lIGNoaXAgaXMgd2VkZ2VkIGFuZCB0cnkgdG8gZml4IGl0IGJ5IHJlc2V0dGluZyB0aGUgY2hp
cC4KLSAqLwotc3RhdGljIHZvaWQgaGFuZ2NoZWNrX2VsYXBzZWQoc3RydWN0IHdvcmtfc3RydWN0
ICp3b3JrKQotewotCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPQotCQljb250YWluZXJfb2Yod29yaywg
dHlwZW9mKCpndCksIGhhbmdjaGVjay53b3JrLndvcmspOwotCWludGVsX2VuZ2luZV9tYXNrX3Qg
aHVuZyA9IDAsIHN0dWNrID0gMCwgd2VkZ2VkID0gMDsKLQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmU7Ci0JZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Ci0JaW50ZWxfd2FrZXJlZl90IHdh
a2VyZWY7Ci0KLQlpZiAoIWk5MTVfbW9kcGFyYW1zLmVuYWJsZV9oYW5nY2hlY2spCi0JCXJldHVy
bjsKLQotCWlmICghUkVBRF9PTkNFKGd0LT5hd2FrZSkpCi0JCXJldHVybjsKLQotCWlmIChpbnRl
bF9ndF9pc193ZWRnZWQoZ3QpKQotCQlyZXR1cm47Ci0KLQl3YWtlcmVmID0gaW50ZWxfcnVudGlt
ZV9wbV9nZXRfaWZfaW5fdXNlKCZndC0+aTkxNS0+cnVudGltZV9wbSk7Ci0JaWYgKCF3YWtlcmVm
KQotCQlyZXR1cm47Ci0KLQkvKiBBcyBlbmFibGluZyB0aGUgR1BVIHJlcXVpcmVzIGZhaXJseSBl
eHRlbnNpdmUgbW1pbyBhY2Nlc3MsCi0JICogcGVyaW9kaWNhbGx5IGFybSB0aGUgbW1pbyBjaGVj
a2VyIHRvIHNlZSBpZiB3ZSBhcmUgdHJpZ2dlcmluZwotCSAqIGFueSBpbnZhbGlkIGFjY2Vzcy4K
LQkgKi8KLQlpbnRlbF91bmNvcmVfYXJtX3VuY2xhaW1lZF9tbWlvX2RldGVjdGlvbihndC0+dW5j
b3JlKTsKLQotCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LT5pOTE1LCBpZCkgewotCQlzdHJ1
Y3QgaGFuZ2NoZWNrIGhjOwotCi0JCWludGVsX2VuZ2luZV9zaWduYWxfYnJlYWRjcnVtYnMoZW5n
aW5lKTsKLQotCQloYW5nY2hlY2tfbG9hZF9zYW1wbGUoZW5naW5lLCAmaGMpOwotCQloYW5nY2hl
Y2tfYWNjdW11bGF0ZV9zYW1wbGUoZW5naW5lLCAmaGMpOwotCQloYW5nY2hlY2tfc3RvcmVfc2Ft
cGxlKGVuZ2luZSwgJmhjKTsKLQotCQlpZiAoaGMuc3RhbGxlZCkgewotCQkJaHVuZyB8PSBlbmdp
bmUtPm1hc2s7Ci0JCQlpZiAoaGMuYWN0aW9uICE9IEVOR0lORV9ERUFEKQotCQkJCXN0dWNrIHw9
IGVuZ2luZS0+bWFzazsKLQkJfQotCi0JCWlmIChoYy53ZWRnZWQpCi0JCQl3ZWRnZWQgfD0gZW5n
aW5lLT5tYXNrOwotCX0KLQotCWlmIChHRU1fU0hPV19ERUJVRygpICYmIChodW5nIHwgc3R1Y2sp
KSB7Ci0JCXN0cnVjdCBkcm1fcHJpbnRlciBwID0gZHJtX2RlYnVnX3ByaW50ZXIoImhhbmdjaGVj
ayIpOwotCi0JCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LT5pOTE1LCBpZCkgewotCQkJaWYg
KGludGVsX2VuZ2luZV9pc19pZGxlKGVuZ2luZSkpCi0JCQkJY29udGludWU7Ci0KLQkJCWludGVs
X2VuZ2luZV9kdW1wKGVuZ2luZSwgJnAsICIlc1xuIiwgZW5naW5lLT5uYW1lKTsKLQkJfQotCX0K
LQotCWlmICh3ZWRnZWQpIHsKLQkJZGV2X2VycihndC0+aTkxNS0+ZHJtLmRldiwKLQkJCSJHUFUg
cmVjb3ZlcnkgdGltZWQgb3V0LCIKLQkJCSIgY2FuY2VsbGluZyBhbGwgaW4tZmxpZ2h0IHJlbmRl
cmluZy5cbiIpOwotCQlHRU1fVFJBQ0VfRFVNUCgpOwotCQlpbnRlbF9ndF9zZXRfd2VkZ2VkKGd0
KTsKLQl9Ci0KLQlpZiAoaHVuZykKLQkJaGFuZ2NoZWNrX2RlY2xhcmVfaGFuZyhndCwgaHVuZywg
c3R1Y2spOwotCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoJmd0LT5pOTE1LT5ydW50aW1lX3BtLCB3
YWtlcmVmKTsKLQotCS8qIFJlc2V0IHRpbWVyIGluIGNhc2UgR1BVIGhhbmdzIHdpdGhvdXQgYW5v
dGhlciByZXF1ZXN0IGJlaW5nIGFkZGVkICovCi0JaW50ZWxfZ3RfcXVldWVfaGFuZ2NoZWNrKGd0
KTsKLX0KLQotdm9pZCBpbnRlbF9ndF9xdWV1ZV9oYW5nY2hlY2soc3RydWN0IGludGVsX2d0ICpn
dCkKLXsKLQl1bnNpZ25lZCBsb25nIGRlbGF5OwotCi0JaWYgKHVubGlrZWx5KCFpOTE1X21vZHBh
cmFtcy5lbmFibGVfaGFuZ2NoZWNrKSkKLQkJcmV0dXJuOwotCi0JLyoKLQkgKiBEb24ndCBjb250
aW51YWxseSBkZWZlciB0aGUgaGFuZ2NoZWNrIHNvIHRoYXQgaXQgaXMgYWx3YXlzIHJ1biBhdAot
CSAqIGxlYXN0IG9uY2UgYWZ0ZXIgd29yayBoYXMgYmVlbiBzY2hlZHVsZWQgb24gYW55IHJpbmcu
IE90aGVyd2lzZSwKLQkgKiB3ZSB3aWxsIGlnbm9yZSBhIGh1bmcgcmluZyBpZiBhIHNlY29uZCBy
aW5nIGlzIGtlcHQgYnVzeS4KLQkgKi8KLQotCWRlbGF5ID0gcm91bmRfamlmZmllc191cF9yZWxh
dGl2ZShEUk1fSTkxNV9IQU5HQ0hFQ0tfSklGRklFUyk7Ci0JcXVldWVfZGVsYXllZF93b3JrKHN5
c3RlbV9sb25nX3dxLCAmZ3QtPmhhbmdjaGVjay53b3JrLCBkZWxheSk7Ci19Ci0KLXZvaWQgaW50
ZWxfZW5naW5lX2luaXRfaGFuZ2NoZWNrKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkK
LXsKLQltZW1zZXQoJmVuZ2luZS0+aGFuZ2NoZWNrLCAwLCBzaXplb2YoZW5naW5lLT5oYW5nY2hl
Y2spKTsKLQllbmdpbmUtPmhhbmdjaGVjay5hY3Rpb25fdGltZXN0YW1wID0gamlmZmllczsKLX0K
LQotdm9pZCBpbnRlbF9ndF9pbml0X2hhbmdjaGVjayhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQotewot
CUlOSVRfREVMQVlFRF9XT1JLKCZndC0+aGFuZ2NoZWNrLndvcmssIGhhbmdjaGVja19lbGFwc2Vk
KTsKLX0KLQotI2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X1NFTEZURVNUKQotI2luY2x1
ZGUgInNlbGZ0ZXN0X2hhbmdjaGVjay5jIgotI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfcmVzZXQuYwppbmRleCA0ODI1YzgyYWVmZWUuLmZlYmFiMzY4ZDhjZiAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jCkBAIC05ODMsOCArOTgzLDYgQEAgdm9pZCBpbnRlbF9n
dF9yZXNldChzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAogCWlmIChyZXQpCiAJCWdvdG8gdGFpbnQ7CiAK
LQlpbnRlbF9ndF9xdWV1ZV9oYW5nY2hlY2soZ3QpOwotCiBmaW5pc2g6CiAJcmVzZXRfZmluaXNo
KGd0LCBhd2FrZSk7CiB1bmxvY2s6CkBAIC0xMzEwLDQgKzEzMDgsNSBAQCB2b2lkIF9faW50ZWxf
ZmluaV93ZWRnZShzdHJ1Y3QgaW50ZWxfd2VkZ2VfbWUgKncpCiAKICNpZiBJU19FTkFCTEVEKENP
TkZJR19EUk1fSTkxNV9TRUxGVEVTVCkKICNpbmNsdWRlICJzZWxmdGVzdF9yZXNldC5jIgorI2lu
Y2x1ZGUgInNlbGZ0ZXN0X2hhbmdjaGVjay5jIgogI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hlY2suYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jCmluZGV4IGZjNGQwMjQwNjUzNi4uZjJiNWFiMWU1
YTJlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hl
Y2suYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hlY2suYwpA
QCAtMTY4MSw3ICsxNjgxLDYgQEAgaW50IGludGVsX2hhbmdjaGVja19saXZlX3NlbGZ0ZXN0cyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAl9OwogCXN0cnVjdCBpbnRlbF9ndCAqZ3Qg
PSAmaTkxNS0+Z3Q7CiAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Ci0JYm9vbCBzYXZlZF9oYW5n
Y2hlY2s7CiAJaW50IGVycjsKIAogCWlmICghaW50ZWxfaGFzX2dwdV9yZXNldChndC0+aTkxNSkp
CkBAIC0xNjkxLDEyICsxNjkwLDkgQEAgaW50IGludGVsX2hhbmdjaGVja19saXZlX3NlbGZ0ZXN0
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkJcmV0dXJuIC1FSU87IC8qIHdlJ3Jl
IGxvbmcgcGFzdCBob3BlIG9mIGEgc3VjY2Vzc2Z1bCByZXNldCAqLwogCiAJd2FrZXJlZiA9IGlu
dGVsX3J1bnRpbWVfcG1fZ2V0KCZndC0+aTkxNS0+cnVudGltZV9wbSk7Ci0Jc2F2ZWRfaGFuZ2No
ZWNrID0gZmV0Y2hfYW5kX3plcm8oJmk5MTVfbW9kcGFyYW1zLmVuYWJsZV9oYW5nY2hlY2spOwot
CWRyYWluX2RlbGF5ZWRfd29yaygmZ3QtPmhhbmdjaGVjay53b3JrKTsgLyogZmx1c2ggcGFyYW0g
Ki8KIAogCWVyciA9IGludGVsX2d0X2xpdmVfc3VidGVzdHModGVzdHMsIGd0KTsKIAotCWk5MTVf
bW9kcGFyYW1zLmVuYWJsZV9oYW5nY2hlY2sgPSBzYXZlZF9oYW5nY2hlY2s7CiAJaW50ZWxfcnVu
dGltZV9wbV9wdXQoJmd0LT5pOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAogCXJldHVybiBl
cnI7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCmluZGV4IDkzNjE3MmY1OGE2NS4uZDVk
MTM2NTk1ZWRmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwpAQCAtOTg3LDkyICs5
ODcsNiBAQCBzdGF0aWMgaW50IGk5MTVfZnJlcXVlbmN5X2luZm8oc3RydWN0IHNlcV9maWxlICpt
LCB2b2lkICp1bnVzZWQpCiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIHZvaWQgaTkxNV9pbnN0
ZG9uZV9pbmZvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCSAgICAgICBz
dHJ1Y3Qgc2VxX2ZpbGUgKm0sCi0JCQkgICAgICAgc3RydWN0IGludGVsX2luc3Rkb25lICppbnN0
ZG9uZSkKLXsKLQljb25zdCBzdHJ1Y3Qgc3NldV9kZXZfaW5mbyAqc3NldSA9ICZSVU5USU1FX0lO
Rk8oZGV2X3ByaXYpLT5zc2V1OwotCWludCBzbGljZTsKLQlpbnQgc3Vic2xpY2U7Ci0KLQlzZXFf
cHJpbnRmKG0sICJcdFx0SU5TVERPTkU6IDB4JTA4eFxuIiwKLQkJICAgaW5zdGRvbmUtPmluc3Rk
b25lKTsKLQotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDMpCi0JCXJldHVybjsKLQotCXNl
cV9wcmludGYobSwgIlx0XHRTQ19JTlNURE9ORTogMHglMDh4XG4iLAotCQkgICBpbnN0ZG9uZS0+
c2xpY2VfY29tbW9uKTsKLQotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDYpCi0JCXJldHVy
bjsKLQotCWZvcl9lYWNoX2luc3Rkb25lX3NsaWNlX3N1YnNsaWNlKGRldl9wcml2LCBzc2V1LCBz
bGljZSwgc3Vic2xpY2UpCi0JCXNlcV9wcmludGYobSwgIlx0XHRTQU1QTEVSX0lOU1RET05FWyVk
XVslZF06IDB4JTA4eFxuIiwKLQkJCSAgIHNsaWNlLCBzdWJzbGljZSwgaW5zdGRvbmUtPnNhbXBs
ZXJbc2xpY2VdW3N1YnNsaWNlXSk7Ci0KLQlmb3JfZWFjaF9pbnN0ZG9uZV9zbGljZV9zdWJzbGlj
ZShkZXZfcHJpdiwgc3NldSwgc2xpY2UsIHN1YnNsaWNlKQotCQlzZXFfcHJpbnRmKG0sICJcdFx0
Uk9XX0lOU1RET05FWyVkXVslZF06IDB4JTA4eFxuIiwKLQkJCSAgIHNsaWNlLCBzdWJzbGljZSwg
aW5zdGRvbmUtPnJvd1tzbGljZV1bc3Vic2xpY2VdKTsKLX0KLQotc3RhdGljIGludCBpOTE1X2hh
bmdjaGVja19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQotewotCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwotCXN0
cnVjdCBpbnRlbF9ndCAqZ3QgPSAmaTkxNS0+Z3Q7Ci0Jc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lOwotCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwotCWVudW0gaW50ZWxfZW5naW5lX2lk
IGlkOwotCi0Jc2VxX3ByaW50ZihtLCAiUmVzZXQgZmxhZ3M6ICVseFxuIiwgZ3QtPnJlc2V0LmZs
YWdzKTsKLQlpZiAodGVzdF9iaXQoSTkxNV9XRURHRUQsICZndC0+cmVzZXQuZmxhZ3MpKQotCQlz
ZXFfcHV0cyhtLCAiXHRXZWRnZWRcbiIpOwotCWlmICh0ZXN0X2JpdChJOTE1X1JFU0VUX0JBQ0tP
RkYsICZndC0+cmVzZXQuZmxhZ3MpKQotCQlzZXFfcHV0cyhtLCAiXHREZXZpY2UgKGdsb2JhbCkg
cmVzZXQgaW4gcHJvZ3Jlc3NcbiIpOwotCi0JaWYgKCFpOTE1X21vZHBhcmFtcy5lbmFibGVfaGFu
Z2NoZWNrKSB7Ci0JCXNlcV9wdXRzKG0sICJIYW5nY2hlY2sgZGlzYWJsZWRcbiIpOwotCQlyZXR1
cm4gMDsKLQl9Ci0KLQlpZiAodGltZXJfcGVuZGluZygmZ3QtPmhhbmdjaGVjay53b3JrLnRpbWVy
KSkKLQkJc2VxX3ByaW50ZihtLCAiSGFuZ2NoZWNrIGFjdGl2ZSwgdGltZXIgZmlyZXMgaW4gJWRt
c1xuIiwKLQkJCSAgIGppZmZpZXNfdG9fbXNlY3MoZ3QtPmhhbmdjaGVjay53b3JrLnRpbWVyLmV4
cGlyZXMgLQotCQkJCQkgICAgamlmZmllcykpOwotCWVsc2UgaWYgKGRlbGF5ZWRfd29ya19wZW5k
aW5nKCZndC0+aGFuZ2NoZWNrLndvcmspKQotCQlzZXFfcHV0cyhtLCAiSGFuZ2NoZWNrIGFjdGl2
ZSwgd29yayBwZW5kaW5nXG4iKTsKLQllbHNlCi0JCXNlcV9wdXRzKG0sICJIYW5nY2hlY2sgaW5h
Y3RpdmVcbiIpOwotCi0Jc2VxX3ByaW50ZihtLCAiR1QgYWN0aXZlPyAlc1xuIiwgeWVzbm8oZ3Qt
PmF3YWtlKSk7Ci0KLQl3aXRoX2ludGVsX3J1bnRpbWVfcG0oJmk5MTUtPnJ1bnRpbWVfcG0sIHdh
a2VyZWYpIHsKLQkJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKLQkJCXN0cnVj
dCBpbnRlbF9pbnN0ZG9uZSBpbnN0ZG9uZTsKLQotCQkJc2VxX3ByaW50ZihtLCAiJXM6ICVkIG1z
IGFnb1xuIiwKLQkJCQkgICBlbmdpbmUtPm5hbWUsCi0JCQkJICAgamlmZmllc190b19tc2Vjcyhq
aWZmaWVzIC0KLQkJCQkJCSAgICBlbmdpbmUtPmhhbmdjaGVjay5hY3Rpb25fdGltZXN0YW1wKSk7
Ci0KLQkJCXNlcV9wcmludGYobSwgIlx0QUNUSEQgPSAweCUwOGxseCBbY3VycmVudCAweCUwOGxs
eF1cbiIsCi0JCQkJICAgKGxvbmcgbG9uZyllbmdpbmUtPmhhbmdjaGVjay5hY3RoZCwKLQkJCQkg
ICBpbnRlbF9lbmdpbmVfZ2V0X2FjdGl2ZV9oZWFkKGVuZ2luZSkpOwotCi0JCQlpbnRlbF9lbmdp
bmVfZ2V0X2luc3Rkb25lKGVuZ2luZSwgJmluc3Rkb25lKTsKLQotCQkJc2VxX3B1dHMobSwgIlx0
aW5zdGRvbmUgcmVhZCA9XG4iKTsKLQkJCWk5MTVfaW5zdGRvbmVfaW5mbyhpOTE1LCBtLCAmaW5z
dGRvbmUpOwotCi0JCQlzZXFfcHV0cyhtLCAiXHRpbnN0ZG9uZSBhY2N1ID1cbiIpOwotCQkJaTkx
NV9pbnN0ZG9uZV9pbmZvKGk5MTUsIG0sCi0JCQkJCSAgICZlbmdpbmUtPmhhbmdjaGVjay5pbnN0
ZG9uZSk7Ci0JCX0KLQl9Ci0KLQlyZXR1cm4gMDsKLX0KLQogc3RhdGljIGludCBpcm9ubGFrZV9k
cnBjX2luZm8oc3RydWN0IHNlcV9maWxlICptKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwpAQCAtNDI4Niw3ICs0MjAwLDYgQEAg
c3RhdGljIGNvbnN0IHN0cnVjdCBkcm1faW5mb19saXN0IGk5MTVfZGVidWdmc19saXN0W10gPSB7
CiAJeyJpOTE1X2d1Y19zdGFnZV9wb29sIiwgaTkxNV9ndWNfc3RhZ2VfcG9vbCwgMH0sCiAJeyJp
OTE1X2h1Y19sb2FkX3N0YXR1cyIsIGk5MTVfaHVjX2xvYWRfc3RhdHVzX2luZm8sIDB9LAogCXsi
aTkxNV9mcmVxdWVuY3lfaW5mbyIsIGk5MTVfZnJlcXVlbmN5X2luZm8sIDB9LAotCXsiaTkxNV9o
YW5nY2hlY2tfaW5mbyIsIGk5MTVfaGFuZ2NoZWNrX2luZm8sIDB9LAogCXsiaTkxNV9kcnBjX2lu
Zm8iLCBpOTE1X2RycGNfaW5mbywgMH0sCiAJeyJpOTE1X3JpbmdfZnJlcV90YWJsZSIsIGk5MTVf
cmluZ19mcmVxX3RhYmxlLCAwfSwKIAl7Imk5MTVfZnJvbnRidWZmZXJfdHJhY2tpbmciLCBpOTE1
X2Zyb250YnVmZmVyX3RyYWNraW5nLCAwfSwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCmluZGV4IGJl
YzI1OTQyZDc3ZC4uNDVkZDY1ZmQyMzFiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2Rydi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKQEAgLTE2
MjQsMTAgKzE2MjQsNyBAQCB2b2lkIGk5MTVfZHJpdmVyX3JlbW92ZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKIAogCWludGVsX2Nzcl91Y29kZV9maW5pKGk5MTUpOwogCi0JLyogRnJl
ZSBlcnJvciBzdGF0ZSBhZnRlciBpbnRlcnJ1cHRzIGFyZSBmdWxseSBkaXNhYmxlZC4gKi8KLQlj
YW5jZWxfZGVsYXllZF93b3JrX3N5bmMoJmk5MTUtPmd0LmhhbmdjaGVjay53b3JrKTsKIAlpOTE1
X3Jlc2V0X2Vycm9yX3N0YXRlKGk5MTUpOwotCiAJaTkxNV9nZW1fZHJpdmVyX3JlbW92ZShpOTE1
KTsKIAogCWludGVsX3Bvd2VyX2RvbWFpbnNfZHJpdmVyX3JlbW92ZShpOTE1KTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2Rydi5oCmluZGV4IDlkMWQ2YmRiM2ZlZS4uZGU3YWZmNzBhOTNiIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZHJ2LmgKQEAgLTIxOTYsNyArMjE5Niw2IEBAIGV4dGVybiBjb25zdCBzdHJ1Y3Qg
ZGV2X3BtX29wcyBpOTE1X3BtX29wczsKIGludCBpOTE1X2RyaXZlcl9wcm9iZShzdHJ1Y3QgcGNp
X2RldiAqcGRldiwgY29uc3Qgc3RydWN0IHBjaV9kZXZpY2VfaWQgKmVudCk7CiB2b2lkIGk5MTVf
ZHJpdmVyX3JlbW92ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7CiAKLXZvaWQgaW50
ZWxfZW5naW5lX2luaXRfaGFuZ2NoZWNrKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7
CiBpbnQgdmx2X2ZvcmNlX2dmeF9jbG9jayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsIGJvb2wgb24pOwogCiBzdGF0aWMgaW5saW5lIGJvb2wgaW50ZWxfZ3Z0X2FjdGl2ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVf
ZXJyb3IuYwppbmRleCAyZGQ2M2EyNjFiMDAuLmZjYWU5M2E5NzY3ZSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2dwdV9lcnJvci5jCkBAIC01MzQsMTAgKzUzNCw2IEBAIHN0YXRpYyB2b2lkIGVy
cm9yX3ByaW50X2VuZ2luZShzdHJ1Y3QgZHJtX2k5MTVfZXJyb3Jfc3RhdGVfYnVmICptLAogCX0K
IAllcnJfcHJpbnRmKG0sICIgIHJpbmctPmhlYWQ6IDB4JTA4eFxuIiwgZWUtPmNwdV9yaW5nX2hl
YWQpOwogCWVycl9wcmludGYobSwgIiAgcmluZy0+dGFpbDogMHglMDh4XG4iLCBlZS0+Y3B1X3Jp
bmdfdGFpbCk7Ci0JZXJyX3ByaW50ZihtLCAiICBoYW5nY2hlY2sgdGltZXN0YW1wOiAlZG1zICgl
bHUlcylcbiIsCi0JCSAgIGppZmZpZXNfdG9fbXNlY3MoZWUtPmhhbmdjaGVja190aW1lc3RhbXAg
LSBlcG9jaCksCi0JCSAgIGVlLT5oYW5nY2hlY2tfdGltZXN0YW1wLAotCQkgICBlZS0+aGFuZ2No
ZWNrX3RpbWVzdGFtcCA9PSBlcG9jaCA/ICI7IGVwb2NoIiA6ICIiKTsKIAllcnJfcHJpbnRmKG0s
ICIgIGVuZ2luZSByZXNldCBjb3VudDogJXVcbiIsIGVlLT5yZXNldF9jb3VudCk7CiAKIAlmb3Ig
KG4gPSAwOyBuIDwgZWUtPm51bV9wb3J0czsgbisrKSB7CkBAIC02NzYsMTEgKzY3Miw4IEBAIHN0
YXRpYyB2b2lkIF9fZXJyX3ByaW50X3RvX3NnbChzdHJ1Y3QgZHJtX2k5MTVfZXJyb3Jfc3RhdGVf
YnVmICptLAogCXRzID0ga3RpbWVfdG9fdGltZXNwZWM2NChlcnJvci0+dXB0aW1lKTsKIAllcnJf
cHJpbnRmKG0sICJVcHRpbWU6ICVsbGQgcyAlbGQgdXNcbiIsCiAJCSAgIChzNjQpdHMudHZfc2Vj
LCB0cy50dl9uc2VjIC8gTlNFQ19QRVJfVVNFQyk7Ci0JZXJyX3ByaW50ZihtLCAiRXBvY2g6ICVs
dSBqaWZmaWVzICgldSBIWilcbiIsIGVycm9yLT5lcG9jaCwgSFopOwotCWVycl9wcmludGYobSwg
IkNhcHR1cmU6ICVsdSBqaWZmaWVzOyAlZCBtcyBhZ28sICVkIG1zIGFmdGVyIGVwb2NoXG4iLAot
CQkgICBlcnJvci0+Y2FwdHVyZSwKLQkJICAgamlmZmllc190b19tc2VjcyhqaWZmaWVzIC0gZXJy
b3ItPmNhcHR1cmUpLAotCQkgICBqaWZmaWVzX3RvX21zZWNzKGVycm9yLT5jYXB0dXJlIC0gZXJy
b3ItPmVwb2NoKSk7CisJZXJyX3ByaW50ZihtLCAiQ2FwdHVyZTogJWx1IGppZmZpZXM7ICVkIG1z
IGFnb1xuIiwKKwkJICAgZXJyb3ItPmNhcHR1cmUsIGppZmZpZXNfdG9fbXNlY3MoamlmZmllcyAt
IGVycm9yLT5jYXB0dXJlKSk7CiAKIAlmb3IgKGVlID0gZXJyb3ItPmVuZ2luZTsgZWU7IGVlID0g
ZWUtPm5leHQpCiAJCWVycl9wcmludGYobSwgIkFjdGl2ZSBwcm9jZXNzIChvbiByaW5nICVzKTog
JXMgWyVkXVxuIiwKQEAgLTczNiw3ICs3MjksNyBAQCBzdGF0aWMgdm9pZCBfX2Vycl9wcmludF90
b19zZ2woc3RydWN0IGRybV9pOTE1X2Vycm9yX3N0YXRlX2J1ZiAqbSwKIAkJZXJyX3ByaW50Ziht
LCAiRVJSX0lOVDogMHglMDh4XG4iLCBlcnJvci0+ZXJyX2ludCk7CiAKIAlmb3IgKGVlID0gZXJy
b3ItPmVuZ2luZTsgZWU7IGVlID0gZWUtPm5leHQpCi0JCWVycm9yX3ByaW50X2VuZ2luZShtLCBl
ZSwgZXJyb3ItPmVwb2NoKTsKKwkJZXJyb3JfcHJpbnRfZW5naW5lKG0sIGVlLCBlcnJvci0+Y2Fw
dHVyZSk7CiAKIAlmb3IgKGVlID0gZXJyb3ItPmVuZ2luZTsgZWU7IGVlID0gZWUtPm5leHQpIHsK
IAkJY29uc3Qgc3RydWN0IGRybV9pOTE1X2Vycm9yX29iamVjdCAqb2JqOwpAQCAtNzY0LDcgKzc1
Nyw3IEBAIHN0YXRpYyB2b2lkIF9fZXJyX3ByaW50X3RvX3NnbChzdHJ1Y3QgZHJtX2k5MTVfZXJy
b3Jfc3RhdGVfYnVmICptLAogCQkJZm9yIChqID0gMDsgaiA8IGVlLT5udW1fcmVxdWVzdHM7IGor
KykKIAkJCQllcnJvcl9wcmludF9yZXF1ZXN0KG0sICIgIiwKIAkJCQkJCSAgICAmZWUtPnJlcXVl
c3RzW2pdLAotCQkJCQkJICAgIGVycm9yLT5lcG9jaCk7CisJCQkJCQkgICAgZXJyb3ItPmNhcHR1
cmUpOwogCQl9CiAKIAkJcHJpbnRfZXJyb3Jfb2JqKG0sIGVlLT5lbmdpbmUsICJyaW5nYnVmZmVy
IiwgZWUtPnJpbmdidWZmZXIpOwpAQCAtMTEzNyw4ICsxMTMwLDYgQEAgc3RhdGljIHZvaWQgZXJy
b3JfcmVjb3JkX2VuZ2luZV9yZWdpc3RlcnMoc3RydWN0IGk5MTVfZ3B1X3N0YXRlICplcnJvciwK
IAl9CiAKIAllZS0+aWRsZSA9IGludGVsX2VuZ2luZV9pc19pZGxlKGVuZ2luZSk7Ci0JaWYgKCFl
ZS0+aWRsZSkKLQkJZWUtPmhhbmdjaGVja190aW1lc3RhbXAgPSBlbmdpbmUtPmhhbmdjaGVjay5h
Y3Rpb25fdGltZXN0YW1wOwogCWVlLT5yZXNldF9jb3VudCA9IGk5MTVfcmVzZXRfZW5naW5lX2Nv
dW50KCZkZXZfcHJpdi0+Z3B1X2Vycm9yLAogCQkJCQkJICBlbmdpbmUpOwogCkBAIC0xNjQ4LDIw
ICsxNjM5LDYgQEAgc3RhdGljIHZvaWQgY2FwdHVyZV9wYXJhbXMoc3RydWN0IGk5MTVfZ3B1X3N0
YXRlICplcnJvcikKIAlpOTE1X3BhcmFtc19jb3B5KCZlcnJvci0+cGFyYW1zLCAmaTkxNV9tb2Rw
YXJhbXMpOwogfQogCi1zdGF0aWMgdW5zaWduZWQgbG9uZyBjYXB0dXJlX2ZpbmRfZXBvY2goY29u
c3Qgc3RydWN0IGk5MTVfZ3B1X3N0YXRlICplcnJvcikKLXsKLQljb25zdCBzdHJ1Y3QgZHJtX2k5
MTVfZXJyb3JfZW5naW5lICplZTsKLQl1bnNpZ25lZCBsb25nIGVwb2NoID0gZXJyb3ItPmNhcHR1
cmU7Ci0KLQlmb3IgKGVlID0gZXJyb3ItPmVuZ2luZTsgZWU7IGVlID0gZWUtPm5leHQpIHsKLQkJ
aWYgKGVlLT5oYW5nY2hlY2tfdGltZXN0YW1wICYmCi0JCSAgICB0aW1lX2JlZm9yZShlZS0+aGFu
Z2NoZWNrX3RpbWVzdGFtcCwgZXBvY2gpKQotCQkJZXBvY2ggPSBlZS0+aGFuZ2NoZWNrX3RpbWVz
dGFtcDsKLQl9Ci0KLQlyZXR1cm4gZXBvY2g7Ci19Ci0KIHN0YXRpYyB2b2lkIGNhcHR1cmVfZmlu
aXNoKHN0cnVjdCBpOTE1X2dwdV9zdGF0ZSAqZXJyb3IpCiB7CiAJc3RydWN0IGk5MTVfZ2d0dCAq
Z2d0dCA9ICZlcnJvci0+aTkxNS0+Z2d0dDsKQEAgLTE3MTMsOCArMTY5MCw2IEBAIGk5MTVfY2Fw
dHVyZV9ncHVfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJZXJyb3ItPm92
ZXJsYXkgPSBpbnRlbF9vdmVybGF5X2NhcHR1cmVfZXJyb3Jfc3RhdGUoaTkxNSk7CiAJZXJyb3It
PmRpc3BsYXkgPSBpbnRlbF9kaXNwbGF5X2NhcHR1cmVfZXJyb3Jfc3RhdGUoaTkxNSk7CiAKLQll
cnJvci0+ZXBvY2ggPSBjYXB0dXJlX2ZpbmRfZXBvY2goZXJyb3IpOwotCiAJY2FwdHVyZV9maW5p
c2goZXJyb3IpOwogCWNvbXByZXNzX2ZpbmkoJmNvbXByZXNzKTsKIApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZ3B1X2Vycm9yLmgKaW5kZXggZGY5ZjU3NzY2NjI2Li4wZWQwNjFlZTMzNzggMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmgKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuaApAQCAtMzQsNyArMzQsNiBAQCBzdHJ1Y3Qg
aTkxNV9ncHVfc3RhdGUgewogCWt0aW1lX3QgYm9vdHRpbWU7CiAJa3RpbWVfdCB1cHRpbWU7CiAJ
dW5zaWduZWQgbG9uZyBjYXB0dXJlOwotCXVuc2lnbmVkIGxvbmcgZXBvY2g7CiAKIAlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNTsKIApAQCAtODUsNyArODQsNiBAQCBzdHJ1Y3QgaTkxNV9n
cHVfc3RhdGUgewogCiAJCS8qIFNvZnR3YXJlIHRyYWNrZWQgc3RhdGUgKi8KIAkJYm9vbCBpZGxl
OwotCQl1bnNpZ25lZCBsb25nIGhhbmdjaGVja190aW1lc3RhbXA7CiAJCWludCBudW1fcmVxdWVz
dHM7CiAJCXUzMiByZXNldF9jb3VudDsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9wcmlvbGlzdF90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wcmlv
bGlzdF90eXBlcy5oCmluZGV4IGFlOGJiM2NiNjI3ZS4uNzMyYWFkMTQ4ODgxIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ByaW9saXN0X3R5cGVzLmgKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9wcmlvbGlzdF90eXBlcy5oCkBAIC0xNiw2ICsxNiwxMiBAQCBl
bnVtIHsKIAlJOTE1X1BSSU9SSVRZX01JTiA9IEk5MTVfQ09OVEVYVF9NSU5fVVNFUl9QUklPUklU
WSAtIDEsCiAJSTkxNV9QUklPUklUWV9OT1JNQUwgPSBJOTE1X0NPTlRFWFRfREVGQVVMVF9QUklP
UklUWSwKIAlJOTE1X1BSSU9SSVRZX01BWCA9IEk5MTVfQ09OVEVYVF9NQVhfVVNFUl9QUklPUklU
WSArIDEsCisKKwkvKiBBIHByZWVtcHRpdmUgcHVsc2UgdXNlZCB0byBtb25pdG9yIHRoZSBoZWFs
dGggb2YgZWFjaCBlbmdpbmUgKi8KKwlJOTE1X1BSSU9SSVRZX0hFQVJUQkVBVCwKKworCS8qIElu
dGVyYWN0aXZlIHdvcmtsb2FkLCBzY2hlZHVsZWQgZm9yIGltbWVkaWF0ZSBwYWdlZmxpcHBpbmcg
Ki8KKwlJOTE1X1BSSU9SSVRZX0RJU1BMQVksCiB9OwogCiAjZGVmaW5lIEk5MTVfVVNFUl9QUklP
UklUWV9TSElGVCAyCi0tIAoyLjIzLjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZy
ZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3Rp
bmZvL2ludGVsLWdmeA==
